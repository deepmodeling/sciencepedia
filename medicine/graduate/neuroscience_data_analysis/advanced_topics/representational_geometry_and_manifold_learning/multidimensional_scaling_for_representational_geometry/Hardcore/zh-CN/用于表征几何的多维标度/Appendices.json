{
    "hands_on_practices": [
        {
            "introduction": "这个练习旨在建立经典多维尺度分析（MDS）的基础。我们将从一组已知神经反应向量的简单几何构型出发，通过亲手计算来观察MDS如何提取和表示数据的内在结构。通过构建表征非相似性矩阵（RDM）并对其进行谱分解，本练习的核心是理解MDS解的特征值如何量化表征几何中沿主轴的方差。",
            "id": "4179073",
            "problem": "在一个测量四种视觉条件下多体素活动模式的实验中，你获得了跨两个体素的以下响应向量：条件 $1$ 的响应为 $r_{1} = (0, 0)$，条件 $2$ 的响应为 $r_{2} = (1, 0)$，条件 $3$ 的响应为 $r_{3} = (0, 2)$，条件 $4$ 的响应为 $r_{4} = (1, 2)$。使用响应向量之间的欧几里得距离，构建表征非相似性矩阵（RDM）。然后，对RDM应用经典多维标度分析，以获得中心化构型及其谱分解。最后，计算第一个主坐标所捕获的总表征方差的比例（即，经典多维标度分析解的最大正特征值除以所有正特征值之和）。请以无舍入的精确分数形式给出你的最终答案。",
            "solution": "解决方案包括三个主要部分：\n1. 使用欧几里得距离，根据给定的响应向量构建表征非相似性矩阵（RDM）。\n2. 应用经典多维标度分析（MDS）来找到所得格拉姆矩阵的特征值。\n3. 计算所需的方差比例。\n\n**第1部分：构建RDM**\nRDM，记为 $\\Delta$，是一个对称的 $4 \\times 4$ 矩阵，其中每个元素 $\\Delta_{ij}$ 是条件 $i$ 和条件 $j$ 之间的非相似性。这里的非相似性是欧几里得距离 $d(r_i, r_j)$。\n\n给定的响应向量为 $r_1 = (0, 0)$，$r_2 = (1, 0)$，$r_3 = (0, 2)$ 和 $r_4 = (1, 2)$。\n成对的欧几里得距离是：\n- $d(r_1, r_2) = \\sqrt{(0-1)^2 + (0-0)^2} = \\sqrt{1} = 1$\n- $d(r_1, r_3) = \\sqrt{(0-0)^2 + (0-2)^2} = \\sqrt{4} = 2$\n- $d(r_1, r_4) = \\sqrt{(0-1)^2 + (0-2)^2} = \\sqrt{1+4} = \\sqrt{5}$\n- $d(r_2, r_3) = \\sqrt{(1-0)^2 + (0-2)^2} = \\sqrt{1+4} = \\sqrt{5}$\n- $d(r_2, r_4) = \\sqrt{(1-1)^2 + (0-2)^2} = \\sqrt{4} = 2$\n- $d(r_3, r_4) = \\sqrt{(0-1)^2 + (2-2)^2} = \\sqrt{1} = 1$\n对角线元素为 $d(r_i, r_i) = 0$。由于距离矩阵是对称的（$\\Delta_{ij} = \\Delta_{ji}$），我们可以构建完整的RDM：\n$$\n\\Delta = \\begin{pmatrix}\n0  1  2  \\sqrt{5} \\\\\n1  0  \\sqrt{5}  2 \\\\\n2  \\sqrt{5}  0  1 \\\\\n\\sqrt{5}  2  1  0\n\\end{pmatrix}\n$$\n\n**第2部分：应用经典多维标度分析**\n经典MDS（也称为Torgerson-Gower标度法）旨在找到一个点的构型，其点间距离与给定的非相似性相匹配。由于我们的非相似性是从现有构型导出的欧几里得距离，MDS将恢复此原始构型的中心化版本。\n\n该过程首先创建平方非相似性矩阵 $\\Delta^{(2)}$，其中 $(\\Delta^{(2)})_{ij} = (\\Delta_{ij})^2$：\n$$\n\\Delta^{(2)} = \\begin{pmatrix}\n0  1  4  5 \\\\\n1  0  5  4 \\\\\n4  5  0  1 \\\\\n5  4  1  0\n\\end{pmatrix}\n$$\n接下来，我们通过对 $\\Delta^{(2)}$ 进行双重中心化来计算格拉姆矩阵 $B$：$B = -\\frac{1}{2} J \\Delta^{(2)} J$，其中 $J = I - \\frac{1}{n} \\mathbf{1}\\mathbf{1}^T$ 是中心化矩阵（$n=4$）。\n\n然而，存在一种更直接的方法。由于我们有原始坐标，我们可以通过计算中心化坐标的内积矩阵来找到格拉姆矩阵 $B$。设原始坐标矩阵为 $X$：\n$$\nX = \\begin{pmatrix}\n0  0 \\\\\n1  0 \\\\\n0  2 \\\\\n1  2\n\\end{pmatrix}\n$$\n点的数量为 $n=4$。这些点的质心（均值向量）是：\n$$\n\\bar{r} = \\frac{1}{4} \\sum_{i=1}^{4} r_i = \\frac{1}{4} \\left( (0+1+0+1), (0+0+2+2) \\right) = \\frac{1}{4} (2, 4) = \\left(\\frac{1}{2}, 1\\right)\n$$\n中心化坐标矩阵 $X_c$ 是通过从 $X$ 的每一行中减去质心得到的：\n$$\nX_c = \\begin{pmatrix}\n0 - \\frac{1}{2}   0 - 1 \\\\\n1 - \\frac{1}{2}   0 - 1 \\\\\n0 - \\frac{1}{2}   2 - 1 \\\\\n1 - \\frac{1}{2}   2 - 1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\frac{1}{2}   -1 \\\\\n\\frac{1}{2}   -1 \\\\\n-\\frac{1}{2}   1 \\\\\n\\frac{1}{2}   1\n\\end{pmatrix}\n$$\n格拉姆矩阵由 $B = X_c X_c^T$ 给出。$B$ 的谱分解给出了经典MDS问题的解。$B$ 的特征值是所需的量。\n\n线性代数中的一个基本结果表明，对于任何矩阵 $A$，$A A^T$ 的非零特征值与 $A^T A$ 的非零特征值相同。在我们的例子中，计算 $X_c^T X_c$ 的特征值比计算 $B = X_c X_c^T$ 的特征值简单得多，因为 $X_c$ 是一个 $4 \\times 2$ 矩阵，所以 $X_c^T X_c$ 是一个 $2 \\times 2$ 矩阵。我们称这个矩阵为 $C = X_c^T X_c$。\n\n$$\nC = X_c^T X_c =\n\\begin{pmatrix}\n-\\frac{1}{2}   \\frac{1}{2}   -\\frac{1}{2}   \\frac{1}{2} \\\\\n-1   -1   1   1\n\\end{pmatrix}\n\\begin{pmatrix}\n-\\frac{1}{2}   -1 \\\\\n\\frac{1}{2}   -1 \\\\\n-\\frac{1}{2}   1 \\\\\n\\frac{1}{2}   1\n\\end{pmatrix}\n$$\n让我们计算 $C$ 的元素：\n$$\nC_{11} = \\left(-\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 + \\left(-\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{4} = 1\n$$\n$$\nC_{12} = \\left(-\\frac{1}{2}\\right)(-1) + \\left(\\frac{1}{2}\\right)(-1) + \\left(-\\frac{1}{2}\\right)(1) + \\left(\\frac{1}{2}\\right)(1) = \\frac{1}{2} - \\frac{1}{2} - \\frac{1}{2} + \\frac{1}{2} = 0\n$$\n$$\nC_{21} = C_{12} = 0\n$$\n$$\nC_{22} = (-1)^2 + (-1)^2 + 1^2 + 1^2 = 1 + 1 + 1 + 1 = 4\n$$\n所以矩阵 $C$ 是：\n$$\nC = \\begin{pmatrix}\n1  0 \\\\\n0  4\n\\end{pmatrix}\n$$\n这个对角矩阵的特征值就是其对角线上的元素：$\\lambda_a = 1$ 和 $\\lambda_b = 4$。这些是格拉姆矩阵 $B$ 的两个非零特征值。$B$ 的另外两个特征值为零。经典MDS解的正特征值为 $\\lambda_1 = 4$ 和 $\\lambda_2 = 1$（从大到小排列）。\n\n**第3部分：计算方差比例**\n问题要求计算第一个主坐标所捕获的总表征方差的比例。这被定义为最大正特征值与所有正特征值之和的比率。\n\n最大正特征值为 $\\lambda_{\\max} = \\lambda_1 = 4$。\n所有正特征值的和为 $\\sum \\lambda_{i0} = \\lambda_1 + \\lambda_2 = 4 + 1 = 5$。\n\n该比例为：\n$$\n\\text{Proportion} = \\frac{\\lambda_{\\max}}{\\sum \\lambda_{i0}} = \\frac{4}{5}\n$$\n这个结果意味着第一个主坐标（即在表征几何中捕获最多变异性的维度）解释了非相似性结构中总方差的 $80\\%$。",
            "answer": "$$\n\\boxed{\\frac{4}{5}}\n$$"
        },
        {
            "introduction": "在实际应用中，实验测量得到的非相似性数据往往含有噪声，可能不完全符合欧几里得距离的几何约束。本练习将探讨如何处理这一关键问题，即当一个非相似性矩阵为“非欧几里得”时该如何操作。我们将学习通过双中心化推导内积矩阵，并利用其谱特性（即特征值）来诊断非欧几里得结构，进而应用标准校正方法将其投影到最近的欧几里得空间。",
            "id": "4179062",
            "problem": "一个实验室从一个神经元群体中收集了三个视觉刺激之间的成对相异性，并将它们组合成一个对角线元素为零的对称平方相异性矩阵 $D^{(2)}$。尽管这些测量值旨在反映表征向量之间的平方欧几里得距离，但测量噪声会使 $D^{(2)}$ 变为非欧几里得的。考虑以下特定情况：\n$$\nD^{(2)} \\;=\\; \\begin{pmatrix}\n0  1  16 \\\\\n1  0  4 \\\\\n16  4  0\n\\end{pmatrix}.\n$$\n经典多维标度分析（MDS）被用来恢复一个点构型，该构型中点间的距离近似于 $D^{(2)}$。仅从以下两个定义出发：(i) 如果点是均值中心化的，那么内积（格拉姆）矩阵编码了成对内积；(ii) 点之间的平方欧几里得距离由它们的内积决定。请执行以下步骤：\n\n1. 在均值中心化的假设下，推导如何从一个通用的平方相异性矩阵 $D^{(2)}$ 获得一个内积矩阵 $B$。然后，对于给定的 $D^{(2)}$，计算相应的 $B$。\n\n2. 利用 $B$ 的谱特性，通过将 $B$ 的任何负特征值设为零，同时保持非负特征值不变，来构造一个投影内积矩阵 $B^{+}$。解释为什么在弗罗贝尼乌斯范数下，这个投影是在最小化 $B$ 变化的意义上最近的。\n\n3. 从 $B^{+}$ 重构一个平方欧几里得距离矩阵 $D^{(2)}_{\\text{proj}}$，该矩阵与欧几里得空间中的嵌入相符，并根据内积和平方距离之间的关系简要说明这种重构形式的合理性。\n\n4. 通过计算弗罗贝尼乌斯范数 $\\|B - B^{+}\\|_{F}$ 的精确值来量化投影所引起的失真。将你的最终答案表示为单个无舍入的封闭形式解析表达式。\n\n提供 $\\|B - B^{+}\\|_{F}$ 的精确值作为你的最终答案。",
            "solution": "该问题要求使用经典多维标度分析（MDS）的原理，对给定的平方相异性矩阵 $D^{(2)}$ 进行四部分分析。\n\n**1. 内积矩阵 $B$ 的推导与计算**\n\n假设有 $n$ 个点，由向量 $\\mathbf{x}_1, \\dots, \\mathbf{x}_n \\in \\mathbb{R}^p$ 表示。点 $\\mathbf{x}_i$ 和 $\\mathbf{x}_j$ 之间的平方欧几里得距离为 $d_{ij}^2 = \\|\\mathbf{x}_i - \\mathbf{x}_j\\|^2$。这些平方距离构成的矩阵是 $D^{(2)}$。内积（格拉姆）矩阵是 $B$，其元素为 $B_{ij} = \\mathbf{x}_i^T \\mathbf{x}_j$。\n\n展开平方距离，我们有：\n$$\nd_{ij}^2 = (\\mathbf{x}_i - \\mathbf{x}_j)^T(\\mathbf{x}_i - \\mathbf{x}_j) = \\mathbf{x}_i^T\\mathbf{x}_i - 2 \\mathbf{x}_i^T\\mathbf{x}_j + \\mathbf{x}_j^T\\mathbf{x}_j = B_{ii} - 2B_{ij} + B_{jj}\n$$\n问题指定点的构型是均值中心化的，这意味着 $\\sum_{k=1}^n \\mathbf{x}_k = \\mathbf{0}$。这表明格拉姆矩阵 $B$ 的行和与列和均为零：\n$$\n\\sum_{j=1}^n B_{ij} = \\sum_{j=1}^n \\mathbf{x}_i^T \\mathbf{x}_j = \\mathbf{x}_i^T \\left(\\sum_{j=1}^n \\mathbf{x}_j\\right) = \\mathbf{x}_i^T \\mathbf{0} = 0\n$$\n$$\n\\sum_{i=1}^n B_{ij} = \\sum_{i=1}^n \\mathbf{x}_i^T \\mathbf{x}_j = \\left(\\sum_{i=1}^n \\mathbf{x}_i\\right)^T \\mathbf{x}_j = \\mathbf{0}^T \\mathbf{x}_j = 0\n$$\n利用此性质，我们可以从 $D^{(2)}$ 推导出 $B$。对 $d_{ij}^2$ 按 $j$ 和 $i$ 求和：\n$$\n\\sum_{j=1}^n d_{ij}^2 = \\sum_{j=1}^n (B_{ii} - 2B_{ij} + B_{jj}) = n B_{ii} - 2\\sum_{j=1}^n B_{ij} + \\sum_{j=1}^n B_{jj} = n B_{ii} + \\text{Tr}(B)\n$$\n$$\n\\sum_{i=1}^n d_{ij}^2 = \\sum_{i=1}^n (B_{ii} - 2B_{ij} + B_{jj}) = \\sum_{i=1}^n B_{ii} - 2\\sum_{i=1}^n B_{ij} + n B_{jj} = \\text{Tr}(B) + n B_{jj}\n$$\n对两个下标求和得到 $\\sum_{i,j} d_{ij}^2 = 2n\\text{Tr}(B)$，所以 $\\text{Tr}(B) = \\frac{1}{2n}\\sum_{i,j} d_{ij}^2$。\n\n让我们定义 $D^{(2)}$ 元素的行、列和总平均值：\n$d_{i\\cdot}^2 = \\frac{1}{n} \\sum_{j=1}^n d_{ij}^2$， $d_{\\cdot j}^2 = \\frac{1}{n} \\sum_{i=1}^n d_{ij}^2$，以及 $d_{\\cdot\\cdot}^2 = \\frac{1}{n^2} \\sum_{i,j} d_{ij}^2$。\n从上面的求和式可得：\n$d_{i\\cdot}^2 = B_{ii} + \\frac{1}{n}\\text{Tr}(B)$，\n$d_{\\cdot j}^2 = B_{jj} + \\frac{1}{n}\\text{Tr}(B)$，\n$d_{\\cdot\\cdot}^2 = \\frac{2}{n}\\text{Tr}(B)$。\n现在，我们用这些量来表示 $B_{ij}$：\n$$\nB_{ij} = -\\frac{1}{2} (d_{ij}^2 - B_{ii} - B_{jj}) = -\\frac{1}{2} \\left[d_{ij}^2 - \\left(d_{i\\cdot}^2 - \\frac{1}{n}\\text{Tr}(B)\\right) - \\left(d_{\\cdot j}^2 - \\frac{1}{n}\\text{Tr}(B)\\right)\\right]\n$$\n$$\nB_{ij} = -\\frac{1}{2} \\left[d_{ij}^2 - d_{i\\cdot}^2 - d_{\\cdot j}^2 + \\frac{2}{n}\\text{Tr}(B)\\right] = -\\frac{1}{2} (d_{ij}^2 - d_{i\\cdot}^2 - d_{\\cdot j}^2 + d_{\\cdot\\cdot}^2)\n$$\n这就是“双重中心化”公式。对于给定的矩阵 $D^{(2)}$，其中 $n=3$：\n$$\nD^{(2)} \\;=\\; \\begin{pmatrix}\n0  1  16 \\\\\n1  0  4 \\\\\n16  4  0\n\\end{pmatrix}\n$$\n行和分别为 $17$、$5$ 和 $20$。总和为 $42$。因为 $D^{(2)}$ 是对称的，所以列和相同。\n行/列平均值为：\n$d_{1\\cdot}^2 = d_{\\cdot 1}^2 = 17/3$。\n$d_{2\\cdot}^2 = d_{\\cdot 2}^2 = 5/3$。\n$d_{3\\cdot}^2 = d_{\\cdot 3}^2 = 20/3$。\n总平均值为 $d_{\\cdot\\cdot}^2 = 42/3^2 = 14/3$。\n现在我们计算 $B$ 的元素：\n$B_{11} = -\\frac{1}{2}(0 - \\frac{17}{3} - \\frac{17}{3} + \\frac{14}{3}) = -\\frac{1}{2}(-\\frac{20}{3}) = \\frac{10}{3}$。\n$B_{22} = -\\frac{1}{2}(0 - \\frac{5}{3} - \\frac{5}{3} + \\frac{14}{3}) = -\\frac{1}{2}(\\frac{4}{3}) = -\\frac{2}{3}$。\n$B_{33} = -\\frac{1}{2}(0 - \\frac{20}{3} - \\frac{20}{3} + \\frac{14}{3}) = -\\frac{1}{2}(-\\frac{26}{3}) = \\frac{13}{3}$。\n$B_{12} = -\\frac{1}{2}(1 - \\frac{17}{3} - \\frac{5}{3} + \\frac{14}{3}) = -\\frac{1}{2}(\\frac{3-17-5+14}{3}) = -\\frac{1}{2}(-\\frac{5}{3}) = \\frac{5}{6}$。\n$B_{13} = -\\frac{1}{2}(16 - \\frac{17}{3} - \\frac{20}{3} + \\frac{14}{3}) = -\\frac{1}{2}(\\frac{48-17-20+14}{3}) = -\\frac{1}{2}(\\frac{25}{3}) = -\\frac{25}{6}$。\n$B_{23} = -\\frac{1}{2}(4 - \\frac{5}{3} - \\frac{20}{3} + \\frac{14}{3}) = -\\frac{1}{2}(\\frac{12-5-20+14}{3}) = -\\frac{1}{2}(\\frac{1}{3}) = -\\frac{1}{6}$。\n所以内积矩阵是：\n$$\nB \\;=\\; \\begin{pmatrix}\n10/3   5/6   -25/6 \\\\\n5/6   -2/3   -1/6 \\\\\n-25/6   -1/6   13/3\n\\end{pmatrix} \\;=\\; \\frac{1}{6} \\begin{pmatrix}\n20   5   -25 \\\\\n5   -4   -1 \\\\\n-25   -1   26\n\\end{pmatrix}\n$$\n\n**2. 到半正定锥的投影**\n\n为了找到 $B$ 的谱特性，我们求其特征值。设 $\\lambda$ 是 $B$ 的一个特征值，$\\mu = 6\\lambda$ 是 $6B$ 的一个特征值。$6B$ 的特征方程是 $\\det(6B - \\mu I) = 0$。\n$$\n\\det \\begin{pmatrix}\n20-\\mu   5   -25 \\\\\n5   -4-\\mu   -1 \\\\\n-25   -1   26-\\mu\n\\end{pmatrix} = 0\n$$\n展开行列式得到：\n$(20-\\mu)[(-4-\\mu)(26-\\mu) - 1] - 5[5(26-\\mu) - 25] - 25[-5 - (-25)(-4-\\mu)] = 0$\n$-\\mu^3 + 42\\mu^2 + 315\\mu = 0$\n$-\\mu(\\mu^2 - 42\\mu - 315) = 0$\n一个特征值是 $\\mu_1 = 0$。另外两个是二次方程的根：\n$$\n\\mu = \\frac{42 \\pm \\sqrt{(-42)^2 - 4(1)(-315)}}{2} = \\frac{42 \\pm \\sqrt{1764 + 1260}}{2} = \\frac{42 \\pm \\sqrt{3024}}{2}\n$$\n简化平方根：$\\sqrt{3024} = \\sqrt{144 \\cdot 21} = 12\\sqrt{21}$。\n$$\n\\mu = \\frac{42 \\pm 12\\sqrt{21}}{2} = 21 \\pm 6\\sqrt{21}\n$$\n$6B$ 的特征值是 $\\mu_1=0$，$\\mu_2 = 21 + 6\\sqrt{21}$ 和 $\\mu_3 = 21 - 6\\sqrt{21}$。$B$ 的特征值是 $\\lambda_i = \\mu_i/6$：\n$\\lambda_1=0$，$\\lambda_2 = \\frac{7}{2} + \\sqrt{21}$，$\\lambda_3 = \\frac{7}{2} - \\sqrt{21}$。\n我们检查 $\\lambda_3$ 的符号。因为 $(\\sqrt{21})^2 = 21$ 且 $(7/2)^2 = 49/4 = 12.25$，所以 $\\sqrt{21}  7/2$，因此 $\\lambda_3  0$。\n矩阵 $B$ 不是半正定的，这证实了 $D^{(2)}$ 是非欧几里得的。\n\n通过将负特征值设为零来形成投影矩阵 $B^{+}$。设 $B$ 的谱分解为 $B = V \\Lambda V^T$，其中 $\\Lambda = \\text{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$，$V$ 是一个由特征向量构成的正交矩阵。那么 $B^{+} = V \\Lambda^{+} V^T$，其中 $\\Lambda^{+} = \\text{diag}(\\max(0,\\lambda_1), \\max(0,\\lambda_2), \\max(0,\\lambda_3))$。\n$$\n\\Lambda^{+} = \\text{diag}(0, \\frac{7}{2} + \\sqrt{21}, 0)\n$$\n在弗罗贝尼乌斯范数的意义上，此投影找到了与 $B$ 最接近的半正定矩阵。这是 Eckart-Young-Mirsky 定理在半正定近似问题上的一个特例结果。对于对称矩阵 $B$，在所有半正定矩阵 $X$ 中最小化 $\\|B-X\\|_F$ 的问题，可以通过找到谱分解 $B = V\\Lambda V^T$ 并设 $X = V \\text{diag}(\\max(0,\\lambda_i)) V^T$ 来解决。弗罗贝尼乌斯范数是酉不变的，所以 $\\|B-X\\|_F^2 = \\|\\Lambda - V^T X V\\|_F^2$。当 $V^T X V$ 是对角矩阵 $\\Lambda^{+}$ 时达到最小值，这意味着 $X=B^{+}$。\n\n**3. 欧几里得距离矩阵 $D^{(2)}_{\\text{proj}}$ 的重构**\n\n平方距离矩阵 $D^{(2)}$ 与其对应的中心化内积矩阵 $B$ 之间的关系由 $d_{ij}^2 = B_{ii} - 2B_{ij} + B_{jj}$ 给出。为了重构一个保证是欧几里得的平方距离矩阵 $D^{(2)}_{\\text{proj}}$，我们将此公式应用于投影后的半正定内积矩阵 $B^{+}$。\n$$\n(D^{(2)}_{\\text{proj}})_{ij} = (B^{+})_{ii} - 2(B^{+})_{ij} + (B^{+})_{jj}\n$$\n这种重构是合理的，因为 $B^{+}$ 是半正定的，所以它是一个有效的格拉姆矩阵。这意味着存在欧几里得空间中的一个点构型 $\\{\\mathbf{y}_i\\}$，使得它们的内积由 $B^{+}_{ij} = \\mathbf{y}_i^T \\mathbf{y}_j$ 给出。这些点之间的平方欧几里得距离必然由 $\\|\\mathbf{y}_i - \\mathbf{y}_j\\|^2 = B^{+}_{ii} - 2B^{+}_{ij} + B^{+}_{jj}$ 给出，这正是 $(D^{(2)}_{\\text{proj}})_{ij}$ 的公式。\n\n**4. 量化失真**\n\n失真是原始内积矩阵与投影后内积矩阵之差的弗罗贝尼乌斯范数，即 $\\|B - B^{+}\\|_F$。利用弗罗贝尼乌斯范数的酉不变性：\n$$\n\\|B - B^{+}\\|_F = \\|V \\Lambda V^T - V \\Lambda^{+} V^T\\|_F = \\|V (\\Lambda - \\Lambda^{+}) V^T\\|_F = \\|\\Lambda - \\Lambda^{+}\\|_F\n$$\n特征值矩阵之间的差是：\n$$\n\\Lambda - \\Lambda^{+} = \\text{diag}(\\lambda_1 - \\max(0,\\lambda_1), \\lambda_2 - \\max(0,\\lambda_2), \\lambda_3 - \\max(0,\\lambda_3))\n$$\n$$\n\\Lambda - \\Lambda^{+} = \\text{diag}(0 - 0, (\\frac{7}{2} + \\sqrt{21}) - (\\frac{7}{2} + \\sqrt{21}), (\\frac{7}{2} - \\sqrt{21}) - 0)\n$$\n$$\n\\Lambda - \\Lambda^{+} = \\text{diag}(0, 0, \\frac{7}{2} - \\sqrt{21})\n$$\n这个对角矩阵的弗罗贝尼乌斯范数是其对角元素平方和的平方根：\n$$\n\\|B - B^{+}\\|_F = \\sqrt{0^2 + 0^2 + \\left(\\frac{7}{2} - \\sqrt{21}\\right)^2} = \\left|\\frac{7}{2} - \\sqrt{21}\\right|\n$$\n因为我们已经确定 $\\frac{7}{2} - \\sqrt{21}  0$，所以绝对值为：\n$$\n\\|B - B^{+}\\|_F = - \\left(\\frac{7}{2} - \\sqrt{21}\\right) = \\sqrt{21} - \\frac{7}{2}\n$$\n这个量代表 $B$ 的负特征值的绝对值之和。",
            "answer": "$$\n\\boxed{\\sqrt{21} - \\frac{7}{2}}\n$$"
        },
        {
            "introduction": "前面的练习都基于度量MDS的假设，即非相似性数值本身具有精确意义。然而，在许多神经科学应用中，我们更关心非相似性值的相对排序。本练习将带你进入非度量MDS的核心，重点关注其关键算法步骤——单调回归。我们将使用经典的“池化相邻违规者算法”（PAVA）来找到一组既尊重原始数据排序又尽可能接近测量距离的拟合距离，并学习计算Kruskal压力值来评估拟合优度。",
            "id": "4179037",
            "problem": "一个实验室正在分析由一组刺激引发的神经活动模式之间的表征非相似性。科学家从一个表征非相似性矩阵 (RDM) 中提取出一组非相似性值 $\\delta_{ij}$，并从相同刺激的一个临时性二维嵌入中测量出点间距离 $d_{ij}$。遵循非度量多维标度 (MDS) 的原则，通过找到一个从非相似性值到拟合距离的单调递增变换来评估拟合优度，该变换能使 $d_{ij}$ 值与 $\\delta_{ij}$ 值的秩次最佳对齐。\n\n考虑从一名被试的记录会话中获得的、针对不同刺激对的以下七对测量值 $(\\delta_{ij}, d_{ij})$：\n$(0.8,\\, 1.1)$, $(1.2,\\, 0.9)$, $(1.4,\\, 1.3)$, $(1.5,\\, 1.7)$, $(1.9,\\, 1.6)$, $(2.1,\\, 2.0)$, $(2.3,\\, 1.9)$。\n\n假设所有对的权重相等。遵循经典的非度量程序，使用最小二乘法准则对距离与非相似性进行单调回归拟合，并强制拟合映射相对于 $\\delta_{ij}$ 是非递减的。然后计算此拟合得到的 Kruskal stress-1 值。\n\n将最终的 stress 值表示为一个无量纲的小数，并四舍五入到四位有效数字。",
            "solution": "该问题要求我们首先找到一组拟合距离（我们将其表示为 $\\hat{d}_{ij}$），这些距离相对于给定的非相似性值 $\\delta_{ij}$ 是单调非递减的，并且在最小二乘意义上尽可能接近观测距离 $d_{ij}$。这个过程被称为单调回归或保序回归。一旦找到拟合距离 $\\hat{d}_{ij}$，我们就可以计算 Kruskal stress-1。\n\n首先，我们必须根据非相似性值 $\\delta_{ij}$ 对数据对进行排序。设数据对的数量为 $n=7$。给定的非相似性值已按升序排列：\n$0.8  1.2  1.4  1.5  1.9  2.1  2.3$。\n我们将对应的观测距离序列表示为 $D = (d_{(1)}, d_{(2)}, \\dots, d_{(7)})$。\n$$D = (1.1, 0.9, 1.3, 1.7, 1.6, 2.0, 1.9)$$\n我们寻求一个新的拟合距离序列 $\\hat{D} = (\\hat{d}_{(1)}, \\hat{d}_{(2)}, \\dots, \\hat{d}_{(7)})$，使得：\n1.  它是单调非递减的：$\\hat{d}_{(1)} \\le \\hat{d}_{(2)} \\le \\dots \\le \\hat{d}_{(7)}$。\n2.  它最小化平方误差和：$\\sum_{k=1}^{7} (d_{(k)} - \\hat{d}_{(k)})^2$。\n\n解决这个问题的标准算法是邻近违规者合并算法 (PAVA)。该算法迭代地识别和解决违反单调性约束的情况。如果对于某个 $k$，有 $\\hat{d}_{(k)}  \\hat{d}_{(k+1)}$，就发生了违规。当发现这种违规时，违规的值将被它们的加权平均值（由于权重相等，这里是简单平均值）所取代。重复此过程，直到没有违规为止。\n\n让我们将 PAVA 应用于我们的序列 $D$：\n初始序列：$(1.1, 0.9, 1.3, 1.7, 1.6, 2.0, 1.9)$。\n\n1.  我们从左到右扫描。第一个违规发生在第一个和第二个元素之间：$1.1  0.9$。我们必须合并这两个值。\n    平均值为 $\\frac{1.1 + 0.9}{2} = 1.0$。\n    序列变为：$(1.0, 1.0, 1.3, 1.7, 1.6, 2.0, 1.9)$。\n    我们从新的块开始向后检查。这个块就是 $(1.0, 1.0)$，是单调的。我们继续向前扫描。\n\n2.  现在的序列是 $\\hat{D} = (1.0, 1.0, 1.3, 1.7, 1.6, 2.0, 1.9)$。\n    我们继续扫描：$1.0 \\le 1.0 \\le 1.3 \\le 1.7$。下一个比较是在第四个和第五个元素之间：$1.7  1.6$。这是一个违规。我们合并这两个值。\n    平均值为 $\\frac{1.7 + 1.6}{2} = 1.65$。\n    序列变为：$(1.0, 1.0, 1.3, 1.65, 1.65, 2.0, 1.9)$。\n    我们必须将这个新块与前面的值进行检查：$1.3 \\le 1.65$。单调性保持。我们继续向前扫描。\n\n3.  现在的序列是 $\\hat{D} = (1.0, 1.0, 1.3, 1.65, 1.65, 2.0, 1.9)$。\n    我们继续扫描：$1.65 \\le 1.65 \\le 2.0$。下一个比较是在第六个和第七个元素之间：$2.0  1.9$。这是一个违规。我们合并这两个值。\n    平均值为 $\\frac{2.0 + 1.9}{2} = 1.95$。\n    序列变为：$(1.0, 1.0, 1.3, 1.65, 1.65, 1.95, 1.95)$。\n    我们将这个新块与前面的值进行检查：$1.65 \\le 1.95$。单调性保持。\n\n最终序列是 $(1.0, 1.0, 1.3, 1.65, 1.65, 1.95, 1.95)$。我们来验证一下单调性：\n$1.0 \\le 1.0 \\le 1.3 \\le 1.65 \\le 1.65 \\le 1.95 \\le 1.95$。\n序列是完全非递减的。这就是我们的拟合距离序列 $\\hat{D}$。\n因此，$\\hat{d}_{(1)}=1.0$, $\\hat{d}_{(2)}=1.0$, $\\hat{d}_{(3)}=1.3$, $\\hat{d}_{(4)}=1.65$, $\\hat{d}_{(5)}=1.65$, $\\hat{d}_{(6)}=1.95$, $\\hat{d}_{(7)}=1.95$。\n\n现在我们计算 Kruskal stress-1，其定义为：\n$$S_1 = \\sqrt{\\frac{\\sum (d_{ij} - \\hat{d}_{ij})^2}{\\sum d_{ij}^2}}$$\n求和是在所有 $n=7$ 个数据对上进行的。\n\n首先，我们计算分子，即残差平方和 $\\sum_{k=1}^{7} (d_{(k)} - \\hat{d}_{(k)})^2$：\n-   $(d_{(1)} - \\hat{d}_{(1)})^2 = (1.1 - 1.0)^2 = 0.1^2 = 0.01$.\n-   $(d_{(2)} - \\hat{d}_{(2)})^2 = (0.9 - 1.0)^2 = (-0.1)^2 = 0.01$.\n-   $(d_{(3)} - \\hat{d}_{(3)})^2 = (1.3 - 1.3)^2 = 0^2 = 0$.\n-   $(d_{(4)} - \\hat{d}_{(4)})^2 = (1.7 - 1.65)^2 = 0.05^2 = 0.0025$.\n-   $(d_{(5)} - \\hat{d}_{(5)})^2 = (1.6 - 1.65)^2 = (-0.05)^2 = 0.0025$.\n-   $(d_{(6)} - \\hat{d}_{(6)})^2 = (2.0 - 1.95)^2 = 0.05^2 = 0.0025$.\n-   $(d_{(7)} - \\hat{d}_{(7)})^2 = (1.9 - 1.95)^2 = (-0.05)^2 = 0.0025$.\n\n残差平方和为：\n$\\sum (d_{(k)} - \\hat{d}_{(k)})^2 = 0.01 + 0.01 + 0 + 0.0025 + 0.0025 + 0.0025 + 0.0025 = 0.03$。\n\n接下来，我们计算分母，即原始距离的平方和 $\\sum_{k=1}^{7} d_{(k)}^2$：\n-   $d_{(1)}^2 = 1.1^2 = 1.21$.\n-   $d_{(2)}^2 = 0.9^2 = 0.81$.\n-   $d_{(3)}^2 = 1.3^2 = 1.69$.\n-   $d_{(4)}^2 = 1.7^2 = 2.89$.\n-   $d_{(5)}^2 = 1.6^2 = 2.56$.\n-   $d_{(6)}^2 = 2.0^2 = 4.00$.\n-   $d_{(7)}^2 = 1.9^2 = 3.61$.\n\n距离平方和为：\n$\\sum d_{(k)}^2 = 1.21 + 0.81 + 1.69 + 2.89 + 2.56 + 4.00 + 3.61 = 16.77$。\n\n现在，我们可以计算 stress-1 的值：\n$$S_1 = \\sqrt{\\frac{0.03}{16.77}} \\approx \\sqrt{0.00178890876...} \\approx 0.042295500...$$\n\n问题要求答案四舍五入到四位有效数字。\n第一个有效数字是 $4$。接下来的三位是 $2, 2, 9$。第五位有效数字是 $5$，这意味着我们需要将第四位向上进位。\n$0.0422955...$ 四舍五入到四位有效数字是 $0.04230$。",
            "answer": "$$\n\\boxed{0.04230}\n$$"
        }
    ]
}