{
    "hands_on_practices": [
        {
            "introduction": "在基于网络的统计（NBS）分析中，第一步是将您的实验设计和科学假设精确地转化为一个统计模型。本练习将指导您为一项包含多个组和协变量的研究构建通用线性模型（GLM）的设计矩阵和对比向量，这是后续所有统计检验的基础。掌握此技能可确保您的分析能够准确地检验您感兴趣的科学问题。",
            "id": "4181134",
            "problem": "您正在分析一个由$n$名受试者组成的功能连接组，这些受试者被分为三个互斥的组：A组、B组和C组。对于每位受试者 $i \\in \\{1,\\dots,n\\}$ 和连接组中的每条边 $e$，您观察到一个边权重 $y_{i}^{(e)}$。您计划使用基于网络的统计（NBS）方法，以边为单位的通用线性模型（GLM）为基础模型，在每条边上构建检验统计量，从而在连接边组件的层面上检验组间差异。\n\n从标准的通用线性模型基础出发，对于每条边 $e$，响应向量 $y^{(e)} \\in \\mathbb{R}^{n}$ 满足以下模型\n$$\ny^{(e)} \\;=\\; X \\beta^{(e)} + \\varepsilon^{(e)},\n$$\n其中 $X \\in \\mathbb{R}^{n \\times p}$ 是设计矩阵，$\\beta^{(e)} \\in \\mathbb{R}^{p}$ 是特定于边的参数向量，$\\varepsilon^{(e)} \\in \\mathbb{R}^{n}$ 是均值为零且方差有限的误差项。您将纳入受试者层面的年龄和性别协变量以控制混淆因素。\n\n构建一个科学有效、满秩的设计矩阵 $X$，用于三组比较，该矩阵包括：\n- 一个截距项，\n- 对A组和B组的组成员身份进行编码，使用二元指示变量，并以C组为参照类别，\n- 一个均值中心化的年龄协变量，\n- 一个性别协变量，编码为女性$0$和男性$1$。\n\n请确保您的构建避免了完全多重共线性，并适用于NBS背景下的边层面GLM估计。然后，基于此矩阵 $X$，指定一个单一的对比向量，用于在每条边上检验“在控制年龄和性别后，A组的平均边权重等于B组的平均边权重”这一零假设。\n\n您最终报告的答案必须是表示为单一闭式解析表达式的对比向量。如果您在构建中引入任何数值常数，必须以符号形式定义，而不是以数值实例化。无需四舍五入。请提供对比向量作为您的最终答案。",
            "solution": "该问题是有效的。它在科学上基于通用线性模型（GLM）应用于神经科学统计假设检验的既定原则。该问题提法明确、客观，并包含构建所需设计矩阵和对比向量的所有必要信息，没有歧义或矛盾。\n\n目标是在GLM框架内构建一个对比向量，以检验一个特定的假设。在给定边 $e$ 上，观测到的边权重 $y^{(e)} \\in \\mathbb{R}^n$ 的模型为：\n$$\ny^{(e)} = X \\beta^{(e)} + \\varepsilon^{(e)}\n$$\n其中 $X \\in \\mathbb{R}^{n \\times p}$ 是设计矩阵，$\\beta^{(e)} \\in \\mathbb{R}^p$ 是参数向量，$\\varepsilon^{(e)}$ 是误差项。\n\n首先，我们根据指定要求构建设计矩阵 $X$。问题说明有三个组（A、B、C），我们需要包含一个截距项、以C组为参照的A组和B组的指示变量、一个均值中心化的年龄协变量和一个性别协变量。这定义了一个包含 $p=5$ 个参数的模型。我们来定义设计矩阵 $X$ 的列。对于每位受试者 $i \\in \\{1, \\dots, n\\}$，$X$ 的第 $i$ 行（表示为 $x_i^T$）构建如下：\n\n设 $G_{iA}$ 是一个指示变量，如果受试者 $i$ 在A组，则 $G_{iA} = 1$，否则 $G_{iA} = 0$。\n设 $G_{iB}$ 是一个指示变量，如果受试者 $i$ 在B组，则 $G_{iB} = 1$，否则 $G_{iB} = 0$。\n如果受试者 $i$ 在C组，则 $G_{iA} = 0$ 且 $G_{iB} = 0$，这使得C组成为所要求的参照类别。\n\n设 $Age_i$ 为受试者 $i$ 的年龄。问题指定了一个均值中心化的年龄协变量。设 $\\bar{A} = \\frac{1}{n} \\sum_{j=1}^n Age_j$ 为所有受试者的平均年龄。受试者 $i$ 的均值中心化年龄为 $A_i = Age_i - \\bar{A}$。\n\n设 $S_i$ 为受试者 $i$ 的性别协变量，编码为女性 $S_i = 0$，男性 $S_i = 1$。\n\n设计矩阵 $X$ 是一个 $n \\times 5$ 的矩阵。$X$ 的第 $i$ 行由向量 $x_i^T$ 给出：\n$$\nx_i^T = \\begin{pmatrix} 1  G_{iA}  G_{iB}  A_i  S_i \\end{pmatrix}\n$$\n对应于边 $e$ 的参数向量 $\\beta^{(e)}$ 是 $\\mathbb{R}^5$ 中的一个列向量：\n$$\n\\beta^{(e)} = \\begin{pmatrix} \\beta_0^{(e)} \\\\ \\beta_1^{(e)} \\\\ \\beta_2^{(e)} \\\\ \\beta_3^{(e)} \\\\ \\beta_4^{(e)} \\end{pmatrix}\n$$\n在边 $e$ 上，受试者 $i$ 的期望边权重 $E[y_i^{(e)}]$ 由以下模型给出：\n$$\nE[y_i^{(e)}] = \\beta_0^{(e)} \\cdot 1 + \\beta_1^{(e)} G_{iA} + \\beta_2^{(e)} G_{iB} + \\beta_3^{(e)} A_i + \\beta_4^{(e)} S_i\n$$\n参数的解释（为清晰起见，省略上标 $(e)$）如下：\n- $\\beta_0$：参照组（C组）中，年龄为平均年龄（$A_i=0$）、性别为参照性别（女性，$S_i=0$）的受试者的平均边权重。\n- $\\beta_1$：在控制年龄和性别后，A组与C组之间的平均边权重差异。\n- $\\beta_2$：在控制年龄和性别后，B组与C组之间的平均边权重差异。\n- $\\beta_3$：年龄对边权重的影响（斜率）。\n- $\\beta_4$：在控制组别和年龄后，男性与女性之间的平均边权重差异。\n\n接下来，我们构建零假设：在控制年龄和性别后，A组的平均边权重等于B组的平均边权重。为了用模型参数来表达这个假设，我们写出每个组的调整后均值。一个组的调整后均值是指该组中受试者的期望边权重，其中协变量被设置为一个共同的参考值（例如，平均年龄 $A_i=0$ 和特定性别 $s$）。\n\nA组的调整后均值 $\\mu_A$ 是：\n$$\n\\mu_A = E[y^{(e)} | \\text{Group A, avg age, sex } s] = \\beta_0 + \\beta_1(1) + \\beta_2(0) + \\beta_3(0) + \\beta_4 s = \\beta_0 + \\beta_1 + \\beta_4 s\n$$\nB组的调整后均值 $\\mu_B$ 是：\n$$\n\\mu_B = E[y^{(e)} | \\text{Group B, avg age, sex } s] = \\beta_0 + \\beta_1(0) + \\beta_2(1) + \\beta_3(0) + \\beta_4 s = \\beta_0 + \\beta_2 + \\beta_4 s\n$$\n现在，零假设 $H_0: \\mu_A = \\mu_B$ 可以用参数写成：\n$$\nH_0: \\beta_0 + \\beta_1 + \\beta_4 s = \\beta_0 + \\beta_2 + \\beta_4 s\n$$\n这可以简化为：\n$$\nH_0: \\beta_1 = \\beta_2\n$$\n或者等价地，\n$$\nH_0: \\beta_1 - \\beta_2 = 0\n$$\n一个线性假设以 $c^T \\beta^{(e)} = 0$ 的形式表示，其中 $c$ 是对比向量。将我们的假设与此形式进行比较：\n$$\nc^T \\beta^{(e)} = c_0 \\beta_0 + c_1 \\beta_1 + c_2 \\beta_2 + c_3 \\beta_3 + c_4 \\beta_4 = 0\n$$\n我们需要这等价于 $1 \\cdot \\beta_1 + (-1) \\cdot \\beta_2 = 0$。通过匹配每个 $\\beta_j$ 的系数，我们找到对比向量 $c$ 的分量：\n$c_0 = 0$\n$c_1 = 1$\n$c_2 = -1$\n$c_3 = 0$\n$c_4 = 0$\n\n因此，写成行向量的对比向量是 $[0, 1, -1, 0, 0]$。该向量指定了参数估计的线性组合，在零假设下，该组合的和被检验是否为零。对比向量中元素的顺序必须与 $\\beta^{(e)}$ 中参数的顺序相匹配，后者由设计矩阵 $X$ 的列顺序决定：截距项、A组指示变量、B组指示变量、均值中心化的年龄、以及性别。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  1  -1  0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在为每个连接边建立了GLM模型后，下一步是推导出一个检验统计量来评估您的假设。本练习的核心是从普通最小二乘法的第一性原理出发，推导出用于检验特定线性假设的边级学生化t统计量。完成此练习将加深您对NBS中假设检验核心机制的理解，并阐明统计显著性是如何在单个连接水平上量化的。",
            "id": "4181109",
            "problem": "在用于连接组的基于网络的统计（NBS）假设检验中，研究者会跨被试计算一个边级检验统计量，然后应用成分水平的校正。考虑一个高等研究生水平的设置，有 $n$ 个被试和 $p$ 个回归量，其中每条边 $e$ 产生一个被试级响应向量 $y_e \\in \\mathbb{R}^n$。假设通用线性模型（GLM）为 $y_e = X \\beta_e + \\varepsilon_e$，其中设计矩阵 $X \\in \\mathbb{R}^{n \\times p}$ 是固定的、满列秩的，误差 $\\varepsilon_e \\sim \\mathcal{N}(0, \\sigma_e^2 I_n)$ 对于该边而言在被试间是独立同分布的。一个感兴趣的科学对比由向量 $c \\in \\mathbb{R}^p$ 编码，边 $e$ 的零假设为 $H_0: c^\\top \\beta_e = 0$。\n\n从GLM假设和普通最小二乘法出发，推导用于检验 $H_0: c^\\top \\beta_e = 0$ 的边级学生化检验统计量，并用 $X$ 和 $y_e$ 精确定义其组成量和它们的估计量。然后，确定以下哪个选项正确给出了最终表达式以及在NBS流程中实际计算它所需的所有定义。选择唯一最佳答案。\n\nA. $t_e = \\dfrac{c^\\top \\hat{\\beta}_e}{\\hat{\\sigma}_e \\sqrt{c^\\top (X^\\top X)^{-1} c}}$，其中 $\\hat{\\beta}_e = (X^\\top X)^{-1} X^\\top y_e$，$\\mathrm{RSS}_e = \\|y_e - X \\hat{\\beta}_e\\|_2^2$，$\\hat{\\sigma}_e^2 = \\dfrac{\\mathrm{RSS}_e}{n - p}$，且在 $H_0$ 下，统计量 $t_e$ 服从自由度为 $n - p$ 的学生t分布。\n\nB. $t_e = \\dfrac{c^\\top \\hat{\\beta}_e}{\\sqrt{\\hat{\\sigma}_e^2 \\, c^\\top (X X^\\top)^{-1} c}}$，其中 $\\hat{\\beta}_e = (X^\\top X)^{-1} X^\\top y_e$，$\\mathrm{RSS}_e = \\|y_e - X \\hat{\\beta}_e\\|_2^2$，$\\hat{\\sigma}_e^2 = \\dfrac{\\mathrm{RSS}_e}{n}$，且在 $H_0$ 下，统计量 $t_e$ 服从自由度为 $n$ 的学生t分布。\n\nC. $t_e = \\dfrac{\\mathbf{1}^\\top \\hat{\\beta}_e}{\\hat{\\sigma} \\sqrt{\\mathbf{1}^\\top (X^\\top X)^{-1} \\mathbf{1}}}$，其中 $\\hat{\\beta}_e = (X^\\top X)^{-1} X^\\top y_e$，且 $\\hat{\\sigma}^2$ 是通过聚合所有边的 $\\mathrm{RSS}_e$ 并除以 $n$ 来估计的合并方差；在 $H_0$ 下，统计量 $t_e$ 服从标准正态分布。\n\nD. $t_e = \\dfrac{c^\\top \\hat{\\beta}_e}{\\hat{s}_e}$，其中 $\\hat{s}_e^2 = \\dfrac{\\|y_e\\|_2^2}{n - p}$，方差估计中不依赖于 $X$；在 $H_0$ 下，统计量 $t_e$ 服从自由度为 $n - p$ 的学生t分布。",
            "solution": "用户希望我验证问题陈述，如果有效，则推导解决方案并评估给定的选项。\n\n### 问题验证\n\n我将首先根据指定程序验证问题陈述。\n\n**步骤1：提取已知条件**\n\n*   被试数量: $n$\n*   回归量数量: $p$\n*   边e的被试级响应向量: $y_e \\in \\mathbb{R}^n$\n*   通用线性模型 (GLM): $y_e = X \\beta_e + \\varepsilon_e$\n*   设计矩阵: $X \\in \\mathbb{R}^{n \\times p}$，固定的、满列秩\n*   误差分布: $\\varepsilon_e \\sim \\mathcal{N}(0, \\sigma_e^2 I_n)$，对于边e在被试间独立同分布 (i.i.d.)\n*   对比向量: $c \\in \\mathbb{R}^p$\n*   边e的零假设: $H_0: c^\\top \\beta_e = 0$\n\n**步骤2：使用提取的已知条件进行验证**\n\n1.  **科学依据：** 该问题牢固地植根于通用线性模型理论，这是包括神经科学在内的许多科学领域中统计分析的基石。其表述——使用设计矩阵、对比向量和假设检验——是分析功能性磁共振成像（fMRI）、脑电图/脑磁图（EEG/MEG）和结构连接组数据（如在NBS中）的标准实践。\n2.  **良态性：** 该问题是良态的。设计矩阵 $X$ 为满列秩的假设确保了矩阵 $X^\\top X$ 是可逆的，这对于找到参数的唯一普通最小二乘法（OLS）解是必要的。统计假设（独立同分布的高斯误差）为检验统计量导出了一个定义明确的分布理论。\n3.  **客观性：** 问题以精确、客观的数学和统计语言陈述，没有歧义或主观性陈述。\n\n**步骤3：结论与行动**\n\n问题陈述是有效的。它在科学上是合理的、良态的且客观的。它提供了从第一性原理推导所需检验统计量的所有必要信息。我现在将继续进行解的推导。\n\n### 解的推导\n\n目标是基于指定的GLM，推导用于检验零假设 $H_0: c^\\top \\beta_e = 0$ 的学生化检验统计量。\n\n**1. 参数 $\\beta_e$ 的估计**\n\n参数 $\\beta_e$ 使用普通最小二乘法（OLS）进行估计，该方法最小化残差平方和 $\\mathrm{RSS}_e = \\|y_e - X\\beta_e\\|_2^2$。OLS估计量 $\\hat{\\beta}_e$ 是正规方程组的解：\n$$ (X^\\top X) \\hat{\\beta}_e = X^\\top y_e $$\n由于 $X$ 是满列秩的，$X^\\top X$ 是一个 $p \\times p$ 的可逆矩阵。因此，估计量是唯一的：\n$$ \\hat{\\beta}_e = (X^\\top X)^{-1} X^\\top y_e $$\n\n**2. 估计量 $\\hat{\\beta}_e$ 的分布**\n\n估计量 $\\hat{\\beta}_e$ 是观测向量 $y_e$ 的线性变换。由于 $y_e$ 是正态分布的（$y_e \\sim \\mathcal{N}(X\\beta_e, \\sigma_e^2 I_n)$），$\\hat{\\beta}_e$ 也是正态分布的。\n*   **均值：**\n    $E[\\hat{\\beta}_e] = E[(X^\\top X)^{-1} X^\\top y_e] = (X^\\top X)^{-1} X^\\top E[y_e] = (X^\\top X)^{-1} X^\\top (X\\beta_e) = \\beta_e$。\n    估计量是无偏的。\n*   **方差-协方差：**\n    $\\mathrm{Var}(\\hat{\\beta}_e) = \\mathrm{Var}((X^\\top X)^{-1} X^\\top y_e) = ((X^\\top X)^{-1} X^\\top) \\mathrm{Var}(y_e) ((X^\\top X)^{-1} X^\\top)^\\top$\n    $= (X^\\top X)^{-1} X^\\top (\\sigma_e^2 I_n) X (X^\\top X)^{-1} = \\sigma_e^2 (X^\\top X)^{-1} (X^\\top X) (X^\\top X)^{-1} = \\sigma_e^2 (X^\\top X)^{-1}$。\n所以，估计量的分布为 $\\hat{\\beta}_e \\sim \\mathcal{N}(\\beta_e, \\sigma_e^2 (X^\\top X)^{-1})$。\n\n**3. 对比估计 $c^\\top \\hat{\\beta}_e$ 的分布**\n\n感兴趣的量 $c^\\top \\beta_e$ 由 $c^\\top \\hat{\\beta}_e$ 估计。作为多元正态变量 $\\hat{\\beta}_e$ 各分量的线性组合，它也是正态分布的。\n*   **均值：** $E[c^\\top \\hat{\\beta}_e] = c^\\top E[\\hat{\\beta}_e] = c^\\top \\beta_e$。\n*   **方差：** $\\mathrm{Var}(c^\\top \\hat{\\beta}_e) = c^\\top \\mathrm{Var}(\\hat{\\beta}_e) c = c^\\top (\\sigma_e^2 (X^\\top X)^{-1}) c = \\sigma_e^2 c^\\top (X^\\top X)^{-1} c$。\n\n在零假设 $H_0: c^\\top \\beta_e = 0$ 下，我们有 $E[c^\\top \\hat{\\beta}_e] = 0$。其分布为：\n$$ c^\\top \\hat{\\beta}_e \\sim \\mathcal{N}(0, \\sigma_e^2 c^\\top (X^\\top X)^{-1} c) \\quad (\\text{在 } H_0 \\text{ 下}) $$\n\n**4. 误差方差 $\\sigma_e^2$ 的估计**\n\n误差方差 $\\sigma_e^2$ 是未知的，必须从数据中估计。$\\sigma_e^2$ 的标准无偏估计量由残差平方和（$\\mathrm{RSS}_e$）导出：\n$$ \\mathrm{RSS}_e = \\|y_e - X\\hat{\\beta}_e\\|_2^2 $$\n误差的自由度是观测数量（$n$）减去 $\\beta_e$ 中估计参数的数量（$p$），即 $df = n-p$。$\\sigma_e^2$ 的无偏估计量是：\n$$ \\hat{\\sigma}_e^2 = \\frac{\\mathrm{RSS}_e}{n - p} $$\n根据线性模型理论的一个已知结果，$\\frac{(n-p)\\hat{\\sigma}_e^2}{\\sigma_e^2} = \\frac{\\mathrm{RSS}_e}{\\sigma_e^2}$ 服从自由度为 $n-p$ 的卡方分布，即 $\\chi_{n-p}^2$。此外，$\\hat{\\sigma}_e^2$ 与 $\\hat{\\beta}_e$ 在统计上是独立的。\n\n**5. 学生t统计量的构建**\n\n一个服从学生t分布的随机变量是由一个标准正态变量与一个独立的、除以其自由度的卡方变量的平方根之比构成的。\n让我们在 $H_0$ 下定义一个标准正态变量 $Z$：\n$$ Z = \\frac{c^\\top \\hat{\\beta}_e - E[c^\\top \\hat{\\beta}_e]}{\\sqrt{\\mathrm{Var}(c^\\top \\hat{\\beta}_e)}} = \\frac{c^\\top \\hat{\\beta}_e}{\\sigma_e \\sqrt{c^\\top (X^\\top X)^{-1} c}} \\sim \\mathcal{N}(0, 1) $$\n以及一个独立的、除以其自由度的卡方变量 $V$：\n$$ V = \\frac{\\hat{\\sigma}_e^2}{\\sigma_e^2} = \\frac{\\mathrm{RSS}_e / (n-p)}{\\sigma_e^2} \\sim \\frac{\\chi_{n-p}^2}{n-p} $$\nt统计量为 $t_e = Z / \\sqrt{V}$：\n$$ t_e = \\frac{ \\frac{c^\\top \\hat{\\beta}_e}{\\sigma_e \\sqrt{c^\\top (X^\\top X)^{-1} c}} }{ \\sqrt{\\frac{\\hat{\\sigma}_e^2}{\\sigma_e^2}} } = \\frac{ \\frac{c^\\top \\hat{\\beta}_e}{\\sigma_e \\sqrt{c^\\top (X^\\top X)^{-1} c}} }{ \\frac{\\hat{\\sigma}_e}{\\sigma_e} } = \\frac{c^\\top \\hat{\\beta}_e}{\\hat{\\sigma}_e \\sqrt{c^\\top (X^\\top X)^{-1} c}} $$\n该统计量在 $H_0$ 下服从自由度为 $n-p$ 的学生t分布。\n\n### 逐项分析选项\n\n*   **选项 A**: $t_e = \\dfrac{c^\\top \\hat{\\beta}_e}{\\hat{\\sigma}_e \\sqrt{c^\\top (X^\\top X)^{-1} c}}$，其中 $\\hat{\\beta}_e = (X^\\top X)^{-1} X^\\top y_e$，$\\mathrm{RSS}_e = \\|y_e - X \\hat{\\beta}_e\\|_2^2$，$\\hat{\\sigma}_e^2 = \\dfrac{\\mathrm{RSS}_e}{n - p}$，且在 $H_0$ 下，统计量 $t_e$ 服从自由度为 $n - p$ 的学生t分布。\n\n    该选项正确陈述了 $t$-统计量的公式。它正确定义了 OLS 估计量 $\\hat{\\beta}_e$。它正确定义了残差平方和 $\\mathrm{RSS}_e$ 和误差方差的无偏估计量 $\\hat{\\sigma}_e^2$，使用了正确的自由度 $n-p$。最后，它正确地指出了在零假设下该统计量的分布为自由度是 $n-p$ 的学生t分布。所有组成部分都是正确的。\n    **结论：正确。**\n\n*   **选项 B**: $t_e = \\dfrac{c^\\top \\hat{\\beta}_e}{\\sqrt{\\hat{\\sigma}_e^2 \\, c^\\top (X X^\\top)^{-1} c}}$，其中 $\\hat{\\beta}_e = (X^\\top X)^{-1} X^\\top y_e$，$\\mathrm{RSS}_e = \\|y_e - X \\hat{\\beta}_e\\|_2^2$，$\\hat{\\sigma}_e^2 = \\dfrac{\\mathrm{RSS}_e}{n}$，且在 $H_0$ 下，统计量 $t_e$ 服从自由度为 $n$ 的学生t分布。\n\n    该选项包含多个错误。\n    1. 分母使用了 $(X X^\\top)^{-1}$ 而不是 $(X^\\top X)^{-1}$。$X X^\\top$ 是一个 $n \\times n$ 矩阵，在通常 $n  p$ 的情况下是不可逆的。即使可逆，其维度也无法与 $p$ 维的对比向量 $c$ 进行正确的乘法运算。\n    2. 方差的估计量是 $\\hat{\\sigma}_e^2 = \\dfrac{\\mathrm{RSS}_e}{n}$。这是有偏的最大似然估计量，而不是用于 $t$-统计量的无偏估计量。\n    3. t分布的自由度被陈述为 $n$，这是不正确的。正确的自由度是 $n-p$。\n    **结论：不正确。**\n\n*   **选项 C**: $t_e = \\dfrac{\\mathbf{1}^\\top \\hat{\\beta}_e}{\\hat{\\sigma} \\sqrt{\\mathbf{1}^\\top (X^\\top X)^{-1} \\mathbf{1}}}$，其中 $\\hat{\\beta}_e = (X^\\top X)^{-1} X^\\top y_e$，且 $\\hat{\\sigma}^2$ 是通过聚合所有边的 $\\mathrm{RSS}_e$ 并除以 $n$ 来估计的合并方差；在 $H_0$ 下，统计量 $t_e$ 服从标准正态分布。\n\n    该选项包含多个错误。\n    1. 它用全1向量 $\\mathbf{1}$ 替换了一般的对比向量 $c$。这是一个特定的对比，检验的是 $H_0: \\sum_{i=1}^p \\beta_{ei} = 0$，而不是一般的假设 $H_0: c^\\top \\beta_e = 0$。\n    2. 它使用了一个跨所有边估计的合并方差 $\\hat{\\sigma}^2$。问题定义的模型具有边特定的方差 $\\sigma_e^2$，因此合并方差不属于指定模型的一部分。\n    3. 它声称该统计量服从标准正态分布。对于方差被估计的有限样本量 $n$，其分布是学生t分布，而非正态分布。\n    **结论：不正确。**\n\n*   **选项 D**: $t_e = \\dfrac{c^\\top \\hat{\\beta}_e}{\\hat{s}_e}$，其中 $\\hat{s}_e^2 = \\dfrac{\\|y_e\\|_2^2}{n - p}$，方差估计中不依赖于 $X$；在 $H_0$ 下，统计量 $t_e$ 服从自由度为 $n - p$ 的学生t分布。\n\n    该选项不正确，因为它错误地指定了分子的标准误。$t$-统计量的分母应该是 $c^\\top \\hat{\\beta}_e$ 的估计标准差，即 $\\sqrt{\\hat{\\sigma}_e^2 c^\\top(X^\\top X)^{-1}c}$。所提出的量 $\\hat{s}_e^2 = \\dfrac{\\|y_e\\|_2^2}{n-p}$ 是数据 $y_e$ 总方差的估计（除以 $n-p$），而不是所估计对比的方差。它错误地使用了总平方和 $\\|y_e\\|_2^2$ 而不是残差平方和，并且完全忽略了关键项 $c^\\top (X^\\top X)^{-1} c$，该项解释了设计和所检验的特定对比。\n    **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "NBS的关键创新之处在于它将分析从单个连接边转移到了连接组件的层面。本练习聚焦于NBS流程中的一个关键计算步骤：在通过主阈值筛选出超阈值连接后，如何高效地识别出这些连接所形成的连通组件。您将探索一种基于并查集数据结构的经典算法，并分析其计算效率，这对于处理大规模连接组成像数据至关重要。",
            "id": "4181097",
            "problem": "您正在使用基于网络的统计 (Network-Based Statistic, NBS) 方法分析功能连接组数据，该方法通过对边级检验统计量设置一个主阈值来诱导生成一个图，并识别图中超阈值边的连通分量。假设有 $V$ 个感兴趣区域 (ROI)，以及一个无向无自环图 $G=(\\mathcal{V}, \\mathcal{E}_{\\tau})$，其中 $\\lvert \\mathcal{V} \\rvert = V$，$\\mathcal{E}_{\\tau} = \\{ (i,j) : i \\neq j,\\, T_{ij} \\ge \\tau \\}$ 表示在检验统计量矩阵上以水平 $\\tau$ 进行阈值化后得到的超阈值边的集合。设 $E = \\lvert \\mathcal{E}_{\\tau} \\rvert$。NBS 的每次置换中的目标是提取 $G$ 的所有连通分量，以便计算分量级统计量（例如，最大分量大小）。假设采用标准的随机存取机器计算模型，并且 $\\mathcal{E}_{\\tau}$ 以无序顶点对列表的形式给出。\n\n请选择一个选项，该选项既概述了在 NBS 这一步骤中提取连通分量的正确且高效的不相交集并（并查集）方法，又给出了关于 $E$ 和 $V$ 的正确的摊销时间复杂度紧界。\n\nA. 为 $V$ 个顶点中的每一个初始化一个不相交集数据结构，每个集合为单例集。对于每个超阈值边 $(i,j) \\in \\mathcal{E}_{\\tau}$，使用按秩合并和路径压缩，对包含 $i$ 和 $j$ 的集合执行合并操作。处理完所有边后，遍历所有顶点一次，应用查找操作以获取每个顶点的代表元，并按代表元对顶点进行分组以产生分量。所有操作的摊销运行时间为 $O\\big((E+V)\\,\\alpha(V)\\big)$，其中 $\\alpha(\\cdot)$ 是反阿克曼函数，当 $E \\ge V$ 时，可简化为 $O\\big(E\\,\\alpha(V)\\big)$。\n\nB. 为超阈值图构建一个邻接表，并从每个未访问过的顶点开始运行深度优先搜索 (DFS) 来标记分量，该算法的运行时间为 $O(E+V)$。这严格快于任何并查集方法，因此是 NBS 中的首选方法。\n\nC. 使用一个既不带按秩合并也不带路径压缩的不相交集结构。对于每个超阈值边，对其端点执行合并操作。最后，遍历所有顶点并应用查找操作来标记分量。摊销运行时间为 $O\\big(E \\log V\\big)$。\n\nD. 按检验统计量值对超阈值边进行排序，然后运行 Kruskal 式扫描，在此过程中合并端点；排序步骤导致总体复杂度为 $O\\big(E \\log E\\big)$，这在该场景下是提取连通分量的最优方法，并且在 NBS 中使用时对于保证正确性是必要的。",
            "solution": "该问题要求选择一个选项，该选项能正确描述一种使用不相交集并 (Disjoint-Set Union, DSU) 或并查集 (union-find) 算法来寻找图的连通分量的高效方法，并为该任务提供正确的时间复杂度。其背景是神经科学中基于网络的统计 (NBS) 方法的一个特定步骤，在该步骤中，通过对一个检验统计量矩阵进行阈值化，形成一个图 $G=(\\mathcal{V}, \\mathcal{E}_{\\tau})$。该图有 $V = \\lvert \\mathcal{V} \\rvert$ 个顶点和 $E = \\lvert \\mathcal{E}_{\\tau} \\rvert$ 条边，输入以这 $E$ 条边的列表形式给出。\n\n首先，我们来确定使用不相交集并数据结构寻找连通分量的最有效方法。\n\nDSU 数据结构维护一个不相交集合的集合。其三个主要操作是：\n1. `MAKESET(x)`：创建一个只包含元素 $x$ 的新集合。\n2. `FIND(x)`：返回包含 $x$ 的集合的代表（或根）。\n3. `UNION(x, y)`：合并包含 $x$ 和 $y$ 的两个集合。\n\n寻找一个有 $V$ 个顶点和包含 $E$ 条边的边列表的图的连通分量的算法如下：\n1. 通过为 $V$ 个顶点中的每一个创建一个单例集来初始化 DSU 数据结构。这需要 $V$ 次调用 `MAKESET`。\n2. 遍历 $E$ 条边。对于每条边 $(u, v)$：\n    a. 通过比较它们的代表来检查 $u$ 和 $v$ 是否已在同一分量中：`FIND(u) == FIND(v)`。\n    b. 如果不在，则合并它们的集合：`UNION(u, v)`。\n3. 处理完所有 $E$ 条边后，所有属于同一连通分量的顶点都将在 DSU 结构中的同一个集合内。要明确地获取这些分量，可以遍历所有 $V$ 个顶点，并使用 `FIND` 操作找到它们的集合代表，然后按代表对它们进行分组。\n\n该算法的时间复杂度取决于 `UNION` 和 `FIND` 操作的实现。最高效的实现使用了两种启发式方法：\n- **按大小或按秩合并 (Union by size or rank)**：在合并两个集合时，将代表较小集合的树的根附加到代表较大集合的树的根上。这可以防止树变得不必要地深。\n- **路径压缩 (Path compression)**：在执行 `FIND(x)` 操作时，将从 $x$ 到根路径上的每个节点都直接变为根的子节点。这会随着时间的推移使树结构扁平化。\n\n当同时使用按秩/大小合并和路径压缩时，对 $n$ 个元素执行 $m$ 次操作序列的摊销时间复杂度为 $O(m \\, \\alpha(n))$，其中 $\\alpha(n)$ 是反阿克曼函数。函数 $\\alpha(n)$ 增长极其缓慢；对于任何实际的 $n$ 值，$\\alpha(n)  5$。\n\n在我们具体的问题中：\n- 元素数量为 $n = V$。\n- 我们执行 $V$ 次 `MAKESET` 操作进行初始化。\n- 我们处理 $E$ 条边，这涉及 $E$ 对 `FIND` 操作和至多 $E-1$ 次 `UNION` 操作。这大约相当于 $3E$ 次操作。\n- 最后，为了明确列出分量，我们执行 $V$ 次 `FIND` 操作。\n- 因此，总操作次数 $m$ 的量级为 $V + 3E + V$，即 $O(E+V)$。\n\n将这些代入通用复杂度公式，总摊销时间为 $O\\big((E+V)\\,\\alpha(V)\\big)$。在许多连接组学应用中，图并不会极其稀疏，因此通常有 $E \\ge V$。在这种情况下，$E$ 项占主导地位，复杂度可以简化为 $O\\big(E\\,\\alpha(V)\\big)$。\n\n现在我们评估每个选项。\n\n**A. 为 $V$ 个顶点中的每一个初始化一个不相交集数据结构，每个集合为单例集。对于每个超阈值边 $(i,j) \\in \\mathcal{E}_{\\tau}$，使用按秩合并和路径压缩，对包含 $i$ 和 $j$ 的集合执行合并操作。处理完所有边后，遍历所有顶点一次，应用查找操作以获取每个顶点的代表元，并按代表元对顶点进行分组以产生分量。所有操作的摊销运行时间为 $O\\big((E+V)\\,\\alpha(V)\\big)$，其中 $\\alpha(\\cdot)$ 是反阿克曼函数，当 $E \\ge V$ 时，可简化为 $O\\big(E\\,\\alpha(V)\\big)$。**\n\n该选项精确地描述了最优的不相交集并算法。\n- 过程描述是正确的：初始化 $V$ 个集合，使用 `UNION`（依赖于 `FIND`）处理 $E$ 条边，然后通过遍历顶点并使用 `FIND` 来最终确定分量结构。\n- 它正确地指出了使用“按秩合并和路径压缩”是关键的优化。\n- 所述的摊销时间复杂度 $O\\big((E+V)\\,\\alpha(V)\\big)$ 是该过程的正确紧界。\n- 在合理条件 $E \\ge V$ 下简化为 $O\\big(E\\,\\alpha(V)\\big)$ 也是正确的。\n**结论：正确。**\n\n**B. 为超阈值图构建一个邻接表，并从每个未访问过的顶点开始运行深度优先搜索 (DFS) 来标记分量，该算法的运行时间为 $O(E+V)$。这严格快于任何并查集方法，因此是 NBS 中的首选方法。**\n\n该选项描述了另一种寻找连通分量的算法（DFS/BFS）。对 DFS 算法及其时间复杂度 $O(E+V)$ 的描述是正确的。然而，问题陈述明确要求选择一个概述**不相交集并（并查集）方法**的选项。此选项描述的是一种完全不同的方法。此外，声称 DFS “严格更快”在渐进意义上是技术上正确的，因为对于 $V2$，$\\alpha(V)  1$，但从实际应用来看，两者性能相当，而声称其“因此是首选方法”是一种主观判断，而非正式的事实陈述。因为它没有描述并查集方法，所以它未能回答问题。\n**结论：不正确。**\n\n**C. 使用一个既不带按秩合并也不带路径压缩的不相交集结构。对于每个超阈值边，对其端点执行合并操作。最后，遍历所有顶点并应用查找操作来标记分量。摊销运行时间为 $O\\big(E \\log V\\big)$。**\n\n该选项描述了 DSU 算法的一种朴素实现，明确指出“既不带按秩合并也不带路径压缩”。在这种情况下，数据结构可能退化为链表，其中一次 `FIND` 操作在最坏情况下可能需要 $O(V)$ 时间。因此，处理 $E$ 条边的步骤序列最多可能需要 $O(EV)$ 时间。所述的 $O(E \\log V)$ 复杂度对于这种朴素实现是不正确的；它对应于一种使用按秩合并*或*路径压缩，但非两者皆用，也非两者皆不用的实现。\n**结论：不正确。**\n\n**D. 按检验统计量值对超阈值边进行排序，然后运行 Kruskal 式扫描，在此过程中合并端点；排序步骤导致总体复杂度为 $O\\big(E \\log E\\big)$，这在该场景下是提取连通分量的最优方法，并且在 NBS 中使用时对于保证正确性是必要的。**\n\n该选项引入了一个不必要且计算成本高昂的步骤：对边进行排序。问题是在由*单一、固定阈值* $\\tau$ 定义的图 $G$ 上寻找连通分量。对于这个任务，$\\mathcal{E}_{\\tau}$ 中的所有边都是等价的；它们原始的检验统计量值与图的拓扑无关。排序步骤需要 $O(E \\log E)$ 时间，这是不必要的。声称这是“最优的”是错误的，因为选项 A 中的 DSU 方法（$O((E+V)\\alpha(V))$）和选项 B 中的 DFS 方法（$O(E+V)$）都比 $O(E \\log E)$ 快。声称其“对于保证正确性是必要的”也是错误的。这个过程模仿了用于寻找最小生成树的 Kruskal 算法，但这并不是当前要解决的问题。\n**结论：不正确。**\n\n基于以上分析，只有选项 A 对所指定问题的高效 DSU 算法及其相应的紧密时间复杂度给出了正确的描述。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}