{
    "hands_on_practices": [
        {
            "introduction": "Understanding a new mathematical tool begins with applying it to a simple case. This first exercise grounds the abstract definitions of Phase-Locking Value ($PLV$) and Pairwise Phase Consistency ($PPC$) in a concrete calculation. By working through a small, well-defined set of phases, you will not only compute these values from scratch but also derive the fundamental algebraic identity that connects them, solidifying your conceptual grasp of how these two important measures relate .",
            "id": "4185608",
            "problem": "You are analyzing phase-locking between neuronal events and a local field potential at a fixed time-frequency point. You are given a set of phase observations in radians, denoted by $\\{\\phi_{k}\\}_{k=1}^{N}$ with $N=4$ and $\\phi=\\{0,\\pi/2,\\pi,3\\pi/2\\}$. Using only fundamental definitions from circular statistics and complex analysis, proceed as follows:\n\n1. Treat each phase as the argument of a unit-norm complex number $z_{k}=\\exp(i\\,\\phi_{k})$, where $i$ is the imaginary unit and $|z_{k}|=1$.\n2. Define the mean resultant vector $R=\\frac{1}{N}\\sum_{k=1}^{N} z_{k}$ and the Phase-Locking Value (PLV) as $|R|$.\n3. Define the Pairwise Phase Consistency (PPC) as the mean cosine of all unique pairwise phase differences,\n$$\n\\mathrm{PPC}=\\frac{2}{N(N-1)}\\sum_{1\\leq k\\ell\\leq N}\\cos\\!\\big(\\phi_{k}-\\phi_{\\ell}\\big).\n$$\n\nStarting from these definitions and standard algebraic properties of complex numbers, first compute $\\mathrm{PLV}$ and $\\mathrm{PPC}$ for the given phase set. Then, use these results to verify, by explicit derivation and numerical evaluation for the provided phases, the algebraic relationship between $\\mathrm{PLV}$ and $\\mathrm{PPC}$ that follows from these definitions.\n\nFinally, report the scalar\n$$\nS \\equiv |\\,\\mathrm{PLV}\\,|^{2}-\\frac{1}{N}-\\frac{N-1}{N}\\,\\mathrm{PPC}\n$$\nfor the given $\\phi$ in radians. Your final answer must be a single real number. Angles are in radians. No units are required for the final answer.",
            "solution": "The problem statement has been meticulously validated and is determined to be scientifically grounded, well-posed, objective, and self-contained. It presents a valid theoretical exercise in the analysis of phase data using established metrics from neuroscience and circular statistics. All necessary definitions and data are provided, and no contradictions or ambiguities are present. We may therefore proceed with a full solution.\n\nThe problem requires a three-part analysis: first, the computation of the Phase-Locking Value (PLV) and Pairwise Phase Consistency (PPC) for a given set of phases; second, the derivation of a general algebraic relationship between these two quantities; and third, the use of these results to compute a final scalar value, $S$.\n\nWe are given $N=4$ phase observations: $\\phi_1 = 0$, $\\phi_2 = \\frac{\\pi}{2}$, $\\phi_3 = \\pi$, and $\\phi_4 = \\frac{3\\pi}{2}$.\n\n**1. Computation of Phase-Locking Value (PLV)**\n\nThe first step is to represent each phase angle $\\phi_k$ as a unit-norm complex number $z_k = \\exp(i\\phi_k)$.\nFor the given phases:\n$$\nz_1 = \\exp(i \\cdot 0) = \\cos(0) + i\\sin(0) = 1\n$$\n$$\nz_2 = \\exp\\left(i \\frac{\\pi}{2}\\right) = \\cos\\left(\\frac{\\pi}{2}\\right) + i\\sin\\left(\\frac{\\pi}{2}\\right) = i\n$$\n$$\nz_3 = \\exp(i\\pi) = \\cos(\\pi) + i\\sin(\\pi) = -1\n$$\n$$\nz_4 = \\exp\\left(i \\frac{3\\pi}{2}\\right) = \\cos\\left(\\frac{3\\pi}{2}\\right) + i\\sin\\left(\\frac{3\\pi}{2}\\right) = -i\n$$\nThe mean resultant vector $R$ is defined as the average of these complex numbers:\n$$\nR = \\frac{1}{N} \\sum_{k=1}^{N} z_k = \\frac{1}{4} (z_1 + z_2 + z_3 + z_4)\n$$\nSubstituting the values of $z_k$:\n$$\nR = \\frac{1}{4} (1 + i - 1 - i) = \\frac{1}{4} (0) = 0\n$$\nThe Phase-Locking Value (PLV) is the magnitude of the mean resultant vector, $|R|$.\n$$\n\\mathrm{PLV} = |R| = |0| = 0\n$$\n\n**2. Computation of Pairwise Phase Consistency (PPC)**\n\nThe PPC is defined as the mean cosine of all unique pairwise phase differences. For $N=4$, there are $\\binom{4}{2} = \\frac{4(3)}{2} = 6$ unique pairs $(k, \\ell)$ with $1 \\le k  \\ell \\le 4$.\nThe formula for PPC is:\n$$\n\\mathrm{PPC} = \\frac{2}{N(N-1)} \\sum_{1\\leq k\\ell\\leq N} \\cos(\\phi_k - \\phi_\\ell) = \\frac{2}{4(3)} \\sum_{1\\leq k\\ell\\leq 4} \\cos(\\phi_k - \\phi_\\ell) = \\frac{1}{6} \\sum_{1\\leq k\\ell\\leq 4} \\cos(\\phi_k - \\phi_\\ell)\n$$\nWe compute the arguments of the cosine terms for all 6 pairs:\n\\begin{itemize}\n    \\item $\\phi_1 - \\phi_2 = 0 - \\frac{\\pi}{2} = -\\frac{\\pi}{2} \\implies \\cos\\left(-\\frac{\\pi}{2}\\right) = 0$\n    \\item $\\phi_1 - \\phi_3 = 0 - \\pi = -\\pi \\implies \\cos(-\\pi) = -1$\n    \\item $\\phi_1 - \\phi_4 = 0 - \\frac{3\\pi}{2} = -\\frac{3\\pi}{2} \\implies \\cos\\left(-\\frac{3\\pi}{2}\\right) = 0$\n    \\item $\\phi_2 - \\phi_3 = \\frac{\\pi}{2} - \\pi = -\\frac{\\pi}{2} \\implies \\cos\\left(-\\frac{\\pi}{2}\\right) = 0$\n    \\item $\\phi_2 - \\phi_4 = \\frac{\\pi}{2} - \\frac{3\\pi}{2} = -\\pi \\implies \\cos(-\\pi) = -1$\n    \\item $\\phi_3 - \\phi_4 = \\pi - \\frac{3\\pi}{2} = -\\frac{\\pi}{2} \\implies \\cos\\left(-\\frac{\\pi}{2}\\right) = 0$\n\\end{itemize}\nThe sum of these cosine values is:\n$$\n\\sum_{1\\leq k\\ell\\leq 4} \\cos(\\phi_k - \\phi_\\ell) = 0 + (-1) + 0 + 0 + (-1) + 0 = -2\n$$\nNow, we can compute the PPC:\n$$\n\\mathrm{PPC} = \\frac{1}{6} (-2) = -\\frac{1}{3}\n$$\n\n**3. Derivation of the Algebraic Relationship and Calculation of $S$**\n\nThe problem asks to derive the algebraic relationship between PLV and PPC to verify the value of $S$. Let's start with the definition of the squared PLV, $|\\mathrm{PLV}|^2 = |R|^2$.\n$$\n|\\mathrm{PLV}|^2 = |R|^2 = R \\cdot R^* = \\left(\\frac{1}{N} \\sum_{k=1}^{N} z_k\\right) \\left(\\frac{1}{N} \\sum_{\\ell=1}^{N} z_\\ell^*\\right) = \\frac{1}{N^2} \\sum_{k=1}^{N} \\sum_{\\ell=1}^{N} z_k z_\\ell^*\n$$\nwhere $z_\\ell^* = \\exp(-i\\phi_\\ell)$ is the complex conjugate of $z_\\ell$. The double summation can be split into terms where $k=\\ell$ and terms where $k \\neq \\ell$:\n$$\n\\sum_{k=1}^{N} \\sum_{\\ell=1}^{N} z_k z_\\ell^* = \\sum_{k=1}^{N} z_k z_k^* + \\sum_{k \\neq \\ell} z_k z_\\ell^*\n$$\nFor the diagonal terms ($k=\\ell$), we have $z_k z_k^* = |z_k|^2$. Since $|z_k|=1$, this product is $1$. The sum is $\\sum_{k=1}^{N} 1 = N$.\n\nFor the off-diagonal terms ($k \\neq \\ell$), we have a sum over $N(N-1)$ pairs. We can group these into pairs $(k, \\ell)$ and $(\\ell, k)$ and rewrite the sum over unique pairs where $k  \\ell$:\n$$\n\\sum_{k \\neq \\ell} z_k z_\\ell^* = \\sum_{1 \\le k  \\ell \\le N} (z_k z_\\ell^* + z_\\ell z_k^*)\n$$\nWe use the fact that $z_k z_\\ell^* = \\exp(i(\\phi_k - \\phi_\\ell))$ and $z_\\ell z_k^* = \\exp(i(\\phi_\\ell - \\phi_k)) = (z_k z_\\ell^*)^*$. The sum of a complex number and its conjugate is $z+z^* = 2\\operatorname{Re}(z)$.\n$$\nz_k z_\\ell^* + z_\\ell z_k^* = 2\\operatorname{Re}(z_k z_\\ell^*) = 2\\operatorname{Re}(\\exp(i(\\phi_k - \\phi_\\ell))) = 2\\cos(\\phi_k - \\phi_\\ell)\n$$\nThus, the sum of off-diagonal terms is:\n$$\n\\sum_{k \\neq \\ell} z_k z_\\ell^* = \\sum_{1 \\le k  \\ell \\le N} 2\\cos(\\phi_k - \\phi_\\ell)\n$$\nSubstituting these results back into the expression for $|\\mathrm{PLV}|^2$:\n$$\n|\\mathrm{PLV}|^2 = \\frac{1}{N^2} \\left( N + \\sum_{1 \\le k  \\ell \\le N} 2\\cos(\\phi_k - \\phi_\\ell) \\right) = \\frac{1}{N} + \\frac{2}{N^2} \\sum_{1 \\le k  \\ell \\le N} \\cos(\\phi_k - \\phi_\\ell)\n$$\nFrom the definition of PPC, we can express the sum of cosines as:\n$$\n\\sum_{1 \\le k  \\ell \\le N} \\cos(\\phi_k - \\phi_\\ell) = \\frac{N(N-1)}{2} \\mathrm{PPC}\n$$\nSubstituting this into the equation for $|\\mathrm{PLV}|^2$:\n$$\n|\\mathrm{PLV}|^2 = \\frac{1}{N} + \\frac{2}{N^2} \\left( \\frac{N(N-1)}{2} \\mathrm{PPC} \\right) = \\frac{1}{N} + \\frac{N-1}{N} \\mathrm{PPC}\n$$\nThis is the general algebraic relationship between $|\\mathrm{PLV}|^2$ and $\\mathrm{PPC}$. Rearranging this equation gives:\n$$\n|\\mathrm{PLV}|^2 - \\frac{1}{N} - \\frac{N-1}{N} \\mathrm{PPC} = 0\n$$\nThe scalar $S$ is defined as the left-hand side of this equation:\n$$\nS \\equiv |\\mathrm{PLV}|^2 - \\frac{1}{N} - \\frac{N-1}{N} \\mathrm{PPC}\n$$\nTherefore, $S$ must be identically equal to $0$ for any set of phases, as a matter of algebraic identity.\n\nTo fulfill the problem's requirement, we explicitly verify this using our computed values for the given phase set: $N=4$, $\\mathrm{PLV}=0$, and $\\mathrm{PPC}=-\\frac{1}{3}$.\n$$\nS = (0)^2 - \\frac{1}{4} - \\frac{4-1}{4} \\left(-\\frac{1}{3}\\right)\n$$\n$$\nS = 0 - \\frac{1}{4} - \\frac{3}{4} \\left(-\\frac{1}{3}\\right)\n$$\n$$\nS = -\\frac{1}{4} + \\frac{3}{12} = -\\frac{1}{4} + \\frac{1}{4} = 0\n$$\nThe numerical evaluation confirms the result of the general derivation. The value of the scalar $S$ is $0$.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Theoretical knowledge becomes practical skill through implementation. In modern data analysis, efficiency is key, especially when dealing with large neural datasets. This exercise challenges you to translate the mathematical definitions of $PLV$ and $PPC$ into efficient, vectorized code, leveraging the algebraic shortcut for $PPC$ to avoid computationally expensive loops . Mastering this practice is essential for applying phase synchrony analysis to real-world, time-resolved data.",
            "id": "4185679",
            "problem": "You are given the task of implementing a vectorized computation of the time-resolved Phase-Locking Value (PLV) and Pairwise Phase Consistency (PPC) across trials and time samples using complex arrays constructed from unit-length phase vectors. In neuroscience data analysis, the instantaneous phase of an analytic signal is a core representation for oscillatory neural time series, and trial-wise synchronization can be assessed from these phase representations. The goal is to compute $PLV(t)$ and $PPC(t)$ for each time sample $t$ by aggregating across trials using only linear algebra operations on complex arrays of unit vectors.\n\nThe foundational base you must use is:\n- For each trial $n$ and time sample $t$, define the unit-length complex representation of phase as $z_n(t) = e^{i\\phi_n(t)}$, where $\\phi_n(t)$ is the instantaneous phase in radians, and $i$ is the imaginary unit. Assume $|z_n(t)| = 1$ for all $n,t$.\n- The Phase-Locking Value (PLV) is the synchronization magnitude across trials at each time sample computed from the complex vectors $z_n(t)$.\n- The Pairwise Phase Consistency (PPC) is the average over all unordered trial pairs of the cosine of phase differences at each time sample computed from the complex vectors $z_n(t)$.\n\nYour program must:\n- Construct, for each test case, a complex array $Z \\in \\mathbb{C}^{N \\times T}$ with entries $Z_{n,t} = e^{i\\phi_n(t)}$, where $N$ is the number of trials and $T$ the number of time samples.\n- Use only vectorized linear algebra operations on $Z$ to compute the time-resolved $PLV(t)$ and unbiased $PPC(t)$ for all $t$ without explicit Python loops over time samples. Angles must be treated in radians.\n- Handle the case where $N \\geq 2$ for unbiased $PPC(t)$; if $N  2$, define $PPC(t)$ as not-a-number for all $t$.\n\nTest suite and array construction details (angles are in radians):\n- Test case $1$ (coherent identical phases, happy path):\n  - Trials $N = 8$, time samples $T = 5$.\n  - Phases identical across trials with a base vector $\\phi(t) = [0, 0.5, 1.0, 1.5, 2.0]$ for $t = 1, \\dots, T$.\n  - Construct $Z$ by repeating $e^{i\\phi(t)}$ across $N$ trials.\n- Test case $2$ (boundary antiphase pairing):\n  - Trials $N = 2$, time samples $T = 4$.\n  - Trial $1$ phases $\\phi_1(t) = [0, 0.25, 0.5, 0.75]$ for $t = 1, \\dots, T$.\n  - Trial $2$ phases $\\phi_2(t) = \\phi_1(t) + \\pi$ for all $t$.\n  - Construct $Z$ with these two trials.\n- Test case $3$ (uniformly random, low synchronization):\n  - Trials $N = 50$, time samples $T = 100$.\n  - Phases $\\phi_n(t)$ are independently sampled from a uniform distribution on $[-\\pi, \\pi]$ using a pseudorandom generator with seed $123$.\n  - Construct $Z$ from these random phases.\n- Test case $4$ (intermediate coherence via circular noise):\n  - Trials $N = 40$, time samples $T = 60$.\n  - Define a deterministic baseline phase series $\\theta(t) = \\sin(0.1 \\cdot t)$ for $t = 0, 1, \\dots, T-1$.\n  - Add trial-wise circular noise sampled from the von Mises distribution with mean $0$ and concentration $\\kappa = 2$ using a pseudorandom generator with seed $456$, so that $\\phi_n(t) = \\theta(t) + \\varepsilon_{n,t}$ with $\\varepsilon_{n,t} \\sim \\mathrm{VM}(0, \\kappa)$.\n  - Construct $Z$ from these phases.\n\nRequirements:\n- Angles must be treated in radians.\n- The outputs for each test case must be two lists: $[PLV(t)]_{t=1}^T$ and $[PPC(t)]_{t=1}^T$, where the elements are floating-point numbers.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a two-element list containing the $PLV$ list and the $PPC$ list for that case. For example, the structure must be $[[plv\\_case1,ppc\\_case1],[plv\\_case2,ppc\\_case2],[plv\\_case3,ppc\\_case3],[plv\\_case4,ppc\\_case4]]$.",
            "solution": "The user's request is a valid scientific computing problem. It requires the implementation of two standard measures of neural phase synchronization, the Phase-Locking Value (PLV) and the Pairwise Phase Consistency (PPC), using vectorized operations on complex-valued matrices. The problem is well-defined, scientifically grounded in neuroscience data analysis, and all necessary parameters for test cases are provided.\n\n### Principle and Derivations\n\nThe core of the problem lies in translating the statistical definitions of PLV and PPC into efficient, vectorized linear algebra operations. Let the input data be represented by a complex matrix $Z \\in \\mathbb{C}^{N \\times T}$, where $N$ is the number of trials and $T$ is the number of time samples. Each element $Z_{n,t} = e^{i\\phi_n(t)}$ is a unit-length complex number representing the phase $\\phi_n(t)$ of a signal in trial $n$ at time $t$.\n\n#### Phase-Locking Value (PLV)\n\nThe PLV at time $t$, denoted $PLV(t)$, measures the length of the average phase vector across trials. It quantifies the degree to which phase values cluster around a common angle. A $PLV$ of $1$ indicates perfect phase alignment, while a $PLV$ of $0$ indicates complete desynchronization (e.g., uniformly distributed phases).\n\nThe mathematical definition is:\n$$ PLV(t) = \\left| \\frac{1}{N} \\sum_{n=1}^N Z_{n,t} \\right| $$\nThis can be rewritten as:\n$$ PLV(t) = \\frac{1}{N} \\left| \\sum_{n=1}^N Z_{n,t} \\right| $$\nTo compute this for all time samples $t$ in a vectorized manner, we first compute the sum of complex vectors across the trial dimension (axis $0$) of the matrix $Z$. Let $\\mathbf{S} \\in \\mathbb{C}^T$ be the resulting row vector where each element $\\mathbf{S}_t = \\sum_{n=1}^N Z_{n,t}$. The PLV time series is then given by:\n$$ \\mathbf{PLV}_t = \\frac{|\\mathbf{S}_t|}{N} $$\n\n#### Pairwise Phase Consistency (PPC)\n\nThe PPC at time $t$, denoted $PPC(t)$, is an alternative measure of phase synchronization that is unbiased by the number of trials. It is calculated as the average of the cosine of phase differences between all unique pairs of trials.\n\nThe definition is:\n$$ PPC(t) = \\frac{1}{\\binom{N}{2}} \\sum_{1 \\le j  k \\le N} \\cos(\\phi_j(t) - \\phi_k(t)) $$\nwhere $\\binom{N}{2} = \\frac{N(N-1)}{2}$ is the number of unique trial pairs. This form is not directly suitable for vectorized computation. We can derive a more convenient expression using complex numbers. Using the identity $\\cos(\\alpha - \\beta) = \\Re(e^{i(\\alpha - \\beta)}) = \\Re(e^{i\\alpha} e^{-i\\beta})$, we can write:\n$$ PPC(t) = \\frac{1}{\\binom{N}{2}} \\sum_{1 \\le j  k \\le N} \\Re(Z_{j,t} Z_{k,t}^*) $$\nwhere $Z_{k,t}^*$ is the complex conjugate of $Z_{k,t}$.\n\nTo find a vectorized expression for the sum, we consider the squared magnitude of the sum vector $\\mathbf{S}_t = \\sum_{n=1}^N Z_{n,t}$:\n$$ |\\mathbf{S}_t|^2 = \\left(\\sum_{j=1}^N Z_{j,t}\\right) \\left(\\sum_{k=1}^N Z_{k,t}^*\\right) = \\sum_{j,k} Z_{j,t} Z_{k,t}^* $$\nWe split this sum into diagonal ($j=k$) and off-diagonal ($j \\neq k$) terms:\n$$ |\\mathbf{S}_t|^2 = \\sum_{n=1}^N |Z_{n,t}|^2 + \\sum_{j \\neq k} Z_{j,t} Z_{k,t}^* $$\nSince $|Z_{n,t}|=1$, the first term is simply $N$. The second term can be expanded as a sum over unique pairs:\n$$ \\sum_{j \\neq k} Z_{j,t} Z_{k,t}^* = \\sum_{1 \\le j  k \\le N} (Z_{j,t} Z_{k,t}^* + Z_{k,t} Z_{j,t}^*) $$\nUsing the identity $w + w^* = 2\\Re(w)$, this becomes:\n$$ \\sum_{j \\neq k} Z_{j,t} Z_{k,t}^* = 2 \\sum_{1 \\le j  k \\le N} \\Re(Z_{j,t} Z_{k,t}^*) $$\nSubstituting back, we get:\n$$ |\\mathbf{S}_t|^2 = N + 2 \\sum_{1 \\le j  k \\le N} \\Re(Z_{j,t} Z_{k,t}^*) $$\nSolving for the sum gives:\n$$ \\sum_{1 \\le j  k \\le N} \\Re(Z_{j,t} Z_{k,t}^*) = \\frac{|\\mathbf{S}_t|^2 - N}{2} $$\nFinally, substituting this into the definition of PPC:\n$$ PPC(t) = \\frac{1}{N(N-1)/2} \\left( \\frac{|\\mathbf{S}_t|^2 - N}{2} \\right) = \\frac{|\\mathbf{S}_t|^2 - N}{N(N-1)} $$\nThis provides a fully vectorized formula for the PPC time series, computable from the same sum vector $\\mathbf{S}$ used for PLV. For $N  2$, the denominator is zero or undefined, so PPC is not defined; in this case, we will output Not-a-Number (NaN) as required.\n\n### Implementation Strategy\n\nThe solution will be implemented in a function `solve()`. This function will iterate through the four specified test cases. For each case, it will:\n1.  Construct the complex data matrix $Z \\in \\mathbb{C}^{N \\times T}$ according to the specified parameters (e.g., coherent, antiphase, random, or noisy phases). This involves using `numpy` for array creation and random number generation from uniform and von Mises distributions with specified seeds for reproducibility.\n2.  Compute the PLV and PPC time series using the derived vectorized formulas. A helper function will encapsulate this core logic.\n3.  Format the resulting lists of floating-point numbers into the precise string representation required by the problem statement.\n4.  Aggregate the formatted strings from all test cases into a final output string and print it.\n\nAll mathematical operations, including complex number arithmetic and random sampling, will be handled by the `numpy` library.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes time-resolved PLV and PPC for a suite of test cases\n    and prints the results in the specified format.\n    \"\"\"\n\n    def compute_plv_ppc(Z):\n        \"\"\"\n        Computes PLV and PPC from a complex phase matrix Z.\n        \n        Args:\n            Z (np.ndarray): A complex array of shape (N, T) where N is trials\n                            and T is time samples. Z_nt = exp(1j*phi_nt).\n\n        Returns:\n            tuple: A tuple containing two lists:\n                   - PLV values for each time point.\n                   - PPC values for each time point.\n        \"\"\"\n        N, T = Z.shape\n        \n        # Sum of complex vectors across trials for each time point\n        S_vec = np.sum(Z, axis=0)\n        \n        # Compute Phase-Locking Value (PLV)\n        # PLV(t) = |(1/N) * sum_n(exp(1j*phi_n(t)))|\n        plv_t = np.abs(S_vec) / N\n        \n        # Compute Pairwise Phase Consistency (PPC)\n        # PPC(t) = (|sum_n(exp(1j*phi_n(t)))|^2 - N) / (N * (N - 1))\n        if N  2:\n            ppc_t = np.full(T, np.nan)\n        else:\n            ppc_t = (np.abs(S_vec)**2 - N) / (N * (N - 1))\n            \n        return plv_t.tolist(), ppc_t.tolist()\n\n    def generate_Z(params):\n        \"\"\"Generates the complex data matrix Z for a given test case.\"\"\"\n        N, T = params['N'], params['T']\n        case_type = params['type']\n        \n        phi_matrix = None\n        if case_type == 'coherent':\n            phi_base = np.array([0.0, 0.5, 1.0, 1.5, 2.0])\n            phi_matrix = np.tile(phi_base, (N, 1))\n        \n        elif case_type == 'antiphase':\n            phi1 = np.array([0.0, 0.25, 0.5, 0.75])\n            phi2 = phi1 + np.pi\n            phi_matrix = np.vstack([phi1, phi2])\n            \n        elif case_type == 'random':\n            rng = np.random.default_rng(params['seed'])\n            phi_matrix = rng.uniform(-np.pi, np.pi, size=(N, T))\n            \n        elif case_type == 'vonmises':\n            rng = np.random.default_rng(params['seed'])\n            t_vec = np.arange(T)\n            theta_t = np.sin(0.1 * t_vec)\n            noise = rng.vonmises(mu=0, kappa=params['kappa'], size=(N, T))\n            phi_matrix = theta_t[np.newaxis, :] + noise # Broadcasting baseline phase\n            \n        return np.exp(1j * phi_matrix)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'N': 8, 'T': 5, 'type': 'coherent'},\n        {'N': 2, 'T': 4, 'type': 'antiphase'},\n        {'N': 50, 'T': 100, 'type': 'random', 'seed': 123},\n        {'N': 40, 'T': 60, 'type': 'vonmises', 'seed': 456, 'kappa': 2}\n    ]\n\n    results = []\n    for params in test_cases:\n        # Generate complex data matrix Z\n        Z = generate_Z(params)\n        \n        # Compute PLV and PPC\n        plv, ppc = compute_plv_ppc(Z)\n        \n        # Format the result for this case as a string\n        plv_str = '[' + ','.join(map(str, plv)) + ']'\n        ppc_str = '[' + ','.join(map(str, ppc)) + ']'\n        case_result_str = f'[{plv_str},{ppc_str}]'\n        \n        results.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A skilled scientist not only knows how to use their tools but also understands their limitations. This advanced practice presents a hypothetical scenario of symmetric bimodal phase locking, a pattern where standard $PLV$ and $PPC$ can be deceptively zero, mimicking a lack of synchrony. This thought experiment will guide you to think beyond first-order metrics and explore how higher-order statistics can reveal complex, hidden synchronization patterns, a crucial step toward robust and nuanced data interpretation .",
            "id": "4185660",
            "problem": "A laboratory records instantaneous phases $\\phi_n \\in [-\\pi,\\pi)$ of a local field potential (LFP) at stimulus onset across $N$ trials, after band-pass filtering to a narrow frequency band. Define the phase-locking value (PLV) magnitude as $r_1 = \\left|\\frac{1}{N}\\sum_{n=1}^N e^{i \\phi_n}\\right|$ and the pairwise phase consistency (PPC) as the expected cosine of phase differences across independent trials, i.e., the large-sample limit of $\\frac{2}{N(N-1)}\\sum_{1 \\leq j  k \\leq N} \\cos(\\phi_j - \\phi_k)$. Consider two generative scenarios for the phase distribution across trials:\n\n- Unimodal: $\\phi$ is drawn independently from a unimodal, rotation-symmetric circular distribution centered at mean direction $\\mu$ with concentration parameter $\\kappa  0$ (for concreteness, think of a Von Mises family, but do not assume any explicit closed-form beyond the definition of circular moments).\n- Symmetric bimodal: $\\phi$ is drawn independently from a mixture of two identical unimodal components centered at $\\mu$ and $\\mu + \\pi$ with equal weights and the same concentration parameter $\\kappa  0$.\n\nStarting only from the core definitions of circular moments and independence, reason about the following claims and proposed tests. Your derivations must use the facts that the PLV magnitude $r_1$ is the magnitude of the first circular moment $\\mathbb{E}[e^{i \\phi}]$, and that PPC (in the large-sample limit) equals $\\mathbb{E}[\\cos(\\phi_j - \\phi_k)]$ for independent draws $\\phi_j,\\phi_k$. Do not assume or use any shortcut formulas beyond these definitions.\n\nWhich of the following statements are correct?\n\nA. In the symmetric bimodal case with equal weights at $\\mu$ and $\\mu + \\pi$, the first circular moment $\\mathbb{E}[e^{i \\phi}]$ is exactly $0$ for any $\\kappa$, so $r_1 \\to 0$ as $N \\to \\infty$, and the PLV magnitude alone cannot distinguish such antipodal locking from a uniform phase distribution.\n\nB. In the symmetric bimodal case with equal weights at $\\mu$ and $\\mu + \\pi$, the large-sample PPC equals $0$, so PPC alone (on the original angles) also cannot distinguish antipodal bimodal locking from no locking.\n\nC. Doubling the angles to test for higher-harmonic phase locking, by replacing each $\\phi_n$ with $2\\phi_n$ and computing either $r_2 = \\left|\\frac{1}{N}\\sum_{n=1}^N e^{i 2 \\phi_n}\\right|$ or the PPC on $2\\phi$, yields a nonzero value in the symmetric bimodal case (for $\\kappa > 0$), thereby discriminating antipodal bimodal locking from a uniform phase distribution.\n\nD. Examining the sample mean direction $\\hat{\\mu} = \\arg\\!\\left(\\sum_{n=1}^N e^{i \\phi_n}\\right)$ across resamples or time windows can help distinguish antipodal bimodal locking from unimodal locking: in the antipodal case with strong concentration, $\\hat{\\mu}$ will tend to flip between two directions approximately separated by $\\pi$, whereas in the unimodal case $\\hat{\\mu}$ will concentrate near a single direction.\n\nE. For any true phase locking, including symmetric antipodal bimodality, $r_1$ must eventually increase above $0$ as $N$ grows, so the PLV magnitude will become strictly positive with enough trials, and thus can be used alone to detect antipodal bimodal locking.\n\nSelect all correct options.",
            "solution": "The problem requires an analysis of phase-locking statistics under different generative models for phase data. We begin by establishing the fundamental quantities and their relationships based on the provided definitions.\n\nLet $\\phi$ be a random variable representing the phase, with a probability distribution $p(\\phi)$.\nThe first circular moment is defined as $m_1 = \\mathbb{E}[e^{i \\phi}]$. By the law of large numbers, the sample mean $\\frac{1}{N}\\sum_{n=1}^N e^{i \\phi_n}$ converges to $m_1$ as the number of trials $N \\to \\infty$.\nThe phase-locking value (PLV) magnitude, in the large-sample limit, is $r_1 = |m_1| = |\\mathbb{E}[e^{i \\phi}]|$.\n\nThe pairwise phase consistency (PPC) is defined as the large-sample limit of the sample mean of $\\cos(\\phi_j - \\phi_k)$, which is $\\mathbb{E}[\\cos(\\phi_j - \\phi_k)]$ for two independent trials $j$ and $k$. Since the phases $\\phi_j$ and $\\phi_k$ are independent and identically distributed (i.i.d.), we can write:\n$$\n\\text{PPC} = \\mathbb{E}[\\cos(\\phi_j - \\phi_k)] = \\mathbb{E}[\\cos\\phi_j \\cos\\phi_k + \\sin\\phi_j \\sin\\phi_k]\n$$\nBy independence, this becomes:\n$$\n\\text{PPC} = \\mathbb{E}[\\cos\\phi_j]\\mathbb{E}[\\cos\\phi_k] + \\mathbb{E}[\\sin\\phi_j]\\mathbb{E}[\\sin\\phi_k] = (\\mathbb{E}[\\cos\\phi])^2 + (\\mathbb{E}[\\sin\\phi])^2\n$$\nThe first circular moment is $m_1 = \\mathbb{E}[e^{i\\phi}] = \\mathbb{E}[\\cos\\phi] + i\\mathbb{E}[\\sin\\phi]$. Its magnitude squared is $|m_1|^2 = (\\mathbb{E}[\\cos\\phi])^2 + (\\mathbb{E}[\\sin\\phi])^2$.\nTherefore, we establish the crucial identity for the large-sample limit:\n$$\n\\text{PPC} = |m_1|^2 = r_1^2\n$$\nThis shows that PPC is simply the squared PLV magnitude in the population limit.\n\nWe now analyze the scenarios.\n\n**Unimodal Distribution:**\nThe distribution $p(\\phi)$ is unimodal and symmetric about a mean direction $\\mu$. Let $\\psi = \\phi - \\mu$. The distribution of $\\psi$ is unimodal and symmetric about $0$. The first moment is:\n$$\nm_1 = \\mathbb{E}[e^{i\\phi}] = \\mathbb{E}[e^{i(\\psi+\\mu)}] = e^{i\\mu}\\mathbb{E}[e^{i\\psi}]\n$$\nSince the distribution of $\\psi$ is symmetric about $0$, $\\mathbb{E}[\\sin\\psi] = 0$. Thus, $\\mathbb{E}[e^{i\\psi}] = \\mathbb{E}[\\cos\\psi]$, which is a real number. For a concentrated distribution ($\\kappa > 0$), phases are clustered, so $\\mathbb{E}[\\cos\\psi]  0$. Let $c_1 = \\mathbb{E}[\\cos\\psi] \\in (0, 1]$.\nSo, $m_1 = c_1 e^{i\\mu}$. The PLV magnitude is $r_1 = |m_1| = c_1  0$. The PPC is $r_1^2 = c_1^2  0$.\n\n**Symmetric Bimodal Distribution:**\nThe distribution is an equal-weight mixture of two identical unimodal components centered at $\\mu$ and $\\mu+\\pi$. Let the unimodal component distribution centered at $\\mu$ be $p_1(\\phi)$ and the one centered at $\\mu+\\pi$ be $p_2(\\phi)$. The mixture distribution is $p(\\phi) = 0.5 p_1(\\phi) + 0.5 p_2(\\phi)$.\nThe first moment is calculated using the law of total expectation:\n$$\nm_1 = \\mathbb{E}[e^{i\\phi}] = 0.5 \\cdot \\mathbb{E}_{p_1}[e^{i\\phi}] + 0.5 \\cdot \\mathbb{E}_{p_2}[e^{i\\phi}]\n$$\nFrom the unimodal analysis, the first moment of the component centered at $\\mu$ is $\\mathbb{E}_{p_1}[e^{i\\phi}] = c_1 e^{i\\mu}$.\nFor the component centered at $\\mu+\\pi$, the mean direction is shifted by $\\pi$. Thus, its first moment is $\\mathbb{E}_{p_2}[e^{i\\phi}] = c_1 e^{i(\\mu+\\pi)} = c_1 e^{i\\mu} e^{i\\pi} = -c_1 e^{i\\mu}$.\nSubstituting these into the mixture expectation:\n$$\nm_1 = 0.5 (c_1 e^{i\\mu}) + 0.5 (-c_1 e^{i\\mu}) = 0\n$$\nThis result is exact for any concentration $\\kappa  0$. Consequently, the PLV magnitude $r_1 = |m_1| = 0$, and the PPC is $r_1^2 = 0$.\n\n**Uniform Distribution (No Locking):**\nFor a uniform distribution on $[-\\pi, \\pi)$, $p(\\phi) = 1/(2\\pi)$.\n$$\nm_1 = \\mathbb{E}[e^{i\\phi}] = \\int_{-\\pi}^{\\pi} e^{i\\phi} \\frac{1}{2\\pi} d\\phi = \\frac{1}{2\\pi} \\left[ \\frac{e^{i\\phi}}{i} \\right]_{-\\pi}^{\\pi} = \\frac{e^{i\\pi} - e^{-i\\pi}}{2\\pi i} = \\frac{2i\\sin(\\pi)}{2\\pi i} = 0\n$$\nThus, $r_1=0$ and $\\text{PPC}=0$.\n\nNow we evaluate each statement.\n\n**Analysis of Option A**\nThis statement claims that for the symmetric bimodal case, $\\mathbb{E}[e^{i\\phi}]=0$, so $r_1 \\to 0$ as $N \\to \\infty$, and PLV magnitude cannot distinguish this from a uniform phase distribution.\nOur derivation shows that for the symmetric bimodal case, the first circular moment $m_1 = \\mathbb{E}[e^{i\\phi}]$ is indeed exactly $0$. By the law of large numbers, the sample PLV magnitude $r_1$ converges to $|m_1|=0$. For a uniform distribution, we also found $m_1=0$. Since the population-level statistic ($r_1$) is $0$ in both cases, any hypothesis test based on $r_1$ would be unable to distinguish between symmetric bimodal locking and a uniform distribution. Thus, the statement is correct.\n\n**Verdict on A: Correct**\n\n**Analysis of Option B**\nThis statement claims that for the symmetric bimodal case, the large-sample PPC is $0$, and PPC also cannot distinguish this case from no locking (a uniform distribution).\nWe established that PPC $= r_1^2$. Since $r_1=0$ for the symmetric bimodal case, the PPC is also $0$. As shown before, for a uniform distribution (no locking), $r_1=0$ and thus PPC is also $0$. Therefore, PPC, like PLV, cannot distinguish between these two scenarios. The statement is correct.\n\n**Verdict on B: Correct**\n\n**Analysis of Option C**\nThis statement proposes distinguishing the symmetric bimodal case from a uniform distribution by doubling the angles. This involves computing the second circular moment, $m_2 = \\mathbb{E}[e^{i2\\phi}]$. The corresponding sample PLV would be $r_2 = |\\frac{1}{N}\\sum_{n=1}^N e^{i2\\phi_n}| \\to |m_2|$.\nFor the **symmetric bimodal** case:\n$$\nm_2 = \\mathbb{E}[e^{i2\\phi}] = 0.5 \\cdot \\mathbb{E}_{p_1}[e^{i2\\phi}] + 0.5 \\cdot \\mathbb{E}_{p_2}[e^{i2\\phi}]\n$$\nLet the unimodal component have a second moment about its mean of $c_2 e^{i2\\mu}$, where $c_2 = \\mathbb{E}[\\cos(2\\psi)]  0$ for a concentrated unimodal distribution.\nThe moment for the first component (centered at $\\mu$) is $\\mathbb{E}_{p_1}[e^{i2\\phi}] = c_2 e^{i2\\mu}$.\nFor the second component (centered at $\\mu+\\pi$), the moment is $\\mathbb{E}_{p_2}[e^{i2\\phi}] = c_2 e^{i2(\\mu+\\pi)} = c_2 e^{i2\\mu} e^{i2\\pi} = c_2 e^{i2\\mu}$.\nThe shift by $\\pi$ becomes a shift by $2\\pi$ after doubling, which is an identity rotation. Thus, both components have the same second moment.\n$$\nm_2 = 0.5(c_2 e^{i2\\mu}) + 0.5(c_2 e^{i2\\mu}) = c_2 e^{i2\\mu}\n$$\nSince $\\kappa0$, the unimodal components are concentrated, not uniform, which implies $c_2  0$. Thus, $|m_2| = c_2  0$.\nFor the **uniform distribution**:\n$$\nm_2 = \\mathbb{E}[e^{i2\\phi}] = \\int_{-\\pi}^{\\pi} e^{i2\\phi} \\frac{1}{2\\pi} d\\phi = \\frac{1}{2\\pi} \\left[ \\frac{e^{i2\\phi}}{2i} \\right]_{-\\pi}^{\\pi} = \\frac{e^{i2\\pi} - e^{-i2\\pi}}{4\\pi i} = 0\n$$\nSince $m_2 \\neq 0$ for the bimodal case but $m_2=0$ for the uniform case, computing $r_2$ or PPC on $2\\phi$ can indeed discriminate between them. The statement is correct.\n\n**Verdict on C: Correct**\n\n**Analysis of Option D**\nThis statement suggests that the behavior of the sample mean direction $\\hat{\\mu} = \\arg(\\sum_{n=1}^N e^{i\\phi_n})$ across resamples or time windows differs between unimodal and antipodal bimodal locking.\nIn the **unimodal** case, phases are sampled from one cluster around $\\mu$. The sum $\\sum e^{i\\phi_n}$ will result in a vector whose direction $\\hat{\\mu}$ is a stable estimate of $\\mu$. Across different samples, $\\hat{\\mu}$ will have a low variance around $\\mu$.\nIn the **symmetric bimodal** case with strong concentration, each $\\phi_n$ is likely close to either $\\mu$ or $\\mu+\\pi$. In a finite sample of size $N$, let $N_1$ be the count of trials near $\\mu$ and $N_2$ be the count near $\\mu+\\pi$ ($N_1+N_2=N$). The vector sum is approximately:\n$$\n\\sum_{n=1}^N e^{i\\phi_n} \\approx N_1 e^{i\\mu} + N_2 e^{i(\\mu+\\pi)} = N_1 e^{i\\mu} - N_2 e^{i\\mu} = (N_1 - N_2) e^{i\\mu}\n$$\nThe argument of this sum, $\\hat{\\mu}$, will be $\\mu$ if $N_1  N_2$ and $\\mu+\\pi$ if $N_2  N_1$. Since the two modes have equal weight, the values of $N_1$ and $N_2$ will fluctuate across different samples (time windows or resamples), causing $N_1-N_2$ to randomly be positive or negative. Consequently, the estimated direction $\\hat{\\mu}$ will flip between $\\mu$ and $\\mu+\\pi$. This bistable behavior of $\\hat{\\mu}$ is distinct from the stable behavior in the unimodal case. The statement is correct.\n\n**Verdict on D: Correct**\n\n**Analysis of Option E**\nThis statement claims that for any true phase locking, including symmetric antipodal, $r_1$ will become strictly positive and can be used for detection.\nThis is incorrect. As proven for Option A, in the symmetric bimodal case, the true first circular moment is $m_1=0$. The sample statistic $r_1$ will fluctuate around $0$ for any finite $N$, and converge to $0$ as $N \\to \\infty$. Its expected value will decrease with $N$ (scaling as $1/\\sqrt{N}$). While for any finite $N$, the sample value $r_1$ is almost surely greater than $0$, it is statistically indistinguishable from a sample drawn from a uniform distribution, which also has a true moment of $0$. A statistical test based on $r_1$ would not be able to reject the null hypothesis of a uniform distribution. Therefore, $r_1$ (PLV magnitude) alone cannot be used to detect this specific type of phase locking.\n\n**Verdict on E: Incorrect**",
            "answer": "$$\\boxed{ABCD}$$"
        }
    ]
}