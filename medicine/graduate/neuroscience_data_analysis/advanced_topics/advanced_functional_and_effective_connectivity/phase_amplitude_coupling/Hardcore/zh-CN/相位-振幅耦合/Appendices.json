{
    "hands_on_practices": [
        {
            "introduction": "在深入进行计算之前，首要任务是全面掌握相位-振幅耦合（Phase-Amplitude Coupling, PAC）分析的完整流程。本练习旨在检验您对从信号处理到统计检验的整个方法论框架的理解。通过从多个选项中识别出科学上严谨的步骤 ，您可以为后续的实际计算和编程打下坚实的概念基础。",
            "id": "4501020",
            "problem": "一位研究人员试图量化与人类颅内记录中意识的神经相关物相关的跨频相互作用。分析来自静息清醒状态下内侧颞叶的局部场电位（LFP）片段，以评估 $4$–$8$ Hz 范围内的 theta 相位是否调制 $30$–$80$ Hz 范围内的 gamma 幅度。从第一性原理出发，相位-幅度耦合（PAC）是低频振荡的瞬时相位与高频振荡的瞬时幅度包络之间的统计依赖关系。分析必须基于解析信号和概率分布的核心定义，并采用有原则的零假设检验。\n\n哪个选项正确定义了 PAC，并概述了一种科学有效的计算 theta 相位调制 gamma 幅度的调制指数的方法，包括基于代理数据的显著性检验？\n\nA. PAC 是高频幅度对低频相位的依赖关系。通过以下步骤计算调制指数：对 LFP 进行带通滤波，得到 theta（$4$–$8$ Hz）信号 $x_{\\theta}(t)$ 和 gamma（$30$–$80$ Hz）信号 $x_{\\gamma}(t)$；通过 Hilbert 变换构建解析信号，$x_{\\theta,a}(t) = x_{\\theta}(t) + j\\,\\mathcal{H}\\{x_{\\theta}(t)\\}$ 和 $x_{\\gamma,a}(t) = x_{\\gamma}(t) + j\\,\\mathcal{H}\\{x_{\\gamma}(t)\\}$；提取 theta 相位 $\\phi_{\\theta}(t) = \\arg(x_{\\theta,a}(t))$ 和 gamma 幅度 $a_{\\gamma}(t) = |x_{\\gamma,a}(t)|$。将 $\\phi_{\\theta}(t)$ 在 $[-\\pi,\\pi)$ 范围内均匀地划分到 $N$ 个区间中；计算每个相位区间 $k$ 内 $a_{\\gamma}(t)$ 的平均值 $\\bar{a}_{\\gamma,k}$，然后归一化为概率分布 $p_k = \\bar{a}_{\\gamma,k}/\\sum_{m=1}^N \\bar{a}_{\\gamma,m}$。设 $U$ 为均匀分布，其中 $u_k = 1/N$。定义 Kullback–Leibler 散度 $D_{\\mathrm{KL}}(P\\Vert U) = \\sum_{k=1}^N p_k \\log\\left(\\frac{p_k}{u_k}\\right)$，调制指数定义为 $MI = D_{\\mathrm{KL}}(P\\Vert U)/\\log N$。使用代理数据评估显著性，这些代理数据在打破相位-幅度依赖关系的同时保留了自相关结构，例如，通过将 $a_{\\gamma}(t)$ 相对于 $\\phi_{\\theta}(t)$ 进行一个超过 theta 自相关窗口的随机延迟的循环移位，并在 $S$ 个代理数据上重新计算 $MI$，得到 $\\{MI_s\\}_{s=1}^S$。计算标准化的 $z$-分数 $z = (MI_{\\text{emp}} - \\mu_s)/\\sigma_s$，其中 $\\mu_s$ 和 $\\sigma_s$ 分别是代理数据的均值和标准差，或者将 $MI_{\\text{emp}}$ 与代理数据的 $95\\%$ 百分位数进行比较；如果 $p  0.05$（必要时进行适当的多重比较校正），则宣布结果具有显著性。\n\nB. PAC 是通过 theta 和 gamma 之间的相位-相位锁定来测量的。对 LFP 进行带通滤波得到 theta 和 gamma 信号，通过 Hilbert 变换计算瞬时相位 $\\phi_{\\theta}(t)$ 和 $\\phi_{\\gamma}(t)$，并通过 $\\phi_{\\gamma}(t) - \\phi_{\\theta}(t)$ 的平均合矢量长度来量化耦合。为检验显著性，通过傅里叶变换计算相干谱并在固定的相干水平上设置阈值；不需要代理数据检验，因为相干性直接测量耦合。\n\nC. PAC 是 theta 相位和 gamma 功率之间的线性相关性。对 theta 和 gamma 信号进行带通滤波，将 $\\phi_{\\theta}(t)$ 转换为角度，计算 gamma 功率 $p_{\\gamma}(t) = x_{\\gamma}^2(t)$，并得到 $\\phi_{\\theta}(t)$ 和 $p_{\\gamma}(t)$ 之间的 Pearson 相关系数 $r$。使用 Student's $t$-检验对跨时间样本的 $r$ 值进行显著性评估；代理数据检验是不必要的，因为 $t$-检验可以控制伪相关。\n\nD. PAC 是低频幅度对高频相位的依赖关系。直接计算原始 gamma 信号 $x_{\\gamma}(t)$ 和原始 theta 信号 $x_{\\theta}(t)$ 之间的互信息，无需滤波伪迹。为检验显著性，随机置换 $x_{\\gamma}(t)$ 的时间点以形成代理数据，并将经验互信息与置换后的分布进行比较；区间划分是可选的，因为互信息对采样具有鲁棒性。\n\nE. PAC 是 theta 和 gamma 的幅度包络之间的关联。通过 Hilbert 变换计算幅度包络 $a_{\\theta}(t)$ 和 $a_{\\gamma}(t)$，并将调制指数计算为仅 $a_{\\gamma}(t)$ 的 Shannon 熵，$H(a_{\\gamma}) = -\\sum_i q_i \\log q_i$，其中 $q_i$ 是 $a_{\\gamma}(t)$ 的直方图区间概率。为检验显著性，对 $a_{\\gamma}(t)$ 进行自助法重采样以获得 $H(a_{\\gamma})$ 的零分布；PAC 不需要相位信息，因为幅度反映了振荡强度。",
            "solution": "用户要求对问题陈述进行严格验证，然后详细推导解决方案并评估所有提供的选项。\n\n### 问题验证\n\n**步骤 1：提取已知信息**\n- **话题**：量化与意识的神经相关物相关的跨频相互作用，特别是相位-幅度耦合（PAC）。\n- **数据来源**：来自人类内侧颞叶在静息清醒状态下的局部场电位（LFP）片段。\n- **相互作用**：Theta ($\\theta$) 相位调制 gamma ($\\gamma$) 幅度。\n- **频带**：$\\theta$ 频带为 $4$–$8$ Hz；$\\gamma$ 频带为 $30$–$80$ Hz。\n- **PAC 的定义**：“低频振荡的瞬时相位与高频振荡的瞬时幅度包络之间的统计依赖关系。”\n- **方法论约束**：分析必须基于：\n    1.  解析信号和概率分布的核心定义。\n    2.  有原则的零假设检验。\n- **问题**：找出正确定义 PAC 并概述了计算调制指数的科学有效方法的选项，该方法包括基于代理数据的显著性检验。\n\n**步骤 2：使用提取的已知信息进行验证**\n- **科学依据**：该问题在计算神经科学中有坚实的基础。相位-幅度耦合是一种被广泛研究的神经动力学。LFP 的使用、特定的大脑区域（内侧颞叶）以及所选的频带（$\\theta$ 和 $\\gamma$）都是该领域的标准做法。所提供的 PAC 定义是准确的，并且是教科书级别的标准。\n- **适定性**：该问题是适定的。它要求根据对现象（theta 相位到 gamma 幅度的耦合）的清晰标准定义，从一组选项中确定一个正确的程序。存在一个唯一的、正确的方法论可以被描述。\n- **客观性**：问题陈述是客观的，并使用了精确的技术语言。没有主观、模糊或基于观点的断言。\n\n**步骤 3：结论与行动**\n问题陈述是**有效的**。它在科学上是合理的、具体的，并提出了一个基于信号处理和神经科学既定原则的可解决任务。我将继续推导解决方案并评估各个选项。\n\n### 推导与选项分析\n\n从第一性原理出发，量化低频相位（$\\phi_{\\text{low}}$）和高频幅度（$a_{\\text{high}}$）之间的相位-幅度耦合（PAC）涉及几个关键步骤。这里，低频是 theta（$\\theta$, $4$–$8$ Hz），高频是 gamma（$\\gamma$, $30$–$80$ Hz）。\n\n1.  **信号分解**：原始 LFP 信号，我们称之为 $s(t)$，必须经过滤波以分离出感兴趣的频率。\n    -   应用带通滤波器以获得 theta 频带信号 $x_{\\theta}(t)$。\n    -   应用另一个带通滤波器以获得 gamma 频带信号 $x_{\\gamma}(t)$。\n\n2.  **解析信号构建**：为了提取瞬时相位和幅度，需要对两个滤波后的信号使用解析信号表示。一个实信号 $x(t)$ 的解析信号 $x_a(t)$ 是使用 Hilbert 变换 $\\mathcal{H}\\{\\cdot\\}$ 构建的：\n    $$x_a(t) = x(t) + j\\,\\mathcal{H}\\{x(t)\\}$$\n    其中 $j = \\sqrt{-1}$。我们对两个信号都进行此计算：\n    -   $x_{\\theta,a}(t) = x_{\\theta}(t) + j\\,\\mathcal{H}\\{x_{\\theta}(t)\\}$\n    -   $x_{\\gamma,a}(t) = x_{\\gamma}(t) + j\\,\\mathcal{H}\\{x_{\\gamma}(t)\\}$\n\n3.  **相位和幅度提取**：瞬时相位是解析信号的辐角，瞬时幅度是其模。我们需要低频信号的相位和高频信号的幅度：\n    -   Theta 相位：$\\phi_{\\theta}(t) = \\arg(x_{\\theta,a}(t))$\n    -   Gamma 幅度：$a_{\\gamma}(t) = |x_{\\gamma,a}(t)|$\n\n4.  **调制量化**：PAC 的核心是 $a_{\\gamma}(t)$ 的平均值在 $\\phi_{\\theta}(t)$ 的所有值上并非恒定。一个可靠的量化方法是测量 gamma 幅度在 theta 相位区间上的分布与均匀分布（代表无耦合的零假设）的偏离程度。\n    -   将相位范围 $[-\\pi, \\pi)$ 分为 $N$ 个离散的区间。\n    -   对于每个相位区间 $k$，计算所有 $\\phi_{\\theta}(t)$ 落入区间 $k$ 的时间点上 $a_{\\gamma}(t)$ 的平均值 $\\bar{a}_{\\gamma,k}$。\n    -   将这个复合的幅度分布归一化，形成一个概率分布 $P$，其中区间 $k$ 的概率为 $p_k = \\bar{a}_{\\gamma,k} / \\sum_{m=1}^{N} \\bar{a}_{\\gamma,m}$。\n    -   使用 Kullback–Leibler (KL) 散度来衡量该分布 $P$ 与均匀分布 $U$（其中对所有 $k$ 都有 $u_k = 1/N$）的偏差：\n        $$D_{\\mathrm{KL}}(P \\Vert U) = \\sum_{k=1}^{N} p_k \\log\\left(\\frac{p_k}{u_k}\\right)$$\n    -   为了获得一个界于 $0$ 和 $1$ 之间的归一化调制指数（$MI$），将 KL 散度通过其最大可能值进行归一化，即均匀分布的熵 $\\log(N)$。\n        $$MI = \\frac{D_{\\mathrm{KL}}(P \\Vert U)}{\\log(N)}$$\n\n5.  **统计显著性检验**：计算出的 $MI_{\\text{emp}}$ 值可能因偶然性而非零。需要进行零假设检验。基于代理数据的方法是标准做法。\n    -   零假设 $H_0$ 是时间序列 $\\phi_{\\theta}(t)$ 和 $a_{\\gamma}(t)$ 之间没有系统性的关系。\n    -   要在 $H_0$ 下生成代理数据，必须打破两个时间序列之间的特定时间对齐，同时保留它们各自的统计特性（例如，功率谱、自相关）。一种标准方法是“时间平移”或“循环移位”代理数据。在两个信号之间引入一个随机的时间延迟 $\\Delta t$，例如，通过分析配对 $(\\phi_{\\theta}(t), a_{\\gamma}(t+\\Delta t))$。该延迟必须足够大以使信号去相关。\n    -   这个过程重复 $S$ 次（例如，$S=1000$）以生成代理调制指数的零分布 $\\{MI_s\\}_{s=1}^S$。\n    -   然后将经验值 $MI_{\\text{emp}}$ 与此零分布进行比较。可以通过计算 $p$-值（$MI_s \\ge MI_{\\text{emp}}$ 的比例）或计算 $z$-分数 $z = (MI_{\\text{emp}} - \\mu_s)/\\sigma_s$ 来评估显著性，其中 $\\mu_s$ 和 $\\sigma_s$ 是代理数据分布的均值和标准差。如果 $p$-值低于所选的显著性水平（例如，$p  0.05$），则拒绝 $H_0$。\n\n### 选项评估\n\n**A. PAC 是高频幅度对低频相位的依赖关系。通过以下步骤计算调制指数：对 LFP 进行带通滤波，得到 theta（$4$–$8$ Hz）信号 $x_{\\theta}(t)$ 和 gamma（$30$–$80$ Hz）信号 $x_{\\gamma}(t)$；通过 Hilbert 变换构建解析信号，$x_{\\theta,a}(t) = x_{\\theta}(t) + j\\,\\mathcal{H}\\{x_{\\theta}(t)\\}$ 和 $x_{\\gamma,a}(t) = x_{\\gamma}(t) + j\\,\\mathcal{H}\\{x_{\\gamma}(t)\\}$；提取 theta 相位 $\\phi_{\\theta}(t) = \\arg(x_{\\theta,a}(t))$ 和 gamma 幅度 $a_{\\gamma}(t) = |x_{\\gamma,a}(t)|$。将 $\\phi_{\\theta}(t)$ 在 $[-\\pi,\\pi)$ 范围内均匀地划分到 $N$ 个区间中；计算每个相位区间 $k$ 内 $a_{\\gamma}(t)$ 的平均值 $\\bar{a}_{\\gamma,k}$，然后归一化为概率分布 $p_k = \\bar{a}_{\\gamma,k}/\\sum_{m=1}^N \\bar{a}_{\\gamma,m}$。设 $U$ 为均匀分布，其中 $u_k = 1/N$。定义 Kullback–Leibler 散度 $D_{\\mathrm{KL}}(P\\Vert U) = \\sum_{k=1}^N p_k \\log\\left(\\frac{p_k}{u_k}\\right)$，调制指数定义为 $MI = D_{\\mathrm{KL}}(P\\Vert U)/\\log N$。使用代理数据评估显著性，这些代理数据在打破相位-幅度依赖关系的同时保留了自相关结构，例如，通过将 $a_{\\gamma}(t)$ 相对于 $\\phi_{\\theta}(t)$ 进行一个超过 theta 自相关窗口的随机延迟的循环移位，并在 $S$ 个代理数据上重新计算 $MI$，得到 $\\{MI_s\\}_{s=1}^S$。计算标准化的 $z$-分数 $z = (MI_{\\text{emp}} - \\mu_s)/\\sigma_s$，其中 $\\mu_s$ 和 $\\sigma_s$ 分别是代理数据的均值和标准差，或者将 $MI_{\\text{emp}}$ 与代理数据的 $95\\%$ 百分位数进行比较；如果 $p  0.05$（必要时进行适当的多重比较校正），则宣布结果具有显著性。**\n- 此选项完整且准确地描述了计算和检验 PAC 的标准现代流程。定义是正确的。信号处理步骤（滤波、Hilbert 变换、相位/幅度提取）是正确的。量化方法（基于 KL 散度的调制指数）是一种有原则且被广泛接受的方法。显著性检验程序（时间平移代理数据）适用于检验特定时间对齐的假设，同时尊重信号的内在属性。将经验值与零分布进行比较的方法（$z$-分数、百分位数）也是标准的。\n- **结论：正确。**\n\n**B. PAC 是通过 theta 和 gamma 之间的相位-相位锁定来测量的。对 LFP 进行带通滤波得到 theta 和 gamma 信号，通过 Hilbert 变换计算瞬时相位 $\\phi_{\\theta}(t)$ 和 $\\phi_{\\gamma}(t)$，并通过 $\\phi_{\\gamma}(t) - \\phi_{\\theta}(t)$ 的平均合矢量长度来量化耦合。为检验显著性，通过傅里叶变换计算相干谱并在固定的相干水平上设置阈值；不需要代理数据检验，因为相干性直接测量耦合。**\n- 这个选项从根本上误解了 PAC。它描述的是相位-相位耦合（n:m 相位锁定），而非相位-幅度耦合。它错误地使用了 gamma 信号的相位（$\\phi_{\\gamma}(t)$）而不是其幅度。所提议的显著性检验（相干性）是另一种跨频相互作用的度量，并且声称不需要代理数据检验的说法对于复杂的、非线性的、非平稳的神经数据通常是无效的。\n- **结论：不正确。**\n\n**C. PAC 是 theta 相位和 gamma 功率之间的线性相关性。对 theta 和 gamma 信号进行带通滤波，将 $\\phi_{\\theta}(t)$ 转换为角度，计算 gamma 功率 $p_{\\gamma}(t) = x_{\\gamma}^2(t)$，并得到 $\\phi_{\\theta}(t)$ 和 $p_{\\gamma}(t)$ 之间的 Pearson 相关系数 $r$。使用 Student's $t$-检验对跨时间样本的 $r$ 值进行显著性评估；代理数据检验是不必要的，因为 $t$-检验可以控制伪相关。**\n- 这个选项在多个方面都有缺陷。首先，在循环变量（相位）和线性变量（功率）之间使用 Pearson 相关性在数学上是不合适的，会产生无意义的结果。其次，它使用瞬时功率 $p_{\\gamma}(t) = x_{\\gamma}^2(t)$，这是一个比幅度包络 $a_{\\gamma}(t)$ 噪声更大且不稳定的度量。第三，所提议的显著性检验（Student's $t$-检验）对于自相关的时间序列数据是无效的，因为它假设样本是独立的。声称代理数据检验是不必要的说法是错误的，并且在这种情况下是一种危险的统计实践。\n- **结论：不正确。**\n\n**D. PAC 是低频幅度对高频相位的依赖关系。直接计算原始 gamma 信号 $x_{\\gamma}(t)$ 和原始 theta 信号 $x_{\\theta}(t)$ 之间的互信息，无需滤波伪迹。为检验显著性，随机置换 $x_{\\gamma}(t)$ 的时间点以形成代理数据，并将经验互信息与置换后的分布进行比较；区间划分是可选的，因为互信息对采样具有鲁棒性。**\n- 这个选项错误地定义了 PAC，颠倒了频率和相关特征（幅度 vs. 相位）的角色。标准定义是低频相位调制高频幅度。它还建议在原始滤波信号（$x_{\\theta}(t)$，$x_{\\gamma}(t)$）上计算互信息，这并不能分离出相位-幅度的关系。滤波不是需要避免的“伪迹”；它是一个必要的步骤。所提议的代理数据方法（置换）不如时间平移恰当，因为它破坏了信号的自相关结构。\n- **结论：不正确。**\n\n**E. PAC 是 theta 和 gamma 的幅度包络之间的关联。通过 Hilbert 变换计算幅度包络 $a_{\\theta}(t)$ 和 $a_{\\gamma}(t)$，并将调制指数计算为仅 $a_{\\gamma}(t)$ 的 Shannon 熵，$H(a_{\\gamma}) = -\\sum_i q_i \\log q_i$，其中 $q_i$ 是 $a_{\\gamma}(t)$ 的直方图区间概率。为检验显著性，对 $a_{\\gamma}(t)$ 进行自助法重采样以获得 $H(a_{\\gamma})$ 的零分布；PAC 不需要相位信息，因为幅度反映了振荡强度。**\n- 这个选项错误地将 PAC 定义为幅度-幅度耦合。此外，所提议的计算是无意义的，因为它只计算了 gamma 幅度的熵，完全忽略了来自 theta 信号的任何信息。仅通过观察两个信号中的一个，不可能测量它们之间的关系。最后声称“PAC 不需要相位信息”直接与**相位**-幅度耦合这一术语相矛盾。\n- **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "掌握了理论框架后，下一步是聚焦于 PAC 量化的核心：调制指数（Modulation Index, MI）的计算。本练习提供了一个预先处理好的相位-振幅分布，要求您应用信息论的定义来得出一个具体的耦合值。通过这个动手计算 ，您将能深刻理解 MI 如何将一个复杂的分布简化为单一、有意义的度量。",
            "id": "5061794",
            "problem": "非快速眼动（NREM）睡眠结构的一个核心特征是皮层慢波振荡与丘脑皮层睡眠纺锤波之间的相互作用。皮层慢波振荡是大幅度、低频率（$0.5$–$1$ $\\mathrm{Hz}$）的波，其相位调制了sigma波段（$11$–$16$ $\\mathrm{Hz}$）内睡眠纺锤波的瞬时振幅，这反映了协同的丘脑皮层活动。考虑一段无伪影的10分钟N2期NREM睡眠，在此期间，来自前额叶皮层的局部场电位已经过带通滤波，以分离出慢波振荡和sigma波段的活动。我们使用从希尔伯特变换导出的解析信号估计了慢波振荡的瞬时相位和sigma波段的振幅包络，并且在跨越 $-\\pi$ 到 $\\pi$ 的 $N=8$ 个等宽相位区间内对纺锤波段的振幅进行了平均。由此得到的按相位分箱的、归一化的平均纺锤波振幅分布（其总和为1）为：\n\n$$\np = \\big(0.05,\\ 0.07,\\ 0.08,\\ 0.10,\\ 0.16,\\ 0.18,\\ 0.20,\\ 0.16\\big).\n$$\n\n使用一个基于原理的相位-振幅耦合的信息论定义，该定义量化了观测到的按相位分箱的振幅分布偏离均匀相位分布的程度，并通过其在 $N$ 个区间下的最大可能值来缩放此偏差，请计算该数据集的耦合值。将最终结果表示为无单位小数，并四舍五入到四位有效数字。",
            "solution": "问题陈述经评估有效。它在科学上基于神经生理学和信号处理的既定原理，是适定的，有足够的信息得出唯一解，并使用客观、可形式化的语言进行描述。所提供的数据是一致且符合实际的。\n\n该问题要求基于信息论定义计算相位-振幅耦合（PAC）值。该定义要求量化观测到的按相位分箱的振幅分布 $P$ 与均匀分布 $U$ 之间的偏差，然后用其最大可能值对此偏差进行归一化。此过程精确地描述了一种称为调制指数（MI）的标准PAC度量方法。\n\n该度量方法的核心是库尔贝克-莱布勒（KL）散度 $D_{KL}(P||U)$，它衡量了当一个人将其信念从先验概率分布 $U$ 修正为后验概率分布 $P$ 时的信息增益。它量化了从 $P$ 到 $U$ 的“距离”。\n\n给定的归一化纺锤波振幅在 $N=8$ 个相位区间上的观测分布为：\n$$ P = (p_1, p_2, \\dots, p_8) = \\big(0.05,\\ 0.07,\\ 0.08,\\ 0.10,\\ 0.16,\\ 0.18,\\ 0.20,\\ 0.16\\big) $$\n对于 $N=8$ 个区间的均匀分布 $U$，每个区间的概率为 $p_i = \\frac{1}{N} = \\frac{1}{8} = 0.125$。\n\n从 $P$ 到 $U$ 的KL散度定义为：\n$$ D_{KL}(P||U) = \\sum_{i=1}^{N} p_i \\log\\left(\\frac{p_i}{u_i}\\right) $$\n使用自然对数（$\\ln$），并代入 $u_i = \\frac{1}{N}$：\n$$ D_{KL}(P||U) = \\sum_{i=1}^{N} p_i \\ln(N p_i) = \\sum_{i=1}^{N} p_i (\\ln(N) + \\ln(p_i)) $$\n$$ D_{KL}(P||U) = \\ln(N) \\sum_{i=1}^{N} p_i + \\sum_{i=1}^{N} p_i \\ln(p_i) $$\n由于 $P$ 是一个概率分布，$\\sum_{i=1}^{N} p_i = 1$。这可以用分布 $P$ 的香农熵 $H(P) = -\\sum_{i=1}^{N} p_i \\ln(p_i)$ 来简化表达式。\n$$ D_{KL}(P||U) = \\ln(N) - H(P) $$\nKL散度的最大可能值 $D_{KL,max}$ 出现在分布最集中的情况下，即所有振幅都集中在一个区间内。对于这样的分布 $P_{max}$，其中一个 $p_k=1$，而所有其他 $p_j=0$（其中 $j \\neq k$）。此分布的熵为 $H(P_{max}) = - (1 \\ln(1) + (N-1) \\times 0 \\ln(0)) = 0$，这里我们使用极限定义 $x \\to 0$ 时 $x \\ln(x) \\to 0$。因此，最大偏差为：\n$$ D_{KL,max} = \\ln(N) - H(P_{max}) = \\ln(N) $$\n调制指数（MI）是KL散度通过此最大值进行归一化的结果：\n$$ \\text{MI} = \\frac{D_{KL}(P||U)}{D_{KL,max}} = \\frac{\\ln(N) - H(P)}{\\ln(N)} $$\n现在我们为给定的数据计算这个值。\n首先，我们计算分布 $p$ 的香农熵 $H(P)$：\n$$ H(P) = - \\sum_{i=1}^{8} p_i \\ln(p_i) $$\n$$ H(P) = - \\big[ 0.05 \\ln(0.05) + 0.07 \\ln(0.07) + 0.08 \\ln(0.08) + 0.10 \\ln(0.10) + 0.16 \\ln(0.16) + 0.18 \\ln(0.18) + 0.20 \\ln(0.20) + 0.16 \\ln(0.16) \\big] $$\n各项分别为：\n$0.05 \\ln(0.05) \\approx -0.149787$\n$0.07 \\ln(0.07) \\approx -0.186148$\n$0.08 \\ln(0.08) \\approx -0.202058$\n$0.10 \\ln(0.10) \\approx -0.230259$\n$2 \\times 0.16 \\ln(0.16) \\approx 2 \\times (-0.293213) = -0.586426$\n$0.18 \\ln(0.18) \\approx -0.308664$\n$0.20 \\ln(0.20) \\approx -0.321888$\n\n将这些值相加：\n$$ \\sum_{i=1}^{8} p_i \\ln(p_i) \\approx -0.149787 - 0.186148 - 0.202058 - 0.230259 - 0.586426 - 0.308664 - 0.321888 = -1.985230 $$\n因此，熵为：\n$$ H(P) \\approx -(-1.985230) = 1.985230 \\text{ 奈特} $$\n对于 $N=8$ 个区间，最大可能熵为：\n$$ H_{max} = \\ln(N) = \\ln(8) \\approx 2.079442 \\text{ 奈特} $$\n现在，我们可以计算调制指数：\n$$ \\text{MI} = \\frac{\\ln(8) - H(P)}{\\ln(8)} \\approx \\frac{2.079442 - 1.985230}{2.079442} $$\n$$ \\text{MI} \\approx \\frac{0.094212}{2.079442} \\approx 0.0453063 $$\n问题要求将结果四舍五入到四位有效数字。\n$$ \\text{MI} \\approx 0.04531 $$\n这个无单位的值表示相位-振幅耦合的强度。值为 $0$ 表示没有耦合（振幅呈均匀分布），而值为 $1$ 表示最大耦合（所有振幅都锁定在单个相位区间）。",
            "answer": "$$\\boxed{0.04531}$$"
        },
        {
            "introduction": "最后的实践环节将所有概念和技能融为一体，模拟一个完整的研究场景。在这个编程练习中，您需要从零开始，生成模拟的神经信号，并实现一个端到端的 PAC 分析流程。这项任务  不仅包括计算调制指数，还涉及执行必要的统计显著性检验，从而让您体验如何从原始数据中得出科学结论。",
            "id": "5015887",
            "problem": "你的任务是量化单个颅内脑电图（iEEG）通道中低频振荡的相位与高频振荡的振幅之间的相位-振幅耦合（PAC），然后检验这种耦合是否从发作前期到发作期有显著增强。该研究涉及癫痫和癫痫发作网络动力学，并基于应用于iEEG神经生理学的、经过充分检验的信号处理原理。\n\n基本原理和定义：\n\n- 设 $x(t)$ 是一个实值iEEG时间序列，采样率为 $f_s$ 样本/秒（单位为$\\mathrm{Hz}$）。使用通带为 $[f_{\\ell},f_h]$（其中 $f_{\\ell}$ 和 $f_h$ 的单位为$\\mathrm{Hz}$）的零相位有限脉冲响应滤波器，可以获得带通滤波分量 $x_{[f_{\\ell},f_h]}(t)$。\n- 对于一个实信号 $y(t)$，通过希尔伯特变换定义的解析信号为 $z(t) = y(t) + i\\,\\mathcal{H}\\{y(t)\\}$. 瞬时振幅为 $A(t) = |z(t)|$，瞬时相位（单位为弧度）为 $\\phi(t) = \\arg[z(t)]$。\n- 相位-振幅耦合的操作化方法是，取theta波段（$4$-$8\\,\\mathrm{Hz}$）的瞬时相位和gamma波段（$30$-$80\\,\\mathrm{Hz}$）的瞬时振幅。为量化耦合，将相位范围 $[-\\pi,\\pi)$ 划分为 $N$ 个相等的区间。对于每个区间 $k \\in \\{1,\\dots,N\\}$，计算其theta相位落在区间 $k$ 内的所有时间点上的平均gamma振幅 $\\bar{A}_k$。令 $p_k = \\bar{A}_k / \\sum_{j=1}^{N} \\bar{A}_j$，并令 $u_k = 1/N$ 为均匀分布。调制指数（MI）是归一化的 Kullback–Leibler 散度\n$$\n\\mathrm{MI} = \\frac{ \\sum_{k=1}^{N} p_k \\log\\left(\\frac{p_k}{u_k}\\right)}{ \\log(N) }.\n$$\n- 为检验PAC的显著变化，定义观测差异 $\\Delta_{\\mathrm{obs}} = \\mathrm{MI}_{\\mathrm{ictal}} - \\mathrm{MI}_{\\mathrm{preictal}}$。通过将gamma振幅时间序列相对于theta相位进行循环移位（在发作前期和发作期片段内独立进行），移位量为随机偏移（以样本为单位），然后重新计算差异，从而为 $\\Delta$ 构建一个零分布。表示增加的单边$p$值是代理差异大于或等于 $\\Delta_{\\mathrm{obs}}$ 的比例，此过程总共使用 $S$ 个代理数据。如果 $\\Delta_{\\mathrm{obs}}  0$ 且 $p  \\alpha$（其中 $\\alpha$ 是显著性水平），则宣告存在统计上显著的增加。\n\n你的程序必须实现上述原理，并为以下自包含的测试套件生成结果。在每个测试中，使用以下生成模型为发作前期和发作期生成合成iEEG信号。设 $\\theta(t) = 2\\pi f_{\\theta} t$ 和 $\\gamma(t) = 2\\pi f_{\\gamma} t$，其中 $t$ 的单位为秒。iEEG信号为\n$$\nx(t) = A_{\\theta}\\cos\\left(\\theta(t)\\right) + \\left[A_{\\gamma,0}\\left(1 + k\\cos\\left(\\theta(t) - \\phi_0\\right)\\right)\\right]\\cos\\left(\\gamma(t)\\right) + \\eta(t),\n$$\n其中 $\\eta(t)$ 是标准差为 $\\sigma$ 的零均值高斯噪声（单位与 $x(t)$ 相同），$k$ 是耦合强度（无量纲），$A_{\\theta}$ 和 $A_{\\gamma,0}$ 是基线振幅，$\\phi_0$ 是一个优选的theta相位（单位为弧度）。通过选择满足 $1 + k\\cos(\\cdot) \\ge 0$ 的 $k$ 值，确保振幅包络对所有 $t$ 均为非负。\n\n对每个测试用例，执行以下步骤：\n\n1. 使用下面指定的参数，通过生成模型生成发作前期和发作期的iEEG信号。\n2. 通过在 $[4,8]\\,\\mathrm{Hz}$ 对 $x(t)$ 进行带通滤波并计算解析相位 $\\phi_{\\theta}(t)$（单位为弧度）来提取theta相位。\n3. 通过在 $[30,80]\\,\\mathrm{Hz}$ 对 $x(t)$ 进行带通滤波并计算解析振幅 $A_{\\gamma}(t)$ 来提取gamma振幅。\n4. 使用 $N$ 个相位区间计算 $\\mathrm{MI}_{\\mathrm{preictal}}$ 和 $\\mathrm{MI}_{\\mathrm{ictal}}$。\n5. 在发作前期和发作期片段中独立使用 $S$ 个循环移位代理数据，计算表示增加的单边 $p$ 值。\n6. 对每个测试用例返回一个布尔值结果，该结果指示在显著性水平 $\\alpha$ 下，PAC是否从发作前期到发作期有统计上显著的增加。\n\n所有相位量均使用弧度。频率使用$\\mathrm{Hz}$，时间使用秒。最终输出为布尔值，输出无需物理单位。\n\n测试套件参数集（每个用例均使用 $A_{\\theta} = 0.5$, $A_{\\gamma,0} = 1.0$, $\\phi_0 = 0$ 弧度, $N = 18$ 个区间, $S = 200$ 个代理数据, 以及 $\\alpha = 0.05$）:\n\n- 用例 1 （理想情况：耦合明显增加）:\n  - 采样率 $f_s = 1000\\,\\mathrm{Hz}$,\n  - 发作前期时长 $T_{\\mathrm{pre}} = 10\\,\\mathrm{s}$,\n  - 发作期时长 $T_{\\mathrm{ict}} = 10\\,\\mathrm{s}$,\n  - Theta频率 $f_{\\theta} = 6\\,\\mathrm{Hz}$,\n  - Gamma频率 $f_{\\gamma} = 50\\,\\mathrm{Hz}$,\n  - 发作前期耦合 $k_{\\mathrm{pre}} = 0.10$,\n  - 发作期耦合 $k_{\\mathrm{ict}} = 0.40$,\n  - 噪声标准差 $\\sigma = 0.5$.\n- 用例 2 （耦合无变化）:\n  - $f_s = 1000\\,\\mathrm{Hz}$,\n  - $T_{\\mathrm{pre}} = 10\\,\\mathrm{s}$,\n  - $T_{\\mathrm{ict}} = 10\\,\\mathrm{s}$,\n  - $f_{\\theta} = 6\\,\\mathrm{Hz}$,\n  - $f_{\\gamma} = 50\\,\\mathrm{Hz}$,\n  - $k_{\\mathrm{pre}} = 0.20$,\n  - $k_{\\mathrm{ict}} = 0.20$,\n  - $\\sigma = 0.5$.\n- 用例 3 （耦合减少）:\n  - $f_s = 1000\\,\\mathrm{Hz}$,\n  - $T_{\\mathrm{pre}} = 10\\,\\mathrm{s}$,\n  - $T_{\\mathrm{ict}} = 10\\,\\mathrm{s}$,\n  - $f_{\\theta} = 6\\,\\mathrm{Hz}$,\n  - $f_{\\gamma} = 50\\,\\mathrm{Hz}$,\n  - $k_{\\mathrm{pre}} = 0.35$,\n  - $k_{\\mathrm{ict}} = 0.05$,\n  - $\\sigma = 0.5$.\n- 用例 4 （边界情况：较短片段给检测带来挑战）:\n  - $f_s = 1000\\,\\mathrm{Hz}$,\n  - $T_{\\mathrm{pre}} = 5\\,\\mathrm{s}$,\n  - $T_{\\mathrm{ict}} = 5\\,\\mathrm{s}$,\n  - $f_{\\theta} = 6\\,\\mathrm{Hz}$,\n  - $f_{\\gamma} = 50\\,\\mathrm{Hz}$,\n  - $k_{\\mathrm{pre}} = 0.10$,\n  - $k_{\\mathrm{ict}} = 0.40$,\n  - $\\sigma = 0.7$.\n\n最终输出格式：\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3,result4]”），其中每个“result”是一个布尔值（$\\mathrm{True}$ 或 $\\mathrm{False}$），表示在显著性水平 $\\alpha$ 下，对应的测试用例中PAC是否从发作前期到发作期有统计上显著的增加。",
            "solution": "用户提供了一个科学上合理、定义明确且客观的问题。它概述了计算神经科学中量化和比较两种生理状态之间相位-振幅耦合（PAC）的标准流程。该问题要求基于既定原则，实现一个从信号生成到统计分析的完整流程。所指定的方法——包括使用零相位FIR滤波器、用于提取解析信号分量的希尔伯特变换、基于Kullback-Leibler散度的调制指数（MI），以及使用循环移位进行统计推断的置换检验——都是执行此任务的标准且合适的方法。\n\n该问题的详细程度足以得出一个唯一且可验证的解，只有一个微小的例外：没有提供有限脉冲响应（FIR）滤波器的阶数。这是滤波器设计所必需的参数。根据我作为专家的角色，我将为此参数选择合理的、标准的值，并说明我的选择。这一疏漏并不会使问题无效，因为该领域的从业者通常会根据既定的启发式方法做出此类选择。我将继续提供完整的解决方案。\n\n以下是所用方法的分步解析。\n\n**1. 合成信号生成**\n\n此问题的基础是颅内脑电图（iEEG）信号 $x(t)$ 的生成模型。该模型由下式给出：\n$$\nx(t) = A_{\\theta}\\cos(2\\pi f_{\\theta} t) + \\left[A_{\\gamma,0}\\left(1 + k\\cos(2\\pi f_{\\theta} t - \\phi_0)\\right)\\right]\\cos(2\\pi f_{\\gamma} t) + \\eta(t)\n$$\n此方程描述了一个由三部分组成的信号：一个低频theta振荡、一个其振幅受theta振荡相位调制的高频gamma振荡，以及标准差为 $\\sigma$ 的加性高斯噪声 $\\eta(t)$。参数 $k$ 控制耦合的强度。对于每个测试用例，我们生成两个这样的信号：一个用于发作前期，耦合强度为 $k_{\\mathrm{pre}}$；另一个用于发作期，耦合强度为 $k_{\\mathrm{ict}}$。时间向量 $t$ 是根据指定的持续时间（$T_{\\mathrm{pre}}$ 或 $T_{\\mathrm{ict}}$）和采样率（$f_s$）生成的。\n\n**2. 信号处理：滤波与解析信号提取**\n\n为了分离相关的频率分量，我们应用带通滤波。问题指定使用零相位FIR滤波器。这是通过 `scipy.signal` 库中的两个函数实现的：\n- `scipy.signal.firwin`：此函数根据给定的滤波器阶数和截止频率设计线性相位FIR滤波器。对于未指定的滤波器阶数，我将使用标准的启发式方法。对于theta波段（$[4, 8]\\,\\mathrm{Hz}$），选择251阶，这在给定的1000Hz采样率下约等于最低频率（$4\\,\\mathrm{Hz}$）的一个完整周期。对于gamma波段（$[30, 80]\\,\\mathrm{Hz}$），选择101阶。选择奇数阶滤波器是为了创建I型（对称）滤波器。\n- `scipy.signal.filtfilt`：此函数将设计的滤波器应用于信号两次，一次前向，一次后向。此过程消除了滤波器引入的相位延迟，从而产生所需的零相位输出。\n\n滤波后，我们得到theta波段信号 $x_{\\theta}(t)$ 和gamma波段信号 $x_{\\gamma}(t)$。我们从这些信号中提取瞬时相位和振幅。这是通过使用希尔伯特变换 $\\mathcal{H}$ 构建解析信号 $z(t) = y(t) + i\\,\\mathcal{H}\\{y(t)\\}$ 来完成的。\n- theta相位被提取为 $\\phi_{\\theta}(t) = \\arg[z_{\\theta}(t)]$，其中 $z_{\\theta}(t)$ 是 $x_{\\theta}(t)$ 的解析信号。\n- gamma振幅被提取为 $A_{\\gamma}(t) = |z_{\\gamma}(t)|$，其中 $z_{\\gamma}(t)$ 是 $x_{\\gamma}(t)$ 的解析信号。\n\n**3. 耦合量化：调制指数（MI）**\n\nPAC的程度使用调制指数（MI）进行量化。对于给定的相位（$\\phi_{\\theta}$）和振幅（$A_{\\gamma}$）时间序列对，这包括以下步骤：\n1.  连续的相位范围 $[-\\pi, \\pi)$ 被离散化为 $N=18$ 个等大小的区间。\n2.  对于每个时间点 $t$，我们确定值 $\\phi_{\\theta}(t)$ 落在哪个相位区间。\n3.  对于每个区间 $k \\in \\{1, \\dots, N\\}$，我们计算所有其对应相位 $\\phi_{\\theta}(t)$ 落入该区间的gamma振幅值 $A_{\\gamma}(t)$ 的平均值。设此平均振幅为 $\\bar{A}_k$。\n4.  将此平均振幅的分布归一化，以形成概率分布 $p_k = \\bar{A}_k / \\sum_{j=1}^{N} \\bar{A}_j$。\n5.  然后，MI被计算为分布 $P = \\{p_k\\}$ 和均匀分布 $U = \\{u_k = 1/N\\}$ 之间的归一化Kullback-Leibler（KL）散度。公式为：\n    $$\n    \\mathrm{MI} = \\frac{ D_{KL}(P || U) }{ \\log(N) } = \\frac{ \\sum_{k=1}^{N} p_k \\log\\left(\\frac{p_k}{u_k}\\right)}{ \\log(N) }\n    $$\n    MI为0表示没有耦合（振幅分布在所有相位区间上是均匀的），而MI接近1表示最大耦合。在实现中，需要注意处理 $p_k=0$ 的情况，此时 $p_k \\log(p_k)$ 项定义为0。\n\n**4. 统计假设检验**\n\n为了确定PAC从发作前期到发作期的增加是否具有统计显著性，我们执行非参数置换检验。\n1.  首先，我们分别计算发作前期和发作期的MI，即 $\\mathrm{MI}_{\\mathrm{preictal}}$ 和 $\\mathrm{MI}_{\\mathrm{ictal}}$。观测到的差异为 $\\Delta_{\\mathrm{obs}} = \\mathrm{MI}_{\\mathrm{ictal}} - \\mathrm{MI}_{\\mathrm{preictal}}$。\n2.  接下来，我们在无耦合的假设下，生成这些差异的零分布。这是通过重复破坏theta相位和gamma振幅时间序列之间的关系来完成的。对于 $S=200$ 次代理试验中的每一次：\n    a. 在发作前期片段内，gamma振幅时间序列 $A_{\\gamma, \\mathrm{pre}}(t)$ 被循环移位一个随机的样本数。使用原始相位 $\\phi_{\\theta, \\mathrm{pre}}(t)$ 和移位后的振幅计算一个新的代理MI，$\\mathrm{MI}_{\\mathrm{pre, surr}}$。\n    b. 在发作期片段上独立执行相同的过程，以计算 $\\mathrm{MI}_{\\mathrm{ict, surr}}$。\n    c. 计算一个代理差异：$\\Delta_{\\mathrm{surr}} = \\mathrm{MI}_{\\mathrm{ict, surr}} - \\mathrm{MI}_{\\mathrm{pre, surr}}$。\n3.  $S$ 个代理差异的集合构成了经验零分布。单边p值是代理差异大于或等于观测差异的比例：$p = \\frac{\\text{count}(\\Delta_{\\mathrm{surr}} \\ge \\Delta_{\\mathrm{obs}})}{S}$。\n4.  如果满足两个条件，则宣告PAC有统计上显著的增加：观测差异显示增加（$\\Delta_{\\mathrm{obs}} > 0$）且p值低于显著性水平（$p  \\alpha = 0.05$）。\n\n这个完整的流程将应用于所提供的四个测试用例中的每一个。为了可复现性，对随机数生成器使用了固定的种子，这会影响噪声生成和代理移位。",
            "answer": "```python\nimport numpy as np\nfrom scipy import signal\n\ndef solve():\n    \"\"\"\n    Main function to solve the PAC analysis problem for all test cases.\n    \"\"\"\n    # Set a seed for reproducibility of noise and surrogate shifts.\n    np.random.seed(0)\n\n    # Define the test cases from the problem statement.\n    common_params = {\n        'A_theta': 0.5,\n        'A_gamma0': 1.0,\n        'phi0': 0.0,\n        'N_bins': 18,\n        'S_surrogates': 200,\n        'alpha': 0.05,\n    }\n    test_cases = [\n        # Case 1 (happy path: clear increase in coupling)\n        {'fs': 1000, 'T_pre': 10, 'T_ict': 10, 'f_theta': 6, 'f_gamma': 50, 'k_pre': 0.10, 'k_ict': 0.40, 'sigma': 0.5},\n        # Case 2 (no change in coupling)\n        {'fs': 1000, 'T_pre': 10, 'T_ict': 10, 'f_theta': 6, 'f_gamma': 50, 'k_pre': 0.20, 'k_ict': 0.20, 'sigma': 0.5},\n        # Case 3 (decrease in coupling)\n        {'fs': 1000, 'T_pre': 10, 'T_ict': 10, 'f_theta': 6, 'f_gamma': 50, 'k_pre': 0.35, 'k_ict': 0.05, 'sigma': 0.5},\n        # Case 4 (boundary: shorter segments challenge detection)\n        {'fs': 1000, 'T_pre': 5, 'T_ict': 5, 'f_theta': 6, 'f_gamma': 50, 'k_pre': 0.10, 'k_ict': 0.40, 'sigma': 0.7},\n    ]\n\n    def generate_signal(T, fs, f_theta, f_gamma, A_theta, A_gamma0, k, phi0, sigma):\n        \"\"\"Generates the synthetic iEEG signal based on the model.\"\"\"\n        num_samples = int(T * fs)\n        t = np.arange(num_samples) / fs\n        theta_t = 2 * np.pi * f_theta * t\n        gamma_t = 2 * np.pi * f_gamma * t\n        \n        # Generative model\n        low_freq_component = A_theta * np.cos(theta_t)\n        amp_modulator = A_gamma0 * (1 + k * np.cos(theta_t - phi0))\n        high_freq_component = amp_modulator * np.cos(gamma_t)\n        noise = sigma * np.random.randn(num_samples)\n        \n        return low_freq_component + high_freq_component + noise\n\n    def compute_mi(phase, amp, N_bins):\n        \"\"\"Computes the Modulation Index (MI).\"\"\"\n        phase_bins = np.linspace(-np.pi, np.pi, N_bins + 1)\n        # Assign each phase value to a bin. np.digitize uses 1-based indexing for bins.\n        binned_phase = np.digitize(phase, bins=phase_bins)\n        \n        mean_amp_per_bin = np.zeros(N_bins)\n        for k in range(1, N_bins + 1):\n            amp_in_bin = amp[binned_phase == k]\n            if len(amp_in_bin) > 0:\n                mean_amp_per_bin[k-1] = np.mean(amp_in_bin)\n        \n        # Normalize to a probability distribution p_k\n        total_mean_amp = np.sum(mean_amp_per_bin)\n        if total_mean_amp == 0:\n            return 0.0\n        \n        p = mean_amp_per_bin / total_mean_amp\n        \n        # Compute Kullback-Leibler divergence D_KL(P || U)\n        u = 1.0 / N_bins\n        p_nonzero = p[p > 0]\n        # KL divergence: sum(p*log(p/u)) = sum(p*log(p)) - sum(p*log(u))\n        # = sum(p*log(p)) + log(N)\n        kl_div = np.sum(p_nonzero * np.log(p_nonzero)) + np.log(N_bins)\n        \n        # Normalize by log(N)\n        mi = kl_div / np.log(N_bins)\n        return mi\n\n    results = []\n    \n    # Filter parameters\n    theta_band = [4, 8]\n    gamma_band = [30, 80]\n    fir_order_theta = 251 # Corresponds to ~1 cycle of the 4 Hz component at 1 kHz fs\n    fir_order_gamma = 101 # Corresponds to ~3 cycles of the 30 Hz component at 1 kHz fs\n\n    for case_params in test_cases:\n        params = {**common_params, **case_params}\n        fs = params['fs']\n        \n        # 1. Generate preictal and ictal signals\n        x_pre = generate_signal(params['T_pre'], fs, params['f_theta'], params['f_gamma'], params['A_theta'], params['A_gamma0'], params['k_pre'], params['phi0'], params['sigma'])\n        x_ict = generate_signal(params['T_ict'], fs, params['f_theta'], params['f_gamma'], params['A_theta'], params['A_gamma0'], params['k_ict'], params['phi0'], params['sigma'])\n        \n        # 2-3. Filter signals and extract phase/amplitude\n        # Design filters\n        b_theta = signal.firwin(fir_order_theta, theta_band, fs=fs, pass_zero='bandpass')\n        b_gamma = signal.firwin(fir_order_gamma, gamma_band, fs=fs, pass_zero='bandpass')\n        \n        # Preictal processing\n        x_pre_theta = signal.filtfilt(b_theta, 1, x_pre)\n        phase_pre = np.angle(signal.hilbert(x_pre_theta))\n        x_pre_gamma = signal.filtfilt(b_gamma, 1, x_pre)\n        amp_pre = np.abs(signal.hilbert(x_pre_gamma))\n        \n        # Ictal processing\n        x_ict_theta = signal.filtfilt(b_theta, 1, x_ict)\n        phase_ict = np.angle(signal.hilbert(x_ict_theta))\n        x_ict_gamma = signal.filtfilt(b_gamma, 1, x_ict)\n        amp_ict = np.abs(signal.hilbert(x_ict_gamma))\n        \n        # 4. Compute observed MI and their difference\n        mi_pre = compute_mi(phase_pre, amp_pre, params['N_bins'])\n        mi_ict = compute_mi(phase_ict, amp_ict, params['N_bins'])\n        obs_diff = mi_ict - mi_pre\n        \n        # 5. Perform surrogate testing\n        surrogate_diffs = np.zeros(params['S_surrogates'])\n        for i in range(params['S_surrogates']):\n            # Preictal surrogate\n            shift_pre = np.random.randint(1, len(amp_pre))\n            amp_pre_surr = np.roll(amp_pre, shift_pre)\n            mi_pre_surr = compute_mi(phase_pre, amp_pre_surr, params['N_bins'])\n            \n            # Ictal surrogate\n            shift_ict = np.random.randint(1, len(amp_ict))\n            amp_ict_surr = np.roll(amp_ict, shift_ict)\n            mi_ict_surr = compute_mi(phase_ict, amp_ict_surr, params['N_bins'])\n            \n            surrogate_diffs[i] = mi_ict_surr - mi_pre_surr\n            \n        # Compute one-sided p-value\n        p_value = np.sum(surrogate_diffs >= obs_diff) / params['S_surrogates']\n        \n        # 6. Determine significance\n        is_significant_increase = (obs_diff > 0) and (p_value  params['alpha'])\n        results.append(is_significant_increase)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}