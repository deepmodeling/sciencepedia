{
    "hands_on_practices": [
        {
            "introduction": "在分析神经数据之前，理解记录设备本身的物理和工程约束至关重要。高密度探针的设计参数，如电极间距和探针长度，直接决定了通道总数，进而对数据采集系统提出了巨大的挑战。本练习将引导你从第一性原理出发，计算一个典型线性探针上的记录位点数量，并确定在给定的采样率和总线速度下，需要多少并行数据通路才能无损地读取所有通道的信号 。这个计算过程揭示了现代神经电生理学中硬件设计和数据吞吐量之间的根本权衡。",
            "id": "4138200",
            "problem": "一个高密度线性细胞外记录位点阵列被制作在长度为 $10\\,\\mathrm{mm}$ 的单个硅探针柄上。沿探针柄方向，相邻位点中心的间距为均匀的 $20\\,\\mu\\mathrm{m}$。每个位点都使用时分复用 (TDM) 技术进行读出，即多个通道共享一条数据总线。信号链必须能够保存能量主要集中在 $7.5\\,\\mathrm{kHz}$ 以下的单单位峰电位波形，并且根据奈奎斯特采样定理和工程实践的限制，每个通道的采样频率需为 $30\\,\\mathrm{kHz}$。共享总线是一条单端金属线，其最大符号率受其电阻-电容乘积的限制，为 $12\\,\\mathrm{MHz}$。由于寻址、同步和建立时间的开销，每秒只有一部分 $(1-\\gamma)$ 的总线符号可用于实际的样本传输，其中 $\\gamma=0.20$。\n\n从间距和采样要求的定义以及 TDM 吞吐量的约束出发，确定探针柄上的记录位点数量，然后从第一性原理推导出，在给定的总线约束下，为保证每个位点都以 $30\\,\\mathrm{kHz}$ 的频率进行采样，所需独立并行 TDM 总线的最小数量。将最终答案表示为所需的并行总线最小数量的单个整数。最终答案无需单位。在推导过程中，除推导本身所隐含的取整外，不要对中间步骤进行四舍五入；最终答案根据构造是精确的。",
            "solution": "问题要求确定读出高密度电生理探针上所有记录位点所需的并行时分复用 (TDM) 总线的最小数量。该解答基于所提供的物理和操作参数，从第一性原理推导得出。\n\n给定的参数如下：\n- 探针柄长度: $L = 10\\,\\mathrm{mm}$\n- 相邻记录位点间距: $p = 20\\,\\mu\\mathrm{m}$\n- 每通道采样频率: $f_s = 30\\,\\mathrm{kHz}$\n- 单条总线的最大符号率: $R_{bus,max} = 12\\,\\mathrm{MHz}$\n- 总线开销因子: $\\gamma = 0.20$\n\n解答过程分为四个步骤：\n1.  计算记录位点的总数 $N_{sites}$。\n2.  计算整个阵列所需的总采样吞吐量 $R_{total, req}$。\n3.  计算单条总线可用的有效数据吞吐量 $R_{bus, eff}$。\n4.  确定并行总线的最小数量 $N_{buses}$。\n\n**步骤 1：确定记录位点的数量**\n记录位点沿长度为 $L$ 的探针柄呈线性阵列排列。相邻位点的中心由均匀间距 $p$ 分隔。假设在这段长度的起点（位置 $0$）和终点（位置 $L$）都放置一个位点，则长度为 $p$ 的区间数量为 $\\frac{L}{p}$。位点的总数比区间数多一，这是离散元素沿连续维度排列的标准结果。\n首先，我们统一单位。将探针柄长度 $L$ 从毫米转换为微米：\n$$L = 10\\,\\mathrm{mm} = 10 \\times 10^3\\,\\mu\\mathrm{m} = 10000\\,\\mu\\mathrm{m}$$\n间距给定为 $p = 20\\,\\mu\\mathrm{m}$。\n因此，位点数量 $N_{sites}$ 为：\n$$N_{sites} = \\frac{L}{p} + 1 = \\frac{10000\\,\\mu\\mathrm{m}}{20\\,\\mu\\mathrm{m}} + 1 = 500 + 1 = 501$$\n探针柄上有 $501$ 个记录位点。\n\n**步骤 2：确定所需的总采样吞吐量**\n$N_{sites}$ 个通道中的每一个都以 $f_s = 30\\,\\mathrm{kHz}$ 的频率进行采样。所需的总吞吐量，即每秒需要从所有位点传输的样本总数，是位点数量与每通道采样频率的乘积。\n$$R_{total, req} = N_{sites} \\times f_s$$\n问题陈述提供了信号带宽低于 $7.5\\,\\mathrm{kHz}$ 的背景信息。根据奈奎斯特采样定理，为避免混叠所需的最小采样率是最高频率分量的两倍，即 $2 \\times 7.5\\,\\mathrm{kHz} = 15\\,\\mathrm{kHz}$。所选的采样频率 $f_s = 30\\,\\mathrm{kHz}$ 大于此最小值，这证实了该设置的科学有效性。\n代入数值：\n$$R_{total, req} = 501 \\times 30\\,\\mathrm{kHz} = 501 \\times 30 \\times 10^3\\,\\mathrm{s}^{-1} = 15030 \\times 10^3\\,\\mathrm{s}^{-1} = 15.03 \\times 10^6\\,\\mathrm{s}^{-1}$$\n所需的总吞吐量为每秒 $15.03$ 百万样本 ($15.03\\,\\mathrm{MSamples/s}$)。\n\n**步骤 3：确定单条总线的有效吞吐量**\n单条 TDM 总线的最大符号率为 $R_{bus,max} = 12\\,\\mathrm{MHz}$。在样本传输的背景下，我们将其解释为每秒最多可传输 $12 \\times 10^6$ 个样本。然而，该容量的一部分（比例为 $\\gamma = 0.20$）会因开销而损失。可用于数据传输的比例为 $(1-\\gamma)$。单条总线的有效吞吐量 $R_{bus, eff}$ 为：\n$$R_{bus, eff} = R_{bus,max} \\times (1 - \\gamma)$$\n代入数值：\n$$R_{bus, eff} = (12 \\times 10^6\\,\\mathrm{s}^{-1}) \\times (1 - 0.20) = (12 \\times 10^6\\,\\mathrm{s}^{-1}) \\times 0.80 = 9.6 \\times 10^6\\,\\mathrm{s}^{-1}$$\n单条总线每秒可有效处理 $9.6$ 百万样本 ($9.6\\,\\mathrm{MSamples/s}$)。\n\n**步骤 4：确定并行总线的最小数量**\n为使用有效吞吐量为 $R_{bus, eff}$ 的并行总线来满足所需的总吞吐量 $R_{total, req}$，总线数量必须至少为所需总速率与单总线速率之比。由于总线数量必须是整数，我们必须对这个比值向上取整（取天花板函数），以确保容量充足。\n设 $N_{buses}$ 为总线的最小数量。\n$$N_{buses} = \\left\\lceil \\frac{R_{total, req}}{R_{bus, eff}} \\right\\rceil$$\n代入计算出的吞吐量值：\n$$N_{buses} = \\left\\lceil \\frac{15.03 \\times 10^6\\,\\mathrm{s}^{-1}}{9.6 \\times 10^6\\,\\mathrm{s}^{-1}} \\right\\rceil = \\left\\lceil \\frac{15.03}{9.6} \\right\\rceil$$\n该比值的数值为：\n$$\\frac{15.03}{9.6} = 1.565625$$\n应用向上取整函数（天花板函数），该函数给出不小于其参数的最小整数：\n$$N_{buses} = \\lceil 1.565625 \\rceil = 2$$\n因此，在给定的总线约束下，要以指定频率对所有 $501$ 个位点进行采样，至少需要 $2$ 条独立的并行 TDM 总线。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "理想化的数据采集在现实中很少见；原始电生理记录常常被各种伪迹（artifacts）污染，这些伪迹的幅度可能远超神经信号。本练习模拟了一个常见的场景：一个大幅值的瞬时电压伪迹进入了信号链路，并探讨了它与模数转换器（ADC）的相互作用 。通过精确计算由该伪迹导致的ADC饱和（即“削波”）持续时间，你将学会如何量化由此造成的数据丢失比例，这是评估数据质量和在后续分析中做出明智决策的一项关键技能。",
            "id": "4138171",
            "problem": "一个高密度硅电生理探头通过一个模拟前端和一个模数转换器（ADC）记录细胞外动作电位。该ADC具有对称的参考输入满量程$\\pm V_{\\mathrm{fs}}$，其中$V_{\\mathrm{fs}} = 1\\,\\mathrm{mV}$，当输入超过此范围时，它会输出饱和的轨到轨编码。考虑在时间$t=0$时，ADC输入端出现一个突然的伪影，表现为一个正向瞬变，其模型为$v(t) = A \\exp(-t/\\tau)$，其中$A = 2\\,\\mathrm{mV}$，$\\tau = 3\\,\\mathrm{ms}$。在时长为$T_{\\mathrm{obs}} = 1\\,\\mathrm{s}$的观测窗口内，神经脉冲以速率$r$（脉冲/秒）的齐次泊松过程形式出现，且与伪影无关。任何其出现时间落在$|v(t)| > V_{\\mathrm{fs}}$区间内的神经脉冲都被认为是削波的且不可用。\n\n从ADC链路中模拟饱和和数字削波的基本原理出发，解释伪影如何导致削波，并推导在观测窗口内被削波的神经脉冲的比例。仅使用满量程饱和的定义和给定的伪影模型作为出发点。将最终比例以小数形式给出，四舍五入到四位有效数字，并且不使用百分号表示。",
            "solution": "该问题要求解释削波机制，并推导在给定观测窗口内被削波的神经脉冲的比例。\n\n首先，我们验证问题陈述的有效性。\n已知条件如下：\n- ADC对称的参考输入满量程：$\\pm V_{\\mathrm{fs}}$\n- 满量程电压：$V_{\\mathrm{fs}} = 1\\,\\mathrm{mV}$\n- ADC行为：当输入$|v(t)| > V_{\\mathrm{fs}}$时，输出饱和（产生轨到轨编码）\n- ADC输入端的伪影模型：$v(t) = A \\exp(-t/\\tau)$，对于$t \\ge 0$\n- 伪影幅度：$A = 2\\,\\mathrm{mV}$\n- 伪影时间常数：$\\tau = 3\\,\\mathrm{ms}$\n- 神经脉冲出现模型：速率为$r$的齐次泊松过程\n- 观测窗口：$T_{\\mathrm{obs}} = 1\\,\\mathrm{s}$\n- 削波条件：如果一个神经脉冲的出现时间落在$|v(t)| > V_{\\mathrm{fs}}$的区间内，则该脉冲被削波\n\n该问题具有科学依据，描述了电生理学中一个标准的信号处理问题。所使用的数学模型（指数衰减、泊松过程）是恰当且被广泛使用的。该问题是适定的，因为所有必要的参数都已提供，并且它会导出一个唯一的、有意义的解。语言客观而精确。因此，该问题被认为是有效的，可以推导出解答。\n\n削波现象源于模数转换器（ADC）的基本限制。ADC将一个连续的模拟输入电压量化为一组有限的离散数字码。这种量化仅在特定的输入电压范围内有效，这里定义为从$-V_{\\mathrm{fs}}$到$+V_{\\mathrm{fs}}$的对称满量程范围。当输入电压的幅值$|v(t)|$超过$V_{\\mathrm{fs}}$时，ADC被驱动进入饱和状态。在此状态下，其输出固定在可能的最大或最小数字值（“轨到轨编码”），并且不再能表示输入电压的变化。伪影的初始幅度$A = 2\\,\\mathrm{mV}$大于满量程电压$V_{\\mathrm{fs}} = 1\\,\\mathrm{mV}$。因此，在$t=0$时，伪影电压$v(0) = A = 2\\,\\mathrm{mV}$迫使ADC进入饱和状态。任何在ADC被大伪影电压饱和时发生的神经脉冲（一种微小、快速的电压波动）都将丢失或被“削波”，因为ADC的输出已经达到其极限，无法记录由脉冲引起的额外电压变化。\n\n为了求出被削波的神经脉冲的比例，我们首先注意到，对于速率为$r$的齐次泊松过程，在时长为$T$的时间间隔内发生的事件（神经脉冲）的期望数由$rT$给出。在时长为$T_{\\mathrm{obs}}$的观测窗口内，神经脉冲的总期望数为$N_{\\mathrm{total}} = r T_{\\mathrm{obs}}$。\n\n如果一个神经脉冲发生在ADC饱和的时间区间内，它就会被削波。设这个区间的总时长为$T_{\\mathrm{clip}}$。被削波的神经脉冲的期望数为$N_{\\mathrm{clipped}} = r T_{\\mathrm{clip}}$。被削波的神经脉冲的比例$F_{\\mathrm{clipped}}$是被削波的神经脉冲期望数与总神经脉冲期望数之比：\n$$\nF_{\\mathrm{clipped}} = \\frac{N_{\\mathrm{clipped}}}{N_{\\mathrm{total}}} = \\frac{r T_{\\mathrm{clip}}}{r T_{\\mathrm{obs}}} = \\frac{T_{\\mathrm{clip}}}{T_{\\mathrm{obs}}}\n$$\n这个结果与神经脉冲速率$r$无关。我们的任务简化为计算$T_{\\mathrm{clip}}$。\n\n当条件$|v(t)| > V_{\\mathrm{fs}}$满足时，发生削波。伪影电压由$v(t) = A \\exp(-t/\\tau)$给出。由于$A = 2\\,\\mathrm{mV}$是正值，所以对于$t \\ge 0$，$v(t)$总是非负的。因此，条件简化为$v(t) > V_{\\mathrm{fs}}$。我们必须对时间$t$求解这个不等式：\n$$\nA \\exp(-t/\\tau) > V_{\\mathrm{fs}}\n$$\n给定参数$A > V_{\\mathrm{fs}} > 0$，我们可以重新整理：\n$$\n\\exp(-t/\\tau) > \\frac{V_{\\mathrm{fs}}}{A}\n$$\n对两边取自然对数：\n$$\n\\ln\\left(\\exp(-t/\\tau)\\right) > \\ln\\left(\\frac{V_{\\mathrm{fs}}}{A}\\right)\n$$\n$$\n-\\frac{t}{\\tau} > \\ln\\left(\\frac{V_{\\mathrm{fs}}}{A}\\right)\n$$\n使用对数性质$\\ln(1/x) = -\\ln(x)$，我们得到：\n$$\n-\\frac{t}{\\tau} > -\\ln\\left(\\frac{A}{V_{\\mathrm{fs}}}\\right)\n$$\n两边同时乘以$-\\tau$（一个负量）会使不等号反向：\n$$\nt  \\tau \\ln\\left(\\frac{A}{V_{\\mathrm{fs}}}\\right)\n$$\n由于伪影从$t=0$开始，削波区间从$t=0$开始，直到电压衰减到$V_{\\mathrm{fs}}$的那个时间$t$为止。这个区间是$[0, t_{\\mathrm{end}})$，其中$t_{\\mathrm{end}} = \\tau \\ln(A/V_{\\mathrm{fs}})$。因此，这个削波区间的时长是：\n$$\nT_{\\mathrm{clip}} = t_{\\mathrm{end}} - 0 = \\tau \\ln\\left(\\frac{A}{V_{\\mathrm{fs}}}\\right)\n$$\n现在我们可以代入给定的数值：$A = 2\\,\\mathrm{mV}$，$V_{\\mathrm{fs}} = 1\\,\\mathrm{mV}$，以及$\\tau = 3\\,\\mathrm{ms} = 3 \\times 10^{-3}\\,\\mathrm{s}$。\n$$\nT_{\\mathrm{clip}} = (3 \\times 10^{-3}\\,\\mathrm{s}) \\times \\ln\\left(\\frac{2\\,\\mathrm{mV}}{1\\,\\mathrm{mV}}\\right) = (3 \\times 10^{-3}) \\ln(2)\\,\\mathrm{s}\n$$\n这个时长大约是$2.079\\,\\mathrm{ms}$，远小于观测窗口$T_{\\mathrm{obs}} = 1\\,\\mathrm{s}$，所以整个削波事件都包含在观测窗口内。\n\n最后，我们计算被削波的神经脉冲的比例：\n$$\nF_{\\mathrm{clipped}} = \\frac{T_{\\mathrm{clip}}}{T_{\\mathrm{obs}}} = \\frac{(3 \\times 10^{-3}) \\ln(2)\\,\\mathrm{s}}{1\\,\\mathrm{s}} = (3 \\times 10^{-3}) \\ln(2)\n$$\n使用值$\\ln(2) \\approx 0.69314718...$：\n$$\nF_{\\mathrm{clipped}} \\approx 3 \\times 10^{-3} \\times 0.69314718 \\approx 0.0020794415\n$$\n按要求四舍五入到四位有效数字，我们得到$0.002079$。",
            "answer": "$$\\boxed{0.002079}$$"
        },
        {
            "introduction": "在高密度记录中，一个核心挑战是如何将微弱的神经信号与影响众多通道的、幅度更大的相关噪声分离开。本练习深入探讨了公共平均参考（Common Average Referencing, CAR）这一广泛用于消除共模噪声的预处理技术 。通过从头推导，你将揭示CAR方法背后微妙的权衡：它在一定程度上减小了目标神经信号的幅度，但通过更有效地抑制公共噪声，它可能显著提高信噪比（Signal-to-Noise Ratio, SNR）。",
            "id": "4138224",
            "problem": "一个具有 $M = 384$ 个记录位点的高密度硅探针测量细胞外电压。在特定时间 $t_{0}$，单个神经元产生一个尖峰，该尖峰在且仅在 $K = 3$ 个通道上以相同的峰值振幅 $A$ 出现，并在所有其他通道上可忽略不计。设每个通道观测到的信号是确定性分量和噪声之和，记为 $x_{i}(t) = s_{i}(t) + n_{i}(t)$，其中噪声 $n_{i}(t)$ 是零均值、时间白噪声、在各通道间同分布（方差为 $\\sigma^{2}$）且通道间不相关。该探针阵列采用公共平均参考（CAR）方法，在每个时间点 $t$ 定义为\n$$\ny_{i}(t) \\equiv x_{i}(t) - \\frac{1}{M} \\sum_{j=1}^{M} x_{j}(t).\n$$\n假设CAR使用所有 $M$ 个通道，包括被参考的通道本身。将一个通道上的信噪比（SNR）定义为该通道上尖峰的峰值振幅与噪声标准差之比。\n\n仅从这些定义和假设出发：\n1) 推导在时间 $t_{0}$，CAR对 $K$ 个含有尖峰的通道之一的尖峰峰值振幅进行缩放的乘法因子，用 $K$ 和 $M$ 表示，然后计算当 $K = 3$ 和 $M = 384$ 时的精确表达式。\n2) 推导CAR相对于处理前的信噪比，对一个含有尖峰的通道的信噪比进行重新缩放的乘法因子，用 $K$ 和 $M$ 表示，然后精确计算当 $K = 3$ 和 $M = 384$ 时的值。\n\n将您的最终答案表示为一个单行矩阵中的两个精确的无量纲表达式，顺序为[振幅缩放因子, 信噪比缩放因子]。不要近似或四舍五入；给出精确的闭式表达式。",
            "solution": "问题要求进行两项推导，这两项推导都与公共平均参考（CAR）对高密度电生理探针检测到的尖峰信号的影响有关。第一项是尖峰峰值振幅的缩放因子，第二项是信噪比（SNR）的缩放因子。\n\n设所有通道的集合为 $\\mathcal{M} = \\{1, 2, ..., M\\}$。在时间 $t$，通道 $i$ 上的信号 $x_i(t)$ 由 $x_i(t) = s_i(t) + n_i(t)$ 给出，其中 $s_i(t)$ 是确定性信号分量， $n_i(t)$ 是噪声。噪声 $n_i(t)$ 是零均值，即 $E[n_i(t)] = 0$，对于所有 $i \\in \\mathcal{M}$，其方差为 $Var(n_i(t)) = \\sigma^2$，并且通道间不相关，即对于 $i \\neq j$，有 $E[n_i(t)n_j(t)] = 0$。\n\n在尖峰峰值时间 $t_0$，来自神经元的信号在一组特定的 $K$ 个通道上振幅为 $A$，在其余的 $M-K$ 个通道上为零。不失一般性，假设通道 $\\{1, ..., K\\}$ 是含有尖峰的通道。\n在时间 $t_0$ 的信号分量为：\n$$\ns_i(t_0) =\n\\begin{cases}\nA  \\text{for } i \\in \\{1, ..., K\\} \\\\\n0  \\text{for } i \\in \\{K+1, ..., M\\}\n\\end{cases}\n$$\n经过CAR处理的信号 $y_i(t)$ 定义为：\n$$\ny_i(t) = x_i(t) - \\frac{1}{M} \\sum_{j=1}^{M} x_j(t)\n$$\n我们可以将 $y_i(t)$ 分解为信号和噪声分量：\n$$\ny_i(t) = \\left(s_i(t) - \\frac{1}{M} \\sum_{j=1}^{M} s_j(t)\\right) + \\left(n_i(t) - \\frac{1}{M} \\sum_{j=1}^{M} n_j(t)\\right)\n$$\n让我们将CAR处理后的信号分量定义为 $s'_i(t) = s_i(t) - \\frac{1}{M} \\sum_{j=1}^{M} s_j(t)$，将CAR处理后的噪声分量定义为 $n'_i(t) = n_i(t) - \\frac{1}{M} \\sum_{j=1}^{M} n_j(t)$。\n\n**1) 振幅缩放因子**\n\n我们需要找到CAR对一个含有尖峰的通道（例如通道 $i=1$）上的尖峰峰值振幅进行缩放的乘法因子。原始振幅为 $s_1(t_0) = A$。CAR处理后的振幅为 $s'_1(t_0)$。\n\n首先，计算在 $t_0$ 时所有信号分量的总和：\n$$\n\\sum_{j=1}^{M} s_j(t_0) = \\sum_{j=1}^{K} A + \\sum_{j=K+1}^{M} 0 = K A\n$$\n在一个含有尖峰的通道（$i \\in \\{1, ..., K\\}$）上，CAR处理后的信号振幅为：\n$$\ns'_i(t_0) = s_i(t_0) - \\frac{1}{M} \\sum_{j=1}^{M} s_j(t_0) = A - \\frac{1}{M} (K A) = A \\left(1 - \\frac{K}{M}\\right)\n$$\n振幅的乘法缩放因子是CAR处理后振幅与处理前振幅之比：\n$$\n\\text{振幅缩放因子} = \\frac{s'_i(t_0)}{s_i(t_0)} = \\frac{A \\left(1 - \\frac{K}{M}\\right)}{A} = 1 - \\frac{K}{M}\n$$\n对于给定的值 $K = 3$ 和 $M = 384$：\n$$\n\\text{振幅缩放因子} = 1 - \\frac{3}{384} = 1 - \\frac{1}{128} = \\frac{128 - 1}{128} = \\frac{127}{128}\n$$\n\n**2) 信噪比缩放因子**\n\n信噪比定义为峰值振幅与噪声标准差之比。\n\n对于一个含有尖峰的通道，CAR处理前的信噪比为：\n$$\n\\text{SNR}_{\\text{pre}} = \\frac{\\text{Amplitude}_{\\text{pre}}}{\\text{StdDev}_{\\text{pre}}} = \\frac{A}{\\sigma}\n$$\n因为原始噪声标准差为 $\\sqrt{\\sigma^2} = \\sigma$。\n\n为了求得CAR处理后的信噪比，我们需要CAR处理后噪声 $n'_i(t)$ 的标准差。让我们计算其方差 $Var(n'_i(t))$。由于噪声是零均值，CAR处理后的噪声也是零均值：\n$E[n'_i(t)] = E[n_i(t)] - \\frac{1}{M} \\sum_{j=1}^{M} E[n_j(t)] = 0 - 0 = 0$。\n方差为：\n$$\nVar(n'_i(t)) = Var\\left(n_i(t) - \\frac{1}{M} \\sum_{j=1}^{M} n_j(t)\\right) = Var\\left(\\left(1-\\frac{1}{M}\\right)n_i(t) - \\frac{1}{M} \\sum_{j \\neq i} n_j(t)\\right)\n$$\n由于噪声信号 $n_j(t)$ 不相关，和的方差等于方差的和：\n$$\nVar(n'_i(t)) = Var\\left(\\left(1-\\frac{1}{M}\\right)n_i(t)\\right) + \\sum_{j \\neq i} Var\\left(-\\frac{1}{M} n_j(t)\\right)\n$$\n使用性质 $Var(cZ) = c^2 Var(Z)$：\n$$\nVar(n'_i(t)) = \\left(1-\\frac{1}{M}\\right)^2 Var(n_i(t)) + \\sum_{j \\neq i} \\left(\\frac{1}{M}\\right)^2 Var(n_j(t))\n$$\n我们知道对于所有 $j$，都有 $Var(n_j(t)) = \\sigma^2$。对 $j \\neq i$ 的求和有 $M-1$ 项。\n$$\nVar(n'_i(t)) = \\left(1-\\frac{2}{M}+\\frac{1}{M^2}\\right)\\sigma^2 + (M-1) \\frac{1}{M^2}\\sigma^2\n$$\n$$\nVar(n'_i(t)) = \\sigma^2 \\left( 1 - \\frac{2}{M} + \\frac{1}{M^2} + \\frac{M-1}{M^2} \\right) = \\sigma^2 \\left( 1 - \\frac{2}{M} + \\frac{1}{M^2} + \\frac{1}{M} - \\frac{1}{M^2} \\right)\n$$\n$$\nVar(n'_i(t)) = \\sigma^2 \\left(1 - \\frac{1}{M}\\right)\n$$\nCAR处理后的噪声标准差为 $\\sigma' = \\sqrt{Var(n'_i(t))} = \\sigma \\sqrt{1 - \\frac{1}{M}}$。\n\n对于一个含有尖峰的通道，CAR处理后的信噪比为：\n$$\n\\text{SNR}_{\\text{post}} = \\frac{\\text{Amplitude}_{\\text{post}}}{\\text{StdDev}_{\\text{post}}} = \\frac{A \\left(1 - \\frac{K}{M}\\right)}{\\sigma \\sqrt{1 - \\frac{1}{M}}}\n$$\n信噪比的缩放因子是比率 $\\frac{\\text{SNR}_{\\text{post}}}{\\text{SNR}_{\\text{pre}}}$：\n$$\n\\text{SNR Scaling Factor} = \\frac{A \\left(1 - \\frac{K}{M}\\right) / \\left(\\sigma \\sqrt{1 - \\frac{1}{M}}\\right)}{A / \\sigma} = \\frac{1 - \\frac{K}{M}}{\\sqrt{1 - \\frac{1}{M}}}\n$$\n对于给定的值 $K = 3$ 和 $M = 384$：\n$$\n\\text{SNR Scaling Factor} = \\frac{1 - \\frac{3}{384}}{\\sqrt{1 - \\frac{1}{384}}} = \\frac{1 - \\frac{1}{128}}{\\sqrt{\\frac{383}{384}}} = \\frac{\\frac{127}{128}}{\\frac{\\sqrt{383}}{\\sqrt{384}}}\n$$\n我们可以化简 $\\sqrt{384} = \\sqrt{64 \\times 6} = 8\\sqrt{6}$。\n$$\n\\text{SNR Scaling Factor} = \\frac{127}{128} \\cdot \\frac{8\\sqrt{6}}{\\sqrt{383}} = \\frac{127\\sqrt{6}}{16\\sqrt{383}}\n$$\n这就是信噪比缩放因子的精确表达式。\n\n最终结果是振幅缩放因子 $\\frac{127}{128}$ 和信噪比缩放因子 $\\frac{127\\sqrt{6}}{16\\sqrt{383}}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{127}{128}  \\frac{127\\sqrt{6}}{16\\sqrt{383}}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}