{
    "hands_on_practices": [
        {
            "introduction": "从观测数据中估计因果效应的关键在于正确处理混杂变量。本练习  将挑战您在一个复杂的（但在神经科学研究中很典型的）因果图中，运用后门准则来识别所有有效的调整集。通过这个实践，您将能更敏锐地区分混杂因素、中介因素和对撞因子，这是设计无偏分析的关键技能。",
            "id": "4145163",
            "problem": "一个行为神经科学实验室正在分析一种无创海马体刺激强度对记忆表现的观测效应。令 $A$ 表示刺激强度，$Y$ 表示延迟回忆记忆分数，$M$ 表示编码期间的海马体θ波段功率（从 $A$ 到 $Y$ 的因果路径上的一个生理中介变量），$Z_1$ 表示基线海马体放电率，$Z_2$ 表示神经炎症指数。此外，数据集中包含以下测量的协变量：$I$（一个影响 $A$ 但不影响 $Y$ 的诊所排班工具变量），$C$（一个受 $Z_1$ 和 $Z_2$ 影响但对 $A$ 或 $Y$ 没有直接影响的病例选择指标），以及 $B$（一个与其他所有变量统计上独立且对 $A$ 或 $Y$ 没有因果效应的基线问卷分数）。假设存在如下有向无环图 (DAG)：存在有向边 $Z_1 \\to A$、$Z_1 \\to Y$、$Z_2 \\to A$、$Z_2 \\to Y$、$A \\to M$、$M \\to Y$ 和 $I \\to A$，以及 $Z_1 \\to C$ 和 $Z_2 \\to C$。除此之外没有其他箭头，并且除了图中所示的之外，没有未测量的混杂因素。所有变量的测量都没有误差。目标是在一致性、正定性和稳定单位处理值假设 (SUTVA) 等标准可识别性条件下，$A$ 对 $Y$ 的总因果效应。\n\n使用因果图模型中的后门准则，从观测数据中识别出下列哪些候选协变量集是用于识别 $A$ 对 $Y$ 的总效应的有效调整集。然后，根据该图解释为什么 $\\{Z_1, Z_2\\}$ 是一个最小有效调整集。\n\n选择所有适用项。\n\nA. $\\{Z_1, Z_2\\}$\n\nB. $\\{Z_1\\}$\n\nC. $\\{Z_2\\}$\n\nD. $\\{Z_1, Z_2, M\\}$\n\nE. $\\{Z_1, Z_2, C\\}$\n\nF. $\\{Z_1, Z_2, I\\}$\n\nG. $\\{Z_1, Z_2, B\\}$\n\nH. $\\{Z_1, Z_2, I, B\\}$\n\n从d-分离和后门准则的定义开始，提供你的推理，并论证为什么在该图中，对于总效应而言，$\\{Z_1, Z_2\\}$ 是最小的，且不会引入偏倚或阻断 $A$ 对 $Y$ 的任何部分因果效应。",
            "solution": "我们从基本原则开始。在一个有向无环图 (DAG) 中，如果一条路径满足以下任一条件，则它被一个节点集所阻断：(i) 该路径包含一个作为条件（被调整）的非对撞节点，或者 (ii) 该路径包含一个未被作为条件且其所有后代节点也均未被作为条件的对撞节点。如果两个变量集之间的每一条路径都被某个条件集所阻断，那么就称这两个变量集在该条件下是d-分离的。后门准则规定：一个集合 $\\mathcal{S}$ 是用于识别 $A$ 对 $Y$ 的总效应的有效调整集，需满足：(i) $\\mathcal{S}$ 中没有任何元素是 $A$ 的后代，并且 (ii) $\\mathcal{S}$ 阻断了从 $A$ 到 $Y$ 的每一条后门路径（即，连接 $A$ 和 $Y$ 且以指向 $A$ 的箭头开始的每一条路径）。在一致性、正定性和稳定单位处理值假设 (SUTVA) 下，如果后门准则成立，那么总效应可以通过对 $\\mathcal{S}$ 进行调整来识别。\n\n现在我们分析给定的DAG。从 $A$ 到 $Y$ 的因果（前门）路径是 $A \\to Y$（如果隐含存在），或者如本题所指明的，至少是 $A \\to M \\to Y$（即使不存在直接的 $A \\to Y$ 箭头，总效应也可能是有明确定义的）。当目标是总效应时，我们绝不能阻断任何因果路径；特别是，我们绝不能对中介变量 $M$ 或 $A$ 的任何后代进行调整。\n\n从 $A$到 $Y$ 的后门路径是指那些以指向 $A$ 的箭头开始的路径。根据该图：\n- 存在一条后门路径 $A \\leftarrow Z_1 \\to Y$。\n- 存在一条后门路径 $A \\leftarrow Z_2 \\to Y$。\n- 存在一个涉及对撞节点 $C$ 的后门结构：$A \\leftarrow Z_1 \\to C \\leftarrow Z_2 \\to Y$。这条路径在对撞节点 $C$ 处默认是阻断的，但如果我们以 $C$（或其后代，本图中没有）为条件，我们就会打开这条路径，从而引入偏倚。\n- 变量 $I$ 是一个工具变量，只有 $I \\to A$ 这条路径，且从 $I$ 到 $Y$ 的路径只能通过 $A$。不存在通过 $I$ 的后门路径，因为 $I$ 没有父节点，也没有指向 $Y$ 的箭头。\n\n因此，要阻断所有后门路径，对 $Z_1$ 和 $Z_2$ 进行调整就足够了，前提是我们不对像 $C$ 这样的对撞节点或像 $M$ 这样的 $A$ 的后代施加条件。\n\n我们根据后门准则评估每个候选集。\n\n选项 A: $\\{Z_1, Z_2\\}$。该集合不包含 $A$ 的后代。以 $Z_1$ 为条件阻断了 $A \\leftarrow Z_1 \\to Y$，以 $Z_2$ 为条件阻断了 $A \\leftarrow Z_2 \\to Y$。通过 $C$ 的对撞路径仍然是阻断的，因为我们没有以 $C$ 或 $C$ 的任何后代为条件。因此，所有后门路径都被阻断，且没有因果路径被阻断。结论：正确。\n\n选项 B: $\\{Z_1\\}$。这以 $Z_1$ 为条件但没有以 $Z_2$ 为条件，使得后门路径 $A \\leftarrow Z_2 \\to Y$ 未被阻断。因此，偏倚依然存在。结论：错误。\n\n选项 C: $\\{Z_2\\}$。与选项B对称，这使得后门路径 $A \\leftarrow Z_1 \\to Y$ 未被阻断。结论：错误。\n\n选项 D: $\\{Z_1, Z_2, M\\}$。尽管 $\\{Z_1, Z_2\\}$ 阻断了所有后门路径，但加入 $M$ 是对因果路径 $A \\to M \\to Y$ 上的一个中介变量施加了条件。对于总效应而言，这将阻断部分因果效应，并且在该调整下只能识别出受控直接效应，而非总效应。此外，后门准则要求集合中不包含 $A$ 的后代。由于 $M$ 是 $A$ 的后代，这违反了该准则。结论：错误。\n\n选项 E: $\\{Z_1, Z_2, C\\}$。以 $C$ 为条件打开了对撞路径 $A \\leftarrow Z_1 \\to C \\leftarrow Z_2 \\to Y$，从而创建了一条从 $A$ 到 $Y$ 的新后门路径，这会引入伪关联。因此，即使包含了 $Z_1$ 和 $Z_2$，加入 $C$ 也会引入偏倚。结论：错误。\n\n选项 F: $\\{Z_1, Z_2, I\\}$。将 $I$ 加入 $\\{Z_1, Z_2\\}$ 不会引入任何新的开放后门路径，因为 $I$ 不是 $A$ 的后代，不是对撞节点，并且除了通过 $A$ 之外没有到 $Y$ 的路径。该集合阻断了所有后门路径，且不阻断任何因果路径。尽管对于识别而言是多余的，但它仍然是一个有效的调整集。结论：正确。\n\n选项 G: $\\{Z_1, Z_2, B\\}$。变量 $B$ 与所有变量独立，没有因果关系；以 $B$ 为条件不会打开或关闭任何路径。因此，该集合仍然通过 $Z_1$ 和 $Z_2$ 阻断了必要的后门路径，并且不阻断任何因果路径。结论：正确。\n\n选项 H: $\\{Z_1, Z_2, I, B\\}$。根据与选项F和G相同的推理，将 $I$ 和 $B$ 加入 $\\{Z_1, Z_2\\}$ 不会产生偏倚或阻断因果路径。后门路径仍然被阻断，并且没有对 $A$ 的后代或对撞节点施加条件。结论：正确。\n\n为什么 $\\{Z_1, Z_2\\}$ 是最小的：如果一个有效调整集的任何真子集都不是有效的调整集，那么该调整集就是最小的。考虑两个真子集 $\\{Z_1\\}$ 和 $\\{Z_2\\}$。集合 $\\{Z_1\\}$ 未能阻断后门路径 $A \\leftarrow Z_2 \\to Y$，使得由 $Z_2$ 引起的混杂未被处理。集合 $\\{Z_2\\}$ 未能阻断后门路径 $A \\leftarrow Z_1 \\to Y$，使得由 $Z_1$ 引起的混杂未被处理。空集和任何其他真子集（例如 $\\varnothing$）显然也无效。因此，$\\{Z_1, Z_2\\}$ 是阻断所有后门路径且不包含 $A$ 的后代或对撞节点的最小集合，这使其成为识别总效应的最小有效调整集。任何不包含像 $M$ 或 $C$ 这样的禁用变量的 $\\{Z_1, Z_2\\}$ 的严格超集也是有效的，但不是最小的；这样的超集（例如 $\\{Z_1, Z_2, I\\}$、$\\{Z_1, Z_2, B\\}$）不会改变 $A$ 和 $Y$ 之间的d-分离关系，但可能影响统计效率，而不影响可识别性。",
            "answer": "$$\\boxed{AFGH}$$"
        },
        {
            "introduction": "虽然调整协变量通常是消除偏倚所必需的，但错误地进行调整反而可能引入偏倚。本练习  旨在阐释“对撞偏倚”这一关键概念，即对两个独立变量的共同结果进行条件化，会在这两个变量之间产生虚假的关联。通过具体的计算，您将精确地看到这种偏倚是如何产生的，这为数据预处理和变量选择提供了重要一课。",
            "id": "4145204",
            "problem": "一项观察性脑电图（EEG）研究旨在探究连续刺激强度 $X$ 是否影响 gamma 波段功率 $Y$。一种预处理算法通过结合刺激锁定特征和信号方差特征，生成一个伪影检测标志 $M$。假设存在一个未观测到的运动相关伪影源 $U$，它会污染 gamma 波段。考虑一个有向无环图 (DAG)，其箭头为 $X \\to M \\leftarrow U \\to Y$，并且从 $X$到 $Y$ 没有直接的箭头。假设一个结构因果模型 (SCM)，其方程为线性的高斯方程：$X \\sim \\mathcal{N}(0,1)$, $U \\sim \\mathcal{N}(0,1)$, $\\varepsilon_M \\sim \\mathcal{N}(0,\\sigma_M^2)$, $\\varepsilon_Y \\sim \\mathcal{N}(0,\\sigma_Y^2)$，所有变量相互独立；$M = aX + bU + \\varepsilon_M$ 且 $Y = cU + \\varepsilon_Y$，其中 $a$、$b$、$c$ 是严格为正的常数。使用 $d$-分离和高斯图模型中条件独立性的基本原理，确定对 $M$ 进行条件化（通过回归调整，或通过限制到具有特定 $M$ 值的时期）对 $X$ 和 $Y$ 之间关联的影响。哪个选项是正确的？\n\nA. 在此模型中 $X \\perp Y \\mid M$ 成立，因此通过 $M$ 进行筛选或调整不会引入偏差。\n\nB. 如果 $a, b, c > 0$，那么 $\\operatorname{Cov}(X,Y \\mid M) = -\\dfrac{abc}{a^2 + b^2 + \\sigma_M^2} \\neq 0$，因此对 $M$ 进行条件化会打开 $X$ 和 $Y$ 之间的伪关联。\n\nC. $\\operatorname{Cov}(X,Y \\mid M) = \\dfrac{ab}{c}$，因此对 $M$ 进行条件化会引入一个正关联，其幅度与 $\\sigma_M^2$ 无关。\n\nD. 对 $M$ 进行条件化会阻断 $U$ 对 $Y$ 的影响，从而从观测数据中得到 $X$ 对 $Y$ 的平均因果效应的无偏估计。",
            "solution": "给定的有向无环图 (DAG) 是 $X \\to M \\leftarrow U \\to Y$。节点 $M$ 是 $X$ 和 $Y$ 之间路径上的一个对撞节点，因为有两条箭头指向它。问题要求确定对这个对撞节点 $M$ 进行条件化的影响。\n\n首先，我们使用 d-分离法则来分析因果结构。\n1.  在刺激 $X$ 和神经响应 $Y$ 之间存在一条路径：$X \\to M \\leftarrow U \\to Y$。\n2.  无条件地，这条路径被对撞节点 $M$ 阻断。由于 $X$ 和 $Y$ 之间没有其他路径，$X$ 和 $Y$ 是 d-分离的。在因果图模型中，d-分离意味着条件独立。因此，$X$ 和 $Y$ 是边际独立的，记为 $X \\perp Y$。这意味着在没有进行条件化的情况下，$X$ 和 $Y$ 之间没有统计关联。$X$ 对 $Y$ 的真实平均因果效应为 $0$，因为从 $X$ 到 $Y$ 没有有向路径。观察性关联正确地反映了这一点。\n3.  当我们对对撞节点 $M$ 进行条件化时，路径 $X \\to M \\leftarrow U \\to Y$ 变为未被阻断或“打开”。这会在 $X$ 和 $Y$ 之间引入一个统计关联。因此，在给定 $M$ 的条件下，$X$ 和 $Y$ 不是独立的，记为 $X \\not\\perp Y \\mid M$。这种引入的关联是伪关联；它不反映 $X$ 和 $Y$ 之间的因果关系。以这种方式对对撞节点进行条件化是一种偏倚的来源，称为对撞偏倚或伯克森悖论。\n\n接下来，我们使用给定的线性高斯结构因果模型 (SCM) 对条件协方差 $\\operatorname{Cov}(X, Y \\mid M)$ 进行定量计算，以证实这一定性分析。对于多元高斯分布，零协方差等价于统计独立性。\n\nSCM 方程为：\n$M = aX + bU + \\varepsilon_M$\n$Y = cU + \\varepsilon_Y$\n\n变量 $X, U, \\varepsilon_M, \\varepsilon_Y$ 相互独立，其分布如下：\n$X \\sim \\mathcal{N}(0,1)$，所以 $\\operatorname{Var}(X) = 1$。\n$U \\sim \\mathcal{N}(0,1)$，所以 $\\operatorname{Var}(U) = 1$。\n$\\varepsilon_M \\sim \\mathcal{N}(0,\\sigma_M^2)$，所以 $\\operatorname{Var}(\\varepsilon_M) = \\sigma_M^2$。\n$\\varepsilon_Y \\sim \\mathcal{N}(0,\\sigma_Y^2)$，所以 $\\operatorname{Var}(\\varepsilon_Y) = \\sigma_Y^2$。\n\n多元高斯系统中的条件协方差公式为：\n$$ \\operatorname{Cov}(X, Y \\mid M) = \\operatorname{Cov}(X, Y) - \\operatorname{Cov}(X, M) \\operatorname{Var}(M)^{-1} \\operatorname{Cov}(M, Y) $$\n\n我们计算每一项：\n1.  $\\operatorname{Cov}(X, Y) = \\operatorname{Cov}(X, cU + \\varepsilon_Y) = c \\operatorname{Cov}(X, U) + \\operatorname{Cov}(X, \\varepsilon_Y)$。由于 $X$、$U$ 和 $\\varepsilon_Y$ 是独立的，$\\operatorname{Cov}(X, U) = 0$ 且 $\\operatorname{Cov}(X, \\varepsilon_Y) = 0$。因此，$\\operatorname{Cov}(X, Y) = 0$。这证实了边际独立性（$X \\perp Y$）。\n\n2.  $\\operatorname{Cov}(X, M) = \\operatorname{Cov}(X, aX + bU + \\varepsilon_M) = a \\operatorname{Cov}(X, X) + b \\operatorname{Cov}(X, U) + \\operatorname{Cov}(X, \\varepsilon_M)$。由于独立性，这简化为 $a \\operatorname{Var}(X) = a(1) = a$。\n\n3.  $\\operatorname{Cov}(M, Y) = \\operatorname{Cov}(aX + bU + \\varepsilon_M, cU + \\varepsilon_Y)$。利用协方差的双线性和注意到外生变量的独立性进行展开，唯一的非零项是 $\\operatorname{Cov}(bU, cU) = bc \\operatorname{Var}(U) = bc(1) = bc$。\n\n4.  $\\operatorname{Var}(M) = \\operatorname{Var}(aX + bU + \\varepsilon_M)$。由于 $X, U, \\varepsilon_M$ 的独立性，和的方差是方差的和：$\\operatorname{Var}(M) = a^2 \\operatorname{Var}(X) + b^2 \\operatorname{Var}(U) + \\operatorname{Var}(\\varepsilon_M) = a^2(1) + b^2(1) + \\sigma_M^2 = a^2 + b^2 + \\sigma_M^2$。\n\n将这些分量代回条件协方差公式：\n$$ \\operatorname{Cov}(X, Y \\mid M) = 0 - (a) (a^2 + b^2 + \\sigma_M^2)^{-1} (bc) = -\\dfrac{abc}{a^2 + b^2 + \\sigma_M^2} $$\n由于 $a, b, c$ 是严格为正的常数，分子 $abc$ 是正的。分母 $a^2 + b^2 + \\sigma_M^2$ 也是严格为正的。因此，$\\operatorname{Cov}(X, Y \\mid M)$ 是一个非零的负值。这证实了对 $M$ 进行条件化会在 $X$ 和 $Y$ 之间引入一个伪负相关。\n\n现在，我们评估每个选项：\n\nA. 在此模型中 $X \\perp Y \\mid M$ 成立，因此通过 $M$ 进行筛选或调整不会引入偏差。\n这个陈述是错误的。我们的推导表明 $\\operatorname{Cov}(X, Y \\mid M) \\neq 0$，对于高斯系统，这意味着 $X \\not\\perp Y \\mid M$。对 $M$ 进行条件化恰恰是引入偏倚的原因。\n**结论：不正确。**\n\nB. 如果 $a, b, c > 0$，那么 $\\operatorname{Cov}(X,Y \\mid M) = -\\dfrac{abc}{a^2 + b^2 + \\sigma_M^2} \\neq 0$，因此对 $M$ 进行条件化会打开 $X$ 和 $Y$ 之间的伪关联。\n这个陈述给出了从第一性原理推导出的精确公式，并提供了正确的因果解释。计算出的协方差不为零，而这就是通过对对撞节点进行条件化来打开伪路径的定义。\n**结论：正确。**\n\nC. $\\operatorname{Cov}(X,Y \\mid M) = \\dfrac{ab}{c}$，因此对 $M$ 进行条件化会引入一个正关联，其幅度与 $\\sigma_M^2$ 无关。\n这个公式是不正确的。我们推导出的协方差是 $-\\dfrac{abc}{a^2 + b^2 + \\sigma_M^2}$。关联是负的，而不是正的，并且其幅度在分母中明确地依赖于 $\\sigma_M^2$。\n**结论：不正确。**\n\nD. 对 $M$ 进行条件化会阻断 $U$ 对 $Y$ 的影响，从而从观测数据中得到 $X$ 对 $Y$ 的平均因果效应的无偏估计。\n这个陈述从根本上误解了图的结构。$M$ 是一个对撞节点，而不是需要被阻断的路径上的混杂因子或中介变量。对对撞节点进行条件化会*创造*一条非因果的关联路径，而不是阻断一条。$X$ 对 $Y$ 的真实因果效应为 $0$。对 $M$ 进行条件化导致了非零的关联，根据定义，这是对因果效应的有偏估计。\n**结论：不正确。**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "除了理论上的可识别性，基于观测数据的因果推断还依赖于“正定性”或“重叠性”这一实际假设，即在所有协变量水平上都存在可比较的受试者和对照者。本练习  模拟了一个该假设被违背的常见真实场景。您将学习如何使用倾向得分诊断正定性问题，并探索诸如权重截断和样本裁剪等标准修正方法，这些都是进行稳健因果分析的重要工具。",
            "id": "4145210",
            "problem": "一项观察性脑电图 (EEG) 研究旨在估计镇静剂暴露对随后的α波段功率的平均因果效应。设二元暴露由 $A \\in \\{0,1\\}$ 表示，结果由 $Y$ 表示，基线协变量由向量 $X$ 表示。基线时的警觉状态根据暴露前的EEG特征和临床观察分为三个层 $V \\in \\{v_1, v_2, v_3\\}$。研究人员为暴露概率 $e(X) = \\mathbb{P}(A=1 \\mid X)$ 拟合了一个倾向性得分模型，并为所有单元获得了估计得分 $\\hat{e}(X)$。在初步诊断中，他们发现在 $V=v_3$ 层，治疗组的 $\\hat{e}(X)$ 值集中在 $1$ 附近，而对照组的 $\\hat{e}(X)$ 值集中在 $0$ 附近，而在 $V=v_1$ 层则似乎有良好的重叠。\n\n根据观察性研究中因果推断的基本原则，正值性假设要求对于目标人群中具有正概率的所有协变量值 $x$，两种暴露水平都具有非零概率：对于 $a \\in \\{0,1\\}$，$0  \\mathbb{P}(A=a \\mid X=x)  1$。违反该假设通常表现为估计的倾向性得分极端地接近 $0$ 或 $1$，以及在以 $X$ 为条件时（或在如 $V$ 这样的有意义的层内）暴露组和非暴露组之间缺乏共同支撑域。研究人员希望通过检查各个警觉状态层的估计倾向性得分和重叠图来诊断潜在的正值性假设违反情况，并提出科学上合理的补救措施。\n\n在这项EEG研究中，以下哪些程序适用于诊断和处理正值性假设的违反情况？选择所有适用项。\n\nA. 在每个警觉状态层 $V=v$ 内，分别为 $A=1$ 和 $A=0$ 的情况叠加 $\\hat{e}(X)$ 的直方图或核密度图，并标记出支撑域不相交或得分集中在 $0$ 或 $1$ 附近的层。作为一种补救措施，在尾部（例如在 $1\\%$ 和 $99\\%$ 分位数处）截断极端的逆概率权重，并报告估计值对这种截断的敏感性。\n\nB. 在重叠性差的层中，通过基于设计的子抽样或匹配将分析限制在共同支撑域的区域，使得在 $V=v$ 内 $A=1$ 和 $A=0$ 的 $X$ 的经验分布更加相似。明确地重新定义和记录经过修剪的人群的目标估计量。\n\nC. 通过计算每个层 $V=v$ 中 $\\hat{e}(X)  \\epsilon$ 或 $\\hat{e}(X) > 1-\\epsilon$ (对于一个小的 $\\epsilon > 0$) 的单元比例来量化极端性，并检查逆概率权重的分布。如果存在重尾且有效样本量很小，则考虑权重截断和基于重叠的修剪。\n\nD. 为了改善重叠，将暴露后测量的EEG特征（例如，镇静后即刻的光谱变化）添加到倾向性得分模型中，以便治疗组和对照组的 $\\hat{e}(X)$ 在各个 $V$ 中更加混合。\n\nE. 拟合越来越灵活的倾向性得分模型（例如，高阶多项式和交互作用），直到所有单元的 $\\hat{e}(X)$ 值都严格位于 $0.1$ 和 $0.9$ 之间，并基于模型灵活性可以解决正值性问题的理由，在不进行任何设计更改的情况下继续分析。",
            "solution": "该问题涉及正值性假设，这是使用诸如治疗概率逆加权（IPTW）等方法从观察性数据中无偏估计因果效应的一个基本先决条件。该假设指出，对于任何给定的协变量集 $X=x$，接受治疗和不接受治疗的概率都非零。形式上，$0  e(x)  1$，其中 $e(x) = \\mathbb{P}(A=1 \\mid X=x)$。\n\n如 $V=v_3$ 层的诊断所示，违反或接近违反此假设意味着对于某些受试者，治疗分配基于其基线特征是（近似）确定性的。这对因果推断构成了一个主要问题，因为它变得不可能或难以-为治疗组的受试者找到可比较的对照组受试者（反之亦然）。在IPTW中，这表现为极端的权重：一个 $\\hat{e}(X) \\approx 1$ 的治疗组受试者得到的权重为 $1/\\hat{e}(X) \\approx 1$，但一个 $\\hat{e}(X) \\approx 1$ 的非治疗组受试者会得到一个天文数字般大的权重 $1/(1-\\hat{e}(X))$。同样，一个 $\\hat{e}(X) \\approx 0$ 的治疗组受试者会得到一个巨大的权重。这些极端的权重会急剧增大因果效应估计量的方差，并使其对倾向性得分模型的错误设定高度敏感。\n\n任务是评估用于诊断和处理此问题的提议程序。\n\n### 逐项分析\n\n**A. 在每个警觉状态层 $V=v$ 内，分别为 $A=1$ 和 $A=0$ 的情况叠加 $\\hat{e}(X)$ 的直方图或核密度图，并标记出支撑域不相交或得分集中在 $0$ 或 $1$ 附近的层。作为一种补救措施，在尾部（例如在 $1\\%$ 和 $99\\%$ 分位数处）截断极端的逆概率权重，并报告估计值对这种截断的敏感性。**\n\n- **诊断**：为治疗组和对照组叠加估计的倾向性得分 $\\hat{e}(X)$ 的分布是评估正值性和重叠的典型图形方法。缺乏重叠，即分布分离，是正值性违反的清晰视觉指标。这种诊断是标准做法，并且被高度推荐。\n- **补救措施**：权重截断是处理由接近违反正值性引起的极端权重的常用且公认的方法。通过对逆概率权重设置上限（例如，在权重分布的第1和第99百分位数），可以显著减少估计量的方差。但这会引入一定量的偏倚，因为截断后的权重不再能完美地平衡协变量分布。因此，执行并报告敏感性分析至关重要，以显示最终因果估计如何随不同截断阈值而变化。这整个程序是有原则且适当的。\n- **结论**：**正确**。\n\n**B. 在重叠性差的层中，通过基于设计的子抽样或匹配将分析限制在共同支撑域的区域，使得在 $V=v$ 内 $A=1$ 和 $A=0$ 的 $X$ 的经验分布更加相似。明确地重新定义和记录经过修剪的人群的目标估计量。**\n\n- **补救措施**：这个通常被称为“修剪样本”的程序，涉及丢弃在另一治疗组中没有可比较对应者的受试者。例如，可以丢弃那些 $\\hat{e}(X)$ 低于治疗组中最小 $\\hat{e}(X)$ 的对照组受试者，以及那些 $\\hat{e}(X)$ 高于对照组中最大 $\\hat{e}(X)$ 的治疗组受试者。这将分析限制在正值性假设更强成立的子群体中。\n- **重新定义估计量**：这是此程序最关键的部分。通过修剪样本，分析不再估计原始完整人群的平均处理效应（ATE）。相反，它估计的是剩余的“重叠”子群体的ATE。这个新的估计目标（估计量）必须被明确定义和报告。例如，结果现在是“对于那些特征既不使他们几乎肯定接受镇静剂也不使他们几乎肯定不接受镇静剂的患者的平均因果效应”。未能承认估计量的这种变化是一个严重的方法论错误。所描述的程序正确地包含了这一至关重要的步骤。\n- **结论**：**正确**。\n\n**C. 通过计算每个层 $V=v$ 中 $\\hat{e}(X)  \\epsilon$ 或 $\\hat{e}(X) > 1-\\epsilon$ (对于一个小的 $\\epsilon > 0$) 的单元比例来量化极端性，并检查逆概率权重的分布。如果存在重尾且有效样本量很小，则考虑权重截断和基于重叠的修剪。**\n\n- **诊断**：这提出了定量诊断来补充选项A中的图形方法。计算具有极端倾向性得分（对于选定的小 $\\epsilon$，例如 $0.01$）的受试者比例是衡量正值性问题普遍性的直接方法。检查逆概率权重的分布，特别是其偏度和重尾的存在，也是评估接近违反正值性对最终估计量方差影响的直接方法。因高度可变的权重而降低的有效样本量（ESS）是另一个关键指标。这些都是优秀和标准的定量诊断方法。\n- **行动**：基于这些诊断发现，考虑如权重截断（来自选项A）和修剪（来自选项B）等补救措施的提议，是一个逻辑上和方法论上合理的流程。它代表了解决该问题的系统性方法。\n- **结论**：**正确**。\n\n**D. 为了改善重叠，将暴露后测量的EEG特征（例如，镇静后即刻的光谱变化）添加到倾向性得分模型中，以便治疗组和对照组的 $\\hat{e}(X)$ 在各个 $V$ 中更加混合。**\n\n- **分析**：这个程序根本上是错误的。用于建模倾向性得分 $e(X) = \\mathbb{P}(A=1 \\mid X)$ 的协变量集必须只包含暴露前变量。在暴露*之后*测量的变量本身可能是暴露的*一个效应*。将这样一个治疗后变量包含在倾向性得分模型的条件集中会引发严重偏倚。例如，如果镇静剂本身引起即刻的光谱变化，那么将这些变化包含在模型中就意味着我们正在为一个治疗效应的部分进行调整。这是一个典型的以对撞因子或中介变量为条件的例子，它会打开虚假的因果路径并使因果效应估计产生偏倚。倾向性得分的目的是解释治疗前的混杂因素，而不是利用治疗后信息人为地强制重叠。\n- **结论**：**不正确**。\n\n**E. 拟合越来越灵活的倾向性得分模型（例如，高阶多项式和交互作用），直到所有单元的 $\\hat{e}(X)$ 值都严格位于 $0.1$ 和 $0.9$ 之间，并基于模型灵活性可以解决正值性问题的理由，在不进行任何设计更改的情况下继续分析。**\n\n- **分析**：这个程序基于对问题的深刻误解。正值性假设是真实世界数据生成过程的一个特征，而不是统计模型的缺陷。如果实际上某些患者几乎总是被治疗（真实的 $e(X)$ 接近 $1$），一个*更灵活、设定得更好*的倾向性得分模型将产生*更接近* $1$ 的估计值 $\\hat{e}(X)$。这将正确地揭示正值性问题，而不是解决它。通过调整模型将 $\\hat{e}(X)$ 估计值推离边界（$0$ 和 $1$）是一种无原则的、临时的做法，它掩盖了根本问题。这相当于为了得到一个“更好看”的得分分布而故意错误设定模型，这很可能由于对混杂因素的控制不足而导致有偏的估计。问题在于数据（缺乏重叠），必须通过设计阶段的补救措施如修剪（选项B）或分析阶段的补救措施如权重截断（选项A）来解决，而不是通过操纵模型来隐藏问题。\n- **结论**：**不正确**。",
            "answer": "$$\\boxed{ABC}$$"
        }
    ]
}