{
    "hands_on_practices": [
        {
            "introduction": "为了有效地使用线性混合效应模型的软件，掌握其公式语法至关重要。本练习  将帮助您把诸如 `(1|subject)` 和 `(0+t|subject)` 这样的常见语法，转换成随机效应设计矩阵 $\\mathbf{Z}$ 的精确数学结构。牢固掌握这种转换是确保您所拟合的模型能准确反映科学假设的基础。",
            "id": "4175329",
            "problem": "一项皮层兴奋性实验测量了每位参与者在两个会话中的运动诱发电位振幅：时间 $t=0$ 的基线会话和时间 $t=1$ 的干预后会话。有 $3$ 名参与者（分组因子水平），标记为 $S1$、$S2$ 和 $S3$。每位参与者在两个会话中都进行了测量，共产生 $6$ 个观测值。各行按 $(S1,t=0)$、$(S1,t=1)$、$(S2,t=0)$、$(S2,t=1)$、$(S3,t=0)$、$(S3,t=1)$ 的顺序排列。假设 $t$ 是一个数值协变量，其取值为给定的 $0$ 和 $1$。\n\n您计划使用标准线性混合模型公式来拟合线性混合效应模型\n$$\n\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\mathbf{Z}\\mathbf{b} + \\boldsymbol{\\varepsilon},\n$$\n其中 $\\mathbf{y}$ 是 $6\\times 1$ 的响应向量，$\\mathbf{X}$ 是固定效应设计矩阵，$\\boldsymbol{\\beta}$ 是固定效应系数向量，$\\mathbf{Z}$ 是随机效应设计矩阵，$\\mathbf{b}$ 是随机效应系数向量，满足 $\\mathbf{b}\\sim \\mathcal{N}(\\mathbf{0},\\mathbf{G})$，且 $\\boldsymbol{\\varepsilon}\\sim \\mathcal{N}(\\mathbf{0},\\sigma^2\\mathbf{I})$ 与 $\\mathbf{b}$ 独立。随机效应设计矩阵 $\\mathbf{Z}$ 通过将组成员关系指标与随机效应协变量相结合，将每个观测值映射到相应的主体特定随机系数。\n\n考虑公式语法中的两种随机效应设定：$(1\\mid \\text{subject})$ 和 $(0 + t \\mid \\text{subject})$，其中分组因子是主体标识符，而 $t$ 是上面定义的数值时间协变量。对于这个包含 $6$ 行的数据集，哪个选项正确解释了这两种设定之间的差异，并推导出了相应的随机效应设计矩阵 $\\mathbf{Z}$？\n\nA. $(1\\mid \\text{subject})$ 仅指定一个主体特定的随机截距；$(0 + t \\mid \\text{subject})$ 仅指定一个主体特定的关于 $t$ 的随机斜率（无随机截距）。因此，两种情况下 $\\mathbf{Z}$ 都有 $3$ 列，每个主体一列。对于 $(1\\mid \\text{subject})$，\n$$\n\\mathbf{Z}_{(1\\mid \\text{subject})}=\n\\begin{bmatrix}\n1  0  0\\\\\n1  0  0\\\\\n0  1  0\\\\\n0  1  0\\\\\n0  0  1\\\\\n0  0  1\n\\end{bmatrix},\n$$\n对于 $(0 + t \\mid \\text{subject})$，\n$$\n\\mathbf{Z}_{(0+t\\mid \\text{subject})}=\n\\begin{bmatrix}\n0  0  0\\\\\n1  0  0\\\\\n0  0  0\\\\\n0  1  0\\\\\n0  0  0\\\\\n0  0  1\n\\end{bmatrix},\n$$\n因为每一列对应一个主体，并携带该主体在每一行的 $t$ 值，其他位置为零。\n\nB. $(1\\mid \\text{subject})$ 和 $(0 + t \\mid \\text{subject})$ 都包含一个主体特定的随机截距，但 $(0 + t \\mid \\text{subject})$ 还额外包含一个主体特定的随机斜率。因此，对于 $(1\\mid \\text{subject})$，$\\mathbf{Z}$ 是一个 $6\\times 3$ 的矩阵，包含主体指示符；而对于 $(0 + t \\mid \\text{subject})$，它是一个 $6\\times 6$ 的矩阵，每个主体有两列：\n$$\n\\mathbf{Z}_{(1\\mid \\text{subject})}=\n\\begin{bmatrix}\n1  0  0\\\\\n1  0  0\\\\\n0  1  0\\\\\n0  1  0\\\\\n0  0  1\\\\\n0  0  1\n\\end{bmatrix},\\quad\n\\mathbf{Z}_{(0+t\\mid \\text{subject})}=\n\\begin{bmatrix}\n1  0  0  0  0  0\\\\\n1  0  0  1  0  0\\\\\n0  1  0  0  0  0\\\\\n0  1  0  0  1  0\\\\\n0  0  1  0  0  0\\\\\n0  0  1  0  0  1\n\\end{bmatrix},\n$$\n其中前三列是主体截距，后三列是主体斜率。\n\nC. $(1\\mid \\text{subject})$ 指定了一个主体特定的关于 $t$ 的随机斜率；$(0 + t \\mid \\text{subject})$ 指定了一个所有主体共享的关于 $t$ 的单一全局随机斜率。因此，对于 $(1\\mid \\text{subject})$，$\\mathbf{Z}$ 等于一个 $6\\times 3$ 矩阵，其条目等于主体列中观测到的 $t$ 值，而对于 $(0 + t \\mid \\text{subject})$，$\\mathbf{Z}$ 是一个 $6\\times 1$ 的向量\n$$\n\\mathbf{Z}_{(0+t\\mid \\text{subject})}=\n\\begin{bmatrix}\n0\\\\\n1\\\\\n0\\\\\n1\\\\\n0\\\\\n1\n\\end{bmatrix}.\n$$\n\nD. $(1\\mid \\text{subject})$ 为每个主体指定一个随机截距，为了可识别性，该截距必须在各组间进行正交归一化，因此其 $\\mathbf{Z}$ 对每个有 $2$ 个观测值的主体使用按 $1/\\sqrt{2}$ 缩放的主体指示符。$(0 + t \\mid \\text{subject})$ 为每个主体指定一个关于 $t$ 的随机斜率，其中 $t$ 在主体内进行均值中心化，因此其 $\\mathbf{Z}$ 在相应的主体列中使用主体内中心化的 $t$ 值 $\\{-\\tfrac{1}{2},+\\tfrac{1}{2}\\}$。具体来说，\n$$\n\\mathbf{Z}_{(1\\mid \\text{subject})}=\n\\begin{bmatrix}\n\\frac{1}{\\sqrt{2}}  0  0\\\\\n\\frac{1}{\\sqrt{2}}  0  0\\\\\n0  \\frac{1}{\\sqrt{2}}  0\\\\\n0  \\frac{1}{\\sqrt{2}}  0\\\\\n0  0  \\frac{1}{\\sqrt{2}}\\\\\n0  0  \\frac{1}{\\sqrt{2}}\n\\end{bmatrix},\\quad\n\\mathbf{Z}_{(0+t\\mid \\text{subject})}=\n\\begin{bmatrix}\n-\\tfrac{1}{2}  0  0\\\\\n+\\tfrac{1}{2}  0  0\\\\\n0  -\\tfrac{1}{2}  0\\\\\n0  +\\tfrac{1}{2}  0\\\\\n0  0  -\\tfrac{1}{2}\\\\\n0  0  +\\tfrac{1}{2}\n\\end{bmatrix}.\n$$\n\n选择唯一最佳选项。",
            "solution": "问题陈述定义明确且有效。它提出了分层数据分析中的一个标准情景，使用了线性混合效应模型（LMMs）的既定术语和符号。任务是为两种不同的随机效应设定构建随机效应设计矩阵 $\\mathbf{Z}$，这是一个数学上精确且可解的问题。\n\n一般的 LMM 由 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\mathbf{Z}\\mathbf{b} + \\boldsymbol{\\varepsilon}$ 给出。随机效应设计矩阵 $\\mathbf{Z}$ 将观测值 $\\mathbf{y}$ 与主体特定的随机效应 $\\mathbf{b}$ 联系起来。$\\mathbf{Z}$ 的结构由公式 `(effects|group)` 决定。在这个问题中，分组因子是 `subject`，有 $3$ 个水平（$S1$，$S2$，$S3$）。总观测数为 $N=6$。数据排序方式为：前两行对应主体 $S1$（时间点为 $t=0$ 和 $t=1$），接下来的两行对应主体 $S2$（$t=0, 1$），最后两行对应主体 $S3$（$t=0, 1$）。因此，数值时间协变量向量为 $\\mathbf{t} = [0, 1, 0, 1, 0, 1]^T$。\n\n### 随机效应设定分析\n\n矩阵 $\\mathbf{Z}$ 的构建遵循指定的随机效应和分组结构。矩阵 $\\mathbf{Z}$ 有 $N=6$ 行。列数等于随机效应的总数。对于给定的随机效应（例如，主体 $j$ 的随机斜率），$\\mathbf{Z}$ 中的相应列包含属于主体 $j$ 的所有观测值的相关协变量值，而对于所有其他观测值则为 $0$。\n\n**情况 1：随机效应设定 $(1 \\mid \\text{subject})$**\n\n此公式为分组因子 `subject` 的每个水平指定一个随机截距。`1` 代表截距。\n-   有 $3$ 个主体，所以有 $3$ 个随机截距，每个主体一个。设它们分别为 $b_{0,1}$、$b_{0,2}$ 和 $b_{0,3}$，对应主体 $S1$、$S2$ 和 $S3$。随机效应向量为 $\\mathbf{b} = [b_{0,1}, b_{0,2}, b_{0,3}]^T$。\n-   矩阵 $\\mathbf{Z}$ 将有 $6$ 行和 $3$ 列。\n-   第一列对应于 $S1$ 的随机截距 $b_{0,1}$。截距的协变量始终为 $1$。因此，该列在对应于 $S1$ 的行（第 $1$ 和第 $2$ 行）处为 $1$，其他位置为 $0$。\n-   第二列对应于 $S2$ 的随机截距 $b_{0,2}$。它在对应于 $S2$ 的行（第 $3$ 和第 $4$ 行）处为 $1$，其他位置为 $0$。\n-   第三列对应于 $S3$ 的随机截距 $b_{0,3}$。它在对应于 $S3$ 的行（第 $5$ 和第 $6$ 行）处为 $1$，其他位置为 $0$。\n\n根据这种构造，设定 $(1 \\mid \\text{subject})$ 的矩阵 $\\mathbf{Z}$ 为：\n$$\n\\mathbf{Z}_{(1\\mid \\text{subject})} =\n\\begin{bmatrix}\n1  0  0 \\\\\n1  0  0 \\\\\n0  1  0 \\\\\n0  1  0 \\\\\n0  0  1 \\\\\n0  0  1\n\\end{bmatrix}\n$$\n\n**情况 2：随机效应设定 $(0 + t \\mid \\text{subject})$**\n\n此公式为分组因子 `subject` 的每个水平指定了协变量 $t$ 的一个随机斜率。`0 +` 项明确抑制了默认的随机截距。\n-   有 $3$ 个主体，所以有 $3$ 个随机斜率，每个主体一个。设它们分别为 $b_{t,1}$、$b_{t,2}$ 和 $b_{t,3}$，对应主体 $S1$、$S2$ 和 $S3$。随机效应向量为 $\\mathbf{b} = [b_{t,1}, b_{t,2}, b_{t,3}]^T$。\n-   矩阵 $\\mathbf{Z}$ 将有 $6$ 行和 $3$ 列。\n-   第一列对应于 $S1$ 的随机斜率 $b_{t,1}$。相关的协变量是 $t$。该列将包含对应于 $S1$ 的行（第 $1$ 和第 $2$ 行，其中 $t$ 分别为 $0$ 和 $1$）的 $t$ 值，其他位置为 $0$。\n-   第二列对应于 $S2$ 的随机斜率 $b_{t,2}$。它将包含对应于 $S2$ 的行（第 $3$ 和第 $4$ 行，其中 $t$ 分别为 $0$ 和 $1$）的 $t$ 值，其他位置为 $0$。\n-   第三列对应于 $S3$ 的随机斜率 $b_{t,3}$。它将包含对应于 $S3$ 的行（第 $5$ 和第 $6$ 行，其中 $t$ 分别为 $0$ 和 $1$）的 $t$ 值，其他位置为 $0$。\n\n根据这种构造，设定 $(0 + t \\mid \\text{subject})$ 的矩阵 $\\mathbf{Z}$ 为：\n$$\n\\mathbf{Z}_{(0+t\\mid \\text{subject})} =\n\\begin{bmatrix}\n0  0  0 \\\\\n1  0  0 \\\\\n0  0  0 \\\\\n0  1  0 \\\\\n0  0  0 \\\\\n0  0  1\n\\end{bmatrix}\n$$\n\n### 选项评估\n\n**选项 A：**\n该选项指出 $(1\\mid \\text{subject})$ 仅指定一个主体特定的随机截距，而 $(0 + t \\mid \\text{subject})$ 仅指定一个主体特定的关于 $t$ 的随机斜率。这个解释是正确的。它提供了以下矩阵：\n$$\n\\mathbf{Z}_{(1\\mid \\text{subject})}=\n\\begin{bmatrix}\n1  0  0\\\\\n1  0  0\\\\\n0  1  0\\\\\n0  1  0\\\\\n0  0  1\\\\\n0  0  1\n\\end{bmatrix},\n\\quad\n\\mathbf{Z}_{(0+t\\mid \\text{subject})}=\n\\begin{bmatrix}\n0  0  0\\\\\n1  0  0\\\\\n0  0  0\\\\\n0  1  0\\\\\n0  0  0\\\\\n0  0  1\n\\end{bmatrix}\n$$\n这些矩阵与我们基于 LMM 公式语法的标准解释所推导出的矩阵完全匹配。\n结论：**正确**。\n\n**选项 B：**\n该选项错误地指出两种设定都包含一个主体特定的随机截距。公式 $(0 + t \\mid \\text{subject})$ 明确排除了随机截距。它为第二种设定提供的矩阵对应于一个同时具有随机截距和随机斜率的模型，该模型应被指定为 $(1 + t \\mid \\text{subject})$ 或 $(t \\mid \\text{subject})$。对模型公式的解释存在根本性错误。\n结论：**不正确**。\n\n**选项 C：**\n该选项对两个公式的解释都有误。它声称 $(1\\mid \\text{subject})$ 指定了一个随机斜率，这是错误的；`1` 指定的是截距。它还声称 $(0 + t \\mid \\text{subject})$ 指定了一个单一的*全局*随机斜率。这也是错误的；分组语法 `| subject` 使效应是针对每个主体的，而不是全局的。此外，为第二个模型提出的 $\\mathbf{Z}$ 矩阵是一个 $6\\times 1$ 的向量，这意味着一个由 $t$ 调节的、所有主体共有的单一随机效应，而不是主体特定的随机斜率。\n结论：**不正确**。\n\n**选项 D：**\n该选项引入了 LMM 设定本身并未暗示的转换。它声称对于 $(1\\mid \\text{subject})$，$\\mathbf{Z}$ 的列必须进行正交归一化，导致了 $1/\\sqrt{2}$ 的缩放。这不是构建 $\\mathbf{Z}$ 的标准要求，$\\mathbf{Z}$ 通常由指示变量（$0$ 和 $1$）组成。它还声称对于 $(0 + t \\mid \\text{subject})$，协变量 $t$ 必须在每个主体内进行均值中心化。虽然均值中心化对于数值稳定性或解释可能是一个有用的预处理步骤，但它并非 `(0 + t | subject)` 公式所固有的。矩阵 $\\mathbf{Z}$ 是根据所提供的协变量（即 $0$ 和 $1$）构建的。因此，所提出的矩阵不是给定问题的标准表示。\n结论：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "线性混合效应模型的主要优势之一是能够将数据中的总方差分解到不同的层次上。本练习  将演示如何计算由被试间差异引起的方差占总方差的比例，并将其与被试内（或残差）变异进行对比。这项技能对于量化个体差异的幅度以及用科学上更有意义的方式解释模型结果至关重要。",
            "id": "4175390",
            "problem": "一个认知神经科学实验在功能性磁共振成像（fMRI）中，于静息和任务两种条件下，对每位受试者进行多次试验，测量其血氧水平依赖（BOLD）信号的振幅。假设受试者 $i$ 在试验 $j$ 上的试验级 BOLD 振幅由一个线性混合效应模型来建模，该模型包含一个针对二元任务指示变量的受试者特定的随机截距和一个受试者特定的随机斜率。具体来说，令 $y_{ij}$ 表示 BOLD 振幅，$c_{ij} \\in \\{0,1\\}$ 表示条件（$c_{ij}=0$ 代表静息，$c_{ij}=1$ 代表任务）。考虑以下层级模型：\n$$\ny_{ij} = \\beta_{0} + \\beta_{1} c_{ij} + b_{0i} + b_{1i} c_{ij} + \\varepsilon_{ij},\n$$\n其中，受试者级别的随机效应为 $\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left(\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix},\\, G\\right)$，观测级别的误差为 $\\varepsilon_{ij} \\sim \\mathcal{N}(0, \\sigma^{2})$，且随机效应与误差项相互独立。假设估计出的协方差矩阵为\n$$\nG = \\begin{pmatrix} 0.8  0.2 \\\\ 0.2  0.5 \\end{pmatrix}, \\quad R = \\sigma^{2} I \\text{ with } \\sigma^{2} = 1.2,\n$$\n其中 $I$ 是相应维度的单位矩阵。在整个研究中，试验是独立呈现的，任务概率为 $\\mathbb{P}(c_{ij} = 1) = 0.6$，静息概率为 $\\mathbb{P}(c_{ij} = 0) = 0.4$，并假设这反映了评估边际方差时所用的设计分布。\n\n使用线性混合效应模型和 $y_{ij}$ 边际分布的方差分解原理，计算试验级 BOLD 振幅的总边际方差中，可归因于受试者间差异（即受试者级别的随机效应）的设计平均比例，此处的平均是相对于所述的条件概率进行的。以精确分数形式报告您的答案。不要使用百分号表示答案。",
            "solution": "问题要求计算血氧水平依赖（BOLD）信号振幅 $y_{ij}$ 的总边际方差中，可归因于受试者间差异的比例。总方差必须在实验条件 $c_{ij}$ 的分布上进行平均。\n\n指定的线性混合效应模型为：\n$$\ny_{ij} = \\beta_{0} + \\beta_{1} c_{ij} + b_{0i} + b_{1i} c_{ij} + \\varepsilon_{ij}\n$$\n在此模型中，$\\beta_{0}$ 和 $\\beta_{1}$ 是固定效应参数，分别代表群体平均截距和任务效应。$b_{0i}$ 和 $b_{1i}$ 是受试者特定的随机效应，表示每个受试者与群体截距和任务效应的偏离。$\\varepsilon_{ij}$ 是受试者 $i$ 在试验 $j$ 上的残差。\n\n观测值 $y_{ij}$ 的总方差来自模型的随机部分。固定效应部分 $\\beta_{0} + \\beta_{1} c_{ij}$ 决定了 $y_{ij}$ 的条件均值，但对其方差没有贡献。因此，方差分解涉及模型的随机部分：$b_{0i} + b_{1i} c_{ij} + \\varepsilon_{ij}$。\n\n假设随机效应 $\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix}$ 和残差 $\\varepsilon_{ij}$ 是相互独立的。因此，在给定任务条件 $c_{ij}$ 的情况下，$y_{ij}$ 的方差可以表示为由随机效应引起的方差和残差方差之和：\n$$\n\\mathrm{Var}(y_{ij} | c_{ij}) = \\mathrm{Var}(b_{0i} + b_{1i} c_{ij}) + \\mathrm{Var}(\\varepsilon_{ij})\n$$\n第一项 $\\mathrm{Var}(b_{0i} + b_{1i} c_{ij})$ 代表在给定条件 $c_{ij}$ 下的受试者间方差。第二项 $\\mathrm{Var}(\\varepsilon_{ij})$ 是受试者内（或残差）方差。\n\n让我们计算依赖于 $c_{ij}$ 的受试者间方差分量。使用方差的性质和给定的随机效应协方差矩阵 $G$，我们有：\n$$\n\\mathrm{Var}(b_{0i} + b_{1i} c_{ij}) = \\mathrm{Var}(b_{0i}) + c_{ij}^2 \\mathrm{Var}(b_{1i}) + 2 c_{ij} \\mathrm{Cov}(b_{0i}, b_{1i})\n$$\n协方差矩阵 $G = \\begin{pmatrix} 0.8  0.2 \\\\ 0.2  0.5 \\end{pmatrix}$ 的分量为 $\\mathrm{Var}(b_{0i}) = G_{11} = 0.8$，$\\mathrm{Var}(b_{1i}) = G_{22} = 0.5$ 和 $\\mathrm{Cov}(b_{0i}, b_{1i}) = G_{12} = 0.2$。\n由于 $c_{ij}$ 是一个取值为 $\\{0, 1\\}$ 的二元指示变量，我们有 $c_{ij}^2 = c_{ij}$。\n代入 $G$ 中的值：\n$$\n\\mathrm{Var}(b_{0i} + b_{1i} c_{ij}) = 0.8 + c_{ij}(0.5) + 2 c_{ij}(0.2) = 0.8 + 0.9 c_{ij}\n$$\n这是在给定任务条件 $c_{ij}$ 下的受试者间方差。\n\n给定的残差方差为 $\\mathrm{Var}(\\varepsilon_{ij}) = \\sigma^2 = 1.2$。该方差在不同条件下是恒定的。\n\n因此，在给定 $c_{ij}$ 的条件下，$y_{ij}$ 的总方差为：\n$$\n\\mathrm{Var}(y_{ij} | c_{ij}) = (0.8 + 0.9 c_{ij}) + 1.2 = 2.0 + 0.9 c_{ij}\n$$\n问题要求计算一个“设计平均”的比例。这意味着我们必须在条件指示变量 $c_{ij}$ 的指定概率分布上对各方差分量进行平均，该分布为 $\\mathbb{P}(c_{ij} = 1) = 0.6$ 和 $\\mathbb{P}(c_{ij} = 0) = 0.4$。$c_{ij}$ 的期望值为 $\\mathbb{E}[c_{ij}] = 1 \\times \\mathbb{P}(c_{ij} = 1) + 0 \\times \\mathbb{P}(c_{ij} = 0) = 0.6$。\n\n设 $V_{\\text{subject}}$ 为可归因于受试者间差异的设计平均方差。我们通过计算条件性受试者间方差关于 $c_{ij}$ 的期望来得到这个值：\n$$\nV_{\\text{subject}} = \\mathbb{E}_{c_{ij}}[\\mathrm{Var}(b_{0i} + b_{1i} c_{ij})] = \\mathbb{E}[0.8 + 0.9 c_{ij}] = 0.8 + 0.9 \\mathbb{E}[c_{ij}]\n$$\n代入 $\\mathbb{E}[c_{ij}] = 0.6$：\n$$\nV_{\\text{subject}} = 0.8 + 0.9 \\times 0.6 = 0.8 + 0.54 = 1.34\n$$\n\n设 $V_{\\text{total}}$ 为设计平均的总边际方差。这是平均受试者间方差与（恒定的）残差方差之和。\n$$\nV_{\\text{total}} = \\mathbb{E}_{c_{ij}}[\\mathrm{Var}(y_{ij} | c_{ij})] = \\mathbb{E}[V_{\\text{subject}}(c_{ij}) + \\sigma^2] = V_{\\text{subject}} + \\sigma^2\n$$\n代入数值：\n$$\nV_{\\text{total}} = 1.34 + 1.2 = 2.54\n$$\n可归因于受试者间差异的总边际方差的比例是 $V_{\\text{subject}}$ 与 $V_{\\text{total}}$ 的比值：\n$$\n\\text{Proportion} = \\frac{V_{\\text{subject}}}{V_{\\text{total}}} = \\frac{1.34}{2.54}\n$$\n为了将其表示为精确分数，我们可以将该比率写为：\n$$\n\\frac{1.34}{2.54} = \\frac{134}{254}\n$$\n将分子和分母同除以它们的最大公约数 $2$：\n$$\n\\frac{134 \\div 2}{254 \\div 2} = \\frac{67}{127}\n$$\n$67$ 和 $127$ 都是质数，因此该分数已是最简形式。",
            "answer": "$$\\boxed{\\frac{67}{127}}$$"
        },
        {
            "introduction": "在设定一个复杂模型后，关键的下一步是确定其所有组成部分（尤其是随机效应）是否都得到了数据的支持。本练习  将介绍似然比检验（LRT）作为一种形式化方法，用于比较嵌套模型，例如含有随机斜率的模型与不含随机斜率的模型。您将学习此检验的正确步骤，包括在参数空间边界上检验方差分量时所需的关键调整。",
            "id": "4175484",
            "problem": "在一项神经生理学实验中，研究人员记录了在不同对比度水平 $x_{ij}$下，神经元 $i$ 在试验 $j$ 中的尖峰计数 $y_{ij}$。他们提出了一个分层线性混合效应模型，以捕捉神经元间在基线和对比度敏感性方面的异质性。具体来说，他们考虑的平均响应的固定效应结构为 $\\beta_0 + \\beta_1 x_{ij}$，以及一个在神经元水平上具有独立随机截距和随机斜率的随机效应结构。完整模型为\n$$\ny_{ij} = \\beta_0 + \\beta_1 x_{ij} + b_{0i} + b_{1i} x_{ij} + \\varepsilon_{ij},\n$$\n其中 $b_{0i} \\sim \\mathcal{N}(0,\\tau_0^2)$，$b_{1i} \\sim \\mathcal{N}(0,\\tau_1^2)$，$\\text{Cov}(b_{0i},b_{1i})=0$，且 $\\varepsilon_{ij} \\sim \\mathcal{N}(0,\\sigma^2)$ 独立于 $b_{0i}$ 和 $b_{1i}$。研究人员希望正式检验是否需要随机斜率方差，即，他们检验\n$$\nH_0:\\ \\tau_1^2 = 0 \\quad \\text{对} \\quad H_1:\\ \\tau_1^2 > 0,\n$$\n同时保持两个模型之间的固定效应设计相同。他们使用限制性最大似然（REML）方法拟合了这两个模型，其中 $H_0$ 下的简化模型设置 $b_{1i} \\equiv 0$ 并保留 $b_{0i} \\sim \\mathcal{N}(0,\\tau_0^2)$，而 $H_1$ 下的完整模型如上所述同时包含 $b_{0i}$ 和 $b_{1i}$。设 $\\ell_0$ 和 $\\ell_1$ 分别表示简化模型和完整模型的REML对数似然值。在一个数据集中，拟合结果为 $\\ell_0 = -1450.3$ 和 $\\ell_1 = -1448.2$。\n\n仅使用似然、最大似然和大样本似然比理论的基本定义，并认识到参数何时位于参数空间的边界上，下列哪个程序正确地说明了在此场景下如何为随机效应比较执行似然比检验（包括正确的零分布），并根据所提供的数值给出了合适的近似$p$值？\n\nA. 使用具有相同固定效应的限制性最大似然（REML）拟合两个模型；计算似然比统计量 $D = -2(\\ell_0 - \\ell_1)$；因为 $H_0$ 将一个方差分量置于边界上（$\\tau_1^2 = 0$），所以使用混合分布 $0.5\\,\\chi^2_{0} + 0.5\\,\\chi^2_{1}$ 作为 $D$ 的零分布；根据上述的 $\\ell_0$ 和 $\\ell_1$，$D = 4.2$，混合$p$值约为 $0.020$。\n\nB. 使用最大似然（ML）拟合两个模型；计算 $D = -2(\\ell_0 - \\ell_1)$ 并与标准的 $\\chi^2_1$ 分布进行比较，因为差异在于一个协方差参数；当 $D=4.2$ 时，$p$值约为 $0.040$，且边界问题可以忽略不计。\n\nC. 保留REML拟合但避免进行似然比检验；而是对估计的随机斜率方差使用 Satterthwaite $t$ 近似法来检验 $H_0:\\tau_1^2=0$；$D$ 的合适零分布仍然是标准的 $\\chi^2_1$。\n\nD. 使用REML拟合两个模型；计算 $D$ 并与标准的 $\\chi^2_2$ 分布进行比较，因为添加随机斜率既引入了一个方差分量，又在固定效应均值中引入了一个额外的斜率参数；当 $D=4.2$ 时，$p$值约为 $0.122$。\n\nE. 使用REML拟合两个模型；计算 $D$ 并仅通过参数化自举法来评估其显著性，因为混合 $\\chi^2$ 零分布是无效的；这个边界问题的正确零分布是 $0.67\\,\\chi^2_{0} + 0.33\\,\\chi^2_{1}$，得出的 $p$值接近 $0.026$。",
            "solution": "用户想要确定在线性混合效应模型中，对一个方差分量进行似然比检验的正确程序。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   模型设定: $y_{ij} = \\beta_0 + \\beta_1 x_{ij} + b_{0i} + b_{1i} x_{ij} + \\varepsilon_{ij}$\n-   随机效应的假设: $b_{0i} \\sim \\mathcal{N}(0,\\tau_0^2)$, $b_{1i} \\sim \\mathcal{N}(0,\\tau_1^2)$\n-   协方差的假设: $\\text{Cov}(b_{0i},b_{1i})=0$\n-   误差项的假设: $\\varepsilon_{ij} \\sim \\mathcal{N}(0,\\sigma^2)$，独立于随机效应。\n-   零假设 ($H_0$): $\\tau_1^2 = 0$\n-   备择假设 ($H_1$): $\\tau_1^2 > 0$\n-   $H_0$下的简化模型: 保留 $b_{0i}$ 但将 $b_{1i}$ 设为 $\\equiv 0$。\n-   $H_1$下的完整模型: 同时包含 $b_{0i}$ 和 $b_{1i}$。\n-   固定效应结构: 两个模型相同，由 $\\beta_0 + \\beta_1 x_{ij}$ 给出。\n-   估计方法: 限制性最大似然（REML）。\n-   数据: 简化模型的REML对数似然值 $\\ell_0 = -1450.3$。完整模型的REML对数似然值 $\\ell_1 = -1448.2$。\n\n**步骤2：使用提取的已知条件进行验证**\n问题陈述具有科学依据、提法得当且客观。\n-   **科学依据**：使用线性混合效应模型分析分层数据（例如来自多个神经元的重复测量数据）是神经科学和许多其他领域的标准且稳健的方法。具体的模型（随机截距和斜率）以及对方差分量的假设检验是该框架下常见且有意义的应用。\n-   **提法得当性**：问题说明清晰。模型是嵌套的，参数有定义，假设是明确的，并且提供了必要的数据（对数似然值）。问题要求给出正确的检验程序和结果，这可以从已有的统计理论中确定。\n-   **客观性**：问题使用精确的技术语言陈述，没有主观或模糊的术语。\n-   **核心挑战**：该问题正确地设置了一个不简单的统计问题。零假设 $\\tau_1^2 = 0$ 将参数置于其可取值空间（$\\tau_1^2 \\ge 0$）的边界上。这违反了经典似然比检验理论（威尔克斯定理）的一个标准正则性条件，因此需要一种修正的方法。该问题检验了关于混合模型假设检验中这个具体但基础的知识点。\n\n**步骤3：结论与行动**\n该问题是有效的。其设定一致，科学上合理，并提出了一个定义明确的统计挑战。我将继续推导解决方案并评估各个选项。\n\n### 解题推导\n\n中心任务是对方差分量进行假设检验，具体为 $H_0: \\tau_1^2 = 0$ 对 $H_1: \\tau_1^2 > 0$。我们感兴趣的参数 $\\tau_1^2$ 是一个方差，它不能为负。零假设将此参数置于参数空间 $[0, \\infty)$ 的边界上。\n\n1.  **似然比检验统计量**：似然比检验（LRT）统计量定义为 $D = -2(\\ell_0 - \\ell_1)$，其中 $\\ell_0$ 和 $\\ell_1$ 分别是零假设和备择假设下模型的对数似然值。使用提供的值：\n    $$\n    D = -2(-1450.3 - (-1448.2)) = -2(-2.1) = 4.2\n    $$\n\n2.  **正确的零分布**：标准的似然比理论（威尔克斯定理）指出，在某些正则性条件下，$D$ 在 $H_0$ 下的渐近分布是一个卡方分布 $\\chi^2_k$，其中 $k$ 是两个嵌套模型之间自由参数数量的差异。对威尔克斯定理的简单应用会得出 $\\chi^2_1$ 分布。\n\n    然而，威尔克斯定理的一个关键正则性条件是，$H_0$ 下的参数真值必须位于参数空间的内部。在这种情况下，$\\tau_1^2 = 0$ 位于边界上。当一个参数在其空间的边界上进行检验时，LRT统计量的渐近零分布不再是一个简单的卡方分布。\n\n    对于检验单个方差分量（如此处的情况），LRT统计量的渐近零分布是卡方分布的混合（Self  Stram, 1987）。对于检验一个额外的随机效应方差，正确的分布是 $\\chi^2_0$ 分布和 $\\chi^2_1$ 分布的等权重混合。\n    $$\n    D \\sim 0.5\\,\\chi^2_0 + 0.5\\,\\chi^2_1\n    $$\n    $\\chi^2_0$ 分布是在0处的一个点质量。混合分布的这一部分反映了在完整模型下 $\\tau_1^2$ 的最大似然估计为0的非零概率（渐近地为0.5），在这种情况下 $\\ell_1 = \\ell_0$ 且 $D=0$。\n\n3.  **REML的使用**：混合分布的理论是为最大似然（ML）估计推导的。然而，公认的是，LRT可以应用于通过REML拟合的模型，并且只要被比较的模型具有*完全相同的固定效应结构*，同样的渐近混合分布仍然成立。问题陈述明确证实了这一条件：“同时保持两个模型之间的固定效应设计相同”。因此，使用提供的REML对数似然值是合适的。\n\n4.  **$p$值计算**：$p$值是在零假设为真的前提下，观测到等于或比计算出的检验统计量更极端的统计量的概率。对于观测到的统计量 $D = 4.2$ 和零分布 $0.5\\,\\chi^2_0 + 0.5\\,\\chi^2_1$：\n    $$\n    p = P(D \\ge 4.2) = 0.5 \\times P(\\chi^2_0 \\ge 4.2) + 0.5 \\times P(\\chi^2_1 \\ge 4.2)\n    $$\n    由于 $\\chi^2_0$ 是在0处的一个点质量，$P(\\chi^2_0 \\ge 4.2) = 0$。该表达式简化为：\n    $$\n    p = 0.5 \\times P(\\chi^2_1 \\ge 4.2)\n    $$\n    从标准统计表或软件中查得，统计量为 $4.2$ 的 $\\chi^2_1$ 检验的单尾 $p$值约为 $0.0404$。因此，混合分布的正确 $p$值是：\n    $$\n    p \\approx 0.5 \\times 0.0404 = 0.0202\n    $$\n\n### 逐项分析选项\n\n**A. 使用具有相同固定效应的限制性最大似然（REML）拟合两个模型；计算似然比统计量 $D = -2(\\ell_0 - \\ell_1)$；因为 $H_0$ 将一个方差分量置于边界上（$\\tau_1^2 = 0$），所以使用混合分布 $0.5\\,\\chi^2_{0} + 0.5\\,\\chi^2_{1}$ 作为 $D$ 的零分布；根据上述的 $\\ell_0$ 和 $\\ell_1$，$D = 4.2$，混合$p$值约为 $0.020$。**\n-   **分析**：该选项正确地指出了由于固定效应相同，可以使用REML。它正确地计算了检验统计量 $D = 4.2$。它正确地识别了边界问题，并指明了理论上正确的渐近零分布，即 $0.5\\,\\chi^2_{0} + 0.5\\,\\chi^2_{1}$ 的混合分布。最后，它正确地计算出所得 $p$值约为 $0.020$。\n-   **结论**：**正确**。\n\n**B. 使用最大似然（ML）拟合两个模型；计算 $D = -2(\\ell_0 - \\ell_1)$ 并与标准的 $\\chi^2_1$ 分布进行比较，因为差异在于一个协方差参数；当 $D=4.2$ 时，$p$值约为 $0.040$，且边界问题可以忽略不计。**\n-   **分析**：这出于多种原因是错误的。问题指出对数似然值来自REML，而非ML。最关键的是，它将边界问题视为“可忽略的”而忽略，并错误地使用了标准的 $\\chi^2_1$ 分布。边界条件是根本性的，忽略它会导致一个过于保守的检验（$p$值是正确值的两倍）。\n-   **结论**：**错误**。\n\n**C. 保留REML拟合但避免进行似然比检验；而是对估计的随机斜率方差使用 Satterthwaite $t$ 近似法来检验 $H_0:\\tau_1^2=0$；$D$ 的合适零分布仍然是标准的 $\\chi^2_1$。**\n-   **分析**：该选项内部不一致且在事实上是错误的。Satterthwaite近似法通常用于为固定效应或方差分量的线性组合构建检验或置信区间，而不是用于对单个方差分量的简单LRT。它错误地断言LRT统计量 $D$ 的零分布是标准的 $\\chi^2_1$ 分布，这与边界问题的正确理论相矛盾。\n-   **结论**：**错误**。\n\n**D. 使用REML拟合两个模型；计算 $D$ 并与标准的 $\\chi^2_2$ 分布进行比较，因为添加随机斜率既引入了一个方差分量，又在固定效应均值中引入了一个额外的斜率参数；当 $D=4.2$ 时，$p$值约为 $0.122$。**\n-   **分析**：这是错误的。问题明确指出两个模型之间的固定效应设计是相同的。添加一个随机斜率 $b_{1i}$ 并不会改变固定效应参数的数量。模型仅在随机效应协方差结构中相差一个参数（$\\tau_1^2$）。因此，使用 $\\chi^2_2$ 分布是错误的。\n-   **结论**：**错误**。\n\n**E. 使用REML拟合两个模型；计算 $D$ 并仅通过参数化自举法来评估其显著性，因为混合 $\\chi^2$ 零分布是无效的；这个边界问题的正确零分布是 $0.67\\,\\chi^2_{0} + 0.33\\,\\chi^2_{1}$，得出的 $p$值接近 $0.026$。**\n-   **分析**：这是错误的。虽然参数化自举法是进行此项检验的一种有效（且经常被推荐）的方法，但声称渐近混合 $\\chi^2$ 分布“无效”是错误的。$0.5\\,\\chi^2_{0} + 0.5\\,\\chi^2_{1}$ 混合分布是用于检验一个方差分量的、理论上推导出的正确渐近零分布。对于这个特定的检验场景，所提出的混合权重 $0.67$ 和 $0.33$ 是不正确的。\n-   **结论**：**错误**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}