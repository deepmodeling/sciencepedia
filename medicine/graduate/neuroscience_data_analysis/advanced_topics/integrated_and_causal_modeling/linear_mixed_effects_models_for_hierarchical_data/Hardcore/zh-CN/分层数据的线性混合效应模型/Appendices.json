{
    "hands_on_practices": [
        {
            "introduction": "本练习聚焦于构建线性混合效应模型的基石：模型设定。在实践中，统计软件使用简洁的公式语法来定义复杂的随机效应结构。掌握这种语法与其底层随机效应设计矩阵 $Z$ 之间的转换，对于确保模型准确反映您的实验设计和研究问题至关重要 。",
            "id": "4175329",
            "problem": "一项皮层兴奋性实验测量了每位参与者在两个会话中的运动诱发电位幅度：时间 $t=0$ 的基线会话和时间 $t=1$ 的干预后会话。有 $3$ 名参与者（分组因子水平），标记为 $S1$、$S2$ 和 $S3$。每位参与者在两个会话中都进行了测量，共产生 $6$ 个观测值。行的顺序为 $(S1,t=0)$、$(S1,t=1)$、$(S2,t=0)$、$(S2,t=1)$、$(S3,t=0)$、$(S3,t=1)$。假设 $t$ 是一个数值协变量，取值为给定的 $0$ 和 $1$。\n\n你计划使用标准的线性混合模型公式来拟合线性混合效应模型\n$$\n\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\mathbf{Z}\\mathbf{b} + \\boldsymbol{\\varepsilon},\n$$\n其中 $\\mathbf{y}$ 是 $6\\times 1$ 的响应向量，$\\mathbf{X}$ 是固定效应设计矩阵，$\\boldsymbol{\\beta}$ 是固定效应系数向量，$\\mathbf{Z}$ 是随机效应设计矩阵，$\\mathbf{b}$ 是随机效应系数向量，满足 $\\mathbf{b}\\sim \\mathcal{N}(\\mathbf{0},\\mathbf{G})$，而 $\\boldsymbol{\\varepsilon}\\sim \\mathcal{N}(\\mathbf{0},\\sigma^2\\mathbf{I})$ 且独立于 $\\mathbf{b}$。随机效应设计矩阵 $\\mathbf{Z}$ 通过将组成员关系指示符与随机效应协变量相结合，将每个观测值映射到相应的特定于受试者的随机系数。\n\n考虑公式语法中的两种随机效应设定：$(1\\mid \\text{subject})$ 和 $(0 + t \\mid \\text{subject})$，其中分组因子是受试者标识符，$t$ 是上面定义的数值时间协变量。对于这个包含 $6$ 行的数据集，哪个选项正确解释了这两种设定之间的差异，并推导出了相应的随机效应设计矩阵 $\\mathbf{Z}$？\n\nA. $(1\\mid \\text{subject})$ 仅指定一个特定于受试者的随机截距；$(0 + t \\mid \\text{subject})$ 仅指定一个特定于受试者的关于 $t$ 的随机斜率（无随机截距）。因此，在这两种情况下，$\\mathbf{Z}$ 都有 $3$ 列，每个受试者一列。对于 $(1\\mid \\text{subject})$，\n$$\n\\mathbf{Z}_{(1\\mid \\text{subject})}=\n\\begin{bmatrix}\n1  & 0  & 0\\\\\n1  & 0  & 0\\\\\n0  & 1  & 0\\\\\n0  & 1  & 0\\\\\n0  & 0  & 1\n\\end{bmatrix},\n$$\n而对于 $(0 + t \\mid \\text{subject})$，\n$$\n\\mathbf{Z}_{(0+t\\mid \\text{subject})}=\n\\begin{bmatrix}\n0  & 0  & 0\\\\\n1  & 0  & 0\\\\\n0  & 0  & 0\\\\\n0  & 1  & 0\\\\\n0  & 0  & 0\\\\\n0  & 0  & 1\n\\end{bmatrix},\n$$\n因为每一列对应一个受试者，并携带该受试者在每一行的 $t$ 值，其他位置为零。\n\nB. $(1\\mid \\text{subject})$ 和 $(0 + t \\mid \\text{subject})$ 都包含一个特定于受试者的随机截距，但 $(0 + t \\mid \\text{subject})$ 还额外包含一个特定于受试者的随机斜率。因此，对于 $(1\\mid \\text{subject})$，$\\mathbf{Z}$ 是一个 $6\\times 3$ 的矩阵，包含受试者指示符；而对于 $(0 + t \\mid \\text{subject})$，它是一个 $6\\times 6$ 的矩阵，每个受试者有两列：\n$$\n\\mathbf{Z}_{(1\\mid \\text{subject})}=\n\\begin{bmatrix}\n1  & 0  & 0\\\\\n1  & 0  & 0\\\\\n0  & 1  & 0\\\\\n0  & 1  & 0\\\\\n0  & 0  & 1\n\\end{bmatrix},\\quad\n\\mathbf{Z}_{(0+t\\mid \\text{subject})}=\n\\begin{bmatrix}\n1  & 0  & 0  & 0  & 0  & 0\\\\\n1  & 0  & 0  & 1  & 0  & 0\\\\\n0  & 1  & 0  & 0  & 0  & 0\\\\\n0  & 1  & 0  & 0  & 1  & 0\\\\\n0  & 0  & 1  & 0  & 0  & 0\\\\\n0  & 0  & 1  & 0  & 0  & 1\n\\end{bmatrix},\n$$\n其中前三列是受试者截距，后三列是受试者斜率。\n\nC. $(1\\mid \\text{subject})$ 指定了一个特定于受试者的关于 $t$ 的随机斜率；$(0 + t \\mid \\text{subject})$ 指定了一个所有受试者共享的关于 $t$ 的单一全局随机斜率。因此，对于 $(1\\mid \\text{subject})$，$\\mathbf{Z}$ 等于一个 $6\\times 3$ 矩阵，其条目等于在受试者对应列中观测到的 $t$ 值，而对于 $(0 + t \\mid \\text{subject})$，$\\mathbf{Z}$ 是一个 $6\\times 1$ 的向量\n$$\n\\mathbf{Z}_{(0+t\\mid \\text{subject})}=\n\\begin{bmatrix}\n0\\\\\n1\\\\\n0\\\\\n1\\\\\n0\\\\\n1\n\\end{bmatrix}.\n$$\n\nD. $(1\\mid \\text{subject})$ 为每个受试者指定一个随机截距，为了可识别性，该截距必须在各组之间进行正交规范化，所以它的 $\\mathbf{Z}$ 对每个有 $2$ 个观测值的受试者使用按 $1/\\sqrt{2}$ 缩放的受试者指示符。$(0 + t \\mid \\text{subject})$ 为每个受试者指定一个关于 $t$ 的随机斜率，其中 $t$ 在受试者内部进行了均值中心化，所以它的 $\\mathbf{Z}$ 在相应的受试者列中使用受试者内中心化的 $t$ 值 $\\{-\\tfrac{1}{2},+\\tfrac{1}{2}\\}$。具体来说，\n$$\n\\mathbf{Z}_{(1\\mid \\text{subject})}=\n\\begin{bmatrix}\n\\frac{1}{\\sqrt{2}}  & 0  & 0\\\\\n\\frac{1}{\\sqrt{2}}  & 0  & 0\\\\\n0  & \\frac{1}{\\sqrt{2}}  & 0\\\\\n0  & \\frac{1}{\\sqrt{2}}  & 0\\\\\n0  & 0  & \\frac{1}{\\sqrt{2}}\\\\\n0  & 0  & \\frac{1}{\\sqrt{2}}\n\\end{bmatrix},\\quad\n\\mathbf{Z}_{(0+t\\mid \\text{subject})}=\n\\begin{bmatrix}\n-\\tfrac{1}{2}  & 0  & 0\\\\\n+\\tfrac{1}{2}  & 0  & 0\\\\\n0  & -\\tfrac{1}{2}  & 0\\\\\n0  & +\\tfrac{1}{2}  & 0\\\\\n0  & 0  & -\\tfrac{1}{2}\\\\\n0  & 0  & +\\tfrac{1}{2}\n\\end{bmatrix}.\n$$\n\n选择唯一最佳选项。",
            "solution": "问题陈述定义明确且有效。它展示了分层数据分析中的一个标准场景，使用了线性混合效应模型（LMM）的既定术语和表示法。任务是为两种不同的随机效应设定构建随机效应设计矩阵 $\\mathbf{Z}$，这是一个数学上精确且可解的问题。\n\n一般的 LMM 由 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\mathbf{Z}\\mathbf{b} + \\boldsymbol{\\varepsilon}$ 给出。随机效应设计矩阵 $\\mathbf{Z}$ 将观测值 $\\mathbf{y}$ 与特定于受试者的随机效应 $\\mathbf{b}$ 联系起来。$\\mathbf{Z}$ 的结构由公式 `(effects|group)` 决定。在这个问题中，分组因子是 `subject`，有 $3$ 个水平（$S1$, $S2$, $S3$）。总观测数为 $N=6$。数据排序方式为：前两行对应受试者 $S1$（在时间 $t=0$ 和 $t=1$），接下来两行对应受试者 $S2$（$t=0, 1$），最后两行对应受试者 $S3$（$t=0, 1$）。因此，数值时间协变量向量为 $\\mathbf{t} = [0, 1, 0, 1, 0, 1]^T$。\n\n### 随机效应设定的分析\n\n矩阵 $\\mathbf{Z}$ 的构建遵循指定的随机效应和分组结构。矩阵 $\\mathbf{Z}$ 有 $N=6$ 行。列数等于随机效应的总数。对于给定的随机效应（例如，受试者 $j$ 的随机斜率），$\\mathbf{Z}$ 中相应的列包含属于受试者 $j$ 的所有观测值的相关协变量的值，而对于所有其他观测值则为 $0$。\n\n**情况 1：随机效应设定 $(1 \\mid \\text{subject})$**\n\n此公式为分组因子 `subject` 的每个水平指定一个随机截距。`1` 代表截距。\n-   有 $3$ 个受试者，因此有 $3$ 个随机截距，每个受试者一个。让它们分别为受试者 $S1$、$S2$ 和 $S3$ 的 $b_{0,1}$、$b_{0,2}$ 和 $b_{0,3}$。随机效应向量是 $\\mathbf{b} = [b_{0,1}, b_{0,2}, b_{0,3}]^T$。\n-   矩阵 $\\mathbf{Z}$ 将有 $6$ 行和 $3$ 列。\n-   第一列对应于 $S1$ 的随机截距 $b_{0,1}$。截距的协变量始终为 $1$。因此，此列在对应于 $S1$ 的行（第 1 行和第 2 行）中为 $1$，否则为 $0$。\n-   第二列对应于 $S2$ 的随机截距 $b_{0,2}$。它在对应于 $S2$ 的行（第 3 行和第 4 行）中为 $1$，否则为 $0$。\n-   第三列对应于 $S3$ 的随机截距 $b_{0,3}$。它在对应于 $S3$ 的行（第 5 行和第 6 行）中为 $1$，否则为 $0$。\n\n根据这种构建方法，设定 $(1 \\mid \\text{subject})$ 的矩阵 $\\mathbf{Z}$ 是：\n$$\n\\mathbf{Z}_{(1\\mid \\text{subject})} =\n\\begin{bmatrix}\n1  & 0  & 0 \\\\\n1  & 0  & 0 \\\\\n0  & 1  & 0 \\\\\n0  & 1  & 0 \\\\\n0  & 0  & 1 \\\\\n0  & 0  & 1\n\\end{bmatrix}\n$$\n\n**情况 2：随机效应设定 $(0 + t \\mid \\text{subject})$**\n\n此公式为分组因子 `subject` 的每个水平指定一个关于协变量 $t$ 的随机斜率。`0 +` 项明确抑制了默认的随机截距。\n-   有 $3$ 个受试者，因此有 $3$ 个随机斜率，每个受试者一个。让它们分别为受试者 $S1$、$S2$ 和 $S3$ 的 $b_{t,1}$、$b_{t,2}$ 和 $b_{t,3}$。随机效应向量是 $\\mathbf{b} = [b_{t,1}, b_{t,2}, b_{t,3}]^T$。\n-   矩阵 $\\mathbf{Z}$ 将有 $6$ 行和 $3$ 列。\n-   第一列对应于 $S1$ 的随机斜率 $b_{t,1}$。相关的协变量是 $t$。此列将包含对应于 $S1$ 的行（第 1 行和第 2 行，其中 $t$ 为 $0$ 和 $1$）的 $t$ 值，否则为 $0$。\n-   第二列对应于 $S2$ 的随机斜率 $b_{t,2}$。它将包含对应于 $S2$ 的行（第 3 行和第 4 行，其中 $t$ 为 $0$ 和 $1$）的 $t$ 值，否则为 $0$。\n-   第三列对应于 $S3$ 的随机斜率 $b_{t,3}$。它将包含对应于 $S3$ 的行（第 5 行和第 6 行，其中 $t$ 为 $0$ 和 $1$）的 $t$ 值，否则为 $0$。\n\n根据这种构建方法，设定 $(0 + t \\mid \\text{subject})$ 的矩阵 $\\mathbf{Z}$ 是：\n$$\n\\mathbf{Z}_{(0+t\\mid \\text{subject})} =\n\\begin{bmatrix}\n0  & 0  & 0 \\\\\n1  & 0  & 0 \\\\\n0  & 0  & 0 \\\\\n0  & 1  & 0 \\\\\n0  & 0  & 0 \\\\\n0  & 0  & 1\n\\end{bmatrix}\n$$\n\n### 选项评估\n\n**选项 A：**\n此选项指出 $(1\\mid \\text{subject})$ 仅指定一个特定于受试者的随机截距，而 $(0 + t \\mid \\text{subject})$ 仅指定一个特定于受试者的关于 $t$ 的随机斜率。这种解释是正确的。它提供了以下矩阵：\n$$\n\\mathbf{Z}_{(1\\mid \\text{subject})}=\n\\begin{bmatrix}\n1  & 0  & 0\\\\\n1  & 0  & 0\\\\\n0  & 1  & 0\\\\\n0  & 1  & 0\\\\\n0  & 0  & 1\n\\end{bmatrix},\n\\quad\n\\mathbf{Z}_{(0+t\\mid \\text{subject})}=\n\\begin{bmatrix}\n0  & 0  & 0\\\\\n1  & 0  & 0\\\\\n0  & 0  & 0\\\\\n0  & 1  & 0\\\\\n0  & 0  & 0\\\\\n0  & 0  & 1\n\\end{bmatrix}\n$$\n这些矩阵与上面基于 LMM 公式语法的标准解释推导出的矩阵完全匹配。\n结论：**正确**。\n\n**选项 B：**\n此选项错误地指出两种设定都包含特定于受试者的随机截距。公式 $(0 + t \\mid \\text{subject})$ 明确排除了随机截距。它为第二种设定提供的矩阵对应于一个同时具有随机截距和随机斜率的模型，该模型应被指定为 $(1 + t \\mid \\text{subject})$ 或 $(t \\mid \\text{subject})$。对模型公式的解释存在根本性错误。\n结论：**错误**。\n\n**选项 C：**\n此选项错误地解释了两个公式。它声称 $(1\\mid \\text{subject})$ 指定了一个随机斜率，这是错误的；`1` 指定的是截距。它还声称 $(0 + t \\mid \\text{subject})$ 指定了一个单一的*全局*随机斜率。这也是错误的；分组语法 `| subject` 使效应特定于每个受试者，而不是全局的。此外，为第二个模型提出的 $\\mathbf{Z}$ 矩阵是一个单一的 $6\\times 1$ 向量，这意味着一个由 $t$ 调制的、所有受试者共有的单一随机效应，而不是特定于受试者的随机斜率。\n结论：**错误**。\n\n**选项 D：**\n此选项引入了 LMM 设定本身并未暗示的转换。它声称对于 $(1\\mid \\text{subject})$，$\\mathbf{Z}$ 的列必须进行正交规范化，导致按 $1/\\sqrt{2}$ 缩放。这不是构建 $\\mathbf{Z}$ 的标准要求，$\\mathbf{Z}$ 通常由指示变量（$0$ 和 $1$）组成。它还声称对于 $(0 + t \\mid \\text{subject})$，协变量 $t$ 必须在每个受试者内部进行均值中心化。虽然均值中心化对于数值稳定性或解释可能是一个有用的预处理步骤，但它并非公式 `(0 + t | subject)` 所固有的。矩阵 $\\mathbf{Z}$ 是根据所提供的协变量（即 $0$ 和 $1$）构建的。因此，所提出的矩阵不是给定问题的标准表示。\n结论：**错误**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "成功拟合模型后，下一步是解释其参数以获得科学见解。本实践问题演示了如何使用估计出的方差-协方差分量（$G$ 和 $\\sigma^2$）来进行方差分解。通过这样做，您可以回答关于数据变异来源的关键问题，例如量化由被试间差异所导致的方差比例 。",
            "id": "4175390",
            "problem": "一项认知神经科学实验在两种条件下（静息和任务）测量了每个被试多次试验中功能性磁共振成像（fMRI）的血氧水平依赖（BOLD）振幅。假设被试 $i$ 在试验 $j$ 的试验水平BOLD振幅由一个线性混合效应模型来建模，该模型包含一个被试特异性随机截距和一个针对二元任务指示变量的被试特异性随机斜率。具体来说，令 $y_{ij}$ 表示BOLD振幅，$c_{ij} \\in \\{0,1\\}$ 表示条件（$c_{ij}=0$ 为静息，$c_{ij}=1$ 为任务）。考虑以下层级模型\n$$\ny_{ij} = \\beta_{0} + \\beta_{1} c_{ij} + b_{0i} + b_{1i} c_{ij} + \\varepsilon_{ij},\n$$\n其中，被试水平的随机效应为 $\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left(\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix},\\, G\\right)$，观测水平的误差为 $\\varepsilon_{ij} \\sim \\mathcal{N}(0, \\sigma^{2})$，且与随机效应独立。假设估计的协方差矩阵为\n$$\nG = \\begin{pmatrix} 0.8 & 0.2 \\\\ 0.2 & 0.5 \\end{pmatrix}, \\quad R = \\sigma^{2} I \\text{ with } \\sigma^{2} = 1.2,\n$$\n其中 $I$ 是适当维度的单位矩阵。在整个研究中，试验以任务概率 $\\mathbb{P}(c_{ij} = 1) = 0.6$ 和静息概率 $\\mathbb{P}(c_{ij} = 0) = 0.4$ 独立呈现，并假设这反映了评估边际方差所使用的设计分布。\n\n运用线性混合效应模型和 $y_{ij}$ 边际分布的方差分解原理，计算试验水平BOLD振幅的总边际方差中可归因于被试间差异（即被试水平的随机效应）的设计平均比例，其中平均是相对于所述的条件概率进行的。请以精确分数形式报告您的答案。请勿使用百分号表示答案。",
            "solution": "该问题要求计算血氧水平依赖（BOLD）振幅 $y_{ij}$ 的总边际方差中，可归因于被试间差异的比例。总方差必须在实验条件 $c_{ij}$ 的分布上进行平均。\n\n指定的线性混合效应模型为：\n$$\ny_{ij} = \\beta_{0} + \\beta_{1} c_{ij} + b_{0i} + b_{1i} c_{ij} + \\varepsilon_{ij}\n$$\n在这里，$\\beta_{0}$ 和 $\\beta_{1}$ 是固定效应参数，分别代表总体平均截距和任务效应。$b_{0i}$ 和 $b_{1i}$ 项是被试特异性随机效应，代表每个被试与总体截距和任务效应的偏差。$\\varepsilon_{ij}$ 项是被试 $i$ 在试验 $j$ 上的残差。\n\n一次观测 $y_{ij}$ 的总方差来自模型的随机部分。固定效应部分 $\\beta_{0} + \\beta_{1} c_{ij}$ 决定了 $y_{ij}$ 的条件均值，但对其方差没有贡献。因此，方差分解涉及模型的随机部分：$b_{0i} + b_{1i} c_{ij} + \\varepsilon_{ij}$。\n\n随机效应 $\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix}$ 和残差 $\\varepsilon_{ij}$ 假设是独立的。因此，$y_{ij}$ 在给定任务条件 $c_{ij}$ 下的方差可以表示为由随机效应引起的方差与残差的方差之和：\n$$\n\\mathrm{Var}(y_{ij} | c_{ij}) = \\mathrm{Var}(b_{0i} + b_{1i} c_{ij}) + \\mathrm{Var}(\\varepsilon_{ij})\n$$\n第一项 $\\mathrm{Var}(b_{0i} + b_{1i} c_{ij})$ 代表在给定条件 $c_{ij}$ 下的被试间方差。第二项 $\\mathrm{Var}(\\varepsilon_{ij})$ 是被试内（或残差）方差。\n\n让我们计算依赖于 $c_{ij}$ 的被试间方差分量。利用方差的性质和给定的随机效应协方差矩阵 $G$，我们有：\n$$\n\\mathrm{Var}(b_{0i} + b_{1i} c_{ij}) = \\mathrm{Var}(b_{0i}) + c_{ij}^2 \\mathrm{Var}(b_{1i}) + 2 c_{ij} \\mathrm{Cov}(b_{0i}, b_{1i})\n$$\n协方差矩阵 $G = \\begin{pmatrix} 0.8 & 0.2 \\\\ 0.2 & 0.5 \\end{pmatrix}$ 的分量为 $\\mathrm{Var}(b_{0i}) = G_{11} = 0.8$，$\\mathrm{Var}(b_{1i}) = G_{22} = 0.5$ 和 $\\mathrm{Cov}(b_{0i}, b_{1i}) = G_{12} = 0.2$。\n由于 $c_{ij}$ 是一个取值为 $\\{0, 1\\}$ 的二元指示变量，我们有 $c_{ij}^2 = c_{ij}$。\n代入 $G$ 中的值：\n$$\n\\mathrm{Var}(b_{0i} + b_{1i} c_{ij}) = 0.8 + c_{ij}(0.5) + 2 c_{ij}(0.2) = 0.8 + 0.9 c_{ij}\n$$\n这是在给定任务条件 $c_{ij}$ 下的被试间方差。\n\n残差方差给定为 $\\mathrm{Var}(\\varepsilon_{ij}) = \\sigma^2 = 1.2$。该方差在所有条件下都是恒定的。\n\n因此，$y_{ij}$ 在给定 $c_{ij}$ 条件下的总方差为：\n$$\n\\mathrm{Var}(y_{ij} | c_{ij}) = (0.8 + 0.9 c_{ij}) + 1.2 = 2.0 + 0.9 c_{ij}\n$$\n问题要求计算一个“设计平均”的比例。这意味着我们必须在条件指示变量 $c_{ij}$ 的指定概率分布上对各方差分量进行平均，该分布为 $\\mathbb{P}(c_{ij} = 1) = 0.6$ 和 $\\mathbb{P}(c_{ij} = 0) = 0.4$。$c_{ij}$ 的期望值为 $\\mathbb{E}[c_{ij}] = 1 \\times \\mathbb{P}(c_{ij} = 1) + 0 \\times \\mathbb{P}(c_{ij} = 0) = 0.6$。\n\n令 $V_{\\text{subject}}$ 为可归因于被试间差异的设计平均方差。我们通过对条件被试间方差关于 $c_{ij}$ 求期望来计算这个值：\n$$\nV_{\\text{subject}} = \\mathbb{E}_{c_{ij}}[\\mathrm{Var}(b_{0i} + b_{1i} c_{ij})] = \\mathbb{E}[0.8 + 0.9 c_{ij}] = 0.8 + 0.9 \\mathbb{E}[c_{ij}]\n$$\n代入 $\\mathbb{E}[c_{ij}] = 0.6$：\n$$\nV_{\\text{subject}} = 0.8 + 0.9 \\times 0.6 = 0.8 + 0.54 = 1.34\n$$\n\n令 $V_{\\text{total}}$ 为设计平均的总边际方差。它等于平均后的被试间方差与（恒定的）残差方差之和。\n$$\nV_{\\text{total}} = \\mathbb{E}_{c_{ij}}[\\mathrm{Var}(y_{ij} | c_{ij})] = \\mathbb{E}[V_{\\text{subject}}(c_{ij}) + \\sigma^2] = V_{\\text{subject}} + \\sigma^2\n$$\n代入数值：\n$$\nV_{\\text{total}} = 1.34 + 1.2 = 2.54\n$$\n可归因于被试间差异的总边际方差的比例是 $V_{\\text{subject}}$ 与 $V_{\\text{total}}$ 的比值：\n$$\n\\text{Proportion} = \\frac{V_{\\text{subject}}}{V_{\\text{total}}} = \\frac{1.34}{2.54}\n$$\n为了将其表示为精确分数，我们可以将该比值写为：\n$$\n\\frac{1.34}{2.54} = \\frac{134}{254}\n$$\n将分子和分母同除以它们的最大公约数 $2$：\n$$\n\\frac{134 \\div 2}{254 \\div 2} = \\frac{67}{127}\n$$\n$67$ 和 $127$ 都是素数，所以这个分数是最简形式。",
            "answer": "$$\\boxed{\\frac{67}{127}}$$"
        },
        {
            "introduction": "建模过程的一个关键部分是确定随机效应结构的适当复杂度。我们常常需要检验一个更复杂的模型（例如，包含随机斜率的模型）是否比一个更简单的嵌套模型提供了显著更优的拟合。本练习介绍了似然比检验（LRT）作为进行此类比较的正式方法，并强调了一个关键细节：当在参数空间的边界上检验方差分量时，会出现非标准的零分布 。",
            "id": "4175484",
            "problem": "在一项神经生理学实验中，研究人员记录了在不同对比度水平 $x_{ij}$ 下，神经元 $i$ 在试验 $j$ 中的试验级尖峰计数 $y_{ij}$。他们提出了一个分层线性混合效应模型来捕捉神经元间在基线和对比度敏感性方面的异质性。具体来说，他们考虑平均响应的固定效应结构为 $\\beta_0 + \\beta_1 x_{ij}$，以及在神经元水平上具有独立随机截距和随机斜率的随机效应结构。完整模型为\n$$\ny_{ij} = \\beta_0 + \\beta_1 x_{ij} + b_{0i} + b_{1i} x_{ij} + \\varepsilon_{ij},\n$$\n其中 $b_{0i} \\sim \\mathcal{N}(0,\\tau_0^2)$, $b_{1i} \\sim \\mathcal{N}(0,\\tau_1^2)$, $\\text{Cov}(b_{0i},b_{1i})=0$，并且 $\\varepsilon_{ij} \\sim \\mathcal{N}(0,\\sigma^2)$ 独立于 $b_{0i}$ 和 $b_{1i}$。研究人员希望正式检验是否需要随机斜率方差，即他们检验\n$$\nH_0:\\ \\tau_1^2 = 0 \\quad \\text{versus} \\quad H_1:\\ \\tau_1^2 > 0,\n$$\n同时保持模型间的固定效应设计相同。他们使用限制性最大似然（REML）方法拟合了两个模型，其中 $H_0$ 下的简化模型设置 $b_{1i} \\equiv 0$ 并保留 $b_{0i} \\sim \\mathcal{N}(0,\\tau_0^2)$，而 $H_1$ 下的完整模型如上所述包含 $b_{0i}$ 和 $b_{1i}$。设 $\\ell_0$ 和 $\\ell_1$ 分别表示简化模型和完整模型的REML对数似然。在一个数据集中，拟合结果为 $\\ell_0 = -1450.3$ 和 $\\ell_1 = -1448.2$。\n\n仅使用似然、最大似然和大样本似然比理论的基本定义，并认识到参数何时位于参数空间的边界上，以下哪个程序正确地说明了如何在这种情况下执行随机效应比较的似然比检验（包括正确的零分布），并根据所提供的数字给出了适当的近似$p$值？\n\nA. 使用限制性最大似然（REML）和相同的固定效应拟合两个模型；计算似然比统计量 $D = -2(\\ell_0 - \\ell_1)$；因为 $H_0$ 将一个方差分量置于边界上（$\\tau_1^2 = 0$），所以使用混合分布 $0.5\\,\\chi^2_{0} + 0.5\\,\\chi^2_{1}$ 作为 $D$ 的零分布；根据上述 $\\ell_0$ 和 $\\ell_1$，得到 $D = 4.2$，混合$p$值约为 $0.020$。\n\nB. 使用最大似然（ML）拟合两个模型；计算 $D = -2(\\ell_0 - \\ell_1)$ 并与标准的 $\\chi^2_{1}$ 分布进行比较，因为差异在于一个协方差参数；当 $D=4.2$ 时，$p$值约为 $0.040$，且边界问题可忽略不计。\n\nC. 保留REML拟合但避免似然比检验；而是对估计的随机斜率方差使用Satterthwaite t-近似来检验 $H_0:\\tau_1^2=0$；$D$ 的适当零分布仍然是标准的 $\\chi^2_{1}$。\n\nD. 使用REML拟合两个模型；计算 $D$ 并与标准的 $\\chi^2_{2}$ 分布进行比较，因为添加随机斜率既引入了一个方差分量，又在固定效应均值中增加了一个额外的斜率参数；当 $D=4.2$ 时，$p$值约为 $0.122$。\n\nE. 使用REML拟合两个模型；计算 $D$ 并仅通过参数自举法评估显著性，因为混合 $\\chi^2$ 零分布无效；该边界问题的正确零分布是 $0.67\\,\\chi^2_{0} + 0.33\\,\\chi^2_{1}$，得出的 $p$值接近 $0.026$。",
            "solution": "用户希望确定在线性混合效应模型中对方差分量进行似然比检验的正确程序。\n\n### 问题验证\n\n**第1步：提取已知信息**\n-   模型设定：$y_{ij} = \\beta_0 + \\beta_1 x_{ij} + b_{0i} + b_{1i} x_{ij} + \\varepsilon_{ij}$\n-   随机效应的假设：$b_{0i} \\sim \\mathcal{N}(0,\\tau_0^2)$，$b_{1i} \\sim \\mathcal{N}(0,\\tau_1^2)$\n-   协方差的假设：$\\text{Cov}(b_{0i},b_{1i})=0$\n-   误差项的假设：$\\varepsilon_{ij} \\sim \\mathcal{N}(0,\\sigma^2)$，独立于随机效应。\n-   零假设（$H_0$）：$\\tau_1^2 = 0$\n-   备择假设（$H_1$）：$\\tau_1^2 > 0$\n-   $H_0$ 下的简化模型：保留 $b_{0i}$ 但设置 $b_{1i} \\equiv 0$。\n-   $H_1$ 下的完整模型：包含 $b_{0i}$ 和 $b_{1i}$。\n-   固定效应结构：两个模型相同，由 $\\beta_0 + \\beta_1 x_{ij}$ 给出。\n-   估计方法：限制性最大似然（REML）。\n-   数据：简化模型的REML对数似然 $\\ell_0 = -1450.3$。完整模型的REML对数似然 $\\ell_1 = -1448.2$。\n\n**第2步：使用提取的已知信息进行验证**\n问题陈述具有科学依据、问题明确且客观。\n-   **科学依据**：使用线性混合效应模型分析分层数据（例如来自多个神经元的重复测量）是神经科学和许多其他领域的标准且稳健的方法。具体的模型（随机截距和斜率）以及对方差分量的假设检验是此框架的常见且有意义的应用。\n-   **问题明确性**：问题规定得很清楚。模型是嵌套的，参数有定义，假设是明确的，并且提供了必要的数据（对数似然）。问题要求给出正确的检验程序和结果，这可以从已建立的统计理论中确定。\n-   **客观性**：问题使用精确的技术语言陈述，没有主观或模糊的术语。\n-   **核心挑战**：该问题正确地设置了一个不平凡的统计问题。零假设 $\\tau_1^2 = 0$ 将参数置于其允许空间（$\\tau_1^2 \\ge 0$）的边界上。这违反了经典似然比检验理论（Wilks定理）的标准正则性条件，需要一种修正的方法。该问题检验了混合模型假设检验中这一具体但根本的知识点。\n\n**第3步：结论与行动**\n问题是有效的。设置是一致的、科学上合理的，并提出了一个明确的统计挑战。我将继续推导解决方案并评估选项。\n\n### 解决方案推导\n\n核心任务是对方差分量进行假设检验，具体为 $H_0: \\tau_1^2 = 0$ 对 $H_1: \\tau_1^2 > 0$。感兴趣的参数 $\\tau_1^2$ 是一个方差，不能为负。零假设将此参数置于参数空间 $[0, \\infty)$ 的边界上。\n\n1.  **似然比检验统计量**：似然比检验（LRT）统计量定义为 $D = -2(\\ell_0 - \\ell_1)$，其中 $\\ell_0$ 和 $\\ell_1$ 分别是零假设和备择假设下模型的对数似然。使用所提供的值：\n    $$\n    D = -2(-1450.3 - (-1448.2)) = -2(-2.1) = 4.2\n    $$\n\n2.  **正确的零分布**：标准的似然比理论（Wilks定理）指出，在某些正则性条件下，$H_0$下$D$的渐近分布是卡方分布 $\\chi^2_k$，其中$k$是两个嵌套模型之间自由参数数量的差异。在这里，与简化模型相比，完整模型多一个参数（$\\tau_1^2$）。Wilks定理的简单应用会建议使用 $\\chi^2_1$ 分布。\n\n    然而，Wilks定理的一个关键正则性条件是，$H_0$下的真实参数值必须位于参数空间的内部。在这种情况下，$\\tau_1^2 = 0$ 位于边界上。当在参数空间的边界上检验参数时，LRT统计量的渐近分布不再是简单的卡方分布。\n\n    对于检验单个方差分量（如此处的情况），LRT统计量的渐近零分布是卡方分布的混合（Self & Stram, 1987）。对于检验一个额外的随机效应方差，正确的分布是 $\\chi^2_0$ 分布和 $\\chi^2_1$ 分布的等权混合。\n    $$\n    D \\sim 0.5\\,\\chi^2_0 + 0.5\\,\\chi^2_1\n    $$\n    $\\chi^2_0$ 分布是在0处的点质量。混合分布的这一部分反映了在完整模型下 $\\tau_1^2$ 的最大似然估计值为0的非零概率（渐近为0.5），在这种情况下 $\\ell_1 = \\ell_0$ 且 $D=0$。\n\n3.  **REML的使用**：混合分布的理论是为最大似然（ML）估计推导的。然而，一个公认的结论是，LRT可以应用于通过REML拟合的模型，并且只要被比较的模型具有*完全相同的固定效应结构*，同样的渐近混合分布仍然成立。问题陈述明确确认了这一条件：“同时保持模型间的固定效应设计相同”。因此，使用所提供的REML对数似然是合适的。\n\n4.  **$p$值计算**：$p$值是在零假设为真的前提下，观察到与计算出的检验统计量一样极端或更极端的概率。对于观察到的统计量 $D = 4.2$ 和零分布 $0.5\\,\\chi^2_0 + 0.5\\,\\chi^2_1$：\n    $$\n    p = P(D \\ge 4.2) = 0.5 \\times P(\\chi^2_0 \\ge 4.2) + 0.5 \\times P(\\chi^2_1 \\ge 4.2)\n    $$\n    由于 $\\chi^2_0$ 是在0处的点质量，所以 $P(\\chi^2_0 \\ge 4.2) = 0$。表达式简化为：\n    $$\n    p = 0.5 \\times P(\\chi^2_1 \\ge 4.2)\n    $$\n    从标准统计表或软件中，对于统计量为4.2的 $\\chi^2_1$ 检验，单尾$p$值约为 $0.0404$。因此，混合分布的正确$p$值为：\n    $$\n    p \\approx 0.5 \\times 0.0404 = 0.0202\n    $$\n\n### 逐项分析\n\n**A. 使用限制性最大似然（REML）和相同的固定效应拟合两个模型；计算似然比统计量 $D = -2(\\ell_0 - \\ell_1)$；因为 $H_0$ 将一个方差分量置于边界上（$\\tau_1^2 = 0$），所以使用混合分布 $0.5\\,\\chi^2_{0} + 0.5\\,\\chi^2_{1}$ 作为 $D$ 的零分布；根据上述 $\\ell_0$ 和 $\\ell_1$，得到 $D = 4.2$，混合$p$值约为 $0.020$。**\n-   **分析**：此选项正确地指出，由于固定效应相同，可以使用REML。它正确地计算了检验统计量 $D = 4.2$。它正确地识别了边界问题，并指定了理论上正确的渐近零分布，即 $0.5\\,\\chi^2_{0} + 0.5\\,\\chi^2_{1}$ 的混合分布。最后，它正确地计算出结果的$p$值约为 $0.020$。\n-   **结论**：**正确**。\n\n**B. 使用最大似然（ML）拟合两个模型；计算 $D = -2(\\ell_0 - \\ell_1)$ 并与标准的 $\\chi^2_{1}$ 分布进行比较，因为差异在于一个协方差参数；当 $D=4.2$ 时，$p$值约为 $0.040$，且边界问题可忽略不计。**\n-   **分析**：这有几个错误的原因。问题陈述指出对数似然来自REML，而不是ML。最关键的是，它将边界问题视为“可忽略的”，并错误地使用了标准的 $\\chi^2_1$ 分布。边界条件是根本性的，忽略它会导致一个过于保守的检验（其$p$值是正确值的两倍）。\n-   **结论**：**错误**。\n\n**C. 保留REML拟合但避免似然比检验；而是对估计的随机斜率方差使用Satterthwaite t-近似来检验 $H_0:\\tau_1^2=0$；$D$ 的适当零分布仍然是标准的 $\\chi^2_{1}$。**\n-   **分析**：这个选项内部不一致且在事实上是错误的。Satterthwaite近似通常用于为固定效应或方差分量的线性组合构建检验或置信区间，而不是用于单个方差分量的简单LRT。它错误地断言LRT统计量$D$的零分布是标准的 $\\chi^2_1$，这与边界问题的正确理论相矛盾。\n-   **结论**：**错误**。\n\n**D. 使用REML拟合两个模型；计算 $D$ 并与标准的 $\\chi^2_{2}$ 分布进行比较，因为添加随机斜率既引入了一个方差分量，又在固定效应均值中增加了一个额外的斜率参数；当 $D=4.2$ 时，$p$值约为 $0.122$。**\n-   **分析**：这是错误的。问题明确指出模型间的固定效应设计是相同的。添加随机斜率 $b_{1i}$ 不会改变固定效应参数的数量。这些模型在随机效应协方差结构中仅相差一个参数（$\\tau_1^2$）。因此，使用 $\\chi^2_2$ 分布是错误的。\n-   **结论**：**错误**。\n\n**E. 使用REML拟合两个模型；计算 $D$ 并仅通过参数自举法评估显著性，因为混合 $\\chi^2$ 零分布无效；该边界问题的正确零分布是 $0.67\\,\\chi^2_{0} + 0.33\\,\\chi^2_{1}$，得出的 $p$值接近 $0.026$。**\n-   **分析**：这是错误的。虽然参数自举法是此检验的一种有效（且常被推荐）的方法，但声称渐近 $\\chi^2$ 混合分布“无效”是错误的。对于检验一个方差分量，$0.5\\,\\chi^2_{0} + 0.5\\,\\chi^2_{1}$ 的混合分布是理论上推导出的正确的渐近零分布。所提出的 $0.67$ 和 $0.33$ 的混合权重对于这个特定的检验场景是错误的。\n-   **结论**：**错误**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}