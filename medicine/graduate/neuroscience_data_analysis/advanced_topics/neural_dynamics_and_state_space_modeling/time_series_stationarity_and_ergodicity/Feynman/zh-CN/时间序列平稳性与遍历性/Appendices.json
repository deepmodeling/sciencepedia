{
    "hands_on_practices": [
        {
            "introduction": "在分析神经时间序列数据之前，一个关键的初始步骤是验证其平稳性假设。平稳性是许多标准分析技术（如谱分析和自相关）的基石。此练习将引导您深入了解一种广泛使用的平稳性检验——KPSS检验的理论基础，通过推导其检验统计量，您将能更好地理解如何从形式上判断一个时间序列是否是水平平稳的，而非依赖于“黑箱”软件 。",
            "id": "4200528",
            "problem": "您正在分析一段从静止状态下啮齿动物背侧海马体记录的单通道局部场电位的基线段。设离散时间序列为 $\\{y_t\\}_{t=1}^{T}$，采样频率为 $f_s$，并假设该序列具有如下分解\n$$\ny_t \\;=\\; \\mu \\;+\\; r_t \\;+\\; \\varepsilon_t,\n$$\n其中 $r_t = r_{t-1} + \\xi_t$，$\\{ \\xi_t \\}$ 为独立同分布的零均值新息，$\\{ \\varepsilon_t \\}$ 是一个零均值的弱平稳遍历过程，具有有限的长程方差。假设 $\\{ \\xi_t \\}$ 独立于 $\\{ \\varepsilon_t \\}$，且 $\\{ \\varepsilon_t \\}$ 的自协方差函数 $\\gamma_k = \\operatorname{Cov}(\\varepsilon_t,\\varepsilon_{t-k})$ 满足 $\\sum_{k=-\\infty}^{\\infty} |\\gamma_k|  \\infty$。\n\n您的任务是：\n1) 以上述分解为基础表示，形式化定义用于检验 $\\{y_t\\}$ 水平平稳性的 Kwiatkowski–Phillips–Schmidt–Shin (KPSS) 检验的原假设和备择假设。\n\n2) 从弱平稳性和长程方差的核心定义出发，基于仅含截距项的回归 $y_t = \\mu + u_t$ 的残差的部分和，推导用于水平平稳性的 KPSS 检验统计量。定义残差 $\\hat{\\varepsilon}_t = y_t - \\hat{\\mu}$，其中 $\\hat{\\mu}$ 是 $\\mu$ 的普通最小二乘 (OLS) 估计量，以及部分和 $S_t = \\sum_{i=1}^{t} \\hat{\\varepsilon}_i$。对长程方差使用一个异方差和自相关一致性 (HAC) 估计量，该估计量使用 Bartlett 核和带宽 $L$，即 $\\hat{\\sigma}^2 = \\hat{\\gamma}_0 + 2\\sum_{j=1}^{L}\\left(1 - \\frac{j}{L+1}\\right)\\hat{\\gamma}_j$，其中 $\\hat{\\gamma}_j = \\frac{1}{T}\\sum_{t=j+1}^{T} \\hat{\\varepsilon}_t \\hat{\\varepsilon}_{t-j}$。\n\n3) 提供 KPSS 检验统计量的最终闭式解析表达式，用 $T$、部分和 $S_t$ 以及 HAC 长程方差估计 $\\hat{\\sigma}^2$ 表示。无需进行数值计算。最终答案必须是单个解析表达式或单行解析表达式矩阵。最终答案中不应包含任何单位。",
            "solution": "该问题是有效的，因为它在科学上基于已建立的统计理论，是适定且客观的。所有组成部分，包括时间序列分解、残差和部分和的定义，以及长程方差估计量的结构，在非平稳时间序列分析中都是标准的。我们开始解答。\n\n该问题要求对时间序列 $\\{y_t\\}_{t=1}^{T}$ 的 Kwiatkowski–Phillips–Schmidt–Shin (KPSS) 检验作出分为三部分的回答。\n\n1) 原假设和备择假设的定义。\n\n为该时间序列提供的模型是\n$$\ny_t = \\mu + r_t + \\varepsilon_t\n$$\n其中 $\\{ \\varepsilon_t \\}$ 是一个零均值的弱平稳过程，而 $r_t$ 是一个随机游走，定义为 $r_t = r_{t-1} + \\xi_t$，其中 $\\{ \\xi_t \\}$ 是一个独立同分布的过程，其均值为 $E[\\xi_t]=0$，方差为 $\\operatorname{Var}(\\xi_t) = \\sigma_\\xi^2$。我们可以不失一般性地假设随机游走的初始值为 $r_0=0$，因为任何非零常数 $r_0$ 都可以被吸收到截距项 $\\mu$ 中。\n\n过程 $\\{y_t\\}$ 是水平平稳的，当且仅当随机游走分量 $r_t$ 不存在，即它随时间保持不变。由于 $r_t = r_{t-1} + \\xi_t$，要使 $r_t$ 为常数，每个新息 $\\xi_t$ 都必须为零。鉴于 $E[\\xi_t]=0$，这等价于新息的方差为零的条件，即 $\\sigma_\\xi^2 = 0$。如果 $\\sigma_\\xi^2  0$，$r_t$ 的方差，即 $\\operatorname{Var}(r_t) = t\\sigma_\\xi^2$，会随时间增长，从而引入一个随机趋势，使得 $\\{y_t\\}$ 非平稳。\n\n因此，用于水平平稳性的 KPSS 检验评估以下假设：\n原假设 $H_0$ 指出时间序列是水平平稳的。这对应于随机游走新息的方差为零。\n$$\nH_0: \\sigma_\\xi^2 = 0\n$$\n在 $H_0$ 下，模型简化为 $y_t = \\mu + \\varepsilon_t$，这描述了一个围绕恒定水平 $\\mu$ 波动的平稳过程。\n\n备择假设 $H_1$ 指出时间序列具有单位根（是差分平稳的），这意味着存在随机趋势。这对应于随机游走新息的方差为正。\n$$\nH_1: \\sigma_\\xi^2  0\n$$\n在 $H_1$ 下，随机游走分量 $r_t$ 存在，且 $\\{y_t\\}$ 是非平稳的。\n\n2) KPSS 检验统计量的推导。\n\nKPSS 检验是一种拉格朗日乘子 (LM) 检验，旨在检测随机游走分量的存在。该统计量是使用在原假设下对 $y_t$ 进行回归得到的残差构建的。对于水平平稳性，在 $H_0$ 下的回归模型是 $y_t = \\mu + u_t$。\n\n首先，我们通过普通最小二乘法 (OLS) 估计截距 $\\mu$。$\\mu$ 的 OLS 估计量是 $y_t$ 的样本均值：\n$$\n\\hat{\\mu} = \\frac{1}{T} \\sum_{t=1}^{T} y_t\n$$\n然后，残差被计算为与该样本均值的偏差：\n$$\n\\hat{\\varepsilon}_t = y_t - \\hat{\\mu}\n$$\n这些残差 $\\hat{\\varepsilon}_t$ 是未观测到的平稳分量 $\\varepsilon_t$（去均值后）的经验对应物。\n\n检验统计量的核心是建立在这些残差的部分和之上。部分和过程定义为：\n$$\nS_t = \\sum_{i=1}^{t} \\hat{\\varepsilon}_i\n$$\n在平稳性的原假设下，过程 $\\{\\varepsilon_t\\}$ 具有恒定的均值（假定为零），因此残差的部分和 $S_t$ 预期会围绕零波动。在备择假设下，单位根分量的存在会导致残差累积，使部分和过程 $S_t$ 发散，其行为类似于一个随机游走。该检验统计量旨在衡量此部分和过程的大小。\n\nKPSS 统计量基于部分和的平方和 $\\sum_{t=1}^{T} S_t^2$。为了获得具有良定义渐近分布的统计量，该和必须被适当地缩放。根据应用于弱相关过程的泛函中心极限定理，缩放后的部分和过程 $\\frac{1}{\\sqrt{T}\\sigma} S_{\\lfloor Tr \\rfloor}$（对于 $r \\in [0,1]$）依分布收敛于一个标准布朗桥 $V(r) = W(r) - rW(1)$，其中 $W(r)$ 是一个标准维纳过程。项 $\\sigma^2$ 是过程 $\\{\\varepsilon_t\\}$ 的长程方差，定义为：\n$$\n\\sigma^2 = \\lim_{T \\to \\infty} \\frac{1}{T} \\operatorname{Var}\\left(\\sum_{t=1}^{T} \\varepsilon_t\\right) = \\sum_{k=-\\infty}^{\\infty} \\gamma_k = \\gamma_0 + 2\\sum_{k=1}^{\\infty}\\gamma_k\n$$\n条件 $\\sum_{k=-\\infty}^{\\infty} |\\gamma_k|  \\infty$ 确保此极限是有限的。\n\n该检验统计量是作为平方布朗桥的积分 $\\int_0^1 V(r)^2 dr$ 的经验模拟构建的。和 $\\sum_{t=1}^{T} S_t^2$ 对应于该积分，适当的缩放因子是 $\\frac{1}{T^2}$。完整的统计量是：\n$$\n\\text{KPSS} = \\frac{1}{T^2\\sigma^2} \\sum_{t=1}^{T} S_t^2\n$$\n由于真实的长程方差 $\\sigma^2$ 是未知的，它必须用一个一致估计量 $\\hat{\\sigma}^2$ 替换。问题指定了一个使用 Bartlett 核和带宽 $L$ 的异方差和自相关一致性 (HAC) 估计量：\n$$\n\\hat{\\sigma}^2 = \\hat{\\gamma}_0 + 2\\sum_{j=1}^{L}\\left(1 - \\frac{j}{L+1}\\right)\\hat{\\gamma}_j\n$$\n其中 $\\hat{\\gamma}_j = \\frac{1}{T}\\sum_{t=j+1}^{T} \\hat{\\varepsilon}_t \\hat{\\varepsilon}_{t-j}$ 是滞后 j 阶的样本自协方差。\n\n将此估计量代入统计量的表达式中，便得到用于水平平稳性的 KPSS 检验统计量的最终可操作形式。\n\n3) KPSS 检验统计量的最终闭式解析表达式。\n\n结合以上推导的各部分，用于水平平稳性的 KPSS 检验统计量（通常表示为 $\\eta_{\\mu}$）由残差的部分和平方和，再除以样本量的平方与估计的长程方差的乘积给出。用给定的量 $T$、$S_t$ 和 $\\hat{\\sigma}^2$ 表示，该表达式为：\n$$\n\\eta_{\\mu} = \\frac{\\sum_{t=1}^{T} S_t^2}{T^2 \\hat{\\sigma}^2}\n$$\n此表达式构成最终答案。",
            "answer": "$$\n\\boxed{\\frac{\\sum_{t=1}^{T} S_t^2}{T^2 \\hat{\\sigma}^2}}\n$$"
        },
        {
            "introduction": "了解如何检验平稳性之后，我们必须理解非平稳性对分析结果的具体影响。本练习探讨了一种常见的非平稳性形式——确定性线性趋势——是如何影响我们对时间序列内部依赖结构的估计的。通过从第一性原理出发，推导样本自协方差估计量中由线性趋势引入的偏差，您将具体地看到违反平稳性假设如何系统性地扭曲分析结果，从而突显出去趋势化等预处理步骤的重要性 。",
            "id": "4200519",
            "problem": "一个研究小组正在分析在感觉皮层记录中获得的单次试验局部场电位（LFP）时间序列。该序列以均匀间隔采样，并索引为 $X_{1}, X_{2}, \\dots, X_{T}$。他们有兴趣使用在延迟 $\\tau$ 处的样本自协方差估计量来估计时间依赖结构，该估计量通过样本均值定义。令 $\\bar{X} = \\frac{1}{T} \\sum_{t=1}^{T} X_{t}$，并考虑延迟 $\\tau \\in \\{0, 1, \\dots, T-1\\}$。该估计量为\n$$\n\\hat{\\gamma}(\\tau) = \\frac{1}{T} \\sum_{t=1}^{T-\\tau} \\left( X_{t} - \\bar{X} \\right) \\left( X_{t+\\tau} - \\bar{X} \\right).\n$$\nA 部分（平稳性）：假设数据由一个宽平稳（WSS）过程 $\\{Y_{t}\\}$ 生成，其均值为 $0$，自协方差函数为 $\\gamma_{Y}(\\tau) = \\mathbb{E}[Y_{t} Y_{t+\\tau}]$，并且该过程在均值和自协方差上是遍历的。请用 $T$、$\\tau$ 和 $\\gamma_{Y}(\\cdot)$ 表示 $\\mathbb{E}\\left[\\hat{\\gamma}(\\tau)\\right]$，并证明在 WSS 条件下，$\\hat{\\gamma}(\\tau)$ 相对于 $\\gamma_{Y}(\\tau)$ 的有限样本偏差。使用第一性原理和遍历性的定义，解释为什么当 $T \\to \\infty$ 时，该估计量是一致的。\n\nB 部分（线性趋势违例）：现在假设 LFP 受到一个确定性线性趋势和偏移量的污染，\n$$\nX_{t} = \\mu + \\beta t + Y_{t},\n$$\n其中 $\\mu \\in \\mathbb{R}$ 和 $\\beta \\in \\mathbb{R}$ 是固定的，$\\{Y_{t}\\}$ 是与之前相同的均值为 $0$、自协方差为 $\\gamma_{Y}(\\tau)$ 的 WSS 过程。请从第一性原理推导 $\\mathbb{E}\\left[\\hat{\\gamma}(\\tau)\\right]$ 中纯粹由线性趋势（即，在样本均值中心化后，由 $\\mu + \\beta t$ 贡献的 $\\mathbb{E}\\left[\\hat{\\gamma}(\\tau)\\right]$ 的分量）引起的加性偏差的精确闭式表达式。将由趋势引起的偏差定义为\n$$\n\\mathrm{Bias}_{\\mathrm{trend}}(\\tau) = \\mathbb{E}\\left[\\hat{\\gamma}(\\tau)\\right] - \\mathbb{E}_{Y}\\left[\\hat{\\gamma}_{Y}(\\tau)\\right],\n$$\n其中 $\\hat{\\gamma}_{Y}(\\tau)$ 表示单独应用于平稳分量 $Y_{t}$ 的相同估计量。请以 $\\beta$、$T$ 和 $\\tau$ 的单一闭式解析表达式形式提供您的最终答案。不需要数值近似。",
            "solution": "该问题陈述已经过验证，被认为是时间序列分析领域中一个提法恰当、有科学依据的问题。它包含充足的信息且内部一致。\n\n该问题分为两部分。A 部分讨论了宽平稳（WSS）过程的样本自协方差估计量的性质。B 部分研究了确定性线性趋势（一种常见的对平稳性的违背）对该估计量引入的偏差。\n\n### A 部分：平稳性、偏差和一致性\n\n在这部分中，时间序列为 $X_{t} = Y_{t}$，其中 $\\{Y_{t}\\}$ 是一个 WSS 过程，其 $\\mathbb{E}[Y_{t}] = 0$，自协方差函数为 $\\gamma_{Y}(\\tau) = \\mathbb{E}[Y_{t}Y_{t+\\tau}]$。样本自协方差估计量由 $\\hat{\\gamma}(\\tau) = \\frac{1}{T} \\sum_{t=1}^{T-\\tau} (X_{t} - \\bar{X})(X_{t+\\tau} - \\bar{X})$ 给出。由于 $X_{t}=Y_{t}$，我们可以将其写作 $\\hat{\\gamma}_{Y}(\\tau) = \\frac{1}{T} \\sum_{t=1}^{T-\\tau} (Y_{t} - \\bar{Y})(Y_{t+\\tau} - \\bar{Y})$，其中 $\\bar{Y} = \\frac{1}{T}\\sum_{t=1}^{T} Y_{t}$。\n\n**1. 估计量的期望**\n\n为了求期望值，我们展开各项并利用期望算子的线性性。\n$$ \\mathbb{E}\\left[\\hat{\\gamma}_{Y}(\\tau)\\right] = \\frac{1}{T} \\sum_{t=1}^{T-\\tau} \\mathbb{E}\\left[ (Y_{t} - \\bar{Y})(Y_{t+\\tau} - \\bar{Y}) \\right] $$\n$$ \\mathbb{E}\\left[\\hat{\\gamma}_{Y}(\\tau)\\right] = \\frac{1}{T} \\sum_{t=1}^{T-\\tau} \\mathbb{E}\\left[ Y_{t}Y_{t+\\tau} - Y_{t}\\bar{Y} - Y_{t+\\tau}\\bar{Y} + \\bar{Y}^2 \\right] $$\n$$ \\mathbb{E}\\left[\\hat{\\gamma}_{Y}(\\tau)\\right] = \\frac{1}{T} \\sum_{t=1}^{T-\\tau} \\left( \\mathbb{E}[Y_{t}Y_{t+\\tau}] - \\mathbb{E}[Y_{t}\\bar{Y}] - \\mathbb{E}[Y_{t+\\tau}\\bar{Y}] + \\mathbb{E}[\\bar{Y}^2] \\right) $$\n让我们评估每个期望项：\n- $\\mathbb{E}[Y_{t}Y_{t+\\tau}] = \\gamma_{Y}(\\tau)$ 根据定义，因为过程是宽平稳的。\n- $\\mathbb{E}[Y_{t}\\bar{Y}] = \\mathbb{E}\\left[Y_{t} \\frac{1}{T}\\sum_{s=1}^{T}Y_{s}\\right] = \\frac{1}{T}\\sum_{s=1}^{T}\\mathbb{E}[Y_{t}Y_{s}] = \\frac{1}{T}\\sum_{s=1}^{T}\\gamma_{Y}(t-s)$。\n- 类似地，$\\mathbb{E}[Y_{t+\\tau}\\bar{Y}] = \\frac{1}{T}\\sum_{s=1}^{T}\\gamma_{Y}(t+\\tau-s)$。\n- $\\mathbb{E}[\\bar{Y}^2] = \\mathrm{Var}(\\bar{Y}) + (\\mathbb{E}[\\bar{Y}])^2$。由于 $\\mathbb{E}[Y_{t}]=0$，我们有 $\\mathbb{E}[\\bar{Y}] = \\frac{1}{T}\\sum_{t=1}^{T}\\mathbb{E}[Y_t] = 0$。因此，$\\mathbb{E}[\\bar{Y}^2] = \\mathrm{Var}(\\bar{Y})$。\n$$ \\mathrm{Var}(\\bar{Y}) = \\mathrm{Var}\\left(\\frac{1}{T}\\sum_{t=1}^{T}Y_{t}\\right) = \\frac{1}{T^2} \\sum_{t=1}^{T}\\sum_{s=1}^{T} \\mathrm{Cov}(Y_{t},Y_{s}) = \\frac{1}{T^2}\\sum_{t=1}^{T}\\sum_{s=1}^{T}\\gamma_{Y}(t-s) $$\n综合这些结果，估计量的期望为：\n$$ \\mathbb{E}\\left[\\hat{\\gamma}_{Y}(\\tau)\\right] = \\frac{1}{T} \\sum_{t=1}^{T-\\tau} \\left( \\gamma_{Y}(\\tau) - \\frac{1}{T}\\sum_{s=1}^{T}\\gamma_{Y}(t-s) - \\frac{1}{T}\\sum_{s=1}^{T}\\gamma_{Y}(t+\\tau-s) + \\frac{1}{T^2}\\sum_{u=1}^{T}\\sum_{v=1}^{T}\\gamma_{Y}(u-v) \\right) $$\n对 $t$ 从 $1$ 到 $T-\\tau$ 求和可得：\n$$ \\mathbb{E}\\left[\\hat{\\gamma}_{Y}(\\tau)\\right] = \\frac{T-\\tau}{T}\\gamma_{Y}(\\tau) - \\frac{1}{T^2}\\sum_{t=1}^{T-\\tau}\\sum_{s=1}^{T}\\left(\\gamma_{Y}(t-s)+\\gamma_{Y}(t+\\tau-s)\\right) + \\frac{T-\\tau}{T^3}\\sum_{u=1}^{T}\\sum_{v=1}^{T}\\gamma_{Y}(u-v) $$\n这就是用 $T$、$\\tau$ 和 $\\gamma_{Y}(\\cdot)$ 表示的 $\\mathbb{E}[\\hat{\\gamma}_{Y}(\\tau)]$ 的表达式。\n\n**2. 有限样本偏差**\n估计量的偏差为 $\\mathrm{Bias}[\\hat{\\gamma}_{Y}(\\tau)] = \\mathbb{E}[\\hat{\\gamma}_{Y}(\\tau)] - \\gamma_{Y}(\\tau)$。\n从上面的表达式可以看出，对于有限的 $T$，偏差主要有两个来源：\na) 首项是 $\\frac{T-\\tau}{T}\\gamma_{Y}(\\tau) = (1-\\frac{\\tau}{T})\\gamma_{Y}(\\tau)$，它不同于 $\\gamma_{Y}(\\tau)$。这部分是由于除数是 $1/T$ 而不是更自然的选择如 $1/(T-\\tau)$。这部分偏差为 $-\\frac{\\tau}{T}\\gamma_{Y}(\\tau)$。\nb) 其余项是由于使用了样本均值 $\\bar{Y}$ 而不是真实均值 $\\mathbb{E}[Y_t]=0$ 引起的。减去 $\\bar{Y}$ 会在总和的所有项之间引入依赖关系，因为每个 $(Y_t - \\bar{Y})$ 项都是整个样本的函数。涉及自协方差函数求和的附加项捕捉了这些复杂的依赖关系。对于大的 $T$，假设自协方差函数衰减得足够快（即 $\\sum_{k=-\\infty}^{\\infty}|\\gamma_{Y}(k)|  \\infty$），这些项的阶数为 $O(1/T)$。因此，对于任何有限的样本量 $T$，$\\hat{\\gamma}_{Y}(\\tau)$ 都是 $\\gamma_{Y}(\\tau)$ 的一个有偏估计量。\n\n**3. 一致性**\n如果一个估计量在样本量趋于无穷大时依概率收敛于真实值，则该估计量是一致的。我们需要证明当 $T \\to \\infty$ 时，$\\hat{\\gamma}_{Y}(\\tau) \\xrightarrow{p} \\gamma_{Y}(\\tau)$。这可以通过证明其偏差和方差都趋于零来建立。\n\n首先，考虑当 $T \\to \\infty$ 时的偏差。期望中的首项 $(1-\\frac{\\tau}{T})\\gamma_{Y}(\\tau)$ 收敛于 $\\gamma_{Y}(\\tau)$。所有其他项都至少按 $1/T$ 的因子缩放。对于一个均值遍历的过程，$\\lim_{T\\to\\infty} T \\cdot \\mathrm{Var}(\\bar{Y})$ 是有限的，这意味着 $\\mathrm{Var}(\\bar{Y})$ 是 $O(1/T)$。其他求和项在归一化后也会消失。因此，$\\lim_{T\\to\\infty} \\mathbb{E}[\\hat{\\gamma}_{Y}(\\tau)] = \\gamma_{Y}(\\tau)$，这意味着该估计量是渐近无偏的。\n\n其次，我们依赖于给定的遍历性。遍历性意味着过程的时间平均收敛到其对应的系综平均。\n我们可以将估计量写作：\n$$ \\hat{\\gamma}_{Y}(\\tau) = \\frac{1}{T}\\sum_{t=1}^{T-\\tau}Y_{t}Y_{t+\\tau} - \\frac{\\bar{Y}}{T}\\sum_{t=1}^{T-\\tau}Y_{t} - \\frac{\\bar{Y}}{T}\\sum_{t=1}^{T-\\tau}Y_{t+\\tau} + \\frac{T-\\tau}{T}\\bar{Y}^2 $$\n当 $T\\to\\infty$ 时：\n- 过程在均值上是遍历的，意味着样本均值收敛于系综均值：$\\bar{Y} \\xrightarrow{p} \\mathbb{E}[Y_{t}]=0$。\n- 过程在自协方差上是遍历的，意味着乘积的时间平均收敛到其系综平均。具体来说，对于平稳过程 $Z_{t} = Y_{t}Y_{t+\\tau}$，其时间平均收敛到其期望：\n$$ \\frac{1}{T-\\tau}\\sum_{t=1}^{T-\\tau}Y_{t}Y_{t+\\tau} \\xrightarrow{p} \\mathbb{E}[Y_{t}Y_{t+\\tau}] = \\gamma_{Y}(\\tau) $$\n考虑 $\\hat{\\gamma}_{Y}(\\tau)$ 的第一项：$\\frac{1}{T}\\sum_{t=1}^{T-\\tau}Y_{t}Y_{t+\\tau} = \\frac{T-\\tau}{T} \\left( \\frac{1}{T-\\tau}\\sum_{t=1}^{T-\\tau}Y_{t}Y_{t+\\tau} \\right)$。由于 $\\frac{T-\\tau}{T} \\to 1$ 且括号中的项收敛于 $\\gamma_{Y}(\\tau)$，整个项依概率收敛于 $\\gamma_{Y}(\\tau)$。\n- 所有其他项都涉及 $\\bar{Y}$ 或 $\\bar{Y}^2$。由于 $\\bar{Y} \\xrightarrow{p} 0$，并且其他和项在概率上有界，根据 Slutsky 定理，所有后续项都收敛到 $0$。\n因此，当 $T\\to\\infty$ 时，$\\hat{\\gamma}_{Y}(\\tau) \\xrightarrow{p} \\gamma_{Y}(\\tau)$，这就在遍历性假设下建立起了估计量的一致性。\n\n### B 部分：由线性趋势引起的偏差\n\n现在，$X_{t} = \\mu + \\beta t + Y_{t}$。我们想要找到加性偏差 $\\mathrm{Bias}_{\\mathrm{trend}}(\\tau) = \\mathbb{E}\\left[\\hat{\\gamma}(\\tau)\\right] - \\mathbb{E}_{Y}\\left[\\hat{\\gamma}_{Y}(\\tau)\\right]$。\n\n首先，我们计算样本均值 $\\bar{X}$：\n$$ \\bar{X} = \\frac{1}{T} \\sum_{t=1}^{T} (\\mu + \\beta t + Y_t) = \\mu + \\beta \\left(\\frac{1}{T} \\sum_{t=1}^{T} t \\right) + \\frac{1}{T}\\sum_{t=1}^{T} Y_t $$\n使用前 $T$ 个整数的和的公式 $\\sum_{t=1}^{T} t = \\frac{T(T+1)}{2}$，我们得到：\n$$ \\bar{X} = \\mu + \\beta \\frac{T+1}{2} + \\bar{Y} $$\n接下来，我们求中心化项 $X_t - \\bar{X}$：\n$$ X_t - \\bar{X} = (\\mu + \\beta t + Y_t) - \\left( \\mu + \\beta \\frac{T+1}{2} + \\bar{Y} \\right) = \\beta\\left(t - \\frac{T+1}{2}\\right) + (Y_t - \\bar{Y}) $$\n令 $d_t = \\beta(t - \\frac{T+1}{2})$ 为确定性分量。则 $X_t - \\bar{X} = d_t + (Y_t - \\bar{Y})$。\n\n现在我们将此代入估计量 $\\hat{\\gamma}(\\tau)$：\n$$ \\hat{\\gamma}(\\tau) = \\frac{1}{T} \\sum_{t=1}^{T-\\tau} (X_t - \\bar{X})(X_{t+\\tau} - \\bar{X}) $$\n$$ \\hat{\\gamma}(\\tau) = \\frac{1}{T} \\sum_{t=1}^{T-\\tau} [d_t + (Y_t - \\bar{Y})] [d_{t+\\tau} + (Y_{t+\\tau} - \\bar{Y})] $$\n展开乘积：\n$$ \\hat{\\gamma}(\\tau) = \\frac{1}{T} \\sum_{t=1}^{T-\\tau} d_t d_{t+\\tau} + \\frac{1}{T} \\sum_{t=1}^{T-\\tau} d_t (Y_{t+\\tau} - \\bar{Y}) + \\frac{1}{T} \\sum_{t=1}^{T-\\tau} d_{t+\\tau} (Y_t - \\bar{Y}) + \\frac{1}{T} \\sum_{t=1}^{T-\\tau} (Y_t - \\bar{Y})(Y_{t+\\tau} - \\bar{Y}) $$\n最后一项恰好是 $\\hat{\\gamma}_{Y}(\\tau)$。让我们对 $Y_t$ 中的随机性取期望：\n$$ \\mathbb{E}\\left[\\hat{\\gamma}(\\tau)\\right] = \\mathbb{E}\\left[ \\frac{1}{T}\\sum d_t d_{t+\\tau} \\right] + \\mathbb{E}\\left[ \\frac{1}{T}\\sum d_t (Y_{t+\\tau} - \\bar{Y}) \\right] + \\mathbb{E}\\left[ \\frac{1}{T}\\sum d_{t+\\tau} (Y_t - \\bar{Y}) \\right] + \\mathbb{E}\\left[\\hat{\\gamma}_{Y}(\\tau)\\right] $$\n项 $d_t$ 是确定性的。交叉项的期望为零，因为 $\\mathbb{E}[Y_t - \\bar{Y}] = \\mathbb{E}[Y_t] - \\mathbb{E}[\\bar{Y}] = 0 - 0 = 0$。\n$$ \\mathbb{E}\\left[ \\frac{1}{T}\\sum d_t (Y_{t+\\tau} - \\bar{Y}) \\right] = \\frac{1}{T}\\sum d_t \\mathbb{E}[Y_{t+\\tau} - \\bar{Y}] = 0 $$\n因此，我们有：\n$$ \\mathbb{E}\\left[\\hat{\\gamma}(\\tau)\\right] = \\frac{1}{T} \\sum_{t=1}^{T-\\tau} d_t d_{t+\\tau} + \\mathbb{E}\\left[\\hat{\\gamma}_{Y}(\\tau)\\right] $$\n因此，由趋势引起的加性偏差纯粹是确定性的：\n$$ \\mathrm{Bias}_{\\mathrm{trend}}(\\tau) = \\mathbb{E}\\left[\\hat{\\gamma}(\\tau)\\right] - \\mathbb{E}\\left[\\hat{\\gamma}_{Y}(\\tau)\\right] = \\frac{1}{T} \\sum_{t=1}^{T-\\tau} d_t d_{t+\\tau} $$\n代入 $d_t$ 的表达式：\n$$ \\mathrm{Bias}_{\\mathrm{trend}}(\\tau) = \\frac{\\beta^2}{T} \\sum_{t=1}^{T-\\tau} \\left(t - \\frac{T+1}{2}\\right) \\left(t+\\tau - \\frac{T+1}{2}\\right) $$\n令 $K = \\frac{T+1}{2}$ 和 $N = T-\\tau$。求和变为：\n$$ S = \\sum_{t=1}^{N} (t - K)(t+\\tau-K) = \\sum_{t=1}^{N} [t^2 + (\\tau-2K)t + (K^2 - \\tau K)] $$\n$$ S = \\sum_{t=1}^{N} t^2 + (\\tau-2K)\\sum_{t=1}^{N} t + N(K^2 - \\tau K) $$\n使用标准求和公式 $\\sum_{t=1}^{N} t = \\frac{N(N+1)}{2}$ 和 $\\sum_{t=1}^{N} t^2 = \\frac{N(N+1)(2N+1)}{6}$：\n代入 $K=\\frac{T+1}{2}$ 和 $N=T-\\tau$，我们有 $\\tau-2K = \\tau-(T+1) = -(T-\\tau+1)=-(N+1)$。\n$$ S = \\frac{N(N+1)(2N+1)}{6} - (N+1)\\frac{N(N+1)}{2} + N(K^2 - \\tau K) $$\n前两项化简为：\n$$ \\frac{N(N+1)}{6} [ (2N+1) - 3(N+1) ] = \\frac{N(N+1)}{6}[-N-2] = -\\frac{N(N+1)(N+2)}{6} $$\n最后一项是 $N(K^2 - \\tau K) = N K(K-\\tau) = N \\frac{T+1}{2}(\\frac{T+1}{2}-\\tau) = N \\frac{(T+1)(T+1-2\\tau)}{4}$。\n代入 $T=N+\\tau$：$T+1=N+\\tau+1$ 和 $T+1-2\\tau = N-\\tau+1$。\n$N(K^2 - \\tau K) = N \\frac{(N+\\tau+1)(N-\\tau+1)}{4} = N \\frac{(N+1)^2-\\tau^2}{4}$。\n所以，$S = -\\frac{N(N+1)(N+2)}{6} + \\frac{N((N+1)^2-\\tau^2)}{4}$。\n通分到分母 12 上进行合并：\n$$ S = \\frac{N}{12} [-2(N+1)(N+2) + 3((N+1)^2 - \\tau^2)] $$\n$$ S = \\frac{N}{12} [-2(N^2+3N+2) + 3(N^2+2N+1-\\tau^2)] $$\n$$ S = \\frac{N}{12} [-2N^2 - 6N - 4 + 3N^2 + 6N + 3 - 3\\tau^2] = \\frac{N}{12} [N^2 - 1 - 3\\tau^2] $$\n将 $N=T-\\tau$ 代回：\n$$ S = \\frac{T-\\tau}{12} [(T-\\tau)^2 - 1 - 3\\tau^2] = \\frac{T-\\tau}{12} [T^2 - 2T\\tau + \\tau^2 - 1 - 3\\tau^2] $$\n$$ S = \\frac{T-\\tau}{12} [T^2 - 2T\\tau - 2\\tau^2 - 1] $$\n偏差是 $\\frac{\\beta^2}{T}S$：\n$$ \\mathrm{Bias}_{\\mathrm{trend}}(\\tau) = \\frac{\\beta^2(T-\\tau)}{12T} (T^2 - 2T\\tau - 2\\tau^2 - 1) $$\n展开此表达式可得：\n$$ \\mathrm{Bias}_{\\mathrm{trend}}(\\tau) = \\frac{\\beta^2}{12T} (T(T^2 - 2T\\tau - 2\\tau^2 - 1) - \\tau(T^2 - 2T\\tau - 2\\tau^2 - 1)) $$\n$$ = \\frac{\\beta^2}{12T} (T^3 - 2T^2\\tau - 2T\\tau^2 - T - \\tau T^2 + 2T\\tau^2 + 2\\tau^3 + \\tau) $$\n$$ = \\frac{\\beta^2}{12T} (T^3 - 3T^2\\tau + 2\\tau^3 - T + \\tau) $$\n这就是由线性趋势引起的加性偏差的最终闭式表达式。",
            "answer": "$$\n\\boxed{\\frac{\\beta^2}{12T} \\left( T^{3} - 3T^{2}\\tau + 2\\tau^{3} - T + \\tau \\right)}\n$$"
        },
        {
            "introduction": "神经科学数据的分析流程通常包含多个预处理步骤，这些操作会改变数据的统计特性。本练习将理论与实践相结合，探讨了一种在脑电图（EEG）分析中常用的技术——公共平均参考（CAR）——如何影响多通道时间序列的平稳性和协方差结构。您将证明像CAR这样的线性时不变变换会保持宽义平稳性，并推导变换后数据的协方差矩阵，从而掌握在实际数据处理中如何追踪和理解数据统计特性的变化 。",
            "id": "4200531",
            "problem": "脑电图 (EEG) 多通道时间序列分析通常采用重参考来减少伪影和共模信号。考虑一个 $m$ 通道脑电信号，建模为一个零均值的联合宽平稳随机过程 $x(t) \\in \\mathbb{R}^{m}$，其中 $t$ 索引离散时间。宽平稳性由恒定的均值和仅取决于时间延迟的自协方差函数定义。脑电图 (EEG) 重参考是在每个时间点上跨通道应用的线性操作。公共平均参考 (CAR) 从每个通道中减去所有通道的平均值，其分量形式定义为\n$$\ny_{i}(t) = x_{i}(t) - \\frac{1}{m} \\sum_{j=1}^{m} x_{j}(t), \\quad i = 1, \\dots, m.\n$$\n令 $1 \\in \\mathbb{R}^{m}$ 表示全1向量，$I_{m} \\in \\mathbb{R}^{m \\times m}$ 表示单位矩阵。假设 $x(t)$ 的零延迟协方差矩阵为\n$$\n\\Sigma_{x} = \\sigma^{2} I_{m} + \\beta \\, 1 1^{\\top},\n$$\n其中 $\\sigma^{2}  0$ 且 $\\beta \\in \\mathbb{R}$，表示独立的通道波动加上一个全局共模分量。假设 $x(t)$ 是二阶遍历的（时间平均收敛于自协方差的系综平均）。\n\n任务：\n1. 从宽平稳性和二阶遍历性的定义，以及线性时不变变换的性质出发，理论上解释重参考在何种情况下保持平稳性和遍历性，以及在何种情况下会引入非平稳性。您的解释应仅依赖于核心定义和关于随机过程线性变换的经过充分检验的事实。\n2. 使用上面定义的 CAR 操作，从第一性原理推导重参考后过程 $y(t)$ 的零延迟协方差矩阵的闭式表达式，用 $m$、$\\sigma^{2}$ 和 $1$ 表示。将零延迟协方差矩阵的最终结果以单个解析表达式的形式给出。不需要数值舍入，也不涉及物理单位。\n\n您的最终答案必须是 $y(t)$ 的零延迟协方差矩阵的单个解析表达式。",
            "solution": "该问题提出了两个任务：首先，理论上解释重参考如何影响时间序列的平稳性和遍历性；其次，推导应用公共平均参考 (CAR) 变换后信号的零延迟协方差矩阵。本解答将依次处理这两个任务。\n\n首先，我们分析一个通用的线性时不变 (LTI) 变换对一个宽平稳 (WSS) 且遍历的随机过程的影响。CAR 操作是这种变换的一个特定实例。\n\n设 $x(t)$ 是一个 $m$ 维向量随机过程。一个线性变换通过矩阵 $L \\in \\mathbb{R}^{m \\times m}$ 将 $x(t)$ 映射到另一个过程 $y(t)$，即 $y(t) = L x(t)$。如果矩阵 $L$ 不依赖于时间 $t$，则该变换是时不变的。\n\n如果一个过程 $x(t)$ 的均值向量是恒定的，并且其自协方差矩阵仅取决于时间延迟 $\\tau = t_1 - t_2$，则该过程是宽平稳的 (WSS)。\n1. $x(t)$ 的均值为 $E[x(t)] = \\mu_x$，是一个常数向量。\n2. $x(t)$ 的自协方差为 $R_x(t_1, t_2) = E[(x(t_1) - \\mu_x)(x(t_2) - \\mu_x)^{\\top}] = R_x(t_1 - t_2)$。\n\n让我们来检查输出过程 $y(t) = L x(t)$ 的性质。\n$y(t)$ 的均值为：\n$$E[y(t)] = E[L x(t)] = L E[x(t)] = L \\mu_x$$\n由于 $L$ 和 $\\mu_x$ 是常数，因此得到的均值向量 $\\mu_y = L \\mu_x$ 也是常数。\n\n$y(t)$ 的自协方差为：\n$$R_y(t_1, t_2) = E[(y(t_1) - \\mu_y)(y(t_2) - \\mu_y)^{\\top}]$$\n代入 $y(t) = L x(t)$ 和 $\\mu_y = L \\mu_x$：\n$$R_y(t_1, t_2) = E[(L x(t_1) - L \\mu_x)(L x(t_2) - L \\mu_x)^{\\top}]$$\n$$R_y(t_1, t_2) = E[L(x(t_1) - \\mu_x)(x(t_2) - \\mu_x)^{\\top}L^{\\top}]$$\n根据期望算子的线性性质：\n$$R_y(t_1, t_2) = L E[(x(t_1) - \\mu_x)(x(t_2) - \\mu_x)^{\\top}] L^{\\top} = L R_x(t_1, t_2) L^{\\top}$$\n由于 $x(t)$ 是宽平稳的，所以 $R_x(t_1, t_2) = R_x(t_1 - t_2)$。因此：\n$$R_y(t_1, t_2) = L R_x(t_1 - t_2) L^{\\top}$$\n右侧仅取决于时间延迟 $\\tau = t_1 - t_2$。我们定义 $R_y(\\tau) = L R_x(\\tau) L^{\\top}$。因此，$y(t)$ 的自协方差也仅取决于时间延迟。由于 $y(t)$ 具有恒定的均值和仅是时间延迟函数的自协方差函数，所以 $y(t)$ 也是宽平稳的。\n这证明了任何 LTI 变换都保持宽平稳性。只有当线性变换是时变的，即 $y(t) = L(t) x(t)$ 时，才可能引入非平稳性，而 CAR 并非这种情况。\n\n二阶遍历性意味着二阶矩（如自协方差）的时间平均会收敛到它们各自的系综平均。对于一个宽平稳过程，这意味着当观测区间趋于无穷时，时间平均的自协方差估计量 $\\hat{R}_x(\\tau)$ 收敛到真实的自协方差 $R_x(\\tau)$。\n$y(t)$ 的时间平均自协方差是 $\\hat{R}_y(\\tau)$。因为 $y(t)$ 是 $x(t)$ 经过 LTI 滤波后的版本，其时间平均统计量通过相同的变换与 $x(t)$ 的统计量相关：\n$$\\hat{R}_y(\\tau) = L \\hat{R}_x(\\tau) L^{\\top}$$\n在观测区间趋于无穷时取极限，并利用 $x(t)$ 的遍历性：\n$$\\lim \\hat{R}_y(\\tau) = \\lim (L \\hat{R}_x(\\tau) L^{\\top}) = L (\\lim \\hat{R}_x(\\tau)) L^{\\top} = L R_x(\\tau) L^{\\top}$$\n我们已经证明了 $R_y(\\tau) = L R_x(\\tau) L^{\\top}$。因此，$\\lim \\hat{R}_y(\\tau) = R_y(\\tau)$，这意味着过程 $y(t)$ 也是二阶遍历的。LTI 变换保持了宽平稳过程的遍历性。\n\n现在，我们进行第二个任务：推导重参考后过程 $y(t)$ 的零延迟协方差矩阵。\nCAR 操作由下式给出：\n$$y_{i}(t) = x_{i}(t) - \\frac{1}{m} \\sum_{j=1}^{m} x_{j}(t)$$\n让我们用向量形式表示。跨通道的平均值是 $\\frac{1}{m} \\sum_{j=1}^{m} x_{j}(t) = \\frac{1}{m} 1^{\\top}x(t)$。从 $x(t)$ 的每个分量中减去这个标量，等价于减去向量 $1 \\left( \\frac{1}{m} 1^{\\top}x(t) \\right)$。\n所以，向量过程 $y(t)$ 是：\n$$y(t) = x(t) - 1 \\left( \\frac{1}{m} 1^{\\top}x(t) \\right) = x(t) - \\left(\\frac{1}{m} 1 1^{\\top}\\right)x(t)$$\n这可以写成 $y(t) = P x(t)$，其中 $P$ 是变换矩阵：\n$$P = I_m - \\frac{1}{m} 1 1^{\\top}$$\n这个矩阵 $P$ 被称为中心化矩阵。它是一个投影矩阵，这意味着它是幂等的 ($P^2=P$) 和对称的 ($P^{\\top}=P$)。\n\n问题陈述了 $x(t)$ 是一个零均值过程。因此，输出过程 $y(t)$ 也是零均值的：\n$$E[y(t)] = E[P x(t)] = P E[x(t)] = P \\cdot 0 = 0$$\n$y(t)$ 的零延迟协方差矩阵，记为 $\\Sigma_y$，由下式给出：\n$$\\Sigma_y = E[y(t) y(t)^{\\top}] = E[(P x(t))(P x(t))^{\\top}] = E[P x(t) x(t)^{\\top} P^{\\top}]$$\n由于 $P$ 是一个常数矩阵：\n$$\\Sigma_y = P E[x(t) x(t)^{\\top}] P^{\\top}$$\n项 $E[x(t) x(t)^{\\top}]$ 是 $x(t)$ 的零延迟协方差矩阵，即给定的 $\\Sigma_x$。矩阵 $P$ 是对称的，所以 $P^{\\top} = P$。\n$$\\Sigma_y = P \\Sigma_x P$$\n我们已知 $\\Sigma_x = \\sigma^{2} I_{m} + \\beta \\, 1 1^{\\top}$。让我们将其代入 $\\Sigma_y$ 的表达式中：\n$$\\Sigma_y = P (\\sigma^{2} I_{m} + \\beta \\, 1 1^{\\top}) P$$\n让我们首先计算乘积 $P \\Sigma_x$：\n$$P \\Sigma_x = \\left(I_m - \\frac{1}{m} 1 1^{\\top}\\right)(\\sigma^{2} I_{m} + \\beta \\, 1 1^{\\top})$$\n$$P \\Sigma_x = \\sigma^{2} I_{m} \\left(I_m - \\frac{1}{m} 1 1^{\\top}\\right) + \\beta \\left(I_m - \\frac{1}{m} 1 1^{\\top}\\right) (1 1^{\\top})$$\n$$P \\Sigma_x = \\sigma^{2} P + \\beta (1 1^{\\top} - \\frac{1}{m} (1 1^{\\top})(1 1^{\\top}))$$\n项 $(1 1^{\\top})(1 1^{\\top}) = 1 (1^{\\top}1) 1^{\\top} = 1(m)1^{\\top} = m(1 1^{\\top})$。\n$$P \\Sigma_x = \\sigma^{2} P + \\beta \\left(1 1^{\\top} - \\frac{1}{m} m(1 1^{\\top})\\right) = \\sigma^{2} P + \\beta (1 1^{\\top} - 1 1^{\\top}) = \\sigma^{2} P + 0 = \\sigma^{2} P$$\n这是一个显著的简化。CAR 算子消除了协方差结构中的共模分量。现在，我们将其代回 $\\Sigma_y$ 的表达式中：\n$$\\Sigma_y = (P \\Sigma_x) P = (\\sigma^2 P) P = \\sigma^2 P^2$$\n由于 $P$ 是一个投影矩阵，$P^2 = P$。因此：\n$$\\Sigma_y = \\sigma^2 P$$\n代入 $P$ 的定义，得到重参考后过程 $y(t)$ 的零延迟协方差矩阵的最终表达式：\n$$\\Sigma_y = \\sigma^2 \\left(I_m - \\frac{1}{m} 1 1^{\\top}\\right)$$\n这个结果表明，CAR 变换完全移除了协方差的全局共模分量（由 $\\beta$ 参数化），并通过投影矩阵 $P$ 缩放了独立方差分量 $\\sigma^2$。得到的协方差矩阵是奇异的，因为它的行和列求和为零，这反映了由 CAR 操作引入的线性相关性 $\\sum_{i=1}^m y_i(t) = 0$。",
            "answer": "$$\\boxed{\\sigma^{2}\\left(I_{m} - \\frac{1}{m} 1 1^{\\top}\\right)}$$"
        }
    ]
}