{
    "hands_on_practices": [
        {
            "introduction": "神经毡（neuropil）污染是钙成像信号分析中的一个核心挑战。一种广泛应用的方法是从感兴趣区域（ROI）的荧光信号中减去一个按比例缩放的神经毡信号。然而，当真实的污染程度随时间动态变化时，使用一个固定的校正系数会引入系统性的误差。本练习  旨在通过推导，量化这种简化模型所产生的偏差（bias），帮助你从根本上理解常见分析流程中误差的来源。",
            "id": "4143823",
            "problem": "您正在使用 Suite2p 分析双光子钙成像数据，Suite2p 会对每个感兴趣区域（ROI）进行神经毡减除。考虑单个 ROI，其观测到的荧光轨迹被建模为胞体信号、神经毡污染和测量噪声的线性混合。该轨迹由 $F_{\\mathrm{ROI}}(t) = S(t) + \\alpha(t) N(t) + \\varepsilon(t)$ 给出，其中 $S(t)$ 是减去基线的胞体荧光（零均值），$N(t)$ 是神经毡荧光，$\\alpha(t)$ 是真实的随时间变化的污染分数，$\\varepsilon(t)$ 是加性测量噪声。Suite2p 应用一个固定的神经毡系数 $\\beta$ 从 ROI 轨迹中减去，产生校正后的估计值 $S_{\\mathrm{hat}}(t) = F_{\\mathrm{ROI}}(t) - \\beta N(t)$。\n\n通过 $N(t) = \\mu_{N} + \\tilde{N}(t)$ 定义神经毡基线和波动，其中 $\\tilde{N}(t)$ 是零均值。将污染分数建模为 $\\alpha(t) = \\alpha_{0} + \\alpha_{1} X(t)$，其中 $X(t)$ 是一个零均值的平稳标量过程，代表调节污染分数的缓慢状态变化（例如，深度依赖的散射或血管周活动）。假设如下：\n- $S(t)$ 和 $\\varepsilon(t)$ 均为零均值，且独立于 $N(t)$ 和 $X(t)$。\n- 神经毡波动 $\\tilde{N}(t)$ 和调制器 $X(t)$ 是联合平稳的，其方差分别为 $\\sigma_{N}^{2}$ 和 $\\sigma_{X}^{2}$，相关系数为 $\\rho$，因此 $\\operatorname{Cov}(X(t), \\tilde{N}(t)) = \\rho \\sigma_{X} \\sigma_{N}$。\n- 所有过程都是遍历的，因此时间平均等于期望。\n\n设 Suite2p 估计相对于真实胞体信号的偏差定义为期望差 $B = \\mathbb{E}[S_{\\mathrm{hat}}(t) - S(t)]$。仅使用上述定义，并且在给定的二阶统计量之外不假设任何特定的参数形式，推导出一个关于 $\\alpha_{0}$、$\\alpha_{1}$、$\\mu_{N}$、$\\sigma_{X}$、$\\sigma_{N}$、$\\rho$ 和 $\\beta$ 的 $B$ 的封闭形式解析表达式。\n\n您的最终答案必须是单个封闭形式的表达式。不需要进行数值评估。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n给定的定义、模型和假设如下：\n- 观测到的 ROI 荧光：$F_{\\mathrm{ROI}}(t) = S(t) + \\alpha(t) N(t) + \\varepsilon(t)$。\n- $S(t)$: 减去基线的胞体荧光，均值为零，$\\mathbb{E}[S(t)] = 0$。\n- $N(t)$: 神经毡荧光。\n- $\\alpha(t)$: 真实的随时间变化的污染分数。\n- $\\varepsilon(t)$: 加性测量噪声，均值为零，$\\mathbb{E}[\\varepsilon(t)] = 0$。\n- 校正后的荧光估计：$S_{\\mathrm{hat}}(t) = F_{\\mathrm{ROI}}(t) - \\beta N(t)$。\n- $\\beta$: 固定的神经毡减除系数。\n- 神经毡模型：$N(t) = \\mu_{N} + \\tilde{N}(t)$，其中 $\\mu_{N}$ 是均值，$\\tilde{N}(t)$ 是零均值波动，$\\mathbb{E}[\\tilde{N}(t)] = 0$。\n- 污染分数模型：$\\alpha(t) = \\alpha_{0} + \\alpha_{1} X(t)$，其中 $X(t)$ 是一个零均值的平稳过程，$\\mathbb{E}[X(t)] = 0$。\n- 统计假设：\n    - $S(t)$ 和 $\\varepsilon(t)$ 独立于 $N(t)$ 和 $X(t)$。\n    - 过程 $\\tilde{N}(t)$ 和 $X(t)$ 是联合平稳的。\n    - $\\tilde{N}(t)$ 的方差是 $\\operatorname{Var}(\\tilde{N}(t)) = \\sigma_{N}^{2}$。\n    - $X(t)$ 的方差是 $\\operatorname{Var}(X(t)) = \\sigma_{X}^{2}$。\n    - $X(t)$ 和 $\\tilde{N}(t)$ 的协方差是 $\\operatorname{Cov}(X(t), \\tilde{N}(t)) = \\rho \\sigma_{X} \\sigma_{N}$。\n- 假设了遍历性，因此时间平均等于系综期望。\n- 偏差 $B$ 定义为期望差：$B = \\mathbb{E}[S_{\\mathrm{hat}}(t) - S(t)]$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据：** 该问题提出了一个简化但标准的线性模型，用于描述双光子钙成像中的神经毡污染，这是神经科学数据分析中一个公认的问题。模型的所有组成部分（$S(t)$, $N(t)$, $\\alpha(t)$ 等）都代表具有物理意义的量或过程。这是一个有效的科学抽象。\n- **适定性：** 提供了计算期望所需的所有必要统计特性（均值、方差、协方差）。目标是为偏差 $B$ 推导一个单一的解析表达式，这是一个明确定义的数学任务。\n- **客观性：** 问题使用精确、形式化的数学语言陈述，没有任何主观或模棱两可的术语。\n\n该问题没有违反任何无效性标准。它在科学上是合理的，形式上是明确的，完整的，一致的，并且是可解的。\n\n### 步骤 3：结论与行动\n问题是 **有效的**。将提供完整的解题推导。\n\n### 解题推导\n目标是推导偏差 $B$ 的表达式，其定义为估计的胞体信号 $S_{\\mathrm{hat}}(t)$ 与真实胞体信号 $S(t)$ 之间的差的期望。\n$$B = \\mathbb{E}[S_{\\mathrm{hat}}(t) - S(t)]$$\n首先，将 $S_{\\mathrm{hat}}(t) = F_{\\mathrm{ROI}}(t) - \\beta N(t)$ 的定义代入 $B$ 的表达式中：\n$$B = \\mathbb{E}[ (F_{\\mathrm{ROI}}(t) - \\beta N(t)) - S(t) ]$$\n接下来，代入观测荧光的模型，$F_{\\mathrm{ROI}}(t) = S(t) + \\alpha(t) N(t) + \\varepsilon(t)$：\n$$B = \\mathbb{E}[ (S(t) + \\alpha(t) N(t) + \\varepsilon(t) - \\beta N(t)) - S(t) ]$$\n真实胞体信号 $S(t)$ 的项相互抵消：\n$$B = \\mathbb{E}[ \\alpha(t) N(t) - \\beta N(t) + \\varepsilon(t) ]$$\n该表达式可以进行因式分解，并根据期望算子的线性性质，分离成两项：\n$$B = \\mathbb{E}[ (\\alpha(t) - \\beta) N(t) ] + \\mathbb{E}[\\varepsilon(t)]$$\n根据问题陈述，测量噪声 $\\varepsilon(t)$ 是零均值的，所以 $\\mathbb{E}[\\varepsilon(t)] = 0$。偏差的方程简化为：\n$$B = \\mathbb{E}[ (\\alpha(t) - \\beta) N(t) ]$$\n现在，我们代入给定的随时间变化的污染分数模型 $\\alpha(t) = \\alpha_{0} + \\alpha_{1} X(t)$ 和神经毡荧光模型 $N(t) = \\mu_{N} + \\tilde{N}(t)$：\n$$B = \\mathbb{E}[ (\\alpha_{0} + \\alpha_{1} X(t) - \\beta) (\\mu_{N} + \\tilde{N}(t)) ]$$\n我们展开期望内的乘积：\n$$B = \\mathbb{E}[ (\\alpha_{0} - \\beta)\\mu_{N} + (\\alpha_{0} - \\beta)\\tilde{N}(t) + \\alpha_{1} X(t)\\mu_{N} + \\alpha_{1} X(t)\\tilde{N}(t) ]$$\n再次，我们对和中的每一项应用期望的线性性质：\n$$B = \\mathbb{E}[(\\alpha_{0} - \\beta)\\mu_{N}] + \\mathbb{E}[(\\alpha_{0} - \\beta)\\tilde{N}(t)] + \\mathbb{E}[\\alpha_{1} X(t)\\mu_{N}] + \\mathbb{E}[\\alpha_{1} X(t)\\tilde{N}(t)]$$\n让我们逐项评估。\n1. 第一项 $\\mathbb{E}[(\\alpha_{0} - \\beta)\\mu_{N}]$ 完全由常数组成。常数的期望就是常数本身：\n$$\\mathbb{E}[(\\alpha_{0} - \\beta)\\mu_{N}] = (\\alpha_{0} - \\beta)\\mu_{N}$$\n2. 对于第二项，我们可以提出常数部分：\n$$\\mathbb{E}[(\\alpha_{0} - \\beta)\\tilde{N}(t)] = (\\alpha_{0} - \\beta)\\mathbb{E}[\\tilde{N}(t)]$$\n已知神经毡波动 $\\tilde{N}(t)$ 是零均值的，所以 $\\mathbb{E}[\\tilde{N}(t)] = 0$。因此，这一整项为零。\n3. 对于第三项，我们提出常数 $\\alpha_{1}$ 和 $\\mu_{N}$：\n$$\\mathbb{E}[\\alpha_{1} X(t)\\mu_{N}] = \\alpha_{1}\\mu_{N}\\mathbb{E}[X(t)]$$\n已知调制过程 $X(t)$ 是零均值的，所以 $\\mathbb{E}[X(t)] = 0$。这一项也为零。\n4. 对于第四项，我们提出常数 $\\alpha_{1}$：\n$$\\mathbb{E}[\\alpha_{1} X(t)\\tilde{N}(t)] = \\alpha_{1}\\mathbb{E}[X(t)\\tilde{N}(t)]$$\n项 $\\mathbb{E}[X(t)\\tilde{N}(t)]$ 是 $X(t)$ 和 $\\tilde{N}(t)$ 之间的协方差，因为两个过程都是零均值的：$\\operatorname{Cov}(X(t), \\tilde{N}(t)) = \\mathbb{E}[(X(t)-\\mathbb{E}[X(t)])(\\tilde{N}(t)-\\mathbb{E}[\\tilde{N}(t)])] = \\mathbb{E}[X(t)\\tilde{N}(t)]$。\n问题陈述该协方差为 $\\operatorname{Cov}(X(t), \\tilde{N}(t)) = \\rho \\sigma_{X} \\sigma_{N}$。因此，第四项的值为：\n$$\\alpha_{1} \\rho \\sigma_{X} \\sigma_{N}$$\n最后，我们将所有四项的结果相加，得到偏差 $B$ 的最终表达式：\n$$B = (\\alpha_{0} - \\beta)\\mu_{N} + 0 + 0 + \\alpha_{1} \\rho \\sigma_{X} \\sigma_{N}$$\n$$B = (\\alpha_{0} - \\beta)\\mu_{N} + \\alpha_{1} \\rho \\sigma_{X} \\sigma_{N}$$\n这就是用指定参数表示的偏差的封闭形式解析表达式。",
            "answer": "$$\n\\boxed{(\\alpha_{0} - \\beta)\\mu_{N} + \\alpha_{1} \\rho \\sigma_{X} \\sigma_{N}}\n$$"
        },
        {
            "introduction": "在理解了固定系数校正可能引入偏差后，我们自然会问：如何在实际数据中判断校正系数是否选择得当？本练习  聚焦于最常见的错误——过度减除（over-subtraction），即校正系数 $\\beta$ 设置得过高。通过本练习，你将学会识别过度校正后数据中出现的典型信号特征，例如负向瞬变和信号分布的偏斜，从而将理论知识转化为实用的数据质量诊断技能。",
            "id": "4143838",
            "problem": "考虑在双光子钙成像中，一个神经元感兴趣区域（ROI）的荧光时间序列及其周围的神经纤维网。假设测得的 ROI 荧光可以建模为细胞组分、神经纤维网污染组分和噪声的线性混合：\n$$F_{\\text{ROI}}(t) = F_{\\text{cell}}(t) + \\alpha F_{\\text{np}}(t) + \\varepsilon(t),$$ \n其中 $F_{\\text{cell}}(t)$ 是细胞荧光，$F_{\\text{np}}(t)$ 是神经纤维网荧光，$\\alpha \\in [0,1]$ 是污染系数，$\\varepsilon(t)$ 是具有对称分布的零均值噪声。假设细胞荧光 $F_{\\text{cell}}(t)$ 来自于一个非负的潜在钙浓度，该浓度由与一个严格非负的脉冲响应 $h(t)$ 卷积的脉冲驱动，因此 $F_{\\text{cell}}(t)$ 中的瞬时事件振幅是非负的。同样，假设当局部神经元群体活跃时，$F_{\\text{np}}(t)$ 具有非负的瞬态。一种常见的神经纤维网校正方法是从 ROI 轨迹中减去一个按比例缩放的神经纤维网轨迹，定义为\n$$F_{\\text{corr}}(t) = F_{\\text{ROI}}(t) - \\beta F_{\\text{np}}(t),$$ \n其中 $\\beta \\ge 0$ 是用户选择的减法系数。\n\n假设在时间 $t_0$ 发生一个瞬态，使得在一个短窗口内（其中脉冲响应可视为非负），$F_{\\text{cell}}(t)$ 和 $F_{\\text{np}}(t)$ 分别比其基线增加了 $A_{\\text{cell}} \\ge 0$ 和 $A_{\\text{np}} \\ge 0$ 的振幅。你可以将 $A_{\\text{cell}}$ 和 $A_{\\text{np}}$ 视为相对于基线的瞬时增量，并将 $\\varepsilon(t)$ 视为具有零均值的小扰动。\n\n仅使用线性混合模型、钙脉冲响应的非负性和噪声的对称性，推断选择比真实污染系数 $\\alpha$ 更大的 $\\beta$ 对 $F_{\\text{corr}}(t)$ 中瞬态极性的影响。然后，提出不需要基准真相（ground-truth）脉冲来检测过度减法的有原则的诊断方法。特别地，考虑基于 $F_{\\text{corr}}(t)$ 围绕其基线的分布以及使用匹配滤波器 $h(t)$ 检测到的事件的极性的诊断方法。\n\n下列哪个陈述是正确的？\n\nA. 在所述模型下，校正后在 $t_0$ 处的瞬态振幅等于 $A_{\\text{cell}} + (\\alpha - \\beta) A_{\\text{np}}$。如果 $\\beta$ 超出 $\\alpha$ 的量大于 $A_{\\text{cell}}/A_{\\text{np}}$，校正后的瞬态将变为负值，在 $F_{\\text{corr}}(t)$ 中产生负向偏转。\n\nB. 因为噪声 $\\varepsilon(t)$ 是对称的，且钙脉冲响应 $h(t)$ 是非负的，所以在正确减法下，合法事件应使 $F_{\\text{corr}}(t)$ 的分布偏向右尾。过度减法（$\\beta > \\alpha$）会导致一个重左尾。一个实用的诊断方法是计算尾部不平衡比率\n$$R_k = \\frac{\\mathbb{P}\\!\\left(F_{\\text{corr}}(t)  m - k \\hat{\\sigma}\\right)}{\\mathbb{P}\\!\\left(F_{\\text{corr}}(t) > m + k \\hat{\\sigma}\\right)},$$ \n其中 $m$ 是 $F_{\\text{corr}}(t)$ 的样本中位数，$\\hat{\\sigma}$ 是一个稳健的尺度估计；$R_k \\gg 1$ 的值表示过度减法。\n\nC. 使用与非负钙脉冲响应成比例的匹配滤波器 $h(t)$，通过投影 $s(t_0) = \\sum_{t} F_{\\text{corr}}(t) h(t - t_0)$ 形成事件分数，并对 $|s(t_0)|$ 进行阈值处理。如果统计上显著比例的高振幅检测事件具有 $s(t_0)  0$（负极性），则这是过度减法的证据。\n\nD. 选择 $\\beta$ 以最小化 $F_{\\text{corr}}(t)$ 的方差可确保最佳校正，并且不会产生过度减法，因为方差减小意味着信号质量的提高。\n\nE. 无论 $F_{\\text{cell}}(t)$ 和 $F_{\\text{np}}(t)$ 之间的依赖关系如何，只要 $\\beta > \\alpha$，零延迟协方差 $\\operatorname{Cov}\\!\\left(F_{\\text{corr}}(t), F_{\\text{np}}(t)\\right)$ 就必须为负；因此，负的零延迟协方差是诊断过度减法的充要条件。",
            "solution": "用户希望我扮演一名 STEM 教授。我的任务是验证问题陈述，如果有效，则提供一个评估每个选项的详细解决方案。\n\n### 问题验证\n\n**第一步：提取已知条件**\n问题提供了以下模型和条件：\n-   ROI 荧光模型：$F_{\\text{ROI}}(t) = F_{\\text{cell}}(t) + \\alpha F_{\\text{np}}(t) + \\varepsilon(t)$。\n-   $F_{\\text{cell}}(t)$: 真实的细胞荧光。\n-   $F_{\\text{np}}(t)$: 神经纤维网荧光。\n-   $\\alpha$: 真实的污染系数，其中 $\\alpha \\in [0,1]$。\n-   $\\varepsilon(t)$: 具有对称分布的零均值噪声。\n-   $F_{\\text{cell}}(t)$ 具有非负的脉冲响应 $h(t)$，导致非负的事件振幅。\n-   $F_{\\text{np}}(t)$ 具有非负的瞬态。\n-   校正后的荧光公式：$F_{\\text{corr}}(t) = F_{\\text{ROI}}(t) - \\beta F_{\\text{np}}(t)$。\n-   $\\beta$: 用户选择的减法系数，其中 $\\beta \\ge 0$。\n-   在瞬态时间 $t_0$，高于基线的振幅分别为 $A_{\\text{cell}} \\ge 0$ 和 $A_{\\text{np}} \\ge 0$。这些被视为瞬时增量。\n\n**第二步：使用提取的已知条件进行验证**\n-   **科学依据**：该问题基于双光子钙成像中神经纤维网污染的标准线性模型，这是计算神经科学中一个被广泛接受和使用的框架。关于信号非负性和对称噪声的假设是此背景下的标准简化。该问题在科学上是合理的。\n-   **良态问题**：该问题在数学上是明确定义的。它提供了一组清晰的方程和假设，并要求对特定条件下（$\\beta > \\alpha$）系统行为进行逻辑推断，并找出诊断这种情况的方法。可以得出一组唯一的逻辑结论。\n-   **客观性**：该问题使用精确、客观的数学和科学语言陈述。它没有歧义和主观论断。\n\n**第三步：结论与行动**\n问题陈述是有效的。它具有科学依据，是良态的，并且是客观的。我将继续推导解决方案。\n\n### 解题推导\n\n首先，我们建立校正后荧光 $F_{\\text{corr}}(t)$ 的基本方程。我们将 $F_{\\text{ROI}}(t)$ 的表达式代入 $F_{\\text{corr}}(t)$ 的公式中：\n$$F_{\\text{corr}}(t) = F_{\\text{ROI}}(t) - \\beta F_{\\text{np}}(t)$$\n$$F_{\\text{corr}}(t) = (F_{\\text{cell}}(t) + \\alpha F_{\\text{np}}(t) + \\varepsilon(t)) - \\beta F_{\\text{np}}(t)$$\n$$F_{\\text{corr}}(t) = F_{\\text{cell}}(t) + (\\alpha - \\beta) F_{\\text{np}}(t) + \\varepsilon(t)$$\n该方程是分析减法系数 $\\beta$ 影响的基础。我们特别感兴趣的是过度减法的情况，即 $\\beta > \\alpha$。在这种情况下，项 $(\\alpha - \\beta)$ 是负的。\n\n### 逐项分析\n\n**A. 在所述模型下，校正后在 $t_0$ 处的瞬态振幅等于 $A_{\\text{cell}} + (\\alpha - \\beta) A_{\\text{np}}$。如果 $\\beta$ 超出 $\\alpha$ 的量大于 $A_{\\text{cell}}/A_{\\text{np}}$，校正后的瞬态将变为负值，在 $F_{\\text{corr}}(t)$ 中产生负向偏转。**\n\n我们来分析校正后信号中瞬态的振幅。问题将振幅 $A_{\\text{cell}}$ 和 $A_{\\text{np}}$ 定义为相对于各自基线的瞬时增量。校正后信号的变化，我们可以称之为校正后振幅 $A_{\\text{corr}}$，可以从我们的基本方程中推导出来，在计算振幅时忽略零均值噪声项 $\\varepsilon(t)$：\n$$A_{\\text{corr}} = \\Delta F_{\\text{corr}}(t_0) = \\Delta F_{\\text{cell}}(t_0) + (\\alpha - \\beta) \\Delta F_{\\text{np}}(t_0)$$\n鉴于 $\\Delta F_{\\text{cell}}(t_0) = A_{\\text{cell}}$ 和 $\\Delta F_{\\text{np}}(t_0) = A_{\\text{np}}$，我们有：\n$$A_{\\text{corr}} = A_{\\text{cell}} + (\\alpha - \\beta) A_{\\text{np}}$$\n这证实了陈述的第一部分。\n\n为了使校正后的瞬态变为负值，我们需要 $A_{\\text{corr}}  0$：\n$$A_{\\text{cell}} + (\\alpha - \\beta) A_{\\text{np}}  0$$\n重新整理不等式以求解过度减法量 $(\\beta - \\alpha)$：\n$$A_{\\text{cell}}  -(\\alpha - \\beta) A_{\\text{np}}$$\n$$A_{\\text{cell}}  (\\beta - \\alpha) A_{\\text{np}}$$\n假设存在神经纤维网瞬态，所以 $A_{\\text{np}} > 0$，我们可以用 $A_{\\text{np}}$ 除不等式两边而不改变不等号方向：\n$$\\frac{A_{\\text{cell}}}{A_{\\text{np}}}  \\beta - \\alpha$$\n这意味着，如果过度减法量 $\\beta - \\alpha$ 大于细胞瞬态振幅与神经纤维网瞬态振幅之比 $A_{\\text{cell}}/A_{\\text{np}}$，则校正后的瞬态振幅为负。这与选项中陈述的条件完全相符。负向偏转是 $A_{\\text{corr}}$ 变为负值的直接结果。\n\n结论：**正确**。\n\n**B. 因为噪声 $\\varepsilon(t)$ 是对称的，且钙脉冲响应 $h(t)$ 是非负的，所以在正确减法下，合法事件应使 $F_{\\text{corr}}(t)$ 的分布偏向右尾。过度减法（$\\beta > \\alpha$）会导致一个重左尾。一个实用的诊断方法是计算尾部不平衡比率 $R_k = \\frac{\\mathbb{P}\\!\\left(F_{\\text{corr}}(t)  m - k \\hat{\\sigma}\\right)}{\\mathbb{P}\\!\\left(F_{\\text{corr}}(t) > m + k \\hat{\\sigma}\\right)}$，其中 $m$ 是 $F_{\\text{corr}}(t)$ 的样本中位数，$\\hat{\\sigma}$ 是一个稳健的尺度估计；$R_k \\gg 1$ 的值表示过度减法。**\n\n在正确减法下（理想情况为 $\\beta = \\alpha$），校正后的信号为 $F_{\\text{corr}}(t) = F_{\\text{cell}}(t) + \\varepsilon(t)$。信号 $F_{\\text{cell}}(t)$ 由一个基线和非负瞬态组成，所以其概率分布是右偏的。噪声 $\\varepsilon(t)$ 是对称的。一个右偏分布与一个对称分布的卷积结果是一个右偏分布。因此，在正确减法下，$F_{\\text{corr}}(t)$ 的分布将有一个右尾。\n\n在过度减法下（$\\beta > \\alpha$），校正后的信号为 $F_{\\text{corr}}(t) = F_{\\text{cell}}(t) - (\\beta - \\alpha)F_{\\text{np}}(t) + \\varepsilon(t)$。项 $-(\\beta - \\alpha)F_{\\text{np}}(t)$ 是一个正值信号（$F_{\\text{np}}(t)$）与一个负常数 $-(\\beta - \\alpha)$ 的乘积。因此，该分量将具有非正（负）的瞬态，为总分布贡献一个重左尾。如果这个效应足够强，它将导致 $F_{\\text{corr}}(t)$ 的分布变为负偏或“重左尾”。\n\n所提出的诊断方法 $R_k$ 量化了这种不对称性。它是远左尾的概率质量与远右尾的概率质量之比。使用中位数 $m$ 和稳健的尺度估计 $\\hat{\\sigma}$（如中位数绝对偏差）使得该度量对于异常值和非高斯分布具有稳健性。如果分布有一个重左尾，分子 $\\mathbb{P}(F_{\\text{corr}}(t)  m - k \\hat{\\sigma})$ 将显著大于分母 $\\mathbb{P}(F_{\\text{corr}}(t) > m + k \\hat{\\sigma})$，导致 $R_k \\gg 1$。这是一个有原则且实用的过度减法诊断方法。\n\n结论：**正确**。\n\n**C. 使用与非负钙脉冲响应成比例的匹配滤波器 $h(t)$，通过投影 $s(t_0) = \\sum_{t} F_{\\text{corr}}(t) h(t - t_0)$ 形成事件分数，并对 $|s(t_0)|$ 进行阈值处理。如果统计上显著比例的高振幅检测事件具有 $s(t_0)  0$（负极性），则这是过度减法的证据。**\n\n我们来分析事件分数 $s(t_0)$。投影操作是线性的。\n$$s(t_0) = \\sum_{t} \\left[F_{\\text{cell}}(t) + (\\alpha - \\beta) F_{\\text{np}}(t) + \\varepsilon(t)\\right] h(t - t_0)$$\n$$s(t_0) = \\underbrace{\\sum_{t} F_{\\text{cell}}(t) h(t-t_0)}_{\\text{第 1 项}} + \\underbrace{(\\alpha - \\beta) \\sum_{t} F_{\\text{np}}(t) h(t-t_0)}_{\\text{第 2 项}} + \\underbrace{\\sum_{t} \\varepsilon(t) h(t-t_0)}_{\\text{第 3 项}}$$\n第 1 项代表来自真实细胞信号的分数。由于 $F_{\\text{cell}}(t)$ 由形状与 $h(t)$ 相似且振幅非负的瞬态组成，并且 $h(t)$ 是非负的，所以这一项将是非负的。\n第 3 项是来自滤波后噪声的分数，其均值为零。\n第 2 项是关键部分。如果 $\\beta > \\alpha$，则因子 $(\\alpha - \\beta)$ 为负。求和 $\\sum_{t} F_{\\text{np}}(t) h(t-t_0)$ 是神经纤维网信号在滤波器 $h(t)$ 上的投影。由于 $F_{\\text{np}}(t)$ 的瞬态和 $h(t)$ 都是非负的，这个和将是非负的。因此，当 $\\beta > \\alpha$ 时，第 2 项是非正的（即，在神经纤维网瞬态期间为负）。\n\n如果在没有细胞瞬态（$F_{\\text{cell}}(t)$ 处于基线水平）的时候发生了显著的神经纤维网瞬态，那么分数将主要由第 2 项决定，导致 $s(t_0)  0$。如果事件检测算法对绝对值 $|s(t_0)|$ 进行阈值处理，它将检测到这些负向“事件”。存在大量具有负分数的检测事件是过度减法的直接后果，并可作为一种强有力的诊断方法。\n\n结论：**正确**。\n\n**D. 选择 $\\beta$ 以最小化 $F_{\\text{corr}}(t)$ 的方差可确保最佳校正，并且不会产生过度减法，因为方差减小意味着信号质量的提高。**\n\n为了找到最小化 $\\operatorname{Var}(F_{\\text{corr}}(t))$ 的 $\\beta$ 值，我们可以计算方差并求最小值。假设噪声 $\\varepsilon(t)$ 与荧光信号不相关：\n$$\\operatorname{Var}(F_{\\text{corr}}) = \\operatorname{Var}(F_{\\text{cell}} + (\\alpha - \\beta)F_{\\text{np}} + \\varepsilon)$$\n$$\\operatorname{Var}(F_{\\text{corr}}) = \\operatorname{Var}(F_{\\text{cell}}) + (\\alpha - \\beta)^2 \\operatorname{Var}(F_{\\text{np}}) + 2(\\alpha - \\beta)\\operatorname{Cov}(F_{\\text{cell}}, F_{\\text{np}}) + \\operatorname{Var}(\\varepsilon)$$\n这是一个关于 $\\beta$ 的二次函数。为了找到最小值，我们令其关于 $\\beta$ 的导数为零：\n$$\\frac{d}{d\\beta} \\operatorname{Var}(F_{\\text{corr}}) = 2(\\alpha - \\beta)(-1)\\operatorname{Var}(F_{\\text{np}}) + 2(-1)\\operatorname{Cov}(F_{\\text{cell}}, F_{\\text{np}}) = 0$$\n$$-(\\alpha - \\beta)\\operatorname{Var}(F_{\\text{np}}) - \\operatorname{Cov}(F_{\\text{cell}}, F_{\\text{np}}) = 0$$\n$$\\beta \\operatorname{Var}(F_{\\text{np}}) = \\alpha \\operatorname{Var}(F_{\\text{np}}) + \\operatorname{Cov}(F_{\\text{cell}}, F_{\\text{np}})$$\n最小化方差的 $\\beta$ 值，我们称之为 $\\beta^*$，是：\n$$\\beta^{*} = \\alpha + \\frac{\\operatorname{Cov}(F_{\\text{cell}}, F_{\\text{np}})}{\\operatorname{Var}(F_{\\text{np}})}$$\n在实践中，神经元（$F_{\\text{cell}}$）的活动通常与周围神经纤维网（$F_{\\text{np}}$）的活动正相关，这意味着 $\\operatorname{Cov}(F_{\\text{cell}}, F_{\\text{np}}) > 0$。在这种常见情况下，$\\beta^{*} > \\alpha$。因此，最小化校正后轨迹的方差实际上会*导致*过度减法。其根本原因是，该过程错误地将与神经纤维网相关的真实细胞信号部分解释为污染并将其减去。方差减小保证最佳校正的假设是错误的；它可能通过移除真实的神经活动而降低信号质量。\n\n结论：**错误**。\n\n**E. 无论 $F_{\\text{cell}}(t)$ 和 $F_{\\text{np}}(t)$ 之间的依赖关系如何，只要 $\\beta > \\alpha$，零延迟协方差 $\\operatorname{Cov}\\!\\left(F_{\\text{corr}}(t), F_{\\text{np}}(t)\\right)$ 就必须为负；因此，负的零延迟协方差是诊断过度减法的充要条件。**\n\n我们来计算校正后信号与神经纤维网信号之间的协方差。假设噪声 $\\varepsilon(t)$ 与 $F_{\\text{np}}(t)$ 独立：\n$$\\operatorname{Cov}(F_{\\text{corr}}, F_{\\text{np}}) = \\operatorname{Cov}(F_{\\text{cell}} + (\\alpha - \\beta)F_{\\text{np}} + \\varepsilon, F_{\\text{np}})$$\n$$\\operatorname{Cov}(F_{\\text{corr}}, F_{\\text{np}}) = \\operatorname{Cov}(F_{\\text{cell}}, F_{\\text{np}}) + \\operatorname{Cov}((\\alpha - \\beta)F_{\\text{np}}, F_{\\text{np}}) + \\operatorname{Cov}(\\varepsilon, F_{\\text{np}})$$\n$$\\operatorname{Cov}(F_{\\text{corr}}, F_{\\text{np}}) = \\operatorname{Cov}(F_{\\text{cell}}, F_{\\text{np}}) + (\\alpha - \\beta)\\operatorname{Var}(F_{\\text{np}})$$\n该陈述声称只要 $\\beta > \\alpha$，这个协方差就*必须*为负。我们来检验一下。如果 $\\beta > \\alpha$，那么 $\\alpha - \\beta  0$，所以第二项是负的。然而，第一项 $\\operatorname{Cov}(F_{\\text{cell}}, F_{\\text{np}})$ 通常是正的。整个表达式的符号取决于这两项的相对大小。完全有可能 $\\operatorname{Cov}(F_{\\text{cell}}, F_{\\text{np}}) > -(\\alpha - \\beta)\\operatorname{Var}(F_{\\text{np}})$，这将使得即使在过度减法的情况下，总协方差也为正。因此，负协方差*不是*过度减法的必要条件。由于该陈述声称它是充要条件，所以该陈述是错误的。\n\n结论：**错误**。",
            "answer": "$$\\boxed{ABC}$$"
        },
        {
            "introduction": "简单的减除模型虽然直观，但更先进的方法试图从根本上解决信号混合问题。这些方法（如约束化非负矩阵分解，CNMF）不依赖于预先定义的ROI，而是构建一个生成模型，直接从原始像素数据中同时推断出神经元的空间足迹（spatial footprint）和时间活动轨迹。本练习  将带你深入这些方法的核心优化过程，通过推导其交替最小化算法的更新规则，让你理解实现这种强大信号解混（demixing）的关键数学原理。",
            "id": "4143876",
            "problem": "考虑一个经过运动校正的二维荧光视频，该视频被分割成单个神经元的固定感兴趣区域（ROI），由矩阵 $Y \\in \\mathbb{R}^{p \\times T}$ 表示，其中包含 $p$ 个像素和 $T$ 个时间点。设空间足迹为 $A \\in \\mathbb{R}^{p \\times 1}$，时间活动轨迹为 $C \\in \\mathbb{R}^{1 \\times T}$，因此秩一分解 $AC$ 模拟了神经元的贡献。假设该视频被神经纤维网荧光 $S \\in \\mathbb{R}^{p \\times T}$ 污染，污染系数为 $\\rho \\in \\mathbb{R}_{+}$，并定义校正后的数据 $Y' = Y - \\rho S$。目标是通过在概率观测模型下进行交替优化来估计 $A$ 和 $C$，同时强制执行与约束非负矩阵分解（CNMF）相关的约束。\n\n从经过充分测试的观测模型和核心定义开始：\n- 在高斯噪声模型下，假设 $Y'$ 生成为 $Y' = AC + E$，其中 $E$ 由独立的、零均值的高斯随机变量组成，方差为 $\\sigma^{2}$。\n- 在泊松计数模型下，假设 $Y'$ 表示光子计数，其率为 $\\Lambda = AC$，因此 $Y'_{i,t} \\sim \\mathrm{Poisson}(\\Lambda_{i,t})$。\n\n您将从增广了正则化和与CNMF实践一致的约束的负对数似然函数出发，为两种模型推导 $A$ 和 $C$ 的交替优化更新，然后计算高斯模型下的一个特定标量更新。\n\n任务：\n1. 在高斯模型下，通过最小化带惩罚项的负对数似然\n$$\n\\mathcal{L}_{\\mathrm{G}}(A,C) = \\frac{1}{2 \\sigma^{2}} \\| Y' - A C \\|_{F}^{2} + \\frac{\\lambda_{C}}{2} \\| C \\|_{F}^{2}\n$$\n推导在给定 $A$ 的条件下 $C$ 的更新规则，其中 $C \\geq 0$。展示无约束最小化子，并描述如何强制执行非负性约束。\n\n2. 在高斯模型下，通过最小化\n$$\n\\mathcal{L}_{\\mathrm{G}}(A,C) = \\frac{1}{2 \\sigma^{2}} \\| Y' - A C \\|_{F}^{2} + \\frac{\\lambda_{A}}{2} \\| A \\|_{2}^{2}\n$$\n推导在给定 $C$ 的条件下 $A$ 的更新规则，其中 $A \\geq 0$。展示无约束最小化子，并描述如何强制执行非负性约束。在您的推导中，请清楚地指出交替优化在秩一情况下是如何解耦的。\n\n3. 从泊松负对数似然\n$$\n\\mathcal{L}_{\\mathrm{P}}(A,C) = \\sum_{i=1}^{p} \\sum_{t=1}^{T} \\left[ (A C)_{i,t} - Y'_{i,t} \\ln\\left( (A C)_{i,t} \\right) \\right],\n$$\n出发，推导 $A$ 和 $C$ 的乘性更新规则，该规则满足 $A \\geq 0$ 和 $C \\geq 0$。提供通过对广义Kullback–Leibler散度下的非负矩阵分解强制执行Karush–Kuhn–Tucker最优性条件或使用适当的辅助函数法得到的表达式。\n\n4. 利用推导出的目标函数和约束的结构，解释为什么诸如非负性、空间正则化（例如，对 $A$ 的二次惩罚或离散拉普拉斯惩罚 $A^T L A$）和显式支撑集约束等约束条件能够防止退化解，例如坍缩的足迹（例如，$A$ 将所有权重集中在单个像素中）。\n\n5. 在高斯模型下计算一次数值更新。考虑 $p=3$ 个像素和 $T=2$ 个时间点，其中\n$$\nY = \\begin{pmatrix}\n10  12 \\\\\n22  20 \\\\\n11  15\n\\end{pmatrix}, \\quad\nS = \\begin{pmatrix}\n4  3 \\\\\n5  4 \\\\\n3  2\n\\end{pmatrix}, \\quad\n\\rho = 0.2,\n$$\n以及初始空间足迹\n$$\nA = \\begin{pmatrix}\n1 \\\\\n2 \\\\\n1\n\\end{pmatrix}.\n$$\n使用任务1中推导的 $C$ 更新规则，并设 $\\lambda_{C} = 1$，计算在神经纤维网校正后，时间点 $t=2$ 处的更新活动，记为 $c_{2}$。用任意荧光单位表示数值结果。将您的答案四舍五入到四位有效数字。",
            "solution": "问题陈述经评估有效。它在科学上基于计算神经科学和优化的既定原则，特别是关于使用约束矩阵分解分析钙成像数据。该问题是适定的，提供了执行所需推导和计算所必需的所有定义、模型和数据。语言客观且数学上精确。该问题是神经科学数据分析中一个核心任务的标准（尽管简化了的）表述，适合进行严谨的求解。\n\n我们将按顺序解决这五个任务。\n\n### 任务1：高斯模型下C的更新\n\n对于固定的空间分量 $A \\in \\mathbb{R}^{p \\times 1}$，需要针对时间分量 $C \\in \\mathbb{R}^{1 \\times T}$ 最小化的目标函数是带惩罚项的负对数似然：\n$$\n\\mathcal{L}_{\\mathrm{G}}(C) = \\frac{1}{2 \\sigma^{2}} \\| Y' - A C \\|_{F}^{2} + \\frac{\\lambda_{C}}{2} \\| C \\|_{F}^{2}\n$$\n并满足约束条件 $C \\geq 0$（逐元素）。\n\n为了找到无约束最小化子，我们计算 $\\mathcal{L}_{\\mathrm{G}}$ 关于 $C$ 的梯度并将其设为零。弗罗贝尼乌斯范数的平方是所有元素的平方和，$\\|X\\|_F^2 = \\mathrm{Tr}(X^T X)$。我们使用迹表示法来表示目标函数：\n$$\n\\mathcal{L}_{\\mathrm{G}}(C) = \\frac{1}{2 \\sigma^{2}} \\mathrm{Tr}((Y' - AC)^T(Y' - AC)) + \\frac{\\lambda_{C}}{2} \\mathrm{Tr}(C^T C)\n$$\n由于 $C$ 是一个 $1 \\times T$ 的行向量，更方便的做法是计算关于每个分量 $c_t$（其中 $t=1, \\dots, T$）的导数。\n$$\n\\| Y' - A C \\|_{F}^{2} = \\sum_{i=1}^{p} \\sum_{t=1}^{T} (Y'_{i,t} - a_i c_t)^2\n$$\n第一项关于特定分量 $c_t$ 的导数是：\n$$\n\\frac{\\partial}{\\partial c_t} \\left( \\sum_{i, \\tau} (Y'_{i,\\tau} - a_i c_\\tau)^2 \\right) = \\sum_{i=1}^{p} 2(Y'_{i,t} - a_i c_t)(-a_i) = -2 \\sum_{i=1}^{p} a_i(Y'_{i,t} - a_i c_t) = -2 (A^T Y'_t - (A^T A) c_t)\n$$\n其中 $Y'_t$ 是 $Y'$ 的第 $t$ 列。正则化项的导数是：\n$$\n\\frac{\\partial}{\\partial c_t} \\left( \\frac{\\lambda_C}{2} \\|C\\|_F^2 \\right) = \\frac{\\partial}{\\partial c_t} \\left( \\frac{\\lambda_C}{2} \\sum_{\\tau=1}^T c_{\\tau}^2 \\right) = \\lambda_C c_t\n$$\n将它们合并，整个目标函数关于 $c_t$ 的导数是：\n$$\n\\frac{\\partial \\mathcal{L}_{\\mathrm{G}}}{\\partial c_t} = \\frac{1}{2 \\sigma^{2}} [-2 (A^T Y'_t - (A^T A) c_t)] + \\lambda_C c_t = \\frac{1}{\\sigma^2} ( (A^T A) c_t - A^T Y'_t) + \\lambda_C c_t\n$$\n将导数设为零以找到无约束最小值：\n$$\n\\left( \\frac{A^T A}{\\sigma^2} + \\lambda_C \\right) c_t = \\frac{A^T Y'_t}{\\sigma^2} \\implies c_t = \\frac{A^T Y'_t}{A^T A + \\sigma^2 \\lambda_C}\n$$\n这可以对整个向量 $C$ 写成：\n$$\nC_{\\mathrm{unconstrained}} = \\frac{A^T Y'}{A^T A + \\sigma^2 \\lambda_C}\n$$\n注意 $A^T A = \\|A\\|_2^2$ 是一个标量，所以除法是良定义的。\n\n该优化问题是一个带有简单非负性约束的二次规划问题。解可以通过将无约束最小化子投影到可行集（非负象限）上找到。这个投影就是逐元素取与零的最大值。因此，强制 $C \\geq 0$ 的 $C$ 的更新规则是：\n$$\nC \\leftarrow \\left( \\frac{A^T Y'}{A^T A + \\sigma^2 \\lambda_C} \\right)_+\n$$\n其中 $(\\cdot)_+$ 表示逐元素应用的整流函数 $\\max(0, \\cdot)$。\n\n### 任务2：高斯模型下A的更新\n\n对于固定的时间分量 $C \\in \\mathbb{R}^{1 \\times T}$，需要针对空间分量 $A \\in \\mathbb{R}^{p \\times 1}$ 最小化的目标函数是：\n$$\n\\mathcal{L}_{\\mathrm{G}}(A) = \\frac{1}{2 \\sigma^{2}} \\| Y' - A C \\|_{F}^{2} + \\frac{\\lambda_{A}}{2} \\| A \\|_{2}^{2}\n$$\n并满足约束 $A \\geq 0$。这与 $C$ 的更新是类似的。我们取关于 $A$ 的每个分量 $a_i$ 的导数：\n$$\n\\frac{\\partial}{\\partial a_i} \\left( \\sum_{j=1}^{p} \\sum_{t=1}^{T} (Y'_{j,t} - a_j c_t)^2 \\right) = \\sum_{t=1}^{T} 2(Y'_{i,t} - a_i c_t)(-c_t) = -2 ( (Y'C^T)_i - a_i(CC^T) )\n$$\n其中 $(Y'C^T)_i$ 是向量 $Y'C^T$ 的第 $i$ 个元素。正则化项的导数是 $\\frac{\\partial}{\\partial a_i} (\\frac{\\lambda_A}{2} \\sum_j a_j^2) = \\lambda_A a_i$。\n\n整个目标函数关于 $a_i$ 的导数是：\n$$\n\\frac{\\partial \\mathcal{L}_{\\mathrm{G}}}{\\partial a_i} = \\frac{1}{\\sigma^2}( a_i(CC^T) - (Y'C^T)_i) + \\lambda_A a_i\n$$\n设为零：\n$$\n\\left( \\frac{CC^T}{\\sigma^2} + \\lambda_A \\right) a_i = \\frac{(Y'C^T)_i}{\\sigma^2} \\implies a_i = \\frac{(Y'C^T)_i}{CC^T + \\sigma^2 \\lambda_A}\n$$\n对于整个向量 $A$：\n$$\nA_{\\mathrm{unconstrained}} = \\frac{Y'C^T}{CC^T + \\sigma^2 \\lambda_A}\n$$\n注意 $CC^T = \\|C\\|_F^2$ 是一个标量。\n\n这个更新方程展示了对 $A$ 优化的解耦。每个像素权重 $a_i$ 的更新只依赖于数据矩阵的相应行 $Y'_{i,:}$，并且与所有其他像素 $j \\neq i$ 无关。这是秩一模型结构的直接结果，其中每个像素的时间序列被建模为对公共时间分量 $C$ 的独立缩放。\n\n强制非负性约束 $A \\geq 0$ 的方法与之前一样，通过投影实现：\n$$\nA \\leftarrow \\left( \\frac{Y'C^T}{CC^T + \\sigma^2 \\lambda_A} \\right)_+\n$$\n\n### 任务3：泊松模型下的乘性更新\n\n目标函数是泊松模型的负对数似然，等价于最小化广义Kullback–Leibler (KL) 散度 $D_{KL}(Y' || AC)$：\n$$\n\\mathcal{L}_{\\mathrm{P}}(A,C) = \\sum_{i=1}^{p} \\sum_{t=1}^{T} \\left[ (A C)_{i,t} - Y'_{i,t} \\ln\\left( (A C)_{i,t} \\right) \\right]\n$$\n我们寻求对 $A \\geq 0$ 和 $C \\geq 0$ 的乘性更新规则。这可以通过辅助函数法或从Karush–Kuhn–Tucker (KKT) 条件推导出来。对于分解 $V \\approx WH$，使用KL散度的非负矩阵分解（NMF）的标准乘性更新规则是：\n$$\nH \\leftarrow H \\odot \\frac{W^T (V ./ (WH))}{W^T \\mathbf{1}} \\quad \\text{和} \\quad W \\leftarrow W \\odot \\frac{(V ./ (WH)) H^T}{\\mathbf{1} H^T}\n$$\n其中 $\\odot$ 和 $./$ 表示逐元素乘法和除法，$\\mathbf{1}$ 是一个大小合适的元素全为1的矩阵。\n\n在我们的例子中，$V=Y'$，$W=A$（一个 $p \\times 1$ 矩阵），$H=C$（一个 $1 \\times T$ 矩阵）。\n\n对于 $C$ 的更新：\n项 $W^T \\mathbf{1}$ 变成一个 $1 \\times T$ 的行向量，其中每个元素是 $\\sum_{i=1}^p a_i$。\n项 $(Y' ./ (AC))_{i,t} = Y'_{i,t} / (a_i c_t)$。\n项 $W^T (V ./ (WH))$ 变成一个 $1 \\times T$ 的向量。其第 $t$ 个分量是：\n$$\n\\sum_{i=1}^p a_i \\frac{Y'_{i,t}}{a_i c_t} = \\frac{1}{c_t} \\sum_{i=1}^p Y'_{i,t}\n$$\n元素 $c_t$ 的乘性更新是：\n$$\nc_t \\leftarrow c_t \\odot \\frac{\\frac{1}{c_t} \\sum_{i=1}^p Y'_{i,t}}{\\sum_{i=1}^p a_i} = \\frac{\\sum_{i=1}^p Y'_{i,t}}{\\sum_{i=1}^p a_i}\n$$\n\n对于 $A$ 的更新：\n项 $\\mathbf{1} H^T$ 变成一个 $p \\times 1$ 的列向量，其中每个元素是 $\\sum_{t=1}^T c_t$。\n项 $(V ./ (WH)) H^T$ 变成一个 $p \\times 1$ 的向量。其第 $i$ 个分量是：\n$$\n\\sum_{t=1}^T \\frac{Y'_{i,t}}{a_i c_t} c_t = \\frac{1}{a_i} \\sum_{t=1}^T Y'_{i,t}\n$$\n元素 $a_i$ 的乘性更新是：\n$$\na_i \\leftarrow a_i \\odot \\frac{\\frac{1}{a_i} \\sum_{t=1}^T Y'_{i,t}}{\\sum_{t=1}^T c_t} = \\frac{\\sum_{t=1}^T Y'_{i,t}}{\\sum_{t=1}^T c_t}\n$$\n所以，对于秩一情况简化后推导出的乘性更新规则是：\n$$\n\\text{对于 } t=1, \\dots, T: \\quad c_t \\leftarrow \\frac{\\sum_{i=1}^p Y'_{i,t}}{\\sum_{i=1}^p a_i}\n$$\n$$\n\\text{对于 } i=1, \\dots, p: \\quad a_i \\leftarrow \\frac{\\sum_{t=1}^T Y'_{i,t}}{\\sum_{t=1}^T c_t}\n$$\n只要 $Y'$ 和初始的 $A, C$ 是非负的，这些更新规则内在地保持了非负性。\n\n### 任务4：约束在防止退化解中的作用\n\n无约束的分解问题 $Y' \\approx AC$ 是不适定的。没有约束，它会产生无限多的退化解。例如，尺度模糊性允许 $(kA)(k^{-1}C) = AC$ 对于任何标量 $k \\neq 0$ 成立。这意味着 $A$ 和 $C$ 的大小不是唯一确定的。更严重的退化包括那些不具有物理意义的解。\n\n1.  **非负性 ($A \\geq 0, C \\geq 0$):** 这是最基本的约束，源于荧光的物理特性。它将解限制在解空间的一个锥体内，并将尺度模糊性限制为 $k > 0$。然而，它本身不足以防止过拟合或非生理性的空间足迹。\n\n2.  **对 $A$ 的空间正则化:** 这编码了关于神经元空间足迹形状的先验信念。\n    *   **二次 ($L_2$) 惩罚 ($\\lambda_A \\|A\\|_2^2$):** 这个惩罚项不鼓励 $A$ 中出现大幅值的项。一个坍缩的足迹，其中所有能量都集中在一个像素 $a_k=M$ 上，而其他像素为零，其惩罚为 $\\frac{\\lambda_A}{2}M^2$。如果将相同的能量分布在 $N$ 个像素上（例如，$a_i=M/N$），其惩罚将正比于 $N(M/N)^2 = M^2/N$，这个值更小。因此，$L_2$ 惩罚偏好空间上分布的足迹，而不是高度集中的足迹，从而减轻了坍缩的风险。\n    *   **拉普拉斯惩罚 ($A^T L A$):** 这种形式的正则化明确地促进了空间平滑性。拉普拉斯算子 $L$ 惩罚相邻像素之间的巨大差异。单个像素上的坍缩足迹代表了一个急剧的空间不连续性（一个大值旁边是零值），这将招致非常高的惩罚。这个约束在强制足迹是连续且平滑的方面非常有效，这与细胞体的微观形态一致。\n\n3.  **显式支撑集约束:** 这包括对预定义感兴趣区域外的所有像素 $i$ 强制 $a_i = 0$。这是防止坍缩足迹最直接的方法，因为可以定义一个具有合理大小和形状的支撑区域，使得解不可能只存在于该区域内的单个像素上（除非该区域本身就是一个像素）。\n\n总而言之，这些约束并非任意设置，而是对不适定分解问题进行正则化的关键。它们融入了关于信号源的物理和生物学性质的关键先验知识，引导优化朝着不仅在数学上有效，而且在科学上有意义且对噪声具有鲁棒性的解发展。\n\n### 任务5：数值更新计算\n\n我们被要求使用任务1中的高斯模型C更新规则，根据给定的初始状态计算 $c_2$ 的更新值。\n更新公式为：\n$$\nc_t = \\left( \\frac{A^T Y'_t}{A^T A + \\sigma^2 \\lambda_C} \\right)_+\n$$\n问题没有指定噪声方差 $\\sigma^2$。在源自概率模型的优化情境中，这个参数通常不失一般性地设为 $1$，因为它实际上是重新缩放了正则化参数 $\\lambda_C$。我们将基于 $\\sigma^2=1$ 的标准假设进行计算。\n\n给定的数据是：\n$$\nY = \\begin{pmatrix} 10  12 \\\\ 22  20 \\\\ 11  15 \\end{pmatrix}, \\quad S = \\begin{pmatrix} 4  3 \\\\ 5  4 \\\\ 3  2 \\end{pmatrix}, \\quad \\rho = 0.2\n$$\n$$\nA = \\begin{pmatrix} 1 \\\\ 2 \\\\ 1 \\end{pmatrix}, \\quad \\lambda_C = 1\n$$\n首先，我们计算经神经纤维网校正的数据 $Y' = Y - \\rho S$：\n$$\n\\rho S = 0.2 \\begin{pmatrix} 4  3 \\\\ 5  4 \\\\ 3  2 \\end{pmatrix} = \\begin{pmatrix} 0.8  0.6 \\\\ 1.0  0.8 \\\\ 0.6  0.4 \\end{pmatrix}\n$$\n$$\nY' = \\begin{pmatrix} 10  12 \\\\ 22  20 \\\\ 11  15 \\end{pmatrix} - \\begin{pmatrix} 0.8  0.6 \\\\ 1.0  0.8 \\\\ 0.6  0.4 \\end{pmatrix} = \\begin{pmatrix} 9.2  11.4 \\\\ 21.0  19.2 \\\\ 10.4  14.6 \\end{pmatrix}\n$$\n我们需要计算 $c_2$，所以我们使用 $Y'$ 的第二列，记为 $Y'_2$：\n$$\nY'_2 = \\begin{pmatrix} 11.4 \\\\ 19.2 \\\\ 14.6 \\end{pmatrix}\n$$\n接下来，我们计算更新公式中的各项：\n分子是 $A^T Y'_2$：\n$$\nA^T Y'_2 = \\begin{pmatrix} 1  2  1 \\end{pmatrix} \\begin{pmatrix} 11.4 \\\\ 19.2 \\\\ 14.6 \\end{pmatrix} = (1)(11.4) + (2)(19.2) + (1)(14.6) = 11.4 + 38.4 + 14.6 = 64.4\n$$\n分母包含 $A^T A$ 和 $\\sigma^2 \\lambda_C$：\n$$\nA^T A = \\begin{pmatrix} 1  2  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 1 \\end{pmatrix} = 1^2 + 2^2 + 1^2 = 1 + 4 + 1 = 6\n$$\n$$\n\\sigma^2 \\lambda_C = (1)(1) = 1\n$$\n现在，将这些值代入 $c_2$ 的公式中：\n$$\nc_2 = \\left( \\frac{64.4}{6 + 1} \\right)_+ = \\left( \\frac{64.4}{7} \\right)_+ = (9.2)_+\n$$\n因为 $9.2 > 0$，所以整流函数没有作用。\n$$\nc_2 = 9.2\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nc_2 = 9.200\n$$",
            "answer": "$$\n\\boxed{9.200}\n$$"
        }
    ]
}