{
    "hands_on_practices": [
        {
            "introduction": "公共卫生规划的第一步是准确评估问题的规模。本练习将引导你完成一项基本流行病学计算，通过结合一系列概率事件——母体感染、垂直传播和出现症状——来预测特定人群中受影响新生儿的预期数量。这个练习将帮助你理解如何将独立的风险因素转化为具体的公共卫生负担估算值 。",
            "id": "4635079",
            "problem": "一个大都会出生队列监测系统监测 Toxoplasma、Others、Rubella、Cytomegalovirus、Herpes simplex virus (TORCH) 类别内的先天性感染。在一个由原发性母体巨细胞病毒 (Cytomegalovirus, CMV) 感染主导的特定暴发期间，流行病学家估算了在整个孕期内汇总的三个参数：孕期母体感染的概率为 $0.05$，在母体感染的情况下发生垂直传播的条件概率为 $0.4$，以及垂直感染的新生儿出生时有症状的条件概率为 $0.1$。在同一时期，该地区有 $20{,}000$ 次完成的妊娠。\n\n仅从概率论的基本定义（事件、条件概率、概率链式法则、指示随机变量和期望的线性性质）出发，并假设报告的风险在不同孕期是稳定的，并且在群体水平上相同且独立地应用于每次妊娠，请推导该队列中出生时患有症状性先天性CMV的新生儿的期望数量的表达式，并计算其值。将最终答案表示为一个代表受影响新生儿数量的实数。不要使用百分号。如果得到的是精确值，则无需四舍五入。",
            "solution": "目标是计算在一个包含 $N$ 次妊娠的队列中，患有症状性先天性巨细胞病毒 (CMV) 的新生儿的期望数量。问题要求从基本定义开始推导。\n\n设 $N = 20{,}000$ 为队列中完成妊娠的总数。问题假设每次妊娠的结果是独立同分布的事件。\n\n对于单次妊娠，我们定义以下事件序列：\n1.  设 $M$ 为母亲在孕期内发生原发性CMV感染的事件。\n2.  设 $T$ 为病毒从母亲垂直传播给胎儿的事件。\n3.  设 $S$ 为新生儿出生时患有症状性先天性CMV的事件。\n\n问题提供了以下概率：\n- 母体感染的概率：$P(M) = 0.05$。\n- 在母体感染的情况下，垂直传播的条件概率：$P(T|M) = 0.4$。\n- 垂直感染的新生儿出生时有症状的条件概率。一个“垂直感染的新生儿”是指事件 $T$ 发生的个体。因此，这是在给定 $T$ 的情况下 $S$ 的条件概率：$P(S|T) = 0.1$。\n\n要使新生儿出生时患有症状性先天性CMV（事件 $S$），必须发生垂直传播（事件 $T$），而这又要求母亲在孕期内被感染（事件 $M$）。这建立了一个必要条件的逻辑链：$S \\implies T \\implies M$。用集合论的语言来说，这意味着这些事件集合是嵌套的：$S \\subseteq T \\subseteq M$。\n\n我们的首要目标是计算从该队列中随机选择的单个新生儿出生时患有症状性先天性CMV的概率 $p_{symptomatic}$。这就是事件 $S$ 的概率，即 $p_{symptomatic} = P(S)$。\n\n我们使用概率的链式法则，它源于条件概率的基本定义 $P(A|B) = \\frac{P(A \\cap B)}{P(B)}$。\n这三个事件的联合概率是 $P(S \\cap T \\cap M)$。因为 $S \\subseteq T \\subseteq M$，这三个事件的交集就是最具体的事件 $S$。因此，$P(S \\cap T \\cap M) = P(S)$。\n\n使用链式法则，我们可以将此联合概率表示为：\n$$P(S \\cap T \\cap M) = P(S | T \\cap M) P(T | M) P(M)$$\n由于 $T \\subseteq M$，交集 $T \\cap M$ 与事件 $T$ 相同。该表达式简化为：\n$$P(S) = P(S | T) P(T | M) P(M)$$\n此表达式给出了新生儿出生时患有症状性先天性CMV的总概率。我们现在可以代入给定值：\n$$p_{symptomatic} = P(S) = (0.1) \\times (0.4) \\times (0.05)$$\n$$p_{symptomatic} = 0.04 \\times 0.05 = 0.002$$\n所以，任何单个新生儿有症状的概率是 $0.002$。\n\n接下来，我们计算在 $N = 20{,}000$ 次妊娠的队列中，有症状新生儿的总期望数量。设 $X$ 是表示这个总数的随机变量。为此，根据问题要求，我们为每次妊娠定义一个指示随机变量。\n\n对于每次妊娠 $i \\in \\{1, 2, \\dots, N\\}$，设 $X_i$ 为一个指示变量，使得：\n$$\nX_i =\n\\begin{cases}\n1  \\text{如果第 } i\\text{ 个新生儿出生时患有症状性先天性CMV} \\\\\n0  \\text{其他情况}\n\\end{cases}\n$$\n有症状新生儿的总数 $X$ 是这些指示变量的和：\n$$X = \\sum_{i=1}^{N} X_i$$\n为了求期望数量，我们计算 $X$ 的期望 $E[X]$。根据期望的线性性质，随机变量之和的期望等于它们各自期望的和：\n$$E[X] = E\\left[\\sum_{i=1}^{N} X_i\\right] = \\sum_{i=1}^{N} E[X_i]$$\n根据定义，指示变量 $X_i$ 的期望是它所指示事件的概率：\n$$E[X_i] = (1 \\times P(X_i=1)) + (0 \\times P(X_i=0)) = P(X_i=1)$$\n事件 $X_i=1$ 是指第 $i$ 个新生儿有症状。由于假设所有妊娠的风险相同，这个概率对所有的 $i$ 都一样，并且等于我们之前计算出的值：\n$$P(X_i=1) = p_{symptomatic} = 0.002$$\n因此，对于所有的 $i=1, \\dots, N$，都有 $E[X_i] = 0.002$。\n\n将此代回 $E[X]$ 的求和式中：\n$$E[X] = \\sum_{i=1}^{N} p_{symptomatic} = N \\times p_{symptomatic}$$\n最后，我们计算数值：\n$$E[X] = 20{,}000 \\times 0.002$$\n$$E[X] = 20{,}000 \\times \\frac{2}{1000} = 20 \\times 2 = 40$$\n因此，该队列中出生时患有症状性先天性CMV的新生儿的期望数量是 $40$。",
            "answer": "$$\\boxed{40}$$"
        },
        {
            "introduction": "从群体估算转向个体诊断，我们必须认识到阳性测试结果并非最终诊断，尤其是在低患病率情况下。本练习应用贝叶斯框架来计算假阳性结果的后验概率，强调了先验概率和检测特异性（包括交叉反应等复杂因素）对诊断准确性的决定性影响 。掌握这一技能对于在临床中做出明智决策至关重要。",
            "id": "4635076",
            "problem": "对 Toxoplasmosis、Other (包括 Syphilis)、Rubella、Cytomegalovirus 和 Herpes simplex virus (TORCH) 组引起的先天性感染进行产前诊断，关键在于在低预检概率的背景下正确解读血清学检测结果。考虑一个已接种疫苗的孕妇人群，在就诊时急性 Rubella 感染的时点患病率为 $p = 8 \\times 10^{-4}$。一种用于 Rubella 免疫球蛋白 M (IgM) 的标准酶免疫测定法，其灵敏度为 $\\text{Se} = 0.92$，特异度为 $\\text{Sp} = 0.985$。然而，在一个患病率为 $q = 0.015$ 的孕妇亚组中，个体同时患有急性 parvovirus B19 感染，对于这些个体，即使在没有急性 Rubella 感染的情况下，Rubella IgM 检测也会因交叉反应而呈现阳性，其概率为 $r = 0.10$。假设在没有急性 Rubella 感染的条件下，检测的基线假阳性和 parvovirus 交叉反应是相互独立的事件，并且检测性能（$\\text{Se}$ 和 $\\text{Sp}$）在各亚组之间保持稳定。使用灵敏度、特异度、患病率和条件概率的核心定义，计算一个阳性的 Rubella IgM 结果并不代表真正存在急性 Rubella 感染的后验概率（即，在检测结果为阳性的条件下，该结果为假阳性的概率）。请将您的答案以小数形式表示，并四舍五入至四位有效数字。",
            "solution": "目标是计算在检测结果为阳性的条件下，一个人没有患急性 Rubella 感染的后验概率。我们可以使用条件概率表示法将其形式化。\n\n我们定义以下事件：\n- $R$：一个人患有急性 Rubella 感染的事件。\n- $R^c$：一个人没有患急性 Rubella 感染的事件。\n- $T^+$：Rubella IgM 检测结果为阳性的事件。\n- $V$：一个人同时患有急性 parvovirus B19 感染的事件。\n\n根据问题陈述，我们已知以下概率：\n- Rubella 的患病率为 $P(R) = p = 8 \\times 10^{-4}$。\n- Parvovirus B19 的患病率为 $P(V) = q = 0.015$。\n- 检测的灵敏度为 $P(T^+|R) = \\text{Se} = 0.92$。\n- 检测的基线特异度为 $P(T^-|R^c \\text{ and not subject to cross-reactivity}) = \\text{Sp} = 0.985$。相应的基线假阳性率为 $1 - \\text{Sp} = 0.015$。\n- 在患有 parvovirus B19 但没有 Rubella 的人中，由于交叉反应导致检测呈阳性的概率为 $P(T^+|R^c \\cap V)=r=0.10$。问题中的措辞“交叉反应阳性概率为 $r = 0.10$”和指令“基线检测假阳性与 parvovirus 交叉反应相互独立”澄清了这是两个独立的假阳性机制。\n\n我们要求解 $P(R^c|T^+)$。使用 Bayes' theorem：\n$$P(R^c|T^+) = \\frac{P(T^+|R^c)P(R^c)}{P(T^+)}$$\n分母 $P(T^+)$ 可以使用全概率定律展开：\n$$P(T^+) = P(T^+|R)P(R) + P(T^+|R^c)P(R^c)$$\n因此，我们所求概率的表达式变为：\n$$P(R^c|T^+) = \\frac{P(T^+|R^c)P(R^c)}{P(T^+|R)P(R) + P(T^+|R^c)P(R^c)}$$\n\n我们有 $P(R) = p$，所以 $P(R^c) = 1 - p$。我们还有 $P(T^+|R) = \\text{Se}$。需要计算的关键项是 $P(T^+|R^c)$，即在没有 Rubella 的人中检测呈阳性的总概率。这个概率受是否存在 parvovirus B19 的影响。我们使用全概率定律，以是否存在 parvovirus ($V$) 为条件：\n$$P(T^+|R^c) = P(T^+|R^c \\cap V)P(V|R^c) + P(T^+|R^c \\cap V^c)P(V^c|R^c)$$\n我们假设 Rubella 和 parvovirus 的患病率是独立的，因此 $P(V|R^c) = P(V) = q$ 且 $P(V^c|R^c) = P(V^c) = 1-q$。\n\n1.  计算 $P(T^+|R^c \\cap V^c)$：这是在没有 Rubella 和没有 parvovirus 的情况下，检测呈阳性的概率。在这种情况下，阳性结果只能由检测的基线假阳性导致。\n    $$P(T^+|R^c \\cap V^c) = 1 - \\text{Sp}$$\n\n2.  计算 $P(T^+|R^c \\cap V)$：这是在没有 Rubella 但有 parvovirus 的情况下，检测呈阳性的概率。阳性结果可能来自基线假阳性机制或 parvovirus 交叉反应。设 $A$ 为基线假阳性事件，其概率为 $P(A) = 1 - \\text{Sp}$。设 $B$ 为由 parvovirus 引起的交叉反应阳性事件，其概率为 $P(B) = r = 0.10$。问题陈述这些事件是独立的。它们中至少有一个发生的概率是 $1 - P(A^c \\cap B^c) = 1 - P(A^c)P(B^c)$。\n    $P(A^c) = \\text{Sp}$（无基线假阳性）且 $P(B^c) = 1-r$（无交叉反应假阳性）。\n    因此，$P(T^+|R^c \\cap V) = 1 - \\text{Sp}(1-r)$。\n\n现在，将这些代回 $P(T^+|R^c)$ 的表达式中：\n$$P(T^+|R^c) = [1 - \\text{Sp}(1-r)]q + (1-\\text{Sp})(1-q)$$\n$$P(T^+|R^c) = q - q\\text{Sp}(1-r) + (1-\\text{Sp}) - q(1-\\text{Sp})$$\n$$P(T^+|R^c) = q - q\\text{Sp} + qr\\text{Sp} + 1 - \\text{Sp} - q + q\\text{Sp}$$\n$$P(T^+|R^c) = 1 - \\text{Sp} + qr\\text{Sp} = (1 - \\text{Sp}) + qr\\text{Sp}$$\n\n现在我们可以计算各部分的数值了。\n- $p = 8 \\times 10^{-4} = 0.0008$\n- $P(R^c) = 1 - p = 1 - 0.0008 = 0.9992$\n- $\\text{Se} = 0.92$\n- $\\text{Sp} = 0.985$\n- $q = 0.015$\n- $r = 0.10$\n\n计算总假阳性率 $P(T^+|R^c)$：\n$$P(T^+|R^c) = (1 - 0.985) + (0.015)(0.10)(0.985)$$\n$$P(T^+|R^c) = 0.015 + (0.0015)(0.985)$$\n$$P(T^+|R^c) = 0.015 + 0.0014775 = 0.0164775$$\n\n现在，我们可以计算 Bayes' theorem 的各项：\n- 人群中真阳性结果的概率：\n  $P(T^+ \\cap R) = P(T^+|R)P(R) = \\text{Se} \\cdot p = 0.92 \\times 0.0008 = 0.000736$\n- 人群中假阳性结果的概率：\n  $P(T^+ \\cap R^c) = P(T^+|R^c)P(R^c) = 0.0164775 \\times 0.9992 = 0.0164643192$\n\n检测结果为阳性的总概率是这两个概率之和：\n$$P(T^+) = P(T^+ \\cap R) + P(T^+ \\cap R^c) = 0.000736 + 0.0164643192 = 0.0172003192$$\n\n最后，所求的后验概率是假阳性结果的概率与检测结果为阳性的总概率之比：\n$$P(R^c|T^+) = \\frac{P(T^+ \\cap R^c)}{P(T^+)} = \\frac{0.0164643192}{0.0172003192} \\approx 0.9572099$$\n\n四舍五入到四位有效数字，结果是 $0.9572$。这意味着，在该人群中，如果检测结果为阳性，患者实际上没有急性 Rubella 感染的几率约为 $95.72\\%$。",
            "answer": "$$\\boxed{0.9572}$$"
        },
        {
            "introduction": "在确定了健康威胁并能够进行诊断后，下一个问题是评估我们干预措施的有效性。本练习介绍了“需治数”(NNT)，这是一个关键指标，它将风险降低转化为公共卫生投入的可衡量标准。通过计算NNT，我们可以更清晰地权衡干预措施的益处与其成本和潜在风险 。",
            "id": "4635072",
            "problem": "一个围产期质量改进团队正在评估使用青霉素进行普遍性产时抗生素预防，以预防新生儿早发性B群链球菌（GBS）病。在一个没有进行预防的参考人群中，早发性GBS病的发病率为每$1{,}000$例活产$0.5$例。良好对照的试验表明，与不进行预防相比，产时使用青霉素可使早发性GBS病的相对风险降低$0.8$。\n\n假设所有分娩的基线风险是同质的，产时抗生素预防（IAP）的识别和实施是完美的，并且干预措施不改变分娩数量。仅使用发病率作为每次分娩事件发生的概率和相对风险降低作为干预导致风险按比例减少的基本定义，确定为预防一例早发性GBS病而需用产时青霉素治疗的人数（NNT）。\n\n将最终的NNT表示为一个纯数字（无单位）。除非必要，否则不要四舍五入；如果需要四舍五入，请使用有效数字。",
            "solution": "目标是计算需治数（NNT），其定义为为预防一个额外不良结局所需治疗的平均患者数。它是绝对风险降低（ARR）的倒数。\n\n设$I_0$为未治疗（对照）人群中的疾病发病率，$I_t$为治疗（干预）人群中的发病率。在此背景下，发病率被用作风险的度量。\n\n根据已知条件，未暴露（未治疗）人群的发病率为：\n$$I_0 = \\frac{0.5}{1000} = 0.0005$$\n\n相对风险降低（RRR）是治疗组相对于对照组风险的比例降低。其定义为：\n$$RRR = \\frac{I_0 - I_t}{I_0}$$\n已知 $RRR = 0.8$。\n\n绝对风险降低（ARR）是对照组和治疗组之间风险的绝对差异。其定义为：\n$$ARR = I_0 - I_t$$\n\n需治数（NNT）是ARR的倒数：\n$$NNT = \\frac{1}{ARR}$$\n\n为了求NNT，我们必须首先计算ARR。我们可以用给定的量$I_0$和$RRR$来表示ARR。通过重新整理RRR的定义，我们得到：\n$$I_0 - I_t = RRR \\times I_0$$\n该等式的左边是ARR的定义。因此：\n$$ARR = RRR \\times I_0$$\n\n现在，我们将给定的值代入此方程：\n$$ARR = 0.8 \\times 0.0005$$\n$$ARR = 0.0004$$\n\n最后，我们使用其定义计算NNT：\n$$NNT = \\frac{1}{ARR} = \\frac{1}{0.0004}$$\n为简化此分数：\n$$NNT = \\frac{1}{\\frac{4}{10000}} = \\frac{10000}{4}$$\n$$NNT = 2500$$\n\n因此，在问题规定的理想化条件下，每对$2500$名母亲进行产时青霉素预防，就能预防一例早发性GBS病。结果是一个精确的整数。",
            "answer": "$$\\boxed{2500}$$"
        }
    ]
}