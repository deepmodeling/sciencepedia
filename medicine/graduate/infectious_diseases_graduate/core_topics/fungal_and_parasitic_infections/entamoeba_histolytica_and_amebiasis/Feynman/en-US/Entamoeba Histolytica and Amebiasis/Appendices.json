{
    "hands_on_practices": [
        {
            "introduction": "Accurately measuring the incidence of a disease is a cornerstone of public health surveillance and epidemiology. However, diagnostic tests are rarely perfect, leading to misclassification that can bias our estimates of disease burden. This exercise  challenges you to move beyond simply using a test to critically evaluating its population-level impact by deriving a formula to correct the observed incidence for the known sensitivity and specificity of an assay.",
            "id": "4628273",
            "problem": "A rural clinic conducts surveillance for amebic colitis caused by Entamoeba histolytica using a stool antigen capture assay. Microscopic examination cannot reliably distinguish Entamoeba histolytica from Entamoeba dispar, and cross-reactivity can produce false positives in individuals colonized with Entamoeba dispar. The antigen capture assay has constant sensitivity $Se$ and specificity $Sp$ for detecting true amebic colitis due to Entamoeba histolytica, as validated against a polymerase chain reaction (PCR) reference.\n\nIn a closed cohort monitored over a fixed surveillance interval, everyone is tested once during the interval, and the crude test-positive proportion is recorded. Let $r_{\\text{obs}}$ denote the observed fraction testing positive during the interval. Let $I_{\\text{true}}$ denote the true incidence proportion of amebic colitis due to Entamoeba histolytica during that interval (that is, the probability that a randomly selected cohort member truly had amebic colitis in the interval, irrespective of test result).\n\nUsing only the definitions of sensitivity and specificity and Bayes’ theorem, derive a closed-form expression for $I_{\\text{true}}$ in terms of $r_{\\text{obs}}$, $Se$, and $Sp$. Clearly state any assumptions you make. Provide your final answer as a single analytic expression. No rounding is required. The answer should be expressed as a dimensionless proportion.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of medical epidemiology and microbiology, is mathematically well-posed, and uses objective, unambiguous terminology. It is a formalizable problem with a unique, meaningful solution derivable from the provided information.\n\nThe objective is to derive an expression for the true incidence proportion, $I_{\\text{true}}$, in terms of the observed proportion of positive tests, $r_{\\text{obs}}$, the test sensitivity, $Se$, and the test specificity, $Sp$.\n\nLet $D$ be the event that a randomly selected individual from the cohort truly has amebic colitis during the surveillance interval. Let $T^+$ be the event that this individual tests positive with the antigen capture assay. The complementary events are $D^c$ (no disease) and $T^-$ (negative test).\n\nFrom the problem statement, we define the given quantities in terms of probabilities:\n- The true incidence proportion is the probability of having the disease: $I_{\\text{true}} = P(D)$.\n- The observed fraction testing positive is the probability of a positive test: $r_{\\text{obs}} = P(T^+)$.\n- The sensitivity ($Se$) is the conditional probability of a positive test given the presence of disease: $Se = P(T^+ | D)$.\n- The specificity ($Sp$) is the conditional probability of a negative test given the absence of disease: $Sp = P(T^- | D^c)$.\n\nOur derivation will use the law of total probability, which is a fundamental component of Bayes' theorem. The overall probability of an event (in this case, a positive test) can be found by summing its probabilities conditioned on a set of mutually exclusive and exhaustive events (in this case, having the disease or not having the disease).\n\nThe probability of a positive test, $P(T^+)$, can be expressed as:\n$$P(T^+) = P(T^+ \\cap D) + P(T^+ \\cap D^c)$$\nUsing the definition of conditional probability, $P(A \\cap B) = P(A|B)P(B)$, we can rewrite this as:\n$$P(T^+) = P(T^+ | D)P(D) + P(T^+ | D^c)P(D^c)$$\n\nWe can now substitute the defined terms into this equation. We have $P(T^+) = r_{\\text{obs}}$, $P(D) = I_{\\text{true}}$, and $P(T^+ | D) = Se$. We must also express the terms $P(D^c)$ and $P(T^+ | D^c)$ using the given information.\n\nThe probability of not having the disease is the complement of having the disease:\n$$P(D^c) = 1 - P(D) = 1 - I_{\\text{true}}$$\n\nThe term $P(T^+ | D^c)$ is the probability of a positive test given the absence of disease, which is the false positive rate. It can be derived from the specificity, $Sp$. Since a non-diseased individual must either test positive or negative, the probabilities must sum to $1$:\n$$P(T^+ | D^c) + P(T^- | D^c) = 1$$\nSubstituting $Sp = P(T^- | D^c)$, we get:\n$$P(T^+ | D^c) = 1 - Sp$$\n\nNow, we substitute all these expressions back into the law of total probability equation:\n$$r_{\\text{obs}} = (Se)(I_{\\text{true}}) + (1 - Sp)(1 - I_{\\text{true}})$$\n\nThis equation provides a relationship between the observed quantity $r_{\\text{obs}}$ and the quantity of interest $I_{\\text{true}}$. The next step is to algebraically solve for $I_{\\text{true}}$.\nFirst, we expand the right-hand side of the equation:\n$$r_{\\text{obs}} = Se \\cdot I_{\\text{true}} + 1 - Sp - (1 - Sp) \\cdot I_{\\text{true}}$$\n\nNext, we collect all terms involving $I_{\\text{true}}$ on one side of the equation:\n$$r_{\\text{obs}} - (1 - Sp) = Se \\cdot I_{\\text{true}} - (1 - Sp) \\cdot I_{\\text{true}}$$\n$$r_{\\text{obs}} - 1 + Sp = I_{\\text{true}} (Se - (1 - Sp))$$\n$$r_{\\text{obs}} + Sp - 1 = I_{\\text{true}} (Se + Sp - 1)$$\n\nFinally, we isolate $I_{\\text{true}}$ by dividing by its coefficient:\n$$I_{\\text{true}} = \\frac{r_{\\text{obs}} + Sp - 1}{Se + Sp - 1}$$\n\nThis is the desired closed-form expression for the true incidence proportion. This formula is commonly known in epidemiology as the Rogan-Gladen estimator.\n\nThe primary assumption required for this expression to be valid and meaningful is that the denominator is non-zero, i.e., $Se + Sp - 1 \\neq 0$. If $Se + Sp = 1$, the test is non-informative (its positive likelihood ratio is $1$), meaning it performs no better than random chance, and thus the true incidence cannot be determined from the observed test results. The problem setup implies a useful diagnostic test, so this assumption is implicitly met.",
            "answer": "$$\\boxed{\\frac{r_{\\text{obs}} + Sp - 1}{Se + Sp - 1}}$$"
        },
        {
            "introduction": "Understanding the molecular basis of pathogenesis often involves comparing the virulence of different microbial strains in experimental models, a central activity in infectious disease research. In this practice , you will analyze hypothetical survival data from animal cohorts infected with wild-type versus genetically modified *E. histolytica*. By applying Kaplan-Meier estimation and the log-rank test, you will learn to rigorously quantify differences in survival outcomes, a core biostatistical skill.",
            "id": "4628274",
            "problem": "You are provided with right-censored survival data from animal cohorts infected with wild-type (WT) versus lectin-silenced (LS) strains of Entamoeba histolytica. The task is to rigorously analyze differences in survival between the two groups using non-parametric survival analysis, grounded in first principles.\n\nUse the following foundational base from survival analysis:\n\n- The survival function $S(t)$ is defined as the probability that a non-negative time-to-event random variable $T$ exceeds time $t$, i.e., $S(t) = \\mathbb{P}(T > t)$.\n- Right-censoring is permitted and assumed to be non-informative: if an observation is censored at time $t$, it contributes to the risk set up to $t$ but does not directly determine an event at $t$.\n- Under the null hypothesis of equal survival, the survival functions for two groups satisfy $S_1(t) = S_2(t)$ for all $t$, where group $1$ is WT and group $2$ is LS.\n\nDerive, implement, and apply a Kaplan–Meier (KM) analysis to estimate the survival function for each group, and compute the median survival time as the smallest time $t$ for which the estimated survival function satisfies $S(t) \\le 0.5$. Then, implement the log-rank test to evaluate whether the survival experiences of the two groups differ, based on comparing observed and expected event counts at each distinct event time under the null hypothesis that $S_1(t) = S_2(t)$ for all $t$. You must treat tied event times correctly and account for censoring in the risk sets at each event time. If the median survival is undefined because the estimated survival function never drops to $0.5$, output $-1$ for that median.\n\nAll survival times must be treated in days, and any reported time should be expressed in days. The log-rank test statistic and its associated tail probability must be dimensionless. Express tail probabilities (p-values) as decimals (not with a percentage sign).\n\nImplement a program that, for each test case, outputs a list containing four values: the log-rank chi-square statistic, the log-rank p-value, the WT median survival in days, and the LS median survival in days. Round all four values to $4$ decimal places.\n\nYour program must use the following test suite. Each test case consists of two arrays: survival times in days and corresponding event indicators (where an event indicator equals $1$ for death and equals $0$ for right-censoring). The arrays for WT and LS are aligned only by membership; there is no pairing between the two groups.\n\n- Test case $1$ (clear difference: WT more virulent, LS less virulent):\n  - WT times: $[3,5,6,7,9,9,12,15]$\n  - WT events: $[1,1,1,1,1,0,1,0]$\n  - LS times: $[5,10,12,14,16,18,20,25]$\n  - LS events: $[1,0,1,1,0,1,1,0]$\n\n- Test case $2$ (no difference: identical survival experience):\n  - WT times: $[4,8,10,10,12,14]$\n  - WT events: $[1,1,0,1,0,1]$\n  - LS times: $[4,8,10,10,12,14]$\n  - LS events: $[1,1,0,1,0,1]$\n\n- Test case $3$ (boundary conditions: many ties and substantial censoring):\n  - WT times: $[2,2,4,4,6,8]$\n  - WT events: $[1,0,1,0,1,0]$\n  - LS times: $[2,3,4,4,6,8,10]$\n  - LS events: $[0,1,0,1,0,1,0]$\n\nFinal output format requirement:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[result_1,result_2,result_3]$). Each $result_i$ must itself be a list of the form $[\\chi^2, p, m_{\\mathrm{WT}}, m_{\\mathrm{LS}}]$, where $\\chi^2$ is the log-rank chi-square statistic, $p$ is the associated p-value, $m_{\\mathrm{WT}}$ is the WT median survival in days, and $m_{\\mathrm{LS}}$ is the LS median survival in days. All numeric values must be rounded to $4$ decimal places. The output must contain no text other than this single bracketed list.",
            "solution": "The problem requires survival analysis for two groups under right-censoring: wild-type (WT) versus lectin-silenced (LS) strains of Entamoeba histolytica. We connect biological context and statistical derivation with two tools: the Kaplan–Meier (KM) estimator and the log-rank test (LRT), deriving both from first principles in survival analysis.\n\nFundamental definitions:\n- Let $T$ be a non-negative random variable representing time-to-event (death), and $S(t) = \\mathbb{P}(T > t)$ the survival function. We observe right-censored data: for some subjects, we only know they survived up to time $t$ but did not experience the event before $t$.\n- Censoring is assumed non-informative: the distribution of $T$ among censored subjects is the same as among uncensored subjects, conditional on having survived up to the censoring time.\n\nKaplan–Meier estimator derivation:\n- Consider distinct, ordered times $\\{t_1, t_2, \\dots, t_J\\}$ at which events occur in a given group. Let $n_j$ be the number at risk immediately prior to $t_j$, and let $d_j$ be the number of events occurring at time $t_j$. Right-censored observations at $t_j$ are removed from the risk set after accounting for events at $t_j$.\n- The Kaplan–Meier (KM) estimator, also known as the product-limit estimator, is given by\n$$\n\\hat{S}(t) = \\prod_{t_j \\le t} \\left(1 - \\frac{d_j}{n_j}\\right).\n$$\nThis estimator follows from viewing survival as the multiplicative complement of conditional failure probabilities at each event time, assuming independent, non-informative censoring.\n- Algorithmically, to compute $\\hat{S}(t)$ over time:\n  1. Sort all observed times (events and censors) for the group.\n  2. Initialize $\\hat{S}(t_0) = 1$ and $n$ as the total number of subjects.\n  3. At each distinct time $t$:\n     - Compute $d$ as the count of events at $t$ and $c$ as the count of censors at $t$.\n     - If $d > 0$, update $\\hat{S}(t) \\leftarrow \\hat{S}(t^{-}) \\cdot \\left(1 - \\frac{d}{n}\\right)$, where $t^{-}$ denotes the instant just before $t$.\n     - Update the risk set $n \\leftarrow n - d - c$.\n  4. The median survival time $\\hat{m}$ is the smallest $t$ such that $\\hat{S}(t) \\le 0.5$. If $\\hat{S}(t) > 0.5$ for all observed times, define $\\hat{m} = -1$.\n\nLog-rank test derivation:\n- The log-rank test (LRT) evaluates the null hypothesis $H_0: S_1(t) = S_2(t)$ for all $t$ against the alternative that the survival functions differ at some $t$. It aggregates deviations between observed and expected event counts across all distinct event times, weighting by the inverse variance under $H_0$.\n- At each distinct pooled event time $t_j$ across both groups, define:\n  - $n_{1j}$ and $n_{2j}$ as the numbers at risk in group $1$ and group $2$ immediately prior to $t_j$.\n  - $d_{1j}$ and $d_{2j}$ as the numbers of events at $t_j$ in each group.\n  - Totals $n_j = n_{1j} + n_{2j}$ and $d_j = d_{1j} + d_{2j}$.\n- Under $H_0$, the expected number of events in group $1$ at $t_j$ is\n$$\ne_{1j} = d_j \\cdot \\frac{n_{1j}}{n_j},\n$$\nand the variance of the difference $d_{1j} - e_{1j}$ is, under the hypergeometric sampling model,\n$$\nv_{1j} = \\frac{n_{1j} n_{2j} d_j (n_j - d_j)}{n_j^2 (n_j - 1)}.\n$$\n- Aggregate over event times:\n$$\nZ = \\sum_{j} (d_{1j} - e_{1j}), \\quad V = \\sum_{j} v_{1j}.\n$$\n- The log-rank chi-square statistic is\n$$\n\\chi^2 = \\begin{cases}\n\\frac{Z^2}{V}, & V > 0, \\\\\n0, & V = 0,\n\\end{cases}\n$$\nwith an approximate chi-square distribution with $1$ degree of freedom under $H_0$. The p-value is $p = 1 - F_{\\chi^2_1}(\\chi^2)$, where $F_{\\chi^2_1}$ is the cumulative distribution function of the chi-square distribution with $1$ degree of freedom.\n- Practical notes:\n  - Censors at time $t$ are in the risk set at $t$ (they are known to have survived up to $t$) but contribute $d_{gj} = 0$; they are removed from the risk set immediately after $t$.\n  - If a time has $n_j \\le 1$, then $v_{1j}$ is taken as $0$ to avoid division by zero; if $V = 0$ after aggregation, set $\\chi^2 = 0$ and $p = 1$.\n\nAlgorithmic plan:\n- For each group, compute the KM step function and identify the median $\\hat{m}$ as the earliest time $t$ with $\\hat{S}(t) \\le 0.5$, or $-1$ if not achieved.\n- For the log-rank test, pool distinct event times across both groups, compute $n_{1j}, n_{2j}, d_{1j}, d_{2j}$ at each $t_j$, aggregate $Z$ and $V$, then compute $\\chi^2$ and $p$.\n- Apply the above to all test cases, and output a single line containing a list of four-tuples $[\\chi^2, p, m_{\\mathrm{WT}}, m_{\\mathrm{LS}}]$, rounded to $4$ decimal places, in the specified format.\n\nEdge cases in the provided test suite:\n- Test case $1$ demonstrates clear group differences (WT events earlier and more frequent).\n- Test case $2$ has identical data across groups, so $\\chi^2$ should be near $0$ and $p$ near $1$, with equal medians.\n- Test case $3$ includes many ties and substantial censoring, exercising correct handling of risk sets and variance accumulation.\n\nAll median survival outputs must be in days, and all outputs must be rounded to $4$ decimal places as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2\n\ndef km_median(times, events):\n    \"\"\"\n    Compute the Kaplan–Meier survival step function and return the median survival time.\n    times: list or array of survival times (days)\n    events: list or array of event indicators (1=death, 0=censored)\n    Returns median survival time (days); -1 if survival never drops to 0.5.\n    \"\"\"\n    times = np.array(times, dtype=float)\n    events = np.array(events, dtype=int)\n\n    # Sort unique times (include both events and censors for risk set updates)\n    unique_times = np.unique(times)\n\n    # Precompute counts at each time\n    # d(t): number of events at time t\n    # c(t): number of censors at time t\n    d_counts = {}\n    c_counts = {}\n    for t in unique_times:\n        at_t = (times == t)\n        d_counts[t] = int(np.sum(at_t & (events == 1)))\n        c_counts[t] = int(np.sum(at_t & (events == 0)))\n\n    n = len(times)\n    S = 1.0\n    # Record survival steps only when an event occurs (since censoring does not change S)\n    step_times = []\n    step_surv = []\n\n    for t in unique_times:\n        d = d_counts[t]\n        c = c_counts[t]\n        if n <= 0:\n            break\n        if d > 0:\n            S *= (n - d) / n\n            step_times.append(t)\n            step_surv.append(S)\n        # Update risk set after accounting for events and censors at t\n        n -= (d + c)\n\n    # Determine median survival: earliest time where S <= 0.5\n    median = -1.0\n    for t, s in zip(step_times, step_surv):\n        if s <= 0.5:\n            median = float(t)\n            break\n    return median\n\ndef logrank_test(times1, events1, times2, events2):\n    \"\"\"\n    Compute the log-rank test statistic and p-value comparing two groups.\n    Returns (chi_square_stat, p_value).\n    \"\"\"\n    times1 = np.array(times1, dtype=float)\n    events1 = np.array(events1, dtype=int)\n    times2 = np.array(times2, dtype=float)\n    events2 = np.array(events2, dtype=int)\n\n    # Distinct pooled event times across both groups\n    event_times1 = np.unique(times1[events1 == 1])\n    event_times2 = np.unique(times2[events2 == 1])\n    pooled_event_times = np.unique(np.concatenate([event_times1, event_times2]))\n    pooled_event_times.sort()\n\n    Z = 0.0\n    V = 0.0\n\n    for t in pooled_event_times:\n        # Number at risk just prior to t (include those with time == t)\n        n1 = int(np.sum(times1 >= t))\n        n2 = int(np.sum(times2 >= t))\n        n = n1 + n2\n\n        # Number of events at t\n        d1 = int(np.sum((times1 == t) & (events1 == 1)))\n        d2 = int(np.sum((times2 == t) & (events2 == 1)))\n        d = d1 + d2\n\n        if n == 0 or d == 0:\n            # No risk or no events; skip (pooled_event_times ensures d > 0 typically)\n            continue\n\n        e1 = d * (n1 / n)\n        # Variance under hypergeometric sampling; guard against division by zero\n        if n > 1:\n            v1 = (n1 * n2 * d * (n - d)) / (n**2 * (n - 1))\n        else:\n            v1 = 0.0\n\n        Z += (d1 - e1)\n        V += v1\n\n    if V > 0.0:\n        chi_sq = (Z ** 2) / V\n        p_val = 1.0 - chi2.cdf(chi_sq, df=1)\n    else:\n        chi_sq = 0.0\n        p_val = 1.0\n\n    return chi_sq, p_val\n\ndef format_no_spaces(obj):\n    \"\"\"\n    Convert a Python list or number into a string without spaces, with default repr for numbers.\n    \"\"\"\n    if isinstance(obj, list):\n        return '[' + ','.join(format_no_spaces(x) for x in obj) + ']'\n    elif isinstance(obj, float):\n        # Ensure standard float string without spaces\n        return str(obj)\n    elif isinstance(obj, int):\n        return str(obj)\n    else:\n        return str(obj)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (WT_times, WT_events, LS_times, LS_events)\n    test_cases = [\n        (\n            [3, 5, 6, 7, 9, 9, 12, 15],\n            [1, 1, 1, 1, 1, 0, 1, 0],\n            [5, 10, 12, 14, 16, 18, 20, 25],\n            [1, 0, 1, 1, 0, 1, 1, 0],\n        ),\n        (\n            [4, 8, 10, 10, 12, 14],\n            [1, 1, 0, 1, 0, 1],\n            [4, 8, 10, 10, 12, 14],\n            [1, 1, 0, 1, 0, 1],\n        ),\n        (\n            [2, 2, 4, 4, 6, 8],\n            [1, 0, 1, 0, 1, 0],\n            [2, 3, 4, 4, 6, 8, 10],\n            [0, 1, 0, 1, 0, 1, 0],\n        ),\n    ]\n\n    results = []\n    for wt_times, wt_events, ls_times, ls_events in test_cases:\n        # Log-rank test\n        chi_sq, p_val = logrank_test(wt_times, wt_events, ls_times, ls_events)\n        # Kaplan–Meier medians\n        m_wt = km_median(wt_times, wt_events)\n        m_ls = km_median(ls_times, ls_events)\n\n        # Round all outputs to 4 decimal places\n        chi_sq_r = round(float(chi_sq), 4)\n        p_val_r = round(float(p_val), 4)\n        m_wt_r = round(float(m_wt), 4)\n        m_ls_r = round(float(m_ls), 4)\n\n        results.append([chi_sq_r, p_val_r, m_wt_r, m_ls_r])\n\n    # Final print statement in the exact required format: single line, bracketed list, no spaces.\n    print(format_no_spaces(results))\n\nsolve()\n```"
        },
        {
            "introduction": "To grasp the full transmission dynamics of a parasite, it is powerful to translate its biological life cycle into a mathematical framework. This problem  guides you through constructing a compartmental model for *E. histolytica*, using a system of ordinary differential equations to represent its key stages from the environment to the host and back. This systems biology approach allows you to explore how different transition and loss rates govern the parasite's potential to sustain its life cycle.",
            "id": "4628262",
            "problem": "Amebiasis caused by Entamoeba histolytica proceeds through a life cycle with environmentally resistant cysts, ingestion of cysts by a host, excystation to trophozoites, encystation in the colon, and shedding of new cysts. Assume a single representative host interacting with a large environmental reservoir. Let the compartment variables be $C_{e}(t)$ for environmental cysts, $C_{u}(t)$ for ingested cysts present in the upper gastrointestinal tract (gastrointestinal, GI), $T(t)$ for trophozoites in the colon, and $C_{s}(t)$ for shed cysts within the host awaiting release to the environment. Assume first-order mass-action kinetics for all transitions and losses.\n\nDefine rate constants: $k_{\\mathrm{in}}$ for ingestion from environment to upper GI, $k_{\\mathrm{ex}}$ for excystation from upper GI cysts to colon trophozoites, $k_{\\mathrm{en}}$ for encystation from trophozoites to shed cysts, and $k_{\\mathrm{sh}}$ for shedding from shed cysts to the environment. Include first-order loss rates $\\delta_{e}$ (environmental cyst decay), $\\delta_{u}$ (upper GI cyst loss without excystation), $\\delta_{t}$ (trophozoite clearance or death), and $\\delta_{s}$ (loss of shed cysts before reaching the environment). Assume no external sources other than the host under study.\n\n1) Using these definitions and assuming linear, first-order transitions, write down the system of ordinary differential equations for $C_{e}(t)$, $C_{u}(t)$, $T(t)$, and $C_{s}(t)$.\n\n2) Under the low-density (linear) regime, define the expected number of environmental cysts ultimately produced per environmental cyst via one complete pass through the host life cycle as the product of step-wise probabilities that each forward transition occurs before its corresponding loss. Using the standard result for competing exponential hazards that if two independent processes with rates $a$ and $b$ compete, the probability that the process with rate $a$ occurs first is $a/(a+b)$, derive a closed-form expression for this expected number in terms of $k_{\\mathrm{in}},k_{\\mathrm{ex}},k_{\\mathrm{en}},k_{\\mathrm{sh}},\\delta_{e},\\delta_{u},\\delta_{t},\\delta_{s}$.\n\n3) Evaluate this expression numerically for the parameter values\n$$\nk_{\\mathrm{in}}=0.05\\ \\text{day}^{-1},\\quad \\delta_{e}=0.02\\ \\text{day}^{-1},\\quad\nk_{\\mathrm{ex}}=2.0\\ \\text{day}^{-1},\\quad \\delta_{u}=0.50\\ \\text{day}^{-1},\\quad\nk_{\\mathrm{en}}=1.0\\ \\text{day}^{-1},\\quad \\delta_{t}=0.30\\ \\text{day}^{-1},\\quad\nk_{\\mathrm{sh}}=0.50\\ \\text{day}^{-1},\\quad \\delta_{s}=0.20\\ \\text{day}^{-1}.\n$$\nExpress the final answer as a unitless decimal rounded to four significant figures.",
            "solution": "The problem statement has been validated and is deemed sound. It presents a clear, self-contained, and scientifically grounded exercise in compartmental modeling and probability theory as applied to parasitology. All necessary definitions, parameters, and assumptions are provided to formulate and solve the problem.\n\n### Part 1: System of Ordinary Differential Equations (ODEs)\n\nThe system of ODEs describes the rate of change of the population in each compartment. The rate of change for a given compartment is the sum of all influx rates minus the sum of all outflux rates. We apply the principle of first-order mass-action kinetics, where the rate of a process is proportional to the size of the source compartment.\n\n1.  **Environmental Cysts, $C_{e}(t)$**:\n    -   Influx: Cysts are shed from the host's \"shed cysts\" compartment, $C_{s}$, at a rate $k_{\\mathrm{sh}} C_{s}(t)$.\n    -   Outflux: Cysts are ingested by the host at a rate $k_{\\mathrm{in}} C_{e}(t)$.\n    -   Outflux: Cysts are lost due to environmental decay at a rate $\\delta_{e} C_{e}(t)$.\n    The resulting differential equation is:\n    $$ \\frac{dC_{e}}{dt} = k_{\\mathrm{sh}} C_{s} - k_{\\mathrm{in}} C_{e} - \\delta_{e} C_{e} = k_{\\mathrm{sh}} C_{s} - (k_{\\mathrm{in}} + \\delta_{e}) C_{e} $$\n\n2.  **Upper GI Cysts, $C_{u}(t)$**:\n    -   Influx: Cysts are ingested from the environment, $C_e$, at a rate $k_{\\mathrm{in}} C_{e}(t)$.\n    -   Outflux: Cysts undergo excystation to become trophozoites, $T$, at a rate $k_{\\mathrm{ex}} C_{u}(t)$.\n    -   Outflux: Cysts are lost from the upper GI tract without excysting at a rate $\\delta_{u} C_{u}(t)$.\n    The resulting differential equation is:\n    $$ \\frac{dC_{u}}{dt} = k_{\\mathrm{in}} C_{e} - k_{\\mathrm{ex}} C_{u} - \\delta_{u} C_{u} = k_{\\mathrm{in}} C_{e} - (k_{\\mathrm{ex}} + \\delta_{u}) C_{u} $$\n\n3.  **Colon Trophozoites, $T(t)$**:\n    -   Influx: Trophozoites arise from the excystation of upper GI cysts, $C_u$, at a rate $k_{\\mathrm{ex}} C_{u}(t)$. The problem does not specify any replication of trophozoites, so no self-promoting term is included.\n    -   Outflux: Trophozoites undergo encystation to become shed cysts, $C_s$, at a rate $k_{\\mathrm{en}} T(t)$.\n    -   Outflux: Trophozoites are cleared or die at a rate $\\delta_{t} T(t)$.\n    The resulting differential equation is:\n    $$ \\frac{dT}{dt} = k_{\\mathrm{ex}} C_{u} - k_{\\mathrm{en}} T - \\delta_{t} T = k_{\\mathrm{ex}} C_{u} - (k_{\\mathrm{en}} + \\delta_{t}) T $$\n\n4.  **Shed Cysts, $C_{s}(t)$**:\n    -   Influx: Shed cysts are formed by the encystation of trophozoites, $T$, at a rate $k_{\\mathrm{en}} T(t)$.\n    -   Outflux: Cysts are shed into the environment, $C_e$, at a rate $k_{\\mathrm{sh}} C_{s}(t)$.\n    -   Outflux: Cysts are lost within the host before being shed at a rate $\\delta_{s} C_{s}(t)$.\n    The resulting differential equation is:\n    $$ \\frac{dC_{s}}{dt} = k_{\\mathrm{en}} T - k_{\\mathrm{sh}} C_{s} - \\delta_{s} C_{s} = k_{\\mathrm{en}} T - (k_{\\mathrm{sh}} + \\delta_{s}) C_{s} $$\n\nThe complete system of ODEs is:\n$$ \\frac{dC_{e}}{dt} = k_{\\mathrm{sh}} C_{s} - (k_{\\mathrm{in}} + \\delta_{e}) C_{e} $$\n$$ \\frac{dC_{u}}{dt} = k_{\\mathrm{in}} C_{e} - (k_{\\mathrm{ex}} + \\delta_{u}) C_{u} $$\n$$ \\frac{dT}{dt} = k_{\\mathrm{ex}} C_{u} - (k_{\\mathrm{en}} + \\delta_{t}) T $$\n$$ \\frac{dC_{s}}{dt} = k_{\\mathrm{en}} T - (k_{\\mathrm{sh}} + \\delta_{s}) C_{s} $$\n\n### Part 2: Derivation of the Expected Number of Cysts\n\nThe problem asks for the expected number of environmental cysts produced from a single environmental cyst after one complete pass through the host. This quantity, let's call it $R_{cycle}$, is defined as the product of the probabilities of successful transition at each step of the life cycle. The probability for each step is determined by the competition between the forward transition process and the loss process. Using the provided formula for competing exponential hazards, where the probability of process `a` occurring before process `b` is $a/(a+b)$, we can derive the probability for each step.\n\n1.  **Ingestion**: An environmental cyst ($C_e$) can be ingested (rate $k_{\\mathrm{in}}$) or can decay (rate $\\delta_e$). The probability of successful ingestion before decay is:\n    $$ P_{\\mathrm{in}} = \\frac{k_{\\mathrm{in}}}{k_{\\mathrm{in}} + \\delta_{e}} $$\n\n2.  **Excystation**: An ingested cyst in the upper GI ($C_u$) can excyst to become a trophozoite (rate $k_{\\mathrm{ex}}$) or be lost (rate $\\delta_u$). The probability of successful excystation is:\n    $$ P_{\\mathrm{ex}} = \\frac{k_{\\mathrm{ex}}}{k_{\\mathrm{ex}} + \\delta_{u}} $$\n\n3.  **Encystation**: A trophozoite ($T$) can encyst (rate $k_{\\mathrm{en}}$) or be cleared/die (rate $\\delta_t$). The probability of successful encystation is:\n    $$ P_{\\mathrm{en}} = \\frac{k_{\\mathrm{en}}}{k_{\\mathrm{en}} + \\delta_{t}} $$\n\n4.  **Shedding**: A cyst ready for shedding ($C_s$) can be successfully shed into the environment (rate $k_{\\mathrm{sh}}$) or be lost (rate $\\delta_s$). The probability of successful shedding is:\n    $$ P_{\\mathrm{sh}} = \\frac{k_{\\mathrm{sh}}}{k_{\\mathrm{sh}} + \\delta_{s}} $$\n\nSince the problem assumes linear, first-order kinetics with no amplification (i.e., one-to-one transformations between stages), the overall expected number of cysts produced per initial cyst is the product of these sequential probabilities:\n$$ R_{cycle} = P_{\\mathrm{in}} \\times P_{\\mathrm{ex}} \\times P_{\\mathrm{en}} \\times P_{\\mathrm{sh}} $$\nSubstituting the expressions for each probability gives the final closed-form expression:\n$$ R_{cycle} = \\left( \\frac{k_{\\mathrm{in}}}{k_{\\mathrm{in}} + \\delta_{e}} \\right) \\left( \\frac{k_{\\mathrm{ex}}}{k_{\\mathrm{ex}} + \\delta_{u}} \\right) \\left( \\frac{k_{\\mathrm{en}}}{k_{\\mathrm{en}} + \\delta_{t}} \\right) \\left( \\frac{k_{\\mathrm{sh}}}{k_{\\mathrm{sh}} + \\delta_{s}} \\right) $$\n\n### Part 3: Numerical Evaluation\n\nWe now substitute the given numerical parameter values into the expression for $R_{cycle}$.\nThe parameter values are:\n$k_{\\mathrm{in}}=0.05\\ \\text{day}^{-1}$, $\\delta_{e}=0.02\\ \\text{day}^{-1}$\n$k_{\\mathrm{ex}}=2.0\\ \\text{day}^{-1}$, $\\delta_{u}=0.50\\ \\text{day}^{-1}$\n$k_{\\mathrm{en}}=1.0\\ \\text{day}^{-1}$, $\\delta_{t}=0.30\\ \\text{day}^{-1}$\n$k_{\\mathrm{sh}}=0.50\\ \\text{day}^{-1}$, $\\delta_{s}=0.20\\ \\text{day}^{-1}$\n\nCalculate each probability term:\n$$ P_{\\mathrm{in}} = \\frac{0.05}{0.05 + 0.02} = \\frac{0.05}{0.07} = \\frac{5}{7} $$\n$$ P_{\\mathrm{ex}} = \\frac{2.0}{2.0 + 0.50} = \\frac{2.0}{2.5} = \\frac{20}{25} = \\frac{4}{5} $$\n$$ P_{\\mathrm{en}} = \\frac{1.0}{1.0 + 0.30} = \\frac{1.0}{1.3} = \\frac{10}{13} $$\n$$ P_{\\mathrm{sh}} = \\frac{0.50}{0.50 + 0.20} = \\frac{0.5}{0.7} = \\frac{5}{7} $$\n\nMultiply these probabilities to find $R_{cycle}$:\n$$ R_{cycle} = \\left(\\frac{5}{7}\\right) \\left(\\frac{4}{5}\\right) \\left(\\frac{10}{13}\\right) \\left(\\frac{5}{7}\\right) $$\n$$ R_{cycle} = \\frac{5 \\times 4 \\times 10 \\times 5}{7 \\times 5 \\times 13 \\times 7} = \\frac{4 \\times 10 \\times 5}{7 \\times 13 \\times 7} = \\frac{200}{637} $$\nNow, we convert this fraction to a decimal and round to four significant figures:\n$$ R_{cycle} = \\frac{200}{637} \\approx 0.3139717425... $$\nRounding to four significant figures, we get $0.3140$.",
            "answer": "$$\\boxed{0.3140}$$"
        }
    ]
}