{
    "hands_on_practices": [
        {
            "introduction": "诊断测试的价值不仅在于其技术准确性，更在于如何在特定人群中正确解读其结果。本练习将指导您运用贝叶斯定理，结合灵敏度、特异性和患病率，计算一项血清学检测的阳性预测值（PPV），从而量化一个阳性结果所代表的真实患病风险 。这项技能是循证医学和公共卫生决策的基础。",
            "id": "4697204",
            "problem": "在一个地方性流行区的神经囊尾蚴病诊断项目中，临床医生采用酶联免疫电转移印迹法 (EITB) 来检测针对猪带绦虫囊尾蚴的抗体。考虑一个由患有新发癫痫的成年患者组成的明确定义的队列，在该队列中，已知疾病患病率为 $P=0.05$。在这个队列中，EITB 检测活动性感染的敏感性为 $S=0.90$，特异性为 $C=0.98$。请仅使用概率论中敏感性、特异性、患病率和贝叶斯定理的核心定义，推导阳性预测值 $\\Pr(\\text{disease} \\mid \\text{test positive})$ 关于 $S$、$C$ 和 $P$ 的表达式，然后用给定值计算其结果。将最终答案以小数形式表示，并四舍五入到四位有效数字。",
            "solution": "本题要求在给定疾病患病率 ($P$)、测试敏感性 ($S$) 和测试特异性 ($C$) 的条件下，推导并计算一种神经囊尾蚴病诊断测试的阳性预测值 (PPV)。推导过程必须基于概率论的基本原理，特别是条件概率和贝叶斯定理的定义。\n\n设 $D$ 为患者患有该疾病（神经囊尾蚴病）的事件，设 $D^c$ 为其互补事件，即患者未患该疾病。设 $T^+$ 为测试结果为阳性的事件。我们需要求解的是阳性预测值，即条件概率 $\\Pr(D \\mid T^+)$。\n\n给定的信息可以正式地表述为：\n1.  患病率：$\\Pr(D) = P = 0.05$。因此，未患病的概率为 $\\Pr(D^c) = 1 - \\Pr(D) = 1 - P$。\n2.  敏感性：$\\Pr(T^+ \\mid D) = S = 0.90$。这是在患病条件下测试结果为阳性的概率。\n3.  特异性：$\\Pr(T^- \\mid D^c) = C = 0.98$，其中 $T^-$ 是测试结果为阴性的事件。特异性是在未患病条件下测试结果为阴性的概率。\n\n根据特异性的定义，我们可以确定假阳性概率，即在未患病条件下测试结果为阳性的概率。这是特异性事件的补集：\n$$\n\\Pr(T^+ \\mid D^c) = 1 - \\Pr(T^- \\mid D^c) = 1 - C\n$$\n\n我们的目标是求解 $\\Pr(D \\mid T^+)$。根据贝叶斯定理，该条件概率由以下公式给出：\n$$\n\\Pr(D \\mid T^+) = \\frac{\\Pr(T^+ \\mid D) \\Pr(D)}{\\Pr(T^+)}\n$$\n\n分母 $\\Pr(T^+)$ 是获得阳性测试结果的全概率。它可以根据全概率定律，通过以患病状态（患病或未患病）为条件来计算：\n$$\n\\Pr(T^+) = \\Pr(T^+ \\mid D) \\Pr(D) + \\Pr(T^+ \\mid D^c) \\Pr(D^c)\n$$\n\n现在，我们将患病率 ($P$)、敏感性 ($S$) 和特异性 ($C$) 的正式定义代入此表达式中：\n- $\\Pr(D) = P$\n- $\\Pr(D^c) = 1 - P$\n- $\\Pr(T^+ \\mid D) = S$\n- $\\Pr(T^+ \\mid D^c) = 1 - C$\n\n将这些代入 $\\Pr(T^+)$ 的公式中，得到：\n$$\n\\Pr(T^+) = S \\cdot P + (1 - C)(1 - P)\n$$\n\n最后，我们将这个 $\\Pr(T^+)$ 的表达式代回到阳性预测值 $\\Pr(D \\mid T^+)$ 的贝叶斯定理公式中：\n$$\n\\Pr(D \\mid T^+) = \\frac{\\Pr(T^+ \\mid D) \\Pr(D)}{S \\cdot P + (1 - C)(1 - P)}\n$$\n这可以简化为用 $S$、$C$ 和 $P$ 表示的 PPV 表达式：\n$$\n\\text{PPV} = \\frac{S \\cdot P}{S \\cdot P + (1 - C)(1 - P)}\n$$\n\n现在，我们使用给定的数值 $P=0.05$、$S=0.90$ 和 $C=0.98$ 来计算这个表达式。\n\n首先，我们计算公式的各个组成部分：\n- 分子是真阳性概率：$S \\cdot P = 0.90 \\times 0.05 = 0.045$。\n- 对于分母，我们首先计算假阳性概率：$(1 - C)(1 - P)$。\n  - $1 - C = 1 - 0.98 = 0.02$。\n  - $1 - P = 1 - 0.05 = 0.95$。\n  - 人群中假阳性测试的概率为 $(1-C)(1-P) = 0.02 \\times 0.95 = 0.019$。\n- 分母是真阳性概率与假阳性概率之和：\n  $\\Pr(T^+) = (S \\cdot P) + ((1 - C)(1 - P)) = 0.045 + 0.019 = 0.064$。\n\n现在我们可以计算 PPV：\n$$\n\\text{PPV} = \\frac{0.045}{0.064}\n$$\n进行除法运算：\n$$\n\\text{PPV} = 0.703125\n$$\n\n题目要求答案以小数形式表示，并四舍五入到四位有效数字。前四位有效数字是 $7, 0, 3, 1$。第五位数字是 $2$，小于 $5$，因此我们向下舍入（即不改变第四位数字）。\n\n因此，阳性预测值为 $0.7031$。",
            "answer": "$$\n\\boxed{0.7031}\n$$"
        },
        {
            "introduction": "做出准确诊断后，下一步便是制定有效的治疗方案。本练习模拟了一个核心的临床药学情景：为一名神经囊尾蚴病患者计算阿苯达唑的给药方案 。您需要根据患者体重进行计算，同时遵守为控制毒性而设定的每日最大剂量上限，从而将药理学原理应用于以患者为中心的实际问题中。",
            "id": "4697329",
            "problem": "一名体重 $60\\,\\text{kg}$ 的成年人被诊断出患有多个脑实质神经囊尾蚴病（NCC）囊肿。治疗方案是服用阿苯达唑，按体重给药，疗程为 $14$ 天。使用以下基本事实：(i) 按体重给药意味着每日总剂量（以毫克计）等于每公斤每日规定毫克数与患者体重（以公斤计）的乘积；(ii) 对于神经囊尾蚴病中的阿苯达唑治疗，标准方案为 $15\\,\\text{mg/kg/day}$，每日分两次等量给药；(iii) 广泛接受的临床指南将阿苯达唑的每日总剂量上限定为 $800\\,\\text{mg/day}$ 以限制其毒性。\n\n根据这些原则，推导出在整个 $14$ 天疗程中将要服用的阿苯达唑累积总剂量（以毫克计），同时考虑到每日分两次给药以及每日最大剂量上限。\n\n请用一个以毫克为单位的数字表达您的最终答案。最终答案中不要包含单位。无需四舍五入。",
            "solution": "让我们根据所提供的数据来正式定义变量。\n患者体重为 $m = 60\\,\\text{kg}$。\n阿苯达唑的处方剂量率为 $D_r = 15\\,\\text{mg/kg/day}$。\n每日最大允许总剂量（剂量上限）为 $D_{\\text{max}} = 800\\,\\text{mg/day}$。\n治疗疗程的持续时间为 $T = 14\\,\\text{days}$。\n\n第一步是根据原则 (i)，基于患者体重计算理论上的每日总剂量。我们将此计算出的每日剂量表示为 $D_{\\text{calc}}$。\n$$D_{\\text{calc}} = m \\times D_r$$\n代入给定值：\n$$D_{\\text{calc}} = 60\\,\\text{kg} \\times 15\\,\\frac{\\text{mg}}{\\text{kg} \\cdot \\text{day}} = 900\\,\\frac{\\text{mg}}{\\text{day}}$$\n\n第二步是应用原则 (iii) 中规定的临床剂量上限。实际每日给药剂量，我们表示为 $D_{\\text{actual}}$，不得超过 $D_{\\text{max}}$。因此，实际每日剂量是计算剂量和最大剂量上限中的较小值。\n$$D_{\\text{actual}} = \\min(D_{\\text{calc}}, D_{\\text{max}})$$\n代入数值：\n$$D_{\\text{actual}} = \\min(900\\,\\text{mg/day}, 800\\,\\text{mg/day})$$\n得出：\n$$D_{\\text{actual}} = 800\\,\\frac{\\text{mg}}{\\text{day}}$$\n\n原则 (ii) 中的信息，即剂量分两次等量给药（即每次 $400\\,\\text{mg}$），是给药方案的一个细节，但并不改变每日给药的总量，该总量仍为 $800\\,\\text{mg}$。\n\n最后一步是计算在整个治疗持续时间 $T$ 内服用的阿苯达唑累积总量 $A_{\\text{total}}$。这是实际每日剂量与治疗疗程天数的乘积。\n$$A_{\\text{total}} = D_{\\text{actual}} \\times T$$\n代入 $D_{\\text{actual}}$ 和 $T$ 的值：\n$$A_{\\text{total}} = 800\\,\\frac{\\text{mg}}{\\text{day}} \\times 14\\,\\text{days}$$\n$$A_{\\text{total}} = 11200\\,\\text{mg}$$\n\n因此，在整个 $14$ 天疗程中服用的阿苯达唑累积总量为 $11200\\,\\text{mg}$。",
            "answer": "$$\\boxed{11200}$$"
        },
        {
            "introduction": "将视角从个体患者的治疗转向群体层面的疾病控制，理解传播动力学是至关重要的。本练习将引导您构建一个猪带绦虫在人类和猪两个宿主间传播的数学模型 。通过使用下一代矩阵法，您将推导出基本再生数（$R_0$）的表达式，揭示控制这种复杂寄生虫病传播所需跨越的流行阈值。",
            "id": "4697304",
            "problem": "考虑一个涉及人类和猪的猪带绦虫（Taenia solium）的双宿主传播周期，该模型基于房室传染病模型的以下标准假设：宿主物种内部和之间的同质混合、频率依赖性传播、恒定的人均移除率，以及在无病平衡点（所有宿主均为易感者）进行评估。设人类为终末宿主，患有肠道绦虫病 (taeniasis)；猪为中间宿主，患有囊尾蚴病 (cysticercosis)。用 $S_h$、$I_h$ 表示人类的易感和感染房室，用 $S_p$、$I_p$ 表示猪的易感和感染房室。设 $N_h$ 和 $N_p$ 分别为宿主总种群数量，人均移除（清除）率对人类为 $\\gamma_h + \\mu_h$，对猪为 $\\gamma_p + \\mu_p$，其中 $\\gamma_{\\cdot}$ 是恢复率，$\\mu_{\\cdot}$ 是宿主死亡率。假设感染力是频率依赖的\n$$\\lambda_h = \\beta_{ph}\\frac{I_p}{N_p} \\quad \\text{和} \\quad \\lambda_p = \\beta_{hp}\\frac{I_h}{N_h},$$\n其中 $\\beta_{ph}$ 是通过食用受感染猪肉导致的猪到人感染的有效传播参数，$\\beta_{hp}$ 是通过环境污染和暴露导致的人到猪感染的有效传播参数。\n\n从基本再生数 $R_0$ 等于下一代矩阵 (NGM) 的谱半径这一定义出发，构建无病平衡点附近的感染子系统，确定新感染项和转移项的雅可比矩阵，并构成 $2 \\times 2$ 的 NGM。将 $R_{ph}$ 定义为在无病平衡点时，由单个感染猪引起的预期新增人类感染数；将 $R_{hp}$ 定义为在无病平衡点时，由单个感染人类引起的预期新增猪感染数。然后，用 $R_{ph}$ 和 $R_{hp}$ 表示基本再生数 $R_0$ 的封闭形式解析表达式。\n\n将您的最终答案表示为单个解析表达式。无需四舍五入。",
            "solution": "我们首先根据所给假设，为人类感染房室 $I_h$ 和猪感染房室 $I_p$ 构建微分方程组。每个感染种群的变化率等于新感染率减去移除率。\n\n人类的新增感染率是来自猪的感染力 $\\lambda_h$ 乘以易感人类数量 $S_h$。感染人类的移除率是 $(\\gamma_h + \\mu_h)I_h$。因此，$I_h$ 的方程为：\n$$ \\frac{dI_h}{dt} = \\lambda_h S_h - (\\gamma_h + \\mu_h)I_h = \\beta_{ph}\\frac{I_p}{N_p}S_h - (\\gamma_h + \\mu_h)I_h $$\n\n类似地，猪的新增感染率是来自人类的感染力 $\\lambda_p$ 乘以易感猪数量 $S_p$。感染猪的移除率是 $(\\gamma_p + \\mu_p)I_p$。因此，$I_p$ 的方程为：\n$$ \\frac{dI_p}{dt} = \\lambda_p S_p - (\\gamma_p + \\mu_p)I_p = \\beta_{hp}\\frac{I_h}{N_h}S_p - (\\gamma_p + \\mu_p)I_p $$\n\n基本再生数 $R_0$ 由无病平衡点 (DFE) 的稳定性决定，该平衡点位于 $(S_h, I_h, S_p, I_p) = (N_h, 0, N_p, 0)$。我们使用下一代矩阵 (NGM) 方法，该方法需要在 DFE 周围对系统进行线性化。感染房室的状态向量为 $x = (I_h, I_p)^T$。\n\n感染房室的变化率可以写成 $\\frac{dx}{dt} = \\mathcal{F}(x) - \\mathcal{V}(x)$，其中 $\\mathcal{F}(x)$ 是新感染率向量，$\\mathcal{V}(x)$ 是转移率（移除）向量。\n根据我们的方程组：\n$$ \\mathcal{F} = \\begin{pmatrix} \\beta_{ph}\\frac{I_p}{N_p}S_h \\\\ \\beta_{hp}\\frac{I_h}{N_h}S_p \\end{pmatrix} \\quad \\text{和} \\quad \\mathcal{V} = \\begin{pmatrix} (\\gamma_h + \\mu_h)I_h \\\\ (\\gamma_p + \\mu_p)I_p \\end{pmatrix} $$\n\nNGM 定义为 $K = FV^{-1}$，其中 $F$ 和 $V$ 是在 DFE 处求值的 $\\mathcal{F}$ 和 $\\mathcal{V}$ 的雅可比矩阵。\n$F = \\left. \\frac{\\partial \\mathcal{F}}{\\partial x} \\right|_{DFE}$ 和 $V = \\left. \\frac{\\partial \\mathcal{V}}{\\partial x} \\right|_{DFE}$。\n\n为了计算 $F$，我们在 DFE（$I_h=0, I_p=0, S_h=N_h, S_p=N_p$）处计算偏导数。在线性化过程中，我们用 DFE 的值 $N_h$ 和 $N_p$ 分别近似 $S_h$ 和 $S_p$，因为对于新发疫情，易感者的减少是二阶效应。\n新感染项线性化为：\n人类新增感染率 $\\approx \\beta_{ph}\\frac{I_p}{N_p}N_h = \\left(\\beta_{ph}\\frac{N_h}{N_p}\\right)I_p$\n猪新增感染率 $\\approx \\beta_{hp}\\frac{I_h}{N_h}N_p = \\left(\\beta_{hp}\\frac{N_p}{N_h}\\right)I_h$\n\n因此，新感染的雅可比矩阵 $F$ 为：\n$$ F = \\begin{pmatrix} \\frac{\\partial}{\\partial I_h}  \\frac{\\partial}{\\partial I_p} \\end{pmatrix} \\begin{pmatrix} \\left(\\beta_{ph}\\frac{N_h}{N_p}\\right)I_p \\\\ \\left(\\beta_{hp}\\frac{N_p}{N_h}\\right)I_h \\end{pmatrix} = \\begin{pmatrix} 0  \\beta_{ph}\\frac{N_h}{N_p} \\\\ \\beta_{hp}\\frac{N_p}{N_h}  0 \\end{pmatrix} $$\n\n转移项的雅可比矩阵 $V$ 为：\n$$ V = \\left. \\frac{\\partial \\mathcal{V}}{\\partial x} \\right|_{DFE} = \\begin{pmatrix} \\gamma_h + \\mu_h  0 \\\\ 0  \\gamma_p + \\mu_p \\end{pmatrix} $$\n\n$V$ 的逆矩阵为：\n$$ V^{-1} = \\begin{pmatrix} \\frac{1}{\\gamma_h + \\mu_h}  0 \\\\ 0  \\frac{1}{\\gamma_p + \\mu_p} \\end{pmatrix} $$\n\n现在，我们构建 NGM, $K = FV^{-1}$：\n$$ K = \\begin{pmatrix} 0  \\beta_{ph}\\frac{N_h}{N_p} \\\\ \\beta_{hp}\\frac{N_p}{N_h}  0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\gamma_h + \\mu_h}  0 \\\\ 0  \\frac{1}{\\gamma_p + \\mu_p} \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{\\beta_{ph}N_h/N_p}{\\gamma_p + \\mu_p} \\\\ \\frac{\\beta_{hp}N_p/N_h}{\\gamma_h + \\mu_h}  0 \\end{pmatrix} $$\n\n基本再生数 $R_0$ 是谱半径 $\\rho(K)$，即 $K$ 的最大绝对值特征值。特征值 $\\lambda$ 是特征方程 $\\det(K - \\lambda I) = 0$ 的根：\n$$ \\det \\begin{pmatrix} -\\lambda  \\frac{\\beta_{ph}N_h/N_p}{\\gamma_p + \\mu_p} \\\\ \\frac{\\beta_{hp}N_p/N_h}{\\gamma_h + \\mu_h}  -\\lambda \\end{pmatrix} = 0 $$\n$$ (-\\lambda)(-\\lambda) - \\left( \\frac{\\beta_{ph}N_h/N_p}{\\gamma_p + \\mu_p} \\right) \\left( \\frac{\\beta_{hp}N_p/N_h}{\\gamma_h + \\mu_h} \\right) = 0 $$\n$$ \\lambda^2 - \\frac{\\beta_{ph}\\beta_{hp}}{(\\gamma_h + \\mu_h)(\\gamma_p + \\mu_p)} = 0 $$\n特征值为 $\\lambda = \\pm \\sqrt{\\frac{\\beta_{ph}\\beta_{hp}}{(\\gamma_h + \\mu_h)(\\gamma_p + \\mu_p)}}$。谱半径是正根：\n$$ R_0 = \\rho(K) = \\sqrt{\\frac{\\beta_{ph}\\beta_{hp}}{(\\gamma_h + \\mu_h)(\\gamma_p + \\mu_p)}} $$\n\n接下来，我们必须用 $R_{ph}$ 和 $R_{hp}$ 来表示 $R_0$。我们从它们的定义中推导出这些量。\n$R_{hp}$ 是在一个完全易感的猪种群中，由单个感染人类引起的预期新增猪感染数。单个感染人类 ($I_h=1$) 在猪群中产生新感染的速率为 $\\lambda_p S_p = (\\beta_{hp}\\frac{1}{N_h})S_p$。在 DFE 处，$S_p = N_p$，因此速率为 $\\beta_{hp}\\frac{N_p}{N_h}$。人类的平均感染期为 $\\frac{1}{\\gamma_h + \\mu_h}$。因此：\n$$ R_{hp} = (\\text{来自一个人类的感染率}) \\times (\\text{人类的平均感染期}) = \\left(\\beta_{hp}\\frac{N_p}{N_h}\\right) \\left(\\frac{1}{\\gamma_h + \\mu_h}\\right) = \\frac{\\beta_{hp}N_p/N_h}{\\gamma_h + \\mu_h} $$\n\n$R_{ph}$ 是在一个完全易感的人类种群中，由单个感染猪引起的预期新增人类感染数。单个感染猪 ($I_p=1$) 在人类中产生新感染的速率为 $\\lambda_h S_h = (\\beta_{ph}\\frac{1}{N_p})S_h$。在 DFE 处，$S_h = N_h$，因此速率为 $\\beta_{ph}\\frac{N_h}{N_p}$。猪的平均感染期为 $\\frac{1}{\\gamma_p + \\mu_p}$。因此：\n$$ R_{ph} = (\\text{来自一头猪的感染率}) \\times (\\text{猪的平均感染期}) = \\left(\\beta_{ph}\\frac{N_h}{N_p}\\right) \\left(\\frac{1}{\\gamma_p + \\mu_p}\\right) = \\frac{\\beta_{ph}N_h/N_p}{\\gamma_p + \\mu_p} $$\n\n这些项 $R_{ph}$ 和 $R_{hp}$ 正是 NGM $K$ 的非对角线元素：\n$$ K = \\begin{pmatrix} 0  R_{ph} \\\\ R_{hp}  0 \\end{pmatrix} $$\n\n该矩阵的特征值由 $\\lambda^2 - R_{ph}R_{hp} = 0$ 给出，因此 $\\lambda = \\pm\\sqrt{R_{ph}R_{hp}}$。谱半径是正根。\n因此，基本再生数 $R_0$ 由这两个“代际”再生数的几何平均值给出：\n$$ R_0 = \\rho(K) = \\sqrt{R_{ph}R_{hp}} $$\n该表达式表示在经过一个完整的传播周期（例如，人 $\\to$ 猪 $\\to$ 人）后，同一宿主类型中的二次感染数。",
            "answer": "$$ \\boxed{\\sqrt{R_{ph}R_{hp}}} $$"
        }
    ]
}