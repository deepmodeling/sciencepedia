{
    "hands_on_practices": [
        {
            "introduction": "在疫情爆发初期，建立一个可靠的病例定义对于采取有效的公共卫生行动至关重要。这项决策涉及到一个关键的权衡：漏掉真实病例（假阴性）与不必要地治疗和隔离非病例（假阳性）之间的平衡。本练习  将演示如何运用贝叶斯决策理论，通过权衡错误分类的代价，来推导出一个最优的诊断阈值，从而为应对肺鼠疫威胁提供理性的、数据驱动的决策指导。",
            "id": "4707298",
            "problem": "一个应对疑似肺鼠疫暴发的现场团队，必须根据一项快速实验室指标，来制定一个用于隔离和经验性治疗的可操作病例定义。每位有症状的患者都接受了靶向鼠疫耶尔森氏菌 (*Yersinia pestis*) 的纤溶酶原激活基因的定量聚合酶链式反应 (qPCR) 检测，实验室返回一个循环阈值 (Ct)。较低的 $Ct$ 值表示较高的靶标载量。流行病学筛查表明，在经过筛查的有症状患者中，真实感染鼠疫耶尔森氏菌的先验概率为 $p=0.12$。为量化决策后果，该团队将假阴性分类（漏诊真实病例）的期望损失建模为 $C_{\\mathrm{FN}}=50$（任意损失单位，包括死亡风险、后续传播和声誉影响），将假阳性分类（不必要的隔离和治疗）的期望损失建模为 $C_{\\mathrm{FP}}=1$。\n\n经验验证表明，在真实感染的条件下，$Ct$ 值近似服从正态分布 $X \\mid \\text{infected} \\sim \\mathcal{N}(\\mu_{1},\\sigma^{2})$，其中 $\\mu_{1}=21$，$\\sigma=2.5$；在未感染的条件下，$Ct$ 值近似服从正态分布 $X \\mid \\text{not infected} \\sim \\mathcal{N}(\\mu_{0},\\sigma^{2})$，其中 $\\mu_{0}=34$，$\\sigma$ 值同样为 $2.5$。假设这些分布在当前操作环境下是经过科学校准且稳定的。\n\n仅从二元分类中的期望损失最小化、贝叶斯定理和正态概率密度函数的定义出发，推导出贝叶斯最优决策规则，并解析求解唯一的 $Ct$ 阈值 $x^{\\ast}$（单位：循环），在该阈值上，决策行为从“分类为鼠疫病例”切换到“不分类为鼠疫病例”。请给出 $x^{\\ast}$ 的最终数值（单位：循环）。将您的答案四舍五入到四位有效数字，并以循环为单位表示该阈值。",
            "solution": "我们将此决策问题构建为一个二元分类问题，有两种行为：分类为“病例”（阳性）与“非病例”（阴性）。令 $H_{1}$ 表示“感染”，$H_{0}$ 表示“未感染”。对于一个观测到的 $Ct$ 值 $x$，每种行为的期望损失可从基本定义导出：\n- 选择“病例”的期望损失为 $L(+ \\mid x)=C_{\\mathrm{FP}}\\,P(H_{0}\\mid x)$。\n- 选择“非病例”的期望损失为 $L(- \\mid x)=C_{\\mathrm{FN}}\\,P(H_{1}\\mid x)$。\n\n对于观测值 $x$，贝叶斯最优行为是期望损失较小的那个。因此，当满足以下条件时选择“病例”：\n$$\nL(+ \\mid x)  L(- \\mid x)\n\\quad\\Longleftrightarrow\\quad\nC_{\\mathrm{FP}}\\,P(H_{0}\\mid x)  C_{\\mathrm{FN}}\\,P(H_{1}\\mid x).\n$$\n等价地，\n$$\n\\frac{P(H_{1}\\mid x)}{P(H_{0}\\mid x)} > \\frac{C_{\\mathrm{FP}}}{C_{\\mathrm{FN}}}.\n$$\n根据贝叶斯定理和似然比的定义，\n$$\n\\frac{P(H_{1}\\mid x)}{P(H_{0}\\mid x)} \\;=\\; \\frac{f_{1}(x)\\,p}{f_{0}(x)\\,(1-p)} \\;=\\; \\Lambda(x)\\,\\frac{p}{1-p},\n$$\n其中 $f_{1}(x)$ 和 $f_{0}(x)$ 分别是在 $H_{1}$ 和 $H_{0}$ 条件下 $X$ 的类条件概率密度函数，而 $\\Lambda(x)=\\frac{f_{1}(x)}{f_{0}(x)}$ 是似然比。决策条件变为\n$$\n\\Lambda(x) > \\eta,\n\\quad\\text{with}\\quad\n\\eta \\equiv \\frac{C_{\\mathrm{FP}}(1-p)}{C_{\\mathrm{FN}}\\,p}.\n$$\n因此，贝叶斯最优规则是：如果 $\\Lambda(x)>\\eta$，则分类为“病例”，否则分类为“非病例”。阈值 $x^{\\ast}$ 是解方程 $\\Lambda(x^{\\ast})=\\eta$ 得到的 $Ct$ 值。\n\n在 $X\\mid H_{i}\\sim \\mathcal{N}(\\mu_{i},\\sigma^{2})$ (其中 $i\\in\\{0,1\\}$) 且 $\\sigma$ 相等的条件下，正态密度函数为\n$$\nf_{i}(x) \\;=\\; \\frac{1}{\\sigma\\sqrt{2\\pi}}\\,\\exp\\!\\left(-\\frac{(x-\\mu_{i})^{2}}{2\\sigma^{2}}\\right).\n$$\n因此，似然比可简化为\n$$\n\\Lambda(x)\n\\;=\\;\n\\frac{f_{1}(x)}{f_{0}(x)}\n\\;=\\;\n\\exp\\!\\left(-\\frac{(x-\\mu_{1})^{2}-(x-\\mu_{0})^{2}}{2\\sigma^{2}}\\right),\n$$\n因为前置因子 $\\frac{1}{\\sigma\\sqrt{2\\pi}}$ 相互抵消。对 $\\Lambda(x^{\\ast})=\\eta$ 两边取自然对数，\n$$\n\\ln \\Lambda(x^{\\ast}) = \\ln \\eta,\n$$\n并代入其显式形式，\n$$\n-\\frac{(x^{\\ast}-\\mu_{1})^{2}-(x^{\\ast}-\\mu_{0})^{2}}{2\\sigma^{2}} = \\ln \\eta.\n$$\n展开并化简平方差：\n$$\n(x^{\\ast}-\\mu_{1})^{2}-(x^{\\ast}-\\mu_{0})^{2}\n=\n2x^{\\ast}(\\mu_{0}-\\mu_{1}) + (\\mu_{1}^{2}-\\mu_{0}^{2}).\n$$\n因此，\n$$\n-\\frac{2x^{\\ast}(\\mu_{0}-\\mu_{1}) + (\\mu_{1}^{2}-\\mu_{0}^{2})}{2\\sigma^{2}} = \\ln \\eta,\n$$\n该方程关于 $x^{\\ast}$ 是线性的。解出 $x^{\\ast}$ 得\n$$\nx^{\\ast}\n=\n\\frac{\\mu_{0}+\\mu_{1}}{2}\n\\;-\\;\n\\frac{\\sigma^{2}}{\\mu_{0}-\\mu_{1}}\\;\\ln \\eta.\n$$\n因为 $\\mu_{1}  \\mu_{0}$ 且 $\\sigma^{2}>0$，似然比 $\\Lambda(x)$ 是关于 $x$ 的严格递减函数，所以决策规则是在 $x  x^{\\ast}$ 时分类为“病例”。\n\n现在代入数值：\n$p=0.12, 1-p=0.88, C_{\\mathrm{FP}}=1, C_{\\mathrm{FN}}=50, \\mu_{1}=21, \\mu_{0}=34, \\sigma=2.5$.\n首先计算决策阈值 $\\eta$：\n$$\n\\eta = \\frac{1 \\times 0.88}{50 \\times 0.12} = \\frac{0.88}{6} \\approx 0.14667.\n$$\n然后计算 $\\ln \\eta$：\n$$\n\\ln(\\eta) \\approx \\ln(0.14667) \\approx -1.91956.\n$$\n最后计算 $Ct$ 阈值 $x^{\\ast}$：\n$$\nx^{\\ast}\n=\n\\frac{34+21}{2}\n-\n\\frac{2.5^{2}}{34-21} \\times (-1.91956)\n=\n27.5\n-\n\\frac{6.25}{13} \\times (-1.91956)\n\\approx\n27.5 + 0.92287\n\\approx 28.42287.\n$$\n将结果四舍五入到四位有效数字，得到 $28.42$。因此，如果一个病人的 $Ct$ 值低于 $28.42$，他们将被分类为鼠疫病例并接受治疗。",
            "answer": "$$\\boxed{28.42}$$"
        },
        {
            "introduction": "在识别病例之后，量化疫情的严重程度成为下一个优先事项。病死率（Case Fatality Rate, CFR）是一个基本指标，但在疫情期间，由于存在大量结局未知的病例，其估计往往变得复杂。本练习  要求您在一个竞争风险框架内，从第一性原理出发，推导病死率的最大似然估计量，揭示如何正确处理右删失数据，并为实时流行病学评估提供一个稳健的工具。",
            "id": "4707365",
            "problem": "在一个偏远地区，正在调查一起由细菌 *Yersinia pestis* 引起的肺鼠疫爆发。调查人员对新发实验室确诊病例进行前瞻性随访，以估计病死率（Case Fatality Rate, CFR），其定义为病例在康复前最终死亡的概率。该分析在日历时间 $T$ 进行，并基于以下基本假设：\n\n- 以确诊为条件，从确诊至死亡的时间和从确诊至康复的时间是相互独立的，并且分别服从具有恒定风险率 $\\lambda_{d}$ 和 $\\lambda_{r}$ 的指数分布。这反映了在现有标准治疗下对临床病程的无记忆性、时间同质性近似。\n- 在时间 $T$ 的右删失（随访的管理性终止）与事件过程是独立的。\n- 结局是互斥且穷尽的：每个病例最终要么死亡要么康复，且一旦一个事件发生，另一个事件便不能发生。\n\n在时间 $T$，监测数据集包含以下充分统计量：\n\n- 纳入的新发确诊病例总数：$N = 90$。\n- 截至时间 $T$ 观测到的死亡人数：$D = 41$。\n- 截至时间 $T$ 观测到的康复人数：$R = 23$。\n- 截至时间 $T$ 仍住院且未记录结局的病例数：$U = N - D - R = 26$。\n- 截至时间 $T$ 所有 $N$ 例病例的总累积随访时间：$\\sum_{i=1}^{N} t_{i} = 505$ 病例-天。\n\n仅从风险、生存以及指数模型下右删失事件发生时间数据的似然函数定义出发，推导病死率（CFR）的最大似然估计量（MLE），并用可观测计数表示。然后，根据上述数据计算其值。将CFR表示为小数（而非百分比），并将最终数值答案四舍五入至四位有效数字。",
            "solution": "该问题要求在竞争风险框架内推导病死率（Case Fatality Rate, CFR）的最大似然估计量（MLE）。\n\n设 $T_d$ 和 $T_r$ 分别为从确诊到死亡和从确诊到康复的时间的随机变量。根据假设，它们是独立的，并分别服从参数为 $\\lambda_d$ (死亡风险率) 和 $\\lambda_r$ (康复风险率) 的指数分布。\n\nCFR 的定义是在康复前死亡的概率，即 $P(T_d  T_r)$。利用指数分布的无记忆性和独立性，这个概率可以简洁地表示为风险率的比率：\n$$\n\\text{CFR} = P(T_d  T_r) = \\frac{\\lambda_d}{\\lambda_d + \\lambda_r}\n$$\n为了找到 CFR 的 MLE，我们首先需要找到 $\\lambda_d$ 和 $\\lambda_r$ 的 MLE。我们为观测数据构建似然函数。数据包括 $D$ 例死亡，$R$ 例康复，以及 $U$ 例在随访期间结局未知的右删失病例。\n\n对于一个在时间 $t_i$ 死亡的病例，其对似然函数的贡献是死亡事件在 $t_i$ 发生的概率密度，即死亡风险率 $\\lambda_d$ 乘以到 $t_i$ 时刻仍然存活（既未死亡也未康复）的概率 $S(t_i) = \\exp(-(\\lambda_d + \\lambda_r)t_i)$。因此，贡献为 $\\lambda_d \\exp(-(\\lambda_d + \\lambda_r)t_i)$。\n同理，对于一个在时间 $t_j$ 康复的病例，其贡献为 $\\lambda_r \\exp(-(\\lambda_d + \\lambda_r)t_j)$。\n对于一个在时间 $t_k$ 被删失的病例，我们只知道其存活超过了 $t_k$，其贡献为生存概率 $S(t_k) = \\exp(-(\\lambda_d + \\lambda_r)t_k)$。\n\n总似然函数 $L(\\lambda_d, \\lambda_r)$ 是所有 $N$ 个个体贡献的乘积：\n$$\nL(\\lambda_d, \\lambda_r) = \\left( \\prod_{i=1}^D \\lambda_d e^{-(\\lambda_d+\\lambda_r)t_i} \\right) \\left( \\prod_{j=1}^R \\lambda_r e^{-(\\lambda_d+\\lambda_r)t_j} \\right) \\left( \\prod_{k=1}^U e^{-(\\lambda_d+\\lambda_r)t_k} \\right)\n$$\n合并各项，得到：\n$$\nL(\\lambda_d, \\lambda_r) = \\lambda_d^D \\lambda_r^R \\exp\\left(-(\\lambda_d + \\lambda_r) \\sum_{i=1}^{N} t_i\\right)\n$$\n令总累积随访时间为 $T_{\\text{total}} = \\sum_{i=1}^{N} t_{i}$。对数似然函数 $\\ell = \\ln(L)$ 为：\n$$\n\\ell(\\lambda_d, \\lambda_r) = D \\ln(\\lambda_d) + R \\ln(\\lambda_r) - (\\lambda_d + \\lambda_r) T_{\\text{total}}\n$$\n为了找到 MLE，我们求 $\\ell$ 关于 $\\lambda_d$ 和 $\\lambda_r$ 的偏导数，并令它们为零：\n$$\n\\frac{\\partial \\ell}{\\partial \\lambda_d} = \\frac{D}{\\lambda_d} - T_{\\text{total}} = 0 \\quad\\implies\\quad \\hat{\\lambda}_d = \\frac{D}{T_{\\text{total}}}\n$$\n$$\n\\frac{\\partial \\ell}{\\partial \\lambda_r} = \\frac{R}{\\lambda_r} - T_{\\text{total}} = 0 \\quad\\implies\\quad \\hat{\\lambda}_r = \\frac{R}{T_{\\text{total}}}\n$$\n根据最大似然估计量的不变性，将这些估计量代入 CFR 的表达式，即可得到 CFR 的 MLE：\n$$\n\\widehat{\\text{CFR}}_{\\text{MLE}} = \\frac{\\hat{\\lambda}_d}{\\hat{\\lambda}_d + \\hat{\\lambda}_r} = \\frac{D/T_{\\text{total}}}{D/T_{\\text{total}} + R/T_{\\text{total}}} = \\frac{D}{D+R}\n$$\n这个结果非常直观：在恒定风险率的假设下，CFR 的最佳估计值是已观测到的死亡人数占所有已知结局（死亡或康复）总人数的比例。值得注意的是，该估计量不依赖于总随访时间 $T_{\\text{total}}$ 或删失病例数 $U$。\n\n现在，我们使用所提供的数据计算其数值：\n- 死亡人数, $D = 41$\n- 康复人数, $R = 23$\n\n$$\n\\widehat{\\text{CFR}} = \\frac{41}{41 + 23} = \\frac{41}{64} = 0.640625\n$$\n根据题目要求，将答案四舍五入至四位有效数字，得到 $0.6406$。",
            "answer": "$$\n\\boxed{0.6406}\n$$"
        },
        {
            "introduction": "将视角从群体层面的监测转向个体患者的治疗，有效治疗是最终目标。药代动力学/药效学（PK/PD）模型为设计合理的抗生素给药方案提供了科学基础。在本问题中 ，您将应用这些原理，通过数学模型将药物暴露与其治疗效果联系起来，确定在24小时内抑制鼠疫耶尔森菌生长所需的氟喹诺酮类药物的最低剂量。",
            "id": "4707331",
            "problem": "一种鼠疫病原体 Yersinia pestis 的强毒株正在使用单次静脉推注剂量的氟喹诺酮类抗生素进行治疗。您需要设计一个最小负荷剂量，使得在效应部位，前 $24$ 小时内细菌净种群变化为非正值。请使用基于第一性原理的药代动力学/药效动力学 (PK/PD; pharmacokinetic/pharmacodynamic) 框架。\n\n假设采用单室药代动力学模型，瞬时静脉推注给药剂量为 $D$，效应部位瞬时平衡，因此效应部位浓度在所有时间都等于血浆浓度。血浆浓度由 $C(t) = \\frac{D}{V}\\exp(-k_{e} t)$ 给出，其中 $V$ 是分布容积，$k_{e}$ 是一级消除速率常数。效应部位的细菌种群动态遵循 $ \\frac{db}{dt} = \\big(r_{g} - k(C(t))\\big) b(t)$，其中 $r_{g}$ 是一级细菌生长速率常数，$k(C)$ 是抗生素杀菌速率。杀菌速率遵循 Hill 系数 $h=1$ 的 Hill 型最大效应模型：$k(C) = \\frac{E_{\\max} C}{EC_{50} + C}$，其中 $E_{\\max}$ 是最大杀菌速率，$EC_{50}$ 是产生半数最大杀菌效果时的浓度。\n\n将区间 $[0,T]$ 上的“细菌抑制”定义为非正的净对数变化，即 $\\int_{0}^{T}\\big(r_{g} - k(C(t))\\big)\\,dt \\leq 0$。最小负荷剂量对应于该积分等于 $0$ 的情况。\n\n仅使用上述定义和参数值 $E_{\\max} = 1.2$ h$^{-1}$，$EC_{50} = 2.0$ mg/L，$r_{g} = 0.35$ h$^{-1}$，$k_{e} = 0.10$ h$^{-1}$，$V = 120$ L 以及 $T = 24$ h，从第一性原理推导满足抑制标准的最小剂量 $D$ 的解析表达式，然后进行数值计算。将最终数值答案四舍五入至三位有效数字。剂量以 mg 表示。",
            "solution": "我们的目标是找到满足特定细菌抑制标准的最小剂量 $D$。该标准要求在时间区间 $[0, T]$ 内，细菌种群的净对数变化为零：\n$$\n\\int_{0}^{T}\\big(r_{g} - k(C(t))\\big)\\,dt = 0\n$$\n其中 $r_g$ 是生长速率， $k(C(t))$ 是浓度依赖的杀菌速率。这个方程可以重写为：\n$$\n\\int_{0}^{T} r_{g}\\,dt = \\int_{0}^{T} k(C(t))\\,dt\n$$\n$$\nr_{g}T = \\int_{0}^{T} \\frac{E_{\\max} C(t)}{EC_{50} + C(t)}\\,dt\n$$\n药物浓度随时间变化为 $C(t) = C_0 \\exp(-k_e t)$，其中 $C_0 = D/V$ 是初始浓度。代入积分中：\n$$\nr_{g}T = \\int_{0}^{T} \\frac{E_{\\max} C_0 \\exp(-k_e t)}{EC_{50} + C_0 \\exp(-k_e t)}\\,dt\n$$\n为了求解这个积分，我们进行变量代换。令 $u = EC_{50} + C_0 \\exp(-k_e t)$。那么 $du = -k_e C_0 \\exp(-k_e t)\\,dt$，这意味着 $C_0 \\exp(-k_e t)\\,dt = -\\frac{1}{k_e}du$。同时更新积分限：\n- 当 $t=0$ 时, $u_{\\text{lower}} = EC_{50} + C_0$。\n- 当 $t=T$ 时, $u_{\\text{upper}} = EC_{50} + C_0 \\exp(-k_e T)$。\n\n将这些代入积分，得到：\n$$\nr_{g}T = \\int_{EC_{50} + C_0}^{EC_{50} + C_0 \\exp(-k_e T)} \\frac{E_{\\max}}{u} \\left(-\\frac{1}{k_e}\\right)\\,du = -\\frac{E_{\\max}}{k_e} \\left[\\ln|u|\\right]_{EC_{50} + C_0}^{EC_{50} + C_0 \\exp(-k_e T)}\n$$\n计算定积分并利用对数性质 $\\ln(a) - \\ln(b) = -\\ln(b/a)$：\n$$\nr_{g}T = \\frac{E_{\\max}}{k_e} \\ln\\left(\\frac{EC_{50} + C_0}{EC_{50} + C_0 \\exp(-k_e T)}\\right)\n$$\n现在，我们需要从这个方程中解出 $C_0$。首先整理方程：\n$$\n\\frac{r_g T k_e}{E_{\\max}} = \\ln\\left(\\frac{EC_{50} + C_0}{EC_{50} + C_0 \\exp(-k_e T)}\\right)\n$$\n对两边取指数：\n$$\n\\exp\\left(\\frac{r_g T k_e}{E_{\\max}}\\right) = \\frac{EC_{50} + C_0}{EC_{50} + C_0 \\exp(-k_e T)}\n$$\n为了简化代数，令 $A = \\exp\\left(\\frac{r_g T k_e}{E_{\\max}}\\right)$。方程变为：\n$$\nA(EC_{50} + C_0 \\exp(-k_e T)) = EC_{50} + C_0\n$$\n$$\nA \\cdot EC_{50} - EC_{50} = C_0 - A C_0 \\exp(-k_e T)\n$$\n$$\nEC_{50}(A - 1) = C_0(1 - A \\exp(-k_e T))\n$$\n解出 $C_0$：\n$$\nC_0 = EC_{50} \\frac{A - 1}{1 - A \\exp(-k_e T)} = EC_{50} \\frac{\\exp\\left(\\frac{r_g T k_e}{E_{\\max}}\\right) - 1}{1 - \\exp\\left(\\frac{r_g T k_e}{E_{\\max}}\\right)\\exp(-k_e T)}\n$$\n剂量 $D$ 由 $D = C_0 V$ 给出。\n\n现在代入数值进行计算：\n- $E_{\\max} = 1.2$ h$^{-1}$\n- $EC_{50} = 2.0$ mg/L\n- $r_{g} = 0.35$ h$^{-1}$\n- $k_{e} = 0.10$ h$^{-1}$\n- $V = 120$ L\n- $T = 24$ h\n\n首先计算指数项中的常数：\n$$\n\\frac{r_g T k_e}{E_{\\max}} = \\frac{0.35 \\times 24 \\times 0.10}{1.2} = \\frac{0.84}{1.2} = 0.7\n$$\n现在计算 $A$:\n$$\nA = \\exp(0.7) \\approx 2.01375\n$$\n然后计算 $C_0$:\n$$\nC_0 = 2.0 \\times \\frac{2.01375 - 1}{1 - 2.01375 \\times \\exp(-0.10 \\times 24)} = 2.0 \\times \\frac{1.01375}{1 - 2.01375 \\times \\exp(-2.4)}\n$$\n$$\n\\exp(-2.4) \\approx 0.090718\n$$\n$$\nC_0 = 2.0 \\times \\frac{1.01375}{1 - 2.01375 \\times 0.090718} = 2.0 \\times \\frac{1.01375}{1 - 0.18270} = 2.0 \\times \\frac{1.01375}{0.81730} \\approx 2.4807 \\text{ mg/L}\n$$\n最后，计算剂量 $D$:\n$$\nD = C_0 \\times V \\approx 2.4807 \\text{ mg/L} \\times 120 \\text{ L} \\approx 297.68 \\text{ mg}\n$$\n四舍五入到三位有效数字，得到 $298$ mg。",
            "answer": "$$\n\\boxed{298}\n$$"
        }
    ]
}