{
    "hands_on_practices": [
        {
            "introduction": "开发针对艾滋病病毒 (HIV) 和流感等高度可变病原体的广谱疫苗，一个核心挑战在于如何识别并优先选择其蛋白质序列中的保守区域作为靶点。本实践介绍了一种基础的生物信息学方法——香农熵 (Shannon entropy)，用以量化潜在疫苗靶点的保守性。通过计算保守性得分，您将学习如何筛选那些不易发生突变、从而能够有效避免免疫逃逸的抗原表位 。",
            "id": "4704532",
            "problem": "在为人类免疫缺陷病毒（HIV）、流感和结核病（TB）设计广谱保护性疫苗时，一个核心挑战是如何优先选择保守区域的表位，以最大限度地减少免疫逃逸。从多序列比对中评估蛋白质序列某一位置保守性的一个定量方法是香农熵，其对于一个离散分布的定义为 $H = -\\sum_{i} p_{i} \\ln p_{i}$，其中 $p_{i}$ 是该位置上残基 $i$ 的经验概率，$\\ln$ 表示自然对数。对于从标准的20个字母的氨基酸表中抽取的一个氨基酸位置，可以定义一个熵归一化的保守性得分 $C = 1 - \\frac{H}{\\ln 20}$，其中 $C \\in [0,1]$；越大的 $C$ 值表示越高的保守性。为了反映公共卫生优先次序，我们指定病原体权重为 $w_{\\text{HIV}} = 0.5$、$w_{\\text{Flu}} = 0.3$ 和 $w_{\\text{TB}} = 0.2$，并通过 $R = w \\cdot C$ 为一个位点定义一个选择排序得分，其中 $w$ 是该位点对应病原体的权重。\n\n给定来自各有 $N = 100$ 条序列的比对中，单个位置上经过整理的氨基酸计数：\n\n- HIV包膜糖蛋白（Env）：\n  - 位置 $E1$：90个甘氨酸，10个丙氨酸。\n  - 位置 $E2$：60个天冬酰胺，40个天冬氨酸。\n- 甲型流感病毒血凝素（HA）：\n  - 位置 $H1$：70个赖氨酸，20个精氨酸，10个天冬酰胺。\n  - 位置 $H2$：95个丝氨酸，5个天冬酰胺。\n- 结核分枝杆菌抗原 $85\\text{B}$（Ag85B）：\n  - 位置 $T1$：98个亮氨酸，2个异亮氨酸。\n\n对于每个位置，根据给定的计数计算经验概率 $p_{i}$、香non熵 $H$、归一化保守性得分 $C = 1 - \\frac{H}{\\ln 20}$，以及使用特定病原体权重 $w$ 计算的选择排序得分 $R = w \\cdot C$。在这五个位置中，找出最大的选择排序得分并报告其值。将最终答案四舍五入到四位有效数字。最终结果以无量纲数表示（无单位）。",
            "solution": "该问题被认为是有效的，因为它科学地基于生物信息学的既定原则（用于序列保守性分析的香农熵），问题阐述清晰，提供了所有必要的数据和明确的目标，并使用客观、定量的语言进行描述。\n\n目标是计算来自三种病原体的五个指定氨基酸位置的选择排序得分 $R$，并找出最大得分。对每个位置的计算分三个阶段进行：\n1.  计算香农熵 $H$。\n2.  计算归一化保守性得分 $C$。\n3.  计算病原体加权的选择排序得分 $R$。\n\n控制方程如下：\n对于总共 $N$ 条序列中计数为 $n_i$ 的氨基酸 $i$，其经验概率为 $p_i = \\frac{n_i}{N}$。\n香农熵为 $H = -\\sum_{i} p_{i} \\ln p_{i}$。\n归一化保守性得分为 $C = 1 - \\frac{H}{\\ln 20}$。\n选择排序得分为 $R = w \\cdot C$。\n\n给定参数如下：\n- 每个比对的总序列数：$N = 100$。\n- 病原体权重：$w_{\\text{HIV}} = 0.5$、$w_{\\text{Flu}} = 0.3$、$w_{\\text{TB}} = 0.2$。\n- 标准氨基酸数量的自然对数是 $\\ln 20 \\approx 2.99573$。\n\n我们现在将计算每个位置的得分。\n\n**HIV包膜糖蛋白（Env），位置 $E1$**\n- 病原体权重：$w_{\\text{HIV}} = 0.5$。\n- 氨基酸计数：90个甘氨酸（Gly），10个丙氨酸（Ala）。\n- 经验概率为：\n  $$p_{\\text{Gly}} = \\frac{90}{100} = 0.9$$\n  $$p_{\\text{Ala}} = \\frac{10}{100} = 0.1$$\n- 香农熵 $H_{E1}$ 为：\n  $$H_{E1} = -(p_{\\text{Gly}} \\ln p_{\\text{Gly}} + p_{\\text{Ala}} \\ln p_{\\text{Ala}}) = -(0.9 \\ln 0.9 + 0.1 \\ln 0.1) \\approx 0.32508$$\n- 保守性得分 $C_{E1}$ 为：\n  $$C_{E1} = 1 - \\frac{H_{E1}}{\\ln 20} \\approx 1 - \\frac{0.32508}{2.99573} \\approx 0.89148$$\n- 选择排序得分 $R_{E1}$ 为：\n  $$R_{E1} = w_{\\text{HIV}} \\cdot C_{E1} \\approx 0.5 \\cdot 0.89148 \\approx 0.44574$$\n\n**HIV包膜糖蛋白（Env），位置 $E2$**\n- 病原体权重：$w_{\\text{HIV}} = 0.5$。\n- 氨基酸计数：60个天冬酰胺（Asn），40个天冬氨酸（Asp）。\n- 经验概率为：\n  $$p_{\\text{Asn}} = \\frac{60}{100} = 0.6$$\n  $$p_{\\text{Asp}} = \\frac{40}{100} = 0.4$$\n- 香农熵 $H_{E2}$ 为：\n  $$H_{E2} = -(p_{\\text{Asn}} \\ln p_{\\text{Asn}} + p_{\\text{Asp}} \\ln p_{\\text{Asp}}) = -(0.6 \\ln 0.6 + 0.4 \\ln 0.4) \\approx 0.67301$$\n- 保守性得分 $C_{E2}$ 为：\n  $$C_{E2} = 1 - \\frac{H_{E2}}{\\ln 20} \\approx 1 - \\frac{0.67301}{2.99573} \\approx 0.77534$$\n- 选择排序得分 $R_{E2}$ 为：\n  $$R_{E2} = w_{\\text{HIV}} \\cdot C_{E2} \\approx 0.5 \\cdot 0.77534 \\approx 0.38767$$\n\n**甲型流感病毒血凝素（HA），位置 $H1$**\n- 病原体权重：$w_{\\text{Flu}} = 0.3$。\n- 氨基酸计数：70个赖氨酸（Lys），20个精氨酸（Arg），10个天冬酰胺（Asn）。\n- 经验概率为：\n  $$p_{\\text{Lys}} = \\frac{70}{100} = 0.7$$\n  $$p_{\\text{Arg}} = \\frac{20}{100} = 0.2$$\n  $$p_{\\text{Asn}} = \\frac{10}{100} = 0.1$$\n- 香农熵 $H_{H1}$ 为：\n  $$H_{H1} = -(p_{\\text{Lys}} \\ln p_{\\text{Lys}} + p_{\\text{Arg}} \\ln p_{\\text{Arg}} + p_{\\text{Asn}} \\ln p_{\\text{Asn}}) = -(0.7 \\ln 0.7 + 0.2 \\ln 0.2 + 0.1 \\ln 0.1) \\approx 0.80182$$\n- 保守性得分 $C_{H1}$ 为：\n  $$C_{H1} = 1 - \\frac{H_{H1}}{\\ln 20} \\approx 1 - \\frac{0.80182}{2.99573} \\approx 0.73235$$\n- 选择排序得分 $R_{H1}$ 为：\n  $$R_{H1} = w_{\\text{Flu}} \\cdot C_{H1} \\approx 0.3 \\cdot 0.73235 \\approx 0.21970$$\n\n**甲型流感病毒血凝素（HA），位置 $H2$**\n- 病原体权重：$w_{\\text{Flu}} = 0.3$。\n- 氨基酸计数：95个丝氨酸（Ser），5个天冬酰胺（Asn）。\n- 经验概率为：\n  $$p_{\\text{Ser}} = \\frac{95}{100} = 0.95$$\n  $$p_{\\text{Asn}} = \\frac{5}{100} = 0.05$$\n- 香农熵 $H_{H2}$ 为：\n  $$H_{H2} = -(p_{\\text{Ser}} \\ln p_{\\text{Ser}} + p_{\\text{Asn}} \\ln p_{\\text{Asn}}) = -(0.95 \\ln 0.95 + 0.05 \\ln 0.05) \\approx 0.19851$$\n- 保守性得分 $C_{H2}$ 为：\n  $$C_{H2} = 1 - \\frac{H_{H2}}{\\ln 20} \\approx 1 - \\frac{0.19851}{2.99573} \\approx 0.93373$$\n- 选择排序得分 $R_{H2}$ 为：\n  $$R_{H2} = w_{\\text{Flu}} \\cdot C_{H2} \\approx 0.3 \\cdot 0.93373 \\approx 0.28012$$\n\n**结核分枝杆菌抗原 $85\\text{B}$（Ag85B），位置 $T1$**\n- 病原体权重：$w_{\\text{TB}} = 0.2$。\n- 氨基酸计数：98个亮氨酸（Leu），2个异亮氨酸（Ile）。\n- 经验概率为：\n  $$p_{\\text{Leu}} = \\frac{98}{100} = 0.98$$\n  $$p_{\\text{Ile}} = \\frac{2}{100} = 0.02$$\n- 香农熵 $H_{T1}$ 为：\n  $$H_{T1} = -(p_{\\text{Leu}} \\ln p_{\\text{Leu}} + p_{\\text{Ile}} \\ln p_{\\text{Ile}}) = -(0.98 \\ln 0.98 + 0.02 \\ln 0.02) \\approx 0.09804$$\n- 保守性得分 $C_{T1}$ 为：\n  $$C_{T1} = 1 - \\frac{H_{T1}}{\\ln 20} \\approx 1 - \\frac{0.09804}{2.99573} \\approx 0.96727$$\n- 选择排序得分 $R_{T1}$ 为：\n  $$R_{T1} = w_{\\text{TB}} \\cdot C_{T1} \\approx 0.2 \\cdot 0.96727 \\approx 0.19345$$\n\n**比较与最终答案**\n计算出的选择排序得分为：\n- $R_{E1} \\approx 0.44574$\n- $R_{E2} \\approx 0.38767$\n- $R_{H1} \\approx 0.21970$\n- $R_{H2} \\approx 0.28012$\n- $R_{T1} \\approx 0.19345$\n\n这些得分中的最大值是 $R_{E1}$。其值约为 $0.44574$。四舍五入到四位有效数字，我们得到 $0.4457$。",
            "answer": "$$\\boxed{0.4457}$$"
        },
        {
            "introduction": "在进行大规模临床试验之前，数学模型可以帮助我们预测疫苗在宿主体内可能发挥的作用。本练习将指导您建立并求解一个简化模型，该模型描述了结核分枝杆菌与免疫系统之间的动态博弈。您将通过该模型探索一款能增强 $IFN-\\gamma$ 反应的疫苗如何改变战局，最终帮助宿主控制感染，从而一窥计算系统生物学在疫苗研发中的威力 。",
            "id": "4704277",
            "problem": "一位开发者被要求构建并分析一个最小化的宿主体内动力学模型，用于描述在疫苗增强的$\\gamma$-干扰素 (IFN-$\\gamma$) 反应下结核病 (TB) 肉芽肿的控制情况。其目标是预测疫苗增强的 IFN-$\\gamma$ 产生对细菌载量轨迹的影响，并计算一个可解释的指标。该模型必须源自宿主-病原体相互作用的基本且经过充分检验的原理，然后进行数值实现和积分。\n\n使用以下基础来推导模型：\n- 宿主-病原体种群动力学：受资源限制的单位细菌复制可以用一个逻辑斯谛项来表示。如果 $B(t)$ 表示以菌落形成单位 (CFU) 计的细菌载量，那么其内在增长遵循单位速率 $r$ 和环境承载力 $K$，这意味着一个与逻辑斯谛种群动力学一致的基线净增长项。\n- 细胞因子调节的杀伤：单位细菌的免疫介导杀伤率随 IFN-$\\gamma$ 浓度 $I(t)$ 的增加而增加，并在高 $I(t)$ 时达到饱和。一个与巨噬细胞活化一致、源于酶动力学和受体占据理论的标准饱和激活函数是希尔函数，例如 $M(I) = \\dfrac{I^n}{I^n + \\theta^n}$，其中 $n$ 是希尔系数，$\\theta$ 是半饱和参数。杀伤项与 $M(I)$ 和细菌载量 $B(t)$ 成正比，比例系数为 $k$。\n- 抗原驱动的 IFN-$\\gamma$ 产生和线性衰减：IFN-$\\gamma$ 的产生与抗原（细菌）载量成比例，并因 T 细胞活化和抗原呈递受限而饱和。一个常见的选择是 $S(B) = \\dfrac{B}{B + h}$，其中 $h$ 是半饱和常数。IFN-$\\gamma$ 以线性速率 $\\delta_I$ 衰减。增强 IFN-$\\gamma$ 产生的疫苗会将产生速率乘以一个因子 $1 + \\eta$，其中 $\\eta$ 是一个小数（而不是百分比）。\n\n基于这些原理，推导 $B(t)$ 和 $I(t)$ 的耦合常微分方程，以描述：\n- 具有单位速率 $r$ 和环境承载力 $K$ 的逻辑斯谛细菌增长。\n- 与 $k M(I) B$ 成正比的 IFN-$\\gamma$ 依赖性杀伤。\n- 与 $S(B)$ 成正比的 IFN-$\\gamma$ 产生，其乘以一个基线速率 $s$ 和疫苗效应因子 $1 + \\eta$，并以速率 $\\delta_I$ 线性衰减。\n\n实现推导出的系统，并从 $t = 0$ 到 $t = T$ 天进行积分。使用初始条件 $B(0) = B_0$（单位：CFU）和 $I(0) = I_0$（单位：任意单位 a.u.）。积分应得出以 CFU 为单位的 $B(T)$。您的程序必须生成一行输出，包含一个方括号括起来的逗号分隔列表；每个测试用例的结果必须是等于 $B(T)$（单位：CFU）的浮点数，并四舍五入到三位有效数字。\n\n角度单位不适用。所有物理单位必须遵守：$B(t)$ 以 CFU 为单位， $I(t)$ 以任意单位 (a.u.) 为单位，时间 $t$ 以天为单位。疫苗效应 $\\eta$ 必须始终被视为小数（例如，$\\eta = 0.5$ 表示增加因子为 0.5，而不是 50%）。\n\n测试套件和参数：\n在以下4组参数集上实现并评估模型，这些参数集旨在测试解的不同方面。在所有情况下，单位均如上所述，$T$ 的单位是天。\n\n- 情况 1 (基线，控制不足): \n  $r = 0.3$, $K = 10^7$, $k = 0.5$, $n = 2$, $\\theta = 0.5$, $s = 0.6$, $\\eta = 0.0$, $h = 10^5$, $\\delta_I = 1.0$, $B_0 = 10^3$, $I_0 = 0.0$, $T = 180$。\n- 情况 2 (疫苗，中度增强):\n  $r = 0.3$, $K = 10^7$, $k = 0.5$, $n = 2$, $\\theta = 0.5$, $s = 0.6$, $\\eta = 0.5$, $h = 10^5$, $\\delta_I = 1.0$, $B_0 = 10^3$, $I_0 = 0.0$, $T = 180$。\n- 情况 3 (疫苗，强力增强):\n  $r = 0.3$, $K = 10^7$, $k = 0.5$, $n = 2$, $\\theta = 0.5$, $s = 0.6$, $\\eta = 2.0$, $h = 10^5$, $\\delta_I = 1.0$, $B_0 = 10^3$, $I_0 = 0.0$, $T = 180$。\n- 情况 4 (边缘情况，无 IFN-$\\gamma$ 产生):\n  $r = 0.3$, $K = 10^7$, $k = 0.5$, $n = 2$, $\\theta = 0.5$, $s = 0.0$, $\\eta = 0.0$, $h = 10^5$, $\\delta_I = 1.0$, $B_0 = 10^3$, $I_0 = 0.0$, $T = 180$。\n\n您的程序应生成一行输出，其中包含一个方括号括起来的逗号分隔列表，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是情况 $i$ 的最终细菌载量 $B(T)$（单位：CFU），四舍五入到三位有效数字并表示为浮点数。",
            "solution": "用户提供了一个问题陈述，要求推导和数值求解一个描述结核病 (TB) 肉芽肿动力学的常微分方程组 (ODEs)。我将首先根据指定标准验证该问题陈述。\n\n### 问题验证\n\n#### 步骤 1：提取已知信息\n已知信息如下：\n- **状态变量**：\n    - $B(t)$：细菌载量，单位为菌落形成单位 (CFU)。\n    - $I(t)$：$\\gamma$-干扰素 (IFN-$\\gamma$) 浓度，单位为任意单位 (a.u.)。\n- **时间**：$t$，单位为天。\n- **模型组件**：\n    - 细菌增长：逻辑斯谛增长，单位速率为 $r$，环境承载力为 $K$。\n    - 免疫介导的杀伤：与细菌载量 $B(t)$ 和 IFN-$\\gamma$ 的饱和函数 $M(I) = \\dfrac{I^n}{I^n + \\theta^n}$ 成正比，杀伤率系数为 $k$。\n    - IFN-$\\gamma$ 产生：与细菌载量的饱和函数 $S(B) = \\dfrac{B}{B + h}$ 成正比，基线产生速率为 $s$，疫苗增强因子为 $(1 + \\eta)$。$\\eta$ 是一个小数。\n    - IFN-$\\gamma$ 衰减：线性衰减，速率为 $\\delta_I$。\n- **初始条件**：$B(0) = B_0$ 和 $I(0) = I_0$。\n- **积分区间**：从 $t=0$ 到 $t=T$。\n- **输出要求**：每个测试用例的最终细菌载量 $B(T)$，单位为 CFU，四舍五入到三位有效数字。\n- **测试用例参数**：\n    - **情况 1**：$r = 0.3$, $K = 10^7$, $k = 0.5$, $n = 2$, $\\theta = 0.5$, $s = 0.6$, $\\eta = 0.0$, $h = 10^5$, $\\delta_I = 1.0$, $B_0 = 10^3$, $I_0 = 0.0$, $T = 180$。\n    - **情况 2**：$\\eta = 0.5$，所有其他参数与情况 1 相同。\n    - **情况 3**：$\\eta = 2.0$，所有其他参数与情况 1 相同。\n    - **情况 4**：$s = 0.0$, $\\eta = 0.0$，所有其他参数与情况 1 相同。\n\n#### 步骤 2：使用提取的已知信息进行验证\n根据验证标准对问题进行评估：\n- **科学依据**：该问题有效。它采用了种群生物学和免疫学中标准、广为接受的数学结构。逻辑斯谛增长是模拟资源有限的种群动态的经典模型。希尔函数和类米氏-门顿饱和项是模拟酶动力学、受体-配体相互作用以及包括细胞因子产生和作用在内的其他可饱和生物过程的标准方法。该模型虽然是简化模型，但基于基本且合理的宿主-病原体相互作用原理。\n- **适定性**：该问题有效。它要求对一组常微分方程的初值问题系统进行数值求解。定义导数的函数是初等函数的复合，确保它们在感兴趣的域 ($B \\ge 0, I \\ge 0$) 上是连续可微的（因此是利普希茨连续的）。这保证了给定初始条件下解的存在性和唯一性。数值求解所需的所有必要参数和条件都已明确提供。\n- **客观性**：该问题有效。它使用精确、量化的语言和数学表达式进行阐述，没有主观或模糊的元素。\n\n该问题没有显示无效清单中列出的任何缺陷。它在科学上是合理的，说明是完整的，并且是可计算求解的。\n\n#### 步骤 3：结论与行动\n该问题**有效**。我将继续推导数学模型并实现数值解。\n\n### 模型推导与求解策略\n\n根据问题陈述中概述的原理，我们可以构建耦合常微分方程组。\n\n细菌载量的变化率 $\\frac{dB}{dt}$ 是逻辑斯谛增长项和免疫介导杀伤项的总和。\n- 逻辑斯谛增长：$r B \\left(1 - \\frac{B}{K}\\right)$\n- IFN-$\\gamma$ 介导的杀伤：$-k M(I) B = -k \\left(\\frac{I^n}{I^n + \\theta^n}\\right) B$\n\n将这两项结合起来得到第一个方程：\n$$\n\\frac{dB}{dt} = r B \\left(1 - \\frac{B}{K}\\right) - k \\frac{I^n}{I^n + \\theta^n} B\n$$\n\nIFN-$\\gamma$ 濃度的变化率 $\\frac{dI}{dt}$ 是抗原驱动产生项和线性衰减项的总和。\n- 疫苗增强的产生：$s (1 + \\eta) S(B) = s (1 + \\eta) \\frac{B}{B + h}$\n- 线性衰减：$-\\delta_I I$\n\n将这两项结合起来得到第二个方程：\n$$\n\\frac{dI}{dt} = s (1 + \\eta) \\frac{B}{B + h} - \\delta_I I\n$$\n\n需要求解的完整系统是：\n$$\n\\begin{cases}\n\\frac{dB}{dt} = r B \\left(1 - \\frac{B}{K}\\right) - k \\frac{I^n}{I^n + \\theta^n} B \\\\\n\\frac{dI}{dt} = s (1 + \\eta) \\frac{B}{B + h} - \\delta_I I\n\\end{cases}\n$$\n初始条件为 $B(0) = B_0$ 和 $I(0) = I_0$。\n\n为了求解这个系统，我们将使用一个数值 ODE 求解器。SciPy 库中的 `scipy.integrate.solve_ivp` 函数是实现此目的的合适且强大的工具。它实现了几种自适应步长的数值方法（例如，龙格-库塔法）来求解初值问题。\n\n对于四个测试用例中的每一个，我们将：\n1. 定义一个函数，根据当前状态 $(B, I)$、时间 $t$ 和模型参数计算导数 $(\\frac{dB}{dt}, \\frac{dI}{dt})$。\n2. 根据情况说明设置参数向量 $(r, K, k, n, \\theta, s, \\eta, h, \\delta_I)$ 和初始状态向量 $(B_0, I_0)$。\n3. 调用 `solve_ivp` 在时间区间 $[0, T]$ 上对系统进行积分。\n4. 从解对象中提取最终细菌载量 $B(T)$。这将是解向量第一个分量的最后一个元素。\n5. 将得到的 $B(T)$ 值四舍五入到三位有效数字。这可以通过使用通用格式说明符 (`g`) 将数字转换为字符串，然后将其解析回浮点数来实现。对于数字 `x`，操作为 `float(f\"{x:.3g}\")`。\n6. 将所有情况的四舍五入结果收集到一个列表中。\n7. 将列表格式化为所需的输出字符串：一个由方括号括起来的逗号分隔的浮点数列表。\n\n此过程将按照问题中的规定在 Python 脚本中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives, implements, and solves a minimal model of TB granuloma dynamics\n    to predict bacillary load under different immune enhancement scenarios.\n    \"\"\"\n\n    def round_to_sf(x, sf):\n        \"\"\"\n        Rounds a number to a specified number of significant figures.\n\n        Args:\n            x (float): The number to round.\n            sf (int): The number of significant figures.\n\n        Returns:\n            float: The rounded number.\n        \"\"\"\n        if x == 0:\n            return 0.0\n        # Use general format specifier 'g' which handles significant digits,\n        # then cast back to float.\n        return float(f\"{x:.{sf}g}\")\n\n    def model_odes(t, y, params):\n        \"\"\"\n        Defines the system of ODEs for the TB granuloma model.\n\n        Args:\n            t (float): Time.\n            y (list or np.ndarray): State vector [B, I].\n            params (tuple): Model parameters.\n\n        Returns:\n            list: The derivatives [dB/dt, dI/dt].\n        \"\"\"\n        B, I = y\n        r, K, k, n, theta, s, eta, h, delta_I = params\n\n        # Ensure bacillary load is non-negative to prevent numerical issues\n        B = max(0, B)\n\n        # Equation for bacillary load B(t)\n        logistic_growth = r * B * (1 - B / K)\n        killing_term = k * (I**n / (I**n + theta**n)) * B\n        dB_dt = logistic_growth - killing_term\n\n        # Equation for IFN-gamma concentration I(t)\n        production_term = s * (1 + eta) * (B / (B + h))\n        decay_term = delta_I * I\n        dI_dt = production_term - decay_term\n\n        return [dB_dt, dI_dt]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (baseline, subcontainment)\n        {'r': 0.3, 'K': 1e7, 'k': 0.5, 'n': 2, 'theta': 0.5, 's': 0.6, 'eta': 0.0, 'h': 1e5, 'delta_I': 1.0, 'B0': 1e3, 'I0': 0.0, 'T': 180},\n        # Case 2 (vaccine, moderate enhancement)\n        {'r': 0.3, 'K': 1e7, 'k': 0.5, 'n': 2, 'theta': 0.5, 's': 0.6, 'eta': 0.5, 'h': 1e5, 'delta_I': 1.0, 'B0': 1e3, 'I0': 0.0, 'T': 180},\n        # Case 3 (vaccine, strong enhancement)\n        {'r': 0.3, 'K': 1e7, 'k': 0.5, 'n': 2, 'theta': 0.5, 's': 0.6, 'eta': 2.0, 'h': 1e5, 'delta_I': 1.0, 'B0': 1e3, 'I0': 0.0, 'T': 180},\n        # Case 4 (edge case, no IFN-gamma production)\n        {'r': 0.3, 'K': 1e7, 'k': 0.5, 'n': 2, 'theta': 0.5, 's': 0.0, 'eta': 0.0, 'h': 1e5, 'delta_I': 1.0, 'B0': 1e3, 'I0': 0.0, 'T': 180}\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        params = (\n            case['r'], case['K'], case['k'], case['n'], case['theta'],\n            case['s'], case['eta'], case['h'], case['delta_I']\n        )\n        y0 = [case['B0'], case['I0']]\n        t_span = [0, case['T']]\n        \n        # Numerically integrate the ODE system\n        # dense_output=True allows for evaluation at any point in the interval\n        solution = solve_ivp(\n            model_odes,\n            t_span,\n            y0,\n            args=(params,),\n            dense_output=True,\n            method='RK45'\n        )\n\n        # Extract the final bacillary load B(T)\n        # sol.y is an array of shape (n_equations, n_timepoints)\n        # The last value corresponds to B(T)\n        final_B = solution.y[0, -1]\n\n        # Round to three significant figures\n        rounded_B = round_to_sf(final_B, 3)\n        results.append(rounded_B)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从临床数据中准确评估疫苗的真实效力并非易事，因为研究中的不同人群可能存在不相等的基线风险，这些差异即为“混杂因素”。本实践将带您直面这一现实挑战，运用直接标准化法 (direct standardization) 来校正混杂因素，从而计算出调整后的疫苗效力。通过处理一个在HIV阳性队列中进行的流感疫苗试验的假设数据，您将掌握一项关键的流行病学技术，以获得更精确、更可靠的评估结果 。",
            "id": "4704294",
            "problem": "一项随机、开放标签的前瞻性队列研究招募了感染人类免疫缺陷病毒（HIV）的成年人，在某一流感季节开始前，旨在评估灭活流感疫苗在该季节内的保护效果。免疫状况通过基线CD4+ T细胞（分化群4）计数进行分层总结：$S_{1}: \\text{CD4}  200$ 个细胞$/\\mu\\text{L}$，$S_{2}: 200 \\le \\text{CD4}  500$ 个细胞$/\\mu\\text{L}$，以及 $S_{3}: \\text{CD4} \\ge 500$ 个细胞$/\\mu\\text{L}$。参与者被分为接种疫苗组（疫苗组）或不接种疫苗组（未接种组）。在所有参与者中确认整个季节内经实验室确诊的流感感染情况。观察到以下计数：\n\n- 疫苗接种组：$S_1$ 层有 $N_{v1} = 600$ 人，其中 $C_{v1} = 90$ 例事件；$S_2$ 层有 $N_{v2} = 1800$ 人，其中 $C_{v2} = 126$ 例事件；$S_3$ 层有 $N_{v3} = 1600$ 人，其中 $C_{v3} = 96$ 例事件。\n- 未接种疫苗组：$S_1$ 层有 $N_{u1} = 400$ 人，其中 $C_{u1} = 120$ 例事件；$S_2$ 层有 $N_{u2} = 1200$ 人，其中 $C_{u2} = 180$ 例事件；$S_3$ 层有 $N_{u3} = 800$ 人，其中 $C_{u3} = 120$ 例事件。\n\n为处理基线CD4 T细胞计数造成的混杂，请使用直接标准化方法，将其标准化到一个共同的CD4分布。该分布由两组的合并基线分层计数定义。仅从风险、风险比和直接标准化的定义出发，且不使用任何专门的“现成”估计量，推导出一个调整后疫苗有效性的表达式，该表达式用于比较疫苗接种组经CD4标准化的风险与未接种疫苗组经CD4标准化的风险。然后，将调整后的疫苗有效性计算为一个十进制数。\n\n说明：\n- 将每层中的风险视为 $r_{gi} = C_{gi}/N_{gi}$，其中组别 $g \\in \\{v,u\\}$，分层 $i \\in \\{1,2,3\\}$。\n- 使用权重 $w_{i}$，其值等于两组在分层 $i$ 中的合并基线比例。\n- 报告最终的调整后疫苗有效性，结果为一个介于0和1之间的小数（无百分号），并四舍五入至四位有效数字。",
            "solution": "问题要求通过使用直接标准化方法，来计算调整后的疫苗有效性（$VE_{adj}$），以控制基线CD4 T细胞计数（分化群4）造成的混杂。该分析将从基本定义出发进行。\n\n设 $g$ 表示组别，其中 $g=v$ 代表疫苗接种组，$g=u$ 代表未接种疫苗组。设 $i$ 表示基于CD4计数的分层，其中 $i \\in \\{1, 2, 3\\}$。提供的数据如下：\n对于疫苗接种组：\n- 分层1：$N_{v1}=600$ 名参与者，$C_{v1}=90$ 例流感事件。\n- 分层2：$N_{v2}=1800$ 名参与者，$C_{v2}=126$ 例流感事件。\n- 分层3：$N_{v3}=1600$ 名参与者，$C_{v3}=96$ 例流感事件。\n\n对于未接种疫苗组：\n- 分层1：$N_{u1}=400$ 名参与者，$C_{u1}=120$ 例流感事件。\n- 分层2：$N_{u2}=1200$ 名参与者，$C_{u2}=180$ 例流感事件。\n- 分层3：$N_{u3}=800$ 名参与者，$C_{u3}=120$ 例流感事件。\n\n第一步是为每个组定义和计算分层特定的流感风险。组 $g$ 和分层 $i$ 中的风险 $r_{gi}$ 定义为事件数 $C_{gi}$ 除以参与者数 $N_{gi}$：\n$$r_{gi} = \\frac{C_{gi}}{N_{gi}}$$\n对于疫苗接种组，分层特定风险为：\n$$r_{v1} = \\frac{C_{v1}}{N_{v1}} = \\frac{90}{600} = 0.15$$\n$$r_{v2} = \\frac{C_{v2}}{N_{v2}} = \\frac{126}{1800} = 0.07$$\n$$r_{v3} = \\frac{C_{v3}}{N_{v3}} = \\frac{96}{1600} = 0.06$$\n对于未接种疫苗组，分层特定风险为：\n$$r_{u1} = \\frac{C_{u1}}{N_{u1}} = \\frac{120}{400} = 0.30$$\n$$r_{u2} = \\frac{C_{u2}}{N_{u2}} = \\frac{180}{1200} = 0.15$$\n$$r_{u3} = \\frac{C_{u3}}{N_{u3}} = \\frac{120}{800} = 0.15$$\n\n接下来，我们以一个共同的标准人群为基准进行直接标准化。问题指定这个标准人群为疫苗接种组和未接种疫苗组的合并人群。每个分层的权重 $w_i$ 是该分层在总合并人群中所占的比例。\n首先，我们计算每个分层中的总参与者人数 $N_i$：\n$$N_1 = N_{v1} + N_{u1} = 600 + 400 = 1000$$\n$$N_2 = N_{v2} + N_{u2} = 1800 + 1200 = 3000$$\n$$N_3 = N_{v3} + N_{u3} = 1600 + 800 = 2400$$\n所有分层的总人数 $N_{total}$ 为：\n$$N_{total} = N_1 + N_2 + N_3 = 1000 + 3000 + 2400 = 6400$$\n然后，标准化权重 $w_i$ 按 $w_i = N_i / N_{total}$ 计算得出：\n$$w_1 = \\frac{1000}{6400} = \\frac{10}{64} = \\frac{5}{32} = 0.15625$$\n$$w_2 = \\frac{3000}{6400} = \\frac{30}{64} = \\frac{15}{32} = 0.46875$$\n$$w_3 = \\frac{2400}{6400} = \\frac{24}{64} = \\frac{3}{8} = 0.375$$\n权重之和为 $w_1 + w_2 + w_3 = \\frac{5}{32} + \\frac{15}{32} + \\frac{12}{32} = \\frac{32}{32} = 1$，符合预期。\n\n组 $g$ 的标准化风险，记为 $R_g$，是其分层特定风险的加权平均值，权重来自标准人群：\n$$R_g = \\sum_{i=1}^{3} w_i r_{gi}$$\n对于疫苗接种组，标准化风险 $R_v$ 为：\n$$R_v = w_1 r_{v1} + w_2 r_{v2} + w_3 r_{v3} = (0.15625)(0.15) + (0.46875)(0.07) + (0.375)(0.06)$$\n$$R_v = 0.0234375 + 0.0328125 + 0.0225 = 0.07875$$\n对于未接种疫苗组，标准化风险 $R_u$ 为：\n$$R_u = w_1 r_{u1} + w_2 r_{u2} + w_3 r_{u3} = (0.15625)(0.30) + (0.46875)(0.15) + (0.375)(0.15)$$\n$$R_u = 0.046875 + 0.0703125 + 0.05625 = 0.1734375$$\n\n疫苗有效性（$VE$）定义为接种疫苗组相较于未接种疫苗组的风险降低比例。当使用标准化风险时，这便成为调整后的疫苗有效性 $VE_{adj}$。它的计算基于调整后的风险比（$RR_{adj}$），即标准化风险的比率, $RR_{adj} = R_v / R_u$：\n$$VE_{adj} = 1 - RR_{adj} = 1 - \\frac{R_v}{R_u}$$\n从定义出发，推导出的调整后疫苗有效性的表达式为：\n$$VE_{adj} = 1 - \\frac{\\sum_{i=1}^{3} w_i r_{vi}}{\\sum_{i=1}^{3} w_i r_{ui}} = 1 - \\frac{\\sum_{i=1}^{3} \\left( \\frac{N_{vi} + N_{ui}}{N_{total}} \\right) \\left( \\frac{C_{vi}}{N_{vi}} \\right)}{\\sum_{i=1}^{3} \\left( \\frac{N_{vi} + N_{ui}}{N_{total}} \\right) \\left( \\frac{C_{ui}}{N_{ui}} \\right)}$$\n$N_{total}$ 项可以消去，从而得到：\n$$VE_{adj} = 1 - \\frac{\\sum_{i=1}^{3} (N_{vi} + N_{ui}) \\frac{C_{vi}}{N_{vi}}}{\\sum_{i=1}^{3} (N_{vi} + N_{ui}) \\frac{C_{ui}}{N_{ui}}}$$\n现在，我们使用计算出的标准化风险来计算 $VE_{adj}$ 的数值：\n$$VE_{adj} = 1 - \\frac{0.07875}{0.1734375}$$\n为了精确计算，我们可以使用在计算标准化风险过程中推导出的分数形式：\n$R_v = \\frac{252}{3200} = \\frac{63}{800}$ 且 $R_u = \\frac{5.55}{32} = \\frac{555}{3200} = \\frac{111}{640}$。\n$$VE_{adj} = 1 - \\frac{63/800}{111/640} = 1 - \\left(\\frac{63}{800} \\cdot \\frac{640}{111}\\right) = 1 - \\left(\\frac{63}{111} \\cdot \\frac{640}{800}\\right) = 1 - \\left(\\frac{21 \\cdot 3}{37 \\cdot 3} \\cdot \\frac{4 \\cdot 160}{5 \\cdot 160}\\right) = 1 - \\left(\\frac{21}{37} \\cdot \\frac{4}{5}\\right)$$\n$$VE_{adj} = 1 - \\frac{84}{185} = \\frac{185 - 84}{185} = \\frac{101}{185}$$\n将此分数转换为小数：\n$$VE_{adj} = \\frac{101}{185} \\approx 0.545945945...$$\n问题要求结果四舍五入到四位有效数字。前四位有效数字是 $5$、$4$、$5$ 和 $9$。第五位有效数字是 $4$，小于 $5$，因此我们向下舍入。\n$$VE_{adj} \\approx 0.5459$$\n因此，在控制了基线CD4 T细胞计数的混杂因素后，调整后的疫苗有效性约为 $0.5459$。",
            "answer": "$$\\boxed{0.5459}$$"
        }
    ]
}