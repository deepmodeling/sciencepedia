{
    "hands_on_practices": [
        {
            "introduction": "任何单克隆抗体的功效都始于其与靶标的结合能力。为了量化这种基本相互作用，我们使用“分数占据率”这一概念，它描述了在给定抗体浓度下与抗体结合的靶分子比例。本练习将引导您从第一性原理出发，推导抗体浓度、结合亲和力（$K_{D}$）与分数占据率之间的关系，为理解剂量-反应关系奠定基石。",
            "id": "4668994",
            "problem": "一种用作传染病宿主导向治疗的单克隆抗体 (mAb) 以 1:1 ($1{:}1$) 的化学计量比与一种可溶性炎症配体结合，形成一个可逆的复合物。在平衡状态下，该可逆反应可写作 $M + L \\rightleftharpoons ML$，其中 $M$ 表示游离的抗体结合位点，$L$ 表示游离的配体，$ML$ 表示已结合的复合物。平衡解离常数由质量作用定律定义为 $K_{D} \\equiv \\frac{[M][L]}{[ML]}$。设抗体结合位点的总浓度为 $R_{T} \\equiv [M] + [ML]$，并将分数占据率定义为 $\\theta \\equiv \\frac{[ML]}{R_{T}}$，它代表被配体占据的抗体结合位点的比例。仅使用这些定义和平衡状态下的质量守恒，推导出此 $1{:}1$ 结合模型的 $\\theta = f([L],K_{D})$ 关系。然后，在 $[L] = 9K_{D}$ 时计算 $\\theta$ 的值并报告其数值。将 $\\theta$ 的最终数值表示为小数，并四舍五入到 $4$ 位有效数字。$\\theta$ 无需单位。",
            "solution": "题目要求对于一个 $1{:}1$ 的可逆结合反应，推导分数占据率 $\\theta$ 作为游离配体浓度 $[L]$ 和平衡解离常数 $K_{D}$ 的函数关系。随后，必须使用该关系式计算当 $[L] = 9K_{D}$ 时 $\\theta$ 的值。\n\n首先，我们开始验证过程。\n\n### 步骤1：提取已知条件\n题目提供了以下定义和条件：\n- 平衡时的可逆反应：$M + L \\rightleftharpoons ML$。\n- 结合的化学计量比为 1:1 ($1{:}1$)。\n- 平衡解离常数定义为 $K_{D} \\equiv \\frac{[M][L]}{[ML]}$。\n- 抗体结合位点的总浓度定义为 $R_{T} \\equiv [M] + [ML]$。\n- 分数占据率定义为 $\\theta \\equiv \\frac{[ML]}{R_{T}}$。\n- 目标是推导 $\\theta = f([L], K_{D})$，然后在特定条件 $[L] = 9K_{D}$ 下计算 $\\theta$。\n- 最终数值答案必须是四舍五入到 $4$ 位有效数字的小数。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它描述了受质量作用定律支配的单价配体-受体结合的标准模型。这是药理学和生物化学中的一个基本概念，通常被称为朗缪尔结合等温线 (Langmuir binding isotherm)。术语 $K_D$、$R_T$ 和 $\\theta$ 的定义标准且明确。该问题提法恰当、内容自洽，并提供了推导所求关系式和进行计算所需的所有信息。其中没有矛盾、事实错误或主观论断。\n\n### 步骤3：结论与行动\n问题有效。现在开始进行推导和计算。\n\n目标是仅用 $[L]$ 和 $K_{D}$ 来表示 $\\theta$。我们从分数占据率的定义开始：\n$$ \\theta = \\frac{[ML]}{R_{T}} $$\n使用抗体结合位点总浓度的定义 $R_{T} = [M] + [ML]$，我们可以将其代入 $\\theta$ 的表达式中：\n$$ \\theta = \\frac{[ML]}{[M] + [ML]} $$\n为了消去未知浓度 $[M]$ 和 $[ML]$，我们使用平衡解离常数 $K_{D}$ 的定义：\n$$ K_{D} = \\frac{[M][L]}{[ML]} $$\n从这个方程中，我们可以重新整理，用 $[ML]$、$[L]$ 和 $K_{D}$ 来表示游离抗体结合位点的浓度 $[M]$：\n$$ [M] = \\frac{K_{D}[ML]}{[L]} $$\n现在，我们将这个 $[M]$ 的表达式代回到我们的 $\\theta$ 方程中：\n$$ \\theta = \\frac{[ML]}{\\left(\\frac{K_{D}[ML]}{[L]}\\right) + [ML]} $$\n项 $[ML]$ 是分母中的公因式，也出现在分子中。我们可以从分母中提取出它：\n$$ \\theta = \\frac{[ML]}{[ML] \\left(\\frac{K_{D}}{[L]} + 1\\right)} $$\n假设复合物浓度 $[ML]$ 不为零（这是发生任何结合所必需的），我们可以约去分子和分母中的 $[ML]$：\n$$ \\theta = \\frac{1}{\\frac{K_{D}}{[L]} + 1} $$\n为了将此表达式简化为更常规的形式，我们可以将分子和分母同时乘以 $[L]$：\n$$ \\theta = \\frac{1 \\cdot [L]}{\\left(\\frac{K_{D}}{[L]} + 1\\right) \\cdot [L]} = \\frac{[L]}{K_{D} + [L]} $$\n这就得到了所求的分数占据率作为游离配体浓度和解离常数的函数关系：\n$$ \\theta = \\frac{[L]}{[L] + K_{D}} $$\n这是著名的 Hill-Langmuir 方程，适用于具有单一类别独立结合位点的系统（Hill 系数为 $1$）。\n\n问题的第二部分要求在游离配体浓度是解离常数九倍的特定情况下计算 $\\theta$ 的值，即 $[L] = 9K_{D}$。我们将这个条件代入我们推导出的 $\\theta$ 方程中：\n$$ \\theta = \\frac{9K_{D}}{9K_{D} + K_{D}} $$\n我们可以从分母中提取出 $K_{D}$：\n$$ \\theta = \\frac{9K_{D}}{K_{D}(9 + 1)} = \\frac{9K_{D}}{10K_{D}} $$\n由于 $K_{D}$ 是一个非零常数，它可以从分子和分母中约去：\n$$ \\theta = \\frac{9}{10} $$\n其数值为：\n$$ \\theta = 0.9 $$\n题目要求将此值表示为四舍五入到 $4$ 位有效数字的小数。为了用四位有效数字表示 $0.9$，我们在后面追加零：\n$$ \\theta = 0.9000 $$\n这表明在此上下文中，该值的精度已知到小数点后四位。",
            "answer": "$$\n\\boxed{0.9000}\n$$"
        },
        {
            "introduction": "单克隆抗体在给药后，其在体内的浓度并非均匀衰减，而是在不同生理房室间进行分布。这种行为最适合用多房室药代动力学模型来描述。本练习要求您从一个双房室模型的基本质量平衡方程出发，推导一种IgG抗体的终末半衰期。这项技能对于预测单抗疗法的作用持续时间以及设计合理的给药间隔至关重要。",
            "id": "4668970",
            "problem": "一种旨在作为传染病宿主导向疗法的全人源免疫球蛋白G (IgG) 单克隆抗体以单次静脉推注的方式给药。其处置遵循线性双室药代动力学 (PK) 模型，仅从中央室消除。设时间 $t$ 时中央室的药物量为 $X_{1}(t)$，外周室的药物量为 $X_{2}(t)$。该模型由质量平衡和线性动力学控制，参数包括系统清除率 $CL$、室间清除率 $Q$、中央室容积 $V_{1}$ 和外周室容积 $V_{2}$。根据定义，微观速率常数为 $k_{10} = CL/V_{1}$、$k_{12} = Q/V_{1}$ 和 $k_{21} = Q/V_{2}$。\n\n从房室质量平衡方程出发，并且不使用任何预先推导的宏观参数公式，推导终末（慢）一级速率常数，并用它来计算终末半衰期 $t_{1/2}$。使用以下对于IgG疗法而言是典型的值：\n- $CL = 0.2$ 升·天$^{-1}$,\n- $Q = 0.5$ 升·天$^{-1}$,\n- $V_{1} = 3.0$ 升,\n- $V_{2} = 4.0$ 升。\n\n将 $t_{1/2}$ 的最终数值结果四舍五入至四位有效数字。以天为单位表示最终答案。",
            "solution": "问题要求从基本的质量平衡方程出发，推导由双室药代动力学模型描述的药物的终末半衰期。\n\n该模型由一个中央室 (1) 和一个外周室 (2) 组成。设 $X_1(t)$ 和 $X_2(t)$ 分别为时间 $t$ 时中央室和外周室中的药物量。该系统由以下参数描述：系统清除率 ($CL$)、室间清除率 ($Q$) 以及中央室 ($V_1$) 和外周室 ($V_2$) 的容积。\n\n首先，我们建立控制每个房室中药物量变化率的线性常微分方程 (ODE) 组。\n\n对于中央室，药物量的变化是流入和流出该室的流量之和。药物从外周室进入，并通过从体内消除和分布到外周室两种途径离开。\n从中央室消除的速率为 $k_{10} X_1$。\n从中央室转移到外周室的速率为 $k_{12} X_1$。\n从外周室转移到中央室的速率为 $k_{21} X_2$。\n中央室的质量平衡方程为：\n$$ \\frac{dX_1}{dt} = k_{21} X_2 - k_{12} X_1 - k_{10} X_1 = -(k_{10} + k_{12})X_1 + k_{21}X_2 $$\n\n对于外周室，药物从中央室进入，并通过返回中央室离开。该室没有药物消除。\n从中央室转移到外周室的速率为 $k_{12} X_1$。\n从外周室转移到中央室的速率为 $k_{21} X_2$。\n外周室的质量平衡方程为：\n$$ \\frac{dX_2}{dt} = k_{12} X_1 - k_{21} X_2 $$\n\n这个一阶线性常微分方程组可以写成矩阵形式：\n$$ \\frac{d}{dt} \\begin{pmatrix} X_1 \\\\ X_2 \\end{pmatrix} = \\begin{pmatrix} -(k_{10} + k_{12}) & k_{21} \\\\ k_{12} & -k_{21} \\end{pmatrix} \\begin{pmatrix} X_1 \\\\ X_2 \\end{pmatrix} $$\n该系统的解是指数项 $e^{\\lambda t}$ 的和，其中 $\\lambda$ 代表系数矩阵的特征值。在药代动力学中，这些通常表示为负的速率常数，即 $-\\alpha$ 和 $-\\beta$。特征值 $\\lambda$ 是特征方程 $\\det(A - \\lambda I) = 0$ 的根，其中 $A$ 是系数矩阵。\n$$ \\det\\left( \\begin{pmatrix} -(k_{10} + k_{12}) & k_{21} \\\\ k_{12} & -k_{21} \\end{pmatrix} - \\begin{pmatrix} \\lambda & 0 \\\\ 0 & \\lambda \\end{pmatrix} \\right) = 0 $$\n$$ \\det \\begin{pmatrix} -(k_{10} + k_{12}) - \\lambda & k_{21} \\\\ k_{12} & -k_{21} - \\lambda \\end{pmatrix} = 0 $$\n展开行列式得到特征多项式：\n$$ (-(k_{10} + k_{12}) - \\lambda)(-k_{21} - \\lambda) - (k_{12})(k_{21}) = 0 $$\n$$ (\\lambda + k_{10} + k_{12})(\\lambda + k_{21}) - k_{12}k_{21} = 0 $$\n$$ \\lambda^2 + k_{21}\\lambda + (k_{10} + k_{12})\\lambda + (k_{10} + k_{12})k_{21} - k_{12}k_{21} = 0 $$\n$$ \\lambda^2 + (k_{10} + k_{12} + k_{21})\\lambda + k_{10}k_{21} + k_{12}k_{21} - k_{12}k_{21} = 0 $$\n$$ \\lambda^2 + (k_{10} + k_{12} + k_{21})\\lambda + k_{10}k_{21} = 0 $$\n药物量 $X_1(t)$ 和 $X_2(t)$ 的解是 $e^{\\lambda_1 t}$ 和 $e^{\\lambda_2 t}$ 的线性组合，其中 $\\lambda_1$ 和 $\\lambda_2$ 是这个二次方程的两个根。药代动力学速率常数（记为 $\\alpha$ 和 $\\beta$）被定义为这些特征值的负数，因此 $\\alpha = -\\lambda_1$ 且 $\\beta = -\\lambda_2$。将 $\\lambda = -r$（其中 $r$ 是一个速率常数）代入特征方程：\n$$ (-r)^2 + (k_{10} + k_{12} + k_{21})(-r) + k_{10}k_{21} = 0 $$\n$$ r^2 - (k_{10} + k_{12} + k_{21})r + k_{10}k_{21} = 0 $$\n这是一个关于宏观速率常数 $\\alpha$ 和 $\\beta$ 的二次方程。使用二次公式，其根为：\n$$ r = \\frac{(k_{10} + k_{12} + k_{21}) \\pm \\sqrt{(k_{10} + k_{12} + k_{21})^2 - 4(k_{10}k_{21})}}{2} $$\n按照惯例，$\\alpha$ 是较大的根（代表较快的初始分布阶段），$\\beta$ 是较小的根（代表较慢的终末消除阶段）。问题要求的是终末（慢）速率常数，即 $\\beta$：\n$$ \\beta = \\frac{(k_{10} + k_{12} + k_{21}) - \\sqrt{(k_{10} + k_{12} + k_{21})^2 - 4(k_{10}k_{21})}}{2} $$\n接下来，我们根据给定参数计算微观速率常数 $k_{10}$、$k_{12}$ 和 $k_{21}$ 的数值：\n$CL = 0.2$ 升·天$^{-1}$\n$Q = 0.5$ 升·天$^{-1}$\n$V_1 = 3.0$ 升\n$V_2 = 4.0$ 升\n\n$$ k_{10} = \\frac{CL}{V_1} = \\frac{0.2}{3.0} \\text{ 天}^{-1} = \\frac{1}{15} \\text{ 天}^{-1} $$\n$$ k_{12} = \\frac{Q}{V_1} = \\frac{0.5}{3.0} \\text{ 天}^{-1} = \\frac{1}{6} \\text{ 天}^{-1} $$\n$$ k_{21} = \\frac{Q}{V_2} = \\frac{0.5}{4.0} \\text{ 天}^{-1} = \\frac{1}{8} \\text{ 天}^{-1} $$\n现在我们将这些值代入 $\\beta$ 的表达式中。首先，我们计算和项与积项：\n和：$S = k_{10} + k_{12} + k_{21} = \\frac{1}{15} + \\frac{1}{6} + \\frac{1}{8}$。15、6和8的最小公倍数是120。\n$$ S = \\frac{8}{120} + \\frac{20}{120} + \\frac{15}{120} = \\frac{43}{120} \\text{ 天}^{-1} $$\n积：$P = k_{10}k_{21} = \\frac{1}{15} \\times \\frac{1}{8} = \\frac{1}{120} \\text{ 天}^{-2} $。\n现在我们可以计算 $\\beta$：\n$$ \\beta = \\frac{S - \\sqrt{S^2 - 4P}}{2} = \\frac{\\frac{43}{120} - \\sqrt{\\left(\\frac{43}{120}\\right)^2 - 4\\left(\\frac{1}{120}\\right)}}{2} $$\n$$ \\beta = \\frac{1}{2} \\left[ \\frac{43}{120} - \\sqrt{\\frac{1849}{14400} - \\frac{4}{120}} \\right] = \\frac{1}{2} \\left[ \\frac{43}{120} - \\sqrt{\\frac{1849 - 4 \\times 120}{14400}} \\right] $$\n$$ \\beta = \\frac{1}{2} \\left[ \\frac{43}{120} - \\sqrt{\\frac{1849 - 480}{14400}} \\right] = \\frac{1}{2} \\left[ \\frac{43}{120} - \\sqrt{\\frac{1369}{14400}} \\right] $$\n$$ \\beta = \\frac{1}{2} \\left[ \\frac{43}{120} - \\frac{\\sqrt{1369}}{\\sqrt{14400}} \\right] = \\frac{1}{2} \\left[ \\frac{43}{120} - \\frac{37}{120} \\right] $$\n$$ \\beta = \\frac{1}{2} \\left[ \\frac{43 - 37}{120} \\right] = \\frac{1}{2} \\left[ \\frac{6}{120} \\right] = \\frac{1}{2} \\left[ \\frac{1}{20} \\right] = \\frac{1}{40} \\text{ 天}^{-1} $$\n所以，终末速率常数为 $\\beta = 0.025$ 天$^{-1}$。\n\n最后，我们计算终末半衰期 $t_{1/2}$，它通过以下公式与终末速率常数 $\\beta$ 相关：\n$$ t_{1/2} = \\frac{\\ln(2)}{\\beta} $$\n代入 $\\beta$ 的值：\n$$ t_{1/2} = \\frac{\\ln(2)}{1/40} = 40 \\ln(2) \\text{ 天} $$\n使用值 $\\ln(2) \\approx 0.69314718$：\n$$ t_{1/2} \\approx 40 \\times 0.69314718 = 27.7258872... \\text{ 天} $$\n问题要求答案四舍五入到四位有效数字。\n$$ t_{1/2} \\approx 27.73 \\text{ 天} $$\n这个值代表在终末消除阶段，体内药物浓度减少一半所需的时间。",
            "answer": "$$\n\\boxed{27.73}\n$$"
        },
        {
            "introduction": "超越单个的药代动力学/药效学（PK/PD）参数，一种疗法的最终成功取决于其对病原体与宿主免疫系统之间复杂动态相互作用的影响。本练习介绍了一种系统层面的方法，使用一组常微分方程（ODEs）来模拟这种相互作用。通过分析模型的平衡点及其稳定性，您将探索单克隆抗体和宿主导向疗法等干预措施如何能够打破平衡、清除病原体，这为您提供了一个预测治疗结果的强大框架。",
            "id": "4669013",
            "problem": "你需要实现一个完整的程序，用于构建和分析一个简化的常微分方程（ODE）模型，该模型捕捉病原体载量、先天性免疫反应和适应性免疫反应之间的相互作用，并评估在单克隆抗体和宿主导向疗法干预下的平衡点和局部稳定性。工作需基于传染病模型的基本且经过充分检验的原理：质量作用增长和清除、抗原对免疫效应器的饱和（希尔型）激活，以及在没有刺激时免疫效应器的线性衰减。所有变量都是无量纲且经过缩放的；不需要物理单位。\n\n模型定义。令 $V(t)$ 表示无量纲的病原体载量，$N(t)$ 表示无量纲的先天性免疫反应强度，$T(t)$ 表示无量纲的适应性免疫反应强度，每个都是时间 $t$ 的函数。病原体具有基线人均复制率 $p$ 和线性清除率 $c$。单克隆抗体（mAb）干预增加了一个强度为 $\\alpha_{\\mathrm{m}} \\ge 0$ 的额外中和（清除）项。宿主导向疗法（HDT）通过限制病原体可利用的宿主资源，将病原体复制率缩放一个因子 $\\gamma \\in (0,1]$。先天性反应由 $V$ 根据饱和动力学激活并线性衰减，适应性反应由 $V$ 和 $N$ 根据饱和动力学激活并线性衰减。免疫效应器对病原体的清除被建模为质量作用杀伤，分别与 $N V$ 和 $T V$ 成正比，强度为 $k_N$ 和 $k_T$。\n\n该模型为：\n$$\n\\frac{dV}{dt} \\;=\\; \\big(\\gamma\\,p - c - \\alpha_{\\mathrm{m}} \\big)\\,V \\;-\\; k_N\\,N\\,V \\;-\\; k_T\\,T\\,V,\n$$\n$$\n\\frac{dN}{dt} \\;=\\; a_N\\,\\frac{V}{h_N + V} \\;-\\; d_N\\,N,\n$$\n$$\n\\frac{dT}{dt} \\;=\\; a_T\\,\\frac{V}{h_T + V} \\;+\\; b_T\\,\\frac{N}{h_B + N} \\;-\\; d_T\\,T.\n$$\n\n使用的定义和事实。\n- 常微分方程（ODE）：一个涉及函数及其导数的关系，定义了一个连续时间 $t$ 的动力学系统。\n- 单克隆抗体（mAb）：一种中和病原体的疗法，此处建模为增加的线性清除项 $\\alpha_{\\mathrm{m}}\\,V$。\n- 宿主导向疗法（HDT）：一种改变宿主因素以阻碍病原体复制的疗法，此处建模为对 $p$ 的一个缩放因子 $\\gamma$，其中 $0  \\gamma \\le 1$。\n- 正性：对于非负初始条件，上述方程的右侧确保 $V(t)$、$N(t)$、$T(t)$ 保持非负。\n- 无病原体平衡点（PFE）：$V^\\star = 0$ 的平衡点，此时 $N^\\star = 0$ 且 $T^\\star = 0$。\n\n你的任务。\n- 对于 $V^\\star \\ge 0$ 的平衡点，推导简化的稳态关系\n  $$\n  N^\\star(V) \\;=\\; \\frac{a_N}{d_N}\\,\\frac{V}{h_N + V}, \\qquad\n  T^\\star(V) \\;=\\; \\frac{1}{d_T}\\left(a_T\\,\\frac{V}{h_T + V} \\;+\\; b_T\\,\\frac{N^\\star(V)}{h_B + N^\\star(V)}\\right),\n  $$\n  以及 $V^\\star \\ge 0$ 的标量平衡条件\n  $$\n  0 \\;=\\; \\left(\\gamma\\,p - c - \\alpha_{\\mathrm{m}}\\right) \\;-\\; k_N\\,N^\\star(V) \\;-\\; k_T\\,T^\\star(V).\n  $$\n  解释为什么这个标量方程最多只有一个严格正解 $V^\\star > 0$。\n- 计算在无病原体平衡点 $(V^\\star,N^\\star,T^\\star)=(0,0,0)$ 处的雅可比矩阵，并根据模型参数确定其局部渐近稳定性的充分必要条件。\n\n算法要求。你的程序必须：\n- 实现鲁棒的数值逻辑，以确定生物学上可接受的平衡点（$V^\\star \\ge 0$, $N^\\star \\ge 0$, $T^\\star \\ge 0$）的数量，在存在严格正平衡点 $V^\\star > 0$ 时检测其存在性，并使用带括号的求根方法对标量稳态条件进行计算，使其绝对误差在 $10^{-9}$ 以内。\n- 计算在 $(0,0,0)$ 处的雅可比矩阵、其特征值以及最大实部（主导实部）。当且仅当所有特征值的实部都严格为负时，宣布无病原体平衡点是局部渐近稳定的。\n- 对于每个测试用例，输出一个列表 $[n_{\\mathrm{eq}},\\ \\mathrm{is\\_PFE\\_stable},\\ \\lambda_{\\max},\\ V^\\star_{+}]$，其中 $n_{\\mathrm{eq}}$ 是可接受平衡点的整数数量，$\\mathrm{is\\_PFE\\_stable}$ 是一个布尔值，$\\lambda_{\\max}$ 是在无病原体平衡点处雅可比矩阵特征值的主导实部，四舍五入到 $6$ 位小数，而 $V^\\star_{+}$ 是严格正平衡病原体载量（如果存在），否则为 $0.0$，四舍五入到 $6$ 位小数。\n\n在所有测试用例中使用以下固定参数值：\n- $p = 1.2$, $c = 0.3$,\n- $a_N = 0.8$, $h_N = 1.0$, $d_N = 0.5$,\n- $a_T = 0.6$, $h_T = 0.5$, $b_T = 0.3$, $h_B = 0.5$, $d_T = 0.4$,\n- $k_N = 0.2$, $k_T = 0.3$.\n\n测试套件。对于每个用例，只有 $\\gamma$ 和 $\\alpha_{\\mathrm{m}}$ 变化：\n- 用例 1：$\\gamma = 1.0$, $\\alpha_{\\mathrm{m}} = 0.0$.\n- 用例 2：$\\gamma = 1.0$, $\\alpha_{\\mathrm{m}} = 0.9$.\n- 用例 3：$\\gamma = 1.0$, $\\alpha_{\\mathrm{m}} = 1.1$.\n- 用例 4：$\\gamma = 0.2$, $\\alpha_{\\mathrm{m}} = 0.0$.\n- 用例 5：$\\gamma = 0.8$, $\\alpha_{\\mathrm{m}} = 0.4$.\n\n最终输出格式。你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的每个元素是按上述顺序排列的一个测试用例的列表。例如，一个包含两个假设用例的输出应如下所示：$[[1,\\mathrm{True},-0.123456,0.000000],[2,\\mathrm{False},0.234567,1.234000]]$。所有浮点输出必须精确四舍五入到 $6$ 位小数。不涉及角度。不得出现百分比；只能使用小数形式。",
            "solution": "该问题是有效的，因为它科学地基于标准的流行病学模型原理，在数学上是适定的、完全指定的，并且是客观的。我们继续进行推导和求解。\n\n### 平衡点分析\n\n系统的平衡状态 $(V^\\star, N^\\star, T^\\star)$ 通过将所有时间导数设置为零来找到：\n$$\n\\frac{dV}{dt} = 0, \\quad \\frac{dN}{dt} = 0, \\quad \\frac{dT}{dt} = 0.\n$$\n\n从先天性免疫反应的方程 $\\frac{dN}{dt} = 0$ 可得：\n$$\na_N\\,\\frac{V^\\star}{h_N + V^\\star} - d_N\\,N^\\star = 0\n$$\n将 $N^\\star$ 解为 $V^\\star$ 的函数，得到稳态先天性反应：\n$$\nN^\\star(V^\\star) = \\frac{a_N}{d_N}\\,\\frac{V^\\star}{h_N + V^\\star}\n$$\n该表达式对任何平衡病原体载量 $V^\\star \\ge 0$ 都有效。\n\n类似地，从适应性免疫反应的方程 $\\frac{dT}{dt} = 0$ 可得：\n$$\na_T\\,\\frac{V^\\star}{h_T + V^\\star} + b_T\\,\\frac{N^\\star}{h_B + N^\\star} - d_T\\,T^\\star = 0\n$$\n解出 $T^\\star$ 并代入 $N^\\star(V^\\star)$ 的表达式，得到稳态适应性反应作为 $V^\\star$ 的函数：\n$$\nT^\\star(V^\\star) = \\frac{1}{d_T}\\left(a_T\\,\\frac{V^\\star}{h_T + V^\\star} + b_T\\,\\frac{N^\\star(V^\\star)}{h_B + N^\\star(V^\\star)}\\right)\n$$\n这些是问题所要求的简化稳态关系。\n\n最后，我们分析平衡状态下的病原体动力学方程 $\\frac{dV}{dt} = 0$：\n$$\n\\big(\\gamma\\,p - c - \\alpha_{\\mathrm{m}} \\big)\\,V^\\star - k_N\\,N^\\star\\,V^\\star - k_T\\,T^\\star\\,V^\\star = 0\n$$\n该方程可以因式分解为：\n$$\nV^\\star \\left[ \\big(\\gamma\\,p - c - \\alpha_{\\mathrm{m}}\\big) - k_N\\,N^\\star(V^\\star) - k_T\\,T^\\star(V^\\star) \\right] = 0\n$$\n这个方程对 $V^\\star$ 有两种类型的解：\n1.  **无病原体平衡点（PFE）：** $V^\\star = 0$。将此代入 $N^\\star$ 和 $T^\\star$ 的关系式，得到 $N^\\star(0) = 0$ 和 $T^\\star(0)=0$。因此，$(V^\\star, N^\\star, T^\\star) = (0, 0, 0)$ 始终是一个平衡点。\n2.  **地方病平衡点：** 如果 $V^\\star > 0$，我们可以除以 $V^\\star$ 得到标量平衡条件：\n    $$\n    \\big(\\gamma\\,p - c - \\alpha_{\\mathrm{m}}\\big) - k_N\\,N^\\star(V^\\star) - k_T\\,T^\\star(V^\\star) = 0\n    $$\n    这可以重写为求函数 $G(V)$ 的一个根 $V^\\star > 0$：\n    $$\n    G(V) = \\left(\\gamma\\,p - c - \\alpha_{\\mathrm{m}}\\right) - k_N\\,N^\\star(V) - k_T\\,T^\\star(V)\n    $$\n\n### 严格正平衡点的唯一性\n\n为了解释为什么这个标量方程最多只有一个严格正解，我们分析涉及 $V$ 的项的单调性。令免疫反应函数为 $F(V) = k_N\\,N^\\star(V) + k_T\\,T^\\star(V)$。平衡方程为 $F(V^\\star) = \\gamma\\,p - c - \\alpha_{\\mathrm{m}}$。如果 $F(V)$ 对于 $V > 0$ 是一个严格单调递增函数，则存在唯一的正解。\n\n我们来检验 $F(V)$ 关于 $V$ 的导数：\n$$\n\\frac{dF}{dV} = k_N \\frac{dN^\\star}{dV} + k_T \\frac{dT^\\star}{dV}\n$$\n$N^\\star(V)$ 的导数是：\n$$\n\\frac{dN^\\star}{dV} = \\frac{d}{dV}\\left(\\frac{a_N}{d_N}\\frac{V}{h_N + V}\\right) = \\frac{a_N}{d_N}\\frac{h_N}{(h_N + V)^2}\n$$\n由于所有参数 $a_N, d_N, h_N$ 均为正，因此对于所有 $V \\ge 0$，$\\frac{dN^\\star}{dV} > 0$。所以，$N^\\star(V)$ 是 $V$ 的一个严格递增函数。\n\n$T^\\star(V)$ 的导数是：\n$$\n\\frac{dT^\\star}{dV} = \\frac{1}{d_T}\\left(a_T \\frac{d}{dV}\\left(\\frac{V}{h_T + V}\\right) + b_T \\frac{d}{dV}\\left(\\frac{N^\\star(V)}{h_B + N^\\star(V)}\\right)\\right)\n$$\n第一项的导数是 $a_T\\frac{h_T}{(h_T + V)^2}$，为正。第二项的导数使用链式法则求得。令 $g(N) = \\frac{N}{h_B+N}$。其导数为 $g'(N) = \\frac{h_B}{(h_B+N)^2} > 0$。因此，第二项的导数为 $b_T \\, g'(N^\\star(V)) \\frac{dN^\\star}{dV}$。由于 $g' > 0$ 且 $\\frac{dN^\\star}{dV} > 0$，该项也严格为正。\n\n由于对于 $V \\ge 0$，$\\frac{dN^\\star}{dV}$ 和 $\\frac{dT^\\star}{dV}$ 都严格为正，且杀伤率 $k_N, k_T$ 为正，它们的和 $\\frac{dF}{dV}$ 也严格为正。这证明了 $F(V)$ 对于 $V \\ge 0$ 是一个严格单调递增函数。一个严格递增函数最多只能与常数值 $\\gamma\\,p - c - \\alpha_{\\mathrm{m}}$ 相交一次。此外，由于 $F(0)=0$，当且仅当常数项为正，即 $\\gamma\\,p - c - \\alpha_{\\mathrm{m}} > 0$ 时，存在一个严格正解 $V^\\star > 0$。\n\n### 无病原体平衡点的稳定性\n\n为评估PFE $(V^\\star, N^\\star, T^\\star) = (0, 0, 0)$ 的局部渐近稳定性，我们计算系统在该点处的雅可比矩阵。令ODE的右侧分别为 $f_1(V,N,T)$、$f_2(V,N,T)$ 和 $f_3(V,N,T)$。雅可比矩阵 $J$ 为：\n$$\nJ = \\begin{pmatrix}\n\\frac{\\partial f_1}{\\partial V}  \\frac{\\partial f_1}{\\partial N}  \\frac{\\partial f_1}{\\partial T} \\\\\n\\frac{\\partial f_2}{\\partial V}  \\frac{\\partial f_2}{\\partial N}  \\frac{\\partial f_2}{\\partial T} \\\\\n\\frac{\\partial f_3}{\\partial V}  \\frac{\\partial f_3}{\\partial N}  \\frac{\\partial f_3}{\\partial T}\n\\end{pmatrix}\n$$\n在 $(0, 0, 0)$ 处计算的偏导数为：\n- $\\frac{\\partial f_1}{\\partial V} = \\gamma p - c - \\alpha_{\\mathrm{m}} - k_N N - k_T T \\;\\to\\; \\gamma p - c - \\alpha_{\\mathrm{m}}$\n- $\\frac{\\partial f_1}{\\partial N} = -k_N V \\;\\to\\; 0$\n- $\\frac{\\partial f_1}{\\partial T} = -k_T V \\;\\to\\; 0$\n- $\\frac{\\partial f_2}{\\partial V} = a_N \\frac{h_N}{(h_N+V)^2} \\;\\to\\; \\frac{a_N}{h_N}$\n- $\\frac{\\partial f_2}{\\partial N} = -d_N \\;\\to\\; -d_N$\n- $\\frac{\\partial f_2}{\\partial T} = 0 \\;\\to\\; 0$\n- $\\frac{\\partial f_3}{\\partial V} = a_T \\frac{h_T}{(h_T+V)^2} \\;\\to\\; \\frac{a_T}{h_T}$\n- $\\frac{\\partial f_3}{\\partial N} = b_T \\frac{h_B}{(h_B+N)^2} \\;\\to\\; \\frac{b_T}{h_B}$\n- $\\frac{\\partial f_3}{\\partial T} = -d_T \\;\\to\\; -d_T$\n\n在PFE处的雅可比矩阵是一个下三角矩阵：\n$$\nJ_{(0,0,0)} = \\begin{pmatrix}\n\\gamma p - c - \\alpha_{\\mathrm{m}}  0  0 \\\\\na_N/h_N  -d_N  0 \\\\\na_T/h_T  b_T/h_B  -d_T\n\\end{pmatrix}\n$$\n三角矩阵的特征值是其对角线上的元素：\n$$\n\\lambda_1 = \\gamma p - c - \\alpha_{\\mathrm{m}}, \\quad \\lambda_2 = -d_N, \\quad \\lambda_3 = -d_T\n$$\n对于局部渐近稳定性，所有特征值的实部必须严格为负。由于参数 $d_N$ 和 $d_T$ 代表生物衰减率，它们是正数，这意味着 $\\lambda_2  0$ 和 $\\lambda_3  0$ 总是成立。因此，PFE的稳定性完全由 $\\lambda_1$ 的符号决定。\n\nPFE局部渐近稳定的充分必要条件是：\n$$\n\\lambda_1 = \\gamma p - c - \\alpha_{\\mathrm{m}}  0\n$$\n该特征值代表了病原体在低密度下的净增长率。当其为负时，病原体无法在群体中成功入侵。问题要求将此临界特征值作为主导实部 $\\lambda_{\\max}$ 输出。\n\n### 算法实现\n\n程序将遍历所提供的每个测试用例。\n1.  对于每个用例，计算临界特征值 $\\lambda_{\\max} = \\gamma p - c - \\alpha_{\\mathrm{m}}$。\n2.  如果 $\\lambda_{\\max}  0$，则PFE是稳定的（`is_PFE_stable` 为 `True`）。\n3.  如果 $\\lambda_{\\max} \\le 0$，可接受的平衡点数量 $n_{\\mathrm{eq}}$ 为 1（即PFE）。如果 $\\lambda_{\\max} > 0$，除了PFE之外，还存在一个唯一的地方病平衡点，因此 $n_{\\mathrm{eq}}=2$。\n4.  如果 $n_{\\mathrm{eq}}=2$，则通过使用鲁棒的带括号求根方法（例如 `scipy.optimize.brentq`）求解 $G(V) = 0$ 来找到严格正平衡点 $V^\\star_{+}$。建立一个搜索区间 $[0, v_{\\mathrm{high}}]$，其中 $G(0) = \\lambda_{\\max} > 0$，并且选择足够大的 $v_{\\mathrm{high}}$ 以使得 $G(v_{\\mathrm{high}})  0$。如果 $n_{\\mathrm{eq}}=1$，则 $V^\\star_{+} = 0.0$。\n5.  为每个用例收集结果 $[n_{\\mathrm{eq}}, \\text{is\\_PFE\\_stable}, \\lambda_{\\max}, V^\\star_{+}]$，浮点数值四舍五入到 6 位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the ODE model analysis problem for a suite of test cases.\n    \"\"\"\n    \n    # Fixed parameter values across all test cases\n    p = 1.2\n    c = 0.3\n    a_N = 0.8\n    h_N = 1.0\n    d_N = 0.5\n    a_T = 0.6\n    h_T = 0.5\n    b_T = 0.3\n    h_B = 0.5\n    d_T = 0.4\n    k_N = 0.2\n    k_T = 0.3\n\n    # Test suite: varying gamma and alpha_m\n    test_cases = [\n        (1.0, 0.0),  # Case 1\n        (1.0, 0.9),  # Case 2\n        (1.0, 1.1),  # Case 3\n        (0.2, 0.0),  # Case 4\n        (0.8, 0.4),  # Case 5\n    ]\n\n    results = []\n    \n    for gamma, alpha_m in test_cases:\n        # Task: Compute Jacobian at (0,0,0), its eigenvalues, and the dominant real part\n        # The Jacobian at the PFE is lower triangular. The eigenvalues are its diagonal entries:\n        # lambda_1 = gamma*p - c - alpha_m\n        # lambda_2 = -d_N\n        # lambda_3 = -d_T\n        # Stability requires all eigenvalues to be negative. Since d_N and d_T are positive,\n        # this depends on the sign of lambda_1, which represents the initial net growth rate.\n        # The problem requires reporting this critical eigenvalue as lambda_max.\n        lambda_max = gamma * p - c - alpha_m\n\n        # Task: Declare the pathogen-free equilibrium locally asymptotically stable iff all eigenvalues have strictly negative real parts\n        is_PFE_stable = lambda_max  0\n\n        # Task: Determine the number of biologically admissible equilibria and compute V_star > 0 if it exists\n        n_eq = 0\n        v_star_plus = 0.0\n\n        if lambda_max = 0:\n            # If the PFE is stable or neutrally stable (lambda_max = 0), it's the only non-negative equilibrium.\n            # The pathogen cannot invade, so no endemic equilibrium exists.\n            n_eq = 1\n            v_star_plus = 0.0\n        else:\n            # If the PFE is unstable (lambda_max > 0), the pathogen can invade,\n            # leading to a second, endemic equilibrium where V* > 0.\n            n_eq = 2\n\n            # Define the steady-state functions N*(V) and T*(V)\n            def n_star(v):\n                return (a_N / d_N) * (v / (h_N + v))\n\n            def t_star(v):\n                n_v = n_star(v)\n                term1 = a_T * (v / (h_T + v))\n                term2 = b_T * (n_v / (h_B + n_v))\n                return (1 / d_T) * (term1 + term2)\n\n            # Define the scalar equilibrium condition G(V) = 0 for the endemic equilibrium.\n            def G(v):\n                return (gamma * p - c - alpha_m) - k_N * n_star(v) - k_T * t_star(v)\n\n            # Find a bracket [v_low, v_high] for the root.\n            # We know G(0) = lambda_max > 0.\n            # We need to find a v_high where G(v_high)  0.\n            v_low = 0.0\n            v_high = 1.0\n            # Incrementally increase v_high until G(v_high) becomes negative.\n            while G(v_high) >= 0:\n                v_high *= 2.0\n                if v_high > 1e12: # Safety break to prevent infinite loop\n                    raise RuntimeError(\"Could not find a bracket for the root.\")\n\n            # Use a robust bracketed root-finding method to find V* > 0.\n            v_star_plus = brentq(G, v_low, v_high, xtol=1e-9)\n\n        # Assemble the results for the current test case\n        case_result = [\n            n_eq,\n            is_PFE_stable,\n            round(lambda_max, 6),\n            round(v_star_plus, 6)\n        ]\n        results.append(case_result)\n\n    # Final print statement in the exact required format\n    formatted_results = []\n    for res in results:\n        # Format: [int, bool, float, float]\n        formatted_results.append(f\"[{res[0]},{'True' if res[1] else 'False'},{res[2]:.6f},{res[3]:.6f}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}