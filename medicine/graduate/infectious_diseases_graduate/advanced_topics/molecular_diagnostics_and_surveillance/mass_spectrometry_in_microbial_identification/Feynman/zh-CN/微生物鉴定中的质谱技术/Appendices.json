{
    "hands_on_practices": [
        {
            "introduction": "在质谱分析中，质量准确度是评估仪器性能和数据可靠性的基石。本练习将引导您计算百万分之误差（parts per million, ppm），这是衡量观测质量与理论质量偏差的标准化指标。掌握此计算对于方法验证和日常质量控制至关重要，可确保微生物鉴定结果的准确性。",
            "id": "4662278",
            "problem": "在用于细菌鉴定的基质辅助激光解吸电离飞行时间 (MALDI-TOF) 质谱工作流程中，对于一个单电荷物质，在质荷比 $m/z = 4{,}562.345$ 处观察到了一个核糖体生物标志物峰。参考数据库列出的相应理论质荷比为 $m/z = 4{,}562.100$。在微生物鉴定的方法验证中，一个常见的接受标准是绝对质量误差不超过百万分之五十 (50 ppm)。\n\n仅使用百万分率 (ppm) 是将无量纲相对差异乘以因子 $10^{6}$ 的定义，从基本原理出发计算以 ppm 为单位的绝对质量误差，并确定该观测结果是否满足所述的接受标准。报告四舍五入至四位有效数字的绝对质量误差，并以 ppm 表示。对于最终的数值答案，仅提供 ppm 值，不带单位。",
            "solution": "该问题要求计算在 MALDI-TOF 质谱图中观察到的一个峰的绝对质量误差（以百万分率 ppm 表示），并确定该误差是否在指定的接受标准范围内。验证问题陈述的有效性是强制性的第一步。\n\n从问题陈述中提取的已知条件如下：\n- 观测质荷比：$m/z_{obs} = 4{,}562.345$\n- 来自参考数据库的理论质荷比：$m/z_{theo} = 4{,}562.100$\n- 该物质是单电荷的，这意味着电荷态 $z = 1$。\n- 接受标准是绝对质量误差不超过百万分之五十 (50 ppm)。\n- ppm 的定义是无量纲相对差异乘以因子 $10^6$。\n\n这个问题具有科学依据，因为 MALDI-TOF 质谱是微生物鉴定的一项标准技术，而使用 ppm 评估质量准确度是该领域的一个基本指标。所提供的 $m/z$ 值对于核糖体蛋白生物标志物是符合实际的。该问题提法恰当、客观，并包含得出唯一且有意义解所需的所有信息。它没有矛盾、歧义和科学缺陷。因此，该问题被认为是有效的，可以制定解决方案。\n\n核心原理是以 ppm 为单位的质量误差的定义。对于质谱仪而言，质量误差是实验测量的离子质量与理论计算的离子质量之间差异的度量。由于指定离子是单电荷的 ($z=1$)，因此质荷比 ($m/z$) 在数值上等于离子的质量 ($m$)。\n设 $m_{obs}$ 为观测质量，$m_{theo}$ 为理论质量。\n根据问题陈述：\n$m_{obs} = 4{,}562.345$\n$m_{theo} = 4{,}562.100$\n\n首先，我们计算绝对质量差异，记为 $\\Delta m$。这是观测质量与理论质量之差的绝对值。\n$$ \\Delta m = |m_{obs} - m_{theo}| $$\n代入给定值：\n$$ \\Delta m = |4{,}562.345 - 4{,}562.100| = 0.245 $$\n\n接下来，我们计算相对质量误差。这是一个无量纲的量，通过将绝对质量差异除以理论质量得到。这种归一化处理使得可以比较不同质量范围内的质量准确度。\n$$ \\text{Relative Mass Error} = \\frac{\\Delta m}{m_{theo}} = \\frac{|m_{obs} - m_{theo}|}{m_{theo}} $$\n代入数值：\n$$ \\text{Relative Mass Error} = \\frac{0.245}{4{,}562.100} $$\n\n问题要求以百万分率 (ppm) 表示误差。如问题所述，这是通过将无量纲相对差异乘以因子 $10^6$ 来实现的。\n$$ \\text{Error (ppm)} = \\left( \\frac{|m_{obs} - m_{theo}|}{m_{theo}} \\right) \\times 10^6 $$\n代入计算出的值：\n$$ \\text{Error (ppm)} = \\left( \\frac{0.245}{4{,}562.100} \\right) \\times 10^6 $$\n$$ \\text{Error (ppm)} \\approx 0.000053703358 \\times 10^6 $$\n$$ \\text{Error (ppm)} \\approx 53.703358 $$\n\n问题要求将结果四舍五入至四位有效数字。$53.703358$ 的前四位有效数字是 $5$、$3$、$7$ 和 $0$。第五位有效数字是 $3$，小于 $5$，因此我们向下舍入。\n$$ \\text{Error (ppm)} \\approx 53.70 $$\n\n最后，我们必须确定观测结果是否满足所述的接受标准。接受标准是绝对质量误差不超过 $50$ ppm。\n计算出的绝对质量误差为 $53.70$ ppm。\n我们将计算出的误差与标准进行比较：\n$$ 53.70 \\text{ ppm} > 50 \\text{ ppm} $$\n由于计算出的质量误差大于允许的最大误差，因此该观测结果不满足方法验证的指定接受标准。\n四舍五入至四位有效数字的绝对质量误差为 $53.70$ ppm。",
            "answer": "$$\\boxed{53.70}$$"
        },
        {
            "introduction": "质谱仪器的分辨能力决定了它区分两个质量相近离子的能力，这对于鉴定混合样本或区分亲缘关系密切的微生物至关重要。本练习将理论与实践相结合，要求您基于峰形模型计算分辨能力，并判断两个相邻的峰是否可以被有效分开。通过这个练习，您将更深刻地理解仪器性能参数如何直接影响数据的解析和鉴定结论。",
            "id": "4662311",
            "problem": "一个临床实验室使用矩阵辅助激光解吸/电离飞行时间 (MALDI-TOF) 质谱法，通过核糖体蛋白指纹图谱来鉴定细菌种类。在一张谱图中，两个相邻的特征峰对应于不同物种特异性的核糖体蛋白，其质荷比 ($m/z$) 值分别为 $m_{1} = 4{,}000$ 和 $m_{2} = 4{,}005$。每个特征峰都呈现高斯峰形，并且该仪器在此质量范围内的峰的半峰全宽 (FWHM) 为 $\\Delta m = 2$。\n\n从基本定义和模型出发：\n- 在给定质量 $m$ 处的分辨率定义为 $R = \\frac{m}{\\Delta m}$。\n- 标准差为 $\\sigma$ 的单峰高斯强度分布可以写成 $I(x) = I_{0}\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right)$，其中 $x$ 是与峰中心的质量偏差，半峰全宽与 $\\sigma$ 的关系为 $\\text{FWHM} = 2\\sqrt{2\\ln 2}\\,\\sigma$。\n- 对于两个中心分别位于 $m_{1}$ 和 $m_{2}$、宽度相同且高度为单位1的相等、独立的高斯峰，其中点处的谷底强度是两个高斯分布在该中点处贡献的总和。\n\n基于这些基础，计算在 $m = 4{,}000$ 处的分辨率 $R$，并根据以下操作性定义判断这两个峰是否达到基线分离：如果中点处的谷底强度小于单个高斯峰最大强度 ($I_{0}$) 的 $0.1$ 倍，则认为这两个峰达到了基线分离。将最终决定表示为：如果达到基线分离，则 $B = 1$；否则 $B = 0$。\n\n将你的最终答案以一个双元素行向量 $\\big(R, B\\big)$ 的形式给出，不带单位。请提供精确值，无需四舍五入。",
            "solution": "首先验证问题陈述，以确保其科学基础扎实、问题定义明确且客观。\n\n### 第1步：提取已知条件\n- 两个峰的质荷比：$m_{1} = 4{,}000$ 和 $m_{2} = 4{,}005$。\n- 仪器的半峰全宽 (FWHM)：$\\Delta m = 2$。\n- 分辨率的定义：$R = \\frac{m}{\\Delta m}$。\n- 高斯强度分布模型：$I(x) = I_{0}\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right)$，其中 $x$ 是与峰中心的质量偏差。\n- FWHM 与标准差 $\\sigma$ 之间的关系：$\\text{FWHM} = 2\\sqrt{2\\ln 2}\\,\\sigma$。\n- 双峰模型：两个中心分别位于 $m_1$ 和 $m_2$、宽度相同且高度为单位1 ($I_0=1$) 的相等、独立的高斯峰。\n- 谷底强度的定义：两个高斯分布在中点处贡献的总和。\n- 基线分离的条件：中点处的谷底强度小于单个高斯峰最大强度 ($I_{0}$) 的 $0.1$ 倍。\n- 分离状态的输出变量：如果达到基线分离，则 $B = 1$，否则 $B = 0$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据。MALDI-TOF 质谱法是微生物学中的一项标准技术，蛋白质指纹图谱是一个常见的应用。高斯峰、FWHM 和分辨率的数学模型是光谱学和分析化学中的标准模型。该问题定义明确，因为所需计算的所有必要数据和定义均已提供。语言是客观的，“基线分离”的标准被给出了一个精确的操作性定义，消除了模糊性。所提供的值对于线性 MALDI-TOF 仪器上的蛋白质分析是物理上现实的。该问题是自洽、一致且可解的。\n\n### 第3步：结论与行动\n问题被判定为**有效**。将提供完整的解题步骤。\n\n任务是计算两个量：在 $m=4{,}000$ 处的分辨率 $R$，以及一个二元变量 $B$ 来指示两个指定的峰是否达到基线分离。\n\n首先，我们计算分辨率 $R$。定义为 $R = \\frac{m}{\\Delta m}$。\n使用给定值 $m = 4{,}000$ 和仪器在此质量范围内的 FWHM $\\Delta m = 2$：\n$$\nR = \\frac{4{,}000}{2} = 2{,}000\n$$\n\n接下来，我们确定 $B$ 的值。这需要评估在 $m_{1} = 4{,}000$ 和 $m_{2} = 4{,}005$ 处的两个峰是否达到基线分离。标准是谷底中点处的强度 $I_{\\text{valley}}$ 必须小于单个峰最大强度 $I_{0}$ 的 $0.1$ 倍。问题陈述要求将峰建模为单位高度，因此我们设 $I_{0} = 1$。因此，基线分离的条件是 $I_{\\text{valley}}  0.1$。\n\n总强度分布 $I_{\\text{total}}(m')$ 是以 $m_1$ 和 $m_2$ 为中心的两个独立高斯峰的总和：\n$$\nI_{\\text{total}}(m') = I_{1}(m') + I_{2}(m') = I_{0}\\exp\\left(-\\frac{(m' - m_{1})^2}{2\\sigma^{2}}\\right) + I_{0}\\exp\\left(-\\frac{(m' - m_{2})^2}{2\\sigma^{2}}\\right)\n$$\n当 $I_{0} = 1$ 时，上式变为：\n$$\nI_{\\text{total}}(m') = \\exp\\left(-\\frac{(m' - m_{1})^2}{2\\sigma^{2}}\\right) + \\exp\\left(-\\frac{(m' - m_{2})^2}{2\\sigma^{2}}\\right)\n$$\n谷底位于两个峰的中点，$m_{\\text{mid}} = \\frac{m_{1} + m_{2}}{2}$。\n$$\nm_{\\text{mid}} = \\frac{4{,}000 + 4{,}005}{2} = 4{,}002.5\n$$\n谷底强度 $I_{\\text{valley}}$ 是在 $m_{\\text{mid}}$ 处的总强度：\n$$\nI_{\\text{valley}} = I_{\\text{total}}(m_{\\text{mid}}) = \\exp\\left(-\\frac{(m_{\\text{mid}} - m_{1})^2}{2\\sigma^{2}}\\right) + \\exp\\left(-\\frac{(m_{\\text{mid}} - m_{2})^2}{2\\sigma^{2}}\\right)\n$$\n中点到每个峰中心的距离是相同的：\n$$\n|m_{\\text{mid}} - m_{1}| = |4{,}002.5 - 4{,}000| = 2.5\n$$\n$$\n|m_{\\text{mid}} - m_{2}| = |4{,}002.5 - 4{,}005| = |-2.5| = 2.5\n$$\n设此距离为 $x_{\\text{mid}} = 2.5$。谷底强度的表达式简化为：\n$$\nI_{\\text{valley}} = 2\\exp\\left(-\\frac{x_{\\text{mid}}^{2}}{2\\sigma^{2}}\\right) = 2\\exp\\left(-\\frac{(2.5)^{2}}{2\\sigma^{2}}\\right)\n$$\n为了计算这个值，我们必须首先根据给定的 FWHM $\\Delta m = 2$ 求出标准差 $\\sigma$。关系式为：\n$$\n\\Delta m = 2\\sqrt{2\\ln 2}\\,\\sigma\n$$\n代入 $\\Delta m = 2$：\n$$\n2 = 2\\sqrt{2\\ln 2}\\,\\sigma \\implies \\sigma = \\frac{1}{\\sqrt{2\\ln 2}}\n$$\n现在我们可以计算指数项中所需的 $2\\sigma^2$：\n$$\n2\\sigma^{2} = 2\\left(\\frac{1}{\\sqrt{2\\ln 2}}\\right)^2 = 2\\left(\\frac{1}{2\\ln 2}\\right) = \\frac{1}{\\ln 2}\n$$\n将此代入 $I_{\\text{valley}}$ 的表达式中：\n$$\nI_{\\text{valley}} = 2\\exp\\left(-\\frac{(2.5)^{2}}{1/\\ln 2}\\right) = 2\\exp(-6.25 \\ln 2)\n$$\n使用对数恒等式 $a\\exp(b \\ln c) = a c^b$：\n$$\nI_{\\text{valley}} = 2 \\cdot (2^{-6.25}) = 2^{1} \\cdot 2^{-6.25} = 2^{1 - 6.25} = 2^{-5.25}\n$$\n现在我们必须将这个值与阈值 $0.1$ 进行比较。峰被分离的条件是 $I_{\\text{valley}}  0.1$，即 $2^{-5.25}  \\frac{1}{10}$。这个不等式等价于 $10  2^{5.25}$。\n我们来计算 $2^{5.25}$：\n$$\n2^{5.25} = 2^{5} \\cdot 2^{0.25} = 32 \\cdot 2^{1/4} = 32\\sqrt[4]{2}\n$$\n我们知道 $1^4=1$ 且 $2^4=16$，所以 $1  \\sqrt[4]{2}  2$。更精确的计算表明 $\\sqrt[4]{2} \\approx 1.189$。\n因此，$2^{5.25} \\approx 32 \\times 1.189 = 38.048$。\n因为 $38.048 > 10$，所以不等式 $10  2^{5.25}$ 成立。\n这证实了 $I_{\\text{valley}}  0.1$。\n根据问题的定义，这两个峰达到了基线分离。因此，变量 $B$ 被赋值为 $1$。\n\n最终答案是双元素行向量 $(R, B)$。\n$$\nR = 2{,}000\n$$\n$$\nB = 1\n$$\n得到的向量是 $(2{,}000, 1)$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 2000  1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在分析复杂的质谱图时，我们经常会遇到谱峰重叠的问题，仅凭肉眼观察难以确定一个宽峰是由单个组分还是多个组分构成。本练习旨在介绍一种严谨的统计学方法，通过拟合嵌套模型并进行假设检验来解决这一难题。您将学习如何以数据驱动的方式判断是否需要用更复杂的双峰模型来解释观测信号，这是从质谱数据中提取可靠生物学信息的关键高级技能。",
            "id": "4662248",
            "problem": "给定一个用于传染病微生物鉴定的基质辅助激光解吸/电离飞行时间（MALDI-TOF）质谱分析中的窄质荷比窗口的模拟表示。在此范围内，峰形是由许多微小的仪器展宽过程卷积而成。根据中心极限定理，该卷积可以很好地用高斯函数近似。仪器分辨率满足 $R = m / \\Delta m$，其中 $\\Delta m$ 是峰的半峰全宽（FWHM）。对于一个高斯峰，其标准差 $\\sigma$ 与其半峰全宽之间的关系遵循 $\\mathrm{FWHM} = 2 \\sqrt{2 \\ln 2} \\, \\sigma$。假设强度测量值上存在加性、独立、同分布的高斯噪声。\n\n构建一个程序，对于每个测试用例，接收质荷比（$m/z$，无量纲比值）范围内的模拟强度数据，并执行以下任务：\n- 在独立高斯噪声的假设下，将数据拟合到一个带有恒定基线的单峰高斯模型。\n- 将相同的数据拟合到一个共享恒定基线的双峰高斯模型（两个高斯函数之和）。\n- 使用适用于具有独立高斯误差和未知方差的嵌套模型的基于似然的原则，在显著性水平 $\\alpha = 0.01$ 下，检验双峰拟合是否比单峰拟合提供了统计上合理的改进。\n\n单峰模型由参数幅度 $A$、中心 $m$、宽度 $\\sigma$ 和基线 $c$ 定义。双峰模型由幅度 $A_1$、$A_2$、中心 $m_1$、$m_2$、宽度 $\\sigma_1$、$\\sigma_2$ 和一个共享基线 $c$ 定义。所有宽度必须严格为正，所有幅度必须为非负，中心必须位于观测到的 $m/z$ 范围内。噪声模型是具有未知方差的独立同分布高斯噪声。\n\n从上述定义和独立高斯噪声的假设出发，通过将高斯误差的最大似然估计与嵌套模型比较检验联系起来，从第一性原理推导你的统计决策规则，并在不依赖问题陈述中任何预先指定的快捷公式的情况下，以算法方式实现它。你对每个测试用例的决策必须是一个布尔值：如果分离成两个峰在 $\\alpha = 0.01$ 的水平上是统计合理的，则输出 $\\,\\mathrm{True}\\,$；否则输出 $\\,\\mathrm{False}\\,$。\n\n物理和数值单位：\n- 质荷比（$m/z$）是一个无量纲比值；报告和使用时均不带单位。\n- 强度以计数（任意单位）为单位，但最终答案是布尔值，因此不需要单位转换。\n\n要实现和评估的测试套件：\n所有五个测试用例都使用相同的 $m/z$ 网格：\n- 下界 $m_{\\min} = 4\\,990$，上界 $m_{\\max} = 5\\,020$，均匀步长 $\\Delta m = 0.1$，得到 $N = 301$ 个点。\n\n对于每种情况，模拟强度数据 $y(m)$，其形式为最多两个高斯峰与一个恒定基线之和，并加上指定标准差的加性高斯噪声。每个高斯峰的形式为 $A \\exp\\!\\left( -\\dfrac{(m - m_0)^2}{2 \\sigma^2} \\right)$，其中幅度为 $A$，中心为 $m_0$，宽度为 $\\sigma$。\n\n- 情况1（分离良好的双峰，中等噪声）：\n  $A_1 = 12\\,000$, $m_1 = 5\\,000$, $\\sigma_1 = 1.5$; \n  $A_2 = 8\\,000$, $m_2 = 5\\,012$, $\\sigma_2 = 1.8$; \n  基线 $c = 150$; 噪声标准差 $s = 150$。\n- 情况2（临界分离，等宽，中等噪声）：\n  $A_1 = 9\\,000$, $m_1 = 5\\,000$, $\\sigma_1 = 1.5$; \n  $A_2 = 7\\,500$, $m_2 = 5\\,003$, $\\sigma_2 = 1.5$; \n  基线 $c = 150$; 噪声标准差 $s = 150$。\n- 情况3（仅单峰）：\n  $A_1 = 10\\,000$, $m_1 = 5\\,005$, $\\sigma_1 = 2.0$; \n  $A_2 = 0$, $m_2$ 任意, $\\sigma_2$ 任意; \n  基线 $c = 150$; 噪声标准差 $s = 150$。\n- 情况4（强噪声下的双峰）：\n  $A_1 = 5\\,000$, $m_1 = 4\\,998$, $\\sigma_1 = 1.6$; \n  $A_2 = 4\\,500$, $m_2 = 5\\,006$, $\\sigma_2 = 1.6$; \n  基线 $c = 150$; 噪声标准差 $s = 1\\,200$。\n- 情况5（非常接近的峰，等宽，中等噪声）：\n  $A_1 = 8\\,000$, $m_1 = 5\\,000$, $\\sigma_1 = 1.5$; \n  $A_2 = 7\\,000$, $m_2 = 5\\,000.75$, $\\sigma_2 = 1.5$; \n  基线 $c = 150$; 噪声标准差 $s = 150$。\n\n算法要求：\n- 使用非线性最小二乘法，在独立高斯噪声的假设下，获得两个模型的最大似然估计。\n- 计算一个从高斯噪声似然原理推导出的嵌套模型比较检验，以获得从单峰模型到双峰模型的改进所对应的 $p$ 值。\n- 如果在 $\\alpha = 0.01$ 的水平上，分离是统计上合理的，则判定为 $\\,\\mathrm{True}\\,$，否则为 $\\,\\mathrm{False}\\,$。\n\n最终输出格式：\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$\\,[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3]\\,\\,$）。该列表必须包含五个布尔值，每个测试用例一个，按上述顺序排列。",
            "solution": "问题陈述经评估是有效的。它在科学上基于质谱分析和统计建模的原理，提法恰当，目标明确，数据充足，并且没有内部矛盾或歧义。\n\n这个问题的核心是确定对于一个给定的质谱数据集，双峰高斯模型是否比单峰模型在拟合优度上提供了统计上显著的改进。这是一个经典的嵌套模型选择问题。\n\n设观测数据为一组在相应质荷比 $m_i$ 处的 $N$ 个强度测量值 $y_i$。底层物理模型受到加性、独立同分布（i.i.d.）高斯噪声的干扰，因此 $y_i = f(m_i; \\theta) + \\epsilon_i$，其中 $\\epsilon_i \\sim \\mathcal{N}(0, s^2)$ 且 $f(m_i; \\theta)$ 是参数向量 $\\theta$ 的模型函数。\n\n对于整个数据集 $\\mathbf{y} = \\{y_1, ..., y_N\\}$，给定参数 $\\theta$ 和噪声方差 $s^2$，其似然函数为：\n$$ L(\\mathbf{y} | \\theta, s^2) = \\prod_{i=1}^{N} \\frac{1}{\\sqrt{2\\pi s^2}} \\exp\\left(-\\frac{(y_i - f(m_i; \\theta))^2}{2s^2}\\right) $$\n对数似然函数是：\n$$ \\ln L = -\\frac{N}{2} \\ln(2\\pi s^2) - \\frac{1}{2s^2} \\sum_{i=1}^{N} (y_i - f(m_i; \\theta))^2 $$\n为了找到参数 $\\theta$ 的最大似然估计（MLE），我们必须最大化 $\\ln L$。这等价于最小化残差平方和（SSR）：\n$$ \\mathrm{SSR}(\\theta) = \\sum_{i=1}^{N} (y_i - f(m_i; \\theta))^2 $$\n因此，模型参数 $\\theta$ 的最大似然估计可以通过非线性最小二乘法找到。\n\n我们正在比较两个嵌套模型：\n原假设 $H_0$ 对应于较简单的单峰模型：\n$$ f_1(m; \\theta_1) = A \\exp\\left(-\\frac{(m - m_0)^2}{2\\sigma^2}\\right) + c $$\n该模型有一个参数向量 $\\theta_1 = (A, m_0, \\sigma, c)$，包含 $p_1 = 4$ 个参数。\n\n备择假设 $H_1$ 对应于较复杂的双峰模型：\n$$ f_2(m; \\theta_2) = A_1 \\exp\\left(-\\frac{(m - m_1)^2}{2\\sigma_1^2}\\right) + A_2 \\exp\\left(-\\frac{(m - m_2)^2}{2\\sigma_2^2}\\right) + c $$\n该模型有一个参数向量 $\\theta_2 = (A_1, A_2, m_1, m_2, \\sigma_1, \\sigma_2, c)$，包含 $p_2 = 7$ 个参数。\n这两个模型是嵌套的，因为 $f_1$ 是 $f_2$ 的一个特例（例如，当 $A_2 = 0$ 时）。\n\n当噪声方差 $s^2$ 未知时，为了比较这些嵌套模型，F检验是合适的统计工具。该检验是在独立同分布高斯噪声的假设下，根据SSR的性质推导出来的。我们首先对两个模型进行非线性最小二乘拟合，以获得它们各自的最小SSR，记为 $\\mathrm{SSR}_1$ 和 $\\mathrm{SSR}_2$。\n\nF统计量构造为，因增加参数而带来的残差平方和的均值减少量与更复杂模型的残差方差之比：\n$$ F = \\frac{(\\mathrm{SSR}_1 - \\mathrm{SSR}_2) / (p_2 - p_1)}{\\mathrm{SSR}_2 / (N - p_2)} $$\n在原假设（$H_0$）下，该统计量服从自由度为 $df_1 = p_2 - p_1$ 和 $df_2 = N - p_2$ 的F分布。对于本问题，我们有：\n- 数据点数：$N=301$。\n- 模型1的参数数量：$p_1=4$。\n- 模型2的参数数量：$p_2=7$。\n- 分子自由度：$df_1 = 7 - 4 = 3$。\n- 分母自由度：$df_2 = 301 - 7 = 294$。\n\n统计决策是通过计算与观测到的F统计量相关联的p值来做出的。p值是在原假设为真的前提下，观测到等于或大于计算出的F统计量的概率。\n$$ p\\text{-value} = P(F_{df_1, df_2} \\ge F_{observed}) $$\n如果该p值小于指定的显著性水平 $\\alpha = 0.01$，我们就拒绝原假设 $H_0$。这意味着双峰模型的额外复杂性因其对数据拟合度的统计显著改进而变得合理。否则，我们未能拒绝 $H_0$，并得出单峰模型已足够的结论。\n\n算法流程如下：\n1.  对每个测试用例，生成模拟质谱数据，包括加性高斯噪声。\n2.  定义单峰和双峰模型函数。\n3.  使用非线性最小二乘算法（如 `scipy.optimize.curve_fit`）将单峰模型拟合到数据。这需要提供合理的初始参数估计和边界以确保收敛。从而获得最小化的残差平方和 $\\mathrm{SSR}_1$。\n4.  类似地，将双峰模型拟合到相同的数据以获得 $\\mathrm{SSR}_2$。对于这个更复杂的拟合，初始猜测值至关重要；一个稳健的策略是使用单峰拟合的结果来初始化双峰模型的参数（例如，通过将单个峰分裂成两个）。\n5.  使用 $\\mathrm{SSR}_1$、$\\mathrm{SSR}_2$、$p_1$、$p_2$ 和 $N$ 计算F统计量。\n6.  使用自由度为 (3, 294) 的F分布的生存函数（1 - CDF）计算p值。\n7.  将p值与 $\\alpha = 0.01$ 进行比较。如果 $p  0.01$，结果为 $\\mathrm{True}$；否则为 $\\mathrm{False}$。对所有五个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\nfrom scipy.stats import f\n\ndef solve():\n    \"\"\"\n    Solves the mass spectrometry peak analysis problem by performing nested model comparison.\n    \"\"\"\n    \n    # Define global parameters for the m/z grid and statistical test\n    M_MIN = 4990.0\n    M_MAX = 5020.0\n    M_STEP = 0.1\n    ALPHA = 0.01\n    \n    # Use a fixed seed for reproducible noise generation\n    RANDOM_SEED = 42\n    \n    # Generate the mass-to-charge ratio grid\n    mz_grid = np.arange(M_MIN, M_MAX + M_STEP / 2, M_STEP)\n    N = len(mz_grid)\n\n    # Define model functions\n    def gaussian(m, A, m0, sigma):\n        \"\"\"A single Gaussian peak function.\"\"\"\n        return A * np.exp(-((m - m0)**2) / (2 * sigma**2))\n\n    def one_peak_model(m, A, m0, sigma, c):\n        \"\"\"A single Gaussian peak with a constant baseline.\"\"\"\n        return gaussian(m, A, m0, sigma) + c\n\n    def two_peak_model(m, A1, m1, sigma1, A2, m2, sigma2, c):\n        \"\"\"The sum of two Gaussian peaks with a shared constant baseline.\"\"\"\n        return gaussian(m, A1, m1, sigma1) + gaussian(m, A2, m2, sigma2) + c\n\n    def generate_data(params, noise_std):\n        \"\"\"Generates synthetic intensity data based on model parameters and noise.\"\"\"\n        A1, m1, sigma1, A2, m2, sigma2, c = params\n        \n        # Seed the random number generator for reproducibility\n        rng = np.random.default_rng(RANDOM_SEED)\n\n        true_signal = two_peak_model(mz_grid, A1, m1, sigma1, A2, m2, sigma2, c)\n        noise = rng.normal(0, noise_std, size=N)\n        return true_signal + noise\n\n    # Define test cases\n    test_cases = [\n        # Case 1: Well-separated two peaks, moderate noise\n        {'params': (12000, 5000, 1.5, 8000, 5012, 1.8, 150), 'noise_std': 150},\n        # Case 2: Borderline separation, moderate noise\n        {'params': (9000, 5000, 1.5, 7500, 5003, 1.5, 150), 'noise_std': 150},\n        # Case 3: Single peak only\n        {'params': (10000, 5005, 2.0, 0, 5005, 2.0, 150), 'noise_std': 150},\n        # Case 4: Two peaks with heavy noise\n        {'params': (5000, 4998, 1.6, 4500, 5006, 1.6, 150), 'noise_std': 1200},\n        # Case 5: Very close peaks, moderate noise\n        {'params': (8000, 5000, 1.5, 7000, 5000.75, 1.5, 150), 'noise_std': 150}\n    ]\n\n    results = []\n    \n    # Model parameters and degrees of freedom\n    p1 = 4  # Number of parameters in one-peak model\n    p2 = 7  # Number of parameters in two-peak model\n    dof1 = p2 - p1\n    dof2 = N - p2\n\n    for case in test_cases:\n        y_data = generate_data(case['params'], case['noise_std'])\n\n        # --- Fit One-Peak Model ---\n        # Initial guess\n        p0_c1 = np.min(y_data)\n        p0_A1_peak = np.max(y_data) - p0_c1\n        p0_m1_peak = mz_grid[np.argmax(y_data)]\n        p0_sigma1_peak = 1.5\n        p0_1 = [p0_A1_peak, p0_m1_peak, p0_sigma1_peak, p0_c1]\n        \n        # Bounds for parameters: [A, m0, sigma, c]\n        bounds_1 = ([0, M_MIN, 1e-6, -np.inf], [np.inf, M_MAX, (M_MAX - M_MIN) / 2, np.inf])\n\n        try:\n            popt1, _ = curve_fit(one_peak_model, mz_grid, y_data, p0=p0_1, bounds=bounds_1, maxfev=10000)\n            residuals1 = y_data - one_peak_model(mz_grid, *popt1)\n            ssr1 = np.sum(residuals1**2)\n        except RuntimeError:\n            ssr1 = np.inf\n\n\n        # --- Fit Two-Peak Model ---\n        # Initial guess based on one-peak fit\n        A_fit, m0_fit, sigma_fit, c_fit = popt1 if ssr1 != np.inf else p0_1\n        p0_2 = [\n            0.5 * A_fit, m0_fit - sigma_fit/2, sigma_fit,  # Peak 1\n            0.5 * A_fit, m0_fit + sigma_fit/2, sigma_fit,  # Peak 2\n            c_fit                                         # Baseline\n        ]\n\n        # Bounds for parameters: [A1, m1, sigma1, A2, m2, sigma2, c]\n        bounds_2 = ([0, M_MIN, 1e-6, 0, M_MIN, 1e-6, -np.inf], \n                    [np.inf, M_MAX, (M_MAX-M_MIN)/2, np.inf, M_MAX, (M_MAX-M_MIN)/2, np.inf])\n\n        try:\n            popt2, _ = curve_fit(two_peak_model, mz_grid, y_data, p0=p0_2, bounds=bounds_2, maxfev=10000)\n            residuals2 = y_data - two_peak_model(mz_grid, *popt2)\n            ssr2 = np.sum(residuals2**2)\n        except RuntimeError:\n            ssr2 = np.inf\n\n\n        # --- Perform F-test for Nested Models ---\n        decision = False\n        if ssr1 != np.inf and ssr2 != np.inf and ssr1  ssr2:\n            F_statistic = ((ssr1 - ssr2) / dof1) / (ssr2 / dof2)\n            p_value = f.sf(F_statistic, dof1, dof2)  # Survival function (1 - cdf)\n            \n            if p_value  ALPHA:\n                decision = True\n        \n        results.append(decision)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(lambda b: str(b).lower(), results))}]\")\n\nsolve()\n```"
        }
    ]
}