{
    "hands_on_practices": [
        {
            "introduction": "Understanding zoonotic transmission begins at the microscopic scale of a single exposure event. This practice challenges you to derive the exponential dose-response model from first principles, a cornerstone of quantitative microbial risk assessment. By modeling the number of viral particles as a random process and infection as a \"single-hit\" event, you will connect the chain of events from a reservoir host to a human and calculate the concrete probability of infection resulting from a single mosquito bite .",
            "id": "4686831",
            "problem": "A zoonotic arbovirus is maintained in an avian reservoir and transmitted to humans by a mosquito vector. Consider a single mosquito bite that occurs after the mosquito has fed on an infected bird. Assume the following biologically grounded chain for the delivered dose: the mosquito acquires virions from the bird’s bloodmeal; some fraction of these virions survive within the vector until the next bite; a fraction of the surviving virions are inoculated into the human dermis at the moment of biting. Let the expected number of virions delivered to the human (the dose) be denoted by $D$.\n\nStart from the following foundational assumptions, which are widely used in quantitative microbial risk assessment and vector-borne transmission modeling:\n- The count of virions acquired during blood feeding and the subsequent count inoculated into the human are well-approximated by Poisson processes due to stochastic partitioning at microscale and independence of individual virions.\n- Infection follows a “single-hit” mechanism: each inoculated virion independently has a constant probability to initiate infection upon arrival, and infection occurs if at least one virion successfully initiates infection.\n\nUsing these assumptions, derive the functional form for the probability of infection in terms of a per-virion infectivity parameter $k$ and the expected dose $D$. Then, compute the infection probability for the following scientifically plausible parameters of a single bite:\n- Reservoir viremia (virions per milliliter): $C_{r} = 2.0 \\times 10^{6}$.\n- Mosquito bloodmeal volume: $V_{m} = 3.5 \\,\\mu\\text{L}$, with $1\\,\\mu\\text{L} = 10^{-3}\\,\\text{mL}$.\n- Acquisition efficiency (fraction of virions in the bloodmeal that enter the mosquito midgut): $\\alpha = 0.15$.\n- In-vector survival from acquisition until the bite (fraction surviving): $s = 0.50$.\n- Inoculation efficiency at the bite (fraction of surviving virions injected into the human): $\\beta = 0.25$.\n- Per-virion infectivity (probability that an inoculated virion initiates infection, under independence): $k = 8.0 \\times 10^{-3}$.\n\nDefine the expected dose as $D = C_{r} \\times V_{m} \\times \\alpha \\times s \\times \\beta$ (with the volume converted to milliliters), and use the derived expression to compute the infection probability. Express your final probability as a decimal, and round your answer to four significant figures.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. The underlying assumptions—Poisson statistics for virion counts and an independent single-hit mechanism for infection—are standard and rigorously defined models in quantitative microbial risk assessment (QMRA) and virology. All necessary parameters are provided with plausible values, and the required calculations are clearly specified. The problem is therefore valid.\n\nThe solution process consists of two main parts: first, deriving the general functional form for the probability of infection based on the given assumptions, and second, calculating a specific numerical value for this probability using the provided parameters.\n\n**Part 1: Derivation of the Infection Probability Model**\n\nLet $N$ be the random variable representing the number of virions inoculated into the human during the mosquito bite. The problem states that $N$ can be modeled as a Poisson process. The expected number of inoculated virions is the dose, denoted by $D$. Therefore, $N$ follows a Poisson distribution with mean $D$. The probability mass function (PMF) of $N$ is given by:\n$$\nP(N=n) = \\frac{D^n \\exp(-D)}{n!} \\quad \\text{for } n = 0, 1, 2, \\dots\n$$\n\nThe problem assumes a \"single-hit\" infection mechanism. This implies that each of the $n$ inoculated virions acts independently to cause infection. Let $k$ be the probability that a single virion successfully initiates an infection. The probability that a single virion *fails* to initiate an infection is therefore $(1-k)$.\n\nGiven that $N=n$ virions have been inoculated, the probability that *none* of them initiate an infection is the product of their individual probabilities of failure, due to their independence. This probability is $(1-k)^n$. Infection occurs if at least one virion is successful. Thus, the probability of infection, conditional on $n$ virions being inoculated, is:\n$$\nP(\\text{Infection} | N=n) = 1 - P(\\text{No Infection} | N=n) = 1 - (1-k)^n\n$$\nThis formula holds for any $n \\ge 0$. If $n=0$, $P(\\text{Infection} | N=0) = 1 - (1-k)^0 = 1 - 1 = 0$, which is correct.\n\nTo find the total probability of infection, $P(\\text{Inf})$, we must sum the conditional probabilities over all possible values of $n$, weighted by the probability of each $n$ occurring. This is an application of the law of total probability:\n$$\nP(\\text{Inf}) = \\sum_{n=0}^{\\infty} P(\\text{Infection} | N=n) P(N=n)\n$$\nSubstituting the expressions for the conditional probability and the PMF of $N$:\n$$\nP(\\text{Inf}) = \\sum_{n=0}^{\\infty} [1 - (1-k)^n] \\frac{D^n \\exp(-D)}{n!}\n$$\nWe can separate the summation into two parts:\n$$\nP(\\text{Inf}) = \\sum_{n=0}^{\\infty} \\frac{D^n \\exp(-D)}{n!} - \\sum_{n=0}^{\\infty} (1-k)^n \\frac{D^n \\exp(-D)}{n!}\n$$\nThe first term is the sum of all probabilities in a Poisson distribution with mean $D$, which is equal to $1$:\n$$\n\\sum_{n=0}^{\\infty} \\frac{D^n \\exp(-D)}{n!} = \\exp(-D) \\sum_{n=0}^{\\infty} \\frac{D^n}{n!} = \\exp(-D) \\exp(D) = 1\n$$\nFor the second term, we can factor out $\\exp(-D)$ and combine the powers of $n$:\n$$\n\\sum_{n=0}^{\\infty} (1-k)^n \\frac{D^n \\exp(-D)}{n!} = \\exp(-D) \\sum_{n=0}^{\\infty} \\frac{[D(1-k)]^n}{n!}\n$$\nThe summation is the Taylor series expansion for the exponential function $\\exp(x)$ with $x=D(1-k)$. Therefore, the second term simplifies to:\n$$\n\\exp(-D) \\exp[D(1-k)] = \\exp[-D + D(1-k)] = \\exp(-D + D - Dk) = \\exp(-kD)\n$$\nCombining the two simplified terms, we arrive at the functional form for the probability of infection, which is the well-known exponential dose-response model:\n$$\nP(\\text{Inf}) = 1 - \\exp(-kD)\n$$\n\n**Part 2: Calculation of the Specific Infection Probability**\n\nFirst, we must calculate the expected dose, $D$, using the provided parameters and formula: $D = C_{r} \\times V_{m} \\times \\alpha \\times s \\times \\beta$.\nThe parameters are:\n- Reservoir viremia: $C_{r} = 2.0 \\times 10^{6} \\, \\text{virions/mL}$\n- Mosquito bloodmeal volume: $V_{m} = 3.5 \\, \\mu\\text{L}$\n- Acquisition efficiency: $\\alpha = 0.15$\n- In-vector survival: $s = 0.50$\n- Inoculation efficiency: $\\beta = 0.25$\n\nWe must first ensure the units are consistent. The volume $V_m$ must be converted from microliters ($\\mu\\text{L}$) to milliliters (mL) using the given conversion factor $1\\,\\mu\\text{L} = 10^{-3}\\,\\text{mL}$:\n$$\nV_{m} = 3.5 \\, \\mu\\text{L} = 3.5 \\times 10^{-3} \\, \\text{mL}\n$$\nNow, we can calculate $D$:\n$$\nD = (2.0 \\times 10^{6}) \\times (3.5 \\times 10^{-3}) \\times 0.15 \\times 0.50 \\times 0.25\n$$\nLet's compute the product step-by-step:\n$$\nD = (7.0 \\times 10^{3}) \\times (0.15 \\times 0.50 \\times 0.25)\n$$\n$$\nD = 7000 \\times (0.075 \\times 0.25)\n$$\n$$\nD = 7000 \\times 0.01875\n$$\n$$\nD = 131.25\n$$\nThe expected dose is $131.25$ virions.\n\nNext, we use the derived probability function $P(\\text{Inf}) = 1 - \\exp(-kD)$ with the calculated value of $D$ and the given per-virion infectivity $k = 8.0 \\times 10^{-3}$.\n$$\nP(\\text{Inf}) = 1 - \\exp[-(8.0 \\times 10^{-3}) \\times 131.25]\n$$\nCalculate the exponent:\n$$\n-k D = -0.008 \\times 131.25 = -1.05\n$$\nNow substitute this back into the probability equation:\n$$\nP(\\text{Inf}) = 1 - \\exp(-1.05)\n$$\nCalculating the numerical value:\n$$\n\\exp(-1.05) \\approx 0.34993802...\n$$\n$$\nP(\\text{Inf}) \\approx 1 - 0.34993802 = 0.65006197...\n$$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $6$, $5$, $0$, $0$. The fifth significant digit is $6$, which is greater than or equal to $5$, so we round up the last significant digit.\n$$\nP(\\text{Inf}) \\approx 0.6501\n$$",
            "answer": "$$\n\\boxed{0.6501}\n$$"
        },
        {
            "introduction": "While a single infection is a concern, the potential for an epidemic is determined by how efficiently a pathogen spreads from one person to another. This exercise guides you through the derivation of the basic reproduction number, $R_0$, for a vector-borne disease from mechanistic principles. You will then explore how changes in key biological and ecological parameters, such as vector biting rate or lifespan, affect $R_0$, providing critical insights into which interventions might be most effective at controlling an outbreak .",
            "id": "4686806",
            "problem": "A zoonotic arbovirus is maintained in a non-human reservoir but can amplify within humans when vectors feed on infectious humans. Under conditions where humans are competent amplifying hosts, the basic reproduction number ($R_0$) for the human–vector–human transmission loop can be derived from first principles. Use the following fundamental base: the basic reproduction number ($R_0$) is the expected number of secondary human infections produced by a single infectious human introduced into an otherwise fully susceptible human population; the total biting rate experienced by a human is the product of the per-vector biting rate and the vector-to-human ratio; vectors and hosts have exponentially distributed lifespans with constant hazards; survival through a fixed extrinsic incubation period is given by the exponential survival function; and the expected number of infectious contacts during an exponentially distributed infectious period equals the contact rate multiplied by the mean duration.\n\nAssume:\n- Each vector bites at rate $a$ (bites per vector per day) on humans.\n- The probability that a bite from an infectious vector infects a susceptible human is $b$.\n- The probability that a bite on an infectious human infects a susceptible vector is $c$.\n- The ratio of vectors to humans is $m$.\n- Vectors die at rate $\\mu$ (per day), and the extrinsic incubation period (EIP) is $n$ (days), so the probability a newly infected vector survives EIP is $\\exp(-\\mu n)$.\n- Humans recover at rate $r$ (per day).\n\nStarting from the above fundamental definitions and facts, derive an expression for $R_0$ in terms of $a$, $b$, $c$, $m$, $\\mu$, $n$, and $r$. Then evaluate $R_0$ and the local parameter sensitivities given by the partial derivatives $\\frac{\\partial R_0}{\\partial a}$, $\\frac{\\partial R_0}{\\partial b}$, $\\frac{\\partial R_0}{\\partial c}$, $\\frac{\\partial R_0}{\\partial m}$, $\\frac{\\partial R_0}{\\partial \\mu}$, and $\\frac{\\partial R_0}{\\partial n}$ at the following parameter values that are plausible for a mosquito-borne zoonosis in a peri-urban setting:\n- $a = 0.25$ bites per vector per day,\n- $b = 0.40$,\n- $c = 0.50$,\n- $m = 5.0$ vectors per human,\n- $\\mu = 0.10$ day$^{-1}$,\n- $n = 10$ days,\n- $r = 0.20$ day$^{-1}$.\n\nProvide the final numerical results as a single row matrix containing $R_0$, $\\frac{\\partial R_0}{\\partial a}$, $\\frac{\\partial R_0}{\\partial b}$, $\\frac{\\partial R_0}{\\partial c}$, $\\frac{\\partial R_0}{\\partial m}$, $\\frac{\\partial R_0}{\\partial \\mu}$, and $\\frac{\\partial R_0}{\\partial n}$ in that order. Round all numbers to four significant figures. Express all quantities as dimensionless numbers (no units).",
            "solution": "The problem is scientifically grounded, well-posed, and objective. It presents a standard exercise in mathematical epidemiology based on the Ross-Macdonald model framework for vector-borne diseases. All parameters and assumptions are clearly defined and consistent. Therefore, the problem is valid, and a solution will be derived.\n\nThe basic reproduction number, $R_0$, is defined as the expected number of secondary human infections produced by a single infectious human in a fully susceptible population. The transmission pathway is from an infectious human to a susceptible vector, and then from that vector (after it becomes infectious) to a susceptible human. We can express $R_0$ as the product of two quantities:\n$1$. The average number of vectors infected by a single infectious human.\n$2$. The average number of humans infected by a single newly infected vector over its entire lifespan.\n\nLet us derive each component separately.\n\nComponent $1$: Average number of vectors infected by a single infectious human.\n- The human recovery rate is $r$. Assuming an exponentially distributed infectious period, the mean duration of infectiousness for a single human is $\\frac{1}{r}$ days.\n- The ratio of vectors to humans is $m$, and each vector bites humans at a rate of $a$ bites per day. Therefore, a single human is bitten at a total rate of $m \\times a$ bites per day.\n- The probability that a bite on an infectious human successfully infects a susceptible vector is $c$.\nThe expected number of vectors infected by one infectious human is the product of the total biting rate on the human, the duration of human infectiousness, and the probability of transmission per bite.\n$$ \\text{Vectors infected per human} = (ma) \\times \\left(\\frac{1}{r}\\right) \\times c = \\frac{mac}{r} $$\n\nComponent $2$: Average number of humans infected by a single newly infected vector.\n- A vector, once infected, must survive the extrinsic incubation period (EIP) of $n$ days to become infectious. With a constant vector mortality rate of $\\mu$, the probability of surviving this period is given by the exponential survival function, $\\exp(-\\mu n)$.\n- If a vector survives the EIP, it becomes infectious for the remainder of its life. Since the vector lifespan is exponentially distributed with rate $\\mu$, the expected infectious lifetime is $\\frac{1}{\\mu}$ days.\n- During its infectious lifetime, the vector bites humans at a rate of $a$ bites per day. The total number of bites an infectious vector gives to humans is thus $a \\times \\frac{1}{\\mu}$.\n- The probability that a bite from an infectious vector successfully infects a susceptible human is $b$.\n- Therefore, the expected number of humans infected by one vector *that has become infectious* is $\\frac{ab}{\\mu}$.\n- To find the expected number of humans infected by a *newly infected* vector, we must multiply this by the probability of the vector surviving the EIP.\n$$ \\text{Humans infected per newly infected vector} = \\exp(-\\mu n) \\times \\frac{ab}{\\mu} $$\n\nCombining these two components, $R_0$ is the product:\n$$ R_0 = (\\text{Vectors infected per human}) \\times (\\text{Humans infected per newly infected vector}) $$\n$$ R_0 = \\left(\\frac{mac}{r}\\right) \\times \\left(\\frac{ab}{\\mu} \\exp(-\\mu n)\\right) $$\n$$ R_0 = \\frac{a^2 b c m}{r \\mu} \\exp(-\\mu n) $$\n\nNow, we evaluate $R_0$ using the given parameter values:\n$a = 0.25$, $b = 0.40$, $c = 0.50$, $m = 5.0$, $\\mu = 0.10$, $n = 10$, $r = 0.20$.\n$$ R_0 = \\frac{(0.25)^2 (0.40) (0.50) (5.0)}{(0.20) (0.10)} \\exp(-(0.10)(10)) $$\n$$ R_0 = \\frac{(0.0625) (0.40) (0.50) (5.0)}{0.02} \\exp(-1) $$\n$$ R_0 = \\frac{0.0625}{0.02} \\exp(-1) = 3.125 \\exp(-1) \\approx 1.14966... $$\nRounding to four significant figures, $R_0 = 1.150$.\n\nNext, we compute the local parameter sensitivities, which are the partial derivatives of $R_0$ with respect to each parameter.\n\n$1$. Sensitivity to $a$:\n$$ \\frac{\\partial R_0}{\\partial a} = \\frac{\\partial}{\\partial a} \\left(\\frac{a^2 b c m}{r \\mu} \\exp(-\\mu n)\\right) = \\frac{2a b c m}{r \\mu} \\exp(-\\mu n) = \\frac{2}{a} R_0 $$\n$$ \\frac{\\partial R_0}{\\partial a} = \\frac{2}{0.25} (1.14966...) = 8 \\times 1.14966... \\approx 9.1973... \\to 9.197 $$\n\n$2$. Sensitivity to $b$:\n$$ \\frac{\\partial R_0}{\\partial b} = \\frac{\\partial}{\\partial b} \\left(\\frac{a^2 b c m}{r \\mu} \\exp(-\\mu n)\\right) = \\frac{a^2 c m}{r \\mu} \\exp(-\\mu n) = \\frac{R_0}{b} $$\n$$ \\frac{\\partial R_0}{\\partial b} = \\frac{1.14966...}{0.40} \\approx 2.8741... \\to 2.874 $$\n\n$3$. Sensitivity to $c$:\n$$ \\frac{\\partial R_0}{\\partial c} = \\frac{\\partial}{\\partial c} \\left(\\frac{a^2 b c m}{r \\mu} \\exp(-\\mu n)\\right) = \\frac{a^2 b m}{r \\mu} \\exp(-\\mu n) = \\frac{R_0}{c} $$\n$$ \\frac{\\partial R_0}{\\partial c} = \\frac{1.14966...}{0.50} \\approx 2.2993... \\to 2.299 $$\n\n$4$. Sensitivity to $m$:\n$$ \\frac{\\partial R_0}{\\partial m} = \\frac{\\partial}{\\partial m} \\left(\\frac{a^2 b c m}{r \\mu} \\exp(-\\mu n)\\right) = \\frac{a^2 b c}{r \\mu} \\exp(-\\mu n) = \\frac{R_0}{m} $$\n$$ \\frac{\\partial R_0}{\\partial m} = \\frac{1.14966...}{5.0} \\approx 0.22993... \\to 0.2299 $$\n\n$5$. Sensitivity to $\\mu$:\n$$ \\frac{\\partial R_0}{\\partial \\mu} = \\frac{\\partial}{\\partial \\mu} \\left(\\frac{a^2 b c m}{r} \\mu^{-1} \\exp(-\\mu n)\\right) = \\frac{a^2 b c m}{r} \\left( (-\\mu^{-2})\\exp(-\\mu n) + \\mu^{-1}(-n)\\exp(-\\mu n) \\right) $$\n$$ \\frac{\\partial R_0}{\\partial \\mu} = \\frac{a^2 b c m}{r \\mu} \\exp(-\\mu n) \\left( -\\frac{1}{\\mu} - n \\right) = -R_0 \\left(\\frac{1}{\\mu} + n\\right) $$\n$$ \\frac{\\partial R_0}{\\partial \\mu} = -1.14966... \\left(\\frac{1}{0.10} + 10\\right) = -1.14966... (10 + 10) = -22.993... \\to -22.99 $$\n\n$6$. Sensitivity to $n$:\n$$ \\frac{\\partial R_0}{\\partial n} = \\frac{\\partial}{\\partial n} \\left(\\frac{a^2 b c m}{r \\mu} \\exp(-\\mu n)\\right) = \\frac{a^2 b c m}{r \\mu} (-\\mu \\exp(-\\mu n)) = -\\mu R_0 $$\n$$ \\frac{\\partial R_0}{\\partial n} = -(0.10) (1.14966...) = -0.114966... \\to -0.1150 $$\n\nWe assemble the seven numerical results into a single row matrix, with each value rounded to four significant figures.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.150 & 9.197 & 2.874 & 2.299 & 0.2299 & -22.99 & -0.1150 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Zoonotic pathogens often emerge from complex ecological and anthropogenic systems, such as wildlife trade networks, where reservoirs are not isolated but connected through the movement of animals. This advanced practice introduces a network modeling approach to quantify spillover risk, treating farms as reservoirs and markets as spillover points. By combining matrix algebra to model infection mixing and probability theory to model rare spillover events, you will build and implement a computational tool to assess how network structure and trade patterns drive the emergence of infectious diseases .",
            "id": "4686782",
            "problem": "A wildlife trade system links animal farms to live-animal markets through directed movement of animals. Farms act as wildlife-derived reservoirs of infection, while markets are points of potential zoonotic spillover to humans. Consider a discrete-time period in which trade flows occur and spillover is assessed. The network has two node types: farms and markets. Farm-to-farm movements mix infection pressure among farms, and farm-to-market movements deliver potentially infected animals to markets. You must derive a program to compute the network-wide probability of at least one spillover event to humans in a single period using principled approximations grounded in low-prevalence rare-event theory.\n\nUse the following foundational base and assumptions, which are widely used and tested in infectious disease modeling:\n\n- Low-prevalence linear reservoir mixing across farms: Let $A \\in \\mathbb{R}_{\\ge 0}^{F \\times F}$ be the directed farm-to-farm movement matrix whose entry $A_{ij}$ quantifies the per-period movement intensity from farm $i$ to farm $j$. Let $p^0 \\in [0,1]^F$ be the baseline within-farm infection prevalence vector arising from non-trade sources (for example, local wildlife reservoir pressure). Assume rare infection, such that the first-order next-generation approximation holds:\n  $$p = p^0 + \\gamma A p,$$\n  where $p \\in [0,1]^F$ is the stationary expected prevalence vector under mixing, and $\\gamma \\in [0,\\infty)$ is a small, dimensionless mixing coefficient capturing the proportional conversion of movement intensity into infection import pressure. Assume the stability condition $\\rho(\\gamma A) < 1$, where $\\rho(\\cdot)$ denotes the spectral radius, so that\n  $$p = (I - \\gamma A)^{-1} p^0.$$\n\n- Rare-event approximation for infected shipments from farms to markets: Let $W \\in \\mathbb{R}_{\\ge 0}^{F \\times M}$ be the farm-to-market shipment matrix whose entry $W_{ij}$ is the expected number of animals sent from farm $i$ to market $j$ per period. For rare infection, the number of infected animals shipped from $i$ to $j$ in a period can be modeled as a Poisson random variable with mean $p_i W_{ij}$ by the law of small numbers.\n\n- Superposition of independent Poisson processes: For a given market $j$, the total infected arrivals $N_j$ across all farms is Poisson with mean $\\Lambda_j = \\sum_{i=1}^F p_i W_{ij}$.\n\n- Poisson thinning for spillover events: Each infected arrival at market $j$ independently triggers a human spillover with probability $s_j \\in [0,1]$ during the period, where $s \\in [0,1]^M$ is the vector of per-infected-animal spillover probabilities at markets. By thinning, the number of human spillovers at market $j$ is Poisson with mean $s_j \\Lambda_j$, and the markets superpose to yield a network-wide Poisson count of spillovers with mean $\\sum_{j=1}^M s_j \\Lambda_j$.\n\nYour tasks are:\n- Starting from the items above, derive an explicit expression for the network-wide probability of at least one spillover in a single period as a function of $A$, $\\gamma$, $p^0$, $W$, and $s$, under the stated stability and independence assumptions.\n- Implement a program that computes this probability for each test case below, rounding the final probability to six decimal places.\n\nTest suite. For each case, use the specified parameter values. All matrices are given in row-major order. No physical units are required; all answers are dimensionless probabilities that must be reported as decimals in $[0,1]$.\n\n- Case 1 (general mixed connectivity and trade):\n  - $F = 3$, $M = 2$.\n  - $A = \\begin{bmatrix} 0 & 0.6 & 0 \\\\ 0.2 & 0 & 0.3 \\\\ 0 & 0.1 & 0 \\end{bmatrix}$.\n  - $\\gamma = 0.3$.\n  - $p^0 = \\begin{bmatrix} 0.01 \\\\ 0.005 \\\\ 0.0 \\end{bmatrix}$.\n  - $W = \\begin{bmatrix} 50 & 20 \\\\ 40 & 10 \\\\ 0 & 30 \\end{bmatrix}$.\n  - $s = \\begin{bmatrix} 0.02 \\\\ 0.05 \\end{bmatrix}$.\n\n- Case 2 (no reservoir connectivity, identical trade as Case 1):\n  - $F = 3$, $M = 2$.\n  - $A = \\begin{bmatrix} 0 & 0.6 & 0 \\\\ 0.2 & 0 & 0.3 \\\\ 0 & 0.1 & 0 \\end{bmatrix}$.\n  - $\\gamma = 0$.\n  - $p^0 = \\begin{bmatrix} 0.01 \\\\ 0.005 \\\\ 0.0 \\end{bmatrix}$.\n  - $W = \\begin{bmatrix} 50 & 20 \\\\ 40 & 10 \\\\ 0 & 30 \\end{bmatrix}$.\n  - $s = \\begin{bmatrix} 0.02 \\\\ 0.05 \\end{bmatrix}$.\n\n- Case 3 (high farm-to-farm connectivity near the stability boundary):\n  - $F = 3$, $M = 2$.\n  - $A = \\begin{bmatrix} 0 & 4 & 0 \\\\ 4 & 0 & 0 \\\\ 0 & 0.5 & 0 \\end{bmatrix}$.\n  - $\\gamma = 0.24$.\n  - $p^0 = \\begin{bmatrix} 0.002 \\\\ 0.001 \\\\ 0.001 \\end{bmatrix}$.\n  - $W = \\begin{bmatrix} 200 & 0 \\\\ 200 & 50 \\\\ 0 & 100 \\end{bmatrix}$.\n  - $s = \\begin{bmatrix} 0.01 \\\\ 0.02 \\end{bmatrix}$.\n\n- Case 4 (no trade to markets):\n  - $F = 2$, $M = 2$.\n  - $A = \\begin{bmatrix} 0 & 0.1 \\\\ 0.05 & 0 \\end{bmatrix}$.\n  - $\\gamma = 0.1$.\n  - $p^0 = \\begin{bmatrix} 0.01 \\\\ 0.02 \\end{bmatrix}$.\n  - $W = \\begin{bmatrix} 0 & 0 \\\\ 0 & 0 \\end{bmatrix}$.\n  - $s = \\begin{bmatrix} 0.05 \\\\ 0.1 \\end{bmatrix}$.\n\n- Case 5 (high-volume trade and high per-infected spillover probability):\n  - $F = 2$, $M = 1$.\n  - $A = \\begin{bmatrix} 0 & 1.0 \\\\ 0.5 & 0 \\end{bmatrix}$.\n  - $\\gamma = 0.2$.\n  - $p^0 = \\begin{bmatrix} 0.05 \\\\ 0.01 \\end{bmatrix}$.\n  - $W = \\begin{bmatrix} 1000 \\\\ 800 \\end{bmatrix}$.\n  - $s = \\begin{bmatrix} 0.3 \\end{bmatrix}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list contains one number per test case, where each number is the network-wide probability of at least one spillover in that case, rounded to six decimal places. For example, an output with three results should look like $[\\text{r}_1,\\text{r}_2,\\text{r}_3]$ where each $\\text{r}_k$ is a decimal rounded to six places.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in established principles of mathematical epidemiology, well-posed with all necessary information provided, and stated in objective, formal language. The stability condition $\\rho(\\gamma A) < 1$ is satisfied for all test cases, ensuring the existence of a unique, meaningful solution.\n\nThe objective is to derive an expression for the network-wide probability of at least one spillover event in a single period and to compute this value for a set of test cases. The derivation proceeds from the foundational assumptions provided.\n\n### Step 1: Derivation of the Total Spillover Rate\n\nThe model defines a sequence of processes leading from baseline farm prevalence to zoonotic spillover. We begin by deriving the mean rate of total network-wide spillovers, which we denote as $\\Lambda_{\\text{total}}$.\n\n**1. Stationary Farm Prevalence:**\nThe stationary expected prevalence vector across the $F$ farms, $p \\in [0,1]^F$, is given by the linear system:\n$$p = p^0 + \\gamma A p$$\nwhere $p^0 \\in [0,1]^F$ is the baseline prevalence vector, $A \\in \\mathbb{R}_{\\ge 0}^{F \\times F}$ is the farm-to-farm movement matrix, and $\\gamma \\in [0,\\infty)$ is the mixing coefficient. This equation can be rearranged as:\n$$I p - \\gamma A p = p^0$$\n$$(I - \\gamma A) p = p^0$$\nHere, $I$ is the $F \\times F$ identity matrix. The problem states that the stability condition $\\rho(\\gamma A) < 1$ holds, where $\\rho(\\cdot)$ is the spectral radius. This guarantees that the matrix $(I - \\gamma A)$ is invertible and that its inverse has non-negative entries. We can therefore solve for $p$:\n$$p = (I - \\gamma A)^{-1} p^0$$\nThis vector $p$ represents the expected infection prevalence on each farm after accounting for the spread of infection through the farm-to-farm trade network.\n\n**2. Infected Arrivals at Markets:**\nThe expected number of infected animals arriving at market $j$ from farm $i$ is $p_i W_{ij}$, where $p_i$ is the prevalence on farm $i$ and $W_{ij}$ is the entry in the farm-to-market shipment matrix $W \\in \\mathbb{R}_{\\ge 0}^{F \\times M}$.\nBy the assumption of superposition of independent Poisson processes, the total mean number of infected arrivals at market $j$, denoted by $\\Lambda_j$, is the sum of arrivals from all farms:\n$$\\Lambda_j = \\sum_{i=1}^F p_i W_{ij}$$\nWe can express the collection of these mean arrival rates for all $M$ markets as a vector $\\Lambda \\in \\mathbb{R}_{\\ge 0}^M$. This vector can be written using matrix-vector multiplication:\n$$\\Lambda = W^T p$$\nwhere $W^T$ is the transpose of the shipment matrix $W$.\n\n**3. Total Spillover Rate:**\nAt each market $j$, each infected animal triggers a human spillover event with probability $s_j$. The vector of these probabilities is $s \\in [0,1]^M$. By the property of Poisson thinning, the number of spillover events at market $j$ is a Poisson process with mean $s_j \\Lambda_j$.\nThe total network-wide number of spillovers is the sum of spillovers from all markets. As the sum of independent Poisson random variables is also a Poisson random variable, the total number of spillovers follows a Poisson distribution with a mean $\\Lambda_{\\text{total}}$ equal to the sum of the individual market means:\n$$\\Lambda_{\\text{total}} = \\sum_{j=1}^M s_j \\Lambda_j$$\nThis sum is the scalar product of the vectors $s$ and $\\Lambda$:\n$$\\Lambda_{\\text{total}} = s^T \\Lambda$$\nSubstituting the expressions for $\\Lambda$ and $p$, we obtain the full expression for the total spillover rate in terms of the input parameters:\n$$\\Lambda_{\\text{total}} = s^T (W^T p) = s^T W^T p$$\n$$\\Lambda_{\\text{total}} = s^T W^T (I - \\gamma A)^{-1} p^0$$\n\n### Step 2: Derivation of Spillover Probability\n\nLet $Z$ be the random variable representing the total number of spillover events across the entire network in one period. As derived above, $Z$ follows a Poisson distribution with mean $\\Lambda_{\\text{total}}$:\n$$Z \\sim \\text{Poisson}(\\Lambda_{\\text{total}})$$\nThe probability mass function of $Z$ is given by:\n$$P(Z=k) = \\frac{(\\Lambda_{\\text{total}})^k e^{-\\Lambda_{\\text{total}}}}{k!} \\quad \\text{for } k = 0, 1, 2, \\dots$$\nWe are interested in the probability of at least one spillover event, which is $P(Z \\ge 1)$. It is most easily calculated as the complement of the probability of zero spillover events, $P(Z=0)$:\n$$P(Z \\ge 1) = 1 - P(Z=0)$$\nFor a Poisson distribution, the probability of zero events is:\n$$P(Z=0) = \\frac{(\\Lambda_{\\text{total}})^0 e^{-\\Lambda_{\\text{total}}}}{0!} = e^{-\\Lambda_{\\text{total}}}$$\nTherefore, the network-wide probability of at least one spillover event is:\n$$P(Z \\ge 1) = 1 - e^{-\\Lambda_{\\text{total}}}$$\nSubstituting the expression for $\\Lambda_{\\text{total}}$, we arrive at the final formula:\n$$P(\\text{spillover} \\ge 1) = 1 - \\exp\\left(-s^T W^T (I - \\gamma A)^{-1} p^0\\right)$$\nThis expression allows for direct computation of the desired probability from the given parameters $A$, $\\gamma$, $p^0$, $W$, and $s$.\n\n### Step 3: Computational Algorithm\n\nThe derived formula is implemented for each test case using the following algorithm:\n1.  Represent the input parameters $A$, $p^0$, $W$, and $s$ as NumPy arrays and $\\gamma$ as a scalar.\n2.  Determine the number of farms, $F$, from the dimension of matrix $A$.\n3.  Construct the $F \\times F$ identity matrix, $I$.\n4.  Calculate the matrix $M = I - \\gamma A$.\n5.  Compute the inverse of $M$, i.e., $M^{-1} = (I - \\gamma A)^{-1}$.\n6.  Calculate the stationary prevalence vector $p = M^{-1} p^0$.\n7.  Compute the transpose of the shipment matrix, $W^T$.\n8.  Calculate the total spillover rate $\\Lambda_{\\text{total}} = s^T W^T p$. In code, this can be computed as a chain of dot products.\n9.  Calculate the final probability $P = 1 - \\exp(-\\Lambda_{\\text{total}})$.\n10. Round the result to six decimal places as specified.\n\nThis procedure is applied to each test case to generate the final list of probabilities.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It defines the test cases, computes the spillover probability for each,\n    and prints the results in the specified format.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general mixed connectivity and trade)\n        {\n            \"A\": np.array([\n                [0.0, 0.6, 0.0],\n                [0.2, 0.0, 0.3],\n                [0.0, 0.1, 0.0]\n            ]),\n            \"gamma\": 0.3,\n            \"p0\": np.array([0.01, 0.005, 0.0]),\n            \"W\": np.array([\n                [50.0, 20.0],\n                [40.0, 10.0],\n                [0.0, 30.0]\n            ]),\n            \"s\": np.array([0.02, 0.05])\n        },\n        # Case 2 (no reservoir connectivity, identical trade as Case 1)\n        {\n            \"A\": np.array([\n                [0.0, 0.6, 0.0],\n                [0.2, 0.0, 0.3],\n                [0.0, 0.1, 0.0]\n            ]),\n            \"gamma\": 0.0,\n            \"p0\": np.array([0.01, 0.005, 0.0]),\n            \"W\": np.array([\n                [50.0, 20.0],\n                [40.0, 10.0],\n                [0.0, 30.0]\n            ]),\n            \"s\": np.array([0.02, 0.05])\n        },\n        # Case 3 (high farm-to-farm connectivity near the stability boundary)\n        {\n            \"A\": np.array([\n                [0.0, 4.0, 0.0],\n                [4.0, 0.0, 0.0],\n                [0.0, 0.5, 0.0]\n            ]),\n            \"gamma\": 0.24,\n            \"p0\": np.array([0.002, 0.001, 0.001]),\n            \"W\": np.array([\n                [200.0, 0.0],\n                [200.0, 50.0],\n                [0.0, 100.0]\n            ]),\n            \"s\": np.array([0.01, 0.02])\n        },\n        # Case 4 (no trade to markets)\n        {\n            \"A\": np.array([\n                [0.0, 0.1],\n                [0.05, 0.0]\n            ]),\n            \"gamma\": 0.1,\n            \"p0\": np.array([0.01, 0.02]),\n            \"W\": np.array([\n                [0.0, 0.0],\n                [0.0, 0.0]\n            ]),\n            \"s\": np.array([0.05, 0.1])\n        },\n        # Case 5 (high-volume trade and high per-infected spillover probability)\n        {\n            \"A\": np.array([\n                [0.0, 1.0],\n                [0.5, 0.0]\n            ]),\n            \"gamma\": 0.2,\n            \"p0\": np.array([0.05, 0.01]),\n            \"W\": np.array([\n                [1000.0],\n                [800.0]\n            ]),\n            \"s\": np.array([0.3])\n        }\n    ]\n\n    def compute_spillover_prob(A, gamma, p0, W, s):\n        \"\"\"\n        Computes the network-wide probability of at least one spillover event.\n\n        Args:\n            A (np.ndarray): Farm-to-farm movement matrix (F x F).\n            gamma (float): Mixing coefficient.\n            p0 (np.ndarray): Baseline infection prevalence vector (F,).\n            W (np.ndarray): Farm-to-market shipment matrix (F x M).\n            s (np.ndarray): Per-infected-animal spillover probability vector (M,).\n\n        Returns:\n            float: The probability of at least one spillover event.\n        \"\"\"\n        F = A.shape[0]\n\n        # 1. Check stability condition (optional but good practice)\n        # The problem statement guarantees this holds, but we verify anyway.\n        # This check is illustrative and can be removed for submission.\n        eigvals = np.linalg.eigvals(gamma * A)\n        spectral_radius = np.max(np.abs(eigvals))\n        if spectral_radius >= 1:\n            raise ValueError(\"System is unstable: spectral radius of gamma*A is >= 1.\")\n\n        # 2. Compute the stationary prevalence vector p = (I - gamma*A)^-1 * p0\n        I = np.identity(F)\n        M_inv = np.linalg.inv(I - gamma * A)\n        p = M_inv @ p0\n\n        # 3. Compute total spillover rate Lambda_total = s^T * W^T * p\n        # Using 1D vectors for p0 and s, numpy's '@' operator correctly\n        # computes dot products and matrix-vector products.\n        # The chain s @ W.T @ p is evaluated right-to-left: W.T @ p first, then s @ result.\n        lambda_total = s @ W.T @ p\n\n        # 4. Compute probability of at least one spillover: P = 1 - exp(-Lambda_total)\n        # Handle cases where lambda_total might be negative due to float precision, though unlikely here.\n        if lambda_total  0:\n            lambda_total = 0.0\n            \n        prob = 1.0 - np.exp(-lambda_total)\n        \n        return prob\n\n    results = []\n    for case in test_cases:\n        prob = compute_spillover_prob(\n            case[\"A\"], case[\"gamma\"], case[\"p0\"], case[\"W\"], case[\"s\"]\n        )\n        # Format the result to exactly six decimal places for the output string.\n        results.append(f\"{prob:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}