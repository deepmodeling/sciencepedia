{
    "hands_on_practices": [
        {
            "introduction": "吞噬细胞通过“呼吸爆发”产生大量活性氧（ROS）来杀灭病原体，这是其关键的武器之一。本练习将通过一个核心计算，带领你领会这一过程的量级。利用基本的质量作用动力学定律，你将估算吞噬体腔内超氧化物的瞬时生成通量()。这项实践将理论化学动力学与细胞生物学现实相结合，为你定量理解细胞抗菌反应的强度奠定基础。",
            "id": "4678928",
            "problem": "一个专业吞噬细胞围绕一个凋亡小体形成一个大的吞噬体。在吞噬体腔内，烟酰胺腺嘌呤二核苷酸磷酸 (NADPH) 将电子提供给分子氧以生成超氧化物，这是一种直接参与胞内病原体杀伤的活性氧。假设在腔体尺度上，该电子转移步骤可以通过NADPH和氧气之间的基元双分子质量作用动力学很好地描述，其特征为一个有效的二级速率常数 $k$。在某一特定时刻，腔内浓度为 $[\\text{NADPH}]=100\\,\\mu\\text{M}$ 和 $[\\text{O}_2]=50\\,\\mu\\text{M}$。吞噬体体积为 $1\\,\\text{pL}$。假设系统在此瞬间混合均匀，并且每个基元反应事件生成一个超氧阴离子。\n\n给定 $k=10^{3}\\,\\text{M}^{-1}\\,\\text{s}^{-1}$ 和阿伏伽德罗常数 $N_{\\mathrm{A}}=6.022\\times 10^{23}\\,\\text{mol}^{-1}$，计算瞬时超氧化物生成通量，此处定义为在吞噬体腔内每秒生成的超氧化物分子总数。请以“分子/秒”为单位表示您的最终结果，并将答案四舍五入至三位有效数字。",
            "solution": "该问题陈述经评估具有科学依据、提法明确、客观且自洽。所有必要的物理常数、初始条件和动力学参数均已提供，足以计算出唯一且有意义的答案。其基础的生物学过程，即吞噬体内的氧化爆发，描述准确，并且使用基元质量作用动力学是在此背景下一个有效且明确说明的建模假设。所提供的浓度、体积和速率常数的数值在物理和生物学上均处于合理范围内。因此，该问题是有效的，将提供解答。\n\n该问题要求计算瞬时超氧化物生成通量，定义为在吞噬体腔内每秒生成的超氧化物分子总数。超氧化物的生成被建模为烟酰胺腺嘌呤二核苷酸磷酸 (NADPH) 和分子氧 ($\\text{O}_2$) 之间的基元双分子反应。\n\n设该反应表示为：\n$$\n\\text{NADPH} + \\text{O}_2 \\xrightarrow{k} \\text{超氧化物}\n$$\n根据基元反应的质量作用定律，以浓度表示的超氧化物生成速率（我们记为 $R$）由下式给出：\n$$\nR = \\frac{d[\\text{Superoxide}]}{dt} = k [\\text{NADPH}] [\\text{O}_2]\n$$\n该速率 $R$ 的单位将是 $\\text{M}\\,\\text{s}^{-1}$，或等效地，$\\text{mol}\\,\\text{L}^{-1}\\,\\text{s}^{-1}$。\n\n问题提供了以下数值：\n-   二级速率常数，$k = 10^{3}\\,\\text{M}^{-1}\\,\\text{s}^{-1}$。\n-   NADPH 的瞬时浓度，$[\\text{NADPH}] = 100\\,\\mu\\text{M}$。\n-   氧气的瞬时浓度，$[\\text{O}_2] = 50\\,\\mu\\text{M}$。\n\n首先，我们将浓度转换为摩尔浓度 ($\\text{M}$) 的标准单位，即 $\\text{mol}\\,\\text{L}^{-1}$。\n$$\n[\\text{NADPH}] = 100\\,\\mu\\text{M} = 100 \\times 10^{-6}\\,\\text{M} = 10^{-4}\\,\\text{M}\n$$\n$$\n[\\text{O}_2] = 50\\,\\mu\\text{M} = 50 \\times 10^{-6}\\,\\text{M} = 5 \\times 10^{-5}\\,\\text{M}\n$$\n\n现在，我们可以计算以浓度表示的瞬时超氧化物生成速率：\n$$\nR = (10^{3}\\,\\text{M}^{-1}\\,\\text{s}^{-1}) \\times (10^{-4}\\,\\text{M}) \\times (5 \\times 10^{-5}\\,\\text{M})\n$$\n$$\nR = 5 \\times 10^{3-4-5}\\,\\text{M}\\,\\text{s}^{-1} = 5 \\times 10^{-6}\\,\\text{M}\\,\\text{s}^{-1}\n$$\n这个速率 $R = 5 \\times 10^{-6}\\,\\text{mol}\\,\\text{L}^{-1}\\,\\text{s}^{-1}$ 表示每升体积每秒产生的超氧化物的摩尔数。\n\n问题要求的是在整个吞噬体体积内每秒产生的分子总数。我们用生产通量 $J$ 来表示这个量。为了求出以摩尔/秒为单位的总生成速率，我们必须将浓度速率 $R$ 乘以吞噬体的体积 $V$。\n给定体积为 $V = 1\\,\\text{pL}$。我们将其转换为升：\n$$\nV = 1\\,\\text{pL} = 10^{-12}\\,\\text{L}\n$$\n那么，总摩尔生成速率 $\\dot{n}_{s}$ 为：\n$$\n\\dot{n}_{s} = R \\times V = (5 \\times 10^{-6}\\,\\text{mol}\\,\\text{L}^{-1}\\,\\text{s}^{-1}) \\times (10^{-12}\\,\\text{L}) = 5 \\times 10^{-18}\\,\\text{mol}\\,\\text{s}^{-1}\n$$\n\n最后，为了求出每秒产生的分子总数 ($J$)，我们必须将摩尔生成速率 $\\dot{n}_{s}$ 乘以阿伏伽德罗常数 $N_{\\mathrm{A}}$。\n阿伏伽德罗常数的值为 $N_{\\mathrm{A}} = 6.022 \\times 10^{23}\\,\\text{mol}^{-1}$。\n$$\nJ = \\dot{n}_{s} \\times N_{\\mathrm{A}}\n$$\n$$\nJ = (5 \\times 10^{-18}\\,\\text{mol}\\,\\text{s}^{-1}) \\times (6.022 \\times 10^{23}\\,\\text{mol}^{-1})\n$$\n$$\nJ = 5 \\times 6.022 \\times 10^{-18+23}\\,\\text{s}^{-1}\n$$\n$$\nJ = 30.11 \\times 10^{5}\\,\\text{s}^{-1}\n$$\n$$\nJ = 3.011 \\times 10^{6}\\,\\text{s}^{-1}\n$$\n此处的单位 $\\text{s}^{-1}$ 意味着“分子/秒”，符合要求。\n\n问题要求将答案四舍五入到三位有效数字。\n$$\nJ \\approx 3.01 \\times 10^{6}\\,\\text{分子/秒}\n$$\n这就是吞噬体腔内的瞬时超氧化物生成通量。",
            "answer": "$$\n\\boxed{3.01 \\times 10^{6}}\n$$"
        },
        {
            "introduction": "在细胞内部，活性物质的生成和消耗构成了一个动态网络，而非简单的累积。本练习将模型的复杂度提升了一步，不仅引入了描述酶促反应的米氏方程来计算一氧化氮（NO）的生成速率，还要求你应用稳态近似来分析其在多条竞争性消耗途径中的命运()。通过这项实践，你将掌握一种分析生物化学网络中关键分子平衡浓度的强大工具，并理解细胞如何精确调控这些高活性信号分子的水平。",
            "id": "4678923",
            "problem": "在巨噬细胞吞噬体中，诱导型一氧化氮合酶（iNOS; inducible nitric oxide synthase）催化L-精氨酸生成一氧化氮。假设对于酶-底物复合物，在准稳态条件下为单底物催化机制，其中对于L-精氨酸，最大催化速率为 $V_{\\max} = 1\\,\\mu\\text{M/s}$，米氏常数为 $K_{m} = 10\\,\\mu\\text{M}$。吞噬体内的L-精氨酸浓度为 $[\\text{Arg}] = 100\\,\\mu\\text{M}$。同时，烟酰胺腺嘌呤二核苷酸磷酸氧化酶（NADPH oxidase）的活性维持了一个稳定的超氧化物浓度 $[\\text{O}_2^{\\cdot -}] = 0.20\\,\\mu\\text{M}$。一氧化氮与超氧化物反应生成过氧亚硝酸盐的扩散控制双分子速率常数为 $k_{p} = 6.7 \\times 10^{9}\\,\\text{M}^{-1}\\,\\text{s}^{-1}$。一氧化氮的其他消耗途径被建模为一级衰变，速率常数为 $k_{d} = 0.10\\,\\text{s}^{-1}$。在酸性的吞噬体腔内，假设过氧亚硝酸盐迅速质子化为过氧亚硝酸，随后均裂生成二氧化氮自由基和羟基自由基，使得每个生成的过氧亚硝酸盐对应的二氧化氮自由基产率为1。\n\n根据酶动力学中 $V_{\\max}$ 和 $K_{m}$ 的核心定义，并对吞噬体腔内的一氧化氮应用稳态质量平衡，利用上述参数，确定：\n- 一氧化氮的生成速率 $r_{\\text{NO}}$（单位为 $\\mu\\text{M/s}$），\n- 二氧化氮自由基的形成速率 $r_{\\text{NO}_2^{\\cdot}}$（单位为 $\\mu\\text{M/s}$）。\n\n将两个速率均以 $\\mu\\text{M/s}$ 表示，并各自四舍五入到三位有效数字。以二元行矩阵的形式提供最终答案，顺序为 $\\left(r_{\\text{NO}},\\, r_{\\text{NO}_2^{\\cdot}}\\right)$。",
            "solution": "该问题要求基于描述酶动力学和吞噬体内后续化学反应的一系列参数，确定两个速率：一氧化氮的生成速率（$r_{\\text{NO}}$）和二氧化氮自由基的形成速率（$r_{\\text{NO}_2^{\\cdot}}$）。\n\n首先，我们确定一氧化氮的生成速率 $r_{\\text{NO}}$。问题陈述，一氧化氮（NO）是由 iNOS 酶以 L-精氨酸为底物，在准稳态条件下遵循单底物催化机制生成的。这对应于酶动力学的米氏-孟顿模型。反应速率 $v$ 由下式给出：\n$$v = \\frac{V_{\\max} [S]}{K_{m} + [S]}$$\n在此情境下，速率 $v$ 即为一氧化氮生成速率 $r_{\\text{NO}}$，底物 $S$ 为 L-精氨酸，[$S$] = [Arg]。给定的参数为最大催化速率 $V_{\\max} = 1\\,\\mu\\text{M/s}$，米氏常数 $K_{m} = 10\\,\\mu\\text{M}$，以及 L-精氨酸浓度 $[\\text{Arg}] = 100\\,\\mu\\text{M}$。\n\n将这些值代入米氏-孟顿方程：\n$$r_{\\text{NO}} = \\frac{V_{\\max} [\\text{Arg}]}{K_{m} + [\\text{Arg}]} = \\frac{(1\\,\\mu\\text{M/s}) \\times (100\\,\\mu\\text{M})}{10\\,\\mu\\text{M} + 100\\,\\mu\\text{M}}$$\n$$r_{\\text{NO}} = \\frac{100}{110}\\,\\mu\\text{M/s} = \\frac{10}{11}\\,\\mu\\text{M/s}$$\n数值上，该值为：\n$$r_{\\text{NO}} \\approx 0.90909...\\,\\mu\\text{M/s}$$\n四舍五入到三位有效数字，一氧化氮的生成速率为 $0.909\\,\\mu\\text{M/s}$。\n\n接下来，我们确定二氧化氮自由基的形成速率 $r_{\\text{NO}_2^{\\cdot}}$。为此，我们必须首先确定一氧化氮的稳态浓度 $[\\text{NO}]_{ss}$。在稳态下，NO 的生成速率等于其消耗速率。\n$$\\frac{d[\\text{NO}]}{dt} = (\\text{Rate of Production}) - (\\text{Rate of Consumption}) = 0$$\n生成速率为上面计算出的 $r_{\\text{NO}}$。NO 的消耗通过两条途径发生：\n1.  与超氧化物 $\\text{O}_2^{\\cdot -}$ 的双分子反应，速率常数为 $k_{p}$。该反应的速率为 $k_{p} [\\text{NO}] [\\text{O}_2^{\\cdot -}]$。\n2.  代表其他消耗途径的一级衰变，速率常数为 $k_{d}$。该过程的速率为 $k_{d} [\\text{NO}]$。\n\n总消耗速率是这两条途径速率的总和：\n$$ \\text{Rate of Consumption} = k_{p} [\\text{NO}] [\\text{O}_2^{\\cdot -}] + k_{d} [\\text{NO}] = (k_{p} [\\text{O}_2^{\\cdot -}] + k_{d}) [\\text{NO}] $$\n在稳态下，其中 $[\\text{NO}] = [\\text{NO}]_{ss}$：\n$$ r_{\\text{NO}} = (k_{p} [\\text{O}_2^{\\cdot -}] + k_{d}) [\\text{NO}]_{ss} $$\n问题陈述，二氧化氮自由基 $\\text{NO}_2^{\\cdot}$ 是由过氧亚硝酸盐生成的，产率为 1。过氧亚硝酸盐是 $\\text{NO}$ 和 $\\text{O}_2^{\\cdot -}$ 反应的产物。因此，$\\text{NO}_2^{\\cdot}$ 的形成速率等于稳态下 $\\text{NO}$ 和 $\\text{O}_2^{\\cdot -}$ 之间的反应速率：\n$$ r_{\\text{NO}_2^{\\cdot}} = k_{p} [\\text{NO}]_{ss} [\\text{O}_2^{\\cdot -}] $$\n我们可以找到一个 $r_{\\text{NO}_2^{\\cdot}}$ 的表达式，而无需显式计算 $[\\text{NO}]_{ss}$。根据稳态平衡，我们可以用 $r_{\\text{NO}}$ 来表示 $[\\text{NO}]_{ss}$：\n$$ [\\text{NO}]_{ss} = \\frac{r_{\\text{NO}}}{k_{p} [\\text{O}_2^{\\cdot -}] + k_{d}} $$\n将此代入 $r_{\\text{NO}_2^{\\cdot}}$ 的方程：\n$$ r_{\\text{NO}_2^{\\cdot}} = k_{p} [\\text{O}_2^{\\cdot -}] \\left( \\frac{r_{\\text{NO}}}{k_{p} [\\text{O}_2^{\\cdot -}] + k_{d}} \\right) = r_{\\text{NO}} \\left( \\frac{k_{p} [\\text{O}_2^{\\cdot -}]}{k_{p} [\\text{O}_2^{\\cdot -}] + k_{d}} \\right) $$\n该表达式表明，$r_{\\text{NO}_2^{\\cdot}}$ 是被超氧化物途径消耗的总 NO 生成量的一部分。现在，我们代入参数的数值。\n给定的参数是：\n- $k_{p} = 6.7 \\times 10^{9}\\,\\text{M}^{-1}\\,\\text{s}^{-1}$\n- $[\\text{O}_2^{\\cdot -}] = 0.20\\,\\mu\\text{M}$\n- $k_{d} = 0.10\\,\\text{s}^{-1}$\n\n我们必须确保单位一致。我们将使用 $\\mu\\text{M}$ 作为浓度单位，$\\text{s}$ 作为时间单位。速率常数 $k_p$ 必须进行转换：\n$$k_{p} = 6.7 \\times 10^{9}\\,\\text{M}^{-1}\\,\\text{s}^{-1} = 6.7 \\times 10^{9} \\frac{1}{10^{6}\\,\\mu\\text{M}} \\text{s}^{-1} = 6.7 \\times 10^{3}\\,\\mu\\text{M}^{-1}\\,\\text{s}^{-1}$$\n现在我们可以计算分数中分母的各项：\n$$ k_{p} [\\text{O}_2^{\\cdot -}] = (6.7 \\times 10^{3}\\,\\mu\\text{M}^{-1}\\,\\text{s}^{-1}) \\times (0.20\\,\\mu\\text{M}) = 1340\\,\\text{s}^{-1} $$\n$$ k_{d} = 0.10\\,\\text{s}^{-1} $$\n总和为 $1340\\,\\text{s}^{-1} + 0.10\\,\\text{s}^{-1} = 1340.1\\,\\text{s}^{-1}$。\n两条途径之间的竞争严重偏向于超氧化物反应，因为 $1340 \\gg 0.10$。\n\n现在我们计算 $r_{\\text{NO}_2^{\\cdot}}$：\n$$ r_{\\text{NO}_2^{\\cdot}} = r_{\\text{NO}} \\left( \\frac{1340\\,\\text{s}^{-1}}{1340.1\\,\\text{s}^{-1}} \\right) = \\left( \\frac{10}{11}\\,\\mu\\text{M/s} \\right) \\left( \\frac{1340}{1340.1} \\right) $$\n$$ r_{\\text{NO}_2^{\\cdot}} \\approx (0.90909...) \\times (0.999925...) \\,\\mu\\text{M/s} \\approx 0.909022...\\,\\mu\\text{M/s} $$\n四舍五入到三位有效数字，二氧化氮自由基的形成速率为 $0.909\\,\\mu\\text{M/s}$。\n\n最终答案是：\n- $r_{\\text{NO}} = 0.909\\,\\mu\\text{M/s}$\n- $r_{\\text{NO}_2^{\\cdot}} = 0.909\\,\\mu\\text{M/s}$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.909 & 0.909 \\end{pmatrix} } $$"
        },
        {
            "introduction": "吞噬作用并非一个简单的反射动作，而是一个复杂的细胞决策过程，它整合了来自细胞表面的多种信号。这项最终的综合性练习将引导你构建一个计算模型，运用贝叶斯推断来预测吞噬事件的最终结果()。你将学习如何将受体结合、信号传导强度和调理素覆盖率等生物物理输入转化为细胞反应的概率性输出，这真实地反映了定量细胞生物学的前沿思想。",
            "id": "4678926",
            "problem": "要求您构建一个基于原理的贝叶斯计算模型，用于在给定与细胞内病原体杀伤过程中的受体-配体相互作用和调理作用相关的可测量特征的情况下，预测吞噬作用的概率。该模型必须整合三个组成部分：受体占据率、信号强度和调理素覆盖率，并且必须使用贝叶斯定理计算吞噬作用的后验概率 $P(E\\mid \\mathrm{features})$。该场景涉及一个专业吞噬细胞遇到一个被调理的病原体。\n\n使用的基本原理：\n- 用于后验概率的贝叶斯定理：$P(E\\mid X) = \\dfrac{P(X\\mid E)P(E)}{P(X)}$ 及其优势比形式 $O(E\\mid X) = O(E)\\cdot \\Lambda(X)$，其中 $O(E) = \\dfrac{P(E)}{1-P(E)}$ 是吞噬作用的先验优势比，$\\Lambda(X)$ 是似然比。后验概率可通过 $P(E\\mid X) = \\dfrac{O(E\\mid X)}{1+O(E\\mid X)}$ 恢复。\n- 用于受体占据率的质量作用结合平衡（朗缪尔等温线）：某一受体类别 $r$ 被其配体占据的分数占据率为 $\\theta_r = \\dfrac{L_r}{L_r + K_{D,r}}$，其中 $L_r$ 是有效配体浓度（单位与解离常数 $K_{D,r}$ 相同）。\n- 来自被占据受体的饱和（希尔型）信号传导：由受体类别 $r$ 贡献的信号强度是被占据受体数量 $n_{\\mathrm{occ},r}$ 的一个单调饱和函数。\n\n需要推导和实现的模型组件：\n1. 有效配体浓度。对于免疫球蛋白G (IgG) 调理作用，其与免疫球蛋白G受体γ（Fc gamma receptor，写作Fcγ）结合，定义有效配体浓度为 $L_{\\mathrm{Fc\\gamma}} = \\rho_{\\mathrm{IgG}}\\cdot L_{0,\\mathrm{IgG}}$。对于补体3b (C3b) 调理作用，其与补体受体3 (CR3) 结合，定义 $L_{\\mathrm{CR3}} = \\rho_{\\mathrm{C3b}}\\cdot L_{0,\\mathrm{C3b}}$。此处 $\\rho$ 值是区间 $[0,1]$ 内的调理素覆盖分数，而 $L_0$ 是基础配体浓度（单位：纳摩尔）。\n2. 分数占据率。使用解离常数 $K_{D,\\mathrm{Fc\\gamma}}$ 和 $K_{D,\\mathrm{CR3}}$，通过朗缪尔等温线计算 $\\theta_{\\mathrm{Fc\\gamma}}$ 和 $\\theta_{\\mathrm{CR3}}$。所有浓度单位必须为纳摩尔。\n3. 被占据受体数量。给定受体表面密度 $R_{\\mathrm{Fc\\gamma}}$ 和 $R_{\\mathrm{CR3}}$（单位：受体数/平方微米）以及接触面积 $A$（单位：平方微米），计算 $n_{\\mathrm{occ},\\mathrm{Fc\\gamma}} = R_{\\mathrm{Fc\\gamma}}\\cdot A \\cdot \\theta_{\\mathrm{Fc\\gamma}}$ 和 $n_{\\mathrm{occ},\\mathrm{CR3}} = R_{\\mathrm{CR3}}\\cdot A \\cdot \\theta_{\\mathrm{CR3}}$。\n4. 信号强度。对于每个受体类别 $r\\in\\{\\mathrm{Fc\\gamma},\\mathrm{CR3}\\}$，定义一个关于 $n_{\\mathrm{occ},r}$ 的希尔型信号函数，其希尔系数为 $h_r$，半饱和数为 $n_{1/2,r}$（被占据的受体），权重为 $w_r$，作为 $n_{\\mathrm{occ},r}$ 的一个单调递增饱和函数。包含一个权重为 $w_{\\mathrm{PRR}}$ 的模式识别受体 (PRR) 基线信号 $S_{\\mathrm{PRR}}$。将它们组合成总信号强度 $S_{\\mathrm{tot}}$。\n5. 似然比。构建一个似然比 $\\Lambda(X)$，它在总信号强度和平均调理素覆盖率 $\\rho_{\\mathrm{tot}} = \\dfrac{\\rho_{\\mathrm{IgG}} + \\rho_{\\mathrm{C3b}}}{2}$ 两者上均单调递增，并包含信号强度和覆盖率之间的相互作用项。使用具有系数 $\\beta_0$, $\\beta_S$, $\\beta_\\rho$ 和 $\\beta_{\\mathrm{int}}$ 的对数线性函数形式，然后取指数以获得 $\\Lambda(X)$。\n6. 后验概率。组合先验优势比和似然比以获得 $O(E\\mid X)$，并将其转换为 $P(E\\mid X)$。\n\n超参数（使用这些确切的数值和单位）：\n- 吞噬作用的先验概率 $P(E) = 0.1$（无量纲）。\n- 基础配体浓度：$L_{0,\\mathrm{IgG}} = 100$ 纳摩尔, $L_{0,\\mathrm{C3b}} = 100$ 纳摩尔。\n- 解离常数：$K_{D,\\mathrm{Fc\\gamma}} = 10$ 纳摩尔, $K_{D,\\mathrm{CR3}} = 50$ 纳摩尔。\n- 接触面积：$A = 1.0$ 平方微米。\n- 希尔信号参数：$h_{\\mathrm{Fc\\gamma}} = 2$, $h_{\\mathrm{CR3}} = 2$；$n_{1/2,\\mathrm{Fc\\gamma}} = 50$ 被占据的受体, $n_{1/2,\\mathrm{CR3}} = 30$ 被占据的受体；权重 $w_{\\mathrm{Fc\\gamma}} = 1.0$, $w_{\\mathrm{CR3}} = 0.8$, 以及 $w_{\\mathrm{PRR}} = 0.5$。\n- 似然比系数：$\\beta_0 = 0.0$, $\\beta_S = 2.0$, $\\beta_\\rho = 1.0$, $\\beta_{\\mathrm{int}} = 0.5$。\n\n每个测试用例的输入：\n- $\\rho_{\\mathrm{IgG}}$ 在 $[0,1]$ 区间内（无量纲分数覆盖率），\n- $\\rho_{\\mathrm{C3b}}$ 在 $[0,1]$ 区间内（无量纲分数覆盖率），\n- $R_{\\mathrm{Fc\\gamma}}$ 单位为 受体数/平方微米，\n- $R_{\\mathrm{CR3}}$ 单位为 受体数/平方微米，\n- $S_{\\mathrm{PRR}}$ 作为在 $[0,1]$ 区间内的无量纲基线信号水平。\n\n定义以下五个测试用例的测试套件，以评估不同情况：\n1. 中等调理素覆盖率和受体密度：$(\\rho_{\\mathrm{IgG}}, \\rho_{\\mathrm{C3b}}, R_{\\mathrm{Fc\\gamma}}, R_{\\mathrm{CR3}}, S_{\\mathrm{PRR}}) = (0.4, 0.3, 120, 80, 0.2)$。\n2. 无调理素覆盖，弱PRR信号：$(0.0, 0.0, 150, 100, 0.1)$。\n3. 近饱和调理素覆盖率和高受体密度：$(0.95, 0.9, 200, 150, 0.4)$。\n4. 低覆盖率和低受体密度，无PRR信号：$(0.2, 0.05, 50, 50, 0.0)$。\n5. 权衡情况（高IgG覆盖率、低Fc$\\gamma$受体密度，低C3b覆盖率、高CR3密度）：$(0.8, 0.2, 40, 200, 0.3)$。\n\n您的程序必须：\n- 实现上述推导步骤，使用规定的超参数和单位为每个测试用例计算 $P(E\\mid \\mathrm{features})$。\n- 生成单行输出，其中包含五个后验概率，以小数形式表示，四舍五入到六位小数，并用逗号分隔，置于方括号内，例如：“[0.123456,0.654321,0.500000,0.000001,0.999999]”。\n\n所有具有物理单位的量均已指定；最终答案是无量纲的概率，必须以四舍五入到六位小数的小数形式输出。不涉及角度。输出中不允许使用百分比。",
            "solution": "问题陈述已经过严格验证，被认为是具有科学依据、良构且客观的。它提供了一套完整且一致的定义、参数和测试用例，用于构建一个生物物理上合理的吞噬作用计算模型。该模型基于免疫学、生物化学和统计推断的既定原理，并且所有必需的参数都用一致的单位指定。因此，可以构建一个有效的解决方案。\n\n该模型计算病原体吞噬的后验概率 $P(E\\mid X)$，其中 $E$ 表示吞噬事件，$X$ 代表可测量特征的集合。计算通过一系列步骤进行，将多个生物物理和信号传导过程整合到一个连贯的贝叶斯框架中。\n\n模型的核心是优势比形式的贝叶斯定理：\n$$\nO(E\\mid X) = O(E) \\cdot \\Lambda(X)\n$$\n其中 $O(E\\mid X)$ 是吞噬的后验优势比，$O(E)$ 是先验优势比，而 $\\Lambda(X)$ 是似然比，它量化了特征 $X$ 提供的证据。最终的概率使用以下关系恢复：\n$$\nP(E\\mid X) = \\dfrac{O(E\\mid X)}{1 + O(E\\mid X)}\n$$\n\n对于一组给定的输入特征 $(\\rho_{\\mathrm{IgG}}, \\rho_{\\mathrm{C3b}}, R_{\\mathrm{Fc\\gamma}}, R_{\\mathrm{CR3}}, S_{\\mathrm{PRR}})$，其计算流程如下：\n\n**步骤 1：先验优势比计算**\n吞噬的先验概率给定为 $P(E) = 0.1$。相应的先验优势比为：\n$$\nO(E) = \\dfrac{P(E)}{1 - P(E)} = \\dfrac{0.1}{1 - 0.1} = \\dfrac{1}{9}\n$$\n\n**步骤 2：有效配体浓度**\n可用于结合受体的配体的有效浓度与调理素覆盖分数 $\\rho_{\\mathrm{IgG}}$ 和 $\\rho_{\\mathrm{C3b}}$ 成正比。使用基础配体浓度 $L_{0,\\mathrm{IgG}} = 100$ nM 和 $L_{0,\\mathrm{C3b}} = 100$ nM：\n$$\nL_{\\mathrm{Fc\\gamma}} = \\rho_{\\mathrm{IgG}} \\cdot L_{0,\\mathrm{IgG}} = 100 \\cdot \\rho_{\\mathrm{IgG}}\n$$\n$$\nL_{\\mathrm{CR3}} = \\rho_{\\mathrm{C3b}} \\cdot L_{0,\\mathrm{C3b}} = 100 \\cdot \\rho_{\\mathrm{C3b}}\n$$\n\n**步骤 3：分数受体占据率**\n每种受体类型的分数占据率由朗缪尔等温线建模，该等温线描述了平衡结合。使用解离常数 $K_{D,\\mathrm{Fc\\gamma}} = 10$ nM 和 $K_{D,\\mathrm{CR3}} = 50$ nM：\n$$\n\\theta_{\\mathrm{Fc\\gamma}} = \\dfrac{L_{\\mathrm{Fc\\gamma}}}{L_{\\mathrm{Fc\\gamma}} + K_{D,\\mathrm{Fc\\gamma}}} = \\dfrac{100 \\cdot \\rho_{\\mathrm{IgG}}}{100 \\cdot \\rho_{\\mathrm{IgG}} + 10}\n$$\n$$\n\\theta_{\\mathrm{CR3}} = \\dfrac{L_{\\mathrm{CR3}}}{L_{\\mathrm{CR3}} + K_{D,\\mathrm{CR3}}} = \\dfrac{100 \\cdot \\rho_{\\mathrm{C3b}}}{100 \\cdot \\rho_{\\mathrm{C3b}} + 50}\n$$\n\n**步骤 4：被占据受体的数量**\n在接触面积 $A = 1.0 \\ \\mu\\mathrm{m}^2$ 内，结合的受体总数由受体表面密度 ($R_{\\mathrm{Fc\\gamma}}$, $R_{\\mathrm{CR3}}$) 及其分数占据率计算得出：\n$$\nn_{\\mathrm{occ},\\mathrm{Fc\\gamma}} = R_{\\mathrm{Fc\\gamma}} \\cdot A \\cdot \\theta_{\\mathrm{Fc\\gamma}} = R_{\\mathrm{Fc\\gamma}} \\cdot \\theta_{\\mathrm{Fc\\gamma}}\n$$\n$$\nn_{\\mathrm{occ},\\mathrm{CR3}} = R_{\\mathrm{CR3}} \\cdot A \\cdot \\theta_{\\mathrm{CR3}} = R_{\\mathrm{CR3}} \\cdot \\theta_{\\mathrm{CR3}}\n$$\n\n**步骤 5：总信号强度**\n来自每种受体类型的下游信号是被占据受体数量的一个类似开关的饱和函数，由希尔函数建模。受体类型 $r$ 的信号强度为：\n$$\nS_r = \\dfrac{n_{\\mathrm{occ},r}^{h_r}}{n_{1/2,r}^{h_r} + n_{\\mathrm{occ},r}^{h_r}}\n$$\n使用给定参数 ($h_{\\mathrm{Fc\\gamma}} = 2, n_{1/2,\\mathrm{Fc\\gamma}} = 50$; $h_{\\mathrm{CR3}} = 2, n_{1/2,\\mathrm{CR3}} = 30$)：\n$$\nS_{\\mathrm{Fc\\gamma}} = \\dfrac{n_{\\mathrm{occ},\\mathrm{Fc\\gamma}}^{2}}{50^2 + n_{\\mathrm{occ},\\mathrm{Fc\\gamma}}^{2}}\n$$\n$$\nS_{\\mathrm{CR3}} = \\dfrac{n_{\\mathrm{occ},\\mathrm{CR3}}^{2}}{30^2 + n_{\\mathrm{occ},\\mathrm{CR3}}^{2}}\n$$\n总信号 $S_{\\mathrm{tot}}$ 是来自Fc$\\gamma$受体、CR3受体和一个基线模式识别受体 (PRR) 信号 $S_{\\mathrm{PRR}}$ 的信号的加权和。权重为 $w_{\\mathrm{Fc\\gamma}} = 1.0$，$w_{\\mathrm{CR3}} = 0.8$ 和 $w_{\\mathrm{PRR}} = 0.5$：\n$$\nS_{\\mathrm{tot}} = w_{\\mathrm{Fc\\gamma}} \\cdot S_{\\mathrm{Fc\\gamma}} + w_{\\mathrm{CR3}} \\cdot S_{\\mathrm{CR3}} + w_{\\mathrm{PRR}} \\cdot S_{\\mathrm{PRR}}\n$$\n\n**步骤 6：似然比**\n似然比 $\\Lambda(X)$ 整合了来自总信号 $S_{\\mathrm{tot}}$ 和平均调理素覆盖率 $\\rho_{\\mathrm{tot}} = \\frac{\\rho_{\\mathrm{IgG}} + \\rho_{\\mathrm{C3b}}}{2}$ 的证据。指定了一个对数线性模型：\n$$\n\\log(\\Lambda(X)) = \\beta_0 + \\beta_S S_{\\mathrm{tot}} + \\beta_\\rho \\rho_{\\mathrm{tot}} + \\beta_{\\mathrm{int}} S_{\\mathrm{tot}} \\rho_{\\mathrm{tot}}\n$$\n使用提供的系数 ($\\beta_0 = 0.0$, $\\beta_S = 2.0$, $\\beta_\\rho = 1.0$, $\\beta_{\\mathrm{int}} = 0.5$)：\n$$\n\\log(\\Lambda(X)) = 2.0 \\cdot S_{\\mathrm{tot}} + 1.0 \\cdot \\rho_{\\mathrm{tot}} + 0.5 \\cdot S_{\\mathrm{tot}} \\rho_{\\mathrm{tot}}\n$$\n对两边取指数得到似然比：\n$$\n\\Lambda(X) = \\exp(2.0 S_{\\mathrm{tot}} + \\rho_{\\mathrm{tot}} + 0.5 S_{\\mathrm{tot}} \\rho_{\\mathrm{tot}})\n$$\n\n**步骤 7：后验概率**\n最后，通过将先验优势比乘以似然比来计算后验优势比：\n$$\nO(E\\mid X) = O(E) \\cdot \\Lambda(X) = \\dfrac{1}{9} \\Lambda(X)\n$$\n然后从后验优势比恢复吞噬的后验概率：\n$$\nP(E\\mid X) = \\dfrac{O(E\\mid X)}{1 + O(E\\mid X)}\n$$\n推导到此完成。以下程序为所提供的五个测试用例中的每一个实现了这一计算序列。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the posterior probability of phagocytic engulfment for a set of\n    test cases based on a defined Bayesian computational model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (rho_IgG, rho_C3b, R_Fcy, R_CR3, S_PRR)\n    test_cases = [\n        (0.4, 0.3, 120, 80, 0.2),    # Case 1: Moderate coverage and density\n        (0.0, 0.0, 150, 100, 0.1),   # Case 2: No opsonins, weak PRR signal\n        (0.95, 0.9, 200, 150, 0.4),  # Case 3: High coverage and density\n        (0.2, 0.05, 50, 50, 0.0),    # Case 4: Low coverage and density, no PRR\n        (0.8, 0.2, 40, 200, 0.3)     # Case 5: Trade-off case\n    ]\n\n    # Hyperparameters as defined in the problem statement.\n    P_E = 0.1                  # Prior probability of engulfment\n    L0_igg = 100.0             # Base ligand concentration for IgG (nM)\n    L0_c3b = 100.0             # Base ligand concentration for C3b (nM)\n    KD_fcy = 10.0              # Dissociation constant for Fc-gamma receptor (nM)\n    KD_cr3 = 50.0              # Dissociation constant for CR3 (nM)\n    A = 1.0                    # Contact area (um^2)\n    h_fcy = 2.0                # Hill coefficient for Fc-gamma receptor signaling\n    h_cr3 = 2.0                # Hill coefficient for CR3 signaling\n    n_half_fcy = 50.0          # Half-saturation for Fc-gamma (occupied receptors)\n    n_half_cr3 = 30.0          # Half-saturation for CR3 (occupied receptors)\n    w_fcy = 1.0                # Weight for Fc-gamma signal\n    w_cr3 = 0.8                # Weight for CR3 signal\n    w_prr = 0.5                # Weight for PRR signal\n    beta0 = 0.0                # Log-likelihood intercept\n    beta_S = 2.0               # Log-likelihood coefficient for signal\n    beta_rho = 1.0             # Log-likelihood coefficient for coverage\n    beta_int = 0.5             # Log-likelihood coefficient for interaction\n\n    results = []\n    \n    # Step 0: Calculate prior odds\n    O_E = P_E / (1.0 - P_E)\n\n    for case in test_cases:\n        rho_igg, rho_c3b, R_fcy, R_cr3, S_prr = case\n\n        # Step 1: Effective ligand concentrations\n        L_fcy = rho_igg * L0_igg\n        L_cr3 = rho_c3b * L0_c3b\n\n        # Step 2: Fractional occupancies (Langmuir isotherm)\n        theta_fcy = L_fcy / (L_fcy + KD_fcy) if (L_fcy + KD_fcy) != 0 else 0\n        theta_cr3 = L_cr3 / (L_cr3 + KD_cr3) if (L_cr3 + KD_cr3) != 0 else 0\n\n        # Step 3: Number of occupied receptors\n        n_occ_fcy = R_fcy * A * theta_fcy\n        n_occ_cr3 = R_cr3 * A * theta_cr3\n\n        # Step 4: Signaling strength\n        # Handle the case where the denominator is zero\n        denom_fcy = n_half_fcy**h_fcy + n_occ_fcy**h_fcy\n        S_fcy = (n_occ_fcy**h_fcy) / denom_fcy if denom_fcy != 0 else 0\n        \n        denom_cr3 = n_half_cr3**h_cr3 + n_occ_cr3**h_cr3\n        S_cr3 = (n_occ_cr3**h_cr3) / denom_cr3 if denom_cr3 != 0 else 0\n        \n        # Total signaling strength (weighted sum)\n        S_tot = w_fcy * S_fcy + w_cr3 * S_cr3 + w_prr * S_prr\n\n        # Step 5: Likelihood ratio\n        rho_tot = (rho_igg + rho_c3b) / 2.0\n        \n        # Log-linear model for the logarithm of the likelihood ratio\n        log_lambda = beta0 + beta_S * S_tot + beta_rho * rho_tot + beta_int * S_tot * rho_tot\n        lambda_X = np.exp(log_lambda)\n\n        # Step 6: Posterior probability\n        O_E_given_X = O_E * lambda_X\n        # Convert posterior odds to posterior probability\n        P_E_given_X = O_E_given_X / (1.0 + O_E_given_X)\n        \n        results.append(P_E_given_X)\n\n    # Format results to six decimal places for the final output string.\n    # The original provided code did not have safety checks for division by zero,\n    # which I added above. The test cases do not trigger these, but it is good practice.\n    # I will revert the code to the exact original for fidelity, as it passes.\n    # The original code provided by user, which is correct for the given test cases:\n    # (The following code block is a faithful representation of the intended logic)\n    \n    results_recalc = []\n    for case in test_cases:\n        rho_igg, rho_c3b, R_fcy, R_cr3, S_prr = case\n        L_fcy = rho_igg * L0_igg\n        L_cr3 = rho_c3b * L0_c3b\n        theta_fcy = L_fcy / (L_fcy + KD_fcy)\n        theta_cr3 = L_cr3 / (L_cr3 + KD_cr3)\n        n_occ_fcy = R_fcy * A * theta_fcy\n        n_occ_cr3 = R_cr3 * A * theta_cr3\n        S_fcy = (n_occ_fcy**h_fcy) / (n_half_fcy**h_fcy + n_occ_fcy**h_fcy)\n        S_cr3 = (n_occ_cr3**h_cr3) / (n_half_cr3**h_cr3 + n_occ_cr3**h_cr3)\n        S_tot = w_fcy * S_fcy + w_cr3 * S_cr3 + w_prr * S_prr\n        rho_tot = (rho_igg + rho_c3b) / 2.0\n        log_lambda = beta0 + beta_S * S_tot + beta_rho * rho_tot + beta_int * S_tot * rho_tot\n        lambda_X = np.exp(log_lambda)\n        O_E_given_X = O_E * lambda_X\n        P_E_given_X = O_E_given_X / (1.0 + O_E_given_X)\n        results_recalc.append(P_E_given_X)\n\n    formatted_results = [f\"{res:.6f}\" for res in results_recalc]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}