{
    "hands_on_practices": [
        {
            "introduction": "Rejection sampling can be understood most intuitively in a discrete setting. This first practice problem challenges you to simulate a biased three-sided die using a standard fair six-sided die . This exercise demonstrates how to systematically correct a simple, uniform proposal distribution to match a desired target distribution, illustrating the core logic of acceptance and rejection. By working through this, you'll gain a foundational grasp of how to set up a valid rejection sampler and optimize its efficiency.",
            "id": "1387122",
            "problem": "A computer simulation requires generating random integers from the set $\\{1, 2, 3\\}$ according to the target probability distribution $P$, where $P(X=1) = 0.5$, $P(X=2) = 0.3$, and $P(X=3) = 0.2$. The only available random number generator is a function that simulates a fair six-sided die, returning an integer from $\\{1, 2, 3, 4, 5, 6\\}$ with uniform probability.\n\nAn engineer devises the following two-step procedure to generate a number from the target distribution $P$:\n**Step 1 (Proposal):** Generate a number $y$ using the fair six-sided die simulator.\n**Step 2 (Acceptance/Rejection):**\n- If $y=1$, accept this proposal with probability $c_1$.\n- If $y=2$, accept this proposal with probability $c_2$.\n- If $y=3$, accept this proposal with probability $c_3$.\n- If $y \\in \\{4, 5, 6\\}$, always reject this proposal (acceptance probability is 0).\nIf the proposal is accepted, the procedure terminates and returns the value of $y$. If it is rejected, the procedure starts over from Step 1.\n\nThe probabilities $c_1, c_2, c_3$ must be chosen to satisfy two conditions:\n1. The distribution of the accepted numbers must match the target distribution $P$.\n2. The overall probability of accepting a proposal in a single run of the two-step procedure must be maximized.\n\nWhat is the overall probability of accepting a proposal in a single run of this optimally-configured procedure? Express your answer as a fraction in simplest form.",
            "solution": "Let the proposal distribution be $q(y)$ with $q(i)=\\frac{1}{6}$ for $i\\in\\{1,2,3,4,5,6\\}$. Let $c_{i}$ be the acceptance probability when $y=i$ for $i\\in\\{1,2,3\\}$ and $c_{i}=0$ for $i\\in\\{4,5,6\\}$. The overall probability of accepting in a single run is\n$$\nA=\\sum_{i=1}^{3} q(i)c_{i}=\\frac{1}{6}\\left(c_{1}+c_{2}+c_{3}\\right).\n$$\nCondition 1 requires that the distribution of accepted values matches the target $P$, i.e., for $i\\in\\{1,2,3\\}$,\n$$\nP_{i}=\\frac{q(i)c_{i}}{A} \\quad\\Longrightarrow\\quad c_{i}=\\frac{A P_{i}}{q(i)}.\n$$\nSince acceptance probabilities must satisfy $0\\leq c_{i}\\leq 1$, we obtain the constraints\n$$\n\\frac{A P_{i}}{q(i)}\\leq 1 \\quad\\Longrightarrow\\quad A\\leq \\frac{q(i)}{P_{i}} \\quad (i=1,2,3).\n$$\nTherefore the maximal feasible $A$ is\n$$\nA_{\\max}=\\min_{i\\in\\{1,2,3\\}} \\frac{q(i)}{P_{i}}.\n$$\nWith $q(i)=\\frac{1}{6}$ and $P_{1}=\\frac{1}{2}$, $P_{2}=\\frac{3}{10}$, $P_{3}=\\frac{1}{5}$,\n$$\n\\frac{q(1)}{P_{1}}=\\frac{1/6}{1/2}=\\frac{1}{3},\\quad \\frac{q(2)}{P_{2}}=\\frac{1/6}{3/10}=\\frac{5}{9},\\quad \\frac{q(3)}{P_{3}}=\\frac{1/6}{1/5}=\\frac{5}{6}.\n$$\nHence\n$$\nA_{\\max}=\\min\\left\\{\\frac{1}{3},\\frac{5}{9},\\frac{5}{6}\\right\\}=\\frac{1}{3}.\n$$\nFor completeness, the corresponding acceptance probabilities are\n$$\nc_{i}=\\frac{A_{\\max} P_{i}}{q(i)}=6 A_{\\max} P_{i}=2 P_{i},\n$$\ngiving $c_{1}=1$, $c_{2}=\\frac{3}{5}$, $c_{3}=\\frac{2}{5}$, all within $[0,1]$. Therefore, the overall acceptance probability per single run in the optimal configuration is $\\frac{1}{3}$.",
            "answer": "$$\\boxed{\\frac{1}{3}}$$"
        },
        {
            "introduction": "Building on the discrete case, we now turn to continuous distributions, which are common in scientific modeling. This exercise asks you to generate samples from a Beta distribution using a simple Uniform proposal distribution . The key skill you will practice is determining the optimal scaling constant $M$, a crucial step that ensures the validity of the sampler and governs its efficiency. This problem solidifies the core mechanics of rejection sampling for continuous variables and highlights the direct link between $M$ and the sampler's acceptance rate.",
            "id": "1387131",
            "problem": "A data scientist is implementing a rejection sampling algorithm to generate random numbers that follow a specific target distribution. The target distribution is a Beta distribution with parameters $\\alpha = 2$ and $\\beta = 2$. The probability density function (PDF) of this target distribution, denoted by $f(x)$, is given by:\n$$f(x) = 6x(1-x) \\quad \\text{for } x \\in [0, 1]$$\nand $f(x) = 0$ otherwise.\n\nFor the proposal distribution, the data scientist uses the standard uniform distribution, U(0, 1). The PDF of this proposal distribution, denoted by $g(x)$, is:\n$$g(x) = 1 \\quad \\text{for } x \\in [0, 1]$$\nand $g(x) = 0$ otherwise.\n\nThe rejection sampling method requires finding a constant $M$ such that the inequality $f(x) \\le M g(x)$ holds for all possible values of $x$. To maximize the efficiency of the sampling process, the smallest possible value of $M$ is chosen. The algorithm then generates a sample $Y$ from the proposal distribution $g(x)$ and accepts it with probability $\\frac{f(Y)}{M g(Y)}$.\n\nCalculate the overall theoretical probability that a sample drawn from the proposal distribution is accepted. Express your answer as an exact fraction.",
            "solution": "We need the smallest constant $M$ such that $f(x) \\le M g(x)$ for all $x$. Since $g(x)=1$ for $x \\in [0,1]$ and $g(x)=0$ otherwise, the condition reduces on $[0,1]$ to $f(x) \\le M$. Therefore the minimal admissible $M$ is the supremum of $f(x)$ on $[0,1]$.\n\nCompute the maximum of $f(x)=6x(1-x)=6(x - x^{2})$ on $[0,1]$. Differentiate:\n$$\nf'(x)=6(1-2x), \\quad f''(x)=-12.\n$$\nSetting $f'(x)=0$ gives $x=\\frac{1}{2}$. Since $f''(x)<0$, this is a maximum. Evaluate\n$$\nM=\\max_{x \\in [0,1]} f(x)=f\\!\\left(\\tfrac{1}{2}\\right)=6 \\cdot \\tfrac{1}{2} \\cdot \\left(1-\\tfrac{1}{2}\\right)=\\frac{3}{2}.\n$$\n\nGiven $Y \\sim g$, the acceptance probability conditional on $Y=y$ is $\\frac{f(y)}{M g(y)}$. The overall acceptance probability is the expectation under $g$:\n$$\n\\mathbb{P}(\\text{accept})=\\mathbb{E}_{g}\\!\\left[\\frac{f(Y)}{M g(Y)}\\right]=\\int_{0}^{1} \\frac{f(x)}{M g(x)} g(x) \\, dx=\\frac{1}{M} \\int_{0}^{1} f(x) \\, dx.\n$$\nSince $f$ is a probability density on $[0,1]$, $\\int_{0}^{1} f(x) \\, dx=1$. For completeness:\n$$\n\\int_{0}^{1} 6x(1-x)\\,dx=6 \\int_{0}^{1} \\left(x - x^{2}\\right) dx=6 \\left(\\frac{1}{2}-\\frac{1}{3}\\right)=1.\n$$\nTherefore,\n$$\n\\mathbb{P}(\\text{accept})=\\frac{1}{M}=\\frac{1}{\\frac{3}{2}}=\\frac{2}{3}.\n$$",
            "answer": "$$\\boxed{\\frac{2}{3}}$$"
        },
        {
            "introduction": "A truly effective rejection sampler relies on a proposal distribution that closely mimics the target distribution. This advanced problem delves into the critical task of optimizing the proposal distribution itself to maximize efficiency . You will determine the optimal scale parameter for a Laplace proposal distribution when targeting a Gaussian distribution, a common scenario in statistical modeling. This exercise will challenge you to use calculus to minimize the rejection constant $M$, providing insight into the design principles of high-performance sampling algorithms.",
            "id": "1387078",
            "problem": "An engineer is designing a simulation to generate random numbers from a specific target distribution for a physics model. The target Probability Density Function (PDF), denoted as $f(x)$, is determined from a Bayesian analysis. Specifically, $f(x)$ is the posterior distribution for a parameter $x$ given a series of experimental measurements. The prior distribution for $x$ is assumed to be uniform over the real line. The measurements, $d_1, d_2, \\dots, d_n$, are drawn independently from a Gaussian distribution with a mean of $x$ and a known variance of $\\tau^2$. After collecting the data, it is found that $n=5$, the variance is $\\tau^2 = 2$, and the sum of the measurements is exactly zero, i.e., $\\sum_{i=1}^{n} d_i = 0$.\n\nFor the simulation, the engineer uses rejection sampling. The proposal distribution is a Laplace distribution, which can be generated efficiently. The PDF of this proposal distribution is given by $g(x) = \\frac{1}{2b} \\exp\\left(-\\frac{|x|}{b}\\right)$, where $b>0$ is a tunable scale parameter.\n\nThe efficiency of the rejection sampling method is maximized when the acceptance rate is maximized. The acceptance rate is inversely proportional to the constant $M = \\sup_{x \\in \\mathbb{R}} \\frac{f(x)}{g(x)}$. To optimize the simulation, the engineer needs to find the value of the parameter $b$ that minimizes this constant $M$.\n\nDetermine the exact optimal value of $b$ that maximizes the efficiency of the simulation. Express your final answer as an analytic expression.",
            "solution": "The prior for $x$ is uniform on $\\mathbb{R}$, which is an improper prior. With known variance $\\tau^{2}$ and $n$ independent Gaussian measurements $d_{i} \\sim \\mathcal{N}(x,\\tau^{2})$, the likelihood is\n$$\nL(x) \\propto \\left(\\frac{1}{\\sqrt{2 \\pi \\tau^{2}}}\\right)^{n} \\exp\\left(-\\frac{1}{2 \\tau^{2}} \\sum_{i=1}^{n} (d_{i}-x)^{2}\\right).\n$$\nCompleting the square,\n$$\n\\sum_{i=1}^{n} (d_{i}-x)^{2} = n(x-\\bar{d})^{2} + \\sum_{i=1}^{n} (d_{i}-\\bar{d})^{2},\n$$\nwhere $\\bar{d} = \\frac{1}{n} \\sum_{i=1}^{n} d_{i}$. With the uniform prior, the posterior is proportional to the likelihood in $x$, hence\n$$\nf(x) = \\sqrt{\\frac{n}{2 \\pi \\tau^{2}}}\\,\\exp\\left(-\\frac{n(x-\\bar{d})^{2}}{2 \\tau^{2}}\\right).\n$$\nGiven $\\sum_{i=1}^{n} d_{i} = 0$ and $n=5$, we have $\\bar{d}=0$, so\n$$\nf(x) = \\sqrt{\\frac{n}{2 \\pi \\tau^{2}}}\\,\\exp\\left(-\\frac{n x^{2}}{2 \\tau^{2}}\\right).\n$$\n\nThe proposal density is Laplace with scale $b>0$:\n$$\ng(x) = \\frac{1}{2 b}\\,\\exp\\left(-\\frac{|x|}{b}\\right).\n$$\nThe rejection constant is\n$$\nM(b) = \\sup_{x \\in \\mathbb{R}} \\frac{f(x)}{g(x)} = 2 b \\sqrt{\\frac{n}{2 \\pi \\tau^{2}}}\\, \\sup_{x \\in \\mathbb{R}} \\exp\\left(-\\frac{n x^{2}}{2 \\tau^{2}} + \\frac{|x|}{b}\\right).\n$$\nDefine\n$$\n\\phi(x) = -\\frac{n x^{2}}{2 \\tau^{2}} + \\frac{|x|}{b}.\n$$\nBy symmetry, maximize over $x \\geq 0$. Then\n$$\n\\phi(x) = -a x^{2} + c x,\\quad a = \\frac{n}{2 \\tau^{2}},\\quad c = \\frac{1}{b}.\n$$\nThis concave quadratic attains its maximum at\n$$\nx^{\\star} = \\frac{c}{2 a} = \\frac{\\tau^{2}}{n b},\n$$\nwith maximum value\n$$\n\\phi(x^{\\star}) = -a \\left(\\frac{\\tau^{2}}{n b}\\right)^{2} + c \\left(\\frac{\\tau^{2}}{n b}\\right) = -\\frac{\\tau^{2}}{2 n b^{2}} + \\frac{\\tau^{2}}{n b^{2}} = \\frac{\\tau^{2}}{2 n b^{2}}.\n$$\nTherefore,\n$$\nM(b) = 2 b \\sqrt{\\frac{n}{2 \\pi \\tau^{2}}}\\, \\exp\\left(\\frac{\\tau^{2}}{2 n b^{2}}\\right).\n$$\nTo minimize $M(b)$ over $b>0$, minimize\n$$\nm(b) = b \\exp\\left(\\frac{\\tau^{2}}{2 n b^{2}}\\right).\n$$\nConsider $\\ln m(b) = \\ln b + \\frac{\\tau^{2}}{2 n b^{2}}$. Differentiate and set to zero:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d} b} \\ln m(b) = \\frac{1}{b} - \\frac{\\tau^{2}}{n b^{3}} = 0 \\quad \\Longrightarrow \\quad b^{2} = \\frac{\\tau^{2}}{n}.\n$$\nThis critical point is a global minimizer because $m(b) \\to \\infty$ as $b \\to 0^{+}$ and as $b \\to \\infty$. Hence the optimal scale is\n$$\nb^{\\star} = \\frac{\\tau}{\\sqrt{n}}.\n$$\nSubstituting the given values $\\tau^{2} = 2$ and $n=5$ gives\n$$\nb^{\\star} = \\sqrt{\\frac{2}{5}}.\n$$",
            "answer": "$$\\boxed{\\sqrt{\\frac{2}{5}}}$$"
        }
    ]
}