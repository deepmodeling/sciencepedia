{"hands_on_practices": [{"introduction": "密度泛函理论（DFT）建立在坚实的理论基础之上。本练习旨在探讨作为整个理论基石的第一条Hohenberg-Kohn定理。该定理建立了电子密度与外部势之间的唯一映射关系，从而使密度成为描述体系性质的核心变量，这项练习将帮助你通过一个思想实验来理解这一定理的深刻内涵。[@problem_id:1768588]", "problem": "在计算材料科学领域，密度泛函理论（DFT）是用于研究材料电子结构的一种强大方法。DFT 的一个基石是第一 Hohenberg-Kohn 定理，该定理确立了多电子系统的基态电子密度与其所受外部势之间的基本关系。\n\n设想两种不同的假想晶体材料，材料 Alpha 和材料 Beta。材料 Alpha 由元素 X 的原子组成，材料 Beta 由元素 Y 的原子组成。它们表现出不同的晶体结构。通过先进的实验技术，研究人员确定了两种材料的基态电子密度，分别表示为 $n_{\\text{Alpha}}(\\mathbf{r})$ 和 $n_{\\text{Beta}}(\\mathbf{r})$。令人惊讶的是，他们发现这两个函数完全相同，即对于所有位置 $\\mathbf{r}$，都有 $n_{\\text{Alpha}}(\\mathbf{r}) = n_{\\text{Beta}}(\\mathbf{r})$。\n\n令 $V_{\\text{Alpha}}(\\mathbf{r})$ 和 $V_{\\text{Beta}}(\\mathbf{r})$ 分别表示材料 Alpha 和材料 Beta 中电子所经历的总周期性外部势，该势来自于它们的原子核。基于基态电子密度相同的假设，关于 $V_{\\text{Alpha}}(\\mathbf{r})$ 和 $V_{\\text{Beta}}(\\mathbf{r})$ 之间的关系，可以得出什么严格的结论？\n\nA. 势必须完全不同，因为材料和晶体结构不同。\n\nB. 势必须相同，$V_{\\text{Alpha}}(\\mathbf{r}) = V_{\\text{Beta}}(\\mathbf{r})$。\n\nC. 势必须仅相差一个常数值，即 $V_{\\text{Alpha}}(\\mathbf{r}) = V_{\\text{Beta}}(\\mathbf{r}) + C$，其中 $C$ 是一个常数。\n\nD. 一个势必须是另一个势的缩放版本，即 $V_{\\text{Alpha}}(\\mathbf{r}) = c V_{\\text{Beta}}(\\mathbf{r})$，其中 $c$ 是一个非单位缩放常数。\n\nE. 这种观测在物理上是不可能的，并且与 Pauli 不相容原理相矛盾。", "solution": "我们考虑两个多电子系统，它们具有相同的电子-电子相互作用和动能算符，但由于不同的原子核排列而具有不同的外部势。令哈密顿量为\n$$\n\\hat{H}_{\\text{Alpha}}=\\hat{T}+\\hat{W}+\\hat{V}_{\\text{Alpha}},\\qquad \\hat{H}_{\\text{Beta}}=\\hat{T}+\\hat{W}+\\hat{V}_{\\text{Beta}},\n$$\n其外部势算符为\n$$\n\\hat{V}_{\\text{Alpha}}=\\int V_{\\text{Alpha}}(\\mathbf{r})\\,\\hat{n}(\\mathbf{r})\\,d\\mathbf{r},\\qquad \\hat{V}_{\\text{Beta}}=\\int V_{\\text{Beta}}(\\mathbf{r})\\,\\hat{n}(\\mathbf{r})\\,d\\mathbf{r},\n$$\n其中 $\\hat{n}(\\mathbf{r})$ 是粒子数密度算符，$V_{\\text{Alpha}}(\\mathbf{r})$ 和 $V_{\\text{Beta}}(\\mathbf{r})$ 是相应的标量外部势。令归一化的基态分别为 $|\\Psi_{\\text{Alpha}}\\rangle$ 和 $|\\Psi_{\\text{Beta}}\\rangle$，其基态能量分别为 $E_{\\text{Alpha}}$ 和 $E_{\\text{Beta}}$，基态密度分别为 $n_{\\text{Alpha}}(\\mathbf{r})$ 和 $n_{\\text{Beta}}(\\mathbf{r})$。\n\n根据假设，测得的基态密度处处相等：\n$$\nn_{\\text{Alpha}}(\\mathbf{r})=n_{\\text{Beta}}(\\mathbf{r})\\equiv n(\\mathbf{r}).\n$$\n我们现在引用第一 Hohenberg-Kohn 定理：对于给定的电子-电子相互作用和固定的粒子数，外部势是基态密度的一个唯一泛函，最多相差一个相加常数。一个标准的证明是使用 Rayleigh-Ritz 变分原理进行反证。\n\n为了进行反证，假设 $V_{\\text{Alpha}}(\\mathbf{r})$ 和 $V_{\\text{Beta}}(\\mathbf{r})$ 产生相同的非简并基态密度 $n(\\mathbf{r})$，但它们的差异不止一个相加常数。这意味着它们各自的哈密顿量 $\\hat{H}_{\\text{Alpha}}$ 和 $\\hat{H}_{\\text{Beta}}$ 是不同的，因此它们对应的基态波函数 $|\\Psi_{\\text{Alpha}}\\rangle$ 和 $|\\Psi_{\\text{Beta}}\\rangle$ 也必定不同。我们将 $|\\Psi_{\\text{Beta}}\\rangle$ 作为哈密顿量 $\\hat{H}_{\\text{Alpha}}$ 的试探波函数。根据变分原理，我们有：\n$$\nE_{\\text{Alpha}}  \\langle\\Psi_{\\text{Beta}}| \\hat{H}_{\\text{Alpha}}|\\Psi_{\\text{Beta}}\\rangle = \\langle\\Psi_{\\text{Beta}}| \\hat{H}_{\\text{Beta}} + \\hat{V}_{\\text{Alpha}} - \\hat{V}_{\\text{Beta}}|\\Psi_{\\text{Beta}}\\rangle = E_{\\text{Beta}} + \\int [V_{\\text{Alpha}}(\\mathbf{r}) - V_{\\text{Beta}}(\\mathbf{r})] n(\\mathbf{r}) d\\mathbf{r}\n$$\n同样地，我们将 $|\\Psi_{\\text{Alpha}}\\rangle$ 作为哈密顿量 $\\hat{H}_{\\text{Beta}}$ 的试探波函数：\n$$\nE_{\\text{Beta}}  \\langle\\Psi_{\\text{Alpha}}| \\hat{H}_{\\text{Beta}}|\\Psi_{\\text{Alpha}}\\rangle = \\langle\\Psi_{\\text{Alpha}}| \\hat{H}_{\\text{Alpha}} + \\hat{V}_{\\text{Beta}} - \\hat{V}_{\\text{Alpha}}|\\Psi_{\\text{Alpha}}\\rangle = E_{\\text{Alpha}} + \\int [V_{\\text{Beta}}(\\mathbf{r}) - V_{\\text{Alpha}}(\\mathbf{r})] n(\\mathbf{r}) d\\mathbf{r}\n$$\n将上述两个不等式相加，我们得到：$E_{\\text{Alpha}} + E_{\\text{Beta}}  E_{\\text{Beta}} + E_{\\text{Alpha}}$，这是一个明显的矛盾。因此，我们的初始假设是错误的。对于一个非简并基态，不可能有两个相差超过一个常数的不同外部势对应同一个基态电子密度。因此，势 $V_{\\text{Alpha}}(\\mathbf{r})$ 和 $V_{\\text{Beta}}(\\mathbf{r})$ 必须仅相差一个常数。", "answer": "$$\\boxed{C}$$", "id": "1768588"}, {"introduction": "从“为什么”有效（Hohenberg-Kohn定理）过渡到“如何”计算（Kohn-Sham方程），本练习通过分析最简单的氢原子体系来剖析Kohn-Sham能量泛函的各个组成部分。理解这些能量项（如交换能 $E_x[n]$ 和相关能 $E_c[n]$）的物理意义，对于领会真实DFT计算中各种近似方法的精髓至关重要。[@problem_id:1768600]", "problem": "在密度泛函理论 (DFT) 的科恩-尚姆 (Kohn-Sham) 表述中，具有电子密度 $n(\\mathbf{r})$ 的体系的总电子能量表示为密度的泛函：\n$$E_{KS}[n] = T_s[n] + E_{\\text{ext}}[n] + E_H[n] + E_{xc}[n]$$\n该泛函中的各项定义如下：\n- $T_s[n]$：一个虚拟的无相互作用电子体系的动能，该体系的电子密度 $n(\\mathbf{r})$ 与真实的相互作用体系相同。\n- $E_{\\text{ext}}[n]$：电子与外势相互作用产生的势能，该外势通常是来自原子核的静电势。\n- $E_H[n]$：哈特里 (Hartree) 能量，即电子密度的经典静电自排斥能。\n- $E_{xc}[n]$：交换相关能，此项包含了其他各项中未包含的所有量子力学多体效应。该项通常分为交换部分和相关部分：$E_{xc}[n] = E_x[n] + E_c[n]$。\n\n考虑一个处于基态的孤立氢原子。对于这个特定体系，下列哪个能量项恒等于零？\n\nA. $T_s[n]$ (无相互作用电子的动能)\n\nB. $E_H[n]$ (哈特里能量)\n\nC. $E_x[n]$ (交换能)\n\nD. $E_c[n]$ (相关能)\n\nE. $E_{\\text{ext}}[n]$ (电子-原子核相互作用能)", "solution": "我们从科恩-尚姆 (Kohn–Sham) 能量泛函出发\n$$\nE_{KS}[n] = T_{s}[n] + E_{\\text{ext}}[n] + E_{H}[n] + E_{xc}[n], \\quad E_{xc}[n] = E_{x}[n] + E_{c}[n].\n$$\n对于一个孤立的氢原子，该体系恰好有一个电子。我们逐一考察各项。\n\n无相互作用动能为\n$$\nT_{s}[n] = \\sum_{i} f_{i} \\int \\varphi_{i}^{*}(\\mathbf{r})\\left(-\\frac{1}{2}\\nabla^{2}\\right)\\varphi_{i}(\\mathbf{r})\\,d\\mathbf{r},\n$$\n只有一个占据轨道。在氢原子基态下，此项不为零。\n\n外势能为\n$$\nE_{\\text{ext}}[n] = \\int n(\\mathbf{r})\\,v_{\\text{ext}}(\\mathbf{r})\\,d\\mathbf{r},\n$$\n其中对于电荷为 $Z=1$ 的氢原子核，在原子单位制下，\n$$\nv_{\\text{ext}}(\\mathbf{r}) = -\\frac{1}{|\\mathbf{r}|},\n$$\n因此 $E_{\\text{ext}}[n]$ 不为零且为负值。\n\n哈特里 (Hartree) 能量为\n$$\nE_{H}[n] = \\frac{1}{2}\\int\\!\\!\\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'.\n$$\n对于任意归一化的单电子密度 $n(\\mathbf{r})\\ge 0$，这个二重积分严格为正，因此 $E_{H}[n]\\neq 0$。从物理上看，这是虚假的经典自相互作用。\n\n在科恩-尚姆 (Kohn–Sham) DFT 中，一个关键的精确恒等式将交换相关能与精确的相互作用量联系起来：\n$$\nE_{xc}[n] = \\bigl(T - T_{s}\\bigr) + \\bigl(V_{ee} - E_{H}[n]\\bigr),\n$$\n其中 $T$ 是相互作用体系的精确动能，$V_{ee}$ 是精确的电子-电子相互作用能。对于单电子体系，不存在电子-电子相互作用，因此\n$$\nV_{ee} = 0,\n$$\n并且相互作用体系与无相互作用的科恩-尚姆 (Kohn–Sham) 体系是相同的，因此\n$$\nT = T_{s}.\n$$\n所以，\n$$\nE_{xc}[n] = -E_{H}[n].\n$$\n将 $E_{xc}[n] = E_{x}[n] + E_{c}[n]$ 分解，单电子密度的精确交换能抵消了哈特里自相互作用，\n$$\nE_{x}[n] = -E_{H}[n],\n$$\n从而\n$$\nE_{c}[n] = 0.\n$$\n因此，对于氢原子，$T_{s}[n]\\neq 0$，$E_{\\text{ext}}[n]\\neq 0$，$E_{H}[n]\\neq 0$，$E_{x}[n]\\neq 0$，唯一恒等于零的项是相关能 $E_{c}[n]$。\n\n因此，正确选项是 D。", "answer": "$$\\boxed{D}$$", "id": "1768600"}, {"introduction": "在理解了Kohn-Sham方程的构成之后，下一步自然是了解如何求解它们。本练习展示了自洽场（SCF）迭代过程，这是每个DFT计算程序核心的计算引擎。通过厘清这个计算流程，我们可以揭开DFT计算“黑箱”的神秘面纱，理解其如何系统地逼近并最终获得基态解。[@problem_id:1768566]", "problem": "在计算材料科学领域，Kohn-Sham密度泛函理论（DFT）是确定材料电子结构的一种强大方法。DFT计算的一个核心部分是一个称为自洽场（SCF）循环的迭代过程，其目的是找到基态电子密度。\n\n这个迭代循环包含一系列特定的计算步骤，这些步骤会重复执行，直到满足收敛标准。下面是单次迭代中执行的三个核心任务，按字母顺序列出：\n\n(A) 通过对占据的单粒子轨道的平方模求和，计算输出电子密度 $n_{\\text{out}}(\\mathbf{r})$。\n(B) 构建有效Kohn-Sham势 $v_{\\text{eff}}(\\mathbf{r})$，该势是当前或上一次迭代的输入电子密度 $n_{\\text{in}}(\\mathbf{r})$ 的函数。\n(C) 针对当前的有效势求解单粒子Kohn-Sham方程，以确定一组新的单粒子轨道 $\\{\\psi_j(\\mathbf{r})\\}$。\n\n在一次迭代开始时，给定输入密度 $n_{\\text{in}}(\\mathbf{r})$，请确定这三个任务的正确时间顺序，以在该次迭代内产生输出密度 $n_{\\text{out}}(\\mathbf{r})$。请从以下选项中选择正确的顺序。\n\nA. (A) $\\rightarrow$ (B) $\\rightarrow$ (C)\n\nB. (B) $\\rightarrow$ (A) $\\rightarrow$ (C)\n\nC. (C) $\\rightarrow$ (A) $\\rightarrow$ (B)\n\nD. (B) $\\rightarrow$ (C) $\\rightarrow$ (A)\n\nE. (A) $\\rightarrow$ (C) $\\rightarrow$ (B)\n\nF. (C) $\\rightarrow$ (B) $\\rightarrow$ (A)", "solution": "在密度泛函理论（DFT）中，自洽场（SCF）循环的目标是找到一个“自洽”的基态电子密度 $n(\\mathbf{r})$。这意味着，如果我们将此密度用作计算的输入，计算所产生的输出密度将与输入密度相同。该过程是迭代的，从一个初始猜测开始，在每一步中不断优化密度，直到满足此条件。让我们分析这三个任务之间的逻辑依赖关系，以确定它们的正确顺序。\n\n迭代循环从对电子密度的一个猜测开始，我们称之为输入密度 $n_{\\text{in}}(\\mathbf{r})$。\n\n步骤1：循环中的第一个任务必须是利用此输入密度 $n_{\\text{in}}(\\mathbf{r})$ 来构建下一步所需的物理量。Kohn-Sham形式理论指出，有效势 $v_{\\text{eff}}(\\mathbf{r})$ 是电子密度的泛函。具体而言，$v_{\\text{eff}}[n](\\mathbf{r}) = v_{\\text{ext}}(\\mathbf{r}) + v_{\\text{H}}[n](\\mathbf{r}) + v_{\\text{xc}}[n](\\mathbf{r})$，其中Hartree势 $v_{\\text{H}}$ 和交换关联势 $v_{\\text{xc}}$ 都依赖于密度 $n(\\mathbf{r})$。因此，第一个逻辑步骤是使用 $n_{\\text{in}}(\\mathbf{r})$ 来计算 $v_{\\text{eff}}(\\mathbf{r})$。这对应于任务（B）。\n\n步骤2：一旦知道了有效势 $v_{\\text{eff}}(\\mathbf{r})$，就可以用它来定义单粒子Kohn-Sham哈密顿量，$\\hat{H}_{\\text{KS}} = -\\frac{1}{2}\\nabla^2 + v_{\\text{eff}}(\\mathbf{r})$。下一步是求解该哈密顿量的本征值问题，即Kohn-Sham方程组：$\\hat{H}_{\\text{KS}} \\psi_j(\\mathbf{r}) = \\epsilon_j \\psi_j(\\mathbf{r})$。求解这些方程可以得到一组单粒子轨道 $\\{\\psi_j(\\mathbf{r})\\}$ 及其对应的能量 $\\{\\epsilon_j\\}$。这对应于任务（C）。任务（C）必须在任务（B）之后，因为它需要（B）中计算出的势。\n\n步骤3：在求解Kohn-Sham方程之后，我们就有了轨道 $\\{\\psi_j(\\mathbf{r})\\}$。DFT的基本原理是电子密度可以由这些轨道构建。对于一个有 $N$ 个电子的体系，密度是通过对 $N$ 个能量最低的（占据的）轨道的概率密度求和来计算的。这就得到了输出电子密度，$n_{\\text{out}}(\\mathbf{r}) = \\sum_{j=1}^{N} |\\psi_j(\\mathbf{r})|^2$。这对应于任务（A）。任务（A）必须在任务（C）之后，因为它需要（C）中计算出的轨道。\n\n总结一次迭代内的流程：\n1.  从 $n_{\\text{in}}(\\mathbf{r})$ 开始。\n2.  执行任务（B）：使用 $n_{\\text{in}}(\\mathbf{r})$ 构建 $v_{\\text{eff}}(\\mathbf{r})$。\n3.  执行任务（C）：使用 $v_{\\text{eff}}(\\mathbf{r})$ 求解轨道 $\\{\\psi_j(\\mathbf{r})\\}$。\n4.  执行任务（A）：使用轨道 $\\{\\psi_j(\\mathbf{r})\\}$ 计算输出密度 $n_{\\text{out}}(\\mathbf{r})$。\n\n因此，任务的正确顺序是（B）$\\rightarrow$（C）$\\rightarrow$（A）。在此序列之后，SCF过程会将 $n_{\\text{out}}(\\mathbf{r})$ 与 $n_{\\text{in}}(\\mathbf{r})$ 进行比较，以检查是否收敛。如果未收敛，则会生成一个新的 $n_{\\text{in}}(\\mathbf{r})$（通常是通过混合旧的输入密度和新的输出密度），然后循环重复。\n\n查看给定的选项，顺序（B）$\\rightarrow$（C）$\\rightarrow$（A）对应于选项D。", "answer": "$$\\boxed{D}$$", "id": "1768566"}]}