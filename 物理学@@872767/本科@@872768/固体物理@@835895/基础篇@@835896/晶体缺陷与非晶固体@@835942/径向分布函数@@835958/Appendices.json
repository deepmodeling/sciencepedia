{"hands_on_practices": [{"introduction": "要真正理解径向分布函数 $g(r)$，最简单的方法是从一个完美的晶体结构入手。在这种理想情况下，$g(r)$ 表现为一系列尖锐的峰，每个峰对应于一个原子邻居壳层。通过计算一个简单立方晶格中最近邻和次近邻的距离，我们可以将 $g(r)$ 的抽象概念与具体的晶体几何结构联系起来，从而为理解更复杂的无序系统打下基础。[@problem_id:1820799]", "problem": "在凝聚态物理的研究中，径向分布函数（以 $g(r)$ 表示）是描述粒子系统平均结构的有力工具。对于绝对零度下的完美晶体，该函数简化为一系列离散且无限尖锐的峰。每个峰的位置 $r$ 对应于从一个参考原子到特定邻近原子壳层的距离。\n\n考虑一种假设性的单原子元素的单晶，它形成一个完美的简单立方（SC）晶格。在SC晶格中，原子位于一个在整个晶体中重复的概念性立方体的顶点上。我们可以将此立方体的边长定义为晶格常数 $a$。通过将一个参考原子置于笛卡尔坐标系的原点 $(0, 0, 0)$，晶格中所有其他原子的位置可以用坐标矢量 $(ia, ja, ka)$ 来描述，其中 $i, j$ 和 $k$ 是整数，且三者不全为零。\n\n该晶格的径向分布函数中的第一个峰出现在距离 $r_1$ 处，对应于第一最近邻原子集。第二个峰出现在距离 $r_2$ 处，对应于第二最近邻原子集。\n\n确定此简单立方晶格的比值 $\\frac{r_2}{r_1}$ 的精确值。", "solution": "问题要求计算简单立方（SC）晶格中，次近邻距离与最近邻距离之比。\n\n我们建立一个坐标系，将一个参考原子置于原点 $(0, 0, 0)$。在一个晶格常数为 $a$ 的简单立方晶格中，所有其他原子的位置由矢量 $\\vec{r} = (ia, ja, ka)$ 给出，其中 $i, j, k$ 是不全为零的整数。\n\n从原点到任何其他原子的距离 $d$ 是该位置矢量的模：\n$$d = |\\vec{r}| = \\sqrt{(ia)^2 + (ja)^2 + (ka)^2}$$\n$$d = a \\sqrt{i^2 + j^2 + k^2}$$\n为了找到到连续邻近原子壳层的距离，我们需要找到 $d$ 的最小可能值。由于 $a$ 是一个常数，这等价于找到整数平方和 $S = i^2 + j^2 + k^2$ 的最小可能非零值。\n\n**第一最近邻（距离 $r_1$）：**\n平方和 $S = i^2 + j^2 + k^2$ 的最小可能非零值出现在整数（$i, j, k$）中一个为 $\\pm 1$ 而另外两个为 0 时。\n例如，我们可以选择 $(i, j, k) = (1, 0, 0)$。\n平方和为 $S_1 = 1^2 + 0^2 + 0^2 = 1$。\n因此，到这些第一最近邻的距离是：\n$$r_1 = a \\sqrt{S_1} = a \\sqrt{1} = a$$\n这些邻原子位于诸如 $(\\pm a, 0, 0)$, $(0, \\pm a, 0)$ 和 $(0, 0, \\pm a)$ 的位置。\n\n**第二最近邻（距离 $r_2$）：**\n要找到第二最近邻，我们必须找到平方和 $S = i^2 + j^2 + k^2$ 的下一个最小可能值。让我们考察接下来几个 $(i, j, k)$ 的整数组合：\n1.  如果两个整数为 $\\pm 1$，一个为 0（例如 $(1, 1, 0)$），则平方和为 $S = 1^2 + 1^2 + 0^2 = 2$。\n2.  如果所有三个整数都为 $\\pm 1$（例如 $(1, 1, 1)$），则平方和为 $S = 1^2 + 1^2 + 1^2 = 3$。\n3.  如果一个整数为 $\\pm 2$，其他为 0（例如 $(2, 0, 0)$），则平方和为 $S = 2^2 + 0^2 + 0^2 = 4$。\n\n比较这些可能的和，继 $S_1=1$ 之后的最小值是 $S_2=2$。这对应于第二最近邻原子壳层。\n到这些第二最近邻的距离是：\n$$r_2 = a \\sqrt{S_2} = a \\sqrt{2}$$\n这些邻原子位于诸如 $(\\pm a, \\pm a, 0)$、$(\\pm a, 0, \\pm a)$ 和 $(0, \\pm a, \\pm a)$ 的位置，沿着立方晶胞的面-对角线。\n\n**计算比值：**\n问题要求计算比值 $\\frac{r_2}{r_1}$。使用我们为 $r_1$ 和 $r_2$ 推导出的表达式：\n$$\\frac{r_2}{r_1} = \\frac{a \\sqrt{2}}{a}$$\n晶格常数 $a$ 被约去，剩下：\n$$\\frac{r_2}{r_1} = \\sqrt{2}$$\n因此，对于SC晶格，径向分布函数中第二个峰与第一个峰的位置之比为 $\\sqrt{2}$。", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "1820799"}, {"introduction": "在处理来自模拟或实验的数据时，至关重要的是要能够判断结果的物理合理性。径向分布函数 $g(r)$ 有其必须遵守的基本物理约束。这个思想实验将挑战你思考 $g(r)$ 的根本定义，并解释为什么它永远不能为负值，这有助于培养你在科学计算中识别非物理结果的批判性思维。[@problem_id:2007503]", "problem": "在统计力学中，由相同粒子组成的简单流体的结构可以通过径向分布函数 $g(r)$ 来描述。该函数的定义是：对于一个平均数密度为 $\\rho = N/V$ 的系统，量 $\\rho g(r)$ 代表了在距离任意一个中心粒子 $r$ 处，其他粒子的局域数密度。因此，在以某个给定粒子为中心、半径为 $r$、无穷小厚度为 $dr$ 的薄球壳内，找到的平均粒子数为 $dN = \\rho g(r) 4 \\pi r^2 dr$。\n\n一名本科生正在进行液态氩的分子动力学模拟。在对粒子轨迹进行后处理后，该学生绘制了计算出的径向分布函数 $g(r)$ 的图像。令他惊讶的是，图像显示 $g(r)$ 在一小段距离范围内变为负值，具体来说是在 $r$ 介于 $0.5$ nm 和 $0.6$ nm 之间。尽管该学生怀疑其分析代码中存在错误，但他首先想确定这样的结果在根本上是否是不符合物理规律的。\n\n下列哪个陈述为“学生得到的负值 $g(r)$ 结果必定是错误的”这一论断提供了最基本、最直接的原因？\n\nA. 负的 $g(r)$ 值意味着在特定空间区域内的平均粒子数为负，这在物理上是不可能的。\nB. 负的 $g(r)$ 会违反 $g(r) = \\exp(-W(r)/(k_B T))$ 这一关系，因为指数函数不能为负。\nC. 该结果与流体中径向分布函数的已知渐近行为不一致，该行为要求当 $r$ 趋于无穷大时，$g(r)$ 必须趋近于 1。\nD. 这样的结果会违反维里状态方程，该方程将压力与 $r \\frac{du(r)}{dr} g(r)$ 的积分联系起来，因为它将意味着对压力的非物理贡献。\nE. 负的 $g(r)$ 意味着关联函数 $h(r) = g(r) - 1$ 小于 -1，而这是结构因子 $S(k)$ 的归一化条件所不允许的。", "solution": "根据定义，在数密度为 $\\rho$ 的均匀流体中，引入径向分布函数 $g(r)$，使得距离某个标记粒子 $r$ 处的局域平均数密度为 $\\rho g(r)$。因此，在半径为 $r$、厚度为 $dr$ 的薄球壳中的平均粒子数为\n$$\ndN=\\rho\\,g(r)\\,4\\pi r^{2}\\,dr.\n$$\n对于任何空间区域，该区域内的粒子数是一个非负整值随机变量。因此，其期望值必须满足\n$$\ndN \\ge 0.\n$$\n由于当 $r0$ 时，$\\rho0$，$4\\pi r^{2}0$ 且 $dr0$，要使 $dN$ 对所有 $r$ 都为非负，唯一的方法是\n$$\ng(r)\\ge 0 \\quad \\text{for all } r0.\n$$\n因此，负的 $g(r)$ 值将意味着该球壳的 $dN  0$，这与 $dN$ 作为平均计数的其基本概率意义直接矛盾。这是负值 $g(r)$ 不符合物理规律的最基本、最直接的原因。\n\n为了完整起见，我们与其他陈述进行比较：\n- 陈述B援引了 $g(r)=\\exp(-W(r)/(k_{B}T))$。虽然这种形式保证了 $g(r)0$，但它依赖于通过 $W(r)=-k_{B}T\\,\\ln g(r)$ 来定义平均力势，而这预设了 $g(r)0$。因此，与上述计数论证相比，它作为正定性的理由不那么基本。\n- 陈述C涉及当 $r\\to\\infty$ 时的渐近极限 $g(r)\\to 1$，这并不排除 $g(r)$ 在中间的 $r$ 值处变为负值，因此它不是一个直接的矛盾。\n- 陈述D引用了维里状态方程。即使 $g(r)$ 在一个小范围内为负，维里方程中的积分原则上仍然可以得到一个有限的压力，所以这不是最直接或最基本的原因。\n- 陈述E提到了 $h(r)=g(r)-1$ 和结构因子的约束。最直接的约束就是来自计数论证的 $g(r)\\ge 0$；诉诸 $S(k)$ 的归一化则更为间接，不是主要原因。\n\n因此，最基本和最直接的原因由陈述A给出。", "answer": "$$\\boxed{A}$$", "id": "2007503"}, {"introduction": "理论是基础，但将理论应用于实际数据是科学家必备的技能。本练习将理论与实践联系起来，指导你完成从一组二维粒子坐标的原始快照数据中数值计算 $g(r)$ 的过程。通过这个练习，你将学习到在计算物理学中用于分析物质结构的关键技术：配对距离计算、数据分箱和归一化。[@problem_id:2007519]", "problem": "对于一个粒子系统，径向分布函数 $g(r)$ 描述了密度如何随与一个参考粒子的距离而变化。对于一个面积为 $A$、包含 $N$ 个粒子的二维系统，在任何给定粒子周围半径为 $r$、厚度为 $dr$ 的环带中找到的平均粒子数 $dN$ 由 $dN = \\rho_0 g(r) (2\\pi r dr)$ 给出，其中 $\\rho_0 = N/A$ 是平均数密度。\n\n我们分析了二维流体计算机模拟中的一个快照。该模拟包含 $N=5$ 个粒子，位于边长为 $L=10$ 任意单位的方形盒子中。为简化计算，在距离计算中忽略了周期性边界条件。这五个粒子的坐标 $(x,y)$ 如下：\nP1: (1, 2)\nP2: (3, 4)\nP3: (7, 6)\nP4: (8, 1)\nP5: (4, 8)\n\n根据这单个构型，计算当距离 $r$ 满足 $4 \\le r  5$ 的区间内，径向分布函数 $g(r)$ 的数值估计。\n\n以闭式解析表达式的形式给出你的答案。", "solution": "本题要求基于粒子位置的单个快照，为特定距离区间计算径向分布函数 $g(r)$ 的数值估计。\n\n首先，我们必须从给定的 $g(r)$ 定义中推导出区间估计值 $g_{est}$ 的公式。定义指出，在中心粒子周围半径为 $r$、宽度为 $dr$ 的无穷小环带中的平均粒子数 $dN$ 为 $dN = \\rho_0 g(r) (2\\pi r dr)$。\n\n为了求出从 $r_{min}$ 到 $r_{max}$ 的有限环带（一个区间）中的粒子数 $\\Delta N$，我们对该表达式进行积分：\n$$ \\Delta N = \\int_{r_{min}}^{r_{max}} \\rho_0 g(r) 2\\pi r dr $$\n对于一个小的区间，我们可以将该区间内的 $g(r)$ 近似为一个常数值 $g_{est}$。\n$$ \\Delta N \\approx \\rho_0 g_{est} \\int_{r_{min}}^{r_{max}} 2\\pi r dr $$\n$$ \\Delta N \\approx \\rho_0 g_{est} \\left[ \\pi r^2 \\right]_{r_{min}}^{r_{max}} = \\rho_0 g_{est} \\pi(r_{max}^2 - r_{min}^2) $$\n项 $\\pi(r_{max}^2 - r_{min}^2)$ 是环带的面积，即 $A_{annulus}$。所以，$\\Delta N \\approx \\rho_0 g_{est} A_{annulus}$。我们可以重新整理这个式子来求解我们所期望的量 $g_{est}$：\n$$ g_{est} = \\frac{\\Delta N}{\\rho_0 A_{annulus}} $$\n在这里，$\\Delta N$ 是在环带中找到的粒子数的*平均值*，该平均值是对所有可能的中心粒子选择进行平均得到的。在我们这个包含 $N$ 个粒子的单个快照中，我们可以通过计算每个粒子的邻居数量然后求平均来估计这个平均值。设 $N_i$ 为在粒子 $i$ 周围的指定环带内，粒子 $j$（其中 $j \\neq i$）的数量。$\\Delta N$ 的估计值是这些计数的平均值：\n$$ \\Delta N_{est} = \\frac{1}{N} \\sum_{i=1}^{N} N_i $$\n求和 $\\sum_{i=1}^{N} N_i$ 将每个间距在区间内的粒子对 $\\{i,j\\}$ 计算了两次（一次以 $i$ 为中心，一次以 $j$ 为中心）。设 $N_p$ 为其间距落在该区间内的唯一粒子对的总数。那么 $\\sum_{i=1}^{N} N_i = 2 N_p$。因此，\n$$ \\Delta N_{est} = \\frac{2 N_p}{N} $$\n将此结果以及方形盒子中的数密度定义 $\\rho_0 = N/A = N/L^2$ 代入我们的 $g_{est}$ 表达式中，我们得到：\n$$ g_{est} = \\frac{2 N_p / N}{(N/L^2) A_{annulus}} = \\frac{2 N_p L^2}{N^2 A_{annulus}} $$\n\n现在，我们将这个公式应用于给定的数据。\n参数如下：\n- 粒子数，$N=5$。\n- 盒子边长，$L=10$ 单位。\n- 距离区间为 $[4, 5)$，所以 $r_{min}=4$ 且 $r_{max}=5$。\n\n首先，计算环带的面积 $A_{annulus}$：\n$$ A_{annulus} = \\pi(r_{max}^2 - r_{min}^2) = \\pi(5^2 - 4^2) = \\pi(25 - 16) = 9\\pi $$\n\n接下来，我们必须计算所有唯一粒子对的两两间距离 $d_{ij} = \\sqrt{(x_i-x_j)^2 + (y_i-y_j)^2}$，并统计有多少个（记为 $N_p$）落在 $4 \\le d_{ij}  5$ 的范围内。共有 $\\frac{N(N-1)}{2} = \\frac{5(4)}{2} = 10$ 对唯一的粒子对。\n粒子坐标为：P1(1,2), P2(3,4), P3(7,6), P4(8,1), P5(4,8)。\n\n1.  $d_{12} = \\sqrt{(3-1)^2 + (4-2)^2} = \\sqrt{2^2 + 2^2} = \\sqrt{8} \\approx 2.828$\n2.  $d_{13} = \\sqrt{(7-1)^2 + (6-2)^2} = \\sqrt{6^2 + 4^2} = \\sqrt{52} \\approx 7.211$\n3.  $d_{14} = \\sqrt{(8-1)^2 + (1-2)^2} = \\sqrt{7^2 + (-1)^2} = \\sqrt{50} \\approx 7.071$\n4.  $d_{15} = \\sqrt{(4-1)^2 + (8-2)^2} = \\sqrt{3^2 + 6^2} = \\sqrt{45} \\approx 6.708$\n5.  $d_{23} = \\sqrt{(7-3)^2 + (6-4)^2} = \\sqrt{4^2 + 2^2} = \\sqrt{20}$。因为 $16  20  25$，我们有 $4  \\sqrt{20}  5$。这对粒子在区间内。（$\\sqrt{20} \\approx 4.472$）\n6.  $d_{24} = \\sqrt{(8-3)^2 + (1-4)^2} = \\sqrt{5^2 + (-3)^2} = \\sqrt{34} \\approx 5.831$\n7.  $d_{25} = \\sqrt{(4-3)^2 + (8-4)^2} = \\sqrt{1^2 + 4^2} = \\sqrt{17}$。因为 $16  17  25$，我们有 $4  \\sqrt{17}  5$。这对粒子在区间内。（$\\sqrt{17} \\approx 4.123$）\n8.  $d_{34} = \\sqrt{(8-7)^2 + (1-6)^2} = \\sqrt{1^2 + (-5)^2} = \\sqrt{26} \\approx 5.099$\n9.  $d_{35} = \\sqrt{(4-7)^2 + (8-6)^2} = \\sqrt{(-3)^2 + 2^2} = \\sqrt{13} \\approx 3.606$\n10. $d_{45} = \\sqrt{(4-8)^2 + (8-1)^2} = \\sqrt{(-4)^2 + 7^2} = \\sqrt{65} \\approx 8.062$\n\n通过检查所有距离，我们发现有两对粒子，{P2, P3} 和 {P2, P5}，其间距 $d$ 满足 $4 \\le d  5$。因此，该区间内的粒子对数量为 $N_p=2$。\n\n最后，将所有值代入估计量公式中：\n$$ g_{est} = \\frac{2 N_p L^2}{N^2 A_{annulus}} = \\frac{2 \\cdot 2 \\cdot (10)^2}{5^2 \\cdot (9\\pi)} = \\frac{4 \\cdot 100}{25 \\cdot 9\\pi} = \\frac{400}{225\\pi} $$\n化简分数：\n$$ g_{est} = \\frac{16 \\cdot 25}{9 \\cdot 25 \\cdot \\pi} = \\frac{16}{9\\pi} $$", "answer": "$$\\boxed{\\frac{16}{9\\pi}}$$", "id": "2007519"}]}