{"hands_on_practices": [{"introduction": "为了建立我们的直觉，我们从一个高度简化的原子“玩具模型”开始。在这个练习中 [@problem_id:1808688]，我们假设一个原子的所有电子都分布在一个无限薄的球壳上。这种理想化的情景让我们能够清晰地执行傅里叶变换，并直接观察到一个特征尺寸（半径 $R$）如何导致原子形式因子随散射矢量 $q$ 而变化。", "problem": "考虑一个原子序数为 $Z$ 的假想球对称原子。在此模型中，该原子由位于原点的点状原子核和 $Z$ 个电子组成。假设所有电子都分布在一个半径为 $R$ 的无限薄的球壳上。该分布由电子数密度 $\\rho(r) = C \\delta(r-R)$ 描述，其中 $r$ 是与原子核的径向距离，$\\delta(x)$ 是狄拉克$\\delta$函数，$C$ 是一个归一化常数。首先，通过要求电子数密度在全空间上的积分等于 $Z$，用 $Z$ 和 $R$ 来确定归一化常数 $C$。\n\n原子形状因子 $f_a(\\mathbf{q})$ 表示原子电子密度的傅里叶变换，并决定其X射线散射特性。它由以下积分定义：\n$$ f_a(\\mathbf{q}) = \\int \\rho(\\mathbf{r}) \\exp(-i \\mathbf{q} \\cdot \\mathbf{r}) dV $$\n其中 $\\mathbf{q}$ 是散射矢量，积分遍及全空间。由于电子密度的球对称性，形状因子将仅依赖于散射矢量的大小 $q = |\\mathbf{q}|$。\n\n计算这个假想原子的原子形状因子 $f_a(q)$。将最终答案表示为以 $Z$、$q$ 和 $R$ 表示的单个闭式解析表达式。", "solution": "给定一个包含 $Z$ 个电子、半径为 $R$ 的球壳的球对称电子数密度 $\\rho(r) = C \\delta(r - R)$。归一化条件是数密度在全空间上的积分等于 $Z$。在球坐标系中，体积元为 $dV = r^{2} \\sin\\theta \\, dr \\, d\\theta \\, d\\phi$，且密度仅依赖于 $r$，我们有\n$$\n\\int \\rho(\\mathbf{r}) \\, dV \\;=\\; \\int_{0}^{\\infty} \\int_{0}^{\\pi} \\int_{0}^{2\\pi} C \\delta(r - R) \\, r^{2} \\sin\\theta \\, d\\phi \\, d\\theta \\, dr \\;=\\; 4\\pi C \\int_{0}^{\\infty} \\delta(r - R) \\, r^{2} \\, dr \\;=\\; 4\\pi C R^{2}.\n$$\n施加 $\\int \\rho \\, dV = Z$ 的条件可得\n$$\n4\\pi C R^{2} = Z \\quad \\Rightarrow \\quad C = \\frac{Z}{4\\pi R^{2}}.\n$$\n\n原子形状因子是电子数密度的傅里叶变换，\n$$\nf_{a}(\\mathbf{q}) \\;=\\; \\int \\rho(\\mathbf{r}) \\exp\\!\\left(-i \\mathbf{q}\\cdot \\mathbf{r}\\right) \\, dV.\n$$\n根据球对称性，$f_{a}$ 仅依赖于 $q = |\\mathbf{q}|$。选择 $z$ 轴沿 $\\mathbf{q}$ 方向，这样 $\\mathbf{q}\\cdot \\mathbf{r} = q r \\cos\\theta$。于是\n$$\nf_{a}(q) \\;=\\; \\int_{0}^{\\infty} \\int_{0}^{\\pi} \\int_{0}^{2\\pi} C \\delta(r - R) \\exp\\!\\left(-i q r \\cos\\theta\\right) r^{2} \\sin\\theta \\, d\\phi \\, d\\theta \\, dr.\n$$\n首先进行角度积分。方位角积分给出一个因子 $2\\pi$，并设 $u = \\cos\\theta$，\n$$\n\\int_{0}^{\\pi} \\exp\\!\\left(-i q r \\cos\\theta\\right) \\sin\\theta \\, d\\theta \\;=\\; \\int_{-1}^{1} \\exp(-i q r u) \\, du \\;=\\; \\frac{2 \\sin(q r)}{q r}.\n$$\n因此，\n$$\n\\int \\exp\\!\\left(-i q r \\cos\\theta\\right) \\, d\\Omega \\;=\\; 2\\pi \\cdot \\frac{2 \\sin(q r)}{q r} \\;=\\; 4\\pi \\frac{\\sin(q r)}{q r}.\n$$\n代回原式，\n$$\nf_{a}(q) \\;=\\; C \\int_{0}^{\\infty} \\delta(r - R) \\, r^{2} \\left[ 4\\pi \\frac{\\sin(q r)}{q r} \\right] dr \\;=\\; 4\\pi C \\, \\frac{R^{2} \\sin(q R)}{q R}.\n$$\n使用归一化常数 $C = \\frac{Z}{4\\pi R^{2}}$，我们得到\n$$\nf_{a}(q) \\;=\\; \\frac{Z}{4\\pi R^{2}} \\cdot 4\\pi R^{2} \\cdot \\frac{\\sin(q R)}{q R} \\;=\\; Z \\, \\frac{\\sin(q R)}{q R}.\n$$\n此结果通过极限 $\\lim_{x \\to 0} \\frac{\\sin x}{x} = 1$ 与归一化条件 $f_{a}(0) = Z$ 相符。", "answer": "$$\\boxed{Z \\,\\frac{\\sin(q R)}{q R}}$$", "id": "1808688"}, {"introduction": "尽管球壳模型很有启发性，但真实的电子云是弥散的，没有清晰的边界。接下来的练习 [@problem_id:1808725] 使用高斯函数来表示一种更真实、更平滑的电子密度分布。通过计算该分布的原子形式因子，你将发现傅里叶变换的一个基本性质，并理解真实空间中平滑的密度分布如何导致倒易空间中平滑衰减的形式因子，这也是真实原子的一个关键特征。", "problem": "考虑一个原子序数为 $Z$ 的中性原子模型。其 $Z$ 个电子的空间分布由一个球对称的电子数密度 $\\rho(r)$ 描述，其中 $r$ 是到原子核的距离。该密度由高斯函数给出：\n$$\n\\rho(r) = C \\exp\\left(-\\frac{r^2}{a^2}\\right)\n$$\n其中 $a$ 是一个具有长度量纲的常数，表征电子云的大小，$C$ 是一个归一化常数。常数 $C$ 的取值必须使得电子数密度在整个空间上的积分等于电子总数 $Z$。\n\n原子形状因子 $f(\\vec{K})$ 描述了 X 射线从原子电子云散射的散射振幅，其定义为电子密度的傅里叶变换：\n$$\nf(\\vec{K}) = \\int \\rho(\\vec{r}) \\exp(-i\\vec{K}\\cdot\\vec{r}) \\, d^3\\vec{r}\n$$\n其中积分遍及整个空间，$\\vec{r}$ 是从原子核出发的位置矢量，$\\vec{K}$ 是散射矢量。对于球对称密度，形状因子仅取决于散射矢量的大小 $K = |\\vec{K}|$。\n\n求此原子的原子形状因子 $f(K)$。请用 $Z$、$K$ 和 $a$ 将最终答案表示为解析表达式。", "solution": "求解过程包括两个主要步骤：首先，我们通过确保总电子数为 $Z$ 来确定归一化常数 $C$。其次，我们计算归一化电子密度的傅里叶变换以求得原子形状因子 $f(K)$。\n\n**第一步：电子密度的归一化**\n\n归一化条件要求电子数密度 $\\rho(\\vec{r})$ 在整个空间上的积分等于电子总数 $Z$。\n$$\nZ = \\int_{\\text{all space}} \\rho(\\vec{r}) \\, d^3\\vec{r}\n$$\n由于密度 $\\rho(r)$ 是球对称的，最方便的方法是使用球坐标系进行积分。体积元为 $d^3\\vec{r} = r^2 \\sin\\theta \\, dr \\, d\\theta \\, d\\phi$。\n$$\nZ = \\int_0^\\infty \\int_0^\\pi \\int_0^{2\\pi} C \\exp\\left(-\\frac{r^2}{a^2}\\right) r^2 \\sin\\theta \\, d\\phi \\, d\\theta \\, dr\n$$\n关于角变量 $\\phi$ 和 $\\theta$ 的积分与其他变量无关。\n$$\n\\int_0^{2\\pi} d\\phi = 2\\pi\n$$\n$$\n\\int_0^\\pi \\sin\\theta \\, d\\theta = [-\\cos\\theta]_0^\\pi = -(-1) - (-1) = 2\n$$\n角积分的乘积为 $4\\pi$。将其代入归一化方程，得到：\n$$\nZ = 4\\pi C \\int_0^\\infty r^2 \\exp\\left(-\\frac{r^2}{a^2}\\right) dr\n$$\n余下的径向积分是一个标准的高斯积分，形式为 $\\int_0^\\infty x^{2n} \\exp(-bx^2) dx = \\frac{(2n-1)!!}{2^{n+1}} \\sqrt{\\frac{\\pi}{b^{2n+1}}}$。对于本问题，有 $n=1$ 且 $b = 1/a^2$。\n$$\n\\int_0^\\infty r^2 \\exp\\left(-\\frac{r^2}{a^2}\\right) dr = \\frac{1!!}{2^{1+1}} \\sqrt{\\frac{\\pi}{(1/a^2)^{2(1)+1}}} = \\frac{1}{4} \\sqrt{\\pi a^6} = \\frac{\\sqrt{\\pi} a^3}{4}\n$$\n将此结果代回：\n$$\nZ = 4\\pi C \\left(\\frac{\\sqrt{\\pi} a^3}{4}\\right) = C \\pi^{3/2} a^3\n$$\n解出归一化常数 $C$：\n$$\nC = \\frac{Z}{\\pi^{3/2} a^3}\n$$\n因此，归一化的电子密度为：\n$$\n\\rho(r) = \\frac{Z}{\\pi^{3/2} a^3} \\exp\\left(-\\frac{r^2}{a^2}\\right)\n$$\n\n**第二步：原子形状因子的计算**\n\n原子形状因子 $f(\\vec{K})$ 是 $\\rho(\\vec{r})$ 的傅里叶变换：\n$$\nf(\\vec{K}) = \\int \\rho(\\vec{r}) \\exp(-i\\vec{K}\\cdot\\vec{r}) \\, d^3\\vec{r}\n$$\n我们再次使用球坐标系。由于问题的球对称性，我们可以不失一般性地将坐标系的 $z$ 轴与散射矢量 $\\vec{K}$ 对齐。这样，点积 $\\vec{K} \\cdot \\vec{r}$ 就简化为 $K r \\cos\\theta$，其中 $\\theta$ 是极角。\n$$\nf(K) = \\int_0^\\infty \\int_0^\\pi \\int_0^{2\\pi} \\frac{Z}{\\pi^{3/2} a^3} \\exp\\left(-\\frac{r^2}{a^2}\\right) \\exp(-iKr\\cos\\theta) r^2 \\sin\\theta \\, d\\phi \\, d\\theta \\, dr\n$$\n对 $\\phi$ 的积分得到一个因子 $2\\pi$。\n$$\nf(K) = \\frac{2\\pi Z}{\\pi^{3/2} a^3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{r^2}{a^2}\\right) \\left[ \\int_0^\\pi \\exp(-iKr\\cos\\theta) \\sin\\theta \\, d\\theta \\right] dr\n$$\n我们来计算内部对 $\\theta$ 的积分。我们使用换元法，令 $u = \\cos\\theta$，则 $du = -\\sin\\theta \\, d\\theta$。积分限从 $\\theta \\in [0, \\pi]$ 变为 $u \\in [1, -1]$。\n$$\n\\int_0^\\pi \\exp(-iKr\\cos\\theta) \\sin\\theta \\, d\\theta = \\int_1^{-1} \\exp(-iKru) (-du) = \\int_{-1}^1 \\exp(-iKru) \\, du\n$$\n$$\n= \\left[ \\frac{\\exp(-iKru)}{-iKr} \\right]_{-1}^1 = \\frac{\\exp(-iKr) - \\exp(iKr)}{-iKr}\n$$\n使用欧拉恒等式 $\\sin(x) = \\frac{\\exp(ix) - \\exp(-ix)}{2i}$，我们可以简化这个表达式：\n$$\n\\frac{-2i\\sin(Kr)}{-iKr} = \\frac{2\\sin(Kr)}{Kr}\n$$\n将此结果代回 $f(K)$ 的表达式中：\n$$\nf(K) = \\frac{2 Z}{\\sqrt{\\pi} a^3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{r^2}{a^2}\\right) \\left( \\frac{2\\sin(Kr)}{Kr} \\right) dr\n$$\n$$\nf(K) = \\frac{4Z}{K\\sqrt{\\pi} a^3} \\int_0^\\infty r \\sin(Kr) \\exp\\left(-\\frac{r^2}{a^2}\\right) dr\n$$\n剩下的积分是一个已知结果，与高斯函数的傅里叶正弦变换有关。标准积分形式为 $\\int_0^\\infty x \\exp(-bx^2) \\sin(cx) dx = \\frac{c\\sqrt{\\pi}}{4b^{3/2}}\\exp\\left(-\\frac{c^2}{4b}\\right)$。这里，$x=r$，$b=1/a^2$，$c=K$。\n$$\n\\int_0^\\infty r \\sin(Kr) \\exp\\left(-\\frac{r^2}{a^2}\\right) dr = \\frac{K\\sqrt{\\pi}}{4(1/a^2)^{3/2}} \\exp\\left(-\\frac{K^2}{4(1/a^2)}\\right) = \\frac{K\\sqrt{\\pi}a^3}{4} \\exp\\left(-\\frac{K^2 a^2}{4}\\right)\n$$\n最后，我们将这个积分结果代入 $f(K)$ 的表达式中：\n$$\nf(K) = \\frac{4Z}{K\\sqrt{\\pi} a^3} \\left[ \\frac{K\\sqrt{\\pi}a^3}{4} \\exp\\left(-\\frac{K^2 a^2}{4}\\right) \\right]\n$$\n前面的系数相消，得到原子形状因子的最终表达式：\n$$\nf(K) = Z \\exp\\left(-\\frac{K^2 a^2}{4}\\right)\n$$\n作为检验，对于前向散射（$K=0$），我们得到 $f(0)=Z$，这是一个正确的结果，因为所有 $Z$ 个电子都同相散射。", "answer": "$$\\boxed{Z \\exp\\left(-\\frac{K^{2} a^{2}}{4}\\right)}$$", "id": "1808725"}, {"introduction": "学习了如何计算原子形式因子后，我们现在来探讨它在实验中的具体影响。前面练习的结果表明，对于任何有限尺寸的原子，其形式因子 $f(q)$ 都会随着散射矢量大小 $q$ 的增加而减小。最后一个练习 [@problem_id:1808703] 是一个思想实验，它要求你预测这种衰减如何影响X射线衍射图样中不同布拉格峰的相对强度，从而巩固微观电子分布与宏观实验可观测量之间的联系。", "problem": "在晶体X射线衍射的研究中，原子形状因子 $f(\\mathbf{q})$ 在决定布拉格峰强度方面起着至关重要的作用。它被定义为单个原子电子电荷分布的傅里叶变换，并取决于散射矢量 $\\mathbf{q}$。对于具有空间分布电子云的真实原子，形状因子在 $\\mathbf{q}=0$ 处达到最大值，并随着 $|\\mathbf{q}|$ 的模增加而减小。这种减小导致了在更大散射角下衍射强度的衰减。\n\n现在，考虑一个由单原子体心立方（BCC）晶格组成的假设固体。我们将比较两种情况：\n1.  一个“真实”晶体，其中原子具有真实的、空间分布的电子云，因此其形状因子 $f_{\\text{real}}(\\mathbf{q})$ 随 $|\\mathbf{q}|$ 的增加而减小。\n2.  一个“假设”晶体，其中每个原子被建模为点电荷。在这种情况下，原子形状因子 $f_{\\text{hypo}}(\\mathbf{q})$ 对于所有散射矢量 $\\mathbf{q}$ 都是一个常数。\n\n设 $I_{110}$ 和 $I_{220}$ 分别为对应于米勒指数(110)和(220)的X射线衍射峰的强度。设 $R_{\\text{real}} = (I_{220}/I_{110})_{\\text{real}}$ 为真实晶体的强度比，而 $R_{\\text{hypo}} = (I_{220}/I_{110})_{\\text{hypo}}$ 为假设晶体的强度比。\n\n下列哪个选项正确地描述了这两个比值之间的关系？\n\nA. $R_{\\text{hypo}}  R_{\\text{real}}  1$\n\nB. $R_{\\text{real}}  R_{\\text{hypo}} = 1$\n\nC. $R_{\\text{real}} = R_{\\text{hypo}} = 1$\n\nD. $1  R_{\\text{real}}  R_{\\text{hypo}}$\n\nE. $R_{\\text{real}} = 0$ and $R_{\\text{hypo}} > 0$", "solution": "对于运动学X射线衍射，米勒指数为 $(hkl)$ 的布拉格峰的积分强度与结构因子模的平方成正比：\n$$\nI_{hkl} \\propto |F_{hkl}|^{2}.\n$$\n对于一个单原子BCC晶格，其中相同的原子位于分数坐标 $(0,0,0)$ 和 $\\left(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2}\\right)$ 处，其对于散射矢量 $\\mathbf{q}=\\mathbf{G}_{hkl}$ 的结构因子为\n$$\nF_{hkl} = f(\\mathbf{q})\\left[\\exp(i\\mathbf{q}\\cdot \\mathbf{0}) + \\exp\\!\\left(i\\mathbf{q}\\cdot \\tfrac{1}{2}( \\mathbf{a}_{1}+\\mathbf{a}_{2}+\\mathbf{a}_{3})\\right)\\right]\n= f(\\mathbf{q})\\left[1 + \\exp\\!\\left(i\\pi(h+k+l)\\right)\\right],\n$$\n使得\n$$\nF_{hkl} = \\begin{cases}\n2\\,f(\\mathbf{q}),  h+k+l \\text{ even},\\\\\n0,  h+k+l \\text{ odd}.\n\\end{cases}\n$$\n(110)和(220)都满足 $h+k+l$ 为偶数，因此\n$$\nI_{110} \\propto 4\\,|f(\\mathbf{q}_{110})|^{2},\\qquad I_{220} \\propto 4\\,|f(\\mathbf{q}_{220})|^{2}.\n$$\n因此，强度比为\n$$\n\\frac{I_{220}}{I_{110}} = \\frac{|f(\\mathbf{q}_{220})|^{2}}{|f(\\mathbf{q}_{110})|^{2}}.\n$$\n在立方晶体中，$|\\mathbf{q}_{hkl}| = |\\mathbf{G}_{hkl}| \\propto \\sqrt{h^{2}+k^{2}+l^{2}}$，所以\n$$\n|\\mathbf{q}_{110}| \\propto \\sqrt{2}, \\qquad |\\mathbf{q}_{220}| \\propto \\sqrt{8} = 2\\sqrt{2},\n$$\n因此 $|\\mathbf{q}_{220}| > |\\mathbf{q}_{110}|$。\n\n对于假设的点状原子，$f_{\\text{hypo}}(\\mathbf{q})$ 是一个与 $\\mathbf{q}$ 无关的常数，所以\n$$\nR_{\\text{hypo}} = \\left(\\frac{I_{220}}{I_{110}}\\right)_{\\text{hypo}} = \\frac{|f_{\\text{hypo}}|^{2}}{|f_{\\text{hypo}}|^{2}} = 1.\n$$\n对于真实原子，$f_{\\text{real}}(\\mathbf{q})$ 随 $|\\mathbf{q}|$ 的增加而减小，得到\n$$\n|f_{\\text{real}}(\\mathbf{q}_{220})|  |f_{\\text{real}}(\\mathbf{q}_{110})| \\quad \\Rightarrow \\quad\nR_{\\text{real}} = \\left(\\frac{I_{220}}{I_{110}}\\right)_{\\text{real}} = \\frac{|f_{\\text{real}}(\\mathbf{q}_{220})|^{2}}{|f_{\\text{real}}(\\mathbf{q}_{110})|^{2}}  1.\n$$\n综合以上结果，\n$$\nR_{\\text{real}}  R_{\\text{hypo}} = 1,\n$$\n这对应于选项B。另请注意，在BCC晶格中，(110)和(220)都不是禁戒的（它们的 $h+k+l$ 之和均为偶数），所以 $R_{\\text{real}}$ 不为零。", "answer": "$$\\boxed{B}$$", "id": "1808703"}]}