{"hands_on_practices": [{"introduction": "密度泛函理论（DFT）的基石之一是Hohenberg-Kohn变分原理，它指出任何尝试的电子密度所计算出的能量都必须大于或等于真实的基态能量。这个练习 [@problem_id:1407256] 提出了一个看似矛盾的思想实验，其结果似乎违背了这一基本原理。通过探究这个悖论，我们将揭示DFT理论成立的一个至关重要的前提条件——N-可表示性（N-representability），从而加深对理论适用边界的理解。", "problem": "一位本科生正在探索密度泛函理论 (DFT) 的基础。他们决定在最简单的系统上——单个非相对论性氢原子——测试 Hohenberg-Kohn (HK) 变分原理。\n\n在原子单位制下，氢原子的外势由 $v_{ext}(\\vec{r}) = -1/r$ 给出。已知其精确的基态能量为 $E_0 = -0.5$ Hartrees。对于单电子系统，总能量可以表示为电子密度 $n(\\vec{r})$ 的一个精确泛函：\n$$E[n] = T_s[n] + \\int v_{ext}(\\vec{r}) n(\\vec{r}) d^3\\vec{r}$$\n其中 $T_s[n]$ 是密度为 $n(\\vec{r})$ 的单个无相互作用电子的动能泛函。\n\n该学生使用两种不同的试探电子密度 $n_A(\\vec{r})$ 和 $n_B(\\vec{r})$ 进行了两次计算。\n1.  使用试探密度 $n_A(\\vec{r})$，计算得到的能量为 $E[n_A] = -0.46$ Hartrees。\n2.  使用试探密度 $n_B(\\vec{r})$，计算得到的能量为 $E[n_B] = -0.53$ Hartrees。\n\n第二个结果 $E[n_B]  E_0$ 似乎直接违反了第二 Hohenberg-Kohn 定理（变分原理），该原理指出，任何有效的试探密度所产生的能量都必须大于或等于真实的基态能量。假设动能泛函 $T_s[n]$ 被精确求值，并且所有数值积分都无误地执行，那么这个悖论性结果最根本的理论原因是什么？\n\nA. Hohenberg-Kohn 定理是为多电子系统推导的，并且已知在像氢这样的单电子系统的特殊情况下会失效。\n\nB. DFT 中的变分原理本身只是一个近似，并不能保证能量的下界。\n\nC. 这个结果必定是由于使用了近似的动能泛函 $T_s[n]$，因为即使对于单个电子，该泛函的精确形式也是未知的。\n\nD. 试探密度 $n_B(\\vec{r})$ 对于单电子系统而言不是一个物理上有效的密度（即，它不是“N-可表示的”），因此违反了变分原理适用的一个关键先决条件。\n\nE. 计算 B 发现了一个比先前已知的更稳定的氢原子电子态，这表明 $E_0 = -0.5$ Hartrees 不是真正的基态。", "solution": "我们从 Levy-Lieb 约束搜索形式的精确 Hohenberg-Kohn 变分公式出发。对于给定的外势 $v(\\vec r)$ 和粒子数 $N$，定义普适泛函\n$$\nF[n] = \\min_{\\Psi \\to n} \\langle \\Psi | \\hat T + \\hat V_{ee} | \\Psi \\rangle,\n$$\n其中最小化是针对所有能产生密度 $n(\\vec r)$ 的反对称 $N$ 电子波函数 $\\Psi$ 进行的。对于任何 $N$-可表示的密度 $n$（即，至少来自一个这样的 $\\Psi$），DFT 能量泛函为\n$$\nE_{v}[n] = F[n] + \\int v(\\vec r) \\, n(\\vec r) \\, d^{3}\\vec r.\n$$\n设 $\\Psi_{n}$ 是一个在 $F[n]$ 的定义中达到（或任意接近）最小值的波函数。那么\n$$\nE_{v}[n] = \\langle \\Psi_{n} | \\hat T + \\hat V_{ee} | \\Psi_{n} \\rangle + \\int v \\, n\n= \\langle \\Psi_{n} | \\hat T + \\hat V_{ee} + \\hat V | \\Psi_{n} \\rangle \\ge E_{0},\n$$\n其中 $E_{0}$ 是精确的基态能量，该不等式遵循 Rayleigh-Ritz 原理。因此，对于每一个 $N$-可表示的密度 $n$，都有\n$$\nE_{v}[n] \\ge E_{0}.\n$$\n\n特别地，对于单电子系统，$\\hat V_{ee} = 0$ 且\n$$\nF[n] = T_{s}[n] = \\min_{\\psi \\to n} \\langle \\psi | \\hat T | \\psi \\rangle = T_{W}[n],\n$$\n其中精确的 Weizsäcker 泛函为\n$$\nT_{W}[n] = \\frac{1}{8} \\int \\frac{|\\nabla n(\\vec r)|^{2}}{n(\\vec r)} \\, d^{3}\\vec r,\n$$\n前提是 $n$ 是 $N$-可表示的并且足够正则，使得 $\\sqrt{n} \\in H^{1}(\\mathbb{R}^{3})$（以确保动能有限）。因此，对于任何物理上有效的单电子密度 $n$，\n$$\nE[n] = T_{s}[n] + \\int v_{ext}(\\vec r) \\, n(\\vec r) \\, d^{3}\\vec r \\ge E_{0}.\n$$\n\n在问题中，我们得到了 $E[n_{B}]  E_{0}$，同时假设 $T_{s}[n]$ 被精确求值且积分是精确的。上述不等式表明，对于任何 $N$-可表示的单电子密度，这样的结果都不可能发生。因此，唯一剩下的逻辑可能性是 $n_{B}$ 不是一个物理上可接受的单电子密度（不满足 $N$-可表示性，或者等价地说，对于通过约束搜索得到的 HK 变分界限，它位于 $F[n]$ 的定义域之外）。典型的违规情况包括非负性缺失、未正确归一化到 $N=1$，或者正则性不足，以至于不存在动能有限且满足 $|\\psi|^{2} = n_{B}$ 的波函数 $\\psi$。\n\n评估各个选项：\n- A 是错误的：HK 定理适用于任何 $N$，并且对于 $N=1$，泛函是精确已知的。\n- B 是错误的：对于约束搜索泛函在其定义域上，DFT 变分原理是严格成立的。\n- C 是错误的：对于 $N=1$，$T_{s}[n]$ 精确等于 $T_{W}[n]$。\n- D 是正确的：这个悖论的产生是因为 $n_{B}$ 不是 $N$-可表示的，从而使得变分界限无效。\n- E 是错误的：氢原子的 $E_{0}$ 是精确已知的，不可能被一个物理上有效的密度所突破。\n\n因此，根本的理论原因是试探密度 $n_{B}$ 不是 $N$-可表示的。", "answer": "$$\\boxed{D}$$", "id": "1407256"}, {"introduction": "从基本定理转向实用的Kohn-Sham方法时，我们必须精确处理电子间的相互作用。其中一个棘手的问题是“自相互作用误差”，即电子会错误地与自身发生作用。这个练习 [@problem_id:1999035] 通过最简单的单电子系统（氢原子）清晰地展示了精确的交换能是如何从根本上被定义出来，以完美抵消经典哈特里能量（Hartree energy）中包含的这种非物理性自相互作用。理解这一原理对于开发和评估更高级的交换关联泛函至关重要。", "problem": "在密度泛函理论 (DFT) 的 Kohn-Sham 表述中，一个电子密度为 $n(\\vec{r})$ 的体系的总电子能量 $E[n]$ 表示为四个分量的和：\n$$E[n] = T_s[n] + E_{ext}[n] + E_H[n] + E_{xc}[n]$$\n此处，$T_s[n]$ 是一个无相互作用电子参考体系的动能，$E_{ext}[n]$ 是电子在原子核外场中的势能，$E_H[n]$ 是 Hartree 能量。Hartree 能量表示电子密度与其自身的经典静电库仑排斥作用。最后一项 $E_{xc}[n]$ 是交换-相关能量，它包含了其他项中未包括的所有量子力学效应。为了我们的目的，我们可以认为 $E_{xc}[n] = E_x[n] + E_c[n]$，其中 $E_x[n]$ 是交换能量，$E_c[n]$ 是相关能量。\n\n一名学生正在使用一个计算化学软件包，其中包含一个假设的精确交换-相关泛函，来研究一个孤立氢原子的电子结构。一个氢原子由一个质子和一个电子组成。在分析计算得到的能量分量时，该学生观察到 Hartree 能量和交换能量之和恰好为零：$E_H[n] + E_x[n] = 0$。\n\n下列哪个陈述为这种精确抵消提供了正确的物理解释？\n\nA. 对于单个电子，Hartree 能量是一种非物理的自相互作用能，而精确交换能量的定义要求它精确地抵消掉这种人为效应。\n\nB. 相关能量描述了电子如何相互规避，对于单电子体系，相关能量为零，因此，为了保持总能量守恒，交换能量必须与 Hartree 能量大小相等、符号相反。\n\nC. 对于任何单电子体系，Kohn-Sham 动能 $T_s[n]$ 与真实动能完全相同，这个条件迫使 Hartree 能量和交换能量之和为零。\n\nD. 该体系具有完美的球对称性，这在数学上约束了球平均静电排斥和相应的交换修正大小相等、符号相反。\n\nE. 交换能量代表电子与自身的经典排斥作用，而 Hartree 能量是一个纯粹的量子力学修正项；对于单个电子，这两种效应大小相等、符号相反。", "solution": "在 Kohn-Sham DFT 中，电子-电子相互作用能表示为 $E_{H}[n] + E_{xc}[n]$ 的和。对于单电子体系，真实的电子-电子相互作用算符\n$$\n\\hat{V}_{ee} = \\frac{1}{2}\\sum_{i\\neq j}\\frac{1}{|\\mathbf{r}_{i}-\\mathbf{r}_{j}|},\n$$\n的精确期望值恒为零，因为不存在电子对。因此，对于精确的泛函，必须有\n$$\nE_{H}[n] + E_{xc}[n] = 0 \\quad \\text{对于任何单电子密度 } n.\n$$\nHartree 能量是密度的经典自库仑能量，\n$$\nE_{H}[n] = \\frac{1}{2}\\iint \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,\\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'.\n$$\n对于具有 Kohn-Sham 轨道 $\\phi(\\mathbf{r})$ 和密度 $n(\\mathbf{r}) = |\\phi(\\mathbf{r})|^{2}$ 的单个电子，精确交换能量（单个 Slater 行列式的交换能量）为\n$$\nE_{x} = -\\frac{1}{2}\\sum_{\\sigma}\\sum_{i,j}\\iint \\frac{\\phi_{i\\sigma}^{*}(\\mathbf{r})\\phi_{j\\sigma}(\\mathbf{r})\\,\\phi_{j\\sigma}^{*}(\\mathbf{r}')\\phi_{i\\sigma}(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,\\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'.\n$$\n当只有一个占据轨道时（例如，$i=j=1$ 且为单个自旋通道），该式简化为\n$$\nE_{x} = -\\frac{1}{2}\\iint \\frac{|\\phi(\\mathbf{r})|^{2}\\,|\\phi(\\mathbf{r}')|^{2}}{|\\mathbf{r}-\\mathbf{r}'|}\\,\\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}' = -E_{H}[n].\n$$\n因此，在单电子体系中，Hartree 自相互作用能被交换能量精确抵消：\n$$\nE_{H}[n] + E_{x}[n] = 0.\n$$\n为了完整起见，在单电子体系中，相关能量为零，$E_{c}[n]=0$，并且 Kohn-Sham 动能等于真实动能。然而，这两个事实都不是强制抵消的机制；相反，抵消的发生是因为 $E_{H}[n]$ 对于单电子来说是一种非物理的自相互作用，而精确交换的定义就是要精确地消除这种自相互作用。\n\n评估各个选项：\n- A 正确地指出 $E_{H}[n]$ 对于单电子是一种非物理的自相互作用，并且精确交换会抵消它。\n- B 指出 $E_{c}[n]=0$（正确），但错误地将抵消的原因归咎于此事实；抵消是由于交换消除了自相互作用。\n- C 和 D 并不能强制使 $E_{H}+E_{x}=0$。\n- E 颠倒了 Hartree 和交换的物理作用。\n\n因此，A 是正确的。", "answer": "$$\\boxed{A}$$", "id": "1999035"}, {"introduction": "在执行Kohn-Sham DFT计算后，我们会得到一组轨道能量，即本征值。一个常见的误解是认为这些本征值的总和就等于体系的总电子能量。这个练习 [@problem_id:1999063] 直接解决了这个误区，通过分析一个氮原子的能量构成，解释了为何两者不相等。通过理解本征值之和与总能量之间的差异，我们能更深刻地领会Kohn-Sham能量表达式中各项的物理意义，并学会如何正确解读计算结果。", "problem": "在科恩-沈（Kohn-Sham, KS）密度泛函理论（Density Functional Theory, DFT）的框架中，一个基态N电子系统的总电子能量由以下泛函给出：\n$$E[\\rho] = T_s[\\rho] + E_{ext}[\\rho] + E_H[\\rho] + E_{xc}[\\rho]$$\n在此式中，$T_s[\\rho]$ 是一个具有相同密度 $\\rho$ 的无相互作用参考系统的动能，$E_{ext}[\\rho]$ 是由外势（通常来自原子核）产生的势能，$E_H[\\rho]$ 是经典的电子-电子库仑排斥能（哈特里能量），而 $E_{xc}[\\rho]$ 是交换相关能，它包含了所有非经典的量子多体效应。\n\n电子密度 $\\rho(\\mathbf{r})$ 由一组单粒子轨道 $\\phi_i$ 构建而成，即 $\\rho(\\mathbf{r}) = \\sum_{i=1}^{N} |\\phi_i(\\mathbf{r})|^2$。这些轨道是KS方程的解：\n$$ \\left( -\\frac{\\hbar^2}{2m} \\nabla^2 + v_{eff}(\\mathbf{r}) \\right) \\phi_i(\\mathbf{r}) = \\epsilon_i \\phi_i(\\mathbf{r}) $$\n其中 $\\epsilon_i$ 是KS本征值（轨道能量）。\n\n对于一个中性氮原子（N，原子序数Z=7），一次DFT计算得到以下占据轨道的KS本征值：\n$\\epsilon_{1s} = -381.5$ eV\n$\\epsilon_{2s} = -18.6$ eV\n$\\epsilon_{2p_x} = \\epsilon_{2p_y} = \\epsilon_{2p_z} = -8.1$ eV\n\n同一次计算给出的总电子能量为 $E[\\rho] = -1483.2$ eV。占据轨道的KS本征值之和为 $\\sum_{i}^{occ} \\epsilon_i = 2 \\times (-381.5) + 2 \\times (-18.6) + 3 \\times (-8.1) = -824.5$ eV。这个和值显然不等于总电子能量。\n\n以下哪个陈述为这种差异提供了正确的物理解释？\n\nA. 本征值之和没有物理意义，其与总能量的差异是所使用的特定交换相关泛函带来的计算赝象。\n\nB. 本征值之和未能正确地计入电子-电子相互作用；具体来说，它重复计算了经典的哈特里排斥能，并且不正确地表示了交换相关能的贡献。\n\nC. 本征值之和仅代表电子的势能，差异源于完全忽略了电子的动能。\n\nD. 本征值之和准确地表示了所有电子-电子相互作用和动能的贡献，但完全忽略了电子与原子核之间的相互作用能。\n\nE. 总能量的计算存在缺陷，因为根据 Hellmann-Feynman 定理，对于任何自洽计算，总能量必须等于轨道能量之和。", "solution": "这个问题的核心是理解科恩-沈（KS）总能量 $E[\\rho]$ 与占据轨道的KS本征值之和 $\\sum_i^{occ} \\epsilon_i$ 之间的关系。\n\n我们从KS-DFT中总电子能量的表达式开始：\n$$E[\\rho] = T_s[\\rho] + E_{ext}[\\rho] + E_H[\\rho] + E_{xc}[\\rho]$$\n其中 $T_s$ 是无相互作用动能，$E_{ext}$ 是电子-原子核吸引能，$E_H$ 是经典的电子-电子（哈特里）排斥能，$E_{xc}$ 是交换相关能。\n\n现在，我们来分析占据轨道的本征值之和。KS本征值 $\\epsilon_i$ 是从KS方程得到的：\n$$H_{KS} \\phi_i = \\epsilon_i \\phi_i$$\n其中 $H_{KS}$ 是KS哈密顿量。本征值 $\\epsilon_i$ 是KS哈密顿量对于轨道 $\\phi_i$ 的期望值：\n$$ \\epsilon_i = \\langle \\phi_i | H_{KS} | \\phi_i \\rangle $$\nKS哈密顿量定义为 $H_{KS} = T_{op} + v_{eff}(\\mathbf{r})$，其中 $T_{op} = -\\frac{\\hbar^2}{2m} \\nabla^2$ 是动能算符，$v_{eff}$ 是有效势。有效势由下式给出：\n$$ v_{eff}(\\mathbf{r}) = v_{ext}(\\mathbf{r}) + v_H(\\mathbf{r}) + v_{xc}(\\mathbf{r}) $$\n在此，$v_{ext}$ 是外势，$v_H(\\mathbf{r}) = \\frac{\\delta E_H}{\\delta \\rho}$ 是哈特里势，$v_{xc}(\\mathbf{r}) = \\frac{\\delta E_{xc}}{\\delta \\rho}$ 是交换相关势。\n\n因此，占据轨道的本征值之和为：\n$$ \\sum_{i=1}^{N} \\epsilon_i = \\sum_{i=1}^{N} \\langle \\phi_i | T_{op} + v_{ext} + v_H + v_{xc} | \\phi_i \\rangle $$\n我们可以将这些项分开：\n$$ \\sum_{i=1}^{N} \\epsilon_i = \\sum_{i=1}^{N} \\langle \\phi_i | T_{op} | \\phi_i \\rangle + \\sum_{i=1}^{N} \\langle \\phi_i | v_{ext} | \\phi_i \\rangle + \\sum_{i=1}^{N} \\langle \\phi_i | v_H | \\phi_i \\rangle + \\sum_{i=1}^{N} \\langle \\phi_i | v_{xc} | \\phi_i \\rangle $$\n\n我们将这些求和项与总能量泛函的各分量进行对应：\n1.  $\\sum_{i=1}^{N} \\langle \\phi_i | T_{op} | \\phi_i \\rangle = T_s[\\rho]$，即无相互作用动能。\n2.  $\\sum_{i=1}^{N} \\langle \\phi_i | v_{ext} | \\phi_i \\rangle = \\int \\sum_{i=1}^{N} |\\phi_i(\\mathbf{r})|^2 v_{ext}(\\mathbf{r}) d\\mathbf{r} = \\int \\rho(\\mathbf{r}) v_{ext}(\\mathbf{r}) d\\mathbf{r} = E_{ext}[\\rho]$，即电子-原子核吸引能。\n3.  $\\sum_{i=1}^{N} \\langle \\phi_i | v_H | \\phi_i \\rangle = \\int \\rho(\\mathbf{r}) v_H(\\mathbf{r}) d\\mathbf{r}$。哈特里能量泛函为 $E_H[\\rho] = \\frac{1}{2} \\int \\rho(\\mathbf{r}) v_H(\\mathbf{r}) d\\mathbf{r}$。这个 $\\frac{1}{2}$ 的因子至关重要；它避免了对电子对之间相互作用的重复计算。因此，本征值之和中的这一项恰好是哈特里能量的两倍：$\\int \\rho(\\mathbf{r}) v_H(\\mathbf{r}) d\\mathbf{r} = 2E_H[\\rho]$。\n4.  $\\sum_{i=1}^{N} \\langle \\phi_i | v_{xc} | \\phi_i \\rangle = \\int \\rho(\\mathbf{r}) v_{xc}(\\mathbf{r}) d\\mathbf{r}$。这一项是交换相关势的期望值，通常不等于交换相关能量泛函 $E_{xc}[\\rho]$。\n\n所以，本征值之和为：\n$$ \\sum_{i=1}^{N} \\epsilon_i = T_s[\\rho] + E_{ext}[\\rho] + 2E_H[\\rho] + \\int \\rho(\\mathbf{r}) v_{xc}(\\mathbf{r}) d\\mathbf{r} $$\n\n现在，我们将其与总能量表达式进行比较：\n$$ E[\\rho] = T_s[\\rho] + E_{ext}[\\rho] + E_H[\\rho] + E_{xc}[\\rho] $$\n\n差异源于与电子-电子相互作用相关的两个项：\n- 本征值之和包含 $2E_H[\\rho]$，而总能量包含 $E_H[\\rho]$。本征值之和重复计算了经典的库仑排斥能。\n- 本征值之和包含项 $\\int \\rho v_{xc} d\\mathbf{r}$，而总能量包含交换相关能 $E_{xc}[\\rho]$。这两者是不同的。\n\n因此，总能量与本征值之和的关系是：\n$$ E[\\rho] = \\sum_{i=1}^{N} \\epsilon_i - E_H[\\rho] + (E_{xc}[\\rho] - \\int \\rho(\\mathbf{r}) v_{xc}(\\mathbf{r}) d\\mathbf{r}) $$\n\n本征值之和不等于总能量，因为它不正确地计入了电子-电子相互作用。我们来评估给出的选项：\nA. 错误。本征值之和具有物理意义（通过上述方程与总能量相关联），而不仅仅是一个计算赝象。\nB. 正确。该陈述准确地指出，本征值之和重复计算了哈特里能量，并且不正确地处理了交换相关能的贡献。这正是产生差异的精确原因。\nC. 错误。本征值之和明确地包含了动能项 $T_s[\\rho]$。\nD. 错误。本征值之和明确地包含了电子-原子核相互作用能 $E_{ext}[\\rho]$。\nE. 错误。Hellmann-Feynman 定理将总能量的导数与哈密顿量导数的期望值联系起来，这是一个不同的概念。没有普适的定理表明在KS-DFT中总能量必须等于轨道能量之和（这仅在无相互作用粒子的情况下成立，或者在哈特里-福克理论中，库普曼斯（Koopmans）定理提供了一种联系，但即使在那里，轨道能量之和也不等于总能量）。", "answer": "$$\\boxed{B}$$", "id": "1999063"}]}