{"hands_on_practices": [{"introduction": "理论知识的生命力在于应用。让我们从一个天体物理学的场景开始。星际空间并非完全真空，而是充满了稀薄的等离子体。当来自遥远天体的射电脉冲穿过这些星际云时，等离子体会作为一种色散介质，使不同频率成分的波以不同的速度传播。本练习将引导您运用色散关系的核心概念，通过观测到的脉冲群速度减慢这一效应，反向推算出星云介质的关键物理参数——电子数密度。[@problem_id:1815500]", "problem": "一个星际天文台探测到一个源自遥远恒星的无线电脉冲，其中心频率为 1.00 GHz。该脉冲穿过一片广阔而稀薄的星云，这片星云可以被模拟为冷的、无磁化的等离子体。由于星云的色散性质，观测到脉冲中能量的传播速度（其群速度）为真空中光速的 75.0%。假设等离子体中电磁波传播的标准模型，计算星云中自由电子的数密度。\n\n为您的计算提供以下常数：\n- 真空中的光速, $c = 2.998 \\times 10^8$ m/s\n- 自由空间的介电常数, $\\epsilon_0 = 8.854 \\times 10^{-12}$ F/m\n- 元电荷, $e = 1.602 \\times 10^{-19}$ C\n- 电子质量, $m_e = 9.109 \\times 10^{-31}$ kg\n\n将您的电子数密度答案以每立方米电子数表示，并四舍五入到三位有效数字。", "solution": "在冷的、无磁化的等离子体中，电磁波的色散关系为\n$$\\omega^{2}=\\omega_{p}^{2}+c^{2}k^{2},$$\n其中 $\\omega$ 是角频率，$k$ 是波数，而 $\\omega_{p}$ 是电子等离子体频率，由下式给出\n$$\\omega_{p}^{2}=\\frac{n_{e}e^{2}}{\\epsilon_{0}m_{e}}.$$\n群速度为\n$$v_{g}=\\frac{\\partial\\omega}{\\partial k}=\\frac{c^{2}k}{\\omega}=c\\sqrt{1-\\frac{\\omega_{p}^{2}}{\\omega^{2}}}.$$\n当 $v_{g}=0.750\\,c$ 时，我们有\n$$\\left(\\frac{v_{g}}{c}\\right)^{2}=1-\\frac{\\omega_{p}^{2}}{\\omega^{2}}\\;\\Rightarrow\\;\\frac{\\omega_{p}^{2}}{\\omega^{2}}=1-(0.750)^{2}=0.4375.$$\n令 $\\omega_{p}^{2}$ 的表达式相等并求解 $n_{e}$，得到\n$$n_{e}=\\frac{\\epsilon_{0}m_{e}}{e^{2}}\\omega^{2}\\left[1-\\left(\\frac{v_{g}}{c}\\right)^{2}\\right].$$\n当 $\\omega=2\\pi f$ 且 $f=1.00\\times 10^{9}\\,\\text{Hz}$ 时，\n$$n_{e}=\\frac{\\epsilon_{0}m_{e}}{e^{2}}\\left(2\\pi f\\right)^{2}\\left(0.4375\\right).$$\n代入给定的常数 $c=2.998\\times 10^{8}\\,\\text{m/s}$ (仅在比率中使用)，$\\epsilon_{0}=8.854\\times 10^{-12}\\,\\text{F/m}$，$e=1.602\\times 10^{-19}\\,\\text{C}$，$m_{e}=9.109\\times 10^{-31}\\,\\text{kg}$，以及 $f=1.00\\times 10^{9}\\,\\text{Hz}$，并进行计算，\n$$\\frac{\\epsilon_{0}m_{e}}{e^{2}}=\\frac{(8.854\\times 10^{-12})(9.109\\times 10^{-31})}{(1.602\\times 10^{-19})^{2}}\\approx 3.14257\\times 10^{-4},$$\n$$(2\\pi f)^{2}=4\\pi^{2}(1.00\\times 10^{9})^{2}=4\\pi^{2}\\times 10^{18},$$\n所以\n$$n_{e}\\approx \\left(3.14257\\times 10^{-4}\\right)\\left(4\\pi^{2}\\right)\\left(0.4375\\right)\\times 10^{18}\\approx 5.43\\times 10^{15}.$$\n因此，电子数密度为 $5.43\\times 10^{15}$ 电子/立方米，保留三位有效数字。", "answer": "$$\\boxed{5.43 \\times 10^{15}}$$", "id": "1815500"}, {"introduction": "色散通常被视为导致信号失真的负面效应，但在现代光学中，它也是一种可以精确操控的强大工具。在超快激光领域，工程师们巧妙地利用色散来压缩脉冲，从而获得极高峰值功率，这项技术（啁啾脉冲放大）甚至获得了诺贝尔物理学奖。本练习模拟了这一过程的核心物理原理：一个经过特殊设计的“啁啾”脉冲（其频率随时间变化）在通过一个具有正常色散的介质后，其时间宽度是如何被显著压缩的。通过亲手计算，您将深入理解色散是如何化腐朽为神奇的。[@problem_id:1815504]", "problem": "脉冲压缩器是高功率激光系统中的一个关键组件，其简化模型涉及将一个啁啾激光脉冲送入色散光学介质中。考虑一个初始为“负啁啾”的光脉冲，这意味着其瞬时频率从前沿到后沿随时间线性减小。脉冲的初始时间宽度为 $\\Delta t_{in} = 50.0 \\text{ ps}$。脉冲所跨越的总频率带宽为 $\\Delta \\omega = 2.50 \\times 10^{13} \\text{ rad/s}$。\n\n该脉冲通过一段长度为 $L = 7.60 \\text{ m}$ 的特殊光纤。该光纤材料在脉冲的带宽范围内表现出正常色散。这种色散效应由群速度色散参数 $\\beta_2 = \\frac{d^2k}{d\\omega^2} = 2.00 \\times 10^{-25} \\text{ s}^2/\\text{m}$ 来表征，其中 $k$ 是波数，$\\omega$ 是角频率。\n\n假设脉冲形状仍由其前沿和后沿的分离确定，且高阶色散效应可以忽略不计，计算脉冲离开光纤后的最终时间宽度。\n\n以皮秒（ps）为单位给出最终答案，并四舍五入到三位有效数字。", "solution": "我们通过频率相关的群延迟来模拟每个频率分量由传播引起的时间位移。设 $k(\\omega)$ 为波数，有\n$$\n\\beta_{1}(\\omega) = \\frac{dk}{d\\omega}, \\qquad \\beta_{2} = \\frac{d^{2}k}{d\\omega^{2}}.\n$$\n经过长度 $L$ 后，角频率 $\\omega$ 的群延迟为\n$$\n\\tau_{g}(\\omega) = \\beta_{1}(\\omega)\\,L.\n$$\n在脉冲中心频率 $\\omega_{0}$ 附近对 $\\beta_{1}(\\omega)$ 进行线性化，\n$$\n\\beta_{1}(\\omega) \\approx \\beta_{1}(\\omega_{0}) + \\beta_{2}\\,(\\omega - \\omega_{0}).\n$$\n对于一个负啁啾输入，考虑其前沿和后沿分别与 $\\omega_{h}$（较高频率）和 $\\omega_{l}$（较低频率）相关联。这两个频率之间的群延迟差为\n$$\n\\Delta \\tau_{g} = \\tau_{g}(\\omega_{l}) - \\tau_{g}(\\omega_{h}) = \\left[\\beta_{1}(\\omega_{l}) - \\beta_{1}(\\omega_{h})\\right]L = \\beta_{2}L(\\omega_{l} - \\omega_{h}) = -\\,\\beta_{2}L\\,\\Delta\\omega,\n$$\n其中 $\\Delta\\omega = \\omega_{h} - \\omega_{l}  0$ 是总带宽。\n\n输出时脉冲前后沿的时间间隔等于输入时间间隔加上群延迟之差：\n$$\n\\Delta t_{\\text{out}} = \\left[t_{\\text{in}}(\\omega_{l}) + \\tau_{g}(\\omega_{l})\\right] - \\left[t_{\\text{in}}(\\omega_{h}) + \\tau_{g}(\\omega_{h})\\right] = \\Delta t_{\\text{in}} + \\Delta \\tau_{g} = \\Delta t_{\\text{in}} - \\beta_{2}L\\,\\Delta\\omega.\n$$\n对于正常色散（$\\beta_{2}  0$）和负啁啾输入，这会减小脉冲宽度。代入给定值，\n$$\n\\beta_{2}L\\,\\Delta\\omega = \\left(2.00 \\times 10^{-25}\\,\\text{s}^{2}/\\text{m}\\right)\\left(7.60\\,\\text{m}\\right)\\left(2.50 \\times 10^{13}\\,\\text{s}^{-1}\\right) = 3.80 \\times 10^{-11}\\,\\text{s} = 38.0\\,\\text{ps}.\n$$\n因此，\n$$\n\\Delta t_{\\text{out}} = 50.0\\,\\text{ps} - 38.0\\,\\text{ps} = 12.0\\,\\text{ps}.\n$$\n四舍五入到三位有效数字并以皮秒表示，最终时间宽度为 $12.0$。", "answer": "$$\\boxed{12.0}$$", "id": "1815504"}, {"introduction": "解析公式为了简洁明了，往往基于理想化的假设，而要完整地观察脉冲在传播过程中的动态演化，数值模拟是不可或缺的手段。这项高级实践将引导您从理论走向实践，编写一个计算机程序来模拟光脉冲在光纤中的传播。您将通过求解慢变包络方程，亲眼见证一个代表数据比特的高斯脉冲，由于群速度色散效应而逐渐展宽的过程。这不仅能让您直观地理解光纤通信中限制传输速率的根本物理瓶颈，更能让您掌握模拟波动现象的强大计算方法。[@problem_id:2450202]", "problem": "您的任务是编写一个完整、可运行的程序，该程序构建一个模拟为高斯波包的光学数据位，在无损单模光纤中传播，并测量其时间展宽。该计算模型必须基于标量、线性缓变包络方程，这是一个从麦克斯韦方程组在缓变包络近似下推导出的、经过充分检验的、描述色散介质中脉冲演化的方程：\n$$\n\\frac{\\partial A(T,z)}{\\partial z}=\\mathrm{i}\\,\\frac{\\beta_{2}}{2}\\,\\frac{\\partial^{2}A(T,z)}{\\partial T^{2}},\n$$\n其中 $A(T,z)$ 是复场包络，$z$ 是传播坐标，$T$ 是延迟时间，定义为 $T=t-z/v_{g}$，其中 $t$ 是实验室时间，$v_{g}$ 是群速度。参数 $\\beta_{2}$ 是群速度色散系数。您必须构建在 $z=0$ 处的初始条件，作为一个变换极限高斯数据位，然后将其演化到指定距离，最后计算输出光强 $|A|^{2}$ 的半高全宽（FWHM）。所有量和结果都必须使用一致的单位处理。\n\n您的程序必须遵守以下规范。\n\n- 初始条件。使用一个具有指定光强半高全宽 $T_{\\mathrm{FWHM},0}$ 的变换极限高斯光强分布，使得光强为\n$$\nI(T,0)=|A(T,0)|^{2}=\\exp\\!\\left(-\\frac{T^{2}}{\\sigma^{2}}\\right),\n$$\n其中 $\\sigma=T_{\\mathrm{FWHM},0}/\\left(2\\sqrt{\\ln 2}\\right)$，相应的场包络为 $A(T,0)=\\exp\\!\\left(-\\frac{T^{2}}{2\\sigma^{2}}\\right)$。\n- 演化模型。使用与 $T$ 相关的时间角频率 $\\omega$ 的定义相一致的傅里叶域方法，在延迟时间 $T$ 上数值求解上述线性偏微分方程。您必须在频域中精确处理色散，并确保正确的单位转换。不包括吸收、增益、非线性或高阶色散项。\n- 测量。在指定距离 $z$ 处计算输出光强 $I(T,z)=|A(T,z)|^{2}$，并通过定位 $I(T,z)$ 等于其峰值一半的两个时间点 $T_{\\mathrm{L}}$ 和 $T_{\\mathrm{R}}$ 来估计时间光强 FWHM，必要时在相邻样本之间使用插值。报告 $T_{\\mathrm{FWHM},z}=T_{\\mathrm{R}}-T_{\\mathrm{L}}$。\n- 单位。色散参数 $\\beta_{2}$ 将以 $\\mathrm{ps}^{2}/\\mathrm{km}$ 提供，距离以 $\\mathrm{km}$ 提供。在内部转换为国际单位制（SI）：秒和米。最终答案必须以皮秒为单位的时间 FWHM 值报告。所有角度（如果出现）均以弧度为单位。\n- 离散化。对于所有测试用例，使用持续时间为 $T_{\\mathrm{span}}=4096\\,\\mathrm{ps}$、包含 $N=32768$ 个等距采样点的均匀延迟时间窗口。假设由离散傅里叶变换引入周期性边界条件。选择时间原点，使得 $T=0$ 位于计算窗口的中心。\n- 测试套件。您的程序必须为以下五个参数集计算结果，每个参数集都指定为初始光强 FWHM $T_{\\mathrm{FWHM},0}$（单位：皮秒）、色散系数 $\\beta_{2}$（单位：$\\mathrm{ps}^{2}/\\mathrm{km}$）和传播距离 $z$（单位：公里）：\n    - 情况 1：$T_{\\mathrm{FWHM},0}=10\\,\\mathrm{ps}$，$\\beta_{2}=-21\\,\\mathrm{ps}^{2}/\\mathrm{km}$，$z=50\\,\\mathrm{km}$。\n    - 情况 2：$T_{\\mathrm{FWHM},0}=10\\,\\mathrm{ps}$，$\\beta_{2}=0\\,\\mathrm{ps}^{2}/\\mathrm{km}$，$z=50\\,\\mathrm{km}$。\n    - 情况 3：$T_{\\mathrm{FWHM},0}=5\\,\\mathrm{ps}$，$\\beta_{2}=2\\,\\mathrm{ps}^{2}/\\mathrm{km}$，$z=10\\,\\mathrm{km}$。\n    - 情况 4：$T_{\\mathrm{FWHM},0}=20\\,\\mathrm{ps}$，$\\beta_{2}=-21\\,\\mathrm{ps}^{2}/\\mathrm{km}$，$z=0.5\\,\\mathrm{km}$。\n    - 情况 5：$T_{\\mathrm{FWHM},0}=30\\,\\mathrm{ps}$，$\\beta_{2}=35\\,\\mathrm{ps}^{2}/\\mathrm{km}$，$z=80\\,\\mathrm{km}$。\n- 输出。您的程序必须生成一行输出，其中包含上述情况测得的输出 FWHM 值（单位：皮秒），四舍五入到小数点后六位，并聚合成一个用方括号括起来的逗号分隔列表。例如，输出格式必须为 [$a$,$b$,$c$,$d$,$e$] 的形式，其中 $a$、$b$、$c$、$d$ 和 $e$ 是小数点后恰好有六位数字的十进制数，并且该行中不包含单位。内部计算必须如上所述保持物理单位，返回的数值必须对应于皮秒。", "solution": "该问题被判定为有效。它在科学上基于成熟的色散介质中光脉冲传播理论，由标量、线性缓变包络方程描述。该问题是适定的，提供了一个具有明确定义的初始条件和所有必要参数的线性偏微分方程。它是客观的，所有要求都以清晰、定量的术语陈述。通过指定的数值方法可以获得唯一、稳定且有意义的解。\n\n将使用分步傅里叶方法数值求解该控制偏微分方程来构建解决方案。对于给定的线性、非耦合方程，此方法不是近似，而是在频域中对解析解的精确数值实现。\n\n控制方程为：\n$$\n\\frac{\\partial A(T,z)}{\\partial z}=\\mathrm{i}\\,\\frac{\\beta_{2}}{2}\\,\\frac{\\partial^{2}A(T,z)}{\\partial T^{2}}\n$$\n其中 $A(T,z)$ 是复场包络，$z$ 是传播距离，$T$ 是延迟时间，$\\beta_{2}$ 是群速度色散参数。\n\n求解过程按以下步骤进行：\n\n1.  **单位转换与离散化**：所有输入参数首先转换为国际单位制（米、秒）以确保物理一致性。\n    -   $T_{\\mathrm{FWHM},0}$ $[\\mathrm{ps}] \\rightarrow [\\mathrm{s}]$：乘以 $10^{-12}$。\n    -   $z$ $[\\mathrm{km}] \\rightarrow [\\mathrm{m}]$：乘以 $10^3$。\n    -   $\\beta_{2}$ $[\\mathrm{ps}^{2}/\\mathrm{km}] \\rightarrow [\\mathrm{s}^{2}/\\mathrm{m}]$：乘以 $10^{-12 \\times 2} / 10^3 = 10^{-27}$。\n\n    计算域被离散化。持续时间为 $T_{\\mathrm{span}} = 4096 \\times 10^{-12}\\,\\mathrm{s}$ 的延迟时间窗口用 $N=32768$ 个点采样。这定义了时间步长 $dT = T_{\\mathrm{span}}/N$。创建一个中心化的时间网格 $T$，范围从 $-T_{\\mathrm{span}}/2$ 到 $T_{\\mathrm{span}}/2 - dT$。相应的角频率网格 $\\omega$ 是根据离散傅里叶变换的性质构建的。首先使用 `numpy.fft.fftfreq(N, d=dT)` 获得频率向量 $\\nu$，然后通过 $\\omega = 2\\pi\\nu$ 将其转换为角频率。\n\n2.  **初始条件**：在 $z=0$ 处的初始脉冲是变换极限高斯脉冲。在时间网格 $T$ 上构建复场包络 $A(T,0)$：\n    $$\n    A(T,0) = \\exp\\!\\left(-\\frac{T^{2}}{2\\sigma^{2}}\\right)\n    $$\n    参数 $\\sigma$ 根据给定的初始光强半高全宽 $T_{\\mathrm{FWHM},0}$ 计算：\n    $$\n    \\sigma = \\frac{T_{\\mathrm{FWHM},0}}{2\\sqrt{\\ln 2}}\n    $$\n    这里，所有时间变量都使用国际单位制。\n\n3.  **频域传播**：偏微分方程在频域中求解。应用定义为 $\\tilde{A}(\\omega,z) = \\mathcal{F}\\{A(T,z)\\}$ 的时间傅里叶变换 $\\mathcal{F}$，二阶导数变为乘法：$\\mathcal{F}\\{\\partial^2A/\\partial T^2\\} = (\\mathrm{i}\\omega)^2 \\tilde{A}(\\omega,z) = -\\omega^2 \\tilde{A}(\\omega,z)$。偏微分方程转化为一组非耦合的常微分方程，每个频率分量 $\\omega$ 对应一个：\n    $$\n    \\frac{d\\tilde{A}(\\omega,z)}{dz} = -\\mathrm{i}\\,\\frac{\\beta_{2}}{2}\\,\\omega^2 \\tilde{A}(\\omega,z)\n    $$\n    对于传播距离 $z$，通过将初始频谱 $\\tilde{A}(\\omega,0)$ 乘以一个传递函数（传播算子）$H(\\omega,z)$ 来找到解：\n    $$\n    \\tilde{A}(\\omega,z) = \\tilde{A}(\\omega,0) \\exp\\left(-\\mathrm{i}\\,\\frac{\\beta_{2}}{2}\\,\\omega^2 z\\right)\n    $$\n    数值算法实现此解：\n    a. 使用快速傅里叶变换（FFT）将初始场 $A(T,0)$ 变换到频域：$\\tilde{A}(\\omega,0) = \\mathrm{FFT}[A(T,0)]$。\n    b. 在离散频率网格 $\\omega$ 上构建传播算子 $H(\\omega,z)$。\n    c. 计算输出频谱：$\\tilde{A}(\\omega,z) = \\tilde{A}(\\omega,0) \\cdot H(\\omega,z)$。\n    d. 使用逆快速傅里叶变换（IFFT）将所得频谱变换回时域，以获得传播后的场包络 $A(T,z) = \\mathrm{IFFT}[\\tilde{A}(\\omega,z)]$。\n    为了正确处理 FFT 算法的频率排序，使用 `fftshift` 和 `ifftshift` 操作来处理中心化的频率和时间域。\n\n4.  **FWHM 测量**：输出光强分布计算为 $I(T,z) = |A(T,z)|^2$。然后确定半高全宽 $T_{\\mathrm{FWHM}, z}$。\n    a. 找到峰值光强 $I_{\\mathrm{peak}} = \\max_T I(T,z)$。\n    b. 半峰值是 $I_{\\mathrm{half}} = I_{\\mathrm{peak}}/2$。\n    c. 确定光强分布与 $I_{\\mathrm{half}}$ 水平线相交的两个交叉点两侧的网格点。对于左交叉点 $T_\\mathrm{L}$，设这些点为 $(T_{i-1}, I_{i-1})$ 和 $(T_i, I_i)$；对于右交叉点 $T_\\mathrm{R}$，设这些点为 $(T_j, I_j)$ 和 $(T_{j+1}, I_{j+1})$，使得 $I_{i-1}  I_{\\mathrm{half}}  I_i$ 且 $I_j  I_{\\mathrm{half}}  I_{j+1}$。\n    d. 使用线性插值法找到精确的交叉点 $T_{\\mathrm{L}}$ 和 $T_{\\mathrm{R}}$：\n    $$\n    T_{\\mathrm{L}} = T_{i-1} + (T_i - T_{i-1}) \\frac{I_{\\mathrm{half}} - I_{i-1}}{I_i - I_{i-1}}\n    $$\n    $$\n    T_{\\mathrm{R}} = T_j + (T_{j+1} - T_j) \\frac{I_{\\mathrm{half}} - I_j}{I_{j+1} - I_j}\n    $$\n    e. FWHM 计算为 $T_{\\mathrm{FWHM},z} = T_{\\mathrm{R}} - T_{\\mathrm{L}}$。\n    f. 这个结果（单位：秒）在报告前通过乘以 $10^{12}$ 转换回皮秒。\n\n此过程应用于所提供的五个测试用例中的每一个。数值实现必须小心处理所有数组索引和 FFT 移位以确保正确性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # (T_FWHM_0 [ps], beta2 [ps^2/km], z [km])\n        (10.0, -21.0, 50.0),\n        (10.0, 0.0, 50.0),\n        (5.0, 2.0, 10.0),\n        (20.0, -21.0, 0.5),\n        (30.0, 35.0, 80.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        fwhm_out_ps = solve_case(*case)\n        results.append(f\"{fwhm_out_ps:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef solve_case(t_fwhm_0_ps, beta2_ps2_km, z_km):\n    \"\"\"\n    Constructs, propagates, and measures a Gaussian wave packet for a single case.\n\n    Args:\n        t_fwhm_0_ps (float): Initial intensity FWHM in picoseconds.\n        beta2_ps2_km (float): Group-velocity dispersion in ps^2/km.\n        z_km (float): Propagation distance in kilometers.\n\n    Returns:\n        float: Output temporal intensity FWHM in picoseconds.\n    \"\"\"\n    # --- 1. Discretization and Unit Conversion ---\n\n    # Discretization parameters\n    N = 32768  # Number of points\n    T_span_ps = 4096.0  # Time window duration in ps\n\n    # Conversion factors\n    PS_TO_S = 1e-12\n    KM_TO_M = 1e3\n    PS2_KM_TO_S2_M = 1e-27  # (1e-12)^2 / 1e3\n\n    # Convert to SI units\n    t_fwhm_0_si = t_fwhm_0_ps * PS_TO_S\n    beta2_si = beta2_ps2_km * PS2_KM_TO_S2_M\n    z_si = z_km * KM_TO_M\n    T_span_si = T_span_ps * PS_TO_S\n\n    # Set up computational grids\n    dt_si = T_span_si / N\n    # Time grid (centered at T=0)\n    T_si = np.linspace(-T_span_si / 2, T_span_si / 2, N, endpoint=False)\n    # Frequency grid (in standard FFT order)\n    nu_si = np.fft.fftfreq(N, d=dt_si)\n    omega_si = 2.0 * np.pi * nu_si\n    \n    # --- 2. Initial Condition ---\n\n    # Calculate sigma from FWHM\n    sigma_si = t_fwhm_0_si / (2.0 * np.sqrt(np.log(2)))\n    \n    # Construct initial field envelope A(T, 0)\n    A_T_0 = np.exp(-T_si**2 / (2.0 * sigma_si**2))\n\n    # --- 3. Propagation Step (Fourier Domain) ---\n    \n    # The propagation operator in the frequency domain\n    # D_op = -i * beta2/2 * omega^2\n    # A(omega, z) = A(omega, 0) * exp(D_op * z)\n    propagator = np.exp(-1j * beta2_si / 2.0 * omega_si**2 * z_si)\n\n    # FFT of initial condition\n    A_omega_0 = np.fft.fft(A_T_0)\n    \n    # Apply propagator in frequency domain\n    A_omega_z = A_omega_0 * propagator\n    \n    # IFFT to get field at distance z\n    A_T_z = np.fft.ifft(A_omega_z)\n\n    # --- 4. FWHM Measurement ---\n\n    # Calculate intensity\n    I_T_z = np.abs(A_T_z)**2\n    \n    # Find peak intensity and half-max value\n    I_peak = np.max(I_T_z)\n    I_half = I_peak / 2.0\n\n    # Handle the case of no broadening\n    if beta2_si == 0:\n        return t_fwhm_0_ps\n\n    # Find indices where intensity is above half-maximum\n    # This is more robust than searching from the peak\n    above_half_max_indices = np.where(I_T_z  I_half)[0]\n    \n    if len(above_half_max_indices)  2:\n        # Not enough points above half max, something is wrong\n        # or pulse is too narrow for grid. Return 0.\n        return 0.0\n\n    # Left crossing index (first point above half max)\n    idx_L_start = above_half_max_indices[0]\n    # Right crossing index (last point above half max)\n    idx_R_end = above_half_max_indices[-1]\n\n    # Linear interpolation for left crossing T_L\n    I1, I2 = I_T_z[idx_L_start - 1], I_T_z[idx_L_start]\n    T1, T2 = T_si[idx_L_start - 1], T_si[idx_L_start]\n    T_L_si = T1 + (T2 - T1) * (I_half - I1) / (I2 - I1)\n\n    # Linear interpolation for right crossing T_R\n    I1, I2 = I_T_z[idx_R_end], I_T_z[idx_R_end + 1]\n    T1, T2 = T_si[idx_R_end], T_si[idx_R_end + 1]\n    T_R_si = T1 + (T2 - T1) * (I_half - I1) / (I2 - I1)\n\n    # Calculate FWHM\n    t_fwhm_z_si = T_R_si - T_L_si\n\n    # Convert back to picoseconds for reporting\n    return t_fwhm_z_si / PS_TO_S\n\nsolve()\n```", "id": "2450202"}]}