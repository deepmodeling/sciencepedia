{"hands_on_practices": [{"introduction": "静电学中的许多问题，例如计算设备中的电势分布，都由泊松方程描述。有限差分法 (FDM) 是一项基础技术，它通过将空间离散化为网格，把连续的微分方程转化为一个线性代数方程组。本练习将让你亲手实践如何将有限差分法应用于一个二维问题，这是数值求解偏微分方程的一项核心技能。[@problem_id:1802423]", "problem": "一块薄的方形特种半导体材料板占据了由 $0 \\le x \\le 0.3 \\text{ m}$ 和 $0 \\le y \\le 0.3 \\text{ m}$ 定义的二维区域。材料内部的静电势 $V(x,y)$ 遵循泊松方程 $\\nabla^2 V = -\\rho(x,y) / \\epsilon$，其中 $\\rho(x,y)$ 是一个空间变化的电荷密度，$\\epsilon$ 是材料的电容率。由于非均匀的掺杂分布，电荷密度与电容率之比由函数 $\\rho(x,y)/\\epsilon = Kxy$ 给出，其中 $K = 400.0 \\text{ V/m}^4$ 是一个常数。板的所有四个外边缘上的电势保持恒定为 $V=0 \\text{ V}$。\n\n为了分析电势分布，该区域被离散化为一个均匀网格，在 x 和 y 方向上的间距均为 $h=0.1 \\text{ m}$。因此，网格点位于坐标 $(ih, jh)$，其中整数 $i, j$ 的取值范围为 0 到 3。\n\n使用导数的二阶有限差分近似，计算位置 $(x,y) = (0.2 \\text{ m}, 0.2 \\text{ m})$ 处的静电势。请以伏特（V）为单位表示您的答案，并四舍五入到三位有效数字。", "solution": "我们得到的是带有狄利克雷边界条件的二维泊松方程：\n$$\n\\nabla^{2} V(x,y) = -\\frac{\\rho(x,y)}{\\epsilon} = -Kxy,\n$$\n在方形域 $0 \\leq x \\leq 0.3$ 和 $0 \\leq y \\leq 0.3$ 上，且在所有四个边界上 $V=0$。该区域以网格间距 $h=0.1$ 进行离散化，因此网格点为 $(x_{i},y_{j})=(ih,jh)$，其中 $i,j \\in \\{0,1,2,3\\}$。内部未知数位于 $(i,j)\\in\\{(1,1),(1,2),(2,1),(2,2)\\}$，对应坐标为 $(0.1,0.1)$, $(0.1,0.2)$, $(0.2,0.1)$, $(0.2,0.2)$。\n使用标准的五点二阶有限差分模板，\n$$\n\\frac{V_{i+1,j}+V_{i-1,j}+V_{i,j+1}+V_{i,j-1}-4V_{i,j}}{h^{2}}=-K x_{i} y_{j},\n$$\n或等价地，\n$$\nV_{i+1,j}+V_{i-1,j}+V_{i,j+1}+V_{i,j-1}-4V_{i,j}=-K x_{i} y_{j} h^{2}.\n$$\n令 $a=V_{1,1}$, $b=V_{1,2}$, $c=V_{2,1}$ 以及 $d=V_{2,2}$。边界值为零。当 $h=0.1$ 时，我们有 $h^{2}=0.01$。对于每个内部节点：\n- 在点 $(1,1)$ 处：$x_{1}y_{1}=(0.1)(0.1)=0.01$，所以\n$$\nc+b-4a=-K(0.01)(0.01)=-0.0001\\,K.\n$$\n- 在点 $(2,1)$ 处：$x_{2}y_{1}=(0.2)(0.1)=0.02$，所以\n$$\na+d-4c=-K(0.02)(0.01)=-0.0002\\,K.\n$$\n- 在点 $(1,2)$ 处：$x_{1}y_{2}=(0.1)(0.2)=0.02$，所以\n$$\na+d-4b=-0.0002\\,K.\n$$\n- 在点 $(2,2)$ 处：$x_{2}y_{2}=(0.2)(0.2)=0.04$，所以\n$$\nb+c-4d=-K(0.04)(0.01)=-0.0004\\,K.\n$$\n为简洁起见，定义 $s=0.0001\\,K$。该方程组变为\n$$\n\\begin{aligned}\nc+b-4a=-s,\\\\\na+d-4c=-2s,\\\\\na+d-4b=-2s,\\\\\nb+c-4d=-4s.\n\\end{aligned}\n$$\n从第二个和第三个方程，$a+d-4c=a+d-4b$ 意味着 $b=c$。令 $t=b=c$。那么第一个方程给出\n$$\n2t-4a=-s \\quad \\Rightarrow \\quad t=2a-\\frac{s}{2}.\n$$\n第四个方程给出\n$$\n2t-4d=-4s \\quad \\Rightarrow \\quad t=2d-2s.\n$$\n令这两个关于 $t$ 的表达式相等，\n$$\n2a-\\frac{s}{2}=2d-2s \\quad \\Rightarrow \\quad d=a+\\frac{3}{4}s.\n$$\n使用 $t=2a-\\frac{s}{2}$ 和第二个方程 $a+d-4t=-2s$：\n$$\na+d-4\\left(2a-\\frac{s}{2}\\right)=-2s \\quad \\Rightarrow \\quad a+d-8a+2s=-2s,\n$$\n$$\nd-7a=-4s \\quad \\Rightarrow \\quad d=7a-4s.\n$$\n令这两个关于 $d$ 的表达式相等，\n$$\na+\\frac{3}{4}s = 7a-4s \\quad \\Rightarrow \\quad 6a=\\frac{19}{4}s \\quad \\Rightarrow \\quad a=\\frac{19}{24}s.\n$$\n那么\n$$\nd=a+\\frac{3}{4}s=\\frac{19}{24}s+\\frac{18}{24}s=\\frac{37}{24}s,\n$$\n并且\n$$\nb=c=t=2a-\\frac{s}{2}=2\\cdot\\frac{19}{24}s-\\frac{1}{2}s=\\frac{38}{24}s-\\frac{12}{24}s=\\frac{26}{24}s=\\frac{13}{12}s.\n$$\n当 $K=400.0$ 时，我们有 $s=0.0001\\times 400.0=0.04$。因此，\n$$\nV(0.2,0.2)=d=\\frac{37}{24}\\times 0.04=0.061666\\ldots\n$$\n四舍五入到三位有效数字，在 $(0.2,0.2)$ 处的电势是 $0.0617$ V。", "answer": "$$\\boxed{0.0617}$$", "id": "1802423"}, {"introduction": "为了模拟电磁波如何随时间传播、变化并与材料相互作用，我们使用时域有限差分 (FDTD) 方法。FDTD 通过对空间和时间进行离散化来直接求解含时的麦克斯韦方程组，但必须修改基本算法以考虑材料的物理特性，例如电导率。这项实践要求你推导在有耗介质中的 FDTD 更新方程，让你深入理解物理属性是如何被整合到数值模拟算法中的。[@problem_id:1802437]", "problem": "在计算电磁学中，时域有限差分 (FDTD) 方法是模拟波传播的一种强大工具。考虑一个一维问题，其中电磁波沿着z轴传播。唯一的非零场分量是电场 $E_x$ 和磁场 $H_y$。传播介质是一种简单的、非磁性的 ($\\mu = \\mu_0$)、有损耗的电介质，其特征是具有恒定的介电常数 $\\epsilon$ 和恒定的电导率 $\\sigma$。\n\nFDTD 方法分别使用步长 $\\Delta z$ 和 $\\Delta t$ 对空间和时间进行离散化。场值在交错网格 (Yee元胞) 上进行计算，对于整数索引 $k$ 和时间步长 $n$，我们将 $E_x(k\\Delta z, n\\Delta t)$ 记为 $E_x^n(k)$，并将 $H_y((k+1/2)\\Delta z, (n+1/2)\\Delta t)$ 记为 $H_y^{n+1/2}(k+1/2)$。\n\n对于无损耗介质 ($\\sigma = 0$)，电场的标准 FDTD 更新方程为：\n$$E_x^{n+1}(k) = E_x^n(k) - \\frac{\\Delta t}{\\epsilon \\Delta z} \\left( H_y^{n+1/2}(k+1/2) - H_y^{n+1/2}(k-1/2) \\right)$$\n\n当介质有损耗时 ($\\sigma > 0$)，必须修改此方程以考虑传导电流。电场的新更新方程形式如下：\n$$E_x^{n+1}(k) = C_a E_x^n(k) - C_b \\left( \\frac{H_y^{n+1/2}(k+1/2) - H_y^{n+1/2}(k-1/2)}{\\Delta z} \\right)$$\n其中 $C_a$ 和 $C_b$ 是依赖于 $\\epsilon$、$\\sigma$ 和时间步长 $\\Delta t$ 的新常数。\n\n假设使用标准的半隐式中心差分格式对麦克斯韦方程组进行离散化，请确定系数之积 $C_a C_b$ 的解析表达式。请用 $\\epsilon$、$\\sigma$ 和 $\\Delta t$ 表示您的答案。", "solution": "我们从一维情况下包含传导电流的安培-麦克斯韦定律开始，该定律与给定的无损耗更新方程所隐含的符号约定一致（即在磁场空间差分项前有一个负号）：\n$$\n\\epsilon \\frac{\\partial E_{x}}{\\partial t} + \\sigma E_{x} = -\\,\\frac{\\partial H_{y}}{\\partial z}.\n$$\n对传导项使用标准的半隐式中心差分（Crank–Nicolson）格式，并在时间和空间上使用 Yee 交错网格，我们按如下方式进行离散化：\n- 将时间导数替换为关于 $E_{x}$ 的中心差分：\n$$\n\\frac{\\partial E_{x}}{\\partial t} \\Big|^{n+1/2} \\approx \\frac{E_{x}^{n+1}(k) - E_{x}^{n}(k)}{\\Delta t}.\n$$\n- 将传导项替换为时间上的平均值：\n$$\nE_{x}\\Big|^{n+1/2} \\approx \\frac{E_{x}^{n+1}(k) + E_{x}^{n}(k)}{2}.\n$$\n- 使用交错空间差分替换半个时间步长处的 $H_{y}$ 空间导数：\n$$\n\\frac{\\partial H_{y}}{\\partial z} \\Big|^{n+1/2} \\approx \\frac{H_{y}^{n+1/2}(k+1/2) - H_{y}^{n+1/2}(k-1/2)}{\\Delta z}.\n$$\n将这些离散形式代入连续方程，得到\n$$\n\\epsilon \\frac{E_{x}^{n+1}(k) - E_{x}^{n}(k)}{\\Delta t} + \\sigma \\frac{E_{x}^{n+1}(k) + E_{x}^{n}(k)}{2}\n= -\\,\\frac{H_{y}^{n+1/2}(k+1/2) - H_{y}^{n+1/2}(k-1/2)}{\\Delta z}.\n$$\n将包含 $E_{x}^{n+1}(k)$ 的项收集到左侧：\n$$\n\\left(\\frac{\\epsilon}{\\Delta t} + \\frac{\\sigma}{2}\\right) E_{x}^{n+1}(k)\n= \\left(\\frac{\\epsilon}{\\Delta t} - \\frac{\\sigma}{2}\\right) E_{x}^{n}(k)\n- \\frac{H_{y}^{n+1/2}(k+1/2) - H_{y}^{n+1/2}(k-1/2)}{\\Delta z}.\n$$\n两边同时除以 $\\left(\\frac{\\epsilon}{\\Delta t} + \\frac{\\sigma}{2}\\right)$，得到问题陈述中所要求的更新方程形式：\n$$\nE_{x}^{n+1}(k) = C_{a} E_{x}^{n}(k)\n- C_{b} \\left(\\frac{H_{y}^{n+1/2}(k+1/2) - H_{y}^{n+1/2}(k-1/2)}{\\Delta z}\\right),\n$$\n其中\n$$\nC_{a} = \\frac{\\frac{\\epsilon}{\\Delta t} - \\frac{\\sigma}{2}}{\\frac{\\epsilon}{\\Delta t} + \\frac{\\sigma}{2}},\n\\qquad\nC_{b} = \\frac{1}{\\frac{\\epsilon}{\\Delta t} + \\frac{\\sigma}{2}}.\n$$\n因此，两系数之积为\n$$\nC_{a} C_{b} = \\frac{\\frac{\\epsilon}{\\Delta t} - \\frac{\\sigma}{2}}{\\left(\\frac{\\epsilon}{\\Delta t} + \\frac{\\sigma}{2}\\right)^{2}}.\n$$\n为了将其仅用 $\\epsilon$、$\\sigma$ 和 $\\Delta t$ 表示，我们将表达式进行整理：\n$$\nC_{a} C_{b}\n= \\frac{\\Delta t}{\\epsilon}\\,\\frac{1 - \\frac{\\sigma \\Delta t}{2 \\epsilon}}{\\left(1 + \\frac{\\sigma \\Delta t}{2 \\epsilon}\\right)^{2}}.\n$$\n此即为所求的解析表达式。", "answer": "$$\\boxed{\\frac{\\Delta t}{\\epsilon}\\,\\frac{1-\\frac{\\sigma \\Delta t}{2\\epsilon}}{\\left(1+\\frac{\\sigma \\Delta t}{2\\epsilon}\\right)^{2}}}$$", "id": "1802437"}, {"introduction": "在模拟开放区域中的波传播时，我们必须防止波从计算网格的人为边界反射回来。完美匹配层 (PML) 是一种人工吸收层，旨在吸收向外传播的波而不引起反射，通常通过使用精心设计的、空间变化的电导率来实现。通过分析一个简化的 PML 一维模型，本练习揭示了这些关键边界条件背后的物理原理，从而在理论和实际仿真设置之间架起一座桥梁。[@problem_id:1802456]", "problem": "在电磁波传播的数值模拟中，例如使用时域有限差分 (FDTD) 方法时，关键在于吸收计算域边界的出射波，以模拟一个开放、无界的空间。这通常通过使用完美匹配层 (PML) 来实现，它是一种人工吸收介质。\n\n考虑一个一维场景，其中区域 $x0$ 为自由空间，其特性由介电常数 $\\epsilon_0$ 和磁导率 $\\mu_0$ 决定。PML 占据区域 $0 \\le x \\le d$。该层被建模为一种非磁性材料 ($\\mu = \\mu_0$)，其介电常数为 $\\epsilon_0$，但具有一个人为设定的、与位置相关的电导率，由下式给出：\n$$\n\\sigma(x) = \\sigma_m \\left(\\frac{x}{d}\\right)^{2}\n$$\n其中 $\\sigma_m$ 是一个常数，表示该层末端的最大电导率。\n\n一束角频率为 $\\omega$ 的单色平面电磁波沿 $+x$ 方向传播。它在 $x=0$ 处正入射到 PML 界面上。假设 PML 的设计使其在整个厚度范围内都可以被视为良介质，即对于范围 $[0, d]$ 内的所有 $x$，条件 $\\sigma(x) \\ll \\omega \\epsilon_0$ 都成立。\n\n基于此模型，确定 PML 末端 ($x=d$) 与始端 ($x=0$) 的电场振幅之比 $R$ 的闭合形式解析表达式。请用 $\\sigma_m$、$d$、$\\epsilon_0$ 和 $\\mu_0$ 表示你的答案。", "solution": "考虑时谐场，并采用 $\\exp(j \\omega t)$ 的时间约定。在线性、各向同性、导电介质中，其介电常数为 $\\epsilon$，电导率为 $\\sigma(x)$，麦克斯韦方程组可推导出一维平面波的标量亥姆霍茲方程：\n$$\n\\frac{d^{2}E}{dx^{2}} + k^{2}(x)\\,E = 0,\n$$\n其中复波数定义为\n$$\nk^{2}(x) = \\omega^{2} \\mu \\epsilon - j \\omega \\mu \\sigma(x) = \\omega^{2} \\mu \\left(\\epsilon - j \\frac{\\sigma(x)}{\\omega}\\right) \\equiv \\omega^{2} \\mu \\epsilon_{c}(x),\n$$\n其中 $\\epsilon_{c}(x) = \\epsilon - j \\sigma(x)/\\omega$。在我们的情况下，$\\mu=\\mu_{0}$ 且 $\\epsilon=\\epsilon_{0}$。\n\n在“良介质”（弱损耗）假设 $\\sigma(x) \\ll \\omega \\epsilon_{0}$ 下，将平方根展开至一阶：\n$$\nk(x) = \\omega \\sqrt{\\mu_{0} \\epsilon_{0}} \\sqrt{1 - j \\frac{\\sigma(x)}{\\omega \\epsilon_{0}}}\n\\approx \\omega \\sqrt{\\mu_{0} \\epsilon_{0}} \\left(1 - \\frac{j}{2} \\frac{\\sigma(x)}{\\omega \\epsilon_{0}}\\right)\n= k_{0} - j\\,\\alpha(x),\n$$\n其中\n$$\nk_{0} \\equiv \\omega \\sqrt{\\mu_{0} \\epsilon_{0}},\\qquad \\alpha(x) \\equiv \\frac{\\sigma(x)}{2}\\sqrt{\\frac{\\mu_{0}}{\\epsilon_{0}}}.\n$$\n那么，一个前向传播解具有如下形式：\n$$\nE(x) \\approx E(0)\\,\\exp\\!\\left(-j \\int_{0}^{x} k_{0}\\,dx'\\right)\\exp\\!\\left(-\\int_{0}^{x} \\alpha(x')\\,dx'\\right),\n$$\n因此电场振幅按以下方式衰减：\n$$\n\\frac{|E(x)|}{|E(0)|} = \\exp\\!\\left(-\\int_{0}^{x} \\alpha(x')\\,dx'\\right).\n$$\n因此，在 $x=d$ 处所求的比率 $R$ 为\n$$\nR = \\exp\\!\\left(-\\int_{0}^{d} \\alpha(x)\\,dx\\right) = \\exp\\!\\left(-\\frac{1}{2}\\sqrt{\\frac{\\mu_{0}}{\\epsilon_{0}}}\\int_{0}^{d} \\sigma(x)\\,dx\\right).\n$$\n根据给定的分布函数 $\\sigma(x) = \\sigma_{m} \\left(\\frac{x}{d}\\right)^{2}$，\n$$\n\\int_{0}^{d} \\sigma(x)\\,dx = \\sigma_{m} \\int_{0}^{d} \\left(\\frac{x}{d}\\right)^{2} dx = \\sigma_{m} \\frac{1}{d^{2}} \\left[\\frac{x^{3}}{3}\\right]_{0}^{d} = \\frac{\\sigma_{m} d}{3}.\n$$\n因此，\n$$\nR = \\exp\\!\\left(-\\frac{1}{2}\\sqrt{\\frac{\\mu_{0}}{\\epsilon_{0}}}\\,\\frac{\\sigma_{m} d}{3}\\right) = \\exp\\!\\left(-\\frac{\\sigma_{m} d}{6}\\sqrt{\\frac{\\mu_{0}}{\\epsilon_{0}}}\\right).\n$$\n由于 PML 在 $x=0$ 处是匹配的，且损耗很弱，因此反射可以忽略不计，上述表达式即为穿过该层的振幅比。", "answer": "$$\\boxed{\\exp\\!\\left(-\\frac{\\sigma_{m} d}{6}\\sqrt{\\frac{\\mu_{0}}{\\epsilon_{0}}}\\right)}$$", "id": "1802456"}]}