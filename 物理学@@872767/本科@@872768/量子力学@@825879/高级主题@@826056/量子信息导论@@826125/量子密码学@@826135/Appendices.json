{"hands_on_practices": [{"introduction": "BB84 协议的安全性取决于我们探测窃听的能力。第一个练习将探讨最直接的窃听后果：引入错误。通过计算预期的量子比特错误率（QBER），你将揭示出量子信道上窃听者存在的量化特征 [@problem_id:2111556]。", "problem": "Alice 和 Bob 希望利用量子力学原理建立一个安全的通信信道。他们采用一个简化版的 Bennett-Brassard 1984 (BB84) 量子密钥分发协议。该协议使用两个互不偏倚基在单个量子比特上编码信息：计算基（Z基），其标准正交态为 $|0\\rangle$ 和 $|1\\rangle$；以及对角基（X基），其标准正交态为 $|+\\rangle$ 和 $|-\\rangle$。这些基通过表达式 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$ 和 $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$ 相互关联。\n\n协议流程如下：对于一个长序列中的每个量子比特，Alice 随机选择一个要发送的比特（0 或 1）和一个用于编码的基（Z 或 X）。例如，要在 X 基中发送 '1'，她会将一个量子比特制备在 $|-\\rangle$ 态。Bob 在不知道 Alice 选择的情况下，随机选择一个基（Z 或 X）来测量每个传入的量子比特。\n\n一个窃听者 Eve 对每个传输的量子比特执行“拦截重发”攻击。对于她从 Alice 处拦截的每个量子比特，Eve 随机选择在 Z 基或 X 基中进行测量，每个基被选中的概率为 $1/2$。然后，她根据自己的测量结果，将一个新的量子比特制备在相应的状态并发送给 Bob。\n\n在整个序列传输完毕后，Alice 和 Bob 公开宣布他们为每个量子比特使用的基。他们丢弃所有基不匹配的情况。然后，他们比较剩下情况（基匹配的情况）中的一部分结果样本，以检查是否存在窃听。在这个匹配基的子集中，对于任意给定的量子比特，出现不一致（错误）的期望概率是多少？\n\n请用精确分数表示你的答案。", "solution": "问题要求在 Eve 进行拦截重发攻击的情况下，对于 Alice 和 Bob 选择了相同基的那些情况，Alice 发送的比特与 Bob 测量的比特之间出现不一致的期望概率。这个概率通常被称为量子比特误码率（QBER）。\n\n我们需要考虑 Alice 的基选择 $B_A$ 与 Bob 的基选择 $B_B$ 相同的通信子集。对于这种基匹配的情况，有两种场景：\n1.  Alice 和 Bob 都使用 Z 基（$B_A = B_B = Z$）。\n2.  Alice 和 Bob 都使用 X 基（$B_A = B_B = X$）。\n\n由于 Alice 和 Bob 的基选择是随机且独立的，因此在这两个场景在匹配基子集中出现的可能性是相等的。我们可以计算每种情况下的错误概率。让我们将 Eve 随机选择的基表示为 $B_E$。\n\n**情况1：Alice 和 Bob 都使用 Z 基 ($B_A = B_B = Z$)。**\n\nAlice 发送 $|0\\rangle$ 或 $|1\\rangle$。不失一般性，我们假设 Alice 通过将量子比特制备在 $|0\\rangle$ 态来发送比特 '0'。如果 Bob 测量到 '1'，则发生错误。\n\nEve 拦截了 $|0\\rangle$ 态。\n- **子情况 1a：** Eve 以 $1/2$ 的概率选择 Z 基（$B_E=Z$）。\n  她在 $\\{|0\\rangle, |1\\rangle\\}$ 基中测量 $|0\\rangle$ 态。她的测量结果将为 '0'，概率为 $|\\langle 0 | 0 \\rangle|^2 = 1$。然后她将一个处于 $|0\\rangle$ 态的新量子比特发送给 Bob。Bob 在 Z 基中测量这个状态，并以概率 1 正确地得到 '0'。这个子情况下的错误概率为 0。\n\n- **子情况 1b：** Eve 以 $1/2$ 的概率选择 X 基（$B_E=X$）。\n  她在 $\\{|+\\rangle, |-\\rangle\\}$ 基中测量 $|0\\rangle$ 态。\n  测量到 '+' 的概率为 $P_E(+) = |\\langle + | 0 \\rangle|^2 = |\\frac{1}{\\sqrt{2}}(\\langle 0| + \\langle 1|)|0\\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。然后她将 $|+\\rangle$ 发送给 Bob。\n  测量到 '-' 的概率为 $P_E(-) = |\\langle - | 0 \\rangle|^2 = |\\frac{1}{\\sqrt{2}}(\\langle 0| - \\langle 1|)|0\\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。然后她将 $|-\\rangle$ 发送给 Bob。\n  Bob 从 Eve 那里接收到量子比特，并在 Z 基中进行测量。如果他测量到 '1'，则发生错误。\n  - 如果 Bob 收到 $|+\\rangle$，测量到 '1' 的概率为 $P_B(1|+) = |\\langle 1 | + \\rangle|^2 = |\\langle 1 | \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) \\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。\n  - 如果 Bob 收到 $|-\\rangle$，测量到 '1' 的概率为 $P_B(1|-) = |\\langle 1 | - \\rangle|^2 = |\\langle 1 | \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle) \\rangle|^2 = |-\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。\n  在这个子情况中，发生错误的总概率是 Eve 发送一个导致 Bob 测量出错的状态的概率，即 $\\frac{1}{2}$。\n\n情况1的总错误概率是各子情况错误概率的加权和：\n$P(\\text{error}|B_A=B_B=Z) = P(B_E=Z) \\times P(\\text{error}|B_E=Z) + P(B_E=X) \\times P(\\text{error}|B_E=X)$\n$P(\\text{error}|B_A=B_B=Z) = \\left(\\frac{1}{2}\\right) \\times 0 + \\left(\\frac{1}{2}\\right) \\times \\left(\\frac{1}{2}\\right) = \\frac{1}{4}$。\n\n**情况2：Alice 和 Bob 都使用 X 基 ($B_A = B_B = X$)。**\n\nAlice 发送 $|+\\rangle$ 或 $|-\\rangle$。不失一般性，我们假设 Alice 在此基中发送比特 '0'，对应于 $|+\\rangle$ 态。如果 Bob 测量到 '-'，则发生错误。\n\nEve 拦截了 $|+\\rangle$ 态。\n- **子情况 2a：** Eve 以 $1/2$ 的概率选择 X 基（$B_E=X$）。\n  她在 $\\{|+\\rangle, |-\\rangle\\}$ 基中测量 $|+\\rangle$ 态。她将以概率 $|\\langle + | + \\rangle|^2 = 1$ 得到 '+'。她将 $|+\\rangle$ 发送给 Bob。Bob 在 X 基中测量，并以概率 1 正确地得到 '+'。错误概率为 0。\n\n- **子情况 2b：** Eve 以 $1/2$ 的概率选择 Z 基（$B_E=Z$）。\n  她在 $\\{|0\\rangle, |1\\rangle\\}$ 基中测量 $|+\\rangle$ 态。\n  测量到 '0' 的概率为 $P_E(0) = |\\langle 0 | + \\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。然后她将 $|0\\rangle$ 发送给 Bob。\n  测量到 '1' 的概率为 $P_E(1) = |\\langle 1 | + \\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。然后她将 $|1\\rangle$ 发送给 Bob。\n  Bob 从 Eve 那里接收到量子比特，并在 X 基中进行测量。如果他测量到 '-'，则发生错误。\n  - 如果 Bob 收到 $|0\\rangle$，测量到 '-' 的概率为 $P_B(-|0) = |\\langle - | 0 \\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。\n  - 如果 Bob 收到 $|1\\rangle$，测量到 '-' 的概率为 $P_B(-|1) = |\\langle - | 1 \\rangle|^2 = |-\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。\n  在这个子情况中，发生错误的总概率是 $\\frac{1}{2}$。\n\n情况2的总错误概率是：\n$P(\\text{error}|B_A=B_B=X) = P(B_E=X) \\times P(\\text{error}|B_E=X) + P(B_E=Z) \\times P(\\text{error}|B_E=Z)$\n$P(\\text{error}|B_A=B_B=X) = \\left(\\frac{1}{2}\\right) \\times 0 + \\left(\\frac{1}{2}\\right) \\times \\left(\\frac{1}{2}\\right) = \\frac{1}{4}$。\n\n**结论：**\n在 Alice 和 Bob 的基匹配的两种可能场景（都是 Z 基或都是 X 基）中，由 Eve 的窃听导致的错误概率恰好为 $\\frac{1}{4}$。因此，在匹配基子集中，不一致的总体期望概率是 $\\frac{1}{4}$。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "2111556"}, {"introduction": "在现实世界中，并非所有错误都意味着恶意攻击；有些错误源于环境与量子系统的相互作用。本练习将介绍一种常见的环境干扰——纯退相干，并要求你计算其导致的 QBER。这将帮助你理解在实际的 QKD 系统中，区分环境噪声和主动窃听是一项至关重要的任务 [@problem_id:2111559]。", "problem": "在一个量子通信系统中，Alice 希望使用 BB84 协议向 Bob 发送一个密钥。Alice 在两个基中的一个制备量子比特：直角 (Z) 基，其量子态为 $|0\\rangle$ 和 $|1\\rangle$；或者对角 (X) 基，其量子态为 $|+\\rangle$ 和 $|-\\rangle$。对于每次传输，她以相等的概率随机选择四个量子态 $|0\\rangle, |1\\rangle, |+\\rangle, |-\\rangle$ 中的一个。\n\n这些量子态定义如下：\n$|0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$， $|1\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n$|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$， $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$\n\n量子比特通过一个会引入纯退相干的噪声量子信道从 Alice 传输到 Bob。该信道对量子比特密度矩阵 $\\rho$ 的影响由 Kraus 算符和表示 $\\mathcal{E}(\\rho) = E_0 \\rho E_0^\\dagger + E_1 \\rho E_1^\\dagger$ 描述，其中 Kraus 算符为：\n$E_0 = \\sqrt{1-p} \\cdot I$\n$E_1 = \\sqrt{p} \\cdot Z$\n\n这里，$p$ 是发生退相干错误的概率，$I$ 是 $2 \\times 2$ 的单位矩阵，$Z$ 是泡利-Z 矩阵，$Z = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$。\n\n接收到每个量子比特后，Bob 随机选择在 Z 基或 X 基下进行测量。传输完成后，Alice 和 Bob 公开宣布他们用于每个量子比特的基序列，并丢弃所有基不匹配的情况。\n\n该协议的性能由量子比特错误率 (QBER) 来量化，QBER 是指在筛选后的密钥（即他们使用相同测量基的比特子集）中，Alice 和 Bob 拥有不同比特值的量子比特所占的比例。\n\n计算该协议的 QBER，作为退相干概率 $p$ 的函数。", "solution": "Alice 以相等的概率发送四个 BB84 量子态中的每一个。噪声信道是一个相位翻转（纯退相干）信道，由 Kraus 算符 $E_{0}=\\sqrt{1-p}\\,I$ 和 $E_{1}=\\sqrt{p}\\,Z$ 描述，因此对于任何量子比特密度矩阵 $\\rho$，\n$$\n\\mathcal{E}(\\rho)=E_{0}\\rho E_{0}^{\\dagger}+E_{1}\\rho E_{1}^{\\dagger}=(1-p)\\rho+p\\,Z\\rho Z.\n$$\nBob 在 Z 基或 X 基下进行测量，筛选后的密钥只保留 Alice 和 Bob 基匹配的事件。\n\n首先考虑 Z 基输入。对于 $|0\\rangle$ 和 $|1\\rangle$，其密度矩阵为 $\\rho_{0}=|0\\rangle\\langle 0|$ 和 $\\rho_{1}=|1\\rangle\\langle 1|$。使用 $Z|0\\rangle=|0\\rangle$ 和 $Z|1\\rangle=-|1\\rangle$，我们有\n$$\nZ\\rho_{0}Z=\\rho_{0},\\qquad Z\\rho_{1}Z=\\rho_{1}.\n$$\n因此，\n$$\n\\mathcal{E}(\\rho_{0})=(1-p)\\rho_{0}+p\\rho_{0}=\\rho_{0},\\qquad \\mathcal{E}(\\rho_{1})=\\rho_{1}.\n$$\n在 Z 基下的投影测量必然得到 Alice 发送的比特，因此在 Z 基匹配的条件下，错误概率为 $0$。\n\n接下来考虑 X 基输入。密度矩阵为\n$$\n\\rho_{+}=|+\\rangle\\langle +|=\\tfrac{1}{2}\\begin{pmatrix}1 & 1 \\\\ 1 & 1\\end{pmatrix},\\qquad\n\\rho_{-}=|-\\rangle\\langle -|=\\tfrac{1}{2}\\begin{pmatrix}1 & -1 \\\\ -1 & 1\\end{pmatrix}.\n$$\n使用 $Z|+\\rangle=|-\\rangle$ 和 $Z|-\\rangle=|+\\rangle$，我们得到\n$$\nZ\\rho_{+}Z=\\rho_{-},\\qquad Z\\rho_{-}Z=\\rho_{+},\n$$\n因此\n$$\n\\mathcal{E}(\\rho_{+})=(1-p)\\rho_{+}+p\\rho_{-},\\qquad \\mathcal{E}(\\rho_{-})=(1-p)\\rho_{-}+p\\rho_{+}.\n$$\n对于使用投影算符 $P_{+}=\\rho_{+}$ 和 $P_{-}=\\rho_{-}$ 的 X 基测量，从 $\\mathcal{E}(\\rho_{+})$ 中获得正确结果的概率是\n$$\n\\operatorname{Pr}(+|\\rho_{+})=\\operatorname{tr}(P_{+}\\mathcal{E}(\\rho_{+}))=(1-p)\\operatorname{tr}(P_{+}\\rho_{+})+p\\,\\operatorname{tr}(P_{+}\\rho_{-})=(1-p)\\cdot 1+p\\cdot 0=1-p,\n$$\n所以错误概率是 $p$。从 $\\rho_{-}$ 开始也是同样的结果。因此，在 X 基匹配的条件下，错误概率为 $p$。\n\n筛选后的密钥由所有基匹配的事件组成。Alice 选择 Z 基或 X 基的概率各为 $\\tfrac{1}{2}$，Bob 也独立地为每个基选择，概率各为 $\\tfrac{1}{2}$。在基匹配的条件下，匹配的基是 Z 的概率等于它是 X 的概率，即 $\\tfrac{1}{2}$。因此，量子比特错误率 (QBER)，定义为筛选后密钥中错误比特的比例，是加权平均值\n$$\n\\mathrm{QBER}=\\tfrac{1}{2}\\cdot 0+\\tfrac{1}{2}\\cdot p=\\tfrac{p}{2}.\n$$", "answer": "$$\\boxed{\\frac{p}{2}}$$", "id": "2111559"}, {"introduction": "探测到错误是一回事，但窃听者到底获取了多少信息？最后一个练习将超越简单的错误率，转向信息论这一强大的工具。你将计算 Alice 的密钥与 Eve 截获数据之间的香农互信息，从而为信息泄露和协议的最终安全性提供一个精确的量化度量 [@problem_id:2111588]。", "problem": "在量子密钥分发 (QKD) 的背景下，BB84协议（以其发明者 Charles Bennett 和 Gilles Brassard 的名字命名）允许通信双方（Alice 和 Bob）建立一个密钥。该密钥的安全性依赖于量子力学原理。\n\n考虑一个简化的BB84协议，其中 Alice 向 Bob 发送一串单光子。对于每个光子，她随机且独立地选择一个比特值（0或1）和一个偏振基来对其进行编码。\n这两个基是：\n1.  直线基 (+)，其中比特 `0` 被编码为水平偏振光子（状态 $|H\\rangle$)，比特 `1` 被编码为垂直偏振光子（状态 $|V\\rangle$)。\n2.  对角基 (×)，其中比特 `0` 被编码为+45°的对角偏振光子（状态 $|D\\rangle = (|H\\rangle + |V\\rangle)/\\sqrt{2}$），比特 `1` 被编码为-45°的反对角偏振光子（状态 $|A\\rangle = (|H\\rangle - |V\\rangle)/\\sqrt{2}$）。\n\n假设 Alice 对比特值和基的选择是均匀随机的，即 $P(\\text{bit}=0)=P(\\text{bit}=1)=1/2$ 且 $P(\\text{basis}=+)=P(\\text{basis}=\\times)=1/2$。\n\n一个窃听者 Eve 企图通过“拦截-重发”攻击来获取密钥。对于 Alice 发送的每一个光子，Eve 都会拦截它，测量其偏振，然后制备一个处于她所测量状态的新光子发送给 Bob。Eve 不知道 Alice 为每个光子选择的基，所以她也为每次拦截均匀随机地选择她的测量基（直线基或对角基）。\n\n令 $A$ 为代表 Alice 原始比特值的随机变量，$E$ 为代表 Eve 通过其测量获得的比特值的随机变量。两个随机变量 $X$ 和 $Y$ 之间的香农互信息是衡量它们相互依赖性的一个度量，由以下公式给出：\n$$I(X:Y) = \\sum_{x,y} p(x,y) \\log_2 \\left( \\frac{p(x,y)}{p(x)p(y)} \\right)$$\n其中 $p(x,y)$ 是 $X$ 和 $Y$ 的联合概率分布，$p(x)$ 和 $p(y)$ 是边缘概率分布。\n\n计算 Alice 的比特值与 Eve 测量的比特值之间的互信息 $I(A:E)$。请用比特作单位，并将答案四舍五入到四位有效数字。", "solution": "Alice 均匀随机地选择基和比特。Eve 在每次拦截时，也均匀随机地选择她的测量基，并将其在该基下的测量结果映射为一个比特。令 $A\\in\\{0,1\\}$ 为 Alice 的比特，$E\\in\\{0,1\\}$ 为 Eve 测量的比特。\n\n根据设定，Eve 使用与 Alice 相同基的概率为\n$$\nP(\\text{same basis})=\\frac{1}{2},\\quad P(\\text{different basis})=\\frac{1}{2}.\n$$\n物理原理（玻恩定则）：测量结果的概率由状态与测量本征态的内积的平方给出。直线基和对角基是互不相关的：例如，从 $|D\\rangle=(|H\\rangle+|V\\rangle)/\\sqrt{2}$ 和 $|A\\rangle=(|H\\rangle-|V\\rangle)/\\sqrt{2}$ 可推得\n$$\n|\\langle D|H\\rangle|^{2}=|\\langle A|H\\rangle|^{2}=\\frac{1}{2},\\quad\n|\\langle D|V\\rangle|^{2}=|\\langle A|V\\rangle|^{2}=\\frac{1}{2}.\n$$\n因此：\n- 如果 Eve 在与 Alice 相同的基中进行测量，其结果必然与 Alice 编码的比特相匹配：\n$$\nP(E=A\\mid \\text{same basis})=1,\\quad P(E\\neq A\\mid \\text{same basis})=0.\n$$\n- 如果 Eve 在不同的基中进行测量，其结果是等概率的，并且独立于 $A$：\n$$\nP(E=A\\mid \\text{different basis})=\\frac{1}{2},\\quad P(E\\neq A\\mid \\text{different basis})=\\frac{1}{2}.\n$$\n对 Eve 的基选择进行平均，得到一个从 $A$ 到 $E$ 的二进制对称信道，其交叉概率为\n$$\nq=P(E\\neq A)=\\frac{1}{2}\\cdot 0+\\frac{1}{2}\\cdot \\frac{1}{2}=\\frac{1}{4},\n$$\n所以\n$$\nP(E=A)=1-q=\\frac{3}{4}.\n$$\n由于对称性以及 $P(A=0)=P(A=1)=\\frac{1}{2}$， $E$ 的边缘分布也是均匀的：\n$$\nP(E=0)=\\frac{1}{2}\\cdot \\frac{3}{4}+\\frac{1}{2}\\cdot \\frac{1}{4}=\\frac{1}{2},\\quad P(E=1)=\\frac{1}{2}.\n$$\n\n香农互信息可以通过以下方式计算\n$$\nI(A:E)=H(E)-H(E\\mid A),\n$$\n其中熵以比特为单位，使用 $\\log_{2}$ 计算。由于 $E$ 是均匀分布的，所以 $H(E)=1$。对于交叉概率 $q=\\frac{1}{4}$ 的二进制对称信道，其条件熵是二进制熵\n$$\nH(E\\mid A)=H_{2}\\!\\left(\\frac{1}{4}\\right)=-\\frac{1}{4}\\log_{2}\\!\\left(\\frac{1}{4}\\right)-\\frac{3}{4}\\log_{2}\\!\\left(\\frac{3}{4}\\right).\n$$\n因此\n$$\nI(A:E)=1-H_{2}\\!\\left(\\frac{1}{4}\\right)\n=1-\\left[-\\frac{1}{4}\\log_{2}\\!\\left(\\frac{1}{4}\\right)-\\frac{3}{4}\\log_{2}\\!\\left(\\frac{3}{4}\\right)\\right].\n$$\n使用 $\\log_{2}\\!\\left(\\frac{1}{4}\\right)=-2$ 和 $-\\log_{2}\\!\\left(\\frac{3}{4}\\right)=\\log_{2}\\!\\left(\\frac{4}{3}\\right)$，\n$$\nH_{2}\\!\\left(\\frac{1}{4}\\right)=\\frac{1}{2}+\\frac{3}{4}\\log_{2}\\!\\left(\\frac{4}{3}\\right)\\approx 0.811278\\dots,\n$$\n所以\n$$\nI(A:E)=1-0.811278\\dots\\approx 0.1887219\\dots \\text{ bits}.\n$$\n四舍五入到四位有效数字，结果是 $0.1887$ 比特。", "answer": "$$\\boxed{0.1887}$$", "id": "2111588"}]}