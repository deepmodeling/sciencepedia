{"hands_on_practices": [{"introduction": "密度泛函理论的核心是将复杂的相互作用电子系统映射到一个辅助的无相互作用系统上。这个练习将帮助你掌握一个基本技能：如何从计算得到的科恩-尚轨道构建出系统的总电子密度，这是连接科恩-尚方程的解与理论核心变量（电子密度）的关键一步。[@problem_id:2088813]", "problem": "在密度泛函理论 (DFT) 的 Kohn-Sham 形式中，一个相互作用的电子系统被映射到一个在有效势中运动的无相互作用电子的虚拟系统。真实系统的性质，包括电子密度，便可以从这个虚拟系统的轨道计算得出。\n\n考虑一个包含两个电子的简单一维模型系统。这两个电子是自旋配对的，意味着它们的自旋相反，并且它们都占据能量最低（基态）的归一化 Kohn-Sham 空间轨道 $\\phi_0(x)$。该轨道的数学形式由下式给出：\n$$\n\\phi_0(x) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{1/4} \\exp(-\\alpha x^2)\n$$\n其中 $x$ 是位置，$\\alpha$ 是一个表征电子束缚情况的正实数常数。\n\n确定该系统的总电子密度 $n(x)$。请将你的答案表示为 $x$ 和 $\\alpha$ 的函数。", "solution": "在 Kohn-Sham DFT 中，总电子密度是通过对被占据的 Kohn-Sham 轨道的密度（包括自旋）求和得到的。对于占据相同归一化空间轨道 $\\phi_{0}(x)$ 的自旋配对电子，其密度为\n$$\nn(x) = 2\\,|\\phi_{0}(x)|^{2}.\n$$\n给定的轨道是\n$$\n\\phi_{0}(x) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{1/4} \\exp(-\\alpha x^{2}),\n$$\n所以其模的平方是\n$$\n|\\phi_{0}(x)|^{2} = \\left(\\frac{2\\alpha}{\\pi}\\right)^{1/2} \\exp(-2\\alpha x^{2}).\n$$\n因此，\n$$\nn(x) = 2 \\left(\\frac{2\\alpha}{\\pi}\\right)^{1/2} \\exp(-2\\alpha x^{2}) = \\left(\\frac{8\\alpha}{\\pi}\\right)^{1/2} \\exp(-2\\alpha x^{2}).\n$$\n作为一致性检验，对全空间进行积分可以得到总电子数：\n$$\n\\int_{-\\infty}^{\\infty} n(x)\\,dx = \\left(\\frac{8\\alpha}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} \\exp(-2\\alpha x^{2})\\,dx = \\left(\\frac{8\\alpha}{\\pi}\\right)^{1/2} \\sqrt{\\frac{\\pi}{2\\alpha}} = 2.\n$$\n这证实了该密度被正确地归一化为两个电子。", "answer": "$$\\boxed{\\left(\\frac{8\\alpha}{\\pi}\\right)^{1/2}\\exp(-2\\alpha x^{2})}$$", "id": "2088813"}, {"introduction": "尽管密度泛函理论非常强大，但其近似泛函存在一些固有的局限性，其中最著名的是自相互作用误差（SIE）。这个练习通过一个 $H_2^+$ 分子离子解离的简化模型，让你亲手计算并理解自相互作用误差如何导致对电子定域化问题（如分子解离）的定性错误描述，从而加深对近似泛函行为的认识。[@problem_id:1363355]", "problem": "在量子化学中，氢分子离子 $H_2^+$ 的解离为电子结构方法的准确性提供了一个基础的测试案例。在无限核间距 ($R \\to \\infty$) 的极限下，该体系正确地分离为一个中性氢原子 (H) 和一个裸质子 ($H^+$)。\n\n密度泛函理论 (DFT) 中的许多常用近似，例如基于广义梯度近似 (GGA) 的那些，都存在一个普遍的问题，称为自相互作用误差 (SIE)。SIE 的一个主要后果是离域电子密度的伪稳定化。对于 $H_2^+$ 的解离，这导致在 $R \\to \\infty$ 时出现定性上不正确的描述，其中单个电子被人为地离域在两个质子上。因此，该体系被错误地描述为一对相同的碎片，每个碎片由一个质子和平均半个电子组成。\n\n为了对该误差进行建模，考虑一个由这种近似DFT泛函计算出的、包含 $N$ 个电子（其中 $0 \\le N \\le 1$）的类氢碎片的基态能量的简化表达式：\n$$E_{\\text{DFT}}(N) = E_0 N + U N(1-N)$$\n此处，$E_0$ 是一个中性氢原子 ($N=1$) 的精确基态能量，而 $U$ 是一个正常数，用于参数化泛函中对于分数电子数所存在的自相互作用能的大小。\n\n在 $R \\to \\infty$ 时，解离的 $H_2^+$ 体系的精确总能量为 $E_{\\text{exact}} = E_0$。请确定该近似DFT模型所预测的在无限分离时的总能量误差 $\\Delta E = E_{\\text{total, DFT}} - E_{\\text{exact}}$。请用参数 $U$ 的封闭形式解析表达式来表示你的答案。", "solution": "在无限分离时，两个质子是无相互作用的碎片，因此近似DFT总能量是碎片能量之和。自相互作用误差导致离域，因此单个电子被平均分配，得到 $N_{A}=N_{B}=\\frac{1}{2}$ 且 $N_{A}+N_{B}=1$。\n\n对于一个电子数为 $N$ 的碎片，该模型给出\n$$\nE_{\\text{DFT}}(N)=E_{0}N+U N(1-N).\n$$\n在 $N=\\frac{1}{2}$ 处求值，\n$$\nE_{\\text{DFT}}\\!\\left(\\tfrac{1}{2}\\right)=E_{0}\\left(\\tfrac{1}{2}\\right)+U\\left(\\tfrac{1}{2}\\right)\\left(1-\\tfrac{1}{2}\\right)=\\frac{E_{0}}{2}+\\frac{U}{4}.\n$$\n因此，在 $R\\to\\infty$ 时的总近似DFT能量为\n$$\nE_{\\text{total, DFT}}=2\\,E_{\\text{DFT}}\\!\\left(\\tfrac{1}{2}\\right)=2\\left(\\frac{E_{0}}{2}+\\frac{U}{4}\\right)=E_{0}+\\frac{U}{2}.\n$$\n精确总能量为 $E_{\\text{exact}}=E_{0}$，所以误差是\n$$\n\\Delta E=E_{\\text{total, DFT}}-E_{\\text{exact}}=\\left(E_{0}+\\frac{U}{2}\\right)-E_{0}=\\frac{U}{2}.\n$$", "answer": "$$\\boxed{\\frac{U}{2}}$$", "id": "1363355"}, {"introduction": "科恩-尚轨道能的物理解释是密度泛函理论中一个微妙而重要的话题，它与哈特里-福克理论中的库普曼斯定理有所不同。这个练习将指导你计算电子亲和能的两种不同方法：一种是基于总能量差的严格定义，另一种是基于最低未占据轨道（LUMO）能量的近似。通过对比这两种方法的结果，你将能更好地理解近似泛函中“导数不连续性”缺失所带来的实际影响。[@problem_id:2384969]", "problem": "你需要实现一个完整的、可运行的程序，根据提供的总能量计算一个氧原子的电子亲和能，并将其与最低未占据分子轨道（LUMO）的 Kohn-Sham 本征值的负值进行比较。这项任务必须在密度泛函理论（DFT）的第一性原理框架下完成。\n\n你将获得以下基础作为有效的出发点：\n- Hohenberg–Kohn 定理建立了基态密度与外势之间的一一对应关系，因此总基态能量是电子密度的泛函。\n- 在 Kohn–Sham 密度泛函理论（KS-DFT）中，使用一个具有相同基态密度的无相互作用参考体系来定义 Kohn–Sham 轨道和本征值。\n- 电子亲和能定义为在原子核位置固定的情况下增加一个电子时基态能量的变化。如果中性体系有 $N$ 个电子，阴离子有 $N+1$ 个电子，那么电子亲和能定义为 $A = E(N) - E(N+1)$，其中 $E(N)$ 和 $E(N+1)$ 分别是中性体系和阴离子的基态总能量。\n- 最低未占据分子轨道的 Kohn–Sham 本征值，记作 $\\epsilon_{\\mathrm{LUMO}}$，是中性 $N$ 电子 Kohn–Sham 体系的一个属性。在精确的 KS-DFT 中，$-\\epsilon_{\\mathrm{HOMO}}$ 等于电离能，但对于电子亲和能， $A$ 和 $-\\epsilon_{\\mathrm{LUMO}}$ 之间的关系涉及到交换相关导数不连续性，因此在近似泛函中，$-\\epsilon_{\\mathrm{LUMO}}$ 通常与 $A$ 不同。\n\n你必须为每个测试用例计算以下内容：\n- 以电子伏特（electronvolt）为单位的电子亲和能 $A$，定义为 $A = E(N) - E(N+1)$，其中 $E(N)$ 和 $E(N+1)$ 以哈特里（Hartree）为单位给出。\n- 以电子伏特为单位的量 $-\\epsilon_{\\mathrm{LUMO}}$，其中 $\\epsilon_{\\mathrm{LUMO}}$ 是从 $N$ 电子 Kohn–Sham 计算中得到的，以哈特里为单位。\n- 上述两个量之间的绝对差值，以电子伏特为单位。\n\n使用转换因子 $1$ 哈特里 $= 27.211386245988$ 电子伏特。所有输出必须以电子伏特表示，并四舍五入到小数点后六位。\n\n实现程序以使用以下测试套件（每个元组为 $(E(N), E(N+1), \\epsilon_{\\mathrm{LUMO}})$，单位为哈特里）：\n- 测试用例 1：$(-75.000000, -75.053700, +0.010000)$。\n- 测试用例 2：$(-75.100000, -75.150000, -0.020000)$。\n- 测试用例 3：$(-74.900000, -74.910000, +0.050000)$。\n- 测试用例 4：$(-75.020000, -75.019000, +0.020000)$。\n\n你的程序应该：\n- 对于每个测试用例，计算 $A_{\\mathrm{eV}} = \\left(E(N) - E(N+1)\\right) \\times 27.211386245988$，$(-\\epsilon_{\\mathrm{LUMO}})_{\\mathrm{eV}} = -\\epsilon_{\\mathrm{LUMO}} \\times 27.211386245988$，以及 $\\Delta_{\\mathrm{eV}} = \\left|A_{\\mathrm{eV}} - (-\\epsilon_{\\mathrm{LUMO}})_{\\mathrm{eV}}\\right|$。\n- 将 $A_{\\mathrm{eV}}$、$(-\\epsilon_{\\mathrm{LUMO}})_{\\mathrm{eV}}$ 和 $\\Delta_{\\mathrm{eV}}$ 四舍五入到小数点后六位。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个列表的列表，每个内部列表对应一个测试用例，每个内部列表按顺序包含三个浮点数 $[A_{\\mathrm{eV}}, (-\\epsilon_{\\mathrm{LUMO}})_{\\mathrm{eV}}, \\Delta_{\\mathrm{eV}}]$，所有数值均四舍五入到小数点后六位。例如：$[[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots]$。\n\n没有用户输入。所有数值常量和测试数据都必须嵌入在程序中。所有最终数值输出都以电子伏特表示，并四舍五入到小数点后六位。", "solution": "目标是计算一个体系的电子亲和能（$A$），将其与 Kohn-Sham（KS）最低未占据分子轨道（LUMO）本征值的负值（$-\\epsilon_{\\mathrm{LUMO}}$）进行比较，并量化它们的差异。这些量在计算物理学和计算化学中是基础性的，用于解释原子和分子的电子结构。\n\n理论基础源于 DFT。一个 $N$ 电子体系的总基态能量 $E(N)$ 是基态电子密度 $\\rho(\\mathbf{r})$ 的唯一泛函。在 KS-DFT 中，这个能量是为一个能够再现 $\\rho(\\mathbf{r})$ 的无相互作用参考体系计算的，从而产生一组 KS 轨道 $\\phi_i$ 及其对应的本征值 $\\epsilon_i$。\n\n电子亲和能 $A$ 是一个热力学量，定义为中性 $N$ 电子体系与其对应的含 $N+1$ 个电子的阴离子之间的能量差。$E(N)$ 和 $E(N+1)$ 都必须是各自电子数的基态总能量。定义如下：\n$$\nA = E(N) - E(N+1)\n$$\n一个正的 $A$ 值表示阴离子在能量上比中性物种更稳定。所提供的能量单位是哈特里原子单位，必须转换为电子伏特（$\\mathrm{eV}$）。\n\n第二个量 $-\\epsilon_{\\mathrm{LUMO}}$ 源自中性 $N$ 电子体系的 KS 本征值谱。LUMO 是在 $N$ 电子基态中未被占据的能量最低的 KS 轨道。根据 Janak 定理，KS 本征值 $\\epsilon_i$ 是总能量对占据数 $n_i$ 的偏导数，即 $\\epsilon_i = \\partial E / \\partial n_i$。对于一个 $N$ 电子体系的 LUMO，$-\\epsilon_{\\mathrm{LUMO}}$ 可以被解释为对电子亲和能的一阶近似。然而，在任何近似的 DFT 泛函中，这种关系都不是精确的。$A$ 和 $-\\epsilon_{\\mathrm{LUMO}}$ 之间的差异是一个已知问题，主要归因于交换相关泛函的导数不连续性，而标准的连续泛函无法捕捉到这一点。本问题要求我们计算的正是这种差异。\n\n对于每个测试用例，给定以哈特里单位表示的输入 $(E(N), E(N+1), \\epsilon_{\\mathrm{LUMO}})$，其计算步骤如下。我们使用转换因子 $C_{\\mathrm{conv}} = 27.211386245988 \\, \\mathrm{eV}/\\mathrm{Hartree}$。\n\n1.  **计算以 $\\mathrm{eV}$ 为单位的电子亲和能**：首先计算以哈特里为单位的电子亲和能 $A_{\\mathrm{Ha}}$。\n    $$\n    A_{\\mathrm{Ha}} = E(N) - E(N+1)\n    $$\n    然后将其转换为电子伏特：\n    $$\n    A_{\\mathrm{eV}} = A_{\\mathrm{Ha}} \\times C_{\\mathrm{conv}}\n    $$\n\n2.  **计算以 $\\mathrm{eV}$ 为单位的负 LUMO 能量**：LUMO 本征值 $\\epsilon_{\\mathrm{LUMO}}$ 以哈特里为单位给出。我们计算其负值并转换为电子伏特：\n    $$\n    (-\\epsilon_{\\mathrm{LUMO}})_{\\mathrm{eV}} = -\\epsilon_{\\mathrm{LUMO}} \\times C_{\\mathrm{conv}}\n    $$\n\n3.  **计算以 $\\mathrm{eV}$ 为单位的绝对差值**：电子亲和能和负 LUMO 能量之间的绝对差值 $\\Delta_{\\mathrm{eV}}$ 是根据未四舍五入的 $\\mathrm{eV}$ 值计算的，以保持精度。\n    $$\n    \\Delta_{\\mathrm{eV}} = |A_{\\mathrm{eV}} - (-\\epsilon_{\\mathrm{LUMO}})_{\\mathrm{eV}}|\n    $$\n\n4.  **四舍五入**：最后，将得到的三个值 $A_{\\mathrm{eV}}$、$(-\\epsilon_{\\mathrm{LUMO}})_{\\mathrm{eV}}$ 和 $\\Delta_{\\mathrm{eV}}$ 按要求四舍五入到小数点后六位。\n\n该过程将系统地应用于问题陈述中提供的所有测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes electron affinity, negative LUMO energy, and their difference\n    based on provided DFT total energies and Kohn-Sham eigenvalues.\n    \"\"\"\n    # Define the conversion factor from Hartree to electronvolts.\n    HARTREE_TO_EV = 27.211386245988\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (E(N), E(N+1), epsilon_LUMO) in Hartree.\n    test_cases = [\n        (-75.000000, -75.053700, 0.010000),\n        (-75.100000, -75.150000, -0.020000),\n        (-74.900000, -74.910000, 0.050000),\n        (-75.020000, -75.019000, 0.020000),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        e_n, e_n_plus_1, eps_lumo = case\n\n        # 1. Calculate Electron Affinity (A) in eV\n        # A = E(N) - E(N+1)\n        a_hartree = e_n - e_n_plus_1\n        a_ev = a_hartree * HARTREE_TO_EV\n\n        # 2. Calculate the negative LUMO energy in eV\n        # This is -epsilon_LUMO\n        neg_eps_lumo_ev = -eps_lumo * HARTREE_TO_EV\n\n        # 3. Calculate the absolute difference in eV\n        # Delta = |A_eV - (-epsilon_LUMO)_eV|\n        delta_ev = abs(a_ev - neg_eps_lumo_ev)\n\n        # 4. Round all results to six decimal places\n        a_ev_rounded = round(a_ev, 6)\n        neg_eps_lumo_ev_rounded = round(neg_eps_lumo_ev, 6)\n        delta_ev_rounded = round(delta_ev, 6)\n\n        # Store the results for this test case\n        all_results.append([a_ev_rounded, neg_eps_lumo_ev_rounded, delta_ev_rounded])\n\n    # Format the final output string to match the required format: [[a1,b1,c1],[a2,b2,c2],...]\n    # This construction avoids extra spaces that str(list) would introduce.\n    output_parts = []\n    for res_list in all_results:\n        # Format a, b, c as floats to ensure decimal point is present even for whole numbers.\n        part = f\"[{res_list[0]},{res_list[1]},{res_list[2]}]\"\n        output_parts.append(part)\n    \n    final_output_string = f\"[{','.join(output_parts)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\n# Execute the solver function.\nsolve()\n```", "id": "2384969"}]}