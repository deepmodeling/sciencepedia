{"hands_on_practices": [{"introduction": "埃伦费斯特定理最直接的应用之一是建立量子力学期望值与经典力学定律之间的联系。这个练习旨在通过一个非谐振子势来巩固这一定理的核心思想。通过计算在给定初始波包状态下动量期望值的瞬时变化率，你将直接应用 $\\frac{d\\langle \\hat{p} \\rangle}{dt} = \\langle -\\frac{dV}{dx} \\rangle$ 这一关系，这不仅能加深你对定理的理解，还能锻炼你处理高斯波包和计算非平凡算符期望值的关键技能 [@problem_id:543546]。", "problem": "一个质量为 $m$ 的粒子在一维非谐势 $V(x) = \\frac{1}{2}k x^2 + \\lambda x^4$ 的影响下运动，其中 $k$ 和 $\\lambda$ 是正实常数。在时刻 $t=0$ 时，该粒子的量子态由归一化的波函数描述：\n$$ \\Psi(x, 0) = \\left(\\frac{2a}{\\pi}\\right)^{1/4} \\exp\\left(-a(x-x_0)^2 + \\frac{i p_0 x}{\\hbar}\\right) $$\n其中 $a > 0$，$x_0$ 和 $p_0$ 是实常数。\n\nEhrenfest 定理指出，对于在势 $V(x)$ 中运动的粒子，动量期望值的时间导数由 $\\frac{d\\langle \\hat{p} \\rangle}{dt} = \\left\\langle -\\frac{dV(\\hat{x})}{dx} \\right\\rangle$ 给出。\n\n使用该定理，确定粒子动量期望值的初始变化率 $\\frac{d\\langle \\hat{p} \\rangle}{dt}\\bigg|_{t=0}$。", "solution": "题目要求计算动量期望值的初始变化率 $\\frac{d\\langle \\hat{p} \\rangle}{dt}\\bigg|_{t=0}$。根据 Ehrenfest 定理，这由 $t=0$ 时力算符的期望值给出。\n\n首先，我们求出与势 $V(\\hat{x}) = \\frac{1}{2}k \\hat{x}^2 + \\lambda \\hat{x}^4$ 对应的力算符 $\\hat{F}$。力是势的负梯度：\n$$ \\hat{F} = -\\frac{dV(\\hat{x})}{d\\hat{x}} = -\\frac{d}{d\\hat{x}}\\left(\\frac{1}{2}k \\hat{x}^2 + \\lambda \\hat{x}^4\\right) = -k\\hat{x} - 4\\lambda\\hat{x}^3 $$\n\n现在，我们需要计算该算符在初始态 $\\Psi(x, 0)$ 下的期望值。\n$$ \\frac{d\\langle \\hat{p} \\rangle}{dt}\\bigg|_{t=0} = \\langle \\hat{F} \\rangle_{t=0} = \\langle -k\\hat{x} - 4\\lambda\\hat{x}^3 \\rangle_{t=0} $$\n\n利用期望值的线性性，上式可以写为：\n$$ \\langle \\hat{F} \\rangle_{t=0} = -k\\langle \\hat{x} \\rangle_{t=0} - 4\\lambda\\langle \\hat{x}^3 \\rangle_{t=0} $$\n\n我们现在必须计算期望值 $\\langle \\hat{x} \\rangle_{t=0}$ 和 $\\langle \\hat{x}^3 \\rangle_{t=0}$。算符 $\\hat{O}$ 的期望值由 $\\langle \\hat{O} \\rangle = \\int_{-\\infty}^{\\infty} \\Psi^*(x, 0) \\hat{O} \\Psi(x, 0) dx$ 给出。$t=0$ 时的概率密度为：\n$$ |\\Psi(x, 0)|^2 = \\Psi^*(x, 0)\\Psi(x, 0) = \\left(\\left(\\frac{2a}{\\pi}\\right)^{1/4} \\exp\\left(-a(x-x_0)^2 - \\frac{i p_0 x}{\\hbar}\\right)\\right) \\left(\\left(\\frac{2a}{\\pi}\\right)^{1/4} \\exp\\left(-a(x-x_0)^2 + \\frac{i p_0 x}{\\hbar}\\right)\\right) $$\n$$ |\\Psi(x, 0)|^2 = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\exp\\left(-2a(x-x_0)^2\\right) $$\n注意，动量项 $p_0$ 不影响概率密度。\n\n1.  **计算 $\\langle \\hat{x} \\rangle_{t=0}$：**\n    $$ \\langle \\hat{x} \\rangle_{t=0} = \\int_{-\\infty}^{\\infty} x |\\Psi(x, 0)|^2 dx = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} x e^{-2a(x-x_0)^2} dx $$\n    令 $u = x - x_0$，则 $x = u + x_0$ 且 $du = dx$。积分变为：\n    $$ \\langle \\hat{x} \\rangle_{t=0} = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} (u + x_0) e^{-2au^2} du $$\n    $$ = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\left[ \\int_{-\\infty}^{\\infty} u e^{-2au^2} du + x_0 \\int_{-\\infty}^{\\infty} e^{-2au^2} du \\right] $$\n    第一个积分是奇函数在对称区间上的积分，因此为零。对于第二个积分，我们使用标准高斯积分公式 $\\int_{-\\infty}^{\\infty} e^{-bu^2}du = \\sqrt{\\frac{\\pi}{b}}$。当 $b=2a$ 时，我们有：\n    $$ \\langle \\hat{x} \\rangle_{t=0} = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\left[ 0 + x_0 \\sqrt{\\frac{\\pi}{2a}} \\right] = x_0 $$\n\n2.  **计算 $\\langle \\hat{x}^3 \\rangle_{t=0}$：**\n    $$ \\langle \\hat{x}^3 \\rangle_{t=0} = \\int_{-\\infty}^{\\infty} x^3 |\\Psi(x, 0)|^2 dx = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} x^3 e^{-2a(x-x_0)^2} dx $$\n    使用相同的代换 $u = x-x_0$：\n    $$ \\langle \\hat{x}^3 \\rangle_{t=0} = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} (u+x_0)^3 e^{-2au^2} du $$\n    展开三次方项：$(u+x_0)^3 = u^3 + 3u^2x_0 + 3ux_0^2 + x_0^3$。\n    $$ \\langle \\hat{x}^3 \\rangle_{t=0} = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} (u^3 + 3u^2x_0 + 3ux_0^2 + x_0^3) e^{-2au^2} du $$\n    $u$ 的奇数次幂项积分为零。我们剩下：\n    $$ \\langle \\hat{x}^3 \\rangle_{t=0} = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\left[ 3x_0 \\int_{-\\infty}^{\\infty} u^2 e^{-2au^2} du + x_0^3 \\int_{-\\infty}^{\\infty} e^{-2au^2} du \\right] $$\n    我们使用已知的高斯积分。对于新的积分，$\\int_{-\\infty}^{\\infty} u^2 e^{-bu^2}du = \\frac{1}{2b}\\sqrt{\\frac{\\pi}{b}}$。当 $b=2a$ 时：\n    $$ \\int_{-\\infty}^{\\infty} u^2 e^{-2au^2} du = \\frac{1}{2(2a)}\\sqrt{\\frac{\\pi}{2a}} = \\frac{1}{4a}\\sqrt{\\frac{\\pi}{2a}} $$\n    代入积分结果：\n    $$ \\langle \\hat{x}^3 \\rangle_{t=0} = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\left[ 3x_0 \\left(\\frac{1}{4a}\\sqrt{\\frac{\\pi}{2a}}\\right) + x_0^3 \\left(\\sqrt{\\frac{\\pi}{2a}}\\right) \\right] $$\n    $$ = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\sqrt{\\frac{\\pi}{2a}} \\left[ \\frac{3x_0}{4a} + x_0^3 \\right] = \\frac{3x_0}{4a} + x_0^3 $$\n\n最后，我们将期望值代回到动量变化率的表达式中：\n$$ \\frac{d\\langle \\hat{p} \\rangle}{dt}\\bigg|_{t=0} = -k\\langle \\hat{x} \\rangle_{t=0} - 4\\lambda\\langle \\hat{x}^3 \\rangle_{t=0} $$\n$$ = -k(x_0) - 4\\lambda\\left(\\frac{3x_0}{4a} + x_0^3\\right) $$\n$$ = -kx_0 - \\frac{3\\lambda x_0}{a} - 4\\lambda x_0^3 $$\n$$ = -x_0 \\left( k + 4\\lambda x_0^2 + \\frac{3\\lambda}{a} \\right) $$", "answer": "$$ \\boxed{-x_0 \\left( k + 4\\lambda x_0^2 + \\frac{3\\lambda}{a} \\right)} $$", "id": "543546"}, {"introduction": "从理解瞬时变化到观察完整的动力学演化，是掌握物理规律的关键一步。本练习将引导你分析一个处于叠加态的粒子在无限深势阱中的行为，这是一个典型的非定态问题。通过推导位置期望值 $\\langle x \\rangle(t)$ 随时间的完整表达式，你将亲眼见证波包的“质心”如何像经典粒子一样进行周期性振荡，这为量子力学与经典力学之间的对应关系提供了生动的例证 [@problem_id:2089747]。", "problem": "一个质量为 $m$ 的粒子被限制在长度为 $L$ 的一维无限深势阱中。其势能函数为：当 $0 < x < L$ 时，$V(x) = 0$；在其他区域，$V(x) = \\infty$。该系统的归一化实值定态波函数由 $\\psi_n(x) = \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{n\\pi x}{L}\\right)$ 给出，其中 $n=1, 2, 3, \\ldots$。\n\n在时刻 $t=0$，粒子被制备于一个非定态，其归一化的波函数为：\n$$\n\\Psi(x,0) = \\frac{1}{\\sqrt{2}} \\left( \\psi_1(x) + \\psi_2(x) \\right)\n$$\n其中 $\\psi_1(x)$ 和 $\\psi_2(x)$ 分别是基态和第一激发态。\n\n确定粒子位置的期望值 $\\langle x \\rangle(t)$，对于任意时刻 $t > 0$。将你的答案表示为一个关于参数 $L$、$m$、$t$ 和约化普朗克常数 $\\hbar$ 的闭合形式解析表达式。", "solution": "无限深阱中的含时状态是通过时间演化算符由定态构造出来的。对于能量本征值为 $E_{n}$ 的定态，其时间演化由幺正演化原理给出：\n$$\n\\Psi(x,t)=\\sum_{n} c_{n}\\,\\psi_{n}(x)\\,\\exp\\!\\left(-\\frac{i E_{n} t}{\\hbar}\\right).\n$$\n已知 $\\Psi(x,0)=\\frac{1}{\\sqrt{2}}\\left(\\psi_{1}(x)+\\psi_{2}(x)\\right)$，则系数为 $c_{1}=c_{2}=1/\\sqrt{2}$，其他系数 $c_{n}=0$。因此，\n$$\n\\Psi(x,t)=\\frac{1}{\\sqrt{2}}\\left[\\psi_{1}(x)\\,\\exp\\!\\left(-\\frac{i E_{1} t}{\\hbar}\\right)+\\psi_{2}(x)\\,\\exp\\!\\left(-\\frac{i E_{2} t}{\\hbar}\\right)\\right],\n$$\n对于无限深阱，有 $E_{n}=\\frac{n^{2}\\pi^{2}\\hbar^{2}}{2 m L^{2}}$。\n\n位置的期望值为\n$$\n\\langle x\\rangle(t)=\\int_{0}^{L}\\Psi^{*}(x,t)\\,x\\,\\Psi(x,t)\\,dx.\n$$\n代入 $\\Psi(x,t)$ 并利用 $\\psi_{n}(x)$ 的实数性质，可得\n$$\n\\langle x\\rangle(t)=\\frac{1}{2}\\left[\\langle 1|x|1\\rangle+\\langle 2|x|2\\rangle+\\exp\\!\\left(-\\frac{i\\Delta E\\, t}{\\hbar}\\right)\\langle 1|x|2\\rangle+\\exp\\!\\left(\\frac{i\\Delta E\\, t}{\\hbar}\\right)\\langle 2|x|1\\rangle\\right],\n$$\n其中 $\\Delta E=E_{2}-E_{1}$ 且 $\\langle n|x|m\\rangle=\\int_{0}^{L}\\psi_{n}(x)\\,x\\,\\psi_{m}(x)\\,dx$。由于 $x$ 是厄米算符且基是实数的，因此 $\\langle 2|x|1\\rangle=\\langle 1|x|2\\rangle$，交叉项合并为 $2\\langle 1|x|2\\rangle\\cos\\!\\left(\\frac{\\Delta E\\, t}{\\hbar}\\right)$：\n$$\n\\langle x\\rangle(t)=\\frac{1}{2}\\left[\\langle 1|x|1\\rangle+\\langle 2|x|2\\rangle\\right]+\\langle 1|x|2\\rangle\\,\\cos\\!\\left(\\frac{\\Delta E\\, t}{\\hbar}\\right).\n$$\n\n计算对角元 $\\langle n|x|n\\rangle$：\n$$\n\\langle n|x|n\\rangle=\\frac{2}{L}\\int_{0}^{L}x\\sin^{2}\\!\\left(\\frac{n\\pi x}{L}\\right)\\,dx.\n$$\n使用 $\\sin^{2}\\theta=\\frac{1}{2}\\left(1-\\cos 2\\theta\\right)$ 以及积分 $J(k)=\\int_{0}^{L}x\\cos(kx)\\,dx=\\left[\\frac{x\\sin(kx)}{k}+\\frac{\\cos(kx)-1}{k^{2}}\\right]_{0}^{L}$，当 $k=\\frac{2n\\pi}{L}$ 时，有 $\\sin(kL)=0$ 和 $\\cos(kL)=1$，我们得到 $J(k)=0$。因此，\n$$\n\\langle n|x|n\\rangle=\\frac{2}{L}\\cdot\\frac{1}{2}\\int_{0}^{L}x\\,dx=\\frac{2}{L}\\cdot\\frac{1}{2}\\cdot\\frac{L^{2}}{2}=\\frac{L}{2}.\n$$\n因此 $\\frac{1}{2}\\left[\\langle 1|x|1\\rangle+\\langle 2|x|2\\rangle\\right]=\\frac{L}{2}$。\n\n现在计算非对角元 $\\langle 1|x|2\\rangle$：\n$$\n\\langle 1|x|2\\rangle=\\frac{2}{L}\\int_{0}^{L}x\\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)dx.\n$$\n使用 $\\sin\\alpha\\sin\\beta=\\frac{1}{2}\\left[\\cos(\\alpha-\\beta)-\\cos(\\alpha+\\beta)\\right]$。令 $a=\\frac{\\pi}{L}$ 和 $b=\\frac{2\\pi}{L}$。那么\n$$\n\\int_{0}^{L}x\\sin(ax)\\sin(bx)\\,dx=\\frac{1}{2}\\left[J(a-b)-J(a+b)\\right],\n$$\n其中 $J(k)$ 如上所示。对于 $k_{1}=a-b=-\\frac{\\pi}{L}$，有 $k_{1}L=-\\pi$，所以 $\\sin(k_{1}L)=0$ 且 $\\cos(k_{1}L)=-1$，得到 $J(k_{1})=-\\frac{2}{k_{1}^{2}}=-\\frac{2L^{2}}{\\pi^{2}}$。对于 $k_{2}=a+b=\\frac{3\\pi}{L}$，有 $k_{2}L=3\\pi$，给出 $J(k_{2})=-\\frac{2}{k_{2}^{2}}=-\\frac{2L^{2}}{9\\pi^{2}}$。因此，\n$$\n\\int_{0}^{L}x\\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)dx=\\frac{1}{2}\\left(-\\frac{2L^{2}}{\\pi^{2}}+\\frac{2L^{2}}{9\\pi^{2}}\\right)=-\\frac{8L^{2}}{9\\pi^{2}},\n$$\n于是\n$$\n\\langle 1|x|2\\rangle=\\frac{2}{L}\\left(-\\frac{8L^{2}}{9\\pi^{2}}\\right)=-\\frac{16L}{9\\pi^{2}}.\n$$\n\n能量差为\n$$\n\\Delta E=E_{2}-E_{1}=\\frac{(4-1)\\pi^{2}\\hbar^{2}}{2 m L^{2}}=\\frac{3\\pi^{2}\\hbar^{2}}{2 m L^{2}},\n$$\n所以 $\\frac{\\Delta E}{\\hbar}=\\frac{3\\pi^{2}\\hbar}{2 m L^{2}}$。将所有部分组合起来，\n$$\n\\langle x\\rangle(t)=\\frac{L}{2}-\\frac{16L}{9\\pi^{2}}\\cos\\!\\left(\\frac{3\\pi^{2}\\hbar}{2 m L^{2}}\\,t\\right).\n$$\n这就是所要求的以 $L$、$m$、$t$ 和 $\\hbar$ 表示的闭合形式表达式。", "answer": "$$\\boxed{\\frac{L}{2}-\\frac{16L}{9\\pi^{2}}\\cos\\!\\left(\\frac{3\\pi^{2}\\hbar}{2 m L^{2}}\\,t\\right)}$$", "id": "2089747"}, {"introduction": "现代物理学研究越来越依赖于计算模拟来探索和验证理论。这个综合性练习将理论与计算实践相结合，要求你编写程序来模拟波包在线性势垒中的演化过程。你的任务是通过数值求解含时薛定谔方程，并跟踪动量期望值的变化，从而定量地验证埃伦费斯特定理。这个练习不仅能让你体验到如何将抽象的量子方程转化为可执行的算法，更能够让你“看到”平均意义上的量子动力学如何精确地遵循经典牛顿第二定律 [@problem_id:2450185]。", "problem": "您需要编写一个完整、可运行的程序，模拟一维非相对论量子波包在线性势下的时间演化，并定量验证关于动量期望值的 Ehrenfest 定理。在一个无量纲单位制中进行计算，其中约化普朗克常数 $\\hbar$ 等于 $1$，粒子质量 $m$ 等于 $1$。动力学由含时薛定谔方程决定\n$$\ni \\,\\partial_t \\psi(x,t) \\;=\\; \\left[-\\tfrac{1}{2}\\,\\partial_{x}^2 \\;+\\; V(x)\\right]\\psi(x,t),\n$$\n其中线性势为\n$$\nV(x) \\;=\\; \\alpha\\,x,\n$$\n此处 $\\alpha$ 是一个实常数。在时间 $t=0$ 时，波包应为一个归一化的高斯最小不确定度态，中心位于位置 $x_0$，均方根宽度为 $\\sigma$，平均波数为 $k_0$，\n$$\n\\psi(x,0) \\;\\propto\\; \\exp\\!\\left(-\\frac{(x-x_0)^2}{4\\sigma^2} + i\\,k_0\\,x\\right),\n$$\n归一化满足\n$$\n\\int_{-\\infty}^{\\infty} |\\psi(x,0)|^2\\,dx \\;=\\; 1.\n$$\n在一个长度为 $L$、离散为 $N$ 个等距格点的一维有限周期性空间域上，从给定的初始状态开始，以均匀时间步长 $\\Delta t$ 模拟总时间 $T = N_t\\,\\Delta t$ 内的演化。在每个时间 $t$，动量的期望值由内积定义为\n$$\n\\langle p \\rangle(t) \\;=\\; \\int_{-L/2}^{L/2} \\psi^*(x,t)\\, \\left(-i\\,\\partial_x\\right)\\,\\psi(x,t)\\,dx.\n$$\nEhrenfest 定理表明\n$$\n\\frac{d}{dt}\\langle p \\rangle(t) \\;=\\; -\\left\\langle \\frac{\\partial V}{\\partial x} \\right\\rangle(t).\n$$\n对于线性势 $V(x)=\\alpha x$，我们有 $\\partial_x V(x)=\\alpha$，因此\n$$\n\\frac{d}{dt}\\langle p \\rangle(t) \\;=\\; -\\alpha.\n$$\n您的程序必须对每个指定的测试用例，通过线性最小二乘法估计函数 $\\langle p \\rangle(t)$ 在整个模拟区间 $[0,T]$ 上关于 $t$ 的最佳拟合斜率 $s$，然后将 $s$ 与理论值 $-\\alpha$ 进行比较。对于每个测试，报告一个布尔值，指示其绝对偏差是否满足\n$$\n|\\,s - (-\\alpha)\\,| \\;\\le\\; \\tau,\n$$\n其中 $\\tau$ 是给定的容差。\n\n使用以下参数集测试套件。所有符号的定义如上，所有数值均为无量纲。空间域在 $[-L/2,\\,L/2)$ 上是周期性的，并且所有测试都使用相同的网格和时间参数。\n- 通用模拟参数：$L = 200$， $N = 1024$， $\\Delta t = 0.002$， $N_t = 1500$， $\\sigma = 5$， $x_0 = -50$。\n- 测试集 A (一般情况)：$\\alpha = 0.2$， $k_0 = 3.0$， 容差 $\\tau = 0.03$。\n- 测试集 B (自由演化边界情况)：$\\alpha = 0.0$， $k_0 = 2.0$， 容差 $\\tau = 0.02$。\n- 测试集 C (负斜坡情况)：$\\alpha = -0.3$， $k_0 = 0.0$， 容差 $\\tau = 0.03$。\n\n您的程序必须输出一行，其中包含一个布尔值列表，按 A、B、C 的顺序对应三个测试，如果该测试满足条件，则相应的布尔值为真，否则为假。确切的输出格式要求为一行的形式\n$$\n[\\text{result\\_A},\\text{result\\_B},\\text{result\\_C}],\n$$\n例如， $[{\\rm True},{\\rm False},{\\rm True}]$。", "solution": "所述问题是有效的。这是一个在计算量子力学中定义明确的问题，基于可靠的物理和数学原理，并为完整的数值求解提供了所有必要的参数。我们将着手构建解决方案。\n\n任务是模拟由含时薛定谔方程支配的一维量子波包 $\\psi(x,t)$ 的时间演化。在指定的约化普朗克常数 $\\hbar=1$ 和粒子质量 $m=1$ 的无量纲单位制中，该方程为：\n$$\ni \\,\\frac{\\partial \\psi(x,t)}{\\partial t} = \\hat{H}\\psi(x,t) = \\left[-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} + V(x)\\right]\\psi(x,t)\n$$\n势是一个线性斜坡，$V(x) = \\alpha x$。在时间间隔 $\\Delta t$ 内演化的形式解由时间演化算符的作用给出，$\\psi(x, t+\\Delta t) = e^{-i\\hat{H}\\Delta t} \\psi(x,t)$。\n\n为了数值实现这一点，我们采用分步傅里叶方法，该方法对于这类问题高效且稳定。哈密顿算符 $\\hat{H}$ 是动能算符 $\\hat{T} = -\\frac{1}{2}\\partial_x^2$ 和势能算符 $\\hat{V} = V(x)$ 的和。由于 $\\hat{T}$ 和 $\\hat{V}$ 不对易，它们的和的指数函数需要被近似。我们使用二阶精度的对称 Strang 分裂：\n$$\ne^{-i(\\hat{T}+\\hat{V})\\Delta t} \\approx e^{-i\\hat{V}\\Delta t/2} \\, e^{-i\\hat{T}\\Delta t} \\, e^{-i\\hat{V}\\Delta t/2} + O(\\Delta t^3)\n$$\n这种分解使我们能够在各自的首选基中处理每个算符。$e^{-i\\hat{V}\\Delta t/2}$ 的作用是在位置空间中的简单乘法。$e^{-i\\hat{T}\\Delta t}$ 的作用是在动量（傅里叶）空间中的简单乘法。这些空间之间的转换通过快速傅里叶变换（FFT）高效处理。\n\n将波函数从时间 $t_n$ 推进到 $t_{n+1} = t_n + \\Delta t$ 的算法包括以下步骤：\n1.  在位置空间中应用第一个半步势算符：$\\psi' = e^{-iV(x)\\Delta t/2} \\psi(x,t_n)$。\n2.  使用 FFT 变换到动量空间：$\\tilde{\\psi}' = \\mathcal{F}\\{\\psi'\\}$。\n3.  在动量空间中应用完整的动能算符步骤：$\\tilde{\\psi}'' = e^{-i k^2 \\Delta t/2} \\tilde{\\psi}'$，其中 $k$ 是波数。\n4.  使用逆 FFT 变换回位置空间：$\\psi'' = \\mathcal{F}^{-1}\\{\\tilde{\\psi}''\\}$。\n5.  应用第二个半步势算符：$\\psi(x,t_{n+1}) = e^{-iV(x)\\Delta t/2} \\psi''$。\n\n这个过程重复 $N_t$ 次，以模拟总时间 $T = N_t \\Delta t$ 内的演化。\n\n模拟在离散网格上进行。空间域 $[-L/2, L/2)$ 被离散为 $N$ 个点，得到网格间距 $\\Delta x = L/N$。$t=0$ 时的初始状态是一个归一化的高斯波包，定义为：\n$$\n\\psi(x,0) = A \\cdot \\exp\\left(-\\frac{(x-x_0)^2}{4\\sigma^2} + i k_0 x\\right)\n$$\n归一化常数 $A = (2\\pi\\sigma^2)^{-1/4}$ 确保 $\\int|\\psi|^2 dx = 1$。对于数值实现，波函数在离散网格上初始化，然后进行数值重新归一化以强制满足 $\\sum_j |\\psi_j|^2 \\Delta x = 1$。\n\n主要目标是验证关于动量期望值 $\\langle p \\rangle(t)$ 的 Ehrenfest 定理：\n$$\n\\frac{d}{dt}\\langle p \\rangle(t) = \\left\\langle -\\frac{\\partial V}{\\partial x} \\right\\rangle(t)\n$$\n对于势 $V(x)=\\alpha x$，力是恒定的，$-\\partial V/\\partial x = -\\alpha$。这意味着动量的期望值应随时间线性变化，斜率为 $-\\alpha$：\n$$\n\\frac{d}{dt}\\langle p \\rangle(t) = -\\alpha\n$$\n在每个时间步 $t_n$，我们必须计算 $\\langle p \\rangle(t_n)$。这由积分给出：\n$$\n\\langle p \\rangle(t) = \\int \\psi^*(x,t) \\hat{p} \\psi(x,t) dx = \\int \\psi^*(x,t) \\left(-i\\frac{\\partial}{\\partial x}\\right) \\psi(x,t) dx\n$$\n为了与谱演化方法保持最大精度和一致性，空间导数 $\\partial_x \\psi$ 使用 FFT 计算：$\\partial_x \\psi = \\mathcal{F}^{-1}\\{ i k \\mathcal{F}\\{\\psi\\} \\}$。然后积分被计算为网格点上的和。对于像动量这样的厄米算符，期望值 $\\langle p \\rangle$ 必须是实数；任何由数值不精确性产生的微小虚部都将被丢弃。\n\n模拟结束后，会得到一个动量期望值的时间序列 $(\\_\\{t_n, \\langle p \\rangle(t_n)\\}\\_)$，其中 $n=0, \\ldots, N_t$。对这些数据执行线性最小二乘回归以确定数值斜率 $s$。`numpy.polyfit` 函数适合此任务。\n\n最后，对每个测试用例，将计算出的斜率 $s$ 与理论值 $-\\alpha$ 进行比较。评估布尔条件 $|\\,s - (-\\alpha)\\,| \\leq \\tau$，并将所有测试的结果整合到指定的输出格式中。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the simulation for all test cases and print the results.\n    \"\"\"\n\n    def run_simulation(L, N, dt, Nt, sigma, x0, alpha, k0, tau):\n        \"\"\"\n        Simulates the time evolution of a 1D Gaussian wave packet in a linear potential\n        and quantitatively verifies Ehrenfest's theorem for momentum.\n\n        Args:\n            L (float): Length of the periodic spatial domain.\n            N (int): Number of grid points.\n            dt (float): Time step for the simulation.\n            Nt (int): Total number of time steps.\n            sigma (float): Initial root-mean-square width of the wave packet.\n            x0 (float): Initial center position of the wave packet.\n            alpha (float): Slope of the linear potential V(x) = alpha * x.\n            k0 (float): Initial mean wavenumber of the wave packet.\n            tau (float): Tolerance for comparing the theoretical and numerical slopes.\n\n        Returns:\n            bool: True if the absolute deviation between the measured slope and the\n                  theoretical slope (-alpha) is within the tolerance tau, False otherwise.\n        \"\"\"\n        # 1. Setup of Computational Grids\n        # Spatial grid (domain from -L/2 to L/2)\n        dx = L / N\n        x = np.linspace(-L / 2.0, L / 2.0 - dx, N)\n        # Wavenumber (momentum) grid for FFT\n        k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n        # 2. Initialization of the Wave Packet\n        # Analytic normalization constant for an infinite domain\n        norm_factor = (2 * np.pi * sigma**2)**(-0.25)\n        # Initial wave function (Gaussian packet)\n        psi = norm_factor * np.exp(-(x - x0)**2 / (4 * sigma**2) + 1j * k0 * x)\n        # Numerical normalization on the discrete periodic grid\n        psi /= np.sqrt(np.sum(np.abs(psi)**2) * dx)\n\n        # 3. Preparation of Time Evolution Operators\n        # These are pre-calculated for efficiency in the loop.\n        # Potential operator for a half time step in position space\n        V_op_half = np.exp(-0.5j * (alpha * x) * dt)\n        # Kinetic operator for a full time step in momentum space\n        T_op_full = np.exp(-0.5j * k**2 * dt)\n\n        # Arrays for storing data at each time step for final analysis\n        times = np.zeros(Nt + 1)\n        p_expectations = np.zeros(Nt + 1)\n\n        # 4. Time Evolution via Split-Step Fourier Method\n        for i in range(Nt + 1):\n            # Store current time\n            times[i] = i * dt\n\n            # Calculate and store the expectation value of momentum", "id": "2450185"}]}