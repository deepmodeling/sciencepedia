{"hands_on_practices": [{"introduction": "任何有限元仿真的第一步都是为物理系统建立正确的偏微分方程（PDE）。本练习聚焦于一个包含多种材料区域的二维静磁学问题，旨在演示如何利用磁矢量势来应用安培定律。掌握如何针对不同区域（例如，载流线圈和磁芯）设置正确的控制方程，是电磁学有限元分析的一项基本技能。[@problem_id:1616428]", "problem": "一位工程师的任务是使用有限元法（FEM）对一个长电磁致动器中的磁场分布进行建模。该致动器在$xy$平面上的横截面由三个不同的区域组成：一个中心铁芯（$\\Omega_{iron}$），铁芯内的一个非同心圆柱形气隙（$\\Omega_{air}$），以及围绕铁芯的铜线圈区域（$\\Omega_{coil}$）。铁芯由一种具有恒定相对磁导率 $\\mu_r$ 的软磁材料制成，因此其磁导率为 $\\mu_{iron} = \\mu_r \\mu_0$。气隙和铜线圈区域被假定具有真空磁导率 $\\mu_0$。线圈中通有稳定、均匀的直流电（DC），在$\\Omega_{coil}$区域内产生轴向电流密度 $\\mathbf{J} = J_z \\hat{k}$，而在其他地方电流密度为零。\n\n由于系统的长度很长，该问题可以被视为二维问题。磁场由电流 $J_z$ 产生，需求解的合适的势是磁矢量势的$z$分量，即 $A_z(x, y)$。整个致动器在一个大的边界框内进行计算建模，并且在该框的外边界 $\\Gamma_{box}$ 上，假定磁矢量势为零，即 $A_z = 0$。\n\n为建立仿真，工程师必须为三个区域（$\\Omega_{iron}$、$\\Omega_{air}$、$\\Omega_{coil}$）中的每一个区域定义 $A_z$ 的控制偏微分方程。下列哪组方程正确地描述了待有限元法软件求解的物理问题？\n\nA. 该问题在所有区域均由拉普拉斯方程描述：\n- 在 $\\Omega_{iron}$ 中：$-\\nabla^2 A_z = 0$\n- 在 $\\Omega_{air}$ 中：$-\\nabla^2 A_z = 0$\n- 在 $\\Omega_{coil}$ 中：$-\\nabla^2 A_z = 0$\n\nB. 该问题由一个泊松方程描述，其中源项 $J_z$ 存在于所有区域：\n- 在 $\\Omega_{iron}$ 中：$-\\nabla \\cdot (\\frac{1}{\\mu_{iron}} \\nabla A_z) = J_z$\n- 在 $\\Omega_{air}$ 中：$-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = J_z$\n- 在 $\\Omega_{coil}$ 中：$-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = J_z$\n\nC. 该问题由一组方程描述，其中源项 $J_z$ 仅在线圈区域非零：\n- 在 $\\Omega_{iron}$ 中：$-\\nabla \\cdot (\\frac{1}{\\mu_{iron}} \\nabla A_z) = 0$\n- 在 $\\Omega_{air}$ 中：$-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = 0$\n- 在 $\\Omega_{coil}$ 中：$-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = J_z$\n\nD. 该问题由一个不正确的公式描述，该公式不恰当地使用了磁导率而非磁阻率：\n- 在 $\\Omega_{iron}$ 中：$-\\nabla \\cdot (\\mu_{iron} \\nabla A_z) = 0$\n- 在 $\\Omega_{air}$ 中：$-\\nabla \\cdot (\\mu_0 \\nabla A_z) = 0$\n- 在 $\\Omega_{coil}$ 中：$-\\nabla \\cdot (\\mu_0 \\nabla A_z) = J_z$\n\nE. 该问题由单一形式的泊松方程 $-\\nabla^2 A_z = \\mu J_z$ 描述，并应用于所有区域：\n- 在 $\\Omega_{iron}$ 中：$-\\nabla^2 A_z = \\mu_{iron} J_z$\n- 在 $\\Omega_{air}$ 中：$-\\nabla^2 A_z = \\mu_0 J_z$\n- 在 $\\Omega_{coil}$ 中：$-\\nabla^2 A_z = \\mu_0 J_z$", "solution": "我们在静磁学框架下，使用麦克斯韦方程组和磁矢量势进行分析。控制方程为\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J}, \\quad \\nabla \\cdot \\mathbf{B} = 0, \\quad \\mathbf{B} = \\mu \\mathbf{H}, \\quad \\mathbf{B} = \\nabla \\times \\mathbf{A}.\n$$\n在二维设定中，选择仅有非零轴向分量的磁矢量势，我们设 $\\mathbf{A} = A_{z}(x,y)\\,\\hat{k}$。则\n$$\n\\mathbf{B} = \\nabla \\times \\mathbf{A} = \\left(\\frac{\\partial A_{z}}{\\partial y}\\right)\\hat{i} - \\left(\\frac{\\partial A_{z}}{\\partial x}\\right)\\hat{j} + 0\\,\\hat{k}.\n$$\n使用本构关系 $\\mathbf{H} = \\frac{1}{\\mu}\\mathbf{B}$（其中 $\\mu$ 为标量、分段常数），我们得到\n$$\nH_{x} = \\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial y}, \\quad H_{y} = -\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial x}.\n$$\n安培定律给出了$z$分量的源方程：\n$$\nJ_{z} = \\left(\\nabla \\times \\mathbf{H}\\right)_{z} = \\frac{\\partial H_{y}}{\\partial x} - \\frac{\\partial H_{x}}{\\partial y}.\n$$\n代入 $H_{x}$ 和 $H_{y}$，\n$$\nJ_{z} = \\frac{\\partial}{\\partial x}\\left(-\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial x}\\right) - \\frac{\\partial}{\\partial y}\\left(\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial y}\\right)\n= -\\frac{\\partial}{\\partial x}\\left(\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial x}\\right) - \\frac{\\partial}{\\partial y}\\left(\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial y}\\right).\n$$\n这可以紧凑地写为\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu}\\nabla A_{z}\\right) = J_{z}.\n$$\n外边界上的边界条件为在 $\\Gamma_{box}$ 上 $A_{z} = 0$。\n\n材料属性是分段常数：\n$$\n\\mu = \\mu_{iron} = \\mu_{r}\\mu_{0} \\text{ in } \\Omega_{iron}, \\quad \\mu = \\mu_{0} \\text{ in } \\Omega_{air}, \\quad \\mu = \\mu_{0} \\text{ in } \\Omega_{coil}.\n$$\n源电流密度是轴向的，并且局限于线圈区域：\n$$\nJ_{z} \\neq 0 \\text{ in } \\Omega_{coil}, \\quad J_{z} = 0 \\text{ in } \\Omega_{iron} \\cup \\Omega_{air}.\n$$\n因此，每个区域的控制偏微分方程为\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu_{iron}}\\nabla A_{z}\\right) = 0 \\quad \\text{in } \\Omega_{iron},\n$$\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu_{0}}\\nabla A_{z}\\right) = 0 \\quad \\text{in } \\Omega_{air},\n$$\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu_{0}}\\nabla A_{z}\\right) = J_{z} \\quad \\text{in } \\Omega_{coil}.\n$$\n这与选项C相符。选项A忽略了线圈中的源项。选项B错误地将源项应用于所有区域。选项D在微分算子中错误地使用了 $\\mu$ 而不是 $1/\\mu$。选项E使用 $-\\nabla^{2}A_{z}=\\mu J_{z}$；虽然这在具有恒定 $\\mu$ 的单个均匀区域内是等效的，但它不是跨越具有不同 $\\mu$ 的多个区域所需的正确非均匀公式，而且它还误导性地在必须明确强制 $J_{z}=0$ 的区域中呈现了源项。因此，正确的公式是选项C。", "answer": "$$\\boxed{C}$$", "id": "1616428"}, {"introduction": "有限元方法将连续的偏微分方程转化为离散的代数矩阵方程。本练习将带你深入了解这一过程的核心，即计算构成这些矩阵的单个元素项。通过为一个准静态涡流问题中的三角形单元计算一个具体的矩阵元素，你将亲身体会到材料属性、几何形状和物理定律如何被共同编码到数值模型中。[@problem_id:1616444]", "problem": "在使用有限元法 (FEM) 对导体中的涡流进行数值建模时，一项关键的计算任务是评估构成导体横截面网格的离散小三角形单元上的耦合积分。这些积分构成了单元特征矩阵的元素。\n\n考虑这样一个线性三角形单元，它由三个顶点处的节点定义，坐标分别为：节点1位于 $(0, 0)$，节点2位于 $(h, 0)$，节点3位于 $(0, a)$。该单元内的某个物理量使用线性基函数（也称为形函数）$N_1(x,y)$、$N_2(x,y)$ 和 $N_3(x,y)$ 进行近似。基函数 $N_i(x,y)$ 在节点 $i$ 处的值为1，在其他两个节点处的值为0。\n\n您的任务是计算该单元基函数 $N_1$ 和 $N_2$ 之间的复值耦合积分 $Z_{12}$。该积分定义为：\n$$ Z_{12} = \\int_{\\text{element}} \\left( \\frac{1}{\\mu} (\\nabla N_1 \\cdot \\nabla N_2) + j\\omega\\sigma (N_1 N_2) \\right) dA $$\n其中 $\\mu$ 是磁导率，$\\sigma$ 是电导率，$\\omega$ 是角频率，$j = \\sqrt{-1}$，积分是在该三角形单元的面积上进行的。\n\n使用以下非磁性铜导体的参数计算 $Z_{12}$ 的数值：\n- 单元尺寸：$h = 1.000$ mm, $a = 2.000$ mm\n- 电导率：$\\sigma = 5.800 \\times 10^7$ S/m\n- 磁导率：$\\mu = 4\\pi \\times 10^{-7}$ H/m\n- 工作频率：$f = 60.00$ Hz\n\n您的答案应以包含 $Z_{12}$ 的实部和虚部的行矩阵形式给出，格式为 $[\\text{Re}(Z_{12}) \\quad \\text{Im}(Z_{12})]$。数值必须以国际单位制单位 $m \\cdot \\Omega^{-1} \\cdot s^{-1}$ 表示，并四舍五入到四位有效数字。最终答案中不要包含单位。", "solution": "我们使用线性形函数对节点位于 $(0,0)$、$(h,0)$ 和 $(0,a)$ 的线性三角形单元进行建模，这些形函数满足在节点 $i$ 处 $N_{i}=1$，在其他节点处为 0。对于这个直角三角形，\n$$\nN_{1}(x,y)=1-\\frac{x}{h}-\\frac{y}{a},\\quad N_{2}(x,y)=\\frac{x}{h},\\quad N_{3}(x,y)=\\frac{y}{a}.\n$$\n它们的梯度（在单元上为常数）是\n$$\n\\nabla N_{1}=\\left(-\\frac{1}{h},-\\frac{1}{a}\\right),\\quad \\nabla N_{2}=\\left(\\frac{1}{h},0\\right),\\quad \\nabla N_{3}=\\left(0,\\frac{1}{a}\\right).\n$$\n因此，\n$$\n\\nabla N_{1}\\cdot \\nabla N_{2}=-\\frac{1}{h^{2}}.\n$$\n单元面积为 $A=\\frac{1}{2}ah$。耦合积分为\n$$\nZ_{12}=\\int_{\\text{element}}\\left(\\frac{1}{\\mu}\\,\\nabla N_{1}\\cdot \\nabla N_{2}+j\\omega\\sigma\\,N_{1}N_{2}\\right)\\,dA\n=\\frac{1}{\\mu}\\left(\\nabla N_{1}\\cdot \\nabla N_{2}\\right)A+j\\omega\\sigma\\int_{\\text{element}}N_{1}N_{2}\\,dA.\n$$\n对于线性三角形，一致质量项满足 $\\int_{\\text{element}}N_{1}N_{2}\\,dA=\\frac{A}{12}$。我们也可以通过直接积分来验证：\n$$\n\\int_{\\text{element}}N_{1}N_{2}\\,dA=\\int_{0}^{h}\\int_{0}^{a(1-x/h)}\\left(\\frac{x}{h}\\right)\\left(1-\\frac{x}{h}-\\frac{y}{a}\\right)\\,dy\\,dx\n=\\frac{ah}{24}=\\frac{A}{12}.\n$$\n因此，\n$$\nZ_{12}=-\\frac{A}{\\mu h^{2}}+j\\,\\omega\\sigma\\,\\frac{A}{12}\n=-\\frac{a}{2\\mu h}+j\\,\\omega\\sigma\\,\\frac{ah}{24}.\n$$\n代入给定参数，并转换为国际单位制单位：$h=1.000\\times 10^{-3}\\,\\text{m}$，$a=2.000\\times 10^{-3}\\,\\text{m}$，$\\sigma=5.800\\times 10^{7}\\,\\text{S/m}$，$\\mu=4\\pi\\times 10^{-7}\\,\\text{H/m}$，以及 $\\omega=2\\pi f=2\\pi\\times 60.00=120\\pi\\,\\text{s}^{-1}$。计算实部：\n$$\n\\operatorname{Re}(Z_{12})=-\\frac{a}{2\\mu h}=-\\frac{2.000\\times 10^{-3}}{2\\,(4\\pi\\times 10^{-7})\\,(1.000\\times 10^{-3})}=-\\frac{1}{4\\pi\\times 10^{-7}}.\n$$\n因此 $\\operatorname{Re}(Z_{12})=-\\frac{10^{7}}{4\\pi}\\approx -7.957747\\times 10^{5}$。\n\n计算虚部：\n$$\n\\operatorname{Im}(Z_{12})=\\omega\\sigma\\,\\frac{ah}{24}=\\frac{2\\pi f\\,\\sigma\\,ah}{24}=\\frac{\\pi f\\,\\sigma\\,ah}{12}.\n$$\n当 $f=60.00$ 时，该式简化为\n$$\n\\operatorname{Im}(Z_{12})=5\\pi\\,\\sigma\\,a h=5\\pi\\,(5.800\\times 10^{7})\\,(2.000\\times 10^{-3})(1.000\\times 10^{-3})=5\\pi\\,(116)=580\\pi\\approx 1.822\\times 10^{3}.\n$$\n如要求，实部和虚部的单位均为 $\\,\\text{m}\\cdot\\Omega^{-1}\\cdot\\text{s}^{-1}$。四舍五入到四位有效数字，得到\n$$\n\\operatorname{Re}(Z_{12})\\approx -7.958\\times 10^{5},\\quad \\operatorname{Im}(Z_{12})\\approx 1.822\\times 10^{3}.\n$$\n因此，所要求的行矩阵如下。", "answer": "$$\\boxed{\\begin{pmatrix}-7.958 \\times 10^{5}  & 1.822 \\times 10^{3}\\end{pmatrix}}$$", "id": "1616444"}, {"introduction": "有限元方法的应用远不止于计算场的大小；它还能捕捉到电磁场中微妙而深刻的物理效应。本练习探讨了一个类似于阿哈罗诺夫-玻姆效应的场景，在该场景中磁场 $\\mathbf{B}$ 为零，但磁矢量势 $\\mathbf{A}$ 却不为零。通过对沿离散路径的 $\\mathbf{A}$ 进行数值积分，你将见证有限元法的离散近似如何能够准确地处理电磁场的拓扑性质，揭示其在解决概念性物理问题中的强大能力。[@problem_id:1616410]", "problem": "考虑一个理想化的、与 $z$ 轴对齐的无限长螺线管，其半径为 $R$。它承载着稳定的电流，在径向距离 $\\rho \\le R$ 的区域内产生均匀磁场 $\\mathbf{B} = B_0 \\hat{\\mathbf{z}}$，而在 $\\rho > R$ 的区域内磁场为零，即 $\\mathbf{B} = \\mathbf{0}$。限制在螺线管内部的总磁通量用 $\\Phi_B$ 表示。\n\n在外部区域（$\\rho > R$），尽管磁场为零，但由于该空间的拓扑非单连通性，磁矢量势 $\\mathbf{A}$ 不为零且非平凡。使用有限元法（FEM）进行数值模拟，以求解螺线管外部区域在 $xy$ 平面上的矢量势 $\\mathbf{A}$。模拟输出了在一系列离散点（节点）处的 $\\mathbf{A}$ 值。这些节点位于一个正 $N$ 边形的顶点上，该多边形以原点为中心，所有顶点都位于半径为 $r_p > R$ 的圆上。\n\n您的任务是计算矢量势沿此 $N$ 边形周长的环流 $\\oint \\mathbf{A} \\cdot d\\mathbf{l}$ 的数值近似值。计算必须通过对构成多边形的 $N$ 条直线段各自的贡献求和来完成。对于每条线段，矢量势 $\\mathbf{A}$ 应通过在其两端顶点处的已知值之间进行线性插值来近似。\n\n请确定此数值近似环流的一个闭合形式表达式，用总磁通量 $\\Phi_B$ 和多边形边数 $N$ 来表示。", "solution": "因为在 $\\rho>R$ 区域 $\\mathbf{B}=\\mathbf{0}$ 且该区域是多连通的，一个能够捕捉到所包围磁通量 $\\Phi_{B}$ 的外部矢量势的合适规范选择是方位角对称形式\n$$\n\\mathbf{A}(\\rho)=\\frac{\\Phi_{B}}{2\\pi \\rho}\\,\\hat{\\boldsymbol{\\phi}},\n$$\n该形式对于 $\\rho>R$ 满足 $\\nabla\\times\\mathbf{A}=\\mathbf{0}$，并且根据斯托克斯定理，对于任何半径为 $\\rho>R$ 的圆，其环流 $\\oint \\mathbf{A}\\cdot d\\mathbf{l}=\\Phi_{B}$。\n\n设半径为 $r_{p}>R$ 的正 $N$ 边形的 $N$ 个顶点位于角度 $\\theta_{k}=\\frac{2\\pi k}{N}$ 处，其位置矢量为 $\\mathbf{r}_{k}=r_{p}\\,\\hat{\\boldsymbol{\\rho}}_{k}$，其中 $k=0,1,\\dots,N-1$。在每个顶点处，\n$$\n\\mathbf{A}_{k}=\\mathbf{A}(\\mathbf{r}_{k})=\\frac{\\Phi_{B}}{2\\pi r_{p}}\\,\\hat{\\boldsymbol{\\phi}}_{k}\\equiv A_{0}\\,\\hat{\\boldsymbol{\\phi}}_{k},\n$$\n其中 $A_{0}=\\frac{\\Phi_{B}}{2\\pi r_{p}}$。\n\n考虑从顶点 $k$ 到 $k+1$ 的边。弦矢量为\n$$\n\\mathbf{d}_{k}=\\mathbf{r}_{k+1}-\\mathbf{r}_{k}=2r_{p}\\sin\\!\\left(\\frac{\\pi}{N}\\right)\\hat{\\boldsymbol{\\phi}}_{\\text{mid}},\n$$\n其中 $\\hat{\\boldsymbol{\\phi}}_{\\text{mid}}=\\hat{\\boldsymbol{\\phi}}(\\theta_{\\text{mid}})$ 且 $\\theta_{\\text{mid}}=\\frac{\\theta_{k}+\\theta_{k+1}}{2}$。因此，边长和单位切向矢量为\n$$\nL_{k}=|\\mathbf{d}_{k}|=2r_{p}\\sin\\!\\left(\\frac{\\pi}{N}\\right),\\qquad \\hat{\\mathbf{t}}_{k}=\\hat{\\boldsymbol{\\phi}}_{\\text{mid}}.\n$$\n\n通过以下方式沿该边对 $\\mathbf{A}$ 进行线性近似\n$$\n\\mathbf{A}^{(\\text{lin})}(s)=(1-s)\\mathbf{A}_{k}+s\\,\\mathbf{A}_{k+1},\\qquad s\\in[0,1],\n$$\n该边对环流的贡献为\n$$\nI_{k}\\approx \\int_{0}^{1}\\mathbf{A}^{(\\text{lin})}(s)\\cdot \\hat{\\mathbf{t}}_{k}\\,L_{k}\\,ds\n=L_{k}\\,\\hat{\\mathbf{t}}_{k}\\cdot \\frac{\\mathbf{A}_{k}+\\mathbf{A}_{k+1}}{2}.\n$$\n使用 $\\hat{\\boldsymbol{\\phi}}_{\\alpha}\\cdot \\hat{\\boldsymbol{\\phi}}_{\\beta}=\\cos(\\alpha-\\beta)$，我们得到\n$$\n\\hat{\\mathbf{t}}_{k}\\cdot \\mathbf{A}_{k}=A_{0}\\cos(\\theta_{k}-\\theta_{\\text{mid}})=A_{0}\\cos\\!\\left(\\frac{\\pi}{N}\\right),\n$$\n$$\n\\hat{\\mathbf{t}}_{k}\\cdot \\mathbf{A}_{k+1}=A_{0}\\cos(\\theta_{k+1}-\\theta_{\\text{mid}})=A_{0}\\cos\\!\\left(\\frac{\\pi}{N}\\right),\n$$\n所以\n$$\nI_{k}=L_{k}\\,A_{0}\\cos\\!\\left(\\frac{\\pi}{N}\\right)=2r_{p}\\sin\\!\\left(\\frac{\\pi}{N}\\right)A_{0}\\cos\\!\\left(\\frac{\\pi}{N}\\right)\n=r_{p}A_{0}\\sin\\!\\left(\\frac{2\\pi}{N}\\right).\n$$\n对所有 $N$ 条边求和，\n$$\n\\sum_{k=0}^{N-1} I_{k}=N\\,r_{p}A_{0}\\sin\\!\\left(\\frac{2\\pi}{N}\\right).\n$$\n代入 $A_{0}=\\frac{\\Phi_{B}}{2\\pi r_{p}}$ 得到闭合形式表达式\n$$\n\\sum_{k=0}^{N-1} I_{k}=\\frac{N}{2\\pi}\\,\\Phi_{B}\\,\\sin\\!\\left(\\frac{2\\pi}{N}\\right).\n$$\n当 $N\\to\\infty$ 时，此结果收敛于 $\\Phi_{B}$，与精确的环流值一致。", "answer": "$$\\boxed{\\frac{N}{2\\pi}\\,\\Phi_{B}\\,\\sin\\!\\left(\\frac{2\\pi}{N}\\right)}$$", "id": "1616410"}]}