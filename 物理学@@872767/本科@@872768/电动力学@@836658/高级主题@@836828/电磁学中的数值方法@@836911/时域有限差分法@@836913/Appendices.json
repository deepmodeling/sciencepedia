{"hands_on_practices": [{"introduction": "时域有限差分（FDTD）方法的核心在于将时间和空间离散化。然而，为了确保数值计算的稳定性并避免结果发散，时间步长 $\\Delta t$ 和空间步长 $\\Delta z$ 的选择必须遵循一个基本规则，即 Courant-Friedrichs-Lewy (CFL) 稳定性条件。这个练习将带你亲手计算在一维 FDTD 仿真中保证数值稳定性的最大时间步长，让你对这一至关重要的计算电磁学原则有更深刻的理解。[@problem_id:1581145]", "problem": "一位研究人员正在开发一个用于模拟光在硅基集成光子电路中传播的数值模型。该模型使用时域有限差分 (FDTD) 法沿对应于直波导核心的一维路径求解麦克斯韦方程组。空间域被离散化为一个均匀网格，网格尺寸为 $\\Delta z = 1.50 \\, \\mu\\text{m}$。波导核心由硅制成，可将其建模为一个相对介电常数为 $\\epsilon_r = 11.68$ 的简单、非磁性、无损耗的介电介质。\n\n为确保 FDTD 模拟保持数值稳定并产生物理上有意义的结果，必须谨慎选择模拟中使用的时间步长 $\\Delta t$。计算保证此一维模拟稳定性的最大可能时间步长 $\\Delta t_{\\text{max}}$。\n\n在计算中，请使用真空中的光速 $c = 2.998 \\times 10^8 \\, \\text{m/s}$。\n\n最终答案以飞秒 (fs) 为单位表示。将最终答案四舍五入至三位有效数字。", "solution": "对于一维 Yee FDTD 格式，库朗稳定性条件要求基于介质中波速的库朗数满足\n$$\nS \\equiv \\frac{v\\,\\Delta t}{\\Delta z} \\leq 1,\n$$\n其中 $v$ 是介质中的电磁波速。因此，最大稳定时间步长为\n$$\n\\Delta t_{\\text{max}}=\\frac{\\Delta z}{v}.\n$$\n在相对介电常数为 $\\epsilon_{r}$ 且 $\\mu_{r}=1$ 的简单、非磁性、无损耗的介电介质中，波速为\n$$\nv=\\frac{1}{\\sqrt{\\mu \\epsilon}}=\\frac{c}{\\sqrt{\\epsilon_{r}}},\n$$\n所以\n$$\n\\Delta t_{\\text{max}}=\\frac{\\Delta z\\,\\sqrt{\\epsilon_{r}}}{c}.\n$$\n\n代入给定值 $\\Delta z=1.50 \\times 10^{-6}\\ \\text{m}$，$\\epsilon_{r}=11.68$ 和 $c=2.998 \\times 10^{8}\\ \\text{m/s}$，\n$$\n\\Delta t_{\\text{max}}=\\frac{\\left(1.50 \\times 10^{-6}\\right)\\sqrt{11.68}}{2.998 \\times 10^{8}}\\ \\text{s}.\n$$\n计算 $\\sqrt{11.68} \\approx 3.4176$，得到\n$$\n\\Delta t_{\\text{max}}=\\frac{1.50 \\times 10^{-6} \\times 3.4176}{2.998 \\times 10^{8}}\\ \\text{s}\n=\\frac{5.1264 \\times 10^{-6}}{2.998 \\times 10^{8}}\\ \\text{s}\n=\\left(\\frac{5.1264}{2.998}\\right)\\times 10^{-14}\\ \\text{s}\n\\approx 1.70995 \\times 10^{-14}\\ \\text{s}.\n$$\n使用 $1\\ \\text{fs}=10^{-15}\\ \\text{s}$ 将其转换为飞秒，\n$$\n\\Delta t_{\\text{max}} \\approx 17.0995\\ \\text{fs}.\n$$\n四舍五入至三位有效数字得到 $17.1\\ \\text{fs}$。", "answer": "$$\\boxed{17.1}$$", "id": "1581145"}, {"introduction": "在进行任何计算模拟之前，评估其所需的计算资源是一项至关重要的实践。对于 FDTD 方法而言，模拟的规模（即网格单元的数量）直接决定了其内存占用。这个练习将引导你估算一个一维 FDTD 模拟所需的基本内存，让你能够将抽象的网格参数与实际的硬件限制联系起来，这是每位计算科学家都需要掌握的实用技能。[@problem_id:1581133]", "problem": "一位研究人员正在使用时域有限差分 (FDTD) 方法开发一个一维 (1D) 模拟，以模拟波的传播。该模拟的空间域被离散化为一个由恰好 1,250,000 个单元组成的网格。在这个简化的 1D 模型中，每个时间步都必须追踪两个不同的场分量（一个电场分量，一个磁场分量）。对于网格中的每个单元，都必须存储这两个分量的值。每个场值都由一个双精度浮点数表示，该浮点数占用 8 字节的计算机内存。\n\n计算在单个时间步内，存储整个网格上这两个场分量数据所需的最小随机存取存储器 (RAM) 容量。为了进行此计算，定义 1 兆字节 (MB) 等于 $10^6$ 字节。请以兆字节 (MB) 为单位表示您的最终答案。", "solution": "目标是计算存储一维 FDTD 模拟网格的场数据所需的总内存。我们已知网格单元数、每个单元的场分量数、每个场值的内存占用量以及字节到兆字节的转换因子。\n\n**步骤 1：确定已知量。**\n- 网格单元数，$N_{cells} = 1,250,000$。\n- 每个单元需存储的场分量数，$N_{fields} = 2$。\n- 存储一个场值所需的内存，$M_{value} = 8$ 字节。\n- 转换因子：1 兆字节 (MB) = $10^6$ 字节。\n\n**步骤 2：计算需要存储的数据点总数。**\n该模拟需要在网格的每个单元中存储两个场分量。因此，需要存储在内存中的独立浮点值总数是单元数与每个单元的场分量数的乘积。\n$$ \\text{数据点总数} = N_{cells} \\times N_{fields} $$\n$$ \\text{数据点总数} = 1,250,000 \\times 2 = 2,500,000 $$\n\n**步骤 3：计算以字节为单位的总内存需求。**\n这些数据点中的每一个都是占用 8 字节的双精度数。为了计算以字节为单位的总内存需求，我们将数据点总数乘以每个数据点的内存大小。\n$$ \\text{总内存（字节）} = (\\text{数据点总数}) \\times M_{value} $$\n$$ \\text{总内存（字节）} = 2,500,000 \\times 8 \\text{ 字节} = 20,000,000 \\text{ 字节} $$\n\n**步骤 4：将总内存从字节转换为兆字节。**\n问题规定 1 MB 等于 $10^6$ 字节。我们可以使用这个转换因子来以要求的单位表示我们的结果。\n$$ \\text{总内存（MB）} = \\frac{\\text{总内存（字节）}}{\\text{每MB字节数}} $$\n$$ \\text{总内存（MB）} = \\frac{20,000,000 \\text{ 字节}}{10^6 \\text{ 字节/MB}} $$\n$$ \\text{总内存（MB）} = 20 \\text{ MB} $$\n\n因此，在模拟的单个时间步中，需要至少 20 MB 的 RAM 来存储指定的场数据。", "answer": "$$\\boxed{20}$$", "id": "1581133"}, {"introduction": "在模拟开放区域（如天线辐射）问题时，一个核心挑战是如何在有限的计算空间中处理向外传播的电磁波，避免其从网格边界反射回来造成干扰。完美匹配层（PML）是一种高效的吸收边界条件，通过构建一个人造吸收介质来解决此问题。这个练习旨在探讨 PML 背后的基本物理概念，解释它如何通过巧妙地设计非物理的电导率 $\\sigma$ 和磁导率 $\\sigma^*$ 来实现无反射吸收，从而确保模拟结果的准确性。[@problem_id:1581104]", "problem": "在计算电磁学中，时域有限差分（FDTD）法是模拟电磁波传播的强大工具。这些模拟中的一个普遍挑战是，计算域必须是有限的，而物理问题可能设定在开放的无界空间中。为了防止计算网格的人为边界产生非物理反射，需要设置吸收边界条件。其中最有效的技术之一是完美匹配层（PML）。PML 是一种放置在 FDTD 网格边缘的人工吸收层。在该层内，麦克斯韦方程组被修改，引入了人工电导率 $\\sigma$ 和人工磁导率 $\\sigma^*$。\n\n考虑在与 PML 区域相邻的无损耗、非磁性介质（例如自由空间）中进行波传播的模拟。在 PML 内部同时引入电导率（$\\sigma > 0$）和专门选择的非物理磁导率（$\\sigma^* > 0$）的基本概念作用是什么？\n\nA. 创建一个行为与标准物理有损耗材料（如盐水）完全相同的介质，从而通过物理衰减机制吸收波。\n\nB. 创建一个高阻抗表面，该表面能完美反射所有频率的波，从而有效隔离计算域。\n\nC. 创建一个波阻抗与相邻仿真区域相同的介质，以防止在界面处发生反射，同时在波穿过该层时对其进行衰减。\n\nD. 在边界上数值强制零场条件，这是在不使用复杂材料属性的情况下截断网格的最简单方法。\n\nE. 将传播波转换为空间上衰减但不耗散任何能量的倏逝波，从而将场能量存储在边界附近。", "solution": "目标：消除与 PML 交界处的反射，同时衰减层内的场。\n\n从均匀各向同性介质中的麦克斯韦方程组开始，该介质增加了电导率 $\\sigma$ 和磁导率 $\\sigma^{*}$：\n$$\n\\nabla \\times \\mathbf{H} = \\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t} + \\sigma \\mathbf{E}, \\quad\n\\nabla \\times \\mathbf{E} = -\\mu \\frac{\\partial \\mathbf{H}}{\\partial t} - \\sigma^{*} \\mathbf{H}.\n$$\n假设时谐场形式为 $\\exp(j\\omega t)$，变换到频域：\n$$\n\\nabla \\times \\mathbf{H} = (j\\omega \\epsilon + \\sigma)\\mathbf{E}, \\quad\n\\nabla \\times \\mathbf{E} = -(j\\omega \\mu + \\sigma^{*})\\mathbf{H}.\n$$\n对于在这种介质中的平面波，其波阻抗为\n$$\nZ_{\\text{PML}} = \\sqrt{\\frac{j\\omega \\mu + \\sigma^{*}}{j\\omega \\epsilon + \\sigma}}.\n$$\n相邻的无损耗区域（例如自由空间）的波阻抗为\n$$\nZ_{0} = \\sqrt{\\frac{\\mu}{\\epsilon}}.\n$$\n为了消除界面处的反射，需要满足 $Z_{\\text{PML}} = Z_{0}$，即：\n$$\n\\frac{j\\omega \\mu + \\sigma^{*}}{j\\omega \\epsilon + \\sigma} = \\frac{\\mu}{\\epsilon}.\n$$\n交叉相乘并简化可得\n$$\n\\epsilon (j\\omega \\mu + \\sigma^{*}) = \\mu (j\\omega \\epsilon + \\sigma) \\;\\Rightarrow\\; \\epsilon \\sigma^{*} = \\mu \\sigma,\n$$\n因此匹配条件为\n$$\n\\sigma^{*} = \\frac{\\mu}{\\epsilon}\\,\\sigma.\n$$\n在此选择下，界面处的反射系数为零：\n$$\n\\Gamma = \\frac{Z_{\\text{PML}} - Z_{0}}{Z_{\\text{PML}} + Z_{0}} = 0.\n$$\n同时，PML 中的传播常数为\n$$\n\\gamma^{2} = (j\\omega \\mu + \\sigma^{*})(j\\omega \\epsilon + \\sigma),\n$$\n因此，当 $\\sigma > 0$ 且 $\\sigma^{*} > 0$ 时，可以得到 $\\Re\\{\\gamma\\} > 0$ 并且 PML 内部的场呈指数衰减：\n$$\n|\\mathbf{E}(x)| \\propto \\exp(-\\alpha x), \\quad \\alpha = \\Re\\{\\gamma\\} > 0.\n$$\n因此，同时引入 $\\sigma$ 和适当选择的 $\\sigma^{*}$ 的基本作用是保持波阻抗匹配以防止界面反射，同时引入损耗以衰减层内的波。这与选项 C 一致，并排除了其他选项：\n- A 是错误的，因为仅含 $\\sigma$ 的标准物理有损耗介质通常会导致阻抗失配和反射；非物理的 $\\sigma^{*}$ 对于实现完美匹配至关重要。\n- B 和 D 描述的是反射性终端（高阻抗或零场），而不是吸收性终端。\n- E 是错误的，因为 PML 通过电导项耗散能量；它不是无耗散的纯倏逝波能量存储。", "answer": "$$\\boxed{C}$$", "id": "1581104"}]}