{"hands_on_practices": [{"introduction": "理解径向分布函数的一个极佳起点是分析理想晶体，其完美的周期性结构使 $g(r)$ 简化为一系列尖锐的峰。通过解决这个问题 [@problem_id:1820799]，你将学习如何从基本的晶格几何出发，确定这些峰的位置。这个练习旨在将抽象的 $g(r)$ 函数与原子在空间中的具体排列直接联系起来，从而为理解更复杂的无序系统打下坚实基础。", "problem": "在凝聚态物质的研究中，径向分布函数（表示为 $g(r)$）是描述粒子系统平均结构的有力工具。对于绝对零度下的理想晶体，该函数简化为一系列离散的、无限尖锐的峰。每个峰的位置 $r$ 对应于从一个参考原子到特定近邻原子壳层的距离。\n\n考虑一种假设的单原子元素单晶，它形成了一个理想的简单立方（SC）晶格。在SC晶格中，原子位于一个在整个晶体中重复的概念立方体的顶点上。我们可以将此立方体的边长定义为晶格常数 $a$。通过将一个参考原子放置在笛卡尔坐标系的原点 $(0, 0, 0)$，晶格中所有其他原子的位置可以用坐标矢量 $(ia, ja, ka)$ 来描述，其中 $i, j$ 和 $k$ 是整数，且三者不同时为零。\n\n该晶格径向分布函数的第一个峰出现在距离 $r_1$ 处，对应于第一近邻原子集。第二个峰出现在距离 $r_2$ 处，对应于第二近邻原子集。\n\n求此简单立方晶格的比值 $\\frac{r_2}{r_1}$ 的精确值。", "solution": "此题要求计算简单立方（SC）晶格中，第二近邻距离与第一近邻距离的比值。\n\n我们建立一个坐标系，将一个参考原子置于原点 $(0, 0, 0)$。在一个晶格常数为 $a$ 的SC晶格中，所有其他原子的位置由矢量 $\\vec{r} = (ia, ja, ka)$ 给出，其中 $i, j, k$ 是不同时为零的整数。\n\n从原点到任何其他原子的距离 $d$ 是该位置矢量的大小：\n$$d = |\\vec{r}| = \\sqrt{(ia)^2 + (ja)^2 + (ka)^2}$$\n$$d = a \\sqrt{i^2 + j^2 + k^2}$$\n要找到到连续近邻壳层的距离，我们需要找到 $d$ 的最小可能值。由于 $a$ 是一个常数，这等价于找到整数平方和 $S = i^2 + j^2 + k^2$ 的最小可能非零值。\n\n**第一近邻（距离 $r_1$）：**\n当整数 ($i, j, k$) 中有一个为 $\\pm 1$ 而另外两个为 0 时，平方和 $S = i^2 + j^2 + k^2$ 取得最小的非零值。\n例如，我们可以选择 $(i, j, k) = (1, 0, 0)$。\n平方和为 $S_1 = 1^2 + 0^2 + 0^2 = 1$。\n因此，到这些第一近邻的距离为：\n$$r_1 = a \\sqrt{S_1} = a \\sqrt{1} = a$$\n这些近邻原子位于诸如 $(\\pm a, 0, 0)$、$(0, \\pm a, 0)$ 和 $(0, 0, \\pm a)$ 的位置上。\n\n**第二近邻（距离 $r_2$）：**\n要找到第二近邻，我们必须找到平方和 $S = i^2 + j^2 + k^2$ 的下一个最小可能值。让我们检查接下来几个 $(i, j, k)$ 的整数组合：\n1.  如果两个整数为 $\\pm 1$ 而一个为 0（例如，$(1, 1, 0)$），则平方和为 $S = 1^2 + 1^2 + 0^2 = 2$。\n2.  如果所有三个整数都为 $\\pm 1$（例如，$(1, 1, 1)$），则平方和为 $S = 1^2 + 1^2 + 1^2 = 3$。\n3.  如果一个整数为 $\\pm 2$ 而其他为 0（例如，$(2, 0, 0)$），则平方和为 $S = 2^2 + 0^2 + 0^2 = 4$。\n\n比较这些可能的和，继 $S_1=1$ 之后的最小值是 $S_2=2$。这对应于第二近邻壳层。\n到这些第二近邻的距离为：\n$$r_2 = a \\sqrt{S_2} = a \\sqrt{2}$$\n这些近邻原子位于诸如 $(\\pm a, \\pm a, 0)$、$(\\pm a, 0, \\pm a)$ 和 $(0, \\pm a, \\pm a)$ 的位置上，即沿着立方晶胞的面-对角线方向。\n\n**计算比值：**\n题目要求计算比值 $\\frac{r_2}{r_1}$。使用我们为 $r_1$ 和 $r_2$ 推导出的表达式：\n$$\\frac{r_2}{r_1} = \\frac{a \\sqrt{2}}{a}$$\n晶格常数 $a$ 被消去，剩下：\n$$\\frac{r_2}{r_1} = \\sqrt{2}$$\n因此，对于SC晶格，径向分布函数中第二峰与第一峰位置的比值为 $\\sqrt{2}$。", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "1820799"}, {"introduction": "与理想晶体不同，液体和玻璃等无序系统的 $g(r)$ 表现为一系列展宽的连续峰。本练习 [@problem_id:1820838] 利用一个简化的非晶材料模型，向你展示如何运用 $g(r)$ 来提取关键的结构信息。通过对给定的 $g(r)$ 函数进行积分，你将能计算出累积配位数，这是表征材料局部原子堆积紧密程度的一个重要物理量。", "problem": "在非晶态材料（如玻璃和液体）的研究中，径向分布函数（Radial Distribution Function, RDF），记为 $g(r)$，是一个至关重要的工具。它描述了在距离一个参考原子 $r$ 处找到另一个原子的概率，相对于均匀分布而言。在一个中心原子周围，半径为 $r$、厚度为 $dr$ 的薄球壳内，原子数 $dN$ 由 $dN = 4\\pi r^2 \\rho g(r) dr$ 给出，其中 $\\rho$ 是材料中原子的平均数密度。\n\n考虑一个特定非晶态金属的径向分布函数的简化模型。在此模型中，原子相互作用的特征是硬核排斥和一个显著的第一近邻壳层。径向分布函数由以下分段函数近似表示：\n$$ g(r) = \\begin{cases} 0  \\text{对于 } 0 \\le r  d \\\\ C  \\text{对于 } d \\le r  2d \\\\ 1  \\text{对于 } r \\ge 2d \\end{cases} $$\n这里，$d$ 是原子的有效硬核直径，$C$ 是一个无量纲常数，代表第一配位壳层的增强密度。\n\n累积配位数 $N(R)$ 定义为以参考原子为中心、半径为 $R$ 的球内的总原子数。\n\n求出对于任意半径 $R > 2d$ 的累积配位数 $N(R)$ 的解析表达式。您的最终表达式应以 $\\rho$、$C$、$d$ 和 $R$ 表示。", "solution": "问题要求解的是累积配位数 $N(R)$，即半径为 $R$ 的球内的总原子数。这可以通过将原子数微分 $dN$ 从 $r=0$ 到 $r=R$ 积分得到。\n\n球壳中的原子数 $dN$、径向分布函数 $g(r)$ 和平均原子数密度 $\\rho$ 之间的基本关系如下：\n$$dN = 4\\pi r^2 \\rho g(r) dr$$\n\n为了求得半径 $R$ 内的总原子数 $N(R)$，我们对该表达式进行积分：\n$$N(R) = \\int_0^R dN = \\int_0^R 4\\pi r^2 \\rho g(r) dr$$\n\n所给的径向分布函数 $g(r)$ 是一个分段函数。由于我们关心的是 $R > 2d$ 的情况，我们必须将积分分成三部分，分别对应于区间 $[0, d)$、$[d, 2d)$ 和 $[2d, R]$ 中 $g(r)$ 的不同定义。\n\n$$N(R) = \\int_0^d 4\\pi r^2 \\rho g(r) dr + \\int_d^{2d} 4\\pi r^2 \\rho g(r) dr + \\int_{2d}^R 4\\pi r^2 \\rho g(r) dr$$\n\n现在我们将每个区间 $g(r)$ 的值代入：\n- 对于 $0 \\le r  d$，$g(r) = 0$。\n- 对于 $d \\le r  2d$，$g(r) = C$。\n- 对于 $r \\ge 2d$，$g(r) = 1$。\n\n将这些值代入积分表达式中：\n$$N(R) = \\int_0^d 4\\pi r^2 \\rho (0) dr + \\int_d^{2d} 4\\pi r^2 \\rho (C) dr + \\int_{2d}^R 4\\pi r^2 \\rho (1) dr$$\n\n我们分别计算每个积分。\n\n第一个积分是：\n$$I_1 = \\int_0^d 0 \\cdot dr = 0$$\n这是符合预期的，因为硬核排斥阻止了任何其他原子进入到中心原子距离 $d$ 的范围内。\n\n第二个积分是：\n$$I_2 = \\int_d^{2d} 4\\pi \\rho C r^2 dr$$\n我们可以将常数提取出来：\n$$I_2 = 4\\pi \\rho C \\int_d^{2d} r^2 dr = 4\\pi \\rho C \\left[ \\frac{r^3}{3} \\right]_d^{2d}$$\n计算定积分：\n$$I_2 = 4\\pi \\rho C \\left( \\frac{(2d)^3}{3} - \\frac{d^3}{3} \\right) = 4\\pi \\rho C \\left( \\frac{8d^3 - d^3}{3} \\right) = 4\\pi \\rho C \\left( \\frac{7d^3}{3} \\right) = \\frac{28}{3}\\pi \\rho C d^3$$\n\n第三个积分是：\n$$I_3 = \\int_{2d}^R 4\\pi \\rho (1) r^2 dr$$\n将常数提取出来：\n$$I_3 = 4\\pi \\rho \\int_{2d}^R r^2 dr = 4\\pi \\rho \\left[ \\frac{r^3}{3} \\right]_{2d}^R$$\n计算定积分：\n$$I_3 = 4\\pi \\rho \\left( \\frac{R^3}{3} - \\frac{(2d)^3}{3} \\right) = 4\\pi \\rho \\left( \\frac{R^3 - 8d^3}{3} \\right) = \\frac{4}{3}\\pi \\rho (R^3 - 8d^3)$$\n\n总累积配位数 $N(R)$ 是这三个积分之和：\n$$N(R) = I_1 + I_2 + I_3 = 0 + \\frac{28}{3}\\pi \\rho C d^3 + \\frac{4}{3}\\pi \\rho (R^3 - 8d^3)$$\n\n现在，我们可以通过提取公因式 $\\frac{4}{3}\\pi \\rho$ 来简化表达式：\n$$N(R) = \\frac{4}{3}\\pi \\rho \\left[ 7 C d^3 + (R^3 - 8d^3) \\right]$$\n$$N(R) = \\frac{4}{3}\\pi \\rho \\left[ R^3 + 7 C d^3 - 8 d^3 \\right]$$\n最后，我们可以从后两项中提取出 $d^3$：\n$$N(R) = \\frac{4}{3}\\pi \\rho \\left[ R^3 + (7C - 8) d^3 \\right]$$\n这就是当 $R>2d$ 时累积配位数的最终解析表达式。", "answer": "$$\\boxed{\\frac{4}{3}\\pi \\rho \\left(R^3 + (7C - 8)d^3\\right)}$$", "id": "1820838"}, {"introduction": "在前面的练习中，我们都是在给定 $g(r)$ 的前提下进行分析。那么，在实际研究中，$g(r)$ 本身是如何获得的呢？这个问题 [@problem_id:2007519] 将指导你完成最核心的一步：从一组来自计算机模拟的原始粒子坐标数据出发，通过分步计算，得出一个特定距离区间内 $g(r)$ 的数值。这个练习将彻底揭示 $g(r)$ 的计算来源，让你掌握将微观粒子分布转化为宏观统计函数的关键方法。", "problem": "对于一个粒子系统，径向分布函数 $g(r)$ 描述了密度如何随与一个参考粒子的距离而变化。对于一个面积为 $A$、包含 $N$ 个粒子的二维系统，在任意给定粒子周围半径为 $r$、厚度为 $dr$ 的环带中找到的平均粒子数 $dN$ 由 $dN = \\rho_0 g(r) (2\\pi r dr)$ 给出，其中 $\\rho_0 = N/A$ 是平均数密度。\n\n我们分析一个二维流体计算机模拟的单个快照。该模拟包含 $N=5$ 个粒子，位于边长为 $L=10$ 任意单位的方形盒子中。为简单起见，在距离计算中忽略周期性边界条件。这五个粒子的坐标 $(x,y)$ 如下：\nP1: (1, 2)\nP2: (3, 4)\nP3: (7, 6)\nP4: (8, 1)\nP5: (4, 8)\n\n根据此单一构型，计算径向分布函数 $g(r)$ 在距离区间 $r$ 满足 $4 \\le r  5$ 内的数值估计值。\n\n请用闭式解析表达式表示您的答案。", "solution": "问题要求根据粒子位置的单个快照，计算径向分布函数 $g(r)$ 在特定距离区间内的数值估计值。\n\n首先，我们必须从给定的 $g(r)$ 定义中推导出区间估计值 $g_{est}$ 的公式。该定义指出，在一个中心粒子周围，半径为 $r$、宽度为 $dr$ 的无穷小环带中的平均粒子数 $dN$ 为 $dN = \\rho_0 g(r) (2\\pi r dr)$。\n\n为了求出从 $r_{min}$ 到 $r_{max}$ 的有限环带（一个区间）内的粒子数 $\\Delta N$，我们对该表达式进行积分：\n$$ \\Delta N = \\int_{r_{min}}^{r_{max}} \\rho_0 g(r) 2\\pi r dr $$\n对于一个小的区间，我们可以将在该区间内的 $g(r)$ 近似为一个常数值 $g_{est}$。\n$$ \\Delta N \\approx \\rho_0 g_{est} \\int_{r_{min}}^{r_{max}} 2\\pi r dr $$\n$$ \\Delta N \\approx \\rho_0 g_{est} \\left[ \\pi r^2 \\right]_{r_{min}}^{r_{max}} = \\rho_0 g_{est} \\pi(r_{max}^2 - r_{min}^2) $$\n项 $\\pi(r_{max}^2 - r_{min}^2)$ 是环带的面积 $A_{annulus}$。因此，$\\Delta N \\approx \\rho_0 g_{est} A_{annulus}$。我们可以重新整理此式，以求解我们所需量 $g_{est}$：\n$$ g_{est} = \\frac{\\Delta N}{\\rho_0 A_{annulus}} $$\n此处，$\\Delta N$ 是在环带中找到的*平均*粒子数，该平均值是对所有可能的中心粒子选择进行平均得到的。在我们包含 $N$ 个粒子的单个快照中，我们可以通过计算每个粒子的邻居数然后求平均来估计这个平均值。设 $N_i$ 是在粒子 $i$ 周围的指定环带内的粒子 $j$（其中 $j \\neq i$）的数量。$\\Delta N$ 的估计值是这些计数的平均值：\n$$ \\Delta N_{est} = \\frac{1}{N} \\sum_{i=1}^{N} N_i $$\n求和 $\\sum_{i=1}^{N} N_i$ 将每一对距离在该区间内的粒子对 $\\{i,j\\}$ 计算了两次（一次以 $i$ 为中心，一次以 $j$ 为中心）。设 $N_p$ 为其间距落在该区间内的唯一粒子对的总数。那么 $\\sum_{i=1}^{N} N_i = 2 N_p$。因此，\n$$ \\Delta N_{est} = \\frac{2 N_p}{N} $$\n将此代入我们的 $g_{est}$ 表达式，并结合方形盒子中数密度 $\\rho_0 = N/A = N/L^2$ 的定义，我们得到：\n$$ g_{est} = \\frac{2 N_p / N}{(N/L^2) A_{annulus}} = \\frac{2 N_p L^2}{N^2 A_{annulus}} $$\n\n现在，我们将此公式应用于给定的数据。\n参数如下：\n- 粒子数，$N=5$。\n- 盒子边长，$L=10$ 单位。\n- 距离区间为 $[4, 5)$，因此 $r_{min}=4$ 且 $r_{max}=5$。\n\n首先，计算环带面积 $A_{annulus}$：\n$$ A_{annulus} = \\pi(r_{max}^2 - r_{min}^2) = \\pi(5^2 - 4^2) = \\pi(25 - 16) = 9\\pi $$\n\n接下来，我们必须计算所有唯一粒子对之间的距离 $d_{ij} = \\sqrt{(x_i-x_j)^2 + (y_i-y_j)^2}$，并计算有多少个（$N_p$）落在 $4 \\le d_{ij}  5$ 的范围内。共有 $\\frac{N(N-1)}{2} = \\frac{5(4)}{2} = 10$ 个唯一的粒子对。粒子坐标为：P1(1,2), P2(3,4), P3(7,6), P4(8,1), P5(4,8)。\n\n1.  $d_{12} = \\sqrt{(3-1)^2 + (4-2)^2} = \\sqrt{2^2 + 2^2} = \\sqrt{8} \\approx 2.828$\n2.  $d_{13} = \\sqrt{(7-1)^2 + (6-2)^2} = \\sqrt{6^2 + 4^2} = \\sqrt{52} \\approx 7.211$\n3.  $d_{14} = \\sqrt{(8-1)^2 + (1-2)^2} = \\sqrt{7^2 + (-1)^2} = \\sqrt{50} \\approx 7.071$\n4.  $d_{15} = \\sqrt{(4-1)^2 + (8-2)^2} = \\sqrt{3^2 + 6^2} = \\sqrt{45} \\approx 6.708$\n5.  $d_{23} = \\sqrt{(7-3)^2 + (6-4)^2} = \\sqrt{4^2 + 2^2} = \\sqrt{20}$。因为 $16 \\le 20  25$，所以我们有 $4 \\le \\sqrt{20}  5$。这一对在区间内。（$\\sqrt{20} \\approx 4.472$）\n6.  $d_{24} = \\sqrt{(8-3)^2 + (1-4)^2} = \\sqrt{5^2 + (-3)^2} = \\sqrt{34} \\approx 5.831$\n7.  $d_{25} = \\sqrt{(4-3)^2 + (8-4)^2} = \\sqrt{1^2 + 4^2} = \\sqrt{17}$。因为 $16 \\le 17  25$，所以我们有 $4 \\le \\sqrt{17}  5$。这一对在区间内。（$\\sqrt{17} \\approx 4.123$）\n8.  $d_{34} = \\sqrt{(8-7)^2 + (1-6)^2} = \\sqrt{1^2 + (-5)^2} = \\sqrt{26} \\approx 5.099$\n9.  $d_{35} = \\sqrt{(4-7)^2 + (8-6)^2} = \\sqrt{(-3)^2 + 2^2} = \\sqrt{13} \\approx 3.606$\n10. $d_{45} = \\sqrt{(4-8)^2 + (8-1)^2} = \\sqrt{(-4)^2 + 7^2} = \\sqrt{65} \\approx 8.062$\n\n通过检查所有距离，我们发现有两对粒子 {P2, P3} 和 {P2, P5} 的间距 $d$ 满足 $4 \\le d  5$。因此，区间内的粒子对数量为 $N_p=2$。\n\n最后，将所有值代入估计量公式：\n$$ g_{est} = \\frac{2 N_p L^2}{N^2 A_{annulus}} = \\frac{2 \\cdot 2 \\cdot (10)^2}{5^2 \\cdot (9\\pi)} = \\frac{4 \\cdot 100}{25 \\cdot 9\\pi} = \\frac{400}{225\\pi} $$\n化简分数：\n$$ g_{est} = \\frac{16 \\cdot 25}{9 \\cdot 25 \\cdot \\pi} = \\frac{16}{9\\pi} $$", "answer": "$$\\boxed{\\frac{16}{9\\pi}}$$", "id": "2007519"}]}