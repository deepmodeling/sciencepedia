{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是动手实践。我们从一个统计力学中的经典问题开始：确定在给定约束条件下，粒子在离散能级上的最概然分布。这个练习 [@problem_id:1980271] 直接应用拉格朗日乘数法，通过最大化系统的微观状态数（或熵），来求解粒子数和总能量守恒时的平衡态分布，这是理解玻尔兹曼分布等核心概念的基石。", "problem": "一个封闭系统由大量（$N$个）可分辨、无相互作用的粒子组成。这些粒子可以分布在两个概念上的“区域”中，即区域0和区域1。\n\n- 在区域0中的粒子只有一个能量状态，$E_0 = 0$。\n- 在区域1中的粒子有两个不同的能量状态，一个较低的状态能量为 $E_1 = \\epsilon$，一个较高的状态能量为 $E_2 = 2\\epsilon$，其中 $\\epsilon$ 是一个正常数。\n\n系统是孤立的，总粒子数固定为 $N$，总内能固定为特定值 $E = N\\epsilon$。你的任务是找出粒子在可用能量状态中的最概然分布。\n\n假设 $N$ 足够大，使得斯特林近似对阶乘有效，使用拉格朗日乘数法来确定占据区域0基态（即能量为 $E_0=0$ 的状态）的粒子分数 $f_0 = N_0/N$。\n\n将你的最终答案表示为一个有理数。", "solution": "令 $N_{0}$、$N_{1}$ 和 $N_{2}$ 分别表示处于单粒子能态 $E_{0}=0$、$E_{1}=\\epsilon$ 和 $E_{2}=2\\epsilon$ 的粒子数。约束条件为\n$$\nN_{0}+N_{1}+N_{2}=N, \\quad \\epsilon N_{1}+2\\epsilon N_{2}=N\\epsilon.\n$$\n对于具有这三个非简并能级的可分辨、无相互作用的粒子，一个宏观态的多重性是\n$$\n\\Omega=\\frac{N!}{N_{0}!\\,N_{1}!\\,N_{2}!}.\n$$\n使用斯特林近似 $\\ln n!\\approx n\\ln n-n$，用拉格朗日乘子 $\\lambda$ 和 $\\beta$ 要最大化的函数是\n$$\n\\Phi=\\ln \\Omega+\\lambda\\left(N-N_{0}-N_{1}-N_{2}\\right)+\\beta\\left(N\\epsilon-\\epsilon N_{1}-2\\epsilon N_{2}\\right).\n$$\n计算平稳条件：\n$$\n\\frac{\\partial \\Phi}{\\partial N_{0}}=-\\ln N_{0}-\\lambda=0,\\qquad\n\\frac{\\partial \\Phi}{\\partial N_{1}}=-\\ln N_{1}-\\lambda-\\beta\\epsilon=0,\\qquad\n\\frac{\\partial \\Phi}{\\partial N_{2}}=-\\ln N_{2}-\\lambda-2\\beta\\epsilon=0.\n$$\n求解得，\n$$\nN_{0}=\\exp(-\\lambda),\\quad N_{1}=\\exp(-\\lambda-\\beta\\epsilon),\\quad N_{2}=\\exp(-\\lambda-2\\beta\\epsilon).\n$$\n定义 $x=\\exp(-\\beta\\epsilon)>0$。那么\n$$\nN_{1}=x\\,N_{0},\\qquad N_{2}=x^{2}N_{0}.\n$$\n应用约束条件：\n$$\nN_{0}(1+x+x^{2})=N,\\qquad N_{0}(x+2x^{2})=N.\n$$\n令等式右边相等，得到\n$$\nx+2x^{2}=1+x+x^{2}\\;\\Rightarrow\\;x^{2}=1\\;\\Rightarrow\\;x=1,\n$$\n因为 $x>0$。因此，\n$$\nN_{0}=\\frac{N}{1+1+1}=\\frac{N}{3},\\qquad f_{0}=\\frac{N_{0}}{N}=\\frac{1}{3}.\n$$", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1980271"}, {"introduction": "掌握了离散系统后，我们将挑战一个更进一步的问题：如何描述连续空间中的粒子分布。在这个练习 [@problem_id:1980252] 中，你将不再是处理有限个能级的占据数，而是要找出一个连续的粒子密度函数 $\\rho(x)$。这个问题将拉格朗日乘数法推广到其连续形式——变分法，用来最大化一个熵泛函。通过求解这个问题，你将学会如何处理对连续函数（而非离散变量）的约束，并领会该方法在推导物理系统空间构型上的威力。", "problem": "考虑一个由$N$个经典的、无相互作用的点状粒子组成的系统，它们被限制在一个长度为$L$的一维盒子中。盒子的范围从位置$x=0$到$x=L$。系统处于热力学平衡状态，并受到两个宏观约束。首先，粒子总数固定为$N$。其次，这$N$个粒子的集体质心精确地固定在盒子的中点，即$x_{CM} = L/2$。\n\n粒子的“最概然”空间分布是使系统构型熵最大化的分布。令$\\rho(x)$表示粒子的线数密度，其中$\\rho(x)dx$是无限小区间$[x, x+dx]$内的粒子数。因此，粒子总数由$\\int_0^L \\rho(x) dx = N$给出。\n\n你的任务是确定这个最概然密度$\\rho(x)$的函数形式。将你的答案表示为给定参数$N$和$L$的函数。", "solution": "我们寻求在总粒子数$N$固定和质心位于$x_{CM}=L/2$的约束下，使构型熵最大化的粒子数密度$\\rho(x)$。将区间$[0,L]$离散化为宽度为$a$、中心位于$x_{j}$的小格，其占据数为$n_{j}\\approx \\rho(x_{j})a$，满足$\\sum_{j} n_{j}=N$和$\\sum_{j} x_{j} n_{j}=N L/2$。具有给定$\\{n_{j}\\}$的微观态数目为 $W = \\frac{N!}{\\prod_{j} n_{j}!}$。对于大的占据数，使用斯特林近似，熵$S=k_{B}\\ln W$在不考虑与$\\rho$形状无关的常数的情况下，由下式给出\n$$\nS[\\rho] \\propto -\\sum_{j} n_{j}\\ln n_{j} \\;\\to\\; -\\int_{0}^{L} \\rho(x)\\ln \\rho(x)\\,dx,\n$$\n此处已取连续极限，并且加性常数（包括任何来自小格尺寸$a$的常数）被吸收到拉格朗日乘子中。\n\n因此我们最大化泛函\n$$\n\\mathcal{F}[\\rho] \\equiv -\\int_{0}^{L} \\rho(x)\\ln \\rho(x)\\,dx - \\lambda\\left(\\int_{0}^{L} \\rho(x)\\,dx - N\\right) - \\mu\\left(\\int_{0}^{L} x\\,\\rho(x)\\,dx - \\frac{N L}{2}\\right),\n$$\n我们针对变分$\\delta\\rho(x)$来最大化该泛函，并满足约束$\\rho(x)\\ge 0$。一阶变分得到\n$$\n\\delta \\mathcal{F} = -\\int_{0}^{L} \\left(\\ln \\rho(x) + 1 + \\lambda + \\mu x\\right)\\delta \\rho(x)\\,dx = 0\n$$\n由于该式对于任意$\\delta \\rho(x)$都必须为0，这就导出了欧拉-拉格朗日条件\n$$\n\\ln \\rho(x) + 1 + \\lambda + \\mu x = 0.\n$$\n因此，\n$$\n\\rho(x) = C\\,\\exp(-\\mu x), \\quad C \\equiv \\exp(-1-\\lambda).\n$$\n\n施加约束条件来确定$C$和$\\mu$。归一化条件给出\n$$\nN = \\int_{0}^{L} \\rho(x)\\,dx = C \\int_{0}^{L} \\exp(-\\mu x)\\,dx =\n\\begin{cases}\nC\\,\\frac{1 - \\exp(-\\mu L)}{\\mu},  \\mu \\neq 0,\\\\\nC\\,L,  \\mu = 0.\n\\end{cases}\n$$\n质心约束意味着\n$$\n\\frac{1}{N}\\int_{0}^{L} x\\,\\rho(x)\\,dx = \\frac{L}{2}.\n$$\n对于$\\mu \\neq 0$，\n$$\n\\int_{0}^{L} x\\,\\exp(-\\mu x)\\,dx = \\frac{1 - (1+\\mu L)\\exp(-\\mu L)}{\\mu^{2}},\n$$\n所以\n$$\n\\langle x \\rangle \\equiv \\frac{1}{N}\\int_{0}^{L} x\\,\\rho(x)\\,dx\n= \\frac{\\frac{1 - (1+\\mu L)\\exp(-\\mu L)}{\\mu^{2}}}{\\frac{1 - \\exp(-\\mu L)}{\\mu}}\n= \\frac{1}{\\mu}\\,\\frac{1 - (1+\\mu L)\\exp(-\\mu L)}{1 - \\exp(-\\mu L)}.\n$$\n要求$\\langle x \\rangle = L/2$，并令$t \\equiv \\mu L$，可得\n$$\n\\frac{1}{t}\\,\\frac{1 - (1+t)\\exp(-t)}{1 - \\exp(-t)} = \\frac{1}{2}.\n$$\n这等价于\n$$\n2\\left[1 - (1+t)\\exp(-t)\\right] = t\\left[1 - \\exp(-t)\\right]\n\\;\\;\\Longleftrightarrow\\;\\; (t - 2) + (t + 2)\\exp(-t) = 0.\n$$\n定义函数 $h(t) \\equiv (t - 2) + (t + 2)\\exp(-t)$。显然 $h(0) = (0-2) + (0+2)e^0 = -2 + 2 = 0$。为了找到该方程的其他解，我们分析 $h(t)$ 的单调性。计算其一阶导数：\n$$\nh'(t) = 1 + [1\\cdot\\exp(-t) + (t+2)(-\\exp(-t))] = 1 + \\exp(-t)(1 - t - 2) = 1 - (t+1)\\exp(-t).\n$$\n为了确定 $h'(t)$ 的符号，我们计算其二阶导数：\n$$\nh''(t) = -[1\\cdot\\exp(-t) + (t+1)(-\\exp(-t))] = -[\\exp(-t) - (t+1)\\exp(-t)] = t\\exp(-t).\n$$\n由于当 $t>0$ 时 $h''(t)>0$，当 $t0$ 时 $h''(t)0$，这表明 $h'(t)$ 在 $t=0$ 处达到其唯一的全局最小值。该最小值为 $h'(0) = 1 - (0+1)e^0 = 0$。因此，对于所有 $t \\neq 0$ 的情况，都有 $h'(t) > 0$。这意味着函数 $h(t)$ 在整个实数域上是严格单调递增的。因为 $h(t)$ 是严格递增的且 $h(0)=0$，所以 $t=0$ 是方程的唯一解。所以，平均值约束的唯一解是 $t=0$，即 $\\mu=0$。\n\n因此，使熵最大化的密度具有$\\mu=0$的特性，即它在$[0,L]$上是均匀分布的。于是，归一化条件确定了$C$：\n$$\nN = C L \\quad \\Longrightarrow \\quad C = \\frac{N}{L}.\n$$\n因此，最概然密度为\n$$\n\\rho(x) = \\frac{N}{L} \\quad \\text{for } 0 \\le x \\le L,\n$$\n该密度满足$\\int_{0}^{L} \\rho(x)\\,dx = N$和$\\frac{1}{N}\\int_{0}^{L} x\\,\\rho(x)\\,dx = L/2$这两个条件，并且最大化了构型熵。", "answer": "$$\\boxed{\\frac{N}{L}}$$", "id": "1980252"}, {"introduction": "最后，我们将拉格朗日乘数法的应用推向一个更广阔的舞台——相空间。这个高级练习 [@problem_id:1980237] 要求你推导出一个在相空间（包含位置和速度）中描述系统的完整分布函数 $f(\\vec{r}, \\vec{v})$。与之前的问题不同，这里的约束不仅包括粒子数和能量，还引入了角动量守恒，这是一个动力学约束。这个问题深刻地揭示了物理学的基本原理：系统的对称性与守恒律（如旋转对称性与角动量守恒）如何通过熵最大化原理，直接决定了其平衡态的数学形式。", "problem": "一个由大量全同、无相互作用的粒子组成的经典气体被限制在一个二维平面内，每个粒子的质量为 $m$。该气体的微观状态由相空间分布函数 $f(\\vec{r}, \\vec{v})$ 描述，该函数给出了在位置 $\\vec{r}=(x,y)$ 处、速度为 $\\vec{v}=(v_x, v_y)$ 的粒子密度。\n\n平衡分布是使连续形式的吉布斯熵最大化的分布，其泛函形式为：\n$$S[f] = -k_B \\iint f(\\vec{r}, \\vec{v}) \\ln[C f(\\vec{r}, \\vec{v})] \\, d^2r \\, d^2v$$\n其中 $k_B$ 是玻尔兹曼常数，$C$ 是一个具有适当单位的常数，以使对数的宗量无量纲。\n\n此最大化过程受三个宏观约束：\n1.  总粒子数是固定的：$N = \\iint f(\\vec{r}, \\vec{v}) \\, d^2r \\, d^2v$。\n2.  总动能是固定的：$E = \\iint \\left(\\frac{1}{2} m v^2\\right) f(\\vec{r}, \\vec{v}) \\, d^2r \\, d^2v$，其中 $v^2 = v_x^2 + v_y^2$。\n3.  总角动量绕原点的z分量是固定的：$L_z = \\iint m(x v_y - y v_x) f(\\vec{r}, \\vec{v}) \\, d^2r \\, d^2v$。\n\n使用拉格朗日乘子法，求出平衡分布函数 $f(\\vec{r}, \\vec{v})$ 的泛函形式。用 $m$、位置分量 $x$ 和 $y$、速度分量 $v_x$ 和 $v_y$、常数 $C$ 以及分别与粒子数、能量和角动量约束相关联的拉格朗日乘子 $\\alpha$、$\\beta$ 和 $\\omega$ 来表示你的答案。", "solution": "我们通过引入拉格朗日乘子，在约束条件下最大化吉布斯熵泛函。由于最大化 $S[f]$ 等价于最大化 $S[f]/k_{B}$，我们考虑\n$$\\mathcal{J}[f] \\equiv - \\iint f(\\vec{r},\\vec{v}) \\ln\\!\\big(C f(\\vec{r},\\vec{v})\\big)\\, d^{2}r\\, d^{2}v - \\alpha\\left(\\iint f\\, d^{2}r\\, d^{2}v - N\\right) - \\beta\\left(\\iint \\frac{1}{2} m v^{2} f\\, d^{2}r\\, d^{2}v - E\\right) - \\omega\\left(\\iint m(x v_{y} - y v_{x}) f\\, d^{2}r\\, d^{2}v - L_{z}\\right).$$\n在任意变分 $\\delta f$ 下，驻点满足 $\\delta \\mathcal{J}=0$。在积分号下对 $f$ 进行变分，并舍去常数约束项 $N$、$E$ 和 $L_{z}$，我们得到\n$$\\delta \\mathcal{J} = \\iint \\left[-\\big(\\ln(C f)+1\\big) - \\alpha - \\beta \\frac{m v^{2}}{2} - \\omega m (x v_{y} - y v_{x})\\right]\\delta f \\, d^{2}r\\, d^{2}v.$$\n由于这对任意 $\\delta f$ 都必须为零，方括号内的表达式必须逐点为零：\n$$-(\\ln(C f)+1) - \\alpha - \\beta \\frac{m v^{2}}{2} - \\omega m (x v_{y} - y v_{x}) = 0.$$\n解出 $\\ln(C f)$ 得到\n$$\\ln(C f) = -1 - \\alpha - \\beta \\frac{m v^{2}}{2} - \\omega m (x v_{y} - y v_{x}).$$\n对两边取指数，得到平衡分布\n$$f(\\vec{r},\\vec{v}) = \\frac{1}{C}\\,\\exp\\!\\left(-1 - \\alpha - \\beta \\frac{m}{2}(v_{x}^{2}+v_{y}^{2}) - \\omega m (x v_{y} - y v_{x})\\right).$$\n这个 $f(\\vec{r},\\vec{v})$ 在固定的 $N$、$E$ 和 $L_{z}$ 约束下使熵最大化，其中乘子 $\\alpha$、$\\beta$ 和 $\\omega$ 分别与粒子数、能量和角动量相关联。", "answer": "$$\\boxed{\\frac{1}{C}\\,\\exp\\!\\left(-1-\\alpha-\\beta\\,\\frac{m}{2}\\left(v_{x}^{2}+v_{y}^{2}\\right)-\\omega\\,m\\left(x\\,v_{y}-y\\,v_{x}\\right)\\right)}$$", "id": "1980237"}]}