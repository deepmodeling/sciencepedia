{"hands_on_practices": [{"introduction": "为了将理论付诸实践，本节提供了一系列精心设计的练习，旨在加深您对大偏差理论的理解和应用能力。这些问题将引导您从计算独立随机变量系统的基本速率函数，到分析其物理含义，最终将其应用于统计力学中的相互作用模型。通过亲手推导，您将更深刻地体会到大偏差理论如何量化罕见事件的发生概率。\n\n我们的第一个练习 [@problem_id:1976167] 关注一个常见于物理学中的场景：对随机事件（如粒子衰变）之间的时间间隔进行建模。这是一个基础性的计算任务，它将引导您应用克拉默定理（Cramér's theorem）的完整流程。您需要先为指数分布计算累积量生成函数，再通过勒让德-芬切尔变换（Legendre-Fenchel transform）求出速率函数，这是掌握大偏差理论核心计算技巧的必经之路。", "problem": "我们开发了一个计算机模拟程序，用于模拟间歇性事件的时间分布，例如放射性样本中连续粒子衰变之间的时间间隔。这些时间间隔表示为 $T_1, T_2, \\ldots, T_N$，是作为 $N$ 个独立同分布的随机变量序列生成的。\n\n每个变量 $T_i$ 都从一个率参数为 $\\lambda_0 > 0$ 的指数分布中抽取。每个 $T_i$ 的概率密度函数由 $p(t) = \\lambda_0 \\exp(-\\lambda_0 t)$（对于 $t \\ge 0$）给出，而当 $t  0$ 时 $p(t)=0$。\n\n该模拟的主要焦点是这些时间间隔的长期平均值，即样本均值，其定义为 $M_N = \\frac{1}{N} \\sum_{i=1}^{N} T_i$。对于非常大的样本数 $N$，该样本均值取一个不同于其期望值的值 $a$（其中 $a  0$）的概率可以使用大偏差原理进行估计。该原理指出，概率具有以下渐近形式：\n$$P(M_N \\approx a) \\sim \\exp(-N I(a))$$\n在这里，$I(a)$ 是一个称为率函数的非负函数，它量化了观察到样本均值 $M_N$ 为值 $a$ 的指数级不可能性。\n\n确定率函数 $I(a)$ 的解析表达式。你的答案应以变量 $a$ 和常数参数 $\\lambda_0$ 表示。", "solution": "我们有独立同分布的 $T_{i}$，其指数密度为 $p(t)=\\lambda_{0}\\exp(-\\lambda_{0} t)$（对于 $t\\geq 0$）。根据克拉默定理（Cramér's theorem），样本均值 $M_{N}$ 的率函数是单个 $T$ 的累积量生成函数的勒让德-芬切尔变换（Legendre-Fenchel transform）：\n$$\nI(a)=\\sup_{\\theta  \\lambda_{0}}\\{\\theta a-\\Lambda(\\theta)\\},\n$$\n其中 $\\Lambda(\\theta)=\\ln \\mathbb{E}[\\exp(\\theta T)]$ 且定义域限制 $\\theta  \\lambda_{0}$ 确保了可积性。\n\n计算矩生成函数：\n$$\n\\mathbb{E}[\\exp(\\theta T)]=\\int_{0}^{\\infty}\\lambda_{0}\\exp(-\\lambda_{0} t)\\exp(\\theta t)\\,dt=\\int_{0}^{\\infty}\\lambda_{0}\\exp\\bigl(-( \\lambda_{0}-\\theta)t\\bigr)\\,dt=\\frac{\\lambda_{0}}{\\lambda_{0}-\\theta},\n$$\n此式对于 $\\theta  \\lambda_{0}$ 有效。因此，累积量生成函数是\n$$\n\\Lambda(\\theta)=\\ln\\left(\\frac{\\lambda_{0}}{\\lambda_{0}-\\theta}\\right)=\\ln(\\lambda_{0})-\\ln(\\lambda_{0}-\\theta)=-\\ln\\left(1-\\frac{\\theta}{\\lambda_{0}}\\right),\\quad \\theta  \\lambda_{0}.\n$$\n\n因此，\n$$\nI(a)=\\sup_{\\theta  \\lambda_{0}}\\left\\{\\theta a+\\ln\\left(1-\\frac{\\theta}{\\lambda_{0}}\\right)\\right\\}.\n$$\n令 $f(\\theta)=\\theta a+\\ln\\left(1-\\frac{\\theta}{\\lambda_{0}}\\right)$。那么\n$$\nf'(\\theta)=a-\\frac{1}{\\lambda_{0}-\\theta},\\qquad f''(\\theta)=-\\frac{1}{(\\lambda_{0}-\\theta)^{2}}  0,\n$$\n所以上确界在满足 $f'(\\theta)=0$ 的唯一驻点处取得：\n$$\na=\\frac{1}{\\lambda_{0}-\\theta^{*}}\\quad\\Longrightarrow\\quad \\theta^{*}=\\lambda_{0}-\\frac{1}{a}.\n$$\n将 $\\theta^{*}$ 代回 $f$ 中：\n$$\nI(a)=f(\\theta^{*})=a\\left(\\lambda_{0}-\\frac{1}{a}\\right)+\\ln\\left(1-\\frac{\\lambda_{0}-\\frac{1}{a}}{\\lambda_{0}}\\right)=\\lambda_{0}a-1+\\ln\\left(\\frac{1}{a\\lambda_{0}}\\right).\n$$\n因此，对于 $a0$，\n$$\nI(a)=\\lambda_{0}a-1-\\ln(\\lambda_{0}a),\n$$\n该函数是非负的，并且在 $a=\\frac{1}{\\lambda_{0}}$ 处为零，这符合大偏差原理对指数变量样本均值的要求。", "answer": "$$\\boxed{\\lambda_{0} a - 1 - \\ln(\\lambda_{0} a)}$$", "id": "1976167"}, {"introduction": "在掌握了计算速率函数的基本方法后，我们来探讨其更深层次的物理意义。这个练习 [@problem_id:1976174] 使用了一个加载骰子的直观模型，这是一个经典的离散随机变量系统。此问题的核心不仅是推导速率函数，更是分析其在期望值附近的局部行为，从而揭示速率函数的曲率与系统内禀涨落（即方差）之间的深刻联系。", "problem": "进行了一系列共 $N$ 次的实验，每次实验包含掷一个特殊的六面骰子一次。设第 $i$ 次掷骰的结果为随机变量 $X_i$，其可以取1到6的整数值。该骰子是不均匀的，掷出点数为 $k$ 的那一面的概率与 $k$ 成正比。掷骰的结果 $\\{X_1, X_2, \\dots, X_N\\}$ 是独立同分布的。\n\n我们关心的是这些结果的样本均值 $S_N = \\frac{1}{N}\\sum_{i=1}^N X_i$。根据大偏差理论的原理，对于非常大的掷骰次数 $N \\to \\infty$，样本均值约等于某个特定值 $a$ 的概率，记为 $P(S_N \\approx a)$，遵循渐近关系 $P(S_N \\approx a) \\propto \\exp(-N \\cdot I(a))$。函数 $I(a)$ 被称为率函数，它量化了观察到样本均值偏离真实期望值的指数稀有性。\n\n设 $X$ 表示单次掷骰结果的随机变量。你的任务是计算率函数 $I(a)$ 的二阶导数 $\\frac{d^2I}{da^2}$ 在均值 $a$ 等于单次掷骰的期望值 $E[X]$ 处的值。请将你的答案表示为一个精确分数。", "solution": "骰子掷出各点数的概率与点数值成正比，因此对于 $k \\in \\{1,2,3,4,5,6\\}$，\n$$\nP(X=k)=\\frac{k}{\\sum_{j=1}^{6} j}=\\frac{k}{21}.\n$$\n计算均值和二阶矩：\n$$\nE[X]=\\sum_{k=1}^{6} k \\cdot \\frac{k}{21}=\\frac{1}{21}\\sum_{k=1}^{6} k^{2}=\\frac{91}{21}=\\frac{13}{3},\n$$\n$$\nE[X^{2}]=\\sum_{k=1}^{6} k^{2} \\cdot \\frac{k}{21}=\\frac{1}{21}\\sum_{k=1}^{6} k^{3}=\\frac{441}{21}=21.\n$$\n因此方差为\n$$\n\\operatorname{Var}(X)=E[X^{2}]-(E[X])^{2}=21-\\left(\\frac{13}{3}\\right)^{2}=\\frac{20}{9}.\n$$\n\n对于样本均值的大偏差问题，定义对数矩生成函数\n$$\n\\Lambda(t)=\\ln E[\\exp(tX)].\n$$\nCramér率函数是其Legendre-Fenchel变换\n$$\nI(a)=\\sup_{t\\in\\mathbb{R}}\\{t a-\\Lambda(t)\\}.\n$$\n在标准的平滑性和凸性条件下（此处条件成立），上确界在满足以下方程的唯一 $t$ 处取得\n$$\n\\Lambda'(t)=a,\n$$\n并且有 $I'(a)=t$。将方程 $\\Lambda'(t)=a$ 对 $a$ 求导可得\n$$\n\\Lambda''(t)\\,\\frac{dt}{da}=1 \\quad\\Longrightarrow\\quad \\frac{dt}{da}=\\frac{1}{\\Lambda''(t)}.\n$$\n因此，\n$$\n\\frac{d^{2}I}{da^{2}}=\\frac{d}{da}\\big(I'(a)\\big)=\\frac{dt}{da}=\\frac{1}{\\Lambda''(t)}.\n$$\n在 $a=E[X]$ 时，使表达式取得上确界的 $t$ 值为 $t=0$，因为\n$$\n\\Lambda'(0)=E[X],\n$$\n并且\n$$\n\\Lambda''(0)=\\operatorname{Var}(X).\n$$\n因此，\n$$\n\\left.\\frac{d^{2}I}{da^{2}}\\right|_{a=E[X]}=\\frac{1}{\\operatorname{Var}(X)}=\\frac{1}{20/9}=\\frac{9}{20}.\n$$", "answer": "$$\\boxed{\\frac{9}{20}}$$", "id": "1976174"}, {"introduction": "前面的练习集中于独立随机变量，但统计力学的许多核心问题都涉及相互作用的粒子系统。这个练习 [@problem_id:1976166] 将大偏差理论应用于统计物理学的一个基石模型——一维伊辛模型。通过分析一个给定的标度化累积量生成函数，您将探索在一个弱相互作用系统中，粒子间的耦合如何修正宏观可观测量（如磁化强度）的涨落概率，这直接展示了大偏差理论在连接微观相互作用与宏观现象方面的强大能力。", "problem": "考虑一个由 $N$ 个自旋组成的一维伊辛模型链，其中每个自旋 $s_i$ 的取值可以为 $+1$ 或 $-1$。系统的能量由 $E = -J \\sum_{i=1}^{N-1} s_i s_{i+1}$ 给出，其中 $J0$ 是铁磁相互作用常数。系统在高温 $T$ 下处于热平衡状态，对应的逆温度为 $\\beta = 1/(k_B T)$，其中 $k_B$ 是玻尔兹曼常数。系统没有外磁场。\n\n在 $N$ 很大的极限下，观测到样本磁化强度 $m = \\frac{1}{N}\\sum_{i=1}^N s_i$ 为某一特定值的概率由大偏差原理描述：$P(m) \\propto \\exp(-N I(m))$，其中 $I(m)$ 是率函数。该率函数可以通过勒让德-芬克尔变换从标度化累积量生成函数 (CGF) $\\psi(h) = \\lim_{N\\to\\infty} \\frac{1}{N} \\ln \\langle \\exp(h \\sum_{i=1}^N s_i) \\rangle$ 获得。\n\n在 $\\beta J \\ll 1$ 的高温极限下，CGF 可以展开为：\n$$\n\\psi(h) = \\ln(2\\cosh(h)) + \\frac{1}{2}(\\beta J)^2 \\tanh^2(h) + O((\\beta J)^4)\n$$\n使用此表达式，求出对于小的样本磁化强度 $m$ 时的率函数 $I(m)$。你的最终答案应当被归一化以满足 $I(0)=0$，并且是关于 $m$ 和 $\\beta J$ 的最低阶非平庸近似。将你的答案表示为包含 $m$、$\\beta$ 和 $J$ 的解析表达式。", "solution": "我们已知高温下的标度化累积量生成函数 (CGF) 为：\n$$\n\\psi(h) = \\ln(2\\cosh(h)) + \\frac{1}{2}(\\beta J)^{2} \\tanh^{2}(h) + O((\\beta J)^{4}).\n$$\n率函数通过勒让德-芬克尔变换得到\n$$\nI(m) = \\sup_{h}\\,\\left[m h - \\psi(h)\\right].\n$$\n对于小磁化强度 $m$，使其取最大值的 $h$ 也很小。因此，我们对 $\\psi(h)$ 进行小 $h$ 展开。使用\n$$\n\\cosh(h) = 1 + \\frac{h^{2}}{2} + O(h^{4}), \\quad \\ln(2\\cosh(h)) = \\ln 2 + \\frac{h^{2}}{2} + O(h^{4}),\n$$\n和\n$$\n\\tanh(h) = h + O(h^{3}), \\quad \\tanh^{2}(h) = h^{2} + O(h^{4}),\n$$\n我们得到，保留到 $h$ 的二次项和 $(\\beta J)^{2}$ 阶，\n$$\n\\psi(h) = \\ln 2 + \\frac{1}{2}\\left[1 + (\\beta J)^{2}\\right] h^{2} + O(h^{4}) + O((\\beta J)^{4}).\n$$\n求导以施加平稳点条件 $m = \\psi'(h)$：\n$$\n\\psi'(h) = \\left[1 + (\\beta J)^{2}\\right] h + O(h^{3}) \\quad \\Rightarrow \\quad h = \\frac{m}{1 + (\\beta J)^{2}} + O(m^{3}).\n$$\n现在计算勒让德表达式，保留到 $m$ 的二次项：\n$$\nI(m) = m h - \\psi(h) = m h - \\left[\\ln 2 + \\frac{1}{2}\\left(1 + (\\beta J)^{2}\\right) h^{2}\\right] + \\text{更高阶项}.\n$$\n将 $h = m/[1 + (\\beta J)^{2}]$ 代入，得到\n$$\nI(m) = \\frac{m^{2}}{1 + (\\beta J)^{2}} - \\ln 2 - \\frac{1}{2}\\left(1 + (\\beta J)^{2}\\right)\\frac{m^{2}}{\\left[1 + (\\beta J)^{2}\\right]^{2}} + \\text{更高阶项}\n= -\\ln 2 + \\frac{1}{2}\\frac{m^{2}}{1 + (\\beta J)^{2}} + \\text{更高阶项}.\n$$\n根据归一化要求 $I(0)=0$，所以我们平移一个常数 $\\ln 2$，得到小 $m$ 的率函数\n$$\nI(m) = \\frac{1}{2}\\frac{m^{2}}{1 + (\\beta J)^{2}} + O(m^{4}) + O((\\beta J)^{4}).\n$$\n最后，同时保留 $m$ 和 $\\beta J$ 的最低阶非平庸项（即 $m$ 的二次项和 $(\\beta J)^{2}$ 阶的项），我们展开\n$$\n\\frac{1}{1 + (\\beta J)^{2}} = 1 - (\\beta J)^{2} + O((\\beta J)^{4}),\n$$\n以获得\n$$\nI(m) = \\frac{1}{2}\\left[1 - (\\beta J)^{2}\\right] m^{2}.\n$$\n该表达式满足 $I(0)=0$，并且是所求的关于 $m$ 和 $\\beta J$ 的最低阶非平庸近似。", "answer": "$$\\boxed{\\frac{1}{2}\\left[1-(\\beta J)^{2}\\right]m^{2}}$$", "id": "1976166"}]}