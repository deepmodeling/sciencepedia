## 引言
在[热力学](@entry_id:141121)领域，功与自由能之间的关系是基石性的概念。对于理想化的可逆过程，外界所做的功精确等于系统自由能的变化。然而，现实世界中的绝大多数过程，从分子的折叠到[化学反应](@entry_id:146973)，都在有限时间内发生，伴随着能量的耗散，属于非平衡过程。长久以来，如何为这些普遍存在的非平衡过程建立一个精确的[热力学](@entry_id:141121)描述，是一个巨大的挑战。贾辛斯基等式（Jarzynski equality）的出现，为这一难题提供了一个出乎意料且极为优美的解决方案，它在[非平衡动力学](@entry_id:160262)和[平衡态](@entry_id:168134)[热力学](@entry_id:141121)之间架起了一座坚实的桥梁。

本文旨在系统性地阐述这一深刻的物理学等式。我们将首先在“原理与机制”一章中，深入剖析贾辛斯基等式的数学形式、其与[热力学第二定律](@entry_id:142732)的内在联系，并揭示热涨落在其中扮演的关键角色。随后，在“应用与跨学科联系”一章，我们将展示该等式如何作为一种强大的工具，在单分子生物物理、[计算化学](@entry_id:143039)乃至天体物理等多个前沿[交叉](@entry_id:147634)学科中得到应用，以从非平衡测量中提取关键的平衡态信息。最后，通过“动手实践”部分提供的一系列具体问题，读者将有机会亲手运用所学知识，加深对理论的理解和应用能力。

## 原理与机制

继前一章对背景的介绍之后，本章将深入探讨贾辛斯基等式 (Jarzynski equality) 的核心原理与内在机制。这一深刻的等式在非[平衡态](@entry_id:168134)统计物理领域中扮演着基石性的角色，它在非平衡过程的功 (work) 与[平衡态](@entry_id:168134)的[热力学状态函数](@entry_id:204381)——亥姆霍兹自由能 (Helmholtz free energy) 之间，建立了一座出乎意料的桥梁。我们将从等式的表述出发，逐步揭示其与[热力学第二定律](@entry_id:142732)的内在联系，并阐明热涨落在其中扮演的关键角色，最后通过具体的实例来展示其应用和验证。

### 贾辛斯基等式：连接平衡与非平衡的桥梁

在经典[热力学](@entry_id:141121)中，功是一个依赖于过程的量，而自由能是一个只与状态相关的量。只有在无限缓慢、可逆的[准静态过程](@entry_id:136273)中，对系统做的功才等于其自由能的变化。然而，对于在有限时间内发生的、不可避免地产生耗散的真实非平衡过程，这种简单的关系便不再成立。贾辛斯基等式恰恰为我们处理这类过程提供了一个极其强大的普适性工具。

该等式表述如下：
$$
\langle \exp(-\beta W) \rangle = \exp(-\beta \Delta F)
$$

为了深刻理解这一关系，我们必须精确地定义其中每一个符号的物理意义：

*   $W$ 指的是在**单次**非平衡过程中，外界对系统所做的**功**。由于系统与热库的相互作用，即使宏观的控制过程完全相同，系统经历的微观轨迹也千差万别。因此，$W$ 是一个依赖于具体微观路径的**[随机变量](@entry_id:195330) (stochastic variable)**，每次实验测量都可能得到不同的值。

*   $\langle \dots \rangle$ 表示**系综平均 (ensemble average)**。这意味着我们需要将同一个非平衡过程重复进行无数次。每一次重复都必须从同一个初始**热平衡态**出发，然后对所有这些实验中测得的 $\exp(-\beta W)$ 值进行平均。

*   $\beta$ 是与热库温度 $T$ 相关的[逆温](@entry_id:140086)标，定义为 $\beta = (k_B T)^{-1}$，其中 $k_B$ 是[玻尔兹曼常数](@entry_id:142384) (Boltzmann constant)。

*   $\Delta F = F_f - F_i$ 是系统在**平衡态**下的[亥姆霍兹自由能](@entry_id:136442)之差。$F_i$ 对应于过程开始前、由初始控制参数决定的平衡态的自由能；$F_f$ 则对应于过程结束后、由末端控制参数决定的**另一个**平衡态的自由能。至关重要的是，$\Delta F$ 是一个平衡态的性质，它与连接这两个状态的具体非[平衡路径](@entry_id:749059)无关。

贾辛斯基等式的惊人之处在于，它断言：一个涉及非平衡过程路径细节的、涨落量的[指数平均](@entry_id:749182)（等式左边），竟然精确地等于一个只依赖于初末平衡态的[状态函数](@entry_id:137683)之差（等式右边）。这一关系不受过程速度的快慢、具体操作路径的复杂性所影响，只要过程的起点和终点（由外部控制参数定义）是确定的，该等式就恒成立。

### 与[热力学第二定律](@entry_id:142732)的内在和谐

初看起来，贾辛斯基等式似乎与我们熟知的热力学第二定律相悖。热力学第二定律的一个推论是，在[等温过程](@entry_id:143096)中，对系统做的功必须大于或等于其自由能的变化，即 $W \ge \Delta F$。然而，贾辛斯基等式中包含了对所有可能的功值 $W$ 的平均，这其中是否允许出现 $W  \Delta F$ 的情况呢？如果允许，这是否“违反”了第二定律？

答案是，贾辛斯基等式不仅与第二定律完全兼容，并且可以通过数学工具从中推导出第二定律的不等式形式。这其中的关键是**琴生不等式 (Jensen's inequality)**。对于任意的凸函数 $f(x)$ 和[随机变量](@entry_id:195330) $X$，琴生不等式表明 $\langle f(X) \rangle \ge f(\langle X \rangle)$。

函数 $f(x) = \exp(x)$ 是一个典型的凸函数。让我们将琴生不等式应用于[随机变量](@entry_id:195330) $X = -\beta W$ [@problem_id:2004400]。我们得到：
$$
\langle \exp(-\beta W) \rangle \ge \exp(\langle -\beta W \rangle)
$$
利用贾辛斯基等式，我们可以将上式左边替换为 $\exp(-\beta \Delta F)$：
$$
\exp(-\beta \Delta F) \ge \exp(-\beta \langle W \rangle)
$$
由于指数函数是单调递增的，两边取自然对数后，不等号方向不变：
$$
-\beta \Delta F \ge -\beta \langle W \rangle
$$
最后，两边同乘以 $-1/\beta$（一个负数），不等号方向反转，我们便得到了：
$$
\langle W \rangle \ge \Delta F
$$
这正是在统计物理框架下[热力学第二定律](@entry_id:142732)的表述。它明确指出，对于非平衡过程，第二定律约束的是**平均功**，而非单次实验的功。因此，单次实验中偶尔出现的 $W  \Delta F$ 的轨迹并不会违反作为统计规律的第二定律。这个不等式也告诉我们，要将系统从状态A驱动到状态B，平均而言，我们至少需要做功 $\Delta F$ [@problem_id:2004400]。

### 涨落的关键作用与“反常”轨迹

既然我们已经证明了 $\langle W \rangle \ge \Delta F$，那么是否可能所有轨迹的功都满足 $W \ge \Delta F$ 呢？答案是否定的，而这恰恰是贾辛斯基等式最深刻和反直觉的内涵之一。

为了让等式 $\langle \exp(-\beta W) \rangle = \exp(-\beta \Delta F)$ 成立，**必须存在**功值 $W  \Delta F$ 的轨迹 [@problem_id:2004356]。我们可以通过[反证法](@entry_id:276604)来理解这一点。假设对于所有可能的轨迹，功都满足 $W \ge \Delta F$。由于函数 $f(W) = \exp(-\beta W)$ 是一个严格单调递减的函数，这意味着对于所有轨迹，我们都有 $\exp(-\beta W) \le \exp(-\beta \Delta F)$。

如果这是一个非[可逆过程](@entry_id:276625)，那么必然存在一些轨迹，其功 $W$ 会因为耗散而严格大于 $\Delta F$。对于这些轨迹，我们有 $\exp(-\beta W)  \exp(-\beta \Delta F)$。在对所有轨迹进行平均时，这些严格小于 $\exp(-\beta \Delta F)$ 的项必然会导致最终的平均值 $\langle \exp(-\beta W) \rangle$ 严格小于 $\exp(-\beta \Delta F)$。这与贾辛斯基等式相矛盾。

因此，为了使等式得以成立，系综中必须包含一些功值 $W  \Delta F$ 的轨迹，以“补偿”那些 $W > \Delta F$ 的轨迹所带来的影响。这些 $W  \Delta F$ 的轨迹，在物理上对应于系统在外界驱动的过程中，偶然地从热库中吸取了热量并将其转化为对外界做的功，从而使得总的净[功耗](@entry_id:264815)非常小，甚至小于自由能的增量。

[指数平均](@entry_id:749182) $\langle \exp(-\beta W) \rangle$ 的形式赋予了那些稀有的、功值较小的事件远大于其发生概率的权重。我们可以通过一个简化的模型来阐明这一点 [@problem_id:2004383]。假设在一个非平衡过程中，功只能取两个值：大概率发生的耗散性轨迹，其功为 $W_2 = \Delta F + W_d$；以及小概率发生的“反常”轨迹，其功为 $W_1 = \Delta F - W_d$，其中 $W_d > 0$。尽管后者的发生频率低，但它在[指数平均](@entry_id:749182)中对应的项 $\exp(-\beta W_1)$ 要远大于高功轨迹对应的项 $\exp(-\beta W_2)$，其比值为 $\exp(2\beta W_d)$。这意味着，在计算总的指数和时，功值较小的轨迹会被指数级地加权放大，从而足以抵消它们较低的发生概率。正是这种指数偏重，使得这些罕见的“第二定律瞬时违背”事件成为维持贾辛斯基等式成立的必要条件。

### 一个具体实例：被驱动的[谐振子](@entry_id:155622)

为了将抽象的等式具体化，让我们考虑一个被广泛研究的模型：一个被限制在一维[谐波](@entry_id:181533)[势阱](@entry_id:151413)中的经典粒子，该系统与恒定温度 $T$ 的热库接触 [@problem_id:2004361] [@problem_id:2004397]。[势能函数](@entry_id:200753)为 $U(x, k) = \frac{1}{2} k x^2$。在某个过程中，我们通过外部控制，将[势阱](@entry_id:151413)的“刚度”系数（弹簧常数）从初值 $k_i$ 任意地改变到终值 $k_f$。

根据贾辛斯基等式，要计算 $\langle \exp(-\beta W) \rangle$，我们首先需要计算初末[平衡态](@entry_id:168134)之间的自由能差 $\Delta F = F(k_f) - F(k_i)$。[亥姆霍兹自由能](@entry_id:136442) $F(k)$ 可以通过[配分函数](@entry_id:193625) $Z(k)$ 计算得到，$F(k) = -k_B T \ln Z(k)$。

对于一维[经典谐振子](@entry_id:153404)，其[配分函数](@entry_id:193625)为：
$$
Z(k) = \frac{1}{h} \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} \exp\left[-\beta \left(\frac{p^2}{2m} + \frac{1}{2}k x^2\right)\right] \, dx \, dp
$$
积分后我们发现 $Z(k)$ 正比于 $k^{-1/2}$。因此，自由能差为：
$$
\Delta F = F(k_f) - F(k_i) = -k_B T \ln\left(\frac{Z(k_f)}{Z(k_i)}\right) = -k_B T \ln\left(\left(\frac{k_f}{k_i}\right)^{-1/2}\right) = \frac{k_B T}{2} \ln\left(\frac{k_f}{k_i}\right)
$$
将此 $\Delta F$ 代入贾辛斯基等式：
$$
\langle \exp(-\beta W) \rangle = \exp\left(-\beta \left[\frac{k_B T}{2} \ln\left(\frac{k_f}{k_i}\right)\right]\right) = \exp\left(-\frac{1}{2} \ln\left(\frac{k_f}{k_i}\right)\right) = \left(\frac{k_f}{k_i}\right)^{-1/2} = \sqrt{\frac{k_i}{k_f}}
$$
这个优美的结果表明，无论我们以多快的速度、以何种方式（线性、正弦或其他任何方式）改变弹簧常数，只要初始和最终值确定，功的[指数平均](@entry_id:749182)值就只依赖于这两个值。

### 非平衡功的统计性质

功 $W$ 作为一个[随机变量](@entry_id:195330)，其统计分布本身就包含了丰富的[物理信息](@entry_id:152556)。我们可以通过考察一个极限情况——瞬时过程（或称“猝灭”），来深入理解功的统计性质 [@problem_id:2004369]。考虑一个[谐振子势](@entry_id:750179)阱 $U(x, \lambda) = \frac{1}{2}k(x-\lambda)^2$，其中心位置 $\lambda$ 被瞬间从 $0$ 移动到 $\lambda_0$。

在这种瞬时过程中，粒子的位置来不及改变。因此，对于一个初始位于 $x$ 的粒子，所做的功就是[势能](@entry_id:748988)在该位置的变化量：
$$
W(x) = U(x, \lambda_0) - U(x, 0) = \frac{1}{2}k(x-\lambda_0)^2 - \frac{1}{2}kx^2 = -k\lambda_0 x + \frac{1}{2}k\lambda_0^2
$$
功 $W$ 的随机性完全来自于初始位置 $x$ 在平衡态下的[热涨落](@entry_id:143642)。在初始的玻尔兹曼分布下，$\langle x \rangle = 0$，而根据[能量均分定理](@entry_id:136972)，$\langle x^2 \rangle = k_B T / k$。

利用这些，我们可以计算功的平均值和[方差](@entry_id:200758)：
$$
\langle W \rangle = \langle -k\lambda_0 x + \frac{1}{2}k\lambda_0^2 \rangle = -k\lambda_0 \langle x \rangle + \frac{1}{2}k\lambda_0^2 = \frac{1}{2}k\lambda_0^2
$$
$$
\sigma_W^2 = \langle (W - \langle W \rangle)^2 \rangle = \langle (-k\lambda_0 x)^2 \rangle = k^2 \lambda_0^2 \langle x^2 \rangle = k^2 \lambda_0^2 \left(\frac{k_B T}{k}\right) = k k_B T \lambda_0^2
$$
这个结果非常富有启发性。首先，平均功 $\langle W \rangle$ 在这种情况下大于自由能差 $\Delta F$（在这种情况下，由于[配分函数](@entry_id:193625)与 $\lambda$ 无关，$\Delta F = 0$ [@problem_id:2004377]），这部分多出来的功 $\langle W_{diss} \rangle = \langle W \rangle - \Delta F = \frac{1}{2}k\lambda_0^2$ 被称为平均[耗散功](@entry_id:748576)。其次，功的[方差](@entry_id:200758) $\sigma_W^2$ 正比于温度 $T$，这直接将宏观的[功涨落](@entry_id:155175)与微观的热运动联系起来，体现了涨落-耗散关系的深层思想。

### 基本前提：初始的正则系综

贾辛斯基等式虽然强大，但它的成立依赖于一个至关重要的前提条件：**过程必须从一个处于正则系综（canonical ensemble）描述的[热平衡](@entry_id:141693)态开始** [@problem_id:2004335]。这意味着在过程开始前，系统已经与[热库](@entry_id:143608)充分交换能量，其微观状态的[概率分布](@entry_id:146404)遵循玻尔兹曼分布。

我们可以通过一个思想实验来理解这一点。设想两个实验，都涉及将[谐振子](@entry_id:155622)的刚度从 $\lambda_A$ 变为 $\lambda_B$。

*   **实验 1**：每次实验开始前，都让系统在 $\lambda = \lambda_A$ 的条件下与热库达到完全平衡。然后执行改变 $\lambda$ 的过程。在这种情况下，初始态是标准的[正则系综](@entry_id:142391)，贾辛斯基等式成立，我们得到 $\langle \exp(-\beta W) \rangle_1 = \exp(-\beta \Delta F)$。

*   **实验 2**：每次实验都从一个完全确定的微观状态开始，例如，将粒子精确地置于[势阱](@entry_id:151413)底部 $x=0$，且初始动量为 $p=0$。然后执行同样的过程。由于初始状态不是一个热[平衡[分](@entry_id:263943)布](@entry_id:182848)，贾辛斯基等式的前提不被满足。事实上，对于一个从 $(x, p) = (0, 0)$ 开始的驱动过程，如果[势阱](@entry_id:151413)中心不移动，粒子会一直保持静止，做的功恒为零。因此，$\langle \exp(-\beta W) \rangle_2 = \exp(0) = 1$。这个结果通常不等于 $\exp(-\beta \Delta F)$（除非 $\Delta F = 0$）。

这个对比鲜明地揭示了，贾辛斯基等式并非一个可以应用于任何动力学过程的自然法则，而是一个在特定统计假设（初始为[正则系综](@entry_id:142391)）下成立的数学恒等式。

### 从理论到实践：测量单分子的自由能

贾辛斯基等式的巨大价值之一在于它为实验测量[平衡态](@entry_id:168134)自由能差提供了一种全新的、基于非平衡测量的方法。这在生物物理等领域尤其重要，例如，在研究[DNA解链](@entry_id:181106)或[蛋白质折叠](@entry_id:136349)时，很难实现真正的[准静态过程](@entry_id:136273)。

利用光镊技术拉伸单个高分子就是一个典型的例子 [@problem_id:2004396]。实验中，可以通过重复快速地拉伸一个分子，每次都记录下所做的功 $W_i$。即使每次拉伸都是一个快速的非平衡过程，我们也可以通过对收集到的一组功值 $\{W_1, W_2, \dots, W_N\}$ 进行计算，来估计平衡态的自由能差 $\Delta F$。

在实践中，系综平均被样本均值所近似：
$$
\langle \exp(-\beta W) \rangle \approx \frac{1}{N} \sum_{i=1}^{N} \exp(-\beta W_i)
$$
因此，自由能差可以通过下式估算：
$$
\Delta F \approx -k_B T \ln\left(\frac{1}{N} \sum_{i=1}^{N} \exp(-\beta W_i)\right)
$$
例如，假设在 $T=300 \text{ K}$ 时，通过5次拉伸实验测得功值为 $30.5, 32.0, 29.8, 35.1, 31.2$ (单位为 $10^{-21} \text{ J}$)。通过计算每个功值的 $\exp(-\beta W_i)$，求和再平均，最后取对数并乘以 $-k_B T$，我们就能得到 $\Delta F \approx 3.14 \times 10^{-20} \text{ J}$ [@problem_id:2004396]。这种方法使得测量那些传统[热力学](@entry_id:141121)方法难以企及的微小系统的能量变化成为可能。然而，值得注意的是，由于[指数平均](@entry_id:749182)对低功值事件的极端敏感性，要获得一个收敛的、准确的 $\Delta F$ 估计值，往往需要大量的实验重复次数。

### 一个可精确求解的模型：[二能级系统](@entry_id:138452)

为了进一步建立直观的理解，我们可以展示对于一个极其简单的离散系统，贾辛斯基等式可以直接从第一性原理推导出来，而无需援引其完整的、更为复杂的证明 [@problem_id:2004390]。

考虑一个只有两个能级 $E_1$ 和 $E_2$ 的系统，初始处于平衡态。其初态的[配分函数](@entry_id:193625)为 $Z_i = \exp(-\beta E_1) + \exp(-\beta E_2)$。系统处于这两个能级的概率分别为 $p_1 = \exp(-\beta E_1)/Z_i$ 和 $p_2 = \exp(-\beta E_2)/Z_i$。

现在，我们瞬间将能级改变为 $E'_1$ 和 $E'_2$。如果系统初始在能级1，做的功就是 $W_1 = E'_1 - E_1$。如果初始在能级2，功就是 $W_2 = E'_2 - E_2$。

现在我们来计算功的[指数平均](@entry_id:749182)：
$$
\langle \exp(-\beta W) \rangle = p_1 \exp(-\beta W_1) + p_2 \exp(-\beta W_2)
$$
代入 $p_1, p_2, W_1, W_2$ 的表达式：
$$
\langle \exp(-\beta W) \rangle = \frac{\exp(-\beta E_1)}{Z_i} \exp(-\beta (E'_1 - E_1)) + \frac{\exp(-\beta E_2)}{Z_i} \exp(-\beta (E'_2 - E_2))
$$
$$
= \frac{\exp(-\beta E'_1) + \exp(-\beta E'_2)}{Z_i} = \frac{Z_f}{Z_i}
$$
其中 $Z_f$ 是末态的[配分函数](@entry_id:193625)。我们知道 $\Delta F = F_f - F_i = -k_B T \ln(Z_f/Z_i)$，因此 $Z_f/Z_i = \exp(-\beta \Delta F)$。这样，我们就直接验证了 $\langle \exp(-\beta W) \rangle = \exp(-\beta \Delta F)$。这个简单的例子清晰地揭示了等式是如何通过对初始平衡态概率和相应路径功的加权平均而自然产生的。

综上所述，贾辛斯基等式不仅是一个深刻的理论结果，更是一个连接理论与实验、平衡与非平衡的强大工具。它迫使我们重新审视热力学第二定律的统计本质，并为在微观尺度上探索和量化[能量转换](@entry_id:165656)提供了全新的视角。