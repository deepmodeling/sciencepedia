{"hands_on_practices": [{"introduction": "我们对经典密度泛函理论的探索始于一项基本技能：从已知的粒子密度计算系统性质。这个练习提供了一个具体的起点，要求你计算在谐振子势阱中，简单理想气体的总外势能。掌握这个“正向问题”[@problem_id:2059839]，是理解密度分布在描述多体系统中所扮演核心角色的第一步。", "problem": "考虑一个一维系统，它由$N$个无相互作用的经典粒子组成，在恒定绝对温度$T$下处于热平衡状态。这些粒子被一个外部谐振子势 $V_{\\text{ext}}(x) = \\frac{1}{2} k x^2$ 所约束，其中$k$是一个正常数，$x$是位置。\n\n在经典统计力学的框架下，这些粒子的空间分布可以用粒子数密度$\\rho(x)$来描述，该密度表示在位置$x$处单位长度内的粒子数。对于这个系统，其平衡粒子密度为一个高斯函数：\n$$\n\\rho(x) = N \\sqrt{\\frac{\\beta k}{2\\pi}} \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right)\n$$\n其中 $\\beta = \\frac{1}{k_B T}$，$k_B$是玻尔兹曼常数。\n\n计算由外部约束势引起的、存储在整个粒子系统中的总势能。请将您的答案表示为一个解析闭式表达式，用总粒子数$N$、玻尔兹曼常数$k_B$和温度$T$表示。", "solution": "在存在外部势$V_{\\text{ext}}(x)$的情况下，一个由粒子数密度$\\rho(x)$描述的系统的总外部势能$U_{\\text{ext}}$由能量密度在整个空间上的积分给出。在点$x$处的能量密度是粒子密度$\\rho(x)$与每个粒子的势能$V_{\\text{ext}}(x)$的乘积。\n\n其定义积分为：\n$$\nU_{\\text{ext}} = \\int_{-\\infty}^{\\infty} \\rho(x) V_{\\text{ext}}(x) \\, dx\n$$\n\n我们已知粒子密度和外部势的表达式：\n$$\n\\rho(x) = N \\sqrt{\\frac{\\beta k}{2\\pi}} \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right)\n$$\n$$\nV_{\\text{ext}}(x) = \\frac{1}{2} k x^2\n$$\n\n将这些表达式代入$U_{\\text{ext}}$的积分中：\n$$\nU_{\\text{ext}} = \\int_{-\\infty}^{\\infty} \\left( N \\sqrt{\\frac{\\beta k}{2\\pi}} \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right) \\right) \\left( \\frac{1}{2} k x^2 \\right) \\, dx\n$$\n\n我们可以将所有常数项移到积分符号外：\n$$\nU_{\\text{ext}} = N \\left( \\sqrt{\\frac{\\beta k}{2\\pi}} \\right) \\left( \\frac{k}{2} \\right) \\int_{-\\infty}^{\\infty} x^2 \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right) \\, dx\n$$\n\n为计算该积分，我们可以使用形式为 $\\int_{-\\infty}^{\\infty} x^{2n} \\exp(-ax^2) \\, dx$ 的高斯积分的标准结果。让我们首先考虑基本的高斯积分：\n$$\nI_0(a) = \\int_{-\\infty}^{\\infty} \\exp(-ax^2) \\, dx = \\sqrt{\\frac{\\pi}{a}}\n$$\n我们可以通过对$I_0(a)$关于参数$a$求导来得到我们需要的积分 $\\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) \\, dx$：\n$$\n\\frac{d}{da} I_0(a) = \\frac{d}{da} \\int_{-\\infty}^{\\infty} \\exp(-ax^2) \\, dx\n$$\n使用在积分号下求导的Leibniz法则：\n$$\n\\frac{d}{da} I_0(a) = \\int_{-\\infty}^{\\infty} \\frac{\\partial}{\\partial a} \\exp(-ax^2) \\, dx = \\int_{-\\infty}^{\\infty} (-x^2) \\exp(-ax^2) \\, dx = - \\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) \\, dx\n$$\n我们也对$I_0(a)$表达式的右侧进行求导：\n$$\n\\frac{d}{da} \\left( \\sqrt{\\frac{\\pi}{a}} \\right) = \\sqrt{\\pi} \\frac{d}{da} (a^{-1/2}) = \\sqrt{\\pi} \\left( -\\frac{1}{2} a^{-3/2} \\right) = -\\frac{1}{2} \\sqrt{\\frac{\\pi}{a^3}}\n$$\n令两个导数结果相等：\n$$\n- \\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) \\, dx = -\\frac{1}{2} \\sqrt{\\frac{\\pi}{a^3}}\n$$\n因此，我们需要的积分为：\n$$\n\\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) \\, dx = \\frac{1}{2} \\sqrt{\\frac{\\pi}{a^3}}\n$$\n在我们的具体问题中，参数$a$对应于$a = \\frac{1}{2}\\beta k$。将此代入积分结果：\n$$\n\\int_{-\\infty}^{\\infty} x^2 \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right) \\, dx = \\frac{1}{2} \\sqrt{\\frac{\\pi}{(\\frac{1}{2}\\beta k)^3}} = \\frac{1}{2} \\sqrt{\\frac{8\\pi}{(\\beta k)^3}} = \\frac{1}{2} \\frac{2\\sqrt{2\\pi}}{(\\beta k)^{3/2}} = \\frac{\\sqrt{2\\pi}}{(\\beta k)^{3/2}}\n$$\n现在，我们将此结果代回到$U_{\\text{ext}}$的表达式中：\n$$\nU_{\\text{ext}} = N \\left( \\sqrt{\\frac{\\beta k}{2\\pi}} \\right) \\left( \\frac{k}{2} \\right) \\left( \\frac{\\sqrt{2\\pi}}{(\\beta k)^{3/2}} \\right)\n$$\n让我们来简化这个代数表达式：\n$$\nU_{\\text{ext}} = \\frac{Nk}{2} \\left( \\frac{(\\beta k)^{1/2}}{(2\\pi)^{1/2}} \\right) \\left( \\frac{(2\\pi)^{1/2}}{(\\beta k)^{3/2}} \\right)\n$$\n$\\sqrt{2\\pi}$项相互抵消：\n$$\nU_{\\text{ext}} = \\frac{Nk}{2} \\frac{(\\beta k)^{1/2}}{(\\beta k)^{3/2}} = \\frac{Nk}{2} (\\beta k)^{1/2 - 3/2} = \\frac{Nk}{2} (\\beta k)^{-1}\n$$\n$$\nU_{\\text{ext}} = \\frac{Nk}{2} \\frac{1}{\\beta k} = \\frac{N}{2\\beta}\n$$\n最后，我们代入定义 $\\beta = \\frac{1}{k_B T}$：\n$$\nU_{\\text{ext}} = \\frac{N}{2(1/k_B T)} = \\frac{1}{2} N k_B T\n$$\n这个结果与能量均分定理一致，该定理指出每个二次自由度（如势能 $V \\propto x^2$）对系统贡献的平均能量为 $\\frac{1}{2}k_B T$。对于$N$个粒子，总势能为 $N \\times \\frac{1}{2}k_B T$。", "answer": "$$\\boxed{\\frac{1}{2} N k_{B} T}$$", "id": "2059839"}, {"introduction": "在了解了如何从给定的密度计算能量之后，我们现在来解决一个更深刻的“逆向问题”。这个练习体现了密度泛函理论的核心原则之一：确定能够稳定任何期望密度分布的唯一外势的能力。通过求解能够为相互作用流体产生特定高斯密度分布的势场[@problem_id:2059864]，你将练习泛函微分这一关键技术，并深入了解多粒子系统的设计与控制。", "problem": "在经典密度泛函理论 (DFT) 的框架内，流体的平衡性质由其单体密度分布 $\\rho(\\mathbf{r})$ 描述。考虑一个在恒定温度 $T$ 下，被限制在 $x$ 轴上的一维相互作用粒子流体。该流体的内禀亥姆霍兹自由能泛函 $F[\\rho]$ 通过一个模型来近似，该模型在局域平均场水平上同时包含了理想气体贡献和对偶相互作用：\n$$F[\\rho] = k_B T \\int_{-\\infty}^{\\infty} \\rho(x) \\left[\\ln(\\rho(x) \\Lambda) - 1\\right] dx + \\frac{A}{2} \\int_{-\\infty}^{\\infty} [\\rho(x)]^2 dx$$\n此处，$k_B$ 是玻尔兹曼常数，$\\Lambda$ 是代表理想气体贡献的热德布罗意波长，$A$ 是一个量化粒子间排斥相互作用强度的正常数。\n\nDFT 的 Hohenberg-Kohn 定理指出，对于一个处于固定温度和化学势 $\\mu$ 的系统，存在一个唯一的外势 $V_{\\text{ext}}(x)$，它可以稳定任何给定的非简并基态密度分布 $\\rho(x)$。这个平衡密度是使巨势泛函 $\\Omega[\\rho] = F[\\rho] + \\int \\rho(x) [V_{\\text{ext}}(x) - \\mu] dx$ 最小化的密度。\n\n你的任务是解决逆问题：确定稳定一个由高斯函数给出的特定目标密度分布所需的外势 $V_{\\text{ext}}(x)$：\n$$\\rho_{\\text{target}}(x) = \\rho_0 \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)$$\n其中 $\\rho_0$ 是 $x=0$ 处的峰值密度，$\\sigma$ 是一个特征宽度。\n\n由于势的定义只取决于一个任意的加性常数，请用 $k_B, T, A, \\rho_0, \\sigma$ 和坐标 $x$ 来表示你的最终答案，即势差 $V_{\\text{ext}}(x) - V_{\\text{ext}}(0)$。", "solution": "我们从固定温度和化学势下的巨势泛函开始，\n$$\n\\Omega[\\rho] = F[\\rho] + \\int_{-\\infty}^{\\infty} \\rho(x) \\left[V_{\\text{ext}}(x) - \\mu \\right] dx,\n$$\n平衡分布满足欧拉-拉格朗日条件\n$$\n\\frac{\\delta \\Omega}{\\delta \\rho(x)} = 0 \\quad \\Rightarrow \\quad \\frac{\\delta F}{\\delta \\rho(x)} + V_{\\text{ext}}(x) - \\mu = 0.\n$$\n对于给定的泛函，\n$$\nF[\\rho] = k_{B} T \\int_{-\\infty}^{\\infty} \\rho(x) \\left[\\ln\\!\\big(\\rho(x)\\Lambda\\big) - 1\\right] dx + \\frac{A}{2} \\int_{-\\infty}^{\\infty} \\left[\\rho(x)\\right]^{2} dx,\n$$\n我们局域地计算每个泛函导数。对于理想气体部分，使用 $f(\\rho)=\\rho\\left[\\ln(\\rho\\Lambda)-1\\right]$，\n$$\n\\frac{d f}{d \\rho} = \\ln(\\rho \\Lambda) + \\rho \\frac{1}{\\rho} - 1 = \\ln(\\rho \\Lambda),\n$$\n所以\n$$\n\\frac{\\delta F_{\\text{id}}}{\\delta \\rho(x)} = k_{B} T \\ln\\!\\big(\\rho(x)\\Lambda\\big).\n$$\n对于相互作用项，\n$$\n\\frac{\\delta}{\\delta \\rho(x)} \\left[\\frac{A}{2} \\int \\rho^{2}(x') dx' \\right] = A \\rho(x).\n$$\n因此，\n$$\n\\frac{\\delta F}{\\delta \\rho(x)} = k_{B} T \\ln\\!\\big(\\rho(x)\\Lambda\\big) + A \\rho(x).\n$$\n欧拉-拉格朗日方程得出\n$$\nV_{\\text{ext}}(x) = \\mu - k_{B} T \\ln\\!\\big(\\rho(x)\\Lambda\\big) - A \\rho(x).\n$$\n势的定义可相差一个加性常数，因此我们考虑其差值\n$$\nV_{\\text{ext}}(x) - V_{\\text{ext}}(0) = - k_{B} T \\left[\\ln\\!\\big(\\rho(x)\\Lambda\\big) - \\ln\\!\\big(\\rho(0)\\Lambda\\big)\\right] - A \\left[\\rho(x) - \\rho(0)\\right].\n$$\n因子 $\\Lambda$ 在对数内部被消去，得到\n$$\nV_{\\text{ext}}(x) - V_{\\text{ext}}(0) = - k_{B} T \\ln\\!\\left(\\frac{\\rho(x)}{\\rho(0)}\\right) - A \\left[\\rho(x) - \\rho(0)\\right].\n$$\n对于目标高斯密度分布\n$$\n\\rho_{\\text{target}}(x) = \\rho_{0} \\exp\\!\\left(-\\frac{x^{2}}{2 \\sigma^{2}}\\right),\n$$\n我们有 $\\rho(0)=\\rho_{0}$ 并且\n$$\n\\ln\\!\\left(\\frac{\\rho(x)}{\\rho(0)}\\right) = -\\frac{x^{2}}{2 \\sigma^{2}}, \\qquad \\rho(x) - \\rho(0) = \\rho_{0} \\left[\\exp\\!\\left(-\\frac{x^{2}}{2 \\sigma^{2}}\\right) - 1\\right].\n$$\n代入势差表达式中，得到\n$$\nV_{\\text{ext}}(x) - V_{\\text{ext}}(0) = k_{B} T \\frac{x^{2}}{2 \\sigma^{2}} + A \\rho_{0} \\left[1 - \\exp\\!\\left(-\\frac{x^{2}}{2 \\sigma^{2}}\\right)\\right].\n$$\n这就将所需的外势差完全用 $k_{B}, T, A, \\rho_{0}, \\sigma$ 和 $x$ 表示出来了。", "answer": "$$\\boxed{\\frac{k_{B} T}{2 \\sigma^{2}} x^{2} + A \\rho_{0} \\left[1 - \\exp\\left(-\\frac{x^{2}}{2 \\sigma^{2}}\\right)\\right]}$$", "id": "2059864"}, {"introduction": "在许多现实情景中，特别是涉及粒子间相互作用的情况下，直接解析地求解平衡密度分布是不可能的。因此，我们转而使用强大的迭代方法。这个练习[@problem_id:2059887]通过引导你完成迭代计算的第一步，让你亲身体验这种自洽场方法。你将看到一个简单的初始猜测（如理想气体解）如何被系统地修正以计入相互作用，这正反映了现代密度泛函理论研究中的核心计算技术。", "problem": "在经典密度泛函理论（DFT）的框架下，相互作用粒子的一维流体的平衡粒子密度分布 $\\rho(x)$ 可以通过求解一个自洽方程来找到。这通常通过使用迭代程序进行数值求解。\n\n考虑这样一个处于恒定温度 $T$ 下的流体。粒子被外部势场限制，并通过对势相互作用。密度的自洽方程可以表示为一个迭代映射。从密度分布 $\\rho_0(x)$ 的一个初始猜测开始，生成后续的近似值 $\\rho_n(x)$。对于这个特定系统，连接一次迭代到下一次迭代的更新规则由下式给出：\n\n$$ \\rho_{n+1}(x) = \\rho_0(x) \\exp\\left(-\\frac{V_{int}[\\rho_n](x)}{k_B T}\\right) $$\n\n其中 $k_B$ 是玻尔兹曼常数。项 $V_{int}[\\rho_n](x)$ 表示在位置 $x$ 的粒子所经历的平均场相互作用势，由所有其他具有密度分布 $\\rho_n(x)$ 的粒子产生。它被定义为一个卷积：\n\n$$ V_{int}[\\rho_n](x) = \\int_{-\\infty}^{\\infty} U(x-x')\\rho_n(x')dx' $$\n\n迭代从该系统的无相互作用版本的已知平衡密度分布开始，这是一个高斯函数：\n$$ \\rho_0(x) = \\rho_c \\exp\\left(-\\frac{x^2}{2\\sigma_0^2}\\right) $$\n在这里，$\\rho_c$ 是势阱中心的峰值密度，而 $\\sigma_0$ 是密度分布的特征宽度。\n\n粒子间的有效对相互作用由一个软核排斥高斯势建模：\n$$ U(r) = A \\exp\\left(-\\frac{r^2}{2\\sigma_i^2}\\right) $$\n其中 $A  0$ 是相互作用强度，$\\sigma_i$ 是相互作用范围。\n\n你的任务是执行这个迭代过程的第一步。从初始猜测 $\\rho_0(x)$ 开始，计算密度分布 $\\rho_1(x)$。具体来说，确定系统中心（$x=0$）在第一次迭代后的密度 $\\rho_1(0)$ 与初始中心密度 $\\rho_c$ 之比的符号表达式。", "solution": "我们已知迭代更新规则\n$$\\rho_{n+1}(x)=\\rho_{0}(x)\\exp\\left(-\\frac{V_{int}[\\rho_{n}](x)}{k_{B}T}\\right),$$\n以及\n$$V_{int}[\\rho_{n}](x)=\\int_{-\\infty}^{\\infty}U(x-x')\\rho_{n}(x')\\,dx',$$\n和初始密度\n$$\\rho_{0}(x)=\\rho_{c}\\exp\\left(-\\frac{x^{2}}{2\\sigma_{0}^{2}}\\right),$$\n以及高斯对势\n$$U(r)=A\\exp\\left(-\\frac{r^{2}}{2\\sigma_{i}^{2}}\\right), \\quad A0.$$\n\n对于第一次迭代，我们需要\n$$\\rho_{1}(x)=\\rho_{0}(x)\\exp\\left(-\\frac{V_{int}[\\rho_{0}](x)}{k_{B}T}\\right).$$\n在中心，$x=0$ 处，这变为\n$$\\rho_{1}(0)=\\rho_{0}(0)\\exp\\left(-\\frac{V_{int}[\\rho_{0}](0)}{k_{B}T}\\right)=\\rho_{c}\\exp\\left(-\\frac{V_{int}[\\rho_{0}](0)}{k_{B}T}\\right).$$\n因此，所求的比率为\n$$\\frac{\\rho_{1}(0)}{\\rho_{c}}=\\exp\\left(-\\frac{V_{int}[\\rho_{0}](0)}{k_{B}T}\\right).$$\n\n剩下的任务是计算 $V_{int}[\\rho_{0}](0)$。使用卷积的定义和 $U$ 的偶函数性质，\n$$V_{int}[\\rho_{0}](0)=\\int_{-\\infty}^{\\infty}U(-x')\\rho_{0}(x')\\,dx'=\\int_{-\\infty}^{\\infty}U(x')\\rho_{0}(x')\\,dx'.$$\n代入给定的形式，\n$$V_{int}[\\rho_{0}](0)=\\int_{-\\infty}^{\\infty}A\\exp\\left(-\\frac{{x'}^{2}}{2\\sigma_{i}^{2}}\\right)\\,\\rho_{c}\\exp\\left(-\\frac{{x'}^{2}}{2\\sigma_{0}^{2}}\\right)\\,dx' = A\\rho_{c}\\int_{-\\infty}^{\\infty}\\exp\\left[-\\frac{{x'}^{2}}{2}\\left(\\frac{1}{\\sigma_{i}^{2}}+\\frac{1}{\\sigma_{0}^{2}}\\right)\\right]dx'.$$\n定义 $s$ 如下\n$$\\frac{1}{s^{2}}=\\frac{1}{\\sigma_{i}^{2}}+\\frac{1}{\\sigma_{0}^{2}}=\\frac{\\sigma_{0}^{2}+\\sigma_{i}^{2}}{\\sigma_{i}^{2}\\sigma_{0}^{2}}, \\quad \\text{所以} \\quad s^{2}=\\frac{\\sigma_{i}^{2}\\sigma_{0}^{2}}{\\sigma_{i}^{2}+\\sigma_{0}^{2}}, \\quad s=\\frac{\\sigma_{i}\\sigma_{0}}{\\sqrt{\\sigma_{i}^{2}+\\sigma_{0}^{2}}}.$$\n那么该积分为标准高斯积分，\n$$\\int_{-\\infty}^{\\infty}\\exp\\left(-\\frac{{x'}^{2}}{2s^{2}}\\right)dx'=s\\sqrt{2\\pi},$$\n所以\n$$V_{int}[\\rho_{0}](0)=A\\rho_{c}\\,s\\sqrt{2\\pi}=A\\rho_{c}\\sqrt{2\\pi}\\,\\frac{\\sigma_{i}\\sigma_{0}}{\\sqrt{\\sigma_{i}^{2}+\\sigma_{0}^{2}}}.$$\n\n将此结果代入比率中，得到\n$$\\frac{\\rho_{1}(0)}{\\rho_{c}}=\\exp\\left(-\\frac{A\\rho_{c}\\sqrt{2\\pi}\\,\\sigma_{i}\\sigma_{0}}{k_{B}T\\,\\sqrt{\\sigma_{i}^{2}+\\sigma_{0}^{2}}}\\right).$$\n这就是所求的符号表达式。", "answer": "$$\\boxed{\\exp\\!\\left(-\\frac{A\\,\\rho_{c}\\,\\sqrt{2\\pi}\\,\\sigma_{i}\\sigma_{0}}{k_{B}T\\,\\sqrt{\\sigma_{i}^{2}+\\sigma_{0}^{2}}}\\right)}$$", "id": "2059887"}]}