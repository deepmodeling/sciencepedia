{"hands_on_practices": [{"introduction": "理论是基础，但真正掌握辛积分器需要亲自动手计算。本练习将引导你使用一种基本的辛积分器——辛欧拉B方法——来手动执行单步积分。通过为一个简单的物理系统（此处的运动方程类似于单摆）计算其在相空间中的演化，你将熟悉辛积分算法的核心更新规则[@problem_id:2060449]。", "problem": "一个粒子在一维相空间中的状态由其位置 $q$ 和动量 $p$ 描述。控制该系统演化的方程如下：\n$$ \\frac{dq}{dt} = p $$\n$$ \\frac{dp}{dt} = -\\sin(q) $$\n为了数值近似计算粒子的轨迹，我们使用一个辛积分格式。将状态从时间 $t_n$ 的 $(q_n, p_n)$ 推进到时间 $t_{n+1} = t_n + \\Delta t$ 的 $(q_{n+1}, p_{n+1})$ 的更新规则由辛欧拉B方法给出：\n1.  更新位置：$q_{n+1} = q_n + \\Delta t \\cdot p_n$\n2.  更新动量：$p_{n+1} = p_n - \\Delta t \\cdot \\sin(q_{n+1})$\n\n注意，动量更新使用了新计算出的位置 $q_{n+1}$。\n\n给定粒子的初始状态为 $(q_0, p_0) = (0, 1)$，请确定经过一个大小为 $\\Delta t$ 的时间步长后，粒子的状态 $(q_1, p_1)$。用包含 $\\Delta t$ 的表达式对来表示你的答案 $q_1$ 和 $p_1$。", "solution": "给定系统的演化方程为 $dq/dt=p$ 和 $dp/dt=-\\sin(q)$，以及辛欧拉B更新规则：\n$$q_{n+1}=q_{n}+\\Delta t\\, p_{n},$$\n$$p_{n+1}=p_{n}-\\Delta t\\, \\sin(q_{n+1}).$$\n初始状态为 $(q_{0},p_{0})=(0,1)$，将 $n=0$ 代入位置更新公式：\n$$q_{1}=q_{0}+\\Delta t\\, p_{0}=0+\\Delta t \\cdot 1=\\Delta t.$$\n接下来，使用新计算出的 $q_{1}$ 来更新动量：\n$$p_{1}=p_{0}-\\Delta t\\, \\sin(q_{1})=1-\\Delta t\\, \\sin(\\Delta t).$$\n因此，经过一个大小为 $\\Delta t$ 的时间步长后，状态为 $(q_{1},p_{1})=(\\Delta t,\\;1-\\Delta t\\, \\sin(\\Delta t))$。", "answer": "$$\\boxed{\\begin{pmatrix}\\Delta t  1-\\Delta t \\sin(\\Delta t)\\end{pmatrix}}$$", "id": "2060449"}, {"introduction": "辛积分器的“辛”字究竟意味着什么？它指的是这些算法能够保持哈密顿系统相空间的几何结构，具体表现为保持面积（或体积）不变。这个练习让你直观地看到辛积分器与非辛积分器的根本区别：通过计算一个初始相空间区域在两种不同方法下的演化，你将定量地验证辛方法是如何保持面积的，而非辛方法则不能[@problem_id:2060446]。", "problem": "哈密顿系统数值模拟中的一个基本概念是相空间体积的守恒，这一性质被称为辛性 (symplecticity)。本问题通过研究非辛积分器和辛积分器如何变换相空间中的一个面积元，来探讨它们之间的差异。\n\n考虑一个一维谐振子，其动力学由无量纲的哈密顿量 $H(q, p) = \\frac{1}{2}(p^2 + q^2)$ 决定，其中 $q$ 是位置，$p$ 是动量。相应的运动方程为 $\\dot{q} = p$ 和 $\\dot{p} = -q$。\n\n我们将使用两种不同的数值积分方案，以固定的时间步长 $\\Delta t$ 来分析系统的演化。\n\n**方法1（前向欧拉法）：**\n在时间步 $n+1$ 的状态 $(q_{n+1}, p_{n+1})$ 是通过使用前向欧拉法从时间步 $n$ 的状态 $(q_n, p_n)$ 计算得出的：\n$q_{n+1} = q_n + \\Delta t \\cdot p_n$\n$p_{n+1} = p_n - \\Delta t \\cdot q_n$\n\n**方法2（辛欧拉A法）：**\n状态通过半隐式或辛欧拉方案更新如下：\n$p_{n+1} = p_n - \\Delta t \\cdot q_n$\n$q_{n+1} = q_n + \\Delta t \\cdot p_{n+1}$\n\n相空间中一个初始的小方形区域由其四个顶点定义，中心位于 $(q_c, p_c) = (1.2, 0.5)$。顶点位于 $(1.2 \\pm 0.01, 0.5 \\pm 0.01)$。\n\n使用方法1和方法2，将大小为 $\\Delta t = 0.15$ 的单个时间步应用于这四个顶点。这会将初始的正方形变换为两个不同的平行四边形。设 $A_{FE}$ 是由方法1产生的平行四边形的面积，而 $A_{SEA}$ 是由方法2产生的平行四边形的面积。\n\n计算比率 $\\frac{A_{FE}}{A_{SEA}}$。请将您的答案以四位有效数字的形式给出。", "solution": "我们考虑每种方法单步时间演化所诱导的线性映射。对于一个线性更新 $(q_{n+1},p_{n+1})^{T} = M (q_{n},p_{n})^{T}$，任何小区域的面积都会乘以 $|\\det M|$。由于谐振子和这里的两种积分器都是关于 $(q,p)$ 的线性变换，雅可比矩阵在整个相平面上是常数，因此面积缩放对于整个区域是相同的，与其中心和大小无关。\n\n令 $h=\\Delta t$。\n\n方法1（前向欧拉法）：更新方式为\n$$\n\\begin{pmatrix}\nq_{n+1}\\\\\np_{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & h\\\\\n-h & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nq_{n}\\\\\np_{n}\n\\end{pmatrix}.\n$$\n因此 $M_{FE}=\\begin{pmatrix}1 & h\\\\ -h & 1\\end{pmatrix}$ 且\n$$\n\\det M_{FE} = 1\\cdot 1 - (h)(-h) = 1 + h^{2}.\n$$\n因此面积按 $A_{FE} = (1+h^{2})A_{0}$ 比例缩放，其中 $A_{0}$ 是初始正方形的面积。\n\n方法2（辛欧拉A法）：更新方式为\n$$\np_{n+1}=p_{n}-h q_{n},\\qquad q_{n+1}=q_{n}+h p_{n+1}=q_{n}+h p_{n}-h^{2} q_{n}=(1-h^{2})q_{n}+h p_{n}.\n$$\n因此\n$$\n\\begin{pmatrix}\nq_{n+1}\\\\\np_{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1-h^{2} & h\\\\\n-h & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nq_{n}\\\\\np_{n}\n\\end{pmatrix},\n$$\n所以 $M_{SEA}=\\begin{pmatrix}1-h^{2} & h\\\\ -h & 1\\end{pmatrix}$ 且\n$$\n\\det M_{SEA}=(1-h^{2})\\cdot 1 - h(-h) = 1-h^{2}+h^{2}=1.\n$$\n因此 $A_{SEA}=A_{0}$。\n\n所求的比率为\n$$\n\\frac{A_{FE}}{A_{SEA}}=\\frac{(1+h^{2})A_{0}}{A_{0}}=1+h^{2}.\n$$\n当 $h=\\Delta t=0.15$ 时，我们得到\n$$\n\\frac{A_{FE}}{A_{SEA}}=1+0.15^{2}=1.0225,\n$$\n四舍五入到四位有效数字后为 $1.023$。", "answer": "$$\\boxed{1.023}$$", "id": "2060446"}, {"introduction": "保持相空间面积的几何特性最终会带来一个非常实际的好处：更高的长期模拟精度。算法的“收敛阶”描述了其全局误差如何随时间步长 $ \\Delta t $ 的减小而减小，是衡量其性能的关键指标。在这个练习中，你将通过分析给定的数值模拟数据，来确定两种算法的收敛阶，从而亲眼见证辛积分器（如Verlet算法）相比于简单的非辛方法所具有的卓越精度优势[@problem_id:2060505]。", "problem": "在许多物理学领域，从天体力学到分子动力学，运动方程都过于复杂，无法解析求解。因此，物理学家们依赖数值积分算法在离散的时间步长上近似求解。这种模拟的精度关键取决于所选的算法和时间步长 $\\Delta t$ 的大小。积分器的一个关键特性是其*收敛阶*，即一个整数指数 $p$，它描述了全局误差 $\\epsilon$（在固定的最终时间，数值解与精确解之差）如何随时间步长缩放，根据关系式 $\\epsilon \\approx C (\\Delta t)^p$，其中当 $\\Delta t \\to 0$ 时，$C$ 为某个常数。\n\n考虑一个简谐振子，它由一个质量为 $m$ 的粒子连接到一个弹簧常数为 $k$ 的弹簧组成。其运动方程为 $\\ddot{x} = -\\omega^2 x$，其中 $\\omega = \\sqrt{k/m}$。对于本问题，我们设定 $\\omega = 1 \\text{ rad/s}$。该粒子从静止状态释放，初始位置为 $x(0) = 1 \\text{ m}$，初始速度为 $v(0) = 0 \\text{ m/s}$。\n\n我们将比较两种常见的数值积分方案。\n\n**方案 A：**\n对于一个时间步长 $\\Delta t$，在时间 $t_i$ 的位置 $x_i$ 和速度 $v_i$ 通过以下规则更新到下一步 $t_{i+1} = t_i + \\Delta t$：\n$v_{i+1} = v_i - \\Delta t \\cdot \\omega^2 x_i$\n$x_{i+1} = x_i + \\Delta t \\cdot v_i$\n\n**方案 B (速度Verlet公式)：**\n位置和速度使用速度的半步法进行更新：\n$v_{i+1/2} = v_i - \\frac{\\Delta t}{2} \\cdot \\omega^2 x_i$\n$x_{i+1} = x_i + \\Delta t \\cdot v_{i+1/2}$\n$v_{i+1} = v_{i+1/2} - \\frac{\\Delta t}{2} \\cdot \\omega^2 x_{i+1}$\n\n为了确定每种方案的收敛阶，我们将系统模拟到最终时间 $T_{final} = 10\\pi$ 秒。下面是对于两个不同时间步长，数值计算得到的最终位置。\n\n对于**方案 A**：\n- 当时间步长为 $\\Delta t_1 = \\frac{\\pi}{10}$ s 时，最终位置为 $x_{A,1}(T_{final}) \\approx 1.54781$。\n- 当时间步长为 $\\Delta t_2 = \\frac{\\pi}{20}$ s 时，最终位置为 $x_{A,2}(T_{final}) \\approx 1.25893$。\n\n对于**方案 B**：\n- 当时间步长为 $\\Delta t_1 = \\frac{\\pi}{10}$ s 时，最终位置为 $x_{B,1}(T_{final}) \\approx 1.04223$。\n- 当时间步长为 $\\Delta t_2 = \\frac{\\pi}{20}$ s 时，最终位置为 $x_{B,2}(T_{final}) \\approx 1.01052$。\n\n基于这些数值证据，确定分别代表方案 A 和方案 B 收敛阶的最佳整数指数对 $(p_A, p_B)$。", "solution": "目标是为这两种数值方案找到整数收敛阶 $p_A$ 和 $p_B$。收敛阶 $p$ 由全局误差 $\\epsilon$ 随时间步长 $\\Delta t$ 的缩放关系定义，即 $\\epsilon \\approx C(\\Delta t)^p$。\n\n首先，我们必须确定精确解，以找到在 $T_{final}$ 时的真值，并计算误差。运动方程为 $\\ddot{x} = -\\omega^2 x$，其中 $\\omega=1$。其通解为 $x(t) = A\\cos(\\omega t) + B\\sin(\\omega t)$。初始条件为 $x(0) = 1$ 和 $v(0) = \\dot{x}(0) = 0$。\n应用 $x(0)=1$：$1 = A\\cos(0) + B\\sin(0) \\implies A=1$。\n速度为 $\\dot{x}(t) = -A\\omega\\sin(\\omega t) + B\\omega\\cos(\\omega t)$。\n应用 $v(0)=0$：$0 = -1\\cdot 1\\sin(0) + B\\cdot 1\\cos(0) \\implies B=0$。\n因此，精确解为 $x(t) = \\cos(t)$。\n\n模拟的最终时间为 $T_{final} = 10\\pi$ 秒。此时的精确位置是：\n$x_{exact}(T_{final}) = x(10\\pi) = \\cos(10\\pi) = 1$。\n\n现在，我们可以为问题中提供的每种情况计算全局误差 $\\epsilon = |x_{num}(T_{final}) - x_{exact}(T_{final})|$。\n\n我们来分析方案 A。\n对于时间步长 $\\Delta t_1 = \\pi/10$，全局误差为：\n$\\epsilon_{A,1} = |x_{A,1}(T_{final}) - 1| = |1.54781 - 1| = 0.54781$。\n对于时间步长 $\\Delta t_2 = \\pi/20$，全局误差为：\n$\\epsilon_{A,2} = |x_{A,2}(T_{final}) - 1| = |1.25893 - 1| = 0.25893$。\n\n为了求指数 $p_A$，我们对两个时间步长使用缩放关系：\n$\\epsilon_{A,1} \\approx C(\\Delta t_1)^{p_A}$\n$\\epsilon_{A,2} \\approx C(\\Delta t_2)^{p_A}$\n将第一个方程除以第二个方程，得到：\n$\\frac{\\epsilon_{A,1}}{\\epsilon_{A,2}} \\approx \\left(\\frac{\\Delta t_1}{\\Delta t_2}\\right)^{p_A}$\n我们可以通过对两边取自然对数来求解 $p_A$：\n$\\ln\\left(\\frac{\\epsilon_{A,1}}{\\epsilon_{A,2}}\\right) = p_A \\ln\\left(\\frac{\\Delta t_1}{\\Delta t_2}\\right)$\n$p_A = \\frac{\\ln(\\epsilon_{A,1}/\\epsilon_{A,2})}{\\ln(\\Delta t_1/\\Delta t_2)}$\n\n时间步长之比为 $\\frac{\\Delta t_1}{\\Delta t_2} = \\frac{\\pi/10}{\\pi/20} = 2$。\n代入方案 A 的误差值：\n$p_A = \\frac{\\ln(0.54781 / 0.25893)}{\\ln(2)} = \\frac{\\ln(2.11574\\dots)}{\\ln(2)} \\approx \\frac{0.7494}{0.6931} \\approx 1.081$\n与此值最接近的整数是 $p_A = 1$。\n\n接下来，我们分析方案 B。\n对于时间步长 $\\Delta t_1 = \\pi/10$，全局误差为：\n$\\epsilon_{B,1} = |x_{B,1}(T_{final}) - 1| = |1.04223 - 1| = 0.04223$。\n对于时间步长 $\\Delta t_2 = \\pi/20$，全局误差为：\n$\\epsilon_{B,2} = |x_{B,2}(T_{final}) - 1| = |1.01052 - 1| = 0.01052$。\n\n使用相同的公式计算指数 $p_B$：\n$p_B = \\frac{\\ln(\\epsilon_{B,1}/\\epsilon_{B,2})}{\\ln(\\Delta t_1/\\Delta t_2)}$\n代入方案 B 的误差值：\n$p_B = \\frac{\\ln(0.04223 / 0.01052)}{\\ln(2)} = \\frac{\\ln(4.01425\\dots)}{\\ln(2)} \\approx \\frac{1.3900}{0.6931} \\approx 2.005$\n与此值最接近的整数是 $p_B = 2$。\n\n因此，方案 A 的收敛阶为 1，方案 B 的收敛阶为 2。这对整数指数是 $(p_A, p_B) = (1, 2)$。", "answer": "$$\\boxed{\\begin{pmatrix} 1  2 \\end{pmatrix}}$$", "id": "2060505"}]}