{"hands_on_practices": [{"introduction": "理论的生命力在于应用。达布定理最直接的应用就是找到一种坐标变换，将一个看起来复杂的辛形式变得像 $dQ \\wedge dP$ 一样简洁标准。这个练习 [@problem_id:2044091] 将引导你完成这个“展平”过程，通过一个具体的例子，掌握寻找达布坐标的基本方法。这是理解哈密顿力学中坐标变换核心思想的第一步。", "problem": "一个物理系统的相空间由两个广义坐标 $x \\in (-\\infty, \\infty)$ 和 $y \\in (0, \\infty)$ 描述。控制哈密顿动力学的基本辛二形式 $\\Omega$ 以一种非正则表示给出：\n$$\n\\Omega = \\frac{1}{y^2} dx \\wedge dy\n$$\n达布定理指出，总可以找到一个从 $(x, y)$ 到一组新的正则坐标 $(Q, P)$（通常称为达布坐标）的局部坐标变换，使得辛形式能以标准正则形式 $\\Omega = dQ \\wedge dP$ 表示。\n\n求出实现这一变换的新正则坐标函数 $Q(x, y)$ 和 $P(x, y)$。将你的最终答案表示为 $(Q(x, y), P(x, y))$ 的函数有序对。", "solution": "我们寻求函数 $Q(x,y)$ 和 $P(x,y)$，使得拉回的正则辛形式满足 $dQ \\wedge dP = \\Omega = \\frac{1}{y^{2}} dx \\wedge dy$。使用微分外积的恒等式，\n$$\ndQ \\wedge dP = \\left(\\frac{\\partial Q}{\\partial x} dx + \\frac{\\partial Q}{\\partial y} dy\\right) \\wedge \\left(\\frac{\\partial P}{\\partial x} dx + \\frac{\\partial P}{\\partial y} dy\\right)\n= \\left(\\frac{\\partial Q}{\\partial x}\\frac{\\partial P}{\\partial y} - \\frac{\\partial Q}{\\partial y}\\frac{\\partial P}{\\partial x}\\right) dx \\wedge dy,\n$$\n我们要求\n$$\n\\frac{\\partial Q}{\\partial x}\\frac{\\partial P}{\\partial y} - \\frac{\\partial Q}{\\partial y}\\frac{\\partial P}{\\partial x} = \\frac{1}{y^{2}}.\n$$\n一个简单的选择是取 $Q(x,y) = x$，此时 $\\frac{\\partial Q}{\\partial x} = 1$ 且 $\\frac{\\partial Q}{\\partial y} = 0$。于是该条件化简为\n$$\n\\frac{\\partial P}{\\partial y} = \\frac{1}{y^{2}}.\n$$\n对 $y$ 积分得到\n$$\nP(x,y) = -\\frac{1}{y} + g(x),\n$$\n其中 $g$ 是 $x$ 的任意函数。将 $Q = x$ 和 $P = -\\frac{1}{y} + g(x)$ 代回外积，\n$$\ndQ \\wedge dP = dx \\wedge \\left(\\frac{1}{y^{2}} dy + g'(x) dx\\right) = \\frac{1}{y^{2}} dx \\wedge dy,\n$$\n因为 $dx \\wedge dx = 0$。因此，$g$ 的任何选择都能得到所需的辛形式。为确定起见，我们选择 $g(x) = 0$，得到正则坐标\n$$\nQ(x,y) = x, \\qquad P(x,y) = -\\frac{1}{y}.\n$$\n它们满足 $dQ \\wedge dP = \\frac{1}{y^{2}} dx \\wedge dy$，并且在给定定义域 $y \\in (0,\\infty)$ 上是局部可逆的，其逆变换为 $x = Q$ 和 $y = -\\frac{1}{P}$。", "answer": "$$\\boxed{\\begin{pmatrix} x  -\\frac{1}{y} \\end{pmatrix}}$$", "id": "2044091"}, {"introduction": "掌握了基本方法后，我们来挑战一个更有深度的问题。在实际研究中，我们有时可能只确定了一个新的广义坐标 $Q$，并需要找到与之相配的共轭动量 $P$ 来确保变换是正则的。这个问题 [@problem_id:2044120] 让你实践如何从已知的 $Q(q, p)$ 出发，通过求解一个偏微分方程来确定 $P(q, p)$，这将加深你对正则变换条件的理解。", "problem": "在分析力学中，一个从相空间坐标 $(q, p)$ 到 $(Q, P)$ 的变换，如果它保持基本的辛2-形式不变，则被称为正则变换。对于一维系统，该条件表示为 $dQ \\wedge dP = dq \\wedge dp$，其中 $\\wedge$ 表示外积。\n\n考虑一个系统，其动力学在具有正则坐标 $(q, p)$ 的相空间中进行描述。引入一个新坐标 $Q$，它通过以下变换与原坐标相关联：\n$$Q(q, p) = e^{q} \\cos(p)$$\n\n你的任务是找到相应的正则动量 $P(q, p)$。你必须提供 $P(q, p)$ 关于原坐标 $q$ 和 $p$ 的具体表达式，并且该表达式还需对所有有效的 $q$ 值满足条件 $P(q, 0) = 0$。", "solution": "一个从 $(q,p)$ 到 $(Q,P)$ 的一维变换是正则的，条件是它保持辛2-形式不变，即要求 $dQ \\wedge dP = dq \\wedge dp$，这等价于雅可比行列式为1：$Q_{q}P_{p} - Q_{p}P_{q} = 1$。\n给定 $Q(q,p) = \\exp(q)\\cos(p)$，计算其偏导数：\n$$\nQ_{q} = \\exp(q)\\cos(p) = Q, \\qquad Q_{p} = -\\exp(q)\\sin(p).\n$$\n正则条件变为关于 $P(q,p)$ 的一阶线性偏微分方程：\n$$\nQ_{q}P_{p} - Q_{p}P_{q} = 1 \\;\\; \\Longleftrightarrow \\;\\; \\exp(q)\\cos(p)\\,P_{p} + \\exp(q)\\sin(p)\\,P_{q} = 1,\n$$\n化简为\n$$\n\\cos(p)\\,P_{p} + \\sin(p)\\,P_{q} = \\exp(-q).\n$$\n用特征线法求解此偏微分方程。将其写成 $a P_{q} + b P_{p} = c$ 的形式，其中 $a = \\sin(p)$，$b = \\cos(p)$，$c = \\exp(-q)$。特征方程为\n$$\n\\frac{dq}{ds} = \\sin(p), \\qquad \\frac{dp}{ds} = \\cos(p), \\qquad \\frac{dP}{ds} = \\exp(-q).\n$$\n沿着特征线，计算 $\\frac{dQ}{ds}$：\n$$\n\\frac{dQ}{ds} = Q_{q}\\frac{dq}{ds} + Q_{p}\\frac{dp}{ds} = \\big(\\exp(q)\\cos(p)\\big)\\sin(p) + \\big(-\\exp(q)\\sin(p)\\big)\\cos(p) = 0.\n$$\n因此，$Q$ 沿着特征线是常数。使用 $\\frac{dp}{ds} = \\cos(p)$，我们得到 $ds = \\frac{dp}{\\cos(p)}$，因此沿着一条特征线\n$$\ndP = \\exp(-q)\\,ds = \\frac{\\exp(-q)}{\\cos(p)}\\,dp.\n$$\n由于 $Q = \\exp(q)\\cos(p)$ 在特征线上是常数，我们有 $\\exp(-q) = \\frac{\\cos(p)}{Q}$，因此\n$$\n\\frac{dP}{dp} = \\frac{1}{Q} \\quad \\Longrightarrow \\quad P = \\frac{p}{Q} + f(Q),\n$$\n其中 $f$ 是关于特征不变量 $Q$ 的任意函数。施加条件 $P(q,0) = 0$。当 $p=0$ 时，$Q(q,0) = \\exp(q)$，所以\n$$\n0 = P(q,0) = \\frac{0}{\\exp(q)} + f\\big(\\exp(q)\\big) \\quad \\Longrightarrow \\quad f(Q) = 0 \\text{ for all } Q>0.\n$$\n选择光滑延拓 $f \\equiv 0$ 可得\n$$\nP(q,p) = \\frac{p}{Q} = \\frac{p\\,\\exp(-q)}{\\cos(p)}.\n$$\n最后，对 $P = p/Q$ 验证辛条件。将 $P$ 写为 $p Q^{-1}$（即 $f\\equiv 0$ 的情况），计算\n$$\nP_{q} = -\\frac{p\\,Q_{q}}{Q^{2}}, \\qquad P_{p} = \\frac{1}{Q} - \\frac{p\\,Q_{p}}{Q^{2}}.\n$$\n然后\n$$\nQ_{q}P_{p} - Q_{p}P_{q} = Q_{q}\\left(\\frac{1}{Q} - \\frac{p\\,Q_{p}}{Q^{2}}\\right) - Q_{p}\\left(-\\frac{p\\,Q_{q}}{Q^{2}}\\right) = \\frac{Q_{q}}{Q} = 1,\n$$\n因为 $Q_{q} = Q$。因此，该变换是正则的，并且满足 $P(q,0)=0$。", "answer": "$$\\boxed{\\frac{p\\,\\exp(-q)}{\\cos(p)}}$$", "id": "2044120"}, {"introduction": "物理系统的自由度往往不止一个，这意味着相空间是高维的。达布定理的强大之处在于它同样适用于高维空间。这个练习 [@problem_id:2044115] 将带你进入一个四维相空间，处理一个“扭曲”的辛形式。你将学习如何将高维问题分解，并利用线性代数的工具找到一个优雅的正则变换，从而体会该理论在更复杂系统中的普适性和结构之美。", "problem": "考虑一个由坐标 $(q_1, q_2, p_1, p_2)$ 构成的四维相空间。某个特定系统的动力学由一个非标准典范形式的辛形式 $\\Omega$ 所支配。这个“扭曲”的辛形式由下式给出：\n$$\n\\Omega = dq_1 \\wedge dq_2 + dp_1 \\wedge dp_2\n$$\nDarboux定理保证了存在一个局域坐标变换，可以转换到一组新坐标 $(Q_1, Q_2, P_1, P_2)$，使得辛形式取标准典范形式，即 $\\Omega = dQ_1 \\wedge dP_1 + dQ_2 \\wedge dP_2$。\n\n你的任务是找到这个变换。具体来说，确定从旧坐标 $x = (q_1, q_2, p_1, p_2)$ 到新坐标 $Y = (Q_1, P_1, Q_2, P_2)$ 的坐标变换的雅可比矩阵 $J$，其矩阵元定义为 $J_{ij} = \\frac{\\partial Y_i}{\\partial x_j}$。\n\n为确保解的唯一性，该变换必须满足以下条件：\n1.  该变换是线性的。\n2.  新坐标是解耦的，使得 $(Q_1, P_1)$ 仅是 $(q_1, q_2)$ 的函数，而 $(Q_2, P_2)$ 仅是 $(p_1, p_2)$ 的函数。\n3.  对于 $(q_1, q_2) \\to (Q_1, P_1)$ 变换：\n    a. $Q_1$ 与 $q_2$ 无关。\n    b. $Q_1$ 相对于 $q_1$ 的变化率为1，即 $\\frac{\\partial Q_1}{\\partial q_1} = 1$。\n    c. 当 $q_2=0$ 时，$P_1$ 等于 $q_1$。\n4.  对于 $(p_1, p_2) \\to (Q_2, P_2)$ 变换：\n    a. $Q_2$ 与 $p_2$ 无关。\n    b. $Q_2$ 相对于 $p_1$ 的变化率为1，即 $\\frac{\\partial Q_2}{\\partial p_1} = 1$。\n    c. 当 $p_2=0$ 时，$P_2$ 等于 $p_1$。\n\n请给出完整的4x4雅可比矩阵作为你的最终答案。", "solution": "我们寻求一个从 $x=(q_{1},q_{2},p_{1},p_{2})$ 到 $Y=(Q_{1},P_{1},Q_{2},P_{2})$ 的线性变量变换，使得扭曲的辛形式 $\\Omega=dq_{1}\\wedge dq_{2}+dp_{1}\\wedge dp_{2}$ 变为典范形式，即 $\\Omega=dQ_{1}\\wedge dP_{1}+dQ_{2}\\wedge dP_{2}$。解耦条件意味着 $(Q_{1},P_{1})$ 仅依赖于 $(q_{1},q_{2})$，而 $(Q_{2},P_{2})$ 仅依赖于 $(p_{1},p_{2})$。对于每个 $2\\times 2$ 的块，如果 $(Q,P)=A\\,(x_{1},x_{2})^{T}$ 是线性的，那么 $dQ\\wedge dP=\\det(A)\\,dx_{1}\\wedge dx_{2}$。因此，对于每个块，我们必须有 $\\det(A)=1$，以使 $dQ\\wedge dP$ 等于相应的楔形式。\n\n对于 $(q_{1},q_{2})\\to(Q_{1},P_{1})$ 映射，我们写作\n$$\n\\begin{pmatrix}Q_{1}\\\\P_{1}\\end{pmatrix}\n=\n\\begin{pmatrix}a  b\\\\ c  d\\end{pmatrix}\n\\begin{pmatrix}q_{1}\\\\ q_{2}\\end{pmatrix}.\n$$\n$Q_{1}$ 与 $q_{2}$ 无关以及 $\\frac{\\partial Q_{1}}{\\partial q_{1}}=1$ 的条件给出了 $b=0$ 和 $a=1$，因此 $Q_{1}=q_{1}$。$P_{1}(q_{2}=0)=q_{1}$ 的条件给出了 $P_{1}=c\\,q_{1}+d\\,q_{2}$ 且 $c=1$。辛条件 $dQ_{1}\\wedge dP_{1}=dq_{1}\\wedge dq_{2}$ 要求 $\\det\\begin{pmatrix}1  0\\\\ 1  d\\end{pmatrix}=d=1$。因此\n$$\nQ_{1}=q_{1},\\qquad P_{1}=q_{1}+q_{2},\\qquad A_{q}=\\begin{pmatrix}1  0\\\\ 1  1\\end{pmatrix}.\n$$\n\n对于 $(p_{1},p_{2})\\to(Q_{2},P_{2})$ 映射，我们写作\n$$\n\\begin{pmatrix}Q_{2}\\\\P_{2}\\end{pmatrix}\n=\n\\begin{pmatrix}a'  b'\\\\ c'  d'\\end{pmatrix}\n\\begin{pmatrix}p_{1}\\\\ p_{2}\\end{pmatrix}.\n$$\n$Q_{2}$ 与 $p_{2}$ 无关以及 $\\frac{\\partial Q_{2}}{\\partial p_{1}}=1$ 的条件给出了 $b'=0$ 和 $a'=1$，因此 $Q_{2}=p_{1}$。$P_{2}(p_{2}=0)=p_{1}$ 的条件给出了 $P_{2}=c'\\,p_{1}+d'\\,p_{2}$ 且 $c'=1$。辛条件 $dQ_{2}\\wedge dP_{2}=dp_{1}\\wedge dp_{2}$ 要求 $\\det\\begin{pmatrix}1  0\\\\ 1  d'\\end{pmatrix}=d'=1$。因此\n$$\nQ_{2}=p_{1},\\qquad P_{2}=p_{1}+p_{2},\\qquad A_{p}=\\begin{pmatrix}1  0\\\\ 1  1\\end{pmatrix}.\n$$\n\n整合两个块，并按 $Y=(Q_{1},P_{1},Q_{2},P_{2})$ 和 $x=(q_{1},q_{2},p_{1},p_{2})$ 的顺序排列，雅可比矩阵 $J$ 是一个块对角矩阵，其块为 $A_{q}$ 和 $A_{p}$：\n$$\nJ=\\begin{pmatrix}\n\\frac{\\partial Q_{1}}{\\partial q_{1}}  \\frac{\\partial Q_{1}}{\\partial q_{2}}  \\frac{\\partial Q_{1}}{\\partial p_{1}}  \\frac{\\partial Q_{1}}{\\partial p_{2}}\\\\\n\\frac{\\partial P_{1}}{\\partial q_{1}}  \\frac{\\partial P_{1}}{\\partial q_{2}}  \\frac{\\partial P_{1}}{\\partial p_{1}}  \\frac{\\partial P_{1}}{\\partial p_{2}}\\\\\n\\frac{\\partial Q_{2}}{\\partial q_{1}}  \\frac{\\partial Q_{2}}{\\partial q_{2}}  \\frac{\\partial Q_{2}}{\\partial p_{1}}  \\frac{\\partial Q_{2}}{\\partial p_{2}}\\\\\n\\frac{\\partial P_{2}}{\\partial q_{1}}  \\frac{\\partial P_{2}}{\\partial q_{2}}  \\frac{\\partial P_{2}}{\\partial p_{1}}  \\frac{\\partial P_{2}}{\\partial p_{2}}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1  0  0  0\\\\\n1  1  0  0\\\\\n0  0  1  0\\\\\n0  0  1  1\n\\end{pmatrix}.\n$$\n这个 $J$ 满足所有施加的条件，并得出 $dQ_{1}\\wedge dP_{1}+dQ_{2}\\wedge dP_{2}=dq_{1}\\wedge dq_{2}+dp_{1}\\wedge dp_{2}$。", "answer": "$$\\boxed{\\begin{pmatrix}1   0  0  0\\\\ 1  1  0  0\\\\ 0  0  1  0\\\\ 0  0  1  1\\end{pmatrix}}$$", "id": "2044115"}]}