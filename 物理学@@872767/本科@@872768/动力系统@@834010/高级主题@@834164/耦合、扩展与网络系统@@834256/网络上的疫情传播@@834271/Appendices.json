{"hands_on_practices": [{"introduction": "我们从一个最基本的问题开始：在一个给定的网络中，如果一个节点被感染，那么另一个特定节点被感染的几率有多大？这个练习 [@problem_id:883373] 使用一个简单的 SI 模型和一个小型的有向图来建立直观理解。通过这个练习，你将学会从网络路径和独立概率事件的角度思考问题，为后续更复杂的模型打下基础。", "problem": "考虑一个用于在有向网络上传播的易感-感染（SI）模型。在此模型中，节点可以处于两种状态之一：易感（$S$）或感染（$I$）。该过程从一个单一的源节点处于感染状态开始，而所有其他节点都处于易感状态。\n\n感染沿着网络的有向边传播。对于从受感染节点 $u$ 到易感节点 $v$ 的每条有向边 $(u, v)$，传播事件以固定的概率 $p$ 发生。所有传播事件都是独立的。如果发生传播事件，节点 $v$ 就会被感染。一旦一个节点被感染，它在整个过程中都保持感染状态。\n\n考虑一个有向无环图（DAG），其节点集为 $V = \\{1, 2, 3, 4, 5, 6\\}$，边集为 $E = \\{(1, 2), (1, 3), (2, 4), (3, 4), (1, 5), (4, 5), (5, 6)\\}$。节点1是初始的感染源。\n\n计算节点6被感染的概率。你的最终答案应该是一个以传播概率 $p$ 表示的解析表达式。", "solution": "1. 识别从节点1到节点6的所有有向路径：\n   A: $1\\to5\\to6$，边 $e_{15},e_{56}$。\n   B: $1\\to2\\to4\\to5\\to6$，边 $e_{12},e_{24},e_{45},e_{56}$。\n   C: $1\\to3\\to4\\to5\\to6$，边 $e_{13},e_{34},e_{45},e_{56}$。\n\n2. 设 $A,B,C$ 分别为路径 A, B, C 全部成功的事件。由于每条边以概率 $p$ 独立传播，\n   $$P(A)=p^2,\\quad P(B)=p^4,\\quad P(C)=p^4.$$\n   \n3. 交集要求边的并集成功：\n   $$P(A\\cap B)=p^5,\\quad P(A\\cap C)=p^5,\\quad P(B\\cap C)=p^6,$$\n   $$P(A\\cap B\\cap C)=p^7.$$\n\n4. 根据容斥原理，\n   \n$$\n     P(\\text{节点6被感染})\n     =P(A)+P(B)+P(C)\n     -\\bigl[P(A\\cap B)+P(A\\cap C)+P(B\\cap C)\\bigr]\n     +P(A\\cap B\\cap C).\n   $$\n\n   代入可得\n   \n$$\n     P\n     =p^2+2p^4-\\bigl(2p^5+p^6\\bigr)+p^7\n     =p^2+2p^4-2p^5-p^6+p^7.\n   $$", "answer": "$$\\boxed{p^2 + 2p^4 - 2p^5 - p^6 + p^7}$$", "id": "883373"}, {"introduction": "超越单个节点的感染概率，我们现在来探讨一个更宏观的问题：一场疫情究竟会不会爆发？这项练习 [@problem_id:1674627] 将引入“疫情阈值”这一关键概念。通过比较两种简单的社区结构，你将亲眼见证网络拓扑结构如何决定其对疾病传播的脆弱性，而这一原理可以被网络邻接矩阵的光谱半径优雅地捕捉。", "problem": "一个公共卫生机构正在研究一种新型病毒在两个不同的小社区中的潜在传播，每个社区都有 $N$ 个人。病毒的传播可以很好地用易感-感染-易感 (SIS) 模型来描述，在该模型中，从感染中恢复的个体立即再次变为易感状态。在这个模型中，一个受感染的个体以速率 $\\beta$ 将疾病传播给其每个易感邻居，并以速率 $\\gamma$ 恢复。传播的动态过程严重依赖于社区内社会接触的网络结构。\n\n社区 A 是一个线性聚居地，房屋排成一条直线。房屋 $i$（对于 $1  i  N$）中的个体仅与房屋 $i-1$ 和 $i+1$ 中的直接邻居有社会接触。位于直线两端（房屋 1 和 $N$）的个体各自只有一个邻居。这种结构形成一个路径图。\n\n社区 B 是一个圆形聚居地，房屋围绕一个中心公共区域排列。每个个体都恰好与两个邻居有社会接触，形成一个闭环。这种结构形成一个环形图。\n\n如果受感染的个体数量可以从一个小的初始种子开始增长，就称之为发生了流行病。当有效传播率（定义为 $\\lambda = \\beta / \\gamma$）超过一个称为流行病阈值的临界值 $\\lambda_c$ 时，就会发生这种情况。对于给定的网络结构，如果 $\\lambda > \\lambda_c$，疾病将变为地方性的；否则，它将消亡。\n\n令 $\\lambda_c^A$ 为社区 A 的流行病阈值，$\\lambda_c^B$ 为社区 B 的流行病阈值。确定比率 $R = \\frac{\\lambda_c^A}{\\lambda_c^B}$ 作为个体数量 $N$ 的函数。您的最终答案应该是一个闭式解析表达式。", "solution": "我们在一个固定的接触网络上对SIS动态进行建模，其邻接矩阵为 $A$。令 $p_{i}(t)$ 表示节点 $i$ 在时间 $t$ 的感染概率。在淬火平均场 (NIMFA) 近似下，动态过程满足\n$$\n\\frac{d p_{i}}{d t}=-\\gamma p_{i}+\\beta\\left(1-p_{i}\\right)\\sum_{j}A_{ij}p_{j}.\n$$\n在对所有 $i$ 均为 $p_{i}=0$ 的无病状态附近进行线性化，得到线性系统\n$$\n\\frac{d\\boldsymbol{p}}{d t}=\\left(-\\gamma I+\\beta A\\right)\\boldsymbol{p},\n$$\n其中 $\\boldsymbol{p}=(p_{1},\\dots,p_{N})^{\\top}$。当 $-\\gamma I+\\beta A$ 的最大特征值穿过零时，无病状态失去稳定性，即，\n$$\n-\\gamma+\\beta\\,\\rho(A)=0\\quad\\Longrightarrow\\quad \\frac{\\beta}{\\gamma}=\\frac{1}{\\rho(A)}.\n$$\n因此，用有效传播率 $\\lambda=\\beta/\\gamma$ 表示的流行病阈值为\n$$\n\\lambda_{c}=\\frac{1}{\\rho(A)},\n$$\n其中 $\\rho(A)$ 是邻接矩阵的谱半径（最大特征值）。\n\n对于社区 A（路径图 $P_{N}$），其邻接矩阵的特征值已知为\n$$\n\\lambda_{k}^{(P_{N})}=2\\cos\\left(\\frac{k\\pi}{N+1}\\right),\\quad k=1,2,\\dots,N,\n$$\n所以谱半径为\n$$\n\\rho\\!\\left(P_{N}\\right)=2\\cos\\left(\\frac{\\pi}{N+1}\\right),\n$$\n因此\n$$\n\\lambda_{c}^{A}=\\frac{1}{2\\cos\\left(\\frac{\\pi}{N+1}\\right)}.\n$$\n\n对于社区 B（环形图 $C_{N}$），其邻接矩阵的特征值为\n$$\n\\lambda_{k}^{(C_{N})}=2\\cos\\left(\\frac{2\\pi k}{N}\\right),\\quad k=0,1,\\dots,N-1,\n$$\n所以谱半径为\n$$\n\\rho\\!\\left(C_{N}\\right)=2,\n$$\n因此\n$$\n\\lambda_{c}^{B}=\\frac{1}{2}.\n$$\n\n所求的比率则为\n$$\nR=\\frac{\\lambda_{c}^{A}}{\\lambda_{c}^{B}}=\\frac{\\frac{1}{2\\cos\\left(\\frac{\\pi}{N+1}\\right)}}{\\frac{1}{2}}=\\frac{1}{\\cos\\left(\\frac{\\pi}{N+1}\\right)}.\n$$\n这是一个关于 $N$ 的闭式解析表达式。", "answer": "$$\\boxed{\\frac{1}{\\cos\\left(\\frac{\\pi}{N+1}\\right)}}$$", "id": "1674627"}, {"introduction": "真实世界的网络很少是均匀的，一些节点（如枢纽）的重要性远超其他节点。这项练习 [@problem_id:1707340] 将挑战你分析一个更真实的“星形网络”，它模拟了一个存在“超级传播者”的情景。你将学习使用下一代矩阵法，这是一个标准而强大的工具，用于计算复杂结构化种群中的基本再生数 $R_0$，并确定疫情爆发的精确条件。", "problem": "考虑一个流行病在区域交通网络中传播的简化模型。该网络由一个中心都市枢纽（节点0）和 $N$ 个相同的卫星城镇（节点 $i=1, 2, \\dots, N$）组成。旅行，也即疾病传播，可以发生在枢纽和任何卫星城镇之间，但不能直接发生在任意两个卫星城镇之间。这形成了一个“星形”网络拓扑。\n\n疾病的传播由该网络上的一个易感-感染-康复 (SIR) 模型来描述。设 $P_0$ 为枢纽的人口，$P_p$ 为每个卫星城镇的人口。我们追踪每个节点 $k$ 中易感者 ($S_k$)、感染者 ($I_k$) 和康复者 ($R_k$) 的数量。每个节点的总人口保持不变。\n\n感染的动态由以下传播率决定：\n-   枢纽内部个体间的有效传播率为 $\\beta_{hh}$。\n-   从枢纽中的一个感染者到任何一个卫星城镇中的一个易感者的有效传播率为 $\\beta_{hp}$。\n-   从任何一个卫星城镇中的一个感染者到枢纽中的一个易感者的有效传播率为 $\\beta_{ph}$。\n-   卫星城镇之间的传播可以忽略不计，视为零。\n\n任何节点中的个体一旦被感染，会以恒定速率 $\\gamma$ 康复，然后对进一步的感染免疫。该系统的无病平衡态 (DFE) 是没有感染者存在的状态。如果此平衡态不稳定，则会发生疫情暴发。\n\n您的任务是确定疫情暴发的阈值条件。该条件由基本再生数 $R_0$ 给出，$R_0$ 定义为在无病平衡态附近线性化的系统的下一代矩阵的谱半径（特征值的最大绝对值）。\n\n推导基本再生数 $R_0$ 关于参数 $N, \\beta_{hh}, \\beta_{hp}, \\beta_{ph}$ 和 $\\gamma$ 的闭式解析表达式。", "solution": "在无病平衡态 (DFE)，所有个体都是易感者，没有感染者。在无病平衡态附近对 SIR 动态进行线性化，并应用下一代矩阵方法，我们将感染子系统写为\n$$\n\\frac{d I_{k}}{d t} = \\sum_{j} F_{kj} I_{j} - \\sum_{j} V_{kj} I_{j},\n$$\n其中 $F$ 包含了新感染出现的速率，$V$ 包含了移出感染状态（此处为康复）的速率。每个节点中的康复以速率 $\\gamma$ 发生，所以 $V=\\gamma I$（由 $\\gamma$ 缩放的单位矩阵）。根据给定的有效传播率的定义，当人口完全易感时，由节点 $j$ 中的一个感染者在节点 $i$ 中引起的新感染以速率 $\\beta_{ij}$ 发生，因此在 DFE 处新感染项的雅可比矩阵为 $F_{ij}=\\beta_{ij}$。\n\n给定星形拓扑和指定的有效传播率，$F$ 中唯一的非零项是：\n$$\nF_{00}=\\beta_{hh}, \\quad F_{0p}=\\beta_{ph} \\text{ for } p=1,\\dots,N, \\quad F_{p0}=\\beta_{hp} \\text{ for } p=1,\\dots,N,\n$$\n其中对于 $p,q \\geq 1$，所有 $F_{pq}=0$。下一代矩阵是\n$$\nK = F V^{-1} = \\frac{1}{\\gamma} F.\n$$\n将枢纽索引为 $0$，卫星城镇索引为 $p=1,\\dots,N$，$K$ 具有星形形式\n$$\nK_{00}=\\frac{\\beta_{hh}}{\\gamma}, \\quad K_{0p}=\\frac{\\beta_{ph}}{\\gamma}, \\quad K_{p0}=\\frac{\\beta_{hp}}{\\gamma}, \\quad K_{pq}=0 \\text{ for } p,q \\geq 1.\n$$\n\n为了计算 $K$ 的谱半径，我们利用卫星城镇之间的对称性。存在 $N-1$ 个支持在卫星城镇上的特征向量，它们的各分量之和为零，且枢纽分量为零；这些特征向量对应的特征值为 $0$。由枢纽基向量和均匀卫星向量张成的二维不变子空间上的动力学可以简化为一个 $2 \\times 2$ 矩阵\n$$\nM = \\begin{pmatrix}\n\\frac{\\beta_{hh}}{\\gamma}  N \\frac{\\beta_{ph}}{\\gamma} \\\\\n\\frac{\\beta_{hp}}{\\gamma}  0\n\\end{pmatrix}.\n$$\n$M$ 的特征多项式是\n$$\n\\lambda^{2} - \\frac{\\beta_{hh}}{\\gamma} \\lambda - N \\frac{\\beta_{ph}}{\\gamma} \\frac{\\beta_{hp}}{\\gamma} = 0.\n$$\n因此，两个非零特征值为\n$$\n\\lambda_{\\pm} = \\frac{1}{2} \\left( \\frac{\\beta_{hh}}{\\gamma} \\pm \\sqrt{ \\left( \\frac{\\beta_{hh}}{\\gamma} \\right)^{2} + 4 N \\frac{\\beta_{ph}}{\\gamma} \\frac{\\beta_{hp}}{\\gamma} } \\right)\n= \\frac{1}{2 \\gamma} \\left( \\beta_{hh} \\pm \\sqrt{ \\beta_{hh}^{2} + 4 N \\beta_{ph} \\beta_{hp} } \\right).\n$$\n由于所有速率都是非负的，谱半径是正根，\n$$\nR_{0} = \\rho(K) = \\frac{1}{2 \\gamma} \\left( \\beta_{hh} + \\sqrt{ \\beta_{hh}^{2} + 4 N \\beta_{ph} \\beta_{hp} } \\right).\n$$\n这就是基本再生数的闭式解析表达式，并通过 $R_{0}  1$ 给出了疫情暴发的阈值。", "answer": "$$\\boxed{\\frac{\\beta_{hh}+\\sqrt{\\beta_{hh}^{2}+4 N \\beta_{hp} \\beta_{ph}}}{2 \\gamma}}$$", "id": "1707340"}]}