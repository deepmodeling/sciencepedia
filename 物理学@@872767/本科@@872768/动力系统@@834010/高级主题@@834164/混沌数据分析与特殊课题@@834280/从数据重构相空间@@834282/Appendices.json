{"hands_on_practices": [{"introduction": "深入研究相空间重构的第一步是理解嵌入参数——即嵌入维度 $m$ 和时间延迟 $\\tau$——如何影响最终生成的数据集。本练习提供了一个具体的实践计算，让您能够确定从一个有限长度的时间序列中可以构建出多少个有效的状态向量。掌握这一计算有助于您理解在高嵌入维度与可用数据点数量之间存在的权衡关系。", "problem": "一位实验物理学家正在通过追踪单个示踪粒子的位置来分析弱湍流的动力学。该粒子的一维位置 $p(t)$ 以离散、均匀的时间间隔被记录下来，生成一个由 $N = 1000$ 个数据点组成的标量时间序列，我们可以将其表示为 $\\{p_1, p_2, \\dots, p_N\\}$。\n\n为了重构系统的吸引子并研究其潜在的几何结构，该物理学家采用了时间延迟嵌入法。该技术在高维空间中构建一组状态向量 $\\mathbf{V}_i$。每个向量都是根据以下规则使用原始时间序列中的值形成的：\n$$\n\\mathbf{V}_i = (p_i, p_{i+\\tau}, p_{i+2\\tau}, \\dots, p_{i+(m-1)\\tau})\n$$\n一个向量 $\\mathbf{V}_i$ 只有当其所有分量都是来自原始时间序列的实际数据点时，才被认为是重构相空间中的一个有效点。对于本分析，选择的嵌入维度为 $m=5$，时间延迟为 $\\tau=10$ 个步长。\n\n计算可以从给定的时间序列中构建出的有效状态向量 $\\mathbf{V}_i$ 的总数。", "solution": "问题要求计算使用时间延迟嵌入法可以构建的有效状态向量的总数。\n\n原始时间序列由 $\\{p_1, p_2, \\dots, p_N\\}$ 给出，其中数据点总数为 $N=1000$。数据点的索引范围是从 $1$ 到 $N$。\n\n重构相空间中的每个状态向量的形式如下：\n$$\n\\mathbf{V}_i = (p_i, p_{i+\\tau}, p_{i+2\\tau}, \\dots, p_{i+(m-1)\\tau})\n$$\n其中 $m$ 是嵌入维度，$\\tau$ 是时间延迟。给定的值为 $m=5$ 和 $\\tau=10$。\n\n一个向量 $\\mathbf{V}_i$ 是有效的，当且仅当它的每个分量都对应于原始时间序列中存在的数据点。这意味着每个分量的索引必须在 $1$ 和 $N$ 之间。我们来检查一下 $\\mathbf{V}_i$ 的分量的索引：\n第一个分量是 $p_i$，索引为 $i$。\n第二个分量是 $p_{i+\\tau}$，索引为 $i+\\tau$。\n...\n最后一个分量是 $p_{i+(m-1)\\tau}$，索引为 $i+(m-1)\\tau$。\n\n为了使向量 $\\mathbf{V}_i$ 有效，所有这些索引都必须小于或等于 $N$。由于索引是递增的，我们只需要确保最大的索引不大于 $N$。最大的索引对应于向量的最后一个分量。\n因此，一个有效向量的条件是：\n$$\ni + (m-1)\\tau \\le N\n$$\n\n向量的起始索引 $i$ 必须至少为 $1$。因此，起始索引 $i$ 的可能取值范围是从 $1$ 到某个最大值 $i_{max}$。为了找到 $i_{max}$，我们对不等式求解 $i$：\n$$\ni \\le N - (m-1)\\tau\n$$\n由于 $i$ 必须是整数，所以 $i$ 的最大值为 $i_{max} = N - (m-1)\\tau$。\n\n有效向量的总数是起始索引 $i$ 的可能整数值的数量。由于 $i$ 的取值范围是从 $1$ 到 $i_{max}$，因此有效向量的总数为：\n$$\n\\text{Total Vectors} = i_{max} - 1 + 1 = i_{max} = N - (m-1)\\tau\n$$\n\n现在，我们代入给定的数值：\n$N = 1000$\n$m = 5$\n$\\tau = 10$\n\n$$\n\\text{Total Vectors} = 1000 - (5-1) \\times 10\n$$\n$$\n\\text{Total Vectors} = 1000 - (4) \\times 10\n$$\n$$\n\\text{Total Vectors} = 1000 - 40\n$$\n$$\n\\text{Total Vectors} = 960\n$$\n\n因此，可以从该时间序列中构建出 960 个有效的状态向量。", "answer": "$$\\boxed{960}$$", "id": "1699327"}, {"introduction": "构建状态向量之后，下一步是将其可视化。时间延迟 $\\tau$ 的选择至关重要，因为它直接决定了重构吸引子的几何形状。本练习通过探索不同延迟如何影响一个简单周期信号的重构，挑战您思考何为“好”的延迟。通过找出重构完美圆形轨迹的条件 [@problem_id:1699289]，您将直观地理解如何选择 $\\tau$ 以便创建尽可能独立的坐标分量，从而清晰地揭示系统的内在动力学特性。", "problem": "在动力系统的时间序列数据分析中，一种常用的技术是时间延迟嵌入。对于一个给定的时间序列 $x(t)$，通过绘制点 $(v_1, v_2) = (x(t), x(t-\\tau))$ 来构建一个二维轨迹，其中 $\\tau$ 是一个选定的时间延迟。$v_1$-$v_2$ 平面中所得曲线的形状揭示了底层动力学的特性。\n\n考虑四个不同的系统，每个系统都产生一个时间序列 $x(t)$，其中 $T$ 是正弦分量振荡的基频周期。对于下列哪个系统，使用指定的时间延迟 $\\tau$ 进行时间延迟嵌入过程，会产生一个以原点为中心的完美圆形？\n\nA. 一个简谐振子，其 $x(t) = A\\sin(\\omega t)$，时间延迟 $\\tau = T/8$，其中 $T = 2\\pi/\\omega$。\n\nB. 一个阻尼谐振子，其 $x(t) = A\\exp(-\\gamma t)\\cos(\\omega t)$（对于某个常数 $\\gamma > 0$），时间延迟 $\\tau = T/4$，其中 $T = 2\\pi/\\omega$。\n\nC. 一个具有两个频率分量的系统，其 $x(t) = A\\sin(\\omega t) + B\\sin(2\\omega t)$，时间延迟 $\\tau = T/4$，其中 $T = 2\\pi/\\omega$。\n\nD. 一个无阻尼谐振子，其 $x(t) = A\\cos(\\omega t)$，时间延迟 $\\tau = T/4$，其中 $T = 2\\pi/\\omega$。", "solution": "我们考虑时间延迟嵌入 $(v_{1},v_{2})=(x(t),x(t-\\tau))$，并确定其轨迹何时是一个以原点为中心的完美圆形。对于单一频率和恒定振幅的正弦信号，形成一个圆的充分必要条件是两个坐标是等振幅的正交分量，即它们的相位差为 $\\pm \\pi/2$（模 $\\pi$），从而使得 $v_{1}^{2}+v_{2}^{2}$ 是一个常数。\n\nA. 设 $x(t)=A\\sin(\\omega t)$ 且 $\\tau=T/8$，其中 $T=2\\pi/\\omega$。定义 $\\theta=\\omega t$ 和 $\\phi=\\omega\\tau=\\omega(T/8)=\\pi/4$。那么\n$$\nv_{1}=A\\sin\\theta,\\quad v_{2}=A\\sin(\\theta-\\phi)=A(\\sin\\theta\\cos\\phi-\\cos\\theta\\sin\\phi).\n$$\n设 $u=v_{1}/A=\\sin\\theta$ 且 $v=v_{2}/A$。通过 $\\sin^{2}\\theta+\\cos^{2}\\theta=1$ 消去 $\\theta$：\n$$\nv=u\\cos\\phi-\\cos\\theta\\sin\\phi\\quad\\Rightarrow\\quad \\cos\\theta=\\frac{u\\cos\\phi-v}{\\sin\\phi},\n$$\n所以\n$$\nu^{2}+\\left(\\frac{u\\cos\\phi-v}{\\sin\\phi}\\right)^{2}=1.\n$$\n对于 $0<\\phi<\\pi$，这是一个椭圆方程，仅当 $\\cos\\phi=0$ 时才成为一个圆。此处 $\\phi=\\pi/4$ 得到 $\\cos\\phi\\neq 0$，所以该曲线不是一个圆。\n\nB. 设 $x(t)=A\\exp(-\\gamma t)\\cos(\\omega t)$，其中 $\\gamma>0$ 且 $\\tau=T/4$，所以 $\\phi=\\omega\\tau=\\pi/2$。令 $\\theta=\\omega t$，\n$$\nv_{1}=A\\exp(-\\gamma t)\\cos\\theta,\\quad v_{2}=A\\exp[-\\gamma(t-\\tau)]\\cos(\\theta-\\phi)=A\\exp(-\\gamma t)\\exp(\\gamma\\tau)\\sin\\theta.\n$$\n则\n$$\nv_{1}^{2}+\\left(\\frac{v_{2}}{\\exp(\\gamma\\tau)}\\right)^{2}=A^{2}\\exp(-2\\gamma t)\\big(\\cos^{2}\\theta+\\sin^{2}\\theta\\big)=A^{2}\\exp(-2\\gamma t),\n$$\n该式依赖于 $t$。轨迹不是一个单一的圆（它描绘了一个收缩的螺旋/椭圆族），因此它不是一个完美的圆。\n\nC. 设 $x(t)=A\\sin(\\omega t)+B\\sin(2\\omega t)$ 且 $\\tau=T/4$，所以 $\\phi=\\omega\\tau=\\pi/2$。令 $\\theta=\\omega t$，\n$$\nv_{1}=A\\sin\\theta+B\\sin(2\\theta),\\quad v_{2}=A\\sin(\\theta-\\phi)+B\\sin(2\\theta-2\\phi)=-A\\cos\\theta-B\\sin(2\\theta).\n$$\n计算\n$$\nv_{1}^{2}+v_{2}^{2}=A^{2}(\\sin^{2}\\theta+\\cos^{2}\\theta)+2B^{2}\\sin^{2}(2\\theta)+2AB\\sin(2\\theta)(\\sin\\theta+\\cos\\theta),\n$$\n除非 $B=0$，否则该式依赖于 $\\theta$。因此，对于 $B\\neq 0$，该曲线不是一个圆。\n\nD. 设 $x(t)=A\\cos(\\omega t)$ 且 $\\tau=T/4$，所以 $\\phi=\\omega\\tau=\\pi/2$ 且 $\\theta=\\omega t$。那么\n$$\nv_{1}=A\\cos\\theta,\\quad v_{2}=A\\cos(\\theta-\\phi)=A\\sin\\theta,\n$$\n因此\n$$\nv_{1}^{2}+v_{2}^{2}=A^{2}(\\cos^{2}\\theta+\\sin^{2}\\theta)=A^{2},\n$$\n是一个常数。轨迹是以原点为中心、半径为 $A$ 的圆。\n\n因此，只有选项D在所述的时间延迟嵌入下产生一个以原点为中心的完美圆形。", "answer": "$$\\boxed{D}$$", "id": "1699289"}, {"introduction": "一个精心选择的延迟可以揭示动力学信息，而一个糟糕的选择则会将其掩盖。一个常见的错误是选择过小的时间延迟 $\\tau$。本练习提供了一种强大的定量方法，来理解为何过小的 $\\tau$ 会带来问题。通过计算重构数据的协方差矩阵的特征值 [@problem_id:1699326]，您可以证明数据点会“坍缩”到一条直線上，这意味着坐标 $x(t)$ 和 $x(t+\\tau)$ 变得高度冗余。这种分析方法能让您从几何角度更深刻地理解相空间重构中参数选择的后果。", "problem": "一位实验者从一个复杂混沌系统中记录了一个标量时间序列 $x(t)$。为了分析其动力学，采用时间延迟嵌入方法来重构状态空间。利用时间延迟 $\\tau$ 从该时间序列构造一个二维状态向量 $\\vec{v}(t)$，使得 $\\vec{v}(t) = (x(t), x(t+\\tau))$。当时间延迟 $\\tau$ 的值非常小时，观察到重构点集在 $(x(t), x(t+\\tau))$ 平面上绘制时，似乎坍缩到一条细线上。\n\n为了量化这一观察，我们将点集 $\\{\\vec{v}(t)\\}$ 视为一个统计分布，并分析其协方差矩阵。数据云的形状和方向由该矩阵的特征值和特征向量描述。\n\n假设时间序列 $x(t)$ 是一个均值为零、方差为 $\\sigma_x^2$ 的平稳过程。其时间导数 $\\dot{x}(t)$ 的均值也为零，方差为 $\\sigma_{\\dot{x}}^2$。此外，假设 $x(t)$ 与其导数 $\\dot{x}(t)$ 统计不相关。\n\n对于一个很小的时间延迟 $\\tau$，可以使用一阶泰勒近似 $x(t+\\tau) \\approx x(t) + \\dot{x}(t)\\tau$。数据云 $\\{\\vec{v}(t)\\}$ 的协方差矩阵的特征值代表了数据沿其主轴的方差。\n\n计算该协方差矩阵的较小特征值与较大特征值的比值。将你的答案表示为 $\\tau$、$\\sigma_x$ 和 $\\sigma_{\\dot{x}}$ 的解析函数。在你的推导中，可以忽略任何 $\\tau^3$ 或更高阶的项。", "solution": "对于较小的 $\\tau$，我们使用一阶泰勒近似来构造二维向量：\n$$\n\\vec{v}(t)=\\begin{pmatrix}x(t)\\\\ x(t+\\tau)\\end{pmatrix}\\approx\\begin{pmatrix}x\\\\ x+\\tau\\dot{x}\\end{pmatrix}.\n$$\n给定平稳性和零均值，$\\vec{v}(t)$ 的协方差矩阵 $\\Sigma$ 为 $\\Sigma=\\mathbb{E}[\\vec{v}\\,\\vec{v}^{\\top}]$。使用 $\\mathbb{E}[x]=\\mathbb{E}[\\dot{x}]=0$、$\\operatorname{Var}(x)=\\sigma_{x}^{2}$、$\\operatorname{Var}(\\dot{x})=\\sigma_{\\dot{x}}^{2}$ 以及 $\\operatorname{Cov}(x,\\dot{x})=0$，其矩阵元素为：\n$$\n\\Sigma_{11}=\\mathbb{E}[x^{2}]=\\sigma_{x}^{2},\n$$\n$$\n\\Sigma_{12}=\\mathbb{E}[x(x+\\tau\\dot{x})]=\\mathbb{E}[x^{2}]+\\tau\\,\\mathbb{E}[x\\dot{x}]=\\sigma_{x}^{2},\n$$\n$$\n\\Sigma_{22}=\\mathbb{E}[(x+\\tau\\dot{x})^{2}]=\\mathbb{E}[x^{2}]+2\\tau\\,\\mathbb{E}[x\\dot{x}]+\\tau^{2}\\mathbb{E}[\\dot{x}^{2}]=\\sigma_{x}^{2}+\\tau^{2}\\sigma_{\\dot{x}}^{2}.\n$$\n因此，\n$$\n\\Sigma=\\begin{pmatrix}\n\\sigma_{x}^{2} & \\sigma_{x}^{2} \\\\\n\\sigma_{x}^{2} & \\sigma_{x}^{2}+\\tau^{2}\\sigma_{\\dot{x}}^{2}\n\\end{pmatrix}.\n$$\n对于一个对称的 $2\\times 2$ 矩阵 $\\begin{pmatrix}a & b\\\\ b & c\\end{pmatrix}$，其特征值为\n$$\n\\lambda_{\\pm}=\\frac{(a+c)\\pm\\sqrt{(a-c)^{2}+4b^{2}}}{2}.\n$$\n当 $a=\\sigma_{x}^{2}$，$b=\\sigma_{x}^{2}$，$c=\\sigma_{x}^{2}+\\tau^{2}\\sigma_{\\dot{x}}^{2}$ 时，我们有\n$$\n\\operatorname{tr}\\Sigma=2\\sigma_{x}^{2}+\\tau^{2}\\sigma_{\\dot{x}}^{2},\\qquad \\det\\Sigma=\\sigma_{x}^{2}\\tau^{2}\\sigma_{\\dot{x}}^{2},\n$$\n以及\n$$\n\\lambda_{\\pm}=\\frac{2\\sigma_{x}^{2}+\\tau^{2}\\sigma_{\\dot{x}}^{2}\\pm\\sqrt{4\\sigma_{x}^{4}+\\tau^{4}\\sigma_{\\dot{x}}^{4}}}{2}.\n$$\n对于较小的 $\\tau$，将平方根展开到允许的阶数。由于\n$$\n\\sqrt{4\\sigma_{x}^{4}+\\tau^{4}\\sigma_{\\dot{x}}^{4}}=2\\sigma_{x}^{2}\\sqrt{1+\\frac{\\tau^{4}\\sigma_{\\dot{x}}^{4}}{4\\sigma_{x}^{4}}}=2\\sigma_{x}^{2}+O(\\tau^{4}),\n$$\n并且可以忽略 $\\tau^{3}$ 或更高阶的项，我们得到\n$$\n\\lambda_{+}=2\\sigma_{x}^{2}+\\frac{1}{2}\\tau^{2}\\sigma_{\\dot{x}}^{2}+O(\\tau^{4}),\\qquad\n\\lambda_{-}=\\frac{1}{2}\\tau^{2}\\sigma_{\\dot{x}}^{2}+O(\\tau^{4}).\n$$\n因此，较小特征值与较大特征值的比值，保留到 $\\tau^{2}$ 阶并忽略 $\\tau^{3}$ 及更高阶的项，为\n$$\n\\frac{\\lambda_{-}}{\\lambda_{+}}=\\frac{\\frac{1}{2}\\tau^{2}\\sigma_{\\dot{x}}^{2}}{2\\sigma_{x}^{2}+\\frac{1}{2}\\tau^{2}\\sigma_{\\dot{x}}^{2}}=\\frac{\\tau^{2}\\sigma_{\\dot{x}}^{2}}{4\\sigma_{x}^{2}}\\left[1+O(\\tau^{2})\\right].\n$$\n舍去 $\\tau^{3}$ 或更高阶的项，得到最终表达式：\n$$\n\\frac{\\lambda_{\\min}}{\\lambda_{\\max}}=\\frac{\\tau^{2}\\sigma_{\\dot{x}}^{2}}{4\\sigma_{x}^{2}}.\n$$", "answer": "$$\\boxed{\\frac{\\tau^{2}\\sigma_{\\dot{x}}^{2}}{4\\sigma_{x}^{2}}}$$", "id": "1699326"}]}