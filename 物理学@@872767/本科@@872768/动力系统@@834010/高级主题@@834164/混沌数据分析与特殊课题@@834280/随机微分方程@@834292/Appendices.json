{"hands_on_practices": [{"introduction": "许多现实世界的系统，如种群动态或金融资产，其增长不仅受内在速率的驱动，还受到随机环境波动的影响。一个看似增长率 ($a>0$) 为正的系统，在引入随机性后，其长期行为可能会出人意料地走向灭绝。本练习将引导你使用伊藤引理来揭示一个随机微分方程的精确解，并推导出决定种群长期生存与否的关键阈值，从而深刻理解随机性如何从根本上改变系统的稳定性 [@problem_id:1710345]。", "problem": "一个用于研究随机波动环境影响的物种族群大小的简化模型，其在时间 $t$ 的族群大小用 $X_t$ 表示。该族群动态由以下线性随机微分方程 (SDE) 控制：\n$$dX_t = a X_t dt + X_t dW_t$$\n其中初始族群 $X_0$ 为正。在此模型中，$a$ 是一个无量纲常数，代表在平均环境条件下，结合了出生率和死亡率的族群净内在增长率。项 $W_t$ 代表一个标准的维纳过程，它模拟了由于环境变异性对族群造成的不可预测的随机冲击。\n\n物种的长期生存是一个关键问题。如果物种的族群大小几乎必然地随着时间趋于无穷而收敛到零，即 $\\lim_{t \\to \\infty} X_t = 0$ 的概率为一，则认为该物种面临必然灭绝。可以证明，内在增长率存在一个临界值，我们将其表示为 $a_c$。如果物种的实际增长率 $a$ 小于这个临界值 ($a  a_c$)，则该族群必然会灭绝。相反，如果 $a > a_c$，则该族群有非零的长期生存概率。\n\n确定这个临界增长率 $a_c$ 的精确值。", "solution": "我们分析线性随机微分方程 $dX_{t}=aX_{t}\\,dt+X_{t}\\,dW_{t}$，其中 $X_{0}>0$。为了确定几乎必然的长期行为，我们将伊藤公式应用于 $f(x)=\\ln x$。对于 $f(x)=\\ln x$，我们有 $f'(x)=x^{-1}$ 和 $f''(x)=-x^{-2}$。将随机微分方程写成 $dX_{t}=b(X_{t})\\,dt+\\sigma(X_{t})\\,dW_{t}$ 的形式，其中 $b(x)=ax$ 和 $\\sigma(x)=x$，伊藤公式给出\n$$\nd\\ln X_{t}\n= \\left(\\frac{b(X_{t})}{X_{t}} - \\frac{1}{2}\\frac{\\sigma(X_{t})^{2}}{X_{t}^{2}}\\right)dt + \\frac{\\sigma(X_{t})}{X_{t}}\\,dW_{t}\n= \\left(a - \\frac{1}{2}\\right)dt + dW_{t}.\n$$\n从 $0$ 到 $t$ 积分，得到\n$$\n\\ln X_{t} = \\ln X_{0} + \\left(a - \\frac{1}{2}\\right)t + W_{t},\n$$\n因此\n$$\nX_{t} = X_{0}\\exp\\left(\\left(a - \\frac{1}{2}\\right)t + W_{t}\\right).\n$$\n这个表达式表明对于所有 $t\\geq 0$，$X_{t}>0$。\n\n为了确定灭绝还是生存，我们考虑缩放后的对数\n$$\n\\frac{1}{t}\\ln X_{t} = \\frac{1}{t}\\ln X_{0} + \\left(a - \\frac{1}{2}\\right) + \\frac{W_{t}}{t}.\n$$\n根据布朗运动的强大数定律，$\\lim_{t\\to\\infty} W_{t}/t = 0$ 几乎必然成立，并且显然 $\\lim_{t\\to\\infty} (\\ln X_{0})/t = 0$。因此，\n$$\n\\lim_{t\\to\\infty} \\frac{1}{t}\\ln X_{t} = a - \\frac{1}{2} \\quad \\text{几乎必然}.\n$$\n结果是：\n- 如果 $a - \\frac{1}{2}  0$，则 $\\ln X_{t} \\to -\\infty$ 几乎必然成立，所以 $X_{t} \\to 0$ 几乎必然成立（必然灭绝）。\n- 如果 $a - \\frac{1}{2} > 0$，则 $\\ln X_{t} \\to +\\infty$ 几乎必然成立，所以 $X_{t} \\to \\infty$ 几乎必然成立（因此不会发生灭绝；生存概率为一）。\n\n因此，临界增长率是 $\\ln X_{t}$ 的漂移项改变符号的阈值，即\n$$\na_{c} = \\frac{1}{2}.\n$$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1710345"}, {"introduction": "在许多应用中，我们关心的不是一个随机过程在特定时间点的状态，而是它首次达到某个临界阈值的时间和结果。这个问题，通常被称为“首次穿越问题”，在金融领域的期权定价和风险管理中至关重要。本练习 [@problem_id:1710319] 将通过一个金融场景，运用维纳过程的鞅性质，来计算一个过程首先触及两个边界中某一个的概率，这是一种比直接求解相应的偏微分方程更优雅和强大的方法。", "problem": "一位金融分析师为一种投机性资产的价格 $P(t)$ 随时间 $t$ 的演变建立模型。该模型假设，价格与其初始价格 $P(0)$ 之比的自然对数，定义为 $X_t = \\ln(P(t)/P(0))$，其动态服从一个标准一维维纳过程 $W_t$。该过程从 $X_0 = 0$ 开始。\n\n分析师实施了一项基于两个预设阈值的自动化交易策略。如果过程 $X_t$ 首次达到一个上边界 $a > 0$，则会触发“止盈”订单。如果 $X_t$ 首次达到一个下边界 $-b$（其中 $b > 0$），则会触发“止损”订单。我们假设该过程最终会触及这两个边界之一。\n\n求因触发“止盈”订单而非“止损”订单而导致交易头寸被平仓的概率。你的答案应该是一个用 $a$ 和 $b$ 表示的符号表达式。", "solution": "设 $X_{t}=W_{t}$ 是一个标准维纳过程，且 $X_{0}=0$。定义首次到达双侧边界的时间为\n$$\n\\tau=\\inf\\{t\\ge 0:\\,X_{t}\\in\\{-b,a\\}\\}.\n$$\n令 $p=\\mathbb{P}(X_{\\tau}=a)$ 表示在到达下边界 $-b$ 之前先到达上边界 $a$ 的概率。\n\n由于 $X_{t}$ 是一个标准布朗运动，所以它是一个鞅。停时过程 $(X_{t\\wedge\\tau})_{t\\ge 0}$ 受 $\\max\\{a,b\\}$ 所界，因为在触及边界之前，它位于 $(-b,a)$ 区间内，而在触及边界后，其值等于 $a$ 或 $-b$。因此 $(X_{t\\wedge\\tau})_{t\\ge 0}$ 是一个有界鞅，所以对所有 $t\\ge 0$，有\n$$\n\\mathbb{E}[X_{t\\wedge\\tau}]=\\mathbb{E}[X_{0}]=0.\n$$\n此外，当 $t\\to\\infty$ 时，$X_{t\\wedge\\tau}\\to X_{\\tau}$ 几乎必然成立，并且对所有 $t$ 都有 $|X_{t\\wedge\\tau}|\\le \\max\\{a,b\\}$，因此根据控制收敛定理，\n$$\n\\mathbb{E}[X_{\\tau}]=\\lim_{t\\to\\infty}\\mathbb{E}[X_{t\\wedge\\tau}]=0.\n$$\n在停时 $\\tau$，随机变量 $X_{\\tau}$ 以概率 $p$ 取值 $a$，并以概率 $1-p$ 取值 $-b$。因此，\n$$\n\\mathbb{E}[X_{\\tau}]=a\\,p+(-b)\\,(1-p)=0.\n$$\n对 $p$ 求解这个线性方程，可得\n$$\na\\,p-b+b\\,p=0\\quad\\Longrightarrow\\quad (a+b)\\,p=b\\quad\\Longrightarrow\\quad p=\\frac{b}{a+b}.\n$$\n因此，过程在到达下边界 $-b$ 之前先到达上边界 $a$ 的概率是 $\\frac{b}{a+b}$。", "answer": "$$\\boxed{\\frac{b}{a+b}}$$", "id": "1710319"}, {"introduction": "绝大多数随机微分方程无法求得解析解，因此数值模拟成为研究其行为不可或缺的工具。然而，将连续时间模型离散化会引入稳定性问题，即数值解是否能真实反映原始系统的长期动态。本练习 [@problem_id:1710321] 探讨了最常用的数值方法——欧拉-丸山法的均方稳定性，你将推导出为保证数值解收敛所需满足的时间步长条件，从而理解在随机模拟中选择合适参数的重要性。", "problem": "一个描述某量 $X_t$ 的随机模型由以下标量线性随机微分方程（SDE）描述：\n$$\ndX_t = \\lambda X_t dt + \\mu X_t dW_t\n$$\n其中 $t$ 是时间，$X_0$ 是非零初始值，$W_t$ 是一个标准维纳过程，$\\lambda$ 和 $\\mu$ 是实数常量且 $\\lambda \\neq 0$。参数 $\\lambda$ 和 $\\mu$ 使得精确解 $X_t$ 是均方稳定的，即 $\\lim_{t \\to \\infty} \\mathbb{E}[X_t^2] = 0$。\n\n为了数值近似求解，应用了具有恒定时间步长 $\\Delta t > 0$ 的显式欧拉-丸山（EM）方法，生成一个近似序列 $\\{X_n\\}_{n \\geq 0}$，其中 $X_n \\approx X(n\\Delta t)$。如果数值解的二阶矩序列 $\\mathbb{E}[X_n^2]$ 在 $n \\to \\infty$ 时收敛到零，则称EM方法是均方稳定的。\n\n确定保证EM格式是均方稳定的最大允许时间步长 $\\Delta t_{max}$。请用 $\\lambda$ 和 $\\mu$ 将您的答案表示为单个解析表达式。", "solution": "给定的随机微分方程（SDE）为 $dX_t = \\lambda X_t dt + \\mu X_t dW_t$。\n对于一个一般的SDE $dY_t = a(t, Y_t) dt + b(t, Y_t) dW_t$，显式欧拉-丸山（EM）格式由下式给出：$Y_{n+1} = Y_n + a(t_n, Y_n) \\Delta t + b(t_n, Y_n) \\Delta W_n$，其中 $\\Delta t = t_{n+1} - t_n$ 且 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$。维纳过程的增量 $\\Delta W_n$ 是独立同分布的正态随机变量，其均值为 $\\mathbb{E}[\\Delta W_n] = 0$，方差为 $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$。\n\n将EM格式应用于本问题中的特定SDE，我们得到离散时间更新规则：\n$$\nX_{n+1} = X_n + \\lambda X_n \\Delta t + \\mu X_n \\Delta W_n\n$$\n我们可以提出因子 $X_n$ 将其写作：\n$$\nX_{n+1} = X_n (1 + \\lambda \\Delta t + \\mu \\Delta W_n)\n$$\n为了分析均方稳定性，我们需要考察二阶矩 $\\mathbb{E}[X_n^2]$ 的演化。我们首先对 $X_{n+1}$ 的表达式进行平方：\n$$\nX_{n+1}^2 = X_n^2 (1 + \\lambda \\Delta t + \\mu \\Delta W_n)^2\n$$\n展开平方项得到：\n$$\nX_{n+1}^2 = X_n^2 (1 + \\lambda^2 (\\Delta t)^2 + \\mu^2 (\\Delta W_n)^2 + 2\\lambda \\Delta t + 2\\mu \\Delta W_n + 2\\lambda\\mu \\Delta t \\Delta W_n)\n$$\n现在，我们对两边取期望。最严谨的做法是首先对关于滤子 $\\mathcal{F}_{t_n}$（直到时间 $t_n$ 可用的信息）取条件期望。由于 $X_n$ 和 $\\Delta t$ 在时间 $t_n$ 是已知的，它们在条件期望内可以被视为常数。增量 $\\Delta W_n$ 独立于 $\\mathcal{F}_{t_n}$。\n$$\n\\mathbb{E}[X_{n+1}^2 | \\mathcal{F}_{t_n}] = X_n^2 \\mathbb{E}[(1 + \\lambda^2 (\\Delta t)^2 + \\mu^2 (\\Delta W_n)^2 + 2\\lambda \\Delta t + 2\\mu \\Delta W_n + 2\\lambda\\mu \\Delta t \\Delta W_n) | \\mathcal{F}_{t_n}]\n$$\n利用期望的线性和性质 $\\mathbb{E}[\\Delta W_n | \\mathcal{F}_{t_n}] = \\mathbb{E}[\\Delta W_n] = 0$ 和 $\\mathbb{E}[(\\Delta W_n)^2 | \\mathcal{F}_{t_n}] = \\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$，我们得到：\n$$\n\\mathbb{E}[X_{n+1}^2 | \\mathcal{F}_{t_n}] = X_n^2 (1 + \\lambda^2 (\\Delta t)^2 + \\mu^2 \\Delta t + 2\\lambda \\Delta t + 0 + 0)\n$$\n$$\n\\mathbb{E}[X_{n+1}^2 | \\mathcal{F}_{t_n}] = X_n^2 (1 + 2\\lambda \\Delta t + \\lambda^2 (\\Delta t)^2 + \\mu^2 \\Delta t)\n$$\n使用全期望定律 $\\mathbb{E}[Y] = \\mathbb{E}[\\mathbb{E}[Y | \\mathcal{G}]]$，我们有：\n$$\n\\mathbb{E}[X_{n+1}^2] = \\mathbb{E}[\\mathbb{E}[X_{n+1}^2 | \\mathcal{F}_{t_n}]] = \\mathbb{E}[X_n^2 (1 + 2\\lambda \\Delta t + \\lambda^2 (\\Delta t)^2 + \\mu^2 \\Delta t)]\n$$\n由于括号中的项是常数，我们可以将其从外层期望中提出：\n$$\n\\mathbb{E}[X_{n+1}^2] = (1 + 2\\lambda \\Delta t + \\lambda^2 (\\Delta t)^2 + \\mu^2 \\Delta t) \\mathbb{E}[X_n^2]\n$$\n这是一个关于二阶矩序列的几何递推关系。令放大因子为 $R(\\Delta t) = 1 + 2\\lambda \\Delta t + \\lambda^2 (\\Delta t)^2 + \\mu^2 \\Delta t$。\n为了使数值格式是均方稳定的，我们需要 $\\lim_{n \\to \\infty} \\mathbb{E}[X_n^2] = 0$。这当且仅当放大因子的绝对值小于1时成立，即 $|R(\\Delta t)|  1$。\n\n我们可以将 $R(\\Delta t)$ 重写为：\n$$\nR(\\Delta t) = (1 + \\lambda \\Delta t)^2 + \\mu^2 \\Delta t\n$$\n因为 $\\Delta t > 0$ 且 $\\mu^2 \\geq 0$，项 $\\mu^2 \\Delta t$ 是非负的。同样，$(1 + \\lambda \\Delta t)^2$ 是非负的。因此，$R(\\Delta t) \\geq 0$。稳定性条件 $|R(\\Delta t)|  1$ 简化为 $R(\\Delta t)  1$。\n$$\n1 + 2\\lambda \\Delta t + \\lambda^2 (\\Delta t)^2 + \\mu^2 \\Delta t  1\n$$\n两边同时减1得到：\n$$\n2\\lambda \\Delta t + \\lambda^2 (\\Delta t)^2 + \\mu^2 \\Delta t  0\n$$\n由于 $\\Delta t > 0$，我们可以用 $\\Delta t$ 除以两边而不改变不等号的方向：\n$$\n2\\lambda + \\lambda^2 \\Delta t + \\mu^2  0\n$$\n现在，我们求解 $\\Delta t$。整理各项，我们得到：\n$$\n\\lambda^2 \\Delta t  -2\\lambda - \\mu^2\n$$\n为了使这个不等式对于 $\\Delta t > 0$ 有解，右边必须为正，这意味着 $-2\\lambda - \\mu^2 > 0$，即 $2\\lambda + \\mu^2  0$。这恰好是精确SDE均方稳定的条件，这在问题陈述中已经给出。\n因为问题陈述 $\\lambda \\neq 0$，我们有 $\\lambda^2 > 0$。我们可以用 $\\lambda^2$ 除以两边来分离出 $\\Delta t$：\n$$\n\\Delta t  \\frac{-2\\lambda - \\mu^2}{\\lambda^2}\n$$\n这个不等式的右边代表了均方稳定性的时间步长的上界。因此，最大允许时间步长为：\n$$\n\\Delta t_{max} = \\frac{-2\\lambda - \\mu^2}{\\lambda^2}\n$$", "answer": "$$\\boxed{\\frac{-2\\lambda - \\mu^{2}}{\\lambda^{2}}}$$", "id": "1710321"}]}