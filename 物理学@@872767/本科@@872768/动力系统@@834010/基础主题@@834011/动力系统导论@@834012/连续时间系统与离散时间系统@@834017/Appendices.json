{"hands_on_practices": [{"introduction": "理论联系实际是掌握任何科学概念的关键。本节的第一个练习将引导你完成最基本的转换：将一个描述连续增长的微分方程转化为一个计算机可以逐步执行的离散时间规则。通过研究一个简单的人工生命模拟 [@problem_id:1669660]，你将应用前向欧拉方法，这是将连续模型转化为离散模型的最直接的技术之一，为理解数字世界如何模拟现实世界奠定基础。", "problem": "一位计算机科学家正在开发一个简单的人工生命（A-Life）模拟。在这个模拟中，一个自我复制的数字生物种群（在连续时间 $t$ 表示为 $P(t)$）由微分方程 $\\frac{dP}{dt} = rP$ 控制，其中 $r$ 是一个代表净增长率的正常数参数。\n\n该模拟的引擎无法连续地对系统建模。相反，它以固定的时长 $h$ 的离散时间步长来更新世界。在时间步长 $n$ 的种群表示为 $P_n$。为了计算下一个时间步长 $P_{n+1}$ 的种群，引擎使用了一个简单的近似方法：它假设从时间 $t_n$ 到 $t_{n+1} = t_n + h$ 的整个区间内，种群变化率是恒定的，并且等于在该区间开始时（即 $t_n$）计算出的速率。\n\n基于这个离散更新规则，推导出一个用 $P_n$、增长率 $r$ 和步长 $h$ 表示的种群 $P_{n+1}$ 的表达式。", "solution": "我们已知连续模型 $\\frac{dP}{dt}=rP$（其中 $r0$ 为常数），并且引擎以大小为 $h$ 的离散步长进行更新，其中 $t_{n+1}=t_{n}+h$。近似方法是，在区间 $\\left[t_{n},t_{n+1}\\right]$ 上的变化率是恒定的，且等于其在 $t_{n}$ 处的值。这意味着我们近似为\n$$\n\\frac{dP}{dt}\\bigg|_{t\\in[t_{n},t_{n+1}]} \\approx \\frac{dP}{dt}\\bigg|_{t=t_{n}}=rP(t_{n})=rP_{n}.\n$$\n使用微积分基本定理，\n$$\nP_{n+1}-P_{n}=\\int_{t_{n}}^{t_{n+1}}\\frac{dP}{dt}\\,dt \\approx \\int_{t_{n}}^{t_{n+1}} rP_{n}\\,dt = rP_{n}\\,(t_{n+1}-t_{n})=rP_{n}\\,h.\n$$\n整理后得到离散更新规则\n$$\nP_{n+1}=P_{n}+hrP_{n}=(1+rh)P_{n}.\n$$\n这是从所述的恒定斜率近似推导出的前向欧拉更新法。", "answer": "$$\\boxed{(1+rh)P_{n}}$$", "id": "1669660"}, {"introduction": "在掌握了基本的一阶系统离散化之后，我们来挑战一个更复杂的场景：一个受阻尼的非线性摆。许多物理系统，如机械振动或天体运动，都由二阶或更高阶的微分方程描述。这个练习 [@problem_id:1669637] 将教你如何将一个二阶常微分方程转化为一个一阶方程组，然后对该系统进行离散化，这是在计算机上模拟复杂动力学行为的一项核心技能。", "problem": "一位计算物理学家正在为一个阻尼非线性摆开发一个模拟程序。该摆的运动由以下连续时间微分方程描述：\n$$\n\\frac{d^2\\theta}{dt^2} + b \\frac{d\\theta}{dt} + k \\sin(\\theta) = 0\n$$\n其中 $\\theta(t)$ 是摆在时间 $t$ 时与垂直方向的夹角，$b$ 是一个正的阻尼系数，$k$ 是一个与重力和摆长相关的正常数。\n\n为了数值地实现这个模型，该物理学家需要将连续方程转换为一组离散时间更新规则。系统在离散时间步 $n$ 的状态由数对 $(\\theta_n, \\omega_n)$ 表示，其中 $\\theta_n$ 是角度，$\\omega_n$ 是角速度。该模拟以持续时间为 $\\Delta t$ 的固定时间增量进行。\n\n使用时间导数的一阶前向差分近似，其中在时间步 $n$ 的导数 $\\frac{dy}{dt}$ 近似为 $\\frac{y_{n+1} - y_n}{\\Delta t}$，推导该系统的更新规则。求出在时间步 $n+1$ 时的角度 $\\theta_{n+1}$ 和角速度 $\\omega_{n+1}$ 的表达式。这些表达式应该用时间步 $n$ 的状态变量（即 $\\theta_n$ 和 $\\omega_n$）、时间步长 $\\Delta t$ 以及系统参数 $b$ 和 $k$ 来表示。\n\n将得到的表达式对 $(\\theta_{n+1}, \\omega_{n+1})$ 作为你的最终答案。", "solution": "我们从连续时间的二阶方程开始\n$$\n\\frac{d^{2}\\theta}{dt^{2}} + b \\frac{d\\theta}{dt} + k \\sin(\\theta) = 0.\n$$\n引入角速度 $\\omega(t)$，其定义为\n$$\n\\omega(t) = \\frac{d\\theta}{dt}.\n$$\n这将二阶方程转换为一阶系统\n$$\n\\frac{d\\theta}{dt} = \\omega, \\qquad \\frac{d\\omega}{dt} = -b\\,\\omega - k \\sin(\\theta).\n$$\n在时间步 $n$ 使用一阶前向差分近似，\n$$\n\\left.\\frac{dy}{dt}\\right|_{t_{n}} \\approx \\frac{y_{n+1} - y_{n}}{\\Delta t},\n$$\n我们将每个方程离散化如下。\n\n对于角度更新，对 $\\frac{d\\theta}{dt} = \\omega$ 应用前向差分：\n$$\n\\frac{\\theta_{n+1} - \\theta_{n}}{\\Delta t} = \\omega_{n}\n\\;\\;\\Rightarrow\\;\\;\n\\theta_{n+1} = \\theta_{n} + \\Delta t\\,\\omega_{n}.\n$$\n\n对于角速度更新，对 $\\frac{d\\omega}{dt} = -b\\,\\omega - k \\sin(\\theta)$ 应用前向差分：\n$$\n\\frac{\\omega_{n+1} - \\omega_{n}}{\\Delta t} = -b\\,\\omega_{n} - k \\sin(\\theta_{n})\n\\;\\;\\Rightarrow\\;\\;\n\\omega_{n+1} = \\omega_{n} - \\Delta t\\left(b\\,\\omega_{n} + k \\sin(\\theta_{n})\\right).\n$$\n\n因此，在时间步长 $\\Delta t$ 内将 $(\\theta_{n},\\omega_{n})$ 推进到 $(\\theta_{n+1},\\omega_{n+1})$ 的显式前向欧拉更新规则是\n$$\n\\theta_{n+1} = \\theta_{n} + \\Delta t\\,\\omega_{n}, \\qquad\n\\omega_{n+1} = \\omega_{n} - \\Delta t\\left(b\\,\\omega_{n} + k \\sin(\\theta_{n})\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\theta_{n} + \\Delta t\\,\\omega_{n}  \\omega_{n} - \\Delta t\\left(b\\,\\omega_{n} + k \\sin(\\theta_{n})\\right)\\end{pmatrix}}$$", "id": "1669637"}, {"introduction": "离散化虽然强大，但也并非没有代价。简单地将连续系统转换为离散形式可能会引入一些意想不到的行为。本练习 [@problem_id:1669632] 探讨了一个关键概念：数值稳定性。你将分析一个本身绝对稳定的放射性衰变过程，并会发现其离散近似仅在特定条件下才保持稳定。这个例子是一个重要的警示，它强调了在数值模拟中谨慎选择时间步长的必要性，以确保结果的物理真实性。", "problem": "放射性核群体的衰变可以用以下一阶线性微分方程来建模：\n$$ \\frac{dN}{dt} = -\\lambda N(t) $$\n其中 $N(t)$ 表示在时间 $t$ 未衰变的原子核数量，$\\lambda$ 是正常数衰变常数。这个连续时间系统是固有稳定的，因为群体 $N(t)$ 会指数衰减到零。\n\n这个过程的数值模拟可以通过离散时间近似来实现。应用步长为 $h  0$ 的前向欧拉法，该连续微分方程被转换为 $N_{k+1} = G N_k$ 形式的离散时间更新规则，其中 $N_k$ 近似于 $N(kh)$，$G$ 是一个取决于 $\\lambda$ 和 $h$ 的因子。\n\n为使数值模拟稳定（即，模拟的群体 $N_k$ 趋向于零而不是无界增长），必须适当地选择时间步长 $h$。如果 $h$ 太大，模拟将变得不稳定。\n\n确定使这种放射性衰变的前向欧拉模拟保持稳定的最大时间步长 $h_{max}$。请用关于衰变常数 $\\lambda$ 的符号表达式来表示你的答案。", "solution": "从线性常微分方程 $ \\frac{dN}{dt} = -\\lambda N(t)$ 开始，其中 $\\lambda  0$。应用步长为 $h0$ 的前向欧拉法，得到离散更新式\n$$\nN_{k+1} = N_{k} + h\\left(-\\lambda N_{k}\\right) = \\left(1 - \\lambda h\\right) N_{k}.\n$$\n因此，放大因子为 $G = 1 - \\lambda h$，递推关系为 $N_{k+1} = G N_{k}$。其通解为 $N_{k} = G^{k} N_{0}$。为使数值模拟在 $k \\to \\infty$ 时 $N_{k} \\to 0$ 的意义下是稳定的，其充要条件是\n$$\n|G|  1.\n$$\n代入 $G = 1 - \\lambda h$ 可得\n$$\n|1 - \\lambda h|  1.\n$$\n这个双重不等式等价于\n$$\n-1  1 - \\lambda h  1.\n$$\n各部分都减去 $1$ 得到\n$$\n-2  -\\lambda h  0.\n$$\n由于 $\\lambda > 0$，除以 $-\\lambda$ 会反转不等号，得到\n$$\n0  h  \\frac{2}{\\lambda}.\n$$\n因此，使前向欧拉法保持稳定的最大允许时间步长是\n$$\nh_{\\text{max}} = \\frac{2}{\\lambda},\n$$\n需要注意的是，等号成立时会得到 $|G|=1$，此时没有衰减，所以稳定性条件要求 $h  \\frac{2}{\\lambda}$，其中 $\\frac{2}{\\lambda}$ 是上确界。", "answer": "$$\\boxed{\\frac{2}{\\lambda}}$$", "id": "1669632"}]}