{"hands_on_practices": [{"introduction": "数值方法不仅可以用于求解微分方程，还能帮助我们根据实验数据估算模型中的未知参数。本练习将通过一个实际情景，即药物浓度衰减模型，来展示如何运用欧拉法进行参数估算。通过这个简单的单步计算，我们将学会如何从测量数据中近似求解关键的反应速率常数，从而体会到数值方法在分析真实世界数据时的实用价值。[@problem_id:1695650]", "problem": "观察到患者血液中的药物浓度（记为 $C(t)$）随时间减少。此过程的一个简化模型假设药物浓度的变化率与当前浓度成正比。该关系可用以下微分方程表示：\n$$\n\\frac{dC}{dt} = -k C(t)\n$$\n其中 $k$ 是正的消除速率常数，时间 $t$ 的单位是小时。\n\n在注射时刻 $t=0$ 时，测得的浓度为 $C_0 = 100.0$ mg/L。经过 $T=2.00$ 小时后，再次测量浓度，发现为 $C(T) = 90.0$ mg/L。\n\n为了得到速率常数 $k$ 的一个简单估计，我们将使用线性近似。假设在从 $t=0$ 到 $t=T$ 的整个区间内，浓度的变化率是恒定的，且等于 $t=0$ 时的初始变化率。使用此近似，计算消除速率常数 $k$ 的值。\n\n请用反小时（hours$^{-1}$）作为单位表示 $k$ 的答案，并四舍五入到三位有效数字。", "solution": "我们已知微分方程 $ \\frac{dC}{dt} = -k\\,C(t) $，初始浓度为 $C(0) = C_{0}$，以及在 $t=T$ 时的测量值为 $C(T)$。线性近似假设在 $[0,T]$ 区间内的变化率是恒定的，且等于 $t=0$ 时的初始速率。\n\n$[0,T]$ 区间内的平均变化率是\n$$\n\\frac{C(T)-C(0)}{T}.\n$$\n在所述近似下，它等于初始导数：\n$$\n\\frac{C(T)-C_{0}}{T} = \\left.\\frac{dC}{dt}\\right|_{t=0} = -k\\,C_{0}.\n$$\n求解 $k$ 可得\n$$\nk = \\frac{C_{0}-C(T)}{T\\,C_{0}}.\n$$\n代入 $C_{0} = 100.0$，$C(T) = 90.0$ 和 $T = 2.00$（其中 $t$ 的单位是小时）可得\n$$\nk = \\frac{100.0 - 90.0}{2.00 \\times 100.0} = \\frac{10.0}{200.0} = 0.0500 \\;\\text{hours}^{-1},\n$$\n四舍五入到三位有效数字。", "answer": "$$\\boxed{0.0500}$$", "id": "1695650"}, {"introduction": "欧拉法虽然简单直观，但其简洁性也带来了潜在的风险：数值不稳定性。选择合适的步长 $h$ 是至关重要的。本练习将以经典的逻辑斯谛增长模型为例，揭示一个常见的陷阱：当步长 $h$ 过大时，数值解可能会出现超越环境承载能力等不符合物理现实的结果，这有助于我们理解数值稳定性对保证计算结果有效性的重要性。[@problem_id:1695616]", "problem": "一个简化模型描述了量 $P(t)$ 随时间的演化，其演化由以下微分方程控制：\n$$ \\frac{dP}{dt} = k P(1-P) $$\n其中 $k$ 是一个正常数。\n\n为了数值上近似该解，我们采用一个离散时间更新法则。下一步的值 $P_{n+1}$ 由当前值 $P_n$ 通过以下法则计算得出：\n$$ P_{n+1} = P_n + h \\left( k P_n(1-P_n) \\right) $$\n其中 $h$ 是时间步长。\n\n假设初始值为 $P_0 = 0.30$，速率常数为 $k = 1.8$。如果计算出的某个值 $P_n$ 超过 1，则认为该模型产生了一个非物理的结果。确定阈值时间步长 $h_{crit}$，使得对于任何时间步长 $h  h_{crit}$，模型的第一次迭代结果 $P_1$ 都会超过 1。将你的答案 $h_{crit}$ 四舍五入到三位有效数字。", "solution": "我们使用给定的前向欧拉更新法则\n$$\nP_{n+1} = P_{n} + h\\,k\\,P_{n}\\left(1 - P_{n}\\right).\n$$\n对于第一步，即 $n=0$ 时，\n$$\nP_{1} = P_{0} + h\\,k\\,P_{0}\\left(1 - P_{0}\\right).\n$$\n如果 $P_{1}  1$，则会出现非物理的结果。由于 $k0$ 且 $P_{0}=0.30 \\in (0,1)$，这意味着 $P_{0}\\left(1-P_{0}\\right)  0$。因此 $P_{1}$ 是关于 $h$ 的严格递增函数，当 $P_{1}$ 恰好达到 $1$ 时的阈值 $h_{crit}$ 满足\n$$\nP_{1} = 1 \\quad \\Longrightarrow \\quad 1 = P_{0} + h_{crit}\\,k\\,P_{0}\\left(1 - P_{0}\\right).\n$$\n求解 $h_{crit}$，\n$$\n1 - P_{0} = h_{crit}\\,k\\,P_{0}\\left(1 - P_{0}\\right)\n\\quad \\Longrightarrow \\quad\nh_{crit} = \\frac{1 - P_{0}}{k\\,P_{0}\\left(1 - P_{0}\\right)} = \\frac{1}{k\\,P_{0}},\n$$\n这里我们利用 $1 - P_{0}  0$ 安全地进行了约分。\n\n代入 $P_{0} = 0.30$ 和 $k = 1.8$，\n$$\nh_{crit} = \\frac{1}{1.8 \\times 0.30} = \\frac{1}{0.54} \\approx 1.851851\\ldots\n$$\n四舍五入到三位有效数字，\n$$\nh_{crit} \\approx 1.85.\n$$\n对于任何 $h  h_{crit}$，我们都有 $P_{1}  1$。", "answer": "$$\\boxed{1.85}$$", "id": "1695616"}, {"introduction": "欧拉法是一阶方法，这意味着其全局误差与步长 $h$ 成正比。我们可以巧妙地利用这一特性来获得更高的精度。本练习将介绍一种强大的技术——理查森外推法 (Richardson extrapolation)，它通过组合两次不同步长的计算结果来消除主导误差项。通过这种方法，我们可以从两次一阶精度的计算中，构造出一个更精确的二阶精度估计值，这为我们改进数值解的准确性提供了一条有效途径。[@problem_id:1695655]", "problem": "一个电子元件的温度 $y(t)$（单位：摄氏度）遵循牛顿冷却定律建模。该元件将热量散发到一个环境中，该环境的温度在一个24小时周期内呈正弦波动。其控制常微分方程（ODE）为：\n$$ \\frac{dy}{dt} = -k \\left( y - T_{amb}(t) \\right) $$\n其中环境温度为 $T_{amb}(t) = T_0 + A \\sin(\\omega t)$。时间 $t$ 的单位是小时。\n\n系统参数如下：\n- 元件的初始温度：$y(0) = 100.0 \\, ^\\circ\\text{C}$\n- 冷却常数：$k = 0.5 \\, \\text{hr}^{-1}$\n- 平均环境温度：$T_0 = 20.0 \\, ^\\circ\\text{C}$\n- 温度变化幅度：$A = 10.0 \\, ^\\circ\\text{C}$\n- 振荡角频率：$\\omega = \\frac{\\pi}{12} \\, \\text{rad/hr}$\n\n您的任务是使用欧拉方法估计在时间 $t=4.0$ 小时时元件的温度。首先，使用步长 $h=2.0$ 小时计算一个估计值。其次，使用步长 $h/2=1.0$ 小时计算另一个估计值。\n\n欧拉方法是一种一阶方法，这意味着对于较小的 $h$，其在固定时间的全局截断误差近似与步长 $h$ 成正比。也就是说，如果 $Y(t)$ 是精确解，$y_h(t)$ 是步长为 $h$ 的数值估计值，那么对于某个依赖于常微分方程但不依赖于 $h$ 的常数 $C$，有 $Y(t) \\approx y_h(t) + C h$。\n\n使用您得到的两个关于 $y(4.0)$ 的数值估计值，消除这个主阶误差项，从而得到一个更精确的二阶温度估计值。将这个改进后的温度估计值的最终答案以摄氏度表示，并四舍五入到四位有效数字。", "solution": "给定常微分方程 $y^{\\prime}(t)=-k\\big(y(t)-T_{\\text{amb}}(t)\\big)$，其中 $T_{\\text{amb}}(t)=T_{0}+A\\sin(\\omega t)$，初始条件为 $y(0)=100$。定义 $f(t,y)=-k\\big(y-(T_{0}+A\\sin(\\omega t))\\big)$。步长为 $h$ 的显式欧拉方法的更新公式为\n$$\ny_{n+1}=y_{n}+h\\,f(t_{n},y_{n})=y_{n}-h\\,k\\left(y_{n}-\\big(T_{0}+A\\sin(\\omega t_{n})\\big)\\right),\\quad t_{n}=t_{0}+nh.\n$$\n\n首先，使用 $h=2$ 小时。到达 $t=4$ 的时间节点为 $t_{0}=0, t_{1}=2, t_{2}=4$。\n- 在 $t_{0}=0$ 时：$T_{\\text{amb}}(0)=T_{0}+A\\sin(0)=20+10\\cdot 0=20$。那么\n$$\nf(0,y_{0})=-k(y_{0}-T_{\\text{amb}}(0))=-0.5\\,(100-20)=-40,\n$$\n所以\n$$\ny_{1}=y_{0}+2\\,(-40)=100-80=20.\n$$\n- 在 $t_{1}=2$ 时：$T_{\\text{amb}}(2)=20+10\\sin\\!\\left(\\tfrac{\\pi}{12}\\cdot 2\\right)=20+10\\sin\\!\\left(\\tfrac{\\pi}{6}\\right)=20+10\\cdot \\tfrac{1}{2}=25$。那么\n$$\nf(2,y_{1})=-0.5\\,(20-25)=2.5,\n$$\n所以\n$$\ny_{2}=y_{1}+2\\,(2.5)=20+5=25.\n$$\n因此，当 $h=2$ 时，在 $t=4$ 时的估计值为 $y_{h}(4)=25$。\n\n其次，使用 $h/2=1$ 小时。时间节点为 $t=0,1,2,3,4$。我们在每个 $t_{n}$ 处计算 $T_{\\text{amb}}$ 的值：\n$$\nT_{\\text{amb}}(0)=20,\\quad T_{\\text{amb}}(1)=20+10\\sin\\!\\left(\\tfrac{\\pi}{12}\\right)\\approx 22.588190451025207,\n$$\n$$\nT_{\\text{amb}}(2)=20+10\\sin\\!\\left(\\tfrac{\\pi}{6}\\right)=25,\\quad T_{\\text{amb}}(3)=20+10\\sin\\!\\left(\\tfrac{\\pi}{4}\\right)\\approx 27.071067811865475.\n$$\n现在应用欧拉步进：\n- 从 $t=0$ 到 $t=1$，\n$$\nf(0,y_{0})=-0.5\\,(100-20)=-40,\\quad y_{1}=100+1\\,(-40)=60.\n$$\n- 从 $t=1$ 到 $t=2$，\n$$\nf(1,y_{1})=-0.5\\,(60-22.588190451025207)=-18.705904774487395,\n$$\n$$\ny_{2}=60-18.705904774487395=41.294095225512605.\n$$\n- 从 $t=2$ 到 $t=3$，\n$$\nf(2,y_{2})=-0.5\\,(41.294095225512605-25)=-8.1470476127563025,\n$$\n$$\ny_{3}=41.294095225512605-8.1470476127563025=33.1470476127563.\n$$\n- 从 $t=3$ 到 $t=4$，\n$$\nf(3,y_{3})=-0.5\\,(33.1470476127563-27.071067811865475)=-3.0379899004454136,\n$$\n$$\ny_{4}=33.1470476127563-3.0379899004454136=30.109057712310887.\n$$\n因此，当 $h/2=1$ 时，在 $t=4$ 时的估计值为 $y_{h/2}(4)\\approx 30.109057712310887$。\n\n给定一阶全局误差模型 $Y(4)\\approx y_{h}(4)+C\\,h$ 和 $Y(4)\\approx y_{h/2}(4)+C\\,\\tfrac{h}{2}$，消除主误差项可得到二阶理查森外推（Richardson extrapolation）\n$$\nY(4)\\approx 2\\,y_{h/2}(4)-y_{h}(4).\n$$\n代入计算出的值，\n$$\nY(4)\\approx 2\\cdot 30.109057712310887-25=35.218115424621774.\n$$\n四舍五入到四位有效数字得到 $35.22$。", "answer": "$$\\boxed{35.22}$$", "id": "1695655"}]}