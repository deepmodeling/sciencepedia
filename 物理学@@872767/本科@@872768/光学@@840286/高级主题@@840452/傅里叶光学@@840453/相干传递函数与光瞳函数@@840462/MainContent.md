## 引言
在现代光学领域，理解一个成像系统如何将物体的精细结构转化为图像至关重要。对于[相干成像](@entry_id:171640)系统——例如[激光](@entry_id:194225)扫描显微镜或[光刻](@entry_id:158096)投影系统——其性能的核心可以用两个紧密相连的概念来描述：**[光瞳函数](@entry_id:163876)**与**[相干传递函数](@entry_id:164879)（CTF）**。[光瞳函数](@entry_id:163876)是系统物理孔径的直接数学表达，而CTF则描述了系统传递不同空间频率信息的能力。然而，这两者之间的深刻联系往往被视为一个抽象的公式，其背后丰富的物理内涵和强大的工程应用价值有待深入挖掘。

本文旨在填补这一认知空白，系统地阐明[光瞳函数](@entry_id:163876)与CTF之间的基本恒等式，并揭示如何利用这一关系来分析、预测乃至主动设计光学系统的性能。通过本文的学习，您将掌握以下核心内容：

在“**原理与机制**”一章中，我们将推导并解释CTF为何是[光瞳函数](@entry_id:163876)的直接映射，并探讨这一关系如何决定系统的[分辨率极限](@entry_id:200378)、如何通过[像差](@entry_id:165808)来表述系统缺陷。随后，在“**应用与[交叉](@entry_id:147634)学科联系**”一章中，我们将展示光瞳工程如何在[空间滤波](@entry_id:202429)、[相衬](@entry_id:157707)显微镜、[半导体](@entry_id:141536)[光刻](@entry_id:158096)等前沿领域中发挥关键作用，将理论与实际应用紧密结合。最后，通过一系列“**动手实践**”的计算练习，您将有机会亲手应用所学知识，巩固对这些核心概念的理解。

## 原理与机制

在[相干成像](@entry_id:171640)领域，光学系统的性能由其将物体的细节传递到像平面的能力来表征。这一过程的核心是两个相互关联的概念：**[光瞳函数](@entry_id:163876) (Pupil Function)** 和 **[相干传递函数](@entry_id:164879) (Coherent Transfer Function, CTF)**。[光瞳函数](@entry_id:163876)是系统物理结构的直接数学描述，而[相干传递函数](@entry_id:164879)则描述了系统在空间频率域中的行为。本章旨在阐明这两个函数之间的基本关系，并探讨如何利用这种关系来分析和设计高性能成像系统。

### [光瞳函数](@entry_id:163876)与[相干传递函数](@entry_id:164879)：一个基本恒等式

我们可以将一个成像系统视为一个对输入光场进行操作的“黑箱”。为了理解这个黑箱的功能，我们需要描述其内部的关键组件，即光阑（aperture stop）。在光学系统中，限制成像光束[孔径](@entry_id:172936)的光阑被称为[孔径光阑](@entry_id:173170)。从像空间观察这个[孔径光阑](@entry_id:173170)所成的像，称为**[出射光瞳](@entry_id:167465) (exit pupil)**。[出射光瞳](@entry_id:167465)是理解系统如何与光相互作用的窗口。

**[光瞳函数](@entry_id:163876)**，记作 $P(x_p, y_p)$，是对[出射光瞳](@entry_id:167465)[复振幅](@entry_id:164138)透过率的数学描述，其中 $(x_p, y_p)$ 是[出射光瞳](@entry_id:167465)平面内的空间坐标。这是一个复数函数，其**振幅**部分描述了光波通过光瞳时振幅的衰减（例如，由于渐晕或专门设计的振幅滤波器），其**相位**部分则描述了光波通过光瞳时发生的相位变化（例如，由于透镜厚度不均或像差）。对于一个理想的、无像差且无吸收的系统，其[光瞳函数](@entry_id:163876)在光瞳的透光区域内为1，在外部为0。

当一个理想点光源（物）由系统成像时，在像平面上形成的光场振幅[分布](@entry_id:182848)被称为**振幅[点扩散函数](@entry_id:183154) (Amplitude Point Spread Function, PSF)**，记作 $h(x_i, y_i)$。PSF 是系统的空间域响应，它表征了系统将一个无限小的点“模糊”成一个衍射图样的程度。根据[傅里叶光学](@entry_id:192627)理论，PSF 是[光瞳函数](@entry_id:163876)的[傅里叶变换](@entry_id:142120)：

$h(x_i, y_i) \propto \mathcal{F}\{P(x_p, y_p)\}|_{f_x \to x_i/(\lambda d_i), f_y \to y_i/(\lambda d_i)}$

其中 $\lambda$ 是光的波长，$d_i$ 是从[出射光瞳](@entry_id:167465)到像平面的距离。

另一方面，**[相干传递函数](@entry_id:164879) (CTF)**，记作 $H(f_x, f_y)$，是系统的频率域响应。在一个[线性系统](@entry_id:147850)里，任何物体都可以分解为一系列不同空间频率 $(f_x, f_y)$ 的正弦分量。CTF 描述了系统对这些频率分量的传递效率。具体来说，像的[频谱](@entry_id:265125) $U_i(f_x, f_y)$ 是物体的[频谱](@entry_id:265125) $U_o(f_x, f_y)$ 与 CTF 的乘积：

$U_i(f_x, f_y) = H(f_x, f_y) U_o(f_x, f_y)$

CTF 本身是振幅[点扩散函数](@entry_id:183154) (PSF) 的[傅里叶变换](@entry_id:142120)。例如，如果一个一维系统的PSF是一个底边半宽为 $w$ 的三角形函数 $h(x) = A(1-|x|/w)$，那么其CTF就是该函数的[傅里叶变换](@entry_id:142120)，结果为一个[sinc平方函数](@entry_id:270853)：$H(f_x) = A w \left( \frac{\sin(\pi w f_x)}{\pi w f_x} \right)^2$。

综合以上关系，我们得到一个至关重要的结论：CTF 与[光瞳函数](@entry_id:163876)之间存在直接的代数关系。由于 PSF 是[光瞳函数](@entry_id:163876)的[傅里叶变换](@entry_id:142120)，而 CTF 又是 PSF 的[傅里叶变换](@entry_id:142120)，根据[傅里叶变换的性质](@entry_id:265641)，CTF 本身就是[光瞳函数](@entry_id:163876)的一个缩放和可能的反转版本。对于大多数中心对称的光学系统，该关系可以简化为一个优美的恒等式：

$H(f_x, f_y) = P(\lambda d_i f_x, \lambda d_i f_y)$

这个表达式揭示了一个深刻的物理事实：**[相干成像](@entry_id:171640)系统的频率[通带](@entry_id:276907)就是其光瞳的直接映射**。系统能够传递哪些空间频率分量，完全由其光瞳的形状、大小和位置决定。

这个基本恒等式是分析[相干成像](@entry_id:171640)系统的基石。例如，考虑一个光瞳由两个关于[原点对称](@entry_id:172995)的小孔构成的系统，其[光瞳函数](@entry_id:163876)可表示为两个狄拉克 $\delta$ 函数之和：$P(x,y)=\delta(x-d/2)\delta(y)+\delta(x+d/2)\delta(y)$。根据上述恒等式，其CTF也将由两个 $\delta$ 函数构成，位于特定的[空间频率](@entry_id:270500)上 [@problem_id:2259590]。这意味着该系统像一个[带通滤波器](@entry_id:271673)，只允许特定频率的物体信息通过。同样，如果一个矩形光瞳在光瞳平面内发生位移，那么其CTF，即频率通带，也会相应地在频率域中移动 [@problem_id:2259614]。

值得注意的是，[相干传递函数](@entry_id:164879) (CTF) 不应与用于[非相干成像](@entry_id:178214)的**[光学传递函数](@entry_id:172898) (Optical Transfer Function, OTF)** 相混淆。OTF 描述的是强度（而非振幅）的传递，其定义为[光瞳函数](@entry_id:163876)的归一化[自相关](@entry_id:138991)。尽管两者在数学上相关，但它们描述的是完全不同的物理过程，适用于不同的照明条件。

### 光瞳：系统性能的蓝图

[光瞳函数](@entry_id:163876) $P(x_p, y_p)$ 不仅仅是一个数学抽象，它是成像系统所有关键性能特征的物理蓝图。通过修改光瞳的振幅或相位，我们可以主动地调控系统的分辨率、对比度和像差。

#### 光瞳尺寸与[分辨率极限](@entry_id:200378)

[光瞳函数](@entry_id:163876)的有限尺寸是[成像系统分辨率](@entry_id:162598)存在极限的根本原因。由于 $H(f_x, f_y) = P(\lambda d_i f_x, \lambda d_i f_y)$，光瞳的边界直接对应于CTF的边界。任何落在光瞳映射区域之外的空间频率都将被系统完全阻断，其值为 $H(f_x, f_y) = 0$。

系统所能传递的最大[空间频率](@entry_id:270500)被称为**相干[截止频率](@entry_id:276383) (coherent cutoff frequency)**，记作 $f_c$。对于一个半径为 $a$ 的圆形光瞳，其CTF也是一个圆形区域。CTF为非零的条件是 $(\lambda d_i f_x)^2 + (\lambda d_i f_y)^2 \le a^2$。由此可得，径向空间频率 $\sqrt{f_x^2+f_y^2}$ 的最大值是 [@problem_id:2259621]：

$f_c = \frac{a}{\lambda d_i}$

在光学设计中，我们通常使用**数值孔径 (Numerical Aperture, NA)** 来表征[物镜](@entry_id:167334)收集光的能力，其定义为 $NA = n \sin\theta_{\max}$，其中 $n$ 是物方介质的[折射率](@entry_id:168910)，$\theta_{\max}$ 是[物镜](@entry_id:167334)能接收的最大光线锥角。对于一个充满光瞳的系统，可以证明 $NA \approx a/d_i$（在像方介质[折射率](@entry_id:168910)为1的简化情况下）。因此，截止频率可以更普遍地表达为：

$f_c = \frac{NA}{\lambda}$

这个简洁而强大的公式表明，要提高[相干成像](@entry_id:171640)系统的分辨率（即提高 $f_c$），只有两种途径：使用更短波长的光（减小 $\lambda$），或者使用具有更大[数值孔径](@entry_id:138876)的物镜（增大 $NA$）。例如，一台使用波长 $\lambda = 488 \, \text{nm}$ [激光](@entry_id:194225)、物镜数值孔径 $NA = 1.25$ 的显微镜，其理论最高可分辨的空间频率为 $f_{c} = 1.25 / (488 \times 10^{-6} \, \text{mm}) \approx 2.56 \times 10^3 \, \text{cycles/mm}$ [@problem_id:2259612]。

#### 光瞳振幅调制：[切趾](@entry_id:147798)

除了硬边光阑，我们还可以在光瞳平面上有意地引入不均匀的振幅透过率，这一技术称为**[切趾](@entry_id:147798) (apodization)**。其主要目的是抑制[点扩散函数](@entry_id:183154) (PSF) 的[旁瓣](@entry_id:270334)（即衍射环）。虽然这通常会以轻微牺牲中心斑锐度为代价，但对于需要高动态范围成像的应用至关重要。

一个典型的[切趾](@entry_id:147798)函数是[高斯函数](@entry_id:261394)。假设[光瞳函数](@entry_id:163876)为一个高斯分布 $P(x, y) = A \exp(-(x^2 + y^2)/w^2)$ [@problem_id:2259606]。根据CTF与光瞳的恒等关系，其CTF也将是一个[高斯函数](@entry_id:261394)。这意味着[频率响应](@entry_id:183149)没有一个硬性的[截止频率](@entry_id:276383)，而是平滑地衰减为零。这样的系统对于抑制由物体[频谱](@entry_id:265125)中的高频成分截断而引起的[振铃效应](@entry_id:147177)特别有效。

#### 光瞳[相位调制](@entry_id:262420)：[像差](@entry_id:165808)与相位工程

[光瞳函数](@entry_id:163876)的相位部分对于成像质量的影响甚至比振幅更为关键。一个理想的、无像差的系统，其[光瞳函数](@entry_id:163876)在整个光瞳区域内应具有恒定的相位，对应于一个汇聚向理想像点的完美[球面波](@entry_id:200471)。任何偏离恒定相位的变化都构成**[波前像差](@entry_id:171755)**。

最简单的[像差](@entry_id:165808)是**[线性相位](@entry_id:274637)斜坡**，这对应于波前的倾斜。例如，在光瞳中放置一个薄玻璃楔，其厚度随坐标 $u$ 线性变化 $T(u) = T_0 + \alpha u$。这会引入一个线性变化的相位因子 $\exp(i k (n-1) \alpha u)$ [@problem_id:2259620]。根据[傅里叶变换](@entry_id:142120)的位移定理，在光瞳（频率）域引入一个[线性相位](@entry_id:274637)，会导致[点扩散函数](@entry_id:183154) (PSF) 在像（空间）域中发生平移。平移的距离为 $x_c = z_i (n-1) \alpha$，其中 $z_i$ 是像距，$(n-1)\alpha$ 是楔形板引起的[光线偏折](@entry_id:269868)角。

更常见的像差是**二次[相位误差](@entry_id:162993)**，它代表**离焦 (defocus)**。当像面没有精确地放在焦平面上时，就会产生这种[像差](@entry_id:165808)，其[光瞳函数](@entry_id:163876)包含一个二次相位项 $\exp(i \alpha x_p^2)$ [@problem_id:2259604]。对于[相干传递函数](@entry_id:164879)CTF而言，这个相位项仅给CTF增加了一个相位因子，并未改变其振幅大小。然而，它会严重影响PSF，使其展宽并降低峰值强度。这种效应在与波长相关的[像差](@entry_id:165808)中尤为明显，如**[纵向色差](@entry_id:174616)**，其中不同波长的光具有不同的[焦距](@entry_id:164489)。这可以建模为一个依赖于波长的二次[相位误差](@entry_id:162993)，导致在宽[光谱](@entry_id:185632)照明下图像模糊 [@problem_id:2259601]。

高阶[像差](@entry_id:165808)，如**[球差](@entry_id:174580)**（$\rho^4$ 项，其中 $\rho$ 是归一化光瞳半径），也是常见的。在[镜头设计](@entry_id:174168)中，一个重要的策略是**[像差平衡](@entry_id:183778)**。例如，通过引入少量的离焦（$\rho^2$ 项）来补偿[球差](@entry_id:174580)，可以最小化整个光瞳上的[波前误差](@entry_id:184739)[方差](@entry_id:200758)，从而改善成像质量。对于由 $W(\rho) = C(\rho^4 + d\rho^2)$ 描述的[波前](@entry_id:197956)，通过选择离焦系数 $d=-1$，可以实现对球差的最佳平衡，这对应于将像面移动到所谓的“[最小弥散圆](@entry_id:171505)”位置 [@problem_id:2259618]。

然而，并非所有的相位变化都是有害的。**相位工程**利用精确控制的光瞳相位来实现特殊功能。一个典型的例子是[相衬](@entry_id:157707)显微镜中使用的Zernike[相板](@entry_id:171849)。通过在光瞳的一个半区引入 $\pi$ 弧度的相移，可以使原本不可见的纯[相位物体](@entry_id:201461)（如活体细胞）的相位变化转化为可见的强度变化 [@problem_id:2259578]。

### 打破常规：空间变化系统

我们迄今为止的讨论都基于一个核心假设：系统是**线性移不变 (Linear Shift-Invariant, LSI)** 的。这意味着[点扩散函数](@entry_id:183154) (PSF) 的形状与点光源在视场中的位置无关。因此，一个单一的CTF就足以表征整个系统的性能。

然而，在真实世界的光学系统中，这个假设常常被打破。一个常见的例子是**渐晕 (vignetting)**，即离轴[视场](@entry_id:175690)点的[图像亮度](@entry_id:175275)低于中心视场点的现象。这是由于离轴物点的光束被系统内的多个光阑（如透镜边框）部分遮挡所致。

我们可以通过让[光瞳函数](@entry_id:163876)依赖于物点坐标 $x_o$ 来对此类空间变化系统建模 [@problem_id:2259577]。例如，一个遭受渐晕的一维系统，其光瞳宽度可能随离轴距离 $|x_o|$ 减小：$W(x_o) = W_0(1 - \alpha |x_o|)$。由于CTF是光瞳的直接映射，CTF也变得依赖于场点位置：$H(\nu; x_o)$。其[截止频率](@entry_id:276383)也随之变化：

$\nu_c(x_o) = \frac{W(x_o)}{2\lambda f} = \frac{W_0(1-\alpha|x_o|)}{2\lambda f}$

对于离轴距离为 $d$ 的点，其分辨率与在轴点分辨率之比为 $1-\alpha d$。这明确表明，离轴[视场](@entry_id:175690)点的分辨率低于中心。对于这类空间变化系统，单一的CTF不再能描述整个系统的性能，必须为[视场](@entry_id:175690)中的每个点都定义一个局部的[传递函数](@entry_id:273897)。

总之，[光瞳函数](@entry_id:163876)是连接光学系统物理结构和其最终成像性能的核心纽带。通过理解并操控光瞳[函数的振幅](@entry_id:160674)和相位，光学工程师可以精确地控制[相干传递函数](@entry_id:164879)，从而优化分辨率、抑制像差，并实现从高分辨率光刻到生物显微成像等各种应用的特定成像目标。