{"hands_on_practices": [{"introduction": "点扩散函数（PSF）最核心的作用是描述一个光学系统如何模糊一个理想的点光源。对于任何物体，其最终图像都是物体真实亮度分布与系统PSF的卷积。本练习通过一个具体的一维例子来实践这一原理，计算一个双星系统的成像结果，帮助我们直观理解模糊效应对分辨细节能力的影响。[@problem_id:2264542]", "problem": "一个用于天文观测的一维成像系统，对准一个遥远的双星系统。这两颗恒星亮度相同且间距很近。物体的空间强度分布 $o(x)$ 可以建模为两个点源之和，每个点源发射的总功率（通量）为 $F_0$。这两颗恒星位于 $x = -d/2$ 和 $x = +d/2$ 的位置。因此，物体分布由 $o(x) = F_0 \\left[ \\delta(x + d/2) + \\delta(x - d/2) \\right]$ 给出，其中 $\\delta(x)$ 是狄拉克δ函数。\n\n由于光学系统的不完美，成像系统会使点源变得模糊。这种模糊由系统的一维点扩散函数 (PSF) $h(x)$ 来表征。PSF被归一化，使其总面积为1，以确保探测到的总功率等于发射的总功率。该系统PSF的具体形式是一个三角函数：\n$$\nh(x) = \\begin{cases} \\frac{1}{W} \\left(1 - \\frac{|x|}{W}\\right)  \\text{for } |x| \\le W \\\\ 0  \\text{for } |x| > W \\end{cases}\n$$\n其中 $W$ 是一个表示模糊范围的参数。最终的图像强度分布 $i(x)$ 是物体分布与PSF的卷积。\n\n给定以下参数：\n- 每颗恒星的总通量，$F_0 = 1.00 \\times 10^{-7}$ W\n- 恒星之间的间距，$d = 6.00$ 微米\n- PSF宽度参数，$W = 10.0$ 微米\n\n计算在两个恒星像的几何中心之间的中点（即 $x=0$ 处）生成的图像的强度。答案以 W/m 为单位表示，并四舍五入到三位有效数字。", "solution": "物体的一维强度分布为 $o(x) = F_{0}\\left[\\delta(x+d/2)+\\delta(x-d/2)\\right]$。图像强度是 $o(x)$ 与PSF $h(x)$ 的卷积：\n$$\ni(x) = \\int_{-\\infty}^{\\infty} o(\\xi)\\,h(x-\\xi)\\,d\\xi.\n$$\n利用狄拉克δ函数的筛选性质和卷积的线性性质，\n$$\ni(x) = F_{0}\\left[h\\left(x+\\frac{d}{2}\\right) + h\\left(x-\\frac{d}{2}\\right)\\right].\n$$\n在中点 $x=0$ 处，\n$$\ni(0) = F_{0}\\left[h\\left(\\frac{d}{2}\\right) + h\\left(-\\frac{d}{2}\\right)\\right] = 2F_{0}\\,h\\left(\\frac{d}{2}\\right),\n$$\n因为 $h(x)$ 是偶函数。PSF为\n$$\nh(x) = \\begin{cases}\n\\frac{1}{W}\\left(1-\\frac{|x|}{W}\\right),  |x|\\leq W,\\\\\n0,  |x|>W,\n\\end{cases}\n$$\n并且由于 $d/2 \\le W$，我们有\n$$\nh\\left(\\frac{d}{2}\\right) = \\frac{1}{W}\\left(1-\\frac{d}{2W}\\right).\n$$\n因此，\n$$\ni(0) = 2F_{0}\\,\\frac{1}{W}\\left(1-\\frac{d}{2W}\\right) = \\frac{2F_{0}}{W} - \\frac{F_{0}d}{W^{2}}.\n$$\n将给定值代入，并将单位转换为米：$F_{0} = 1.00\\times 10^{-7}\\ \\text{W}$，$d = 6.00\\times 10^{-6}\\ \\text{m}$，$W = 1.00\\times 10^{-5}\\ \\text{m}$：\n$$\n\\frac{2F_{0}}{W} = \\frac{2\\times 1.00\\times 10^{-7}}{1.00\\times 10^{-5}} = 2.00\\times 10^{-2}\\ \\text{W/m},\n$$\n$$\n\\frac{F_{0}d}{W^{2}} = \\frac{1.00\\times 10^{-7}\\times 6.00\\times 10^{-6}}{\\left(1.00\\times 10^{-5}\\right)^{2}} = 6.00\\times 10^{-3}\\ \\text{W/m}.\n$$\n因此，\n$$\ni(0) = 2.00\\times 10^{-2} - 6.00\\times 10^{-3} = 1.40\\times 10^{-2}\\ \\text{W/m}.\n$$\n四舍五入到三位有效数字，在 $x=0$ 处的强度为 $1.40\\times 10^{-2}$ W/m。", "answer": "$$\\boxed{1.40 \\times 10^{-2}}$$", "id": "2264542"}, {"introduction": "理解了如何*使用*PSF，我们更进一步，探索如何*设计*PSF。PSF的形态并非任意，它是由光通过系统光瞳（aperture）时发生衍射的直接结果。关键在于傅里叶变换关系：光瞳的形状决定了PSF的形状。本练习将探讨这种反比关系，展示改变光瞳尺寸如何影响PSF的拉伸，这是为特定任务设计光学系统时的关键概念。[@problem_id:2264538]", "problem": "在一个理想的、无像差的光学成像系统中，来自单个点光源的光在像平面上的分布由点扩展函数（PSF）描述。PSF由光从系统出射光瞳发生的衍射决定。光瞳的透射函数 $P(x_p, y_p)$ 与焦平面上光的复振幅 $U(x_f, y_f)$ 之间的关系由一个二维傅里叶变换给出。对于开放孔径内的坐标 $(x_p, y_p)$，光瞳函数 $P(x_p, y_p)$ 等于1，否则为0。PSF是该复振幅的模的平方：$\\text{PSF}(x_f, y_f) = |U(x_f, y_f)|^2$。\n\n考虑这样一个系统的光瞳形状。下列哪种光瞳形状会产生一个中心亮斑区域沿水平轴（$x_f$轴）明显拉长，而沿垂直轴（$y_f$轴）被压缩的PSF？\n\nA. 半径为 $R$ 的圆形光瞳。\n\nB. 边长为 $L$ 的方形光瞳。\n\nC. 水平宽度为 $W$，垂直高度为 $2W$ 的矩形光瞳。\n\nD. 水平宽度为 $2W$，垂直高度为 $W$ 的矩形光瞳。\n\nE. 等边三角形光瞳。", "solution": "夫琅禾费衍射原理指出，焦平面上的复振幅与光瞳透射函数的傅里叶变换成正比。使用焦距 $f$ 和波长 $\\lambda$，标量衍射积分给出\n$$\nU(x_{f},y_{f}) \\propto \\iint P(x_{p},y_{p}) \\exp\\!\\left(-i 2\\pi \\frac{x_{p}x_{f}+y_{p}y_{f}}{\\lambda f}\\right)\\,dx_{p}\\,dy_{p}.\n$$\n点扩展函数是光强\n$$\n\\text{PSF}(x_{f},y_{f}) = |U(x_{f},y_{f})|^{2}.\n$$\n\n对于可分离的矩形光瞳，设水平宽度为 $a$，垂直高度为 $b$。将光瞳写为 $P(x_{p},y_{p}) = \\Pi(x_{p}/a)\\,\\Pi(y_{p}/b)$，其中 $\\Pi$ 是单位矩形函数。傅里叶变换可以因式分解，得到\n$$\nU(x_{f},y_{f}) \\propto \\operatorname{sinc}\\!\\left(\\frac{a\\,x_{f}}{\\lambda f}\\right)\\,\\operatorname{sinc}\\!\\left(\\frac{b\\,y_{f}}{\\lambda f}\\right),\n$$\n其中 $\\operatorname{sinc}(\\xi) = \\frac{\\sin(\\pi \\xi)}{\\pi \\xi}$。主瓣的第一零点出现在\n$$\n\\frac{a\\,x_{f}}{\\lambda f} = \\pm 1 \\quad\\Rightarrow\\quad |x_{f}|=\\frac{\\lambda f}{a}, \n\\qquad\n\\frac{b\\,y_{f}}{\\lambda f} = \\pm 1 \\quad\\Rightarrow\\quad |y_{f}|=\\frac{\\lambda f}{b}.\n$$\n因此，中心瓣沿 $x_{f}$ 的宽度与 $\\lambda f/a$ 成正比，沿 $y_{f}$ 的宽度与 $\\lambda f/b$ 成正比。因此：\n- 在给定的光瞳坐标上，较大的光瞳范围会在相应的焦平面坐标上产生更窄的主瓣。\n- 较小的光瞳范围会产生更宽的主瓣。\n\n将此应用于各个选项：\n\nA. 半径为 $R$ 的圆形光瞳。其振幅为 $U \\propto \\frac{J_{1}(kR\\rho)}{kR\\rho}$，其中 $k=2\\pi/\\lambda$ 且 $\\rho=\\sqrt{x_{f}^{2}+y_{f}^{2}}/f$，形成一个各向同性的艾里斑。中心亮斑区域是圆形的，不是拉长的。\n\nB. 边长为 $L$ 的方形光瞳。这是矩形光瞳 $a=b=L$ 的一个特例，因此沿 $x_{f}$ 和 $y_{f}$ 的主瓣宽度相等。没有拉长。\n\nC. 水平宽度为 $W$，垂直高度为 $2W$ 的矩形光瞳。这里 $a=W$ 且 $b=2W$，所以主瓣宽度沿 $x_{f}$ 为 $\\lambda f/W$，沿 $y_{f}$ 为 $\\lambda f/(2W)$。因此，中心亮斑区域沿 $x_{f}$ 更宽，沿 $y_{f}$ 更窄，即水平拉长、垂直压缩，符合要求。\n\nD. 水平宽度为 $2W$，垂直高度为 $W$ 的矩形光瞳。这里 $a=2W$ 且 $b=W$，产生的宽度水平方向为 $\\lambda f/(2W)$，垂直方向为 $\\lambda f/W$。这会产生相反的效果：水平压缩、垂直拉长。\n\nE. 等边三角形光瞳。其傅里叶变换表现出三重旋转对称性；中心瓣没有像描述的那样特定地沿水平轴拉长并沿垂直轴压缩。它不符合所述的拉长情况。\n\n因此，只有选项C能产生中心亮斑区域沿 $x_{f}$ 拉长、沿 $y_{f}$ 压缩的PSF。", "answer": "$$\\boxed{C}$$", "id": "2264538"}, {"introduction": "现实世界中的成像系统由多个组件（如透镜、传感器等）构成，每个组件都会对整体的模糊产生影响。我们如何确定整个系统的PSF？对于串联的系统，总PSF是各个组件PSF的卷积。本练习通过组合一个透镜和一个传感器的两个高斯型PSF来演示这一原理，其结果揭示了一个强大而实用的结论：模糊效应的方差是会累加的。[@problem_id:2264567]", "problem": "一位光学工程师正在对一个新的数字成像系统进行特性分析。该系统可以建模为两个串联的独立光学子系统：一个主透镜和一个数字传感器阵列。对于一个线性空间不变的成像系统，形成的图像 $I(x, y)$ 是真实物体亮度分布 $O(x, y)$ 与系统的点扩展函数（PSF） $h(x, y)$ 的二维卷积。PSF代表了系统对一个理想化的点光源的响应。\n\n每个子系统的模糊效应由其自身的PSF来描述。假设两个子系统都引入了圆形对称的高斯模糊。\n\n主透镜的PSF，$h_L(x, y)$，由下式给出：\n$$h_L(x, y) = \\frac{1}{2\\pi \\sigma_L^2} \\exp\\left(-\\frac{x^2+y^2}{2\\sigma_L^2}\\right)$$\n其中 $\\sigma_L$ 是表征透镜模糊的标准差。\n\n数字传感器的内在PSF，$h_S(x, y)$，它考虑了诸如像素间电荷扩散等效应，由下式给出：\n$$h_S(x, y) = \\frac{1}{2\\pi \\sigma_S^2} \\exp\\left(-\\frac{x^2+y^2}{2\\sigma_S^2}\\right)$$\n其中 $\\sigma_S$ 是表征传感器模糊的标准差。\n\n当这两个子系统串联组合时，整个成像系统的总PSF，$h_{total}(x, y)$，是它们各自PSF的卷积。请确定总PSF，$h_{total}(x, y)$，关于 $x$、$y$、$\\sigma_L$ 和 $\\sigma_S$ 的解析表达式。", "solution": "对于线性空间不变系统，总PSF是各个PSF的卷积：\n$$\nh_{total}(x,y) = \\iint_{-\\infty}^{\\infty} h_{L}(x-u,y-v)\\,h_{S}(u,v)\\, \\mathrm{d}u\\,\\mathrm{d}v.\n$$\n每个PSF都是圆形对称的高斯函数：\n$$\nh_{L}(x,y) = \\frac{1}{2\\pi \\sigma_{L}^{2}} \\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2\\sigma_{L}^{2}}\\right), \\quad\nh_{S}(x,y) = \\frac{1}{2\\pi \\sigma_{S}^{2}} \\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2\\sigma_{S}^{2}}\\right).\n$$\n它们在 $x$ 和 $y$ 上是可分的，因为\n$$\nh_{L}(x,y) = \\left[\\frac{1}{\\sqrt{2\\pi}\\sigma_{L}} \\exp\\!\\left(-\\frac{x^{2}}{2\\sigma_{L}^{2}}\\right)\\right]\\left[\\frac{1}{\\sqrt{2\\pi}\\sigma_{L}} \\exp\\!\\left(-\\frac{y^{2}}{2\\sigma_{L}^{2}}\\right)\\right],\n$$\n对于 $h_{S}(x,y)$ 和 $\\sigma_{S}$ 也是类似的。因此，二维卷积可以分解为 $x$ 和 $y$ 方向上两个一维卷积的乘积。考虑 $x$ 分量：\n$$\nI_{x}(x) = \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi}\\sigma_{L}} \\exp\\!\\left(-\\frac{(x-u)^{2}}{2\\sigma_{L}^{2}}\\right)\\,\\frac{1}{\\sqrt{2\\pi}\\sigma_{S}} \\exp\\!\\left(-\\frac{u^{2}}{2\\sigma_{S}^{2}}\\right)\\,\\mathrm{d}u.\n$$\n合并指数部分：\n$$\n-\\frac{(x-u)^{2}}{2\\sigma_{L}^{2}}-\\frac{u^{2}}{2\\sigma_{S}^{2}}=-\\frac{x^{2}}{2\\sigma_{L}^{2}}+\\frac{x}{\\sigma_{L}^{2}}u-\\frac{1}{2}\\left(\\frac{1}{\\sigma_{L}^{2}}+\\frac{1}{\\sigma_{S}^{2}}\\right)u^{2}.\n$$\n定义 $a=\\frac{1}{2}\\left(\\frac{1}{\\sigma_{L}^{2}}+\\frac{1}{\\sigma_{S}^{2}}\\right)$ 和 $b=\\frac{x}{\\sigma_{L}^{2}}$。配方法得到\n$$\n-\\!a u^{2}+b u-\\frac{x^{2}}{2\\sigma_{L}^{2}}=-a\\left(u-\\frac{b}{2a}\\right)^{2}+a\\left(\\frac{b}{2a}\\right)^{2}-\\frac{x^{2}}{2\\sigma_{L}^{2}}.\n$$\n使用 $2a=\\frac{1}{\\sigma_{L}^{2}}+\\frac{1}{\\sigma_{S}^{2}}=\\frac{\\sigma_{L}^{2}+\\sigma_{S}^{2}}{\\sigma_{L}^{2}\\sigma_{S}^{2}}$ 和 $b=\\frac{x}{\\sigma_{L}^{2}}$，我们有\n$$\n\\frac{b}{2a}=\\frac{x\\sigma_{S}^{2}}{\\sigma_{L}^{2}+\\sigma_{S}^{2}}, \\quad a\\left(\\frac{b}{2a}\\right)^{2}-\\frac{x^{2}}{2\\sigma_{L}^{2}}=-\\frac{x^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}.\n$$\n因此\n$$\nI_{x}(x)=\\frac{1}{2\\pi \\sigma_{L}\\sigma_{S}}\\exp\\!\\left(-\\frac{x^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right)\\int_{-\\infty}^{\\infty}\\exp\\!\\left(-a\\left(u-\\frac{b}{2a}\\right)^{2}\\right)\\mathrm{d}u.\n$$\n使用高斯积分 $\\int_{-\\infty}^{\\infty}\\exp(-a(u-\\mu)^{2})\\,\\mathrm{d}u=\\sqrt{\\pi/a}$ （对于 $a>0$）以及 $a=\\frac{\\sigma_{L}^{2}+\\sigma_{S}^{2}}{2\\sigma_{L}^{2}\\sigma_{S}^{2}}$，我们得到\n$$\nI_{x}(x)=\\frac{1}{2\\pi \\sigma_{L}\\sigma_{S}}\\sqrt{\\frac{\\pi}{a}}\\exp\\!\\left(-\\frac{x^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right)=\\frac{1}{\\sqrt{2\\pi}\\sqrt{\\sigma_{L}^{2}+\\sigma_{S}^{2}}}\\exp\\!\\left(-\\frac{x^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right).\n$$\n对 $y$ 进行同样的计算，我们得到\n$$\nI_{y}(y)=\\frac{1}{\\sqrt{2\\pi}\\sqrt{\\sigma_{L}^{2}+\\sigma_{S}^{2}}}\\exp\\!\\left(-\\frac{y^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right).\n$$\n因此，将独立的 $x$ 和 $y$ 的结果相乘，总PSF为\n$$\nh_{total}(x,y)=I_{x}(x)\\,I_{y}(y)=\\frac{1}{2\\pi(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right).\n$$\n这是一个圆形对称的高斯函数，其方差等于各个方差之和，这与独立高斯模糊卷积的预期结果一致。", "answer": "$$\\boxed{\\frac{1}{2\\pi\\left(\\sigma_{L}^{2}+\\sigma_{S}^{2}\\right)}\\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2\\left(\\sigma_{L}^{2}+\\sigma_{S}^{2}\\right)}\\right)}$$", "id": "2264567"}]}