{"hands_on_practices": [{"introduction": "要完全掌握Ewald求和法，我们不仅需要理解如何将缓收敛的晶格求和分解为实空间和倒易空间中两个迅速收敛的级数，还必须掌握其中引入的修正项。这个练习 [@problem_id:97840] 旨在剖析Ewald方法中的两个关键组成部分：自能项和背景电荷产生的常数电势项。通过在一个具体的物理模型（类氯化铯晶体结构）中单独计算这些项，我们可以更深刻地理解它们为何是必要的，以及它们在整个计算中的作用。", "problem": "在固态物理学中，Ewald求和方法是一种用于计算周期性体系中长程静电势的强大技术。该方法将缓慢收敛的晶格求和分解为两个快速收敛的部分：一个在实空间中的求和，另一个在倒易空间中的求和。这个过程引入了修正项，以避免重复计算并处理自相互作用赝象。\n\n考虑一个晶体结构，它由一个体积为 $\\Omega$ 的电中性晶胞描述，其中包含位于位置 $\\mathbf{r}_j$、带有电荷 $q_j$ 的离子。某个特定离子位置上的总静电势可以分解为几个组成部分。你的任务是，对于一个特定的晶格，在位于原点的离子位置上，计算其中两个分量的和。\n\n该晶体具有一个边长为 $a$ 的立方晶胞。它包含两个离子：一个带电荷 $+q$ 位于原点 $\\mathbf{r}_1 = (0,0,0)$，另一个带电荷 $-q$ 位于体心 $\\mathbf{r}_2 = (a/2, a/2, a/2)$。\n\n计算位于原点（$\\mathbf{r}_1$）的离子位置上以下两个势能贡献之和：\n\n1.  **自势能项 ($V_{self}$):** 该项用于修正一个离子的点电荷与其自身的屏蔽高斯电荷云之间的相互作用，这是Ewald方法引入的一种赝象。该项对势的贡献来自每个离子自身的屏蔽高斯电荷云（电荷为 $-q$，分布为 $\\rho_s(\\mathbf{r}) = -q (\\eta/\\pi)^{3/2} \\exp(-\\eta r^2)$）。这个屏蔽云在其中心处产生的势由 $V_{self} = -\\frac{q \\sqrt{\\eta}}{2\\epsilon_0\\pi^{3/2}}$ 给出。此处，$q$ 是目标位置上离子的电荷，$\\eta$ 是Ewald收敛参数，$\\epsilon_0$ 是真空介电常数。\n\n2.  **恒定势能偏移 ($V_{offset}$):** 该项表示在倒易空间求和中使用的电荷分布的光滑部分所产生的平均势。对于真空中的周期性体系，该势能在整个晶胞中是恒定的，并由公式 $V_{offset} = -\\frac{1}{6\\epsilon_0 \\Omega} \\sum_{j \\in \\text{cell}} q_j |\\mathbf{r}_j|^2$ 给出。该求和是对一个晶胞内所有离子进行的。\n\n请以单个符号表达式的形式给出总势能 $V_{total} = V_{self} + V_{offset}$。", "solution": "位于原点 $\\mathbf{r}_1 = (0,0,0)$ 的离子位置处的静电势是自势能项和恒定势能偏移之和：\n\n$$\nV_{\\text{total}} = V_{\\text{self}} + V_{\\text{offset}}.\n$$\n\n\n**步骤1：计算位于原点的离子的 $V_{\\text{self}}$。**\n对于一个电荷为 $q_j$ 的离子，其自势能由下式给出：\n\n$$\nV_{\\text{self}} = -\\frac{q_j \\sqrt{\\eta}}{2 \\epsilon_0 \\pi^{3/2}}.\n$$\n\n对于位于原点的离子，$q_j = q_1 = +q$。因此：\n\n$$\nV_{\\text{self}} = -\\frac{q \\sqrt{\\eta}}{2 \\epsilon_0 \\pi^{3/2}}.\n$$\n\n\n**步骤2：计算 $V_{\\text{offset}}$。**\n恒定势能偏移由下式给出：\n\n$$\nV_{\\text{offset}} = -\\frac{1}{6 \\epsilon_0 \\Omega} \\sum_{j \\in \\text{cell}} q_j |\\mathbf{r}_j|^2,\n$$\n\n其中 $\\Omega = a^3$ 是立方晶胞的体积。求和遍及晶胞中的两个离子。\n\n- 对于位于 $\\mathbf{r}_1 = (0,0,0)$ 且电荷为 $q_1 = +q$ 的离子1：\n  \n$$\n  |\\mathbf{r}_1|^2 = 0^2 + 0^2 + 0^2 = 0, \\quad \\text{因此} \\quad q_1 |\\mathbf{r}_1|^2 = q \\cdot 0 = 0.\n  $$\n\n- 对于位于 $\\mathbf{r}_2 = (a/2, a/2, a/2)$ 且电荷为 $q_2 = -q$ 的离子2：\n  \n$$\n  |\\mathbf{r}_2|^2 = \\left(\\frac{a}{2}\\right)^2 + \\left(\\frac{a}{2}\\right)^2 + \\left(\\frac{a}{2}\\right)^2 = 3 \\cdot \\frac{a^2}{4} = \\frac{3a^2}{4}, \\quad \\text{因此} \\quad q_2 |\\mathbf{r}_2|^2 = (-q) \\cdot \\frac{3a^2}{4} = -\\frac{3q a^2}{4}.\n  $$\n\n将这些贡献相加：\n\n$$\n\\sum_{j} q_j |\\mathbf{r}_j|^2 = 0 + \\left(-\\frac{3q a^2}{4}\\right) = -\\frac{3q a^2}{4}.\n$$\n\n代入 $V_{\\text{offset}}$ 的公式中：\n\n$$\nV_{\\text{offset}} = -\\frac{1}{6 \\epsilon_0 a^3} \\left(-\\frac{3q a^2}{4}\\right) = \\frac{1}{6 \\epsilon_0 a^3} \\cdot \\frac{3q a^2}{4} = \\frac{3q a^2}{24 \\epsilon_0 a^3} = \\frac{q}{8 \\epsilon_0 a}.\n$$\n\n\n**步骤3：将各分量相加求得 $V_{\\text{total}}$。**\n\n$$\nV_{\\text{total}} = V_{\\text{self}} + V_{\\text{offset}} = -\\frac{q \\sqrt{\\eta}}{2 \\epsilon_0 \\pi^{3/2}} + \\frac{q}{8 \\epsilon_0 a}.\n$$\n\n该表达式即为原点处的总静电势。", "answer": "$$\n\\boxed{-\\dfrac{q \\sqrt{\\eta}}{2 \\epsilon_0 \\pi^{3/2}} + \\dfrac{q}{8 \\epsilon_0 a}}\n$$", "id": "97840"}, {"introduction": "在理解了必要的修正项之后，我们转向Ewald方法的核心计算之一：倒易空间求和。这个练习 [@problem_id:97935] 提供了一个直接的、动手计算的机会，要求我们处理一个经典的一维交替电荷链模型。通过计算倒易空间求和对晶格能的贡献，你可以熟练掌握如何构建和计算结构因子 $S(\\mathbf{G})$，并将其应用于倒易空间求和公式中，这对于在更复杂的系统中应用Ewald方法至关重要。", "problem": "Ewald求和法是计算周期性体系静电能的一种强大技术。它将收敛缓慢的点电荷相互作用的晶格求和分解为一个快速收敛的实空间求和和一个快速收敛的倒易空间求和。\n\n对于三维电荷体系，倒易空间求和对每个晶胞总能量的贡献由下式给出（使用SI单位）：\n$$ U_{\\text{recip}} = \\frac{1}{2V\\epsilon_0} \\sum_{\\mathbf{G} \\neq 0} \\frac{1}{G^2} |S(\\mathbf{G})|^2 e^{-G^2 / (4\\eta^2)} $$\n其中，$V$是晶胞的体积，$\\epsilon_0$是真空介电常数，$\\mathbf{G}$是非零的倒易晶格矢量，$\\eta$是Ewald分裂参数，$S(\\mathbf{G})$是晶胞的结构因子。结构因子定义为 $S(\\mathbf{G}) = \\sum_{j} q_j e^{-i \\mathbf{G} \\cdot \\mathbf{r}_j}$，其中求和遍历晶胞内位于位置 $\\mathbf{r}_j$ 的所有电荷 $q_j$。\n\n考虑一个沿x轴排列的、由交替点电荷组成的无限长一维链。晶胞长度为$a$，包含两个电荷：一个电荷$+q$位于位置$x_1=0$，一个电荷$-q$位于位置$x_2=a/2$。对于这样一个嵌入在三维空间中的一维体系，晶胞“体积”取为其长度，$V=a$，倒易晶格矢量由 $G_n = \\frac{2\\pi n}{a}$ 给出，其中$n$为任意非零整数。\n\n您的任务是计算部分和 $U_{\\text{recip}}^{(5)}$，它表示前五个非零正指数倒易晶格矢量（即对应于$n=1, 2, 3, 4, 5$的矢量）对倒易空间能量的贡献。用电荷$q$、晶格常数$a$、Ewald参数$\\eta$和真空介电常数$\\epsilon_0$表示您的答案。", "solution": "我们从SI单位制中每个晶胞的倒易空间能量表达式出发，将其特化于长度为$a$的一维链（单位“体积”$V=a$）：\n$$\nU_{\\text{recip}} = \\frac{1}{2a\\epsilon_0}\\sum_{G\\neq0}\\frac{1}{G^2}\\bigl|S(G)\\bigr|^2\\,e^{-G^2/(4\\eta^2)}.\n$$\n此处倒易晶格矢量为 $G_n=\\tfrac{2\\pi n}{a}$，$n\\in\\mathbb Z\\setminus\\{0\\}$。对于位于$x_1=0$的电荷$+q$和位于$x_2=a/2$的电荷$-q$，结构因子为：\n$$\nS(G_n)=\\sum_j q_j e^{-iG_nx_j}\n= q\\bigl(1 - e^{-iG_n a/2}\\bigr) = q\\bigl(1 - e^{-i(2\\pi n/a) a/2}\\bigr) = q\\bigl(1 - e^{-i\\pi n}\\bigr).\n$$\n因此，结构因子的模平方为：\n$$\n|S(G_n)|^2\n= q^2\\bigl|1 - e^{-i\\pi n}\\bigr|^2\n= q^2\\bigl(2 -2\\cos(\\pi n)\\bigr)\n=2q^2\\bigl[1-(-1)^n\\bigr].\n$$\n因此，当$n$为奇数时，$|S(G_n)|^2=4q^2$；当$n$为偶数时，为零。对$n=1,\\dots,5$的部分和简化为仅对奇数$n=1,3,5$求和。\n\n现在，我们计算对能量的贡献项。代入$G_n^2=(2\\pi n/a)^2$和$|S(G_n)|^2=4q^2$可得：\n$$\nU_{\\text{recip}}^{(5)} = \\frac{1}{2a\\epsilon_0}\\sum_{n=1,3,5}\\frac{1}{(2\\pi n/a)^2}\\,4q^2\n\\exp\\!\\Bigl[-\\frac{(2\\pi n/a)^2}{4\\eta^2}\\Bigr].\n$$\n简化每一项的系数：\n$$\n\\frac{1}{2a\\epsilon_0} \\frac{1}{(2\\pi n/a)^2} 4q^2 = \\frac{4q^2}{2a\\epsilon_0} \\frac{a^2}{4\\pi^2 n^2} = \\frac{q^2 a}{2\\epsilon_0 \\pi^2 n^2}.\n$$\n指数项为：\n$$\n\\exp\\!\\Bigl[-\\frac{(2\\pi n/a)^2}{4\\eta^2}\\Bigr]\n=\\exp\\!\\Bigl[-\\frac{\\pi^2n^2}{a^2\\eta^2}\\Bigr].\n$$\n因此，总的部分和为：\n$$\nU_{\\text{recip}}^{(5)}\n=\\sum_{n=1,3,5} \\frac{q^2 a}{2\\epsilon_0 \\pi^2 n^2}\n\\exp\\!\\Bigl[-\\frac{\\pi^2n^2}{a^2\\eta^2}\\Bigr]\n=\\frac{q^2a}{2\\epsilon_0\\pi^2}\\sum_{n=1,3,5}\\frac{1}{n^2}\n\\exp\\!\\Bigl[-\\frac{\\pi^2n^2}{a^2\\eta^2}\\Bigr].\n$$\n写出具体各项：\n$$\nU_{\\text{recip}}^{(5)}\n=\\frac{q^2a}{2\\epsilon_0\\pi^2}\\Bigl(\n\\frac{1}{1^2}e^{-\\frac{\\pi^2}{a^2\\eta^2}}\n+\\frac{1}{3^2}e^{-\\frac{9\\pi^2}{a^2\\eta^2}}\n+\\frac{1}{5^2}e^{-\\frac{25\\pi^2}{a^2\\eta^2}}\n\\Bigr).\n$$", "answer": "$$\\boxed{\\frac{q^2a}{2\\epsilon_0\\pi^2}\\Bigl(e^{-\\frac{\\pi^2}{a^2\\eta^2}}+\\frac{1}{9}e^{-\\frac{9\\pi^2}{a^2\\eta^2}}+\\frac{1}{25}e^{-\\frac{25\\pi^2}{a^2\\eta^2}}\\Bigr)}$$", "id": "97935"}, {"introduction": "将Ewald求和法从理论公式转化为高效的计算程序，需要考虑计算成本与精度之间的权衡。这个高级练习 [@problem_id:97871] 探讨了在实际计算中如何优化Ewald方法的参数。通过分析给定的误差和计算成本模型，你将学习如何通过调整分裂参数 $\\alpha$ 来最小化总计算时间，同时保证结果达到预设的精度。这种优化思想是计算物理和材料模拟中的一个核心主题，它连接了理论物理的深刻见解与高性能计算的实际需求。", "problem": "在用于计算周期性体系中静电相互作用的Ewald求和方法 (Ewald summation method) 中，总势能的计算被分解为一个快速收敛的实空间求和与一个快速收敛的倒易空间求和。这些求和的收敛性由一个分裂参数 $\\alpha$ 控制。在实际实现中，两个求和都在有限的截断值处被截断：实空间求和在半径 $R_{cut}$ 处截断，倒易空间求和在波矢大小 $G_{cut}$ 处截断。\n\n计算的精度取决于 $\\alpha$、$R_{cut}$ 和 $G_{cut}$ 的选择。对于一个给定的期望精度 $\\epsilon$，选择这些参数以平衡来自两个求和的截断误差。设实空间和倒易空间求和贡献的均方根 (RMS) 误差分别为 $\\epsilon_R$ 和 $\\epsilon_K$：\n\n$$\n\\epsilon_R = C_1 \\frac{\\exp[-(\\alpha R_{cut})^2]}{(\\alpha R_{cut})^2}\n$$\n$$\n\\epsilon_K = C_2 \\frac{\\exp[-(G_{cut}/(2\\alpha))^2]}{G_{cut}/(2\\alpha)}\n$$\n\n其中 $C_1$ 和 $C_2$ 是取决于体系性质的正常数。一种达到总体精度 $\\epsilon$ 的常用策略是要求两个误差贡献都单独等于 $\\epsilon$：$\\epsilon_R = \\epsilon$ 且 $\\epsilon_K = \\epsilon$。\n\n计算的计算成本是实空间部分和倒易空间部分成本的总和，$T = T_R + T_K$。对于一个特定的（可能非标准的）实现，这些成本由下式给出：\n\n$$\nT_R = K_R R_{cut}^2\n$$\n$$\nT_K = K_G G_{cut}^3\n$$\n\n其中 $K_R$ 和 $K_G$ 是与算法和机器性能相关的正常数。\n\n你的任务是找到实空间和倒易空间计算之间计算量的最优划分。为此，首先用 $\\alpha$ 和目标精度 $\\epsilon$ 来表示 $R_{cut}$ 和 $G_{cut}$。然后，找到使总计算成本 $T(\\alpha)$ 最小化的 $\\alpha$ 值。最后，对于这个最优的 $\\alpha$ 选择，推导出计算成本之比 $\\frac{T_R}{T_K}$ 的数值。\n\n**近似指导：** 对于高精度计算，$\\epsilon$ 非常小。这意味着自变量 $u = \\alpha R_{cut}$ 和 $v = G_{cut}/(2\\alpha)$ 很大。在求解关于 $x$ 的形如 $\\epsilon = C' \\frac{e^{-x^2}}{x^n}$ 的方程时，你可以使用领头阶近似 $x^2 \\approx \\ln(C'/\\epsilon)$，忽略缓慢变化的对数修正项。", "solution": "我们已知：\n- 实空间求和的均方根误差：$\\epsilon_R = C_1 \\frac{\\exp[-(\\alpha R_{cut})^2]}{(\\alpha R_{cut})^2} = \\epsilon$\n- 倒易空间求和的均方根误差：$\\epsilon_K = C_2 \\frac{\\exp[-(G_{cut}/(2\\alpha))^2]}{G_{cut}/(2\\alpha)} = \\epsilon$\n- 计算成本：$T_R = K_R R_{cut}^2$ 和 $T_K = K_G G_{cut}^3$\n\n对于高精度（$\\epsilon$ 很小），我们对形如 $\\epsilon = C' e^{-x^2}/x^n$ 的方程使用近似 $x^2 \\approx \\ln(C'/\\epsilon)$。\n\n**步骤1：用 $\\alpha$ 和 $\\epsilon$ 求解 $R_{cut}$ 和 $G_{cut}$。**\n\n对于 $\\epsilon_R = \\epsilon$：\n- 令 $u = \\alpha R_{cut}$。则 $\\epsilon = C_1 e^{-u^2} / u^2$。\n- 近似：$u^2 \\approx \\ln(C_1 / \\epsilon)$。\n- 因此，$(\\alpha R_{cut})^2 \\approx \\ln(C_1 / \\epsilon)$。\n- 求解 $R_{cut}$：$R_{cut} \\approx \\frac{1}{\\alpha} \\sqrt{\\ln(C_1 / \\epsilon)}$。\n\n对于 $\\epsilon_K = \\epsilon$：\n- 令 $v = G_{cut}/(2\\alpha)$。则 $\\epsilon = C_2 e^{-v^2} / v$。\n- 近似：$v^2 \\approx \\ln(C_2 / \\epsilon)$ (因为 $n=1$)。\n- 因此，$\\left( \\frac{G_{cut}}{2\\alpha} \\right)^2 \\approx \\ln(C_2 / \\epsilon)$。\n- 求解 $G_{cut}$：$G_{cut} \\approx 2\\alpha \\sqrt{\\ln(C_2 / \\epsilon)}$。\n\n**步骤2：表示计算成本 $T_R$ 和 $T_K$。**\n\n代入 $R_{cut}$ 和 $G_{cut}$：\n- $T_R = K_R R_{cut}^2 \\approx K_R \\left( \\frac{1}{\\alpha} \\sqrt{\\ln(C_1 / \\epsilon)} \\right)^2 = K_R \\frac{\\ln(C_1 / \\epsilon)}{\\alpha^2}$\n- $T_K = K_G G_{cut}^3 \\approx K_G \\left( 2\\alpha \\sqrt{\\ln(C_2 / \\epsilon)} \\right)^3 = K_G \\cdot 8 \\alpha^3 \\left( \\ln(C_2 / \\epsilon) \\right)^{3/2}$\n\n**步骤3：总成本 $T(\\alpha) = T_R + T_K$ 及其最小化。**\n\n定义常数：\n- $A = K_R \\ln(C_1 / \\epsilon)$ (与 $\\alpha$ 无关)\n- $B = 8 K_G \\left( \\ln(C_2 / \\epsilon) \\right)^{3/2}$ (与 $\\alpha$ 无关)\n\n那么：\n- $T(\\alpha) = A \\alpha^{-2} + B \\alpha^3$\n\n通过将导数设为零来最小化 $T(\\alpha)$：\n- $\\frac{dT}{d\\alpha} = -2A \\alpha^{-3} + 3B \\alpha^2 = 0$\n- 重新整理：$3B \\alpha^2 = 2A \\alpha^{-3}$\n- 两边同乘以 $\\alpha^3$：$3B \\alpha^5 = 2A$\n- 因此，$A = \\frac{3}{2} B \\alpha^5$\n\n**步骤4：求最优时的比率 $T_R / T_K$。**\n\n根据成本表达式和最小化条件：\n- $T_R = A \\alpha^{-2}$\n- $T_K = B \\alpha^3$\n- 比率：$\\frac{T_R}{T_K} = \\frac{A \\alpha^{-2}}{B \\alpha^3} = \\frac{A}{B \\alpha^5}$\n\n代入 $A = \\frac{3}{2} B \\alpha^5$：\n- $\\frac{T_R}{T_K} = \\frac{\\frac{3}{2} B \\alpha^5}{B \\alpha^5} = \\frac{3}{2}$\n\n因此，该比率为 $3/2$。", "answer": "$$\\boxed{\\dfrac{3}{2}}$$", "id": "97871"}]}