{"hands_on_practices": [{"introduction": "原子尺度上势阱的不对称性是如何转化为材料受热时的宏观膨胀的？第一个练习 ([@problem_id:2969949]) 将直接解决这个问题。通过分析经典的莫尔斯势，你将运用统计力学推导出热膨胀的主导项，从而在微观原因和宏观效应之间建立起一个具体的数学联系。", "problem": "考虑一个一维原子间距坐标 $r$，其由莫尔斯势 $V(r)=D\\left(\\exp\\!\\left(-2a(r-r_0)\\right)-2\\exp\\!\\left(-a(r-r_0)\\right)\\right)$ 决定，其中阱深 $D>0$，范围参数 $a>0$，且最小值位于 $r=r_0$。在经典正则系综（Canonical Ensemble, CE）中，绝对温度为 $T$ 时的热平均值 $\\langle r\\rangle_T$ 通过玻尔兹曼权重 $\\exp(-\\beta V(r))$ 定义，其中逆温度为 $\\beta=1/(k_B T)$，$k_B$ 是玻尔兹曼常数。从正则平均值的基本定义出发，并对 $V(r)$ 在其最小值 $r_0$ 附近进行系统展开，通过计算 $\\langle r\\rangle_T$ 到 $T$ 的一阶来计算经典极限下的领头热膨胀项。将非谐性作微扰处理，并假设分布在 $r_0$ 附近足够局域，从而展开和高斯矩恒等式有效。将您的最终结果表示为 $\\langle r\\rangle_T$ 的一个闭式解析表达式，该表达式包含到 $T$ 的线性项为止，并用 $D$、$a$、$r_0$ 和 $k_B$ 表示。最终的方框答案中不要包含单位。由于答案是符号形式，因此不需要四舍五入。", "solution": "问题要求计算在一维系统中，由莫尔斯势决定的原子间距在经典正则系综中的热平均值 $\\langle r \\rangle_T$。我们的任务是找到 $\\langle r \\rangle_T$ 的表达式，精确到温度 $T$ 的线性项。这对应于热膨胀的主导阶贡献。\n\n莫尔斯势由下式给出\n$$V(r) = D\\left(\\exp(-2a(r-r_0)) - 2\\exp(-a(r-r_0))\\right)$$\n其中 $D > 0$ 是阱深，$a > 0$ 是范围参数，$r_0$ 是对应于势能最小值的平衡间距。\n\n在温度 $T$ 下，间距 $r$ 的热平均值由正则平均值给出：\n$$\\langle r \\rangle_T = \\frac{\\int_0^\\infty r \\exp(-\\beta V(r)) dr}{\\int_0^\\infty \\exp(-\\beta V(r)) dr}$$\n其中 $\\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数。\n\n为了分析低温行为，我们将势能 $V(r)$ 在其最小值点 $r=r_0$ 附近展开成泰勒级数。令 $x = r-r_0$ 为偏离平衡位置的位移。势能作为 $x$ 的函数是 $V(r_0+x)$。泰勒级数为：\n$$V(r_0+x) = V(r_0) + V'(r_0)x + \\frac{1}{2!}V''(r_0)x^2 + \\frac{1}{3!}V'''(r_0)x^3 + \\mathcal{O}(x^4)$$\n我们计算 $V(r)$ 的必要导数并在 $r=r_0$ 处求值：\n- $V(r_0) = D(\\exp(0) - 2\\exp(0)) = -D$。\n- $V'(r) = D(-2a\\exp(-2a(r-r_0)) + 2a\\exp(-a(r-r_0)))$，所以 $V'(r_0) = D(-2a+2a)=0$，这与最小值点的期望相符。\n- $V''(r) = D(4a^2\\exp(-2a(r-r_0)) - 2a^2\\exp(-a(r-r_0)))$，所以 $V''(r_0) = D(4a^2-2a^2)=2Da^2$。\n- $V'''(r) = D(-8a^3\\exp(-2a(r-r_0)) + 2a^3\\exp(-a(r-r_0)))$，所以 $V'''(r_0) = D(-8a^3+2a^3)=-6Da^3$。\n\n将这些代入泰勒级数，势能直到三次项为：\n$$V(r_0+x) \\approx -D + \\frac{1}{2}(2Da^2)x^2 + \\frac{1}{6}(-6Da^3)x^3 = -D + Da^2x^2 - Da^3x^3$$\n我们可以将其分为谐振部分 $V_h(x)$ 和非谐微扰部分 $V_a(x)$。令 $k = 2Da^2$ 为有效弹簧常数。\n$$V(r_0+x) = \\underbrace{-D + \\frac{1}{2}kx^2}_{V_h(x)} \\underbrace{- Da^3x^3}_{V_a(x)} + \\mathcal{O}(x^4)$$\n势能中的常数项 $-D$ 会产生一个因子 $\\exp(\\beta D)$，该因子在平均值的分子和分母中被抵消，因此我们可以忽略它。\n\n偏离平衡位置的平均位移为 $\\langle x \\rangle_T = \\langle r-r_0 \\rangle_T = \\langle r \\rangle_T - r_0$。我们想计算 $\\langle x \\rangle_T$。\n$$\\langle x \\rangle_T = \\frac{\\int_{-\\infty}^\\infty x \\exp(-\\beta (V_h(x) + V_a(x))) dx}{\\int_{-\\infty}^\\infty \\exp(-\\beta (V_h(x) + V_a(x))) dx}$$\n积分限从 $(-r_0, \\infty)$ 扩展到 $(-\\infty, \\infty)$，这是一个在低温下有效的近似，因为玻尔兹曼权重 $\\exp(-\\beta V(x))$ 在 $x=0$ 附近急剧达到峰值。\n在低温下，$\\beta V_a(x)$ 很小，所以我们可以展开非谐项的指数函数：$\\exp(-\\beta V_a(x)) \\approx 1 - \\beta V_a(x)$。\n$$\\langle x \\rangle_T \\approx \\frac{\\int x (1-\\beta V_a(x)) \\exp(-\\beta V_h(x)) dx}{\\int (1-\\beta V_a(x)) \\exp(-\\beta V_h(x)) dx}$$\n令 $\\langle A \\rangle_0$ 表示相对于谐势 $V_h(x)$ 的热平均值：\n$$\\langle A \\rangle_0 = \\frac{\\int A(x) \\exp(-\\beta V_h(x)) dx}{\\int \\exp(-\\beta V_h(x)) dx}$$\n在这种表示法中，$\\langle x \\rangle_T$ 变为：\n$$\\langle x \\rangle_T \\approx \\frac{\\langle x(1-\\beta V_a(x)) \\rangle_0}{\\langle 1-\\beta V_a(x) \\rangle_0} = \\frac{\\langle x \\rangle_0 - \\beta \\langle xV_a(x) \\rangle_0}{1 - \\beta \\langle V_a(x) \\rangle_0}$$\n谐势 $V_h(x) = \\frac{1}{2}kx^2$ 是 $x$ 的偶函数。相应的玻尔兹曼分布是一个高斯分布，也是一个偶函数。因此，任何 $x$ 的奇函数在此分布上的平均值为零。\n- $\\langle x \\rangle_0 = 0$。\n- $V_a(x) = -Da^3x^3$ 是一个奇函数，所以 $\\langle V_a(x) \\rangle_0 = -Da^3 \\langle x^3 \\rangle_0 = 0$。\n- 乘积 $xV_a(x) = -Da^3x^4$ 是一个偶函数，所以它的平均值非零。\n\n经过这些简化，$\\langle x \\rangle_T$ 的表达式变为：\n$$\\langle x \\rangle_T \\approx \\frac{0 - \\beta \\langle xV_a(x) \\rangle_0}{1 - 0} = -\\beta \\langle xV_a(x) \\rangle_0$$\n代入 $V_a(x)$:\n$$\\langle x \\rangle_T \\approx -\\beta \\langle x(-Da^3x^3) \\rangle_0 = \\beta Da^3 \\langle x^4 \\rangle_0$$\n我们现在需要计算谐振子的四阶矩 $\\langle x^4 \\rangle_0$。谐振子分布是零均值的高斯分布。该分布的矩是众所周知的。首先，二阶矩（方差）可以从能量均分定理 $\\frac{1}{2}k\\langle x^2 \\rangle_0 = \\frac{1}{2}k_BT$ 得到，这给出：\n$$\\langle x^2 \\rangle_0 = \\frac{k_BT}{k} = \\frac{k_BT}{2Da^2} = \\frac{1}{2\\beta Da^2}$$\n对于零均值高斯分布，四阶矩与二阶矩的关系为 $\\langle x^4 \\rangle_0 = 3(\\langle x^2 \\rangle_0)^2$。\n$$\\langle x^4 \\rangle_0 = 3 \\left( \\frac{1}{2\\beta Da^2} \\right)^2 = \\frac{3}{4\\beta^2 D^2 a^4}$$\n现在，我们将其代回 $\\langle x \\rangle_T$ 的表达式中：\n$$\\langle x \\rangle_T \\approx \\beta Da^3 \\left( \\frac{3}{4\\beta^2 D^2 a^4} \\right) = \\frac{3Da^3}{4\\beta D^2 a^4} = \\frac{3}{4\\beta Da}$$\n最后，我们代入 $\\beta = 1/(k_B T)$:\n$$\\langle x \\rangle_T \\approx \\frac{3k_B T}{4Da}$$\n这是偏离平衡位置的平均位移，它与温度成线性关系。那么平均间距 $\\langle r \\rangle_T$ 是：\n$$\\langle r \\rangle_T = r_0 + \\langle x \\rangle_T \\approx r_0 + \\frac{3k_B T}{4Da}$$\n该表达式包括常数项 $r_0$ 和与 $T$ 成线性关系的项，符合要求。修正项的正号表明平均间距随温度升高而增加，这就是热膨胀现象。这是由原子间势的不对称性引起的，在数学上由非零的三次非谐项所体现。", "answer": "$$\\boxed{r_0 + \\frac{3k_B T}{4Da}}$$", "id": "2969949"}, {"introduction": "真实固体由大量相互作用的原子组成，其集体振动（声子）决定了其热学性质。本练习 ([@problem_id:2969960]) 将从单振子图像推广到作为真实材料建模基石的准谐近似。你将从由格林艾森参数量化的单个声子模式的性质出发，推导出宏观热膨胀系数，并探索不同模式间的竞争如何导致反常的负热膨胀现象。", "problem": "一个晶体固体可以用准谐波近似很好地描述，其中声子频率 $\\omega_{\\mathbf{q}\\nu}$ 取决于晶体体积 $V$。总亥姆霍兹自由能可以写为 $F(V,T) = U_{0}(V) + F_{\\text{ph}}(V,T)$，其中 $U_{0}(V)$ 是静态晶格能，声子部分为\n$$\nF_{\\text{ph}}(V,T) = \\sum_{\\mathbf{q}\\nu} \\left[ \\tfrac{1}{2}\\hbar \\omega_{\\mathbf{q}\\nu}(V) + k_{B} T \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{\\hbar \\omega_{\\mathbf{q}\\nu}(V)}{k_{B} T}\\right)\\right)\\right].\n$$\n模式格林艾森参数定义为 $\\gamma_{\\mathbf{q}\\nu} \\equiv -\\frac{\\partial \\ln \\omega_{\\mathbf{q}\\nu}}{\\partial \\ln V}$，等温体模量定义为 $B_{T} \\equiv -V\\left(\\frac{\\partial P}{\\partial V}\\right)_{T}$，以及体热膨胀系数定义为 $\\alpha(T) \\equiv \\frac{1}{V}\\left(\\frac{\\partial V}{\\partial T}\\right)_{P}$。\n\n任务：\n1) 仅从上述定义和基本热力学关系出发，推导 $\\alpha(T)$ 的一个通用表达式，用声子热容 $C_{\\mathbf{q}\\nu}(T)$、模式格林艾森参数 $\\gamma_{\\mathbf{q}\\nu}$、等温体模量 $B_{T}$ 和体积 $V$ 来表示。根据你的表达式，陈述在多模系统中，温度 $T$ 下出现负热膨胀的充分必要条件。\n\n2) 考虑一个具有两组无色散（爱因斯坦）光学模式的玩具多模晶体：\n- 一个低频集，简并度为 $g_{-}$，能量为 $\\hbar\\omega_{-}$，模式格林艾森参数为 $\\gamma_{-}  0$。\n- 一个高频集，简并度为 $g_{+}$，能量为 $\\hbar\\omega_{+}$，模式格林艾森参数为 $\\gamma_{+}>0$。\n假设 $B_{T}$ 和 $V$ 在感兴趣的温度范围内与温度无关，并且能量为 $\\hbar \\omega$ 的爱因斯坦模式的声子热容为\n$$\nC_{E}(\\omega,T) = k_{B}\\,\\frac{x^{2}\\exp(x)}{\\left[\\exp(x)-1\\right]^{2}},\\quad x \\equiv \\frac{\\hbar \\omega}{k_{B}T}.\n$$\n\n对于具有参数 $g_{-}=3$，$\\hbar\\omega_{-}=8\\,\\text{meV}$，$\\gamma_{-}=-2.5$，$g_{+}=9$，$\\hbar\\omega_{+}=20\\,\\text{meV}$ 和 $\\gamma_{+}=+1.0$ 的数值模型，确定 $\\alpha(T)$ 符号改变的温度 $T^{\\star}$。你可以取玻尔兹曼常数为 $k_{B}=0.0861733\\,\\text{meV/K}$。报告 $T^{\\star}$ 的数值，四舍五入到3位有效数字。用开尔文表示你的最终答案。", "solution": "这个问题包含两个部分。第一部分要求在准谐波近似下推导体热膨胀系数 $\\alpha(T)$ 的通用表达式，以及负热膨胀（NTE）的条件。第二部分将此结果应用于一个特定的玩具模型，以计算热膨胀符号改变的温度 $T^{\\star}$。\n\n### 第1部分：$\\alpha(T)$ 的推导及NTE的条件\n\n体热膨胀系数 $\\alpha(T)$ 定义为\n$$\n\\alpha(T) \\equiv \\frac{1}{V}\\left(\\frac{\\partial V}{\\partial T}\\right)_{P}\n$$\n其中 $V$ 是体积，$T$ 是温度，$P$ 是压力。该导数是在恒定压力下求得的。为了方便计算，我们使用偏导数的三元积法则，该法则表明\n$$\n\\left(\\frac{\\partial V}{\\partial T}\\right)_{P} \\left(\\frac{\\partial T}{\\partial P}\\right)_{V} \\left(\\frac{\\partial P}{\\partial V}\\right)_{T} = -1\n$$\n重新整理这个恒等式得到\n$$\n\\left(\\frac{\\partial V}{\\partial T}\\right)_{P} = -\\left(\\frac{\\partial V}{\\partial P}\\right)_{T} \\left(\\frac{\\partial P}{\\partial T}\\right)_{V}\n$$\n将其代入 $\\alpha(T)$ 的定义中：\n$$\n\\alpha(T) = -\\frac{1}{V} \\left(\\frac{\\partial V}{\\partial P}\\right)_{T} \\left(\\frac{\\partial P}{\\partial T}\\right)_{V}\n$$\n等温体模量 $B_T$ 定义为 $B_{T} \\equiv -V\\left(\\frac{\\partial P}{\\partial V}\\right)_{T}$。因此，$-\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial P}\\right)_{T} = \\frac{1}{B_T}$。这将 $\\alpha(T)$ 的表达式简化为\n$$\n\\alpha(T) = \\frac{1}{B_{T}} \\left(\\frac{\\partial P}{\\partial T}\\right)_{V}\n$$\n这是一个标准的热力学关系。现在我们必须计算项 $\\left(\\frac{\\partial P}{\\partial T}\\right)_{V}$。压力 $P$ 通过基本关系式 $P = -\\left(\\frac{\\partial F}{\\partial V}\\right)_{T}$ 与亥姆霍兹自由能 $F(V,T)$ 相关联。给定的总亥姆霍兹自由能是 $F(V,T) = U_{0}(V) + F_{\\text{ph}}(V,T)$。\n那么压力为\n$$\nP(V,T) = -\\left(\\frac{\\partial U_{0}}{\\partial V}\\right)_{T} - \\left(\\frac{\\partial F_{\\text{ph}}}{\\partial V}\\right)_{T}\n$$\n我们需要计算在恒定体积下压力随温度的变化：\n$$\n\\left(\\frac{\\partial P}{\\partial T}\\right)_{V} = -\\frac{\\partial}{\\partial T}\\left(\\frac{\\partial U_{0}}{\\partial V}\\right)_{V} - \\frac{\\partial}{\\partial T}\\left(\\frac{\\partial F_{\\text{ph}}}{\\partial V}\\right)_{V} = -\\frac{\\partial^2 F_{\\text{ph}}}{\\partial T \\partial V}\n$$\n涉及 $U_0(V)$ 的项消失了，因为 $U_0$ 只是 $V$ 的函数。由于 $F_{\\text{ph}}$ 是一个良态函数，我们可以交换微分的顺序：$\\frac{\\partial^2 F_{\\text{ph}}}{\\partial T \\partial V} = \\frac{\\partial^2 F_{\\text{ph}}}{\\partial V \\partial T}$。\n\n对自由能的声子贡献是所有声子模式 $(\\mathbf{q}\\nu)$ 的总和：\n$$\nF_{\\text{ph}}(V,T) = \\sum_{\\mathbf{q}\\nu} F_{\\mathbf{q}\\nu}(V,T) = \\sum_{\\mathbf{q}\\nu} \\left[ \\tfrac{1}{2}\\hbar \\omega_{\\mathbf{q}\\nu}(V) + k_{B} T \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{\\hbar \\omega_{\\mathbf{q}\\nu}(V)}{k_{B} T}\\right)\\right)\\right]\n$$\n让我们首先计算单个模式的自由能 $F_{\\mathbf{q}\\nu}$ 对体积 $V$ 的导数。频率 $\\omega_{\\mathbf{q}\\nu}$ 是 $V$ 的函数。\n$$\n\\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial V} = \\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V} \\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial \\omega_{\\mathbf{q}\\nu}} = \\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V} \\left[ \\frac{1}{2}\\hbar + k_B T \\frac{-\\exp(-\\hbar\\omega_{\\mathbf{q}\\nu}/k_B T) \\cdot (-\\hbar/k_B T)}{1-\\exp(-\\hbar\\omega_{\\mathbf{q}\\nu}/k_B T)} \\right]\n$$\n$$\n\\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial V} = \\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V} \\left[ \\frac{1}{2}\\hbar + \\frac{\\hbar}{ \\exp(\\hbar\\omega_{\\mathbf{q}\\nu}/k_B T) - 1 } \\right] = \\frac{1}{\\omega_{\\mathbf{q}\\nu}} \\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V} \\left[ \\frac{1}{2}\\hbar\\omega_{\\mathbf{q}\\nu} + \\frac{\\hbar\\omega_{\\mathbf{q}\\nu}}{ \\exp(\\hbar\\omega_{\\mathbf{q}\\nu}/k_B T) - 1 } \\right]\n$$\n方括号中的项是量子谐振子的平均能量 $U_{\\mathbf{q}\\nu}(T)$。所以，$\\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial V} = U_{\\mathbf{q}\\nu}(T) \\frac{\\partial \\ln \\omega_{\\mathbf{q}\\nu}}{\\partial V}$。\n使用模式格林艾森参数的定义 $\\gamma_{\\mathbf{q}\\nu} \\equiv -\\frac{\\partial \\ln \\omega_{\\mathbf{q}\\nu}}{\\partial \\ln V} = -\\frac{V}{\\omega_{\\mathbf{q}\\nu}}\\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V}$，我们可以写出 $\\frac{\\partial \\ln \\omega_{\\mathbf{q}\\nu}}{\\partial V} = -\\frac{\\gamma_{\\mathbf{q}\\nu}}{V}$。\n因此，\n$$\n\\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial V} = - U_{\\mathbf{q}\\nu}(T) \\frac{\\gamma_{\\mathbf{q}\\nu}}{V}\n$$\n对所有模式求和得到声子压力贡献：\n$$\nP_{\\text{ph}}(V,T) = -\\left(\\frac{\\partial F_{\\text{ph}}}{\\partial V}\\right)_{T} = \\sum_{\\mathbf{q}\\nu} \\frac{\\gamma_{\\mathbf{q}\\nu} U_{\\mathbf{q}\\nu}(T)}{V}\n$$\n现在，我们可以计算 $\\left(\\frac{\\partial P}{\\partial T}\\right)_{V} = \\left(\\frac{\\partial P_{\\text{ph}}}{\\partial T}\\right)_{V}$：\n$$\n\\left(\\frac{\\partial P}{\\partial T}\\right)_{V} = \\frac{\\partial}{\\partial T} \\left( \\sum_{\\mathbf{q}\\nu} \\frac{\\gamma_{\\mathbf{q}\\nu} U_{\\mathbf{q}\\nu}(T)}{V} \\right)_{V} = \\frac{1}{V} \\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} \\left(\\frac{\\partial U_{\\mathbf{q}\\nu}}{\\partial T}\\right)_{V}\n$$\n量 $\\left(\\frac{\\partial U_{\\mathbf{q}\\nu}}{\\partial T}\\right)_{V}$ 是模式 $(\\mathbf{q}\\nu)$ 的热容，记为 $C_{\\mathbf{q}\\nu}(T)$。\n$$\n\\left(\\frac{\\partial P}{\\partial T}\\right)_{V} = \\frac{1}{V} \\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} C_{\\mathbf{q}\\nu}(T)\n$$\n将此代回 $\\alpha(T)$ 的表达式，我们得到最终结果：\n$$\n\\alpha(T) = \\frac{1}{B_{T} V} \\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} C_{\\mathbf{q}\\nu}(T)\n$$\n这就是用指定量表示的 $\\alpha(T)$ 的通用表达式。\n\n对于负热膨胀，我们必须有 $\\alpha(T)  0$。对于热力学稳定的固体，等温体模量 $B_T$ 必须为正（$B_T > 0$），体积 $V$ 也为正。任何模式的热容 $C_{\\mathbf{q}\\nu}(T)$ 是一个非负量（$C_{\\mathbf{q}\\nu}(T) \\ge 0$）。因此，$\\alpha(T)$ 的符号完全由和 $\\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} C_{\\mathbf{q}\\nu}(T)$ 的符号决定。\n在温度 $T$ 下发生负热膨胀的充分必要条件是：\n$$\n\\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} C_{\\mathbf{q}\\nu}(T)  0\n$$\n\n### 第2部分：符号改变温度 $T^{\\star}$ 的计算\n\n对于给定的玩具模型，模式总和包括两个部分：一个低频集，其简并度为 $g_{-}$，频率为 $\\omega_{-}$，格林艾森参数为 $\\gamma_{-}$；以及一个高频集，其简并度为 $g_{+}$，频率为 $\\omega_{+}$，格林艾森参数为 $\\gamma_{+}$。总和变为：\n$$\n\\sum_{\\text{modes}} \\gamma_{\\text{mode}} C_{\\text{mode}}(T) = g_{-} \\gamma_{-} C_{E}(\\omega_{-}, T) + g_{+} \\gamma_{+} C_{E}(\\omega_{+}, T)\n$$\n其中 $C_{E}(\\omega, T)$ 是单个爱因斯坦模式的热容。\n热膨胀系数 $\\alpha(T)$ 在 $\\alpha(T) = 0$ 时改变符号。由于前置因子 $\\frac{1}{B_T V}$ 是正的，这种情况发生在总和为零时：\n$$\ng_{-} \\gamma_{-} C_{E}(\\omega_{-}, T^{\\star}) + g_{+} \\gamma_{+} C_{E}(\\omega_{+}, T^{\\star}) = 0\n$$\n问题提供了爱因斯坦热容的表达式：$C_{E}(\\omega,T) = k_{B}\\,\\frac{x^{2}\\exp(x)}{\\left[\\exp(x)-1\\right]^{2}}$，其中 $x \\equiv \\frac{\\hbar \\omega}{k_{B}T}$。\n将此代入我们的方程中：\n$$\ng_{-} \\gamma_{-} k_{B} \\frac{x_{-}^2 \\exp(x_{-})}{(\\exp(x_{-})-1)^2} + g_{+} \\gamma_{+} k_{B} \\frac{x_{+}^2 \\exp(x_{+})}{(\\exp(x_{+})-1)^2} = 0\n$$\n其中 $x_{-} \\equiv \\frac{\\hbar\\omega_{-}}{k_B T^{\\star}}$ 且 $x_{+} \\equiv \\frac{\\hbar\\omega_{+}}{k_B T^{\\star}}$。玻尔兹曼常数 $k_B$ 被消掉了。\n代入数值 $g_{-}=3$，$\\gamma_{-}=-2.5$，$g_{+}=9$，$\\gamma_{+}=+1.0$：\n$$\n(3)(-2.5) \\frac{x_{-}^2 \\exp(x_{-})}{(\\exp(x_{-})-1)^2} + (9)(1.0) \\frac{x_{+}^2 \\exp(x_{+})}{(\\exp(x_{+})-1)^2} = 0\n$$\n$$\n9 \\frac{x_{+}^2 \\exp(x_{+})}{(\\exp(x_{+})-1)^2} = 7.5 \\frac{x_{-}^2 \\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\n变量 $x_{-}$ 和 $x_{+}$ 是相关的：$x_{+} = \\frac{\\hbar\\omega_{+}}{k_B T^{\\star}} = \\frac{\\hbar\\omega_{-}}{k_B T^{\\star}} \\frac{\\hbar\\omega_{+}}{\\hbar\\omega_{-}} = x_{-} \\frac{20\\,\\text{meV}}{8\\,\\text{meV}} = 2.5 x_{-}$。\n代入 $x_{+} = 2.5x_{-}$，方程变为：\n$$\n9 \\frac{(2.5x_{-})^2 \\exp(2.5x_{-})}{(\\exp(2.5x_{-})-1)^2} = 7.5 \\frac{x_{-}^2 \\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\n对于 $T^{\\star} > 0$，我们有 $x_{-} \\ne 0$，因此可以从两边消去 $x_{-}^2$：\n$$\n9 \\cdot (2.5)^2 \\frac{\\exp(2.5x_{-})}{(\\exp(2.5x_{-})-1)^2} = 7.5 \\frac{\\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\n$$\n56.25 \\frac{\\exp(2.5x_{-})}{(\\exp(2.5x_{-})-1)^2} = 7.5 \\frac{\\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\n两边除以 $7.5$ 得到：\n$$\n7.5 \\frac{\\exp(2.5x_{-})}{(\\exp(2.5x_{-})-1)^2} = \\frac{\\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\n这是一个关于 $x_{-}$ 的超越方程。我们用数值方法求解。我们定义一个函数 $f(y) = 7.5 \\exp(2.5y)(\\exp(y)-1)^2 - \\exp(y)(\\exp(2.5y)-1)^2$ 并找到它的根 $y=x_{-}$。\n通过测试数值，我们发现对于 $y=0.65$，$f(0.65) > 0$；对于 $y=0.66$，$f(0.66)  0$。进一步细化表明，根非常接近 $x_{-} \\approx 0.6529$。\n现在我们可以计算温度 $T^{\\star}$：\n$$\nT^{\\star} = \\frac{\\hbar\\omega_{-}}{k_B x_{-}}\n$$\n使用给定值 $\\hbar\\omega_{-} = 8\\,\\text{meV}$ 和 $k_B=0.0861733\\,\\text{meV/K}$：\n$$\nT^{\\star} = \\frac{8\\,\\text{meV}}{(0.0861733\\,\\text{meV/K}) \\cdot (0.6529)} = \\frac{8}{0.056262}\\,\\text{K} \\approx 142.189\\,\\text{K}\n$$\n将结果四舍五入到3位有效数字得到 $142\\,\\text{K}$。在低温下，较软模式的负 $\\gamma_{-}$ 占主导地位，导致加热时收缩（$\\alpha  0$）。在较高温度下，数量更多的高能模式的正 $\\gamma_{+}$ 变得显著，导致膨胀（$\\alpha > 0$）。$T^{\\star}$ 是转变温度。", "answer": "$$\\boxed{142}$$", "id": "2969960"}, {"introduction": "准谐近似虽然功能强大，但也有其局限性，尤其是在原子振动强烈的材料中。最后一个计算练习 ([@problem_id:2970007]) 引入了更高级的自洽声子 (SCP) 方法，该方法能更好地处理强非谐性。通过编程实现并比较准谐近似 (QHA) 和 SCP 模型，你将获得计算凝聚态物理的实践经验，并体会到为何需要更复杂的理论来精确预测复杂材料的性质。", "problem": "你需要实现一个程序，用于计算一个具有强非谐性的简化钙钛矿模型的体积热膨胀系数 $\\alpha(T)$（作为温度的函数）。你必须比较准谐近似 (QHA) 和自洽声子 (SCP) 方法的预测，并定量评估四次非谐性在再现实测膨胀趋势方面的影响。\n\n需要使用的基本定义和模型假设如下：\n- 在温度 $T$ 和体积 $V$ 下，亥姆霍兹自由能 $F(T,V)$ 由晶格弹性贡献和振动贡献组成。在固定外压 $P_{\\text{ext}}$ 下，吉布斯自由能为 $G(T,V) = E_{\\text{el}}(V) + F_{\\text{vib}}(T,V) + P_{\\text{ext}} V$。在给定 $T$ 和固定 $P_{\\text{ext}}$ 的条件下，热平衡状态满足 $G(T,V)$ 相对于 $V$ 的最小化。\n- 体积热膨胀系数定义为 $\\alpha(T) = \\frac{1}{V(T)} \\left( \\frac{\\partial V(T)}{\\partial T} \\right)_{P_{\\text{ext}}}$，你必须使用中心有限差分近似进行数值计算。\n- 弹性贡献被建模为围绕参考体积 $V_0$ 的二次展开，其体弹性模量为 $B$：$E_{\\text{el}}(V) = \\frac{B}{2 V_0} \\left(V - V_0\\right)^2$。\n- 振动谱由 $s$ 个相同的光学模式表示，这些模式通过格林爱森（Grüneisen）型关系 $\\omega(V) = \\omega_0 \\left( \\frac{V}{V_0} \\right)^{-\\gamma}$ 与体积耦合，其中 $\\omega_0$ 是参考角频率，$\\gamma$ 是格林爱森参数。\n- 每个模式的谐振子亥姆霍兹自由能为 $F_{\\text{harm}}(T,\\omega) = k_B T \\ln\\left(1 - e^{-\\hbar \\omega / k_B T}\\right) + \\frac{1}{2} \\hbar \\omega$，因此总的 QHA 振动自由能为 $F_{\\text{QHA}}(T,V) = s \\, F_{\\text{harm}}(T, \\omega(V))$。此处 $k_B$ 是玻尔兹曼常数，$\\hbar$ 是约化普朗克常数。\n- 在处理四次非谐性的自洽声子 (SCP) 方法中，每个模式由单坐标势 $U(x;V) = \\frac{1}{2} M \\, \\omega(V)^2 \\, x^2 + \\frac{1}{4} \\beta \\, x^4$ 控制，其中 $M$ 是有效质量，$\\beta$ 是四次项系数。重整化角频率 $\\Omega$ 由以下自洽条件隐式确定：\n$$\nM \\, \\Omega^2 = M \\, \\omega(V)^2 + 3 \\, \\beta \\, \\langle x^2 \\rangle_{\\Omega},\n$$\n其中谐振子坐标方差为：\n$$\n\\langle x^2 \\rangle_{\\Omega} = \\frac{\\hbar}{2 M \\Omega} \\, \\coth\\left( \\frac{\\hbar \\Omega}{2 k_B T} \\right).\n$$\n使用 $\\langle x^4 \\rangle_{\\Omega} = 3 \\, \\langle x^2 \\rangle_{\\Omega}^2$。在自洽解 $\\Omega$ 下，每个模式的 SCP 变分自由能为：\n$$\nF_{\\text{SCP,mode}}(T,V) = F_{\\text{harm}}(T,\\Omega) + \\frac{1}{2} M \\left( \\omega(V)^2 - \\Omega^2 \\right) \\langle x^2 \\rangle_{\\Omega} + \\frac{1}{4} \\beta \\, \\langle x^4 \\rangle_{\\Omega},\n$$\n且 $F_{\\text{SCP}}(T,V) = s \\, F_{\\text{SCP,mode}}(T,V)$。\n\n计算任务：\n1. 对于每组指定的参数集和温度 $T$，在固定外压 $P_{\\text{ext}}$ 下，通过最小化 $G(T,V)$ 相对于 $V$ 的值来计算平衡体积 $V(T)$，具体针对以下情况：\n   - QHA：使用 $F_{\\text{QHA}}(T,V)$。\n   - SCP：使用 $F_{\\text{SCP}}(T,V)$，其中重整化的 $\\Omega$ 必须通过求解上述隐式方程自洽地获得。如果 $\\beta = 0$，则 $\\Omega = \\omega(V)$ 精确成立。\n2. 在每个目标温度 $T$ 下，使用中心有限差分近似计算 $\\alpha(T)$：\n$$\n\\alpha(T) \\approx \\frac{1}{V(T)} \\cdot \\frac{V(T + \\Delta T) - V(T - \\Delta T)}{2 \\, \\Delta T},\n$$\n取 $\\Delta T = 1 \\, \\mathrm{K}$。\n3. 对于每个测试用例，还需计算与所提供的实验参考值 $\\alpha_{\\text{exp}}(T)$ 的相对偏差 $\\delta(T)$（以小数形式表示）：\n$$\n\\delta(T) = \\frac{\\alpha(T) - \\alpha_{\\text{exp}}(T)}{\\alpha_{\\text{exp}}(T)}.\n$$\n\n单位与数值报告：\n- 所有物理量必须使用国际单位制 (SI) 处理。热膨胀系数必须以 $\\mathrm{K}^{-1}$ 为单位报告。\n- 报告的所有数值输出均需四舍五入到七位小数。\n\n测试套件：\n为以下三个探测不同物理机制区域的参数集实现计算：\n\n- 测试用例 1（强非谐性钙钛矿）：\n  - $V_0 = 64 \\times 10^{-30} \\, \\mathrm{m}^3$，$B = 1.10 \\times 10^{11} \\, \\mathrm{Pa}$，$M = 3.0 \\times 10^{-26} \\, \\mathrm{kg}$，$\\omega_0 = 2.0 \\times 10^{13} \\, \\mathrm{rad/s}$，$\\gamma = 2.0$，$\\beta = 6.0 \\times 10^{20} \\, \\mathrm{J/m}^4$，$s = 3$，$P_{\\text{ext}} = 0 \\, \\mathrm{Pa}$，目标温度 $T \\in \\{300 \\, \\mathrm{K}, 900 \\, \\mathrm{K}\\}$，实验参考值 $\\alpha_{\\text{exp}}(300 \\, \\mathrm{K}) = 1.40 \\times 10^{-5} \\, \\mathrm{K}^{-1}$ 和 $\\alpha_{\\text{exp}}(900 \\, \\mathrm{K}) = 1.20 \\times 10^{-5} \\, \\mathrm{K}^{-1}$。\n- 测试用例 2（中等非谐性）：\n  - 与测试用例 1 相同，除了 $\\beta = 1.5 \\times 10^{20} \\, \\mathrm{J/m}^4$，以及实验参考值 $\\alpha_{\\text{exp}}(300 \\, \\mathrm{K}) = 1.30 \\times 10^{-5} \\, \\mathrm{K}^{-1}$ 和 $\\alpha_{\\text{exp}}(900 \\, \\mathrm{K}) = 1.25 \\times 10^{-5} \\, \\mathrm{K}^{-1}$。\n- 测试用例 3（谐振子极限边界）：\n  - 与测试用例 1 相同，除了 $\\beta = 0$，以及实验参考值 $\\alpha_{\\text{exp}}(300 \\, \\mathrm{K}) = 1.25 \\times 10^{-5} \\, \\mathrm{K}^{-1}$ 和 $\\alpha_{\\text{exp}}(900 \\, \\mathrm{K}) = 1.25 \\times 10^{-5} \\, \\mathrm{K}^{-1}$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。\n- 每个测试用例的条目必须是一个包含八个数字的列表：\n  - $[\\alpha_{\\text{QHA}}(300 \\, \\mathrm{K}), \\alpha_{\\text{QHA}}(900 \\, \\mathrm{K}), \\alpha_{\\text{SCP}}(300 \\, \\mathrm{K}), \\alpha_{\\text{SCP}}(900 \\, \\mathrm{K}), \\delta_{\\text{QHA}}(300 \\, \\mathrm{K}), \\delta_{\\text{QHA}}(900 \\, \\mathrm{K}), \\delta_{\\text{SCP}}(300 \\, \\mathrm{K}), \\delta_{\\text{SCP}}(900 \\, \\mathrm{K})]$，\n  所有数值均四舍五入到七位小数，其中 $\\alpha$ 的单位为 $\\mathrm{K}^{-1}$，$\\delta$ 为无单位的小数。\n- 因此，对于这三个测试用例，最终输出必须是包含三个列表的单一列表，例如：$[[a_1,a_2,a_3,a_4,a_5,a_6,a_7,a_8],[b_1,\\dots,b_8],[c_1,\\dots,c_8]]$，其中每个符号都由数值替换。", "solution": "用户要求在两种不同的理论近似（准谐近似和自洽声子方法）下，为一个钙钛矿模型计算体积热膨胀系数 $\\alpha(T)$。该要求已被验证为凝聚态物理学领域一个在科学上合理、定义明确且完整的问题。我们将提供详细的解决方案。\n\n### 1. 热力学框架\n\n吉布斯自由能由下式给出：\n$$\nG(T,V) = E_{\\mathrm{el}}(V) + F_{\\mathrm{vib}}(T,V) + P_{\\mathrm{ext}} V\n$$\n其中 $E_{\\mathrm{el}}(V)$ 是晶格的静态弹性势能，$F_{\\mathrm{vib}}(T,V)$ 是振动亥姆霍兹自由能。平衡体积 $V(T)$ 通过求解以下最小化问题得到：\n$$\n\\left( \\frac{\\partial G(T,V)}{\\partial V} \\right)_T = 0\n$$\n问题指定了以下能量贡献模型：\n\n-   **弹性势能**：一个简单的二次模型，描述了晶格从其参考体积 $V_0$ 压缩或膨胀所需的能量。\n    $$\n    E_{\\mathrm{el}}(V) = \\frac{B}{2 V_0} (V - V_0)^2\n    $$\n    此处，$B$ 是体弹性模量。\n\n-   **振动自由能**：该项取决于处理原子振动（声子）所选择的近似方法。晶体的振动行为被简化为 $s$ 个相同的光学声子模式，其频率 $\\omega$ 根据格林爱森（Grüneisen）关系随体积变化：\n    $$\n    \\omega(V) = \\omega_0 \\left( \\frac{V}{V_0} \\right)^{-\\gamma}\n    $$\n    其中 $\\gamma$ 是格林爱森参数。\n\n### 2. 准谐近似 (QHA)\n\nQHA 是较简单的模型。它将声子视为理想的谐振子，但允许其频率依赖于晶体体积。总振动自由能是每个模式贡献的总和：\n$$\nF_{\\mathrm{QHA}}(T,V) = s \\cdot F_{\\mathrm{harm}}(T, \\omega(V))\n$$\n其中 $F_{\\mathrm{harm}}$ 是量子谐振子的标准统计力学结果：\n$$\nF_{\\mathrm{harm}}(T,\\omega) = k_B T \\ln\\left(1 - e^{-\\hbar \\omega / k_B T}\\right) + \\frac{1}{2} \\hbar \\omega\n$$\n$\\frac{1}{2} \\hbar \\omega$ 项是零点能。\n\n### 3. 自洽声子 (SCP) 方法\n\nSCP 方法提供了一种更复杂的处理非谐性的方法，这对于谐振子近似失效的材料至关重要。每个模式的势能包含一个四次项：$U(x) = \\frac{1}{2} M \\omega(V)^2 x^2 + \\frac{1}{4} \\beta x^4$。该项引入了声子间的相互作用。SCP 方法使用一个具有*重整化*频率 $\\Omega$ 的有效无相互作用声子系统来近似这个相互作用系统，该频率必须自洽地确定。\n\n自洽条件将重整化频率 $\\Omega$ 与有效谐振子的均方根位移 $\\langle x^2 \\rangle_{\\Omega}$ 联系起来：\n$$\nM \\Omega^2 = M \\omega(V)^2 + 3 \\beta \\langle x^2 \\rangle_{\\Omega}\n$$\n均方根位移本身也依赖于 $\\Omega$：\n$$\n\\langle x^2 \\rangle_{\\Omega} = \\frac{\\hbar}{2 M \\Omega} \\coth\\left( \\frac{\\hbar \\Omega}{2 k_B T} \\right)\n$$\n对于给定的体积 $V$ 和温度 $T$，这构成了一个关于 $\\Omega$ 的隐式方程，必须进行数值求解，例如，使用像 Brent-Dekker 方法这样的求根算法。\n\n一旦找到自洽的 $\\Omega$，即可计算 SCP 振动自由能。使用自洽条件，给定的 $F_{\\text{SCP,mode}}$ 表达式可以简化为：\n$$\nF_{\\mathrm{SCP,mode}}(T,V) = F_{\\mathrm{harm}}(T,\\Omega) - \\frac{3}{4}\\beta (\\langle x^2 \\rangle_{\\Omega})^2\n$$\n总的 SCP 振动自由能则为 $F_{\\mathrm{SCP}}(T,V) = s \\cdot F_{\\mathrm{SCP,mode}}(T,V)$。一个关键的检验是，如果非谐性系数 $\\beta = 0$，自洽方程会得出 $\\Omega = \\omega(V)$，并且 SCP 自由能正确地简化为 QHA 自由能。\n\n### 4. 计算算法\n\n总体的计算流程如下：\n\n1.  **对于每个测试用例和模型 (QHA/SCP)：**\n    a. 我们在固定温度 $T$ 下定义一个吉布斯自由能函数 $G(V)$。该函数封装了 $E_{\\mathrm{el}}(V)$ 和相应的 $F_{\\mathrm{vib}}(T,V)$ 的计算。\n    b. 对于 SCP 模型，$F_{\\mathrm{vib}}(T,V)$ 的评估需要一个内部步骤：使用数值求根器（`scipy.optimize.brentq`）在每个 $(T,V)$ 对上求解关于 $\\Omega$ 的自洽方程。\n    c. 我们通过使用优化例程（`scipy.optimize.minimize_scalar`）对 $G(V)$ 相对于 $V$ 进行数值最小化来找到平衡体积 $V(T)$。\n\n2.  **计算热膨胀系数 $\\alpha(T)$**：\n    问题指定了对导数 $\\left( \\frac{\\partial V}{\\partial T} \\right)_P$ 使用中心有限差分近似。这需要计算三个温度下的平衡体积：$T - \\Delta T$、$T$ 和 $T + \\Delta T$，其中 $\\Delta T = 1 \\, \\mathrm{K}$。\n    $$\n    \\alpha(T) \\approx \\frac{1}{V(T)} \\frac{V(T + \\Delta T) - V(T - \\Delta T)}{2 \\Delta T}\n    $$\n\n3.  **计算相对偏差 $\\delta(T)$**：\n    将计算出的 $\\alpha(T)$ 与提供的实验参考值 $\\alpha_{\\text{exp}}(T)$ 进行比较，以量化模型的准确性：\n    $$\n    \\delta(T) = \\frac{\\alpha(T) - \\alpha_{\\text{exp}}(T)}{\\alpha_{\\text{exp}}(T)}\n    $$\n\n4.  **最终输出**：\n    每个测试用例的结果——包含两个模型在两个温度下计算出的 $\\alpha$ 和 $\\delta$ 值的八个浮点数——被收集、四舍五入，并格式化为指定的列表的列表结构。整个实现过程均使用国际单位制。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar, brentq\n\ndef solve():\n    \"\"\"\n    Computes volumetric thermal expansion coefficient for QHA and SCP models\n    and compares them to experimental data.\n    \"\"\"\n    \n    # Fundamental constants in SI units\n    HBAR = 1.054571817e-34  # J.s\n    KB = 1.380649e-23      # J/K\n    \n    # Finite difference step for temperature\n    DT = 1.0\n\n    # Test cases as defined in the problem statement\n    test_cases = [\n        {\n            \"params\": {'s': 3, 'V0': 64e-30, 'B': 1.10e11, 'M': 3.0e-26, \n                       'omega0': 2.0e13, 'gamma': 2.0, 'beta': 6.0e20, 'P_ext': 0.0},\n            \"temps\": [300.0, 900.0],\n            \"alpha_exp\": [1.40e-5, 1.20e-5]\n        },\n        {\n            \"params\": {'s': 3, 'V0': 64e-30, 'B': 1.10e11, 'M': 3.0e-26, \n                       'omega0': 2.0e13, 'gamma': 2.0, 'beta': 1.5e20, 'P_ext': 0.0},\n            \"temps\": [300.0, 900.0],\n            \"alpha_exp\": [1.30e-5, 1.25e-5]\n        },\n        {\n            \"params\": {'s': 3, 'V0': 64e-30, 'B': 1.10e11, 'M': 3.0e-26, \n                       'omega0': 2.0e13, 'gamma': 2.0, 'beta': 0.0, 'P_ext': 0.0},\n            \"temps\": [300.0, 900.0],\n            \"alpha_exp\": [1.25e-5, 1.25e-5]\n        }\n    ]\n\n    all_results = []\n    \n    # Memoization caches to speed up repeated calculations during minimization\n    memo_F_vib = {}\n    memo_omega_scp = {}\n\n    def get_omega_V(V, p):\n        return p['omega0'] * (V / p['V0'])**(-p['gamma'])\n\n    def get_E_el(V, p):\n        return p['B'] / (2 * p['V0']) * (V - p['V0'])**2\n\n    def get_F_harm_mode(T, omega):\n        if T = 1e-9 or omega = 1e-9:\n             return 0.5 * HBAR * omega\n        \n        arg = HBAR * omega / (KB * T)\n        # Avoid overflow/underflow issues in np.exp\n        if arg > 700:\n            return 0.5 * HBAR * omega\n        \n        return KB * T * np.log(1 - np.exp(-arg)) + 0.5 * HBAR * omega\n\n    def get_F_qha(T, V, p):\n        key = ('QHA', T, V)\n        if key in memo_F_vib: return memo_F_vib[key]\n        \n        omega = get_omega_V(V, p)\n        result = p['s'] * get_F_harm_mode(T, omega)\n        memo_F_vib[key] = result\n        return result\n\n    def solve_omega_scp_for_V_T(V, T, p):\n        key = (T, V)\n        if key in memo_omega_scp: return memo_omega_scp[key]\n        \n        if p['beta'] == 0:\n            omega_scp = get_omega_V(V, p)\n            memo_omega_scp[key] = omega_scp\n            return omega_scp\n            \n        omega_bare_sq = get_omega_V(V, p)**2\n        \n        def scp_equation(Omega):\n            if Omega = 1e-12: return -np.inf\n            \n            arg_coth = HBAR * Omega / (2 * KB * T)\n            coth_val = 1.0 / np.tanh(arg_coth) if arg_coth  300 else 1.0\n                \n            x2_mean = (HBAR / (2 * p['M'] * Omega)) * coth_val\n            return Omega**2 - omega_bare_sq - (3 * p['beta'] / p['M']) * x2_mean\n        \n        omega_bare = np.sqrt(omega_bare_sq)\n        lower_bound = omega_bare * 1e-6\n        upper_bound = omega_bare * 20\n        \n        try:\n            val_lower = scp_equation(lower_bound)\n            val_upper = scp_equation(upper_bound)\n            if np.sign(val_lower) == np.sign(val_upper):\n                upper_bound *= 5\n        except (OverflowError, ValueError):\n            pass\n            \n        omega_scp = brentq(scp_equation, lower_bound, upper_bound, xtol=1e-15, rtol=1e-15)\n        memo_omega_scp[key] = omega_scp\n        return omega_scp\n\n    def get_F_scp(T, V, p):\n        key = ('SCP', T, V)\n        if key in memo_F_vib: return memo_F_vib[key]\n\n        if p['beta'] == 0:\n            return get_F_qha(T, V, p)\n        \n        Omega_scp = solve_omega_scp_for_V_T(V, T, p)\n        \n        arg_coth = HBAR * Omega_scp / (2 * KB * T)\n        coth_val = 1.0 / np.tanh(arg_coth) if arg_coth  300 else 1.0\n        \n        x2_mean = (HBAR / (2 * p['M'] * Omega_scp)) * coth_val\n        \n        F_harm_scp = p['s'] * get_F_harm_mode(T, Omega_scp)\n        correction = p['s'] * (-0.75 * p['beta'] * x2_mean**2)\n        \n        result = F_harm_scp + correction\n        memo_F_vib[key] = result\n        return result\n\n    def get_equilibrium_volume(T, p, model):\n        F_vib_func = get_F_qha if model == 'QHA' else get_F_scp\n\n        def gibbs_G(V):\n            Eel = get_E_el(V, p)\n            Fvib = F_vib_func(T, V, p)\n            return Eel + Fvib + p['P_ext'] * V\n            \n        bounds = (p['V0'] * 0.9, p['V0'] * 1.1)\n        res = minimize_scalar(gibbs_G, bounds=bounds, method='bounded', options={'xatol': 1e-25})\n        return res.x\n\n    for case in test_cases:\n        params = case[\"params\"]\n        \n        memo_F_vib.clear()\n        memo_omega_scp.clear()\n        \n        alphas = []\n        for model in ['QHA', 'SCP']:\n            for T_target in case[\"temps\"]:\n                V_T = get_equilibrium_volume(T_target, params, model)\n                V_plus = get_equilibrium_volume(T_target + DT, params, model)\n                V_minus = get_equilibrium_volume(T_target - DT, params, model)\n                \n                alpha = (1.0 / V_T) * (V_plus - V_minus) / (2.0 * DT)\n                alphas.append(alpha)\n        \n        alpha_qha = alphas[0:2]\n        alpha_scp = alphas[2:4]\n        \n        delta_qha = [(a - a_exp) / a_exp for a, a_exp in zip(alpha_qha, case[\"alpha_exp\"])]\n        delta_scp = [(a - a_exp) / a_exp for a, a_exp in zip(alpha_scp, case[\"alpha_exp\"])]\n        \n        case_result = [\n            round(alpha_qha[0], 7), round(alpha_qha[1], 7),\n            round(alpha_scp[0], 7), round(alpha_scp[1], 7),\n            round(delta_qha[0], 7), round(delta_qha[1], 7),\n            round(delta_scp[0], 7), round(delta_scp[1], 7)\n        ]\n        all_results.append(case_result)\n        \n    # Format the final output string as per requirements\n    print(f\"[[{','.join(map(str,all_results[0]))}],[{','.join(map(str,all_results[1]))}],[{','.join(map(str,all_results[2]))}]]\".replace(\" \", \"\"))\n\nsolve()\n```", "id": "2970007"}]}