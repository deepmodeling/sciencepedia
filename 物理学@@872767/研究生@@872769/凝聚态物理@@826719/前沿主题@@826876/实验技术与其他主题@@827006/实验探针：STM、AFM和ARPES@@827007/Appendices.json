{"hands_on_practices": [{"introduction": "扫描隧道谱（STS）使我们能够探测物质的局域电子态密度（LDOS）。然而，任何测量得到的谱线都不是无限锐利的。这种展宽的根源在于电子本身的热能，其能量分布由费米-狄拉克分布描述。本练习将指导您从第一性原理出发，推导这个由温度决定的能量分辨率极限。通过计算热核函数的半峰全宽（FWHM），您将定量地理解在给定温度下STS实验所能达到的最终能量分辨率。[@problem_id:2988543]", "problem": "在通过扫描隧道显微镜 (STM) 进行的扫描隧道谱 (STS) 实验中，测得的微分电导 $dI/dV$ 作为偏置电压 $V$ 的函数，可以建模为样品电子态密度与费米-狄拉克分布能量导数的卷积。假设样品的态密度在热展宽的能量尺度上变化缓慢，因此能量分辨率受限于热核 $-\\mathrm{d}f/\\mathrm{d}E$ 的宽度，其中 $f(E)$ 是费米-狄拉克分布。从温度为 $T$ 时的费米-狄拉克分布定义出发：\n$$\nf(E)=\\frac{1}{1+\\exp\\!\\left(\\frac{E}{k_{B}T}\\right)},\n$$\n推导核函数 $-\\mathrm{d}f/\\mathrm{d}E$ 的半峰全宽 (FWHM) 的闭合形式表达式，并用它来计算在 $T=4\\,\\mathrm{K}$ 时的热能分辨率，忽略例如电压噪声或锁定调制等仪器展宽。最终能量以 $\\mathrm{meV}$ 为单位表示，并将您的答案四舍五入到四位有效数字。", "solution": "用户要求推导在扫描隧道谱 (STS) 中使用的热展宽核的半峰全宽 (FWHM)，并在特定温度下进行数值计算。\n\n### 步骤 1：FWHM 的推导\n\n热展宽核由费米-狄拉克分布对能量 $E$ 的负导数给出。我们将该核表示为 $K(E)$。\n$$\nK(E) = -\\frac{df}{dE}\n$$\n费米-狄拉克分布由下式给出：\n$$\nf(E) = \\frac{1}{1+\\exp\\left(\\frac{E}{k_B T}\\right)} = \\left(1+\\exp\\left(\\frac{E}{k_B T}\\right)\\right)^{-1}\n$$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。在此计算中，化学势 $\\mu$ 被隐式地设为 $0$，因为导数峰的宽度与其能量位置无关。\n\n我们使用链式法则计算导数：\n$$\n\\frac{df}{dE} = -1 \\cdot \\left(1+\\exp\\left(\\frac{E}{k_B T}\\right)\\right)^{-2} \\cdot \\frac{d}{dE}\\left(\\exp\\left(\\frac{E}{k_B T}\\right)\\right)\n$$\n$$\n\\frac{df}{dE} = -\\left(1+\\exp\\left(\\frac{E}{k_B T}\\right)\\right)^{-2} \\cdot \\exp\\left(\\frac{E}{k_B T}\\right) \\cdot \\frac{1}{k_B T}\n$$\n$$\n\\frac{df}{dE} = -\\frac{1}{k_B T} \\frac{\\exp\\left(\\frac{E}{k_B T}\\right)}{\\left(1+\\exp\\left(\\frac{E}{k_B T}\\right)\\right)^2}\n$$\n因此，该核为：\n$$\nK(E) = -\\frac{df}{dE} = \\frac{1}{k_B T} \\frac{\\exp\\left(\\frac{E}{k_B T}\\right)}{\\left(1+\\exp\\left(\\frac{E}{k_B T}\\right)\\right)^2}\n$$\n为了简化这个表达式，我们可以使用双曲正割函数的恒等式 $\\mathrm{sech}(x) = 1/\\cosh(x)$。我们知道 $\\cosh(x) = \\frac{e^x+e^{-x}}{2}$。将分子和分母同乘以 $\\exp\\left(-\\frac{E}{k_B T}\\right)$ 来处理核的表达式：\n$$\nK(E) = \\frac{1}{k_B T} \\frac{1}{\\exp\\left(-\\frac{E}{2k_B T}\\right)^2 \\left(1+\\exp\\left(\\frac{E}{k_B T}\\right)\\right)^2} = \\frac{1}{k_B T} \\frac{1}{\\left(\\exp\\left(-\\frac{E}{2k_B T}\\right)\\left(1+\\exp\\left(\\frac{E}{k_B T}\\right)\\right)\\right)^2}\n$$\n$$\nK(E) = \\frac{1}{k_B T} \\frac{1}{\\left(\\exp\\left(-\\frac{E}{2k_B T}\\right) + \\exp\\left(\\frac{E}{2k_B T}\\right)\\right)^2}\n$$\n使用恒等式 $2\\cosh(x) = e^x + e^{-x}$，其中 $x = \\frac{E}{2k_B T}$，我们得到：\n$$\nK(E) = \\frac{1}{k_B T} \\frac{1}{\\left(2\\cosh\\left(\\frac{E}{2k_B T}\\right)\\right)^2} = \\frac{1}{4k_B T} \\frac{1}{\\cosh^2\\left(\\frac{E}{2k_B T}\\right)}\n$$\n$$\nK(E) = \\frac{1}{4k_B T} \\mathrm{sech}^2\\left(\\frac{E}{2k_B T}\\right)\n$$\n这个函数关于 $E=0$ 对称。为了找到 FWHM，我们首先确定 $K(E)$ 的最大值。函数 $\\mathrm{sech}^2(x)$ 在 $x=0$ 处有最大值 $1$。因此，$K(E)$ 在 $E=0$ 处取得最大值：\n$$\nK_{max} = K(0) = \\frac{1}{4k_B T} \\mathrm{sech}^2(0) = \\frac{1}{4k_B T}\n$$\n接下来，我们找到能量值 $\\pm E_{HW}$（其中 HW 代表半宽），在这些值上函数等于其最大值的一半：\n$$\nK(E_{HW}) = \\frac{1}{2} K_{max}\n$$\n$$\n\\frac{1}{4k_B T} \\mathrm{sech}^2\\left(\\frac{E_{HW}}{2k_B T}\\right) = \\frac{1}{2} \\left(\\frac{1}{4k_B T}\\right)\n$$\n$$\n\\mathrm{sech}^2\\left(\\frac{E_{HW}}{2k_B T}\\right) = \\frac{1}{2}\n$$\n对两边取平方根（并只考虑正根，因为 $\\mathrm{sech}(x) > 0$）：\n$$\n\\mathrm{sech}\\left(\\frac{E_{HW}}{2k_B T}\\right) = \\frac{1}{\\sqrt{2}}\n$$\n因为 $\\mathrm{sech}(x) = 1/\\cosh(x)$，这意味着：\n$$\n\\cosh\\left(\\frac{E_{HW}}{2k_B T}\\right) = \\sqrt{2}\n$$\n为了解出自变量，我们使用反双曲余弦函数，对于 $y \\ge 1$ 有 $\\mathrm{arccosh}(y) = \\ln(y + \\sqrt{y^2-1})$：\n$$\n\\frac{E_{HW}}{2k_B T} = \\mathrm{arccosh}(\\sqrt{2}) = \\ln\\left(\\sqrt{2} + \\sqrt{(\\sqrt{2})^2-1}\\right) = \\ln(\\sqrt{2} + \\sqrt{1})\n$$\n$$\n\\frac{E_{HW}}{2k_B T} = \\ln(1+\\sqrt{2})\n$$\n解出 $E_{HW}$：\n$$\nE_{HW} = 2k_B T \\ln(1+\\sqrt{2})\n$$\nFWHM，记为 $\\Delta E$，是半宽的两倍：\n$$\n\\Delta E = 2 E_{HW} = 4k_B T \\ln(1+\\sqrt{2})\n$$\n这就是热展宽核 FWHM 的闭合形式表达式。\n\n### 步骤 2：数值计算\n\n我们被要求计算在 $T = 4\\,\\mathrm{K}$ 时的能量分辨率。我们使用玻尔兹曼常数的值 $k_B \\approx 8.617333 \\times 10^{-5} \\, \\mathrm{eV/K}$。对于这个问题，方便将其表示为 $\\mathrm{meV/K}$：\n$$\nk_B \\approx 0.08617333 \\, \\mathrm{meV/K}\n$$\n常数因子的数值是：\n$$\n\\ln(1+\\sqrt{2}) \\approx \\ln(1 + 1.41421356) = \\ln(2.41421356) \\approx 0.88137359\n$$\n现在，我们将这些值代入 FWHM 公式：\n$$\n\\Delta E = 4 \\times (0.08617333 \\, \\mathrm{meV/K}) \\times (4 \\, \\mathrm{K}) \\times \\ln(1+\\sqrt{2})\n$$\n$$\n\\Delta E \\approx 4 \\times (0.08617333) \\times 4 \\times (0.88137359) \\, \\mathrm{meV}\n$$\n$$\n\\Delta E \\approx 1.215158 \\, \\mathrm{meV}\n$$\n题目要求答案四舍五入到四位有效数字。\n$$\n\\Delta E \\approx 1.215 \\, \\mathrm{meV}\n$$", "answer": "$$\\boxed{1.215}$$", "id": "2988543"}, {"introduction": "调频原子力显微镜（FM-AFM）以其通过探测微小力梯度实现原子级分辨率而闻名。一个关键问题是：是什么决定了其灵敏度的最终极限？答案在于悬臂不可避免的热振动，它构成了基本的噪声来源，而能量均分定理为量化这种热运动提供了理论框架。本练习要求您从基本物理原理出发，推导可探测的最小力梯度。通过这一过程，您将把悬臂的宏观属性与热噪声的微观极限联系起来，从而揭示设计高灵敏度AFM时所涉及的物理权衡。[@problem_id:2988559]", "problem": "一个在频率调制（FM）模式下进行的原子力显微镜（AFM）实验使用一个单模悬臂，该悬臂可被建模为阻尼谐振子，其弹簧常数为 $k$，共振频率为 $f_0$，品质因数为 $Q$。悬臂在 $f_0$ 处被驱动，达到稳定的振荡幅度 $A$。环境温度为 $T$，测量通道具有一个等效噪声带宽 $B$（单位为赫兹），该带宽由锁相环和解调滤波器设定。振荡器的热涨落限制了通过共振频率偏移来检测微小保守针尖-样品力梯度的精度。\n\n仅从基本原理和关于阻尼谐振子中热噪声的成熟公式出发，推导FM-AFM中最小可探测保守力梯度的解析表达式，该梯度被定义为：其引起的共振频率偏移等于测量带宽内的均方根热频率噪声。作为一个中间步骤，根据能量均分定理计算热均方根偏转幅度。然后，使用以下参数，对热偏转幅度和最小可探测力梯度进行数值计算：\n- $k = 200~\\mathrm{N/m}$，\n- $f_0 = 2.50 \\times 10^{4}~\\mathrm{Hz}$，\n- $Q = 2.50 \\times 10^{4}$，\n- $A = 5.00 \\times 10^{-10}~\\mathrm{m}$，\n- $T = 5.00~\\mathrm{K}$，\n- $B = 2.00 \\times 10^{2}~\\mathrm{Hz}$，\n以及玻尔兹曼常数 $k_B = 1.380649 \\times 10^{-23}~\\mathrm{J/K}$。\n\n将两个所求的数值结果四舍五入到三位有效数字。热偏转幅度以米为单位表示，最小可探测力梯度以 $\\mathrm{N/m}$ 为单位表示。以一个双元素行矩阵的形式提供最终答案，其中依次包含热偏转幅度和最小可探测力梯度。", "solution": "该问题要求我们推导并计算调频原子力显微镜（FM-AFM）中的两个关键物理量：悬臂的热均方根偏转幅度和由热噪声限制的最小可探测力梯度。\n\n### 步骤 1：热均方根偏转幅度的推导与计算\n\n悬臂可以被建模为一个简谐振子。根据统计力学中的能量均分定理，在热平衡温度 $T$ 下，谐振子的平均势能为 $\\frac{1}{2}k_B T$。悬臂的势能为 $\\frac{1}{2}k\\langle z^2 \\rangle$，其中 $k$ 是其弹簧常数，$\\langle z^2 \\rangle$ 是其均方偏转。\n令平均势能相等：\n$$ \\frac{1}{2}k\\langle z^2 \\rangle = \\frac{1}{2}k_B T $$\n因此，热均方根（RMS）偏转幅度 $z_{th,rms}$ 为：\n$$ z_{th,rms} = \\sqrt{\\langle z^2 \\rangle} = \\sqrt{\\frac{k_B T}{k}} $$\n**数值计算：**\n使用给定参数：\n- $k_B = 1.380649 \\times 10^{-23}~\\mathrm{J/K}$\n- $T = 5.00~\\mathrm{K}$\n- $k = 200~\\mathrm{N/m}$\n$$ z_{th,rms} = \\sqrt{\\frac{(1.380649 \\times 10^{-23}~\\mathrm{J/K}) \\times (5.00~\\mathrm{K})}{200~\\mathrm{N/m}}} = \\sqrt{3.4516225 \\times 10^{-25}~\\mathrm{m}^2} \\approx 5.875 \\times 10^{-13}~\\mathrm{m} $$\n四舍五入到三位有效数字，热偏转幅度为 $5.88 \\times 10^{-13}~\\mathrm{m}$。\n\n### 步骤 2：最小可探测力梯度的推导\n\n1.  **力梯度引起的频率偏移：**\n    当悬臂受到一个保守力梯度 $k_{ts} = \\partial F_{ts}/\\partial z$ 的作用时，其有效弹簧常数变为 $k_{eff} = k + k_{ts}$。共振频率 $f = \\frac{1}{2\\pi}\\sqrt{\\frac{k_{eff}}{m}}$ 也会发生改变。对于小的力梯度（$k_{ts} \\ll k$），频率偏移 $\\Delta f$ 可以近似为：\n    $$ \\Delta f = f_{eff} - f_0 \\approx \\frac{f_0}{2k} k_{ts} $$\n    因此，力梯度可以表示为：\n    $$ k_{ts} = \\frac{2k}{f_0} \\Delta f $$\n\n2.  **热频率噪声：**\n    FM-AFM 的灵敏度极限是由悬臂的自发热振动引起的频率噪声决定的。对于一个在测量带宽 $B$ 内的测量，频率噪声的均方根值 $\\Delta f_{rms}$ 由以下标准公式给出：\n    $$ \\Delta f_{rms} = \\sqrt{\\frac{f_0 k_B T B}{\\pi Q k A^2}} $$\n    其中 $Q$ 是品质因数，$A$ 是振荡幅度。这个公式源于涨落-耗散定理，它将悬臂的热力噪声与频率测量的不确定性联系起来。\n\n3.  **最小可探测力梯度：**\n    根据问题定义，最小可探测力梯度 $k_{ts,min}$ 是指其引起的频率偏移 $\\Delta f$ 等于均方根频率噪声 $\\Delta f_{rms}$。\n    $$ \\Delta f_{min} = \\Delta f_{rms} $$\n    将 $k_{ts,min}$ 代入频率偏移公式，并令其等于 $\\Delta f_{rms}$：\n    $$ \\frac{f_0}{2k} k_{ts,min} = \\sqrt{\\frac{f_0 k_B T B}{\\pi Q k A^2}} $$\n    解出 $k_{ts,min}$：\n    $$ k_{ts,min} = \\frac{2k}{f_0} \\sqrt{\\frac{f_0 k_B T B}{\\pi Q k A^2}} = \\frac{2k}{f_0 A} \\sqrt{\\frac{f_0 k_B T B}{\\pi Q k}} $$\n    进一步化简得到最终表达式：\n    $$ k_{ts,min} = \\frac{2}{A} \\sqrt{\\frac{k k_B T B}{\\pi f_0 Q}} $$\n\n### 步骤 3：最小可探测力梯度的数值计算\n\n使用给定参数：\n- $A = 5.00 \\times 10^{-10}~\\mathrm{m}$\n- $k = 200~\\mathrm{N/m}$\n- $k_B = 1.380649 \\times 10^{-23}~\\mathrm{J/K}$\n- $T = 5.00~\\mathrm{K}$\n- $B = 2.00 \\times 10^{2}~\\mathrm{Hz}$\n- $f_0 = 2.50 \\times 10^{4}~\\mathrm{Hz}$\n- $Q = 2.50 \\times 10^{4}$\n$$ k_{ts,min} = \\frac{2}{5.00 \\times 10^{-10}} \\sqrt{\\frac{(200) \\cdot (1.380649 \\times 10^{-23}) \\cdot (5.00) \\cdot (2.00 \\times 10^2)}{\\pi \\cdot (2.50 \\times 10^4) \\cdot (2.50 \\times 10^4)}} $$\n$$ k_{ts,min} = (4.00 \\times 10^9) \\sqrt{\\frac{2.761298 \\times 10^{-18}}{1.963495 \\times 10^9}} = (4.00 \\times 10^9) \\sqrt{1.406267 \\times 10^{-27}} $$\n$$ k_{ts,min} \\approx (4.00 \\times 10^9) \\times (3.7499 \\times 10^{-14}) \\approx 1.49996 \\times 10^{-4}~\\mathrm{N/m} $$\n四舍五入到三位有效数字，最小可探测力梯度为 $1.50 \\times 10^{-4}~\\mathrm{N/m}$。\n\n### 最终答案\n\n将计算出的热偏转幅度和最小可探测力梯度组合成一个双元素行矩阵：\n$$\n\\begin{pmatrix}\nz_{th,rms}  k_{ts,min}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n5.88 \\times 10^{-13}~\\mathrm{m}  1.50 \\times 10^{-4}~\\mathrm{N/m}\n\\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.88 \\times 10^{-13}  1.50 \\times 10^{-4}\n\\end{pmatrix}\n}\n$$", "id": "2988559"}, {"introduction": "角分辨光电子能谱（ARPES）能够直接观察材料在倒易空间中的电子能带结构和费米面，这一强大功能使我们能够提取材料的基本宏观属性。费米面所包围的体积（在二维情况下为面积）与材料的载流子浓度之间存在着深刻的联系，这便是由Luttinger定理所阐明的关系。本练习要求您首先从倒易空间中简单的态计数出发，推导这一关系。然后，您将应用该关系，计算由ARPES测量的各种费米面的载流子浓度，将抽象的倒易空间图像转化为具体的物理量。[@problem_id:2988548]", "problem": "考虑一个通过角分辨光电子能谱（ARPES）探测的二维电子系统。ARPES 绘制了二维布里渊区中的费米面轮廓，提供了一组倒易空间中的点，这些点近似地表示了零温下占据态与未占据态之间的边界。假设边长为 $L$ 的正方形样品具有周期性边界条件，因此允许的晶格动量被量子化为 $\\mathbf{k} = \\frac{2\\pi}{L}\\mathbf{n}$，其中分量为整数。倒易空间中单位面积的 $\\mathbf{k}$-态密度可由此量子化条件导出。每个 $\\mathbf{k}$-态带有一个简并因子 $g \\equiv g_s g_v$，其中 $g_s$ 是自旋简并度，$g_v$ 是任何复制费米口袋的附加能谷或能带简并度。\n\n从上述定义和基本的状态计数论证出发，推导二维系统中封闭的费米面面积与载流子密度之间的关系。通过将ARPES测量的口袋面积解释为移动载流子（对于电子型口袋是电子，对于空穴型口袋是空穴）的度量，一致地处理电子型口袋（费米面包裹占据态）和空穴型口袋（费米面包裹能带顶附近的未占据态）。您的推导必须从所述的 $\\mathbf{k}$-态量子化开始，并以一个仅依赖于倒易空间中封闭面积和简并度 $g$ 的表达式结束。\n\n您的程序必须实现以下计算步骤：\n- 给定二维ARPES测量的费米面轮廓，使用适当的几何方法计算倒易空间中的封闭面积。当轮廓由一组有序的 $\\mathbf{k}$-空间点描述时，使用稳健的多边形面积计算方法。当轮廓被解析描述时（例如，圆形或椭圆形），使用精确的几何面积公式以避免离散化误差。\n- 将所有倒易空间量转换为国际单位制（SI）。倒易空间坐标以埃的倒数（$\\mathrm{\\AA}^{-1}$）为单位提供，其中 $1\\,\\mathrm{\\AA} = 10^{-10}\\,\\mathrm{m}$，因此 $1\\,\\mathrm{\\AA}^{-1} = 10^{10}\\,\\mathrm{m}^{-1}$。倒易空间中的面积因此转换为 $1\\,\\mathrm{\\AA}^{-2} = 10^{20}\\,\\mathrm{m}^{-2}$。\n- 使用推导出的表达式计算载流子密度。对于电子型口袋报告电子载流子密度，对于空穴型口袋报告空穴载流子密度，两者均以正浮点数形式报告。\n- 以 $\\mathrm{m}^{-2}$ 为单位，将最终答案表示为浮点数。\n\n测试套件：\n请为以下五个案例提供结果。在所有案例中，输出必须是一个浮点数，代表以 $\\mathrm{m}^{-2}$ 为单位的载流子密度，并四舍五入到六位有效数字。\n\n1. 一个位于原点的圆形电子口袋，半径为 $k_F = 0.5\\,\\mathrm{\\AA}^{-1}$，自旋简并度 $g_s = 2$，能谷简并度 $g_v = 1$。\n2. 一个位于布里渊区角落的圆形空穴口袋，半径为 $k_h = 0.2\\,\\mathrm{\\AA}^{-1}$，自旋简并度 $g_s = 2$，能谷简并度 $g_v = 1$。\n3. 一个位于原点的椭圆形电子口袋，半轴分别为 $k_x = 0.3\\,\\mathrm{\\AA}^{-1}$ 和 $k_y = 0.5\\,\\mathrm{\\AA}^{-1}$，自旋简并度 $g_s = 2$，能谷简并度 $g_v = 2$。\n4. 一个完全自旋极化系统中的圆形电子口袋，半径为 $k_F = 0.35\\,\\mathrm{\\AA}^{-1}$，自旋简并度 $g_s = 1$，能谷简并度 $g_v = 1$。\n5. 一个由一组有序的ARPES点（单位为 $\\mathrm{\\AA}^{-1}$）描述的各向异性电子口袋，形成一个简单的闭合轮廓：\n$\\{(0.40, 0.00), (0.35, 0.20), (0.15, 0.35), (0.00, 0.40), (-0.10, 0.35), (-0.25, 0.15), (-0.30, -0.05), (-0.10, -0.25), (0.20, -0.30), (0.35, -0.15)\\}$，自旋简并度 $g_s = 2$，能谷简并度 $g_v = 1$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的结果与上述案例的顺序相同（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是以 $\\mathrm{m}^{-2}$ 为单位的载流子密度浮点数，并四舍五入到六位有效数字。", "solution": "该问题的核心是推导并应用二维电子气的载流子密度与其费米面在倒易空间中包围的面积之间的关系。\n\n### 步骤 1：推导载流子密度与费米面面积的关系\n\n推导从有限系统中晶格动量 $\\mathbf{k}$ 在周期性边界条件下的量子化开始。对于边长为 $L$ 的二维正方形样品，允许的动量矢量为：\n$$ \\mathbf{k} = (k_x, k_y) = \\left( \\frac{2\\pi}{L}n_x, \\frac{2\\pi}{L}n_y \\right) $$\n其中 $n_x$ 和 $n_y$ 是整数。这些允许的 $\\mathbf{k}$-矢量在倒易平面中形成一个均匀的正方形网格。沿每个轴的相邻点之间的间距为 $\\Delta k = \\frac{2\\pi}{L}$。因此，与单个唯一的轨道 $\\mathbf{k}$-态相关联的倒易空间面积为：\n$$ A_{\\text{state}} = \\Delta k_x \\Delta k_y = \\left( \\frac{2\\pi}{L} \\right)^2 = \\frac{4\\pi^2}{L^2} $$\n样品的实空间面积为 $A = L^2$，因此我们可以将每个 $\\mathbf{k}$-态的面积写为 $A_{\\text{state}} = \\frac{4\\pi^2}{A}$。这意味着倒易空间中轨道态的密度为 $\\frac{1}{A_{\\text{state}}} = \\frac{A}{4\\pi^2}$。\n\n在零温下，所有能量低于费米能的态都被占据。费米面是分隔占据态和未占据态的等能面轮廓。对于电子型口袋，费米面包围着占据态。占据的轨道态总数 $N_{\\text{orb}}$，可以通过在费米面包围的面积 $A_k$ 上对态密度进行积分得到：\n$$ N_{\\text{orb}} = \\iint_{A_k} \\frac{d^2k}{A_{\\text{state}}} = \\frac{1}{A_{\\text{state}}} \\iint_{A_k} d^2k = \\frac{A_k}{A_{\\text{state}}} = \\frac{A_k A}{4\\pi^2} $$\n对于空穴型口袋，费米面在一个原本填满的能带内包围着未占据的态。面积 $A_k$ 对应于缺失的电子，这等效于空穴载流子的数量，因此计数论证保持不变。\n\n每个轨道 $\\mathbf{k}$-态可以有额外的简并度 $g = g_s g_v$。因此，总载流子数（电子或空穴）$N_{\\text{carriers}}$ 为：\n$$ N_{\\text{carriers}} = g \\times N_{\\text{orb}} = g \\frac{A_k A}{4\\pi^2} $$\n载流子密度 $n$ 是实空间单位面积内的载流子数量，它是一个不依赖于样品尺寸的强度性质。\n$$ n = \\frac{N_{\\text{carriers}}}{A} = \\frac{1}{A} \\left( g \\frac{A_k A}{4\\pi^2} \\right) $$\n实空间面积 $A$ 被约去，得到最终的基本关系式：\n$$ n = g \\frac{A_k}{4\\pi^2} $$\n这个表达式将宏观的载流子密度 $n$ 与微观的费米面面积 $A_k$ 联系起来，并且对电子和空穴口袋都有效。\n\n### 步骤 2：应用公式进行计算\n\n为了解决问题，我们将此公式应用于每个测试案例。\n首先，必须以 $\\mathrm{\\AA}^{-2}$ 为单位计算面积 $A_k$。\n-   对于半径为 $k_F$ 的圆形口袋，面积为 $A_k = \\pi k_F^2$。\n-   对于半轴为 $k_x$ 和 $k_y$ 的椭圆形口袋，面积为 $A_k = \\pi k_x k_y$。\n-   对于由一组有序顶点 $(k_{x,i}, k_{y,i})$ 描述的口袋，面积使用多边形的鞋带公式计算： $A_k = \\frac{1}{2} |\\sum_{i=1}^{N} (k_{x,i} k_{y,i+1} - k_{x,i+1} k_{y,i})|$，其中第 $(N+1)$ 个顶点与第一个顶点相同。\n\n其次，使用转换因子 $1\\,\\mathrm{\\AA}^{-2} = (10^{10}\\,\\mathrm{m}^{-1})^2 = 10^{20}\\,\\mathrm{m}^{-2}$ 将面积 $A_k$ 从 $\\mathrm{\\AA}^{-2}$ 转换为 SI 单位（$\\mathrm{m}^{-2}$）。\n\n最后，使用推导出的公式，以及 $A_k$ 的 SI 值和给定的总简并度 $g = g_s g_v$，计算以 $\\mathrm{m}^{-2}$ 为单位的载流子密度 $n$。然后将结果四舍五入到六位有效数字。", "answer": "```python\nimport numpy as np\nimport math\n\ndef round_to_significant_digits(num, sig_figs):\n    \"\"\"\n    Rounds a number to a specified number of significant digits.\n    \"\"\"\n    if num == 0:\n        return 0.0\n    # Calculate the power of 10 for the desired rounding precision.\n    power = -math.floor(math.log10(abs(num))) + (sig_figs - 1)\n    return round(num, power)\n\ndef compute_carrier_density(Ak_inv_angstroms_sq, g, sig_figs=6):\n    \"\"\"\n    Computes carrier density from Fermi surface area and degeneracy.\n\n    Args:\n        Ak_inv_angstroms_sq (float): Enclosed Fermi surface area in inverse Angstroms squared.\n        g (int): Total degeneracy factor (g_s * g_v).\n        sig_figs (int): Number of significant digits for the final result.\n\n    Returns:\n        float: Carrier density in m^-2, rounded to sig_figs.\n    \"\"\"\n    # Conversion factor for area from A^-2 to m^-2\n    ANGSTROM_SQ_TO_METER_SQ = 1e20\n\n    # Convert area to SI units (m^-2)\n    Ak_si = Ak_inv_angstroms_sq * ANGSTROM_SQ_TO_METER_SQ\n\n    # Apply the 2D carrier density formula: n = g * Ak / (4 * pi^2)\n    density = g * Ak_si / (4 * np.pi**2)\n\n    return round_to_significant_digits(density, sig_figs)\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the results.\n    \"\"\"\n    test_cases = [\n        # Case 1: Circular electron pocket\n        {'type': 'circle', 'params': {'r': 0.5}, 'gs': 2, 'gv': 1},\n        # Case 2: Circular hole pocket\n        {'type': 'circle', 'params': {'r': 0.2}, 'gs': 2, 'gv': 1},\n        # Case 3: Elliptical electron pocket\n        {'type': 'ellipse', 'params': {'kx': 0.3, 'ky': 0.5}, 'gs': 2, 'gv': 2},\n        # Case 4: Circular electron pocket, spin-polarized\n        {'type': 'circle', 'params': {'r': 0.35}, 'gs': 1, 'gv': 1},\n        # Case 5: Anisotropic electron pocket (polygon)\n        {\n            'type': 'polygon',\n            'params': {\n                'points': np.array([\n                    (0.40, 0.00), (0.35, 0.20), (0.15, 0.35), (0.00, 0.40),\n                    (-0.10, 0.35), (-0.25, 0.15), (-0.30, -0.05),\n                    (-0.10, -0.25), (0.20, -0.30), (0.35, -0.15)\n                ])\n            },\n            'gs': 2, 'gv': 1\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        Ak = 0.0\n        if case['type'] == 'circle':\n            r = case['params']['r']\n            # Area of a circle: pi * r^2\n            Ak = np.pi * r**2\n        elif case['type'] == 'ellipse':\n            kx = case['params']['kx']\n            ky = case['params']['ky']\n            # Area of an ellipse: pi * kx * ky\n            Ak = np.pi * kx * ky\n        elif case['type'] == 'polygon':\n            points = case['params']['points']\n            x = points[:, 0]\n            y = points[:, 1]\n            # Shoelace formula for polygon area\n            Ak = 0.5 * np.abs(np.dot(x, np.roll(y, -1)) - np.dot(y, np.roll(x, -1)))\n        \n        g = case['gs'] * case['gv']\n        density = compute_carrier_density(Ak, g)\n        results.append(density)\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(map(str, [3.97887e+18, 6.3662e+17, 4.77465e+18, 9.74838e+17, 1.74145e+18]))}]\")\n\nsolve()\n```", "id": "2988548"}]}