## 引言
在量子多体物理的世界里，粒子间的相互作用是产生丰富奇异现象的根源，但也使得精确求解系统的行为成为一项巨大的理论挑战。直接求解包含相互作用的[哈密顿量](@entry_id:172864)往往是不可能的。为了克服这一障碍，物理学家发展了一套强大而直观的语言——[费曼图](@entry_id:144373)方法。它不仅是一个系统性的微扰计算工具，更是一种深刻的物理洞察方式，能将抽象的数学公式转化为粒子间散射、传播与变换的生动图像。

本文旨在为读者提供一个关于多体系统中[费曼图](@entry_id:144373)理论的全面而深入的指南。我们将从最基本的原理出发，系统地解决如何处理相互作用这一核心问题。读者将学习到如何将一个看似无法处理的问题，分解为一系列可以计算和理解的图形化步骤，并最终利用这些步骤来预测和解释真实的物理现象。

为实现这一目标，本文组织为三个循序渐进的章节。在“**原理与机制**”中，我们将奠定理论基础，介绍[相互作用绘景](@entry_id:198213)、戴森级数、以及作为理论核心的格林函数。读者将理解自能、[戴森方程](@entry_id:146246)、以及处理有限温度问题的松原形式主义等关键概念。接着，在“**应用与跨学科联系**”中，我们将展示这套理论工具的威力，探讨它如何解释[金属中的屏蔽](@entry_id:146568)效应、预测[铁磁性](@entry_id:137256)和超导等[相变](@entry_id:147324)，并构成现代计算方法（如[GW近似](@entry_id:140388)和DMFT）的理论核心。最后，在“**动手实践**”部分，读者将有机会通过解决具体问题，将理论知识转化为实际的计算技能，巩固对费曼图“语法”的掌握。通过本次学习，您将建立起一个从基本原理到前沿应用的完整知识框架。

## 原理与机制

在多体系统中，粒子间的相互作用使得精确求解[哈密顿量](@entry_id:172864)的本征态和[本征值](@entry_id:154894)变得极其困难。费曼图方法为我们提供了一个系统性的微扰理论框架，用以处理这些复杂的相互作用。它不仅是一种强大的计算工具，更是一种深刻的物理洞察方式，能将复杂的代数表达式转化为直观的物理过程图像。本章将深入探讨费曼图理论的基本原理及其赋予该理论结构和预测能力的内在机制。

### [相互作用绘景](@entry_id:198213)与[微扰展开](@entry_id:159275)

多体系统微扰理论的出发点，是将总[哈密顿量](@entry_id:172864) $H$ 分解为一个可解的非相互作用部分 $H_0$ 和一个相互作用部分 $H_{\text{int}}$。我们的目标是系统地计算 $H_{\text{int}}$ 对系统性质的影响。实现这一目标的关键在于引入**[相互作用绘景](@entry_id:198213) (interaction picture)**。

在[相互作用绘景](@entry_id:198213)中，算符的时间演化由非相互作用的[哈密顿量](@entry_id:172864) $H_0$ 决定，而系统状态的[时间演化](@entry_id:153943)则由[相互作用绘景](@entry_id:198213)下的[哈密顿量](@entry_id:172864) $H_I(t)$ 控制。对于一个[场算符](@entry_id:140269) $\psi(\mathbf{r})$，其在[相互作用绘景](@entry_id:198213)下的形式为：
$$
\psi_I(\mathbf{r},t) = e^{i H_0 t} \psi(\mathbf{r}) e^{-i H_0 t}
$$
相应地，[相互作用哈密顿量](@entry_id:181720)变为：
$$
H_I(t) = e^{i H_0 t} H_{\text{int}} e^{-i H_0 t}
$$
这种划分的优越性在于，[场算符](@entry_id:140269) $\psi_I(\mathbf{r},t)$ 的演化是简单的、可解的（如同[自由粒子](@entry_id:148748)），这使得应用维克定理 (Wick's theorem) 成为可能。所有复杂的相互作用效应都被封装在状态的演化中，而状态的演化由[演化算符](@entry_id:182628) $U_I(t, t_0)$ 描述，它满足薛定谔方程 $i \frac{\partial}{\partial t}U_I(t,t_0) = H_I(t) U_I(t,t_0)$。

通过对该方程进行迭代求解，我们可以得到一个以 $H_I$ 的幂次展开的级数，这便是著名的**戴森级数 (Dyson series)**。对于从遥远过去 ($t_0 \to -\infty$) 到遥远未来 ($t \to +\infty$) 的演化，[演化算符](@entry_id:182628)被称为**[散射矩阵](@entry_id:137017) (S-matrix)** $S \equiv U_I(+\infty, -\infty)$。它的展开式为：
$$
S = \sum_{n=0}^{\infty} \frac{(-i)^n}{n!} \int_{-\infty}^{\infty} dt_1 \cdots \int_{-\infty}^{\infty} dt_n \, T[H_I(t_1) \cdots H_I(t_n)]
$$
其中 $T$ 是**[时间排序算符](@entry_id:148044) (time-ordering operator)**。它的出现至关重要，因为不同时刻的[相互作用哈密顿量](@entry_id:181720) $H_I(t_i)$ 和 $H_I(t_j)$ 通常不对易。[时间排序算符](@entry_id:148044)将一系列算符按照时间从晚到早[排列](@entry_id:136432)，确保了演化的正确因果顺序。例如，对于一个包含两体相互作用 $V(\mathbf{r}-\mathbf{r}')$ 的费米系统 [@problem_id:2989970]，其二阶展开项为：
$$
S^{(2)} = -\frac{1}{2} \int_{-\infty}^{\infty} dt \int_{-\infty}^{\infty} dt' \, T[H_I(t) H_I(t')]
$$
这个戴森级数构成了所有微扰计算的基石，而[费曼图](@entry_id:144373)正是这个级数中每一项的图形化表示。

### 格林函数：理论的核心构造

虽然 S 矩阵在[散射理论](@entry_id:143476)中至关重要，但在多体物理中，我们更关心的是系统内部的激发和传播性质。这些性质被**[单粒子格林函数](@entry_id:140400) (single-particle Green's function)** 所描述。在[海森堡绘景](@entry_id:141162)中，对于[费米子](@entry_id:146235)系统，时间排序的[格林函数](@entry_id:147802)（或称[费曼传播子](@entry_id:140690)）定义为：
$$
G(x_1, t_1; x_2, t_2) = -i \langle T[\psi(x_1, t_1) \psi^{\dagger}(x_2, t_2)] \rangle
$$
这里的 $\langle \cdots \rangle$ 表示在系统平衡态（通常是[基态](@entry_id:150928)或[热力学](@entry_id:141121)系综）下的平均值。格林函数物理上描述了一个粒子在时空点 $(x_2, t_2)$ 被产生，然后传播到时空点 $(x_1, t_1)$ 并被湮灭的量子力学振幅。

对于[费米子](@entry_id:146235)，[时间排序算符](@entry_id:148044) $T$ 的定义需要特别注意：每交换一对[费米子算符](@entry_id:149120)，就要引入一个负号。因此，格林函数的显式形式可以借助[亥维赛阶跃函数](@entry_id:268807) $\theta(t)$ 写出 [@problem_id:2989933]：
$$
G(x_1, t_1; x_2, t_2) = -i \Big[ \theta(t_1 - t_2) \langle \psi(x_1, t_1) \psi^{\dagger}(x_2, t_2) \rangle - \theta(t_2 - t_1) \langle \psi^{\dagger}(x_2, t_2) \psi(x_1, t_1) \rangle \Big]
$$
第一项描述了粒子（particle）在时间向前传播 ($t_1 > t_2$)，第二项描述了空穴（hole）在时间向前传播（等价于粒子在时间上向后传播，$t_2 > t_1$）。

必须将时间排序格林函数与**[推迟格林函数](@entry_id:139183) ([retarded Green's function](@entry_id:139183))** $G^R$ 区分开来。[推迟格林函数](@entry_id:139183)描述了系统对一个微扰的因果响应，其定义为：
$$
G^R(x_1, t_1; x_2, t_2) = -i \theta(t_1 - t_2) \langle \{ \psi(x_1, t_1), \psi^{\dagger}(x_2, t_2) \}_{+} \rangle
$$
其中 $\{\cdot, \cdot\}_{+}$ 是[反对易子](@entry_id:139754)。$\theta(t_1 - t_2)$ 因子确保了响应（在 $t_1$）不会发生在源（在 $t_2$）之前，体现了因果性。而[反对易子](@entry_id:139754)的使用，确保了其[运动方程](@entry_id:170720)具有正确的源项，这与[费米子](@entry_id:146235)的等时[反对易关系](@entry_id:153815)直接相关 [@problem_id:2989933]。在[微扰展开](@entry_id:159275)中自然出现的[传播子](@entry_id:139558)是时间排序的 $G$，而与实验可观测量（如线性响应系数）直接相关的是推迟的 $G^R$。两者通过解析延拓相互联系。

### 关联图与林克-克拉斯特定理

利用戴森级数和格林函数的定义，我们可以将[格林函数](@entry_id:147802)展开成一个关于相互作用 $H_{\text{int}}$ 的无穷级数。这个级数的每一项都可以用一个[费曼图](@entry_id:144373)来表示。在这些图中，会出现两类基本的拓扑结构：**关联图 (connected diagrams)** 和**[非关联图](@entry_id:192455) (disconnected diagrams)**。[非关联图](@entry_id:192455)由两个或多个没有传播子线相连的部分组成。

一个深刻的结论，即**林克-克拉斯特定理 (Linked-Cluster Theorem)**，极大地简化了计算。该定理指出，[物理可观测量](@entry_id:154692)（如[基态能量](@entry_id:263704)、粒子数密度、各种响应函数）仅由关联图贡献。所有[非关联图](@entry_id:192455)的贡献，特别是那些不与任何外部粒子线相连的“真空泡”图，会以一种系统性的方式被抵消。

理解这一点最优雅的方式是通过**[生成泛函](@entry_id:152688) (generating functional)** 方法。我们可以引入一个外部源场 $J(x)$，并定义[配分函数](@entry_id:193625)泛函 $Z[J]$。完整的格林函数（包含[关联和](@entry_id:269099)非关联部分）可以通过对 $Z[J]$ 求泛函导数得到。而只包含关联图的格林函数，则由 $W[J] \equiv \ln Z[J]$ 的泛函导数生成 [@problem_id:2989954] [@problem_id:2989931]：
$$
G_c^{(n)}(x_1, \dots, x_n) = \left. \frac{\delta^n W[J]}{\delta J(x_n) \cdots \delta J(x_1)} \right|_{J=0}
$$
这在数学上等价于矩 (moments) 和[累积量](@entry_id:152982) (cumulants) 之间的关系。由于系统的宏观热力学性质（如[巨势](@entry_id:136286)能 $\Omega$）正比于 $\ln Z$，它们天然地只与关联图（[累积量](@entry_id:152982)）相关 [@problem_id:2989931] [@problem_id:2989931]。这个定理使得我们能够忽略复杂的[非关联图](@entry_id:192455)，专注于计算物理上更有意义的关联图。

### [戴森方程](@entry_id:146246)：重整微扰序列

即使只考虑关联图，[微扰级数](@entry_id:266790)仍然是无穷的。为了有效地处理这个无穷级数，我们需要一种方法来组织它。这里的关键概念是图的**不可约性 (irreducibility)**。

对于[单粒子格林函数](@entry_id:140400)，一个图被称为**单粒子可约的 (one-particle reducible, 1PR)**，如果它可以通过切断一条内部传播子线而分裂成两个不相连的部分。反之，如果无论切断哪条内部传播子线都不能使图分裂，则该图是**单粒子不可约的 (one-particle irreducible, 1PI)** [@problem_id:2989974]。

现在，我们定义一个核心物理量——**自能 (self-energy)** $\Sigma$，它被定义为所有 1PI 图的总和（并约定移除连接到外部的[传播子](@entry_id:139558)线，即“截肢”）。[自能](@entry_id:145608) $\Sigma$ 本身可以看作是一个“黑盒子”，代表了相互作用对粒子传播产生的所有不可约的修正 [@problem_id:2989974] [@problem_id:2989955]。

这个定义的美妙之处在于，任何一个关联图，要么是 1PI 的，要么可以唯一地分解成一个由 1PI 的[自能](@entry_id:145608)块和非相互作用[传播子](@entry_id:139558) $G_0$ 组成的链条。完整的（或称“缀饰的”）格林函数 $G$ 就是所有这些可能链条的总和：
$$
G = G_0 + G_0 \Sigma G_0 + G_0 \Sigma G_0 \Sigma G_0 + \cdots
$$
这是一个几何级数，可以被精确地求和，得到**[戴森方程](@entry_id:146246) (Dyson's equation)**：
$$
G = G_0 + G_0 \Sigma G
$$
或者写成更紧凑的形式：
$$
G^{-1} = G_0^{-1} - \Sigma
$$
[戴森方程](@entry_id:146246)是一个非凡的成果。它将一个无穷的[微扰级数](@entry_id:266790)转化为了一个自洽的代数方程（在动量-频率空间中）。它将非相互作用的传播子 $G_0$（裸[传播子](@entry_id:139558)）与包含所有相互作用效应的 $G$（缀饰[传播子](@entry_id:139558)）通过[自能](@entry_id:145608) $\Sigma$ 联系起来 [@problem_id:2989901]。

### 自能的物理内涵：[准粒子](@entry_id:136584)

[戴森方程](@entry_id:146246)提供了一个强大的形式框架，但自能 $\Sigma$ 的物理意义是什么？为了揭示这一点，我们需要考察缀饰格林函数 $G$ 的解析结构，特别是它的极点。格林[函数的极点](@entry_id:189069)对应于系统的[元激发](@entry_id:140859)。对于一个非相互作用的系统，$G_0(\mathbf{k}, \omega) = [\omega - \xi_{\mathbf{k}} + i\delta]^{-1}$ (其中 $\xi_{\mathbf{k}}=\epsilon_{\mathbf{k}}-\mu$) 的极点位于 $\omega = \xi_{\mathbf{k}}$，代表一个能量确定、寿命无限的稳定粒子。

对于相互作用系统，我们需要考察缀饰[推迟格林函数](@entry_id:139183)的极点，其分母为 $\omega - \xi_{\mathbf{k}} - \Sigma^R(\mathbf{k}, \omega)$。自能 $\Sigma^R$ 通常是一个依赖于频率和动量的复函数。极点的位置由方程 $\omega - \xi_{\mathbf{k}} - \Sigma^R(\mathbf{k}, \omega) = 0$ 决定 [@problem_id:2989955]。

*   **能量重整化**：[自能](@entry_id:145608)的**实部** $\mathrm{Re}\Sigma^R$ 导致了[极点位置](@entry_id:271565)的移动。修正后的[激发能](@entry_id:190368)量 $\omega_{\mathbf{k}}^*$ 由方程 $\omega_{\mathbf{k}}^* - \xi_{\mathbf{k}} - \mathrm{Re}\Sigma^R(\mathbf{k}, \omega_{\mathbf{k}}^*) = 0$ 给出。这意味着相互作用改变了粒子的[有效能](@entry_id:139794)量。

*   **有限寿命**：[自能](@entry_id:145608)的**虚部** $\mathrm{Im}\Sigma^R$ 使[极点移动](@entry_id:269721)到复平面。一个非零的虚部意味着激发不再是稳定的，而是会衰减。衰减率（或[谱函数](@entry_id:147628)峰的宽度）正比于 $-\mathrm{Im}\Sigma^R(\mathbf{k}, \omega_{\mathbf{k}}^*)$。这赋予了激发一个**有限的寿命**。

这种被相互作用“缀饰”了的、具有[重整化](@entry_id:143501)能量和有限寿命的激发，被称为**[准粒子](@entry_id:136584) (quasiparticle)**。[准粒子](@entry_id:136584)是理解[多体系统](@entry_id:144006)（如[费米液体](@entry_id:142392)）低能物理的关键概念。

此外，相互作用还会减小[准粒子](@entry_id:136584)态与裸粒子态的交叠。这个效应由**[准粒子权重](@entry_id:140100) (quasiparticle residue)** $Z_{\mathbf{k}}$ 来量化，它与自能的频率导数有关：
$$
Z_{\mathbf{k}} = \left[1 - \left.\frac{\partial \mathrm{Re}\Sigma^{R}(\mathbf{k},\omega)}{\partial \omega}\right|_{\omega=\omega_{\mathbf{k}}^*}\right]^{-1}
$$
$Z_{\mathbf{k}}$ 的值介于 0 和 1 之间，描述了单粒子激发谱在多大程度上仍然保留在[准粒子](@entry_id:136584)峰中。

### 有限温[度理论](@entry_id:636058)：松原形式主义

上述理论可以推广到有限温度 $T>0$ 的情况。这需要引入**松原形式主义 (Matsubara formalism)**，其核心思想是将实[时间演化](@entry_id:153943) $e^{-iHt}$ 替换为[虚时间演化](@entry_id:164452) $e^{-\tau K}$，其中 $\tau \in [0, \beta)$ 是虚时间，$\beta = 1/(k_B T)$，而 $K=H-\mu N$ 是巨正则[哈密顿量](@entry_id:172864) [@problem_id:2989903]。

在虚时形式主义中，[有限温度格林函数](@entry_id:144467)定义为：
$$
G(\tau) = - \langle T_\tau \psi(\tau) \psi^\dagger(0) \rangle
$$
其中 $T_\tau$ 是虚[时间排序算符](@entry_id:148044)。对于[费米子](@entry_id:146235)，由于迹的循环不变性和[费米子算符](@entry_id:149120)的[反对易](@entry_id:186708)性质，可以证明[松原格林函数](@entry_id:199218)满足一个关键的边界条件：**反周期性 (anti-periodicity)** [@problem_id:2989903]。
$$
G(\tau + \beta) = - G(\tau), \quad \text{for } \tau  0
$$
这个反周期性边界条件意味着，当我们将格林函数进行[傅里叶级数](@entry_id:139455)展开时，其频率不是连续的，而是取一系列离散的值，即**费米[松原频率](@entry_id:197724) (fermionic Matsubara frequencies)** [@problem_id:2989903] [@problem_id:2989977]：
$$
\omega_n = \frac{(2n+1)\pi}{\beta}, \quad n \in \mathbb{Z}
$$
与此相对，[玻色子](@entry_id:138266)的格林函数满足[周期性边界条件](@entry_id:147809) $D(\tau+\beta) = D(\tau)$，因此它们的[松原频率](@entry_id:197724)是 $\nu_m = 2m\pi/\beta$。

这一发现使得我们可以建立一套完整的**有限温度[费曼规则](@entry_id:156797)**。以哈伯德模型 ($H_{\mathrm{int}}=U\sum_{i}n_{i\uparrow}n_{i\downarrow}$) 为例 [@problem_id:2989977]：
1.  **传播子线**：每条内部[费米子](@entry_id:146235)线（动量 $\mathbf{k}$，频率 $i\omega_n$）贡献一个因子 $G_0(\mathbf{k}, i\omega_n) = (i\omega_n - \xi_{\mathbf{k}})^{-1}$。
2.  **顶点**：每个相互作用顶点贡献一个因子 $-U$。顶点处，传入和传出的总动量和总[松原频率](@entry_id:197724)守恒。
3.  **求和与积分**：对所有独立的内部动量在[第一布里渊区](@entry_id:269110)内求和（或积分），对所有独立的内部[松原频率求和](@entry_id:194908)，并附带因子 $1/\beta$。
4.  **费米环**：每个闭合的[费米子](@entry_id:146235)环路额外贡献一个因子 $-1$。

这些规则使得在有限温度下进行系统性的微扰计算成为可能。

### 自洽与[守恒近似](@entry_id:139611)

在实际应用中，我们无法对[自能](@entry_id:145608) $\Sigma$ 的所有 1PI 图进行求和。我们必须进行近似，例如只取最低阶的图。一个强大的改进策略是构造**自洽近似 (self-consistent approximations)**。其思想是，在计算[自能](@entry_id:145608) $\Sigma$ 的图时，内部的[传播子](@entry_id:139558)线不再使用裸[传播子](@entry_id:139558) $G_0$，而是使用待求的完整缀饰传播子 $G$ [@problem_id:2989901]。这使得[自能](@entry_id:145608)成为 $G$ 的一个泛函，$\Sigma[G]$，而[戴森方程](@entry_id:146246) $G^{-1} = G_0^{-1} - \Sigma[G]$ 变成了一个需要自洽求解的方程。

然而，这种“缀饰”操作必须小心进行，否则会导致对某些物理过程的重复计算。正确的做法是，在构建 $\Sigma[G]$ 时，只使用那些自身不包含任何[自能修正](@entry_id:754667)的图，这类图被称为**[骨架图](@entry_id:147556) (skeleton diagrams)** [@problem_id:2989901] [@problem_id:2989923]。通过这种方式，[戴森方程](@entry_id:146246)的自洽求解过程会自动且唯一地生成所有高阶的可约图，从而避免了重复计算。

一个更深刻且系统的方法是基于 **Luttinger-Ward 泛函** $\Phi[G]$。这个泛函被定义为所有闭合的、连通的、双粒子不可约的骨架真[空图](@entry_id:275064)之和。它的一个关键性质是，[自能](@entry_id:145608)可以通过对它求泛函导数得到 [@problem_id:2989923]：
$$
\Sigma[G] = \frac{\delta \Phi[G]}{\delta G}
$$
这个关系为系统地构造[自能](@entry_id:145608)提供了一条途径。更重要的是，由 Baym 和 Kadanoff 证明，任何通过这种方式（即从某个泛函 $\Phi_{\text{approx}}[G]$ 派生出来）构造的近似自能，都能保证满足系统的宏观守恒律（如粒子数、动量和[能量守恒](@entry_id:140514)）。这类近似被称为**[守恒近似](@entry_id:139611) (conserving approximations)** [@problem_id:2989901] [@problem_id:2989923]。这为我们选择和构造可靠的[近似方案](@entry_id:267451)提供了坚实的理论依据。

作为一个最简单的例子，对于哈伯德模型，最低阶的 $\Phi[G]$ 对应于一个简单的双环图。对其求泛函导数，我们得到哈特里 (Hartree) 自能，它是一个与动量和频率无关的常数 $\Sigma = U n/2$，其中 $n$ 是粒子密度 [@problem_id:2989946]。这代表了由其他自旋[粒子产生](@entry_id:158755)的[平均场势](@entry_id:158256)，是理解电子关联效应的第一步。更复杂的近似，如包含二阶图的波动交换近似 (fluctuation-exchange approximation, FLEX)，都是建立在这一严谨的自洽与守恒框架之上的。