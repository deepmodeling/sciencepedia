{"hands_on_practices": [{"introduction": "我们从一个基础但至关重要的问题开始，它揭示了虚时格林函数 $G(\\tau)$ 的一个根本性质。这个练习将展示 $G(\\tau)$ 在 $\\tau=0$ 处的间断性如何直接与粒子的量子统计（即费米子或玻色子的对易/反对易关系）联系起来。通过这个推导 [@problem_id:3004451]，你将理解格林函数的形式主义是如何内在地包含了量子力学的基本原理。", "problem": "考虑一个单个费米子模式，其湮灭算符为 $c$，产生算符为 $c^{\\dagger}$，它们满足正则等时反对易关系 $\\{c,c^{\\dagger}\\}=1$。在巨正则系综中进行计算，逆温度为 $\\beta=1/(k_{B}T)$，巨势算符为 $K=H-\\mu N$，其中 $H$ 是哈密顿算符，$\\mu$ 是化学势，$N$ 是粒子数算符。定义虚时海森堡算符 $c(\\tau)=\\exp(\\tau K)\\,c\\,\\exp(-\\tau K)$ 和虚时编时格林函数\n$$\nG(\\tau)=\\langle T_{\\tau}\\,c(\\tau)\\,c^{\\dagger}(0)\\rangle=\\frac{\\mathrm{Tr}\\big[\\exp(-\\beta K)\\,T_{\\tau}\\,c(\\tau)\\,c^{\\dagger}(0)\\big]}{\\mathrm{Tr}\\big[\\exp(-\\beta K)\\big]},\n$$\n其中 $T_{\\tau}$ 是虚时编时算符，$\\langle\\cdots\\rangle$ 表示热平均。\n\n1) 仅从这些定义和正则等时反对易关系出发，推导等时不连续性\n$$\n\\Delta G\\equiv \\lim_{\\epsilon\\to 0^{+}}\\big(G(0^{-})-G(0^{+})\\big)\n$$\n的通用表达式，用等时反对易子的热期望值来表示。\n\n2) 将问题特殊化到一个无相互作用的费米能级，其巨势算符为 $K=\\epsilon\\,c^{\\dagger}c$，其中 $\\epsilon$ 是相对于化学势测量的单粒子能量。在任意有限温度下计算 $\\Delta G$。将你的最终答案表示为一个无单位的实数。", "solution": "我们从第一性原理出发：虚时海森堡算符 $c(\\tau)=\\exp(\\tau K)\\,c\\,\\exp(-\\tau K)$、虚时编时算符 $T_{\\tau}$，以及关于 $\\exp(-\\beta K)$ 定义的热平均 $\\langle\\cdots\\rangle$。\n\n步骤1：在 $\\tau=0$ 处的编时分解和单侧极限。\n对于任意两个费米子算符 $A(\\tau)$ 和 $B(\\tau')$，虚时编时算符的作用方式为\n$$\nT_{\\tau}\\,A(\\tau)\\,B(\\tau')=\\theta(\\tau-\\tau')\\,A(\\tau)\\,B(\\tau')-\\theta(\\tau'-\\tau)\\,B(\\tau')\\,A(\\tau),\n$$\n其中 $\\theta$ 是亥维赛德阶跃函数。将此应用于 $G(\\tau)=\\langle T_{\\tau}\\,c(\\tau)\\,c^{\\dagger}(0)\\rangle$ 得到\n$$\nG(\\tau)=\\theta(\\tau)\\,\\langle c(\\tau)\\,c^{\\dagger}(0)\\rangle-\\theta(-\\tau)\\,\\langle c^{\\dagger}(0)\\,c(\\tau)\\rangle.\n$$\n取极限 $\\tau\\to 0^{+}$ 和 $\\tau\\to 0^{-}$，并利用 $c(\\tau)$ 作为 $\\tau$ 的算符值函数在等时处的连续性，我们得到\n$$\nG(0^{+})=\\langle c(0)\\,c^{\\dagger}(0)\\rangle,\\qquad G(0^{-})=-\\langle c^{\\dagger}(0)\\,c(0)\\rangle.\n$$\n因此，等时不连续性为\n$$\n\\Delta G\\equiv G(0^{-})-G(0^{+})=-\\langle c^{\\dagger}(0)\\,c(0)\\rangle-\\langle c(0)\\,c^{\\dagger}(0)\\rangle=-\\left\\langle \\{c(0),c^{\\dagger}(0)\\}\\right\\rangle.\n$$\n由于热平均是时间平移不变的，并且此处的反对易子是在等时情况下，我们可以更简洁地写成\n$$\n\\Delta G=-\\langle\\{c,c^{\\dagger}\\}\\rangle.\n$$\n\n步骤2：对无相互作用费米能级的计算。\n对于一个巨势算符为 $K=\\epsilon\\,c^{\\dagger}c$ 的单个无相互作用费米能级，正则反对易关系给出了算符恒等式\n$$\n\\{c,c^{\\dagger}\\}=1.\n$$\n取热平均会保持此恒等式不变，因为右边是一个c-数：\n$$\n\\langle\\{c,c^{\\dagger}\\}\\rangle=\\langle 1\\rangle=1.\n$$\n因此，从上面推导的通用表达式可知，\n$$\n\\Delta G=-\\langle\\{c,c^{\\dagger}\\}\\rangle=-1.\n$$\n\n(可选)通过显式热平均进行一致性检验：为了完整起见，可以直接使用 $c(\\tau)=\\exp(-\\epsilon\\tau)\\,c$ 和热平均 $\\langle c^{\\dagger}c\\rangle=f(\\epsilon)$ 及 $\\langle cc^{\\dagger}\\rangle=1-f(\\epsilon)$ 来计算 $G(0^{\\pm})$，其中 $f(\\epsilon)=1/(\\exp(\\beta\\epsilon)+1)$ 是费米-狄拉克分布。于是\n$$\nG(0^{+})=\\langle c\\,c^{\\dagger}\\rangle=1-f(\\epsilon),\\qquad G(0^{-})=-\\langle c^{\\dagger}c\\rangle=-f(\\epsilon),\n$$\n所以\n$$\n\\Delta G=G(0^{-})-G(0^{+})=-f(\\epsilon)-\\big(1-f(\\epsilon)\\big)=-1,\n$$\n与反对易子的结果一致。这证实了对于正则费米子，该不连续性纯粹是运动学的，并且与温度和能级能量无关。", "answer": "$$\\boxed{-1}$$", "id": "3004451"}, {"introduction": "在有限温度理论中，从虚时域变换到松原频率域后，我们经常需要计算无穷的松原频率求和。这个练习 [@problem_id:3004458] 介绍了一种强大而通用的技术——围道积分法，用以处理这类求和。你将亲手计算一个最常见的松原求和，并证明它等于费米-狄拉克分布函数 $n_F(\\epsilon)$，从而掌握一项在实际研究中不可或缺的计算技能。", "problem": "考虑一个能量为 $\\epsilon \\in \\mathbb{R}$ 的无相互作用费米子模式，其处于有限温度 $T$，逆温度为 $\\beta \\equiv 1/(k_B T)$。令 $\\omega_n = (2n+1)\\pi/\\beta$（其中 $n \\in \\mathbb{Z}$）表示费米子松原频率。定义松原求和\n$$\nS(\\epsilon) \\equiv \\frac{1}{\\beta} \\sum_{n=-\\infty}^{\\infty} \\frac{1}{i \\omega_n - \\epsilon} \\, .\n$$\n仅从费米子松原频率和费米-狄拉克分布的定义出发，通过在复平面中进行围线积分来计算 $S(\\epsilon)$。提供一个 $S(\\epsilon)$ 作为 $\\beta$ 和 $\\epsilon$ 函数的闭合形式解析表达式。如果引入任何无穷小收敛因子，请确保其移除是合乎情理的。将最终答案表示为无单位的单个解析表达式。", "solution": "任务是计算松原求和\n$$\nS(\\epsilon) = \\frac{1}{\\beta} \\sum_{n=-\\infty}^{\\infty} \\frac{1}{i \\omega_n - \\epsilon}\n$$\n其中 $\\omega_n = (2n+1)\\pi/\\beta$ 是费米子松原频率（$n \\in \\mathbb{Z}$），$\\epsilon \\in \\mathbb{R}$ 是一个恒定的能量，$\\beta$ 是逆温度。\n\n该求和是条件收敛的，因为对于大的 $|n|$，求和项的行为类似于 $1/n$。为确保结果适定，我们必须引入正则化。标准的物理方案是在无穷小负时间 $\\tau = 0^-$ 处计算时间排序的格林函数，这对应于引入一个收敛因子 $e^{i\\omega_n \\eta}$，其中 $\\eta \\to 0^+$。因此，我们首先计算正则化后的求和：\n$$\nS_{\\eta}(\\epsilon) = \\frac{1}{\\beta} \\sum_{n=-\\infty}^{\\infty} \\frac{e^{i\\omega_n \\eta}}{i \\omega_n - \\epsilon}\n$$\n然后在计算结束时取极限 $\\eta \\to 0^+$。\n\n我们可以将此求和表示为复平面上的一个围线积分。关键是找到一个辅助函数，它在松原频率 $i\\omega_n$ 处有单极点。费米-狄拉克分布函数 $n_F(E) = \\frac{1}{e^{\\beta E} + 1}$，当扩展到复平面上成为 $n_F(z) = \\frac{1}{e^{\\beta z} + 1}$ 时，其极点恰好位于我们需要的位置。$n_F(z)$ 的极点出现在 $e^{\\beta z} + 1 = 0$ 时，这意味着对于任意整数 $k$，$e^{\\beta z} = -1 = e^{i(2k+1)\\pi}$。解为 $z_k = i(2k+1)\\pi/\\beta = i\\omega_k$。这些都是单极点。\n\n让我们为围线积分构造被积函数。考虑函数：\n$$\nf(z) = \\frac{e^{z\\eta}}{z-\\epsilon} n_F(z) = \\frac{e^{z\\eta}}{(z-\\epsilon)(e^{\\beta z} + 1)}\n$$\n此函数 $f(z)$ 的极点是：\n1. 在 $z = \\epsilon$ 处有一个单极点。\n2. 在所有 $n \\in \\mathbb{Z}$ 的费米子松原频率 $z_n = i\\omega_n$ 处有单极点。\n\n我们计算 $f(z)$ 在这些极点处的留数。\n对于在 $z=\\epsilon$ 处的极点：\n$$\n\\text{Res}(f, \\epsilon) = \\lim_{z \\to \\epsilon} (z-\\epsilon) f(z) = \\lim_{z \\to \\epsilon} \\frac{e^{z\\eta}}{e^{\\beta z} + 1} = \\frac{e^{\\epsilon\\eta}}{e^{\\beta\\epsilon}+1} = n_F(\\epsilon) e^{\\epsilon\\eta}\n$$\n对于在 $z_n=i\\omega_n$ 处的极点：\n$n_F(z)$ 在 $z_n$ 处的留数由 $\\lim_{z \\to z_n} (z-z_n) \\frac{1}{e^{\\beta z}+1}$ 给出。对 $0/0$ 型使用洛必达法则（或使用单极点公式 $P(z_n)/Q'(z_n)$），留数为 $\\frac{1}{\\beta e^{\\beta z_n}} = \\frac{1}{\\beta e^{i(2n+1)\\pi}} = -\\frac{1}{\\beta}$。\n因此，$f(z)$ 在 $z_n$ 处的留数为：\n$$\n\\text{Res}(f, i\\omega_n) = \\left. \\frac{e^{z\\eta}}{z-\\epsilon} \\right|_{z=i\\omega_n} \\times \\text{Res}(n_F(z), i\\omega_n) = \\frac{e^{i\\omega_n \\eta}}{i\\omega_n - \\epsilon} \\left(-\\frac{1}{\\beta}\\right)\n$$\n这些留数的总和与我们的目标求和 $S_{\\eta}(\\epsilon)$ 直接相关：\n$$\n\\sum_{n=-\\infty}^{\\infty} \\text{Res}(f, i\\omega_n) = \\sum_{n=-\\infty}^{\\infty} -\\frac{1}{\\beta} \\frac{e^{i\\omega_n \\eta}}{i\\omega_n - \\epsilon} = -S_{\\eta}(\\epsilon)\n$$\n现在，我们应用留数定理。令 $C_R$ 为一个以原点为中心、半径为 $R$ 的圆形围线，其中 $R$ 足够大以包围所有我们关心的极点。该定理指出：\n$$\n\\frac{1}{2\\pi i} \\oint_{C_R} f(z) dz = \\sum_{k} \\text{Res}(f, z_k) = \\text{Res}(f, \\epsilon) + \\sum_{n=-\\infty}^{\\infty} \\text{Res}(f, i\\omega_n)\n$$\n$$\n\\frac{1}{2\\pi i} \\oint_{C_R} f(z) dz = n_F(\\epsilon) e^{\\epsilon\\eta} - S_{\\eta}(\\epsilon)\n$$\n我们必须证明当 $R \\to \\infty$ 时，围线积分消失。令 $z=Re^{i\\theta}$。对于大的 $|z|=R$，我们有 $|z-\\epsilon| \\approx R$。\n被积函数的大小为：\n$$\n|f(z)| \\approx \\frac{|e^{z\\eta}|}{R |e^{\\beta z} + 1|} = \\frac{e^{\\eta R \\cos\\theta}}{R |e^{\\beta R\\cos\\theta}e^{i\\beta R\\sin\\theta} + 1|}\n$$\n我们在复平面的两个部分分析其行为：\n1. 右半平面（$\\text{Re}(z) = R\\cos\\theta > 0$，即 $-\\pi/2  \\theta  \\pi/2$）：当 $R\\to\\infty$ 时，$e^{\\beta R\\cos\\theta}$ 指数增长，因此 $|e^{\\beta z}+1| \\sim e^{\\beta R\\cos\\theta}$。\n$$\n|f(z)| \\sim \\frac{e^{\\eta R \\cos\\theta}}{R e^{\\beta R \\cos\\theta}} = \\frac{1}{R} e^{-(\\beta-\\eta)R\\cos\\theta}\n$$\n由于 $\\eta \\to 0^+$，我们有 $\\beta - \\eta > 0$。由于在此区域 $\\cos\\theta > 0$，指数项导致 $|f(z)|$ 的消失速度远快于 $1/R$。\n2. 左半平面（$\\text{Re}(z) = R\\cos\\theta \\le 0$，即 $\\pi/2 \\le \\theta \\le 3\\pi/2$）：当 $R\\to\\infty$ 时，$e^{\\beta R\\cos\\theta} \\to 0$，因此 $|e^{\\beta z}+1| \\sim 1$。\n$$\n|f(z)| \\sim \\frac{e^{\\eta R \\cos\\theta}}{R}\n$$\n由于在此区域 $\\eta > 0$ 且 $\\cos\\theta \\le 0$，指数项 $e^{\\eta R\\cos\\theta}$ 会指数级快速衰减到零。\n\n在两个半平面中，当 $R\\to\\infty$ 时，被积函数 $|f(z)|$ 的消失速度都快于 $1/R$。围线的长度是 $2\\pi R$。根据 ML 不等式，积分的大小由 $(2\\pi R) \\times \\max_{z \\in C_R} |f(z)|$ 界定，该值趋于零。因此，\n$$\n\\lim_{R\\to\\infty} \\oint_{C_R} f(z) dz = 0\n$$\n根据留数定理，可以得出所有留数的总和必须为零：\n$$\nn_F(\\epsilon) e^{\\epsilon\\eta} - S_{\\eta}(\\epsilon) = 0\n$$\n这给出了正则化后求和的表达式：\n$$\nS_{\\eta}(\\epsilon) = n_F(\\epsilon) e^{\\epsilon\\eta}\n$$\n最后，为了获得原始求和的值，我们通过取极限 $\\eta \\to 0^+$ 来移除正则化。这是一个适定的极限：\n$$\nS(\\epsilon) = \\lim_{\\eta \\to 0^+} S_{\\eta}(\\epsilon) = \\lim_{\\eta \\to 0^+} \\left( n_F(\\epsilon) e^{\\epsilon\\eta} \\right) = n_F(\\epsilon) e^0 = n_F(\\epsilon)\n$$\n代入费米-狄拉克分布的定义，我们得到闭合形式的解析表达式：\n$$\nS(\\epsilon) = \\frac{1}{e^{\\beta\\epsilon}+1}\n$$", "answer": "$$\n\\boxed{\\frac{1}{\\exp(\\beta \\epsilon) + 1}}\n$$", "id": "3004458"}, {"introduction": "最后，我们将所学知识应用于解决一个现代多体物理学中的前沿问题，即动力学平均场理论 (DMFT)。这个练习 [@problem_id:3004474] 聚焦于 DMFT 的核心思想：自洽条件，它巧妙地将一个复杂的格点问题映射为一个可解的杂质模型。通过推导其关键的自洽方程，你将深入理解这种强大方法的理论构造，并为处理强关联电子系统打下坚实基础。", "problem": "考虑在有限温度下晶格上的单带哈伯德模型，该模型使用松原格林函数进行描述。令 $i\\omega_n$ 表示费米子松原频率，其定义为 $i\\omega_n = i(2n+1)\\pi/\\beta$，其中 $n \\in \\mathbb{Z}$，$\\beta$ 为逆温度。局域晶格格林函数 $G_{\\text{loc}}(i\\omega_n)$ 通过对无相互作用态密度 $\\rho(\\epsilon)$ 积分定义：\n$$\nG_{\\text{loc}}(i\\omega_n) = \\int d\\epsilon\\, \\rho(\\epsilon)\\, \\frac{1}{i\\omega_n + \\mu - \\Sigma(i\\omega_n) - \\epsilon},\n$$\n其中 $\\mu$ 是化学势，$\\Sigma(i\\omega_n)$ 是局域自能。\n\n在动力学平均场理论 (DMFT) 中，晶格问题被映射到一个安德森杂质模型，该模型具有外斯场 $G_0(i\\omega_n)$ 和杂化函数 $\\Delta(i\\omega_n)$，它们之间的关系为\n$$\nG_0^{-1}(i\\omega_n) = i\\omega_n + \\mu - \\Delta(i\\omega_n).\n$$\n杂质格林函数 $G_{\\text{imp}}(i\\omega_n)$ 满足杂质戴森方程\n$$\nG_{\\text{imp}}^{-1}(i\\omega_n) = G_0^{-1}(i\\omega_n) - \\Sigma(i\\omega_n).\n$$\nDMFT 自洽条件要求杂质格林函数等于局域晶格格林函数：\n$$\nG_{\\text{imp}}(i\\omega_n) = G_{\\text{loc}}(i\\omega_n).\n$$\n\n仅从上述定义和晶格戴森方程出发，推导 DMFT 自洽条件 $G_{\\text{imp}}(i\\omega_n) = G_{\\text{loc}}(i\\omega_n)$，并说明它如何导出一个用于杂化函数的更新公式：\n$$\n\\Delta(i\\omega_n) = i\\omega_n + \\mu - \\Sigma(i\\omega_n) - \\left[G_{\\text{loc}}(i\\omega_n)\\right]^{-1}.\n$$\n然后，将其特化到具有无限配位数的贝特晶格，其无相互作用态密度为半圆形，半带宽为 $D = 2t$，\n$$\n\\rho(\\epsilon) = \\frac{2}{\\pi D^2} \\sqrt{D^2 - \\epsilon^2}, \\quad |\\epsilon| \\le D,\n$$\n并推导出更新公式简化为\n$$\n\\Delta(i\\omega_n) = t^2\\, G_{\\text{loc}}(i\\omega_n).\n$$\n\n算法任务：实现一个程序，对贝特晶格执行DMFT不动点迭代，并使用哈伯德-I近似作为杂质求解器。在DMFT循环中，对于给定的外斯场 $G_0(i\\omega_n)$，自能 $\\Sigma(i\\omega_n)$ 在半填充（$\\mu = U/2$）时通过以下近似计算：\n$$\n\\Sigma(i\\omega_n) \\approx \\frac{(U/2)G_0^{-1}(i\\omega_n)}{G_0^{-1}(i\\omega_n) - U/2}\n$$\n使用此自能的表达式，并执行以下循环：\n- 对于给定的 $\\beta$、$t$、$U$、$\\mu$ 和松原频率数目 $N_\\omega$，构造集合 $\\{i\\omega_n\\}$。\n- 将所有 $n$ 的 $\\Delta(i\\omega_n)$ 初始化为零。\n- 在每次迭代中，使用从其半圆形态密度和局域自能导出的恒等式计算贝特晶格上的 $G_{\\text{loc}}(i\\omega_n)$，使用通用的 DMFT 公式更新 $\\Delta(i\\omega_n)$，并单独计算 $t^2 G_{\\text{loc}}(i\\omega_n)$。\n- 使用更新后的 $\\Delta(i\\omega_n)$，通过杂质戴森方程计算杂质格林函数 $G_{\\text{imp}}(i\\omega_n)$。\n- 使用线性混合继续迭代，直到所有 $n$ 上 $G_{\\text{imp}}(i\\omega_n)$ 与 $G_{\\text{loc}}(i\\omega_n)$ 之间的最大绝对差值低于容差，并且通用更新与贝特晶格更新（即 $\\Delta(i\\omega_n)$ 与 $t^2 G_{\\text{loc}}(i\\omega_n)$）之间的最大绝对差值也低于同一容差。\n\n数值要求：\n- 完全使用无量纲量进行计算；无需进行物理单位转换。\n- 在适当之处使用复数运算。\n- 为保证稳定性，使用区间 $(0,1)$ 内的线性混合参数。\n- 对两个自洽条件均使用 $10^{-10}$ 的停止容差。\n\n测试套件：\n- 情况1（无相互作用）：$\\beta = 10.0$, $t = 0.5$, $U = 0.0$, $\\mu = 0.0$, $N_\\omega = 64$。\n- 情况2（有相互作用，半填充）：$\\beta = 20.0$, $t = 0.5$, $U = 2.0$, $\\mu = U/2$, $N_\\omega = 64$。\n- 情况3（原子极限）：$\\beta = 50.0$, $t = 0.0$, $U = 2.0$, $\\mu = U/2$, $N_\\omega = 64$。\n\n对于每个测试用例，您的程序必须输出两个浮点数：\n1. 收敛后，$G_{\\text{imp}}(i\\omega_n)$ 与 $G_{\\text{loc}}(i\\omega_n)$ 在所有 $n$ 上的最大绝对差值。\n2. 收敛后，通用 DMFT 更新 $\\Delta(i\\omega_n)$ 与贝特晶格更新 $t^2 G_{\\text{loc}}(i\\omega_n)$ 在所有 $n$ 上的最大绝对差值。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用逗号分隔的列表，内有六个浮点数，按测试用例的顺序排列，每个用例贡献两个数字，并用方括号括起来。例如，\"[r11,r12,r21,r22,r31,r32]\"。", "solution": "该问题要求两部分回应：动力学平均场理论 (DMFT) 中关键方程的理论推导，以及针对特定模型的 DMFT 自洽循环的算法实现。\n\n### 理论推导\n\n首先，我们推导问题中定义的格林函数、自能和杂化函数之间的关系。\n\n1.  **通用杂化函数更新公式的推导**\n\nDMFT 框架将晶格问题映射到一个等效的量子杂质问题，该问题必须自洽求解。这种联系是通过一组定义建立的。\n\n辅助杂质模型由其无相互作用格林函数（外斯场）$G_0(i\\omega_n)$ 定义，该函数由杂化函数 $\\Delta(i\\omega_n)$ 构建：\n$$\nG_0^{-1}(i\\omega_n) = i\\omega_n + \\mu - \\Delta(i\\omega_n)\n$$\n这里，$i\\omega_n = i(2n+1)\\pi/\\beta$ 是费米子松原频率，$\\mu$ 是化学势，$\\beta$ 是逆温度。\n\n杂质模型的相互作用格林函数 $G_{\\text{imp}}(i\\omega_n)$ 通过杂质戴森方程与 $G_0(i\\omega_n)$ 和杂质自能 $\\Sigma(i\\omega_n)$ 相关联：\n$$\nG_{\\text{imp}}^{-1}(i\\omega_n) = G_0^{-1}(i\\omega_n) - \\Sigma(i\\omega_n)\n$$\n将 $G_0^{-1}(i\\omega_n)$ 的定义代入戴森方程，得到杂质模型各量之间的直接关系：\n$$\nG_{\\text{imp}}^{-1}(i\\omega_n) = i\\omega_n + \\mu - \\Delta(i\\omega_n) - \\Sigma(i\\omega_n)\n$$\nDMFT 的核心原则是自洽条件，该条件要求局域晶格格林函数 $G_{\\text{loc}}(i\\omega_n)$ 与杂质格林函数相同：\n$$\nG_{\\text{loc}}(i\\omega_n) = G_{\\text{imp}}(i\\omega_n)\n$$\n通过施加这个条件，我们可以在前一个方程中用 $G_{\\text{loc}}(i\\omega_n)$ 替换 $G_{\\text{imp}}(i\\omega_n)$：\n$$\nG_{\\text{loc}}^{-1}(i\\omega_n) = i\\omega_n + \\mu - \\Delta(i\\omega_n) - \\Sigma(i\\omega_n)\n$$\n此方程定义了自洽关系。为了推导杂化函数 $\\Delta(i\\omega_n)$ 的更新公式（这是自洽循环的目标），我们重排方程以求解 $\\Delta(i\\omega_n)$：\n$$\n\\Delta(i\\omega_n) = i\\omega_n + \\mu - \\Sigma(i\\omega_n) - G_{\\text{loc}}^{-1}(i\\omega_n)\n$$\n这是任何 DMFT 计算中杂化函数的通用更新公式。自洽循环涉及猜测一个 $\\Delta$，求解杂质模型得到 $\\Sigma$，计算相应的 $G_{\\text{loc}}$，然后使用此公式找到一个新的 $\\Delta$，并迭代直至收敛。\n\n2.  **贝特晶格的推导**\n\n对于具有半圆形态密度 (DOS) 的晶格，这是无限配位数极限下贝特晶格的特征，局域格林函数的计算得以简化。态密度由 $\\rho(\\epsilon) = \\frac{2}{\\pi D^2} \\sqrt{D^2 - \\epsilon^2}$ 给出，其中 $|\\epsilon| \\le D$，半带宽为 $D=2t$。\n\n局域晶格格林函数由态密度的希尔伯特变换定义：\n$$\nG_{\\text{loc}}(i\\omega_n) = \\int_{-D}^{D} d\\epsilon \\, \\rho(\\epsilon) \\, \\frac{1}{z - \\epsilon} = \\int_{-D}^{D} d\\epsilon \\, \\frac{2}{\\pi D^2} \\sqrt{D^2 - \\epsilon^2} \\, \\frac{1}{z - \\epsilon}\n$$\n其中 $z = i\\omega_n + \\mu - \\Sigma(i\\omega_n)$。这是一个复分析中的标准积分，其值为：\n$$\nG_{\\text{loc}}(z) = \\frac{2}{D^2} \\left( z - \\sqrt{z^2 - D^2} \\right)\n$$\n选择平方根的分支，使得当 $|z|$ 很大时，$G_{\\text{loc}}(z) \\sim 1/z$，这对应于确保 $\\sqrt{z^2 - D^2}$ 的虚部与 $z$ 的虚部符号相同。\n\n这个方程可以通过代数方法反转，以 $G_{\\text{loc}}$ 表示 $z$：\n$$\n\\frac{D^2}{2} G_{\\text{loc}} = z - \\sqrt{z^2 - D^2} \\implies z - \\frac{D^2}{2} G_{\\text{loc}} = \\sqrt{z^2-D^2}\n$$\n两边平方得到：\n$$\nz^2 - z D^2 G_{\\text{loc}} + \\frac{D^4}{4} G_{\\text{loc}}^2 = z^2 - D^2\n$$\n$$\n-z D^2 G_{\\text{loc}} + \\frac{D^4}{4} G_{\\text{loc}}^2 = -D^2 \\implies z G_{\\text{loc}} = 1 + \\frac{D^2}{4} G_{\\text{loc}}^2\n$$\n$$\nz = G_{\\text{loc}}^{-1} + \\frac{D^2}{4} G_{\\text{loc}}\n$$\n将定义 $z = i\\omega_n + \\mu - \\Sigma(i\\omega_n)$ 和 $D=2t$ 代回：\n$$\ni\\omega_n + \\mu - \\Sigma(i\\omega_n) = G_{\\text{loc}}^{-1}(i\\omega_n) + t^2 G_{\\text{loc}}(i\\omega_n)\n$$\n现在我们使用之前推导的 $\\Delta(i\\omega_n)$ 的通用更新公式：\n$$\n\\Delta(i\\omega_n) = i\\omega_n + \\mu - \\Sigma(i\\omega_n) - G_{\\text{loc}}^{-1}(i\\omega_n)\n$$\n代入贝特晶格特有的 $(i\\omega_n + \\mu - \\Sigma(i\\omega_n))$ 表达式，得到：\n$$\n\\Delta(i\\omega_n) = \\left( G_{\\text{loc}}^{-1}(i\\omega_n) + t^2 G_{\\text{loc}}(i\\omega_n) \\right) - G_{\\text{loc}}^{-1}(i\\omega_n)\n$$\n$$\n\\Delta(i\\omega_n) = t^2 G_{\\text{loc}}(i\\omega_n)\n$$\n这个非常简单的关系是贝特晶格上 DMFT 的一个关键结果。它提供了从局域格林函数直接更新杂化函数的方法，从而简化了自洽循环。\n\n### 算法实现\n\n任务是实现一个 DMFT 不动点迭代。任何 DMFT 循环的核心是“杂质求解器”，这是一个为给定的外斯场 $G_0$ 计算自能 $\\Sigma$ 的过程。\n\n**哈伯德-I 杂质求解器**\n\n问题指定使用哈伯德-I 近似作为杂质求解器。为了在 DMFT 循环中实现自洽，我们将哈伯德-I 近似视为一个依赖于外斯场 $G_0$ 的自能泛函。在半填充（$\\mu=U/2$）时，自能的计算公式在问题中已直接给出：\n$$\n\\Sigma(i\\omega_n) \\approx \\frac{(U/2)G_0^{-1}(i\\omega_n)}{G_0^{-1}(i\\omega_n) - U/2}\n$$\n这个 $\\Sigma$ 的表达式依赖于 $G_0$，因此也依赖于 $\\Delta$，使其成为自洽 DMFT 循环的合适候选。\n\n**自洽循环**\n\n算法流程如下：\n1.  **初始化**：对于给定的参数（$\\beta, t, U, \\mu, N_\\omega$），构建松原频率数组 $i\\omega_n$。将杂化函数数组 $\\Delta(i\\omega_n)$ 初始化为零。\n2.  **迭代**：重复执行直至满足收敛标准：\n    a.  **计算外斯场**：根据当前的杂化函数 $\\Delta_k$，计算外斯场 $G_{0,k}^{-1}(i\\omega_n) = i\\omega_n + \\mu - \\Delta_k(i\\omega_n)$。\n    b.  **杂质求解器 (哈伯德-I)**：使用问题中给出的、以 $G_{0,k}^{-1}$ 作为输入的哈伯德-I 公式计算自能 $\\Sigma_k(i\\omega_n)$。\n    c.  **计算局域格林函数**：使用贝特晶格公式和刚刚计算出的自能 $\\Sigma_k(i\\omega_n)$ 来计算晶格格林函数 $G_{\\text{loc},k}(i\\omega_n)$。\n    d.  **更新杂化函数**：使用简化的贝特晶格关系找到新的杂化函数 $\\Delta_{\\text{new}}(i\\omega_n)$：$\\Delta_{\\text{new}}(i\\omega_n) = t^2 G_{\\text{loc},k}(i\\omega_n)$。\n    e.  **混合**：为确保稳定收敛，下一次迭代的杂化函数是旧值和新值的线性混合：$\\Delta_{k+1} = (1-\\alpha)\\Delta_k + \\alpha \\Delta_{\\text{new}}$，其中 $\\alpha \\in (0,1)$ 是一个混合参数。\n3.  **收敛性检查**：每次更新 $\\Delta$ 后，我们计算问题要求的用于收敛性检查的量：\n    a.  当前的杂质格林函数计算为 $G_{\\text{imp},k+1}^{-1} = i\\omega_n + \\mu - \\Delta_{k+1} - \\Sigma_k$。注意，$\\Sigma_k$ 来自当前步骤，而不是用 $\\Delta_{k+1}$ 重新计算的。\n    b.  第一个误差是与自洽性的偏差：$\\max_n |G_{\\text{imp},k+1}(i\\omega_n) - G_{\\text{loc},k}(i\\omega_n)|$。\n    c.  第二个误差验证贝特晶格推导的一致性。我们计算“通用”更新 $\\Delta_{\\text{general}} = i\\omega_n + \\mu - \\Sigma_k - G_{\\text{loc},k}^{-1}$，并将其与“贝特”更新 $\\Delta_{\\text{Bethe}} = t^2 G_{\\text{loc},k}$ 进行比较。误差为 $\\max_n |\\Delta_{\\text{general}}(i\\omega_n) - \\Delta_{\\text{Bethe}}(i\\omega_n)|$。\n4.  **终止**：当两个误差指标都低于指定的容差 $10^{-10}$ 时，循环终止。报告这两个误差的最终值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DMFT problem for the Bethe lattice using the Hubbard-I approximation.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (non-interacting)\n        {'beta': 10.0, 't': 0.5, 'U': 0.0, 'mu': 0.0, 'Nw': 64},\n        # Case 2 (interacting, half filling)\n        {'beta': 20.0, 't': 0.5, 'U': 2.0, 'mu': 1.0, 'Nw': 64},\n        # Case 3 (atomic limit)\n        {'beta': 50.0, 't': 0.0, 'U': 2.0, 'mu': 1.0, 'Nw': 64},\n    ]\n\n    results = []\n    \n    # Parameters for the iterative solver\n    max_iter = 2000\n    tolerance = 1e-10\n    mixing_alpha = 0.5\n\n    for params in test_cases:\n        beta = params['beta']\n        t = params['t']\n        U = params['U']\n        mu = params['mu']\n        Nw = params['Nw']\n\n        # Construct Matsubara frequencies i*omega_n\n        n_matsubara = np.arange(Nw)\n        omega_n = (2 * n_matsubara + 1) * np.pi / beta\n        iwn = 1j * omega_n\n\n        # Initialize hybridization function Delta(i*omega_n)\n        delta = np.zeros(Nw, dtype=complex)\n        \n        err1, err2 = 1.0, 1.0 # Initialize errors\n        converged = False\n\n        for i in range(max_iter):\n            # 1. Compute Weiss field G_0^{-1}\n            g0_inv = iwn + mu - delta\n\n            # 2. Impurity Solver: Hubbard-I approximation for Sigma\n            # At half-filling, mu = U/2, this is Sigma = (U/2) * G0_inv / (G0_inv - U/2)\n            # Handle U=0 case to avoid division by zero\n            if U == 0:\n                sigma = np.zeros(Nw, dtype=complex)\n            else:\n                sigma = (U / 2.0) * g0_inv / (g0_inv - U / 2.0)\n            \n            # 3. Compute local lattice Green's function G_loc for Bethe lattice\n            D = 2.0 * t\n            z = iwn + mu - sigma\n\n            # Handle t=0 (atomic limit) separately\n            if t == 0:\n                g_loc = 1.0 / z\n            else:\n                # Square root with branch choice: Im(sqrt) must have same sign as Im(z)\n                sqrt_arg = z**2 - D**2\n                sqrt_val = np.sqrt(sqrt_arg)\n                \n                # Enforce correct branch cut choice for G_loc\n                # Im[G_loc(iwn)] must be  0 for wn  0.\n                # G_loc = (2/D^2)*(z - sqrt(z^2-D^2)).\n                # For large z=iwn, G_loc ~ 1/z = -i/wn. So Im(G_loc)  0.\n                # To get this, Im(z - sqrt) must be  0.\n                # Im(z)  0 for wn  0. So we need Im(sqrt)  0.\n                fix_sign = (np.imag(z) * np.imag(sqrt_val))  0\n                sqrt_val[fix_sign] *= -1\n\n                g_loc = (2.0 / D**2) * (z - sqrt_val)\n\n            # 4. Update hybridization function Delta\n            # Using the simplified Bethe lattice formula\n            delta_new = t**2 * g_loc\n\n            # 5. Linear mixing for stability\n            delta = (1.0 - mixing_alpha) * delta + mixing_alpha * delta_new\n            \n            # --- Convergence checks ---\n            # These checks are performed after one update step as per problem description.\n            # a. Compute G_imp using the *newly mixed* delta and *old* sigma\n            g_imp_inv = iwn + mu - delta - sigma\n            g_imp = 1.0 / g_imp_inv\n            err1 = np.max(np.abs(g_imp - g_loc))\n            \n            # b. Check consistency of the two Delta update formulas\n            # Delta_general = z - G_loc^{-1}\n            # Delta_bethe = t^2 * G_loc\n            if t == 0:\n                delta_general = np.zeros(Nw, dtype=complex)\n            else:\n                delta_general = z - 1.0 / g_loc\n            \n            delta_bethe = t**2 * g_loc\n            err2 = np.max(np.abs(delta_general - delta_bethe))\n\n            if err1  tolerance and err2  tolerance:\n                converged = True\n                break\n        \n        if not converged:\n             # In a real scenario, one might raise an error.\n             # Here, we just report the last computed errors.\n             pass\n\n        results.extend([err1, err2])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3004474"}]}