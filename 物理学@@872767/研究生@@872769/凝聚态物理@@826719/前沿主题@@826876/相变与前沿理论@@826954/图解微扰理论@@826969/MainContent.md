## 引言
在量子多体物理的宏大叙事中，直接求解包含复杂相互作用的薛定谔方程是一项几乎无法完成的挑战。为了揭示电子、[声子](@entry_id:140728)等[准粒子](@entry_id:136584)在材料中的集体行为，图表微扰理论应运而生。它以其直观的费曼图语言和严谨的数学框架，将复杂的量子过程转化为可系统计算的项，成为了现代凝聚态物理与[量子化学](@entry_id:140193)研究的理论基石。然而，其形式体系的复杂性和概念的抽象性，为学习者带来了显著的知识鸿沟。本文旨在弥合这一鸿沟，为读者提供一条从基本原理到前沿应用的清晰路径。

我们将通过以下章节逐步深入。**“原理与机制”**一章将奠定理论基础，从[格林函数](@entry_id:147802)的定义出发，系统介绍[费曼图](@entry_id:144373)规则、[戴森方程](@entry_id:146246)及自洽近似等核心概念。接下来，**“应用与跨学科连接”**一章将展示理论的威力，探讨其如何解释屏蔽效应、[量子输运](@entry_id:138932)和超导现象，并揭示其与DMFT、[GW近似](@entry_id:140388)等方法的深刻联系。最后，**“动手实践”**部分将通过具体的计算问题，巩固并深化读者的理解。

现在，让我们正式踏上这段旅程，深入探索图表微扰理论的原理与机制。

## 原理与机制

在引言章节之后，我们现在深入探讨图表[微扰理论](@entry_id:138766)的核心原理与机制。本章将系统地建立该理论的形式体系，从[格林函数](@entry_id:147802)的基本定义开始，逐步构建费曼图、[戴森方程](@entry_id:146246)和自洽理论的框架，并最终延伸至非平衡系统和非微扰方法等前沿领域。

### 基本研究对象：[格林函数](@entry_id:147802)及其性质

在多体物理中，我们很少能直接求解系统的完整[波函数](@entry_id:147440)。取而代之，我们关注更为 tractable 且与实验[可观测量](@entry_id:267133)直接相关的物理量——**格林函数 (Green's functions)**。它们描述了在系统中添加或移除一个粒子后，该粒子在不同时空点之间传播的量子力学振幅。

#### 虚时[格林函数](@entry_id:147802)（[松原格林函数](@entry_id:199218)）

在平衡态[统计力](@entry_id:194984)学中，特别是在有限温度下，使用**虚时形式主义 (imaginary-time formalism)** 或称**松原形式主义 (Matsubara formalism)** 尤为方便。对于一个处于[巨正则系综](@entry_id:141562)中的[费米子](@entry_id:146235)系统，其[哈密顿量](@entry_id:172864)为 $H$，[粒子数算符](@entry_id:153568)为 $N$，化学势为 $\mu$，[逆温](@entry_id:140086)度为 $\beta = 1/(k_B T)$，我们可以定义虚时格林函数。

体系的演化不再由[哈密顿量](@entry_id:172864) $H$ 主导，而是由巨正则[哈密顿量](@entry_id:172864) $K = H - \mu N$ 决定，后者也决定了[热力学](@entry_id:141121)权重 $e^{-\beta K}$。一个算符 $c_{\mathbf{x}}$ 的虚时[海森堡绘景](@entry_id:141162)演化由下式给出：
$c_{\mathbf{x}}(\tau) = e^{\tau K} c_{\mathbf{x}} e^{-\tau K}$。

[费米子](@entry_id:146235)的单粒子虚时格林函数定义为：
$$
G(\mathbf{x}, \tau) = - \langle T_{\tau}\, c_{\mathbf{x}}(\tau)\, c_{\mathbf{0}}^{\dagger}(0) \rangle
$$
其中，$\langle \cdot \rangle = Z^{-1} \mathrm{Tr}[ e^{-\beta K} \cdot ]$ 表示在[巨正则系综](@entry_id:141562)下的热平均，$Z = \mathrm{Tr}[ e^{-\beta K} ]$ 是[巨配分函数](@entry_id:154455)。$T_{\tau}$ 是**虚时编序算符 (imaginary-time ordering operator)**，它将算符按照虚时 $\tau$ 的大小降序[排列](@entry_id:136432)。对于[费米子](@entry_id:146235)，每次[交换算符](@entry_id:156554)位置都需要引入一个 $-1$ 的因子，这体现了[泡利不相容原理](@entry_id:141850)。

利用[迹的循环性质](@entry_id:153103)，可以证明[费米子](@entry_id:146235)格林函数在虚时区间 $(-\beta, \beta)$ 内具有**反周期性 (anti-periodicity)**：
$$
G(\mathbf{x}, \tau) = - G(\mathbf{x}, \tau + \beta) \quad (\text{当 } -\beta  \tau  0 \text{ 时})
$$
这个反周期边界条件意味着，当我们将[格林函数](@entry_id:147802)进行[傅里叶变换](@entry_id:142120)到频率域时，其频率不是连续的，而是取一系列离散的**[费米子](@entry_id:146235)[松原频率](@entry_id:197724) (fermionic Matsubara frequencies)**：
$$
\omega_n = \frac{(2n + 1)\pi}{\beta}, \quad n \in \mathbb{Z}
$$
这使得我们可以在频率-动量空间中进行代数运算，极大地简化了计算。

#### 实时格林函数与[解析延拓](@entry_id:147225)

虽然虚时格林函数在计算上很方便，但它并不直接对应于通常的实验可观测量，如输运系数或[谱函数](@entry_id:147628)。这些量与**实时格林函数 (real-time Green's functions)** 相关，后者描述了在真实时间 $t$ 中的演化。其中最重要的是**[推迟格林函数](@entry_id:139183) ([retarded Green's function](@entry_id:139183))** $G^R$ 和**超前[格林函数](@entry_id:147802) (advanced Green's function)** $G^A$。

对于[费米子](@entry_id:146235)系统，[推迟格林函数](@entry_id:139183)定义为：
$$
G^{R}(\mathbf{x}, t) = -i \, \theta(t) \, \langle \{ c_{\mathbf{x}}(t), c_{\mathbf{0}}^{\dagger}(0) \} \rangle
$$
其中，$\{A, B\} = AB + BA$ 是[反对易子](@entry_id:139754)，$\theta(t)$ 是赫维赛德[阶跃函数](@entry_id:159192)，它保证了函数的**因果性 (causality)**——响应（在 $t$ 时刻）不能发生在其原因（在 $0$ 时刻）之前。与虚时格林函数的编序定义不同，这里的因果性是由 $\theta(t)$ 显式强制执行的。[实时演化](@entry_id:199067)由[哈密顿量](@entry_id:172864) $H$ 生成：$c_{\mathbf{x}}(t) = e^{iHt} c_{\mathbf{x}} e^{-iHt}$。

这两种[格林函数](@entry_id:147802)之间存在深刻的联系。[推迟格林函数](@entry_id:139183)在[复频率](@entry_id:266400)平面的[上半平面](@entry_id:199119)是解析的。这一[解析性](@entry_id:140716)质允许我们通过**[解析延拓](@entry_id:147225) (analytic continuation)** 的手续，从在离散[虚频](@entry_id:165180)率轴上计算得到的[松原格林函数](@entry_id:199218) $G(\mathbf{k}, i\omega_n)$ 得到在实频率轴上的[推迟格林函数](@entry_id:139183) $G^R(\mathbf{k}, \omega)$：
$$
G^R(\mathbf{k}, \omega) = G(\mathbf{k}, i\omega_n \to \omega + i\eta)
$$
其中 $\eta$ 是一个无穷小的正数。这个关系是连接理论计算和实验测量的桥梁。

### [微扰展开](@entry_id:159275)与费曼图

当系统中存在相互作用 $H_{\mathrm{int}}$ 时，格林函数通常无法精确求解。[微扰理论](@entry_id:138766)提供了一个系统性的方法，将相互作用的效应展开为一系列可以计算的项。这一展开的优美之处在于，每一项都可以用一个直观的图形——**[费曼图](@entry_id:144373) (Feynman diagram)** ——来表示。

#### 图的构建：[威克定理](@entry_id:137086)与[对称因子](@entry_id:274828)

在[相互作用绘景](@entry_id:198213)中，[格林函数](@entry_id:147802)可以表示为对非相互作用[基态](@entry_id:150928)（或系综）求平均的相互作用算符的编时乘积。计算这些平均值的核心工具是**[威克定理](@entry_id:137086) (Wick's theorem)**。该定理指出，一串产生和[湮灭算符](@entry_id:165390)的编时乘积的[真空期望值](@entry_id:146340)，等于所有可能的两两**收缩 (contraction)** 的组合之和。每个收缩对应于一个非相互作用的格林函数 $G_0$，即[传播子](@entry_id:139558)。

在图上，传播子 $G_0$ 表示为一条线，而相互作用 $H_{\mathrm{int}}$ 中的算符组合表示为一个**顶点 (vertex)**。通过[威克定理](@entry_id:137086)将所有顶点上的算符腿（代表[场算符](@entry_id:140269)）两两连接，我们就生成了所有可能的[费曼图](@entry_id:144373)。

一个给定的图在[微扰展开](@entry_id:159275)中的权重由其**[对称因子](@entry_id:274828) (symmetry factor)** 决定。这个因子是一个纯组[合数](@entry_id:263553)，它源于对展开式中等价项的合并。其计算需要考虑三个来源：
1.  来[自相互作用](@entry_id:201333)指数展开的 $1/n!$ 因子。
2.  来自相互作用项本身的组合因子，例如 $\lambda/4! \phi^4$ 中的 $1/4!$。
3.  能够产生同一**拓扑结构 (topologically distinct diagram)** 的等价威克收缩的数量。

一个拓扑上不同的图是指其顶点和线的连接方式是独特的，与线上具体的时空标签或等价线的[排列](@entry_id:136432)无关。例如，对于一个具有 $\lambda/4! \phi^4$ 相互作用的[玻色子](@entry_id:138266)理论，其一阶真空修正来自于对单个顶点上四个场的收缩。共有 3 种不同的配对方式，它们都产生同一个“8”字形的双圈图。结合来自作用量中的 $1/4!$ 因子，该图的[对称因子](@entry_id:274828)为 $S = 3 / 4! = 1/8$。

### 关联图与[非关联图](@entry_id:192455)：链接团簇定理

在[微扰展开](@entry_id:159275)中，我们会生成各种各样的图。这些图可以分为两大类：**关联图 (connected diagrams)** 和**[非关联图](@entry_id:192455) (disconnected diagrams)**。一个图如果可以被分成两个或多个没有[传播子](@entry_id:139558)相连的部分，它就是非关联的。

一个看似复杂的问题是，在计算物理量时是否需要考虑无穷多的[非关联图](@entry_id:192455)。幸运的是，**链接团簇定理 (Linked-Cluster Theorem)** 优雅地解决了这个问题。该定理可以通过[生成泛函](@entry_id:152688)的形式简洁地表述。定义[配分函数](@entry_id:193625)的[生成泛函](@entry_id:152688) $Z[J, \bar{J}]$ 和关联[格林函数](@entry_id:147802)的[生成泛函](@entry_id:152688) $W[J, \bar{J}]$，它们的关系是：
$$
Z[J, \bar{J}] = \exp(W[J, \bar{J}])
$$
这意味着，完整的[配分函数](@entry_id:193625)（包含所有图）是关联图之和的指数。物理上更重要的是热力学势，例如[巨热力学势](@entry_id:136286) $\Omega = -\beta^{-1} \ln Z$。根据上述关系，$\Omega$ 直接正比于 $W[0,0]$，即所有**关联真[空图](@entry_id:275064) (connected vacuum diagrams)** 之和。

这个定理有两大重要推论：
1.  **[热力学](@entry_id:141121)量的[广延性](@entry_id:144932)**：由于每个关联真[空图](@entry_id:275064)的贡献都正比于时空体积 $V\beta$，$\Omega$ 也将正比于体积 $V$，这保证了[热力学](@entry_id:141121)量的[广延性](@entry_id:144932)。如果 $\Omega$ 包含[非关联图](@entry_id:192455)的贡献（如两个关联[图的乘积](@entry_id:269799)，其贡献正比于 $V^2$），[广延性](@entry_id:144932)将被破坏。
2.  **[物理可观测量](@entry_id:154692)与关联函数**：物理可观测量，如磁化率或[电导](@entry_id:177131)，通常由对热力学势对外场求导得到。由于 $\Omega \propto W = \ln Z$，这些导数自然地只与关联[格林函数](@entry_id:147802)（也称为**累积量 (cumulants)**）相关。所有非关联的部分，尤其是与外部探针无关的“真空泡沫”图，在归一化的[格林函数](@entry_id:147802)中被系统地约掉。

我们可以通过一个具体的例子来验证[非关联图](@entry_id:192455)的消除。考虑 Hubbard 模型二阶[微扰展开](@entry_id:159275)中的自由能。展开 $Z$ 会得到关联图和[非关联图](@entry_id:192455)（例如，两个一阶“牡蛎”图的组合）。然而，当我们计算 $\ln Z$ 时，$\ln(1+x) = x - x^2/2 + \dots$ 展开式中的二次项 $-(\delta Z^{(1)})^2/2$ 会精确地抵消掉 $Z$ 的二阶展开中由两个一阶图组成的非关联部分。最终，$\ln Z$ 的二阶贡献恰好只剩下所有二阶关联图之和，这明确地展示了链接团簇定理的威力。

### [戴森方程](@entry_id:146246)与[自能](@entry_id:145608)

对于[单粒子格林函数](@entry_id:140400) $G$ 的[微扰展开](@entry_id:159275)，我们可以根据图的拓扑结构进行一次极其重要的重组。我们将所有关联图分为**单粒子可约 (one-particle-reducible, 1PR)** 和**单粒子不可约 (one-particle-irreducible, 1PI)** 两类。如果一个两点图（描述[格林函数](@entry_id:147802)的图）可以通过切断一条内部[传播子](@entry_id:139558)线而分成两个不相连的部分，那么它就是 1PR 的；反之则为 1PI。

**[自能](@entry_id:145608) (self-energy)** $\Sigma$ 被定义为所有 1PI 图之和（并切除掉外腿）。它概括了粒子在传播过程中受到的所有不可简化的相互作用效应。

有了这个定义，完整的格林函数 $G$ 可以表示为一个几何级数之和：
$$
G = G_0 + G_0 \Sigma G_0 + G_0 \Sigma G_0 \Sigma G_0 + \dots
$$
这个级数可以被求和，得到一个简洁的代数方程——**[戴森方程](@entry_id:146246) (Dyson equation)**：
$$
G = G_0 + G_0 \Sigma G
$$
或者写成更紧凑的形式 $G^{-1} = G_0^{-1} - \Sigma$。这个方程的意义在于，它将复杂的[微扰展开](@entry_id:159275)重组了：完整的[格林函数](@entry_id:147802) $G$ 是由非相互作用的格林函数 $G_0$ 和代表所有不可约相互作用的[自能](@entry_id:145608) $\Sigma$ 自洽地决定的。所有 1PR 的图都已经被[戴森方程](@entry_id:146246)的迭代结构自动包含了。因此，为了避免**重复计数 (double counting)**，[自能](@entry_id:145608) $\Sigma$ 的定义中**必须**只包含 1PI 图。

### 自洽微扰理论与[守恒近似](@entry_id:139611)

[戴森方程](@entry_id:146246)为我们开辟了一条超越简单微扰论的道路。我们可以构建**自洽的 (self-consistent)** 近似。

#### [骨架图](@entry_id:147556)与重复计数问题

在标准的（非自洽）微扰论中，我们用非相互作用的传播子 $G_0$ 来计算自能图，得到 $\Sigma[G_0]$。然而，一个更强大的方法是，将自能表达为**完整**[格林函数](@entry_id:147802) $G$ 的泛函，即 $\Sigma[G]$，然后求[解耦](@entry_id:637294)合的[戴森方程](@entry_id:146246) $G^{-1} = G_0^{-1} - \Sigma[G]$。

这里的关键是如何构造 $\Sigma[G]$ 以避免重复计数。如果我们简单地取所有 1PI 图，并将里面的 $G_0$ 全部替换为 $G$，就会导致严重的重复计数。因为 $G$ 本身已经包含了[自能修正](@entry_id:754667)，这样做等于在已经修正过的[传播子](@entry_id:139558)上再次添加修正。

正确的做法是，只用所谓的**[骨架图](@entry_id:147556) (skeleton diagrams)** 来构造 $\Sigma[G]$。[骨架图](@entry_id:147556)是那些自身内部不包含任何[自能修正](@entry_id:754667)的 1PI 图。换句话说，[骨架图](@entry_id:147556)在拓扑上是“裸露”的，但其内部的传播子线已经是被“穿好衣服”的完整 $G$。通过这种方式，[戴森方程](@entry_id:146246)的迭代过程会以一种受控的方式将所有可能的[自能](@entry_id:145608)插入到每一条[传播子](@entry_id:139558)线中，从而不多不少地生成完整的[微扰级数](@entry_id:266790)中的每一个拓扑结构。

#### Luttinger-Ward 泛函与[守恒近似](@entry_id:139611)

如何系统地得到满足物理守恒律（如粒子数、动量和[能量守恒](@entry_id:140514)）的自洽近似？答案在于 **Luttinger-Ward 泛函** $\Phi[G]$。这个泛函被定义为所有闭合的、关联的、**二粒子不可约 (two-particle-irreducible, 2PI)** 骨架真[空图](@entry_id:275064)之和，其中内部线是完整的 $G$。

该理论的惊人之处在于，与此 $\Phi[G]$ 对应的自洽自能可以通过泛函求导得到：
$$
\Sigma[G] = \frac{\delta \Phi[G]}{\delta G}
$$
基于这种方式（称为“$\Phi$-可导”理论）构建的任何近似，只要通过求解[戴森方程](@entry_id:146246)达到自洽，就能够自动满足宏观守恒律。这些近似被称为**[守恒近似](@entry_id:139611) (conserving approximations)**。因此，Luttinger-Ward 形式主义不仅为避免重复计数提供了严格的数学框架，还保证了近似理论的物理一致性。

### [对称性与守恒律](@entry_id:160300)：[沃德-高桥恒等式](@entry_id:145721)

物理系统的对称性会在[格林函数](@entry_id:147802)之间施加严格的约束，这些约束称为**[沃德-高桥恒等式](@entry_id:145721) (Ward-Takahashi Identities, WTI)**。它们是图表理论内部自洽性的重要检验。

以电荷守恒为例，它源于全局 U(1) 规范不变性。这一对称性导致了[单粒子格林函数](@entry_id:140400)和三点**[顶点函数](@entry_id:145137) (vertex function)** $\Gamma$ 之间的一个精确关系。在静态、长波极限下 ($q \to 0, \Omega = 0$)，该恒等式可以简化为：
$$
\mathbf{\Gamma}(\mathbf{k}, i\omega) = \nabla_{\mathbf{k}} G^{-1}(\mathbf{k}, i\omega) = \mathbf{v}_{\mathbf{k}} + \nabla_{\mathbf{k}} \Sigma(\mathbf{k}, i\omega)
$$
其中 $\mathbf{v}_{\mathbf{k}} = \nabla_{\mathbf{k}} \epsilon_{\mathbf{k}}$ 是裸带速。这个关系表明，[顶点函数](@entry_id:145137)的修正（偏离裸顶点 $\mathbf{v}_{\mathbf{k}}$ 的部分）完全由自能的动量依赖性决定。

我们可以用一个具体的模型来检验这个恒等式。考虑一个具有抛物线[色散](@entry_id:263750)的电子系统，受到白噪声杂质势的散射。在[玻恩近似](@entry_id:138141)下，[自能](@entry_id:145608) $\Sigma$ 是一个动量无关的常数，因此 $\nabla_{\mathbf{k}} \Sigma = 0$。根据 WTI，这预示着[顶点函数](@entry_id:145137)在此时没有修正，即 $\mathbf{\Gamma} = \mathbf{v}_{\mathbf{k}}$。

我们可以独立地计算[顶点修正](@entry_id:146982)。在所谓的“梯子近似”下，我们发现对于抛物线[色散](@entry_id:263750)，所有梯[子图](@entry_id:273342)对[顶点修正](@entry_id:146982)的贡献精确为零。这与 WTI 的预测完全一致，展示了图表理论强大的内部[自洽性](@entry_id:160889)。

### 高级专题与扩展

图表[微扰理论](@entry_id:138766)是一个极其丰富的框架，可以扩展到更复杂的情形。

#### 非平衡系统：Keldysh 形式主义

为了研究远离平衡态的量子系统的实时动力学，我们需要一个比松原形式主义更强大的工具。**Keldysh 形式主义**应运而生。其核心思想是定义一个在时间轴上“前进”再“后退”的**Keldysh 闭路 (Keldysh contour)** $\mathcal{C}$。

算符现在在闭路上进行编序，由此定义的**闭路编序格林函数** $G^{\mathcal{C}}$ 是一个 $2 \times 2$ 矩阵，其分量对应于场的算符位于前向支（+）或后向支（-）上的不同组合。这些分量可以线性组合成物理上更有意义的函数：[推迟格林函数](@entry_id:139183) $G^R$、超前格林函数 $G^A$ 和 **Keldysh 格林函数** $G^K$。例如，对于[费米子](@entry_id:146235)，它们的定义为：
$$
G^{R}(t,t') = -i\,\theta(t-t')\,\langle [\psi(t),\psi^{\dagger}(t')]_+ \rangle
$$
$$
G^{A}(t,t') = +i\,\theta(t'-t)\,\langle [\psi(t),\psi^{\dagger}(t')]_+ \rangle
$$
$$
G^{K}(t,t') = -i\,\langle \{\psi(t),\psi^{\dagger}(t')\} \rangle
$$
在 Keldysh 闭路上的图表规则也相应改变。最显著的一点是，位于后向支的相互作用顶点会带上一个与前向支相反的因子（例如，后向支为 $+i$，前向支为 $-i$），这反映了积分路径的方向。

通过一个标准的 Keldysh 旋转，可以将格林函数和自能[矩阵变换](@entry_id:156789)到一个更方便的“推迟-超前 (RA)”基。在这个基中，由于因果性，矩阵呈现出优美的上三角结构：
$$
\mathbf{G}(t,t') = \begin{pmatrix} G^{R}(t,t')  G^{K}(t,t') \\ 0  G^{A}(t,t') \end{pmatrix}
$$
[自能](@entry_id:145608)矩阵也具有相同的结构。这个特性极大地简化了非[平衡问题](@entry_id:636409)的理论分析。

#### 超越自能：Parquet 方程

[戴森方程](@entry_id:146246)是对单粒子性质（通过[自能](@entry_id:145608) $\Sigma$）的自洽[重求和](@entry_id:275405)。然而，在许多强关联问题中，两粒子相互作用本身也受到体系的强烈重整化。描述这种效应的物理量是完整的**二粒子[顶点函数](@entry_id:145137)** $\Gamma$。

**Parquet 方程**提供了一个非微扰的、自洽的框架来计算完整的二粒子[顶点函数](@entry_id:145137) $\Gamma$。其核心思想是将 $\Gamma$ 分解为不同的“通道”。一个图可以根据它是否能通过切断两条[传播子](@entry_id:139558)线来分开，而被分类为**二粒子可约**的。根据这两条线的动量路由，可约性分为三个通道：粒子-粒子 (pp)、粒子-空穴 (ph) 和横向粒子-空穴 ($\overline{\mathrm{ph}}$)。

Parquet 形式主义将 $\Gamma$ 分解为一个在所有通道都不可约的完全不可约部分 $\Lambda$，以及三个在各自通道可约的部分 $\Phi_r$ 的和：
$$
\Gamma = \Lambda + \Phi_{\mathrm{pp}} + \Phi_{\mathrm{ph}} + \Phi_{\overline{\mathrm{ph}}}
$$
每个可约部分 $\Phi_r$ 都通过一个贝特-萨尔佩特方程 (Bethe-Salpeter equation) 自洽地生成。这个方程的核是所谓的“通道不可约顶点” $\Gamma_r^{\mathrm{irr}}$，它被定义为 $\Gamma$ 中除去 $\Phi_r$ 之后的所有部分，即 $\Gamma_r^{\mathrm{irr}} = \Lambda + \sum_{s \neq r} \Phi_s$。这建立了一套复杂的、相互耦合的[积分方程](@entry_id:138643)组。求解这套方程可以在保持**[交叉对称性](@entry_id:145431) (crossing symmetry)** 的前提下，对所有通道的涨落进行自洽求和，从而提供了一种强大的非微扰方法来处理强关联问题。