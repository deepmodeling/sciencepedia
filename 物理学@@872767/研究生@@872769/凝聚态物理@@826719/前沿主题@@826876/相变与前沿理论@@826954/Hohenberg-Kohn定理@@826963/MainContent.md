## 引言
在量子力学领域，精确描述包含多个相互作用电子的系统，如原子、分子和固体，是核心挑战之一。传统上，这需要求解高维度的多体薛定谔方程，其[计算复杂性](@entry_id:204275)随粒子数[指数增长](@entry_id:141869)。[密度泛函理论](@entry_id:139027)（DFT）的出现彻底改变了这一局面，它将计算的[焦点](@entry_id:174388)从极其复杂的[波函数](@entry_id:147440)转移到了相对简单的三维电子密度上。而支撑起整个DFT宏伟大厦的理论基石，正是由Pierre Hohenberg和Walter Kohn于1964年提出的两个基本定理。

Hohenberg-Kohn (HK) 定理以其深刻的洞察力和优雅的逻辑，证明了仅用电子密度这一物理量来描述系统[基态](@entry_id:150928)是完备且合法的，解决了长期以来困扰物理学家和化学家的一个根本性问题。然而，这些定理本身是[存在性证明](@entry_id:267253)，并未直接提供计算方法。本文旨在系统地剖析Hohenberg-[Kohn定理](@entry_id:143958)的理论精髓及其深远影响，为理解现代[电子结构计算](@entry_id:748901)方法奠定坚实基础。

本文将分为三个部分。在“原理和机制”一章中，我们将深入探讨两个HK定理的精确表述、经典的证明过程，并审视理论中关于[可表示性](@entry_id:635277)和简并性的挑战及其修正。接下来，“应用与跨学科联系”一章将展示这些抽象定理如何通过Kohn-Sham框架转化为强大的计算工具，并探讨其在化学、[材料科学](@entry_id:152226)等领域的应用、扩展以及近似带来的挑战。最后，“动手实践”部分将通过具体的计算练习，帮助读者将理论概念与实际操作联系起来，加深对HK定理核心思想的理解。

## 原理和机制

密度泛函理论（Density Functional Theory, DFT）的理论基石由Hohenberg-Kohn (HK) 定理奠定。这些定理从根本上改变了我们对多电子系统量子力学问题的看法，将计算和概念的[焦点](@entry_id:174388)从极其复杂的[多体波函数](@entry_id:203043) $\Psi(\vec{r}_1, \vec{r}_2, \dots, \vec{r}_N)$ 转移到相对简单的三维电子密度 $n(\vec{r})$ 上。本章将系统地阐述这两个基本定理的原理、证明过程及其深远影响，并探讨其在面对理论挑战时的完善与推广。理解这些原理是掌握现代[电子结构计算](@entry_id:748901)方法的关键。[@problem_id:2133296] [@problem_id:2464788]

### 第一Hohenberg-Kohn 定理：[存在性与唯一性](@entry_id:263101)

第一HK定理旨在建立[基态](@entry_id:150928)电子密度 $n_0(\vec{r})$ 与系统所处的外势 $v(\vec{r})$ 之间的基本关系。该定理的精确表述如下：

对于一个处于非简并[基态](@entry_id:150928)的[相互作用粒子系统](@entry_id:181451)，其[基态](@entry_id:150928)电子密度 $n_0(\vec{r})$ 唯一地决定了系统所处的外势 $v(\vec{r})$，其差别最多为一个无关紧要的附加常数。

这个定理的直接推论是，由于外势 $v(\vec{r})$ 与粒子数 $N$ 共同决定了系统的[哈密顿量](@entry_id:172864) $\hat{H}$，进而决定了系统的[基态](@entry_id:150928)[波函数](@entry_id:147440) $\Psi_0$ 以及所有其他[基态](@entry_id:150928)性质，因此，基态密度 $n_0(\vec{r})$ 也就唯一地决定了系统的所有[基态](@entry_id:150928)性质。这意味着，原则上，任何一个[基态](@entry_id:150928)物理量都可以表示为基态密度的一个**泛函** (functional)。[@problem_id:2994401]

#### 基于变分原理的证明（*Reductio ad Absurdum*）

Hohenberg和Kohn最初的证明采用的是一种优雅的[反证法](@entry_id:276604)，其[逻辑核心](@entry_id:751444)是量子力学的瑞利-里兹（Rayleigh-Ritz）变分原理。变分原理指出，对于任意一个归一化的[试探波函数](@entry_id:142892) $\Psi'$, 系统[哈密顿量](@entry_id:172864) $\hat{H}$ 的[能量期望值](@entry_id:174035) $\langle\Psi'|\hat{H}|\Psi'\rangle$ 永远不会低于其真实的[基态能量](@entry_id:263704) $E_0$。当且仅当[试探波函数](@entry_id:142892) $\Psi'$ 就是真实的[基态](@entry_id:150928)[波函数](@entry_id:147440) $\Psi_0$ 时，等号成立。对于非简并[基态](@entry_id:150928)，任何不同于 $\Psi_0$ 的试探波函数都会得到严格大于 $E_0$ 的能量。

证明过程如下：
假设存在两个不同的外势 $v_A(\vec{r})$ 和 $v_B(\vec{r})$，它们之间的差异不仅仅是一个常数，即 $v_A(\vec{r}) \neq v_B(\vec{r}) + C$。这两个外势分别对应于两个系统 A 和 B，它们的[哈密顿量](@entry_id:172864)为：
$$
\hat{H}_A = \hat{T} + \hat{W} + \hat{V}_A
$$
$$
\hat{H}_B = \hat{T} + \hat{W} + \hat{V}_B
$$
其中 $\hat{T}$ 是[动能算符](@entry_id:265633)，$\hat{W}$ 是电子间相互作用算符（这两个算符对两个系统是相同的），而 $\hat{V}_A = \sum_{i} v_A(\vec{r}_i)$ 和 $\hat{V}_B = \sum_{i} v_B(\vec{r}_i)$ 是各自的外[势能](@entry_id:748988)算符。

我们假设这两个系统都具有非简并的[基态](@entry_id:150928)，其[波函数](@entry_id:147440)分别为 $\Psi_A$ 和 $\Psi_B$，[基态能量](@entry_id:263704)分别为 $E_A$ 和 $E_B$。现在，我们作出与定理结论相反的**核心假设**：尽管外势不同，这两个系统却拥有完全相同的[基态](@entry_id:150928)电子密度 $n_0(\vec{r})$。[@problem_id:2133296] [@problem_id:2994407]

首先，由于 $v_A(\vec{r})$ 和 $v_B(\vec{r})$ 的差异不只是一个常数，那么 $\hat{H}_A$ 和 $\hat{H}_B$ 是本质不同的[哈密顿量](@entry_id:172864)，它们对应的非简并[基态](@entry_id:150928)[波函数](@entry_id:147440)也必然不同，即 $\Psi_A \neq \Psi_B$。

现在，我们将系统B的[基态](@entry_id:150928)[波函数](@entry_id:147440) $\Psi_B$ 作为系统A的一个试探波函数，根据变分原理，必然有严格的不等式：
$$
E_A  \langle \Psi_B | \hat{H}_A | \Psi_B \rangle
$$
我们可以将 $\hat{H}_A$ 写成 $\hat{H}_B + \hat{V}_A - \hat{V}_B$ 的形式，代入上式：
$$
E_A  \langle \Psi_B | \hat{H}_B + \hat{V}_A - \hat{V}_B | \Psi_B \rangle = \langle \Psi_B | \hat{H}_B | \Psi_B \rangle + \langle \Psi_B | \hat{V}_A - \hat{V}_B | \Psi_B \rangle
$$
右边的第一项正是系统B的[基态能量](@entry_id:263704) $E_B$。第二项可以写成密度的形式：
$$
\langle \Psi_B | \hat{V}_A - \hat{V}_B | \Psi_B \rangle = \int [v_A(\vec{r}) - v_B(\vec{r})] n_B(\vec{r}) d^3r
$$
根据我们的核心假设，$n_A(\vec{r}) = n_B(\vec{r}) = n_0(\vec{r})$，于是得到第一个关键不等式：
$$
E_A  E_B + \int [v_A(\vec{r}) - v_B(\vec{r})] n_0(\vec{r}) d^3r \quad (1)
$$
完全对称地，我们可以将系统A的[基态](@entry_id:150928)[波函数](@entry_id:147440) $\Psi_A$ 作为系统B的[试探波函数](@entry_id:142892)，得到第二个关键不等式：
$$
E_B  E_A + \int [v_B(\vec{r}) - v_A(\vec{r})] n_0(\vec{r}) d^3r \quad (2)
$$
将不等式 (1) 和 (2) 相加，我们得到：
$$
E_A + E_B  E_B + E_A + \int [v_A(\vec{r}) - v_B(\vec{r})] n_0(\vec{r}) d^3r + \int [v_B(\vec{r}) - v_A(\vec{r})] n_0(\vec{r}) d^3r
$$
积分项完全抵消，最终导致一个逻辑上的矛盾：
$$
E_A + E_B  E_A + E_B
$$
这个荒谬的结论说明，我们的初始假设——即两个不只相差一个常数的外势可以产生相同的基态密度——是错误的。因此，对于非简并[基态](@entry_id:150928)，基[态密度](@entry_id:147894) $n_0(\vec{r})$ 必须唯一地决定其外势 $v(\vec{r})$。[@problem_id:1407261]

#### 关于附加常数的说明

值得注意的是，如果两个外势之间仅仅相差一个常数 $C$，即 $v_B(\vec{r}) = v_A(\vec{r}) + C$，那么 $\hat{H}_B = \hat{H}_A + \sum_i C = \hat{H}_A + NC$。这意味着两个[哈密顿量](@entry_id:172864)拥有完全相同的本征函数（包括[基态](@entry_id:150928)[波函数](@entry_id:147440)），而[能量本征值](@entry_id:144381)则整体平移了 $NC$。在这种情况下，$\Psi_A = \Psi_B$，因此它们自然对应相同的基[态密度](@entry_id:147894)。此时，变分原理中的不等号将变为等号，上述[反证法](@entry_id:276604)中的矛盾便不复存在。这解释了为何定理中必须包含“最多相差一个附加常数”的限定。[@problem_id:1407261]

### 第二 Hohenberg-Kohn 定理：变分原理

第一HK定理证明了基态能量是基[态密度](@entry_id:147894)的泛函 $E_0 = E[n_0]$，但这只是一个[存在性证明](@entry_id:267253)。第二HK定理则为如何利用这一关系提供了一个具有实际操作意义的[变分原理](@entry_id:198028)。

首先，我们将总能量泛函 $E_v[n]$ 分为两部分：一部分是与外势 $v(\vec{r})$ 相关的能量，另一部分则与系统内在性质（动能和粒子间相互作用）相关。
$$
E_v[n] = \int v(\vec{r}) n(\vec{r}) d^3r + F[n]
$$
其中，$F[n]$ 被称为**Hohenberg-Kohn [普适泛函](@entry_id:140176)**，它包含了电子的动能泛函 $T[n]$ 和电子间相互作用能泛函 $V_{ee}[n]$。$F[n]$ 之所以被称为**普适的** (universal)，是因为它的数学形式不依赖于任何特定的外势 $v(\vec{r})$，而只依赖于粒子间的相互作用形式（例如，电子间的库仑相互作用）。[@problem_id:2133306]

这意味着，对于任何包含 $N$ 个相互作用电子的系统，无论是[氢分子](@entry_id:148239)中由两个质子产生的[库仑势](@entry_id:154276)，还是[量子点](@entry_id:143385)中的抛物线形囚禁势，它们所对应的[普适泛函](@entry_id:140176) $F[n]$ 都是同一个数学函数。当然，将不同的密度 $n_A(\vec{r})$ 和 $n_B(\vec{r})$ 代入同一个泛函 $F[n]$，通常会得到不同的能量值 $F[n_A]$ 和 $F[n_B]$。普适性指的是**泛函本身形式的统一**，而非其在不同系统上取值的相同。[@problem_id:2133306] [@problem_id:2464788]

第二HK定理的表述如下：

对于一个给定的外势 $v(\vec{r})$，正确的基态能量 $E_0$ 是能量泛函 $E_v[n]$ 在所有“可接受的”密度 $n(\vec{r})$ 中所能取到的最小值。使泛函达到最小值的密度正是该系统真实的基态密度 $n_0(\vec{r})$。
$$
E_0 = \min_{n} E_v[n] = \min_{n} \left\{ F[n] + \int v(\vec{r}) n(\vec{r}) d^3r \right\}
$$
这个定理的意义在于，它将求解多体薛定谔方程这一极其困难的问题，转化为了一个寻找能量泛函最小值的[优化问题](@entry_id:266749)。虽然我们并不知道[普适泛函](@entry_id:140176) $F[n]$ 的精确形式，但这个[变分原理](@entry_id:198028)为发展和评估各种近似泛函提供了理论依据。我们可以构造 $F[n]$ 的近似形式（特别是其中的交换关联部分），然后通过最小化总能量来计算系统的基态能量和密度。一个更好的近似泛函，应该能在最小化后给出更接近真实值的能量。[@problem_saturated:"2994394", "2464788"]

### 理论的深化：[可表示性](@entry_id:635277)与简并问题

最初的Hohenberg-[Kohn定理](@entry_id:143958)虽然在概念上是革命性的，但其证明留下了一些需要审慎对待的理论细节，特别是关于密度的“[可表示性](@entry_id:635277)”以及[基态](@entry_id:150928)简并情况的处理。这些问题的深入探讨对于构建一个严谨的理论框架至关重要。

#### [N-可表示性](@entry_id:189302) 与 v-[可表示性](@entry_id:635277)

第二HK定理中的变分原理是在“可接受的”密度集合上进行的。这个集合的具体定义是什么？这里涉及两个重要的概念：**[N-可表示性](@entry_id:189302) (N-representability)** 和 **v-[可表示性](@entry_id:635277) (v-representability)**。

- **[N-可表示性](@entry_id:189302)**：一个密度函数 $n(\vec{r})$ 如果能由至少一个符合[泡利不相容原理](@entry_id:141850)的（即反对称的）、归一化的 $N$ 电子[波函数](@entry_id:147440) $\Psi$ 积分得到，那么它就是N-可表示的。这是一个相对宽松的条件，它只要求密度在数学上能与某个合法的[波函数](@entry_id:147440)对应，而不管这个[波函数](@entry_id:147440)是[基态](@entry_id:150928)还是[激发态](@entry_id:261453)，也不管它是否是某个物理[哈密顿量](@entry_id:172864)的本征态。[@problem_id:2994413]

- **v-[可表示性](@entry_id:635277)**：一个密度函数 $n(\vec{r})$ 如果是某个局域外势 $v(\vec{r})$ 对应的[相互作用哈密顿量](@entry_id:181720)的**[基态](@entry_id:150928)**密度，那么它就是v-可表示的。这是一个非常强的条件。

最初的HK定理的证明实际上是在v-可表示密度的集合上进行的。但这带来了一个逻辑上的困难：当我们进行变[分时](@entry_id:274419)，我们如何确保我们尝试的每一个试探密度 $n'(\vec{r})$ 都是v-可表示的？更严重的是，后来人们发现，存在一些“行为良好”的N-可表示密度，它们无法成为任何局域外势下的基[态密度](@entry_id:147894)，即它们是N-可表示的，但不是v-可表示的。[@problem_id:1407230] [@problem_id:2994413]

#### Levy-Lieb 约[束搜索](@entry_id:634146)方法

为了解决v-[可表示性](@entry_id:635277)问题，Levy和Lieb提出了**约[束搜索](@entry_id:634146) (constrained-search)** 的方法，为[普适泛函](@entry_id:140176) $F[n]$ 提供了一个明确的、建设性的定义。
$$
F[n] = \min_{\Psi \to n} \langle \Psi | \hat{T} + \hat{W} | \Psi \rangle
$$
这个定义的精妙之处在于，对于一个给定的N-可表示密度 $n(\vec{r})$，它在所有能够产生该密度的[波函数](@entry_id:147440) $\Psi$（即 $\Psi \to n$ 的[波函数](@entry_id:147440)集合）中进行搜索，找到使得动能与相互作用能之和 $\langle\Psi|\hat{T} + \hat{W}|\Psi\rangle$ 最小的那个[波函数](@entry_id:147440)，并将这个最小值定义为 $F[n]$ 的值。[@problem_id:1407230] [@problem_id:2994394]

该方法有几个重要的优点：
1.  **扩展了定义域**：$F[n]$ 的定义域从难以捉摸的v-可表示密度集，扩展到了所有N-可表示密度集。这为DFT提供了更为坚实的数学基础。[@problem_id:2994413]
2.  **明确的构造性**：它提供了一个原则上可行的构造 $F[n]$ 的路径，尽管在实践中对所有 $\Psi$ 进行搜索是不可行的。
3.  **澄清了概念**：它清楚地表明，对于一个任意的N-可表示密度 $n$，找到的那个使 $\langle\Psi|\hat{T} + \hat{W}|\Psi\rangle$ 最小的[波函数](@entry_id:147440) $\Psi_{n, \min}$，并不一定就是某个物理[哈密顿量](@entry_id:172864)的[基态](@entry_id:150928)[波函数](@entry_id:147440)。这再次强调了N-可表示密度与v-可表示密度之间的区别。[@problem_id:1407230]

通过约[束搜索](@entry_id:634146)，第二HK定理的变分原理可以被严格地表述为在所有N-可表示密度上进行的[能量最小化](@entry_id:147698)，其最小值就是系统的基态能量。[@problem_id:2994413]

#### [基态](@entry_id:150928)简并问题

第一HK定理的简单反证法证明严重依赖于[基态](@entry_id:150928)的非简并性，因为它需要变分原理中的严格不等式。如果[基态](@entry_id:150928)是简并的，情况会变得复杂。例如，两个不同的[哈密顿量](@entry_id:172864) $\hat{H}_A$ 和 $\hat{H}_B$ 可能共享一个或多个[基态](@entry_id:150928)[波函数](@entry_id:147440)。在这种情况下，当用 $\Psi_B$ 作为 $\hat{H}_A$ 的试探态时，可能得到 $E_A = \langle\Psi_B|\hat{H}_A|\Psi_B\rangle$。这使得反证法中的严格不等式链条被打破，无法导出矛盾。[@problem_id:2464818]

解决这个问题需要将理论框架从[纯态](@entry_id:141688)推广到**系综 (ensemble)**。通过考虑由简并[基态](@entry_id:150928)构成的系综密度矩阵，并对系综自由能进行变分，可以证明即使在[基态](@entry_id:150928)简并的情况下，系综平均的基[态密度](@entry_id:147894)仍然唯一地决定了外势（至多相差一个常数）。这一推广由Gross, Oliveira, 和Kohn完成，并在Lieb的[凸分析](@entry_id:273238)框架中得到了更为普适和严格的证明。对于大多数应用而言，了解简并性会使原始证明失效，而理论可以通过推广到系综来修复，这一点已经足够。[@problem_id:2464818]

### 结论：Hohenberg-Kohn 定理的基石地位

尽管Hohenberg-[Kohn定理](@entry_id:143958)是[存在性定理](@entry_id:261096)，它们没有给出那个“神圣”的[普适泛函](@entry_id:140176) $F[n]$ 的具体形式，但它们在现代计算化学和凝聚态物理中仍然具有不可动摇的基石地位。其重要性可以归结为以下三点 [@problem_id:2464788]：

1.  **确立了密度的核心地位**：第一HK定理从根本上证明了只用三维空间中的电子密度 $n(\vec{r})$ 来描述多电子系统[基态](@entry_id:150928)是合法且完备的，为整个理论提供了合法性。

2.  **提供了[变分原理](@entry_id:198028)的途径**：第二HK定理建立的能量泛函[变分原理](@entry_id:198028)，是所有现代DFT计算方法的出发点。它不仅指导了基态能量和密度的求解，也为评估和系统性地改进近似交换关联泛函提供了标准。

3.  **揭示了泛函的普适性**：$F[n]$ 的普适性意味着，为一种体系（如[均匀电子气](@entry_id:163911)）发展出的泛函近似，原则上可以应用于任何其他体系（如分子或固体）。正是这种可移植性使得DFT成为一种高效、普适且强大的计算工具。

总之，Hohenberg-[Kohn定理](@entry_id:143958)构建了密度泛函理论的宏伟蓝图，尽管蓝图中的许多细节（即交换关联泛函的精确形式）仍需通过近似来填充，但这个蓝图本身指明了方向，并保证了这条道路的正确性。