{"hands_on_practices": [{"introduction": "双电流模型为理解巨磁阻效应提供了基本框架。本练习将超越简化的图像，为一个电流垂直平面（CPP）三层结构建立一个更真实的电阻网络模型。通过明确地考虑自旋依赖的体电阻率和界面电阻，你将推导出总的器件电阻，这是为实际自旋电子器件建模和设计的一项关键技能 ([@problem_id:2992241])。", "problem": "考虑一个电流垂直于平面的三层结构，由铁磁体/非磁体/铁磁体（$F/N/F$）组成，其中两个铁磁层相同，厚度均为 $t_{F}$，非磁性间隔层的厚度为 $t_{N}$。该器件具有均匀的横截面积 $A$，电流均匀流过。假设采用双电流模型（自旋向上和自旋向下的通道独立导电，无自旋翻转散射），并假设线性响应（欧姆输运）。铁磁体中自旋向上和自旋向下电子的体电阻率分别为 $\\rho_{F}^{\\uparrow}$ 和 $\\rho_{F}^{\\downarrow}$。非磁性间隔层的体电阻率与自旋无关，等于 $\\rho_{N}$。每个 $F/N$ 界面贡献一个自旋相关的界面比电阻（面积-电阻乘积），分别用 $R_{b}^{\\uparrow}$ 和 $R_{b}^{\\downarrow}$ 表示，单位为 $\\mathrm{\\Omega \\, m^{2}}$。该三层结构中有两个 $F/N$ 界面。忽略任何其他界面的贡献。\n\n在平行（P）磁构型中，两个铁磁体的磁化方向一致。在反平行（AP）构型中，它们的磁化方向相反。界面比电阻是相对于相邻铁磁体的局域磁化方向定义的；因此，在AP构型中，一个相对于左侧铁磁体为自旋向上的电子，在右侧铁磁体的界面处则相对于该铁磁体为自旋向下。\n\n仅从欧姆定律、厚度为 $L$ 且电阻率为 $\\rho$ 的薄板的体电阻定义 $R = \\rho L/A$、给定自旋通道内电阻的串联相加，以及两个自旋通道电导的并联相加出发，推导P和AP构型下总器件电阻 $R_{P}$ 和 $R_{AP}$（单位为 $\\mathrm{\\Omega}$）的闭合形式表达式，这些表达式应是 $A$、$t_{F}$、$t_{N}$、$\\rho_{F}^{\\uparrow}$、$\\rho_{F}^{\\downarrow}$、$\\rho_{N}$、$R_{b}^{\\uparrow}$ 和 $R_{b}^{\\downarrow}$ 的函数。以解析表达式的形式给出最终答案。不需要进行数值计算。最终电阻以 $\\mathrm{\\Omega}$ 为单位表示（而不是面积-电阻乘积）。", "solution": "该问题被认为是有效的，因为它代表了凝聚态物理中一个标准的、良定的问题，具有科学依据、自洽且客观。不存在矛盾、信息缺失或违反物理原理的情况。因此，我们可以进行推导。\n\n分析基于双电流模型，其中自旋向上（$\\uparrow$）和自旋向下（$\\downarrow$）的电子被视为两个独立的并行导电通道。器件的总电阻通过首先计算每个自旋通道的电阻（通过其组成层和界面的电阻串联相加），然后将两个通道的电导并联相加来确定。该结构是一个 $F/N/F$ 三层结构，电流垂直于平面（CPP）。\n\n首先，我们定义三层结构中每个组件的电阻，单位为欧姆（$\\Omega$）。给定体电阻率 $\\rho$、层厚度 $L$ 和横截面积 $A$，电阻为 $R = \\rho L / A$。给定界面比电阻（面积-电阻乘积）$R_b$，界面电阻为 $R_{int} = R_b / A$。\n\n各个独立组件的电阻为：\n-   单个厚度为 $t_F$ 的铁磁（$F$）层的电阻：\n    $$R_{F}^{\\uparrow} = \\frac{\\rho_{F}^{\\uparrow} t_{F}}{A}$$\n    $$R_{F}^{\\downarrow} = \\frac{\\rho_{F}^{\\downarrow} t_{F}}{A}$$\n-   厚度为 $t_N$ 的非磁性（$N$）间隔层的电阻：\n    $$R_N = \\frac{\\rho_N t_N}{A}$$\n-   单个 F/N 界面的电阻：\n    $$R_{int}^{\\uparrow} = \\frac{R_{b}^{\\uparrow}}{A}$$\n    $$R_{int}^{\\downarrow} = \\frac{R_{b}^{\\downarrow}}{A}$$\n\n现在我们推导平行（$P$）和反平行（$AP$）磁构型下的总电阻。\n\n**平行（P）构型**\n在$P$构型中，两个铁磁层的磁化方向一致。电子在穿过器件的整个过程中，其自旋状态保持不变。\n\n自旋向上通道由两个$F$层、一个$N$层和两个$F/N$界面组成，所有这些都对自旋向上电子的电阻有贡献。自旋向上通道的总电阻 $R_{P}^{\\uparrow}$ 是串联之和：\n$$R_{P}^{\\uparrow} = R_{F}^{\\uparrow} + R_{int}^{\\uparrow} + R_{N} + R_{int}^{\\uparrow} + R_{F}^{\\uparrow} = 2 R_{F}^{\\uparrow} + 2 R_{int}^{\\uparrow} + R_{N}$$\n代入每个组件的表达式：\n$$R_{P}^{\\uparrow} = 2 \\frac{\\rho_{F}^{\\uparrow} t_{F}}{A} + 2 \\frac{R_{b}^{\\uparrow}}{A} + \\frac{\\rho_{N} t_{N}}{A} = \\frac{1}{A} (2 \\rho_{F}^{\\uparrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\uparrow})$$\n\n类似地，自旋向下通道的总电阻 $R_{P}^{\\downarrow}$ 为：\n$$R_{P}^{\\downarrow} = 2 R_{F}^{\\downarrow} + 2 R_{int}^{\\downarrow} + R_{N} = \\frac{1}{A} (2 \\rho_{F}^{\\downarrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\downarrow})$$\n\n器件总电阻 $R_P$ 通过将两个通道并联组合得到：\n$$R_P = \\left( \\frac{1}{R_{P}^{\\uparrow}} + \\frac{1}{R_{P}^{\\downarrow}} \\right)^{-1} = \\frac{R_{P}^{\\uparrow} R_{P}^{\\downarrow}}{R_{P}^{\\uparrow} + R_{P}^{\\downarrow}}$$\n代入 $R_{P}^{\\uparrow}$ 和 $R_{P}^{\\downarrow}$ 的表达式：\n分子中的乘积是：\n$$R_{P}^{\\uparrow} R_{P}^{\\downarrow} = \\frac{1}{A^2} (2 \\rho_{F}^{\\uparrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\uparrow}) (2 \\rho_{F}^{\\downarrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\downarrow})$$\n分母中的和是：\n$$R_{P}^{\\uparrow} + R_{P}^{\\downarrow} = \\frac{1}{A} [ (2 \\rho_{F}^{\\uparrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\uparrow}) + (2 \\rho_{F}^{\\downarrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\downarrow}) ]$$\n$$R_{P}^{\\uparrow} + R_{P}^{\\downarrow} = \\frac{2}{A} [ (\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow}) t_{F} + \\rho_{N} t_{N} + (R_{b}^{\\uparrow} + R_{b}^{\\downarrow}) ]$$\n将这些组合起来得到 $R_P$ 的最终表达式：\n$$R_P = \\frac{\\frac{1}{A^2} (2 \\rho_{F}^{\\uparrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\uparrow})(2 \\rho_{F}^{\\downarrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\downarrow})}{\\frac{2}{A} [(\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow}) t_{F} + \\rho_{N} t_{N} + (R_{b}^{\\uparrow} + R_{b}^{\\downarrow})]}$$\n$$R_P = \\frac{1}{2A} \\frac{(2 \\rho_{F}^{\\uparrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\uparrow})(2 \\rho_{F}^{\\downarrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\downarrow})}{(\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow}) t_{F} + \\rho_{N} t_{N} + R_{b}^{\\uparrow} + R_{b}^{\\downarrow}}$$\n\n**反平行（AP）构型**\n在$AP$构型中，磁化方向相反。我们将自旋量子化轴固定在左侧铁磁体的磁化方向上。一个相对于左侧铁磁体为自旋向上的电子，相对于右侧铁磁体则为自旋向下，反之亦然。\n\n让我们追踪第一个通道，即相对于左侧铁磁体为自旋-$\\uparrow$的电子。它串联经历以下电阻：\n1.  左侧 $F$ 层：$R_{F}^{\\uparrow}$\n2.  第一个 $F/N$ 界面：$R_{int}^{\\uparrow}$\n3.  $N$ 间隔层：$R_{N}$\n4.  第二个 $F/N$ 界面：此时相对于右侧铁磁体为自旋-$\\downarrow$，因此经历的电阻为 $R_{int}^{\\downarrow}$。\n5.  右侧 $F$ 层：作为自旋-$\\downarrow$电子经历电阻，$R_{F}^{\\downarrow}$。\n\n该通道的总电阻 $R_{AP, 1}$ 为：\n$$R_{AP, 1} = R_{F}^{\\uparrow} + R_{int}^{\\uparrow} + R_{N} + R_{int}^{\\downarrow} + R_{F}^{\\downarrow}$$\n\n对于第二个通道（相对于左侧铁磁体为自旋-$\\downarrow$），串联电阻为：$R_{F}^{\\downarrow}$、$R_{int}^{\\downarrow}$、$R_{N}$、$R_{int}^{\\uparrow}$ 和 $R_{F}^{\\uparrow}$。总电阻为：\n$$R_{AP, 2} = R_{F}^{\\downarrow} + R_{int}^{\\downarrow} + R_{N} + R_{int}^{\\uparrow} + R_{F}^{\\uparrow}$$\n\n显然，$R_{AP, 1} = R_{AP, 2}$。我们将此单通道电阻表示为 $R_{AP}^{\\text{channel}}$。\n$$R_{AP}^{\\text{channel}} = (\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow})\\frac{t_{F}}{A} + (R_{b}^{\\uparrow} + R_{b}^{\\downarrow})\\frac{1}{A} + \\rho_{N}\\frac{t_{N}}{A}$$\n$$R_{AP}^{\\text{channel}} = \\frac{1}{A} [(\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow}) t_{F} + \\rho_{N} t_{N} + R_{b}^{\\uparrow} + R_{b}^{\\downarrow}]$$\n\n器件总电阻 $R_{AP}$ 是两个相同电阻 $R_{AP}^{\\text{channel}}$ 的并联组合：\n$$R_{AP} = \\left( \\frac{1}{R_{AP}^{\\text{channel}}} + \\frac{1}{R_{AP}^{\\text{channel}}} \\right)^{-1} = \\frac{R_{AP}^{\\text{channel}}}{2}$$\n代入 $R_{AP}^{\\text{channel}}$ 的表达式，得到 $R_{AP}$ 的最终表达式：\n$$R_{AP} = \\frac{1}{2A} [(\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow}) t_{F} + \\rho_{N} t_{N} + R_{b}^{\\uparrow} + R_{b}^{\\downarrow}]$$\n如此便推导出了所需的两个表达式。", "answer": "$$\\boxed{\\begin{aligned} R_P = \\frac{1}{2A} \\frac{(2 \\rho_{F}^{\\uparrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\uparrow})(2 \\rho_{F}^{\\downarrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\downarrow})}{(\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow}) t_{F} + \\rho_{N} t_{N} + R_{b}^{\\uparrow} + R_{b}^{\\downarrow}} \\\\ \\\\ R_{AP} = \\frac{1}{2A} [(\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow}) t_{F} + \\rho_{N} t_{N} + R_{b}^{\\uparrow} + R_{b}^{\\downarrow}] \\end{aligned}}$$", "id": "2992241"}, {"introduction": "虽然平行和反平行构型代表了自旋阀的两个极端状态，但其电阻实际上随着铁磁层之间磁化方向夹角的连续变化而变化。本练习深入探讨了这种角度依赖性的量子力学起源。你将应用量子态投影原理来模拟非理想“倾斜”状态下的电阻，从而更深刻地理解自旋相互作用如何转化为宏观电信号 ([@problem_id:1779490])。", "problem": "自旋阀是表现出巨磁阻效应（GMR）的器件中的一个基本元件。考虑一个简化的自旋阀模型，它由两个铁磁层 F1 和 F2 组成，中间由一个薄的非磁性导电隔离层隔开。该结构的电阻由双电流模型描述，其中自旋向上和自旋向下的电子在两个独立的平行通道中传输。\n\n第一层 F1 的磁化方向固定在 $+z$ 轴方向。第二层 F2 的磁化方向可以与 $+z$ 轴成一个角度 $\\theta$。\n\n电子在铁磁层中经历的电阻取决于其自旋与该层磁化方向的相对取向。\n- 如果电子的自旋与该层的磁化方向平行，它会经历一个低电阻 $R_L$。\n- 如果电子的自旋与该层的磁化方向反平行，它会经历一个高电阻 $R_H$，其中 $R_H  R_L$。\n\n对于一般取向，电阻是一个量子力学平均值。如果一个电子自旋态被测量到与该层磁化方向平行的概率为 $P_{\\parallel}$，被测量到反平行的概率为 $P_{\\perp}$（其中 $P_{\\parallel} + P_{\\perp} = 1$），则它在该层中经历的电阻由 $R_{layer} = P_{\\parallel} R_L + P_{\\perp} R_H$ 给出。一个自旋通道的总电阻是两个层电阻的总和。入射的非极化电流由 50% 的自旋向上电子和 50% 的自旋向下电子组成，这里的自旋是相对于 F1 层的磁化轴定义的。\n\n在实际器件中，“反平行”构型可能不是完美对齐的。假设由于不完美的反铁磁耦合，该状态的特征是 F2 的磁化方向相对于 F1 的磁化方向倾斜了一个固定角度 $\\theta_{AP}$。\n\n推导在该倾斜状态下器件总电阻 $R$ 的闭式解析表达式。用 $R_L$、$R_H$ 和 $\\theta_{AP}$ 表示你的答案。", "solution": "器件的总电阻是自旋向上通道电阻 $R_{\\uparrow, \\text{total}}$ 和自旋向下通道电阻 $R_{\\downarrow, \\text{total}}$ 的并联。\n$$R = \\frac{R_{\\uparrow, \\text{total}} R_{\\downarrow, \\text{total}}}{R_{\\uparrow, \\text{total}} + R_{\\downarrow, \\text{total}}}$$\n我们需要找出 $R_{\\uparrow, \\text{total}}$ 和 $R_{\\downarrow, \\text{total}}$ 作为两层磁化方向之间夹角 $\\theta$ 的函数表达式。问题要求的是在特定角度 $\\theta = \\theta_{AP}$ 时的电阻。\n\n**步骤 1：计算自旋向上通道的电阻。**\n一个自旋向上的电子，其自旋与 F1 的磁化方向（$+z$ 轴）对齐。\n- 在 F1 层中的电阻为 $R_{\\uparrow, \\text{F1}} = R_L$。\n- 为了找到在 F2 层中的电阻，其磁化方向与 $+z$ 轴成 $\\theta$ 角，我们需要一个自旋向上态 $|\\uparrow_z\\rangle$ 被测量为与 F2 磁化轴平行或反平行的概率。设沿着 F2 轴的本征态为 $|\\uparrow_\\theta\\rangle$ 和 $|\\downarrow_\\theta\\rangle$。\n平行的量子力学概率幅是内积 $\\langle\\uparrow_\\theta|\\uparrow_z\\rangle$。概率是此概率幅的模的平方。对于自旋为 1/2 的粒子，此概率由 $P_{\\parallel} = \\cos^2(\\frac{\\theta}{2})$ 给出。\n类似地，反平行的概率为 $P_{\\perp} = |\\langle\\downarrow_\\theta|\\uparrow_z\\rangle|^2 = \\sin^2(\\frac{\\theta}{2})$。\n作为检验，$P_{\\parallel} + P_{\\perp} = \\cos^2(\\frac{\\theta}{2}) + \\sin^2(\\frac{\\theta}{2}) = 1$。\n因此，自旋向上电子在 F2 层中的电阻为：\n$$R_{\\uparrow, \\text{F2}} = P_{\\parallel} R_L + P_{\\perp} R_H = R_L \\cos^2\\left(\\frac{\\theta}{2}\\right) + R_H \\sin^2\\left(\\frac{\\theta}{2}\\right)$$\n自旋向上通道的总电阻是两层电阻之和：\n$$R_{\\uparrow, \\text{total}}(\\theta) = R_{\\uparrow, \\text{F1}} + R_{\\uparrow, \\text{F2}} = R_L + R_L \\cos^2\\left(\\frac{\\theta}{2}\\right) + R_H \\sin^2\\left(\\frac{\\theta}{2}\\right)$$\n\n**步骤 2：计算自旋向下通道的电阻。**\n一个自旋向下的电子，其自旋与 F1 的磁化方向反平行。\n- 在 F1 层中的电阻为 $R_{\\downarrow, \\text{F1}} = R_H$。\n- 对于 F2 层，我们需要一个自旋向下态 $|\\downarrow_z\\rangle$ 的概率。与 F2 轴平行的概率为 $P_{\\parallel} = |\\langle\\uparrow_\\theta|\\downarrow_z\\rangle|^2 = \\sin^2(\\frac{\\theta}{2})$。反平行的概率为 $P_{\\perp} = |\\langle\\downarrow_\\theta|\\downarrow_z\\rangle|^2 = \\cos^2(\\frac{\\theta}{2})$。\n自旋向下电子在 F2 层中的电阻为：\n$$R_{\\downarrow, \\text{F2}} = P_{\\parallel} R_L + P_{\\perp} R_H = R_L \\sin^2\\left(\\frac{\\theta}{2}\\right) + R_H \\cos^2\\left(\\frac{\\theta}{2}\\right)$$\n自旋向下通道的总电阻为：\n$$R_{\\downarrow, \\text{total}}(\\theta) = R_{\\downarrow, \\text{F1}} + R_{\\downarrow, \\text{F2}} = R_H + R_L \\sin^2\\left(\\frac{\\theta}{2}\\right) + R_H \\cos^2\\left(\\frac{\\theta}{2}\\right)$$\n\n**步骤 3：简化通道电阻的表达式。**\n为了方便，我们使用 $R_H = (R_H-R_L)+R_L$ 和 $\\sin^2(x) = 1-\\cos^2(x)$ 来重写通道电阻：\n$$R_{\\uparrow, \\text{total}}(\\theta) = R_L + R_L \\cos^2\\left(\\frac{\\theta}{2}\\right) + R_H \\left(1-\\cos^2\\left(\\frac{\\theta}{2}\\right)\\right) = R_L + R_H - (R_H - R_L) \\cos^2\\left(\\frac{\\theta}{2}\\right)$$\n同样地，对于自旋向下通道：\n$$R_{\\downarrow, \\text{total}}(\\theta) = R_H + R_L \\left(1-\\cos^2\\left(\\frac{\\theta}{2}\\right)\\right) + R_H \\cos^2\\left(\\frac{\\theta}{2}\\right) = R_H + R_L + (R_H - R_L) \\cos^2\\left(\\frac{\\theta}{2}\\right)$$\n\n**步骤 4：计算总电阻。**\n现在我们计算并联组合。首先，求通道电阻之和：\n$$R_{\\uparrow, \\text{total}} + R_{\\downarrow, \\text{total}} = (R_L + R_H - (R_H - R_L) \\cos^2\\left(\\frac{\\theta}{2}\\right)) + (R_L + R_H + (R_H - R_L) \\cos^2\\left(\\frac{\\theta}{2}\\right))$$\n$$R_{\\uparrow, \\text{total}} + R_{\\downarrow, \\text{total}} = 2(R_L + R_H)$$\n接下来，求通道电阻之积。这是一个平方差公式 $(A-B)(A+B) = A^2 - B^2$，其中 $A = R_L + R_H$ 且 $B = (R_H - R_L) \\cos^2(\\frac{\\theta}{2})$。\n$$R_{\\uparrow, \\text{total}} R_{\\downarrow, \\text{total}} = (R_L + R_H)^2 - \\left((R_H - R_L) \\cos^2\\left(\\frac{\\theta}{2}\\right)\\right)^2 = (R_L + R_H)^2 - (R_H - R_L)^2 \\cos^4\\left(\\frac{\\theta}{2}\\right)$$\n现在，将这些结合起来求总电阻 $R(\\theta)$：\n$$R(\\theta) = \\frac{R_{\\uparrow, \\text{total}} R_{\\downarrow, \\text{total}}}{R_{\\uparrow, \\text{total}} + R_{\\downarrow, \\text{total}}} = \\frac{(R_L + R_H)^2 - (R_H - R_L)^2 \\cos^4\\left(\\frac{\\theta}{2}\\right)}{2(R_L + R_H)}$$\n这可以通过拆分分数来简化：\n$$R(\\theta) = \\frac{(R_L + R_H)^2}{2(R_L + R_H)} - \\frac{(R_H - R_L)^2}{2(R_L + R_H)} \\cos^4\\left(\\frac{\\theta}{2}\\right)$$\n$$R(\\theta) = \\frac{R_L + R_H}{2} - \\frac{(R_H - R_L)^2}{2(R_L + R_H)} \\cos^4\\left(\\frac{\\theta}{2}\\right)$$\n\n**步骤 5：代入特定角度 $\\theta_{AP}$。**\n问题要求的是倾斜的反平行状态下的电阻，因此我们令 $\\theta = \\theta_{AP}$。\n$$R(\\theta_{AP}) = \\frac{R_L + R_H}{2} - \\frac{(R_H - R_L)^2}{2(R_L + R_H)} \\cos^4\\left(\\frac{\\theta_{AP}}{2}\\right)$$\n这就是器件总电阻的最终表达式。", "answer": "$$\\boxed{\\frac{R_L + R_H}{2} - \\frac{(R_H - R_L)^{2}}{2(R_L + R_H)}\\cos^{4}\\left(\\frac{\\theta_{AP}}{2}\\right)}$$", "id": "1779490"}, {"introduction": "解析模型虽然强大，但要从第一性原理预测特定材料组合的巨磁阻效应，则需要先进的计算方法。本练习旨在弥合理论与计算之间的鸿沟，指导你完成一个在紧束缚框架下使用格林函数方法模拟自旋输运的工作流程。通过计算自旋分辨的透射率和最终的巨磁阻比，你将亲身体验现代计算自旋电子学中的一项基础技术 ([@problem_id:2992231])。", "problem": "你需要设计并实现一个完整的、可运行的程序，该程序运行一个从头计算工作流，该工作流结合了密度泛函理论 (DFT) 和波函数匹配，以计算自旋分辨透射率 $T_s(E)$，并在弹道、单轨道、最近邻紧束缚极限下，预测特定铁磁体/正常金属 ($F/N$) 界面的垂直平面电流巨磁阻 (CPP GMR)。该计算必须以纯粹的数学和逻辑术语表示，并在明确说明的假设下产生可进行数值测试的输出。\n\n你必须假设以下具有物理动机的模型和基本依据：\n\n- 从用于相位相干输运的 Landauer–Büttiker 形式理论出发，其中两端电导由透射概率决定。独立处理每个自旋通道 $s \\in \\{\\uparrow,\\downarrow\\}$，并假设在界面处发生自旋守恒散射。\n- 将 DFT 推导的电子结构映射为铁磁电极中每个自旋通道的单轨道（类 s 轨道）紧束缚哈密顿量，以及正常金属电极中的单轨道紧束缚哈密顿量。将模型约束为具有最近邻跃迁和在位能的半无限一维链，这些参数通过从头计算的能带中心和带宽进行拟合。界面由单个界面轨道表示，该轨道耦合到铁磁电极的最后一个格点和正常金属电极的第一个格点。\n- 使用通过推迟格林函数表示的波函数匹配，以获得半无限电极的表面自能，并计算通过单个界面轨道的透射率 $T_s(E)$。采用推迟边界条件和针对电极能带之外能量的主值规定，以确保科学真实性。\n- 建立一个对称的 $F/N/F$ 自旋阀模型，其中两个相同的 $F/N$ 界面由一个间隔层隔开，为简单起见，忽略该间隔层的相位相干性（界面电阻的非相干串联相加）。使用平行和反平行磁化排列计算 CPP GMR 比率，结果为无量纲小数。\n\n你的程序必须实现以下任务：\n\n1.  用自旋相关的参数 $(\\epsilon_{F,\\uparrow}, t_{F,\\uparrow})$ 和 $(\\epsilon_{F,\\downarrow}, t_{F,\\downarrow})$ 表示铁磁电极，用 $(\\epsilon_N, t_N)$ 表示正常金属电极，用 $(\\epsilon_{C,\\uparrow}, \\epsilon_{C,\\downarrow})$ 表示界面轨道，与铁磁体的耦合为 $(t_{cL,\\uparrow}, t_{cL,\\downarrow})$，与正常金属的耦合为 $t_{cR}$。所有能量和跃迁项必须以电子伏特 (eV) 为单位处理。\n2.  使用通过半无限紧束缚链的推迟格林函数进行的波函数匹配，计算在指定能量 $E$ 下的自旋分辨的单界面透射率 $T_s(E)$。\n3.  对于平行 (P) 和反平行 (AP) 磁化排列，通过两个相同界面的非相干串联相加来近似对称 $F/N/F$ 器件的电导。根据这些值，计算定义为 $(R_{\\mathrm{AP}} - R_{\\mathrm{P}})/R_{\\mathrm{P}}$ 的 CPP GMR 比率，表示为不带百分号的小数。\n4.  最终输出为一行，其中包含所提供测试套件的一系列结果。每个测试用例的结果必须是一个包含三个浮点数的列表 $[T_{\\uparrow}(E), T_{\\downarrow}(E), \\mathrm{GMR}]$，四舍五入到六位小数。最终打印必须生成形如 $[[r_{1,1},r_{1,2},r_{1,3}],[r_{2,1},r_{2,2},r_{2,3}],\\dots]$ 的单行。\n\n单位和约定：\n\n- 能量和跃迁项必须以电子伏特 (eV) 为单位。\n- 自旋分辨透射率 $T_s(E)$ 是无量纲的。\n- GMR 比率必须表示为小数。\n\n测试套件和模型参数：\n\n在所有测试用例中，对铁磁体、正常金属和界面轨道使用以下固定参数：\n\n- 铁磁体（左电极）：\n  - $\\epsilon_{F,\\uparrow} = -0.6$ eV, $t_{F,\\uparrow} = 1.3$ eV.\n  - $\\epsilon_{F,\\downarrow} = +0.4$ eV, $t_{F,\\downarrow} = 0.9$ eV.\n- 正常金属（右电极）：\n  - $\\epsilon_{N} = 0.0$ eV, $t_{N} = 1.0$ eV.\n- 界面轨道：\n  - $\\epsilon_{C,\\uparrow} = -0.1$ eV, $\\epsilon_{C,\\downarrow} = +0.1$ eV.\n  - $t_{cR} = 0.85$ eV.\n\n定义四个测试用例，改变费米能 $E$ 和铁磁体到界面的耦合：\n\n- 测试用例 1（一般情况）：\n  - $E = 0.0$ eV.\n  - $t_{cL,\\uparrow} = 0.9$ eV, $t_{cL,\\downarrow} = 0.8$ eV.\n- 测试用例 2（近能带边缘行为）：\n  - $E = 1.99$ eV.\n  - $t_{cL,\\uparrow} = 0.9$ eV, $t_{cL,\\downarrow} = 0.8$ eV.\n- 测试用例 3（弱界面耦合）：\n  - $E = -0.5$ eV.\n  - $t_{cL,\\uparrow} = 0.2$ eV, $t_{cL,\\downarrow} = 0.2$ eV.\n- 测试用例 4（上能带中的自旋不对称透射）：\n  - $E = 1.85$ eV.\n  - $t_{cL,\\uparrow} = 0.9$ eV, $t_{cL,\\downarrow} = 0.8$ eV.\n\n要求的最终输出格式：\n\n- 你的程序应生成一行输出，其中包含一个逗号分隔的列表的列表，每个内部列表包含三个浮点数 $[T_{\\uparrow}(E), T_{\\downarrow}(E), \\mathrm{GMR}]$，所有值都四舍五入到六位小数，并用方括号括起来，用于按上述顺序排列的四个测试用例。例如：$[[r_{1,1},r_{1,2},r_{1,3}],[r_{2,1},r_{2,2},r_{2,3}],[r_{3,1},r_{3,2},r_{3,3}],[r_{4,1},r_{4,2},r_{4,3}]]$。", "solution": "该问题要求计算铁磁体/正常金属/铁磁体 ($F/N/F$) 自旋阀的自旋分辨透射率和巨磁阻 (GMR)。理论框架基于应用于简化的单维、单轨道紧束缚模型的 Landauer-Büttiker 形式理论。计算将使用推迟格林函数技术进行。\n\n首先，我们对系统进行建模。它由两个半无限电极（左侧为铁磁体 $F$，右侧为正常金属 $N$）通过单个界面轨道 ($C$) 耦合而成。由于左电极的铁磁性，其电子结构是自旋相关的。我们独立描述每个自旋通道 $s \\in \\{\\uparrow, \\downarrow\\}$。电极的紧束缚哈密顿量由在位能 $\\epsilon$ 和最近邻跃迁积分 $t$ 表征。铁磁电极的参数为 $(\\epsilon_{F,s}, t_{F,s})$，正常金属电极的参数为 $(\\epsilon_N, t_N)$，界面轨道具有自旋相关的在位能 $\\epsilon_{C,s}$。从左电极到中心格点的耦合（跃迁）为 $t_{cL,s}$，从中心格点到右电极的耦合为 $t_{cR}$。\n\n计算的核心是推迟格林函数。对于一个参数为 $(\\epsilon, t)$ 的半无限一维紧束缚链，其表面格点的格林函数 $g^R_{surf}(E)$ 通过求解表面格点的戴森方程得到。这会产生一个关于 $g^R_{surf}$ 的二次方程，选择物理可行解（对应于出射波或衰减态）可得：\n$$\ng^R_{surf}(E; \\epsilon, t) = \\frac{(E - \\epsilon) - \\sqrt{(E - \\epsilon)^2 - 4t^2}}{2t^2}\n$$\n必须小心处理平方根以确保正确的推迟边界条件。从解析上讲，这意味着对于电极导带内的能量 $E$ ($|E-\\epsilon| \\le 2|t|$），平方根的参数为负，我们取其根为带有负号的纯虚数，从而确保 $g^R_{surf}(E)$ 的虚部为非正值。对于能带外的能量，根是实数，选择的符号要对应于一个远离界面衰减的状态。使用复数运算，将平方根的参数视为复数 $(E - \\epsilon)^2 - 4t^2 + i0^+$，可以正确地处理所有情况。平方根的主支通常会产生非负虚部，因此需要在分子中明确使用减号。\n\n半无限电极充当电荷库，使中心格点的能级展宽。这种效应由自能 $\\Sigma^R(E)$ 捕获。对于给定的自旋通道 $s$，左电极 ($L$) 和右电极 ($R$) 施加在中心格点上的自能由下式给出：\n$$\n\\Sigma^R_{L,s}(E) = t_{cL,s}^2 \\cdot g^R_{surf}(E; \\epsilon_{F,s}, t_{F,s})\n$$\n$$\n\\Sigma^R_{R}(E) = t_{cR}^2 \\cdot g^R_{surf}(E; \\epsilon_N, t_N)\n$$\n请注意，正常金属电极的参数是自旋无关的。\n\n中心界面格点的完整推迟格林函数，被其与电极的耦合“修饰”后为：\n$$\nG^R_{C,s}(E) = \\left[ E - \\epsilon_{C,s} - \\Sigma^R_{L,s}(E) - \\Sigma^R_{R}(E) \\right]^{-1}\n$$\n自旋通道 $s$ 通过界面的透射概率 $T_s(E)$ 由 Landauer-Büttiker 公式给出，对于单点导体，该公式简化为：\n$$\nT_s(E) = \\Gamma_{L,s}(E) \\cdot \\Gamma_{R}(E) \\cdot |G^R_{C,s}(E)|^2\n$$\n这里，$\\Gamma_{L/R,s}$ 是展宽函数（或耦合速率），表示电子从电极进入中心格点或从中心格点离开到电极的速率。它们与自能的虚部有关：\n$$\n\\Gamma_{L/R,s}(E) = -2 \\, \\mathrm{Im}[\\Sigma^R_{L/R,s}(E)]\n$$\n只有当电子在两个电极中都存在可用态时（对应于 $\\Gamma_{L,s}$ 和 $\\Gamma_{R}$ 均不为零），才会发生透射。\n\n接下来，我们计算对称 $F/N/F$ 器件的 GMR。问题指定了来自两个相同 $F/N$ 界面的电阻的非相干相加。我们考虑两个独立的自旋通道并行地穿过整个器件。\n\n对于平行 (P) 排列，两个 $F$ 层的磁化方向一致。\n自旋向上通道的总电阻是两个界面电阻之和：$R_{P,\\uparrow} = R_\\uparrow + R_\\uparrow = 2 R_\\uparrow$。以电阻量子 $R_0 = h/e^2$ 为单位，我们有 $R_s = 1/T_s(E)$。\n因此，$R_{P,\\uparrow} = 2/T_\\uparrow(E)$。类似地，对于自旋向下通道，$R_{P,\\downarrow} = 2/T_\\downarrow(E)$。\n总电阻 $R_P$ 通过将两个并联自旋通道的电导（电阻的倒数）相加得到：\n$$\n\\frac{1}{R_P} = \\frac{1}{R_{P,\\uparrow}} + \\frac{1}{R_{P,\\downarrow}} = \\frac{T_\\uparrow(E)}{2} + \\frac{T_\\downarrow(E)}{2} \\implies R_P = \\frac{2}{T_\\uparrow(E) + T_\\downarrow(E)}\n$$\n\n对于反平行 (AP) 排列，第二个 $F$ 层的磁化反转。自旋向上通道中的电子以透射率 $T_\\uparrow$ 穿过第一个界面，以透射率 $T_\\downarrow$ 穿过第二个界面。\n该路径的总电阻为 $R_{AP,\\text{path1}} = R_\\uparrow + R_\\downarrow = 1/T_\\uparrow(E) + 1/T_\\downarrow(E)$。\n另一条路径，对于最初处于自旋向下通道的电子，是对称的：$R_{AP,\\text{path2}} = R_\\downarrow + R_\\uparrow = R_{AP,\\text{path1}}$。\n总电阻 $R_{AP}$ 来自这两条并联的相同路径：\n$$\n\\frac{1}{R_{AP}} = \\frac{1}{R_{AP,\\text{path1}}} + \\frac{1}{R_{AP,\\text{path2}}} = \\frac{2}{1/T_\\uparrow(E) + 1/T_\\downarrow(E)} \\implies R_{AP} = \\frac{1}{2} \\left( \\frac{1}{T_\\uparrow(E)} + \\frac{1}{T_\\downarrow(E)} \\right) = \\frac{T_\\uparrow(E) + T_\\downarrow(E)}{2 T_\\uparrow(E) T_\\downarrow(E)}\n$$\n\n最后，GMR 比率定义为 $(R_{AP} - R_P)/R_P = R_{AP}/R_P - 1$。代入推导出的 $R_P$ 和 $R_{AP}$ 表达式（以 $R_0$ 为单位）：\n$$\n\\mathrm{GMR} = \\frac{\\frac{T_\\uparrow + T_\\downarrow}{2 T_\\uparrow T_\\downarrow}}{\\frac{2}{T_\\uparrow + T_\\downarrow}} - 1 = \\frac{(T_\\uparrow + T_\\downarrow)^2}{4 T_\\uparrow T_\\downarrow} - 1\n$$\n这个表达式可以简化为：\n$$\n\\mathrm{GMR} = \\frac{T_\\uparrow^2 + 2T_\\uparrow T_\\downarrow + T_\\downarrow^2 - 4T_\\uparrow T_\\downarrow}{4 T_\\uparrow T_\\downarrow} = \\frac{(T_\\uparrow - T_\\downarrow)^2}{4 T_\\uparrow T_\\downarrow}\n$$\n这个最终公式提供了基于单界面自旋分辨透射率的 GMR 比率。该算法将为每个测试用例实现这些公式，并使用 `numpy` 库的复数支持来执行计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are permitted.\n\ndef solve():\n    \"\"\"\n    Main function to solve the CPP-GMR problem for the given test suite.\n    It orchestrates the calculation for each test case and prints the final result.\n    \"\"\"\n\n    # Fixed parameters as defined in the problem statement.\n    # Ferromagnet (F) lead parameters in eV\n    eps_F_up, t_F_up = -0.6, 1.3\n    eps_F_down, t_F_down = 0.4, 0.9\n    # Normal metal (N) lead parameters in eV\n    eps_N, t_N = 0.0, 1.0\n    # Interfacial orbital parameters in eV\n    eps_C_up, eps_C_down = -0.1, 0.1\n    # Interface coupling parameters in eV\n    t_cR = 0.85\n\n    # Test cases defined in the problem statement.\n    # Each case is a tuple: (E, t_cL_up, t_cL_down)\n    test_cases = [\n        (0.0, 0.9, 0.8),    # Test case 1\n        (1.99, 0.9, 0.8),   # Test case 2\n        (-0.5, 0.2, 0.2),   # Test case 3\n        (1.85, 0.9, 0.8),   # Test case 4\n    ]\n\n    # Pre-calculate surface Green's function for the right (Normal Metal) lead\n    # as it's common for all spins and test cases unless E changes.\n    \n    def get_surface_g(E, eps, t):\n        \"\"\"\n        Calculates the retarded surface Green's function for a semi-infinite 1D tight-binding lead.\n        \n        Args:\n            E (float): Energy in eV.\n            eps (float): Onsite energy of the lead in eV.\n            t (float): Hopping parameter of the lead in eV.\n            \n        Returns:\n            complex: The value of the retarded surface Green's function.\n        \"\"\"\n        if t == 0:\n            return 1j * np.inf # Avoid division by zero, though not expected\n        \n        # Use complex arithmetic to handle in-band and out-of-band cases correctly.\n        # The term (E - eps)^2 - 4*t^2 + 0j ensures numpy.sqrt returns a complex number.\n        # The principal root of sqrt for a negative real number is on the positive imaginary axis.\n        # The minus sign before the sqrt ensures the correct retarded boundary condition (Im(g) = 0).\n        z = (E - eps)\n        arg_sqrt = z**2 - 4 * t**2 + 0j\n        numerator = z - np.sqrt(arg_sqrt)\n        denominator = 2 * t**2\n        \n        return numerator / denominator\n\n    def compute_results_for_case(case):\n        \"\"\"\n        Computes the spin-resolved transmission and GMR for a single test case.\n        \"\"\"\n        E, t_cL_up, t_cL_down = case\n\n        # --- Right Lead (Normal Metal) Calculations ---\n        # These are spin-independent.\n        g_surf_R = get_surface_g(E, eps_N, t_N)\n        sigma_R = t_cR**2 * g_surf_R\n        gamma_R = -2 * np.imag(sigma_R)\n\n        # --- Spin-Up Channel Calculation ---\n        g_surf_L_up = get_surface_g(E, eps_F_up, t_F_up)\n        sigma_L_up = t_cL_up**2 * g_surf_L_up\n        gamma_L_up = -2 * np.imag(sigma_L_up)\n        \n        # Dressed Green's function for the central site\n        g_C_up_inv = E - eps_C_up - sigma_L_up - sigma_R\n        g_C_up = 1.0 / g_C_up_inv\n        \n        # Transmission for spin-up\n        T_up = gamma_L_up * gamma_R * np.abs(g_C_up)**2\n\n        # --- Spin-Down Channel Calculation ---\n        g_surf_L_down = get_surface_g(E, eps_F_down, t_F_down)\n        sigma_L_down = t_cL_down**2 * g_surf_L_down\n        gamma_L_down = -2 * np.imag(sigma_L_down)\n        \n        # Dressed Green's function for the central site\n        g_C_down_inv = E - eps_C_down - sigma_L_down - sigma_R\n        g_C_down = 1.0 / g_C_down_inv\n        \n        # Transmission for spin-down\n        T_down = gamma_L_down * gamma_R * np.abs(g_C_down)**2\n\n        # --- GMR Calculation ---\n        # Handle cases where transmission might be zero to avoid division by zero.\n        if T_up * T_down == 0:\n            # If T_up and T_down are not equal, GMR is infinite.\n            # If they are both zero, resistances are both infinite and GMR is ill-defined.\n            # A common physical convention is GMR=0 if total transmission is zero.\n            # However, the formula (T_up-T_down)^2 / (4*T_up*T_down) suggests divergence.\n            # For the given test cases, this is not expected to happen.\n            if T_up == T_down:\n                gmr = 0.0\n            else:\n                gmr = np.inf # Placeholder for an infinite GMR\n        else:\n            gmr = (T_up - T_down)**2 / (4 * T_up * T_down)\n            \n        return [round(T_up, 6), round(T_down, 6), round(gmr, 6)]\n\n    # Process all test cases\n    results = [compute_results_for_case(case) for case in test_cases]\n\n    # Format the final output as a single string\n    result_str = \",\".join([str(r) for r in results])\n    result_str = result_str.replace(\" \", \"\") # Remove spaces for compact representation\n\n    # Print the final result in the exact required format.\n    print(f\"[{result_str}]\")\n\nsolve()\n\n```", "id": "2992231"}]}