{"hands_on_practices": [{"introduction": "在深入研究复杂的量子场论形式之前，通过一个简单的物理论证就能获得对极化子物理核心的宝贵洞察。这个练习旨在运用海森堡不确定性原理和量纲分析来估算极化子的特征尺寸，揭示电子动能与晶格极化势能之间的基本竞争关系。这种估算方法虽然粗略，却能有效地建立起对极化子作为一个自陷量子态的直观物理图像 [@problem_id:3010669]。", "problem": "考虑一个能带有效质量为 $m$ 的单电子，在极性晶体中与角频率为 $\\omega_{LO}$ 的纵向光学（LO）声子相互作用，该体系在长波长下由连续 Fröhlich 模型描述。设 $\\alpha$ 表示标准的无量纲 Fröhlich 电子-声子耦合常数。将极化子半径 $r_p$ 定义为被其自感应极化场局域化的电子波包的特征范围。\n\n仅从以下基本输入出发：\n- 海森堡不确定性原理，以标准方式用于估计将质量为 $m$ 的粒子局域在大小为 $r_p$ 的区域内所需的动能代价。\n- 在连续极限下，由极化介导的吸引作用是长程的，且形式为库仑型，因此其对能量的贡献与电子电荷云的大小 $r_p$ 成反比这一事实。\n- 使用可用的微观尺度 $\\hbar$、$m$ 和 $\\omega_{LO}$ 进行量纲分析，这定义了一个自然声子长度 $a_{LO} \\equiv \\sqrt{\\hbar/(2 m \\omega_{LO})}$ 和一个自然声子能量 $\\hbar \\omega_{LO}$，\n\n构建一个粗略的变分能量泛函 $E(r_p)$，其形式为一个动能项和一个极化项之和\n$$\nE(r_p) \\simeq \\frac{\\hbar^{2}}{2 m}\\,\\frac{1}{r_p^{2}} \\;-\\; \\alpha\\,\\hbar \\omega_{LO}\\,\\frac{a_{LO}}{r_p},\n$$\n其中，为了进行数量级估计，被省略的无量纲前置因子被取为1。\n\n通过将 $E(r_p)$ 对 $r_p$ 最小化，确定极化子半径 $r_p$ 作为由 $\\alpha$、$m$、$\\omega_{LO}$ 和 $\\hbar$ 表示的闭合形式解析表达式。将你得到的 $r_p$ 的最终结果以米为单位表示。不要代入任何参数的数值，也不要进行近似；只提供精确的符号表达式。", "solution": "我们被要求通过最小化一个包含局域化动能代价和吸引极化能的变分能量来估计极化子半径 $r_p$。基本输入是：(i) 用海森堡不确定性原理来估计局域化的动能，(ii) 在连续 Fröhlich 模型中，由极化介导的吸引作用具有长程 $1/r$ 标度行为，以及 (iii) 通过自然尺度 $a_{LO}$ 和 $\\hbar \\omega_{LO}$，使用量纲分析来确定对微观参数 $\\hbar$、$m$ 和 $\\omega_{LO}$ 的依赖关系。\n\n首先，将一个粒子局域在大小为 $r_p$ 的区域内，意味着动量不确定度的量级为 $\\Delta p \\sim \\hbar / r_p$。相应的动能代价的标度行为如下\n$$\nE_{\\mathrm{kin}}(r_p) \\sim \\frac{(\\Delta p)^{2}}{2 m} \\sim \\frac{\\hbar^{2}}{2 m}\\,\\frac{1}{r_p^{2}}。\n$$\n这是对受限粒子动能的标准不确定性原理估计。\n\n其次，电子在极性晶体中感应出的极化场会产生一个具有库仑标度行为的长程吸引势。对于分布在尺度 $r_p$ 上的电荷密度，其产生的极化能必须标度为 $- \\text{const}/r_p$。在连续 Fröhlich 模型中，唯一可用的微观能量尺度是 $\\hbar \\omega_{LO}$，而唯一可由 $\\hbar$、$m$ 和 $\\omega_{LO}$ 构建的微观长度尺度是\n$$\na_{LO} \\equiv \\sqrt{\\frac{\\hbar}{2 m \\omega_{LO}}}。\n$$\n由于电子-声子相互作用的无量纲强度由 $\\alpha$ 衡量，量纲分析和已知的 $1/r$ 长程特性意味着吸引极化能的形式为\n$$\nE_{\\mathrm{pol}}(r_p) \\sim - \\alpha\\,\\hbar \\omega_{LO}\\,\\frac{a_{LO}}{r_p}。\n$$\n这种形式确保了正确的量纲：因子 $\\hbar \\omega_{LO}$ 提供了能量，因子 $a_{LO}/r_p$ 是无量纲的，而 $1/r_p$ 标度行为反映了库仑长程吸引作用。为了进行数量级估计，我们按照问题所述，将省略的无量纲前置因子设为1。\n\n因此，总的变分能量是\n$$\nE(r_p) \\simeq \\frac{\\hbar^{2}}{2 m}\\,\\frac{1}{r_p^{2}} \\;-\\; \\alpha\\,\\hbar \\omega_{LO}\\,\\frac{a_{LO}}{r_p}。\n$$\n\n为了找到最优的极化子半径，我们将 $E(r_p)$ 对 $r_p$ 进行最小化：\n$$\n\\frac{dE}{dr_p} \\;=\\; -\\,\\frac{\\hbar^{2}}{m}\\,\\frac{1}{r_p^{3}} \\;+\\; \\alpha\\,\\hbar \\omega_{LO}\\,a_{LO}\\,\\frac{1}{r_p^{2}} \\;=\\; 0。\n$$\n两边乘以 $r_p^{3}$ 以消去分母：\n$$\n-\\,\\frac{\\hbar^{2}}{m} \\;+\\; \\alpha\\,\\hbar \\omega_{LO}\\,a_{LO}\\,r_p \\;=\\; 0。\n$$\n解出 $r_p$：\n$$\nr_p \\;=\\; \\frac{\\hbar^{2}/m}{\\alpha\\,\\hbar \\omega_{LO}\\,a_{LO}} \\;=\\; \\frac{\\hbar}{m}\\,\\frac{1}{\\alpha\\,\\omega_{LO}\\,a_{LO}}。\n$$\n将 $a_{LO} = \\sqrt{\\hbar/(2 m \\omega_{LO})}$ 代入此表达式。首先计算分母：\n$$\n\\omega_{LO}\\,a_{LO} \\;=\\; \\omega_{LO}\\,\\sqrt{\\frac{\\hbar}{2 m \\omega_{LO}}} \\;=\\; \\sqrt{\\omega_{LO}}\\,\\sqrt{\\frac{\\hbar}{2 m}}。\n$$\n因此\n$$\nr_p \\;=\\; \\frac{\\hbar}{m}\\,\\frac{1}{\\alpha}\\,\\frac{1}{\\sqrt{\\omega_{LO}}}\\,\\sqrt{\\frac{2 m}{\\hbar}}\n\\;=\\; \\frac{1}{\\alpha}\\,\\sqrt{2}\\,\\sqrt{\\frac{\\hbar}{m \\omega_{LO}}}。\n$$\n等价地，直接使用 $a_{LO}$，\n$$\nr_p \\;=\\; \\frac{2\\,a_{LO}}{\\alpha}。\n$$\n按要求恢复明确的参数，最终的闭合形式表达式是\n$$\nr_p \\;=\\; \\frac{\\sqrt{2}}{\\alpha}\\,\\sqrt{\\frac{\\hbar}{m \\omega_{LO}}}。\n$$\n该表达式具有长度的单位，因此当 $\\hbar$、$m$ 和 $\\omega_{LO}$ 用国际单位制（SI）单位表示时，它给出以米为单位的 $r_p$。", "answer": "$$\\boxed{\\frac{\\sqrt{2}}{\\alpha}\\sqrt{\\frac{\\hbar}{m\\,\\omega_{LO}}}}$$", "id": "3010669"}, {"introduction": "在前一个练习建立的直观图像基础上，我们将采用一种更为严谨的理论工具——变分法——来定量研究强耦合极化子。Pekar变分法是分析强耦合极限下Fröhlich极化子性质的经典方法。通过本练习，你将推导出极化子基态能量与耦合常数 $\\alpha$ 的著名 $-\\alpha^2$ 标度关系，并利用高斯试探波函数估算其比例系数，从而深化对变分原理在多体问题中应用的理解 [@problem_id:3010617]。", "problem": "在连续谱 Fröhlich 极化子模型中，一个带质量为 $m$ 的电子通过无量纲 Fröhlich 耦合常数 $\\alpha$ 与角频率为 $\\omega_{LO}$ 的纵向光学声子相互作用。在绝热强耦合（Pekar）方法中，声子场被一个由电子密度自洽决定的静态极化场所取代。在此极限下，一个经过充分检验的结果是，对于固定的归一化电子波函数 $\\psi(\\mathbf{r})$，总能量由一个 Pekar 能量泛函给出。引入极化子的自然单位，长度为 $\\ell \\equiv \\sqrt{\\hbar/(2 m \\omega_{LO})}$，能量为 $\\varepsilon_0 \\equiv \\hbar \\omega_{LO}$，并将归一化波函数写作无量纲坐标 $\\mathbf{x} \\equiv \\mathbf{r}/\\ell$ 的函数 $\\psi(\\mathbf{x})$，满足 $\\int d^3 x\\, |\\psi(\\mathbf{x})|^2 = 1$。在这些单位下，Pekar 泛函的形式为一个动能项减去一个由库仑核媒介的自相互作用项。\n\n1. 从此泛函形式出发，使用形如 $\\psi_{\\gamma}(\\mathbf{x}) = \\gamma^{3/2} \\varphi(\\gamma \\mathbf{x})$ 的标度变换拟设（其中 $\\varphi(\\mathbf{x})$ 为一个固定的、归一化的形状函数），证明在强耦合区域（$\\alpha \\gg 1$），基态能量必定满足如下标度关系\n$$\nE_0(\\alpha) \\propto - \\alpha^2 \\hbar \\omega_{LO}\n$$\n您的推导必须通过分离动能项和相互作用项对 $\\gamma$ 的依赖关系，并对 $\\gamma$ 进行最小化，来明确地展示出对 $\\alpha$ 的平方依赖性。\n\n2. 为估计该比例常数，采用单参数高斯试探波函数族\n$$\n\\psi_{\\lambda}(\\mathbf{x}) = \\left(\\frac{\\lambda}{\\pi}\\right)^{3/4} \\exp\\!\\left(-\\frac{\\lambda}{2}\\, \\mathbf{x}^2\\right), \\quad \\lambda > 0,\n$$\n并在极化子单位下，将 Pekar 能量泛函精确地计算为 $\\lambda$ 的函数。通过对此能量关于 $\\lambda$ 进行最小化，得到由下式定义的常数 $c$ 的一个闭式估计\n$$\nE_0(\\alpha) \\approx - c\\, \\alpha^2\\, \\hbar \\omega_{LO} \\quad (\\alpha \\gg 1).\n$$\n\n请给出常数 $c$ 的精确值（一个没有单位的纯数）作为最终答案。不要提供不等式或方程式作为答案。如果您选择计算任何中间数值，请保持最终的 $c$ 为精确的解析形式，无需四舍五入。", "solution": "首先对问题进行验证，以确保其科学基础扎实、提法恰当且客观。该问题描述了 Fröhlich 极化子的强耦合极限，这是凝聚态物理中的一个经典课题。它要求进行标度分析和变分计算，这些都是标准的理论技术。物理量、单位和数学对象都有明确的定义。因此，该问题被认为是有效的。\n\n在指定的极化子单位（长度为 $\\ell = \\sqrt{\\hbar/(2 m \\omega_{LO})}$，能量为 $\\varepsilon_0 = \\hbar \\omega_{LO}$）下，Pekar 能量泛函描述了在绝热近似下电子-声子系统的总能量。需要最小化的泛函由电子动能的期望值加上由晶格静态极化场媒介的电子自相互作用能给出。根据该模型的标准推导，对于归一化波函数 $\\psi(\\mathbf{x})$（满足 $\\int d^3x |\\psi(\\mathbf{x})|^2 = 1$），无量纲能量泛函 $\\mathcal{E}[\\psi] \\equiv E[\\psi]/\\varepsilon_0$ 为：\n$$\n\\mathcal{E}[\\psi] = \\int |\\nabla\\psi(\\mathbf{x})|^2 d^3x - \\alpha \\iint \\frac{|\\psi(\\mathbf{x})|^2 |\\psi(\\mathbf{x}')|^2}{|\\mathbf{x}-\\mathbf{x}'|} d^3x d^3x'\n$$\n让我们将动能项和势能项分别表示为 $T[\\psi]$ 和 $V[\\psi]$：\n$$\nT[\\psi] = \\int |\\nabla\\psi(\\mathbf{x})|^2 d^3x\n$$\n$$\nV[\\psi] = \\alpha \\iint \\frac{|\\psi(\\mathbf{x})|^2 |\\psi(\\mathbf{x}')|^2}{|\\mathbf{x}-\\mathbf{x}'|} d^3x d^3x'\n$$\n使得 $\\mathcal{E}[\\psi] = T[\\psi] - V[\\psi]$。请注意，这里的相互作用项 $V[\\psi]$ 的定义中，耦合常数 $\\alpha$ 是一个前置因子。\n\n**第一部分：标度分析**\n我们使用标度变换拟设 $\\psi_{\\gamma}(\\mathbf{x}) = \\gamma^{3/2} \\varphi(\\gamma \\mathbf{x})$，其中 $\\varphi(\\mathbf{x})$ 是一个固定的、归一化的波函数形状，$\\gamma$ 是一个正实数标度参数。因子 $\\gamma^{3/2}$ 确保了对于所有 $\\gamma > 0$，$\\psi_{\\gamma}$ 保持归一化：\n$$\n\\int |\\psi_{\\gamma}(\\mathbf{x})|^2 d^3x = \\int \\gamma^3 |\\varphi(\\gamma\\mathbf{x})|^2 d^3x\n$$\n通过将积分变量变为 $\\mathbf{y} = \\gamma\\mathbf{x}$，从而 $d^3x = \\gamma^{-3} d^3y$，我们得到：\n$$\n\\int \\gamma^3 |\\varphi(\\mathbf{y})|^2 (\\gamma^{-3} d^3y) = \\int |\\varphi(\\mathbf{y})|^2 d^3y = 1\n$$\n因为 $\\varphi$ 是归一化的。\n\n接下来，我们分析动能项和势能项如何随 $\\gamma$ 标度变换。\n对于动能项 $T[\\psi_{\\gamma}]$：\n$$\n\\nabla\\psi_{\\gamma}(\\mathbf{x}) = \\nabla[\\gamma^{3/2} \\varphi(\\gamma\\mathbf{x})] = \\gamma^{3/2} [\\nabla_{\\gamma\\mathbf{x}}\\varphi(\\gamma\\mathbf{x})] \\gamma = \\gamma^{5/2} (\\nabla\\varphi)(\\gamma\\mathbf{x})\n$$\n因此，\n$$\nT[\\psi_{\\gamma}] = \\int |\\gamma^{5/2} (\\nabla\\varphi)(\\gamma\\mathbf{x})|^2 d^3x = \\gamma^5 \\int |(\\nabla\\varphi)(\\gamma\\mathbf{x})|^2 d^3x\n$$\n将变量变为 $\\mathbf{y} = \\gamma\\mathbf{x}$：\n$$\nT[\\psi_{\\gamma}] = \\gamma^5 \\int |(\\nabla\\varphi)(\\mathbf{y})|^2 (\\gamma^{-3} d^3y) = \\gamma^2 \\int |(\\nabla\\varphi)(\\mathbf{y})|^2 d^3y = \\gamma^2 T[\\varphi]\n$$\n动能以 $\\gamma^2$ 的形式进行标度变换。\n\n对于势能项 $V[\\psi_{\\gamma}]$：\n$$\nV[\\psi_{\\gamma}] = \\alpha \\iint \\frac{|\\psi_{\\gamma}(\\mathbf{x})|^2 |\\psi_{\\gamma}(\\mathbf{x}')|^2}{|\\mathbf{x}-\\mathbf{x}'|} d^3x d^3x' = \\alpha \\iint \\frac{\\gamma^3|\\varphi(\\gamma\\mathbf{x})|^2 \\gamma^3|\\varphi(\\gamma\\mathbf{x}')|^2}{|\\mathbf{x}-\\mathbf{x}'|} d^3x d^3x'\n$$\n将变量变为 $\\mathbf{y} = \\gamma\\mathbf{x}$ 和 $\\mathbf{y}' = \\gamma\\mathbf{x}'$，我们有 $d^3x = \\gamma^{-3} d^3y$，$d^3x' = \\gamma^{-3} d^3y'$，以及 $|\\mathbf{x}-\\mathbf{x}'| = \\gamma^{-1}|\\mathbf{y}-\\mathbf{y}'|$。\n$$\nV[\\psi_{\\gamma}] = \\alpha \\iint \\frac{\\gamma^6 |\\varphi(\\mathbf{y})|^2 |\\varphi(\\mathbf{y}')|^2}{\\gamma^{-1}|\\mathbf{y}-\\mathbf{y}'|} (\\gamma^{-3} d^3y) (\\gamma^{-3} d^3y') = \\gamma^{6+1-3-3} \\left( \\alpha \\iint \\frac{|\\varphi(\\mathbf{y})|^2 |\\varphi(\\mathbf{y}')|^2}{|\\mathbf{y}-\\mathbf{y}'|} d^3y d^3y' \\right)\n$$\n$$\nV[\\psi_{\\gamma}] = \\gamma V[\\varphi]\n$$\n势能以 $\\gamma$ 的形式进行标度变换。\n\n试探波函数 $\\psi_{\\gamma}$ 的总能量泛函为：\n$$\n\\mathcal{E}(\\gamma) = \\gamma^2 T[\\varphi] - \\gamma V[\\varphi]\n$$\n为了找到使此能量最小化的最优标度参数 $\\gamma_0$，我们对 $\\gamma$ 求导并令结果为零：\n$$\n\\frac{d\\mathcal{E}}{d\\gamma} = 2\\gamma T[\\varphi] - V[\\varphi] = 0\n$$\n$T[\\varphi]$ 和 $V[\\varphi]/\\alpha$ 是由固定形状函数 $\\varphi$ 决定的正常数。最优的 $\\gamma_0$ 是：\n$$\n\\gamma_0 = \\frac{V[\\varphi]}{2T[\\varphi]}\n$$\n由于 $V[\\varphi] \\propto \\alpha$，我们有 $\\gamma_0 \\propto \\alpha$。在强耦合极限下（$\\alpha \\gg 1$），波函数变得高度局域化（$\\gamma_0 \\gg 1$）。\n\n将 $\\gamma_0$ 代回能量泛函：\n$$\n\\mathcal{E}_0 = \\mathcal{E}(\\gamma_0) = \\gamma_0^2 T[\\varphi] - \\gamma_0 V[\\varphi] = \\gamma_0^2 T[\\varphi] - (2\\gamma_0 T[\\varphi]) \\gamma_0 = -\\gamma_0^2 T[\\varphi]\n$$\n或者，\n$$\n\\mathcal{E}_0 = \\left(\\frac{V[\\varphi]}{2T[\\varphi]}\\right)^2 T[\\varphi] - \\frac{V[\\varphi]}{2T[\\varphi]} V[\\varphi] = \\frac{V[\\varphi]^2}{4T[\\varphi]} - \\frac{V[\\varphi]^2}{2T[\\varphi]} = -\\frac{V[\\varphi]^2}{4T[\\varphi]}\n$$\n由于 $V[\\varphi] \\propto \\alpha$，基态能量 $\\mathcal{E}_0$ 以 $\\alpha^2$ 的形式进行标度变换：\n$$\n\\mathcal{E}_0 \\propto -\\alpha^2 \\quad \\implies \\quad E_0 = \\mathcal{E}_0 \\hbar\\omega_{LO} \\propto -\\alpha^2 \\hbar\\omega_{LO}\n$$\n这证明了在强耦合区域中对 $\\alpha$ 所需的平方依赖关系。\n\n**第二部分：比例常数的变分计算**\n我们使用单参数高斯试探波函数：\n$$\n\\psi_{\\lambda}(\\mathbf{x}) = \\left(\\frac{\\lambda}{\\pi}\\right)^{3/4} \\exp\\!\\left(-\\frac{\\lambda}{2}\\, \\mathbf{x}^2\\right)\n$$\n其中 $\\lambda > 0$ 是变分参数。此波函数是归一化的。\n\n首先，我们计算动能 $T[\\psi_{\\lambda}]$：\n$$\n\\nabla\\psi_{\\lambda}(\\mathbf{x}) = \\left(\\frac{\\lambda}{\\pi}\\right)^{3/4} (-\\lambda\\mathbf{x}) \\exp\\!\\left(-\\frac{\\lambda}{2}\\, \\mathbf{x}^2\\right)\n$$\n$$\n|\\nabla\\psi_{\\lambda}(\\mathbf{x})|^2 = \\left(\\frac{\\lambda}{\\pi}\\right)^{3/2} \\lambda^2 |\\mathbf{x}|^2 \\exp(-\\lambda \\mathbf{x}^2)\n$$\n$$\nT[\\psi_{\\lambda}] = \\int |\\nabla\\psi_{\\lambda}(\\mathbf{x})|^2 d^3x = \\left(\\frac{\\lambda}{\\pi}\\right)^{3/2} \\lambda^2 \\int_0^{\\infty} (4\\pi r^2) r^2 e^{-\\lambda r^2} dr = 4\\pi \\left(\\frac{\\lambda}{\\pi}\\right)^{3/2} \\lambda^2 \\int_0^{\\infty} r^4 e^{-\\lambda r^2} dr\n$$\n使用标准积分 $\\int_0^{\\infty} r^4 e^{-ar^2} dr = \\frac{3}{8a^2}\\sqrt{\\frac{\\pi}{a}}$，其中 $a=\\lambda$：\n$$\nT[\\psi_{\\lambda}] = 4\\pi \\frac{\\lambda^{3/2}}{\\pi^{3/2}} \\lambda^2 \\left( \\frac{3}{8\\lambda^2} \\sqrt{\\frac{\\pi}{\\lambda}} \\right) = \\frac{12\\pi\\lambda^2}{8\\pi} \\frac{\\lambda^{3/2}}{\\lambda^2 \\lambda^{1/2}} = \\frac{3}{2}\\lambda\n$$\n\n接下来，我们计算相互作用积分，它对应于高斯电荷分布 $\\rho(\\mathbf{x}) = |\\psi_\\lambda(\\mathbf{x})|^2$ 的静电自能：\n$$\nP[\\psi_{\\lambda}] = \\iint \\frac{|\\psi_{\\lambda}(\\mathbf{x})|^2 |\\psi_{\\lambda}(\\mathbf{x}')|^2}{|\\mathbf{x}-\\mathbf{x}'|} d^3x d^3x'\n$$\n已知此积分为 $P[\\psi_{\\lambda}] = \\sqrt{2\\lambda/\\pi}$。为了完整起见，我们可以通过先计算势 $\\Phi(\\mathbf{x}) = \\int d^3x' \\rho(\\mathbf{x}')/|\\mathbf{x}-\\mathbf{x}'|$ 来推导它，对于高斯分布，该势为 $\\Phi(r) = (1/r) \\text{erf}(\\sqrt{\\lambda}r)$。然后，\n$$\nP[\\psi_{\\lambda}] = \\int \\rho(\\mathbf{x}) \\Phi(\\mathbf{x}) d^3x = \\int_0^{\\infty} 4\\pi r^2 \\left(\\frac{\\lambda}{\\pi}\\right)^{3/2} e^{-\\lambda r^2} \\frac{1}{r} \\text{erf}(\\sqrt{\\lambda}r) dr\n$$\n$$\nP[\\psi_{\\lambda}] = 4\\pi \\left(\\frac{\\lambda}{\\pi}\\right)^{3/2} \\int_0^{\\infty} r e^{-\\lambda r^2} \\text{erf}(\\sqrt{\\lambda}r) dr\n$$\n令 $u = \\sqrt{\\lambda}r$，则 $du = \\sqrt{\\lambda}dr$。积分变为：\n$$\nP[\\psi_{\\lambda}] = 4\\pi \\left(\\frac{\\lambda}{\\pi}\\right)^{3/2} \\frac{1}{\\lambda} \\int_0^{\\infty} u e^{-u^2} \\text{erf}(u) du\n$$\n该定积分的值为 $\\int_0^{\\infty} u e^{-u^2} \\text{erf}(u)du = 1/(2\\sqrt{2})$。\n$$\nP[\\psi_{\\lambda}] = 4\\pi \\frac{\\lambda^{3/2}}{\\pi^{3/2}} \\frac{1}{\\lambda} \\frac{1}{2\\sqrt{2}} = \\frac{2\\sqrt{2}\\pi \\lambda^{1/2}}{\\pi^{3/2}} = \\sqrt{\\frac{2\\lambda}{\\pi}}\n$$\n\n高斯试探函数的总能量泛函为：\n$$\n\\mathcal{E}(\\lambda) = T[\\psi_{\\lambda}] - \\alpha P[\\psi_\\lambda] = \\frac{3}{2}\\lambda - \\alpha \\sqrt{\\frac{2\\lambda}{\\pi}} = \\frac{3}{2}\\lambda - \\alpha \\sqrt{\\frac{2}{\\pi}}\\sqrt{\\lambda}\n$$\n我们对此式关于 $\\lambda$ 进行最小化：\n$$\n\\frac{d\\mathcal{E}}{d\\lambda} = \\frac{3}{2} - \\alpha \\sqrt{\\frac{2}{\\pi}} \\frac{1}{2\\sqrt{\\lambda}} = 0\n$$\n$$\n3\\sqrt{\\lambda_0} = \\alpha \\sqrt{\\frac{2}{\\pi}} \\implies \\sqrt{\\lambda_0} = \\frac{\\alpha}{3}\\sqrt{\\frac{2}{\\pi}}\n$$\n因此，参数的最优值为 $\\lambda_0 = \\frac{2\\alpha^2}{9\\pi}$。\n\n将 $\\lambda_0$ 代回能量表达式 $\\mathcal{E}(\\lambda)$：\n$$\n\\mathcal{E}_0 = \\mathcal{E}(\\lambda_0) = \\frac{3}{2}\\lambda_0 - \\alpha \\sqrt{\\frac{2}{\\pi}}\\sqrt{\\lambda_0}\n$$\n从最小化条件，我们可以代入 $\\alpha\\sqrt{2/\\pi} = 3\\sqrt{\\lambda_0}$：\n$$\n\\mathcal{E}_0 = \\frac{3}{2}\\lambda_0 - (3\\sqrt{\\lambda_0})\\sqrt{\\lambda_0} = \\frac{3}{2}\\lambda_0 - 3\\lambda_0 = -\\frac{3}{2}\\lambda_0\n$$\n现在，代入 $\\lambda_0$ 的表达式：\n$$\n\\mathcal{E}_0 = -\\frac{3}{2} \\left(\\frac{2\\alpha^2}{9\\pi}\\right) = -\\frac{3\\alpha^2}{9\\pi} = -\\frac{\\alpha^2}{3\\pi}\n$$\n因此，估计的基态能量为：\n$$\nE_0(\\alpha) \\approx -\\frac{1}{3\\pi} \\alpha^2 \\hbar\\omega_{LO}\n$$\n通过将其与目标形式 $E_0(\\alpha) \\approx - c\\, \\alpha^2\\, \\hbar\\omega_{LO}$ 进行比较，我们确定了比例常数 $c$。\n$$\nc = \\frac{1}{3\\pi}\n$$", "answer": "$$\\boxed{\\frac{1}{3\\pi}}$$", "id": "3010617"}, {"introduction": "为了连接理论模型与现代计算物理研究的实践，本练习将带你进入数据驱动的分析领域。量子蒙特卡洛等先进的数值方法通常在虚时间中进行计算，产生的数据无法直接与实验中的实频物理量（如能谱）进行比较。这个练习将指导你完成一个关键的技术流程：通过解析延拓，从虚时格林函数数据中提取出真实的极化子能谱和色散关系，这是凝聚态计算物理中的一项核心技能 [@problem_id:3010624]。", "problem": "考虑一个单极化子问题，其中一个电子与无色散光学声子浴相互作用，在低能区产生一个定义明确的准粒子，并在高能区产生一个非相干连续谱。在零温下，对于 $\\tau>0$ 的电子增添虚时格林函数 $G(\\mathbf{k},\\tau)$ 具有一个 Lehmann 谱表示，该表示由一个支撑集为 $\\omega \\ge 0$ 的非负谱函数 $A^{+}(\\mathbf{k},\\omega)$ 给出。从基础的多体形式理论出发，利用谱表示和拉普拉斯逆变换来提取极化子色散 $E(\\mathbf{k})$。\n\n你的推导必须基于以下经过充分检验的事实和定义：\n- 电子增添谱函数的 Lehmann 谱表示意味着，在零温且 $\\tau>0$ 时，虚时格林函数满足\n$$\nG(\\mathbf{k},\\tau) = -\\int_{0}^{\\infty} d\\omega\\, A^{+}(\\mathbf{k},\\omega) e^{-\\omega \\tau},\n$$\n其中 $A^{+}(\\mathbf{k},\\omega)\\ge 0$ 编码了增添一个动量为 $\\mathbf{k}$、能量为 $\\omega$ 的电子的概率幅密度。\n- 低能准粒子峰将极化子色散 $E(\\mathbf{k})$ 定义为 $A^{+}(\\mathbf{k},\\omega)$ 中能量最低的孤立峰的位置。\n\n你必须通过在非负性和光滑性约束下对上述积分方程求逆，来实现一个从虚时到实频的解析延拓过程。具体来说：\n- 将 $\\omega$ 在间距为 $\\Delta \\omega$ 的均匀网格 $\\{\\omega_j\\}_{j=0}^{N_\\omega-1}$ 上离散化，并将 $\\tau$ 在均匀网格 $\\{\\tau_i\\}_{i=0}^{N_\\tau-1}$ 上离散化。\n- 用线性系统近似该积分方程\n$$\nG_i \\approx \\sum_{j=0}^{N_\\omega-1} K_{ij} A_j, \\quad K_{ij} = e^{-\\omega_j \\tau_i}\\Delta \\omega,\n$$\n其中 $A_j \\approx A^{+}(\\mathbf{k},\\omega_j)$。\n- 通过求解一个正则化的非负最小二乘（NNLS）问题来恢复 $A_j$\n$$\n\\min_{A_j \\ge 0} \\left\\| K A - G \\right\\|_2^2 + \\lambda \\left\\| L A \\right\\|_2^2,\n$$\n其中 $L$ 是一个施加光滑性的一阶差分算子，$\\lambda>0$ 是正则化强度。通过将系统增广为以下形式来实现：\n$$\n\\begin{pmatrix}\nK \\\\\n\\sqrt{\\lambda} L\n\\end{pmatrix} A \\approx\n\\begin{pmatrix}\nG \\\\\n0\n\\end{pmatrix},\n$$\n并对 $A$ 求解 NNLS 问题。\n- 将 $E(\\mathbf{k})$ 确定为 $A^{+}(\\mathbf{k},\\omega)$ 的能量最低的显著局域极大值的位置 $\\omega$。\n\n你的程序必须实现此流程，并针对一个指定的、由已知谱函数生成的合成量子蒙特卡洛式数据测试套件，输出极化子色散。所有能量必须以毫电子伏（meV）表示，虚时以逆毫电子伏（$\\mathrm{meV}^{-1}$）表示。角度单位在此不适用。输出的能量必须四舍五入到六位小数。\n\n测试套件的数据生成必须使用形式为以下公式的具有物理动机的谱函数：\n$$\nA^{+}(\\mathbf{k},\\omega) = Z(\\mathbf{k})\\, \\frac{1}{\\sqrt{2\\pi}\\sigma_{\\mathrm{pk}}}\\exp\\!\\left(-\\frac{[\\omega - E(\\mathbf{k})]^2}{2\\sigma_{\\mathrm{pk}}^2}\\right) + A_{\\mathrm{cont}}\\, \\frac{1}{\\sqrt{2\\pi}\\sigma_{\\mathrm{cont}}}\\exp\\!\\left(-\\frac{[\\omega - \\omega_{\\mathrm{cont}}]^2}{2\\sigma_{\\mathrm{cont}}^2}\\right),\n$$\n其中 $Z(\\mathbf{k})$ 是准粒子权重，$\\sigma_{\\mathrm{pk}}$ 是一个近似 delta 峰的小宽度，$A_{\\mathrm{cont}}$ 是非相干连续谱的积分权重（因此连续谱高斯函数的积分为 $A_{\\mathrm{cont}}$），$\\omega_{\\mathrm{cont}}$ 和 $\\sigma_{\\mathrm{cont}}$ 分别是其中心和宽度。极化子色散在其最小值附近被建模为抛物线形式：\n$$\nE(\\mathbf{k}) = E_0 + a\\, |\\mathbf{k}|^2,\n$$\n其中 $E_0$ 的单位是 meV，$a$ 的单位是 $\\mathrm{meV}\\cdot\\mathrm{nm}^2$。这种简化的有效质量形式是一种标准的低 $\\mathbf{k}$ 近似，并且足以用于生成测试数据。\n\n实现以下测试套件。对于每个测试用例，在 $\\omega \\in [0, \\omega_{\\max}]$（其中 $\\omega_{\\max} = 300\\,\\mathrm{meV}$，$\\Delta\\omega = 1\\,\\mathrm{meV}$）的网格上构建 $A^{+}(\\mathbf{k},\\omega)$；通过在 $\\tau \\in [\\tau_{\\min}, \\tau_{\\max}]$（其中 $\\tau_{\\min}=0.05\\,\\mathrm{meV}^{-1}$，$\\tau_{\\max}=5.00\\,\\mathrm{meV}^{-1}$，以及 $N_\\tau=100$ 个均匀分布的点）的网格上离散化积分来构建 $G(\\mathbf{k},\\tau)$；并添加均值为零、标准差等于该情况下 $G(\\mathbf{k},\\tau)$ 最大值的 $10^{-4}$ 倍的微小高斯噪声。\n\n测试套件参数集：\n- 用例 1（一般情况）：$|\\mathbf{k}| = 0.50\\,\\mathrm{nm}^{-1}$，$E_0 = 20\\,\\mathrm{meV}$，$a = 8\\,\\mathrm{meV}\\cdot\\mathrm{nm}^2$，$Z(\\mathbf{k}) = 0.7$，$A_{\\mathrm{cont}} = 0.3$，$\\omega_{\\mathrm{cont}} = 110\\,\\mathrm{meV}$，$\\sigma_{\\mathrm{cont}} = 35\\,\\mathrm{meV}$，$\\sigma_{\\mathrm{pk}} = 2\\,\\mathrm{meV}$。\n- 用例 2（重准粒子）：$|\\mathbf{k}| = 1.50\\,\\mathrm{nm}^{-1}$，$E_0 = 30\\,\\mathrm{meV}$，$a = 3\\,\\mathrm{meV}\\cdot\\mathrm{nm}^2$，$Z(\\mathbf{k}) = 0.5$，$A_{\\mathrm{cont}} = 0.6$，$\\omega_{\\mathrm{cont}} = 90\\,\\mathrm{meV}$，$\\sigma_{\\mathrm{cont}} = 50\\,\\mathrm{meV}$，$\\sigma_{\\mathrm{pk}} = 2\\,\\mathrm{meV}$。\n- 用例 3（低准粒子权重，强连续谱）：$|\\mathbf{k}| = 0.10\\,\\mathrm{nm}^{-1}$，$E_0 = 12\\,\\mathrm{meV}$，$a = 5\\,\\mathrm{meV}\\cdot\\mathrm{nm}^2$，$Z(\\mathbf{k}) = 0.2$，$A_{\\mathrm{cont}} = 0.9$，$\\omega_{\\mathrm{cont}} = 80\\,\\mathrm{meV}$，$\\sigma_{\\mathrm{cont}} = 60\\,\\mathrm{meV}$，$\\sigma_{\\mathrm{pk}} = 2\\,\\mathrm{meV}$。\n\n使用正则化强度 $\\lambda = 10^{-2}$ 和一个由下式定义的一阶差分矩阵 $L$：\n$$\n(LA)_j = A_{j} - A_{j+1}, \\quad j=0,\\dots,N_\\omega-2.\n$$\n\n峰值识别规则：在离散网格上确定 $A^{+}(\\mathbf{k},\\omega)$ 的局域极大值。在满足 $\\omega \\le \\omega_{\\mathrm{search}}$ 且振幅大于全局最大值 $\\alpha$ 倍的局域极大值中，选择 $\\omega$ 最小的那个。使用 $\\omega_{\\mathrm{search}} = 60\\,\\mathrm{meV}$ 和 $\\alpha = 0.05$。如果没有局域极大值满足这些标准，则选择限制在 $\\omega \\le \\omega_{\\mathrm{search}}$ 内的全局最大值。\n\n你的程序应针对上述测试套件，生成单行输出，其中包含三个提取出的色散值 $[E(\\mathbf{k}_1),E(\\mathbf{k}_2),E(\\mathbf{k}_3)]$，形式为用逗号分隔并括在方括号中的列表，每个能量值以 meV 为单位，四舍五入到六位小数，格式完全如下：\n$[E_1,E_2,E_3]$。", "solution": "这个问题的核心任务是通过分析合成的虚时格林函数数据 $G(\\mathbf{k},\\tau)$ 来确定极化子色散关系 $E(\\mathbf{k})$。这是计算凝聚态物理中的一个常见问题，尤其是在采用天然在虚时下运算的量子蒙特卡洛（QMC）方法的研究中。解决方案要求执行一个从虚时 $\\tau$到实频 $\\omega$ 的解析延拓，这是一个在数值上具有挑战性的过程。\n\n该过程的理论基础是 Lehmann 谱表示。在零温（$T=0$）下，动量为 $\\mathbf{k}$ 的电子的增添虚时格林函数 $G(\\mathbf{k},\\tau)$ 通过一个拉普拉斯变换与其对应的谱函数 $A^{+}(\\mathbf{k},\\omega)$ 相关联：\n$$\nG(\\mathbf{k},\\tau) = -\\int_{0}^{\\infty} d\\omega\\, A^{+}(\\mathbf{k},\\omega) e^{-\\omega \\tau} \\quad (\\text{对于 } \\tau>0)\n$$\n谱函数 $A^{+}(\\mathbf{k},\\omega)$ 是一个非负量，代表将一个动量为 $\\mathbf{k}$、能量为 $\\omega$ 的电子添加到系统中的概率密度。极化子是一种由电子被声子云“缀饰”而形成的准粒子，它在 $A^{+}(\\mathbf{k},\\omega)$ 的最低能量处表现为一个独特而尖锐的峰。这个峰的位置定义了极化子色散关系 $E(\\mathbf{k})$。我们的目标是从 $G(\\mathbf{k},\\tau)$ 的含噪数据中恢复 $A^{+}(\\mathbf{k},\\omega)$，然后定位这个峰。\n\n拉普拉斯逆变换是一个经典的不适定问题；输入数据 $G(\\mathbf{k},\\tau)$ 中的少量噪声可能导致恢复出的解 $A^{+}(\\mathbf{k},\\omega)$ 中出现巨大的、不符合物理规律的振荡。为了获得稳定且有物理意义的解，我们采用指定的正则化反演方案。\n\n第一步是将问题离散化。我们在均匀网格上表示连续函数：$\\tau$ 在网格 $\\{\\tau_i\\}_{i=0}^{N_\\tau-1}$ 上，$\\omega$ 在网格 $\\{\\omega_j\\}_{j=0}^{N_\\omega-1}$ 上。积分方程随之变为一个线性方程组。令 $D_i = -G(\\mathbf{k},\\tau_i) > 0$。离散化后的关系为：\n$$\nD_i = \\int_{0}^{\\infty} d\\omega\\, A^{+}(\\mathbf{k},\\omega) e^{-\\omega \\tau_i} \\approx \\sum_{j=0}^{N_\\omega-1} A^{+}(\\mathbf{k},\\omega_j) e^{-\\omega_j \\tau_i} \\Delta\\omega\n$$\n这可以写成矩阵形式 $D \\approx K A$，其中 $A$ 是未知谱函数值 $A_j = A^{+}(\\mathbf{k},\\omega_j)$ 的向量，$D$ 是输入数据 $D_i$ 的向量，而 $K$ 是核矩阵，其元素为 $K_{ij} = e^{-\\omega_j \\tau_i} \\Delta\\omega$。\n\n为了克服这种反演的不适定性，我们引入两个约束。首先是谱函数非负的物理要求，$A_j \\ge 0$。其次，我们添加一个 Tikhonov 正则化项，对解施加光滑性约束。这通过最小化一个复合目标函数来实现：\n$$\n\\min_{A \\ge 0} \\left\\| K A - D \\right\\|_2^2 + \\lambda \\left\\| L A \\right\\|_2^2\n$$\n此处，$\\| \\cdot \\|_2^2$ 表示欧几里得范数的平方，$\\lambda$ 是一个正的正则化参数，它控制着数据拟合与解的光滑度之间的权衡，而 $L$ 是一个近似微分算子的矩阵。问题指定了一个一阶差分算子 $(LA)_j = A_j - A_{j+1}$，它会惩罚谱中相邻点之间的大跳跃。\n\n这个带非负性约束的正则化最小化问题，可以方便地重构为一个标准的非负最小二乘（NNLS）问题。我们构建一个增广矩阵和一个增广数据向量：\n$$\n\\tilde{K} = \\begin{pmatrix} K \\\\ \\sqrt{\\lambda} L \\end{pmatrix}, \\quad \\tilde{D} = \\begin{pmatrix} D \\\\ \\mathbf{0} \\end{pmatrix}\n$$\n问题于是等价于求解 $\\min_{\\tilde{A} \\ge 0} \\| \\tilde{K} \\tilde{A} - \\tilde{D} \\|_2^2$，对此存在高效的数值求解器，例如 `scipy.optimize.nnls`。\n\n对于每个测试用例，总体算法流程如下：\n1.  **数据合成**：我们首先生成合成的“实验”数据。一个具有物理动机的谱函数 $A^{+}(\\mathbf{k},\\omega)$ 被构建为代表极化子峰的尖锐高斯函数与代表非相干连续谱的宽广高斯函数之和。极化子峰的位置 $E(\\mathbf{k})$ 由抛物线有效质量近似 $E(\\mathbf{k}) = E_0 + a|\\mathbf{k}|^2$ 给出。通过将这个 $A^{+}(\\mathbf{k},\\omega)$ 与拉普拉斯核 $e^{-\\omega \\tau_i}$进行数值积分来计算格林函数 $G(\\mathbf{k},\\tau_i)$。最后，添加少量高斯噪声以模拟实验不确定性。然后将求解器的输入向量设置为 $D_i = -G_{\\text{noisy}}(\\mathbf{k},\\tau_i)$。\n\n2.  **解析延拓**：使用给定的参数（$\\lambda$、网格定义等）构建增广线性系统 $(\\tilde{K}, \\tilde{D})$。求解 NNLS 问题以获得重构的谱函数 $A_{\\text{recon}}$。\n\n3.  **峰值识别**：最后一步是从 $A_{\\text{recon}}$ 中提取极化子能量。我们识别出重构谱中的所有局域极大值。根据指定的规则，我们筛选这些极大值，只考虑那些低于搜索能量截止值 $\\omega_{\\mathrm{search}} = 60\\,\\mathrm{meV}$ 且振幅超过 $A_{\\text{recon}}$ 全局最大值 $\\alpha=0.05$ 倍阈值的极大值。极化子能量 $E(\\mathbf{k})$ 随后被确定为满足这些标准的最低频率峰的能量。如果找不到这样的峰，则一个备用程序会选择搜索区域 $\\omega \\le \\omega_{\\text{search}}$ 内的全局最大值。\n\n此过程为从虚时关联数据中提取谱信息提供了一种稳健且标准的方法，这是现代计算物理学中的一项基本任务。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Solves the polaron dispersion problem by performing analytic continuation\n    on synthetic imaginary-time Green's function data.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {  # Case 1 (general case)\n            \"k_mag\": 0.50, \"E0\": 20.0, \"a\": 8.0, \"Zk\": 0.7, \"A_cont\": 0.3,\n            \"omega_cont\": 110.0, \"sigma_cont\": 35.0, \"sigma_pk\": 2.0\n        },\n        {  # Case 2 (heavy quasiparticle)\n            \"k_mag\": 1.50, \"E0\": 30.0, \"a\": 3.0, \"Zk\": 0.5, \"A_cont\": 0.6,\n            \"omega_cont\": 90.0, \"sigma_cont\": 50.0, \"sigma_pk\": 2.0\n        },\n        {  # Case 3 (low quasiparticle weight, strong continuum)\n            \"k_mag\": 0.10, \"E0\": 12.0, \"a\": 5.0, \"Zk\": 0.2, \"A_cont\": 0.9,\n            \"omega_cont\": 80.0, \"sigma_cont\": 60.0, \"sigma_pk\": 2.0\n        }\n    ]\n\n    # --- Global parameters ---\n    # Grids\n    omega_max = 300.0\n    delta_omega = 1.0\n    tau_min = 0.05\n    tau_max = 5.00\n    N_tau = 100\n    \n    # Analytic continuation parameters\n    reg_lambda = 1e-2\n    \n    # Peak identification parameters\n    omega_search = 60.0\n    alpha_threshold = 0.05\n    \n    # Use a seeded random number generator for reproducibility\n    rng = np.random.default_rng(42)\n\n    # --- Setup grids ---\n    omega_grid = np.arange(0, omega_max + delta_omega, delta_omega)\n    N_omega = len(omega_grid)\n    tau_grid = np.linspace(tau_min, tau_max, N_tau)\n\n    results = []\n    \n    for params in test_cases:\n        # --- 1. Generate synthetic data ---\n        \n        # True polaron dispersion energy\n        E_k_true = params[\"E0\"] + params[\"a\"] * params[\"k_mag\"]**2\n        \n        # Spectral function A(k, w)\n        def gaussian(x, mu, sigma):\n            return 1.0 / (np.sqrt(2 * np.pi) * sigma) * np.exp(-(x - mu)**2 / (2 * sigma**2))\n            \n        A_peak = params[\"Zk\"] * gaussian(omega_grid, E_k_true, params[\"sigma_pk\"])\n        A_continuum = params[\"A_cont\"] * gaussian(omega_grid, params[\"omega_cont\"], params[\"sigma_cont\"])\n        A_true = A_peak + A_continuum\n        \n        # Imaginary-time Green's function G(k, tau)\n        # G(tau) = - integral A(w) * exp(-w*tau) dw\n        kernel_for_integration = np.exp(-np.outer(tau_grid, omega_grid))\n        G_true = -delta_omega * (kernel_for_integration @ A_true)\n        \n        # Add a small amount of Gaussian noise\n        noise_std_dev = 1e-4 * np.max(np.abs(G_true))\n        noise = rng.normal(loc=0.0, scale=noise_std_dev, size=N_tau)\n        G_noisy = G_true + noise\n        \n        # The input data for the least-squares problem is D = -G\n        D_data = -G_noisy\n        \n        # --- 2. Perform Analytic Continuation ---\n        \n        # Construct kernel matrix K for the linear system D = KA\n        # K_ij = exp(-w_j * tau_i) * delta_omega\n        K = kernel_for_integration * delta_omega\n        \n        # Construct the first-difference regularization matrix L\n        # (LA)_j = A_j - A_{j+1}\n        L = np.diag(np.ones(N_omega)) - np.diag(np.ones(N_omega - 1), k=1)\n        L = L[:-1, :]\n        \n        # Construct the augmented system for regularized NNLS\n        sqrt_lambda = np.sqrt(reg_lambda)\n        K_augmented = np.vstack([K, sqrt_lambda * L])\n        D_augmented = np.concatenate([D_data, np.zeros(L.shape[0])])\n        \n        # Solve the NNLS problem to find the reconstructed spectral function\n        A_recon, _ = nnls(K_augmented, D_augmented)\n        \n        # --- 3. Extract Polaron Energy from Reconstructed Spectrum ---\n        \n        # Find all local maxima in the reconstructed spectrum A_recon\n        local_maxima_indices = []\n        for j in range(1, N_omega - 1):\n            if A_recon[j] > A_recon[j-1] and A_recon[j] > A_recon[j+1]:\n                local_maxima_indices.append(j)\n        \n        # Filter the maxima based on the given criteria\n        A_max_global = np.max(A_recon)\n        candidate_peaks = []\n        if A_max_global > 0:\n            for idx in local_maxima_indices:\n                if (omega_grid[idx] = omega_search and \n                    A_recon[idx] > alpha_threshold * A_max_global):\n                    candidate_peaks.append((omega_grid[idx], A_recon[idx]))\n\n        # Sort candidates by energy (lowest first)\n        candidate_peaks.sort(key=lambda p: p[0])\n        \n        extracted_energy = 0.0\n        if candidate_peaks:\n            # The polaron energy is the lowest-energy significant peak\n            extracted_energy = candidate_peaks[0][0]\n        else:\n            # Fallback: find the global maximum within the search energy window\n            search_region_indices = np.where(omega_grid = omega_search)[0]\n            if len(search_region_indices) > 0:\n                A_recon_search_region = A_recon[search_region_indices]\n                max_idx_in_region = np.argmax(A_recon_search_region)\n                # Convert back to index in the full omega_grid\n                best_idx = search_region_indices[max_idx_in_region]\n                extracted_energy = omega_grid[best_idx]\n            else:\n                 # Should not happen as omega_search > 0\n                extracted_energy = -1.0 \n    \n        results.append(extracted_energy)\n\n    # Format the results to 6 decimal places and print in the required format\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3010624"}]}