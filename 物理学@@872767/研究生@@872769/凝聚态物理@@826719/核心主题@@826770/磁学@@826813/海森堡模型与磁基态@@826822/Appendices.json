{"hands_on_practices": [{"introduction": "海森堡模型的核心是理解自旋间的交换相互作用。本练习通过分析一个孤立的自旋-$\\frac{1}{2}$二聚体（dimer）来探讨这一基本概念，这可以说是量子磁学中的“氢原子”问题。通过构建总自旋并对角化海森堡哈密顿量，您将推导出单重态和三重态的能量，并学会如何利用非弹性中子散射（INS）等实验数据来确定交换耦合常数$J$的符号和大小。这个练习是理解更复杂磁系统电子结构和激发谱的基础。[@problem_id:3012185]", "problem": "考虑一个准一维磁性绝缘体中由两个局域自旋-$\\frac{1}{2}$矩构成的二聚体，该二聚体与其他二聚体充分分离，因此在二聚体内交换作用的能量标度上，二聚体间的耦合可以忽略不计。其低能磁相互作用是各向同性的，由海森堡哈密顿量 $\\hat{H} = J \\,\\mathbf{S}_{1}\\cdot\\mathbf{S}_{2}$ 描述，其中 $J$ 是交换常数，$\\mathbf{S}_{i}$ 是适用于晶格自旋模型的无量纲自旋算符。假设在自旋空间中具有旋转不变性。从量子力学中的基本角动量相加出发，使用总自旋构造法对 $\\hat{H}$ 进行对角化，并确定单重态和三重态本征态的能量（表示为 $J$ 的函数）。\n\n一项使用非弹性中子散射（INS）的实验检测到一个有能隙的单一磁模式，该模式是三重简并的，源于一个非简并的基态。测量得到该模式从基态跃迁的能量转移为 $2.947$ meV。利用能级分裂和简并度的信息，推断 $J$ 的符号并计算其值。将最终数值答案四舍五入到四位有效数字，并以 meV 为单位表示。仅输出 $J$ 的值（带符号）作为最终答案。", "solution": "用户提供的问题在科学上是合理的、提法得当、客观，并且包含了得到唯一解所需的所有信息。该问题要求对自旋二聚体的海森堡哈密顿量进行对角化，然后根据实验数据确定交换常数 $J$。该问题是有效的。\n\n该系统由两个局域自旋-$\\frac{1}{2}$矩组成，由各向同性的海森堡哈密顿量描述：\n$$\n\\hat{H} = J \\,\\mathbf{S}_{1}\\cdot\\mathbf{S}_{2}\n$$\n此处，$J$ 是交换常数，$\\mathbf{S}_{1}$ 和 $\\mathbf{S}_{2}$ 是无量纲的自旋-$\\frac{1}{2}$算符。为对角化此哈密顿量，我们采用总自旋构造法。总自旋算符 $\\mathbf{S}$ 定义为单个自旋算符的矢量和：\n$$\n\\mathbf{S} = \\mathbf{S}_{1} + \\mathbf{S}_{2}\n$$\n对总自旋算符进行平方，我们得到：\n$$\n\\mathbf{S}^2 = (\\mathbf{S}_{1} + \\mathbf{S}_{2}) \\cdot (\\mathbf{S}_{1} + \\mathbf{S}_{2}) = \\mathbf{S}_{1}^2 + \\mathbf{S}_{2}^2 + 2\\mathbf{S}_{1}\\cdot\\mathbf{S}_{2}\n$$\n根据这个关系，我们可以用自旋平方算符来表示相互作用项 $\\mathbf{S}_{1}\\cdot\\mathbf{S}_{2}$，这些算符在总自旋基下的本征值是已知的。\n$$\n\\mathbf{S}_{1}\\cdot\\mathbf{S}_{2} = \\frac{1}{2} (\\mathbf{S}^2 - \\mathbf{S}_{1}^2 - \\mathbf{S}_{2}^2)\n$$\n将此代入哈密顿量，得到：\n$$\n\\hat{H} = \\frac{J}{2} (\\mathbf{S}^2 - \\mathbf{S}_{1}^2 - \\mathbf{S}_{2}^2)\n$$\n这种形式的哈密顿量在总自旋的本征态基 $|s, m_s\\rangle$ 中是对角的，其中 $s$ 是总自旋量子数，$m_s$ 是其投影。对于给定的态 $|s, s_1, s_2\\rangle$，自旋平方算符的本征值分别为 $s(s+1)$、$s_1(s_1+1)$ 和 $s_2(s_2+1)$，因为这些算符是无量纲的（即，在 $\\hbar=1$ 的单位制中）。\n\n对于两个自旋-$\\frac{1}{2}$ 的粒子，我们有 $s_1 = \\frac{1}{2}$ 和 $s_2 = \\frac{1}{2}$。根据角动量相加法则，总自旋量子数 $s$ 的取值范围是从 $|s_1 - s_2|$ 到 $s_1 + s_2$。因此，可能的值为：\n$$\ns \\in \\left\\{ \\left|\\frac{1}{2} - \\frac{1}{2}\\right|, \\dots, \\frac{1}{2} + \\frac{1}{2} \\right\\} \\implies s \\in \\{0, 1\\}\n$$\n这两个 $s$ 值对应两个不同的能级：\n1.  **单重态**，其中 $s=0$。该态是非简并的，因为其简并度为 $2s+1 = 2(0)+1=1$。\n2.  **三重态**，其中 $s=1$。该态是三重简并的，因为其简并度为 $2s+1 = 2(1)+1=3$。\n\n现在我们计算这些态各自的能量本征值。对于这两个态，$\\mathbf{S}_1^2$ 和 $\\mathbf{S}_2^2$ 的本征值是相同的：$s_1(s_1+1) = s_2(s_2+1) = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$。\n\n对于单重态 ($s=0$)：\n$\\mathbf{S}^2$ 的本征值为 $s(s+1) = 0(0+1) = 0$。\n单重态的能量 $E_S$ 为：\n$$\nE_S = \\frac{J}{2} \\left(0 - \\frac{3}{4} - \\frac{3}{4}\\right) = \\frac{J}{2} \\left(-\\frac{3}{2}\\right) = -\\frac{3}{4}J\n$$\n\n对于三重态 ($s=1$)：\n$\\mathbf{S}^2$ 的本征值为 $s(s+1) = 1(1+1) = 2$。\n三重态的能量 $E_T$ 为：\n$$\nE_T = \\frac{J}{2} \\left(2 - \\frac{3}{4} - \\frac{3}{4}\\right) = \\frac{J}{2} \\left(2 - \\frac{3}{2}\\right) = \\frac{J}{2} \\left(\\frac{1}{2}\\right) = +\\frac{1}{4}J\n$$\n\n来自非弹性中子散射（INS）的实验结果提供了关键信息。实验观测到一个单一磁模式，对应于从一个**非简并基态**到**三重简并激发态**的激发。我们的分析表明，单重态（$s=0$）是非简并的，而三重态（$s=1$）是三重简并的。因此，实验观测到的是从单重态到三重态的跃迁（或反之）。要使单重态成为基态，其能量必须低于三重态的能量：\n$$\nE_S  E_T \\implies -\\frac{3}{4}J  \\frac{1}{4}J\n$$\n在不等式两边同时加上 $\\frac{3}{4}J$ 可得：\n$$\n0  \\frac{1}{4}J + \\frac{3}{4}J \\implies 0  J\n$$\n这意味着交换常数 $J$ 必须为正（$J0$），这对应于反铁磁相互作用。非简并基态是单重态，三重简并激发态是三重态。\n\n在INS实验中测得的能量转移 $\\Delta E$ 是激发态和基态之间的能量差：\n$$\n\\Delta E = E_{\\text{excited}} - E_{\\text{ground}} = E_T - E_S\n$$\n代入能量的表达式：\n$$\n\\Delta E = \\left(\\frac{1}{4}J\\right) - \\left(-\\frac{3}{4}J\\right) = \\frac{1}{4}J + \\frac{3}{4}J = J\n$$\n问题陈述中提到，测得的能量转移为 $\\Delta E = 2.947$ meV。因此，我们可以将其直接等同于交换常数 $J$：\n$$\nJ = 2.947 \\, \\text{meV}\n$$\n根据态的简并度推断出 $J$ 的符号为正。该值已经给出四位有效数字。", "answer": "$$\n\\boxed{2.947}\n$$", "id": "3012185"}, {"introduction": "在真实的晶体中，自旋间的相互作用并非总是完美的各向同性。本练习将引导您探索一个更精细的效应：Dzyaloshinskii-Moriya（DM）相互作用的微观起源。您将通过微扰论，从一个包含自旋轨道耦合（SOC）和破缺反演对称性的微观模型出发，推导出一个有效的自旋哈密顿量。这个过程不仅揭示了反对称的DM相互作用如何有利于非共线的倾斜自旋基态，也训练了凝聚态理论中从第一性原理模型推导有效哈密顿量的关键技能。[@problem_id:2911604]", "problem": "考虑两个开壳层磁性中心 $A$ 和 $B$，每个中心有一个未配对电子（有效自旋-$\\tfrac{1}{2}$），通过单个桥联配体在弯曲构型中耦合，该构型破坏了关于 $A$–$B$ 键中点的反演对称性。用一个双中心 Hubbard–Anderson 哈密顿量来模拟低能电子结构，该模型包含 $A$ 和 $B$ 上单占据基态轨道间的最近邻跃迁 $t$、惩罚双占据的大在位库仑排斥 $U$，以及在位点 $A$ 上、能量比基态轨道高 $\\Delta$ 的局域晶体场激发轨道。假设一个局域原子自旋轨道耦合 (SOC) $H_{\\mathrm{SOC}}=\\lambda\\,\\mathbf{L}_{A}\\cdot\\mathbf{S}_{A}$ 仅作用于位点 $A$，其中 $\\lambda$ 是 SOC 常数，$\\mathbf{L}_{A}$ 和 $\\mathbf{S}_{A}$ 分别是 $A$ 上的轨道和自旋角动量算符。配体的位移会诱导奇宇称杂化，从而非对称地混合 $A$ 和 $B$ 上的基态和激发轨道；用一个小的无量纲数 $\\eta$ 来参数化这种奇宇称混合的强度，该数在反演操作下变号，且与弯曲畸变振幅成正比。\n\n在 $U\\gg t$、$\\Delta\\gg \\lambda$ 的极限下进行研究，并使用一个正则 (Schrieffer–Wolff) 变换，将 $t$ 处理到二阶，将 $\\lambda$ 和 $\\eta$ 处理到一阶，以消除虚电荷和轨道激发，从而获得一个作用在自旋子空间 $\\{\\mathbf{S}_{A},\\mathbf{S}_{B}\\}$ 上的有效自旋哈密顿量。仅从上述假设和标准二阶微扰理论出发，推导领头阶有效双自旋哈密顿量，并指出在反演对称性破缺和 SOC 存在的情况下对称性允许的项。特别地，确定各向同性 Heisenberg 交换作用 $J$ 和 Dzyaloshinskii–Moriya (DM) 相互作用矢量 $\\mathbf{D}$ 如何依赖于微观参数 $t$、$U$、$\\Delta$、$\\lambda$ 和奇宇称混合振幅 $\\eta$，并确定在两个金属-配体键矢量定义了一个单位法向量为 $\\hat{\\mathbf{z}}$ 的平面的构型中，$\\mathbf{D}$ 的取向。\n\n然后，将两个自旋视为大小相等的经典矢量，最小化得到的自旋哈密顿量，以获得非共线基态。令 $\\delta$ 表示由 DM 相互作用引起的、偏离完全反平行排列的倾角大小（即与 $\\pi$ 弧度的偏差）。用 $J$ 和 $|\\mathbf{D}|$ 的大小表示 $\\delta$。\n\n最后，对于一个符合上述条件的特定最小模型，取数值 $t=0.25\\,\\mathrm{eV}$、$U=4.0\\,\\mathrm{eV}$、$\\Delta=2.0\\,\\mathrm{eV}$、$\\lambda=0.050\\,\\mathrm{eV}$ 和奇宇称混合振幅 $\\eta=0.60$。计算经典基态下的倾角 $\\delta$（以弧度为单位）。将您的答案四舍五入到四位有效数字。以弧度为单位给出您的最终数值答案。", "solution": "所呈现的问题是理论量子磁学中的一个适定问题，它基于量子力学和固态物理的既定原理。该问题是自洽的、科学上合理的且客观的。因此，有必要给出完整解答。\n\n该系统由一个双中心 Hubbard–Anderson 型模型描述。我们的有效自旋哈密顿量将构建在低能子空间上，该子空间由位点 $A$ 上有一个电子、位点 $B$ 上有一个电子的状态及其各自的自旋构成。位点的总自旋算符为 $\\mathbf{S}_{A}$ 和 $\\mathbf{S}_{B}$，自旋量子数 $S=1/2$。未微扰哈密顿量 $H_0$ 描述了基态流形（能量定义为 $0$）、一个位点上出现双占据的虚电荷转移 (CT) 态（能量 $U$），以及位点 $A$ 上的局域晶体场 (CF) 激发态（能量 $\\Delta$）。问题指明了极限 $U \\gg t$ 和 $\\Delta \\gg \\lambda$。\n\n微扰 $V$ 由三部分组成：\n1. 位点 $A$ 和 $B$ 之间的电子跃迁 $H_t$。问题陈述暗示这会因非对称环境而改变。\n2. 位点 $A$ 上的在位自旋轨道耦合 (SOC)，$H_{\\mathrm{SOC}} = \\lambda\\,\\mathbf{L}_{A}\\cdot\\mathbf{S}_{A}$。\n3. 一个奇宇称混合势，其强度由 $\\eta$ 参数化。这种混合破坏了反演对称性，并允许不同宇称的轨道之间发生杂化。\n\n我们使用二阶微扰理论推导作用于低能自旋子空间上的有效哈密顿量 $H_{\\text{eff}}$。对于具有投影算符 $P$ 的简并基态流形，该理论给出 $H_{\\text{eff}} = P V P - P V Q \\frac{1}{H_0 - E_0} Q V P$，其中 $Q=1-P$ 投影到激发态上。\n\n首先，我们确定各向同性 Heisenberg 交换相互作用 $H_J = J \\mathbf{S}_A \\cdot \\mathbf{S}_B$。该项源于跃迁参数 $t$ 的二阶微扰理论。该过程涉及一个电子从一个位点虚跃迁到另一个位点，产生一个能量为 $U$ 的双占据 CT 态，然后跃迁回原始构型。这是动能交换机制。标准分析表明，这解除了总自旋单重态 ($S_{\\text{tot}}=0$) 和三重态 ($S_{\\text{tot}}=1$) 之间的简并，对于正的 $U$ 会使单重态稳定。三重态和单重态之间的能隙即为交换耦合 $J$。得到的哈密顿量项为 $J \\mathbf{S}_A \\cdot \\mathbf{S}_B$，交换常数 $J$ 的标度关系为：\n$$ J = \\frac{4t^2}{U} $$\n由于 $U  0$，$J$ 为正，有利于自旋的反铁磁排列。\n\n其次，我们推导 Dzyaloshinskii–Moriya (DM) 相互作用 $H_{\\text{DM}} = \\mathbf{D} \\cdot (\\mathbf{S}_A \\times \\mathbf{S}_B)$。这个反对称交换项仅在反演对称性破缺和自旋轨道耦合同时存在时才被允许。根据问题陈述，这些效应分别由参数 $\\eta$ 和 $\\lambda$ 描述。DM 相互作用源于不同超交换路径之间的量子干涉。\n\n领头阶各向同性交换作用 $J$ 来自一个二阶过程，该过程涉及对称跃迁算符的两次应用，其标度关系为 $t^2/U$。DM 相互作用源于更高阶过程或微扰理论中涉及 $H_t$、$H_{\\text{SOC}}$ 和不对称性 $\\eta$ 的交叉项。一个全面的推导涉及三阶微扰理论，需要考虑标准超交换路径与同时涉及 SOC 和非对称势的路径之间的干涉。这样一条路径可以设想为：一个电子从位点 $B$ 跃迁到 $A$（代价 $t$，中间态能量 $U$），然后 CT 态被 SOC 改变（代价 $\\lambda$，它混合了基态和激发态，因此状态被一个特征能量分母 $\\Delta$ 修正），最后一次非对称跃迁（代价 $\\eta t$）使系统返回基态流形。产生的相互作用强度将与这些矩阵元的乘积除以能量分母成正比，给出的标度关系为 $|\\mathbf{D}| \\propto \\frac{t \\cdot \\lambda \\cdot (\\eta t)}{U \\Delta}$。\n\n这导致了以下的标度关系：\n$$ |\\mathbf{D}| \\propto \\frac{\\eta \\lambda t^2}{U \\Delta} $$\n通过代入 $J$ 的表达式，我们找到了 DM 矢量大小与 $J$ 的标度关系：\n$$ |\\mathbf{D}| \\propto J \\frac{\\eta \\lambda}{\\Delta} $$\n对于“一个符合上述条件的特定最小模型”，我们假设最简单的情况，即任何额外的几何因子或数值前因子都为单位1。因此，我们建立关系：\n$$ |\\mathbf{D}| = J \\frac{\\eta \\lambda}{\\Delta} $$\nDM 矢量 $\\mathbf{D}$ 的取向由系统的对称性决定。对于弯曲的 A-L-B 构型，Moriya 定则规定 $\\mathbf{D}$ 必须垂直于包含原子 A、L 和 B 的平面。问题指定两个金属-配体键矢量定义了一个单位法向量为 $\\hat{\\mathbf{z}}$ 的平面。因此，DM 矢量的取向沿着 z 轴：$\\mathbf{D} = |\\mathbf{D}| \\hat{\\mathbf{z}}$。\n\n接下来，我们分析经典自旋哈密顿量以找到基态自旋构型：\n$$ H_{\\text{eff}} = J \\mathbf{S}_A \\cdot \\mathbf{S}_B + \\mathbf{D} \\cdot (\\mathbf{S}_A \\times \\mathbf{S}_B) $$\n将自旋视为大小为 $S$ 的经典矢量。哈密顿量的 DM 项为 $\\mathbf{D} \\cdot (\\mathbf{S}_A \\times \\mathbf{S}_B)$。为了使总能量最小化，这一项应为负，这意味着叉积 $\\mathbf{S}_A \\times \\mathbf{S}_B$ 应与 DM 矢量 $\\mathbf{D}$ 反平行。当自旋位于垂直于 $\\mathbf{D}$ 的平面内时，该项的幅度最大。设 $\\mathbf{D}$ 沿 $\\hat{\\mathbf{z}}$ 方向，自旋位于 $xy$ 平面内，且其取向使得 $\\mathbf{S}_A \\times \\mathbf{S}_B$ 与 $\\mathbf{D}$ 反平行。此时，能量可以写为自旋间夹角 $\\theta_{AB}$ 的函数：\n$$ E(\\theta_{AB}) = J S^2 \\cos\\theta_{AB} - |\\mathbf{D}| S^2 \\sin\\theta_{AB} $$\n为了找到最小能量构型，我们对 $\\theta_{AB}$ 求导并令结果为零：\n$$ \\frac{dE}{d\\theta_{AB}} = -J S^2 \\sin\\theta_{AB} - |\\mathbf{D}| S^2 \\cos\\theta_{AB} = 0 $$\n$$ \\tan\\theta_{AB} = -\\frac{|\\mathbf{D}|}{J} $$\n由于 $J0$（反铁磁性），基态近似为反平行，即 $\\theta_{AB} \\approx \\pi$。倾角 $\\delta$ 定义为偏离完全反平行排列（$\\pi$）的幅度。设 $\\theta_{AB} = \\pi - \\delta$（其中 $\\delta$ 为小正角）。代入此式：\n$$ \\tan(\\pi - \\delta) = -\\tan\\delta $$\n因此，$-\\tan\\delta = -\\frac{|\\mathbf{D}|}{J}$，即 $\\tan\\delta = \\frac{|\\mathbf{D}|}{J}$。\n倾角的幅度由下式给出：\n$$ \\delta = \\arctan\\left(\\frac{|\\mathbf{D}|}{J}\\right) $$\n\n最后，我们计算 $\\delta$ 的数值。\n给定的参数是 $t=0.25\\,\\mathrm{eV}$、$U=4.0\\,\\mathrm{eV}$、$\\Delta=2.0\\,\\mathrm{eV}$、$\\lambda=0.050\\,\\mathrm{eV}$ 和 $\\eta=0.60$。\n首先，计算比率 $|\\mathbf{D}|/J$：\n$$ \\frac{|\\mathbf{D}|}{J} = \\frac{\\eta \\lambda}{\\Delta} = \\frac{0.60 \\times 0.050}{2.0} = \\frac{0.030}{2.0} = 0.015 $$\n现在，计算倾角 $\\delta$（以弧度为单位）：\n$$ \\delta = \\arctan(0.015) $$\n使用计算工具，$\\delta \\approx 0.014996625...$ 弧度。\n四舍五入到四位有效数字，我们得到：\n$$ \\delta \\approx 0.01500\\,\\text{radians} $$\n这个结果证实了倾角很小，从而证明了微扰方法的合理性。", "answer": "$$\\boxed{0.01500}$$", "id": "2911604"}, {"introduction": "当我们将相互作用的自旋扩展到整个晶格时，新的集体现象就会出现，尤其是当不同的相互作用相互竞争时。本练习探讨了二维方格子上经典的 $J_1-J_2$ 海森堡模型，这是研究磁阻挫（magnetic frustration）的典范模型。您将首先解析地推导出一个螺旋自旋构型的能量，然后通过编写程序数值最小化该能量，从而确定体系的基态。这个实践结合了解析推导和计算物理方法，展示了竞争性相互作用如何导致非平庸的螺旋磁序。[@problem_id:3019393]", "problem": "考虑一个具有周期性边界条件的二维方晶格上的经典各向同性海森堡模型。其哈密顿量包含最近邻（NN）和次近邻（NNN）之间的相互作用。该模型由参数 $J_1$、$J_2$ 和固定自旋长度 $S$ 定义，哈密顿量为\n$$\nH = \\sum_{\\langle i,j\\rangle} J_1\\,\\mathbf{S}_i\\cdot\\mathbf{S}_j + \\sum_{\\langle\\langle i,j\\rangle\\rangle} J_2\\,\\mathbf{S}_i\\cdot\\mathbf{S}_j,\n$$\n其中 $\\mathbf{S}_i$ 是大小固定为 $S$ 的经典自旋，求和 $\\langle i,j\\rangle$ 和 $\\langle\\langle i,j\\rangle\\rangle$ 分别遍历所有最近邻（NN）和次近邻（NNN）键，每个键只计一次。\n\n从哈密顿量以及方晶格上最近邻和次近邻的定义出发，推导单-$\\mathbf{Q}$ 螺旋构型 $ \\mathbf{S}(\\mathbf{r}_i) = S\\left(\\cos(\\mathbf{Q}\\cdot \\mathbf{r}_i),\\,\\sin(\\mathbf{Q}\\cdot \\mathbf{r}_i),\\,0\\right) $ 的经典单位格点能量，并将其简化为关于有序波矢 $\\mathbf{Q}=(q_x,q_y)$ 的函数 $E(\\mathbf{Q})/N$，其中分量 $q_x$ 和 $q_y$ 以弧度表示。你的推导必须从哈密顿量开始，并且只使用晶格几何和平移不变性，不得假定任何快捷公式。\n\n然后，编写一个程序，通过在布里渊区上最小化所推导的 $E(\\mathbf{Q})/N$ 来确定经典基态。波矢分量的搜索范围必须是 $q_x\\in[-\\pi,\\pi]$ 和 $q_y\\in[-\\pi,\\pi]$（角度以弧度为单位）。使用包含端点 $-\\pi$ 和 $\\pi$ 的均匀网格采样。如果多个 $\\mathbf{Q}$ 值在数值公差 $\\epsilon$（使用 $\\epsilon=10^{-12}$）内使 $E(\\mathbf{Q})/N$ 最小化，则使用确定性的决胜规则选择一个唯一的最小化向量：选择在定义域 $[-\\pi,\\pi]\\times[-\\pi,\\pi]$ 内具有字典序最小的 $(q_x,q_y)$ 对的 $\\mathbf{Q}$。\n\n对于下面的测试套件中的每组参数，计算：\n- 最小化波矢分量 $q_x$ 和 $q_y$（以弧度为单位）。\n- 相应的经典单位格点能量 $E(\\mathbf{Q})/N$（无量纲，因为 $J_1$、$J_2$ 和 $S$ 采用一致的单位）。\n\n将最终程序输出表示为单行，其中包含一个用方括号括起来的逗号分隔的结果列表。每个测试用例的结果本身必须是一个包含三个浮点数的列表 $[q_x,q_y,E/N]$，因此完整的输出将类似于 $[[q_{x,1},q_{y,1},E_1],[q_{x,2},q_{y,2},E_2],\\dots]$。角度必须以弧度为单位，程序应将每个报告的数字四舍五入到 $6$ 位小数。\n\n测试套件（所有情况均使用 $S=1.0$）：\n- 情况 1：$J_1=1.0$，$J_2=0.3$。\n- 情况 2：$J_1=1.0$，$J_2=0.6$。\n- 情况 3：$J_1=1.0$，$J_2=0.5$。\n- 情况 4：$J_1=-1.0$，$J_2=0.3$。\n- 情况 5：$J_1=0.0$，$J_2=1.0$。\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，无空格，格式完全如下：\n$$\n\\left[\\,[q_{x,1},q_{y,1},E_1],[q_{x,2},q_{y,2},E_2],\\dots\\,\\right].\n$$", "solution": "用户提供的问题已经过验证，并被确定为凝聚态物理学中一个定义良好、科学合理的问题。\n\n该问题需要一个分为两部分的解决方案：首先，推导方晶格上螺旋磁构型的经典单位格点能量；其次，通过数值实现来寻找给定相互作用参数下的基态。\n\n### 第一部分：单位格点能量的推导\n\n起点是二维方晶格上具有最近邻（$J_1$）和次近邻（$J_2$）相互作用的经典海森堡哈密顿量：\n$$\nH = \\sum_{\\langle i,j\\rangle} J_1\\,\\mathbf{S}_i\\cdot\\mathbf{S}_j + \\sum_{\\langle\\langle i,j\\rangle\\rangle} J_2\\,\\mathbf{S}_i\\cdot\\mathbf{S}_j\n$$\n这里，$\\mathbf{S}_i$ 是晶格格点 $i$ 处大小固定为 $S$ 的经典自旋矢量。求和 $\\langle i,j\\rangle$ 和 $\\langle\\langle i,j\\rangle\\rangle$ 分别遍历所有唯一的最近邻（NN）和次近邻（NNN）键。\n\n我们考虑一个单-$\\mathbf{Q}$ 平面螺旋自旋构型，其中自旋被限制在一个平面（例如 $xy$ 平面）内，其取向在整个晶格上呈正弦变化。位于格点 $\\mathbf{r}_i$ 的自旋由下式给出：\n$$\n\\mathbf{S}(\\mathbf{r}_i) = S\\left(\\cos(\\mathbf{Q}\\cdot \\mathbf{r}_i),\\,\\sin(\\mathbf{Q}\\cdot \\mathbf{r}_i),\\,0\\right)\n$$\n其中 $\\mathbf{Q} = (q_x, q_y)$ 是有序波矢。\n\n位于格点 $\\mathbf{r}_i$ 和 $\\mathbf{r}_j$ 的两个自旋之间的相互作用能与其点积成正比：\n$$\n\\mathbf{S}_i \\cdot \\mathbf{S}_j = \\mathbf{S}(\\mathbf{r}_i) \\cdot \\mathbf{S}(\\mathbf{r}_j) = S^2 \\left[ \\cos(\\mathbf{Q}\\cdot\\mathbf{r}_i)\\cos(\\mathbf{Q}\\cdot\\mathbf{r}_j) + \\sin(\\mathbf{Q}\\cdot\\mathbf{r}_i)\\sin(\\mathbf{Q}\\cdot\\mathbf{r}_j) \\right]\n$$\n使用三角恒等式 $\\cos(A-B) = \\cos A \\cos B + \\sin A \\sin B$，上式可简化为：\n$$\n\\mathbf{S}_i \\cdot \\mathbf{S}_j = S^2 \\cos(\\mathbf{Q}\\cdot\\mathbf{r}_i - \\mathbf{Q}\\cdot\\mathbf{r}_j) = S^2 \\cos(\\mathbf{Q}\\cdot(\\mathbf{r}_i - \\mathbf{r}_j))\n$$\n\n总能量 $E$ 是此构型的哈密顿量的值。为了找到单位格点能量 $E/N$（其中 $N$ 是总格点数），我们可以利用晶格和自旋构型的平移不变性。每个格点的能量贡献是相同的。我们可以计算一个参考格点（比如原点 $\\mathbf{r}_0 = \\mathbf{0}$）与其邻居相互作用相关的能量，然后除以 2 来校正键的双重计数（因为格点 $i$ 和 $j$ 之间的键能由它们共享）。\n\n因此，单位格点能量 $E/N$ 为：\n$$\n\\frac{E}{N} = \\frac{1}{2} \\left[ \\sum_{j \\in \\text{NN of } 0} J_1 \\mathbf{S}_0 \\cdot \\mathbf{S}_j + \\sum_{j \\in \\text{NNN of } 0} J_2 \\mathbf{S}_0 \\cdot \\mathbf{S}_j \\right]\n$$\n相对于原点的邻居位置由位移矢量 $\\boldsymbol{\\delta}$ 给出。对于位于 $\\mathbf{r}_0 = \\mathbf{0}$ 的格点，其邻居位于 $\\mathbf{r}_j = \\boldsymbol{\\delta}$。相互作用项变为：\n$$\n\\mathbf{S}_0 \\cdot \\mathbf{S}_j = S^2 \\cos(\\mathbf{Q}\\cdot(\\mathbf{0} - \\boldsymbol{\\delta})) = S^2 \\cos(-\\mathbf{Q}\\cdot\\boldsymbol{\\delta}) = S^2 \\cos(\\mathbf{Q}\\cdot\\boldsymbol{\\delta})\n$$\n现在，单位格点能量可以写成对这些位移矢量的求和：\n$$\n\\frac{E(\\mathbf{Q})}{N} = \\frac{1}{2} \\left[ J_1 S^2 \\sum_{\\boldsymbol{\\delta}_{\\mathrm{NN}}} \\cos(\\mathbf{Q}\\cdot\\boldsymbol{\\delta}_{\\mathrm{NN}}) + J_2 S^2 \\sum_{\\boldsymbol{\\delta}_{\\mathrm{NNN}}} \\cos(\\mathbf{Q}\\cdot\\boldsymbol{\\delta}_{\\mathrm{NNN}}) \\right]\n$$\n\n设晶格常数 $a=1$。方晶格的邻居矢量为：\n- 最近邻（NN）：$\\boldsymbol{\\delta}_{\\mathrm{NN}} \\in \\{(1,0), (-1,0), (0,1), (0,-1)\\}$。有 $z_1=4$ 个这样的邻居。\n- 次近邻（NNN）：$\\boldsymbol{\\delta}_{\\mathrm{NNN}} \\in \\{(1,1), (1,-1), (-1,1), (-1,-1)\\}$。有 $z_2=4$ 个这样的邻居。\n\n我们现在计算这些和。\n对于最近邻：\n$$\n\\sum_{\\boldsymbol{\\delta}_{\\mathrm{NN}}} \\cos(\\mathbf{Q}\\cdot\\boldsymbol{\\delta}_{\\mathrm{NN}}) = \\cos(q_x) + \\cos(-q_x) + \\cos(q_y) + \\cos(-q_y) = 2\\cos(q_x) + 2\\cos(q_y)\n$$\n对于次近邻：\n$$\n\\sum_{\\boldsymbol{\\delta}_{\\mathrm{NNN}}} \\cos(\\mathbf{Q}\\cdot\\boldsymbol{\\delta}_{\\mathrm{NNN}}) = \\cos(q_x+q_y) + \\cos(q_x-q_y) + \\cos(-q_x+q_y) + \\cos(-q_x-q_y)\n$$\n使用 $\\cos(-A)=\\cos(A)$ 和 $\\cos(A+B)+\\cos(A-B) = 2\\cos A \\cos B$：\n$$\n\\sum_{\\boldsymbol{\\delta}_{\\mathrm{NNN}}} \\cos(\\mathbf{Q}\\cdot\\boldsymbol{\\delta}_{\\mathrm{NNN}}) = 2(\\cos(q_x+q_y) + \\cos(q_x-q_y)) = 2(2\\cos(q_x)\\cos(q_y)) = 4\\cos(q_x)\\cos(q_y)\n$$\n将这些和代回单位格点能量的表达式中：\n$$\n\\frac{E(\\mathbf{Q})}{N} = \\frac{S^2}{2} \\left[ J_1(2\\cos(q_x) + 2\\cos(q_y)) + J_2(4\\cos(q_x)\\cos(q_y)) \\right]\n$$\n这简化为螺旋构型的经典单位格点能量的最终表达式：\n$$\n\\frac{E(\\mathbf{Q})}{N} = S^2 \\left[ J_1(\\cos(q_x) + \\cos(q_y)) + 2J_2\\cos(q_x)\\cos(q_y) \\right]\n$$\n推导到此完成。\n\n### 第二部分：数值最小化\n\n经典基态对应于使此能量函数 $E(\\mathbf{Q})/N$ 最小化的波矢 $\\mathbf{Q}=(q_x, q_y)$。程序将通过在由 $q_x, q_y \\in [-\\pi, \\pi]$ 定义的第一布里渊区上的一个精细、均匀的网格上计算所推导的能量函数，来找到这个最小值。使用大量的网格点以确保足够精确地定位最小值。\n\n在计算了网格上每个 $(\\mathbf{q}_x, \\mathbf{q}_y)$ 对的能量后，确定最小能量值。所有产生此最小能量（在小的数值公差 $\\epsilon = 10^{-12}$ 内）的网格点被收集为候选点。问题指定了一个确定性的决胜规则：从候选波矢集合中，选择具有字典序最小的 $(q_x, q_y)$ 对的那个作为唯一解。程序通过对候选向量进行排序并选择第一个来实现此规则。该过程为每组指定的参数 $(J_1, J_2)$ 产出基态波矢和能量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the classical ground state wavevector and energy for the J1-J2\n    Heisenberg model on a 2D square lattice for several parameter sets.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (J1, J2)\n        (1.0, 0.3),\n        (1.0, 0.6),\n        (1.0, 0.5),\n        (-1.0, 0.3),\n        (0.0, 1.0),\n    ]\n\n    # Parameters from the problem\n    S = 1.0\n    epsilon = 1e-12\n\n    # Grid setup for minimizing the energy function.\n    # A fine grid ensures accuracy in finding the minimum. The grid includes\n    # endpoints -pi and pi as required.\n    N_points = 4001\n    q_vals = np.linspace(-np.pi, np.pi, N_points)\n    qx_grid, qy_grid = np.meshgrid(q_vals, q_vals)\n\n    results = []\n    for j1, j2 in test_cases:\n        # Calculate energy per site for the entire grid of wavevectors (qx, qy)\n        # using the derived formula:\n        # E/N = S^2 * [J1*(cos(qx) + cos(qy)) + 2*J2*cos(qx)*cos(qy)]\n        cos_qx = np.cos(qx_grid)\n        cos_qy = np.cos(qy_grid)\n        \n        energy_grid = S**2 * (j1 * (cos_qx + cos_qy) + 2 * j2 * cos_qx * cos_qy)\n\n        # Find the minimum energy value on the grid.\n        min_energy = np.min(energy_grid)\n\n        # Find all grid indices where the energy is equal to the minimum\n        # within the specified numerical tolerance.\n        min_indices = np.argwhere(np.abs(energy_grid - min_energy) = epsilon)\n\n        # Collect all candidate (qx, qy) wavevectors that produce the minimum energy.\n        candidates = []\n        for idx_pair in min_indices:\n            # np.meshgrid with 'xy' indexing (default) means qx_grid.shape[1] is\n            # the length of q_vals and qy_grid.shape[0] is the length of q_vals.\n            # argwhere returns (row, col) which corresponds to (qy_idx, qx_idx).\n            qy_idx, qx_idx = idx_pair\n            qx = q_vals[qx_idx]\n            qy = q_vals[qy_idx]\n            candidates.append((qx, qy))\n            \n        # Apply the deterministic tie-breaking rule: choose the wavevector\n        # with the lexicographically smallest (qx, qy) pair.\n        # Python's default tuple sorting is lexicographical.\n        candidates.sort()\n        best_qx, best_qy = candidates[0]\n        \n        # Calculate the final energy corresponding to the chosen wavevector.\n        # This re-calculation ensures precision for the chosen point.\n        final_energy = S**2 * (j1 * (np.cos(best_qx) + np.cos(best_qy)) + 2 * j2 * np.cos(best_qx) * np.cos(best_qy))\n        \n        # Round results to 6 decimal places as required.\n        q_x_r = best_qx\n        q_y_r = best_qy\n        E_r = final_energy\n        \n        # Format the numbers and append to the results list.\n        # The f-string format specifier '{:.6f}' ensures 6 decimal places.\n        # An explicit check for -0.0 is included for clean output.\n        if round(q_x_r, 6) == -0.0: q_x_r = 0.0\n        if round(q_y_r, 6) == -0.0: q_y_r = 0.0\n        if round(E_r, 6) == -0.0: E_r = 0.0\n        \n        results.append(f\"[{q_x_r:.6f},{q_y_r:.6f},{E_r:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[[{','.join(results)}]]\")\n\nsolve()\n```", "id": "3019393"}]}