{"hands_on_practices": [{"introduction": "半经典模型是理解布洛赫振荡的核心工具。第一个练习将通过计算一个关键的可观测量——振荡的实空间振幅——来建立直观认识。这个练习直接将材料的能带结构（特别是其带宽）与电子在电场下的宏观运动联系起来，揭示了振荡幅度与能带宽度成正比，与电场强度成反比的基本关系 [@problem_id:1762346]。", "problem": "在先进半导体器件的研究中，一维超晶格是工程设计的周期性结构，它在电子能谱中产生人工微带。考虑这样一个超晶格的简化模型，其中第一个导带微带中电子的能量色散关系由紧束缚近似给出：\n$$E(k) = E_c - \\Delta \\cos(ka)$$\n这里，$k$是电子的晶体动量，$a$是超晶格周期，$E_c$是微带中心的恒定能量，$\\Delta$是一个决定微带半宽度的正常数。\n\n一个大小为 $\\mathcal{E}$ 的均匀静电场沿超晶格方向施加。一个电子最初静止在该能带的底部。使用电子动力学的半经典模型，确定电子相对于其初始位置的最大空间位移。请用 $\\Delta$、$e$、$\\mathcal{E}$ 和 $a$ 给出解析表达式，其中 $e$ 是元电荷。", "solution": "我们使用电子在均匀电场下的周期性能带中的半经典运动方程：\n$$\\hbar \\dot{k} = -e \\mathcal{E}, \\qquad v(k) = \\frac{1}{\\hbar}\\frac{dE}{dk}。$$\n对于 $E(k) = E_{c} - \\Delta \\cos(ka)$，我们通过求导计算群速度：\n$$\\frac{dE}{dk} = -\\Delta \\frac{d}{dk}\\cos(ka) = -\\Delta \\left(-\\sin(ka)\\right)a = \\Delta a \\sin(ka),$$\n所以\n$$v(k) = \\frac{\\Delta a}{\\hbar}\\sin(ka)。$$\n对于均匀电场 $\\mathcal{E}$，晶体动量随时间演化为\n$$k(t) = k(0) - \\frac{e \\mathcal{E}}{\\hbar}t。$$\n电子最初静止在能带底部，这发生在 $k(0) = 0$ 处，此时 $v(0)=0$。因此，\n$$k(t) = -\\frac{e \\mathcal{E}}{\\hbar}t,$$\n并且使用 $a k(t) = -\\omega_{B} t$ 和布洛赫频率 $\\omega_{B} \\equiv \\frac{e \\mathcal{E} a}{\\hbar}$，速度变为\n$$v(t) = \\frac{\\Delta a}{\\hbar}\\sin\\big(a k(t)\\big) = \\frac{\\Delta a}{\\hbar}\\sin(-\\omega_{B} t) = -\\frac{\\Delta a}{\\hbar}\\sin(\\omega_{B} t)。$$\n那么相对于初始位置的位移为\n$$x(t) - x(0) = \\int_{0}^{t} v(t')\\,dt' = -\\frac{\\Delta a}{\\hbar}\\int_{0}^{t}\\sin(\\omega_{B} t')\\,dt' = \\frac{\\Delta a}{\\hbar \\omega_{B}}\\big[\\cos(\\omega_{B} t) - 1\\big] 。$$\n余弦项的范围在 $-1$ 和 $1$ 之间，因此位移是有界的。其最大值发生在 $\\cos(\\omega_{B} t) = -1$ 时，得到\n$$\\max|x(t) - x(0)| = \\frac{\\Delta a}{\\hbar \\omega_{B}}\\big|(-1) - 1\\big| = \\frac{2\\Delta a}{\\hbar \\omega_{B}}。$$\n代入 $\\omega_{B} = \\frac{e \\mathcal{E} a}{\\hbar}$ 可得\n$$\\max|x(t) - x(0)| = \\frac{2\\Delta a}{\\hbar}\\cdot \\frac{\\hbar}{e \\mathcal{E} a} = \\frac{2\\Delta}{e \\mathcal{E}}。$$\n这就是相对于初始位置的最大空间位移。", "answer": "$$\\boxed{\\frac{2\\Delta}{e \\mathcal{E}}}$$", "id": "1762346"}, {"introduction": "在了解了周期性有界能带如何导致振荡之后，一个至关重要的问题是：当这些条件不被满足时会发生什么？这个思想实验将探讨在具有线性、无界色散关系的材料（如石墨烯）中的电子动力学。通过将布洛赫振荡的条件与一个其不发生的场景进行对比，这个练习旨在揭示为何能带的周期性和有界性对于此现象是根本性的 [@problem_id:1762347]。", "problem": "在一个简化的石墨烯二维模型中，动量空间中一个称为 Dirac 点的特定点附近的低能电子激发，可以用线性色散关系 $E(\\mathbf{k}) = \\hbar v_F |\\mathbf{k}|$ 来描述。此处，$\\mathbf{k} = (k_x, k_y)$ 是相对于 Dirac 点的晶格动量矢量，$v_F$ 是一个具有速度单位的常数，称为费米速度，而 $\\hbar$ 是约化 Planck 常数。\n\n一个电子由该模型描述。在时间 $t=0$ 时，它位于 Dirac 点，对应于晶格动量 $\\mathbf{k}(0) = \\mathbf{0}$。同时，一个均匀恒定的电场 $\\mathbf{E} = E_0 \\hat{\\mathbf{x}}$ 被施加到石墨烯片上。电子晶格动量的演化由半经典运动方程 $\\frac{d\\mathbf{k}}{dt} = -\\frac{e}{\\hbar}\\mathbf{E}$ 决定，其中 $-e$ 是电子的电荷。\n\n假设在所有相关时间内，电子都保持在该线性色散关系所描述的能带内，并且这个简化模型成立。对于任何时间 $t > 0$，下列哪个陈述正确地描述了电子群速度的大小 $|\\mathbf{v}_g(t)|$？\n\nA. 在所有时间 $t  0$ 内，它都保持为零。\n\nB. 它随时间线性增加，与 $t$ 成正比。\n\nC. 它是时间的周期性振荡函数。\n\nD. 在所有时间 $t  0$ 内，它都是一个常数，且等于费米速度 $v_F$。\n\nE. 在所有时间 $t  0$ 内，它都无定义。", "solution": "我们已知色散关系 $E(\\mathbf{k}) = \\hbar v_{F} |\\mathbf{k}|$ 和晶格动量的半经典运动方程，\n$$\n\\frac{d\\mathbf{k}}{dt} = -\\frac{e}{\\hbar}\\mathbf{E}.\n$$\n当 $\\mathbf{E} = E_{0}\\hat{\\mathbf{x}}$ 且初始条件为 $\\mathbf{k}(0)=\\mathbf{0}$ 时，对时间积分可得\n$$\n\\mathbf{k}(t) = \\mathbf{k}(0) - \\frac{e}{\\hbar}\\mathbf{E}\\,t = -\\frac{e}{\\hbar}E_{0}t\\,\\hat{\\mathbf{x}}.\n$$\n对于任何 $t0$，这满足 $|\\mathbf{k}(t)| = \\frac{e}{\\hbar}E_{0}t  0$。\n\n群速度的半经典定义为\n$$\n\\mathbf{v}_{g}(\\mathbf{k}) = \\frac{1}{\\hbar}\\nabla_{\\mathbf{k}} E(\\mathbf{k}).\n$$\n使用 $E(\\mathbf{k}) = \\hbar v_{F}|\\mathbf{k}|$，我们计算\n$$\n\\mathbf{v}_{g}(\\mathbf{k}) = \\frac{1}{\\hbar}\\nabla_{\\mathbf{k}}\\left(\\hbar v_{F}|\\mathbf{k}|\\right) = v_{F}\\nabla_{\\mathbf{k}}|\\mathbf{k}|.\n$$\n对于 $\\mathbf{k}\\neq \\mathbf{0}$，梯度满足 $\\nabla_{\\mathbf{k}}|\\mathbf{k}| = \\frac{\\mathbf{k}}{|\\mathbf{k}|}$，因此\n$$\n\\mathbf{v}_{g}(\\mathbf{k}) = v_{F}\\frac{\\mathbf{k}}{|\\mathbf{k}|}, \\quad \\text{所以} \\quad |\\mathbf{v}_{g}(\\mathbf{k})| = v_{F}.\n$$\n因为对于所有 $t0$，我们有 $\\mathbf{k}(t)\\neq \\mathbf{0}$，所以群速度的大小是恒定的，等于 $v_{F}$。因此，正确的陈述是，对于所有 $t0$，$|\\mathbf{v}_{g}(t)|$ 是一个常数，且等于 $v_{F}$。", "answer": "$$\\boxed{D}$$", "id": "1762347"}, {"introduction": "半经典模型是一个功能强大的近似。最后一个练习将超越这一模型，通过直接数值模拟来探索完整的量子力学图像。通过求解波包的时间演化薛定谔方程，并将其与半经典轨迹进行比较，我们可以严格地检验近似的有效性，并观察到波包展宽等独特的量子效应 [@problem_id:2972562]。这个编程练习为深入理解量子与半经典世界之间的对应与差异提供了坚实的实践基础。", "problem": "考虑一个具有开放边界条件的一维最近邻紧束缚链，该链受到空间均匀的静态电场作用。在自然单位制下进行计算，其中约化普朗克常数设为 $1$，晶格常数设为 $1$，元电荷设为 $1$。因此，所有物理量都是无量纲的。一个包含 $N$ 个格点的链上的单粒子哈密顿量为\n$$\n\\hat{H} = -J \\sum_{n=0}^{N-2} \\left( \\lvert n \\rangle \\langle n+1 \\rvert + \\lvert n+1 \\rangle \\langle n \\rvert \\right) + F \\sum_{n=0}^{N-1} n \\lvert n \\rangle \\langle n \\rvert,\n$$\n其中 $J0$ 是跃迁振幅，$F0$ 是电场强度，$\\lvert n \\rangle$ 表示局域在格点 $n$ 上的 Wannier 态。含时薛定谔方程为\n$$\ni \\frac{d}{dt} \\lvert \\psi(t) \\rangle = \\hat{H} \\lvert \\psi(t) \\rangle.\n$$\n您需要将完整的量子动力学与波包的半经典动力学进行比较。\n\n初始态。初始波函数是一个高斯波包，以格点 $n_0$ 为中心，准动量为 $k_0$，\n$$\n\\psi_n(0) = \\mathcal{N} \\exp\\!\\left( -\\frac{(n-n_0)^2}{2 \\sigma^2} \\right) e^{i k_0 n},\n$$\n其中 $\\sigma$ 是实空间标准差，$\\mathcal{N}$ 是归一化常数，其取值使得 $\\sum_{n=0}^{N-1} \\lvert \\psi_n(0) \\rvert^2 = 1$。在时间 $t$ 时，位置的量子期望值为\n$$\nx_{\\mathrm{qm}}(t) = \\sum_{n=0}^{N-1} n \\, \\lvert \\psi_n(t) \\rvert^2.\n$$\n\n半经典描述。在准动量空间中窄波包的单带半经典极限下，使用以下经过充分检验的基本关系作为出发点：\n- 最近邻紧束缚能带的能量色散关系为 $\\varepsilon(k) = -2J \\cos k$。\n- 群速度为 $v(k) = \\frac{1}{\\hbar} \\frac{d \\varepsilon}{d k}$，在此单位制下简化为 $v(k) = \\frac{d \\varepsilon}{d k}$。\n- 加速定理为 $\\hbar \\, \\frac{d k}{d t} = -F$，在此单位制下简化为 $\\frac{d k}{d t} = -F$。\n\n将波包视为初始时由单一准动量 $k_0$ 表征，并对半经典运动方程进行积分以获得半经典位置 $x_{\\mathrm{sc}}(t)$，初始条件为 $x_{\\mathrm{sc}}(0) = x_{\\mathrm{qm}}(0)$。不要假设任何最终公式；直接从这些原理推导并实现您所需要的内容。\n\n比较度量。对于给定的参数集和时间区间 $[0,T]$ 上的一个包含 $M$ 个采样时间的均匀网格，定义量子位置和半经典位置之间的均方根偏差为\n$$\n\\Delta = \\sqrt{ \\frac{1}{M} \\sum_{m=1}^{M} \\left( x_{\\mathrm{qm}}(t_m) - x_{\\mathrm{sc}}(t_m) \\right)^2 }.\n$$\n以晶格位置为单位，将 $\\Delta$ 报告为一个无量纲浮点数。将报告的每个值四舍五入到 $6$ 位小数。\n\n实现要求。\n- 通过对角化 $\\hat{H}$ 并使用幺正时间演化，在所需时间点获得 $\\lvert \\psi(t) \\rangle$，从而精确求解有限链的完整量子动力学。\n- 使用上面列出的原理实现半经典演化。\n- 使用开放边界条件。选择链中间附近的中心点 $n_0$。不允许使用任何人工吸收边界或加窗。\n\n角度单位。准动量 $k_0$ 必须以弧度为单位指定和处理。\n\n时间网格。对于下面的每种情况，使用一个包含 $M$ 个时间点的均匀网格 $t_m = m \\, T / M$，其中 $m = 1, 2, \\dots, M$。\n\n测试套件。使用以下四组参数，它们用于探测量子动力学向半经典理论的收敛及其失效情况：\n- 情况 1 (宽波包，弱电场)：$N=201$, $J=1.0$, $F=0.05$, $k_0=0.7$, $\\sigma=12.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$。\n- 情况 2 (窄波包，相同弱电场)：$N=201$, $J=1.0$, $F=0.05$, $k_0=0.7$, $\\sigma=3.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$。\n- 情况 3 (宽波包，强电场)：$N=201$, $J=1.0$, $F=0.3$, $k_0=0.7$, $\\sigma=12.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$。\n- 情况 4 (边界限制运动)：$N=121$, $J=1.0$, $F=0.02$, $k_0=0.0$, $\\sigma=12.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$。\n\n输出格式。您的程序应生成单行输出，其中包含按情况 1 到 4 的顺序排列的结果，形式为方括号内以逗号分隔的列表。例如，输出必须如下所示\n$$\n[\\Delta_1,\\Delta_2,\\Delta_3,\\Delta_4],\n$$\n其中每个 $\\Delta_i$ 都四舍五入到 $6$ 位小数。输出是无量纲的，并且必须以晶格位置为单位进行解释。", "solution": "该问题要求详细比较一维紧束缚链中波包的完整量子力学演化与其对应的半经典轨迹。这是固态物理学中研究 Bloch 振荡和量子到经典对应关系的经典问题。我将首先推导两种描述所需的公式，然后概述数值实现方法。\n\n### 量子力学动力学\n\n该系统是一个由 $N$ 个离散格点组成的有限链，由整数 $n=0, 1, \\dots, N-1$ 索引。链上粒子的状态由一个态矢量 $|\\psi(t)\\rangle = \\sum_{n=0}^{N-1} \\psi_n(t) |n\\rangle$ 描述，其中 $\\psi_n(t)$ 是粒子在时间 $t$ 位于格点 $n$ 的复振幅。动力学由含时薛定谔方程 $i \\frac{d}{dt} |\\psi(t)\\rangle = \\hat{H} |\\psi(t)\\rangle$ 控制，单位制为 $\\hbar=1$。\n\n哈密顿量 $\\hat{H}$ 由下式给出：\n$$\n\\hat{H} = -J \\sum_{n=0}^{N-2} \\left( |n\\rangle\\langle n+1| + |n+1\\rangle\\langle n| \\right) + F \\sum_{n=0}^{N-1} n |n\\rangle\\langle n|\n$$\n第一项描述了相邻格点之间振幅为 $J$ 的跃迁，第二项代表了由强度为 $F$ 的静态电场引起的线性势。该势导致了 Wannier-Stark 梯。\n\n在格点基 $\\{|n\\rangle\\}$ 中，该算符可以表示为一个 $N \\times N$ 的实对称（因此是厄米）矩阵 $H$。矩阵元为：\n$$\nH_{ij} = \\langle i | \\hat{H} | j \\rangle = \\begin{cases}\n    F \\cdot i   \\text{if } i=j \\\\\n    -J   \\text{if } |i-j|=1 \\\\\n    0   \\text{otherwise}\n\\end{cases}\n$$\n由于哈密顿量与时间无关，薛定谔方程的形式解为 $|\\psi(t)\\rangle = e^{-iHt} |\\psi(0)\\rangle$，其中 $|\\psi(0)\\rangle$ 是初始态。通过对角化哈密顿矩阵 $H$ 可以获得数值精确解。设本征值为 $E_j$，对应的本征矢量为 $|\\phi_j\\rangle$，满足 $H|\\phi_j\\rangle = E_j|\\phi_j\\rangle$。时间演化算符在该本征基中可以表示为 $e^{-iHt} = \\sum_j e^{-iE_j t} |\\phi_j\\rangle\\langle\\phi_j|$。\n\n那么在时间 $t$ 的状态是：\n$$\n|\\psi(t)\\rangle = \\left(\\sum_j e^{-iE_j t} |\\phi_j\\rangle\\langle\\phi_j|\\right) |\\psi(0)\\rangle = \\sum_j c_j e^{-iE_j t} |\\phi_j\\rangle\n$$\n其中 $c_j = \\langle\\phi_j|\\psi(0)\\rangle$ 是初始态投影到本征基上的系数。\n\n初始态是一个高斯波包：\n$$\n\\psi_n(0) = \\langle n | \\psi(0) \\rangle = \\mathcal{N} \\exp\\left( -\\frac{(n-n_0)^2}{2\\sigma^2} \\right) e^{ik_0n}\n$$\n归一化常数 $\\mathcal{N}$ 的选择使得 $\\sum_{n=0}^{N-1} |\\psi_n(0)|^2 = 1$，这给出 $\\mathcal{N} = 1 / \\sqrt{\\sum_{n=0}^{N-1} \\exp\\left(-\\frac{(n-n_0)^2}{\\sigma^2}\\right)}$。\n\n时间 $t$ 的位置量子期望值通过下式计算：\n$$\nx_{\\mathrm{qm}}(t) = \\langle\\psi(t)|\\hat{x}|\\psi(t)\\rangle = \\sum_{n=0}^{N-1} n |\\psi_n(t)|^2\n$$\n\n### 半经典动力学\n\n半经典模型将波包视为一个点状粒子，其动力学由能带结构 $\\varepsilon(k)$ 和加速定理决定。\n给出的原理是：\n1.  能量色散：$\\varepsilon(k) = -2J \\cos(k)$。\n2.  群速度：$v(k) = \\frac{d\\varepsilon}{dk} = 2J \\sin(k)$。\n3.  加速度：$\\frac{dk}{dt} = -F$。\n\n对加速度方程积分，初始条件为 $k(0) = k_0$，得到随时间变化的准动量：\n$$\nk(t) = k_0 - Ft\n$$\n半经典位置 $x_{\\mathrm{sc}}(t)$ 通过对群速度积分得到，$\\frac{dx_{\\mathrm{sc}}}{dt} = v(k(t))$：\n$$\n\\frac{dx_{\\mathrm{sc}}}{dt} = 2J \\sin(k_0 - Ft)\n$$\n将其从 $t=0$ 积分到 $t$ 得到位置的变化量：\n$$\nx_{\\mathrm{sc}}(t) - x_{\\mathrm{sc}}(0) = \\int_0^t 2J \\sin(k_0 - Ft') dt' = 2J \\left[ \\frac{\\cos(k_0 - Ft')}{F} \\right]_0^t\n$$\n$$\nx_{\\mathrm{sc}}(t) = x_{\\mathrm{sc}}(0) + \\frac{2J}{F} \\left( \\cos(k_0 - Ft) - \\cos(k_0) \\right)\n$$\n初始半经典位置 $x_{\\mathrm{sc}}(0)$ 设为等于初始量子期望值，即 $x_{\\mathrm{sc}}(0) = x_{\\mathrm{qm}}(0) = \\sum_{n=0}^{N-1} n |\\psi_n(0)|^2$。\n\n### 数值实现与比较\n\n对于每个测试用例，算法按以下步骤进行：\n1.  **设置**：定义所有参数（$N, J, F, k_0, \\sigma, n_0, T, M$），并为 $m=1, \\dots, M$ 构建均匀时间网格 $t_m = m T/M$。\n2.  **初始态**：构建离散的初始波函数 $\\psi_n(0)$ 并将其归一化。\n3.  **量子动力学**：\n    a. 构建 $N \\times N$ 的哈密顿矩阵 $H$。\n    b. 使用标准的厄米矩阵本征求解器（例如 `numpy.linalg.eigh`）对 $H$ 进行数值对角化，以获得本征值 $\\{E_j\\}$ 和由本征矢量 $U$ 组成的幺正矩阵（其列为 $|\\phi_j\\rangle$）。\n    c. 将初始态投影到本征基上：$|\\psi(0)\\rangle_{\\mathrm{eig}} = U^\\dagger |\\psi(0)\\rangle$。\n    d. 对于网格中的每个时间 $t_m$，通过将相位因子 $e^{-iE_j t_m}$ 应用于 $|\\psi(0)\\rangle_{\\mathrm{eig}}$ 的分量，并变换回格点基来计算演化后的状态：$|\\psi(t_m)\\rangle = U (e^{-iE t_m} |\\psi(0)\\rangle_{\\mathrm{eig}})$。这一步可以通过对所有时间一次性使用矢量化操作来高效实现。\n    e. 计算量子位置数组 $x_{\\mathrm{qm}}(t_m)$。\n4.  **半经典动力学**：\n    a. 计算初始位置 $x_{\\mathrm{qm}}(0)$ 并将 $x_{\\mathrm{sc}}(0)$ 设置为此值。\n    b. 使用推导出的解析公式计算半经典位置数组 $x_{\\mathrm{sc}}(t_m)$。\n5.  **偏差**：使用计算出的数组 $x_{\\mathrm{qm}}(t_m)$ 和 $x_{\\mathrm{sc}}(t_m)$ 在时间网格上计算均方根偏差 $\\Delta$。\n6.  **输出**：最终的 $\\Delta$ 值四舍五入到 6 位小数并存储。然后将所有情况的结果格式化为所需的输出字符串。\n\n此过程为有限链上的量子动力学提供了严格且数值精确（在机器精度范围内）的评估，从而可以与理想化的半经典模型进行精确比较。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the root-mean-square deviation between quantum and semiclassical\n    dynamics for four specified test cases.\n    \"\"\"\n    \n    # Test cases from the problem statement.\n    # (N, J, F, k0, sigma, M)\n    # n0 and T are derived from these.\n    test_cases_params = [\n        (201, 1.0, 0.05, 0.7, 12.0, 256),\n        (201, 1.0, 0.05, 0.7, 3.0, 256),\n        (201, 1.0, 0.3, 0.7, 12.0, 256),\n        (121, 1.0, 0.02, 0.0, 12.0, 256),\n    ]\n\n    results = []\n\n    for N, J, F, k0, sigma, M in test_cases_params:\n        # Derived parameters\n        n0 = N // 2\n        T = 2 * np.pi / F\n        \n        # 1. Time grid\n        # The sum for Delta is from m=1 to M, so we start at t=T/M.\n        times = np.linspace(T / M, T, M)\n        \n        # 2. Site indices\n        sites = np.arange(N)\n        \n        # 3. Initial State Preparation\n        psi_unnormalized = np.exp(-(sites - n0)**2 / (2 * sigma**2)) * np.exp(1j * k0 * sites)\n        norm = np.linalg.norm(psi_unnormalized)\n        psi_0 = psi_unnormalized / norm\n\n        # 4. Quantum Dynamics Calculation\n        # a. Construct Hamiltonian\n        H_diag = F * sites\n        H_offdiag = -J * np.ones(N - 1)\n        H = np.diag(H_diag) + np.diag(H_offdiag, k=1) + np.diag(H_offdiag, k=-1)\n        \n        # b. Eigendecomposition of the Hermitian Hamiltonian\n        eigenvalues, eigenvectors = np.linalg.eigh(H)\n        \n        # c. Project initial state onto the eigenbasis\n        # For a real symmetric matrix H, eigenvectors are real, so U.T.conj()=U.T\n        psi_0_eigenbasis = eigenvectors.T @ psi_0\n        \n        # d. Evolve state in time (vectorized for all time steps)\n        # Outer product creates an (N, M) matrix of phases e^{-i*E_j*t_m}\n        time_evolution_factors = np.exp(np.outer(-1j * eigenvalues, times))\n        # Multiply each eigen-coefficient with its time evolution factor\n        psi_t_eigenbasis = psi_0_eigenbasis[:, np.newaxis] * time_evolution_factors\n        # Transform back to the site basis\n        psi_t = eigenvectors @ psi_t_eigenbasis  # Shape (N, M)\n        \n        # e. Calculate quantum expectation value of position\n        x_qm = np.sum(sites[:, np.newaxis] * np.abs(psi_t)**2, axis=0) # Shape (M,)\n\n        # 5. Semiclassical Dynamics Calculation\n        # a. Initial position\n        x_qm_0 = np.sum(sites * np.abs(psi_0)**2)\n        x_sc_0 = x_qm_0\n\n        # b. Semiclassical trajectory for all time steps\n        x_sc = x_sc_0 + (2 * J / F) * (np.cos(k0 - F * times) - np.cos(k0))\n        \n        # 6. Comparison Metric\n        deviation = np.sqrt(np.mean((x_qm - x_sc)**2))\n        results.append(deviation)\n\n    # 7. Final output formatting\n    # Round to 6 decimal places and format to ensure trailing zeros.\n    formatted_results = [f'{round(r, 6):.6f}' for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2972562"}]}