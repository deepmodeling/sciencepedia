{"hands_on_practices": [{"introduction": "迭代函数系统（IFS）的吸引子不仅是一个几何形状，它还被赋予了一个独特的不变测度，描述了分形上“质量”的分布。通过计算该测度的矩（如均值和方差），我们可以获得关于分形结构的关键统计信息。本练习 ([@problem_id:876612]) 将通过一个具体的一维IFS实例，指导你如何运用不变测度的自洽性方程来计算其二阶矩。", "problem": "一个$\\mathbb{R}$上的迭代函数系统 (IFS) 由一组 $N$ 个仿射收缩映射 $w_i(x) = r_i x + d_i$（其中 $i=1,\\dots,N$）以及一组概率 $\\{p_i\\}_{i=1}^N$（其中 $p_i > 0, \\sum p_i=1$）组成，它拥有一个唯一的不变测度 $\\mu$。该测度是一个概率测度，并满足以下平衡方程：\n$$ \\int_{\\mathbb{R}} f(x) \\, d\\mu(x) = \\sum_{i=1}^N p_i \\int_{\\mathbb{R}} f(w_i(x)) \\, d\\mu(x) $$\n对任意连续有界函数 $f$ 成立。该测度的矩，$M_k = \\int x^k \\, d\\mu(x)$，可以通过设 $f(x)=x^k$ 来求得。\n\n考虑由以下两个映射定义的IFS：\n1. $w_1(x) = r_1 x + d_1$\n2. $w_2(x) = r_2 x + d_2$\n\n系统参数规定如下：\n- 缩放因子：$r_1 = 1/4$ 和 $r_2 = 1/2$。\n- 映射的构造使得其吸引子位于单位区间 $[0,1]$ 内。具体来说，$w_1$ 将 $[0,1]$ 映射到 $[0, r_1]$，$w_2$ 将 $[0,1]$ 映射到 $[1-r_2, 1]$。\n- 相关概率相等：$p_1 = p_2 = 1/2$。\n\n计算该 IFS 的不变测度 $\\mu$ 的二阶矩 $M_2 = \\int x^2 d\\mu(x)$ 的值。", "solution": "我们使用具有映射 $w_i(x)=r_i x+d_i$ 和概率 $p_i$ 的 IFS 的矩平衡关系：\n\n1. 一阶矩 $M_1$ 满足\n$$\nM_1=\\sum_{i=1}^2 p_i\\,(r_iM_1+d_i)\n=\\Bigl(\\sum_{i=1}^2 p_i r_i\\Bigr)M_1+\\sum_{i=1}^2 p_i d_i,\n$$\n所以\n$$\nM_1\\Bigl(1-\\sum_{i=1}^2 p_i r_i\\Bigr)\n=\\sum_{i=1}^2 p_i d_i,\n\\quad\nM_1\n=\\frac{\\sum_i p_i d_i}{1-\\sum_i p_i r_i}.\n$$\n\n2. 二阶矩 $M_2$ 满足\n$$\nM_2\n=\\sum_{i=1}^2 p_i\\,\\bigl(r_i^2M_2+2r_i d_iM_1+d_i^2\\bigr)\n=\\Bigl(\\sum_i p_i r_i^2\\Bigr)M_2\n+2\\Bigl(\\sum_i p_i r_i d_i\\Bigr)M_1\n+\\sum_i p_i d_i^2,\n$$\n因此\n$$\nM_2\\Bigl(1-\\sum_i p_i r_i^2\\Bigr)\n=2\\Bigl(\\sum_i p_i r_i d_i\\Bigr)M_1+\\sum_i p_i d_i^2,\n\\quad\nM_2\n=\\frac{2(\\sum_i p_ir_id_i)M_1+\\sum_i p_i d_i^2}\n{1-\\sum_i p_i r_i^2}.\n$$\n\n3. 对于我们的IFS：$p_1=p_2=\\tfrac{1}{2}$，$r_1=\\tfrac{1}{4}$，$r_2=\\tfrac{1}{2}$，$d_1=0$，$d_2=1-r_2=\\tfrac{1}{2}$。\n计算\n$$\n\\sum_i p_i r_i=\\tfrac{1}{2}\\Bigl(\\tfrac{1}{4}+\\tfrac{1}{2}\\Bigr)=\\tfrac{3}{8},\\quad\n\\sum_i p_i d_i=\\tfrac{1}{2}\\cdot0+\\tfrac{1}{2}\\cdot\\tfrac{1}{2}=\\tfrac{1}{4},\n$$\n$$\nM_1=\\frac{\\tfrac{1}{4}}{1-\\tfrac{3}{8}}=\\frac{\\tfrac{1}{4}}{\\tfrac{5}{8}}=\\frac{2}{5}.\n$$\n接着，\n$$\n\\sum_i p_ir_id_i\n=\\tfrac{1}{2}\\Bigl(\\tfrac{1}{4}\\cdot0+\\tfrac{1}{2}\\cdot\\tfrac{1}{2}\\Bigr)\n=\\tfrac{1}{8},\\quad\n\\sum_i p_i d_i^2\n=\\tfrac{1}{2}\\cdot0+\\tfrac{1}{2}\\cdot\\Bigl(\\tfrac{1}{2}\\Bigr)^2\n=\\tfrac{1}{8},\n$$\n$$\n\\sum_i p_ir_i^2\n=\\tfrac{1}{2}\\Bigl(\\tfrac{1}{16}+\\tfrac{1}{4}\\Bigr)\n=\\tfrac{5}{32}.\n$$\n因此\n$$\nM_2\n=\\frac{2\\cdot\\tfrac{1}{8}\\cdot\\tfrac{2}{5}+\\tfrac{1}{8}}\n{1-\\tfrac{5}{32}}\n=\\frac{\\tfrac{1}{20}+\\tfrac{1}{8}}{\\tfrac{27}{32}}\n=\\frac{\\tfrac{9}{40}}{\\tfrac{27}{32}}\n=\\frac{9}{40}\\cdot\\frac{32}{27}\n=\\frac{4}{15}.\n$$", "answer": "$$\\boxed{\\frac{4}{15}}$$", "id": "876612"}, {"introduction": "“混沌游戏”是生成分形的一种直观而有趣的随机算法。这个过程不仅仅是视觉上的游戏，其背后可以用随机过程，特别是马尔可夫链，进行精确的数学建模。本练习 ([@problem_id:876571]) 将引导你分析一个修改版混沌游戏的动态行为，通过计算从分形的一个区域首次到达另一个区域的期望时间，从而将抽象的IFS规则与具体的时间行为联系起来。", "problem": "谢尔宾斯基垫片（Sierpinski gasket）是一种分形，可以作为一个迭代函数系统（Iterated Function System, IFS）的吸引子生成。考虑平面上的一个等边三角形 $T$。该IFS包含三个仿射变换 $\\{w_0, w_1, w_2\\}$，它们将三角形 $T$ 映射到其自身三个更小的、不重叠的全等副本上，我们将其记为 $T_0$、$T_1$ 和 $T_2$。令 $T_0$ 对应左下角的子三角形，$T_1$ 对应右下角的子三角形，$T_2$ 对应顶部的子三角形。\n\n我们定义一个修改版的“混沌游戏”来生成一个点序列 $\\{x_k\\}_{k=0}^\\infty$。我们从位于左下角子三角形 $T_0$ 内任意位置的一点 $x_0$ 开始。后续的点通过规则 $x_{k+1} = w_{j_k}(x_k)$ 迭代生成，其中索引 $j_k \\in \\{0, 1, 2\\}$ 在每一步 $k$ 被随机选择。\n\n选择特定变换 $w_j$ 的概率取决于当前点 $x_k$ 的位置。令 $S_i$ 表示点 $x_k$ 位于子三角形 $T_i$ 内的事件。这个混沌游戏的概率规则如下：\n\n1.  如果当前点 $x_k$ 在 $T_0$ 中，则下一步的变换从 $\\{w_1, w_2\\}$ 中选择。选择 $w_1$ 的概率是 $\\alpha$，选择 $w_2$ 的概率是 $1-\\alpha$。变换 $w_0$ 不会被选择，即 $P(j_k=0|x_k \\in T_0) = 0$。\n\n2.  如果当前点 $x_k$ 在 $T_1$ 中，则下一步的变换从 $\\{w_0, w_2\\}$ 中选择。选择 $w_0$ 的概率是 $\\beta$，选择 $w_2$ 的概率是 $1-\\beta$。变换 $w_1$ 不会被选择，即 $P(j_k=1|x_k \\in T_1) = 0$。\n\n参数 $\\alpha$ 和 $\\beta$ 是区间 $(0, 1)$ 内的常数。\n\n一旦有点 $x_k$ 落入顶部的子三角形 $T_2$，游戏就停止。一次“迭代”对应于单次应用变换 $w_j$。\n\n计算一个从 $T_0$ 开始的点首次进入 $T_2$ 所需的期望迭代次数 $E$。你的答案应该用 $\\alpha$ 和 $\\beta$ 表示。", "solution": "该问题要求计算一个从子三角形 $T_0$ 开始的点首次落入子三角形 $T_2$ 所需的期望迭代次数。这是一个离散时间随机过程的首中时（first-passage time）问题。\n\n令系统的状态由当前点 $x_k$ 所在的子三角形决定。状态空间为 $\\{S_0, S_1, S_2\\}$，其中 $S_i$ 对应事件 $x_k \\in T_i$。过程从状态 $S_0$ 开始。状态 $S_2$ 是目标状态，在本问题中作为吸收态。\n\n令 $E_i$ 为系统当前处于状态 $S_i$ 时，首次到达 $T_2$ 所需的期望额外迭代次数。我们需要求的是 $E = E_0$。\n\n根据定义，如果系统已经处于目标状态 $S_2$，则到达它所需的期望额外步数为零。因此，\n$$E_2 = 0$$\n\n我们可以通过对第一步的结果进行条件分析，为期望值 $E_0$ 和 $E_1$ 建立一个线性方程组。期望首中时的一般公式是 $E_i = 1 + \\sum_j P_{ij} E_j$，其中 $P_{ij}$ 是从状态 $S_i$ 到状态 $S_j$ 的转移概率。\n\n我们根据问题陈述来确定转移概率：\n\n如果系统处于状态 $S_0$（即 $x_k \\in T_0$）：\n- 变换 $w_1$ 以概率 $\\alpha$ 被选择。下一个点 $x_{k+1} = w_1(x_k)$ 将在 $T_1$ 中，因为 $w_1(T_0) \\subset w_1(T)=T_1$。所以，系统转移到状态 $S_1$。转移概率为 $P_{01} = \\alpha$。\n- 变换 $w_2$ 以概率 $1-\\alpha$ 被选择。下一个点 $x_{k+1} = w_2(x_k)$ 将在 $T_2$ 中。系统转移到状态 $S_2$。转移概率为 $P_{02} = 1-\\alpha$。\n- 变换 $w_0$ 是禁止的，所以 $P_{00}=0$。\n\n$E_0$ 的方程是：\n$$E_0 = 1 + P_{00}E_0 + P_{01}E_1 + P_{02}E_2$$\n$$E_0 = 1 + (0)E_0 + (\\alpha)E_1 + (1-\\alpha)E_2$$\n代入 $E_2=0$，我们得到：\n$$E_0 = 1 + \\alpha E_1$$\n\n如果系统处于状态 $S_1$（即 $x_k \\in T_1$）：\n- 变换 $w_0$ 以概率 $\\beta$ 被选择。下一个点 $x_{k+1} = w_0(x_k)$ 将在 $T_0$ 中。系统转移到状态 $S_0$。转移概率为 $P_{10} = \\beta$。\n- 变换 $w_2$ 以概率 $1-\\beta$ 被选择。下一个点 $x_{k+1} = w_2(x_k)$ 将在 $T_2$ 中。系统转移到状态 $S_2$。转移概率为 $P_{12} = 1-\\beta$。\n- 变换 $w_1$ 是禁止的，所以 $P_{11}=0$。\n\n$E_1$ 的方程是：\n$$E_1 = 1 + P_{10}E_0 + P_{11}E_1 + P_{12}E_2$$\n$$E_1 = 1 + (\\beta)E_0 + (0)E_1 + (1-\\beta)E_2$$\n代入 $E_2=0$，我们得到：\n$$E_1 = 1 + \\beta E_0$$\n\n现在我们有一个包含两个变量 $E_0$ 和 $E_1$ 的二元线性方程组：\n1. $E_0 = 1 + \\alpha E_1$\n2. $E_1 = 1 + \\beta E_0$\n\n我们想解出 $E_0$。将第二个方程中 $E_1$ 的表达式代入第一个方程：\n$$E_0 = 1 + \\alpha (1 + \\beta E_0)$$\n分配 $\\alpha$：\n$$E_0 = 1 + \\alpha + \\alpha\\beta E_0$$\n现在，我们将含有 $E_0$ 的项移到一边：\n$$E_0 - \\alpha\\beta E_0 = 1 + \\alpha$$\n提取公因子 $E_0$：\n$$E_0(1 - \\alpha\\beta) = 1 + \\alpha$$\n最后，解出 $E_0$：\n$$E_0 = \\frac{1 + \\alpha}{1 - \\alpha\\beta}$$\n因为 $\\alpha, \\beta \\in (0, 1)$，所以乘积 $\\alpha\\beta$ 在 $(0, 1)$ 区间内，这保证了分母 $1-\\alpha\\beta$ 非零且为正。期望迭代次数是有限的。", "answer": "$$ \\boxed{\\frac{1+\\alpha}{1-\\alpha\\beta}} $$", "id": "876571"}, {"introduction": "豪斯多夫维数是衡量分形复杂性和空间填充能力的核心指标。在许多高级应用中，分形是通过有约束的迭代生成的，即并非所有变换序列都被允许。本练习 ([@problem_id:876577]) 将带你挑战一个更复杂的场景：计算一个由“有限型子转移”所定义的约束系统生成的分形吸引子的维数。你将学习如何运用加权邻接矩阵这一强大工具，它同时编码了系统的尺度因子和符号动力学规则。", "problem": "实直线上的一个迭代函数系统 (IFS) 由一组压缩仿射映射 $\\{w_i\\}_{i \\in \\mathcal{A}}$ 定义。这样一个系统的吸引子是唯一的非空紧集 $K$，满足 $K = \\bigcup_{i \\in \\mathcal{A}} w_i(K)$。$K$ 中的任意一点 $x \\in K$ 都可以由一个“地址”唯一确定，这个地址是一个无穷序列 $s = s_1s_2s_3\\dots$，其中 $s_k \\in \\mathcal{A}$，它指定了所应用的映射序列。\n\n考虑一个具有两个映射 $w_0$ 和 $w_1$ 的 IFS，由字母表 $\\mathcal{A}=\\{0,1\\}$ 索引。这两个映射分别具有恒定的缩放因子 $r_0$ 和 $r_1$，其中 $0  r_0, r_1  1$。我们感兴趣的是一个受限系统的吸引子，其中并非所有映射序列都是允许的。具体来说，允许的地址序列集合是由禁止片段 '11' 定义的有限型子转移 $\\Sigma_G \\subset \\{0,1\\}^\\mathbb{N}$。也就是说，如果 $s = s_1s_2s_3\\dots \\in \\Sigma_G$，那么对于所有 $k \\ge 1$，我们不能有 $(s_k, s_{k+1}) = (1,1)$。\n\n由此产生的分形集 $A$ 是 $\\Sigma_G$ 在标准投影映射下的像。其豪斯多夫维数 $D$ 取决于缩放因子 $r_0$ 和 $r_1$。\n\n你的任务是在给定缩放因子之间的特定关系 $r_1 = r_0^2$ 的条件下，确定集合 $A$ 的豪斯多夫维数 $D$。请用关于 $r_0$ 的解析表达式表示你的最终答案。", "solution": "我们通过一个加权邻接矩阵来为这个带禁止片段的 IFS 建模，在豪斯多夫维数 $D$ 处，该矩阵的谱半径等于 1。\n\n1.  定义 $a=r_0^s,\\;b=r_1^s$。允许的转移禁止“11”，因此加权邻接矩阵为\n$$\nM=\\begin{pmatrix}a  b\\\\ a  0\\end{pmatrix}.\n$$\n\n2.  其特征方程为\n$$\n\\lambda^2-(a+0)\\lambda-(ab)=0,\\quad\\lambda^2-a\\lambda-ab=0.\n$$\n\n3.  令主特征值 $\\lambda=1$ 可得\n$$\n1^2 - a\\cdot1 - ab=0\\quad\\Longrightarrow\\quad a+ab=1.\n$$\n\n4.  因为 $a=r_0^s$ 且 $b=r_1^s=(r_0^2)^s=r_0^{2s}$，我们有\n$$\nr_0^s + r_0^s\\cdot r_0^{2s}=1\\quad\\Longrightarrow\\quad r_0^s + r_0^{3s}=1.\n$$\n\n5.  令 $x=r_0^s$。则 $x^3+x-1=0$。唯一的实根是\n$$\nx=\\sqrt[3]{\\frac{1}{2}+\\sqrt{\\frac{31}{108}}}\\;+\\;\\sqrt[3]{\\frac{1}{2}-\\sqrt{\\frac{31}{108}}}.\n$$\n\n6.  最后，$s=D$ 满足 $r_0^D=x$，所以\n$$\nD=\\frac{\\ln x}{\\ln r_0}\n=\\frac{\\ln\\!\\bigl(\\sqrt[3]{\\frac{1}{2}+\\sqrt{\\frac{31}{108}}}+\\sqrt[3]{\\frac{1}{2}-\\sqrt{\\frac{31}{108}}}\\bigr)}{\\ln r_0}.\n$$", "answer": "$$\\boxed{\\frac{\\ln\\!\\bigl(\\sqrt[3]{\\tfrac{1}{2}+\\sqrt{\\tfrac{31}{108}}}+\\sqrt[3]{\\tfrac{1}{2}-\\sqrt{\\tfrac{31}{108}}}\\bigr)}{\\ln r_0}}$$", "id": "876577"}]}