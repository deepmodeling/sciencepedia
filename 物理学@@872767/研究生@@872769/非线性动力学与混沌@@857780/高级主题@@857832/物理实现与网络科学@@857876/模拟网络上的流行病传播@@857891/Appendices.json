{"hands_on_practices": [{"introduction": "要理解传染病如何在网络中传播，一个基础的练习是追踪并计算病毒从源头传播到特定个体的概率。这个练习将带领我们分析一个简单有向无环图上的易感-感染 (SI) 模型，通过识别所有可能的感染路径并运用容斥原理，精确计算一个节点最终被感染的总概率。这个过程不仅能加深我们对传播过程随机性的理解，也为分析更复杂网络中的冗余传播路径提供了基本工具 [@problem_id:883373]。", "problem": "考虑一个在有向网络上传播的易感-感染（SI）模型。在此模型中，节点可以处于两种状态之一：易感（S）或感染（I）。该过程始于一个源节点处于感染状态，而所有其他节点都处于易感状态。\n\n感染沿着网络的有向边传播。对于从感染节点 $u$ 到易感节点 $v$ 的每条有向边 $(u, v)$，传播事件以固定的概率 $p$ 发生。所有传播事件都是独立的。如果传播事件发生，节点 $v$ 就被感染。一旦一个节点被感染，它在整个过程中都保持感染状态。\n\n考虑一个有向无环图（DAG），其节点集为 $V = \\{1, 2, 3, 4, 5, 6\\}$，边集为 $E = \\{(1, 2), (1, 3), (2, 4), (3, 4), (1, 5), (4, 5), (5, 6)\\}$。节点 1 是感染的初始源。\n\n计算节点 6 最终被感染的概率。你的最终答案应该是一个关于传播概率 $p$ 的解析表达式。", "solution": "1. 找出从节点 1 到节点 6 的所有有向路径：\n   A: $1\\to5\\to6$，边 $e_{15},e_{56}$。\n   B: $1\\to2\\to4\\to5\\to6$，边 $e_{12},e_{24},e_{45},e_{56}$。\n   C: $1\\to3\\to4\\to5\\to6$，边 $e_{13},e_{34},e_{45},e_{56}$。\n\n2. 设 $A,B,C$ 分别为路径 A、B、C 全部成功传播的事件。由于每条边的传播是独立的，概率为 $p$，\n   $$P(A)=p^2,\\quad P(B)=p^4,\\quad P(C)=p^4.$$\n   \n3. 事件的交集要求其对应边集的并集中的所有边都成功传播：\n   $$P(A\\cap B)=p^5,\\quad P(A\\cap C)=p^5,\\quad P(B\\cap C)=p^6,$$\n   $$P(A\\cap B\\cap C)=p^7.$$\n\n4. 根据容斥原理，\n   \n$$\n     P(\\text{node }6\\text{ infected})\n     =P(A)+P(B)+P(C)\n     -\\bigl[P(A\\cap B)+P(A\\cap C)+P(B\\cap C)\\bigr]\n     +P(A\\cap B\\cap C).\n   $$\n\n   代入可得\n   \n$$\n     P\n     =p^2+2p^4-\\bigl(2p^5+p^6\\bigr)+p^7\n     =p^2+2p^4-2p^5-p^6+p^7.\n   $$", "answer": "$$\\boxed{p^2 + 2p^4 - 2p^5 - p^6 + p^7}$$", "id": "883373"}, {"introduction": "在研究网络疫情时，一个核心问题是：疾病能否在人群中持续传播，还是会自行消亡？这个问题引出了“疫情阈值”这一关键概念，它标志着疾病爆发的临界点。本练习将通过一个 quenched mean-field (QMF) 易感-感染-易感 (SIS) 模型，向我们展示如何通过计算网络邻接矩阵的最大特征值来确定这个阈值。通过解决这个问题，我们将亲身体会到网络结构（通过其邻接矩阵 $\\Lambda(A)$ 体现）如何直接决定了宏观的流行病学动态 [@problem_id:883388]。", "problem": "在网络流行病传播的研究中，淬火平均场易感-感染-易感 (SIS) 模型描述了节点 $i$ 在时间 $t$ 被感染的概率 $p_i(t)$。对于一个包含 $N$ 个节点的网络，其动力学由以下耦合微分方程组决定：\n$$\n\\frac{dp_i}{dt} = \\beta (1-p_i) \\sum_{j=1}^{N} A_{ij} p_j - \\mu p_i, \\quad i=1, \\dots, N\n$$\n此处，$\\beta$ 是每个感染链接的感染率，$\\mu$ 是恢复率，$A$ 是网络的邻接矩阵（如果节点 $i$ 和 $j$ 相连，则 $A_{ij}=1$，否则 $A_{ij}=0$）。我们假设该图是无向的且没有自环（$A_{ii}=0$）。\n\n流行病阈值是感染在网络中持续存在的临界条件。该阈值通过分析无病平衡点（所有 $i$ 的 $p_i=0$）的稳定性来找到。当且仅当无病状态不稳定时，才可能发生流行病爆发。这个条件由邻接矩阵 $A$ 的最大特征值 $\\Lambda(A)$ 决定。感染率与恢复率的临界比值由 $\\tau_c = (\\beta/\\mu)_c = 1/\\Lambda(A)$ 给出。\n\n考虑在一个包含五个节点的小型网络上传播的流行病。该网络由两个共享一个公共中心顶点的三角形节点组成。节点被标记，使得节点 $\\{1, 2, 3\\}$ 构成一个三角形，节点 $\\{3, 4, 5\\}$ 构成第二个三角形。该网络的邻接矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix}\n0  1  1  0  0 \\\\\n1  0  1  0  0 \\\\\n1  1  0  1  1 \\\\\n0  0  1  0  1 \\\\\n0  0  1  1  0\n\\end{pmatrix}\n$$\n确定该网络的流行病阈值 $\\tau_c = (\\beta/\\mu)_c$ 的精确值。", "solution": "我们要求解流行病阈值\n$$\n\\tau_c \\;=\\;\\frac{1}{\\Lambda(A)}\n$$\n其中 $\\Lambda(A)$ 是邻接矩阵的最大特征值\n$$\nA = \\begin{pmatrix}\n0  1  1  0  0 \\\\\n1  0  1  0  0 \\\\\n1  1  0  1  1 \\\\\n0  0  1  0  1 \\\\\n0  0  1  1  0\n\\end{pmatrix}.\n$$\n\n1.  根据对称性，节点 1 和 2 是等价的，节点 4 和 5 也是如此。我们引入拟设特征向量\n$$v=(x,x,z,y,y)^T。$$\n2.  特征值方程 $Av=\\lambda v$ 对于节点 1，给出\n$$\n\\lambda x = x + z,\n$$\n对于节点 4，给出\n$$\n\\lambda y = y + z,\n$$\n以及对于节点 3，给出\n$$\n\\lambda z = 2(x+y).\n$$\n3.  由前两个方程可得，\n$$\nz = (\\lambda-1)x,\n\\qquad\nz=(\\lambda-1)y,\n$$\n所以要么 $\\lambda=1$，要么 $x=y$。根 $\\lambda=1$ 是一个有效的特征值，但不是最大的。对于 $x=y$，设 $a=x=y$，$z=a(\\lambda-1)$ 并代入第三个方程：\n$$\n\\lambda\\bigl[a(\\lambda-1)\\bigr]=2(2a)\n\\;\\;\\Longrightarrow\\;\\;\n\\lambda(\\lambda-1)=4\n\\;\\;\\Longrightarrow\\;\\;\n\\lambda^2-\\lambda-4=0.\n$$\n4.  两个解是\n$$\n\\lambda = \\frac{1\\pm\\sqrt{1+16}}{2}\n=\\frac{1\\pm\\sqrt{17}}{2}.\n$$\n因此，最大特征值是\n$$\n\\Lambda(A)=\\frac{1+\\sqrt{17}}{2}.\n$$\n5.  因此，流行病阈值是\n$$\n\\tau_c=\\frac{1}{\\Lambda(A)}\n=\\frac{2}{1+\\sqrt{17}}.\n$$", "answer": "$$\\boxed{\\frac{2}{1+\\sqrt{17}}}$$", "id": "883388"}, {"introduction": "理论模型的力量在于它们能够解释和预测真实世界的现象，但这需要我们能够从观测数据中估计模型的参数。这个练习将我们置于数据科学家的角色，任务是根据一个星形网络上观测到的确切感染时间序列，来推断潜在的传播率 $\\beta$。我们将使用统计推断中的一个基石方法——最大似然估计 (Maximum Likelihood Estimation, MLE)——来解决这个问题，从而搭建起从微观传播事件到宏观模型参数的桥梁 [@problem_id:883335]。", "problem": "考虑一种疾病在一个由 $N$ 个节点组成的静态网络上根据连续时间易感-感染 (SI) 模型进行传播。在此模型中，节点可以处于两种状态之一：易感 (S) 或感染 (I)。一个受感染的节点会一直保持感染状态。\n\n疾病沿着网络的边传播。如果一个易感节点与一个受感染节点相连，就可能发生感染事件。一个特定的受感染节点将疾病传播给一个特定的易感邻居所需的时间是一个速率为 $\\beta$ 的指数随机变量。因此，一个易感节点 $j$ 被感染的总速率为 $\\lambda_j = k_j(t) \\beta$，其中 $k_j(t)$ 是在时间 $t$ 节点 $j$ 的受感染邻居的数量。\n\n现给定一次流行病在由四个节点 $\\{v_0, v_1, v_2, v_3\\}$ 组成的特定网络上的完整传播历史。该网络结构是一个星形图，其中节点 $v_0$ 是中心节点，连接着三个外围节点 $v_1, v_2, v_3$。外围节点之间互不相连。\n\n观测到的感染历史如下：\n1.  在时间 $t_0 = 0$ 时，中心节点 $v_0$ 被感染。\n2.  在时间 $t_1 > t_0$ 时，节点 $v_1$ 被感染。\n3.  在时间 $t_2 > t_1$ 时，节点 $v_2$ 被感染。\n4.  在时间 $t_3 > t_2$ 时，节点 $v_3$ 被感染，传播完成。\n\n根据这一观测历史，求出传播速率 $\\beta$ 的最大似然估计。将您的答案表示为关于给定感染时间 $t_1$、$t_2$ 和 $t_3$ 的闭式解析表达式。", "solution": "我们将观测到的事件时间标记为 $t_1, t_2, t_3$，其中 $0  t_1  t_2  t_3$。最大似然估计 (MLE) 的目标是找到使观测到的数据出现的概率最大的参数 $\\beta$。\n\n似然函数 $\\mathcal{L}(\\beta)$ 是给定参数 $\\beta$ 时，观测到该感染序列的概率密度。我们可以通过考虑每个时间间隔内的事件来构建它：\n\n1.  **时间间隔 $[0, t_1)$**：中心节点 $v_0$ 已感染，三个外围节点 $v_1, v_2, v_3$ 均易感。因此，每个易感节点被感染的速率为 $\\beta$，总感染速率为 $3\\beta$。第一个感染事件发生在时间 $t_1$ 的概率密度为指数分布 $f(t_1) = 3\\beta e^{-3\\beta t_1}$。\n\n2.  **时间间隔 $[t_1, t_2)$**：一个外围节点（$v_1$）已被感染，剩下两个易感节点（$v_2, v_3$）。总感染速率降为 $2\\beta$。从 $t_1$ 开始，到下一次感染事件发生在 $t_2$（即时间间隔为 $t_2-t_1$）的概率密度为 $f(t_2-t_1) = 2\\beta e^{-2\\beta(t_2-t_1)}$。\n\n3.  **时间间隔 $[t_2, t_3)$**：两个外围节点已被感染，只剩下一个易感节点（$v_3$）。总感染速率为 $\\beta$。从 $t_2$ 开始，到最后一次感染事件发生在 $t_3$（即时间间隔为 $t_3-t_2$）的概率密度为 $f(t_3-t_2) = \\beta e^{-\\beta(t_3-t_2)}$。\n\n由于指数过程的无记忆性，总似然函数是这些独立事件概率密度的乘积：\n$$\n\\mathcal{L}(\\beta) = (3\\beta e^{-3\\beta t_1}) \\cdot (2\\beta e^{-2\\beta(t_2-t_1)}) \\cdot (\\beta e^{-\\beta(t_3-t_2)})\n$$\n简化表达式：\n$$\n\\mathcal{L}(\\beta) = 6\\beta^3 \\exp\\left[-\\beta(3t_1 + 2(t_2-t_1) + (t_3-t_2))\\right]\n$$\n$$\n\\mathcal{L}(\\beta) = 6\\beta^3 \\exp\\left[-\\beta(t_1 + t_2 + t_3)\\right]\n$$\n为了便于求导，我们取对数似然函数：\n$$\n\\ln \\mathcal{L}(\\beta) = \\ln(6) + 3\\ln\\beta - \\beta(t_1+t_2+t_3)\n$$\n将对数似然函数对 $\\beta$ 求导，并令其等于零，以找到最大值：\n$$\n\\frac{d}{d\\beta}\\ln\\mathcal{L}(\\beta) = \\frac{3}{\\beta} - (t_1+t_2+t_3) = 0\n$$\n解出 $\\beta$ 的最大似然估计值 $\\hat{\\beta}$：\n$$\n\\hat{\\beta} = \\frac{3}{t_1+t_2+t_3}\n$$", "answer": "$$\\boxed{\\frac{3}{t_1+t_2+t_3}}$$", "id": "883335"}]}