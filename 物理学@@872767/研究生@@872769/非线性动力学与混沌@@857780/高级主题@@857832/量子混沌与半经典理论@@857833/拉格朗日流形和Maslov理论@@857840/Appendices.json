{"hands_on_practices": [{"introduction": "生成函数是哈密顿力学中的一个强大工具，它允许我们通过寻找“自然”的坐标来简化系统的动力学。一个典型的例子是变换到作用量-角度变量，这通常可以使哈密顿量只依赖于新的动量（作用量），从而使运动方程变得平凡。本练习 [@problem_id:880911] 将通过经典的简谐振子案例，引导你完成这一关键的变换过程，让你亲手体验如何利用第2类生成函数找到作用量-角度变量。", "problem": "考虑一个质量为 $m$、角频率为 $\\omega$ 的一维简谐振子。其动力学由哈密顿量描述：\n$$\nH(q, p) = \\frac{p^2}{2m} + \\frac{1}{2} m\\omega^2 q^2\n$$\n其中 $q$ 是位置， $p$ 是动量。\n\n我们希望进行一次正则变换，从相空间坐标 $(q, p)$ 变换到作用量-角度变量 $(\\phi, I)$。作用量变量 $I$ 由恒定能量 $E$ 下一个运动周期的相空间积分定义：\n$$\nI = \\frac{1}{2\\pi} \\oint p \\, dq\n$$\n在这些新坐标下，新的哈密顿量 $K$ 仅依赖于作用量，即 $K(I) = E(I)$。\n\n这个变换可以由一个第二类生成函数 $F_2(q, I)$ 来描述，它依赖于旧坐标 $q$ 和新动量（作用量） $I$。新旧坐标由以下方程联系：\n$$\np = \\frac{\\partial F_2(q, I)}{\\partial q}, \\quad \\phi = \\frac{\\partial F_2(q, I)}{\\partial I}\n$$\n你的任务是求出生成函数 $F_2(q, I)$ 的显式形式。最终表达式应为 $q$、$I$ 以及参数 $m$ 和 $\\omega$ 的函数。任意积分常数可以设为零。", "solution": "1. 谐振子的能量-作用量关系为\n$$E=I\\omega,\\qquad E=\\frac{p^2}{2m}+\\frac12m\\omega^2q^2\\,.$$\n因此在恒定 $I$ 的轨道上\n$$p^2=2mI\\omega-m^2\\omega^2q^2,\\quad \np=\\pm m\\omega\\sqrt{\\frac{2I}{m\\omega}-q^2}\\,. $$\n\n2. 第二类生成函数满足\n$$p=\\frac{\\partial F_2(q,I)}{\\partial q},\\qquad\n\\phi=\\frac{\\partial F_2(q,I)}{\\partial I}\\,. $$\n\n3. 我们选择 $p$ 的正分支，并对 $q$ 进行积分：\n$$F_2(q,I)=\\int p\\,dq\n=m\\omega\\int\\sqrt{\\frac{2I}{m\\omega}-q^2}\\,dq.$$\n\n4. 使用标准积分\n$$\\int\\sqrt{a^2-q^2}\\,dq\n=\\frac q2\\sqrt{a^2-q^2}+\\frac{a^2}{2}\\arcsin\\!\\frac q a,$$\n其中 $a^2=\\frac{2I}{m\\omega}$，得到\n$$F_2(q,I)\n=m\\omega\\Bigl[\n\\frac q2\\sqrt{\\tfrac{2I}{m\\omega}-q^2}\n+\\frac12\\frac{2I}{m\\omega}\\arcsin\\!\\Bigl(\\frac{q}{\\sqrt{\\tfrac{2I}{m\\omega}}}\\Bigr)\n\\Bigr].$$\n\n5. 化简得，\n$$F_2(q,I)\n=\\frac{m\\omega q}{2}\\sqrt{\\frac{2I}{m\\omega}-q^2}\n+I\\arcsin\\!\\Bigl(q\\sqrt{\\tfrac{m\\omega}{2I}}\\Bigr)\\,,$$\n并将积分常数设为零。", "answer": "$$\\boxed{F_2(q,I)\n=\\frac{m\\omega q}{2}\\sqrt{\\frac{2I}{m\\omega}-q^2}\n+I\\arcsin\\!\\Bigl(q\\sqrt{\\frac{m\\omega}{2I}}\\Bigr)}$$", "id": "880911"}, {"introduction": "正则变换不仅可以单独使用，还可以像函数一样进行复合，从而构建出更复杂的变换。理解如何复合变换以及如何找到复合变换的生成函数，对于处理多步骤的动力学问题至关重要。本练习 [@problem_id:880914] 将引导你将一个由第3类生成函数定义的变换与另一个由第2类生成函数定义的变换复合起来，并推导出最终的第1类生成函数。", "problem": "在哈密顿力学中，系统的动力学由相空间中的坐标 $(q, p)$ 描述。正则变换是一种从坐标 $(q, p)$ 到新坐标 $(Q, P)$ 的坐标变换，它保持哈密顿方程的基本结构不变。这种变换可以用生成函数来描述。新旧坐标之间的关系由生成函数的偏导数确定。根据其自变量的不同，生成函数有四种常见类型：$F_1(q, Q)$、$F_2(q, P)$、$F_3(p, Q)$ 和 $F_4(p, P)$。\n\n本问题涉及两个正则变换的复合。考虑一个一维系统。\n第一个变换 $\\Phi_1$ 将坐标 $(q, p)$ 映射到 $(Q, P)$。它由一个第三类生成函数生成：\n$$F_3^{(1)}(p, Q) = -a(p-Q)^2$$\n其中 $a$ 是一个非零常数。变换方程由 $q = -\\partial F_3^{(1)}/\\partial p$ 和 $P = -\\partial F_3^{(1)}/\\partial Q$ 给出。\n\n第二个变换 $\\Phi_2$ 将坐标 $(Q, P)$ 映射到 $(Q', P')$。它由一个第二类生成函数生成：\n$$F_2^{(2)}(Q, P') = b Q P'$$\n其中 $b$ 是一个非零常数。变换方程由 $P = \\partial F_2^{(2)}/\\partial Q$ 和 $Q' = \\partial F_2^{(2)}/\\partial P'$ 给出。\n\n复合变换 $\\Phi = \\Phi_2 \\circ \\Phi_1$ 将初始坐标 $(q, p)$ 直接映射到最终坐标 $(Q', P')$。这个复合变换也是正则的，并且可以用其自身的生成函数来描述。\n\n确定复合变换 $\\Phi$ 的第一类生成函数 $F_1(q, Q')$。假设 $F_1$ 的任意积分常数为零。第一类生成函数的关系式为 $p = \\partial F_1/\\partial q$ 和 $P' = -\\partial F_1/\\partial Q'$。", "solution": "1. 第一个变换 $\\Phi_1$ 由 $F_3^{(1)}(p,Q)=-a(p-Q)^2$ 生成，给出\n$$q=-\\frac{\\partial F_3^{(1)}}{\\partial p}=-\\bigl[-2a(p-Q)\\bigr]=2a(p-Q),$$\n$$P=-\\frac{\\partial F_3^{(1)}}{\\partial Q}=-\\bigl[2a(p-Q)\\bigr]=-2a(p-Q)\\,. $$\n解出 $Q, P$ 关于 $(q,p)$ 的表达式：\n$$q=2a(p-Q)\\ \\Rightarrow\\ Q=p-\\frac{q}{2a},$$\n$$P=-2a(p-Q)=-q\\,.$$\n\n2. 第二个变换 $\\Phi_2$ 由 $F_2^{(2)}(Q,P')=b\\,Q\\,P'$ 生成，给出\n$$P=\\frac{\\partial F_2^{(2)}}{\\partial Q}=b\\,P',\\qquad\nQ'=\\frac{\\partial F_2^{(2)}}{\\partial P'}=b\\,Q.$$\n因此\n$$P'=\\frac{P}{b}=-\\frac{q}{b},\\qquad Q'=b\\Bigl(p-\\frac{q}{2a}\\Bigr).$$\n\n3. 将 $Q'=b\\,p-\\frac{b}{2a}q$ 反解以表示 $p$：\n$$b\\,p=Q'+\\frac{b}{2a}q\\ \\Rightarrow\\ p=\\frac{Q'}{b}+\\frac{q}{2a}.$$\n\n4. 第一类生成函数 $F_1(q,Q')$ 满足\n$$\\frac{\\partial F_1}{\\partial q}=p,\\qquad\n\\frac{\\partial F_1}{\\partial Q'}=-P'\\,. $$\n写出全微分\n$$dF_1=p\\,dq - P'\\,dQ'\\,. $$\n代入 $p=\\frac{Q'}{b}+\\frac{q}{2a}$ 和 $P'=-\\frac{q}{b}$：\n$$dF_1=\\Bigl(\\frac{Q'}{b}+\\frac{q}{2a}\\Bigr)dq-\\Bigl(-\\frac{q}{b}\\Bigr)dQ'\n=\\Bigl(\\frac{Q'}{b}+\\frac{q}{2a}\\Bigr)dq+\\frac{q}{b}\\,dQ'.$$\n对 $dq$ 项积分时保持 $Q'$ 为常数，对 $dQ'$ 项积分时保持 $q$ 为常数：\n$$F_1(q,Q')=\\int\\Bigl(\\frac{Q'}{b}+\\frac{q}{2a}\\Bigr)dq+\\int\\frac{q}{b}\\,dQ'\n=\\frac{q\\,Q'}{b}+\\frac{q^2}{4a}+C(Q').$$\n然后\n$$\\frac{\\partial F_1}{\\partial Q'}=\\frac{q}{b}+C'(Q')\\overset{!}{=}-P'=\\frac{q}{b}\n\\ \\Rightarrow\\ C'(Q')=0,\\ C=0.$$\n\n因此\n$$F_1(q,Q')=\\frac{q\\,Q'}{b}+\\frac{q^2}{4a}\\,. $$", "answer": "$$\\boxed{\\frac{q\\,Q'}{b}+\\frac{q^2}{4a}}$$", "id": "880914"}, {"introduction": "拉格朗日流形和马斯洛夫理论的核心思想之一是经典轨迹的几何性质深刻地影响着量子现象。在半经典近似中，连接初态和末态的经典轨道的稳定性决定了量子跃迁的振幅。范弗莱克行列式 [@problem_id:880912] 正是量化这种稳定性的关键，它测量了初始位置附近的一族经典轨道随时间的散开或汇聚程度。", "problem": "在量子力学的半经典近似中，将量子态随时间演化的传播子可以表示为连接初始点和终点的所有经典路径的和。根据 Van Vleck-Gutzwiller 公式，对于一维系统，传播子 $K(q_f, T; q_i, 0)$ 由下式给出：\n$$ K(q_f, T; q_i, 0) \\approx \\sum_{\\text{cl. paths}} C \\exp\\left(\\frac{i}{\\hbar} S_{cl}(q_f, T; q_i, 0)\\right) $$\n振幅因子 $C$ 取决于经典路径的稳定性，并与 Van Vleck 行列式 $D$ 相关。该行列式衡量了从初始点 $q_i$ 附近出发的一束经典路径随时间的散开程度。\n\n对于一个演化时间为 $T$ 的一维系统，经典路径建立了一个从初始相空间坐标 $(q_0, p_0)$ 到最终坐标 $(q_T, p_T)$ 的映射。稳定性矩阵（或单值矩阵）$M(T)$ 是此映射的雅可比矩阵：\n$$ M(T) = \\frac{\\partial(q_T, p_T)}{\\partial(q_0, p_0)} = \\begin{pmatrix} \\frac{\\partial q_T}{\\partial q_0}  \\frac{\\partial q_T}{\\partial p_0} \\\\ \\frac{\\partial p_T}{\\partial q_0}  \\frac{\\partial p_T}{\\partial p_0} \\end{pmatrix} = \\begin{pmatrix} M_{qq}  M_{qp} \\\\ M_{pq}  M_{pp} \\end{pmatrix} $$\nVan Vleck 行列式 $D(T)$ 可以方便地计算为该矩阵元素 $M_{qp}$ 的逆：\n$$ D(T) = (M_{qp}(T))^{-1} = \\left(\\frac{\\partial q_T}{\\partial p_0}\\right)^{-1} $$\n考虑一个质量为 $m$ 的粒子在一维排斥势 $V(q) = -\\frac{1}{2}kq^2$ 中运动，其中 $k$ 是一个正常数。该系统被称为倒置谐振子。对于时间间隔 $T$ 内的经典演化，计算 Van Vleck 行列式 $D(T)$。", "solution": "问题要求计算在势 $V(q) = -\\frac{1}{2}kq^2$ 中质量为 $m$ 的粒子的 Van Vleck 行列式 $D(T)$。我们将使用经典流的稳定性矩阵来计算它。\n\n**1. 哈密顿量与运动方程**\n\n首先，我们写出系统的哈密顿量 $H$。动能为 $T = p^2/(2m)$，势能为 $V(q) = -kq^2/2$。\n$$ H(q, p) = T + V = \\frac{p^2}{2m} - \\frac{1}{2}kq^2 $$\n经典动力学由哈密顿方程决定：\n$$ \\dot{q} = \\frac{\\partial H}{\\partial p} = \\frac{p}{m} $$\n$$ \\dot{p} = -\\frac{\\partial H}{\\partial q} = -(-kq) = kq $$\n\n**2. 线性系统与稳定性矩阵**\n\n哈密顿方程构成一个线性一阶常微分方程组。我们可以将它们写成矩阵形式。设状态矢量为 $\\mathbf{x}(t) = \\begin{pmatrix} q(t) \\\\ p(t) \\end{pmatrix}$。那么运动方程为：\n$$ \\frac{d}{dt}\\mathbf{x}(t) = \\begin{pmatrix} \\dot{q} \\\\ \\dot{p} \\end{pmatrix} = \\begin{pmatrix} 0  1/m \\\\ k  0 \\end{pmatrix} \\begin{pmatrix} q \\\\ p \\end{pmatrix} $$\n这是 $\\dot{\\mathbf{x}} = A\\mathbf{x}$ 的形式，其中矩阵 $A$ 为：\n$$ A = \\begin{pmatrix} 0  1/m \\\\ k  0 \\end{pmatrix} $$\n这个线性系统的解是 $\\mathbf{x}(T) = e^{AT} \\mathbf{x}(0)$。矩阵 $M(T) = e^{AT}$ 正是我们需要的稳定性矩阵。\n\n**3. 计算矩阵指数 $M(T) = e^{AT}$**\n\n为了计算矩阵指数，我们首先求 $A$ 的特征值。特征方程为 $\\det(A - \\lambda I) = 0$。\n$$ \\det \\begin{pmatrix} -\\lambda  1/m \\\\ k  -\\lambda \\end{pmatrix} = (-\\lambda)(-\\lambda) - (1/m)(k) = \\lambda^2 - \\frac{k}{m} = 0 $$\n特征值为 $\\lambda_{1,2} = \\pm \\sqrt{k/m}$。我们定义特征频率 $\\omega = \\sqrt{k/m}$。则特征值为 $\\pm\\omega$。\n\n由于特征值是不同的，我们可以使用 Cayley-Hamilton 定理，该定理意味着 $e^{AT}$ 可以写成 $I$ 和 $A$ 的线性组合：\n$$ e^{AT} = c_0(T) I + c_1(T) A $$\n标量系数 $c_0(T)$ 和 $c_1(T)$可以通过求解关于特征值的相同关系式得到：\n$$ e^{\\lambda T} = c_0(T) + c_1(T) \\lambda $$\n代入两个特征值 $\\lambda = \\omega$ 和 $\\lambda = -\\omega$：\n$$ e^{\\omega T} = c_0 + c_1 \\omega $$\n$$ e^{-\\omega T} = c_0 - c_1 \\omega $$\n将这两个方程相加得到：\n$$ e^{\\omega T} + e^{-\\omega T} = 2c_0 \\implies c_0(T) = \\frac{e^{\\omega T} + e^{-\\omega T}}{2} = \\cosh(\\omega T) $$\n用第一个方程减去第二个方程得到：\n$$ e^{\\omega T} - e^{-\\omega T} = 2c_1 \\omega \\implies c_1(T) = \\frac{e^{\\omega T} - e^{-\\omega T}}{2\\omega} = \\frac{\\sinh(\\omega T)}{\\omega} $$\n现在我们可以构造稳定性矩阵 $M(T) = e^{AT}$：\n$$ M(T) = \\cosh(\\omega T) \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\frac{\\sinh(\\omega T)}{\\omega} \\begin{pmatrix} 0  1/m \\\\ k  0 \\end{pmatrix} $$\n$$ M(T) = \\begin{pmatrix} \\cosh(\\omega T)  \\frac{1}{m\\omega}\\sinh(\\omega T) \\\\ \\frac{k}{\\omega}\\sinh(\\omega T)  \\cosh(\\omega T) \\end{pmatrix} $$\n使用 $k = m\\omega^2$，项 $k/\\omega = m\\omega^2/\\omega = m\\omega$。所以稳定性矩阵是：\n$$ M(T) = \\begin{pmatrix} \\cosh(\\omega T)  \\frac{1}{m\\omega}\\sinh(\\omega T) \\\\ m\\omega\\sinh(\\omega T)  \\cosh(\\omega T) \\end{pmatrix} $$\n\n**4. 计算 Van Vleck 行列式**\n\n稳定性矩阵的各个分量为：\n$$ M_{qq}(T) = \\frac{\\partial q_T}{\\partial q_0} = \\cosh(\\omega T) $$\n$$ M_{qp}(T) = \\frac{\\partial q_T}{\\partial p_0} = \\frac{1}{m\\omega}\\sinh(\\omega T) $$\n$$ M_{pq}(T) = \\frac{\\partial p_T}{\\partial q_0} = m\\omega\\sinh(\\omega T) $$\n$$ M_{pp}(T) = \\frac{\\partial p_T}{\\partial p_0} = \\cosh(\\omega T) $$\nVan Vleck 行列式由 $D(T) = (M_{qp}(T))^{-1}$ 给出。\n$$ D(T) = \\left( \\frac{1}{m\\omega}\\sinh(\\omega T) \\right)^{-1} = \\frac{m\\omega}{\\sinh(\\omega T)} $$\n最后，我们代回 $\\omega = \\sqrt{k/m}$：\n$$ D(T) = \\frac{m\\sqrt{k/m}}{\\sinh(T\\sqrt{k/m})} = \\frac{\\sqrt{m^2k/m}}{\\sinh(T\\sqrt{k/m})} = \\frac{\\sqrt{mk}}{\\sinh\\left(T\\sqrt{\\frac{k}{m}}\\right)} $$\n这就是在时间 $T$ 的 Van Vleck 行列式的最终表达式。", "answer": "$$ \\boxed{\\frac{\\sqrt{mk}}{\\sinh\\left(T\\sqrt{\\frac{k}{m}}\\right)}} $$", "id": "880912"}]}