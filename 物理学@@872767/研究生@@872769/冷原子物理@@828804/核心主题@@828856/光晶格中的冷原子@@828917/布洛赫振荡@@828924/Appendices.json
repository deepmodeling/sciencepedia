{"hands_on_practices": [{"introduction": "理论与实践的结合始于将抽象概念与可观测量联系起来。这个练习将能带结构的核心参数——紧束缚模型中的跃迁积分 $\\gamma$——与布洛赫振荡的真实空间振幅联系起来。通过计算不同能带宽度材料中电子的振荡幅度，你将亲身体会到能带的曲率如何直接决定了粒子在外场作用下的运动范围 [@problem_id:1762299]。", "problem": "考虑两种不同的一维晶体材料，材料A和材料B，它们的晶格常数 $a$ 相同。每种材料中，电子在最低导带中的能量色散关系可以用单带紧束缚模型近似表示：\n$$E(k) = E_C - 2\\gamma \\cos(ka)$$\n其中 $k$ 是晶体波矢，$E_C$ 是一个恒定的能量偏移，$\\gamma$ 是最近邻跃迁积分，它与能带的带宽直接相关。\n\n材料A的特征是其跃迁积分 $\\gamma_A = 0.45 \\, \\text{eV}$。\n材料B的特征是其跃迁积分 $\\gamma_B = 1.65 \\, \\text{eV}$。\n\n一个大小为 $\\mathcal{E}$ 的弱均匀静电场被施加在每种材料上。在两种情况下，一个电子最初都静止在导带底（即在 $k=0$ 处，群速度为零）。所施加的电场使电子进行布洛赫振荡。设 $\\Delta x_A$ 和 $\\Delta x_B$ 分别为材料A和材料B中电子布洛赫振荡的空间振幅（离振荡中心的最大位移）。\n\n计算比值 $\\frac{\\Delta x_B}{\\Delta x_A}$。你的答案应以数字形式给出，并四舍五入到三位有效数字。", "solution": "分析始于一维晶体中电子在均匀电场 $\\mathcal{E}$ 作用下的半经典运动方程。晶体动量 $\\hbar k$ 根据外力发生变化：\n$$ \\hbar \\frac{dk}{dt} = -e\\mathcal{E} $$\n其中 $e$ 是元电荷。电子的群速度 $v_g$ 由能带结构 $E(k)$ 决定：\n$$ v_g(k) = \\frac{1}{\\hbar} \\frac{dE}{dk} $$\n\n首先，我们求解波矢 $k$ 的时间演化。对第一个方程进行积分，初始条件为电子在时间 $t=0$ 时从 $k=0$ 开始：\n$$ \\int_0^{k(t)} \\hbar \\, dk' = \\int_0^t -e\\mathcal{E} \\, dt' $$\n$$ \\hbar k(t) = -e\\mathcal{E}t $$\n$$ k(t) = -\\frac{e\\mathcal{E}}{\\hbar}t $$\n这表明波矢随时间线性演化。\n\n接下来，我们使用给定的紧束缚能量色散关系 $E(k) = E_C - 2\\gamma \\cos(ka)$ 来确定群速度：\n$$ v_g(k) = \\frac{1}{\\hbar} \\frac{d}{dk} \\left( E_C - 2\\gamma \\cos(ka) \\right) $$\n$$ v_g(k) = \\frac{1}{\\hbar} \\left( -2\\gamma \\cdot [-\\sin(ka) \\cdot a] \\right) = \\frac{2\\gamma a}{\\hbar} \\sin(ka) $$\n电子在 $k=0$ 处静止的初始条件得到了满足，因为 $v_g(0) = \\frac{2\\gamma a}{\\hbar}\\sin(0) = 0$。\n\n电子的位置 $x(t)$ 可通过从 $t=0$ 开始对其群速度进行积分得到。设其初始位置为 $x(0)$。\n$$ x(t) = x(0) + \\int_0^t v_g(k(t')) dt' $$\n将 $v_g(k)$ 和 $k(t')$ 的表达式代入积分中：\n$$ x(t) = x(0) + \\int_0^t \\frac{2\\gamma a}{\\hbar} \\sin\\left(k(t') a\\right) dt' $$\n$$ x(t) = x(0) + \\int_0^t \\frac{2\\gamma a}{\\hbar} \\sin\\left( -\\frac{e\\mathcal{E}a}{\\hbar}t' \\right) dt' $$\n使用恒等式 $\\sin(-z) = -\\sin(z)$，我们得到：\n$$ x(t) = x(0) - \\frac{2\\gamma a}{\\hbar} \\int_0^t \\sin\\left( \\frac{e\\mathcal{E}a}{\\hbar}t' \\right) dt' $$\n项 $\\frac{e\\mathcal{E}a}{\\hbar}$ 是布洛赫振荡的角频率，记作 $\\omega_B$。积分变为：\n$$ \\int_0^t \\sin(\\omega_B t') dt' = \\left[ -\\frac{1}{\\omega_B}\\cos(\\omega_B t') \\right]_0^t = -\\frac{1}{\\omega_B}(\\cos(\\omega_B t) - \\cos(0)) = \\frac{1 - \\cos(\\omega_B t)}{\\omega_B} $$\n将此结果代回 $x(t)$ 的表达式中：\n$$ x(t) = x(0) - \\frac{2\\gamma a}{\\hbar} \\left( \\frac{1 - \\cos(\\omega_B t)}{\\omega_B} \\right) $$\n$$ x(t) = \\left( x(0) - \\frac{2\\gamma a}{\\hbar \\omega_B} \\right) + \\frac{2\\gamma a}{\\hbar \\omega_B} \\cos(\\omega_B t) $$\n这个方程描述了一个简谐运动。余弦函数前面的项是振荡的振幅。我们称之为 $\\Delta x$：\n$$ \\Delta x = \\frac{2\\gamma a}{\\hbar \\omega_B} $$\n现在，我们代入 $\\omega_B = \\frac{e\\mathcal{E}a}{\\hbar}$ 的定义：\n$$ \\Delta x = \\frac{2\\gamma a}{\\hbar \\left(\\frac{e\\mathcal{E}a}{\\hbar}\\right)} = \\frac{2\\gamma}{e\\mathcal{E}} $$\n这个重要的结果表明，布洛赫振荡的空间振幅与跃迁积分 $\\gamma$ 成正比，与电场强度 $\\mathcal{E}$ 成反比，而与晶格常数 $a$ 无关。\n\n我们需要计算比值 $\\frac{\\Delta x_B}{\\Delta x_A}$。对每种材料使用推导出的振幅表达式：\n$$ \\Delta x_A = \\frac{2\\gamma_A}{e\\mathcal{E}} $$\n$$ \\Delta x_B = \\frac{2\\gamma_B}{e\\mathcal{E}} $$\n由于两种情况下的电场 $\\mathcal{E}$ 和电荷 $e$ 是相同的，该比值简化为：\n$$ \\frac{\\Delta x_B}{\\Delta x_A} = \\frac{\\frac{2\\gamma_B}{e\\mathcal{E}}}{\\frac{2\\gamma_A}{e\\mathcal{E}}} = \\frac{\\gamma_B}{\\gamma_A} $$\n最后，我们代入给定的跃迁积分数值：\n$$ \\gamma_A = 0.45 \\, \\text{eV} $$\n$$ \\gamma_B = 1.65 \\, \\text{eV} $$\n$$ \\frac{\\Delta x_B}{\\Delta x_A} = \\frac{1.65}{0.45} = 3.6666... $$\n将结果四舍五入到三位有效数字，我们得到3.67。", "answer": "$$\\boxed{3.67}$$", "id": "1762299"}, {"introduction": "一个概念的真正掌握不仅在于知道它何时适用，更在于理解它何时失效。这个练习是一个思想实验，旨在探讨布洛赫振荡的适用边界 [@problem_id:1762347]。通过分析具有线性色散关系（如理想石墨烯中的狄拉克费米子）的粒子动力学，你将揭示为何周期性有界的能带结构是产生布洛赫振荡的根本前提，从而深化对该现象本质的理解。", "problem": "在石墨烯的简化二维模型中，动量空间中一个称为狄拉克点 (Dirac point) 的特定点附近的低能电子激发，可以用线性色散关系 $E(\\mathbf{k}) = \\hbar v_F |\\mathbf{k}|$ 来描述。此处，$\\mathbf{k} = (k_x, k_y)$ 是相对于狄拉克点的晶体动量矢量，$v_F$ 是一个具有速度单位的常数，称为费米速度 (Fermi velocity)，而 $\\hbar$ 是约化普朗克常数。\n\n一个电子由该模型描述。在时间 $t=0$ 时，它位于狄拉克点，对应的晶体动量为 $\\mathbf{k}(0) = \\mathbf{0}$。同时，一个均匀且恒定的电场 $\\mathbf{E} = E_0 \\hat{\\mathbf{x}}$ 被施加到石墨烯片上。电子晶体动量的演化由半经典运动方程 $\\frac{d\\mathbf{k}}{dt} = -\\frac{e}{\\hbar}\\mathbf{E}$ 控制，其中 $-e$ 是电子的电荷。\n\n假设在所有相关时间内，电子都保持在该线性色散所描述的能带内，并且这个简化模型成立。下列哪个陈述正确描述了在任意时间 $t > 0$ 时，电子群速度的大小 $|\\mathbf{v}_g(t)|$？\n\nA. 在所有时间 $t > 0$ 内都保持为零。\n\nB. 它随时间线性增加，与 $t$ 成正比。\n\nC. 它是时间的周期性振荡函数。\n\nD. 在所有 $t > 0$ 时，它是一个常数，且等于费米速度 $v_F$。\n\nE. 在所有时间 $t > 0$ 内都无定义。", "solution": "我们已知色散关系 $E(\\mathbf{k}) = \\hbar v_{F} |\\mathbf{k}|$ 和晶体动量的半经典运动方程，\n$$\n\\frac{d\\mathbf{k}}{dt} = -\\frac{e}{\\hbar}\\mathbf{E}.\n$$\n在电场为 $\\mathbf{E} = E_{0}\\hat{\\mathbf{x}}$ 且初始条件为 $\\mathbf{k}(0)=\\mathbf{0}$ 的情况下，对时间积分可得\n$$\n\\mathbf{k}(t) = \\mathbf{k}(0) - \\frac{e}{\\hbar}\\mathbf{E}\\,t = -\\frac{e}{\\hbar}E_{0}t\\,\\hat{\\mathbf{x}}.\n$$\n对于任意 $t>0$，此结果满足 $|\\mathbf{k}(t)| = \\frac{e}{\\hbar}E_{0}t > 0$。\n\n群速度的半经典定义为\n$$\n\\mathbf{v}_{g}(\\mathbf{k}) = \\frac{1}{\\hbar}\\nabla_{\\mathbf{k}} E(\\mathbf{k}).\n$$\n使用 $E(\\mathbf{k}) = \\hbar v_{F}|\\mathbf{k}|$，我们计算\n$$\n\\mathbf{v}_{g}(\\mathbf{k}) = \\frac{1}{\\hbar}\\nabla_{\\mathbf{k}}\\left(\\hbar v_{F}|\\mathbf{k}|\\right) = v_{F}\\nabla_{\\mathbf{k}}|\\mathbf{k}|.\n$$\n当 $\\mathbf{k}\\neq \\mathbf{0}$ 时，梯度满足 $\\nabla_{\\mathbf{k}}|\\mathbf{k}| = \\frac{\\mathbf{k}}{|\\mathbf{k}|}$，因此\n$$\n\\mathbf{v}_{g}(\\mathbf{k}) = v_{F}\\frac{\\mathbf{k}}{|\\mathbf{k}|}, \\quad \\text{so} \\quad |\\mathbf{v}_{g}(\\mathbf{k})| = v_{F}.\n$$\n由于对所有 $t>0$ 都有 $\\mathbf{k}(t)\\neq \\mathbf{0}$，因此群速度的大小不随时间变化，且等于 $v_{F}$。所以，正确的陈述是：对于所有 $t>0$，$|\\mathbf{v}_{g}(t)|$ 为常数且等于 $v_{F}$。", "answer": "$$\\boxed{D}$$", "id": "1762347"}, {"introduction": "半经典模型为我们提供了一个优雅且直观的图像，但它终究是一个近似。这项高级计算练习将带领你超越半经典描述，通过求解含时薛定谔方程来直接模拟波包的完整量子动力学。通过将精确的量子演化结果与半经典预测进行定量比较，你将能够验证半经典近似的有效性范围，并深入探索波包宽度和外场强度等因素如何影响量子与经典描述之间的一致性 [@problem_id:2972562]。", "problem": "考虑一个具有开放边界条件的一维最近邻紧束缚链，该链受到空间均匀的静态电场作用。在自然单位制下进行计算，其中约化普朗克常数设为 $1$，晶格常数设为 $1$，基本电荷设为 $1$。因此，所有量都是无量纲的。在包含 $N$ 个格点的链上，单粒子哈密顿量为\n$$\n\\hat{H} = -J \\sum_{n=0}^{N-2} \\left( |n\\rangle\\langle n+1| + |n+1\\rangle\\langle n| \\right) + F \\sum_{n=0}^{N-1} n |n\\rangle\\langle n|,\n$$\n其中 $J>0$ 是跃迁振幅，$F>0$ 是电场强度，$|n\\rangle$ 表示局域在格点 $n$ 上的 Wannier 态。含时薛定谔方程为\n$$\ni \\frac{d}{dt} |\\psi(t)\\rangle = \\hat{H} |\\psi(t)\\rangle.\n$$\n您将需要比较波包的完整量子动力学与其半经典动力学。\n\n初始状态。初始波函数是一个高斯波包，中心位于格点 $n_0$，准动量为 $k_0$，\n$$\n\\psi_n(0) = \\mathcal{N} \\exp\\!\\left( -\\frac{(n-n_0)^2}{2 \\sigma^2} \\right) e^{i k_0 n},\n$$\n其中 $\\sigma$ 是实空间标准差，$\\mathcal{N}$ 是归一化常数，其选取应使得 $\\sum_{n=0}^{N-1} |\\psi_n(0)|^2 = 1$。在时刻 $t$ 的位置的量子期望值为\n$$\nx_{\\mathrm{qm}}(t) = \\sum_{n=0}^{N-1} n \\, |\\psi_n(t)|^2.\n$$\n\n半经典描述。在准动量空间中窄波包的单带半经典极限下，使用以下经过充分检验的基本关系作为您的出发点：\n- 最近邻紧束缚能带的能量色散关系为 $\\varepsilon(k) = -2J \\cos k$。\n- 群速度为 $v(k) = \\frac{1}{\\hbar} \\frac{d \\varepsilon}{d k}$，在此单位制下简化为 $v(k) = \\frac{d \\varepsilon}{d k}$。\n- 加速度定理为 $\\hbar \\, \\frac{d k}{d t} = -F$，在此单位制下简化为 $\\frac{d k}{d t} = -F$。\n\n将波包视为最初由单一准动量 $k_0$ 表征，并积分半经典运动方程以获得半经典位置 $x_{\\mathrm{sc}}(t)$，初始条件为 $x_{\\mathrm{sc}}(0) = x_{\\mathrm{qm}}(0)$。不要假设任何最终公式；直接根据这些原理推导并实现您所需要的一切。\n\n比较度量。对于给定的参数集和时间区间 $[0,T]$（其中包含 $M$ 个均匀采样时间点），将量子位置与半经典位置之间的均方根偏差定义为\n$$\n\\Delta = \\sqrt{ \\frac{1}{M} \\sum_{m=1}^{M} \\left( x_{\\mathrm{qm}}(t_m) - x_{\\mathrm{sc}}(t_m) \\right)^2 }.\n$$\n以无量纲的浮点数形式报告 $\\Delta$，单位为晶格格点。将报告的每个值四舍五入到 $6$ 位小数。\n\n实现要求。\n- 通过对角化 $\\hat{H}$ 并使用幺正时间演化，在所需时间点获得 $|\\psi(t)\\rangle$，从而精确求解有限链的完整量子动力学。\n- 使用上述原理实现半经典演化。\n- 使用开放边界条件。选择链中心附近的 $n_0$。不允许使用人工吸收边界或加窗函数。\n\n角度单位。准动量 $k_0$ 必须以弧度为单位指定和处理。\n\n时间网格。对于以下每种情况，使用一个包含 $M$ 个时间点的均匀网格 $t_m = m \\, T / M$，其中 $m = 1, 2, \\dots, M$。\n\n测试套件。使用以下四组参数集来探究向半经典近似的收敛及其失效情况：\n- 情况 1（宽波包，弱场）：$N=201$, $J=1.0$, $F=0.05$, $k_0=0.7$, $\\sigma=12.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$。\n- 情况 2（窄波包，相同弱场）：$N=201$, $J=1.0$, $F=0.05$, $k_0=0.7$, $\\sigma=3.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$。\n- 情况 3（宽波包，强场）：$N=201$, $J=1.0$, $F=0.3$, $k_0=0.7$, $\\sigma=12.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$。\n- 情况 4（边界限制运动）：$N=121$, $J=1.0$, $F=0.02$, $k_0=0.0$, $\\sigma=12.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$。\n\n输出格式。您的程序应生成单行输出，其中包含按情况 1 到情况 4 顺序排列的结果，形式为用方括号括起来的逗号分隔列表。例如，输出必须如下所示\n$$\n[\\Delta_1,\\Delta_2,\\Delta_3,\\Delta_4],\n$$\n其中每个 $\\Delta_i$ 都四舍五入到 $6$ 位小数。输出是无量纲的，必须以晶格格点为单位进行解释。", "solution": "该问题要求详细比较一维紧束缚链中波包的完整量子力学演化与其对应的半经典轨迹。这是固态物理学中研究布洛赫振荡和量子-经典对应关系的经典问题。我将首先推导两种描述所需的公式，然后概述数值实现方法。\n\n### 量子力学动力学\n\n该系统是一个由 $N$ 个离散格点组成的有限链，由整数 $n=0, 1, \\dots, N-1$ 索引。链上粒子的状态由状态矢量 $|\\psi(t)\\rangle = \\sum_{n=0}^{N-1} \\psi_n(t) |n\\rangle$ 描述，其中 $\\psi_n(t)$ 是粒子在时刻 $t$ 位于格点 $n$ 的复振幅。其动力学由含时薛定谔方程 $i \\frac{d}{dt} |\\psi(t)\\rangle = \\hat{H} |\\psi(t)\\rangle$ 决定，单位制中 $\\hbar=1$。\n\n哈密顿量 $\\hat{H}$ 由下式给出：\n$$\n\\hat{H} = -J \\sum_{n=0}^{N-2} \\left( |n\\rangle\\langle n+1| + |n+1\\rangle\\langle n| \\right) + F \\sum_{n=0}^{N-1} n |n\\rangle\\langle n|\n$$\n第一项描述了相邻格点之间振幅为 $J$ 的跃迁，第二项代表了由强度为 $F$ 的静态电场引起的线性势。该势导致了 Wannier-Stark 梯。\n\n该算符可以在格点基矢 $\\{|n\\rangle\\}$ 下表示为一个 $N \\times N$ 的实对称（因此也是厄米）矩阵 $H$。其矩阵元为：\n$$\nH_{ij} = \\langle i | \\hat{H} | j \\rangle = \\begin{cases}\n    F \\cdot i  & \\text{if } i=j \\\\\n    -J  & \\text{if } |i-j|=1 \\\\\n    0  & \\text{otherwise}\n\\end{cases}\n$$\n由于哈密顿量不含时，薛定谔方程的形式解为 $|\\psi(t)\\rangle = e^{-iHt} |\\psi(0)\\rangle$，其中 $|\\psi(0)\\rangle$ 是初始状态。通过对角化哈密顿矩阵 $H$ 可以获得数值精确解。设本征值为 $E_j$，对应的本征矢量为 $|\\phi_j\\rangle$，满足 $H|\\phi_j\\rangle = E_j|\\phi_j\\rangle$。时间演化算符在此本征基矢下可以表示为 $e^{-iHt} = \\sum_j e^{-iE_j t} |\\phi_j\\rangle\\langle\\phi_j|$。\n\n那么在时刻 $t$ 的状态为：\n$$\n|\\psi(t)\\rangle = \\left(\\sum_j e^{-iE_j t} |\\phi_j\\rangle\\langle\\phi_j|\\right) |\\psi(0)\\rangle = \\sum_j c_j e^{-iE_j t} |\\phi_j\\rangle\n$$\n其中 $c_j = \\langle\\phi_j|\\psi(0)\\rangle$ 是初始状态投影到本征基矢上的系数。\n\n初始状态是一个高斯波包：\n$$\n\\psi_n(0) = \\langle n | \\psi(0) \\rangle = \\mathcal{N} \\exp\\left( -\\frac{(n-n_0)^2}{2\\sigma^2} \\right) e^{ik_0n}\n$$\n归一化常数 $\\mathcal{N}$ 的选取应使得 $\\sum_{n=0}^{N-1} |\\psi_n(0)|^2 = 1$，这给出 $\\mathcal{N} = 1 / \\sqrt{\\sum_{n=0}^{N-1} \\exp\\left(-\\frac{(n-n_0)^2}{\\sigma^2}\\right)}$。\n\n在时刻 $t$ 的位置的量子期望值通过以下方式计算：\n$$\nx_{\\mathrm{qm}}(t) = \\langle\\psi(t)|\\hat{x}|\\psi(t)\\rangle = \\sum_{n=0}^{N-1} n |\\psi_n(t)|^2\n$$\n\n### 半经典动力学\n\n半经典模型将波包视为一个点状粒子，其动力学由能带结构 $\\varepsilon(k)$ 和加速度定理决定。\n提供的原理如下：\n1.  能量色散关系：$\\varepsilon(k) = -2J \\cos(k)$。\n2.  群速度：$v(k) = \\frac{d\\varepsilon}{dk} = 2J \\sin(k)$。\n3.  加速度：$\\frac{dk}{dt} = -F$。\n\n对加速度方程积分，并代入初始条件 $k(0) = k_0$，得到含时的准动量：\n$$\nk(t) = k_0 - Ft\n$$\n通过对群速度积分 $\\frac{dx_{\\mathrm{sc}}}{dt} = v(k(t))$，可以找到半经典位置 $x_{\\mathrm{sc}}(t)$：\n$$\n\\frac{dx_{\\mathrm{sc}}}{dt} = 2J \\sin(k_0 - Ft)\n$$\n将其从 $t=0$ 积分到 $t$，得到位置的变化量：\n$$\nx_{\\mathrm{sc}}(t) - x_{\\mathrm{sc}}(0) = \\int_0^t 2J \\sin(k_0 - Ft') dt' = 2J \\left[ \\frac{\\cos(k_0 - Ft')}{F} \\right]_0^t\n$$\n$$\nx_{\\mathrm{sc}}(t) = x_{\\mathrm{sc}}(0) + \\frac{2J}{F} \\left( \\cos(k_0 - Ft) - \\cos(k_0) \\right)\n$$\n初始半经典位置 $x_{\\mathrm{sc}}(0)$ 设为等于初始量子期望值，即 $x_{\\mathrm{sc}}(0) = x_{\\mathrm{qm}}(0) = \\sum_{n=0}^{N-1} n |\\psi_n(0)|^2$。\n\n### 数值实现与比较\n\n对于每个测试用例，算法按以下步骤进行：\n1.  **设置**：定义所有参数（$N, J, F, k_0, \\sigma, n_0, T, M$），并为 $m=1, \\dots, M$ 构建均匀时间网格 $t_m = m T/M$。\n2.  **初始状态**：构造离散的初始波函数 $\\psi_n(0)$ 并将其归一化。\n3.  **量子动力学**：\n    a. 构造 $N \\times N$ 的哈密顿矩阵 $H$。\n    b. 使用标准的厄米矩阵本征求解器（例如，`numpy.linalg.eigh`）对 $H$ 进行数值对角化，以获得本征值 $\\{E_j\\}$ 和由本征矢量 $U$ 组成的幺正矩阵（其列为 $|\\phi_j\\rangle$）。\n    c. 将初始状态投影到本征基矢上：$|\\psi(0)\\rangle_{\\mathrm{eig}} = U^\\dagger |\\psi(0)\\rangle$。\n    d. 对于网格中的每个时间点 $t_m$，通过将相位因子 $e^{-iE_j t_m}$ 应用于 $|\\psi(0)\\rangle_{\\mathrm{eig}}$ 的分量，并变换回格点基矢，来计算演化后的状态：$|\\psi(t_m)\\rangle = U (e^{-iE t_m} |\\psi(0)\\rangle_{\\mathrm{eig}})$。这一步可以通过对所有时间点同时使用向量化操作来高效实现。\n    e. 计算量子位置数组 $x_{\\mathrm{qm}}(t_m)$。\n4.  **半经典动力学**：\n    a. 计算初始位置 $x_{\\mathrm{qm}}(0)$ 并将 $x_{\\mathrm{sc}}(0)$ 设置为该值。\n    b. 使用推导出的解析公式计算半经典位置数组 $x_{\\mathrm{sc}}(t_m)$。\n5.  **偏差**：使用计算出的数组 $x_{\\mathrm{qm}}(t_m)$ 和 $x_{\\mathrm{sc}}(t_m)$ 在整个时间网格上计算均方根偏差 $\\Delta$。\n6.  **输出**：将最终的 $\\Delta$ 值四舍五入到 6 位小数并存储。然后将所有情况的结果格式化为所需的输出字符串。\n\n此过程为有限链上的量子动力学提供了严谨且数值精确（在机器精度范围内）的评估，从而可以与理想化的半经典模型进行精确比较。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the root-mean-square deviation between quantum and semiclassical\n    dynamics for four specified test cases.\n    \"\"\"\n    \n    # Test cases from the problem statement.\n    # (N, J, F, k0, sigma, M)\n    # n0 and T are derived from these.\n    test_cases_params = [\n        (201, 1.0, 0.05, 0.7, 12.0, 256),\n        (201, 1.0, 0.05, 0.7, 3.0, 256),\n        (201, 1.0, 0.3, 0.7, 12.0, 256),\n        (121, 1.0, 0.02, 0.0, 12.0, 256),\n    ]\n\n    results = []\n\n    for N, J, F, k0, sigma, M in test_cases_params:\n        # Derived parameters\n        n0 = N // 2\n        T = 2 * np.pi / F\n        \n        # 1. Time grid\n        # The sum for Delta is from m=1 to M, so we start at t=T/M.\n        times = np.linspace(T / M, T, M)\n        \n        # 2. Site indices\n        sites = np.arange(N)\n        \n        # 3. Initial State Preparation\n        psi_unnormalized = np.exp(-(sites - n0)**2 / (2 * sigma**2)) * np.exp(1j * k0 * sites)\n        norm = np.linalg.norm(psi_unnormalized)\n        psi_0 = psi_unnormalized / norm\n\n        # 4. Quantum Dynamics Calculation\n        # a. Construct Hamiltonian\n        H_diag = F * sites\n        H_offdiag = -J * np.ones(N - 1)\n        H = np.diag(H_diag) + np.diag(H_offdiag, k=1) + np.diag(H_offdiag, k=-1)\n        \n        # b. Eigendecomposition of the Hermitian Hamiltonian\n        eigenvalues, eigenvectors = np.linalg.eigh(H)\n        \n        # c. Project initial state onto the eigenbasis\n        # For a real symmetric matrix H, eigenvectors are real, so U.T.conj()=U.T\n        psi_0_eigenbasis = eigenvectors.T @ psi_0\n        \n        # d. Evolve state in time (vectorized for all time steps)\n        # Outer product creates an (N, M) matrix of phases e^{-i*E_j*t_m}\n        time_evolution_factors = np.exp(np.outer(-1j * eigenvalues, times))\n        # Multiply each eigen-coefficient with its time evolution factor\n        psi_t_eigenbasis = psi_0_eigenbasis[:, np.newaxis] * time_evolution_factors\n        # Transform back to the site basis\n        psi_t = eigenvectors @ psi_t_eigenbasis  # Shape (N, M)\n        \n        # e. Calculate quantum expectation value of position\n        x_qm = np.sum(sites[:, np.newaxis] * np.abs(psi_t)**2, axis=0) # Shape (M,)\n\n        # 5. Semiclassical Dynamics Calculation\n        # a. Initial position\n        x_qm_0 = np.sum(sites * np.abs(psi_0)**2)\n        x_sc_0 = x_qm_0\n\n        # b. Semiclassical trajectory for all time steps\n        x_sc = x_sc_0 + (2 * J / F) * (np.cos(k0 - F * times) - np.cos(k0))\n        \n        # 6. Comparison Metric\n        deviation = np.sqrt(np.mean((x_qm - x_sc)**2))\n        results.append(deviation)\n\n    # 7. Final output formatting\n    # Round to 6 decimal places and format to ensure trailing zeros.\n    formatted_results = [f'{round(r, 6):.6f}' for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2972562"}]}