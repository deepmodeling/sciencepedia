{"hands_on_practices": [{"introduction": "日冕物质抛射（CME）通常被建模为膨胀的磁通量绳。理解当这些巨大的磁结构在行星际空间中传播时其内部磁场如何演化，对于预测它们到达地球时的地磁效应至关重要。本练习将引导你应用理想磁流体动力学（MHD）中的一个基本守恒定律——磁通量守恒——来推导CME磁场强度随其与太阳距离的增加而衰减的规律[@problem_id:235145]。这项实践有助于将抽象的物理原理与CME的可观测特性联系起来。", "problem": "日冕物质抛射 (CME) 可以被建模为一个具有环形几何结构的、膨胀的理想磁流体力学 (MHD) 磁通量绳。\n\n该磁通量绳的特征在于一个随时间变化的大半径 $R_c(t)$（从太阳中心到环体横截面几何中心的距离）和一个随时间变化的小半径 $a(t)$。\n\n在此模型中，距离环体主轴为 $r_{cyl}$ 的柱坐标距离处的环向磁场分量 $B_t$ 由下式给出：\n$$B_t(r_{cyl}, t) = B_{t,c}(t) \\frac{R_c(t)}{r_{cyl}}$$\n其中 $B_{t,c}(t)$ 是环体横截面中心（此处 $r_{cyl} = R_c(t)$）的环向磁场强度。\n\n随着 CME 向外传播，磁通量绳会膨胀。观测表明，这种膨胀不一定是自相似的。假设小半径随大半径按以下幂律演化：\n$$a(t) = k R_c(t)^\\beta$$\n其中 $k$ 是一个常数，$\\beta$ 是一个标度指数，满足 $0  \\beta  1$。\n\n在理想磁流体力学中，穿过环体小横截面的总环向磁通量 $\\Psi_t$ 是守恒的。在大尺度膨胀的渐近极限下，即 $R_c(t) \\gg a(t)$ 时，中心环向磁场预计将服从 $B_{t,c}(t) \\propto R_c(t)^{-\\eta}$ 形式的幂律。\n\n推导用参数 $\\beta$ 表示标度指数 $\\eta$ 的表达式。\n\n您可能会发现以下定积分很有用：\n$$ \\int_0^{2\\pi} \\frac{d\\theta}{A + B \\cos\\theta} = \\frac{2\\pi}{\\sqrt{A^2 - B^2}} \\quad \\text{for} \\quad A > |B| $$", "solution": "问题要求解对于一个膨胀的环形 CME 磁通量绳，关系式 $B_{t,c}(t) \\propto R_c(t)^{-\\eta}$ 中的标度指数 $\\eta$。推导基于环向磁通量 $\\Psi_t$ 的守恒。\n\n**步骤 1：表达环向磁通量 $\\Psi_t$**\n\n环向磁通量是环向磁场 $B_t$ 在环体圆形横截面上的积分，该横截面的面积为 $A = \\pi a^2$。我们使用以小横截面轴线为中心的局部极坐标 $(\\rho, \\phi)$，使得横截面中的一个点距离环体主轴的柱坐标距离为 $r_{cyl} = R_c + \\rho \\cos\\phi$。面积元为 $dA = \\rho \\, d\\rho \\, d\\phi$。\n\n磁通量 $\\Psi_t$ 由下式给出：\n$$ \\Psi_t = \\iint_A B_t \\, dA = \\int_0^a \\int_0^{2\\pi} B_t(r_{cyl}(\\rho, \\phi), t) \\, \\rho \\, d\\rho \\, d\\phi $$\n\n代入给定的 $B_t$ 表达式：\n$$ \\Psi_t = \\int_0^a \\int_0^{2\\pi} \\left( B_{t,c}(t) \\frac{R_c(t)}{R_c(t) + \\rho \\cos\\phi} \\right) \\rho \\, d\\rho \\, d\\phi $$\n\n为简单起见，我们将省略显式的时间依赖关系，因为积分是在一个固定的时间瞬间进行的。\n$$ \\Psi_t = B_{t,c} R_c \\int_0^a \\rho \\left( \\int_0^{2\\pi} \\frac{d\\phi}{R_c + \\rho \\cos\\phi} \\right) d\\rho $$\n\n**步骤 2：计算积分**\n\n首先，我们使用给定公式，令 $A=R_c$ 和 $B=\\rho$，求解关于 $\\phi$ 的内部积分。由于 $\\rho \\le a$ 并且我们处于 $R_c \\gg a$ 的情况，条件 $A>|B|$ 是满足的。\n$$ \\int_0^{2\\pi} \\frac{d\\phi}{R_c + \\rho \\cos\\phi} = \\frac{2\\pi}{\\sqrt{R_c^2 - \\rho^2}} $$\n\n现在，将此结果代回到 $\\Psi_t$ 的表达式中：\n$$ \\Psi_t = B_{t,c} R_c \\int_0^a \\rho \\left( \\frac{2\\pi}{\\sqrt{R_c^2 - \\rho^2}} \\right) d\\rho = 2\\pi B_{t,c} R_c \\int_0^a \\frac{\\rho}{\\sqrt{R_c^2 - \\rho^2}} d\\rho $$\n\n接下来，我们计算关于 $\\rho$ 的积分。令 $u = R_c^2 - \\rho^2$。则 $du = -2\\rho \\, d\\rho$，因此 $\\rho \\, d\\rho = -du/2$。积分限从 $\\rho=0 \\to u=R_c^2$ 和 $\\rho=a \\to u=R_c^2-a^2$ 变化。\n$$ \\int_0^a \\frac{\\rho}{\\sqrt{R_c^2 - \\rho^2}} d\\rho = \\int_{R_c^2}^{R_c^2-a^2} \\frac{-du/2}{\\sqrt{u}} = -\\frac{1}{2} \\left[ 2\\sqrt{u} \\right]_{R_c^2}^{R_c^2-a^2} = -\\left[ \\sqrt{u} \\right]_{R_c^2}^{R_c^2-a^2} $$\n$$ = -(\\sqrt{R_c^2 - a^2} - \\sqrt{R_c^2}) = R_c - \\sqrt{R_c^2 - a^2} $$\n\n将此代回，得到环向磁通量的完整表达式：\n$$ \\Psi_t = 2\\pi B_{t,c} R_c (R_c - \\sqrt{R_c^2 - a^2}) $$\n我们可以从平方根中提取因子 $R_c$ 得到：\n$$ \\Psi_t = 2\\pi B_{t,c} R_c^2 \\left(1 - \\sqrt{1 - \\left(\\frac{a}{R_c}\\right)^2}\\right) $$\n\n**步骤 3：应用磁通量守恒和膨胀定律**\n\n根据理想磁流体力学，$\\Psi_t$ 在膨胀过程中是一个常数。因此：\n$$ B_{t,c}(t) R_c(t)^2 \\left(1 - \\sqrt{1 - \\left(\\frac{a(t)}{R_c(t)}\\right)^2}\\right) = \\text{常数} $$\n\n这意味着 $B_{t,c}(t)$ 具有以下标度关系：\n$$ B_{t,c}(t) \\propto \\frac{1}{R_c(t)^2 \\left(1 - \\sqrt{1 - \\left(\\frac{a(t)}{R_c(t)}\\right)^2}\\right)} $$\n\n现在，我们代入给定的膨胀定律 $a(t) = k R_c(t)^\\beta$：\n$$ \\frac{a(t)}{R_c(t)} = \\frac{k R_c(t)^\\beta}{R_c(t)} = k R_c(t)^{\\beta-1} $$\n所以标度关系变为：\n$$ B_{t,c}(t) \\propto \\frac{1}{R_c(t)^2 \\left(1 - \\sqrt{1 - k^2 R_c(t)^{2(\\beta-1)}}\\right)} $$\n\n**步骤 4：对大的 $R_c$ 进行渐近分析**\n\n我们想在 $R_c(t) \\to \\infty$ 的极限下找到幂律标度关系。由于 $0  \\beta  1$，指数 $\\beta-1$ 是负的。因此，当 $R_c \\to \\infty$ 时，项 $x = k^2 R_c(t)^{2(\\beta-1)}$ 趋近于零。\n\n我们可以对小的 $x$ 使用 $\\sqrt{1-x}$ 的泰勒展开：\n$$ \\sqrt{1-x} \\approx 1 - \\frac{1}{2}x + \\mathcal{O}(x^2) $$\n分母括号中的项变为：\n$$ 1 - \\sqrt{1 - x} \\approx 1 - \\left(1 - \\frac{1}{2}x\\right) = \\frac{1}{2}x $$\n将 $x = k^2 R_c(t)^{2(\\beta-1)}$ 代回到这个近似中：\n$$ 1 - \\sqrt{1 - k^2 R_c(t)^{2(\\beta-1)}} \\approx \\frac{1}{2} k^2 R_c(t)^{2(\\beta-1)} $$\n\n现在将此渐近形式代回到 $B_{t,c}(t)$ 的标度关系中：\n$$ B_{t,c}(t) \\propto \\frac{1}{R_c(t)^2 \\left(\\frac{1}{2} k^2 R_c(t)^{2(\\beta-1)}\\right)} $$\n常数 $\\frac{1}{2}k^2$可以被吸收到比例常数中。\n$$ B_{t,c}(t) \\propto \\frac{1}{R_c(t)^2 R_c(t)^{2\\beta - 2}} = \\frac{1}{R_c(t)^{2 + 2\\beta - 2}} = R_c(t)^{-2\\beta} $$\n\n**步骤 5：确定标度指数 $\\eta$**\n\n通过将我们推导出的标度关系 $B_{t,c}(t) \\propto R_c(t)^{-2\\beta}$ 与所需的形式 $B_{t,c}(t) \\propto R_c(t)^{-\\eta}$ 进行比较，我们可以直接确定标度指数 $\\eta$。\n$$ \\eta = 2\\beta $$", "answer": "$$ \\boxed{2\\beta} $$", "id": "235145"}, {"introduction": "在现实的日球层中，CME并非孤立传播。当一快速CME追上并“撞击”先前抛出的较慢CME或太阳风时，会形成激波，这种相互作用能够显著增强空间天气事件的强度。本练习通过一个简化的流体动力学模型，让你运用基本守恒定律来推导相互作用产生的激波前沿的速度[@problem_id:235296]。通过这个练习，你将掌握分析行星际激波这一关键空间天气现象的基本技能。", "problem": "日冕物质抛射（CMEs）是太阳大规模等离子体和磁场喷发的现象。当一个快速CME跟随一个较慢的CME时，它们的相互作用前沿会形成一个激波。这一现象对空间天气预报至关重要，因为它可能导致粒子加速增强。\n\n考虑一个此类相互作用的简化一维模型。一个慢速CME在其经过的空间区域充满了其抛射物，我们将其建模为一个密度为常数 $\\rho_1$、以恒定速度 $v_1$ 从太阳径向向外移动的均匀介质。随后，第二个更快的CME沿着相同的径向路径被发射出来。其前沿就像一个不可穿透的活塞，以恒定速度 $v_2  v_1$ 运动。\n\n这个活塞在第一个CME的抛射物中驱动一个正向激波。设在太阳的静止参考系中，该激波波前的速度为 $v_s$。将激波两侧的等离子体视为绝热指数为常数 $\\gamma$ 的理想气体。您可以假设上游介质（第一个CME的抛射物）是“冷的”，意味着其热压可以忽略不计。此外，忽略磁场的影响。\n\n推导激波波前速度 $v_s$ 的表达式。你的最终答案应以 $v_1$、$v_2$ 和 $\\gamma$ 表示。", "solution": "我们在太阳静止参考系中应用Rankine-Hugoniot跳跃条件。上游介质（慢速CME）的状态为 $(\\rho_1, v_1)$，下游介质（被活塞压缩的物质）速度为 $v_2$，激波速度为 $v_s$。\n\n质量守恒定律要求跨越激波的质量通量是连续的：\n$$\\rho_1 (v_s - v_1) = \\rho_2 (v_s - v_2)$$\n由于上游介质是“冷的”（$p_1 \\approx 0$），动量守恒定律简化为：\n$$p_2 + \\rho_2 (v_s - v_2)^2 = \\rho_1 (v_s - v_1)^2$$\n对于一个理想气体中的强激波，密度压缩比是一个常数，仅取决于绝热指数 $\\gamma$：\n$$\\frac{\\rho_2}{\\rho_1} = \\frac{\\gamma+1}{\\gamma-1}$$\n现在我们可以利用这些关系来求解激波速度 $v_s$。首先，将密度压缩比代入质量守恒方程，得到上下游相对速度之间的关系：\n$$v_s - v_2 = \\frac{\\rho_1}{\\rho_2} (v_s - v_1) = \\frac{\\gamma-1}{\\gamma+1} (v_s - v_1)$$\n重新整理此方程，以 $v_2$ 表示：\n$$v_2 = v_s - \\frac{\\gamma-1}{\\gamma+1}(v_s - v_1) = v_s \\left(1 - \\frac{\\gamma-1}{\\gamma+1}\\right) + v_1 \\left(\\frac{\\gamma-1}{\\gamma+1}\\right) = \\frac{2}{\\gamma+1}v_s + \\frac{\\gamma-1}{\\gamma+1}v_1$$\n最后，我们求解 $v_s$。将上式两边乘以 $(\\gamma+1)$ 并重新整理：\n$$(\\gamma+1)v_2 = 2v_s + (\\gamma-1)v_1$$\n$$2v_s = (\\gamma+1)v_2 - (\\gamma-1)v_1$$\n因此，激波速度为：\n$$v_s = \\frac{(\\gamma+1)v_2 - (\\gamma-1)v_1}{2}$$", "answer": "$$\\boxed{\\frac{(\\gamma+1)v_2 - (\\gamma-1)v_1}{2}}$$", "id": "235296"}, {"introduction": "准确的空间天气预报通常依赖于综合多个不同模型的预测结果。每个模型可能基于不同的物理假设，因此在不同条件下表现各异。本练习探讨了一个核心的预报问题：如何以最佳方式将两个独立的概率预报模型线性组合，以最大化预报的准确性[@problem_id:235172]。你将通过最小化组合预报的布莱尔分数（Brier score）来推导最优权重，这是一种在统计预报领域广泛应用的高级技巧。", "problem": "在空间天气预报领域，一个关键挑战是精确预测日冕物质抛射（CME）是否会在地球引发显著的地磁暴。为了提高预报准确性，通常会将来自多个独立模型的预测结合起来。\n\n考虑两个概率预报模型 A 和 B，它们为一次 CME 是否具有地球有效性提供概率 $p_A$ 和 $p_B$。实际结果是一个二元变量 $o$，如果发生磁暴则 $o=1$，否则 $o=0$。概率预报的准确性通常用 Brier 评分来衡量，其定义为均方误差 $BS = \\langle (p - o)^2 \\rangle$，其中尖括号表示对大量过去事件集合的平均。\n\n可以通过对单个模型预报进行线性加权来形成一个组合预报 $p_C$：\n$$p_C = w_A p_A + (1-w_A) p_B$$\n其中 $w_A$ 是分配给模型 A 预报的权重。\n\n针对用于预测某类 CME 引发磁暴的两个特定模型，已经进行了长期验证研究：\n1.  **模型 A** 是一种复杂的磁流体动力学（MHD）模拟。研究发现，其 Brier 评分 $BS_A$ 与该 CME 太阳源区的特征湍动磁能密度 $U_{turb}$ 成正比。该关系由 $BS_A = \\alpha U_{turb}$ 给出，其中 $\\alpha$ 是一个经验常数。\n2.  **模型 B** 是一种更简单的、基于拖曳的经验模型。其 Brier 评分 $BS_B$ 主要由 CME 传播路径上的环境太阳风的可变性决定。这通过沿日地路径的太阳风质子密度的方差 $\\sigma_{sw}^2$ 来量化，其关系为 $BS_B = \\beta \\sigma_{sw}^2$，其中 $\\beta$ 是另一个经验常数。\n\n假设两个预报 $p_A$ 和 $p_B$ 在统计上都是**校准的**，即平均预报概率与事件的观测频率相匹配（$ \\langle p_A \\rangle = \\langle p_B \\rangle = \\langle o \\rangle $）。进一步假设预报误差 $e_A = p_A - o$ 和 $e_B = p_B - o$ 是**不相关的**（$\\langle e_A e_B \\rangle = 0$）。\n\n推导使组合预報 $p_C$ 的 Brier 评分最小化的模型 A 的最优权重系数 $w_A$。用物理参数 $U_{turb}$、$\\sigma_{sw}^2$ 以及常数 $\\alpha$ 和 $\\beta$ 来表示你的答案。", "solution": "我们的目标是找到权重 $w_A$，以最小化组合预报 $p_C = w_A p_A + (1-w_A) p_B$ 的 Brier 评分 $BS_C = \\langle (p_C - o)^2 \\rangle$。\n\n首先，我们用单个模型的预报误差 $e_A = p_A - o$ 和 $e_B = p_B - o$ 来表示组合预报的误差 $e_C = p_C - o$：\n$$e_C = p_C - o = (w_A p_A + (1-w_A)p_B) - o$$\n通过重新组合项，并代入 $o = w_A o + (1-w_A)o$，我们得到：\n$$e_C = w_A(p_A - o) + (1-w_A)(p_B - o) = w_A e_A + (1-w_A)e_B$$\n\n接下来，我们计算组合预报的 Brier 评分 $BS_C = \\langle e_C^2 \\rangle$：\n$$BS_C = \\langle (w_A e_A + (1-w_A)e_B)^2 \\rangle = \\langle w_A^2 e_A^2 + (1-w_A)^2 e_B^2 + 2 w_A (1-w_A) e_A e_B \\rangle$$\n利用平均的线性性质，我们得到：\n$$BS_C = w_A^2 \\langle e_A^2 \\rangle + (1-w_A)^2 \\langle e_B^2 \\rangle + 2 w_A (1-w_A) \\langle e_A e_B \\rangle$$\n根据题意，预报误差不相关，即 $\\langle e_A e_B \\rangle = 0$。同时，根据Brier评分的定义，$\\langle e_A^2 \\rangle = BS_A$ 且 $\\langle e_B^2 \\rangle = BS_B$。因此，方程简化为：\n$$BS_C = w_A^2 BS_A + (1-w_A)^2 BS_B$$\n\n现在，我们将 $BS_A = \\alpha U_{turb}$ 和 $BS_B = \\beta \\sigma_{sw}^2$ 代入，得到 $BS_C$ 作为 $w_A$ 的函数：\n$$BS_C(w_A) = w_A^2 (\\alpha U_{turb}) + (1-w_A)^2 (\\beta \\sigma_{sw}^2)$$\n为了找到使 $BS_C$ 最小的 $w_A$，我们对 $w_A$ 求导并令其为零：\n$$\\frac{dBS_C}{dw_A} = 2w_A (\\alpha U_{turb}) - 2(1-w_A)(\\beta \\sigma_{sw}^2) = 0$$\n$$w_A (\\alpha U_{turb}) = (1-w_A)(\\beta \\sigma_{sw}^2)$$\n$$w_A (\\alpha U_{turb}) = \\beta \\sigma_{sw}^2 - w_A (\\beta \\sigma_{sw}^2)$$\n$$w_A (\\alpha U_{turb} + \\beta \\sigma_{sw}^2) = \\beta \\sigma_{sw}^2$$\n\n求解 $w_A$ 得到最优权重：\n$$w_A = \\frac{\\beta \\sigma_{sw}^2}{\\alpha U_{turb} + \\beta \\sigma_{sw}^2}$$", "answer": "$$\\boxed{\\frac{\\beta\\,\\sigma_{sw}^2}{\\alpha\\,U_{turb} + \\beta\\,\\sigma_{sw}^2}}$$", "id": "235172"}]}