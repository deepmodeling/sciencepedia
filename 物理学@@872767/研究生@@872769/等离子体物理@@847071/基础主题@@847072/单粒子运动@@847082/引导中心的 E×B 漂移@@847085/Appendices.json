{"hands_on_practices": [{"introduction": "第一个练习直接应用了 $\\vec{E} \\times \\vec{B}$ 漂移公式。通过在柱坐标系下考虑一个特定但物理上相关的电场和磁场构型，你将计算引导中心在两点之间移动所需的时间。这项练习旨在巩固计算漂移速度并对其进行积分以确定粒子轨迹的基本方法，这是分析单粒子运动的核心技能。[@problem_id:248592]", "problem": "一个质量为 $m$、电荷为 $q$ 的带电粒子在同时存在电场和磁场的空间区域中运动。磁场是均匀且静态的，沿 z 轴方向，在柱坐标系 $(\\rho, \\phi, z)$ 中表示为 $\\vec{B} = B_0 \\hat{z}$。电场是静态的、纯方位角的，其大小与离 z 轴的径向距离成反比，表示为 $\\vec{E} = \\frac{K}{\\rho}\\hat{\\phi}$。此处，$B_0 > 0$ 和 $K > 0$ 是正常数。这种形式的电场在任何不包围 z 轴的区域都是物理上可以实现的。\n\n在导心近似下，粒子导心的主要运动是 $\\vec{E} \\times \\vec{B}$ 漂移，由速度矢量 $\\vec{v}_E = \\frac{\\vec{E} \\times \\vec{B}}{B^2}$ 描述。假设所有其他漂移（例如梯度漂移、曲率漂移和极化漂移）都可以忽略不计。\n\n推导粒子导心从初始径向位置 $\\rho_1$ 漂移到最终径向位置 $\\rho_2$ 所需时间 $T$ 的符号表达式，其中 $\\rho_2 > \\rho_1 > 0$。", "solution": "1. $\\vec{E} \\times \\vec{B}$ 漂移速度由下式给出\n$$\n\\vec{v}_E = \\frac{\\vec{E} \\times \\vec{B}}{B^2} \\,. \n$$\n2. 已知 $\\vec{E} = \\frac{K}{\\rho}\\hat{\\phi}$ 和 $\\vec{B} = B_0\\hat{z}$，计算\n$$\n\\vec{E} \\times \\vec{B}\n= \\frac{K}{\\rho}\\hat{\\phi} \\times B_0\\hat{z}\n= \\frac{K B_0}{\\rho}\\hat{\\rho}\n\\quad\\Longrightarrow\\quad\n\\vec{v}_E = \\frac{K}{B_0 \\rho}\\hat{\\rho}.\n$$\n3. 导心以速度 $v_\\rho = d\\rho/dt = K/(B_0\\rho)$ 径向向外漂移。分离变量：\n$$\n\\rho \\, d\\rho = \\frac{K}{B_0} \\, dt.\n$$\n4. 在时间 $0$ 到 $T$ 上，对 $\\rho$ 从 $\\rho_1$ 积分到 $\\rho_2$：\n$$\n\\int_{\\rho_1}^{\\rho_2} \\rho \\, d\\rho\n= \\frac{K}{B_0} \\int_0^T dt\n\\quad\\Longrightarrow\\quad\n\\frac{1}{2}(\\rho_2^2 - \\rho_1^2) = \\frac{K}{B_0} T.\n$$\n5. 求解 $T$：\n$$\nT = \\frac{B_0}{2K}(\\rho_2^2 - \\rho_1^2).\n$$", "answer": "$$\\boxed{\\frac{B_0}{2K}(\\rho_2^2-\\rho_1^2)}$$", "id": "248592"}, {"introduction": "这个练习将超越单个粒子的路径，引导你将 $\\vec{E} \\times \\vec{B}$ 漂移作为一个集体性的流体来分析。你将探索涡度这一流体运动的关键属性，并将其应用于由高斯势结构产生的漂移速度场。这项练习将微观的粒子漂移与等离子体的宏观流体行为联系起来，展示了势场结构如何引起旋转流动。[@problem_id:248773]", "problem": "考虑一个低密度、无碰撞的等离子体，置于一个均匀的静态磁场 $\\vec{B} = B_0 \\hat{z}$ 中。在垂直于 $\\vec{B}$ 的平面上，粒子引导中心的运动主要由 $\\vec{E} \\times \\vec{B}$ 漂移主导，其速度场由 $\\vec{v}_E = \\frac{\\vec{E} \\times \\vec{B}}{B^2}$ 描述。电场 $\\vec{E}$ 是静电场，由标量势 $\\phi$ 导出，满足 $\\vec{E} = -\\nabla\\phi$。\n\n该静电势在 $xy$ 平面上具有二维高斯分布，且呈径向对称。在极坐标 $(r, \\theta)$ 中，其表达式为：\n$$\n\\phi(r) = \\phi_0 \\exp\\left(-\\frac{r^2}{a^2}\\right)\n$$\n其中 $\\phi_0$ 是原点处的势振幅，$a$ 是势结构的特征长度尺度。\n\n与 $\\vec{E} \\times \\vec{B}$ 漂移相关的类流体流动具有涡度，定义为速度场的旋度，即 $\\vec{\\Omega}_E = \\nabla \\times \\vec{v}_E$。\n\n推导该涡度穿过一个位于 $xy$ 平面上、以原点为中心、半径为 $R$ 的圆盘的总通量 $\\mathcal{F}$ 的闭式解析表达式。该圆盘的表面法线方向指向正 $\\hat{z}$ 方向。", "solution": "1. $xy$ 平面内的 $\\vec{E} \\times \\vec{B}$ 漂移速度为 \n$$\\vec{v}_E = \\frac{\\vec{E} \\times \\vec{B}}{B_0^2}\n= \\frac{1}{B_0}(-\\partial_y \\phi, \\partial_x \\phi, 0)。$$\n2. 涡度的 $z$ 分量为\n$$\\Omega_{E,z}\n= \\partial_x v_{E,y} - \\partial_y v_{E,x}\n= \\frac{1}{B_0}(\\partial_x^2 \\phi + \\partial_y^2 \\phi)\n= \\frac{1}{B_0}\\nabla^2_\\perp \\phi。$$\n3. 在极坐标中，$\\nabla^2_\\perp \\phi = (1/r)\\partial_r(r\\partial_r\\phi)$。因此，穿过半径为 $R$ 的圆盘的通量为\n$$\\mathcal{F} = \\iint_{r \\le R} \\Omega_{E,z} \\, dS\n= \\frac{1}{B_0} \\iint_{r \\le R} \\nabla^2_\\perp \\phi \\, dS。$$\n4. 转换为极坐标并进行分部积分：\n$$\\iint_{r \\le R} \\nabla^2_\\perp \\phi \\, dS\n= 2\\pi \\int_0^R \\frac{1}{r}\\partial_r(r\\partial_r\\phi) \\, r \\, dr\n= 2\\pi \\left[r\\partial_r\\phi\\right]_0^R。$$\n5. 对于 $\\phi(r) = \\phi_0 \\exp(-r^2/a^2)$，我们有 \n$$\\partial_r \\phi = -\\frac{2r}{a^2}\\phi_0 e^{-r^2/a^2}, \\quad\nr \\partial_r \\phi \\Big|_{r=R}\n= -\\frac{2R^2}{a^2}\\phi_0 e^{-R^2/a^2}。$$\n6. 因此\n$$\\mathcal{F}\n= \\frac{2\\pi}{B_0}\\left(-\\frac{2R^2}{a^2}\\phi_0 e^{-R^2/a^2}\\right)\n= -\\frac{4\\pi \\phi_0 R^2}{a^2 B_0} \\exp\\left(-\\frac{R^2}{a^2}\\right)。$$", "answer": "$$\\boxed{-\\frac{4\\pi \\phi_0 R^2}{a^2 B_0}\\exp\\left(-\\frac{R^2}{a^2}\\right)}$$", "id": "248773"}, {"introduction": "最后的这项实践旨在弥合抽象的引导中心近似与带电粒子完整动力学之间的鸿沟。从基本的洛伦兹力定律出发，你将通过编写数值模拟程序来追踪粒子的完整轨迹，该轨迹包含了快速的回旋运动和较慢的漂移运动。通过计算方法滤除回旋运动，你将能够提取出漂移速度并将其与理论预测进行比较，从而更深刻地理解像 $\\vec{E} \\times \\vec{B}$ 漂移这样的简化模型是如何从复杂的底层物理学中产生的。[@problem_id:2390224]", "problem": "一个电荷为 $q$、质量为 $m$ 的非相对论性点粒子在均匀且相互垂直的电场和磁场中运动。设粒子的位置为 $\\mathbf{r}(t)$（单位为米），其速度为 $\\mathbf{v}(t)$（单位为米/秒）。基本依据是牛顿第二定律和洛伦兹力定律：总力为 $\\mathbf{F} = q\\left(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}\\right)$，因此运动方程是耦合常微分方程组 (ODEs)：$\\dfrac{d\\mathbf{r}}{dt} = \\mathbf{v}$ 和 $m\\dfrac{d\\mathbf{v}}{dt} = q\\left(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}\\right)$。假设所有场在空间和时间上都是恒定的，并以国际单位制 (SI) 给出。\n\n您的任务是实现并使用欧拉方法求解常微分方程，以数值方式证明 $\\mathbf{E}\\times\\mathbf{B}$ 漂移的存在。具体要求如下：\n\n1. 仅从牛顿第二定律和洛伦兹力（上述基本依据）出发，推导当一个恒定的垂直电场 $\\mathbf{E}$ 和磁场 $\\mathbf{B}$ 作用于粒子时，所产生的连续时间漂移速度的形式。解释为何此漂移独立于 $q$ 和 $m$。\n2. 为上述常微分方程系统推导前向欧拉方法和一种半隐式欧拉变体（先更新速度，然后使用更新后的速度更新位置）。您必须明确陈述您将要实现的更新规则。\n3. 为了在有限时间内稳健地进行数值漂移提取，而无需等待多次回旋，请使用导心位置来滤除回旋运动并分离出漂移。定义导心坐标\n   $$\\mathbf{R}(t) = \\mathbf{r}(t) - \\frac{m}{q\\|\\mathbf{B}\\|^2}\\,\\mathbf{v}(t) \\times \\mathbf{B},$$\n   并将漂移速度估计为有限时间差商\n   $$\\widehat{\\mathbf{v}}_{\\text{drift}} = \\frac{\\mathbf{R}(T) - \\mathbf{R}(0)}{T}.$$\n   解释这如何从连续时间动力学中得出，以及为什么它能消除快速的回旋运动。\n4. 实现这两种方法，并为下面的每个测试用例，计算您的数值估计漂移速度 $\\widehat{\\mathbf{v}}_{\\text{drift}}$ 与您在第1部分中从连续方程解析推导出的漂移速度之间的差值的欧几里得范数（单位为米/秒）。对于每个测试用例，报告两个浮点数：使用前向欧拉方法的误差，后跟使用半隐式欧拉变体的误差。\n\n物理和数值单位：$\\mathbf{E}$ 的所有矢量分量单位为伏特/米，$\\mathbf{B}$ 的单位为特斯拉，时间单位为秒，$\\mathbf{r}$ 的单位为米，$\\mathbf{v}$ 的单位为米/秒，电荷 $q$ 的单位为库仑，质量 $m$ 的单位为千克。请将所有要求的误差大小以米/秒为单位表示为浮点数。\n\n测试套件和初始条件：\n- 对所有情况，使用初始位置 $\\mathbf{r}(0) = (0,0,0)$ 米。\n- 使用以下四组参数集，涵盖一般情况、边界情况、磁场极小的边缘情况以及电荷符号反转的情况：\n  1. 情况A（理想路径）：$q = 1.0\\times 10^{-15}$，$m = 1.0\\times 10^{-12}$，$\\mathbf{E} = (2.0,0.0,0.0)$，$\\mathbf{B} = (0.0,0.0,0.5)$，$T = 10.0$，$\\Delta t = 0.05$，以及 $\\mathbf{v}(0) = (0.0,0.0,0.0)$。\n  2. 情况B（边界，无电场）：$q = 1.0\\times 10^{-15}$，$m = 1.0\\times 10^{-12}$，$\\mathbf{E} = (0.0,0.0,0.0)$，$\\mathbf{B} = (0.0,0.0,0.5)$，$T = 1.0$，$\\Delta t = 0.1$，以及 $\\mathbf{v}(0) = (0.0,0.0,0.0)$。\n  3. 情况C（边缘，磁场极小）：$q = 1.0\\times 10^{-15}$，$m = 1.0\\times 10^{-12}$，$\\mathbf{E} = (0.01,0.0,0.0)$，$\\mathbf{B} = (0.0,0.0,1.0\\times 10^{-4})$，$T = 50.0$，$\\Delta t = 0.5$，以及 $\\mathbf{v}(0) = (0.0,0.0,0.0)$。\n  4. 情况D（电荷符号反转）：$q = -1.0\\times 10^{-15}$，$m = 1.0\\times 10^{-12}$，$\\mathbf{E} = (2.0,0.0,0.0)$，$\\mathbf{B} = (0.0,0.0,0.5)$，$T = 10.0$，$\\Delta t = 0.05$，以及 $\\mathbf{v}(0) = (0.0,0.0,0.0)$。\n\n最终输出格式：\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。\n- 该列表必须按顺序为每个情况包含两个浮点数：首先是前向欧拉误差（单位：米/秒），然后是半隐式欧拉误差（单位：米/秒）。对于这四个情况，输出总共必须是 $8$ 个数字，顺序为 $\\left[\\text{A-FE},\\text{A-SE},\\text{B-FE},\\text{B-SE},\\text{C-FE},\\text{C-SE},\\text{D-FE},\\text{D-SE}\\right]$。", "solution": "所提出的问题是有效的。它基于经典电动力学的基本原理，即洛伦兹力定律和牛顿第二定律，并且它提出了一个计算物理学中定义明确的初值问题。所有必要的参数和条件都已提供，并且没有科学或逻辑上的矛盾。我们将进行严谨的求解。\n\n带电粒子在正交电磁场中的运动是一个典型问题。其轨迹是平行于磁场的匀速运动、垂直于磁场平面内的圆周回旋运动，以及此回旋中心的稳定漂移（该漂移也垂直于磁场）的叠加。我们的目标是首先解析地推导出该漂移速度，然后使用欧拉方法的两种变体在数值上证明其存在。\n\n**1. 漂移速度的解析推导**\n\n电荷为 $q$、质量为 $m$ 的粒子的运动方程由牛顿第二定律和洛伦兹力组合给出：\n$$m\\frac{d\\mathbf{v}}{dt} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})$$\n我们寻求速度 $\\mathbf{v}$ 的解。让我们将速度分解为平行于磁场 $\\mathbf{B}$ 和垂直于磁场 $\\mathbf{B}$ 的分量：$\\mathbf{v} = \\mathbf{v}_{\\|} + \\mathbf{v}_{\\perp}$。电场也同样分解为 $\\mathbf{E} = \\mathbf{E}_{\\|} + \\mathbf{E}_{\\perp}$。运动方程分为两部分：\n$$m\\frac{d\\mathbf{v}_{\\|}}{dt} = q\\mathbf{E}_{\\|}$$\n$$m\\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{E}_{\\perp} + \\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\n问题陈述了场是相互垂直的，所以 $\\mathbf{E} \\cdot \\mathbf{B} = 0$，这意味着 $\\mathbf{E}_{\\|} = 0$。因此，$\\frac{d\\mathbf{v}_{\\|}}{dt} = 0$，平行于 $\\mathbf{B}$ 的速度分量是恒定的。\n\n垂直运动更为复杂。我们假设垂直速度 $\\mathbf{v}_{\\perp}$ 可以表示为一个恒定的漂移速度 $\\mathbf{v}_D$ 和一个时变的回旋速度 $\\mathbf{u}(t)$ 的和：$\\mathbf{v}_{\\perp} = \\mathbf{v}_D + \\mathbf{u}(t)$。漂移速度代表一个稳态解，其中垂直平面内的合力平均为零。可以存在一个特定的恒定速度 $\\mathbf{v}_D$，使得电场力和磁场力完全平衡。我们通过将垂直加速度设为零并将 $\\mathbf{v}_{\\perp}$ 替换为 $\\mathbf{v}_D$ 来找到这个速度：\n$$0 = q(\\mathbf{E}_{\\perp} + \\mathbf{v}_D \\times \\mathbf{B})$$\n$$\\mathbf{E}_{\\perp} = -(\\mathbf{v}_D \\times \\mathbf{B})$$\n为求解 $\\mathbf{v}_D$，我们用 $\\mathbf{B}$ 对该方程做叉积：\n$$\\mathbf{E}_{\\perp} \\times \\mathbf{B} = -(\\mathbf{v}_D \\times \\mathbf{B}) \\times \\mathbf{B}$$\n使用矢量三重积恒等式 $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A} \\cdot \\mathbf{C}) - \\mathbf{C}(\\mathbf{A} \\cdot \\mathbf{B})$，我们得到：\n$$\\mathbf{E}_{\\perp} \\times \\mathbf{B} = -[\\mathbf{B}(\\mathbf{v}_D \\cdot \\mathbf{B}) - \\mathbf{v}_D(\\mathbf{B} \\cdot \\mathbf{B})]$$\n漂移速度 $\\mathbf{v}_D$ 是对垂直力的响应，因此它必须垂直于 $\\mathbf{B}$，即 $\\mathbf{v}_D \\cdot \\mathbf{B} = 0$。该方程简化为：\n$$\\mathbf{E}_{\\perp} \\times \\mathbf{B} = -[-\\mathbf{v}_D(\\mathbf{B} \\cdot \\mathbf{B})] = \\mathbf{v}_D \\|\\mathbf{B}\\|^2$$\n由于 $\\mathbf{E}_{\\perp} = \\mathbf{E}$，我们得到了 $\\mathbf{E} \\times \\mathbf{B}$ 漂移速度的表达式：\n$$\\mathbf{v}_D = \\frac{\\mathbf{E} \\times \\mathbf{B}}{\\|\\mathbf{B}\\|^2}$$\n此推导表明，漂移速度 $\\mathbf{v}_D$ 仅取决于电场 $\\mathbf{E}$ 和磁场 $\\mathbf{B}$。它从根本上独立于粒子的电荷 $q$ 和质量 $m$。电荷和质量的大小仅影响叠加的回旋运动的特性（其频率和半径），而不影响导心漂移的速度。电荷 $q$ 的符号会反转回旋方向，但漂移方向保持不变。\n\n**2. 数值积分方案的推导**\n\n待求解的方程组是一组耦合的一阶常微分方程 (ODEs)：\n$$ \\frac{d\\mathbf{r}}{dt} = \\mathbf{v} $$\n$$ \\frac{d\\mathbf{v}}{dt} = \\frac{q}{m}(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) = \\mathbf{a}(\\mathbf{v}) $$\n我们用恒定的步长 $\\Delta t$ 将时间离散化，使得 $t_n = n\\Delta t$。系统在时间 $t_n$ 的状态是 $(\\mathbf{r}_n, \\mathbf{v}_n)$。\n\n**前向欧拉 (FE)** 方法是一种显式一阶方法。它使用在第 $n$ 步计算的导数来近似第 $n+1$ 步的状态：\n$$ \\mathbf{v}_{n+1} = \\mathbf{v}_n + \\Delta t \\cdot \\mathbf{a}(\\mathbf{v}_n) = \\mathbf{v}_n + \\Delta t \\frac{q}{m}(\\mathbf{E} + \\mathbf{v}_n \\times \\mathbf{B}) $$\n$$ \\mathbf{r}_{n+1} = \\mathbf{r}_n + \\Delta t \\cdot \\mathbf{v}_n $$\n该方法简单，但以其较差的稳定性而闻名，特别是对于振荡系统，它会人为地增加系统能量。\n\n**半隐式欧拉 (SE)** 方法，也称为 Euler-Cromer 方法，是一种提高稳定性的变体。按照规定，我们首先更新速度，然后使用这个新计算出的速度来更新位置。这引入了一个隐式元素，显著改善了哈密顿系统的能量守恒。更新规则如下：\n$$ \\mathbf{v}_{n+1} = \\mathbf{v}_n + \\Delta t \\cdot \\mathbf{a}(\\mathbf{v}_n) = \\mathbf{v}_n + \\Delta t \\frac{q}{m}(\\mathbf{E} + \\mathbf{v}_n \\times \\mathbf{B}) $$\n$$ \\mathbf{r}_{n+1} = \\mathbf{r}_n + \\Delta t \\cdot \\mathbf{v}_{n+1} $$\n与前向欧拉方法相比，这种辛积分器有望为回旋粒子产生更准确的长期轨迹。\n\n**3. 用于漂移估计的导心位置**\n\n完整的粒子轨迹 $\\mathbf{r}(t)$ 是一条复杂的摆线路径，由快速的回旋运动叠加在较慢的导心漂移上形成。为了数值提取漂移速度，我们必须滤除振荡的回旋运动。导心位置 $\\mathbf{R}(t)$ 代表粒子圆周回旋的中心。在问题中定义为：\n$$\\mathbf{R}(t) = \\mathbf{r}(t) - \\frac{m}{q\\|\\mathbf{B}\\|^2}\\mathbf{v}(t) \\times \\mathbf{B}$$\n第二项 $\\boldsymbol{\\rho}_{est}(t) = \\frac{m}{q\\|\\mathbf{B}\\|^2}\\mathbf{v}(t) \\times \\mathbf{B}$ 是回旋半径矢量的近似值，该矢量是从导心指向粒子位置的矢量。通过从粒子的瞬时位置 $\\mathbf{r}(t)$ 中减去这一项，我们得到了导心位置的估计值。这种减法有效地从位置数据中移除了振荡运动的最大分量。\n\n这个估计的导心的瞬时速度 $\\frac{d\\mathbf{R}}{dt}$ 并非完全恒定。它包含真实的导心速度（在我们的情况下是 $\\mathbf{v}_D$，因为 $\\mathbf{v}_{\\|}(0)=0$）以及一个以回旋频率振荡的残余项。为了消除这种残余振荡，我们在总模拟时间 $T$ 内对导心速度进行平均。这通过计算有限差分商来完成：\n$$\\widehat{\\mathbf{v}}_{\\text{drift}} = \\frac{\\mathbf{R}(T) - \\mathbf{R}(0)}{T}$$\n这个计算等效于 $\\frac{1}{T}\\int_0^T \\frac{d\\mathbf{R}}{dt'} dt'$。当时间 $T$ 远大于回旋周期时，振荡部分的积分与恒定漂移的积分相比变得可以忽略不计，从而得到一个数值上稳健的平均漂移速度估计。对于给定的初始条件 $\\mathbf{r}(0) = \\mathbf{0}$ 和 $\\mathbf{v}(0) = \\mathbf{0}$，初始导心位置为 $\\mathbf{R}(0) = \\mathbf{0}$，从而将估计简化为 $\\widehat{\\mathbf{v}}_{\\text{drift}} = \\mathbf{R}(T)/T$。\n\n**4. 计算步骤**\n\n对于每个测试用例，我们执行以下步骤：\n1.  计算解析漂移速度 $\\mathbf{v}_D = \\frac{\\mathbf{E} \\times \\mathbf{B}}{\\|\\mathbf{B}\\|^2}$。\n2.  使用前向欧拉方法运行从 $t=0$ 到 $t=T$ 的模拟，以找到最终状态 $(\\mathbf{r}_{FE}(T), \\mathbf{v}_{FE}(T))$。\n3.  计算最终导心位置 $\\mathbf{R}_{FE}(T)$ 和数值漂移 $\\widehat{\\mathbf{v}}_{\\text{drift, FE}} = (\\mathbf{R}_{FE}(T) - \\mathbf{R}(0))/T$。\n4.  计算前向欧拉方法的误差，即欧几里得范数 $E_{FE} = \\|\\widehat{\\mathbf{v}}_{\\text{drift, FE}} - \\mathbf{v}_D\\|$。\n5.  使用半隐式欧拉方法重复步骤2-4，以找到 $(\\mathbf{r}_{SE}(T), \\mathbf{v}_{SE}(T))$、$\\widehat{\\mathbf{v}}_{\\text{drift, SE}}$ 和相应的误差 $E_{SE} = \\|\\widehat{\\mathbf{v}}_{\\text{drift, SE}} - \\mathbf{v}_D\\|$。\n6.  计算出的误差对 $(E_{FE}, E_{SE})$ 构成了该测试用例的结果。对所有指定的情况重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the error in numerically estimated E x B drift velocity\n    using Forward Euler and Semi-Implicit Euler methods.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {\n            \"q\": 1.0e-15, \"m\": 1.0e-12, \"E\": np.array([2.0, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 0.5]), \"T\": 10.0, \"dt\": 0.05,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        },\n        # Case B (boundary, no electric field)\n        {\n            \"q\": 1.0e-15, \"m\": 1.0e-12, \"E\": np.array([0.0, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 0.5]), \"T\": 1.0, \"dt\": 0.1,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        },\n        # Case C (edge, very small magnetic field)\n        {\n            \"q\": 1.0e-15, \"m\": 1.0e-12, \"E\": np.array([0.01, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 1.0e-4]), \"T\": 50.0, \"dt\": 0.5,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        },\n        # Case D (sign reversal of charge)\n        {\n            \"q\": -1.0e-15, \"m\": 1.0e-12, \"E\": np.array([2.0, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 0.5]), \"T\": 10.0, \"dt\": 0.05,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        q, m, E, B = case[\"q\"], case[\"m\"], case[\"E\"], case[\"B\"]\n        T, dt, v0, r0 = case[\"T\"], case[\"dt\"], case[\"v0\"], case[\"r0\"]\n\n        B_norm_sq = np.dot(B, B)\n\n        # Calculate analytical drift velocity\n        if B_norm_sq  0:\n            v_drift_analytical = np.cross(E, B) / B_norm_sq\n        else:\n            v_drift_analytical = np.array([0.0, 0.0, 0.0])\n            \n        num_steps = int(round(T / dt))\n\n        # --- Forward Euler Method ---\n        r = np.copy(r0)\n        v = np.copy(v0)\n        \n        for _ in range(num_steps):\n            a = (q / m) * (E + np.cross(v, B))\n            r_next = r + v * dt\n            v_next = v + a * dt\n            r, v = r_next, v_next\n        \n        r_final_fe, v_final_fe = r, v\n        \n        # --- Semi-Implicit Euler Method ---\n        r = np.copy(r0)\n        v = np.copy(v0)\n        \n        for _ in range(num_steps):\n            a = (q / m) * (E + np.cross(v, B))\n            v_next = v + a * dt\n            r_next = r + v_next * dt\n            r, v = r_next, v_next\n            \n        r_final_se, v_final_se = r, v\n\n        # --- Calculate errors ---\n        # Guiding center position R_0 at t=0 is r0 since v0 is zero\n        R0 = r0\n        \n        # Error for Forward Euler\n        if B_norm_sq  0:\n            R_T_fe = r_final_fe - (m / (q * B_norm_sq)) * np.cross(v_final_fe, B)\n        else: # Handle B=0 case, though not in test suite\n            R_T_fe = r_final_fe\n            \n        v_drift_fe_numerical = (R_T_fe - R0) / T\n        error_fe = np.linalg.norm(v_drift_fe_numerical - v_drift_analytical)\n        results.append(error_fe)\n\n        # Error for Semi-Implicit Euler\n        if B_norm_sq  0:\n            R_T_se = r_final_se - (m / (q * B_norm_sq)) * np.cross(v_final_se, B)\n        else: # Handle B=0 case\n            R_T_se = r_final_se\n\n        v_drift_se_numerical = (R_T_se - R0) / T\n        error_se = np.linalg.norm(v_drift_se_numerical - v_drift_analytical)\n        results.append(error_se)\n\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```", "id": "2390224"}]}