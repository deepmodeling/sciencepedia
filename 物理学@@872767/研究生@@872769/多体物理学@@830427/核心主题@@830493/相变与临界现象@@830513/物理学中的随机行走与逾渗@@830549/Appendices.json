{"hands_on_practices": [{"introduction": "了解随机行走者在有限空间中的最终命运是一个基本问题。这个练习，通常被称为“赌徒破产”问题，提供了一种直接而优雅的方法来计算行走者在到达另一个边界之前先到达某个特定边界的概率。这是一个求解随机过程研究中随处可见的差分方程的基础实践。[@problem_id:1188067]", "problem": "考虑在整数格 $\\mathbb{Z}$ 上的一个一维对称随机游走。一个粒子初始位于位置 $n$，其中 $n$ 是一个正整数。位置 $0$ 和 $N$（其中 $N$ 是一个大于 $n$ 的整数）是吸收壁。\n\n在每个离散时间步，位于位置 $i$ 的粒子移动到其最近的邻居之一，即位置 $i+1$ 或 $i-1$。这个游走是对称的，意味着向右移动的概率等于向左移动的概率，每个方向的概率都为 $1/2$。\n\n一旦粒子到达位置 $0$ 或 $N$，过程就停止。你的任务是计算粒子在被位置 $0$ 吸收之前，先被位置 $N$ 吸收的概率。这通常被称为吸收概率或退出概率。\n\n求此概率，其是关于粒子初始位置 $n$ 和吸收壁位置 $N$ 的函数。", "solution": "令 $P_i$ 表示从整数位置 $i$（其中 $0 \\le i \\le N$）出发的粒子在到达位置 $0$ 之前先到达位置 $N$ 的概率。我们需要求解 $P_n$。\n\n该问题由一组边界条件和位于边界之间的位置 $i$ 的概率 $P_i$ 的递推关系所定义。\n\n1.  **边界条件：**\n    位置 $0$ 和 $N$ 是吸收壁。\n    -   如果粒子从 $i=N$ 出发，它已经到达了 $N$，因此首先到达 $N$ 的概率是 1。于是，我们有边界条件：\n        $$ P_N = 1 $$\n    -   如果粒子从 $i=0$ 出发，它已经到达了 $0$，因此首先到达 $N$ 的概率是 0。于是，我们有另一个边界条件：\n        $$ P_0 = 0 $$\n\n2.  **递推关系：**\n    对于任何满足 $0  i  N$ 的位置 $i$，我们可以根据第一步的结果，使用全概率公式写出 $P_i$ 的关系式：\n    -   粒子以 $1/2$ 的概率移动到位置 $i+1$。从 $i+1$ 出发，首先到达 $N$ 的概率是 $P_{i+1}$。\n    -   粒子以 $1/2$ 的概率移动到位置 $i-1$。从 $i-1$ 出发，首先到达 $N$ 的概率是 $P_{i-1}$。\n\n    因此，$P_i$ 可由下式给出：\n    $$ P_i = \\frac{1}{2} P_{i+1} + \\frac{1}{2} P_{i-1} $$\n    这个方程表明，位置 $i$ 的概率是其相邻位置概率的平均值。它定义了一个线性递推关系（或差分方程）。整理该方程，我们得到：\n    $$ P_{i+1} - 2P_i + P_{i-1} = 0 $$\n\n3.  **求解差分方程：**\n    这是一个二阶线性齐次常系数差分方程。我们假设解的形式为 $P_i = r^i$，代入方程得到特征方程：\n    $$ r^{i+1} - 2r^i + r^{i-1} = 0 $$\n    假设 $r \\neq 0$，两边同除以 $r^{i-1}$：\n    $$ r^2 - 2r + 1 = 0 $$\n    该方程可因式分解为 $(r-1)^2 = 0$，表明有一个重根 $r_1 = r_2 = 1$。\n\n4.  **通解：**\n    对于有重根 $r$ 的线性差分方程，两个线性无关的解是 $r^i$ 和 $i \\cdot r^i$。在我们的情况中，由于 $r=1$，$P_i$ 的通解是这两个解的线性组合：\n    $$ P_i = A \\cdot (1)^i + B \\cdot i \\cdot (1)^i = A + Bi $$\n    其中 $A$ 和 $B$ 是待定常数。\n\n5.  **应用边界条件：**\n    我们使用边界条件 $P_0 = 0$ 和 $P_N = 1$ 来求解 $A$ 和 $B$。\n    -   由 $P_0 = 0$ 可得：\n        $$ P_0 = A + B(0) = 0 \\implies A = 0 $$\n    -   将 $A=0$ 代入通解得到 $P_i = Bi$。现在使用第二个边界条件 $P_N = 1$：\n        $$ P_N = B \\cdot N = 1 \\implies B = \\frac{1}{N} $$\n\n6.  **最终表达式：**\n    将 $A=0$ 和 $B=1/N$ 代回，得到特解：\n    $$ P_i = \\frac{i}{N} $$\n    问题要求的是从位置 $n$ 出发的概率，即 $P_n$。因此：\n    $$ P_n = \\frac{n}{N} $$", "answer": "$$ \\boxed{\\frac{n}{N}} $$", "id": "1188067"}, {"introduction": "超越简单的一维晶格，我们来探讨随机行走在无限树状结构——贝特晶格（Bethe lattice）上的行为如何变化。这个问题探讨了遍历性行走（总能返回原点）与瞬态行走（可能逃逸到无穷远）之间的根本区别。通过引入一个偏置，我们可以驱动系统在这两种状态之间发生相变，这在一个随机行走问题中展示了临界现象的核心概念。[@problem_id:1188095]", "problem": "考虑一个在配位数为 $z \\ge 2$ 的无限 Bethe 晶格（或 Cayley 树）上的有偏随机游走。一个粒子从晶格的原点（根）开始。游走的动力学由一个偏置参数 $\\epsilon$ 定义。\n\n晶格结构由距原点图距离为 $n$ 的顶点“壳层”组成。对于距离为 $n  0$ 的顶点上的粒子，在壳层 $n-1$（更靠近原点）有一个邻居，在壳层 $n+1$（更远离原点）有 $z-1$ 个邻居。\n\n在每个离散时间步的跳跃概率定义如下：\n- 从距离为 $n0$ 的任意顶点，移动到壳层 $n-1$ 中唯一邻居的概率是 $p_{in} = \\frac{1+(z-1)\\epsilon}{z}$。\n- 从距离为 $n0$ 的任意顶点，移动到壳层 $n+1$ 中 $z-1$ 个邻居中任意一个的概率是 $p_{out} = \\frac{1-\\epsilon}{z}$。\n- 从原点（$n=0$），粒子以相等的概率 $1/z$ 移动到其 $z$ 个邻居（在壳层 $n=1$ 中）中的任意一个。\n\n偏置参数 $\\epsilon$ 可以是正数或负数，其范围需保持概率为非负。\n\n如果粒子最终返回其起始点（原点）的概率恰好为 1，则随机游走被定义为**常返的**。如果此概率小于 1，则游走是**暂留的**，这意味着有非零的概率逃逸到无穷远处。\n\n存在一个临界偏置值 $\\epsilon_c$，它分开了这两种行为模式。对于 $\\epsilon  \\epsilon_c$，游走是常返的（具有朝向原点的漂移），而对于 $\\epsilon  \\epsilon_c$，游走是暂留的（具有远离原点的漂移）。\n\n确定临界偏置 $\\epsilon_c$ 作为配位数 $z$ 的函数。", "solution": "为了确定随机游走是常返的还是暂留的，我们计算从原点出发的粒子永不返回的“逃逸”概率。如果此概率为零，则游走是常返的；如果为正，则是暂留的。这一性质由从紧邻原点的壳层1出发的粒子能否返回原点决定。\n\n我们定义 $f$ 为从任意一个顶点出发，最终能到达其唯一“父”节点（更靠近原点的邻居）的概率。由于Bethe晶格的自相似性，这个概率 $f$ 不依赖于顶点在树上的具体位置（只要它不在原点）。\n\n现在，考虑一个位于壳层 $n > 0$ 的粒子。它要想到达其位于壳层 $n-1$ 的父节点，可以通过以下方式：\n1.  在下一步直接向内移动。此事件的概率是 $p_{\\text{in}}$。\n2.  在下一步向外移动到其 $z-1$ 个“子”节点中的一个（位于壳层 $n+1$）。对于其中每一个子节点，粒子必须最终从该子节点返回到原点。从子节点（壳层 $n+1$）到达“祖父”节点（壳层 $n-1$）的总概率是 $f^2$。这是因为粒子必须先从壳层 $n+1$ 返回到壳层 $n$（概率为 $f$），然后再从壳层 $n$ 返回到壳层 $n-1$（概率也为 $f$）。\n\n将所有可能性加起来，我们得到 $f$ 的自洽方程：\n$$ f = p_{\\text{in}} + (z-1) p_{\\text{out}} f^2 $$\n代入 $p_{\\text{in}}$ 和 $p_{\\text{out}}$ 的表达式：\n$$ f = \\frac{1 + (z-1)\\epsilon}{z} + (z-1) \\frac{1 - \\epsilon}{z} f^2 $$\n整理成关于 $f$ 的二次方程：\n$$ (z-1)(1 - \\epsilon) f^2 - z f + (1 + (z-1)\\epsilon) = 0 $$\n这个方程总有一个根是 $f=1$（可以通过代入验证）。另一个根是 $r$，根据韦达定理（根之积 $1 \\cdot r = c/a$）：\n$$ r = \\frac{1 + (z-1)\\epsilon}{(z-1)(1 - \\epsilon)} $$\n物理上的返回概率 $f$ 必须是 $[0, 1]$ 区间内的最小非负根。\n-   如果 $r \\ge 1$，那么最小的非负根就是 $f=1$。这意味着返回概率为1，游走是**常返的**。\n-   如果 $r  1$，那么最小的非负根就是 $f=r  1$。这意味着返回概率小于1，游走是**暂留的**。\n\n临界点 $\\epsilon_c$ 发生在两种行为模式的边界处，即 $r=1$ 时。\n$$ \\frac{1 + (z-1)\\epsilon_c}{(z-1)(1 - \\epsilon_c)} = 1 $$\n解出 $\\epsilon_c$：\n$$ 1 + (z-1)\\epsilon_c = (z-1)(1 - \\epsilon_c) $$\n$$ 1 + (z-1)\\epsilon_c = z - 1 - (z-1)\\epsilon_c $$\n$$ 2(z-1)\\epsilon_c = z - 2 $$\n$$ \\epsilon_c = \\frac{z-2}{2(z-1)} $$\n这就是临界偏置值。对于 $\\epsilon  \\epsilon_c$, 游走常返；对于 $\\epsilon  \\epsilon_c$, 游走暂留。", "answer": "$$ \\boxed{\\dfrac{z-2}{2(z-1)}} $$", "id": "1188095"}, {"introduction": "将随机行走的概念与紧密相关的逾渗理论联系起来。这个练习使用与前一个问题相同的贝特晶格结构来分析逾渗模型中的集团特性。通过使用生成函数这一强大的技术，你将计算出有限集团的平均尺寸——一个类似于磁性系统中磁化率的物理量，它在逾渗阈值 $p_c$ 处会发散。[@problem_id:1188069]", "problem": "考虑在一个配位数为 $z$ 的无限贝特晶格（也称为凯莱树）上的位点逾渗。在这个晶格上，每个位点以概率 $p$ 被独立占据，以概率 $1-p$ 为空。一个簇被定义为一组相连的被占据位点，其中如果两个位点是晶格上的最近邻，则它们是相连的。\n\n对于一定的 $p$ 值范围，所有簇的大小都是有限的。这被称为亚临界相或非逾渗相，发生在 $p  p_c$ 的情况下，其中 $p_c$ 是临界逾渗阈值。在此相中，可以研究这些有限簇的统计特性。\n\n任务是计算一个随机选择的*被占据*位点所属的簇的平均大小。令此量表示为 $\\langle s \\rangle$。这个量也被称为逾渗磁化率。\n\n使用生成函数方法，确定在亚临界相（$p  p_c$）中，$\\langle s \\rangle$ 作为占据概率 $p$ 和配位数 $z$ 的函数的表达式。", "solution": "为了计算在贝特晶格（配位数为 $z$）上位点逾渗的亚临界相（$p  p_c$）中，一个随机选择的*被占据*位点所属簇的平均大小 $\\langle s \\rangle$，我们使用生成函数方法。\n\n首先，定义一个辅助生成函数 $T(x)$。它代表从一个中心位点的某个特定邻居出发，向外延伸的“分支”的大小分布的生成函数。一个分支的大小是该分支中被占据位点的数量。$T(x)$ 满足如下自洽方程：\n$$ T(x) = (1 - p) \\cdot x^0 + p \\cdot x \\cdot [T(x)]^{z-1} $$\n这个方程的右边考虑了两种情况：\n-   该邻居位点是空的（概率为 $1-p$），则该分支大小为0，对生成函数的贡献是 $x^0=1$。\n-   该邻居位点被占据（概率为 $p$），则它自身对大小贡献为1（因子 $x$），并且它又引出 $z-1$ 个新的独立分支，每个分支的生成函数也是 $T(x)$。\n\n接下来，我们构造整个簇的生成函数 $G(x)$。由于我们考虑的是一个被占据位点所属的簇，所以中心位点是被占据的。这个簇由中心位点本身和从它延伸出去的 $z$ 个独立分支组成：\n$$ G(x) = x \\cdot [T(x)]^z $$\n\n簇的平均大小 $\\langle s \\rangle$ 就是生成函数 $G(x)$ 在 $x=1$ 处的导数：\n$$ \\langle s \\rangle = G'(1) $$\n\n对 $G(x)$ 求导：\n$$ G'(x) = [T(x)]^z + x \\cdot z \\cdot [T(x)]^{z-1} \\cdot T'(x) $$\n在 $x=1$ 处求值：\n$$ G'(1) = [T(1)]^z + z \\cdot [T(1)]^{z-1} \\cdot T'(1) $$\n\n在亚临界相（$p  p_c$），所有簇都是有限的，所以 $T(1)$（即所有分支大小的概率之和）等于1。\n\n然后，我们需要计算 $T'(1)$。对 $T(x)$ 的方程两边对 $x$ 求导：\n$$ T'(x) = p \\left( [T(x)]^{z-1} + x (z-1) [T(x)]^{z-2} T'(x) \\right) $$\n令 $x=1$ 并代入 $T(1)=1$：\n$$ T'(1) = p \\left( 1 + (z-1) T'(1) \\right) = p + p(z-1)T'(1) $$\n整理并解出 $T'(1)$：\n$$ T'(1) [1 - p(z-1)] = p \\implies T'(1) = \\frac{p}{1 - p(z-1)} $$\n\n最后，将 $T(1)=1$ 和 $T'(1)$ 的表达式代入 $G'(1)$：\n$$ \\langle s \\rangle = G'(1) = 1^z + z \\cdot 1^{z-1} \\cdot \\frac{p}{1 - p(z-1)} = 1 + \\frac{zp}{1 - p(z-1)} $$\n将上式通分化简：\n$$ \\langle s \\rangle = \\frac{1 - p(z-1) + zp}{1 - p(z-1)} = \\frac{1 - pz + p + zp}{1 - p(z-1)} = \\frac{1+p}{1 - p(z-1)} $$\n这个表达式在 $p  p_c = \\frac{1}{z-1}$ 时有效，此时分母为正。", "answer": "$$\\boxed{\\dfrac{1 + p}{1 - p(z-1)}}$$", "id": "1188069"}]}