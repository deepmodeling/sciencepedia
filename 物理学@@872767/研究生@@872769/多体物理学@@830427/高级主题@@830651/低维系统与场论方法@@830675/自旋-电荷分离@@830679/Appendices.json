{"hands_on_practices": [{"introduction": "在常规金属中，电子是稳定的准粒子。然而，在一维系统中，由于相互作用，电子会“分裂”成携带自旋（自旋子）和电荷（空穴子）的独立激发。这种现象——自旋-电荷分离——的一个直接后果是，将一个电子注入系统的能力在费米能级附近被强烈抑制。本练习将指导您使用“玻色化”这一强大技术来计算一维导线末端的隧道态密度，这是一个可通过扫描隧道显微镜测量的量，并揭示其如何以幂律形式依赖于能量。[@problem_id:1199673]", "problem": "考虑一个定义在 $x \\le 0$ 的半无限长导线上的、由相互作用的自旋-1/2电子组成的一维系统。该系统的低能物理由 Tomonaga-Luttinger 液体 (TLL) 模型描述。有效哈密顿量分离为电荷 ($\\nu=c$) 和自旋 ($\\nu=s$) 两个部分：\n$$\nH = \\sum_{\\nu=c,s} \\frac{\\hbar v_\\nu}{2\\pi} \\int_{-\\infty}^0 dx \\left[ K_\\nu (\\partial_x \\theta_\\nu(x))^2 + \\frac{1}{K_\\nu} (\\partial_x \\phi_\\nu(x))^2 \\right]\n$$\n这里，$\\phi_\\nu(x)$ 和 $\\theta_\\nu(x)$ 是描述集体激发的玻色子相位场，$v_\\nu$ 是传播速度，$K_\\nu$ 是编码相互作用强度的无量纲 Luttinger 参数。对于无相互作用的电子，$K_c = K_s = 1$。排斥相互作用导致 $K_c  1$，而对于自旋旋转不变的系统，$K_s=1$。\n\n我们关心的是导线末端 ($x=0$) 处的单粒子隧穿态密度 (TDOS) $\\rho(\\omega)$，在低能量 $\\omega$（从费米能级测量）下的行为。TDOS 表现出幂律行为：\n$$\n\\rho(\\omega) \\propto \\omega^\\alpha\n$$\n指数 $\\alpha$ 可以从边界上单电子虚时格林函数的长时衰减行为确定，即 $G_{end}(\\tau) = \\langle T_\\tau c_\\sigma(0,\\tau) c_\\sigma^\\dagger(0,0) \\rangle$。如果对于较大的 $\\tau$，$G_{end}(\\tau) \\propto |\\tau|^{-\\eta}$，那么指数由 $\\alpha = \\eta - 1$ 给出。\n\n在玻色化框架中，电子算符 $c_\\sigma(x)$ 用右行 ($p=+1$) 和左行 ($p=-1$) 场 $\\psi_{p,\\sigma}(x)$ 来表示。在低能量下，这些场表示为：\n$$\n\\psi_{p,\\sigma}(x) \\propto \\exp\\left[ -i \\frac{1}{\\sqrt{2}} (p \\phi_c(x) - \\theta_c(x)) - i \\frac{\\sigma}{\\sqrt{2}} (p \\phi_s(x) - \\theta_s(x)) \\right]\n$$\n其中 $\\sigma = \\pm 1$ 分别代表自旋向上/向下。完整的电子算符是 $c_\\sigma(x) = \\psi_{+1,\\sigma}(x) + \\psi_{-1,\\sigma}(x)$。\n\n在 $x=0$ 处存在边界，这对场施加了边界条件。对于开放边界（无电流流过），条件是场 $\\phi_\\nu(x,t)$ 在边界处被钉扎：\n$$\n\\phi_c(x=0, t) = 0 \\quad \\text{and} \\quad \\phi_s(x=0, t) = 0\n$$\n这反过来又允许对偶场 $\\theta_\\nu(x,t)$ 在边界处涨落。这些场的等时关联函数与此问题无关，但其动力学由虚时 $\\tau$ 中的两点函数捕捉。对于边界上的场，其表达式为：\n$$\n\\langle (\\theta_\\nu(0, \\tau) - \\theta_\\nu(0, 0))^2 \\rangle = \\frac{2}{K_\\nu} \\ln\\left(\\frac{|\\tau|}{\\tau_0}\\right)\n$$\n其中 $\\tau_0$ 是一个短时截断。\n\n利用所提供的信息，确定 TLL 导线末端隧穿态密度的幂律指数 $\\alpha$ 的表达式。请用 Luttinger 参数 $K_c$ 和 $K_s$ 表示你的答案。", "solution": "我们从边界条件钉扎的玻色子场和玻色化的电子算符开始。\n\n1. 边界 ($x=0$) 处的电子算符：\n   由于 $\\phi_\\nu(0,\\tau)=0$，\n   $$\\psi_{p,\\sigma}(0,\\tau)\\propto \\exp\\Bigl[-i\\frac1{\\sqrt2}(p\\phi_c-\\theta_c)\n   -i\\frac{\\sigma}{\\sqrt2}(p\\phi_s-\\theta_s)\\Bigr]\n   =\\exp\\Bigl[i\\frac1{\\sqrt2}\\theta_c(0,\\tau)\n   +i\\frac{\\sigma}{\\sqrt2}\\theta_s(0,\\tau)\\Bigr]\\,.$$\n   对 $p=\\pm1$ 求和得到\n   $$c_\\sigma(0,\\tau)\\propto \\exp\\Bigl[i\\frac1{\\sqrt2}\\theta_c(0,\\tau)\n   +i\\frac{\\sigma}{\\sqrt2}\\theta_s(0,\\tau)\\Bigr]\\,.$$\n\n2. 虚时格林函数：\n   $$G_{end}(\\tau)\\propto \n   \\bigl\\langle e^{\\,iA(\\tau)}e^{-iA(0)}\\bigr\\rangle,\\quad\n   A(\\tau)=\\frac1{\\sqrt2}\\theta_c(0,\\tau)+\\frac{\\sigma}{\\sqrt2}\\theta_s(0,\\tau)\\,. $$\n\n3. 高斯平均：\n   $$\\langle e^{\\,i(A(\\tau)-A(0))}\\rangle\n   =\\exp\\Bigl[-\\tfrac12\\langle\\bigl(A(\\tau)-A(0)\\bigr)^2\\rangle\\Bigr]\\,.$$\n   使用\n   $$\\langle(\\theta_\\nu(\\tau)-\\theta_\\nu(0))^2\\rangle\n   =\\frac{2}{K_\\nu}\\ln\\frac{|\\tau|}{\\tau_0},$$\n   我们得到\n   $$\\langle(A(\\tau)-A(0))^2\\rangle\n   =\\frac12\\Bigl\\langle(\\Delta\\theta_c)^2\\Bigr\\rangle\n   +\\frac12\\Bigl\\langle(\\Delta\\theta_s)^2\\Bigr\\rangle\n   =\\Bigl(\\frac1{K_c}+\\frac1{K_s}\\Bigr)\\ln\\frac{|\\tau|}{\\tau_0}\\,.$$\n\n4. 长时衰减：\n   $$G_{end}(\\tau)\\propto\n   \\exp\\Bigl[-\\tfrac12\\bigl(\\tfrac1{K_c}+\\tfrac1{K_s}\\bigr)\\ln\\frac{|\\tau|}{\\tau_0}\\Bigr]\n   =\\Bigl(\\frac{|\\tau|}{\\tau_0}\\Bigr)^{-\\eta},\\quad\n   \\eta=\\frac1{2K_c}+\\frac1{2K_s}\\,. $$\n\n5. TDOS 指数：\n   $$\\alpha=\\eta-1=\\frac1{2K_c}+\\frac1{2K_s}-1\\,. $$", "answer": "$$\\boxed{\\frac{1}{2K_c}+\\frac{1}{2K_s}-1}$$", "id": "1199673"}, {"introduction": "自旋-电荷分离不仅影响单个电子的性质，还深刻地改变了系统可能形成的集体有序状态。在一维中，量子涨落阻止了真正的长程有序，取而代之的是不同有序倾向之间的竞争，这表现为关联函数的幂律衰减。本练习将探讨两种主要的竞争不稳定性：电荷密度波（CDW）和单重态超导（SS）。通过计算并比较它们关联函数的衰减指数，我们可以确定将这两种主导涨落区域分开的临界条件，从而绘制出 Tomonaga-Luttinger 液体理论的基态相图。[@problem_id:1199603]", "problem": "在一维相互作用电子系统的低能有效理论，即朝永-Luttinger液体（TLL）理论中，量子涨落会阻止在零温下形成真正的长程有序。取而代之的是，不同的有序倾向表现为幂律衰减的关联函数。“主导”类型的涨落是其对应关联函数在长距离上衰减最慢的那一种。\n\n考虑一个具有自旋-电荷分离的有自旋的TLL。低能物理由两组玻色场描述：具有Luttinger参数 $K_c$ 的电荷场 $(\\phi_c, \\theta_c)$，以及具有Luttinger参数 $K_s$ 的自旋场 $(\\phi_s, \\theta_s)$。在 $T=0$ 时，场关联函数的长距离行为由以下公式给出：\n$$\n\\langle [\\phi_\\nu(x) - \\phi_\\nu(0)]^2 \\rangle = \\frac{K_\\nu}{\\pi} \\ln(|x|/\\alpha)\n$$\n$$\n\\langle [\\theta_\\nu(x) - \\theta_\\nu(0)]^2 \\rangle = \\frac{1}{\\pi K_\\nu} \\ln(|x|/\\alpha)\n$$\n其中 $\\nu \\in \\{c, s\\}$，$\\alpha$ 是一个短程截断。\n\n$2k_F$ 电荷密度波（CDW）和单重态超导（SS）涨落的算符可以用这些玻色场来表示。对于这个问题，我们考虑以下形式：\n$$\nO_{CDW}(x) \\sim \\exp[i\\sqrt{2\\pi}\\phi_c(x)] \\cos[\\sqrt{2\\pi}\\theta_s(x)]\n$$\n$$\nO_{SS}(x) \\sim \\exp[i\\sqrt{2\\pi}\\theta_c(x)] \\cos[\\sqrt{2\\pi}\\phi_s(x)]\n$$\n假设系统具有SU(2)自旋旋转对称性，这将自旋Luttinger参数固定为 $K_s=1$。\n\n确定电荷Luttinger参数 $K_c$ 的值，该值标志着由CDW和SS涨落主导的区域之间的边界。", "solution": "1. 对于一个顶点算符 $e^{i a\\phi_\\nu(x)}$，其关联函数的衰减由其标度维数决定。$\\langle e^{ia\\phi_\\nu(x)} e^{-ia\\phi_\\nu(0)} \\rangle = \\langle e^{ia[\\phi_\\nu(x) - \\phi_\\nu(0)]} \\rangle = \\exp\\left(-\\frac{a^2}{2}\\langle[\\phi_\\nu(x) - \\phi_\\nu(0)]^2\\rangle\\right) = \\exp\\left(-\\frac{a^2 K_\\nu}{2\\pi}\\ln(|x|/\\alpha)\\right) = (|x|/\\alpha)^{-a^2 K_\\nu/(2\\pi)}$。\n   当 $a=\\sqrt{2\\pi}$ 时，关联函数衰减为 $(|x|/\\alpha)^{-K_\\nu}$。因此，与 $e^{i\\sqrt{2\\pi}\\phi_c}$ 相关的标度维数为 $K_c$。\n\n2. 类似地，对于算符 $e^{i a\\theta_\\nu(x)}$，其关联函数衰减为 $(|x|/\\alpha)^{-a^2/(2\\pi K_\\nu)}$。当 $a=\\sqrt{2\\pi}$ 时，衰减为 $(|x|/\\alpha)^{-1/K_\\nu}$。因此，与 $e^{i\\sqrt{2\\pi}\\theta_c}$ 相关的标度维数为 $1/K_c$。\n\n3. CDW算符 $O_{CDW}\\sim e^{i\\sqrt{2\\pi}\\phi_c}\\cos(\\sqrt{2\\pi}\\theta_s)$ 的总标度维数是其电荷部分和自旋部分维数之和。$\\cos(\\sqrt{2\\pi}\\theta_s)$ 的标度维数为 $1/K_s$。因此，$\\Delta_{CDW}=K_c+1/K_s$。由于 $K_s=1$，我们有 $\\Delta_{CDW}=K_c+1$。\n\n4. SS算符 $O_{SS}\\sim e^{i\\sqrt{2\\pi}\\theta_c}\\cos(\\sqrt{2\\pi}\\phi_s)$ 的总标度维数是 $\\Delta_{SS}=1/K_c+K_s$。由于 $K_s=1$，我们有 $\\Delta_{SS}=1/K_c+1$。\n\n5. 边界条件 $\\Delta_{CDW}=\\Delta_{SS}$ 意味着两种涨落衰减得同样慢。\n   $$K_c+1=\\frac{1}{K_c}+1\\quad\\Longrightarrow\\quad K_c=\\frac{1}{K_c}\\quad\\Longrightarrow\\quad K_c^2=1\\quad\\Longrightarrow\\quad K_c=1.$$\n   (我们取正根，因为 $K_c>0$)", "answer": "$$\\boxed{1}$$", "id": "1199603"}, {"introduction": "虽然解析计算为自旋-电荷分离提供了坚实的理论基础，但没有什么比直接观察这一现象更能增强直觉了。本练习将带您进入计算物理的世界，通过精确的数值模拟来可视化一个电子注入一维 Hubbard 链后的动态过程。您将通过编写代码来追踪过剩电荷密度和自旋密度的演化，并亲眼见证它们如何以不同的速度传播，从而形成两个分离的波包。这项实践提供了一个独特的机会，让您在计算机上“看到”自旋-电荷分离的真实过程，将抽象的理论概念转化为具体的动态图像。[@problem_id:3017411]", "problem": "考虑一个具有开放边界条件的一维 Hubbard 链，在 $L$ 个格点的晶格上用二次量子化进行建模。每个格点允许两种费米子模式，即自旋向上和自旋向下，按模式索引 $m = 2 j + s$ 进行正则排序，其中 $j \\in \\{0, 1, \\dots, L-1\\}$ 标记格点，$s \\in \\{0,1\\}$ 标记自旋，$s=0$ 为自旋向上，$s=1$ 为自旋向下。费米子产生和湮灭算符 $c_m^\\dagger$ 和 $c_m$ 满足正则反对易关系 $\\{c_m, c_n^\\dagger\\} = \\delta_{mn}$ 和 $\\{c_m, c_n\\} = \\{c_m^\\dagger, c_n^\\dagger\\} = 0$。哈密顿量是标准的一维排斥 Hubbard 模型，\n$$\nH = -t \\sum_{j=0}^{L-2} \\sum_{s=0}^{1} \\left( c_{2j+s}^\\dagger c_{2(j+1)+s} + c_{2(j+1)+s}^\\dagger c_{2j+s} \\right) + U \\sum_{j=0}^{L-1} n_{j\\uparrow} n_{j\\downarrow},\n$$\n其中 $t$ 是最近邻跃迁振幅（设为 $t=1$），$U$ 是在位相互作用强度，且 $n_{j\\uparrow} = c_{2j}^\\dagger c_{2j}$，$n_{j\\downarrow} = c_{2j+1}^\\dagger c_{2j+1}$。单位选取为 $\\hbar = 1$。\n\n要求您模拟局域电子注入后的幺正时间演化，并通过提取超额电荷密度和自旋密度的空间分离峰值位置来量化自旋-电荷分离。您无需实现完整的演化块消减（TEBD）或含时密度矩阵重整化群（DMRG），而应通过对稀疏哈密顿量进行指数化，在小尺寸链上执行数值精确的时间演化。对于短时间和小型系统，这在概念上与 TEBD 一致。\n\n初始态：制备一个半填充的乘积态 $|\\psi_\\mathrm{init}\\rangle$，每个格点上恰好有一个电子，且自旋交替排列，使得偶数 $j$ 的格点被自旋向上的电子占据，奇数 $j$ 的格点被自旋向下的电子占据。然后，通过将 $c^\\dagger_{2 j_0}$ 作用于 $|\\psi_\\mathrm{init}\\rangle$ ，在格点 $j_0$ 处注入一个局域的自旋向上电子，并将得到的态 $|\\psi(0)\\rangle$ 归一化。通过重复应用单步演化 $|\\psi(t+\\Delta t)\\rangle \\approx e^{-i H \\Delta t} |\\psi(t)\\rangle$，在哈密顿量 $H$ 下将 $|\\psi(0)\\rangle$ 演化时间 $T$，使用固定的时间步长 $\\Delta t$。在最终时间 $T$ 计算以下局域可观测量：\n- 电荷密度 $n_j(T) = \\langle \\psi(T) | n_{j\\uparrow} + n_{j\\downarrow} | \\psi(T) \\rangle$。\n- z-分量自旋密度 $S^z_j(T) = \\frac{1}{2} \\langle \\psi(T) | n_{j\\uparrow} - n_{j\\downarrow} | \\psi(T) \\rangle$。\n定义相对于注入前初始乘积态 $|\\psi_\\mathrm{init}\\rangle$ 的相应超额密度：\n$$\n\\Delta n_j(T) = n_j(T) - n_j^\\mathrm{init}, \\quad \\Delta S^z_j(T) = S^z_j(T) - S^{z,\\mathrm{init}}_j.\n$$\n为量化自旋-电荷分离，通过在 $j > j_0$ 的范围内，取使 $\\Delta n_j(T)$ 最大化的索引 $j$ 和在正值中使 $\\Delta S^z_j(T)$ 最大化的索引，来确定向右移动的峰值位置。如果对于某一可观测量，在右侧未发现正的超额值，则将其右峰位置定义为 $j_0$。分离度量是这两个峰值位置之差，以晶格格点单位表示：\n$$\n\\Delta x = j^\\ast_\\mathrm{charge}(T) - j^\\ast_\\mathrm{spin}(T).\n$$\n\n使用 $2L$ 个费米子模式上的占据数基矢来实现希尔伯特空间，由从 $0$ 到 $2^{2L}-1$ 的整数上的位串表示。使用由 $m = 2 j + s$ 指定的正则排序。通过枚举基矢态并应用源于 Jordan–Wigner 排序的费米子符号规则来构建稀疏哈密顿量。使用作用于向量的数值稳定的稀疏指数运算来执行时间演化。从概率分布 $|\\psi(T)|^2$ 和占据数基矢中数算符的对角结构计算密度。\n\n模拟参数：\n对以下三组参数集运行模拟，所有参数集的跃迁振幅均为 $t=1$ 且具有开放边界条件：\n- 情况 A: $L=6$, $U=0$, $T=0.6$, $\\Delta t=0.05$, $j_0=3$.\n- 情况 B: $L=6$, $U=4$, $T=0.6$, $\\Delta t=0.05$, $j_0=3$.\n- 情况 C: $L=6$, $U=8$, $T=0.6$, $\\Delta t=0.05$, $j_0=3$.\n\n您的程序必须输出一行，其中包含一个逗号分隔的三个浮点数列表，单位为晶格格点，每个浮点数对应于相应情况下的分离度量 $\\Delta x$，并用方括号括起来（例如，$[\\Delta x_A,\\Delta x_B,\\Delta x_C]$）。不允许有任何其他输出。以晶格格点单位表示的距离应为纯数字（无量纲的晶格位置）。确保数值稳定性并提供通过标准 Python 浮点数格式化字符串舍入的结果。", "solution": "用户提供的问题是计算凝聚态物理中一个定义明确且具有科学依据的练习。它要求模拟一维 Hubbard 模型中的量子动力学，以展示自旋-电荷分离现象。该问题是有效的，因为它是自洽的、客观的，并且基于已确立的物理原理。指定的参数和系统尺寸（$L=6$）对于精确对角化方法在计算上是可行的。\n\n解决方案的实现方法是：在占据数基矢中表示多体量子系统，将哈密顿量构建为稀疏矩阵，使用矩阵指数函数执行时间演化，最后计算所需的物理可观测量。\n\n### 1. 希尔伯特空间与基矢表示\n该系统由一个包含 $L$ 个格点的晶格组成，每个格点有两个费米子模式，分别对应自旋向上（$s=0$）和自旋向下（$s=1$）。费米子模式的总数为 $2L$。希尔伯特空间是由这 $2L$ 个模式所有可能的占据方式所张成的福克空间。该空间的完备基是占据数基，其中每个基矢态都通过指明哪些模式被占据来指定。\n\n对于一个有 $2L$ 个模式的系统，每个基矢态都可以唯一地映射到一个 $2L$ 位的整数，通常称为位掩码。如果模式 $m$ 被占据，则该整数的第 $m$ 位置为 $1$，否则为 $0$。模式索引 $m$ 定义为 $m = 2j + s$，其中 $j \\in \\{0, 1, \\dots, L-1\\}$ 是格点索引。这建立了一个从 $m=0$（格点0，自旋向上）到 $m=2L-1$（格点 $L-1$，自旋向下）的模式的正则排序。这个希尔伯特空间的维度是 $2^{2L}$。对于 $L=6$，维度是 $2^{12} = 4096$，这对于直接数值计算是可行的。\n\n### 2. 哈密顿量构建\nHubbard 哈密顿量 $H = H_t + H_U$ 由动能（跃迁）项 $H_t$ 和势能（在位相互作用）项 $H_U$ 组成。\n\n相互作用项为 $H_U = U \\sum_{j=0}^{L-1} n_{j\\uparrow} n_{j\\downarrow}$，其中 $n_{j\\uparrow} = c_{2j}^\\dagger c_{2j}$ 和 $n_{j\\downarrow} = c_{2j+1}^\\dagger c_{2j+1}$ 是数算符。在占据数基矢中，数算符是对角的。一个基矢态 $|k\\rangle$（由整数 $k$ 表示）是 $H_U$ 的本征态。相应的本征值是 $U$ 乘以在态 $|k\\rangle$ 中双重占据的格点数。因此，$H_U$ 的矩阵表示是对角的，其元素为 $\\langle k | H_U | k \\rangle = U \\sum_{j=0}^{L-1} \\left( (k \\gg 2j) \\ 1 \\right) \\cdot \\left( (k \\gg (2j+1)) \\ 1 \\right)$。\n\n跃迁项为 $H_t = -t \\sum_{j=0}^{L-2} \\sum_{s=0}^{1} \\left( c_{2j+s}^\\dagger c_{2(j+1)+s} + \\text{h.c.} \\right)$。该项是非对角的。像 $c_{m_2}^\\dagger c_{m_1}$ 这样的算符在模式 $m_1$ 湮灭一个费米子，并在模式 $m_2$ 产生一个费米子。它将一个基矢态 $|k\\rangle$（其中 $m_1$ 被占据，$m_2$ 为空）连接到另一个态 $|k'\\rangle$（其中 $m_1$ 为空，$m_2$ 被占据）。费米子算符的一个关键方面是 Jordan-Wigner 符号，它源于反对易关系。算符 $c_{m_2}^\\dagger c_{m_1}$ 作用在态 $|k\\rangle$ 上会产生一个 $(-1)^P$ 的符号，其中 $P$ 是 $m_1$ 和 $m_2$ 之间（不包括两端）被占据的模式数。假设 $m_1  m_2$，符号由整数 $k$ 在比特位置 $m_1+1$ 和 $m_2-1$ 之间设置的比特数的奇偶性决定。矩阵元为 $\\langle k' | H_t | k \\rangle = -t \\cdot (-1)^P$。由于哈密顿量是厄米共轭的，所以 $\\langle k | H_t | k' \\rangle = \\langle k' | H_t | k \\rangle$。\n\n综合这些，我们将完整的哈密顿量 $H$ 构建为一个 $2^{2L} \\times 2^{2L}$ 的稀疏矩阵。\n\n### 3. 初始态与时间演化\n模拟从一个特定的初始态开始。首先，定义一个基态 $|\\psi_\\mathrm{init}\\rangle$ 为一个半填充的乘积态，具有交替的自旋模式：如果 $j$ 是偶数，格点 $j$ 有一个自旋向上的电子；如果 $j$ 是奇数，则有一个自旋向下的电子。这对应于我们福克空间中的一个单一基矢。\n\n用于时间演化的态 $|\\psi(0)\\rangle$ 是通过在格点 $j_0$ 注入一个自旋向上的电子来创建的。这是通过将产生算符 $c_{2j_0}^\\dagger$ 作用于 $|\\psi_\\mathrm{init}\\rangle$ 来实现的。由于格点 $j_0$ 的自旋向上模式初始为空，此操作是明确定义的，并产生一个新的、已经是归一化的单一基矢态。$|\\psi(0)\\rangle$ 的状态向量表示是一个大小为 $2^{2L}$ 的数组，在对应于适当位掩码的索引处为 $1$，其他位置为 $0$。\n\n状态向量的时间演化由薛定谔方程 $|\\psi(t)\\rangle = e^{-iHt} |\\psi(0)\\rangle$（其中 $\\hbar = 1$）决定。这是通过数值计算得到的。问题指定使用单步传播算符 $e^{-iH\\Delta t}$ 的重复应用，但为了提高数值精度和稳定性，我们通过计算完整的矩阵指数 $e^{-iHT}$ 对初始态 $|\\psi(0)\\rangle$ 的作用来直接计算最终态 $|\\psi(T)\\rangle$。`scipy.sparse.linalg.expm_multiply` 函数对此非常理想，因为它可以在不显式构成稠密矩阵 $e^{-iHT}$ 的情况下计算此作用。\n\n### 4. 可观测量的测量\n在最终时间 $T$，我们有状态向量 $|\\psi(T)\\rangle = \\sum_k \\alpha_k |k\\rangle$。对角算符 $O$ 的期望值为 $\\langle O \\rangle = \\langle \\psi(T) | O | \\psi(T) \\rangle = \\sum_k |\\alpha_k|^2 \\langle k | O | k \\rangle$。\n电荷密度 $n_j = n_{j\\uparrow} + n_{j\\downarrow}$ 和 z-分量自旋密度 $S^z_j = \\frac{1}{2}(n_{j\\uparrow} - n_{j\\downarrow})$ 在占据数基矢中是对角的。它们在时间 $T$ 的期望值是通过对每个基矢态 $|k\\rangle$ 的本征值求和计算的，并用相应的概率 $|\\alpha_k|^2$ 加权。\n\n### 5. 自旋-电荷分离分析\n为了量化自旋-电荷分离，我们首先通过减去初始（注入前）密度来计算超额密度：\n$\\Delta n_j(T) = n_j(T) - n_j^\\mathrm{init}$\n$\\Delta S^z_j(T) = S^z_j(T) - S^{z,\\mathrm{init}}_j$\n\n然后定位这些超额密度在注入点右侧（$j > j_0$）的峰值位置。\n- 对于电荷（$j^\\ast_\\mathrm{charge}$）：如果在 $j > j_0$ 的区域存在任何正的超额电荷 $\\Delta n_j(T) > 0$，则峰值是使 $\\Delta n_j(T)$ 最大化的索引 $j$。否则，该位置定义为 $j_0$。\n- 对于自旋（$j^\\ast_\\mathrm{spin}$）：如果在 $j > j_0$ 的区域存在任何正的超额自旋 $\\Delta S^z_j(T) > 0$，则峰值是在这些正值中使 $\\Delta S^z_j(T)$ 最大化的索引 $j$。否则，该位置定义为 $j_0$。\n\n最终的分离度量是这些峰值位置的差：$\\Delta x = j^\\ast_\\mathrm{charge}(T) - j^\\ast_\\mathrm{spin}(T)$。对提供的三组参数中的每一组重复整个过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import expm_multiply\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case A: L=6, U=0, T=0.6, Δt=0.05, j₀=3\n        {'L': 6, 'U': 0, 't': 1, 'T': 0.6, 'dt': 0.05, 'j0': 3},\n        # Case B: L=6, U=4, T=0.6, Δt=0.05, j₀=3\n        {'L': 6, 'U': 4, 't': 1, 'T': 0.6, 'dt': 0.05, 'j0': 3},\n        # Case C: L=6, U=8, T=0.6, Δt=0.05, j₀=3\n        {'L': 6, 'U': 8, 't': 1, 'T': 0.6, 'dt': 0.05, 'j0': 3},\n    ]\n\n    results = []\n    for params in test_cases:\n        delta_x = run_simulation(**params)\n        results.append(delta_x)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(L, U, t, T, dt, j0):\n    \"\"\"\n    Performs the simulation for a single set of parameters.\n    \"\"\"\n    num_modes = 2 * L\n    hilbert_dim = 1  num_modes\n\n    # 1. Initial State Preparation\n    # |psi_init>: Alternating spin-up/down product state (half-filling)\n    init_mask = 0\n    for j in range(L):\n        if j % 2 == 0:  # Even site: spin-up\n            init_mask |= (1  (2 * j))\n        else:  # Odd site: spin-down\n            init_mask |= (1  (2 * j + 1))\n\n    # Pre-injection densities for calculating excess densities later\n    n_init = np.ones(L)\n    Sz_init = np.array([0.5 if j % 2 == 0 else -0.5 for j in range(L)])\n\n    # |psi(0)>: Inject one spin-up electron at site j0\n    m_inj = 2 * j0\n    inj_mask = init_mask | (1  m_inj)\n    \n    psi_0 = np.zeros(hilbert_dim, dtype=np.complex128)\n    psi_0[inj_mask] = 1.0\n\n    # 2. Hamiltonian Construction\n    H = lil_matrix((hilbert_dim, hilbert_dim), dtype=float)\n\n    for k in range(hilbert_dim):\n        # On-site interaction term (diagonal)\n        if U != 0:\n            U_term = 0\n            for j in range(L):\n                m_up = 2 * j\n                m_down = 2 * j + 1\n                if ((k >> m_up)  1) and ((k >> m_down)  1):\n                    U_term += U\n            if U_term != 0:\n                H[k, k] = U_term\n\n    # Hopping term (off-diagonal)\n    for j in range(L - 1): # site index\n        for s in range(2): # spin index {0: up, 1: down}\n            m1 = 2 * j + s\n            m2 = 2 * (j + 1) + s\n            \n            for k in range(hilbert_dim):\n                # Check if hop from m1 to m2 is possible in state k\n                if ((k >> m1)  1) and not ((k >> m2)  1):\n                    k_prime = k ^ (1  m1) ^ (1  m2)\n                    \n                    # Jordan-Wigner sign\n                    # Count occupied fermions between m1 and m2\n                    mask = ((1  (m2 - m1 - 1)) - 1)  (m1 + 1)\n                    sub_k = k  mask\n                    parity = bin(sub_k).count('1')\n                    sign = 1 if parity % 2 == 0 else -1\n                    \n                    val = -t * sign\n                    # Since H is built once, fill both symmetric elements\n                    if k  k_prime: # To avoid processing each pair twice\n                        H[k_prime, k] += val\n                        H[k, k_prime] += val\n\n    H_csr = H.tocsr()\n    \n    # 3. Time Evolution\n    num_steps = int(round(T / dt))\n    \n    # Evolve state from t=0 to t=T. expm_multiply can do this in one call\n    # for better accuracy than repeated multiplication.\n    psi_T = expm_multiply(-1j * H_csr, psi_0, start=0, stop=T, num=num_steps + 1)[-1]\n    \n    # 4. Calculate Observables\n    # Pre-calculate observable values for each basis state to vectorize computation\n    n_vals_per_site = np.zeros((L, hilbert_dim), dtype=np.int8)\n    Sz_vals_per_site = np.zeros((L, hilbert_dim), dtype=float)\n\n    for k in range(hilbert_dim):\n        for j in range(L):\n            m_up = 2 * j\n            m_down = 2 * j + 1\n            n_up_k = (k >> m_up)  1\n            n_down_k = (k >> m_down)  1\n            n_vals_per_site[j, k] = n_up_k + n_down_k\n            Sz_vals_per_site[j, k] = 0.5 * (n_up_k - n_down_k)\n            \n    probs = np.abs(psi_T)**2\n    n_T = n_vals_per_site @ probs\n    Sz_T = Sz_vals_per_site @ probs\n    \n    # 5. Excess Densities\n    delta_n = n_T - n_init\n    delta_Sz = Sz_T - Sz_init\n    \n    # 6. Find Peak Positions\n    j_charge_peak = j0\n    j_spin_peak = j0\n    \n    search_indices = np.arange(j0 + 1, L)\n    \n    # Charge peak: find max of delta_n if any value is positive on the right\n    if len(search_indices) > 0:\n        excess_charge_right = delta_n[search_indices]\n        if np.any(excess_charge_right > 0):\n            peak_idx_in_slice = np.argmax(excess_charge_right)\n            j_charge_peak = search_indices[peak_idx_in_slice]\n\n    # Spin peak: find max among positive values of delta_Sz on the right\n    if len(search_indices) > 0:\n        excess_spin_right = delta_Sz[search_indices]\n        positive_spin_mask = excess_spin_right > 0\n        if np.any(positive_spin_mask):\n            positive_spin_values = excess_spin_right[positive_spin_mask]\n            positive_spin_indices = search_indices[positive_spin_mask]\n            peak_idx_in_subset = np.argmax(positive_spin_values)\n            j_spin_peak = positive_spin_indices[peak_idx_in_subset]\n\n    # 7. Separation Measure\n    delta_x = float(j_charge_peak - j_spin_peak)\n    return delta_x\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3017411"}]}