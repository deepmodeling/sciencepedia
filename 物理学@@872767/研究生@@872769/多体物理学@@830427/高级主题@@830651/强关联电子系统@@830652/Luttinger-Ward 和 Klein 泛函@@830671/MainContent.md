## 引言
在探索由大量相互作用粒子组成的量子世界的征程中，[多体物理学](@entry_id:144526)面临的核心挑战是如何在保留关键物理特性的前提下，发展出可控且自洽的近似方法。直接求解多体薛定谔方程几乎是不可能的，因此，基于格林函数的形式主义提供了一条功能强大的途径。然而，随意的微扰近似往往会破坏[能量守恒](@entry_id:140514)等基本物理定律，导致非物理的结果。本文旨在解决这一关键问题，系统介绍Luttinger-Ward与Klein泛函——一个深刻而优美的理论框架，它为构建守恒的、[热力学自洽的](@entry_id:755906)多体[近似理论](@entry_id:138536)提供了坚实的数学基础。通过学习本文，读者将深入理解这一强大工具的精髓。在第一章“原理与机制”中，我们将奠定理论基础，阐明[巨势](@entry_id:136286)如何作为格林函数的泛函，并介绍通过变分原理导出[戴森方程](@entry_id:146246)的核心思想。接着，在第二章“应用与跨学科连接”中，我们将展示该理论在[计算热力学](@entry_id:148023)量、[响应函数](@entry_id:142629)以及作为[GW近似](@entry_id:140388)和动态平均场理论（DMFT）等前沿方法的理论基石方面的广泛应用。最后，通过第三章“动手实践”中的具体计算练习，读者将有机会亲手应用这些概念，将抽象的理论转化为具体的物理理解。

## 原理与机制

在[多体物理学](@entry_id:144526)中，我们的核心目标之一是理解和计算相互作用系统中粒子的行为。[单粒子格林函数](@entry_id:140400) $G$ 是描述这些行为的中心工具。一个强大而严谨的理论框架是基于[巨势](@entry_id:136286) $\Omega$ 作为格林函数 $G$ 的泛函的思想。本章将深入探讨这一框架的原理与机制，重点介绍 Luttinger-Ward 和 Klein 泛函，它们为构建系统性的、满足守恒律的近似方法提供了坚实的基础。

### 作为[格林函数](@entry_id:147802)泛函的[巨势](@entry_id:136286)

在相互作用系统中，[巨势](@entry_id:136286) $\Omega$ 不仅是一个[热力学](@entry_id:141121)量，还可以被看作是完整[格林函数](@entry_id:147802) $G$ 的一个复杂泛函，记作 $\Omega[G]$。这一观点的核心在于，物理上实现的[格林函数](@entry_id:147802) $G_{\text{phys}}$ 应该使该泛函取极值（通常是最小值）。这为我们提供了一个强大的[变分原理](@entry_id:198028)来确定系统的性质。

Luttinger和Ward，以及后来的Baym和Kadanoff，推导出了[巨势泛函](@entry_id:144711)的一个精确表达式。它由三个部分组成：

$$
\Omega[G] = \text{Tr}[\ln(-G^{-1})] + \text{Tr}[\Sigma G] + \Phi[G]
$$

让我们逐一解析这些项的物理意义：
1.  **$\text{Tr}[\ln(-G^{-1})]$**: 这一项代表了在完整[格林函数](@entry_id:147802) $G$ 描述的[准粒子](@entry_id:136584)图像下的有效单粒子贡献。利用[戴森方程](@entry_id:146246) $G^{-1} = G_0^{-1} - \Sigma$（其中 $G_0$ 是无[相互作用格林函数](@entry_id:186516)，$\Sigma$ 是自能），我们可以看到它包含了系统的动能和外场[势能](@entry_id:748988)，并通过[自能](@entry_id:145608) $\Sigma$ 包含了相互作用的平均场效应。

2.  **$\Phi[G]$**: 这是 **Luttinger-Ward 泛函**，是整个理论框架的核心。$\Phi[G]$ 被定义为[对相互作用能](@entry_id:173751)的所有**闭合的、连通的、双粒子不可约（2PI）[骨架图](@entry_id:147556)**（skeleton diagrams）求和。
    *   **[骨架图](@entry_id:147556)**：图中的每一条线都代表完整的、包含了所有相互作用效应的格林函数 $G$，而不是裸格林函数 $G_0$。
    *   **双粒子不可约（2PI）**：一个图如果不能通过切断两条格林函数线而分裂成两个分离的部分，那么它就是双粒子不可约的。这个条件至关重要，它确保了图的集合中没有冗余，并且避免了某些类型的双重计算。

3.  **$\text{Tr}[\Sigma G]$**: 这一项通常被视为一个“减去双重计算”的修正项。$\text{Tr}[\ln(-G^{-1})]$ 项中隐式地包含了部分[相互作用能](@entry_id:264333)，而 $\Phi[G]$ 也完全由相互作用贡献构成，$\text{Tr}[\Sigma G]$ 的引入恰好可以修正它们之间的双重计算问题。

### Klein 泛函与[变分原理](@entry_id:198028)

为了更清晰地阐述[变分原理](@entry_id:198028)，我们引入 **Klein 泛函** $\Psi_K[G]$（在文献中有时也记作 $\Gamma[G]$）：

$$
\Psi_K[G] \equiv \text{Tr}[\ln(-G^{-1})] + \Phi[G]
$$

于是，[巨势泛函](@entry_id:144711)可以被简洁地写成：

$$
\Omega[G] = \Psi_K[G] + \text{Tr}[\Sigma G]
$$

这一恒等式在理论中扮演着基础性的角色。例如，对于一个自洽求解的格林函数，我们可以显式验证这个关系的成立，从而确认了理论的内在一致性 [@problem_id:1206320]。

现在，我们引入该理论框架中最关键的一步：将[自能](@entry_id:145608) $\Sigma$ 定义为 Luttinger-Ward 泛函 $\Phi[G]$ 对[格林函数](@entry_id:147802) $G$ 的泛函导数。

$$
\Sigma_{ij}[G] = \frac{\delta \Phi[G]}{\delta G_{ji}}
$$

（注意指标的顺序，这源于泛函导数的标准定义。）任何通过这种方式从某个泛函 $\Phi$ 导出的[自能](@entry_id:145608)近似，都被称为是 **$\Phi$-可导的**（$\Phi$-derivable）或**守恒的**。

这个定义的深刻之处在于它与[巨势](@entry_id:136286)的[定态](@entry_id:137260)条件 $\frac{\delta\Omega[G]}{\delta G} = 0$ 的结合。可以证明，对完整的[巨势泛函](@entry_id:144711)求关于 $G$ 的泛函导数并使其为零的定态条件，等价于要求[格林函数](@entry_id:147802) $G$ 满足以下方程：

$$
G_0^{-1} - \frac{\delta \Phi[G]}{\delta G^T} = G^{-1}
$$

其中 $\frac{\delta \Phi[G]}{\delta G^T}$ 是一个简写，其 $(i,j)$ 元为 $\frac{\delta \Phi[G]}{\delta G_{ji}}$。如果我们利用上面的定义，令自能 $\Sigma[G] = \frac{\delta \Phi[G]}{\delta G^T}$，那么[定态](@entry_id:137260)条件就精确地给出了我们熟知的**[戴森方程](@entry_id:146246)**：

$$
G_0^{-1} - \Sigma = G^{-1}
$$

这个结果极为重要：它表明，只要自能是通过对一个 Luttinger-Ward 泛函 $\Phi$ 求导得到的，那么通过[巨势](@entry_id:136286)的[变分原理](@entry_id:198028)找到的物理[格林函数](@entry_id:147802)将自动满足[戴森方程](@entry_id:146246)。这保证了整个理论框架的自洽性。从[热力学](@entry_id:141121)角度看，这可以被理解为一个勒让德变换，其中 $\Sigma$ 和 $G$ 扮演着[共轭变量](@entry_id:147843)的角色，这解释了为何它们之间满足类似于[麦克斯韦关系式](@entry_id:137731)的对称性。

### 构建[守恒近似](@entry_id:139611)：$\Phi$-可导理论

在实践中，我们无法对无穷多的图进行求和来得到精确的 $\Phi[G]$。Luttinger-Ward 形式主义的巨大威力在于，它提供了一个系统性的方法来构建近似。我们可以通过选择 $\Phi[G]$ 的一个图的[子集](@entry_id:261956) $\Phi_{\text{approx}}[G]$ 来定义一个近似，然后通过求导 $\Sigma_{\text{approx}} = \delta \Phi_{\text{approx}} / \delta G$ 来获得一个自洽的、并且保证满足宏观守恒律的[自能](@entry_id:145608)。

#### 示例 1：[Hartree-Fock](@entry_id:142303) 近似

最简单的非微扰近似是 [Hartree-Fock](@entry_id:142303) (HF) 理论。它可以通过包含 $\Phi[G]$ 中最低阶的两个图来得到：一个直接相互作用环（Hartree 项）和一个交换相互作用环（Fock 项）。对应的 Luttinger-Ward 泛函为：

$$
\Phi_{\text{HF}}[G] = \frac{1}{2} \sum_{\text{direct}} - \frac{1}{2} \sum_{\text{exchange}}
$$

以一个具有瞬时相互作用 $U(\mathbf{q})$ 的[费米子](@entry_id:146235)系统为例，其泛函的具体形式为 [@problem_id:1206342]：

$$
\Phi_{\text{HF}}[G] = \frac{1}{2} U(0) \left( T \sum_{k,\sigma} G_{k\sigma} \right)^2 - \frac{1}{2} T^2 \sum_{\sigma} \sum_{k,p} U(\mathbf{k}-\mathbf{p}) G_{k\sigma} G_{p\sigma}
$$

对此表达式关于 $G$ 求泛函导数，我们便能精确地重现标准的、频率无关的 [Hartree-Fock](@entry_id:142303) [自能](@entry_id:145608)。

#### 示例 2：[二阶微扰理论](@entry_id:192858)

我们可以通过包含更高阶的图来系统地改进近似。二阶相互作用对 $\Phi[G]$ 的贡献来自于所谓的“蚝式图”（oyster diagram）或“日落图”（setting-sun diagram）。对于一个局域相互作用为 $U$ 的系统（例如[单杂质安德森模型](@entry_id:138488)），二阶 Luttinger-Ward 泛函的形式为 [@problem_id:1206324] [@problem_id:1206314]：

$$
\Phi^{(2)}[G_d] = \frac{1}{2} U^2 T \sum_{i\Omega_m} \left( \Pi_d(i\Omega_m) \right)^2 \quad \text{其中} \quad \Pi_d(i\Omega_m) = -T \sum_{i\nu_n} G_d(i\nu_n) G_d(i\nu_n + i\Omega_m)
$$

这里的 $\Pi_d$ 是极化气泡。对 $\Phi^{(2)}[G_d]$ 求导会产生我们熟悉的二阶自能图。同样，对于一个[标量场](@entry_id:151443)的 $\lambda \phi^4$ 理论，最低阶的非平庸贡献来自于一个“8字形图”，其泛函密度也可以被显式计算 [@problem_id:1206313]。这些例子展示了如何通过评估特定的[骨架图](@entry_id:147556)来为不同模型构建 $\Phi$ 泛函。

### $\Phi$-可导近似的性质与推论

采用 $\Phi$-可导框架之所以如此重要，是因为它能自动保证近似理论具备一系列优良的物理性质。

*   **宏观守恒律**：Baym 和 Kadanoff 证明，任何 $\Phi$-可导的近似都自动满足粒子数、动量和能量的宏观守恒律。这是该方法最强大的优点之一。例如，在[含时 Hartree-Fock (TDHF)](@entry_id:198498) 理论中，总能量之所以守恒，其根本原因在于 HF [哈密顿量](@entry_id:172864)是 HF 能量泛函对[密度矩阵](@entry_id:139892)的泛函导数，这正是 $\Phi$-可导结构的一个体现 [@problem_id:1206302]。

*   **[热力学一致性](@entry_id:138886)**：该框架不仅给出了自洽的[谱函数](@entry_id:147628)，还提供了一种[计算热力学](@entry_id:148023)势（如[巨势](@entry_id:136286) $\Omega$）的严谨方法，确保了[热力学关系式](@entry_id:139032)得到满足 [@problem_id:1206320]。

*   **[谱函数](@entry_id:147628)求和规则**：$\Phi$-可导近似能够正确地满足[谱函数](@entry_id:147628)的基本求和规则。例如，谱函数的总积分（零阶矩）恒等于1：$\int_{-\infty}^{\infty} A(\mathbf{k}, \omega) d\omega = 1$。更有趣的是，谱函数的一阶矩由自能在高频极限下的行为决定。对于任何 $\Phi$-可导近似，[自能](@entry_id:145608)在高频区的极限总是趋向于频率无关的 [Hartree-Fock](@entry_id:142303) 自能，即 $\lim_{|\omega|\to\infty} \Sigma(\mathbf{k}, \omega) = \Sigma_{\text{HF}}(\mathbf{k})$。这意味着一阶矩总是由裸[色散](@entry_id:263750)和 HF 自能给出，为分析[谱权重](@entry_id:144751)提供了坚实的理论基础 [@problem_id:1206315]。

*   **Luttinger 定理**：Luttinger 定理指出，在费米液体中，费米面的体积仅由粒子[数密度](@entry_id:268986)决定，不受相互作用细节的影响。Luttinger-Ward 形式主义为该定理提供了一个形式化的证明。证明的关键在于表明在零温下，$\text{Tr}[\ln(-G^{-1})]$ 的虚部积分为零，这保证了通过[格林函数](@entry_id:147802)计算出的粒子数与[费米面体积](@entry_id:145133)之间的正确关系 [@problem_id:1206336]。

### 非[守恒近似](@entry_id:139611)的病态行为

理解为何必须严格遵守 $\Phi$-可导的规则同样重要。当这些规则被破坏时，理论将出现各种非物理的病态行为。

*   **“麦克斯韦关系”检验**：一个[自能](@entry_id:145608) $\Sigma[G]$ 是 $\Phi$-可导的必要条件是其对 $G$ 的二阶泛函导数（即四点[顶点函数](@entry_id:145137)）是对称的：
    $$
    \frac{\delta \Sigma(1)}{\delta G(2)} = \frac{\delta \Sigma(2)}{\delta G(1)}
    $$
    这里 $1, 2$ 是时空、自旋等所有变量的紧凑记号。这个关系类似于[热力学](@entry_id:141121)中的麦克斯韦关系。许多看似合理的近似，例如 Hubbard-I 近似，实际上并不满足这个对称性条件。通过显式计算可以发现，其不对称核 $A_{\sigma\tau} \propto (\delta\Sigma_\sigma/\delta G_\tau - \delta\Sigma_\tau/\delta G_\sigma)$ 不为零，从而证明它不是一个[守恒近似](@entry_id:139611) [@problem_id:1206306]。这样的近似会导致能量、粒子数等不守恒。

*   **[骨架图](@entry_id:147556)规则的重要性**：$\Phi$ 泛函必须由 **2PI [骨架图](@entry_id:147556)**构成。如果我们试图从一个非[骨架图](@entry_id:147556)或非 2PI 图来构建一个“泛函”，那么整个理论的自洽性就会被破坏。例如，如果我们取一个自能图 $\Sigma^{(2)}[G]$，然后通过一个看似合理的方式 $\tilde{\Phi}[G] = \frac{1}{2}\text{Tr}(G\Sigma^{(2)}[G])$ 来构造一个泛函，我们会发现，对这个 $\tilde{\Phi}$ 求导得到的自能 $\delta\tilde{\Phi}/\delta G$ 并不等于我们开始时使用的 $\Sigma^{(2)}[G]$ [@problem_id:1206350]。这破坏了 $\Sigma = \delta\Phi/\delta G$ 的核心关系，导致理论框架的崩溃。

### 形式主义的推广

Luttinger-Ward 形式主义的适用范围非常广泛，可以推广到更复杂的情形。

*   **高阶[顶点函数](@entry_id:145137)**：Luttinger-Ward 泛函不仅能生成自能，它的高阶导数还能系统地生成多粒子不可约[顶点函数](@entry_id:145137)。例如，三粒子不可约顶点 $\Gamma^{(3)}$ 可以通过对 $\Phi[G]$ 求三次泛函导数得到 [@problem_id:1206289]：
    $$
    \Gamma^{(3)}_{i_1 i_2 i_3, j_1 j_2 j_3} = \frac{\delta^3 \Phi[G]}{\delta G_{j_1 i_1} \delta G_{j_2 i_2} \delta G_{j_3 i_3}}
    $$
    这为研究高阶关联效应提供了系统性的出发点。

*   **非平衡系统**：通过将理论推广到 Keldysh 时间路径上，Luttinger-Ward 形式主义成为研究非平衡[量子多体系统](@entry_id:141221)的强大工具。在 Keldysh 轮廓上定义的泛函 $\Gamma[G]$ 的定态条件 $\delta\Gamma[G]/\delta G=0$ 可以导出 Keldysh 空间中的[戴森方程](@entry_id:146246)。通过应用 Langreth 规则进行解析延拓，我们可以从这个单一的[矩阵方程](@entry_id:203695)中导出一整套关于 retarded ($G^R$)、advanced ($G^A$) 和 Keldysh ($G^K$) 分量的耦合方程，其中包括描述系统演化的[量子动理学方程](@entry_id:137964) [@problem_id:1206321]。这为从第一性原理出发研究[量子输运](@entry_id:138932)和[超快动力学](@entry_id:164209)过程提供了坚实的理论框架。

总之，Luttinger-Ward 和 Klein 泛函不仅提供了一个优雅的数学结构，更重要的是，它为在复杂的[量子多体问题](@entry_id:146763)中构建自洽、守恒且具有良好物理性质的近似理论铺平了道路。