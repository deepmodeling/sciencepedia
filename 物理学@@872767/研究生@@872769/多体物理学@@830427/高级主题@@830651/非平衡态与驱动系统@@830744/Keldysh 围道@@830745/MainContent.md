## 引言
在[多体物理学](@entry_id:144526)领域，对远离热平衡的量子系统的理解是一个核心挑战。传统的理论工具，如基于虚时松原形式主义或[绝热演化](@entry_id:153352)的方法，在处理快速变化的外部驱动或强非平衡稳态时常常失效。这些系统缺乏一个简单的[基态](@entry_id:150928)，其动力学演化充满了复杂的量子关联和相干效应，对理论描述提出了根本性的难题。Keldysh 轮廓形式主义应运而生，它通过在实时间轴上构建一个巧妙的“前向-后向”闭合路径，提供了一个强大而严谨的框架来精确描述和计算非平衡量子系统的动力学演化与可观测量。

本文旨在系统地介绍 Keldysh 形式主义。在“原理与机制”一章中，我们将奠定理论基础，详细阐述 Keldysh 轮廓的构建、轮廓排序格林函数的矩阵结构，以及 Keldysh 旋转带来的深刻简化。接着，在“应用与跨学科联系”一章，我们将展示该形式主义在[量子输运](@entry_id:138932)、超导动力学、[量子信息](@entry_id:137721)和强关联系统等前沿领域的广泛应用，揭示其解决实际问题的能力。最后，通过“动手实践”部分提供的具体计算练习，读者将有机会亲手应用这些概念，加深对理论的理解。通过这三章的学习，读者将掌握一个分析复杂非平衡量子现象的不可或缺的工具。

## 原理与机制

在研究远离热平衡的[量子多体系统](@entry_id:141221)时，传统的基于虚时（松原）格林函数或[绝热演化](@entry_id:153352)的[微扰理论](@entry_id:138766)方法遇到了根本性的困难。这是因为非[平衡态](@entry_id:168134)系统通常没有一个简单的、可以通过[绝热演化](@entry_id:153352)从其到达的[基态](@entry_id:150928)，并且初始状态可能包含复杂的关联。为了正确计算非平衡系统中物理量的[期望值](@entry_id:153208)，我们需要一种能够在实时间轴上处理[量子演化](@entry_id:198246)的理论框架。Keldysh 形式主义正是为此而生。

### Keldysh 轮廓：一种非平衡演化的路径

一个算符 $\hat{O}$ 在时刻 $t$ 的[期望值](@entry_id:153208)由密度矩阵 $\rho(t_0)$ 给出：
$$
\langle \hat{O}(t) \rangle = \text{Tr}[\rho(t_0) U^\dagger(t, t_0) \hat{O}(t) U(t, t_0)]
$$
其中 $U(t, t_0)$ 是从初始时刻 $t_0$ 到时刻 $t$ 的[时间演化算符](@entry_id:196774)。这个表达式的结构揭示了计算的核心：系统首先从 $t_0$ 正向演化到 $t$，此时算符 $\hat{O}$ 作用于系统；然后，为了与初始[密度矩阵](@entry_id:139892)结合，系统必须从 $t$ “反向”演化回 $t_0$。这种“向前再向后”的演化路径启发了 **Keldysh 轮廓**（也称为 Schwinger-Keldysh 轮廓）的构建。

Keldysh 轮廓 $C$ 是一个在复时间平面上的路径，它由两个分支组成：
1.  **正向分支 ($C_+$)**：沿着实时间轴从初始时刻 $t_0$ 演化到一个最远时刻 $t_{max}$（通常取为 $+\infty$）。
2.  **反向分支 ($C_-$)**：从 $t_{max}$ 沿着实时间轴演化回初始时刻 $t_0$。

轮廓上的任意一个“时间” $\tau$ 不仅由其实部 $t$ 指定，还由其所在的分支 $\sigma \in \{+, -\}$ 指定。为了处理沿此轮廓的算符乘积，我们引入 **轮廓排序算符** $T_K$。其排序规则是：
- 位于反向分支上的任意时刻总被认为是“晚于”位于正向分支上的任意时刻。
- 在同一分支上，正向分支按正常时间顺序排序，而反向分支按反时间顺序排序。

沿轮廓从 $\tau_1$ 到 $\tau_2$ 的演化由轮廓排序的[演化算符](@entry_id:182628) $U_K(\tau_2, \tau_1)$ 描述：
$$
U_K(\tau_2, \tau_1) = T_K \exp\left(-\frac{i}{\hbar} \int_{\tau_1}^{\tau_2} H(s) ds\right)
$$
其中积分沿着轮廓 $C$ 进行。

为了具体理解这一点，我们可以考虑一个简单的例子：计算一个从反向分支上的时刻 $\tau_{initial} = (t_i, -)$ 演化到正向分支上的时刻 $\tau_{final} = (t_f, +)$ 的[演化算符](@entry_id:182628)。演化路径实际上是从 $(t_f, +)$ 沿 $C_+$ 到 $(t_{max}, +)$，然后从 $(t_{max}, -)$ 沿 $C_-$ 到 $(t_i, -)$。对于一个不依赖于时间的[哈密顿量](@entry_id:172864) $H_0$，这个[演化算符](@entry_id:182628)可以被显式计算。它由两部分的乘积构成：沿 $C_-$ 的反时间顺序演化和沿 $C_+$ 的正常时间顺序演化。由于 $H_0$ 与自身对易，指数可以合并，最终得到一个简洁的结果，只依赖于两个实时间点之差 $t_f - t_i$ [@problem_id:1210947]。这个例子清晰地展示了 Keldysh 轮廓上[时间演化](@entry_id:153943)的复合规则，特别是跨越分支的演化是如何处理的。

### 轮廓上的[格林函数](@entry_id:147802)与 Keldysh 旋转

有了在轮廓上定义演化的方法，我们自然可以定义 **轮廓排序[格林函数](@entry_id:147802)**：
$$
G(\tau, \tau') = -i \langle T_K \psi(\tau) \psi^\dagger(\tau') \rangle
$$
其中 $\psi(\tau)$ 和 $\psi^\dagger(\tau')$ 是轮廓时间 $\tau$ 和 $\tau'$ 上的[场算符](@entry_id:140269)。由于 $\tau$ 和 $\tau'$ 都可以位于正向或反向分支上，这个定义自然地引出了一个 $2 \times 2$ 的矩阵结构：
$$
G_c = \begin{pmatrix} G^{++}  G^{+-} \\ G^{-+}  G^{--} \end{pmatrix} = \begin{pmatrix} G^T  G^> \\ G^  G^{\tilde{T}} \end{pmatrix}
$$
矩阵的各个分量具有明确的物理意义：
- $G^{++} = G^T(t, t')$ 是标准的 **时间排序格林函数**。
- $G^{--} = G^{\tilde{T}}(t, t')$ 是 **反时间排序[格林函数](@entry_id:147802)**。
- $G^{+-} = G^>(t, t')$ 是 **[大格林函数](@entry_id:142137)** (greater Green's function)，与粒子占据态的传播有关。
- $G^{-+} = G^(t, t')$ 是 **[小格林函数](@entry_id:141540)** (lesser Green's function)，与空穴占据态的传播或态的占据情况有关。

尽管这个矩阵包含了系统的全部信息，但其四个分量并非完全独立，存在一定的冗余。为了获得一个更具物理洞察力且计算上更简便的表示，我们进行所谓的 **Keldysh 旋转**。其核心思想是将正向和反向分支上的场 $\phi_1 \equiv \phi_+$ 和 $\phi_2 \equiv \phi_-$ [线性组合](@entry_id:154743)成“经典场”和“量子场”：
$$
\phi_{cl} = \frac{1}{\sqrt{2}}(\phi_1 + \phi_2), \quad \phi_q = \frac{1}{\sqrt{2}}(\phi_1 - \phi_2)
$$
（注意：定义中的归一化因子可能有多种选择，这里采用对称的形式）。这个变换可以用一个旋转矩阵 $R$ 来表示：
$$
\begin{pmatrix} \phi_{cl} \\ \phi_q \end{pmatrix} = R \begin{pmatrix} \phi_1 \\ \phi_2 \end{pmatrix}, \quad \text{with} \quad R = \frac{1}{\sqrt{2}} \begin{pmatrix} 1  1 \\ 1  -1 \end{pmatrix}
$$
[格林函数](@entry_id:147802)作为一个二阶张量，其变换规则为 $\mathbf{G} = R G_c R^T$。执行这个[矩阵变换](@entry_id:156789)后，我们会发现一个惊人的简化：在新的“物理”基或“Keldysh”基中，[格林函数](@entry_id:147802)矩阵呈现出一种 **三角结构** [@problem_id:1157305]：
$$
\mathbf{G} = \begin{pmatrix} G_{cl,cl}  G_{cl,q} \\ G_{q,cl}  G_{q,q} \end{pmatrix} = \begin{pmatrix} G^K  G^R \\ G^A  0 \end{pmatrix}
$$
这里，$G^R$ 和 $G^A$ 分别是标准的 **[推迟格林函数](@entry_id:139183)** ([retarded Green's function](@entry_id:139183)) 和 **超前[格林函数](@entry_id:147802)** (advanced Green's function)，它们描述了系统对微扰的线性响应。$G^K$ 是 **Keldysh 格林函数**，它包含了系统中的涨落和占据信息。$G_{q,q}$ 分量恒为零，这是因果律的直接体现，并极大地简化了理论计算。Keldysh、[大格林函数](@entry_id:142137)和[小格林函数](@entry_id:141540)之间通过 $G^K = G^ + G^>$ 建立联系。

### [自能](@entry_id:145608)与涨落-耗散定理

当系统存在相互作用，或者与外部环境（如[热库](@entry_id:143608)）耦合时，这些效应可以通过 **自能** $\Sigma$ 来系统地描述。在 Keldysh 形式主义中，[戴森方程](@entry_id:146246)（Dyson's equation）同样具有矩阵形式：
$$
G = G_0 + G_0 \Sigma G
$$
其中 $G_0$ 是[无相互作用系统](@entry_id:143064)的格林函数。[自能](@entry_id:145608)矩阵 $\Sigma$ 也可以通过 Keldysh [旋转变换](@entry_id:200017)到物理基，得到其推迟、超前和 Keldysh 分量（$\Sigma^R, \Sigma^A, \Sigma^K$）。

对于一个处于热平衡的系统（例如，一个[热库](@entry_id:143608)），这些[自能](@entry_id:145608)分量并非相互独立，而是由 **涨落-耗散定理 (Fluctuation-Dissipation Theorem, FDT)** 联系在一起。在频率空间中，该定理的一个关键关系是：
$$
\Sigma^K(\omega) = (\Sigma^R(\omega) - \Sigma^A(\omega)) \coth\left(\frac{\hbar\omega}{2k_B T}\right) = 2i \, \text{Im}[\Sigma^R(\omega)] \coth\left(\frac{\hbar\omega}{2k_B T}\right)
$$
这个定理表明，系统的涨落（由 $\Sigma^K$ 描述）与耗散（由 $\Sigma^R$ 的虚部，即 $\text{Im}[\Sigma^R]$ 描述）之间存在着深刻的内在联系。例如，如果我们知道一个热库的耗散性质，例如其谱密度 $J(\omega)$，它与 $\text{Im}[\Sigma_R(\omega)]$ 直接相关，我们就可以通过 FDT 直接确定其对系统施加的噪声或涨落，即 $\Sigma_K(\omega)$ [@problem_id:1157302]。

自能的不同分量具有清晰的物理图像。例如，当一个[量子点](@entry_id:143385)与电子库耦合时，$\Sigma^(\omega)$ 描述了电子从库中隧穿到量子点的速率，它正比于库的电子占据数 $f(\omega)$。而 $\Sigma^>(\omega)$ 描述了电子从量子点隧穿到库中的速率，它正比于库中可供占据的空态数 $1-f(\omega)$。这些关系可以通过具体的计算得到验证，例如，对于一个耦合到[费米子](@entry_id:146235)库的共振能级，其大自能 (greater self-energy) $\Sigma^>(\omega)$ 可以表示为[耦合强度](@entry_id:275517)（或杂化函数）$\Gamma(\omega)$ 和[费米-狄拉克分布](@entry_id:138909)的组合：$\Sigma^>(\omega) = i\Gamma(\omega)[1-f(\omega-\mu)]$ [@problem_id:1157332]。

值得注意的是，实时的 Keldysh 形式主义与[平衡态](@entry_id:168134)下的虚时（松原）形式主义通过[解析延拓](@entry_id:147225)紧密联系。一个在[松原频率](@entry_id:197724) $i\Omega_n$ 上计算的平衡自能 $\Pi(i\Omega_n)$，可以通过解析延拓 $i\Omega_n \to \omega + i\eta$（其中 $\eta$ 为正无穷小）得到其推迟分量 $\Pi^R(\omega)$ [@problem_id:1157317]。这为结合两种方法的优势提供了桥梁。

### 在[量子输运](@entry_id:138932)与动力学中的应用

Keldysh 形式主义最强大的应用领域之一是[量子输运](@entry_id:138932)。它为处理非平衡稳态和瞬态动力学提供了统一而严谨的框架。

#### [量子动理学方程](@entry_id:137964)

从矩阵形式的[戴森方程](@entry_id:146246)出发，并利用 **Langreth 规则**（它给出了轮廓上两个函数乘积的各分量的表达式，例如 $(AB)^ = A^R B^ + A^ B^A$），我们可以推导出一系列方程来描述系统的动力学。其中，最重要的方程之一是[小格林函数](@entry_id:141540) $G^$ 所满足的方程，通常称为 **Keldysh 方程**：
$$
G^(\omega) = G^R(\omega) \Sigma^(\omega) G^A(\omega)
$$
这个方程有着非常直观的物理诠释：系统的非平衡占据情况（由 $G^$ 描述）是由外部源（$\Sigma^$，例如来自电极的注入）决定的，并通过系统自身的谱特性（由 $G^R$ 和 $G^A$ 的乘积，即[谱函数](@entry_id:147628) $A(\omega)$ 描述）进行“过滤”。

在[稳态](@entry_id:182458)条件下，系统达到一种动态平衡，此时[量子动理学方程](@entry_id:137964)成立。这等价于所谓的“[碰撞积分](@entry_id:152100)”为零。[碰撞积分](@entry_id:152100)定义为[自能](@entry_id:145608)与[格林函数](@entry_id:147802)对易子的小分量 $[G, \Sigma]^ \equiv (G\Sigma)^ - (\Sigma G)^$。对于一个处于[稳态](@entry_id:182458)的单能级[量子点模型](@entry_id:266819)，可以利用 Langreth 规则直接证明该[碰撞积分](@entry_id:152100)为零 [@problem_id:1157344]，这正是[稳态](@entry_id:182458)输运得以建立的基础。

#### [稳态](@entry_id:182458)输运

基于 Keldysh 形式主义，Meir 和 Wingreen 推导出了一个计算通过相互作用区域的电流的普适公式。对于非相互作用系统，该公式可以简化为我们所熟知的 Landauer-Büttiker 形式，其中电流由电子在不同能量下的[透射概率](@entry_id:137943) $\mathcal{T}(\omega)$ 决定。对于一个共振能级模型，[透射概率](@entry_id:137943)可以表示为：
$$
\mathcal{T}(\omega) = \Gamma_L(\omega) \Gamma_R(\omega) |G^R(\omega)|^2
$$
其中 $\Gamma_{L/R}(\omega)$ 是左右电极的耦合强度，$G^R(\omega)$ 是系统的全[推迟格林函数](@entry_id:139183)。

利用这个框架，我们可以计算各种[输运性质](@entry_id:203130)：
- **[电荷](@entry_id:275494)流和热流**：通过对[能量积分](@entry_id:166228)，可以计算[电荷](@entry_id:275494)流和热导 [@problem_id:1157304]。
- **电流噪声**：除了平均电流，我们还可以计算电流的涨落，即散粒噪声。这为探测[输运过程](@entry_id:177992)中的[电荷量子化](@entry_id:150600)和关联效应提供了重要信息。例如，可以计算 Fano 因子 $F = S/(2e|I|)$ [@problem_id:1157340] 或[散粒噪声](@entry_id:140025)功率本身 [@problem_id:1157320]。
- **[隧穿谱学](@entry_id:139081)**：通过测量[微分](@entry_id:158718)[电导](@entry_id:177131) $dI/dV$，我们可以探测系统的[局域态密度](@entry_id:136852)。这在研究[超导体](@entry_id:191025)等具有复杂能谱的材料时尤为强大。例如，我们可以分析正常金属-绝缘体-[超导体](@entry_id:191025)（NIS）结的隧穿谱，从而揭示[超导能隙](@entry_id:145058)的结构 [@problem_id:1157325] [@problem_id:1157323]。
- **非平衡占据**：Keldysh 形式主义还允许我们计算系统在非平衡驱动下的有效能量[分布](@entry_id:182848)。例如，可以定义一个 **有效占据数** $f_{\text{eff}}(\omega) = iG^(\omega)/A(\omega)$，它描述了在能量 $\omega$ 的态在非平衡稳态下的等效占据概率。对于一个偏压下的量子点，这个占据数通常是左右电极费米函数的加权平均值 [@problem_id:1157328]。

#### 瞬态动力学

Keldysh 形式主义的另一个强大之处在于它能够精确描述系统对外部参数突变的响应，即所谓的 **[量子淬火](@entry_id:145899)** (quantum quench) 问题。例如，我们可以研究一个原本孤立的量子点在 $t=0$ 时刻突然与电极耦合后，其电子占据数 $n(t)$ 随时间的演化。计算表明，占据数会从初始值（例如 0）弛豫到其[稳态](@entry_id:182458)值，弛豫过程通常呈指数形式，其速率由[耦合强度](@entry_id:275517) $\Gamma$ 决定 [@problem_id:1157293]。对于非相互作用系统，高阶关联函数可以分解为低阶关联函数的乘积，例如，双占据的[期望值](@entry_id:153208)等于单占据[期望值](@entry_id:153208)的平方 $\langle n_\uparrow(t) n_\downarrow(t) \rangle = \langle n_\uparrow(t) \rangle \langle n_\downarrow(t) \rangle$ [@problem_id:1157288]。

### 高级主题与扩展

Keldysh 形式主义是一个广阔的领域，为处理各种复杂的非[平衡问题](@entry_id:636409)提供了基础。

#### [路径积分表述](@entry_id:145051)

除了算符方法，Keldysh 形式主义也可以用路径积分来表述。此时，我们需要在 Keldysh 轮廓上对场的所有可能历史进行积分。系统的[生成泛函](@entry_id:152688)可以写为 $Z_K = \int \mathcal{D}q_+ \mathcal{D}q_- e^{iS_K[q_+, q_-]/\hbar}$。在旋转到“经典-量子”基 ($q_{cl}, q_q$) 后，作用量 $S_K$ 具有一种特殊的结构。一个非常深刻的结果是，系统的经典[运动方程](@entry_id:170720)可以通过对量子场 $q_q$ 取作用量的泛函变分并令其为零得到。这优雅地展示了[经典动力学](@entry_id:177360)是如何作为量子理论的平均场近似而出现的。例如，对于一个受驱动的阻尼量子谐振子，其[吸收功率](@entry_id:265908)的计算可以通过此方法大大简化 [@problem_id:1157283]。

#### 相互作用与自洽计算

对于相互作用系统，自能 $\Sigma$ 本身就依赖于格林函数 $G$，这导致了 **自洽** 计算的需求。一个简单的例子是处理[量子点](@entry_id:143385)上[库仑相互作用](@entry_id:747947)的 **Hartree 近似**。在该近似下，自旋为 $\sigma$ 的电子感受到的自能正比于相反自旋 $-\sigma$ 电子的平均占据数 $\langle n_{-\sigma} \rangle$，即 $\Sigma^R_\sigma = U \langle n_{-\sigma} \rangle$。由于 $\langle n_{-\sigma} \rangle$ 又通过[格林函数](@entry_id:147802)依赖于 $\Sigma$，因此必须迭代求解直至收敛 [@problem_id:1157312]。

#### 强关联系统：[从属玻色子方法](@entry_id:136652)

对于强关联系统（例如 $U \to \infty$ 的[安德森杂质模型](@entry_id:137939)），简单的平均场理论可能失效。此时可以采用更复杂的方法，如 **从属粒子 (slave-particle) 方法**。在[从属玻色子方法](@entry_id:136652)中，一个物理电子算符被分解为一个赝[费米子](@entry_id:146235)（[自旋子](@entry_id:140415)）和一个[从属玻色子](@entry_id:137816)的乘积，并引入一个约束来排除双占据。在[平均场近似](@entry_id:144121)下，[玻色子](@entry_id:138266)场被其[期望值](@entry_id:153208)取代，从而将原问题映射到一个具有[重整化参数](@entry_id:146915)的有效共振能级模型。将此方法与 Keldysh 形式主义结合，可以计算强关联系统（如近藤（Kondo）体系）的非平衡性质，例如其在费米能级处展现出的尖锐[谱函数](@entry_id:147628)峰，即[近藤共振](@entry_id:140159) [@problem_id:1157341]。

#### [全计数统计](@entry_id:141114) (Full Counting Statistics, FCS)

Keldysh 形式主义还为 **[全计数统计](@entry_id:141114) (FCS)** 提供了理论基础。FCS 的目标是计算在给定时间内通过导体的[电荷](@entry_id:275494)数 $N$ 的完整[概率分布](@entry_id:146404) $P(N)$，而不仅仅是其平均值（电流）和[方差](@entry_id:200758)（噪声）。这个[分布](@entry_id:182848)的所有信息都包含在其各阶累积量 $C_n$ 中。例如，$C_3$ 描述了[分布](@entry_id:182848)的偏斜度。利用 Levitov-Lesovik 公式，这些累积量可以表示为[透射概率](@entry_id:137943) $T(E)$ 的不同组合在能量上的积分。例如，我们可以计算出高偏压下共振能级输运的第三[累积量](@entry_id:152982) [@problem_id:1157292]，从而获得超出传统噪声测量的更精细信息。