{"hands_on_practices": [{"introduction": "核磁共振量子计算中的基本任务是精确操控单个量子比特。理论上理想的整形脉冲（如sinc脉冲）可以实现频率选择性激发，但在实践中，它们通常通过一系列短而强的“硬脉冲”来近似。这个练习 ([@problem_id:106545]) 引导我们使用硬脉冲近似来构建一个选择性$\\pi$脉冲，并计算其对离共振自旋的最终影响，这有助于我们理解脉冲工程的基本原理和布洛赫矢量在旋转坐标系中的演化。", "problem": "在核磁共振 (NMR) 量子计算中，使用整形射频 (RF) 脉冲对量子比特（核自旋）进行选择性旋转。一种常见的选择性脉冲是 sinc 脉冲，在理想情况下，它会激发一个矩形频率片。在实践中，sinc 脉冲必须在时间上被截断，并且通常实现为一系列短时、高功率的“硬”脉冲与自由进动周期交错的序列。这被称为硬脉冲近似或 DANGO (D'Ari and Glover)。\n\n考虑一个自旋-1/2 的原子核，初始处于沿 z 轴的自旋向上态，由态矢量 $|\\psi_i\\rangle = |0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 描述。该自旋相对于射频载波频率有一个共振频率偏移 $\\Delta\\omega$。该量子比特受到一个脉冲序列的作用，该序列近似于一个截断的 sinc $\\pi$ 脉冲。该序列由三个沿旋转坐标系 x 轴施加的瞬时硬脉冲组成，脉冲之间由两个相同的自由进动延迟隔开。\n\n演化由幺正算符序列 $U = U_3 U_D U_2 U_D U_1$ 描述，其中 $U_k = e^{-i\\frac{\\theta_k}{2}\\sigma_x}$ 是第 $k$ 个硬脉冲的算符，其翻转角为 $\\theta_k$，而 $U_D = e^{-i H_{off} \\Delta t / \\hbar}$ 是持续时间为 $\\Delta t$ 的延迟的自由进动算符。在旋转坐标系中的失谐哈密顿量为 $H_{off} = \\frac{\\hbar \\Delta\\omega}{2} \\sigma_z$。这里，$\\sigma_x$ 和 $\\sigma_z$ 是泡利矩阵。\n\n该脉冲序列是对称的，具有以下参数：\n- 第一个和第三个脉冲的翻转角：$\\theta_1 = \\theta_3 = \\theta_a = \\frac{\\pi}{4}$\n- 中心脉冲的翻转角：$\\theta_2 = \\theta_b = \\frac{\\pi}{2}$\n- 在每个延迟间隔期间，由于自由进动累积的总相位为 $\\phi = \\Delta\\omega \\Delta t = \\frac{\\pi}{2}$。\n\n计算最终的布居数反转，其定义为泡利 Z 算符的期望值 $\\langle\\sigma_z\\rangle_f = \\langle\\psi_f|\\sigma_z|\\psi_f\\rangle$，其中 $|\\psi_f\\rangle = U|\\psi_i\\rangle$ 是自旋的最终状态。", "solution": "我们在布洛赫矢量图像中进行计算，其中幺正变换 \n$$U=R_x(\\theta_a)\\,R_z(\\phi)\\,R_x(\\theta_b)\\,R_z(\\phi)\\,R_x(\\theta_a)$$ \n将初始布洛赫矢量 $r_0=(0,0,1)$ 旋转为 $r_f=R\\,r_0$。此处 \n$$R_x(\\alpha)=\\begin{pmatrix}\n1  0  0 \\\\ 0  \\cos\\alpha  -\\sin\\alpha \\\\ 0  \\sin\\alpha  \\cos\\alpha\n\\end{pmatrix},\\quad\nR_z(\\beta)=\\begin{pmatrix}\n\\cos\\beta  -\\sin\\beta  0 \\\\ \\sin\\beta  \\cos\\beta  0 \\\\ 0  0  1\n\\end{pmatrix}.$$\n\n给定 $\\theta_a=\\pi/4,\\;\\theta_b=\\pi/2,\\;\\phi=\\pi/2$，我们依次计算：\n1. 经过 $R_x(\\pi/4)$ 之后：\n   $$r_1=(0,\\,-\\sin\\tfrac\\pi4,\\;\\cos\\tfrac\\pi4)=(0,-\\tfrac1{\\sqrt2},\\tfrac1{\\sqrt2}).$$\n2. 经过 $R_z(\\pi/2)$ 之后：\n   $$r_2=\\bigl(\\tfrac1{\\sqrt2},\\,0,\\;\\tfrac1{\\sqrt2}\\bigr).$$\n3. 经过 $R_x(\\pi/2)$ 之后：\n   $$r_3=\\bigl(\\tfrac1{\\sqrt2},\\,-\\tfrac1{\\sqrt2},\\,0\\bigr).$$\n4. 经过第二个 $R_z(\\pi/2)$ 之后：\n   $$r_4=\\bigl(\\tfrac1{\\sqrt2},\\,\\tfrac1{\\sqrt2},\\,0\\bigr).$$\n5. 经过最后的 $R_x(\\pi/4)$ 之后：\n   $$r_f=\\Bigl(\\tfrac1{\\sqrt2},\\;\\tfrac12,\\;\\tfrac12\\Bigr).$$\n\n最终的布居数反转是 $r_f$ 的 z 分量，\n$$\\langle\\sigma_z\\rangle_f = r_{f,z} = \\tfrac12.$$", "answer": "$$\\boxed{\\frac12}$$", "id": "106545"}, {"introduction": "通用量子计算需要高保真度的双量子比特门。这个练习 ([@problem_id:106530]) 探究了一种通过射频脉冲实现双比特SWAP门的方法，并立即引入了核磁共振量子计算中的一个核心挑战：在施加控制脉冲的同时，系统内部的J耦合演化也在持续进行。通过计算在这种实际情况下的门保真度损失，我们学会了如何量化这种“串扰”效应对量子门性能的影响，这是设计和评估量子算法时的一项关键技能。", "problem": "在核磁共振 (NMR) 量子计算的背景下，考虑一个由两个弱耦合的自旋1/2粒子（量子比特）组成的系统。两个自旋之间的相互作用由J耦合哈密顿量描述：\n$$\nH_J = \\frac{h J}{4} \\sigma_z^{(1)} \\otimes \\sigma_z^{(2)}\n$$\n其中 $J$ 是以赫兹为单位的耦合常数，$h$ 是普朗克常数，$\\sigma_z^{(k)}$ 是第 $k$ 个量子比特的Pauli Z矩阵。\n\n通过同时向两个自旋施加一个强的、共振的、矩形射频 (RF) 脉冲来实现一个特定的量子门。该脉冲在旋转坐标系中沿x轴方向施加，持续时间为 $\\tau$。该脉冲是一个“$\\pi$脉冲”，意味着在理想情况下，它会引起绕x轴 $\\pi$ 角度的旋转。这个射频脉冲的哈密顿量由下式给出：\n$$\nH_{RF} = \\frac{h}{4\\tau} \\left(\\sigma_x^{(1)} + \\sigma_x^{(2)}\\right)\n$$\n在施加脉冲期间，J耦合演化是不可忽略的。因此，在脉冲期间系统的总哈密顿量为 $H = H_{RF} + H_J$。\n\n理想门操作 $U_{ideal}$ 定义为仅在射频脉冲作用下的演化（即，当 $J=0$ 时）：\n$$\nU_{ideal} = \\exp\\left(-\\frac{i H_{RF} \\tau}{\\hbar}\\right)\n$$\n实际实现的门 $U_{impl}$ 是在总哈密顿量 $H$ 下的演化：\n$$\nU_{impl} = \\exp\\left(-\\frac{i H \\tau}{\\hbar}\\right)\n$$\n实现的质量由门保真度 $F = \\frac{1}{16} \\left| \\text{Tr}\\left(U_{ideal}^\\dagger U_{impl}\\right) \\right|^2$ 来衡量。\n\n假设耦合很弱，使得无量纲参数 $J\\tau \\ll 1$，计算门不忠实度 $\\mathcal{I} = 1 - F$ 到 $J\\tau$ 的最低非零阶。请用 $J$ 和 $\\tau$ 表示你的答案。", "solution": "1. 脉冲期间旋转坐标系中的总哈密顿量为\n$$\nH = H_{RF} + H_J,\\quad\nH_{RF} = \\hbar\\frac{\\omega_{\\rm rf}}{2}(\\sigma_x^{(1)}+\\sigma_x^{(2)}),\\;\nH_J = \\hbar\\omega_J\\,\\sigma_z^{(1)}\\sigma_z^{(2)},\n$$  \n其中 $\\omega_{\\rm rf}=\\pi/\\tau$（从而实现一个$\\pi$脉冲），且 $\\omega_J=\\pi J/2$。\n\n2. 在 $H_{RF}$ 的相互作用绘景中，耦合项为\n$$\n\\tilde H_J(t)\n=e^{\\,iH_{RF}t/\\hbar}\\,H_J\\,e^{-\\,iH_{RF}t/\\hbar}\n=\\hbar\\omega_J\\,(R_x^{(1)}(\\omega_{\\rm rf}t)\\otimes R_x^{(2)}(\\omega_{\\rm rf}t))\n\\,\\sigma_z^{(1)}\\sigma_z^{(2)}\n\\,(R_x^{(1)}(\\omega_{\\rm rf}t)\\otimes R_x^{(2)}(\\omega_{\\rm rf}t))^\\dagger.\n$$\n将每个 $\\sigma_z$ 旋转为 $\\sigma_z\\cos\\theta+\\sigma_y\\sin\\theta$（其中 $\\theta=\\omega_{\\rm rf}t$），可以得到\n$$\n\\tilde H_J(t)=\\hbar\\omega_J\\big[\\sigma_z^{(1)}\\sigma_z^{(2)}\\cos^2\\theta\n+(\\sigma_z^{(1)}\\sigma_y^{(2)}+\\sigma_y^{(1)}\\sigma_z^{(2)})\\cos\\theta\\sin\\theta\n+\\sigma_y^{(1)}\\sigma_y^{(2)}\\sin^2\\theta\\big].\n$$\n\n3. 一阶相互作用绘景传播子是\n$$\nK=\\frac{1}{\\hbar}\\int_0^\\tau\\tilde H_J(t)\\,dt\n=\\omega_J\\!\\int_0^\\tau\\big[\\sigma_z^{(1)}\\sigma_z^{(2)}\\cos^2\\theta\n+\\cdots+\\sigma_y^{(1)}\\sigma_y^{(2)}\\sin^2\\theta\\big]dt.\n$$\n使用 $\\int_0^\\tau\\cos^2\\theta\\,dt=\\int_0^\\tau\\sin^2\\theta\\,dt=\\tau/2$ 和 $\\int_0^\\tau\\sin\\theta\\cos\\theta\\,dt=0$ 可得\n$$\nK=\\frac{\\omega_J\\tau}{2}\\big(\\sigma_z^{(1)}\\sigma_z^{(2)}+\\sigma_y^{(1)}\\sigma_y^{(2)}\\big).\n$$\n\n4. 保真度为\n$$\nF=\\frac{1}{16}\\big|\\Tr(e^{-iK})\\big|^2\n\\approx1-\\frac{\\Tr(K^2)}{4}+\\cdots.\n$$\n计算\n$$\nK^2=\\Big(\\frac{\\omega_J\\tau}{2}\\Big)^2\\big(\\sigma_z\\sigma_z+\\sigma_y\\sigma_y\\big)^2,\n\\quad(\\sigma_z\\sigma_z+\\sigma_y\\sigma_y)^2=2I-2\\,\\sigma_x\\sigma_x,\n$$\n因此 $\\Tr(K^2)=8(\\omega_J\\tau/2)^2=2(\\omega_J\\tau)^2$。所以\n$$\n\\mathcal I=1-F\\approx\\frac{\\Tr(K^2)}{4}=\\frac{(\\omega_J\\tau)^2}{2}\n=\\frac{\\big(\\frac{\\pi J}{2}\\tau\\big)^2}{2}\n=\\frac{\\pi^2J^2\\tau^2}{8}.\n$$", "answer": "$$\\boxed{\\frac{\\pi^2J^2\\tau^2}{8}}$$", "id": "106530"}, {"introduction": "液态核磁共振本质上是对大量分子进行的系综测量，这是其区别于其他量子计算平台的关键特征。这个练习 ([@problem_id:106548]) 模拟了样品中存在的静态磁场梯度（一种空间不均匀性）如何影响量子态的制备。我们将看到，一个在单个分子上能够制备纯纠缠态的操作序列，在整个系综上却会因为退相干而产生一个混合态，通过计算系综终态的纯度，我们可以具体地衡量这种不均匀性所导致的信息损失。", "problem": "在液态核磁共振（NMR）量子计算的背景下，考虑一个由两个耦合的自旋1/2粒子（量子比特 A 和量子比特 B）组成的系统，它们具有不同的旋磁比 $\\gamma_A$ 和 $\\gamma_B$。目标是制备一个双量子比特的贝尔态。\n\n该系统初始制备在纯态 $|\\psi_0\\rangle = |00\\rangle$ 上。施加以下操作序列：\n1.  一个理想的、瞬时的 Hadamard 门施加于量子比特 A。\n2.  系统经历一段持续时间为 $T$ 的自由演化。在此期间，系统受到一个与主量子化轴 $\\hat{z}$ 对齐的静态线性磁场梯度 $\\vec{G}$ 的作用，即 $\\vec{G} = G \\hat{z}$。包含分子的样品沿 $z$ 轴在长度为 $L$ 的范围内均匀分布，中心在 $z=0$ 处（从 $z=-L/2$ 到 $z=L/2$）。控制此自由演化的哈密顿量仅由梯度引起，由 $H(z) = \\frac{\\hbar}{2} (\\delta\\omega_A(z) \\sigma_z^A + \\delta\\omega_B(z) \\sigma_z^B)$ 给出，其中 $\\sigma_z^i$ 是量子比特 $i$ 的泡利 Z 算符，$\\delta\\omega_i(z) = \\gamma_i G z$ 是与位置相关的拉莫尔频率偏移。J耦合和化学位移效应在此期间被认为是重聚焦的。\n3.  自由演化之后，施加一个理想的、瞬时的受控非门（CNOT），其中量子比特 A 为控制位，量子比特 B 为目标位。CNOT 的作用定义为 $U_{CNOT}|x,y\\rangle = |x, x \\oplus y\\rangle$，其中 $x, y \\in \\{0, 1\\}$ 且 $\\oplus$ 表示模2加法。\n\n由于与位置相关的演化，在位置 $z$ 处一个分子的末态 $\\rho(z)$ 与其他分子的末态不同。整个系综的末态是一个混合态 $\\bar{\\rho}$，它是通过对样品中所有分子的位置进行平均得到的。\n\n计算这个最终系综平均态 $\\bar{\\rho}$ 的纯度 $P = \\text{Tr}(\\bar{\\rho}^2)$。请用给定的符号参数 $\\gamma_A$、 $G$、 $T$ 和 $L$ 将您的答案表示为封闭形式的解析表达式。", "solution": "1. 在对量子比特 A 施加 Hadamard 门之后，\n$$|\\psi_1\\rangle = \\frac{1}{\\sqrt2}(|0\\rangle_A+|1\\rangle_A)\\otimes|0\\rangle_B\n=\\frac1{\\sqrt2}\\bigl(|00\\rangle+|10\\rangle\\bigr)\\,. $$\n\n2. 在位置 $z$ 处自由演化期间，\n$$H(z)=\\frac\\hbar2\\bigl(\\delta\\omega_A(z)\\,\\sigma_z^A+\\delta\\omega_B(z)\\,\\sigma_z^B\\bigr),\\quad\n\\delta\\omega_i(z)=\\gamma_i\\,G\\,z,$$\n所以\n$$U(z)=\\exp\\!\\Bigl[-\\frac{iT}{\\hbar}H(z)\\Bigr]\n=\\exp\\!\\Bigl[-\\frac{iT}{2}\\bigl(\\delta\\omega_A\\sigma_z^A+\\delta\\omega_B\\sigma_z^B\\bigr)\\Bigr] \n=U_A\\otimes U_B$$\n其中\n$$U_i|0\\rangle_i=e^{-i\\,\\delta\\omega_iT/2}|0\\rangle_i,\\quad\nU_i|1\\rangle_i=e^{\\,i\\,\\delta\\omega_iT/2}|1\\rangle_i.$$\n\n3. 作用于 $|\\psi_1\\rangle$ 上，\n$$U(z)\\,|\\psi_1\\rangle\n=\\frac1{\\sqrt2}\\Bigl(e^{-i(\\phi_A+\\phi_B)}|00\\rangle\n+e^{\\,i(\\phi_A-\\phi_B)}|10\\rangle\\Bigr),\\quad\n\\phi_i=\\frac{\\delta\\omega_iT}{2}.$$\n\n4. CNOT$(A\\to B)$ 门将 $|00\\rangle\\to|00\\rangle,\\;|10\\rangle\\to|11\\rangle$，得到\n$$|\\psi(z)\\rangle\n=\\frac{e^{-i(\\phi_A+\\phi_B)}}{\\sqrt2}\\Bigl(|00\\rangle\n+e^{\\,i2\\phi_A}\\,|11\\rangle\\Bigr)\n\\;\\widehat{=}\\;\\frac1{\\sqrt2}\\bigl(|00\\rangle+e^{i\\,\\Delta(z)}|11\\rangle\\bigr),$$\n其中\n$$\\Delta(z)=2\\phi_A=\\delta\\omega_A(z)\\,T=\\gamma_A\\,G\\,T\\,z.$$\n\n5. 在 $z$ 处的纯态为\n$$\\rho(z)=|\\psi(z)\\rangle\\langle\\psi(z)|\n=\\frac12\\Bigl(|00\\rangle\\langle00|+|11\\rangle\\langle11|\n+e^{-i\\Delta(z)}|00\\rangle\\langle11|+e^{i\\Delta(z)}|11\\rangle\\langle00|\\Bigr).$$\n\n6. 在 $z\\in[-L/2,L/2]$ 上均匀平均，\n$$\\bar\\rho=\\frac1L\\int_{-L/2}^{L/2}\\rho(z)\\,dz\n=\\frac12\\Bigl(|00\\rangle\\langle00|+|11\\rangle\\langle11|\\Bigr)\n+\\frac12\\,M\\,\\bigl(|00\\rangle\\langle11|+|11\\rangle\\langle00|\\bigr),$$\n其中\n$$M=\\frac1L\\int_{-L/2}^{L/2}e^{-i\\gamma_A G T z}\\,dz\n=\\frac{2}{\\gamma_A G T\\,L}\\,\\sin\\!\\Bigl(\\tfrac{\\gamma_A G T\\,L}{2}\\Bigr)\n=\\mathrm{sinc}\\!\\Bigl(\\tfrac{\\gamma_A G T\\,L}{2}\\Bigr).$$\n\n7. 在 $\\{|00\\rangle,|11\\rangle\\}$ 子空间中，\n$$\\bar\\rho=\\frac12\\begin{pmatrix}1  M\\\\ M  1\\end{pmatrix},$$\n所以\n$$\\bar\\rho^2=\\frac{1}{4}\\begin{pmatrix}1+M^22M\\\\2M1+M^2\\end{pmatrix},\\quad\nP=\\Tr(\\bar\\rho^2)=\\frac12\\bigl(1+M^2\\bigr).$$\n\n8. 代入 $M=\\sin(\\tfrac{\\gamma_AGTL}{2})/(\\tfrac{\\gamma_AGTL}{2})$ 得到\n$$P=\\frac12\\Biggl[1+\\Bigl(\\frac{\\sin\\!\\bigl(\\tfrac{\\gamma_A G T L}{2}\\bigr)}{\\tfrac{\\gamma_A G T L}{2}}\\Bigr)^{\\!2}\\Biggr].$$", "answer": "$$\\boxed{\\frac12\\Bigl[1+\\Bigl(\\frac{\\sin\\!\\bigl(\\tfrac{\\gamma_A G T L}{2}\\bigr)}{\\tfrac{\\gamma_A G T L}{2}}\\Bigr)^{\\!2}\\Bigr]}$$", "id": "106548"}]}