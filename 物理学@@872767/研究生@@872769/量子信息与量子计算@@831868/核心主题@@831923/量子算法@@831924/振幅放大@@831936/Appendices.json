{"hands_on_practices": [{"introduction": "掌握了振幅放大的基本原理后，首要的实践步骤是将其应用于理想化的场景中。这个练习将帮助你熟悉核心公式，该公式描述了在经过特定次数的迭代后，找到标记量子态的成功概率。通过解决这个问题 ([@problem_id:45105])，你将能够在一个无误差的理想环境中，巩固对初始成功概率、迭代次数和最终放大后概率之间关系的理解。", "problem": "在量子力学的振幅放大过程中，我们的目标是增加测量到期望的“标记”量子态 $|w\\rangle$ 的概率。该过程从一个初始态 $|\\psi\\rangle$ 开始，这个初始态由某个算法 $A$ 制备，并可以在标记态 $|w\\rangle$ 及其正交补 $|\\chi\\rangle$ 的基中分解为 $|\\psi\\rangle = \\sin(\\theta)|w\\rangle + \\cos(\\theta)|\\chi\\rangle$。初始成功概率，即从 $|\\psi\\rangle$ 中测量到 $|w\\rangle$ 的概率为 $a = |\\langle w|\\psi\\rangle|^2 = \\sin^2(\\theta)$。\n\n振幅放大算法的核心是迭代应用振幅放大算子 $Q = U_\\psi U_w$，其中 $U_w = I - 2|w\\rangle\\langle w|$ 是翻转标记态相位的神谕算符，$U_\\psi = 2|\\psi\\rangle\\langle\\psi| - I$ 是关于初始态 $|\\psi\\rangle$ 进行反射的扩散算符。可以证明，将算符 $Q$ 对初始态 $|\\psi\\rangle$ 应用 $k$ 次，会得到量子态 $|\\psi_k\\rangle = Q^k |\\psi\\rangle$。在此过程中，标记态 $|w\\rangle$ 的振幅被放大。经过 $k$ 步迭代后，测量到 $|w\\rangle$ 的概率由以下公式给出：\n$$P_k = \\sin^2((2k+1)\\theta)$$\n\n考虑一个数据库中的搜索问题，该数据库由一个维度为 $N=256$ 的希尔伯特空间表示。一个算法 $A$ 制备了一个初始态 $|\\psi\\rangle$，它与单个标记态 $|w\\rangle$ 有交叠，产生的初始成功概率为 $a=1/16$。计算在执行 $k=3$ 次振幅放大过程迭代后，精确的成功概率 $P_k$。", "solution": "初始成功概率为 $a = \\sin^2(\\theta) = \\frac{1}{16}$。因此，\n\n$$\n\\sin(\\theta) = \\sqrt{\\frac{1}{16}} = \\frac{1}{4},\n$$\n\n因为 $\\theta \\in [0, \\pi/2]$。经过 $k$ 次迭代后的概率为\n\n$$\nP_k = \\sin^2((2k+1)\\theta).\n$$\n\n对于 $k = 3$，\n\n$$\nP_3 = \\sin^2((2 \\cdot 3 + 1)\\theta) = \\sin^2(7\\theta).\n$$\n\n为了计算 $\\sin(7\\theta)$，使用多倍角公式：\n\n$$\n\\sin(7\\theta) = \\sin(\\theta) \\left(7 - 56 \\sin^2(\\theta) + 112 \\sin^4(\\theta) - 64 \\sin^6(\\theta)\\right).\n$$\n\n代入 $\\sin(\\theta) = \\frac{1}{4}$：\n\n$$\n\\sin(7\\theta) = \\frac{1}{4} \\left(7 - 56 \\left(\\frac{1}{4}\\right)^2 + 112 \\left(\\frac{1}{4}\\right)^4 - 64 \\left(\\frac{1}{4}\\right)^6\\right).\n$$\n\n计算幂次：\n\n$$\n\\left(\\frac{1}{4}\\right)^2 = \\frac{1}{16}, \\quad \\left(\\frac{1}{4}\\right)^4 = \\frac{1}{256}, \\quad \\left(\\frac{1}{4}\\right)^6 = \\frac{1}{4096}.\n$$\n\n代入：\n\n$$\n\\sin(7\\theta) = \\frac{1}{4} \\left(7 - 56 \\cdot \\frac{1}{16} + 112 \\cdot \\frac{1}{256} - 64 \\cdot \\frac{1}{4096}\\right).\n$$\n\n化简每一项：\n\n$$\n56 \\cdot \\frac{1}{16} = \\frac{56}{16} = \\frac{7}{2}, \\quad 112 \\cdot \\frac{1}{256} = \\frac{112}{256} = \\frac{7}{16}, \\quad 64 \\cdot \\frac{1}{4096} = \\frac{64}{4096} = \\frac{1}{64}.\n$$\n\n所以，\n\n$$\n\\sin(7\\theta) = \\frac{1}{4} \\left(7 - \\frac{7}{2} + \\frac{7}{16} - \\frac{1}{64}\\right).\n$$\n\n将括号内的各项通分，使用公分母 64：\n\n$$\n7 = \\frac{448}{64}, \\quad \\frac{7}{2} = \\frac{224}{64}, \\quad \\frac{7}{16} = \\frac{28}{64}, \\quad \\frac{1}{64} = \\frac{1}{64}\n$$\n\n\n$$\n7 - \\frac{7}{2} + \\frac{7}{16} - \\frac{1}{64} = \\frac{448}{64} - \\frac{224}{64} + \\frac{28}{64} - \\frac{1}{64} = \\frac{448 - 224 + 28 - 1}{64} = \\frac{251}{64}.\n$$\n\n因此，\n\n$$\n\\sin(7\\theta) = \\frac{1}{4} \\cdot \\frac{251}{64} = \\frac{251}{256}.\n$$\n\n最后，\n\n$$\nP_3 = \\sin^2(7\\theta) = \\left(\\frac{251}{256}\\right)^2 = \\frac{251^2}{256^2}.\n$$\n\n计算：\n\n$$\n251^2 = 63001, \\quad 256^2 = 65536,\n$$\n\n所以\n\n$$\nP_3 = \\frac{63001}{65536}.\n$$\n\n该分数已是最简形式，因为 63001 和 65536 没有公因数（65536 是 2 的幂，而 63001 是奇数）。", "answer": "$$\\boxed{\\dfrac{63001}{65536}}$$", "id": "45105"}, {"introduction": "在理想化的计算之后，我们来探讨一个更贴近现实的场景：量子操作中的相干误差。这个练习模拟了一个有缺陷的“神谕”（oracle），它没有完美地标记目标态，而是在其上施加了一个错误的相位。通过分析这个问题 ([@problem_id:45186])，你将不再仅仅是套用公式，而是需要一步步追踪量子态的演化，从而深化对Grover算法几何图像以及相干误差如何影响算法性能的理解。", "problem": "考虑一个$N$维希尔伯特空间中的量子搜索问题，其规范正交基为 $\\{|0\\rangle, |1\\rangle, \\dots, |N-1\\rangle\\}$。存在一个唯一的“标记”态，记为 $|w\\rangle$。该算法从均匀叠加态开始：\n$$|\\psi_0\\rangle = \\frac{1}{\\sqrt{N}}\\sum_{x=0}^{N-1} |x\\rangle$$\n\n一次标准的Grover迭代包括应用算子 $G = U_s U_w$，其中 $U_w$ 是神谕，$U_s$ 是扩散算子。扩散算子定义为 $U_s = 2|\\psi_0\\rangle\\langle \\psi_0| - I$，其中 $I$ 是单位算子。\n\n一个正确的神谕 $U_w$ 通过施加一个-1的相位来标记量子态 $|w\\rangle$，即 $U_w = I - 2|w\\rangle\\langle w|$。在本问题中，我们有一个有缺陷的神谕 $U_w(\\phi)$，它对标记态施加一个 $e^{i\\phi}$ 的相位。其作用定义为：\n$$\nU_w(\\phi) |x\\rangle = \\begin{cases} e^{i\\phi} |x\\rangle  \\text{if } x=w \\\\ |x\\rangle  \\text{if } x\\neq w \\end{cases}\n$$\n这个有缺陷的神谕可以写成算子 $U_w(\\phi) = I + (e^{i\\phi}-1)|w\\rangle\\langle w|$。\n\n经过一次这种修正的Grover算法迭代后，系统的状态为 $|\\psi_1\\rangle = U_s U_w(\\phi) |\\psi_0\\rangle$。\n\n你的任务是计算在这一次迭代后测量得到标记态 $|w\\rangle$ 的概率，即 $P(w) = |\\langle w | \\psi_1 \\rangle|^2$。请给出在搜索空间大小 $N=8$ 且有缺陷神谕的相位为 $\\phi = 3\\pi/4$ 的特定情况下的精确解析表达式。", "solution": "我们在由标记态 $|w\\rangle$ 和其他态的等幅叠加所张成的二维子空间中进行计算\n$$|\\alpha\\rangle=\\frac{1}{\\sqrt{N-1}}\\sum_{x\\neq w}|x\\rangle.$$ \n定义 \n$$s=\\frac{1}{\\sqrt{N}},\\qquad c=\\sqrt{\\frac{N-1}{N}},\\qquad|\\psi_0\\rangle=s|w\\rangle+c|\\alpha\\rangle.$$\n有缺陷的神谕作用后得到\n$$|\\psi'\\rangle=U_w(\\phi)|\\psi_0\\rangle\n=s\\,e^{i\\phi}|w\\rangle+c|\\alpha\\rangle\n\\equiv a|w\\rangle+b|\\alpha\\rangle.$$\n扩散算子 $U_s=2|\\psi_0\\rangle\\langle\\psi_0|-I$ 作用后得到\n$$|\\psi_1\\rangle\n=U_s|\\psi'\\rangle\n=2\\langle\\psi_0|\\psi'\\rangle\\,|\\psi_0\\rangle-|\\psi'\\rangle,\n\\qquad\\langle\\psi_0|\\psi'\\rangle\n=s^2e^{i\\phi}+c^2.$$\n投影到 $|w\\rangle$ 上得到\n\n$$\na_1=\\langle w|\\psi_1\\rangle\n=2s\\bigl(s^2e^{i\\phi}+c^2\\bigr)-s\\,e^{i\\phi}\n=s\\bigl((2s^2-1)e^{i\\phi}+2c^2\\bigr).\n$$\n\n由于 $s^2=1/N$ 且 $c^2=(N-1)/N$，上式变为\n\n$$\na_1=\\frac{1}{N\\sqrt{N}}\\Bigl((2-N)e^{i\\phi}+2(N-1)\\Bigr).\n$$\n\n因此，成功概率为\n\n$$\nP(w)=|a_1|^2\n=\\frac{|(2-N)e^{i\\phi}+2(N-1)|^2}{N^3}\n=\\frac{(N-2)^2+4(N-1)^2-4(N-1)(N-2)\\cos\\phi}{N^3}.\n$$\n\n对于 $N=8$ 和 $\\phi=3\\pi/4$ 的情况，我们得到\n\n$$\nP(w)\n=\\frac{232-168\\cos(3\\pi/4)}{512}\n=\\frac{232+84\\sqrt{2}}{512}\n=\\frac{58+21\\sqrt{2}}{128}.\n$$", "answer": "$$\\boxed{\\frac{58+21\\sqrt2}{128}}$$", "id": "45186"}, {"introduction": "除了电路内部的相干误差，量子计算机还会受到与环境相互作用导致的退相干效应的影响。这个练习引入了退极化通道（depolarizing channel）——一种模拟非相干噪声的常用模型——并让你分析它在算法执行过程中对量子态的影响。解决这个问题 ([@problem_id:45082]) 将为你提供处理含噪声量子系统的宝贵实践经验，让你直观地看到环境噪声如何降低算法性能，并理解在实际量子计算中进行误差分析的重要性。", "problem": "考虑一个在2量子比特寄存器上的量子搜索问题，其搜索空间对应 $N=4$ 个项目。系统被初始化为均匀叠加态 $|s\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{x=0}^{N-1} |x\\rangle$。存在一个单一的“标记”态，记为 $|w\\rangle$。搜索通过应用一次 Grover 算法的迭代来执行。\n\n一次标准的 Grover 迭代由算符 $G = D O$ 描述，其中 $O$ 是神谕算符，$D$ 是扩散算符。神谕算符定义为 $O = I - 2|w\\rangle\\langle w|$，扩散算符为 $D = 2|s\\rangle\\langle s| - I$。\n\n在本问题中，量子计算机受到噪声的影响。在神谕算符 $O$ 应用于该态之后，但在扩散算符 $D$ 应用*之前*，该2量子比特系统与环境发生相互作用。这种相互作用被建模为一个2量子比特去极化信道 $\\mathcal{E}_p$，其对密度矩阵 $\\rho$ 的作用定义如下：\n$$\n\\mathcal{E}_p(\\rho) = (1-p) \\rho + p \\frac{I_N}{N}\n$$\n其中 $I_N$ 是 $N=4$ 维希尔伯特空间上的单位算符。\n\n假设系统从纯态 $\\rho_{in} = |s\\rangle\\langle s|$ 开始，一次带噪 Grover 迭代按以下步骤进行：\n1. 应用神谕算符：$\\rho_1 = O \\rho_{in} O^\\dagger$。\n2. 应用去极化信道：$\\rho_2 = \\mathcal{E}_p(\\rho_1)$。\n3. 应用扩散算符：$\\rho_{out} = D \\rho_2 D^\\dagger$。\n\n计算在末态 $\\rho_{out}$ 中测量到标记态 $|w\\rangle$ 的概率，已知去极化信道的强度为 $p = 1/10$。", "solution": "1. 初始态和算符。当 $N=4$ 时，\n$$|s\\rangle=\\frac{1}{4}\\sum_{x=0}^3|x\\rangle,\\quad P=|w\\rangle\\langle w|,$$\n$$O=I-2P,\\quad D=2|s\\rangle\\langle s|-I.$$\n初始密度矩阵为 $\\rho_{in}=|s\\rangle\\langle s|$。\n\n2. 经过神谕算符作用后：\n$$\\rho_1=O\\,\\rho_{in}\\,O^\\dagger=|\\psi_1\\rangle\\langle\\psi_1|,$$\n其中\n$$|\\psi_1\\rangle=O|s\\rangle=-\\frac{1}{2}|w\\rangle+\\frac{1}{2}\\sum_{x\\neq w}|x\\rangle.$$\n\n3. 强度为 $p$ 的去极化噪声：\n$$\\rho_2=\\mathcal E_p(\\rho_1)=(1-p)\\rho_1+p\\frac{I_4}{4}.$$\n\n4. 经过扩散算符作用后：\n$$\\rho_{out}=D\\,\\rho_2\\,D^\\dagger=(1-p)\\,D\\rho_1D+p\\frac{I_4}{4},\\quad D^2=I.$$\n\n5. 测量到 $|w\\rangle$ 的概率：\n$$P_w=\\Tr\\bigl[P\\,\\rho_{out}\\bigr]=(1-p)\\Tr[P\\,D\\rho_1D]+p\\,\\frac{\\Tr P}{4}.$$\n由于 $\\Tr P=1$ 且 $D\\,P\\,D=|w'\\rangle\\langle w'|$，其中 $|w'\\rangle=D|w\\rangle=|s\\rangle-|w\\rangle$，\n$$\\Tr[P\\,D\\rho_1D]=\\bigl|\\langle\\psi_1|D|w\\rangle\\bigr|^2 = \\bigl|\\langle\\psi_1|w'\\rangle\\bigr|^2.$$\n计算内积：\n$$\\langle s|\\psi_1\\rangle=-\\frac{1}{2}\\langle s|w\\rangle+\\frac{1}{2}\\sum_{x\\neq w}\\langle s|x\\rangle\n=-\\frac{1}{4}+\\frac{3}{4}=\\frac{1}{2},$$\n$$\\langle w|\\psi_1\\rangle=-\\frac{1}{2},$$\n所以\n$$\\langle w'|\\psi_1\\rangle= \\langle s|\\psi_1\\rangle - \\langle w|\\psi_1\\rangle =\\frac{1}{2}-(-\\frac{1}{2})=1\\;\\;\\Longrightarrow\\;\\;\n\\Tr[P\\,D\\rho_1D]=1.$$\n\n6. 因此\n$$P_w=(1-p)\\cdot1+p\\cdot\\frac{1}{4}=1-\\frac{3p}{4}.$$\n代入 $p=\\frac{1}{10}$ 得 $P_w=1-\\frac{3}{40}=\\frac{37}{40}.$", "answer": "$$\\boxed{\\frac{37}{40}}$$", "id": "45082"}]}