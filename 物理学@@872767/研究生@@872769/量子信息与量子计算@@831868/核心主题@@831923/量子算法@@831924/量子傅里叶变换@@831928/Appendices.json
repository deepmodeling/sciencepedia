{"hands_on_practices": [{"introduction": "深入理解量子傅里叶变换 (Quantum Fourier Transform, QFT) 最好的方法就是亲手计算它对不同量子态的作用。我们从一个基本但重要的多量子比特纠缠态——W 态开始。通过将 QFT 应用于 3-量子比特的 W 态，我们可以直接运用 QFT 的定义，观察它如何将输入的叠加态转换成输出端复杂的相位分布，这是一个锻炼 QFT 核心数学定义的绝佳练习 [@problem_id:167266]。", "problem": "在量子计算中，量子傅里叶变换（Quantum Fourier Transform, QFT）是作用于量子比特的线性变换，是离散傅里叶变换的量子对应。对于一个包含 $n$ 个量子比特的量子系统，其计算基态表示为 $|j\\rangle$，其中 $j$ 是一个在 $0 \\le j \\le 2^n - 1$ 范围内的整数。$n$ 量子比特的QFT（记为 $U_{QFT}$）对基态 $|j\\rangle$ 的作用定义如下：\n$$ U_{QFT}|j\\rangle = \\frac{1}{\\sqrt{2^n}} \\sum_{k=0}^{2^n-1} \\exp\\left(\\frac{2\\pi i j k}{2^n}\\right) |k\\rangle $$\n在这里，右矢（ket）与其二进制表示相对应，例如，当 $n=3$ 时， $|1\\rangle \\equiv |001\\rangle$ 且 $|6\\rangle \\equiv |110\\rangle$。\n\n另一个重要的多体纠缠态是 $n$ 量子比特的 W 态，它是所有只有一个量子比特处于 $|1\\rangle$ 态而其余量子比特处于 $|0\\rangle$ 态的基态的均匀叠加。当 $n=3$ 时，W 态由下式给出：\n$$ |W_3\\rangle = \\frac{1}{\\sqrt{3}} \\left( |001\\rangle + |010\\rangle + |100\\rangle \\right) $$\n\n考虑一个初始制备在 $|W_3\\rangle$ 态的 3 量子比特量子寄存器。然后对该寄存器应用 3 量子比特的量子傅里叶变换。变换之后，在计算基上对所有三个量子比特进行测量。\n\n计算测量结果为 $|111\\rangle$ 态的概率。", "solution": "初始态是 3 量子比特的 W 态：\n\n$$\n|W_3\\rangle = \\frac{1}{\\sqrt{3}} \\left( |001\\rangle + |010\\rangle + |100\\rangle \\right)\n$$\n\n在十进制表示中， $|001\\rangle = |1\\rangle$， $|010\\rangle = |2\\rangle$，以及 $|100\\rangle = |4\\rangle$，所以：\n\n$$\n|W_3\\rangle = \\frac{1}{\\sqrt{3}} \\left( |1\\rangle + |2\\rangle + |4\\rangle \\right)\n$$\n\n\n3 量子比特的量子傅里叶变换（QFT）对基态 $|j\\rangle$ 的作用如下：\n\n$$\nU_{\\text{QFT}} |j\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\exp\\left( \\frac{2\\pi i j k}{8} \\right) |k\\rangle\n$$\n\n\n根据线性性质，将 $U_{\\text{QFT}}$ 作用于 $|W_3\\rangle$ 得到：\n\n$$\nU_{\\text{QFT}} |W_3\\rangle = \\frac{1}{\\sqrt{3}} \\left( U_{\\text{QFT}} |1\\rangle + U_{\\text{QFT}} |2\\rangle + U_{\\text{QFT}} |4\\rangle \\right)\n$$\n\n\n计算每一项：\n- 对于 $|j=1\\rangle$：\n  \n$$\n  U_{\\text{QFT}} |1\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\exp\\left( \\frac{2\\pi i \\cdot 1 \\cdot k}{8} \\right) |k\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\omega^k |k\\rangle\n  $$\n\n  其中 $\\omega = \\exp(2\\pi i / 8) = \\exp(i\\pi/4)$。\n- 对于 $|j=2\\rangle$：\n  \n$$\n  U_{\\text{QFT}} |2\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\exp\\left( \\frac{2\\pi i \\cdot 2 \\cdot k}{8} \\right) |k\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\exp\\left( \\frac{2\\pi i k}{4} \\right) |k\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\phi^k |k\\rangle\n  $$\n\n  其中 $\\phi = \\exp(i\\pi/2) = i$。\n- 对于 $|j=4\\rangle$：\n  \n$$\n  U_{\\text{QFT}} |4\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\exp\\left( \\frac{2\\pi i \\cdot 4 \\cdot k}{8} \\right) |k\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\exp\\left( i\\pi k \\right) |k\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} (-1)^k |k\\rangle\n  $$\n\n\nQFT 变换后的态是：\n\n$$\nU_{\\text{QFT}} |W_3\\rangle = \\frac{1}{\\sqrt{3}} \\left( \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\omega^k |k\\rangle + \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\phi^k |k\\rangle + \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} (-1)^k |k\\rangle \\right) = \\frac{1}{\\sqrt{24}} \\sum_{k=0}^{7} \\left( \\omega^k + \\phi^k + (-1)^k \\right) |k\\rangle\n$$\n\n\n态 $|111\\rangle$ 对应于 $k=7$。 $|7\\rangle$ 的系数是：\n\n$$\nc_7 = \\frac{1}{\\sqrt{24}} \\left( \\omega^7 + \\phi^7 + (-1)^7 \\right)\n$$\n\n\n计算每一项：\n- $\\omega^7 = \\exp(14\\pi i / 8) = \\exp(7\\pi i / 4) = \\cos(7\\pi/4) + i \\sin(7\\pi/4) = \\frac{\\sqrt{2}}{2} - i \\frac{\\sqrt{2}}{2} = \\frac{1}{\\sqrt{2}} (1 - i)$\n- $\\phi^7 = i^7 = i^{4+3} = i^3 = -i$\n- $(-1)^7 = -1$\n\n所以：\n\n$$\nc_7 = \\frac{1}{\\sqrt{24}} \\left( \\frac{1}{\\sqrt{2}} (1 - i) - i - 1 \\right) = \\frac{1}{\\sqrt{24}} \\left( \\frac{1}{\\sqrt{2}} - 1 - i \\left( \\frac{1}{\\sqrt{2}} + 1 \\right) \\right)\n$$\n\n\n测量得到 $|111\\rangle$ 的概率是 $|c_7|^2$：\n\n$$\n|c_7|^2 = \\frac{1}{24} \\left| \\frac{1}{\\sqrt{2}} - 1 - i \\left( \\frac{1}{\\sqrt{2}} + 1 \\right) \\right|^2 = \\frac{1}{24} \\left[ \\left( \\frac{1}{\\sqrt{2}} - 1 \\right)^2 + \\left( \\frac{1}{\\sqrt{2}} + 1 \\right)^2 \\right]\n$$\n\n\n计算平方项：\n\n$$\n\\left( \\frac{1}{\\sqrt{2}} - 1 \\right)^2 = \\left( \\frac{1}{\\sqrt{2}} \\right)^2 - 2 \\cdot \\frac{1}{\\sqrt{2}} \\cdot 1 + 1^2 = \\frac{1}{2} - \\sqrt{2} + 1 = \\frac{3}{2} - \\sqrt{2}\n$$\n\n\n$$\n\\left( \\frac{1}{\\sqrt{2}} + 1 \\right)^2 = \\left( \\frac{1}{\\sqrt{2}} \\right)^2 + 2 \\cdot \\frac{1}{\\sqrt{2}} \\cdot 1 + 1^2 = \\frac{1}{2} + \\sqrt{2} + 1 = \\frac{3}{2} + \\sqrt{2}\n$$\n\n\n将平方项相加：\n\n$$\n\\left( \\frac{3}{2} - \\sqrt{2} \\right) + \\left( \\frac{3}{2} + \\sqrt{2} \\right) = 3\n$$\n\n\n因此：\n\n$$\n|c_7|^2 = \\frac{1}{24} \\cdot 3 = \\frac{3}{24} = \\frac{1}{8}\n$$\n\n\n测量得到 $|111\\rangle$ 的概率是 $\\frac{1}{8}$。", "answer": "$$ \\boxed{\\dfrac{1}{8}} $$", "id": "167266"}, {"introduction": "在掌握了基本计算之后，我们可以探索 QFT 的一个更强大、更有用的特性：周期性发现。QFT 在许多关键量子算法（如秀尔算法）中扮演核心角色，其根本原因在于它能够揭示量子态中隐藏的周期性。本练习 [@problem_id:167137] 构建了一个具有明确周期性的输入态，通过计算，你将亲眼见证 QFT 如何将这个周期性信息转化到傅里叶基下，使得原本隐藏的周期变得清晰可见。", "problem": "在一个标准正交基 $|0\\rangle, |1\\rangle, \\dots, |N-1\\rangle$ 上，量子傅里叶变换 (QFT) 是一个酉变换，其对基矢的作用定义如下：\n$$\nQFT_N |x\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{y=0}^{N-1} e^{2\\pi i xy / N} |y\\rangle\n$$\n其中 $x \\in \\{0, 1, \\dots, N-1\\}$。对于一个 $n$ 量子比特的系统，$N=2^n$。\n\n考虑一个4量子比特的量子寄存器，因此 $N=2^4=16$。系统被制备在一个初态 $|\\psi_{in}\\rangle$，该初态是对应于集合 $S = \\{0, 4, 8, 12\\}$ 中整数的计算基矢的均匀叠加态。然后对该态应用量子傅里叶变换，得到末态 $|\\psi_{out}\\rangle = QFT_{16} |\\psi_{in}\\rangle$。\n\n从输出态中测量得到计算基矢 $|y\\rangle$ 的总概率是多少？其中整数 $y$ 满足条件 $y \\equiv 2 \\pmod 4$。", "solution": "1. **构建初态 $|\\psi_{in}\\rangle$。**\n初态是集合 $S = \\{0, 4, 8, 12\\}$ 中各态的均匀叠加态。该集合的大小为 $|S|=4$。因此，归一化的初态为：\n$$\n|\\psi_{in}\\rangle = \\frac{1}{\\sqrt{|S|}} \\sum_{x \\in S} |x\\rangle = \\frac{1}{\\sqrt{4}} \\left( |0\\rangle + |4\\rangle + |8\\rangle + |12\\rangle \\right) = \\frac{1}{2} \\sum_{k=0}^{3} |4k\\rangle\n$$\n\n2. **应用量子傅里叶变换。**\n我们将 $QFT_{16}$ 应用于态 $|\\psi_{in}\\rangle$。利用 QFT 算符的线性性质：\n$$\n|\\psi_{out}\\rangle = QFT_{16} |\\psi_{in}\\rangle = \\frac{1}{2} \\sum_{k=0}^{3} QFT_{16} |4k\\rangle\n$$\n现在，我们将 QFT 的定义代入每个基矢：\n$$\n|\\psi_{out}\\rangle = \\frac{1}{2} \\sum_{k=0}^{3} \\left( \\frac{1}{\\sqrt{16}} \\sum_{y=0}^{15} e^{2\\pi i (4k)y / 16} |y\\rangle \\right)\n$$\n$$\n|\\psi_{out}\\rangle = \\frac{1}{2 \\cdot 4} \\sum_{k=0}^{3} \\sum_{y=0}^{15} e^{i \\pi ky / 2} |y\\rangle\n$$\n我们可以交换求和顺序，以对每个基矢 $|y\\rangle$ 的系数进行分组：\n$$\n|\\psi_{out}\\rangle = \\frac{1}{8} \\sum_{y=0}^{15} \\left( \\sum_{k=0}^{3} e^{i \\pi ky / 2} \\right) |y\\rangle\n$$\n态 $|\\psi_{out}\\rangle$ 可以写作 $|\\psi_{out}\\rangle = \\sum_{y=0}^{15} c_y |y\\rangle$，其中振幅 $c_y$ 为：\n$$\nc_y = \\frac{1}{8} \\sum_{k=0}^{3} \\left(e^{i \\pi y / 2}\\right)^k\n$$\n\n3. **计算振幅 $c_y$。**\n$c_y$ 的求和是一个有限几何级数 $\\sum_{k=0}^{n-1} r^k$，其中 $n=4$，公比为 $r = e^{i \\pi y / 2}$。\n该求和存在两种情况：\n(a) 如果 $r=1$，和为 $n=4$。这种情况发生在 $e^{i \\pi y / 2} = 1$ 时，这意味着 $\\frac{\\pi y}{2}$ 是 $2\\pi$ 的整数倍。所以，$\\frac{y}{4}$ 必须是整数。这对 $y \\in \\{0, 4, 8, 12\\}$ 成立。在这种情况下，振幅为：\n$$\nc_y = \\frac{1}{8} \\cdot 4 = \\frac{1}{2} \\quad \\text{对于 } y \\in \\{0, 4, 8, 12\\}\n$$\n(b) 如果 $r \\neq 1$，和为 $\\frac{r^n - 1}{r - 1}$。这里 $n=4$：\n$$\n\\sum_{k=0}^{3} r^k = \\frac{r^4 - 1}{r - 1} = \\frac{(e^{i \\pi y / 2})^4 - 1}{e^{i \\pi y / 2} - 1} = \\frac{e^{i 2\\pi y} - 1}{e^{i \\pi y / 2} - 1}\n$$\n因为 $y$ 是整数，所以 $e^{i 2\\pi y} = \\cos(2\\pi y) + i \\sin(2\\pi y) = 1$。分子是 $1 - 1 = 0$。由于我们处于 $r\\neq 1$ 的情况，分母非零。因此，和为0。\n这意味着对于所有不是4的倍数的 $y$，振幅为：\n$$\nc_y = 0 \\quad \\text{对于 } y \\notin \\{0, 4, 8, 12\\}\n$$\n因此，输出态是仅四个基矢的叠加态：\n$$\n|\\psi_{out}\\rangle = \\frac{1}{2} \\left( |0\\rangle + |4\\rangle + |8\\rangle + |12\\rangle \\right)\n$$\n\n4. **计算所求概率。**\n问题要求测量得到态 $|y\\rangle$ 且 $y \\equiv 2 \\pmod 4$ 的总概率。在范围 $y \\in \\{0, 1, \\dots, 15\\}$ 内，满足此条件的 $y$ 值为 $2, 6, 10, 14$。\n测量得到特定态 $|y\\rangle$ 的概率为 $P(y) = |c_y|^2$。总概率是这些结果各自概率的总和：\n$$\nP_{total} = P(y=2) + P(y=6) + P(y=10) + P(y=14)\n$$\n$$\nP_{total} = |c_2|^2 + |c_6|^2 + |c_{10}|^2 + |c_{14}|^2\n$$\n根据我们在第3步的分析，振幅 $c_y$ 仅当 $y$ 是4的倍数时才非零。\n集合 $\\{2, 6, 10, 14\\}$ 中的所有值都不是4的倍数。\n因此，这些态的振幅全为零：\n$$\nc_2 = 0, \\quad c_6 = 0, \\quad c_{10} = 0, \\quad c_{14} = 0\n$$\n将这些值代入概率表达式中：\n$$\nP_{total} = |0|^2 + |0|^2 + |0|^2 + |0|^2 = 0\n$$", "answer": "$$\n\\boxed{0}\n$$", "id": "167137"}, {"introduction": "除了在算法中的应用，QFT 在物理学中也具有深刻的意义。它是在具有离散平移对称性（例如，环上的粒子）的物理系统中分析动力学的自然工具。本练习 [@problem_id:167237] 让你探索 QFT 如何对角化一个描述粒子在循环图上跳跃的哈密顿量。这揭示了 QFT 的一个本质作用——它将计算基矢（位置本征态）变换为能量本征态（动量本征态），从而极大地简化了系统时间演化的分析。", "problem": "考虑一个三量子比特系统，其计算基态 $|j\\rangle$（其中 $j$ 是量子比特串的整数表示，$j \\in \\{0, 1, \\dots, 7\\}$）可被视为一个大小为 $N=8$ 的循环图上的格点。该系统在一个哈密顿量下演化，该哈密顿量描述了此循环上的最近邻跃迁，并具有均匀的在位能。哈密顿量由下式给出\n$$ H = \\sum_{j=0}^{N-1} \\left( \\epsilon |j\\rangle\\langle j| + J |j\\rangle\\langle j+1 \\pmod N| + J |j\\rangle\\langle j-1 \\pmod N| \\right) $$\n其中 $N=8$，$J$ 是跃迁强度，$\\epsilon$ 是在位能。\n\n这个哈密顿量是一个循环矩阵，可以被量子傅里叶变换 (Quantum Fourier Transform, QFT) 对角化。$H$ 的本征矢量是傅里叶态 $|\\tilde{k}\\rangle$，相应的能量本征值由下式给出\n$$ E_k = \\epsilon + 2J \\cos\\left(\\frac{2\\pi k}{N}\\right) $$\n其中 $k \\in \\{0, 1, \\dots, N-1\\}$。计算基 $|k\\rangle$ 和能量本征基（傅里叶基）$|\\tilde{k}\\rangle$ 之间的关系由逆量子傅里叶变换 (inverse QFT) 给出：\n$|\\tilde{k}\\rangle = U_{QFT}^\\dagger |k\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{j=0}^{N-1} e^{-2\\pi i jk/N} |j\\rangle$。\n\n如果系统制备在初态 $|\\psi(0)\\rangle = |1\\rangle$，求在之后的时刻 $t$ 的返回概率 $P(t) = |\\langle 1 | \\psi(t) \\rangle|^2$。将您的答案表示为 $t$、$J$ 和约化普朗克常数 $\\hbar$ 的函数。", "solution": "我们希望计算\n$$P(t)=\\bigl|\\langle1|e^{-iHt/\\hbar}|1\\rangle\\bigr|^2\\,. $$\n因为 $H$ 的本征值为\n$$E_k=\\epsilon+2J\\cos\\frac{2\\pi k}{N},\\quad N=8,$$ \n本征矢量为 $|\\tilde{k}\\rangle$, 我们可以求得振幅\n$$A(t)=\\langle1|\\psi(t)\\rangle\n=\\frac1N\\sum_{k=0}^{N-1}e^{-iE_k t/\\hbar}\n=e^{-i\\epsilon t/\\hbar}\\frac1{8}\\sum_{k=0}^{7}e^{-i\\frac{2Jt}{\\hbar}\\cos\\frac{\\pi k}{4}}\\,.$$\n全局相位在 $|A(t)|^2$ 中会消去，因此设\n$$\\alpha=\\frac{2Jt}{\\hbar}\\,,$$ \n并计算这个离散和。注意到 $\\cos\\frac{\\pi k}{4}$ 的取值成对出现，为 \\{1, √2/2, 0, −√2/2, −1, −√2/2, 0, √2/2\\}，可得\n\n$$\n\\sum_{k=0}^7e^{-i\\alpha\\cos(\\pi k/4)}\n=2\\cos\\alpha+2+4\\cos\\frac{\\alpha}{\\sqrt2}\\,.\n$$\n\n因此，返回振幅为\n\n$$\nA(t)=\\frac{1}{8}\\bigl(2\\cos\\alpha+2+4\\cos\\frac{\\alpha}{\\sqrt2}\\bigr)\n=\\frac{1}{4}+\\frac{1}{4}\\cos\\alpha+\\frac12\\cos\\frac{\\alpha}{\\sqrt2},\n$$\n\n所以\n\n$$\nP(t)=\\Bigl(\\frac{1}{4}+\\frac{1}{4}\\cos\\!\\frac{2Jt}{\\hbar}\n+\\frac12\\cos\\!\\frac{\\sqrt2 Jt}{\\hbar}\\Bigr)^2.\n$$", "answer": "$$\\boxed{\\Bigl(\\tfrac{1+\\cos\\frac{2Jt}{\\hbar}}{4}+\\tfrac{\\cos\\frac{\\sqrt2\\,Jt}{\\hbar}}{2}\\Bigr)^2}$$", "id": "167237"}]}