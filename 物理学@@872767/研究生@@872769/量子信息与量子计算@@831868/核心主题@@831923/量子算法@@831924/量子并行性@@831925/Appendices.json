{"hands_on_practices": [{"introduction": "量子并行性的核心思想是利用量子叠加态一次性对多个输入进行函数求值。这个入门级练习旨在具体展示这一概念。通过将输入寄存器置于所有可能输入的均匀叠加态，我们只需调用一次量子“谕示器” (oracle)，就能在一个纠缠态中并行计算出函数在整个定义域上的所有值。[@problem_id:125408]", "problem": "一个 4 量子比特的量子系统由两个 2 量子比特的寄存器组成：一个输入寄存器和一个输出寄存器。该系统的状态在希尔伯特空间 $\\mathcal{H} = (\\mathbb{C}^2)^{\\otimes 2} \\otimes (\\mathbb{C}^2)^{\\otimes 2}$ 中描述。单个量子比特的计算基为 $\\{|0\\rangle, |1\\rangle\\}$。\n\n系统被初始化为状态 $|\\psi_{in}\\rangle = |+\\rangle^{\\otimes 2} \\otimes |0\\rangle^{\\otimes 2}$，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$ 且 $|0\\rangle^{\\otimes 2} = |00\\rangle$。\n\n一个由酉算符 $U_f$ 表示的量子预言机被应用于该系统。该预言机评估由下式定义的经典函数 $f: \\{0,1\\}^2 \\to \\{0,1\\}^2$：\n$$f(x_1, x_2) = (x_1, x_1 \\oplus x_2)$$\n其中 $\\oplus$ 表示模 2 加法（异或）。预言机对计算基态 $|x_1 x_2\\rangle|y_1 y_2\\rangle$ 的作用由下式给出：\n$$U_f |x_1 x_2\\rangle |y_1 y_2\\rangle = |x_1 x_2\\rangle |y_1 \\oplus f_1(x_1, x_2), y_2 \\oplus f_2(x_1, x_2)\\rangle$$\n其中 $f_1$ 和 $f_2$ 是函数 $f$ 的两个分量。\n\n在将预言机 $U_f$ 应用于初始状态 $|\\psi_{in}\\rangle$ 后，对输出寄存器（最后两个量子比特）进行计算基下的测量。计算得到结果 $|11\\rangle$ 的概率。", "solution": "1. 初始状态为\n$$|\\psi_{in}\\rangle = |+\\rangle^{\\otimes2}\\otimes|00\\rangle\n=\\bigl(\\tfrac1{\\sqrt2}(|0\\rangle+|1\\rangle)\\bigr)^{\\otimes2}\\otimes|00\\rangle\n=\\frac1{2}\\sum_{x_1,x_2\\in\\{0,1\\}}|x_1x_2\\rangle\\otimes|00\\rangle.$$\n\n2. 预言机的作用为\n$$U_f\\,|x_1x_2\\rangle|y_1y_2\\rangle\n=|x_1x_2\\rangle\\,|y_1\\oplus f_1(x_1,x_2),\\,y_2\\oplus f_2(x_1,x_2)\\rangle,$$\n其中 $f(x_1,x_2)=(x_1,\\;x_1\\oplus x_2)$。\n\n3. 将 $U_f$ 应用于 $|\\psi_{in}\\rangle$ 得到\n$$|\\psi_{\\rm out}\\rangle\n=\\frac1{2}\\sum_{x_1,x_2}|x_1x_2\\rangle\\,|f(x_1,x_2)\\rangle.$$\n\n4. 我们测量最后两个量子比特，并希望得到结果 $|11\\rangle$。这仅在以下情况下发生：\n$$f(x_1,x_2)=(1,1)\\quad\\Longrightarrow\\quad x_1=1,\\;x_1\\oplus x_2=1\n\\;\\Rightarrow\\;x_2=0.$$\n因此，只有一个项 $|10\\rangle|11\\rangle$ 有贡献，其振幅为 $1/2$。\n\n5. 输出寄存器上得到 $|11\\rangle$ 的概率是\n$$P(11)=\\bigl|\\tfrac1{2}\\bigr|^2=\\tfrac14.$$", "answer": "$$\\boxed{\\frac14}$$", "id": "125408"}, {"introduction": "Bernstein-Vazirani 算法是展示量子并行性如何带来指数级加速的经典范例。该算法的完美运行依赖于谕示器对叠加态中每一个基态都精确地施加正确的相位。本练习通过引入一个有缺陷的谕示器来探讨该算法的鲁棒性，该谕示器在一个输入上失效。通过分析这种局部错误如何破坏最终的全局干涉图样，我们可以更深刻地理解量子并行性是如何通过干涉效应将信息提取出来的。[@problem_id:125316]", "problem": "Bernstein-Vazirani (BV) 算法是一种量子算法，为量子并行性提供了一个显著的范例。它解决的是找到一个秘密的 $n$ 比特字符串 $s = s_{n-1}s_{n-2}...s_0$ 的问题。对该秘密字符串的访问是通过一个函数预言机 $f_s: \\{0,1\\}^n \\to \\{0,1\\}$ 提供的，该预言机由按位内积 $f_s(x) = s \\cdot x \\pmod 2$ 定义。\n\n标准的 BV 算法使用一个量子线路，其中包含一个用于输入寄存器的 $n$ 个量子比特和一个用于输出的辅助量子比特。该线路按以下步骤进行：\n1. 将 $n$ 个输入量子比特初始化为 $|0\\rangle^{\\otimes n}$，并将辅助量子比特初始化为 $|1\\rangle$。\n2. 对所有 $n+1$ 个量子比特应用阿达马门（$H$）。这将输入寄存器制备在均匀叠加态 $\\frac{1}{\\sqrt{2^n}}\\sum_{x \\in \\{0,1\\}^n}|x\\rangle$ 上，并将辅助量子比特制备在态 $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle-|1\\rangle)$ 上。\n3. 应用量子预言机 $U_f$，它将 $|x\\rangle|y\\rangle$ 映射到 $|x\\rangle|y \\oplus f_s(x)\\rangle$。为辅助量子比特选择 $|-\\rangle$ 态可以巧妙地将其转变为一个相位预言机，该预言机对输入寄存器施加一个相位：$U_f(|x\\rangle \\otimes |-\\rangle) = (-1)^{f_s(x)}|x\\rangle \\otimes |-\\rangle$。\n4. 对输入寄存器应用阿达马门 $H^{\\otimes n}$。\n5. 在计算基下测量输入寄存器。在理想的执行情况下，测量结果恰好是秘密字符串 $s$。\n\n考虑一个 3 量子比特（$n=3$）的 BV 算法实现，其设计目的是找到秘密字符串 $s=110$。然而，该相位预言机是错误的。对于单个计算基态 $|x_0\\rangle = |101\\rangle$，该预言机未能施加相位，其作用如同单位算子。对于所有其他基态 $|x\\rangle \\neq |101\\rangle$，该预言机正常工作。也就是说，错误的预言机 $U_f'$ 对输入寄存器态的作用如下：\n$$\nU_f' |x\\rangle = \\begin{cases}\n    (-1)^{s \\cdot x} |x\\rangle,  \\text{if } x \\neq 101 \\\\\n    |x\\rangle,  \\text{if } x = 101\n\\end{cases}\n$$\n假设算法的其余部分被完美地执行，计算测量得到正确秘密字符串 $s=110$ 的概率。", "solution": "我们有 $n=3$，秘密字符串 $s=110$，以及错误的预言机作用如下：\n$$\n\\alpha_x = \\begin{cases}\n(-1)^{s \\cdot x},  \\text{if } x \\neq 101 \\\\\n1,  \\text{if } x = 101\n\\end{cases}\n$$\n1. 在第一批阿达马门作用之后，输入寄存器为\n$$\n|\\psi_1\\rangle=\\frac1{\\sqrt{2^3}}\\sum_{x\\in\\{0,1\\}^3}|x\\rangle.\n$$\n2. 在错误的相位预言机作用之后，\n$$\n|\\psi_2\\rangle=\\frac1{\\sqrt{8}}\\sum_{x}\\alpha_x|x\\rangle.\n$$\n3. 应用 $H^{\\otimes3}$ 得到振幅\n$$\nA(y)=\\langle y|\\psi_3\\rangle\n=\\frac1{2^3}\\sum_{x}\\alpha_x\\,(-1)^{x\\cdot y}.\n$$\n4. 分离出错误项 $x_0=101$：\n\n$$\n\\sum_{x}\\alpha_x(-1)^{x\\cdot y}\n=\\sum_{x}(-1)^{s\\cdot x}(-1)^{x\\cdot y}\n\\;+\\;\\bigl[1-(-1)^{s\\cdot x_0}\\bigr](-1)^{x_0\\cdot y}.\n$$\n\n第一个求和项是理想的 BV 算法结果：\n$$\n\\sum_{x}(-1)^{s\\cdot x+x\\cdot y}\n=\\sum_{x}(-1)^{x\\cdot(s\\oplus y)}\n=2^3\\,\\delta_{y,s}.\n$$\n定义 $\\Delta=1-(-1)^{s\\cdot x_0}$。因此\n$$\nA(y)\n=\\delta_{y,s}\n\\;+\\;\\frac{\\Delta}{8}(-1)^{x_0\\cdot y}.\n$$\n5. 对于 $y=s=110$ 和 $x_0=101$，计算\n$$\ns\\cdot x_0=1\\cdot1+1\\cdot0+0\\cdot1\\equiv1\\pmod2,\n\\quad\n(-1)^{s\\cdot x_0}=-1,\n\\quad\n\\Delta=1-(-1)=2,\n$$\n和\n$$\n(-1)^{x_0\\cdot s}=(-1)^{1}=-1.\n$$\n因此\n$$\nA(s)=1+\\frac{2}{8}(-1)\n=1-\\tfrac14=\\tfrac34,\n\\qquad\nP(s)=|A(s)|^2=\\bigl(\\tfrac34\\bigr)^2=\\tfrac{9}{16}.\n$$", "answer": "$$\\boxed{\\tfrac{9}{16}}$$", "id": "125316"}, {"introduction": "这个高级练习将量子并行性的概念应用于一个更复杂的计算任务：区分两个不同的函数。这里的挑战在于，你需要设计一个量子算法，利用单次并行查询来最大化区分两种可能谕示器的成功概率。这个问题不仅巩固了对量子并行计算的理解，还将其与量子态判定的基本限制联系起来，展示了如何量化由量子并行性带来的计算优势。[@problem_id:125293]", "problem": "一台量子计算机的任务是区分两个不同的二次型，$q_1, q_2: \\mathbb{F}_2^n \\to \\mathbb{F}_2$，其中 $n \\geq 3$ 是一个奇数。域 $\\mathbb{F}_2$ 是具有两个元素 $\\{0, 1\\}$ 的有限域，加法运算为模 2 加，记为 $\\oplus$。这两个二次型由下式给出：\n$$q_1(x) = \\sum_{i=1}^{n-1} x_i x_{i+1}$$\n$$q_2(x) = \\sum_{i=1}^{n-2} x_i x_{i+1}$$\n对于一个向量 $x = (x_1, x_2, \\dots, x_n) \\in \\mathbb{F}_2^n$。\n\n提供一个预言机，对于给定的二次型 $q$，它在一个 $(n+1)$-量子比特寄存器上实现幺正变换 $U_q$：\n$$U_q |x\\rangle |y\\rangle = |x\\rangle |y \\oplus q(x)\\rangle$$\n其中 $|x\\rangle$ 是一个 $n$-量子比特计算基态，而 $|y\\rangle$ 是一个单量子比特计算基态。\n\n使用以下量子算法：\n1.  将 $(n+1)$-量子比特系统初始化到状态 $|\\Psi_{in}\\rangle = |0\\rangle^{\\otimes n} \\otimes |1\\rangle$。\n2.  对所有 $n+1$ 个量子比特应用 Hadamard 门 $H$。\n3.  应用预言机 $U_q$，其中 $q$ 以相等的概率为 $q_1$ 或 $q_2$。\n4.  对前 $n$ 个量子比特（$|x\\rangle$ 寄存器）应用 Hadamard 门 $H$。\n5.  测量前 $n$ 个量子比特的末态。执行一个最优测量来区分两种可能的末态。\n\n推导成功识别预言机实现的是哪个二次型（$q_1$ 或 $q_2$）的最大概率。", "solution": "我们首先推导任意二次型 $q$ 的最终纯态。初始化\n$$|\\Psi_{in}\\rangle=|0\\rangle^{\\otimes n}\\otimes|1\\rangle.$$\n应用 $H^{\\otimes n+1}$ 得到\n$$|\\Psi_1\\rangle=\\frac1{\\sqrt{2^n}}\\sum_{x\\in\\F_2^n}|x\\rangle\\otimes\\frac{|0\\rangle-|1\\rangle}{\\sqrt2}.$$\n预言机 $U_q$ 产生\n$$U_q|\\Psi_1\\rangle=\\frac1{\\sqrt{2^n}}\\sum_x(-1)^{q(x)}|x\\rangle\\otimes\\frac{|0\\rangle-|1\\rangle}{\\sqrt2}.$$\n丢弃辅助量子比特并对 $x$ 寄存器应用 $H^{\\otimes n}$ 得到\n$$|\\psi_q\\rangle=\\frac1{2^n}\\sum_{y\\in\\F_2^n}\\Bigl[\\sum_x(-1)^{q(x)\\oplus x\\cdot y}\\Bigr]|y\\rangle.$$\n因此，两个候选态 $|\\psi_1\\rangle,|\\psi_2\\rangle$ 满足\n$$\\langle\\psi_1|\\psi_2\\rangle=\\frac1{2^n}\\sum_{x\\in\\F_2^n}(-1)^{q_1(x)\\oplus q_2(x)}.$$\n注意到 $q_1(x)\\oplus q_2(x)=x_{n-1}x_n$ 并对 $x$ 求和得到\n$$\\langle\\psi_1|\\psi_2\\rangle=\\frac{2^{n-1}}{2^n}=\\frac12.$$\n等先验概率的 Helstrom 界给出\n$$P_{\\max}=\\frac12\\Bigl(1+\\sqrt{1-|\\langle\\psi_1|\\psi_2\\rangle|^2}\\Bigr)\n=\\frac12\\Bigl(1+\\sqrt{1-\\tfrac14}\\Bigr)\n=\\frac12+\\frac{\\sqrt3}{4}.$$", "answer": "$$\\boxed{\\frac{2+\\sqrt3}{4}}$$", "id": "125293"}]}