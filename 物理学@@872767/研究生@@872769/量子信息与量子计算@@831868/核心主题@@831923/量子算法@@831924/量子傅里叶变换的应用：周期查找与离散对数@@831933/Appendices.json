{"hands_on_practices": [{"introduction": "量子相位估计算法是周期寻找算法的核心。这项练习旨在通过一个理想化的场景，帮助我们理解其基本工作原理。通过计算一个非预期结果的概率，我们可以验证一个重要结论：当真实相位可以被量子比特精确表示时，算法会以100%的概率输出正确结果，而所有其他结果的概率则为零。[@problem_id:48169]", "problem": "量子相位估计算法（QPE）是许多量子算法中的一个基本子程序，包括用于整数分解的Shor算法。QPE的目标是估计给定酉算符 $U$ 的特征值 $e^{i2\\pi\\phi}$ 的相位 $\\phi \\in [0, 1)$。\n\n标准的QPE电路由两个量子寄存器组成：\n1.  一个具有 $n$ 个量子比特的控制寄存器，初始化为状态 $|0\\rangle^{\\otimes n}$。\n2.  一个目标寄存器，制备在 $U$ 的一个本征态 $|\\psi\\rangle$ 上，使得 $U|\\psi\\rangle = e^{i2\\pi\\phi}|\\psi\\rangle$。\n\n该算法按以下步骤进行：\n1.  对控制寄存器中的每个量子比特应用阿达马门（Hadamard gate）。\n2.  对于控制寄存器中的每个量子比特 $k$（从 $k=0$ 到 $n-1$），对目标寄存器应用受控-$U^{2^k}$ 门。\n3.  对控制寄存器应用逆量子傅里叶变换（IQFT）。\n4.  在计算基下测量控制寄存器。测量结果是一个 $n$ 比特的字符串，表示一个近似于 $2^n\\phi$ 的整数 $j$。\n\n考虑Shor算法中分解数字 $N=51$（以 $a=10$ 为底）的一部分，一个特定的QPE例程。假设目标寄存器被制备在模幂运算算符的一个特定本征态上，并且这个本征态对应于一个精确的相位 $\\phi=3/8$。使用一个具有 $n=4$ 个量子比特的控制寄存器进行估计。\n\n计算在控制寄存器中测量到结果 $|1000\\rangle$ 的精确概率。", "solution": "问题要求在给定参数集下，计算量子相位估计算法（QPE）的控制寄存器中测量到特定结果的概率。\n\n两个寄存器的初始状态是 $|0\\rangle^{\\otimes n} |\\psi\\rangle$。\n\n1.  对控制寄存器的 $n=4$ 个量子比特应用阿达马门后，状态变为：\n    $$\n    \\frac{1}{\\sqrt{2^4}} \\sum_{k=0}^{2^4-1} |k\\rangle |\\psi\\rangle = \\frac{1}{4} \\sum_{k=0}^{15} |k\\rangle |\\psi\\rangle\n    $$\n\n2.  接下来，应用受控-$U^{2^k}$ 操作。系统状态演化为：\n    $$\n    \\frac{1}{4} \\sum_{k=0}^{15} |k\\rangle U^k |\\psi\\rangle\n    $$\n    鉴于 $|\\psi\\rangle$ 是 $U$ 的一个本征态，其本征值为 $e^{i2\\pi\\phi}$，我们有 $U^k|\\psi\\rangle = (e^{i2\\pi\\phi})^k |\\psi\\rangle = e^{i2\\pi k \\phi} |\\psi\\rangle$。因此，状态为：\n    $$\n    |\\Psi_{pre-IQFT}\\rangle = \\frac{1}{4} \\sum_{k=0}^{15} e^{i2\\pi k \\phi} |k\\rangle |\\psi\\rangle\n    $$\n\n3.  对控制寄存器应用逆量子傅里叶变换（IQFT）。IQFT作用于基态 $|k\\rangle$ 的方式如下：\n    $$\n    \\text{IQFT}|k\\rangle = \\frac{1}{\\sqrt{2^n}} \\sum_{j=0}^{2^n-1} e^{-i2\\pi kj/2^n} |j\\rangle\n    $$\n    将此应用于控制寄存器的状态：\n    $$\n    |\\Psi_{final}\\rangle = \\frac{1}{4} \\sum_{k=0}^{15} e^{i2\\pi k \\phi} \\left( \\frac{1}{4} \\sum_{j=0}^{15} e^{-i2\\pi kj/16} |j\\rangle \\right) |\\psi\\rangle\n    $$\n    重新排列求和项，我们得到：\n    $$\n    |\\Psi_{final}\\rangle = \\frac{1}{16} \\sum_{j=0}^{15} \\left( \\sum_{k=0}^{15} e^{i2\\pi k \\phi} e^{-i2\\pi kj/16} \\right) |j\\rangle |\\psi\\rangle\n    $$\n    在控制寄存器中测量到结果 $|j\\rangle$ 的振幅是：\n    $$\n    A_j = \\frac{1}{16} \\sum_{k=0}^{15} e^{i2\\pi k (\\phi - j/16)}\n    $$\n\n4.  我们需要计算测量到结果 $|1000\\rangle$ 的概率。在十进制中，这个二进制字符串对应的整数 $j$ 是：\n    $$\n    j = 1 \\cdot 2^3 + 0 \\cdot 2^2 + 0 \\cdot 2^1 + 0 \\cdot 2^0 = 8\n    $$\n\n5.  我们将给定值代入 $j=8$ 的振幅表达式中：\n    -   $n=4$\n    -   $\\phi=3/8$\n    -   $j=8$\n\n    指数的参数是：\n    $$\n    \\phi - \\frac{j}{16} = \\frac{3}{8} - \\frac{8}{16} = \\frac{3}{8} - \\frac{1}{2} = \\frac{3-4}{8} = -\\frac{1}{8}\n    $$\n    振幅 $A_8$ 是：\n    $$\n    A_8 = \\frac{1}{16} \\sum_{k=0}^{15} e^{i2\\pi k (-1/8)} = \\frac{1}{16} \\sum_{k=0}^{15} e^{-i\\pi k/4}\n    $$\n\n6.  这是一个有限几何级数，形式为 $\\sum_{k=0}^{M-1} r^k$，其中 $M=16$ 且 $r = e^{-i\\pi/4}$。\n    有限几何级数的和由公式 $\\frac{1-r^M}{1-r}$ 给出（当 $r \\neq 1$ 时）。\n    这里，$r = e^{-i\\pi/4} = \\cos(-\\pi/4) + i\\sin(-\\pi/4) = \\frac{1}{\\sqrt{2}} - i\\frac{1}{\\sqrt{2}}$，它不等于1。\n    所以，我们可以使用该公式。我们来计算 $r^M = r^{16}$ 这一项：\n    $$\n    r^{16} = \\left(e^{-i\\pi/4}\\right)^{16} = e^{-i(16\\pi/4)} = e^{-i4\\pi}\n    $$\n    使用欧拉公式，$e^{-i4\\pi} = \\cos(-4\\pi) + i\\sin(-4\\pi) = 1 + 0i = 1$。\n\n7.  现在将此结果代回求和公式中：\n    $$\n    \\sum_{k=0}^{15} (e^{-i\\pi/4})^k = \\frac{1 - r^{16}}{1 - r} = \\frac{1-1}{1 - e^{-i\\pi/4}} = \\frac{0}{1 - e^{-i\\pi/4}} = 0\n    $$\n    注意分母不为零。\n\n8.  测量到 $j=8$ 的振幅是：\n    $$\n    A_8 = \\frac{1}{16} \\cdot 0 = 0\n    $$\n\n9.  一个结果的概率是其振幅的模的平方。\n    $$\n    P(j=8) = |A_8|^2 = |0|^2 = 0\n    $$\n    给定相位 $\\phi=3/8$ 可以被一个分母能整除 $2^n=16$ 的分数精确表示（因为 $3/8 = 6/16$），这意味着QPE算法将以概率1产生结果 $j=6$。因此，测量到任何其他结果（包括 $j=8$）的概率都精确为0。", "answer": "$$ \\boxed{0} $$", "id": "48169"}, {"introduction": "在更普遍的情况下，量子寄存器的比特数并非总是周期长度的整数倍，这使得输出概率的计算变得更加复杂。这项练习将我们从理想情况带入到这种更具代表性的场景中。通过解决这个问题，你将学会如何处理不同长度的叠加态，并计算出特定测量结果的精确概率。[@problem_id:48198]", "problem": "用于分解整数 $N$ 的 Shor 算法的量子部分依赖于一个称为量子求阶的子程序。给定 $N$ 和一个与 $N$ 互质的整数 $a  N$，该子程序找到满足 $a^r \\equiv 1 \\pmod{N}$ 的最小正整数 $r$。\n\n该过程使用两个量子寄存器。第一个是初始化为 $|0\\rangle^{\\otimes L}$ 的 $L$ 量子比特寄存器，第二个是足以容纳高达 $N-1$ 的值的寄存器，也初始化为 $|0\\rangle$。令 $Q = 2^L$。算法按以下步骤进行：\n\n1.  对第一个寄存器的每个量子比特应用哈达玛变换，创建状态：\n    $$ |\\psi_1\\rangle = \\frac{1}{\\sqrt{Q}} \\sum_{x=0}^{Q-1} |x\\rangle |0\\rangle $$\n2.  将模幂算子 $U_f$（其中 $f(x) = a^x \\pmod{N}$）应用于组合状态：\n    $$ |\\psi_2\\rangle = \\frac{1}{\\sqrt{Q}} \\sum_{x=0}^{Q-1} |x\\rangle |a^x \\pmod{N}\\rangle $$\n3.  对第一个寄存器应用量子傅里叶变换 (QFT)。\n4.  测量第一个寄存器。测量结果是一个整数 $k \\in \\{0, 1, ..., Q-1\\}$。\n\n测量值 $k$ 很可能接近 $Q/r$ 的某个整数倍。然后可以使用连分数算法从 $k/Q$ 推导出周期 $r$。\n\n考虑以 $a=4$ 为基数分解 $N=21$ 的情况。设第一个寄存器由 $L=10$ 个量子比特组成，因此 $Q=1024$。假设在步骤 4 之后，第一个寄存器的测量结果为 $k=171$。当使用连分数算法处理此结果时，它给出了一个不同于真实周期的候选周期。计算测量到这个特定结果的确切概率 $P(k=171)$。", "solution": "我们希望计算\n$$P(k)=\\frac{1}{Q^2}\\sum_{y=0}^{r-1}\\Bigl|\\sum_{m=0}^{M_y-1}e^{2\\pi i\\,k(y+m r)/Q}\\Bigr|^2$$\n对于 $N=21$，$a=4$，因此 $r=\\min\\{r:a^r\\equiv1\\pmod{21}\\}=3$，$L=10$，$Q=2^{10}=1024$，以及观测到的 $k=171$。\n\n1.  确定 $M_y=\\#\\{m\\ge0:y+mr\\le Q-1\\}=\\left\\lfloor\\frac{Q-1-y}{r}\\right\\rfloor+1$。由于 $Q=3\\cdot341+1$，可以得到\n$$M_0=342,\\quad M_1=M_2=341.$$\n\n2.  定义\n$$\\theta=\\frac{2\\pi k r}{Q}=\\frac{2\\pi\\cdot171\\cdot3}{1024}\n=\\pi\\Bigl(1+\\tfrac1{512}\\Bigr),$$\n并令 $S_y=\\sum_{m=0}^{M_y-1}e^{i\\theta m}e^{2\\pi i k y/Q}$。等比级数公式给出\n$$\\Bigl|S_y\\Bigr|\n=\\Bigl|\\frac{1-e^{iM_y\\theta}}{1-e^{i\\theta}}\\Bigr|\n=\\frac{\\bigl|\\sin(\\tfrac{M_y\\theta}{2})\\bigr|}{\\bigl|\\sin(\\tfrac{\\theta}{2})\\bigr|}.$$\n\n3.  注意到\n$$\\frac{\\theta}{2}=\\frac\\pi2+\\frac{\\pi}{1024},\\qquad\n\\sin\\!\\bigl(\\tfrac\\theta2\\bigr)=\\cos\\!\\bigl(\\tfrac\\pi{1024}\\bigr),$$\n以及\n$$\\sin\\!\\bigl(171\\theta\\bigr)\n=\\sin\\!\\Bigl(\\pi\\frac{87723}{512}\\Bigr)\n=-\\sin\\!\\Bigl(\\frac{171\\pi}{512}\\Bigr),$$\n$$\\sin\\!\\bigl(341\\tfrac\\theta2\\bigr)\n=\\sin\\!\\Bigl(\\pi\\frac{174933}{1024}\\Bigr)\n=\\sin\\!\\Bigl(\\frac{853\\pi}{1024}\\Bigr)\n=\\sin\\!\\Bigl(\\frac{171\\pi}{1024}\\Bigr),$$\n我们得到\n$$|S_0|^2\n=\\frac{\\sin^2\\!\\bigl(171\\pi/512\\bigr)}{\\cos^2\\!(\\pi/1024)},\\quad\n|S_1|^2=|S_2|^2\n=\\frac{\\sin^2\\!\\bigl(171\\pi/1024\\bigr)}{\\cos^2\\!(\\pi/1024)}.$$\n\n4.  因此\n$$P(171)=\\frac{1}{1024^2}\\Bigl(|S_0|^2+2|S_1|^2\\Bigr)\n=\\frac{1}{1024^2\\cos^2(\\pi/1024)}\\Bigl[\\sin^2\\!\\bigl(\\tfrac{171\\pi}{512}\\bigr)\n+2\\sin^2\\!\\bigl(\\tfrac{171\\pi}{1024}\\bigr)\\Bigr].$$\n\n5.  最后使用 $\\sin(171\\pi/512)=2\\sin(171\\pi/1024)\\cos(171\\pi/1024)$ 来合并各项：\n$$P(171)\n=\\frac{2\\,\\sin^2\\!\\bigl(\\tfrac{171\\pi}{1024}\\bigr)\\bigl(2\\cos^2\\!\\tfrac{171\\pi}{1024}+1\\bigr)}\n{1024^2\\,\\cos^2\\!\\bigl(\\tfrac{\\pi}{1024}\\bigr)}.$$", "answer": "$$\\boxed{\\frac{2\\,\\sin^2\\!\\bigl(\\tfrac{171\\pi}{1024}\\bigr)\\bigl(2\\cos^2\\!\\tfrac{171\\pi}{1024}+1\\bigr)}{1024^2\\,\\cos^2\\!\\bigl(\\tfrac{\\pi}{1024}\\bigr)}}$$", "id": "48198"}, {"introduction": "量子算法的成功不仅依赖于量子计算的精确性，还依赖于后续的经典数据处理。这个练习模拟了一个在测量读出阶段发生单个比特翻转错误的常见情况。通过这个实践，你将亲身体会到算法对错误的敏感性，并理解一个微小的经典错误是如何可能使整个量子计算的努力付诸东流的。[@problem_id:48302]", "problem": "量子周期查找算法是用于整数分解的Shor算法的一个关键组成部分。其目的是找到一个函数 $f(x)$ 的周期 $r$，其中 $f(x+r)=f(x)$。该算法使用一个 $n$ 量子比特的寄存器，在应用量子傅里叶变换（QFT）并进行测量后，会产生一个整数结果 $k$。在理想条件下，分数 $k/2^n$ 是一个未知有理数 $c/r$ 的极佳近似，其中 $c$ 是一个与 $r$ 互质的随机整数。\n\n该算法的经典后处理部分包括对 $k/2^n$ 使用连分数算法，以找到近似它的候选分数 $p/q$。这些渐进分数的分母 $q$ 是周期 $r$ 的候选值。这一系列渐进分数，记为 $C_m = p_m/q_m$，$m=0, 1, 2, \\dots$，提供了越来越好的近似值。\n\n考虑一个使用 $n=11$ 量子比特寄存器的周期查找算法实例。其基础函数的周期为 $r=7$。算法的量子部分成功运行一次，会正确地得到测量结果 $k=585$。然而，在测量过程中，测量结果 $k$ 的最高有效位（MSB）发生了一个比特翻转错误。这导致了一个错误的数值 $k'$。\n\n使用这个错误的数值 $k'$，执行经典后处理步骤。计算比率 $k'/2^n$ 的连分数展开的第三个渐进分数 $C_2 = p_2/q_2$ 的分母。", "solution": "1. 翻转11比特测量值585的最高有效位（MSB）。在11比特中，585的MSB为0，所以翻转它相当于加上 $2^{10}$：\n$$k' = 585 + 2^{10} = 585 + 1024 = 1609.$$\n\n2. 构造比率\n$$\\frac{k'}{2^n} = \\frac{1609}{2^{11}} = \\frac{1609}{2048}.$$\n\n3. 计算 $1609/2048$ 的连分数展开：\n$$\\frac{1609}{2048} = [0;1,3,1,1,1,72,2].$$\n\n4. 使用标准递推关系\n$$p_{-2}=0,\\quad p_{-1}=1,\\quad p_k = a_k p_{k-1} + p_{k-2},$$\n$$q_{-2}=1,\\quad q_{-1}=0,\\quad q_k = a_k q_{k-1} + q_{k-2}.$$\n则\n- $C_0 = p_0/q_0 = 0/1$，\n- $C_1 = p_1/q_1 = 1/1$，\n- $C_2 = p_2/q_2$ 其中\n  $$p_2 = 3\\cdot p_1 + p_0 = 3\\cdot1 + 0 = 3,$$\n  $$q_2 = 3\\cdot q_1 + q_0 = 3\\cdot1 + 1 = 4.$$\n因此，第三个渐进分数 $C_2 = 3/4$ 的分母为 $q_2 = 4$。", "answer": "$$\\boxed{4}$$", "id": "48302"}]}