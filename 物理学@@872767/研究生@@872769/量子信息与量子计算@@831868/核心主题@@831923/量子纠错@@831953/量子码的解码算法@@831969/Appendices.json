{"hands_on_practices": [{"introduction": "为了将理论付诸实践，让我们从一个旨在建立几何直觉的练习开始。许多用于拓扑码（如环面码）的解码算法，其核心思想是在格子上找到连接“缺陷”（即综合征）的最小权重路径。这个练习将使用一个简单的贪心算法来模拟这个过程，帮助你理解像最小权重完美匹配（MWPM）这样的解码器背后的基本原理。 [@problem_id:66247]", "problem": "环面码是一种定义在具有周期性边界条件（一个环面）的二维方格晶格上的量子纠错码。量子比特放置在晶格的边上。该码由两类算符稳定：对每个顶点 $s$ 的星算符 $A_s = \\prod_{j \\in s} X_j$ 和对每个格子 $p$ 的格子算符 $B_p = \\prod_{j \\in \\partial p} Z_j$。\n\n量子比特上的泡利 $X$ 错误可能导致相邻的格子算符对在测量时得到 $-1$ 的结果。这些测量结果为 $-1$ 的格子被称为 Z-伴随子。解码的目标是根据伴随子的位置推断出 X-错误链，并应用一个由 X 算符组成的修正链，将状态恢复到编码空间。修正链必须将所有伴随子配对。寻找最可能的错误构型的问题，等价于寻找一组将伴随子配对且总长度（权重）最小的路径。\n\n考虑一个足够大的 $L \\times L$ 晶格上的环面码。一个错误事件产生了四个 Z-伴随子，位于格子 $p_1, p_2, p_3, p_4$。这些格子的中心可以用对偶晶格上的整数坐标 $(x,y)$ 来描述。伴随子位置由 $p_1=(0,0)$、$p_2=(W,0)$、$p_3=(0,H)$ 和 $p_4=(W,H)$ 给出，形成一个矩形。两个伴随子之间的距离是它们在对偶晶格上的曼哈顿距离，$d((x_i, y_i), (x_j, y_j)) = |x_i - x_j| + |y_i - y_j|$。这个距离对应于连接两个格子的最短 X-算符链的权重。\n\n一种简单的解码策略是贪心最近对算法。其工作原理如下：\n1.  从所有伴随子的集合开始。\n2.  找到具有最小曼哈顿距离的一对尚未配对的伴随子。\n3.  将这对配对。相应修正链的权重就是这个最小距离。\n4.  从待考虑的伴随子集合中移除这对已配对的伴随子。\n5.  重复步骤 2-4，直到所有伴随子都被配对。\n\n在选择最近对时，如果出现距离相同的情况，则选择满足 $i  j$ 的索引对 $(p_i, p_j)$ 中，字典序最小的一对（即首先比较 $i$，然后比较 $j$）。\n\n给定 $W=3$ 和 $H=1$，使用贪心最近对算法计算总修正权重。", "solution": "1. 伴随子坐标：\n   $p_1=(0,0)$, $p_2=(3,0)$, $p_3=(0,1)$, $p_4=(3,1)$。\n2. 计算曼哈顿距离 $d_{ij}=|x_i-x_j|+|y_i-y_j|$：\n   $$d_{12}=|0-3|+|0-0|=3,\\quad d_{13}=|0-0|+|0-1|=1,$$\n   $$d_{14}=|0-3|+|0-1|=4,\\quad d_{23}=|3-0|+|0-1|=4,$$\n   $$d_{24}=|3-3|+|0-1|=1,\\quad d_{34}=|3-3|+|1-1|=0.$$\n   修正：$d_{34}=|0-3|+|1-1|=3$。\n3. 贪心匹配过程：\n   - 距离矩阵中最小的非零距离是 1，对应于 $(p_1,p_3)$ 和 $(p_2,p_4)$ 两对。\n   - 根据字典序决胜规则，我们首先选择索引对 $(1,3)$。\n   - 匹配 $(p_1,p_3)$，权重为 $d_{13}=1$。\n   - 剩下的未配对伴随子是 $p_2$ 和 $p_4$。\n   - 它们之间唯一的配对是 $(p_2,p_4)$，权重为 $d_{24}=1$。\n4. 总修正权重是所有匹配权重的总和：$1+1=2$。", "answer": "$$\\boxed{2}$$", "id": "66247"}, {"introduction": "接下来，我们将从几何算法转向更强大但更抽象的概率解码器。置信传播（Belief Propagation, BP）是一种在代码的 Tanner 图上传递“置信度”（通常表示为对数似然比）的迭代算法。本练习将深入探讨其核心机制，即计算一个完整的迭代引发的消息更新，让你亲身体验该算法的运作方式。 [@problem_id:66341]", "problem": "Steane 码是一种 `[[7, 1, 3]]` 量子纠错码。其纠错特性源自经典的 `[7, 4, 3]` Hamming 码。当纠正比特翻转（$X$）错误时，需要测量与该经典码的奇偶校验相对应的校验子。任务是根据校验子和信道错误概率，找到最可能的错误模式，这项任务可以使用经典解码算法来完成。\n\n考虑使用和积算法（一种置信传播）进行解码。该算法在码的 Tanner 图上运行。设经典码由其奇偶校验矩阵 $H$ 定义，其中行对应于校验节点（$c_j$），列对应于变量节点（$v_i$）。如果 $H_{ji}=1$，则在 $c_j$ 和 $v_i$ 之间存在一条边。\n\n该算法通过在 Tanner 图的边上传递表示为对数似然比（LLRs）的消息来工作。二进制变量 $x$ 的 LLR 定义为 $L(x) = \\log(P(x=0)/P(x=1))$。令 $L_{ch,i}$ 为信道给出的变量 $v_i$ 的初始 LLR。\n\n消息是迭代更新的。\n-   初始的变量到校验节点的消息由信道给出：$L(q_{i \\to j})^{(0)} = L_{ch,i}$。\n-   在迭代 $t \\ge 1$ 中，从校验节点 $c_j$ 到变量节点 $v_i$ 的消息更新如下：\n    $$ L(r_{j \\to i})^{(t)} = 2 \\tanh^{-1} \\left( \\prod_{k \\in N(j) \\setminus \\{i\\}} \\tanh\\left(\\frac{L(q_{k \\to j})^{(t-1)}}{2}\\right) \\right) $$\n    其中 $N(j)$ 是连接到校验节点 $j$ 的变量节点的索引集合。\n-   然后，从变量节点 $v_i$ 到校验节点 $c_j$ 的消息更新如下：\n    $$ L(q_{i \\to j})^{(t)} = L_{ch,i} + \\sum_{k \\in N(i) \\setminus \\{j\\}} L(r_{k \\to i})^{(t)} $$\n    其中 $N(i)$ 是连接到变量节点 $i$ 的校验节点的索引集合。\n\n设与 Steane 码相关联的经典码的奇偶校验矩阵为：\n$$ H = \\begin{pmatrix} 0  0  0  1  1  1  1 \\\\ 0  1  1  0  0  1  1 \\\\ 1  0  1  0  1  0  1 \\end{pmatrix} $$\n行由 $j \\in \\{1, 2, 3\\}$ 索引，列由 $i \\in \\{1, 2, ..., 7\\}$ 索引。假设信道产生的错误使得初始 LLR 为：对于 $i \\in \\{1, 2, 3, 4, 5, 6\\}$，$L_{ch,i} = L_A$；以及 $L_{ch,7} = L_B$。\n\n计算和积算法一次完整迭代后的变量到校验节点消息 $L(q_{3 \\to 2})^{(1)}$。将您的答案表示为 $L_A$ 和 $L_B$ 的函数。", "solution": "奇偶校验矩阵 $H$ 如下所示：\n\n$$\nH = \\begin{pmatrix}\n0  0  0  1  1  1  1 \\\\\n0  1  1  0  0  1  1 \\\\\n1  0  1  0  1  0  1\n\\end{pmatrix}\n$$\n\n其中行（校验节点）由 $j \\in \\{1, 2, 3\\}$ 索引，列（变量节点）由 $i \\in \\{1, 2, \\dots, 7\\}$ 索引。初始 LLR 对于 $i \\in \\{1, 2, 3, 4, 5, 6\\}$ 为 $L_{\\text{ch},i} = L_A$，以及 $L_{\\text{ch},7} = L_B$。\n\n目标是计算一次完整迭代后的变量到校验节点消息 $L(q_{3 \\to 2})^{(1)}$。此消息按如下方式更新：\n\n$$\nL(q_{i \\to j})^{(t)} = L_{\\text{ch},i} + \\sum_{k \\in N(i) \\setminus \\{j\\}} L(r_{k \\to i})^{(t)}\n$$\n\n其中 $N(i)$ 是连接到变量节点 $i$ 的校验节点的集合。\n\n对于变量节点 $i = 3$，连接由 $H$ 的第 3 列中的非零项确定：\n- 第 3 列在第 2 行和第 3 行有 1，所以 $N(3) = \\{2, 3\\}$。\n\n因此，对于发送到校验节点 $j = 2$ 的消息：\n\n$$\nL(q_{3 \\to 2})^{(1)} = L_{\\text{ch},3} + \\sum_{k \\in N(3) \\setminus \\{2\\}} L(r_{k \\to 3})^{(1)}\n$$\n\n排除 $j = 2$ 后，求和是对 $k \\in \\{3\\}$ 进行的（因为 $N(3) \\setminus \\{2\\} = \\{3\\}$）。因此：\n\n$$\nL(q_{3 \\to 2})^{(1)} = L_A + L(r_{3 \\to 3})^{(1)}\n$$\n\n因为 $L_{\\text{ch},3} = L_A$。\n\n现在，计算 $L(r_{3 \\to 3})^{(1)}$，即从校验节点 3 到变量节点 3 的校验到变量节点消息。更新规则是：\n\n$$\nL(r_{j \\to i})^{(t)} = 2 \\tanh^{-1} \\left( \\prod_{k \\in N(j) \\setminus \\{i\\}} \\tanh\\left( \\frac{L(q_{k \\to j})^{(t-1)}}{2} \\right) \\right)\n$$\n\n其中 $N(j)$ 是连接到校验节点 $j$ 的变量节点的集合。\n\n对于校验节点 $j = 3$，连接由 $H$ 的第 3 行中的非零项确定：\n- 第 3 行在第 1、3、5、7 列有 1，所以 $N(3) = \\{1, 3, 5, 7\\}$。\n\n因此，对于发送到变量节点 $i = 3$ 的消息：\n\n$$\nL(r_{3 \\to 3})^{(1)} = 2 \\tanh^{-1} \\left( \\prod_{k \\in N(3) \\setminus \\{3\\}} \\tanh\\left( \\frac{L(q_{k \\to 3})^{(0)}}{2} \\right) \\right)\n$$\n\n排除 $i = 3$ 后，乘积是对 $k \\in \\{1, 5, 7\\}$ 进行的。\n\n在 $t = 0$ 时的初始变量到校验节点消息是 $L(q_{k \\to j})^{(0)} = L_{\\text{ch},k}$：\n- 对于 $k = 1$：$L(q_{1 \\to 3})^{(0)} = L_{\\text{ch},1} = L_A$\n- 对于 $k = 5$：$L(q_{5 \\to 3})^{(0)} = L_{\\text{ch},5} = L_A$\n- 对于 $k = 7$：$L(q_{7 \\to 3})^{(0)} = L_{\\text{ch},7} = L_B$\n\n将这些代入乘积中：\n\n$$\n\\prod_{k \\in \\{1, 5, 7\\}} \\tanh\\left( \\frac{L(q_{k \\to 3})^{(0)}}{2} \\right) = \\tanh\\left( \\frac{L_A}{2} \\right) \\cdot \\tanh\\left( \\frac{L_A}{2} \\right) \\cdot \\tanh\\left( \\frac{L_B}{2} \\right) = \\left[ \\tanh\\left( \\frac{L_A}{2} \\right) \\right]^2 \\tanh\\left( \\frac{L_B}{2} \\right)\n$$\n\n\n因此：\n\n$$\nL(r_{3 \\to 3})^{(1)} = 2 \\tanh^{-1} \\left( \\left[ \\tanh\\left( \\frac{L_A}{2} \\right) \\right]^2 \\tanh\\left( \\frac{L_B}{2} \\right) \\right)\n$$\n\n\n现在将其代回 $L(q_{3 \\to 2})^{(1)}$ 的表达式中：\n\n$$\nL(q_{3 \\to 2})^{(1)} = L_A + 2 \\tanh^{-1} \\left( \\left[ \\tanh\\left( \\frac{L_A}{2} \\right) \\right]^2 \\tanh\\left( \\frac{L_B}{2} \\right) \\right)\n$$\n\n\n这是一次完整迭代后消息的最终表达式。", "answer": "$$\n\\boxed{L_A + 2 \\tanh^{-1} \\left( \\tanh^{2} \\left( \\frac{L_A}{2} \\right) \\tanh \\left( \\frac{L_B}{2} \\right) \\right)}\n$$", "id": "66341"}, {"introduction": "最后，我们来探讨一个至关重要的概念：解码器为何会失败以及如何失败。即使是像最小权重完美匹配（MWPM）这样的最优匹配算法，也可能被特定的错误模式“欺骗”，从而导致逻辑错误，即在解码后，编码的量子信息被意外改变。这个练习将通过一个具体的例子，展示如何确定导致这种解码失败的最低权重物理错误，从而揭示解码器性能的内在局限性。 [@problem_id:66369]", "problem": "一个距离为 $d=5$ 的平面码定义在一个 $d \\times d$ 的方形晶格上，其中量子比特位于顶点上。该码旨在防护局域错误。对于本问题，我们仅考虑单量子比特泡利X错误及其探测。\n\n用于探测这些X错误的稳定子是Z-方格算符 $B_p = \\prod_{q \\in p} Z_q$，其中乘积遍及一个方格 $p$ 四个角上的四个量子比特。作用于某个量子比特上的X错误会与周围的四个方格稳定子反对易（如果量子比特在边界上，则会少于四个），从而将其本征值从 $+1$ 翻转为 $-1$。这些被违背的稳定子被称为伴随式。\n\n解码器的任务是根据伴随式信息推断出最可能的错误构型。并查集（Union-Find）解码器是一种高效算法，对于所考虑的错误模型，其功能相当于最小权重完美匹配（MWPM）解码器。它会找到一个修正算符 $C$（一个X错误的集合），该算符可以解释给定的伴随式，并且具有最小可能数量的错误（即最小权重）。\n\n如果解码器给出的修正 $C$ 与真实的物理错误 $E$ 不同，并且组合操作 $E \\cdot C^{-1} = E \\cdot C$（因为 $X_q^2=I$）导致一个净逻辑算符作用于编码态上，则发生逻辑失效。这种情况发生在存在一个权重 $w(C)  w(E)$ 的错误链 $C$，它产生与 $E$ 相同的伴随式，并且 $E \\cdot C$ 等效于一个逻辑算符 $L_X$。注意，根据定义，任何逻辑算符 $L_X$ 在码的体（内部）都是无伴随式的。\n\n对于一个距离为 $d=5$ 的表面码，最小权重的逻辑X算符 $L_X$ 是作用在晶格某一行上所有 $d=5$ 个量子比特上的X算符串。\n\n找出导致此系统中发生逻辑失效的物理错误构型 $E$ 的最小权重。", "solution": "我们用 $S$ 表示最小逻辑算符 $L_X$ 的支集（一行 $d=5$ 个量子比特），用 $T$ 表示任意候选修正 $C$ 的支集。令\n$$\nd=5,\\quad c=\\lvert T\\rvert,\\quad k=\\lvert S\\cap T\\rvert.\n$$\n由于 $E=L_X C$（因此 $E$ 和 $C$ 具有相同的伴随式），并且泡利-X乘法对应于支集的对称差，所以 $E$ 的权重为\n$$\ne=\\lvert S\\oplus T\\rvert\n=\\lvert S\\rvert+\\lvert T\\rvert-2\\lvert S\\cap T\\rvert\n=5 + c - 2k.\n$$\n逻辑失效要求解码器选择 $C$（权重为 $c$）而不是 $E$（权重为 $e$），即 $c  e$。将 $e$ 的表达式代入该不等式，我们得到 $c  5 + c - 2k$，化简后为 $2k  5$。由于 $k$ 是整数，这意味着 $k$ 的最大可能值为2。物理错误的权重为 $e = 5+c-2k$。为了最小化 $e$，我们需要最小化 $c$ 并最大化 $k$。我们选择 $k$ 的最大可能值 $k=2$。要使修正 $C$ 与 $L_X$ 的交集大小为 $k=2$，修正的权重 $c$ 必须至少为2。因此，我们选择最小可能的 $c=2$。代入这些值，我们得到 $e = 5+2-2(2)=3$。这个解是自洽的，因为 $c=2  e=3$ 满足逻辑失效的条件。因此，导致逻辑失效的物理错误的最小权重是3。", "answer": "$$\\boxed{3}$$", "id": "66369"}]}