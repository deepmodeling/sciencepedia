{"hands_on_practices": [{"introduction": "要理解 BB84 协议如何保障安全性，首先需要分析窃听者的行为会如何暴露。第一个练习将探讨最基本、最直接的窃听策略：“拦截重发”攻击。通过计算这种攻击所导致的量子比特错误率（QBER），您将发现一个基本原理：任何窃听者（Eve）获取信息的企图都不可避免地会引入可被检测到的扰动 [@problem_id:715047]。", "problem": "在一个基于 BB84 协议的量子密钥分发方案中，Alice 向 Bob 发送单光子。对于每次传输，她使用两种偏振基中的一种——直角基（$+$）或对角基（$\\times$）——随机地编码一个经典比特（'0' 或 '1'）。\n这些基的量子态定义如下：\n- 直角基（$+$）：$|0\\rangle$（水平偏振），$|1\\rangle$（垂直偏振）。\n- 对角基（$\\times$）：$|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$，$|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$。\n\nAlice 为每个光子完全随机地选择她的基，选择直角基的概率为 $\\frac{1}{2}$，选择对角基的概率也为 $\\frac{1}{2}$。类似地，Bob 在测量每个入射光子时，也以各 $\\frac{1}{2}$ 的概率随机选择他的测量基。在量子传输之后，Alice 和 Bob 通过一个公共经典信道进行通信以进行基比对，只保留他们使用相同基的那些比特。这组比特构成了筛选密钥。\n\n一个窃听者 Eve 发动了截获重发攻击。她截获来自 Alice 的每一个光子，对其进行测量，然后根据她的测量结果制备一个新的光子发送给 Bob。然而，Eve 的策略不是对称的。她怀疑 Alice 可能对某一基有所偏好，因此她有偏向性地选择她的测量基：她以概率 $p$ 使用直角基（$+$），并以概率 $1-p$ 使用对角基（$\\times$）。\n\n推导这种攻击在 Alice 和 Bob 共享的筛选密钥中所引起的量子比特错误率（QBER）。QBER 定义为筛选密钥中与 Alice 原始发送的比特不同的比特所占的比例。请将您的答案表示为 $p$ 的函数。", "solution": "我们用 $A\\in\\{+,\\times\\}$ 表示 Alice 的基，用 $E\\in\\{+,\\times\\}$ 表示 Eve 的基（选择概率为 $P(E=+)=p$），用 $B\\in\\{+,\\times\\}$ 表示 Bob 的基。 当 $A=B$ 时得到筛选密钥，这种情况发生的概率为\n$$P(A=B)=P(A=+,B=+)+P(A=\\times,B=\\times)=\\tfrac14+\\tfrac14=\\tfrac12.$$\n分两种情况讨论：\n\n情况 1：$A=B=+$。此时\n- 如果 $E=+$（概率为 $p$），Eve 会正确测量并重发正确的状态 $\\Rightarrow$ 没有错误。\n- 如果 $E=\\times$（概率为 $1-p$），Eve 的测量结果是随机的，而 Bob 的测量有 $\\tfrac12$ 的概率产生错误。\n因此\n$$P(\\text{error}\\mid A=B=+)=p\\cdot0+(1-p)\\cdot\\tfrac12=\\tfrac{1-p}2.$$\n情况 2：$A=B=\\times$。类似地\n$$P(\\text{error}\\mid A=B=\\times)=p\\cdot\\tfrac12+(1-p)\\cdot0=\\tfrac p2.$$\n因此，发生错误且为筛选事件的联合概率是\n$$P(\\text{error},A=B)\n=\\tfrac14\\cdot\\tfrac{1-p}2+\\tfrac14\\cdot\\tfrac p2\n=\\tfrac{1}{8}.$$\n最后，QBER 为\n$$\n\\text{QBER}\n=\\frac{P(\\text{error},A=B)}{P(A=B)}\n=\\frac{\\tfrac18}{\\tfrac12}\n=\\frac14.\n$$", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "715047"}, {"introduction": "在真实的量子通信系统中，错误不仅可能来自窃听者，也可能源于设备本身。这个练习将我们的关注点从敌对攻击转向物理硬件的固有缺陷。您将分析量子信道的损耗和探测器的暗计数如何共同影响总体的量子比特错误率（QBER），这是建立基线错误率的关键一步，对于将固有噪声与潜在的恶意攻击区分开来至关重要 [@problem_id:143401]。", "problem": "在BB84量子密钥分发协议的一个简化模型中，我们考虑信道损耗和探测器暗计数对量子比特错误率（QBER）的影响。\n\nAlice 通过一个透过率为 $\\eta$（其中 $0 \\le \\eta \\le 1$）的量子信道向 Bob 发送单光子量子比特。对于每个比特，Bob 随机选择一个测量基（Z基或X基）。对于给定的测量基选择，Bob 的探测装置由两个理想的单光子探测器组成。例如，在Z基下，一个探测器（$D_0$）对状态 $|0\\rangle$ 产生响应，另一个探测器（$D_1$）对状态 $|1\\rangle$ 产生响应。\n\n探测器并非完美，会受暗计数影响。在给定的时间窗口内，即使没有光子入射，每个探测器也有 $p_d$ 的概率触发。我们假设这些暗计数事件对于每个探测器是独立的。我们还假设 $p_d$ 足够小，以至于更复杂的错误来源可以忽略不计。信道本身不会引起比特翻转错误，只会导致光子丢失。\n\n在传输阶段之后，Alice 和 Bob 进行筛选，只保留他们使用相同测量基的结果。对于这些经过筛选的比特，当且仅当两个相应的探测器中**恰好有一个**触发时，该结果才被视为有效并被添加到密钥中。如果两个探测器都触发或都不触发，则该时间窗口的结果将被丢弃。\n\n对于一个经过筛选的比特，如果触发的探测器与 Alice 最初发送的比特值不对应，则记录一个错误。例如，如果 Alice 发送了“0”，并且 Bob 在相同的基上进行测量，那么如果探测器 $D_1$ 触发而 $D_0$ 没有触发，就会发生错误。\n\n计算筛选后密钥的 QBER，将其表示为信道透过率 $\\eta$ 和探测器暗计数概率 $p_d$ 的函数。", "solution": "为了计算量子比特错误率（QBER），我们考虑 Alice 和 Bob 使用相同测量基（经过筛选后）的情景。QBER 定义为错误的有效探测数与总有效探测数之比。当且仅当恰好一个探测器触发时，发生一次有效探测。如果触发的探测器与 Alice 发送的比特不对应，则发生错误。\n\n假设 Alice 发送比特“0”（发送“1”的情况是对称的）。信道透过率为 $\\eta$，因此光子被 Bob 接收到的概率为 $\\eta$，丢失的概率为 $1-\\eta$。Bob 使用两个理想探测器：$D_0$ 用于状态 $|0\\rangle$，$D_1$ 用于状态 $|1\\rangle$。每个探测器的暗计数概率为 $p_d$，且暗计数是独立的。\n\n**情况1：光子被接收（概率为 $\\eta$）**\n- 光子触发 $D_0$（因为 Alice 发送了“0”），所以 $D_0$ 以概率1触发。\n- $D_1$ 可能因暗计数而触发，概率为 $p_d$。\n  - 如果 $D_1$ 不触发（概率为 $1 - p_d$），则恰好有一个探测器（$D_0$）触发，从而产生一次有效且正确的探测。\n  - 如果 $D_1$ 触发（概率为 $p_d$），则两个探测器都触发，导致一个无效事件（被丢弃）。\n因此，对于一个被接收的光子：\n- 有效探测的概率：$\\eta (1 - p_d)$\n- 发生错误的概率：0（因为 $D_0$ 总是触发，任何有效事件都是正确的）\n\n**情况2：光子丢失（概率为 $1 - \\eta$）**\n- 没有光子到达，因此探测完全由暗计数引起。\n- $D_0$ 触发的概率为 $p_d$（暗计数），不触发的概率为 $1 - p_d$。\n- $D_1$ 触发的概率为 $p_d$，不触发的概率为 $1 - p_d$。\n有效探测（恰好一个探测器触发）：\n- $D_0$ 触发而 $D_1$ 不触发：概率为 $p_d (1 - p_d)$\n- $D_1$ 触发而 $D_0$ 不触发：概率为 $p_d (1 - p_d)$\n有效探测的总概率：$2 p_d (1 - p_d)$\n在这些有效探测中：\n- 仅 $D_0$ 触发：Bob 记录“0”（正确）\n- 仅 $D_1$ 触发：Bob 记录“1”（错误，因为 Alice 发送了“0”）\n发生错误的概率：$p_d (1 - p_d)$\n\n**总概率**\n- 一次有效探测的概率（当 Alice 发送“0”时）：\n\n$$\n  P_{\\text{valid}} = \\eta (1 - p_d) + (1 - \\eta) \\cdot 2 p_d (1 - p_d)\n  $$\n\n- 一次有效探测中发生错误的概率（当 Alice 发送“0”时）：\n\n$$\n  P_{\\text{error}} = (1 - \\eta) p_d (1 - p_d)\n  $$\n\n\n根据对称性，当 Alice 发送“1”时，表达式是相同的。由于 Alice 以相等的概率发送每个比特，因此总概率是相同的。\n\n**QBER 计算**\nQBER 是错误概率与有效探测概率之比：\n\n$$\n\\text{QBER} = \\frac{P_{\\text{error}}}{P_{\\text{valid}}} = \\frac{(1 - \\eta) p_d (1 - p_d)}{\\eta (1 - p_d) + 2 (1 - \\eta) p_d (1 - p_d)}\n$$\n\n对分母提取公因式 $(1 - p_d)$：\n\n$$\nP_{\\text{valid}} = (1 - p_d) \\left[ \\eta + 2 (1 - \\eta) p_d \\right]\n$$\n\n因此，\n\n$$\n\\text{QBER} = \\frac{(1 - \\eta) p_d (1 - p_d)}{(1 - p_d) \\left[ \\eta + 2 (1 - \\eta) p_d \\right]} = \\frac{(1 - \\eta) p_d}{\\eta + 2 (1 - \\eta) p_d}\n$$\n\n前提是 $1 - p_d \\neq 0$（当 $p_d  1$ 时成立）。\n\nQBER 的表达式为：\n\n$$\n\\text{QBER} = \\frac{(1 - \\eta) p_d}{\\eta + 2 (1 - \\eta) p_d}\n$$", "answer": "$$ \\boxed{\\dfrac{ (1-\\eta) p_d }{ \\eta + 2 (1-\\eta) p_d }} $$", "id": "143401"}, {"introduction": "当 Alice 和 Bob 生成筛选密钥后，他们面临一个关键问题：真实的错误率究竟是多少？为了回答这个问题，他们必须牺牲一部分密钥进行公开比较。最后一个练习将深入探讨这一过程的统计学基础，利用霍夫丁不等式来确定需要多少测试比特，才能在给定的置信水平下可靠地估计出 QBER [@problem_id:143242]。这一计算是在任何实际的量子密钥分发（QKD）实现中做出严格、可量化的安全声明的基石。", "problem": "在BB84量子密钥分发协议中，Alice和Bob传输量子态并公开协调其测量基之后，他们会得到一个共享的“筛选密钥”（sifted key）。在从这个筛选密钥中提取安全的私钥之前，他们必须估计量子比特错误率（QBER），我们将其表示为 $Q$。QBER是筛选密钥中一个比特被翻转的真实概率（即，Alice有一个0而Bob有一个1，或者反之亦然）。\n\n为了做到这一点，他们同意牺牲其筛选密钥中随机选择的 $n$ 个比特的子集。他们公开比较这 $n$ 个比特，并计算不匹配的数量，以计算出一个经验错误率 $\\hat{Q}$。\n\n为了最终密钥的安全性，至关重要的是不能显著低估真实的QBER。一种保守的方法是基于观测值 $\\hat{Q}$ 来建立 $Q$ 的一个上界。具体来说，Alice和Bob要求真实的QBER $Q$ 不大于他们观测到的错误率 $\\hat{Q}$ 加上一个小的容差 $\\epsilon$，即 $Q \\le \\hat{Q} + \\epsilon$。如果这个条件被违反，协议就被认为是不安全的。他们希望将这种安全性失效的概率 $P(Q  \\hat{Q} + \\epsilon)$ 限制在一个小的安全参数 $\\delta$ 以内。\n\n假设比特错误是独立同分布地发生的，你可以使用单边Hoeffding不等式。对于 $n$ 个独立同分布的伯努利随机变量的经验平均值 $\\hat{p}$（其真实均值为 $p$），该不等式对低估的概率给出了如下界限：\n$$\nP(p - \\hat{p} \\ge \\epsilon) \\le e^{-2n\\epsilon^2}\n$$\n给定一个期望的精度 $\\epsilon$ 和一个安全性失效概率 $\\delta$，确定Alice和Bob必须比较的最小整数测试比特数 $n$，以满足他们的安全要求。用 $\\epsilon$ 和 $\\delta$ 的函数来表示你的答案。", "solution": "问题要求计算所需的最小测试比特数 $n$，以确保将真实量子比特错误率（QBER）$Q$ 低估超过一个精度 $\\epsilon$ 的概率最多为 $\\delta$。\n\n1.  **定义变量和安全条件：**\n    -   $Q$：真实的QBER，即错误分布的真实均值（不等式中的 $p$）。\n    -   $\\hat{Q}$：从 $n$ 个测试比特中经验性测量的QBER，即样本均值（不等式中的 $\\hat{p}$）。\n    -   $n$：测试比特的数量，即样本数量。\n    -   $\\epsilon$：期望的精度或容差。\n    -   $\\delta$：最大可容忍的安全性失效概率。\n\n    安全性失效事件定义为真实的QBER大于估计率加上容差：$Q  \\hat{Q} + \\epsilon$。这可以重写为 $Q - \\hat{Q}  \\epsilon$。安全要求是此事件的概率最多为 $\\delta$：\n    $$\n    P(Q - \\hat{Q}  \\epsilon) \\le \\delta\n    $$\n\n2.  **应用Hoeffding不等式：**\n    每个测试比特的比较可以建模为一个伯努利试验：结果为1（错误）的概率为 $Q$，结果为0（无错误）的概率为 $1-Q$。经验错误率 $\\hat{Q}$ 是 $n$ 个这样的独立同分布试验的平均值。\n\n    问题提供了单边Hoeffding不等式：\n    $$\n    P(p - \\hat{p} \\ge \\epsilon) \\le e^{-2n\\epsilon^2}\n    $$\n    将我们的变量映射到这个不等式：$p \\to Q$ 和 $\\hat{p} \\to \\hat{Q}$。所以我们有：\n    $$\n    P(Q - \\hat{Q} \\ge \\epsilon) \\le e^{-2n\\epsilon^2}\n    $$\n    事件 $Q - \\hat{Q}  \\epsilon$ 是事件 $Q - \\hat{Q} \\ge \\epsilon$ 的一个子集。因此，后者的概率上界也是前者的概率上界：\n    $$\n    P(Q - \\hat{Q}  \\epsilon) \\le P(Q - \\hat{Q} \\ge \\epsilon) \\le e^{-2n\\epsilon^2}\n    $$\n\n3.  **强制执行安全条件：**\n    为了满足安全要求 $P(Q - \\hat{Q}  \\epsilon) \\le \\delta$，我们可以强制执行一个更强的条件，即其来自Hoeffding不等式的上界小于或等于 $\\delta$：\n    $$\n    e^{-2n\\epsilon^2} \\le \\delta\n    $$\n\n4.  **求解 n：**\n    我们现在对这个不等式求解 $n$。首先，对两边取自然对数。由于 $\\ln(x)$ 是一个单调递增函数，不等式的方向保持不变。\n    $$\n    \\ln\\left(e^{-2n\\epsilon^2}\\right) \\le \\ln(\\delta)\n    $$\n    $$\n    -2n\\epsilon^2 \\le \\ln(\\delta)\n    $$\n    接下来，两边同乘以 $-1$。这会反转不等式的方向：\n    $$\n    2n\\epsilon^2 \\ge -\\ln(\\delta)\n    $$\n    使用对数性质 $-\\ln(x) = \\ln(1/x)$，我们得到：\n    $$\n    2n\\epsilon^2 \\ge \\ln\\left(\\frac{1}{\\delta}\\right)\n    $$\n    最后，通过除以 $2\\epsilon^2$（这是一个正数，因为 $\\epsilon0$）来分離 $n$：\n    $$\n    n \\ge \\frac{1}{2\\epsilon^2} \\ln\\left(\\frac{1}{\\delta}\\right)\n    $$\n\n5.  **确定最小整数值：**\n    测试比特数 $n$ 必须是一个整数。该不等式给出了 $n$ 的一个下界。满足此条件的最小整数值是大于或等于右侧表达式的最小整数。这由向上取整函数（ceiling function）给出。\n    $$\n    n_{min} = \\left\\lceil \\frac{1}{2\\epsilon^2} \\ln\\left(\\frac{1}{\\delta}\\right) \\right\\rceil\n    $$\n    这就是所需最小测试比特数的最终表达式。", "answer": "$$ \\boxed{\\left\\lceil \\frac{1}{2\\epsilon^2} \\ln\\left(\\frac{1}{\\delta}\\right) \\right\\rceil} $$", "id": "143242"}]}