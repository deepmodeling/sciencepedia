## 引言
[BB84协议](@entry_id:138648)是[量子密码学](@entry_id:144827)的奠基性成果，它利用量子力学的基本原理，为实现理论上[无条件安全](@entry_id:144745)的信息交换提供了可能。然而，在从优雅的理论走向复杂的现实应用过程中，出现了一个关键的知识鸿沟：理想模型中的[绝对安全](@entry_id:262916)性如何应对物理设备的不完美、信道噪声以及日益狡猾的攻击手段？本文旨在系统性地填补这一鸿沟，为读者构建一幅从核心理论到前沿实践的全景图。在接下来的内容中，读者将首先深入学习“原理与机制”章节，掌握[BB84协议](@entry_id:138648)的运作方式、安全性基础以及密钥提纯过程。随后，在“应用与跨学科连接”章节，我们将探讨协议在实际部署中面临的挑战、相应的解决方案（如诱骗态和[MDI-QKD](@entry_id:138134)），并揭示其与密码学其他分支及基础物理学的深刻联系。最后，通过“动手实践”中的具体问题，读者将有机会巩固所学知识，并将其应用于解决实际的安全分析问题。这个结构化的学习路径将引导您从量子世界的微观规则出发，最终抵达构建安全量子通信网络的宏观视野。

## 原理与机制

BB84 协议的运行和安全性植根于量子力学的几个基本原理。本章将系统地阐述这些核心原理，从协议的基本操作流程开始，逐步深入到其安全性的理论基础和实际应用中的关键过程。我们将探讨[量子态](@entry_id:146142)的制备与测量、窃听行为如何引入可被检测的错误，以及如何通过经典后处理步骤从受干扰的原始密钥中提炼出最终的安全密钥。

### 核心协议机制

BB84 协议的核心思想是利用非正交[量子态](@entry_id:146142)的不可区分性。协议的通信双方，通常称为 Alice（发送方）和 Bob（接收方），利用两组共轭基（conjugate bases）来编码和解码信息。

最常用的两组基是：
1.  **Z 基（或称直线基、计算基）**：由两个正交态 $|0\rangle$ 和 $|1\rangle$ 构成。
2.  **X 基（或称对角基、Hadamard 基）**：由两个正交态 $|+\rangle$ 和 $|-\rangle$ 构成。这两个态可以表示为 Z 基的叠加：
    $$ |+\rangle = \frac{1}{\sqrt{2}}(|0\rangle + |1\rangle) $$
    $$ |-\rangle = \frac{1}{\sqrt{2}}(|0\rangle - |1\rangle) $$

这两组基的一个关键特性是它们是 **互不偏倚（mutually unbiased）** 的。这意味着，如果一个[量子比特](@entry_id:137928)在 X 基中被制备（例如，处于 $|+\rangle$ 态），然后用 Z 基进行测量，其结果将是完全随机的。具体来说，测量到 $|0\rangle$ 的概率和测量到 $|1\rangle$ 的概率都是 $1/2$。反之亦然。正是这种测量结果的不确定性，构成了探测窃听的基础。

协议的[量子通信](@entry_id:138989)阶段如下：
1.  **编码（Alice）**：Alice 想要发送一个随机的经典比特序列。对于序列中的每一个比特，她随机选择 Z 基或 X 基中的一个进行编码。例如，她可以约定用 $|0\rangle$ 和 $|+\rangle$ 代表比特“0”，用 $|1\rangle$ 和 $|-\rangle$ 代表比特“1”。
2.  **传输**：Alice 通过量子信道将这一系列单[光子](@entry_id:145192)（或单个[量子比特](@entry_id:137928)）发送给 Bob。
3.  **测量（Bob）**：对于接收到的每一个[量子比特](@entry_id:137928)，Bob 同样随机地选择 Z 基或 X 基中的一个进行测量，并记录下测量结果。

由于 Alice 和 Bob 的基选择是独立且随机的，在约 $50\%$ 的情况下，他们会碰巧选择相同的基。在另外 $50\%$ 的情况下，他们的基选择会不匹配。

#### 密钥筛选

量子传输完成后，Alice 和 Bob 进入一个称为 **密钥筛选（key sifting）** 的公共讨论阶段。他们通过一个经典的、可被窃听的信道，对自己为每个[量子比特](@entry_id:137928)所选择的基序列进行比对。他们保留那些双方使用了相同基的测量结果，并丢弃所有基不匹配的结果。这个过程结束后，他们得到一串较短的比特序列，称为 **筛选密钥（sifted key）**。在理想情况下，由于他们在相同的基上进行了制备和测量，他们的筛选密钥应该是完全一致的。

筛选密钥的预期长度是协议效率的一个基本衡量标准。假设 Alice 发送了 $N$ 个[光子](@entry_id:145192)。在最理想的情况下，即 Alice 和 Bob 对两种基的选择都是完全随机的（概率均为 $1/2$），并且没有[光子](@entry_id:145192)在传输中丢失，他们选择相同基（Z-Z 或 X-X）的概率是 $P(\text{match}) = P(A_Z, B_Z) + P(A_X, B_X) = (\frac{1}{2} \times \frac{1}{2}) + (\frac{1}{2} \times \frac{1}{2}) = \frac{1}{2}$。因此，筛选密钥的预期长度是 $N/2$。

然而，在实际应用中，情况更为复杂。基选择可能存在偏好，[量子信道](@entry_id:145403)也存在固有的[光子](@entry_id:145192)损耗。我们可以建立一个更实际的模型来计算筛选密钥的预期长度 [@problem_id:122686]。假设 Alice 以概率 $p_A$ 选择 Z 基，Bob 以概率 $p_B$ 选择 Z 基。此外，信道损耗可能依赖于 Bob 的测量设置：当 Bob 选择 Z 基时，[光子](@entry_id:145192)丢失的概率为 $\eta_Z$；选择 X 基时，丢失概率为 $\eta_X$。

对于单个[光子](@entry_id:145192)，它能成功贡献一个比特到筛选密钥中，必须满足两个条件：(1) Alice 和 Bob 选择了相同的基；(2) 该[光子](@entry_id:145192)没有丢失。因此，单次传输成功的概率是：
$$ P(\text{sifted bit}) = P(A=Z, B=Z) \times P(\text{no loss}|B=Z) + P(A=X, B=X) \times P(\text{no loss}|B=X) $$
$$ P(\text{sifted bit}) = p_A p_B (1-\eta_Z) + (1-p_A)(1-p_B)(1-\eta_X) $$
对于初始发送的 $N$ 个[光子](@entry_id:145192)，筛选密钥的预期长度 $L_{sift}$ 就是 $N \times P(\text{sifted bit})$。这个例子清晰地展示了协议的产出效率如何受到实际设备参数和信道特性的影响。

### [量子比特](@entry_id:137928)错误率（QBER）及其来源

在理想情况下，Alice 和 Bob 的筛选密钥是完全相同的。然而，在现实世界中，由于信道噪声或潜在的窃听行为，Bob 的测量结果可能与 Alice 发送的比特值不符。这种不一致的比例被称为 **[量子比特](@entry_id:137928)错误率（Quantum Bit Error Rate, QBER）**。QBER 是一个至关重要的参数，Alice 和 Bob 通过牺牲一小部分筛选密钥并公开比对，来估计其大小。一个非零的 QBER 揭示了信道的非理想性，更重要的是，它为窃听者的存在提供了证据。

QBER 的来源可以分为两类：内在错误和由窃听引起的错误。

#### 内在 QBER 与信道噪声

即使没有窃听者，系统的不完美也会导致错误。例如，Alice 的量子光源可能不稳定，Bob 的探测器可能没有完美校准，或者量子信道本身就存在噪声。

一个典型的例子是 **[参考系](@entry_id:169232)未对准** [@problem_id:122687]。假设 Bob 的测量设备相对于 Alice 的[参考系](@entry_id:169232)有一个微小的旋转角度 $\theta$。这意味着 Bob 的测量基 $\{|0'\rangle, |1'\rangle\}$ 和 $\{|+'\rangle, |-'\}\rangle$ 是 Alice 基旋转 $\theta$ 后的结果。例如，Bob 的 Z 基由 $R(\theta) = \begin{pmatrix} \cos\theta  -\sin\theta \\ \sin\theta  \cos\theta \end{pmatrix}$ 旋转得到：$|0'\rangle = \cos\theta|0\rangle + \sin\theta|1\rangle$ 和 $|1'\rangle = -\sin\theta|0\rangle + \cos\theta|1\rangle$。

当 Alice 发送 $|0\rangle$（比特“0”）且 Bob 也使用 Z 基测量时，Bob 错误地测得比特“1”（即结果为 $|1'\rangle$）的概率是 $|\langle 1' | 0 \rangle|^2 = |-\sin\theta|^2 = \sin^2\theta$。由于协议的对称性，可以证明当 Alice 发送 $|1\rangle$ 时，Bob 测得“0”的概率也是 $\sin^2\theta$。同样，当双方都使用 X 基时，错误率也是 $\sin^2\theta$。因此，这种系统性的旋转误差会导致一个固有的 QBER，其值为 $Q = \sin^2\theta$。

有趣的是，一个完全不同的物理问题——**Alice 的光源制备不完美**——可以导致数学上相同的结果 [@problem_id:143404]。如果 Alice 的光源存在系统性误差，使得她意图发送的任何状态 $|\psi\rangle$ 实际上都被旋转了 $\theta$ 角，变为 $U(\theta)|\psi\rangle$，那么最终产生的 QBER 同样是 $\sin^2\theta$。这揭示了[量子信息](@entry_id:137721)的一个深刻特性：不同的物理过程可以通过相同的数学模型来描述，其可观测的后果也是相同的。

除了设备不完美，**信道噪声** 是另一个主要的内在错误来源。真实量子信道与环境的相互作用会改变传输中[量子态](@entry_id:146142)的性质。常见的[噪声模型](@entry_id:752540)包括：
- **[振幅阻尼信道](@entry_id:141880)（Amplitude Damping Channel）** [@problem_id:143272]：模拟[能量耗散](@entry_id:147406)过程，例如[激发态](@entry_id:261453) $|1\rangle$ 有一定概率 $\gamma$ 衰减到[基态](@entry_id:150928) $|0\rangle$。这种噪声对 Z 基的影响是不对称的（$|0\rangle$ 不变，但 $|1\rangle$ 可能变成 $|0\rangle$），而对 X 基的影响则是对称地降低相干性。它导致的 QBER 为 $Q = \frac{\gamma + 1 - \sqrt{1-\gamma}}{4}$。
- **[相位阻尼](@entry_id:147888)信道（Phase Damping Channel）** [@problem_id:45842]：模拟失去相位信息但没有能量交换的过程（[纯退相干](@entry_id:204036)）。它保持 Z 基的本征态不变，因此在 Z 基中不产生任何错误。然而，它会破坏 X [基态](@entry_id:150928)（$|+\rangle$ 和 $|-\rangle$）的叠加性质，导致在 X 基中产生错误。它导致的 QBER 为 $Q = \frac{1}{4}(1 - \sqrt{1-\lambda})$，其中 $\lambda$ 是[退相干](@entry_id:145157)参数。

一个更通用的模型是 **泡利信道（Pauli Channel）** [@problem_id:714995]，它以一定的概率 $p_x, p_y, p_z$ 对[量子比特](@entry_id:137928)施加 $X$（比特翻转）、$Y$（比特翻转加相位翻转）或 $Z$（相位翻转）操作。在这种信道中，Z 基中的错误率（比特错误率）为 $e_Z = p_x + p_y$，而 X 基中的错误率（相[位错](@entry_id:157482)误率）为 $e_X = p_y + p_z$。总的 QBER 是这两者的平均值，因为它通常通过在两个基中抽样来估计。这个模型清楚地区分了 **比特错误** 和 **相[位错](@entry_id:157482)误**，这一区别对于理解协议的安全性至关重要。

### 窃听与安全性

BB84 协议的安全性基石是 **测量行为会干扰量子系统** 这一原理，以及与之密切相关的 **[不可克隆定理](@entry_id:146200)（No-Cloning Theorem）**。该定理指出，不可能创造一个完美的、通用的设备，能够复制一个任意未知的[量子态](@entry_id:146142)。

任何试图窃听的第三方，我们称之为 Eve，为了获取关于密钥的信息，必须以某种方式与 Alice 发送的[量子比特](@entry_id:137928)进行交互。这种交互，无论是通过测量还是其他方式，都不可避免地有扰乱原始[量子态](@entry_id:146142)的风险。这种扰动会在 Alice 和 Bob 的筛选密钥中引入额外的错误，从而提高 QBER。如果 Alice 和 Bob 测得的 QBER 超过了由信道噪声和设备不完美所导致的预期内在 QBER，他们就可以断定存在窃听行为，并立即中止协议。

#### 截获重发攻击

最直接的窃听策略是 **截获重发攻击（Intercept-Resend Attack）**。Eve 截获 Alice 发送的每一个[量子比特](@entry_id:137928)，用她自己选择的基进行测量，然后根据她的测量结果制备一个新的[量子比特](@entry_id:137928)发送给 Bob。

- **对称攻击** [@problem_id:171243]：假设 Eve 像 Bob 一样，随机选择 Z 基或 X 基进行测量。考虑 Alice 发送一个 Z 基的比特，比如 $|0\rangle$。
    - 有 $1/2$ 的概率，Eve 猜对了基（Z 基）。她会以 $100\%$ 的概率测得 $|0\rangle$，然后发送一个完美的 $|0\rangle$ 给 Bob。如果 Bob 也用 Z 基测量，就不会产生错误。
    - 有 $1/2$ 的概率，Eve 猜错了基（X 基）。她对 $|0\rangle$ 的测量会以各 $1/2$ 的概率得到 $|+\rangle$ 或 $|-\rangle$。然后她将这个结果态发送给 Bob。当 Bob 用 Z 基测量 $|+\rangle$ 或 $|-\rangle$ 时，他会以 $1/2$ 的概率得到错误的结果“1”。
    综合来看，当 Alice 和 Bob 的基匹配时，Eve 的行为导致错误的总概率为 $P(\text{Eve 错基}) \times P(\text{Bob 测错 | Eve 错基}) = \frac{1}{2} \times \frac{1}{2} = \frac{1}{4}$。因此，这种攻击会引入 $25\%$ 的 QBER。

- **非对称攻击** [@problem_id:143398]：Eve 也可以采取固定的策略，例如总是使用 X 基进行测量。
    - 如果 Alice 发送 Z 基的态（例如 $|0\rangle$），Eve 的 X 基测量会随机化结果，导致 Bob 在 Z 基测量时有 $50\%$ 的错误率（$e_Z = 1/2$）。
    - 如果 Alice 恰好也发送 X 基的态（例如 $|+\rangle$），Eve 的 X 基测量会完美地得到结果 $|+\rangle$ 而不产生干扰。因此，在 X 基上不会引入错误（$e_X = 0$）。
    由于 Alice 随机选择基，平均下来，这种攻击引入的 QBER 仍然是 $\frac{1}{2}e_Z + \frac{1}{2}e_X = \frac{1}{2}(\frac{1}{2}) + \frac{1}{2}(0) = \frac{1}{4}$。

这些简单的攻击模型表明，无论 Eve 采用何种截获重发策略，只要她试图获取信息，就会在不匹配的基上引入显著的错误率，最终体现为 Alice 和 Bob 可观测的 $25\%$ 的 QBER。更一般地，如果各方基选择的概率不同，我们可以推导出一个依赖于这些概率的 QBER 表达式 [@problem_id:715044]。

#### 更高级的攻击

Eve 可以采用比截获重发更复杂的策略。
- **[量子克隆](@entry_id:138347)攻击** [@problem_id:159149]：由于完美的克隆被禁止，Eve 只能使用不完美的[量子克隆](@entry_id:138347)机。一个“通用对称 1 到 2 [量子克隆](@entry_id:138347)机”是理论上最好的选择。它将输入态 $|\psi\rangle$ 转换为一个包含两个不完美副本的联合状态。可以计算出，当 Eve 将其中一个副本发送给 Bob 时，Bob 接收到的[量子态](@entry_id:146142)的保真度（fidelity）为 $5/6$。这意味着 Bob 测量到正确结果的概率是 $5/6$，而测量到错误结果的概率是 $1 - 5/6 = 1/6$。因此，这种攻击引入的 QBER 是 $1/6 \approx 16.7\%$。

- **相干攻击（Coherent Attack）**：这是最强大的一类攻击。Eve 不直接测量传输中的[量子比特](@entry_id:137928)，而是让它与她自己的一个[辅助量子比特](@entry_id:144604)（称为 ancilla 或探针）发生[幺正演化](@entry_id:145020)（unitary evolution）。之后，她将可能已被扰动的原始[量子比特](@entry_id:137928)发送给 Bob，并保留自己的探针。在 Alice 和 Bob 完成所有经典通信后，Eve 对她收集到的所有探针进行一次全局性的、复杂的[联合测量](@entry_id:151032)，以期最大化地提取信息。

一个典型的相干攻击是 **CNOT 攻击** [@problem_id:714929, @problem_id:143275]。Eve 将 Alice 的[量子比特](@entry_id:137928)作为 CNOT 门的控制位，将她自己制备在 $|0\rangle_E$ 态的探针作为目标位。
- 当 Alice 发送 Z [基态](@entry_id:150928) $|c\rangle_A$ (其中 $c=0,1$) 时，联合态的演化是 $|c\rangle_A |0\rangle_E \rightarrow |c\rangle_A |c\rangle_E$。Alice 的[量子比特](@entry_id:137928)没有被改变，因此 Bob 在 Z 基中测量不会发现任何错误 ($e_Z = 0$)。然而，Eve 的探针现在与 Alice 的比特完全相关，Eve 通过测量自己的探针就能完美地知道 Alice 的比特。
- 当 Alice 发送 X [基态](@entry_id:150928) $|+\rangle_A$ 或 $|-\rangle_A$ 时，情况就大不相同了。例如，对于 $|+\rangle_A$，演化后的联合态是 $\frac{1}{\sqrt{2}}(|0\rangle_A|0\rangle_E + |1\rangle_A|1\rangle_E)$。这是一个[纠缠态](@entry_id:152310)。虽然 Alice 的[量子比特](@entry_id:137928)被改变了，但这种改变在 Z 基中是不可见的，却在 X 基中造成了错误。可以计算出，这种攻击在 X 基中引入的错误率（相[位错](@entry_id:157482)误率）非零。

CNOT 攻击揭示了一个深刻的道理：Eve 可以设计一种攻击，在一个基（Z 基）上不产生错误，从而隐藏自己，但代价是在共轭基（X 基）上不可避免地留下痕迹。这也解释了为什么 BB84 协议必须使用两个基：一个用于生成密钥，另一个用于检测窃听。通过分析 CNOT 攻击，我们还可以量化 Eve 获得的信息。当双方使用 Z 基时，Eve 获得 1 比特信息；当使用 X 基时，她获得 0 比特信息。平均在筛选密钥的每个比特上，Eve 的[信息增益](@entry_id:262008)为 $I(A:E) = 1/2$ 比特 [@problem_id:143275]。

### 从原始比特到安全密钥：经典后处理

通过[量子信道](@entry_id:145403)传输和筛选后，Alice 和 Bob 得到一个共享的、但可能含有错误且部分信息已被 Eve 窃取的筛选密钥。要将其转换为最终可用的、高度安全的密钥，还需经过几个关键的经典后处理步骤。

#### 1. [参数估计](@entry_id:139349)（Parameter Estimation）

Alice 和 Bob 随机选取一小部分筛选密钥，通过公共信道进行比对，以估计 QBER。这个估计值，我们称之为 $Q$，是决定后续步骤如何进行以及协议是否安全的关键。如果 $Q$ 高于某个预设的阈值（例如，高于理论上由信道噪声所能解释的最大值），他们就认为信道不安全，并放弃此次密钥分发。

#### 2. [信息协商](@entry_id:145509)（Information Reconciliation / Error Correction）

如果 QBER 在可接受的范围内，Alice 和 Bob 就必须纠正他们密钥中的不一致之处。这个过程称为[信息协商](@entry_id:145509)。一个经典的算法是 **Cascade 协议**。这些协议的核心思想是通过公共信道交换最少量的信息（通常是关于密钥块的[奇偶校验位](@entry_id:170898)），来定位并纠正错误。

然而，所有这些公开的通信都可能被 Eve 截获。因此，[纠错](@entry_id:273762)过程本身会向 Eve 泄露关于密钥的信息。对于一个理想的单向[纠错](@entry_id:273762)协议（例如，Alice 帮助 Bob 纠正他的密钥），所泄露的最小[信息量](@entry_id:272315)由[香农熵](@entry_id:144587)给出，即 $I_{leak} = h(Q)$，其中 $h(p) = -p\log_2 p - (1-p)\log_2(1-p)$ 是二元熵函数 [@problem_id:143399]。例如，在一个简化的场景中，如果已知一个长度为 $N$ 的数据块中只有一个错误，通过类似[二分查找](@entry_id:266342)的方式定位这个错误，需要公开 $\log_2 N$ 个[奇偶校验位](@entry_id:170898)，这也就泄露了 $\log_2 N$ 比特的信息 [@problem_id:143186]。

#### 3. [隐私放大](@entry_id:147169)（Privacy Amplification）

经过纠错后，Alice 和 Bob 拥有了完全相同的密钥串。然而，由于窃听和纠错过程的[信息泄露](@entry_id:155485)，Eve 对这个密钥串仍然掌握了部分信息。[隐私放大](@entry_id:147169)的目的就是消除 Eve 的这些信息。

其基本工具是 **哈希函数（Hash Functions）**。Alice 和 Bob 从一个被称为 **二元万有哈希函数族（two-universal family of hash functions）** 中随机选择一个哈希函数，并将其应用于他们共享的密钥串上，生成一个更短的、全新的密钥。

这个过程的理论基础是 **[剩余哈希引理](@entry_id:138857)（Leftover Hashing Lemma）**。该引理指出，如果 Eve 对原始密钥串 $X$ 的不确定性（用 **[最小熵](@entry_id:138837) (min-entropy)** $H_{min}(X|E)$ 来衡量）足够大，那么经过哈希压缩后，得到的短密钥将是均匀随机的，并且与 Eve 的所有信息几乎完全无关。

Eve 对密钥串 $X$ 的猜测概率 $p_{guess}(X|E)$ 与[最小熵](@entry_id:138837)的关系为 $H_{min}(X|E) = -\log_2(p_{guess}(X|E))$。最终的安全密钥长度 $\ell$ 可以被确定为：
$$ \ell \approx H_{min}(X|E) - s $$
其中 $s$ 是一个安全参数，用于将密钥与 Eve 信息的关联降低到可忽略不计的水平。例如，若 Eve 已知长度为 $N$ 的密钥中的 $\alpha N$ 个比特，则她猜对整个密钥的概率是 $2^{-(1-\alpha)N}$，因此 $H_{min}(X|E) = (1-\alpha)N$。最终密钥长度将约为 $(1-\alpha)N$ 减去安全参数 [@problem_id:143378]。

### 渐近[安全[密钥](@entry_id:145034)率](@entry_id:145034)

将所有部分综合起来，我们可以推导出在协议运行无穷多次的理想情况下（即渐近极限），每个筛选出的原始比特最终能产生多少安全密钥比特。这个比率被称为 **渐近[安全[密钥](@entry_id:145034)率](@entry_id:145034)（asymptotic secret key rate）**，记为 $R$。

一个著名的结果，即 Devetak-Winter 公式，给出了[密钥率](@entry_id:145034)的下界。对于 BB84 协议，一个简化的版本可以直观地理解为：
$$ R \ge \text{初始信息} - \text{纠错泄露} - \text{对 Eve 的泄露} $$

1.  **初始信息**：每个筛选比特携带 1 比特的信息。
2.  **纠错泄露**：如前所述，理想情况下为 $h(e_Z)$，其中 $e_Z$ 是在密钥生成基（Z 基）中观测到的比特错误率（即 QBER）。在实际中，由于[纠错](@entry_id:273762)协议的效率 $f_{EC} \ge 1$，这部分成本为 $f_{EC}h(e_Z)$。
3.  **对 Eve 的泄露**：这部分比较复杂，它等于 Eve 通过攻击所能获得的[信息量](@entry_id:272315)，也就是[隐私放大](@entry_id:147169)需要消除的[信息量](@entry_id:272315)。一个深刻的结论是，Eve 对 Z 基密钥的[信息量](@entry_id:272315)，可以由在共轭基（X 基）中观测到的 **相[位错](@entry_id:157482)误率** $e_X$ 来界定。

**[熵不确定性关系](@entry_id:142360)（Entropic Uncertainty Relation）** 是连接这两个错误率并量化 Eve 知识的数学工具。一个关键的不等式是 $S(A_Z|E) + S(A_X|B) \ge 1$ [@problem_id:143203]。这里，$S(A_Z|E)$ 是给定 Eve 的信息后，Alice 的 Z 基结果的[条件熵](@entry_id:136761)，它代表了 Eve 对密钥的不确定性。$S(A_X|B)$ 是给定 Bob 的系统后，Alice 的 X 基结果的[条件熵](@entry_id:136761)，它与相[位错](@entry_id:157482)误率 $e_X$ 直接相关：$S(A_X|B) = h(e_X)$。

这个不等式可以重写为 $S(A_Z|E) \ge 1 - h(e_X)$。这意味着，Eve 对 Z 基密钥的不确定性（我们希望它大）的下界，是由相[位错](@entry_id:157482)误率 $e_X$（我们希望它小）决定的。Eve 能获得的关于 Z 基密钥的信息量 $I(A_Z:E)$ 最多是 $1 - S(A_Z|E) \le h(e_X)$。因此，[隐私放大](@entry_id:147169)需要消除的[信息量](@entry_id:272315)由 $h(e_X)$ 作为上界。

综合起来，[安全密钥率](@entry_id:145034)的下界为：
$$ R \ge 1 - f_{EC}h(e_Z) - h(e_X) $$
这个公式（或其变体）是 BB84 安全性分析的核心 [@problem_id:714858, @problem_id:171331]。它优美地将两个可观测的量——比特错误率 $e_Z$ 和相[位错](@entry_id:157482)误率 $e_X$——与最终的安全密钥产出联系起来。在许多对称的攻击和[噪声模型](@entry_id:752540)中，可以证明 $e_Z = e_X = Q$ [@problem_id:143253, @problem_id:714869]，此时公式简化为 $R \ge 1 - (1+f_{EC})h(Q)$。这个结果清晰地表明，只要测得的 QBER 足够低，即使在存在窃听者的情况下，依然可以生成正长度的安全密钥。当 QBER 超过某个阈值时，[密钥率](@entry_id:145034)变为零或负数，意味着无法再提取出安全的密钥。

更严格的分析可以使用 **[相干信息](@entry_id:147583)（Coherent Information）** $I(A\rangle B) = S(\rho_B) - S(\rho_{AB})$ [@problem_id:122812]，它是在纠缠辅助的框架下对[量子信道容量](@entry_id:137713)的度量，为这些安全证明提供了更为普适和强大的数学基础。