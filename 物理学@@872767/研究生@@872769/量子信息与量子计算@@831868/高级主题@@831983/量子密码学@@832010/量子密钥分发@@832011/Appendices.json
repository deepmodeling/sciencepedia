{"hands_on_practices": [{"introduction": "量子密钥分发的基础在于海森堡不确定性原理的一个巧妙应用：对非正交量子态的测量会不可避免地干扰它们。本练习 [@problem_id:1651421] 将通过一个基本场景，带你亲手计算当发送方（Alice）和接收方（Bob）使用不匹配的测量基时，可能出现的各种测量结果的概率。理解这些概率分布是掌握BB84协议中密钥筛选过程和窃听检测原理的第一步。", "problem": "在一个基于 Bennett-Brassard 1984 (BB84) 协议的量子密钥分发 (QKD) 系统的初步测试中，发送方 (Alice) 重复地向接收方 (Bob) 发送量子比特。该系统使用两种不同的量子基进行编码和测量：\n1. Z基（矩形基），由两个正交态 $|0\\rangle$ 和 $|1\\rangle$ 组成。\n2. X基（对角基），由两个正交态 $|+\\rangle$ 和 $|-\\rangle$ 组成。\n\nX基的态由Z基的态定义如下：\n$|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$\n$|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$\n\n在这次特定的测试运行中，Alice 将每个量子比特都制备在态 $|\\psi\\rangle = |0\\rangle$ 上。Bob 不知道 Alice 选择的基，他对自己的接收器进行编程，为每个传入的量子比特随机选择一个测量基。他选择以 $p_Z = \\frac{1}{2}$ 的概率在 Z 基中测量，并以 $p_X = \\frac{1}{2}$ 的概率在 X 基中测量。\n\n计算 Bob 对 Alice 发送的任何单个量子比特进行测量时，得到以下四种结果的总概率：\n1. 获得与态 $|0\\rangle$ 对应的结果的概率。\n2. 获得与态 $|1\\rangle$ 对应的结果的概率。\n3. 获得与态 $|+\\rangle$ 对应的结果的概率。\n4. 获得与态 $|-\\rangle$ 对应的结果的概率。\n\n将你的最终答案表示为一个包含这四个概率的行矩阵，使用分数表示，并按上述顺序列出。", "solution": "题目要求计算在 Alice 总是发送态 $|\\psi\\rangle = |0\\rangle$ 且 Bob 随机选择其测量基的情况下，Bob 端可能出现的四种测量结果的总概率。我们可以使用全概率公式来计算每个概率。对于任何结果 `R`，总概率由以下公式给出：\n$P(R) = P(R | \\text{Bob chooses Z-basis}) \\cdot P(\\text{Bob chooses Z-basis}) + P(R | \\text{Bob chooses X-basis}) \\cdot P(\\text{Bob chooses X-basis})$\n\n给定 Bob 选择 Z 基的概率为 $p_Z = \\frac{1}{2}$，选择 X 基的概率为 $p_X = \\frac{1}{2}$。\n\n让我们分别分析每种基选择下的测量结果。\n\n**情况1：Bob 选择 Z 基进行测量。**\n测量算符对应于到基矢 $|0\\rangle$ 和 $|1\\rangle$ 上的投影算符。Alice 发送的态是 $|\\psi\\rangle = |0\\rangle$。\nBob 测量到结果 `0` 的概率由玻恩定则给出：\n$P(0 | \\text{Z-basis}) = |\\langle 0 | \\psi \\rangle|^2 = |\\langle 0 | 0 \\rangle|^2 = 1^2 = 1$.\nBob 测量到结果 `1` 的概率是：\n$P(1 | \\text{Z-basis}) = |\\langle 1 | \\psi \\rangle|^2 = |\\langle 1 | 0 \\rangle|^2 = 0^2 = 0$.\n在 Z 基中测量时，不可能获得对应于 X 基中某个态的结果。因此：\n$P(+ | \\text{Z-basis}) = 0$\n$P(- | \\text{Z-basis}) = 0$\n\n**情况2：Bob 选择 X 基进行测量。**\n测量算符对应于到基矢 $|+\\rangle$ 和 $|-\\rangle$ 上的投影算符。Alice 仍然发送态 $|\\psi\\rangle = |0\\rangle$。\n为了计算概率，我们首先需要将态 $|\\psi\\rangle = |0\\rangle$ 在 X 基下展开。我们可以通过反解 $|+\\rangle$ 和 $|-\\rangle$ 的定义来做到这一点：\n$|+\\rangle + |-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) + \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle) = \\frac{2}{\\sqrt{2}}|0\\rangle = \\sqrt{2}|0\\rangle$\n因此， $|0\\rangle = \\frac{1}{\\sqrt{2}}(|+\\rangle + |-\\rangle)$。\n\n现在，我们可以计算在 X 基中测量的概率。\nBob 测量到结果 `+` 的概率是：\n$P(+ | \\text{X-basis}) = |\\langle + | \\psi \\rangle|^2 = |\\langle + | 0 \\rangle|^2 = \\left| \\langle + | \\left( \\frac{1}{\\sqrt{2}}(|+\\rangle + |-\\rangle) \\right) \\right|^2 = \\left| \\frac{1}{\\sqrt{2}} (\\langle + | + \\rangle + \\langle + | - \\rangle) \\right|^2 = \\left| \\frac{1}{\\sqrt{2}} (1 + 0) \\right|^2 = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 = \\frac{1}{2}$。\nBob 测量到结果 `-` 的概率是：\n$P(- | \\text{X-basis}) = |\\langle - | \\psi \\rangle|^2 = |\\langle - | 0 \\rangle|^2 = \\left| \\langle - | \\left( \\frac{1}{\\sqrt{2}}(|+\\rangle + |-\\rangle) \\right) \\right|^2 = \\left| \\frac{1}{\\sqrt{2}} (\\langle - | + \\rangle + \\langle - | - \\rangle) \\right|^2 = \\left| \\frac{1}{\\sqrt{2}} (0 + 1) \\right|^2 = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 = \\frac{1}{2}$。\n在 X 基中测量时，不可能获得对应于 Z 基中某个态的结果。因此：\n$P(0 | \\text{X-basis}) = 0$\n$P(1 | \\text{X-basis}) = 0$\n\n**步骤3：计算总概率。**\n现在我们使用全概率公式，并代入 $p_Z = p_X = \\frac{1}{2}$ 来合并结果。\n\n1.  **测量到 `0` 的总概率：**\n    $P(0) = P(0 | \\text{Z-basis}) \\cdot p_Z + P(0 | \\text{X-basis}) \\cdot p_X = (1) \\cdot \\frac{1}{2} + (0) \\cdot \\frac{1}{2} = \\frac{1}{2}$。\n\n2.  **测量到 `1` 的总概率：**\n    $P(1) = P(1 | \\text{Z-basis}) \\cdot p_Z + P(1 | \\text{X-basis}) \\cdot p_X = (0) \\cdot \\frac{1}{2} + (0) \\cdot \\frac{1}{2} = 0$。\n\n3.  **测量到 `+` 的总概率：**\n    $P(+) = P(+ | \\text{Z-basis}) \\cdot p_Z + P(+ | \\text{X-basis}) \\cdot p_X = (0) \\cdot \\frac{1}{2} + \\left(\\frac{1}{2}\\right) \\cdot \\frac{1}{2} = \\frac{1}{4}$。\n\n4.  **测量到 `-` 的总概率：**\n    $P(-) = P(- | \\text{Z-basis}) \\cdot p_Z + P(- | \\text{X-basis}) \\cdot p_X = (0) \\cdot \\frac{1}{2} + \\left(\\frac{1}{2}\\right) \\cdot \\frac{1}{2} = \\frac{1}{4}$。\n\n按要求的顺序（结果 `0`, `1`, `+`, `-`），这四个概率分别是 $\\frac{1}{2}$、$0$、$\\frac{1}{4}$ 和 $\\frac{1}{4}$。\n作为检验，所有可能结果的概率之和为 $\\frac{1}{2} + 0 + \\frac{1}{4} + \\frac{1}{4} = 1$，符合预期。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} & 0 & \\frac{1}{4} & \\frac{1}{4} \\end{pmatrix}}$$", "id": "1651421"}, {"introduction": "在理想的BB84协议中，我们假设Alice和Bob的测量基是完美对齐的。然而，在实际系统中，设备的不完美总会导致偏差，例如偏振参考系的微小旋转。本练习 [@problem_id:122687] 探讨了这种恒定的基准失配角度 $\\theta$ 如何引入一个固有的量子比特错误率（QBER）。通过这个计算，你将理解物理实现中的不完美性是如何直接转化为可量化的协议性能指标的。", "problem": "在BB84量子密钥分发协议中，Alice在两组基中的一组上制备量子比特：直线（$Z$）基或对角（$X$）基。她为每个要发送的量子比特随机选择一组基和一个比特值（0或1）。\n与比特值0和1相对应的状态如下：\n- 在 $Z$ 基中：$|0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $|1\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n- 在 $X$ 基中：$|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$ 和 $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$。\n\n接收方 Bob 也随机选择在 $Z$ 基或 $X$ 基中测量每个传入的量子比特。传输结束后，Alice 和 Bob 公开宣布他们所使用的基序列。他们丢弃所有基选择不匹配的测量结果。剩余的比特构成了筛选密钥。量子比特误码率（QBER）是此筛选密钥中 Alice 和 Bob 之间不一致的比特所占的比例。\n\n考虑一个场景，其中 Bob 的测量设备与 Alice 的设备未完美对准。他们的偏振参考系之间存在一个恒定的角度偏差 $\\theta$。这意味着 Bob 的测量基 $\\{|0'\\rangle, |1'\\rangle\\}$ 和 $\\{|+'\\rangle, |-'\\rangle\\}$ 相对于 Alice 的基旋转了角度 $\\theta$。旋转算符由 $R(\\theta) = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix}$ 给出。因此，Bob 的基向量与 Alice 的基向量之间的关系为 $|v'\\rangle = R(\\theta) |v\\rangle$。\n\n假设 Alice 和 Bob 以相等的概率选择他们的基，计算筛选密钥的内在 QBER 作为失准角 $\\theta$ 的函数。", "solution": "为了计算筛选密钥的内在量子比特误码率（QBER）作为失准角 $\\theta$ 的函数，我们考虑 Alice 和 Bob 的基匹配的情况。当双方都选择直线（$Z$）基或都选择对角（$X$）基时，就形成了筛选密钥。QBER是筛选密钥中 Alice 和 Bob 之间不一致的比特所占的比例。\n\n旋转算符为 $R(\\theta) = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix}$。Bob 的基向量与 Alice 的基向量之间的关系为 $|v'\\rangle = R(\\theta) |v\\rangle$。因此：\n- Bob 的 $Z$ 基：$|0'\\rangle = R(\\theta) |0\\rangle = \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}$， $|1'\\rangle = R(\\theta) |1\\rangle = \\begin{pmatrix} -\\sin\\theta \\\\ \\cos\\theta \\end{pmatrix}$。\n- Bob 的 $X$ 基：$|+'\\rangle = R(\\theta) |+\\rangle$， $|-'\\rangle = R(\\theta) |-\\rangle$。\n\n由于对称性，两组基的 QBER 是相同的。我们计算 $Z$ 基的错误概率，并将其推广到 $X$ 基。\n\n**情况1：双方都使用 $Z$ 基。**\n- Alice 以 $\\frac{1}{2}$ 的概率发送 $|0\\rangle$（比特0）。Bob 在 $\\{|0'\\rangle, |1'\\rangle\\}$ 基中进行测量：\n  - Bob 测得 $|0'\\rangle$（比特0）的概率：$|\\langle 0' | 0 \\rangle|^2 = |\\cos\\theta|^2 = \\cos^2\\theta$。\n  - Bob 测得 $|1'\\rangle$（比特1，发生错误）的概率：$|\\langle 1' | 0 \\rangle|^2 = |-\\sin\\theta|^2 = \\sin^2\\theta$。\n- Alice 以 $\\frac{1}{2}$ 的概率发送 $|1\\rangle$（比特1）：\n  - Bob 测得 $|0'\\rangle$（比特0，发生错误）的概率：$|\\langle 0' | 1 \\rangle|^2 = |\\sin\\theta|^2 = \\sin^2\\theta$。\n  - Bob 测得 $|1'\\rangle$（比特1）的概率：$|\\langle 1' | 1 \\rangle|^2 = |\\cos\\theta|^2 = \\cos^2\\theta$。\n- $Z$ 基的错误概率为：$\\frac{1}{2} \\sin^2\\theta + \\frac{1}{2} \\sin^2\\theta = \\sin^2\\theta$。\n\n**情况2：双方都使用 $X$ 基。**\n- Alice 以 $\\frac{1}{2}$ 的概率发送 $|+\\rangle$（比特0）。Bob 在 $\\{|+'\\rangle, |-'\\rangle\\}$ 基中进行测量：\n  - $\\langle +' | + \\rangle = \\left[ R(\\theta) |+\\rangle \\right]^\\dagger |+\\rangle = \\langle +| R^\\dagger(\\theta) |+ \\rangle$。由于 $R(\\theta)$ 是实正交矩阵，因此 $R^\\dagger(\\theta) = R(-\\theta)$。\n  - 或者，直接计算：\n    - $|+'\\rangle = R(\\theta) |+\\rangle = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\cos\\theta - \\sin\\theta \\\\ \\sin\\theta + \\cos\\theta \\end{pmatrix}$。\n    - $\\langle +' | + \\rangle = \\frac{1}{\\sqrt{2}} (\\cos\\theta - \\sin\\theta) \\cdot \\frac{1}{\\sqrt{2}} + \\frac{1}{\\sqrt{2}} (\\sin\\theta + \\cos\\theta) \\cdot \\frac{1}{\\sqrt{2}} = \\frac{1}{2} (\\cos\\theta - \\sin\\theta + \\sin\\theta + \\cos\\theta) = \\cos\\theta$。\n    - Bob 测得 $|+'\\rangle$（比特0）的概率：$|\\langle +' | + \\rangle|^2 = \\cos^2\\theta$。\n    - Bob 测得 $|-'\\rangle$（比特1，发生错误）的概率：$|\\langle -' | + \\rangle|^2 = 1 - |\\langle +' | + \\rangle|^2 = 1 - \\cos^2\\theta = \\sin^2\\theta$（因为这些状态是标准正交的）。\n- Alice 以 $\\frac{1}{2}$ 的概率发送 $|-\\rangle$（比特1）：\n  - $\\langle +' | - \\rangle = \\left[ R(\\theta) |+\\rangle \\right]^\\dagger |-\\rangle = \\langle +| R^\\dagger(\\theta) | - \\rangle$。\n  - 直接计算：\n    - $\\langle +' | - \\rangle = \\frac{1}{\\sqrt{2}} (\\cos\\theta - \\sin\\theta) \\cdot \\frac{1}{\\sqrt{2}} + \\frac{1}{\\sqrt{2}} (\\sin\\theta + \\cos\\theta) \\cdot \\left(-\\frac{1}{\\sqrt{2}}\\right) = \\frac{1}{2} (\\cos\\theta - \\sin\\theta - \\sin\\theta - \\cos\\theta) = -\\sin\\theta$。\n    - Bob 测得 $|+'\\rangle$（比特0，发生错误）的概率：$|\\langle +' | - \\rangle|^2 = |-\\sin\\theta|^2 = \\sin^2\\theta$。\n    - Bob 测得 $|-'\\rangle$（比特1）的概率：$|\\langle -' | - \\rangle|^2 = 1 - \\sin^2\\theta = \\cos^2\\theta$。\n- $X$ 基的错误概率为：$\\frac{1}{2} \\sin^2\\theta + \\frac{1}{2} \\sin^2\\theta = \\sin^2\\theta$。\n\n筛选密钥由 $Z$ 基和 $X$ 基的贡献均等构成，因为双方都选择 $Z$ 的概率是 $\\frac{1}{4}$，双方都选择 $X$ 的概率也是 $\\frac{1}{4}$，所以在期望上，筛选密钥一半来自 $Z$ 基，一半来自 $X$ 基。这两个部分的错误率都是 $\\sin^2\\theta$。因此，总的 QBER 是：\n\n$$\n\\text{QBER} = \\sin^2\\theta.\n$$", "answer": "$$\\boxed{\\sin^{2}{\\theta}}$$", "id": "122687"}, {"introduction": "BB84协议的安全性并非源于阻止窃听，而是源于使其能够被检测。最直接的窃听策略之一是“拦截-重发”攻击，即窃听者（Eve）拦截每个量子比特，自行测量后再发送一个新的给Bob。本练习 [@problem_id:1651422] 将引导你计算这种攻击策略必然会在筛选后的密钥中引入的量子比特错误率。这个计算是QKD安全理论的基石，它明确展示了任何主动窃听行为都会在Alice和Bob的通信中留下不可磨灭的痕迹。", "problem": "两位物理学家Alice和Bob正在测试他们新的量子密钥分发（QKD）系统，该系统基于BB84协议运行。在此协议中，Alice向Bob发送量子比特（qubit），用以编码经典比特信息。\n\n编码方案如下：\n- 为了发送经典比特“0”，Alice可以制备一个处于状态 $|0\\rangle$（来自矩形基）的量子比特，或者处于状态 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$（来自对角基）的量子比特。\n- 为了发送经典比特“1”，Alice可以制备一个处于状态 $|1\\rangle$（来自矩形基）的量子比特，或者处于状态 $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$（来自对角基）的量子比特。\n\n对于她发送的每一个量子比特，Alice都会做出两个独立的随机选择：她选择要发送的经典比特（0或1，各有50%的概率），并选择要使用的基（矩形基或对角基，各有50%的概率）。\n\n一个窃听者Eve对从Alice传输到Bob的每一个量子比特都实施了截获重发攻击。对于她截获的每个量子比特，由于不知道Alice选择的基，Eve会随机选择一个基（矩形基或对角基，各有50%的概率）进行测量。然后，她将一个新的量子比特发送给Bob，该量子比特被制备成与她的测量结果相对应的状态，并采用她用于测量的基。\n\nBob从Eve那里接收到量子比特，并且在不知道Alice或Eve选择的基的情况下，也随机选择一个基（矩形基或对角基，各有50%的概率）进行测量。\n\n在整个量子比特序列传输和测量完毕后，Alice和Bob通过一个公共信道进行通信，以比较他们用于每个比特的基。他们丢弃所有基选择不匹配的比特。剩下的比特构成了筛选密钥。\n\n计算预期的量子比特误码率（QBER），其定义为Bob的筛选密钥中的一个比特与Alice最初发送的相应比特不匹配的概率。请将您的答案表示为小数。", "solution": "设 $X \\in \\{0,1\\}$ 表示Alice的比特，$A \\in \\{\\mathcal{R},\\mathcal{D}\\}$ 表示Alice的基（矩形基或对角基），$E \\in \\{\\mathcal{R},\\mathcal{D}\\}$ 表示Eve的基，$B \\in \\{\\mathcal{R},\\mathcal{D}\\}$ 表示Bob的基。设 $Y \\in \\{0,1\\}$ 表示Bob在其所选基中测量的结果并解读成的比特。筛选集对应于事件 $S=\\{A=B\\}$。量子比特误码率（QBER）是条件概率\n$$\n\\mathrm{QBER}=P(Y \\neq X \\mid S).\n$$\n根据关于Eve的基是否与Alice的基匹配的全概率公式，\n$$\nP(Y \\neq X \\mid S)=P(E=A \\mid S)\\,P(Y \\neq X \\mid S,E=A)+P(E \\neq A \\mid S)\\,P(Y \\neq X \\mid S,E \\neq A).\n$$\n因为 $E$ 的选择独立于 $A$ 和 $B$，所以以 $S$ 为条件不会改变 $E$ 相对于 $A$ 的分布：\n$$\nP(E=A \\mid S)=\\frac{P(E=A, S)}{P(S)}=\\frac{P(E=A)\\,P(S)}{P(S)}=P(E=A)=\\frac{1}{2},\n$$\n因此 $P(E \\neq A \\mid S)=\\frac{1}{2}$。\n\n评估这两个条件错误概率：\n1) 如果 $E=A$ 且 $S$ 成立（因此 $B=A$），Eve在Alice的基中进行测量，并以该基重新发送相应的本征态。然后Bob在相同的基 $A$ 中进行测量，通过对本征态进行投影测量，可以确定地获得相同的比特。因此\n$$\nP(Y \\neq X \\mid S,E=A)=0.\n$$\n2) 如果 $E \\neq A$ 且 $S$ 成立（因此 $B=A \\neq E$），Eve在共轭基中进行测量。例如，如果Alice发送了 $|0\\rangle$（基 $\\mathcal{R}$），而Eve在 $\\mathcal{D}$ 基中测量，Eve的结果将以各 $\\frac{1}{2}$ 的概率为 $|+\\rangle$ 或 $|-\\rangle$，然后她重新发送该状态。Bob在 $\\mathcal{R}$ 基中测量；根据玻恩定则可得\n$$\n|\\langle 0|+\\rangle|^{2}=|\\langle 1|+\\rangle|^{2}=|\\langle 0|-\\rangle|^{2}=|\\langle 1|-\\rangle|^{2}=\\left|\\frac{1}{\\sqrt{2}}\\right|^{2}=\\frac{1}{2},\n$$\n所以Bob的测量结果相对于Alice的原始比特是均匀随机的。因此\n$$\nP(Y \\neq X \\mid S,E \\neq A)=\\frac{1}{2}.\n$$\n\n综合这些，\n$$\n\\mathrm{QBER}=\\left(\\frac{1}{2}\\right)\\cdot 0+\\left(\\frac{1}{2}\\right)\\cdot \\left(\\frac{1}{2}\\right)=\\frac{1}{4}=0.25.\n$$", "answer": "$$\\boxed{0.25}$$", "id": "1651422"}]}