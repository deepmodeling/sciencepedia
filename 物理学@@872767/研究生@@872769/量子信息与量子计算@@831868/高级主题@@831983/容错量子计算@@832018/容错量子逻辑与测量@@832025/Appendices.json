{"hands_on_practices": [{"introduction": "在容错量子计算中，实现高保真度的逻辑门至关重要，而横向门（transversal gate）是最简洁的实现方式。本练习探讨了在Steane编码的$|+\\rangle_L$态上，一个横向$S$门与理想逻辑$S$门之间的区别。通过这个例子，我们将揭示横向操作的一个基本限制，并理解为何需要如魔术态蒸馏等更复杂的容错技术 [@problem_id:84602]。", "problem": "Steane 码是一种 `[[7,1,3]]` 量子纠错码，它将一个逻辑量子比特编码到七个物理量子比特中。它是一种 CSS 码，由经典的 `[7,4,3]` 汉明码（表示为 $C_H$）构建而成。$C_H$ 的 16 个码字被划分为两个集合：$C_e$（包含 8 个偶重码字的集合）和 $C_o$（包含 8 个奇重码字的集合）。\n\n逻辑基态被定义为这些集合上的均匀叠加：\n$$\n|0\\rangle_L = \\frac{1}{\\sqrt{|C_e|}} \\sum_{c \\in C_e} |c\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{c \\in C_e} |c\\rangle\n$$\n$$\n|1\\rangle_L = \\frac{1}{\\sqrt{|C_o|}} \\sum_{c \\in C_o} |c\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{c \\in C_o} |c\\rangle\n$$\n其中 $|c\\rangle = |c_1 c_2 \\dots c_7\\rangle$ 是计算基态。一个特别有用的逻辑态是 $|+\\rangle_L = \\frac{1}{\\sqrt{2}}(|0\\rangle_L + |1\\rangle_L)$，可以证明它是汉明码 $C_H = C_e \\cup C_o$ 的所有 16 个码字的均匀叠加：\n$$\n|+\\rangle_L = \\frac{1}{\\sqrt{|C_H|}} \\sum_{c \\in C_H} |c\\rangle = \\frac{1}{4} \\sum_{c \\in C_H} |c\\rangle\n$$\n\n理想的逻辑 S 门（表示为 $S_L$）由其对逻辑基态的作用定义：$S_L|0\\rangle_L = |0\\rangle_L$ 和 $S_L|1\\rangle_L = i|1\\rangle_L$。相比之下，横向 S 门是通过将单量子比特 S 门 $S = \\begin{pmatrix} 1   0 \\\\ 0  i \\end{pmatrix}$ 应用于七个物理量子比特中的每一个来实现的，即 $S^{\\otimes 7}$。横向门对计算基态 $|c\\rangle$ 的作用是 $S^{\\otimes 7}|c\\rangle = i^{w(c)} |c\\rangle$，其中 $w(c)$ 是比特串 $c$ 的汉明重量。\n\n经典 `[7,4,3]` 汉明码 $C_H$ 的重量分布由 $\\{A_w\\}$ 给出，其中 $A_w$ 是汉明重量为 $w$ 的码字数量。非零值为 $A_0=1$，$A_3=7$，$A_4=7$ 和 $A_7=1$。\n\n您的任务是计算从 $|+\\rangle_L$ 开始，经过理想 S 门作用后的状态与经过横向 S 门操作得到的实际状态之间的保真度。保真度 $F$ 定义为 $F = |\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle|^2$，其中 $|\\psi_{\\text{ideal}}\\rangle = S_L |+\\rangle_L$ 且 $|\\psi_{\\text{actual}}\\rangle = S^{\\otimes 7} |+\\rangle_L$。", "solution": "保真度定义为 $ F = |\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle|^2 $，其中：\n- $ |\\psi_{\\text{ideal}}\\rangle = S_L |+\\rangle_L $\n- $ |\\psi_{\\text{actual}}\\rangle = S^{\\otimes 7} |+\\rangle_L $\n\n首先，使用给定的汉明码 $ C_H $ 上的均匀叠加来表示 $ |+\\rangle_L $：\n\n$$\n|+\\rangle_L = \\frac{1}{4} \\sum_{c \\in C_H} |c\\rangle\n$$\n\n因为 $ |C_H| = 16 $，归一化因子为 $ \\frac{1}{\\sqrt{16}} = \\frac{1}{4} $。\n\n理想逻辑 S 门的作用如下：\n\n$$\nS_L |0\\rangle_L = |0\\rangle_L, \\quad S_L |1\\rangle_L = i |1\\rangle_L\n$$\n\n给定 $ |+\\rangle_L = \\frac{1}{\\sqrt{2}} (|0\\rangle_L + |1\\rangle_L) $，应用 $ S_L $：\n\n$$\nS_L |+\\rangle_L = \\frac{1}{\\sqrt{2}} (S_L |0\\rangle_L + S_L |1\\rangle_L) = \\frac{1}{\\sqrt{2}} (|0\\rangle_L + i |1\\rangle_L)\n$$\n\n用码字集 $ C_e $（偶重）和 $ C_o $（奇重）表示 $ |0\\rangle_L $ 和 $ |1\\rangle_L $：\n\n$$\n|0\\rangle_L = \\frac{1}{\\sqrt{8}} \\sum_{c \\in C_e} |c\\rangle, \\quad |1\\rangle_L = \\frac{1}{\\sqrt{8}} \\sum_{c \\in C_o} |c\\rangle\n$$\n\n代入：\n\n$$\n|\\psi_{\\text{ideal}}\\rangle = \\frac{1}{\\sqrt{2}} \\left( \\frac{1}{\\sqrt{8}} \\sum_{c \\in C_e} |c\\rangle + i \\frac{1}{\\sqrt{8}} \\sum_{c \\in C_o} |c\\rangle \\right) = \\frac{1}{4} \\left( \\sum_{c \\in C_e} |c\\rangle + i \\sum_{c \\in C_o} |c\\rangle \\right)\n$$\n\n因为 $ \\frac{1}{\\sqrt{2}} \\cdot \\frac{1}{\\sqrt{8}} = \\frac{1}{\\sqrt{16}} = \\frac{1}{4} $。\n\n横向 S 门对计算基态的作用是 $ S^{\\otimes 7} |c\\rangle = i^{w(c)} |c\\rangle $，所以：\n\n$$\n|\\psi_{\\text{actual}}\\rangle = S^{\\otimes 7} |+\\rangle_L = \\frac{1}{4} \\sum_{c \\in C_H} i^{w(c)} |c\\rangle\n$$\n\n\n内积为：\n\n$$\n\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle = \\left[ \\frac{1}{4} \\left( \\sum_{c' \\in C_e} \\langle c'| - i \\sum_{c' \\in C_o} \\langle c'| \\right) \\right] \\left[ \\frac{1}{4} \\sum_{c \\in C_H} i^{w(c)} |c\\rangle \\right]\n$$\n\n因为取伴随会将 $ i $ 变为 $ -i $。这可以简化为：\n\n$$\n\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle = \\frac{1}{16} \\left[ \\sum_{c' \\in C_e} \\langle c'| - i \\sum_{c' \\in C_o} \\langle c'| \\right] \\left[ \\sum_{c \\in C_H} i^{w(c)} |c\\rangle \\right]\n$$\n\n由于正交性，$ \\langle c' | c \\rangle = \\delta_{c',c} $，并且集合 $ C_e $ 和 $ C_o $ 是 $ C_H $ 的不相交子集。将对 $ c \\in C_H $ 的求和拆分为对 $ c \\in C_e $ 和 $ c \\in C_o $ 的求和：\n\n$$\n\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle = \\frac{1}{16} \\left[ \\sum_{c \\in C_e} i^{w(c)} - i \\sum_{c \\in C_o} i^{w(c)} \\right]\n$$\n\n\n使用汉明码 $ C_H $ 的重量分布：\n- 重量 0: $ A_0 = 1 $ (在 $ C_e $ 中)\n- 重量 3: $ A_3 = 7 $ (在 $ C_o $ 中)\n- 重量 4: $ A_4 = 7 $ (在 $ C_e $ 中)\n- 重量 7: $ A_7 = 1 $ (在 $ C_o $ 中)\n\n计算求和：\n\n$$\n\\sum_{c \\in C_e} i^{w(c)} = (i^0) \\cdot A_0 + (i^4) \\cdot A_4 = (1) \\cdot 1 + (1) \\cdot 7 = 8\n$$\n\n\n$$\n\\sum_{c \\in C_o} i^{w(c)} = (i^3) \\cdot A_3 + (i^7) \\cdot A_7 = (-i) \\cdot 7 + (-i) \\cdot 1 = -8i\n$$\n\n代入：\n\n$$\n\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle = \\frac{1}{16} \\left[ 8 - i \\cdot (-8i) \\right]\n$$\n\n简化 $ -i \\cdot (-8i) = 8i^2 = 8(-1) = -8 $：\n\n$$\n\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle = \\frac{1}{16} [8 + (-8)] = \\frac{0}{16} = 0\n$$\n\n因此，保真度为：\n\n$$\nF = |\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle|^2 = |0|^2 = 0\n$$", "answer": "$$ \\boxed{0} $$", "id": "84602"}, {"introduction": "理解了横向实现的局限性后，我们来探究物理错误如何转化为逻辑错误。本练习设计了一个思想实验，其中一个物理$Y$错误在一个经过特殊“形变”的表面码上被“分裂”成一个物理-逻辑关联错误。我们将分析一个“完美”的纠错步骤如何反而导致一个纯粹的逻辑$Z$错误，从而清晰地展示解码器对错误模型的假设是逻辑失败的关键根源 [@problem_id:84600]。", "problem": "一种特殊的、经过Clifford形变的表面码被设计用于防护Z错误占主导地位的高度偏向性噪声模型。这种形变虽然对频繁发生的Z错误有利，但可能对非偏好类型的错误产生复杂的影响。\n\n考虑一个使用此种编码方式的逻辑量子比特。逻辑基态表示为 $|0\\rangle_L$ 和 $|1\\rangle_L$，它们分别是逻辑泡利Z算符 $\\bar{Z}$ 的本征态，对应的本征值分别为 $+1$ 和 $-1$。初始逻辑态被制备在一个叠加态：\n$$|\\psi_{init}\\rangle_L = \\cos\\left(\\frac{\\theta}{2}\\right)|0\\rangle_L + \\sin\\left(\\frac{\\theta}{2}\\right)|1\\rangle_L$$\n其中 $\\theta$ 是一个固定参数。\n\n在某个数据量子比特上发生了一个非偏好的物理Y错误，由算符 $Y_q$ 表示。由于形变的性质以及同时作用的逻辑门，这个物理错误被“分裂”成一个相关的物理-逻辑复合错误算符。作用在编码空间上的等效错误由下式给出：\n$$E = Y_q \\bar{Z}$$\n这里，$Y_q$ 作用于物理数据量子比特 $q$，而 $\\bar{Z}$ 是编码量子比特的逻辑Z算符。\n\n发生此错误后，会进行一轮纠错。解码器被设计用于识别和纠正由物理错误产生的局域综合症。错误算符 $E$ 产生的综合症与单独的 $Y_q$ 错误产生的综合症完全相同，因为逻辑算符 $\\bar{Z}$ 对稳定子是不可见的。解码器正确地识别出 $Y_q$ 错误的综合症，并施加相应的完美纠正算符 $C = Y_q$。请注意，泡利算符是自身的逆（相差一个相位因子），但为简单起见，我们在此将纠正算符定义为泡利算符本身（$C=Y_q$ 而非 $Y_q^\\dagger$）。\n\n给定此场景，推导初始态与经过错误和后续纠正后的最终态之间的保真度 $F = |\\langle\\psi_{init}|\\psi_{final}\\rangle_L|^2$。你的最终答案应针对 $\\theta = \\frac{\\pi}{3}$ 的具体情况。", "solution": "1. 初始逻辑态为\n$$|\\psi_{\\rm init}\\rangle_L = \\cos\\!\\bigl(\\tfrac{\\theta}{2}\\bigr)|0\\rangle_L + \\sin\\!\\bigl(\\tfrac{\\theta}{2}\\bigr)|1\\rangle_L.$$  \n2. 等效错误算符和纠正算符为\n$$E = Y_q\\,\\overline{Z},\\quad C = Y_q.$$  \n3. 作用在编码空间上的净算符为\n$$C\\,E = Y_q\\,Y_q\\,\\overline{Z} = (Y_q)^2\\,\\overline{Z} = I\\,\\overline{Z} = \\overline{Z}.$$  \n4. 最终逻辑态为\n$$|\\psi_{\\rm final}\\rangle_L = \\overline{Z}\\,|\\psi_{\\rm init}\\rangle_L\n= \\cos\\!\\bigl(\\tfrac{\\theta}{2}\\bigr)|0\\rangle_L - \\sin\\!\\bigl(\\tfrac{\\theta}{2}\\bigr)|1\\rangle_L.$$  \n5. 保真度为\n$$F = \\bigl|\\langle\\psi_{\\rm init}|\\psi_{\\rm final}\\rangle_L\\bigr|^2\n= \\bigl|\\cos^2\\!\\bigl(\\tfrac{\\theta}{2}\\bigr)-\\sin^2\\!\\bigl(\\tfrac{\\theta}{2}\\bigr)\\bigr|^2\n= \\cos^2(\\theta).$$  \n6. 对于 $\\theta=\\frac{\\pi}{3}$，\n$$F = \\cos^2\\!\\bigl(\\tfrac{\\pi}{3}\\bigr) = \\Bigl(\\tfrac12\\Bigr)^2 = \\tfrac14.$$", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "84600"}, {"introduction": "现在，我们将这些概念应用于一个具体的解码场景，以评估解码器在真实错误面前的性能。本练习分析了一个特定的关联$Z$错误对环面码（toric code）的影响。通过追踪一个标准的最小权重完美匹配（MWPM）解码器的响应，我们将发现某些低权重的物理错误组合如何能够“欺骗”解码器，使其选择一条导致逻辑错误的“最短路径”，这揭示了解码器算法的一个关键失效模式 [@problem_id:84627]。", "problem": "一个二维环面码（toric code）构建在一个 $L \\times L$ 的方格晶格上，该晶格具有周期性边界条件（即一个环面）。量子比特位于该晶格的边上。该码由一组稳定子算符定义。对于每个顶点 $v$，有一个星算符 $A_v = \\bigotimes_{j \\in \\text{star}(v)} X_j$；对于每个方格（plaquette）$p$，有一个方格算符 $B_p = \\bigotimes_{j \\in \\text{edge}(p)} Z_j$。这里，$\\text{star}(v)$ 是与顶点 $v$ 相邻的边的集合，而 $\\text{edge}(p)$ 是构成方格 $p$ 边界的边的集合。码空间中的一个态 $|\\psi_L\\rangle$ 满足：对于所有的 $v$ 有 $A_v |\\psi_L\\rangle = |\\psi_L\\rangle$ 且对于所有的 $p$ 有 $B_p |\\psi_L\\rangle = |\\psi_L\\rangle$。\n\n考虑一个码距为 $d$ 的环面码，其中 $d=L=3$。晶格的顶点可以用整数坐标 $(x,y)$ 标记，其中 $x,y \\in \\{0, 1, 2\\}$，并且所有坐标运算都在模 $L=3$ 下进行。一条水平边连接顶点 $(x,y)$ 和 $(x+1,y)$，我们将其上的量子比特表示为 $h_{x,y}$。一条垂直边连接 $(x,y)$ 和 $(x,y+1)$，我们将其量子比特表示为 $v_{x,y}$。\n\n假设系统遭受一个由算符 $E = Z(h_{0,1}) Z(h_{1,1})$ 描述的关联泡利-$Z$ 错误事件，其中 $Z(q)$ 是作用在量子比特 $q$ 上的泡利-$Z$ 算符。此错误将违反某些星稳定子，从而产生一个纠错症状（syndrome）。然后应用一个纠错程序，该程序包括两个步骤：\n1.  识别出被违反的星稳定子的位置（即纠错症状）。\n2.  应用一个校正算符 $C$，它是泡利-$Z$ 算符的乘积，形成一条连接纠错症状位置的链。选择这条链使其包含的算符数量最少（即最短路径）。这就是对于单个缺陷对的最小权重完美匹配（MWPM）解码器的原理。如果存在多个这样的最短路径，解码器会均匀随机地选择一条。\n\n如果组合算符 $C \\cdot E$ 等效于码的一个非平凡逻辑算符，则发生逻辑错误。对于 $Z$ 型错误，我们关心的是逻辑 $Z$ 算符 $Z_L$，它是在构成环绕环面的同调非平凡环路的量子比特链上的一系列 $Z$ 算符的乘积。\n\n给定在 $L=3$ 环面码上的特定关联错误 $E = Z(h_{0,1}) Z(h_{1,1})$，在应用 MWPM 纠错程序后，留下一个逻辑错误的概率是多少？", "solution": "1. 错误算符为\n$$\nE = Z(h_{0,1})\\,Z(h_{1,1}).\n$$\n水平边上的每个 $Z$ 算符会翻转两个相邻星算符的本征值。顶点 $(1,1)$ 处的星算符受到两个 $Z$ 算符作用，其本征值返回到 $+1$，而顶点 $(0,1)$ 和 $(2,1)$ 处的星算符各受到一个 $Z$ 算符作用，因此被违反。因此，纠错症状缺陷位于\n$$\nv_1 = (0,1),\\quad v_2 = (2,1).\n$$\n\n2.  MWPM 解码器通过 $Z$ 算符的最短路径连接 $v_1$ 和 $v_2$。在 $3\\times3$ 环面上，通过单条水平边 $h_{2,1}$ 的距离为\n$$\nd\\bigl((0,1),(2,1)\\bigr)=1\n$$\n该路径是唯一的，所以\n$$\nC = Z(h_{2,1}).\n$$\n\n3.  组合算符为\n$$\nC\\,E \n= Z(h_{2,1})\\,Z(h_{0,1})\\,Z(h_{1,1})\n$$\n这恰好是作用在 $y=1$ 处所有三条水平边上的 $Z$ 算符的乘积。这是一个环绕环面的非平凡同调环路，即逻辑算符 $Z_L$。因此，该错误加上校正的每次实现都会产生一个逻辑 $Z$ 错误。\n\n4.  因此，残留逻辑错误的概率是\n$$\n1.\n$$", "answer": "$$\\boxed{1}$$", "id": "84627"}]}