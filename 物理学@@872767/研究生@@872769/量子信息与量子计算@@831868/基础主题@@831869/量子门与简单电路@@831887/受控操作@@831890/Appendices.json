{"hands_on_practices": [{"introduction": "控制门是量子算法的基石，但其行为远比经典“如果-那么”逻辑更为精妙。本练习 [@problem_id:64987] 探究了CNOT门的“反作用”效应，揭示了目标量子比特的状态如何反过来影响控制量子比特。理解这一点对于掌握CNOT门如何产生纠缠至关重要。", "problem": "考虑一个由控制量子比特（下标为 $c$）和目标量子比特（下标为 $t$）组成的双量子比特系统。CNOT（受控非）门作用于该系统。其在计算基 $\\{|0\\rangle, |1\\rangle\\}$ 上的作用定义为 $U_{CNOT}|c\\rangle_c|t\\rangle_t = |c\\rangle_c|t \\oplus c\\rangle_t$，其中 $\\oplus$ 表示模2加法。\n\n系统的初始状态由乘积态 $|\\Psi_{in}\\rangle = |+\\rangle_c |\\psi\\rangle_t$ 给出。控制量子比特制备在状态 $|+\\rangle_c = \\frac{1}{\\sqrt{2}}(|0\\rangle_c + |1\\rangle_c)$ 上。目标量子比特处于状态 $|\\psi\\rangle_t = \\alpha|0\\rangle_t + \\beta|1\\rangle_t$，其中 $\\alpha$ 是一个复系数，$\\beta = \\sqrt{1-|\\alpha|^2}$。平方根取主根（非负实数根），因此 $\\beta$ 是一个非负实数。\n\n当CNOT门作用于系统时，发现控制量子比特的状态保持不变。量子比特子系统的状态由其约化密度矩阵描述。找出满足此条件的复系数 $\\alpha$。", "solution": "初始状态为 $|\\Psi_{\\text{in}}\\rangle = |+\\rangle_c |\\psi\\rangle_t$，其中 $|+\\rangle_c = \\frac{1}{\\sqrt{2}}(|0\\rangle_c + |1\\rangle_c)$ 且 $|\\psi\\rangle_t = \\alpha|0\\rangle_t + \\beta|1\\rangle_t$，$\\beta = \\sqrt{1 - |\\alpha|^2}$（非负实数）。CNOT 门的作用方式为 $U_{\\text{CNOT}}|c\\rangle_c|t\\rangle_t = |c\\rangle_c|t \\oplus c\\rangle_t$。\n\n应用 CNOT 门前的状态可以写作：\n$$\n|\\Psi_{\\text{in}}\\rangle = \\frac{1}{\\sqrt{2}} \\left( \\alpha|00\\rangle + \\beta|01\\rangle + \\alpha|10\\rangle + \\beta|11\\rangle \\right).\n$$\n\n应用 CNOT 门后，控制位为 $|1\\rangle$ 的部分的目标位被翻转：\n$$\n|\\Psi_{\\text{out}}\\rangle = \\frac{1}{\\sqrt{2}} \\left( \\alpha|00\\rangle + \\beta|01\\rangle + \\beta|10\\rangle + \\alpha|11\\rangle \\right),\n$$\n使用简写 $|ab\\rangle = |a\\rangle_c |b\\rangle_t$。\n\n控制量子比特的约化密度矩阵通过对目标量子比特求迹得到：\n$$\n\\rho_{c,\\text{out}} = \\operatorname{Tr}_t(|\\Psi_{\\text{out}}\\rangle\\langle\\Psi_{\\text{out}}|).\n$$\n\n在控制量子比特基 $\\{|0\\rangle_c, |1\\rangle_c\\}$ 中的矩阵元为：\n- 对角元：\n  \n$$\n  \\langle 0| \\rho_{c,\\text{out}} |0\\rangle = \\langle 00| \\Psi_{\\text{out}} \\rangle \\langle \\Psi_{\\text{out}} |00 \\rangle + \\langle 01| \\Psi_{\\text{out}} \\rangle \\langle \\Psi_{\\text{out}} |01 \\rangle = \\left| \\frac{\\alpha}{\\sqrt{2}} \\right|^2 + \\left| \\frac{\\beta}{\\sqrt{2}} \\right|^2 = \\frac{|\\alpha|^2}{2} + \\frac{\\beta^2}{2}.\n  $$\n\n  由于 $\\beta^2 = 1 - |\\alpha|^2$，\n  \n$$\n  \\langle 0| \\rho_{c,\\text{out}} |0\\rangle = \\frac{|\\alpha|^2}{2} + \\frac{1 - |\\alpha|^2}{2} = \\frac{1}{2}.\n  $$\n\n  类似地，\n  \n$$\n  \\langle 1| \\rho_{c,\\text{out}} |1\\rangle = \\frac{\\beta^2}{2} + \\frac{|\\alpha|^2}{2} = \\frac{1}{2}.\n  $$\n\n- 非对角元：\n  \n$$\n  \\langle 0| \\rho_{c,\\text{out}} |1\\rangle = \\langle 00| \\Psi_{\\text{out}} \\rangle \\langle \\Psi_{\\text{out}} |10 \\rangle + \\langle 01| \\Psi_{\\text{out}} \\rangle \\langle \\Psi_{\\text{out}} |11 \\rangle = \\left( \\frac{\\alpha}{\\sqrt{2}} \\right) \\left( \\frac{\\beta}{\\sqrt{2}} \\right)^* + \\left( \\frac{\\beta}{\\sqrt{2}} \\right) \\left( \\frac{\\alpha}{\\sqrt{2}} \\right)^* = \\frac{\\alpha\\beta^* + \\beta\\alpha^*}{2}.\n  $$\n  因为 $\\beta$ 是非负实数，所以 $\\beta^*=\\beta$。\n  $$\n  \\langle 0| \\rho_{c,\\text{out}} |1\\rangle = \\frac{\\beta(\\alpha + \\alpha^*)}{2} = \\beta \\operatorname{Re}(\\alpha).\n  $$\n\n  $\\langle 1| \\rho_{c,\\text{out}} |0\\rangle = (\\langle 0| \\rho_{c,\\text{out}} |1\\rangle)^* = \\beta \\operatorname{Re}(\\alpha)$。\n\n因此，\n$$\n\\rho_{c,\\text{out}} = \\begin{pmatrix}\n\\frac{1}{2}  & \\beta \\operatorname{Re}(\\alpha) \\\\\n\\beta \\operatorname{Re}(\\alpha)  & \\frac{1}{2}\n\\end{pmatrix}.\n$$\n\n控制量子比特的初始约化密度矩阵为：\n$$\n\\rho_{c,\\text{in}} = |+\\rangle\\langle+|_c = \\frac{1}{2} \\begin{pmatrix} 1  & 1 \\\\ 1  & 1 \\end{pmatrix}.\n$$\n\n为使控制量子比特的状态保持不变，需满足 $\\rho_{c,\\text{out}} = \\rho_{c,\\text{in}}$，所以：\n$$\n\\beta \\operatorname{Re}(\\alpha) = \\frac{1}{2}.\n$$\n\n代入 $\\beta = \\sqrt{1 - |\\alpha|^2}$，\n$$\n\\sqrt{1 - |\\alpha|^2} \\cdot \\operatorname{Re}(\\alpha) = \\frac{1}{2}.\n$$\n\n设 $\\alpha = a + ib$，其中 $a, b \\in \\mathbb{R}$，则 $| \\alpha |^2 = a^2 + b^2$ 且 $\\operatorname{Re}(\\alpha) = a$：\n$$\n\\sqrt{1 - (a^2 + b^2)} \\cdot a = \\frac{1}{2}.\n$$\n因为等式右边为正，且 $\\sqrt{\\dots}$ 为非负，所以必须有 $a > 0$。\n\n两边平方，\n$$\na^2 (1 - a^2 - b^2) = \\frac{1}{4}.\n$$\n重新整理，\n$$\na^2 b^2 = a^2 - a^4 - \\frac{1}{4} = -(a^4 - a^2 + \\frac{1}{4}) = -(a^2 - \\frac{1}{2})^2.\n$$\n由于 $a, b$ 是实数，所以 $a^2b^2 \\geq 0$。同时，$-(a^2 - \\frac{1}{2})^2 \\leq 0$。\n唯一使等式成立的可能是两边都等于零。\n$$\na^2 b^2 = 0 \\quad \\text{and} \\quad -(a^2 - \\frac{1}{2})^2 = 0.\n$$\n从第一部分可知 $a=0$ 或 $b=0$。但我们已经知道 $a>0$，所以 $b=0$。\n从第二部分可知 $a^2 = \\frac{1}{2}$。因为 $a>0$，所以 $a = \\frac{1}{\\sqrt{2}}$。\n\n因此，$\\alpha = a + ib = \\frac{1}{\\sqrt{2}} + i \\cdot 0 = \\frac{1}{\\sqrt{2}}$。", "answer": "$$ \\boxed{\\dfrac{1}{\\sqrt{2}}} $$", "id": "64987"}, {"introduction": "在理解了单个控制门的基础上，本练习 [@problem_id:65061] 展示了它们在序列中的强大能力。你将通过应用一系列受控操作来构建一个特定的多量子比特纠缠态。这个实践加强了对量子态在电路中逐步演化的理解，并突显了如何通过简单的两比特和三比特相互作用来构建复杂的量子关联。", "problem": "考虑一个三量子比特的量子系统，其量子比特标记为1、2和3。该系统被初始化在状态 $|\\psi_i\\rangle = |+\\rangle_1 |0\\rangle_2 |0\\rangle_3$ 下，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$，$|0\\rangle, |1\\rangle$ 是标准的计算基态。\n\n一个由三个量子门组成的序列按以下顺序作用于该系统：\n1.  一个受控非门 (CNOT)，记为 $CNOT_{12}$，其中量子比特1为控制位，量子比特2为目标位。CNOT门在计算基态 $|c\\rangle|t\\rangle$ 上的作用是 $|c\\rangle|t \\oplus c\\rangle$，其中 $\\oplus$ 表示模2加法。\n2.  第二个CNOT门，记为 $CNOT_{13}$，其中量子比特1为控制位，量子比特3为目标位。\n3.  一个双控泡利Z门，记为 $CCZ_{2,3;1}$，其中量子比特2和3为控制量子比特，量子比特1为目标量子比特。当且仅当两个控制量子比特都处于状态 $|1\\rangle$ 时，此门才对目标量子比特应用一个泡利Z门。泡利Z门的定义为 $Z|0\\rangle = |0\\rangle$ 和 $Z|1\\rangle = -|1\\rangle$。\n\n设 $|\\psi_f\\rangle$ 是应用此量子门序列后系统的最终状态。计算初始状态和最终状态之间的保真度 $F = |\\langle \\psi_i | \\psi_f \\rangle|^2$。", "solution": "初始状态为 $|\\psi_i\\rangle = |+\\rangle_1 |0\\rangle_2 |0\\rangle_3$，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。因此，\n\n$$\n|\\psi_i\\rangle = \\frac{1}{\\sqrt{2}} \\left( |0\\rangle_1 |0\\rangle_2 |0\\rangle_3 + |1\\rangle_1 |0\\rangle_2 |0\\rangle_3 \\right) = \\frac{1}{\\sqrt{2}} (|000\\rangle + |100\\rangle).\n$$\n\n按顺序应用量子门：\n\n1. **CNOT$_{12}$** (控制量子比特1，目标量子比特2)：\n   - $|000\\rangle \\to |000\\rangle$ (控制位为0，目标位不变)。\n   - $|100\\rangle \\to |110\\rangle$ (控制位为1，目标位翻转)。\n   得到的状态：\n   \n$$\n   |\\psi_1\\rangle = \\frac{1}{\\sqrt{2}} \\left( |000\\rangle + |110\\rangle \\right),\n   $$\n\n   其中 $|q_1 q_2 q_3\\rangle$ 表示 $|q_1\\rangle_1 |q_2\\rangle_2 |q_3\\rangle_3$。\n\n2. **CNOT$_{13}$** (控制量子比特1，目标量子比特3)：\n   - $|000\\rangle \\to |000\\rangle$ (控制位为0，目标位不变)。\n   - $|110\\rangle \\to |111\\rangle$ (控制位为1，目标位从 $|0\\rangle$ 翻转到 $|1\\rangle$ )。\n   得到的状态（这是一个GHZ态）：\n   \n$$\n   |\\psi_2\\rangle = \\frac{1}{\\sqrt{2}} \\left( |000\\rangle + |111\\rangle \\right).\n   $$\n\n\n3. **CCZ$_{2,3;1}$** (控制量子比特2和3，目标量子比特1；如果两个控制位都为 $|1\\rangle$，则对目标位应用Z门)：\n   - $|000\\rangle$：控制位为 $|0\\rangle$ 和 $|0\\rangle$，所以无作用 $\\to |000\\rangle$。\n   - $|111\\rangle$：控制位为 $|1\\rangle$ 和 $|1\\rangle$，所以对目标量子比特1应用Z门： $Z_1|111\\rangle = (Z|1\\rangle)_1 |1\\rangle_2 |1\\rangle_3 = (-|1\\rangle_1)|1\\rangle_2 |1\\rangle_3 = -|111\\rangle$。\n   得到的最终状态：\n   \n$$\n   |\\psi_f\\rangle = \\frac{1}{\\sqrt{2}} \\left( |000\\rangle - |111\\rangle \\right).\n   $$\n\n\n保真度为 $F = |\\langle \\psi_i | \\psi_f \\rangle|^2$。计算内积：\n\n$$\n\\langle \\psi_i | \\psi_f \\rangle = \\left( \\frac{1}{\\sqrt{2}} \\left( \\langle 000| + \\langle 100| \\right) \\right) \\left( \\frac{1}{\\sqrt{2}} \\left( |000\\rangle - |111\\rangle \\right) \\right) = \\frac{1}{2} \\left( \\langle 000| + \\langle 100| \\right) \\left( |000\\rangle - |111\\rangle \\right).\n$$\n\n展开：\n\n$$\n\\langle \\psi_i | \\psi_f \\rangle = \\frac{1}{2} \\left[ \\langle 000|000\\rangle - \\langle 000|111\\rangle + \\langle 100|000\\rangle - \\langle 100|111\\rangle \\right].\n$$\n\n利用计算基态的正交归一性 ($\\langle abc | def \\rangle = \\delta_{ad} \\delta_{be} \\delta_{cf}$):\n\n$$\n\\langle 000|000\\rangle = 1, \\quad \\langle 000|111\\rangle = 0, \\quad \\langle 100|000\\rangle = 0, \\quad \\langle 100|111\\rangle = 0.\n$$\n\n因此，\n\n$$\n\\langle \\psi_i | \\psi_f \\rangle = \\frac{1}{2} \\left[ 1 - 0 + 0 - 0 \\right] = \\frac{1}{2}.\n$$\n\n保真度是内积模的平方：\n\n$$\nF = \\left| \\frac{1}{2} \\right|^2 = \\frac{1}{4}.\n$$", "answer": "$$ \\boxed{\\dfrac{1}{4}} $$", "id": "65061"}, {"introduction": "控制门不仅仅是固定的构建模块；在现代变分量子算法中，它们也扮演着核心角色，通过调节门参数来解决问题。本练习 [@problem_id:64998] 将你带入这一领域，要求你计算一个期望值相对于受控旋转角度的解析梯度。这项技能对于优化参数化量子电路至关重要，而这正是量子机器学习和计算化学等领域的核心技术。", "problem": "考虑一个双量子比特系统，其中第一个量子比特作为控制比特，第二个量子比特作为目标比特。系统被初始化为乘积态 $|\\psi_{in}\\rangle = |+\\rangle_1 |0\\rangle_2$，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle)$。\n\n一个受控-$R_y(\\theta)$门，记作 $C-R_y(\\theta)$，被应用于此初始态。该门的作用是：当控制比特处于$|0\\rangle$态时，对目标比特施加单位算符 $I$；当控制比特处于$|1\\rangle$态时，对目标比特施加单量子比特旋转 $R_y(\\theta)$。该算符可以写成：\n$$C-R_y(\\theta) = |0\\rangle\\langle 0| \\otimes I + |1\\rangle\\langle 1| \\otimes R_y(\\theta)$$\n旋转门 $R_y(\\theta)$ 由以下矩阵定义：\n$$R_y(\\theta) = \\exp\\left(-i \\frac{\\theta}{2} Y\\right) = \\begin{pmatrix} \\cos(\\theta/2)  & -\\sin(\\theta/2) \\\\ \\sin(\\theta/2)  & \\cos(\\theta/2) \\end{pmatrix}$$\n其中 $Y$ 是泡利-Y矩阵。门作用后系统的状态为 $|\\psi_{out}(\\theta)\\rangle = C-R_y(\\theta) |\\psi_{in}\\rangle$。\n\n最后，对目标比特执行泡利-Z算符的测量。因此，可观测量为 $M = I_1 \\otimes Z_2$。\n\n你的任务是计算可观测量 $M$ 的期望值关于门参数 $\\theta$ 的解析梯度。找到 $\\frac{d}{d\\theta} \\langle M \\rangle$ 的闭式表达式，其中 $\\langle M \\rangle(\\theta) = \\langle\\psi_{out}(\\theta)| M |\\psi_{out}(\\theta)\\rangle$。", "solution": "初始态为 $|\\psi_{in}\\rangle = |+\\rangle_1 |0\\rangle_2 = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) \\otimes |0\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |10\\rangle)$。\n\n受控-$R_y(\\theta)$门的作用如下：\n\n$$\nC-R_y(\\theta) = |0\\rangle\\langle 0| \\otimes I + |1\\rangle\\langle 1| \\otimes R_y(\\theta)\n$$\n\n应用该门到初态的两个部分：\n\n$$\nC-R_y(\\theta) |00\\rangle = |0\\rangle \\otimes I|0\\rangle = |00\\rangle\n$$\n\n\n$$\nC-R_y(\\theta) |10\\rangle = |1\\rangle \\otimes R_y(\\theta)|0\\rangle = |1\\rangle \\otimes \\left( \\cos\\left(\\frac{\\theta}{2}\\right) |0\\rangle + \\sin\\left(\\frac{\\theta}{2}\\right) |1\\rangle \\right) = \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle + \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle\n$$\n\n因此，输出态为：\n\n$$\n|\\psi_{out}(\\theta)\\rangle = C-R_y(\\theta) |\\psi_{in}\\rangle = \\frac{1}{\\sqrt{2}} \\left( |00\\rangle + \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle + \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle \\right)\n$$\n\n\n可观测量为 $M = I_1 \\otimes Z_2$。期望值 $\\langle M \\rangle = \\langle \\psi_{out}(\\theta) | M | \\psi_{out}(\\theta) \\rangle$。\n\n首先，将 $M$ 应用于 $|\\psi_{out}(\\theta)\\rangle$：\n\n$$\nM |\\psi_{out}(\\theta)\\rangle = (I_1 \\otimes Z_2) \\cdot \\frac{1}{\\sqrt{2}} \\left( |00\\rangle + \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle + \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle \\right)\n$$\n\n由于 $Z_2 |0\\rangle = |0\\rangle$ 且 $Z_2 |1\\rangle = -|1\\rangle$：\n\n$$\nM |\\psi_{out}(\\theta)\\rangle = \\frac{1}{\\sqrt{2}} \\left( |00\\rangle + \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle - \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle \\right)\n$$\n\n\n现在计算内积 $\\langle \\psi_{out}(\\theta) | M | \\psi_{out}(\\theta) \\rangle$：\n\n$$\n\\langle M \\rangle = \\frac{1}{2} \\left( \\langle 00| + \\cos\\left(\\frac{\\theta}{2}\\right) \\langle 10| + \\sin\\left(\\frac{\\theta}{2}\\right) \\langle 11| \\right) \\left( |00\\rangle + \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle - \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle \\right)\n$$\n\n利用基态的正交归一性：\n\n$$\n\\langle M \\rangle = \\frac{1}{2} \\left[ 1 \\cdot 1 + \\cos\\left(\\frac{\\theta}{2}\\right) \\cdot \\cos\\left(\\frac{\\theta}{2}\\right) + \\sin\\left(\\frac{\\theta}{2}\\right) \\cdot (-\\sin\\left(\\frac{\\theta}{2}\\right)) \\right] = \\frac{1}{2} \\left[ 1 + \\cos^2\\left(\\frac{\\theta}{2}\\right) - \\sin^2\\left(\\frac{\\theta}{2}\\right) \\right]\n$$\n\n使用二倍角恒等式 $\\cos^2(\\alpha) - \\sin^2(\\alpha) = \\cos(2\\alpha)$，其中 $\\alpha = \\theta/2$：\n\n$$\n\\langle M \\rangle = \\frac{1}{2} \\left( 1 + \\cos(\\theta) \\right)\n$$\n\n\n关于 $\\theta$ 的导数是：\n\n$$\n\\frac{d}{d\\theta} \\langle M \\rangle = \\frac{d}{d\\theta} \\left[ \\frac{1}{2} (1 + \\cos(\\theta)) \\right] = \\frac{1}{2} \\cdot (-\\sin(\\theta)) = -\\frac{1}{2} \\sin(\\theta)\n$$", "answer": "$$ \\boxed{-\\dfrac{1}{2}\\sin(\\theta)} $$", "id": "64998"}]}