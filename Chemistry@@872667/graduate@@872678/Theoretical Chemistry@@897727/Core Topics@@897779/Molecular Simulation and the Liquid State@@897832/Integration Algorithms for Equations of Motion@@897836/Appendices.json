{"hands_on_practices": [{"introduction": "In molecular dynamics, the choice of timestep $h$ is a critical trade-off between efficiency and stability. This practice reveals the fundamental origin of the stability limit for the Verlet algorithm, which is dictated by the highest frequency vibrations in the system. By analyzing a simple harmonic oscillator model, you will directly connect a physical property—vibrational frequency—to the maximum permissible timestep for a stable simulation. [@problem_id:2780537]", "problem": "A single bonded pair in a diatomic molecule can be modeled near equilibrium as a one-dimensional harmonic oscillator with potential energy $V(x)=\\frac{1}{2}k x^{2}$, where $k$ is the curvature of the potential and $x$ is the bond displacement. The equation of motion is $m\\,\\ddot{x}=-\\frac{\\partial V}{\\partial x}$, where $m$ is the reduced mass. Spectroscopic measurements report a high-frequency stretching mode at wavenumber $\\tilde{\\nu}=3000\\ \\mathrm{cm}^{-1}$. You plan to integrate the equations of motion using the position-Verlet algorithm. Using only fundamental definitions and a linear stability analysis of the resulting discrete harmonic oscillator dynamics, determine a numerically safe time step $h_{\\text{safe}}$ defined as one-tenth of the largest time step $h_{\\max}$ that keeps the discrete solution bounded (no exponential growth). Use the speed of light $c=2.99792458\\times 10^{10}\\ \\mathrm{cm\\,s^{-1}}$ to convert the wavenumber to angular frequency.\n\nExpress your final answer as $h_{\\text{safe}}$ in femtoseconds, and round your answer to four significant figures. Report only the value of $h_{\\text{safe}}$.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It is based on fundamental principles of classical mechanics (harmonic oscillator), spectroscopy, and numerical analysis (stability of integration algorithms). All necessary information is provided for a unique solution. I will proceed with the derivation.\n\nThe system is a one-dimensional harmonic oscillator, whose potential energy is given by $V(x) = \\frac{1}{2}kx^2$. The equation of motion is Newton's second law:\n$$m\\ddot{x} = -\\frac{\\partial V}{\\partial x} = -kx$$\nThis can be rewritten in the standard form for a simple harmonic oscillator:\n$$\\ddot{x} + \\omega^2 x = 0$$\nwhere $\\omega = \\sqrt{k/m}$ is the natural angular frequency of the oscillator.\n\nThe problem provides the wavenumber of the stretching mode, $\\tilde{\\nu} = 3000\\ \\mathrm{cm}^{-1}$. The angular frequency $\\omega$ is related to the wavenumber $\\tilde{\\nu}$ and the speed of light $c$ by the following fundamental relations. The frequency $\\nu$ is given by $\\nu = c\\tilde{\\nu}$, and the angular frequency is $\\omega = 2\\pi\\nu$. Therefore:\n$$\\omega = 2\\pi c \\tilde{\\nu}$$\nThis allows the determination of $\\omega$ without explicit knowledge of the reduced mass $m$ or the force constant $k$.\n\nThe position-Verlet algorithm is a specific implementation of the Verlet integration scheme. For the purpose of linear stability analysis, it is sufficient to analyze the basic Verlet recurrence relation, which is mathematically equivalent in this context. The discrete form for the position $x_n = x(nh)$ at time $t_n = n h$ with time step $h$ is:\n$$x_{n+1} = 2x_n - x_{n-1} + h^2 a_n$$\nwhere $a_n = \\ddot{x}(t_n)$ is the acceleration at time $t_n$. For the harmonic oscillator, the acceleration is $a_n = -\\omega^2 x_n$. Substituting this into the recurrence relation gives:\n$$x_{n+1} = 2x_n - x_{n-1} - h^2 \\omega^2 x_n$$\nThis is a linear homogeneous recurrence relation with constant coefficients, which can be rearranged as:\n$$x_{n+1} - (2 - (\\omega h)^2)x_n + x_{n-1} = 0$$\nTo analyze the stability of this relation, we seek solutions of the form $x_n = \\lambda^n$. Substituting this ansatz yields the characteristic equation:\n$$\\lambda^2 - (2 - (\\omega h)^2)\\lambda + 1 = 0$$\nFor the solution to remain bounded, the magnitudes of the roots $\\lambda$ of this quadratic equation must not be greater than $1$. Since the product of the roots is $\\lambda_1 \\lambda_2 = 1$ (from the constant term of the polynomial), this condition implies that the roots must be complex conjugates lying on the unit circle in the complex plane, i.e., $|\\lambda| = 1$. This occurs if and only if the discriminant of the characteristic equation is negative:\n$$\\Delta = (2 - (\\omega h)^2)^2 - 4  0$$\nSolving this inequality for the term $(\\omega h)^2$:\n$$(2 - (\\omega h)^2)^2  4$$\n$$|2 - (\\omega h)^2|  2$$\nThis leads to a two-sided inequality:\n$$-2  2 - (\\omega h)^2  2$$\nThe right side of the inequality, $2 - (\\omega h)^2  2$, implies $-(\\omega h)^2  0$, which is true for any non-zero $h$ and $\\omega$. The left side of the inequality, $-2  2 - (\\omega h)^2$, implies $(\\omega h)^2  4$.\nThus, the condition for numerical stability is:\n$$|\\omega h|  2$$\nThe largest possible time step, $h_{\\max}$, for which the discrete solution remains bounded is found at the boundary of this stability region:\n$$\\omega h_{\\max} = 2 \\implies h_{\\max} = \\frac{2}{\\omega}$$\nThe problem defines a numerically safe time step, $h_{\\text{safe}}$, as one-tenth of this maximum value:\n$$h_{\\text{safe}} = \\frac{1}{10} h_{\\max} = \\frac{1}{10} \\left(\\frac{2}{\\omega}\\right) = \\frac{1}{5\\omega}$$\nSubstituting the expression for $\\omega = 2\\pi c \\tilde{\\nu}$:\n$$h_{\\text{safe}} = \\frac{1}{5(2\\pi c \\tilde{\\nu})} = \\frac{1}{10\\pi c \\tilde{\\nu}}$$\nNow, we substitute the provided numerical values: $\\tilde{\\nu} = 3000\\ \\mathrm{cm}^{-1}$ and $c = 2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s^{-1}}$.\n$$h_{\\text{safe}} = \\frac{1}{10\\pi (2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s^{-1}})(3000\\ \\mathrm{cm}^{-1})}$$\n$$h_{\\text{safe}} = \\frac{1}{30000\\pi \\times 2.99792458 \\times 10^{10}}\\ \\mathrm{s}$$\n$$h_{\\text{safe}} \\approx 3.5392318 \\times 10^{-16}\\ \\mathrm{s}$$\nThe problem requires the answer in femtoseconds, where $1\\ \\mathrm{fs} = 10^{-15}\\ \\mathrm{s}$.\n$$h_{\\text{safe}} \\approx 3.5392318 \\times 10^{-16} \\ \\mathrm{s} \\times \\left(\\frac{1\\ \\mathrm{fs}}{10^{-15}\\ \\mathrm{s}}\\right) = 0.35392318\\ \\mathrm{fs}$$\nRounding the result to four significant figures gives:\n$$h_{\\text{safe}} = 0.3539\\ \\mathrm{fs}$$", "answer": "$$\\boxed{0.3539}$$", "id": "2780537"}, {"introduction": "Translating theoretical algorithms into functional code is a cornerstone of computational science. This exercise challenges you to implement the widely used velocity Verlet integrator for a particle moving in a realistic, anharmonic Morse potential. By calculating the total energy of the system over time, you will investigate the concept of energy drift, a key diagnostic for the accuracy and long-term stability of a numerical trajectory. [@problem_id:2780514]", "problem": "Consider the one-dimensional equation of motion for a single degree of freedom coordinate $q$ of reduced mass $m$ moving in a Morse potential $V(q)=D_e\\left(1-\\exp\\left(-a\\,(q-q_e)\\right)\\right)^2$. The dynamics are governed by Newton's second law $m\\,\\mathrm{d}^2 q / \\mathrm{d} t^2 = - \\mathrm{d} V / \\mathrm{d} q$, and the kinetic energy is $K = \\tfrac{1}{2}\\,m\\,v^2$ with $v=\\mathrm{d} q / \\mathrm{d} t$. The total energy is $E=K+V$, which is a constant of motion for the exact solution.\n\nYour task is to write a complete program that:\n- Implements the velocity Verlet time integration algorithm to advance the trajectory by $N$ steps of size $h$ starting from initial conditions $q(0)=q_0$ and $v(0)=v_0$ under the force $F(q)=-\\mathrm{d}V/\\mathrm{d}q$.\n- Computes the energy drift $\\Delta E = E_N - E_0$, where $E_0$ is the initial total energy and $E_N$ is the total energy after $N$ steps.\n- Uses atomic units throughout: energy in Hartree, length in bohr, mass in the electron mass unit, and time in the atomic unit of time. You must express the final numerical answers in Hartree (for energy drift), rounded to $10$ decimal places.\n\nBase your implementation only on:\n- Newton's second law $m\\,\\mathrm{d}^2 q / \\mathrm{d} t^2 = F(q)$ with $F(q)=-\\mathrm{d}V/\\mathrm{d}q$.\n- The definitions of kinetic energy $K=\\tfrac{1}{2}\\,m\\,v^2$ and total energy $E=K+V$.\n- The standard velocity Verlet scheme consistent with these laws.\n\nDerive any needed expressions (such as the force) directly from the provided potential $V(q)$.\n\nTest suite:\nEvaluate the program on the following five parameter sets. Each case specifies $(D_e,a,q_e,m,q_0,v_0,h,N)$ in the given order, with all quantities in atomic units as specified above.\n- Case $1$: $(D_e,a,q_e,m,q_0,v_0,h,N)=(\\,0.176,\\,1.02,\\,0.0,\\,1836.0,\\,0.2,\\,0.0,\\,0.2,\\,1000\\,)$.\n- Case $2$: $(D_e,a,q_e,m,q_0,v_0,h,N)=(\\,0.176,\\,1.02,\\,0.0,\\,1836.0,\\,0.2,\\,0.0,\\,0.02,\\,10000\\,)$.\n- Case $3$: $(D_e,a,q_e,m,q_0,v_0,h,N)=(\\,0.176,\\,1.02,\\,0.0,\\,1836.0,\\,0.0,\\,0.0,\\,0.5,\\,100\\,)$.\n- Case $4$: $(D_e,a,q_e,m,q_0,v_0,h,N)=(\\,0.176,\\,1.02,\\,0.0,\\,1836.0,\\,1.0,\\,-0.05,\\,0.4,\\,800\\,)$.\n- Case $5$: $(D_e,a,q_e,m,q_0,v_0,h,N)=(\\,0.176,\\,1.02,\\,0.0,\\,1836.0,\\,0.3,\\,0.1,\\,0.1,\\,0\\,)$.\n\nRequired final output format:\nYour program should produce a single line of output containing the five resulting energy drifts, in the order of the cases above, as a comma-separated list enclosed in square brackets. Each drift must be a float rounded to $10$ decimal places, for example, $[0.0000000000,0.1234567890,-0.0000000001,0.0000000000,0.0000000000]$.", "solution": "The problem requires the implementation of the velocity Verlet algorithm to simulate the dynamics of a particle in a one-dimensional Morse potential and to compute the numerical energy drift. The problem statement is subjected to validation before a solution is attempted.\n\n**Problem Validation**\n\n1.  **Givens Extracted:**\n    *   Potential: $V(q)=D_e\\left(1-\\exp\\left(-a\\,(q-q_e)\\right)\\right)^2$.\n    *   Equation of Motion: $m\\,\\mathrm{d}^2 q / \\mathrm{d} t^2 = - \\mathrm{d} V / \\mathrm{d} q$.\n    *   Energy: $E = \\tfrac{1}{2}\\,m\\,v^2 + V(q)$.\n    *   Algorithm: Velocity Verlet integration.\n    *   Task: Compute energy drift $\\Delta E = E_N - E_0$ over $N$ steps of size $h$.\n    *   Units: Atomic units are specified for all quantities.\n    *   Parameters: Five test cases with specified values for $(D_e,a,q_e,m,q_0,v_0,h,N)$ are provided.\n\n2.  **Validation Verdict:**\n    The problem is **valid**. It is scientifically grounded in classical mechanics, mathematically well-posed, and all necessary information for a unique numerical solution is provided. The use of the Morse potential and the velocity Verlet algorithm are standard practices in theoretical chemistry. The problem is a straightforward application of established principles and contains no ambiguities, contradictions, or factual errors. Two of the provided test cases (Case 3 and Case 5) represent trivial dynamics and serve as logical checks for any correct implementation.\n\n**Solution Derivation**\n\nThe solution proceeds in three steps: derivation of the force, formulation of the integration algorithm, and specification of the energy calculation.\n\n**1. Force Derivation**\nThe force $F(q)$ is the negative gradient of the potential energy $V(q)$. The potential is given by:\n$$V(q) = D_e\\left(1 - \\exp\\left(-a(q - q_e)\\right)\\right)^2$$\nTo find the force, we must compute the derivative $\\mathrm{d}V/\\mathrm{d}q$. Using the chain rule, let $u(q) = -a(q - q_e)$. Then $V(q) = D_e(1 - e^u)^2$.\n$$\\frac{\\mathrm{d}V}{\\mathrm{d}q} = \\frac{\\mathrm{d}V}{\\mathrm{d}u} \\frac{\\mathrm{d}u}{\\mathrm{d}q}$$\nThe individual derivatives are:\n$$\\frac{\\mathrm{d}V}{\\mathrm{d}u} = D_e \\cdot 2(1 - e^u) \\cdot \\frac{d}{du}(1-e^u) = D_e \\cdot 2(1 - e^u) \\cdot (-e^u) = -2D_e(e^u - e^{2u})$$\n$$\\frac{\\mathrm{d}u}{\\mathrm{d}q} = -a$$\nCombining these results gives:\n$$\\frac{\\mathrm{d}V}{\\mathrm{d}q} = \\left(-2D_e(e^u - e^{2u})\\right) \\cdot (-a) = 2aD_e(e^u - e^{2u})$$\nSubstituting $u = -a(q-q_e)$ back into the expression yields:\n$$\\frac{\\mathrm{d}V}{\\mathrm{d}q} = 2aD_e \\left(\\exp\\left(-a(q-q_e)\\right) - \\exp\\left(-2a(q-q_e)\\right)\\right)$$\nThe force $F(q) = -\\mathrm{d}V/\\mathrm{d}q$ is therefore:\n$$F(q) = -2aD_e \\left(\\exp\\left(-a(q-q_e)\\right) - \\exp\\left(-2a(q-q_e)\\right)\\right)$$\nThis expression will be used to compute the force at each time step.\n\n**2. Velocity Verlet Algorithm**\nThe velocity Verlet algorithm is a second-order symplectic integrator used to solve Newton's equations of motion. Given the position $q_n$, velocity $v_n$, and force $F_n = F(q_n)$ at time $t_n = n h$, the state at the next time step $t_{n+1} = (n+1)h$ is computed as follows.\n\nFirst, the position is advanced by a full time step $h$:\n$$q_{n+1} = q_n + v_n h + \\frac{1}{2} \\frac{F_n}{m} h^2$$\nNext, the force $F_{n+1}$ is computed at the new position $q_{n+1}$:\n$$F_{n+1} = F(q_{n+1})$$\nFinally, the velocity is updated using the average of the old and new forces:\n$$v_{n+1} = v_n + \\frac{h}{2m} (F_n + F_{n+1})$$\nThis sequence of operations is repeated for $N$ steps, starting from the initial conditions $(q_0, v_0)$.\n\n**3. Energy Calculation and Drift**\nThe total energy $E$ at any point in time for a state $(q,v)$ is the sum of the kinetic energy $K$ and potential energy $V$:\n$$E(q,v) = K(v) + V(q) = \\frac{1}{2}mv^2 + D_e\\left(1 - \\exp\\left(-a(q-q_e)\\right)\\right)^2$$\nThe initial energy is calculated at $t=0$:\n$$E_0 = E(q_0, v_0)$$\nAfter $N$ integration steps, the system is in the final state $(q_N, v_N)$. The final energy is:\n$$E_N = E(q_N, v_N)$$\nThe energy drift $\\Delta E$ is the difference between the final and initial energies:\n$$\\Delta E = E_N - E_0$$\nFor a perfect integration of a conservative system, $\\Delta E$ would be zero. For the numerical velocity Verlet scheme, the energy is not exactly conserved, but it exhibits bounded fluctuations around the true value, with no long-term systematic drift. The magnitude of these fluctuations depends on the time step $h$.\n\nIn Case 3, where $q_0 = q_e$ and $v_0 = 0$, the initial force is $F(q_e) = 0$. The particle is at rest at the minimum of the potential well. The algorithm will correctly keep the particle stationary, so $q_n = q_e$ and $v_n = 0$ for all $n$. Consequently, $E_N = E_0$ and the energy drift $\\Delta E$ must be exactly $0.0$.\n\nIn Case 5, where the number of steps $N=0$, no integration is performed. The final state is identical to the initial state, so $q_N = q_0$ and $v_N = v_0$. The energy drift $\\Delta E = E_0 - E_0$ is trivially $0.0$. These cases serve as validation for the implementation. The program will follow these derived formulas to compute the energy drift for each test case, with the final results rounded to $10$ decimal places as specified.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print results.\n    \"\"\"\n\n    # Helper functions for physical quantities, defined within the scope of solve()\n    # to keep the solution self-contained.\n\n    def get_potential(q, De, a, qe):\n        \"\"\"Calculates the Morse potential energy.\"\"\"\n        return De * (1.0 - np.exp(-a * (q - qe)))**2\n\n    def get_force(q, De, a, qe):\n        \"\"\"Calculates the force derived from the Morse potential.\"\"\"\n        exp_term = np.exp(-a * (q - qe))\n        return -2.0 * a * De * (exp_term - exp_term**2)\n\n    def get_total_energy(q, v, De, a, qe, m):\n        \"\"\"Calculates the total energy (kinetic + potential).\"\"\"\n        kinetic_energy = 0.5 * m * v**2\n        potential_energy = get_potential(q, De, a, qe)\n        return kinetic_energy + potential_energy\n\n    def run_simulation(De, a, qe, m, q0, v0, h, N):\n        \"\"\"\n        Runs a velocity Verlet simulation for a single parameter set.\n\n        Args:\n            De, a, qe: Morse potential parameters.\n            m: Mass of the particle.\n            q0, v0: Initial position and velocity.\n            h: Time step size.\n            N: Number of integration steps.\n\n        Returns:\n            The energy drift (E_final - E_initial).\n        \"\"\"\n        # Handle the trivial case of zero steps.\n        if N == 0:\n            return 0.0\n\n        # Handle the trivial stationary case where the particle starts at rest at the potential minimum.\n        if q0 == qe and v0 == 0.0:\n            return 0.0\n\n        # Initial state\n        q = float(q0)\n        v = float(v0)\n\n        # Calculate initial energy\n        E0 = get_total_energy(q, v, De, a, qe, m)\n\n        # Calculate initial force needed for the first step\n        force = get_force(q, De, a, qe)\n\n        # Velocity Verlet integration loop\n        for _ in range(int(N)):\n            # Update position to a full step\n            q_new = q + v * h + 0.5 * (force / m) * h**2\n\n            # Calculate force at the new position\n            force_new = get_force(q_new, De, a, qe)\n\n            # Update velocity with the average of old and new forces\n            v_new = v + 0.5 * ((force + force_new) / m) * h\n\n            # Update state for the next iteration\n            q, v, force = q_new, v_new, force_new\n\n        # Calculate final energy\n        E_final = get_total_energy(q, v, De, a, qe, m)\n        \n        energy_drift = E_final - E0\n        return energy_drift\n\n    # Test suite from the problem statement.\n    # Each tuple contains: (De, a, qe, m, q0, v0, h, N)\n    test_cases = [\n        (0.176, 1.02, 0.0, 1836.0, 0.2, 0.0, 0.2, 1000),\n        (0.176, 1.02, 0.0, 1836.0, 0.2, 0.0, 0.02, 10000),\n        (0.176, 1.02, 0.0, 1836.0, 0.0, 0.0, 0.5, 100),\n        (0.176, 1.02, 0.0, 1836.0, 1.0, -0.05, 0.4, 800),\n        (0.176, 1.02, 0.0, 1836.0, 0.3, 0.1, 0.1, 0),\n    ]\n\n    results = []\n    for case in test_cases:\n        drift = run_simulation(*case)\n        # Round the result to 10 decimal places as required.\n        results.append(round(drift, 10))\n\n    # Format the results into the specified string format.\n    # Using f-string with .10f ensures fixed-point notation and avoids scientific notation.\n    formatted_results = [f\"{r:.10f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the main function.\nsolve()\n```", "id": "2780514"}, {"introduction": "As established previously, high-frequency motions like bond stretching severely restrict the simulation timestep, making long simulations computationally expensive. This practice explores a powerful and common solution: the use of holonomic constraints to \"freeze\" these fast motions, allowing for a much larger timestep. You will quantify the significant efficiency gain achieved by making O–H bonds rigid in a water model, demonstrating a key technique for practical molecular simulations. [@problem_id:2780480]", "problem": "Consider a single decoupled normal mode of a molecular system governed by Newton’s second law, which in the harmonic approximation satisfies $m \\, \\ddot{x}(t) = - k \\, x(t)$, equivalently $\\ddot{x}(t) + \\omega^{2} x(t) = 0$ with $\\omega = \\sqrt{k/m}$. The mode is integrated in Molecular Dynamics (MD) using the velocity Verlet algorithm defined by the discrete update\n$v_{n+\\frac{1}{2}} = v_{n} + \\frac{\\Delta t}{2} a(x_{n})$, \n$x_{n+1} = x_{n} + \\Delta t \\, v_{n+\\frac{1}{2}}$, \n$v_{n+1} = v_{n+\\frac{1}{2}} + \\frac{\\Delta t}{2} a(x_{n+1})$,\nwhere $a(x) = -\\omega^{2} x$ and $\\Delta t$ is the timestep. Starting from these definitions and the harmonic equation of motion, derive the linear stability condition that ensures bounded solutions for the discrete trajectory $\\{x_{n}\\}$ as $n \\to \\infty$, and obtain the resulting expression for the maximal stable timestep as a function of the mode angular frequency $\\omega$.\n\nThen apply your result to assess the effect of holonomic constraints that rigidify high-frequency O–H stretches in a water model. Use the following gas-phase water wavenumbers (in $\\mathrm{cm}^{-1}$) as characteristic values for the fastest internal motions: asymmetric stretch $\\tilde{\\nu}_{\\mathrm{as}} = 3756 \\ \\mathrm{cm}^{-1}$, symmetric stretch $\\tilde{\\nu}_{\\mathrm{s}} = 3657 \\ \\mathrm{cm}^{-1}$, and bend $\\tilde{\\nu}_{\\mathrm{b}} = 1595 \\ \\mathrm{cm}^{-1}$. Assume that in the unconstrained (fully flexible) case the maximal angular frequency is set by the asymmetric stretch and that, upon constraining the O–H bonds to be rigid, both stretching modes are removed so the bend sets the maximal angular frequency. Model each normal mode as independent and estimate the multiplicative gain in the maximal stable timestep $\\Delta t_{\\max}$ when going from unconstrained to O–H constrained water. Express your final answer as a single dimensionless number equal to the ratio $\\Delta t_{\\max}^{(\\mathrm{rigid\\ O\\!-\\!H})} / \\Delta t_{\\max}^{(\\mathrm{flexible})}$, and round your answer to $4$ significant figures.", "solution": "The posed problem is scientifically grounded, well-posed, and contains all necessary information for its resolution. It represents a standard analysis in computational theoretical chemistry. We shall proceed with the solution.\n\nThe problem requires a two-part analysis. First, we must derive the stability condition for the velocity Verlet algorithm applied to a simple harmonic oscillator. Second, we must apply this condition to a practical scenario in molecular dynamics involving a water molecule.\n\nLet us begin with the derivation. The system is described by the equation of motion $\\ddot{x}(t) + \\omega^{2} x(t) = 0$, where the acceleration is $a(x) = -\\omega^{2} x$. The velocity Verlet integrator is given by the update steps:\n$$v_{n+\\frac{1}{2}} = v_{n} + \\frac{\\Delta t}{2} a(x_{n})$$\n$$x_{n+1} = x_{n} + \\Delta t \\, v_{n+\\frac{1}{2}}$$\n$$v_{n+1} = v_{n+\\frac{1}{2}} + \\frac{\\Delta t}{2} a(x_{n+1})$$\n\nOur objective is to find the mapping from the state vector at time step $n$, $\\mathbf{z}_{n} = \\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}$, to the state vector at time step $n+1$, $\\mathbf{z}_{n+1} = \\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix}$. This mapping is expressed via a transfer matrix $\\mathbf{T}$ such that $\\mathbf{z}_{n+1} = \\mathbf{T} \\mathbf{z}_{n}$. The stability of the algorithm depends on the eigenvalues of $\\mathbf{T}$.\n\nWe substitute the acceleration $a(x_{n}) = -\\omega^{2} x_{n}$ into the first update equation:\n$$v_{n+\\frac{1}{2}} = v_{n} - \\frac{\\omega^{2} \\Delta t}{2} x_{n}$$\nNext, we substitute this into the position update:\n$$x_{n+1} = x_{n} + \\Delta t \\left( v_{n} - \\frac{\\omega^{2} \\Delta t}{2} x_{n} \\right) = \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right) x_{n} + (\\Delta t) v_{n}$$\nThis equation gives the first row of the transfer matrix $\\mathbf{T}$.\n\nTo find the second row, we must express $v_{n+1}$ in terms of $x_{n}$ and $v_{n}$. We use the third update rule, where $a(x_{n+1}) = -\\omega^{2} x_{n+1}$:\n$$v_{n+1} = v_{n+\\frac{1}{2}} - \\frac{\\omega^{2} \\Delta t}{2} x_{n+1}$$\nSubstitute the expressions for $v_{n+\\frac{1}{2}}$ and $x_{n+1}$:\n$$v_{n+1} = \\left(v_{n} - \\frac{\\omega^{2} \\Delta t}{2} x_{n}\\right) - \\frac{\\omega^{2} \\Delta t}{2} \\left( \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right) x_{n} + (\\Delta t) v_{n} \\right)$$\nGroup terms by $x_{n}$ and $v_{n}$:\n$$v_{n+1} = \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right) v_{n} - \\left( \\frac{\\omega^{2} \\Delta t}{2} + \\frac{\\omega^{2} \\Delta t}{2} \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right) \\right) x_{n}$$\n$$v_{n+1} = \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right) v_{n} - \\frac{\\omega^{2} \\Delta t}{2} \\left( 2 - \\frac{(\\omega \\Delta t)^{2}}{2} \\right) x_{n}$$\n$$v_{n+1} = -\\omega^{2} \\Delta t \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{4}\\right) x_{n} + \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right) v_{n}$$\nThis provides the second row of the transfer matrix.\n\nCombining these results, the transfer matrix $\\mathbf{T}$ is:\n$$\\mathbf{T} = \\begin{pmatrix} 1 - \\frac{(\\omega \\Delta t)^{2}}{2}  \\Delta t \\\\ -\\omega^{2} \\Delta t \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{4}\\right)  1 - \\frac{(\\omega \\Delta t)^{2}}{2} \\end{pmatrix}$$\nFor a discrete trajectory to remain bounded as $n \\to \\infty$, the modulus of the eigenvalues $\\lambda$ of $\\mathbf{T}$ must not exceed $1$. The eigenvalues are solutions to the characteristic equation $\\det(\\mathbf{T} - \\lambda \\mathbf{I}) = 0$. This equation is $\\lambda^{2} - \\mathrm{Tr}(\\mathbf{T})\\lambda + \\det(\\mathbf{T}) = 0$.\n\nThe determinant of the matrix is:\n$$\\det(\\mathbf{T}) = \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right)^{2} + \\omega^{2} \\Delta t^{2} \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{4}\\right) = 1 - (\\omega \\Delta t)^{2} + \\frac{(\\omega \\Delta t)^{4}}{4} + (\\omega \\Delta t)^{2} - \\frac{(\\omega \\Delta t)^{4}}{4} = 1$$\nThis result, $\\det(\\mathbf{T}) = 1$, confirms the symplectic nature of the velocity Verlet algorithm.\n\nThe trace of the matrix is:\n$$\\mathrm{Tr}(\\mathbf{T}) = \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right) + \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right) = 2 - (\\omega \\Delta t)^{2}$$\nThe characteristic equation is $\\lambda^{2} - (2 - (\\omega \\Delta t)^{2})\\lambda + 1 = 0$.\nThe solutions for $\\lambda$ are complex if the discriminant of this quadratic equation is negative, and real otherwise. The stability boundary is where the eigenvalues transition from complex (with modulus $1$) to real (with one having modulus greater than $1$). This occurs when the discriminant is zero. The general stability condition for a $2 \\times 2$ symplectic matrix is $|\\mathrm{Tr}(\\mathbf{T})| \\le 2$.\n\nApplying this condition:\n$$|2 - (\\omega \\Delta t)^{2}| \\le 2$$\nThis inequality is equivalent to $-2 \\le 2 - (\\omega \\Delta t)^{2} \\le 2$.\nThe right-hand side, $2 - (\\omega \\Delta t)^{2} \\le 2$, implies $-(\\omega \\Delta t)^{2} \\le 0$, which is always satisfied.\nThe left-hand side, $-2 \\le 2 - (\\omega \\Delta t)^{2}$, implies $(\\omega \\Delta t)^{2} \\le 4$.\nSince $\\omega$ and $\\Delta t$ are positive physical quantities, the stability condition is:\n$$\\omega \\Delta t \\le 2$$\nFrom this, the maximal stable timestep $\\Delta t_{\\max}$ for a mode with angular frequency $\\omega$ is:\n$$\\Delta t_{\\max} = \\frac{2}{\\omega}$$\n\nNow, we apply this result to the water molecule. In a molecular system, the overall maximal stable timestep is determined by the fastest vibrational mode, which has the highest angular frequency, $\\omega_{\\max}$.\n$$\\Delta t_{\\max} = \\frac{2}{\\omega_{\\max}}$$\nThe angular frequency $\\omega$ is related to the wavenumber $\\tilde{\\nu}$ (in $\\mathrm{cm}^{-1}$) by $\\omega = 2 \\pi c \\tilde{\\nu}$, where $c$ is the speed of light.\nThus, $\\Delta t_{\\max} = \\frac{2}{2 \\pi c \\tilde{\\nu}_{\\max}} = \\frac{1}{\\pi c \\tilde{\\nu}_{\\max}}$. This shows that $\\Delta t_{\\max}$ is inversely proportional to the maximal wavenumber $\\tilde{\\nu}_{\\max}$.\n\nFor the unconstrained (fully flexible) case, the highest frequency mode is the asymmetric stretch:\n$$\\tilde{\\nu}_{\\max}^{(\\mathrm{flexible})} = \\tilde{\\nu}_{\\mathrm{as}} = 3756 \\ \\mathrm{cm}^{-1}$$\nFor the O–H constrained case, the stretching modes are removed. The fastest remaining mode is the bend:\n$$\\tilde{\\nu}_{\\max}^{(\\mathrm{rigid\\ O\\!-\\!H})} = \\tilde{\\nu}_{\\mathrm{b}} = 1595 \\ \\mathrm{cm}^{-1}$$\nThe problem asks for the multiplicative gain in the maximal stable timestep, which is the ratio:\n$$\\frac{\\Delta t_{\\max}^{(\\mathrm{rigid\\ O\\!-\\!H})}}{\\Delta t_{\\max}^{(\\mathrm{flexible})}} = \\frac{1 / (\\pi c \\tilde{\\nu}_{\\max}^{(\\mathrm{rigid\\ O\\!-\\!H})})}{1 / (\\pi c \\tilde{\\nu}_{\\max}^{(\\mathrm{flexible})})} = \\frac{\\tilde{\\nu}_{\\max}^{(\\mathrm{flexible})}}{\\tilde{\\nu}_{\\max}^{(\\mathrm{rigid\\ O\\!-\\!H})}}$$\nSubstituting the given numerical values:\n$$\\frac{\\Delta t_{\\max}^{(\\mathrm{rigid\\ O\\!-\\!H})}}{\\Delta t_{\\max}^{(\\mathrm{flexible})}} = \\frac{3756}{1595} \\approx 2.3548589...$$\nRounding to $4$ significant figures, as requested, we obtain the final answer.", "answer": "$$\\boxed{2.355}$$", "id": "2780480"}]}