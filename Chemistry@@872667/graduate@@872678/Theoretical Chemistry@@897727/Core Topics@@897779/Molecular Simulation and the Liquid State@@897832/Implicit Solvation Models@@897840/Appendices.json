{"hands_on_practices": [{"introduction": "We begin with the cornerstone of continuum solvation theory: the Born model. This foundational exercise guides you through the derivation of the solvation free energy for a spherical ion, starting from the first principles of electrostatics. Successfully completing this practice [@problem_id:2778777] is essential for building a deep intuition for how a continuous dielectric medium stabilizes a charged solute.", "problem": "A single spherical cavity of radius $R$ is carved in an otherwise homogeneous, isotropic, linear dielectric continuum of relative permittivity (dielectric constant) $\\epsilon$. A point ion of charge $q$ is placed at the center of the cavity. Assume that the cavity interior is vacuum-like with relative permittivity $\\epsilon_{\\mathrm{in}} = 1$, and the exterior medium has relative permittivity $\\epsilon_{\\mathrm{out}} = \\epsilon$. Work in Gaussian electrostatic units (also called the centimeter-gram-second electrostatic system), in which Coulomb’s law reads $F = q_{1} q_{2} / r^{2}$, the displacement field satisfies $\\nabla \\cdot \\mathbf{D} = 4 \\pi \\rho_{\\mathrm{free}}$, and the energy density of a linear dielectric is $u = \\mathbf{E} \\cdot \\mathbf{D} / (8 \\pi)$.\n\nStarting only from these electrostatic laws and the standard boundary conditions at a planar interface applied locally to the spherical surface (continuity of the tangential component of the electric field and continuity of the normal component of the displacement field in the absence of free surface charge), derive the reversible work to charge the ion from $0$ to $q$ in the dielectric environment minus the corresponding reversible work in vacuum. Interpret the resulting quantity as the solvation (polarization) free energy within an implicit solvation model.\n\nYour derivation must:\n- Solve for the spherically symmetric electric field inside and outside the cavity using Gauss’s law and the boundary conditions at $r = R$.\n- Compute the total electrostatic energy for the dielectric system and for the vacuum reference by integrating the appropriate energy density over space, and form their difference in a way that yields a finite result without introducing any ad hoc cutoffs at $r = 0$.\n- Express the final solvation free energy $\\Delta G_{\\mathrm{solv}}$ as a closed-form analytic expression in terms of $q$, $\\epsilon$, and $R$ in Gaussian electrostatic units.\n\nFinally, briefly explain, based on your derivation, the physical interpretation of the parameter $R$ that appears in your expression within the context of implicit solvation models.\n\nReport your final answer as a single closed-form analytic expression for $\\Delta G_{\\mathrm{solv}}$. Do not include any units in the final answer box.", "solution": "The system is radially symmetric, with a point charge $q$ at the origin, an inner region $0  r  R$ of relative permittivity $\\epsilon_{\\mathrm{in}} = 1$, and an outer region $r  R$ of relative permittivity $\\epsilon_{\\mathrm{out}} = \\epsilon$. In Gaussian electrostatic units (centimeter-gram-second electrostatic), the governing relations are $\\nabla \\cdot \\mathbf{D} = 4 \\pi \\rho_{\\mathrm{free}}$, with $\\mathbf{D} = \\epsilon \\mathbf{E}$ in a linear, isotropic dielectric of relative permittivity $\\epsilon$, and the energy density $u = \\mathbf{E} \\cdot \\mathbf{D} / (8 \\pi)$. The boundary conditions at $r = R$ (in the absence of free surface charge) are continuity of the tangential component of $\\mathbf{E}$ and continuity of the normal component of $\\mathbf{D}$, which, for a spherically symmetric field, reduce to continuity of the scalar potential and the condition $\\epsilon_{\\mathrm{in}} E_{\\mathrm{in}}^{\\perp} = \\epsilon_{\\mathrm{out}} E_{\\mathrm{out}}^{\\perp}$ at $r = R$.\n\nFirst, determine the electric field in each region. By symmetry, the field is purely radial, $\\mathbf{E}(r) = E(r) \\,\\hat{\\mathbf{r}}$, and Gauss’s law applied to a sphere of radius $r$ centered at the origin gives\n$$\n\\oint_{S_{r}} \\mathbf{D} \\cdot d\\mathbf{A} \\;=\\; 4 \\pi q \\quad \\Longrightarrow \\quad D(r) \\, 4 \\pi r^{2} \\;=\\; 4 \\pi q \\quad \\Longrightarrow \\quad D(r) \\;=\\; \\frac{q}{r^{2}} \\, .\n$$\nInside the cavity, $\\epsilon_{\\mathrm{in}}=1$, so $D_{\\mathrm{in}}(r) = E_{\\mathrm{in}}(r)$, and therefore\n$$\nE_{\\mathrm{in}}(r) \\;=\\; \\frac{q}{r^{2}} \\quad \\text{for } 0 r  R \\, .\n$$\nOutside the cavity, $D_{\\mathrm{out}}(r) = \\epsilon E_{\\mathrm{out}}(r)$, and thus\n$$\nE_{\\mathrm{out}}(r) \\;=\\; \\frac{D_{\\mathrm{out}}(r)}{\\epsilon} \\;=\\; \\frac{1}{\\epsilon} \\,\\frac{q}{r^{2}} \\quad \\text{for } r  R \\, .\n$$\nThese fields satisfy the boundary condition on the normal component of $\\mathbf{D}$ at $r=R$ automatically, because $D(r)$ is continuous and equal to $q/r^{2}$ everywhere except at the location of the point charge.\n\nNext, compute the electrostatic energy by integrating the energy density. For a linear dielectric, the energy density is $u = \\mathbf{E} \\cdot \\mathbf{D} / (8 \\pi)$. Thus, for the dielectric system,\n$$\nU(\\epsilon) \\;=\\; \\int_{0}^{\\infty} \\frac{\\mathbf{E} \\cdot \\mathbf{D}}{8 \\pi} \\, dV \\;=\\; \\int_{0}^{R} \\frac{E_{\\mathrm{in}}^{2}}{8 \\pi} \\, dV \\;+\\; \\int_{R}^{\\infty} \\frac{\\epsilon E_{\\mathrm{out}}^{2}}{8 \\pi} \\, dV \\, .\n$$\nFor the vacuum reference (no dielectric anywhere), the field is $E_{0}(r) = q/r^{2}$ for all $r0$, and the energy is\n$$\nU(1) \\;=\\; \\int_{0}^{\\infty} \\frac{E_{0}^{2}}{8 \\pi} \\, dV \\;=\\; \\int_{0}^{\\infty} \\frac{1}{8 \\pi} \\left( \\frac{q}{r^{2}} \\right)^{2} dV \\, .\n$$\nBoth $U(\\epsilon)$ and $U(1)$ diverge at $r \\to 0$ because the point-charge self-energy is not finite; however, the solvation free energy $\\Delta G_{\\mathrm{solv}}$ is the reversible work difference between charging in the dielectric and charging in vacuum, namely\n$$\n\\Delta G_{\\mathrm{solv}} \\;=\\; U(\\epsilon) \\;-\\; U(1) \\, .\n$$\nThis difference is finite because the fields inside the cavity $0rR$ are identical in the dielectric system and in the vacuum reference, and hence their energy contributions over $0rR$ cancel exactly. Therefore, the difference arises solely from the region $rR$:\n$$\n\\Delta G_{\\mathrm{solv}} \\;=\\; \\int_{R}^{\\infty} \\left[ \\frac{\\epsilon E_{\\mathrm{out}}^{2}}{8 \\pi} \\;-\\; \\frac{E_{0}^{2}}{8 \\pi} \\right] dV \\, .\n$$\nInsert $E_{\\mathrm{out}}(r) = q/(\\epsilon r^{2})$ and $E_{0}(r) = q/r^{2}$, and use $dV = 4 \\pi r^{2} dr$:\n$$\n\\Delta G_{\\mathrm{solv}} \\;=\\; \\int_{R}^{\\infty} \\left[ \\frac{\\epsilon}{8 \\pi} \\left( \\frac{q}{\\epsilon r^{2}} \\right)^{2} \\;-\\; \\frac{1}{8 \\pi} \\left( \\frac{q}{r^{2}} \\right)^{2} \\right] 4 \\pi r^{2} \\, dr \\, .\n$$\nSimplify the integrand term by term. For the dielectric term,\n$$\n\\frac{\\epsilon}{8 \\pi} \\left( \\frac{q}{\\epsilon r^{2}} \\right)^{2} 4 \\pi r^{2}\n\\;=\\;\n\\frac{\\epsilon}{8 \\pi} \\cdot \\frac{q^{2}}{\\epsilon^{2} r^{4}} \\cdot 4 \\pi r^{2}\n\\;=\\;\n\\frac{q^{2}}{2 \\epsilon} \\cdot \\frac{1}{r^{2}} \\, .\n$$\nFor the vacuum term,\n$$\n\\frac{1}{8 \\pi} \\left( \\frac{q}{r^{2}} \\right)^{2} 4 \\pi r^{2}\n\\;=\\;\n\\frac{q^{2}}{2} \\cdot \\frac{1}{r^{2}} \\, .\n$$\nHence,\n$$\n\\Delta G_{\\mathrm{solv}} \\;=\\; \\int_{R}^{\\infty} \\left( \\frac{q^{2}}{2 \\epsilon} \\cdot \\frac{1}{r^{2}} \\;-\\; \\frac{q^{2}}{2} \\cdot \\frac{1}{r^{2}} \\right) dr\n\\;=\\;\n\\frac{q^{2}}{2} \\left( \\frac{1}{\\epsilon} - 1 \\right) \\int_{R}^{\\infty} \\frac{dr}{r^{2}} \\, .\n$$\nEvaluate the integral,\n$$\n\\int_{R}^{\\infty} \\frac{dr}{r^{2}} \\;=\\; \\left[ - \\frac{1}{r} \\right]_{R}^{\\infty} \\;=\\; \\frac{1}{R} \\, ,\n$$\nwhich yields\n$$\n\\Delta G_{\\mathrm{solv}} \\;=\\; \\frac{q^{2}}{2} \\left( \\frac{1}{\\epsilon} - 1 \\right) \\frac{1}{R}\n\\;=\\;\n- \\frac{1}{2} \\left( 1 - \\epsilon^{-1} \\right) \\frac{q^{2}}{R} \\, .\n$$\nThis is the Born solvation free energy in Gaussian electrostatic units. It is negative for $\\epsilon  1$, indicating that the dielectric medium stabilizes the charged state relative to vacuum.\n\nPhysical interpretation of $R$: In the continuum picture, the microscopic ion and its immediate molecular environment are represented by an inner region where the dielectric response is absent ($\\epsilon_{\\mathrm{in}} = 1$), and the bulk solvent is represented by a homogeneous dielectric with permittivity $\\epsilon$ beginning at $r=R$. The parameter $R$ is therefore an effective cavity radius, often called the Born radius, which delineates where the continuum dielectric begins to act. It encodes the solute’s size and shape as perceived by the long-wavelength polarization of the solvent, and in practice it may differ from a simple van der Waals radius because it implicitly accounts for short-range structural and electronic effects of the first solvation shell that are not explicitly modeled by the continuum.", "answer": "$$\\boxed{-\\frac{1}{2}\\left(1-\\epsilon^{-1}\\right)\\frac{q^{2}}{R}}$$", "id": "2778777"}, {"introduction": "A complete solvation model must account for more than just electrostatics; the energy required to form a cavity for the solute within the solvent is also significant. This practice [@problem_id:2778704] focuses on these non-electrostatic contributions, showing how they can be estimated from the solute's geometry using fundamental thermodynamic principles. This exercise highlights the importance of cavity surface area and volume in determining solubility.", "problem": "In continuum implicit solvation models of the Polarizable Continuum Model (PCM) type, the nonelectrostatic part of the solvation free energy is often modeled in terms of the geometry of the solute cavity carved out of the solvent. Consider a solute cavity formed by the union of impenetrable spheres embedded in a liquid at constant temperature. Assume the liquid has a constant macroscopic surface tension and is subject to a uniform external pressure.\n\nStarting only from the fundamental definitions of reversible mechanical work and reversible interfacial work, and treating the surface tension and pressure as constants with respect to the creation of the cavity, derive the leading-order dependence of the nonelectrostatic solvation free energy on the cavity geometry. Your derivation must identify the geometric quantities on which this free energy depends and the corresponding physical coefficients, without invoking any pre-specified target formula.\n\nThen apply your result to a fused-sphere cavity composed of two identical spheres of radius $R$ whose centers are separated by a distance $d$ with $0d2R$. Using geometric reasoning and well-tested formulas for spherical caps, express the total surface area $S(R,d)$ and total volume $V(R,d)$ of the fused-sphere cavity in closed form, and hence evaluate the nonelectrostatic solvation free energy for the following parameters:\n- Sphere radius $R = 2.0\\,\\text{\\AA}$,\n- Center separation $d = 3.0\\,\\text{\\AA}$,\n- Empirical surface-work coefficient $\\gamma_{\\mathrm{ne}} = 0.0220\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-2}$,\n- Empirical pressure-work coefficient $p_{\\mathrm{ne}} = 6.022\\times 10^{-5}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-3}$.\n\nExpress the final energy in $\\text{kJ}\\,\\text{mol}^{-1}$ and round your answer to four significant figures.", "solution": "The nonelectrostatic component of the solvation free energy, $\\Delta G_{\\mathrm{ne}}$, in an implicit solvent model corresponds to the reversible work required to create a solute-shaped cavity within the solvent continuum at constant temperature and pressure. This work is performed against two primary opposing forces: the solvent's surface tension and the external pressure.\n\nFirst, consider the reversible interfacial work, $W_{\\mathrm{surface}}$, required to create the cavity's surface area, $S$. The creation of a new interface between the solute cavity and the solvent continuum must overcome the cohesive forces of the solvent, which are macroscopically manifested as surface tension. For a constant surface tension, $\\gamma$, the work done is directly proportional to the area created. Thus, the contribution to the free energy is:\n$$W_{\\mathrm{surface}} = \\gamma S$$\n\nSecond, consider the reversible mechanical work, $W_{\\mathrm{volume}}$, done against the uniform external pressure, $p$, to displace a volume $V$ of the solvent. This is the standard pressure-volume work term. For a constant pressure, this work is:\n$$W_{\\mathrm{volume}} = pV$$\n\nAt constant temperature and pressure, the Gibbs free energy change is equal to the non-expansion reversible work done on the system. The creation of the cavity is such a process. Therefore, the total nonelectrostatic free energy is the sum of these two work components. The coefficients $\\gamma$ and $p$ are treated as effective empirical parameters in this context, which we will denote as $\\gamma_{\\mathrm{ne}}$ and $p_{\\mathrm{ne}}$ respectively, to reflect their role in modeling the nonelectrostatic interactions.\n\nThe resulting expression for the nonelectrostatic solvation free energy is:\n$$\\Delta G_{\\mathrm{ne}} = \\gamma_{\\mathrm{ne}} S + p_{\\mathrm{ne}} V$$\nThis equation establishes the leading-order dependence of the nonelectrostatic free energy on the cavity's geometric properties: its surface area $S$ and its volume $V$. The corresponding physical coefficients are the empirical surface-work coefficient $\\gamma_{\\mathrm{ne}}$ and the empirical pressure-work coefficient $p_{\\mathrm{ne}}$.\n\nNext, we apply this result to the specific geometry of a fused-sphere cavity formed by two identical spheres of radius $R$ with their centers separated by a distance $d$, where $0  d  2R$.\n\nThe total surface area, $S(R,d)$, of the fused-sphere cavity is the sum of the areas of the two exposed spherical caps. For one sphere, the plane of intersection is a distance $d/2$ from its center. The height of the smaller spherical cap that is removed (inside the other sphere) is $h_{\\mathrm{removed}} = R - d/2$. The surface area of this removed cap is $2\\pi R h_{\\mathrm{removed}}$. The exposed area of one sphere is its total area minus the area of the removed cap: $4\\pi R^2 - 2\\pi R(R - d/2) = 2\\pi R^2 + \\pi R d$. Since there are two such identical exposed caps, the total surface area is:\n$$S(R,d) = 2 \\times (2\\pi R^2 + \\pi R d) = 2\\pi R(2R+d)$$\n\nThe total volume, $V(R,d)$, is the sum of the volumes of the two spheres minus the volume of their intersection. The intersection is a lens formed by two identical spherical caps, each of height $h = R - d/2$. The volume of a single spherical cap is given by $V_{\\mathrm{cap}} = \\frac{1}{3}\\pi h^2 (3R - h)$. The total volume of the union is the volume of two full spheres minus the volume of the lens (which is counted twice in the sum). A more direct method is to sum the volumes of the two major spherical segments that constitute the fused body. The volume of one such segment is the volume of a sphere minus the volume of the small cap that is cut off:\n$$V_{\\mathrm{segment}} = \\frac{4}{3}\\pi R^3 - V_{\\mathrm{cap}} = \\frac{4}{3}\\pi R^3 - \\frac{1}{3}\\pi (R-d/2)^2 (3R - (R-d/2))$$\n$$V_{\\mathrm{segment}} = \\frac{4}{3}\\pi R^3 - \\frac{1}{3}\\pi (R-d/2)^2 (2R+d/2)$$\nExpanding this gives:\n$$V_{\\mathrm{segment}} = \\frac{\\pi}{3} \\left( 4R^3 - \\left( R^2 - Rd + \\frac{d^2}{4} \\right) \\left( 2R + \\frac{d}{2} \\right) \\right) = \\frac{\\pi}{3} \\left( 2R^3 + \\frac{3}{2}R^2d - \\frac{d^3}{8} \\right)$$\nThe total volume is twice the volume of one segment:\n$$V(R,d) = 2 V_{\\mathrm{segment}} = \\frac{2\\pi}{3} \\left( 2R^3 + \\frac{3}{2}R^2d - \\frac{d^3}{8} \\right) = \\pi \\left( \\frac{4}{3}R^3 + R^2d - \\frac{d^3}{12} \\right)$$\n\nNow, we substitute the given numerical parameters:\n$R = 2.0\\,\\text{\\AA}$\n$d = 3.0\\,\\text{\\AA}$\n$\\gamma_{\\mathrm{ne}} = 0.0220\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-2}$\n$p_{\\mathrm{ne}} = 6.022\\times 10^{-5}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-3}$\n\nFirst, we calculate the surface area $S$ and volume $V$:\n$$S = 2\\pi R(2R+d) = 2\\pi(2.0)(2 \\times 2.0 + 3.0) = 4\\pi(4.0 + 3.0) = 28\\pi\\,\\text{\\AA}^2$$\n$$V = \\pi \\left( \\frac{4}{3}R^3 + R^2d - \\frac{d^3}{12} \\right) = \\pi \\left( \\frac{4}{3}(2.0)^3 + (2.0)^2(3.0) - \\frac{(3.0)^3}{12} \\right)$$\n$$V = \\pi \\left( \\frac{4}{3}(8.0) + (4.0)(3.0) - \\frac{27.0}{12} \\right) = \\pi \\left( \\frac{32.0}{3} + 12.0 - \\frac{9.0}{4} \\right)$$\nUsing a common denominator of $12$:\n$$V = \\pi \\left( \\frac{32.0 \\times 4}{12} + \\frac{12.0 \\times 12}{12} - \\frac{9.0 \\times 3}{12} \\right) = \\pi \\left( \\frac{128.0 + 144.0 - 27.0}{12} \\right) = \\frac{245\\pi}{12}\\,\\text{\\AA}^3$$\n\nFinally, we calculate the nonelectrostatic solvation free energy:\n$$\\Delta G_{\\mathrm{ne}} = \\gamma_{\\mathrm{ne}} S + p_{\\mathrm{ne}} V$$\n$$\\Delta G_{\\mathrm{ne}} = (0.0220) \\times (28\\pi) + (6.022\\times 10^{-5}) \\times \\left(\\frac{245\\pi}{12}\\right)$$\n$$\\Delta G_{\\mathrm{ne}} = 0.616\\pi + \\frac{1475.39\\pi}{12} \\times 10^{-5}$$\n$$\\Delta G_{\\mathrm{ne}} = \\pi \\left( 0.616 + 122.94916... \\times 10^{-5} \\right)$$\n$$\\Delta G_{\\mathrm{ne}} = \\pi \\left( 0.616 + 0.0012294916... \\right)$$\n$$\\Delta G_{\\mathrm{ne}} = \\pi \\left( 0.6172294916... \\right)$$\n$$\\Delta G_{\\mathrm{ne}} \\approx 1.93906\\,\\text{kJ}\\,\\text{mol}^{-1}$$\n\nRounding to four significant figures, the final result is $1.939\\,\\text{kJ}\\,\\text{mol}^{-1}$.", "answer": "$$\n\\boxed{1.939}\n$$", "id": "2778704"}, {"introduction": "Theoretical models gain their power when they can make accurate, quantitative predictions. This final hands-on practice [@problem_id:2778738] bridges the gap between abstract theory and practical application by demonstrating how to parameterize an implicit solvation model. Using a Bayesian statistical framework, you will fit model parameters to data and learn to generate predictive intervals, a key skill in modern computational chemistry.", "problem": "You are given a simplified forward model derived from the Polarizable Continuum Model (PCM) under the linear response approximation. The electrostatic contribution to the solvation free energy is taken to scale with the dielectric response factor $f(\\varepsilon)$, where $\\varepsilon$ is the solvent static dielectric constant and $f(\\varepsilon)$ is defined for a spherical cavity surrogate as $f(\\varepsilon) = \\dfrac{\\varepsilon - 1}{\\varepsilon + 2}$. The non-electrostatic contribution is taken as proportional to the solute cavity surface area $S$. The total solvation free energy $\\Delta G$ (in $\\mathrm{kJ/mol}$) is modeled as a linear function of $f(\\varepsilon)$ and $S$ with an intercept:\n$$\ny_i \\equiv \\Delta G_i = \\theta_0 + \\theta_1 f(\\varepsilon_i) + \\theta_2 S_i + \\varepsilon_i^{(\\text{noise})},\n$$\nwhere $\\varepsilon_i^{(\\text{noise})} \\sim \\mathcal{N}(0,\\sigma^2)$ are independent and identically distributed Gaussian errors with known variance $\\sigma^2$, and $\\boldsymbol{\\theta} = (\\theta_0,\\theta_1,\\theta_2)^\\top$ are unknown parameters.\n\nAdopt a Gaussian prior for $\\boldsymbol{\\theta}$,\n$$\n\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0,\\boldsymbol{\\Sigma}_0),\n$$\nwith $\\boldsymbol{\\mu}_0 = (0,0,0)^\\top$ and $\\boldsymbol{\\Sigma}_0 = \\mathrm{diag}(\\tau^2,\\tau^2,\\tau^2)$, where $\\tau^2 = 1000$.\n\nThe training data consist of $N=8$ independent measurements $(\\varepsilon_i, S_i, y_i)$ with $\\sigma = 1.5$ (in $\\mathrm{kJ/mol}$), where $S_i$ is in $\\text{\\AA}^2$, and $y_i$ is in $\\mathrm{kJ/mol}$. The data are:\n- $i=1$: $\\varepsilon_1 = 78.4$, $S_1 = 120$, $y_1 = -24.0806$,\n- $i=2$: $\\varepsilon_2 = 78.4$, $S_2 = 150$, $y_2 = -24.5806$,\n- $i=3$: $\\varepsilon_3 = 78.4$, $S_3 = 180$, $y_3 = -21.3806$,\n- $i=4$: $\\varepsilon_4 = 78.4$, $S_4 = 210$, $y_4 = -20.7806$,\n- $i=5$: $\\varepsilon_5 = 2.38$, $S_5 = 120$, $y_5 = -4.3521$,\n- $i=6$: $\\varepsilon_6 = 2.38$, $S_6 = 150$, $y_6 = -4.9521$,\n- $i=7$: $\\varepsilon_7 = 2.38$, $S_7 = 180$, $y_7 = -2.2521$,\n- $i=8$: $\\varepsilon_8 = 2.38$, $S_8 = 210$, $y_8 = -1.6521$.\n\nTasks:\n1. Starting from Bayes’ rule and the definitions above, derive the posterior distribution $p(\\boldsymbol{\\theta}\\mid \\mathbf{y}, \\mathbf{X}, \\sigma^2)$ for the linear-Gaussian model with Gaussian prior, where $\\mathbf{X}$ is the design matrix with rows $\\mathbf{x}_i^\\top = (1, f(\\varepsilon_i), S_i)$ and $\\mathbf{y} = (y_1,\\dots,y_8)^\\top$.\n2. Implement a program that computes the posterior mean vector $\\boldsymbol{\\mu}_N$ and posterior covariance matrix $\\boldsymbol{\\Sigma}_N$ of $\\boldsymbol{\\theta}$.\n3. For each of the following three predictive cases, compute the Bayesian predictive $95\\%$ interval for a new solvation free energy $y_\\star$ using the posterior predictive distribution implied by the model:\n   - Case A: $\\varepsilon_\\star = 10.0$, $S_\\star = 160$,\n   - Case B: $\\varepsilon_\\star = 78.4$, $S_\\star = 140$,\n   - Case C: $\\varepsilon_\\star = 2.0$, $S_\\star = 220$.\n   For each case, construct $\\mathbf{x}_\\star^\\top = (1, f(\\varepsilon_\\star), S_\\star)$ and use the predictive distribution to obtain the lower and upper endpoints of the interval. Express each interval endpoint in $\\mathrm{kJ/mol}$, rounded to three decimal places.\n\nSpecifications and constraints:\n- All energies must be expressed in $\\mathrm{kJ/mol}$ and all surface areas in $\\text{\\AA}^2$. Angles are not used. Report all final numerical outputs as dimensionless numbers corresponding to the specified units.\n- Your program must implement the Bayesian inference and predictive interval computation without requiring user input.\n- Test suite to cover different facets:\n  - Typical moderate dielectric and moderate surface area: Case A with $\\varepsilon_\\star = 10.0$, $S_\\star = 160$.\n  - High dielectric, smaller surface area: Case B with $\\varepsilon_\\star = 78.4$, $S_\\star = 140$.\n  - Low dielectric, large surface area: Case C with $\\varepsilon_\\star = 2.0$, $S_\\star = 220$.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n$$\n[\\ell_A, u_A, \\ell_B, u_B, \\ell_C, u_C],\n$$\nwhere $\\ell$ and $u$ denote the predictive interval lower and upper endpoints, respectively, each rounded to three decimal places, with no additional whitespace or text.", "solution": "According to Bayes' rule, the posterior distribution is proportional to the product of the likelihood and the prior:\n$$\np(\\boldsymbol{\\theta} \\mid \\mathbf{y}, \\mathbf{X}, \\sigma^2) \\propto p(\\mathbf{y} \\mid \\mathbf{X}, \\boldsymbol{\\theta}, \\sigma^2) p(\\boldsymbol{\\theta})\n$$\nThe likelihood for the linear model $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}^{(\\text{noise})}$ with i.i.d. Gaussian noise $\\varepsilon_i^{(\\text{noise})} \\sim \\mathcal{N}(0, \\sigma^2)$ is a multivariate Gaussian distribution:\n$$\np(\\mathbf{y} \\mid \\mathbf{X}, \\boldsymbol{\\theta}, \\sigma^2) = \\mathcal{N}(\\mathbf{y} \\mid \\mathbf{X}\\boldsymbol{\\theta}, \\sigma^2\\mathbf{I}) \\propto \\exp\\left(-\\frac{1}{2\\sigma^2}(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})^\\top(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})\\right)\n$$\nThe prior distribution for $\\boldsymbol{\\theta}$ is also Gaussian:\n$$\np(\\boldsymbol{\\theta}) = \\mathcal{N}(\\boldsymbol{\\theta} \\mid \\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0) \\propto \\exp\\left(-\\frac{1}{2}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)^\\top\\boldsymbol{\\Sigma}_0^{-1}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)\\right)\n$$\nThe log-posterior is proportional to the sum of the log-likelihood and log-prior. By completing the square on the terms involving $\\boldsymbol{\\theta}$, one finds that the posterior is also Gaussian, $p(\\boldsymbol{\\theta} \\mid \\mathbf{y}, \\mathbf{X}, \\sigma^2) = \\mathcal{N}(\\boldsymbol{\\theta} \\mid \\boldsymbol{\\mu}_N, \\boldsymbol{\\Sigma}_N)$, with inverse covariance and mean given by:\n$$\n\\boldsymbol{\\Sigma}_N^{-1} = \\boldsymbol{\\Sigma}_0^{-1} + \\frac{1}{\\sigma^2}\\mathbf{X}^\\top\\mathbf{X} \\quad \\implies \\quad \\boldsymbol{\\Sigma}_N = \\left(\\boldsymbol{\\Sigma}_0^{-1} + \\frac{1}{\\sigma^2}\\mathbf{X}^\\top\\mathbf{X}\\right)^{-1}\n$$\n$$\n\\boldsymbol{\\mu}_N = \\boldsymbol{\\Sigma}_N \\left(\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 + \\frac{1}{\\sigma^2}\\mathbf{X}^\\top\\mathbf{y}\\right)\n$$\nThis completes the derivation for the posterior distribution, as required by Task 1.\n\nFor a new data point $\\mathbf{x}_{\\star}$, the predictive distribution of the corresponding observation $y_{\\star}$ is found by marginalizing over the posterior of $\\boldsymbol{\\theta}$:\n$$\np(y_{\\star} \\mid \\mathbf{x}_{\\star}, \\mathbf{y}, \\mathbf{X}, \\sigma^2) = \\int p(y_{\\star} \\mid \\mathbf{x}_{\\star}, \\boldsymbol{\\theta}, \\sigma^2) p(\\boldsymbol{\\theta} \\mid \\mathbf{y}, \\mathbf{X}, \\sigma^2) d\\boldsymbol{\\theta}\n$$\nwhere $p(y_{\\star} \\mid \\mathbf{x}_{\\star}, \\boldsymbol{\\theta}, \\sigma^2) = \\mathcal{N}(y_{\\star} \\mid \\mathbf{x}_{\\star}^\\top\\boldsymbol{\\theta}, \\sigma^2)$. The result of this integral is a Gaussian distribution, known as the posterior predictive distribution, $y_{\\star} \\sim \\mathcal{N}(\\mu_{\\text{pred}}, \\sigma^2_{\\text{pred}})$, with mean and variance:\n$$\n\\mu_{\\text{pred}} = \\mathbf{x}_{\\star}^\\top\\boldsymbol{\\mu}_N\n$$\n$$\n\\sigma^2_{\\text{pred}} = \\sigma^2 + \\mathbf{x}_{\\star}^\\top\\boldsymbol{\\Sigma}_N\\mathbf{x}_{\\star}\n$$\nThe predictive variance has two components: the inherent noise $\\sigma^2$ in a new measurement, and the uncertainty in the model parameters propagated to the prediction, $\\mathbf{x}_{\\star}^\\top\\boldsymbol{\\Sigma}_N\\mathbf{x}_{\\star}$. A $95\\%$ predictive interval is then given by $\\mu_{\\text{pred}} \\pm z \\cdot \\sigma_{\\text{pred}}$, where $z$ is the $97.5$-th percentile of the standard normal distribution ($z \\approx 1.96$).", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    # --- Step 1: Define constants and data from the problem statement ---\n\n    # Model parameters\n    sigma = 1.5\n    sigma_sq = sigma**2\n    tau_sq = 1000.0\n\n    # Prior distribution parameters for theta = [theta_0, theta_1, theta_2]^T\n    mu_0 = np.zeros(3)\n    # Sigma_0 is diagonal, so its inverse is also diagonal\n    Sigma0_inv = np.diag([1.0/tau_sq, 1.0/tau_sq, 1.0/tau_sq])\n\n    # Training data (N=8)\n    training_data = [\n        (78.4, 120, -24.0806),\n        (78.4, 150, -24.5806),\n        (78.4, 180, -21.3806),\n        (78.4, 210, -20.7806),\n        (2.38, 120, -4.3521 ),\n        (2.38, 150, -4.9521 ),\n        (2.38, 180, -2.2521 ),\n        (2.38, 210, -1.6521 ),\n    ]\n\n    # Predictive test cases\n    test_cases = [\n        (10.0, 160), # Case A\n        (78.4, 140), # Case B\n        (2.0,  220), # Case C\n    ]\n\n    # --- Step 2: Prepare the design matrix X and response vector y ---\n    \n    # Dielectric response factor function\n    def f_eps(eps):\n        return (eps - 1.0) / (eps + 2.0)\n\n    N = len(training_data)\n    y = np.array([d[2] for d in training_data])\n    \n    # Design matrix X has rows [1, f(eps_i), S_i]\n    X = np.zeros((N, 3))\n    for i, (eps_i, S_i, _) in enumerate(training_data):\n        X[i, 0] = 1.0\n        X[i, 1] = f_eps(eps_i)\n        X[i, 2] = S_i\n\n    # --- Step 3: Compute the posterior distribution parameters ---\n    \n    # Posterior covariance: Sigma_N = (Sigma_0^-1 + (1/sigma^2) * X^T * X)^-1\n    # Matrix multiplications use the @ operator\n    XTX = X.T @ X\n    SigmaN_inv = Sigma0_inv + (1.0/sigma_sq) * XTX\n    Sigma_N = np.linalg.inv(SigmaN_inv)\n\n    # Posterior mean: mu_N = Sigma_N * (Sigma_0^-1 * mu_0 + (1/sigma^2) * X^T * y)\n    # Since mu_0 is the zero vector, this simplifies\n    XTy = X.T @ y\n    mu_N = Sigma_N @ ((1.0/sigma_sq) * XTy)\n\n    # --- Step 4: Compute the predictive intervals for test cases ---\n\n    # Z-score for a 95% confidence/predictive interval\n    z_score = norm.ppf(0.975)\n\n    results = []\n    for eps_star, S_star in test_cases:\n        # Construct the feature vector for the new data point\n        x_star = np.array([1.0, f_eps(eps_star), S_star])\n\n        # Predictive mean\n        mu_pred = x_star.T @ mu_N\n\n        # Predictive variance: noise variance + parameter uncertainty variance\n        pred_var = sigma_sq + x_star.T @ Sigma_N @ x_star\n        pred_std = np.sqrt(pred_var)\n\n        # Calculate lower and upper bounds of the 95% predictive interval\n        lower_bound = mu_pred - z_score * pred_std\n        upper_bound = mu_pred + z_score * pred_std\n        \n        results.extend([lower_bound, upper_bound])\n\n    # --- Step 5: Format and print the final output ---\n    \n    # The output must be a single line, with each number rounded to three decimal places.\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2778738"}]}