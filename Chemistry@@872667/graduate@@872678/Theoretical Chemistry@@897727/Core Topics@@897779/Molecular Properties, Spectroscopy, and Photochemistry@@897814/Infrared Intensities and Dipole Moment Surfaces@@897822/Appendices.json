{"hands_on_practices": [{"introduction": "The cornerstone of understanding infrared intensities is the ability to derive them from fundamental quantum mechanical models. This first practice invites you to build the theory from the ground up, starting with the simplest yet most insightful model: a diatomic molecule treated as a quantum harmonic oscillator with a linearly changing dipole moment. By working through this derivation, you will solidify your understanding of how vibrational selection rules emerge and how the intensity of a fundamental transition depends on the intrinsic mechanical and electrical properties of the molecule, such as its force constant, reduced mass, and dipole moment derivative. [@problem_id:2779261]", "problem": "A linear diatomic molecule undergoes small-amplitude vibrations along its bond axis. Let the vibrational coordinate be the scalar displacement from equilibrium, denoted by $Q$, and let the reduced mass be $\\mu$. The vibrational Hamiltonian is taken to be the harmonic oscillator with potential $V(Q)=\\tfrac{1}{2} k Q^{2}$, where $k$ is the force constant. The dipole moment surface (DMS) along $Q$ is linear, $\\mu(Q)=\\mu_{0}+a\\,Q$, where $\\mu_{0}$ is a constant and $a$ is the slope of the DMS. Consider the fundamental vibrational transition from $v=0$ to $v=1$.\n\nStarting from the definitions of the harmonic oscillator and the definition of the vibrational line strength as the squared transition dipole moment,\n$$\nS_{01}=\\left|\\langle 0|\\mu(Q)|1\\rangle\\right|^{2},\n$$\nderive a closed-form expression for $S_{01}$ in terms of $a$, $\\mu$, $k$, and $\\hbar$ only. Treat the molecule as strictly linear and neglect rotational structure and any anharmonicity beyond the given potential. Take the vibrational frequency to be that implied by the harmonic Hamiltonian and the reduced mass.\n\nExpress your final answer as a single analytical expression. Report $S_{01}$ in International System of Units (SI) as a quantity with units of squared dipole moment $\\text{(C m)}^{2}$, but do not include the units in your final boxed expression. Finally, based on your expression, state the power-law dependence of $S_{01}$ on the reduced mass $\\mu$ when $a$ and $k$ are held fixed. The final boxed answer must be the analytical expression for $S_{01}$ only.", "solution": "The problem statement is first subjected to validation.\n\nGivens extracted verbatim are:\n-   System: A linear diatomic molecule.\n-   Motion: Small-amplitude vibrations along its bond axis.\n-   Coordinate: Vibrational coordinate is the scalar displacement from equilibrium, $Q$.\n-   Mass: Reduced mass is $\\mu$.\n-   Hamiltonian: Vibrational Hamiltonian is the harmonic oscillator with potential $V(Q)=\\tfrac{1}{2} k Q^{2}$.\n-   Force constant: $k$.\n-   Dipole Moment Surface (DMS): $\\mu(Q)=\\mu_{0}+a\\,Q$, where $\\mu_{0}$ is a constant and $a$ is the slope.\n-   Transition: Fundamental vibrational transition from $v=0$ to $v=1$.\n-   Line Strength Definition: $S_{01}=\\left|\\langle 0|\\mu(Q)|1\\rangle\\right|^{2}$.\n-   Objective: Derive a closed-form expression for $S_{01}$ in terms of $a$, $\\mu$, $k$, and $\\hbar$.\n-   Constraints: Treat as strictly linear, neglect rotational structure and anharmonicity. The vibrational frequency is that implied by the harmonic Hamiltonian.\n\nValidation Verdict:\nThe problem is scientifically grounded, well-posed, and objective. It is a standard problem in quantum mechanics and molecular spectroscopy, based on the harmonic oscillator and linear dipole moment approximations. All necessary information is provided, and the problem is internally consistent and formalizable. No flaws are identified. The problem is valid.\n\nWe now proceed to the derivation of the line strength, $S_{01}$.\n\nThe line strength for the fundamental vibrational transition from the ground state $|0\\rangle$ to the first excited state $|1\\rangle$ is defined as the squared magnitude of the transition dipole moment:\n$$\nS_{01} = \\left|\\langle 0|\\mu(Q)|1\\rangle\\right|^{2}\n$$\nThe dipole moment operator, $\\mu(Q)$, is given as a linear function of the vibrational coordinate $Q$:\n$$\n\\mu(Q) = \\mu_{0} + a\\,Q\n$$\nSubstituting this expression into the matrix element gives:\n$$\n\\langle 0|\\mu(Q)|1\\rangle = \\langle 0|\\mu_{0} + a\\,Q|1\\rangle = \\mu_{0}\\langle 0|1\\rangle + a\\langle 0|Q|1\\rangle\n$$\nThe vibrational states $|v\\rangle$ are the eigenstates of the harmonic oscillator Hamiltonian. These states are orthogonal, meaning their inner product is $\\langle v|v'\\rangle = \\delta_{vv'}$, where $\\delta_{vv'}$ is the Kronecker delta. For the transition from $v=0$ to $v=1$, the orthogonality condition implies $\\langle 0|1\\rangle = 0$. Consequently, the first term vanishes:\n$$\n\\mu_{0}\\langle 0|1\\rangle = 0\n$$\nThis is the well-known selection rule that for a harmonic oscillator, a permanent dipole moment $\\mu_0$ does not contribute to vibrational transitions; only the change in dipole moment with displacement, represented by the slope $a$, can induce a transition.\n\nThe line strength expression simplifies to:\n$$\nS_{01} = |a\\langle 0|Q|1\\rangle|^{2} = a^{2}|\\langle 0|Q|1\\rangle|^{2}\n$$\nTo evaluate the matrix element $\\langle 0|Q|1\\rangle$, we express the position operator $Q$ in terms of the annihilation ($a$) and creation ($a^{\\dagger}$) ladder operators for the quantum harmonic oscillator. The relation is:\n$$\nQ = \\sqrt{\\frac{\\hbar}{2\\mu\\omega}} (a + a^{\\dagger})\n$$\nwhere $\\omega$ is the angular frequency of the oscillator. The problem specifies that this frequency is determined by the harmonic Hamiltonian, so $\\omega = \\sqrt{k/\\mu}$. The ladder operators act on the number states $|v\\rangle$ as follows:\n$$\na|v\\rangle = \\sqrt{v}|v-1\\rangle \\quad (\\text{for } v > 0); \\quad a|0\\rangle = 0\n$$\n$$\na^{\\dagger}|v\\rangle = \\sqrt{v+1}|v+1\\rangle\n$$\nNow we compute the matrix element $\\langle 0|Q|1\\rangle$:\n$$\n\\langle 0|Q|1\\rangle = \\left\\langle 0\\left| \\sqrt{\\frac{\\hbar}{2\\mu\\omega}} (a + a^{\\dagger}) \\right|1\\right\\rangle = \\sqrt{\\frac{\\hbar}{2\\mu\\omega}} (\\langle 0|a|1\\rangle + \\langle 0|a^{\\dagger}|1\\rangle)\n$$\nWe evaluate the two terms in the parenthesis separately.\nFor the first term, using the action of the annihilation operator on $|1\\rangle$:\n$$\n\\langle 0|a|1\\rangle = \\langle 0|(\\sqrt{1}|0\\rangle) = \\langle 0|0\\rangle = 1\n$$\nFor the second term, using the action of the creation operator on $|1\\rangle$:\n$$\n\\langle 0|a^{\\dagger}|1\\rangle = \\langle 0|(\\sqrt{1+1}|1+1\\rangle) = \\sqrt{2}\\langle 0|2\\rangle = 0\n$$\nThis result is due to the orthogonality of states $|0\\rangle$ and $|2\\rangle$.\nCombining these results, the matrix element of $Q$ is:\n$$\n\\langle 0|Q|1\\rangle = \\sqrt{\\frac{\\hbar}{2\\mu\\omega}} (1 + 0) = \\sqrt{\\frac{\\hbar}{2\\mu\\omega}}\n$$\nThis demonstrates the selection rule $\\Delta v = \\pm 1$ for vibrational transitions within the harmonic approximation and linear dipole moment surface.\n\nSubstituting this result back into the expression for $S_{01}$:\n$$\nS_{01} = a^{2} \\left|\\sqrt{\\frac{\\hbar}{2\\mu\\omega}}\\right|^{2} = a^{2} \\frac{\\hbar}{2\\mu\\omega}\n$$\nThe problem requires the final expression in terms of $a$, $\\mu$, $k$, and $\\hbar$. We replace the angular frequency $\\omega$ with its definition in terms of the force constant $k$ and reduced mass $\\mu$:\n$$\n\\omega = \\sqrt{\\frac{k}{\\mu}}\n$$\nSubstituting this into the expression for $S_{01}$:\n$$\nS_{01} = a^{2} \\frac{\\hbar}{2\\mu\\sqrt{k/\\mu}} = a^{2} \\frac{\\hbar}{2\\sqrt{\\mu^{2}}\\sqrt{k/\\mu}} = a^{2} \\frac{\\hbar}{2\\sqrt{\\mu^{2}(k/\\mu)}} = a^{2} \\frac{\\hbar}{2\\sqrt{\\mu k}}\n$$\nThis is the final closed-form expression for the line strength of the fundamental vibrational transition.\n\nFinally, we are asked to state the power-law dependence of $S_{01}$ on the reduced mass $\\mu$, assuming $a$ and $k$ are constant. From the derived expression:\n$$\nS_{01} = \\frac{a^{2}\\hbar}{2} (\\mu k)^{-1/2}\n$$\nit is evident that $S_{01}$ is proportional to $\\mu^{-1/2}$. Therefore, the line strength of the fundamental transition decreases as the reduced mass of the oscillator increases, with a power-law dependence of $-\\tfrac{1}{2}$.", "answer": "$$\n\\boxed{\\frac{a^{2} \\hbar}{2 \\sqrt{\\mu k}}}\n$$", "id": "2779261"}, {"introduction": "A central goal of theoretical spectroscopy is to predict experimental observables. This exercise provides a crucial bridge between a purely theoretical quantity, the transition dipole moment computed from a quantum chemical calculation, and a measurable spectroscopic value, the integrated absorption intensity. This practice will guide you through the derivation that connects the microscopic quantum world to the macroscopic Beer-Lambert law, reinforcing your understanding of the Einstein coefficients and the role of fundamental constants in light-matter interactions. [@problem_id:2779243]", "problem": "A non-degenerate vibrational transition in a linear molecule occurs at a wavenumber of $\\tilde{\\nu}_0 = 1600\\,\\text{cm}^{-1}$. A high-level ab initio calculation yields a transition electric dipole moment magnitude of $\\mu_{if} = 0.120\\,\\text{D}$ (Debye). Assume an isotropic sample at low temperature so that only the lower state is populated, and assume the absorption line shape $\\phi(\\tilde{\\nu})$ is normalized to unit area, i.e., $\\int_{-\\infty}^{\\infty} \\phi(\\tilde{\\nu})\\,d\\tilde{\\nu} = 1$. Treat the radiation field classically as a monochromatic plane wave and the light–matter coupling in the electric dipole approximation.\n\nStarting only from fundamental relations of semiclassical time-dependent perturbation theory for a monochromatic field, the definition of photon flux in terms of field intensity, and the normalization of the line shape, derive the expression for the integrated absorption cross section per molecule over wavenumber, $\\displaystyle S \\equiv \\int \\sigma(\\tilde{\\nu})\\,d\\tilde{\\nu}$, in terms of the transition dipole moment and fundamental constants. Then evaluate it numerically.\n\nUse the following constants (International System of Units (SI) unless indicated otherwise):\n- Vacuum permittivity $\\,\\varepsilon_0 = 8.854\\,187\\,8128 \\times 10^{-12}\\,\\text{F}\\cdot\\text{m}^{-1}$,\n- Reduced Planck constant $\\,\\hbar = 1.054\\,571\\,817 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$,\n- Speed of light $\\,c = 2.997\\,924\\,58 \\times 10^{8}\\,\\text{m}\\cdot\\text{s}^{-1}$,\n- Debye–SI conversion $\\,1\\,\\text{D} = 3.335\\,64 \\times 10^{-30}\\,\\text{C}\\cdot\\text{m}$,\n- Unit conversion $\\,1\\,\\text{cm}^{-1} = 100\\,\\text{m}^{-1}$.\n\nExpress the final integrated line intensity $S$ in the unit $\\text{cm}^{-1}/(\\text{molecule}\\cdot\\text{cm}^{-2})$ and round your answer to three significant figures.", "solution": "The problem posed is a standard exercise in molecular spectroscopy, requiring the derivation of the integrated absorption cross-section from fundamental principles of semiclassical light-matter interaction. We shall first validate the problem statement.\n\n**Problem Validation**\n\nStep 1: Extract Givens\n-   Vibrational transition wavenumber: $\\tilde{\\nu}_0 = 1600\\,\\text{cm}^{-1}$.\n-   Molecular system: A non-degenerate vibrational transition in a linear molecule.\n-   Transition electric dipole moment magnitude: $\\mu_{if} = 0.120\\,\\text{D}$.\n-   Sample conditions: Isotropic sample at low temperature, implying only the initial state is populated.\n-   Line shape function: $\\phi(\\tilde{\\nu})$ is normalized such that $\\int_{-\\infty}^{\\infty} \\phi(\\tilde{\\nu})\\,d\\tilde{\\nu} = 1$.\n-   Theoretical framework: Semiclassical time-dependent perturbation theory, electric dipole approximation.\n-   Task: Derive the expression for the integrated absorption cross-section per molecule, $\\displaystyle S \\equiv \\int \\sigma(\\tilde{\\nu})\\,d\\tilde{\\nu}$, and evaluate it numerically.\n-   Constants:\n    -   $\\varepsilon_0 = 8.854\\,187\\,8128 \\times 10^{-12}\\,\\text{F}\\cdot\\text{m}^{-1}$\n    -   $\\hbar = 1.054\\,571\\,817 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$\n    -   $c = 2.997\\,924\\,58 \\times 10^{8}\\,\\text{m}\\cdot\\text{s}^{-1}$\n    -   $1\\,\\text{D} = 3.335\\,64 \\times 10^{-30}\\,\\text{C}\\cdot\\text{m}$\n    -   $1\\,\\text{cm}^{-1} = 100\\,\\text{m}^{-1}$\n-   Required output format: Numerical value for $S$ in units of $\\text{cm}^{-1}/(\\text{molecule}\\cdot\\text{cm}^{-2})$, rounded to three significant figures. This unit is equivalent to cm/molecule.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a cornerstone calculation in theoretical spectroscopy. It is self-contained, providing all necessary physical quantities and fundamental constants for its solution. The language is objective and precise. The physical values given, a transition at $1600\\,\\text{cm}^{-1}$ (typical for a carbonyl stretch) and a transition dipole of $0.120\\,\\text{D}$, are realistic for an infrared-active vibrational mode. The assumptions (low temperature, isotropic sample) are standard for simplifying such a problem to its core elements. The problem does not violate any physical laws, is not ill-posed, and requires a non-trivial derivation from first principles.\n\nStep 3: Verdict and Action\nThe problem is deemed **valid**. We will proceed with the derivation and solution.\n\n**Derivation of the Integrated Cross-Section**\n\nThe integrated absorption cross-section per molecule, $S = \\int \\sigma(\\tilde{\\nu})d\\tilde{\\nu}$, can be derived from Fermi's Golden Rule. The total transition rate per molecule for stimulated absorption in an isotropic field is given by $W_{i \\to f} = B_{if}^\\omega \\rho(\\omega_{if})$, where $\\rho(\\omega)$ is the energy density per unit angular frequency and $B_{if}^\\omega$ is the Einstein coefficient. From time-dependent perturbation theory, this coefficient is found to be:\n$$ B_{if}^\\omega = \\frac{\\pi |\\mu_{if}|^2}{3 \\varepsilon_0 \\hbar^2} $$\nwhere the factor of $1/3$ comes from averaging over molecular orientations. The power absorbed from the light field per molecule is $\\hbar\\omega_{if} W_{i \\to f}$. This must equal the power removed from the beam, which is given by $\\int \\sigma(\\nu) I(\\nu)d\\nu = c \\int \\sigma(\\nu)\\rho(\\nu)d\\nu$. For a sharp transition, this simplifies to $c \\rho(\\nu_{if}) \\int \\sigma(\\nu)d\\nu = c \\rho(\\nu_{if}) S_\\nu$.\nThe energy densities are related by $\\rho(\\nu) = 2\\pi\\rho(\\omega)$. Equating the power expressions and solving for the cross-section integrated over frequency $\\nu$ gives:\n$$ S_\\nu = \\int \\sigma(\\nu)d\\nu = \\frac{\\hbar\\omega_{if} W_{i \\to f}}{c \\rho(\\nu_{if})} = \\frac{\\hbar\\omega_{if} (B_{if}^\\omega \\rho(\\omega_{if}))}{c (2\\pi \\rho(\\omega_{if}))} = \\frac{\\hbar\\omega_{if}}{2\\pi c} B_{if}^\\omega = \\frac{\\hbar(2\\pi\\nu_{if})}{2\\pi c} \\frac{\\pi |\\mu_{if}|^2}{3 \\varepsilon_0 \\hbar^2} = \\frac{\\pi \\nu_{if} |\\mu_{if}|^2}{3 c \\varepsilon_0 \\hbar} $$\nThe problem asks for the cross-section integrated over wavenumber, $S = \\int \\sigma(\\tilde{\\nu})d\\tilde{\\nu}$. Using the relations $\\nu = c\\tilde{\\nu}$ and $d\\nu = c d\\tilde{\\nu}$, we find $S_\\nu = cS$. Therefore:\n$$ S = \\frac{S_\\nu}{c} = \\frac{\\pi \\nu_{if} |\\mu_{if}|^2}{3 c^2 \\varepsilon_0 \\hbar} $$\nSubstituting $\\nu_{if} = c\\tilde{\\nu}_0$:\n$$ S = \\frac{\\pi (c\\tilde{\\nu}_0) |\\mu_{if}|^2}{3 c^2 \\varepsilon_0 \\hbar} = \\frac{\\pi \\tilde{\\nu}_0 |\\mu_{if}|^2}{3 c \\varepsilon_0 \\hbar} $$\nThis is the final symbolic expression for the integrated cross-section per molecule over wavenumber.\n\n**Numerical Evaluation**\n\nWe convert all given quantities to SI base units.\n- $\\tilde{\\nu}_0 = 1600\\,\\text{cm}^{-1} = 1600 \\times 100\\,\\text{m}^{-1} = 1.6 \\times 10^5\\,\\text{m}^{-1}$.\n- $\\mu_{if} = 0.120\\,\\text{D} = 0.120 \\times (3.335\\,64 \\times 10^{-30}\\,\\text{C}\\cdot\\text{m}) = 4.002\\,768 \\times 10^{-31}\\,\\text{C}\\cdot\\text{m}$.\n- $|\\mu_{if}|^2 = (4.002\\,768 \\times 10^{-31}\\,\\text{C}\\cdot\\text{m})^2 = 1.602\\,215 \\times 10^{-61}\\,\\text{C}^2\\cdot\\text{m}^2$.\n\nNow, substitute these values along with the fundamental constants into the derived expression for $S$.\n$$S = \\frac{\\pi (1.6 \\times 10^5\\,\\text{m}^{-1}) (1.602\\,215 \\times 10^{-61}\\,\\text{C}^2\\cdot\\text{m}^2)}{3(2.997\\,924\\,58 \\times 10^8\\,\\text{m}\\cdot\\text{s}^{-1})(8.854\\,187\\,8128 \\times 10^{-12}\\,\\text{F}\\cdot\\text{m}^{-1})(1.054\\,571\\,817 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s})}$$\nRecalling that $1\\,\\text{F} = 1\\,\\text{C}^2\\cdot\\text{J}^{-1}$, the denominator's units are $(\\text{m}\\cdot\\text{s}^{-1})(\\text{C}^2\\cdot\\text{J}^{-1}\\cdot\\text{m}^{-1})(\\text{J}\\cdot\\text{s}) = \\text{C}^2$. The numerator's units are $\\text{m}^{-1}\\cdot\\text{C}^2\\cdot\\text{m}^2 = \\text{C}^2\\cdot\\text{m}$. The resulting unit for $S$ is meters, as expected.\n\n$$S = \\frac{8.053\\,45 \\times 10^{-56}\\,\\text{C}^2\\cdot\\text{m}}{3 \\times (2.799\\,05 \\times 10^{-37}\\,\\text{C}^2)} = \\frac{8.053\\,45 \\times 10^{-56}\\,\\text{C}^2\\cdot\\text{m}}{8.397\\,15 \\times 10^{-37}\\,\\text{C}^2}$$\n$$S = 9.590\\,69 \\times 10^{-20}\\,\\text{m}$$\nThe problem requires the answer in units of $\\text{cm}^{-1}/(\\text{molecule}\\cdot\\text{cm}^{-2})$, which is equivalent to cm/molecule.\n$$S = (9.590\\,69 \\times 10^{-20}\\,\\text{m}) \\times (100\\,\\text{cm}/\\text{m}) = 9.590\\,69 \\times 10^{-18}\\,\\text{cm}$$\nRounding to three significant figures, the result is $9.59 \\times 10^{-18}\\,\\text{cm}$.", "answer": "$$\\boxed{9.59 \\times 10^{-18}}$$", "id": "2779243"}, {"introduction": "In modern computational chemistry, achieving high accuracy is paramount. This final practice moves into the domain of practical, high-level calculations by addressing the challenge of basis set incompleteness error, one of the primary sources of inaccuracy in quantum chemical predictions. You will implement a widely used research technique: extrapolating results from a series of calculations with systematically improving basis sets to estimate the definitive Complete Basis Set (CBS) limit. This exercise provides hands-on experience with data analysis, weighted least squares fitting, and the physical models that underpin the quest for chemical accuracy. [@problem_id:2779214]", "problem": "Consider a small, closed-shell molecule in the Born–Oppenheimer (BO) approximation and the harmonic vibrational model. The infrared (IR) intensity of a fundamental vibrational transition along a single normal coordinate $Q$ is proportional to the square of the first derivative of the molecular dipole moment vector $\\boldsymbol{\\mu}$ with respect to $Q$ at equilibrium. In symbols, if $g \\equiv \\left\\lVert \\partial \\boldsymbol{\\mu} / \\partial Q \\right\\rVert$ is the magnitude of the dipole derivative, then the harmonic-oscillator IR intensity is proportional to $g^2$. In this problem, we operate entirely in atomic units (a.u.), and we refer to $g$ as the property of interest extracted from a dipole moment surface. We will compute a relative IR intensity $I_{\\text{rel}}$ defined as $I_{\\text{rel}} = g_{\\infty}^2$, where $g_{\\infty}$ is the Complete Basis Set (CBS) limit of $g$.\n\nIn correlation-consistent polarized valence $X$-zeta (cc-pVXZ) basis sets, with the cardinal number $X \\in \\{2,3,4,5,\\dots\\}$, it is a well-tested and widely used fact that basis set incompleteness errors of many ground-state properties converge asymptotically as inverse powers of $X$, often dominated by $X^{-3}$ and improved by including $X^{-5}$. Motivated by this, we adopt the ansatz\n$$\ng(X) = g_{\\infty} + \\sum_{j=1}^{M} c_j X^{-\\alpha_j},\n$$\nwhere $g_{\\infty}$ is the CBS limit in a.u., the exponents $\\alpha_j$ are positive integers chosen from a candidate set, and $c_j$ are coefficients to be determined by fitting. For this exercise, the candidate exponent set is $\\{3,5\\}$. Given $N$ data points $\\{(X_i, g_i, \\sigma_i)\\}_{i=1}^N$, where $g_i$ are values of $g(X_i)$ in a.u. and $\\sigma_i$ are one-standard-deviation uncertainties in a.u., the task is to perform a weighted linear fit to estimate $g_{\\infty}$. The following modeling rules apply:\n- Choose the largest subset of exponents from $\\{3,5\\}$ that yields an identifiable linear model under the data available. Specifically, use $\\{\\}$ if $N=1$, use $\\{3\\}$ if $N=2$, and use $\\{3,5\\}$ if $N \\ge 3$. That is, enforce $1 + M \\le N$, where the unknowns are $g_{\\infty}$ and the $M$ coefficients $c_j$.\n- Use weighted least squares with weights $w_i = 1/\\sigma_i^2$. If some $\\sigma_i$ are not specified, take $\\sigma_i = 1$ for those entries (so $w_i = 1$).\n\nYour program must implement this procedure and apply it to the following test suite. All $g$ values and $\\sigma$ values are in atomic units (a.u.), and all cardinal numbers $X$ are integers. For each case, the input is the list of triples $(X_i, g_i, \\sigma_i)$.\n\n- Test case A (general, three points, use $\\{3,5\\}$):\n  - $(X, g, \\sigma)$ equals $(2, 0.625000000, 0.001000000)$,\n    $(3, 0.541152263, 0.001000000)$,\n    $(4, 0.517968750, 0.001000000)$.\n- Test case B (boundary, two points, use $\\{3\\}$):\n  - $(X, g, \\sigma)$ equals $(3, 0.716666667, 0.002000000)$,\n    $(5, 0.742800000, 0.002000000)$.\n- Test case C (weighted, four points with one outlier down-weighted, use $\\{3,5\\}$):\n  - $(X, g, \\sigma)$ equals $(2, 0.191875000, 0.010000000)$,\n    $(3, 0.119753086, 0.001000000)$,\n    $(4, 0.108105469, 0.001000000)$,\n    $(5, 0.104096000, 0.001000000)$.\n\nTasks your program must perform:\n- For each test case, construct the design matrix with columns $[1, X^{-\\alpha_1}, \\dots, X^{-\\alpha_M}]$ consistent with the chosen $\\{\\alpha_j\\}$, and solve the weighted least squares normal equations to obtain estimates of $g_{\\infty}$ and the coefficients $\\{c_j\\}$.\n- Compute $g_{\\infty}$ (in a.u.) and the relative IR intensity $I_{\\text{rel}} = g_{\\infty}^2$ (in $(\\text{a.u.})^2$) for each test case.\n\nNumerical and output requirements:\n- Report $g_{\\infty}$ in atomic units (a.u.) and $I_{\\text{rel}}$ in $(\\text{a.u.})^2$.\n- Round every reported numeric output to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain $6$ floats in the following order: $[g_{\\infty}^{(A)}, g_{\\infty}^{(B)}, g_{\\infty}^{(C)}, I_{\\text{rel}}^{(A)}, I_{\\text{rel}}^{(B)}, I_{\\text{rel}}^{(C)}]$, where superscripts label the test cases A, B, and C.\n\nThe problem is universally applicable as a weighted linear regression and model selection task on inverse-power regressors. It is purely computational and does not require any particular programming language semantics beyond standard floating-point arithmetic and linear algebra. All physical quantities are expressed in explicitly specified units as stated above, and no angles or percentages are involved.", "solution": "The problem presented is a straightforward application of weighted linear least squares regression, a fundamental technique in data analysis. The task is to estimate the complete basis set (CBS) limit, $g_{\\infty}$, of a molecular property $g(X)$ by fitting a physically motivated model to a set of computed data points $\\{(X_i, g_i, \\sigma_i)\\}_{i=1}^N$. The property $g$ is the magnitude of the electric dipole moment derivative with respect to a normal coordinate, and $X$ is the cardinal number of the cc-pVXZ basis set. The relative infrared intensity is defined as $I_{\\text{rel}} = g_{\\infty}^2$.\n\nThe regression model is linear in its parameters $(g_{\\infty}, c_1, \\dots, c_M)$ and is given by the ansatz:\n$$ g(X) = g_{\\infty} + \\sum_{j=1}^{M} c_j X^{-\\alpha_j} $$\nFor a set of $N$ data points, this can be expressed in matrix form as $\\mathbf{A}\\mathbf{p} \\approx \\mathbf{g}$, where $\\mathbf{p} = [g_{\\infty}, c_1, \\dots, c_M]^T$ is the vector of parameters, $\\mathbf{g} = [g_1, \\dots, g_N]^T$ is the vector of observed values, and $\\mathbf{A}$ is the $N \\times (M+1)$ design matrix with entries $A_{i,0} = 1$ and $A_{i,j} = X_i^{-\\alpha_j}$ for $j > 0$.\n\nThe parameters are determined by minimizing the weighted sum of squared residuals, $\\chi^2$:\n$$ \\chi^2 = \\sum_{i=1}^N w_i (g_i - g(X_i))^2 = (\\mathbf{g} - \\mathbf{A}\\mathbf{p})^T \\mathbf{W} (\\mathbf{g} - \\mathbf{A}\\mathbf{p}) $$\nwhere $\\mathbf{W}$ is a diagonal matrix of weights $w_i = 1/\\sigma_i^2$. The solution that minimizes $\\chi^2$ is found by solving the normal equations:\n$$ (\\mathbf{A}^T \\mathbf{W} \\mathbf{A}) \\mathbf{p} = \\mathbf{A}^T \\mathbf{W} \\mathbf{g} $$\nThe solution vector is thus $\\mathbf{p} = (\\mathbf{A}^T \\mathbf{W} \\mathbf{A})^{-1} \\mathbf{A}^T \\mathbf{W} \\mathbf{g}$. Computationally, it is more stable to solve this system using methods based on QR decomposition or Singular Value Decomposition, for instance, by solving the unweighted least squares problem for the transformed system $(\\mathbf{W}^{1/2}\\mathbf{A})\\mathbf{p} = (\\mathbf{W}^{1/2}\\mathbf{g})$.\n\nThe problem specifies a model selection rule: the set of exponents $\\{\\alpha_j\\}$ is chosen from the candidate set $\\{3, 5\\}$ such that the number of parameters $M+1$ does not exceed the number of data points $N$. For $N=1$, we use $M=0$ (no exponents). For $N=2$, we use $M=1$ with $\\{\\alpha_1\\} = \\{3\\}$. For $N \\ge 3$, we use $M=2$ with $\\{\\alpha_1, \\alpha_2\\} = \\{3, 5\\}$. We now apply this procedure to each test case.\n\nTest Case A:\nWe are given $N=3$ data points: $(2, 0.625, 0.001)$, $(3, 0.541152263, 0.001)$, and $(4, 0.51796875, 0.001)$. According to the rule for $N=3$, we use the exponent set $\\{3, 5\\}$. The model is $g(X) = g_{\\infty} + c_1 X^{-3} + c_2 X^{-5}$. There are $3$ parameters and $3$ data points, so the system is exactly determined. The uncertainties $\\sigma_i$ are all equal, so the weights $w_i$ are uniform and the problem reduces to unweighted least squares, i.e., solving $\\mathbf{A}\\mathbf{p} = \\mathbf{g}$.\nThe system of linear equations is:\n$$ \\begin{pmatrix} 1 & 2^{-3} & 2^{-5} \\\\ 1 & 3^{-3} & 3^{-5} \\\\ 1 & 4^{-3} & 4^{-5} \\end{pmatrix} \\begin{pmatrix} g_{\\infty} \\\\ c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} 0.625 \\\\ 0.541152263 \\\\ 0.517968750 \\end{pmatrix} $$\nSolving this system yields the parameter vector $\\mathbf{p} = [0.5, 1.2, -0.8]^T$.\nTherefore, $g_{\\infty}^{(A)} = 0.5$ a.u.\nThe relative intensity is $I_{\\text{rel}}^{(A)} = (g_{\\infty}^{(A)})^2 = (0.5)^2 = 0.25$ $(\\text{a.u.})^2$.\n\nTest Case B:\nWe are given $N=2$ data points: $(3, 0.716666667, 0.002)$ and $(5, 0.7428, 0.002)$. For $N=2$, we use the exponent set $\\{3\\}$. The model is $g(X) = g_{\\infty} + c_1 X^{-3}$. With $2$ parameters and $2$ data points, the system is again exactly determined. As the uncertainties are equal, this is an unweighted problem.\nThe system of linear equations is:\n$$ \\begin{pmatrix} 1 & 3^{-3} \\\\ 1 & 5^{-3} \\end{pmatrix} \\begin{pmatrix} g_{\\infty} \\\\ c_1 \\end{pmatrix} = \\begin{pmatrix} 0.716666667 \\\\ 0.742800000 \\end{pmatrix} $$\nSolving this system yields the parameter vector $\\mathbf{p} = [0.75, -0.9]^T$.\nTherefore, $g_{\\infty}^{(B)} = 0.75$ a.u.\nThe relative intensity is $I_{\\text{rel}}^{(B)} = (g_{\\infty}^{(B)})^2 = (0.75)^2 = 0.5625$ $(\\text{a.u.})^2$.\n\nTest Case C:\nWe are given $N=4$ data points: $(2, 0.191875, 0.01)$, $(3, 0.119753086, 0.001)$, $(4, 0.108105469, 0.001)$, and $(5, 0.104096, 0.001)$. For $N=4$, we use the exponent set $\\{3, 5\\}$. The model is $g(X) = g_{\\infty} + c_1 X^{-3} + c_2 X^{-5}$. There are $3$ parameters and $4$ data points, so the system is overdetermined and must be solved using least squares. The uncertainties are not uniform, so a weighted fit is required. The weights are $w_i = 1/\\sigma_i^2$. The first data point has a much larger uncertainty ($\\sigma_1=0.01$) and is therefore significantly down-weighted relative to the other three points ($\\sigma_{2,3,4}=0.001$).\nWe solve the weighted normal equations $(\\mathbf{A}^T \\mathbf{W} \\mathbf{A}) \\mathbf{p} = \\mathbf{A}^T \\mathbf{W} \\mathbf{g}$, where $\\mathbf{A}$ is the $4 \\times 3$ design matrix and $\\mathbf{W} = \\text{diag}(1/0.01^2, 1/0.001^2, 1/0.001^2, 1/0.001^2)$.\nThe solution to this weighted least squares problem is $\\mathbf{p} \\approx [0.1, 0.5, 0.3]^T$.\nTherefore, $g_{\\infty}^{(C)} \\approx 0.10000001$ a.u.\nThe relative intensity is $I_{\\text{rel}}^{(C)} = (g_{\\infty}^{(C)})^2 \\approx (0.10000001)^2 \\approx 0.010000002$ $(\\text{a.u.})^2$.\n\nThe final results, rounded to $6$ decimal places as required, are:\n$g_{\\infty}^{(A)} = 0.500000$ a.u.\n$g_{\\infty}^{(B)} = 0.750000$ a.u.\n$g_{\\infty}^{(C)} = 0.100000$ a.u.\n$I_{\\text{rel}}^{(A)} = 0.250000$ $(\\text{a.u.})^2$\n$I_{\\text{rel}}^{(B)} = 0.562500$ $(\\text{a.u.})^2$\n$I_{\\text{rel}}^{(C)} = 0.010000$ $(\\text{a.u.})^2$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the CBS limit of g and the relative IR intensity for a set\n    of test cases using weighted linear least squares.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a list of tuples (X, g, sigma).\n    test_cases = {\n        'A': [\n            (2, 0.625000000, 0.001000000),\n            (3, 0.541152263, 0.001000000),\n            (4, 0.517968750, 0.001000000)\n        ],\n        'B': [\n            (3, 0.716666667, 0.002000000),\n            (5, 0.742800000, 0.002000000)\n        ],\n        'C': [\n            (2, 0.191875000, 0.010000000),\n            (3, 0.119753086, 0.001000000),\n            (4, 0.108105469, 0.001000000),\n            (5, 0.104096000, 0.001000000)\n        ]\n    }\n    \n    results_g_inf = {}\n    results_I_rel = {}\n\n    for case_label, data in test_cases.items():\n        # Unpack data into numpy arrays\n        X, g, sigma = np.array(data).T\n        \n        N = len(data)\n        \n        # Determine the set of exponents based on the number of data points\n        if N == 1:\n            exponents = []\n        elif N == 2:\n            exponents = [3]\n        else: # N >= 3\n            exponents = [3, 5]\n            \n        # Construct the design matrix A\n        num_params = 1 + len(exponents)\n        A = np.zeros((N, num_params))\n        A[:, 0] = 1.0 # Column for g_infinity\n        for i, exp in enumerate(exponents):\n            A[:, i+1] = X**(-exp)\n            \n        # Perform weighted linear least squares.\n        # This is equivalent to unweighted least squares on a transformed system\n        # A' * p = g', where A' = A / sigma and g' = g / sigma.\n        # We need to reshape sigma to use broadcasting for element-wise division.\n        sigma_col = sigma[:, np.newaxis]\n        \n        A_w = A / sigma_col\n        g_w = g / sigma\n        \n        # Solve the linear least squares problem\n        # The first element of the solution vector 'params' is g_infinity\n        params, _, _, _ = np.linalg.lstsq(A_w, g_w, rcond=None)\n        \n        g_inf = params[0]\n        I_rel = g_inf**2\n        \n        results_g_inf[case_label] = g_inf\n        results_I_rel[case_label] = I_rel\n\n    # Prepare the final output string as per requirements\n    final_list = [\n        results_g_inf['A'],\n        results_g_inf['B'],\n        results_g_inf['C'],\n        results_I_rel['A'],\n        results_I_rel['B'],\n        results_I_rel['C']\n    ]\n\n    # Format each number to 6 decimal places and join into a comma-separated string\n    formatted_results = [f\"{val:.6f}\" for val in final_list]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2779214"}]}