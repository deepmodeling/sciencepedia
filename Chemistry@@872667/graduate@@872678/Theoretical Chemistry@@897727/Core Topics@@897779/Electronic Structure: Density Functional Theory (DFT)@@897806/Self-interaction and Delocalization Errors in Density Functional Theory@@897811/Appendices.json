{"hands_on_practices": [{"introduction": "In exact Kohn-Sham DFT, a cornerstone result known as Janak's theorem equates the negative of the highest occupied molecular orbital (HOMO) energy, $-\\epsilon_{\\mathrm{HOMO}}$, to the first ionization potential, $I$. However, this equality often fails for common approximate functionals due to self-interaction error. This first practice provides a direct, quantitative look at this failure by tasking you with calculating the ionization potential of several atoms using both the total energy difference and the HOMO energy from a Local Density Approximation (LDA) calculation, thereby measuring the error firsthand [@problem_id:2804406].", "problem": "You are given precomputed Local Density Approximation (LDA) data for ground-state total energies and the highest occupied Kohn–Sham orbital energy for three atoms. Using the definition of the first ionization energy as the difference of ground-state total energies between the cation and the neutral, and the Kohn–Sham interpretation of the negative of the highest occupied orbital energy, quantify the deviation that arises in LDA. All energies are given in hartree and your answers must be expressed in hartree, rounded to six decimal places.\n\nFoundational definitions and facts to use:\n- In Density Functional Theory (DFT), the first ionization energy is defined by the finite difference of total energies as $I \\equiv E(N-1) - E(N)$, where $E(M)$ denotes the exact ground-state total energy for $M$ electrons.\n- In exact Kohn–Sham (KS) DFT, it holds that $I = -\\varepsilon_{\\mathrm{HOMO}}$, where $\\varepsilon_{\\mathrm{HOMO}}$ is the highest occupied KS eigenvalue, but approximate functionals such as the Local Density Approximation (LDA) generally violate this equality.\n\nYour task:\n- For each atom, compute $I = E(N-1) - E(N)$.\n- Compute $-\\varepsilon_{\\mathrm{HOMO}}$.\n- Compute the signed deviation $\\Delta = I - \\left(-\\varepsilon_{\\mathrm{HOMO}}\\right)$.\n- Report, for each atom, the triple $[I,\\,-\\varepsilon_{\\mathrm{HOMO}},\\,\\Delta]$.\n\nTest suite data (LDA, spin-unpolarized where relevant; values are representative and self-consistent):\n- Hydrogen: $E_{\\mathrm{LDA}}(N=1) = -0.478$, $E_{\\mathrm{LDA}}(N-1=0) = 0.000$, $\\varepsilon_{\\mathrm{HOMO}}^{\\mathrm{LDA}} = -0.270$.\n- Helium: $E_{\\mathrm{LDA}}(N=2) = -2.834$, $E_{\\mathrm{LDA}}(N-1=1) = -1.940$, $\\varepsilon_{\\mathrm{HOMO}}^{\\mathrm{LDA}} = -0.571$.\n- Neon: $E_{\\mathrm{LDA}}(N=10) = -128.200$, $E_{\\mathrm{LDA}}(N-1=9) = -127.360$, $\\varepsilon_{\\mathrm{HOMO}}^{\\mathrm{LDA}} = -0.540$.\n\nCoverage rationale for the test suite:\n- Hydrogen serves as an edge case where $E(N-1)=0$ and the system has a single electron, highlighting self-interaction.\n- Helium is a closed-shell, light atom probing the transition from one- to two-electron behavior.\n- Neon is a closed-shell, heavier atom probing many-electron behavior and delocalization tendencies.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of three lists, each list corresponding to one atom (Hydrogen, Helium, Neon in this order), and each inner list containing the three floats $[I,\\,-\\varepsilon_{\\mathrm{HOMO}},\\,\\Delta]$, all rounded to six decimal places.\n- The line must be formatted exactly like:\n  \"[[a1,a2,a3],[b1,b2,b3],[c1,c2,c3]]\"\n  where each $a_i$, $b_i$, $c_i$ is a float in hartree with exactly six digits after the decimal point.\n\nNo input will be provided to your program; it must use the embedded test suite data above and print the single required line.", "solution": "The problem is subjected to validation and is deemed valid. It is scientifically grounded in the principles of Density Functional Theory (DFT), well-posed with all necessary data provided, and objective in its formulation. We will proceed with a solution.\n\nThe central task is to quantify the discrepancy between two methods for calculating the first ionization energy, $I$, within the framework of the Local Density Approximation (LDA). In exact DFT, the first ionization energy is given by two equivalent expressions. The first is the difference in ground-state total energies between the $(N-1)$-electron system and the $N$-electron system:\n$$I \\equiv E(N-1) - E(N)$$\nThis is often referred to as the $\\Delta$SCF method. The second arises from Janak's theorem, which relates the derivative of the total energy with respect to orbital occupation to the orbital eigenvalue. For the highest occupied molecular orbital (HOMO), this leads to the exact relation:\n$$I = -\\varepsilon_{\\mathrm{HOMO}}$$\nwhere $\\varepsilon_{\\mathrm{HOMO}}$ is the energy of the highest occupied Kohn-Sham orbital.\n\nFor approximate exchange-correlation functionals, such as LDA, this equality is not guaranteed. The failure of LDA to satisfy this condition is a well-known deficiency, stemming from self-interaction error and the related delocalization error. An electron in such an approximate potential spuriously interacts with its own charge density, which is artificially spread out. This unphysical self-repulsion raises the orbital energies, particularly $\\varepsilon_{\\mathrm{HOMO}}$, making them less negative than they should be. Consequently, $-\\varepsilon_{\\mathrm{HOMO}}$ becomes a poor approximation for the ionization energy.\n\nWe will compute the ionization energy using both definitions and then calculate their signed deviation, $\\Delta$, for each of the specified atoms. The deviation is defined as:\n$$\\Delta = I - (-\\varepsilon_{\\mathrm{HOMO}})$$\nA non-zero value of $\\Delta$ quantifies the error in the LDA functional with respect to this fundamental property. All energies are in hartree.\n\nFor the Hydrogen atom ($N=1$):\nThe provided data are $E_{\\mathrm{LDA}}(N=1) = -0.478$, $E_{\\mathrm{LDA}}(N-1=0) = 0.000$, and $\\varepsilon_{\\mathrm{HOMO}}^{\\mathrm{LDA}} = -0.270$.\nThe ionization energy from the total energy difference is:\n$$I_{\\mathrm{H}} = E_{\\mathrm{LDA}}(0) - E_{\\mathrm{LDA}}(1) = 0.000 - (-0.478) = 0.478$$\nThe ionization energy from the HOMO eigenvalue is:\n$$-\\varepsilon_{\\mathrm{HOMO, H}}^{\\mathrm{LDA}} = -(-0.270) = 0.270$$\nThe deviation is:\n$$\\Delta_{\\mathrm{H}} = I_{\\mathrm{H}} - (-\\varepsilon_{\\mathrm{HOMO, H}}^{\\mathrm{LDA}}) = 0.478 - 0.270 = 0.208$$\nFor the single-electron hydrogen atom, this deviation is a pure manifestation of self-interaction error.\n\nFor the Helium atom ($N=2$):\nThe provided data are $E_{\\mathrm{LDA}}(N=2) = -2.834$, $E_{\\mathrm{LDA}}(N-1=1) = -1.940$, and $\\varepsilon_{\\mathrm{HOMO}}^{\\mathrm{LDA}} = -0.571$.\nThe ionization energy from the total energy difference is:\n$$I_{\\mathrm{He}} = E_{\\mathrm{LDA}}(1) - E_{\\mathrm{LDA}}(2) = -1.940 - (-2.834) = 0.894$$\nThe ionization energy from the HOMO eigenvalue is:\n$$-\\varepsilon_{\\mathrm{HOMO, He}}^{\\mathrm{LDA}} = -(-0.571) = 0.571$$\nThe deviation is:\n$$\\Delta_{\\mathrm{He}} = I_{\\mathrm{He}} - (-\\varepsilon_{\\mathrm{HOMO, He}}^{\\mathrm{LDA}}) = 0.894 - 0.571 = 0.323$$\nThe substantial positive deviation shows that $\\varepsilon_{\\mathrm{HOMO}}^{\\mathrm{LDA}}$ is significantly too high (not negative enough).\n\nFor the Neon atom ($N=10$):\nThe provided data are $E_{\\mathrm{LDA}}(N=10) = -128.200$, $E_{\\mathrm{LDA}}(N-1=9) = -127.360$, and $\\varepsilon_{\\mathrm{HOMO}}^{\\mathrm{LDA}} = -0.540$.\nThe ionization energy from the total energy difference is:\n$$I_{\\mathrm{Ne}} = E_{\\mathrm{LDA}}(9) - E_{\\mathrm{LDA}}(10) = -127.360 - (-128.200) = 0.840$$\nThe ionization energy from the HOMO eigenvalue is:\n$$-\\varepsilon_{\\mathrm{HOMO, Ne}}^{\\mathrm{LDA}} = -(-0.540) = 0.540$$\nThe deviation is:\n$$\\Delta_{\\mathrm{Ne}} = I_{\\mathrm{Ne}} - (-\\varepsilon_{\\mathrm{HOMO, Ne}}^{\\mathrm{LDA}}) = 0.840 - 0.540 = 0.300$$\nThe error persists for many-electron systems, highlighting the systematic nature of this failure in LDA. In all cases, the $-\\varepsilon_{\\mathrm{HOMO}}$ value severely underestimates the ionization energy predicted by the more reliable total energy difference method. This is a direct consequence of local functionals yielding a convex $E(N)$ curve, in contrast to the piecewise-linear behavior of the exact functional. The positive deviation $\\Delta$ is characteristic of delocalization error inherent to common approximate functionals.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the deviation between two definitions of the first ionization energy\n    using precomputed Local Density Approximation (LDA) data for H, He, and Ne.\n    \"\"\"\n    \n    # Test suite data (LDA, in hartree): (E_N, E_N_minus_1, epsilon_HOMO)\n    # The data represents ground-state total energies and the highest occupied\n    # Kohn-Sham orbital energy for the neutral atom.\n    test_cases = [\n        # Hydrogen (N=1)\n        (-0.478, 0.000, -0.270),  \n        # Helium (N=2)\n        (-2.834, -1.940, -0.571),  \n        # Neon (N=10)\n        (-128.200, -127.360, -0.540) \n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        E_N, E_N_minus_1, epsilon_HOMO = case\n        \n        # 1. Compute the ionization energy from the total energy difference.\n        # I = E(N-1) - E(N)\n        I_delta_scf = E_N_minus_1 - E_N\n        \n        # 2. Compute the ionization energy from the HOMO eigenvalue.\n        # I = -epsilon_HOMO\n        I_ks_eigenvalue = -epsilon_HOMO\n        \n        # 3. Compute the signed deviation.\n        # Delta = I_delta_scf - I_ks_eigenvalue\n        deviation = I_delta_scf - I_ks_eigenvalue\n        \n        # Store the triplet [I, -epsilon_HOMO, Delta] for the current atom.\n        atom_results = [I_delta_scf, I_ks_eigenvalue, deviation]\n        all_results.append(atom_results)\n\n    # Format the final output according to the specified format:\n    # \"[[a1,a2,a3],[b1,b2,b3],[c1,c2,c3]]\" with values rounded to six decimal places.\n    formatted_results = []\n    for atom_res in all_results:\n        # Format each number in the inner list to have exactly six decimal places.\n        inner_list_str = f\"[{atom_res[0]:.6f},{atom_res[1]:.6f},{atom_res[2]:.6f}]\"\n        formatted_results.append(inner_list_str)\n        \n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    # Print the single required line.\n    print(final_output_string)\n\n# Execute the main function.\nsolve()\n```", "id": "2804406"}, {"introduction": "Having seen a key symptom of self-interaction error, we now turn to its underlying cause using a model system. This exercise explores the dissociation of the hydrogen molecular ion, $\\text{H}_2^{+}$, where exact DFT predicts the single electron must localize on one of the protons at infinite separation. You will contrast this correct piecewise-linear behavior with a model for a typical semi-local functional, which exhibits a convex energy curve that unphysically favors a delocalized, fractionally charged state, providing a clear illustration of delocalization error [@problem_id:2804468].", "problem": "Consider the dissociation of the cationic hydrogen dimer, with chemical formula $\\text{H}_2^{+}$, in the limit of very large internuclear separation so that the two protons define two non-overlapping fragments labeled $\\mathrm{A}$ and $\\mathrm{B}$. There is a single electron in the system. Use the following fundamental base:\n\n- In the exact Kohn–Sham formulation of Density Functional Theory (DFT), for any one-electron density, the Hartree self-interaction is exactly canceled by the exchange-correlation functional. Consequently, for a one-electron system the total energy is the sum of the non-interacting kinetic energy and the external potential energy, and the energy as a function of fractional electron number is piecewise linear according to the Perdew–Parr–Levy–Balduz (PPLB) condition.\n- At infinite separation, the Hamiltonian separates into two isolated fragments with on-site one-electron energies $\\varepsilon_{\\mathrm{A}}$ and $\\varepsilon_{\\mathrm{B}}$. For a hydrogen atom, the exact non-relativistic ground-state energy is $-0.5$ Hartree. In the symmetric $\\text{H}_2^{+}$ case, $\\varepsilon_{\\mathrm{A}}=\\varepsilon_{\\mathrm{B}}=-0.5$ Hartree.\n- In approximate semi-local functionals such as the Generalized Gradient Approximation (GGA), the cancellation of the one-electron self-interaction is incomplete. A robust qualitative model for the residual delocalization error at dissociation is a convex quadratic penalty in the fragment occupations reflecting the quadratic scaling of the Hartree energy with charge, of the form $E_{\\mathrm{res}}(\\,n_{\\mathrm{A}}\\,)=\\alpha\\left(n_{\\mathrm{A}}^{2}+\\left(1-n_{\\mathrm{A}}\\right)^{2}\\right)$ with $\\alpha0$, where $n_{\\mathrm{A}}\\in[0,1]$ is the fraction of the electron localized on fragment $\\mathrm{A}$ and $1-n_{\\mathrm{A}}$ on fragment $\\mathrm{B}$.\n\nTasks:\n\n- Using only the above fundamentals, and assuming infinite separation so that there is no inter-fragment hopping or overlap, derive from first principles the exact dissociation-limit energy as a function of the occupation $n_{\\mathrm{A}}$ and identify the minimizing occupation that represents a symmetry-broken, localized-electron state. In the perfectly symmetric case $\\varepsilon_{\\mathrm{A}}=\\varepsilon_{\\mathrm{B}}$, adopt the convention that the localized-electron branch corresponds to $n_{\\mathrm{A}}=1$.\n- Construct a GGA-like approximate dissociation-limit energy by adding the convex quadratic residual error $E_{\\mathrm{res}}$ to the non-interacting fragment energy, and analytically determine the occupation $n_{\\mathrm{A}}^{\\ast}$ that minimizes this approximate energy subject to the bound constraints $n_{\\mathrm{A}}\\in[0,1]$. Specify when the minimizer lies strictly inside the interval and when it saturates at the boundaries.\n- Express all energies in Hartree units. Angles do not appear. All final numerical answers must be real numbers. Round all printed floating-point results to six digits after the decimal point.\n\nYour program must implement the derived formulas and evaluate, for each test case, the following four quantities in this order: the exact minimal energy $E_{\\mathrm{exact}}^{\\min}$ (Hartree), the corresponding exact minimizing occupation $n_{\\mathrm{A,exact}}^{\\ast}$, the GGA-like minimal energy $E_{\\mathrm{GGA}}^{\\min}$ (Hartree), and the corresponding GGA-like minimizing occupation $n_{\\mathrm{A,GGA}}^{\\ast}$.\n\nUse the following test suite of parameter triples $(\\varepsilon_{\\mathrm{A}},\\varepsilon_{\\mathrm{B}},\\alpha)$, with all energies in Hartree:\n\n- $( -0.5, -0.5, 0.1 )$\n- $( -0.48, -0.52, 0.1 )$\n- $( -0.3, -0.7, 0.1 )$\n- $( -0.48, -0.52, 0.01 )$\n- $( -0.5, -0.5, 0.001 )$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must concatenate the four rounded values for each test case in the exact order specified above, traversing the test suite in the order listed. For example, the format must be $[E_{\\mathrm{exact}}^{\\min}(\\text{case}\\ \\mathrm{A}),n_{\\mathrm{A,exact}}^{\\ast}(\\text{case}\\ \\mathrm{A}),E_{\\mathrm{GGA}}^{\\min}(\\text{case}\\ \\mathrm{A}),n_{\\mathrm{A,GGA}}^{\\ast}(\\text{case}\\ \\mathrm{A}),\\dots]$ with no additional whitespace or text.", "solution": "We consider the dissociation limit of $\\mathrm{H}_{2}^{+}$ as two infinitely separated fragments $\\mathrm{A}$ and $\\mathrm{B}$ with on-site one-electron energies $\\varepsilon_{\\mathrm{A}}$ and $\\varepsilon_{\\mathrm{B}}$. There is a single electron with occupation $n_{\\mathrm{A}}$ on fragment $\\mathrm{A}$ and $1-n_{\\mathrm{A}}$ on fragment $\\mathrm{B}$, with $n_{\\mathrm{A}}\\in[0,1]$.\n\nExact dissociation energy from first principles. For any one-electron density, the exact exchange-correlation functional cancels the Hartree self-interaction, and the Perdew–Parr–Levy–Balduz (PPLB) condition enforces piecewise linearity of the total energy with respect to the electron number on each decoupled fragment. At infinite separation, there is no coupling term, so the exact energy as a function of $n_{\\mathrm{A}}$ is simply the linear interpolation between fragment energies:\n$$\nE_{\\mathrm{exact}}(n_{\\mathrm{A}})=n_{\\mathrm{A}}\\,\\varepsilon_{\\mathrm{A}}+\\left(1-n_{\\mathrm{A}}\\right)\\,\\varepsilon_{\\mathrm{B}}.\n$$\nBecause $E_{\\mathrm{exact}}(n_{\\mathrm{A}})$ is linear in $n_{\\mathrm{A}}$, its minimum on the closed interval $[0,1]$ is achieved at a boundary point. Specifically,\n$$\nE_{\\mathrm{exact}}^{\\min}=\\min\\left\\{\\varepsilon_{\\mathrm{A}},\\varepsilon_{\\mathrm{B}}\\right\\},\\quad\nn_{\\mathrm{A,exact}}^{\\ast}=\\begin{cases}\n1,\\text{if }\\varepsilon_{\\mathrm{A}}lt;\\varepsilon_{\\mathrm{B}},\\\\\n0,\\text{if }\\varepsilon_{\\mathrm{B}}lt;\\varepsilon_{\\mathrm{A}},\\\\\n1,\\text{if }\\varepsilon_{\\mathrm{A}}=\\varepsilon_{\\mathrm{B}}\\ \\text{(by the stated convention of choosing a localized branch)}.\n\\end{cases}\n$$\nThus, the exact dissociation places the entire electron on the lower-energy fragment, and in the symmetric case any $n_{\\mathrm{A}}\\in[0,1]$ is degenerate; we select $n_{\\mathrm{A,exact}}^{\\ast}=1$ to represent a localized-electron state on fragment $\\mathrm{A}$.\n\nGGA-like approximate energy and minimizer. Semi-local functionals such as the Generalized Gradient Approximation (GGA) do not perfectly cancel one-electron self-interaction, producing a residual, convex delocalization error that increases with charge localization. A minimal, symmetry-respecting model for this residual in the dissociation limit is a quadratic penalty in the fragment occupations:\n$$\nE_{\\mathrm{res}}(n_{\\mathrm{A}})=\\alpha\\left(n_{\\mathrm{A}}^{2}+\\left(1-n_{\\mathrm{A}}\\right)^{2}\\right),\\quad \\alpha0.\n$$\nAdding this to the non-interacting fragment energy yields the GGA-like total energy\n$$\nE_{\\mathrm{GGA}}(n_{\\mathrm{A}})=n_{\\mathrm{A}}\\,\\varepsilon_{\\mathrm{A}}+\\left(1-n_{\\mathrm{A}}\\right)\\,\\varepsilon_{\\mathrm{B}}+\\alpha\\left(n_{\\mathrm{A}}^{2}+\\left(1-n_{\\mathrm{A}}\\right)^{2}\\right).\n$$\nTo minimize $E_{\\mathrm{GGA}}(n_{\\mathrm{A}})$ over $n_{\\mathrm{A}}\\in[0,1]$, we first find the unconstrained stationary point by differentiation:\n$$\n\\frac{dE_{\\mathrm{GGA}}}{dn_{\\mathrm{A}}}=\\varepsilon_{\\mathrm{A}}-\\varepsilon_{\\mathrm{B}}+2\\alpha\\left(2n_{\\mathrm{A}}-1\\right).\n$$\nSetting the derivative to zero yields the unconstrained minimizer\n$$\nn_{\\mathrm{A}}^{\\mathrm{uncon}}=\\frac{1}{2}+\\frac{\\varepsilon_{\\mathrm{B}}-\\varepsilon_{\\mathrm{A}}}{4\\alpha}.\n$$\nBecause the second derivative is constant and positive, $\\frac{d^{2}E_{\\mathrm{GGA}}}{dn_{\\mathrm{A}}^{2}}=4\\alpha0$, this stationary point is a global minimizer of the unconstrained quadratic. Enforcing the bound constraints $n_{\\mathrm{A}}\\in[0,1]$ then gives the constrained minimizer\n$$\nn_{\\mathrm{A,GGA}}^{\\ast}=\\min\\left\\{1,\\max\\left\\{0,\\ \\frac{1}{2}+\\frac{\\varepsilon_{\\mathrm{B}}-\\varepsilon_{\\mathrm{A}}}{4\\alpha}\\right\\}\\right\\}.\n$$\nThe corresponding minimal GGA-like energy is\n$$\nE_{\\mathrm{GGA}}^{\\min}=E_{\\mathrm{GGA}}\\!\\left(n_{\\mathrm{A,GGA}}^{\\ast}\\right)=n_{\\mathrm{A,GGA}}^{\\ast}\\,\\varepsilon_{\\mathrm{A}}+\\left(1-n_{\\mathrm{A,GGA}}^{\\ast}\\right)\\,\\varepsilon_{\\mathrm{B}}+\\alpha\\left(\\left(n_{\\mathrm{A,GGA}}^{\\ast}\\right)^{2}+\\left(1-n_{\\mathrm{A,GGA}}^{\\ast}\\right)^{2}\\right).\n$$\nInterior versus boundary regimes. The minimizer lies strictly in the interior if and only if $0lt;n_{\\mathrm{A}}^{\\mathrm{uncon}}lt;1$, i.e.,\n$$\n-2\\alphalt;\\varepsilon_{\\mathrm{B}}-\\varepsilon_{\\mathrm{A}}lt;2\\alpha.\n$$\nIf $\\varepsilon_{\\mathrm{B}}-\\varepsilon_{\\mathrm{A}}\\leq -2\\alpha$, then $n_{\\mathrm{A,GGA}}^{\\ast}=0$; if $\\varepsilon_{\\mathrm{B}}-\\varepsilon_{\\mathrm{A}}\\geq 2\\alpha$, then $n_{\\mathrm{A,GGA}}^{\\ast}=1$. In the symmetric case $\\varepsilon_{\\mathrm{A}}=\\varepsilon_{\\mathrm{B}}$, the unconstrained minimizer is $n_{\\mathrm{A}}^{\\mathrm{uncon}}=\\frac{1}{2}$, and the minimal energy is elevated above the exact value by the residual penalty $\\alpha\\left(\\frac{1}{2}\\right)$ since $\\left(\\frac{1}{2}\\right)^{2}+\\left(1-\\frac{1}{2}\\right)^{2}=\\frac{1}{2}$.\n\nComputational procedure. For each parameter triple $(\\varepsilon_{\\mathrm{A}},\\varepsilon_{\\mathrm{B}},\\alpha)$:\n- Compute $E_{\\mathrm{exact}}^{\\min}=\\min\\left\\{\\varepsilon_{\\mathrm{A}},\\varepsilon_{\\mathrm{B}}\\right\\}$ and $n_{\\mathrm{A,exact}}^{\\ast}$ as above, with $n_{\\mathrm{A,exact}}^{\\ast}=1$ in the symmetric case by convention.\n- Compute $n_{\\mathrm{A,GGA}}^{\\ast}$ by clamping $n_{\\mathrm{A}}^{\\mathrm{uncon}}$ to $[0,1]$, and then $E_{\\mathrm{GGA}}^{\\min}$ by evaluating $E_{\\mathrm{GGA}}$ at $n_{\\mathrm{A,GGA}}^{\\ast}$.\n- Round each numerical output to six digits after the decimal point, and aggregate the results into a single flat list in the required order.\n\nApplication to the test suite. Using the listed parameters (in Hartree), we obtain:\n\n- For $( -0.5, -0.5, 0.1 )$: $E_{\\mathrm{exact}}^{\\min}=-0.5$, $n_{\\mathrm{A,exact}}^{\\ast}=1$, $n_{\\mathrm{A,GGA}}^{\\ast}=\\frac{1}{2}$, $E_{\\mathrm{GGA}}^{\\min}=-0.5+0.1\\cdot\\frac{1}{2}=-0.45$.\n- For $( -0.48, -0.52, 0.1 )$: $E_{\\mathrm{exact}}^{\\min}=-0.52$, $n_{\\mathrm{A,exact}}^{\\ast}=0$, $n_{\\mathrm{A,GGA}}^{\\ast}=\\frac{1}{2}+\\frac{-0.52-(-0.48)}{4\\cdot 0.1}=0.4$, and $E_{\\mathrm{GGA}}^{\\min}=-0.504+0.1\\cdot 0.52=-0.452$.\n- For $( -0.3, -0.7, 0.1 )$: $E_{\\mathrm{exact}}^{\\min}=-0.7$, $n_{\\mathrm{A,exact}}^{\\ast}=0$, unconstrained $n_{\\mathrm{A}}^{\\mathrm{uncon}}=-0.5$, so $n_{\\mathrm{A,GGA}}^{\\ast}=0$, and $E_{\\mathrm{GGA}}^{\\min}=-0.7+0.1=-0.6$.\n- For $( -0.48, -0.52, 0.01 )$: $E_{\\mathrm{exact}}^{\\min}=-0.52$, $n_{\\mathrm{A,exact}}^{\\ast}=0$, unconstrained $n_{\\mathrm{A}}^{\\mathrm{uncon}}=-0.5$, so $n_{\\mathrm{A,GGA}}^{\\ast}=0$, and $E_{\\mathrm{GGA}}^{\\min}=-0.52+0.01=-0.51$.\n- For $( -0.5, -0.5, 0.001 )$: $E_{\\mathrm{exact}}^{\\min}=-0.5$, $n_{\\mathrm{A,exact}}^{\\ast}=1$, $n_{\\mathrm{A,GGA}}^{\\ast}=\\frac{1}{2}$, and $E_{\\mathrm{GGA}}^{\\min}=-0.5+0.001\\cdot\\frac{1}{2}=-0.4995$.\n\nThe program will reproduce these values to six decimal places and format them as a single flat list as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef clamp(x, lo, hi):\n    return max(lo, min(hi, x))\n\ndef exact_min_energy_and_occupation(eA, eB):\n    # Exact: piecewise linear, minimize at boundaries.\n    if eA  eB:\n        nA = 1.0\n        E = eA\n    elif eB  eA:\n        nA = 0.0\n        E = eB\n    else:\n        # Degenerate symmetric case: choose localized branch on A by convention.\n        nA = 1.0\n        E = eA  # equals eB\n    return E, nA\n\ndef gga_min_energy_and_occupation(eA, eB, alpha):\n    # Unconstrained minimizer for quadratic energy\n    n_uncon = 0.5 + (eB - eA) / (4.0 * alpha)\n    nA = clamp(n_uncon, 0.0, 1.0)\n    # Energy at minimizer\n    E = nA * eA + (1.0 - nA) * eB + alpha * (nA**2 + (1.0 - nA)**2)\n    return E, nA\n\ndef solve():\n    # Define the test cases from the problem statement: (eA, eB, alpha), in Hartree.\n    test_cases = [\n        (-0.5,   -0.5,  0.1),\n        (-0.48,  -0.52, 0.1),\n        (-0.3,   -0.7,  0.1),\n        (-0.48,  -0.52, 0.01),\n        (-0.5,   -0.5,  0.001),\n    ]\n\n    results = []\n    for eA, eB, alpha in test_cases:\n        E_exact, n_exact = exact_min_energy_and_occupation(eA, eB)\n        E_gga, n_gga = gga_min_energy_and_occupation(eA, eB, alpha)\n        # Append rounded values as strings to control formatting and avoid spaces.\n        results.extend([\n            f\"{E_exact:.6f}\",\n            f\"{n_exact:.6f}\",\n            f\"{E_gga:.6f}\",\n            f\"{n_gga:.6f}\",\n        ])\n\n    # Final print statement in the exact required format (single line, no extra spaces).\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2804468"}, {"introduction": "The errors we've examined have profound consequences in practical calculations, particularly in describing chemical bond breaking. This final practice explores how these errors manifest in the dissociation of a two-electron system like $\\text{H}_{2}$ and how a computational strategy—spin symmetry breaking—can serve as a partial remedy. By analyzing various scenarios, you will learn to distinguish when a broken-symmetry solution is a mere artifact for correcting functional errors versus when it represents a physically meaningful state, a critical skill for any practitioner of DFT [@problem_id:2804491].", "problem": "Consider a stretched diatomic system at internuclear separation $R \\to \\infty$, composed of two identical fragments $A$ and $B$. Let the total electron number be $N_{\\text{tot}} = 2$. In Kohn–Sham density functional theory (DFT), the total energy is a functional of the spin densities $n_{\\uparrow}(\\mathbf{r})$ and $n_{\\downarrow}(\\mathbf{r})$, and includes the classical Hartree energy\n$$\nE_{\\mathrm{H}}[n] = \\dfrac{1}{2} \\iint \\dfrac{n(\\mathbf{r}) \\, n(\\mathbf{r}')}{\\lvert \\mathbf{r} - \\mathbf{r}' \\rvert} \\, d\\mathbf{r} \\, d\\mathbf{r}' \\, ,\n$$\ntogether with an exchange–correlation functional $E_{\\mathrm{xc}}[n_{\\uparrow}, n_{\\downarrow}]$. The exact functional satisfies the one-electron self-interaction condition: for any one-electron density $n_{1}(\\mathbf{r})$ placed entirely in a single spin channel, $E_{\\mathrm{H}}[n_{1}] + E_{\\mathrm{xc}}[n_{1}, 0] = 0$. Many commonly used semilocal approximations violate this, which is known as self-interaction error (SIE). In addition, the Perdew–Parr–Levy–Balduz (PPLB) condition states that the exact ground-state energy $E(N)$ as a function of (possibly fractional) electron number $N$ is piecewise linear between integers.\n\nFor $R \\to \\infty$, the fragments are noninteracting, so minimizing the total energy with respect to the spin densities on $A$ and $B$ subject to the constraint $N_{\\text{tot}} = 2$ can be analyzed in terms of fragment electron numbers $N_A$ and $N_B$ with $N_A + N_B = 2$. Restricted Kohn–Sham solutions enforce $n_{\\uparrow}(\\mathbf{r}) = n_{\\downarrow}(\\mathbf{r})$, while unrestricted Kohn–Sham solutions allow $n_{\\uparrow}(\\mathbf{r}) \\neq n_{\\downarrow}(\\mathbf{r})$, potentially breaking spin symmetry.\n\nUsing only these definitions and conditions as the starting point, reason about how symmetry breaking can alter the balance between localization and delocalization of electrons on the fragments, and how this interacts with SIE and delocalization error (deviation from PPLB piecewise linearity). Then answer the following multiple-choice question by selecting all correct statements.\n\nWhich of the following statements are correct?\n\nA. For the stretched $\\text{H}_{2}$ molecule with $N_{\\text{tot}} = 2$, an unrestricted Kohn–Sham solution that breaks spin symmetry can localize one electron with spin-$\\uparrow$ on fragment $A$ and one electron with spin-$\\downarrow$ on fragment $B$. This avoids fractional spins on each atom, mitigates delocalization and static-correlation related errors, and improves the dissociation energy toward the exact limit, although the spin density is not that of the exact pure singlet state.\n\nB. In one-electron systems such as $\\text{H}_{2}^{+}$ at any $R$, commonly used semilocal functionals are free of self-interaction error by construction, so symmetry breaking cannot improve the description and generically worsens the energy.\n\nC. For a finite, symmetric molecule whose exact nonrelativistic Hamiltonian commutes with total spin and spatial symmetry operators, a broken-symmetry Kohn–Sham determinant at $R \\to \\infty$ represents a physically meaningful pure ground state that spontaneously breaks spin symmetry; enforcing symmetry necessarily yields unphysical densities.\n\nD. In extended solids with antiferromagnetic order, spin symmetry-broken Kohn–Sham solutions can be physically meaningful in the thermodynamic limit, and the associated localization of $d$ or $f$ electrons often reduces delocalization errors linked to self-interaction in semilocal functionals.\n\nE. If an approximate $E(N)$ is convex between integers, distributing a fractional electron equally between two distant fragments strictly lowers the energy relative to localizing the electron on one fragment. Allowing spin-symmetry breaking cannot alter this conclusion because the energy depends only on the total density and not on its spin decomposition.\n\nSelect all that apply. Justify your choices by reasoning from the PPLB condition, the one-electron self-interaction condition, and the structure of restricted versus unrestricted Kohn–Sham descriptions at $R \\to \\infty$.", "solution": "The problem statement is critically validated. All given definitions and conditions—the system of two separated identical fragments with a total of $N_{\\text{tot}} = 2$ electrons, the form of the Hartree energy $E_{\\mathrm{H}}$, the one-electron self-interaction condition, the Perdew–Parr–Levy–Balduz (PPLB) condition, and the distinction between restricted and unrestricted Kohn–Sham (KS) methods—are standard, scientifically sound, and well-established concepts in density functional theory (DFT). The problem is well-posed, objective, and directly pertains to the topic of self-interaction and delocalization errors. Therefore, the problem is valid, and a solution can be derived.\n\nThe core of the problem lies in analyzing the dissociation of a two-electron diatomic molecule ($N_{\\text{tot}} = 2$) into two identical, non-interacting fragments ($A$ and $B$) at separation $R \\to \\infty$. The exact ground state of such a system (e.g., $\\text{H}_2$) is a spin singlet with total spin $S=0$, where one electron is localized on fragment $A$ and the other on fragment $B$. The total energy is exactly the sum of the energies of the two isolated one-electron fragments, $E_{\\text{exact}} = 2 E(\\text{fragment})$.\n\nWe now analyze the behavior of approximate DFT functionals in this limit.\n\nA restricted Kohn–Sham (RKS) calculation imposes the constraint $n_{\\uparrow}(\\mathbf{r}) = n_{\\downarrow}(\\mathbf{r})$. For a symmetric system of two fragments, this forces the density to be delocalized over both fragments. The lowest-energy KS orbital is a symmetric combination of fragment orbitals, and it is occupied by two electrons. At large separation $R$, the total density is approximately $n(\\mathbf{r}) \\approx n_A(\\mathbf{r}) + n_B(\\mathbf{r})$, where $n_A$ and $n_B$ are atomic-like densities. This corresponds to a total of $N_A = 1$ electron on fragment $A$ and $N_B = 1$ electron on fragment $B$. However, the RKS constraint implies that on each fragment, the density is composed of half of a spin-$\\uparrow$ electron and half of a spin-$\\downarrow$ electron (i.e., $N_{A,\\uparrow} = N_{A,\\downarrow} = 1/2$). This is an unphysical description of a one-electron fragment (like a hydrogen atom). This incorrect description is a manifestation of static (or strong) correlation error. For approximate functionals that suffer from delocalization error (i.e., their energy-vs-particle-number curve $E(N)$ is convex), the RKS energy at dissociation, $E_{\\text{RKS}}(R \\to \\infty)$, is significantly higher than the correct limit of $2 E(\\text{fragment})$.\n\nAn unrestricted Kohn–Sham (UKS) calculation allows $n_{\\uparrow}(\\mathbf{r}) \\neq n_{\\downarrow}(\\mathbf{r})$. This additional freedom allows the system to break the spin symmetry. A lower-energy solution can be found where one electron with spin-$\\uparrow$ localizes on fragment $A$ ($N_{A,\\uparrow}=1, N_{A,\\downarrow}=0$) and the other electron with spin-$\\downarrow$ localizes on fragment $B$ ($N_{B,\\uparrow}=0, N_{B,\\downarrow}=1$). The total energy is then $E_{\\text{UKS}} = E_{\\text{fragment}, A}[n_{A,\\uparrow}, 0] + E_{\\text{fragment}, B}[0, n_{B,\\downarrow}]$. Since the fragments are identical, this becomes $E_{\\text{UKS}} = 2 E_{\\text{approx}}(\\text{fragment})$. This energy correctly approaches the dissociation limit (as calculated by that approximate functional for the fragment). This process of localizing integer numbers of electrons with definite spin on each fragment avoids the unphysical fractional-spin description of the RKS solution and dramatically lowers the total energy, thus correcting for the static correlation error. The price is that the resulting UKS wavefunction is not a pure spin singlet and has an unphysical non-zero spin density, $n_S(\\mathbf{r}) = n_{\\uparrow}(\\mathbf{r}) - n_{\\downarrow}(\\mathbf{r}) \\neq 0$, whereas the true singlet ground state has $n_S(\\mathbf{r}) = 0$.\n\nWith this understanding, we evaluate each option.\n\n**A. For the stretched $\\text{H}_{2}$ molecule with $N_{\\text{tot}} = 2$, an unrestricted Kohn–Sham solution that breaks spin symmetry can localize one electron with spin-$\\uparrow$ on fragment $A$ and one electron with spin-$\\downarrow$ on fragment $B$. This avoids fractional spins on each atom, mitigates delocalization and static-correlation related errors, and improves the dissociation energy toward the exact limit, although the spin density is not that of the exact pure singlet state.**\n\nThis statement accurately summarizes the discussion above. The UKS solution for stretched $\\text{H}_2$ indeed localizes integer-spin electrons on each atom. This avoids the unphysical state of the RKS solution where each atom has fractional spins ($N_{\\uparrow}=1/2, N_{\\downarrow}=1/2$). This localization is the mechanism by which UKS mitigates the massive static correlation error present in the RKS description, leading to a much-improved dissociation energy that approaches $2 \\times E(\\text{H atom})$. The resulting UKS state is a broken-symmetry state, and its non-zero spin density is indeed different from the zero spin density of the true singlet ground state. Therefore, this statement is **Correct**.\n\n**B. In one-electron systems such as $\\text{H}_{2}^{+}$ at any $R$, commonly used semilocal functionals are free of self-interaction error by construction, so symmetry breaking cannot improve the description and generically worsens the energy.**\n\nThe premise of this statement is false. The one-electron self-interaction error (SIE) is defined by the non-cancellation of the Hartree energy and the exchange-correlation energy for a one-electron density, i.e., $E_{\\mathrm{H}}[n_1] + E_{\\mathrm{xc}}[n_1, 0] \\neq 0$. Commonly used semilocal functionals, such as those based on the Local Density Approximation (LDA) or Generalized Gradient Approximations (GGAs), are well-known to suffer from one-electron SIE. For instance, the calculated energy of a hydrogen atom is incorrect precisely because of this residual self-interaction. The statement that they are \"free of self-interaction error by construction\" is incorrect. While the conclusion that symmetry breaking does not improve the description of $\\text{H}_2^{+}$ is true (the symmetric, delocalized state is lower in energy even with approximate functionals), the justification provided is false. Therefore, this statement is **Incorrect**.\n\n**C. For a finite, symmetric molecule whose exact nonrelativistic Hamiltonian commutes with total spin and spatial symmetry operators, a broken-symmetry Kohn–Sham determinant at $R \\to \\infty$ represents a physically meaningful pure ground state that spontaneously breaks spin symmetry; enforcing symmetry necessarily yields unphysical densities.**\n\nThis statement contains a fundamental misconception. For a finite system, the exact eigenstates of the Hamiltonian must possess the same symmetries as the Hamiltonian. The ground state of $\\text{H}_2$ is a pure singlet state ($S=0$) and does not \"spontaneously break spin symmetry.\" The broken-symmetry UKS determinant is a mathematical construct within an approximate theory (single-determinant KS-DFT) that provides a better energy by mixing spin states (e.g., singlet and triplet). It does not represent a \"physically meaningful pure ground state.\" Spontaneous symmetry breaking is a concept that applies rigorously in the thermodynamic limit (infinite systems), not to individual finite molecules. The broken-symmetry KS state is a useful approximation, but it is not the physical reality. Therefore, this statement is **Incorrect**.\n\n**D. In extended solids with antiferromagnetic order, spin symmetry-broken Kohn–Sham solutions can be physically meaningful in the thermodynamic limit, and the associated localization of $d$ or $f$ electrons often reduces delocalization errors linked to self-interaction in semilocal functionals.**\n\nIn contrast to finite molecules, extended systems can exhibit true spontaneous symmetry breaking in the thermodynamic limit. Antiferromagnetism is a prime example, where the physical ground state possesses a magnetic order that breaks the spin-rotational symmetry of the underlying Hamiltonian. A spin symmetry-broken KS calculation is therefore the physically correct approach to model such a state. For many materials with strongly correlated $d$ or $f$ electrons (e.g., Mott insulators), a non-spin-polarized or ferromagnetic calculation with a semilocal functional erroneously predicts a metallic state due to the delocalization error inherent in the functional. By allowing for an antiferromagnetic (AFM) broken-symmetry solution, the electrons are allowed to localize on specific atomic sites with opposing spins. This localization correctly opens a band gap, rectifying the qualitative failure of the more symmetric calculation and mitigating the functional's delocalization error. Thus, the statement is a correct description of the role and success of broken-symmetry DFT in solid-state physics. Therefore, this statement is **Correct**.\n\n**E. If an approximate $E(N)$ is convex between integers, distributing a fractional electron equally between two distant fragments strictly lowers the energy relative to localizing the electron on one fragment. Allowing spin-symmetry breaking cannot alter this conclusion because the energy depends only on the total density and not on its spin decomposition.**\n\nThe first part of the statement is a direct consequence of the definition of convexity. For a convex function $E(N)$, $E(N_A) + E(N_B)$ is minimized when the charges are distributed, e.g., for one electron, $2 E(1/2)  E(1)$. However, the justification in the second part is fundamentally false. In spin-DFT, the total energy is a functional of the spin densities, $E[n_{\\uparrow}, n_{\\downarrow}]$. The exchange-correlation functional $E_{\\mathrm{xc}}[n_{\\uparrow}, n_{\\downarrow}]$ explicitly depends on both spin densities, not just the total density $n = n_{\\uparrow} + n_{\\downarrow}$. Allowing spin-symmetry breaking ($n_{\\uparrow} \\neq n_{\\downarrow}$) provides additional variational flexibility. For a given total density, different spin decompositions can lead to different energies. As shown in the analysis for stretched $\\text{H}_2$, breaking spin symmetry (UKS) allows the system to find a much lower energy than the spin-restricted (RKS) solution, even when the total density $n(\\mathbf{r})$ is largely the same. The change in spin decomposition is precisely what remedies the static correlation error. The claim that spin-symmetry breaking cannot alter the energetic balance because the energy only depends on total density is incorrect. Therefore, this statement is **Incorrect**.", "answer": "$$\\boxed{AD}$$", "id": "2804491"}]}