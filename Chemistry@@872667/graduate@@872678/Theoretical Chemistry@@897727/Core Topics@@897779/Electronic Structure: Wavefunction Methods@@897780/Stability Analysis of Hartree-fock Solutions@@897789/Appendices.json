{"hands_on_practices": [{"introduction": "This first practice strips down the complex machinery of stability analysis to its mathematical essence. By analyzing a simplified $2 \\times 2$ matrix representing a single mode in the Random Phase Approximation (RPA), also known as Time-Dependent Hartree-Fock (TDHF), you will analytically derive the conditions under which an instability arises. This exercise reveals how an imaginary excitation energy, the hallmark of a dynamic instability, emerges from the interplay between the diagonal term $A$ (related to orbital energy gaps) and the off-diagonal coupling term $B$ (related to electron repulsion integrals), providing the fundamental intuition for why certain Hartree-Fock solutions can be unstable points on the energy surface rather than true minima [@problem_id:2808285].", "problem": "Consider the linear stability analysis of a stationary Hartree–Fock (HF) solution via Time-Dependent Hartree–Fock (TDHF), also known as the Random Phase Approximation (RPA). In this framework, small-amplitude oscillations around the HF stationary point are governed by an RPA eigenvalue problem constructed from the Hessian of the HF energy with respect to orbital rotations. For a single particle–hole mode, the orbital-rotation Hessian reduces to a scalar block structure, and the corresponding RPA dynamic matrix becomes a $2 \\times 2$ matrix with real scalar entries $A$ and $B$, where $A$ represents the diagonal (direct) block and $B$ the coupling (exchange) block. Assume $A$ and $B$ are real and that $A \\ge 0$, consistent with the physical interpretation of $A$ as a single-particle energy gap corrected by Coulomb terms.\n\nStarting from the RPA linear response equation as a standard eigenvalue problem for the $2 \\times 2$ dynamic matrix,\n\n$$\n\\begin{pmatrix}\nA  B \\\\\n- B  -A\n\\end{pmatrix}\n\\begin{pmatrix}\nX \\\\ Y\n\\end{pmatrix}\n= \\omega\n\\begin{pmatrix}\nX \\\\ Y\n\\end{pmatrix},\n$$\n\nperform the following:\n\n1. Derive the characteristic polynomial and solve analytically for the two eigenvalues $\\omega_{+}$ and $\\omega_{-}$ as closed-form expressions in terms of $A$ and $B$.\n2. Using the physical requirement that a dynamically stable HF stationary point has real excitation frequencies, deduce the regime in which the HF solution is unstable and express it in terms of $A$ and $|B|$.\n\nProvide, as your final answer, the pair of eigenvalues $\\left(\\omega_{+}, \\omega_{-}\\right)$ in closed form as a function of $A$ and $B$. No numerical evaluation is required, and no units are needed. The instability condition should be justified in your derivation but should not be included in the final boxed answer.", "solution": "The problem presented is a standard eigenvalue problem in the context of the Random Phase Approximation (RPA) used in quantum chemistry to assess the stability of a Hartree-Fock (HF) ground state. The problem is well-posed, scientifically grounded, and contains all necessary information for its resolution. I will proceed with the derivation.\n\nThe RPA dynamic matrix is given as:\n$$\n\\mathbf{M} = \\begin{pmatrix}\nA  B \\\\\n-B  -A\n\\end{pmatrix}\n$$\nwhere $A$ and $B$ are real scalars and it is given that $A \\ge 0$. The eigenvalues $\\omega$ of this matrix represent the excitation frequencies of the system. They are determined by solving the characteristic equation, which is derived from the secular determinant:\n$$\n\\det(\\mathbf{M} - \\omega\\mathbf{I}) = 0\n$$\nHere, $\\mathbf{I}$ is the $2 \\times 2$ identity matrix. Substituting the matrices, we have:\n$$\n\\det \\begin{pmatrix}\nA - \\omega  B \\\\\n-B  -A - \\omega\n\\end{pmatrix} = 0\n$$\nThe determinant is calculated as:\n$$\n(A - \\omega)(-A - \\omega) - (B)(-B) = 0\n$$\nExpanding the terms, we obtain the characteristic polynomial in $\\omega$:\n$$\n-(A - \\omega)(A + \\omega) + B^2 = 0\n$$\n$$\n-(A^2 - \\omega^2) + B^2 = 0\n$$\n$$\n-A^2 + \\omega^2 + B^2 = 0\n$$\nRearranging this equation gives the characteristic equation for the eigenvalues:\n$$\n\\omega^2 = A^2 - B^2\n$$\nThis is the first part of the required derivation, showing the characteristic polynomial (or rather, the resulting equation for the eigenvalues). We now solve for the two eigenvalues, which we denote as $\\omega_{+}$ and $\\omega_{-}$:\n$$\n\\omega = \\pm \\sqrt{A^2 - B^2}\n$$\nThus, the two eigenvalues are:\n$$\n\\omega_{+} = \\sqrt{A^2 - B^2}\n$$\n$$\n\\omega_{-} = - \\sqrt{A^2 - B^2}\n$$\nThis completes the first task.\n\nFor the second task, we analyze the stability of the HF stationary point. A fundamental principle of linear stability analysis is that a stationary point is stable if small perturbations do not grow exponentially in time. In the context of TDHF/RPA, the time evolution of a perturbation mode with frequency $\\omega$ is proportional to $\\exp(-i\\omega t)$. If $\\omega$ is real, the mode oscillates and the stationary point is stable with respect to this mode. If $\\omega$ has a positive imaginary part, $\\omega = \\omega_{\\text{Re}} + i\\omega_{\\text{Im}}$ with $\\omega_{\\text{Im}}  0$, then the time evolution factor becomes $\\exp(-i\\omega_{\\text{Re}}t)\\exp(\\omega_{\\text{Im}}t)$, which leads to exponential growth. This signifies an instability.\n\nThe eigenvalues we derived are $\\omega = \\pm \\sqrt{A^2 - B^2}$.\nFor the eigenvalues to be real, the quantity under the square root must be non-negative:\n$$\nA^2 - B^2 \\ge 0\n$$\nThis inequality can be rewritten as $A^2 \\ge B^2$. Taking the square root of both sides and using the given condition that $A \\ge 0$, we find the condition for stability:\n$$\nA \\ge |B|\n$$\nConversely, the HF solution is unstable if the eigenvalues are not real. In our case, this occurs when the quantity under the square root is negative:\n$$\nA^2 - B^2  0\n$$\nWhen this condition holds, the eigenvalues become purely imaginary:\n$$\n\\omega = \\pm i \\sqrt{B^2 - A^2}\n$$\nAn imaginary eigenvalue corresponds to an exponentially growing or decaying mode, which signifies a dynamic instability of the HF stationary point. Therefore, the regime in which the HF solution is unstable is defined by the inequality:\n$$\nA^2  B^2\n$$\nAgain using the fact that $A \\ge 0$, this condition is equivalent to:\n$$\nA  |B|\n$$\nThis is the condition for instability, as requested. The final answer requires only the expressions for the eigenvalues.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{A^2 - B^2}  - \\sqrt{A^2 - B^2} \\end{pmatrix}}\n$$", "id": "2808285"}, {"introduction": "Building on the abstract concept of instability, this practice explores its most famous physical manifestation: the failure of Restricted Hartree-Fock (RHF) to correctly describe the dissociation of a chemical bond. You will work with the two-site Hubbard model for the H₂ molecule, a canonical system for understanding electron correlation effects. This exercise will guide you through deriving the energy for both the RHF and a symmetry-broken Unrestricted Hartree-Fock (UHF) solution, culminating in the identification of the Coulson-Fischer point—the critical bond length where the RHF wavefunction becomes unstable with respect to spin-symmetry breaking [@problem_id:2921439]. This connects the mathematical formalism of stability analysis to the crucial chemical concept of static correlation.", "problem": "Consider a two-site minimal-basis model for the hydrogen molecule, with one orthonormalized atomic orbital on each nucleus, $\\chi_{A}$ and $\\chi_{B}$. Define the symmetric (bonding) and antisymmetric (antibonding) molecular orbitals as $\\psi_{g} = (\\chi_{A}+\\chi_{B})/\\sqrt{2}$ and $\\psi_{u} = (\\chi_{A}-\\chi_{B})/\\sqrt{2}$. Work within the following scientifically standard approximations that capture the essential physics of symmetry breaking in Hartree-Fock theory:\n- The one-electron (core) integrals satisfy $h_{AA}(R)=h_{BB}(R)=\\alpha(R)$ and $h_{AB}(R)=h_{BA}(R)=t(R)$ with $t(R)  0$. Consequently, $h_{gg}(R)=\\alpha(R)+t(R)$ and $h_{uu}(R)=\\alpha(R)-t(R)$.\n- Retain only the on-site two-electron Coulomb integral $U(R) \\equiv (AA|AA) = (BB|BB)$, and neglect all intersite two-electron integrals such as $(AA|BB)$ and $(AB|BA)$. This is the standard Hubbard-like minimal model with zero differential overlap.\n- Use the Hartree-Fock (HF) energy functional and the definitions of restricted Hartree-Fock (RHF) and unrestricted Hartree-Fock (UHF) to derive results. Do not assume any target condition in advance.\n\nTasks:\n1) Starting from the HF energy expression for a closed-shell determinant, construct the RHF energy $E_{\\mathrm{RHF}}(R)$ for two electrons doubly occupying $\\psi_{g}$. Express $E_{\\mathrm{RHF}}(R)$ in terms of $\\alpha(R)$, $t(R)$, and $U(R)$.\n2) Consider the broken-symmetry UHF determinant in which the spin-up electron is localized on site $A$ and the spin-down electron on site $B$. Construct the corresponding UHF energy $E_{\\mathrm{UHF}}(R)$ within the same approximations.\n3) Using the $R \\to \\infty$ behavior of $t(R)$ and $U(R)$, explain why RHF fails to describe the dissociation limit correctly in this model, while the UHF broken-symmetry state captures the correct limit.\n4) Analyze the stability of the RHF solution against spin-symmetry breaking by considering an infinitesimal spin-unrestricted mixing of $\\psi_{g}$ and $\\psi_{u}$. Derive the analytic condition (the Coulson–Fischer point) for the onset of instability in this two-orbital, one-occupied–one-virtual subspace, and obtain an explicit criterion involving $t(R)$ and $U(R)$ only.\n5) Assume the following physically reasonable parametrizations and constants:\n   - $t(R) = -t_{0} \\exp(-a R)$ with $t_{0} = 24.0$ eV and $a = 1.45$ Å$^{-1}$,\n   - $U(R) \\approx U_{0}$ with $U_{0} = 16.0$ eV independent of $R$ over the range of interest.\n   Use your instability criterion from part 4 to solve for the critical bond length $R_{c}$ at which the RHF solution becomes unstable to UHF symmetry breaking. Express the final numerical value of $R_{c}$ in angstroms. Round your answer to four significant figures.", "solution": "The problem as stated is a standard, well-posed problem in theoretical chemistry. It is scientifically grounded, internally consistent, and contains all necessary information to derive the requested results. It is therefore deemed valid.\n\nThe problem asks for an analysis of the Restricted Hartree-Fock (RHF) and Unrestricted Hartree-Fock (UHF) methods for a minimal model of the H$_2$ molecule, culminating in the calculation of the bond length at which the RHF solution becomes unstable.\n\n**1) Derivation of the RHF Energy**\n\nThe RHF wavefunction for the ground state of the H$_2$ molecule in this model is a single Slater determinant where two electrons, one spin-up ($\\alpha$) and one spin-down ($\\beta$), doubly occupy the bonding molecular orbital $\\psi_g$. The wavefunction is $\\Psi_{\\mathrm{RHF}} = |\\psi_g \\alpha, \\psi_g \\beta|$. The RHF energy functional for this two-electron closed-shell system is given by:\n$$\nE_{\\mathrm{RHF}} = 2 h_{gg} + J_{gg}\n$$\nwhere $h_{gg}$ is the one-electron core integral for an electron in $\\psi_g$, and $J_{gg}$ is the Coulomb repulsion integral between the two electrons in $\\psi_g$.\n\nThe problem provides $h_{gg}(R) = \\alpha(R) + t(R)$.\n\nThe Coulomb integral $J_{gg}$ is defined as $(\\psi_g \\psi_g|\\psi_g \\psi_g)$. We must express this in terms of the atomic orbital (AO) integrals. The MOs are $\\psi_g = \\frac{1}{\\sqrt{2}}(\\chi_A + \\chi_B)$ and $\\psi_u = \\frac{1}{\\sqrt{2}}(\\chi_A - \\chi_B)$.\n$$\nJ_{gg} = \\langle \\psi_g(1)\\psi_g(2) | \\frac{1}{r_{12}} | \\psi_g(1)\\psi_g(2) \\rangle\n$$\nSubstituting the definition of $\\psi_g$:\n$$\nJ_{gg} = \\frac{1}{4} \\langle (\\chi_A + \\chi_B)(1) (\\chi_A + \\chi_B)(2) | \\frac{1}{r_{12}} | (\\chi_A + \\chi_B)(1) (\\chi_A + \\chi_B)(2) \\rangle\n$$\nExpanding this expression leads to $16$ two-electron integrals in the AO basis. However, the problem specifies a zero differential overlap (ZDO) approximation where only on-site Coulomb integrals $(AA|AA)$ and $(BB|BB)$ are non-zero. Let $(ij|kl) \\equiv \\langle \\chi_i(1)\\chi_j(2) | r_{12}^{-1} | \\chi_k(1)\\chi_l(2) \\rangle$. The approximation implies that an integral is non-zero only if $i=k$ and $j=l$, and there are no overlap densities like $\\chi_A\\chi_B$. More formally, $(\\mu\\nu|\\lambda\\sigma) = \\delta_{\\mu\\nu}\\delta_{\\lambda\\sigma}(\\mu\\mu|\\lambda\\lambda)$. Following this, the expansion of $J_{gg}$ simplifies significantly:\n$$\nJ_{gg} = \\frac{1}{4} \\left[ (AA|AA) + (AA|BB) + (BB|AA) + (BB|BB) + \\text{other terms that are zero} \\right]\n$$\nWithin our approximations, $(AA|AA)=(BB|BB)=U(R)$ and intersite integrals like $(AA|BB)$ are zero.\n$$\nJ_{gg} = \\frac{1}{4} [U(R) + 0 + 0 + U(R)] = \\frac{1}{2} U(R)\n$$\nSubstituting the expressions for $h_{gg}$ and $J_{gg}$ into the energy formula, we obtain the RHF energy:\n$$\nE_{\\mathrm{RHF}}(R) = 2(\\alpha(R) + t(R)) + \\frac{1}{2}U(R)\n$$\n\n**2) Derivation of the UHF Energy**\n\nFor the broken-symmetry state, the UHF wavefunction places the spin-up electron on site $A$ and the spin-down electron on site $B$. The spatial orbitals are different for different spins: $\\psi^{\\alpha} = \\chi_A$ and $\\psi^{\\beta} = \\chi_B$. The wavefunction is $\\Psi_{\\mathrm{UHF}} = |\\chi_A \\alpha, \\chi_B \\beta|$. The energy for this single-determinant wavefunction is:\n$$\nE_{\\mathrm{UHF}} = h_{AA} + h_{BB} + J_{AB}\n$$\nwhere $h_{AA}$ and $h_{BB}$ are the core integrals for the respective atomic orbitals, and $J_{AB}$ is the Coulomb repulsion between an electron in $\\chi_A$ and an electron in $\\chi_B$. There is no exchange term because the electrons have opposite spins.\n\nFrom the problem givens:\n- $h_{AA} = \\alpha(R)$\n- $h_{BB} = \\alpha(R)$\n- $J_{AB} = (\\chi_A\\chi_A|\\chi_B\\chi_B) = (AA|BB)$. The problem states to neglect such intersite integrals, so $J_{AB}=0$.\n\nTherefore, the UHF energy is:\n$$\nE_{\\mathrm{UHF}}(R) = \\alpha(R) + \\alpha(R) + 0 = 2\\alpha(R)\n$$\n\n**3) Analysis of the Dissociation Limit ($R \\to \\infty$)**\n\nAs the bond length $R$ approaches infinity, the interaction between the two hydrogen atoms vanishes. This has the following consequences for our model parameters:\n- The hopping integral $t(R) = h_{AB}(R)$ goes to zero, as it depends on the overlap between $\\chi_A$ and $\\chi_B$: $\\lim_{R\\to\\infty} t(R) = 0$.\n- The on-site core integral $\\alpha(R) = h_{AA}(R)$ approaches the energy of an electron in an isolated hydrogen atom, which we can denote $E_H$.\n- The on-site repulsion $U(R)$ approaches a constant value $U_0$, the energy required to place two electrons on the same hydrogen atom (to form H$^-$).\n\nThe correct dissociation energy of H$_2$ is the sum of the energies of two separate hydrogen atoms: $2 E_H$.\n\nLet us examine the dissociation limit for the two energies we derived:\n- **RHF Limit**:\n$$\n\\lim_{R\\to\\infty} E_{\\mathrm{RHF}}(R) = \\lim_{R\\to\\infty} \\left[ 2(\\alpha(R) + t(R)) + \\frac{1}{2}U(R) \\right] = 2(E_H + 0) + \\frac{1}{2}U_0 = 2E_H + \\frac{1}{2}U_0\n$$\nThe RHF energy incorrectly dissociates to a state with energy $U_0/2$ above the correct limit. This is a well-known failure. The RHF wavefunction contains equal parts covalent (H-H) and ionic (H$^+$...H$^-$) configurations. At infinite separation, the ionic configurations are physically incorrect but persist in the RHF description, artificially raising the energy by half the ionic penalty $U_0$.\n\n- **UHF Limit**:\n$$\n\\lim_{R\\to\\infty} E_{\\mathrm{UHF}}(R) = \\lim_{R\\to\\infty} [2\\alpha(R)] = 2E_H\n$$\nThe broken-symmetry UHF solution correctly describes the dissociation into two neutral hydrogen atoms, one with spin-up and one with spin-down, yielding the correct dissociation energy.\n\n**4) RHF Instability Condition**\n\nThe RHF solution becomes unstable when a lower-energy solution can be found by breaking the spin symmetry. We can test for this by introducing a small spin-unrestricted perturbation to the RHF wavefunction and checking if the energy decreases. We define a new set of spin-orbitals by mixing the occupied RHF orbital $\\psi_g$ with the virtual RHF orbital $\\psi_u$, controlled by a parameter $\\theta$:\n$$\n\\psi^{\\alpha}(\\theta) = \\cos\\theta \\, \\psi_g + \\sin\\theta \\, \\psi_u\n$$\n$$\n\\psi^{\\beta}(\\theta) = \\cos\\theta \\, \\psi_g - \\sin\\theta \\, \\psi_u\n$$\nThe RHF solution corresponds to $\\theta=0$. The energy as a function of $\\theta$ is $E(\\theta) = h_{\\alpha\\alpha} + h_{\\beta\\beta} + J_{\\alpha\\beta}$.\nThe core-hamiltonian terms are:\n$$\nh_{\\alpha\\alpha} = \\langle \\psi^{\\alpha} | h | \\psi^{\\alpha} \\rangle = \\cos^2\\theta h_{gg} + \\sin^2\\theta h_{uu} + 2\\sin\\theta\\cos\\theta h_{gu}\n$$\nWe find $h_{gu} = \\frac{1}{2}\\langle \\chi_A+\\chi_B | h | \\chi_A-\\chi_B \\rangle = \\frac{1}{2}(h_{AA}-h_{AB}+h_{BA}-h_{BB})=0$. So, $h_{\\alpha\\alpha} = \\cos^2\\theta h_{gg} + \\sin^2\\theta h_{uu}$. Similarly, $h_{\\beta\\beta} = \\cos^2\\theta h_{gg} + \\sin^2\\theta h_{uu}$.\nThe Coulomb term $J_{\\alpha\\beta} = (\\psi^{\\alpha}\\psi^{\\alpha}|\\psi^{\\beta}\\psi^{\\beta})$ is calculated by expanding the orbitals in the AO basis and applying the ZDO approximation, as in part 1. This yields $J_{\\alpha\\beta} = \\frac{U}{2} \\cos^2(2\\theta)$.\nThe total energy is:\n$$\nE(\\theta) = 2(\\cos^2\\theta h_{gg} + \\sin^2\\theta h_{uu}) + \\frac{U}{2}\\cos^2(2\\theta)\n$$\nUsing $h_{gg}=\\alpha+t$, $h_{uu}=\\alpha-t$, $\\cos^2\\theta = \\frac{1+\\cos(2\\theta)}{2}$, $\\sin^2\\theta = \\frac{1-\\cos(2\\theta)}{2}$:\n$$\nE(\\theta) = 2(\\alpha+t\\cos(2\\theta)) + \\frac{U}{2}\\cos^2(2\\theta)\n$$\nThe RHF solution at $\\theta=0$ is an extremum. To check for stability, we examine the second derivative $E''(\\theta)$ at $\\theta=0$.\n$$\n\\frac{dE}{d\\theta} = -4t\\sin(2\\theta) - U\\cos(2\\theta)\\sin(2\\theta)\n$$\n$$\n\\frac{d^2E}{d\\theta^2} = -8t\\cos(2\\theta) - 2U(\\cos^2(2\\theta)-\\sin^2(2\\theta)) = -8t\\cos(2\\theta) - 2U\\cos(4\\theta)\n$$\nEvaluating at $\\theta=0$:\n$$\nE''(0) = -8t - 2U\n$$\nThe RHF solution is stable if $E''(0)  0$. It becomes unstable at the point where $E''(0) \\le 0$. The Coulson-Fischer point is where $E''(0)=0$.\n$$\n-8t(R) - 2U(R) = 0 \\implies -4t(R) = U(R)\n$$\nSince $t(R)$ is negative, we can write the condition in terms of its magnitude $|t(R)|=-t(R)$:\n$$\n4|t(R)| = U(R)\n$$\nThis is the analytic condition for the onset of the RHF instability.\n\n**5) Calculation of the Critical Bond Length $R_c$**\n\nWe are given the parametrizations:\n- $t(R) = -t_0 \\exp(-a R)$ with $t_0 = 24.0$ eV and $a = 1.45$ Å$^{-1}$. Thus, $|t(R)| = 24.0 \\exp(-1.45 R)$.\n- $U(R) \\approx U_0 = 16.0$ eV.\n\nWe substitute these into the instability condition to find the critical bond length $R_c$:\n$$\n4 |t(R_c)| = U_0\n$$\n$$\n4 \\left( 24.0 \\exp(-1.45 R_c) \\right) = 16.0\n$$\n$$\n96.0 \\exp(-1.45 R_c) = 16.0\n$$\n$$\n\\exp(-1.45 R_c) = \\frac{16.0}{96.0} = \\frac{1}{6}\n$$\nTo solve for $R_c$, we take the natural logarithm of both sides:\n$$\n-1.45 R_c = \\ln\\left(\\frac{1}{6}\\right) = -\\ln(6)\n$$\n$$\nR_c = \\frac{\\ln(6)}{1.45}\n$$\nUsing the value $\\ln(6) \\approx 1.791759$:\n$$\nR_c \\approx \\frac{1.791759}{1.45} \\approx 1.235696 \\text{ Å}\n$$\nRounding to four significant figures as requested, the critical bond length is $1.236$ Å.", "answer": "$$\\boxed{1.236}$$", "id": "2921439"}, {"introduction": "In practical quantum chemistry calculations, identifying an instability is only the first step; the ultimate goal is to find the true electronic ground state. This final practice addresses the diagnostic challenge of what to do after an instability is found. You will be given an abstract orbital-rotation Hessian from a hypothetical Self-Consistent Field (SCF) calculation and tasked with diagnosing the root cause of the instability [@problem_id:2808380]. By decomposing the Hessian's lowest eigenvalue into contributions from orbital energy gaps and electron-electron coupling, you will learn to distinguish between instabilities caused by near-degeneracies versus those driven by strong correlation effects, and in turn, select the appropriate computational remedy, such as level-shifting or re-initializing the calculation with a symmetry-broken guess.", "problem": "Consider the stability of solutions obtained from a Self-Consistent Field (SCF) procedure within the Hartree-Fock (HF) approximation. A stationary HF solution is a local minimum of the electronic energy with respect to orbital rotations if and only if the second variation (the orbital-rotation Hessian) is positive semi-definite in the space of occupied-to-virtual rotations. In a minimal abstraction, the second-order change in energy along a rotation direction represented by a real vector $\\mathbf{x}$ can be written as a quadratic form composed of two contributions: a diagonal contribution from orbital energy differences and a coupling contribution from electron-electron interactions. In this abstraction, the total quadratic form for each test case is fully specified by:\n- A set of occupied orbital energies $\\{\\varepsilon_i\\}$ and virtual orbital energies $\\{\\varepsilon_a\\}$, both in Hartree.\n- A symmetric real coupling matrix $\\mathbf{K}$ of dimension $n_{\\text{rot}} \\times n_{\\text{rot}}$, where $n_{\\text{rot}} = n_{\\text{occ}} \\times n_{\\text{virt}}$, whose elements are in Hartree.\n- A real scalar channel parameter $\\gamma$ (dimensionless) that encodes whether the coupling increases or decreases curvature in the chosen stability channel.\n\nYour program must:\n- Construct the diagonal matrix $\\mathbf{D}$ with elements $D_{ia,ia} = \\Delta_{ia}$ where $\\Delta_{ia} = \\varepsilon_a - \\varepsilon_i$ in Hartree, using the composite index $r = i \\, n_{\\text{virt}} + a$ to map $(i,a)$ to a single index $r \\in \\{0,\\dots,n_{\\text{rot}}-1\\}$.\n- Assemble the symmetric orbital-rotation Hessian matrix $\\mathbf{H}$ such that its quadratic form along any real vector $\\mathbf{x}$ equals the sum of diagonal and coupling contributions, i.e., $\\mathbf{x}^\\top \\mathbf{H} \\mathbf{x} = \\mathbf{x}^\\top \\mathbf{D} \\mathbf{x} + \\gamma \\, \\mathbf{x}^\\top \\mathbf{K} \\mathbf{x}$. Use the symmetrized matrix $\\frac{1}{2}(\\mathbf{H} + \\mathbf{H}^\\top)$ in computations to eliminate any numerical asymmetry.\n- Compute the lowest (smallest) eigenvalue $\\lambda_{\\min}$ and a corresponding normalized eigenvector $\\mathbf{v}_{\\min}$ of $\\mathbf{H}$. Normalize $\\mathbf{v}_{\\min}$ to unit $\\ell_2$ norm.\n- Diagnose stability and propose a remedy based on the following logic grounded in the variational principle. Decompose the curvature along $\\mathbf{v}_{\\min}$ into diagonal and coupling parts: $c_{\\text{gap}} = \\mathbf{v}_{\\min}^\\top \\mathbf{D} \\mathbf{v}_{\\min}$ and $c_{\\text{cpl}} = \\mathbf{v}_{\\min}^\\top (\\gamma \\mathbf{K}) \\mathbf{v}_{\\min}$. Then:\n  - If $\\lambda_{\\min}  -0.05$ Hartree and $c_{\\text{cpl}}  0$ with $\\lvert c_{\\text{cpl}} \\rvert  c_{\\text{gap}} + 0.02$ Hartree, output the action code $2$ (reinitialize; e.g., different initial guess or symmetry-broken ansatz).\n  - Else if $\\lambda_{\\min}  0$ Hartree, or $\\lambda_{\\min} \\le 0.02$ Hartree, or $c_{\\text{gap}}  0.05$ Hartree, output the action code $1$ (apply level-shifting to increase virtual orbital energies).\n  - Else output the action code $0$ (the solution is stable; no remedy needed).\n- Report, for each test case, the lowest eigenpair and the suggested action. All energies must be expressed in Hartree and rounded to $6$ decimals. The eigenvector components are dimensionless and must be rounded to $6$ decimals.\n\nAngle units are not relevant. No percentages are involved.\n\nTest Suite. Use exactly the following three test cases, each with $n_{\\text{occ}} = 2$ and $n_{\\text{virt}} = 2$ (thus $n_{\\text{rot}} = 4$). The composite rotation index ordering is $r = 0 \\leftrightarrow (i=0,a=0)$, $r = 1 \\leftrightarrow (i=0,a=1)$, $r = 2 \\leftrightarrow (i=1,a=0)$, $r = 3 \\leftrightarrow (i=1,a=1)$.\n\n- Case $1$ (well-separated gaps; expected stable):\n  - $\\varepsilon_{\\text{occ}} = [-0.50, -0.30]$ Hartree.\n  - $\\varepsilon_{\\text{virt}} = [0.20, 0.50]$ Hartree.\n  - $\\gamma = +0.5$.\n  - $\\mathbf{K}$ in Hartree:\n    - Row $0$: $[0.01, 0.005, 0.004, 0.003]$,\n    - Row $1$: $[0.005, 0.01, 0.002, 0.004]$,\n    - Row $2$: $[0.004, 0.002, 0.01, 0.005]$,\n    - Row $3$: $[0.003, 0.004, 0.005, 0.01]$.\n- Case $2$ (near-degenerate gaps; expected need for level-shifting):\n  - $\\varepsilon_{\\text{occ}} = [-0.50, -0.49]$ Hartree.\n  - $\\varepsilon_{\\text{virt}} = [-0.45, -0.20]$ Hartree.\n  - $\\gamma = -0.4$.\n  - $\\mathbf{K}$ in Hartree:\n    - Row $0$: $[0.10, 0.04, 0.03, 0.02]$,\n    - Row $1$: $[0.04, 0.08, 0.02, 0.03]$,\n    - Row $2$: $[0.03, 0.02, 0.09, 0.04]$,\n    - Row $3$: $[0.02, 0.03, 0.04, 0.07]$.\n- Case $3$ (triplet-like strong coupling instability; expected reinitialization):\n  - $\\varepsilon_{\\text{occ}} = [-0.60, -0.50]$ Hartree.\n  - $\\varepsilon_{\\text{virt}} = [0.10, 0.20]$ Hartree.\n  - $\\gamma = -1.0$.\n  - $\\mathbf{K}$ in Hartree:\n    - Row $0$: $[0.20, 0.05, 0.04, 0.03]$,\n    - Row $1$: $[0.05, 0.20, 0.02, 0.04]$,\n    - Row $2$: $[0.04, 0.02, 0.75, 0.05]$,\n    - Row $3$: $[0.03, 0.04, 0.05, 0.20]$.\n\nFinal Output Format. Your program should produce a single line of output containing a single list with three nested lists, one per test case, each nested list containing:\n- First the lowest eigenvalue $\\lambda_{\\min}$ in Hartree rounded to $6$ decimals,\n- Then the $4$ components of the corresponding normalized eigenvector $\\mathbf{v}_{\\min}$ rounded to $6$ decimals in the rotation index order $[r=0,r=1,r=2,r=3]$,\n- Finally the integer action code as defined above.\n\nConcretely, the printed line must look like:\n- $[ [\\lambda^{(1)}_{\\min}, v^{(1)}_0, v^{(1)}_1, v^{(1)}_2, v^{(1)}_3, a^{(1)}], [\\lambda^{(2)}_{\\min}, v^{(2)}_0, v^{(2)}_1, v^{(2)}_2, v^{(2)}_3, a^{(2)}], [\\lambda^{(3)}_{\\min}, v^{(3)}_0, v^{(3)}_1, v^{(3)}_2, v^{(3)}_3, a^{(3)}] ]$\nwhere each $\\lambda^{(k)}_{\\min}$ and $v^{(k)}_r$ is rounded to $6$ decimals and each $a^{(k)} \\in \\{0,1,2\\}$ is an integer.", "solution": "The problem presented is a valid and well-posed exercise in computational theoretical chemistry. It concerns the stability analysis of a Hartree-Fock (HF) electronic structure solution, a fundamental topic in the field. All necessary data and procedural rules are provided, the context is scientifically sound, and the objective is clear. We shall therefore proceed with a complete solution.\n\nThe stability of a Self-Consistent Field (SCF) solution is determined by the curvature of the electronic energy functional with respect to variations in the molecular orbitals. For a solution to be a local minimum, the second-order variation of the energy must be non-negative for all allowed variations. In the context of orbital rotations between the occupied and virtual spaces, this second-order variation is represented by the orbital-rotation Hessian matrix, denoted here by $\\mathbf{H}$. The solution is stable if and only if $\\mathbf{H}$ is positive semi-definite.\n\nThe core of the problem is to construct and analyze this Hessian matrix for several test cases. The total energy variation, expressed as a quadratic form $\\mathbf{x}^\\top \\mathbf{H} \\mathbf{x}$ for a rotation vector $\\mathbf{x}$, is given as the sum of two distinct physical contributions:\n$1$. A diagonal term, $\\mathbf{x}^\\top \\mathbf{D} \\mathbf{x}$, which arises from the energy differences between the virtual and occupied orbitals being mixed.\n$2$. A coupling term, $\\gamma \\, \\mathbf{x}^\\top \\mathbf{K} \\mathbf{x}$, which accounts for the change in electron-electron repulsion energy due to the orbital rotation.\n\nFollowing the problem specification, the Hessian matrix $\\mathbf{H}$ is assembled as:\n$$\n\\mathbf{H} = \\mathbf{D} + \\gamma \\mathbf{K}\n$$\nHere, $\\mathbf{D}$ is a diagonal matrix whose elements are the orbital energy gaps, $D_{rr} = \\Delta_{ia} = \\varepsilon_a - \\varepsilon_i$. The index $r$ is a composite index that maps the pair of orbital indices $(i, a)$ (occupied $i$, virtual $a$) to a single dimension, $r = i \\cdot n_{\\text{virt}} + a$. The matrix $\\mathbf{K}$ encapsulates the coupling effects from the two-electron integrals, and $\\gamma$ is a scalar parameter that modulates this coupling. Since the provided coupling matrix $\\mathbf{K}$ is symmetric and $\\mathbf{D}$ is diagonal, the resulting Hessian $\\mathbf{H}$ is also symmetric. The instruction to use the symmetrized form $\\frac{1}{2}(\\mathbf{H} + \\mathbf{H}^\\top)$ is a good numerical practice to enforce symmetry and is followed, although it has no effect on an already-symmetric matrix.\n\nThe stability is assessed by examining the eigenvalues of $\\mathbf{H}$. If the lowest eigenvalue, $\\lambda_{\\min}$, is negative, the Hessian is not positive semi-definite, indicating that there exists a direction of orbital rotation (the corresponding eigenvector $\\mathbf{v}_{\\min}$) along which the energy decreases. This signifies an instability, meaning the found SCF solution is not a true energy minimum but a saddle point.\n\nThe complete procedure for each test case is as follows:\nFirst, we construct the diagonal matrix $\\mathbf{D}$ using the provided occupied ($\\varepsilon_i$) and virtual ($\\varepsilon_a$) orbital energies and the specified index mapping.\nSecond, we assemble the Hessian matrix $\\mathbf{H}$ by adding the coupling contribution $\\gamma \\mathbf{K}$ to $\\mathbf{D}$.\nThird, we solve the matrix eigenvalue equation $\\mathbf{H}\\mathbf{v} = \\lambda\\mathbf{v}$ to find the lowest eigenpair, $(\\lambda_{\\min}, \\mathbf{v}_{\\min})$. For this, we utilize a numerical eigensolver for real symmetric matrices, which guarantees real eigenvalues and orthonormal eigenvectors. The eigenvector $\\mathbf{v}_{\\min}$ is normalized to have a unit $\\ell_2$ norm.\n\nFinally, we apply the diagnostic logic provided, which is more nuanced than a simple sign check of $\\lambda_{\\min}$. We decompose the curvature along the softest mode $\\mathbf{v}_{\\min}$ into its constituent parts:\n- The gap contribution: $c_{\\text{gap}} = \\mathbf{v}_{\\min}^\\top \\mathbf{D} \\mathbf{v}_{\\min}$\n- The coupling contribution: $c_{\\text{cpl}} = \\mathbf{v}_{\\min}^\\top (\\gamma \\mathbf{K}) \\mathbf{v}_{\\min}$\nIt is a direct consequence of the definitions that $\\lambda_{\\min} = c_{\\text{gap}} + c_{\\text{cpl}}$. Based on the values of $\\lambda_{\\min}$, $c_{\\text{gap}}$, and $c_{\\text{cpl}}$, we diagnose the stability and recommend a corrective action.\n\n- **Action 0 (Stable)** is assigned if the solution is robustly stable, characterized by a sufficiently positive $\\lambda_{\\min}$ and a dominant, positive gap contribution $c_{\\text{gap}}$ (Thresholds: $\\lambda_{\\min}  0.02$ Hartree and $c_{\\text{gap}} \\ge 0.05$ Hartree).\n- **Action 1 (Level-Shifting)** is recommended for marginal instabilities. This case is identified by a small positive or any negative $\\lambda_{\\min}$, or by a very small gap contribution $c_{\\text{gap}}$, suggesting that near-degeneracies between occupied and virtual orbitals are the primary cause of instability. Level-shifting, which artificially increases the virtual orbital energies, is an effective remedy for such issues. (Thresholds: $\\lambda_{\\min}  0$ Hartree, or $\\lambda_{\\min} \\le 0.02$ Hartree, or $c_{\\text{gap}}  0.05$ Hartree).\n- **Action 2 (Reinitialization)** is reserved for severe instabilities. This is indicated by a large negative eigenvalue ($\\lambda_{\\min}  -0.05$ Hartree) that is primarily driven by a strong, attractive (destabilizing) coupling term ($c_{\\text{cpl}}  0$ with $\\lvert c_{\\text{cpl}} \\rvert  c_{\\text{gap}} + 0.02$ Hartree). This points to a fundamental problem with the electronic configuration (e.g., a singlet-triplet instability), requiring a new SCF calculation with a different initial guess.\n\nThis structured analysis allows for a precise characterization of the stability of HF solutions and informs the appropriate computational strategy for converging to a true energy minimum. We now implement this procedure for the given test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Hartree-Fock stability analysis problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: Well-separated gaps; expected stable\n        {\n            \"e_occ\": np.array([-0.50, -0.30]),\n            \"e_virt\": np.array([0.20, 0.50]),\n            \"gamma\": 0.5,\n            \"K\": np.array([\n                [0.01, 0.005, 0.004, 0.003],\n                [0.005, 0.01, 0.002, 0.004],\n                [0.004, 0.002, 0.01, 0.005],\n                [0.003, 0.004, 0.005, 0.01]\n            ])\n        },\n        # Case 2: Near-degenerate gaps; expected need for level-shifting\n        {\n            \"e_occ\": np.array([-0.50, -0.49]),\n            \"e_virt\": np.array([-0.45, -0.20]),\n            \"gamma\": -0.4,\n            \"K\": np.array([\n                [0.10, 0.04, 0.03, 0.02],\n                [0.04, 0.08, 0.02, 0.03],\n                [0.03, 0.02, 0.09, 0.04],\n                [0.02, 0.03, 0.04, 0.07]\n            ])\n        },\n        # Case 3: Triplet-like strong coupling instability; expected reinitialization\n        {\n            \"e_occ\": np.array([-0.60, -0.50]),\n            \"e_virt\": np.array([0.10, 0.20]),\n            \"gamma\": -1.0,\n            \"K\": np.array([\n                [0.20, 0.05, 0.04, 0.03],\n                [0.05, 0.20, 0.02, 0.04],\n                [0.04, 0.02, 0.75, 0.05],\n                [0.03, 0.04, 0.05, 0.20]\n            ])\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        e_occ = case[\"e_occ\"]\n        e_virt = case[\"e_virt\"]\n        gamma = case[\"gamma\"]\n        K = case[\"K\"]\n        \n        n_occ = len(e_occ)\n        n_virt = len(e_virt)\n        n_rot = n_occ * n_virt\n\n        # Construct the diagonal matrix D\n        delta = np.zeros(n_rot)\n        for i in range(n_occ):\n            for a in range(n_virt):\n                r = i * n_virt + a\n                delta[r] = e_virt[a] - e_occ[i]\n        D = np.diag(delta)\n\n        # Assemble the Hessian matrix H\n        H = D + gamma * K\n        \n        # Symmetrize H for numerical stability (as per problem statement)\n        H_sym = 0.5 * (H + H.T)\n        \n        # Compute eigenvalues and eigenvectors\n        # np.linalg.eigh returns eigenvalues in ascending order\n        eigenvalues, eigenvectors = np.linalg.eigh(H_sym)\n        \n        lambda_min = eigenvalues[0]\n        v_min = eigenvectors[:, 0]\n        \n        # Diagnose stability and propose remedy\n        c_gap = v_min.T @ D @ v_min\n        c_cpl = v_min.T @ (gamma * K) @ v_min\n        \n        action_code = 0  # Default to stable\n        \n        # Rule for Action 2\n        if lambda_min  -0.05 and c_cpl  0 and np.abs(c_cpl)  c_gap + 0.02:\n            action_code = 2\n        # Rule for Action 1\n        elif lambda_min  0 or lambda_min = 0.02 or c_gap  0.05:\n            action_code = 1\n        \n        # Format results for the current case\n        case_result = []\n        case_result.append(round(lambda_min, 6))\n        for component in v_min:\n            case_result.append(round(component, 6))\n        case_result.append(action_code)\n        \n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # To avoid space after commas inside inner lists:\n    formatted_results = []\n    for res in results:\n        res_str = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f},{res[3]:.6f},{res[4]:.6f},{res[5]}]\"\n        formatted_results.append(res_str)\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2808380"}]}