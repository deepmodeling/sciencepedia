{"hands_on_practices": [{"introduction": "Polarization functions provide essential angular flexibility, allowing electron density to deform in response to its chemical environment or external fields. This exercise makes that concept concrete by modeling how adding a single polarization function enhances a molecule's response to an electric field, directly impacting its calculated polarizability. By working through a simplified but powerful perturbative model, you will derive and quantify the direct link between a specific basis function and this key physical property [@problem_id:2916115].", "problem": "Consider the change in the static dipole polarizability when a single polarization function of angular momentum $d$ is added on the oxygen center of a water molecule, modeled in a minimal way as follows. Work in Hartree atomic units (a.u.), where the elementary charge, the reduced Planck constant, and the electron mass are set to $1$, dipole moments have units of Bohr ($a_0$), energies have units of Hartree ($E_h$), and polarizabilities have units of $a_0^3$.\n\nStart from the definition that the static dipole polarizability tensor $\\alpha_{ij}$ is the second derivative of the electronic ground-state energy $E$ with respect to a homogeneous electric field component $\\mathcal{E}_i$, evaluated at zero field, i.e., $\\alpha_{ij} = -\\left.\\frac{\\partial^2 E}{\\partial \\mathcal{E}_i \\partial \\mathcal{E}_j}\\right|_{\\mathcal{E}=0}$. Use time-independent nondegenerate Rayleigh–Schrödinger perturbation theory and the standard sum-over-states representation as the fundamental base to derive a lowest-order expression for the change in a single tensor component $\\Delta \\alpha_{kk}$ along a fixed molecular axis $k$ when one new oxygen-centered virtual channel is introduced by adding a single, orthonormalized, cartesian $d$-type Gaussian-type orbital (GTO).\n\nAdopt the following physically motivated and self-consistent modeling assumptions to make the problem definite and numerically testable, without introducing any additional approximations beyond those listed here:\n- The change $\\Delta \\alpha_{kk}$ is dominated by mixing of a single occupied oxygen-centered lone-pair-like molecular orbital of $p$ character, $\\lvert p\\rangle$, with the newly available virtual configuration $\\lvert d\\rangle$ supported by the added $d$-type GTO. All other occupied–virtual channels are assumed unchanged and therefore cancel in the difference.\n- The energy gap between these two configurations is a positive constant $\\Delta E = E_d - E_p > 0$, specified per test case in units of $E_h$.\n- The transition dipole matrix element along the $k$ axis scales with the spatial extent of the added cartesian $d$-type GTO. Specifically, take the matrix element magnitude to be $\\mu_{pd}^{(k)} = S\\,\\zeta_d^{-1/2}$, where $\\zeta_d > 0$ is the Gaussian exponent of the $d$ function in units of $a_0^{-2}$, and $S > 0$ is a dimensionless amplitude capturing the effective $p$ character on oxygen along axis $k$ and angular coupling.\n- Assume orthonormality of the involved states and neglect relaxation beyond first order in the electric field, consistent with linear response.\n\nYour tasks are:\n1. Using only the stated fundamental base and modeling assumptions, derive an explicit expression for $\\Delta \\alpha_{kk}$ in terms of $\\Delta E$, $\\zeta_d$, and $S$, and determine its sign. Your derivation must be grounded in the first-order perturbed density viewpoint and the sum-over-states picture, and it must logically connect the scaling of $\\mu_{pd}^{(k)}$ to the observed dependence of $\\Delta \\alpha_{kk}$ on $\\zeta_d$ and $\\Delta E$.\n2. Implement a program that evaluates your derived expression for a small test suite of parameter triples $(\\Delta E, \\zeta_d, S)$ given below. Produce numerical values of $\\Delta \\alpha_{kk}$ in $a_0^3$ for each test case.\n3. The final output must be a single line containing a Python list literal with the results for the test cases, in the same order as listed, each value rounded to $6$ decimal places, e.g., $[x_1,x_2,x_3]$.\n4. You are required to express the results in units of $a_0^3$.\n\nTest suite (each triple is $(\\Delta E, \\zeta_d, S)$, with $\\Delta E$ in $E_h$, $\\zeta_d$ in $a_0^{-2}$, and $S$ dimensionless):\n- Case A (general happy path): $(0.6, 1.5, 1.1)$.\n- Case B (tight $d$ function, boundary-like behavior): $(1.5, 6.0, 1.1)$.\n- Case C (diffuse $d$ function, edge-case behavior): $(0.3, 0.5, 1.1)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3]$), where each $r_i$ is the computed $\\Delta \\alpha_{kk}$ in $a_0^3$ for the corresponding test case, rounded to $6$ decimal places.", "solution": "The problem statement is first subjected to a validation procedure.\n\nStep 1: Extracted Givens.\n- The definition of the static dipole polarizability tensor is $\\alpha_{ij} = -\\left.\\partial^2 E / \\partial \\mathcal{E}_i \\partial \\mathcal{E}_j\\right|_{\\mathcal{E}=0}$.\n- The theoretical foundation is time-independent nondegenerate Rayleigh–Schrödinger perturbation theory and the sum-over-states representation.\n- The quantity of interest is the change in a polarizability tensor component, $\\Delta \\alpha_{kk}$, upon adding a single cartesian $d$-type Gaussian-type orbital (GTO) on the oxygen atom of a water molecule.\n- Assumption 1: The change $\\Delta \\alpha_{kk}$ is solely due to the introduction of a new excitation channel between an occupied $p$-type molecular orbital (MO) $\\lvert p\\rangle$ and a new virtual $d$-type MO $\\lvert d\\rangle$.\n- Assumption 2: The energy gap between these two states is a positive constant $\\Delta E = E_d - E_p > 0$.\n- Assumption 3: The magnitude of the transition dipole matrix element between these states along axis $k$ is given by the model $\\mu_{pd}^{(k)} = S\\,\\zeta_d^{-1/2}$, where $\\zeta_d > 0$ is the GTO exponent and $S > 0$ is a dimensionless amplitude.\n- Assumption 4: The states are orthonormal, and electronic relaxation effects beyond first order are neglected.\n- All calculations are performed in Hartree atomic units, with polarizability expressed in units of $a_0^3$.\n- Test cases for $(\\Delta E, \\zeta_d, S)$: Case A $(0.6, 1.5, 1.1)$; Case B $(1.5, 6.0, 1.1)$; Case C $(0.3, 0.5, 1.1)$.\n\nStep 2: Validation.\nThe problem is scientifically grounded, being based on standard principles of quantum chemistry (perturbation theory, basis sets, molecular properties). Its simplifying assumptions, while aggressive, are physically motivated for creating a tractable model and are explicitly stated. The problem is well-posed, objective, and self-contained, providing all necessary information to derive a unique expression and compute the required numerical values. It does not violate any fundamental laws, nor is it trivial or ill-defined.\n\nStep 3: Verdict.\nThe problem is valid. A reasoned solution will be provided.\n\nThe derivation proceeds from the sum-over-states (SOS) expression for the static dipole polarizability, which is a direct consequence of second-order Rayleigh-Schrödinger perturbation theory applied to a molecule in a static electric field. For a diagonal component $\\alpha_{kk}$, the SOS expression is:\n$$\n\\alpha_{kk} = 2 \\sum_{n \\neq 0} \\frac{|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_n \\rangle|^2}{E_n - E_0}\n$$\nwhere $\\Psi_0$ is the ground electronic state with energy $E_0$, $\\{\\Psi_n\\}_{n \\neq 0}$ is the set of all excited electronic states with energies $E_n$, and $\\hat{\\mu}_k$ is the $k$-component of the electric dipole operator. All quantities are in atomic units.\n\nThe problem states that adding a new $d$-type GTO introduces a single new virtual channel involving an occupied orbital $\\lvert p \\rangle$ and the new virtual orbital $\\lvert d \\rangle$. All other occupied-virtual channels are assumed to be unaffected. Therefore, the change in polarizability, $\\Delta \\alpha_{kk}$, is simply the contribution of this single new term to the sum-over-states:\n$$\n\\Delta \\alpha_{kk} = 2 \\frac{|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_{p \\to d} \\rangle|^2}{E_{p \\to d} - E_0}\n$$\nwhere $\\Psi_{p \\to d}$ is the newly accessible excited state corresponding to the promotion of an electron from $\\lvert p \\rangle$ to $\\lvert d \\rangle$.\n\nWe now apply the modeling assumptions to evaluate this expression.\n1. The energy denominator, $E_{p \\to d} - E_0$, is the energy of the excitation. Within a molecular orbital picture, this is approximated by the difference in orbital energies. The problem provides this value directly as the energy gap $\\Delta E = E_d - E_p$.\n2. The numerator contains the squared transition dipole moment, $|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_{p \\to d} \\rangle|^2$. Within a single-particle model, this state-to-state matrix element is proportional to the orbital matrix element $\\mu_{pd}^{(k)} = \\langle p | \\hat{\\mu}_k | d \\rangle$. The problem provides a model for the magnitude of this effective transition moment as $|\\mu_{pd}^{(k)}| = S \\zeta_d^{-1/2}$.\n\nSubstituting these model parameters into the expression for $\\Delta \\alpha_{kk}$:\n$$\n\\Delta \\alpha_{kk} = 2 \\frac{(S \\zeta_d^{-1/2})^2}{\\Delta E}\n$$\nThis simplifies to the final expression:\n$$\n\\Delta \\alpha_{kk} = \\frac{2 S^2}{\\Delta E \\cdot \\zeta_d}\n$$\nThis is the explicit expression for $\\Delta \\alpha_{kk}$ in terms of the given parameters $\\Delta E$, $\\zeta_d$, and $S$.\n\nTo determine the sign of $\\Delta \\alpha_{kk}$, we note that $S > 0$ by definition, so $S^2 > 0$. The energy gap $\\Delta E > 0$ and the Gaussian exponent $\\zeta_d > 0$ are also given as positive constants. As all factors in the expression are positive, the resulting change in polarizability $\\Delta \\alpha_{kk}$ must be positive. This is physically correct: adding a polarization channel for the electron density to respond to an external field must increase the polarizability of the system.\n\nThe derivation also illuminates the dependence of $\\Delta \\alpha_{kk}$ on the model parameters. The inverse proportionality to the energy gap, $\\Delta \\alpha_{kk} \\propto 1/\\Delta E$, is characteristic of second-order perturbation theory: smaller energy gaps lead to stronger coupling and larger responses. The inverse proportionality to the exponent, $\\Delta \\alpha_{kk} \\propto 1/\\zeta_d$, arises from the scaling of the transition dipole moment. A smaller exponent $\\zeta_d$ signifies a more spatially diffuse GTO. A diffuse function has a larger spatial extent, which leads to a larger value for the matrix element of the position-dependent dipole operator, $\\mu_{pd}^{(k)}$. This larger transition moment, in turn, yields a greater contribution to the polarizability, consistent with the known fact that diffuse basis functions are crucial for accurately describing polarizabilities.\n\nThe problem is now reduced to a numerical calculation using the derived formula for the provided test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the change in static dipole polarizability based on a derived\n    two-level model and provided test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (delta_E, zeta_d, S)\n    test_cases = [\n        (0.6, 1.5, 1.1),  # Case A: General happy path\n        (1.5, 6.0, 1.1),  # Case B: Tight d function, boundary-like behavior\n        (0.3, 0.5, 1.1),  # Case C: Diffuse d function, edge-case behavior\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        delta_E, zeta_d, S = case\n\n        # The derived formula for the change in polarizability is:\n        # delta_alpha_kk = (2 * S^2) / (delta_E * zeta_d)\n        # All inputs are in Hartree atomic units, so the result is in the\n        # atomic unit of polarizability, which is a_0^3.\n        delta_alpha_kk = (2 * S**2) / (delta_E * zeta_d)\n\n        # Append the result formatted to 6 decimal places as required.\n        results.append(f\"{delta_alpha_kk:.6f}\")\n\n    # Final print statement in the exact required format: [r1,r2,r3]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2916115"}, {"introduction": "Diffuse functions are indispensable for accurately describing spatially extended electron distributions, which are characteristic of anions and Rydberg excited states. This practice moves beyond qualitative descriptions by providing a hands-on method to quantitatively distinguish between compact valence excitations and diffuse Rydberg excitations based on orbital properties. You will implement a model from first principles, building the necessary matrix elements and using metrics like the second moment $\\langle r^2 \\rangle$ to classify the nature of electronic transitions [@problem_id:2916133].", "problem": "You are asked to design and implement a mathematically self-contained program that distinguishes valence from Rydberg excitations in a toy model of ammonia by examining attachment densities and orbital characters with and without augmentation by diffuse functions. Work in atomic units throughout, where length is measured in bohr and exponents are in bohr$^{-2}$. All final second-moment radii must be expressed in bohr$^{2}$.\n\nThe model is as follows. Consider a single-center basis of normalized $s$-type Gaussian-Type Orbitals (GTOs), each of the form $\\chi_{p}(\\mathbf{r}) = N(\\alpha_{p}) \\exp(-\\alpha_{p} r^{2})$ centered at the origin, where $r = \\|\\mathbf{r}\\|$, and the normalization factor is $N(\\alpha) = \\left(\\dfrac{2\\alpha}{\\pi}\\right)^{3/4}$. A molecular orbital $\\phi(\\mathbf{r})$ is a linear combination of these basis functions, $\\phi(\\mathbf{r}) = \\sum_{p=1}^{M} c_{p} \\chi_{p}(\\mathbf{r})$, where $M$ is the number of primitives. The attachment density for a one-electron excitation from an occupied orbital to a virtual orbital is taken to be $|\\phi_{\\mathrm{virt}}(\\mathbf{r})|^{2}$, which encodes the spatial character of the electron following the excitation.\n\nFundamental Gaussian integral results for $s$-type functions at the same center that you may use are:\n- The overlap integral $S_{pq} = \\int \\chi_{p}(\\mathbf{r}) \\chi_{q}(\\mathbf{r}) \\, d^{3}r = \\left(\\dfrac{2\\sqrt{\\alpha_{p}\\alpha_{q}}}{\\alpha_{p}+\\alpha_{q}}\\right)^{3/2}$.\n- The second-moment integral $R^{(2)}_{pq} = \\int r^{2}\\,\\chi_{p}(\\mathbf{r}) \\chi_{q}(\\mathbf{r}) \\, d^{3}r = S_{pq}\\,\\dfrac{3}{2(\\alpha_{p}+\\alpha_{q})}$.\n\nGiven a coefficient vector $\\mathbf{c} \\in \\mathbb{R}^{M}$ and the matrices $S = [S_{pq}]$ and $R^{(2)} = [R^{(2)}_{pq}]$, the second moment of the attachment density (equivalently of the virtual orbital) is\n$$\\langle r^{2} \\rangle_{\\mathrm{attach}} = \\frac{\\mathbf{c}^{\\mathsf{T}} R^{(2)} \\mathbf{c}}{\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c}},$$\nwhich must be reported in bohr$^{2}$. The Mulliken-like diffuse-fraction of an orbital over a specified index set $\\mathcal{D}$ of diffuse primitives is defined by\n$$ f_{\\mathrm{diffuse}} = \\frac{\\sum_{p\\in \\mathcal{D}} \\sum_{q=1}^{M} c_{p}\\,c_{q}\\,S_{pq}}{\\sum_{p=1}^{M} \\sum_{q=1}^{M} c_{p}\\,c_{q}\\,S_{pq}}. $$\n\nFor each test case below, you are given:\n- A valence-only set of exponents $\\{\\alpha_{v}\\}$.\n- An augmented set of diffuse exponents $\\{\\alpha_{d}\\}$ to be appended to the valence set to form the augmented basis.\n- Two unnormalized coefficient lists in the augmented basis: one for an occupied valence molecular orbital $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}}$ and one for a virtual target orbital $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$.\n- Two thresholds $r^{2}_{\\mathrm{cut}}$ (in bohr$^{2}$) and $f_{\\mathrm{cut}}$ (unitless, as a decimal fraction).\n\nYour program must, for each test case:\n1. Build the augmented basis by concatenating $\\{\\alpha_{v}\\}$ and $\\{\\alpha_{d}\\}$ (valence indices first, then diffuse). Construct $S$ and $R^{(2)}$ for this augmented basis using the formulas above.\n2. Normalize both $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}}$ and $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$ with respect to the $S$ metric, i.e., scale $\\mathbf{c}$ so that $\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c} = 1$.\n3. Compute the augmented-case attachment second moment $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}}$ from the normalized $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$ and the diffuse fraction $f_{\\mathrm{diffuse}}^{\\mathrm{aug}}$ using the diffuse index set $\\mathcal{D}$ corresponding to the appended diffuse primitives.\n4. Build the non-augmented (valence-only) basis by discarding the diffuse primitives and truncating the coefficient vectors to the valence block, then re-normalize with the valence-only overlap matrix. Compute the non-augmented attachment second moment $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$. Define $f_{\\mathrm{diffuse}}^{\\mathrm{noaug}} = 0$ because no diffuse primitives are present.\n5. Classify the excitation as \"Rydberg\" in the augmented basis if and only if both $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}} \\ge r^{2}_{\\mathrm{cut}}$ and $f_{\\mathrm{diffuse}}^{\\mathrm{aug}} \\ge f_{\\mathrm{cut}}$. Otherwise, classify it as \"valence\". Report this classification as an integer, with $1$ for Rydberg and $0$ for valence.\n6. Compute $\\Delta r^{2} = \\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}} - \\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$ in bohr$^{2}$.\n\nTest suite. Use the following four test cases; each list is given in the order (valence exponents, diffuse exponents, occupied coefficients in augmented basis, virtual coefficients in augmented basis, $r^{2}_{\\mathrm{cut}}$, $f_{\\mathrm{cut}}$):\n- Case $1$ (happy path, strongly Rydberg under augmentation):\n  - $\\{\\alpha_{v}\\} = \\{1.6, 0.5\\}$, $\\{\\alpha_{d}\\} = \\{0.08, 0.03\\}$,\n  - $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}} = (0.8, 1.0, 0.05, 0.02)$,\n  - $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}} = (0.1, 0.2, 1.0, 0.9)$,\n  - $r^{2}_{\\mathrm{cut}} = 8.0$ bohr$^{2}$, $f_{\\mathrm{cut}} = 0.6$.\n- Case $2$ (valence-like virtual, augmentation present but unimportant):\n  - $\\{\\alpha_{v}\\} = \\{1.6, 0.6\\}$, $\\{\\alpha_{d}\\} = \\{0.1\\}$,\n  - $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}} = (0.9, 1.0, 0.0)$,\n  - $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}} = (0.7, 0.8, 0.1)$,\n  - $r^{2}_{\\mathrm{cut}} = 6.0$ bohr$^{2}$, $f_{\\mathrm{cut}} = 0.5$.\n- Case $3$ (borderline mixture of valence and diffuse character):\n  - $\\{\\alpha_{v}\\} = \\{1.2, 0.4\\}$, $\\{\\alpha_{d}\\} = \\{0.08\\}$,\n  - $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}} = (0.9, 1.1, 0.05)$,\n  - $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}} = (0.45, 0.50, 0.45)$,\n  - $r^{2}_{\\mathrm{cut}} = 6.0$ bohr$^{2}$, $f_{\\mathrm{cut}} = 0.5$.\n- Case $4$ (edge case with extremely diffuse augmentation):\n  - $\\{\\alpha_{v}\\} = \\{1.8\\}$, $\\{\\alpha_{d}\\} = \\{0.02\\}$,\n  - $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}} = (1.0, 0.01)$,\n  - $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}} = (0.05, 1.0)$,\n  - $r^{2}_{\\mathrm{cut}} = 12.0$ bohr$^{2}$, $f_{\\mathrm{cut}} = 0.8$.\n\nFinal output format. Your program must produce a single line containing a single list whose entries are, for each test case in order:\n- $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}}$ (float, in bohr$^{2}$),\n- $f_{\\mathrm{diffuse}}^{\\mathrm{aug}}$ (float, unitless),\n- $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$ (float, in bohr$^{2}$),\n- $f_{\\mathrm{diffuse}}^{\\mathrm{noaug}}$ (float, always $0$),\n- $\\Delta r^{2}$ (float, in bohr$^{2}$),\n- the classification integer ($1$ for Rydberg, $0$ for valence).\n\nThe program should thus print a single line of the form\n$[x_{1},x_{2},\\dots,x_{24}]$\nfor the $4$ cases, where the entries appear in the order specified above. All second-moment quantities must be in bohr$^{2}$, and all fractions must be decimals (no percentage signs). Angles do not appear in this problem. The computation must be fully deterministic and not require any user input.", "solution": "The problem presented is a valid, self-contained exercise in computational quantum chemistry. It requires the implementation of a simplified model to analyze and classify electronic excitations based on the spatial extent of the target molecular orbital. The model, while a toy representation, is built upon sound and standard principles of quantum mechanics, namely the use of Gaussian-Type Orbitals (GTOs) as a basis set and the calculation of electronic properties from wavefunctions constructed in this basis. All necessary definitions, formulas, and data are provided, and the logic is free from contradiction or ambiguity. We proceed with the solution.\n\nThe fundamental components of the model are the atomic basis functions, molecular orbitals (MOs), and the operators for physical properties. The basis set consists of normalized, single-center $s$-type GTOs, $\\chi_{p}(\\mathbf{r})$, defined by an exponent $\\alpha_{p}$:\n$$ \\chi_{p}(\\mathbf{r}) = \\left(\\frac{2\\alpha_{p}}{\\pi}\\right)^{3/4} \\exp(-\\alpha_{p} r^{2}) $$\nA molecular orbital, $\\phi(\\mathbf{r})$, is a linear combination of these basis functions:\n$$ \\phi(\\mathbf{r}) = \\sum_{p=1}^{M} c_{p} \\chi_{p}(\\mathbf{r}) $$\nwhere $\\mathbf{c} = (c_1, c_2, \\dots, c_M)^{\\mathsf{T}}$ is the vector of MO coefficients in the basis of $M$ GTOs.\n\nThe analysis of orbital properties requires computing matrix elements of operators in the GTO basis. The problem provides the necessary analytical formulas for the overlap matrix, $S$, and the second-moment-radius matrix, $R^{(2)}$:\n$$ S_{pq} = \\int \\chi_{p}(\\mathbf{r}) \\chi_{q}(\\mathbf{r}) \\, d^{3}r = \\left(\\frac{2\\sqrt{\\alpha_{p}\\alpha_{q}}}{\\alpha_{p}+\\alpha_{q}}\\right)^{3/2} $$\n$$ R^{(2)}_{pq} = \\int r^{2}\\,\\chi_{p}(\\mathbf{r}) \\chi_{q}(\\mathbf{r}) \\, d^{3}r = S_{pq}\\,\\frac{3}{2(\\alpha_{p}+\\alpha_{q})} $$\nThe expectation value of the squared radius, $\\langle r^2 \\rangle$, for an orbital described by the coefficient vector $\\mathbf{c}$ is given by the general formula for an expectation value in a non-orthogonal basis:\n$$ \\langle r^{2} \\rangle = \\frac{\\int \\phi^{*}(\\mathbf{r}) r^2 \\phi(\\mathbf{r}) \\, d^3r}{\\int \\phi^{*}(\\mathbf{r}) \\phi(\\mathbf{r}) \\, d^3r} = \\frac{\\mathbf{c}^{\\mathsf{T}} R^{(2)} \\mathbf{c}}{\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c}} $$\nThe denominator, $\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c}$, is the squared norm of the MO. For a normalized orbital, this denominator is $1$, simplifying the expression. The normalization condition is $\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c} = 1$. An unnormalized coefficient vector $\\mathbf{c}_{\\mathrm{unnorm}}$ is normalized by scaling: $\\mathbf{c}_{\\mathrm{norm}} = \\mathbf{c}_{\\mathrm{unnorm}} / \\sqrt{\\mathbf{c}_{\\mathrm{unnorm}}^{\\mathsf{T}} S \\mathbf{c}_{\\mathrm{unnorm}}}$.\n\nThe problem models an electronic excitation by focusing on the character of the virtual (target) orbital, $\\phi_{\\mathrm{virt}}$. The attachment density is defined as $|\\phi_{\\mathrm{virt}}(\\mathbf{r})|^2$, and its spatial extent, quantified by $\\langle r^2 \\rangle_{\\mathrm{attach}} = \\langle r^2 \\rangle_{\\phi_{\\mathrm{virt}}}$, serves as a primary metric. A large $\\langle r^2 \\rangle$ indicates a diffuse, Rydberg-like orbital, while a smaller $\\langle r^2 \\rangle$ suggests a more compact, valence-like orbital.\n\nA second metric, the diffuse fraction $f_{\\mathrm{diffuse}}$, quantifies the contribution of a designated set of diffuse basis functions (those with small exponents $\\alpha_p$) to the MO. The specified definition is a Mulliken-like partition of the total electronic density:\n$$ f_{\\mathrm{diffuse}} = \\frac{\\sum_{p\\in \\mathcal{D}} \\sum_{q=1}^{M} c_{p}\\,c_{q}\\,S_{pq}}{\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c}} $$\nwhere $\\mathcal{D}$ is the index set of diffuse primitives. For a normalized MO, the denominator is $1$. The numerator can be computed efficiently: let $\\mathbf{v} = S \\mathbf{c}$; the numerator is then $\\sum_{p \\in \\mathcal{D}} c_p v_p$.\n\nThe computational procedure for each test case is as follows:\n1.  **Construct Bases and Matrices**:\n    The augmented basis is formed by concatenating the valence exponents $\\{\\alpha_v\\}$ and diffuse exponents $\\{\\alpha_d\\}$. Let $N_v$ be the number of valence functions and $M$ be the total number of functions. The augmented overlap matrix $S^{\\mathrm{aug}}$ and second-moment matrix $(R^{(2)})^{\\mathrm{aug}}$ of size $M \\times M$ are constructed. The valence-only matrices, $S^{\\mathrm{noaug}}$ and $(R^{(2)})^{\\mathrm{noaug}}$, are the top-left $N_v \\times N_v$ blocks of the augmented matrices.\n\n2.  **Process Orbitals**:\n    The problem provides unnormalized coefficient vectors for both an occupied and a virtual orbital, $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}}$ and $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$. The instructions require normalizing both. It must be noted that only the virtual orbital properties are used for the final classification and output. The processing of the occupied orbital is performed as instructed but serves only as a procedural check.\n    \n    For the virtual orbital:\n    a.  **Augmented Case**: The vector $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$ is normalized using $S^{\\mathrm{aug}}$. Using the normalized vector, $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}}$ and $f_{\\mathrm{diffuse}}^{\\mathrm{aug}}$ are computed. The set $\\mathcal{D}$ for the diffuse fraction consists of the indices corresponding to $\\{\\alpha_d\\}$.\n    b.  **Non-Augmented Case**: The vector $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$ is truncated to its first $N_v$ components to yield $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{noaug}}$. This vector is re-normalized using $S^{\\mathrm{noaug}}$. Then, $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$ is computed. By definition, since there are no diffuse functions in this basis, $f_{\\mathrm{diffuse}}^{\\mathrm{noaug}} = 0$.\n\n3.  **Classify and Report**:\n    The excitation is classified as Rydberg (output $1$) if both $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}} \\ge r^{2}_{\\mathrm{cut}}$ and $f_{\\mathrm{diffuse}}^{\\mathrm{aug}} \\ge f_{\\mathrm{cut}}$. Otherwise, it is classified as valence (output $0$). The change in the second moment, $\\Delta r^{2} = \\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}} - \\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$, is calculated. The final six quantities—$\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}}$, $f_{\\mathrm{diffuse}}^{\\mathrm{aug}}$, $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$, $f_{\\mathrm{diffuse}}^{\\mathrm{noaug}}$, $\\Delta r^{2}$, and the classification integer—are compiled for each case.\n\nThis systematic application of fundamental quantum chemical principles to the provided data yields a deterministic and verifiable solution.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the quantum chemistry problem for all test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1 (happy path, strongly Rydberg under augmentation)\n        {\n            \"alpha_v\": [1.6, 0.5], \"alpha_d\": [0.08, 0.03],\n            \"c_occ_aug\": [0.8, 1.0, 0.05, 0.02],\n            \"c_virt_aug\": [0.1, 0.2, 1.0, 0.9],\n            \"r2_cut\": 8.0, \"f_cut\": 0.6\n        },\n        # Case 2 (valence-like virtual, augmentation present but unimportant)\n        {\n            \"alpha_v\": [1.6, 0.6], \"alpha_d\": [0.1],\n            \"c_occ_aug\": [0.9, 1.0, 0.0],\n            \"c_virt_aug\": [0.7, 0.8, 0.1],\n            \"r2_cut\": 6.0, \"f_cut\": 0.5\n        },\n        # Case 3 (borderline mixture of valence and diffuse character)\n        {\n            \"alpha_v\": [1.2, 0.4], \"alpha_d\": [0.08],\n            \"c_occ_aug\": [0.9, 1.1, 0.05],\n            \"c_virt_aug\": [0.45, 0.50, 0.45],\n            \"r2_cut\": 6.0, \"f_cut\": 0.5\n        },\n        # Case 4 (edge case with extremely diffuse augmentation)\n        {\n            \"alpha_v\": [1.8], \"alpha_d\": [0.02],\n            \"c_occ_aug\": [1.0, 0.01],\n            \"c_virt_aug\": [0.05, 1.0],\n            \"r2_cut\": 12.0, \"f_cut\": 0.8\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = process_case(case)\n        results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef build_matrices(alphas):\n    \"\"\"\n    Constructs overlap (S) and second-moment-radius (R2) matrices.\n    \n    Args:\n        alphas (list of float): List of Gaussian exponents.\n        \n    Returns:\n        (np.ndarray, np.ndarray): The S and R2 matrices.\n    \"\"\"\n    n = len(alphas)\n    S = np.zeros((n, n))\n    R2 = np.zeros((n, n))\n    \n    for i in range(n):\n        for j in range(n):\n            ap = alphas[i]\n            aq = alphas[j]\n            \n            S_pq = (2 * np.sqrt(ap * aq) / (ap + aq))**1.5\n            R2_pq = S_pq * 1.5 / (ap + aq)\n            \n            S[i, j] = S_pq\n            R2[i, j] = R2_pq\n            \n    return S, R2\n\ndef normalize_coeffs(c, S):\n    \"\"\"Normalizes a coefficient vector with respect to the overlap matrix S.\"\"\"\n    norm_sq = c.T @ S @ c\n    if norm_sq = 0: # Should not happen with valid positive definite S\n        raise ValueError(\"Non-positive norm squared.\")\n    return c / np.sqrt(norm_sq)\n\ndef process_case(case_data):\n    \"\"\"\n    Processes a single test case according to the problem specification.\n    \n    Args:\n        case_data (dict): A dictionary containing all data for one test case.\n        \n    Returns:\n        list of float: The 6 result values for the case.\n    \"\"\"\n    alpha_v = case_data[\"alpha_v\"]\n    alpha_d = case_data[\"alpha_d\"]\n    c_occ_aug_unnorm = np.array(case_data[\"c_occ_aug\"])\n    c_virt_aug_unnorm = np.array(case_data[\"c_virt_aug\"])\n    r2_cut = case_data[\"r2_cut\"]\n    f_cut = case_data[\"f_cut\"]\n\n    n_v = len(alpha_v)\n    n_d = len(alpha_d)\n    M = n_v + n_d\n    \n    alpha_aug = alpha_v + alpha_d\n    \n    # 1. Build augmented basis matrices\n    S_aug, R2_aug = build_matrices(alpha_aug)\n\n    # Extract non-augmented (valence-only) sub-matrices\n    S_noaug = S_aug[:n_v, :n_v]\n    R2_noaug = R2_aug[:n_v, :n_v]\n    \n    # 2. Normalize both occupied and virtual orbitals (as per instructions)\n    # The occupied orbital calculations are performed for procedural completeness\n    # but are not used in the final output values.\n    _ = normalize_coeffs(c_occ_aug_unnorm, S_aug)\n    c_occ_noaug_unnorm = c_occ_aug_unnorm[:n_v]\n    if n_v > 0:\n        _ = normalize_coeffs(c_occ_noaug_unnorm, S_noaug)\n\n    # Process the virtual orbital for the required outputs\n    # Augmented case\n    c_virt_aug_norm = normalize_coeffs(c_virt_aug_unnorm, S_aug)\n    \n    # 3. Compute augmented-case metrics\n    r2_attach_aug = c_virt_aug_norm.T @ R2_aug @ c_virt_aug_norm\n    \n    # Denominator for f_diffuse is 1 due to normalization\n    norm_check_aug = c_virt_aug_norm.T @ S_aug @ c_virt_aug_norm\n    \n    # Numerator of f_diffuse\n    v_vec = S_aug @ c_virt_aug_norm\n    diffuse_indices = range(n_v, M)\n    f_diffuse_num = np.dot(c_virt_aug_norm[diffuse_indices], v_vec[diffuse_indices])\n    f_diffuse_aug = f_diffuse_num / norm_check_aug\n\n    # 4. Compute non-augmented case metrics\n    c_virt_noaug_unnorm = c_virt_aug_unnorm[:n_v]\n    if n_v > 0:\n        c_virt_noaug_norm = normalize_coeffs(c_virt_noaug_unnorm, S_noaug)\n        r2_attach_noaug = c_virt_noaug_norm.T @ R2_noaug @ c_virt_noaug_norm\n    else: # Should not happen based on test cases\n        r2_attach_noaug = 0.0\n\n    f_diffuse_noaug = 0.0\n    \n    # 5. Classify the excitation\n    is_rydberg = (r2_attach_aug >= r2_cut and f_diffuse_aug >= f_cut)\n    classification = 1 if is_rydberg else 0\n    \n    # 6. Compute delta r^2\n    delta_r2 = r2_attach_aug - r2_attach_noaug\n\n    return [\n        r2_attach_aug,\n        f_diffuse_aug,\n        r2_attach_noaug,\n        f_diffuse_noaug,\n        delta_r2,\n        classification\n    ]\n\nsolve()\n```", "id": "2916133"}, {"introduction": "The accurate calculation of weak non-covalent interactions presents a significant challenge where basis set choice, including augmentation, is critical. This exercise addresses the pervasive issue of Basis Set Superposition Error (BSSE) and its relationship to the intrinsic incompleteness of the basis set. By applying the half-counterpoise correction scheme, you will algebraically dissect the total interaction energy error into these distinct components, gaining practical insight into how improving a basis set systematically reduces different sources of error [@problem_id:2916061].", "problem": "You are given a supermolecular description of a halide–water complex and a set of absolute electronic energies computed with different basis sets, with and without diffuse augmentation. The target is to partition the interaction energy error into a component attributable to Basis Set Superposition Error (BSSE) and a component attributable to basis-set incompleteness (sometimes called Basis-Set Incompleteness Error), using the half-Counterpoise (half-CP) framework.\n\nStart from the following foundational facts and definitions, which are standard in quantum chemistry and follow from the variational principle and supermolecular energy definitions:\n- Let $E_{AB}^{AB}$ denote the electronic energy of the dimer computed in the dimer basis.\n- Let $E_{A}^{A}$ and $E_{B}^{B}$ denote the electronic energies of the monomers computed in their own monomer bases.\n- Let $E_{A}^{AB}$ and $E_{B}^{AB}$ denote the monomer energies computed in the presence of the partner’s basis functions as ghosts (the “dimer basis” with one ghost), which by the variational principle satisfy $E_{A}^{AB} \\le E_{A}^{A}$ and $E_{B}^{AB} \\le E_{B}^{B}$.\n- The raw (uncorrected) supermolecular interaction energy is \n$$\nI_{\\mathrm{raw}} \\equiv E_{AB}^{AB} - E_{A}^{A} - E_{B}^{B}.\n$$\n- The Counterpoise (CP) corrected interaction energy, following Boys–Bernardi Counterpoise, is\n$$\nI_{\\mathrm{CP}} \\equiv E_{AB}^{AB} - E_{A}^{AB} - E_{B}^{AB}.\n$$\n- The half-Counterpoise (half-CP) interaction energy is the average\n$$\nI_{1/2} \\equiv \\tfrac{1}{2}\\left(I_{\\mathrm{raw}} + I_{\\mathrm{CP}}\\right).\n$$\n- The CP shift (the standard estimator of Basis Set Superposition Error (BSSE)) is\n$$\n\\Delta_{\\mathrm{CP}} \\equiv \\left(E_{A}^{AB} - E_{A}^{A}\\right) + \\left(E_{B}^{AB} - E_{B}^{B}\\right),\n$$\nwhich satisfies $I_{\\mathrm{CP}} = I_{\\mathrm{raw}} - \\Delta_{\\mathrm{CP}}$.\n\nLet the reference (complete-basis) interaction energy be provided as $I_{\\mathrm{ref}}$, and define the half-CP interaction energy error as\n$$\n\\varepsilon_{1/2} \\equiv I_{1/2} - I_{\\mathrm{ref}}.\n$$\n\nYour tasks are:\n1) Using only the definitions above, algebraically express $\\varepsilon_{1/2}$ as the sum of two contributions, one that depends on $\\Delta_{\\mathrm{CP}}$ and one that depends only on $I_{\\mathrm{CP}} - I_{\\mathrm{ref}}$. Interpret these two terms as the “residual BSSE contribution in half-CP” and the “basis-set incompleteness contribution in half-CP,” respectively. Do not introduce any additional assumptions beyond the given definitions.\n2) Implement these expressions in a program that evaluates the two contributions and their sum for each test case.\n3) Convert all final reported quantities from hartree to kilojoules per mole using the factor $1\\,\\text{hartree} = 2625.49962\\,\\text{kJ}\\,\\text{mol}^{-1}$.\n4) Express all final numerical answers in $\\text{kJ}\\,\\text{mol}^{-1}$ rounded to six decimal places.\n\nUse the following test suite of parameter sets, each providing $\\left(E_{AB}^{AB}, E_{A}^{A}, E_{B}^{B}, E_{A}^{AB}, E_{B}^{AB}\\right)$ in hartree, together with a single common reference interaction energy $I_{\\mathrm{ref}}$ in hartree corresponding to the same complex geometry:\n\n- Test Case 1 (non-augmented, polarized, double-zeta-like):\n  - $E_{AB}^{AB} = -536.490000$\n  - $E_{A}^{A} = -460.180000$\n  - $E_{B}^{B} = -76.280000$\n  - $E_{A}^{AB} = -460.186000$\n  - $E_{B}^{AB} = -76.284000$\n- Test Case 2 (non-augmented, polarized, triple-zeta-like):\n  - $E_{AB}^{AB} = -536.526666$\n  - $E_{A}^{A} = -460.200000$\n  - $E_{B}^{B} = -76.300000$\n  - $E_{A}^{AB} = -460.205000$\n  - $E_{B}^{AB} = -76.302000$\n- Test Case 3 (diffuse-augmented, polarized, triple-zeta-like):\n  - $E_{AB}^{AB} = -536.542800$\n  - $E_{A}^{A} = -460.210000$\n  - $E_{B}^{B} = -76.310000$\n  - $E_{A}^{AB} = -460.211500$\n  - $E_{B}^{AB} = -76.310800$\n- Test Case 4 (diffuse-augmented, polarized, quadruple-zeta-like):\n  - $E_{AB}^{AB} = -536.550700$\n  - $E_{A}^{A} = -460.215000$\n  - $E_{B}^{B} = -76.315000$\n  - $E_{A}^{AB} = -460.215200$\n  - $E_{B}^{AB} = -76.315100$\n\nUse the same reference interaction energy for all cases:\n- $I_{\\mathrm{ref}} = -0.020500$ hartree.\n\nFor each test case, your program must compute and return a triple\n$$\n\\left[\\varepsilon_{1/2},\\ \\varepsilon_{\\mathrm{BSSE}}^{(1/2)},\\ \\varepsilon_{\\mathrm{inc}}^{(1/2)}\\right],\n$$\neach entry expressed in $\\text{kJ}\\,\\text{mol}^{-1}$ and rounded to six decimal places, where $\\varepsilon_{1/2}$ is the total half-CP interaction energy error, $\\varepsilon_{\\mathrm{BSSE}}^{(1/2)}$ is the residual BSSE contribution in half-CP, and $\\varepsilon_{\\mathrm{inc}}^{(1/2)}$ is the basis-set incompleteness contribution in half-CP, such that\n$$\n\\varepsilon_{1/2} = \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} + \\varepsilon_{\\mathrm{inc}}^{(1/2)}.\n$$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a JSON-like list of lists, one inner list per test case, in the order given above. For example:\n- \n  `[[x11,x12,x13],[x21,x22,x23],[x31,x32,x33],[x41,x42,x43]]`\n- \nwith each $x_{ij}$ in $\\text{kJ}\\,\\text{mol}^{-1}$ rounded to six decimal places, and no additional text.\n\nAngle units are not applicable. All energies provided are in hartree, and all requested outputs must be in $\\text{kJ}\\,\\text{mol}^{-1}$.", "solution": "The problem statement has been subjected to rigorous validation and is found to be scientifically sound, well-posed, and internally consistent. All provided definitions are standard within the field of quantum chemistry, and the numerical data are physically realistic and conform to the variational principle, where $E_{X}^{XY} \\le E_{X}^{X}$. We may therefore proceed with the solution.\n\nThe primary task is to decompose the total error of the half-Counterpoise (half-CP) interaction energy, $\\varepsilon_{1/2}$, into two physically meaningful components: a residual Basis Set Superposition Error (BSSE) contribution, $\\varepsilon_{\\mathrm{BSSE}}^{(1/2)}$, and a basis-set incompleteness contribution, $\\varepsilon_{\\mathrm{inc}}^{(1/2)}$. This decomposition must be derived algebraically from the provided foundational definitions.\n\nWe begin with the definition of the half-CP interaction energy error:\n$$\n\\varepsilon_{1/2} \\equiv I_{1/2} - I_{\\mathrm{ref}}\n$$\nThe half-CP interaction energy, $I_{1/2}$, is defined as the arithmetic mean of the raw and the fully Counterpoise-corrected interaction energies:\n$$\nI_{1/2} \\equiv \\frac{1}{2}\\left(I_{\\mathrm{raw}} + I_{\\mathrm{CP}}\\right)\n$$\nSubstituting this into the expression for $\\varepsilon_{1/2}$ gives:\n$$\n\\varepsilon_{1/2} = \\frac{1}{2}\\left(I_{\\mathrm{raw}} + I_{\\mathrm{CP}}\\right) - I_{\\mathrm{ref}}\n$$\nThe problem provides the relationship between the raw interaction energy, $I_{\\mathrm{raw}}$, the CP-corrected interaction energy, $I_{\\mathrm{CP}}$, and the CP shift, $\\Delta_{\\mathrm{CP}}$, as $I_{\\mathrm{CP}} = I_{\\mathrm{raw}} - \\Delta_{\\mathrm{CP}}$. We can rearrange this to express $I_{\\mathrm{raw}}$ in terms of $I_{\\mathrm{CP}}$ and $\\Delta_{\\mathrm{CP}}$:\n$$\nI_{\\mathrm{raw}} = I_{\\mathrm{CP}} + \\Delta_{\\mathrm{CP}}\n$$\nWe now substitute this expression for $I_{\\mathrm{raw}}$ into our equation for $\\varepsilon_{1/2}$:\n$$\n\\varepsilon_{1/2} = \\frac{1}{2}\\left((I_{\\mathrm{CP}} + \\Delta_{\\mathrm{CP}}) + I_{\\mathrm{CP}}\\right) - I_{\\mathrm{ref}}\n$$\nCombining terms inside the parenthesis yields:\n$$\n\\varepsilon_{1/2} = \\frac{1}{2}\\left(2I_{\\mathrm{CP}} + \\Delta_{\\mathrm{CP}}\\right) - I_{\\mathrm{ref}}\n$$\nDistributing the factor of $\\frac{1}{2}$ and rearranging the terms to isolate the desired dependencies, we obtain:\n$$\n\\varepsilon_{1/2} = I_{\\mathrm{CP}} + \\frac{1}{2}\\Delta_{\\mathrm{CP}} - I_{\\mathrm{ref}} = \\left(I_{\\mathrm{CP}} - I_{\\mathrm{ref}}\\right) + \\frac{1}{2}\\Delta_{\\mathrm{CP}}\n$$\nThis expression provides the required decomposition. We can now identify the two contributions.\n\nThe first term, $(I_{\\mathrm{CP}} - I_{\\mathrm{ref}})$, represents the deviation of the fully CP-corrected interaction energy from the exact, reference value. The CP correction is designed to eliminate the BSSE. Therefore, any remaining error in $I_{\\mathrm{CP}}$ is attributed to the intrinsic inadequacy, or incompleteness, of the chosen basis set. We define this as the basis-set incompleteness contribution:\n$$\n\\varepsilon_{\\mathrm{inc}}^{(1/2)} \\equiv I_{\\mathrm{CP}} - I_{\\mathrm{ref}}\n$$\nThe second term, $\\frac{1}{2}\\Delta_{\\mathrm{CP}}$, is exactly one half of the total CP correction, which is the standard estimator for the magnitude of the BSSE. The half-CP method, by its construction, corrects for only half of the estimated BSSE. It is therefore logical to interpret this second term as the residual BSSE that remains uncorrected in the half-CP scheme:\n$$\n\\varepsilon_{\\mathrm{BSSE}}^{(1/2)} \\equiv \\frac{1}{2}\\Delta_{\\mathrm{CP}}\n$$\nThe total half-CP error is the sum of these two components, $\\varepsilon_{1/2} = \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} + \\varepsilon_{\\mathrm{inc}}^{(1/2)}$, as derived.\n\nThe computational procedure for each test case is as follows. Given the set of energies $\\left(E_{AB}^{AB}, E_{A}^{A}, E_{B}^{B}, E_{A}^{AB}, E_{B}^{AB}\\right)$ in hartree and the reference interaction energy $I_{\\mathrm{ref}}$ in hartree:\n1.  Calculate the CP shift, $\\Delta_{\\mathrm{CP}}$, in hartree:\n    $$\n    \\Delta_{\\mathrm{CP}} = (E_{A}^{AB} - E_{A}^{A}) + (E_{B}^{AB} - E_{B}^{B})\n    $$\n2.  Calculate the CP-corrected interaction energy, $I_{\\mathrm{CP}}$, in hartree:\n    $$\n    I_{\\mathrm{CP}} = E_{AB}^{AB} - E_{A}^{AB} - E_{B}^{AB}\n    $$\n3.  Calculate the two error components in hartree:\n    $$\n    \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} = \\frac{1}{2}\\Delta_{\\mathrm{CP}}\n    $$\n    $$\n    \\varepsilon_{\\mathrm{inc}}^{(1/2)} = I_{\\mathrm{CP}} - I_{\\mathrm{ref}}\n    $$\n4.  Calculate the total half-CP error, $\\varepsilon_{1/2}$, in hartree as their sum:\n    $$\n    \\varepsilon_{1/2} = \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} + \\varepsilon_{\\mathrm{inc}}^{(1/2)}\n    $$\n5.  Convert each of these three quantities from hartree to $\\text{kJ}\\,\\text{mol}^{-1}$ using the provided factor $1\\,\\text{hartree} = 2625.49962\\,\\text{kJ}\\,\\text{mol}^{-1}$.\n6.  Round the final results in $\\text{kJ}\\,\\text{mol}^{-1}$ to six decimal places.\n\nThis procedure will be implemented and applied to the four provided test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and partitions the half-CP interaction energy error for a series of\n    quantum chemical calculations on a halide-water complex.\n    \"\"\"\n\n    # Conversion factor from Hartree to kJ/mol as specified.\n    H_TO_KJ_MOL = 2625.49962\n\n    # Reference interaction energy in Hartree, common to all test cases.\n    I_ref_hartree = -0.020500\n\n    # Test cases: (E_AB_AB, E_A_A, E_B_B, E_A_AB, E_B_AB) in Hartree.\n    test_cases = [\n        # Test Case 1 (non-augmented, polarized, double-zeta-like)\n        (-536.490000, -460.180000, -76.280000, -460.186000, -76.284000),\n        # Test Case 2 (non-augmented, polarized, triple-zeta-like)\n        (-536.526666, -460.200000, -76.300000, -460.205000, -76.302000),\n        # Test Case 3 (diffuse-augmented, polarized, triple-zeta-like)\n        (-536.542800, -460.210000, -76.310000, -460.211500, -76.310800),\n        # Test Case 4 (diffuse-augmented, polarized, quadruple-zeta-like)\n        (-536.550700, -460.215000, -76.315000, -460.215200, -76.315100),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        E_AB_AB, E_A_A, E_B_B, E_A_AB, E_B_AB = case\n\n        # 1. Calculate CP shift (Delta_CP) in Hartree.\n        # This is the standard estimator for the Basis Set Superposition Error (BSSE).\n        delta_cp_hartree = (E_A_AB - E_A_A) + (E_B_AB - E_B_B)\n\n        # 2. Calculate CP-corrected interaction energy (I_CP) in Hartree.\n        I_cp_hartree = E_AB_AB - E_A_AB - E_B_AB\n\n        # 3. Calculate the error components in Hartree based on the derivation.\n        # Residual BSSE contribution in half-CP scheme.\n        eps_bsse_half_cp_hartree = 0.5 * delta_cp_hartree\n        # Basis-set incompleteness contribution in half-CP scheme.\n        eps_inc_half_cp_hartree = I_cp_hartree - I_ref_hartree\n        # Total half-CP error, being the sum of the two components.\n        eps_half_cp_hartree = eps_bsse_half_cp_hartree + eps_inc_half_cp_hartree\n\n        # 4. Convert all quantities to kJ/mol.\n        eps_half_cp_kjmol = eps_half_cp_hartree * H_TO_KJ_MOL\n        eps_bsse_half_cp_kjmol = eps_bsse_half_cp_hartree * H_TO_KJ_MOL\n        eps_inc_half_cp_kjmol = eps_inc_half_cp_hartree * H_TO_KJ_MOL\n\n        # 5. Round to six decimal places as required.\n        result_triple = [\n            round(eps_half_cp_kjmol, 6),\n            round(eps_bsse_half_cp_kjmol, 6),\n            round(eps_inc_half_cp_kjmol, 6),\n        ]\n        \n        all_results.append(result_triple)\n\n    # 6. Format the output as a JSON-like string of a list of lists.\n    # The format requires no spaces and specific bracketing.\n    case_strings = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in all_results]\n    final_output = f\"[{','.join(case_strings)}]\"\n    \n    # Print the final formatted string.\n    print(final_output)\n\nsolve()\n```", "id": "2916061"}]}