{"hands_on_practices": [{"introduction": "To appreciate the power of methods like Selected CI and FCIQMC, we must first understand the limitations of more traditional approaches. A critical benchmark for any electronic structure method is size consistency, the ability to correctly calculate the energy of two non-interacting systems as the sum of their individual energies. This exercise [@problem_id:2803703] provides a clear, analytical demonstration of why truncated Configuration Interaction (CI) methods like CISD fail this fundamental test, motivating the need for FCI-level theories that are inherently size-consistent.", "problem": "Consider two identical, noninteracting, closed-shell fragments labeled $A$ and $B$. Each fragment is modeled in a minimal Hilbert space spanned by a Hartree–Fock (HF) reference determinant $\\lvert 0_{F} \\rangle$ and one doubly excited determinant $\\lvert 2_{F} \\rangle$ ($F \\in \\{A,B\\}$). Assume Brillouin’s theorem so that single excitations do not couple to the HF reference for each fragment. In this minimal model, the fragment Hamiltonian in the ordered basis $\\{\\lvert 0_{F} \\rangle,\\lvert 2_{F} \\rangle\\}$ has diagonal elements $E_{0}$ and $E_{2}$ and a nonzero off-diagonal coupling $K$, with an energy gap $\\Delta \\equiv E_{2}-E_{0} > 0$. Work in atomic units, and without loss of generality shift the zero of energy so that $E_{0}=0$, hence the fragment Hamiltonian is represented by the matrix $\\begin{pmatrix} 0 & K \\\\ K & \\Delta \\end{pmatrix}$. The total Hamiltonian for the dimer is additive, $H=H_{A}\\otimes I_{B}+I_{A}\\otimes H_{B}$, and there is no interaction between fragments.\n\nConfiguration Interaction with Singles and Doubles (CISD) on the dimer is defined here as the diagonalization of $H$ in the subspace spanned by the HF product reference $\\lvert 0_{A}0_{B} \\rangle$ and all determinants with up to two electrons excited relative to that reference. In this model, that CISD subspace is $\\{\\lvert 0_{A}0_{B} \\rangle,\\lvert 2_{A}0_{B} \\rangle,\\lvert 0_{A}2_{B} \\rangle\\}$ but excludes $\\lvert 2_{A}2_{B} \\rangle$. Full Configuration Interaction (FCI) includes all four product determinants. Full Configuration Interaction Quantum Monte Carlo (FCIQMC) is a projector Quantum Monte Carlo algorithm that in the infinite-sampling limit yields the exact FCI ground-state energy within a chosen one-particle basis.\n\nStarting from the above definitions and standard many-electron quantum mechanics, do the following:\n\n1. For a single fragment, analytically diagonalize the $2 \\times 2$ Hamiltonian to obtain its exact ground-state energy $E_{\\mathrm{mono}}(\\Delta,K)$.\n2. For the dimer, construct and diagonalize the $3 \\times 3$ CISD Hamiltonian in the basis $\\{\\lvert 0_{A}0_{B} \\rangle,\\lvert 2_{A}0_{B} \\rangle,\\lvert 0_{A}2_{B} \\rangle\\}$ to obtain the CISD ground-state energy $E_{\\mathrm{dimer}}^{\\mathrm{CISD}}(\\Delta,K)$.\n3. Using the definition of size consistency, form the size-consistency error $\\delta(\\Delta,K) \\equiv E_{\\mathrm{dimer}}^{\\mathrm{CISD}}(\\Delta,K) - 2E_{\\mathrm{mono}}(\\Delta,K)$.\n4. Argue, without further numerical diagonalization, what the exact FCI dimer ground-state energy must be in this noninteracting case, and explain briefly why an FCIQMC calculation would avoid the pathology found in step 3 in the limit of exact sampling.\n\nProvide your final answer as a single closed-form analytical expression for $\\delta(\\Delta,K)$ in terms of $\\Delta$ and $K$ (atomic units). Do not approximate or expand; give the exact expression.", "solution": "The posed problem is subject to validation. All givens are extracted verbatim.\n- Fragments: Two identical, noninteracting, closed-shell fragments $A$ and $B$.\n- Fragment Hilbert space: $\\{\\lvert 0_{F} \\rangle, \\lvert 2_{F} \\rangle\\}$ for $F \\in \\{A,B\\}$.\n- Fragment Hamiltonian ($E_0=0$): $H_F = \\begin{pmatrix} 0 & K \\\\ K & \\Delta \\end{pmatrix}$, with $\\Delta > 0$.\n- Total Hamiltonian: $H=H_{A}\\otimes I_{B}+I_{A}\\otimes H_{B}$.\n- CISD subspace for dimer: $\\{\\lvert 0_{A}0_{B} \\rangle,\\lvert 2_{A}0_{B} \\rangle,\\lvert 0_{A}2_{B} \\rangle\\}$.\n- FCI subspace for dimer: $\\{\\lvert 0_{A}0_{B} \\rangle,\\lvert 2_{A}0_{B} \\rangle,\\lvert 0_{A}2_{B} \\rangle, \\lvert 2_{A}2_{B} \\rangle\\}$.\n- FCIQMC properties: Yields exact FCI ground-state energy in the infinite-sampling limit.\n\nThe problem is scientifically grounded, well-posed, and objective. It is a standard pedagogical problem in theoretical chemistry used to illustrate the size-consistency failure of truncated Configuration Interaction (CI) methods. The model, while simplified, is built upon the rigorous mathematical framework of many-body quantum mechanics, including tensor product spaces and matrix diagonalization. It contains no scientific flaws, ambiguities, or contradictions. The problem is valid. The solution proceeds.\n\n1. Ground-state energy of a single fragment.\nThe Hamiltonian for a single fragment $F$ is a $2 \\times 2$ matrix:\n$$ H_F = \\begin{pmatrix} 0 & K \\\\ K & \\Delta \\end{pmatrix} $$\nThe energy eigenvalues $E$ are the roots of the characteristic equation $\\det(H_F - E I) = 0$.\n$$ \\det \\begin{pmatrix} -E & K \\\\ K & \\Delta - E \\end{pmatrix} = 0 $$\n$$ (-E)(\\Delta - E) - K^2 = 0 $$\n$$ E^2 - \\Delta E - K^2 = 0 $$\nThis quadratic equation is solved for $E$:\n$$ E = \\frac{\\Delta \\pm \\sqrt{(-\\Delta)^2 - 4(1)(-K^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 4K^2}}{2} $$\nThe ground-state energy is the lower of the two eigenvalues. Given $\\Delta > 0$ and $K$ is a real coupling, $\\sqrt{\\Delta^2 + 4K^2} > \\Delta$. Thus, the ground-state energy is:\n$$ E_{\\mathrm{mono}}(\\Delta,K) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 4K^2}}{2} $$\n\n2. CISD ground-state energy of the dimer.\nThe total Hamiltonian is $H = H_A \\otimes I_B + I_A \\otimes H_B$. The CISD Hamiltonian matrix is constructed in the specified truncated basis $\\{\\lvert 0_A 0_B \\rangle, \\lvert 2_A 0_B \\rangle, \\lvert 0_A 2_B \\rangle \\}$. The matrix elements $H_{ij} = \\langle \\phi_i | H | \\phi_j \\rangle$ are computed as follows:\n$H_{11} = \\langle 0_A 0_B | H | 0_A 0_B \\rangle = \\langle 0_A|H_A|0_A\\rangle + \\langle 0_B|H_B|0_B\\rangle = 0 + 0 = 0$.\n$H_{22} = \\langle 2_A 0_B | H | 2_A 0_B \\rangle = \\langle 2_A|H_A|2_A\\rangle + \\langle 0_B|H_B|0_B\\rangle = \\Delta + 0 = \\Delta$.\n$H_{33} = \\langle 0_A 2_B | H | 0_A 2_B \\rangle = \\langle 0_A|H_A|0_A\\rangle + \\langle 2_B|H_B|2_B\\rangle = 0 + \\Delta = \\Delta$.\n$H_{12} = \\langle 0_A 0_B | H | 2_A 0_B \\rangle = \\langle 0_A|H_A|2_A\\rangle\\langle 0_B|0_B\\rangle = K \\cdot 1 = K$.\n$H_{13} = \\langle 0_A 0_B | H | 0_A 2_B \\rangle = \\langle 0_A|0_A\\rangle\\langle 0_B|H_B|2_B\\rangle = 1 \\cdot K = K$.\n$H_{23} = \\langle 2_A 0_B | H | 0_A 2_B \\rangle = \\langle 2_A|H_A|0_A\\rangle\\langle 0_B|2_B\\rangle + \\langle 2_A|0_A\\rangle\\langle 0_B|H_B|2_B\\rangle = K \\cdot 0 + 0 \\cdot K = 0$.\nBy hermiticity, $H_{21}=K$, $H_{31}=K$, and $H_{32}=0$. The CISD Hamiltonian matrix is:\n$$ H^{\\mathrm{CISD}} = \\begin{pmatrix} 0 & K & K \\\\ K & \\Delta & 0 \\\\ K & 0 & \\Delta \\end{pmatrix} $$\nTo find the eigenvalues, solve $\\det(H^{\\mathrm{CISD}} - E I) = 0$:\n$$ \\det \\begin{pmatrix} -E & K & K \\\\ K & \\Delta - E & 0 \\\\ K & 0 & \\Delta - E \\end{pmatrix} = 0 $$\n$$ -E(\\Delta-E)^2 - K(K(\\Delta-E)) + K(-K(\\Delta-E)) = 0 $$\n$$ -E(\\Delta-E)^2 - 2K^2(\\Delta-E) = 0 $$\n$$ -(\\Delta-E)[E(\\Delta-E) + 2K^2] = 0 $$\nThis yields one root $E = \\Delta$, and the roots of the quadratic equation $E(\\Delta-E) + 2K^2 = 0$, which is $E^2 - \\Delta E - 2K^2 = 0$.\n$$ E = \\frac{\\Delta \\pm \\sqrt{(-\\Delta)^2 - 4(1)(-2K^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 8K^2}}{2} $$\nThe three eigenvalues are $\\Delta$, $\\frac{\\Delta + \\sqrt{\\Delta^2 + 8K^2}}{2}$, and $\\frac{\\Delta - \\sqrt{\\Delta^2 + 8K^2}}{2}$. The ground-state energy is the lowest value:\n$$ E_{\\mathrm{dimer}}^{\\mathrm{CISD}}(\\Delta,K) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8K^2}}{2} $$\n\n3. Size-consistency error.\nThe error is defined as $\\delta(\\Delta,K) \\equiv E_{\\mathrm{dimer}}^{\\mathrm{CISD}} - 2E_{\\mathrm{mono}}$.\n$$ \\delta(\\Delta,K) = \\left( \\frac{\\Delta - \\sqrt{\\Delta^2 + 8K^2}}{2} \\right) - 2 \\left( \\frac{\\Delta - \\sqrt{\\Delta^2 + 4K^2}}{2} \\right) $$\n$$ \\delta(\\Delta,K) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8K^2}}{2} - (\\Delta - \\sqrt{\\Delta^2 + 4K^2}) $$\n$$ \\delta(\\Delta,K) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8K^2} - 2\\Delta + 2\\sqrt{\\Delta^2 + 4K^2}}{2} $$\n$$ \\delta(\\Delta,K) = \\frac{2\\sqrt{\\Delta^2 + 4K^2} - \\sqrt{\\Delta^2 + 8K^2} - \\Delta}{2} $$\nThis non-zero error for $K \\neq 0$ demonstrates the size-inconsistency of truncated CISD.\n\n4. FCI energy and FCIQMC.\nFor a system of two non-interacting fragments $A$ and $B$, the total Hamiltonian is $H = H_A + H_B$ (shorthand for $H_A \\otimes I_B + I_A \\otimes H_B$). The eigenvalues of $H$ are all possible sums of the eigenvalues of $H_A$ and $H_B$. The exact ground-state energy of the dimer is therefore the sum of the ground-state energies of the two fragments. This is the definition of size consistency, which FCI correctly reproduces.\n$$ E_{\\mathrm{dimer}}^{\\mathrm{FCI}} = E_{\\mathrm{mono}} + E_{\\mathrm{mono}} = 2E_{\\mathrm{mono}} = \\Delta - \\sqrt{\\Delta^2 + 4K^2} $$\nThe pathology of CISD arises from the truncation of the many-electron basis. The true ground state of the non-interacting dimer is the product of the fragment ground states. Each fragment ground state is a linear combination of $\\lvert 0_F \\rangle$ and $\\lvert 2_F \\rangle$. Their product thus contains a component of the form $\\lvert 2_A 2_B \\rangle$, which is a quadruple excitation with respect to the reference $\\lvert 0_A 0_B \\rangle$. The CISD method, by definition, excludes determinants with more than two excitations and thus cannot represent the true ground-state wavefunction. FCIQMC is a stochastic projector method that samples the full CI space. In the limit of exact sampling, it converges to the exact FCI ground-state energy. Therefore, FCIQMC would yield $E_{\\mathrm{dimer}}^{\\mathrm{FCI}} = 2E_{\\mathrm{mono}}$, and thus exhibits no size-consistency error. It avoids the pathology of truncated CISD by operating in the complete, untruncated (within the one-particle basis) many-electron space.", "answer": "$$\\boxed{\\frac{2\\sqrt{\\Delta^2 + 4K^2} - \\sqrt{\\Delta^2 + 8K^2} - \\Delta}{2}}$$", "id": "2803703"}, {"introduction": "Having established the motivation for FCI-level methods, we now explore the inner workings of the Full CI Quantum Monte Carlo (FCIQMC) algorithm. This exercise [@problem_id:2803677] demystifies the stochastic process by guiding you through a single propagation step for a small, well-defined system. By manually tracking a population of \"walkers\" through the core events of spawning, death/cloning, and annihilation, you will gain a concrete understanding of how the algorithm uses imaginary-time projection to sample the vast FCI space and converge on the ground-state solution.", "problem": "In a minimal Selected Configuration Interaction (Selected CI) subspace consisting of two Slater determinants $\\lvert D_{0} \\rangle$ and $\\lvert D_{1} \\rangle$, consider the imaginary-time stochastic projector dynamics of Full Configuration Interaction Quantum Monte Carlo (Full CI Quantum Monte Carlo, FCIQMC). The effective Hamiltonian matrix in this subspace has nonzero elements $H_{00}=-1.0$, $H_{11}=+0.5$, and $H_{01}=H_{10}=+0.2$, all in Hartree. The discrete time step is $\\delta \\tau = 0.1$ and the fixed population-control shift is $S=-0.8$ (both in Hartree units). \n\nAt the start of the step, the walker distribution is:\n- On $\\lvert D_{0} \\rangle$: $3$ positive and $1$ negative walkers.\n- On $\\lvert D_{1} \\rangle$: $1$ negative walker.\n\nAdopt the standard FCIQMC update for one time step with the following rules and order:\n- Spawning: For each walker on determinant $i$, select a connected determinant $j$ with probability $p_{\\mathrm{gen}}(j \\mid i)=1$ in this two-determinant model. Propose a spawn to $j$ with probability $p_{\\mathrm{s}}(j \\leftarrow i)=\\delta \\tau \\left| H_{ji} \\right|$. If a spawn occurs, the child’s sign is $s_{\\mathrm{child}}=-\\mathrm{sgn}(H_{ji})\\, s_{\\mathrm{parent}}$.\n- Death/Cloning: For each parent walker on determinant $i$, apply a diagonal event with probability $p_{\\mathrm{d}}(i)=\\delta \\tau \\left( H_{ii}-S \\right)$. If $p_{\\mathrm{d}}(i) \\ge 0$, the walker dies with probability $p_{\\mathrm{d}}(i)$. If $p_{\\mathrm{d}}(i)<0$, a clone is created with probability $-p_{\\mathrm{d}}(i)$ (same sign and determinant).\n- Annihilation: After completing spawning and death/cloning for the parents, sum all contributions (original survivors, spawned children, and clones) on each determinant and annihilate by cancelling opposite-signed walkers locally.\n\nUse the following independent uniform random numbers in $\\left[0,1\\right)$ to decide each Bernoulli event:\n- Spawning attempts from $\\lvert D_{0} \\rangle$ to $\\lvert D_{1} \\rangle$ for the four initial walkers in the sequence: positive-$a$ uses $0.4$, positive-$b$ uses $0.015$, positive-$c$ uses $0.8$, negative-$a$ uses $0.010$.\n- Spawning attempt from $\\lvert D_{1} \\rangle$ to $\\lvert D_{0} \\rangle$ for its initial walker: $0.70$.\n- Death/cloning on $\\lvert D_{0} \\rangle$ for the same four initial walkers in the same sequence: $0.010$, $0.50$, $0.50$, $0.30$.\n- Death on $\\lvert D_{1} \\rangle$ for its initial walker: $0.50$.\n\nTake the projected energy estimator with reference $\\lvert D_{0} \\rangle$ to be\n$$\nE_{\\mathrm{proj}} \\equiv \\frac{\\sum_{j \\in \\{0,1\\}} H_{0j} \\, N_{j}}{N_{0}},\n$$\nwhere $N_{j}$ is the signed walker count on $\\lvert D_{j} \\rangle$ after annihilation. Compute the change in the projected energy estimator over this one step,\n$$\n\\Delta E_{\\mathrm{proj}} \\equiv E_{\\mathrm{proj}}^{\\text{after}} - E_{\\mathrm{proj}}^{\\text{before}},\n$$\nand give your final answer as an exact value in Hartree (do not round). The final answer must be a single number.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It provides a complete and consistent set of data and rules to execute a single, deterministic step of a standard Full Configuration Interaction Quantum Monte Carlo (FCIQMC) simulation. The problem is a direct and formalizable application of principles in theoretical chemistry. Therefore, a solution will be provided.\n\nThe objective is to compute the change in the projected energy, $\\Delta E_{\\mathrm{proj}} = E_{\\mathrm{proj}}^{\\text{after}} - E_{\\mathrm{proj}}^{\\text{before}}$, over one time step $\\delta \\tau = 0.1$.\n\nFirst, we establish the initial state and calculate the projected energy before the step, $E_{\\mathrm{proj}}^{\\text{before}}$.\nThe initial signed walker counts on the Slater determinants $\\lvert D_{0} \\rangle$ and $\\lvert D_{1} \\rangle$ are:\n- $N_{0}^{\\text{before}} = (+1) \\times 3 + (-1) \\times 1 = 2$\n- $N_{1}^{\\text{before}} = (+1) \\times 0 + (-1) \\times 1 = -1$\n\nThe projected energy estimator is defined as $E_{\\mathrm{proj}} \\equiv \\frac{\\sum_{j} H_{0j} \\, N_{j}}{N_{0}}$. The relevant Hamiltonian matrix elements are $H_{00}=-1.0$ and $H_{01}=+0.2$.\nThe initial projected energy is:\n$$\nE_{\\mathrm{proj}}^{\\text{before}} = \\frac{H_{00} N_{0}^{\\text{before}} + H_{01} N_{1}^{\\text{before}}}{N_{0}^{\\text{before}}} = \\frac{(-1.0)(2) + (0.2)(-1)}{2} = \\frac{-2.0 - 0.2}{2} = \\frac{-2.2}{2} = -1.1\n$$\n\nNext, we simulate one time step according to the specified rules, in the order of spawning, death/cloning, and annihilation.\n\nSpawning Step:\nA spawn from determinant $\\lvert D_{i} \\rangle$ to $\\lvert D_{j} \\rangle$ occurs with probability $p_{\\mathrm{s}}(j \\leftarrow i) = \\delta \\tau \\left| H_{ji} \\right|$. The sign of the spawned child is $s_{\\mathrm{child}} = -\\mathrm{sgn}(H_{ji}) s_{\\mathrm{parent}}$.\n\n- Spawning from $\\lvert D_{0} \\rangle$ to $\\lvert D_{1} \\rangle$:\n  The probability is $p_{\\mathrm{s}}(1 \\leftarrow 0) = \\delta \\tau \\left| H_{10} \\right| = (0.1) |+0.2| = 0.02$.\n  The sign rule is $s_{\\mathrm{child}} = -\\mathrm{sgn}(+0.2) s_{\\mathrm{parent}} = -s_{\\mathrm{parent}}$.\n  There are $4$ parent walkers on $\\lvert D_{0} \\rangle$: $3$ positive (p-a, p-b, p-c) and $1$ negative (n-a). We check each against its random number $u$.\n  1. Walker p-a ($u=0.4$): $0.4 \\ge 0.02$. No spawn.\n  2. Walker p-b ($u=0.015$): $0.015 < 0.02$. Spawn occurs. Parent is positive, so a negative child is created on $\\lvert D_{1} \\rangle$.\n  3. Walker p-c ($u=0.8$): $0.8 \\ge 0.02$. No spawn.\n  4. Walker n-a ($u=0.010$): $0.010 < 0.02$. Spawn occurs. Parent is negative, so a positive child is created on $\\lvert D_{1} \\rangle$.\n  In total, spawning from $\\lvert D_{0} \\rangle$ creates one positive and one negative walker on $\\lvert D_{1} \\rangle$.\n\n- Spawning from $\\lvert D_{1} \\rangle$ to $\\lvert D_{0} \\rangle$:\n  The probability is $p_{\\mathrm{s}}(0 \\leftarrow 1) = \\delta \\tau \\left| H_{01} \\right| = (0.1) |+0.2| = 0.02$.\n  The sign rule is $s_{\\mathrm{child}} = -\\mathrm{sgn}(+0.2) s_{\\mathrm{parent}} = -s_{\\mathrm{parent}}$.\n  There is $1$ negative parent walker on $\\lvert D_{1} \\rangle$.\n  1. Walker ($u=0.70$): $0.70 \\ge 0.02$. No spawn.\n  No walkers are spawned onto $\\lvert D_{0} \\rangle$.\n\nDeath/Cloning Step:\nThis is applied to the original parent walkers. The event probability is $p_{\\mathrm{d}}(i) = \\delta \\tau (H_{ii} - S)$, where $S = -0.8$.\n\n- On $\\lvert D_{0} \\rangle$:\n  The probability is $p_{\\mathrm{d}}(0) = (0.1) \\left( H_{00} - S \\right) = (0.1)(-1.0 - (-0.8)) = (0.1)(-0.2) = -0.02$.\n  Since $p_{\\mathrm{d}}(0) < 0$, cloning occurs with probability $-p_{\\mathrm{d}}(0) = 0.02$.\n  We check the $4$ parent walkers on $\\lvert D_{0} \\rangle$ against their random numbers $u$.\n  1. Walker p-a ($u=0.010$): $0.010 < 0.02$. Clone created. A new positive walker appears on $\\lvert D_{0} \\rangle$.\n  2. Walker p-b ($u=0.50$): $0.50 \\ge 0.02$. No clone.\n  3. Walker p-c ($u=0.50$): $0.50 \\ge 0.02$. No clone.\n  4. Walker n-a ($u=0.30$): $0.30 \\ge 0.02$. No clone.\n  The original $4$ walkers survive, and one positive clone is added to $\\lvert D_{0} \\rangle$.\n\n- On $\\lvert D_{1} \\rangle$:\n  The probability is $p_{\\mathrm{d}}(1) = (0.1) \\left( H_{11} - S \\right) = (0.1)(0.5 - (-0.8)) = (0.1)(1.3) = 0.13$.\n  Since $p_{\\mathrm{d}}(1) \\ge 0$, death occurs with probability $0.13$.\n  We check the $1$ negative parent walker on $\\lvert D_{1} \\rangle$ against its random number $u=0.50$.\n  1. Walker ($u=0.50$): $0.50 \\ge 0.13$. The walker survives.\n  The original negative walker on $\\lvert D_{1} \\rangle$ survives.\n\nAnnihilation Step:\nWe now sum all walkers (survivors, clones, spawned children) on each determinant and annihilate opposite-signed pairs.\n\n- On $\\lvert D_{0} \\rangle$:\n  - Original survivors: $3$ positive, $1$ negative.\n  - Spawned children: $0$.\n  - Clones: $1$ positive.\n  - Total before annihilation: $(3+1)$ positive, $1$ negative $= 4$ positive, $1$ negative.\n  - Annihilation: $4 - 1 = 3$ positive walkers remain.\n  - The final signed count is $N_{0}^{\\text{after}} = +3$.\n\n- On $\\lvert D_{1} \\rangle$:\n  - Original survivor: $1$ negative.\n  - Spawned children: $1$ positive, $1$ negative.\n  - Clones: $0$.\n  - Total before annihilation: $1$ positive, $(1+1)$ negative $= 1$ positive, $2$ negative.\n  - Annihilation: $2 - 1 = 1$ negative walker remains.\n  - The final signed count is $N_{1}^{\\text{after}} = -1$.\n\nFinally, we compute the projected energy after the step, $E_{\\mathrm{proj}}^{\\text{after}}$, and its change, $\\Delta E_{\\mathrm{proj}}$.\n$$\nE_{\\mathrm{proj}}^{\\text{after}} = \\frac{H_{00} N_{0}^{\\text{after}} + H_{01} N_{1}^{\\text{after}}}{N_{0}^{\\text{after}}} = \\frac{(-1.0)(3) + (0.2)(-1)}{3} = \\frac{-3.0 - 0.2}{3} = -\\frac{3.2}{3}\n$$\nThe change in projected energy is:\n$$\n\\Delta E_{\\mathrm{proj}} = E_{\\mathrm{proj}}^{\\text{after}} - E_{\\mathrm{proj}}^{\\text{before}} = \\left(-\\frac{3.2}{3}\\right) - (-1.1) = -\\frac{3.2}{3} + \\frac{1.1}{1}\n$$\nTo express this as an exact fraction:\n$$\n\\Delta E_{\\mathrm{proj}} = -\\frac{32}{30} + \\frac{11}{10} = -\\frac{32}{30} + \\frac{33}{30} = \\frac{33 - 32}{30} = \\frac{1}{30}\n$$\nThe change in the projected energy estimator over this one step is exactly $\\frac{1}{30}$ Hartree.", "answer": "$$\\boxed{\\frac{1}{30}}$$", "id": "2803677"}, {"introduction": "A Quantum Monte Carlo simulation does not produce a single, definitive energy but rather a time series of correlated estimates. Extracting a reliable final result and its uncertainty from this data is a crucial skill. This practice [@problem_id:2803682] addresses the essential task of statistical analysis, where you will derive the formula for the variance of the sample mean from first principles using a blocking analysis. This exercise illuminates the concept of the integrated autocorrelation time, $\\tau_{\\mathrm{int}}$, and demonstrates how it quantifies the effective number of independent samples, which is fundamental to reporting a statistically sound result.", "problem": "In Selected Configuration Interaction (SCI) and Full Configuration Interaction Quantum Monte Carlo (FCIQMC), one often monitors a projected-energy time series $\\{O_t\\}_{t=1}^{N}$ obtained at discrete imaginary-time iterations separated by a fixed imaginary-time step $\\delta \\tau$ (in atomic units (a.u.)). Assume $\\{O_t\\}$ is a wide-sense stationary, unbiased estimator of the exact projected energy with finite variance $\\sigma^{2} = \\operatorname{Var}(O_t)$ and autocovariance function $C(k) = \\mathbb{E}[(O_t - \\mu)(O_{t+k} - \\mu)]$, where $\\mu = \\mathbb{E}[O_t]$ and $k$ is the integer lag.\n\n1) Define the normalized autocorrelation function $\\rho(k)$ and the integrated autocorrelation time $\\tau_{\\mathrm{int}}$ for the discrete-time series $\\{O_t\\}$.\n\n2) Using only the definitions in part (1), the stationarity of $\\{O_t\\}$, and a blocking analysis construction in which the data are partitioned into $M$ non-overlapping blocks of consecutive length $b$ (so $N = M b$), derive the large-$N$ expression for the variance of the sample mean $\\bar{O} = \\frac{1}{N}\\sum_{t=1}^{N} O_t$ in terms of $\\sigma^{2}$ and $\\tau_{\\mathrm{int}}$. Your derivation must proceed by: (i) forming the block averages $\\bar{O}^{(b)}_j = \\frac{1}{b}\\sum_{t=(j-1)b+1}^{jb} O_t$, (ii) expressing $\\operatorname{Var}(\\bar{O})$ in terms of $\\operatorname{Var}(\\bar{O}^{(b)}_j)$ and $M$, and (iii) taking a limit of large block size $b$ relative to the correlation length so that inter-block correlations are negligible, to obtain a closed-form dependence on $\\tau_{\\mathrm{int}}$.\n\n3) Consider an FCIQMC calculation in which the normalized autocorrelation function of the projected-energy time series is well described by a single-exponential decay $\\rho(k) = \\exp(-k\\,\\delta \\tau/\\tau_{c})$, where $\\tau_{c}$ is a characteristic decay time. Let $\\delta \\tau = 0.001$ a.u., $\\tau_{c} = 0.01$ a.u., $N = 10^{6}$ iterations, and per-iteration variance $\\sigma^{2} = 0.09$ in Hartree squared (Ha$^{2}$). Using your derived result, compute the variance of the sample mean $\\operatorname{Var}(\\bar{O})$. Round your answer to four significant figures. Express your final result in Hartree squared (Ha$^{2}$).", "solution": "The problem as stated is scientifically grounded, well-posed, and free of contradictions. It presents a standard, albeit non-trivial, exercise in the statistical analysis of time-series data from a Monte Carlo simulation, a fundamental topic in computational theoretical chemistry. I will therefore proceed with a complete solution.\n\n1) Definition of statistical quantities for the discrete-time series $\\{O_t\\}$:\n\nThe normalized autocorrelation function, $\\rho(k)$, for a wide-sense stationary process is defined as the autocovariance function $C(k)$ normalized by the variance of the process. The variance is the autocovariance at zero lag, $C(0)$.\nGiven $C(k) = \\mathbb{E}[(O_t - \\mu)(O_{t+k} - \\mu)]$ and $\\sigma^{2} = \\operatorname{Var}(O_t) = C(0)$, the normalized autocorrelation function is:\n$$\n\\rho(k) = \\frac{C(k)}{C(0)} = \\frac{C(k)}{\\sigma^{2}}\n$$\nBy definition, $\\rho(0) = 1$. Due to stationarity, $C(k) = C(-k)$, which implies $\\rho(k) = \\rho(-k)$.\n\nThe integrated autocorrelation time, $\\tau_{\\mathrm{int}}$, quantifies the number of simulation steps required to produce a statistically independent data point. For a discrete-time series, it is defined by a sum over the normalized autocorrelation function. A standard definition, which is consistent with the blocking analysis that follows, is:\n$$\n\\tau_{\\mathrm{int}} = \\frac{1}{2} + \\sum_{k=1}^{\\infty} \\rho(k)\n$$\nThis quantity, $\\tau_{\\mathrm{int}}$, is dimensionless and represents the autocorrelation time in units of the lag step, $k$.\n\n2) Derivation of the variance of the sample mean $\\bar{O}$:\n\nThe derivation proceeds according to the specified steps.\nThe sample mean of the entire time series is $\\bar{O} = \\frac{1}{N}\\sum_{t=1}^{N} O_t$.\n\n(i) The data are partitioned into $M$ non-overlapping blocks of length $b$, where $N=Mb$. The block average for the $j$-th block is given as:\n$$\n\\bar{O}^{(b)}_j = \\frac{1}{b}\\sum_{t=(j-1)b+1}^{jb} O_t\n$$\nThe overall sample mean $\\bar{O}$ can be expressed as the average of these block means:\n$$\n\\bar{O} = \\frac{1}{N}\\sum_{t=1}^{N} O_t = \\frac{1}{Mb}\\sum_{j=1}^{M} \\sum_{t=(j-1)b+1}^{jb} O_t = \\frac{1}{M}\\sum_{j=1}^{M} \\left( \\frac{1}{b}\\sum_{t=(j-1)b+1}^{jb} O_t \\right) = \\frac{1}{M}\\sum_{j=1}^{M} \\bar{O}^{(b)}_j\n$$\n\n(ii) The variance of the sample mean, $\\operatorname{Var}(\\bar{O})$, can now be expressed in terms of the block averages:\n$$\n\\operatorname{Var}(\\bar{O}) = \\operatorname{Var}\\left(\\frac{1}{M}\\sum_{j=1}^{M} \\bar{O}^{(b)}_j\\right) = \\frac{1}{M^2} \\operatorname{Var}\\left(\\sum_{j=1}^{M} \\bar{O}^{(b)}_j\\right) = \\frac{1}{M^2} \\sum_{j=1}^{M}\\sum_{l=1}^{M} \\operatorname{Cov}(\\bar{O}^{(b)}_j, \\bar{O}^{(b)}_l)\n$$\n\n(iii) In the limit of large block size $b$, specifically when $b$ is much larger than the correlation length of the series, the block averages $\\bar{O}^{(b)}_j$ and $\\bar{O}^{(b)}_l$ for $j \\neq l$ become statistically independent. This means their covariance is negligible: $\\operatorname{Cov}(\\bar{O}^{(b)}_j, \\bar{O}^{(b)}_l) \\approx 0$ for $j \\neq l$. The double summation thus collapses to a single sum over the variances:\n$$\n\\operatorname{Var}(\\bar{O}) \\approx \\frac{1}{M^2} \\sum_{j=1}^{M} \\operatorname{Var}(\\bar{O}^{(b)}_j)\n$$\nSince the original series $\\{O_t\\}$ is stationary, the statistical properties of the block averages are independent of the block index $j$. Thus, $\\operatorname{Var}(\\bar{O}^{(b)}_j) = \\operatorname{Var}(\\bar{O}^{(b)})$ for all $j$. The expression simplifies to:\n$$\n\\operatorname{Var}(\\bar{O}) \\approx \\frac{1}{M^2} M \\operatorname{Var}(\\bar{O}^{(b)}) = \\frac{1}{M} \\operatorname{Var}(\\bar{O}^{(b)})\n$$\nNext, we must find an expression for $\\operatorname{Var}(\\bar{O}^{(b)})$. For a generic block (we drop the index $j$):\n$$\n\\operatorname{Var}(\\bar{O}^{(b)}) = \\operatorname{Var}\\left(\\frac{1}{b}\\sum_{t=1}^{b} O_t\\right) = \\frac{1}{b^2} \\sum_{t=1}^{b}\\sum_{s=1}^{b} \\operatorname{Cov}(O_t, O_s)\n$$\nUsing the stationarity property $\\operatorname{Cov}(O_t, O_s) = C(|t-s|)$, we have:\n$$\n\\operatorname{Var}(\\bar{O}^{(b)}) = \\frac{1}{b^2} \\sum_{t=1}^{b}\\sum_{s=1}^{b} C(|t-s|)\n$$\nThis double sum can be rewritten by grouping terms with the same lag $k = t-s$. There are $b-|k|$ such pairs for a lag $k$.\n$$\n\\operatorname{Var}(\\bar{O}^{(b)}) = \\frac{1}{b^2} \\sum_{k=-(b-1)}^{b-1} (b-|k|) C(k) = \\frac{1}{b^2} \\left( b C(0) + \\sum_{k=1}^{b-1} 2(b-k)C(k) \\right)\n$$\nDividing by $b$ and using $C(k) = \\sigma^2 \\rho(k)$:\n$$\n\\operatorname{Var}(\\bar{O}^{(b)}) = \\frac{\\sigma^2}{b} \\left( 1 + 2 \\sum_{k=1}^{b-1} (1-\\frac{k}{b}) \\rho(k) \\right)\n$$\nSubstituting this into our expression for $\\operatorname{Var}(\\bar{O})$ and using $N=Mb$:\n$$\n\\operatorname{Var}(\\bar{O}) \\approx \\frac{1}{M} \\left[ \\frac{\\sigma^2}{b} \\left( 1 + 2 \\sum_{k=1}^{b-1} (1-\\frac{k}{b}) \\rho(k) \\right) \\right] = \\frac{\\sigma^2}{N} \\left( 1 + 2 \\sum_{k=1}^{b-1} (1-\\frac{k}{b}) \\rho(k) \\right)\n$$\nFor a large block size $b$ such that $\\rho(k) \\to 0$ for $k \\ll b$, the term $k/b$ becomes negligible for all relevant $k$, and the sum limit can be extended to infinity.\n$$\n\\operatorname{Var}(\\bar{O}) \\approx \\frac{\\sigma^2}{N} \\left( 1 + 2 \\sum_{k=1}^{\\infty} \\rho(k) \\right)\n$$\nUsing the definition of $\\tau_{\\mathrm{int}}$ from part (1), where $\\sum_{k=1}^{\\infty} \\rho(k) = \\tau_{\\mathrm{int}} - \\frac{1}{2}$, we obtain the final large-$N$ expression:\n$$\n\\operatorname{Var}(\\bar{O}) \\approx \\frac{\\sigma^2}{N} \\left( 1 + 2 (\\tau_{\\mathrm{int}} - \\frac{1}{2}) \\right) = \\frac{\\sigma^2}{N} (1 + 2\\tau_{\\mathrm{int}} - 1) = \\frac{2\\sigma^2 \\tau_{\\mathrm{int}}}{N}\n$$\n\n3) Calculation for the specific FCIQMC case:\n\nWe are given $\\rho(k) = \\exp(-k\\,\\delta \\tau/\\tau_{c})$. We first calculate the sum $\\sum_{k=1}^{\\infty} \\rho(k)$. This is a geometric series:\n$$\n\\sum_{k=1}^{\\infty} \\rho(k) = \\sum_{k=1}^{\\infty} \\left( \\exp(-\\frac{\\delta \\tau}{\\tau_{c}}) \\right)^k\n$$\nThe sum of a geometric series $\\sum_{k=1}^{\\infty} r^k$ is $\\frac{r}{1-r}$ for $|r|<1$. Here, $r = \\exp(-\\frac{\\delta \\tau}{\\tau_{c}})$.\n$$\n\\sum_{k=1}^{\\infty} \\rho(k) = \\frac{\\exp(-\\frac{\\delta \\tau}{\\tau_{c}})}{1 - \\exp(-\\frac{\\delta \\tau}{\\tau_{c}})}\n$$\nSubstitute this into the expression for the variance:\n$$\n\\operatorname{Var}(\\bar{O}) = \\frac{\\sigma^2}{N} \\left( 1 + 2 \\frac{\\exp(-\\frac{\\delta \\tau}{\\tau_{c}})}{1 - \\exp(-\\frac{\\delta \\tau}{\\tau_{c}})} \\right) = \\frac{\\sigma^2}{N} \\left( \\frac{1 - \\exp(-\\frac{\\delta \\tau}{\\tau_{c}}) + 2\\exp(-\\frac{\\delta \\tau}{\\tau_{c}})}{1 - \\exp(-\\frac{\\delta \\tau}{\\tau_{c}})} \\right)\n$$\n$$\n\\operatorname{Var}(\\bar{O}) = \\frac{\\sigma^2}{N} \\left( \\frac{1 + \\exp(-\\frac{\\delta \\tau}{\\tau_{c}})}{1 - \\exp(-\\frac{\\delta \\tau}{\\tau_{c}})} \\right)\n$$\nThis expression is equivalent to $\\frac{\\sigma^2}{N} \\coth\\left(\\frac{\\delta\\tau}{2\\tau_c}\\right)$. Now, we substitute the given numerical values: $\\delta \\tau = 0.001$ a.u., $\\tau_{c} = 0.01$ a.u., $N = 10^{6}$, and $\\sigma^{2} = 0.09$ Ha$^{2}$.\n\nThe argument of the hyperbolic cotangent is:\n$$\n\\frac{\\delta\\tau}{2\\tau_c} = \\frac{0.001}{2 \\times 0.01} = \\frac{0.001}{0.02} = 0.05\n$$\nThe variance of the sample mean is:\n$$\n\\operatorname{Var}(\\bar{O}) = \\frac{0.09}{10^{6}} \\coth(0.05)\n$$\nWe compute the value of $\\coth(0.05)$:\n$$\n\\coth(0.05) \\approx 20.016675\n$$\nThus,\n$$\n\\operatorname{Var}(\\bar{O}) = (0.09 \\times 10^{-6}) \\times 20.016675 \\approx 1.80150075 \\times 10^{-6} \\text{ Ha}^{2}\n$$\nRounding this result to four significant figures gives:\n$$\n\\operatorname{Var}(\\bar{O}) \\approx 1.802 \\times 10^{-6} \\text{ Ha}^{2}\n$$\nThis result demonstrates that even with a large number of samples ($10^6$), the correlation between data points (indicated by $\\tau_{\\mathrm{int}} \\approx 10$) significantly inflates the variance of the mean compared to the uncorrelated case, for which the variance would be $\\sigma^2/N = 9 \\times 10^{-8}$.", "answer": "$$\n\\boxed{1.802 \\times 10^{-6}}\n$$", "id": "2803682"}]}