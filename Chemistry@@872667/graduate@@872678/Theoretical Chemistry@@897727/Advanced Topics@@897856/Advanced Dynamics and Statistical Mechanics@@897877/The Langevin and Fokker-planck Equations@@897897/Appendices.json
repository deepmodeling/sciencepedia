{"hands_on_practices": [{"introduction": "The harmonically bound Brownian particle, also known as the Ornstein-Uhlenbeck process, serves as a cornerstone model in statistical physics. It is one of the few non-trivial stochastic systems that can be solved analytically, making it an invaluable tool for building intuition. This practice [@problem_id:2815972] will guide you through the complete analysis of this system, from setting up the linear Langevin equations to deriving the time-correlation functions that describe how the particle's memory of its initial state fades over time. Mastering this calculation is essential for understanding relaxation phenomena and the interplay between friction, thermal noise, and a confining potential.", "problem": "Consider a single Brownian particle of mass $m$ moving in one spatial dimension in a harmonic potential $U(x)=\\tfrac{1}{2} k x^{2}$ and in contact with a heat bath at absolute temperature $T$. Let the solvent impose a linear Stokes friction with coefficient $\\gamma$ and a random force that satisfies the fluctuation-dissipation theorem. Starting only from Newton's second law and the fluctuation-dissipation theorem for the random force, write down the stochastic equations of motion for the position $x(t)$ and velocity $v(t)$, and the corresponding linear drift operator for the two-component state $(x,v)^{\\mathsf{T}}$. Then, using the framework of the Langevin and Fokker-Planck equations, derive the stationary time-dependent covariance matrix\n$$\nC(t) \\equiv \\begin{pmatrix}\n\\langle x(t)\\,x(0)\\rangle  \\langle x(t)\\,v(0)\\rangle \\\\\n\\langle v(t)\\,x(0)\\rangle  \\langle v(t)\\,v(0)\\rangle\n\\end{pmatrix},\n$$\nfor $t \\ge 0$ under equilibrium initial conditions. Provide explicit expressions for all four entries in terms of $m$, $\\gamma$, $k$, $k_{B}$, $T$, and $t$, and discuss how the functional form changes in the underdamped regime and the overdamped regime. Finally, extract the two relaxation rates that govern the exponential relaxation of correlations in both regimes, expressed solely in terms of $m$, $\\gamma$, and $k$. Report these two rates as a single row matrix using the LaTeX $\\texttt{pmatrix}$ environment. No numerical evaluation is required, and you should leave all constants symbolic. The final answer must be the pair of rates only, as a single closed-form analytic expression without units.", "solution": "The problem as stated is scientifically sound, well-posed, objective, and self-contained. It is a standard problem in statistical physics concerning the Ornstein-Uhlenbeck process, which models a harmonically bound Brownian particle. All required parameters and conditions are provided, and no inconsistencies or ambiguities are present. Therefore, the problem is valid and a solution will be provided.\n\nThe motion of the particle is governed by Newton's second law, which includes the harmonic potential force, a linear friction force, and a stochastic random force from the heat bath. The equation of motion is the Langevin equation:\n$$\nm \\frac{d^2x}{dt^2} = -k x - \\gamma \\frac{dx}{dt} + R(t)\n$$\nwhere $m$ is the mass, $k$ is the spring constant of the harmonic potential $U(x) = \\frac{1}{2} k x^2$, $\\gamma$ is the friction coefficient, and $R(t)$ is the stochastic force.\n\nThe state of the system is described by the two-component vector $\\mathbf{z}(t) = (x(t), v(t))^{\\mathsf{T}}$, where $v(t) = dx/dt$ is the velocity. The second-order stochastic differential equation can be written as a system of two first-order equations:\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -\\frac{k}{m} x - \\frac{\\gamma}{m} v + \\frac{1}{m} R(t)\n$$\nThis system can be expressed in matrix form as a multivariate Ornstein-Uhlenbeck process:\n$$\n\\frac{d\\mathbf{z}}{dt} = A\\mathbf{z} + \\mathbf{f}(t)\n$$\nwhere the linear drift operator (or matrix) $A$ and the stochastic forcing term $\\mathbf{f}(t)$ are given by:\n$$\nA = \\begin{pmatrix} 0  1 \\\\ -\\frac{k}{m}  -\\frac{\\gamma}{m} \\end{pmatrix}, \\quad \\mathbf{f}(t) = \\begin{pmatrix} 0 \\\\ \\frac{1}{m} R(t) \\end{pmatrix}\n$$\nThe random force $R(t)$ is a white noise process satisfying the fluctuation-dissipation theorem, which specifies its statistical properties:\n$$\n\\langle R(t) \\rangle = 0\n$$\n$$\n\\langle R(t) R(t') \\rangle = 2\\gamma k_B T \\delta(t-t')\n$$\nwhere $k_B$ is the Boltzmann constant and $T$ is the absolute temperature.\n\nWe are asked to find the stationary time-dependent covariance matrix $C(t)$ for $t \\ge 0$, defined as:\n$$\nC(t) = \\langle \\mathbf{z}(t) \\mathbf{z}(0)^{\\mathsf{T}} \\rangle = \\begin{pmatrix} \\langle x(t)x(0)\\rangle  \\langle x(t)v(0)\\rangle \\\\ \\langle v(t)x(0)\\rangle  \\langle v(t)v(0)\\rangle \\end{pmatrix}\n$$\nThe formal solution to the linear stochastic differential equation is:\n$$\n\\mathbf{z}(t) = e^{At} \\mathbf{z}(0) + \\int_0^t e^{A(t-s)} \\mathbf{f}(s) ds\n$$\nSubstituting this into the definition of $C(t)$:\n$$\nC(t) = \\left\\langle \\left( e^{At} \\mathbf{z}(0) + \\int_0^t e^{A(t-s)} \\mathbf{f}(s) ds \\right) \\mathbf{z}(0)^{\\mathsf{T}} \\right\\rangle\n$$\nSince the system is in equilibrium, the initial state $\\mathbf{z}(0)$ is uncorrelated with the random force $\\mathbf{f}(s)$ for any $s > 0$. Thus, the cross-term vanishes: $\\langle \\mathbf{f}(s) \\mathbf{z}(0)^{\\mathsf{T}} \\rangle = 0$. This simplifies the expression to:\n$$\nC(t) = e^{At} \\langle \\mathbf{z}(0) \\mathbf{z}(0)^{\\mathsf{T}} \\rangle = e^{At} \\Sigma\n$$\nwhere $\\Sigma$ is the equal-time covariance matrix at equilibrium. The components of $\\Sigma$ are determined from the equilibrium Maxwell-Boltzmann distribution $P_{eq}(x,v) \\propto \\exp\\left(-\\frac{H(x,v)}{k_B T}\\right)$, where the Hamiltonian is $H(x,v) = \\frac{1}{2}kx^2 + \\frac{1}{2}mv^2$.\nFrom the equipartition theorem, the average energy per quadratic degree of freedom is $\\frac{1}{2}k_B T$:\n$$\n\\langle \\tfrac{1}{2}kx^2 \\rangle_{eq} = \\tfrac{1}{2}k_B T \\implies \\langle x^2 \\rangle_{eq} = \\frac{k_B T}{k}\n$$\n$$\n\\langle \\tfrac{1}{2}mv^2 \\rangle_{eq} = \\tfrac{1}{2}k_B T \\implies \\langle v^2 \\rangle_{eq} = \\frac{k_B T}{m}\n$$\nThe cross-correlation $\\langle xv \\rangle_{eq}$ is zero because the equilibrium distribution is separable in $x$ and $v$, and the average of an odd function of $v$ (or $x$) over a symmetric interval is zero. Thus, the equilibrium covariance matrix is:\n$$\n\\Sigma = \\begin{pmatrix} \\langle x^2 \\rangle_{eq}  \\langle xv \\rangle_{eq} \\\\ \\langle vx \\rangle_{eq}  \\langle v^2 \\rangle_{eq} \\end{pmatrix} = \\begin{pmatrix} \\frac{k_B T}{k}  0 \\\\ 0  \\frac{k_B T}{m} \\end{pmatrix}\n$$\nTo find $C(t)$, we must compute the matrix exponential $e^{At}$. This is done by finding the eigenvalues and eigenvectors of $A$. The characteristic equation is $\\det(A - \\lambda I) = 0$:\n$$\n\\det\\begin{pmatrix} -\\lambda  1 \\\\ -\\frac{k}{m}  -\\frac{\\gamma}{m}-\\lambda \\end{pmatrix} = (-\\lambda)(-\\tfrac{\\gamma}{m}-\\lambda) - (-\\tfrac{k}{m}) = \\lambda^2 + \\frac{\\gamma}{m}\\lambda + \\frac{k}{m} = 0\n$$\nThe eigenvalues are the roots of this quadratic equation:\n$$\n\\lambda_{\\pm} = \\frac{-\\frac{\\gamma}{m} \\pm \\sqrt{(\\frac{\\gamma}{m})^2 - \\frac{4k}{m}}}{2} = \\frac{-\\gamma \\pm \\sqrt{\\gamma^2 - 4mk}}{2m}\n$$\nThe matrix exponential $e^{At}$ can be written as $e^{At} = c_0(t)I + c_1(t)A$ by the Cayley-Hamilton theorem, or found by diagonalization. For distinct eigenvalues $\\lambda_+, \\lambda_-$, the general form of $e^{At}$ is:\n$$\ne^{At} = \\frac{1}{\\lambda_+ - \\lambda_-} \\begin{pmatrix} \\lambda_+ e^{\\lambda_- t} - \\lambda_- e^{\\lambda_+ t}  e^{\\lambda_+ t} - e^{\\lambda_- t} \\\\ -\\frac{k}{m}(e^{\\lambda_+ t} - e^{\\lambda_- t})  \\lambda_+ e^{\\lambda_+ t} - \\lambda_- e^{\\lambda_- t} \\end{pmatrix}\n$$\nNow we compute $C(t) = e^{At}\\Sigma$:\n$$\nC(t) = \\frac{1}{\\lambda_+ - \\lambda_-} \\begin{pmatrix} \\lambda_+ e^{\\lambda_- t} - \\lambda_- e^{\\lambda_+ t}  e^{\\lambda_+ t} - e^{\\lambda_- t} \\\\ -\\frac{k}{m}(e^{\\lambda_+ t} - e^{\\lambda_- t})  \\lambda_+ e^{\\lambda_+ t} - \\lambda_- e^{\\lambda_- t} \\end{pmatrix} \\begin{pmatrix} \\frac{k_B T}{k}  0 \\\\ 0  \\frac{k_B T}{m} \\end{pmatrix}\n$$\nThe four entries of the covariance matrix are:\n$$\n\\langle x(t)x(0) \\rangle = \\frac{k_B T}{k(\\lambda_+ - \\lambda_-)} (\\lambda_+ e^{\\lambda_- t} - \\lambda_- e^{\\lambda_+ t})\n$$\n$$\n\\langle x(t)v(0) \\rangle = \\frac{k_B T}{m(\\lambda_+ - \\lambda_-)} (e^{\\lambda_+ t} - e^{\\lambda_- t})\n$$\n$$\n\\langle v(t)x(0) \\rangle = \\frac{k_B T}{k(\\lambda_+ - \\lambda_-)} \\left(-\\frac{k}{m}\\right)(e^{\\lambda_+ t} - e^{\\lambda_- t}) = -\\frac{k_B T}{m(\\lambda_+ - \\lambda_-)} (e^{\\lambda_+ t} - e^{\\lambda_- t})\n$$\n$$\n\\langle v(t)v(0) \\rangle = \\frac{k_B T}{m(\\lambda_+ - \\lambda_-)} (\\lambda_+ e^{\\lambda_+ t} - \\lambda_- e^{\\lambda_- t})\n$$\nThe functional form of these correlations depends on the sign of the discriminant $\\Delta = \\gamma^2 - 4mk$.\n\n1.  **Overdamped regime ($\\gamma^2 > 4mk$):** The eigenvalues $\\lambda_+$ and $\\lambda_-$ are distinct, real, and negative. The correlation functions are sums of two decaying real exponentials, $e^{\\lambda_+ t}$ and $e^{\\lambda_- t}$. There are no oscillations. The system relaxes monotonically to equilibrium.\n\n2.  **Underdamped regime ($\\gamma^2  4mk$):** The eigenvalues are a complex conjugate pair:\n    $$\n    \\lambda_{\\pm} = -\\frac{\\gamma}{2m} \\pm i\\omega_1, \\quad \\text{where} \\quad \\omega_1 = \\frac{\\sqrt{4mk - \\gamma^2}}{2m} = \\sqrt{\\frac{k}{m} - \\left(\\frac{\\gamma}{2m}\\right)^2}\n    $$\n    In this case, $\\lambda_+ - \\lambda_- = -2i\\omega_1$. The correlation functions exhibit damped oscillations. For example, the velocity autocorrelation function becomes:\n    $$\n    \\langle v(t)v(0) \\rangle = \\frac{k_B T}{m(-2i\\omega_1)} ((-\\frac{\\gamma}{2m}-i\\omega_1)e^{(-\\frac{\\gamma}{2m}+i\\omega_1)t} - (-\\frac{\\gamma}{2m}+i\\omega_1)e^{(-\\frac{\\gamma}{2m}-i\\omega_1)t})\n    $$\n    $$\n    \\langle v(t)v(0) \\rangle = \\frac{k_B T}{m} e^{-\\frac{\\gamma t}{2m}} \\left(\\cos(\\omega_1 t) - \\frac{\\gamma}{2m\\omega_1} \\sin(\\omega_1 t)\\right)\n    $$\n    The correlations decay with an envelope function $e^{-\\gamma t/(2m)}$ and oscillate with frequency $\\omega_1$. Similar expressions hold for the other matrix elements.\n\n3.  **Critically damped regime ($\\gamma^2 = 4mk$):** The eigenvalues are repeated and real, $\\lambda_+ = \\lambda_- = -\\gamma/(2m)$. The correlation functions decay as $(c_1 + c_2 t)e^{-\\gamma t/(2m)}$, which is the fastest possible decay without oscillation.\n\nThe problem asks for the two relaxation rates that govern the exponential relaxation. These rates correspond to the decay of the system's eigenmodes and are given by the negative of the eigenvalues $\\lambda_{\\pm}$.\nLet the rates be $r_1$ and $r_2$.\n$$\nr_{1,2} = -\\lambda_{\\pm} = \\frac{\\gamma \\mp \\sqrt{\\gamma^2 - 4mk}}{2m}\n$$\nThese two expressions provide the two real relaxation rates in the overdamped regime, and they become a complex conjugate pair in the underdamped regime, where the real part gives the decay rate and the imaginary part gives the oscillation frequency. These two rates fully characterize the dynamics of relaxation in all regimes.\nThe two rates are:\n$$\n\\frac{\\gamma + \\sqrt{\\gamma^2 - 4mk}}{2m} \\quad \\text{and} \\quad \\frac{\\gamma - \\sqrt{\\gamma^2 - 4mk}}{2m}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\gamma + \\sqrt{\\gamma^2 - 4mk}}{2m}  \\frac{\\gamma - \\sqrt{\\gamma^2 - 4mk}}{2m} \\end{pmatrix}}\n$$", "id": "2815972"}, {"introduction": "Beyond describing the trajectory of a particle, the Langevin formalism provides powerful tools to calculate the timescales of important events, such as a chemical reaction or a protein folding step. This exercise [@problem_id:2932592] introduces the concept of the Mean First Passage Time (MFPT), which quantifies the average time it takes for a stochastic process to first reach a target state. You will derive and solve the governing differential equation for the MFPT, learning how to incorporate physical constraints like reflecting and absorbing boundaries into your mathematical model.", "problem": "A single coarse-grained bead of a flexible polymer in a nanochannel is modeled by an overdamped one-dimensional coordinate $x(t)$ constrained to the interval $[0,L]$, where $x(t)=0$ represents a hard reflecting wall and $x(t)=L$ represents an absorbing exit. The bead undergoes thermal diffusion with constant diffusivity $D$ and no systematic drift, governed at mesoscopic scales by the overdamped Langevin equation\n$$\n\\frac{dx}{dt}=\\sqrt{2D}\\,\\eta(t),\n$$\nwhere $\\eta(t)$ is standard Gaussian white noise with $\\langle \\eta(t)\\rangle = 0$ and $\\langle \\eta(t)\\eta(t')\\rangle=\\delta(t-t')$. Let $p(x,t\\,|\\,x_0,0)$ denote the conditional probability density for $x(t)$ given $x(0)=x_0\\in[0,L]$. The corresponding Fokker–Planck equation (FPE) for $p(x,t\\,|\\,x_0,0)$ is to be used together with physically correct boundary conditions for a reflecting wall at $x=0$ and an absorbing boundary at $x=L$.\n\nDefine the mean first passage time (MFPT) $\\tau(x_0)$ as the expectation value of the random time to reach $x=L$ for the first time, starting from $x(0)=x_0$, under the dynamics above. Starting from the Langevin model and the Fokker–Planck description as the fundamental base, derive and solve the boundary–value problem satisfied by $\\tau(x_0)$, imposing the correct boundary conditions associated with a reflecting endpoint at $x=0$ and an absorbing endpoint at $x=L$.\n\nProvide your final result as a single closed-form analytic expression for $\\tau(x_0)$ in terms of $L$, $x_0$, and $D$. Express your answer in symbolically simplified form. Do not include units in your final expression. Assume that $D$ is provided in $\\mathrm{m^2\\,s^{-1}}$ and that $L$ and $x_0$ are provided in $\\mathrm{m}$, so that $\\tau(x_0)$ is in $\\mathrm{s}$.", "solution": "The problem statement describes a classical one-dimensional diffusion process within a finite domain, subject to mixed boundary conditions. We first verify the correspondence between the given Langevin equation and the associated Fokker-Planck equation (FPE), and then derive and solve the boundary-value problem for the mean first passage time (MFPT).\n\nThe system is governed by the overdamped Langevin equation for the coordinate $x(t)$:\n$$\n\\frac{dx}{dt} = \\sqrt{2D}\\,\\eta(t)\n$$\nHere, the drift term is zero, and the diffusion term is constant. This corresponds to a Fokker-Planck equation for the conditional probability density $p(x,t) \\equiv p(x, t \\,|\\, x_0, 0)$ that is a simple diffusion equation:\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = D \\frac{\\partial^2 p(x,t)}{\\partial x^2}\n$$\nThe physical constraints on the system are expressed as boundary conditions on $p(x,t)$. The hard reflecting wall at $x=0$ implies that the probability flux $J(x,t) = -D \\frac{\\partial p}{\\partial x}$ must vanish. The absorbing exit at $x=L$ implies that the probability of finding the particle there is zero. Thus, the boundary conditions are:\n$$\n\\frac{\\partial p}{\\partial x}\\bigg|_{x=0} = 0 \\quad \\text{and} \\quad p(L,t) = 0\n$$\n\nThe quantity of interest is the mean first passage time $\\tau(x_0)$, defined as the average time for a particle starting at $x(0)=x_0$ to first reach the absorbing boundary at $x=L$. A standard method to determine $\\tau(x_0)$ is through the backward Kolmogorov equation. Let us consider the evolution of the system over a small time interval $\\Delta t$. The MFPT from a starting point $x_0$ can be related to the MFPT from the new position $x_0 + \\Delta x$ after time $\\Delta t$. This relation is expressed as:\n$$\n\\tau(x_0) = \\Delta t + \\langle \\tau(x_0 + \\Delta x) \\rangle\n$$\nThe average $\\langle \\dots \\rangle$ is taken over all possible displacements $\\Delta x$ during the interval $\\Delta t$. We perform a Taylor expansion of $\\tau(x_0 + \\Delta x)$ around $x_0$:\n$$\n\\tau(x_0 + \\Delta x) = \\tau(x_0) + \\frac{d\\tau}{dx_0} \\Delta x + \\frac{1}{2} \\frac{d^2\\tau}{dx_0^2} (\\Delta x)^2 + O((\\Delta x)^3)\n$$\nTaking the expectation value of this expansion gives:\n$$\n\\langle \\tau(x_0 + \\Delta x) \\rangle = \\tau(x_0) + \\frac{d\\tau}{dx_0} \\langle \\Delta x \\rangle + \\frac{1}{2} \\frac{d^2\\tau}{dx_0^2} \\langle (\\Delta x)^2 \\rangle + \\dots\n$$\nThe moments of the displacement $\\Delta x$ are determined from the Langevin equation. Over a small time $\\Delta t$:\n$$\n\\langle \\Delta x \\rangle = \\left\\langle \\int_0^{\\Delta t} \\sqrt{2D}\\,\\eta(t') dt' \\right\\rangle = \\sqrt{2D} \\int_0^{\\Delta t} \\langle \\eta(t') \\rangle dt' = 0\n$$\n$$\n\\langle (\\Delta x)^2 \\rangle = \\left\\langle \\left( \\int_0^{\\Delta t} \\sqrt{2D}\\,\\eta(t') dt' \\right)^2 \\right\\rangle = 2D \\int_0^{\\Delta t} \\int_0^{\\Delta t} \\langle \\eta(t') \\eta(t'') \\rangle dt' dt''\n$$\nUsing the property $\\langle \\eta(t') \\eta(t'') \\rangle = \\delta(t' - t'')$, the double integral reduces to a single integral:\n$$\n\\langle (\\Delta x)^2 \\rangle = 2D \\int_0^{\\Delta t} dt' = 2D \\Delta t\n$$\nHigher-order moments are of order $O((\\Delta t)^{3/2})$ or smaller and can be neglected. Substituting these moments back into the recursion for $\\tau(x_0)$:\n$$\n\\tau(x_0) = \\Delta t + \\tau(x_0) + \\frac{1}{2} \\frac{d^2\\tau}{dx_0^2} (2D \\Delta t)\n$$\nSubtracting $\\tau(x_0)$ from both sides and dividing by $\\Delta t$ yields the ordinary differential equation for the MFPT, often called Dynkin's equation:\n$$\nD \\frac{d^2\\tau}{dx_0^2} = -1\n$$\nThis equation must be solved subject to boundary conditions on $\\tau(x_0)$. These conditions are derived from the physical nature of the boundaries at $x_0=0$ and $x_0=L$.\n1. At the absorbing boundary $x_0=L$: If the particle starts at the exit, the time to reach it is zero. Therefore, $\\tau(L) = 0$.\n2. At the reflecting boundary $x_0=0$: A particle at an infinitesimal distance $\\epsilon$ from the wall has the same expectation of exit time as a particle that would be at $-\\epsilon$ in an unbounded system with the same exit at $L$. This symmetry implies that the MFPT must have an extremum at a reflecting wall. Consequently, its derivative must be zero. Thus, $\\frac{d\\tau}{dx_0}\\bigg|_{x_0=0} = 0$.\n\nWe now solve the boundary-value problem. Integrating the differential equation once with respect to $x_0$ yields:\n$$\n\\frac{d\\tau}{dx_0} = -\\frac{x_0}{D} + C_1\n$$\nwhere $C_1$ is a constant of integration. Applying the reflecting boundary condition at $x_0=0$:\n$$\n\\frac{d\\tau}{dx_0}\\bigg|_{x_0=0} = -\\frac{0}{D} + C_1 = 0 \\quad \\implies \\quad C_1 = 0\n$$\nThe equation for the first derivative simplifies to:\n$$\n\\frac{d\\tau}{dx_0} = -\\frac{x_0}{D}\n$$\nIntegrating a second time with respect to $x_0$ gives the general solution for $\\tau(x_0)$:\n$$\n\\tau(x_0) = \\int \\left( -\\frac{x_0}{D} \\right) dx_0 = -\\frac{x_0^2}{2D} + C_2\n$$\nwhere $C_2$ is the second constant of integration. We determine $C_2$ using the absorbing boundary condition at $x_0=L$:\n$$\n\\tau(L) = -\\frac{L^2}{2D} + C_2 = 0 \\quad \\implies \\quad C_2 = \\frac{L^2}{2D}\n$$\nSubstituting the value of $C_2$ back into the expression for $\\tau(x_0)$ gives the final result:\n$$\n\\tau(x_0) = \\frac{L^2}{2D} - \\frac{x_0^2}{2D}\n$$\nThis can be written in a more compact form. The result is physically consistent: the MFPT is maximal for a particle starting at the reflecting wall ($x_0=0$) and zero for a particle starting at the absorbing exit ($x_0=L$). The time scales as $L^2/D$, which is characteristic of diffusive processes.", "answer": "$$\n\\boxed{\\frac{L^{2} - x_{0}^{2}}{2D}}\n$$", "id": "2932592"}, {"introduction": "While analytical solutions are enlightening, most problems in modern theoretical chemistry are tackled with computer simulations. This hands-on practice [@problem_id:2815946] bridges the gap between continuous-time theory and discrete-time algorithms by having you analyze the widely used BAOAB splitting integrator for Langevin dynamics. By treating the algorithm as a discrete map for a harmonic oscillator, you can analytically compute its stationary properties and quantify its accuracy, providing deep insight into how numerical methods sample the correct equilibrium distribution and where errors can arise.", "problem": "Consider the one-dimensional underdamped Langevin dynamics for a particle of mass $m$ in a potential $U(x)$ coupled to a heat bath at temperature $T$ with friction coefficient $\\gamma$. The equations of motion are the stochastic differential equations (SDEs)\n$$\n\\frac{dx}{dt} = v,\\qquad m\\frac{dv}{dt} = -\\frac{dU}{dx}(x) - \\gamma m v + \\sqrt{2\\gamma m k_{\\mathrm{B}} T}\\,\\eta(t),\n$$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant and $\\eta(t)$ is standard white noise. Work in dimensionless reduced units such that $m = 1$, $k_{\\mathrm{B}}T = 1$, and all quantities are expressed in these units.\n\nYour task is to present the \"BAOAB\" splitting algorithm for the time discretization of the above dynamics and then analyze its configurational sampling bias for the harmonic potential $U(x) = \\tfrac{1}{2}k x^2$. Here, the \"BAOAB\" name refers to composing, in order, a half-step kick in momentum ($B$), a half-step drift in position ($A$), an Ornstein–Uhlenbeck (OU) stochastic momentum update ($O$), followed by another half-step drift ($A$), and a final half-step kick ($B$). The algorithm acts over a single timestep of size $\\Delta t$.\n\nStarting from fundamental principles only (Newton’s second law, the definition of the stochastic forcing with fluctuation–dissipation, and linear algebra for linear maps), do the following:\n\n1. Specify the BAOAB updates for the harmonic potential $U(x) = \\tfrac{1}{2}k x^2$ in one spatial dimension. Use $\\Delta t$ for the timestep, $\\gamma$ for the (dimensionless) friction, $k$ for the (dimensionless) spring constant, and standard normal variates for the random numbers. Do not assume any formula beyond the definitions given above.\n\n2. For the harmonic potential, show that a single BAOAB step maps the state vector $y_n = \\begin{bmatrix} x_n \\\\ p_n \\end{bmatrix}$ to $y_{n+1}$ via an affine transformation with additive Gaussian noise of the form\n$$\ny_{n+1} = M\\,y_n + G\\,\\xi_n,\n$$\nwith $\\xi_n \\sim \\mathcal{N}(0,1)$, and determine the matrices $M$ and $G$ explicitly in terms of $\\Delta t$, $\\gamma$, $k$, and the reduced-unit parameters.\n\n3. Using only first principles, determine the stationary configurational variance $\\operatorname{Var}[x]$ of the Markov chain defined by the BAOAB integrator for the harmonic potential. You must compute the stationary covariance matrix $\\Sigma$ that satisfies\n$$\n\\Sigma = M\\,\\Sigma\\,M^\\top + Q,\\qquad Q = GG^\\top,\n$$\nand then extract the configurational variance as the $(1,1)$ entry of $\\Sigma$.\n\n4. In the continuum limit, the exact configurational variance for the harmonic potential is $\\operatorname{Var}_{\\mathrm{exact}}[x] = \\frac{k_{\\mathrm{B}}T}{k}$. Define the signed fractional configurational bias as\n$$\n\\mathcal{B}(\\Delta t,\\gamma) = \\frac{\\operatorname{Var}_{\\mathrm{BAOAB}}[x] - \\operatorname{Var}_{\\mathrm{exact}}[x]}{\\operatorname{Var}_{\\mathrm{exact}}[x]}.\n$$\n\nCompute $\\mathcal{B}(\\Delta t,\\gamma)$ in reduced units with $m = 1$, $k_{\\mathrm{B}}T = 1$, and $k = 1$ for the following test suite of $(\\Delta t,\\gamma)$ pairs:\n- $(0.005, 1.0)$\n- $(0.050, 1.0)$\n- $(0.500, 1.0)$\n- $(1.500, 1.0)$\n- $(1.900, 1.0)$\n- $(0.200, 0.1)$\n- $(0.200, 5.0)$\n\nYour program must compute these seven values exactly for the linear Gaussian system by constructing $M$ and $G$ from the BAOAB composition and solving for the stationary covariance; do not estimate them by trajectory sampling.\n\nFinal output format:\n- Your program should produce a single line of output containing the seven signed fractional biases as a comma-separated list enclosed in square brackets, in the same order as above (for example, $[b_1,b_2,b_3,b_4,b_5,b_6,b_7]$). The entries must be floating-point numbers.", "solution": "The problem posed is a self-contained, mathematically well-defined exercise in the analysis of numerical integrators for stochastic differential equations. It is scientifically grounded in the principles of statistical mechanics and the theory of Markov chains. The problem is valid and permits a rigorous, analytical solution.\n\nWe begin by formalizing the system. The one-dimensional underdamped Langevin dynamics for a particle of mass $m$ in a harmonic potential $U(x) = \\frac{1}{2} k x^2$ are given by the stochastic differential equations:\n$$\n\\frac{dx}{dt} = v\n$$\n$$\nm\\frac{dv}{dt} = -kx - \\gamma mv + \\sqrt{2\\gamma m k_{\\mathrm{B}} T}\\,\\eta(t)\n$$\nIn reduced units where mass $m=1$ and thermal energy $k_{\\mathrm{B}}T=1$, and using momentum $p=mv=v$, the system simplifies to:\n$$\n\\frac{dx}{dt} = p\n$$\n$$\n\\frac{dp}{dt} = -kx - \\gamma p + \\sqrt{2\\gamma}\\,\\eta(t)\n$$\nWe will analyze the BAOAB splitting algorithm for these dynamics. The algorithm is a composition of five distinct operations applied sequentially over a timestep $\\Delta t$. The state of the system is represented by the vector $y = \\begin{bmatrix} x \\\\ p \\end{bmatrix}$.\n\n1.  **BAOAB Update Steps for the Harmonic Potential**\n\nThe BAOAB algorithm is constructed by splitting the Langevin Liouville operator into three parts: an update due to position drift (A), an update due to momentum kick from the conservative force (B), and an exact solution for the Ornstein-Uhlenbeck process governing momentum under friction and random force (O).\n\nLet the state at the beginning of a step be $(x_n, p_n)$. A single step of the BAOAB integrator producing $(x_{n+1}, p_{n+1})$ is as follows:\n\n-   **B-step (half-step kick, $\\Delta t/2$):** The momentum is updated by the conservative force $F(x) = -kx$ over a half-timestep.\n    $$\n    p \\leftarrow p + F(x) \\frac{\\Delta t}{2} = p - kx \\frac{\\Delta t}{2}\n    $$\n-   **A-step (half-step drift, $\\Delta t/2$):** The position is updated by the momentum over a half-timestep. Since $m=1$, $v=p$.\n    $$\n    x \\leftarrow x + p \\frac{\\Delta t}{2}\n    $$\n-   **O-step (full-step OU update, $\\Delta t$):** The momentum is updated by solving the Ornstein-Uhlenbeck SDE $dp_t = -\\gamma p_t dt + \\sqrt{2\\gamma} dW_t$ exactly over a full timestep $\\Delta t$. The solution is:\n    $$\n    p \\leftarrow p \\cdot e^{-\\gamma \\Delta t} + \\sqrt{k_B T(1 - e^{-2\\gamma \\Delta t})} \\cdot \\xi\n    $$\n    where $\\xi \\sim \\mathcal{N}(0,1)$ is a standard normal random variate. In our reduced units where $k_B T=1$, this becomes:\n    $$\n    p \\leftarrow p \\cdot e^{-\\gamma \\Delta t} + \\sqrt{1 - e^{-2\\gamma \\Delta t}} \\cdot \\xi\n    $$\n-   **A-step (half-step drift, $\\Delta t/2$):** A second position update.\n    $$\n    x \\leftarrow x + p \\frac{\\Delta t}{2}\n    $$\n-   **B-step (half-step kick, $\\Delta t/2$):** A second momentum update.\n    $$\n    p \\leftarrow p - kx \\frac{\\Delta t}{2}\n    $$\n\n2.  **Affine Transformation Matrices $M$ and $G$**\n\nEach step can be written as an affine transformation on the state vector $y = \\begin{bmatrix} x \\\\ p \\end{bmatrix}$. Let $\\xi_n$ be the standard normal variate at step $n$.\n\n-   B-step matrix: $M_B = \\begin{pmatrix} 1  0 \\\\ -k \\frac{\\Delta t}{2}  1 \\end{pmatrix}$\n-   A-step matrix: $M_A = \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ 0  1 \\end{pmatrix}$\n-   O-step operator: $y \\to M_O y + G_O \\xi_n$, with $M_O = \\begin{pmatrix} 1  0 \\\\ 0  e^{-\\gamma \\Delta t} \\end{pmatrix}$ and $G_O = \\begin{pmatrix} 0 \\\\ \\sqrt{1 - e^{-2\\gamma \\Delta t}} \\end{pmatrix}$.\n\nThe full BAOAB update $y_{n+1} = \\text{B(A(O(A(B(}y_n\\text{)))))}$ is composed as:\n$$\ny_{n+1} = M_B M_A \\left( M_O \\left( M_A M_B y_n \\right) + G_O \\xi_n \\right)\n$$\nThis gives the affine transformation $y_{n+1} = M y_n + G \\xi_n$ with:\n$$\nM = M_B M_A M_O M_A M_B \\qquad \\text{and} \\qquad G = M_B M_A G_O\n$$\nWe perform the matrix multiplications. First, we define auxiliary matrices:\n$M_{AB} = M_A M_B = \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ -k\\frac{\\Delta t}{2}  1 \\end{pmatrix} = \\begin{pmatrix} 1 - k\\frac{\\Delta t^2}{4}  \\frac{\\Delta t}{2} \\\\ -k\\frac{\\Delta t}{2}  1 \\end{pmatrix}$\n$M_{BA} = M_B M_A = \\begin{pmatrix} 1  0 \\\\ -k\\frac{\\Delta t}{2}  1 \\end{pmatrix} \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ -k\\frac{\\Delta t}{2}  1 - k\\frac{\\Delta t^2}{4} \\end{pmatrix}$\n\nThe propagator matrix is $M = M_{BA} M_O M_{AB}$.\nMultiplication yields the matrix elements of $M$:\n$$ M_{11} = 1 - \\frac{k\\Delta t^2}{4}(1 + e^{-\\gamma\\Delta t}) $$\n$$ M_{12} = \\frac{\\Delta t}{2}(1 + e^{-\\gamma\\Delta t}) $$\n$$ M_{21} = -\\frac{k\\Delta t}{2}\\left(1 - \\frac{k\\Delta t^2}{4}\\right)(1 + e^{-\\gamma\\Delta t}) $$\n$$ M_{22} = -\\frac{k\\Delta t^2}{4} + \\left(1 - \\frac{k\\Delta t^2}{4}\\right)e^{-\\gamma\\Delta t} $$\n\nThe noise vector $G$ is given by $G = M_{BA} G_O$:\n$$\nG = \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ -k\\frac{\\Delta t}{2}  1 - k\\frac{\\Delta t^2}{4} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\sqrt{1 - e^{-2\\gamma \\Delta t}} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\Delta t}{2} \\sqrt{1 - e^{-2\\gamma \\Delta t}} \\\\ \\left(1 - \\frac{k\\Delta t^2}{4}\\right) \\sqrt{1 - e^{-2\\gamma \\Delta t}} \\end{pmatrix}\n$$\n\n3.  **Stationary Configurational Variance**\n\nThe Markov chain defined by the affine transformation generates a stationary Gaussian distribution for the state vector $y$, provided the system is stable. The stationary distribution has a mean of zero and a covariance matrix $\\Sigma = \\mathbb{E}[y y^\\top]$ that satisfies the discrete-time Lyapunov equation:\n$$\n\\Sigma = M \\Sigma M^\\top + Q\n$$\nwhere $Q = GG^\\top$ is the covariance of the additive noise term $G\\xi_n$. The matrix $Q$ is:\n$$\nQ = (1 - e^{-2\\gamma \\Delta t}) \\begin{pmatrix} \\left(\\frac{\\Delta t}{2}\\right)^2  \\frac{\\Delta t}{2}\\left(1 - \\frac{k\\Delta t^2}{4}\\right) \\\\ \\frac{\\Delta t}{2}\\left(1 - \\frac{k\\Delta t^2}{4}\\right)  \\left(1 - \\frac{k\\Delta t^2}{4}\\right)^2 \\end{pmatrix}\n$$\nSolving the Lyapunov equation for the symmetric $2 \\times 2$ matrix $\\Sigma$ provides the stationary covariances. The configurational variance is the top-left element of this matrix, $\\operatorname{Var}_{\\mathrm{BAOAB}}[x] = \\Sigma_{11}$. This equation can be solved numerically using standard linear algebra libraries.\n\n4.  **Configurational Bias Calculation**\n\nThe exact stationary configurational variance for the continuum system is given by the equipartition theorem: $\\operatorname{Var}_{\\mathrm{exact}}[x] = \\frac{k_{\\mathrm{B}}T}{k}$. In the reduced units of this problem ($k_{\\mathrm{B}}T=1$) and for the specific test cases where the spring constant is $k=1$, the exact variance is $\\operatorname{Var}_{\\mathrm{exact}}[x] = 1$.\n\nThe signed fractional configurational bias is thus defined as:\n$$\n\\mathcal{B}(\\Delta t,\\gamma) = \\frac{\\operatorname{Var}_{\\mathrm{BAOAB}}[x] - \\operatorname{Var}_{\\mathrm{exact}}[x]}{\\operatorname{Var}_{\\mathrm{exact}}[x]} = \\Sigma_{11} - 1\n$$\nThe following program implements the construction of matrices $M$ and $Q$ and solves the Lyapunov equation to compute this bias for the specified test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_discrete_lyapunov\n\ndef solve():\n    \"\"\"\n    Computes the signed fractional configurational bias of the BAOAB integrator\n    for a harmonic potential in one dimension.\n    \"\"\"\n    \n    # Test cases are provided as pairs of (timestep, friction_coefficient).\n    test_cases = [\n        (0.005, 1.0),\n        (0.050, 1.0),\n        (0.500, 1.0),\n        (1.500, 1.0),\n        (1.900, 1.0),\n        (0.200, 0.1),\n        (0.200, 5.0)\n    ]\n\n    results = []\n    \n    # System parameters in reduced units as specified by the problem.\n    k = 1.0  # spring constant\n    m = 1.0  # mass\n    kBT = 1.0 # thermal energy\n\n    for dt, gamma in test_cases:\n        # Calculate intermediate terms based on the BAOAB splitting.\n        exp_gdt = np.exp(-gamma * dt)\n        exp_2gdt = np.exp(-2.0 * gamma * dt)\n        \n        # 1. Construct the propagator matrix M.\n        # M = M_B * M_A * M_O * M_A * M_B\n        # The elements of M are derived from first principles in the solution text.\n        M = np.zeros((2, 2))\n        M[0, 0] = 1.0 - k * dt**2 / 4.0 * (1.0 + exp_gdt)\n        M[0, 1] = dt / 2.0 * (1.0 + exp_gdt)\n        M[1, 0] = -k * dt / 2.0 * (1.0 - k * dt**2 / 4.0) * (1.0 + exp_gdt)\n        M[1, 1] = -k * dt**2 / 4.0 + (1.0 - k * dt**2 / 4.0) * exp_gdt\n        \n        # 2. Construct the noise covariance matrix Q = G G^T.\n        # G is the noise vector G = M_B * M_A * G_O.\n        sqrt_term = np.sqrt(kBT * (1.0 - exp_2gdt)) # kBT=1, m=1\n        g1 = dt / 2.0 * sqrt_term\n        g2 = (1.0 - k * dt**2 / 4.0) * sqrt_term\n        \n        Q = np.array([\n            [g1**2, g1 * g2],\n            [g1 * g2, g2**2]\n        ])\n\n        # 3. Solve the discrete-time Lyapunov equation: Sigma = M Sigma M^T + Q.\n        # The function solve_discrete_lyapunov solves A X A^H + Q = X.\n        # This corresponds to our equation with A=M and X=Sigma.\n        Sigma = solve_discrete_lyapunov(M, Q)\n        \n        # 4. Extract configurational variance and compute the bias.\n        var_baoab_x = Sigma[0, 0]\n        \n        # The exact variance is Var_exact[x] = kBT / k = 1.0 in these units.\n        var_exact_x = kBT / k\n        \n        # The signed fractional bias is (Var_baoab - Var_exact) / Var_exact.\n        bias = (var_baoab_x - var_exact_x) / var_exact_x\n        \n        results.append(bias)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2815946"}]}