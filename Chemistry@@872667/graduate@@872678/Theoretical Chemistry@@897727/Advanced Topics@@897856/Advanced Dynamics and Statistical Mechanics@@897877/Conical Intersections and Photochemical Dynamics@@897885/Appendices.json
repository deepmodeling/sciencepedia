{"hands_on_practices": [{"introduction": "To understand the complex dynamics at a conical intersection, we first need a simple, yet powerful, mathematical model. This foundational exercise guides you through the construction of the linear vibronic coupling (LVC) model, the cornerstone for describing the local topology of conical intersections [@problem_id:2765978]. By starting from physically motivated constraints in a diabatic basis, you will derive the characteristic double-cone shape of the adiabatic potential energy surfaces and the singular nature of the non-adiabatic derivative couplings, gaining a first-principles appreciation for the mathematical structure that governs ultrafast photochemical reactions.", "problem": "A triatomic molecule exhibits a conical intersection localized in a two-dimensional branching plane spanned by nuclear displacement coordinates $Q_{x}$ and $Q_{y}$ about a reference geometry. In a diabatic electronic basis $\\{|\\phi_{1}^{\\mathrm{d}}\\rangle,|\\phi_{2}^{\\mathrm{d}}\\rangle\\}$ chosen such that the diabatic potential energy difference is odd in $Q_{x}$ and the interstate diabatic coupling is odd in $Q_{y}$, the leading-order (linear) vibronic terms are sufficient to capture the local topology. Assume the following physically motivated constraints: (i) to linear order, the diabatic diagonal elements are equal in magnitude and opposite in sign along $Q_{x}$ with proportionality constant $a$, (ii) the diabatic off-diagonal coupling is linear in $Q_{y}$ with proportionality constant $b$, and (iii) there is no constant term or linear term in $Q_{x}$ in the off-diagonal, nor a linear term in $Q_{y}$ in the diagonal elements, so that the nuclear origin $Q_{x}=Q_{y}=0$ is a degeneracy point.\n\nStarting from the time-independent electronic Schrödinger equation for fixed nuclear geometry and the definition of adiabatic states as eigenvectors of the electronic Hamiltonian, do the following:\n\n1. Construct the minimal $2\\times 2$ diabatic Hamiltonian matrix $H(Q_{x},Q_{y})$ consistent with the constraints above.\n2. Diagonalize this Hamiltonian to obtain the adiabatic energies $E_{+}(Q_{x},Q_{y})$ and $E_{-}(Q_{x},Q_{y})$.\n3. Define the adiabatic derivative coupling vector between the upper and lower adiabatic states as $\\mathbf{d}_{+-}(Q_{x},Q_{y})=\\langle \\phi_{+}(Q_{x},Q_{y})|\\nabla_{Q}|\\phi_{-}(Q_{x},Q_{y})\\rangle$, where $\\nabla_{Q}=(\\partial/\\partial Q_{x},\\partial/\\partial Q_{y})$, and $|\\phi_{\\pm}\\rangle$ are the normalized adiabatic electronic eigenvectors. Adopt the real adiabatic gauge in which the adiabatic eigenvectors are everywhere real and continuous away from the degeneracy (with a branch cut chosen so that the eigenvectors are real for $Q_{x}>0$), and compute the two components $d_{+-}^{(x)}(Q_{x},Q_{y})$ and $d_{+-}^{(y)}(Q_{x},Q_{y})$.\n\nExpress your final answer as a single row matrix with the four entries $[E_{+},\\,E_{-},\\,d_{+-}^{(x)},\\,d_{+-}^{(y)}]$. No numerical evaluation is required. Do not include units. The final answer must be a single closed-form analytic expression.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n**Step 1: Extract Givens**\n- **System**: A triatomic molecule with a conical intersection.\n- **Coordinates**: A two-dimensional branching plane spanned by nuclear displacement coordinates $Q_{x}$ and $Q_{y}$.\n- **Basis**: A diabatic electronic basis $\\{|\\phi_{1}^{\\mathrm{d}}\\rangle,|\\phi_{2}^{\\mathrm{d}}\\rangle\\}$.\n- **Model**: Linear vibronic coupling model is sufficient.\n- **Constraint (i)**: Diabatic diagonal potential elements are $V_{11} \\propto Q_{x}$ and $V_{22} \\propto -Q_{x}$ with the same proportionality constant $a$.\n- **Constraint (ii)**: Diabatic off-diagonal coupling element is $V_{12} \\propto Q_{y}$ with proportionality constant $b$.\n- **Constraint (iii)**: The electronic Hamiltonian contains no constant terms, no linear term in $Q_{x}$ for the off-diagonal coupling, and no linear term in $Q_{y}$ for the diagonal elements. The origin $(Q_{x}, Q_{y}) = (0, 0)$ is a point of electronic degeneracy.\n- **Task 1**: Construct the $2 \\times 2$ diabatic Hamiltonian matrix $H(Q_{x}, Q_{y})$.\n- **Task 2**: Find the adiabatic energies $E_{+}(Q_{x}, Q_{y})$ and $E_{-}(Q_{x}, Q_{y})$ by diagonalizing $H$.\n- **Task 3**: Compute the components of the adiabatic derivative coupling vector $\\mathbf{d}_{+-}(Q_{x}, Q_{y}) = \\langle \\phi_{+}(Q_{x}, Q_{y})|\\nabla_{Q}|\\phi_{-}(Q_{x}, Q_{y})\\rangle$, where $\\nabla_{Q} = (\\partial/\\partial Q_{x}, \\partial/\\partial Q_{y})$, in the real adiabatic gauge.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, describing the standard linear vibronic coupling (LVC) model for a conical intersection, a fundamental concept in theoretical photochemistry. It is well-posed, with sufficient constraints to uniquely define the Hamiltonian and derive the requested quantities. The language is objective and precise. The problem formulation does not violate any fundamental principles of quantum mechanics or mathematics; rather, it is a direct application of them. There are no contradictions, missing data, or ambiguities.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be provided.\n\nThe solution proceeds in three parts as requested.\n\n**1. Construction of the Diabatic Hamiltonian Matrix**\n\nBased on the provided constraints, the $2 \\times 2$ electronic Hamiltonian matrix $H$ in the diabatic basis $\\{|\\phi_{1}^{\\mathrm{d}}\\rangle, |\\phi_{2}^{\\mathrm{d}}\\rangle\\}$ is constructed. The diagonal elements are linear in $Q_{x}$ with equal magnitude and opposite sign, and the off-diagonal elements are linear in $Q_{y}$. The Hamiltonian matrix must be Hermitian, thus $H_{12} = H_{21}$. The constraints lead to the following form for the diabatic Hamiltonian $H(Q_{x}, Q_{y})$:\n$$ H(Q_{x}, Q_{y}) = \\begin{pmatrix} a Q_{x} & b Q_{y} \\\\ b Q_{y} & -a Q_{x} \\end{pmatrix} $$\nThis is the standard Hamiltonian for the $E \\otimes \\epsilon$ Jahn-Teller effect, a specific case of the linear vibronic coupling model.\n\n**2. Adiabatic Energies**\n\nThe adiabatic energies, $E_{\\pm}(Q_x, Q_y)$, are the eigenvalues of the Hamiltonian matrix $H$. They are found by solving the characteristic equation $\\det(H - E I) = 0$, where $I$ is the $2 \\times 2$ identity matrix.\n$$ \\det \\begin{pmatrix} a Q_{x} - E & b Q_{y} \\\\ b Q_{y} & -a Q_{x} - E \\end{pmatrix} = 0 $$\n$$ (a Q_{x} - E)(-a Q_{x} - E) - (b Q_{y})^{2} = 0 $$\n$$ E^{2} - (a Q_{x})^{2} - (b Q_{y})^{2} = 0 $$\n$$ E^{2} = a^{2} Q_{x}^{2} + b^{2} Q_{y}^{2} $$\nThe two eigenvalues, representing the upper and lower adiabatic potential energy surfaces, are:\n$$ E_{+}(Q_{x}, Q_{y}) = \\sqrt{a^{2} Q_{x}^{2} + b^{2} Q_{y}^{2}} $$\n$$ E_{-}(Q_{x}, Q_{y}) = -\\sqrt{a^{2} Q_{x}^{2} + b^{2} Q_{y}^{2}} $$\nThese two surfaces form a double cone meeting at the origin $(Q_{x}, Q_{y}) = (0, 0)$, which is the conical intersection point.\n\n**3. Adiabatic Derivative Coupling**\n\nThe derivative coupling vector components $d_{+-}^{(x)}$ and $d_{+-}^{(y)}$ are the elements of $\\mathbf{d}_{+-}$. A robust method for their calculation is the Hellmann-Feynman theorem, which provides the relation:\n$$ \\mathbf{d}_{+-} = \\frac{\\langle \\phi_{+} | (\\nabla_{Q} H) | \\phi_{-} \\rangle}{E_{-} - E_{+}} $$\nwhere $|\\phi_{\\pm}\\rangle$ are the normalized adiabatic eigenvectors. The energy denominator is $E_{-} - E_{+} = -2 \\sqrt{a^{2} Q_{x}^{2} + b^{2} Q_{y}^{2}}$.\n\nThe gradients of the Hamiltonian with respect to $Q_{x}$ and $Q_{y}$ are:\n$$ \\frac{\\partial H}{\\partial Q_{x}} = \\begin{pmatrix} a & 0 \\\\ 0 & -a \\end{pmatrix} $$\n$$ \\frac{\\partial H}{\\partial Q_{y}} = \\begin{pmatrix} 0 & b \\\\ b & 0 \\end{pmatrix} $$\nTo evaluate the matrix elements, the adiabatic eigenvectors are required. Let us define a mixing angle $\\theta$ such that $a Q_{x} = R \\cos\\theta$ and $b Q_{y} = R \\sin\\theta$, where $R = \\sqrt{a^{2} Q_{x}^{2} + b^{2} Q_{y}^{2}} = E_{+}$. The Hamiltonian becomes $H = R \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\\\ \\sin\\theta & -\\cos\\theta \\end{pmatrix}$. The normalized eigenvectors are:\n$$ |\\phi_{+}\\rangle = \\begin{pmatrix} \\cos(\\theta/2) \\\\ \\sin(\\theta/2) \\end{pmatrix}, \\quad |\\phi_{-}\\rangle = \\begin{pmatrix} -\\sin(\\theta/2) \\\\ \\cos(\\theta/2) \\end{pmatrix} $$\nThis choice of eigenvectors corresponds to the specified real adiabatic gauge.\n\nNow, we compute the numerators for the derivative coupling components.\nFor the $x$-component:\n$$ \\langle \\phi_{+} | \\frac{\\partial H}{\\partial Q_{x}} | \\phi_{-} \\rangle = \\begin{pmatrix} \\cos(\\theta/2) & \\sin(\\theta/2) \\end{pmatrix} \\begin{pmatrix} a & 0 \\\\ 0 & -a \\end{pmatrix} \\begin{pmatrix} -\\sin(\\theta/2) \\\\ \\cos(\\theta/2) \\end{pmatrix} $$\n$$ = a \\left( -\\cos(\\theta/2)\\sin(\\theta/2) - \\sin(\\theta/2)\\cos(\\theta/2) \\right) = -2a \\cos(\\theta/2)\\sin(\\theta/2) = -a \\sin\\theta $$\nSubstituting $\\sin\\theta = b Q_{y} / R = b Q_{y} / E_{+}$, the numerator is $-ab Q_{y} / E_{+}$.\nThus, the $x$-component of the derivative coupling is:\n$$ d_{+-}^{(x)} = \\frac{-ab Q_{y} / E_{+}}{-2 E_{+}} = \\frac{ab Q_{y}}{2 E_{+}^{2}} = \\frac{ab Q_{y}}{2(a^{2} Q_{x}^{2} + b^{2} Q_{y}^{2})} $$\n\nFor the $y$-component:\n$$ \\langle \\phi_{+} | \\frac{\\partial H}{\\partial Q_{y}} | \\phi_{-} \\rangle = \\begin{pmatrix} \\cos(\\theta/2) & \\sin(\\theta/2) \\end{pmatrix} \\begin{pmatrix} 0 & b \\\\ b & 0 \\end{pmatrix} \\begin{pmatrix} -\\sin(\\theta/2) \\\\ \\cos(\\theta/2) \\end{pmatrix} $$\n$$ = b \\left( \\cos^{2}(\\theta/2) - \\sin^{2}(\\theta/2) \\right) = b \\cos\\theta $$\nSubstituting $\\cos\\theta = a Q_{x} / R = a Q_{x} / E_{+}$, the numerator is $ab Q_{x} / E_{+}$.\nThus, the $y$-component of the derivative coupling is:\n$$ d_{+-}^{(y)} = \\frac{ab Q_{x} / E_{+}}{-2 E_{+}} = -\\frac{ab Q_{x}}{2 E_{+}^{2}} = -\\frac{ab Q_{x}}{2(a^{2} Q_{x}^{2} + b^{2} Q_{y}^{2})} $$\nThese expressions are singular at the conical intersection $(0, 0)$, which is a characteristic feature of non-adiabatic coupling.\n\nThe four requested quantities are therefore assembled into a single row matrix.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{a^{2} Q_{x}^{2} + b^{2} Q_{y}^{2}} & -\\sqrt{a^{2} Q_{x}^{2} + b^{2} Q_{y}^{2}} & \\frac{ab Q_{y}}{2(a^{2} Q_{x}^{2} + b^{2} Q_{y}^{2})} & -\\frac{ab Q_{x}}{2(a^{2} Q_{x}^{2} + b^{2} Q_{y}^{2})} \\end{pmatrix}}\n$$", "id": "2765978"}, {"introduction": "A conical intersection is more than just a point of degeneracy; it is a topological defect in the electronic potential energy landscape. This practice delves into the most profound consequence of this topology: the geometric (or Berry) phase [@problem_id:2765956]. By calculating the circulation of the nonadiabatic coupling vector field around the intersection, you will directly prove that an adiabatic electronic state acquires a phase of $\\pi$ upon encirclement, a sign change that has crucial implications for nuclear wavepacket interference and the ultimate outcome of photochemical processes.", "problem": "Consider a two-state adiabatic electronic subspace arising from the Born–Oppenheimer (BO) separation near a conical intersection (CI) located at the origin of nuclear coordinate space. Let the nuclear configuration be parameterized in polar coordinates by $(r,\\theta)$ centered at the CI. The nonadiabatic derivative coupling vector between the two adiabatic states is given by the real-valued field\n$$\n\\mathbf{d}_{12}(r,\\theta)=\\frac{\\hat{\\theta}}{2r},\n$$\nwhere $\\hat{\\theta}$ is the unit vector in the angular direction. Assume a nuclear trajectory that traces once, counterclockwise, around a circle of fixed radius $r=R>0$ enclosing the CI.\n\nStarting only from standard adiabatic transport in the BO framework, where the parallel transport of the adiabatic basis along a nuclear path is governed by the nonadiabatic derivative coupling matrix, compute the holonomy associated with one loop around the circle. Use this to determine the geometric phase (Mead–Berry phase) accumulated by an initially chosen adiabatic state after completing the loop.\n\nYour tasks are:\n- Compute the circulation integral $\\oint \\mathbf{d}_{12}\\cdot d\\mathbf{R}$ around the circle.\n- Using the fact that the holonomy in this two-state real gauge corresponds to a rotation in the two-dimensional adiabatic subspace by the angle equal to that circulation, deduce the phase acquired by a transported adiabatic state after one loop.\n\nExpress the final geometric phase as an exact value in radians. Provide a single final value, not an equation or inequality, and do not include units in your final boxed answer.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard, canonical model for describing the geometric phase effect at a conical intersection in a two-state electronic system. All necessary information is provided, and the premises are consistent with the established principles of quantum chemistry and non-adiabatic dynamics. Therefore, we proceed with the solution.\n\nThe objective is to compute the geometric phase acquired by an adiabatic electronic state when the nuclear configuration undergoes a cyclic evolution around a conical intersection. This phase is determined by the holonomy of the adiabatic basis, which is governed by the non-adiabatic derivative coupling vector $\\mathbf{d}_{12}$.\n\nThe nuclear trajectory is a counterclockwise circle $C$ of a fixed radius $r=R > 0$ centered at the origin, which is the location of the conical intersection. In polar coordinates $(r, \\theta)$, this path is parameterized by $r=R$ and $\\theta$ varying from $0$ to $2\\pi$. The differential displacement vector along this path, $d\\mathbf{R}$, is tangent to the circle. In a polar coordinate system, the general differential displacement is $d\\mathbf{R} = dr\\,\\hat{r} + r\\,d\\theta\\,\\hat{\\theta}$. Since the radius $r=R$ is constant along the trajectory $C$, we have $dr=0$. The displacement vector thus simplifies to:\n$$\nd\\mathbf{R} = R\\,d\\theta\\,\\hat{\\theta}\n$$\n\nThe nonadiabatic derivative coupling vector is given as:\n$$\n\\mathbf{d}_{12}(r,\\theta) = \\frac{\\hat{\\theta}}{2r}\n$$\nAlong the specified circular path, where $r=R$, this vector field becomes:\n$$\n\\mathbf{d}_{12}(R,\\theta) = \\frac{\\hat{\\theta}}{2R}\n$$\n\nThe first task is to compute the circulation of this vector field around the closed path $C$. The circulation, which we denote by $\\gamma$, is given by the line integral:\n$$\n\\gamma = \\oint_C \\mathbf{d}_{12} \\cdot d\\mathbf{R}\n$$\nSubstituting the expressions for $\\mathbf{d}_{12}$ and $d\\mathbf{R}$ along the path into the integral:\n$$\n\\gamma = \\int_{0}^{2\\pi} \\left( \\frac{\\hat{\\theta}}{2R} \\right) \\cdot (R\\,d\\theta\\,\\hat{\\theta})\n$$\nThe dot product of the unit vector $\\hat{\\theta}$ with itself is $\\hat{\\theta} \\cdot \\hat{\\theta} = 1$. The integrand simplifies significantly:\n$$\n\\gamma = \\int_{0}^{2\\pi} \\frac{R}{2R} d\\theta = \\int_{0}^{2\\pi} \\frac{1}{2} d\\theta\n$$\nEvaluating this elementary integral yields the value of the circulation:\n$$\n\\gamma = \\frac{1}{2} [\\theta]_{0}^{2\\pi} = \\frac{1}{2} (2\\pi - 0) = \\pi\n$$\n\nThe problem states that for this two-state system with a real gauge (real electronic wavefunctions), the holonomy resulting from parallel transport around the loop is a rotation in the two-dimensional adiabatic subspace $\\{|\\Psi_1\\rangle, |\\Psi_2\\rangle\\}$. The angle of this rotation is precisely the circulation $\\gamma$ we have just computed.\n\nThe holonomy is represented by a rotation matrix $U$ acting on the basis vectors. The matrix for a rotation by an angle $\\gamma$ in a two-dimensional space is:\n$$\nU = \\begin{pmatrix} \\cos(\\gamma) & -\\sin(\\gamma) \\\\ \\sin(\\gamma) & \\cos(\\gamma) \\end{pmatrix}\n$$\nSubstituting the calculated value $\\gamma = \\pi$:\n$$\nU = \\begin{pmatrix} \\cos(\\pi) & -\\sin(\\pi) \\\\ \\sin(\\pi) & \\cos(\\pi) \\end{pmatrix} = \\begin{pmatrix} -1 & 0 \\\\ 0 & -1 \\end{pmatrix}\n$$\nThis matrix describes how the adiabatic basis vectors transform after one complete loop. If $|\\Psi_j(\\mathbf{R}_i)\\rangle$ is an adiabatic state at the start of the loop, the state at the end of the loop $|\\Psi_j(\\mathbf{R}_f)\\rangle$, where $\\mathbf{R}_f = \\mathbf{R}_i$, is given by the action of the holonomy. For the first state, $|\\Psi_1\\rangle$, its transformation is:\n$$\n|\\Psi_1(\\text{final})\\rangle = U_{11}|\\Psi_1(\\text{initial})\\rangle + U_{21}|\\Psi_2(\\text{initial})\\rangle = (-1)|\\Psi_1(\\text{initial})\\rangle + (0)|\\Psi_2(\\text{initial})\\rangle = -|\\Psi_1(\\text{initial})\\rangle\n$$\nSimilarly, for the second state, $|\\Psi_2\\rangle$:\n$$\n|\\Psi_2(\\text{final})\\rangle = U_{12}|\\Psi_1(\\text{initial})\\rangle + U_{22}|\\Psi_2(\\text{initial})\\rangle = (0)|\\Psi_1(\\text{initial})\\rangle + (-1)|\\Psi_2(\\text{initial})\\rangle = -|\\Psi_2(\\text{initial})\\rangle\n$$\nIn both cases, an initial adiabatic state returns to itself multiplied by a factor of $-1$. This factor is the geometric phase factor, $e^{i\\gamma_g}$, where $\\gamma_g$ is the geometric phase, also known as the Mead–Berry phase.\n\nWe have the relation:\n$$\ne^{i\\gamma_g} = -1\n$$\nFrom Euler's identity, $e^{i\\pi} = -1$. Therefore, the geometric phase accumulated by the adiabatic state is:\n$$\n\\gamma_g = \\pi\n$$\nThis result is fundamental: encircling a conical intersection in a two-state system induces a sign change in the real-valued adiabatic electronic wavefunctions, which corresponds to a geometric phase of $\\pi$.", "answer": "$$\\boxed{\\pi}$$", "id": "2765956"}, {"introduction": "Theoretical models are most powerful when they can make quantitative predictions for real chemical systems. This computational practice bridges the gap between the abstract linear vibronic coupling (LVC) model and its application to data from quantum chemistry calculations [@problem_id:2765943]. By performing a numerical least-squares fit to determine the LVC parameters from a set of synthetic *ab initio* energy points, you will gain practical experience in parameterizing and validating a vibronic coupling Hamiltonian, a core task in modern computational photochemistry.", "problem": "You are to implement and validate a two-state Linear Vibronic Coupling (LVC) model near a Minimum Energy Conical Intersection (MECI) in a two-dimensional branching plane spanned by a gradient-difference coordinate and a derivative-coupling coordinate. Begin from the following base:\n\n1. In the adiabatic representation, a conical intersection occurs when two electronic states become degenerate and the non-adiabatic coupling cannot be neglected. Near a MECI, the diabatic Hamiltonian in the branching plane can be represented by a symmetric two-by-two matrix whose elements can be Taylor-expanded in the branching-plane coordinates to linear or quadratic order.\n\n2. In the diabatic representation, let the branching-plane coordinates be the dimensionless normal-mode displacements $g$ (gradient-difference coordinate) and $h$ (derivative-coupling coordinate). Consider the lowest-order physically consistent model in which the diabatic gap is linear in $g$, the diabatic coupling is linear in $h$, and both diabatic surfaces share the same harmonic curvature in $g$ and $h$. Let the zero of energy be arbitrary.\n\n3. The adiabatic energies $E_{S_0}(g,h)$ and $E_{S_1}(g,h)$ are the eigenvalues of the diabatic Hamiltonian. Under the above assumptions, introduce five unknown LVC parameters:\n- $E_0$ (energy offset at the MECI) in electronvolts (eV),\n- $\\kappa_g$ (linear coefficient along $g$ in eV),\n- $\\kappa_h$ (linear coefficient along $h$ in eV),\n- $\\Omega_g$ (effective frequency in energy units $\\hbar \\omega$ along $g$ in eV),\n- $\\Omega_h$ (effective frequency in energy units $\\hbar \\omega$ along $h$ in eV).\n\nGiven these, the adiabatic energies are functions of $g$ and $h$ derived from the diabatic Hamiltonian via eigenvalue decomposition.\n\nYour task is to:\n- Derive the explicit adiabatic energy expressions in terms of $E_0$, $\\kappa_g$, $\\kappa_h$, $\\Omega_g$, $\\Omega_h$, and $(g,h)$ using the above physical model.\n- Implement a nonlinear least-squares fit of these five parameters to synthetic “ab initio” energies supplied by the model itself on a set of training scans in the branching plane, without using any closed-form shortcut formulas for the fit.\n- Validate the fitted parameters by predicting adiabatic energies along an orthogonal branching-plane scan and computing the root-mean-square error (RMSE) in electronvolts (eV), combining both $S_0$ and $S_1$ energies.\n- Ensure physically meaningful positivity by constraining $\\kappa_g \\ge 0$, $\\kappa_h \\ge 0$, $\\Omega_g \\ge 0$, $\\Omega_h \\ge 0$.\n\nAngle convention and coordinate generation:\n- A one-dimensional scan in the branching plane is parameterized by a scalar displacement $q$ and an angle $\\theta$ (in degrees) measured from the $g$ axis.\n- The Cartesian coordinates are $g = q \\cos(\\theta)$ and $h = q \\sin(\\theta)$, with the cosine and sine interpreted in radians; you must convert degrees to radians before evaluating trigonometric functions.\n\nData generation protocol (synthetic, noiseless ab initio data):\n- For each test case below, the “ab initio” energies are the exact model adiabatic energies $E_{S_0}(g,h)$ and $E_{S_1}(g,h)$ evaluated at the specified training scans using the true parameters. No external datasets are used.\n\nFitting protocol:\n- Fit the parameters by minimizing the sum of squared residuals between model adiabatic energies and the synthetic “ab initio” energies for both $S_0$ and $S_1$ across all training points in a case.\n- Use any numerically stable method that adheres to the constraints above.\n- After fitting, predict $E_{S_0}$ and $E_{S_1}$ along the validation scan for that case, and compute the RMSE in eV over the combined set of validation energies ($S_0$ and $S_1$ together).\n\nNumerical units:\n- All energies, including $E_0$, $\\kappa_g$, $\\kappa_h$, $\\Omega_g$, $\\Omega_h$, $E_{S_0}$, $E_{S_1}$, and the RMSE, must be in electronvolts (eV).\n- Angles are in degrees, but you must convert them to radians before using trigonometric functions.\n- The branching-plane coordinates $q$, $g$, and $h$ are dimensionless.\n\nTest suite:\nFor each case, you are given a set of true LVC parameters, two training scans, and one orthogonal validation scan.\n\nCase 1:\n- True parameters: $E_0 = 3.8$, $\\kappa_g = 1.2$, $\\kappa_h = 0.8$, $\\Omega_g = 0.5$, $\\Omega_h = 0.7$.\n- Training scans:\n  - Scan A: $\\theta_A = 30^\\circ$, $q \\in \\{-0.20,-0.10,0.00,0.10,0.20\\}$.\n  - Scan B: $\\theta_B = -20^\\circ$, $q \\in \\{-0.15,-0.05,0.05,0.15\\}$.\n- Validation scan:\n  - Orthogonal to Scan A: $\\theta_V = 120^\\circ$, $q \\in \\{-0.18,-0.06,0.06,0.18\\}$.\n\nCase 2:\n- True parameters: $E_0 = 4.3$, $\\kappa_g = 0.9$, $\\kappa_h = 1.1$, $\\Omega_g = 0.6$, $\\Omega_h = 0.4$.\n- Training scans:\n  - Scan A: $\\theta_A = 25^\\circ$, $q \\in \\{-0.20,-0.10,0.00,0.10,0.20\\}$.\n  - Scan B: $\\theta_B = -35^\\circ$, $q \\in \\{-0.15,-0.05,0.05,0.15\\}$.\n- Validation scan:\n  - Orthogonal to Scan A: $\\theta_V = 115^\\circ$, $q \\in \\{-0.18,-0.06,0.06,0.18\\}$.\n\nCase 3:\n- True parameters: $E_0 = 3.2$, $\\kappa_g = 1.5$, $\\kappa_h = 0.6$, $\\Omega_g = 0.55$, $\\Omega_h = 0.55$.\n- Training scans:\n  - Scan A: $\\theta_A = 40^\\circ$, $q \\in \\{-0.20,-0.10,0.00,0.10,0.20\\}$.\n  - Scan B: $\\theta_B = -15^\\circ$, $q \\in \\{-0.15,-0.05,0.05,0.15\\}$.\n- Validation scan:\n  - Orthogonal to Scan A: $\\theta_V = 130^\\circ$, $q \\in \\{-0.18,-0.06,0.06,0.18\\}$.\n\nTasks and required output:\n1. For each case, generate the synthetic “ab initio” training energies using the true parameters and the specified training scans.\n2. Fit $E_0$, $\\kappa_g$, $\\kappa_h$, $\\Omega_g$, $\\Omega_h$ by least squares under the non-negativity constraints $\\kappa_g \\ge 0$, $\\kappa_h \\ge 0$, $\\Omega_g \\ge 0$, $\\Omega_h \\ge 0$.\n3. Predict validation energies using the fitted parameters, and compute the RMSE in eV over both $S_0$ and $S_1$ validation energies combined.\n4. Your program should produce a single line of output containing, for each case, the fitted parameters and the validation RMSE, rounded to five decimal places, aggregated as a list of lists in the form:\n   [ [kappa_g_fit, kappa_h_fit, Omega_g_fit, Omega_h_fit, E0_fit, RMSE_val],\n     [kappa_g_fit, kappa_h_fit, Omega_g_fit, Omega_h_fit, E0_fit, RMSE_val],\n     [kappa_g_fit, kappa_h_fit, Omega_g_fit, Omega_h_fit, E0_fit, RMSE_val] ]\nwhere all entries are in eV and rounded to five decimal places.\n\nAll computations must be carried out in pure floating-point arithmetic with no symbolic algebra. All angles must be handled in degrees in the inputs and converted to radians internally before trigonometric computations. The final printed line must exactly follow the format above: a single line, a single list containing three sublists, commas separating values, no additional text.", "solution": "We start from the diabatic description of a conical intersection in a two-state system. Near a Minimum Energy Conical Intersection (MECI), define the branching plane spanned by two orthonormal coordinates: $g$ along the gradient-difference direction and $h$ along the derivative-coupling direction. In a lowest-order Linear Vibronic Coupling (LVC) model, we include linear terms that split and couple the diabatic states and quadratic harmonic terms that stabilize displacements away from the MECI. Because we adopt dimensionless normal-mode coordinates, the harmonic coefficients enter as effective frequencies in energy units $\\hbar \\omega$.\n\n1. Model construction. Consider the diabatic Hamiltonian\n$$\n\\mathbf{H}_\\text{dia}(g,h) =\n\\begin{pmatrix}\nE_0 + \\dfrac{1}{2}\\Omega_g g^2 + \\dfrac{1}{2}\\Omega_h h^2 + \\kappa_g g & \\kappa_h h \\\\\n\\kappa_h h & E_0 + \\dfrac{1}{2}\\Omega_g g^2 + \\dfrac{1}{2}\\Omega_h h^2 - \\kappa_g g\n\\end{pmatrix},\n$$\nwhere $E_0$ is an energy offset at $g=h=0$, $\\kappa_g$ controls the linear splitting along $g$ (tuning coordinate), $\\kappa_h$ controls the linear interstate coupling along $h$ (coupling coordinate), and $\\Omega_g,\\Omega_h$ are effective harmonic coefficients (in eV) along $g$ and $h$, respectively. The diagonal average is\n$$\nE_\\text{avg}(g,h) = E_0 + \\dfrac{1}{2}\\Omega_g g^2 + \\dfrac{1}{2}\\Omega_h h^2,\n$$\nthe diabatic difference is $\\Delta(g,h) = 2\\kappa_g g$, and the diabatic coupling is $C(g,h)=\\kappa_h h$.\n\n2. Adiabatic energies. The adiabatic energies $E_{S_0}$ and $E_{S_1}$ are the eigenvalues of $\\mathbf{H}_\\text{dia}(g,h)$, which for a real symmetric $2 \\times 2$ matrix with equal average and difference $\\pm \\Delta/2$ and coupling $C$ are\n$$\nE_{S_{1,0}}(g,h) = E_\\text{avg}(g,h) \\pm \\sqrt{\\left(\\kappa_g g\\right)^2 + \\left(\\kappa_h h\\right)^2}.\n$$\nThis follows from the characteristic polynomial of a $2\\times 2$ matrix, yielding eigenvalues $E_\\text{avg} \\pm \\sqrt{(\\Delta/2)^2 + C^2}$, with $(\\Delta/2)^2 = (\\kappa_g g)^2$ and $C^2=(\\kappa_h h)^2$. The “$+$” branch corresponds to the upper adiabatic state $S_1$ and the “$-$” branch to the lower adiabatic state $S_0$.\n\n3. Coordinate parameterization. A one-dimensional scan at angle $\\theta$ (in degrees) is parameterized by a displacement $q \\in \\mathbb{R}$ via\n$$\ng(q,\\theta) = q \\cos\\left(\\theta \\dfrac{\\pi}{180}\\right), \\quad\nh(q,\\theta) = q \\sin\\left(\\theta \\dfrac{\\pi}{180}\\right).\n$$\nThis permits straightforward generation of training and validation points along straight lines in the branching plane.\n\n4. Fitting task. We are given synthetic “ab initio” datasets that are defined by evaluating the model adiabatic energies at specified training scans for known true parameters, but we do not use these truths in the fitting; instead, we recover them by minimizing the sum of squared deviations between model and data. Denote the parameter vector by\n$$\n\\mathbf{p} = \\left(E_0, \\kappa_g, \\kappa_h, \\Omega_g, \\Omega_h\\right),\n$$\nand the model energies by $E^{\\text{model}}_{S_0}(g,h;\\mathbf{p})$ and $E^{\\text{model}}_{S_1}(g,h;\\mathbf{p})$ according to the expressions in step 2. For a set of training points $\\{(g_i,h_i)\\}_{i=1}^N$ with synthetic data $\\{E^{\\text{data}}_{S_0,i}, E^{\\text{data}}_{S_1,i}\\}$, define the residual vector\n$$\n\\mathbf{r}(\\mathbf{p}) = \\left(\nE^{\\text{model}}_{S_0}(g_1,h_1;\\mathbf{p}) - E^{\\text{data}}_{S_0,1}, \\;\nE^{\\text{model}}_{S_1}(g_1,h_1;\\mathbf{p}) - E^{\\text{data}}_{S_1,1}, \\;\n\\dots,\\;\nE^{\\text{model}}_{S_0}(g_N,h_N;\\mathbf{p}) - E^{\\text{data}}_{S_0,N}, \\;\nE^{\\text{model}}_{S_1}(g_N,h_N;\\mathbf{p}) - E^{\\text{data}}_{S_1,N}\n\\right)^\\top.\n$$\nThe least-squares problem is\n$$\n\\min_{\\mathbf{p}} \\; \\|\\mathbf{r}(\\mathbf{p})\\|_2^2\n\\quad \\text{subject to} \\quad\n\\kappa_g \\ge 0, \\; \\kappa_h \\ge 0, \\; \\Omega_g \\ge 0, \\; \\Omega_h \\ge 0,\n$$\nwith $E_0$ unconstrained. We solve this numerically (for example, by a trust-region or Levenberg–Marquardt-like method with bound constraints), using reasonable initial guesses such as the average of all training energies for $E_0$ and positive values for the remaining parameters. The constraints reflect the physical interpretation that linear magnitudes and harmonic curvatures are non-negative near the MECI; the sign indeterminacy of $\\kappa_g$ and $\\kappa_h$ in the eigenvalue formula is resolved by restricting to non-negative solutions.\n\n5. Validation. After obtaining the fitted parameters $\\widehat{\\mathbf{p}}$, we predict energies on a validation scan orthogonal to one of the training scans: for a set of validation points $\\{(g_j^\\text{val},h_j^\\text{val})\\}_{j=1}^M$, compute\n$$\nE^{\\text{pred}}_{S_{0,1},j} = E^{\\text{model}}_{S_{0,1}}(g_j^\\text{val},h_j^\\text{val};\\widehat{\\mathbf{p}}), \\quad\nE^{\\text{true}}_{S_{0,1},j} = E^{\\text{model}}_{S_{0,1}}(g_j^\\text{val},h_j^\\text{val};\\mathbf{p}_\\text{true}),\n$$\nand the root-mean-square error (RMSE) in electronvolts over both states combined:\n$$\n\\text{RMSE} = \\sqrt{\n\\dfrac{1}{2M} \\sum_{j=1}^{M}\n\\left( \\left[E^{\\text{pred}}_{S_0,j} - E^{\\text{true}}_{S_0,j}\\right]^2 +\n\\left[E^{\\text{pred}}_{S_1,j} - E^{\\text{true}}_{S_1,j}\\right]^2 \\right)\n}.\n$$\nBecause the synthetic data are noiseless and the parameterization is identifiable with two non-collinear training scans, the fit should recover the true parameters to within numerical precision, and the RMSE should be effectively zero.\n\n6. Algorithmic design. For each of the three cases in the test suite:\n- Generate training and validation coordinates $(g,h)$ from the $(q,\\theta)$ specification using $g=q\\cos(\\theta \\pi/180)$ and $h=q\\sin(\\theta \\pi/180)$.\n- Generate synthetic training energies by evaluating the model at the true parameters.\n- Set initial guesses, assemble the residuals over all training points, and solve the constrained least-squares problem numerically.\n- Using the fitted parameters, generate predictions on the validation scan and compute the RMSE in electronvolts as described.\n- Round the fitted parameters and RMSE to five decimal places.\n\n7. Output. Collect the results for the three cases in order, each as a list\n$$\n\\left[ \\kappa_g^\\text{fit},\\; \\kappa_h^\\text{fit},\\; \\Omega_g^\\text{fit},\\; \\Omega_h^\\text{fit},\\; E_0^\\text{fit},\\; \\text{RMSE} \\right],\n$$\nand print a single line that is a list of these three lists, with entries rounded to five decimal places, for example:\n$$\n\\left[\n[\\dots],\\; [\\dots],\\; [\\dots]\n\\right].\n$$\nAll entries must be in units of electronvolts (eV).\n\nThis procedure demonstrates how the LVC model near a conical intersection connects fundamental diabatic expansions to observable adiabatic energy splittings, and how parameter inference by least squares enables quantitative predictions on orthogonal scans in the branching plane.", "answer": "[ [1.20000, 0.80000, 0.50000, 0.70000, 3.80000, 0.00000], [0.90000, 1.10000, 0.60000, 0.40000, 4.30000, 0.00000], [1.50000, 0.60000, 0.55000, 0.55000, 3.20000, 0.00000] ]", "id": "2765943"}]}