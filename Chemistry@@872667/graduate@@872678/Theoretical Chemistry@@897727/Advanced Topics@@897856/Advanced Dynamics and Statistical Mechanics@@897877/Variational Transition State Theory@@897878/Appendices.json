{"hands_on_practices": [{"introduction": "Before we can apply variational corrections, we must first master the fundamentals of locating and characterizing stationary points on a potential energy surface (PES). This practice grounds the abstract concept of a reaction pathway in a concrete mathematical exercise, using multivariable calculus to find the minima (reactants/products) and saddle points (conventional transition states) that define the landscape of a chemical reaction. By analyzing the local curvature via the Hessian matrix, you will develop the essential skill of distinguishing stable states from transition states [@problem_id:2693873].", "problem": "A two-dimensional model potential energy surface (PES) is given by the scalar field $V(x,y)$ defined on $\\mathbb{R}^2$ by $V(x,y)=x^{4}-2x^{2}+y^{2}+\\frac{1}{2}xy$. In variational transition state theory (VTST), the transition state is associated with an index-$1$ saddle point on the minimum energy path (MEP), while local minima correspond to potential wells. Starting from the fundamental definitions that stationary points satisfy $\\nabla V=\\mathbf{0}$ and that the Hessian matrix $H$ governs local curvature with classification by the signs of its eigenvalues, do the following:\n\n1. Determine all stationary points $(x^{*},y^{*})$ of $V$ by solving $\\frac{\\partial V}{\\partial x}=0$ and $\\frac{\\partial V}{\\partial y}=0$.\n2. For each stationary point, compute the Hessian matrix $H$ and classify the point by the signs of the eigenvalues of $H$ (local minimum, index-$1$ saddle).\n3. Identify the index-$1$ saddle that lies on the MEP connecting the two minima. Using this, compute the barrier height $\\Delta V$ defined as the difference $V(x_{\\text{s}},y_{\\text{s}})-V(x_{\\text{m}},y_{\\text{m}})$, where $(x_{\\text{s}},y_{\\text{s}})$ is the saddle from step $3$ and $(x_{\\text{m}},y_{\\text{m}})$ is either of the two symmetry-related minima from step $2$.\n\nExpress your final answer for the barrier height $\\Delta V$ as a single exact rational number (no approximation) in the reduced energy units of the given PES (no physical units). Your final answer must be a single value.", "solution": "The problem requires a thorough analysis of the potential energy surface (PES) given by $V(x,y)=x^{4}-2x^{2}+y^{2}+\\frac{1}{2}xy$. The analysis proceeds in three stages as requested: first, locating all stationary points; second, classifying these points; and third, calculating the energy barrier for the transition between the potential wells.\n\nStep 1: Determination of Stationary Points\n\nA stationary point $(x^{*},y^{*})$ of a scalar field $V(x,y)$ must satisfy the condition that the gradient of the field is zero, i.e., $\\nabla V(x^{*},y^{*})=\\mathbf{0}$. This corresponds to a system of two equations:\n$$ \\frac{\\partial V}{\\partial x} = 0 $$\n$$ \\frac{\\partial V}{\\partial y} = 0 $$\nFirst, we compute the partial derivatives of the given potential $V(x,y)$:\n$$ \\frac{\\partial V}{\\partial x} = \\frac{\\partial}{\\partial x} (x^{4}-2x^{2}+y^{2}+\\frac{1}{2}xy) = 4x^{3} - 4x + \\frac{1}{2}y $$\n$$ \\frac{\\partial V}{\\partial y} = \\frac{\\partial}{\\partial y} (x^{4}-2x^{2}+y^{2}+\\frac{1}{2}xy) = 2y + \\frac{1}{2}x $$\nSetting these to zero gives the system of equations:\n$$ 4x^{3} - 4x + \\frac{1}{2}y = 0 \\quad (1) $$\n$$ 2y + \\frac{1}{2}x = 0 \\quad (2) $$\nFrom equation $(2)$, we can express $y$ in terms of $x$:\n$$ 2y = -\\frac{1}{2}x \\implies y = -\\frac{1}{4}x $$\nSubstituting this expression for $y$ into equation $(1)$:\n$$ 4x^{3} - 4x + \\frac{1}{2}(-\\frac{1}{4}x) = 0 $$\n$$ 4x^{3} - 4x - \\frac{1}{8}x = 0 $$\n$$ 4x^{3} - (\\frac{32}{8} + \\frac{1}{8})x = 0 $$\n$$ 4x^{3} - \\frac{33}{8}x = 0 $$\nFactoring out $x$:\n$$ x(4x^{2} - \\frac{33}{8}) = 0 $$\nThis equation yields three possible solutions for $x$:\n1. $x = 0$\n2. $4x^{2} = \\frac{33}{8} \\implies x^{2} = \\frac{33}{32} \\implies x = \\pm\\sqrt{\\frac{33}{32}} = \\pm\\frac{\\sqrt{33}}{4\\sqrt{2}} = \\pm\\frac{\\sqrt{66}}{8}$\n\nWe find the corresponding $y$ values for each $x$ using $y = -\\frac{1}{4}x$:\n- For $x_0 = 0$: $y_0 = -\\frac{1}{4}(0) = 0$. The first stationary point is $P_0 = (0,0)$.\n- For $x_1 = \\sqrt{\\frac{33}{32}}$: $y_1 = -\\frac{1}{4}\\sqrt{\\frac{33}{32}}$. The second stationary point is $P_1 = (\\sqrt{\\frac{33}{32}}, -\\frac{1}{4}\\sqrt{\\frac{33}{32}})$.\n- For $x_2 = -\\sqrt{\\frac{33}{32}}$: $y_2 = -\\frac{1}{4}(-\\sqrt{\\frac{33}{32}}) = \\frac{1}{4}\\sqrt{\\frac{33}{32}}$. The third stationary point is $P_2 = (-\\sqrt{\\frac{33}{32}}, \\frac{1}{4}\\sqrt{\\frac{33}{32}})$.\n\nStep 2: Classification of Stationary Points\n\nThe classification of these stationary points is determined by the definiteness of the Hessian matrix $H$, evaluated at each point. The Hessian matrix is the matrix of second partial derivatives:\n$$ H(x,y) = \\begin{pmatrix} \\frac{\\partial^2 V}{\\partial x^2}  \\frac{\\partial^2 V}{\\partial x \\partial y} \\\\ \\frac{\\partial^2 V}{\\partial y \\partial x}  \\frac{\\partial^2 V}{\\partial y^2} \\end{pmatrix} $$\nThe required second-order partial derivatives are:\n$$ \\frac{\\partial^2 V}{\\partial x^2} = \\frac{\\partial}{\\partial x} (4x^{3} - 4x + \\frac{1}{2}y) = 12x^{2} - 4 $$\n$$ \\frac{\\partial^2 V}{\\partial y^2} = \\frac{\\partial}{\\partial y} (2y + \\frac{1}{2}x) = 2 $$\n$$ \\frac{\\partial^2 V}{\\partial x \\partial y} = \\frac{\\partial}{\\partial x} (2y + \\frac{1}{2}x) = \\frac{1}{2} $$\nSo the Hessian matrix is:\n$$ H(x,y) = \\begin{pmatrix} 12x^{2} - 4  \\frac{1}{2} \\\\ \\frac{1}{2}  2 \\end{pmatrix} $$\nWe now evaluate this matrix at each stationary point. The nature of the point is determined by the signs of the eigenvalues of $H$. This can be assessed using the determinant, $\\det(H)$, and the trace, $\\text{tr}(H)$. If $\\det(H)  0$, the eigenvalues have opposite signs, indicating a saddle point. If $\\det(H)  0$, the eigenvalues have the same sign; if $\\text{tr}(H)  0$, both are positive (local minimum), and if $\\text{tr}(H)  0$, both are negative (local maximum).\n\n- At point $P_0 = (0,0)$:\n$$ H(0,0) = \\begin{pmatrix} 12(0)^{2} - 4  \\frac{1}{2} \\\\ \\frac{1}{2}  2 \\end{pmatrix} = \\begin{pmatrix} -4  \\frac{1}{2} \\\\ \\frac{1}{2}  2 \\end{pmatrix} $$\n$$ \\det(H(0,0)) = (-4)(2) - (\\frac{1}{2})(\\frac{1}{2}) = -8 - \\frac{1}{4} = -\\frac{33}{4} $$\nSince the determinant is negative, the eigenvalues have opposite signs. Thus, $P_0 = (0,0)$ is an index-$1$ saddle point (a transition state).\n\n- At points $P_1$ and $P_2$:\nFor both these points, $x^{2} = \\frac{33}{32}$. The Hessian matrix is therefore the same for both.\n$$ \\frac{\\partial^2 V}{\\partial x^2} = 12(\\frac{33}{32}) - 4 = \\frac{3 \\cdot 33}{8} - 4 = \\frac{99}{8} - \\frac{32}{8} = \\frac{67}{8} $$\n$$ H(P_{1,2}) = \\begin{pmatrix} \\frac{67}{8}  \\frac{1}{2} \\\\ \\frac{1}{2}  2 \\end{pmatrix} $$\n$$ \\det(H(P_{1,2})) = (\\frac{67}{8})(2) - (\\frac{1}{2})(\\frac{1}{2}) = \\frac{67}{4} - \\frac{1}{4} = \\frac{66}{4} = \\frac{33}{2} $$\n$$ \\text{tr}(H(P_{1,2})) = \\frac{67}{8} + 2 = \\frac{67}{8} + \\frac{16}{8} = \\frac{83}{8} $$\nSince $\\det(H)  0$ and $\\text{tr}(H)  0$, both eigenvalues are positive. Therefore, points $P_1$ and $P_2$ are both local minima.\n\nStep 3: Calculation of the Barrier Height\n\nThe problem states that the minimum energy path (MEP) connects two minima. We have found two such minima, $P_1$ and $P_2$. The transition state on this path must be an index-$1$ saddle point. We have found a single such point, $P_0=(0,0)$. This must be the transition state for the reaction connecting the two wells. The coordinates of the saddle point are thus $(x_s, y_s) = (0,0)$. The coordinates of the minima are $(x_m, y_m)$, which can be taken as either $P_1$ or $P_2$. Let us select $P_1$.\n\nThe barrier height $\\Delta V$ is defined as the difference in potential energy between the saddle point and one of the minima:\n$$ \\Delta V = V(x_s, y_s) - V(x_m, y_m) $$\nFirst, calculate the potential energy at the saddle point $(x_s, y_s)=(0,0)$:\n$$ V(0,0) = (0)^{4} - 2(0)^{2} + (0)^{2} + \\frac{1}{2}(0)(0) = 0 $$\nNext, calculate the potential energy at a minimum, for instance using the coordinates of $P_1$ where $x_m^2 = \\frac{33}{32}$ and $y_m = -\\frac{1}{4}x_m$:\n$$ V(x_m, y_m) = x_m^{4} - 2x_m^{2} + y_m^{2} + \\frac{1}{2}x_m y_m $$\nSubstitute $y_m = -\\frac{1}{4}x_m$:\n$$ V(x_m, y_m) = x_m^{4} - 2x_m^{2} + (-\\frac{1}{4}x_m)^{2} + \\frac{1}{2}x_m(-\\frac{1}{4}x_m) $$\n$$ V(x_m, y_m) = x_m^{4} - 2x_m^{2} + \\frac{1}{16}x_m^{2} - \\frac{1}{8}x_m^{2} $$\n$$ V(x_m, y_m) = x_m^{4} - (\\frac{32}{16} - \\frac{1}{16} + \\frac{2}{16})x_m^{2} = x_m^{4} - \\frac{33}{16}x_m^{2} $$\nNow substitute the value $x_m^2 = \\frac{33}{32}$:\n$$ V(x_m, y_m) = (x_m^2)^2 - \\frac{33}{16}x_m^2 = (\\frac{33}{32})^2 - \\frac{33}{16}(\\frac{33}{32}) $$\n$$ V(x_m, y_m) = \\frac{33^2}{32^2} - \\frac{33^2}{16 \\cdot 32} = \\frac{1089}{1024} - \\frac{1089}{512} $$\n$$ V(x_m, y_m) = \\frac{1089}{1024} - \\frac{2 \\cdot 1089}{1024} = -\\frac{1089}{1024} $$\nThe potential energy at both minima is identical due to the symmetry of the potential with respect to the transformation $(x,y) \\rightarrow (-x,-y)$.\n\nFinally, the barrier height $\\Delta V$ is:\n$$ \\Delta V = V(0,0) - V(x_m, y_m) = 0 - (-\\frac{1089}{1024}) = \\frac{1089}{1024} $$\nThis value is an exact rational number as requested.", "answer": "$$\\boxed{\\frac{1089}{1024}}$$", "id": "2693873"}, {"introduction": "Conventional Transition State Theory places the dividing surface at the saddle point of the *potential* energy surface. Variational TST refines this by recognizing that the true bottleneck for a reaction at a given temperature occurs at the maximum of the *free energy* of activation. This exercise will guide you through calculating the Helmholtz free energy along a discretized Minimum Energy Path, incorporating temperature-dependent vibrational contributions, to identify the position of the variational transition state [@problem_id:2693838].", "problem": "A unimolecular isomerization proceeds along a minimum energy path (MEP) parameterized by a dimensionless arc-length coordinate $s \\in [0,1]$, with $s=0$ in the reactant valley and $s=1$ in the product valley. At each fixed $s$, one can construct a dividing surface orthogonal to the MEP and describe small-amplitude motions on this surface by harmonic vibrational normal modes with frequencies $\\nu_i(s)$ (in hertz), excluding the reaction coordinate itself. In Variational Transition State Theory (VTST), the location of the variational bottleneck is obtained by maximizing the Helmholtz free energy of activation $A^\\ddagger(s,T)$ over $s$ at the given temperature $T$, considering only the $s$-dependent contributions from the potential energy along the MEP and the orthogonal vibrational modes. Rotational and translational contributions can be taken as $s$-independent and therefore ignored in locating the maximum.\n\nStarting from the canonical (constant-$NVT$) ensemble and the quantum harmonic oscillator, derive from first principles an expression for the vibrational contribution to the Helmholtz free energy for a single harmonic mode of frequency $\\nu$, and use it to construct $A^\\ddagger(s,T)$ per mole as the sum of the potential energy along the MEP and the molar vibrational free energy contributions of the orthogonal modes.\n\nYou are given the following discrete grid of $s$ values with the MEP potential energy $V(s)$ (in kJ mol⁻¹ relative to reactants) and three orthogonal harmonic vibrational frequencies $\\nu_i(s)$ (in THz, i.e., $10^{12}$ Hz) for each dividing surface. Use $T=500\\ \\mathrm{K}$.\n\n- $s=0.00$: $V(s)=0.0$ kJ mol⁻¹; $\\nu_i(s)=(25.0,\\ 20.0,\\ 15.0)$ THz\n- $s=0.25$: $V(s)=20.0$ kJ mol⁻¹; $\\nu_i(s)=(22.0,\\ 18.0,\\ 14.0)$ THz\n- $s=0.50$: $V(s)=38.0$ kJ mol⁻¹; $\\nu_i(s)=(18.0,\\ 15.0,\\ 12.0)$ THz\n- $s=0.75$: $V(s)=27.0$ kJ mol⁻¹; $\\nu_i(s)=(20.0,\\ 16.0,\\ 13.0)$ THz\n- $s=1.00$: $V(s)=6.0$ kJ mol⁻¹; $\\nu_i(s)=(23.0,\\ 19.0,\\ 15.0)$ THz\n\nUse the following constants:\n- Planck constant $h = 6.62607015\\times 10^{-34}$ J s,\n- Boltzmann constant $k_B = 1.380649\\times 10^{-23}$ J K⁻¹,\n- Avogadro constant $N_A = 6.02214076\\times 10^{23}$ mol⁻¹,\n- Gas constant $R = N_A k_B = 8.314462618$ J mol⁻¹ K⁻¹.\n\nTasks:\n1. Derive the expression for the molar vibrational Helmholtz free energy of a single quantum harmonic oscillator of frequency $\\nu$ at temperature $T$ and assemble the expression for $A^\\ddagger(s,T)$ per mole using the given data.\n2. Compute $A^\\ddagger(s,500\\ \\mathrm{K})$ in kJ mol⁻¹ for each $s$ in the grid.\n3. Identify the $s$ on this grid at which $A^\\ddagger(s,500\\ \\mathrm{K})$ is maximized (the variational bottleneck).\n\nReport as your final answer only the value of the maximizing $s$ on the given grid. Round your final answer to three significant figures. The reported $s$ is dimensionless.", "solution": "The first task is to derive from first principles the expression for the molar vibrational Helmholtz free energy. We begin with the canonical ensemble. The energy levels $E_n$ for a single quantum harmonic oscillator of frequency $\\nu$ are given by:\n$$E_n = \\left(n + \\frac{1}{2}\\right)h\\nu, \\quad n = 0, 1, 2, \\dots$$\nwhere $h$ is the Planck constant.\n\nThe canonical partition function, $q$, for this single oscillator at temperature $T$ is the sum over all quantum states:\n$$q_{vib} = \\sum_{n=0}^{\\infty} \\exp\\left(-\\frac{E_n}{k_B T}\\right) = \\sum_{n=0}^{\\infty} \\exp\\left(-\\frac{(n + \\frac{1}{2})h\\nu}{k_B T}\\right)$$\nwhere $k_B$ is the Boltzmann constant. This expression can be factored:\n$$q_{vib} = \\exp\\left(-\\frac{h\\nu}{2k_B T}\\right) \\sum_{n=0}^{\\infty} \\left[\\exp\\left(-\\frac{h\\nu}{k_B T}\\right)\\right]^n$$\nThe summation is a geometric series of the form $\\sum_{n=0}^{\\infty} x^n = \\frac{1}{1-x}$ with $x = \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)$. Since $T  0$, we have $|x|1$, and the series converges.\nThe partition function for one oscillator is therefore:\n$$q_{vib} = \\frac{\\exp\\left(-\\frac{h\\nu}{2k_B T}\\right)}{1 - \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)}$$\nThe Helmholtz free energy, $A$, is related to the partition function by $A = -k_B T \\ln q$. For a single oscillator, the vibrational Helmholtz free energy, $A_{vib}$, is:\n$$A_{vib} = -k_B T \\ln(q_{vib}) = -k_B T \\ln\\left(\\frac{\\exp\\left(-\\frac{h\\nu}{2k_B T}\\right)}{1 - \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)}\\right)$$\nUsing the properties of logarithms, we obtain:\n$$A_{vib} = -k_B T \\left[-\\frac{h\\nu}{2k_B T} - \\ln\\left(1 - \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)\\right)\\right]$$\n$$A_{vib} = \\frac{1}{2}h\\nu + k_B T \\ln\\left(1 - \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)\\right)$$\nThis expression represents the free energy of a single oscillator. It includes the zero-point energy ($ZPE$), $\\frac{1}{2}h\\nu$, and a temperature-dependent term.\nTo obtain the molar vibrational Helmholtz free energy, $A_{vib, m}$, we multiply by the Avogadro constant $N_A$:\n$$A_{vib, m} = N_A A_{vib} = \\frac{1}{2}N_A h\\nu + N_A k_B T \\ln\\left(1 - \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)\\right)$$\nUsing the definition of the molar gas constant, $R = N_A k_B$, the final expression is:\n$$A_{vib, m}(\\nu, T) = \\frac{1}{2}N_A h\\nu + R T \\ln\\left(1 - \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)\\right)$$\nThe problem defines the Helmholtz free energy of activation, $A^\\ddagger(s,T)$, as the difference between the Helmholtz free energy at a dividing surface $s$ and that of the reactants at $s=0$. The total Helmholtz free energy at any $s$ is the sum of the potential energy $V(s)$ and the contributions from all $N_{modes}$ orthogonal vibrational modes. Given $V(s=0)=0$:\n$$A^\\ddagger(s,T) = \\left(V(s) + \\sum_{i=1}^{N_{modes}} A_{vib, m}(\\nu_i(s), T)\\right) - \\left(V(s=0) + \\sum_{i=1}^{N_{modes}} A_{vib, m}(\\nu_i(0), T)\\right)$$\n$$A^\\ddagger(s,T) = V(s) + \\sum_{i=1}^{N_{modes}} \\left[A_{vib, m}(\\nu_i(s), T) - A_{vib, m}(\\nu_i(0), T)\\right]$$\n\nThe second task is to compute $A^\\ddagger(s,T)$ for the given grid of $s$ values at $T=500\\ \\mathrm{K}$. We are given three orthogonal modes ($N_{modes}=3$) at each point. We must use the provided constants:\n$h = 6.62607015\\times 10^{-34}\\ \\mathrm{J\\ s}$\n$k_B = 1.380649\\times 10^{-23}\\ \\mathrm{J\\ K^{-1}}$\n$N_A = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$\n$R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$\n$T = 500\\ \\mathrm{K}$\n\nWe first compute the total molar vibrational free energy at the reactant state, $s=0$, which serves as our reference. At $s=0$, the frequencies are $\\nu_i(0)=(25.0, 20.0, 15.0)\\ \\mathrm{THz}$. Let's denote the sum as $A_{vib,tot}(s,T) = \\sum_{i=1}^3 A_{vib,m}(\\nu_i(s), T)$.\nFor $s=0.00$:\nThe frequencies are $\\nu_1 = 25.0 \\times 10^{12}\\ \\mathrm{Hz}$, $\\nu_2 = 20.0 \\times 10^{12}\\ \\mathrm{Hz}$, and $\\nu_3 = 15.0 \\times 10^{12}\\ \\mathrm{Hz}$.\n$A_{vib,m}(25.0\\ \\mathrm{THz}) = 4.592\\ \\mathrm{kJ\\ mol^{-1}}$\n$A_{vib,m}(20.0\\ \\mathrm{THz}) = 3.331\\ \\mathrm{kJ\\ mol^{-1}}$\n$A_{vib,m}(15.0\\ \\mathrm{THz}) = 1.868\\ \\mathrm{kJ\\ mol^{-1}}$\n$A_{vib,tot}(s=0, T=500\\ \\mathrm{K}) = 4.592 + 3.331 + 1.868 = 9.791\\ \\mathrm{kJ\\ mol^{-1}}$.\nBy definition, $A^\\ddagger(0,T) = V(0) + A_{vib,tot}(0,T) - A_{vib,tot}(0,T) = 0\\ \\mathrm{kJ\\ mol^{-1}}$.\n\nNow we compute $A^\\ddagger(s,T)$ for the other points on the grid.\nFor $s=0.25$: $V(s) = 20.0\\ \\mathrm{kJ\\ mol^{-1}}$, $\\nu_i(s) = (22.0, 18.0, 14.0)\\ \\mathrm{THz}$.\n$A_{vib,tot}(s=0.25, T=500\\ \\mathrm{K}) = A_{vib,m}(22.0) + A_{vib,m}(18.0) + A_{vib,m}(14.0) = 3.869 + 2.767 + 1.639 = 8.275\\ \\mathrm{kJ\\ mol^{-1}}$.\n$A^\\ddagger(0.25, T) = V(0.25) + A_{vib,tot}(0.25,T) - A_{vib,tot}(0,T) = 20.0 + 8.275 - 9.791 = 18.484\\ \\mathrm{kJ\\ mol^{-1}}$.\n\nFor $s=0.50$: $V(s) = 38.0\\ \\mathrm{kJ\\ mol^{-1}}$, $\\nu_i(s) = (18.0, 15.0, 12.0)\\ \\mathrm{THz}$.\n$A_{vib,tot}(s=0.50, T=500\\ \\mathrm{K}) = A_{vib,m}(18.0) + A_{vib,m}(15.0) + A_{vib,m}(12.0) = 2.767 + 1.868 + 1.207 = 5.842\\ \\mathrm{kJ\\ mol^{-1}}$.\n$A^\\ddagger(0.50, T) = V(0.50) + A_{vib,tot}(0.50,T) - A_{vib,tot}(0,T) = 38.0 + 5.842 - 9.791 = 34.051\\ \\mathrm{kJ\\ mol^{-1}}$.\n\nFor $s=0.75$: $V(s) = 27.0\\ \\mathrm{kJ\\ mol^{-1}}$, $\\nu_i(s) = (20.0, 16.0, 13.0)\\ \\mathrm{THz}$.\n$A_{vib,tot}(s=0.75, T=500\\ \\mathrm{K}) = A_{vib,m}(20.0) + A_{vib,m}(16.0) + A_{vib,m}(13.0) = 3.331 + 2.116 + 1.419 = 6.866\\ \\mathrm{kJ\\ mol^{-1}}$.\n$A^\\ddagger(0.75, T) = V(0.75) + A_{vib,tot}(0.75,T) - A_{vib,tot}(0,T) = 27.0 + 6.866 - 9.791 = 24.075\\ \\mathrm{kJ\\ mol^{-1}}$.\n\nFor $s=1.00$: $V(s) = 6.0\\ \\mathrm{kJ\\ mol^{-1}}$, $\\nu_i(s) = (23.0, 19.0, 15.0)\\ \\mathrm{THz}$.\n$A_{vib,tot}(s=1.00, T=500\\ \\mathrm{K}) = A_{vib,m}(23.0) + A_{vib,m}(19.0) + A_{vib,m}(15.0) = 4.103 + 3.045 + 1.868 = 9.016\\ \\mathrm{kJ\\ mol^{-1}}$.\n$A^\\ddagger(1.00, T) = V(1.00) + A_{vib,tot}(1.00,T) - A_{vib,tot}(0,T) = 6.0 + 9.016 - 9.791 = 5.225\\ \\mathrm{kJ\\ mol^{-1}}$.\n\nThe third task is to identify the value of $s$ that maximizes $A^\\ddagger(s, 500\\ \\mathrm{K})$. Summarizing the results:\n$A^\\ddagger(0.00, 500\\ \\mathrm{K}) = 0.000\\ \\mathrm{kJ\\ mol^{-1}}$\n$A^\\ddagger(0.25, 500\\ \\mathrm{K}) = 18.484\\ \\mathrm{kJ\\ mol^{-1}}$\n$A^\\ddagger(0.50, 500\\ \\mathrm{K}) = 34.051\\ \\mathrm{kJ\\ mol^{-1}}$\n$A^\\ddagger(0.75, 500\\ \\mathrm{K}) = 24.075\\ \\mathrm{kJ\\ mol^{-1}}$\n$A^\\ddagger(1.00, 500\\ \\mathrm{K}) = 5.225\\ \\mathrm{kJ\\ mol^{-1}}$\n\nBy direct comparison, the maximum value of $A^\\ddagger(s, 500\\ \\mathrm{K})$ on the given grid is $34.051\\ \\mathrm{kJ\\ mol^{-1}}$, which occurs at $s=0.50$. This position corresponds to the variational bottleneck for the reaction at this temperature. The maximum of the potential energy curve $V(s)$ also occurs at $s=0.50$, but the free energy barrier is lower than the potential energy barrier ($38.0\\ \\mathrm{kJ\\ mol^{-1}}$) due to changes in the vibrational frequencies along the reaction path.\n\nThe problem asks for the value of $s$ that maximizes $A^\\ddagger(s,T)$. This value is $0.50$. Rounding to three significant figures, we write $0.500$.", "answer": "$$\\boxed{0.500}$$", "id": "2693838"}, {"introduction": "The ultimate goal of theoretical kinetics is often the computation of a rate constant. This practice challenges you to translate the principles of VTST into a working numerical algorithm, a crucial skill for any computational chemist. You will implement a procedure to scan a discretized reaction path, calculate the free energy profile, identify the variational bottleneck, and compute the final VTST rate constant, solidifying your understanding from theory to implementation [@problem_id:2693805].", "problem": "You are given a discretized minimum energy path (MEP) parameterized by a scalar reaction coordinate $s$ sampled at grid points $\\{s_j\\}_{j=0}^{M-1}$. At each grid point $s_j$, you are provided with:\n- a potential energy value $V(s_j)$, and\n- the set of orthogonal harmonic mode angular frequencies $\\{\\omega_i(s_j)\\}_{i=1}^{N}$, representing all vibrational modes orthogonal to the reaction coordinate at that $s_j$.\n\nYou are also given the orthogonal mode frequencies at the reactant reference state, $\\{\\omega_i^{R}\\}_{i=1}^{N}$, and the reactant reference potential $V_R \\equiv V(s_0)$. Work in reduced units where the Boltzmann constant $k_B$ is $1$, the reduced Planck constant $\\hbar$ is $1$, and the Planck constant $h$ is therefore $2\\pi$.\n\nStarting from the canonical flux-over-population definition for a fixed dividing surface and the definition of the canonical partition function, construct and implement a numerical algorithm that scans the grid $\\{s_j\\}$ to compute the Variational Transition State Theory (VTST) rate constant $k_{\\text{VTST}}(T)$ at a given temperature $T$ by variationally selecting the dividing surface that minimizes the flux-over-population rate. Use the quantum harmonic oscillator partition function for each orthogonal mode. Your algorithm must:\n- represent the free energy of a dividing surface at $s_j$ in terms of the potential $V(s_j)$ and the vibrational partition functions of the orthogonal modes $\\{\\omega_i(s_j)\\}_{i=1}^{N}$,\n- represent the reactant free energy in terms of $V_R$ and $\\{\\omega_i^{R}\\}_{i=1}^{N}$,\n- evaluate the free energy barrier along the path, and\n- compute the rate by the flux-over-population expression at the variationally optimal $s_j$.\n\nAll computations must be performed in the reduced unit system above (no physical units are required in the output). The temperature is dimensionless. Angles are not involved. All final numerical answers must be floats.\n\nYour program must implement the algorithm and evaluate it on the following test suite. For each test case, the inputs are:\n- a temperature $T$,\n- a list of grid points $\\{s_j\\}$ (only used for indexing; the algorithm must not assume any particular spacing),\n- a list of potentials $\\{V(s_j)\\}$ with $V_R = V(s_0)$,\n- a nested list of orthogonal mode frequencies at each grid point, $\\{\\{\\omega_i(s_j)\\}_{i=1}^N\\}_{j=0}^{M-1}$,\n- a list of reactant orthogonal frequencies $\\{\\omega_i^{R}\\}_{i=1}^N$ (corresponding to $s_0$).\n\nUse the exact quantum harmonic oscillator partition function for each mode, with inverse temperature $\\beta = 1/T$, given by\n$$\nq(\\omega, T) = \\frac{e^{-\\beta \\omega / 2}}{1 - e^{-\\beta \\omega}}.\n$$\nUse the canonical flux-over-population form for the rate at a fixed dividing surface, and select the variationally optimal dividing surface $s^\\ast$ by scanning all grid points.\n\nTest suite:\n- Case A:\n  - $T = 1.0$\n  - $\\{s_j\\}_{j=0}^{4} = \\{-1.0, -0.5, 0.0, 0.5, 1.0\\}$\n  - $\\{V(s_j)\\}_{j=0}^{4} = \\{0.0, 0.3, 0.8, 0.3, 0.05\\}$\n  - $\\{\\{\\omega_i(s_j)\\}_{i=1}^{3}\\}_{j=0}^{4} = \\{[1.2, 1.0, 0.8], [1.1, 0.9, 0.7], [0.9, 0.85, 0.6], [1.0, 0.95, 0.65], [1.1, 1.0, 0.7]\\}$\n  - $\\{\\omega_i^{R}\\}_{i=1}^{3} = \\{1.2, 1.0, 0.8\\}$\n- Case B:\n  - $T = 0.8$\n  - $\\{s_j\\}_{j=0}^{3} = \\{-1.5, -0.5, 0.4, 1.2\\}$\n  - $\\{V(s_j)\\}_{j=0}^{3} = \\{0.0, 0.2, 0.5, 0.9\\}$\n  - $\\{\\{\\omega_i(s_j)\\}_{i=1}^{2}\\}_{j=0}^{3} = \\{[1.4, 1.3], [1.3, 1.25], [1.25, 1.2], [1.2, 1.15]\\}$\n  - $\\{\\omega_i^{R}\\}_{i=1}^{2} = \\{1.4, 1.3\\}$\n- Case C:\n  - $T = 0.5$\n  - $\\{s_j\\}_{j=0}^{3} = \\{-0.8, -0.2, 0.1, 0.6\\}$\n  - $\\{V(s_j)\\}_{j=0}^{3} = \\{0.0, 0.15, 0.25, 0.6\\}$\n  - $\\{\\{\\omega_i(s_j)\\}_{i=1}^{4}\\}_{j=0}^{3} = \\{[1.5, 1.1, 0.9, 0.4], [1.4, 1.0, 0.6, 0.2], [1.3, 0.9, 0.3, 0.15], [1.35, 0.95, 0.5, 0.25]\\}$\n  - $\\{\\omega_i^{R}\\}_{i=1}^{4} = \\{1.5, 1.1, 0.9, 0.4\\}$\n\nYour program must:\n- implement the scanning algorithm described above,\n- compute $k_{\\text{VTST}}(T)$ for each case,\n- and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,x_3]$, where each $x_i$ is the float for the corresponding test case. You must round each $x_i$ to exactly $8$ decimal places in the output.", "solution": "The objective is to compute the VTST rate constant, $k_{\\text{VTST}}(T)$, for a reaction described by a discretized Minimum Energy Path (MEP). The VTST principle asserts that the \"true\" transition state is the configuration along the reaction path that corresponds to the maximum of the Gibbs free energy of activation. This is equivalent to finding the dividing surface that minimizes the calculated rate, as any other choice would permit recrossing trajectories, leading to an overestimation of the rate.\n\nWe begin with the fundamental expression for the rate constant, $k(s, T)$, for a dividing surface located at a specific point $s$ along the reaction coordinate, derived from Transition State Theory (TST):\n$$\nk(s, T) = \\frac{k_B T}{h} \\frac{Q^{\\ddagger}(s, T)}{Q^R(T)}\n$$\nwhere $k_B$ is the Boltzmann constant, $h$ is the Planck constant, $T$ is the temperature, $Q^R(T)$ is the canonical partition function of the reactants, and $Q^{\\ddagger}(s, T)$ is the canonical partition function of the activated complex at the dividing surface $s$, with the motion along the reaction coordinate factored out.\n\nThe problem specifies a system of reduced units where $k_B = 1$, $\\hbar = 1$, and thus $h = 2\\pi\\hbar = 2\\pi$. The inverse temperature is $\\beta = (k_B T)^{-1} = 1/T$. In these units, the rate expression becomes:\n$$\nk(s, T) = \\frac{T}{2\\pi} \\frac{Q^{\\ddagger}(s, T)}{Q^R(T)}\n$$\nThe canonical partition function, $Q$, is related to the Helmholtz free energy, $A$, by the expression $A = -k_B T \\ln Q$. In our units, this is $A = -T \\ln Q$. This allows us to express the ratio of partition functions in terms of the free energy of activation, $\\Delta A^{\\ddagger}(s, T)$:\n$$\n\\frac{Q^{\\ddagger}(s, T)}{Q^R(T)} = \\frac{e^{-A(s, T) / T}}{e^{-A^R(T) / T}} = e^{-(A(s, T) - A^R(T)) / T} = e^{-\\Delta A^{\\ddagger}(s, T) / T}\n$$\nSubstituting this into the rate expression gives:\n$$\nk(s, T) = \\frac{T}{2\\pi} e^{-\\Delta A^{\\ddagger}(s, T) / T}\n$$\nThe Helmholtz free energy $A(s, T)$ at a point $s_j$ on the MEP is determined by its potential energy $V(s_j)$ and the vibrational partition functions of the $N$ modes orthogonal to the reaction coordinate. Assuming the total partition function is a product of its components, and that non-vibrational components cancel between the reactant and dividing surface, we have:\n$$\nQ^{\\ddagger}(s_j, T) = \\left( \\prod_{i=1}^{N} q(\\omega_i(s_j), T) \\right) e^{-V(s_j) / T}\n$$\nwhere $q(\\omega_i(s_j), T)$ is the vibrational partition function for the $i$-th orthogonal mode with frequency $\\omega_i(s_j)$ at grid point $s_j$.\nThe problem specifies the use of the quantum harmonic oscillator (QHO) partition function. For a mode with angular frequency $\\omega$, the energy levels are $E_n = \\hbar\\omega(n + 1/2)$, which are $E_n = \\omega(n + 1/2)$ in our units. The QHO partition function is:\n$$\nq(\\omega, T) = \\sum_{n=0}^{\\infty} e^{-\\beta E_n} = e^{-\\beta\\omega/2} \\sum_{n=0}^{\\infty} (e^{-\\beta\\omega})^n = \\frac{e^{-\\beta\\omega/2}}{1 - e^{-\\beta\\omega}}\n$$\nThis matches the formula provided. The free energy at the dividing surface $s_j$ is therefore:\n$$\nA(s_j, T) = -T \\ln Q^{\\ddagger}(s_j, T) = V(s_j) - T \\sum_{i=1}^{N} \\ln q(\\omega_i(s_j), T)\n$$\nSimilarly, the reactant free energy $A^R(T)$ is computed using the reactant reference potential $V_R = V(s_0)$ and reactant frequencies $\\{\\omega_i^R\\}$:\n$$\nA^R(T) = V_R - T \\sum_{i=1}^{N} \\ln q(\\omega_i^R, T)\n$$\nThe activation free energy profile is $\\Delta A^{\\ddagger}(s_j, T) = A(s_j, T) - A^R(T)$.\n\nThe variational principle requires us to find the location $s^*$ that maximizes the free energy barrier $\\Delta A^{\\ddagger}(s, T)$, which corresponds to the minimum rate. Since the MEP is discretized into points $\\{s_j\\}$, we perform a scan over all these points:\n$$\n\\Delta A^{\\ddagger}_{\\max}(T) = \\max_{j} \\{ \\Delta A^{\\ddagger}(s_j, T) \\}\n$$\nThe VTST rate constant is then computed using this maximal free energy barrier:\n$$\nk_{\\text{VTST}}(T) = \\frac{T}{2\\pi} e^{-\\Delta A^{\\ddagger}_{\\max}(T) / T}\n$$\nThe algorithm is as follows:\n1.  For a given temperature $T$, calculate $\\beta = 1/T$.\n2.  Compute the reactant free energy, $A^R(T)$, using $V_R=V(s_0)$ and frequencies $\\{\\omega_i^R\\}$.\n3.  Initialize a variable $\\Delta A^{\\ddagger}_{\\max}$ to $-\\infty$.\n4.  Iterate through each grid point $s_j$ ($j=0, \\dots, M-1$):\n    a. Compute the free energy $A(s_j, T)$ using the potential $V(s_j)$ and frequencies $\\{\\omega_i(s_j)\\}$.\n    b. Calculate the activation free energy $\\Delta A^{\\ddagger}(s_j, T) = A(s_j, T) - A^R(T)$.\n    c. Update $\\Delta A^{\\ddagger}_{\\max} = \\max(\\Delta A^{\\ddagger}_{\\max}, \\Delta A^{\\ddagger}(s_j, T))$.\n5.  After scanning all points, use the final $\\Delta A^{\\ddagger}_{\\max}$ to calculate $k_{\\text{VTST}}(T)$.\n\nThis procedure is implemented for each test case to obtain the final numerical results.", "answer": "```python\n# The final answer must be a single, complete, standalone program.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the variational transition state theory problem\n    for the provided test suite.\n    \"\"\"\n    test_cases = [\n        {\n            \"T\": 1.0,\n            \"s_j\": [-1.0, -0.5, 0.0, 0.5, 1.0],\n            \"V_sj\": [0.0, 0.3, 0.8, 0.3, 0.05],\n            \"omega_ij\": [\n                [1.2, 1.0, 0.8], \n                [1.1, 0.9, 0.7], \n                [0.9, 0.85, 0.6], \n                [1.0, 0.95, 0.65], \n                [1.1, 1.0, 0.7]\n            ],\n            \"omega_iR\": [1.2, 1.0, 0.8]\n        },\n        {\n            \"T\": 0.8,\n            \"s_j\": [-1.5, -0.5, 0.4, 1.2],\n            \"V_sj\": [0.0, 0.2, 0.5, 0.9],\n            \"omega_ij\": [\n                [1.4, 1.3], \n                [1.3, 1.25], \n                [1.25, 1.2], \n                [1.2, 1.15]\n            ],\n            \"omega_iR\": [1.4, 1.3]\n        },\n        {\n            \"T\": 0.5,\n            \"s_j\": [-0.8, -0.2, 0.1, 0.6],\n            \"V_sj\": [0.0, 0.15, 0.25, 0.6],\n            \"omega_ij\": [\n                [1.5, 1.1, 0.9, 0.4], \n                [1.4, 1.0, 0.6, 0.2], \n                [1.3, 0.9, 0.3, 0.15], \n                [1.35, 0.95, 0.5, 0.25]\n            ],\n            \"omega_iR\": [1.5, 1.1, 0.9, 0.4]\n        }\n    ]\n\n    def q_ho(omega, T):\n        \"\"\"\n        Calculates the quantum harmonic oscillator partition function for a single mode.\n        q(omega, T) = exp(-beta*omega/2) / (1 - exp(-beta*omega))\n        \"\"\"\n        if T = 0:\n            return 0.0\n        beta = 1.0 / T\n        \n        # Avoid division by zero for omega=0, though not expected here.\n        if abs(omega)  1e-12:\n            return 1.0 / (beta*omega) if beta*omega != 0 else float('inf') \n\n        beta_omega = beta * omega\n        \n        # Avoid overflow in exp(x) by using exp(-abs(x))\n        if beta_omega > 700: # np.exp(709) is max, but be safe\n            return np.exp(-beta_omega / 2.0)\n        \n        return np.exp(-beta_omega / 2.0) / (1.0 - np.exp(-beta_omega))\n\n    def calculate_helmholtz_free_energy(V, omegas, T):\n        \"\"\"\n        Calculates the Helmholtz free energy for a given configuration.\n        A = V - T * sum(ln(q_i))\n        \"\"\"\n        sum_ln_q = 0.0\n        for omega in omegas:\n            sum_ln_q += np.log(q_ho(omega, T))\n        \n        return V - T * sum_ln_q\n\n    results = []\n    for case in test_cases:\n        T = case[\"T\"]\n        V_sj_list = case[\"V_sj\"]\n        omega_ij_list = case[\"omega_ij\"]\n        omega_iR = case[\"omega_iR\"]\n        \n        # The reactant reference state is at s_0\n        V_R = V_sj_list[0]\n        \n        # Calculate the Helmholtz free energy of the reactant state\n        A_R = calculate_helmholtz_free_energy(V_R, omega_iR, T)\n        \n        max_delta_A_ddagger = -np.inf\n        \n        # Scan all grid points to find the maximum free energy barrier\n        num_points = len(V_sj_list)\n        for j in range(num_points):\n            V_j = V_sj_list[j]\n            omegas_j = omega_ij_list[j]\n            \n            # Calculate free energy at the current dividing surface\n            A_j = calculate_helmholtz_free_energy(V_j, omegas_j, T)\n            \n            # Calculate the free energy of activation relative to reactants\n            delta_A_ddagger = A_j - A_R\n            \n            # Update the maximum free energy barrier\n            if delta_A_ddagger > max_delta_A_ddagger:\n                max_delta_A_ddagger = delta_A_ddagger\n\n        # Calculate the VTST rate constant using the maximum free energy barrier\n        # k_vtst = (T / (2*pi)) * exp(-delta_A_max / T)\n        k_vtst = (T / (2.0 * np.pi)) * np.exp(-max_delta_A_ddagger / T)\n        results.append(k_vtst)\n\n    # Format the results to 8 decimal places as strings and join them\n    formatted_results = [\"{:.8f}\".format(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solver\nsolve()\n```", "id": "2693805"}]}