{"hands_on_practices": [{"introduction": "The relationship between a non-zero commutator and a physical observable is nowhere more apparent than in the Heisenberg uncertainty principle. This foundational exercise guides you through the derivation of the position-momentum uncertainty relation directly from the canonical commutator $[\\hat{x}, \\hat{p}] = i\\hbar$. By then applying these ideas to a Gaussian wavepacket and the quantum harmonic oscillator, you will see how this abstract algebraic property governs the minimum possible energy of a molecular vibration [@problem_id:2792117].", "problem": "In a one-dimensional quantum description of a diatomic molecule’s vibrational mode, the coordinate operator $\\hat{x}$ and momentum operator $\\hat{p}$ satisfy the canonical commutation relation $[\\hat{x},\\hat{p}] = i \\hbar \\hat{I}$, where $\\hbar$ is the reduced Planck constant and $\\hat{I}$ is the identity operator. Consider the harmonic approximation to the potential energy surface with the Hamiltonian $\\hat{H} = \\frac{\\hat{p}^{2}}{2 m} + \\frac{1}{2} m \\omega^{2} \\hat{x}^{2}$, where $m$ is the reduced mass and $\\omega$ is the angular frequency of the vibrational mode.\n\nYour tasks are:\n\n- Starting only from the commutator $[\\hat{x},\\hat{p}] = i \\hbar \\hat{I}$ and basic properties of inner products on a complex Hilbert space, derive a state-independent lower bound on the product of the standard deviations $\\Delta x$ and $\\Delta p$ of $\\hat{x}$ and $\\hat{p}$ in an arbitrary normalized state.\n\n- Consider the family of normalized Gaussian wavepackets\n$$\n\\psi_{x_{c},p_{c},\\alpha}(x) \\;=\\; \\left(\\frac{\\alpha}{\\pi}\\right)^{\\!1/4} \\exp\\!\\left(-\\frac{\\alpha}{2} (x - x_{c})^{2} + i \\frac{p_{c}}{\\hbar} x \\right),\n$$\nwith parameters $x_{c} \\in \\mathbb{R}$, $p_{c} \\in \\mathbb{R}$, and $\\alpha > 0$. Compute $\\Delta x$ and $\\Delta p$ for this state and verify whether the bound derived above is saturated.\n\n- For the harmonic Hamiltonian $\\hat{H}$, compute the energy expectation value $\\langle \\hat{H} \\rangle$ in the Gaussian state $\\psi_{x_{c},p_{c},\\alpha}$ as a function of $x_{c}$, $p_{c}$, and $\\alpha$. Minimize $\\langle \\hat{H} \\rangle$ over $x_{c}$, $p_{c}$, and $\\alpha$ to obtain the lowest possible value attained within this Gaussian family. Interpret your result in relation to the vibrational ground state.\n\nProvide as your final answer the exact symbolic expression, in terms of $\\hbar$ and $\\omega$, for the minimized energy expectation value obtained by this variational procedure. Do not substitute numerical values and do not report units; give a single closed-form expression only.", "solution": "The problem consists of three parts: deriving the Heisenberg uncertainty principle for position and momentum, analyzing a Gaussian wavepacket to verify it is a minimum uncertainty state, and applying the variational principle using this family of Gaussian states to find an upper bound on the ground state energy of the quantum harmonic oscillator.\n\nPart 1: Derivation of the State-Independent Lower Bound\n\nLet $\\hat{A}$ and $\\hat{B}$ be two Hermitian operators, and let $|\\psi\\rangle$ be an arbitrary normalized state. The standard deviation of an observable is defined as $\\Delta A = \\sqrt{\\langle (\\hat{A} - \\langle \\hat{A} \\rangle \\hat{I})^2 \\rangle}$. Let us define the \"centered\" operators $\\hat{A}' = \\hat{A} - \\langle \\hat{A} \\rangle \\hat{I}$ and $\\hat{B}' = \\hat{B} - \\langle \\hat{B} \\rangle \\hat{I}$. By definition, $(\\Delta A)^2 = \\langle (\\hat{A}')^2 \\rangle$ and $(\\Delta B)^2 = \\langle (\\hat{B}')^2 \\rangle$.\n\nConsider the states $|f\\rangle = \\hat{A}'|\\psi\\rangle$ and $|g\\rangle = \\hat{B}'|\\psi\\rangle$. The Cauchy-Schwarz inequality states that $\\langle f|f \\rangle \\langle g|g \\rangle \\geq |\\langle f|g \\rangle|^2$.\nSubstituting the definitions gives:\n$\\langle f|f \\rangle = \\langle \\psi | (\\hat{A}')^\\dagger \\hat{A}' | \\psi \\rangle = \\langle \\psi | (\\hat{A}')^2 | \\psi \\rangle = (\\Delta A)^2$.\n$\\langle g|g \\rangle = \\langle \\psi | (\\hat{B}')^\\dagger \\hat{B}' | \\psi \\rangle = \\langle \\psi | (\\hat{B}')^2 | \\psi \\rangle = (\\Delta B)^2$.\nThe inner product $\\langle f|g \\rangle$ is $\\langle \\psi | (\\hat{A}')^\\dagger \\hat{B}' | \\psi \\rangle = \\langle \\hat{A}'\\hat{B}' \\rangle$.\n\nSo the Cauchy-Schwarz inequality becomes:\n$$\n(\\Delta A)^2 (\\Delta B)^2 \\geq |\\langle \\hat{A}'\\hat{B}' \\rangle|^2\n$$\nAny operator, such as $\\hat{A}'\\hat{B}'$, can be written as $\\hat{A}'\\hat{B}' = \\frac{1}{2} \\{\\hat{A}', \\hat{B}'\\} + \\frac{1}{2} [\\hat{A}', \\hat{B}']$. The expectation value $\\langle \\{\\hat{A}', \\hat{B}'\\} \\rangle$ is real and $\\langle [\\hat{A}', \\hat{B}'] \\rangle$ is purely imaginary. For any complex number $z = x+iy$, $|z|^2 = x^2+y^2 \\geq y^2 = (\\text{Im}(z))^2$. Thus:\n$$\n|\\langle \\hat{A}'\\hat{B}' \\rangle|^2 \\geq \\left| \\text{Im} \\left( \\frac{1}{2} \\langle [\\hat{A}', \\hat{B}'] \\rangle \\right) \\right|^2\n$$\nFor $\\hat{A}=\\hat{x}$ and $\\hat{B}=\\hat{p}$, the commutator of the centered operators is $[\\hat{x}', \\hat{p}'] = [\\hat{x},\\hat{p}] = i\\hbar\\hat{I}$.\nThe expectation value is $\\langle [\\hat{x}', \\hat{p}'] \\rangle = i\\hbar$.\nThe imaginary part of $\\langle \\hat{x}'\\hat{p}' \\rangle$ is $\\text{Im}(\\frac{1}{2} \\langle i\\hbar \\rangle) = \\frac{\\hbar}{2}$.\nPutting this all together:\n$$\n(\\Delta x)^2 (\\Delta p)^2 \\geq \\left( \\frac{\\hbar}{2} \\right)^2\n$$\nTaking the square root yields the Heisenberg uncertainty principle:\n$$\n\\Delta x \\Delta p \\geq \\frac{\\hbar}{2}\n$$\n\nPart 2: Analysis of the Gaussian Wavepacket\n\nThe given normalized wavepacket is $\\psi(x) = (\\frac{\\alpha}{\\pi})^{1/4} \\exp(-\\frac{\\alpha}{2} (x - x_{c})^{2} + i \\frac{p_{c}}{\\hbar} x)$.\nThe probability density $|\\psi(x)|^2 = \\sqrt{\\frac{\\alpha}{\\pi}} \\exp(-\\alpha (x - x_{c})^{2})$ is a Gaussian distribution in $x$ centered at $x_c$ with variance $(\\Delta x)^2 = \\frac{1}{2\\alpha}$. Thus, $\\Delta x = \\frac{1}{\\sqrt{2\\alpha}}$.\nBy symmetry, the expectation value of momentum is $\\langle \\hat{p} \\rangle = p_c$.\nTo find $(\\Delta p)^2$, we compute $\\langle \\hat{p}^2 \\rangle$:\n$$\n\\langle \\hat{p}^2 \\rangle = \\int_{-\\infty}^{\\infty} (\\hat{p}\\psi(x))^* (\\hat{p}\\psi(x)) dx = \\int_{-\\infty}^{\\infty} |\\psi(x)|^2 |p_c + i\\hbar\\alpha(x-x_c)|^2 dx\n$$\n$$\n\\langle \\hat{p}^2 \\rangle = p_c^2 \\int_{-\\infty}^{\\infty} |\\psi(x)|^2 dx + \\hbar^2\\alpha^2 \\int_{-\\infty}^{\\infty} (x-x_c)^2 |\\psi(x)|^2 dx\n$$\nThe first integral is $1$ (normalization), and the second is the variance of $x$, $(\\Delta x)^2 = \\frac{1}{2\\alpha}$.\n$$\n\\langle \\hat{p}^2 \\rangle = p_c^2 + \\hbar^2\\alpha^2 \\left(\\frac{1}{2\\alpha}\\right) = p_c^2 + \\frac{\\hbar^2\\alpha}{2}\n$$\nThe variance in momentum is $(\\Delta p)^2 = \\langle \\hat{p}^2 \\rangle - \\langle \\hat{p} \\rangle^2 = \\frac{\\hbar^2\\alpha}{2}$.\nThis gives $\\Delta p = \\frac{\\hbar\\sqrt{\\alpha}}{\\sqrt{2}}$.\nThe uncertainty product is:\n$$\n\\Delta x \\Delta p = \\left(\\frac{1}{\\sqrt{2\\alpha}}\\right) \\left(\\frac{\\hbar\\sqrt{\\alpha}}{\\sqrt{2}}\\right) = \\frac{\\hbar}{2}\n$$\nThis is exactly the lower bound derived in Part 1. Thus, the Gaussian wavepacket saturates the Heisenberg uncertainty principle.\n\nPart 3: Variational Minimization of Energy\n\nThe Hamiltonian is $\\hat{H} = \\frac{\\hat{p}^{2}}{2 m} + \\frac{1}{2} m \\omega^{2} \\hat{x}^{2}$. The expectation value of the energy in the Gaussian trial state is $E(x_c, p_c, \\alpha) = \\frac{1}{2m}\\langle \\hat{p}^2 \\rangle + \\frac{1}{2}m\\omega^2\\langle \\hat{x}^2 \\rangle$.\nWe use $\\langle \\hat{x}^2 \\rangle = (\\Delta x)^2 + \\langle \\hat{x} \\rangle^2 = \\frac{1}{2\\alpha} + x_c^2$ and $\\langle \\hat{p}^2 \\rangle = (\\Delta p)^2 + \\langle \\hat{p} \\rangle^2 = \\frac{\\hbar^2\\alpha}{2} + p_c^2$.\nSubstituting these into the energy expression:\n$$\nE(x_c, p_c, \\alpha) = \\frac{1}{2m}\\left(p_c^2 + \\frac{\\hbar^2\\alpha}{2}\\right) + \\frac{1}{2}m\\omega^2\\left(x_c^2 + \\frac{1}{2\\alpha}\\right)\n$$\n$$\nE(x_c, p_c, \\alpha) = \\frac{p_c^2}{2m} + \\frac{m\\omega^2 x_c^2}{2} + \\frac{\\hbar^2\\alpha}{4m} + \\frac{m\\omega^2}{4\\alpha}\n$$\nTo find the minimum energy, we set the partial derivatives with respect to the parameters to zero.\n$$\n\\frac{\\partial E}{\\partial x_c} = m\\omega^2 x_c = 0 \\implies x_c = 0\n$$\n$$\n\\frac{\\partial E}{\\partial p_c} = \\frac{p_c}{m} = 0 \\implies p_c = 0\n$$\nSubstituting $x_c=0$ and $p_c=0$, the energy becomes a function of $\\alpha$ only:\n$$\nE(\\alpha) = \\frac{\\hbar^2\\alpha}{4m} + \\frac{m\\omega^2}{4\\alpha}\n$$\nWe minimize with respect to $\\alpha$:\n$$\n\\frac{dE}{d\\alpha} = \\frac{\\hbar^2}{4m} - \\frac{m\\omega^2}{4\\alpha^2} = 0 \\implies \\alpha^2 = \\frac{m^2\\omega^2}{\\hbar^2}\n$$\nSince $\\alpha$ must be positive, $\\alpha_{min} = \\frac{m\\omega}{\\hbar}$.\nFinally, we substitute $\\alpha_{min}$ back into the expression for $E(\\alpha)$ to find the minimum energy:\n$$\nE_{min} = \\frac{\\hbar^2}{4m}\\left(\\frac{m\\omega}{\\hbar}\\right) + \\frac{m\\omega^2}{4}\\left(\\frac{\\hbar}{m\\omega}\\right) = \\frac{\\hbar\\omega}{4} + \\frac{\\hbar\\omega}{4} = \\frac{1}{2}\\hbar\\omega\n$$\nAccording to the variational principle, the true ground state energy $E_0 \\le E_{min}$. Since this result matches the known exact ground state energy of the quantum harmonic oscillator, we have found that the optimal Gaussian is the true ground state wavefunction.\nThe minimized energy expectation value is the final answer.", "answer": "$$\n\\boxed{\\frac{1}{2}\\hbar\\omega}\n$$", "id": "2792117"}, {"introduction": "Beyond their connection to uncertainty, commutators are powerful tools for analyzing the structure of Hamiltonians and decoupling complex quantum systems into simpler parts. This practice explores the algebraic consequences of commuting an operator with a projector, which forms the mathematical basis for effective Hamiltonian theories used extensively in quantum chemistry. You will demonstrate that the condition for decoupling a model space from its environment is elegantly captured by a simple commutation relation [@problem_id:2792032].", "problem": "Consider a complex Hilbert space with a decomposition into a model (active) subspace and its orthogonal complement. Let $P$ be the orthogonal projector onto the model subspace, so that $P^{2}=P$ and $P^{\\dagger}=P$, and let $Q=\\mathbb{I}-P$ be the orthogonal projector onto the complementary subspace. Let $A$ be a general bounded linear operator on the Hilbert space.\n\n1) Using only the defining properties of projectors and the definition of a commutator, evaluate the commutator $[P A P, P]$.\n\n2) In effective Hamiltonian theory, one seeks a similarity-transformed Hamiltonian $\\bar{H}=\\exp(-S) H \\exp(S)$ that achieves exact decoupling between the model and complementary subspaces. Using fundamental operator algebra and your result from part (1), state a necessary and sufficient condition on $\\bar{H}$ for exact decoupling, and explain how it relates to the vanishing of the off-diagonal blocks $Q \\bar{H} P$ and $P \\bar{H} Q$. Justify your statements from first principles.\n\nExpress the final answer to part (1) as a single closed-form analytic expression. No numerical approximation is required.", "solution": "This problem consists of two parts. First, we must evaluate a specific commutator involving a general operator $A$ and a projection operator $P$. Second, we analyze the condition for the decoupling of subspaces in the context of effective Hamiltonian theory.\n\nPart 1: Evaluation of the commutator $[P A P, P]$\n\nThe commutator is defined as $[\\hat{X}, \\hat{Y}] = \\hat{X}\\hat{Y} - \\hat{Y}\\hat{X}$. The problem states that $P$ is an orthogonal projector, which is idempotent, meaning $P^{2} = P$. We are asked to evaluate $[P A P, P]$.\n\nApplying the definition of the commutator and the associative property of operator multiplication:\n$$\n[P A P, P] = (P A P) P - P (P A P) = P A (P P) - (P P) A P\n$$\nUsing the idempotent property, $P^{2} = P$:\n$$\n[P A P, P] = P A P - P A P = 0\n$$\nThe commutator is identically the zero operator.\n\nPart 2: Condition for exact decoupling in effective Hamiltonian theory\n\nThe Hilbert space is partitioned into a model subspace (range of $P$) and a complementary subspace (range of $Q = \\mathbb{I} - P$). Exact decoupling between these two subspaces means that the effective Hamiltonian, $\\bar{H}$, does not induce transitions between them. This requires the \"off-diagonal\" blocks of the Hamiltonian, which map between the subspaces, to be zero:\n$$\nP \\bar{H} Q = 0 \\quad \\text{and} \\quad Q \\bar{H} P = 0\n$$\nThe necessary and sufficient condition on $\\bar{H}$ that is equivalent to these two equations is that $\\bar{H}$ must commute with the projector $P$:\n$$\n[\\bar{H}, P] = 0\n$$\nWe prove this equivalence from first principles.\n\nFirst, we prove sufficiency: if $[\\bar{H}, P] = 0$, then the subspaces are decoupled.\nAssume $[\\bar{H}, P] = 0$, which means $\\bar{H} P = P \\bar{H}$.\nTo show that $Q \\bar{H} P = 0$, we pre-multiply the commutation relation by $Q$:\n$$\nQ (\\bar{H} P) = Q (P \\bar{H}) \\implies (Q \\bar{H}) P = (Q P) \\bar{H}\n$$\nSince $Q$ and $P$ project onto orthogonal subspaces, their product is the zero operator: $Q P = (\\mathbb{I} - P) P = P - P^2 = 0$.\nThus, $Q \\bar{H} P = 0$.\nTo show that $P \\bar{H} Q = 0$, we post-multiply the commutation relation by $Q$:\n$$\n(\\bar{H} P) Q = (P \\bar{H}) Q \\implies \\bar{H} (P Q) = P \\bar{H} Q\n$$\nSince $P Q = 0$, this gives $P \\bar{H} Q = 0$.\nThus, if $\\bar{H}$ commutes with $P$, the off-diagonal blocks vanish.\n\nSecond, we prove necessity: if the subspaces are decoupled, then $[\\bar{H}, P] = 0$.\nAssume the decoupling conditions $P \\bar{H} Q = 0$ and $Q \\bar{H} P = 0$. We can express any operator $\\bar{H}$ using the resolution of identity $\\mathbb{I} = P + Q$:\n$$\n\\bar{H} = \\mathbb{I} \\bar{H} \\mathbb{I} = (P + Q) \\bar{H} (P + Q) = P \\bar{H} P + P \\bar{H} Q + Q \\bar{H} P + Q \\bar{H} Q\n$$\nApplying the decoupling conditions, the expression for $\\bar{H}$ simplifies to its block-diagonal form:\n$$\n\\bar{H} = P \\bar{H} P + Q \\bar{H} Q\n$$\nNow, we compute the commutator $[\\bar{H}, P]$ using this form of $\\bar{H}$:\n$$\n[\\bar{H}, P] = [P \\bar{H} P + Q \\bar{H} Q, P] = [P \\bar{H} P, P] + [Q \\bar{H} Q, P]\n$$\nThe first term, $[P \\bar{H} P, P]$, was shown to be zero in Part 1.\nFor the second term, we apply the commutator definition and use $Q P = 0$ and $P Q = 0$:\n$$\n[Q \\bar{H} Q, P] = (Q \\bar{H} Q) P - P (Q \\bar{H} Q) = Q \\bar{H} (Q P) - (P Q) \\bar{H} Q = Q \\bar{H} (0) - (0) \\bar{H} Q = 0\n$$\nSince both terms in the sum are zero, we have $[\\bar{H}, P] = 0$.\nThis demonstrates that the vanishing of the off-diagonal blocks necessitates that $\\bar{H}$ commutes with $P$. In summary, $[\\bar{H}, P] = 0$ is the necessary and sufficient condition for exact decoupling.", "answer": "$$\n\\boxed{0}\n$$", "id": "2792032"}, {"introduction": "The repeated application of commutators can reveal the full dynamical capabilities of a quantum system, a concept at the heart of quantum control theory. This advanced practice challenges you to compute the \"dynamical Lie algebra\" for a vibronically coupled two-level system, a common model in molecular spectroscopy. By starting with just two Hamiltonians and repeatedly taking their commutators, you will map out the complete set of unitary transformations accessible to the system, revealing its underlying symmetry and control landscape [@problem_id:2791994].", "problem": "Consider a molecular two-level electronic system with ground state $\\lvert g \\rangle$ and excited state $\\lvert e \\rangle$ coupled to a single intramolecular vibrational normal mode modeled as a harmonic oscillator with annihilation and creation operators $a$ and $a^{\\dagger}$ satisfying $[a,a^{\\dagger}] = 1$. Work in the truncated Fock basis $\\{ \\lvert n \\rangle \\}_{n=0}^{M}$ for some fixed finite $M \\in \\mathbb{N}$, so the total Hilbert space dimension is $2(M+1)$. Define the Pauli operators $\\sigma_{x}$, $\\sigma_{y}$, and $\\sigma_{z}$ acting on the electronic subspace, and $\\sigma_{\\pm} = (\\sigma_{x} \\pm i \\sigma_{y})/2$.\n\nThe drift Hamiltonian is\n$$\nH_{0} = \\omega\\, a^{\\dagger} a + \\frac{\\Delta}{2}\\, \\sigma_{z},\n$$\nand the vibronic coupling is given by the Jaynes–Cummings interaction\n$$\nH_{1} = g \\left( \\sigma_{+} a + \\sigma_{-} a^{\\dagger} \\right),\n$$\nwith nonzero real parameters $\\omega$, $\\Delta$, and $g$. Assume the controls allow time-dependent switching of $H_{0}$ and $H_{1}$ so that the dynamical Lie algebra is the real Lie algebra $\\mathfrak{L}$ generated by the skew-Hermitian operators $iH_{0}$ and $iH_{1}$ under commutators and real linear combinations. Throughout, use only the canonical commutation relations, tensor-product structure, and definition of a Lie algebra generated by a set of operators as your starting point.\n\nDefine the total excitation operator\n$$\nK = a^{\\dagger} a + \\frac{1}{2} \\left( \\sigma_{z} + \\mathbb{I} \\right).\n$$\nIt is known that $K$ partitions the truncated Hilbert space into invariant subspaces for the Jaynes–Cummings coupling. Using operator algebra and commutator identities, starting only from the definitions above, do the following:\n\n1. Determine the block structure induced by $K$ on the truncated Hilbert space for general $M$, identifying the one-dimensional and two-dimensional invariant subspaces.\n\n2. Using commutators, show how $iH_{0}$ and $iH_{1}$ generate, within each two-dimensional invariant subspace, a copy of $\\mathfrak{su}(2)$, and argue how to separate these copies across different invariant subspaces solely by algebraic means available from $iH_{0}$ and $iH_{1}$. Your argument must rely on commutator-generated operators and their action on different invariant subspaces, without invoking any external theorems beyond the definitions and commutation relations stated.\n\n3. Conclude the structure of $\\mathfrak{L}$ and identify the connected component of the identity of the reachable set $\\exp(\\mathfrak{L})$. For your final reported result, compute the real dimension of $\\mathfrak{L}$ as a function of $M$.\n\nExpress your final answer as a single closed-form analytic expression in terms of $M$. No numerical approximation or rounding is required. No units are to be provided in the final answer.", "solution": "The solution proceeds by addressing the three specified tasks in order.\n\n1. Block Structure Induced by the Operator $K$\n\nThe operator $K$ is the total excitation number operator, which can also be written as $K = a^{\\dagger}a + \\sigma_{+}\\sigma_{-}$. The Hilbert space decomposes into invariant subspaces under the dynamics generated by $H_0$ and $H_1$ if $K$ commutes with both Hamiltonians.\n\nFirst, we verify the commutation of $K$ with $H_0$:\n$$[K, H_{0}] = \\left[ a^{\\dagger} a + \\frac{1}{2}(\\sigma_z + \\mathbb{I}), \\omega a^{\\dagger} a + \\frac{\\Delta}{2} \\sigma_z \\right]$$\nSince the vibrational operators ($a, a^\\dagger$) and electronic operators ($\\sigma_z$) act on different tensor product spaces, they commute. An operator also commutes with itself and the identity operator. Therefore, all terms in the expansion of the commutator are zero:\n$$[K, H_{0}] = \\omega [a^{\\dagger}a, a^{\\dagger}a] + \\frac{\\Delta}{2} [a^{\\dagger}a, \\sigma_z] + \\frac{\\omega}{2} [\\sigma_z+\\mathbb{I}, a^{\\dagger}a] + \\frac{\\Delta}{4} [\\sigma_z+\\mathbb{I}, \\sigma_z] = 0$$\n\nNext, we verify the commutation of $K$ with $H_1$:\n$$[K, H_{1}] = g [a^{\\dagger} a + \\sigma_{+}\\sigma_{-}, \\sigma_{+} a + \\sigma_{-} a^{\\dagger}]$$\nUsing the relations $[a^{\\dagger}a, a] = -a$, $[a^{\\dagger}a, a^{\\dagger}] = a^{\\dagger}$, $[\\sigma_{+}\\sigma_{-}, \\sigma_{+}] = \\sigma_{+}$, and $[\\sigma_{+}\\sigma_{-}, \\sigma_{-}] = -\\sigma_{-}$, we evaluate the commutators term by term:\n$$[a^{\\dagger}a, \\sigma_{+}a] = \\sigma_{+} [a^{\\dagger}a, a] = -\\sigma_{+}a$$\n$$[a^{\\dagger}a, \\sigma_{-}a^{\\dagger}] = \\sigma_{-} [a^{\\dagger}a, a^{\\dagger}] = \\sigma_{-}a^{\\dagger}$$\n$$[\\sigma_{+}\\sigma_{-}, \\sigma_{+}a] = [\\sigma_{+}\\sigma_{-}, \\sigma_{+}]a = \\sigma_{+}a$$\n$$[\\sigma_{+}\\sigma_{-}, \\sigma_{-}a^{\\dagger}] = [\\sigma_{+}\\sigma_{-}, \\sigma_{-}]a^{\\dagger} = -\\sigma_{-}a^{\\dagger}$$\nCombining these results:\n$$[K, H_{1}]/g = (-\\sigma_{+}a + \\sigma_{-}a^{\\dagger}) + (\\sigma_{+}a - \\sigma_{-}a^{\\dagger}) = 0$$\nSince $[K, H_0]=[K, H_1]=0$, $K$ commutes with all elements of the Lie algebra $\\mathfrak{L}$. The Hilbert space $\\mathcal{H}$ thus decomposes into a direct sum of eigenspaces of $K$, each of which is an invariant subspace for the dynamics.\n\nThe basis states are $\\lvert g, n \\rangle$ and $\\lvert e, n \\rangle$ for $n \\in \\{0, 1, \\dots, M\\}$. The action of $K$ is:\n$$K \\lvert g, n \\rangle = (a^{\\dagger}a + \\sigma_{+}\\sigma_{-}) \\lvert g, n \\rangle = n \\lvert g, n \\rangle$$\n$$K \\lvert e, n \\rangle = (a^{\\dagger}a + \\sigma_{+}\\sigma_{-}) \\lvert e, n \\rangle = (n+1) \\lvert e, n \\rangle$$\nThe eigenspaces $\\mathcal{H}_k$ correspond to eigenvalues $k \\in \\{0, 1, ..., M+1\\}$:\n- For $k=0$: The only state is $\\lvert g, 0 \\rangle$. This is a $1$-dimensional invariant subspace $\\mathcal{H}_0 = \\text{span}\\{\\lvert g, 0 \\rangle\\}$.\n- For $k \\in \\{1, 2, \\dots, M\\}$: The states are $\\lvert g, k \\rangle$ and $\\lvert e, k-1 \\rangle$. These form $M$ distinct $2$-dimensional invariant subspaces $\\mathcal{H}_k = \\text{span}\\{\\lvert g, k \\rangle, \\lvert e, k-1 \\rangle\\}$.\n- For $k = M+1$: The only state is $\\lvert e, M \\rangle$. This is a $1$-dimensional invariant subspace $\\mathcal{H}_{M+1} = \\text{span}\\{\\lvert e, M \\rangle\\}$.\n\nThe Hilbert space has the block structure $\\mathcal{H} = \\mathcal{H}_0 \\oplus \\left(\\bigoplus_{k=1}^{M} \\mathcal{H}_k \\right) \\oplus \\mathcal{H}_{M+1}$.\n\n2. Generation and Separation of $\\mathfrak{su}(2)$ Algebras\n\nA non-abelian algebra is generated if $[iH_0, iH_1] \\neq 0$. This commutator is $-[H_0, H_1]$.\n$$[H_0, H_1] = [\\omega a^\\dagger a + \\frac{\\Delta}{2} \\sigma_z, g(\\sigma_+ a + \\sigma_- a^\\dagger)] = g(\\Delta-\\omega)(\\sigma_+ a - \\sigma_- a^\\dagger)$$\nThis commutator is zero if and only if $\\Delta=\\omega$ (the resonant case), which would lead to an abelian Lie algebra. For the problem to be non-trivial and for the structure to depend on $M$, we analyze the generic non-resonant case where $\\Delta \\neq \\omega$.\n\nWithin a 2D subspace $\\mathcal{H}_k$ (for $k \\in \\{1, \\dots, M\\}$) with basis $\\{\\lvert g, k \\rangle, \\lvert e, k-1 \\rangle\\}$, the generators have matrix representations proportional to Pauli matrices:\n$$iH_1|_{\\mathcal{H}_k} = i g \\sqrt{k} \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}_k = i g \\sqrt{k} \\sigma_{x,k}$$\n$$iH_0|_{\\mathcal{H}_k} = i \\begin{pmatrix} \\omega k - \\Delta/2 & 0 \\\\ 0 & \\omega(k-1)+\\Delta/2 \\end{pmatrix}_k = i \\frac{\\omega(2k-1)-\\Delta}{2} \\mathbb{I}_k + i \\frac{\\omega-\\Delta}{2} \\sigma_{z,k}$$\nSince $g \\neq 0$, $k \\ge 1$, and $\\Delta \\neq \\omega$, the restricted operators $iH_1|_{\\mathcal{H}_k}$ and the non-scalar part of $iH_0|_{\\mathcal{H}_k}$ are non-zero operators proportional to $\\sigma_{x,k}$ and $\\sigma_{z,k}$ respectively. Their commutator $[i\\sigma_{x,k}, i\\sigma_{z,k}] = 2i\\sigma_{y,k}$ generates the third basis operator. Thus, the generators restricted to $\\mathcal{H}_k$ generate a copy of $\\mathfrak{su}(2)$, denoted $\\mathfrak{su}(2)_k$.\n\nTo separate these $\\mathfrak{su}(2)_k$ algebras, we must algebraically construct operators that act selectively on the different $\\mathcal{H}_k$ blocks. This requires generating operators with coefficients that depend on the block index $k$. Let's compute a nested commutator:\n$$C_1 = [iH_0, iH_1] = i g(\\Delta-\\omega)(\\sigma_- a^\\dagger - \\sigma_+ a)$$\n$$C_2 = [iH_1, C_1] = [i g(\\sigma_+ a + \\sigma_- a^\\dagger), i g(\\Delta-\\omega)(\\sigma_- a^\\dagger - \\sigma_+ a)]$$\n$$C_2 = -g^2(\\Delta-\\omega) [\\sigma_+ a + \\sigma_- a^\\dagger, \\sigma_- a^\\dagger - \\sigma_+ a] = 2g^2(\\Delta-\\omega) [\\sigma_+ a, \\sigma_- a^\\dagger]$$\nThe key commutator is $[\\sigma_+ a, \\sigma_- a^\\dagger] = \\sigma_+\\sigma_- + \\sigma_z a^\\dagger a$. Let's call this operator $Q'$. Its action on the basis of $\\mathcal{H}_k$ is:\n$$Q' \\lvert g, k \\rangle = (0 + \\sigma_z k) \\lvert g, k \\rangle = -k \\lvert g, k \\rangle$$\n$$Q' \\lvert e, k-1 \\rangle = (\\mathbb{I} + \\sigma_z (k-1)) \\lvert e, k-1 \\rangle = (\\mathbb{I} + (k-1)) \\lvert e, k-1 \\rangle = k \\lvert e, k-1 \\rangle$$\nThus, the restriction is $Q'|_{\\mathcal{H}_k} = -k \\sigma_{z,k}$. The generated operator $C_2$ is proportional to $\\sum_{k=1}^M k\\, i\\sigma_{z,k}$.\n\nThe Lie algebra $\\mathfrak{L}$ thus contains operators proportional to $Z_0 = \\sum_{k=1}^M i\\sigma_{z,k}$ (from $iH_0$) and $Z_1 = \\sum_{k=1}^M k\\, i\\sigma_{z,k}$ (from $C_2$). By repeated commutation with $iH_1$ (or an operator proportional to $\\sum_k \\sqrt{k}\\, i\\sigma_{x,k}$), we can generate operators of the form $Z_p = \\sum_{k=1}^M k^p i\\sigma_{z,k}$ for $p=0, 1, \\dots, M-1$. These $M$ operators are linearly independent.\nWith a set of operators $\\{Z_p\\}_{p=0}^{M-1}$, we can form linear combinations $\\sum_p c_p Z_p = \\sum_k (\\sum_p c_p k^p) i\\sigma_{z,k}$. By choosing coefficients $\\{c_p\\}$ that form Lagrange interpolating polynomials, we can construct operators that are non-zero only in a single block $\\mathcal{H}_j$, i.e., we can construct each $i\\sigma_{z,j}$ individually. Commuting $i\\sigma_{z,j}$ with $iH_1$ then generates $i\\sigma_{y,j}$, and another commutation generates $i\\sigma_{x,j}$.\nThis demonstrates that $\\mathfrak{L}$ contains the entire semisimple algebra $\\bigoplus_{j=1}^M \\mathfrak{su}(2)_j$, which has dimension $3M$.\n\n3. Structure and Dimension of $\\mathfrak{L}$\n\nThe Lie algebra $\\mathfrak{L}$ is the direct sum of its semisimple part and its center. We have identified the semisimple part as $\\bigoplus_{j=1}^M \\mathfrak{su}(2)_j$. The remaining part of $\\mathfrak{L}$ is generated by the component of $iH_0$ that commutes with this semisimple algebra.\nThe full operator $iH_0$ is:\n$$iH_0 = \\sum_{k=1}^M \\left( i \\frac{\\omega(2k-1)-\\Delta}{2} \\mathbb{I}_k + i \\frac{\\omega-\\Delta}{2} \\sigma_{z,k} \\right) \\oplus \\left(-\\frac{i\\Delta}{2}\\mathbb{I}_0\\right) \\oplus \\left(i(\\omega M + \\frac{\\Delta}{2})\\mathbb{I}_{M+1}\\right)$$\nThe term proportional to $\\sum \\sigma_{z,k}$ is part of the semisimple algebra. The remaining operator is a linear combination of identity operators on each invariant subspace and is therefore in the center of the algebra. Since this operator is linearly independent from the semisimple part, it spans a one-dimensional abelian ideal, $\\mathfrak{u}(1)$. No further independent central elements are generated.\n\nTherefore, the structure of the Lie algebra is $\\mathfrak{L} \\cong \\left(\\bigoplus_{j=1}^M \\mathfrak{su}(2)_j\\right) \\oplus \\mathfrak{u}(1)$.\nThe real dimension of $\\mathfrak{L}$ is the sum of the dimensions of its components:\n$$\\text{dim}(\\mathfrak{L}) = M \\cdot \\text{dim}(\\mathfrak{su}(2)) + \\text{dim}(\\mathfrak{u}(1)) = 3M + 1$$\nThe connected component of the identity of the group of reachable unitary transformations is $\\exp(\\mathfrak{L})$, which is isomorphic to $\\left(SU(2)\\right)^M \\times U(1)$.", "answer": "$$\n\\boxed{3M+1}\n$$", "id": "2791994"}]}