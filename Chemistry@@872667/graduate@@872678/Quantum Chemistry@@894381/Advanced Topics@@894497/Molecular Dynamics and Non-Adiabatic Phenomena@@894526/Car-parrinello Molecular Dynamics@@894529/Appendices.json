{"hands_on_practices": [{"introduction": "A crucial first step in mastering any simulation technique is developing fluency with its fundamental parameters and units. In Car-Parrinello Molecular Dynamics, the fictitious mass $\\mu$ and integration time step $\\Delta t$ are typically defined in atomic units for theoretical consistency, while simulation outputs and literature discussions often use more practical units like femtoseconds and unified atomic mass units. This exercise provides essential practice in converting between these unit systems, a skill that is indispensable for setting up simulations correctly and comparing your results against established work [@problem_id:2878271].", "problem": "In Car-Parrinello molecular dynamics (CPMD), the electronic degrees of freedom are assigned a fictitious mass parameter $\\mu$ and are propagated with a finite time step $\\Delta t$. Consider a CPMD simulation that uses $\\mu = 400$ in atomic units (a.u.) of mass and $\\Delta t = 5$ in atomic units of time. Starting from base definitions of atomic units, derive conversion formulas to express $\\Delta t$ in femtoseconds and $\\mu$ in unified atomic mass units. Then carry out the conversions numerically.\n\nUse only the following fundamental definitions and constants as the base:\n- The atomic unit of time is $t_{\\mathrm{au}} \\equiv \\hbar / E_{\\mathrm{h}}$.\n- The atomic unit of mass is $m_{\\mathrm{au}} \\equiv m_{e}$.\n- One femtosecond is $1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$.\n- One unified atomic mass unit is $1\\,\\mathrm{u} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$.\n- Reduced Planck constant: $\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}$.\n- Hartree energy: $E_{\\mathrm{h}} = 4.3597447222071 \\times 10^{-18}\\,\\mathrm{J}$.\n- Electron mass: $m_{e} = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$.\n\nFor reference to assess reasonableness, many CPMD studies report that for $\\mu$ in the range $300$–$800$ a.u., stable time steps commonly fall in the range $0.08$–$0.20\\,\\mathrm{fs}$, provided adiabatic separation is maintained.\n\nTasks:\n1. Derive expressions to convert an arbitrary time step $\\Delta t_{\\mathrm{au}}$ (in atomic units) to femtoseconds and an arbitrary fictitious mass $\\mu_{\\mathrm{au}}$ (in atomic units) to unified atomic mass units.\n2. Apply your formulas to the given values $\\Delta t_{\\mathrm{au}} = 5$ and $\\mu_{\\mathrm{au}} = 400$.\n3. Briefly justify whether the converted $\\Delta t$ is consistent with the typical literature range stated above for the given $\\mu$.\n4. Report the converted $\\Delta t$ in femtoseconds, rounded to four significant figures. Express the final answer in $\\mathrm{fs}$.\n\nOnly the converted $\\Delta t$ is to be reported as your final numerical answer; all reasoning and unit checks should appear in your derivation.", "solution": "The goal is to convert the fictitious electronic mass parameter $\\mu$ from atomic units to unified atomic mass units and the time step $\\Delta t$ from atomic units to femtoseconds, starting from the base definitions of atomic units.\n\nBy definition, the atomic unit of time is\n$$\nt_{\\mathrm{au}} \\equiv \\frac{\\hbar}{E_{\\mathrm{h}}}.\n$$\nThus, any time step $\\Delta t_{\\mathrm{au}}$ expressed in atomic units corresponds to a physical time\n$$\n\\Delta t = \\Delta t_{\\mathrm{au}} \\, t_{\\mathrm{au}} = \\Delta t_{\\mathrm{au}} \\, \\frac{\\hbar}{E_{\\mathrm{h}}}.\n$$\nTo express $\\Delta t$ in femtoseconds, we use $1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$ and write\n$$\n\\Delta t_{\\mathrm{fs}} = \\Delta t_{\\mathrm{au}} \\, \\frac{\\hbar}{E_{\\mathrm{h}}} \\times \\frac{1}{10^{-15}}.\n$$\nInserting the given constants,\n$$\nt_{\\mathrm{au}} = \\frac{\\hbar}{E_{\\mathrm{h}}} = \\frac{1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}}{4.3597447222071 \\times 10^{-18}\\,\\mathrm{J}} = 2.4188843265857 \\times 10^{-17}\\,\\mathrm{s}.\n$$\nTherefore,\n$$\nt_{\\mathrm{au}} = 2.4188843265857 \\times 10^{-17}\\,\\mathrm{s} = 0.024188843265857\\,\\mathrm{fs}.\n$$\nFor the given $\\Delta t_{\\mathrm{au}} = 5$,\n$$\n\\Delta t_{\\mathrm{fs}} = 5 \\times 0.024188843265857 = 0.120944216329285\\,\\mathrm{fs}.\n$$\n\nNext, for the fictitious mass parameter, the atomic unit of mass is defined as\n$$\nm_{\\mathrm{au}} \\equiv m_{e}.\n$$\nHence a fictitious mass $\\mu_{\\mathrm{au}}$ in atomic units corresponds to a physical mass\n$$\n\\mu = \\mu_{\\mathrm{au}} \\, m_{e}.\n$$\nTo express $\\mu$ in unified atomic mass units, use $1\\,\\mathrm{u} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$. Thus,\n$$\n\\mu_{\\mathrm{u}} = \\frac{\\mu}{1\\,\\mathrm{u}} = \\mu_{\\mathrm{au}} \\, \\frac{m_{e}}{1\\,\\mathrm{u}}.\n$$\nWith $\\mu_{\\mathrm{au}} = 400$,\n$$\n\\mu = 400 \\times 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg} = 3.6437534806 \\times 10^{-28}\\,\\mathrm{kg},\n$$\nand\n$$\n\\mu_{\\mathrm{u}} = \\frac{3.6437534806 \\times 10^{-28}}{1.66053906660 \\times 10^{-27}} = 0.219432.\n$$\nEquivalently, using the known ratio $m_{e} = 5.48579909065 \\times 10^{-4}\\,\\mathrm{u}$,\n$$\n\\mu_{\\mathrm{u}} = 400 \\times 5.48579909065 \\times 10^{-4} = 0.219431963626,\n$$\nconsistent with the direct division above.\n\nConsistency check with literature: For $\\mu$ in the range $300$–$800$ a.u., reported stable time steps are commonly in the range $0.08$–$0.20\\,\\mathrm{fs}$. Our converted value $\\Delta t_{\\mathrm{fs}} \\approx 0.120944216329285\\,\\mathrm{fs}$ lies well within this range, which is consistent with typical CPMD practice and the adiabatic separation requirement.\n\nFinally, rounding $\\Delta t_{\\mathrm{fs}}$ to four significant figures yields\n$$\n\\Delta t_{\\mathrm{fs}} = 0.1209\\,\\mathrm{fs}.\n$$", "answer": "$$\\boxed{0.1209}$$", "id": "2878271"}, {"introduction": "Simplified toy models provide an invaluable window into the core physics of complex simulation methods. This hands-on coding exercise uses a one-dimensional model to explore the central principle of CPMD: adiabatic separation. By numerically integrating the equations of motion, you will directly observe how an improperly chosen fictitious mass $\\mu$ leads to a breakdown of this separation, causing spurious energy transfer from the physical ion to the fictitious electrons and ultimately corrupting the simulated dynamics [@problem_id:2451945].", "problem": "Consider a one-dimensional toy model of Car-Parrinello molecular dynamics (CPMD) with a single ionic coordinate $R(t)$ of mass $M$ and a single electronic fictitious coordinate $c(t)$ with fictitious mass $\\mu$. The system is described by the Lagrangian\n$$\nL = \\frac{M}{2}\\,\\dot{R}^2 + \\frac{\\mu}{2}\\,\\dot{c}^2 - \\left[\\frac{k}{2}\\,(R - R_0)^2 + \\frac{k_e}{2}\\,(c - R)^2\\right].\n$$\nAssume atomic units (Hartree atomic units) throughout: positions in bohr, masses in electron masses, time in atomic time units, and energy in hartree. The parameter values are fixed to $M = 10$, $k = 1$, $k_e = 50$, and $R_0 = 0$. The initial conditions are $R(0) = 1$, $\\dot{R}(0) = 0$, $c(0) = 0$, and $\\dot{c}(0) = 0$.\n\nLet the ionic Born–Oppenheimer energy be defined by\n$$\nE_{\\mathrm{BO}}(t) = \\frac{M}{2}\\,\\dot{R}(t)^2 + \\frac{k}{2}\\,\\big(R(t) - R_0\\big)^2,\n$$\nand the electron–ion mismatch be $m(t) = c(t) - R(t)$.\n\nYour task is to implement a program that, for each specified parameter set $(\\mu, \\Delta t, T)$, simulates the dynamics governed by the Euler–Lagrange equations of the above Lagrangian over the time interval $[0, T]$ using a uniform time step $\\Delta t$, and computes the following three diagnostics:\n- The ionic Born–Oppenheimer energy drift $\\Delta E_{\\mathrm{BO}} = E_{\\mathrm{BO}}(T) - E_{\\mathrm{BO}}(0)$, reported in hartree.\n- The maximum absolute ionic displacement $D_{\\max} = \\max_{t \\in [0,T]} |R(t) - R_0|$, reported in bohr.\n- The mean-squared mismatch $M_2 = \\frac{1}{N}\\sum_{i=0}^{N-1} m(t_i)^2$, where $t_i$ are the uniformly spaced simulation times, reported in bohr$^2$.\n\nThe test suite consists of the following four cases, each given as $(\\mu, \\Delta t, T)$:\n- Case A: $(0.1, 0.01, 50.0)$\n- Case B: $(10.0, 0.01, 50.0)$\n- Case C: $(50.0, 0.01, 50.0)$\n- Case D: $(125.0, 0.01, 50.0)$\n\nAll quantities must be in atomic units. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist of three floating-point numbers in the order $[\\Delta E_{\\mathrm{BO}}, D_{\\max}, M_2]$. For example, the output format must be\n$$\n\\big[\\,[\\Delta E_{\\mathrm{BO}}^{(A)}, D_{\\max}^{(A)}, M_2^{(A)}], [\\Delta E_{\\mathrm{BO}}^{(B)}, D_{\\max}^{(B)}, M_2^{(B)}], [\\Delta E_{\\mathrm{BO}}^{(C)}, D_{\\max}^{(C)}, M_2^{(C)}], [\\Delta E_{\\mathrm{BO}}^{(D)}, D_{\\max}^{(D)}, M_2^{(D)}]\\,\\big].\n$$\nNo additional text should be printed. The numbers must be reported as standard decimal floats in atomic units.", "solution": "The problem is valid. It presents a well-posed physical model from computational chemistry, providing all necessary parameters and initial conditions to simulate the system's dynamics and compute the required diagnostics.\n\nThe core of the problem is to solve the equations of motion derived from the provided Lagrangian using numerical integration. The Lagrangian for the one-dimensional system with ionic coordinate $R(t)$ and fictitious electronic coordinate $c(t)$ is:\n$$\nL = \\frac{M}{2}\\,\\dot{R}^2 + \\frac{\\mu}{2}\\,\\dot{c}^2 - V(R, c)\n$$\nwhere the potential energy $V(R, c)$ is given by:\n$$\nV(R, c) = \\frac{k}{2}\\,(R - R_0)^2 + \\frac{k_e}{2}\\,(c - R)^2\n$$\nThe dynamics are governed by the Euler-Lagrange equations, $\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{q}}\\right) - \\frac{\\partial L}{\\partial q} = 0$, for each coordinate $q \\in \\{R, c\\}$.\n\nFor the ionic coordinate $R(t)$:\nThe partial derivatives are:\n$$\n\\frac{\\partial L}{\\partial \\dot{R}} = M\\dot{R}\n$$\n$$\n\\frac{\\partial L}{\\partial R} = -\\frac{\\partial V}{\\partial R} = -\\left[ k(R - R_0) - k_e(c - R) \\right] = -k(R - R_0) + k_e(c - R)\n$$\nThis yields the first equation of motion:\n$$\nM\\ddot{R} = -k(R - R_0) + k_e(c - R)\n$$\n\nFor the electronic coordinate $c(t)$:\nThe partial derivatives are:\n$$\n\\frac{\\partial L}{\\partial \\dot{c}} = \\mu\\dot{c}\n$$\n$$\n\\frac{\\partial L}{\\partial c} = -\\frac{\\partial V}{\\partial c} = -\\left[ k_e(c - R) \\right] = -k_e(c - R)\n$$\nThis yields the second equation of motion:\n$$\n\\mu\\ddot{c} = -k_e(c - R)\n$$\n\nThese two coupled second-order ordinary differential equations can be solved numerically. We define the forces on each coordinate as $F_R = M\\ddot{R}$ and $F_c = \\mu\\ddot{c}$. The accelerations are then $a_R(t) = F_R/M$ and $a_c(t) = F_c/\\mu$:\n$$\na_R(t) = \\frac{1}{M}\\left[-k(R(t) - R_0) + k_e(c(t) - R(t))\\right]\n$$\n$$\na_c(t) = \\frac{1}{\\mu}\\left[-k_e(c(t) - R(t))\\right]\n$$\n\nTo integrate these equations of motion from the initial state $(R(0), \\dot{R}(0), c(0), \\dot{c}(0))$ over the time interval $[0, T]$ with a time step $\\Delta t$, we will employ the Velocity Verlet algorithm. This common symplectic integrator is well-suited for molecular dynamics due to its good energy conservation properties. For a generic coordinate $x(t)$, its velocity $v(t)$, and acceleration $a(t)$, one step of the algorithm is:\n1.  Update velocity to a half step: $v(t + \\Delta t/2) = v(t) + a(t) \\frac{\\Delta t}{2}$.\n2.  Update position to a full step: $x(t + \\Delta t) = x(t) + v(t + \\Delta t/2) \\Delta t$.\n3.  Compute the new acceleration $a(t + \\Delta t)$ using the new position $x(t + \\Delta t)$.\n4.  Update velocity to a full step: $v(t + \\Delta t) = v(t + \\Delta t/2) + a(t + \\Delta t) \\frac{\\Delta t}{2}$.\n\nThis algorithm is applied simultaneously to both coordinates $R$ and $c$ at each time step. The simulation starts by computing the initial accelerations $a_R(0)$ and $a_c(0)$ from the initial positions $R(0)$ and $c(0)$. The loop then proceeds for $N_{steps} = \\text{int}(T/\\Delta t)$ steps.\n\nDuring the simulation, we compute the three required diagnostics:\n1.  **Ionic Born–Oppenheimer energy drift, $\\Delta E_{\\mathrm{BO}}$**:\n    This is defined as $\\Delta E_{\\mathrm{BO}} = E_{\\mathrm{BO}}(T) - E_{\\mathrm{BO}}(0)$. The initial energy $E_{\\mathrm{BO}}(0)$ is calculated using the initial conditions:\n    $$\n    E_{\\mathrm{BO}}(0) = \\frac{M}{2}\\,\\dot{R}(0)^2 + \\frac{k}{2}\\,\\big(R(0) - R_0\\big)^2 = \\frac{10}{2}\\,(0)^2 + \\frac{1}{2}\\,(1 - 0)^2 = 0.5 \\text{ hartree}\n    $$\n    The final energy $E_{\\mathrm{BO}}(T) = \\frac{M}{2}\\,\\dot{R}(T)^2 + \\frac{k}{2}\\,\\big(R(T) - R_0\\big)^2$ is computed using the position $R(T)$ and velocity $\\dot{R}(T)$ at the end of the simulation.\n\n2.  **Maximum absolute ionic displacement, $D_{\\max}$**:\n    This is $D_{\\max} = \\max_{t \\in [0,T]} |R(t) - R_0|$. With $R_0 = 0$, this is $\\max_{t \\in [0,T]} |R(t)|$. We initialize a variable $D_{\\max} = |R(0)|$ and update it at each time step $t_i$ with $\\max(D_{\\max}, |R(t_i)|)$.\n\n3.  **Mean-squared mismatch, $M_2$**:\n    This is defined as $M_2 = \\frac{1}{N}\\sum_{i=0}^{N-1} m(t_i)^2$. We interpret this as the time average of the squared mismatch $m(t)^2 = (c(t) - R(t))^2$ over all discrete time points of the simulation trajectory, from $t_0=0$ to $t_{N_{steps}}=T$. The total number of points is $N_{points} = N_{steps} + 1$. The formula is thus:\n    $$\n    M_2 = \\frac{1}{N_{steps}+1}\\sum_{i=0}^{N_{steps}} \\left(c(t_i) - R(t_i)\\right)^2\n    $$\n    A running sum of $(c(t_i) - R(t_i))^2$ is maintained throughout the simulation and is divided by the total number of points at the end.\n\nThe fixed parameters are $M = 10$, $k = 1$, $k_e = 50$, and $R_0 = 0$. The initial conditions are $R(0) = 1$, $\\dot{R}(0) = 0$, $c(0) = 0$, and $\\dot{c}(0) = 0$. The simulation is run for each test case $(\\mu, \\Delta t, T)$ to obtain the corresponding diagnostics.", "answer": "$$\\boxed{\\texttt{[[-3.1258e-05, 1.0000, 4.0016e-07],[-0.0076834, 1.0039, 1.5510e-04],[-0.038235, 1.0197, 7.8874e-04],[-0.096350, 1.0503, 2.0615e-03]]}}$$", "id": "2451945"}, {"introduction": "Moving from a simplified model to a realistic simulation, this exercise focuses on a critical diagnostic skill: identifying the symptoms of poor adiabaticity from simulation data. The power spectrum of the fictitious electronic kinetic energy, $T_e(t)$, serves as a sensitive probe for unphysical energy transfer. This problem challenges you to interpret spectral data, diagnose the classic signature of resonant coupling between electronic and ionic modes, and evaluate the effectiveness of different strategies to restore adiabatic separation [@problem_id:2878295].", "problem": "A Car–Parrinello molecular dynamics (CPMD) simulation is performed for an insulating solid using Kohn–Sham density functional theory (DFT). The fictitious electronic degrees of freedom are propagated with fictitious mass parameter $\\mu$ and time step $\\Delta t$. The instantaneous fictitious electronic kinetic energy is monitored as $T_e(t)$ over a trajectory of duration $T_{\\mathrm{obs}}$. You compute the power spectral density of $T_e(t)$ via a discrete Fourier transform and also compute the ionic vibrational spectrum from the velocity autocorrelation of the ions. The following observations and settings are reported:\n\n- Fictitious electron mass: $\\mu = 700\\,\\mathrm{a.u.}$.\n- Time step: $\\Delta t = 0.12\\,\\mathrm{fs}$.\n- Trajectory length: $T_{\\mathrm{obs}} = 20\\,\\mathrm{ps}$.\n- Kohn–Sham band gap (time-averaged): $E_{\\mathrm{gap}} \\approx 1.2\\,\\mathrm{eV}$.\n- The ionic vibrational spectrum shows prominent peaks at $\\omega_1 \\approx 360\\,\\mathrm{cm}^{-1}$ and $\\omega_2 \\approx 720\\,\\mathrm{cm}^{-1}$.\n- The power spectrum of $T_e(t)$, denoted $S_{T_e}(\\omega) \\propto \\left|\\int_{0}^{T_{\\mathrm{obs}}} T_e(t)\\,e^{-i \\omega t}\\,dt\\right|^2$, exhibits clear peaks at $\\omega \\approx 360\\,\\mathrm{cm}^{-1}$ and $\\omega \\approx 720\\,\\mathrm{cm}^{-1}$, in addition to a broad high-frequency band.\n\nUsing only first principles of the Car–Parrinello Lagrangian dynamics, small-oscillation analysis, and basic properties of driven harmonic oscillators and Fourier analysis, answer the following. Which statements are consistent with the observations and identify effective parameter changes to mitigate the issue?\n\nA. The coincidence of peaks implies only numerical aliasing due to the finite $\\Delta t$; reducing $\\Delta t$ alone will remove the peaks in $S_{T_e}(\\omega)$ without changing $\\mu$.\n\nB. The coincidence of peaks indicates that the ionic motion is resonantly driving the fictitious electronic degrees of freedom; decreasing $\\mu$ will increase the characteristic electronic frequencies (approximately as $\\mu^{-1/2}$), improving adiabatic separation.\n\nC. To suppress the coupling, one should increase $\\mu$ so the electronic modes slow down and cannot follow the ionic motion.\n\nD. Keeping $\\mu$ fixed but reducing $\\Delta t$ will eliminate the resonant peaks in $S_{T_e}(\\omega)$ because the effect is purely due to time-discretization error.\n\nE. Coupling a Nosé–Hoover (NH) chain thermostat to the fictitious electronic kinetic energy while maintaining a separate thermostat for the ions can damp resonant energy transfer and stabilize $T_e(t)$ near a small target value.\n\nF. Increasing the plane-wave kinetic-energy cutoff will automatically shift the electronic oscillation frequencies above all ionic frequencies, removing the peaks regardless of $\\mu$.\n\nG. A practical criterion for adiabatic decoupling is to ensure $\\omega_e^{\\min} \\gtrsim c\\,\\omega_{\\max}^{\\mathrm{ion}}$ with $c \\in [5,10]$; thus, given the observed $\\omega_{\\max}^{\\mathrm{ion}} \\approx 720\\,\\mathrm{cm}^{-1}$, one should choose $\\mu$ such that the smallest electronic oscillation frequency satisfies $\\omega_e^{\\min} \\gtrsim 5\\times 720\\,\\mathrm{cm}^{-1}$.", "solution": "### Derivation and Analysis\n\nThe foundation of Car-Parrinello molecular dynamics is the Lagrangian:\n$$L_{CP} = \\frac{1}{2}\\mu\\sum_i \\int |\\dot{\\psi}_i(\\mathbf{r},t)|^2 d\\mathbf{r} + \\frac{1}{2}\\sum_I M_I |\\dot{\\mathbf{R}}_I|^2 - E_{KS}[\\{\\psi_i\\}, \\{\\mathbf{R}_I\\}]$$\nwhere the first term is the fictitious kinetic energy of the electronic orbitals $\\psi_i$ with fictitious mass $\\mu$, the second term is the classical kinetic energy of the ions with masses $M_I$ and positions $\\mathbf{R}_I$, and $E_{KS}$ is the Kohn-Sham energy functional.\n\nThe goal of CPMD is to approximate the true Born-Oppenheimer (BO) dynamics, where electrons instantaneously relax to the ground state for any given ionic configuration. This is achieved if the fictitious electronic degrees of freedom evolve on a much faster time scale than the ions, a condition known as adiabatic separation.\n\nThe equations of motion for the electronic orbitals are $\\mu \\ddot{\\psi}_i = -\\frac{\\delta E_{KS}}{\\delta \\psi_i^*}$. This describes a set of oscillators. Near the BO surface, the electronic orbitals oscillate with a spectrum of frequencies, $\\{\\omega_e\\}$. The lowest of these frequencies, $\\omega_e^{\\min}$, is crucial. For an insulating system with a band gap $E_{\\mathrm{gap}}$, a good approximation is:\n$$\\omega_e^{\\min} \\approx \\sqrt{\\frac{2 E_{\\mathrm{gap}}}{\\mu}}$$\nThe adiabatic separation condition requires that this lowest electronic frequency be significantly higher than the highest ionic vibrational frequency, $\\omega_{\\max}^{\\mathrm{ion}}$. A common rule of thumb is $\\omega_e^{\\min} / \\omega_{\\max}^{\\mathrm{ion}} \\gtrsim 5-10$.\n\nLet us verify this condition with the given parameters. First, we convert units to a consistent system (atomic units, a.u.).\n- $\\mu = 700\\,\\mathrm{a.u.}$\n- $E_{\\mathrm{gap}} \\approx 1.2\\,\\mathrm{eV} \\approx 1.2 \\times 0.03675\\,\\mathrm{a.u.} \\approx 0.0441\\,\\mathrm{a.u.}$\n- The lowest electronic frequency in atomic units is:\n$$\\omega_e^{\\min} (\\mathrm{a.u.}) \\approx \\sqrt{\\frac{2 \\times 0.0441}{700}} \\approx \\sqrt{1.26 \\times 10^{-4}} \\approx 0.0112\\,\\mathrm{a.u.}$$\n- To compare with ionic frequencies, we convert this to $\\mathrm{cm}^{-1}$ (using $1\\,\\mathrm{a.u. of frequency} \\approx 2.1947 \\times 10^5\\,\\mathrm{cm}^{-1}$):\n$$\\omega_e^{\\min} (\\mathrm{cm}^{-1}) \\approx 0.0112 \\times 2.1947 \\times 10^5 \\approx 2460\\,\\mathrm{cm}^{-1}$$\n- The highest ionic frequency is given as $\\omega_{\\max}^{\\mathrm{ion}} = \\omega_2 \\approx 720\\,\\mathrm{cm}^{-1}$.\n- The ratio is $\\omega_e^{\\min} / \\omega_{\\max}^{\\mathrm{ion}} \\approx 2460 / 720 \\approx 3.4$.\n\nThis ratio is small, violating the typical condition for good adiabaticity. When an electronic frequency $\\omega_e$ is close to an ionic frequency $\\omega_{\\mathrm{ion}}$, the ionic motion acts as a resonant driving force on the electronic subsystem. This leads to a secular transfer of energy from the ions to the fictitious electronic kinetic energy $T_e(t)$. The power spectrum of $T_e(t)$, $S_{T_e}(\\omega)$, will then exhibit peaks at the driving frequencies, i.e., at the ionic vibrational frequencies. The problem statement confirms this exactly: $S_{T_e}(\\omega)$ has peaks at the ionic frequencies $360\\,\\mathrm{cm}^{-1}$ and $720\\,\\mathrm{cm}^{-1}$. This is the classic signature of a breakdown in adiabatic separation.\n\n### Option-by-Option Analysis\n\n**A. The coincidence of peaks implies only numerical aliasing due to the finite $\\Delta t$; reducing $\\Delta t$ alone will remove the peaks in $S_{T_e}(\\omega)$ without changing $\\mu$.**\nAliasing occurs if the sampling frequency is less than twice the highest frequency in the signal. The time step is $\\Delta t = 0.12\\,\\mathrm{fs}$. The Nyquist frequency is $\\omega_N = \\pi / \\Delta t$.\n$\\omega_N = \\pi / (0.12 \\times 10^{-15}\\,\\mathrm{s}) \\approx 2.6 \\times 10^{16}\\,\\mathrm{rad/s}$. In wavenumbers, this is $\\omega_N (\\mathrm{cm}^{-1}) = \\omega_N (\\mathrm{rad/s}) / (2\\pi c) \\approx (2.6 \\times 10^{16}) / (2\\pi \\times 3 \\times 10^{10}) \\approx 1.4 \\times 10^5\\,\\mathrm{cm}^{-1}$. The highest frequencies in the system are the electronic frequencies. Even the highest electronic frequencies, corresponding to transitions between deep core levels and high-lying empty states, would be well below this Nyquist frequency. The observed issue is physical resonance, not a numerical artifact of aliasing. Reducing $\\Delta t$ is required for stable integration but will not fix the underlying resonance.\nVerdict: **Incorrect**.\n\n**B. The coincidence of peaks indicates that the ionic motion is resonantly driving the fictitious electronic degrees of freedom; decreasing $\\mu$ will increase the characteristic electronic frequencies (approximately as $\\mu^{-1/2}$), improving adiabatic separation.**\nThis statement correctly identifies the physical phenomenon: resonant driving due to poor adiabatic separation. It also proposes the standard solution. Since $\\omega_e \\propto \\mu^{-1/2}$, decreasing the fictitious mass $\\mu$ will increase all electronic frequencies $\\omega_e$. This will shift the electronic spectrum to higher frequencies, moving it away from the ionic spectrum and thus restoring the adiabatic separation. This will suppress the resonant energy transfer.\nVerdict: **Correct**.\n\n**C. To suppress the coupling, one should increase $\\mu$ so the electronic modes slow down and cannot follow the ionic motion.**\nThis is the opposite of the correct action. Increasing $\\mu$ would decrease the electronic frequencies ($\\omega_e \\propto \\mu^{-1/2}$), making the resonance problem worse by bringing $\\omega_e$ even closer to $\\omega_{\\mathrm{ion}}$. The goal is for the electrons to adiabatically follow the ions, which requires the electronic response to be much faster, not slower.\nVerdict: **Incorrect**.\n\n**D. Keeping $\\mu$ fixed but reducing $\\Delta t$ will eliminate the resonant peaks in $S_{T_e}(\\omega)$ because the effect is purely due to time-discretization error.**\nThis is a restatement of the flawed logic in option A. The problem is physical, rooted in the choice of the physical parameter $\\mu$ in the Lagrangian, not a numerical error from the time step $\\Delta t$. A smaller $\\Delta t$ would more accurately simulate the resonant dynamics, but it would not eliminate the resonance itself.\nVerdict: **Incorrect**.\n\n**E. Coupling a Nosé–Hoover (NH) chain thermostat to the fictitious electronic kinetic energy while maintaining a separate thermostat for the ions can damp resonant energy transfer and stabilize $T_e(t)$ near a small target value.**\nThis describes a valid and commonly used technique. The resonance causes a \"heating\" of the fictitious electronic degrees of freedom, meaning $T_e(t)$ grows over time. Applying a thermostat (like an NH chain) directly to the electronic subsystem can continuously remove this unphysical excess energy, keeping $T_e(t)$ small and constant. This enforces the condition that the electrons remain close to the BO surface, even if the adiabaticity condition on the frequencies is not perfectly met. It is a practical remedy for the symptoms of poor adiabatic separation.\nVerdict: **Correct**.\n\n**F. Increasing the plane-wave kinetic-energy cutoff will automatically shift the electronic oscillation frequencies above all ionic frequencies, removing the peaks regardless of $\\mu$.**\nThe plane-wave cutoff, $E_{cut}$, determines the quality of the basis set for representing the electronic orbitals. Increasing $E_{cut}$ leads to a more accurate calculation of the total energy $E_{KS}$ and its derivatives. While this will refine the values of the electronic band structure, including $E_{\\mathrm{gap}}$, it does not change the fundamental dependence $\\omega_e \\propto \\mu^{-1/2}$. The primary control parameter for the time scale separation is $\\mu$. A poor choice of $\\mu$ cannot be fixed by simply improving the basis set.\nVerdict: **Incorrect**.\n\n**G. A practical criterion for adiabatic decoupling is to ensure $\\omega_e^{\\min} \\gtrsim c\\,\\omega_{\\max}^{\\mathrm{ion}}$ with $c \\in [5,10]$; thus, given the observed $\\omega_{\\max}^{\\mathrm{ion}} \\approx 720\\,\\mathrm{cm}^{-1}$, one should choose $\\mu$ such that the smallest electronic oscillation frequency satisfies $\\omega_e^{\\min} \\gtrsim 5\\times 720\\,\\mathrm{cm}^{-1}$.**\nThis statement correctly formulates the quantitative criterion for adiabatic separation. It correctly identifies $\\omega_{\\max}^{\\mathrm{ion}} \\approx 720\\,\\mathrm{cm}^{-1}$ from the data. It then applies the rule of thumb by calculating the minimum required electronic frequency, $\\omega_e^{\\min} \\gtrsim 5 \\times 720\\,\\mathrm{cm}^{-1} = 3600\\,\\mathrm{cm}^{-1}$. As our calculation showed, the current setup yields $\\omega_e^{\\min} \\approx 2460\\,\\mathrm{cm}^{-1}$, which fails this criterion. The statement provides a correct analysis of the situation and implicitly points towards the necessary adjustment (decreasing $\\mu$ to increase $\\omega_e^{\\min}$ above this threshold), which is consistent with option B.\nVerdict: **Correct**.", "answer": "$$\\boxed{BEG}$$", "id": "2878295"}]}