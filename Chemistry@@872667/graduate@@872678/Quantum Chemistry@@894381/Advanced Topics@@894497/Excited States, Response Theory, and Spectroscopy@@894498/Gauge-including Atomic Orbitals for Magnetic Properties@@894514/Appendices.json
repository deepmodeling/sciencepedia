{"hands_on_practices": [{"introduction": "A fundamental challenge in calculating magnetic properties is the gauge-origin problem, where results can depend on an arbitrary choice of coordinate system. This exercise explores the most common solution: the use of Gauge-Including Atomic Orbitals (GIAOs), also known as London orbitals. By analyzing how GIAOs work, you will understand how they ensure gauge-invariance and why this, in turn, influences the requirements for the basis set itself [@problem_id:2916068].", "problem": "A uniform static magnetic field $\\mathbf{B}$ can be represented by many vector potentials $\\mathbf{A}(\\mathbf{r})$ related by gauge transformations. In nonrelativistic electronic structure theory with minimal coupling, the electronic Hamiltonian uses $\\mathbf{p}\\to \\mathbf{p}-q\\,\\mathbf{A}(\\mathbf{r})$, where $q$ is the electron charge in atomic units and $\\mathbf{p}$ is the canonical momentum operator. For a uniform $\\mathbf{B}$, a common choice is the origin-centered potential $\\mathbf{A}_{\\mathbf{R}_0}(\\mathbf{r})=\\tfrac{1}{2}\\,\\mathbf{B}\\times\\left(\\mathbf{r}-\\mathbf{R}_0\\right)$, which depends on the gauge origin $\\mathbf{R}_0$. Exact observables (including Nuclear Magnetic Resonance (NMR) shieldings) are gauge-origin independent, since a gauge change $\\mathbf{A}\\mapsto \\mathbf{A}+\\nabla \\chi(\\mathbf{r})$ can be compensated by a phase transformation of the exact wave function $\\psi(\\mathbf{r})\\mapsto e^{i q \\chi(\\mathbf{r})}\\psi(\\mathbf{r})$. In a finite, real Gaussian basis without field-dependent phases, however, the variational space does not transform covariantly under $\\mathbf{A}\\mapsto \\mathbf{A}+\\nabla \\chi$, and computed magnetic response properties can spuriously depend on $\\mathbf{R}_0$. A known remedy is to use London orbitals, also called Gauge-Including Atomic Orbitals (GIAOs), which attach a field-dependent phase to each atomic basis function. Consider the computation of isotropic NMR shielding constants of benzene within a single-determinant response framework and a contracted Gaussian basis.\n\nWhich of the following statements best explains how London orbitals reduce gauge-origin dependence and why their use often lessens the need for extremely diffuse basis functions in such NMR shielding calculations for benzene?\n\nA. London orbitals attach a field-dependent complex phase to each atomic basis function centered at $\\mathbf{R}_\\mu$, ensuring that the finite variational space transforms properly under shifts of the gauge origin $\\mathbf{R}_0$. This strongly suppresses origin dependence of magnetic response at finite basis. Because the correct long-wavelength gauge behavior is built into the basis, extremely diffuse $s$- and $p$-type functions become less critical for benzene shieldings, although polarization functions remain essential to describe induced ring currents.\n\nB. London orbitals remove the paramagnetic term of the shielding tensor identically, so origin dependence vanishes but the description of diamagnetic currents requires adding even more diffuse functions than in standard Gaussian bases.\n\nC. Gauge-origin dependence arises solely from electron correlation; therefore, introducing London orbitals in a Hartree–Fock calculation has no effect on origin dependence, and only adding diffuse functions can cure it.\n\nD. Choosing the Coulomb gauge with $\\nabla\\cdot \\mathbf{A}=0$ eliminates origin dependence exactly in any finite Gaussian basis without adding phase factors; hence London orbitals are unnecessary, and diffuse functions are only needed for describing core orbitals of benzene.\n\nE. The phase factor in London orbitals reproduces all field-induced anisotropy, so polarization functions are no longer needed; for benzene shieldings, a minimal unpolarized basis with London phases suffices and diffuse functions become completely superfluous.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n\n-   A uniform static magnetic field is denoted by $\\mathbf{B}$.\n-   The vector potential is $\\mathbf{A}(\\mathbf{r})$.\n-   In nonrelativistic electronic structure theory with minimal coupling, the canonical momentum operator $\\mathbf{p}$ is replaced by the mechanical momentum operator $\\mathbf{p}-q\\,\\mathbf{A}(\\mathbf{r})$, where $q$ is the electron charge in atomic units.\n-   A common choice of vector potential for a uniform field $\\mathbf{B}$ is $\\mathbf{A}_{\\mathbf{R}_0}(\\mathbf{r})=\\tfrac{1}{2}\\,\\mathbf{B}\\times\\left(\\mathbf{r}-\\mathbf{R}_0\\right)$, which depends on a gauge origin $\\mathbf{R}_0$.\n-   Exact observables are independent of the gauge origin.\n-   A gauge change $\\mathbf{A}\\mapsto \\mathbf{A}+\\nabla \\chi(\\mathbf{r})$ is compensated by a phase transformation of the exact wave function $\\psi(\\mathbf{r})\\mapsto e^{i q \\chi(\\mathbf{r})}\\psi(\\mathbf{r})$.\n-   In a finite, real Gaussian basis without field-dependent phases, computed magnetic properties depend on the gauge origin $\\mathbf{R}_0$.\n-   Gauge-Including Atomic Orbitals (GIAOs), or London orbitals, are a remedy which attach a field-dependent phase to each atomic basis function.\n-   The system under consideration is benzene, and the property is the isotropic NMR shielding constant, computed within a single-determinant response framework using a contracted Gaussian basis.\n-   The question asks for the best explanation of how London orbitals reduce gauge-origin dependence and why their use lessens the need for extremely diffuse basis functions for this calculation.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientific Grounding**: The problem is based on the standard, well-established quantum mechanical theory of molecular magnetic properties. The concepts of the vector potential, gauge transformations, the minimal coupling prescription, the gauge origin problem in finite basis sets, and the GIAO method are all cornerstones of this field. The description is factually correct and scientifically sound.\n-   **Well-Posedness**: The problem is well-posed. It asks for a scientific explanation of a known computational method's effectiveness, which has a clear and established answer within the theory.\n-   **Objectivity**: The problem is stated in precise, technical language, free from subjective or ambiguous terminology.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is scientifically sound, well-posed, and objective. There are no contradictions, missing information, or other flaws. The problem is valid. We proceed to a full solution.\n\n**Derivation and Evaluation**\n\nThe central issue is the gauge invariance of quantum mechanical observables. The Schrödinger equation is invariant under the simultaneous transformations:\n$$\n\\mathbf{A}(\\mathbf{r}) \\rightarrow \\mathbf{A}'(\\mathbf{r}) = \\mathbf{A}(\\mathbf{r}) + \\nabla\\chi(\\mathbf{r})\n$$\n$$\n\\psi(\\mathbf{r}) \\rightarrow \\psi'(\\mathbf{r}) = e^{iq\\chi(\\mathbf{r})/\\hbar} \\psi(\\mathbf{r})\n$$\nIn atomic units, $\\hbar=1$ and for an electron $q=-1$. The problem statement uses a general charge $q$.\n\nWhen we use a finite basis set expansion for the molecular orbitals, $\\psi_i = \\sum_{\\mu} c_{\\mu i} \\phi_\\mu$, the exact wavefunction $\\psi$ is approximated. A standard basis set of atomic orbitals, $\\{\\phi_\\mu(\\mathbf{r}-\\mathbf{R}_\\mu)\\}$, is fixed and does not depend on the vector potential $\\mathbf{A}(\\mathbf{r})$. If we change the gauge, for instance by shifting the gauge origin $\\mathbf{R}_0$ in $\\mathbf{A}_{\\mathbf{R}_0}(\\mathbf{r})=\\tfrac{1}{2}\\,\\mathbf{B}\\times\\left(\\mathbf{r}-\\mathbf{R}_0\\right)$, an arbitrary function in the space spanned by $\\{\\phi_\\mu\\}$ cannot reproduce the required phase transformation $e^{iq\\chi(\\mathbf{r})/\\hbar}\\psi(\\mathbf{r})$. The variational space is not closed under this transformation. This incompleteness of the basis set is the root of the spurious gauge-origin dependence of calculated properties like NMR shielding constants.\n\nThe London orbital, or GIAO, approach, introduced by Fritz London in $1937$, remedies this flaw at the basis-function level. Instead of a field-independent basis function $\\phi_\\mu$, one uses a field-dependent one:\n$$\n\\chi_\\mu(\\mathbf{r}, \\mathbf{B}) = e^{-iq\\frac{1}{2}(\\mathbf{B}\\times\\mathbf{R}_\\mu)\\cdot\\mathbf{r}} \\, \\phi_\\mu(\\mathbf{r}-\\mathbf{R}_\\mu)\n$$\nThis specific form is for a gauge origin at the coordinate system origin, i.e., $\\mathbf{R}_0 = \\mathbf{0}$ and $\\mathbf{A}(\\mathbf{r}) = \\frac{1}{2}\\mathbf{B}\\times\\mathbf{r}$. The phase factor is $e^{-iq\\mathbf{A}(\\mathbf{R}_\\mu)\\cdot\\mathbf{r}}$. This phase factor gives the basis function the correct translational property under a magnetic field. When the mechanical momentum operator, $\\hat{\\boldsymbol{\\pi}} = \\mathbf{p} - q\\mathbf{A}(\\mathbf{r})$, acts on this GIAO, the result is\n$$\n\\hat{\\boldsymbol{\\pi}} \\chi_\\mu(\\mathbf{r}, \\mathbf{B}) = e^{-iq\\mathbf{A}(\\mathbf{R}_\\mu)\\cdot\\mathbf{r}} \\left( \\mathbf{p} - q\\mathbf{A}(\\mathbf{r}) + q\\mathbf{A}(\\mathbf{R}_\\mu) \\right) \\phi_\\mu(\\mathbf{r}-\\mathbf{R}_\\mu) = e^{-iq\\mathbf{A}(\\mathbf{R}_\\mu)\\cdot\\mathbf{r}} \\left( \\mathbf{p} - q\\frac{1}{2}\\mathbf{B}\\times(\\mathbf{r}-\\mathbf{R}_\\mu) \\right) \\phi_\\mu(\\mathbf{r}-\\mathbf{R}_\\mu)\n$$\nCritically, the vector potential appearing in the operator that acts on the original Gaussian function $\\phi_\\mu$ is now centered at the basis function's own origin, $\\mathbf{R}_\\mu$. Any matrix element $\\langle \\chi_\\mu | \\hat{\\mathcal{O}} | \\chi_\\nu \\rangle$ involving the momentum operator now depends on vector potentials centered at their respective atomic sites, $\\mathbf{R}_\\mu$ and $\\mathbf{R}_\\nu$, and is independent of the global, arbitrary gauge origin $\\mathbf{R}_0$. This ensures that calculated properties are, to a very high degree, independent of $\\mathbf{R}_0$ even with a finite basis set.\n\nNow, we consider the need for diffuse functions. Without GIAOs, if the gauge origin $\\mathbf{R}_0$ is chosen far from an atom at $\\mathbf{R}_\\mu$, the basis functions $\\{\\phi_\\mu\\}$ must describe the electronic response under a large vector potential $\\mathbf{A}_{\\mathbf{R}_0}(\\mathbf{r})$. This requires the basis to be very flexible over long distances to correctly model the induced current density, which in turn necessitates the use of basis functions with large spatial extent (i.e., very diffuse functions). This is an artificial demand imposed by a poor choice of common gauge origin. With GIAOs, the long-range part of the gauge problem is solved analytically by the complex phase factor. Each basis function effectively operates in its own local gauge, so it only needs to be flexible enough to describe the *physical* response of the electron density in its immediate vicinity. The artificial need for diffuse functions to handle long-range gauge effects is therefore greatly diminished.\n\nHowever, the physical description of electron currents, such as the aromatic ring current in benzene, requires the deformation of molecular orbitals. This deformation is accomplished in the basis set by mixing functions of different angular momenta (e.g., $p$ and $d$ orbitals on carbon). These are polarization functions. GIAOs do not eliminate the need for an adequate description of the physical response, so polarization functions remain essential for accurate calculations of properties like NMR shielding anisotropy, which is dominated by the ring current in benzene.\n\nWith this understanding, we evaluate the options.\n\n**Option-by-Option Analysis**\n\n**A.** \"London orbitals attach a field-dependent complex phase to each atomic basis function centered at $\\mathbf{R}_\\mu$, ensuring that the finite variational space transforms properly under shifts of the gauge origin $\\mathbf{R}_0$. This strongly suppresses origin dependence of magnetic response at finite basis. Because the correct long-wavelength gauge behavior is built into the basis, extremely diffuse $s$- and $p$-type functions become less critical for benzene shieldings, although polarization functions remain essential to describe induced ring currents.\"\nThis statement is entirely consistent with our derivation. It correctly identifies the role of the phase factor in restoring proper transformation properties and suppressing origin dependence. It correctly links the built-in \"long-wavelength gauge behavior\" to the reduced need for diffuse functions. Finally, it correctly states that polarization functions are still necessary to describe the physical phenomenon of induced currents.\n**Verdict: Correct.**\n\n**B.** \"London orbitals remove the paramagnetic term of the shielding tensor identically, so origin dependence vanishes but the description of diamagnetic currents requires adding even more diffuse functions than in standard Gaussian bases.\"\nThis is incorrect. GIAOs do not remove the paramagnetic term, which is a physically meaningful (though gauge-dependent) component of the shielding. They ensure the sum of paramagnetic and diamagnetic terms is approximately gauge-invariant. The claim that they increase the need for diffuse functions is the opposite of the truth.\n**Verdict: Incorrect.**\n\n**C.** \"Gauge-origin dependence arises solely from electron correlation; therefore, introducing London orbitals in a Hartree–Fock calculation has no effect on origin dependence, and only adding diffuse functions can cure it.\"\nThis is incorrect. Gauge-origin dependence is a finite-basis-set artifact that is prominent even in Hartree–Fock (single-determinant) theory, which neglects electron correlation. GIAOs are extremely effective at the Hartree-Fock level. Stating that only diffuse functions can cure the problem is also false.\n**Verdict: Incorrect.**\n\n**D.** \"Choosing the Coulomb gauge with $\\nabla\\cdot \\mathbf{A}=0$ eliminates origin dependence exactly in any finite Gaussian basis without adding phase factors; hence London orbitals are unnecessary, and diffuse functions are only needed for describing core orbitals of benzene.\"\nThis is incorrect. The Coulomb gauge condition $\\nabla\\cdot \\mathbf{A}=0$ does not uniquely specify $\\mathbf{A}$, and the freedom to shift the gauge origin persists within this gauge family. Therefore, the gauge-origin problem is not eliminated. Furthermore, the statement that diffuse functions are for core orbitals is nonsensical; they are for valence and long-range phenomena.\n**Verdict: Incorrect.**\n\n**E.** \"The phase factor in London orbitals reproduces all field-induced anisotropy, so polarization functions are no longer needed; for benzene shieldings, a minimal unpolarized basis with London phases suffices and diffuse functions become completely superfluous.\"\nThis is incorrect. The phase factor corrects a mathematical deficiency (gauge dependence). It does not substitute for the physical necessity of describing the anisotropic distortion of the electron cloud, for which polarization functions are essential. A minimal basis, even with GIAOs, will not yield accurate shielding constants for a molecule like benzene.\n**Verdict: Incorrect.**\n\nThus, only statement A provides a scientifically correct and complete explanation.", "answer": "$$\\boxed{A}$$", "id": "2916068"}, {"introduction": "Moving from theory to practice, this problem requires you to implement the core algorithm for an NMR shielding calculation using the GIAO approach. You will be provided with the necessary matrix elements, simulating the output of a quantum chemistry program's integral engine. This hands-on coding exercise will solidify your understanding of how the diamagnetic and paramagnetic contributions are assembled to compute the final shielding tensor [@problem_id:2893981].", "problem": "A closed-shell molecule in a uniform external magnetic field is described by the minimal-coupling Hamiltonian with the vector potential in Coulomb gauge, where the vector potential is given by $\\mathbf{A}(\\mathbf{r}) = \\tfrac{1}{2}\\,\\mathbf{B} \\times (\\mathbf{r} - \\mathbf{R}_g)$. The electronic energy depends on both the external magnetic field $\\mathbf{B}$ and on the magnetic dipole moment of a chosen nucleus $K$, denoted $\\boldsymbol{\\mu}_K$. The nuclear magnetic resonance (NMR) shielding tensor at nucleus $K$ is defined as the mixed second derivative of the electronic energy with respect to these perturbations, evaluated at zero field and zero nuclear magnetic moment. In a linear response framework with Gauge-Including Atomic Orbitals (GIAO), and a closed-shell Restricted Hartree–Fock (RHF) reference, the shielding tensor decomposes into a diamagnetic contribution from the expectation value of a one-electron diamagnetic operator and a paramagnetic contribution arising from the first-order change in the wave function. You are to derive, from the minimal-coupling Hamiltonian and the definition of the shielding tensor, an implementable expression suitable for numerical evaluation in an atomic orbital (AO) basis with GIAO phase factors, under the following assumptions: closed-shell RHF reference, independent-particle linear response (sum-over-states) for the paramagnetic term, and property integrals already evaluated in the GIAO basis.\n\nYour task is to write a complete program that, for each provided test case, carries out the following steps using only the information provided in the test suite data:\n- Solve the generalized eigenvalue problem for the Fock matrix in a non-orthonormal AO basis to obtain molecular orbital (MO) energies and coefficients.\n- Build the closed-shell one-particle density matrix from the occupied MO coefficients.\n- Evaluate the diamagnetic part of the shielding tensor at a specified nucleus as an expectation value of the supplied diamagnetic AO operator matrices with the density matrix.\n- Evaluate the paramagnetic part of the shielding tensor using an independent-particle sum-over-states expression involving the occupied–virtual MO matrix elements of the supplied AO property matrices coupling to the nuclear magnetic dipole at nucleus $K$ and the external magnetic field.\n- Form the total shielding tensor and report its isotropic value.\n\nYou must treat the following objects as given numerical inputs for each case:\n- The AO overlap matrix $\\mathbf{S}$, a real, symmetric, positive-definite matrix of size $N \\times N$.\n- The AO Fock matrix $\\mathbf{F}$, a real, symmetric matrix of size $N \\times N$, corresponding to the unperturbed RHF solution at zero field.\n- The number of electrons $N_e$, an even integer determining the number of occupied spatial orbitals $N_{\\mathrm{occ}} = N_e / 2$.\n- Diamagnetic AO operator matrices for the chosen nucleus $K$, one for each Cartesian component, $\\mathbf{D}_{xx}^K$, $\\mathbf{D}_{yy}^K$, and $\\mathbf{D}_{zz}^K$, each of size $N \\times N$.\n- Magnetic dipole coupling AO matrices at nucleus $K$, $\\mathbf{M}_x^K$, $\\mathbf{M}_y^K$, and $\\mathbf{M}_z^K$, each of size $N \\times N$.\n- External magnetic field coupling AO matrices $\\mathbf{L}_x$, $\\mathbf{L}_y$, and $\\mathbf{L}_z$, each of size $N \\times N$.\n- A gauge-origin vector $\\mathbf{R}_g$ (which for a GIAO treatment should not affect the final result), specified as a triplet of real numbers.\n\nYour program must:\n- Solve for MO energies and coefficients by orthonormalizing the AO basis using symmetric orthonormalization, diagonalizing the transformed Fock matrix, and back-transforming to obtain the MO coefficient matrix in the AO basis.\n- Build the closed-shell density matrix $\\mathbf{P} = 2\\,\\mathbf{C}_{\\mathrm{occ}} \\mathbf{C}_{\\mathrm{occ}}^{\\top}$, where $\\mathbf{C}_{\\mathrm{occ}}$ collects the first $N_{\\mathrm{occ}}$ columns of the MO coefficient matrix $\\mathbf{C}$.\n- Compute the diamagnetic diagonal shielding components as $\\sigma_{d,uu} = \\mathrm{Tr}(\\mathbf{P}\\,\\mathbf{D}_{uu}^K)$ for $u \\in \\{x,y,z\\}$, using only the provided diagonal operator components $\\mathbf{D}_{xx}^K$, $\\mathbf{D}_{yy}^K$, and $\\mathbf{D}_{zz}^K$.\n- Compute the paramagnetic diagonal shielding components using a sum-over-states expression in the MO basis for $u \\in \\{x,y,z\\}$:\n  1. Transform $\\mathbf{M}_u^K$ and $\\mathbf{L}_u$ to the MO basis via $\\tilde{\\mathbf{M}}_u^K = \\mathbf{C}^{\\top} \\mathbf{M}_u^K \\mathbf{C}$ and $\\tilde{\\mathbf{L}}_u = \\mathbf{C}^{\\top} \\mathbf{L}_u \\mathbf{C}$.\n  2. Let $\\{\\varepsilon_p\\}$ be the MO energies ordered ascending. With $i$ indexing occupied orbitals and $a$ indexing virtual orbitals, evaluate\n     $\\sigma_{p,uu} = -2 \\sum_{i=1}^{N_{\\mathrm{occ}}} \\sum_{a=N_{\\mathrm{occ}}+1}^{N} \\dfrac{ \\tilde{M}_{u,ia}^K \\, \\tilde{L}_{u,ai} }{ \\varepsilon_{a} - \\varepsilon_{i} }$.\n- Form the total diagonal components $\\sigma_{uu} = \\sigma_{d,uu} + \\sigma_{p,uu}$ and compute the isotropic shielding $\\sigma_{\\mathrm{iso}} = (\\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz})/3$.\n- Report the result in parts per million by computing $\\sigma_{\\mathrm{ppm}} = 10^{6}\\,\\sigma_{\\mathrm{iso}}$.\n\nAll quantities are in atomic units unless otherwise specified. The output for each test case must be a float number representing $\\sigma_{\\mathrm{ppm}}$, rounded to exactly $6$ digits after the decimal point. Your program should produce a single line of output containing the results for all test cases, formatted as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,x_3]$.\n\nUse the following test suite. Each test case is specified by providing $N$, $N_e$, $\\mathbf{S}$, $\\mathbf{F}$, $\\mathbf{D}_{xx}^K$, $\\mathbf{D}_{yy}^K$, $\\mathbf{D}_{zz}^K$, $\\mathbf{M}_x^K$, $\\mathbf{M}_y^K$, $\\mathbf{M}_z^K$, $\\mathbf{L}_x$, $\\mathbf{L}_y$, $\\mathbf{L}_z$, and $\\mathbf{R}_g$.\n\nTest case $1$ (closed-shell diatomic, two-AO minimal basis, slight AO overlap):\n- $N = 2$, $N_e = 2$.\n- $\\mathbf{S} = \\begin{bmatrix} $1.0$ & $0.05$ \\\\ $0.05$ & $1.0$ \\end{bmatrix}$.\n- $\\mathbf{F} = \\begin{bmatrix} -$0.7$ & -$0.15$ \\\\ -$0.15$ & $0.2$ \\end{bmatrix}$.\n- $\\mathbf{D}_{xx}^K = \\begin{bmatrix} $3.1\\times 10^{-5}$ & $0.2\\times 10^{-5}$ \\\\ $0.2\\times 10^{-5}$ & $2.9\\times 10^{-5}$ \\end{bmatrix}$.\n- $\\mathbf{D}_{yy}^K = \\begin{bmatrix} $3.0\\times 10^{-5}$ & $0.1\\times 10^{-5}$ \\\\ $0.1\\times 10^{-5}$ & $3.0\\times 10^{-5}$ \\end{bmatrix}$.\n- $\\mathbf{D}_{zz}^K = \\begin{bmatrix} $3.2\\times 10^{-5}$ & -$0.1\\times 10^{-5}$ \\\\ -$0.1\\times 10^{-5}$ & $2.8\\times 10^{-5}$ \\end{bmatrix}$.\n- $\\mathbf{M}_x^K = \\begin{bmatrix} $0.0$ & $1.5\\times 10^{-3}$ \\\\ $1.5\\times 10^{-3}$ & $0.0$ \\end{bmatrix}$.\n- $\\mathbf{M}_y^K = \\begin{bmatrix} $0.0$ & -$1.1\\times 10^{-3}$ \\\\ -$1.1\\times 10^{-3}$ & $0.0$ \\end{bmatrix}$.\n- $\\mathbf{M}_z^K = \\begin{bmatrix} $0.0$ & $0.9\\times 10^{-3}$ \\\\ $0.9\\times 10^{-3}$ & $0.0$ \\end{bmatrix}$.\n- $\\mathbf{L}_x = \\begin{bmatrix} $0.0$ & $2.0\\times 10^{-3}$ \\\\ $2.0\\times 10^{-3}$ & $0.0$ \\end{bmatrix}$.\n- $\\mathbf{L}_y = \\begin{bmatrix} $0.0$ & -$1.8\\times 10^{-3}$ \\\\ -$1.8\\times 10^{-3}$ & $0.0$ \\end{bmatrix}$.\n- $\\mathbf{L}_z = \\begin{bmatrix} $0.0$ & $1.6\\times 10^{-3}$ \\\\ $1.6\\times 10^{-3}$ & $0.0$ \\end{bmatrix}$.\n- $\\mathbf{R}_g = ($0.0$, $0.0$, $0.0$)$.\n\nTest case $2$ (same integrals, different gauge origin to test gauge-origin invariance under GIAO):\n- $N = 2$, $N_e = 2$.\n- $\\mathbf{S} = \\begin{bmatrix} $1.0$ & $0.05$ \\\\ $0.05$ & $1.0$ \\end{bmatrix}$.\n- $\\mathbf{F} = \\begin{bmatrix} -$0.7$ & -$0.15$ \\\\ -$0.15$ & $0.2$ \\end{bmatrix}$.\n- $\\mathbf{D}_{xx}^K = \\begin{bmatrix} $3.1\\times 10^{-5}$ & $0.2\\times 10^{-5}$ \\\\ $0.2\\times 10^{-5}$ & $2.9\\times 10^{-5}$ \\end{bmatrix}$.\n- $\\mathbf{D}_{yy}^K = \\begin{bmatrix} $3.0\\times 10^{-5}$ & $0.1\\times 10^{-5}$ \\\\ $0.1\\times 10^{-5}$ & $3.0\\times 10^{-5}$ \\end{bmatrix}$.\n- $\\mathbf{D}_{zz}^K = \\begin{bmatrix} $3.2\\times 10^{-5}$ & -$0.1\\times 10^{-5}$ \\\\ -$0.1\\times 10^{-5}$ & $2.8\\times 10^{-5}$ \\end{bmatrix}$.\n- $\\mathbf{M}_x^K = \\begin{bmatrix} $0.0$ & $1.5\\times 10^{-3}$ \\\\ $1.5\\times 10^{-3}$ & $0.0$ \\end{bmatrix}$.\n- $\\mathbf{M}_y^K = \\begin{bmatrix} $0.0$ & -$1.1\\times 10^{-3}$ \\\\ -$1.1\\times 10^{-3}$ & $0.0$ \\end{bmatrix}$.\n- $\\mathbf{M}_z^K = \\begin{bmatrix} $0.0$ & $0.9\\times 10^{-3}$ \\\\ $0.9\\times 10^{-3}$ & $0.0$ \\end{bmatrix}$.\n- $\\mathbf{L}_x = \\begin{bmatrix} $0.0$ & $2.0\\times 10^{-3}$ \\\\ $2.0\\times 10^{-3}$ & $0.0$ \\end{bmatrix}$.\n- $\\mathbf{L}_y = \\begin{bmatrix} $0.0$ & -$1.8\\times 10^{-3}$ \\\\ -$1.8\\times 10^{-3}$ & $0.0$ \\end{bmatrix}$.\n- $\\mathbf{L}_z = \\begin{bmatrix} $0.0$ & $1.6\\times 10^{-3}$ \\\\ $1.6\\times 10^{-3}$ & $0.0$ \\end{bmatrix}$.\n- $\\mathbf{R}_g = ($1.0$, -$2.0$, $0.5$)$.\n\nTest case $3$ (single-AO closed shell, no virtuals; paramagnetic contribution vanishes):\n- $N = 1$, $N_e = 2$.\n- $\\mathbf{S} = \\begin{bmatrix} $1.0$ \\end{bmatrix}$.\n- $\\mathbf{F} = \\begin{bmatrix} -$0.5$ \\end{bmatrix}$.\n- $\\mathbf{D}_{xx}^K = \\begin{bmatrix} $3.0\\times 10^{-5}$ \\end{bmatrix}$.\n- $\\mathbf{D}_{yy}^K = \\begin{bmatrix} $3.0\\times 10^{-5}$ \\end{bmatrix}$.\n- $\\mathbf{D}_{zz}^K = \\begin{bmatrix} $3.0\\times 10^{-5}$ \\end{bmatrix}$.\n- $\\mathbf{M}_x^K = \\begin{bmatrix} $0.0$ \\end{bmatrix}$, $\\mathbf{M}_y^K = \\begin{bmatrix} $0.0$ \\end{bmatrix}$, $\\mathbf{M}_z^K = \\begin{bmatrix} $0.0$ \\end{bmatrix}$.\n- $\\mathbf{L}_x = \\begin{bmatrix} $0.0$ \\end{bmatrix}$, $\\mathbf{L}_y = \\begin{bmatrix} $0.0$ \\end{bmatrix}$, $\\mathbf{L}_z = \\begin{bmatrix} $0.0$ \\end{bmatrix}$.\n- $\\mathbf{R}_g = ($0.0$, $0.0$, $0.0$)$.\n\nAngle units do not apply. Express the final isotropic shielding for each case in parts per million (dimensionless), rounded to exactly six digits after the decimal point, and print the three results on a single line as a comma-separated list enclosed in square brackets, for example, $[12.345678,23.456789,34.567890]$.", "solution": "The problem requires the computation of the isotropic nuclear magnetic resonance (NMR) shielding constant for a closed-shell molecule described by Restricted Hartree-Fock (RHF) theory, using Gauge-Including Atomic Orbitals (GIAOs). The provided data consists of pre-computed matrix elements of various operators in the atomic orbital (AO) basis. The task is to implement the standard quantum chemical expressions for the diamagnetic and paramagnetic contributions to the shielding tensor and combine them to find the total isotropic shielding. The problem is scientifically well-grounded and provides a complete set of data and a clear computational procedure, rendering it a valid and solvable problem in computational quantum chemistry.\n\nThe theoretical framework begins with the solution of the unperturbed electronic structure problem, which for a closed-shell RHF wavefunction is given by the Roothaan-Hall generalized eigenvalue equation:\n$$\n\\mathbf{F}\\mathbf{C} = \\mathbf{S}\\mathbf{C}\\boldsymbol{\\varepsilon}\n$$\nHere, $\\mathbf{F}$ is the Fock matrix, $\\mathbf{S}$ is the AO overlap matrix, $\\mathbf{C}$ is the matrix of molecular orbital (MO) coefficients, and $\\boldsymbol{\\varepsilon}$ is the diagonal matrix of MO energies. All matrices are represented in the basis of $N$ atomic orbitals.\n\nThe electronic state is described by the one-particle density matrix $\\mathbf{P}$. For a closed-shell system with $N_e$ electrons, there are $N_{\\mathrm{occ}} = N_e / 2$ doubly occupied spatial orbitals. The density matrix in the AO basis is constructed from the MO coefficients of these occupied orbitals, $\\mathbf{C}_{\\mathrm{occ}}$:\n$$\n\\mathbf{P} = 2\\,\\mathbf{C}_{\\mathrm{occ}} \\mathbf{C}_{\\mathrm{occ}}^{\\top}\n$$\n\nThe NMR shielding tensor $\\boldsymbol{\\sigma}^K$ at nucleus $K$ is the mixed second derivative of the electronic energy with respect to the external magnetic field $\\mathbf{B}$ and the nuclear magnetic moment $\\boldsymbol{\\mu}_K$. Within linear response theory, it is separable into two contributions: a diamagnetic part $\\boldsymbol{\\sigma}_d^K$ and a paramagnetic part $\\boldsymbol{\\sigma}_p^K$.\n$$\n\\boldsymbol{\\sigma}^K = \\boldsymbol{\\sigma}_d^K + \\boldsymbol{\\sigma}_p^K\n$$\n\nThe diamagnetic contribution, $\\sigma_{d,uu}^K$ for a Cartesian component $u \\in \\{x, y, z\\}$, is the ground-state expectation value of the corresponding second-derivative operator. Given the AO matrix representation of this operator, $\\mathbf{D}_{uu}^K$, the diamagnetic shielding component is computed as a matrix trace with the density matrix:\n$$\n\\sigma_{d,uu}^K = \\mathrm{Tr}(\\mathbf{P}\\,\\mathbf{D}_{uu}^K)\n$$\n\nThe paramagnetic contribution, $\\sigma_{p,uu}^K$, arises from the first-order mixing of occupied and virtual (unoccupied) orbitals due to the magnetic perturbations. The problem provides a sum-over-states expression based on an independent-particle model for this term. Let $\\mathbf{M}_u^K$ be the AO matrix for the operator coupling to the $u$-component of the nuclear magnetic moment $\\boldsymbol{\\mu}_K$, and let $\\mathbf{L}_u$ be the AO matrix for the operator coupling to the $u$-component of the external magnetic field $\\mathbf{B}$. The paramagnetic shielding component is given by:\n$$\n\\sigma_{p,uu}^K = -2 \\sum_{i=1}^{N_{\\mathrm{occ}}} \\sum_{a=N_{\\mathrm{occ}}+1}^{N} \\frac{ \\tilde{M}_{u,ia}^K \\, \\tilde{L}_{u,ai} }{ \\varepsilon_{a} - \\varepsilon_{i} }\n$$\nwhere $i$ indexes occupied MOs and $a$ indexes virtual MOs. The terms $\\tilde{M}_{u,ia}^K$ and $\\tilde{L}_{u,ai}$ are the matrix elements of the perturbation operators in the MO basis, which are obtained by transforming the AO matrices:\n$$\n\\tilde{\\mathbf{M}}_u^K = \\mathbf{C}^{\\top} \\mathbf{M}_u^K \\mathbf{C} \\quad \\text{and} \\quad \\tilde{\\mathbf{L}}_u = \\mathbf{C}^{\\top} \\mathbf{L}_u \\mathbf{C}\n$$\nSince the provided AO matrices $\\mathbf{M}_u^K$ and $\\mathbf{L}_u$ are real and symmetric, their MO-basis representations $\\tilde{\\mathbf{M}}_u^K$ and $\\tilde{\\mathbf{L}}_u$ are also real and symmetric. Therefore, $\\tilde{L}_{u,ai} = \\tilde{L}_{u,ia}$.\n\nFinally, the total isotropic shielding constant, $\\sigma_{\\mathrm{iso}}$, is one-third of the trace of the total shielding tensor. We compute this from the diagonal components:\n$$\n\\sigma_{\\mathrm{iso}} = \\frac{1}{3} (\\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz}) = \\frac{1}{3} \\sum_{u \\in \\{x,y,z\\}} (\\sigma_{d,uu}^K + \\sigma_{p,uu}^K)\n$$\nThe result is then converted to parts per million (ppm) for reporting: $\\sigma_{\\mathrm{ppm}} = 10^6 \\sigma_{\\mathrm{iso}}$.\n\nThe computational procedure is as follows:\n1.  Solve the generalized eigenvalue problem $\\mathbf{F}\\mathbf{C} = \\mathbf{S}\\mathbf{C}\\boldsymbol{\\varepsilon}$ to find MO energies $\\varepsilon_p$ and coefficients $\\mathbf{C}$. This is accomplished via symmetric orthonormalization of the AO basis. First, the transformation matrix $\\mathbf{X} = \\mathbf{S}^{-1/2}$ is constructed from the eigenvalues and eigenvectors of $\\mathbf{S}$. The Fock matrix is then transformed to the orthonormal basis, $\\mathbf{F}' = \\mathbf{X}^{\\top} \\mathbf{F} \\mathbf{X}$.\n2.  The standard eigenvalue problem $\\mathbf{F}'\\mathbf{C}' = \\mathbf{C}'\\boldsymbol{\\varepsilon}$ is solved for the orthonormal MO coefficients $\\mathbf{C}'$ and energies $\\boldsymbol{\\varepsilon}$.\n3.  The MO coefficients are back-transformed to the original AO basis: $\\mathbf{C} = \\mathbf{X}\\mathbf{C}'$. The resulting energies and coefficient matrix columns must be sorted in ascending order of energy.\n4.  The density matrix $\\mathbf{P}$ is constructed using the first $N_{\\mathrm{occ}} = N_e/2$ columns of $\\mathbf{C}$.\n5.  The diamagnetic components $\\sigma_{d,uu}^K$ are calculated by taking the trace of the product of $\\mathbf{P}$ and each of the given $\\mathbf{D}_{uu}^K$ matrices.\n6.  The paramagnetic components $\\sigma_{p,uu}^K$ are calculated by first transforming the $\\mathbf{M}_u^K$ and $\\mathbf{L}_u$ matrices to the MO basis and then evaluating the sum-over-states expression.\n7.  The total diagonal components $\\sigma_{uu}$ are summed, averaged to get $\\sigma_{\\mathrm{iso}}$, and scaled by $10^6$ to obtain the final result in ppm.\n\nThe GIAO method ensures that the calculated shielding tensor is independent of the gauge origin $\\mathbf{R}_g$. The provided operator matrices are assumed to be correctly formulated within the GIAO framework. Consequently, the vector $\\mathbf{R}_g$ is not explicitly used in the calculation, a fact verified by the test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef calculate_shielding(N, Ne, S, F, D_xx, D_yy, D_zz, M_x, M_y, M_z, L_x, L_y, L_z, R_g):\n    \"\"\"\n    Calculates the isotropic NMR shielding constant using GIAO-RHF theory.\n    \"\"\"\n    # Number of occupied orbitals\n    N_occ = Ne // 2\n    \n    # Step 1-3: Solve the generalized eigenvalue problem using explicit symmetric orthonormalization.\n    # The problem statement specifies this procedure.\n    \n    # 1.a: Find eigenvalues (s_vals) and eigenvectors (U) of the overlap matrix S.\n    s_vals, U = np.linalg.eigh(S)\n    \n    # 1.b: Construct S^(-1/2)\n    s_inv_sqrt = np.diag(s_vals**-0.5)\n    X = U @ s_inv_sqrt @ U.T # Transformation matrix S^(-1/2)\n    \n    # 2: Transform F to the orthonormal basis\n    F_prime = X.T @ F @ X\n    \n    # 3.a: Solve the standard eigenvalue problem for F_prime\n    eps, C_prime = np.linalg.eigh(F_prime) # eps are MO energies, C_prime are coeffs in ortho basis\n    \n    # eps and C_prime are already sorted by eigenvalue.\n    \n    # 3.b: Back-transform coefficients to the AO basis\n    C = X @ C_prime\n    \n    # Step 4: Build the closed-shell density matrix\n    C_occ = C[:, :N_occ]\n    P = 2 * (C_occ @ C_occ.T)\n    \n    # Step 5: Compute the diamagnetic part of the shielding tensor\n    sigma_d_xx = np.trace(P @ D_xx)\n    sigma_d_yy = np.trace(P @ D_yy)\n    sigma_d_zz = np.trace(P @ D_zz)\n    \n    # Step 6: Compute the paramagnetic part of the shielding tensor\n    sigma_p_xx, sigma_p_yy, sigma_p_zz = 0.0, 0.0, 0.0\n    \n    # Only if there are virtual orbitals\n    if N > N_occ:\n        # Transform M and L operators to MO basis\n        M_x_mo = C.T @ M_x @ C\n        M_y_mo = C.T @ M_y @ C\n        M_z_mo = C.T @ M_z @ C\n        L_x_mo = C.T @ L_x @ C\n        L_y_mo = C.T @ L_y @ C\n        L_z_mo = C.T @ L_z @ C\n        \n        # Sum-over-states expression\n        for i in range(N_occ):\n            for a in range(N_occ, N):\n                energy_diff = eps[a] - eps[i]\n                if np.abs(energy_diff) > 1e-12: # Avoid division by zero\n                    # Since operators are symmetric, L_ai = L_ia\n                    sigma_p_xx -= 2 * M_x_mo[i, a] * L_x_mo[i, a] / energy_diff\n                    sigma_p_yy -= 2 * M_y_mo[i, a] * L_y_mo[i, a] / energy_diff\n                    sigma_p_zz -= 2 * M_z_mo[i, a] * L_z_mo[i, a] / energy_diff\n\n    # Step 7: Form the total shielding tensor and compute the isotropic value\n    sigma_xx = sigma_d_xx + sigma_p_xx\n    sigma_yy = sigma_d_yy + sigma_p_yy\n    sigma_zz = sigma_d_zz + sigma_p_zz\n    \n    sigma_iso = (sigma_xx + sigma_yy + sigma_zz) / 3.0\n    \n    # Convert to parts per million (ppm)\n    sigma_ppm = 1e6 * sigma_iso\n    \n    return sigma_ppm\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        {\n            \"N\": 2, \"Ne\": 2,\n            \"S\": np.array([[1.0, 0.05], [0.05, 1.0]]),\n            \"F\": np.array([[-0.7, -0.15], [-0.15, 0.2]]),\n            \"D_xx\": np.array([[3.1e-5, 0.2e-5], [0.2e-5, 2.9e-5]]),\n            \"D_yy\": np.array([[3.0e-5, 0.1e-5], [0.1e-5, 3.0e-5]]),\n            \"D_zz\": np.array([[3.2e-5, -0.1e-5], [-0.1e-5, 2.8e-5]]),\n            \"M_x\": np.array([[0.0, 1.5e-3], [1.5e-3, 0.0]]),\n            \"M_y\": np.array([[0.0, -1.1e-3], [-1.1e-3, 0.0]]),\n            \"M_z\": np.array([[0.0, 0.9e-3], [0.9e-3, 0.0]]),\n            \"L_x\": np.array([[0.0, 2.0e-3], [2.0e-3, 0.0]]),\n            \"L_y\": np.array([[0.0, -1.8e-3], [-1.8e-3, 0.0]]),\n            \"L_z\": np.array([[0.0, 1.6e-3], [1.6e-3, 0.0]]),\n            \"R_g\": np.array([0.0, 0.0, 0.0])\n        },\n        # Test case 2\n        {\n            \"N\": 2, \"Ne\": 2,\n            \"S\": np.array([[1.0, 0.05], [0.05, 1.0]]),\n            \"F\": np.array([[-0.7, -0.15], [-0.15, 0.2]]),\n            \"D_xx\": np.array([[3.1e-5, 0.2e-5], [0.2e-5, 2.9e-5]]),\n            \"D_yy\": np.array([[3.0e-5, 0.1e-5], [0.1e-5, 3.0e-5]]),\n            \"D_zz\": np.array([[3.2e-5, -0.1e-5], [-0.1e-5, 2.8e-5]]),\n            \"M_x\": np.array([[0.0, 1.5e-3], [1.5e-3, 0.0]]),\n            \"M_y\": np.array([[0.0, -1.1e-3], [-1.1e-3, 0.0]]),\n            \"M_z\": np.array([[0.0, 0.9e-3], [0.9e-3, 0.0]]),\n            \"L_x\": np.array([[0.0, 2.0e-3], [2.0e-3, 0.0]]),\n            \"L_y\": np.array([[0.0, -1.8e-3], [-1.8e-3, 0.0]]),\n            \"L_z\": np.array([[0.0, 1.6e-3], [1.6e-3, 0.0]]),\n            \"R_g\": np.array([1.0, -2.0, 0.5])\n        },\n        # Test case 3\n        {\n            \"N\": 1, \"Ne\": 2,\n            \"S\": np.array([[1.0]]),\n            \"F\": np.array([[-0.5]]),\n            \"D_xx\": np.array([[3.0e-5]]),\n            \"D_yy\": np.array([[3.0e-5]]),\n            \"D_zz\": np.array([[3.0e-5]]),\n            \"M_x\": np.array([[0.0]]), \"M_y\": np.array([[0.0]]), \"M_z\": np.array([[0.0]]),\n            \"L_x\": np.array([[0.0]]), \"L_y\": np.array([[0.0]]), \"L_z\": np.array([[0.0]]),\n            \"R_g\": np.array([0.0, 0.0, 0.0])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_shielding(\n            case[\"N\"], case[\"Ne\"], case[\"S\"], case[\"F\"],\n            case[\"D_xx\"], case[\"D_yy\"], case[\"D_zz\"],\n            case[\"M_x\"], case[\"M_y\"], case[\"M_z\"],\n            case[\"L_x\"], case[\"L_y\"], case[\"L_z\"],\n            case[\"R_g\"]\n        )\n        results.append(f\"{result:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2893981"}, {"introduction": "While GIAOs solve the gauge-origin problem, achieving high accuracy still depends critically on the quality of the underlying atomic orbital basis set. This exercise asks you to think like a practicing computational chemist, evaluating the strengths and weaknesses of different basis set families for shielding calculations. You will learn to distinguish between general-purpose basis sets and those specifically optimized for magnetic properties, a crucial skill for producing reliable results [@problem_id:2916491].", "problem": "A nuclear magnetic resonance (NMR) shielding tensor is defined in nonrelativistic electronic structure theory as the second derivative of the electronic ground-state energy with respect to an external homogeneous magnetic field and the magnetic dipole moment of a given nucleus. In Cartesian components, this reads\n$$\n\\sigma_{ab} = -\\left.\\frac{\\partial^2 E}{\\partial B_a\\,\\partial \\mu_b}\\right|_{\\mathbf{B}=\\mathbf{0},\\,\\boldsymbol{\\mu}=\\mathbf{0}},\n$$\nwhere $E$ is the Born–Oppenheimer electronic energy, $\\mathbf{B}$ is the external magnetic field, and $\\boldsymbol{\\mu}$ is the nuclear magnetic dipole moment. Within time-dependent linear response, one writes\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{dia}} + \\boldsymbol{\\sigma}^{\\mathrm{para}},\n$$\nwhere $\\boldsymbol{\\sigma}^{\\mathrm{dia}}$ is the diamagnetic contribution, expressible as a ground-state expectation value involving the vector potential, and $\\boldsymbol{\\sigma}^{\\mathrm{para}}$ is the paramagnetic contribution, which depends on virtual excitations (unoccupied orbital manifold) coupling to magnetic perturbations. In a complete basis, the tensor is gauge-origin invariant. In a finite atom-centered basis, gauge-origin artifacts arise unless one uses gauge-including atomic orbitals (GIAO, also called London orbitals), which incorporate a field-dependent phase to enforce correct translational properties. The basis must be sufficiently flexible in the near-nuclear region (radially tight $s/p$ functions to describe the cusp and core region that enter $\\boldsymbol{\\sigma}^{\\mathrm{dia}}$) and in angular and radial polarization of the valence and virtual spaces (to converge $\\boldsymbol{\\sigma}^{\\mathrm{para}}$), and may require diffuse functions to describe long-range magnetic response and currents, especially for electronegative atoms and anions.\n\nConsider computing both isotropic shieldings and shielding anisotropies for light main-group nuclei in small neutral organic molecules using gauge-including atomic orbitals at a density functional theory level. You must decide whether a Karlsruhe def2-TZVPP basis is sufficient relative to specialized Jensen polarization-consistent-for-shieldings (pcS-$n$) basis sets for achieving results close to the basis-set limit, and assess the role of diffuse and tight functions.\n\nWhich of the following statements are correct?\n\nA. For first-row nuclei in neutral organic molecules, def2-TZVPP used with gauge-including atomic orbitals at a typical density functional theory level often yields qualitatively reliable isotropic shieldings; however, Jensen pcS-$2$ generally achieves faster basis-set convergence for shieldings because it is optimized for the magnetic response problem (through reoptimized contractions, additional very tight functions, and balanced polarization), so pcS-$2$ is typically closer to the complete-basis result than def2-TZVPP of similar nominal valence $\\zeta$ quality.\n\nB. Diffuse functions have negligible impact on NMR shieldings because they primarily affect electric-dipole properties such as polarizabilities, not magnetic response; therefore, augmenting def2-TZVPP with diffuse functions (e.g., def2-TZVPPD) does not materially improve shieldings on oxygen or nitrogen compared to def2-TZVPP.\n\nC. Because shielding anisotropy is dominated by the diamagnetic term that depends only on occupied orbitals, adding more polarization functions to the virtual space brings little benefit; thus, a double-polarized triple-$\\zeta$ valence basis such as def2-TZVPP cannot be improved upon by optimized Jensen pcS-$n$ sets for anisotropy in first-row systems.\n\nD. Gauge-including atomic orbitals remove not only gauge-origin dependence but also basis-set incompleteness effects; consequently, even a double-$\\zeta$ basis is sufficient to produce numerically stable absolute shieldings.\n\nE. For heavier $p$-block nuclei beyond the second row, core–valence correlation and scalar relativistic effects dominate the error budget of absolute shieldings; therefore, specialized core–valence and relativistic-optimized basis sets (e.g., augmented correlation-consistent core–valence sets or relativistic adapted def2 variants) generally outperform a nonrelativistic def2-TZVPP for absolute shieldings, even when gauge-including atomic orbitals are used.\n\nSelect all that apply.", "solution": "The problem asks for an evaluation of several statements concerning the calculation of nuclear magnetic resonance (NMR) shielding tensors using density functional theory (DFT), gauge-including atomic orbitals (GIAO), and a comparison between Karlsruhe `def2-TZVPP` and Jensen `pcS-n` basis sets.\n\nFirst, a validation of the problem statement is required. The problem provides a correct definition of the nonrelativistic NMR shielding tensor, $\\sigma_{ab}$, as a second derivative property:\n$$\n\\sigma_{ab} = -\\left.\\frac{\\partial^2 E}{\\partial B_a\\,\\partial \\mu_b}\\right|_{\\mathbf{B}=\\mathbf{0},\\,\\boldsymbol{\\mu}=\\mathbf{0}}\n$$\nIt accurately decomposes the tensor into diamagnetic ($\\boldsymbol{\\sigma}^{\\mathrm{dia}}$) and paramagnetic ($\\boldsymbol{\\sigma}^{\\mathrm{para}}$) contributions. The description of the gauge-origin problem in finite basis sets and its resolution via GIAOs is also correct. The general requirements for basis sets—tight functions for the core region influencing $\\boldsymbol{\\sigma}^{\\mathrm{dia}}$, polarization functions for the valence and virtual space influencing $\\boldsymbol{\\sigma}^{\\mathrm{para}}$, and diffuse functions for delocalized systems—are standard concepts in computational chemistry. The problem context, comparing specific, well-known basis set families for a defined task, is scientifically sound, well-posed, and objective. There are no scientific or factual flaws, ambiguities, or contradictions in the problem setup. The problem is valid.\n\nWe now proceed to evaluate each statement individually.\n\n**Analysis of Statement A:**\nThis statement claims that for first-row nuclei, `def2-TZVPP` with GIAOs yields \"qualitatively reliable\" isotropic shieldings, but that the specialized Jensen `pcS-2` basis set provides faster convergence and results that are typically closer to the complete-basis-set (CBS) limit.\n\nThe `def2-TZVPP` basis is a triple-$\\zeta$ valence set with two sets of polarization functions. For many applications, this level of basis set provides a good balance of accuracy and computational cost, and for NMR shieldings of light elements in simple molecules, it often yields results that are qualitatively correct (e.g., correct ordering of chemical shifts). This part of the statement is reasonable.\n\nThe core of the statement is the comparison with the `pcS-n` basis sets. These sets, developed by Frank Jensen, are *property-optimized*, meaning their exponents and contraction coefficients have been explicitly optimized to reproduce NMR shielding constants, not the total electronic energy. The optimization procedure for `pcS-n` basis sets ensures a balanced description of all aspects critical to the shielding tensor:\n$1$. The core region, by including very tight $s$- and $p$-functions, which is essential for the diamagnetic term $\\boldsymbol{\\sigma}^{\\mathrm{dia}} \\propto \\langle \\Psi_0 | r^{-1} | \\Psi_0 \\rangle$.\n$2$. The valence and virtual space, by a careful optimization of polarization functions, which is critical for the paramagnetic term $\\boldsymbol{\\sigma}^{\\mathrm{para}}$ that involves coupling between occupied and virtual orbitals.\n\nBecause `pcS-n` sets are specifically tailored for this physical property, they are known to converge to the CBS limit for shieldings much more systematically and rapidly than general-purpose, energy-optimized basis sets like `def2-TZVPP`. A `pcS-2` basis, which is of nominal triple-$\\zeta$ quality, will almost invariably produce shielding constants closer to the CBS limit than `def2-TZVPP`. Therefore, the statement is a correct representation of the performance hierarchy of these basis sets for NMR calculations.\n\nVerdict for A: **Correct**.\n\n**Analysis of Statement B:**\nThis statement asserts that diffuse functions have a \"negligible\" impact on NMR shieldings and thus augmenting `def2-TZVPP` to `def2-TZVPPD` does not \"materially improve\" results for atoms like oxygen or nitrogen.\n\nThis assertion is a gross oversimplification. The paramagnetic shielding term $\\boldsymbol{\\sigma}^{\\mathrm{para}}$ involves a sum over excited states. For systems with low-lying virtual orbitals, especially in the presence of electronegative atoms (like N and O), anions, or delocalized $\\pi$-systems, the electronic density is more spatially extended. Diffuse functions are required to accurately describe this extended density and the low-energy part of the virtual orbital manifold. While their impact on shieldings might be less dramatic than on electric polarizabilities, it is certainly not negligible. For electronegative atoms in many chemical environments, the inclusion of diffuse functions can change calculated shieldings by several parts per million (ppm), which is a material improvement in the context of achieving high accuracy. The problem's own preamble correctly notes that diffuse functions \"may require diffuse functions to describe long-range magnetic response and currents, especially for electronegative atoms and anions.\" The statement directly contradicts this by claiming their effect is negligible.\n\nVerdict for B: **Incorrect**.\n\n**Analysis of Statement C:**\nThis statement claims that shielding anisotropy is dominated by the diamagnetic term, and consequently, polarization functions for the virtual space are of little benefit.\n\nThis is fundamentally wrong. The diamagnetic term, $\\boldsymbol{\\sigma}^{\\mathrm{dia}}$, arises from the Larmor precession of the electron cloud and is approximately proportional to the spherically symmetric core density. As such, it is largely isotropic and contributes mainly a constant offset to all diagonal elements of the shielding tensor. The shielding *anisotropy*—the difference between the principal components of the tensor—is overwhelmingly dominated by the *paramagnetic* term, $\\boldsymbol{\\sigma}^{\\mathrm{para}}$. This term arises from the mixing of occupied and virtual orbitals by the magnetic field, a process that is highly directional and dependent on molecular symmetry and bonding (e.g., $\\pi$-bonds, lone pairs). Because $\\boldsymbol{\\sigma}^{\\mathrm{para}}$ is computed via response theory involving a sum over virtual orbitals, its accurate calculation is critically dependent on a flexible basis set capable of describing the response of the electron density. This flexibility is provided precisely by polarization functions. An improved description of the virtual space through more and better-optimized polarization functions, such as those in the `pcS-n` sets, is crucial for converging the shielding anisotropy. The claim that `def2-TZVPP` cannot be improved upon for this property is therefore false.\n\nVerdict for C: **Incorrect**.\n\n**Analysis of Statement D:**\nThis statement claims that GIAOs remove both gauge-origin dependence and basis-set incompleteness error (BSIE), making even a double-$\\zeta$ (DZ) basis sufficient.\n\nThis statement conflates two entirely different types of error. GIAOs solve the gauge-origin problem. In a calculation with a finite basis set, the calculated shielding value would otherwise depend on the arbitrary choice of the coordinate system's origin (the gauge origin). GIAOs build the gauge-origin dependence directly into the basis functions in a physically correct way, making the final result independent of this arbitrary choice. However, GIAOs do *nothing* to correct for the inherent inadequacy of a small basis set. The BSIE is the error resulting from the inability of a finite set of functions to represent the exact wavefunction. A double-$\\zeta$ basis, such as `def2-SVP`, lacks the necessary flexibility (sufficient tight functions, polarization functions, diffuse functions) to accurately describe either the core density for $\\boldsymbol{\\sigma}^{\\mathrm{dia}}$ or the occupied-virtual mixing for $\\boldsymbol{\\sigma}^{\\mathrm{para}}$. While the result from a DZ-GIAO calculation is gauge-invariant, it is still a poor approximation of the true shielding value, and is far from the CBS limit. Therefore, the statement is based on a false premise.\n\nVerdict for D: **Incorrect**.\n\n**Analysis of Statement E:**\nThis statement posits that for heavier $p$-block nuclei (third row and beyond), core-valence correlation and scalar relativistic effects are the dominant sources of error, making specialized basis sets superior to a nonrelativistic `def2-TZVPP` basis.\n\nThis statement is entirely correct. For heavy atoms, two effects which are often negligible for first-row elements become critically important:\n$1$. **Relativistic Effects**: The high nuclear charge causes inner-shell electrons to move at relativistic speeds. This leads to a relativistic contraction of $s$- and $p$-orbitals and an expansion of $d$- and $f$-orbitals. These changes profoundly affect the electronic structure near the nucleus, which has a very large effect on NMR shieldings (often referred to as the \"heavy-atom effect\"). Scalar relativistic corrections are the minimum requirement for quantitative accuracy.\n$2$. **Core-Valence Correlation**: The frozen-core approximation is less valid for heavier elements. Electron correlation between the valence and outer-core electrons can significantly influence properties of the valence shell.\n\nThese two effects can alter calculated absolute shieldings by hundreds or thousands of ppm, an error far larger than the typical BSIE for a triple-$\\zeta$ basis or errors from the DFT functional. Consequently, high-accuracy calculations on heavy nuclei mandate the use of a relativistic Hamiltonian (e.g., Douglas-Kroll-Hess or Zeroth-Order Regular Approximation) paired with basis sets specifically optimized for such calculations (e.g., relativistically contracted basis sets like `def2-TZVPP-DKH`). To account for core-valence correlation, one must use basis sets containing additional tight functions, such as the `cc-pCVXZ` family. A standard, nonrelativistic `def2-TZVPP` basis used in a nonrelativistic calculation is completely inadequate for this task.\n\nVerdict for E: **Correct**.", "answer": "$$\\boxed{AE}$$", "id": "2916491"}]}