{"hands_on_practices": [{"introduction": "This first practice provides a concrete starting point for understanding the ONIOM method's structure. By applying the standard three-layer ONIOM energy expression to a set of pre-computed values for a hypothetical system [@problem_id:2910443], you will gain direct experience in assembling the final energy from calculations at different levels of theory. This exercise illuminates how the subtractive scheme works in practice and how the total energy can be conceptually decomposed into chemically intuitive components.", "problem": "A reaction center embedded in a protein pocket is partitioned into three nested regions for an Our own N-layered Integrated molecular Orbital and Molecular mechanics (ONIOM) three-layer scheme: a high-level quantum mechanics core $\\mathrm{M1}$ (model-1), an intermediate shell $\\mathrm{M2}\\setminus \\mathrm{M1}$ (the portion of the medium region not in $\\mathrm{M1}$), and an outer environment $\\mathrm{E}$, with the real system $\\mathrm{R} = \\mathrm{M2} \\cup \\mathrm{E}$ and $\\mathrm{M1} \\subset \\mathrm{M2} \\subset \\mathrm{R}$. All energies are evaluated at a common, fixed geometry under the Born–Oppenheimer approximation. You are given single-point energies (in kJ/mol) computed at three electronic-structure levels: high ($\\mathrm{H}$), medium ($\\mathrm{M}$), and low ($\\mathrm{L}$), for the subsystems indicated:\n- $E_{\\mathrm{H}}(\\mathrm{M1}) = -845.213$.\n- $E_{\\mathrm{M}}(\\mathrm{M1}) = -832.476$.\n- $E_{\\mathrm{M}}(\\mathrm{M2}) = -910.592$.\n- $E_{\\mathrm{M}}(\\mathrm{M2}\\setminus \\mathrm{M1}) = -78.311$.\n- $E_{\\mathrm{L}}(\\mathrm{M2}) = -905.881$.\n- $E_{\\mathrm{L}}(\\mathrm{E}) = -320.447$.\n- $E_{\\mathrm{L}}(\\mathrm{R}) = -1241.908$.\n\nStarting only from the following fundamental bases:\n- Additivity and interaction definition at a given level $X \\in \\{\\mathrm{H}, \\mathrm{M}, \\mathrm{L}\\}$: the energy of a union of disjoint regions can be expressed as the sum of their isolated energies plus an interaction energy, and this identity determines the interaction contribution by difference.\n- The subtractive ONIOM construction combines energies from nested regions across levels to approximate the real-system high-level energy.\n\n(a) Derive a decomposition of the three-layer ONIOM total energy into the sum of intra-model, intra-environment, and interaction terms, clearly identifying which terms are carried at the high, medium, and low levels.\n\n(b) Using the given data, evaluate numerically the three-layer ONIOM total energy for the real system and provide the final value in kJ/mol. Round your answer to four significant figures and express the final energy in kJ/mol. Do not include any units in your final boxed answer.", "solution": "The problem will first be subjected to rigorous validation before any attempt at a solution.\n\n### Step 1: Extract Givens\nThe problem statement provides the following explicit data and definitions:\n- System partitioning: A real system $\\mathrm{R}$ is partitioned into three nested regions. A high-level core $\\mathrm{M1}$, an intermediate region such that the medium-level model is $\\mathrm{M2}$, and an outer environment $\\mathrm{E}$. The relationships are $\\mathrm{M1} \\subset \\mathrm{M2} \\subset \\mathrm{R}$ and $\\mathrm{R} = \\mathrm{M2} \\cup \\mathrm{E}$. The partition defines three disjoint regions: $\\mathrm{M1}$, the intermediate shell $\\mathrm{M2}\\setminus \\mathrm{M1}$, and the environment $\\mathrm{E}$.\n- Electronic-structure levels: High ($\\mathrm{H}$), Medium ($\\mathrm{M}$), and Low ($\\mathrm{L}$).\n- Single-point energies (in kJ/mol):\n  - $E_{\\mathrm{H}}(\\mathrm{M1}) = -845.213$\n  - $E_{\\mathrm{M}}(\\mathrm{M1}) = -832.476$\n  - $E_{\\mathrm{M}}(\\mathrm{M2}) = -910.592$\n  - $E_{\\mathrm{M}}(\\mathrm{M2}\\setminus \\mathrm{M1}) = -78.311$\n  - $E_{\\mathrm{L}}(\\mathrm{M2}) = -905.881$\n  - $E_{\\mathrm{L}}(\\mathrm{E}) = -320.447$\n  - $E_{\\mathrm{L}}(\\mathrm{R}) = -1241.908$\n- Fundamental principles:\n  - Additivity and interaction: The energy of a union of disjoint regions is the sum of their isolated energies plus an interaction energy, $E(A \\cup B) = E(A) + E(B) + E_{\\text{int}}(A, B)$.\n  - The subtractive ONIOM construction is used to approximate the real-system high-level energy.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed based on the established criteria.\n\n- **Scientifically Grounded**: The problem describes a standard three-layer ONIOM (Our own N-layered Integrated molecular Orbital and Molecular mechanics) calculation, a widely used and validated multiscale method in quantum chemistry. The energy values are physically reasonable for molecular systems. The principles of additivity and subtractive extrapolation are cornerstones of this method.\n- **Well-Posed**: The problem is well-posed. It provides a complete set of data and clear definitions required to derive the requested energy decomposition and to compute the numerical result. The question is unambiguous.\n- **Objective**: The problem is stated in precise, objective, technical language, free from any subjective or speculative content.\n- **Internal Consistency**: The given data are consistent. For example, at the medium level $\\mathrm{M}$, the system $\\mathrm{M2}$ is the union of disjoint regions $\\mathrm{M1}$ and $\\mathrm{M2}\\setminus \\mathrm{M1}$. The energy of the union is $E_{\\mathrm{M}}(\\mathrm{M2}) = E_{\\mathrm{M}}(\\mathrm{M1}) + E_{\\mathrm{M}}(\\mathrm{M2}\\setminus \\mathrm{M1}) + E_{\\mathrm{M, int}}(\\mathrm{M1}, \\mathrm{M2}\\setminus \\mathrm{M1})$. Using the provided data, we have $-910.592 = -832.476 + (-78.311) + E_{\\mathrm{M, int}}(\\mathrm{M1}, \\mathrm{M2}\\setminus \\mathrm{M1})$, which implies an interaction energy $E_{\\mathrm{M, int}} = 0.195 \\, \\text{kJ/mol}$. This is a small, physically plausible value, confirming the internal consistency of the provided energies. The problem does not contain any contradictions or missing information pertinent to its solution.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, objective, and internally consistent. It is therefore deemed **valid**. A full solution will be provided.\n\n### Solution\n\n(a) Derivation of the three-layer ONIOM energy decomposition.\n\nThe objective of the ONIOM method is to approximate the energy of the real system, $\\mathrm{R}$, at the highest level of theory, $\\mathrm{H}$. For a three-layer scheme ($\\mathrm{L}$: Low, $\\mathrm{M}$: Medium, $\\mathrm{H}$: High) with nested regions $\\mathrm{M1} \\subset \\mathrm{M2} \\subset \\mathrm{R}$, the total ONIOM energy, $E_{\\mathrm{ONIOM}}$, is constructed using a subtractive extrapolation scheme. The fundamental expression is:\n$$E_{\\mathrm{ONIOM}} = E_{\\mathrm{L}}(\\mathrm{R}) + [E_{\\mathrm{M}}(\\mathrm{M2}) - E_{\\mathrm{L}}(\\mathrm{M2})] + [E_{\\mathrm{H}}(\\mathrm{M1}) - E_{\\mathrm{M}}(\\mathrm{M1})]$$\nThis equation begins with the energy of the entire real system ($\\mathrm{R}$) at the low level ($\\mathrm{L}$). The first bracketed term, $[E_{\\mathrm{M}}(\\mathrm{M2}) - E_{\\mathrm{L}}(\\mathrm{M2})]$, corrects the energy of the medium-sized model system ($\\mathrm{M2}$) from the low level to the medium level. The second bracketed term, $[E_{\\mathrm{H}}(\\mathrm{M1}) - E_{\\mathrm{M}}(\\mathrm{M1})]$, further corrects the energy of the smallest core model system ($\\mathrm{M1}$) from the medium level to the high level.\n\nTo decompose this total energy into intra-model, intra-environment, and interaction terms, we can rearrange the expression. This rearrangement clarifies how contributions from different parts of the system are treated at different levels of theory, which corresponds to the so-called \"mechanical embedding\" scheme.\n$$E_{\\mathrm{ONIOM}} = [E_{\\mathrm{H}}(\\mathrm{M1})] + [E_{\\mathrm{M}}(\\mathrm{M2}) - E_{\\mathrm{M}}(\\mathrm{M1})] + [E_{\\mathrm{L}}(\\mathrm{R}) - E_{\\mathrm{L}}(\\mathrm{M2})]$$\nWe can now analyze each of these three terms based on the given partitioning and the additivity principle. The system consists of three disjoint regions: the core $\\mathrm{M1}$, the intermediate shell $\\mathrm{I} = \\mathrm{M2}\\setminus \\mathrm{M1}$, and the environment $\\mathrm{E}$.\n\n1.  **Term 1**: $E_{\\mathrm{H}}(\\mathrm{M1})$\n    This term is the energy of the core model system $\\mathrm{M1}$ calculated at the high level, $\\mathrm{H}$. This is a pure **intra-model** energy term for the core region.\n\n2.  **Term 2**: $E_{\\mathrm{M}}(\\mathrm{M2}) - E_{\\mathrm{M}}(\\mathrm{M1})$\n    This term represents the effect of adding the intermediate shell $\\mathrm{I} = \\mathrm{M2}\\setminus \\mathrm{M1}$ to the core $\\mathrm{M1}$, with all energies evaluated at the medium level, $\\mathrm{M}$. Using the additivity principle, the energy of the union $\\mathrm{M2} = \\mathrm{M1} \\cup (\\mathrm{M2}\\setminus \\mathrm{M1})$ is given by $E_{\\mathrm{M}}(\\mathrm{M2}) = E_{\\mathrm{M}}(\\mathrm{M1}) + E_{\\mathrm{M}}(\\mathrm{M2}\\setminus \\mathrm{M1}) + E_{\\mathrm{M, int}}(\\mathrm{M1}, \\mathrm{M2}\\setminus \\mathrm{M1})$.\n    Therefore, the term can be expanded as:\n    $$E_{\\mathrm{M}}(\\mathrm{M2}) - E_{\\mathrm{M}}(\\mathrm{M1}) = E_{\\mathrm{M}}(\\mathrm{M2}\\setminus \\mathrm{M1}) + E_{\\mathrm{M, int}}(\\mathrm{M1}, \\mathrm{M2}\\setminus \\mathrm{M1})$$\n    This expression comprises the **intra-model** energy of the intermediate shell and the **interaction** energy between the core and the intermediate shell, both calculated at the medium level $\\mathrm{M}$.\n\n3.  **Term 3**: $E_{\\mathrm{L}}(\\mathrm{R}) - E_{\\mathrm{L}}(\\mathrm{M2})$\n    This term represents the effect of adding the environment $\\mathrm{E}$ to the full model system $\\mathrm{M2}$, with all energies evaluated at the low level, $\\mathrm{L}$. Since the real system is $\\mathrm{R} = \\mathrm{M2} \\cup \\mathrm{E}$, the additivity principle gives $E_{\\mathrm{L}}(\\mathrm{R}) = E_{\\mathrm{L}}(\\mathrm{M2}) + E_{\\mathrm{L}}(\\mathrm{E}) + E_{\\mathrm{L, int}}(\\mathrm{M2}, \\mathrm{E})$.\n    Therefore, the term can be expanded as:\n    $$E_{\\mathrm{L}}(\\mathrm{R}) - E_{\\mathrm{L}}(\\mathrm{M2}) = E_{\\mathrm{L}}(\\mathrm{E}) + E_{\\mathrm{L, int}}(\\mathrm{M2}, \\mathrm{E})$$\n    This expression comprises the **intra-environment** energy of region $\\mathrm{E}$ and the **interaction** energy between the model system $\\mathrm{M2}$ and the environment $\\mathrm{E}$, both calculated at the low level $\\mathrm{L}$.\n\nIn summary, the total ONIOM energy is decomposed as follows:\n$$E_{\\mathrm{ONIOM}} = \\underbrace{E_{\\mathrm{H}}(\\mathrm{M1})}_{\\text{H-level}} + \\underbrace{[E_{\\mathrm{M}}(\\mathrm{M2}\\setminus \\mathrm{M1}) + E_{\\mathrm{M, int}}(\\mathrm{M1}, \\mathrm{M2}\\setminus \\mathrm{M1})]}_{\\text{M-level}} + \\underbrace{[E_{\\mathrm{L}}(\\mathrm{E}) + E_{\\mathrm{L, int}}(\\mathrm{M2}, \\mathrm{E})]}_{\\text{L-level}}$$\nThis decomposition shows that the total energy is a sum of contributions from different regions, where the core region is treated at the high level, the intermediate region and its interaction with the core are treated at the medium level, and the outer environment and its interaction with the model system are treated at the low level.\n\n(b) Numerical evaluation of the three-layer ONIOM total energy.\n\nWe use the standard subtractive formula and substitute the provided energy values.\n$$E_{\\mathrm{ONIOM}} = E_{\\mathrm{L}}(\\mathrm{R}) + [E_{\\mathrm{M}}(\\mathrm{M2}) - E_{\\mathrm{L}}(\\mathrm{M2})] + [E_{\\mathrm{H}}(\\mathrm{M1}) - E_{\\mathrm{M}}(\\mathrm{M1})]$$\nThe given values are:\n- $E_{\\mathrm{L}}(\\mathrm{R}) = -1241.908 \\, \\text{kJ/mol}$\n- $E_{\\mathrm{M}}(\\mathrm{M2}) = -910.592 \\, \\text{kJ/mol}$\n- $E_{\\mathrm{L}}(\\mathrm{M2}) = -905.881 \\, \\text{kJ/mol}$\n- $E_{\\mathrm{H}}(\\mathrm{M1}) = -845.213 \\, \\text{kJ/mol}$\n- $E_{\\mathrm{M}}(\\mathrm{M1}) = -832.476 \\, \\text{kJ/mol}$\n\nFirst, we calculate the two correction terms:\nThe medium-level correction for the $\\mathrm{M2}$ region is:\n$$\\Delta E_{\\mathrm{M/L}} = E_{\\mathrm{M}}(\\mathrm{M2}) - E_{\\mathrm{L}}(\\mathrm{M2}) = -910.592 - (-905.881) = -4.711 \\, \\text{kJ/mol}$$\nThe high-level correction for the $\\mathrm{M1}$ region is:\n$$\\Delta E_{\\mathrm{H/M}} = E_{\\mathrm{H}}(\\mathrm{M1}) - E_{\\mathrm{M}}(\\mathrm{M1}) = -845.213 - (-832.476) = -12.737 \\, \\text{kJ/mol}$$\n\nNow, we sum the base energy and the correction terms to obtain the total ONIOM energy:\n$$E_{\\mathrm{ONIOM}} = E_{\\mathrm{L}}(\\mathrm{R}) + \\Delta E_{\\mathrm{M/L}} + \\Delta E_{\\mathrm{H/M}}$$\n$$E_{\\mathrm{ONIOM}} = -1241.908 + (-4.711) + (-12.737)$$\n$$E_{\\mathrm{ONIOM}} = -1241.908 - 4.711 - 12.737 = -1259.356 \\, \\text{kJ/mol}$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value is $-1259.356$. The four most significant digits are $1, 2, 5, 9$. The following digit is $3$, which is less than $5$, so we round down (i.e., truncate).\nThe final energy is $-1259$ kJ/mol. The remaining given values, $E_{\\mathrm{M}}(\\mathrm{M2}\\setminus \\mathrm{M1})$ and $E_{\\mathrm{L}}(\\mathrm{E})$, were not required for the final numerical calculation but were used to confirm the internal consistency of the problem statement and are relevant to the conceptual decomposition in part (a).", "answer": "$$\n\\boxed{-1259}\n$$", "id": "2910443"}, {"introduction": "After mastering the basic energy calculation, it is crucial to understand the implications of the method's inherent approximations. This practice delves into the connection between ONIOM energies and chemical kinetics, a primary application area [@problem_id:2910502]. You will use the principles of Transition State Theory to derive how model truncation errors in the ONIOM energy of reactant and transition states directly propagate to the calculated reaction rate constant, highlighting the importance of error cancellation.", "problem": "A chemical reaction proceeds from a reactant state to a transition state on a potential energy surface. Consider modeling this reaction with the Our own N-layered Integrated Molecular Orbital and Molecular Mechanics (ONIOM) multilayer method using a bi-layer scheme in which the full system is treated at a low level of theory and a properly embedded model subsystem is treated at a high level of theory. Let the ONIOM energy of a state $X \\in \\{\\mathrm{R}, \\mathrm{TS}\\}$ be defined by the standard combination rule\n$$\nE_{\\mathrm{ONIOM}}(X) \\equiv E_{\\mathrm{L}}^{\\mathrm{full}}(X) + \\left[E_{\\mathrm{H}}^{\\mathrm{model}}(X) - E_{\\mathrm{L}}^{\\mathrm{model}}(X)\\right],\n$$\nwhere $E_{\\mathrm{L}}^{\\mathrm{full}}(X)$ is the low-level energy of the full system, $E_{\\mathrm{H}}^{\\mathrm{model}}(X)$ is the high-level energy of the model subsystem, and $E_{\\mathrm{L}}^{\\mathrm{model}}(X)$ is the low-level energy of the model subsystem. Define the high-level correction at state $X$ as $\\Delta c(X) \\equiv E_{\\mathrm{H}}^{\\mathrm{model}}(X) - E_{\\mathrm{L}}^{\\mathrm{model}}(X)$, so that $E_{\\mathrm{ONIOM}}(X) = E_{\\mathrm{L}}^{\\mathrm{full}}(X) + \\Delta c(X)$. Assume that harmonic zero-point and thermal contributions to the Gibbs free energy are obtained consistently at the low level on the full system for both states, and that the high-level correction $\\Delta c(X)$ is an energetic shift that does not change the partition-function-derived entropies. Under these assumptions, the ONIOM Gibbs free energy of state $X$ at temperature $T$ can be written as\n$$\nG_{\\mathrm{ONIOM}}(X;T) = G_{\\mathrm{L}}^{\\mathrm{full}}(X;T) + \\Delta c(X),\n$$\nwhere $G_{\\mathrm{L}}^{\\mathrm{full}}(X;T)$ is the low-level full-system Gibbs free energy.\n\nLet the true target be the high-level free energy on the full system, $G_{\\mathrm{true}}(X;T)$. Let the true high-level correction on the full system be $\\Delta c_{\\mathrm{true}}(X) \\equiv E_{\\mathrm{H}}^{\\mathrm{full}}(X) - E_{\\mathrm{L}}^{\\mathrm{full}}(X)$, so that $G_{\\mathrm{true}}(X;T) = G_{\\mathrm{L}}^{\\mathrm{full}}(X;T) + \\Delta c_{\\mathrm{true}}(X)$ under the same thermodynamic treatment. Define the model-truncation error in the high-level correction at state $X$ by $\\delta_{X} \\equiv \\Delta c(X) - \\Delta c_{\\mathrm{true}}(X)$.\n\nUsing these definitions and starting from the foundations of the ONIOM combination rule and Transition State Theory (TST), perform the following:\n\n- Derive the ONIOM barrier height for the Gibbs free energy, $\\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T) \\equiv G_{\\mathrm{ONIOM}}(\\mathrm{TS};T) - G_{\\mathrm{ONIOM}}(\\mathrm{R};T)$, in terms of $G_{\\mathrm{L}}^{\\mathrm{full}}$, $\\Delta c(\\mathrm{TS})$, and $\\Delta c(\\mathrm{R})$.\n- Express the barrier error $\\varepsilon^{\\ddagger}(T) \\equiv \\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T) - \\Delta G_{\\mathrm{true}}^{\\ddagger}(T)$ in terms of $\\delta_{\\mathrm{TS}}$ and $\\delta_{\\mathrm{R}}$.\n- Using the Eyring form of Transition State Theory, $k(T) = \\dfrac{k_{B} T}{h} \\dfrac{Q^{\\ddagger}(T)}{Q_{\\mathrm{R}}(T)} \\exp\\!\\left(-\\dfrac{\\Delta G^{\\ddagger}(T)}{k_{B} T}\\right)$, where $k_{B}$ is the Boltzmann constant, $h$ is Planck’s constant, and $Q^{\\ddagger}(T)$ and $Q_{\\mathrm{R}}(T)$ are appropriate partition functions for the transition state and reactant, respectively, assume that the ratio $\\dfrac{Q^{\\ddagger}(T)}{Q_{\\mathrm{R}}(T)}$ and any transmission coefficient are identical between the ONIOM and true high-level descriptions. Under this assumption, determine how the barrier error $\\varepsilon^{\\ddagger}(T)$ propagates to the rate constant.\n\nWhat is the closed-form analytic expression for the ratio $k_{\\mathrm{ONIOM}}(T)/k_{\\mathrm{true}}(T)$ in terms of $k_{B}$, $T$, $\\delta_{\\mathrm{TS}}$, and $\\delta_{\\mathrm{R}}$? Provide a single simplified expression. No numerical evaluation is required, and no units should be included in the final expression.", "solution": "The problem statement is submitted for validation.\n\n**Step 1: Extract Givens**\nThe following definitions and assumptions are provided verbatim from the problem statement:\n- The ONIOM energy of a state $X \\in \\{\\mathrm{R}, \\mathrm{TS}\\}$ is:\n$$E_{\\mathrm{ONIOM}}(X) \\equiv E_{\\mathrm{L}}^{\\mathrm{full}}(X) + \\left[E_{\\mathrm{H}}^{\\mathrm{model}}(X) - E_{\\mathrm{L}}^{\\mathrm{model}}(X)\\right]$$\n- The high-level correction at state $X$ is:\n$$\\Delta c(X) \\equiv E_{\\mathrm{H}}^{\\mathrm{model}}(X) - E_{\\mathrm{L}}^{\\mathrm{model}}(X)$$\n- The ONIOM energy can be written as:\n$$E_{\\mathrm{ONIOM}}(X) = E_{\\mathrm{L}}^{\\mathrm{full}}(X) + \\Delta c(X)$$\n- The ONIOM Gibbs free energy of state $X$ at temperature $T$ is:\n$$G_{\\mathrm{ONIOM}}(X;T) = G_{\\mathrm{L}}^{\\mathrm{full}}(X;T) + \\Delta c(X)$$\n- This form assumes harmonic zero-point and thermal contributions are obtained at the low level on the full system and that $\\Delta c(X)$ is an energetic shift that does not affect entropy.\n- The true target high-level free energy on the full system is:\n$$G_{\\mathrm{true}}(X;T) = G_{\\mathrm{L}}^{\\mathrm{full}}(X;T) + \\Delta c_{\\mathrm{true}}(X)$$\n- The true high-level correction on the full system is:\n$$\\Delta c_{\\mathrm{true}}(X) \\equiv E_{\\mathrm{H}}^{\\mathrm{full}}(X) - E_{\\mathrm{L}}^{\\mathrm{full}}(X)$$\n- The model-truncation error in the high-level correction at state $X$ is:\n$$\\delta_{X} \\equiv \\Delta c(X) - \\Delta c_{\\mathrm{true}}(X)$$\n- The ONIOM Gibbs free energy barrier is:\n$$\\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T) \\equiv G_{\\mathrm{ONIOM}}(\\mathrm{TS};T) - G_{\\mathrm{ONIOM}}(\\mathrm{R};T)$$\n- The barrier error is:\n$$\\varepsilon^{\\ddagger}(T) \\equiv \\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T) - \\Delta G_{\\mathrm{true}}^{\\ddagger}(T)$$\n- The Eyring form of Transition State Theory gives the rate constant as:\n$$k(T) = \\dfrac{k_{B} T}{h} \\dfrac{Q^{\\ddagger}(T)}{Q_{\\mathrm{R}}(T)} \\exp\\!\\left(-\\dfrac{\\Delta G^{\\ddagger}(T)}{k_{B} T}\\right)$$\n- An assumption is made that the ratio of partition functions $\\dfrac{Q^{\\ddagger}(T)}{Q_{\\mathrm{R}}(T)}$ is identical between the ONIOM and true high-level descriptions.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is subjected to critical evaluation.\n- **Scientific Grounding**: The problem is firmly based on established principles of quantum chemistry (the ONIOM method) and chemical kinetics (Transition State Theory, specifically the Eyring equation). The definitions and equations provided are standard in the field. The setup is scientifically realistic.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary definitions and a clear set of assumptions. The questions posed are specific and lead to a unique, meaningful solution through logical derivation.\n- **Objectivity**: The language is precise, mathematical, and free of subjective or ambiguous terminology.\nThe problem does not violate any of the criteria for invalidity. It is a formal, self-contained, and scientifically sound problem in theoretical chemistry.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be derived.\n\nThe derivation proceeds in three parts as requested.\n\n**Part 1: Derivation of the ONIOM Barrier Height**\nThe Gibbs free energy barrier within the ONIOM framework, $\\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T)$, is defined as the difference between the ONIOM Gibbs free energy of the transition state (TS) and the reactant (R).\n$$\n\\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T) \\equiv G_{\\mathrm{ONIOM}}(\\mathrm{TS};T) - G_{\\mathrm{ONIOM}}(\\mathrm{R};T)\n$$\nWe substitute the given expression for the ONIOM Gibbs free energy, $G_{\\mathrm{ONIOM}}(X;T) = G_{\\mathrm{L}}^{\\mathrm{full}}(X;T) + \\Delta c(X)$, for both the transition state and the reactant:\n$$\n\\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T) = \\left[ G_{\\mathrm{L}}^{\\mathrm{full}}(\\mathrm{TS};T) + \\Delta c(\\mathrm{TS}) \\right] - \\left[ G_{\\mathrm{L}}^{\\mathrm{full}}(\\mathrm{R};T) + \\Delta c(\\mathrm{R}) \\right]\n$$\nRearranging the terms by grouping the full-system low-level energies and the high-level corrections gives the desired expression:\n$$\n\\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T) = \\left[ G_{\\mathrm{L}}^{\\mathrm{full}}(\\mathrm{TS};T) - G_{\\mathrm{L}}^{\\mathrm{full}}(\\mathrm{R};T) \\right] + \\left[ \\Delta c(\\mathrm{TS}) - \\Delta c(\\mathrm{R}) \\right]\n$$\nThis expression separates the barrier into a component computed at the low level of theory for the full system and a correction derived from the difference in high-level corrections between the transition state and the reactant.\n\n**Part 2: Expression for the Barrier Error**\nThe barrier error, $\\varepsilon^{\\ddagger}(T)$, is defined as the difference between the ONIOM barrier and the true barrier, $\\Delta G_{\\mathrm{true}}^{\\ddagger}(T)$.\n$$\n\\varepsilon^{\\ddagger}(T) \\equiv \\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T) - \\Delta G_{\\mathrm{true}}^{\\ddagger}(T)\n$$\nFirst, we must express the true barrier, $\\Delta G_{\\mathrm{true}}^{\\ddagger}(T)$, using its definition:\n$$\n\\Delta G_{\\mathrm{true}}^{\\ddagger}(T) \\equiv G_{\\mathrm{true}}(\\mathrm{TS};T) - G_{\\mathrm{true}}(\\mathrm{R};T)\n$$\nUsing the provided expression for the true Gibbs free energy, $G_{\\mathrm{true}}(X;T) = G_{\\mathrm{L}}^{\\mathrm{full}}(X;T) + \\Delta c_{\\mathrm{true}}(X)$:\n$$\n\\Delta G_{\\mathrm{true}}^{\\ddagger}(T) = \\left[ G_{\\mathrm{L}}^{\\mathrm{full}}(\\mathrm{TS};T) + \\Delta c_{\\mathrm{true}}(\\mathrm{TS}) \\right] - \\left[ G_{\\mathrm{L}}^{\\mathrm{full}}(\\mathrm{R};T) + \\Delta c_{\\mathrm{true}}(\\mathrm{R}) \\right]\n$$\n$$\n\\Delta G_{\\mathrm{true}}^{\\ddagger}(T) = \\left[ G_{\\mathrm{L}}^{\\mathrm{full}}(\\mathrm{TS};T) - G_{\\mathrm{L}}^{\\mathrm{full}}(\\mathrm{R};T) \\right] + \\left[ \\Delta c_{\\mathrm{true}}(\\mathrm{TS}) - \\Delta c_{\\mathrm{true}}(\\mathrm{R}) \\right]\n$$\nNow, we substitute the expressions for $\\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T)$ and $\\Delta G_{\\mathrm{true}}^{\\ddagger}(T)$ into the definition of the error $\\varepsilon^{\\ddagger}(T)$:\n$$\n\\varepsilon^{\\ddagger}(T) = \\left( \\left[ G_{\\mathrm{L}}^{\\mathrm{full}}(\\mathrm{TS};T) - G_{\\mathrm{L}}^{\\mathrm{full}}(\\mathrm{R};T) \\right] + \\left[ \\Delta c(\\mathrm{TS}) - \\Delta c(\\mathrm{R}) \\right] \\right) - \\left( \\left[ G_{\\mathrm{L}}^{\\mathrm{full}}(\\mathrm{TS};T) - G_{\\mathrm{L}}^{\\mathrm{full}}(\\mathrm{R};T) \\right] + \\left[ \\Delta c_{\\mathrm{true}}(\\mathrm{TS}) - \\Delta c_{\\mathrm{true}}(\\mathrm{R}) \\right] \\right)\n$$\nThe low-level full-system barrier, $[G_{\\mathrm{L}}^{\\mathrm{full}}(\\mathrm{TS};T) - G_{\\mathrm{L}}^{\\mathrm{full}}(\\mathrm{R};T)]$, cancels out. This cancellation is a central feature of the ONIOM method's error analysis.\n$$\n\\varepsilon^{\\ddagger}(T) = \\left[ \\Delta c(\\mathrm{TS}) - \\Delta c(\\mathrm{R}) \\right] - \\left[ \\Delta c_{\\mathrm{true}}(\\mathrm{TS}) - \\Delta c_{\\mathrm{true}}(\\mathrm{R}) \\right]\n$$\nRearranging the terms to group them by state (TS and R):\n$$\n\\varepsilon^{\\ddagger}(T) = \\left[ \\Delta c(\\mathrm{TS}) - \\Delta c_{\\mathrm{true}}(\\mathrm{TS}) \\right] - \\left[ \\Delta c(\\mathrm{R}) - \\Delta c_{\\mathrm{true}}(\\mathrm{R}) \\right]\n$$\nUsing the definition of the model-truncation error, $\\delta_{X} \\equiv \\Delta c(X) - \\Delta c_{\\mathrm{true}}(X)$, we arrive at the final expression for the barrier error:\n$$\n\\varepsilon^{\\ddagger}(T) = \\delta_{\\mathrm{TS}} - \\delta_{\\mathrm{R}}\n$$\nThis result demonstrates that the error in the ONIOM activation barrier is precisely the difference in the model-truncation errors between the transition state and the reactant.\n\n**Part 3: Derivation of the Rate Constant Ratio**\nWe are asked to find the ratio $k_{\\mathrm{ONIOM}}(T)/k_{\\mathrm{true}}(T)$. Using the provided Eyring equation:\n$$\nk_{\\mathrm{ONIOM}}(T) = \\frac{k_{B} T}{h} \\frac{Q^{\\ddagger}_{\\mathrm{ONIOM}}(T)}{Q_{\\mathrm{R, ONIOM}}(T)} \\exp\\left(-\\frac{\\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T)}{k_{B} T}\\right)\n$$\n$$\nk_{\\mathrm{true}}(T) = \\frac{k_{B} T}{h} \\frac{Q^{\\ddagger}_{\\mathrm{true}}(T)}{Q_{\\mathrm{R, true}}(T)} \\exp\\left(-\\frac{\\Delta G_{\\mathrm{true}}^{\\ddagger}(T)}{k_{B} T}\\right)\n$$\nThe problem states the assumption that the ratio of partition functions is the same for both the ONIOM and true descriptions:\n$$\n\\frac{Q^{\\ddagger}_{\\mathrm{ONIOM}}(T)}{Q_{\\mathrm{R, ONIOM}}(T)} = \\frac{Q^{\\ddagger}_{\\mathrm{true}}(T)}{Q_{\\mathrm{R, true}}(T)}\n$$\nTaking the ratio $k_{\\mathrm{ONIOM}}(T)/k_{\\mathrm{true}}(T)$, the pre-exponential factor $\\frac{k_{B} T}{h}$ and the partition function ratios cancel out:\n$$\n\\frac{k_{\\mathrm{ONIOM}}(T)}{k_{\\mathrm{true}}(T)} = \\frac{\\exp\\left(-\\dfrac{\\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T)}{k_{B} T}\\right)}{\\exp\\left(-\\dfrac{\\Delta G_{\\mathrm{true}}^{\\ddagger}(T)}{k_{B} T}\\right)}\n$$\nUsing the property of exponentials, $\\exp(a)/\\exp(b) = \\exp(a-b)$:\n$$\n\\frac{k_{\\mathrm{ONIOM}}(T)}{k_{\\mathrm{true}}(T)} = \\exp\\left(-\\frac{\\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T)}{k_{B} T} + \\frac{\\Delta G_{\\mathrm{true}}^{\\ddagger}(T)}{k_{B} T}\\right) = \\exp\\left(-\\frac{\\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T) - \\Delta G_{\\mathrm{true}}^{\\ddagger}(T)}{k_{B} T}\\right)\n$$\nThe term in the numerator of the exponent is the barrier error, $\\varepsilon^{\\ddagger}(T) = \\Delta G_{\\mathrm{ONIOM}}^{\\ddagger}(T) - \\Delta G_{\\mathrm{true}}^{\\ddagger}(T)$.\n$$\n\\frac{k_{\\mathrm{ONIOM}}(T)}{k_{\\mathrm{true}}(T)} = \\exp\\left(-\\frac{\\varepsilon^{\\ddagger}(T)}{k_{B} T}\\right)\n$$\nFinally, we substitute the result from Part 2, $\\varepsilon^{\\ddagger}(T) = \\delta_{\\mathrm{TS}} - \\delta_{\\mathrm{R}}$:\n$$\n\\frac{k_{\\mathrm{ONIOM}}(T)}{k_{\\mathrm{true}}(T)} = \\exp\\left(-\\frac{\\delta_{\\mathrm{TS}} - \\delta_{\\mathrm{R}}}{k_{B} T}\\right)\n$$\nThis expression can be simplified by reversing the sign in the numerator:\n$$\n\\frac{k_{\\mathrm{ONIOM}}(T)}{k_{\\mathrm{true}}(T)} = \\exp\\left(\\frac{\\delta_{\\mathrm{R}} - \\delta_{\\mathrm{TS}}}{k_{B} T}\\right)\n$$\nThis is the final closed-form analytic expression for the ratio of the rate constants.", "answer": "$$\n\\boxed{\\exp\\left(\\frac{\\delta_{\\mathrm{R}} - \\delta_{\\mathrm{TS}}}{k_{B} T}\\right)}\n$$", "id": "2910502"}, {"introduction": "A successful ONIOM calculation relies on a model system that is large enough to capture the essential high-level electronic effects. This final exercise bridges theory and practical application by asking you to formalize a robust procedure for testing this convergence [@problem_id:2910552]. By implementing an algorithm to monitor the high-level correction, $\\Delta_{H}$, as the model system expands, you will develop a critical skill for ensuring the reliability and accuracy of multilayer simulations.", "problem": "You are asked to formalize and implement a convergence procedure for the multilayer energy decomposition known as Our own N-layered Integrated molecular Orbital and Molecular mechanics (ONIOM). The central object of interest is the high-level correction on the model subsystem, which is the difference between the electronic energy of the model subsystem computed at a high level of theory and at a low level of theory. Starting from the standard ONIOM decomposition under the Born–Oppenheimer approximation and well-established definitions of electronic energies, consider the following setup.\n\nLet the electronically adiabatic energy of the real (full) system at low level be denoted by $E_{L}^{\\text{real}}$. Let the energy of the model subsystem computed at high and low levels be denoted by $E_{H}^{\\text{model}}(k)$ and $E_{L}^{\\text{model}}(k)$, respectively, where the index $k \\in \\{1,2,\\dots,N\\}$ enumerates successive expansions of the model subsystem. Define the high-level correction on the model as\n$$\n\\Delta_{H}(k) \\equiv E_{H}^{\\text{model}}(k) - E_{L}^{\\text{model}}(k).\n$$\nThe well-tested ONIOM composite energy is $E_{L}^{\\text{real}} + \\Delta_{H}(k)$, and as the model subsystem expands, the sequence $\\{\\Delta_{H}(k)\\}$ is expected to approach a limit if the long-range physics is adequately captured at the low level.\n\nYour task is to derive a convergence metric from first principles of numerical analysis that is consistent with the physical expectations above, and then implement a program that detects the first expansion step at which the high-level correction is converged. Use the following mathematically defined metric with both absolute and relative components for robustness:\n\n1. For $k \\ge 2$, define the absolute change\n$$\na_{k} \\equiv \\left|\\Delta_{H}(k) - \\Delta_{H}(k-1)\\right|.\n$$\n2. For $k \\ge 2$, define the relative change with a safety floor $\\sigma > 0$ to avoid division by zero,\n$$\nr_{k} \\equiv \\frac{a_{k}}{\\max\\left(\\left|\\Delta_{H}(k)\\right|,\\left|\\Delta_{H}(k-1)\\right|,\\sigma\\right)}.\n$$\n3. Given thresholds $\\tau_{\\text{abs}} > 0$ and $\\tau_{\\text{rel}} > 0$, and a window size $w \\in \\mathbb{N}$ with $w \\ge 1$, declare that step $k$ (with $2 \\le k \\le N$) satisfies the convergence criterion if for all $j \\in \\{\\max(2,k-w+1),\\dots,k\\}$ both inequalities hold:\n$$\na_{j} \\le \\tau_{\\text{abs}} \\quad \\text{and} \\quad r_{j} \\le \\tau_{\\text{rel}}.\n$$\nDefine the first such $k$ as the convergence index. If no such $k$ exists up to $N$, return $-1$.\n\nAll energies are to be treated in Hartree. The thresholds $\\tau_{\\text{abs}}$ are in Hartree, the thresholds $\\tau_{\\text{rel}}$ are dimensionless, and $\\sigma$ is in Hartree.\n\nInput is fixed by this problem statement; no user input is required. Implement your program to evaluate the convergence index for each test case below. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[k_1,k_2,k_3,k_4,k_5]$, where each $k_i$ is an integer convergence index for the corresponding test case in order.\n\nTest Suite. For each case, you are provided the sequence $\\{\\Delta_{H}(k)\\}_{k=1}^{N}$ in Hartree, the absolute threshold $\\tau_{\\text{abs}}$, the relative threshold $\\tau_{\\text{rel}}$, the window $w$, and the safety floor $\\sigma$:\n\n- Case A (typical monotone stabilization): $\\Delta_{H} = [-2.1234,-2.1145,-2.1112,-2.1108,-2.1107]$, $\\tau_{\\text{abs}} = 1.0\\times 10^{-3}$, $\\tau_{\\text{rel}} = 2.0\\times 10^{-3}$, $w = 2$, $\\sigma = 1.0\\times 10^{-8}$.\n- Case B (alternating convergence with damping): $\\Delta_{H} = [-2.0000,-2.2000,-2.1000,-2.1900,-2.1200,-2.1800,-2.1500,-2.1700,-2.1600,-2.1650,-2.1630,-2.1640]$, $\\tau_{\\text{abs}} = 5.0\\times 10^{-3}$, $\\tau_{\\text{rel}} = 4.0\\times 10^{-3}$, $w = 3$, $\\sigma = 1.0\\times 10^{-8}$.\n- Case C (trivial immediate stability): $\\Delta_{H} = [0.0,0.0,0.0]$, $\\tau_{\\text{abs}} = 1.0\\times 10^{-8}$, $\\tau_{\\text{rel}} = 1.0\\times 10^{-8}$, $w = 1$, $\\sigma = 1.0\\times 10^{-12}$.\n- Case D (no convergence within available expansions): $\\Delta_{H} = [-1.0,-0.8,-0.6,-0.4,-0.2]$, $\\tau_{\\text{abs}} = 1.0\\times 10^{-3}$, $\\tau_{\\text{rel}} = 1.0\\times 10^{-3}$, $w = 2$, $\\sigma = 1.0\\times 10^{-8}$.\n- Case E (near-zero corrections requiring safety floor handling): $\\Delta_{H} = [0.0,1.0\\times 10^{-7},-1.0\\times 10^{-7},2.0\\times 10^{-8},-1.0\\times 10^{-8},5.0\\times 10^{-9}]$, $\\tau_{\\text{abs}} = 5.0\\times 10^{-8}$, $\\tau_{\\text{rel}} = 2.0$, $w = 2$, $\\sigma = 1.0\\times 10^{-8}$.\n\nYour program should output a single line with a Python-style list of the five integer results in the order of the cases above, that is, exactly one line of the form $[k_A,k_B,k_C,k_D,k_E]$.", "solution": "The posed problem requires the formalization and implementation of a numerical convergence test for the high-level correction term, $\\Delta_{H}(k)$, in the ONIOM (Our own N-layered Integrated molecular Orbital and Molecular mechanics) method. The task is not one of physical derivation but of rigorous algorithmic implementation based on the provided mathematical definitions for convergence, which are standard in numerical analysis. The procedure must determine the first expansion step, denoted by the index $k$, at which the sequence of corrections is deemed stable within a specified tolerance window.\n\nThe problem is scientifically and mathematically well-posed. All necessary data and definitions are provided. We will proceed methodically to construct the algorithm.\n\nThe core of the problem lies in the sequence of high-level corrections, $\\{\\Delta_{H}(k)\\}_{k=1}^{N}$, where $k$ is the expansion index. Convergence is assessed based on the rate of change of this sequence. The provided criteria are:\n\n$1$. The absolute change between successive steps, defined for $k \\ge 2$:\n$$\na_{k} \\equiv \\left|\\Delta_{H}(k) - \\Delta_{H}(k-1)\\right|\n$$\n\n$2$. The relative change, which is normalized by the magnitude of the correction terms themselves. This is defined for $k \\ge 2$ with a safety floor $\\sigma > 0$ to prevent division by zero or by numerically insignificant values:\n$$\nr_{k} \\equiv \\frac{a_{k}}{\\max\\left(\\left|\\Delta_{H}(k)\\right|,\\left|\\Delta_{H}(k-1)\\right|,\\sigma\\right)}\n$$\n\nA single step $j$ is considered provisionally converged if both its absolute and relative changes fall below respective thresholds, $\\tau_{\\text{abs}}$ and $\\tau_{\\text{rel}}$. That is, $a_{j} \\le \\tau_{\\text{abs}}$ and $r_{j} \\le \\tau_{\\text{rel}}$.\n\nThe final convergence criterion introduces the concept of a stability window of size $w \\ge 1$. A step $k$ (where $2 \\le k \\le N$) is declared the convergence index if and only if it is the *first* such step for which a retrospective check is satisfied. Specifically, for *all* steps $j$ within the window ending at $k$, i.e., for all $j \\in \\{\\max(2, k-w+1), \\dots, k\\}$, the dual inequality ($a_{j} \\le \\tau_{\\text{abs}}$ and $r_{j} \\le \\tau_{\\text{rel}}$) must hold. If no such $k$ exists up to the maximum expansion $N$, the sequence is considered non-convergent, and the index is reported as $-1$.\n\nThe algorithm to find the convergence index is therefore a sequential search. We iterate through possible convergence indices $k$ from $2$ to $N$. For each $k$, we verify the stability condition over its corresponding look-back window.\n\nThe algorithm is as follows:\nFor each potential convergence index $k$ from $2$ to $N$:\n$1$. Determine the start of the required check window, $j_{\\text{start}} = \\max(2, k-w+1)$.\n$2$. Assume the window is converged, setting a boolean flag `is_window_converged` to true.\n$3$. Iterate through each step $j$ from $j_{\\text{start}}$ to $k$. For each $j$:\n    a. Retrieve $\\Delta_{H}(j)$ and $\\Delta_{H}(j-1)$.\n    b. Calculate $a_{j}$ and $r_{j}$ according to their definitions.\n    c. Check if $a_{j} \\le \\tau_{\\text{abs}}$ and $r_{j} \\le \\tau_{\\text{rel}}$.\n    d. If the check fails for any $j$, the window condition is not met. Set `is_window_converged` to false and break the inner loop over $j$.\n$4$. If the inner loop completes with `is_window_converged` still true, it means all steps in the window $\\{\\max(2, k-w+1), \\dots, k\\}$ have met the criterion. Thus, $k$ is the first such index found. The algorithm terminates and returns $k$.\n$5$. If the outer loop over $k$ completes without returning, no convergence index was found. The algorithm returns $-1$.\n\nLet us apply this logic to Case A:\n$\\Delta_{H} = [-2.1234, -2.1145, -2.1112, -2.1108, -2.1107]$, $N=5$.\nParameters: $\\tau_{\\text{abs}} = 1.0 \\times 10^{-3}$, $\\tau_{\\text{rel}} = 2.0 \\times 10^{-3}$, $w=2$, $\\sigma = 1.0 \\times 10^{-8}$.\n\n- Check $k=2$: Window is $\\{j | j \\in \\{\\max(2, 1), \\dots, 2\\}\\}$, which is $\\{2\\}$.\n  - $j=2$: $a_2 = |-2.1145 - (-2.1234)| = 0.0089$. Since $0.0089 > \\tau_{\\text{abs}}$, the condition fails. $k=2$ is not the convergence index.\n\n- Check $k=3$: Window is $\\{j | j \\in \\{\\max(2, 2), \\dots, 3\\}\\}$, which is $\\{2, 3\\}$.\n  - The check for $j=2$ already failed. Thus, the window condition fails for $k=3$.\n\n- Check $k=4$: Window is $\\{j | j \\in \\{\\max(2, 3), \\dots, 4\\}\\}$, which is $\\{3, 4\\}$.\n  - $j=3$: $a_3 = |-2.1112 - (-2.1145)| = 0.0033$. Since $0.0033 > \\tau_{\\text{abs}}$, the condition fails. Thus, the window condition fails for $k=4$.\n\n- Check $k=5$: Window is $\\{j | j \\in \\{\\max(2, 4), \\dots, 5\\}\\}$, which is $\\{4, 5\\}$.\n  - Check $j=4$:\n    - $a_4 = |-2.1108 - (-2.1112)| = 0.0004$. $0.0004 \\le 1.0 \\times 10^{-3}$. (Pass)\n    - $r_4 = 0.0004 / \\max(|-2.1108|, |-2.1112|, 10^{-8}) = 0.0004 / 2.1112 \\approx 1.89 \\times 10^{-4}$. $1.89 \\times 10^{-4} \\le 2.0 \\times 10^{-3}$. (Pass)\n    - Condition for $j=4$ holds.\n  - Check $j=5$:\n    - $a_5 = |-2.1107 - (-2.1108)| = 0.0001$. $0.0001 \\le 1.0 \\times 10^{-3}$. (Pass)\n    - $r_5 = 0.0001 / \\max(|-2.1107|, |-2.1108|, 10^{-8}) = 0.0001 / 2.1108 \\approx 4.74 \\times 10^{-5}$. $4.74 \\times 10^{-5} \\le 2.0 \\times 10^{-3}$. (Pass)\n    - Condition for $j=5$ holds.\n  - Since the conditions hold for all $j \\in \\{4, 5\\}$, and $k=5$ is the first index for which this is true, the convergence index for Case A is $5$.\n\nBy applying this rigorous procedure to all test cases, we obtain the following results:\n- Case A: $5$\n- Case B: $12$\n- Case C: $2$\n- Case D: $-1$\n- Case E: $6$\n\nThe implementation will be a direct translation of this algorithm into Python code, utilizing the `numpy` library for numerical operations.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef find_convergence_index(delta_h, tau_abs, tau_rel, w, sigma):\n    \"\"\"\n    Determines the convergence index for a sequence of ONIOM high-level corrections.\n\n    Args:\n        delta_h (list or np.ndarray): Sequence of high-level corrections {Δ_H(k)}.\n        tau_abs (float): Absolute convergence threshold.\n        tau_rel (float): Relative convergence threshold.\n        w (int): Window size for convergence check.\n        sigma (float): Safety floor for the relative change denominator.\n\n    Returns:\n        int: The first convergence index k (2 <= k <= N), or -1 if not converged.\n    \"\"\"\n    N = len(delta_h)\n    if N < 2:\n        return -1\n\n    delta_h = np.array(delta_h, dtype=np.float64)\n\n    # We search for the first k, from 2 to N, that satisfies the criterion.\n    # The problem uses 1-based indexing for k, so range is (2, N + 1).\n    for k in range(2, N + 1):\n        # A potential convergence index k has been found if the condition\n        # holds for all steps j in a window of size w ending at k.\n        \n        is_window_converged = True\n        window_start_j = max(2, k - w + 1)\n        \n        for j in range(window_start_j, k + 1):\n            # For each step j in the window, check the convergence criteria.\n            # Convert 1-based problem indices (j, j-1) to 0-based Python indices.\n            idx_j = j - 1\n            idx_j_minus_1 = j - 2\n            \n            delta_h_j = delta_h[idx_j]\n            delta_h_j_minus_1 = delta_h[idx_j_minus_1]\n            \n            # 1. Absolute change a_j\n            a_j = np.abs(delta_h_j - delta_h_j_minus_1)\n            \n            # 2. Relative change r_j\n            denominator = np.max([np.abs(delta_h_j), np.abs(delta_h_j_minus_1), sigma])\n            \n            # The denominator is guaranteed non-zero if sigma > 0.\n            r_j = a_j / denominator\n                \n            # 3. Check if this step j meets the dual criteria\n            if not (a_j <= tau_abs and r_j <= tau_rel):\n                is_window_converged = False\n                break  # This j fails, so window ending at k fails.\n        \n        if is_window_converged:\n            # This is the first k that satisfies the condition for its window.\n            return k \n            \n    # If the loop finishes, no such k was found.\n    return -1\n\ndef solve():\n    \"\"\"\n    Solves the problem for the predefined test suite and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (typical monotone stabilization)\n        {\n            \"delta_h\": [-2.1234, -2.1145, -2.1112, -2.1108, -2.1107],\n            \"tau_abs\": 1.0e-3, \"tau_rel\": 2.0e-3, \"w\": 2, \"sigma\": 1.0e-8\n        },\n        # Case B (alternating convergence with damping)\n        {\n            \"delta_h\": [\n                -2.0000, -2.2000, -2.1000, -2.1900, -2.1200, -2.1800, \n                -2.1500, -2.1700, -2.1600, -2.1650, -2.1630, -2.1640\n            ],\n            \"tau_abs\": 5.0e-3, \"tau_rel\": 4.0e-3, \"w\": 3, \"sigma\": 1.0e-8\n        },\n        # Case C (trivial immediate stability)\n        {\n            \"delta_h\": [0.0, 0.0, 0.0],\n            \"tau_abs\": 1.0e-8, \"tau_rel\": 1.0e-8, \"w\": 1, \"sigma\": 1.0e-12\n        },\n        # Case D (no convergence within available expansions)\n        {\n            \"delta_h\": [-1.0, -0.8, -0.6, -0.4, -0.2],\n            \"tau_abs\": 1.0e-3, \"tau_rel\": 1.0e-3, \"w\": 2, \"sigma\": 1.0e-8\n        },\n        # Case E (near-zero corrections requiring safety floor handling)\n        {\n            \"delta_h\": [0.0, 1.0e-7, -1.0e-7, 2.0e-8, -1.0e-8, 5.0e-9],\n            \"tau_abs\": 5.0e-8, \"tau_rel\": 2.0, \"w\": 2, \"sigma\": 1.0e-8\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = find_convergence_index(\n            case[\"delta_h\"], case[\"tau_abs\"], case[\"tau_rel\"], case[\"w\"], case[\"sigma\"]\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2910552"}]}