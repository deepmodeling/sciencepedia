{"hands_on_practices": [{"introduction": "Our exploration begins with the most fundamental manifestation of free particle dynamics: the spreading of a wave packet. This exercise [@problem_id:2892591] provides a direct look at how an initially localized particle, described by a Gaussian wave packet, inevitably delocalizes over time. By calculating the characteristic time for this dispersion, you will gain crucial physical intuition into how a particle's mass and its initial localization dictate the timescale of quantum effects, connecting directly to the correspondence principle.", "problem": "A one-dimensional free particle of mass $m$ is prepared at time $t=0$ in the normalized Gaussian wave packet\n$$\n\\psi(x,0)=\\left(\\frac{1}{2\\pi\\sigma^{2}}\\right)^{1/4}\\exp\\!\\left[-\\frac{(x-x_{0})^{2}}{4\\sigma^{2}}+\\frac{i p_{0} x}{\\hbar}\\right],\n$$\nwhere $\\sigma>0$ is a real width parameter, $x_{0}\\in\\mathbb{R}$ is the initial mean position, $p_{0}\\in\\mathbb{R}$ is the initial mean momentum, and $\\hbar$ is the reduced Planck constant. The particle evolves under the time-dependent Schrödinger equation for a free particle with Hamiltonian $\\hat{H}=\\hat{p}^{2}/(2m)$, and the canonical commutation relation $[\\hat{x},\\hat{p}]=i\\hbar$ holds.\n\nStarting only from these fundamentals, derive the time dependence of the position variance $\\operatorname{Var}[x](t)$ and determine the first positive time $t_{s}$ at which the spatial variance has doubled relative to its initial value at $t=0$. Express your final answer for $t_{s}$ as a closed-form expression in terms of $m$, $\\sigma$, and $\\hbar$, and express the final time in seconds. Then, based on your derived expression, briefly discuss how $t_{s}$ depends on $m$, $\\sigma$, and $\\hbar$, and explain the behavior in the classical limit $m\\to\\infty$.\n\nYour final reported answer must be the single analytic expression for $t_{s}$ only.", "solution": "The problem will first be subjected to a rigorous validation procedure before any attempt at a solution is made.\n\nProblem Validation\n\nStep 1: Extract Givens\nThe problem provides the following information verbatim:\n- A one-dimensional free particle of mass $m$.\n- Initial state at time $t=0$: A normalized Gaussian wave packet $\\psi(x,0)=\\left(\\frac{1}{2\\pi\\sigma^{2}}\\right)^{1/4}\\exp\\!\\left[-\\frac{(x-x_{0})^{2}}{4\\sigma^{2}}+\\frac{i p_{0} x}{\\hbar}\\right]$.\n- Parameters: $\\sigma>0$ is a real width parameter, $x_{0}\\in\\mathbb{R}$ is the initial mean position, $p_{0}\\in\\mathbb{R}$ is the initial mean momentum, and $\\hbar$ is the reduced Planck constant.\n- Dynamics: The particle evolves under the time-dependent Schrödinger equation for a free particle.\n- Hamiltonian: $\\hat{H}=\\hat{p}^{2}/(2m)$.\n- Commutation relation: $[\\hat{x},\\hat{p}]=i\\hbar$.\n- Objective: Derive the time dependence of the position variance $\\operatorname{Var}[x](t)$.\n- Objective: Determine the first positive time $t_{s}$ at which the spatial variance has doubled relative to its initial value, $\\operatorname{Var}[x](t_{s})=2\\operatorname{Var}[x](0)$.\n- Objective: Express the final answer for $t_{s}$ as a closed-form expression in terms of $m$, $\\sigma$, and $\\hbar$.\n- Objective: Discuss the dependence of $t_{s}$ on the parameters and its behavior in the classical limit.\n\nStep 2: Validate Using Extracted Givens\nThe problem is examined against the required criteria.\n- **Scientifically Grounded**: The problem is a canonical exercise in quantum mechanics concerning the dynamics of a Gaussian wave packet for a free particle. All principles, equations, and definitions—the Schrödinger equation, the free-particle Hamiltonian, the canonical commutation relation, and the form of the Gaussian wave packet—are standard and fundamentally correct.\n- **Well-Posed**: The problem is well-posed. The initial state is specified, the governing equation of motion is provided, and the quantity to be calculated is clearly defined. A unique and stable solution is expected to exist.\n- **Objective**: The problem is stated in precise, objective mathematical language, free from ambiguity or subjective content.\n- **Flaw Analysis**: The problem statement contains a minor inconsistency where it requests the answer to be expressed \"in seconds\" while providing no numerical values, but this is immediately superseded by the instruction to provide a \"closed-form expression\" and the global rule that the final answer must be a single analytic expression. This minor flaw does not render the problem invalid; it merely requires a correct interpretation in favor of the more specific and dominant instruction. The problem is otherwise self-contained, consistent, and scientifically sound.\n\nStep 3: Verdict and Action\nThe problem is **valid**. A solution will be derived.\n\nSolution\nThe most direct method to find the time evolution of the variance is to use the Heisenberg picture, which describes the time evolution of operators. The variance of the position operator $\\hat{x}$ at time $t$ is given by $\\operatorname{Var}[x](t) = \\langle \\hat{x}(t)^2 \\rangle - \\langle \\hat{x}(t) \\rangle^2$, where the expectation values are taken with respect to the initial state $\\psi(x,0)$.\n\nThe Heisenberg equation of motion for an operator $\\hat{A}(t)$ is $\\frac{d\\hat{A}(t)}{dt} = \\frac{1}{i\\hbar}[\\hat{A}(t), \\hat{H}]$. The Hamiltonian for the free particle is $\\hat{H} = \\frac{\\hat{p}^2}{2m}$.\n\nFirst, we determine the time evolution of the position operator $\\hat{x}(t)$ and momentum operator $\\hat{p}(t)$. At $t=0$, we have $\\hat{x}(0) = \\hat{x}$ and $\\hat{p}(0) = \\hat{p}$.\nFor the momentum operator:\n$$ \\frac{d\\hat{p}(t)}{dt} = \\frac{1}{i\\hbar}[\\hat{p}, \\frac{\\hat{p}^2}{2m}] = 0 $$\nThus, the momentum operator is a constant of motion: $\\hat{p}(t) = \\hat{p}(0) = \\hat{p}$.\n\nFor the position operator:\n$$ \\frac{d\\hat{x}(t)}{dt} = \\frac{1}{i\\hbar}[\\hat{x}, \\frac{\\hat{p}^2}{2m}] = \\frac{1}{2mi\\hbar}([\\hat{x},\\hat{p}]\\hat{p} + \\hat{p}[\\hat{x},\\hat{p}]) = \\frac{1}{2mi\\hbar}(i\\hbar\\hat{p} + \\hat{p}i\\hbar) = \\frac{\\hat{p}}{m} $$\nIntegrating with respect to time yields:\n$$ \\hat{x}(t) = \\hat{x}(0) + \\frac{\\hat{p}(0)}{m}t = \\hat{x} + \\frac{\\hat{p}}{m}t $$\n\nNext, we calculate the expectation values with respect to the initial state $\\psi(x,0)$. The probability density at $t=0$ is:\n$$ |\\psi(x,0)|^2 = \\left(\\frac{1}{2\\pi\\sigma^2}\\right)^{1/2} \\exp\\left[-\\frac{(x-x_0)^2}{2\\sigma^2}\\right] $$\nThis is a normal distribution with mean $x_0$ and variance $\\sigma^2$.\nBy inspection and symmetry arguments, the expectation values of position and momentum at $t=0$ are:\n$$ \\langle \\hat{x} \\rangle_0 = x_0 $$\n$$ \\langle \\hat{p} \\rangle_0 = p_0 $$\nThe variance of position at $t=0$ is given directly by the parameter $\\sigma$:\n$$ \\operatorname{Var}[x](0) = (\\Delta x)_0^2 = \\langle (\\hat{x} - \\langle \\hat{x} \\rangle_0)^2 \\rangle_0 = \\sigma^2 $$\nThe initial state is a minimum-uncertainty Gaussian wave packet, so it satisfies the condition $(\\Delta x)_0 (\\Delta p)_0 = \\hbar/2$. From this, we find the initial momentum variance:\n$$ (\\Delta p)_0^2 = \\frac{\\hbar^2}{4(\\Delta x)_0^2} = \\frac{\\hbar^2}{4\\sigma^2} $$\n\nNow, we find the time-dependent expectation values.\nThe mean position is:\n$$ \\langle \\hat{x} \\rangle(t) = \\langle \\hat{x}(t) \\rangle_0 = \\left\\langle \\hat{x} + \\frac{\\hat{p}}{m}t \\right\\rangle_0 = \\langle \\hat{x} \\rangle_0 + \\frac{\\langle \\hat{p} \\rangle_0}{m}t = x_0 + \\frac{p_0}{m}t $$\nThis describes the classical trajectory of the center of the wave packet.\n\nThe expectation value of the squared position operator is:\n$$ \\langle \\hat{x}^2 \\rangle(t) = \\langle \\hat{x}(t)^2 \\rangle_0 = \\left\\langle \\left(\\hat{x} + \\frac{\\hat{p}}{m}t\\right)^2 \\right\\rangle_0 = \\left\\langle \\hat{x}^2 + \\frac{t}{m}(\\hat{x}\\hat{p}+\\hat{p}\\hat{x}) + \\frac{t^2}{m^2}\\hat{p}^2 \\right\\rangle_0 $$\n$$ \\langle \\hat{x}^2 \\rangle(t) = \\langle \\hat{x}^2 \\rangle_0 + \\frac{t}{m}\\langle \\hat{x}\\hat{p}+\\hat{p}\\hat{x} \\rangle_0 + \\frac{t^2}{m^2}\\langle \\hat{p}^2 \\rangle_0 $$\nWe need the initial second moments $\\langle \\hat{x}^2 \\rangle_0$ and $\\langle \\hat{p}^2 \\rangle_0$.\n$$ \\langle \\hat{x}^2 \\rangle_0 = (\\Delta x)_0^2 + \\langle \\hat{x} \\rangle_0^2 = \\sigma^2 + x_0^2 $$\n$$ \\langle \\hat{p}^2 \\rangle_0 = (\\Delta p)_0^2 + \\langle \\hat{p} \\rangle_0^2 = \\frac{\\hbar^2}{4\\sigma^2} + p_0^2 $$\nThe correlation term is $\\langle \\hat{x}\\hat{p}+\\hat{p}\\hat{x} \\rangle_0$. Since $\\hat{x}\\hat{p}+\\hat{p}\\hat{x} = 2\\hat{x}\\hat{p} - [\\hat{x},\\hat{p}] = 2\\hat{x}\\hat{p} - i\\hbar$, its expectation value is $2\\langle \\hat{x}\\hat{p} \\rangle_0 - i\\hbar$. Also, $\\langle (\\hat{x}\\hat{p})^\\dagger \\rangle_0 = \\langle \\hat{p}\\hat{x} \\rangle_0 = \\langle \\hat{x}\\hat{p} \\rangle_0^*$. Thus $\\langle \\hat{x}\\hat{p}+\\hat{p}\\hat{x} \\rangle_0 = 2\\operatorname{Re}(\\langle \\hat{x}\\hat{p} \\rangle_0)$. A direct calculation shows $\\langle \\hat{x}\\hat{p} \\rangle_0 = x_0 p_0 + i\\hbar/2$. Therefore,\n$$ \\langle \\hat{x}\\hat{p}+\\hat{p}\\hat{x} \\rangle_0 = 2\\operatorname{Re}(x_0 p_0 + i\\hbar/2) = 2x_0 p_0 $$\nSubstituting these into the expression for $\\langle \\hat{x}^2 \\rangle(t)$:\n$$ \\langle \\hat{x}^2 \\rangle(t) = (\\sigma^2 + x_0^2) + \\frac{t}{m}(2x_0 p_0) + \\frac{t^2}{m^2}\\left(\\frac{\\hbar^2}{4\\sigma^2} + p_0^2\\right) $$\n$$ \\langle \\hat{x}^2 \\rangle(t) = \\sigma^2 + \\frac{\\hbar^2 t^2}{4m^2\\sigma^2} + \\left(x_0^2 + \\frac{2x_0 p_0}{m}t + \\frac{p_0^2 t^2}{m^2}\\right) $$\n\nNow we compute the variance $\\operatorname{Var}[x](t) = \\langle \\hat{x}^2 \\rangle(t) - (\\langle \\hat{x} \\rangle(t))^2$:\n$$ (\\langle \\hat{x} \\rangle(t))^2 = \\left(x_0 + \\frac{p_0}{m}t\\right)^2 = x_0^2 + \\frac{2x_0 p_0}{m}t + \\frac{p_0^2 t^2}{m^2} $$\nSubtracting this from $\\langle \\hat{x}^2 \\rangle(t)$:\n$$ \\operatorname{Var}[x](t) = \\left(\\sigma^2 + \\frac{\\hbar^2 t^2}{4m^2\\sigma^2} + x_0^2 + \\frac{2x_0 p_0}{m}t + \\frac{p_0^2 t^2}{m^2}\\right) - \\left(x_0^2 + \\frac{2x_0 p_0}{m}t + \\frac{p_0^2 t^2}{m^2}\\right) $$\n$$ \\operatorname{Var}[x](t) = \\sigma^2 + \\frac{\\hbar^2 t^2}{4m^2\\sigma^2} $$\nThis fundamental result shows that the variance of the wave packet grows quadratically in time. The spreading is independent of the initial position $x_0$ and momentum $p_0$.\n\nThe problem asks for the time $t_s$ at which the variance has doubled from its initial value.\nThe initial variance is $\\operatorname{Var}[x](0) = \\sigma^2$.\nWe must solve the equation $\\operatorname{Var}[x](t_s) = 2\\operatorname{Var}[x](0)$:\n$$ \\sigma^2 + \\frac{\\hbar^2 t_s^2}{4m^2\\sigma^2} = 2\\sigma^2 $$\n$$ \\frac{\\hbar^2 t_s^2}{4m^2\\sigma^2} = \\sigma^2 $$\n$$ t_s^2 = \\frac{4m^2\\sigma^4}{\\hbar^2} $$\nTaking the positive root for the first positive time $t_s$:\n$$ t_s = \\frac{2m\\sigma^2}{\\hbar} $$\n\nDiscussion of the result:\nThe time $t_s$ for the packet's variance to double is a characteristic time for quantum spreading. Its dependence on the parameters is revealing:\n- $t_s \\propto m$: The spreading time is directly proportional to the mass. Heavier particles exhibit slower quantum spreading, which is consistent with the correspondence principle; massive objects behave more classically.\n- $t_s \\propto \\sigma^2$: The spreading time is proportional to the square of the initial width. A wave packet that is initially very localized (small $\\sigma$) has a large momentum uncertainty $(\\Delta p \\sim \\hbar/\\sigma)$ due to the uncertainty principle. The diverse momentum components cause the packet to fly apart rapidly. Conversely, a wide initial packet (large $\\sigma$) has a small momentum uncertainty, so its components travel at nearly the same velocity, leading to very slow spreading.\n- $t_s \\propto 1/\\hbar$: The spreading time is inversely proportional to the reduced Planck constant. In the classical limit where $\\hbar \\to 0$, $t_s \\to \\infty$. This signifies that quantum spreading is a purely quantum mechanical effect that vanishes in classical mechanics. A classical distribution of particles would simply translate without any change in its intrinsic width.\n- In the limit $m \\to \\infty$, $t_s \\to \\infty$. This implies that an infinitely massive particle would not experience quantum spreading, reinforcing the classical limit behavior.", "answer": "$$\n\\boxed{\\frac{2m\\sigma^{2}}{\\hbar}}\n$$", "id": "2892591"}, {"introduction": "Having examined dynamics on an unrestricted line, we now introduce a physical boundary to see how it constrains a particle's evolution. This practice [@problem_id:2892628] challenges you to construct the quantum mechanical propagator for a particle on a half-line using the method of images. This powerful technique demonstrates how solutions to complex boundary-value problems can be elegantly constructed from the simpler, known solutions for free space, offering deep insight into the role of symmetry and boundary conditions in quantum dynamics.", "problem": "Consider a spinless quantum particle of mass $m$ moving freely on the half-line $x \\ge 0$ with an impenetrable hard wall at $x=0$. The Hilbert space is $L^{2}([0,\\infty))$ and the time evolution is generated by the Hamiltonian\n$$\n\\hat{H} \\,=\\, -\\frac{\\hbar^{2}}{2m}\\,\\frac{d^{2}}{dx^{2}}\n$$\non the domain of twice-differentiable functions that vanish at the boundary, implementing the Dirichlet boundary condition $\\psi(0,t)=0$. Let $K_{D}(x,x';t)$ denote the propagator (time-evolution kernel) on the half-line, defined for $x \\ge 0$, $x' \\ge 0$, and $t>0$, so that for any initial state $\\psi(x,0)$ supported on $[0,\\infty)$,\n$$\n\\psi(x,t) \\,=\\, \\int_{0}^{\\infty} K_{D}(x,x';t)\\,\\psi(x',0)\\,dx' .\n$$\nStarting from the time-dependent Schrödinger equation\n$$\n\\mathrm{i}\\hbar\\,\\frac{\\partial}{\\partial t}K_{D}(x,x';t) \\,=\\, -\\frac{\\hbar^{2}}{2m}\\,\\frac{\\partial^{2}}{\\partial x^{2}}K_{D}(x,x';t)\n$$\nfor $x>0$, together with the boundary condition $K_{D}(0,x';t)=0$ for all $x'\\ge 0$, $t>0$, and the initial condition $\\lim_{t\\to 0^{+}}K_{D}(x,x';t)=\\delta(x-x')$ in the sense of distributions on $[0,\\infty)$, construct $K_{D}(x,x';t)$ by invoking the method of images. You may assume without derivation any standard, well-tested property of the free-particle propagator on the full line. Explicitly verify that your constructed kernel satisfies the stated boundary and initial conditions, and that it solves the free-particle Schrödinger equation for $x>0$ and $t>0$.\n\nProvide your final result for $K_{D}(x,x';t)$ as a single closed-form analytic expression in terms of $m$, $\\hbar$, $x$, $x'$, and $t$. The final answer must be a single expression. No numerical evaluation is required, and no units should be included in the final boxed expression.", "solution": "The problem requires the construction of the time-evolution kernel, or propagator, $K_{D}(x,x';t)$ for a non-relativistic, spinless particle of mass $m$ constrained to the half-line $x \\ge 0$ with an impenetrable barrier at $x=0$. The dynamics are governed by the free-particle Hamiltonian $\\hat{H} = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$ with a Dirichlet boundary condition, $\\psi(0,t)=0$, which translates to $K_{D}(0,x';t)=0$. The initial condition is given as $\\lim_{t\\to 0^{+}}K_{D}(x,x';t)=\\delta(x-x')$. The \"method of images\" is specified for the derivation.\n\nFirst, we recall the propagator for a free particle in one dimension on the entire real line, $(-\\infty, \\infty)$. We denote this by $K_{0}(x,x';t)$. It is the fundamental solution to the time-dependent Schrödinger equation (TDSE):\n$$\n\\mathrm{i}\\hbar\\,\\frac{\\partial}{\\partial t}K_{0}(x,x';t) \\,=\\, -\\frac{\\hbar^{2}}{2m}\\,\\frac{\\partial^{2}}{\\partial x^{2}}K_{0}(x,x';t)\n$$\nwith the initial condition $K_{0}(x,x';t) \\to \\delta(x-x')$ as $t \\to 0^{+}$. The well-known form of this propagator is:\n$$\nK_{0}(x,x';t) \\,=\\, \\sqrt{\\frac{m}{2\\pi \\mathrm{i}\\hbar t}} \\exp\\left(\\frac{\\mathrm{i}m(x-x')^{2}}{2\\hbar t}\\right)\n$$\nThe method of images allows us to solve problems with boundaries by extending the domain and constructing a solution from the boundary-free case. For the Dirichlet condition $K_D(0, x'; t) = 0$, we must ensure that the wavefunction vanishes at the origin for all time. This can be achieved by creating an antisymmetric solution on the full real line.\n\nConsider an initial source at position $x' > 0$. To produce a solution that is zero at $x=0$, we introduce a fictitious \"image\" source at position $-x'$ with an opposite sign. The initial condition for this auxiliary problem on the full line $\\mathbb{R}$ is thus an antisymmetric superposition of delta functions: $\\psi_{\\text{full}}(x,0) = \\delta(x-x') - \\delta(x+x')$.\n\nThe time evolution of this state under the free-particle Hamiltonian is obtained by applying the free-space propagator $K_0$. By the principle of superposition:\n$$\n\\psi_{\\text{full}}(x,t) = \\int_{-\\infty}^{\\infty} K_{0}(x,y;t) \\psi_{\\text{full}}(y,0) \\,dy = \\int_{-\\infty}^{\\infty} K_{0}(x,y;t) \\left[\\delta(y-x') - \\delta(y+x')\\right] \\,dy\n$$\nEvaluating the integrals yields:\n$$\n\\psi_{\\text{full}}(x,t) = K_{0}(x,x';t) - K_{0}(x,-x';t)\n$$\nFor $x, x' \\ge 0$, this function represents the evolution of an initial state $\\delta(x-x')$ on the half-line. We identify this with the desired propagator $K_D(x,x';t)$. Substituting the explicit form of $K_{0}(x,x';t)$:\n$$\nK_{D}(x,x';t) = \\sqrt{\\frac{m}{2\\pi \\mathrm{i}\\hbar t}} \\exp\\left(\\frac{\\mathrm{i}m(x-x')^{2}}{2\\hbar t}\\right) - \\sqrt{\\frac{m}{2\\pi \\mathrm{i}\\hbar t}} \\exp\\left(\\frac{\\mathrm{i}m(x-(-x'))^{2}}{2\\hbar t}\\right)\n$$\nwhich simplifies to:\n$$\nK_{D}(x,x';t) = \\sqrt{\\frac{m}{2\\pi \\mathrm{i}\\hbar t}} \\left[ \\exp\\left(\\frac{\\mathrm{i}m(x-x')^{2}}{2\\hbar t}\\right) - \\exp\\left(\\frac{\\mathrm{i}m(x+x')^{2}}{2\\hbar t}\\right) \\right]\n$$\nWe must now rigorously verify that this expression satisfies all the stated conditions.\n\n1.  **Schrödinger Equation:** The TDSE is a linear differential equation. Both terms, $K_{0}(x,x';t)$ and $K_{0}(x,-x';t)$, are solutions to the free-particle TDSE with respect to the variable $x$. Therefore, their linear combination, $K_{D}(x,x';t)$, is also a solution for $x>0$ and $t>0$.\n\n2.  **Boundary Condition:** We must verify that $K_{D}(0,x';t)=0$ for all $x' \\ge 0$ and $t>0$. Substituting $x=0$ into the expression for $K_{D}$:\n$$\nK_{D}(0,x';t) = \\sqrt{\\frac{m}{2\\pi \\mathrm{i}\\hbar t}} \\left[ \\exp\\left(\\frac{\\mathrm{i}m(0-x')^{2}}{2\\hbar t}\\right) - \\exp\\left(\\frac{\\mathrm{i}m(0+x')^{2}}{2\\hbar t}\\right) \\right]\n$$\n$$\nK_{D}(0,x';t) = \\sqrt{\\frac{m}{2\\pi \\mathrm{i}\\hbar t}} \\left[ \\exp\\left(\\frac{\\mathrm{i}m(x')^{2}}{2\\hbar t}\\right) - \\exp\\left(\\frac{\\mathrm{i}m(x')^{2}}{2\\hbar t}\\right) \\right] = 0\n$$\nThe boundary condition is correctly satisfied.\n\n3.  **Initial Condition:** We analyze the limit $t \\to 0^{+}$.\n$$\n\\lim_{t\\to 0^{+}} K_{D}(x,x';t) = \\lim_{t\\to 0^{+}} \\left[ K_{0}(x,x';t) - K_{0}(x,-x';t) \\right]\n$$\nUsing the known property of the free propagator, $\\lim_{t\\to 0^{+}}K_{0}(x,y;t) = \\delta(x-y)$, we obtain:\n$$\n\\lim_{t\\to 0^{+}} K_{D}(x,x';t) = \\delta(x-x') - \\delta(x+x')\n$$\nThis limit must be understood in the sense of distributions on the space of functions on $[0,\\infty)$. For any test function $f(x)$ on $[0,\\infty)$, the action of this kernel is:\n$$\n\\int_{0}^{\\infty} [\\delta(x-x') - \\delta(x+x')] f(x') dx' = f(x) - \\int_{0}^{\\infty} \\delta(x+x') f(x') dx'\n$$\nFor $x > 0$ and $x' \\ge 0$, the argument of the second delta function, $x+x'$, is strictly positive. Thus, $\\delta(x+x')$ is zero for all $x' \\in [0, \\infty)$ and the integral vanishes. If $x=0$, the integral is still zero unless $x'=0$. In either scenario for $x, x' \\in [0, \\infty)$, the term $\\delta(x+x')$ does not contribute to the evolution of states defined on the positive half-line. The kernel's action in the limit $t \\to 0^+$ is identical to that of $\\delta(x-x')$. The initial condition is therefore satisfied.\n\nThe constructed kernel has been explicitly verified to satisfy all required conditions of the problem.", "answer": "$$\n\\boxed{\\sqrt{\\frac{m}{2\\pi \\mathrm{i}\\hbar t}} \\left( \\exp\\left(\\frac{\\mathrm{i} m (x-x')^2}{2\\hbar t}\\right) - \\exp\\left(\\frac{\\mathrm{i} m (x+x')^2}{2\\hbar t}\\right) \\right)}\n$$", "id": "2892628"}, {"introduction": "Theoretical derivations provide the 'why,' but computational methods provide the 'how.' This final practice [@problem_id:2892564] transitions from analytical solutions to the numerical algorithms that power modern quantum simulations. You will implement a second-order symmetric operator-splitting scheme and discover that for the free particle, this sophisticated approximation becomes exact, perfectly mapping onto the kinetic phase evolution in momentum space that is efficiently computed using the Fast Fourier Transform (FFT).", "problem": "Implement a one-dimensional, second-order symmetric operator-splitting time propagator for a quantum particle governed by the time-dependent Schrödinger equation in a periodic box, and verify in the free-particle limit that it reduces to exact application of the kinetic phase. Work entirely in atomic units, where $\\hbar = 1$ and the particle mass is $m = 1$.\n\nStart from the time-dependent Schrödinger equation for a single particle in one spatial dimension,\n$$\n\\mathrm{i}\\,\\frac{\\partial}{\\partial t}\\,\\psi(x,t) \\;=\\; \\hat{H}\\,\\psi(x,t),\\qquad \\hat{H} \\;=\\; \\hat{T} + \\hat{V},\n$$\nwith kinetic energy operator $\\hat{T} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ and multiplicative potential energy operator $(\\hat{V}\\psi)(x) = V(x)\\,\\psi(x)$. The exact evolution over a time step $\\Delta t$ is given by the unitary propagator $\\hat{U}(\\Delta t) = \\exp\\!\\left(-\\mathrm{i}\\,\\hat{H}\\,\\Delta t\\right)$. A second-order accurate, symmetric operator splitting (also known as Strang splitting) replaces the exact propagator by a composition of substeps that alternately apply free evolution generated by $\\hat{T}$ and pointwise potential evolution generated by $\\hat{V}$, arranged symmetrically in time.\n\nOn a periodic interval of length $L$ discretized with $N$ equidistant grid points $x_j = j\\,\\Delta x$ for $j \\in \\{0,1,\\dots,N-1\\}$ with $\\Delta x = L/N$, the free evolution generated by $\\hat{T}$ is diagonal in the momentum representation. Let $k_n = \\frac{2\\pi}{L} n$ denote the discrete angular wavenumbers associated with the grid, where $n$ runs over the $N$ modes consistent with the discrete Fourier transform. The free evolution over a time increment $\\Delta t$ corresponds to multiplying each Fourier mode by the kinetic phase factor associated with its kinetic energy $T(k_n) = \\frac{1}{2}k_n^2$.\n\nTasks:\n1. Derive, from the definitions above and without invoking any black-box results beyond standard properties of exponentials and commutators, a second-order accurate, symmetric operator-splitting scheme that advances $\\psi(x,t)$ by a time step $\\Delta t$ under $\\hat{H} = \\hat{T} + \\hat{V}$ on the periodic grid. Your derivation must start from the fundamental time-dependent Schrödinger equation and the fact that the exact propagator is $\\exp(-\\mathrm{i}\\,\\hat{H}\\,\\Delta t)$.\n2. Specialize your scheme to the free-particle limit $V(x) \\equiv 0$ and prove that, on the periodic grid, the scheme reduces to exact application of the kinetic phase in momentum space. That is, show that for total time $t = M\\,\\Delta t$ with integer $M \\geq 0$, the $M$ repeated splitting steps coincide with a single spectral application of the exact free propagator $\\exp\\!\\left(-\\mathrm{i}\\,\\hat{T}\\,t\\right)$.\n3. Implement your scheme using the Discrete Fourier Transform computed by the Fast Fourier Transform (FFT) on the periodic grid. Use the momentum-space kinetic update by multiplying by the appropriate kinetic phase factors, and the real-space potential update by pointwise multiplication by potential phase factors.\n4. Verify numerically, for the free-particle limit $V(x)=0$, that the multi-step second-order splitting coincides with the one-shot exact free evolution in momentum space over the same total time, by computing the $L^2$-norm difference on the grid, defined as\n$$\n\\left\\|\\psi - \\phi\\right\\|_{L^2(\\text{grid})} \\;=\\; \\left(\\sum_{j=0}^{N-1} \\left|\\psi_j - \\phi_j\\right|^2\\,\\Delta x\\right)^{1/2}.\n$$\nUse normalized initial states $\\psi(x,0)$.\n\nYour program must hard-code the following test suite and output the $L^2$-norm differences for each case as floating-point numbers. All computations are in atomic units and are dimensionless; no physical units need to be reported. The grid is periodic on $[0,L)$ in all cases.\n\nLet $\\Delta x = L/N$ and $k_n = \\frac{2\\pi}{L} n$ as above. For a Gaussian wavepacket centered at $x_0$ with width $\\sigma$ and mean wavenumber $k_0$, use\n$$\n\\psi(x,0) \\;=\\; \\frac{1}{(\\pi\\sigma^2)^{1/4}}\\,\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right)\\,\\exp\\!\\left(\\mathrm{i}\\,k_0\\,x\\right),\n$$\nfollowed by discrete normalization so that $\\sum_j |\\psi_j|^2 \\Delta x = 1$. For a plane wave with wavenumber $k_0$ on the grid, use $\\psi(x,0) = L^{-1/2}\\,\\exp(\\mathrm{i}\\,k_0\\,x)$.\n\nTest suite:\n- Case A (happy path Gaussian): $N=1024$, $L=100.0$, $x_0=25.0$, $\\sigma=2.0$, $k_0=1.25$, $\\Delta t=0.05$, $M=200$, $V(x)\\equiv 0$.\n- Case B (zero-time boundary): same parameters as Case A, but $\\Delta t=0.0$, $M=0$, $V(x)\\equiv 0$.\n- Case C (grid-aligned plane wave): $N=1024$, $L=100.0$, choose mode index $m=100$ so that $k_0=\\frac{2\\pi}{L}m$, initialize $\\psi(x,0) = L^{-1/2}\\exp(\\mathrm{i}\\,k_0 x)$, take $\\Delta t=0.03$, $M=333$, $V(x)\\equiv 0$.\n- Case D (high-wavenumber Gaussian near Nyquist): $N=1024$, $L=100.0$, $x_0=40.0$, $\\sigma=10.0$, let $k_{\\max}=\\pi/\\Delta x$ and choose $k_0=0.8\\,k_{\\max}$, take $\\Delta t=0.02$, $M=250$, $V(x)\\equiv 0$.\n\nFor each case, compute the $L^2$-norm difference between:\n- the state obtained by applying $M$ steps of your second-order symmetric splitting with $V(x)=0$, and\n- the state obtained by applying the exact free evolution once in momentum space for total time $t=M\\,\\Delta t$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r_A,r_B,r_C,r_D]\"), where $r_A$, $r_B$, $r_C$, $r_D$ are the four floating-point differences defined above, in the order of Cases A, B, C, D. No other output is permitted.", "solution": "The problem requires the derivation, analysis, and implementation of a second-order symmetric operator-splitting propagator for the one-dimensional time-dependent Schrödinger equation, with a specific focus on its exactness in the free-particle limit. We shall address each task in sequence. All calculations are performed in atomic units, where $\\hbar=1$ and the particle mass $m=1$.\n\nThe governing equation is\n$$\n\\mathrm{i}\\,\\frac{\\partial}{\\partial t}\\,\\psi(x,t) \\;=\\; \\hat{H}\\,\\psi(x,t)\n$$\nwhere the Hamiltonian is $\\hat{H} = \\hat{T} + \\hat{V}$, with $\\hat{T} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ and $(\\hat{V}\\psi)(x) = V(x)\\,\\psi(x)$. The formal solution over a time step $\\Delta t$ is\n$$\n\\psi(x, t+\\Delta t) = \\exp(-\\mathrm{i}\\hat{H}\\Delta t)\\,\\psi(x,t)\n$$\nSince the operators $\\hat{T}$ and $\\hat{V}$ do not commute in general, i.e., $[\\hat{T}, \\hat{V}] \\neq 0$, the exponential of the sum cannot be factored into a product of exponentials: $\\exp(-\\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t) \\neq \\exp(-\\mathrm{i}\\hat{T}\\Delta t)\\exp(-\\mathrm{i}\\hat{V}\\Delta t)$. Operator splitting methods provide a systematic way to approximate the full propagator as a sequence of propagators involving only $\\hat{T}$ or $\\hat{V}$.\n\n**Task 1: Derivation of the Second-Order Symmetric Propagator**\n\nWe seek an approximation $\\hat{U}_{approx}(\\Delta t)$ to the exact propagator $\\hat{U}(\\Delta t) = \\exp(-\\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t)$ that is accurate to second order in $\\Delta t$. A symmetric composition, known as Strang splitting, is given by\n$$\n\\hat{U}_{approx}(\\Delta t) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\\,\\exp(-\\mathrm{i}\\hat{V}\\Delta t)\\,\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\n$$\nTo prove that this is a second-order approximation, we compare the Taylor series expansion of $\\hat{U}_{approx}(\\Delta t)$ with that of the exact propagator $\\hat{U}(\\Delta t)$ in powers of $\\Delta t$.\n\nThe expansion of the exact propagator is:\n$$\n\\hat{U}(\\Delta t) = \\mathbf{1} - \\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t + \\frac{(-\\mathrm{i})^2}{2!}(\\hat{T}+\\hat{V})^2(\\Delta t)^2 + O((\\Delta t)^3)\n$$\n$$\n\\hat{U}(\\Delta t) = \\mathbf{1} - \\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t - \\frac{1}{2}(\\hat{T}^2 + \\hat{T}\\hat{V} + \\hat{V}\\hat{T} + \\hat{V}^2)(\\Delta t)^2 + O((\\Delta t)^3)\n$$\nNow, we expand the components of the approximate propagator:\n$$\n\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2}) = \\mathbf{1} - \\mathrm{i}\\frac{\\hat{T}\\Delta t}{2} - \\frac{1}{2}(\\frac{\\hat{T}\\Delta t}{2})^2 + O((\\Delta t)^3) = \\mathbf{1} - \\mathrm{i}\\frac{\\hat{T}\\Delta t}{2} - \\frac{\\hat{T}^2(\\Delta t)^2}{8} + O((\\Delta t)^3)\n$$\n$$\n\\exp(-\\mathrm{i}\\hat{V}\\Delta t) = \\mathbf{1} - \\mathrm{i}\\hat{V}\\Delta t - \\frac{1}{2}(\\hat{V}\\Delta t)^2 + O((\\Delta t)^3) = \\mathbf{1} - \\mathrm{i}\\hat{V}\\Delta t - \\frac{\\hat{V}^2(\\Delta t)^2}{2} + O((\\Delta t)^3)\n$$\nMultiplying these expansions for $\\hat{U}_{approx}(\\Delta t)$:\n$$\n\\hat{U}_{approx}(\\Delta t) = \\left( \\mathbf{1} - \\mathrm{i}\\frac{\\hat{T}\\Delta t}{2} - \\frac{\\hat{T}^2(\\Delta t)^2}{8} \\right) \\left( \\mathbf{1} - \\mathrm{i}\\hat{V}\\Delta t - \\frac{\\hat{V}^2(\\Delta t)^2}{2} \\right) \\left( \\mathbf{1} - \\mathrm{i}\\frac{\\hat{T}\\Delta t}{2} - \\frac{\\hat{T}^2(\\Delta t)^2}{8} \\right) + O((\\Delta t)^3)\n$$\nWe collect terms by powers of $\\Delta t$:\nThe term of order $(\\Delta t)^0$ is $\\mathbf{1} \\cdot \\mathbf{1} \\cdot \\mathbf{1} = \\mathbf{1}$, which matches.\nThe term of order $(\\Delta t)^1$ is:\n$$\n(-\\mathrm{i}\\frac{\\hat{T}}{2})\\Delta t + (-\\mathrm{i}\\hat{V})\\Delta t + (-\\mathrm{i}\\frac{\\hat{T}}{2})\\Delta t = -\\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t\n$$\nThis also matches the exact expansion.\nThe term of order $(\\Delta t)^2$ is the sum of all operator products whose coefficients contain $(\\Delta t)^2$:\n$$\n\\underbrace{ \\left(-\\mathrm{i}\\frac{\\hat{T}}{2}\\right)\\left(-\\mathrm{i}\\hat{V}\\right)(\\Delta t)^2 }_{-\\frac{1}{2}\\hat{T}\\hat{V}(\\Delta t)^2} + \\underbrace{ \\left(-\\mathrm{i}\\frac{\\hat{T}}{2}\\right)\\left(-\\mathrm{i}\\frac{\\hat{T}}{2}\\right)(\\Delta t)^2 }_{-\\frac{1}{4}\\hat{T}^2(\\Delta t)^2} + \\underbrace{ \\left(-\\mathrm{i}\\hat{V}\\right)\\left(-\\mathrm{i}\\frac{\\hat{T}}{2}\\right)(\\Delta t)^2 }_{-\\frac{1}{2}\\hat{V}\\hat{T}(\\Delta t)^2} + \\underbrace{ \\left(-\\frac{\\hat{T}^2}{8}\\right)(\\Delta t)^2 + \\left(-\\frac{\\hat{V}^2}{2}\\right)(\\Delta t)^2 + \\left(-\\frac{\\hat{T}^2}{8}\\right)(\\Delta t)^2 }_{\\text{from squares in individual expansions}}\n$$\nSumming these terms:\n$$\n(\\Delta t)^2 \\left( -\\frac{1}{2}\\hat{T}\\hat{V} - \\frac{1}{4}\\hat{T}^2 - \\frac{1}{2}\\hat{V}\\hat{T} - \\frac{1}{8}\\hat{T}^2 - \\frac{1}{2}\\hat{V}^2 - \\frac{1}{8}\\hat{T}^2 \\right) = (\\Delta t)^2 \\left( -\\frac{1}{2}(\\hat{T}\\hat{V} + \\hat{V}\\hat{T}) - \\frac{1}{2}\\hat{V}^2 - (\\frac{1}{4}+\\frac{1}{8}+\\frac{1}{8})\\hat{T}^2 \\right)\n$$\n$$\n= (\\Delta t)^2 \\left( -\\frac{1}{2}(\\hat{T}^2 + \\hat{T}\\hat{V} + \\hat{V}\\hat{T} + \\hat{V}^2) \\right) = -\\frac{1}{2}(\\hat{T}+\\hat{V})^2 (\\Delta t)^2\n$$\nThis precisely matches the second-order term in the expansion of $\\hat{U}(\\Delta t)$. Since the expansions of $\\hat{U}(\\Delta t)$ and $\\hat{U}_{approx}(\\Delta t)$ agree up to and including terms of order $(\\Delta t)^2$, the symmetric splitting scheme is second-order accurate. The local error is $O((\\Delta t)^3)$.\n\n**Task 2: Specialization to the Free-Particle Limit**\n\nIn the free-particle limit, the potential energy is identically zero, $V(x) \\equiv 0$, which implies the operator $\\hat{V} = 0$. The Hamiltonian simplifies to $\\hat{H} = \\hat{T}$.\nThe exact propagator for a time step $\\Delta t$ is $\\hat{U}(\\Delta t) = \\exp(-\\mathrm{i}\\hat{T}\\Delta t)$.\nLet us evaluate the symmetric splitting propagator $\\hat{U}_{approx}(\\Delta t)$ under this condition:\n$$\n\\hat{U}_{approx}(\\Delta t) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\\,\\exp(-\\mathrm{i}(0)\\Delta t)\\,\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\n$$\nSince the exponential of the zero operator is the identity operator, $\\exp(0) = \\mathbf{1}$, this expression simplifies to:\n$$\n\\hat{U}_{approx}(\\Delta t) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\\,\\mathbf{1}\\,\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2}) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\\,\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\n$$\nAn operator always commutes with itself. Therefore, we can add the exponents: $\\exp(\\hat{A})\\exp(\\hat{B}) = \\exp(\\hat{A}+\\hat{B})$ if $[\\hat{A},\\hat{B}]=0$.\n$$\n\\hat{U}_{approx}(\\Delta t) \\;=\\; \\exp\\left(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2} - \\mathrm{i}\\hat{T}\\frac{\\Delta t}{2}\\right) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\Delta t)\n$$\nThis is identical to the exact free-particle propagator $\\hat{U}(\\Delta t)$. Thus, for any single time step $\\Delta t$, the symmetric splitting scheme is not an approximation but is exact for a free particle.\n\nNow, consider the evolution over a total time $t = M\\Delta t$, achieved by applying the propagator $M$ times. The state at time $t$ is given by\n$$\n\\psi(x, t) = \\left(\\hat{U}_{approx}(\\Delta t)\\right)^M \\psi(x, 0)\n$$\nSubstituting our result for the free-particle case:\n$$\n\\psi(x, t) = \\left(\\exp(-\\mathrm{i}\\hat{T}\\Delta t)\\right)^M \\psi(x, 0)\n$$\nAgain, since all operators in the product are identical, they commute, and we can sum the exponents:\n$$\n\\psi(x, t) = \\exp(-M \\cdot \\mathrm{i}\\hat{T}\\Delta t) \\psi(x, 0) = \\exp(-\\mathrm{i}\\hat{T}(M\\Delta t)) \\psi(x, 0)\n$$\nWith $t = M\\Delta t$, we have:\n$$\n\\psi(x, t) = \\exp(-\\mathrm{i}\\hat{T}t) \\psi(x, 0)\n$$\nThis is precisely the state obtained by applying the exact free-evolution propagator for the total time $t$ in a single step. This proves that for a free particle, the result of $M$ repeated splitting steps is identical to a single spectral application of the exact free propagator over the total duration.\n\n**Task 3 & 4: Implementation and Numerical Verification Strategy**\n\nThe action of the propagators is implemented on a discrete grid of $N$ points $x_j=j\\Delta x$ on a periodic interval of length $L$.\nThe potential propagator $\\exp(-\\mathrm{i}\\hat{V}\\tau)$ is local in real space; its action on a wavefunction $\\psi_j = \\psi(x_j)$ is pointwise multiplication: $(\\exp(-\\mathrm{i}\\hat{V}\\tau)\\psi)_j = \\exp(-\\mathrm{i}V(x_j)\\tau)\\psi_j$. For the free-particle case $V(x)=0$, this is simply multiplication by $1$.\n\nThe kinetic propagator $\\exp(-\\mathrm{i}\\hat{T}\\tau)$ is local in momentum space. We use the Discrete Fourier Transform (DFT), computed via the Fast Fourier Transform (FFT) algorithm, to switch between real and momentum space representations.\nThe action of $\\exp(-\\mathrm{i}\\hat{T}\\tau)$ on $\\psi$ is computed as:\n1.  Transform to momentum space: $\\tilde{\\psi}(k_n) = \\mathcal{F}\\{\\psi(x_j)\\}$, where $\\mathcal{F}$ denotes the DFT.\n2.  Apply the kinetic phase: $\\tilde{\\psi}'(k_n) = \\exp(-\\mathrm{i} T(k_n) \\tau) \\tilde{\\psi}(k_n)$, where the kinetic energy is $T(k_n) = \\frac{1}{2}k_n^2$. The discrete wavenumbers $k_n$ are those corresponding to the DFT.\n3.  Transform back to real space: $\\psi'(x_j) = \\mathcal{F}^{-1}\\{\\tilde{\\psi}'(k_n)\\}$.\n\nCombining these, the algorithm for the multi-step splitting evolution is as follows:\nInitialize $\\psi_j$ at $t=0$. For $m=1, \\dots, M$:\n  a. Apply kinetic half-step: $\\psi \\leftarrow \\mathcal{F}^{-1}\\{\\exp(-\\mathrm{i} k_n^2/2 \\cdot \\Delta t/2) \\mathcal{F}\\{\\psi\\}\\}$.\n  b. Apply potential step: For $V(x)=0$, this is an identity operation.\n  c. Apply kinetic half-step: $\\psi \\leftarrow \\mathcal{F}^{-1}\\{\\exp(-\\mathrm{i} k_n^2/2 \\cdot \\Delta t/2) \\mathcal{F}\\{\\psi\\}\\}$.\n\nThe one-shot exact evolution is computed as:\n  a. Set total time $t = M\\Delta t$.\n  b. Apply full kinetic step: $\\psi_{exact} \\leftarrow \\mathcal{F}^{-1}\\{\\exp(-\\mathrm{i} k_n^2/2 \\cdot t) \\mathcal{F}\\{\\psi\\}\\}$.\n\nAs shown in Task 2, these two procedures are algebraically identical. The numerical verification will thus compute the $L^2$-norm of the difference between the wavefunctions produced by the two methods. An ideally implemented code should yield a difference on the order of machine floating-point precision, confirming that the implementation correctly reflects the analytical result. The metric is:\n$$\n\\left\\|\\psi_{split} - \\psi_{exact}\\right\\|_{L^2(\\text{grid})} \\;=\\; \\left(\\sum_{j=0}^{N-1} \\left|\\psi_{split,j} - \\psi_{exact,j}\\right|^2\\,\\Delta x\\right)^{1/2}\n$$\nThe test suite explores different initial conditions (Gaussian, plane wave) and parameters (time steps, wavenumbers) to ensure the robustness of this conclusion.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.fft import fft, ifft, fftfreq\n\ndef solve():\n    \"\"\"\n    Solves the problem by implementing and verifying the symmetric operator-splitting\n    propagator for the free-particle Schrödinger equation.\n    \"\"\"\n\n    test_cases = [\n        # Case A: Happy path Gaussian\n        {\n            \"N\": 1024, \"L\": 100.0, \"x0\": 25.0, \"sigma\": 2.0, \"k0\": 1.25,\n            \"dt\": 0.05, \"M\": 200, \"type\": \"gaussian\"\n        },\n        # Case B: Zero-time boundary\n        {\n            \"N\": 1024, \"L\": 100.0, \"x0\": 25.0, \"sigma\": 2.0, \"k0\": 1.25,\n            \"dt\": 0.0, \"M\": 0, \"type\": \"gaussian\"\n        },\n        # Case C: Grid-aligned plane wave\n        {\n            \"N\": 1024, \"L\": 100.0, \"m\": 100,\n            \"dt\": 0.03, \"M\": 333, \"type\": \"plane_wave\"\n        },\n        # Case D: High-wavenumber Gaussian near Nyquist\n        {\n            \"N\": 1024, \"L\": 100.0, \"x0\": 40.0, \"sigma\": 10.0, \"k0_factor\": 0.8,\n            \"dt\": 0.02, \"M\": 250, \"type\": \"high_k_gaussian\"\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        N = case[\"N\"]\n        L = case[\"L\"]\n        dt = case[\"dt\"]\n        M = case[\"M\"]\n        \n        # 1. Set up spatial and momentum grids\n        dx = L / N\n        x = np.linspace(0.0, L, N, endpoint=False)\n        k = 2 * np.pi * fftfreq(N, d=dx)\n        \n        # 2. Initialize wavefunction psi0\n        if case[\"type\"] == \"gaussian\":\n            x0 = case[\"x0\"]\n            sigma = case[\"sigma\"]\n            k0 = case[\"k0\"]\n            # Unnormalized Gaussian\n            psi0 = (1.0 / (np.pi * sigma**2)**0.25) * \\\n                   np.exp(-(x - x0)**2 / (2 * sigma**2)) * \\\n                   np.exp(1j * k0 * x)\n        elif case[\"type\"] == \"plane_wave\":\n            m = case[\"m\"]\n            k0 = 2 * np.pi * m / L\n            psi0 = (1.0 / np.sqrt(L)) * np.exp(1j * k0 * x)\n        elif case[\"type\"] == \"high_k_gaussian\":\n            x0 = case[\"x0\"]\n            sigma = case[\"sigma\"]\n            k_max = np.pi / dx\n            k0 = case[\"k0_factor\"] * k_max\n            psi0 = (1.0 / (np.pi * sigma**2)**0.25) * \\\n                   np.exp(-(x - x0)**2 / (2 * sigma**2)) * \\\n                   np.exp(1j * k0 * x)\n        else:\n            raise ValueError(f\"Unknown case type: {case['type']}\")\n\n        # Discrete normalization for Gaussians, plane wave is already normalized\n        if \"gaussian\" in case[\"type\"]:\n            norm_factor = np.sqrt(np.sum(np.abs(psi0)**2) * dx)\n            psi0 /= norm_factor\n\n        # 3. Method 1: Multi-step splitting evolution for V=0\n        psi_split = np.copy(psi0)\n        \n        # Kinetic energy propagator for a half time step\n        # For V=0, V-step is identity. The two half-steps can be combined for efficiency,\n        # but we implement them separately to model the Strang splitting algorithm structure.\n        kinetic_propagator_half = np.exp(-1j * 0.5 * k**2 * dt / 2)\n        \n        # Explicit V=0 potential propagator (identity)\n        potential_propagator = np.ones(N) # exp(-i*0*dt) = 1\n\n        for _ in range(M):\n            # First kinetic half-step\n            psi_k = fft(psi_split)\n            psi_k *= kinetic_propagator_half\n            psi_split = ifft(psi_k)\n            \n            # Potential step (identity for V=0)\n            psi_split *= potential_propagator\n\n            # Second kinetic half-step\n            psi_k = fft(psi_split)\n            psi_k *= kinetic_propagator_half\n            psi_split = ifft(psi_k)\n            \n        # 4. Method 2: One-shot exact evolution\n        total_time = M * dt\n        kinetic_propagator_full = np.exp(-1j * 0.5 * k**2 * total_time)\n        psi0_k = fft(psi0)\n        psi_exact_k = psi0_k * kinetic_propagator_full\n        psi_exact = ifft(psi_exact_k)\n\n        # 5. Compute L2-norm difference\n        diff_norm = np.sqrt(np.sum(np.abs(psi_split - psi_exact)**2) * dx)\n        results.append(diff_norm)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2892564"}]}