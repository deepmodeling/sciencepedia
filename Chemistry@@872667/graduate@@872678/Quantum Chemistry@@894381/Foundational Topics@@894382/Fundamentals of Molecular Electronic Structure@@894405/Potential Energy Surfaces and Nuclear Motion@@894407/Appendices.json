{"hands_on_practices": [{"introduction": "This exercise guides you through the modern workflow for constructing a global, high-fidelity potential energy surface (PES) from first-principles electronic structure calculations. By considering the crucial roles of molecular symmetry, coordinate choice, and the inclusion of energy gradients, you will learn to distinguish between principled and flawed approaches to PES fitting. This practice is fundamental to developing surfaces that can accurately predict molecular properties and reaction dynamics [@problem_id:2917132].", "problem": "You are tasked with constructing a global ground-state potential energy surface for a polyatomic molecule with identical atoms (for concreteness, consider methane, $ \\mathrm{CH_4} $, whose proton labels are physically indistinguishable) within the Born–Oppenheimer (BO) framework. Under BO, the potential energy surface is the electronic ground-state energy $ E(\\mathbf{R}) $ as a function of the $ 3N $-dimensional nuclear coordinate vector $ \\mathbf{R} $ for $ N $ nuclei. The exact $ E(\\mathbf{R}) $ is invariant under overall translations and rotations of $ \\mathbf{R} $, and under any permutation of coordinates belonging to identical nuclei; these symmetries must be respected by any fitted representation. You have access to ab initio data: energies $ E(\\mathbf{R}_i) $ and nuclear gradients $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}_i) $ at sampled geometries $ \\{ \\mathbf{R}_i \\} $. The target representation is a Permutationally Invariant Polynomial (PIP), i.e., a polynomial in internal-coordinate features that is exactly invariant under permutations of identical nuclei.\n\nSelect all options that constitute a valid, symmetry-consistent, and principled workflow to obtain a global PIP fit that can be used to drive nuclear motion (e.g., classical dynamics or nuclear quantum dynamics), starting from first principles and well-tested facts. Your reasoning should appeal to: (i) the BO definition of $ E(\\mathbf{R}) $, (ii) the invariances implied by the electronic Hamiltonian, and (iii) the identification of forces $ \\mathbf{F}(\\mathbf{R}) = - \\nabla_{\\mathbf{R}} E(\\mathbf{R}) $ that govern nuclear motion.\n\nA. Sample $ \\mathbf{R} $ by drawing random Cartesian displacements in a narrow region around the equilibrium structure, compute $ E(\\mathbf{R}) $ only, and fit an ordinary polynomial in the $ 3N $ Cartesian components without removing translations or rotations and without any symmetry constraints. Validate by differentiating the polynomial to obtain $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}) $ and checking that the fitted forces look smooth near the minimum.\n\nB. Generate a design $ \\{ \\mathbf{R}_i \\} $ that covers chemically relevant regions, including near-equilibrium, transition-state neighborhoods, and dissociation channels, using internal-coordinate proposals (e.g., bond stretches, angle bends) and random displacements in the subspace of $ 3N - 6 $ internal coordinates (for a non-linear molecule). Compute both $ E(\\mathbf{R}_i) $ and $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}_i) $. Construct a basis of internal-coordinate features (e.g., functions of interatomic distances $ r_{ab} $ and angle cosines) that is made explicitly invariant under the permutation group of identical atoms by symmetrization, and fit a linear PIP expansion by minimizing a composite loss that weights energy and gradient residuals with unit-consistent weights. Use regularization to avoid overfitting and validate on symmetry-related hold-out sets.\n\nC. To reduce computational cost, compute gradients $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}_i) $ by finite-difference approximations of ab initio energies on a coarse Cartesian grid and fit a generic kernel regressor in Cartesian coordinates. Permutational invariance need not be enforced because the kernel regressor can approximate any smooth function and will learn the symmetry implicitly from the data. Validation can be restricted to reproducing energies; forces need not be matched.\n\nD. Start from the BO ground electronic state. Construct an initial point set $ \\{ \\mathbf{R}_i \\} $ by perturbing equilibrium geometries along normal modes to span a broad energy range and augment with configurations along reactive coordinates and at large separations to capture correct asymptotes. Compute $ E(\\mathbf{R}_i) $ and $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}_i) $ with a consistent ab initio method. Map $ \\mathbf{R} $ to a set of internal, rotation- and translation-invariant descriptors, then build a PIP basis by enforcing invariance under the relevant permutation group (e.g., $ S_4 $ for the four hydrogens) at the basis-construction stage. Determine coefficients via a regularized least-squares problem that simultaneously matches energies and gradients with appropriate weights, and validate by checking symmetry-related predictions and local curvatures (e.g., Hessian-derived harmonic frequencies) at stationary points.\n\nE. Fit an unconstrained polynomial in Cartesian coordinates to the combined energy and gradient data. After training, enforce permutational invariance by averaging the fitted polynomial over all permutations of identical atoms applied to the input coordinates; this removes the need for internal coordinates or invariant bases. Rotational and translational invariance can be ignored because the post-fit permutation averaging ensures the final model is physical.\n\nChoose all that apply.", "solution": "We begin from the Born–Oppenheimer (BO) separation, where the total molecular Hamiltonian is approximated by an electronic Hamiltonian $ \\hat{H}_e(\\mathbf{r}; \\mathbf{R}) $ parametrized by nuclear coordinates $ \\mathbf{R} $, yielding an electronic ground-state energy $ E(\\mathbf{R}) $ that defines the potential energy surface (PES) on which the nuclei move. The electronic Hamiltonian is invariant under overall translations and rotations of $ \\mathbf{R} $, and under permutations of coordinates associated with physically indistinguishable nuclei. Therefore, the exact PES satisfies\n- $ E(\\mathbf{R}) = E(\\mathbf{R} + \\mathbf{a}) $ for any translation $ \\mathbf{a} $,\n- $ E(\\mathbf{R}) = E(\\mathbf{Q}\\mathbf{R}) $ for any global rotation $ \\mathbf{Q} $ in $ \\mathrm{SO}(3) $,\n- $ E(\\mathbf{R}) = E(P \\cdot \\mathbf{R}) $ for any permutation $ P $ within the symmetry group that permutes identical nuclei.\n\nNuclear motion is governed by forces $ \\mathbf{F}(\\mathbf{R}) = - \\nabla_{\\mathbf{R}} E(\\mathbf{R}) $, which directly appear in Newton’s equations for classical dynamics and in the nuclear kinetic-plus-potential operator in quantum nuclear dynamics. From the Hellmann–Feynman (HF) theorem, when the electronic wavefunction is sufficiently well converged, the ab initio gradient $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}) $ provides physically meaningful forces. Including both $ E(\\mathbf{R}) $ and $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}) $ in a fit improves local accuracy of slopes and curvatures and constrains the fit globally.\n\nA Permutationally Invariant Polynomial (PIP) is constructed by forming polynomial basis functions of internal-coordinate features (e.g., interatomic distances $ r_{ab} $ or their smooth transforms, and angle cosines) and symmetrizing these basis functions under the relevant permutation group so that each basis element is exactly invariant. Using internal coordinates removes explicit dependence on overall rotations and translations; employing symmetrized basis functions ensures exact equality under permutations of identical nuclei. Fitting typically involves solving a regularized least-squares problem that minimizes a composite loss such as\n\n$$\n\\mathcal{L} = w_E \\sum_i \\big( E_{\\text{fit}}(\\mathbf{R}_i) - E_{\\text{ref}}(\\mathbf{R}_i) \\big)^2 + w_g \\sum_i \\big\\| \\nabla_{\\mathbf{R}} E_{\\text{fit}}(\\mathbf{R}_i) - \\nabla_{\\mathbf{R}} E_{\\text{ref}}(\\mathbf{R}_i) \\big\\|^2 + \\lambda \\| \\mathbf{c} \\|^2 ,\n$$\n\nwith $ w_E $, $ w_g $ ensuring unit consistency and $ \\lambda $ a Tikhonov regularization parameter for coefficients $ \\mathbf{c} $. To achieve global fidelity, the training set must sample near-equilibrium, transition-state regions, and far-from-equilibrium geometries, including dissociation limits, so that the fit respects correct asymptotic behavior.\n\nWe now analyze each option.\n\nOption A:\n- Uses Cartesian components directly and does not remove overall rotations or translations. This contradicts the invariances of $ E(\\mathbf{R}) $; a generic polynomial in Cartesian coordinates can spuriously depend on orientation and position.\n- Ignores permutation symmetry of identical nuclei, so $ E(\\mathbf{R}) \\neq E(P \\cdot \\mathbf{R}) $ in general for a permutation $ P $.\n- Samples only near the minimum, which cannot support a global PES and leads to poor extrapolation for nuclear motion outside a tiny neighborhood.\n- Fits energies only, losing constraints from forces, and validates only “smoothness,” which is not a physics-based criterion.\nVerdict: Incorrect.\n\nOption B:\n- Designs $ \\{ \\mathbf{R}_i \\} $ that cover a broad range of configurations, including reactive and dissociative regions. This is necessary for a global PES.\n- Uses internal coordinates in a $ 3N - 6 $ dimensional subspace for a non-linear molecule to remove rotations and translations, satisfying those invariances.\n- Computes both $ E(\\mathbf{R}_i) $ and $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}_i) $; the latter encode forces via $ \\mathbf{F}(\\mathbf{R}) = - \\nabla_{\\mathbf{R}} E(\\mathbf{R}) $, improving fidelity for nuclear motion.\n- Constructs a PIP basis by explicit symmetrization under the permutation group of identical atoms, guaranteeing exact permutational invariance by construction.\n- Minimizes a composite energy-plus-gradient loss with proper weighting and regularization, a principled and widely used approach.\n- Validates on symmetry-related hold-out sets, directly testing invariance and transfer.\nVerdict: Correct.\n\nOption C:\n- Computes gradients by finite differences of energy on a coarse grid in Cartesian space; such approximations add numerical noise and bias unless the grid is extremely fine, defeating the stated purpose of reliable $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}) $.\n- Fits a generic kernel in Cartesian coordinates without enforcing invariance. A kernel regressor does not automatically satisfy permutation invariance, nor remove translational and rotational degrees of freedom, unless the kernel and inputs are constructed to do so.\n- Omits force matching in validation, despite forces being central to nuclear motion.\nVerdict: Incorrect.\n\nOption D:\n- Grounds the construction in BO and samples along normal modes and reactive coordinates, and includes large separations to capture asymptotic channels; this supports global fidelity.\n- Computes consistent ab initio $ E(\\mathbf{R}_i) $ and $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}_i) $, leveraging HF forces to constrain the fit.\n- Transforms to internal, rotation- and translation-invariant descriptors, and builds the PIP basis by enforcing permutation invariance at the basis level (e.g., using the action of $ S_4 $ for the four hydrogens in $ \\mathrm{CH_4} $).\n- Determines coefficients by a regularized least-squares fit to energies and gradients with appropriate weights, which is a principled and stable procedure.\n- Validates using symmetry checks and local curvature (Hessian-derived harmonic frequencies), linking directly to nuclear vibrational properties.\nVerdict: Correct.\n\nOption E:\n- Fits an unconstrained polynomial in Cartesian coordinates, then averages the fitted function over permutations. While permutation averaging can enforce permutational invariance post hoc, it does not address rotational and translational invariance, which remain violated because the inputs are Cartesian coordinates.\n- Post-fit symmetrization does not guarantee that the resulting model optimally matches both energies and gradients; it can also disrupt the force consistency learned during fitting because the operation is applied after coefficient optimization rather than enforced at the basis-construction stage.\n- Explicitly dismisses the need for internal coordinates or invariant bases and ignores rotation/translation invariance, contradicting the required symmetries of $ E(\\mathbf{R}) $.\nVerdict: Incorrect.\n\nTherefore, the valid, symmetry-consistent, and principled workflows are those in Options B and D.", "answer": "$$\\boxed{BD}$$", "id": "2917132"}, {"introduction": "With a potential energy surface in hand, we can explore the fascinating world of nuclear quantum dynamics. This hands-on coding exercise challenges you to compute the tunneling splitting in a classic double-well potential, a key phenomenon in chemical reactions and spectroscopy. By implementing and comparing a numerically exact method with the semiclassical Wentzel–Kramers–Brillouin (WKB) approximation, you will gain a deep, practical understanding of how barrier penetration is governed by the shape of the PES and the mass of the particle [@problem_id:2917145].", "problem": "Consider one-dimensional nuclear motion on a symmetric double-well potential energy surface defined by the quartic form $V(x) = a \\,(x^2 - b^2)^2$ in atomic units (a.u.), where Planck’s reduced constant $\\hbar = 1$, the electron mass $m_e = 1$, and energies are in hartree while lengths are in bohr. The nuclear mass $m$ is treated as a scalar parameter in the Hamiltonian $H = -\\dfrac{1}{2 m}\\dfrac{d^2}{dx^2} + V(x)$. The minima lie at $x = \\pm b$ with $V(\\pm b) = 0$ and a central barrier at $x = 0$ with height $V(0) = a b^4$. The task is to compute the tunneling splitting of the lowest vibrational doublet and to compare an analytical semiclassical estimate with an exact numerical result.\n\nStarting from the time-independent Schrödinger equation and fundamental definitions of the Wentzel–Kramers–Brillouin (WKB) approximation, derive a computational approach that does the following for a given parameter set $(m,a,b)$:\n\n- Construct the local harmonic approximation at the minimum $x = b$ to estimate the single-well ground-state energy $E_0$ and the small-amplitude angular frequency $\\omega_0$ from $V''(b)$ and $m$.\n- Use a one-dimensional WKB barrier-penetration analysis to estimate the tunneling splitting $\\Delta_{\\text{WKB}}$ of the lowest doublet by evaluating the imaginary classical action across the classically forbidden region between the inner turning points for energy $E_0$.\n- Compute the exact splitting $\\Delta_{\\text{exact}}$ by numerical diagonalization of the Hamiltonian on a uniform grid using the finite difference method (FDM) with Dirichlet boundary conditions on a finite interval $[-L,L]$. Use a second-order central-difference kinetic energy operator to form a symmetric tridiagonal Hamiltonian matrix and obtain the two lowest eigenvalues $E_0^{\\text{exact}}$ and $E_1^{\\text{exact}}$; then set $\\Delta_{\\text{exact}} = E_1^{\\text{exact}} - E_0^{\\text{exact}}$.\n\nYour program must implement both approaches and report for each test case:\n- $\\Delta_{\\text{exact}}$ in hartree,\n- $\\Delta_{\\text{WKB}}$ in hartree,\n- the absolute difference $|\\Delta_{\\text{exact}} - \\Delta_{\\text{WKB}}|$ in hartree.\n\nAll energies must be expressed in hartree and each reported float must be rounded to $8$ decimal places.\n\nYou must implement your own numerical integration of the action integral and your own tridiagonal Hamiltonian diagonalization using scientifically standard algorithms, but you may use well-tested numerical library routines for root finding, quadrature, and symmetric tridiagonal eigensolvers.\n\nTest Suite and Discretization Details:\n- Use the same grid and box for all test cases: $L = 6.0$ bohr and a uniform grid with $N = 2000$ total points; impose Dirichlet boundary conditions at $x = \\pm L$ by restricting the Hamiltonian to the $N-2$ interior points.\n- Use the following $3$ parameter sets $(m,a,b)$, chosen to probe different barrier regimes while maintaining scientific realism and numerical stability:\n  - Case A (moderate-to-high barrier): $(m,a,b) = (1.0, 1.0, 1.5)$.\n  - Case B (moderate barrier): $(m,a,b) = (1.0, 3.0, 1.0)$.\n  - Case C (near-threshold barrier, WKB stress test): $(m,a,b) = (1.0, 20.0, 0.7)$.\n  \nFor each case, ensure that the barrier height $a b^4$ exceeds the local harmonic zero-point estimate $E_0$ so that a classically forbidden region exists for the WKB analysis.\n\nFinal Output Format:\n- Your program should produce a single line of output containing a flat list of floats ordered as $[\\Delta_{\\text{exact}}^{(A)}, \\Delta_{\\text{WKB}}^{(A)}, |\\Delta_{\\text{exact}}^{(A)} - \\Delta_{\\text{WKB}}^{(A)}|, \\Delta_{\\text{exact}}^{(B)}, \\Delta_{\\text{WKB}}^{(B)}, |\\Delta_{\\text{exact}}^{(B)} - \\Delta_{\\text{WKB}}^{(B)}|, \\Delta_{\\text{exact}}^{(C)}, \\Delta_{\\text{WKB}}^{(C)}, |\\Delta_{\\text{exact}}^{(C)} - \\Delta_{\\text{WKB}}^{(C)}|]$, rounded to $8$ decimal places, and enclosed in square brackets with comma-separated values, for a total of $9$ floats on a single line.\n\nAngle units do not occur in this problem. No percentages occur in this problem. All physical quantities that appear in the output must be in hartree, rounded to $8$ decimal places. No other text may be printed.", "solution": "The problem presented is a standard exercise in computational quantum mechanics and is valid. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. The task involves solving the one-dimensional time-independent Schrödinger equation for a particle of mass $m$ in a symmetric double-well potential $V(x) = a (x^2 - b^2)^2$. The goal is to compute the energy splitting $\\Delta E$ of the ground state doublet, which arises from quantum tunneling through the central barrier. This will be accomplished using two distinct methods: a semiclassical Wentzel–Kramers–Brillouin (WKB) approximation and a numerically exact diagonalization using the Finite Difference Method (FDM). The results from both methods will be compared. We work in atomic units where $\\hbar = 1$. The Hamiltonian is given by:\n$$\nH = -\\dfrac{1}{2 m}\\dfrac{d^2}{dx^2} + V(x)\n$$\n\nFirst, we derive the computational steps for the WKB approximation. This method provides an analytical estimate that is accurate in the limit of high, wide barriers.\n\nThe WKB formula for the energy splitting of the lowest doublet in a symmetric double-well potential is:\n$$\n\\Delta_{\\text{WKB}} = \\frac{\\hbar \\omega_0}{\\pi} e^{-S/\\hbar}\n$$\nIn atomic units, this becomes $\\Delta_{\\text{WKB}} = \\frac{\\omega_0}{\\pi} e^{-S}$. Here, $\\omega_0$ is the classical angular frequency of small oscillations within a single well, and $S$ is the classical action for tunneling under the barrier.\n\nTo find $\\omega_0$, we perform a harmonic approximation of the potential $V(x)$ around one of its minima, for instance at $x=b$. The potential is expanded in a Taylor series up to the second order around $x=b$:\n$V(x) \\approx V(b) + V'(b)(x-b) + \\frac{1}{2}V''(b)(x-b)^2$.\nThe potential is defined such that $V(b) = 0$ and $V'(x) = 4ax(x^2-b^2)$, so $V'(b)=0$. The second derivative is $V''(x) = 4a(3x^2 - b^2)$, which gives $V''(b) = 4a(3b^2 - b^2) = 8ab^2$.\nThe approximated harmonic potential is $V_{\\text{HO}}(x) = \\frac{1}{2}(8ab^2)(x-b)^2$. This corresponds to a harmonic oscillator with a spring constant $k = 8ab^2$. The angular frequency is thus $\\omega_0 = \\sqrt{k/m} = \\sqrt{8ab^2/m}$.\n\nThe ground-state energy within this single-well harmonic approximation is the zero-point energy $E_0 = \\frac{1}{2}\\hbar\\omega_0$. With $\\hbar=1$, we have:\n$$\nE_0 = \\frac{1}{2}\\omega_0 = \\sqrt{\\frac{2ab^2}{m}}\n$$\nThis energy $E_0$ is used as the energy level for the tunneling particle in the WKB calculation.\n\nThe action integral $S$, also known as the Gamow factor exponent, is calculated across the classically forbidden region:\n$$\nS = \\int_{-c}^{c} |p(x)| \\, dx = \\int_{-c}^{c} \\sqrt{2m(V(x) - E_0)} \\, dx\n$$\nThe limits of integration, $\\pm c$, are the inner classical turning points where the energy $E_0$ equals the potential energy $V(x)$. They are found by solving the equation $V(x) = E_0$:\n$a(x^2 - b^2)^2 = E_0 \\implies x^2 - b^2 = \\pm\\sqrt{E_0/a} \\implies x^2 = b^2 \\pm \\sqrt{E_0/a}$.\nThe inner turning points correspond to the smaller positive solution for $x^2$, so we take the minus sign: $c^2 = b^2 - \\sqrt{E_0/a}$, which gives $c = \\sqrt{b^2 - \\sqrt{E_0/a}}$. The existence of a real solution for $c$ is guaranteed by the problem condition that the barrier height $V(0) = ab^4$ is greater than $E_0$. The integral for $S$ does not have a simple analytical solution for this potential and must be evaluated numerically.\n\nNext, we detail the numerically exact approach using the Finite Difference Method (FDM). This method transforms the continuous differential Schrödinger equation into a discrete matrix eigenvalue problem.\n\nThe spatial domain $[-L, L]$ is discretized into a uniform grid of $N$ points $x_i = -L + i \\cdot \\Delta x$ for $i=0, \\dots, N-1$, with grid spacing $\\Delta x = 2L/(N-1)$. The wavefunction $\\psi(x)$ is represented by a vector of its values at these grid points, $\\vec{\\psi} = (\\psi_0, \\psi_1, \\dots, \\psi_{N-1})^T$.\n\nThe second derivative in the kinetic energy operator is approximated by a second-order central difference:\n$$\n\\frac{d^2\\psi}{dx^2}\\bigg|_{x_i} \\approx \\frac{\\psi(x_{i+1}) - 2\\psi(x_i) + \\psi(x_{i-1})}{(\\Delta x)^2}\n$$\nThe problem specifies Dirichlet boundary conditions, $\\psi(-L) = \\psi(L) = 0$, which translates to $\\psi_0 = 0$ and $\\psi_{N-1} = 0$. This means we only need to solve for the wavefunction at the $N-2$ interior points, from $x_1$ to $x_{N-2}$. The Schrödinger equation at an interior point $x_j$ (where $j=1, \\dots, N-2$) becomes:\n$$\n-\\frac{1}{2m} \\left( \\frac{\\psi_{j+1} - 2\\psi_j + \\psi_{j-1}}{(\\Delta x)^2} \\right) + V(x_j)\\psi_j = E \\psi_j\n$$\nThis can be rearranged into a matrix equation $\\mathbf{H}\\vec{\\psi'} = E\\vec{\\psi'}$, where $\\vec{\\psi'}$ is the vector of wavefunction values at the interior points, and $\\mathbf{H}$ is an $(N-2) \\times (N-2)$ symmetric tridiagonal matrix. The elements of this matrix are:\n- Diagonal elements: $H_{jj} = \\frac{1}{m(\\Delta x)^2} + V(x_{j})$\n- Off-diagonal elements: $H_{j,j+1} = H_{j+1,j} = -\\frac{1}{2m(\\Delta x)^2}$\n\nThis matrix eigenvalue problem can be solved numerically to find the eigenvalues $E_n$. The two lowest eigenvalues, $E_0^{\\text{exact}}$ and $E_1^{\\text{exact}}$, correspond to the ground state and the first excited state, which form the tunneling doublet. The numerically exact splitting is then:\n$$\n\\Delta_{\\text{exact}} = E_1^{\\text{exact}} - E_0^{\\text{exact}}\n$$\n\nThe provided program implements both approaches. For the WKB calculation, it first computes $\\omega_0$ and $E_0$, then finds the turning point $c$ using a root-finding algorithm (`scipy.optimize.brentq`), and finally evaluates the action integral $S$ using numerical quadrature (`scipy.integrate.quad`). For the FDM calculation, it constructs the tridiagonal Hamiltonian matrix and uses a specialized eigensolver (`scipy.linalg.eigh_tridiagonal`) to efficiently find the two lowest eigenvalues. The program then computes and reports the required quantities for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, linalg, optimize\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases and print the results.\n    \"\"\"\n    # Discretization and simulation box parameters as specified.\n    L = 6.0\n    N = 2000\n\n    # Test cases: (m, a, b) parameter sets.\n    test_cases = [\n        # Case A (moderate-to-high barrier)\n        (1.0, 1.0, 1.5),\n        # Case B (moderate barrier)\n        (1.0, 3.0, 1.0),\n        # Case C (near-threshold barrier, WKB stress test)\n        (1.0, 20.0, 0.7),\n    ]\n\n    # List to store all 9 final results.\n    final_results = []\n\n    for m, a, b in test_cases:\n        delta_exact, delta_wkb, abs_diff = calculate_splitting(m, a, b, L, N)\n        final_results.extend([\n            round(delta_exact, 8),\n            round(delta_wkb, 8),\n            round(abs_diff, 8)\n        ])\n\n    # Print the results in the exact specified format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\ndef calculate_splitting(m, a, b, L, N):\n    \"\"\"\n    Calculates the tunneling splitting using both FDM and WKB methods.\n\n    Args:\n        m (float): Mass of the particle.\n        a (float): Parameter 'a' of the potential V(x).\n        b (float): Parameter 'b' of the potential V(x), defines minima at +/- b.\n        L (float): Half-width of the simulation box [-L, L].\n        N (int): Number of grid points.\n\n    Returns:\n        tuple: A tuple containing (delta_exact, delta_wkb, abs_diff).\n    \"\"\"\n\n    # --- Part 1: Numerical \"Exact\" Calculation using Finite Difference Method ---\n\n    # Define the potential energy function.\n    def V(x):\n        return a * (x**2 - b**2)**2\n\n    # Set up the spatial grid. We only consider N-2 interior points.\n    x_grid = np.linspace(-L, L, N)\n    dx = x_grid[1] - x_grid[0]\n    x_interior = x_grid[1:-1] # Grid points from x_1 to x_{N-2}\n\n    # Construct the tridiagonal Hamiltonian matrix elements.\n    # Diagonal elements: 1/(m*dx^2) + V(x_i)\n    diag_elements = (1.0 / (m * dx**2)) + V(x_interior)\n\n    # Off-diagonal elements: -1/(2*m*dx^2)\n    # There are N-3 off-diagonal elements for an (N-2)x(N-2) matrix.\n    offdiag_elements = -1.0 / (2.0 * m * dx**2) * np.ones(N - 3)\n\n    # Diagonalize the tridiagonal matrix to find the two lowest eigenvalues.\n    # `eigh_tridiagonal` returns eigenvalues in ascending order.\n    # select='i' and select_range=(0, 1) requests the first two eigenvalues (indices 0 and 1).\n    eigenvalues = linalg.eigh_tridiagonal(diag_elements, offdiag_elements, select='i', select_range=(0, 1))[0]\n    E0_exact, E1_exact = eigenvalues\n\n    # Calculate the \"exact\" tunneling splitting.\n    delta_exact = E1_exact - E0_exact\n\n    # --- Part 2: Semiclassical WKB Calculation ---\n\n    # Calculate the harmonic frequency at the well minimum.\n    # k = V''(b) = 8*a*b^2. omega0 = sqrt(k/m).\n    omega0 = np.sqrt(8 * a * b**2 / m)\n\n    # Estimate the ground state energy E0 using the harmonic approximation (ZPE).\n    # In atomic units (hbar=1), E0 = 0.5 * omega0.\n    E0_harmonic = 0.5 * omega0\n\n    # Find the inner classical turning points +/- c by solving V(x) = E0_harmonic.\n    # This is equivalent to finding the root of f(x) = V(x) - E0 = 0.\n    def turning_point_eq(x):\n        return V(x) - E0_harmonic\n\n    # We search for the positive root 'c' in the interval [0, b].\n    # brentq is a robust root-finding algorithm.\n    c = optimize.brentq(turning_point_eq, 0, b)\n    \n    # Define the integrand for the action integral S.\n    def action_integrand(x):\n        return np.sqrt(2 * m * (V(x) - E0_harmonic))\n    \n    # Numerically integrate from -c to c to find the action S.\n    # We use scipy.integrate.quad for this.\n    S, _ = integrate.quad(action_integrand, -c, c)\n    \n    # Calculate the WKB tunneling splitting.\n    # delta_wkb = (omega0 / pi) * exp(-S) since hbar=1.\n    delta_wkb = (omega0 / np.pi) * np.exp(-S)\n    \n    # Calculate the absolute difference between the two methods.\n    abs_diff = np.abs(delta_exact - delta_wkb)\n\n    return delta_exact, delta_wkb, abs_diff\n\n# Execute the main function when the script is run.\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2917145"}, {"introduction": "The Born-Oppenheimer approximation, which defines the PES, is not exact, and its limitations give rise to subtle but important physical effects. This problem asks you to analytically investigate the leading-order correction, the Diagonal Born-Oppenheimer Correction (DBOC), and its impact on molecular properties. By deriving how the DBOC shifts equilibrium geometries and vibrational frequencies, you will explore the mass-dependent nature of these non-adiabatic effects and their consequences for isotopic substitution [@problem_id:2917150].", "problem": "A diatomic molecule with internuclear separation coordinate $R$ has an electronic potential energy surface $E_{0}(R)$ obtained under the Born–Oppenheimer separation of electronic and nuclear motion. Consider the inclusion of the diagonal Born–Oppenheimer correction (DBOC), defined as the diagonal adiabatic correction to the effective nuclear Hamiltonian that arises at leading order from the adiabatic expansion beyond the Born–Oppenheimer approximation. Assume that near the Born–Oppenheimer equilibrium geometry $R_{e}$, the electronic potential $E_{0}(R)$ is well approximated by a harmonic form with force constant $k$, so that $E_{0}(R)\\approx E_{0}(R_{e})+\\tfrac{1}{2}k\\,(R-R_{e})^{2}$. Assume further that the DBOC produces a smooth correction $\\Delta U(R)$ that can be expanded about $R_{e}$ as $\\Delta U(R)\\approx \\Delta U_{0}+B\\,(R-R_{e})+\\tfrac{1}{2}C\\,(R-R_{e})^{2}$, where $B$ and $C$ are small in the sense that $|B|/k\\ll 1$ and $|C|/k\\ll 1$. The total potential for nuclear motion is then $V_{\\text{tot}}(R)=E_{0}(R)+\\Delta U(R)$.\n\nTwo isotopologues are considered for the same electronic state: a light hydride $\\mathrm{XH}$ and its heavy isotopic analogue $\\mathrm{XD}$. Let the heavy atom $\\mathrm{X}$ be sufficiently massive that, to leading order, the reduced mass for vibration may be approximated by the light atom mass alone, so that the reduced mass $\\mu_{\\mathrm{XH}}\\approx M_{\\mathrm{H}}$ for $\\mathrm{XH}$ and $\\mu_{\\mathrm{XD}}\\approx M_{\\mathrm{D}}$ for $\\mathrm{XD}$. Assume that the leading mass dependence of the DBOC Taylor coefficients is dominated by the light atom and scales inversely with its mass, so that $B=b/M_{L}$ and $C=c/M_{L}$ with $M_{L}=M_{\\mathrm{H}}$ for $\\mathrm{XH}$ and $M_{L}=M_{\\mathrm{D}}$ for $\\mathrm{XD}$, where $b$ and $c$ are mass-independent constants that depend only on the electronic structure in the vicinity of $R_{e}$.\n\nStarting from the Born–Oppenheimer separation and the definition of the diagonal adiabatic correction (DBOC), and working to leading order in $|B|/k$ and $|C|/k$, do the following: (i) demonstrate that inclusion of $\\Delta U(R)$ shifts the equilibrium geometry from $R_{e}$ by a nonzero amount and modifies the harmonic vibrational frequency; (ii) derive the leading-order expressions for the geometry shift and the vibrational frequency shift for an arbitrary isotopologue in terms of $k$, $\\mu$, $B$, and $C$; and (iii) use these expressions and the stated scaling assumptions to obtain the exact, closed-form ratio of the vibrational frequency shifts $\\delta\\omega_{\\mathrm{XH}}/\\delta\\omega_{\\mathrm{XD}}$ in the limit where $\\mu_{\\mathrm{XH}}\\approx M_{\\mathrm{H}}$ and $\\mu_{\\mathrm{XD}}\\approx M_{\\mathrm{D}}$ and $M_{\\mathrm{D}}=2\\,M_{\\mathrm{H}}$. Provide the final answer as an exact, dimensionless expression. Do not round.", "solution": "The problem as stated is scientifically grounded, self-contained, and well-posed. It addresses a standard topic in quantum chemistry—the breakdown of the Born-Oppenheimer approximation—using standard perturbative methods. All required assumptions and data are provided. No inconsistencies or invalid premises are present. Therefore, we proceed to the solution.\n\nThe total potential for nuclear motion, $V_{\\text{tot}}(R)$, is the sum of the Born-Oppenheimer (BO) potential, $E_{0}(R)$, and the diagonal Born-Oppenheimer correction (DBOC), $\\Delta U(R)$.\n$$V_{\\text{tot}}(R) = E_{0}(R) + \\Delta U(R)$$\nThe problem provides expansions for these potentials around the BO equilibrium geometry, $R_{e}$:\n$$E_{0}(R)\\approx E_{0}(R_{e})+\\frac{1}{2}k(R-R_{e})^{2}$$\n$$\\Delta U(R)\\approx \\Delta U_{0}+B(R-R_{e})+\\frac{1}{2}C(R-R_{e})^{2}$$\nwhere $k$ is the BO force constant, and $B$ and $C$ are the first- and second-order coefficients of the DBOC expansion, respectively. Combining these gives the total potential near $R_{e}$:\n$$V_{\\text{tot}}(R) \\approx E_{0}(R_{e}) + \\Delta U_{0} + B(R-R_{e}) + \\frac{1}{2}(k+C)(R-R_{e})^{2}$$\nThis expression is a quadratic polynomial in the displacement coordinate $(R-R_{e})$.\n\n(i) To demonstrate the shift in equilibrium geometry and harmonic frequency, we first find the new equilibrium geometry, $R'_{e}$, by finding the minimum of $V_{\\text{tot}}(R)$. This occurs where the first derivative with respect to $R$ is zero.\n$$\\frac{dV_{\\text{tot}}}{dR} = B + (k+C)(R-R_{e})$$\nSetting this derivative to zero at $R=R'_{e}$:\n$$B + (k+C)(R'_{e}-R_{e}) = 0$$\nSolving for the geometry shift, $\\delta R = R'_{e}-R_{e}$:\n$$\\delta R = -\\frac{B}{k+C}$$\nSince $|C|/k \\ll 1$, we expand this to leading order:\n$$\\delta R = -\\frac{B}{k(1+C/k)} \\approx -\\frac{B}{k}\\left(1 - \\frac{C}{k} + \\dots\\right) \\approx -\\frac{B}{k}$$\nThe higher-order term is proportional to $BC/k^2$ and is neglected. As $B$ is generally non-zero, $\\delta R \\neq 0$, demonstrating that the DBOC shifts the equilibrium geometry.\n\nNext, we find the new effective harmonic force constant, $k'$, which is the second derivative of the total potential evaluated at the new equilibrium, $R'_{e}$.\n$$k' = \\left.\\frac{d^{2}V_{\\text{tot}}}{dR^{2}}\\right|_{R=R'_{e}}$$\nThe second derivative is constant with respect to $R$:\n$$\\frac{d^{2}V_{\\text{tot}}}{dR^{2}} = k+C$$\nThus, the new force constant is $k' = k+C$. The BO harmonic vibrational frequency is $\\omega_{0} = \\sqrt{k/\\mu}$, where $\\mu$ is the reduced mass. The new frequency, including the DBOC, is $\\omega' = \\sqrt{k'/\\mu} = \\sqrt{(k+C)/\\mu}$. Since $C$ is generally non-zero, $\\omega' \\neq \\omega_{0}$, demonstrating that the harmonic frequency is modified.\n\n(ii) The leading-order expressions for the geometry shift and vibrational frequency shift have been derived above.\nThe geometry shift is:\n$$\\delta R = R'_{e} - R_{e} \\approx -\\frac{B}{k}$$\nThe frequency shift, $\\delta\\omega = \\omega' - \\omega_{0}$, is found by expanding $\\omega'$ for small $C/k$:\n$$\\delta\\omega = \\sqrt{\\frac{k+C}{\\mu}} - \\sqrt{\\frac{k}{\\mu}} = \\sqrt{\\frac{k}{\\mu}}\\left(\\sqrt{1+\\frac{C}{k}} - 1\\right)$$\nUsing the binomial approximation $\\sqrt{1+x} \\approx 1 + \\frac{1}{2}x$ for small $x=C/k$:\n$$\\delta\\omega \\approx \\sqrt{\\frac{k}{\\mu}}\\left(\\left(1+\\frac{1}{2}\\frac{C}{k}\\right) - 1\\right) = \\sqrt{\\frac{k}{\\mu}}\\left(\\frac{C}{2k}\\right)$$\n$$\\delta\\omega \\approx \\frac{C}{2\\sqrt{k\\mu}}$$\nThese are the required leading-order expressions for an arbitrary isotopologue.\n\n(iii) We now apply these results to the two isotopologues, $\\mathrm{XH}$ and $\\mathrm{XD}$. The problem states the following scaling rules:\n- Reduced masses: $\\mu_{\\mathrm{XH}} \\approx M_{\\mathrm{H}}$ and $\\mu_{\\mathrm{XD}} \\approx M_{\\mathrm{D}}$.\n- DBOC coefficients: $B = b/M_{L}$ and $C = c/M_{L}$, where $M_{L}$ is the light atom mass and $b$, $c$ are mass-independent constants.\n- The BO force constant $k$ is electronic in origin and thus independent of isotopic mass.\n- The mass relation is $M_{\\mathrm{D}} = 2M_{\\mathrm{H}}$.\n\nWe need the ratio of the vibrational frequency shifts, $\\delta\\omega_{\\mathrm{XH}}/\\delta\\omega_{\\mathrm{XD}}$. Using the derived expression for $\\delta\\omega$:\nFor $\\mathrm{XH}$, we have $M_{L} = M_{\\mathrm{H}}$, $\\mu_{\\mathrm{XH}} \\approx M_{\\mathrm{H}}$, and $C_{\\mathrm{XH}} = c/M_{\\mathrm{H}}$. The shift is:\n$$\\delta\\omega_{\\mathrm{XH}} \\approx \\frac{C_{\\mathrm{XH}}}{2\\sqrt{k\\mu_{\\mathrm{XH}}}} = \\frac{c/M_{\\mathrm{H}}}{2\\sqrt{kM_{\\mathrm{H}}}} = \\frac{c}{2\\sqrt{k}}\\frac{1}{M_{\\mathrm{H}}^{3/2}}$$\nFor $\\mathrm{XD}$, we have $M_{L} = M_{\\mathrm{D}}$, $\\mu_{\\mathrm{XD}} \\approx M_{\\mathrm{D}}$, and $C_{\\mathrm{XD}} = c/M_{\\mathrm{D}}$. The shift is:\n$$\\delta\\omega_{\\mathrm{XD}} \\approx \\frac{C_{\\mathrm{XD}}}{2\\sqrt{k\\mu_{\\mathrm{XD}}}} = \\frac{c/M_{\\mathrm{D}}}{2\\sqrt{kM_{\\mathrm{D}}}} = \\frac{c}{2\\sqrt{k}}\\frac{1}{M_{\\mathrm{D}}^{3/2}}$$\n\nNow, we compute the ratio. The mass-independent constants $c$, $k$, and the factor of $2$ cancel:\n$$\\frac{\\delta\\omega_{\\mathrm{XH}}}{\\delta\\omega_{\\mathrm{XD}}} \\approx \\frac{\\frac{c}{2\\sqrt{k}}\\frac{1}{M_{\\mathrm{H}}^{3/2}}}{\\frac{c}{2\\sqrt{k}}\\frac{1}{M_{\\mathrm{D}}^{3/2}}} = \\frac{M_{\\mathrm{D}}^{3/2}}{M_{\\mathrm{H}}^{3/2}} = \\left(\\frac{M_{\\mathrm{D}}}{M_{\\mathrm{H}}}\\right)^{3/2}$$\nSubstituting the given mass relation $M_{\\mathrm{D}} = 2M_{\\mathrm{H}}$:\n$$\\frac{\\delta\\omega_{\\mathrm{XH}}}{\\delta\\omega_{\\mathrm{XD}}} = \\left(\\frac{2M_{\\mathrm{H}}}{M_{\\mathrm{H}}}\\right)^{3/2} = 2^{3/2}$$\nThis simplifies to the final exact expression.\n$$2^{3/2} = 2^{1} \\cdot 2^{1/2} = 2\\sqrt{2}$$", "answer": "$$\\boxed{2\\sqrt{2}}$$", "id": "2917150"}]}