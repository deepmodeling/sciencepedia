{"hands_on_practices": [{"introduction": "This first exercise provides a foundational, first-principles derivation of Brillouin's theorem for the simplest molecular system, $\\text{H}_2$. By explicitly constructing the canonical molecular orbitals from symmetry and applying the definitions of Hartree-Fock theory, you will directly see why the off-diagonal Fock matrix element $F_{ia}$ between an occupied and a virtual orbital is zero. This practice solidifies the crucial connection between the stationarity condition that defines canonical HF orbitals and the vanishing of the Hamiltonian matrix element between the HF ground state and singly-excited determinants, $\\langle \\Phi_0|H|\\Phi_i^a\\rangle=0$ [@problem_id:2877956].", "problem": "Consider the hydrogen molecule $\\text{H}_2$ at its equilibrium internuclear separation in a minimal basis consisting of the two $1s$ atomic orbitals centered on nuclei $A$ and $B$, denoted $\\chi_{A}$ and $\\chi_{B}$. Let the overlap integral be $S \\equiv \\langle \\chi_{A}|\\chi_{B}\\rangle$, with $0<S<1$. Assume a closed-shell restricted Hartree–Fock (RHF) description with $2$ electrons occupying a single spatial molecular orbital (MO) doubly with opposite spins. Work in atomic units. The Roothaan–Hall equations are $F C = S C \\varepsilon$, where $F$ is the Fock matrix in the atomic orbital basis, $S$ is the overlap matrix, $C$ is the coefficient matrix, and $\\varepsilon$ is the diagonal matrix of orbital energies.\n\na) Using only the inversion symmetry of $\\text{H}_2$ and the fact that the nuclei and basis functions are equivalent by the symmetry that exchanges $A$ and $B$, derive the normalized canonical molecular orbitals $\\psi_{g}$ and $\\psi_{u}$ as linear combinations of $\\chi_{A}$ and $\\chi_{B}$ in terms of the overlap $S$. Do not assume orthogonality of $\\chi_{A}$ and $\\chi_{B}$; determine the required normalization constants explicitly in terms of $S$.\n\nb) Using the RHF variational principle and the Roothaan–Hall equations, argue from first principles that in the canonical MO basis the Fock matrix is diagonal, and identify the occupied orbital $i$ and the lowest virtual orbital $a$ with $\\psi_{g}$ and $\\psi_{u}$, respectively. From this, compute the off-diagonal canonical Fock matrix element $F_{ia}$.\n\nc) Using the Slater–Condon rules for configuration interaction matrix elements and the stationarity of the RHF determinant with respect to orbital rotations, evaluate the Hamiltonian coupling $\\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle$ between the RHF reference Slater determinant $\\Phi_{0}$ and the singly excited determinant $\\Phi_{i}^{a}$ obtained by replacing one electron in the occupied spatial MO $i$ by one in the virtual spatial MO $a$ (with a fixed spin). Express your final result in Hartree.\n\nReport your final answer as the pair $\\left(F_{ia},\\,\\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle\\right)$, written as a row matrix. No numerical rounding is required.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens\n- System: Hydrogen molecule, $\\text{H}_2$, at equilibrium internuclear separation.\n- Basis set: Minimal basis of two $1s$ atomic orbitals, $\\chi_{A}$ and $\\chi_{B}$, centered on nuclei $A$ and $B$.\n- Overlap integral: $S \\equiv \\langle \\chi_{A}|\\chi_{B}\\rangle$, where $0 < S < 1$.\n- Electronic structure method: Closed-shell restricted Hartree–Fock (RHF) with $2$ electrons in a single doubly occupied spatial molecular orbital (MO).\n- Units: Atomic units (Hartrees for energy).\n- Governing equations: Roothaan–Hall equations, $F C = S C \\varepsilon$, where $F$ is the Fock matrix, $S$ is the overlap matrix, $C$ is the MO coefficient matrix, and $\\varepsilon$ is the diagonal matrix of orbital energies.\n- Symmetries: Inversion symmetry, and equivalence of nuclei and basis functions under exchange of $A$ and $B$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard illustrative example from the field of quantum chemistry. It deals with fundamental concepts of the Linear Combination of Atomic Orbitals (LCAO) approximation, Hartree-Fock theory, and Configuration Interaction (CI). The problem is well-posed; the use of symmetry and the RHF framework provides a clear path to a unique answer. The language is objective and precise. The data provided, such as the existence of an overlap $S$ where $0 < S < 1$, is physically realistic for molecular systems. The problem is self-contained and free of contradictions.\n\nStep 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe solution is structured into the three parts requested by the problem statement.\n\na) Derivation of the Canonical Molecular Orbitals\n\nThe molecular orbitals (MOs), $\\psi$, are constructed as a Linear Combination of Atomic Orbitals (LCAO), $\\chi_{A}$ and $\\chi_{B}$:\n$$ \\psi = c_{A}\\chi_{A} + c_{B}\\chi_{B} $$\nThe $\\text{H}_2$ molecule possesses inversion symmetry. Let $\\hat{I}$ be the inversion operator. The basis functions are centered on the nuclei, which are exchanged by inversion, so $\\hat{I}\\chi_{A} = \\chi_{B}$ and $\\hat{I}\\chi_{B} = \\chi_{A}$. The MOs must be eigenfunctions of the symmetry operators of the molecular point group. Thus, $\\hat{I}\\psi = \\lambda\\psi$. Applying the operator twice restores the original state, so $\\hat{I}^2\\psi = \\psi$, which implies $\\lambda^2=1$ and thus $\\lambda = \\pm 1$.\n\nFor $\\lambda = +1$ (gerade symmetry, denoted by subscript $g$):\n$$ \\hat{I}\\psi_{g} = \\hat{I}(c_{A}\\chi_{A} + c_{B}\\chi_{B}) = c_{A}\\chi_{B} + c_{B}\\chi_{A} $$\nSetting this equal to $+1 \\cdot \\psi_{g} = c_{A}\\chi_{A} + c_{B}\\chi_{B}$ yields $c_{A} = c_{B}$. The unnormalized orbital is proportional to $(\\chi_{A} + \\chi_{B})$.\n\nFor $\\lambda = -1$ (ungerade symmetry, denoted by subscript $u$):\n$$ \\hat{I}\\psi_{u} = \\hat{I}(c_{A}\\chi_{A} + c_{B}\\chi_{B}) = c_{A}\\chi_{B} + c_{B}\\chi_{A} $$\nSetting this equal to $-1 \\cdot \\psi_{u} = -c_{A}\\chi_{A} - c_{B}\\chi_{B}$ yields $c_{A} = -c_{B}$. The unnormalized orbital is proportional to $(\\chi_{A} - \\chi_{B})$.\n\nWe now normalize these orbitals. The atomic orbitals are assumed to be normalized, $\\langle \\chi_{A} | \\chi_{A} \\rangle = \\langle \\chi_{B} | \\chi_{B} \\rangle = 1$. The overlap is given as $S = \\langle \\chi_{A} | \\chi_{B} \\rangle$. Since the orbitals are real, $S = \\langle \\chi_{B} | \\chi_{A} \\rangle$.\n\nFor $\\psi_{g} = N_{g}(\\chi_{A} + \\chi_{B})$, the normalization condition $\\langle \\psi_{g} | \\psi_{g} \\rangle = 1$ gives:\n$$ N_{g}^2 \\langle \\chi_{A} + \\chi_{B} | \\chi_{A} + \\chi_{B} \\rangle = N_{g}^2 (\\langle \\chi_{A}|\\chi_{A} \\rangle + \\langle \\chi_{B}|\\chi_{B} \\rangle + \\langle \\chi_{A}|\\chi_{B} \\rangle + \\langle \\chi_{B}|\\chi_{A} \\rangle) = 1 $$\n$$ N_{g}^2 (1 + 1 + S + S) = N_{g}^2 (2 + 2S) = 1 \\implies N_{g} = \\frac{1}{\\sqrt{2(1+S)}} $$\nThus, the normalized gerade MO is:\n$$ \\psi_{g} = \\frac{1}{\\sqrt{2(1+S)}} (\\chi_{A} + \\chi_{B}) $$\nFor $\\psi_{u} = N_{u}(\\chi_{A} - \\chi_{B})$, the normalization condition $\\langle \\psi_{u} | \\psi_{u} \\rangle = 1$ gives:\n$$ N_{u}^2 \\langle \\chi_{A} - \\chi_{B} | \\chi_{A} - \\chi_{B} \\rangle = N_{u}^2 (\\langle \\chi_{A}|\\chi_{A} \\rangle + \\langle \\chi_{B}|\\chi_{B} \\rangle - \\langle \\chi_{A}|\\chi_{B} \\rangle - \\langle \\chi_{B}|\\chi_{A} \\rangle) = 1 $$\n$$ N_{u}^2 (1 + 1 - S - S) = N_{u}^2 (2 - 2S) = 1 \\implies N_{u} = \\frac{1}{\\sqrt{2(1-S)}} $$\nThus, the normalized ungerade MO is:\n$$ \\psi_{u} = \\frac{1}{\\sqrt{2(1-S)}} (\\chi_{A} - \\chi_{B}) $$\n\nb) The Fock Matrix in the Canonical MO Basis\n\nThe Roothaan–Hall equations $F C = S C \\varepsilon$ define a generalized eigenvalue problem. The solutions are the molecular orbital coefficient matrix $C$ and the diagonal matrix of orbital energies $\\varepsilon$. The columns of $C$ contain the coefficients that define the canonical MOs $\\psi_{p}$ in the AO basis.\nThe transformation from the AO basis representation of the Fock matrix, $F_{AO}$, to the MO basis representation, $F_{MO}$, is given by $F_{MO} = C^{\\dagger} F_{AO} C$.\nBy left-multiplying the Roothaan–Hall equation by $C^{\\dagger}$, we get:\n$$ C^{\\dagger} F C = C^{\\dagger} S C \\varepsilon $$\nThe canonical MOs are by definition an orthonormal set, so $\\langle \\psi_{p} | \\psi_{q} \\rangle = \\delta_{pq}$. The matrix representation of the overlap operator in the MO basis is therefore the identity matrix, $I$. We can verify this: $(C^{\\dagger} S C)_{pq} = \\langle \\psi_{p} | \\psi_{q} \\rangle = \\delta_{pq}$.\nSubstituting this into the transformed equation yields:\n$$ F_{MO} = C^{\\dagger} F C = I \\varepsilon = \\varepsilon $$\nSince $\\varepsilon$ is the diagonal matrix of orbital energies, the Fock matrix $F_{MO}$ is diagonal in the basis of canonical MOs. This is not an assumption but a direct consequence of the definition of canonical Hartree-Fock orbitals.\n\nThe orbital $\\psi_{g}$ corresponds to a constructive interference (bonding) of the AOs, leading to an accumulation of electron density between the nuclei. This lowers the energy. The orbital $\\psi_{u}$ has a nodal plane between the nuclei (antibonding), which raises the energy. Therefore, $\\varepsilon_{g} < \\varepsilon_{u}$.\nIn the RHF ground state of $\\text{H}_2$ with $2$ electrons, both electrons occupy the lowest energy spatial orbital, $\\psi_{g}$.\nThus, the occupied orbital is $i = \\psi_{g}$. The lowest-energy virtual (unoccupied) orbital is $a = \\psi_{u}$.\nThe off-diagonal element of the Fock matrix in the canonical MO basis is $F_{ia} = F_{gu}$. As established, the Fock matrix in this basis is diagonal:\n$$ F_{MO} = \\begin{pmatrix} F_{gg} & F_{gu} \\\\ F_{ug} & F_{uu} \\end{pmatrix} = \\begin{pmatrix} \\varepsilon_{g} & 0 \\\\ 0 & \\varepsilon_{u} \\end{pmatrix} $$\nTherefore, the off-diagonal element $F_{ia}$ is identically zero.\n$$ F_{ia} = F_{gu} = 0 $$\n\nc) The Hamiltonian Coupling Matrix Element $\\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle$\n\nThis is an evaluation of the matrix element that appears in Configuration Interaction (CI) theory and is central to Brillouin's theorem. The RHF ground state determinant is $\\Phi_{0} = |\\psi_{g}\\overline{\\psi_{g}}|$, where the bar denotes spin $\\beta$ and no bar denotes spin $\\alpha$. A singly excited determinant, where an electron is promoted from the occupied MO $i$ to the virtual MO $a$, is $\\Phi_{i}^{a}$. With $i=\\psi_{g}$ and $a=\\psi_{u}$, and choosing to excite the spin-$\\alpha$ electron, we have $\\Phi_{g}^{u} = |\\psi_{u}\\overline{\\psi_{g}}|$.\n\nBrillouin's theorem states that for a canonical Hartree-Fock wavefunction $\\Phi_{0}$, the Hamiltonian matrix elements between $\\Phi_{0}$ and all singly excited determinants $\\Phi_{i}^{a}$ are zero: $\\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle = 0$. This theorem is a direct consequence of the variational procedure used to obtain the Hartree-Fock orbitals. The HF energy $E_{HF} = \\langle \\Phi_{0}|H|\\Phi_{0}\\rangle$ is stationary (minimized) with respect to first-order variations in the spin-orbitals. A singly excited determinant $\\Phi_{i}^{a}$ can be shown to be the first-order component of a wavefunction obtained by an infinitesimal rotation of the occupied orbital $\\psi_i$ with the virtual orbital $\\psi_a$. The condition that the energy is stationary implies that the matrix element coupling the reference state to this first-order variation must vanish.\n\nAlternatively, we can prove this by explicit evaluation using the Slater-Condon rules and relating the result to the Fock matrix element derived in part (b). The matrix element between two determinants differing by a single spin-orbital $(\\phi_{i} \\to \\phi_{a})$ is given by:\n$$ \\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle = \\langle \\phi_{i} |h| \\phi_{a} \\rangle + \\sum_{j \\in \\mathrm{occ}} \\left( \\langle \\phi_{i}\\phi_{j}|\\frac{1}{r_{12}}|\\phi_{a}\\phi_{j} \\rangle - \\langle \\phi_{i}\\phi_{j}|\\frac{1}{r_{12}}|\\phi_{j}\\phi_{a} \\rangle \\right) $$\nwhere the sum runs over all spin-orbitals $j$ occupied in $\\Phi_{0}$. This expression is precisely the definition of the off-diagonal Fock matrix element between spin-orbitals $\\phi_{i}$ and $\\phi_{a}$, $F_{ia} = \\langle \\phi_{i}|F|\\phi_{a} \\rangle$.\nIn our specific case, the spin-orbitals are $\\phi_{i} = \\psi_{g}\\alpha$ and $\\phi_{a} = \\psi_{u}\\alpha$. The occupied spin-orbitals are $\\psi_{g}\\alpha$ and $\\psi_{g}\\beta$. We have shown in part (b) that the Fock matrix element between the canonical spatial orbitals $i=\\psi_{g}$ and $a=\\psi_{u}$ is $F_{ia}=0$. This implies that the Fock matrix element between the corresponding spin-orbitals is also zero.\nTherefore, we have the general identity:\n$$ \\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle = F_{ia} $$\nFrom part (b), we established that for canonical orbitals, $F_{ia} = 0$. Consequently, the Hamiltonian coupling is also zero.\n$$ \\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle = 0 \\text{ Hartree} $$\nThe pair of requested values is $(F_{ia}, \\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle) = (0, 0)$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 \\end{pmatrix}}\n$$", "id": "2877956"}, {"introduction": "Building on the foundational understanding, this practice introduces the power of molecular symmetry as a predictive tool. The Fock operator, like the Hamiltonian, must be totally symmetric under the operations of the molecular point group, meaning it belongs to the totally symmetric irreducible representation $\\mathrm{A}_{g}$. This exercise demonstrates how this symmetry requirement imposes strict selection rules on matrix elements, forcing many off-diagonal Fock elements $F_{ia}$ to be zero without needing to perform any explicit integration [@problem_id:2877968]. You will apply group theory to a molecule with $D_{2h}$ symmetry to see how pairs of occupied and virtual orbitals belonging to different irreducible representations are automatically uncoupled.", "problem": "Consider a closed-shell molecule whose equilibrium geometry belongs to the $D_{2h}$ point group. Assume a restricted Hartree–Fock (RHF) solution with spatial molecular orbitals (MOs) that transform as one-dimensional irreducible representations (irreps) of $D_{2h}$, namely $\\mathrm{A}_{g}$, $\\mathrm{B}_{1g}$, $\\mathrm{B}_{2g}$, $\\mathrm{B}_{3g}$, $\\mathrm{A}_{u}$, $\\mathrm{B}_{1u}$, $\\mathrm{B}_{2u}$, and $\\mathrm{B}_{3u}$. Let the occupied MOs include three orbitals labeled $i_{1}$, $i_{2}$, and $i_{3}$ with symmetry assignments $\\Gamma(i_{1})=\\mathrm{A}_{g}$, $\\Gamma(i_{2})=\\mathrm{B}_{3u}$, and $\\Gamma(i_{3})=\\mathrm{B}_{2g}$. Let the virtual MOs include four orbitals labeled $a_{1}$, $a_{2}$, $a_{3}$, and $a_{4}$ with symmetry assignments $\\Gamma(a_{1})=\\mathrm{B}_{1g}$, $\\Gamma(a_{2})=\\mathrm{A}_{u}$, $\\Gamma(a_{3})=\\mathrm{B}_{1u}$, and $\\Gamma(a_{4})=\\mathrm{B}_{2u}$.\n\nDefine the Fock matrix element between an occupied orbital $i$ and a virtual orbital $a$ as $F_{ia}=\\langle \\phi_{i}\\vert \\hat{f}\\vert \\phi_{a}\\rangle$, where $\\hat{f}$ is the RHF Fock operator. Starting only from the following foundational facts:\n- The RHF Fock operator for a closed-shell state is invariant under all operations of the molecular point group, i.e., $\\Gamma(\\hat{f})=\\mathrm{A}_{g}$.\n- An integral over all space is nonzero only if the total direct product of the irreps associated with the bra, operator, and ket contains the totally symmetric irrep.\n\nUsing these principles and group representation properties, determine the value of\n$$\nS \\;=\\; \\sum_{(i,a)\\in \\mathcal{M}} F_{ia}\n$$\nfor the set of occupied–virtual pairs\n$$\n\\mathcal{M}\\;=\\;\\{(i_{1},a_{1}),\\,(i_{1},a_{2}),\\,(i_{2},a_{3}),\\,(i_{3},a_{4})\\}.\n$$\nExpress your final answer as a single real number. No rounding is required and no units are needed.", "solution": "The problem as stated is valid. It is a well-posed problem in quantum chemistry that relies on fundamental principles of group representation theory and Hartree–Fock theory. We will now proceed with a rigorous solution based only on the provided foundational facts.\n\nThe objective is to compute the sum $S = \\sum_{(i,a)\\in \\mathcal{M}} F_{ia}$, where $F_{ia}$ is a matrix element of the Fock operator $\\hat{f}$ between an occupied spatial molecular orbital (MO) $\\phi_i$ and a virtual spatial MO $\\phi_a$. The matrix element is defined as $F_{ia} = \\langle \\phi_{i}\\vert \\hat{f}\\vert \\phi_{a}\\rangle$.\n\nThe problem provides two foundational principles. The second principle is the crucial one for this analysis: an integral over all space is nonzero only if the total direct product of the irreducible representations (irreps) associated with the bra, operator, and ket contains the totally symmetric irrep. For the $D_{2h}$ point group, the totally symmetric irrep is $\\mathrm{A}_g$.\n\nApplying this principle to the Fock matrix element $F_{ia}$, the condition for it to be non-zero is that the direct product $\\Gamma(\\phi_i) \\otimes \\Gamma(\\hat{f}) \\otimes \\Gamma(\\phi_a)$ must contain $\\mathrm{A}_g$. Here, $\\Gamma(\\Psi)$ denotes the irrep to which the function or operator $\\Psi$ belongs.\n\nThe problem states, as the first foundational fact, that the Fock operator $\\hat{f}$ for a closed-shell restricted Hartree–Fock (RHF) state is invariant under all operations of the molecular point group. This means the Fock operator belongs to the totally symmetric irrep. Thus, $\\Gamma(\\hat{f}) = \\mathrm{A}_g$.\n\nSubstituting this into our condition, we get:\n$$\n\\Gamma(\\phi_i) \\otimes \\mathrm{A}_g \\otimes \\Gamma(\\phi_a) \\supset \\mathrm{A}_g\n$$\nThe direct product of any irrep $\\Gamma$ with the totally symmetric irrep $\\mathrm{A}_g$ results in the irrep $\\Gamma$ itself. That is, $\\Gamma \\otimes \\mathrm{A}_g = \\Gamma$. Our condition therefore simplifies to:\n$$\n\\Gamma(\\phi_i) \\otimes \\Gamma(\\phi_a) \\supset \\mathrm{A}_g\n$$\nThe problem specifies that the MOs transform as one-dimensional irreps of the $D_{2h}$ group. For one-dimensional irreps, the direct product of two irreps, say $\\Gamma_1$ and $\\Gamma_2$, results in another one-dimensional irrep, $\\Gamma_3$. In this case, the statement $\\Gamma_1 \\otimes \\Gamma_2 \\supset \\mathrm{A}_g$ is equivalent to the stricter equality $\\Gamma_1 \\otimes \\Gamma_2 = \\mathrm{A}_g$.\n\nFor any group, the direct product of two irreps $\\Gamma_1$ and $\\Gamma_2$ is equal to the totally symmetric irrep if and only if $\\Gamma_1$ is the complex conjugate of $\\Gamma_2$. Since all irreps of the $D_{2h}$ point group are real (their characters are all real numbers, either $1$ or $-1$), this condition simplifies further: the product is $\\mathrm{A}_g$ if and only if the two irreps are identical.\nTherefore, the selection rule for the Fock matrix element $F_{ia}$ is that it can be non-zero only if $\\Gamma(\\phi_i) = \\Gamma(\\phi_a)$. If the symmetries of the occupied and virtual orbitals are different, the matrix element is rigorously zero.\n\nWe are tasked with computing the sum over the set $\\mathcal{M} = \\{(i_{1},a_{1}),\\,(i_{1},a_{2}),\\,(i_{2},a_{3}),\\,(i_{3},a_{4})\\}$. We will now examine each pair $(i, a)$ in this set using the derived selection rule.\n\n1.  Pair $(i_1, a_1)$:\n    The symmetries are given as $\\Gamma(i_1) = \\mathrm{A}_g$ and $\\Gamma(a_1) = \\mathrm{B}_{1g}$.\n    Since $\\mathrm{A}_g \\neq \\mathrm{B}_{1g}$, the condition $\\Gamma(i_1) = \\Gamma(a_1)$ is not satisfied.\n    Therefore, $F_{i_1 a_1} = 0$.\n\n2.  Pair $(i_1, a_2)$:\n    The symmetries are $\\Gamma(i_1) = \\mathrm{A}_g$ and $\\Gamma(a_2) = \\mathrm{A}_u$.\n    Since $\\mathrm{A}_g \\neq \\mathrm{A}_u$, the condition is not satisfied.\n    Therefore, $F_{i_1 a_2} = 0$.\n\n3.  Pair $(i_2, a_3)$:\n    The symmetries are $\\Gamma(i_2) = \\mathrm{B}_{3u}$ and $\\Gamma(a_3) = \\mathrm{B}_{1u}$.\n    Since $\\mathrm{B}_{3u} \\neq \\mathrm{B}_{1u}$, the condition is not satisfied.\n    Therefore, $F_{i_2 a_3} = 0$.\n\n4.  Pair $(i_3, a_4)$:\n    The symmetries are $\\Gamma(i_3) = \\mathrm{B}_{2g}$ and $\\Gamma(a_4) = \\mathrm{B}_{2u}$.\n    Since $\\mathrm{B}_{2g} \\neq \\mathrm{B}_{2u}$, the condition is not satisfied.\n    Therefore, $F_{i_3 a_4} = 0$.\n\nEvery single term in the sum is strictly zero due to symmetry constraints. The total sum $S$ is therefore:\n$$\nS = F_{i_1 a_1} + F_{i_1 a_2} + F_{i_2 a_3} + F_{i_3 a_4} = 0 + 0 + 0 + 0 = 0\n$$\nIt is important to recognize that this result is a manifestation of a more general principle. The molecular orbitals obtained from a canonical Hartree–Fock calculation are, by construction, eigenfunctions of the Fock operator: $\\hat{f} \\phi_k = \\epsilon_k \\phi_k$, where $\\epsilon_k$ is the energy of orbital $\\phi_k$. The matrix element $F_{ia}$ is then $F_{ia} = \\langle \\phi_i|\\hat{f}|\\phi_a \\rangle = \\langle \\phi_i|\\epsilon_a \\phi_a \\rangle = \\epsilon_a \\langle \\phi_i|\\phi_a \\rangle$. Because the set of all molecular orbitals (occupied and virtual) forms an orthonormal set, the inner product $\\langle \\phi_i|\\phi_a \\rangle = \\delta_{ia}$. As $i$ represents an occupied orbital and $a$ represents a virtual orbital, they are necessarily distinct, so $i \\neq a$ and $\\delta_{ia}=0$. This implies $F_{ia}=0$ for any occupied-virtual pair. This general result is known as Brillouin's theorem.\n\nThe problem, by providing specific symmetries that are all mismatched, constructs a scenario where this general theorem is demonstrated through a direct, case-by-case application of group theory selection rules, which is the path demanded by the problem statement. The conclusion is inescapable and rigorous: the sum is zero.", "answer": "$$\n\\boxed{0}\n$$", "id": "2877968"}, {"introduction": "This final practice bridges the gap between analytical theory and computational quantum chemistry. You are tasked with writing a simple Self-Consistent Field (SCF) program to numerically solve the Roothaan-Hall equations for a model system. By implementing the iterative algorithm that variationally minimizes the Hartree-Fock energy, you will witness how the off-diagonal occupied-virtual block of the Fock matrix is systematically diagonalized, driving the $F_{ia}$ elements to zero upon convergence [@problem_id:2877902]. This hands-on coding exercise provides a tangible confirmation of Brillouin's theorem, revealing it as an emergent property of the self-consistent field solution.", "problem": "You are to write a complete, runnable program that numerically verifies Brillouin’s theorem for closed-shell Restricted Hartree–Fock (RHF) in an orthonormal atomic orbital basis. The verification target is that for canonical Hartree–Fock orbitals, the occupied–virtual block elements $F_{ia}$ of the Fock matrix expressed in the molecular orbital basis vanish within a specified tight numerical threshold. The program must construct the RHF solution from first principles using the definitions below, without external data or user input, and report a boolean result for each provided test case.\n\nStart from the following foundational definitions and facts:\n- In RHF for a closed-shell system with an even number of electrons $N_{\\mathrm{e}}$, the number of doubly occupied spatial orbitals is $n_{\\mathrm{occ}} = N_{\\mathrm{e}}/2$, and the total number of spatial basis functions is $n$.\n- The one-electron core Hamiltonian matrix is $h_{\\mu\\nu}$ (in Hartree atomic units), and the two-electron integrals in chemist’s notation are $(\\mu\\nu\\vert\\lambda\\sigma)$.\n- The spin-summed RHF density matrix is $P_{\\mu\\nu} = 2\\sum_{i=1}^{n_{\\mathrm{occ}}} C_{\\mu i} C_{\\nu i}$, where $C_{\\mu i}$ are the molecular orbital coefficients.\n- The Fock matrix is $F_{\\mu\\nu} = h_{\\mu\\nu} + G_{\\mu\\nu}$ with $G_{\\mu\\nu} = \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma}\\left[2(\\mu\\nu\\vert\\lambda\\sigma) - (\\mu\\lambda\\vert\\nu\\sigma)\\right]$.\n- Canonical Hartree–Fock orbitals are obtained by solving $F C = S C \\varepsilon$; in this problem the basis is orthonormal so $S_{\\mu\\nu} = \\delta_{\\mu\\nu}$, and the equation reduces to $F C = C \\varepsilon$ with diagonal matrix $\\varepsilon$ of orbital energies.\n- Brillouin’s theorem (for closed-shell RHF) implies that in the canonical molecular orbital basis, the occupied–virtual Fock elements $F_{ia}$ are zero at self-consistency, where index $i$ runs over occupied orbitals and index $a$ runs over virtual orbitals.\n\nImplementation model and constraints:\n- You will work in an orthonormal basis, so $S_{\\mu\\nu} = \\delta_{\\mu\\nu}$.\n- To keep the two-electron structure simple but nontrivial, use the following reduced integral model, consistent with a zero-differential-overlap style approximation that preserves the Coulomb and a simplified exchange structure:\n  1. Define a symmetric Coulomb parameter matrix $U \\in \\mathbb{R}^{n\\times n}$ with elements $U_{\\mu\\lambda}$.\n  2. Define the two-electron tensor by $(\\mu\\nu\\vert\\lambda\\sigma) = 0$ unless $\\mu = \\nu$ and $\\lambda = \\sigma$, in which case $(\\mu\\mu\\vert\\lambda\\lambda) = U_{\\mu\\lambda}$.\n  3. Under this model, the Coulomb and exchange contributions reduce to $J_{\\mu\\nu} = \\delta_{\\mu\\nu}\\sum_{\\lambda} P_{\\lambda\\lambda} U_{\\mu\\lambda}$ and $K_{\\mu\\nu} = P_{\\mu\\nu} U_{\\mu\\nu}$, so that $F = h + 2J - K$.\n- Use a straightforward self-consistent field iteration:\n  1. Initialize $P$ from the lowest $n_{\\mathrm{occ}}$ eigenvectors of $h$.\n  2. At each iteration, build $F = h + 2J - K$, diagonalize $F$ to obtain $C$ and update $P$ from the lowest $n_{\\mathrm{occ}}$ orbitals. Use linear mixing $P \\leftarrow (1-\\alpha) P_{\\mathrm{old}} + \\alpha P_{\\mathrm{new}}$ with a mixing factor $\\alpha$.\n  3. Converge when the Frobenius norm of the change in $P$ is below a tolerance; enforce a maximum number of iterations and assume convergence for the given data.\n  4. After convergence, rebuild $F$ from the converged $P$ and obtain the canonical orbitals by diagonalizing $F$.\n- Finally, compute $F$ in the molecular orbital basis $F^{\\mathrm{MO}} = C^{\\mathsf{T}} F C$, extract the block with indices $i \\in \\{1,\\dots,n_{\\mathrm{occ}}\\}$ and $a \\in \\{n_{\\mathrm{occ}}+1,\\dots,n\\}$, and verify that all elements $F_{ia}^{\\mathrm{MO}}$ are below a given threshold $\\tau$ in absolute value. If there are no virtual orbitals ($n_{\\mathrm{occ}} = n$) or no occupied orbitals ($n_{\\mathrm{occ}} = 0$), return a boolean value of true by convention for that case.\n\nTest suite:\nFor each case below, all entries of $h$ and $U$ are in Hartree atomic units. Indices are zero-based in the input description, but you will implement them as standard arrays. In each item, $n$ is the basis size and $N_{\\mathrm{e}}$ is the number of electrons. The RHF must be closed-shell with $N_{\\mathrm{e}}$ even and $N_{\\mathrm{e}} \\le 2n$.\n\n- Case A (Neon-like closed shell with one virtual orbital):\n  - $n = 6$, $N_{\\mathrm{e}} = 10$, threshold $\\tau = 10^{-8}$.\n  - One-electron matrix $h$ (symmetric, only listed nonzero distinct elements):\n    - Diagonal: $h_{00} = -32.0$, $h_{11} = -1.8$, $h_{22} = -0.9$, $h_{33} = -0.9$, $h_{44} = -0.9$, $h_{55} = -0.2$.\n    - Off-diagonal: $h_{1,5} = h_{5,1} = -0.05$, $h_{2,5} = h_{5,2} = -0.02$, $h_{3,5} = h_{5,3} = -0.02$, $h_{4,5} = h_{5,4} = -0.02$.\n  - Coulomb parameter matrix $U$ (symmetric; only upper triangle listed, with symmetry implied):\n    - $U_{00} = 5.0$, $U_{01} = 1.5$, $U_{02} = 1.2$, $U_{03} = 1.2$, $U_{04} = 1.2$, $U_{05} = 0.8$,\n    - $U_{11} = 1.6$, $U_{12} = 1.3$, $U_{13} = 1.3$, $U_{14} = 1.3$, $U_{15} = 1.0$,\n    - $U_{22} = 1.4$, $U_{23} = 1.2$, $U_{24} = 1.2$, $U_{25} = 0.9$,\n    - $U_{33} = 1.4$, $U_{34} = 1.2$, $U_{35} = 0.9$,\n    - $U_{44} = 1.4$, $U_{45} = 0.9$,\n    - $U_{55} = 1.1$.\n\n- Case B (Beryllium-like closed shell with multiple virtuals and mild mixing):\n  - $n = 5$, $N_{\\mathrm{e}} = 4$, $\\tau = 10^{-8}$.\n  - One-electron matrix $h$:\n    - Diagonal: $h_{00} = -10.0$, $h_{11} = -1.0$, $h_{22} = -0.6$, $h_{33} = -0.6$, $h_{44} = -0.2$.\n    - Off-diagonal: $h_{1,4} = h_{4,1} = -0.05$, $h_{2,3} = h_{3,2} = -0.02$.\n  - Coulomb parameter matrix $U$:\n    - $U_{00} = 4.0$, $U_{01} = 1.2$, $U_{02} = 1.0$, $U_{03} = 1.0$, $U_{04} = 0.7$,\n    - $U_{11} = 1.5$, $U_{12} = 1.1$, $U_{13} = 1.1$, $U_{14} = 0.9$,\n    - $U_{22} = 1.2$, $U_{23} = 1.1$, $U_{24} = 0.8$,\n    - $U_{33} = 1.2$, $U_{34} = 0.8$,\n    - $U_{44} = 1.0$.\n\n- Case C (Edge case with no virtual orbitals):\n  - $n = 2$, $N_{\\mathrm{e}} = 4$, $\\tau = 10^{-8}$.\n  - One-electron matrix $h$:\n    - Diagonal: $h_{00} = -1.0$, $h_{11} = -0.5$.\n  - Coulomb parameter matrix $U$:\n    - $U_{00} = 1.0$, $U_{01} = 0.7$, $U_{11} = 0.8$.\n\nAlgorithmic requirements:\n- Implement RHF with linear mixing using a mixing factor $\\alpha = 0.7$, maximum iterations $200$, and convergence threshold on the Frobenius norm of the density change $\\lVert \\Delta P \\rVert_{\\mathrm{F}} < 10^{-12}$.\n- After convergence, evaluate $F^{\\mathrm{MO}} = C^{\\mathsf{T}} F C$, extract the occupied–virtual block, and return true if its maximum absolute element is less than the test’s $\\tau$ (or true if there are no such elements).\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for the cases A, B, and C in that order, for example: `[True, False, True]`. The elements must be the Python boolean literals \"True\" or \"False\".\n\nNo user input is permitted, and no external data sources may be used. All computations are in Hartree atomic units; the final answers are booleans, so no unit must be printed.", "solution": "The problem statement has been subjected to rigorous validation and is found to be valid. It is a well-posed, scientifically grounded problem in computational quantum chemistry that requests the numerical verification of Brillouin's theorem for a closed-shell Restricted Hartree-Fock (RHF) system within a specified simplified model. All necessary data, parameters, and algorithmic constraints are provided, allowing for a unique and verifiable solution. We shall proceed with a detailed exposition of the theoretical framework and the computational algorithm.\n\nThe objective is to implement the self-consistent field (SCF) procedure for a closed-shell molecule, as described by the RHF equations, and subsequently verify that for the resultant canonical molecular orbitals, the elements of the Fock matrix connecting occupied and virtual orbitals are numerically zero, as predicted by Brillouin's theorem.\n\nThe foundational equation of RHF theory in an orthonormal basis is the Roothaan-Hall equation, which takes the form of a matrix eigenvalue problem:\n$$\nF C = C \\varepsilon\n$$\nHere, $F$ is the Fock matrix in the atomic orbital (AO) basis, $C$ is the matrix of molecular orbital (MO) coefficients, and $\\varepsilon$ is a diagonal matrix containing the orbital energies. The basis is specified as orthonormal, hence the overlap matrix is the identity matrix, $S = I$.\n\nThe Fock matrix $F$ is defined as the sum of the one-electron core Hamiltonian $h$ and the two-electron operator $G$:\n$$\nF_{\\mu\\nu} = h_{\\mu\\nu} + G_{\\mu\\nu}\n$$\nThe two-electron part, $G_{\\mu\\nu}$, accounts for the average repulsion that one electron experiences from all other electrons. For a closed-shell system, it is given by:\n$$\nG_{\\mu\\nu} = \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right]\n$$\nwhere $(\\mu\\nu|\\lambda\\sigma)$ are the two-electron repulsion integrals in chemist's notation, and $P_{\\lambda\\sigma}$ is the density matrix. The density matrix is constructed from the MO coefficients of the $n_{\\mathrm{occ}} = N_{\\mathrm{e}}/2$ doubly occupied orbitals:\n$$\nP_{\\mu\\nu} = 2 \\sum_{i=1}^{n_{\\mathrm{occ}}} C_{\\mu i} C^*_{\\nu i}\n$$\nSince this problem deals with real-valued orbitals, the complex conjugate is omitted.\n\nThe problem introduces a simplified model for the two-electron integrals, characteristic of Zero-Differential Overlap (ZDO) approximations. The integral $(\\mu\\nu|\\lambda\\sigma)$ is non-zero only if $\\mu=\\nu$ and $\\lambda=\\sigma$, in which case its value is given by a symmetric parameter matrix $U$:\n$$\n(\\mu\\nu|\\lambda\\sigma) = U_{\\mu\\lambda} \\delta_{\\mu\\nu} \\delta_{\\lambda\\sigma}\n$$\nUnder this approximation, the general expression for $G_{\\mu\\nu}$ simplifies significantly. The Coulomb contribution, $J_{\\mu\\nu} = \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} (\\mu\\nu|\\lambda\\sigma)$, becomes:\n$$\nJ_{\\mu\\nu} = \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} (U_{\\mu\\lambda} \\delta_{\\mu\\nu} \\delta_{\\lambda\\sigma}) = \\delta_{\\mu\\nu} \\sum_{\\lambda} P_{\\lambda\\lambda} U_{\\mu\\lambda}\n$$\nThis shows that the Coulomb matrix $J$ is diagonal. The exchange contribution, $K_{\\mu\\nu} = \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} (\\mu\\lambda|\\nu\\sigma)$, becomes:\n$$\nK_{\\mu\\nu} = \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} (U_{\\mu\\nu} \\delta_{\\mu\\lambda} \\delta_{\\nu\\sigma}) = U_{\\mu\\nu} P_{\\mu\\nu}\n$$\nThis shows that the exchange matrix $K$ is the element-wise (Hadamard) product of the matrices $U$ and $P$. The full two-electron term is $G = 2J - K$, leading to the specialized Fock matrix for this problem:\n$$\nF_{\\mu\\nu} = h_{\\mu\\nu} + 2\\delta_{\\mu\\nu} \\sum_{\\lambda} P_{\\lambda\\lambda} U_{\\mu\\lambda} - P_{\\mu\\nu} U_{\\mu\\nu}\n$$\n\nThe Roothaan-Hall equation is non-linear because the Fock matrix $F$ depends on the density matrix $P$, which in turn depends on the MO coefficients $C$ that are the eigenvectors of $F$. This non-linearity necessitates an iterative solution, known as the SCF procedure. The algorithm to be implemented is as follows:\n1.  **Initialization**: An initial guess for the density matrix $P$ is required. A standard choice is to diagonalize the core Hamiltonian $h$ to obtain initial MO coefficients $C^{(0)}$ and form $P^{(0)}$ from the $n_{\\mathrm{occ}}$ eigenvectors corresponding to the lowest eigenvalues.\n2.  **SCF Iteration**: For the $k$-th iteration:\n    a. Construct the Fock matrix $F^{(k)}$ using the current density matrix $P^{(k-1)}$.\n    b. Solve the eigenvalue problem $F^{(k)} C^{(k)} = C^{(k)} \\varepsilon^{(k)}$ to obtain new MO coefficients $C^{(k)}$ and orbital energies $\\varepsilon^{(k)}$. The eigenvectors in $C^{(k)}$ must be sorted according to their corresponding eigenvalues in ascending order.\n    c. Form a new density matrix $P_{\\mathrm{new}}^{(k)}$ using the first $n_{\\mathrm{occ}}$ columns of $C^{(k)}$.\n    d. To aid convergence, apply linear mixing of the old and new density matrices using a mixing parameter $\\alpha$: $P^{(k)} = (1-\\alpha) P^{(k-1)} + \\alpha P_{\\mathrm{new}}^{(k)}$.\n    e. Check for convergence by evaluating the change in the density matrix, for instance, by computing the Frobenius norm of the difference, $\\lVert P^{(k)} - P^{(k-1)} \\rVert_{\\mathrm{F}}$. The loop terminates when this norm falls below a specified convergence threshold, $\\epsilon_{\\mathrm{conv}}$. A maximum number of iterations is enforced.\n\n3.  **Post-SCF Verification**: Upon convergence, the final density matrix $P$ and the corresponding Fock matrix $F$ are self-consistent. The eigenvectors of this final $F$ are the canonical molecular orbitals. Brillouin's theorem states that for these canonical orbitals, the Fock matrix elements between occupied orbitals (indexed by $i, j, \\dots$) and virtual orbitals (indexed by $a, b, \\dots$) are zero. To verify this, we first transform the Fock matrix from the AO basis to the MO basis:\n    $$\n    F^{\\mathrm{MO}} = C^\\mathsf{T} F C\n    $$\n    Since $C$ contains the eigenvectors of $F$, $F^{\\mathrm{MO}}$ must be a diagonal matrix equal to $\\varepsilon$. Consequently, all off-diagonal elements, including the occupied-virtual block $F^{\\mathrm{MO}}_{ia}$, must be zero. The numerical verification consists of extracting this specific block, corresponding to rows $i \\in \\{1,\\dots,n_{\\mathrm{occ}}\\}$ and columns $a \\in \\{n_{\\mathrm{occ}}+1,\\dots,n\\}$, and checking if the absolute value of every element is smaller than the given numerical threshold $\\tau$. If the set of occupied or virtual orbitals is empty, the theorem is considered trivially satisfied.\n\nThe implementation will execute this entire procedure for each test case provided. The core calculations involve matrix constructions and diagonalizations, which are well-suited for numerical libraries such as NumPy and SciPy. The final result for each case will be a boolean value indicating whether $\\max_{i,a} |F^{\\mathrm{MO}}_{ia}| < \\tau$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.linalg\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and run the RHF verification.\n    \"\"\"\n    \n    # Algorithmic parameters from the problem description\n    alpha = 0.7\n    max_iter = 200\n    conv_tol = 1e-12\n\n    test_cases = [\n        # Case A: Neon-like closed shell\n        {\n            \"name\": \"A\",\n            \"n\": 6,\n            \"Ne\": 10,\n            \"tau\": 1e-8,\n            \"h_elements\": {\n                (0, 0): -32.0, (1, 1): -1.8, (2, 2): -0.9, (3, 3): -0.9,\n                (4, 4): -0.9, (5, 5): -0.2, (1, 5): -0.05, (2, 5): -0.02,\n                (3, 5): -0.02, (4, 5): -0.02\n            },\n            \"U_elements\": {\n                (0, 0): 5.0, (0, 1): 1.5, (0, 2): 1.2, (0, 3): 1.2, (0, 4): 1.2, (0, 5): 0.8,\n                (1, 1): 1.6, (1, 2): 1.3, (1, 3): 1.3, (1, 4): 1.3, (1, 5): 1.0,\n                (2, 2): 1.4, (2, 3): 1.2, (2, 4): 1.2, (2, 5): 0.9,\n                (3, 3): 1.4, (3, 4): 1.2, (3, 5): 0.9,\n                (4, 4): 1.4, (4, 5): 0.9,\n                (5, 5): 1.1\n            }\n        },\n        # Case B: Beryllium-like closed shell\n        {\n            \"name\": \"B\",\n            \"n\": 5,\n            \"Ne\": 4,\n            \"tau\": 1e-8,\n            \"h_elements\": {\n                (0, 0): -10.0, (1, 1): -1.0, (2, 2): -0.6, (3, 3): -0.6,\n                (4, 4): -0.2, (1, 4): -0.05, (2, 3): -0.02\n            },\n            \"U_elements\": {\n                (0, 0): 4.0, (0, 1): 1.2, (0, 2): 1.0, (0, 3): 1.0, (0, 4): 0.7,\n                (1, 1): 1.5, (1, 2): 1.1, (1, 3): 1.1, (1, 4): 0.9,\n                (2, 2): 1.2, (2, 3): 1.1, (2, 4): 0.8,\n                (3, 3): 1.2, (3, 4): 0.8,\n                (4, 4): 1.0\n            }\n        },\n        # Case C: Edge case with no virtuals\n        {\n            \"name\": \"C\",\n            \"n\": 2,\n            \"Ne\": 4,\n            \"tau\": 1e-8,\n            \"h_elements\": {\n                (0, 0): -1.0, (1, 1): -0.5\n            },\n            \"U_elements\": {\n                (0, 0): 1.0, (0, 1): 0.7, (1, 1): 0.8\n            }\n        }\n    ]\n\n    def construct_symmetric_matrix(size, elements):\n        \"\"\"Helper to build symmetric matrices from a dictionary of elements.\"\"\"\n        mat = np.zeros((size, size))\n        for (i, j), val in elements.items():\n            mat[i, j] = val\n            if i != j:\n                mat[j, i] = val\n        return mat\n\n    def run_rhf_and_verify(case_data):\n        \"\"\"Performs RHF-SCF and verifies Brillouin's theorem for a single case.\"\"\"\n        n, Ne, tau = case_data[\"n\"], case_data[\"Ne\"], case_data[\"tau\"]\n        h_elements, U_elements = case_data[\"h_elements\"], case_data[\"U_elements\"]\n        \n        n_occ = Ne // 2\n\n        # Per problem specification, return True if no occupied or no virtual orbitals.\n        if n_occ == 0 or n_occ == n:\n            return True\n\n        # Construct matrices from input data\n        h = construct_symmetric_matrix(n, h_elements)\n        U = construct_symmetric_matrix(n, U_elements)\n\n        # 1. Initial Guess for Density Matrix P\n        # Diagonalize core Hamiltonian h and use lowest n_occ eigenvectors\n        _, C = scipy.linalg.eigh(h)\n        C_occ = C[:, :n_occ]\n        P = 2 * (C_occ @ C_occ.T)\n\n        # 2. SCF Iteration Loop\n        for _ in range(max_iter):\n            P_old = P.copy()\n\n            # Build Fock matrix F = h + 2J - K\n            p_diag = np.diag(P)\n            j_diag = U @ p_diag\n            J = np.diag(j_diag)\n            K = P * U\n            F = h + 2 * J - K\n\n            # Diagonalize F to get new MO coefficients\n            # eigh returns eigenvalues in ascending order, which is convenient\n            _, C = scipy.linalg.eigh(F)\n\n            # Form new density matrix P_new\n            C_occ = C[:, :n_occ]\n            P_new = 2 * (C_occ @ C_occ.T)\n\n            # Apply linear mixing\n            P = (1 - alpha) * P_old + alpha * P_new\n\n            # Check for convergence\n            delta_P = P - P_old\n            if np.linalg.norm(delta_P) < conv_tol:\n                break\n        \n        # 3. Post-SCF Verification of Brillouin's Theorem\n        # Rebuild the final Fock matrix from the converged density matrix\n        p_diag = np.diag(P)\n        j_diag = U @ p_diag\n        J = np.diag(j_diag)\n        K = P * U\n        F_final = h + 2 * J - K\n\n        # Get the canonical orbitals by diagonalizing the final Fock matrix\n        _, C_final = scipy.linalg.eigh(F_final)\n\n        # Transform the Fock matrix to the MO basis\n        F_mo = C_final.T @ F_final @ C_final\n\n        # Extract the occupied-virtual block\n        # Occupied indices: 0 to n_occ-1\n        # Virtual indices: n_occ to n-1\n        F_ov = F_mo[:n_occ, n_occ:]\n\n        # F_ov block might be empty if n_occ=n (already handled), but this is robust\n        if F_ov.size == 0:\n            return True\n            \n        # Check if the largest absolute element is below the threshold\n        max_abs_val = np.max(np.abs(F_ov))\n        \n        return max_abs_val < tau\n\n    results = []\n    for case in test_cases:\n        result = run_rhf_and_verify(case)\n        results.append(str(result))\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2877902"}]}