{"hands_on_practices": [{"introduction": "This exercise delves into the fundamental nature of spin contamination. By analyzing a broken-symmetry Unrestricted Hartree-Fock (UHF) determinant for a stretched hydrogen molecule, you will directly decompose the wavefunction into its constituent spin-pure singlet and triplet components. This practice is crucial for building a concrete intuition for what a spin-contaminated state truly is: a linear combination of states with different total spin quantum numbers [@problem_id:2925761].", "problem": "Consider the stretched hydrogen molecule $\\mathrm{H}_{2}$ described in a minimal basis of two real, normalized, localized spatial orbitals $\\phi_{A}(\\mathbf{r})$ and $\\phi_{B}(\\mathbf{r})$ centered on the two hydrogen atoms, with mutual overlap $s=\\langle \\phi_{A} \\mid \\phi_{B} \\rangle$, where $0 \\le s  1$. The unrestricted Hartree–Fock (UHF) broken-symmetry determinant with one $\\alpha$ electron localized on $A$ and one $\\beta$ electron localized on $B$ is\n$$\n\\Psi_{\\mathrm{UHF}}(1,2) \\;=\\; \\frac{1}{\\sqrt{2}}\n\\begin{vmatrix}\n\\phi_{A}(1)\\,\\alpha(1)  \\phi_{B}(1)\\,\\beta(1) \\\\\n\\phi_{A}(2)\\,\\alpha(2)  \\phi_{B}(2)\\,\\beta(2)\n\\end{vmatrix}\n\\;=\\; \\frac{1}{\\sqrt{2}}\\left[\\phi_{A}(1)\\phi_{B}(2)\\,\\alpha(1)\\beta(2)\\;-\\;\\phi_{A}(2)\\phi_{B}(1)\\,\\alpha(2)\\beta(1)\\right].\n$$\nLet $\\chi_{S}$ and $\\chi_{T}$ denote the normalized two-electron spin eigenfunctions with total spin $S=0$ (singlet, $m_{s}=0$) and $S=1$ (triplet, $m_{s}=0$), respectively:\n$$\n\\chi_{S}(1,2) \\;=\\; \\frac{1}{\\sqrt{2}}\\left[\\alpha(1)\\beta(2)-\\alpha(2)\\beta(1)\\right], \\qquad\n\\chi_{T}(1,2) \\;=\\; \\frac{1}{\\sqrt{2}}\\left[\\alpha(1)\\beta(2)+\\alpha(2)\\beta(1)\\right].\n$$\nDefine the symmetric and antisymmetric spatial combinations\n$$\n\\Phi_{+}(1,2) \\;=\\; \\phi_{A}(1)\\phi_{B}(2)+\\phi_{A}(2)\\phi_{B}(1), \\qquad\n\\Phi_{-}(1,2) \\;=\\; \\phi_{A}(1)\\phi_{B}(2)-\\phi_{A}(2)\\phi_{B}(1),\n$$\nand their normalized forms\n$$\n\\Phi_{S}^{N} \\;=\\; \\frac{\\Phi_{+}}{\\sqrt{2(1+s^{2})}}, \\qquad\n\\Phi_{A}^{N} \\;=\\; \\frac{\\Phi_{-}}{\\sqrt{2(1-s^{2})}}.\n$$\nUsing only the fundamental requirements of fermionic antisymmetry and the orthonormality of the spin functions, project $\\Psi_{\\mathrm{UHF}}$ onto the total-spin subspaces $S=0$ and $S=1$ to obtain its decomposition into spin-pure configuration state functions (CSFs),\n$$\n\\Psi_{\\mathrm{UHF}} \\;=\\; c_{S}\\,\\Phi_{S}^{N}\\chi_{S} \\;+\\; c_{T}\\,\\Phi_{A}^{N}\\chi_{T},\n$$\nwith real, nonnegative coefficients $c_{S}$ and $c_{T}$. Derive the closed-form analytic expression for the singlet amplitude $c_{S}$ as a function of the orbital overlap $s$. Express your final answer as a single simplified expression in terms of $s$. No numerical rounding is required.", "solution": "The problem is validated as well-posed and scientifically grounded. The objective is to determine the coefficient $c_{S}$ in the expansion of the provided Unrestricted Hartree–Fock wavefunction, $\\Psi_{\\mathrm{UHF}}$, into its spin-pure singlet and triplet components. The expansion is given by:\n$$\n\\Psi_{\\mathrm{UHF}} = c_{S}\\,\\Phi_{S}^{N}\\chi_{S} + c_{T}\\,\\Phi_{A}^{N}\\chi_{T}\n$$\nwhere $\\Phi_{S}^{N}\\chi_{S}$ and $\\Phi_{A}^{N}\\chi_{T}$ form an orthonormal set of configuration state functions (CSFs). The coefficients $c_{S}$ and $c_{T}$ can be found by projecting $\\Psi_{\\mathrm{UHF}}$ onto these basis functions. However, a more direct algebraic method is to re-express $\\Psi_{\\mathrm{UHF}}$ in this basis.\n\nWe begin with the definition of $\\Psi_{\\mathrm{UHF}}$:\n$$\n\\Psi_{\\mathrm{UHF}}(1,2) = \\frac{1}{\\sqrt{2}}\\left[\\phi_{A}(1)\\phi_{B}(2)\\,\\alpha(1)\\beta(2) - \\phi_{A}(2)\\phi_{B}(1)\\,\\alpha(2)\\beta(1)\\right]\n$$\nThe two-electron spin products can be decomposed into the singlet ($\\chi_{S}$) and triplet ($\\chi_{T}$) spin eigenfunctions. The required relations are derived from the definitions of $\\chi_{S}$ and $\\chi_{T}$:\n$$\n\\chi_{S}(1,2) = \\frac{1}{\\sqrt{2}}\\left[\\alpha(1)\\beta(2) - \\alpha(2)\\beta(1)\\right]\n$$\n$$\n\\chi_{T}(1,2) = \\frac{1}{\\sqrt{2}}\\left[\\alpha(1)\\beta(2) + \\alpha(2)\\beta(1)\\right]\n$$\nSolving this system of linear equations for $\\alpha(1)\\beta(2)$ and $\\alpha(2)\\beta(1)$ yields:\n$$\n\\alpha(1)\\beta(2) = \\frac{1}{\\sqrt{2}}\\left[\\chi_{S}(1,2) + \\chi_{T}(1,2)\\right]\n$$\n$$\n\\alpha(2)\\beta(1) = \\frac{1}{\\sqrt{2}}\\left[-\\chi_{S}(1,2) + \\chi_{T}(1,2)\\right]\n$$\nSubstitution of these expressions into the formula for $\\Psi_{\\mathrm{UHF}}$ gives:\n$$\n\\Psi_{\\mathrm{UHF}} = \\frac{1}{\\sqrt{2}} \\left[ \\phi_{A}(1)\\phi_{B}(2) \\frac{1}{\\sqrt{2}}(\\chi_{S} + \\chi_{T}) - \\phi_{A}(2)\\phi_{B}(1) \\frac{1}{\\sqrt{2}}(-\\chi_{S} + \\chi_{T}) \\right]\n$$\nWe collect the coefficients of $\\chi_{S}$ and $\\chi_{T}$:\n$$\n\\Psi_{\\mathrm{UHF}} = \\frac{1}{2} \\left[ \\left(\\phi_{A}(1)\\phi_{B}(2) + \\phi_{A}(2)\\phi_{B}(1)\\right)\\chi_{S} + \\left(\\phi_{A}(1)\\phi_{B}(2) - \\phi_{A}(2)\\phi_{B}(1)\\right)\\chi_{T} \\right]\n$$\nThe spatial parts are recognized as the unnormalized symmetric and antisymmetric combinations, $\\Phi_{+}$ and $\\Phi_{-}$, respectively:\n$$\n\\Psi_{\\mathrm{UHF}} = \\frac{1}{2} \\left[ \\Phi_{+} \\chi_{S} + \\Phi_{-} \\chi_{T} \\right]\n$$\nThe problem requires the decomposition in terms of the normalized spatial functions $\\Phi_{S}^{N}$ and $\\Phi_{A}^{N}$. These are related to $\\Phi_{+}$ and $\\Phi_{-}$ by their normalization constants:\n$$\n\\Phi_{S}^{N} = \\frac{\\Phi_{+}}{\\sqrt{\\langle\\Phi_{+}|\\Phi_{+}\\rangle}} = \\frac{\\Phi_{+}}{\\sqrt{2(1+s^{2})}}\n$$\n$$\n\\Phi_{A}^{N} = \\frac{\\Phi_{-}}{\\sqrt{\\langle\\Phi_{-}|\\Phi_{-}\\rangle}} = \\frac{\\Phi_{-}}{\\sqrt{2(1-s^{2})}}\n$$\nThus, we can write $\\Phi_{+} = \\sqrt{2(1+s^{2})}\\,\\Phi_{S}^{N}$ and $\\Phi_{-} = \\sqrt{2(1-s^{2})}\\,\\Phi_{A}^{N}$. Substituting these into the expression for $\\Psi_{\\mathrm{UHF}}$:\n$$\n\\Psi_{\\mathrm{UHF}} = \\frac{1}{2} \\left[ \\left(\\sqrt{2(1+s^{2})}\\,\\Phi_{S}^{N}\\right) \\chi_{S} + \\left(\\sqrt{2(1-s^{2})}\\,\\Phi_{A}^{N}\\right) \\chi_{T} \\right]\n$$\n$$\n= \\frac{\\sqrt{2(1+s^{2})}}{2} \\Phi_{S}^{N}\\chi_{S} + \\frac{\\sqrt{2(1-s^{2})}}{2} \\Phi_{A}^{N}\\chi_{T}\n$$\nBy direct comparison with the target form $\\Psi_{\\mathrm{UHF}} = c_{S}\\,\\Phi_{S}^{N}\\chi_{S} + c_{T}\\,\\Phi_{A}^{N}\\chi_{T}$, the coefficient $c_{S}$ is identified as:\n$$\nc_{S} = \\frac{\\sqrt{2(1+s^{2})}}{2}\n$$\nThis expression simplifies to:\n$$\nc_{S} = \\frac{\\sqrt{2}\\sqrt{1+s^{2}}}{2} = \\sqrt{\\frac{1+s^{2}}{2}}\n$$\nThis result is consistent with the requirement that the coefficient be real and non-negative for $s \\in [0, 1)$. It is also consistent with the normalization of $\\Psi_{\\mathrm{UHF}}$. Since the basis CSFs are orthonormal, we must have $\\langle\\Psi_{\\mathrm{UHF}}|\\Psi_{\\mathrm{UHF}}\\rangle = c_{S}^{2} + c_{T}^{2} = \\frac{1+s^{2}}{2} + \\frac{1-s^{2}}{2} = 1$. The initial UHF Slater determinant is constructed from two orthonormal spin-orbitals, as $\\langle\\phi_{A}\\alpha|\\phi_{B}\\beta\\rangle = \\langle\\phi_{A}|\\phi_{B}\\rangle\\langle\\alpha|\\beta\\rangle = s \\cdot 0 = 0$, so its norm is indeed $1$.", "answer": "$$\n\\boxed{\\sqrt{\\frac{1+s^{2}}{2}}}\n$$", "id": "2925761"}, {"introduction": "Building on the concept of spin-contaminated wavefunctions, this practice applies the spin projection technique to a quantitative problem. You will calculate the ground-state energy of the two-site Hubbard model—a cornerstone for understanding electron correlation—at different levels of theory: RHF, Projected Hartree-Fock (PHF), and the exact Full Configuration Interaction (FCI). This hands-on calculation will illuminate the strengths and weaknesses of PHF by comparing its energy to both a simpler mean-field approximation and the exact benchmark [@problem_id:2925681].", "problem": "Consider the symmetric two-site, half-filled Hubbard model with two electrons and two orthonormal, site-localized spatial orbitals. The electronic Hamiltonian is\n$$\n\\hat{H} \\;=\\; -\\,t \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\left( \\hat{a}_{1\\sigma}^{\\dagger}\\hat{a}_{2\\sigma} + \\hat{a}_{2\\sigma}^{\\dagger}\\hat{a}_{1\\sigma} \\right) \\;+\\; U \\sum_{i=1}^{2} \\hat{n}_{i\\alpha}\\hat{n}_{i\\beta},\n$$\nwhere $t \\gt 0$ is the nearest-neighbor hopping integral, $U \\gt 0$ is the on-site Coulomb repulsion, $\\hat{a}_{i\\sigma}^{\\dagger}$ creates an electron with spin $\\sigma$ on site $i$, and $\\hat{n}_{i\\sigma}=\\hat{a}_{i\\sigma}^{\\dagger}\\hat{a}_{i\\sigma}$. Take $t = 1.0 \\text{ eV}$ and $U = 6.0 \\text{ eV}$.\n\nStarting only from fundamental definitions of the Hamiltonian, Slater determinants, total spin operator, and the spin-projection operator onto total spin $S=0$, do the following:\n\n1) Derive the energy of the paramagnetic closed-shell Restricted Hartree-Fock (RHF) state obtained by doubly occupying the bonding molecular orbital formed from the two sites. Express your result as a function of $t$ and $U$, and then evaluate it for the given numerical values.\n\n2) Consider the broken-symmetry Unrestricted Hartree-Fock (UHF) determinant in which one electron with spin $\\alpha$ occupies site $1$ and one electron with spin $\\beta$ occupies site $2$, i.e., the determinant $\\lvert \\Phi_{\\text{BS}}\\rangle = \\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger}\\lvert 0\\rangle$. Construct explicitly the spin-projected singlet wavefunction $\\lvert \\Psi_{S=0}\\rangle \\propto \\hat{\\mathcal{P}}_{S=0}\\,\\lvert \\Phi_{\\text{BS}}\\rangle$ using the definition of the spin-projection operator $\\hat{\\mathcal{P}}_{S=0}$, and compute its normalized projected Hartree-Fock (PHF) energy $E_{\\text{PHF}} = \\langle \\Psi_{S=0} \\rvert \\hat{H} \\lvert \\Psi_{S=0} \\rangle$. Evaluate it for the given $t$ and $U$.\n\n3) Obtain the exact singlet Full Configuration Interaction (FCI) ground-state energy by writing the Hamiltonian in a minimal singlet basis and analytically diagonalizing the Hamiltonian matrix in that basis. Express the exact singlet energy in closed form as a function of $t$ and $U$, and then evaluate it numerically for the given parameters.\n\nFinally, compute the single quantity\n$$\n\\Delta \\;=\\; E_{\\text{PHF}} \\;-\\; E_{\\text{FCI}}\n$$\nin electronvolts, and round your answer to four significant figures. Express the final energy in eV.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a unique solution. We proceed directly to the derivation. The Hamiltonian for the two-site, two-electron Hubbard model is given by\n$$ \\hat{H} = -t \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\left( \\hat{a}_{1\\sigma}^{\\dagger}\\hat{a}_{2\\sigma} + \\hat{a}_{2\\sigma}^{\\dagger}\\hat{a}_{1\\sigma} \\right) + U \\sum_{i=1}^{2} \\hat{n}_{i\\alpha}\\hat{n}_{i\\beta} $$\nwhere $t = 1.0 \\text{ eV}$ and $U = 6.0 \\text{ eV}$.\n\nPart 1: Restricted Hartree-Fock (RHF) Energy\n\nFirst, we define the molecular orbitals (MOs) from the site-localized orbitals $\\lvert 1 \\rangle$ and $\\lvert 2 \\rangle$. The bonding ($\\lvert \\phi_b \\rangle$) and antibonding ($\\lvert \\phi_a \\rangle$) MOs are:\n$$ \\lvert \\phi_b \\rangle = \\frac{1}{\\sqrt{2}}(\\lvert 1 \\rangle + \\lvert 2 \\rangle) $$\n$$ \\lvert \\phi_a \\rangle = \\frac{1}{\\sqrt{2}}(\\lvert 1 \\rangle - \\lvert 2 \\rangle) $$\nThe one-electron part of the Hamiltonian, the hopping term $\\hat{T} = -t \\sum_{\\sigma} (\\hat{a}_{1\\sigma}^{\\dagger}\\hat{a}_{2\\sigma} + \\hat{a}_{2\\sigma}^{\\dagger}\\hat{a}_{1\\sigma})$, has matrix elements $h_{ij} = \\langle i \\rvert \\hat{h}_{core} \\lvert j \\rangle$ in the site basis where $h_{11}=h_{22}=0$ and $h_{12}=h_{21}=-t$. The energy of the bonding MO is $h_{bb} = \\langle \\phi_b \\rvert \\hat{h}_{core} \\lvert \\phi_b \\rangle = \\frac{1}{2}(\\langle 1 \\rvert + \\langle 2 \\rvert) \\hat{h}_{core} (\\lvert 1 \\rangle + \\lvert 2 \\rangle) = \\frac{1}{2}(h_{11}+h_{12}+h_{21}+h_{22}) = \\frac{1}{2}(0 - t - t + 0) = -t$.\nThe RHF state $\\lvert \\Phi_{\\text{RHF}} \\rangle$ is formed by doubly occupying the bonding orbital $\\lvert \\phi_b \\rangle$. The one-electron energy for two electrons is $2h_{bb} = -2t$.\n\nThe two-electron energy is the expectation value of the Coulomb repulsion term $\\hat{U}_{term} = U \\sum_{i=1}^{2} \\hat{n}_{i\\alpha}\\hat{n}_{i\\beta}$.\nIn the RHF approximation, the probability of finding an electron with spin $\\alpha$ on site $i$ is independent of finding an electron with spin $\\beta$ on the same site. This probability is given by the squared coefficient of the site orbital $\\lvert i \\rangle$ in the occupied MO $\\lvert \\phi_b \\rangle$.\n$$ \\langle \\hat{n}_{i\\alpha} \\rangle = |\\langle i | \\phi_b \\rangle|^2 = \\left|\\frac{1}{\\sqrt{2}}\\right|^2 = \\frac{1}{2} $$\n$$ \\langle \\hat{n}_{i\\beta} \\rangle = |\\langle i | \\phi_b \\rangle|^2 = \\frac{1}{2} $$\nThe expectation value of the double-occupancy operator within the mean-field approximation is $\\langle \\hat{n}_{i\\alpha}\\hat{n}_{i\\beta} \\rangle \\approx \\langle \\hat{n}_{i\\alpha} \\rangle \\langle \\hat{n}_{i\\beta} \\rangle = (\\frac{1}{2})(\\frac{1}{2}) = \\frac{1}{4}$.\nThe total two-electron energy is then $U (\\langle \\hat{n}_{1\\alpha}\\hat{n}_{1\\beta} \\rangle + \\langle \\hat{n}_{2\\alpha}\\hat{n}_{2\\beta} \\rangle) = U (\\frac{1}{4} + \\frac{1}{4}) = \\frac{U}{2}$.\nThe total RHF energy is the sum of the one- and two-electron contributions:\n$$ E_{\\text{RHF}} = -2t + \\frac{U}{2} $$\nFor $t=1.0 \\text{ eV}$ and $U=6.0 \\text{ eV}$, this evaluates to $E_{\\text{RHF}} = -2(1.0) + \\frac{6.0}{2} = -2.0 + 3.0 = 1.0 \\text{ eV}$.\n\nPart 2: Projected Hartree-Fock (PHF) Energy\n\nThe broken-symmetry UHF determinant is given as $\\lvert \\Phi_{\\text{BS}} \\rangle = \\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger}\\lvert 0\\rangle$. This state has $M_S=0$ but is a mixture of singlet ($S=0$) and triplet ($S=1$) components. We must project out the triplet component. The spin-projection operator for a singlet state ($S=0$) in a two-electron system (where other possibilities are $S=1$) is:\n$$ \\hat{\\mathcal{P}}_{S=0} = \\prod_{K=1} \\frac{\\hat{S}^2 - K(K+1)}{0(0+1) - K(K+1)} = \\frac{\\hat{S}^2 - 1(2)}{0 - 2} = 1 - \\frac{1}{2}\\hat{S}^2 $$\nThe action of the total spin-squared operator $\\hat{S}^2$ on $\\lvert \\Phi_{\\text{BS}} \\rangle \\equiv \\lvert 1\\alpha, 2\\beta \\rangle$ is required.\n$$ \\hat{S}^2 \\lvert 1\\alpha, 2\\beta \\rangle = (\\hat{s}_1^2 + \\hat{s}_2^2 + 2\\hat{s}_1 \\cdot \\hat{s}_2)\\lvert 1\\alpha, 2\\beta \\rangle = (\\frac{3}{4} + \\frac{3}{4} + 2\\hat{s}_{z1}\\hat{s}_{z2} + \\hat{s}_{1+}\\hat{s}_{2-} + \\hat{s}_{1-}\\hat{s}_{2+})\\lvert 1\\alpha, 2\\beta \\rangle $$\n$$ \\hat{S}^2 \\lvert 1\\alpha, 2\\beta \\rangle = (\\frac{3}{2} + 2(\\frac{1}{2})(-\\frac{1}{2}) + 0 + \\hat{s}_{1-}\\hat{s}_{2+}) \\lvert 1\\alpha, 2\\beta \\rangle = \\lvert 1\\alpha, 2\\beta \\rangle + \\lvert 1\\beta, 2\\alpha \\rangle $$\nApplying the projector:\n$$ \\hat{\\mathcal{P}}_{S=0}\\lvert \\Phi_{\\text{BS}} \\rangle = \\left(1 - \\frac{1}{2}\\hat{S}^2\\right)\\lvert 1\\alpha, 2\\beta \\rangle = \\lvert 1\\alpha, 2\\beta \\rangle - \\frac{1}{2}(\\lvert 1\\alpha, 2\\beta \\rangle + \\lvert 1\\beta, 2\\alpha \\rangle) = \\frac{1}{2}(\\lvert 1\\alpha, 2\\beta \\rangle - \\lvert 1\\beta, 2\\alpha \\rangle) $$\nThis unnormalized state has norm-squared $\\langle \\dots \\rvert \\dots \\rangle = (\\frac{1}{2})^2 (1+1) = \\frac{1}{2}$. Normalizing gives the projected wavefunction:\n$$ \\lvert \\Psi_{S=0} \\rangle = \\frac{1}{\\sqrt{2}}(\\lvert 1\\alpha, 2\\beta \\rangle - \\lvert 1\\beta, 2\\alpha \\rangle) = \\frac{1}{\\sqrt{2}}(\\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger} - \\hat{a}_{1\\beta}^{\\dagger}\\hat{a}_{2\\alpha}^{\\dagger})\\lvert 0\\rangle $$\nThis is the purely covalent Heitler-London singlet state. Its energy is $E_{\\text{PHF}} = \\langle \\Psi_{S=0} \\rvert \\hat{H} \\lvert \\Psi_{S=0} \\rangle$.\nThe expectation value of the Coulomb term $\\hat{U}_{term}$ is zero, as this state contains no configurations with two electrons on the same site (no double occupancy):\n$$ \\langle \\Psi_{S=0} \\rvert \\hat{U}_{term} \\lvert \\Psi_{S=0} \\rangle = 0 $$\nThe expectation value of the hopping term $\\hat{T}$ is also zero, because $\\hat{T}$ only connects the covalent state to orthogonal ionic states, making the matrix element $\\langle \\Psi_{S=0} \\rvert \\hat{T} \\lvert \\Psi_{S=0} \\rangle$ zero.\nTherefore, the PHF energy is:\n$$ E_{\\text{PHF}} = 0 + 0 = 0 \\text{ eV} $$\n\nPart 3: Full Configuration Interaction (FCI) Energy\n\nFor the minimal singlet basis, we consider the two states that can mix under the action of the Hamiltonian: the covalent singlet state and the symmetric ionic singlet state.\n$$ \\lvert \\Psi_1 \\rangle = \\lvert \\Psi_{cov} \\rangle = \\frac{1}{\\sqrt{2}}(\\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger} - \\hat{a}_{1\\beta}^{\\dagger}\\hat{a}_{2\\alpha}^{\\dagger})\\lvert 0 \\rangle $$\n$$ \\lvert \\Psi_2 \\rangle = \\lvert \\Psi_{ion} \\rangle = \\frac{1}{\\sqrt{2}}(\\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{1\\beta}^{\\dagger} + \\hat{a}_{2\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger})\\lvert 0 \\rangle $$\nWe construct the $2 \\times 2$ Hamiltonian matrix $\\mathbf{H}$ in this basis.\nThe diagonal element $H_{11} = \\langle \\Psi_{cov} \\rvert \\hat{H} \\lvert \\Psi_{cov} \\rangle$ is precisely the PHF energy calculated above. Thus, $H_{11} = 0$.\nThe diagonal element $H_{22} = \\langle \\Psi_{ion} \\rvert \\hat{H} \\lvert \\Psi_{ion} \\rangle$. The hopping term $\\hat{T}$ has zero expectation value for $\\lvert \\Psi_{ion} \\rangle$. The Coulomb term gives $U$ for each component of $\\lvert \\Psi_{ion} \\rangle$, so $H_{22} = \\frac{1}{2}(U+U) = U$.\nThe off-diagonal element $H_{12} = \\langle \\Psi_{cov} \\rvert \\hat{H} \\lvert \\Psi_{ion} \\rangle$. The $\\hat{U}_{term}$ does not contribute. The hopping term $\\hat{T}$ connects the covalent and ionic states. By applying $\\hat{T}$ to the components of $\\lvert\\Psi_{ion}\\rangle$, one can show that $\\hat{T} \\lvert \\Psi_{ion} \\rangle = -2t \\lvert \\Psi_{cov} \\rangle$. Thus, the matrix element becomes $H_{12} = \\langle \\Psi_{cov} \\rvert (-2t \\lvert \\Psi_{cov} \\rangle) = -2t$. Since $\\hat{H}$ is Hermitian, $H_{21} = -2t$.\nThe Hamiltonian matrix is:\n$$ \\mathbf{H} = \\begin{pmatrix} 0  -2t \\\\ -2t  U \\end{pmatrix} $$\nThe eigenvalues are found by solving the characteristic equation $\\det(\\mathbf{H} - E\\mathbf{I})=0$:\n$$ (-E)(U-E) - (-2t)^2 = 0 \\implies E^2 - UE - 4t^2 = 0 $$\nThe solutions are $E = \\frac{U \\pm \\sqrt{U^2 + 16t^2}}{2}$.\nThe FCI ground state energy is the lower eigenvalue:\n$$ E_{\\text{FCI}} = \\frac{U - \\sqrt{U^2 + 16t^2}}{2} $$\nFor $t=1.0 \\text{ eV}$ and $U=6.0 \\text{ eV}$:\n$$ E_{\\text{FCI}} = \\frac{6.0 - \\sqrt{6.0^2 + 16(1.0)^2}}{2} = \\frac{6.0 - \\sqrt{52}}{2} = 3.0 - \\sqrt{13} \\approx -0.60555 \\text{ eV} $$\n\nFinal Calculation\n\nThe required quantity is $\\Delta = E_{\\text{PHF}} - E_{\\text{FCI}}$.\n$$ \\Delta = 0 - \\left(\\frac{U - \\sqrt{U^2 + 16t^2}}{2}\\right) = \\frac{\\sqrt{U^2 + 16t^2} - U}{2} $$\nSubstituting the numerical values:\n$$ \\Delta = \\frac{\\sqrt{52} - 6.0}{2} = \\sqrt{13} - 3.0 \\approx 3.605551275 - 3.0 = 0.605551275 \\text{ eV} $$\nRounding to four significant figures gives $\\Delta = 0.6056 \\text{ eV}$.", "answer": "$$\\boxed{0.6056}$$", "id": "2925681"}, {"introduction": "A desirable property of any electronic structure method is size-extensivity, which ensures that the energy of $n$ non-interacting systems is simply $n$ times the energy of one. This exercise explores a well-known deficiency of spin-projected methods: their lack of size-extensivity. By deriving and implementing a model for a chain of non-interacting fragments, you will quantify this error and see firsthand how it scales with system size, a critical consideration for applications in materials science and large molecular systems [@problem_id:2925756].", "problem": "Consider a linear chain of $n$ noninteracting hydrogen molecules $\\mathrm{H}_2$, each described by a single deformed collinear unrestricted determinant $\\lvert \\Phi \\rangle$ that breaks spin symmetry at large bond length. We study the spin-singlet projection of the product state using Projected Hartree–Fock (PHF), here meaning spin projection after variation. The objective is to quantify the size-extensivity error of PHF for the $n$-fragment product by analyzing how the projected energy scales with $n$.\n\nUse the following first-principles foundations and definitions:\n\n- The total spin projection operator onto spin $S=0$ is\n$$\n\\hat{P}^{S=0} = \\frac{1}{8\\pi^2} \\int d\\Omega \\, \\hat{R}(\\Omega),\n$$\nwhere $\\hat{R}(\\Omega)$ is the spin-rotation operator parameterized by Euler angles $\\Omega$, and $d\\Omega$ is the Haar measure on $\\mathrm{SU}(2)$. For collinear determinants and singlet projection, the integral reduces to a single polar angle $\\beta \\in [0,\\pi]$ with measure $w(\\beta)\\,d\\beta = \\tfrac{1}{2}\\sin\\beta\\,d\\beta$.\n\n- For a single deformed fragment, define the overlap kernel\n$$\nk(\\beta) = \\langle \\Phi \\lvert \\hat{R}(\\beta) \\rvert \\Phi \\rangle,\n$$\nand the Hamiltonian kernel for a spin-free one- and two-body Hamiltonian $\\hat{h}$,\n$$\n\\varepsilon(\\beta) = \\langle \\Phi \\lvert \\hat{h}\\, \\hat{R}(\\beta) \\rvert \\Phi \\rangle.\n$$\nIt is convenient to introduce the reduced energy kernel $e(\\beta)$ by $\\varepsilon(\\beta) = e(\\beta)\\,k(\\beta)$.\n\n- For $n$ noninteracting identical fragments, the Hamiltonian is $\\hat{H} = \\sum_{i=1}^{n} \\hat{h}^{(i)}$ and the product state is $\\lvert \\Phi^{(n)} \\rangle = \\bigotimes_{i=1}^{n} \\lvert \\Phi \\rangle$. The projected energy for total spin $S=0$ is\n$$\nE_n = \\frac{ \\langle \\Phi^{(n)} \\lvert \\hat{H}\\, \\hat{P}^{S=0} \\rvert \\Phi^{(n)} \\rangle }{ \\langle \\Phi^{(n)} \\lvert \\hat{P}^{S=0} \\rvert \\Phi^{(n)} \\rangle }.\n$$\nUsing the factorization of kernels for noninteracting fragments and the commutation of $\\hat{H}$ with spin rotations, one arrives at the integral representation\n$$\nE_n = \\frac{ n \\int_{0}^{\\pi} w(\\beta)\\, e(\\beta)\\, k(\\beta)^n \\, d\\beta }{ \\int_{0}^{\\pi} w(\\beta)\\, k(\\beta)^n \\, d\\beta }.\n$$\n\nTo render the problem concrete while retaining physical invariances, consider the minimal rotationally invariant parametrization\n$$\nt \\equiv \\sin^2\\left(\\frac{\\beta}{2}\\right) \\in [0,1], \\quad w(\\beta)\\,d\\beta = dt,\n$$\nand choose\n$$\nk(t; p) = 1 - p\\, t, \\qquad e(t; E_0, a) = E_0 + a\\, t,\n$$\nwith $p \\in [0,1)$ quantifying the spin polarization of the deformed determinant (with $p=0$ corresponding to a spin-pure reference) and $(E_0,a)$ real parameters (in hartree) describing the reduced energy kernel to first order in the rotation-invariant scalar $t$. In this model, for each fragment the projected energy reduces to averages over the unit interval with weight $k(t)^m$ for a nonnegative integer $m$.\n\nDefine the size-extensivity error as\n$$\n\\Delta_n \\equiv E_n - n E_1.\n$$\n\nTasks:\n\n1) Starting from the definitions above and the noninteracting fragment assumption, derive expressions for $E_n$ and $E_1$ in terms of integrals over $t \\in [0,1]$ involving $k(t)$ and $e(t)$ only.\n\n2) Show that with the given parametrization $\\varepsilon(t) = e(t) k(t)$, one can write\n$$\nE_n = n \\left[ E_0 + a \\frac{ \\int_{0}^{1} t \\, k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt } \\right],\n$$\nand hence\n$$\n\\Delta_n = n a \\left( \\frac{ \\int_{0}^{1} t \\, k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt } - \\frac{ \\int_{0}^{1} t \\, k(t)^1 \\, dt }{ \\int_{0}^{1} k(t)^1 \\, dt } \\right).\n$$\n\n3) Evaluate the integrals analytically for\n$$\nk(t) = 1 - p t, \\quad p \\in [0,1),\n$$\nnamely derive closed-form expressions, valid for integer $m \\ge 0$,\n$$\nD_m(p) \\equiv \\int_{0}^{1} (1 - p t)^m \\, dt, \\qquad T_m(p) \\equiv \\int_{0}^{1} t (1 - p t)^m \\, dt,\n$$\nand then express the error as\n$$\n\\Delta_n = n a \\left( \\frac{T_n(p)}{D_n(p)} - \\frac{T_1(p)}{D_1(p)} \\right).\n$$\nAll energies are in hartree. Handle the limiting case $p=0$ by taking the appropriate limits of your closed forms.\n\n4) Implement a program that, using only the formulas derived in this problem, computes $\\Delta_n$ for the following test suite of parameter sets $(n,p,E_0,a)$:\n- $(1,\\, 0.6,\\, -1.0,\\, 0.2)$,\n- $(5,\\, 0.0,\\, -1.0,\\, 0.2)$,\n- $(4,\\, 0.6,\\, -1.0,\\, 0.2)$,\n- $(50,\\, 0.6,\\, -1.0,\\, 0.2)$,\n- $(10,\\, 0.95,\\, -1.0,\\, 0.5)$.\nReturn the list of $\\Delta_n$ values as floating-point numbers. All energies must be computed in hartree, and your output values therefore represent hartree. The output unit must not be printed; just return the numeric values.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[x1,x2,x3,x4,x5]\").", "solution": "The problem as stated is valid. It is a well-defined theoretical exercise in quantum chemistry that explores the concept of size-extensivity error in the context of Projected Hartree-Fock theory using a simplified, but physically motivated, model. All definitions, parameters, and objectives are specified with sufficient clarity and rigor to permit a unique analytical and computational solution. We proceed with the derivation as requested.\n\nThe derivation is segmented into the tasks outlined in the problem statement.\n\n**Task 1: Expressions for $E_n$ and $E_1$**\n\nThe problem provides the general integral representation for the projected energy of $n$ noninteracting fragments:\n$$\nE_n = \\frac{ n \\int_{0}^{\\pi} w(\\beta)\\, e(\\beta)\\, k(\\beta)^n \\, d\\beta }{ \\int_{0}^{\\pi} w(\\beta)\\, k(\\beta)^n \\, d\\beta }\n$$\nWe are given the coordinate transformation $t = \\sin^2(\\beta/2)$, which implies $dt = \\frac{1}{2} (2\\sin(\\beta/2)\\cos(\\beta/2)) d\\beta = \\frac{1}{2}\\sin\\beta d\\beta$. This is precisely the given integration measure $w(\\beta)d\\beta$. The integration limits $\\beta \\in [0, \\pi]$ correspond to $t \\in [0, 1]$.\n\nBy directly substituting the change of variables into the expression for $E_n$, we obtain the expression in terms of integrals over $t$:\n$$\nE_n = \\frac{ n \\int_{0}^{1} e(t) k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt }\n$$\nThe expression for $E_1$ is obtained by setting $n=1$ in the above formula:\n$$\nE_1 = \\frac{ 1 \\int_{0}^{1} e(t) k(t)^1 \\, dt }{ \\int_{0}^{1} k(t)^1 \\, dt }\n$$\nThis completes the first task.\n\n**Task 2: Derivation of $E_n$ and $\\Delta_n$ expressions**\n\nWe are given the parametrizations $e(t) = E_0 + a t$ and the fact that $\\varepsilon(t) = e(t)k(t)$. The starting point is the expression for $E_n$ derived in Task 1. We substitute the linear model for $e(t)$:\n$$\nE_n = \\frac{ n \\int_{0}^{1} (E_0 + a t) k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt }\n$$\nBy linearity of the integral, we can separate the numerator:\n$$\nE_n = \\frac{ n \\left( \\int_{0}^{1} E_0 k(t)^n \\, dt + \\int_{0}^{1} a t k(t)^n \\, dt \\right) }{ \\int_{0}^{1} k(t)^n \\, dt }\n$$\nSince $E_0$ and $a$ are constants, they can be factored out of the integrals:\n$$\nE_n = \\frac{ n \\left( E_0 \\int_{0}^{1} k(t)^n \\, dt + a \\int_{0}^{1} t k(t)^n \\, dt \\right) }{ \\int_{0}^{1} k(t)^n \\, dt }\n$$\nDistributing the denominator to each term in the numerator yields:\n$$\nE_n = n \\left( E_0 \\frac{ \\int_{0}^{1} k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt } + a \\frac{ \\int_{0}^{1} t k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt } \\right)\n$$\nThis simplifies to the required expression:\n$$\nE_n = n \\left[ E_0 + a \\frac{ \\int_{0}^{1} t \\, k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt } \\right]\n$$\nNow, we derive the expression for the size-extensivity error, $\\Delta_n \\equiv E_n - n E_1$. Using the above result for $E_n$ and $E_1$ (by setting $n=1$):\n$$\nE_1 = 1 \\cdot \\left[ E_0 + a \\frac{ \\int_{0}^{1} t \\, k(t)^1 \\, dt }{ \\int_{0}^{1} k(t)^1 \\, dt } \\right]\n$$\nThen, the error $\\Delta_n$ is:\n$$\n\\Delta_n = n \\left[ E_0 + a \\frac{ \\int_{0}^{1} t \\, k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt } \\right] - n \\left[ E_0 + a \\frac{ \\int_{0}^{1} t \\, k(t)^1 \\, dt }{ \\int_{0}^{1} k(t)^1 \\, dt } \\right]\n$$\nThe terms involving $nE_0$ cancel:\n$$\n\\Delta_n = n a \\left( \\frac{ \\int_{0}^{1} t \\, k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt } - \\frac{ \\int_{0}^{1} t \\, k(t)^1 \\, dt }{ \\int_{0}^{1} k(t)^1 \\, dt } \\right)\n$$\nThis confirms the second required expression.\n\n**Task 3: Analytical Evaluation of Integrals and Final Expression for $\\Delta_n$**\n\nWe must evaluate the integrals $D_m(p)$ and $T_m(p)$ for $k(t) = 1 - p t$ with $p \\in [0, 1)$ and integer $m \\ge 0$.\n\nFirst, consider the integral $D_m(p)$:\n$$\nD_m(p) = \\int_{0}^{1} (1 - p t)^m \\, dt\n$$\nIf $p=0$, the integrand is $1^m=1$, so $D_m(0) = \\int_{0}^{1} 1 \\, dt = 1$.\nIf $p \\neq 0$, we use the substitution $u = 1 - p t$, which gives $du = -p \\, dt$. The integration limits change from $t=0,1$ to $u=1, 1-p$.\n$$\nD_m(p) = \\int_{1}^{1-p} u^m \\left(-\\frac{du}{p}\\right) = \\frac{1}{p} \\int_{1-p}^{1} u^m \\, du = \\frac{1}{p} \\left[ \\frac{u^{m+1}}{m+1} \\right]_{1-p}^{1}\n$$\n$$\nD_m(p) = \\frac{1}{p(m+1)} \\left( 1^{m+1} - (1-p)^{m+1} \\right) = \\frac{1 - (1-p)^{m+1}}{p(m+1)}\n$$\nThis closed form for $p \\neq 0$ correctly approaches $1$ as $p \\to 0$, as can be verified using L'Hôpital's rule.\n\nNext, we evaluate the integral $T_m(p)$:\n$$\nT_m(p) = \\int_{0}^{1} t (1 - p t)^m \\, dt\n$$\nIf $p=0$, the integral becomes $T_m(0) = \\int_{0}^{1} t \\, dt = 1/2$.\nIf $p \\neq 0$, we use integration by parts with $u=t$ and $dv=(1-pt)^m dt$. Then $du=dt$ and $v = -\\frac{(1-pt)^{m+1}}{p(m+1)}$.\n$$\nT_m(p) = \\left[ -\\frac{t(1-pt)^{m+1}}{p(m+1)} \\right]_0^1 - \\int_0^1 \\left(-\\frac{(1-pt)^{m+1}}{p(m+1)}\\right) dt\n$$\n$$\nT_m(p) = -\\frac{(1-p)^{m+1}}{p(m+1)} + \\frac{1}{p(m+1)} \\int_0^1 (1-pt)^{m+1} dt\n$$\n$$\nT_m(p) = -\\frac{(1-p)^{m+1}}{p(m+1)} + \\frac{D_{m+1}(p)}{p(m+1)} = -\\frac{(1-p)^{m+1}}{p(m+1)} + \\frac{1 - (1-p)^{m+2}}{p^2(m+1)(m+2)}\n$$\n$$\nT_m(p) = \\frac{-p(m+2)(1-p)^{m+1} + 1 - (1-p)^{m+2}}{p^2(m+1)(m+2)}\n$$\n$$\nT_m(p) = \\frac{1 - (1-p)^{m+1}[p(m+2) + (1-p)]}{p^2(m+1)(m+2)} = \\frac{1 - (1-p)^{m+1}[1 + p(m+1)]}{p^2(m+1)(m+2)}\n$$\nThis form correctly yields the limit $1/2$ as $p \\to 0$, consistent with our direct calculation.\n\nUsing these definitions, the size-extensivity error $\\Delta_n$ is expressed as:\n$$\n\\Delta_n = n a \\left( \\frac{T_n(p)}{D_n(p)} - \\frac{T_1(p)}{D_1(p)} \\right)\n$$\nThis completes the analytical derivation. The subsequent task is numerical implementation.", "answer": "```python\nimport numpy as np\n\ndef D_m(m: int, p: float) - float:\n    \"\"\"\n    Computes the integral D_m(p) = integral from 0 to 1 of (1 - p*t)^m dt.\n    This corresponds to the denominator of the energy expression.\n    \n    Args:\n        m (int): The exponent, a non-negative integer. Corresponds to n or 1.\n        p (float): The spin polarization parameter, p in [0, 1).\n\n    Returns:\n        float: The value of the integral D_m(p).\n    \"\"\"\n    if p == 0.0:\n        return 1.0\n    \n    # Using float literals for calculations.\n    m_plus_1 = float(m + 1)\n    \n    # This formula is derived in the solution text. It is valid for p != 0.\n    return (1.0 - (1.0 - p)**m_plus_1) / (p * m_plus_1)\n\ndef T_m(m: int, p: float) - float:\n    \"\"\"\n    Computes the integral T_m(p) = integral from 0 to 1 of t*(1 - p*t)^m dt.\n    This corresponds to the moment integral in the numerator of the energy expression.\n\n    Args:\n        m (int): The exponent, a non-negative integer. Corresponds to n or 1.\n        p (float): The spin polarization parameter, p in [0, 1).\n\n    Returns:\n        float: The value of the integral T_m(p).\n    \"\"\"\n    if p == 0.0:\n        # If p=0, the integral is integral of t dt from 0 to 1.\n        return 0.5\n    \n    m_plus_1 = float(m + 1)\n    m_plus_2 = float(m + 2)\n    \n    # This form is derived to be numerically stable and avoids cancellation errors.\n    numerator = 1.0 - (1.0 - p)**m_plus_1 * (1.0 + p * m_plus_1)\n    denominator = p**2 * m_plus_1 * m_plus_2\n    \n    return numerator / denominator\n\ndef calculate_delta_n(n: int, p: float, a: float) - float:\n    \"\"\"\n    Calculates the size-extensivity error Delta_n based on the derived formulas.\n    The error is defined as Delta_n = E_n - n * E_1.\n\n    Args:\n        n (int): The number of noninteracting fragments.\n        p (float): The spin polarization parameter.\n        a (float): The linear coefficient of the reduced energy kernel e(t).\n\n    Returns:\n        float: The size-extensivity error in hartree.\n    \"\"\"\n    # The term t_m = T_m(p) / D_m(p) represents the expectation value of t\n    # over the distribution k(t)^m. The error is proportional to the difference\n    # in this expectation value for an n-fragment versus a 1-fragment system.\n    \n    # For n=1, the error is zero by definition. The formula also naturally gives 0.\n    if n == 1:\n        return 0.0\n\n    # For p=0, the system is spin-pure and size-extensive, so the error is 0.\n    if p == 0.0:\n        return 0.0\n\n    # Average of t for a system of n fragments\n    ratio_n = T_m(n, p) / D_m(n, p)\n    \n    # Average of t for a single fragment\n    ratio_1 = T_m(1, p) / D_m(1, p)\n    \n    delta_n = n * a * (ratio_n - ratio_1)\n    return delta_n\n\ndef solve():\n    \"\"\"\n    Main function to execute the problem's tasks for the given test suite.\n    \"\"\"\n    # Test suite of parameters (n, p, E_0, a).\n    # The parameter E_0 is not required for the calculation of the error Delta_n.\n    test_cases = [\n        (1, 0.6, -1.0, 0.2),\n        (5, 0.0, -1.0, 0.2),\n        (4, 0.6, -1.0, 0.2),\n        (50, 0.6, -1.0, 0.2),\n        (10, 0.95, -1.0, 0.5),\n    ]\n\n    results = []\n    for n, p, E_0, a in test_cases:\n        delta_n = calculate_delta_n(n, p, a)\n        results.append(delta_n)\n\n    # The final output must be a single line containing a comma-separated\n    # list of floating-point numbers enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver\nsolve()\n```", "id": "2925756"}]}