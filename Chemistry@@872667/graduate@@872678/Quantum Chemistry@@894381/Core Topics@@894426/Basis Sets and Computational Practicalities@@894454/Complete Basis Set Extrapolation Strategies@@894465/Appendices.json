{"hands_on_practices": [{"introduction": "The cornerstone of Complete Basis Set (CBS) extrapolation is the two-point formula derived from the asymptotic behavior of the correlation energy. This first exercise provides a direct, hands-on application of this principle. By using two correlation energy data points from consecutive correlation-consistent basis sets, you will algebraically eliminate the unknown prefactor and solve for the CBS limit, a fundamental skill for any quantum chemist performing high-accuracy calculations [@problem_id:2880601].", "problem": "In correlated electronic structure calculations with correlation-consistent basis sets, the correlation energy $E_c(n)$ computed with a basis set characterized by the cardinal number $n$ is observed to approach the Complete Basis Set (CBS) limit $E_{c,\\infty}$ according to a leading-order inverse-power law in $n$, namely that there exists a constant $A$ and a positive exponent $\\alpha$ such that\n$$\nE_c(n) = E_{c,\\infty} + A n^{-\\alpha}.\n$$\nThis behavior arises from the systematic recovery of electron-electron cusp and dynamical correlation contributions as $n$ increases. Assume this asymptotic model holds for the given data and that the exponent is known.\n\nYou have obtained correlation energies at two consecutive cardinal numbers, $E_c(4) = -0.2500$ a.u. and $E_c(5) = -0.2550$ a.u., with $\\alpha = 3$. Using only the stated asymptotic model and first principles of algebraic elimination, determine the CBS limit $E_{c,\\infty}$ and the estimated residual correlation energy at cardinal number $5$, defined as\n$$\n\\Delta E_{\\text{res}}(5) \\equiv E_{c,\\infty} - E_c(5).\n$$\nReport your final answers as a row vector $\\bigl(E_{c,\\infty},\\, \\Delta E_{\\text{res}}(5)\\bigr)$ in that order. Round both quantities to six significant figures. Express all energies in atomic units (Hartree).", "solution": "We begin with the stated asymptotic model for the correlation energy $E_c(n)$ as a function of the basis set cardinal number $n$:\n$$\nE_c(n) = E_{c,\\infty} + A n^{-\\alpha}\n$$\nHere, $E_{c,\\infty}$ is the correlation energy at the Complete Basis Set (CBS) limit, and $A$ is a constant specific to the system under study. The exponent $\\alpha$ is given as $\\alpha = 3$.\n\nWe are provided with two data points:\n1. For $n_1 = 4$, the correlation energy is $E_c(4) = -0.2500$ atomic units.\n2. For $n_2 = 5$, the correlation energy is $E_c(5) = -0.2550$ atomic units.\n\nSubstituting these values into the model equation yields a system of two linear equations for the two unknown parameters, $E_{c,\\infty}$ and $A$:\n$$\nE_c(4) = E_{c,\\infty} + A \\cdot 4^{-3} \\quad (1)\n$$\n$$\nE_c(5) = E_{c,\\infty} + A \\cdot 5^{-3} \\quad (2)\n$$\nTo solve this system, we shall use algebraic elimination. We can express the parameter $A$ in terms of $E_{c,\\infty}$ and the known quantities from each equation. From equation (1):\n$$\nA = 4^3 \\left( E_c(4) - E_{c,\\infty} \\right)\n$$\nFrom equation (2):\n$$\nA = 5^3 \\left( E_c(5) - E_{c,\\infty} \\right)\n$$\nEquating these two expressions for $A$ allows us to eliminate it:\n$$\n4^3 \\left( E_c(4) - E_{c,\\infty} \\right) = 5^3 \\left( E_c(5) - E_{c,\\infty} \\right)\n$$\nWe now solve for the CBS limit energy, $E_{c,\\infty}$. Expanding the terms:\n$$\n4^3 E_c(4) - 4^3 E_{c,\\infty} = 5^3 E_c(5) - 5^3 E_{c,\\infty}\n$$\nRearranging the terms to isolate $E_{c,\\infty}$:\n$$\n5^3 E_{c,\\infty} - 4^3 E_{c,\\infty} = 5^3 E_c(5) - 4^3 E_c(4)\n$$\n$$\nE_{c,\\infty} \\left( 5^3 - 4^3 \\right) = 5^3 E_c(5) - 4^3 E_c(4)\n$$\nThis yields the general two-point extrapolation formula for $E_{c,\\infty}$:\n$$\nE_{c,\\infty} = \\frac{5^3 E_c(5) - 4^3 E_c(4)}{5^3 - 4^3}\n$$\nNow, we substitute the given numerical values. The powers of the cardinal numbers are $4^3 = 64$ and $5^3 = 125$.\n$$\nE_{c,\\infty} = \\frac{125 \\cdot (-0.2550) - 64 \\cdot (-0.2500)}{125 - 64}\n$$\nWe compute the numerator and the denominator separately.\nDenominator: $125 - 64 = 61$.\nNumerator: $125 \\cdot (-0.2550) - 64 \\cdot (-0.2500) = -31.875 - (-16.0) = -31.875 + 16.0 = -15.875$.\nThus, the CBS limit energy is:\n$$\nE_{c,\\infty} = \\frac{-15.875}{61} \\approx -0.2602459016... \\text{ a.u.}\n$$\nRounding this to six significant figures, we get $E_{c,\\infty} = -0.260246$ a.u.\n\nNext, we must determine the estimated residual correlation energy at cardinal number $5$, which is defined as $\\Delta E_{\\text{res}}(5) \\equiv E_{c,\\infty} - E_c(5)$. Using our calculated value for $E_{c,\\infty}$ and the given value for $E_c(5)$:\n$$\n\\Delta E_{\\text{res}}(5) = (-0.2602459016...) - (-0.2550)\n$$\n$$\n\\Delta E_{\\text{res}}(5) = -0.0052459016... \\text{ a.u.}\n$$\nRounding this value to six significant figures gives $\\Delta E_{\\text{res}}(5) = -0.00524590$ a.u.\n\nThe final answer consists of the pair $(E_{c,\\infty}, \\Delta E_{\\text{res}}(5))$, with both values rounded to six significant figures.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.260246 & -0.00524590\n\\end{pmatrix}\n}\n$$", "id": "2880601"}, {"introduction": "High-accuracy thermochemical predictions often rely on composite methods like Coupled-Cluster with Singles, Doubles, and perturbative Triples (CCSD(T)), where different energy components exhibit distinct basis set convergence rates. A naive extrapolation of the total energy can be less accurate than a more nuanced, component-wise approach. This practice guides you through a realistic scenario where you will extrapolate the CCSD and (T) correlation energy components separately before assembling the final CBS-limit total energy, mirroring the best practices used in modern research [@problem_id:2880606].", "problem": "A closed-shell molecule is computed with correlation-consistent polarized valence $X$-zeta basis sets, where $X \\in \\{3,4,5\\}$ is the cardinal number. The total coupled-cluster with singles and doubles and perturbative triples energy (CCSD(T)) is decomposed as $E_{\\mathrm{tot}}(X) = E_{\\mathrm{HF}}(X) + E_{c}^{\\mathrm{CCSD}}(X) + E^{(T)}(X)$, where $E_{\\mathrm{HF}}$ is the Hartree–Fock energy, $E_{c}^{\\mathrm{CCSD}}$ is the correlation energy from Coupled-Cluster with Singles and Doubles (CCSD), and $E^{(T)}$ is the perturbative triples correction. For correlation-consistent basis sets, it is a well-tested fact that the leading basis-set incompleteness error of correlation energies decays asymptotically as a power law in the cardinal number $X$, with exponent tied to the angular-momentum convergence of the correlation hole.\n\nYou are given the following data (energies in Hartree, $\\mathrm{E_h}$):\n- Hartree–Fock energy at $X=5$: $E_{\\mathrm{HF}}(5) = -76.026760\\ \\mathrm{E_h}$.\n- CCSD correlation energies: $E_{c}^{\\mathrm{CCSD}}(3) = -0.182450\\ \\mathrm{E_h}$, $E_{c}^{\\mathrm{CCSD}}(4) = -0.201300\\ \\mathrm{E_h}$, $E_{c}^{\\mathrm{CCSD}}(5) = -0.210100\\ \\mathrm{E_h}$.\n- Perturbative triples contributions: $E^{(T)}(3) = -0.017820\\ \\mathrm{E_h}$, $E^{(T)}(4) = -0.019950\\ \\mathrm{E_h}$, $E^{(T)}(5) = -0.021000\\ \\mathrm{E_h}$.\n\nAssume:\n- The Hartree–Fock energy is effectively converged at $X=5$ and may be taken as the complete-basis-set (CBS) Hartree–Fock limit, i.e., $E_{\\mathrm{HF}}(\\infty) \\approx E_{\\mathrm{HF}}(5)$.\n- For both $E_{c}^{\\mathrm{CCSD}}$ and $E^{(T)}$, the leading basis-set error scales as $X^{-3}$ in the asymptotic regime.\n\nUsing only these assumptions and restricting to the largest two cardinal numbers $X=4$ and $X=5$ for each correlation component, perform separate two-point CBS extrapolations for $E_{c}^{\\mathrm{CCSD}}$ and $E^{(T)}$, then assemble the total $E_{\\mathrm{tot}}(\\infty)$ at the CCSD(T)/CBS level. Express your final answer in Hartree and round to six significant figures.", "solution": "The total electronic energy at the CCSD(T) level of theory with a basis set of cardinal number $X$ is given by the sum:\n$$\nE_{\\mathrm{tot}}(X) = E_{\\mathrm{HF}}(X) + E_{c}^{\\mathrm{CCSD}}(X) + E^{(T)}(X)\n$$\nThe objective is to determine the energy in the complete basis set limit, $E_{\\mathrm{tot}}(\\infty)$, by extrapolating each component separately.\n$$\nE_{\\mathrm{tot}}(\\infty) = E_{\\mathrm{HF}}(\\infty) + E_{c}^{\\mathrm{CCSD}}(\\infty) + E^{(T)}(\\infty)\n$$\nThe problem provides the following data and assumptions:\n1.  The Hartree-Fock energy is assumed to be converged at the $X=5$ level: $E_{\\mathrm{HF}}(\\infty) \\approx E_{\\mathrm{HF}}(5) = -76.026760\\ \\mathrm{E_h}$.\n2.  The correlation energy components, $E_{\\text{corr}}(X)$ (representing either $E_{c}^{\\mathrm{CCSD}}(X)$ or $E^{(T)}(X)$), follow an asymptotic formula for large $X$:\n    $$\n    E_{\\text{corr}}(X) = E_{\\text{corr}}(\\infty) + A X^{-3}\n    $$\n    where $E_{\\text{corr}}(\\infty)$ is the CBS limit of the correlation energy and $A$ is a constant specific to the component.\n\nTo find $E_{\\text{corr}}(\\infty)$, a two-point extrapolation scheme is employed using the data for the two largest available cardinal numbers, $X_i=4$ and $X_j=5$. This creates a system of two linear equations for the two unknowns, $E_{\\text{corr}}(\\infty)$ and $A$:\n$$\nE_{\\text{corr}}(X_i) = E_{\\text{corr}}(\\infty) + A X_i^{-3}\n$$\n$$\nE_{\\text{corr}}(X_j) = E_{\\text{corr}}(\\infty) + A X_j^{-3}\n$$\nSolving this system for $E_{\\text{corr}}(\\infty)$ yields the general extrapolation formula:\n$$\nE_{\\text{corr}}(\\infty) = \\frac{X_j^3 E_{\\text{corr}}(X_j) - X_i^3 E_{\\text{corr}}(X_i)}{X_j^3 - X_i^3}\n$$\nWe apply this formula separately to the CCSD correlation energy and the perturbative triples correction.\n\nFirst, for the CCSD correlation energy, $E_{c}^{\\mathrm{CCSD}}$, with $X_i=4$ and $X_j=5$:\nThe given data are $E_{c}^{\\mathrm{CCSD}}(4) = -0.201300\\ \\mathrm{E_h}$ and $E_{c}^{\\mathrm{CCSD}}(5) = -0.210100\\ \\mathrm{E_h}$.\nThe cardinal numbers are $X_i=4$ and $X_j=5$. We compute the powers: $4^3 = 64$ and $5^3 = 125$.\n$$\nE_{c}^{\\mathrm{CCSD}}(\\infty) = \\frac{5^3 E_{c}^{\\mathrm{CCSD}}(5) - 4^3 E_{c}^{\\mathrm{CCSD}}(4)}{5^3 - 4^3} = \\frac{125 \\times (-0.210100) - 64 \\times (-0.201300)}{125 - 64}\n$$\n$$\nE_{c}^{\\mathrm{CCSD}}(\\infty) = \\frac{-26.2625 - (-12.8832)}{61} = \\frac{-13.3793}{61} \\approx -0.21933278\\ \\mathrm{E_h}\n$$\n\nSecond, for the perturbative triples correction, $E^{(T)}$, with $X_i=4$ and $X_j=5$:\nThe given data are $E^{(T)}(4) = -0.019950\\ \\mathrm{E_h}$ and $E^{(T)}(5) = -0.021000\\ \\mathrm{E_h}$.\n$$\nE^{(T)}(\\infty) = \\frac{5^3 E^{(T)}(5) - 4^3 E^{(T)}(4)}{5^3 - 4^3} = \\frac{125 \\times (-0.021000) - 64 \\times (-0.019950)}{125 - 64}\n$$\n$$\nE^{(T)}(\\infty) = \\frac{-2.625 - (-1.2768)}{61} = \\frac{-1.3482}{61} \\approx -0.02210164\\ \\mathrm{E_h}\n$$\n\nFinally, we assemble the total CCSD(T)/CBS energy by summing the components:\n$$\nE_{\\mathrm{tot}}(\\infty) = E_{\\mathrm{HF}}(\\infty) + E_{c}^{\\mathrm{CCSD}}(\\infty) + E^{(T)}(\\infty)\n$$\nUsing the assumed CBS Hartree-Fock energy and the extrapolated correlation energies:\n$$\nE_{\\mathrm{tot}}(\\infty) \\approx -76.026760 + (-0.21933278) + (-0.02210164)\n$$\n$$\nE_{\\mathrm{tot}}(\\infty) \\approx -76.26819442\\ \\mathrm{E_h}\n$$\nThe problem requires the final answer to be rounded to six significant figures. The calculated value is $-76.26819442...$. The first six significant digits are $7$, $6$, $2$, $6$, $8$, $1$. The seventh digit is $9$, so we round up the sixth digit.\n$$\nE_{\\mathrm{tot}}(\\infty) \\approx -76.2682\\ \\mathrm{E_h}\n$$\nThis is the final estimated total energy at the CCSD(T)/CBS level.", "answer": "$$\n\\boxed{-76.2682}\n$$", "id": "2880606"}, {"introduction": "A single two-point extrapolation provides only a point estimate of the CBS limit, giving no insight into the uncertainty of this prediction. To build a more robust understanding, we can turn to statistical methods like bootstrapping. This advanced practice challenges you to implement a program that assesses the uncertainty in a CBS estimate by resampling from a set of pairwise extrapolations, providing not just a single number but a statistically meaningful confidence interval for your result [@problem_id:2880589].", "problem": "Implement a complete, runnable program that estimates the complete basis set (CBS) limit for a molecule from finite-basis total electronic energies using a bootstrap over available adjacent basis pairs. Work within the following rigorously defined framework.\n\nPhysical and mathematical base. In correlation-consistent basis set sequences with cardinal number $n$ (for example, Dunning’s cc-pV$n$Z family), well-tested asymptotic behavior supports that the total electronic energy $E(n)$ of a fixed electronic structure method (for example, Coupled Cluster with Singles, Doubles, and perturbative Triples (CCSD(T))) converges toward the complete basis set (CBS) limit $E_{\\mathrm{CBS}}$ as an inverse power of the effective cardinal $(n+s)$:\n$$\nE(n) \\;=\\; E_{\\mathrm{CBS}} \\;+\\; \\dfrac{A}{(n+s)^{p}},\n$$\nwhere $A$ is an unknown coefficient, $p \\gt 0$ is a chosen convergence exponent, and $s \\ge 0$ is a chosen shift. This type of inverse-power convergence is widely used and consistent with the asymptotic behavior of correlation-consistent basis sets for correlation energies; the same parametric form is frequently and successfully used for total energies when $p$ and $s$ are chosen appropriately for the level of theory and property of interest.\n\nYour tasks:\n\n1. Derive, from the base convergence model above, a two-point estimator for $E_{\\mathrm{CBS}}$ using any adjacent pair of cardinal numbers $(n_{1},n_{2})$ with $n_{2} \\gt n_{1}$ and corresponding total energies $E(n_{1})$ and $E(n_{2})$. Your derivation must start from the stated asymptotic model and eliminate the nuisance parameter $A$ to obtain a closed-form estimator for $E_{\\mathrm{CBS}}$ in terms of $(n_{1},n_{2},E(n_{1}),E(n_{2}),p,s)$. Do not assume any additional empirical fitting beyond the given two data points.\n\n2. Construct all available adjacent basis pairs from the provided sequence of cardinal numbers $\\{n\\}$ and associated energies $\\{E(n)\\}$. For example, if the provided cardinals are $\\{3,4,5,6\\}$, the available adjacent pairs are $(3,4)$, $(4,5)$, and $(5,6)$.\n\n3. Implement a bootstrap procedure over the available adjacent basis pairs to obtain an empirical distribution of CBS estimates. Specifically:\n   - Let there be $M$ adjacent pairs. For each bootstrap replicate, draw $M$ pairs with replacement from the $M$ available pairs, compute the two-point $E_{\\mathrm{CBS}}$ estimate for each drawn pair, and aggregate these $M$ values using the sample median to form a single bootstrap replicate CBS estimate.\n   - Repeat this procedure for $B$ bootstrap replicates to generate an empirical distribution of CBS estimates.\n   - Summarize this distribution by reporting the sample median, the central $68\\%$ interval (from the empirical $0.16$ and $0.84$ quantiles), and the central $95\\%$ interval (from the empirical $0.025$ and $0.975$ quantiles).\n\n4. Units and rounding. All energies are in Hartree. Report all requested numerical outputs in Hartree and round each reported number to $6$ decimal places.\n\n5. Randomness control. Use a pseudo-random number generator with a fixed seed of $123456$ to enable reproducibility.\n\n6. Output format. Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case contributes a list of $5$ floats in the order [median, low68, high68, low95, high95]. For example:\n\"[[-76.280000,-76.290000,-76.270000,-76.295000,-76.265000],[...],...]\"\nThere must be no additional output text.\n\nTest suite. Implement your solution for the following four test cases. Each test case is specified by the tuple (cardinals, energies, exponent p, shift s, bootstrap replicates B). The bootstrap replicates $B$ must be applied exactly as given, and the aggregation within each bootstrap replicate must be the sample median of the pairwise CBS estimates.\n\n- Case A (monotone approach, standard inverse-cube model):\n  - Cardinals: $[3,4,5,6]$\n  - Energies (Hartree): $[-76.023400,-76.165800,-76.224900,-76.254300]$\n  - Exponent: $p=3$\n  - Shift: $s=0$\n  - Bootstrap replicates: $B=10000$\n\n- Case B (same data, alternative exponent and shifted cardinal):\n  - Cardinals: $[3,4,5,6]$\n  - Energies (Hartree): $[-76.023400,-76.165800,-76.224900,-76.254300]$\n  - Exponent: $p=4$\n  - Shift: $s=0.5$\n  - Bootstrap replicates: $B=10000$\n\n- Case C (boundary case with a single adjacent pair):\n  - Cardinals: $[5,6]$\n  - Energies (Hartree): $[-76.224900,-76.254300]$\n  - Exponent: $p=3$\n  - Shift: $s=0$\n  - Bootstrap replicates: $B=10000$\n\n- Case D (slightly non-monotone data to test robustness):\n  - Cardinals: $[3,4,5,6]$\n  - Energies (Hartree): $[-108.920500,-108.951800,-108.949500,-108.956000]$\n  - Exponent: $p=3$\n  - Shift: $s=0$\n  - Bootstrap replicates: $B=10000$\n\nFinal required behavior. Your program must hard-code the above test suite, execute the derivation and bootstrap for each case, and print a single line with the nested list of rounded results as specified. No user input is permitted. Ensure scientific realism, internal consistency, and correct use of the asymptotic convergence base without introducing unvalidated assumptions. All outputs must be in Hartree, rounded to $6$ decimal places, and printed in the exact single-line bracketed format described.", "solution": "The primary task is to derive a two-point extrapolation formula for the complete basis set energy, $E_{\\mathrm{CBS}}$, from the given asymptotic model:\n$$E(n) = E_{\\mathrm{CBS}} + \\dfrac{A}{(n+s)^{p}}$$\nHere, $E(n)$ represents the total electronic energy computed with a basis set of cardinal number $n$, $A$ is an unknown coefficient, $p > 0$ is a specified convergence exponent, and $s \\ge 0$ is a specified cardinal number shift.\n\nFor any adjacent pair of cardinal numbers $(n_{1}, n_{2})$ with $n_{2} > n_{1}$ and their corresponding energies $(E(n_{1}), E(n_{2}))$, we can formulate a system of two linear equations in the unknowns $E_{\\mathrm{CBS}}$ and $A$:\n$$\n\\begin{cases}\nE(n_{1}) = E_{\\mathrm{CBS}} + \\dfrac{A}{(n_{1}+s)^{p}} & (1) \\\\\nE(n_{2}) = E_{\\mathrm{CBS}} + \\dfrac{A}{(n_{2}+s)^{p}} & (2)\n\\end{cases}\n$$\nTo solve for $E_{\\mathrm{CBS}}$, we must first eliminate the nuisance parameter $A$. We can rearrange equations $(1)$ and $(2)$ to isolate the term containing $A$:\n$$\n\\begin{cases}\nE(n_{1}) - E_{\\mathrm{CBS}} = \\dfrac{A}{(n_{1}+s)^{p}} \\\\\nE(n_{2}) - E_{\\mathrm{CBS}} = \\dfrac{A}{(n_{2}+s)^{p}}\n\\end{cases}\n$$\nThis allows us to express $A$ in two distinct ways:\n$$\n\\begin{cases}\nA = (E(n_{1}) - E_{\\mathrm{CBS}})(n_{1}+s)^{p} \\\\\nA = (E(n_{2}) - E_{\\mathrm{CBS}})(n_{2}+s)^{p}\n\\end{cases}\n$$\nBy equating these two expressions for $A$, the parameter is eliminated:\n$$\n(E(n_{1}) - E_{\\mathrm{CBS}})(n_{1}+s)^{p} = (E(n_{2}) - E_{\\mathrm{CBS}})(n_{2}+s)^{p}\n$$\nWe now expand this equation to solve for $E_{\\mathrm{CBS}}$:\n$$\nE(n_{1})(n_{1}+s)^{p} - E_{\\mathrm{CBS}}(n_{1}+s)^{p} = E(n_{2})(n_{2}+s)^{p} - E_{\\mathrm{CBS}}(n_{2}+s)^{p}\n$$\nNext, we consolidate all terms involving $E_{\\mathrm{CBS}}$ on one side of the equation:\n$$\nE_{\\mathrm{CBS}}(n_{2}+s)^{p} - E_{\\mathrm{CBS}}(n_{1}+s)^{p} = E(n_{2})(n_{2}+s)^{p} - E(n_{1})(n_{1}+s)^{p}\n$$\nFactoring out $E_{\\mathrm{CBS}}$ gives:\n$$\nE_{\\mathrm{CBS}} \\left[ (n_{2}+s)^{p} - (n_{1}+s)^{p} \\right] = E(n_{2})(n_{2}+s)^{p} - E(n_{1})(n_{1}+s)^{p}\n$$\nFinally, by dividing by the term in the square brackets, we obtain the closed-form two-point estimator for the complete basis set energy:\n$$\nE_{\\mathrm{CBS}} = \\dfrac{E(n_{2})(n_{2}+s)^{p} - E(n_{1})(n_{1}+s)^{p}}{(n_{2}+s)^{p} - (n_{1}+s)^{p}}\n$$\nThis formula is the foundation for the required computational procedure.\n\nThe subsequent steps involve implementing a bootstrap statistical analysis based on this formula. The algorithm is as follows:\n1. From the input sequences of cardinal numbers $\\{n\\}$ of length $N$ and energies $\\{E(n)\\}$, we form $M = N-1$ adjacent pairs $(n_{i}, n_{i+1})$ and their corresponding energies $(E(n_{i}), E(n_{i+1}))$.\n2. For each of these $M$ pairs, we compute a pairwise CBS estimate, $E_{\\mathrm{CBS}}^{(i)}$, using the derived formula. This yields a base set of $M$ estimates.\n3. A bootstrap procedure is executed for $B$ replicates. For each replicate:\n    a. A new sample of size $M$ is drawn *with replacement* from the base set of $M$ pairwise CBS estimates.\n    b. The sample median of this new sample is calculated. This value is a single bootstrap replicate of the CBS energy.\n4. This process generates an empirical distribution of $B$ bootstrap medians. This distribution is then analyzed to provide the final statistical summary.\n5. The summary consists of the sample median of the $B$ bootstrap medians, the central $68\\%$ confidence interval (defined by the empirical $0.16$ and $0.84$ quantiles), and the central $95\\%$ confidence interval (defined by the empirical $0.025$ and $0.975$ quantiles).\n6. To ensure reproducibility, the pseudo-random number generator is initialized with a fixed seed of $123456$.\n7. All final numerical results are reported in Hartree and rounded to $6$ decimal places.\n\nThe following program implements this entire workflow for the provided test suite.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a bootstrap procedure to estimate the complete basis set (CBS) limit\n    for molecular electronic energies and provides statistical uncertainty estimates.\n    \"\"\"\n\n    # Set the fixed seed for the pseudo-random number generator for reproducibility.\n    np.random.seed(123456)\n\n    # Define the test cases from the problem statement.\n    # Format: (cardinals, energies, exponent p, shift s, bootstrap replicates B)\n    test_cases = [\n        (\n            [3, 4, 5, 6],\n            [-76.023400, -76.165800, -76.224900, -76.254300],\n            3.0,\n            0.0,\n            10000\n        ),\n        (\n            [3, 4, 5, 6],\n            [-76.023400, -76.165800, -76.224900, -76.254300],\n            4.0,\n            0.5,\n            10000\n        ),\n        (\n            [5, 6],\n            [-76.224900, -76.254300],\n            3.0,\n            0.0,\n            10000\n        ),\n        (\n            [3, 4, 5, 6],\n            [-108.920500, -108.951800, -108.949500, -108.956000],\n            3.0,\n            0.0,\n            10000\n        )\n    ]\n\n    def calculate_cbs_two_point(n1, e1, n2, e2, p, s):\n        \"\"\"\n        Calculates the CBS limit using the two-point extrapolation formula.\n        \"\"\"\n        n1s_p = (n1 + s)**p\n        n2s_p = (n2 + s)**p\n        \n        numerator = e2 * n2s_p - e1 * n1s_p\n        denominator = n2s_p - n1s_p\n        \n        # Denominator will not be zero since n2 > n1, p > 0, s >= 0\n        return numerator / denominator\n\n    all_results = []\n    for case in test_cases:\n        cardinals, energies, p, s, B = case\n\n        # 1. Generate all adjacent pairs and compute their pairwise CBS estimates.\n        num_pairs = len(cardinals) - 1\n        pairwise_cbs_estimates = []\n        for i in range(num_pairs):\n            n1, e1 = cardinals[i], energies[i]\n            n2, e2 = cardinals[i+1], energies[i+1]\n            cbs_est = calculate_cbs_two_point(n1, e1, n2, e2, p, s)\n            pairwise_cbs_estimates.append(cbs_est)\n\n        M = len(pairwise_cbs_estimates)\n\n        # 2. Perform the bootstrap procedure.\n        bootstrap_medians = []\n        if M > 0:\n            for _ in range(B):\n                # Draw M samples with replacement from the pairwise estimates.\n                resampled_estimates = np.random.choice(pairwise_cbs_estimates, size=M, replace=True)\n                # Aggregate using the sample median.\n                replicate_median = np.median(resampled_estimates)\n                bootstrap_medians.append(replicate_median)\n        else:\n            # This case will not occur with the given test suite.\n            # If it did, results would be undefined.\n            # We can use NaN as a placeholder for robustness.\n            all_results.append([np.nan] * 5)\n            continue\n\n        # 3. Summarize the bootstrap distribution.\n        # The bootstrap distribution is the list of B replicate medians.\n        final_median = np.median(bootstrap_medians)\n        \n        # Calculate quantiles for 68% and 95% central intervals.\n        quantiles = np.quantile(bootstrap_medians, [0.16, 0.84, 0.025, 0.975])\n        low68, high68 = quantiles[0], quantiles[1]\n        low95, high95 = quantiles[2], quantiles[3]\n\n        # 4. Collect and round the results to 6 decimal places.\n        case_result = [final_median, low68, high68, low95, high95]\n        rounded_result = [round(x, 6) for x in case_result]\n        all_results.append(rounded_result)\n\n    # 5. Format the final output string exactly as required.\n    result_strings = []\n    for res_list in all_results:\n        formatted_nums = [f'{x:.6f}' for x in res_list]\n        result_strings.append(f'[{\",\".join(formatted_nums)}]')\n    \n    final_output_str = f\"[{','.join(result_strings)}]\"\n    print(final_output_str)\n\nsolve()\n```", "id": "2880589"}]}