{"hands_on_practices": [{"introduction": "The Local Density Approximation (LDA) forms the foundational first rung of Jacob's Ladder, but it suffers from a fundamental self-interaction error (SIE). In this exercise ([@problem_id:2890214]), you will analytically calculate the exchange energy for the hydrogen atom using the LDA functional. By comparing this result to the exact exchange energy, you will quantify the magnitude of this spurious self-interaction, providing a concrete understanding of one of the primary motivations for developing more advanced functionals.", "problem": "Consider the first rung of Jacob’s ladder of density functional approximations, the Local (Spin) Density Approximation (LSDA), for the exchange energy in Kohn–Sham density functional theory (DFT). The LSDA exchange functional for a general spin density $(n_{\\uparrow},n_{\\downarrow})$ is defined by\n$$\nE_{x}^{\\mathrm{LSDA}}[n_{\\uparrow},n_{\\downarrow}] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\int \\left(n_{\\uparrow}(\\mathbf{r})^{4/3} + n_{\\downarrow}(\\mathbf{r})^{4/3}\\right)\\, d\\mathbf{r}.\n$$\nFor a one-electron system, the spin density is fully polarized, so that $n_{\\uparrow}(\\mathbf{r}) = n(\\mathbf{r})$ and $n_{\\downarrow}(\\mathbf{r})=0$. The exact Kohn–Sham exchange energy for a one-electron system must cancel the classical Coulomb (Hartree) self-interaction, where the Hartree energy is\n$$\nE_{H}[n] \\;=\\; \\frac{1}{2}\\int \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\, d\\mathbf{r}\\, d\\mathbf{r'}.\n$$\nHence, for a true one-electron density, the exact exchange energy is $E_{x}^{\\mathrm{exact}}[n] = -E_{H}[n]$ and the correlation energy is zero.\n\nTake the hydrogen atom ground-state (one-electron) density in atomic units (Hartree atomic units) as\n$$\nn(\\mathbf{r}) \\;=\\; \\frac{1}{\\pi}\\,\\exp(-2 r),\n$$\nwhere $r = |\\mathbf{r}|$ and the Bohr radius is $a_{0}=1$.\n\nStarting from these definitions, and without introducing any other approximations, carry out the necessary integrals to:\n1) evaluate the LSDA exchange energy $E_{x}^{\\mathrm{LSDA}}[n]$ for the given density, and\n2) quantify the residual exchange self-interaction error by comparing to the exact one-electron exchange, i.e., compute\n$$\n\\Delta_{x} \\;=\\; E_{x}^{\\mathrm{LSDA}}[n] - E_{x}^{\\mathrm{exact}}[n] \\;=\\; E_{x}^{\\mathrm{LSDA}}[n] + E_{H}[n].\n$$\n\nExpress your final answers as exact analytic expressions in hartree. No numerical rounding is required. Provide both requested quantities in your final answer.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, and internally consistent. It presents a standard calculation in density functional theory, albeit with a specified form of the LSDA functional that must be strictly adhered to. The task is to compute the LSDA exchange energy for the hydrogen atom ground-state density and the corresponding residual self-interaction error. We proceed with the derivation.\n\nThe problem requires the calculation of two quantities: the LSDA exchange energy, $E_{x}^{\\mathrm{LSDA}}[n]$, and the residual exchange self-interaction error, $\\Delta_{x}$. We will compute these in sequence.\n\nFirst, we evaluate the LSDA exchange energy $E_{x}^{\\mathrm{LSDA}}[n]$. The problem provides the functional:\n$$\nE_{x}^{\\mathrm{LSDA}}[n_{\\uparrow},n_{\\downarrow}] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\int \\left(n_{\\uparrow}(\\mathbf{r})^{4/3} + n_{\\downarrow}(\\mathbf{r})^{4/3}\\right)\\, d\\mathbf{r}\n$$\nFor a one-electron system such as the hydrogen atom, the spin density is fully polarized. We set $n_{\\uparrow}(\\mathbf{r}) = n(\\mathbf{r})$ and $n_{\\downarrow}(\\mathbf{r}) = 0$. The functional simplifies to:\n$$\nE_{x}^{\\mathrm{LSDA}}[n] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\int n(\\mathbf{r})^{4/3}\\, d\\mathbf{r}\n$$\nThe ground-state density of the hydrogen atom is given in atomic units as:\n$$\nn(\\mathbf{r}) \\;=\\; \\frac{1}{\\pi}\\,\\exp(-2 r)\n$$\nwhere $r=|\\mathbf{r}|$. We raise the density to the power of $4/3$:\n$$\nn(\\mathbf{r})^{4/3} \\;=\\; \\left(\\frac{1}{\\pi}\\,\\exp(-2 r)\\right)^{4/3} \\;=\\; \\frac{1}{\\pi^{4/3}}\\,\\exp\\left(-\\frac{8}{3} r\\right)\n$$\nThe integral is over all space. Since the integrand is spherically symmetric, we can use spherical coordinates and integrate over the angular variables, which yields a factor of $4\\pi$. The volume element is $d\\mathbf{r} = 4\\pi r^2 dr$.\n$$\n\\int n(\\mathbf{r})^{4/3}\\, d\\mathbf{r} \\;=\\; \\int_0^\\infty \\frac{1}{\\pi^{4/3}}\\,\\exp\\left(-\\frac{8}{3} r\\right) (4\\pi r^2)\\,dr \\;=\\; \\frac{4\\pi}{\\pi^{4/3}} \\int_0^\\infty r^2 \\exp\\left(-\\frac{8}{3} r\\right)\\,dr \\;=\\; 4\\pi^{-1/3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{8}{3} r\\right)\\,dr\n$$\nThis is a standard integral of the form $\\int_0^\\infty x^n \\exp(-ax)\\,dx = \\frac{n!}{a^{n+1}}$. Here, $n=2$ and $a=8/3$.\n$$\n\\int_0^\\infty r^2 \\exp\\left(-\\frac{8}{3} r\\right)\\,dr \\;=\\; \\frac{2!}{(8/3)^3} \\;=\\; \\frac{2}{512/27} \\;=\\; \\frac{54}{512} \\;=\\; \\frac{27}{256}\n$$\nSubstituting this result back, we find the integrated density term:\n$$\n\\int n(\\mathbf{r})^{4/3}\\, d\\mathbf{r} \\;=\\; 4\\pi^{-1/3} \\left(\\frac{27}{256}\\right) \\;=\\; \\frac{27}{64}\\pi^{-1/3}\n$$\nNow, we compute $E_{x}^{\\mathrm{LSDA}}[n]$:\n$$\nE_{x}^{\\mathrm{LSDA}}[n] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\left(\\frac{27}{64}\\pi^{-1/3}\\right) \\;=\\; -\\frac{3}{4} \\frac{3^{1/3}}{\\pi^{1/3}} \\frac{27}{64}\\pi^{-1/3} \\;=\\; -\\frac{3 \\cdot 3^{1/3} \\cdot 3^3}{4 \\cdot 64 \\cdot \\pi^{2/3}} \\;=\\; -\\frac{3^{1+1/3+3}}{256 \\pi^{2/3}} \\;=\\; -\\frac{3^{13/3}}{256\\pi^{2/3}}\n$$\n\nNext, we evaluate the residual self-interaction error $\\Delta_x = E_{x}^{\\mathrm{LSDA}}[n] + E_{H}[n]$. This requires the calculation of the Hartree energy $E_H[n]$.\n$$\nE_{H}[n] \\;=\\; \\frac{1}{2}\\int \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\, d\\mathbf{r}\\, d\\mathbf{r'}\n$$\nThis is the classical electrostatic self-energy of the charge distribution $n(\\mathbf{r})$. It can be computed as $E_H[n] = \\frac{1}{2}\\int n(\\mathbf{r})\\phi(\\mathbf{r})\\,d\\mathbf{r}$, where $\\phi(\\mathbf{r})$ is the electrostatic potential generated by the density $n(\\mathbf{r})$. For a spherically symmetric density $n(r)$, the potential $\\phi(r)$ at a distance $r$ from the origin is given by:\n$$\n\\phi(r) \\;=\\; \\frac{1}{r} \\int_0^r n(r')\\,4\\pi r'^2\\,dr' + \\int_r^\\infty \\frac{n(r')\\,4\\pi r'^2}{r'}\\,dr'\n$$\nUsing $n(r') = \\frac{1}{\\pi}\\exp(-2r')$, the first term (charge enclosed in sphere of radius $r$, divided by $r$) is:\n$$\n\\frac{1}{r} \\int_0^r \\frac{1}{\\pi}\\exp(-2r')\\,4\\pi r'^2\\,dr' = \\frac{4}{r} \\int_0^r r'^2 \\exp(-2r')\\,dr' = \\frac{4}{r} \\left[-\\frac{\\exp(-2r')}{2}(r'^2+r'+1/2)\\right]_0^r = \\frac{1}{r}\\left[1 - \\exp(-2r)(2r^2+2r+1)\\right]\n$$\nThe second term (potential from charge outside sphere of radius $r$) is:\n$$\n\\int_r^\\infty \\frac{1}{\\pi}\\exp(-2r')\\,\\frac{4\\pi r'^2}{r'}\\,dr' = 4 \\int_r^\\infty r'\\exp(-2r')\\,dr' = 4\\left[-\\frac{\\exp(-2r')}{2}(r'+1/2)\\right]_r^\\infty = \\exp(-2r)(2r+1)\n$$\nCombining these terms, the potential is:\n$$\n\\phi(r) \\;=\\; \\frac{1}{r} - \\frac{\\exp(-2r)(2r^2+2r+1)}{r} + \\exp(-2r)(2r+1) \\;=\\; \\frac{1}{r} - \\exp(-2r)(2r+2+1/r) + \\exp(-2r)(2r+1) \\;=\\; \\frac{1}{r} - \\exp(-2r)(1+1/r)\n$$\nNow we can compute the Hartree energy:\n$$\nE_H[n] \\;=\\; \\frac{1}{2}\\int_0^\\infty n(r)\\phi(r)\\,4\\pi r^2\\,dr \\;=\\; \\frac{1}{2}\\int_0^\\infty \\left(\\frac{1}{\\pi}\\exp(-2r)\\right) \\left(\\frac{1}{r} - \\exp(-2r)(1+1/r)\\right) 4\\pi r^2\\,dr\n$$\n$$\nE_H[n] \\;=\\; 2 \\int_0^\\infty r^2 \\exp(-2r) \\left(\\frac{1}{r} - \\exp(-2r) - \\frac{\\exp(-2r)}{r}\\right)\\,dr \\;=\\; 2 \\int_0^\\infty \\left(r\\exp(-2r) - r^2\\exp(-4r) - r\\exp(-4r)\\right)\\,dr\n$$\nThis expression contains three standard integrals:\n$$\n\\int_0^\\infty r\\exp(-2r)\\,dr = \\frac{1!}{2^2} = \\frac{1}{4}\n$$\n$$\n\\int_0^\\infty r^2\\exp(-4r)\\,dr = \\frac{2!}{4^3} = \\frac{2}{64} = \\frac{1}{32}\n$$\n$$\n\\int_0^\\infty r\\exp(-4r)\\,dr = \\frac{1!}{4^2} = \\frac{1}{16}\n$$\nSubstituting these values:\n$$\nE_H[n] \\;=\\; 2 \\left(\\frac{1}{4} - \\frac{1}{32} - \\frac{1}{16}\\right) \\;=\\; 2 \\left(\\frac{8}{32} - \\frac{1}{32} - \\frac{2}{32}\\right) \\;=\\; 2 \\left(\\frac{5}{32}\\right) \\;=\\; \\frac{5}{16}\n$$\nThe exact exchange for this one-electron system is $E_{x}^{\\mathrm{exact}}[n] = -E_{H}[n] = -5/16$.\n\nFinally, the residual exchange self-interaction error is:\n$$\n\\Delta_{x} \\;=\\; E_{x}^{\\mathrm{LSDA}}[n] + E_{H}[n] \\;=\\; -\\frac{3^{13/3}}{256\\pi^{2/3}} + \\frac{5}{16}\n$$\nThe two requested quantities are $E_{x}^{\\mathrm{LSDA}}[n]$ and $\\Delta_{x}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\dfrac{3^{13/3}}{256\\pi^{2/3}} & \\dfrac{5}{16} - \\dfrac{3^{13/3}}{256\\pi^{2/3}} \\end{pmatrix}}\n$$", "id": "2890214"}, {"introduction": "Moving up to the second rung of Jacob's Ladder, Generalized Gradient Approximations (GGAs) improve upon LDA by incorporating information about the local density gradient, $|\\nabla n(\\mathbf{r})|$. This practice ([@problem_id:2890262]) provides a direct look into this mechanism by having you calculate the change in exchange energy when moving from an LDA to a GGA functional for a model system. This exercise illuminates how the reduced density gradient, $s(\\mathbf{r})$, acts as the key variable that allows GGAs to differentiate between various electronic environments.", "problem": "Consider a spin-unpolarized electron system described within Kohn–Sham Density Functional Theory (DFT). Use atomic units (Hartree for energy and Bohr for length). Let the electron density be spherically symmetric and given by the Gaussian model\n$$\nn(\\mathbf{r}) = n_{0}\\,\\exp\\!\\left(-\\alpha r^{2}\\right),\n$$\nwith parameters $n_{0} > 0$ and $\\alpha > 0$. The exchange energy in the Local Density Approximation (LDA) is\n$$\nE_{x}^{\\mathrm{LDA}} = \\int \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\mathbf{r}))\\,d^{3}\\mathbf{r}, \\quad \\varepsilon_{x}^{\\mathrm{LDA}}(n) = -C_{x}\\,n^{4/3},\n$$\nwhere $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$. At the second rung of Jacob’s ladder, consider a Generalized Gradient Approximation (GGA) exchange functional of the form\n$$\nE_{x}^{\\mathrm{GGA}} = \\int \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\mathbf{r}))\\,F_{x}(s(\\mathbf{r}))\\,d^{3}\\mathbf{r},\n$$\nwith enhancement factor\n$$\nF_{x}(s) = 1 + \\mu\\,s^{2},\n$$\nwhere $\\mu > 0$ is a constant and $s(\\mathbf{r})$ is the reduced density gradient\n$$\ns(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2\\,k_{F}(\\mathbf{r})\\,n(\\mathbf{r})}, \\qquad k_{F}(\\mathbf{r}) = \\left(3\\pi^{2} n(\\mathbf{r})\\right)^{1/3}.\n$$\nDerive, from first principles and the definitions given, a closed-form analytic expression for the exchange energy difference\n$$\n\\Delta E_{x} \\equiv E_{x}^{\\mathrm{GGA}} - E_{x}^{\\mathrm{LDA}}\n$$\nas a function of $n_{0}$, $\\alpha$, and $\\mu$. Express your final answer in Hartree as a single simplified expression (no numerical approximation or rounding).", "solution": "We begin from the definitions of the exchange energy in the Local Density Approximation (LDA) and in a Generalized Gradient Approximation (GGA). For a spin-unpolarized system, the LDA exchange energy density is\n$$\n\\varepsilon_{x}^{\\mathrm{LDA}}(n) = -C_{x}\\,n^{4/3}, \\qquad C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}.\n$$\nAt the second rung of Jacob’s ladder, a GGA exchange functional uses an enhancement factor $F_{x}(s)$ depending on the reduced gradient $s(\\mathbf{r})$:\n$$\nE_{x}^{\\mathrm{GGA}} = \\int \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\mathbf{r}))\\,F_{x}(s(\\mathbf{r}))\\,d^{3}\\mathbf{r}, \\qquad s(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2\\,k_{F}(\\mathbf{r})\\,n(\\mathbf{r})}, \\quad k_{F}(\\mathbf{r}) = \\left(3\\pi^{2}n(\\mathbf{r})\\right)^{1/3}.\n$$\nWith $F_{x}(s) = 1 + \\mu s^{2}$, the exchange energy difference is\n$$\n\\Delta E_{x} = E_{x}^{\\mathrm{GGA}} - E_{x}^{\\mathrm{LDA}} = \\int \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\mathbf{r}))\\left(F_{x}(s(\\mathbf{r})) - 1\\right)\\,d^{3}\\mathbf{r} = \\mu \\int \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\mathbf{r}))\\,s(\\mathbf{r})^{2}\\,d^{3}\\mathbf{r}.\n$$\n\nWe now evaluate $s(\\mathbf{r})$ for the given density $n(\\mathbf{r}) = n_{0}\\exp(-\\alpha r^{2})$. By spherical symmetry,\n$$\n\\nabla n(\\mathbf{r}) = \\frac{d n}{dr}\\,\\hat{\\mathbf{r}} = -2\\alpha r\\,n(\\mathbf{r})\\,\\hat{\\mathbf{r}}, \\qquad |\\nabla n(\\mathbf{r})| = 2\\alpha r\\,n(\\mathbf{r}).\n$$\nTherefore,\n$$\ns(\\mathbf{r}) = \\frac{2\\alpha r\\,n(\\mathbf{r})}{2\\,k_{F}(\\mathbf{r})\\,n(\\mathbf{r})} = \\frac{\\alpha r}{k_{F}(\\mathbf{r})} = \\frac{\\alpha r}{\\left(3\\pi^{2} n(\\mathbf{r})\\right)^{1/3}}.\n$$\nHence,\n$$\ns(\\mathbf{r})^{2} = \\frac{\\alpha^{2} r^{2}}{\\left(3\\pi^{2}\\right)^{2/3}}\\,n(\\mathbf{r})^{-2/3}.\n$$\n\nInsert $\\varepsilon_{x}^{\\mathrm{LDA}}$ and $s^{2}$ into $\\Delta E_{x}$:\n$$\n\\Delta E_{x} = \\mu \\int \\left[-C_{x}\\,n(\\mathbf{r})^{4/3}\\right]\\left[\\frac{\\alpha^{2} r^{2}}{\\left(3\\pi^{2}\\right)^{2/3}}\\,n(\\mathbf{r})^{-2/3}\\right]d^{3}\\mathbf{r} = -\\mu\\,C_{x}\\,\\frac{\\alpha^{2}}{\\left(3\\pi^{2}\\right)^{2/3}} \\int r^{2}\\,n(\\mathbf{r})^{2/3}\\,d^{3}\\mathbf{r}.\n$$\nFor the Gaussian density,\n$$\nn(\\mathbf{r})^{2/3} = n_{0}^{2/3}\\,\\exp\\!\\left(-\\frac{2}{3}\\alpha r^{2}\\right).\n$$\nIn spherical coordinates $d^{3}\\mathbf{r} = 4\\pi r^{2}dr$, so\n$$\n\\int r^{2}\\,n(\\mathbf{r})^{2/3}\\,d^{3}\\mathbf{r} = 4\\pi\\,n_{0}^{2/3}\\int_{0}^{\\infty} r^{4}\\,\\exp\\!\\left(-a r^{2}\\right)\\,dr, \\qquad a \\equiv \\frac{2}{3}\\alpha.\n$$\nThe standard integral for $a > 0$ and integer $m \\ge 0$,\n$$\n\\int_{0}^{\\infty} r^{2m}\\,\\exp(-a r^{2})\\,dr = \\frac{1}{2}\\,a^{-(m+1/2)}\\,\\Gamma\\!\\left(m+\\frac{1}{2}\\right),\n$$\ngives for $m = 2$,\n$$\n\\int_{0}^{\\infty} r^{4}\\,\\exp(-a r^{2})\\,dr = \\frac{1}{2}\\,a^{-5/2}\\,\\Gamma\\!\\left(\\frac{5}{2}\\right) = \\frac{1}{2}\\,a^{-5/2}\\,\\frac{3\\sqrt{\\pi}}{4} = \\frac{3\\sqrt{\\pi}}{8}\\,a^{-5/2}.\n$$\nThus,\n$$\n\\int r^{2}\\,n(\\mathbf{r})^{2/3}\\,d^{3}\\mathbf{r} = 4\\pi\\,n_{0}^{2/3}\\,\\frac{3\\sqrt{\\pi}}{8}\\,a^{-5/2} = \\frac{3\\pi\\sqrt{\\pi}}{2}\\,n_{0}^{2/3}\\,a^{-5/2}.\n$$\nWith $a = \\frac{2}{3}\\alpha$, we have $a^{-5/2} = \\left(\\frac{3}{2}\\right)^{5/2}\\alpha^{-5/2}$. Therefore,\n$$\n\\int r^{2}\\,n(\\mathbf{r})^{2/3}\\,d^{3}\\mathbf{r} = \\frac{3\\pi\\sqrt{\\pi}}{2}\\,n_{0}^{2/3}\\,\\left(\\frac{3}{2}\\right)^{5/2}\\alpha^{-5/2}.\n$$\nInsert this into $\\Delta E_{x}$:\n$$\n\\Delta E_{x} = -\\mu\\,C_{x}\\,\\frac{\\alpha^{2}}{\\left(3\\pi^{2}\\right)^{2/3}} \\cdot \\frac{3\\pi\\sqrt{\\pi}}{2}\\,n_{0}^{2/3}\\,\\left(\\frac{3}{2}\\right)^{5/2}\\alpha^{-5/2}.\n$$\nCombine powers of $\\alpha$:\n$$\n\\alpha^{2}\\,\\alpha^{-5/2} = \\alpha^{-1/2}.\n$$\nNow simplify constants. First use\n$$\nC_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}, \\qquad \\frac{C_{x}}{\\left(3\\pi^{2}\\right)^{2/3}} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\left(3\\pi^{2}\\right)^{-2/3} = \\frac{3^{2/3}}{4}\\,\\pi^{-5/3}.\n$$\nThen\n$$\n\\Delta E_{x} = -\\mu\\,n_{0}^{2/3}\\,\\alpha^{-1/2}\\left[\\frac{3^{2/3}}{4}\\,\\pi^{-5/3}\\right]\\left[\\frac{3\\pi\\sqrt{\\pi}}{2}\\right]\\left[\\left(\\frac{3}{2}\\right)^{5/2}\\right].\n$$\nGroup factors of $\\pi$:\n$$\n\\pi^{-5/3}\\cdot \\pi\\cdot \\sqrt{\\pi} = \\pi^{-5/3+1+1/2} = \\pi^{-1/6}.\n$$\nGroup factors of $3$ and $2$:\n$$\n\\frac{3^{2/3}\\cdot 3 \\cdot 3^{5/2}}{4 \\cdot 2 \\cdot 2^{5/2}} = \\frac{3^{2/3 + 1 + 5/2}}{2^{3 + 5/2}} = \\frac{3^{25/6}}{2^{11/2}}.\n$$\nTherefore,\n$$\n\\Delta E_{x} = -\\mu\\,\\frac{3^{25/6}}{2^{11/2}\\,\\pi^{1/6}}\\,n_{0}^{2/3}\\,\\alpha^{-1/2}.\n$$\nThis is the desired closed-form analytic expression in Hartree for the exchange energy change from LDA to the specified GGA with $F_{x}(s) = 1 + \\mu s^{2}$. The negative sign is consistent with $F_{x}(s) > 1$ for $s \\ne 0$, making the GGA exchange more attractive than the LDA exchange.", "answer": "$$\\boxed{-\\,\\mu\\,\\frac{3^{25/6}}{2^{11/2}\\,\\pi^{1/6}}\\,n_{0}^{2/3}\\,\\alpha^{-1/2}}$$", "id": "2890262"}, {"introduction": "Hybrid functionals, which occupy the fourth rung of Jacob's Ladder, achieve high accuracy by mixing a fraction of exact Hartree-Fock exchange with a semi-local DFT functional, but this involves a crucial compromise. This problem ([@problem_id:2890240]) models the inherent trade-off between correcting for delocalization error and introducing static correlation error. By analyzing simplified error metrics as a function of the mixing parameter $a$, you will gain a deeper appreciation for the design principles and challenges behind modern, high-performance exchange-correlation functionals.", "problem": "Consider the role of exchange-correlation approximations in Kohn–Sham Density Functional Theory (DFT) as organized by Jacob’s ladder, in particular the effect of incorporating a fraction of exact (Hartree–Fock) exchange to form a global hybrid functional (rung four). Work in atomic units, so all energies are in hartree. You will analyze two exact-constraint-based error measures that diagnose, respectively, delocalization error and static correlation error, and you will model how these errors change when a fraction of exact exchange is added.\n\nAs fundamental base, use the following well-tested facts and definitions:\n1) For the exact functional, the ground-state energy as a function of electron number $N$ at fixed external potential is piecewise linear between adjacent integers; for an approximate functional, deviation from piecewise linearity in the open interval between integers can be quantified by the curvature $\\,\\kappa \\equiv \\dfrac{d^{2}E}{dN^{2}}\\,$, which vanishes for the exact functional.\n2) For the exact functional at the dissociation limit of the hydrogen molecule $\\mathrm{H}_{2}$, the energy of the spin-restricted ensemble as a function of fractional spin polarization $y$ at fixed electron number $N=1$ is constant; for an approximate functional, deviation from constancy can be quantified by the quadratic coefficient $\\,\\mu\\,$ in the expansion $\\,E(y) = E(0) + \\dfrac{1}{2}\\mu\\,y^{2} + O(y^{4})\\,$, which vanishes for the exact functional.\n3) A global hybrid functional mixes exchange-correlation contributions linearly: for a mixing fraction $a \\in [0,1]$, its exchange-correlation energy is $\\,E_{\\text{xc}}^{(a)} = a\\,E_{x}^{\\text{HF}} + (1-a)\\,E_{\\text{xc}}^{\\text{DFA}}\\,$, where Hartree–Fock (HF) denotes exact exchange and Density Functional Approximation (DFA) denotes a semilocal rung-two or rung-three functional. Assume the correlation part of the DFA does not depend on $a$.\n\nUse the following scientifically plausible, fixed reference values for the two diagnostic coefficients associated with the two limiting components (they are treated as constants characterizing the response of each component in the specified regimes):\n- For delocalization error in the one-electron sector (e.g., the $\\mathrm{H}_{2}^{+}$ problem near a fixed geometry), the curvature constants are $\\,\\kappa_{\\text{DFA}} = +0.30\\,$ and $\\,\\kappa_{\\text{HF}} = -0.20\\,$ (in hartree).\n- For static correlation error in stretched $\\mathrm{H}_{2}$ at a large internuclear separation (e.g., $R = 10.0$ bohr), the fractional-spin quadratic coefficients are $\\,\\mu_{\\text{DFA}} = 0.10\\,$ and $\\,\\mu_{\\text{HF}} = 0.50\\,$ (in hartree).\n\nTask A (derivation): Starting only from items (1)–(3) above, derive how the hybrid mixing with fraction $a$ propagates to the two diagnostic coefficients. In particular, express the hybrid curvature $\\,\\kappa(a)\\,$ and the hybrid fractional-spin coefficient $\\,\\mu(a)\\,$ in terms of $a$, $\\,\\kappa_{\\text{DFA}}\\,$, $\\,\\kappa_{\\text{HF}}\\,$, $\\,\\mu_{\\text{DFA}}\\,$, and $\\,\\mu_{\\text{HF}}\\,$. Then, define the magnitudes to be reported as $\\,|\\kappa(a)|\\,$ (delocalization error magnitude) and $\\,\\mu(a)\\,$ (static correlation error magnitude).\n\nTask B (computation): For a set of test cases, compute $\\,|\\kappa(a)|\\,$, $\\,\\mu(a)\\,$, and a trade-off score\n$$\nS(a) = w_{d}\\,|\\kappa(a)| + w_{s}\\,\\mu(a),\n$$\nwhere $\\,w_{d}\\,$ and $\\,w_{s}\\,$ are nonnegative weights. All reported quantities must be in hartree. Your program must implement the derived formulas from Task A and evaluate the following test suite, which probes boundary cases and interior points:\n- Test $1$: $\\,a=0.0\\,$, $\\,w_{d}=1.0\\,$, $\\,w_{s}=1.0\\,$.\n- Test $2$: $\\,a=1.0\\,$, $\\,w_{d}=1.0\\,$, $\\,w_{s}=1.0\\,$.\n- Test $3$: $\\,a=0.25\\,$, $\\,w_{d}=2.0\\,$, $\\,w_{s}=1.0\\,$.\n- Test $4$: $\\,a=0.75\\,$, $\\,w_{d}=1.0\\,$, $\\,w_{s}=2.0\\,$.\n- Test $5$: $\\,a=0.50\\,$, $\\,w_{d}=1.0\\,$, $\\,w_{s}=1.5\\,$.\n\nYour program should produce a single line of output containing the results for all tests as a comma-separated list enclosed in square brackets. Each test’s result must be a three-element list in the order $[\\,|\\kappa(a)|,\\,\\mu(a),\\,S(a)\\,]$, with each float rounded to six decimal places, and all energies in hartree. For example, the overall structure must be\n$\\,\\big[\\,[x_{1},y_{1},z_{1}],\\,[x_{2},y_{2},z_{2}],\\,\\dots\\,\\big]\\,$,\nprinted on one line with no spaces.", "solution": "**Task A: Derivation**\n\nThe task requires the derivation of the functional dependence of the diagnostic coefficients $\\kappa(a)$ and $\\mu(a)$ on the mixing fraction $a$.\n\nThe total electronic energy for a system described by a hybrid functional with mixing parameter $a$ is, within the generalized Kohn-Sham (GKS) framework, a functional of the set of GKS orbitals, or equivalently, the density matrix. Using the specified definition of the exchange-correlation energy, the total energy functional is:\n$$E^{(a)} = T_s + V_{ne} + J + E_{\\text{xc}}^{(a)} = T_s + V_{ne} + J + a\\,E_{x}^{\\text{HF}} + (1-a)\\,E_{\\text{xc}}^{\\text{DFA}}$$\nwhere all terms are functionals of the self-consistent density $\\rho^{(a)}$ (or the orbitals that produce it). A direct analysis of the second derivatives of $E^{(a)}$ is complicated by the implicit dependence of $\\rho^{(a)}$ on the parameter $a$.\n\nA standard and physically sound simplification is to invoke a principle analogous to first-order perturbation theory. The total energy is stationary with respect to first-order variations of the density around the self-consistent solution. Thus, to a good approximation, we can analyze the change in energy by evaluating the perturbed functional using a fixed reference density, for instance, the density from the pure DFA calculation, $\\rho^{\\text{DFA}}$. This leads to the approximation:\n$$E^{(a)}[\\rho^{\\text{DFA}}] \\approx E^{\\text{DFA}}[\\rho^{\\text{DFA}}] + a \\left( E_x^{\\text{HF}}[\\rho^{\\text{DFA}}] - E_{\\text{xc}}^{\\text{DFA}}[\\rho^{\\text{DFA}}] \\right)$$\nThis formulation reveals that the energy $E^{(a)}$ can be treated as a linear function of the mixing parameter $a$. Consequently, any derivative of the energy with respect to a parameter other than $a$ will also exhibit this linear dependence.\n\nFor the curvature $\\kappa(a) = \\frac{d^2E^{(a)}}{dN^2}$, taking the second derivative of the approximate energy expression with respect to the electron number $N$ while keeping the external potential fixed yields a linear function of $a$. We can determine this function by its values at the endpoints $a=0$ and $a=1$.\nAt $a=0$, the functional is pure DFA, so we must have $\\kappa(0) = \\kappa_{\\text{DFA}}$.\nAt $a=1$, the model should recover the property of the HF limit, so we must have $\\kappa(1) = \\kappa_{\\text{HF}}$.\nA linear function connecting these two points is a simple linear interpolation:\n$$\\kappa(a) = (1-a)\\kappa(0) + a\\kappa(1)$$\nSubstituting the known endpoint values, we arrive at the final expression for the hybrid curvature:\n$$\\kappa(a) = (1-a)\\kappa_{\\text{DFA}} + a\\kappa_{\\text{HF}}$$\n\nThe same reasoning is applied to the static correlation error metric $\\mu(a)$. This coefficient is obtained from the second derivative of the energy with respect to the fractional spin polarization $y$, evaluated at $y=0$: $\\mu(a) = \\frac{d^2 E^{(a)}}{dy^2} \\big|_{y=0}$. Following the same logic, this property must also interpolate linearly between the pure DFA and pure HF values.\n$$\\mu(a) = (1-a)\\mu(0) + a\\mu(1)$$\nSubstituting the known reference values, $\\mu(0) = \\mu_{\\text{DFA}}$ and $\\mu(1) = \\mu_{\\text{HF}}$ yields:\n$$\\mu(a) = (1-a)\\mu_{\\text{DFA}} + a\\mu_{\\text{HF}}$$\n\n**Task B: Computation**\n\nThe derived formulae are implemented for the computational task. The reported magnitudes are $|\\kappa(a)|$ for delocalization error and $\\mu(a)$ for static correlation error (since $\\mu(a)$ is non-negative for $a \\in [0,1]$). The trade-off score is $S(a) = w_{d}\\,|\\kappa(a)| + w_{s}\\,\\mu(a)$. The Python program in the final answer section performs these calculations for the specified test suite.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DFT hybrid functional error analysis problem.\n    \"\"\"\n    \n    # Define reference values from the problem statement (in Hartree).\n    kappa_dfa = 0.30\n    kappa_hf = -0.20\n    mu_dfa = 0.10\n    mu_hf = 0.50\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, w_d, w_s)\n    test_cases = [\n        (0.0, 1.0, 1.0),   # Test 1\n        (1.0, 1.0, 1.0),   # Test 2\n        (0.25, 2.0, 1.0),  # Test 3\n        (0.75, 1.0, 2.0),  # Test 4\n        (0.50, 1.0, 1.5),  # Test 5\n    ]\n\n    results_for_printing = []\n\n    for case in test_cases:\n        a, w_d, w_s = case\n\n        # Task A: Implement the derived formulas for kappa(a) and mu(a).\n        # kappa(a) = (1-a)*kappa_DFA + a*kappa_HF\n        kappa_a = (1.0 - a) * kappa_dfa + a * kappa_hf\n        \n        # mu(a) = (1-a)*mu_DFA + a*mu_HF\n        mu_a = (1.0 - a) * mu_dfa + a * mu_hf\n\n        # The problem specifies reporting |kappa(a)| for the delocalization error magnitude.\n        abs_kappa_a = np.abs(kappa_a)\n\n        # Task B: Compute the trade-off score S(a).\n        # S(a) = w_d * |kappa(a)| + w_s * mu(a)\n        score_a = w_d * abs_kappa_a + w_s * mu_a\n\n        # Format the result for the current test case as a string \"[x,y,z]\"\n        # with numbers rounded to six decimal places.\n        case_result_str = (\n            f\"[{abs_kappa_a:.6f},{mu_a:.6f},{score_a:.6f}]\"\n        )\n        results_for_printing.append(case_result_str)\n\n    # Final print statement in the exact required format: [[x1,y1,z1],[x2,y2,z2],...]\n    # without any spaces.\n    print(f\"[{','.join(results_for_printing)}]\")\n\nsolve()\n```", "id": "2890240"}]}