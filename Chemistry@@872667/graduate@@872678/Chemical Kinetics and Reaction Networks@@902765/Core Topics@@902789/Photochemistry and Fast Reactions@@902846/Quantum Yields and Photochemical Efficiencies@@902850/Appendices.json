{"hands_on_practices": [{"introduction": "Understanding the efficiency of a photochemical process is paramount. The cornerstone of this quantitative analysis is the quantum yield, $\\Phi$, which provides a direct measure of events-out per photons-in. This first exercise grounds the abstract concept of quantum yield in concrete, measurable laboratory quantities, starting from first principles like the Planck-Einstein relation to connect a light source's radiant power to the rate of photon absorption and ultimately calculate an overall reaction efficiency. [@problem_id:2666383]", "problem": "A photochemical reactor is illuminated by monochromatic light of vacuum wavelength $\\lambda$. The light source delivers a steady radiant power $P$ into the reaction volume. Let the photon flux be $F$, defined as the number of photons transmitted into the volume per unit time. The energy of a single photon of this light is $E$. An Einstein is defined as $1$ mole of photons. A fraction $a$ of the incident photons is absorbed by the reacting solution; the remainder is transmitted or reflected. The observed molar rate of formation of a photo-product is $r_{\\mathrm{prod}}$.\n\nStarting from fundamental definitions only, namely (i) radiant power as energy per unit time, (ii) the energy of a photon of wavelength $\\lambda$, and (iii) the definition of the Einstein as a mole of photons, derive an expression that relates $F$, $P$, and $E$ for monochromatic light. Then, using your derived relationship together with the Einstein definition, determine the quantum yield $\\phi$ (dimensionless) of product formation defined as the ratio of the rate of product formation to the rate of photon absorption expressed in moles per unit time.\n\nUse the following data:\n- $\\lambda = 400\\,\\mathrm{nm}$,\n- $P = 5.00 \\times 10^{-3}\\,\\mathrm{J}\\,\\mathrm{s}^{-1}$,\n- $a = 0.600$,\n- $r_{\\mathrm{prod}} = 3.00 \\times 10^{-9}\\,\\mathrm{mol}\\,\\mathrm{s}^{-1}$,\n- Planck constant $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J}\\,\\mathrm{s}$,\n- Speed of light in vacuum $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$,\n- Avogadro constant $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$.\n\nExpress your final answer for $\\phi$ as a decimal number, with no units, and round to three significant figures.", "solution": "The problem as stated is subjected to validation.\n\n**Step 1: Extract Givens**\n- Vacuum wavelength of light: $\\lambda = 400\\,\\mathrm{nm}$\n- Steady radiant power: $P = 5.00 \\times 10^{-3}\\,\\mathrm{J}\\,\\mathrm{s}^{-1}$\n- Fraction of incident photons absorbed: $a = 0.600$\n- Observed molar rate of product formation: $r_{\\mathrm{prod}} = 3.00 \\times 10^{-9}\\,\\mathrm{mol}\\,\\mathrm{s}^{-1}$\n- Planck constant: $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J}\\,\\mathrm{s}$\n- Speed of light in vacuum: $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- Avogadro constant: $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$\n- Definitions:\n  - Photon flux, $F$, is the number of photons transmitted into the volume per unit time.\n  - Radiant power, $P$, is energy per unit time.\n  - The energy of a single photon of wavelength $\\lambda$ is $E$.\n  - An Einstein is $1$ mole of photons.\n  - Quantum yield, $\\phi$, is the ratio of the rate of product formation to the rate of photon absorption, with both rates expressed in moles per unit time.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is based on the fundamental principles of photochemistry, specifically the Planck-Einstein relation for photon energy and the definition of quantum yield. All concepts are standard in physical chemistry and chemical kinetics.\n- **Well-Posed**: The problem provides all necessary definitions, data, and physical constants to perform the required derivations and calculations. The goal is clearly stated, and a unique solution can be determined.\n- **Objective**: The language is precise, quantitative, and free from subjective or ambiguous statements.\n- **Flaw Analysis**:\n  1. **Scientific Unsoundness**: No violations of physical laws or mathematical logic.\n  2. **Non-Formalizable/Irrelevant**: The problem is a standard, formalizable exercise in the specified topic of *quantum yields and photochemical efficiencies*.\n  3. **Incomplete/Contradictory**: The setup is complete and self-consistent.\n  4. **Unrealistic/Infeasible**: The numerical values for power, wavelength, absorption, and reaction rate are physically plausible for a laboratory photochemical experiment.\n  5. **Ill-Posed**: The problem is well-structured and leads to a unique, stable solution.\n  6. **Pseudo-Profound/Trivial**: The problem is a standard textbook exercise, neither trivial nor artificially complicated. It requires a correct application of fundamental definitions.\n  7. **Outside Scientific Verifiability**: The calculations are entirely verifiable.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A rigorous solution will be provided.\n\n**Derivation and Solution**\n\nThe first task is to derive a relationship between the radiant power $P$, the photon flux $F$, and the energy of a single photon $E$.\n\nBy definition, radiant power $P$ is the total energy transmitted per unit time. If $N$ photons, each with energy $E$, are transmitted over a time interval $\\Delta t$, the total energy is $N \\times E$. Therefore, power is given by:\n$$ P = \\frac{N \\times E}{\\Delta t} $$\nThe photon flux $F$ is defined as the number of photons transmitted per unit time, so $F = \\frac{N}{\\Delta t}$. Substituting this into the expression for power yields the direct relationship:\n$$ P = F \\times E $$\nThis is the required relationship between $P$, $F$, and $E$.\n\nThe second task is to determine the quantum yield $\\phi$. The quantum yield is defined as the ratio of the rate of product formation in moles per unit time to the rate of photon absorption in moles per unit time.\n$$ \\phi = \\frac{\\text{rate of product formation (mol/time)}}{\\text{rate of photon absorption (mol/time)}} $$\nThe rate of product formation is given as $r_{\\mathrm{prod}}$. Let the rate of photon absorption be denoted $r_{\\mathrm{abs}}$. Thus,\n$$ \\phi = \\frac{r_{\\mathrm{prod}}}{r_{\\mathrm{abs}}} $$\nWe must now find an expression for $r_{\\mathrm{abs}}$. The incident photon flux, $F$, is given in units of photons per unit time. From our first derivation, $F = \\frac{P}{E}$. The energy of a single photon, $E$, is given by the Planck-Einstein relation:\n$$ E = h\\nu = \\frac{hc}{\\lambda} $$\nwhere $\\nu$ is the frequency of the light. Substituting this into the expression for flux gives the incident photon flux in terms of the given quantities:\n$$ F = \\frac{P}{\\frac{hc}{\\lambda}} = \\frac{P\\lambda}{hc} $$\nThis rate is in units of photons per second. The problem states that a fraction $a$ of these photons is absorbed. Therefore, the rate of photon absorption in photons per second is $aF$.\n$$ \\text{Rate of absorbed photons} = aF = \\frac{aP\\lambda}{hc} \\quad (\\text{units: photons/time}) $$\nThe definition of quantum yield requires the rate of absorption to be expressed in moles per unit time. To convert from a number of particles (photons) to a number of moles, we must divide by the Avogadro constant, $N_{\\mathrm{A}}$.\n$$ r_{\\mathrm{abs}} = \\frac{aF}{N_{\\mathrm{A}}} = \\frac{aP\\lambda}{hcN_{\\mathrm{A}}} \\quad (\\text{units: mol/time}) $$\nNow we can write the complete expression for the quantum yield $\\phi$:\n$$ \\phi = \\frac{r_{\\mathrm{prod}}}{r_{\\mathrm{abs}}} = \\frac{r_{\\mathrm{prod}}}{\\left(\\frac{aP\\lambda}{hcN_{\\mathrm{A}}}\\right)} = \\frac{r_{\\mathrm{prod}}hcN_{\\mathrm{A}}}{aP\\lambda} $$\nThis is the final symbolic expression for the quantum yield. We will now substitute the given numerical values. It is critical to ensure all units are consistent within the SI system. The wavelength $\\lambda$ must be converted from nanometers to meters:\n$$ \\lambda = 400\\,\\mathrm{nm} = 400 \\times 10^{-9}\\,\\mathrm{m} = 4.00 \\times 10^{-7}\\,\\mathrm{m} $$\nSubstituting all values into the expression for $\\phi$:\n$$ \\phi = \\frac{(3.00 \\times 10^{-9}\\,\\mathrm{mol}\\,\\mathrm{s}^{-1}) \\times (6.62607015 \\times 10^{-34}\\,\\mathrm{J}\\,\\mathrm{s}) \\times (2.99792458 \\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1})}{(0.600) \\times (5.00 \\times 10^{-3}\\,\\mathrm{J}\\,\\mathrm{s}^{-1}) \\times (4.00 \\times 10^{-7}\\,\\mathrm{m})} $$\nThe units cancel out as expected, leaving a dimensionless quantity:\n$$ \\frac{(\\mathrm{mol}\\,\\mathrm{s}^{-1}) \\cdot (\\mathrm{J}\\,\\mathrm{s}) \\cdot (\\mathrm{m}\\,\\mathrm{s}^{-1}) \\cdot (\\mathrm{mol}^{-1})}{(\\mathrm{J}\\,\\mathrm{s}^{-1}) \\cdot (\\mathrm{m})} = \\frac{\\mathrm{J} \\cdot \\mathrm{m} \\cdot \\mathrm{s}^{-1}}{\\mathrm{J} \\cdot \\mathrm{m} \\cdot \\mathrm{s}^{-1}} = 1 $$\nPerforming the numerical calculation:\n$$ \\phi = \\frac{3.00 \\times 6.62607015 \\times 2.99792458 \\times 6.02214076 \\times 10^{-9 - 34 + 8 + 23}}{0.600 \\times 5.00 \\times 4.00 \\times 10^{-3 - 7}} $$\n$$ \\phi = \\frac{359.011... \\times 10^{-12}}{12.0 \\times 10^{-10}} = \\frac{3.59011... \\times 10^{-10}}{1.20 \\times 10^{-9}} $$\n$$ \\phi = 0.299176... $$\nThe problem requires the answer to be rounded to three significant figures, which is consistent with the precision of the input data ($P$, $a$, $r_{\\mathrm{prod}}$).\n$$ \\phi \\approx 0.299 $$\nThis is the final calculated quantum yield for the formation of the product under the specified conditions.", "answer": "$$\\boxed{0.299}$$", "id": "2666383"}, {"introduction": "While measuring an overall quantum yield is a crucial first step, a deeper understanding requires dissecting the underlying kinetic network that dictates its value. The final efficiency of product formation is nearly always the result of competition between the desired reactive pathway and various non-productive decay channels. This practice challenges you to model a sequential photochemical reaction and, by solving the system's kinetic differential equations, derive an exact analytical expression for the product quantum yield, $\\Phi_P$, in terms of the elementary rate constants. [@problem_id:2666331]", "problem": "A photochemical system is excited by an impulsive light pulse at time $t=0$ such that exactly one excited singlet state $S_1$ is created per photon absorbed. The excited state $S_1$ undergoes a sequential first-order reaction to an intermediate $I$, which in turn undergoes a first-order reaction to form the final product $P$. Both $S_1$ and $I$ also have first-order nonproductive loss channels that do not form $P$. All processes are unimolecular and time-independent, and there are no back reactions. The elementary steps are:\n$S_1 \\xrightarrow{k_a} I$, $I \\xrightarrow{k_b} P$, $S_1 \\xrightarrow{k_s} \\text{loss}$, and $I \\xrightarrow{k_i} \\text{loss}$.\nLet $[S_1](t)$ and $[I](t)$ denote the time-dependent populations with initial conditions $[S_1](0)=1$ and $[I](0)=0$. The quantum yield of product formation $\\Phi_P$ is defined as the number of molecules of $P$ formed per photon absorbed, which equals the time integral of the flux into $P$ normalized by the single absorbed photon.\nDerive, from first principles of chemical kinetics and the definition of quantum yield, an exact closed-form expression for $\\Phi_P$ in terms of $k_a$, $k_b$, $k_s$, and $k_i$. Express your final answer as a single simplified analytic expression in terms of $k_a$, $k_b$, $k_s$, and $k_i$. Do not approximate and do not include units. If you find an intermediate result that depends on a difference of rate constants in a denominator, take any necessary limit to obtain a formula valid for all positive values of the rate constants. The final answer must be a single expression; no rounding is needed.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It describes a standard problem in photochemical kinetics that can be formalized and solved using established mathematical methods. The givens are self-contained and consistent. We proceed with the derivation.\n\nThe photochemical reaction network is described by the following elementary steps:\n$S_1 \\xrightarrow{k_a} I$\n$I \\xrightarrow{k_b} P$\n$S_1 \\xrightarrow{k_s} \\text{loss}$\n$I \\xrightarrow{k_i} \\text{loss}$\n\nFrom these steps, we construct the system of linear first-order ordinary differential equations governing the time evolution of the populations of the excited state $[S_1](t)$ and the intermediate $[I](t)$. The rate of change for each species is the sum of the rates of processes that form it minus the sum of the rates of processes that consume it.\n\nThe rate equation for $[S_1]$ is:\n$$\n\\frac{d[S_1]}{dt} = -k_a [S_1] - k_s [S_1] = -(k_a + k_s) [S_1]\n$$\nLet us define the total decay rate constant for $S_1$ as $\\lambda_S = k_a + k_s$. The equation becomes:\n$$\n\\frac{d[S_1]}{dt} = -\\lambda_S [S_1]\n$$\nThis is a standard first-order decay equation. With the initial condition $[S_1](0) = 1$, the solution is:\n$$\n[S_1](t) = [S_1](0) \\exp(-\\lambda_S t) = \\exp(-\\lambda_S t)\n$$\n\nThe rate equation for the intermediate $[I]$ is:\n$$\n\\frac{d[I]}{dt} = k_a [S_1] - k_b [I] - k_i [I] = k_a [S_1] - (k_b + k_i) [I]\n$$\nLet us define the total decay rate constant for $I$ as $\\lambda_I = k_b + k_i$. Substituting the solution for $[S_1](t)$ into the equation for $[I]$ gives:\n$$\n\\frac{d[I]}{dt} = k_a \\exp(-\\lambda_S t) - \\lambda_I [I]\n$$\nThis can be rearranged into the standard form of a linear first-order ordinary differential equation:\n$$\n\\frac{d[I]}{dt} + \\lambda_I [I] = k_a \\exp(-\\lambda_S t)\n$$\nWe solve this equation using an integrating factor, $\\mu(t)$, which is given by $\\mu(t) = \\exp(\\int \\lambda_I dt) = \\exp(\\lambda_I t)$. Multiplying the differential equation by $\\mu(t)$ gives:\n$$\n\\exp(\\lambda_I t) \\frac{d[I]}{dt} + \\lambda_I \\exp(\\lambda_I t) [I] = k_a \\exp(\\lambda_I t) \\exp(-\\lambda_S t)\n$$\nThe left side is the derivative of the product $[I](t)\\mu(t)$:\n$$\n\\frac{d}{dt} \\left( [I](t) \\exp(\\lambda_I t) \\right) = k_a \\exp((\\lambda_I - \\lambda_S)t)\n$$\nWe integrate both sides with respect to time from $0$ to $t$:\n$$\n[I](t) \\exp(\\lambda_I t) - [I](0) \\exp(0) = \\int_0^t k_a \\exp((\\lambda_I - \\lambda_S)\\tau) d\\tau\n$$\nGiven the initial condition $[I](0) = 0$, we have:\n$$\n[I](t) \\exp(\\lambda_I t) = k_a \\int_0^t \\exp((\\lambda_I - \\lambda_S)\\tau) d\\tau\n$$\nThe evaluation of the integral depends on whether $\\lambda_I = \\lambda_S$.\n\nCase 1: $\\lambda_I \\neq \\lambda_S$.\n$$\n\\int_0^t \\exp((\\lambda_I - \\lambda_S)\\tau) d\\tau = \\left[ \\frac{\\exp((\\lambda_I - \\lambda_S)\\tau)}{\\lambda_I - \\lambda_S} \\right]_0^t = \\frac{\\exp((\\lambda_I - \\lambda_S)t) - 1}{\\lambda_I - \\lambda_S}\n$$\nSubstituting this back gives:\n$$\n[I](t) \\exp(\\lambda_I t) = k_a \\frac{\\exp((\\lambda_I - \\lambda_S)t) - 1}{\\lambda_I - \\lambda_S}\n$$\nSolving for $[I](t)$ by multiplying by $\\exp(-\\lambda_I t)$:\n$$\n[I](t) = \\frac{k_a}{\\lambda_I - \\lambda_S} \\left( \\exp(-\\lambda_S t) - \\exp(-\\lambda_I t) \\right)\n$$\n\nThe quantum yield of product formation, $\\Phi_P$, is defined as the total number of molecules of $P$ formed, normalized by the number of photons absorbed. Since we start with $[S_1](0) = 1$ molecule per absorbed photon, $\\Phi_P$ is the total amount of $P$ formed as $t \\to \\infty$. This is the time integral of the rate of formation of $P$.\nThe rate of formation of $P$ is $\\frac{d[P]}{dt} = k_b [I](t)$.\n$$\n\\Phi_P = [P](\\infty) = \\int_0^\\infty \\frac{d[P]}{dt} dt = \\int_0^\\infty k_b [I](t) dt\n$$\nSubstituting the expression for $[I](t)$:\n$$\n\\Phi_P = k_b \\int_0^\\infty \\frac{k_a}{\\lambda_I - \\lambda_S} \\left( \\exp(-\\lambda_S t) - \\exp(-\\lambda_I t) \\right) dt\n$$\n$$\n\\Phi_P = \\frac{k_a k_b}{\\lambda_I - \\lambda_S} \\left[ \\int_0^\\infty \\exp(-\\lambda_S t) dt - \\int_0^\\infty \\exp(-\\lambda_I t) dt \\right]\n$$\nThe definite integrals are standard: $\\int_0^\\infty \\exp(-kt) dt = \\frac{1}{k}$ for $k > 0$. Since all rate constants are positive, $\\lambda_S > 0$ and $\\lambda_I > 0$.\n$$\n\\Phi_P = \\frac{k_a k_b}{\\lambda_I - \\lambda_S} \\left( \\frac{1}{\\lambda_S} - \\frac{1}{\\lambda_I} \\right)\n$$\nSimplifying the expression in the parenthesis:\n$$\n\\Phi_P = \\frac{k_a k_b}{\\lambda_I - \\lambda_S} \\left( \\frac{\\lambda_I - \\lambda_S}{\\lambda_S \\lambda_I} \\right)\n$$\nThe term $(\\lambda_I - \\lambda_S)$ cancels, yielding a result that is well-defined even if $\\lambda_I = \\lambda_S$:\n$$\n\\Phi_P = \\frac{k_a k_b}{\\lambda_S \\lambda_I}\n$$\n\nCase 2: $\\lambda_I = \\lambda_S$.\nThe problem states to provide a formula valid for all positive rate constants. Although our previous result appears general, we confirm by re-deriving for the specific case $\\lambda_I = \\lambda_S$. The integral for $[I](t)$ becomes:\n$$\n[I](t) \\exp(\\lambda_S t) = k_a \\int_0^t \\exp(0) d\\tau = k_a \\int_0^t d\\tau = k_a t\n$$\nThus, $[I](t) = k_a t \\exp(-\\lambda_S t)$.\nThe quantum yield is then:\n$$\n\\Phi_P = \\int_0^\\infty k_b [I](t) dt = \\int_0^\\infty k_b k_a t \\exp(-\\lambda_S t) dt = k_a k_b \\int_0^\\infty t \\exp(-\\lambda_S t) dt\n$$\nThis is a standard integral, related to the Gamma function, which evaluates to $\\frac{1}{\\lambda_S^2}$.\n$$\n\\Phi_P = k_a k_b \\left( \\frac{1}{\\lambda_S^2} \\right) = \\frac{k_a k_b}{\\lambda_S^2}\n$$\nSince for this case $\\lambda_I = \\lambda_S$, we can write this as $\\Phi_P = \\frac{k_a k_b}{\\lambda_S \\lambda_I}$. This confirms that the expression is general and holds for all positive values of the rate constants.\n\nFinally, we substitute the definitions of $\\lambda_S$ and $\\lambda_I$ back into the general expression:\n$\\lambda_S = k_a + k_s$\n$\\lambda_I = k_b + k_i$\n$$\n\\Phi_P = \\frac{k_a k_b}{(k_a + k_s)(k_b + k_i)}\n$$\nThis expression can be interpreted physically. The term $\\frac{k_a}{k_a + k_s}$ is the quantum yield of the formation of intermediate $I$ from $S_1$. The term $\\frac{k_b}{k_b + k_i}$ represents the efficiency with which the intermediate $I$ is converted to the product $P$. The overall quantum yield for a sequential reaction is the product of the efficiencies of each step, which is precisely what the derived formula shows. This provides a satisfactory check on the result.", "answer": "$$\\boxed{\\frac{k_a k_b}{(k_a + k_s)(k_b + k_i)}}$$", "id": "2666331"}, {"introduction": "In many real-world systems, photochemical efficiency is not constant but varies with the energy of the incident photons, giving rise to a wavelength-dependent quantum yield, $\\Phi(\\lambda)$. Determining this function from experimental measurements, which are often integrated over a spectral range, constitutes a challenging inverse problem. This final, advanced practice introduces a powerful computational technique used in modern research to tackle this issue, tasking you to implement a regularized inversion method to reconstruct the full $\\Phi(\\lambda)$ spectrum from a set of simulated photostationary rate measurements. [@problem_id:2666410]", "problem": "You are tasked with designing and implementing a computational method to extract a wavelength-dependent quantum yield function, denoted by $\\Phi(\\lambda)$, from photostationary measurements. The goal is to formulate and solve an inverse problem using regularization and non-negativity, consistent with photochemical kinetics. Use the following fundamental base: (i) the Einstein law of photochemical equivalence, which states that each absorbed photon can at most initiate one primary photochemical event, and (ii) linear superposition of independent absorption events across wavelengths. Assume a thin, optically dilute sample so that re-absorption and inner-filter effects are negligible and the spectral absorptance $a(\\lambda)$ is known. For a given illumination spectral photon flux density $F_j(\\lambda)$, the photoproduct formation rate per unit area under photostationary conditions is modeled by\n$$\nR_j \\;=\\; \\int_{\\lambda_{\\min}}^{\\lambda_{\\max}} F_j(\\lambda)\\,a(\\lambda)\\,\\Phi(\\lambda)\\,d\\lambda.\n$$\nDiscretize the wavelength interval into a uniform grid $\\{\\lambda_k\\}_{k=1}^{L}$ with spacing $\\Delta\\lambda$, and form the linear system\n$$\n\\mathbf{y} \\;=\\; \\mathbf{K}\\,\\boldsymbol{\\Phi} \\;+\\; \\boldsymbol{\\varepsilon},\\quad \\text{with}\\quad K_{j,k} \\;=\\; F_j(\\lambda_k)\\,a(\\lambda_k)\\,\\Delta\\lambda,\\quad y_j \\approx R_j,\n$$\nwhere $\\boldsymbol{\\varepsilon}$ models additive measurement noise, and $\\boldsymbol{\\Phi}\\in\\mathbb{R}^L$ is the discretized quantum yield. You must recover $\\boldsymbol{\\Phi}$ by solving a regularized inverse problem with a first-order finite-difference smoothness operator $\\mathbf{L}\\in\\mathbb{R}^{(L-1)\\times L}$ defined by $(\\mathbf{L}\\boldsymbol{\\Phi})_k = \\Phi_{k+1}-\\Phi_k$. Enforce the physical constraint $\\Phi(\\lambda)\\ge 0$ via non-negativity bounds in the optimization. Implement the estimate as the minimizer of the Tikhonov-regularized objective\n$$\n\\min_{\\boldsymbol{\\Phi}\\ge \\mathbf{0}} \\ \\left\\lVert \\mathbf{K}\\,\\boldsymbol{\\Phi}-\\mathbf{y}\\right\\rVert_2^2\\;+\\;\\alpha\\,\\left\\lVert \\mathbf{L}\\,\\boldsymbol{\\Phi}\\right\\rVert_2^2,\n$$\nwith the regularization strength $\\alpha0$ specified per test case below.\n\nConstruct synthetic yet physically plausible test data by defining a common wavelength grid and known spectral factors as follows. Use $\\lambda_{\\min}=\\,$$300$ nm, $\\lambda_{\\max}=\\,$$380$ nm, $\\Delta\\lambda=\\,$$1$ nm, so $L=\\,$$81$. Define the spectral absorptance $a(\\lambda)$ as the sum of two Gaussian bands\n$$\na(\\lambda)\\;=\\;0.6\\exp\\!\\left(-\\frac{(\\lambda-330)^2}{2\\cdot 8^2}\\right)\\;+\\;0.3\\exp\\!\\left(-\\frac{(\\lambda-360)^2}{2\\cdot 5^2}\\right),\n$$\nand define the ground-truth quantum yield $\\Phi_{\\text{true}}(\\lambda)$ by\n$$\n\\Phi_{\\text{true}}(\\lambda)\\;=\\;\\mathrm{clip}\\!\\left[\\,0.15\\;+\\;\\frac{0.6}{1+\\exp\\!\\left(-\\frac{\\lambda-345}{6}\\right)}\\;+\\;0.05\\,\\sin\\!\\left(\\frac{2\\pi(\\lambda-300)}{30}\\right)\\,,\\,0\\,,\\,1\\,\\right],\n$$\nwhere $\\mathrm{clip}[x,0,1]=\\min(\\max(x,0),1)$ acts elementwise. For each illumination $j$, use a normalized Gaussian spectral photon flux\n$$\nF_j(\\lambda)\\;=\\;\\frac{\\exp\\!\\left(-\\tfrac{1}{2}\\big(\\tfrac{\\lambda-c_j}{w_j}\\big)^2\\right)}{\\sum_{k=1}^{L}\\exp\\!\\left(-\\tfrac{1}{2}\\big(\\tfrac{\\lambda_k-c_j}{w_j}\\big)^2\\right)\\,\\Delta\\lambda},\n$$\nso that $\\sum_k F_j(\\lambda_k)\\Delta\\lambda=\\,$$1$. Generate noiseless rates $y_j^{\\star}=\\sum_k F_j(\\lambda_k)\\,a(\\lambda_k)\\,\\Phi_{\\text{true}}(\\lambda_k)\\,\\Delta\\lambda$, then add independent Gaussian noise $\\varepsilon_j\\sim \\mathcal{N}(0,\\sigma^2)$ with $\\sigma=\\eta\\cdot\\mathrm{median}(|\\mathbf{y}^{\\star}|)$ for a specified noise scale $\\eta$, using a fixed pseudo-random seed $s$ per test. The reconstruction $\\widehat{\\boldsymbol{\\Phi}}$ must be produced by solving the stated optimization with the given $\\alpha$, and the performance must be quantified as the relative $\\ell_2$ error\n$$\nE\\;=\\;\\frac{\\left\\lVert \\widehat{\\boldsymbol{\\Phi}}-\\boldsymbol{\\Phi}_{\\text{true}} \\right\\rVert_2}{\\left\\lVert \\boldsymbol{\\Phi}_{\\text{true}} \\right\\rVert_2},\n$$\nexpressed as a decimal.\n\nTest suite. Implement the following three test cases, each specifying the illumination set $\\{(c_j,w_j)\\}$, the noise parameters, and the regularization strength:\n\n- Test case A (general well-posed case): $J=\\,$$7$ with centers $c_j\\in\\{305,320,335,345,355,365,375\\}$ nm and widths $w_j\\in\\{6,8,8,8,8,8,6\\}$ nm. Use noise scale $\\eta=\\,$$0.01$, seed $s=\\,$$12345$, and regularization strength $\\alpha=\\,$$0.01$.\n\n- Test case B (ill-conditioned with fewer illuminations and higher noise): $J=\\,$$2$ with centers $c_j\\in\\{320,360\\}$ nm and widths $w_j\\in\\{15,15\\}$ nm. Use noise scale $\\eta=\\,$$0.05$, seed $s=\\,$$24680$, and regularization strength $\\alpha=\\,$$0.05$.\n\n- Test case C (near-identity sensing, noise-free): $J=\\,$$81$ with centers $c_j$ equal to every wavelength grid point $\\{300,301,\\dots,380\\}$ nm and a common narrow width $w_j=\\,$$0.8$ nm for all $j$. Use noise scale $\\eta=\\,$$0$, no randomness (seed unused), and regularization strength $\\alpha=\\,$$10^{-6}$.\n\nAlgorithmic requirements. Construct the matrices $\\mathbf{K}$ and $\\mathbf{L}$ exactly as defined. Solve the regularized problem by converting it to an equivalent bound-constrained least-squares problem via system augmentation,\n$$\n\\min_{\\boldsymbol{\\Phi}\\in [0,\\infty)^L}\\ \\left\\lVert \\begin{bmatrix}\\mathbf{K}\\\\ \\sqrt{\\alpha}\\,\\mathbf{L}\\end{bmatrix}\\boldsymbol{\\Phi}\\;-\\;\\begin{bmatrix}\\mathbf{y}\\\\ \\mathbf{0}\\end{bmatrix}\\right\\rVert_2,\n$$\nand use a deterministic solver with lower bound $\\mathbf{0}$ and an upper bound of $1.5$ elementwise. Do not use any stochastic method beyond the specified Gaussian noise.\n\nOutput. For each test case, compute the relative $\\ell_2$ error $E$ as defined above, rounded to six decimal places. Your program should produce a single line of output containing the three results as a comma-separated list enclosed in square brackets (e.g., \"[$e_1$,$e_2$,$e_3$]\"). All outputs are decimals without units.\n\nPhysical units. The spectral photon flux density $F_j(\\lambda)$ is in photons$\\cdot$nm$^{-1}\\cdot$m$^{-2}\\cdot$s$^{-1}$, the absorptance $a(\\lambda)$ and the quantum yield $\\Phi(\\lambda)$ are dimensionless, and the rate $R_j$ is in photons$\\cdot$m$^{-2}\\cdot$s$^{-1}$ scaled by the dimensionless yield. The requested error outputs are dimensionless decimals. Angles do not appear in this problem.\n\nFinal check. Ensure that your implementation is self-contained, uses the specified grid and parameters exactly as given, and that the final printed line is the list of three rounded errors in the exact format described.", "solution": "The problem as stated is a valid and well-posed exercise in computational physical chemistry. It presents a standard inverse problem—recovering a function from its integral transforms—set in the context of photochemical kinetics. The approach of using Tikhonov regularization with a smoothness prior and non-negativity constraints is a rigorous and widely accepted method for solving such ill-posed problems. All required data, models, and parameters are provided unambiguously. Therefore, we shall proceed with a detailed, step-by-step solution.\n\nThe fundamental relationship given is the photoproduct formation rate $R_j$ for a specific illumination spectrum $F_j(\\lambda)$:\n$$ R_j \\;=\\; \\int_{\\lambda_{\\min}}^{\\lambda_{\\max}} F_j(\\lambda)\\,a(\\lambda)\\,\\Phi(\\lambda)\\,d\\lambda $$\nThis integral equation connects the measured data $R_j$ to the unknown quantum yield function $\\Phi(\\lambda)$. Our goal is to solve for $\\Phi(\\lambda)$.\n\n**Step 1: Discretization and Linear System Formulation**\n\nThe continuous problem is made computationally tractable through discretization. The wavelength domain $[\\lambda_{\\min}, \\lambda_{\\max}] = [300, 380]$ nm is partitioned into a uniform grid $\\{\\lambda_k\\}_{k=1}^L$ with spacing $\\Delta\\lambda = 1$ nm, resulting in $L = (380 - 300)/1 + 1 = 81$ discrete points.\n\nThe integral is approximated by a Riemann sum:\n$$ y_j \\approx \\sum_{k=1}^{L} F_j(\\lambda_k)\\,a(\\lambda_k)\\,\\Phi(\\lambda_k)\\,\\Delta\\lambda $$\nwhere $y_j$ represents the measured rate, inclusive of noise. This set of $J$ equations (for $J$ different illuminations) can be expressed in matrix-vector form:\n$$ \\mathbf{y} = \\mathbf{K}\\boldsymbol{\\Phi} + \\boldsymbol{\\varepsilon} $$\nHere, $\\mathbf{y} \\in \\mathbb{R}^J$ is the vector of measured rates, $\\boldsymbol{\\Phi} \\in \\mathbb{R}^L$ is the discretized unknown quantum yield vector, $\\boldsymbol{\\varepsilon} \\in \\mathbb{R}^J$ is additive noise, and $\\mathbf{K} \\in \\mathbb{R}^{J \\times L}$ is the kernel matrix whose elements are defined by:\n$$ K_{j,k} = F_j(\\lambda_k)\\,a(\\lambda_k)\\,\\Delta\\lambda $$\nThe vector $\\boldsymbol{\\Phi}$ is what we seek to determine.\n\n**Step 2: Construction of the System and Regularization Matrices**\n\nFor a given set of test parameters, we first construct the necessary matrices.\n\nThe absorptance vector $\\mathbf{a} \\in \\mathbb{R}^L$ is computed by evaluating the given function $a(\\lambda)$ on the wavelength grid $\\boldsymbol{\\lambda}$:\n$$ a_k = a(\\lambda_k) = 0.6\\exp\\left(-\\frac{(\\lambda_k-330)^2}{2 \\cdot 64}\\right) + 0.3\\exp\\left(-\\frac{(\\lambda_k-360)^2}{2 \\cdot 25}\\right) $$\n\nFor each of the $J$ illuminations in a test case, the spectral photon flux vector $\\mathbf{F}_j \\in \\mathbb{R}^L$ is calculated. The provided formula includes normalization over the discrete grid:\n$$ (F_j)_k = F_j(\\lambda_k) = \\frac{\\exp\\left(-\\frac{1}{2}\\left(\\frac{\\lambda_k-c_j}{w_j}\\right)^2\\right)}{\\sum_{i=1}^{L}\\exp\\left(-\\frac{1}{2}\\left(\\frac{\\lambda_i-c_j}{w_j}\\right)^2\\right)\\,\\Delta\\lambda} $$\nWith $\\mathbf{a}$ and the set of $\\{\\mathbf{F}_j\\}_{j=1}^J$, the kernel matrix $\\mathbf{K}$ is assembled row by row.\n\nTo regularize the problem, a first-order finite-difference operator $\\mathbf{L} \\in \\mathbb{R}^{(L-1) \\times L}$ is constructed. It is a bidiagonal matrix of the form:\n$$ \\mathbf{L} = \\begin{pmatrix}\n-1  1  0  \\dots  0 \\\\\n0  -1  1  \\dots  0 \\\\\n\\vdots   \\ddots   \\vdots \\\\\n0  \\dots  0  -1  1\n\\end{pmatrix} $$\nThe term $\\left\\lVert \\mathbf{L}\\boldsymbol{\\Phi}\\right\\rVert_2^2$ in the objective function penalizes large variations between adjacent points in the quantum yield spectrum, thereby enforcing smoothness.\n\n**Step 3: Synthetic Data Generation for Testing**\n\nA known ground truth, $\\boldsymbol{\\Phi}_{\\text{true}}$, is used to generate synthetic data, allowing for quantitative evaluation of the reconstruction accuracy. The true quantum yield is computed on the grid:\n$$ (\\Phi_{\\text{true}})_k = \\mathrm{clip}\\left[\\,0.15 + \\frac{0.6}{1+\\exp\\left(-\\frac{\\lambda_k-345}{6}\\right)} + 0.05\\,\\sin\\left(\\frac{2\\pi(\\lambda_k-300)}{30}\\right),\\, 0,\\, 1\\,\\right] $$\nThe noiseless data vector $\\mathbf{y}^\\star \\in \\mathbb{R}^J$ is then $\\mathbf{y}^\\star = \\mathbf{K} \\boldsymbol{\\Phi}_{\\text{true}}$.\n\nMeasurement noise is simulated as independent and identically distributed Gaussian noise, $\\varepsilon_j \\sim \\mathcal{N}(0, \\sigma^2)$. The noise level $\\sigma$ is scaled by the median signal strength, $\\sigma = \\eta \\cdot \\mathrm{median}(|\\mathbf{y}^\\star|)$, for a given noise factor $\\eta$ and a fixed random seed for reproducibility. The final measurement vector is $\\mathbf{y} = \\mathbf{y}^\\star + \\boldsymbol{\\varepsilon}$.\n\n**Step 4: Solving the Bound-Constrained Regularized Least-Squares Problem**\n\nThe core of the task is to find the estimated quantum yield $\\widehat{\\boldsymbol{\\Phi}}$ by solving the Tikhonov-regularized optimization problem with a non-negativity constraint:\n$$ \\min_{\\boldsymbol{\\Phi} \\ge \\mathbf{0}} \\ \\left\\lVert \\mathbf{K}\\,\\boldsymbol{\\Phi}-\\mathbf{y}\\right\\rVert_2^2\\;+\\;\\alpha\\,\\left\\lVert \\mathbf{L}\\,\\boldsymbol{\\Phi}\\right\\rVert_2^2 $$\nAs specified, this is converted into a standard bound-constrained linear least-squares problem. We form an augmented matrix $\\mathbf{A}_{\\text{aug}}$ and an augmented vector $\\mathbf{y}_{\\text{aug}}$:\n$$ \\mathbf{A}_{\\text{aug}} = \\begin{bmatrix}\\mathbf{K}\\\\ \\sqrt{\\alpha}\\,\\mathbf{L}\\end{bmatrix}, \\quad \\mathbf{y}_{\\text{aug}} = \\begin{bmatrix}\\mathbf{y}\\\\ \\mathbf{0}\\end{bmatrix} $$\nThe problem is now equivalent to:\n$$ \\min_{\\boldsymbol{\\Phi}} \\left\\lVert \\mathbf{A}_{\\text{aug}}\\boldsymbol{\\Phi} - \\mathbf{y}_{\\text{aug}}\\right\\rVert_2^2 \\quad \\text{subject to} \\quad \\mathbf{0} \\le \\boldsymbol{\\Phi} \\le 1.5 \\cdot \\mathbf{1} $$\nThis formulation is directly solvable using numerical libraries, specifically `scipy.optimize.lsq_linear`. The lower bound enforces the physical constraint $\\Phi(\\lambda) \\ge 0$, and the upper bound of $1.5$ is a non-binding but helpful constraint for solver stability, given the physical expectation that $\\Phi(\\lambda) \\le 1$.\n\n**Step 5: Error Quantification**\n\nThe accuracy of the recovered estimate $\\widehat{\\boldsymbol{\\Phi}}$ is assessed by computing the relative $\\ell_2$ error against the known ground truth $\\boldsymbol{\\Phi}_{\\text{true}}$:\n$$ E = \\frac{\\left\\lVert \\widehat{\\boldsymbol{\\Phi}}-\\boldsymbol{\\Phi}_{\\text{true}} \\right\\rVert_2}{\\left\\lVert \\boldsymbol{\\Phi}_{\\text{true}} \\right\\rVert_2} $$\nThis procedure is repeated for each of the three test cases, and the resulting errors are reported.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import lsq_linear\n\ndef solve():\n    \"\"\"\n    Solves for the wavelength-dependent quantum yield by inverting photostationary\n    rate measurements using Tikhonov regularization.\n    \"\"\"\n    \n    # --------------------------------------------------------------------------\n    # 1. Define Common Parameters and Functions\n    # --------------------------------------------------------------------------\n    lambda_min = 300.0\n    lambda_max = 380.0\n    delta_lambda = 1.0\n    lambda_grid = np.arange(lambda_min, lambda_max + delta_lambda, delta_lambda)\n    L = len(lambda_grid)\n\n    # Spectral absorptance a(lambda)\n    a_vec = 0.6 * np.exp(-(lambda_grid - 330.0)**2 / (2 * 8.0**2)) + \\\n            0.3 * np.exp(-(lambda_grid - 360.0)**2 / (2 * 5.0**2))\n\n    # Ground-truth quantum yield Phi_true(lambda)\n    phi_true_raw = 0.15 + 0.6 / (1 + np.exp(-(lambda_grid - 345.0) / 6.0)) + \\\n                   0.05 * np.sin(2 * np.pi * (lambda_grid - 300.0) / 30.0)\n    phi_true_vec = np.clip(phi_true_raw, 0, 1)\n\n    # First-order finite-difference regularization matrix L\n    L_matrix = np.eye(L, k=1) - np.eye(L)\n    L_matrix = L_matrix[:-1, :]\n\n    # --------------------------------------------------------------------------\n    # 2. Define Test Cases\n    # --------------------------------------------------------------------------\n    test_cases = [\n        # Test case A: Well-posed general case\n        {\n            \"illuminations\": list(zip(\n                [305, 320, 335, 345, 355, 365, 375],  # centers c_j\n                [6, 8, 8, 8, 8, 8, 6]                 # widths w_j\n            )),\n            \"eta\": 0.01,\n            \"seed\": 12345,\n            \"alpha\": 0.01\n        },\n        # Test case B: Ill-conditioned case\n        {\n            \"illuminations\": list(zip(\n                [320, 360],  # centers c_j\n                [15, 15]     # widths w_j\n            )),\n            \"eta\": 0.05,\n            \"seed\": 24680,\n            \"alpha\": 0.05\n        },\n        # Test case C: Near-identity sensing, noise-free\n        {\n            \"illuminations\": list(zip(lambda_grid, [0.8] * L)),\n            \"eta\": 0,\n            \"seed\": None,  # Not used for eta=0\n            \"alpha\": 1e-6\n        }\n    ]\n\n    # --------------------------------------------------------------------------\n    # 3. Process Each Test Case\n    # --------------------------------------------------------------------------\n    results = []\n    for case in test_cases:\n        J = len(case[\"illuminations\"])\n        alpha = case[\"alpha\"]\n\n        # Construct Kernel Matrix K\n        K_matrix = np.zeros((J, L))\n        for j, (c_j, w_j) in enumerate(case[\"illuminations\"]):\n            F_j_unnormalized = np.exp(-0.5 * ((lambda_grid - c_j) / w_j)**2)\n            normalization_const = np.sum(F_j_unnormalized) * delta_lambda\n            F_j_vec = F_j_unnormalized / normalization_const\n            K_matrix[j, :] = F_j_vec * a_vec * delta_lambda\n\n        # Generate synthetic measurement vector y\n        y_star = K_matrix @ phi_true_vec\n        \n        if case[\"eta\"]  0:\n            sigma = case[\"eta\"] * np.median(np.abs(y_star))\n            rng = np.random.default_rng(case[\"seed\"])\n            noise = rng.normal(loc=0.0, scale=sigma, size=J)\n            y_vec = y_star + noise\n        else:\n            y_vec = y_star\n\n        # Form the augmented system for Tikhonov regularization\n        A_aug = np.vstack([K_matrix, np.sqrt(alpha) * L_matrix])\n        y_aug = np.concatenate([y_vec, np.zeros(L - 1)])\n\n        # Solve the bound-constrained least-squares problem\n        # min ||A_aug * Phi - y_aug||^2, subject to 0 = Phi = 1.5\n        bounds = (0, 1.5)\n        solution = lsq_linear(A_aug, y_aug, bounds=bounds)\n        phi_hat_vec = solution.x\n\n        # Calculate the relative l2 error\n        error = np.linalg.norm(phi_hat_vec - phi_true_vec) / np.linalg.norm(phi_true_vec)\n        results.append(f\"{error:.6f}\")\n\n    # --------------------------------------------------------------------------\n    # 4. Print Final Output in Specified Format\n    # --------------------------------------------------------------------------\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2666410"}]}