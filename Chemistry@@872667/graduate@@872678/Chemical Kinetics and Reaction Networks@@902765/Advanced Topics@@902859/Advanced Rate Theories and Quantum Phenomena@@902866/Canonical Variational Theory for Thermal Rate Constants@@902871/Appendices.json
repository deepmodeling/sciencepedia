{"hands_on_practices": [{"introduction": "The core principle of Canonical Variational Theory (CVT) is to find the optimal location for the dividing surface by minimizing the calculated Transition State Theory (TST) rate. This exercise provides a foundational application of this principle to a classic parabolic saddle potential. By deriving the TST rate as a function of the dividing surface position, $k_{\\text{TST}}(x_{0};T)$, you will identify the location that corresponds to the minimum flux and explore how the properties of orthogonal modes influence this result [@problem_id:2629601].", "problem": "A classical particle of mass $m$ moves on a two-dimensional separable potential energy surface\n$$\nV(x,y)\\;=\\;V^{\\ddagger}\\;-\\;\\frac{1}{2}m\\omega_{x}^{2}\\,x^{2}\\;+\\;\\frac{1}{2}m\\omega_{y}^{2}\\,y^{2},\n$$\nwith one unstable mode $x$ of frequency $\\omega_{x}$ at the saddle ($x=0$) and one stable orthogonal mode $y$ of frequency $\\omega_{y}$. The system is in canonical equilibrium at absolute temperature $T$ with inverse temperature $\\beta=1/(k_{\\mathrm{B}}T)$, where $k_{\\mathrm{B}}$ is the Boltzmann constant.\n\nConsider the dividing surface defined by $s(x)=x-x_{0}=0$, where $x_{0}$ is a constant to be chosen variationally. In classical Transition State Theory (TST), the thermal rate constant through this dividing surface is defined as the canonical equilibrium flux divided by the reactant population,\n$$\nk_{\\text{TST}}(x_{0};T)\\;=\\;\\frac{1}{Q_{r}}\\int \\mathrm{d}x\\,\\mathrm{d}y\\,\\mathrm{d}p_{x}\\,\\mathrm{d}p_{y}\\;\\delta\\!\\big(x-x_{0}\\big)\\,\\theta\\!\\big(\\dot{s}\\big)\\,\\dot{s}\\;\\exp\\!\\big(-\\beta H(x,y,p_{x},p_{y})\\big),\n$$\nwhere $H(x,y,p_{x},p_{y})=\\frac{p_{x}^{2}}{2m}+\\frac{p_{y}^{2}}{2m}+V(x,y)$ is the classical Hamiltonian, $\\dot{s}=\\dot{x}=p_{x}/m$, $\\delta(\\cdot)$ is the Dirac delta function, $\\theta(\\cdot)$ is the Heaviside step function, and $Q_{r}$ is the reactant canonical partition function (a constant independent of $x_{0}$). Canonical Variational Theory (CVT) chooses $x_{0}$ to minimize $k_{\\text{TST}}(x_{0};T)$.\n\nStarting from the above definitions only, compute a closed-form expression for $k_{\\text{TST}}(x_{0};T)$ in terms of $m$, $\\omega_{x}$, $\\omega_{y}$, $V^{\\ddagger}$, $\\beta$, and $Q_{r}$, and then determine the value of $x_{0}$ that minimizes $k_{\\text{TST}}(x_{0};T)$. Interpret whether the entropic contribution from the $y$ mode shifts the optimal $x_{0}$ away from $x_{0}=0$.\n\nExpress your final answer as the optimal value of $x_{0}$ that minimizes $k_{\\text{TST}}(x_{0};T)$. No rounding is required. No units are required in the final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard exercise in classical canonical variational transition state theory for a separable parabolic potential. All necessary information is provided. Therefore, we proceed to the solution.\n\nThe task is to first derive a closed-form expression for the classical Transition State Theory (TST) rate constant, $k_{\\text{TST}}(x_{0};T)$, for a particle of mass $m$ on the given potential energy surface, and then to find the value of $x_{0}$ that minimizes this rate constant as prescribed by Canonical Variational Theory (CVT).\n\nThe TST rate constant is given by the expression:\n$$\nk_{\\text{TST}}(x_{0};T) = \\frac{1}{Q_{r}}\\int \\mathrm{d}x\\,\\mathrm{d}y\\,\\mathrm{d}p_{x}\\,\\mathrm{d}p_{y}\\;\\delta(x-x_{0})\\,\\theta(\\dot{s})\\,\\dot{s}\\;\\exp(-\\beta H(x,y,p_{x},p_{y}))\n$$\nThe classical Hamiltonian $H$ and the potential $V(x,y)$ are:\n$$\nH(x,y,p_{x},p_{y}) = \\frac{p_{x}^{2}}{2m}+\\frac{p_{y}^{2}}{2m}+V(x,y)\n$$\n$$\nV(x,y) = V^{\\ddagger} - \\frac{1}{2}m\\omega_{x}^{2}x^{2} + \\frac{1}{2}m\\omega_{y}^{2}y^{2}\n$$\nThe term $\\dot{s}$ is the velocity perpendicular to the dividing surface $s(x)=x-x_{0}=0$, which is $\\dot{s}=\\dot{x}=p_{x}/m$.\n\nWe substitute the Hamiltonian into the rate constant expression. The integral over the phase space coordinates can be simplified by evaluating the integral over $x$ first, using the property of the Dirac delta function $\\delta(x-x_{0})$. This sets $x=x_{0}$ in the rest of the integrand.\n$$\nk_{\\text{TST}}(x_{0};T) = \\frac{1}{Q_{r}}\\int \\mathrm{d}y\\,\\mathrm{d}p_{x}\\,\\mathrm{d}p_{y}\\;\\theta\\left(\\frac{p_{x}}{m}\\right)\\,\\frac{p_{x}}{m}\\;\\exp\\left(-\\beta \\left[\\frac{p_{x}^{2}}{2m}+\\frac{p_{y}^{2}}{2m} + V^{\\ddagger} - \\frac{1}{2}m\\omega_{x}^{2}x_{0}^{2} + \\frac{1}{2}m\\omega_{y}^{2}y^{2}\\right]\\right)\n$$\nThe exponential can be factored, and due to the separability of the Hamiltonian, the overall integral can be written as a product of four terms: a constant factor and three one-dimensional integrals.\n$$\nk_{\\text{TST}}(x_{0};T) = \\frac{1}{Q_{r}} \\exp(-\\beta V^{\\ddagger}) \\exp\\left(\\frac{1}{2}\\beta m\\omega_{x}^{2}x_{0}^{2}\\right) \\times I_{p_{x}} \\times I_{p_{y}} \\times I_{y}\n$$\nwhere the integrals $I_{p_{x}}$, $I_{p_{y}}$, and $I_{y}$ are defined as:\n$$\nI_{p_{x}} = \\int_{-\\infty}^{\\infty} \\mathrm{d}p_{x} \\; \\theta\\left(\\frac{p_{x}}{m}\\right)\\frac{p_{x}}{m} \\exp\\left(-\\frac{\\beta p_{x}^{2}}{2m}\\right)\n$$\n$$\nI_{p_{y}} = \\int_{-\\infty}^{\\infty} \\mathrm{d}p_{y} \\; \\exp\\left(-\\frac{\\beta p_{y}^{2}}{2m}\\right)\n$$\n$$\nI_{y} = \\int_{-\\infty}^{\\infty} \\mathrm{d}y \\; \\exp\\left(-\\frac{1}{2}\\beta m\\omega_{y}^{2}y^{2}\\right)\n$$\nWe now evaluate each integral.\n\nFor $I_{p_{x}}$, the Heaviside step function $\\theta(p_{x}/m)$ restricts the integration domain to $p_{x} \\in [0, \\infty)$.\n$$\nI_{p_{x}} = \\int_{0}^{\\infty} \\frac{p_{x}}{m} \\exp\\left(-\\frac{\\beta}{2m} p_{x}^{2}\\right) \\mathrm{d}p_{x}\n$$\nWe use the substitution $u = \\frac{\\beta}{2m}p_{x}^{2}$, so $\\mathrm{d}u = \\frac{\\beta}{m}p_{x}\\,\\mathrm{d}p_{x}$, which gives $\\frac{p_{x}}{m}\\mathrm{d}p_{x} = \\frac{1}{\\beta}\\mathrm{d}u$.\n$$\nI_{p_{x}} = \\int_{0}^{\\infty} \\frac{1}{\\beta} \\exp(-u) \\mathrm{d}u = \\frac{1}{\\beta} \\left[-\\exp(-u)\\right]_{0}^{\\infty} = \\frac{1}{\\beta} (0 - (-1)) = \\frac{1}{\\beta}\n$$\n\nFor $I_{p_{y}}$ and $I_{y}$, we use the standard Gaussian integral formula $\\int_{-\\infty}^{\\infty} \\exp(-az^{2})\\,\\mathrm{d}z = \\sqrt{\\pi/a}$.\n\nFor $I_{p_{y}}$, the coefficient is $a = \\beta/(2m)$:\n$$\nI_{p_{y}} = \\sqrt{\\frac{\\pi}{\\beta/(2m)}} = \\sqrt{\\frac{2\\pi m}{\\beta}}\n$$\n\nFor $I_{y}$, the coefficient is $a = \\frac{1}{2}\\beta m\\omega_{y}^{2}$:\n$$\nI_{y} = \\sqrt{\\frac{\\pi}{\\frac{1}{2}\\beta m\\omega_{y}^{2}}} = \\sqrt{\\frac{2\\pi}{\\beta m\\omega_{y}^{2}}}\n$$\n\nNow, we multiply these results together to obtain the full expression for $k_{\\text{TST}}(x_{0};T)$.\n$$\nk_{\\text{TST}}(x_{0};T) = \\frac{1}{Q_{r}} \\exp(-\\beta V^{\\ddagger}) \\exp\\left(\\frac{1}{2}\\beta m\\omega_{x}^{2}x_{0}^{2}\\right) \\left(\\frac{1}{\\beta}\\right) \\left(\\sqrt{\\frac{2\\pi m}{\\beta}}\\right) \\left(\\sqrt{\\frac{2\\pi}{\\beta m\\omega_{y}^{2}}}\\right)\n$$\nThe product of the square-root terms simplifies:\n$$\n\\sqrt{\\frac{2\\pi m}{\\beta} \\cdot \\frac{2\\pi}{\\beta m\\omega_{y}^{2}}} = \\sqrt{\\frac{4\\pi^{2}m}{\\beta^{2} m\\omega_{y}^{2}}} = \\frac{2\\pi}{\\beta \\omega_{y}}\n$$\nSubstituting this back gives the closed-form expression for the rate constant:\n$$\nk_{\\text{TST}}(x_{0};T) = \\frac{1}{Q_{r}} \\exp(-\\beta V^{\\ddagger}) \\exp\\left(\\frac{1}{2}\\beta m\\omega_{x}^{2}x_{0}^{2}\\right) \\frac{1}{\\beta} \\frac{2\\pi}{\\beta \\omega_{y}} = \\frac{2\\pi}{Q_{r}\\beta^{2}\\omega_{y}} \\exp(-\\beta V^{\\ddagger}) \\exp\\left(\\frac{1}{2}\\beta m\\omega_{x}^{2}x_{0}^{2}\\right)\n$$\nThis is the required expression for $k_{\\text{TST}}(x_{0};T)$.\n\nNext, we apply the CVT principle, which requires finding the value of $x_{0}$ that minimizes $k_{\\text{TST}}(x_{0};T)$. Let us examine the dependence of $k_{\\text{TST}}(x_{0};T)$ on $x_{0}$. The expression can be written as:\n$$\nk_{\\text{TST}}(x_{0};T) = C \\cdot \\exp\\left(\\frac{1}{2}\\beta m\\omega_{x}^{2}x_{0}^{2}\\right)\n$$\nwhere $C = \\frac{2\\pi}{Q_{r}\\beta^{2}\\omega_{y}} \\exp(-\\beta V^{\\ddagger})$ is a positive constant that does not depend on $x_{0}$.\nTo minimize $k_{\\text{TST}}(x_{0};T)$, we must minimize the term $\\exp(\\frac{1}{2}\\beta m\\omega_{x}^{2}x_{0}^{2})$. Since the exponential function is strictly monotonic increasing, this is equivalent to minimizing its argument, $g(x_{0}) = \\frac{1}{2}\\beta m\\omega_{x}^{2}x_{0}^{2}$.\n\nThe parameters $\\beta=1/(k_{\\mathrm{B}}T)$, $m$, and $\\omega_{x}^{2}$ are all positive. Therefore, the function $g(x_{0})$ is a parabola opening upwards, with its vertex at $x_{0}=0$. The minimum value of $g(x_{0})$ is $0$, which occurs uniquely at $x_{0}=0$.\nThus, the value of $x_{0}$ that minimizes $k_{\\text{TST}}(x_{0};T)$ is $x_{0}=0$.\n\nFinally, we must interpret this result. The variational transition state is located at the maximum of the free energy profile along the reaction coordinate. The free energy of the dividing surface at $x_{0}$ is $G^{\\ddagger}(x_{0}) = -k_{\\mathrm{B}}T \\ln Q^{\\ddagger}(x_{0})$, where $Q^{\\ddagger}(x_{0})$ is the partition function of the system constrained to the dividing surface. From our integral expression, ignoring factors related to the reaction coordinate itself, this is:\n$$\nQ^{\\ddagger}(x_{0}) \\propto \\exp\\left(-\\beta \\left[V^{\\ddagger} - \\frac{1}{2}m\\omega_{x}^{2}x_{0}^{2}\\right]\\right) \\int \\mathrm{d}y\\,\\mathrm{d}p_{y} \\exp\\left(-\\beta\\left[\\frac{p_{y}^{2}}{2m} + \\frac{1}{2}m\\omega_{y}^{2}y^{2}\\right]\\right)\n$$\nThe integral term is the partition function for the orthogonal mode $y$, $q_{y}$. Since $\\omega_{y}$ is a constant in the problem statement, $q_{y}$ is independent of $x_{0}$. The free energy is thus:\n$$\nG^{\\ddagger}(x_{0}) = V^{\\ddagger} - \\frac{1}{2}m\\omega_{x}^{2}x_{0}^{2} - k_{\\mathrm{B}}T\\ln(q_{y}) + \\text{const.}\n$$\nThe entropic contribution from the $y$ mode, $-k_{\\mathrm{B}}T\\ln(q_{y})$, is a constant with respect to $x_{0}$. It provides a constant downward shift to the free energy profile but does not change the location of its maximum. The maximum of $G^{\\ddagger}(x_{0})$ is determined solely by the maximum of the potential energy term, $V_{pot}(x_{0}) = V^{\\ddagger} - \\frac{1}{2}m\\omega_{x}^{2}x_{0}^{2}$, which occurs at $x_{0}=0$.\nTherefore, the entropic contribution from the stable mode $y$ does not shift the optimal dividing surface away from the potential energy saddle point at $x_{0}=0$. A shift would only occur if the frequency of the orthogonal mode, $\\omega_{y}$, were a function of the reaction coordinate $x$, i.e., $\\omega_{y}(x)$, indicating coupling between the modes. Such coupling is absent in the specified separable potential.", "answer": "$$\n\\boxed{0}\n$$", "id": "2629601"}, {"introduction": "A fundamental theorem of reaction rate theory states that the TST rate provides a strict upper bound to the true classical rate. CVT aims to find the tightest possible upper bound by variationally optimizing the dividing surface. This problem presents a carefully constructed model where the CVT rate exactly equals the true classical rate, illustrating the ideal scenario where the \"no-recrossing\" assumption of TST holds perfectly at the variational transition state [@problem_id:2629639].", "problem": "Consider a classical, one-dimensional Hamiltonian system with Hamiltonian $H(x,p) = \\frac{p^{2}}{2m} + V(x)$ that describes a unimolecular reaction from a reactant basin to products. Assume the following physically realistic and self-consistent model.\n- The reactant basin is a harmonic well of frequency $\\omega_{r}$ with minimum energy set to zero at $x=-x_{0}$, i.e., in the reactant region the potential can be taken as $V_{r}(x) = \\frac{1}{2} m \\omega_{r}^{2} (x + x_{0})^{2}$.\n- There is a single barrier at $x=0$ of height $V^{\\ddagger} = V(0)$, and for $x>0$ the potential $V(x)$ decreases monotonically so that any trajectory that reaches $x>0$ with energy $E>V^{\\ddagger}$ never returns to $x \\le 0$ (no classical recrossing once the barrier is crossed).\n- The exact classical transmission probability is $P_{\\mathrm{cl}}(E) = \\Theta(E - V^{\\ddagger})$, where $\\Theta(\\cdot)$ is the Heaviside step function.\n- The system is prepared in a canonical ensemble at temperature $T$ with Boltzmann constant $k_{\\mathrm{B}}$.\n\nStarting only from the principles of Hamiltonian mechanics and the classical canonical ensemble, and using phase-space integrals without invoking any prepackaged transition-state formulas, do the following.\n1) Using Canonical Variational Transition State Theory (CVTST), which chooses a dividing surface at position $s$ along the coordinate $x$ to minimize the canonical flux-over-population rate $k[s](T)$, derive a closed-form expression for the optimal $k_{\\mathrm{CVT}}(T)$ in terms of $\\omega_{r}$, $V^{\\ddagger}$, $k_{\\mathrm{B}}$, and $T$.\n2) Using the given exact classical transmission probability $P_{\\mathrm{cl}}(E)$ and the canonical reactant ensemble, obtain a closed-form expression for the exact classical thermal rate constant $k_{\\mathrm{exact}}(T)$ for this model.\n3) Explain why $k_{\\mathrm{CVT}}(T)$ is an upper bound to $k_{\\mathrm{exact}}(T)$ in general, and verify for this model that the bound is saturated. Define the gap $\\Delta(T) \\equiv k_{\\mathrm{CVT}}(T) - k_{\\mathrm{exact}}(T)$ and give it in closed form.\n\nExpress your final answer as a row matrix containing $k_{\\mathrm{CVT}}(T)$ and $\\Delta(T)$ in symbolic form, with all parameters kept symbolic. Do not include units in your final expressions. For interpretation, the rate constants have units of inverse time (e.g., $\\mathrm{s}^{-1}$).", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard, albeit simplified, model for a unimolecular reaction that is tractable within the framework of classical statistical mechanics and reaction rate theory. All necessary information is provided, and the task is to derive quantities based on established principles without invoking pre-packaged formulas. The problem is therefore deemed **valid**, and I will proceed with the solution.\n\nThe solution is presented in three parts, as requested.\n\nFirst, we derive the expression for the Canonical Variational Transition State Theory (CVTST) rate constant, $k_{\\mathrm{CVT}}(T)$. The derivation begins from the fundamental definition of the rate constant for a dividing surface at position $s$ along the reaction coordinate $x$. The Transition State Theory (TST) rate constant, $k[s](T)$, is the ratio of the one-way flux of phase points through the dividing surface to the total population of reactants.\n$$k[s](T) = \\frac{\\Phi_+[s]}{Q_r}$$\nHere, $\\Phi_+[s]$ is the forward flux through the surface $x=s$, and $Q_r$ is the canonical partition function of the reactants.\n\nThe forward flux is calculated via a phase-space integral over the Hamiltonian $H(x,p) = \\frac{p^2}{2m} + V(x)$, with $\\beta = (k_{\\mathrm{B}} T)^{-1}$:\n$$\\Phi_+[s] = \\int_{-\\infty}^{\\infty} dx \\int_0^{\\infty} dp \\, \\frac{1}{h} \\left(\\frac{p}{m}\\right) \\delta(x-s) \\exp(-\\beta H(x,p))$$\nThe delta function $\\delta(x-s)$ localizes the integral to the dividing surface.\n$$\\Phi_+[s] = \\frac{1}{h} \\exp(-\\beta V(s)) \\int_0^{\\infty} dp \\, \\frac{p}{m} \\exp\\left(-\\frac{\\beta p^2}{2m}\\right)$$\nThe integral over momentum evaluates to:\n$$\\int_0^{\\infty} \\frac{p}{m} \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) dp = \\left[-\\frac{1}{\\beta} \\exp\\left(-\\frac{\\beta p^2}{2m}\\right)\\right]_0^{\\infty} = \\frac{1}{\\beta} = k_{\\mathrm{B}} T$$\nThus, the forward flux is:\n$$\\Phi_+[s] = \\frac{k_{\\mathrm{B}} T}{h} \\exp(-\\beta V(s))$$\n\nNext, we calculate the reactant partition function, $Q_r$. The reactant potential is given as a harmonic well, $V_r(x) = \\frac{1}{2} m \\omega_r^2 (x+x_0)^2$. In the context of TST, the reactant partition function is typically calculated by integrating over all phase space for the reactant potential well model.\n$$Q_r = \\frac{1}{h} \\int_{-\\infty}^{\\infty} dx \\int_{-\\infty}^{\\infty} dp \\, \\exp(-\\beta H_r(x,p))$$\nwhere $H_r(x,p)$ is the Hamiltonian with the reactant potential $V_r(x)$.\n$$Q_r = \\frac{1}{h} \\left( \\int_{-\\infty}^{\\infty} dp \\, \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) \\right) \\left( \\int_{-\\infty}^{\\infty} dx \\, \\exp\\left(-\\frac{1}{2} \\beta m \\omega_r^2 (x+x_0)^2\\right) \\right)$$\nThese are standard Gaussian integrals. The momentum integral yields $\\sqrt{2\\pi m / \\beta}$. The position integral yields $\\sqrt{2\\pi / (\\beta m \\omega_r^2)}$.\n$$Q_r = \\frac{1}{h} \\sqrt{\\frac{2\\pi m}{\\beta}} \\sqrt{\\frac{2\\pi}{\\beta m \\omega_r^2}} = \\frac{1}{h} \\frac{2\\pi}{\\beta \\omega_r} = \\frac{2\\pi k_{\\mathrm{B}} T}{h \\omega_r}$$\n\nNow we assemble the TST rate constant $k[s](T)$:\n$$k[s](T) = \\frac{\\Phi_+[s]}{Q_r} = \\frac{(k_{\\mathrm{B}} T / h) \\exp(-\\beta V(s))}{2\\pi k_{\\mathrm{B}} T / (h \\omega_r)} = \\frac{\\omega_r}{2\\pi} \\exp(-\\beta V(s))$$\nCVTST requires finding the dividing surface position $s=s^*$ that minimizes this rate constant. This is equivalent to finding the position that maximizes the potential energy $V(s)$. The problem states that the potential has a single maximum at $x=0$, with value $V(0) = V^\\ddagger$. Therefore, the optimal dividing surface is at $s^*=0$.\nThe CVTST rate constant is the rate evaluated at this optimal surface:\n$$k_{\\mathrm{CVT}}(T) = k[s=0](T) = \\frac{\\omega_r}{2\\pi} \\exp(-\\beta V(0)) = \\frac{\\omega_r}{2\\pi} \\exp\\left(-\\frac{V^\\ddagger}{k_{\\mathrm{B}} T}\\right)$$\n\nSecond, we obtain the exact classical thermal rate constant, $k_{\\mathrm{exact}}(T)$. The exact rate constant can be expressed as the TST rate evaluated at an optimal dividing surface, multiplied by a transmission coefficient $\\kappa(T)$ that corrects for trajectories recrossing this surface.\n$$k_{\\mathrm{exact}}(T) = \\kappa[s](T) k[s](T)$$\nThe key to this problem lies in the statement: \"any trajectory that reaches $x>0$ with energy $E>V^{\\ddagger}$ never returns\". Let us choose the dividing surface at the top of the barrier, $s=0$. Any trajectory crossing this surface in the forward direction (i.e., with momentum $p>0$) has a total energy $E = \\frac{p^2}{2m} + V(0) = \\frac{p^2}{2m} + V^\\ddagger$. Since $p>0$, it follows that $p^2/(2m) > 0$, and thus $E > V^\\ddagger$. According to the problem statement, such a trajectory is guaranteed to proceed to products ($x>0$) and never return. This signifies that there is no recrossing at the $s=0$ dividing surface.\nTherefore, for the dividing surface at $s=0$, the transmission coefficient is exactly unity: $\\kappa[s=0](T)=1$.\nThe exact classical rate is thus identical to the TST rate evaluated at this specific surface:\n$$k_{\\mathrm{exact}}(T) = k[s=0](T) = \\frac{\\omega_r}{2\\pi} \\exp\\left(-\\frac{V^\\ddagger}{k_{\\mathrm{B}} T}\\right)$$\n\nThird, we explain the upper-bound property of CVTST and calculate the gap $\\Delta(T)$.\nIn a general reaction, for any arbitrarily chosen dividing surface $s$, the TST rate $k[s](T)$ assumes that every forward crossing leads to reaction. However, classical trajectories may recross the surface multiple times before settling into either reactants or products. TST improperly counts these recrossing, non-reactive trajectories as reactive events. Consequently, the TST rate provides an upper bound to the true rate: $k_{\\mathrm{exact}}(T) \\le k[s](T)$ for any $s$.\nCVTST is a variational method that seeks the best possible TST rate by finding the dividing surface that minimizes this upper bound: $k_{\\mathrm{CVT}}(T) = \\min_s k[s](T)$. Since $k_{\\mathrm{exact}}(T)$ is a lower bound for $k[s](T)$ at every $s$, it must also be a lower bound for the minimum value. Thus, the fundamental variational principle of TST states that $k_{\\mathrm{exact}}(T) \\le k_{\\mathrm{CVT}}(T)$.\n\nTo verify that the bound is saturated in this model, we compare the expressions derived above:\n$$k_{\\mathrm{CVT}}(T) = \\frac{\\omega_r}{2\\pi} \\exp\\left(-\\frac{V^\\ddagger}{k_{\\mathrm{B}} T}\\right)$$\n$$k_{\\mathrm{exact}}(T) = \\frac{\\omega_r}{2\\pi} \\exp\\left(-\\frac{V^\\ddagger}{k_{\\mathrm{B}} T}\\right)$$\nThe expressions are identical. This means the bound is saturated, $k_{\\mathrm{CVT}}(T) = k_{\\mathrm{exact}}(T)$, because the CVTST procedure correctly identified the unique dividing surface at $s=0$ where the no-recrossing assumption of TST holds exactly true for this specific model.\n\nFinally, the gap $\\Delta(T)$ is defined as the difference between the CVTST rate and the exact rate:\n$$\\Delta(T) \\equiv k_{\\mathrm{CVT}}(T) - k_{\\mathrm{exact}}(T)$$\nGiven that we have shown these two rates to be equal for this model, the gap is zero.\n$$\\Delta(T) = \\left( \\frac{\\omega_r}{2\\pi} \\exp\\left(-\\frac{V^\\ddagger}{k_{\\mathrm{B}} T}\\right) \\right) - \\left( \\frac{\\omega_r}{2\\pi} \\exp\\left(-\\frac{V^\\ddagger}{k_{\\mathrm{B}} T}\\right) \\right) = 0$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\omega_{r}}{2\\pi} \\exp\\left(-\\frac{V^{\\ddagger}}{k_{\\mathrm{B}} T}\\right) & 0\n\\end{pmatrix}\n}\n$$", "id": "2629639"}, {"introduction": "While CVT provides a powerful static method for estimating rates, the underlying reason for its necessity lies in the classical dynamics of trajectories. A poorly chosen dividing surface is plagued by \"recrossing\" events, where trajectories cross the surface but do not proceed to products, artificially inflating the rate. This computational exercise delves into this phenomenon directly, asking you to simulate trajectories and calculate the transmission coefficient $\\kappa(T)$, which quantifies the reduction in rate due to recrossing for a non-optimal, tilted dividing surface [@problem_id:2629554].", "problem": "Consider a two–degree-of-freedom classical Hamiltonian system intended to model a barrier crossing with a flat orthogonal mode, as used in Canonical Variational Theory (CVT) for thermal rate constants. The Hamiltonian is\n$$\nH(x,y,p_x,p_y) \\;=\\; \\frac{p_x^2}{2m} \\;+\\; \\frac{p_y^2}{2m} \\;+\\; V(x,y),\n$$\nwith the separable quadratic saddle potential\n$$\nV(x,y) \\;=\\; E_b \\;-\\; \\frac{1}{2} m \\,\\omega_x^2\\, x^2 \\;+\\; \\frac{1}{2} m \\,\\omega_y^2\\, y^2,\n$$\nwhere $m$ is the mass, $\\omega_x$ is the (real, positive) magnitude of the imaginary frequency along the reaction coordinate $x$ at the saddle, and $\\omega_y$ is the frequency of the orthogonal (bath) mode $y$. The energy offset $E_b$ does not affect the dynamics and may be set to $0$ without loss of generality.\n\nA planar dividing surface is specified by\n$$\ns(x,y) \\;=\\; x \\;-\\; \\alpha\\, y,\n$$\nso that the product region is the half-space $s(x,y) > 0$ and the reactant region is $s(x,y) < 0$. The “tilt” parameter $\\alpha$ controls the orientation of the dividing surface relative to the reaction coordinate. The instantaneous flux across the dividing surface is proportional to $\\dot{s} = \\dot{x} - \\alpha \\dot{y}$.\n\nAdopt classical Hamiltonian dynamics with\n$$\n\\dot{x} = \\frac{p_x}{m}, \\quad \\dot{y} = \\frac{p_y}{m}, \\quad \\dot{p}_x = + m \\omega_x^2 x, \\quad \\dot{p}_y = - m \\omega_y^2 y,\n$$\nwhich implies the analytical solutions\n$$\nx(t) \\;=\\; x_0 \\cosh(\\omega_x t) \\;+\\; \\frac{v_{x,0}}{\\omega_x}\\sinh(\\omega_x t),\\qquad\ny(t) \\;=\\; y_0 \\cos(\\omega_y t) \\;+\\; \\frac{v_{y,0}}{\\omega_y}\\sin(\\omega_y t),\n$$\nwith $v_{x,0} = \\dot{x}(0)$ and $v_{y,0} = \\dot{y}(0)$.\n\nUse a short-time trajectory analysis of the flux-side time correlation form to estimate the transmission coefficient $\\kappa(T)$ (the reduction from transition state theory due to recrossing) at temperature $T$ in reduced units with Boltzmann constant $k_{\\mathrm{B}} = 1$. The flux ensemble at the dividing surface is defined by the canonical density restricted to $s(x,y)=0$ and weighted by the positive normal velocity,\n$$\n\\rho_{\\mathrm{flux}} \\;\\propto\\; \\delta\\!\\big(s(x,y)\\big)\\; \\Theta\\!\\big(\\dot{s}\\big)\\; \\dot{s}\\; \\exp\\!\\big(-\\beta H(x,y,p_x,p_y)\\big),\\quad \\beta = 1/T,\n$$\nwhere $\\Theta(\\cdot)$ is the Heaviside step function and $\\delta(\\cdot)$ is the Dirac delta distribution.\n\nFor a given short observation time $t^\\star > 0$, estimate $\\kappa(T)$ by the flux-weighted fraction of trajectories that, having just crossed from reactants to products with $\\dot{s}>0$ at $t=0$, are found on the product side at time $t^\\star$:\n$$\n\\kappa(T; t^\\star) \\;\\approx\\; \\frac{\\left\\langle \\Theta\\!\\big(s(x(t^\\star),y(t^\\star))\\big)\\; \\right\\rangle_{\\mathrm{flux}}}{\\left\\langle 1 \\right\\rangle_{\\mathrm{flux}}},\n$$\nwhere the averages are over the flux ensemble. This equals the ratio\n$$\n\\kappa(T; t^\\star) \\;=\\; \\frac{\\int \\delta(s)\\,\\Theta(\\dot{s})\\,\\dot{s}\\,e^{-\\beta H}\\,\\Theta\\!\\big(s(t^\\star)\\big)\\,d\\Gamma}{\\int \\delta(s)\\,\\Theta(\\dot{s})\\,\\dot{s}\\,e^{-\\beta H}\\,d\\Gamma},\n$$\nwith $d\\Gamma = dx\\,dy\\,dp_x\\,dp_y$. In practice, estimate this ratio by Monte Carlo sampling from the canonical distribution restricted to $s=0$ and weighting each sample by $\\max(\\dot{s},0)$.\n\nA poor choice of dividing surface (large $\\alpha$) couples the orthogonal mode into the dividing surface, creating large recrossing when the orthogonal mode is relatively flat (small $\\omega_y$). Your task is to implement a program that:\n\n- Samples initial conditions from the canonical distribution at temperature $T$ constrained to $s(x,y)=0$ via the substitution $x = \\alpha y$.\n- Draws velocities $(v_{x,0}, v_{y,0})$ from the Maxwell–Boltzmann distribution at temperature $T$ for mass $m$.\n- Weights each trajectory by $w = \\max(\\dot{s}(0),0) = \\max(v_{x,0} - \\alpha v_{y,0},0)$.\n- Propagates each trajectory analytically to time $t^\\star$ and records the indicator $\\Theta\\!\\big(s(x(t^\\star),y(t^\\star))\\big)$.\n- Estimates $\\kappa(T; t^\\star)$ as the weighted average of that indicator divided by the weighted average of $1$.\n\nTo ensure the stationary canonical measure along the dividing surface, sample $y_0$ from the one-dimensional Gaussian implied by $V(\\alpha y, y)$:\n$$\nV(\\alpha y, y) \\;=\\; -\\frac{1}{2} m \\omega_x^2 (\\alpha y)^2 \\;+\\; \\frac{1}{2} m \\omega_y^2 y^2 \\;=\\; \\frac{1}{2} m \\Omega_{\\mathrm{eff}}^2\\, y^2,\n$$\nwith\n$$\n\\Omega_{\\mathrm{eff}}^2 \\;=\\; \\omega_y^2 \\;-\\; \\alpha^2 \\omega_x^2.\n$$\nYou must restrict to parameters with $\\Omega_{\\mathrm{eff}}^2 > 0$ so that the canonical density on the dividing surface is normalizable. Use $x_0 = \\alpha y_0$.\n\nUse the following test suite of parameter sets, all in reduced, dimensionless units with $k_{\\mathrm{B}} = 1$:\n\n- Test $1$ (good dividing surface, baseline): $m = 1.0$, $T = 1.0$, $\\omega_x = 5.0$, $\\omega_y = 2.0$, $\\alpha = 0.0$, observation time $t^\\star = \\pi / (2\\,\\omega_y)$, number of trajectories $N = 200000$.\n- Test $2$ (poor dividing surface, moderate flatness): $m = 1.0$, $T = 1.0$, $\\omega_x = 5.0$, $\\omega_y = 1.0$, $\\alpha = 0.15$, $t^\\star = \\pi / (2\\,\\omega_y)$, $N = 200000$.\n- Test $3$ (poor dividing surface, flatter orthogonal mode): $m = 1.0$, $T = 1.0$, $\\omega_x = 5.0$, $\\omega_y = 0.8$, $\\alpha = 0.15$, $t^\\star = \\pi / (2\\,\\omega_y)$, $N = 200000$.\n- Test $4$ (poor dividing surface, stiffer orthogonal mode): $m = 1.0$, $T = 1.0$, $\\omega_x = 5.0$, $\\omega_y = 3.0$, $\\alpha = 0.15$, $t^\\star = \\pi / (2\\,\\omega_y)$, $N = 200000$.\n\nImplementation requirements:\n\n- Use a fixed pseudorandom seed equal to $12345$ for reproducibility.\n- Sample $y_0 \\sim \\mathcal{N}\\!\\left(0,\\;\\sigma_y^2\\right)$ with $\\sigma_y^2 = T/(m\\,\\Omega_{\\mathrm{eff}}^2)$, and $v_{x,0}, v_{y,0} \\sim \\mathcal{N}\\!\\left(0,\\;\\sigma_v^2\\right)$ with $\\sigma_v^2 = T/m$.\n- Use the analytical propagation formulas above to evaluate $s(t^\\star) = x(t^\\star) - \\alpha y(t^\\star)$.\n- Return $\\kappa(T; t^\\star)$ for each test as a floating-point number rounded to six digits after the decimal point.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., “[$\\mathtt{result1}$,$\\mathtt{result2}$,$\\mathtt{result3}$,$\\mathtt{result4}$]”). The four entries must be the estimates of $\\kappa(T; t^\\star)$ in the order of the tests $1$ through $4$, each rounded to six decimal places. No additional output should be printed.", "solution": "The problem statement is subjected to validation and is found to be scientifically sound, complete, and well-posed. It presents a standard model from the field of chemical kinetics—a two-dimensional quadratic saddle potential—and requests the numerical evaluation of the transmission coefficient using a correctly formulated Monte Carlo importance sampling scheme. The parameters provided are consistent and allow for a stable and meaningful computation. Therefore, a solution is warranted.\n\nThe objective is to compute the short-time approximation to the transmission coefficient, $\\kappa(T; t^\\star)$, for a classical particle moving on a two-dimensional potential energy surface. This coefficient quantifies the deviation from transition state theory (TST) due to trajectories recrossing the dividing surface. The TST rate constant assumes all trajectories crossing the dividing surface from reactants to products are reactive. In reality, some trajectories recross back to the reactant region, an effect captured by $\\kappa$.\n\nThe transmission coefficient is defined as a ratio of flux-weighted averages over an ensemble of trajectories starting on the dividing surface $s(x,y)=0$ at time $t=0$:\n$$\n\\kappa(T; t^\\star) = \\frac{\\left\\langle \\Theta\\!\\big(s(x(t^\\star),y(t^\\star))\\big)\\; \\right\\rangle_{\\mathrm{flux}}}{\\left\\langle 1 \\right\\rangle_{\\mathrm{flux}}} = \\frac{\\int \\delta(s)\\,\\Theta(\\dot{s})\\,\\dot{s}\\,e^{-\\beta H}\\,\\Theta\\!\\big(s(t^\\star)\\big)\\,d\\Gamma}{\\int \\delta(s)\\,\\Theta(\\dot{s})\\,\\dot{s}\\,e^{-\\beta H}\\,d\\Gamma}\n$$\nHere, $\\Gamma$ represents the full phase space $(x, y, p_x, p_y)$, $\\beta = 1/(k_B T)$ with $k_B=1$, $\\delta(\\cdot)$ is the Dirac delta function, and $\\Theta(\\cdot)$ is the Heaviside step function. The integrand is weighted by the canonical distribution $e^{-\\beta H}$, restricted to the dividing surface $s(x,y)=0$, and further restricted to trajectories initially moving toward the product side ($\\dot{s}>0$) by the factor $\\Theta(\\dot{s})\\,\\dot{s}$. The numerator contains an additional factor $\\Theta(s(t^\\star))$, which is $1$ if the trajectory is on the product side ($s>0$) at time $t^\\star$, and $0$ otherwise.\n\nThis ratio of integrals is estimated using a Monte Carlo importance sampling method. We sample initial conditions from the canonical distribution restricted to the dividing surface, denoted by the probability density $\\rho_{\\mathrm{DS}} \\propto \\delta(s) e^{-\\beta H}$. The remaining part of the flux measure, $\\max(\\dot{s},0)$, is used as an importance weight. The estimate for $\\kappa(T; t^\\star)$ is then:\n$$\n\\kappa(T; t^\\star) \\approx \\frac{\\sum_{i=1}^N \\max(\\dot{s}_i(0), 0) \\cdot \\Theta(s_i(t^\\star))}{\\sum_{i=1}^N \\max(\\dot{s}_i(0), 0)}\n$$\nwhere trajectory initial conditions are sampled as described below.\n\nThe step-by-step procedure for the Monte Carlo simulation is as follows:\n\n1.  **Sampling Initial Positions**. The dividing surface is defined by $s(x,y) = x - \\alpha y = 0$, which implies the constraint $x_0 = \\alpha y_0$. The potential energy on this surface is a function of $y_0$ alone:\n    $$\n    V(x_0, y_0) = V(\\alpha y_0, y_0) = -\\frac{1}{2} m \\omega_x^2 (\\alpha y_0)^2 + \\frac{1}{2} m \\omega_y^2 y_0^2 = \\frac{1}{2} m (\\omega_y^2 - \\alpha^2 \\omega_x^2) y_0^2\n    $$\n    We define the effective frequency squared on the dividing surface as $\\Omega_{\\mathrm{eff}}^2 = \\omega_y^2 - \\alpha^2 \\omega_x^2$. The problem correctly requires $\\Omega_{\\mathrm{eff}}^2 > 0$ for the potential to be confining, which makes the canonical distribution normalizable. The probability density for $y_0$ is proportional to $e^{-\\beta V(\\alpha y_0, y_0)} = \\exp\\left(-\\frac{\\beta m \\Omega_{\\mathrm{eff}}^2}{2} y_0^2\\right)$. This is a Gaussian distribution with mean $0$ and variance $\\sigma_y^2$. By comparing the exponent to that of a standard Gaussian, $-\\frac{y_0^2}{2\\sigma_y^2}$, we find:\n    $$\n    \\sigma_y^2 = \\frac{1}{\\beta m \\Omega_{\\mathrm{eff}}^2} = \\frac{T}{m \\Omega_{\\mathrm{eff}}^2}\n    $$\n    We sample $y_0$ from $\\mathcal{N}(0, \\sigma_y^2)$ and set $x_0 = \\alpha y_0$.\n\n2.  **Sampling Initial Velocities**. The kinetic energy is $K = \\frac{p_x^2}{2m} + \\frac{p_y^2}{2m} = \\frac{1}{2}m(v_x^2 + v_y^2)$. The velocity distribution is given by the Maxwell-Boltzmann distribution, where the probability density is proportional to $e^{-\\beta K}$. This corresponds to two independent Gaussian distributions for $v_{x,0}$ and $v_{y,0}$, each with mean $0$. The variance $\\sigma_v^2$ is found by comparing the exponent $-\\frac{\\beta m v_x^2}{2}$ with $-\\frac{v_x^2}{2\\sigma_v^2}$:\n    $$\n    \\sigma_v^2 = \\frac{1}{\\beta m} = \\frac{T}{m}\n    $$\n    We sample $v_{x,0}$ and $v_{y,0}$ independently from $\\mathcal{N}(0, \\sigma_v^2)$.\n\n3.  **Calculating Trajectory Weights**. The weight for each trajectory $i$ is determined by the initial flux across the dividing surface:\n    $$\n    w_i = \\max(\\dot{s}_i(0), 0) = \\max(v_{x,0}^{(i)} - \\alpha v_{y,0}^{(i)}, 0)\n    $$\n    Trajectories with $\\dot{s}(0) \\le 0$ are given zero weight as they are not crossing towards products.\n\n4.  **Propagating Trajectories**. Each trajectory is propagated from its initial state $(x_0, y_0, v_{x,0}, v_{y,0})$ to the observation time $t^\\star$ using the provided analytical solutions:\n    $$\n    x(t^\\star) = x_0 \\cosh(\\omega_x t^\\star) + \\frac{v_{x,0}}{\\omega_x}\\sinh(\\omega_x t^\\star)\n    $$\n    $$\n    y(t^\\star) = y_0 \\cos(\\omega_y t^\\star) + \\frac{v_{y,0}}{\\omega_y}\\sin(\\omega_y t^\\star)\n    $$\n\n5.  **Evaluating the Indicator Function**. At time $t^\\star$, we determine if the trajectory is on the product side by evaluating the sign of the dividing surface function $s(t^\\star)$:\n    $$\n    s(t^\\star) = x(t^\\star) - \\alpha y(t^\\star)\n    $$\n    The indicator function is $\\Theta(s(t^\\star))$, which is $1$ if $s(t^\\star) > 0$ and $0$ otherwise.\n\n6.  **Computing the Estimate**. Finally, the estimate for the transmission coefficient is the weighted average of the indicator function:\n    $$\n    \\hat{\\kappa}(T; t^\\star) = \\frac{\\sum_{i=1}^N w_i \\cdot \\Theta(s_i(t^\\star))}{\\sum_{i=1}^N w_i}\n    $$\nThe implementation will follow this logic for each set of parameters provided in the test suite. A fixed pseudorandom seed is used to ensure reproducibility of the stochastic simulation.", "answer": "```python\nimport numpy as np\n\ndef calculate_kappa(m, T, wx, wy, alpha, t_star, N, seed):\n    \"\"\"\n    Calculates the transmission coefficient kappa using Monte Carlo sampling.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n\n    # 1. Calculate parameters for sampling distributions\n    # Condition Omega_eff^2 > 0 is checked in problem validation\n    Omega_eff_sq = wy**2 - (alpha * wx)**2\n    sigma_y_sq = T / (m * Omega_eff_sq)\n    sigma_y = np.sqrt(sigma_y_sq)\n    \n    sigma_v_sq = T / m\n    sigma_v = np.sqrt(sigma_v_sq)\n\n    # 2. Sample initial conditions (positions and velocities)\n    # Positions on the dividing surface x = alpha*y\n    y0 = rng.normal(loc=0.0, scale=sigma_y, size=N)\n    x0 = alpha * y0\n    \n    # Velocities from Maxwell-Boltzmann distribution\n    vx0 = rng.normal(loc=0.0, scale=sigma_v, size=N)\n    vy0 = rng.normal(loc=0.0, scale=sigma_v, size=N)\n\n    # 3. Calculate trajectory weights\n    # w = max(s_dot(0), 0) = max(vx0 - alpha*vy0, 0)\n    s_dot_0 = vx0 - alpha * vy0\n    weights = np.maximum(s_dot_0, 0)\n\n    # 4. Propagate trajectories to time t_star\n    cosh_val = np.cosh(wx * t_star)\n    sinh_val_by_w = np.sinh(wx * t_star) / wx\n    cos_val = np.cos(wy * t_star)\n    sin_val_by_w = np.sin(wy * t_star) / wy\n\n    xt_star = x0 * cosh_val + vx0 * sinh_val_by_w\n    yt_star = y0 * cos_val + vy0 * sin_val_by_w\n\n    # 5. Evaluate the indicator function Theta(s(t_star))\n    s_t_star = xt_star - alpha * yt_star\n    indicator = (s_t_star > 0).astype(float)\n\n    # 6. Compute the estimate for kappa\n    numerator = np.sum(weights * indicator)\n    denominator = np.sum(weights)\n\n    if denominator == 0:\n        # This case is unlikely for large N but is a possible outcome\n        return 0.0\n\n    kappa = numerator / denominator\n    return kappa\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # m,    T,   wx,  wy,  alpha, N\n        (1.0, 1.0, 5.0, 2.0, 0.0,  200000), # Test 1\n        (1.0, 1.0, 5.0, 1.0, 0.15, 200000), # Test 2\n        (1.0, 1.0, 5.0, 0.8, 0.15, 200000), # Test 3\n        (1.0, 1.0, 5.0, 3.0, 0.15, 200000), # Test 4\n    ]\n\n    results = []\n    seed = 12345\n\n    for m, T, wx, wy, alpha, N in test_cases:\n        t_star = np.pi / (2.0 * wy)\n        kappa = calculate_kappa(m, T, wx, wy, alpha, t_star, N, seed)\n        # Round to six decimal places as required\n        results.append(f\"{kappa:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2629554"}]}