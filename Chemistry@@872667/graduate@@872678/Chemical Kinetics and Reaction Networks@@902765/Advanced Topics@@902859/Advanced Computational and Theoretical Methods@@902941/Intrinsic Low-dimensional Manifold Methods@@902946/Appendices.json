{"hands_on_practices": [{"introduction": "This first exercise grounds the abstract idea of a low-dimensional manifold in a simple, analytically solvable chemical system. By calculating the stiffness ratio from the Jacobian's eigenvalues, you will directly quantify the separation of fast and slow dynamics inherent in the system. This practice illuminates the core principle that allows for model reduction and introduces the concept of a slow variable as a composite quantity that evolves on a longer timescale [@problem_id:2649300].", "problem": "Consider the well-mixed, isothermal, constant-volume reaction network with mass-action kinetics given by the unimolecular reactions $A \\rightleftharpoons B$ and $B \\to C$. Denote the forward and backward rate constants of the reversible pair by $k_{1} > 0$ and $k_{-1} > 0$, respectively, and the rate constant for the irreversible step by $k_{s} > 0$. Assume the time-scale separation $k_{1} + k_{-1} \\gg k_{s}$ holds. Let $x_{A}(t)$, $x_{B}(t)$, and $x_{C}(t)$ denote the concentrations of $A$, $B$, and $C$, respectively.\n\nStarting from the law of mass action and the definition of the Jacobian matrix for autonomous ordinary differential equations, do the following:\n\n1. Derive the linear dynamical system for $(x_{A}, x_{B}, x_{C})^{\\top}$ and its Jacobian matrix $J$. Using the eigenvalues of $J$, define the stiffness ratio $r$ as the ratio of the magnitudes of the fast and slow nonzero eigenvalues, $r \\equiv |\\lambda_{\\text{fast}}|/|\\lambda_{\\text{slow}}|$. Compute $r$ to leading order in the small parameter $\\varepsilon \\equiv k_{s}/(k_{1}+k_{-1})$.\n\n2. Using the concept of the Intrinsic Low-Dimensional Manifold (ILDM), where the fast reaction fluxes vanish to leading order and fast variables are slaved to slow ones, identify a scalar slow variable $s(x)$ as a linear combination $s(x) = \\alpha_{A} x_{A} + \\alpha_{B} x_{B} + \\alpha_{C} x_{C}$ that is invariant under the fast reversible pair $A \\rightleftharpoons B$ (i.e., orthogonal to its stoichiometric subspace) and therefore changes only due to the slow reaction $B \\to C$. Impose the normalization $\\alpha_{A} = \\alpha_{B} = 1$ and $\\alpha_{C} = 0$.\n\nExpress your final answer as a row matrix with two entries, placing the stiffness ratio $r$ first and the slow variable $s(x)$ second. No numerical approximation is required; give a closed-form expression in terms of $k_{1}$, $k_{-1}$, $k_{s}$, $x_{A}$, and $x_{B}$. Do not include units in the final answer and do not report any intermediate results. The final answer must be an analytic expression.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. It is a standard exercise in the analysis of stiff chemical kinetic systems and model reduction via intrinsic low-dimensional manifolds. We proceed with the derivation.\n\nThe reaction network is given by $A \\underset{k_{-1}}{\\stackrel{k_{1}}{\\rightleftharpoons}} B \\stackrel{k_{s}}{\\to} C$. Applying the law of mass action for a well-mixed, isothermal, constant-volume system, we formulate the system of autonomous ordinary differential equations governing the concentrations $x_{A}(t)$, $x_{B}(t)$, and $x_{C}(t)$:\n$$\n\\frac{dx_{A}}{dt} = -k_{1}x_{A} + k_{-1}x_{B}\n$$\n$$\n\\frac{dx_{B}}{dt} = k_{1}x_{A} - k_{-1}x_{B} - k_{s}x_{B} = k_{1}x_{A} - (k_{-1} + k_{s})x_{B}\n$$\n$$\n\\frac{dx_{C}}{dt} = k_{s}x_{B}\n$$\nThis system is linear. It can be expressed in matrix form $\\frac{d\\mathbf{x}}{dt} = J\\mathbf{x}$, where $\\mathbf{x} = (x_{A}, x_{B}, x_{C})^{\\top}$. The Jacobian matrix $J$ is the constant matrix of coefficients:\n$$\nJ = \\begin{pmatrix}\n-k_{1} & k_{-1} & 0 \\\\\nk_{1} & -(k_{-1} + k_{s}) & 0 \\\\\n0 & k_{s} & 0\n\\end{pmatrix}\n$$\nTo find the eigenvalues $\\lambda$ of $J$, we solve the characteristic equation $\\det(J - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix}\n-k_{1} - \\lambda & k_{-1} & 0 \\\\\nk_{1} & -(k_{-1} + k_{s}) - \\lambda & 0 \\\\\n0 & k_{s} & -\\lambda\n\\end{pmatrix} = 0\n$$\nExpanding the determinant along the third column yields:\n$$\n(-\\lambda) \\left[ (-k_{1} - \\lambda)(-(k_{-1} + k_{s}) - \\lambda) - (k_{1})(k_{-1}) \\right] = 0\n$$\nOne eigenvalue is immediately identified as $\\lambda_{1} = 0$. This corresponds to the conservation of total mass, as $\\frac{d}{dt}(x_{A} + x_{B} + x_{C}) = 0$. The other two eigenvalues are the roots of the quadratic equation:\n$$\n(\\lambda + k_{1})(\\lambda + k_{-1} + k_{s}) - k_{1}k_{-1} = 0\n$$\n$$\n\\lambda^{2} + (k_{1} + k_{-1} + k_{s})\\lambda + k_{1}(k_{-1} + k_{s}) - k_{1}k_{-1} = 0\n$$\n$$\n\\lambda^{2} + (k_{1} + k_{-1} + k_{s})\\lambda + k_{1}k_{s} = 0\n$$\nWe solve for the remaining eigenvalues, which we denote $\\lambda_{\\text{fast}}$ and $\\lambda_{\\text{slow}}$, corresponding to the fast and slow dynamics, respectively. The time-scale separation is defined by the small parameter $\\varepsilon = \\frac{k_{s}}{k_{1}+k_{-1}} \\ll 1$. Let $K = k_{1} + k_{-1}$. The quadratic equation becomes $\\lambda^{2} + (K + k_{s})\\lambda + k_{1}k_{s} = 0$.\n\nWe seek solutions to leading order in $\\varepsilon$. For the fast timescale, we expect $|\\lambda| \\sim O(K)$. The equation becomes $\\lambda^2 + K\\lambda \\approx 0$, which gives $\\lambda \\approx -K$. Thus, to leading order, the fast eigenvalue is:\n$$\n\\lambda_{\\text{fast}} \\approx -(k_{1} + k_{-1})\n$$\nFor the slow timescale, we expect $|\\lambda| \\sim O(k_s)$. The term $\\lambda^2$ is of order $O(k_s^2)$ and is negligible compared to the other terms. The equation becomes $(K+k_s)\\lambda + k_1 k_s \\approx 0$, which simplifies to $K\\lambda + k_1 k_s \\approx 0$. This gives $\\lambda \\approx -k_1 k_s / K$. The slow nonzero eigenvalue to leading order is:\n$$\n\\lambda_{\\text{slow}} \\approx -\\frac{k_{1}k_{s}}{k_{1} + k_{-1}}\n$$\nBoth eigenvalues are negative, indicating stability. The stiffness ratio $r$ is defined as the ratio of the magnitudes of these nonzero eigenvalues:\n$$\nr = \\frac{|\\lambda_{\\text{fast}}|}{|\\lambda_{\\text{slow}}|} \\approx \\frac{|-(k_{1} + k_{-1})|}{|-\\frac{k_{1}k_{s}}{k_{1} + k_{-1}}|} = \\frac{k_{1} + k_{-1}}{\\frac{k_{1}k_{s}}{k_{1} + k_{-1}}} = \\frac{(k_{1} + k_{-1})^{2}}{k_{1}k_{s}}\n$$\nThis completes the first part of the problem.\n\nFor the second part, we identify a slow variable $s(x) = \\alpha_{A}x_{A} + \\alpha_{B}x_{B} + \\alpha_{C}x_{C}$. This variable must be invariant under the fast reaction pair $A \\rightleftharpoons B$. The stoichiometric vector for this fast reaction is $\\nu_{\\text{fast}} = (-1, 1, 0)^{\\top}$, representing the net change in moles of $(A, B, C)$. Invariance implies that the coefficient vector $\\mathbf{\\alpha} = (\\alpha_{A}, \\alpha_{B}, \\alpha_{C})^{\\top}$ must be orthogonal to $\\nu_{\\text{fast}}$.\n$$\n\\mathbf{\\alpha} \\cdot \\nu_{\\text{fast}} = (\\alpha_{A}, \\alpha_{B}, \\alpha_{C}) \\cdot (-1, 1, 0) = -\\alpha_{A} + \\alpha_{B} = 0\n$$\nThis yields the condition $\\alpha_{A} = \\alpha_{B}$.\nThe time evolution of $s(x)$ is given by:\n$$\n\\frac{ds}{dt} = \\alpha_{A}\\frac{dx_{A}}{dt} + \\alpha_{B}\\frac{dx_{B}}{dt} + \\alpha_{C}\\frac{dx_{C}}{dt}\n$$\n$$\n\\frac{ds}{dt} = \\alpha_{A}(-k_{1}x_{A} + k_{-1}x_{B}) + \\alpha_{B}(k_{1}x_{A} - (k_{-1}+k_{s})x_{B}) + \\alpha_{C}(k_{s}x_{B})\n$$\n$$\n\\frac{ds}{dt} = (k_{1}x_{A} - k_{-1}x_{B})(\\alpha_{B} - \\alpha_{A}) - k_{s}x_{B}\\alpha_{B} + k_{s}x_{B}\\alpha_{C}\n$$\nApplying the condition $\\alpha_{A} = \\alpha_{B}$, the first term, which is proportional to the fast reaction flux, vanishes:\n$$\n\\frac{ds}{dt} = k_{s}x_{B}(\\alpha_{C} - \\alpha_{B})\n$$\nThe rate of change of $s(x)$ is proportional to the slow rate constant $k_{s}$, confirming that it is a slow variable. The problem specifies the coefficients $\\alpha_{A} = 1$, $\\alpha_{B} = 1$, and $\\alpha_{C} = 0$. This choice is consistent with the derived condition $\\alpha_{A} = \\alpha_{B}$.\nSubstituting these values, we obtain the explicit form of the slow variable:\n$$\ns(x) = (1)x_{A} + (1)x_{B} + (0)x_{C} = x_{A} + x_{B}\n$$\n\nThis variable represents the total concentration of the species involved in the fast equilibrium. Its dynamics, $\\frac{ds}{dt} = -k_{s}x_{B}$, show that this combined pool depletes slowly through the reaction to $C$.\n\nThe two required results are the stiffness ratio $r$ and the slow variable $s(x)$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{(k_{1} + k_{-1})^{2}}{k_{1}k_{s}} & x_{A} + x_{B} \\end{pmatrix}}\n$$", "id": "2649300"}, {"introduction": "Moving beyond conceptual identification, this exercise tasks you with constructing the mathematical operators—spectral projectors—that formally separate the state space into fast and slow subspaces. You will apply these projectors to a system's rate vector to compute the Intrinsic Low-Dimensional Manifold (ILDM) residual, a key diagnostic for determining if a given state lies on the slow manifold. This practice provides the essential computational tools for implementing and analyzing ILDM-based model reduction [@problem_id:2649302].", "problem": "Consider an isothermal, perfectly mixed, constant-volume open reactor with three chemical species $X_{1}$, $X_{2}$, and $X_{3}$. The reaction network consists of first-order conversions and first-order outflows:\n- $X_{1} \\to X_{2}$ with rate constant $k_{12} = 3\\,\\mathrm{s}^{-1}$,\n- $X_{2} \\to X_{3}$ with rate constant $k_{23} = 4\\,\\mathrm{s}^{-1}$,\n- Outflow $X_{1} \\to \\varnothing$ with rate constant $k_{1,\\mathrm{out}} = 7\\,\\mathrm{s}^{-1}$,\n- Outflow $X_{2} \\to \\varnothing$ with rate constant $k_{2,\\mathrm{out}} = 16\\,\\mathrm{s}^{-1}$,\n- Outflow $X_{3} \\to \\varnothing$ with rate constant $k_{3,\\mathrm{out}} = 1\\,\\mathrm{s}^{-1}$,\n- A constant source of $X_{1}$ at rate $s = 1\\,\\mathrm{mol\\,L^{-1}\\,s^{-1}}$.\n\nLet the concentration vector be $x = (x_{1},x_{2},x_{3})^{\\top}$ with $x_{i}$ in $\\mathrm{mol\\,L^{-1}}$. Under mass-action kinetics and perfect mixing, the governing ordinary differential equation is\n$$\n\\frac{dx}{dt} \\equiv f(x) \\;=\\; J\\,x \\;+\\; u,\n$$\nwith\n$$\nJ \\;=\\;\n\\begin{pmatrix}\n-(k_{1,\\mathrm{out}}+k_{12}) & 0 & 0\\\\\nk_{12} & -(k_{2,\\mathrm{out}}+k_{23}) & 0\\\\\n0 & k_{23} & -k_{3,\\mathrm{out}}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n-10 & 0 & 0\\\\\n3 & -20 & 0\\\\\n0 & 4 & -1\n\\end{pmatrix},\n\\qquad\nu \\;=\\; \\begin{pmatrix} s \\\\ 0 \\\\ 0 \\end{pmatrix} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\n\nAt the point $x^{\\ast} = (0.10,\\,0.050,\\,0.010)^{\\top}\\,\\mathrm{mol\\,L^{-1}}$, use the intrinsic low-dimensional manifold (ILDM) method with chosen slow dimension $d=1$ to construct the spectral projectors onto the slow and fast subspaces via the eigenstructure of the Jacobian $J$ at $x^{\\ast}$. Specifically:\n- Identify the slow eigenvalue (the one with smallest magnitude) and its corresponding right and left eigenvectors.\n- Normalize the left and right slow eigenvectors to enforce biorthogonality for the rank-$1$ slow projector.\n- Construct the slow projector $P_{s}$ and the fast projector $P_{f} = I - P_{s}$ at $x^{\\ast}$.\n- Evaluate the ILDM residual $P_{f}\\,f(x^{\\ast})$ and compute its Euclidean norm\n$$\nR \\;=\\; \\|P_{f}\\,f(x^{\\ast})\\|_{2}.\n$$\n\nProvide your final answer as a single exact expression for $R$. Express the value in $\\mathrm{mol\\,L^{-1}\\,s^{-1}}$. Do not include any units in your final boxed answer.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, objective, and complete.\n\n**Step 1: Extract Givens**\n- Chemical species: $X_{1}$, $X_{2}$, $X_{3}$.\n- Rate constants: $k_{12} = 3\\,\\mathrm{s}^{-1}$, $k_{23} = 4\\,\\mathrm{s}^{-1}$, $k_{1,\\mathrm{out}} = 7\\,\\mathrm{s}^{-1}$, $k_{2,\\mathrm{out}} = 16\\,\\mathrm{s}^{-1}$, $k_{3,\\mathrm{out}} = 1\\,\\mathrm{s}^{-1}$.\n- Source rate: $s = 1\\,\\mathrm{mol\\,L^{-1}\\,s^{-1}}$.\n- Concentration vector: $x = (x_{1}, x_{2}, x_{3})^{\\top}$.\n- Governing ODE: $\\frac{dx}{dt} \\equiv f(x) = J\\,x + u$.\n- Jacobian matrix: $J = \\begin{pmatrix} -10 & 0 & 0\\\\ 3 & -20 & 0\\\\ 0 & 4 & -1 \\end{pmatrix}$.\n- Source vector: $u = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$.\n- Point of evaluation: $x^{\\ast} = (0.10,\\,0.050,\\,0.010)^{\\top}\\,\\mathrm{mol\\,L^{-1}}$.\n- Task: Compute the Euclidean norm $R = \\|P_{f}\\,f(x^{\\ast})\\|_{2}$ of the ILDM residual, where $P_f$ is the projector onto the fast subspace corresponding to the single slow dimension ($d=1$).\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem describes a linear reaction network governed by mass-action kinetics, a standard and fundamental model in chemical kinetics. The Intrinsic Low-Dimensional Manifold (ILDM) method is a well-established technique for model order reduction in such systems. The formulation is correct.\n- **Well-Posedness and Completeness**: The problem is fully specified. All required matrices, vectors, constants, and the point of evaluation are provided. The objective is to compute a specific, uniquely defined quantity.\n- **Objectivity**: The problem is stated in precise, objective mathematical language.\n- **Conclusion**: The problem is valid. It is a standard application of the ILDM framework to a linear system.\n\n**Solution Derivation**\n\nThe objective is to compute the Euclidean norm of the ILDM residual, $R = \\|P_{f}\\,f(x^{\\ast})\\|_{2}$. This requires constructing the fast projector $P_f$ from the eigenstructure of the Jacobian matrix $J$.\n\nFirst, we determine the eigenvalues and eigenvectors of $J$. The matrix is\n$$\nJ = \\begin{pmatrix} -10 & 0 & 0\\\\ 3 & -20 & 0\\\\ 0 & 4 & -1 \\end{pmatrix}.\n$$\nSince $J$ is a lower triangular matrix, its eigenvalues are its diagonal entries: $\\lambda_{1} = -1$, $\\lambda_{2} = -10$, and $\\lambda_{3} = -20$.\n\nThe ILDM method separates timescales based on the magnitude of the eigenvalues. The \"slow\" subspace is associated with eigenvalues of small magnitude, while the \"fast\" subspace is associated with eigenvalues of large magnitude. For a slow dimension of $d=1$, we identify the single eigenvalue with the smallest magnitude.\nThe magnitudes are $|\\lambda_{1}| = 1$, $|\\lambda_{2}| = 10$, and $|\\lambda_{3}| = 20$. The smallest magnitude is $1$, so the slow eigenvalue is $\\lambda_{s} = \\lambda_{1} = -1$. The fast eigenvalues are $\\lambda_{f1} = -10$ and $\\lambda_{f2} = -20$.\n\nNext, we find the right and left eigenvectors corresponding to the slow eigenvalue $\\lambda_{s} = -1$.\nThe right eigenvector $v_{s}$ is found by solving $(J - \\lambda_{s}I)v_{s} = 0$:\n$$\n(J + I)v_{s} = \\begin{pmatrix} -10+1 & 0 & 0\\\\ 3 & -20+1 & 0\\\\ 0 & 4 & -1+1 \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\\\ c \\end{pmatrix} = \\begin{pmatrix} -9 & 0 & 0\\\\ 3 & -19 & 0\\\\ 0 & 4 & 0 \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\\\ c \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\nThe system of equations is $-9a=0$, $3a-19b=0$, and $4b=0$. This implies $a=0$ and $b=0$, while $c$ is arbitrary. We choose $c=1$, giving the right slow eigenvector:\n$$\nv_{s} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\nThe left eigenvector $w_{s}^{\\top}$ is found by solving $w_{s}^{\\top}(J - \\lambda_{s}I) = 0^{\\top}$:\n$$\nw_{s}^{\\top}(J + I) = \\begin{pmatrix} a & b & c \\end{pmatrix} \\begin{pmatrix} -9 & 0 & 0\\\\ 3 & -19 & 0\\\\ 0 & 4 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\end{pmatrix}.\n$$\nThis gives the equations $-9a + 3b = 0$ (so $b=3a$) and $-19b + 4c = 0$ (so $4c = 19b = 19(3a) = 57a$). Choosing $a=4$ to obtain integer components gives $b=12$ and $c=57$. Thus, a left slow eigenvector is:\n$$\nw_{s} = \\begin{pmatrix} 4 \\\\ 12 \\\\ 57 \\end{pmatrix}.\n$$\nFor the construction of the projector, the eigenvectors must be normalized to satisfy the biorthogonality condition $w_{s}^{\\top}v_{s}=1$. First, we compute the inner product:\n$$\nw_{s}^{\\top}v_{s} = \\begin{pmatrix} 4 & 12 & 57 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = 57.\n$$\nWe can rescale $w_s$ to $\\hat{w}_{s} = \\frac{1}{57} w_{s}$ and keep $v_s$ as $\\hat{v}_{s} = v_{s}$. Then $\\hat{w}_{s}^{\\top}\\hat{v}_{s}=1$.\nThe projector onto the slow subspace, $P_{s}$, is a rank-$1$ matrix given by $P_{s} = \\hat{v}_{s}\\hat{w}_{s}^{\\top}$:\n$$\nP_{s} = v_{s} (\\frac{1}{57}w_{s}^{\\top}) = \\frac{1}{57} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 4 & 12 & 57 \\end{pmatrix} = \\frac{1}{57} \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 4 & 12 & 57 \\end{pmatrix}.\n$$\nThe projector onto the fast subspace, $P_{f}$, is complementary to $P_{s}$: $P_{f} = I - P_{s}$.\n$$\nP_{f} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} - \\frac{1}{57} \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 4 & 12 & 57 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ -\\frac{4}{57} & -\\frac{12}{57} & 0 \\end{pmatrix}.\n$$\nNow, we evaluate the full rate vector $f(x)$ at the point $x^{\\ast} = (0.1, 0.05, 0.01)^{\\top} = (\\frac{1}{10}, \\frac{1}{20}, \\frac{1}{100})^{\\top}$.\n$$\nf(x^{\\ast}) = Jx^{\\ast} + u = \\begin{pmatrix} -10 & 0 & 0\\\\ 3 & -20 & 0\\\\ 0 & 4 & -1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{10} \\\\ \\frac{1}{20} \\\\ \\frac{1}{100} \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\n$$\nJx^{\\ast} = \\begin{pmatrix} -10(\\frac{1}{10}) \\\\ 3(\\frac{1}{10}) - 20(\\frac{1}{20}) \\\\ 4(\\frac{1}{20}) - 1(\\frac{1}{100}) \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ \\frac{3}{10} - 1 \\\\ \\frac{1}{5} - \\frac{1}{100} \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -\\frac{7}{10} \\\\ \\frac{19}{100} \\end{pmatrix}.\n$$\n$$\nf(x^{\\ast}) = \\begin{pmatrix} -1 \\\\ -\\frac{7}{10} \\\\ \\frac{19}{100} \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{7}{10} \\\\ \\frac{19}{100} \\end{pmatrix}.\n$$\nThe ILDM residual is the projection of this vector onto the fast subspace, $P_{f}f(x^{\\ast})$:\n$$\nP_{f}f(x^{\\ast}) = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ -\\frac{4}{57} & -\\frac{12}{57} & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -\\frac{7}{10} \\\\ \\frac{19}{100} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{7}{10} \\\\ (-\\frac{12}{57})(-\\frac{7}{10}) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{7}{10} \\\\ \\frac{84}{570} \\end{pmatrix}.\n$$\nThe fraction $\\frac{84}{570}$ can be simplified: $\\frac{84}{570} = \\frac{3 \\times 28}{3 \\times 190} = \\frac{28}{190} = \\frac{14}{95}$.\nSo, the residual vector is:\n$$\nP_{f}f(x^{\\ast}) = \\begin{pmatrix} 0 \\\\ -\\frac{7}{10} \\\\ \\frac{14}{95} \\end{pmatrix}.\n$$\nFinally, we compute its Euclidean norm, $R$:\n$$\nR = \\|P_{f}f(x^{\\ast})\\|_{2} = \\sqrt{0^{2} + \\left(-\\frac{7}{10}\\right)^{2} + \\left(\\frac{14}{95}\\right)^{2}} = \\sqrt{\\frac{49}{100} + \\frac{196}{95^{2}}}.\n$$\nTo simplify, we factor out common terms:\n$$\nR^{2} = \\frac{49}{100} + \\frac{4 \\times 49}{(5 \\times 19)^{2}} = 49\\left(\\frac{1}{100} + \\frac{4}{9025}\\right) = 49\\left(\\frac{1}{4 \\times 25} + \\frac{4}{361 \\times 25}\\right).\n$$\n$$\nR^{2} = \\frac{49}{25}\\left(\\frac{1}{4} + \\frac{4}{361}\\right) = \\frac{49}{25}\\left(\\frac{361 + 16}{4 \\times 361}\\right) = \\frac{49}{25}\\left(\\frac{377}{1444}\\right).\n$$\nTaking the square root:\n$$\nR = \\sqrt{\\frac{49 \\times 377}{25 \\times 1444}} = \\frac{\\sqrt{49}\\sqrt{377}}{\\sqrt{25}\\sqrt{1444}} = \\frac{7\\sqrt{377}}{5 \\times 38} = \\frac{7\\sqrt{377}}{190}.\n$$\nThe number $377 = 13 \\times 29$, so $\\sqrt{377}$ cannot be simplified further.", "answer": "$$\\boxed{\\frac{7\\sqrt{377}}{190}}$$", "id": "2649302"}, {"introduction": "In realistic, complex systems, the number of slow variables is not always known a priori. This practice introduces an algorithmic approach to determine the dimension of the slow manifold by analyzing the gaps in the spectrum of the system's local Jacobian matrix. By implementing a routine to compute local spectral gap ratios, you will learn a robust, data-driven method for making one of the most critical decisions in model reduction: choosing the dimension of the simplified model [@problem_id:2649282].", "problem": "You are given a reversible, multi-step mass-action chemical reaction network with three species $A$, $B$, and $C$, and six elementary reactions:\n- $R_{1,f}$: $A + B \\rightarrow C$, with rate $v_{1,f} = k_{1,f}\\,A\\,B$,\n- $R_{1,b}$: $C \\rightarrow A + B$, with rate $v_{1,b} = k_{1,b}\\,C$,\n- $R_{2,f}$: $C \\rightarrow B$, with rate $v_{2,f} = k_{2,f}\\,C$,\n- $R_{2,b}$: $B \\rightarrow C$, with rate $v_{2,b} = k_{2,b}\\,B$,\n- $R_{3,f}$: $B \\rightarrow A$, with rate $v_{3,f} = k_{3,f}\\,B$,\n- $R_{3,b}$: $A \\rightarrow B$, with rate $v_{3,b} = k_{3,b}\\,A$.\n\nAssume mass-action kinetics and let $x = [A,B,C]^\\top \\in \\mathbb{R}_{\\ge 0}^3$ denote the concentration vector. Let $S \\in \\mathbb{R}^{3 \\times 6}$ be the stoichiometric matrix whose columns are the stoichiometric change vectors for each reaction in the order $(R_{1,f}, R_{1,b}, R_{2,f}, R_{2,b}, R_{3,f}, R_{3,b})$:\n- $R_{1,f}$: $[-1,-1,+1]^\\top$,\n- $R_{1,b}$: $[+1,+1,-1]^\\top$,\n- $R_{2,f}$: $[0,+1,-1]^\\top$,\n- $R_{2,b}$: $[0,-1,+1]^\\top$,\n- $R_{3,f}$: $[+1,-1,0]^\\top$,\n- $R_{3,b}$: $[-1,+1,0]^\\top$.\n\nThe ordinary differential equation is $\\dot{x} = S\\,v(x)$, where $v(x) \\in \\mathbb{R}^6$ collects the reaction rates defined above. The Jacobian matrix at state $x$ is $J(x) = \\frac{\\partial}{\\partial x}\\left(S\\,v(x)\\right) = \\sum_{j=1}^{6} S_{\\cdot j}\\,\\nabla v_j(x)^\\top$, where $S_{\\cdot j}$ denotes the $j$-th column of $S$.\n\nYou will work with the following known parameter values:\n- $k_{1,f} = 50.0$, $k_{1,b} = 10.0$,\n- $k_{2,f} = 20.0$, $k_{2,b} = 5.0$,\n- $k_{3,f} = 1.0$, $k_{3,b} = 0.2$.\n\nAt a given state $x$, let $\\{\\lambda_i(x)\\}_{i=1}^{3}$ be the eigenvalues of $J(x)$. Define the modal speeds $\\sigma_i(x) = \\max\\{0,\\,-\\operatorname{Re}(\\lambda_i(x))\\}$ for $i \\in \\{1,2,3\\}$. Consider the sorted speeds $\\sigma_{(1)}(x) \\ge \\sigma_{(2)}(x) \\ge \\sigma_{(3)}(x) \\ge 0$ and, for numerical stability, fix $\\varepsilon = 10^{-12}$. Define the adjacent spectral gap ratios\n$$\n\\rho_i(x) = \\frac{\\sigma_{(i)}(x)}{\\sigma_{(i+1)}(x) + \\varepsilon}, \\quad i \\in \\{1,2\\}.\n$$\nLet $g(x) \\in \\{1,2\\}$ be the index $i$ that maximizes $\\rho_i(x)$, with the tie broken by choosing the smallest such index. Interpret $g(x)$ as the number of fast modes, and define the slow subspace dimension as $d(x) = 3 - g(x)$. The corresponding local spectral gap value is $\\rho_{g(x)}(x)$.\n\nYour task is to implement a program that, for each specified test state $x$, computes:\n- the local spectral gap ratio $\\rho_{g(x)}(x)$, and\n- the selected slow subspace dimension $d(x)$.\n\nReport the ratio rounded to $6$ decimal places.\n\nTest suite (states $x = [A,B,C]$):\n- $x_1 = [0.1,\\,2.0,\\,0.1]$,\n- $x_2 = [2.0,\\,0.1,\\,0.1]$,\n- $x_3 = [1.0,\\,1.0,\\,1.0]$,\n- $x_4 = [10^{-6},\\,10^{-6},\\,2.0]$,\n- $x_5 = [5.0,\\,5.0,\\,0.1]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test state in the same order and is itself a two-element list $[\\rho_{g(x)}, d(x)]$ with the ratio rounded to $6$ decimal places. For example, the printed output must have the form\n\"[[r_1,d_1],[r_2,d_2],[r_3,d_3],[r_4,d_4],[r_5,d_5]]\"\nwith no additional text.\n\nAll outputs are dimensionless real numbers or integers, so no physical unit specification is required. Angles are not involved. Ensure numerical stability and reproducibility by following the definitions exactly as given, including the use of $\\varepsilon = 10^{-12}$ in the ratio definitions.", "solution": "The problem statement has been subjected to rigorous validation and is found to be scientifically sound and mathematically well-posed. It is grounded in the standard principles of chemical kinetics and dynamical systems theory, specifically the analysis of time-scale separation via the spectral properties of the system's Jacobian matrix. All definitions, parameters, and conditions are provided, allowing for a unique and verifiable solution. We may therefore proceed with the derivation of the solution.\n\nThe core of the problem is the analysis of the local dynamics of the given chemical reaction network, which is governed by the ordinary differential equation (ODE) system $\\dot{x} = S\\,v(x)$, where $x = [A, B, C]^\\top$ is the vector of species concentrations. The local stability and time scales are determined by the eigenvalues of the Jacobian matrix, $J(x)$.\n\nFirst, we must derive the analytical form of the Jacobian matrix, $J(x) = \\frac{\\partial (S\\,v)}{\\partial x}$. The rate vector is given by $v(x) = [k_{1,f}AB, k_{1,b}C, k_{2,f}C, k_{2,b}B, k_{3,f}B, k_{3,b}A]^\\top$. The ODE system for the concentrations is:\n$$\n\\dot{A} = -k_{1,f}AB + k_{1,b}C + k_{3,f}B - k_{3,b}A\n$$\n$$\n\\dot{B} = -k_{1,f}AB + k_{1,b}C + k_{2,f}C - k_{2,b}B - k_{3,f}B + k_{3,b}A\n$$\n$$\n\\dot{C} = k_{1,f}AB - k_{1,b}C - k_{2,f}C + k_{2,b}B\n$$\nThe Jacobian matrix $J(x)$ is the matrix of partial derivatives of the vector field $[\\dot{A}, \\dot{B}, \\dot{C}]^\\top$ with respect to the state variables $[A, B, C]$. Its elements $J_{ij}(x) = \\frac{\\partial \\dot{x}_i}{\\partial x_j}$ are:\n$$\nJ(x) =\n\\begin{pmatrix}\n\\frac{\\partial \\dot{A}}{\\partial A} & \\frac{\\partial \\dot{A}}{\\partial B} & \\frac{\\partial \\dot{A}}{\\partial C} \\\\\n\\frac{\\partial \\dot{B}}{\\partial A} & \\frac{\\partial \\dot{B}}{\\partial B} & \\frac{\\partial \\dot{B}}{\\partial C} \\\\\n\\frac{\\partial \\dot{C}}{\\partial A} & \\frac{\\partial \\dot{C}}{\\partial B} & \\frac{\\partial \\dot{C}}{\\partial C}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-k_{1,f}B - k_{3,b} & -k_{1,f}A + k_{3,f} & k_{1,b} \\\\\n-k_{1,f}B + k_{3,b} & -k_{1,f}A - k_{2,b} - k_{3,f} & k_{1,b} + k_{2,f} \\\\\nk_{1,f}B & k_{1,f}A + k_{2,b} & -k_{1,b} - k_{2,f}\n\\end{pmatrix}\n$$\nThe computational procedure for each test state $x$ is as follows:\n\n1.  Substitute the given component values of $x = [A, B, C]^\\top$ and the specified rate constants $k_{1,f} = 50.0$, $k_{1,b} = 10.0$, $k_{2,f} = 20.0$, $k_{2,b} = 5.0$, $k_{3,f} = 1.0$, and $k_{3,b} = 0.2$ into the analytical expression for $J(x)$ to obtain a numerical $3 \\times 3$ matrix.\n\n2.  Compute the three eigenvalues of the resulting matrix $J(x)$, which we denote as $\\{\\lambda_i(x)\\}_{i=1}^{3}$. These eigenvalues may be complex.\n\n3.  Calculate the modal speeds $\\sigma_i(x)$ associated with each eigenvalue. The speed is defined as the non-negative part of the rate of decay, $\\sigma_i(x) = \\max\\{0, -\\operatorname{Re}(\\lambda_i(x))\\}$. For stable modes where $\\operatorname{Re}(\\lambda_i(x)) \\le 0$, this simplifies to $\\sigma_i(x) = -\\operatorname{Re}(\\lambda_i(x))$.\n\n4.  Sort these speeds in descending order to obtain the ordered speeds $\\sigma_{(1)}(x) \\ge \\sigma_{(2)}(x) \\ge \\sigma_{(3)}(x)$.\n\n5.  Calculate the adjacent spectral gap ratios using the provided formula, which includes a small regularization parameter $\\varepsilon = 10^{-12}$ to ensure numerical stability:\n    $$\n    \\rho_1(x) = \\frac{\\sigma_{(1)}(x)}{\\sigma_{(2)}(x) + \\varepsilon}\n    $$\n    $$\n    \\rho_2(x) = \\frac{\\sigma_{(2)}(x)}{\\sigma_{(3)}(x) + \\varepsilon}\n    $$\n\n6.  Identify the index $g(x)$ that corresponds to the largest spectral gap. This index is defined as $g(x) = \\arg\\max_{i \\in \\{1,2\\}} \\rho_i(x)$. The problem specifies that ties are broken by choosing the smaller index, so we find $g(x) = 1$ if $\\rho_1(x) \\ge \\rho_2(x)$, and $g(x) = 2$ otherwise.\n\n7.  The dimension of the slow subspace, $d(x)$, is then determined by the number of fast modes, $g(x)$: $d(x) = 3 - g(x)$.\n\n8.  The final quantities to be reported for the state $x$ are the value of the largest spectral gap, $\\rho_{g(x)}(x)$, and the dimension of the slow subspace, $d(x)$.\n\nThis entire algorithm is implemented and applied to each of the five specified test states. The resulting values of the spectral gap ratio are rounded to $6$ decimal places as required. The program in the final answer section automates this procedure.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the chemical kinetics problem by calculating the local spectral gap ratio\n    and slow subspace dimension for a set of test states, faithfully implementing\n    the algorithm described in the problem statement.\n    \"\"\"\n\n    # Define the rate constants from the problem statement.\n    k_params = {\n        'k1f': 50.0, 'k1b': 10.0,\n        'k2f': 20.0, 'k2b': 5.0,\n        'k3f': 1.0,  'k3b': 0.2\n    }\n    \n    # Define the numerical stability constant.\n    epsilon = 1e-12\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        [0.1, 2.0, 0.1],\n        [2.0, 0.1, 0.1],\n        [1.0, 1.0, 1.0],\n        [1e-6, 1e-6, 2.0],\n        [5.0, 5.0, 0.1]\n    ]\n\n    results = []\n    \n    for state_vector in test_cases:\n        A, B, C = state_vector\n        k = k_params\n\n        # Construct the Jacobian matrix J(x)\n        J = np.array([\n            [-k['k1f'] * B - k['k3b'],           -k['k1f'] * A + k['k3f'],          k['k1b']],\n            [-k['k1f'] * B + k['k3b'],           -k['k1f'] * A - k['k2b'] - k['k3f'], k['k1b'] + k['k2f']],\n            [k['k1f'] * B,                      k['k1f'] * A + k['k2b'],           -k['k1b'] - k['k2f']]\n        ])\n\n        # Compute eigenvalues of the Jacobian\n        eigenvalues = np.linalg.eigvals(J)\n\n        # Compute modal speeds sigma_i = max(0, -Re(lambda_i))\n        modal_speeds = np.maximum(0, -np.real(eigenvalues))\n\n        # Sort speeds in descending order\n        sorted_speeds = np.sort(modal_speeds)[::-1]\n        \n        s1, s2, s3 = sorted_speeds[0], sorted_speeds[1], sorted_speeds[2]\n\n        # Calculate adjacent spectral gap ratios\n        rho1 = s1 / (s2 + epsilon)\n        rho2 = s2 / (s3 + epsilon)\n\n        # Determine g(x), the index of the largest gap, and d(x), the slow dimension\n        if rho1 >= rho2: # Tie-breaking rule: choose smallest index\n            g_x = 1\n            rho_gx = rho1\n        else:\n            g_x = 2\n            rho_gx = rho2\n            \n        d_x = 3 - g_x\n\n        # Append the required results for this case\n        results.append([rho_gx, d_x])\n\n    # Format the final output string as specified\n    # The format \"[{r:.6f},{d}]\" ensures rounding to 6 decimal places\n    inner_parts = [f\"[{r:.6f},{d}]\" for r, d in results]\n    final_output = f\"[{','.join(inner_parts)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2649282"}]}