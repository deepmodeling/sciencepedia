{"hands_on_practices": [{"introduction": "This first practice establishes the foundational skill for determining an empirical formula from elemental mass composition. By converting mass percentages into molar quantities and normalizing them, you will apply the law of definite proportions to find the simplest whole-number ratio of atoms in a compound. Mastering this core stoichiometric calculation is the essential first step toward interpreting analytical data [@problem_id:2937627].", "problem": "An anhydrous organic compound composed solely of carbon, hydrogen, and oxygen was analyzed to give the following mass composition: carbon $54.528\\,\\%$, hydrogen $9.150\\,\\%$, and oxygen $36.322\\,\\%$. Using only the concept of the mole, the law of definite proportions, and standard atomic weights, determine the empirical formula of the compound. For numerical convenience, adopt a sample basis of $100.0\\,\\mathrm{g}$. Report your result as the ordered triple $(n_{\\mathrm{C}}, n_{\\mathrm{H}}, n_{\\mathrm{O}})$ in the order carbon, hydrogen, oxygen, where each $n$ is the smallest set of whole-number subscripts consistent with the data. Do not include units in your reported triple. If minor rounding is warranted by the data, justify it by reference to stoichiometric integer ratios. The final reported triple should consist of exact integers (no rounding specification in significant figures is needed because the final result is integral).", "solution": "The problem is subjected to validation.\n\n**Givens:**\n- An anhydrous organic compound is composed of Carbon (C), Hydrogen (H), and Oxygen (O).\n- Mass composition: Carbon $54.528\\,\\%$, Hydrogen $9.150\\,\\%$, Oxygen $36.322\\,\\%$.\n- A sample basis of $100.0\\,\\mathrm{g}$ is to be used for calculation.\n- The task is to determine the empirical formula, represented as the smallest set of whole-number subscripts $(n_{\\mathrm{C}}, n_{\\mathrm{H}}, n_{\\mathrm{O}})$.\n\n**Validation:**\nThe problem is a standard exercise in general chemistry, requiring the determination of an empirical formula from mass percent composition. It is a valid problem for the following reasons:\n1.  **Scientifically Grounded:** The procedure is based on fundamental principles of chemistry, namely the mole concept and the law of definite proportions.\n2.  **Well-Posed and Consistent:** The problem provides all necessary data. The mass percentages sum to $54.528\\,\\% + 9.150\\,\\% + 36.322\\,\\% = 100.000\\,\\%$, ensuring the data is self-consistent. The objective is clearly stated, and the path to a unique solution is well-defined.\n3.  **Objective:** The problem is stated in precise, quantitative terms, free from any subjectivity or ambiguity.\n\nThe problem is therefore deemed **valid**, and a solution will be constructed.\n\nThe empirical formula of a compound represents the simplest whole-number ratio of the amounts of substance (moles) of each constituent element. The procedure is to convert the given mass percentages into masses, then masses into moles, and finally to determine the simplest integer ratio of these molar amounts.\n\nFollowing the instruction, we assume a sample of mass $100.0\\,\\mathrm{g}$. The mass of each element in this sample is numerically equal to its percentage.\nMass of Carbon, $m_{\\mathrm{C}} = 100.0\\,\\mathrm{g} \\times \\frac{54.528}{100} = 54.528\\,\\mathrm{g}$.\nMass of Hydrogen, $m_{\\mathrm{H}} = 100.0\\,\\mathrm{g} \\times \\frac{9.150}{100} = 9.150\\,\\mathrm{g}$.\nMass of Oxygen, $m_{\\mathrm{O}} = 100.0\\,\\mathrm{g} \\times \\frac{36.322}{100} = 36.322\\,\\mathrm{g}$.\n\nThe amount of substance, $n$, for each element is found by dividing its mass, $m$, by its standard atomic weight (molar mass), $M$. The standard atomic weights are taken as:\nMolar mass of Carbon, $M_{\\mathrm{C}} = 12.011\\,\\mathrm{g/mol}$.\nMolar mass of Hydrogen, $M_{\\mathrm{H}} = 1.008\\,\\mathrm{g/mol}$.\nMolar mass of Oxygen, $M_{\\mathrm{O}} = 15.999\\,\\mathrm{g/mol}$.\n\nThe calculation for the moles of each element is as follows:\nAmount of Carbon, $n_{\\mathrm{C}} = \\frac{m_{\\mathrm{C}}}{M_{\\mathrm{C}}} = \\frac{54.528\\,\\mathrm{g}}{12.011\\,\\mathrm{g/mol}} \\approx 4.5398\\,\\mathrm{mol}$.\nAmount of Hydrogen, $n_{\\mathrm{H}} = \\frac{m_{\\mathrm{H}}}{M_{\\mathrm{H}}} = \\frac{9.150\\,\\mathrm{g}}{1.008\\,\\mathrm{g/mol}} \\approx 9.0774\\,\\mathrm{mol}$.\nAmount of Oxygen, $n_{\\mathrm{O}} = \\frac{m_{\\mathrm{O}}}{M_{\\mathrm{O}}} = \\frac{36.322\\,\\mathrm{g}}{15.999\\,\\mathrm{g/mol}} \\approx 2.2702\\,\\mathrm{mol}$.\n\nTo determine the simplest molar ratio, we divide the amount of each element by the smallest calculated amount, which is $n_{\\mathrm{O}} \\approx 2.2702\\,\\mathrm{mol}$.\n\nRatio for Carbon: $\\frac{n_{\\mathrm{C}}}{n_{\\mathrm{O}}} = \\frac{4.5398}{2.2702} \\approx 1.9997$\nRatio for Hydrogen: $\\frac{n_{\\mathrm{H}}}{n_{\\mathrm{O}}} = \\frac{9.0774}{2.2702} \\approx 3.9985$\nRatio for Oxygen: $\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{O}}} = \\frac{2.2702}{2.2702} = 1.0000$\n\nThe calculated molar ratios are approximately $1.9997 : 3.9985 : 1.0000$. The deviations of the first two ratios from the integers $2$ and $4$ are exceedingly small (less than $0.02\\,\\%$). Such minor discrepancies are expected and are attributed to the inherent experimental uncertainty in the elemental analysis from which the mass percentages are derived. Therefore, rounding to the nearest integer is scientifically justified to obtain the stoichiometric whole-number ratio.\n\nThe simplest whole-number ratio of moles of C:H:O is $2:4:1$. This corresponds to the empirical formula $\\mathrm{C_2H_4O}$.\n\nThe problem requires the answer as an ordered triple of integer subscripts $(n_{\\mathrm{C}}, n_{\\mathrm{H}}, n_{\\mathrm{O}})$. This triple is $(2, 4, 1)$.", "answer": "$$\\boxed{\\begin{pmatrix} 2 & 4 & 1 \\end{pmatrix}}$$", "id": "2937627"}, {"introduction": "This exercise moves from idealized data to a more realistic analytical scenario, tackling the common practice of determining oxygen content \"by difference.\" This practice challenges you not only to derive an empirical formula but also to critically evaluate the quality of the data. By quantifying the impact of a hypothetical systematic error, you will explore how experimental assumptions can introduce bias into your results, a crucial consideration for any experimental scientist [@problem_id:2937650].", "problem": "An elemental analysis is conducted on a pure organic compound known to contain only carbon, hydrogen, and oxygen. The laboratory directly measures the mass fractions of carbon and hydrogen and reports oxygen \"by difference,\" defined operationally as the remainder needed to sum to $100\\,\\%$ of the sample mass based on conservation of mass. The reported results are: carbon $59.983\\,\\%$, hydrogen $4.475\\,\\%$, and oxygen (by difference) $35.542\\,\\%$. Use the following standard atomic weights: $M_{\\mathrm{C}} = 12.011\\,\\mathrm{g\\,mol^{-1}}$, $M_{\\mathrm{H}} = 1.008\\,\\mathrm{g\\,mol^{-1}}$, and $M_{\\mathrm{O}} = 15.999\\,\\mathrm{g\\,mol^{-1}}$.\n\nUsing only the law of conservation of mass and the definitions of mass fraction, mole, and empirical formula:\n- Compute and justify the empirical formula implied by the reported data by converting mass fractions to amounts in moles and reducing to the smallest whole-number ratio.\n- Then, suppose the oxygen-by-difference value is systematically overestimated by $1.000$ mass percentage point for this compound class, while the directly measured carbon and hydrogen values are unbiased. Keeping the reported carbon mass fraction fixed, quantify the relative bias (as a decimal fraction) in the oxygen-to-carbon atomic ratio when computed from the reported oxygen percentage compared to the corrected oxygen percentage. Specifically, compute \n$$\\left(\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}}\\right)_{\\text{reported}} \\Big/ \\left(\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}}\\right)_{\\text{corrected}} - 1,$$ \nand express your final numerical result as a decimal rounded to four significant figures. No units are required for the final result.", "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extract Givens.\nThe problem provides the following data and definitions for a pure organic compound containing only Carbon (C), Hydrogen (H), and Oxygen (O):\n- Reported mass fraction of Carbon: $w_{\\mathrm{C, rep}} = 59.983\\,\\% = 0.59983$\n- Reported mass fraction of Hydrogen: $w_{\\mathrm{H, rep}} = 4.475\\,\\% = 0.04475$\n- Reported mass fraction of Oxygen: $w_{\\mathrm{O, rep}} = 35.542\\,\\% = 0.35542$\n- The oxygen mass fraction is determined \"by difference,\" such that the sum of the reported mass fractions is $100\\,\\%$. Indeed, $59.983 + 4.475 + 35.542 = 100.000$.\n- Standard atomic weight of Carbon: $M_{\\mathrm{C}} = 12.011\\,\\mathrm{g\\,mol^{-1}}$\n- Standard atomic weight of Hydrogen: $M_{\\mathrm{H}} = 1.008\\,\\mathrm{g\\,mol^{-1}}$\n- Standard atomic weight of Oxygen: $M_{\\mathrm{O}} = 15.999\\,\\mathrm{g\\,mol^{-1}}$\n\nThe problem is divided into two tasks:\n1.  Determine the empirical formula based on the reported data.\n2.  Calculate the relative bias in the oxygen-to-carbon atomic ratio, defined as $\\left(\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}}\\right)_{\\text{reported}} \\Big/ \\left(\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}}\\right)_{\\text{corrected}} - 1$.\nFor the second task, a hypothetical \"corrected\" state is defined by these rules:\n- The oxygen mass fraction is corrected by subtracting $1.000$ percentage point: $w_{\\mathrm{O, corrected}} = w_{\\mathrm{O, reported}} - 0.01000$.\n- The carbon mass fraction is kept fixed: $w_{\\mathrm{C, corrected}} = w_{\\mathrm{C, reported}}$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded in the principles of stoichiometry and elemental analysis. The first task is a standard exercise in general chemistry. The second task introduces a hypothetical scenario for the purpose of a calculation. The rules for defining the \"corrected\" state ($w_{\\mathrm{O, corrected}} = w_{\\mathrm{O, rep}} - 0.01$ and $w_{\\mathrm{C, corrected}} = w_{\\mathrm{C, rep}}$) are physically inconsistent if one also assumes the hydrogen mass fraction is fixed and that all mass fractions must sum to $1$, as this would violate the law of conservation of mass. However, the problem does not claim this \"corrected\" state represents a physical reality. It poses a well-defined calculation comparing a result from reported data to a result from a hypothetical data set. The instructions are clear, unambiguous, and contain all necessary information. The problem is not ill-posed; it is a formal exercise in calculating error propagation under specified, albeit artificial, conditions.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid. A complete solution will be provided.\n\nPart 1: Determination of the Empirical Formula.\nTo find the empirical formula, we convert the mass fractions of the elements into molar ratios. We can assume a sample mass of $100\\,\\mathrm{g}$ without loss of generality. The masses of the elements are then numerically equal to their percentages.\n- Mass of Carbon, $m_{\\mathrm{C}} = 59.983\\,\\mathrm{g}$\n- Mass of Hydrogen, $m_{\\mathrm{H}} = 4.475\\,\\mathrm{g}$\n- Mass of Oxygen, $m_{\\mathrm{O}} = 35.542\\,\\mathrm{g}$\n\nNext, we calculate the amount in moles ($n$) for each element using the formula $n = \\frac{m}{M}$, where $M$ is the molar mass (given as atomic weight).\n- Moles of Carbon: $n_{\\mathrm{C}} = \\frac{59.983\\,\\mathrm{g}}{12.011\\,\\mathrm{g\\,mol^{-1}}} \\approx 4.9940\\,\\mathrm{mol}$\n- Moles of Hydrogen: $n_{\\mathrm{H}} = \\frac{4.475\\,\\mathrm{g}}{1.008\\,\\mathrm{g\\,mol^{-1}}} \\approx 4.4395\\,\\mathrm{mol}$\n- Moles of Oxygen: $n_{\\mathrm{O}} = \\frac{35.542\\,\\mathrm{g}}{15.999\\,\\mathrm{g\\,mol^{-1}}} \\approx 2.2215\\,\\mathrm{mol}$\n\nTo find the simplest whole-number ratio, we divide the mole amounts by the smallest value, which is $n_{\\mathrm{O}}$.\n- Ratio for C: $\\frac{n_{\\mathrm{C}}}{n_{\\mathrm{O}}} = \\frac{4.9940}{2.2215} \\approx 2.248$\n- Ratio for H: $\\frac{n_{\\mathrm{H}}}{n_{\\mathrm{O}}} = \\frac{4.4395}{2.2215} \\approx 1.998$\n- Ratio for O: $\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{O}}} = 1$\n\nThe resulting ratios are approximately $2.25$ for C, $2.00$ for H, and $1.00$ for O. To convert these to integers, we must multiply all values by the smallest integer that clears the fraction. Here, $2.25 = \\frac{9}{4}$, so we multiply by $4$.\n- C: $2.25 \\times 4 = 9$\n- H: $2.00 \\times 4 = 8$\n- O: $1.00 \\times 4 = 4$\n\nThe empirical formula is therefore $\\mathrm{C_9H_8O_4}$.\n\nPart 2: Calculation of Relative Bias.\nThe relative bias, $B$, is defined as:\n$$B = \\frac{\\left(\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}}\\right)_{\\text{reported}}}{\\left(\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}}\\right)_{\\text{corrected}}} - 1$$\nThe ratio of moles of oxygen to moles of carbon, $\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}}$, can be expressed in terms of mass fractions ($w$) and molar masses ($M$):\n$$\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}} = \\frac{w_{\\mathrm{O}}/M_{\\mathrm{O}}}{w_{\\mathrm{C}}/M_{\\mathrm{C}}} = \\frac{w_{\\mathrm{O}}}{w_{\\mathrm{C}}} \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{O}}}$$\nSubstituting this into the expression for bias $B$:\n$$B = \\frac{\\left(\\frac{w_{\\mathrm{O, rep}}}{w_{\\mathrm{C, rep}}}\\right) \\left(\\frac{M_{\\mathrm{C}}}{M_{\\mathrm{O}}}\\right)}{\\left(\\frac{w_{\\mathrm{O, corr}}}{w_{\\mathrm{C, corr}}}\\right) \\left(\\frac{M_{\\mathrm{C}}}{M_{\\mathrm{O}}}\\right)} - 1$$\nThe term $\\frac{M_{\\mathrm{C}}}{M_{\\mathrm{O}}}$ cancels out. The problem specifies that for this calculation, we must keep the carbon mass fraction fixed, meaning $w_{\\mathrm{C, corrected}} = w_{\\mathrm{C, reported}}$. This term also cancels. The expression for the bias simplifies considerably:\n$$B = \\frac{w_{\\mathrm{O, rep}}}{w_{\\mathrm{C, rep}}} \\frac{w_{\\mathrm{C, corr}}}{w_{\\mathrm{O, corr}}} - 1 = \\frac{w_{\\mathrm{O, rep}}}{w_{\\mathrm{O, corr}}} - 1$$\nThe problem states that the corrected oxygen mass fraction is obtained by subtracting $1.000$ percentage point ($0.01000$) from the reported value.\n- $w_{\\mathrm{O, reported}} = 0.35542$\n- $w_{\\mathrm{O, corrected}} = w_{\\mathrm{O, reported}} - 0.01000 = 0.35542 - 0.01000 = 0.34542$\n\nNow we substitute these values into the simplified bias equation:\n$$B = \\frac{0.35542}{0.34542} - 1$$\nPerforming the calculation:\n$$B \\approx 1.02895026 - 1 = 0.02895026$$\nThe problem requires the result as a decimal rounded to four significant figures. The first four significant figures are $2$, $8$, $9$, and $5$. The digit following the fifth is $0$, so no rounding up is necessary.\n$$B \\approx 0.02895$$\nThis is the required relative bias.", "answer": "$$\\boxed{0.02895}$$", "id": "2937650"}, {"introduction": "In modern analytical chemistry, high-resolution mass spectrometry provides highly precise mass data, which, when combined with other constraints, can pinpoint a unique molecular formula. This advanced computational practice requires you to develop an algorithm that searches for candidate formulas satisfying simultaneous constraints on exact mass, double bond equivalents (DBE), and elemental composition. This exercise mirrors the sophisticated software-driven approaches used in contemporary research to unambiguously identify unknown compounds from complex analytical data [@problem_id:2937652].", "problem": "Implement a program that performs an exhaustive but bounded search over integer atom counts for the elements $\\{C,H,N,O,S,Cl\\}$ to determine all molecular formulas that satisfy simultaneous constraints on exact monoisotopic mass, double bond equivalents (DBE), and elemental mass fractions. Your program must start from fundamental definitions and well-tested formulas:\n\n- Exact monoisotopic mass: For a candidate integer atom count vector $\\mathbf{n} = [n_C,n_H,n_N,n_O,n_S,n_{Cl}]$, the exact mass $m(\\mathbf{n})$ is the sum of element-wise products of counts with their monoisotopic masses. Use the following monoisotopic masses (in unified atomic mass units, also called daltons): $m_C = 12.00000000000$, $m_H = 1.00782503223$, $m_N = 14.00307400443$, $m_O = 15.99491461957$, $m_S = 31.97207117440$, $m_{Cl} = 34.96885268200$.\n- Double bond equivalent (DBE): For a candidate formula $\\mathbf{n}$, compute the hydrogen-deficiency-based DBE as\n$$\\mathrm{DBE}(\\mathbf{n}) = \\frac{2\\,n_C + 2 + n_N - n_H - n_{X}}{2},$$\nwhere $n_X$ is the total count of monovalent halogens. In this problem, $n_X = n_{Cl}$. Chemically valid solutions must satisfy that $\\mathrm{DBE}(\\mathbf{n})$ is a non-negative integer.\n- Elemental mass fraction for an element $E$ is defined as $w_E(\\mathbf{n}) = \\frac{n_E\\,m_E}{m(\\mathbf{n})}$. The fractions must be compared to case-specific closed intervals. All fractions must be expressed as decimals (not with a percentage sign).\n\nYour program must:\n\n1. Enumerate all $\\mathbf{n}$ with each $n_E$ constrained to case-specific integer bounds $0 \\le n_E \\le n_E^{\\max}$.\n2. For each $\\mathbf{n}$, compute $m(\\mathbf{n})$, $\\mathrm{DBE}(\\mathbf{n})$, and $w_E(\\mathbf{n})$ for all elements $E \\in \\{C,H,N,O,S,Cl\\}$.\n3. Accept $\\mathbf{n}$ as a solution for a test case if and only if all of the following hold simultaneously:\n   - The exact mass is within the specified absolute tolerance: $|m(\\mathbf{n}) - m_{\\mathrm{target}}| \\le \\Delta m$ where both $m_{\\mathrm{target}}$ and $\\Delta m$ are provided.\n   - The DBE lies within the inclusive integer range $[\\mathrm{DBE}_{\\min}, \\mathrm{DBE}_{\\max}]$ and is an integer.\n   - For every element $E$, the elemental mass fraction satisfies $w_E^{\\min} \\le w_E(\\mathbf{n}) \\le w_E^{\\max}$ where the bounds are provided per element.\n\nReturn, for each test case, all solutions as a lexicographically sorted list of atom-count lists $[n_C,n_H,n_N,n_O,n_S,n_{Cl}]$.\n\nPhysical and numerical units: Exact masses and tolerances must be treated in daltons. DBE is unitless. Elemental mass fractions are unitless decimals in $[0,1]$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces. Each entry corresponds to one test caseâ€™s solution set, represented as a list of integer lists. For example, a two-case run returning one solution for the first case and none for the second must look like $[[[2,5,1,2,0,0]],[]]$.\n\nTest suite and answer specification: Use the following four cases that together probe a typical matched case, a halogenated case, a heteroatom-rich case, and an infeasible boundary case. All numerical values are closed intervals and must be applied inclusively.\n\n- Constants common to all cases:\n  - Monoisotopic masses (daltons): $m_C = 12.00000000000$, $m_H = 1.00782503223$, $m_N = 14.00307400443$, $m_O = 15.99491461957$, $m_S = 31.97207117440$, $m_{Cl} = 34.96885268200$.\n\n- Case $1$ (nitrogen-oxygen small molecule):\n  - Target mass and tolerance: $m_{\\mathrm{target}} = 75.03202840472$, $\\Delta m = 0.0005$.\n  - DBE range: $\\mathrm{DBE}_{\\min} = 1$, $\\mathrm{DBE}_{\\max} = 1$.\n  - Elemental mass fraction bounds $(w_E^{\\min},w_E^{\\max})$:\n    - $C$: $(0.319, 0.321)$,\n    - $H$: $(0.0665, 0.0680)$,\n    - $N$: $(0.186, 0.187)$,\n    - $O$: $(0.425, 0.428)$,\n    - $S$: $(0.000, 0.010)$,\n    - $Cl$: $(0.000, 0.010)$.\n  - Atom-count upper bounds $n_E^{\\max}$:\n    - $C$: $10$, $H$: $20$, $N$: $4$, $O$: $10$, $S$: $2$, $Cl$: $2$.\n\n- Case $2$ (dihalogenated hydrocarbon):\n  - Target mass and tolerance: $m_{\\mathrm{target}} = 97.96900549292$, $\\Delta m = 0.0005$.\n  - DBE range: $\\mathrm{DBE}_{\\min} = 0$, $\\mathrm{DBE}_{\\max} = 0$.\n  - Elemental mass fraction bounds:\n    - $C$: $(0.245, 0.246)$,\n    - $H$: $(0.0410, 0.0415)$,\n    - $N$: $(0.000, 0.010)$,\n    - $O$: $(0.000, 0.010)$,\n    - $S$: $(0.000, 0.010)$,\n    - $Cl$: $(0.713, 0.7145)$.\n  - Atom-count upper bounds:\n    - $C$: $4$, $H$: $8$, $N$: $2$, $O$: $2$, $S$: $1$, $Cl$: $3$.\n\n- Case $3$ (carbonyl sulfide):\n  - Target mass and tolerance: $m_{\\mathrm{target}} = 59.96698579397$, $\\Delta m = 0.0005$.\n  - DBE range: $\\mathrm{DBE}_{\\min} = 2$, $\\mathrm{DBE}_{\\max} = 2$.\n  - Elemental mass fraction bounds:\n    - $C$: $(0.200, 0.201)$,\n    - $H$: $(0.000, 0.010)$,\n    - $N$: $(0.000, 0.010)$,\n    - $O$: $(0.2663, 0.2670)$,\n    - $S$: $(0.533, 0.534)$,\n    - $Cl$: $(0.000, 0.010)$.\n  - Atom-count upper bounds:\n    - $C$: $3$, $H$: $2$, $N$: $2$, $O$: $3$, $S$: $2$, $Cl$: $1$.\n\n- Case $4$ (infeasible bounds):\n  - Target mass and tolerance: $m_{\\mathrm{target}} = 200.00000000000$, $\\Delta m = 0.0010$.\n  - DBE range: $\\mathrm{DBE}_{\\min} = 0$, $\\mathrm{DBE}_{\\max} = 5$.\n  - Elemental mass fraction bounds:\n    - $C$: $(0.000, 1.000)$,\n    - $H$: $(0.000, 1.000)$,\n    - $N$: $(0.000, 1.000)$,\n    - $O$: $(0.000, 1.000)$,\n    - $S$: $(0.000, 1.000)$,\n    - $Cl$: $(0.000, 1.000)$.\n  - Atom-count upper bounds:\n    - $C$: $1$, $H$: $1$, $N$: $1$, $O$: $1$, $S$: $1$, $Cl$: $1$.\n\nYour program must evaluate the four cases in the order listed and produce a single line containing the list of solution sets in that order, formatted without spaces as described above. Each individual solution is a list of six integers in the element order $\\{C,H,N,O,S,Cl\\}$.", "solution": "The problem statement has been evaluated and is determined to be valid. It presents a well-defined computational task in the domain of analytical chemistry, specifically related to molecular formula determination from mass spectrometry data. The problem is scientifically grounded, internally consistent, and requires the implementation of a constrained exhaustive search algorithm. The provided physical constants, mathematical formulae, and constraints are clear and sufficient for deriving a unique set of solutions for each test case. A minor notational ambiguity regarding interval representation is present, where parenthesis notation is used for what are explicitly defined as closed, inclusive intervals. This is a trivial defect in presentation, not a logical flaw, and the explicit instruction for inclusivity provides unambiguous clarification. We shall proceed with the solution.\n\nThe problem requires the identification of all possible molecular formulae, expressed as integer vectors of atom counts $\\mathbf{n} = [n_C, n_H, n_N, n_O, n_S, n_{Cl}]$, that simultaneously satisfy a given set of constraints on exact mass, double bond equivalents, and elemental mass fractions. The search space for the atom counts $n_E$ for each element $E$ is bounded by case-specific upper limits, $0 \\le n_E \\le n_E^{\\max}$. The finite nature of this search space makes an exhaustive search, or brute-force enumeration, a viable and correct strategy.\n\nThe algorithm will proceed as follows:\n\n1.  **Iterate Over Test Cases**: The program will systematically process each of the four provided test cases. For each case, the specific constraints ($m_{\\mathrm{target}}$, $\\Delta m$, $[\\mathrm{DBE}_{\\min}, \\mathrm{DBE}_{\\max}]$, $\\{w_E^{\\min}, w_E^{\\max}\\}$, and $\\{n_E^{\\max}\\}$) are used.\n\n2.  **Generate Candidate Formulae**: For a given test case, all possible candidate vectors $\\mathbf{n}$ are generated. This is a combinatorial problem, iterating through each $n_C$ from $0$ to $n_C^{\\max}$, each $n_H$ from $0$ to $n_H^{\\max}$, and so on for all six elements. This defines a six-dimensional search grid of integer points.\n\n3.  **Apply Constraint Filters**: Each candidate vector $\\mathbf{n}$ is subjected to a sequence of validation checks. A candidate must pass all checks to be considered a solution. The checks are ordered to maximize computational efficiency by eliminating non-viable candidates as early as possible.\n\n    a. **Mass Filter**: The exact monoisotopic mass $m(\\mathbf{n})$ is calculated using the provided formula:\n    $$m(\\mathbf{n}) = \\sum_{E \\in \\{C,H,N,O,S,Cl\\}} n_E m_E$$\n    where $m_E$ are the given monoisotopic masses. A candidate is kept for further processing only if its mass falls within the specified tolerance window:\n    $$|m(\\mathbf{n}) - m_{\\mathrm{target}}| \\le \\Delta m$$\n    Candidates with a total mass of $m(\\mathbf{n})=0$ (i.e., the null formula $\\mathbf{n}=[0,0,0,0,0,0]$) are inherently rejected as all target masses are positive. This check also prevents division by zero in the subsequent mass fraction calculation.\n\n    b. **Double Bond Equivalent (DBE) Filter**: For candidates that pass the mass filter, the DBE is calculated:\n    $$\\mathrm{DBE}(\\mathbf{n}) = \\frac{2n_C + 2 + n_N - n_H - n_{Cl}}{2}$$\n    For a chemically valid formula, $\\mathrm{DBE}(\\mathbf{n})$ must be a non-negative integer. This implies that the numerator, $2n_C + 2 + n_N - n_H - n_{Cl}$, must be a non-negative even integer. Furthermore, the resulting DBE value must lie within the specified inclusive range $[\\mathrm{DBE}_{\\min}, \\mathrm{DBE}_{\\max}]$.\n\n    c. **Elemental Mass Fraction Filter**: For candidates passing both mass and DBE filters, the elemental mass fraction $w_E(\\mathbf{n})$ for each element $E$ is calculated:\n    $$w_E(\\mathbf{n}) = \\frac{n_E m_E}{m(\\mathbf{n})}$$\n    Each calculated fraction $w_E(\\mathbf{n})$ must fall within its specified inclusive range $[w_E^{\\min}, w_E^{\\max}]$. A candidate is accepted as a final solution only if this condition holds for all six elements.\n\n4.  **Collect and Sort Solutions**: All candidate vectors $\\mathbf{n}$ that satisfy all three filters are collected for the current test case. This list of solutions is then lexicographically sorted as required.\n\n5.  **Format Output**: The final result is a list containing the sorted solution lists for each of the four test cases. This is formatted into a single string with no whitespace, adhering strictly to the specified format. For cases yielding no solutions, an empty list is represented.\n\nThis systematic enumeration and filtering approach guarantees that all solutions within the defined search space are found, and no invalid formulae are included. The implementation will use high-precision floating-point arithmetic to ensure numerical correctness.\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport itertools\n\ndef solve():\n    \"\"\"\n    Performs an exhaustive search for molecular formulas satisfying constraints\n    on mass, DBE, and elemental composition.\n    \"\"\"\n    \n    # Fundamental constants\n    # Monoisotopic masses (daltons) for C, H, N, O, S, Cl\n    MONOISOTOPIC_MASSES = np.array([\n        12.00000000000,    # C\n        1.00782503223,     # H\n        14.00307400443,    # N\n        15.99491461957,    # O\n        31.97207117440,    # S\n        34.96885268200     # Cl\n    ])\n    \n    # Test cases defined as a list of dictionaries.\n    test_cases = [\n        # Case 1: nitrogen-oxygen small molecule\n        {\n            'm_target': 75.03202840472, 'delta_m': 0.0005,\n            'dbe_range': (1, 1),\n            'w_bounds': [\n                (0.319, 0.321),    # C\n                (0.0665, 0.0680),  # H\n                (0.186, 0.187),    # N\n                (0.425, 0.428),    # O\n                (0.000, 0.010),    # S\n                (0.000, 0.010)     # Cl\n            ],\n            'n_max': [10, 20, 4, 10, 2, 2]\n        },\n        # Case 2: dihalogenated hydrocarbon\n        {\n            'm_target': 97.96900549292, 'delta_m': 0.0005,\n            'dbe_range': (0, 0),\n            'w_bounds': [\n                (0.245, 0.246),    # C\n                (0.0410, 0.0415),  # H\n                (0.000, 0.010),    # N\n                (0.000, 0.010),    # O\n                (0.000, 0.010),    # S\n                (0.713, 0.7145)    # Cl\n            ],\n            'n_max': [4, 8, 2, 2, 1, 3]\n        },\n        # Case 3: carbonyl sulfide\n        {\n            'm_target': 59.96698579397, 'delta_m': 0.0005,\n            'dbe_range': (2, 2),\n            'w_bounds': [\n                (0.200, 0.201),    # C\n                (0.000, 0.010),    # H\n                (0.000, 0.010),    # N\n                (0.2663, 0.2670),  # O\n                (0.533, 0.534),    # S\n                (0.000, 0.010)     # Cl\n            ],\n            'n_max': [3, 2, 2, 3, 2, 1]\n        },\n        # Case 4: infeasible bounds\n        {\n            'm_target': 200.00000000000, 'delta_m': 0.0010,\n            'dbe_range': (0, 5),\n            'w_bounds': [\n                (0.000, 1.000),    # C\n                (0.000, 1.000),    # H\n                (0.000, 1.000),    # N\n                (0.000, 1.000),    # O\n                (0.000, 1.000),    # S\n                (0.000, 1.000)     # Cl\n            ],\n            'n_max': [1, 1, 1, 1, 1, 1]\n        }\n    ]\n\n    all_cases_results = []\n\n    for case in test_cases:\n        m_target, delta_m = case['m_target'], case['delta_m']\n        dbe_min, dbe_max = case['dbe_range']\n        w_bounds = case['w_bounds']\n        n_max = case['n_max']\n        \n        # Generate candidate atom counts using itertools.product\n        count_ranges = [range(n + 1) for n in n_max]\n        candidates = itertools.product(*count_ranges)\n        \n        found_solutions = []\n        \n        for counts_tuple in candidates:\n            # Trivial case of no atoms has zero mass and undefined fractions\n            if sum(counts_tuple) == 0:\n                continue\n\n            counts = np.array(counts_tuple)\n            \n            # --- Filter 1: Exact Mass ---\n            total_mass = np.dot(counts, MONOISOTOPIC_MASSES)\n            if not (m_target - delta_m = total_mass = m_target + delta_m):\n                continue\n                \n            # --- Filter 2: Double Bond Equivalent (DBE) ---\n            nC, nH, nN, nO, nS, nCl = counts_tuple\n            dbe_numerator = 2 * nC + 2 + nN - nH - nCl\n            \n            # DBE must be a non-negative integer\n            if dbe_numerator  0 or dbe_numerator % 2 != 0:\n                continue\n            \n            dbe = dbe_numerator // 2\n            if not (dbe_min = dbe = dbe_max):\n                continue\n            \n            # --- Filter 3: Elemental Mass Fractions ---\n            # This check is last as it's the most computationally expensive.\n            mass_fractions = (counts * MONOISOTOPIC_MASSES) / total_mass\n            \n            all_fractions_valid = True\n            for i in range(len(counts)):\n                w_min, w_max = w_bounds[i]\n                if not (w_min = mass_fractions[i] = w_max):\n                    all_fractions_valid = False\n                    break\n            \n            if all_fractions_valid:\n                found_solutions.append(list(counts))\n\n        # Sort solutions lexicographically\n        found_solutions.sort()\n        all_cases_results.append(found_solutions)\n        \n    # Format the final output string precisely as required (no spaces)\n    outer_parts = []\n    for case_solutions in all_cases_results:\n        if not case_solutions:\n            outer_parts.append('[]')\n        else:\n            inner_parts = []\n            for sol in case_solutions:\n                inner_parts.append(f\"[{','.join(map(str, sol))}]\")\n            outer_parts.append(f\"[{','.join(inner_parts)}]\")\n    \n    final_output = f\"[{','.join(outer_parts)}]\"\n    print(final_output)\n\n# solve() # The function is defined but not called, as the answer is the final output string.\n```", "answer": "$$\\boxed{\\texttt{[[[2,5,1,2,0,0]]],[[2,4,0,0,0,2]],[[1,0,0,1,1,0]],[]]}}$$", "id": "2937652"}]}