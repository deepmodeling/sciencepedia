{"hands_on_practices": [{"introduction": "The selection of an appropriate acid-base indicator is predicated on matching its transition range to the $\\mathrm{pH}$ at the equivalence point. However, it is a common misconception that this equivalence $\\mathrm{pH}$ is fixed for a given class of titration. This practice [@problem_id:2918025] challenges that notion by exploring how analyte concentration fundamentally alters the extent of hydrolysis at the equivalence point, thereby shifting the $\\mathrm{pH}$. By working through this hypothetical scenario, you will develop a deeper, first-principles understanding of how dilution affects the equivalence point and why the optimal indicator choice may change accordingly.", "problem": "A monoprotic weak base $B$ (aqueous) of base dissociation constant $K_b$ is titrated with a strong acid. All solutions are ideal and at $25^{\\circ}\\mathrm{C}$, where the ionic product of water is $K_w = 1.0\\times 10^{-14}$. Consider two experiments that deliver the same amount of substance of $B$ at very different dilutions:\n\n- Experiment $1$: $V_0 = 25.00\\,\\mathrm{mL}$ of $0.100\\,\\mathrm{mol\\,L^{-1}}$ $B$ titrated to equivalence with $0.100\\,\\mathrm{mol\\,L^{-1}}$ $\\mathrm{HCl}$.\n- Experiment $2$: $V_0 = 2500.00\\,\\mathrm{mL}$ of $0.00100\\,\\mathrm{mol\\,L^{-1}}$ $B$ titrated to equivalence with $0.100\\,\\mathrm{mol\\,L^{-1}}$ $\\mathrm{HCl}$.\n\nAssume $K_b(B) = 1.80\\times 10^{-5}$ so that $K_a(\\mathrm{BH}^+) = K_w/K_b$. At each equivalence point, the solution contains the conjugate acid $\\mathrm{BH}^+$ and its counterion (from the strong titrant), at a total volume equal to the initial analyte volume plus the equivalence volume of titrant. Your tasks:\n\n- Starting only from the definitions of the acid dissociation constant $K_a$, the water autoionization constant $K_w$, mass balance, and charge balance, analyze how the formal concentration of $\\mathrm{BH}^+$ at equivalence controls hydrolysis and the resulting potential of hydrogen ($\\mathrm{pH}$). Justify whether the $\\mathrm{pH}$ at equivalence should move toward or away from neutrality as the analyte is diluted, and how the fractional hydrolysis (the ratio $[\\mathrm{B}]/C_{\\mathrm{BH}^+}$) responds to dilution.\n- Then, using standard indicator transition intervals, determine whether the optimal indicator should change between Experiments $1$ and $2$. Use the following transition ranges (at $25^{\\circ}\\mathrm{C}$): methyl orange ($\\mathrm{pH}$ 3.1–4.4), methyl red ($\\mathrm{pH}$ 4.2–6.3), bromothymol blue ($\\mathrm{pH}$ 6.0–7.6), phenolphthalein ($\\mathrm{pH}$ 8.3–10.0).\n\nWhich single option best captures the correct analysis and indicator choice?\n\nA. The equivalence $\\mathrm{pH}$ is the same in both experiments because $K_a$ is intensive; fractional hydrolysis is unchanged; the same indicator (methyl red) is optimal in both.\n\nB. The equivalence $\\mathrm{pH}$ moves toward $7$ upon dilution because the formal concentration of $\\mathrm{BH}^+$ decreases and hydrolysis becomes relatively more extensive (higher fraction); methyl red is optimal in Experiment $1$, whereas bromothymol blue is preferable in Experiment $2$.\n\nC. The equivalence $\\mathrm{pH}$ moves away from $7$ upon dilution because hydrolysis intensifies in absolute terms; fractional hydrolysis decreases; phenolphthalein is preferable in Experiment $2$.\n\nD. The equivalence $\\mathrm{pH}$ moves toward $7$ upon dilution and the fractional hydrolysis increases, but the indicator need not change; methyl red remains optimal in both experiments because the $\\mathrm{pH}$ jump fully spans its transition range in each case.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n-   Analyte: Monoprotic weak base $B$.\n-   Base dissociation constant: $K_b(B) = 1.80 \\times 10^{-5}$.\n-   Temperature: $25^{\\circ}\\mathrm{C}$.\n-   Ionic product of water: $K_w = 1.0 \\times 10^{-14}$.\n-   Titrant: Strong acid, $\\mathrm{HCl}$.\n-   Experiment $1$: $V_0 = 25.00\\,\\mathrm{mL}$ of $0.100\\,\\mathrm{mol\\,L^{-1}}$ $B$ titrated with $0.100\\,\\mathrm{mol\\,L^{-1}}$ $\\mathrm{HCl}$.\n-   Experiment $2$: $V_0 = 2500.00\\,\\mathrm{mL}$ of $0.00100\\,\\mathrm{mol\\,L^{-1}}$ $B$ titrated with $0.100\\,\\mathrm{mol\\,L^{-1}}$ $\\mathrm{HCl}$.\n-   Titration is to the equivalence point. The amount of substance of $B$ is the same in both experiments.\n-   At equivalence, the solution contains the conjugate acid $\\mathrm{BH}^+$.\n-   Acid dissociation constant of conjugate acid: $K_a(\\mathrm{BH}^+) = K_w/K_b$.\n-   Indicator transition ranges ($\\mathrm{pH}$): methyl orange (3.1–4.4), methyl red (4.2–6.3), bromothymol blue (6.0–7.6), phenolphthalein (8.3–10.0).\n\n**Step 2: Validate Using Extracted Givens**\nThe problem describes a standard acid-base titration scenario. All provided data ($K_b$, $K_w$, concentrations, volumes) are scientifically realistic and internally consistent. The amount of substance of $B$ in Experiment $1$ is $n_B = (0.100\\,\\mathrm{mol\\,L^{-1}})(0.02500\\,\\mathrm{L}) = 0.00250\\,\\mathrm{mol}$. In Experiment $2$, $n_B = (0.00100\\,\\mathrm{mol\\,L^{-1}})(2.50000\\,\\mathrm{L}) = 0.00250\\,\\mathrm{mol}$. The condition of \"same amount of substance\" is met. The problem is chemically sound, well-posed, objective, and contains sufficient information for a unique solution.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A full solution will be derived.\n\n**Derivation from First Principles**\n\nAt the equivalence point of the titration of a weak base $B$ with a strong acid $\\mathrm{HCl}$, all the base has been converted to its conjugate acid, $\\mathrm{BH}^+$. The solution consists of the weak acid $\\mathrm{BH}^+$ and the spectator ion $\\mathrm{Cl}^-$. The $\\mathrm{pH}$ is determined by the hydrolysis of $\\mathrm{BH}^+$.\n\nThe relevant chemical equilibria in the solution are:\n1.  Hydrolysis of $\\mathrm{BH}^+$: $\\mathrm{BH}^+(aq) + \\mathrm{H}_2\\mathrm{O}(l) \\rightleftharpoons \\mathrm{B}(aq) + \\mathrm{H}_3\\mathrm{O}^+(aq)$\n    The acid dissociation constant is $K_a = \\frac{[\\mathrm{B}][\\mathrm{H}_3\\mathrm{O}^+]}{[\\mathrm{BH}^+]}$.\n2.  Autoionization of water: $2\\mathrm{H}_2\\mathrm{O}(l) \\rightleftharpoons \\mathrm{H}_3\\mathrm{O}^+(aq) + \\mathrm{OH}^-(aq)$\n    The ionic product of water is $K_w = [\\mathrm{H}_3\\mathrm{O}^+][\\mathrm{OH}^-]$.\n\nLet $C_{\\mathrm{BH}^+}$ be the formal concentration of $\\mathrm{BH}^+$ at the equivalence point.\nThe mass balance for the base and its conjugate is $C_{\\mathrm{BH}^+} = [\\mathrm{BH}^+] + [\\mathrm{B}]$.\nThe charge balance equation is $[\\mathrm{BH}^+] + [\\mathrm{H}_3\\mathrm{O}^+] = [\\mathrm{Cl}^-] + [\\mathrm{OH}^-]$. At equivalence, the concentration of the spectator ion $[\\mathrm{Cl}^-]$ is equal to the formal concentration of the conjugate acid, $C_{\\mathrm{BH}^+}$.\nSo, $[\\mathrm{BH}^+] + [\\mathrm{H}_3\\mathrm{O}^+] = C_{\\mathrm{BH}^+} + [\\mathrm{OH}^-]$.\nSubstituting $[\\mathrm{BH}^+] = C_{\\mathrm{BH}^+} - [\\mathrm{B}]$ from the mass balance gives:\n$(C_{\\mathrm{BH}^+} - [\\mathrm{B}]) + [\\mathrm{H}_3\\mathrm{O}^+] = C_{\\mathrm{BH}^+} + [\\mathrm{OH}^-]$\nThis simplifies to the proton balance equation: $[\\mathrm{H}_3\\mathrm{O}^+] = [\\mathrm{B}] + [\\mathrm{OH}^-]$.\n\nUsing the equilibrium expressions, we can write $[\\mathrm{B}] = K_a \\frac{[\\mathrm{BH}^+]}{[\\mathrm{H}_3\\mathrm{O}^+]}$ and $[\\mathrm{OH}^-] = \\frac{K_w}{[\\mathrm{H}_3\\mathrm{O}^+]}$.\nThe equation becomes $[\\mathrm{H}_3\\mathrm{O}^+] = K_a \\frac{[\\mathrm{BH}^+]}{[\\mathrm{H}_3\\mathrm{O}^+]} + \\frac{K_w}{[\\mathrm{H}_3\\mathrm{O}^+]}$.\n$[\\mathrm{H}_3\\mathrm{O}^+]^2 = K_a[\\mathrm{BH}^+] + K_w$.\nFor a weak acid, hydrolysis is typically small, so we can approximate $[\\mathrm{BH}^+] \\approx C_{\\mathrm{BH}^+}$. This yields the accurate expression for hydronium ion concentration:\n$$[\\mathrm{H}_3\\mathrm{O}^+] = \\sqrt{K_a C_{\\mathrm{BH}^+} + K_w}$$\nThe fractional hydrolysis, $\\alpha$, is the fraction of $\\mathrm{BH}^+$ that has hydrolyzed to $B$: $\\alpha = \\frac{[\\mathrm{B}]}{C_{\\mathrm{BH}^+}}$.\nSince $[\\mathrm{B}] = [\\mathrm{H}_3\\mathrm{O}^+] - [\\mathrm{OH}^-]$ and for an acidic solution $[\\mathrm{H}_3\\mathrm{O}^+] \\gg [\\mathrm{OH}^-]$, we can approximate $[\\mathrm{B}] \\approx [\\mathrm{H}_3\\mathrm{O}^+]$. If we also assume $K_a C_{\\mathrm{BH}^+} \\gg K_w$, then $[\\mathrm{H}_3\\mathrm{O}^+] \\approx \\sqrt{K_a C_{\\mathrm{BH}^+}}$.\nThen, $\\alpha \\approx \\frac{\\sqrt{K_a C_{\\mathrm{BH}^+}}}{C_{\\mathrm{BH}^+}} = \\sqrt{\\frac{K_a}{C_{\\mathrm{BH}^+}}}$. This shows that as the concentration $C_{\\mathrm{BH}^+}$ decreases (dilution), the fractional hydrolysis $\\alpha$ increases.\n\nThe acid dissociation constant is $K_a = \\frac{K_w}{K_b} = \\frac{1.0 \\times 10^{-14}}{1.80 \\times 10^{-5}} \\approx 5.56 \\times 10^{-10}$.\n\n**Analysis of Experiment 1**\n-   Amount of $B$: $n_B = (0.100\\,\\mathrm{mol\\,L^{-1}})(0.02500\\,\\mathrm{L}) = 2.50 \\times 10^{-3}\\,\\mathrm{mol}$.\n-   Equivalence volume of $\\mathrm{HCl}$: $V_{eq,1} = \\frac{n_B}{C_{HCl}} = \\frac{2.50 \\times 10^{-3}\\,\\mathrm{mol}}{0.100\\,\\mathrm{mol\\,L^{-1}}} = 0.0250\\,\\mathrm{L} = 25.0\\,\\mathrm{mL}$.\n-   Total volume at equivalence: $V_{total,1} = V_0 + V_{eq,1} = 25.00\\,\\mathrm{mL} + 25.0\\,\\mathrm{mL} = 50.0\\,\\mathrm{mL} = 0.0500\\,\\mathrm{L}$.\n-   Formal concentration of $\\mathrm{BH}^+$: $C_{\\mathrm{BH}^+,1} = \\frac{n_B}{V_{total,1}} = \\frac{2.50 \\times 10^{-3}\\,\\mathrm{mol}}{0.0500\\,\\mathrm{L}} = 0.0500\\,\\mathrm{mol\\,L^{-1}}$.\n-   Hydronium ion concentration:\n    $[\\mathrm{H}_3\\mathrm{O}^+] = \\sqrt{(5.56 \\times 10^{-10})(0.0500) + 1.0 \\times 10^{-14}} = \\sqrt{2.78 \\times 10^{-11} + 1.0 \\times 10^{-14}} \\approx 5.27 \\times 10^{-6}\\,\\mathrm{mol\\,L^{-1}}$.\n-   $\\mathrm{pH}$ at equivalence: $\\mathrm{pH}_{eq,1} = -\\log_{10}(5.27 \\times 10^{-6}) \\approx 5.28$.\n-   Fractional hydrolysis: $\\alpha_1 \\approx \\sqrt{\\frac{5.56 \\times 10^{-10}}{0.0500}} \\approx 1.05 \\times 10^{-4}$.\n\n**Analysis of Experiment 2**\n-   Amount of $B$: $n_B = (0.00100\\,\\mathrm{mol\\,L^{-1}})(2.50000\\,\\mathrm{L}) = 2.50 \\times 10^{-3}\\,\\mathrm{mol}$.\n-   Equivalence volume of $\\mathrm{HCl}$: $V_{eq,2} = \\frac{n_B}{C_{HCl}} = \\frac{2.50 \\times 10^{-3}\\,\\mathrm{mol}}{0.100\\,\\mathrm{mol\\,L^{-1}}} = 0.0250\\,\\mathrm{L} = 25.0\\,\\mathrm{mL}$.\n-   Total volume at equivalence: $V_{total,2} = V_0 + V_{eq,2} = 2500.00\\,\\mathrm{mL} + 25.0\\,\\mathrm{mL} = 2525.0\\,\\mathrm{mL} = 2.525\\,\\mathrm{L}$.\n-   Formal concentration of $\\mathrm{BH}^+$: $C_{\\mathrm{BH}^+,2} = \\frac{n_B}{V_{total,2}} = \\frac{2.50 \\times 10^{-3}\\,\\mathrm{mol}}{2.525\\,\\mathrm{L}} \\approx 9.90 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}$.\n-   Hydronium ion concentration:\n    $[\\mathrm{H}_3\\mathrm{O}^+] = \\sqrt{(5.56 \\times 10^{-10})(9.90 \\times 10^{-4}) + 1.0 \\times 10^{-14}} = \\sqrt{5.50 \\times 10^{-13} + 1.0 \\times 10^{-14}} = \\sqrt{5.60 \\times 10^{-13}} \\approx 7.48 \\times 10^{-7}\\,\\mathrm{mol\\,L^{-1}}$.\n-   $\\mathrm{pH}$ at equivalence: $\\mathrm{pH}_{eq,2} = -\\log_{10}(7.48 \\times 10^{-7}) \\approx 6.13$.\n-   Fractional hydrolysis: $\\alpha_2 \\approx \\sqrt{\\frac{5.56 \\times 10^{-10}}{9.90 \\times 10^{-4}}} \\approx 7.49 \\times 10^{-4}$.\n\n**Comparative Analysis and Conclusions**\n1.  **Effect of Dilution on Equivalence pH**: Comparing Experiment $1$ ($C_{\\mathrm{BH}^+}$ is higher) and Experiment $2$ ($C_{\\mathrm{BH}^+}$ is lower), the equivalence $\\mathrm{pH}$ changes from $\\mathrm{pH}_{eq,1} \\approx 5.28$ to $\\mathrm{pH}_{eq,2} \\approx 6.13$. As the analyte solution is diluted, the equivalence point $\\mathrm{pH}$ moves toward the neutral value of $7.0$.\n2.  **Effect of Dilution on Fractional Hydrolysis**: Comparing the fractional hydrolysis, $\\alpha_1 \\approx 1.05 \\times 10^{-4}$ and $\\alpha_2 \\approx 7.49 \\times 10^{-4}$. As the solution is diluted, the fractional hydrolysis increases ($\\alpha_2 > \\alpha_1$). This is consistent with Le Chatelier's principle applied to the hydrolysis equilibrium.\n3.  **Optimal Indicator Choice**: The optimal indicator is one for which its $pK_{a, \\mathrm{HIn}}$ is closest to the $\\mathrm{pH}$ at the equivalence point. The center of the indicator's transition range is a good estimate for its $pK_{a, \\mathrm{HIn}}$.\n    -   For Experiment $1$ ($\\mathrm{pH}_{eq} \\approx 5.28$): The center of the methyl red range ($\\mathrm{pH}$ 4.2–6.3) is $(4.2+6.3)/2 = 5.25$. This is an excellent match. Methyl red is the optimal indicator.\n    -   For Experiment $2$ ($\\mathrm{pH}_{eq} \\approx 6.13$):\n        -   The center of the methyl red range is $5.25$. The difference is $|6.13 - 5.25| = 0.88$.\n        -   The center of the bromothymol blue range ($\\mathrm{pH}$ 6.0–7.6) is $(6.0+7.6)/2 = 6.8$. The difference is $|6.13 - 6.8| = 0.67$.\n        Since bromothymol blue's center is closer to the equivalence point $\\mathrm{pH}$, it is the preferable and more optimal indicator for Experiment $2$.\n\n**Evaluation of Options**\n\n-   **A. The equivalence $\\mathrm{pH}$ is the same in both experiments because $K_a$ is intensive; fractional hydrolysis is unchanged; the same indicator (methyl red) is optimal in both.**\n    **Incorrect**. The equivalence $\\mathrm{pH}$ is dependent on concentration ($\\sqrt{K_a C_{\\mathrm{BH}^+}}$) and thus changes. Fractional hydrolysis also changes with concentration.\n\n-   **B. The equivalence $\\mathrm{pH}$ moves toward $7$ upon dilution because the formal concentration of $\\mathrm{BH}^+$ decreases and hydrolysis becomes relatively more extensive (higher fraction); methyl red is optimal in Experiment $1$, whereas bromothymol blue is preferable in Experiment $2$.**\n    **Correct**. This statement accurately reflects all aspects of the analysis: the direction of the $\\mathrm{pH}$ shift, the reason for it (decreasing concentration), the increase in fractional hydrolysis, and the correct selection of indicators based on proximity of their $pK_{a, \\mathrm{HIn}}$ to the equivalence $\\mathrm{pH}$ in each case.\n\n-   **C. The equivalence $\\mathrm{pH}$ moves away from $7$ upon dilution because hydrolysis intensifies in absolute terms; fractional hydrolysis decreases; phenolphthalein is preferable in Experiment $2$.**\n    **Incorrect**. The $\\mathrm{pH}$ moves toward $7$, not away. Fractional hydrolysis increases, not decreases. The absolute extent of hydrolysis (concentration of $B$) decreases. Phenolphthalein is unsuitable for an acidic equivalence point.\n\n-   **D. The equivalence $\\mathrm{pH}$ moves toward $7$ upon dilution and the fractional hydrolysis increases, but the indicator need not change; methyl red remains optimal in both experiments because the $\\mathrm{pH}$ jump fully spans its transition range in each case.**\n    **Incorrect**. While the first part of the statement is correct, the claim about the indicator is flawed. Although methyl red might be a *usable* indicator for Experiment $2$ because the $\\mathrm{pH}$ jump is sufficiently large, it is not the *optimal* one. Bromothymol blue is a better choice for Experiment $2$. The term \"optimal\" implies the best possible choice, which minimizes titration error. Thus, stating methyl red \"remains optimal\" is incorrect. Option B provides a more precise and accurate analysis of the indicator choice.", "answer": "$$\\boxed{B}$$", "id": "2918025"}, {"introduction": "Reporting a numerical result without a corresponding statement of uncertainty is scientifically incomplete. This exercise [@problem_id:2917984] moves beyond simple error estimation to a formal uncertainty analysis, guiding you through the process of propagating uncertainties from multiple independent sources—instrumental readings, standard concentrations, and endpoint detection—to the final analyte concentration. This practice provides a rigorous framework for quantifying the confidence in a titration result, a critical skill in all quantitative sciences.", "problem": "A monoprotic strong acid solution of unknown concentration $C_{a}$ is prepared by delivering an initial volume $V_{a}$ of the acid into a flask. The acid is titrated with a standardized strong base (sodium hydroxide) of concentration $C_{b}$ from a buret, using an acid-base indicator with a color transition centered at $\\mathrm{pH}^{\\ast}$. You may assume ideal behavior (activities equal to concentrations), negligible carbon dioxide absorption, and that the only relevant equilibria are those of water autoionization and the strong acid–strong base neutralization. The measurement model for the analyte concentration estimate is\n$C_{a,\\mathrm{est}}=\\dfrac{C_{b}\\,V_{\\mathrm{end}}}{V_{a}}$,\nwhere $V_{\\mathrm{end}}$ is the delivered volume at the visual endpoint. The endpoint is identified at $\\mathrm{pH}_{\\mathrm{end}}$ with a known uncertainty due to indicator detection. The buret reading also introduces an independent volume uncertainty.\n\nStarting only from fundamental stoichiometry, mass balance, charge balance, and the definition of $\\mathrm{pH}$, derive a first-order uncertainty propagation that rigorously maps the standard uncertainties in the titrant concentration $u(C_{b})$, the buret-delivered volume at the endpoint $u(V_{\\mathrm{b}})$, and the endpoint $\\mathrm{pH}$ uncertainty $u(\\mathrm{pH}_{\\mathrm{end}})$ into the standard uncertainty of the estimated analyte concentration $u(C_{a,\\mathrm{est}})$. Treat $V_{\\mathrm{end}}$ as a function of the measured $\\mathrm{pH}_{\\mathrm{end}}$ and derive $\\dfrac{\\partial V}{\\partial \\mathrm{pH}}$ at the endpoint from first principles.\n\nUse the following specific data for a single titration at $25\\,^{\\circ}\\mathrm{C}$:\n- Initial analyte volume $V_{a} = 25.000\\,\\mathrm{mL}$ (treat as exact for this problem).\n- Titrant concentration $C_{b} = 0.10000\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$ with standard uncertainty $u(C_{b}) = 0.00010\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$.\n- Endpoint buret reading $V_{\\mathrm{end}} = 24.960\\,\\mathrm{mL}$ with standard uncertainty $u(V_{\\mathrm{b}}) = 0.020\\,\\mathrm{mL}$.\n- Indicator midpoint $\\mathrm{pH}^{\\ast} = 7.00$ with endpoint standard uncertainty $u(\\mathrm{pH}_{\\mathrm{end}}) = 0.10$.\n- Water ionic product $K_{w} = 1.0\\times 10^{-14}$ and $\\mathrm{pH} = -\\log_{10}([\\mathrm{H}^{+}])$.\n\nAssume that $u(C_{b})$, $u(V_{\\mathrm{b}})$, and $u(\\mathrm{pH}_{\\mathrm{end}})$ are small, uncorrelated, and that linearization is valid. In evaluating $\\dfrac{\\partial V}{\\partial \\mathrm{pH}}$, work on the acidic side of the equivalence region and relate $V$ to $[\\mathrm{H}^{+}]$ by stoichiometry and dilution.\n\nCompute the numerical value of the standard uncertainty $u(C_{a,\\mathrm{est}})$ implied by these inputs. Express your final numerical result in $\\mathrm{mol}\\,\\mathrm{L}^{-1}$ and round your answer to four significant figures.", "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- Analyte: Monoprotic strong acid.\n- Titrant: Strong base ($\\mathrm{NaOH}$) of concentration $C_{b}$.\n- Measurement model: $C_{a,\\mathrm{est}}=\\dfrac{C_{b}\\,V_{\\mathrm{end}}}{V_{a}}$.\n- Initial analyte volume: $V_{a} = 25.000\\,\\mathrm{mL}$ (treated as an exact value).\n- Titrant concentration: $C_{b} = 0.10000\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$.\n- Standard uncertainty in titrant concentration: $u(C_{b}) = 0.00010\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$.\n- Endpoint buret reading: $V_{\\mathrm{end}} = 24.960\\,\\mathrm{mL}$.\n- Standard uncertainty in buret reading: $u(V_{\\mathrm{b}}) = 0.020\\,\\mathrm{mL}$.\n- Indicator midpoint: $\\mathrm{pH}^{\\ast} = 7.00$, assumed to be the endpoint $\\mathrm{pH}$.\n- Standard uncertainty in endpoint $\\mathrm{pH}$: $u(\\mathrm{pH}_{\\mathrm{end}}) = 0.10$.\n- Temperature: $25\\,^{\\circ}\\mathrm{C}$.\n- Water ionic product: $K_{w} = 1.0 \\times 10^{-14}$.\n- Definition of $\\mathrm{pH}$: $\\mathrm{pH} = -\\log_{10}([\\mathrm{H}^{+}])$.\n- Assumptions:\n    - Ideal behavior (activity equals concentration).\n    - Negligible $\\mathrm{CO}_2$ absorption.\n    - Relevant equilibria: water autoionization and neutralization.\n    - Uncertainties $u(C_{b})$, $u(V_{\\mathrm{b}})$, and $u(\\mathrm{pH}_{\\mathrm{end}})$ are small, uncorrelated, and linearization is valid.\n- Task: Derive and compute the standard uncertainty $u(C_{a,\\mathrm{est}})$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on fundamental principles of analytical chemistry, specifically acid-base titrimetry and the GUM (Guide to the Expression of Uncertainty in Measurement) framework. All concepts are well-established.\n- **Well-Posed:** The problem provides all necessary numerical data, a clear model, and a well-defined objective. It asks for a derivation and a numerical calculation, which is a standard format for a quantitative science problem.\n- **Objective:** The problem is stated in precise, quantitative, and unbiased language.\n\nThe problem does not violate any of the invalidity criteria. It is scientifically sound, well-posed, objective, and formalizable.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Solution Derivation\nThe objective is to determine the standard uncertainty of the estimated analyte concentration, $u(C_{a,\\mathrm{est}})$, given the measurement model $C_{a,\\mathrm{est}}=\\dfrac{C_{b}\\,V_{\\mathrm{end}}}{V_{a}}$. The initial volume $V_{a}$ is treated as an exact constant. The input quantities with uncertainty are the titrant concentration $C_{b}$ and the endpoint volume $V_{\\mathrm{end}}$.\n\nThe uncertainty in $V_{\\mathrm{end}}$ arises from two independent sources as specified in the problem:\n1. The uncertainty of reading the buret, denoted $u(V_{\\mathrm{b}})$.\n2. The uncertainty in determining the correct volume due to the uncertainty in identifying the endpoint $\\mathrm{pH}$, which can be expressed as $u(V_{\\mathrm{pH}}) = \\left|\\dfrac{\\partial V_{\\mathrm{end}}}{\\partial \\mathrm{pH}_{\\mathrm{end}}}\\right| u(\\mathrm{pH}_{\\mathrm{end}})$.\n\nSince these sources are uncorrelated, the total variance of $V_{\\mathrm{end}}$ is the sum of the individual variances:\n$$u^2(V_{\\mathrm{end}}) = u^2(V_{\\mathrm{b}}) + u^2(V_{\\mathrm{pH}}) = u^2(V_{\\mathrm{b}}) + \\left(\\dfrac{\\partial V_{\\mathrm{end}}}{\\partial \\mathrm{pH}_{\\mathrm{end}}}\\right)^2 u^2(\\mathrm{pH}_{\\mathrm{end}})$$\n\nThe measurement model is a function of $C_{b}$ and $V_{\\mathrm{end}}$, which are considered independent variables. According to the law of propagation of uncertainty for uncorrelated variables, the variance of $C_{a,\\mathrm{est}}$ is given by:\n$$u^2(C_{a,\\mathrm{est}}) = \\left(\\dfrac{\\partial C_{a,\\mathrm{est}}}{\\partial C_{b}}\\right)^2 u^2(C_{b}) + \\left(\\dfrac{\\partial C_{a,\\mathrm{est}}}{\\partial V_{\\mathrm{end}}}\\right)^2 u^2(V_{\\mathrm{end}})$$\n\nSubstituting the expression for $u^2(V_{\\mathrm{end}})$ yields the full uncertainty model:\n$$u^2(C_{a,\\mathrm{est}}) = \\left(\\dfrac{\\partial C_{a,\\mathrm{est}}}{\\partial C_{b}}\\right)^2 u^2(C_{b}) + \\left(\\dfrac{\\partial C_{a,\\mathrm{est}}}{\\partial V_{\\mathrm{end}}}\\right)^2 \\left[ u^2(V_{\\mathrm{b}}) + \\left(\\dfrac{\\partial V_{\\mathrm{end}}}{\\partial \\mathrm{pH}_{\\mathrm{end}}}\\right)^2 u^2(\\mathrm{pH}_{\\mathrm{end}}) \\right]$$\n\nThe required partial derivatives of the measurement model are:\n$$\\dfrac{\\partial C_{a,\\mathrm{est}}}{\\partial C_{b}} = \\dfrac{V_{\\mathrm{end}}}{V_{a}}$$\n$$\\dfrac{\\partial C_{a,\\mathrm{est}}}{\\partial V_{\\mathrm{end}}} = \\dfrac{C_{b}}{V_{a}}$$\n\nThe next step is to derive the term $\\dfrac{\\partial V_{\\mathrm{end}}}{\\partial \\mathrm{pH}_{\\mathrm{end}}}$, which is the slope of the titration curve ($V$ vs. $\\mathrm{pH}$) at the endpoint. This is derived from the charge balance equation for the solution at any point during the titration. The species in solution are $\\mathrm{H}^{+}$, $\\mathrm{OH}^{-}$, $\\mathrm{Na}^{+}$ (from titrant), and $\\mathrm{A}^{-}$ (from strong acid). The charge balance equation is:\n$$[\\mathrm{H}^{+}] + [\\mathrm{Na}^{+}] = [\\mathrm{OH}^{-}] + [\\mathrm{A}^{-}]$$\n\nThe concentrations of the spectator ions are given by dilution:\n$$[\\mathrm{Na}^{+}] = \\dfrac{C_{b}V}{V_{a}+V} \\quad \\text{and} \\quad [\\mathrm{A}^{-}] = \\dfrac{C_{a}V_{a}}{V_{a}+V}$$\nwhere $V$ is the added volume of base. Also, from the autoionization of water, $[\\mathrm{OH}^{-}] = \\dfrac{K_{w}}{[\\mathrm{H}^{+}]}$.\nSubstituting these into the charge balance equation:\n$$[\\mathrm{H}^{+}] + \\dfrac{C_{b}V}{V_{a}+V} = \\dfrac{K_{w}}{[\\mathrm{H}^{+}]} + \\dfrac{C_{a}V_{a}}{V_{a}+V}$$\nThis equation defines the relationship between the added volume $V$ and the hydrogen ion concentration $[\\mathrm{H}^{+}]$. Let $h = [\\mathrm{H}^{+}]$. To find $\\dfrac{\\partial V}{\\partial h}$, we use implicit differentiation. Let us rearrange the equation into the form $F(V,h)=0$:\n$$F(V,h) = h(V_{a}+V) + C_{b}V - \\dfrac{K_{w}}{h}(V_{a}+V) - C_{a}V_{a} = 0$$\nThe derivative $\\dfrac{dV}{dh}$ is given by $\\dfrac{dV}{dh} = -\\dfrac{\\partial F/\\partial h}{\\partial F/\\partial V}$.\nThe partial derivatives are:\n$$\\dfrac{\\partial F}{\\partial h} = (V_{a}+V) + \\dfrac{K_{w}}{h^2}(V_{a}+V) = (V_{a}+V)\\left(1 + \\dfrac{K_{w}}{h^2}\\right)$$\n$$\\dfrac{\\partial F}{\\partial V} = h + C_{b} - \\dfrac{K_{w}}{h}$$\nThus:\n$$\\dfrac{dV}{dh} = -\\dfrac{(V_{a}+V)(1 + K_{w}/h^2)}{h + C_{b} - K_{w}/h}$$\nWe evaluate this derivative at the endpoint, which is at $\\mathrm{pH}_{\\mathrm{end}} = 7.00$. At this $\\mathrm{pH}$, $h = [\\mathrm{H}^{+}] = 10^{-7} \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}$, and since $K_{w} = 10^{-14}$, we have $h = \\sqrt{K_{w}}$. This simplifies the expression:\n$$h - \\dfrac{K_{w}}{h} = \\sqrt{K_{w}} - \\dfrac{K_{w}}{\\sqrt{K_{w}}} = 0$$\n$$1 + \\dfrac{K_{w}}{h^2} = 1 + \\dfrac{K_{w}}{K_{w}} = 2$$\nSo, at the endpoint ($V=V_{\\mathrm{end}}$):\n$$\\dfrac{dV}{dh}\\bigg|_{\\mathrm{pH}=7} = -\\dfrac{(V_{a}+V_{\\mathrm{end}})(2)}{C_{b}} = -\\dfrac{2(V_{a}+V_{\\mathrm{end}})}{C_{b}}$$\nNow, we use the chain rule to find the derivative with respect to $\\mathrm{pH}$: $\\dfrac{dV}{d\\mathrm{pH}} = \\dfrac{dV}{dh} \\cdot \\dfrac{dh}{d\\mathrm{pH}}$.\nFrom $\\mathrm{pH} = -\\log_{10}(h) = -\\dfrac{\\ln(h)}{\\ln(10)}$, we get $h = \\exp(-\\mathrm{pH}\\ln(10))$.\nThus, $\\dfrac{dh}{d\\mathrm{pH}} = -h\\ln(10)$.\nCombining these results:\n$$\\dfrac{\\partial V_{\\mathrm{end}}}{\\partial \\mathrm{pH}_{\\mathrm{end}}} = \\left(-\\dfrac{2(V_{a}+V_{\\mathrm{end}})}{C_{b}}\\right)(-h_{\\mathrm{end}}\\ln(10)) = \\dfrac{2(V_{a}+V_{\\mathrm{end}})}{C_{b}} \\sqrt{K_{w}}\\ln(10)$$\n\n### Numerical Calculation\nThe given values are converted to base SI units (L for volume, mol L$^{-1}$ for concentration):\n- $V_{a} = 0.025000\\,\\mathrm{L}$\n- $C_{b} = 0.10000\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$\n- $u(C_{b}) = 0.00010\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$\n- $V_{\\mathrm{end}} = 0.024960\\,\\mathrm{L}$\n- $u(V_{\\mathrm{b}}) = 0.000020\\,\\mathrm{L}$\n- $u(\\mathrm{pH}_{\\mathrm{end}}) = 0.10$\n- $\\sqrt{K_{w}} = 1.0 \\times 10^{-7}\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$\n- $\\ln(10) \\approx 2.302585$\n\n1.  Calculate the sensitivity coefficients:\n    $$\\dfrac{\\partial C_{a,\\mathrm{est}}}{\\partial C_{b}} = \\dfrac{0.024960\\,\\mathrm{L}}{0.025000\\,\\mathrm{L}} = 0.9984$$\n    $$\\dfrac{\\partial C_{a,\\mathrm{est}}}{\\partial V_{\\mathrm{end}}} = \\dfrac{0.10000\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}}{0.025000\\,\\mathrm{L}} = 4.0000\\,\\mathrm{mol}\\,\\mathrm{L}^{-2}$$\n\n2.  Calculate $\\dfrac{\\partial V_{\\mathrm{end}}}{\\partial \\mathrm{pH}_{\\mathrm{end}}}$:\n    $$V_{a}+V_{\\mathrm{end}} = 0.025000\\,\\mathrm{L} + 0.024960\\,\\mathrm{L} = 0.049960\\,\\mathrm{L}$$\n    $$\\dfrac{\\partial V_{\\mathrm{end}}}{\\partial \\mathrm{pH}_{\\mathrm{end}}} = \\dfrac{2(0.049960\\,\\mathrm{L})}{0.10000\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}} (1.0 \\times 10^{-7}\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}) (2.302585)$$\n    $$\\dfrac{\\partial V_{\\mathrm{end}}}{\\partial \\mathrm{pH}_{\\mathrm{end}}} \\approx 2.30078 \\times 10^{-7}\\,\\mathrm{L}$$\n\n3.  Calculate the individual squared uncertainty components for $u^2(C_{a,\\mathrm{est}})$:\n    -   Component from $u(C_{b})$:\n        $$u_1^2 = \\left(\\dfrac{V_{\\mathrm{end}}}{V_{a}}\\right)^2 u^2(C_{b}) = (0.9984)^2 (0.00010\\,\\mathrm{mol}\\,\\mathrm{L}^{-1})^2 \\approx 9.968 \\times 10^{-9}\\,\\mathrm{mol}^2\\,\\mathrm{L}^{-2}$$\n    -   Component from $u(V_{\\mathrm{b}})$:\n        $$u_2^2 = \\left(\\dfrac{C_{b}}{V_{a}}\\right)^2 u^2(V_{\\mathrm{b}}) = (4.0000\\,\\mathrm{mol}\\,\\mathrm{L}^{-2})^2 (0.000020\\,\\mathrm{L})^2 = 6.400 \\times 10^{-9}\\,\\mathrm{mol}^2\\,\\mathrm{L}^{-2}$$\n    -   Component from $u(\\mathrm{pH}_{\\mathrm{end}})$:\n        $$u_3^2 = \\left(\\dfrac{C_{b}}{V_{a}}\\right)^2 \\left(\\dfrac{\\partial V_{\\mathrm{end}}}{\\partial \\mathrm{pH}_{\\mathrm{end}}}\\right)^2 u^2(\\mathrm{pH}_{\\mathrm{end}})$$\n        $$u_3^2 = (4.0000\\,\\mathrm{mol}\\,\\mathrm{L}^{-2})^2 (2.30078 \\times 10^{-7}\\,\\mathrm{L})^2 (0.10)^2 \\approx 8.47 \\times 10^{-15}\\,\\mathrm{mol}^2\\,\\mathrm{L}^{-2}$$\n\n4.  Sum the components to find the total variance:\n    $$u^2(C_{a,\\mathrm{est}}) = u_1^2 + u_2^2 + u_3^2$$\n    $$u^2(C_{a,\\mathrm{est}}) \\approx (9.968 \\times 10^{-9}) + (6.400 \\times 10^{-9}) + (8.47 \\times 10^{-15})\\,\\mathrm{mol}^2\\,\\mathrm{L}^{-2}$$\n    $$u^2(C_{a,\\mathrm{est}}) \\approx 1.6368 \\times 10^{-8}\\,\\mathrm{mol}^2\\,\\mathrm{L}^{-2}$$\n    The contribution from the $\\mathrm{pH}$ uncertainty is negligible compared to the other two sources.\n\n5.  Calculate the final standard uncertainty:\n    $$u(C_{a,\\mathrm{est}}) = \\sqrt{1.6368 \\times 10^{-8}}\\,\\mathrm{mol}\\,\\mathrm{L}^{-1} \\approx 1.2794 \\times 10^{-4}\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$$\n\nRounding to four significant figures as required, the standard uncertainty is $1.279 \\times 10^{-4}\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$.", "answer": "$$\n\\boxed{1.279 \\times 10^{-4}}\n$$", "id": "2917984"}, {"introduction": "Classical titrimetric analysis often relies on identifying a single endpoint, discarding the rich information contained in the data leading up to it. This advanced computational practice [@problem_id:2918052] introduces a modern, powerful alternative based on Bayesian statistics. You will develop a model that sequentially updates the probability distribution for the equivalence volume as each colorimetric data point is collected, providing a more robust estimate and a more nuanced understanding of its uncertainty compared to traditional methods.", "problem": "You are to design and implement a complete, runnable program that estimates the equivalence volume from sequential colorimetric readings of an acid–base indicator during a titration, using a Bayesian update model, and compares the resulting posterior uncertainty against a classical first-order propagation-of-uncertainty calculation. The design must start from the following fundamental base: the Henderson–Hasselbalch relationship for indicators and a local linearization of the titration curve near the equivalence point.\n\nDefinitions and modeling assumptions to use as the fundamental base:\n1. The acid–base indicator obeys the Henderson–Hasselbalch relationship in the form $ \\mathrm{pH} = \\mathrm{p}K_a^{\\mathrm{ind}} + \\log_{10}\\!\\left(\\dfrac{[\\mathrm{In}^-]}{[\\mathrm{HIn}]}\\right) $. Define the fraction of the deprotonated (basic-colored) form as $ f = \\dfrac{[\\mathrm{In}^-]}{[\\mathrm{In}^-] + [\\mathrm{HIn}]} $. Then $ f = \\dfrac{1}{1 + 10^{\\mathrm{p}K_a^{\\mathrm{ind}} - \\mathrm{pH}}} $.\n2. Near the equivalence point, approximate the titration curve by a first-order Taylor expansion of $ \\mathrm{pH}(V) $ in the added titrant volume $ V $ about the equivalence volume $ V_e $, so that $ \\mathrm{pH}(V) \\approx \\mathrm{pH}_e + S\\,(V - V_e) $, where $ S $ is the local slope in $\\mathrm{pH}$ units per $\\mathrm{mL}$. This is a standard, local linearization justified by smoothness of the titration curve and finite buffer capacity in a small neighborhood around $ V_e $ for weak-acid/strong-base or weak-base/strong-acid systems.\n3. A colorimetric reading $ y_i $ at added volume $ V_i $ is modeled as a noisy observation of $ f(V_i) $: $ y_i = f(V_i) + \\varepsilon_i $ with $ \\varepsilon_i \\sim \\mathcal{N}(0, \\sigma_y^2) $ and independent across $ i $.\n\nYour tasks:\n1. Bayesian model:\n   - Use a univariate Normal prior $ V_e \\sim \\mathcal{N}(\\mu_0, \\sigma_0^2) $ on the equivalence volume $ V_e $ in $\\mathrm{mL}$.\n   - Under the model above, the likelihood for $ V_e $ given a reading $ (V_i, y_i) $ is $ \\mathcal{N}(y_i \\mid f(V_i; V_e), \\sigma_y^2) $ where $ f(V; V_e) = \\dfrac{1}{1 + 10^{\\mathrm{p}K_a^{\\mathrm{ind}} - (\\mathrm{pH}_e + S\\,(V - V_e))}} $.\n   - Update the prior sequentially with the provided readings in the given order to obtain the final posterior for $ V_e $. You must compute the posterior numerically on a uniform grid over $ [\\mu_0 - 5\\sigma_0, \\mu_0 + 5\\sigma_0] $ $\\mathrm{mL}$ with grid spacing $ 0.0005 $ $\\mathrm{mL}$, normalizing at each step to a proper discrete probability distribution. Report the final posterior mean and standard deviation of $ V_e $ in $\\mathrm{mL}$.\n\n2. Classical propagation:\n   - From the Henderson–Hasselbalch mapping and the linearized titration curve, algebraically invert $ y \\mapsto V $ to obtain, for each reading, a point estimate $ \\widehat{V}_{e,i} $ and then combine the $ \\widehat{V}_{e,i} $ optimally assuming independent, homoscedastic colorimetric noise. Use first-order (delta method) propagation from $ y $ to $ \\widehat{V}_e $ to derive the variance $ \\sigma_{V_e,i}^2 $ for each reading. Combine the per-reading estimates by inverse-variance weighting to obtain a single classical estimate with combined standard deviation $ \\sigma_{V_e,\\mathrm{class}} $ in $\\mathrm{mL}$. Your program must report this combined classical standard deviation.\n\n3. Output specification:\n   - For each test case below, output a list of three floats $ [\\mu_{\\mathrm{post}}, \\sigma_{\\mathrm{post}}, \\sigma_{V_e,\\mathrm{class}}] $ in $\\mathrm{mL}$, where $ \\mu_{\\mathrm{post}} $ and $ \\sigma_{\\mathrm{post}} $ are the posterior mean and posterior standard deviation for $ V_e $ from the Bayesian update, and $ \\sigma_{V_e,\\mathrm{class}} $ is the classical combined standard deviation. Round each float to $ 4 $ decimal places.\n   - Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each element is itself a list of three floats, for example $ [[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3]] $.\n\nPhysical units and numerical precision:\n- Express all volumes in $\\mathrm{mL}$ and all standard deviations in $\\mathrm{mL}$.\n- All color fractions $ y_i $ are dimensionless.\n- Use base-$10$ logarithms where applicable, and ensure numerical stability in the Bayesian computation via log-likelihood accumulation and renormalization at each step.\n\nTest suite:\nProvide results for the following three cases. In each case, use the readings in the given order for the sequential Bayesian update.\n\n- Case A (moderate slope, well-matched indicator):\n  - Indicator parameter: $ \\mathrm{p}K_a^{\\mathrm{ind}} = 8.70 $.\n  - Linearized titration parameters: $ \\mathrm{pH}_e = 8.72 $, $ S = 0.50 $ $\\mathrm{pH}/\\mathrm{mL} $.\n  - Measurement noise: $ \\sigma_y = 0.02 $ (dimensionless).\n  - Prior on $ V_e $: $ \\mu_0 = 25.2 $ $\\mathrm{mL}$, $ \\sigma_0 = 0.4 $ $\\mathrm{mL}$.\n  - Added volumes (in $\\mathrm{mL}$): $ [23.5, 24.5, 24.9, 25.1, 25.5, 26.5] $.\n  - Observed color fractions $ y $: $ [0.1515, 0.3807, 0.4744, 0.5443, 0.6447, 0.8667] $.\n\n- Case B (steep slope, tightly spaced readings):\n  - Indicator parameter: $ \\mathrm{p}K_a^{\\mathrm{ind}} = 8.70 $.\n  - Linearized titration parameters: $ \\mathrm{pH}_e = 8.72 $, $ S = 1.00 $ $\\mathrm{pH}/\\mathrm{mL} $.\n  - Measurement noise: $ \\sigma_y = 0.015 $ (dimensionless).\n  - Prior on $ V_e $: $ \\mu_0 = 25.1 $ $\\mathrm{mL}$, $ \\sigma_0 = 0.3 $ $\\mathrm{mL}$.\n  - Added volumes (in $\\mathrm{mL}$): $ [24.8, 24.95, 25.0, 25.05, 25.2] $.\n  - Observed color fractions $ y $: $ [0.3930, 0.4864, 0.5058, 0.5473, 0.6218] $.\n\n- Case C (indicator far from endpoint, weakly informative data):\n  - Indicator parameter: $ \\mathrm{p}K_a^{\\mathrm{ind}} = 10.00 $.\n  - Linearized titration parameters: $ \\mathrm{pH}_e = 8.72 $, $ S = 0.50 $ $\\mathrm{pH}/\\mathrm{mL} $.\n  - Measurement noise: $ \\sigma_y = 0.01 $ (dimensionless).\n  - Prior on $ V_e $: $ \\mu_0 = 25.0 $ $\\mathrm{mL}$, $ \\sigma_0 = 0.5 $ $\\mathrm{mL}$.\n  - Added volumes (in $\\mathrm{mL}$): $ [24.0, 24.5, 25.0, 25.5, 26.0] $.\n  - Observed color fractions $ y $: $ [0.0183, 0.0245, 0.0529, 0.0835, 0.1480] $.\n\nFinal output format:\n- Print one line: a single list whose elements are the three-number lists for the cases above, in the same order A, B, C. Each number must be rounded to $ 4 $ decimal places. For example: $ [[25.0123,0.0521,0.0540],[\\dots],[\\dots]] $.", "solution": "The problem statement has been rigorously validated and is determined to be scientifically sound, well-posed, and free of contradictions or ambiguities. It presents a formal problem in computational statistics as applied to analytical chemistry. The data and parameters provided are realistic and serve to test the robustness of the implemented models under varying conditions. I will therefore proceed with a complete solution.\n\nThe solution is conceptualized in two distinct parts, as directed: first, a Bayesian sequential estimation of the equivalence volume $V_e$, and second, a classical estimation based on first-order uncertainty propagation.\n\n**Part 1: Bayesian Sequential Estimation**\n\nThe core of the Bayesian approach is the iterative application of Bayes' theorem to update our knowledge about the parameter of interest, $V_e$, as new data become available.\n\nThe state of knowledge about $V_e$ is represented by a probability distribution. We begin with a prior distribution, $P(V_e)$, which is given as a Normal distribution:\n$$\nV_e \\sim \\mathcal{N}(\\mu_0, \\sigma_0^2)\n$$\nFor each measurement $y_i$ taken at a known titrant volume $V_i$, we compute a likelihood, $P(y_i | V_e)$. This term quantifies how probable the observed measurement $y_i$ is for any given hypothetical value of $V_e$. The problem defines the observation model as $y_i = f(V_i; V_e) + \\varepsilon_i$, where $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma_y^2)$. The likelihood is therefore a Normal distribution centered on the theoretically predicted color fraction $f(V_i; V_e)$:\n$$\nP(y_i | V_e) = \\mathcal{N}(y_i | f(V_i; V_e), \\sigma_y^2) = \\frac{1}{\\sqrt{2\\pi}\\sigma_y} \\exp\\left(-\\frac{(y_i - f(V_i; V_e))^2}{2\\sigma_y^2}\\right)\n$$\nThe function $f(V_i; V_e)$ is a composite of the linearized titration curve and the Henderson-Hasselbalch relationship for the indicator:\n$$\n\\mathrm{pH}(V_i; V_e) = \\mathrm{pH}_e + S(V_i - V_e)\n$$\n$$\nf(V_i; V_e) = \\frac{1}{1 + 10^{\\mathrm{p}K_a^{\\mathrm{ind}} - \\mathrm{pH}(V_i; V_e)}} = \\frac{1}{1 + 10^{\\mathrm{p}K_a^{\\mathrm{ind}} - (\\mathrm{pH}_e + S(V_i - V_e))}}\n$$\nWith each new data point $(V_i, y_i)$, the posterior distribution from the previous step becomes the prior for the current step. The update rule is:\n$$\nP(V_e | y_{1..i}) \\propto P(V_e | y_{1..i-1}) \\cdot P(y_i | V_e)\n$$\nwhere $P(V_e | y_{1..0}) \\equiv P(V_e)$ is the initial prior.\n\nFor numerical implementation, we discretize the continuous parameter $V_e$ onto a uniform grid as specified, from $\\mu_0 - 5\\sigma_0$ to $\\mu_0 + 5\\sigma_0$ with spacing $0.0005$ $\\mathrm{mL}$. The algorithm proceeds as follows:\n1.  **Initialization**: Create the grid of $V_e$ values. The initial prior probability mass on each grid point $V_{e,j}$ is calculated from the PDF of $\\mathcal{N}(\\mu_0, \\sigma_0^2)$. For numerical stability, we work with log-probabilities. The initial log-posterior is the log-prior: $\\log P_0(V_{e,j}) = -\\frac{1}{2}\\left(\\frac{V_{e,j} - \\mu_0}{\\sigma_0}\\right)^2$.\n2.  **Sequential Update**: For each observation $(V_i, y_i)$ from $i=1$ to $N$:\n    a.  Calculate the log-likelihood $\\log P(y_i | V_{e,j})$ for each grid point $V_{e,j}$: $\\log \\mathcal{L}_j = -\\frac{1}{2}\\left(\\frac{y_i - f(V_i; V_{e,j})}{\\sigma_y}\\right)^2$.\n    b.  Add the log-likelihood to the current log-posterior: $\\log P_i(V_{e,j}) = \\log P_{i-1}(V_{e,j}) + \\log \\mathcal{L}_j$.\n    c.  Normalize the posterior to ensure it remains a valid probability distribution and to prevent numerical underflow. This is done by converting from log-probabilities to probabilities, summing them, and dividing by the sum. The log-sum-exp trick (subtracting the maximum log-probability before exponentiating) is used to maintain precision.\n3.  **Final Calculation**: After all $N$ observations are processed, the final discrete posterior distribution $P_N(V_e)$ is used to compute the posterior mean $\\mu_{\\mathrm{post}}$ and standard deviation $\\sigma_{\\mathrm{post}}$:\n$$\n\\mu_{\\mathrm{post}} = \\sum_j V_{e,j} \\cdot P_N(V_{e,j})\n$$\n$$\n\\sigma_{\\mathrm{post}} = \\sqrt{\\sum_j (V_{e,j} - \\mu_{\\mathrm{post}})^2 \\cdot P_N(V_{e,j})}\n$$\n\n**Part 2: Classical Propagation of Uncertainty**\n\nThis method involves two steps: first, inverting the model to derive a point estimate for $V_e$ from each measurement, and second, combining these estimates optimally.\n\n1.  **Inversion**: We algebraically solve the model equation $y = f(V; V_e)$ for $V_e$. Starting with $y = (1 + 10^{\\mathrm{p}K_a^{\\mathrm{ind}} - \\mathrm{pH}})^{-1}$, we find $\\mathrm{pH} = \\mathrm{p}K_a^{\\mathrm{ind}} + \\log_{10}(y/(1-y))$. Substituting the linear pH model, $\\mathrm{pH}_e + S(V - V_e) = \\mathrm{p}K_a^{\\mathrm{ind}} + \\log_{10}(y/(1-y))$, and solving for $V_e$ gives the estimator for the $i$-th measurement:\n$$\n\\widehat{V}_{e,i} = g(y_i) = V_i - \\frac{1}{S} \\left[ (\\mathrm{p}K_a^{\\mathrm{ind}} - \\mathrm{pH}_e) + \\log_{10}\\left(\\frac{y_i}{1-y_i}\\right) \\right]\n$$\n\n2.  **Uncertainty Propagation**: The uncertainty in $y_i$, given by $\\sigma_y$, propagates to an uncertainty in $\\widehat{V}_{e,i}$. Using a first-order Taylor expansion (the delta method), the variance of $\\widehat{V}_{e,i}$ is:\n$$\n\\sigma_{V_e,i}^2 \\approx \\left( \\frac{dg}{dy_i} \\right)^2 \\sigma_y^2\n$$\nThe derivative is calculated as:\n$$\n\\frac{dg}{dy_i} = -\\frac{1}{S} \\frac{d}{dy_i}\\left(\\frac{\\ln(y_i/(1-y_i))}{\\ln 10}\\right) = -\\frac{1}{S \\ln 10} \\left(\\frac{1}{y_i} + \\frac{1}{1-y_i}\\right) = -\\frac{1}{S \\ln(10) y_i(1-y_i)}\n$$\nThus, the variance for each estimate is:\n$$\n\\sigma_{V_e,i}^2 = \\frac{\\sigma_y^2}{S^2(\\ln 10)^2 y_i^2 (1-y_i)^2}\n$$\n\n3.  **Combination of Estimates**: Assuming the measurement errors $\\varepsilon_i$ are independent, the optimal way to combine the individual estimates $\\widehat{V}_{e,i}$ is by inverse-variance weighting. The variance of the combined estimator is the reciprocal of the sum of the individual inverse variances (weights):\n$$\n\\frac{1}{\\sigma_{V_e,\\mathrm{class}}^2} = \\sum_i \\frac{1}{\\sigma_{V_e,i}^2} = \\sum_i \\frac{S^2(\\ln 10)^2 y_i^2 (1-y_i)^2}{\\sigma_y^2}\n$$\nSolving for the combined standard deviation gives the final expression:\n$$\n\\sigma_{V_e,\\mathrm{class}} = \\left( \\sum_i \\frac{1}{\\sigma_{V_e,i}^2} \\right)^{-1/2} = \\frac{\\sigma_y}{|S| \\ln 10} \\left( \\sum_i y_i^2 (1-y_i)^2 \\right)^{-1/2}\n$$\nThis formula is implemented to compute the classical uncertainty. The provided code structure adheres to these derived principles.", "answer": "```python\nimport numpy as np\n\ndef _solve_one_case(params):\n    \"\"\"\n    Solves a single test case for both Bayesian and classical estimates.\n    \"\"\"\n    pKa_ind = params['pKa_ind']\n    pH_e = params['pH_e']\n    S = params['S']\n    sigma_y = params['sigma_y']\n    mu0 = params['mu0']\n    sigma0 = params['sigma0']\n    V_data = np.array(params['V_data'])\n    y_data = np.array(params['y_data'])\n\n    # === Part 1: Bayesian Sequential Estimation ===\n\n    # 1. Define the grid for V_e\n    grid_start = mu0 - 5 * sigma0\n    grid_end = mu0 + 5 * sigma0\n    grid_step = 0.0005\n    # Use linspace to ensure the grid includes endpoints and has the correct spacing\n    num_points = int(round((grid_end - grid_start) / grid_step)) + 1\n    v_e_grid = np.linspace(grid_start, grid_end, num_points)\n\n    # 2. Initialize the prior distribution on the grid (in log-space)\n    log_posterior = -0.5 * ((v_e_grid - mu0) / sigma0)**2\n\n    # 3. Sequentially update the posterior for each data point\n    for V_i, y_i in zip(V_data, y_data):\n        # Calculate theoretical color fraction f for all V_e in grid\n        ph_i_grid = pH_e + S * (V_i - v_e_grid)\n        f_i_grid = 1.0 / (1.0 + 10**(pKa_ind - ph_i_grid))\n        \n        # Calculate log-likelihood for the current data point\n        log_likelihood = -0.5 * ((y_i - f_i_grid) / sigma_y)**2\n        \n        # Update log-posterior\n        log_posterior += log_likelihood\n\n        # Normalize to prevent numerical underflow/overflow (log-sum-exp trick)\n        log_posterior -= np.max(log_posterior)\n        posterior = np.exp(log_posterior)\n        posterior /= np.sum(posterior)\n        log_posterior = np.log(posterior + 1e-100) # add small const to avoid log(0)\n\n    # The final probability distribution is the last computed 'posterior'\n    final_posterior = posterior\n\n    # 4. Calculate posterior mean and standard deviation\n    mu_post = np.sum(v_e_grid * final_posterior)\n    var_post = np.sum((v_e_grid - mu_post)**2 * final_posterior)\n    sigma_post = np.sqrt(var_post)\n\n    # === Part 2: Classical Propagation of Uncertainty ===\n    \n    # Use the derived formula for combined classical standard deviation\n    # sigma_class = (sigma_y / (|S| * ln(10))) / sqrt(sum(y_i^2 * (1-y_i)^2))\n    sum_term = np.sum(y_data**2 * (1 - y_data)**2)\n    denominator = np.abs(S) * np.log(10) * np.sqrt(sum_term)\n    sigma_class = sigma_y / denominator\n\n    # 5. Return rounded results\n    return [round(mu_post, 4), round(sigma_post, 4), round(sigma_class, 4)]\n    \ndef solve():\n    \"\"\"\n    Main function to define test cases, run the solver, and print results.\n    \"\"\"\n    test_cases = [\n        {\n            'name': 'Case A',\n            'pKa_ind': 8.70, 'pH_e': 8.72, 'S': 0.50, 'sigma_y': 0.02,\n            'mu0': 25.2, 'sigma0': 0.4,\n            'V_data': [23.5, 24.5, 24.9, 25.1, 25.5, 26.5],\n            'y_data': [0.1515, 0.3807, 0.4744, 0.5443, 0.6447, 0.8667]\n        },\n        {\n            'name': 'Case B',\n            'pKa_ind': 8.70, 'pH_e': 8.72, 'S': 1.00, 'sigma_y': 0.015,\n            'mu0': 25.1, 'sigma0': 0.3,\n            'V_data': [24.8, 24.95, 25.0, 25.05, 25.2],\n            'y_data': [0.3930, 0.4864, 0.5058, 0.5473, 0.6218]\n        },\n        {\n            'name': 'Case C',\n            'pKa_ind': 10.00, 'pH_e': 8.72, 'S': 0.50, 'sigma_y': 0.01,\n            'mu0': 25.0, 'sigma0': 0.5,\n            'V_data': [24.0, 24.5, 25.0, 25.5, 26.0],\n            'y_data': [0.0183, 0.0245, 0.0529, 0.0835, 0.1480]\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = _solve_one_case(case)\n        all_results.append(result)\n\n    # Print the final result in the exact specified format\n    print(str(all_results).replace(' ', ''))\n\nsolve()\n```", "id": "2918052"}]}