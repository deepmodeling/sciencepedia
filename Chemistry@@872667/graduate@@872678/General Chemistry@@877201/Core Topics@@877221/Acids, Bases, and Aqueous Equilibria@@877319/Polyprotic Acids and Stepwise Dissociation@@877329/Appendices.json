{"hands_on_practices": [{"introduction": "Advanced problem-solving in chemical equilibrium often begins not with brute-force calculation, but with keen chemical intuition. This practice hones your ability to perform a dominant-balance analysis, a powerful technique for simplifying complex systems by identifying the most significant chemical species and equilibria in a specific pH range [@problem_id:2951933]. Mastering this skill allows you to quickly estimate the state of a solution and build a robust framework for more detailed quantitative analysis.", "problem": "A triprotic acid $\\mathrm{H_3A}$ has stepwise acid dissociation constants characterized by $pK_{a1} = 2.00$, $pK_{a2} = 6.80$, and $pK_{a3} = 11.80$ at $25~^{\\circ}\\mathrm{C}$. An aqueous solution is prepared by dissolving the pure acid at an analytical concentration $C_T = 10^{-4}\\ \\mathrm{M}$ in pure water (no added salts). Consider the interior $\\mathrm{pH}$ region defined by $pK_{a1}+1 \\le \\mathrm{pH} \\le pK_{a2}-1$. Using a dominant-balance analysis grounded in the definitions of stepwise dissociation equilibria, water autoprotolysis, mass balance, and electroneutrality (charge balance), which option correctly identifies the leading terms to be retained in the charge balance for this solution in that $\\mathrm{pH}$ region and the resulting leading-order scaling for $\\mathrm{pH}$ with the given parameters?\n\nA. In this $\\mathrm{pH}$ region, the charge balance is dominated by $\\left[\\mathrm{H}^+\\right]$ on the left and $\\left[\\mathrm{H_2A^-}\\right]$ on the right, with $\\left[\\mathrm{OH^-}\\right]$, $\\left[\\mathrm{HA^{2-}}\\right]$, and $\\left[\\mathrm{A^{3-}}\\right]$ negligible; mass balance gives $\\left[\\mathrm{H_2A^-}\\right] \\sim C_T$, so $\\left[\\mathrm{H}^+\\right] \\sim C_T$ and $\\mathrm{pH} \\approx -\\log_{10} C_T \\approx 4.00$.\n\nB. In this $\\mathrm{pH}$ region, the amphiprotic character of $\\mathrm{H_2A^-}$ fixes $\\left[\\mathrm{H}^+\\right] \\sim \\sqrt{K_{a1}K_{a2}}$ independent of $C_T$, so the leading-order charge balance retains $\\left[\\mathrm{H_2A^-}\\right]$ and $\\left[\\mathrm{HA^{2-}}\\right]$ while neglecting $\\left[\\mathrm{OH^-}\\right]$, giving $\\mathrm{pH} \\approx \\left(pK_{a1}+pK_{a2}\\right)/2 \\approx 4.40$.\n\nC. In this $\\mathrm{pH}$ region, the first dissociation alone controls the charge balance, so $\\left[\\mathrm{H}^+\\right] \\sim K_{a1}$ and $\\mathrm{pH} \\approx pK_{a1} \\approx 2.00$, with all conjugate-base terms negligible.\n\nD. In this $\\mathrm{pH}$ region, water autoprotolysis dominates the charge balance so that $\\left[\\mathrm{H}^+\\right] \\approx \\left[\\mathrm{OH^-}\\right]$, and the acid contributes negligibly; hence $\\mathrm{pH} \\approx 7.00$ regardless of $C_T$, $K_{a1}$, $K_{a2}$, and $K_{a3}$.", "solution": "The problem statement must first be validated for scientific and logical integrity.\n\n**Step 1: Extract Givens**\n- **System:** A triprotic acid, $\\mathrm{H_3A}$, in aqueous solution.\n- **Thermodynamic Data:** Stepwise acid dissociation constants at $25~^{\\circ}\\mathrm{C}$ are given as $pK_{a1} = 2.00$, $pK_{a2} = 6.80$, and $pK_{a3} = 11.80$. This implies $K_{a1} = 10^{-2.00}$, $K_{a2} = 10^{-6.80}$, and $K_{a3} = 10^{-11.80}$. The temperature implies the autoprotolysis constant of water is $K_w = 10^{-14.00}$.\n- **Concentration:** The analytical concentration of the acid is $C_T = 10^{-4}\\ \\mathrm{M}$.\n- **Condition:** The solution is prepared in pure water with no other salts added.\n- **Region of Interest:** The analysis is to be performed in the $\\mathrm{pH}$ range defined by $pK_{a1}+1 \\le \\mathrm{pH} \\le pK_{a2}-1$. Numerically, this corresponds to the range $3.00 \\le \\mathrm{pH} \\le 5.80$.\n- **Required Analysis:** A dominant-balance analysis based on fundamental principles (equilibria, mass balance, charge balance) to identify leading terms in the charge balance and the resulting $\\mathrm{pH}$ scaling.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded. The concept of stepwise dissociation of a polyprotic acid is a standard topic in general and analytical chemistry. The provided $pK_a$ values are realistic; for example, they are close to those of phosphoric acid ($\\mathrm{H_3PO_4}$). The problem is well-posed, providing all necessary information ($C_T$ and all $K_a$ values) to determine the equilibrium state of the system. The language is objective and precise. The task is to apply a standard approximation method (dominant-balance analysis) within a specified, mathematically consistent region. The problem setup does not violate any fundamental principles and is not incomplete, contradictory, or ambiguous.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. A solution will be derived.\n\n**Derivation**\n\nThe fundamental governing equations for this system are:\n1.  **Chemical Equilibria:**\n    $$ \\mathrm{H_3A} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{H_2A^-} + \\mathrm{H_3O^+} \\quad K_{a1} = \\frac{\\left[\\mathrm{H_2A^-}\\right]\\left[\\mathrm{H}^+\\right]}{\\left[\\mathrm{H_3A}\\right]} = 10^{-2.00} $$\n    $$ \\mathrm{H_2A^-} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{HA^{2-}} + \\mathrm{H_3O^+} \\quad K_{a2} = \\frac{\\left[\\mathrm{HA^{2-}}\\right]\\left[\\mathrm{H}^+\\right]}{\\left[\\mathrm{H_2A^-}\\right]} = 10^{-6.80} $$\n    $$ \\mathrm{HA^{2-}} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{A^{3-}} + \\mathrm{H_3O^+} \\quad K_{a3} = \\frac{\\left[\\mathrm{A^{3-}}\\right]\\left[\\mathrm{H}^+\\right]}{\\left[\\mathrm{HA^{2-}}\\right]} = 10^{-11.80} $$\n    $$ 2\\mathrm{H_2O} \\rightleftharpoons \\mathrm{H_3O^+} + \\mathrm{OH^-} \\quad K_w = \\left[\\mathrm{H}^+\\right]\\left[\\mathrm{OH^-}\\right] = 10^{-14.00} $$\n    Here, $\\left[\\mathrm{H}^+\\right]$ is used as a shorthand for $\\left[\\mathrm{H_3O^+}\\right]$.\n\n2.  **Mass Balance:** The total concentration of all species containing the conjugate base 'A' must equal the initial analytical concentration, $C_T$.\n    $$ C_T = \\left[\\mathrm{H_3A}\\right] + \\left[\\mathrm{H_2A^-}\\right] + \\left[\\mathrm{HA^{2-}}\\right] + \\left[\\mathrm{A^{3-}}\\right] = 10^{-4}\\ \\mathrm{M} $$\n\n3.  **Charge Balance (Electroneutrality):** The sum of the molar concentrations of positive charges must equal the sum of the molar concentrations of negative charges.\n    $$ \\left[\\mathrm{H}^+\\right] = \\left[\\mathrm{OH^-}\\right] + \\left[\\mathrm{H_2A^-}\\right] + 2\\left[\\mathrm{HA^{2-}}\\right] + 3\\left[\\mathrm{A^{3-}}\\right] $$\n\nThe problem directs us to perform a dominant-balance analysis within the specified $\\mathrm{pH}$ range of $3.00 \\le \\mathrm{pH} \\le 5.80$. We first analyze the distribution of the acid-derived species in this region. The relative fractions of adjacent species are governed by the ratios $\\left[\\mathrm{H}^+\\right]/K_a$.\n\n-   **Ratio of $\\left[\\mathrm{H_3A}\\right]$ to $\\left[\\mathrm{H_2A^-}\\right]$:**\n    $$ \\frac{\\left[\\mathrm{H_3A}\\right]}{\\left[\\mathrm{H_2A^-}\\right]} = \\frac{\\left[\\mathrm{H}^+\\right]}{K_{a1}} $$\n    Since the $\\mathrm{pH}$ region is $3.00 \\le \\mathrm{pH} \\le 5.80$, we have $10^{-5.80} \\le \\left[\\mathrm{H}^+\\right] \\le 10^{-3.00}$. The value of $K_{a1}$ is $10^{-2.00}$. Thus, the ratio $\\left[\\mathrm{H}^+\\right]/K_{a1}$ is in the range $[10^{-3.80}, 10^{-1.00}]$. This means that $\\left[\\mathrm{H_3A}\\right]$ is at most $10\\%$ of $\\left[\\mathrm{H_2A^-}\\right]$ (at $\\mathrm{pH}=3.00$) and is significantly smaller at higher $\\mathrm{pH}$ values within the range. Thus, $\\left[\\mathrm{H_3A}\\right]$ is a minor species compared to $\\left[\\mathrm{H_2A^-}\\right]$.\n\n-   **Ratio of $\\left[\\mathrm{HA^{2-}}\\right]$ to $\\left[\\mathrm{H_2A^-}\\right]$:**\n    $$ \\frac{\\left[\\mathrm{HA^{2-}}\\right]}{\\left[\\mathrm{H_2A^-}\\right]} = \\frac{K_{a2}}{\\left[\\mathrm{H}^+\\right]} $$\n    The value of $K_{a2}$ is $10^{-6.80}$. In the given $\\mathrm{pH}$ range, the ratio $K_{a2}/\\left[\\mathrm{H}^+\\right]$ is in the range $[10^{-3.80}, 10^{-1.00}]$. This means that $\\left[\\mathrm{HA^{2-}}\\right]$ is at most $10\\%$ of $\\left[\\mathrm{H_2A^-}\\right]$ (at $\\mathrm{pH}=5.80$) and is significantly smaller at lower $\\mathrm{pH}$ values within the range. Thus, $\\left[\\mathrm{HA^{2-}}\\right]$ is also a minor species compared to $\\left[\\mathrm{H_2A^-}\\right]$.\n\n-   Since $\\left[\\mathrm{HA^{2-}}\\right]$ is minor, $\\left[\\mathrm{A^{3-}}\\right]$ must be negligible, as $\\left[\\mathrm{A^{3-}}\\right]/\\left[\\mathrm{HA^{2-}}\\right] = K_{a3}/\\left[\\mathrm{H}^+\\right] \\ll 1$ in this $\\mathrm{pH}$ range.\n\nGiven that $\\left[\\mathrm{H_3A}\\right]$, $\\left[\\mathrm{HA^{2-}}\\right]$, and $\\left[\\mathrm{A^{3-}}\\right]$ are all minor species compared to $\\left[\\mathrm{H_2A^-}\\right]$ in the specified $\\mathrm{pH}$ region, the mass balance equation simplifies to:\n$$ C_T \\approx \\left[\\mathrm{H_2A^-}\\right] $$\n\nNow we analyze the charge balance equation: $\\left[\\mathrm{H}^+\\right] = \\left[\\mathrm{OH^-}\\right] + \\left[\\mathrm{H_2A^-}\\right] + 2\\left[\\mathrm{HA^{2-}}\\right] + 3\\left[\\mathrm{A^{3-}}\\right]$.\n-   **$\\left[\\mathrm{OH^-}\\right]$:** In the range $3.00 \\le \\mathrm{pH} \\le 5.80$, $\\left[\\mathrm{H}^+\\right]$ is at least $10^{-5.80} \\mathrm{M}$, while $\\left[\\mathrm{OH^-}\\right]$ is at most $10^{-8.20} \\mathrm{M}$. Thus, $\\left[\\mathrm{OH^-}\\right]$ is negligible compared to $\\left[\\mathrm{H}^+\\right]$.\n-   **Terms from the acid:** We already established that $\\left[\\mathrm{HA^{2-}}\\right]$ and $\\left[\\mathrm{A^{3-}}\\right]$ are small compared to $\\left[\\mathrm{H_2A^-}\\right]$. Specifically, $\\left[\\mathrm{HA^{2-}}\\right]  0.1 \\left[\\mathrm{H_2A^-}\\right]$ and $3\\left[\\mathrm{A^{3-}}\\right]$ is even smaller. Therefore, the dominant term on the right-hand side from the acid species is $\\left[\\mathrm{H_2A^-}\\right]$.\n\nThe simplified charge balance equation becomes:\n$$ \\left[\\mathrm{H}^+\\right] \\approx \\left[\\mathrm{H_2A^-}\\right] $$\n\nCombining the results from the simplified mass balance and charge balance:\n$$ \\left[\\mathrm{H}^+\\right] \\approx \\left[\\mathrm{H_2A^-}\\right] \\approx C_T $$\nSubstituting the given value for $C_T$:\n$$ \\left[\\mathrm{H}^+\\right] \\approx 10^{-4}\\ \\mathrm{M} $$\nThis leads to a $\\mathrm{pH}$ estimate of:\n$$ \\mathrm{pH} \\approx -\\log_{10}(10^{-4}) = 4.00 $$\nThis calculated $\\mathrm{pH}$ of $4.00$ lies within the specified analysis range of $3.00 \\le \\mathrm{pH} \\le 5.80$, which confirms the self-consistency of our approximations and analysis.\n\n**Option-by-Option Analysis**\n\n**A. In this $\\mathrm{pH}$ region, the charge balance is dominated by $\\left[\\mathrm{H}^+\\right]$ on the left and $\\left[\\mathrm{H_2A^-}\\right]$ on the right, with $\\left[\\mathrm{OH^-}\\right]$, $\\left[\\mathrm{HA^{2-}}\\right]$, and $\\left[\\mathrm{A^{3-}}\\right]$ negligible; mass balance gives $\\left[\\mathrm{H_2A^-}\\right] \\sim C_T$, so $\\left[\\mathrm{H}^+\\right] \\sim C_T$ and $\\mathrm{pH} \\approx -\\log_{10} C_T \\approx 4.00$.**\nThis statement perfectly matches our derivation. The dominant balance analysis shows that in the specified $\\mathrm{pH}$ region, $\\left[\\mathrm{H_2A^-}\\right]$ is the principal species derived from the acid, making $\\left[\\mathrm{H_2A^-}\\right] \\approx C_T$. The charge balance simplification to $\\left[\\mathrm{H}^+\\right] \\approx \\left[\\mathrm{H_2A^-}\\right]$ is also correct. The conclusion that $\\left[\\mathrm{H}^+\\right] \\approx C_T$ and $\\mathrm{pH} \\approx 4.00$ is the logical outcome.\nVerdict: **Correct**.\n\n**B. In this $\\mathrm{pH}$ region, the amphiprotic character of $\\mathrm{H_2A^-}$ fixes $\\left[\\mathrm{H}^+\\right] \\sim \\sqrt{K_{a1}K_{a2}}$ independent of $C_T$, so the leading-order charge balance retains $\\left[\\mathrm{H_2A^-}\\right]$ and $\\left[\\mathrm{HA^{2-}}\\right]$ while neglecting $\\left[\\mathrm{OH^-}\\right]$, giving $\\mathrm{pH} \\approx \\left(pK_{a1}+pK_{a2}\\right)/2 \\approx 4.40$.**\nThis reasoning is incorrect. The formula $\\mathrm{pH} \\approx (pK_{a1}+pK_{a2})/2$ is an approximation for a solution prepared by dissolving the amphiprotic salt (e.g., $\\mathrm{NaH_2A}$), not the pure acid $\\mathrm{H_3A}$. The proton balance for that different system leads to this result. For a solution of $\\mathrm{H_3A}$, the correct charge balance is the one stated in the derivation above. The claim that the leading-order charge balance retains $\\left[\\mathrm{H_2A^-}\\right]$ and $\\left[\\mathrm{HA^{2-}}\\right]$ is false; the dominant balance is between $\\left[\\mathrm{H}^+\\right]$ and $\\left[\\mathrm{H_2A^-}\\right]$, as shown previously.\nVerdict: **Incorrect**.\n\n**C. In this $\\mathrm{pH}$ region, the first dissociation alone controls the charge balance, so $\\left[\\mathrm{H}^+\\right] \\sim K_{a1}$ and $\\mathrm{pH} \\approx pK_{a1} \\approx 2.00$, with all conjugate-base terms negligible.**\nThis option contains several errors. First, the resulting $\\mathrm{pH}$ of $2.00$ is outside the specified analysis region of $[3.00, 5.80]$, an immediate contradiction. Second, the assumption that $\\left[\\mathrm{H}^+\\right] \\sim K_{a1}$ is unfounded. A correct analysis of the first dissociation as a weak acid, $K_{a1} = \\left[\\mathrm{H}^+\\right]^2 / (C_T - \\left[\\mathrm{H}^+\\right])$, with $C_T=10^{-4}\\ \\mathrm{M}$ and $K_{a1}=10^{-2.00}\\ \\mathrm{M}$, gives $\\left[\\mathrm{H}^+\\right] \\approx 10^{-4}\\ \\mathrm{M}$, which corresponds to $\\mathrm{pH} \\approx 4.00$, not $2.00$. Lastly, stating that \"all conjugate-base terms [are] negligible\" is contradictory, as the first dissociation requires $\\left[\\mathrm{H_2A^-}\\right]$ to balance the charge from $\\left[\\mathrm{H}^+\\right]$.\nVerdict: **Incorrect**.\n\n**D. In this $\\mathrm{pH}$ region, water autoprotolysis dominates the charge balance so that $\\left[\\mathrm{H}^+\\right] \\approx \\left[\\mathrm{OH^-}\\right]$, and the acid contributes negligibly; hence $\\mathrm{pH} \\approx 7.00$ regardless of $C_T$, $K_{a1}$, $K_{a2}$, and $K_{a3}$.**\nThis option is fundamentally incorrect. The addition of an acid, even a dilute one, must result in a $\\mathrm{pH}  7.00$. The proposed $\\mathrm{pH}$ of $7.00$ is also outside the specified analysis region of $[3.00, 5.80]$. The premise that the acid's contribution is negligible is false for an acid with $pK_{a1}=2.00$ at a concentration of $10^{-4}\\ \\mathrm{M}$. As shown in our primary analysis, the acid's dissociation is the primary source of $\\mathrm{H}^+$.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2951933"}, {"introduction": "Amphiprotic species, which can both donate and accept protons, are central to understanding buffers and biological systems. This exercise challenges you to calculate the pH of a sodium bicarbonate solution, a classic example of an amphiprotic system, starting from fundamental conservation laws [@problem_id:2951880]. By deriving the exact solution, you will gain a deeper appreciation for the well-known approximation $\\mathrm{pH} \\approx (pK_{a,1} + pK_{a,2})/2$ and learn to identify the physical corrections required for high-precision results.", "problem": "An aqueous solution at temperature $25^\\circ\\mathrm{C}$ is prepared by dissolving sodium bicarbonate to a formal concentration $C_{\\mathrm{NaHCO_3}} = 0.050\\ \\mathrm{mol}\\ \\mathrm{L}^{-1}$ in water, in a closed vessel with no exchange of carbon dioxide gas. Treat the solution as ideal so that activities equal molar concentrations. Carbonic acid $\\mathrm{H_2CO_3}$ undergoes stepwise dissociation with acid dissociation constants characterized by $\\mathrm{p}K_{a,1} = 6.35$ and $\\mathrm{p}K_{a,2} = 10.33$ at $25^\\circ\\mathrm{C}$. The autoionization of water at $25^\\circ\\mathrm{C}$ is given by $K_{\\mathrm{w}} = 1.0 \\times 10^{-14}$. Starting only from the law of mass action, the definitions of the dissociation constants, and the exact mass and charge balances, determine the $\\mathrm{pH}$ of the solution. Report the $\\mathrm{pH}$ as a dimensionless value, rounded to four significant figures.", "solution": "The problem asks for the pH of a solution of sodium bicarbonate ($\\mathrm{NaHCO_3}$), which contains the amphiprotic species bicarbonate ($\\mathrm{HCO_3^-}$). We derive the solution from first principles.\n\nThe species in solution are $\\mathrm{Na^+}$, $\\mathrm{H^+}$, $\\mathrm{OH^-}$, $\\mathrm{H_2CO_3}$, $\\mathrm{HCO_3^-}$, and $\\mathrm{CO_3^{2-}}$. The formal concentration of sodium bicarbonate is $T = C_{\\mathrm{NaHCO_3}} = 0.050\\ \\mathrm{M}$.\n\n**1. Proton Balance Equation**\nThe most direct method is to use a proton balance equation (also called the proton condition). We choose the species initially added to the solution, $\\mathrm{H_2O}$ and $\\mathrm{HCO_3^-}$, as the reference \"zero level\" for protons.\n- Proton-excess species (formed by gaining protons relative to the reference): $\\mathrm{H^+}$ and $\\mathrm{H_2CO_3}$.\n- Proton-deficient species (formed by losing protons relative to the reference): $\\mathrm{OH^-}$, and $\\mathrm{CO_3^{2-}}$.\n\nThe proton balance requires that the concentration of proton-excess species equals that of proton-deficient species:\n$$ [\\mathrm{H^+}] + [\\mathrm{H_2CO_3}] = [\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}] $$\nThis is an exact relationship for this system.\n\n**2. Expressing Concentrations in terms of $[\\mathrm{H^+}]$**\nWe use the equilibrium constant expressions to write each term as a function of $[\\mathrm{H^+}]$ and $[\\mathrm{HCO_3^-}]$:\n- From $K_{a,1} = \\frac{[\\mathrm{H^+}][\\mathrm{HCO_3^-}]}{[\\mathrm{H_2CO_3}]}$, we have $[\\mathrm{H_2CO_3}] = \\frac{[\\mathrm{H^+}][\\mathrm{HCO_3^-}]}{K_{a,1}}$.\n- From $K_{a,2} = \\frac{[\\mathrm{H^+}][\\mathrm{CO_3^{2-}}]}{[\\mathrm{HCO_3^-}]}$, we have $[\\mathrm{CO_3^{2-}}] = \\frac{K_{a,2}[\\mathrm{HCO_3^-}]}{[\\mathrm{H^+}]}$.\n- From $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$, we have $[\\mathrm{OH^-}] = \\frac{K_w}{[\\mathrm{H^+}]}$.\n\nSubstitute these into the proton balance equation:\n$$ [\\mathrm{H^+}] + \\frac{[\\mathrm{H^+}][\\mathrm{HCO_3^-}]}{K_{a,1}} = \\frac{K_{a,2}[\\mathrm{HCO_3^-}]}{[\\mathrm{H^+}]} + \\frac{K_w}{[\\mathrm{H^+}]} $$\n\n**3. Applying the Mass Balance Approximation**\nFor a solution of an intermediate salt of a polyprotic acid, it is an excellent approximation that the concentration of the amphiprotic species is nearly equal to the formal concentration, i.e., $[\\mathrm{HCO_3^-}] \\approx T$. This is because the amounts that protonate to $\\mathrm{H_2CO_3}$ or deprotonate to $\\mathrm{CO_3^{2-}}$ are small. Substituting $[\\mathrm{HCO_3^-}] \\approx T$:\n$$ [\\mathrm{H^+}] + \\frac{T[\\mathrm{H^+}]}{K_{a,1}} = \\frac{K_{a,2}T}{[\\mathrm{H^+}]} + \\frac{K_w}{[\\mathrm{H^+}]} $$\n\n**4. Solving for $[\\mathrm{H^+}]$**\nWe rearrange the equation to solve for $[\\mathrm{H^+}]$:\n- Multiply the entire equation by $[\\mathrm{H^+}]$:\n$$ [\\mathrm{H^+}]^2 + \\frac{T[\\mathrm{H^+}]^2}{K_{a,1}} = K_{a,2}T + K_w $$\n- Factor out $[\\mathrm{H^+}]^2$:\n$$ [\\mathrm{H^+}]^2 \\left( 1 + \\frac{T}{K_{a,1}} \\right) = K_{a,2}T + K_w $$\n- Isolate $[\\mathrm{H^+}]^2$:\n$$ [\\mathrm{H^+}]^2 = \\frac{K_{a,2}T + K_w}{1 + T/K_{a,1}} $$\nThis is the \"exact\" formula for the pH of an amphiprotic salt solution, which only relies on the approximation $[\\mathrm{HCO_3^-}] \\approx T$.\n\n**5. Numerical Calculation**\nGiven values:\n- $T = 0.050\\ \\mathrm{M}$\n- $pK_{a,1} = 6.35 \\implies K_{a,1} = 10^{-6.35} \\approx 4.467 \\times 10^{-7}$\n- $pK_{a,2} = 10.33 \\implies K_{a,2} = 10^{-10.33} \\approx 4.677 \\times 10^{-11}$\n- $K_w = 1.0 \\times 10^{-14}$\n\nCalculate the terms in the formula:\n- Numerator: $K_{a,2}T + K_w = (4.677 \\times 10^{-11})(0.050) + 1.0 \\times 10^{-14} = 2.3385 \\times 10^{-12} + 1.0 \\times 10^{-14} = 2.3485 \\times 10^{-12}$\n- Denominator: $1 + T/K_{a,1} = 1 + \\frac{0.050}{4.467 \\times 10^{-7}} = 1 + 111932 = 111933$\n\nNow, calculate $[\\mathrm{H^+}]^2$:\n$$ [\\mathrm{H^+}]^2 = \\frac{2.3485 \\times 10^{-12}}{111933} \\approx 2.0981 \\times 10^{-17} $$\n\nCalculate $[\\mathrm{H^+}]$:\n$$ [\\mathrm{H^+}] = \\sqrt{2.0981 \\times 10^{-17}} \\approx 4.5805 \\times 10^{-9}\\ \\mathrm{M} $$\n\nCalculate the pH:\n$$ \\mathrm{pH} = -\\log_{10}(4.5805 \\times 10^{-9}) \\approx 8.33905 $$\n\nRounding to four significant figures as required, the final pH is $8.339$.", "answer": "$$\\boxed{8.339}$$", "id": "2951880"}, {"introduction": "While analytical approximations provide invaluable insight, a complete understanding of polyprotic acid systems requires mastering exact numerical solutions. This practice guides you through the process of deriving the exact governing equation for a diprotic acid from first principles and implementing a robust numerical solver to find the hydrogen ion concentration [@problem_id:2951873]. This computational approach is universally applicable and represents a cornerstone of modern quantitative chemical analysis, freeing you from the limitations of simplified scenarios.", "problem": "You are asked to write a program that computes the hydrogen ion concentration $\\,[\\mathrm{H}^+]$ for aqueous solutions of a general diprotic acid using only first principles: equilibrium definitions, mass conservation, and charge neutrality. Consider a generic diprotic acid $\\mathrm{H_2A}$ with stepwise dissociation equilibria characterized by the acid dissociation constants $K_{\\mathrm{a1}}$ and $K_{\\mathrm{a2}}$ in water at temperature such that the ionic product of water is $K_\\mathrm{w}$. The formal concentration (also called analytical concentration) of the acid is $C_\\mathrm{T}$, defined by $C_\\mathrm{T} = [\\mathrm{H_2A}] + [\\mathrm{HA}^-] + [\\mathrm{A}^{2-}]$. No other solutes are present. All concentrations are to be expressed in $\\mathrm{mol\\,L^{-1}}$.\n\nStarting only from the definitions of the equilibrium constants, the mass balance on the acid, the electroneutrality (charge balance) of the solution, and the autodissociation of water,\n- equilibrium constants: $K_{\\mathrm{a1}} = \\dfrac{[\\mathrm{H}^+][\\mathrm{HA}^-]}{[\\mathrm{H_2A}]}$, $K_{\\mathrm{a2}} = \\dfrac{[\\mathrm{H}^+][\\mathrm{A}^{2-}]}{[\\mathrm{HA}^-]}$,\n- mass balance: $C_\\mathrm{T} = [\\mathrm{H_2A}] + [\\mathrm{HA}^-] + [\\mathrm{A}^{2-}]$,\n- water: $K_\\mathrm{w} = [\\mathrm{H}^+][\\mathrm{OH}^-]$,\n- electroneutrality: total positive charge equals total negative charge in solution,\nderive a single nonlinear scalar equation $f([\\mathrm{H}^+]) = 0$ whose physically meaningful root gives the hydrogen ion concentration $\\,[\\mathrm{H}^+]  0$. You must then implement a Newtonâ€“Raphson iteration to solve this equation, designed to be globally convergent in practice by safeguarding the iteration so that it remains in the physically admissible domain $\\,[\\mathrm{H}^+]  0$ and respects a bracketing interval where the function changes sign.\n\nYour implementation must adhere to the following algorithmic specifications:\n- Variable to solve for: $\\,[\\mathrm{H}^+]$ in $\\mathrm{mol\\,L^{-1}}$.\n- Initial guess: construct a principled initial guess based on the monoprotic limit where the second dissociation is neglected but water autoionization is retained. Justify this choice from the governing equations; do not use ad hoc constants.\n- Safeguard: maintain a bracketing interval $\\,[\\mathrm{H}_\\mathrm{lo}, \\mathrm{H}_\\mathrm{hi}]$ with $\\mathrm{H}_\\mathrm{lo}  0$ for which $f(\\mathrm{H}_\\mathrm{lo})  0  f(\\mathrm{H}_\\mathrm{hi})$ (or the reverse), and ensure the Newton step does not leave this interval; if it does, fall back to a bisection step.\n- Stopping criterion: stop when both an absolute residual tolerance and a relative-step tolerance are satisfied simultaneously, with absolute function tolerance $\\lvert f([\\mathrm{H}^+]) \\rvert \\le \\tau_f$ and relative step tolerance $\\dfrac{\\lvert \\Delta [\\mathrm{H}^+] \\rvert}{\\max(1, \\lvert [\\mathrm{H}^+] \\rvert)} \\le \\tau_x$. You should set $\\tau_f = 10^{-16}\\,\\mathrm{mol\\,L^{-1}}$ and $\\tau_x = 10^{-12}$, and cap the maximum number of iterations at $200$.\n\nYour program must solve the problem for the following five test cases (each specified by $(K_{\\mathrm{a1}}, K_{\\mathrm{a2}}, C_\\mathrm{T}, K_\\mathrm{w})$, all in $\\mathrm{mol\\,L^{-1}}$):\n- Test 1 (moderately strong first step, weak second step): $(1.0\\times 10^{-2},\\, 1.0\\times 10^{-7},\\, 1.0\\times 10^{-2},\\, 1.0\\times 10^{-14})$.\n- Test 2 (very weak acid; water dominates): $(1.0\\times 10^{-7},\\, 1.0\\times 10^{-12},\\, 1.0\\times 10^{-3},\\, 1.0\\times 10^{-14})$.\n- Test 3 (very dilute acid): $(1.0\\times 10^{-6},\\, 1.0\\times 10^{-10},\\, 1.0\\times 10^{-8},\\, 1.0\\times 10^{-14})$.\n- Test 4 (concentrated acid; first step near strong): $(5.0\\times 10^{-1},\\, 1.0\\times 10^{-3},\\, 1.0,\\, 1.0\\times 10^{-14})$.\n- Test 5 (nearly equal dissociation constants): $(1.0\\times 10^{-5},\\, 1.0\\times 10^{-5},\\, 1.0\\times 10^{-3},\\, 1.0\\times 10^{-14})$.\n\nFinal output format:\n- For each test case, compute the unique positive root $\\,[\\mathrm{H}^+]$ of your derived equation, expressed in $\\mathrm{mol\\,L^{-1}}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in scientific notation with exactly $10$ significant digits for each value. For example, the intended formatting is like $[1.2345678900\\mathrm{e}{-03},2.3456789000\\mathrm{e}{-04}]$ (unitless in the textual output, but all values represent $\\mathrm{mol\\,L^{-1}}$).", "solution": "The problem as stated is subjected to validation.\n\n### Step 1: Extract Givens\n\nThe problem provides the following governing principles and definitions for an aqueous solution of a diprotic acid $\\mathrm{H_2A}$:\n- **Equilibrium Constants**:\n  - First acid dissociation: $K_{\\mathrm{a1}} = \\dfrac{[\\mathrm{H}^+][\\mathrm{HA}^-]}{[\\mathrm{H_2A}]}$\n  - Second acid dissociation: $K_{\\mathrm{a2}} = \\dfrac{[\\mathrm{H}^+][\\mathrm{A}^{2-}]}{[\\mathrm{HA}^-]}$\n  - Water autoionization: $K_\\mathrm{w} = [\\mathrm{H}^+][\\mathrm{OH}^-]$\n- **Conservation Laws**:\n  - Mass balance on the acid species: $C_\\mathrm{T} = [\\mathrm{H_2A}] + [\\mathrm{HA}^-] + [\\mathrm{A}^{2-}]$, where $C_\\mathrm{T}$ is the formal concentration.\n  - Electroneutrality (charge balance): The sum of positive charge concentrations must equal the sum of negative charge concentrations.\n- **Objective**: Derive a single nonlinear scalar equation $f([\\mathrm{H}^+]) = 0$ for the hydrogen ion concentration $[\\mathrm{H}^+]$ and solve it using a safeguarded Newton-Raphson method.\n- **Numerical Specifications**:\n  - Initial guess: Based on the monoprotic approximation including water autoionization.\n  - Safeguard: Maintain a bracketing interval and use bisection fallback.\n  - Tolerances: $\\tau_f = 10^{-16}\\,\\mathrm{mol\\,L^{-1}}$, $\\tau_x = 10^{-12}$.\n  - Maximum iterations: $200$.\n- **Test Cases**: Five sets of parameters $(K_{\\mathrm{a1}}, K_{\\mathrm{a2}}, C_\\mathrm{T}, K_\\mathrm{w})$ are provided.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is reviewed against the validation criteria.\n\n- **Scientifically Grounded**: The problem is a classic exercise in physical chemistry, based entirely on the fundamental principles of chemical equilibrium, mass conservation, and charge neutrality. All principles are standard and factually sound.\n- **Well-Posed**: The problem is well-posed. The derivation from first principles leads to a single nonlinear equation in one variable, $[\\mathrm{H}^+]$. Because the function is shown to be monotonic, a unique positive root exists, ensuring a unique and stable solution.\n- **Objective**: The problem statement is precise, quantitative, and free of subjective or ambiguous language.\n- **Completeness and Consistency**: The problem provides all necessary definitions, constants, and constraints to derive and solve the equation. There are no contradictions.\n- **Feasibility**: The parameter values for the test cases are physically realistic for aqueous solutions.\n\nThe problem is free of any of the specified flaws.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. A complete, reasoned solution will be provided.\n\n### Derivation of the Governing Equation\n\nThe objective is to find the hydrogen ion concentration, which we shall denote as $h \\equiv [\\mathrm{H}^+]$. All other variable concentrations must be expressed in terms of $h$ and the given constants: $K_{\\mathrm{a1}}$, $K_{\\mathrm{a2}}$, $C_\\mathrm{T}$, and $K_\\mathrm{w}$.\n\n**1. Charge Balance Equation:**\nThe ions present in the solution are $\\mathrm{H}^+$, $\\mathrm{OH}^-$, $\\mathrm{HA}^-$, and $\\mathrm{A}^{2-}$. The condition of electroneutrality requires that the total concentration of positive charges equals the total concentration of negative charges.\n$$[\\mathrm{H}^+] = [\\mathrm{OH}^-] + [\\mathrm{HA}^-] + 2[\\mathrm{A}^{2-}]$$\nThe coefficient $2$ for $[\\mathrm{A}^{2-}]$ arises because this ion carries a charge of $-2$.\n\n**2. Expressing Concentrations in Terms of $h$:**\n- From the autoionization of water, we have:\n$$[\\mathrm{OH}^-] = \\frac{K_\\mathrm{w}}{h}$$\n- To express the acid species concentrations $([\\mathrm{H_2A}], [\\mathrm{HA}^-], [\\mathrm{A}^{2-}])$ in terms of $h$, we use the mass balance equation combined with the equilibrium constant definitions. It is convenient to define the fractions of each species, $\\alpha_i$:\n$$ \\alpha_0 = \\frac{[\\mathrm{H_2A}]}{C_\\mathrm{T}}, \\quad \\alpha_1 = \\frac{[\\mathrm{HA}^-]}{C_\\mathrm{T}}, \\quad \\alpha_2 = \\frac{[\\mathrm{A}^{2-}]}{C_\\mathrm{T}} $$\nFrom the equilibrium definitions:\n$$[\\mathrm{HA}^-] = \\frac{K_{\\mathrm{a1}}[\\mathrm{H_2A}]}{h}$$\n$$[\\mathrm{A}^{2-}] = \\frac{K_{\\mathrm{a2}}[\\mathrm{HA}^-]}{h} = \\frac{K_{\\mathrm{a1}}K_{\\mathrm{a2}}[\\mathrm{H_2A}]}{h^2}$$\nSubstituting these into the mass balance equation $C_\\mathrm{T} = [\\mathrm{H_2A}] + [\\mathrm{HA}^-] + [\\mathrm{A}^{2-}]$ gives:\n$$C_\\mathrm{T} = [\\mathrm{H_2A}] \\left( 1 + \\frac{K_{\\mathrm{a1}}}{h} + \\frac{K_{\\mathrm{a1}}K_{\\mathrm{a2}}}{h^2} \\right) = [\\mathrm{H_2A}] \\left( \\frac{h^2 + K_{\\mathrm{a1}}h + K_{\\mathrm{a1}}K_{\\mathrm{a2}}}{h^2} \\right)$$\nLet the denominator be $D(h) = h^2 + K_{\\mathrm{a1}}h + K_{\\mathrm{a1}}K_{\\mathrm{a2}}$. We can now express $[\\mathrm{H_2A}]$, and subsequently $[\\mathrm{HA}^-]$ and $[\\mathrm{A}^{2-}]$, in terms of $h$, $C_\\mathrm{T}$, and equilibrium constants:\n$$[\\mathrm{H_2A}] = C_\\mathrm{T} \\frac{h^2}{D(h)} \\implies \\alpha_0 = \\frac{h^2}{D(h)}$$\n$$[\\mathrm{HA}^-] = C_\\mathrm{T} \\frac{K_{\\mathrm{a1}}h}{D(h)} \\implies \\alpha_1 = \\frac{K_{\\mathrm{a1}}h}{D(h)}$$\n$$[\\mathrm{A}^{2-}] = C_\\mathrm{T} \\frac{K_{\\mathrm{a1}}K_{\\mathrm{a2}}}{D(h)} \\implies \\alpha_2 = \\frac{K_{\\mathrm{a1}}K_{\\mathrm{a2}}}{D(h)}$$\n\n**3. Final Nonlinear Equation:**\nSubstituting these expressions for $[\\mathrm{OH}^-]$, $[\\mathrm{HA}^-]$, and $[\\mathrm{A}^{2-}]$ back into the charge balance equation:\n$$h = \\frac{K_\\mathrm{w}}{h} + C_\\mathrm{T} \\frac{K_{\\mathrm{a1}}h}{h^2 + K_{\\mathrm{a1}}h + K_{\\mathrm{a1}}K_{\\mathrm{a2}}} + 2 C_\\mathrm{T} \\frac{K_{\\mathrm{a1}}K_{\\mathrm{a2}}}{h^2 + K_{\\mathrm{a1}}h + K_{\\mathrm{a1}}K_{\\mathrm{a2}}}$$\nWe define the function $f(h)$ such that its root gives the solution for $h$:\n$$f(h) = h - \\frac{K_\\mathrm{w}}{h} - C_\\mathrm{T} \\left( \\frac{K_{\\mathrm{a1}}h + 2K_{\\mathrm{a1}}K_{\\mathrm{a2}}}{h^2 + K_{\\mathrm{a1}}h + K_{\\mathrm{a1}}K_{\\mathrm{a2}}} \\right) = 0$$\nThis is the required nonlinear scalar equation. The physically meaningful solution is the unique positive root of this equation.\n\n### Numerical Solution by Safeguarded Newton-Raphson Method\n\nThe Newton-Raphson method finds a root of $f(h)=0$ via the iterative scheme:\n$$h_{k+1} = h_k - \\frac{f(h_k)}{f'(h_k)}$$\nwhere $f'(h)$ is the derivative of $f(h)$ with respect to $h$.\n\n**1. Derivative of $f(h)$:**\nThe derivative is calculated as:\n$$f'(h) = \\frac{d}{dh} \\left( h - K_\\mathrm{w}h^{-1} - C_\\mathrm{T} \\frac{N(h)}{D(h)} \\right)$$\nwhere $N(h) = K_{\\mathrm{a1}}h + 2K_{\\mathrm{a1}}K_{\\mathrm{a2}}$ and $D(h) = h^2 + K_{\\mathrm{a1}}h + K_{\\mathrm{a1}}K_{\\mathrm{a2}}$.\nUsing the quotient rule for the third term:\n$$f'(h) = 1 + \\frac{K_\\mathrm{w}}{h^2} - C_\\mathrm{T} \\frac{N'(h)D(h) - N(h)D'(h)}{D(h)^2}$$\nwith $N'(h) = K_{\\mathrm{a1}}$ and $D'(h) = 2h + K_{\\mathrm{a1}}$. After algebraic simplification, we find:\n$$N'(h)D(h) - N(h)D'(h) = -K_{\\mathrm{a1}}h^2 - 4K_{\\mathrm{a1}}K_{\\mathrm{a2}}h - K_{\\mathrm{a1}}^2 K_{\\mathrm{a2}}$$\nThus, the derivative is:\n$$f'(h) = 1 + \\frac{K_\\mathrm{w}}{h^2} + C_\\mathrm{T} \\frac{K_{\\mathrm{a1}}h^2 + 4K_{\\mathrm{a1}}K_{\\mathrm{a2}}h + K_{\\mathrm{a1}}^2 K_{\\mathrm{a2}}}{(h^2 + K_{\\mathrm{a1}}h + K_{\\mathrm{a1}}K_{\\mathrm{a2}})^2}$$\nFor any physically relevant parameters ($C_\\mathrm{T} \\ge 0$, $K's  0$) and for any $h  0$, every term in $f'(h)$ is non-negative, and the first term is $1$. Thus, $f'(h)  0$. This proves that $f(h)$ is a strictly monotonically increasing function for $h0$, which guarantees a unique positive root.\n\n**2. Initial Guess ($h_0$):**\nAs specified, the initial guess is derived from the monoprotic approximation ($K_{\\mathrm{a2}}=0$), retaining the contribution of water autoionization. The charge balance simplifies to $[\\mathrm{H}^+] = [\\mathrm{OH}^-] + [\\mathrm{HA}^-]$, which leads to the cubic equation:\n$$h^3 + K_{\\mathrm{a1}}h^2 - (K_{\\mathrm{a1}}C_\\mathrm{T} + K_\\mathrm{w})h - K_{\\mathrm{a1}}K_\\mathrm{w} = 0$$\nThis equation has exactly one positive real root, which provides a principled and robust initial guess $h_0$. We solve this polynomial numerically.\n\n**3. Bracketing Interval $[H_{\\mathrm{lo}}, H_{\\mathrm{hi}}]$:**\nA rigorous bracketing interval containing the root is essential for the safeguard mechanism.\n- **Lower bound ($H_{\\mathrm{lo}}$):** In pure water ($C_\\mathrm{T}=0$), $h=\\sqrt{K_\\mathrm{w}}$. Adding acid ($C_\\mathrm{T}0$) must increase $h$. Therefore, the root is always greater than $\\sqrt{K_\\mathrm{w}}$. At $h = \\sqrt{K_\\mathrm{w}}$, $f(\\sqrt{K_\\mathrm{w}}) = 0 - C_\\mathrm{T}(\\ldots) \\le 0$. Thus, we can set $H_{\\mathrm{lo}} = \\sqrt{K_\\mathrm{w}}$.\n- **Upper bound ($H_{\\mathrm{hi}}$):** The concentration of anions from the acid, $[\\mathrm{HA}^-] + 2[\\mathrm{A}^{2-}]$, represents the amount of proton released per liter, which cannot exceed $2C_\\mathrm{T}$. From the charge balance, $h = [\\mathrm{OH}^-] + ([\\mathrm{HA}^-] + 2[\\mathrm{A}^{2-}])$, we have the inequality $h \\le K_\\mathrm{w}/h + 2C_\\mathrm{T}$. This rearranges to $h^2 - 2C_\\mathrm{T}h - K_\\mathrm{w} \\le 0$. The right-most positive value of $h$ satisfying this is the larger root of $h^2 - 2C_\\mathrm{T}h - K_\\mathrm{w} = 0$, which is $h = C_\\mathrm{T} + \\sqrt{C_\\mathrm{T}^2 + K_\\mathrm{w}}$. At this value, $f(h) \\ge 0$. Thus, we can set $H_{\\mathrm{hi}} = C_\\mathrm{T} + \\sqrt{C_\\mathrm{T}^2 + K_\\mathrm{w}}$.\nThe root is guaranteed to lie in the interval $[\\sqrt{K_\\mathrm{w}}, C_\\mathrm{T} + \\sqrt{C_\\mathrm{T}^2 + K_\\mathrm{w}}]$.\n\n**4. Algorithm Implementation:**\nThe algorithm proceeds as follows:\n1. Initialize the iteration with the guess $h_0$ from the monoprotic cubic root.\n2. Initialize the bracket $[H_{\\mathrm{lo}}, H_{\\mathrm{hi}}]$.\n3. In each iteration, calculate the Newton step $\\Delta h = -f(h)/f'(h)$.\n4. Let the prospective new iterate be $h_{\\text{new}} = h + \\Delta h$.\n5. **Safeguard:** If $h_{\\text{new}}$ falls outside the current bracket $(H_{\\mathrm{lo}}, H_{\\mathrm{hi}})$, discard it and perform a bisection step instead: $h_{\\text{new}} = (H_{\\mathrm{lo}} + H_{\\mathrm{hi}})/2$.\n6. Update the current iterate: $h \\leftarrow h_{\\text{new}}$.\n7. Update the bracket: if $f(h)  0$, set $H_{\\mathrm{lo}} = h$; if $f(h)  0$, set $H_{\\mathrm{hi}} = h$.\n8. Check for convergence: stop if both $|f(h)| \\le \\tau_f$ and $|\\Delta h| / \\max(1, |h_{\\text{old}}|) \\le \\tau_x$ are satisfied.\n9. If convergence is not achieved, repeat from step 3, up to the maximum number of iterations.\n\nThis hybrid Newton-Bisection method combines the rapid local convergence of the Newton-Raphson method with the guaranteed global convergence of the bisection method.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_diprotic_acid_h_conc(Ka1, Ka2, CT, Kw, tau_f, tau_x, max_iter):\n    \"\"\"\n    Computes the hydrogen ion concentration [H+] for a diprotic acid solution\n    using a safeguarded Newton-Raphson method.\n\n    Args:\n        Ka1 (float): First acid dissociation constant.\n        Ka2 (float): Second acid dissociation constant.\n        CT (float): Formal concentration of the acid.\n        Kw (float): Ionic product of water.\n        tau_f (float): Absolute function residual tolerance.\n        tau_x (float): Relative step tolerance.\n        max_iter (int): Maximum number of iterations.\n\n    Returns:\n        float: The calculated hydrogen ion concentration [H+].\n    \"\"\"\n    if CT == 0.0:\n        return np.sqrt(Kw)\n\n    # Define the function f(h) = 0 and its derivative f'(h)\n    def f(h):\n        if h = 0:\n            return -np.inf\n        # Denominator for alpha fractions\n        den = h**2 + Ka1 * h + Ka1 * Ka2\n        if den == 0: # Avoid division by zero, though unlikely for h > 0\n            return np.inf if Ka1 > 0 else h - Kw/h\n        # Charge balance equation: h - Kw/h - CT*(alpha1 + 2*alpha2) = 0\n        return h - Kw/h - CT * (Ka1 * h + 2 * Ka1 * Ka2) / den\n\n    def f_prime(h):\n        if h = 0:\n            return np.inf\n        # Denominator\n        den = h**2 + Ka1 * h + Ka1 * Ka2\n        if den == 0:\n            return np.inf\n        # Numerator of the derivative of the acid term\n        num_prime_term = Ka1 * h**2 + 4 * Ka1 * Ka2 * h + Ka1**2 * Ka2\n        return 1 + Kw/h**2 + CT * num_prime_term / den**2\n\n    # Step 1: Principled initial guess h_0 from monoprotic approximation\n    # h^3 + Ka1*h^2 - (Ka1*CT + Kw)*h - Ka1*Kw = 0\n    coeffs = [1, Ka1, -(Ka1 * CT + Kw), -Ka1 * Kw]\n    roots = np.roots(coeffs)\n    h_current = next((np.real(r) for r in roots if np.isreal(r) and r > 0), np.sqrt(Kw + Ka1*CT))\n\n    # Step 2: Establish a rigorous bracketing interval\n    h_lo = np.sqrt(Kw)\n    h_hi = CT + np.sqrt(CT**2 + Kw)\n    \n    # Ensure initial guess is within the bracket for stability\n    if not (h_lo = h_current = h_hi):\n        h_current = (h_lo + h_hi) / 2.0\n\n    # Step 3: Safeguarded Newton-Raphson iteration\n    for i in range(max_iter):\n        h_old = h_current\n        fh = f(h_old)\n        fph = f_prime(h_old)\n\n        if fph = 0: # Should not occur; fallback to bisection\n            delta_h = (h_lo + h_hi) / 2.0 - h_old\n        else:\n            # Newton step\n            delta_h = -fh / fph\n\n        h_new = h_old + delta_h\n\n        # Safeguard: if Newton step is out of bounds, use bisection\n        if not (h_lo  h_new  h_hi):\n            h_new = (h_lo + h_hi) / 2.0\n            delta_h = h_new - h_old\n        \n        h_current = h_new\n\n        # Update bracketing interval\n        fh_new = f(h_current)\n        if fh_new  0:\n            h_lo = h_current\n        elif fh_new > 0:\n            h_hi = h_current\n        else: # Found exact root\n            break\n\n        # Check for convergence based on the step just taken and the new residual\n        abs_residual_converged = abs(fh_new) = tau_f\n        rel_step_converged = abs(delta_h) / max(1.0, abs(h_old)) = tau_x\n\n        if abs_residual_converged and rel_step_converged:\n            break\n            \n    return h_current\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Ka1, Ka2, CT, Kw)\n    test_cases = [\n        (1.0e-2, 1.0e-7, 1.0e-2, 1.0e-14),\n        (1.0e-7, 1.0e-12, 1.0e-3, 1.0e-14),\n        (1.0e-6, 1.0e-10, 1.0e-8, 1.0e-14),\n        (5.0e-1, 1.0e-3, 1.0, 1.0e-14),\n        (1.0e-5, 1.0e-5, 1.0e-3, 1.0e-14),\n    ]\n\n    # Numerical parameters from the problem statement\n    tau_f = 1.0e-16\n    tau_x = 1.0e-12\n    max_iter = 200\n\n    results = []\n    for case in test_cases:\n        Ka1, Ka2, CT, Kw = case\n        h_plus = solve_diprotic_acid_h_conc(Ka1, Ka2, CT, Kw, tau_f, tau_x, max_iter)\n        results.append(\"{:.10e}\".format(h_plus))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2951873"}]}