{"hands_on_practices": [{"introduction": "Understanding the relationship between molecular properties and macroscopic observables is a cornerstone of the kinetic theory of gases. This first exercise challenges you to derive how molecular speed depends on mass from fundamental principles for two different gases at the same temperature. By working through this problem [@problem_id:2947195], you will solidify your grasp of how the mean speed $\\langle v \\rangle$ and root-mean-square speed $v_{\\mathrm{rms}}$ scale, a key principle underlying processes like diffusion and effusion.", "problem": "Two separate containers each hold a very dilute, monatomic, nonrelativistic ideal gas at the same thermodynamic temperature $T$. Container $1$ holds gas species with molecular mass $m_1$, and container $2$ holds gas species with molecular mass $m_2$. Assume classical equilibrium and that the velocity distribution is isotropic, with no external fields or interactions beyond elastic collisions. Using only fundamental equilibrium-statistical principles and core definitions (without invoking any pre-stated “shortcut” results), determine how the mean molecular speed $\\langle v \\rangle$ and the root-mean-square (rms) speed $v_{\\mathrm{rms}}$ scale with $m$ and $T$, and from that obtain the ratios $\\langle v \\rangle_1 / \\langle v \\rangle_2$ and $v_{\\mathrm{rms},1} / v_{\\mathrm{rms},2}$ for the two gases at the same $T$. Express your final result as analytic expressions depending only on $m_1$ and $m_2$. No numerical evaluation is required. Report your final answer as a row matrix in the order $\\left(\\langle v \\rangle_1 / \\langle v \\rangle_2,\\; v_{\\mathrm{rms},1} / v_{\\mathrm{rms},2}\\right)$. The ratios are dimensionless and require no units.", "solution": "The problem statement will first be subjected to a rigorous validation procedure.\n\n**Step 1: Extract Givens**\n- System: Two separate containers, designated $1$ and $2$.\n- Contents: Each container holds a very dilute, monatomic, nonrelativistic ideal gas.\n- Thermal State: Both containers are at the same thermodynamic temperature, $T$.\n- Gas Properties: Gas in container $1$ has molecular mass $m_1$; gas in container $2$ has molecular mass $m_2$.\n- Assumptions: The systems are in classical equilibrium, the velocity distribution is isotropic, there are no external fields, and interactions are limited to elastic collisions.\n- Objectives:\n    $1$. Determine the scaling of the mean molecular speed $\\langle v \\rangle$ and the root-mean-square speed $v_{\\mathrm{rms}}$ with molecular mass $m$ and temperature $T$.\n    $2$. Derive the ratios $\\frac{\\langle v \\rangle_1}{\\langle v \\rangle_2}$ and $\\frac{v_{\\mathrm{rms},1}}{v_{\\mathrm{rms},2}}$.\n- Constraints: The derivation must use only fundamental equilibrium-statistical principles and core definitions, without invoking pre-stated \"shortcut\" results.\n- Final Answer Format: A row matrix containing the two requested ratios as analytic expressions in terms of $m_1$ and $m_2$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is subjected to scrutiny based on the criteria of scientific soundness, well-posedness, and objectivity.\n\n- **Scientifically Grounded:** The problem describes a classical ideal gas, a cornerstone model in statistical mechanics and kinetic theory of gases. The underlying principles (Boltzmann statistics) are fundamental to physics. The problem is scientifically sound.\n- **Well-Posed:** The problem is clearly stated, providing all necessary information ($m_1$, $m_2$, same $T$, ideal gas conditions) to uniquely determine the requested ratios. The task is specific and a meaningful solution exists.\n- **Objective:** The language is formal, precise, and unambiguous. It uses standard scientific terminology and is free from subjective or speculative content.\n- **Flaw Analysis:**\n    $1$. **Scientific/Factual Unsoundness:** None. The premises are standard for the kinetic theory of gases.\n    $2$. **Non-Formalizable/Irrelevant:** None. The problem is a standard exercise in statistical mechanics and is directly on topic.\n    $3$. **Incomplete/Contradictory:** None. The specified conditions are sufficient and self-consistent.\n    $4$. **Unrealistic/Infeasible:** None. The model describes real gases to a high degree of accuracy under the stated conditions (dilute, nonrelativistic).\n    $5$. **Ill-Posed/Poorly Structured:** None. The problem structure is logical and leads to a unique result.\n    $6$. **Pseudo-Profound/Trivial:** None. The constraint to derive the result from first principles prevents triviality and requires a substantive demonstration of understanding.\n    $7$. **Outside Scientific Verifiability:** None. The result is a standard, verifiable conclusion of statistical mechanics.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. It is a well-formulated problem in statistical physics that tests fundamental understanding. A full, reasoned solution will now be provided.\n\n**Solution Derivation**\n\nThe problem requires a derivation from first principles. We begin with the Boltzmann distribution, which states that the probability of a particle being in a microstate with energy $E$ is proportional to the Boltzmann factor $\\exp(-E / (k_B T))$, where $k_B$ is the Boltzmann constant and $T$ is the thermodynamic temperature.\n\nFor a single monatomic gas molecule of mass $m$, its energy is purely kinetic and nonrelativistic:\n$$ E = \\frac{1}{2}mv^2 = \\frac{1}{2}m(v_x^2 + v_y^2 + v_z^2) $$\nwhere $\\mathbf{v} = (v_x, v_y, v_z)$ is the molecular velocity vector.\n\nThe probability distribution function for the velocity components, $f(v_x, v_y, v_z)$, is proportional to the Boltzmann factor.\n$$ f(v_x, v_y, v_z) \\, dv_x \\, dv_y \\, dv_z = C \\exp\\left(-\\frac{m(v_x^2 + v_y^2 + v_z^2)}{2k_B T}\\right) \\, dv_x \\, dv_y \\, dv_z $$\nThe constant $C$ is determined by the normalization condition that the total probability must be $1$:\n$$ \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} C \\exp\\left(-\\frac{m(v_x^2 + v_y^2 + v_z^2)}{2k_B T}\\right) \\, dv_x \\, dv_y \\, dv_z = 1 $$\nThis integral separates into a product of three identical Gaussian integrals of the form $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$, with $a = \\frac{m}{2k_B T}$.\n$$ C \\left(\\sqrt{\\frac{\\pi}{m/(2k_B T)}}\\right)^3 = 1 \\implies C \\left(\\frac{2\\pi k_B T}{m}\\right)^{3/2} = 1 $$\nThus, the normalization constant is $C = \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2}$.\n\nThe problem concerns the molecular speed $v = |\\mathbf{v}| = \\sqrt{v_x^2 + v_y^2 + v_z^2}$. To find the speed distribution $F(v)$, we transform from Cartesian velocity coordinates $(v_x, v_y, v_z)$ to spherical coordinates $(v, \\theta, \\phi)$, where the volume element is $dv_x \\, dv_y \\, dv_z = v^2 \\sin\\theta \\, dv \\, d\\theta \\, d\\phi$. The probability of finding a molecule with speed between $v$ and $v+dv$ is found by integrating the velocity distribution over all solid angles:\n$$ F(v) \\, dv = \\left( \\int_0^{2\\pi} d\\phi \\int_0^{\\pi} \\sin\\theta \\, d\\theta \\right) C \\exp\\left(-\\frac{mv^2}{2k_B T}\\right) v^2 \\, dv $$\nThe angular integral yields $4\\pi$. Substituting the value of $C$, we obtain the Maxwell-Boltzmann speed distribution:\n$$ F(v) = 4\\pi \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} v^2 \\exp\\left(-\\frac{mv^2}{2k_B T}\\right) $$\nThis function is defined for $v \\in [0, \\infty)$.\n\nNow, we can calculate the required statistical averages.\n\n**1. Mean Molecular Speed $\\langle v \\rangle$**\nThe mean speed is the first moment of the speed distribution:\n$$ \\langle v \\rangle = \\int_0^{\\infty} v F(v) \\, dv = 4\\pi \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\int_0^{\\infty} v^3 \\exp\\left(-\\frac{mv^2}{2k_B T}\\right) \\, dv $$\nLet $a = \\frac{m}{2k_B T}$. The integral is of the form $\\int_0^{\\infty} x^3 \\exp(-ax^2)dx$. This standard integral evaluates to $\\frac{1}{2a^2}$.\n$$ \\int_0^{\\infty} v^3 \\exp\\left(-av^2\\right) \\, dv = \\frac{1}{2a^2} = \\frac{1}{2\\left(\\frac{m}{2k_B T}\\right)^2} = \\frac{1}{2} \\frac{4(k_B T)^2}{m^2} = \\frac{2(k_B T)^2}{m^2} $$\nSubstituting this result back into the expression for $\\langle v \\rangle$:\n$$ \\langle v \\rangle = 4\\pi \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\left( \\frac{2(k_B T)^2}{m^2} \\right) = 4\\pi \\frac{m^{3/2}}{(2\\pi)^{3/2}(k_B T)^{3/2}} \\frac{2(k_B T)^2}{m^2} $$\n$$ \\langle v \\rangle = \\frac{8\\pi m^{3/2} (k_B T)^2}{2\\sqrt{2}\\pi\\sqrt{\\pi} m^2 (k_B T)^{3/2}} = \\frac{4}{\\sqrt{2\\pi}} \\frac{\\sqrt{k_B T}}{\\sqrt{m}} = \\sqrt{\\frac{16 k_B T}{2\\pi m}} = \\sqrt{\\frac{8k_B T}{\\pi m}} $$\nThe scaling law for the mean speed is $\\langle v \\rangle \\propto \\sqrt{\\frac{T}{m}}$.\n\n**2. Root-Mean-Square Speed $v_{\\mathrm{rms}}$**\nThe root-mean-square speed is defined as $v_{\\mathrm{rms}} = \\sqrt{\\langle v^2 \\rangle}$, where $\\langle v^2 \\rangle$ is the mean-square speed. We first calculate $\\langle v^2 \\rangle$, the second moment of the distribution:\n$$ \\langle v^2 \\rangle = \\int_0^{\\infty} v^2 F(v) \\, dv = 4\\pi \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\int_0^{\\infty} v^4 \\exp\\left(-\\frac{mv^2}{2k_B T}\\right) \\, dv $$\nAgain, let $a = \\frac{m}{2k_B T}$. The integral is of the form $\\int_0^{\\infty} x^4 \\exp(-ax^2)dx$, which evaluates to $\\frac{3\\sqrt{\\pi}}{8a^{5/2}}$.\n$$ \\int_0^{\\infty} v^4 \\exp\\left(-av^2\\right) \\, dv = \\frac{3\\sqrt{\\pi}}{8a^{5/2}} = \\frac{3\\sqrt{\\pi}}{8\\left(\\frac{m}{2k_B T}\\right)^{5/2}} $$\nSubstituting this into the expression for $\\langle v^2 \\rangle$:\n$$ \\langle v^2 \\rangle = 4\\pi \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\left( \\frac{3\\sqrt{\\pi}}{8} \\frac{(2k_B T)^{5/2}}{m^{5/2}} \\right) = 4\\pi \\frac{m^{3/2}}{(2\\pi)^{3/2}(k_B T)^{3/2}} \\frac{3\\sqrt{\\pi}(2k_B T)^{5/2}}{8m^{5/2}} $$\n$$ \\langle v^2 \\rangle = \\frac{4\\pi m^{3/2}}{2\\sqrt{2}\\pi\\sqrt{\\pi}(k_B T)^{3/2}} \\frac{3\\sqrt{\\pi}4\\sqrt{2}(k_B T)^{5/2}}{8m^{5/2}} = \\frac{3 \\cdot 4 \\cdot 4 \\cdot \\pi \\sqrt{\\pi} \\sqrt{2}}{2 \\cdot 8 \\cdot \\pi \\sqrt{\\pi} \\sqrt{2}} \\frac{m^{3/2}}{m^{5/2}} \\frac{(k_B T)^{5/2}}{(k_B T)^{3/2}} = 3 \\frac{k_B T}{m} $$\nAn alternative, more direct derivation of $\\langle v^2 \\rangle$ uses the equipartition theorem, a fundamental consequence of classical statistical mechanics for systems with quadratic energy terms. The average kinetic energy is $\\langle E_k \\rangle = \\langle \\frac{1}{2}mv^2 \\rangle$. For three translational degrees of freedom, $\\langle E_k \\rangle = 3 \\times \\frac{1}{2}k_B T$. Equating these gives $\\frac{1}{2}m\\langle v^2 \\rangle = \\frac{3}{2}k_B T$, which directly yields $\\langle v^2 \\rangle = \\frac{3k_B T}{m}$.\n\nThe root-mean-square speed is therefore:\n$$ v_{\\mathrm{rms}} = \\sqrt{\\langle v^2 \\rangle} = \\sqrt{\\frac{3k_B T}{m}} $$\nThe scaling law for the rms speed is $v_{\\mathrm{rms}} \\propto \\sqrt{\\frac{T}{m}}$.\n\n**3. Calculation of Ratios**\nBoth gases are at the same temperature $T$.\nFor gas $1$ (mass $m_1$): $\\langle v \\rangle_1 = \\sqrt{\\frac{8k_B T}{\\pi m_1}}$ and $v_{\\mathrm{rms},1} = \\sqrt{\\frac{3k_B T}{m_1}}$.\nFor gas $2$ (mass $m_2$): $\\langle v \\rangle_2 = \\sqrt{\\frac{8k_B T}{\\pi m_2}}$ and $v_{\\mathrm{rms},2} = \\sqrt{\\frac{3k_B T}{m_2}}$.\n\nThe ratio of mean speeds is:\n$$ \\frac{\\langle v \\rangle_1}{\\langle v \\rangle_2} = \\frac{\\sqrt{\\frac{8k_B T}{\\pi m_1}}}{\\sqrt{\\frac{8k_B T}{\\pi m_2}}} = \\sqrt{\\frac{1/m_1}{1/m_2}} = \\sqrt{\\frac{m_2}{m_1}} $$\n\nThe ratio of root-mean-square speeds is:\n$$ \\frac{v_{\\mathrm{rms},1}}{v_{\\mathrm{rms},2}} = \\frac{\\sqrt{\\frac{3k_B T}{m_1}}}{\\sqrt{\\frac{3k_B T}{m_2}}} = \\sqrt{\\frac{1/m_1}{1/m_2}} = \\sqrt{\\frac{m_2}{m_1}} $$\nAs expected from their identical scaling with mass, both ratios are the same.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{\\frac{m_2}{m_1}}  \\sqrt{\\frac{m_2}{m_1}}\n\\end{pmatrix}\n}\n$$", "id": "2947195"}, {"introduction": "The Maxwell-Boltzmann distribution is asymmetric, which gives rise to three distinct measures of a typical molecular speed: the most probable ($v_{\\mathrm{mp}}$), the mean ($\\langle v \\rangle$), and the root-mean-square ($v_{\\mathrm{rms}}$). This practice problem [@problem_id:2947207] directly confronts the common misconception that these values are interchangeable. By calculating and comparing $v_{\\mathrm{mp}}$ and $v_{\\mathrm{rms}}$ for a real gas, you will gain a concrete, quantitative appreciation for the shape and meaning of the speed distribution.", "problem": "A common student assertion in kinetic theory is that the root-mean-square speed $v_{\\mathrm{rms}}$ equals the most probable speed $v_{\\mathrm{mp}}$ for a gas at a given temperature. Consider a dilute monatomic ideal gas of neon at temperature $T = 400\\,\\mathrm{K}$ with molar mass $M = 20.1797\\,\\mathrm{g\\,mol^{-1}}$. Using only the Boltzmann factor for translational kinetic energy, isotropy of velocity space, and standard constants, construct a quantitative counterexample by deriving expressions for $v_{\\mathrm{mp}}$ and $v_{\\mathrm{rms}}$ from first principles and then evaluating them numerically for these $T$ and $M$. Take the ideal-gas constant to be $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ and use $M$ in $\\mathrm{kg\\,mol^{-1}}$ when needed. Which option correctly furnishes a valid counterexample (i.e., a pair of unequal numerical values for $v_{\\mathrm{rms}}$ and $v_{\\mathrm{mp}}$ that follows from the correct first-principles derivation) for neon at $T = 400\\,\\mathrm{K}$?\n\n- A. $v_{\\mathrm{rms}} \\approx 703\\,\\mathrm{m\\,s^{-1}}$ and $v_{\\mathrm{mp}} \\approx 574\\,\\mathrm{m\\,s^{-1}}$\n\n- B. $v_{\\mathrm{rms}} = v_{\\mathrm{mp}} \\approx 574\\,\\mathrm{m\\,s^{-1}}$\n\n- C. $v_{\\mathrm{rms}} \\approx 574\\,\\mathrm{m\\,s^{-1}}$ and $v_{\\mathrm{mp}} \\approx 703\\,\\mathrm{m\\,s^{-1}}$\n\n- D. $v_{\\mathrm{rms}} = v_{\\mathrm{mp}} \\approx 648\\,\\mathrm{m\\,s^{-1}}$", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- The system is a dilute monatomic ideal gas.\n- The gas is neon.\n- Temperature: $T = 400\\,\\mathrm{K}$.\n- Molar mass of neon: $M = 20.1797\\,\\mathrm{g\\,mol^{-1}}$.\n- Ideal gas constant: $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- The problem is to evaluate the assertion that the root-mean-square speed $v_{\\mathrm{rms}}$ equals the most probable speed $v_{\\mathrm{mp}}$.\n- The derivation must be from first principles, using only the Boltzmann factor for translational kinetic energy, isotropy of velocity space, and standard constants.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is rooted in the kinetic theory of gases and statistical mechanics, specifically the Maxwell-Boltzmann distribution. These are well-established and fundamental scientific theories.\n- **Well-Posed:** All necessary data ($T$, $M$, $R$) are provided. The quantities to be derived ($v_{\\mathrm{rms}}$, $v_{\\mathrm{mp}}$) are unambiguously defined. A unique, stable, and meaningful solution exists.\n- **Objective:** The problem is phrased in a precise, quantitative, and unbiased manner. It asks for a scientific refutation of a specific assertion.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically sound, well-posed, and complete. I will proceed with the derivation and solution.\n\nThe task is to refute the student assertion that $v_{\\mathrm{rms}} = v_{\\mathrm{mp}}$. This will be achieved by deriving the expressions for both quantities from first principles, as stipulated.\n\n**Derivation of the Maxwell-Boltzmann Speed Distribution**\n\nLet a molecule have mass $m$ and velocity $\\vec{v} = (v_x, v_y, v_z)$. The translational kinetic energy is $\\epsilon = \\frac{1}{2}m v^2 = \\frac{1}{2}m(v_x^2 + v_y^2 + v_z^2)$.\n\nAccording to the Boltzmann factor, the probability of a molecule having a velocity component $v_x$ is proportional to $e^{-\\epsilon_x / (k_B T)}$, where $\\epsilon_x = \\frac{1}{2}m v_x^2$ and $k_B$ is the Boltzmann constant.\nThe probability density function for $v_x$ is thus of the form $g(v_x) = C e^{-m v_x^2 / (2 k_B T)}$. The normalization constant $C$ is found by requiring $\\int_{-\\infty}^{\\infty} g(v_x) dv_x = 1$. Using the Gaussian integral $\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$, with $a = m/(2 k_B T)$, we find $C = \\sqrt{m/(2\\pi k_B T)}$.\nSo, the normalized distribution for one component is:\n$$g(v_x) = \\left(\\frac{m}{2\\pi k_B T}\\right)^{1/2} e^{-\\frac{m v_x^2}{2 k_B T}}$$\nDue to the isotropy of space, the velocity components are independent and identically distributed. The probability density for a velocity vector $\\vec{v}$ is:\n$$f(\\vec{v}) = g(v_x) g(v_y) g(v_z) = \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} e^{-\\frac{m(v_x^2+v_y^2+v_z^2)}{2 k_B T}} = \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} e^{-\\frac{m v^2}{2 k_B T}}$$\nTo find the distribution of speeds $v = |\\vec{v}|$, we change to spherical coordinates in velocity space. The volume element is $d^3\\vec{v} = v^2 \\sin\\theta dv d\\theta d\\phi$. Integrating over all angles ($\\int_0^{2\\pi} d\\phi \\int_0^\\pi \\sin\\theta d\\theta = 4\\pi$) gives the probability $F(v)dv$ of finding a molecule with speed between $v$ and $v+dv$:\n$$F(v)dv = \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} e^{-\\frac{m v^2}{2 k_B T}} (4\\pi v^2 dv)$$\nThe Maxwell-Boltzmann speed distribution function is therefore:\n$$F(v) = 4\\pi \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} v^2 e^{-\\frac{m v^2}{2 k_B T}}$$\n\n**Derivation of the Most Probable Speed ($v_{\\mathrm{mp}}$)**\n\nThe most probable speed $v_{\\mathrm{mp}}$ corresponds to the maximum of the distribution function $F(v)$. We find this by setting the derivative $\\frac{dF(v)}{dv}$ to zero.\n$$\\frac{d}{dv} \\left(v^2 e^{-\\frac{m v^2}{2 k_B T}}\\right) = 0$$\nUsing the product rule:\n$$2v e^{-\\frac{m v^2}{2 k_B T}} + v^2 \\left(-\\frac{2mv}{2 k_B T}\\right) e^{-\\frac{m v^2}{2 k_B T}} = 0$$\nFor $v  0$, we can divide by $v e^{-\\frac{m v^2}{2 k_B T}}$:\n$$2 - \\frac{m v^2}{k_B T} = 0$$\nSolving for $v$ gives the most probable speed, $v_{\\mathrm{mp}}$:\n$$v_{\\mathrm{mp}}^2 = \\frac{2 k_B T}{m} \\implies v_{\\mathrm{mp}} = \\sqrt{\\frac{2 k_B T}{m}}$$\nUsing molar quantities, where $R = N_A k_B$ and $M = N_A m$ ($N_A$ is Avogadro's number):\n$$v_{\\mathrm{mp}} = \\sqrt{\\frac{2 (R/N_A) T}{(M/N_A)}} = \\sqrt{\\frac{2 R T}{M}}$$\n\n**Derivation of the Root-Mean-Square Speed ($v_{\\mathrm{rms}}$)**\n\nThe root-mean-square speed $v_{\\mathrm{rms}}$ is the square root of the mean square speed, $\\langle v^2 \\rangle$. The mean square speed is defined as:\n$$\\langle v^2 \\rangle = \\int_0^\\infty v^2 F(v) dv = \\int_0^\\infty v^2 \\left( 4\\pi \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} v^2 e^{-\\frac{m v^2}{2 k_B T}} \\right) dv$$\n$$\\langle v^2 \\rangle = 4\\pi \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\int_0^\\infty v^4 e^{-\\frac{m v^2}{2 k_B T}} dv$$\nLet $a = \\frac{m}{2 k_B T}$. The integral is of the form $\\int_0^\\infty x^4 e^{-ax^2} dx = \\frac{3}{8}\\sqrt{\\frac{\\pi}{a^5}}$.\nSubstituting this result:\n$$\\langle v^2 \\rangle = 4\\pi \\left(\\frac{a}{\\pi}\\right)^{3/2} \\left(\\frac{3}{8}\\sqrt{\\frac{\\pi}{a^5}}\\right) = 4\\pi \\frac{a^{3/2}}{\\pi^{3/2}} \\frac{3\\pi^{1/2}}{8 a^{5/2}} = \\frac{12\\pi a^{3/2} \\pi^{1/2}}{8 \\pi^{3/2} a^{5/2}} = \\frac{3}{2a}$$\nSubstituting back $a = \\frac{m}{2 k_B T}$:\n$$\\langle v^2 \\rangle = \\frac{3}{2(m/(2 k_B T))} = \\frac{3 k_B T}{m}$$\nTherefore, the root-mean-square speed is:\n$$v_{\\mathrm{rms}} = \\sqrt{\\langle v^2 \\rangle} = \\sqrt{\\frac{3 k_B T}{m}}$$\nIn molar quantities:\n$$v_{\\mathrm{rms}} = \\sqrt{\\frac{3 R T}{M}}$$\n\n**Quantitative Counterexample**\n\nFrom the derived expressions, we see that $v_{\\mathrm{rms}} = \\sqrt{\\frac{3 R T}{M}}$ and $v_{\\mathrm{mp}} = \\sqrt{\\frac{2 R T}{M}}$. It is immediately evident that $v_{\\mathrm{rms}} \\neq v_{\\mathrm{mp}}$. Specifically, $v_{\\mathrm{rms}} = \\sqrt{3/2} \\cdot v_{\\mathrm{mp}} \\approx 1.225 \\cdot v_{\\mathrm{mp}}$. The student assertion is thus proven false from first principles.\n\nNow we perform the numerical calculation for neon at $T = 400\\,\\mathrm{K}$.\nGiven:\n$T = 400\\,\\mathrm{K}$\n$M = 20.1797\\,\\mathrm{g\\,mol^{-1}} = 0.0201797\\,\\mathrm{kg\\,mol^{-1}}$\n$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\nCalculation of $v_{\\mathrm{mp}}$:\n$$v_{\\mathrm{mp}} = \\sqrt{\\frac{2 \\times (8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (400\\,\\mathrm{K})}{0.0201797\\,\\mathrm{kg\\,mol^{-1}}}} \\approx \\sqrt{\\frac{6651.57}{0.0201797}}\\,\\mathrm{m\\,s^{-1}} \\approx \\sqrt{329617.45}\\,\\mathrm{m\\,s^{-1}} \\approx 574.12\\,\\mathrm{m\\,s^{-1}}$$\n\nCalculation of $v_{\\mathrm{rms}}$:\n$$v_{\\mathrm{rms}} = \\sqrt{\\frac{3 \\times (8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (400\\,\\mathrm{K})}{0.0201797\\,\\mathrm{kg\\,mol^{-1}}}} \\approx \\sqrt{\\frac{9977.36}{0.0201797}}\\,\\mathrm{m\\,s^{-1}} \\approx \\sqrt{494426.18}\\,\\mathrm{m\\,s^{-1}} \\approx 703.15\\,\\mathrm{m\\,s^{-1}}$$\n\nRounding to the nearest integer as in the options, we obtain $v_{\\mathrm{mp}} \\approx 574\\,\\mathrm{m\\,s^{-1}}$ and $v_{\\mathrm{rms}} \\approx 703\\,\\mathrm{m\\,s^{-1}}$.\n\n**Evaluation of Options**\n\n- **A. $v_{\\mathrm{rms}} \\approx 703\\,\\mathrm{m\\,s^{-1}}$ and $v_{\\mathrm{mp}} \\approx 574\\,\\mathrm{m\\,s^{-1}}$**\nThis option presents the values that match our rigorous derivation and numerical calculation. It correctly shows that $v_{\\mathrm{rms}}  v_{\\mathrm{mp}}$ and provides the correct numerical values. This constitutes a valid counterexample.\n**Verdict: Correct**\n\n- **B. $v_{\\mathrm{rms}} = v_{\\mathrm{mp}} \\approx 574\\,\\mathrm{m\\,s^{-1}}$**\nThis option presents the fallacious assertion that $v_{\\mathrm{rms}} = v_{\\mathrm{mp}}$. The derivation proves this is false. It also incorrectly assigns the value of $v_{\\mathrm{mp}}$ to $v_{\\mathrm{rms}}$.\n**Verdict: Incorrect**\n\n- **C. $v_{\\mathrm{rms}} \\approx 574\\,\\mathrm{m\\,s^{-1}}$ and $v_{\\mathrm{mp}} \\approx 703\\,\\mathrm{m\\,s^{-1}}$**\nThis option correctly recognizes that the speeds are unequal but incorrectly swaps their values. The derivation shows $v_{\\mathrm{rms}} = \\sqrt{3/2} \\cdot v_{\\mathrm{mp}}$, so $v_{\\mathrm{rms}}$ must be larger than $v_{\\mathrm{mp}}$.\n**Verdict: Incorrect**\n\n- **D. $v_{\\mathrm{rms}} = v_{\\mathrm{mp}} \\approx 648\\,\\mathrm{m\\,s^{-1}}$**\nThis option also presents the false assertion $v_{\\mathrm{rms}} = v_{\\mathrm{mp}}$. The numerical value $648\\,\\mathrm{m\\,s^{-1}}$ is approximately the average speed, $v_{\\mathrm{avg}} = \\sqrt{8RT/\\pi M} \\approx 647.7\\,\\mathrm{m\\,s^{-1}}$. This is irrelevant and wrong on multiple levels.\n**Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "2947207"}, {"introduction": "Modern scientific inquiry relies on verifying theoretical models with computational simulations. This final practice provides a comprehensive, hands-on experience in this essential process [@problem_id:2947200]. You will construct the Maxwell-Boltzmann speed distribution from the ground up by sampling individual velocity components from their underlying Gaussian distributions, and then use powerful statistical tools to validate your simulated data against the exact theoretical predictions.", "problem": "A single non-interacting atom in a dilute monatomic ideal gas at thermodynamic equilibrium and absolute temperature $T$ has kinetic energy $E = \\frac{1}{2} m v^{2}$, where $m$ is the particle mass and $v$ is the speed. In the canonical ensemble, the probability density in velocity space is proportional to $\\exp\\!\\left(- \\frac{E}{k_{\\mathrm{B}} T}\\right)$, where $k_{\\mathrm{B}}$ is the Boltzmann constant. Using this as the fundamental base, proceed as follows.\n\n- Show from first principles that the three Cartesian components of the velocity, $(v_{x}, v_{y}, v_{z})$, are independent and identically distributed Gaussian random variables with mean $0$ and variance $\\sigma^{2} = \\frac{k_{\\mathrm{B}} T}{m}$.\n- Using a transformation to spherical coordinates in velocity space, derive the one-dimensional probability density function (Probability Density Function (PDF)) for the scalar speed $v = \\sqrt{v_{x}^{2} + v_{y}^{2} + v_{z}^{2}}$. From this, obtain the corresponding cumulative distribution function (Cumulative Distribution Function (CDF)) $F(v)$ in terms of elementary functions and the error function.\n- Derive closed-form expressions for the mean speed $\\langle v \\rangle$ and the mean squared speed $\\langle v^{2} \\rangle$, and verify that $\\frac{1}{2} m \\langle v^{2} \\rangle = \\frac{3}{2} k_{\\mathrm{B}} T$ as required by the equipartition theorem.\n- Design an algorithm to sample molecular velocities in three dimensions by drawing three independent Gaussian deviates with variance $\\sigma^{2} = \\frac{k_{\\mathrm{B}} T}{m}$ and mean $0$, assembling them into a velocity vector $(v_{x}, v_{y}, v_{z})$, and then computing the speed $v$ as its Euclidean norm. Use a Monte Carlo (MC) sample of size $N$ to empirically approximate the speed distribution.\n- To verify that the sampled speeds follow the theoretically derived speed CDF, compute the Kolmogorov–Smirnov (KS) statistic, defined as the supremum over $v \\in [0, \\infty)$ of the absolute difference between the empirical CDF and the theoretical CDF. Additionally, compute two dimensionless diagnostics: the relative error in the mean speed, $\\left|\\langle v \\rangle_{\\mathrm{emp}} - \\langle v \\rangle_{\\mathrm{th}}\\right| / \\langle v \\rangle_{\\mathrm{th}}$, and the relative error in the mean kinetic energy, $\\left|\\frac{1}{2} m \\langle v^{2} \\rangle_{\\mathrm{emp}} - \\frac{3}{2} k_{\\mathrm{B}} T\\right| \\big/ \\left(\\frac{3}{2} k_{\\mathrm{B}} T\\right)$.\n- Use the Boltzmann constant $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\ \\mathrm{J \\, K^{-1}}$. All physical quantities must be expressed in International System of Units (SI). Masses must be given in kilograms, temperatures in kelvin, speeds in $\\mathrm{m \\, s^{-1}}$, and energies in joules. Your computed diagnostics are dimensionless and should be reported as decimal floats.\n\nImplement a program that performs the sampling and verification for the following test suite. In each case, use the provided pseudorandom seed for reproducibility, and draw exactly $N$ independent three-dimensional velocity vectors as described. Atomic masses are specified in atomic mass units (convert using $1 \\ \\mathrm{u} = 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg}$), then use the converted mass in kilograms in all computations.\n\n- Test case $1$ (happy path): Argon, mass $39.948 \\ \\mathrm{u}$, $T = 300 \\ \\mathrm{K}$, $N = 200000$, seed $12345$.\n- Test case $2$ (low temperature, light atom): Helium, mass $4.002602 \\ \\mathrm{u}$, $T = 10 \\ \\mathrm{K}$, $N = 100000$, seed $24680$.\n- Test case $3$ (high temperature, heavy atom): Xenon, mass $131.293 \\ \\mathrm{u}$, $T = 1000 \\ \\mathrm{K}$, $N = 150000$, seed $13579$.\n- Test case $4$ (small sample boundary): Nitrogen, mass $28.0134 \\ \\mathrm{u}$, $T = 300 \\ \\mathrm{K}$, $N = 5000$, seed $98765$.\n\nFor each test case, compute and return a list of three floats: \n- the Kolmogorov–Smirnov statistic,\n- the relative error in the mean speed,\n- the relative error in the mean kinetic energy.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing a list of the four test-case results in order, where each test-case result is itself a list of three floats. The overall format must be a single bracketed list with comma-separated entries and no spaces, for example, $[[a_{11},a_{12},a_{13}],[a_{21},a_{22},a_{23}],[a_{31},a_{32},a_{33}],[a_{41},a_{42},a_{43}]]$.\n- Each float in the output must be formatted to exactly six digits after the decimal point.", "solution": "The problem is scientifically grounded, well-posed, and contains all necessary information for a complete solution. It is a standard exercise in statistical mechanics, combining theoretical derivations with numerical verification. The problem is therefore deemed valid.\n\nThe solution proceeds in two stages. First, the required theoretical expressions are derived from first principles. Second, an algorithm is designed and implemented to perform a Monte Carlo simulation and compute the specified diagnostics.\n\n**Theoretical Derivations**\n\n**1. Velocity Component Distribution**\n\nThe problem states that the probability density function (PDF) for a velocity vector $\\vec{v} = (v_x, v_y, v_z)$ in the canonical ensemble is proportional to $\\exp(-E / (k_{\\mathrm{B}} T))$. The kinetic energy is purely translational:\n$$E = \\frac{1}{2} m v^2 = \\frac{1}{2} m (v_x^2 + v_y^2 + v_z^2)$$\nwhere $m$ is the mass of the atom, $T$ is the absolute temperature, and $k_{\\mathrm{B}}$ is the Boltzmann constant.\n\nThe joint PDF for the velocity components is therefore:\n$$P(v_x, v_y, v_z) \\propto \\exp\\left(-\\frac{m(v_x^2 + v_y^2 + v_z^2)}{2 k_{\\mathrm{B}} T}\\right)$$\nThis expression can be factorized into three independent functions of $v_x$, $v_y$, and $v_z$:\n$$P(v_x, v_y, v_z) \\propto \\exp\\left(-\\frac{m v_x^2}{2 k_{\\mathrm{B}} T}\\right) \\exp\\left(-\\frac{m v_y^2}{2 k_{\\mathrm{B}} T}\\right) \\exp\\left(-\\frac{m v_z^2}{2 k_{\\mathrm{B}} T}\\right)$$\nThe factorization implies that the velocity components $v_x$, $v_y$, and $v_z$ are statistically independent random variables. The PDF for any single component, say $v_x$, is:\n$$p(v_x) \\propto \\exp\\left(-\\frac{m v_x^2}{2 k_{\\mathrm{B}} T}\\right)$$\nThis is the functional form of a Gaussian (normal) distribution, whose general PDF is given by:\n$$f(x; \\mu, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right)$$\nBy comparing the exponent in $p(v_x)$ with the general form, we identify the mean $\\mu = 0$ and the variance $\\sigma^2$ by setting the coefficients of the quadratic term equal:\n$$\\frac{m}{2 k_{\\mathrm{B}} T} = \\frac{1}{2\\sigma^2} \\implies \\sigma^2 = \\frac{k_{\\mathrm{B}} T}{m}$$\nSince the functional form is identical for $v_x$, $v_y$, and $v_z$, the three components are independent and identically distributed (i.i.d.) Gaussian random variables with mean $0$ and variance $\\sigma^2 = k_{\\mathrm{B}} T / m$.\n\n**2. Speed Distribution (Maxwell-Boltzmann)**\n\nTo derive the PDF for the scalar speed $v = \\sqrt{v_x^2 + v_y^2 + v_z^2}$, we transform the joint PDF from Cartesian velocity coordinates $(v_x, v_y, v_z)$ to spherical coordinates $(v, \\theta, \\phi)$, where $v \\in [0, \\infty)$, $\\theta \\in [0, \\pi]$, and $\\phi \\in [0, 2\\pi)$. The volume element in velocity space transforms as $dv_x dv_y dv_z = v^2 \\sin\\theta \\, dv \\, d\\theta \\, d\\phi$.\n\nThe normalized joint PDF in Cartesian coordinates is:\n$$P(v_x, v_y, v_z) = \\left(\\frac{m}{2\\pi k_{\\mathrm{B}} T}\\right)^{3/2} \\exp\\left(-\\frac{m(v_x^2 + v_y^2 + v_z^2)}{2 k_{\\mathrm{B}} T}\\right)$$\nThe probability of finding the velocity vector in an infinitesimal volume element is $P(v_x, v_y, v_z) \\, dv_x dv_y dv_z$. In spherical coordinates, this probability is:\n$$d\\text{Prob} = \\left(\\frac{m}{2\\pi k_{\\mathrm{B}} T}\\right)^{3/2} \\exp\\left(-\\frac{m v^2}{2 k_{\\mathrm{B}} T}\\right) v^2 \\sin\\theta \\, dv \\, d\\theta \\, d\\phi$$\nTo find the PDF for the speed $v$, denoted $f(v)$, we integrate over all possible solid angles:\n$$f(v) dv = \\left[ \\int_0^{2\\pi} \\int_0^{\\pi} \\left(\\frac{m}{2\\pi k_{\\mathrm{B}} T}\\right)^{3/2} \\exp\\left(-\\frac{m v^2}{2 k_{\\mathrm{B}} T}\\right) v^2 \\sin\\theta \\, d\\theta \\, d\\phi \\right] dv$$\nThe integral over the angular parts is $\\int_0^{2\\pi} d\\phi \\int_0^{\\pi} \\sin\\theta \\, d\\theta = (2\\pi)(2) = 4\\pi$.\nThus, the speed PDF is:\n$$f(v) = 4\\pi \\left(\\frac{m}{2\\pi k_{\\mathrm{B}} T}\\right)^{3/2} v^2 \\exp\\left(-\\frac{m v^2}{2 k_{\\mathrm{B}} T}\\right)$$\nThis is the Maxwell-Boltzmann distribution for molecular speeds.\n\nThe cumulative distribution function (CDF), $F(v)$, is the integral of the PDF from $0$ to $v$:\n$$F(v) = \\int_0^v f(u) \\, du = 4\\pi \\left(\\frac{m}{2\\pi k_{\\mathrm{B}} T}\\right)^{3/2} \\int_0^v u^2 \\exp\\left(-\\frac{m u^2}{2 k_{\\mathrm{B}} T}\\right) du$$\nLet $a = m / (2k_{\\mathrm{B}} T)$ and perform a change of variables $x = u\\sqrt{a}$. Then $du = dx/\\sqrt{a}$. The integral becomes:\n$$F(v) = 4\\pi \\left(\\frac{a}{\\pi}\\right)^{3/2} \\int_0^{v\\sqrt{a}} \\left(\\frac{x}{\\sqrt{a}}\\right)^2 e^{-x^2} \\frac{dx}{\\sqrt{a}} = \\frac{4}{\\sqrt{\\pi}} \\int_0^{v\\sqrt{a}} x^2 e^{-x^2} dx$$\nUsing integration by parts on $\\int x^2 e^{-x^2} dx$ with $u=x$ and $dv'=x e^{-x^2} dx$, we find $\\int x^2 e^{-x^2} dx = -\\frac{1}{2} x e^{-x^2} + \\frac{1}{2} \\int e^{-x^2} dx$.\nWith the definition of the error function, $\\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_0^z e^{-x^2} dx$, the definite integral is:\n$$\\int_0^{z} x^2 e^{-x^2} dx = \\left[-\\frac{1}{2} x e^{-x^2}\\right]_0^z + \\frac{1}{2} \\int_0^z e^{-x^2} dx = -\\frac{1}{2} z e^{-z^2} + \\frac{\\sqrt{\\pi}}{4} \\text{erf}(z)$$\nSubstituting $z = v\\sqrt{a}$, the CDF becomes:\n$$F(v) = \\frac{4}{\\sqrt{\\pi}} \\left(-\\frac{1}{2} v\\sqrt{a} \\, e^{-av^2} + \\frac{\\sqrt{\\pi}}{4} \\text{erf}(v\\sqrt{a})\\right)$$\n$$F(v) = \\text{erf}\\left(v\\sqrt{\\frac{m}{2 k_{\\mathrm{B}} T}}\\right) - \\frac{2}{\\sqrt{\\pi}} v\\sqrt{\\frac{m}{2 k_{\\mathrm{B}} T}} \\exp\\left(-\\frac{m v^2}{2 k_{\\mathrm{B}} T}\\right)$$\n\n**3. Mean Speed and Mean Squared Speed**\n\nThe mean speed $\\langle v \\rangle$ is the first moment of the speed PDF:\n$$\\langle v \\rangle = \\int_0^{\\infty} v f(v) \\, dv = 4\\pi \\left(\\frac{a}{\\pi}\\right)^{3/2} \\int_0^{\\infty} v^3 e^{-av^2} dv$$\nUsing the standard integral $\\int_0^{\\infty} x^3 e^{-ax^2} dx = 1/(2a^2)$, we get:\n$$\\langle v \\rangle = 4\\pi \\left(\\frac{a}{\\pi}\\right)^{3/2} \\frac{1}{2a^2} = \\frac{2}{\\sqrt{\\pi a}} = \\sqrt{\\frac{4}{\\pi a}} = \\sqrt{\\frac{4}{\\pi} \\frac{2k_{\\mathrm{B}}T}{m}} = \\sqrt{\\frac{8 k_{\\mathrm{B}} T}{\\pi m}}$$\nThe mean squared speed $\\langle v^2 \\rangle$ is the second moment:\n$$\\langle v^2 \\rangle = \\int_0^{\\infty} v^2 f(v) \\, dv = 4\\pi \\left(\\frac{a}{\\pi}\\right)^{3/2} \\int_0^{\\infty} v^4 e^{-av^2} dv$$\nUsing the standard integral $\\int_0^{\\infty} x^4 e^{-ax^2} dx = \\frac{3}{8}\\sqrt{\\frac{\\pi}{a^5}}$, we get:\n$$\\langle v^2 \\rangle = 4\\pi \\left(\\frac{a}{\\pi}\\right)^{3/2} \\frac{3}{8} \\sqrt{\\frac{\\pi}{a^5}} = \\frac{3}{2a} = \\frac{3 k_{\\mathrm{B}} T}{m}$$\nFinally, we verify the equipartition theorem. The mean kinetic energy is:\n$$\\langle E \\rangle = \\frac{1}{2} m \\langle v^2 \\rangle = \\frac{1}{2} m \\left(\\frac{3 k_{\\mathrm{B}} T}{m}\\right) = \\frac{3}{2} k_{\\mathrm{B}} T$$\nThis result is correct, as a monatomic particle has $3$ translational degrees of freedom, each contributing $\\frac{1}{2} k_{\\mathrm{B}} T$ to the average energy.\n\n**Algorithm Design and Verification**\n\nThe algorithm implements a Monte Carlo simulation based on the derived principles.\n\n1.  **Initialization**: For each test case (mass $m_u$, temperature $T$, sample size $N$, seed), set physical constants $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\, \\mathrm{J \\, K^{-1}}$ and $1 \\, \\mathrm{u} = 1.66053906660 \\times 10^{-27} \\, \\mathrm{kg}$. Convert the mass from atomic mass units to kilograms: $m = m_u \\times (1.66053906660 \\times 10^{-27})$.\n2.  **Parameter Calculation**: Calculate the variance $\\sigma^2 = k_{\\mathrm{B}} T / m$ and a related parameter $a = m / (2k_{\\mathrm{B}} T)$ needed for theoretical calculations.\n3.  **Velocity Sampling**:\n    *   Initialize a pseudorandom number generator with the specified seed for reproducibility.\n    *   Generate a sample of $N \\times 3$ independent random numbers from a standard normal distribution (mean $0$, variance $1$).\n    *   Reshape this into an $N \\times 3$ array, representing $N$ sets of $(g_x, g_y, g_z)$.\n    *   Scale these deviates by the standard deviation $\\sigma = \\sqrt{\\sigma^2}$ to produce $N$ velocity vectors $(v_x, v_y, v_z)$, where each component is drawn from $N(0, \\sigma^2)$.\n4.  **Speed Calculation**: For each velocity vector, compute the speed $v = \\sqrt{v_x^2 + v_y^2 + v_z^2}$. This results in a sample of $N$ speeds.\n5.  **Diagnostic Calculation**:\n    *   **Kolmogorov-Smirnov (KS) Statistic**: This statistic measures the maximum absolute difference between the empirical CDF (ECDF) of the sampled speeds and the theoretical CDF, $F(v)$. The ECDF is constructed from the sorted sample of speeds. The `scipy.stats.kstest` function is used to compare the sampled speeds against the derived theoretical CDF, $F(v)$.\n    *   **Relative Error in Mean Speed**: The empirical mean speed $\\langle v \\rangle_{\\mathrm{emp}}$ is the arithmetic average of the $N$ sampled speeds. The theoretical mean speed is $\\langle v \\rangle_{\\mathrm{th}} = \\sqrt{8k_{\\mathrm{B}}T/(\\pi m)}$. The relative error is calculated as $|\\langle v \\rangle_{\\mathrm{emp}} - \\langle v \\rangle_{\\mathrm{th}}| / \\langle v \\rangle_{\\mathrm{th}}$.\n    *   **Relative Error in Mean Kinetic Energy**: The empirical mean squared speed $\\langle v^2 \\rangle_{\\mathrm{emp}}$ is the average of the squares of the sampled speeds. The empirical mean kinetic energy is $\\langle E \\rangle_{\\mathrm{emp}} = \\frac{1}{2} m \\langle v^2 \\rangle_{\\mathrm{emp}}$. The theoretical mean kinetic energy is $\\langle E \\rangle_{\\mathrm{th}} = \\frac{3}{2} k_{\\mathrm{B}} T$. The relative error is $| \\langle E \\rangle_{\\mathrm{emp}} - \\langle E \\rangle_{\\mathrm{th}} | / \\langle E \\rangle_{\\mathrm{th}}$.\n\nThis procedure is applied to each test case provided in the problem statement.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import kstest\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Solves the problem by running Monte Carlo simulations for each test case\n    and computing the required diagnostics.\n    \"\"\"\n    # Define constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    U_TO_KG = 1.66053906660e-27  # Atomic mass unit to kg\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (mass_u, T_K, N, seed)\n        (39.948, 300.0, 200000, 12345),      # Argon\n        (4.002602, 10.0, 100000, 24680),     # Helium\n        (131.293, 1000.0, 150000, 13579),    # Xenon\n        (28.0134, 300.0, 5000, 98765),       # Nitrogen (as point mass)\n    ]\n\n    results = []\n    for mass_u, T, N, seed in test_cases:\n        # Step 1: Initialization and Parameter Calculation\n        m_kg = mass_u * U_TO_KG\n        \n        # Variance of velocity components\n        sigma_sq = (K_B * T) / m_kg\n        sigma = np.sqrt(sigma_sq)\n        \n        # Parameter 'a' for theoretical formulas\n        a = m_kg / (2.0 * K_B * T)\n        sqrt_a = np.sqrt(a)\n\n        # Step 2: Sampling Velocities and Speeds\n        rng = np.random.default_rng(seed)\n        # Generate N velocity vectors (N, 3) with components from N(0, sigma^2)\n        velocity_vectors = rng.normal(loc=0.0, scale=sigma, size=(N, 3))\n        # Compute the speed (Euclidean norm) for each vector\n        sampled_speeds = np.linalg.norm(velocity_vectors, axis=1)\n\n        # Step 3: Compute Diagnostics\n        \n        # 3.1: Kolmogorov-Smirnov Statistic\n        \n        # Define the theoretical CDF F(v)\n        def theoretical_cdf(v):\n            z = v * sqrt_a\n            term1 = erf(z)\n            term2 = (2.0 / np.sqrt(np.pi)) * z * np.exp(-z**2)\n            return term1 - term2\n\n        # Perform the KS test\n        ks_result = kstest(sampled_speeds, theoretical_cdf)\n        ks_statistic = ks_result.statistic\n\n        # 3.2: Relative Error in Mean Speed\n        mean_speed_emp = np.mean(sampled_speeds)\n        mean_speed_th = np.sqrt(8.0 * K_B * T / (np.pi * m_kg))\n        rel_err_mean_speed = np.abs(mean_speed_emp - mean_speed_th) / mean_speed_th\n\n        # 3.3: Relative Error in Mean Kinetic Energy\n        mean_sq_speed_emp = np.mean(np.power(sampled_speeds, 2))\n        mean_energy_emp = 0.5 * m_kg * mean_sq_speed_emp\n        mean_energy_th = 1.5 * K_B * T\n        rel_err_mean_energy = np.abs(mean_energy_emp - mean_energy_th) / mean_energy_th\n\n        # Store the three computed diagnostics for this test case\n        results.append([ks_statistic, rel_err_mean_speed, rel_err_mean_energy])\n\n    # Final print statement in the exact required format.\n    sub_results = []\n    for res_tuple in results:\n        sub_results.append(f\"[{res_tuple[0]:.6f},{res_tuple[1]:.6f},{res_tuple[2]:.6f}]\")\n    final_output_str = f\"[{','.join(sub_results)}]\"\n    print(final_output_str)\n\nsolve()\n```", "id": "2947200"}]}