{"hands_on_practices": [{"introduction": "This problem goes to the heart of wetting phenomena by applying Young's equation, a cornerstone of surface science. You will move beyond a simple force-balance picture to calculate a fundamental, yet often difficult to measure, property: the solid-liquid interfacial tension, $\\gamma_{SL}$. This exercise [@problem_id:2945158] sharpens your ability not only to perform calculations but also to critically assess the thermodynamic plausibility of your results, a crucial skill in physical chemistry research.", "problem": "A sessile droplet of a pure liquid rests on a smooth, rigid, chemically homogeneous solid in quiescent air at constant temperature. The liquid, solid, and vapor are all at mechanical and thermal equilibrium. The droplet is sufficiently small that gravitational distortion is negligible, and contact-angle hysteresis, line tension, and adsorption-induced changes of surface energy can be neglected. The static contact angle is measured to be $\\theta = 50.0^{\\circ}$. Independent measurements give the liquid–vapor interfacial tension as $\\gamma_{LV} = 64.2$ mN m$^{-1}$ and the solid–vapor surface free energy as $\\gamma_{SV} = 47.5$ mN m$^{-1}$.\n\nStarting only from the following fundamentals:\n- The interfacial free energy is the excess Helmholtz free energy per unit area, so that the total interfacial contribution to the Helmholtz free energy for the droplet–solid–vapor system is $F = \\gamma_{SV} A_{SV} + \\gamma_{SL} A_{SL} + \\gamma_{LV} A_{LV}$, where $A_{ij}$ are the areas of the respective interfaces.\n- The equilibrium shape minimizes $F$ subject to fixed liquid volume, and equilibrium at the contact line requires in-plane force balance.\n\nDerive the relation that connects $\\gamma_{SV}$, $\\gamma_{SL}$, $\\gamma_{LV}$, and the contact angle $\\theta$. Then use it to compute the solid–liquid interfacial tension $\\gamma_{SL}$ for the system described above.\n\nFinally, assess the thermodynamic plausibility of the computed $\\gamma_{SL}$ by checking it against general constraints implied by equilibrium thermodynamics and the observed $\\theta$.\n\nExpress the final value of $\\gamma_{SL}$ in millinewtons per meter (mN m$^{-1}$) and round your answer to four significant figures. Your final answer should be a single numerical value.", "solution": "The problem statement is first subjected to critical validation.\n\nGivens extracted verbatim are:\n- A sessile droplet of a pure liquid on a smooth, rigid, chemically homogeneous solid in quiescent air at constant temperature.\n- The system is at mechanical and thermal equilibrium.\n- Assumptions: gravitational distortion is negligible; contact-angle hysteresis, line tension, and adsorption-induced changes of surface energy can be neglected.\n- Static contact angle $\\theta = 50.0^{\\circ}$.\n- Liquid–vapor interfacial tension $\\gamma_{LV} = 64.2$ mN m$^{-1}$.\n- Solid–vapor surface free energy $\\gamma_{SV} = 47.5$ mN m$^{-1}$.\n- Total interfacial Helmholtz free energy: $F = \\gamma_{SV} A_{SV} + \\gamma_{SL} A_{SL} + \\gamma_{LV} A_{LV}$.\n- Equilibrium condition: minimize $F$ at constant liquid volume, and equilibrium at the contact line requires in-plane force balance.\n\nThe problem is scientifically grounded, well-posed, and objective. It describes a classic, idealized system in surface thermodynamics and provides all necessary data and physical constraints to derive a well-known result and perform the required calculation. The premises are based on fundamental principles of thermodynamics and mechanics. The problem is therefore valid, and we may proceed with the solution.\n\nThe task is to derive the relation between the interfacial tensions and the contact angle, and then to compute the solid–liquid interfacial tension, $\\gamma_{SL}$. One of the specified fundamentals is the requirement of in-plane force balance at the three-phase contact line. We will use this mechanical analogy, where interfacial tensions are treated as forces per unit length acting along their respective interfaces.\n\nConsider a point on the circular contact line where the solid, liquid, and vapor phases meet. Three forces per unit length act on this line:\n1.  The solid–vapor tension, $\\gamma_{SV}$, acting along the plane of the solid, pulling away from the droplet.\n2.  The solid–liquid tension, $\\gamma_{SL}$, acting along the plane of the solid, pulling under the droplet.\n3.  The liquid–vapor tension, $\\gamma_{LV}$, acting tangentially to the liquid–vapor interface.\n\nFor mechanical equilibrium to exist, the vector sum of these forces must be zero. We are concerned with the components of these forces in the plane of the solid surface. The vertical component of $\\gamma_{LV}$ is balanced by a normal reaction force from the rigid solid and is not relevant to the horizontal equilibrium. The balance of forces in the horizontal plane is given by:\n$$\n\\gamma_{SV} = \\gamma_{SL} + \\gamma_{LV} \\cos(\\theta)\n$$\nThis is Young's equation. It is the relation connecting the three interfacial tensions and the static contact angle.\n\nThe problem requires the calculation of the solid–liquid interfacial tension, $\\gamma_{SL}$. We rearrange Young's equation to solve for $\\gamma_{SL}$:\n$$\n\\gamma_{SL} = \\gamma_{SV} - \\gamma_{LV} \\cos(\\theta)\n$$\nWe are given the following values:\n$\\gamma_{SV} = 47.5$ mN m$^{-1}$\n$\\gamma_{LV} = 64.2$ mN m$^{-1}$\n$\\theta = 50.0^{\\circ}$\n\nSubstituting these values into the equation:\n$$\n\\gamma_{SL} = 47.5 - 64.2 \\cos(50.0^{\\circ})\n$$\nThe cosine of $50.0^{\\circ}$ must be computed. $\\cos(50.0^{\\circ}) \\approx 0.6427876$.\n$$\n\\gamma_{SL} \\approx 47.5 - 64.2 \\times 0.6427876\n$$\n$$\n\\gamma_{SL} \\approx 47.5 - 41.26696...\n$$\n$$\n\\gamma_{SL} \\approx 6.23303... \\text{ mN m}^{-1}\n$$\nThe problem asks for the result to be rounded to four significant figures, which yields $\\gamma_{SL} = 6.233$ mN m$^{-1}$.\n\nFinally, we assess the thermodynamic plausibility of this result.\nFirst, a fundamental requirement for a stable interface is that its interfacial tension must be non-negative. Our calculated value, $\\gamma_{SL} \\approx 6.233$ mN m$^{-1}$, is positive, satisfying this basic condition. A negative value would imply an unstable interface that would spontaneously increase its area, which is unphysical.\n\nSecond, we consider the condition for partial wetting. A liquid forms a droplet with a finite contact angle ($\\theta  0^{\\circ}$) only if it does not spread spontaneously over the solid surface. Spreading is governed by the spreading coefficient, $S$:\n$$\nS = \\gamma_{SV} - (\\gamma_{SL} + \\gamma_{LV})\n$$\nIf $S  0$, the liquid partially wets the surface, consistent with an observed contact angle $\\theta  0^{\\circ}$. If $S \\ge 0$, the liquid spreads completely, resulting in $\\theta = 0^{\\circ}$.\nBy substituting Young's equation, $\\gamma_{SV} - \\gamma_{SL} = \\gamma_{LV} \\cos(\\theta)$, into the expression for $S$:\n$$\nS = \\gamma_{LV} \\cos(\\theta) - \\gamma_{LV} = \\gamma_{LV}(\\cos(\\theta) - 1)\n$$\nGiven that $\\gamma_{LV} = 64.2$ mN m$^{-1}  0$ and the contact angle is $\\theta = 50.0^{\\circ}$, we have $0^{\\circ}  \\theta  180^{\\circ}$. This means $\\cos(\\theta)  1$, and therefore $(\\cos(\\theta) - 1)$ is negative. Consequently, the spreading coefficient $S$ must be negative. This is fully consistent with the experimental observation of a finite contact angle.\n\nAnother check is the work of adhesion, $W_a$, which represents the work done to separate the liquid from the solid. It is defined as $W_a = \\gamma_{SV} + \\gamma_{LV} - \\gamma_{SL}$. For a stable interaction, $W_a$ must be positive. Using Young's equation, we can write this as the Young-Dupré equation:\n$$\nW_a = \\gamma_{LV}(1 + \\cos(\\theta))\n$$\nSince $\\gamma_{LV}  0$ and $\\theta = 50.0^{\\circ}$ (so $\\cos(\\theta)  0$), the work of adhesion $W_a$ is positive. This affirms the stability of the solid-liquid interface.\n\nThe computed value for $\\gamma_{SL}$ is thus positive and consistent with the conditions for partial wetting and stable adhesion, rendering it thermodynamically plausible.\nThe final numerical answer, rounded to four significant figures, is $6.233$.", "answer": "$$\\boxed{6.233}$$", "id": "2945158"}, {"introduction": "Viscosity is a measure of a fluid's resistance to flow, but its practical importance is best understood through dimensionless numbers that characterize flow regimes. This practice [@problem_id:2945220] places you in the role of a microfluidics engineer, tasked with determining if inertial forces can be safely ignored in a microchannel flow. By calculating the Reynolds number, you will connect the abstract Navier-Stokes equations to a concrete decision-making process that is fundamental to the design and analysis of microscale devices.", "problem": "A Newtonian binary aqueous mixture of glycerol and water at $298\\,\\mathrm{K}$ flows steadily through a straight, fully wetted, rectangular microchannel of width $w = 120\\,\\mu\\mathrm{m}$ and height $h = 30\\,\\mu\\mathrm{m}$. The fluid has density $\\rho = 1200\\,\\mathrm{kg\\,m^{-3}}$ and dynamic viscosity $\\mu = 0.015\\,\\mathrm{Pa\\cdot s}$. A syringe pump supplies a constant volumetric flow rate $Q = 0.25\\,\\mu\\mathrm{L\\,min^{-1}}$. Assume incompressible flow with the no-slip boundary condition.\n\nStarting from the incompressible momentum balance for a Newtonian fluid, use characteristic scales for velocity and length to identify the dimensionless ratio that compares inertial to viscous contributions for internal duct flow. For a noncircular duct, take the characteristic length to be the hydraulic diameter defined by $D_{h} \\equiv 4A/P$, where $A$ is the cross-sectional area and $P$ is the wetted perimeter. Using the given parameters, estimate the mean speed from the volumetric flow rate and evaluate this dimensionless ratio numerically. State whether neglect of inertia (creeping-flow approximation) is justified based on the magnitude of this ratio.\n\nRound your reported value of the dimensionless ratio to four significant figures. Express the final value as a pure number (dimensionless).", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is a standard exercise in fluid mechanics. Therefore, I will proceed with the solution.\n\nThe problem requires an analysis of fluid flow based on the momentum balance equation for an incompressible Newtonian fluid, which is the Navier-Stokes equation. For steady flow ($\\frac{\\partial \\mathbf{v}}{\\partial t} = \\mathbf{0}$) and in the absence of body forces, this equation is written as:\n$$\n\\rho (\\mathbf{v} \\cdot \\nabla) \\mathbf{v} = -\\nabla p + \\mu \\nabla^2 \\mathbf{v}\n$$\nHere, $\\rho$ is the fluid density, $\\mathbf{v}$ is the velocity vector, $p$ is the pressure, and $\\mu$ is the dynamic viscosity. The term on the left, $\\rho (\\mathbf{v} \\cdot \\nabla) \\mathbf{v}$, represents inertial forces per unit volume. The term $\\mu \\nabla^2 \\mathbf{v}$ represents viscous forces per unit volume.\n\nTo compare the magnitudes of these forces, we non-dimensionalize the equation. We introduce a characteristic length scale $L_c$ and a characteristic velocity scale $U_c$. The variables are scaled as follows: $\\mathbf{x}^* = \\mathbf{x}/L_c$ and $\\mathbf{v}^* = \\mathbf{v}/U_c$. The gradient operator becomes $\\nabla = \\frac{1}{L_c}\\nabla^*$. Substituting these into the steady-state equation gives:\n$$\n\\rho \\left( \\frac{U_c}{L_c} (\\mathbf{v}^* \\cdot \\nabla^*) (U_c \\mathbf{v}^*) \\right) \\sim - \\frac{1}{L_c}\\nabla^* p + \\mu \\frac{U_c}{L_c^2} \\nabla^{*2} \\mathbf{v}^*\n$$\nConsidering the order of magnitude of the inertial and viscous terms:\n$$\n\\text{Inertial term magnitude} \\sim \\frac{\\rho U_c^2}{L_c}\n$$\n$$\n\\text{Viscous term magnitude} \\sim \\frac{\\mu U_c}{L_c^2}\n$$\nThe dimensionless ratio that compares inertial to viscous contributions is the ratio of these two magnitudes:\n$$\n\\frac{\\text{Inertial forces}}{\\text{Viscous forces}} = \\frac{\\rho U_c^2 / L_c}{\\mu U_c / L_c^2} = \\frac{\\rho U_c L_c}{\\mu}\n$$\nThis dimensionless group is the Reynolds number, denoted $Re$. For this problem, the characteristic length $L_c$ is the hydraulic diameter $D_h$, and the characteristic velocity $U_c$ is the mean flow speed $U$. Thus, we must evaluate:\n$$\nRe = \\frac{\\rho U D_h}{\\mu}\n$$\n\nFirst, we calculate the required geometric and flow parameters from the given data.\nThe channel has a rectangular cross-section with width $w = 120\\,\\mu\\mathrm{m} = 1.2 \\times 10^{-4}\\,\\mathrm{m}$ and height $h = 30\\,\\mu\\mathrm{m} = 3.0 \\times 10^{-5}\\,\\mathrm{m}$.\n\nThe cross-sectional area $A$ is:\n$$\nA = w \\times h = (1.2 \\times 10^{-4}\\,\\mathrm{m}) \\times (3.0 \\times 10^{-5}\\,\\mathrm{m}) = 3.6 \\times 10^{-9}\\,\\mathrm{m^2}\n$$\nThe volumetric flow rate $Q$ is given as $0.25\\,\\mu\\mathrm{L\\,min^{-1}}$. We must convert this to SI units ($m^3 s^{-1}$):\n$$\nQ = 0.25\\,\\frac{\\mu\\mathrm{L}}{\\mathrm{min}} \\times \\frac{10^{-9}\\,\\mathrm{m^3}}{1\\,\\mu\\mathrm{L}} \\times \\frac{1\\,\\mathrm{min}}{60\\,\\mathrm{s}} = \\frac{0.25}{60} \\times 10^{-9}\\,\\mathrm{m^3\\,s^{-1}} \\approx 4.1667 \\times 10^{-12}\\,\\mathrm{m^3\\,s^{-1}}\n$$\nThe mean flow speed $U$ is the flow rate divided by the area:\n$$\nU = \\frac{Q}{A} = \\frac{\\frac{0.25}{60} \\times 10^{-9}\\,\\mathrm{m^3\\,s^{-1}}}{3.6 \\times 10^{-9}\\,\\mathrm{m^2}} = \\frac{0.25}{60 \\times 3.6}\\,\\mathrm{m\\,s^{-1}} = \\frac{0.25}{216}\\,\\mathrm{m\\,s^{-1}} \\approx 1.1574 \\times 10^{-3}\\,\\mathrm{m\\,s^{-1}}\n$$\nNext, we calculate the hydraulic diameter $D_h$. For a non-circular duct, it is defined as $D_h = 4A/P$, where $P$ is the wetted perimeter.\nThe wetted perimeter $P$ for the rectangular channel is:\n$$\nP = 2(w+h) = 2(1.2 \\times 10^{-4}\\,\\mathrm{m} + 3.0 \\times 10^{-5}\\,\\mathrm{m}) = 2(1.5 \\times 10^{-4}\\,\\mathrm{m}) = 3.0 \\times 10^{-4}\\,\\mathrm{m}\n$$\nThe hydraulic diameter $D_h$ is:\n$$\nD_h = \\frac{4A}{P} = \\frac{4 \\times (3.6 \\times 10^{-9}\\,\\mathrm{m^2})}{3.0 \\times 10^{-4}\\,\\mathrm{m}} = \\frac{14.4 \\times 10^{-9}}{3.0 \\times 10^{-4}}\\,\\mathrm{m} = 4.8 \\times 10^{-5}\\,\\mathrm{m}\n$$\nNow we have all quantities to calculate the Reynolds number, using the given fluid properties: density $\\rho = 1200\\,\\mathrm{kg\\,m^{-3}}$ and dynamic viscosity $\\mu = 0.015\\,\\mathrm{Pa\\cdot s}$.\n$$\nRe = \\frac{\\rho U D_h}{\\mu} = \\frac{(1200\\,\\mathrm{kg\\,m^{-3}}) \\times (\\frac{0.25}{216}\\,\\mathrm{m\\,s^{-1}}) \\times (4.8 \\times 10^{-5}\\,\\mathrm{m})}{0.015\\,\\mathrm{Pa\\cdot s}}\n$$\nLet us evaluate this expression:\n$$\nRe = \\frac{1200 \\times 0.25 \\times 4.8 \\times 10^{-5}}{216 \\times 0.015} = \\frac{300 \\times 4.8 \\times 10^{-5}}{3.24} = \\frac{1440 \\times 10^{-5}}{3.24} = \\frac{0.0144}{3.24}\n$$\n$$\nRe = \\frac{144 \\times 10^{-4}}{324 \\times 10^{-2}} = \\frac{144}{324} \\times 10^{-2} = \\left(\\frac{12}{18}\\right)^2 \\times 10^{-2} = \\left(\\frac{2}{3}\\right)^2 \\times 10^{-2} = \\frac{4}{9} \\times 10^{-2}\n$$\n$$\nRe = 0.004444...\n$$\nThe problem asks for the value rounded to four significant figures. This gives $Re = 0.004444$.\n\nFinally, we must assess whether the creeping-flow approximation is justified. The creeping-flow (or Stokes flow) regime is characterized by the dominance of viscous forces over inertial forces. This is quantitatively expressed by the condition that the Reynolds number is much less than unity ($Re \\ll 1$).\nIn our case, $Re \\approx 0.004444$, which is indeed much smaller than $1$. Therefore, the inertial term $\\rho (\\mathbf{v} \\cdot \\nabla) \\mathbf{v}$ in the Navier-Stokes equation is negligible compared to the viscous term $\\mu \\nabla^2 \\mathbf{v}$. The neglect of inertia is fully justified, and the creeping-flow approximation is valid for these conditions.", "answer": "$$\n\\boxed{0.004444}\n$$", "id": "2945220"}, {"introduction": "How do macroscopic transport properties like viscosity emerge from the chaotic dance of individual molecules? This advanced computational exercise [@problem_id:2945217] tackles this question head-on by guiding you through the Green-Kubo formalism, a profound result of statistical mechanics. You will implement a numerical method to calculate shear viscosity from the time-correlation of microscopic stress fluctuations, learning not just the theory but also the practical challenges of data analysis, such as choosing an appropriate integration cutoff and estimating uncertainty from finite simulation data.", "problem": "You are given the task of computing the shear viscosity of a simple liquid from time-correlation data produced by molecular dynamics, using a principle-based numerical method. The strategy must start from fundamental statistical mechanics and proceed to a robust, unit-consistent computational implementation that includes a physically justified integration cutoff and an uncertainty estimate.\n\nStart from the following fundamental base:\n- The Fluctuation-Dissipation Theorem (FDT) states that linear transport coefficients can be expressed as time integrals of equilibrium time-correlation functions of corresponding microscopic fluxes.\n- In an isotropic liquid, the shear viscosity $\\eta$ is expressed via a Green-Kubo relation as a volume-, temperature-, and correlation-integral of an off-diagonal microscopic stress autocorrelation function. Denote the off-diagonal stress component by $P_{xy}(t)$ (with units of pascal) and its stationary autocorrelation by $C(t)=\\langle P_{xy}(0)P_{xy}(t)\\rangle$ (units of $\\text{Pa}^2$).\n- The constants and units to be used are: Boltzmann constant $k_{\\mathrm{B}}=1.380649\\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$, $1\\,\\text{nm}=10^{-9}\\,\\text{m}$, $1\\,\\text{ps}=10^{-12}\\,\\text{s}$, and $1\\,\\text{mPa}\\cdot\\text{s}=10^{-3}\\,\\text{Pa}\\cdot\\text{s}$.\n\nYour program must:\n- Using only the above base, derive the correct integral expression linking $\\eta$, the system volume $V$, the absolute temperature $T$, and the time integral of $C(t)$.\n- Numerically integrate the correlation function to obtain $\\eta$, taking careful account of units.\n- Choose a physically justified integration cutoff time $t_c$ that avoids integrating deep into the noise-dominated tail. The cutoff must be chosen directly from the data by a two-part criterion: \n  1. A moving-window consistency-with-zero test for the integrand $C(t)$, and \n  2. A plateau test on the cumulative integral. \n  More specifically, in a window of duration $W$ (in time), locate the earliest time $t$ such that the absolute value of the moving-window mean of $C(t)$ is less than $z$ times the standard error of the mean in that window (with $z=1.96$), and simultaneously the relative change of the cumulative integral over the next window of equal size is less than a tolerance $r_{\\mathrm{tol}}=0.02$. If no such time exists, set $t_c$ to the maximum sampled time. The window $W$ should be set to the larger of $1.0\\,\\text{ps}$ and $0.05\\,t_{\\max}$, but it must contain at least $10$ sample points.\n- Estimate the uncertainty of $\\eta$ by computing independent estimates from each provided replicate, using the common cutoff $t_c$ determined from the ensemble-average correlation function, and then reporting the standard error of the mean across replicates.\n\nNumerical integration requirement:\n- Use a Riemann sum with the trapezoidal rule for the cumulative integral $\\int_0^t C(\\tau)\\,d\\tau$ evaluated on the provided discrete grid. Treat the sample spacing exactly as specified by the time grid.\n\nUnits and reporting:\n- All physical input quantities and outputs must be handled with correct units. \n- Express the final viscosity in $\\text{mPa}\\cdot\\text{s}$, rounded to three significant figures. \n- Express the integration cutoff $t_c$ in $\\text{ps}$, rounded to two decimal places. \n- Express the uncertainty (standard error) in $\\text{mPa}\\cdot\\text{s}$, rounded to two significant figures.\n\nTest suite:\nImplement your program to run on the following three test cases. In each case, you must generate deterministic synthetic time-correlation datasets from the specified formulas. Each case provides absolute temperature $T$, a cubic box length $L$ (so $V=L^3$), a time step $\\Delta t$, a maximum time $t_{\\max}$, and the number of replicates $N_{\\mathrm{rep}}$. The target reference viscosity $\\eta_{\\mathrm{ref}}$ is given to set the amplitude of the base correlation function, but you must not use it directly as an answer; it only informs the synthetic data construction to be reproducible and physically plausible.\n\nFor all cases, define the time grid as $t_n = n\\,\\Delta t$ for integers $n$ such that $0 \\le t_n \\le t_{\\max}$, and use seconds when integrating. For each case, construct the base correlation $C_{\\text{base}}(t)$ and then add deterministic replicate-specific perturbations $\\delta C_r(t)$ to obtain replicate series $C_r(t)=C_{\\text{base}}(t)+\\delta C_r(t)$ for $r=1,\\dots,N_{\\mathrm{rep}}$. The amplitude parameters are chosen to yield $\\eta_{\\mathrm{ref}}$ in the noise-free, infinite-time, ensemble-average limit.\n\n- Case A (happy path, single-exponential decay):\n  - $T=298\\,\\text{K}$, $L=3.0\\,\\text{nm}$, $\\Delta t=0.02\\,\\text{ps}$, $t_{\\max}=20.0\\,\\text{ps}$, $N_{\\mathrm{rep}}=4$, and $\\eta_{\\mathrm{ref}}=0.90\\,\\text{mPa}\\cdot\\text{s}$.\n  - Define $\\tau_1=2.0\\,\\text{ps}$ and set \n    $$C_{\\text{base}}(t)=A_1\\,e^{-t/\\tau_1}\\,,$$\n    where $A_1$ is fixed by the requirement that the Green-Kubo integral reproduces $\\eta_{\\mathrm{ref}}$ in the noiseless limit.\n  - For replicates $r=1,2,3,4$, define perturbations\n    $$\\delta C_r(t)=b_r\\,A_1\\,e^{-t/\\tau_b}\\cos\\!\\big(2\\pi f_r t\\big)\\,,$$\n    with $\\tau_b=1.0\\,\\text{ps}$, $\\{b_r\\}=\\{0.05,-0.04,0.03,0.02\\}$, and $\\{f_r\\}=\\{0.50,0.40,0.70,0.90\\}\\,\\text{ps}^{-1}$.\n\n- Case B (boundary, very fast decay):\n  - $T=350\\,\\text{K}$, $L=2.5\\,\\text{nm}$, $\\Delta t=0.005\\,\\text{ps}$, $t_{\\max}=2.0\\,\\text{ps}$, $N_{\\mathrm{rep}}=3$, and $\\eta_{\\mathrm{ref}}=0.50\\,\\text{mPa}\\cdot\\text{s}$.\n  - Define $\\tau_1=0.10\\,\\text{ps}$ and\n    $$C_{\\text{base}}(t)=A_1\\,e^{-t/\\tau_1}\\,,$$\n    with $A_1$ fixed by the noiseless Green-Kubo constraint for $\\eta_{\\mathrm{ref}}$.\n  - Replicate perturbations:\n    $$\\delta C_r(t)=b_r\\,A_1\\,e^{-t/\\tau_b}\\cos\\!\\big(2\\pi f_b t\\big)\\,,$$\n    with $\\tau_b=0.30\\,\\text{ps}$, $f_b=3.0\\,\\text{ps}^{-1}$, and $\\{b_r\\}=\\{0.02,-0.02,0.015\\}$.\n\n- Case C (edge, biexponential with a weak damped oscillatory contribution and a long tail):\n  - $T=320\\,\\text{K}$, $L=4.0\\,\\text{nm}$, $\\Delta t=0.05\\,\\text{ps}$, $t_{\\max}=100.0\\,\\text{ps}$, $N_{\\mathrm{rep}}=3$, and $\\eta_{\\mathrm{ref}}=2.00\\,\\text{mPa}\\cdot\\text{s}$.\n  - Define $\\tau_1=1.5\\,\\text{ps}$, $\\tau_2=15.0\\,\\text{ps}$ and weights $w_1=0.80$, $w_2=0.20$. Set\n    $$C_{\\text{base}}(t)=A_1\\,e^{-t/\\tau_1}+A_2\\,e^{-t/\\tau_2}+A_3\\,e^{-t/\\tau_d}\\cos\\!\\big(2\\pi f_d t\\big)\\,,$$\n    where $A_1=w_1 S/\\tau_1$ and $A_2=w_2 S/\\tau_2$ with $S=\\eta_{\\mathrm{ref}}\\,(k_{\\mathrm{B}}T)/V$. The damped oscillation has $\\tau_d=5.0\\,\\text{ps}$, $f_d=0.15\\,\\text{ps}^{-1}$, and $A_3=0.05\\,A_1$. This $A_3$ is small so that its integral contribution is minor but it introduces mild sign changes in $C(t)$.\n  - Replicate perturbations:\n    $$\\delta C_r(t)=b_r\\,A_1\\,e^{-t/\\tau_b}\\cos\\!\\big(2\\pi f_r t\\big)\\,,$$\n    with $\\tau_b=2.0\\,\\text{ps}$, $\\{b_r\\}=\\{0.04,-0.03,0.02\\}$, and $\\{f_r\\}=\\{0.20,0.35,0.50\\}\\,\\text{ps}^{-1}$.\n\nImplementation details:\n- Compute $A_1$ (and $A_2$) from the constraint implied by the FDT-based integral, ensuring that the noiseless infinite-time integral equals $\\eta_{\\mathrm{ref}}$ when multiplied by $V/(k_{\\mathrm{B}}T)$. For a single exponential $A_1\\,e^{-t/\\tau_1}$ this implies $A_1 \\tau_1 = \\eta_{\\mathrm{ref}} (k_{\\mathrm{B}}T)/V$. For the biexponential, enforce $A_1\\tau_1 + A_2\\tau_2 \\approx S$ as specified by $w_1$ and $w_2$.\n- For each case, from the $N_{\\mathrm{rep}}$ replicates, compute the ensemble-average $\\overline{C}(t)$, determine a common cutoff $t_c$ from $\\overline{C}(t)$ using the stated two-part criterion, then compute per-replicate viscosities $\\eta_r$ by integrating up to $t_c$ and multiplying by $V/(k_{\\mathrm{B}}T)$, and finally compute the mean and the standard error across replicates.\n- All time integrals must be performed in seconds; report $\\eta$ in $\\text{mPa}\\cdot\\text{s}$ and $t_c$ in $\\text{ps}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a three-element list $[\\eta_{\\text{mPa}\\cdot\\text{s}},t_{c,\\text{ps}},u_{\\text{mPa}\\cdot\\text{s}}]$.\n- For example, the printed line must look like:\n  - \"[[x11,x12,x13],[x21,x22,x23],[x31,x32,x33]]\"\n- Apply the rounding rules specified above before printing.", "solution": "The problem of computing the shear viscosity, $\\eta$, from molecular dynamics data is a standard procedure in computational statistical mechanics. It requires a rigorous application of the Green-Kubo relations, careful numerical integration, and a physically justified method for handling finite-time data.\n\nThe problem as stated is valid. It is scientifically grounded in the fluctuation-dissipation theorem, is well-posed with all necessary parameters and a clear algorithmic objective, and is free of ambiguity or factual error. The synthetic data generation provides a deterministic and reproducible test bed for the numerical method.\n\nThe solution proceeds in three stages:\n1.  Derivation of the working formula for viscosity from the provided principles.\n2.  Design of the numerical algorithm, including the integration scheme and the two-part cutoff criterion.\n3.  Implementation of the algorithm to process the specified test cases, with careful attention to physical units.\n\n### 1. The Green-Kubo Relation for Shear Viscosity\n\nThe problem states that linear transport coefficients are related to time integrals of equilibrium time-correlation functions. For the shear viscosity $\\eta$, this is expressed through the Green-Kubo formula. The relevant microscopic flux is an off-diagonal component of the stress tensor, which we denote as $P_{xy}(t)$ (in units of pascals, $\\text{Pa}$). Its equilibrium autocorrelation function is given as $C(t) = \\langle P_{xy}(0)P_{xy}(t) \\rangle$ (in units of $\\text{Pa}^2$).\n\nFor an isotropic fluid of volume $V$ at absolute temperature $T$, the Green-Kubo relation for shear viscosity is:\n$$ \\eta = \\frac{V}{k_{\\mathrm{B}} T} \\int_0^\\infty \\langle P_{xy}(0)P_{xy}(t) \\rangle \\, dt $$\nSubstituting the given definition of $C(t)$, we arrive at the working formula:\n$$ \\eta = \\frac{V}{k_{\\mathrm{B}} T} \\int_0^\\infty C(t) \\, dt $$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant.\n\nA dimensional analysis confirms the correctness of this expression. The units must resolve to those of viscosity, $\\text{Pa} \\cdot \\text{s}$, which is equivalent to $\\text{kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-1}$ in SI base units.\n-   Volume $V$: $[\\text{m}^3]$.\n-   Thermal energy $k_{\\mathrm{B}}T$: $[\\text{J}] = [\\text{kg} \\cdot \\text{m}^2 \\cdot \\text{s}^{-2}]$.\n-   Autocorrelation function $C(t)$: $[\\text{Pa}^2] = ([\\text{N} \\cdot \\text{m}^{-2}])^2 = ([\\text{kg} \\cdot \\text{m} \\cdot \\text{s}^{-2} \\cdot \\text{m}^{-2}])^2 = [\\text{kg}^2 \\cdot \\text{m}^{-2} \\cdot \\text{s}^{-4}]$.\n-   Time integral $\\int C(t) dt$: $[\\text{kg}^2 \\cdot \\text{m}^{-2} \\cdot \\text{s}^{-3}]$.\n\nCombining these, the units of the right-hand side are:\n$$ [\\eta] = \\frac{[\\text{m}^3]}{[\\text{kg} \\cdot \\text{m}^2 \\cdot \\text{s}^{-2}]} \\cdot [\\text{kg}^2 \\cdot \\text{m}^{-2} \\cdot \\text{s}^{-3}] = [\\text{kg}^{-1} \\cdot \\text{m} \\cdot \\text{s}^2] \\cdot [\\text{kg}^2 \\cdot \\text{m}^{-2} \\cdot \\text{s}^{-3}] = [\\text{kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-1}] $$\nThis matches the units of viscosity, confirming the formula's dimensional consistency. All calculations must be performed in base SI units.\n\n### 2. Numerical Integration and Cutoff Determination\n\nIn practice, the integral is evaluated numerically over a finite time interval, from $t=0$ to a cutoff time $t_c$.\n$$ \\eta \\approx \\frac{V}{k_{\\mathrm{B}} T} \\int_0^{t_c} C(t) \\, dt $$\nThe integral must be approximated from discrete data $C(t_n)$ on a time grid $t_n=n\\Delta t$. The trapezoidal rule is specified for this task. The cumulative integral $I(t_n) = \\int_0^{t_n} C(\\tau)d\\tau$ is approximated as:\n$$ I(t_n) \\approx \\sum_{i=0}^{n-1} \\frac{C(t_i) + C(t_{i+1})}{2} \\Delta t $$\n\nThe choice of $t_c$ is critical. Integrating for too short a time truncates the correlation function, underestimating $\\eta$. Integrating for too long includes the noisy, uncorrelated tail of $C(t)$, which adds variance without improving the estimate of the true integral. A physically motivated, data-driven criterion is required. The problem specifies a two-part criterion to find the earliest time $t$ that can be considered the start of the noisy tail.\n\nLet $W$ be a time window of duration $W = \\max(1.0\\,\\text{ps}, 0.05\\,t_{\\max})$, containing at least $N_W \\geq 10$ data points. We search for the earliest time $t_i = i\\Delta t$ that satisfies two conditions simultaneously:\n1.  **Consistency-with-Zero Test:** The correlation function $C(t)$ should be statistically indistinguishable from zero noise in the window $[t_i, t_i+W]$. This is tested by requiring the absolute value of the mean of $\\overline{C}(t)$ in the window to be smaller than $z=1.96$ times its standard error of the mean (SEM):\n    $$ |\\text{mean}(\\overline{C}(t))|_{t \\in [t_i, t_i+W]}|  z \\cdot \\text{SEM}(\\overline{C}(t))_{t \\in [t_i, t_i+W]} $$\n2.  **Plateau Test:** The contribution of the subsequent `noisy` part of the signal to the cumulative integral must be negligible. This is tested on the *next* window of equal size, $[t_i+W, t_i+2W]$. The relative change in the cumulative integral due to this window must be below a tolerance $r_{\\mathrm{tol}} = 0.02$. Let $I(t) = \\int_0^t \\overline{C}(\\tau)d\\tau$. The condition is:\n    $$ \\frac{|I(t_i+2W) - I(t_i+W)|}{|I(t_i+2W)|}  r_{\\mathrm{tol}} $$\nThe first time $t_i$ satisfying both conditions is chosen as the cutoff time, $t_c=t_i$. If no such time is found, $t_c$ is set to the maximum available time, $t_{\\max}$. This procedure requires data up to $t_i+2W$, so the search for $t_i$ is limited to the range $[0, t_{\\max}-2W]$.\n\n### 3. Uncertainty Quantification and Final Calculation\n\nThe analysis is performed on $N_{\\mathrm{rep}}$ replicate simulations.\n1.  The ensemble-average correlation function, $\\overline{C}(t) = \\frac{1}{N_{\\mathrm{rep}}}\\sum_{r=1}^{N_{\\mathrm{rep}}} C_r(t)$, is computed first.\n2.  The common cutoff time $t_c$ is determined from $\\overline{C}(t)$ using the two-part criterion described above.\n3.  Using this common $t_c$, an independent viscosity estimate $\\eta_r$ is calculated for each replicate $r$:\n    $$ \\eta_r = \\frac{V}{k_{\\mathrm{B}} T} \\int_0^{t_c} C_r(t) \\, dt $$\n4.  The final viscosity estimate is the mean of the replicate viscosities, $\\eta = \\text{mean}(\\{\\eta_r\\})$.\n5.  The statistical uncertainty is estimated by the standard error of the mean of the replicate viscosities: $u = \\text{std}(\\{\\eta_r\\}) / \\sqrt{N_{\\mathrm{rep}}}$.\n\nThe final results—$\\eta$, $t_c$, and $u$—are converted to the specified units ($\\text{mPa}\\cdot\\text{s}$ for viscosity, $\\text{ps}$ for time) and rounded to the required number of significant figures or decimal places.", "answer": "```python\nimport numpy as np\nfrom math import log10, floor, sqrt\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the entire calculation for all test cases.\n    \"\"\"\n\n    def round_sig(x, n):\n        \"\"\"Rounds a number x to n significant figures.\"\"\"\n        if x == 0 or np.isinf(x) or np.isnan(x):\n            return x\n        return round(x, n - int(floor(log10(abs(x)))) - 1)\n\n    # --- Data Generation Functions ---\n\n    def C_base_A(t, T, V, eta_ref, k_B, params):\n        tau1_ps = 2.0\n        tau1 = tau1_ps * 1e-12\n        S = eta_ref * k_B * T / V\n        A1 = S / tau1\n        return A1 * np.exp(-t / tau1), {'A1': A1}\n\n    def delta_C_A(t, amps, r, params):\n        tau_b_ps = 1.0\n        tau_b = tau_b_ps * 1e-12\n        b_r_vals = [0.05, -0.04, 0.03, 0.02]\n        f_r_vals_ps = [0.50, 0.40, 0.70, 0.90]\n        f_r = f_r_vals_ps[r] * 1e12\n        b_r = b_r_vals[r]\n        A1 = amps['A1']\n        return b_r * A1 * np.exp(-t / tau_b) * np.cos(2 * np.pi * f_r * t)\n\n    def C_base_B(t, T, V, eta_ref, k_B, params):\n        tau1_ps = 0.10\n        tau1 = tau1_ps * 1e-12\n        S = eta_ref * k_B * T / V\n        A1 = S / tau1\n        return A1 * np.exp(-t / tau1), {'A1': A1}\n\n    def delta_C_B(t, amps, r, params):\n        tau_b_ps = 0.30\n        tau_b = tau_b_ps * 1e-12\n        f_b_ps = 3.0\n        f_b = f_b_ps * 1e12\n        b_r_vals = [0.02, -0.02, 0.015]\n        b_r = b_r_vals[r]\n        A1 = amps['A1']\n        return b_r * A1 * np.exp(-t / tau_b) * np.cos(2 * np.pi * f_b * t)\n\n    def C_base_C(t, T, V, eta_ref, k_B, params):\n        tau1_ps, tau2_ps = 1.5, 15.0\n        w1, w2 = 0.80, 0.20\n        tau_d_ps, f_d_ps = 5.0, 0.15\n        \n        tau1, tau2 = tau1_ps * 1e-12, tau2_ps * 1e-12\n        tau_d, f_d = tau_d_ps * 1e-12, f_d_ps * 1e12\n\n        S = eta_ref * k_B * T / V\n        A1 = w1 * S / tau1\n        A2 = w2 * S / tau2\n        A3 = 0.05 * A1\n        \n        term1 = A1 * np.exp(-t / tau1)\n        term2 = A2 * np.exp(-t / tau2)\n        term3 = A3 * np.exp(-t / tau_d) * np.cos(2 * np.pi * f_d * t)\n        \n        return term1 + term2 + term3, {'A1': A1}\n\n    def delta_C_C(t, amps, r, params):\n        tau_b_ps = 2.0\n        tau_b = tau_b_ps * 1e-12\n        b_r_vals = [0.04, -0.03, 0.02]\n        f_r_vals_ps = [0.20, 0.35, 0.50]\n        b_r = b_r_vals[r]\n        f_r = f_r_vals_ps[r] * 1e12\n        A1 = amps['A1']\n        return b_r * A1 * np.exp(-t / tau_b) * np.cos(2 * np.pi * f_r * t)\n    \n    # --- Main Processing Function for a Single Case ---\n\n    def process_case(params):\n        T = params['T']\n        L_nm, dt_ps, tmax_ps = params['L'], params['dt'], params['t_max']\n        N_rep, eta_ref_mPa_s = params['N_rep'], params['eta_ref']\n\n        k_B = 1.380649e-23\n        L, V = L_nm * 1e-9, (L_nm * 1e-9)**3\n        dt, t_max = dt_ps * 1e-12, tmax_ps * 1e-12\n        eta_ref = eta_ref_mPa_s * 1e-3\n        \n        t_grid = np.arange(0, t_max + dt / 2, dt)\n        \n        C_replicates = []\n        C_base, amps = params['C_base_func'](t_grid, T, V, eta_ref, k_B, params)\n        for r in range(N_rep):\n            delta_C = params['delta_C_func'](t_grid, amps, r, params)\n            C_replicates.append(C_base + delta_C)\n\n        C_bar = np.mean(np.array(C_replicates), axis=0)\n        \n        integral_C_bar = np.concatenate(([0], np.cumsum(0.5 * (C_bar[:-1] + C_bar[1:])) * dt))\n\n        z, r_tol = 1.96, 0.02\n        W_ps = max(1.0, 0.05 * tmax_ps)\n        W_duration_sec = W_ps * 1e-12\n        N_W = max(10, int(np.ceil(W_duration_sec / dt)))\n\n\n        tc_idx = len(t_grid) - 1\n        \n        # Search for cutoff time tc\n        # Loop range ensures that i + 2*N_W is a valid index.\n        for i in range(len(t_grid) - 2 * N_W):\n\n            # Cond 1: Zero-mean test over window [i, i+N_W-1]\n            win1 = C_bar[i : i + N_W]\n            mean_C = np.mean(win1)\n            std_C = np.std(win1, ddof=1)\n            sem_C = std_C / sqrt(N_W) if N_W > 0 else 0\n            cond1 = abs(mean_C)  z * sem_C if sem_C > 0 else (mean_C == 0)\n\n            # Cond 2: Plateau test over next window [i+N_W, i+2*N_W-1]\n            change_in_next_window = integral_C_bar[i + 2 * N_W] - integral_C_bar[i + N_W]\n            val_at_end = integral_C_bar[i + 2 * N_W]\n            cond2 = abs(change_in_next_window / val_at_end)  r_tol if val_at_end != 0 else False\n            \n            if cond1 and cond2:\n                tc_idx = i\n                break\n        \n        tc = t_grid[tc_idx]\n\n        eta_replicates = []\n        prefactor = V / (k_B * T)\n        for C_r in C_replicates:\n            integral_r = np.trapz(C_r[:tc_idx + 1], t_grid[:tc_idx + 1])\n            eta_replicates.append(prefactor * integral_r)\n\n        eta_mean = np.mean(eta_replicates)\n        eta_sem = np.std(eta_replicates, ddof=1) / sqrt(N_rep) if N_rep > 1 else 0.0\n\n        eta_final = round_sig(eta_mean * 1000, 3)\n        u_final = round_sig(eta_sem * 1000, 2)\n        tc_final = round(tc * 1e12, 2)\n        \n        return [eta_final, tc_final, u_final]\n\n    # --- Test Case Definitions ---\n    \n    test_cases = [\n        {\n            'T': 298.0, 'L': 3.0, 'dt': 0.02, 't_max': 20.0, 'N_rep': 4, 'eta_ref': 0.90,\n            'C_base_func': C_base_A, 'delta_C_func': delta_C_A\n        },\n        {\n            'T': 350.0, 'L': 2.5, 'dt': 0.005, 't_max': 2.0, 'N_rep': 3, 'eta_ref': 0.50,\n            'C_base_func': C_base_B, 'delta_C_func': delta_C_B\n        },\n        {\n            'T': 320.0, 'L': 4.0, 'dt': 0.05, 't_max': 100.0, 'N_rep': 3, 'eta_ref': 2.00,\n            'C_base_func': C_base_C, 'delta_C_func': delta_C_C\n        },\n    ]\n\n    results = [process_case(case) for case in test_cases]\n    \n    formatted_results = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2945217"}]}