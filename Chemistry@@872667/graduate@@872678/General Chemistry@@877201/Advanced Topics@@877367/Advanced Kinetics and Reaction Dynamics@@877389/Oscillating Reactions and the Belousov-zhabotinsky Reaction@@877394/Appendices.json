{"hands_on_practices": [{"introduction": "The intricate dance of the Belousov-Zhabotinsky reaction is a constant tug-of-war between autocatalytic production and inhibition. This exercise brings this conflict into sharp focus by asking you to determine the critical threshold concentration of the inhibitor, bromide ($[\\mathrm{Br}^-]$), that is just sufficient to suppress the autocatalytic runaway process [@problem_id:2949141]. By applying a simple stability analysis to a core part of the Oregonator model, you will derive a fundamental relationship that governs the \"on/off\" switch of the reaction's engine.", "problem": "In the minimal Field–Noyes Oregonator description of the Belousov–Zhabotinsky reaction (BZ reaction), consider the dynamics of the autocatalytic intermediate hypobromous acid ($\\mathrm{HBrO_2}$), denoted by $X \\equiv [\\mathrm{HBrO_2}]$, in the presence of the inhibitor bromide, $Y \\equiv [\\mathrm{Br}^{-}]$. Assume constant acidity and that bromate $A \\equiv [\\mathrm{BrO_3^{-}}]$ is held effectively constant by large excess. Use the law of mass action as the fundamental base to model the three dominant contributions to the rate of change of $X$ as follows:\n\n- Autocatalytic production: $\\mathrm{HBrO_2} + \\mathrm{BrO_3^{-}} + \\mathrm{H^{+}} \\to 2\\,\\mathrm{HBrO_2}$ with rate $k_{a}\\,A\\,X$.\n- Inhibitory removal: $\\mathrm{HBrO_2} + \\mathrm{Br^{-}} + \\mathrm{H^{+}} \\to \\text{products}$ with rate $k_{i}\\,X\\,Y$.\n- Termination: $2\\,\\mathrm{HBrO_2} \\to \\text{products}$ with rate $2\\,k_{t}\\,X^{2}$.\n\nHere $k_{a}$, $k_{i}$, and $k_{t}$ are positive rate constants, and $A$, $X$, and $Y$ are concentrations. Under these assumptions, the net rate of change of $X$ is\n$$\n\\frac{dX}{dt} \\;=\\; k_{a}\\,A\\,X \\;-\\; k_{i}\\,X\\,Y \\;-\\; 2\\,k_{t}\\,X^{2}.\n$$\nDefine the “bromide threshold” $[\\mathrm{Br}^{-}]_{\\text{crit}}$ as the smallest inhibitor concentration at which infinitesimal perturbations in $X$ do not grow by autocatalysis (that is, autocatalysis is just suppressed). Using only the model above and the law of mass action, determine an explicit closed-form expression for $[\\mathrm{Br}^{-}]_{\\text{crit}}$ by imposing the appropriate condition on $\\frac{dX}{dt}$ in the limit $X \\to 0^{+}$ and solving for $Y$.\n\nExpress your final result as an analytic expression in terms of $k_{a}$, $k_{i}$, and $A$. Report $[\\mathrm{Br}^{-}]_{\\text{crit}}$ in molarity. No numerical approximation or rounding is required.", "solution": "The problem statement is evaluated and deemed valid. It is a scientifically grounded, well-posed, and objective problem in the field of chemical kinetics, specifically concerning the stability analysis of a simplified model for the Belousov-Zhabotinsky reaction.\n\nThe rate of change for the concentration of the autocatalytic intermediate, $X \\equiv [\\mathrm{HBrO_2}]$, is given by the differential equation:\n$$\n\\frac{dX}{dt} = k_{a} A X - k_{i} X Y - 2 k_{t} X^{2}\n$$\nHere, $Y \\equiv [\\mathrm{Br}^{-}]$ is the concentration of the inhibitor, and $A \\equiv [\\mathrm{BrO_3^{-}}]$ is the concentration of a reactant held in large excess, effectively a constant parameter. The terms correspond to autocatalytic production ($k_{a} A X$), inhibitory removal ($k_{i} X Y$), and self-termination ($-2 k_{t} X^{2}$). All rate constants $k_{a}$, $k_{i}$, and $k_{t}$ are positive.\n\nThe objective is to determine the \"bromide threshold\", denoted as $[\\mathrm{Br}^{-}]_{\\text{crit}}$. This is defined as the smallest inhibitor concentration, $Y$, at which infinitesimal perturbations in $X$ do not grow. This is a question of the stability of the system at very low concentrations of $X$, specifically the stability of the trivial steady state $X = 0$.\n\nAn infinitesimal perturbation in $X$ implies we are analyzing the system in the vicinity of $X=0$, i.e., in the limit $X \\to 0^{+}$. The condition that such a perturbation \"does not grow\" means that if we start with a very small positive concentration of $X$, its concentration will not increase. Mathematically, this translates to the condition that the net rate of change, $\\frac{dX}{dt}$, must be less than or equal to zero for $X \\to 0^{+}$.\n$$\n\\frac{dX}{dt} \\le 0 \\quad \\text{for } X \\to 0^{+}\n$$\nTo analyze the behavior of $\\frac{dX}{dt}$ for small $X$, we can factor out $X$ from the rate equation:\n$$\n\\frac{dX}{dt} = X (k_{a} A - k_{i} Y - 2 k_{t} X)\n$$\nSince we are considering a small but positive concentration $X$ (i.e., $X  0$), the sign of $\\frac{dX}{dt}$ is determined by the sign of the term in the parentheses:\n$$\n(k_{a} A - k_{i} Y - 2 k_{t} X)\n$$\nFor the non-growth condition $\\frac{dX}{dt} \\le 0$ to hold for $X  0$, we must have:\n$$\nk_{a} A - k_{i} Y - 2 k_{t} X \\le 0\n$$\nThe problem specifies the analysis should be for *infinitesimal* perturbations, which corresponds to the limit as $X$ approaches zero from the positive side ($X \\to 0^{+}$). In this limit, the term $2 k_{t} X$ vanishes. The inequality governing the stability at the origin thus becomes:\n$$\nk_{a} A - k_{i} Y \\le 0\n$$\nThis inequality defines the condition on the inhibitor concentration $Y$ that ensures the suppression of autocatalysis for vanishingly small amounts of $X$. Rearranging for $Y$, we find:\n$$\nk_{i} Y \\ge k_{a} A\n$$\nSince $k_{i}$ is a positive rate constant, we can divide by it without changing the direction of the inequality:\n$$\nY \\ge \\frac{k_{a} A}{k_{i}}\n$$\nThis result indicates that for any bromide concentration $Y$ greater than or equal to the value $\\frac{k_{a} A}{k_{i}}$, the autocatalytic process is suppressed near $X=0$. The problem asks for the \"bromide threshold\", $[\\mathrm{Br}^{-}]_{\\text{crit}}$, which is the *smallest* inhibitor concentration at which this suppression occurs. This corresponds to the boundary case of the inequality, where the system is at the critical point between growth and decay. We find this threshold value by setting the inequality to an equality:\n$$\nY_{\\text{crit}} = \\frac{k_{a} A}{k_{i}}\n$$\nRecalling the definition $Y \\equiv [\\mathrm{Br}^{-}]$, the final expression for the bromide threshold is:\n$$\n[\\mathrm{Br}^{-}]_{\\text{crit}} = \\frac{k_{a} A}{k_{i}}\n$$\nThis expression represents the critical concentration of bromide where the rate of autocatalytic production of $\\mathrm{HBrO_2}$ is exactly balanced by its rate of removal by bromide, in the limit of zero $\\mathrm{HBrO_2}$ concentration. Below this threshold, autocatalysis dominates, and small perturbations of $X$ will grow. Above this threshold, inhibition dominates, and small perturbations will decay.", "answer": "$$\n\\boxed{\\frac{k_{a} A}{k_{i}}}\n$$", "id": "2949141"}, {"introduction": "Realistic chemical mechanisms, like the Field-Kőrös-Noyes (FKN) model for the BZ reaction, can involve dozens of elementary steps and highly reactive intermediates. To make these systems tractable, chemists often rely on approximations. This practice provides a hands-on justification for one of the most powerful tools in a kineticist's arsenal, the Quasi-Steady-State Approximation (QSSA), by having you calculate the lifetime of a radical intermediate and compare it to the macroscopic oscillation period [@problem_id:2949235]. This quantifies the separation of timescales that makes such model simplifications valid.", "problem": "In the cerium-catalyzed Belousov-Zhabotinsky (BZ) reaction, the Field-Körös-Noyes (FKN) mechanism contains fast radical intermediates that are commonly eliminated by the Quasi-Steady-State Approximation (QSSA). Consider the bromine dioxide radical $\\mathrm{BrO_2\\cdot}$ as the representative radical intermediate. Two experimentally well-supported radical sinks dominate under acidic aqueous conditions:\n- $\\mathrm{BrO_2\\cdot} + \\mathrm{Br^{-}} \\rightarrow \\text{products}$ with second-order rate constant $k_{\\mathrm{Br}} = 1.0 \\times 10^{9}\\ \\mathrm{M^{-1}\\ s^{-1}}$,\n- $\\mathrm{BrO_2\\cdot} + \\mathrm{Ce^{3+}} \\rightarrow \\text{products}$ with second-order rate constant $k_{\\mathrm{Ce}} = 5.0 \\times 10^{7}\\ \\mathrm{M^{-1}\\ s^{-1}}$.\n\nDuring the radical relaxation that follows a small perturbation in $\\left[\\mathrm{BrO_2\\cdot}\\right]$, the concentrations of the scavengers are effectively constant on the radical timescale. Take the minimum bromide concentration in one oscillation to be $\\left[\\mathrm{Br^{-}}\\right]_{\\min} = 1.0 \\times 10^{-4}\\ \\mathrm{M}$ and the cerium(III) concentration to be $\\left[\\mathrm{Ce^{3+}}\\right] = 1.0 \\times 10^{-3}\\ \\mathrm{M}$. The oscillation period of the macroscopic BZ reaction under these conditions is $T_{\\mathrm{osc}} = 60\\ \\mathrm{s}$.\n\nStarting only from the law of mass action and first-order decay kinetics, derive an expression for the effective lifetime $\\tau_{\\mathrm{rad}}$ of $\\mathrm{BrO_2\\cdot}$ under pseudo-first-order conditions with respect to $\\mathrm{Br^{-}}$ and $\\mathrm{Ce^{3+}}$. Then compute the dimensionless ratio $\\varepsilon = \\tau_{\\mathrm{rad}}/T_{\\mathrm{osc}}$. Express your final answer for $\\varepsilon$ as a pure number rounded to three significant figures.", "solution": "The appropriate starting point is the law of mass action applied to the elementary radical consumption steps. Let $\\left[R\\right] \\equiv \\left[\\mathrm{BrO_2\\cdot}\\right]$, $\\left[B\\right] \\equiv \\left[\\mathrm{Br^{-}}\\right]$, and $\\left[C\\right] \\equiv \\left[\\mathrm{Ce^{3+}}\\right]$. The two dominant consumption reactions are:\n- $R + B \\xrightarrow{k_{\\mathrm{Br}}} \\text{products}$,\n- $R + C \\xrightarrow{k_{\\mathrm{Ce}}} \\text{products}$.\n\nUnder conditions where $\\left[B\\right]$ and $\\left[C\\right]$ are approximately constant during the decay of a small perturbation in $\\left[R\\right]$, the rate of change of $\\left[R\\right]$ is\n$$\n\\frac{d\\left[R\\right]}{dt} = -k_{\\mathrm{Br}} \\left[B\\right]\\left[R\\right] - k_{\\mathrm{Ce}} \\left[C\\right]\\left[R\\right].\n$$\nThis can be written as a first-order decay with an effective pseudo-first-order rate constant $k_{\\mathrm{eff}}$:\n$$\n\\frac{d\\left[R\\right]}{dt} = -k_{\\mathrm{eff}} \\left[R\\right], \\quad \\text{where} \\quad k_{\\mathrm{eff}} = k_{\\mathrm{Br}}\\left[B\\right] + k_{\\mathrm{Ce}}\\left[C\\right].\n$$\nThe solution of this linear differential equation is an exponential decay,\n$$\n\\left[R\\right](t) = \\left[R\\right](0)\\,\\exp\\!\\left(-k_{\\mathrm{eff}} t\\right),\n$$\nso the characteristic lifetime $\\tau_{\\mathrm{rad}}$ of the radical is the reciprocal of $k_{\\mathrm{eff}}$:\n$$\n\\tau_{\\mathrm{rad}} = \\frac{1}{k_{\\mathrm{eff}}} = \\frac{1}{k_{\\mathrm{Br}}\\left[B\\right] + k_{\\mathrm{Ce}}\\left[C\\right]}.\n$$\nInsert the given values:\n- $k_{\\mathrm{Br}} = 1.0 \\times 10^{9}\\ \\mathrm{M^{-1}\\ s^{-1}}$,\n- $\\left[B\\right] = \\left[\\mathrm{Br^{-}}\\right]_{\\min} = 1.0 \\times 10^{-4}\\ \\mathrm{M}$,\n- $k_{\\mathrm{Ce}} = 5.0 \\times 10^{7}\\ \\mathrm{M^{-1}\\ s^{-1}}$,\n- $\\left[C\\right] = \\left[\\mathrm{Ce^{3+}}\\right] = 1.0 \\times 10^{-3}\\ \\mathrm{M}$.\n\nCompute $k_{\\mathrm{eff}}$:\n$$\nk_{\\mathrm{eff}} = \\left(1.0 \\times 10^{9}\\right)\\left(1.0 \\times 10^{-4}\\right) + \\left(5.0 \\times 10^{7}\\right)\\left(1.0 \\times 10^{-3}\\right) \\ \\mathrm{s^{-1}} = \\left(1.0 \\times 10^{5} + 5.0 \\times 10^{4}\\right)\\ \\mathrm{s^{-1}} = 1.5 \\times 10^{5}\\ \\mathrm{s^{-1}}.\n$$\nThus,\n$$\n\\tau_{\\mathrm{rad}} = \\frac{1}{1.5 \\times 10^{5}\\ \\mathrm{s^{-1}}} = 6.666\\ldots \\times 10^{-6}\\ \\mathrm{s}.\n$$\nForm the dimensionless ratio with the oscillation period $T_{\\mathrm{osc}} = 60\\ \\mathrm{s}$:\n$$\n\\varepsilon = \\frac{\\tau_{\\mathrm{rad}}}{T_{\\mathrm{osc}}} = \\frac{6.666\\ldots \\times 10^{-6}\\ \\mathrm{s}}{60\\ \\mathrm{s}} = 1.111\\ldots \\times 10^{-7}.\n$$\nRounded to three significant figures, the result is\n$$\n\\varepsilon = 1.11 \\times 10^{-7}.\n$$\nThis extremely small ratio quantitatively supports the validity of the Quasi-Steady-State Approximation (QSSA) for eliminating $\\mathrm{BrO_2\\cdot}$ on the timescale of BZ oscillations, because the radical relaxes many orders of magnitude faster than the macroscopic oscillation period.", "answer": "$$\\boxed{1.11 \\times 10^{-7}}$$", "id": "2949235"}, {"introduction": "Moving beyond the well-stirred beaker, the true beauty of the BZ reaction unfolds in space, creating complex waves and patterns. This advanced computational exercise challenges you to build a reaction-diffusion model from the ground up to simulate a photosensitive BZ system. You will not only observe the emergence of chemical waves but also learn to control them—'writing' pathways with dark channels and 'erasing' activity with light [@problem_id:2949245]. This capstone practice connects fundamental kinetics and transport phenomena to the exciting frontier of chemical computing and pattern formation.", "problem": "Design and implement a complete, runnable program that formalizes a protocol to write and erase spatial chemical patterns in a photosensitive Belousov-Zhabotinsky (BZ) reaction using spatially structured illumination, and predicts the resulting wave fronts using a reaction-diffusion model. Your implementation must start from fundamental laws of mass conservation and reaction-diffusion transport and construct a two-variable minimal model for the photosensitive BZ medium. The program must simulate the dynamics on a two-dimensional square domain with periodic boundaries and compute specified quantitative metrics for a small suite of illumination protocols that test writing and erasing.\n\nThe physical system is an excitable medium with an activator and an inhibitor subject to reaction kinetics (from the Field-Körös-Noyes mechanism reduced to a two-variable minimal form) and diffusion. The illumination provides a local source of bromide that photoinhibits excitation. Use nondimensional variables and parameters so that no physical unit conversion is required; report all results as pure numbers. Assume the two-dimensional domain is square with side length represented by an integer grid.\n\nYour program must do the following.\n\n- Represent the chemical state by two scalar fields, the activator $u(x,y,t)$ and the inhibitor/catalyst $v(x,y,t)$, evolving under reaction terms derived from mass-action kinetics consistent with the Oregonator reduction for the photosensitive BZ reaction, and diffusion terms $\\nabla^2 u$ and $\\nabla^2 v$ with constant diffusion coefficients. Illumination is represented by a nonnegative scalar field $\\phi(x,y,t)$ that increases the effective local bromide source and thereby suppresses excitation.\n- Use a square grid of size $N \\times N$ with $N = 64$, spatial step $\\Delta x = 1$, and periodic boundary conditions. Use an explicit time-stepping scheme with time step $\\Delta t = 0.02$.\n- Use the following nondimensional kinetic and transport parameters that place the medium in an excitable regime under low illumination and a nonexcitable regime under high illumination: $\\varepsilon = 0.20$, $f = 1.40$, $q = 0.002$, $D_u = 0.20$, and $D_v = 0.10$.\n- Initialize the fields to a spatially uniform steady state consistent with the kinetics in the presence of illumination $\\phi$, then superimpose a localized “seed” excitation by setting $u$ within a small disk to a high value to trigger wave emission. You may approximate the uniform steady state by setting $u = q$ and $v = q$ before applying the seed.\n- Implement the following three illumination protocols (these are the test suite). In each case, the seed is a disk of radius $r\\_0 = 3$ centered at the domain center $(x\\_0,y\\_0) = (N/2,N/2)$ with initial activator value $u = 0.90$ inside the disk and unchanged elsewhere. Use the same $\\Delta t$ and $\\Delta x$ for every case. Total simulation steps and illumination patterns are case-specific as detailed below.\n\nTest Suite:\n\n- Case A (Write a confined stripe-guided wave and estimate axial front speed):\n  - Illumination pattern: a vertical “dark” stripe of width $w = 6$ grid points centered at $x = N/2$ where $\\phi = \\phi\\_{\\mathrm{dark}} = 0.005$, embedded in a “bright” background where $\\phi = \\phi\\_{\\mathrm{bright}} = 0.070$.\n  - Total simulation steps: $T\\_{\\mathrm{A}} = 400$.\n  - Metric: Estimate the axial front speed along the stripe’s centerline column $x = N/2$ as follows. Let $\\theta\\_u = 0.30$ be the front threshold. For each time $t\\_k = k \\,\\Delta t$ with $k \\in \\{k\\_1,\\dots,k\\_2\\}$ where $t\\_{1} = 2.00$ and $t\\_{2} = 8.00$ (thus $k\\_1 = 100$ and $k\\_2 = 400$), compute the maximal axial distance from the centerline row $y\\_0 = N/2$ to any row $y$ on the center column with $u(N/2,y,t\\_k)  \\theta\\_u$. Perform a least-squares linear fit of this maximal distance versus time over the specified interval and report the fitted slope as the speed (a float).\n- Case B (Erase by global brightening and report quenching success):\n  - Illumination pattern: uniform “dark” illumination $\\phi = \\phi\\_{\\mathrm{dark}} = 0.005$ for times $t  t\\_{\\mathrm{switch}}$ and uniform “bright” illumination $\\phi = \\phi\\_{\\mathrm{erase}} = 0.080$ for times $t \\ge t\\_{\\mathrm{switch}}$, where $t\\_{\\mathrm{switch}} = 4.00$.\n  - Total simulation steps: $T\\_{\\mathrm{B}} = 600$.\n  - Metric: At the final time, compute the spatial mean $\\overline{u}$ of the activator field and report a boolean indicating whether $\\overline{u}  \\theta\\_{\\mathrm{erase}}$, where $\\theta\\_{\\mathrm{erase}} = 0.10$.\n- Case C (Boundary case: uniformly bright, no propagation):\n  - Illumination pattern: uniform “bright” illumination $\\phi = \\phi\\_{\\mathrm{bright}} = 0.080$ at all times.\n  - Total simulation steps: $T\\_{\\mathrm{C}} = 200$.\n  - Metric: Count the number of grid points with $u  \\theta\\_u$ at the final time and report this count as an integer.\n\nComputational requirements and checks:\n\n- Use a five-point stencil for the Laplacian and periodic boundaries. Ensure that the explicit time step satisfies the standard diffusion stability criterion $\\Delta t  \\Delta x^2/(4 \\max\\{D_u,D_v\\})$; the given values satisfy this bound.\n- All variables and parameters are nondimensional; therefore no physical unit conversion or unit reporting is required.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order [Case A speed as a float, Case B boolean, Case C integer]. For example, a valid output shape is $[\\text{float},\\text{boolean},\\text{integer}]$ with no spaces.\n\nYour implementation must be a complete, self-contained program requiring no external input. It must construct the illumination fields for the three cases, simulate the dynamics, compute the three metrics, and print the aggregated results in the exact specified format.", "solution": "The problem requires the design and implementation of a numerical simulation for a photosensitive Belousov-Zhabotinsky (BZ) reaction on a two-dimensional domain. The problem is scientifically well-posed, providing all necessary parameters and specifications for a complete solution. The core of the task is to solve a system of reaction-diffusion partial differential equations (PDEs) and compute specified metrics for three different illumination protocols.\n\n**1. Mathematical Model**\n\nThe system is described by two state variables: the activator concentration $u(x,y,t)$ and the inhibitor concentration $v(x,y,t)$. Their evolution is governed by a two-variable Oregonator model, a reduction of the full Field-Körös-Noyes (FKN) mechanism, modified to include photosensitivity. The governing PDEs are:\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{1}{\\varepsilon} \\left( u(1-u) - fv \\frac{u-q}{u+q} \\right) + D_u \\nabla^2 u\n$$\n$$\n\\frac{\\partial v}{\\partial t} = u - v + \\phi(x,y,t) + D_v \\nabla^2 v\n$$\nHere, $u$ is the activator (analogous to $\\mathrm{HBrO_2}$) and $v$ is the inhibitor (related to the oxidized catalyst, $\\mathrm{ferriin}$). The parameters $\\varepsilon$, $f$, and $q$ are kinetic constants that determine the local dynamics. The terms $D_u \\nabla^2 u$ and $D_v \\nabla^2 v$ represent Fickian diffusion with constant diffusion coefficients $D_u$ and $D_v$. The scalar field $\\phi(x,y,t)$ represents the spatially and temporally structured illumination, which photochemically generates bromide ions (an inhibitor), thus acting as a source term in the inhibitor equation and suppressing wave excitation. All variables and parameters are nondimensional.\n\nThe given parameters are:\n- Kinetic parameters: $\\varepsilon = 0.20$, $f = 1.40$, $q = 0.002$.\n- Diffusion coefficients: $D_u = 0.20$, $D_v = 0.10$.\n\n**2. Numerical Discretization**\n\nThe continuous PDEs are discretized on a square grid and integrated in time.\n\n- **Spatial Discretization**: The continuous domain is replaced by a $N \\times N$ grid with $N = 64$ and spatial step $\\Delta x = 1$. The Laplacian operator $\\nabla^2$ is approximated using a second-order, five-point finite difference stencil:\n$$\n(\\nabla^2 \\psi)_{i,j} \\approx \\frac{\\psi_{i,j+1} + \\psi_{i,j-1} + \\psi_{i+1,j} + \\psi_{i-1,j} - 4\\psi_{i,j}}{(\\Delta x)^2}\n$$\nwhere $\\psi$ can be either $u$ or $v$, and $(i,j)$ are the grid indices. Periodic boundary conditions are applied, meaning that indices are treated modulo $N$.\n\n- **Temporal Discretization**: An explicit forward Euler method is used for time integration with a time step of $\\Delta t = 0.02$. The state variables at time step $k+1$ are computed from their values at step $k$ as follows:\n$$\nu^{k+1}_{i,j} = u^k_{i,j} + \\Delta t \\left[ \\frac{1}{\\varepsilon} \\left( u^k_{i,j}(1-u^k_{i,j}) - fv^k_{i,j} \\frac{u^k_{i,j}-q}{u^k_{i,j}+q} \\right) + D_u (\\nabla^2 u)^k_{i,j} \\right]\n$$\n$$\nv^{k+1}_{i,j} = v^k_{i,j} + \\Delta t \\left[ u^k_{i,j} - v^k_{i,j} + \\phi^k_{i,j} + D_v (\\nabla^2 v)^k_{i,j} \\right]\n$$\nThe chosen time step $\\Delta t = 0.02$ satisfies the Courant-Friedrichs-Lewy (CFL) stability condition for the diffusion part, $\\Delta t  (\\Delta x)^2 / (4 \\max\\{D_u, D_v\\})$, since $0.02  1^2 / (4 \\times 0.20) = 1.25$.\n\n**3. Implementation of Test Cases**\n\nFor all cases, the simulation starts from an approximate uniform steady state with $u=q$ and $v=q$. A wave is then initiated by applying a seed: within a central disk of radius $r_0=3$, the activator is set to $u=0.90$.\n\n- **Case A: Write and Measure Speed**\n  - **Illumination**: A vertical channel of low illumination ($\\phi_{\\mathrm{dark}} = 0.005$) with width $w=6$ is \"written\" into a background of high, inhibitory illumination ($\\phi_{\\mathrm{bright}} = 0.070$).\n  - **Simulation**: The system evolves for $T_A = 400$ steps ($\\Delta t=0.02$ per step).\n  - **Metric**: The axial speed of the wave front along the channel's centerline ($x=N/2$) is estimated. For each time step $k$ from $k_1=100$ ($t=2.0$) to $k_2=400$ ($t=8.0$), we find the maximum distance along the $y$-axis from the domain center to a point where $u  \\theta_u=0.30$. A least-squares linear fit of these distances against time yields the wave speed as the slope of the line.\n\n- **Case B: Erase and Test Quenching**\n  - **Illumination**: The domain starts with uniform low illumination ($\\phi_{\\mathrm{dark}} = 0.005$), allowing a wave to propagate outwards from the seed. At time $t_{\\mathrm{switch}} = 4.0$ (step $k=200$), the illumination is switched globally to a high, \"erasing\" value ($\\phi_{\\mathrm{erase}} = 0.080$).\n  - **Simulation**: The system evolves for a total of $T_B = 600$ steps.\n  - **Metric**: Quenching success is evaluated at the final time. If the spatial average of the activator, $\\overline{u}$, is below a threshold $\\theta_{\\mathrm{erase}} = 0.10$, the quenching is successful (returns `True`), otherwise it fails (returns `False`).\n\n- **Case C: Boundary Case (No Propagation)**\n  - **Illumination**: The domain is subjected to uniform high illumination ($\\phi_{\\mathrm{bright}} = 0.080$) for the entire simulation. This level of illumination is expected to suppress any wave propagation from the initial seed.\n  - **Simulation**: The system evolves for $T_C = 200$ steps.\n  - **Metric**: At the final time, we count the number of grid points where the activator concentration $u$ remains above the threshold $\\theta_u = 0.30$. This measures the extent to which the initial excitation has been quenched.\n\nThe implementation encapsulates this logic into a single program that runs all three cases and reports the computed metrics in the specified format. The core of the implementation is a numerical solver for the reaction-diffusion system, which is then applied under the specific conditions of each test case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates a photosensitive Belousov-Zhabotinsky (BZ) reaction\n    under three different illumination protocols and computes specified metrics.\n    \"\"\"\n    \n    # --- Global Parameters ---\n    N = 64\n    DX = 1.0\n    DT = 0.02\n    \n    # Kinetic and transport parameters\n    EPS = 0.20\n    F = 1.40\n    Q = 0.002\n    DU = 0.20\n    DV = 0.10\n\n    # Initial condition parameters\n    R0 = 3\n    U_SEED = 0.90\n    CENTER_X, CENTER_Y = N // 2, N // 2\n\n    # --- Helper Functions ---\n\n    def get_initial_state():\n        \"\"\"Initializes the activator (u) and inhibitor (v) fields.\"\"\"\n        u = np.full((N, N), Q, dtype=np.float64)\n        v = np.full((N, N), Q, dtype=np.float64)\n        \n        y_coords, x_coords = np.mgrid[0:N, 0:N]\n        dist_sq = (x_coords - CENTER_X)**2 + (y_coords - CENTER_Y)**2\n        seed_mask = dist_sq  R0**2\n        u[seed_mask] = U_SEED\n        \n        return u, v\n\n    def compute_laplacian(field):\n        \"\"\"Computes the 2D Laplacian with periodic boundary conditions.\"\"\"\n        return (np.roll(field, 1, axis=0) + np.roll(field, -1, axis=0) +\n                np.roll(field, 1, axis=1) + np.roll(field, -1, axis=1) - 4 * field) / (DX**2)\n\n    def integration_step(u, v, phi):\n        \"\"\"Performs one forward Euler step.\"\"\"\n        lap_u = compute_laplacian(u)\n        lap_v = compute_laplacian(v)\n\n        reaction_u = (1 / EPS) * (u * (1 - u) - F * v * (u - Q) / (u + Q))\n        reaction_v = u - v\n\n        u_new = u + DT * (reaction_u + DU * lap_u)\n        v_new = v + DT * (reaction_v + phi + DV * lap_v)\n        \n        return u_new, v_new\n\n    # --- Test Case Implementations ---\n\n    def run_case_a():\n        \"\"\"Case A: Write a confined stripe-guided wave and estimate axial front speed.\"\"\"\n        \n        # Parameters\n        T_STEPS = 400\n        PHI_DARK = 0.005\n        PHI_BRIGHT = 0.070\n        W = 6.0\n        THETA_U = 0.30\n        K1 = int(2.00 / DT)\n        K2 = int(8.00 / DT)\n        \n        # Setup illumination field\n        _, x_coords = np.mgrid[0:N, 0:N]\n        phi = np.full((N, N), PHI_BRIGHT, dtype=np.float64)\n        stripe_mask = np.abs(x_coords - CENTER_X)  W / 2\n        phi[stripe_mask] = PHI_DARK\n\n        # Setup simulation\n        u, v = get_initial_state()\n        times, distances = [], []\n\n        # Run simulation\n        for k in range(1, T_STEPS + 1):\n            u, v = integration_step(u, v, phi)\n            \n            if k = K1 and k = K2:\n                center_col_u = u[:, CENTER_X]\n                above_threshold_rows = np.where(center_col_u  THETA_U)[0]\n                \n                if above_threshold_rows.size  0:\n                    max_dist = np.max(np.abs(above_threshold_rows - CENTER_Y)) * DX\n                else:\n                    max_dist = 0.0\n                \n                times.append(k * DT)\n                distances.append(max_dist)\n        \n        # Calculate metric\n        if not times or len(times)  2:\n            return 0.0\n\n        p = np.polyfit(times, distances, 1)\n        speed = p[0]\n        \n        return float(speed)\n\n    def run_case_b():\n        \"\"\"Case B: Erase by global brightening and report quenching success.\"\"\"\n\n        # Parameters\n        T_STEPS = 600\n        T_SWITCH = 4.00\n        K_SWITCH = int(T_SWITCH / DT)\n        PHI_DARK = 0.005\n        PHI_ERASE = 0.080\n        THETA_ERASE = 0.10\n\n        # Setup simulation\n        u, v = get_initial_state()\n\n        # Run simulation\n        for k in range(1, T_STEPS + 1):\n            if k * DT  T_SWITCH:\n                phi_val = PHI_DARK\n            else:\n                phi_val = PHI_ERASE\n            phi = np.full((N, N), phi_val, dtype=np.float64)\n            u, v = integration_step(u, v, phi)\n        \n        # Calculate metric\n        mean_u = np.mean(u)\n        \n        return bool(mean_u  THETA_ERASE)\n\n    def run_case_c():\n        \"\"\"Case C: Uniformly bright, no propagation.\"\"\"\n        \n        # Parameters\n        T_STEPS = 200\n        PHI_BRIGHT = 0.080\n        THETA_U = 0.30\n        \n        # Setup illumination\n        phi = np.full((N, N), PHI_BRIGHT, dtype=np.float64)\n\n        # Setup simulation\n        u, v = get_initial_state()\n\n        # Run simulation\n        for _ in range(T_STEPS):\n            u, v = integration_step(u, v, phi)\n            \n        # Calculate metric\n        count = np.sum(u  THETA_U)\n        \n        return int(count)\n\n    # --- Main Execution ---\n    results = [\n        run_case_a(),\n        run_case_b(),\n        run_case_c()\n    ]\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\n\nsolve()\n\n```", "id": "2949245"}]}