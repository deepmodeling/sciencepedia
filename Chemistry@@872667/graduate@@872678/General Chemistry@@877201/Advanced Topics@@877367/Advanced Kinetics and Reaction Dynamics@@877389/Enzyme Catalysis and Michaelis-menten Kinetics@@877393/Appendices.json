{"hands_on_practices": [{"introduction": "The standard Michaelis-Menten model provides a foundational understanding of enzyme kinetics, but real biological systems often present additional complexities. One common phenomenon is product inhibition, where the accumulating product competes with the substrate for the enzyme's active site. This practice challenges you to derive a modified rate law that accounts for competitive product inhibition, a crucial skill for accurately modeling enzymatic reactions in settings like industrial bioreactors or metabolic pathways where product concentration can be significant [@problem_id:1993723].", "problem": "An enzyme `E` is used in an industrial bioreactor to convert a substrate `S` into a valuable product `P`. Experimental data suggests that as the product `P` accumulates, the reaction rate slows down more than expected from substrate depletion alone. This is hypothesized to be due to competitive product inhibition, where `P` binds reversibly to the enzyme's active site.\n\nThe proposed kinetic scheme is as follows:\n1.  Enzyme-substrate binding: $E + S \\rightleftharpoons ES$ (with forward rate constant $k_1$ and reverse rate constant $k_{-1}$)\n2.  Catalytic step: $ES \\rightarrow E + P$ (with catalytic rate constant $k_{cat}$)\n3.  Product inhibition: $E + P \\rightleftharpoons EP$ (a rapid equilibrium)\n\nFor this system, we define the following constants:\n- The Michaelis constant, $K_M = \\frac{k_{-1} + k_{cat}}{k_1}$.\n- The product inhibition dissociation constant, $K_P = \\frac{[E][P]}{[EP]}$.\n- The total enzyme concentration, $[E]_T$.\n- The maximum velocity, $V_{max} = k_{cat}[E]_T$.\n\nAssuming the concentration of the enzyme-substrate complex, `[ES]`, reaches a steady state, derive a closed-form analytic expression for the initial reaction velocity, $v_0$. The expression should be given in terms of $V_{max}$, $K_M$, $K_P$, the initial substrate concentration $[S]$, and the initial product concentration $[P]$.", "solution": "We use the given kinetic scheme with competitive binding of product to the free enzyme and apply the steady-state approximation for the enzyme-substrate complex together with rapid equilibrium for product binding.\n\nFirst, write the steady-state condition for $[ES]$:\n$$\n\\frac{d[ES]}{dt}=k_{1}[E][S]-(k_{-1}+k_{cat})[ES]=0 \\quad \\Rightarrow \\quad [ES]=\\frac{k_{1}}{k_{-1}+k_{cat}}[E][S]=\\frac{[E][S]}{K_{M}}.\n$$\n\nNext, use rapid equilibrium for product binding to free enzyme:\n$$\nK_{P}=\\frac{[E][P]}{[EP]} \\quad \\Rightarrow \\quad [EP]=\\frac{[E][P]}{K_{P}}.\n$$\n\nApply the total enzyme conservation:\n$$\n[E]_{T}=[E]+[ES]+[EP]=[E]+[ES]+\\frac{[E][P]}{K_{P}}=[E]\\left(1+\\frac{[P]}{K_{P}}\\right)+[ES].\n$$\nSolve this for $[E]$:\n$$\n[E]=\\frac{[E]_{T}-[ES]}{1+\\frac{[P]}{K_{P}}}.\n$$\n\nSubstitute this expression for $[E]$ into $[ES]=\\frac{[E][S]}{K_{M}}$:\n$$\n[ES]=\\frac{[S]}{K_{M}}\\cdot \\frac{[E]_{T}-[ES]}{1+\\frac{[P]}{K_{P}}}.\n$$\nRearrange to solve for $[ES]$ explicitly:\n$$\n[ES]\\left(1+\\frac{[P]}{K_{P}}\\right)=\\frac{[S]}{K_{M}}\\left([E]_{T}-[ES]\\right),\n$$\n$$\n[ES]\\left(1+\\frac{[P]}{K_{P}}+\\frac{[S]}{K_{M}}\\right)=\\frac{[E]_{T}[S]}{K_{M}},\n$$\n$$\n[ES]=\\frac{[E]_{T}\\,\\frac{[S]}{K_{M}}}{1+\\frac{[P]}{K_{P}}+\\frac{[S]}{K_{M}}}.\n$$\n\nThe initial velocity is $v_{0}=k_{cat}[ES]$. Using $V_{max}=k_{cat}[E]_{T}$,\n$$\nv_{0}=k_{cat}[ES]=V_{max}\\,\\frac{\\frac{[S]}{K_{M}}}{1+\\frac{[P]}{K_{P}}+\\frac{[S]}{K_{M}}}.\n$$\nEquivalently, multiplying numerator and denominator by $K_{M}$ gives the standard competitive-inhibition form:\n$$\nv_{0}=\\frac{V_{max}[S]}{K_{M}\\left(1+\\frac{[P]}{K_{P}}\\right)+[S]}.\n$$\nThis is the desired closed-form expression in terms of $V_{max}$, $K_{M}$, $K_{P}$, $[S]$, and $[P]$.", "answer": "$$\\boxed{\\frac{V_{max}[S]}{K_{M}\\left(1+\\frac{[P]}{K_{P}}\\right)+[S]}}$$", "id": "1993723"}, {"introduction": "Kinetic parameters are not static; they are intrinsically linked to the thermodynamic properties of the system and can vary with environmental conditions like temperature. This exercise explores the connection between thermodynamics and enzyme kinetics within the context of competitive inhibition. By analyzing the effect of temperature on substrate and inhibitor binding affinities, you will learn to predict changes in the apparent Michaelis constant, $K_{M,app}$, using principles like the van 't Hoff equation [@problem_id:1993720].", "problem": "An enzymatic biosensor is being developed to detect a specific substrate, S. The sensor utilizes an enzyme, E, that follows Michaelis-Menten kinetics. The enzyme's Michaelis constant for the substrate is denoted by $K_M$.\n\nThe sample matrix in which the sensor operates contains a background substance, I, which acts as a competitive inhibitor for the enzyme. The concentration of this inhibitor, $[I]$, can be considered constant for the sensor's operational lifetime. The inhibition constant for I is denoted by $K_I$. Under these conditions, the enzyme exhibits an apparent Michaelis constant, $K_{M,app}$, given by the relation $K_{M,app} = K_M \\left(1 + \\frac{[I]}{K_I}\\right)$.\n\nThermodynamic studies have been performed on the binding processes. The binding of the substrate S to the enzyme E ($E+S \\rightleftharpoons ES$) is a slightly endothermic process, with a standard molar enthalpy change of $\\Delta H_{bind,S}^\\circ > 0$. In contrast, the binding of the inhibitor I to the enzyme E ($E+I \\rightleftharpoons EI$) is a strongly exothermic process, with a standard molar enthalpy change of $\\Delta H_{bind,I}^\\circ  0$. Assume that these enthalpy changes are independent of temperature over the small operational range of the sensor. The dissociation constants $K_M$ and $K_I$ are related to the standard Gibbs free energy of their respective dissociation processes.\n\nThe biosensor is initially calibrated at a temperature $T_0$. If the operating temperature of the sensor increases slightly, how will the value of the apparent Michaelis constant, $K_{M,app}$, change?\n\nA. $K_{M,app}$ will increase.\n\nB. $K_{M,app}$ will decrease.\n\nC. $K_{M,app}$ will remain unchanged.\n\nD. The change in $K_{M,app}$ depends on the initial concentration of the inhibitor $[I]$.\n\nE. The change in $K_{M,app}$ cannot be determined without knowing the entropy changes for the binding processes.", "solution": "The apparent Michaelis constant under competitive inhibition is $K_{M,\\mathrm{app}}(T)=K_{M}(T)\\left(1+\\frac{[I]}{K_{I}(T)}\\right)$ with $[I]$ constant.\n\nTo determine how $K_{M,\\mathrm{app}}$ changes with temperature, use the van 't Hoff relation for the association (binding) equilibrium $E+L \\rightleftharpoons EL$ with standard binding enthalpy $\\Delta H_{\\mathrm{bind},L}^{\\circ}$:\n$$\n\\frac{\\mathrm{d}\\ln K_{a,L}}{\\mathrm{d}T}=\\frac{\\Delta H_{\\mathrm{bind},L}^{\\circ}}{R T^{2}},\n$$\nwhere $K_{a,L}$ is the association equilibrium constant. The dissociation constant is $K_{d,L}=1/K_{a,L}$, so\n$$\n\\frac{\\mathrm{d}\\ln K_{d,L}}{\\mathrm{d}T}=-\\frac{\\Delta H_{\\mathrm{bind},L}^{\\circ}}{R T^{2}}.\n$$\n\nIdentifying $K_{M}$ with the substrate dissociation constant and $K_{I}$ with the inhibitor dissociation constant (as stated), we obtain:\n- For substrate binding, $\\Delta H_{\\mathrm{bind},S}^{\\circ}>0$ (endothermic), hence\n$$\n\\frac{\\mathrm{d}\\ln K_{M}}{\\mathrm{d}T}=-\\frac{\\Delta H_{\\mathrm{bind},S}^{\\circ}}{R T^{2}}0 \\quad \\Rightarrow \\quad \\frac{\\mathrm{d}K_{M}}{\\mathrm{d}T}0.\n$$\n- For inhibitor binding, $\\Delta H_{\\mathrm{bind},I}^{\\circ}0$ (exothermic), hence\n$$\n\\frac{\\mathrm{d}\\ln K_{I}}{\\mathrm{d}T}=-\\frac{\\Delta H_{\\mathrm{bind},I}^{\\circ}}{R T^{2}}0 \\quad \\Rightarrow \\quad \\frac{\\mathrm{d}K_{I}}{\\mathrm{d}T}0.\n$$\n\nDifferentiate $K_{M,\\mathrm{app}}(T)$:\n$$\n\\frac{\\mathrm{d}K_{M,\\mathrm{app}}}{\\mathrm{d}T}\n=\\left(\\frac{\\mathrm{d}K_{M}}{\\mathrm{d}T}\\right)\\left(1+\\frac{[I]}{K_{I}}\\right)\n+K_{M}\\left(-\\frac{[I]}{K_{I}^{2}}\\right)\\left(\\frac{\\mathrm{d}K_{I}}{\\mathrm{d}T}\\right).\n$$\nSince $1+\\frac{[I]}{K_{I}}0$, $\\frac{\\mathrm{d}K_{M}}{\\mathrm{d}T}0$, and $\\frac{\\mathrm{d}K_{I}}{\\mathrm{d}T}0$, both terms on the right-hand side are negative. Therefore,\n$$\n\\frac{\\mathrm{d}K_{M,\\mathrm{app}}}{\\mathrm{d}T}0,\n$$\nso a slight increase in temperature decreases $K_{M,\\mathrm{app}}$. This conclusion does not depend on the specific value of $[I]$ (beyond being nonnegative), and it does not require knowledge of entropy changes because the temperature trend is determined by the given enthalpy signs via the van 't Hoff relation.\n\nHence the correct choice is that $K_{M,\\mathrm{app}}$ will decrease.", "answer": "$$\\boxed{B}$$", "id": "1993720"}, {"introduction": "Extracting reliable kinetic parameters from experimental data is a cornerstone of quantitative enzymology. While linearized methods like the Lineweaver-Burk plot are historically significant, modern analysis relies heavily on direct nonlinear regression. This computational practice guides you through implementing both techniques to analyze several datasets, offering a direct comparison of their performance and revealing the statistical pitfalls of linearization versus the robustness of nonlinear fitting [@problem_id:2938278].", "problem": "You are provided with initial rate measurements for a single-substrate enzyme following the binding-and-catalysis scheme $E + S \\rightleftharpoons ES \\rightarrow E + P$ under initial-rate conditions. Starting from the law of mass action and the quasi-steady-state assumption, derive an expression for the initial velocity $v$ as a function of substrate concentration $[S]$ and two parameters that characterize the enzyme-catalyzed reaction. Then, implement and use two independent estimation procedures to infer these two parameters from given datasets: (i) direct nonlinear least-squares regression on the derived rate law and (ii) a linear regression based on the Lineweaver-Burk (LB) transformation. Finally, compare the estimates from the two procedures for each dataset.\n\nFundamental base to begin the derivation:\n- The reaction mechanism is $E + S \\xrightleftharpoons[k_{-1}]{k_1} ES \\xrightarrow{k_2} E + P$ with rate constants $k_1$, $k_{-1}$, and $k_2$.\n- Under initial-rate conditions, product accumulation is negligible, and total enzyme concentration $[E]_T$ is conserved.\n- The quasi-steady-state condition for the complex $ES$ holds at early times.\n- The observable initial rate is $v = \\dfrac{d[P]}{dt}$ at $t \\to 0^+$.\n- Assume $[S]_0 \\gg [E]_T$ so that substrate depletion is negligible during the initial-rate measurement.\n\nYour program must:\n1. Derive the initial-rate law from the fundamental base above and use it as the model for nonlinear regression to estimate the two kinetic parameters. Denote the maximal velocity as $V_{\\max}$ (in $\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$) and the Michaelis constant as $K_m$ (in $\\mu \\mathrm{M}$). Use unweighted nonlinear least squares with physically meaningful constraints ($V_{\\max}  0$, $K_m  0$).\n2. Independently, apply the Lineweaver-Burk (LB) transformation, which rewrites the model in a linear-in-parameters form, and estimate the same parameters via ordinary least squares on the transformed variables.\n3. For each dataset, report both sets of parameter estimates. Express $V_{\\max}$ in $\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$ and $K_m$ in $\\mu \\mathrm{M}$. Round each reported number to four significant figures.\n\nTest suite (all $[S]$ values are in $\\mu \\mathrm{M}$, all $v$ values are in $\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$):\n- Dataset A (balanced range of $[S]$): $[S] = [2, 5, 10, 20, 40, 80, 160]$, $v = [0.162, 0.349, 0.641, 0.991, 1.441, 1.792, 2.118]$.\n- Dataset B (low-$[S]$-heavy): $[S] = [0.5, 1, 2, 3, 4, 5, 8]$, $v = [0.106, 0.208, 0.335, 0.461, 0.522, 0.612, 0.727]$.\n- Dataset C (high-$[S]$-heavy): $[S] = [10, 20, 50, 100, 200, 400, 800]$, $v = [0.040, 0.071, 0.165, 0.258, 0.409, 0.523, 0.648]$.\n- Dataset D (includes a mild high-$[S]$ outlier): $[S] = [5, 15, 30, 60, 120, 240]$, $v = [0.191, 0.492, 0.869, 1.329, 1.960, 2.270]$.\n\nAlgorithmic requirements and numerical conditions:\n- For nonlinear regression, use a robust initialization strategy that does not assume prior knowledge of the parameters, and enforce $V_{\\max}  0$ and $K_m  0$.\n- For the LB method, form $x = 1/[S]$ and $y = 1/v$ and perform ordinary least squares on $y = a x + b$. Convert the fitted slope $a$ and intercept $b$ into $V_{\\max}$ and $K_m$. Ensure no division-by-zero occurs.\n- For each dataset, output the ordered list $[V_{\\max}^{\\mathrm{NL}}, K_m^{\\mathrm{NL}}, V_{\\max}^{\\mathrm{LB}}, K_m^{\\mathrm{LB}}]$, where the superscripts indicate the estimation method (nonlinear versus Lineweaver-Burk). All values must be floats rounded to four significant figures, with units as specified above.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all datasets as a comma-separated list of lists enclosed in square brackets, for example, $[[x_{A1},x_{A2},x_{A3},x_{A4}],[x_{B1},x_{B2},x_{B3},x_{B4}],\\ldots]$ with no spaces.", "solution": "The problem is subjected to rigorous validation and is deemed valid. It is a scientifically grounded, well-posed, and objective problem in the field of chemical kinetics. The task requires the derivation of the Michaelis-Menten equation from fundamental principles and its application to experimental data analysis using two standard regression techniques: direct nonlinear least-squares fitting and linear regression on the Lineweaver-Burk transformed data. This is a classic exercise that assesses both theoretical understanding and practical data analysis skills.\n\nThe solution proceeds in two parts: first, a formal derivation of the rate law, and second, a description of the computational methods used to estimate the kinetic parameters from the provided datasets.\n\n**1. Derivation of the Michaelis-Menten Rate Law**\n\nThe enzymatic reaction is described by the following mechanism:\n$$\nE + S \\xrightleftharpoons[k_{-1}]{k_1} ES \\xrightarrow{k_2} E + P\n$$\nwhere $E$ is the enzyme, $S$ is the substrate, $ES$ is the enzyme-substrate complex, and $P$ is the product. The rate constants for the association, dissociation, and catalytic steps are $k_1$, $k_{-1}$, and $k_2$, respectively.\n\nThe rates of change for the concentrations of the chemical species involved are described by the law of mass action. For the enzyme-substrate complex $[ES]$, the rate equation is:\n$$\n\\frac{d[ES]}{dt} = k_1 [E][S] - k_{-1}[ES] - k_2[ES] = k_1 [E][S] - (k_{-1} + k_2)[ES]\n$$\n\nThe total enzyme concentration, $[E]_T$, is conserved throughout the reaction:\n$$\n[E]_T = [E] + [ES]\n$$\nThis allows the concentration of free enzyme, $[E]$, to be expressed as $[E] = [E]_T - [ES]$.\n\nThe quasi-steady-state assumption (QSSA) is applied, which posits that the concentration of the intermediate $[ES]$ complex rapidly reaches a steady state where its rate of formation is balanced by its rate of breakdown. Mathematically, this is expressed as:\n$$\n\\frac{d[ES]}{dt} \\approx 0\n$$\nApplying the QSSA to the rate equation for $[ES]$ yields:\n$$\nk_1 [E][S] - (k_{-1} + k_2)[ES] = 0\n$$\nSubstituting $[E] = [E]_T - [ES]$ into this equation:\n$$\nk_1 ([E]_T - [ES])[S] - (k_{-1} + k_2)[ES] = 0\n$$\nWe now solve for the steady-state concentration of the complex, $[ES]$:\n$$\nk_1 [E]_T [S] - k_1 [ES][S] - (k_{-1} + k_2)[ES] = 0\n$$\n$$\nk_1 [E]_T [S] = [ES] (k_1[S] + k_{-1} + k_2)\n$$\n$$\n[ES] = \\frac{k_1 [E]_T [S]}{k_1[S] + k_{-1} + k_2}\n$$\nBy dividing the numerator and denominator by $k_1$, we get:\n$$\n[ES] = \\frac{[E]_T [S]}{[S] + \\frac{k_{-1} + k_2}{k_1}}\n$$\n\nThe initial velocity of the reaction, $v$, is defined as the rate of product formation, which is proportional to the concentration of the $ES$ complex:\n$$\nv = \\frac{d[P]}{dt} = k_2 [ES]\n$$\nSubstituting the expression for $[ES]$ into the velocity equation gives:\n$$\nv = k_2 \\frac{[E]_T [S]}{[S] + \\frac{k_{-1} + k_2}{k_1}}\n$$\nThis expression is the complete rate law under the QSSA. To simplify it into the familiar Michaelis-Menten form, we define two key parameters:\n1.  The maximal velocity, $V_{\\max}$, which is the theoretical maximum rate of the reaction when the enzyme is fully saturated with substrate ($[S] \\to \\infty$). In this limit, $[ES] \\approx [E]_T$, and the velocity becomes $v = k_2 [E]_T$. Therefore, we define:\n    $$\n    V_{\\max} = k_2 [E]_T\n    $$\n2.  The Michaelis constant, $K_m$, which is a composite constant representing the substrate concentration at which the reaction velocity is half of $V_{\\max}$. We define it as:\n    $$\n    K_m = \\frac{k_{-1} + k_2}{k_1}\n    $$\n\nSubstituting these two parameters, $V_{\\max}$ and $K_m$, into the rate law results in the Michaelis-Menten equation:\n$$\nv = \\frac{V_{\\max}[S]}{K_m + [S]}\n$$\nThis equation will serve as the model for the nonlinear regression analysis.\n\n**2. Parameter Estimation Procedures**\n\nTwo independent methods are implemented to estimate $V_{\\max}$ and $K_m$ from the provided datasets.\n\n**2.1. Direct Nonlinear Least-Squares (NLS) Regression**\n\nThis method directly fits the Michaelis-Menten equation to the experimental data pairs $([S]_i, v_i)$. The goal is to find the parameter values for $V_{\\max}$ and $K_m$ that minimize the sum of squared residuals (SSR):\n$$\n\\mathrm{SSR}(V_{\\max}, K_m) = \\sum_{i=1}^{n} \\left( v_i - \\frac{V_{\\max}[S]_i}{K_m + [S]_i} \\right)^2\n$$\nThis is a nonlinear optimization problem. The implementation utilizes the `scipy.optimize.curve_fit` function. To ensure robustness and physical meaning, the following conditions are applied:\n-   A robust initial guess for the parameters is generated: $V_{\\max, 0} = \\max(v_{\\text{data}})$ and $K_{m, 0} = \\mathrm{median}([S]_{\\text{data}})$.\n-   Parameter constraints $V_{\\max} > 0$ and $K_m > 0$ are enforced using the `bounds` argument of the function.\n\n**2.2. Lineweaver-Burk (LB) Linear Regression**\n\nThis method involves a transformation of the Michaelis-Menten equation into a linear form. By taking the reciprocal of both sides of the equation:\n$$\n\\frac{1}{v} = \\frac{K_m + [S]}{V_{\\max}[S]} = \\frac{K_m}{V_{\\max}[S]} + \\frac{[S]}{V_{\\max}[S]}\n$$\nThis simplifies to the equation of a straight line, $y = ax + b$:\n$$\n\\frac{1}{v} = \\left(\\frac{K_m}{V_{\\max}}\\right) \\frac{1}{[S]} + \\frac{1}{V_{\\max}}\n$$\nwhere $y = 1/v$, $x = 1/[S]$, the slope is $a = K_m / V_{\\max}$, and the y-intercept is $b = 1 / V_{\\max}$.\n\nThe experimental data are transformed to $(x_i, y_i) = (1/[S]_i, 1/v_i)$. An ordinary least-squares linear regression is performed on these transformed data to find the best-fit slope $a$ and intercept $b$. The kinetic parameters are then calculated from these fitted values:\n$$\nV_{\\max} = \\frac{1}{b}\n$$\n$$\nK_m = a \\cdot V_{\\max} = \\frac{a}{b}\n$$\nThis method is computationally simple but can be sensitive to errors in measurements at low substrate concentrations, as these points have high leverage in the linear fit.\n\nThe following program implements both procedures for all provided datasets and formats the results as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\nimport math\n\ndef solve():\n    \"\"\"\n    Derives Michaelis-Menten parameters using NLS and Lineweaver-Burk methods.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset A\n        {'S': np.array([2, 5, 10, 20, 40, 80, 160], dtype=float), \n         'v': np.array([0.162, 0.349, 0.641, 0.991, 1.441, 1.792, 2.118], dtype=float)},\n        # Dataset B\n        {'S': np.array([0.5, 1, 2, 3, 4, 5, 8], dtype=float), \n         'v': np.array([0.106, 0.208, 0.335, 0.461, 0.522, 0.612, 0.727], dtype=float)},\n        # Dataset C\n        {'S': np.array([10, 20, 50, 100, 200, 400, 800], dtype=float), \n         'v': np.array([0.040, 0.071, 0.165, 0.258, 0.409, 0.523, 0.648], dtype=float)},\n        # Dataset D\n        {'S': np.array([5, 15, 30, 60, 120, 240], dtype=float), \n         'v': np.array([0.191, 0.492, 0.869, 1.329, 1.960, 2.270], dtype=float)},\n    ]\n\n    all_results = []\n\n    def michaelis_menten(S, Vmax, Km):\n        \"\"\"Michaelis-Menten model function.\"\"\"\n        return (Vmax * S) / (Km + S)\n\n    def round_to_sf(x, sf):\n        \"\"\"Rounds a number to a specified number of significant figures.\"\"\"\n        if x == 0:\n            return 0.0\n        sign = -1 if x  0 else 1\n        x = abs(x)\n        if x == 0:\n            return 0.0\n        \n        # Calculate rounding position\n        pos = sf - 1 - int(math.floor(math.log10(x)))\n        return sign * round(x, pos)\n\n    for case in test_cases:\n        S_data = case['S']\n        v_data = case['v']\n\n        # (i) Nonlinear Least-Squares Regression (NLS)\n        Vmax_nl, Km_nl = np.nan, np.nan\n        try:\n            # Robust initial guess for parameters: Vmax ~ max(v), Km ~ S at Vmax/2\n            p0 = [np.max(v_data), np.median(S_data)]\n            # Enforce physically meaningful constraints (Vmax  0, Km  0)\n            bounds = ([0, 0], [np.inf, np.inf])\n            popt_nl, _ = curve_fit(michaelis_menten, S_data, v_data, p0=p0, bounds=bounds)\n            Vmax_nl, Km_nl = popt_nl\n        except RuntimeError:\n            # This case occurs if the optimization fails to converge.\n            pass\n\n        # (ii) Lineweaver-Burk (LB) Linear Regression\n        Vmax_lb, Km_lb = np.nan, np.nan\n        try:\n            # Transform data: x = 1/[S], y = 1/v\n            # The problem statement guarantees S  0 and v  0.\n            x_lb = 1.0 / S_data\n            y_lb = 1.0 / v_data\n            \n            # Perform linear regression: y = a*x + b\n            # slope (a) = Km/Vmax, intercept (b) = 1/Vmax\n            slope, intercept = np.polyfit(x_lb, y_lb, 1)\n\n            # Check for physically meaningful results (positive slope and intercept)\n            if intercept  0 and slope  0:\n                Vmax_lb = 1.0 / intercept\n                Km_lb = slope / intercept\n        except (np.linalg.LinAlgError, ZeroDivisionError):\n            # This case occurs if linear algebra fails or if intercept is zero.\n            pass\n        \n        # Round all results to four significant figures\n        sf = 4\n        result = [\n            round_to_sf(Vmax_nl, sf),\n            round_to_sf(Km_nl, sf),\n            round_to_sf(Vmax_lb, sf),\n            round_to_sf(Km_lb, sf)\n        ]\n        all_results.append(result)\n\n    # Format the output string to be a list of lists with no spaces\n    # Example: [[v_a,k_a,v_a,k_a],[v_b,k_b,v_b,k_b]]\n    result_strings = [f\"[{r[0]},{r[1]},{r[2]},{r[3]}]\" for r in all_results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2938278"}]}