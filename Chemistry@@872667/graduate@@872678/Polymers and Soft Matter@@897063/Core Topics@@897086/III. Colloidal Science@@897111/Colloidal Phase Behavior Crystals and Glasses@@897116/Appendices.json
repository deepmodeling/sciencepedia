{"hands_on_practices": [{"introduction": "The most fundamental property of a dense particulate system is its packing fraction, $\\phi$. This exercise explores the upper limits of packing for both perfectly ordered crystals and disordered glassy arrangements. By deriving the famous close-packing fraction for an FCC lattice and contrasting it with random close packing, you will gain a concrete understanding of how structure impacts density [@problem_id:2909316]. Furthermore, you will work with the Steinhardt bond-orientational order parameter, $Q_{6}$, a powerful tool for quantifying the degree and type of local order that distinguishes crystals from glasses.", "problem": "A monodisperse suspension of hard, non-attracting colloidal spheres exhibits crystalline face-centered cubic (fcc) or hexagonal close-packed (hcp) order at maximum packing, and forms a mechanically stable disordered jammed state known as random close packing (RCP). Consider the following:\n\n1. The packing fraction is defined as $\\phi = V_{\\text{spheres}}/V_{\\text{cell}}$. For an fcc crystal of hard spheres of radius $R$, the cubic unit cell of edge length $a$ contains $4$ spheres in total, with geometrical contact along the face diagonal at close packing.\n\n2. The random close packing fraction for monodisperse hard spheres is taken as $\\phi_{\\text{RCP}} = 0.64$.\n\n3. To quantify structural order, use the Steinhardt bond-orientational order parameter of degree six, $Q_{6}$, defined globally by\n$$\nQ_{6} = \\left(\\frac{4\\pi}{13}\\sum_{m=-6}^{6} \\left| \\left\\langle Y_{6m}(\\theta,\\varphi) \\right\\rangle \\right|^{2}\\right)^{1/2},\n$$\nwhere $\\left\\langle \\cdot \\right\\rangle$ denotes an average over bonds defined by the $12$ nearest neighbors of each particle and then an average over all particles, and $Y_{6m}$ are degree-$6$ spherical harmonics. For perfect crystals with $12$ neighbors, take $Q_{6}^{\\text{fcc}} = 0.5745$, $Q_{6}^{\\text{hcp}} = 0.4848$. For disordered random close packing, take $Q_{6}^{\\text{RCP}} = 0.2700$.\n\n4. Define a dimensionless contrast index that combines packing and bond-orientational order, for a structure $s \\in \\{\\text{fcc},\\text{hcp}\\}$, by\n$$\nC_{s} = \\left[ \\left( \\frac{\\phi_{s} - \\phi_{\\text{RCP}}}{\\phi_{\\text{cp}}} \\right)^{2} + \\left( \\frac{Q_{6}^{s} - Q_{6}^{\\text{RCP}}}{Q_{6}^{\\text{fcc}} - Q_{6}^{\\text{RCP}}} \\right)^{2} \\right]^{1/2},\n$$\nwhere $\\phi_{\\text{cp}}$ is the maximum close-packed fraction for fcc/hcp and $\\phi_{s} = \\phi_{\\text{cp}}$ for both fcc and hcp.\n\nTasks:\na) Starting from the geometric constraints of hard-sphere contact in the fcc lattice, derive $\\phi_{\\text{cp}}$ in closed form.\nb) Using the provided $Q_{6}$ values, compute the ratio\n$$\n\\mathcal{R} = \\frac{C_{\\text{fcc}}}{C_{\\text{hcp}}}.\n$$\nExpress your final answer for $\\mathcal{R}$ as a single dimensionless number, rounded to four significant figures. No units are required for the final answer.", "solution": "The problem presented is validated as scientifically sound, well-posed, and complete. We shall proceed with its solution in two parts as requested.\n\nPart a) requires the derivation of the packing fraction for a close-packed structure, $\\phi_{\\text{cp}}$, specifically for a face-centered cubic (fcc) lattice. The packing fraction, $\\phi$, is defined as the ratio of the total volume of the spheres within a unit cell to the volume of the unit cell itself:\n$$\n\\phi = \\frac{V_{\\text{spheres}}}{V_{\\text{cell}}}\n$$\nFor a single sphere of radius $R$, the volume is $V_{\\text{sphere}} = \\frac{4}{3}\\pi R^{3}$.\nThe problem states that the fcc unit cell contains a total of $N=4$ spheres. This is a known result from crystallography, corresponding to $8$ corner spheres (each contributing $1/8$ to the cell) and $6$ face-centered spheres (each contributing $1/2$ to the cell), giving a total of $8 \\times \\frac{1}{8} + 6 \\times \\frac{1}{2} = 1 + 3 = 4$ spheres.\nThe total volume occupied by spheres within the unit cell is therefore:\n$$\nV_{\\text{spheres}} = N \\times V_{\\text{sphere}} = 4 \\times \\frac{4}{3}\\pi R^{3} = \\frac{16}{3}\\pi R^{3}\n$$\nThe volume of the cubic unit cell is $V_{\\text{cell}} = a^{3}$, where $a$ is the lattice constant or edge length of the cube. To determine $\\phi$, we must relate $a$ to $R$. The problem specifies that for a close-packed arrangement of hard spheres, contact occurs along the face diagonal of the cubic cell.\n\nThe length of the face diagonal, $d$, of a cube with edge length $a$ is given by the Pythagorean theorem: $d^{2} = a^{2} + a^{2} = 2a^{2}$, which gives $d = a\\sqrt{2}$.\nAlong this diagonal, a sphere at one corner, a sphere at the center of the face, and a sphere at the opposite corner are in contact. The distance from the corner to the face center covers one radius of the corner sphere and one radius of the face-centered sphere. The full diagonal length, therefore, spans the radius of the first corner sphere, the full diameter of the face-centered sphere, and the radius of the second corner sphere.\nThus, the length of the face diagonal in terms of the sphere radius $R$ is:\n$$\nd = R + 2R + R = 4R\n$$\nBy equating the two expressions for the diagonal length, we establish the relationship between $a$ and $R$:\n$$\na\\sqrt{2} = 4R\n$$\nSolving for $a$, we find:\n$$\na = \\frac{4R}{\\sqrt{2}} = 2\\sqrt{2}R\n$$\nNow, we can compute the volume of the unit cell:\n$$\nV_{\\text{cell}} = a^{3} = (2\\sqrt{2}R)^{3} = 2^{3}(\\sqrt{2})^{3}R^{3} = 8(2\\sqrt{2})R^{3} = 16\\sqrt{2}R^{3}\n$$\nFinally, we substitute the expressions for $V_{\\text{spheres}}$ and $V_{\\text{cell}}$ into the definition of the packing fraction to find the close-packing fraction, $\\phi_{\\text{cp}}$:\n$$\n\\phi_{\\text{cp}} = \\frac{V_{\\text{spheres}}}{V_{\\text{cell}}} = \\frac{\\frac{16}{3}\\pi R^{3}}{16\\sqrt{2}R^{3}}\n$$\nThe terms $16$ and $R^{3}$ cancel, yielding the exact, closed-form result:\n$$\n\\phi_{\\text{cp}} = \\frac{\\pi}{3\\sqrt{2}}\n$$\nThis is the maximum possible packing fraction for monodisperse spheres, achieved by both fcc and hcp structures.\n\nPart b) requires the computation of the ratio $\\mathcal{R} = C_{\\text{fcc}}/C_{\\text{hcp}}$. The contrast index $C_{s}$ is defined as:\n$$\nC_{s} = \\left[ \\left( \\frac{\\phi_{s} - \\phi_{\\text{RCP}}}{\\phi_{\\text{cp}}} \\right)^{2} + \\left( \\frac{Q_{6}^{s} - Q_{6}^{\\text{RCP}}}{Q_{6}^{\\text{fcc}} - Q_{6}^{\\text{RCP}}} \\right)^{2} \\right]^{1/2}\n$$\nThe problem specifies that for both crystalline structures, $\\phi_{s} = \\phi_{\\text{cp}}$. Let us first evaluate $C_{\\text{fcc}}$. For $s = \\text{fcc}$, we have $\\phi_{s} = \\phi_{\\text{fcc}} = \\phi_{\\text{cp}}$ and $Q_{6}^{s} = Q_{6}^{\\text{fcc}}$.\n$$\nC_{\\text{fcc}} = \\left[ \\left( \\frac{\\phi_{\\text{cp}} - \\phi_{\\text{RCP}}}{\\phi_{\\text{cp}}} \\right)^{2} + \\left( \\frac{Q_{6}^{\\text{fcc}} - Q_{6}^{\\text{RCP}}}{Q_{6}^{\\text{fcc}} - Q_{6}^{\\text{RCP}}} \\right)^{2} \\right]^{1/2}\n$$\nThe second term in the brackets simplifies to $1^{2}=1$. Thus:\n$$\nC_{\\text{fcc}} = \\left[ \\left( 1 - \\frac{\\phi_{\\text{RCP}}}{\\phi_{\\text{cp}}} \\right)^{2} + 1 \\right]^{1/2}\n$$\nNext, we evaluate $C_{\\text{hcp}}$. For $s = \\text{hcp}$, we have $\\phi_{s} = \\phi_{\\text{hcp}} = \\phi_{\\text{cp}}$ and $Q_{6}^{s} = Q_{6}^{\\text{hcp}}$.\n$$\nC_{\\text{hcp}} = \\left[ \\left( \\frac{\\phi_{\\text{cp}} - \\phi_{\\text{RCP}}}{\\phi_{\\text{cp}}} \\right)^{2} + \\left( \\frac{Q_{6}^{\\text{hcp}} - Q_{6}^{\\text{RCP}}}{Q_{6}^{\\text{fcc}} - Q_{6}^{\\text{RCP}}} \\right)^{2} \\right]^{1/2}\n$$\nThe first term is identical to that in $C_{\\text{fcc}}$. Let us define the following dimensionless quantities for clarity:\n$$\nX = 1 - \\frac{\\phi_{\\text{RCP}}}{\\phi_{\\text{cp}}}\n$$\n$$\nY = \\frac{Q_{6}^{\\text{hcp}} - Q_{6}^{\\text{RCP}}}{Q_{6}^{\\text{fcc}} - Q_{6}^{\\text{RCP}}}\n$$\nWith these definitions, the expressions become:\n$$\nC_{\\text{fcc}} = \\left( X^{2} + 1 \\right)^{1/2}\n$$\n$$\nC_{\\text{hcp}} = \\left( X^{2} + Y^{2} \\right)^{1/2}\n$$\nThe required ratio is then:\n$$\n\\mathcal{R} = \\frac{C_{\\text{fcc}}}{C_{\\text{hcp}}} = \\frac{\\left( X^{2} + 1 \\right)^{1/2}}{\\left( X^{2} + Y^{2} \\right)^{1/2}} = \\left( \\frac{X^{2} + 1}{X^{2} + Y^{2}} \\right)^{1/2}\n$$\nWe now substitute the numerical values provided and derived:\n$\\phi_{\\text{cp}} = \\frac{\\pi}{3\\sqrt{2}} \\approx 0.740480$\n$\\phi_{\\text{RCP}} = 0.64$\n$Q_{6}^{\\text{fcc}} = 0.5745$\n$Q_{6}^{\\text{hcp}} = 0.4848$\n$Q_{6}^{\\text{RCP}} = 0.2700$\n\nFirst, compute $X$:\n$$\nX = 1 - \\frac{0.64}{\\pi/(3\\sqrt{2})} = 1 - \\frac{0.64 \\times 3\\sqrt{2}}{\\pi} \\approx 1 - \\frac{1.92 \\times 1.414214}{3.141593} \\approx 1 - 0.864303 \\approx 0.135697\n$$\nSo, $X^{2} \\approx (0.135697)^{2} \\approx 0.0184136$.\n\nNext, compute $Y$:\n$$\nY = \\frac{0.4848 - 0.2700}{0.5745 - 0.2700} = \\frac{0.2148}{0.3045} \\approx 0.7054187\n$$\nSo, $Y^{2} \\approx (0.7054187)^{2} \\approx 0.497616$.\n\nNow we compute the ratio $\\mathcal{R}$:\n$$\n\\mathcal{R} = \\left( \\frac{0.0184136 + 1}{0.0184136 + 0.497616} \\right)^{1/2} = \\left( \\frac{1.0184136}{0.5160296} \\right)^{1/2} \\approx (1.97355)^{1/2} \\approx 1.404831\n$$\nRounding the result to four significant figures as instructed, we obtain $1.405$.", "answer": "$$\n\\boxed{1.405}\n$$", "id": "2909316"}, {"introduction": "While hard spheres provide a crucial reference system, most real colloidal systems exhibit effective interactions that drive phase separation and crystallization. This exercise explores the classic depletion interaction, where adding non-adsorbing polymers to a colloidal suspension generates a powerful, short-range attraction between the colloids due to an increase in the polymers' translational entropy. You will derive the celebrated Asakura-Oosawa depletion potential from first principles and analyze how its strength and range can be tuned by changing the polymer-to-colloid size ratio [@problem_id:2909337], a key principle in formulating complex fluids.", "problem": "A monodisperse suspension of hard-sphere colloids of radius $a$ is mixed with a dilute solution of nonadsorbing, ideal polymer coils of radius of gyration $R_{g}$ at absolute temperature $T$. Assume polymer–colloid interactions are purely excluded-volume and that each colloid is surrounded by a polymer-depleted layer of thickness equal to the polymer radius of gyration, so the exclusion radius is $R_{\\mathrm{ex}}=a+R_{g}$. The polymer coil number density is $\\rho_{p}$, so that the solution osmotic pressure in the dilute, ideal regime is controlled solely by polymer translational entropy. Consider the pairwise interaction between two colloids at center-to-center separation $d$. The depletion attraction results from the overlap of their polymer-excluded regions.\n\nStarting from the osmotic pressure of an ideal polymer solution and the geometry of the overlap of two equal spheres of radius $R_{\\mathrm{ex}}$, derive the depletion pair potential at contact and its range in separation. Then evaluate these quantities at the following parameters: $a=5.00\\times 10^{-7}\\,\\mathrm{m}$, $R_{g}=5.00\\times 10^{-8}\\,\\mathrm{m}$, $\\rho_{p}=3.58\\times 10^{20}\\,\\mathrm{m}^{-3}$, and $T=298\\,\\mathrm{K}$. Define the polymer–colloid size ratio $q=R_{g}/a$ and, after obtaining the contact result, express how the contact well depth scales with $q$ for general $q$ and in the limit $q\\ll 1$.\n\nAnswer specification:\n- Report the contact well depth as a dimensionless number in units of $k_{B}T$, that is, report $U_{\\mathrm{dep}}(0)/(k_{B}T)$.\n- Report the interaction range as a dimensionless number in units of $a$, that is, report $h_{r}/a$.\n- Round both dimensionless numbers to three significant figures.\n- For the discussion of scaling with $q$, provide your reasoning in words in your working but do not include it in the final numeric answer.", "solution": "The problem statement has been evaluated and is determined to be scientifically grounded, well-posed, and internally consistent. It presents a standard model in soft matter physics, known as the Asakura-Oosawa model, for which a unique solution can be derived from first principles. We shall proceed with the derivation.\n\nThe problem asks for the depletion pair potential between two hard-sphere colloids of radius $a$ immersed in a dilute solution of ideal, non-adsorbing polymer coils of radius of gyration $R_g$. The polymer number density is $\\rho_p$ and the temperature is $T$.\n\nThe depletion interaction originates from an imbalance in osmotic pressure. A polymer-depleted layer of thickness $R_g$ exists around each colloid. Thus, each colloid is encased in an effective exclusion sphere of radius $R_{\\mathrm{ex}} = a + R_g$. When two such colloids approach to a center-to-center distance $d  2R_{\\mathrm{ex}}$, their exclusion spheres overlap. This overlap region, previously inaccessible to the centers of the polymer coils, becomes available. The increase in the volume accessible to the polymers leads to an increase in their translational entropy and a corresponding decrease in the free energy of the system. This decrease in free energy manifests as an attractive potential between the colloids.\n\nThe change in free energy, which is the depletion potential $U_{\\mathrm{dep}}(d)$, is equal to the negative of the work done by the osmotic pressure $\\Pi$ of the polymer reservoir to fill the newly available volume $V_{\\mathrm{overlap}}(d)$.\n$$U_{\\mathrm{dep}}(d) = -\\Pi V_{\\mathrm{overlap}}(d)$$\nFor a dilute, ideal polymer solution, the osmotic pressure is given by the van 't Hoff law:\n$$\\Pi = \\rho_p k_B T$$\nwhere $k_B$ is the Boltzmann constant.\n\nThe interaction potential is therefore:\n$$U_{\\mathrm{dep}}(d) = -\\rho_p k_B T V_{\\mathrm{overlap}}(d)$$\nThe potential is non-zero only within the range where the exclusion spheres overlap, but the hard cores of the colloids do not. This corresponds to the range of center-to-center separations $2a \\le d \\le 2R_{\\mathrm{ex}}$. For $d > 2R_{\\mathrm{ex}}$, $V_{\\mathrm{overlap}}(d) = 0$ and thus $U_{\\mathrm{dep}}(d) = 0$. For $d  2a$, the hard-sphere potential is infinite.\n\nThe volume of intersection of two spheres of radius $R_{\\mathrm{ex}}$ separated by a distance $d$ is a standard geometric result:\n$$V_{\\mathrm{overlap}}(d) = \\frac{4\\pi}{3}R_{\\mathrm{ex}}^3 \\left(1 - \\frac{3d}{4R_{\\mathrm{ex}}} + \\frac{d^3}{16R_{\\mathrm{ex}}^3}\\right)$$\nThe problem requires the potential at contact, which corresponds to the hard cores touching, i.e., $d=2a$. Let us denote this potential as $U_{contact}$.\n$$U_{contact} = U_{\\mathrm{dep}}(d=2a) = -\\rho_p k_B T V_{\\mathrm{overlap}}(d=2a)$$\nWe substitute $d=2a$ into the expression for $V_{\\mathrm{overlap}}(d)$:\n$$V_{\\mathrm{overlap}}(d=2a) = \\frac{4\\pi}{3}R_{\\mathrm{ex}}^3 \\left(1 - \\frac{3(2a)}{4R_{\\mathrm{ex}}} + \\frac{(2a)^3}{16R_{\\mathrm{ex}}^3}\\right) = \\frac{4\\pi}{3}R_{\\mathrm{ex}}^3 \\left(1 - \\frac{3a}{2R_{\\mathrm{ex}}} + \\frac{a^3}{2R_{\\mathrm{ex}}^3}\\right)$$\nTo simplify this expression, we introduce the polymer-colloid size ratio $q = R_g/a$. This gives $R_{\\mathrm{ex}} = a+R_g = a(1+q)$. Substituting this into the expression for the contact volume:\n$$V_{\\mathrm{overlap}}(d=2a) = \\frac{4\\pi}{3}(a(1+q))^3 \\left(1 - \\frac{3a}{2a(1+q)} + \\frac{a^3}{2(a(1+q))^3}\\right)$$\n$$V_{\\mathrm{overlap}}(d=2a) = \\frac{4\\pi a^3}{3}(1+q)^3 \\left(1 - \\frac{3}{2(1+q)} + \\frac{1}{2(1+q)^3}\\right)$$\nWe combine the terms in the parenthesis:\n$$\\frac{2(1+q)^3 - 3(1+q)^2 + 1}{2(1+q)^3} = \\frac{2(1+3q+3q^2+q^3) - 3(1+2q+q^2) + 1}{2(1+q)^3}$$\n$$= \\frac{(2+6q+6q^2+2q^3) - (3+6q+3q^2) + 1}{2(1+q)^3} = \\frac{3q^2+2q^3}{2(1+q)^3} = \\frac{q^2(3+2q)}{2(1+q)^3}$$\nSubstituting this back into the volume expression:\n$$V_{\\mathrm{overlap}}(d=2a) = \\frac{4\\pi a^3}{3}(1+q)^3 \\left(\\frac{q^2(3+2q)}{2(1+q)^3}\\right) = \\frac{2\\pi a^3}{3} q^2(3+2q)$$\nThe dimensionless contact potential is therefore:\n$$\\frac{U_{contact}}{k_B T} = -\\rho_p \\frac{V_{\\mathrm{overlap}}(d=2a)}{1} = -\\rho_p \\frac{2\\pi a^3}{3} q^2(3+2q)$$\nThis is the required expression. The problem uses the notation $U_{\\mathrm{dep}}(0)$, which is interpreted as the potential at zero surface-to-surface separation, equivalent to $d=2a$.\n\nThe range of the interaction, $h_r$, is the maximum surface-to-surface separation for which the potential is non-zero. The interaction starts when $d = 2R_{\\mathrm{ex}} = 2(a+R_g)$. The surface-to-surface distance is $h_s = d-2a$. The maximum value is $h_r = 2(a+R_g) - 2a = 2R_g$.\nThe dimensionless interaction range is:\n$$\\frac{h_r}{a} = \\frac{2R_g}{a} = 2q$$\n\nNow we evaluate these quantities using the given parameters: $a=5.00\\times 10^{-7}\\,\\mathrm{m}$, $R_{g}=5.00\\times 10^{-8}\\,\\mathrm{m}$, $\\rho_{p}=3.58\\times 10^{20}\\,\\mathrm{m}^{-3}$, and $T=298\\,\\mathrm{K}$.\nFirst, we compute the size ratio $q$:\n$$q = \\frac{R_g}{a} = \\frac{5.00\\times 10^{-8}\\,\\mathrm{m}}{5.00\\times 10^{-7}\\,\\mathrm{m}} = 0.100$$\nThe dimensionless interaction range is:\n$$\\frac{h_r}{a} = 2q = 2(0.100) = 0.200$$\nNext, we compute the dimensionless contact well depth:\n$$\\frac{U_{contact}}{k_B T} = -\\rho_p \\frac{2\\pi a^3}{3} q^2(3+2q)$$\n$$\\frac{U_{contact}}{k_B T} = -(3.58\\times 10^{20}\\,\\mathrm{m}^{-3}) \\frac{2\\pi (5.00\\times 10^{-7}\\,\\mathrm{m})^3}{3} (0.100)^2 (3+2(0.100))$$\n$$\\frac{U_{contact}}{k_B T} = -(3.58\\times 10^{20}) \\frac{2\\pi (1.25\\times 10^{-19})}{3} (0.0100) (3.20)$$\n$$\\frac{U_{contact}}{k_B T} = -(3.58 \\times 1.25 \\times 0.0100 \\times 3.20) \\times \\frac{2\\pi}{3} \\times 10^{(20-19)}$$\n$$\\frac{U_{contact}}{k_B T} = -0.1432 \\times \\frac{20\\pi}{3} \\approx -2.9991$$\nRounding to three significant figures, we get $-3.00$.\n\nFinally, we analyze the scaling of the contact well depth with the size ratio $q$. The magnitude of the contact potential is $|U_{contact}| \\propto q^2(3+2q)$.\nFor general $q$, the well depth scales as $q^2(3+2q)$.\nIn the limit of small polymers, $q \\ll 1$, this expression simplifies. We can approximate $3+2q \\approx 3$. The scaling becomes:\n$$|U_{contact}| \\propto q^2 \\quad (\\text{for } q \\ll 1)$$\nThis is known as the protein limit or colloidal limit.\nIn the opposite limit of large polymers, $q \\gg 1$, we can approximate $3+2q \\approx 2q$. The scaling becomes:\n$$|U_{contact}| \\propto q^2(2q) = 2q^3 \\quad (\\text{for } q \\gg 1)$$\nThis is known as the polymer limit. The problem specifically asks for the general case and the $q \\ll 1$ limit.", "answer": "$$\n\\boxed{\\begin{pmatrix}-3.00  0.200\\end{pmatrix}}\n$$", "id": "2909337"}, {"introduction": "What happens when a dense liquid is cooled or compressed so rapidly that it avoids crystallization? It forms a glass—a structurally disordered solid. This exercise tackles the prediction of the liquid-to-glass transition using the ideal Mode-Coupling Theory (MCT), a powerful framework that connects the static structure of a liquid to its dynamical arrest. You will implement a numerical solver for the self-consistent MCT equations to pinpoint the critical packing fraction $\\phi_{c}$ where particles become permanently caged by their neighbors [@problem_id:2909294], offering a profound look into the theoretical underpinnings of glassy matter.", "problem": "Consider an overdamped colloidal suspension of identical hard spheres of diameter $\\,\\sigma\\,$ at number density $\\,\\rho\\,$ and packing fraction $\\,\\phi = \\pi \\rho \\sigma^{3} / 6\\,$. Within the ideal Mode-Coupling Theory (MCT) for Brownian dynamics, the nonergodicity parameters $\\,f_{q}\\,$ are defined as the long-time limits of the normalized intermediate scattering function at wavenumber $\\,q\\,$. The ideal MCT predicts a self-consistent equation for $\\,f_{q}\\,$ of the form\n$$\n\\frac{f_{q}}{1 - f_{q}} \\;=\\; m_{q},\n$$\nwhere the long-time memory kernel $\\,m_{q}\\,$ is given, for an isotropic fluid, by\n$$\nm_{q} \\;=\\; \\frac{\\rho\\, S(q)}{8 \\pi^{2} q^{2}} \\int_{0}^{\\infty} \\mathrm{d}k \\; k^{2} \\int_{-1}^{1} \\mathrm{d}\\mu \\; S(k)\\, S(p)\\; \\left[k\\,\\mu\\, c(k) + \\big(q - k \\mu\\big)\\, c(p)\\right]^{2} \\; f_{k} \\, f_{p},\n$$\nwith $\\,p = \\sqrt{q^{2} + k^{2} - 2 q k \\mu}\\,$, and the direct correlation function $\\,c(q)\\,$ defined by the Ornstein–Zernike relation in Fourier space,\n$$\nc(q) \\;=\\; \\frac{1 - 1/S(q)}{\\rho}.\n$$\nAll quantities are dimensionless after setting $\\,\\sigma = 1\\,$ and thermal energy $\\,k_{\\mathrm{B}} T = 1\\,$. The trivial solution $\\,f_{q} = 0\\,$ exists at all $\\,\\phi\\,$. The ideal glass transition occurs at a critical packing fraction $\\,\\phi_{c}\\,$ where a nontrivial solution $\\,f_{q} \\neq 0\\,$ first emerges.\n\nIn this problem, you will numerically determine the ideal glass transition packing fraction $\\,\\phi_{c}\\,$ by solving the above self-consistent equations for $\\,f_{q}\\,$ using a discretized $\\,q\\,$-grid, Gaussian quadrature for the angular integration, and a fixed-point iteration with mixing. To make the task fully specified and computationally tractable while remaining physically plausible, use the following analytic surrogate for the static structure factor of hard spheres, $\\,S(q;\\phi)\\,$, which captures the growth and sharpening of the principal peak with increasing $\\,\\phi\\,$ and the reduction of compressibility at small $\\,q\\,$:\n$$\nS(q;\\phi) \\;=\\; S_{0}(\\phi) \\;+\\; A(\\phi)\\,\\exp\\!\\left(-\\frac{(q - q_{0})^{2}}{2\\, w^{2}}\\right) \\;+\\; B(\\phi)\\, \\frac{\\sin(q)}{q}\\, \\exp\\!\\left(-\\left(\\frac{q}{q_{d}}\\right)^{2}\\right),\n$$\nwith\n$$\nS_{0}(\\phi) \\;=\\; \\frac{1}{1 + \\kappa \\phi}, \\qquad A(\\phi) \\;=\\; \\frac{a\\, \\phi}{1 - \\phi/\\phi_{\\star}}, \\qquad B(\\phi) \\;=\\; b\\, \\phi,\n$$\nand fixed constants\n$$\nq_{0} = 7.0,\\quad w = 0.65 \\times s_{w},\\quad \\kappa = 20,\\quad a = 0.8,\\quad \\phi_{\\star} = 0.59,\\quad b = 0.1,\\quad q_{d} = 10.\n$$\nHere $\\,s_{w}\\,$ is a tunable dimensionless width-scaling parameter provided per test case. For numerical robustness, enforce $\\,S(q;\\phi) \\ge S_{\\min}\\,$ with $\\,S_{\\min} = 0.05\\,$ at all $\\,q\\,$.\n\nYour program must:\n- Discretize the wavenumber domain using a uniform grid $\\,q_{i}\\in[q_{\\min}, q_{\\max}]\\,$ with $\\,N_{q}\\,$ points, where $\\,q_{\\min}  0\\,$ to avoid singularities in the prefactor $\\,1/q^{2}\\,$ of the memory kernel. Use $\\,q_{\\min} = 10^{-3}\\,$.\n- Evaluate the angular integral $\\,\\int_{-1}^{1} \\mathrm{d}\\mu\\,(\\cdots)\\,$ using $\\,N_{\\mu}\\,$-point Gauss–Legendre quadrature.\n- For a given $\\,\\phi\\,$, iterate the fixed-point map\n$$\nf_{q}^{\\mathrm{new}} \\;=\\; \\frac{m_{q}[f]}{1 + m_{q}[f]}\n$$\nwith linear mixing,\n$$\nf_{q} \\leftarrow (1 - \\gamma)\\, f_{q} \\;+\\; \\gamma\\, f_{q}^{\\mathrm{new}},\n$$\nstarting from a uniform small positive initialization $\\,f_{q}^{(0)} = \\varepsilon\\,$ with $\\,\\varepsilon = 10^{-6}\\,$. Use a mixing parameter $\\,\\gamma = 0.5\\,$. Declare convergence when $\\,\\max_{q} \\lvert f_{q}^{\\mathrm{new}} - f_{q}\\rvert  \\tau\\,$ with $\\,\\tau = 10^{-6}\\,$ or after $\\,N_{\\mathrm{iter},\\max} = 200\\,$ iterations. Classify the state as glass if $\\,\\overline{f} = \\frac{1}{N_{q}}\\sum_{i=1}^{N_{q}} f_{q_{i}}  f_{\\mathrm{th}}\\,$ with $\\,f_{\\mathrm{th}} = 10^{-3}\\,$, otherwise as fluid.\n- For each test case, determine $\\,\\phi_{c}\\,$ by bisection on $\\,\\phi\\,$ over a bracketing interval $\\, [\\phi_{\\mathrm{lo}}, \\phi_{\\mathrm{hi}}]\\,$ where the system is fluid at $\\,\\phi_{\\mathrm{lo}}\\,$ and glass at $\\,\\phi_{\\mathrm{hi}}\\,$. Perform $\\,N_{\\mathrm{bisect}} = 12\\,$ bisection steps and report the midpoint as the estimate of $\\,\\phi_{c}\\,$. The number density is $\\,\\rho = 6 \\phi / \\pi\\,$ in units of $\\,\\sigma = 1\\,$.\n\nImplementation requirements and numerical details:\n- Use linear interpolation for off-grid evaluations of $\\,f_{p}\\,$ and $\\,S(p)\\,$; for arguments $\\,p\\,$ outside the tabulated range, use $\\,S(p) = 1\\,$, $\\,c(p) = 0\\,$, and $\\,f(p) = 0\\,$.\n- Use the trapezoidal rule for the radial integral $\\,\\int_{0}^{\\infty} \\mathrm{d}k\\,$ truncated at $\\,q_{\\max}\\,$.\n- Ensure that $\\,0 \\le f_{q} \\le 1\\,$ at each iteration by clipping if needed.\n\nTest suite:\nProvide results for the following three test cases, each specified by the tuple $\\, (N_{q}, q_{\\max}, N_{\\mu}, \\phi_{\\mathrm{lo}}, \\phi_{\\mathrm{hi}}, s_{w})\\,$:\n- Case $\\,1\\,$: $\\, (36, 40.0, 12, 0.45, 0.585, 1.0)\\,$.\n- Case $\\,2\\,$: $\\, (28, 30.0, 8, 0.45, 0.585, 1.0)\\,$.\n- Case $\\,3\\,$: $\\, (36, 40.0, 12, 0.45, 0.585, 1.2)\\,$.\n\nAnswer specification:\n- For each case, output the estimated $\\,\\phi_{c}\\,$ as a dimensionless floating-point number rounded to three decimals.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, namely $\\,\\big[\\phi_{c}^{(1)}, \\phi_{c}^{(2)}, \\phi_{c}^{(3)}\\big]\\,$ with each entry rounded to three decimals (for example, $\\, [0.534,0.529,0.558]\\,$).", "solution": "The problem statement is scientifically sound, internally consistent, and provides an unambiguous specification for a numerical procedure. It is therefore deemed valid. The task is to determine the critical packing fraction $\\phi_{c}$ for the ideal glass transition as predicted by Mode-Coupling Theory (MCT) for a model colloidal system of hard spheres.\n\nThe overall strategy to locate $\\phi_{c}$ is a bisection search over the packing fraction $\\phi$. The problem provides a bracketing interval $[\\phi_{\\mathrm{lo}}, \\phi_{\\mathrm{hi}}]$ for each test case, where the colloidal system is known to be in a fluid state at $\\phi_{\\mathrm{lo}}$ and a glass state at $\\phi_{\\mathrm{hi}}$. The bisection method iteratively halves this interval $N_{\\mathrm{bisect}}$ times. At each step, the state of the system is determined at the midpoint $\\phi_{\\mathrm{mid}} = (\\phi_{\\mathrm{lo}} + \\phi_{\\mathrm{hi}})/2$. If the system at $\\phi_{\\mathrm{mid}}$ is a glass, the upper bound of the search interval is updated, $\\phi_{\\mathrm{hi}} \\leftarrow \\phi_{\\mathrm{mid}}$; if it is a fluid, the lower bound is updated, $\\phi_{\\mathrm{lo}} \\leftarrow \\phi_{\\mathrm{mid}}$. The final estimate for $\\phi_{c}$ is the midpoint of the resulting narrow interval.\n\nThe core of the algorithm is a function that determines whether the system at a given $\\phi$ is a fluid or a glass. This is achieved by numerically solving the self-consistent MCT equation for the nonergodicity parameter $f_{q}$:\n$$\n\\frac{f_{q}}{1 - f_{q}} \\;=\\; m_{q}[f]\n$$\nThis equation can be rearranged into a fixed-point iteration form:\n$$\nf_{q}^{\\mathrm{new}} \\;=\\; \\frac{m_{q}[f]}{1 + m_{q}[f]}\n$$\nStarting from a small initial guess $f_{q}^{(0)} = \\varepsilon$ (representing a fluid state with thermal fluctuations), this mapping is iterated until convergence. To stabilize the iteration, which can be numerically sensitive near the transition, a linear mixing scheme is employed:\n$$\nf_{q} \\leftarrow (1 - \\gamma)\\, f_{q} \\;+\\; \\gamma\\, f_{q}^{\\mathrm{new}}\n$$\nwhere $\\gamma$ is the mixing parameter. An iteration is considered converged if the maximum absolute change in $f_{q}$ across the entire wavenumber grid falls below a tolerance $\\tau$, i.e., $\\max_{q} \\lvert f_{q}^{\\mathrm{new}} - f_{q}\\rvert  \\tau$. If the iteration converges to a state where the average nonergodicity parameter $\\overline{f} = \\frac{1}{N_{q}}\\sum_{i=1}^{N_{q}} f_{q_{i}}$ is significantly different from zero (specifically, $\\overline{f}  f_{\\mathrm{th}}$), the state is classified as a glass. Otherwise, it is classified as a fluid, which corresponds to the trivial solution $f_{q} = 0$.\n\nThe most computationally intensive part is the evaluation of the memory kernel, $m_{q}$. The provided formula for an isotropic fluid is:\n$$\nm_{q} \\;=\\; \\frac{\\rho\\, S(q)}{8 \\pi^{2} q^{2}} \\int_{0}^{\\infty} \\mathrm{d}k \\; k^{2} \\int_{-1}^{1} \\mathrm{d}\\mu \\; S(k)\\, S(p)\\; \\left[k\\,\\mu\\, c(k) + \\big(q - k \\mu\\big)\\, c(p)\\right]^{2} \\; f_{k} \\, f_{p}\n$$\nwith $p = \\sqrt{q^{2} + k^{2} - 2 q k \\mu}$. For a numerical solution, all functions are discretized on a uniform wavenumber grid $q_{i}\\in[q_{\\min}, q_{\\max}]$ with $N_{q}$ points. The double integral in $m_{q}$ is computed as follows:\n$1$. **Angular Integration ($\\mu$):** The integral over $\\mu$ from $-1$ to $1$ is evaluated using $N_{\\mu}$-point Gauss-Legendre quadrature, which replaces the integral with a weighted sum: $\\int_{-1}^{1} g(\\mu) \\mathrm{d}\\mu \\approx \\sum_{l=1}^{N_{\\mu}} w_{l} g(\\mu_{l})$, where $\\mu_{l}$ and $w_{l}$ are the quadrature nodes and weights, respectively.\n$2$. **Radial Integration ($k$):** The integral over $k$ from $0$ to $\\infty$ is approximated by applying the trapezoidal rule over the discretized grid, from $q_{\\min}$ to $q_{\\max}$. This transforms the integral into a weighted sum over the grid points $k_{j} = q_{j}$.\n\nFor each external wavevector $q_{i}$ on the grid, and for each pair of integration variables $(k_{j}, \\mu_{l})$, the wavevector $p$ must be calculated. As $p$ will generally not fall on a grid point, the values $S(p)$, $c(p)$, and $f_{p}$ are obtained via linear interpolation from their tabulated values on the $q$-grid. The problem specifies boundary conditions for this interpolation: for $p$ outside the grid range $[q_{\\min}, q_{\\max}]$, we use $S(p) = 1$, $c(p) = 0$, and $f_{p} = 0$. These correspond to the non-interacting limit of an ideal gas.\n\nThe static structure factor $S(q)$ and direct correlation function $c(q)$ are first calculated for the given $\\phi$ using the provided analytic surrogate model and the Ornstein-Zernike relation, $c(q) = (\\rho)^{-1} (1 - 1/S(q))$. The entire procedure is encapsulated in a Python program that executes the bisection search for each test case and reports the final estimated $\\phi_{c}$, rounded as specified.", "answer": "[0.534,0.529,0.558]", "id": "2909294"}]}