{"hands_on_practices": [{"introduction": "To understand phase separation, we must analyze the shape of the free energy curve, as it governs the thermodynamic stability of a mixture. This exercise is a foundational practice in deriving the mathematical tools for this analysis directly from the Flory-Huggins free energy expression. By working through the calculus, you will uncover the physical significance of the free energy's derivatives and establish the spinodal condition, $f''(\\phi)=0$, which marks the limit of local stability, and the critical point conditions, $f''(\\phi)=f'''(\\phi)=0$, where phase separation begins. [@problem_id:2930606]", "problem": "Consider a binary mixture on a lattice described by the Flory–Huggins free energy of mixing per lattice site, scaled by the thermal energy $k_{B}T$ (Boltzmann constant times absolute temperature), \n$$\n\\frac{f(\\phi)}{k_{B}T} \\;=\\; \\frac{\\phi}{N_{2}} \\ln \\phi \\;+\\; \\frac{1-\\phi}{N_{1}} \\ln(1-\\phi) \\;+\\; \\chi\\,\\phi(1-\\phi),\n$$\nwhere $0\\phi1$ is the volume fraction of component $2$, $N_{1}$ and $N_{2}$ are the degrees of polymerization (segment numbers) of components $1$ and $2$, respectively, and $\\chi$ is the Flory–Huggins interaction parameter. Starting from this definition and fundamental thermodynamic principles for mixtures, do the following:\n\n1. Compute the first and second derivatives $f'(\\phi)$ and $f''(\\phi)$ explicitly with respect to $\\phi$.\n2. Based on the connections between free energy derivatives and chemical potentials in binary mixtures, interpret the physical meaning of $f'(\\phi)$ and $f''(\\phi)$ in the context of phase equilibrium and stability.\n3. Using the curvature criterion for stability, write down the spinodal condition in terms of $f''(\\phi)$ and derive the implicit spinodal relation between $\\phi$ and $\\chi$.\n4. Identify the critical point by applying the appropriate conditions on the derivatives of $f(\\phi)$, and obtain the critical composition $\\phi_{c}$ and the critical interaction parameter $\\chi_{c}$ in terms of $N_{1}$ and $N_{2}$.\n\nProvide your final answer as a single closed-form analytic expression for $\\chi_{c}$ as a function of $N_{1}$ and $N_{2}$. No numerical evaluation is required, and no units should be included in the final answer.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- The scaled Flory–Huggins free energy of mixing per lattice site is given by:\n$$\n\\frac{f(\\phi)}{k_{B}T} \\;=\\; \\frac{\\phi}{N_{2}} \\ln \\phi \\;+\\; \\frac{1-\\phi}{N_{1}} \\ln(1-\\phi) \\;+\\; \\chi\\,\\phi(1-\\phi)\n$$\n- $\\phi$: volume fraction of component $2$, with $0\\phi1$.\n- $N_{1}$, $N_{2}$: degrees of polymerization of components $1$ and $2$.\n- $\\chi$: the Flory–Huggins interaction parameter.\n- $k_{B}T$: the thermal energy, product of Boltzmann's constant and absolute temperature.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded:** The problem is based on the Flory–Huggins theory, a canonical model in polymer physics. The expression for the free energy of mixing is standard.\n- **Well-Posed:** The problem provides a clear function and asks for standard thermodynamic quantities and conditions derived from it (derivatives, stability conditions, critical point). The procedure is well-defined and leads to a unique solution.\n- **Objective:** The problem is stated using precise mathematical language and established physical concepts. It is free of subjective or ambiguous terminology.\n- **Completeness and Consistency:** The problem is self-contained. All necessary information to perform the derivations is provided.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. It is a standard and rigorous exercise in the thermodynamics of polymer mixtures. The solution will now be developed.\n\nTo simplify the notation, we define a dimensionless free energy density, $g(\\phi)$, as\n$$\ng(\\phi) = \\frac{f(\\phi)}{k_{B}T} = \\frac{\\phi}{N_{2}} \\ln \\phi + \\frac{1-\\phi}{N_{1}} \\ln(1-\\phi) + \\chi\\phi(1-\\phi).\n$$\nWe will compute derivatives of $g(\\phi)$ and then relate them back to the derivatives of $f(\\phi)$.\n\n**1. Computation of Derivatives**\n\nThe first derivative of $g(\\phi)$ with respect to $\\phi$ is found by applying standard rules of differentiation:\n$$\ng'(\\phi) = \\frac{d g}{d \\phi} = \\frac{d}{d\\phi} \\left[ \\frac{\\phi}{N_{2}} \\ln \\phi \\right] + \\frac{d}{d\\phi} \\left[ \\frac{1-\\phi}{N_{1}} \\ln(1-\\phi) \\right] + \\frac{d}{d\\phi} \\left[ \\chi(\\phi - \\phi^{2}) \\right]\n$$\n$$\ng'(\\phi) = \\left( \\frac{1}{N_{2}} \\ln \\phi + \\frac{\\phi}{N_{2}} \\frac{1}{\\phi} \\right) + \\left( -\\frac{1}{N_{1}} \\ln(1-\\phi) + \\frac{1-\\phi}{N_{1}} \\frac{-1}{1-\\phi} \\right) + \\chi(1 - 2\\phi)\n$$\n$$\ng'(\\phi) = \\frac{\\ln \\phi}{N_{2}} - \\frac{\\ln(1-\\phi)}{N_{1}} + \\frac{1}{N_{2}} - \\frac{1}{N_{1}} + \\chi(1 - 2\\phi)\n$$\nThe second derivative, $g''(\\phi)$, is obtained by differentiating $g'(\\phi)$:\n$$\ng''(\\phi) = \\frac{d^{2} g}{d \\phi^{2}} = \\frac{d}{d\\phi} \\left[ \\frac{\\ln \\phi}{N_{2}} \\right] - \\frac{d}{d\\phi} \\left[ \\frac{\\ln(1-\\phi)}{N_{1}} \\right] + \\frac{d}{d\\phi} \\left[ \\frac{1}{N_{2}} - \\frac{1}{N_{1}} \\right] + \\frac{d}{d\\phi} \\left[ \\chi(1 - 2\\phi) \\right]\n$$\n$$\ng''(\\phi) = \\frac{1}{N_{2}\\phi} - \\left( \\frac{1}{N_{1}} \\frac{-1}{1-\\phi} \\right) + 0 - 2\\chi\n$$\n$$\ng''(\\phi) = \\frac{1}{N_{2}\\phi} + \\frac{1}{N_{1}(1-\\phi)} - 2\\chi\n$$\nThe derivatives of $f(\\phi)$ are simply these expressions multiplied by $k_{B}T$:\n$$\nf'(\\phi) = k_{B}T \\left[ \\frac{\\ln \\phi}{N_{2}} - \\frac{\\ln(1-\\phi)}{N_{1}} + \\frac{1}{N_{2}} - \\frac{1}{N_{1}} + \\chi(1 - 2\\phi) \\right]\n$$\n$$\nf''(\\phi) = k_{B}T \\left[ \\frac{1}{N_{2}\\phi} + \\frac{1}{N_{1}(1-\\phi)} - 2\\chi \\right]\n$$\n\n**2. Physical Interpretation of Derivatives**\n\nIn the thermodynamics of binary mixtures, the first derivative of the free energy density with respect to composition is related to the difference in chemical potentials. Specifically, $f'(\\phi)$ is proportional to the exchange chemical potential, $\\Delta\\mu = \\mu_{2}/N_{2} - \\mu_{1}/N_{1}$, which is the chemical potential difference per segment. This quantity represents the thermodynamic force driving interdiffusion of components. At phase equilibrium between two phases $\\alpha$ and $\\beta$ with compositions $\\phi^{\\alpha}$ and $\\phi^{\\beta}$, the chemical potentials of each component must be equal in both phases, which implies $f'(\\phi^{\\alpha}) = f'(\\phi^{\\beta})$.\n\nThe second derivative, $f''(\\phi)$, determines the local thermodynamic stability of the mixture. For a homogeneous mixture to be stable against infinitesimal composition fluctuations, the free energy curve must be convex, meaning $f''(\\phi) > 0$. If $f''(\\phi)  0$, the mixture is unstable and will spontaneously separate via spinodal decomposition. The condition $f''(\\phi) = 0$ defines the limit of this local stability.\n\n**3. Spinodal Condition and Relation**\n\nThe spinodal curve separates the metastable and unstable regions of the phase diagram. It is defined by the locus of points where the second derivative of the free energy with respect to composition is zero. This is the curvature criterion for the onset of instability.\nThe spinodal condition is therefore:\n$$\nf''(\\phi) = 0\n$$\nUsing our expression for $f''(\\phi)$ (and noting that $k_{B}T \\neq 0$), this becomes:\n$$\n\\frac{1}{N_{2}\\phi} + \\frac{1}{N_{1}(1-\\phi)} - 2\\chi = 0\n$$\nThis equation is the implicit spinodal relation between $\\phi$ and $\\chi$. We can express the spinodal interaction parameter, $\\chi_{sp}$, as an explicit function of composition $\\phi$:\n$$\n\\chi_{sp}(\\phi) = \\frac{1}{2} \\left[ \\frac{1}{N_{2}\\phi} + \\frac{1}{N_{1}(1-\\phi)} \\right]\n$$\n\n**4. The Critical Point**\n\nThe critical point is a unique point on the phase boundary where the distinction between two coexisting phases vanishes. It lies on the spinodal curve and is identified as the point where the stability condition is first violated. Mathematically, it is an inflection point of the free energy curve where both the second and third derivatives are zero.\nThe conditions for the critical point ($\\phi_{c}$, $\\chi_{c}$) are:\n1. $f''(\\phi_{c}) = 0$\n2. $f'''(\\phi_{c}) = 0$\n\nFirst, we find the third derivative, $f'''(\\phi)$, by differentiating $g''(\\phi)$ and multiplying by $k_{B}T$:\n$$\ng'''(\\phi) = \\frac{d}{d\\phi} \\left( \\frac{1}{N_{2}\\phi} \\right) + \\frac{d}{d\\phi} \\left( \\frac{1}{N_{1}(1-\\phi)} \\right) - \\frac{d}{d\\phi} \\left( 2\\chi \\right)\n$$\n$$\ng'''(\\phi) = -\\frac{1}{N_{2}\\phi^{2}} + \\frac{1}{N_{1}(1-\\phi)^{2}}\n$$\nSo, $f'''(\\phi) = k_{B}T \\left[ -\\frac{1}{N_{2}\\phi^{2}} + \\frac{1}{N_{1}(1-\\phi)^{2}} \\right]$.\n\nApplying the second condition, $f'''(\\phi_{c}) = 0$:\n$$\n-\\frac{1}{N_{2}\\phi_{c}^{2}} + \\frac{1}{N_{1}(1-\\phi_{c})^{2}} = 0\n$$\n$$\n\\frac{1}{N_{1}(1-\\phi_{c})^{2}} = \\frac{1}{N_{2}\\phi_{c}^{2}}\n$$\n$$\nN_{2}\\phi_{c}^{2} = N_{1}(1-\\phi_{c})^{2}\n$$\nTaking the square root of both sides (and considering only the physically meaningful positive root since $\\phi_{c} > 0$ and $1-\\phi_{c} > 0$), we get:\n$$\n\\sqrt{N_{2}}\\phi_{c} = \\sqrt{N_{1}}(1-\\phi_{c})\n$$\n$$\n\\sqrt{N_{2}}\\phi_{c} = \\sqrt{N_{1}} - \\sqrt{N_{1}}\\phi_{c}\n$$\n$$\n(\\sqrt{N_{1}} + \\sqrt{N_{2}})\\phi_{c} = \\sqrt{N_{1}}\n$$\nThis gives the critical composition:\n$$\n\\phi_{c} = \\frac{\\sqrt{N_{1}}}{\\sqrt{N_{1}} + \\sqrt{N_{2}}}\n$$\nNow, we find $\\chi_{c}$ by substituting $\\phi_{c}$ into the spinodal relation (the first condition, $f''(\\phi_{c})=0$):\n$$\n\\chi_{c} = \\chi_{sp}(\\phi_{c}) = \\frac{1}{2} \\left[ \\frac{1}{N_{2}\\phi_{c}} + \\frac{1}{N_{1}(1-\\phi_{c})} \\right]\n$$\nFrom the expression for $\\phi_{c}$, we have:\n$$\n\\frac{1}{\\phi_{c}} = \\frac{\\sqrt{N_{1}} + \\sqrt{N_{2}}}{\\sqrt{N_{1}}}\n$$\nAnd for $1-\\phi_{c}$:\n$$\n1-\\phi_{c} = 1 - \\frac{\\sqrt{N_{1}}}{\\sqrt{N_{1}} + \\sqrt{N_{2}}} = \\frac{\\sqrt{N_{1}} + \\sqrt{N_{2}} - \\sqrt{N_{1}}}{\\sqrt{N_{1}} + \\sqrt{N_{2}}} = \\frac{\\sqrt{N_{2}}}{\\sqrt{N_{1}} + \\sqrt{N_{2}}}\n$$\nSo, $\\frac{1}{1-\\phi_{c}} = \\frac{\\sqrt{N_{1}} + \\sqrt{N_{2}}}{\\sqrt{N_{2}}}$.\nSubstituting these into the expression for $\\chi_{c}$:\n$$\n\\chi_{c} = \\frac{1}{2} \\left[ \\frac{1}{N_{2}}\\left(\\frac{\\sqrt{N_{1}} + \\sqrt{N_{2}}}{\\sqrt{N_{1}}}\\right) + \\frac{1}{N_{1}}\\left(\\frac{\\sqrt{N_{1}} + \\sqrt{N_{2}}}{\\sqrt{N_{2}}}\\right) \\right]\n$$\nFactor out the common term $(\\sqrt{N_{1}} + \\sqrt{N_{2}})$:\n$$\n\\chi_{c} = \\frac{\\sqrt{N_{1}} + \\sqrt{N_{2}}}{2} \\left[ \\frac{1}{N_{2}\\sqrt{N_{1}}} + \\frac{1}{N_{1}\\sqrt{N_{2}}} \\right]\n$$\nA more direct simplification is:\n$$\n\\chi_{c} = \\frac{1}{2} \\left[ \\frac{1}{N_{2}} \\left(\\frac{\\sqrt{N_1}+\\sqrt{N_2}}{\\sqrt{N_1}}\\right) + \\frac{1}{N_{1}} \\left(\\frac{\\sqrt{N_1}+\\sqrt{N_2}}{\\sqrt{N_2}}\\right) \\right]\n$$\n$$\n\\chi_{c} = \\frac{1}{2} \\left[ \\frac{\\sqrt{N_1}+\\sqrt{N_2}}{N_2\\sqrt{N_1}} + \\frac{\\sqrt{N_1}+\\sqrt{N_2}}{N_1\\sqrt{N_2}} \\right] = \\frac{1}{2} \\left[ \\frac{1}{\\sqrt{N_1 N_2}} + \\frac{1}{N_2} + \\frac{1}{N_1} + \\frac{1}{\\sqrt{N_1 N_2}} \\right]\n$$\n$$\n\\chi_{c} = \\frac{1}{2} \\left[ \\frac{1}{N_{1}} + \\frac{2}{\\sqrt{N_{1}N_{2}}} + \\frac{1}{N_{2}} \\right]\n$$\nThis expression is a perfect square:\n$$\n\\chi_{c} = \\frac{1}{2} \\left[ \\left(\\frac{1}{\\sqrt{N_{1}}}\\right)^{2} + 2\\left(\\frac{1}{\\sqrt{N_{1}}}\\right)\\left(\\frac{1}{\\sqrt{N_{2}}}\\right) + \\left(\\frac{1}{\\sqrt{N_{2}}}\\right)^{2} \\right]\n$$\nThus, the final expression for the critical interaction parameter is:\n$$\n\\chi_{c} = \\frac{1}{2} \\left( \\frac{1}{\\sqrt{N_{1}}} + \\frac{1}{\\sqrt{N_{2}}} \\right)^{2}\n$$\nThis completes the derivation.", "answer": "$$\n\\boxed{\\frac{1}{2} \\left( \\frac{1}{\\sqrt{N_{1}}} + \\frac{1}{\\sqrt{N_{2}}} \\right)^{2}}\n$$", "id": "2930606"}, {"introduction": "After deriving the general criteria for stability, the next step is to apply them to a concrete physical system. The critical interaction parameter, $\\chi_{c}$, serves as a crucial threshold: a mixture is stable and fully miscible if its interaction parameter $\\chi$ is below this value. This practice allows you to calculate $\\chi_{c}$ for a specific polymer-solvent system and use it to predict whether the mixture will be stable or will phase separate, bridging the gap between abstract theory and practical material behavior. [@problem_id:2930608]", "problem": "A binary mixture of a small-molecule solvent (component 1) and a polymer (component 2) is modeled by the Flory–Huggins free energy of mixing per lattice site in units of $k_{B}T$, given by\n$$\nf(\\phi) \\;=\\; \\frac{\\phi}{N_{1}} \\ln \\phi \\;+\\; \\frac{1-\\phi}{N_{2}} \\ln(1-\\phi) \\;+\\; \\chi\\,\\phi\\,(1-\\phi),\n$$\nwhere $\\phi \\in (0,1)$ is the volume fraction of component $1$, $N_{1}$ and $N_{2}$ are the degrees of polymerization of components $1$ and $2$, respectively, and $\\chi$ is the Flory–Huggins interaction parameter. The spinodal is defined by the loss of convexity of $f(\\phi)$, i.e., by the curvature criterion $f''(\\phi)=0$, while the binodal is defined by the common-tangent construction on $f(\\phi)$ (equal chemical potentials and osmotic pressures in coexisting phases).\n\nFor a mixture with $N_{1}=1$ and $N_{2}=500$ at $\\chi=0.4$:\n\n1. Starting from the given $f(\\phi)$ only, derive the curvature $f''(\\phi)$ and solve the spinodal condition $f''(\\phi)=0$ for $\\phi \\in (0,1)$. Determine whether spinodal compositions exist at this $\\chi$.\n2. Using the common-tangent criterion as the definition of the binodal, assess whether binodal compositions exist at $\\chi=0.4$ for this system.\n3. From first principles applied to the curvature, determine the critical interaction parameter $\\chi_{c}$ (the smallest $\\chi$ at which any spinodal compositions exist for some $\\phi \\in (0,1)$) for $N_{1}=1$, $N_{2}=500$.\n\nReport $\\chi_{c}$ as your final answer, rounded to four significant figures. $\\chi_{c}$ is dimensionless; report it without units.", "solution": "The problem requires a thorough analysis of the phase behavior of a binary polymer-solvent mixture using the Flory-Huggins model. We will proceed by addressing each of the three tasks in sequence, after validating the problem statement.\n\nThe problem is scientifically grounded, well-posed, and objective. It is based on the standard Flory-Huggins theory, a cornerstone of polymer physics. All necessary parameters and definitions are provided, and the questions are mathematically precise and answerable from the given information. The problem is therefore deemed **valid**, and we may proceed with the solution.\n\nThe free energy of mixing per lattice site is given by\n$$\nf(\\phi) = \\frac{\\phi}{N_{1}} \\ln \\phi + \\frac{1-\\phi}{N_{2}} \\ln(1-\\phi) + \\chi\\,\\phi\\,(1-\\phi)\n$$\nwhere $\\phi$ is the volume fraction of the solvent (component $1$), $N_{1}$ is its degree of polymerization, $N_{2}$ is the degree of polymerization of the polymer (component $2$), and $\\chi$ is the interaction parameter. We are given $N_{1}=1$, $N_{2}=500$, and for the first two parts, $\\chi=0.4$.\n\n**1. Analysis of Spinodal Compositions at $\\chi=0.4$**\n\nThe spinodal curve is defined by the condition $f''(\\phi)=0$, where $f''(\\phi)$ is the second derivative of the free energy with respect to composition, also known as the curvature. First, we compute the first and second derivatives of $f(\\phi)$.\n\nThe first derivative, $f'(\\phi)$, is:\n$$\nf'(\\phi) = \\frac{d}{d\\phi} \\left( \\frac{\\phi}{N_{1}} \\ln \\phi + \\frac{1-\\phi}{N_{2}} \\ln(1-\\phi) + \\chi\\phi - \\chi\\phi^2 \\right)\n$$\n$$\nf'(\\phi) = \\left(\\frac{1}{N_{1}}\\ln\\phi + \\frac{\\phi}{N_{1}\\phi}\\right) + \\left(\\frac{-1}{N_{2}}\\ln(1-\\phi) + \\frac{1-\\phi}{N_{2}}\\frac{-1}{1-\\phi}\\right) + \\chi(1-2\\phi)\n$$\n$$\nf'(\\phi) = \\frac{1}{N_{1}}(\\ln\\phi + 1) - \\frac{1}{N_{2}}(\\ln(1-\\phi) + 1) + \\chi(1-2\\phi)\n$$\nThe second derivative, $f''(\\phi)$, is the curvature:\n$$\nf''(\\phi) = \\frac{d}{d\\phi} f'(\\phi) = \\frac{d}{d\\phi} \\left( \\frac{1}{N_{1}}\\ln\\phi - \\frac{1}{N_{2}}\\ln(1-\\phi) + \\frac{1}{N_{1}} - \\frac{1}{N_{2}} + \\chi - 2\\chi\\phi \\right)\n$$\n$$\nf''(\\phi) = \\frac{1}{N_{1}\\phi} - \\frac{1}{N_{2}}\\frac{-1}{1-\\phi} - 2\\chi\n$$\n$$\nf''(\\phi) = \\frac{1}{N_{1}\\phi} + \\frac{1}{N_{2}(1-\\phi)} - 2\\chi\n$$\nThe spinodal condition is $f''(\\phi)=0$. We substitute the given values $N_{1}=1$, $N_{2}=500$, and $\\chi=0.4$:\n$$\n\\frac{1}{1 \\cdot \\phi} + \\frac{1}{500(1-\\phi)} - 2(0.4) = 0\n$$\n$$\n\\frac{1}{\\phi} + \\frac{1}{500(1-\\phi)} = 0.8\n$$\nTo solve for $\\phi$, we clear the denominators by multiplying by $500\\phi(1-\\phi)$, assuming $\\phi \\in (0,1)$:\n$$\n500(1-\\phi) + \\phi = 0.8 \\cdot 500\\phi(1-\\phi)\n$$\n$$\n500 - 499\\phi = 400\\phi(1-\\phi) = 400\\phi - 400\\phi^2\n$$\nRearranging this into a standard quadratic form $a\\phi^2+b\\phi+c=0$:\n$$\n400\\phi^2 - (400+499)\\phi + 500 = 0\n$$\n$$\n400\\phi^2 - 899\\phi + 500 = 0\n$$\nThe solutions for $\\phi$ are given by the quadratic formula, $\\phi = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$. First, we compute the discriminant, $\\Delta = b^2-4ac$:\n$$\n\\Delta = (-899)^2 - 4(400)(500) = 808201 - 800000 = 8201\n$$\nSince $\\Delta > 0$, there are two real roots. However, we must check if these roots lie within the physical domain $\\phi \\in (0,1)$.\n$$\n\\phi = \\frac{899 \\pm \\sqrt{8201}}{2(400)} = \\frac{899 \\pm \\sqrt{8201}}{800}\n$$\nUsing the approximation $\\sqrt{8201} \\approx 90.56$:\n$$\n\\phi_1 = \\frac{899 - 90.56}{800} = \\frac{808.44}{800} \\approx 1.01\n$$\n$$\n\\phi_2 = \\frac{899 + 90.56}{800} = \\frac{989.56}{800} \\approx 1.24\n$$\nBoth roots are greater than $1$ and fall outside the physically valid range of $\\phi \\in (0,1)$. This implies that for $\\chi = 0.4$, the curvature $f''(\\phi)$ is never zero for any physical composition. Since $f''(\\phi)$ is a continuous function on $(0,1)$ and positive as $\\phi \\to 0^{+}$ and $\\phi \\to 1^{-}$, it must be positive for all $\\phi \\in (0,1)$. Thus, the free energy function $f(\\phi)$ is strictly convex.\nTherefore, at $\\chi=0.4$, no spinodal compositions exist for this system.\n\n**2. Analysis of Binodal Compositions at $\\chi=0.4$**\n\nThe binodal curve marks the compositions of phases in equilibrium, determined by the common-tangent construction. Phase separation, giving rise to binodal compositions, can only occur if the free energy curve $f(\\phi)$ has a region of negative curvature ($f''(\\phi)0$), which allows for a straight line (the common tangent) to connect two points on the curve while lying below the curve between those points.\nAs established in Part 1, for $\\chi=0.4$, the curvature $f''(\\phi)$ is strictly positive for all $\\phi \\in (0,1)$. This means the free energy function $f(\\phi)$ is everywhere convex. A strictly convex function does not permit a common-tangent line to lie below the function itself. The entire system is thermodynamically stable as a single homogeneous phase for all compositions.\nConsequently, at $\\chi=0.4$, no binodal compositions exist. The system is completely miscible.\n\n**3. Determination of the Critical Interaction Parameter $\\chi_{c}$**\n\nThe critical point is the threshold for phase separation. It is defined as the point $(\\phi_c, \\chi_c)$ where a region of negative curvature first appears. At this specific point, the binodal and spinodal curves touch. Mathematically, it is defined by the simultaneous satisfaction of two conditions:\n$$\nf''(\\phi_c) = 0 \\quad \\text{and} \\quad f'''(\\phi_c) = 0\n$$\nFirst, we find the third derivative, $f'''(\\phi)$:\n$$\nf'''(\\phi) = \\frac{d}{d\\phi}f''(\\phi) = \\frac{d}{d\\phi}\\left(\\frac{1}{N_{1}\\phi} + \\frac{1}{N_{2}(1-\\phi)} - 2\\chi\\right)\n$$\n$$\nf'''(\\phi) = -\\frac{1}{N_{1}\\phi^2} + \\frac{1}{N_{2}(1-\\phi)^2}\n$$\nWe solve $f'''(\\phi_c)=0$ to find the critical composition $\\phi_c$:\n$$\n-\\frac{1}{N_{1}\\phi_c^2} + \\frac{1}{N_{2}(1-\\phi_c)^2} = 0 \\quad \\implies \\quad N_{2}(1-\\phi_c)^2 = N_{1}\\phi_c^2\n$$\nTaking the square root of both sides (and considering only positive physical values for $\\phi_c$ and $1-\\phi_c$):\n$$\n\\sqrt{N_{2}}(1-\\phi_c) = \\sqrt{N_{1}}\\phi_c\n$$\n$$\n\\sqrt{N_{2}} = \\phi_c(\\sqrt{N_{1}} + \\sqrt{N_{2}})\n$$\nThis gives the general expression for the critical composition:\n$$\n\\phi_c = \\frac{\\sqrt{N_{2}}}{\\sqrt{N_{1}} + \\sqrt{N_{2}}}\n$$\nNext, we use the spinodal condition $f''(\\phi_c)=0$ to find the critical interaction parameter $\\chi_c$:\n$$\n2\\chi_c = \\frac{1}{N_{1}\\phi_c} + \\frac{1}{N_{2}(1-\\phi_c)}\n$$\nFrom the expression for $\\phi_c$ and the corresponding expression for $1-\\phi_c = \\frac{\\sqrt{N_{1}}}{\\sqrt{N_{1}} + \\sqrt{N_{2}}}$:\n$$\n2\\chi_c = \\frac{1}{N_{1}} \\left( \\frac{\\sqrt{N_{1}} + \\sqrt{N_{2}}}{\\sqrt{N_{2}}} \\right) + \\frac{1}{N_{2}} \\left( \\frac{\\sqrt{N_{1}} + \\sqrt{N_{2}}}{\\sqrt{N_{1}}} \\right)\n$$\nThis can be simplified to the well-known form:\n$$\n\\chi_c = \\frac{1}{2}\\left(\\frac{1}{\\sqrt{N_1}} + \\frac{1}{\\sqrt{N_2}}\\right)^2\n$$\nAlternatively, the expression for the critical interaction parameter is:\n$$\n\\chi_c = \\frac{(\\sqrt{N_1} + \\sqrt{N_2})^2}{2 N_1 N_2}\n$$\nNow, we substitute the specified values $N_1=1$ and $N_2=500$:\n$$\n\\chi_c = \\frac{(\\sqrt{1} + \\sqrt{500})^2}{2(1)(500)} = \\frac{(1 + \\sqrt{500})^2}{1000}\n$$\nSince $\\sqrt{500} = \\sqrt{100 \\times 5} = 10\\sqrt{5}$, we have:\n$$\n\\chi_c = \\frac{(1 + 10\\sqrt{5})^2}{1000} = \\frac{1^2 + 2(1)(10\\sqrt{5}) + (10\\sqrt{5})^2}{1000}\n$$\n$$\n\\chi_c = \\frac{1 + 20\\sqrt{5} + 100(5)}{1000} = \\frac{501 + 20\\sqrt{5}}{1000}\n$$\nTo obtain the numerical value, we use $\\sqrt{5} \\approx 2.236068$:\n$$\n\\chi_c = \\frac{501 + 20(2.236068)}{1000} = \\frac{501 + 44.72136}{1000} = \\frac{545.72136}{1000} = 0.54572136\n$$\nRounding to four significant figures as required, we get $\\chi_c = 0.5457$. This value is greater than the $\\chi=0.4$ used in the first two parts, which is consistent with our finding that the system was fully miscible under those conditions.", "answer": "$$\\boxed{0.5457}$$", "id": "2930608"}, {"introduction": "While analyzing stability at a single point is useful, a complete understanding requires mapping the entire phase boundary. The spinodal condition provides a direct relationship between composition $\\phi$ and the interaction parameter $\\chi$, which is often temperature-dependent. This advanced hands-on exercise guides you in translating this physical theory into a computational algorithm to numerically trace the spinodal curve, a vital skill in modern polymer science for visualizing the complete phase diagram. [@problem_id:2930568]", "problem": "Consider an incompressible binary mixture modeled by the Flory–Huggins free energy per lattice site (in units of Boltzmann constant times temperature, $k_{\\mathrm{B}}T$) as a function of the volume fraction $\\phi$ of component $1$:\n$$\nf(\\phi;T) \\equiv \\frac{\\phi}{N_1}\\ln \\phi + \\frac{1-\\phi}{N_2}\\ln(1-\\phi) + \\chi(T)\\,\\phi\\,(1-\\phi),\n$$\nwhere $N_1$ and $N_2$ are the degrees of polymerization of components $1$ and $2$, respectively, and $\\chi(T)$ is the Flory–Huggins interaction parameter. The spinodal curve is defined as the locus of points in composition–temperature space where the homogeneous free energy loses convexity, i.e., the curvature with respect to $\\phi$ vanishes. Mathematically, the spinodal compositions $\\phi_{\\mathrm{sp}}(T)$ at a given temperature $T$ are the solutions in the open interval $(0,1)$ of the equation\n$$\n\\frac{\\partial^2 f(\\phi;T)}{\\partial \\phi^2} = 0.\n$$\nYou are to work in the specific, scientifically realistic case with parameter values $N_1=1$, $N_2=1000$, and a temperature-dependent interaction parameter\n$$\n\\chi(T) = 0.4 + \\frac{50}{T},\n$$\nwith temperature $T$ expressed in kelvin (K). The volume fraction $\\phi$ is dimensionless. Your task is to build a principled numerical algorithm that, starting only from the given free energy definition and the curvature-based definition of the spinodal, computes all spinodal compositions $\\phi_{\\mathrm{sp}}(T)$ for each prescribed temperature in a test suite.\n\nFundamental base to use:\n- The definition of the Flory–Huggins free energy $f(\\phi;T)$ for an incompressible binary mixture as given above.\n- The definition of the spinodal as the set of $(\\phi,T)$ such that $\\partial^2 f/\\partial \\phi^2=0$ with $\\phi \\in (0,1)$.\n- Standard calculus for computing derivatives and for characterizing minima via higher derivatives.\n\nDesign requirements:\n- Derive the explicit curvature condition in terms of $\\phi$, $N_1$, $N_2$, and $\\chi(T)$ starting from the given free energy definition, and use it to formulate a robust root-finding problem for $\\phi \\in (0,1)$ at fixed $T$.\n- Establish from first principles the existence and number of solutions by analyzing the curvature as a function of $\\phi$, identifying when there are zero, one (critical), or two spinodal compositions.\n- Implement a numerically stable algorithm that:\n  - Detects whether there is no spinodal solution at a given $T$ (returns an empty list).\n  - Detects the critical case with exactly one spinodal composition (returns a single-element list).\n  - Computes both spinodal compositions when they exist (returns a two-element ascending list).\n- Numerical units and precision: Temperatures must be treated in kelvin. Report compositions as decimal fractions (dimensionless) rounded to $8$ decimal places.\n\nTest suite:\n- Use the following temperatures in kelvin: $[200.0, 300.0, 350.0, 378.7878787879, 400.0, 1000.0]$.\n\nOutput specification:\n- For each temperature in the test suite, output the list of spinodal compositions $\\phi_{\\mathrm{sp}}(T)$ found by your algorithm, with elements rounded to $8$ decimal places and ordered ascending. Use an empty list when no solutions exist and a single-element list at the critical condition.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to one temperature in the test suite and is itself a bracketed, comma-separated list of the rounded compositions. For example, an output with three cases might look like \"[[0.12345678,0.98765432],[0.54321000],[]]\". The actual numbers must correspond to the given parameters and temperatures.", "solution": "The problem requires the calculation of spinodal compositions for a binary mixture described by the Flory-Huggins free energy. The process begins with a rigorous validation of the problem statement, which is found to be scientifically sound, well-posed, and objective. The subsequent solution is derived from first principles.\n\nThe Flory-Huggins free energy of mixing per lattice site, in units of $k_{\\mathrm{B}}T$, is given as:\n$$\nf(\\phi;T) = \\frac{\\phi}{N_1}\\ln \\phi + \\frac{1-\\phi}{N_2}\\ln(1-\\phi) + \\chi(T)\\,\\phi\\,(1-\\phi)\n$$\nHere, $\\phi$ is the volume fraction of component 1, $N_1$ and $N_2$ are the degrees of polymerization, and $\\chi(T)$ is the temperature-dependent interaction parameter.\n\nThe spinodal curve is defined as the locus of points where the free energy curvature with respect to composition vanishes. This indicates the limit of thermodynamic stability for a homogeneous mixture against infinitesimal fluctuations. Mathematically, this corresponds to the condition:\n$$\n\\frac{\\partial^2 f}{\\partial \\phi^2} = 0, \\quad \\text{for } \\phi \\in (0,1)\n$$\nTo derive the spinodal equation, we compute the first and second derivatives of $f(\\phi;T)$ with respect to $\\phi$:\nFirst derivative:\n$$\n\\frac{\\partial f}{\\partial \\phi} = \\frac{1}{N_1}(\\ln \\phi + 1) - \\frac{1}{N_2}(\\ln(1-\\phi) + 1) + \\chi(T)(1 - 2\\phi)\n$$\nSecond derivative (curvature):\n$$\n\\frac{\\partial^2 f}{\\partial \\phi^2} = \\frac{1}{N_1 \\phi} + \\frac{1}{N_2 (1-\\phi)} - 2\\chi(T)\n$$\nSetting the second derivative to zero yields the spinodal equation:\n$$\n\\frac{1}{N_1 \\phi} + \\frac{1}{N_2 (1-\\phi)} - 2\\chi(T) = 0\n$$\nThis equation defines the spinodal compositions $\\phi_{\\mathrm{sp}}$ for a given set of parameters $(N_1, N_2, \\chi)$.\n\nTo analyze the number of solutions, it is instructive to express the interaction parameter $\\chi$ as a function of the spinodal composition $\\phi$:\n$$\n\\chi_{\\mathrm{sp}}(\\phi) = \\frac{1}{2} \\left[ \\frac{1}{N_1 \\phi} + \\frac{1}{N_2 (1-\\phi)} \\right]\n$$\nThis function describes the spinodal curve in the $(\\phi, \\chi)$ plane. The number of solutions for $\\phi$ at a given $\\chi(T)$ depends on the value of $\\chi(T)$ relative to the minimum of $\\chi_{\\mathrm{sp}}(\\phi)$. This minimum represents the critical point for phase separation.\n\nThe critical point $(\\phi_c, \\chi_c)$ is found by minimizing $\\chi_{\\mathrm{sp}}(\\phi)$ with respect to $\\phi$, which is equivalent to setting the third derivative of the free energy to zero:\n$$\n\\frac{d\\chi_{\\mathrm{sp}}}{d\\phi} = \\frac{\\partial}{\\partial \\phi} \\left( \\frac{1}{2}\\frac{\\partial^2 f}{\\partial \\phi^2} \\right) = \\frac{1}{2}\\frac{\\partial^3 f}{\\partial \\phi^3} = \\frac{1}{2} \\left( -\\frac{1}{N_1 \\phi^2} + \\frac{1}{N_2 (1-\\phi)^2} \\right) = 0\n$$\nSolving for the critical composition $\\phi_c$:\n$$\n\\frac{1}{N_1 \\phi_c^2} = \\frac{1}{N_2 (1-\\phi_c)^2} \\implies \\sqrt{N_1} \\phi_c = \\sqrt{N_2} (1-\\phi_c)\n$$\n$$\n\\phi_c = \\frac{\\sqrt{N_2}}{\\sqrt{N_1} + \\sqrt{N_2}} = \\frac{1}{1 + \\sqrt{N_1/N_2}}\n$$\nSubstituting $\\phi_c$ back into the expression for $\\chi_{\\mathrm{sp}}(\\phi)$ yields the critical interaction parameter $\\chi_c$:\n$$\n\\chi_c = \\frac{1}{2} \\left( \\frac{1}{\\sqrt{N_1}} + \\frac{1}{\\sqrt{N_2}} \\right)^2\n$$\nFor the given parameters $N_1=1$ and $N_2=1000$:\n$$\n\\phi_c = \\frac{\\sqrt{1000}}{\\sqrt{1} + \\sqrt{1000}} \\approx 0.96934651\n$$\n$$\n\\chi_c = \\frac{1}{2} \\left( \\frac{1}{\\sqrt{1}} + \\frac{1}{\\sqrt{1000}} \\right)^2 = \\frac{1}{2} \\left( 1 + \\frac{1}{10\\sqrt{10}} \\right)^2 \\approx 0.53212280\n$$\nThe system exhibits phase separation only when the interaction parameter $\\chi(T)$ exceeds this critical value $\\chi_c$.\n- If $\\chi(T) > \\chi_c$, there are two distinct spinodal compositions.\n- If $\\chi(T) = \\chi_c$, there is exactly one spinodal composition, $\\phi = \\phi_c$. This occurs at the critical temperature, $T_c$.\n- If $\\chi(T)  \\chi_c$, there are no real solutions for $\\phi \\in (0,1)$, and the mixture is stable at all compositions.\n\nThe critical temperature $T_c$ is found by solving $\\chi(T_c) = \\chi_c$ using the given temperature dependence $\\chi(T) = 0.4 + 50/T$:\n$$\n0.4 + \\frac{50}{T_c} = \\chi_c \\implies T_c = \\frac{50}{\\chi_c - 0.4}\n$$\nUsing the calculated value of $\\chi_c$:\n$$\nT_c \\approx \\frac{50}{0.53212280 - 0.4} = \\frac{50}{0.13212280} \\approx 378.423001 \\text{ K}\n$$\n\nThe numerical algorithm is designed based on this analysis. For each temperature $T$ in the test suite:\n1.  Calculate $\\chi(T) = 0.4 + 50/T$.\n2.  Compare $\\chi(T)$ to the pre-calculated $\\chi_c$.\n3.  If $\\chi(T)  \\chi_c$ (or $T > T_c$), there are no solutions.\n4.  If $\\chi(T) > \\chi_c$ (or $T  T_c$), there are two solutions. These are found by numerically solving the nonlinear equation $\\frac{1}{N_1 \\phi} + \\frac{1}{N_2 (1-\\phi)} - 2\\chi(T) = 0$. The roots are bracketed by $(0, \\phi_c)$ and $(\\phi_c, 1)$ and can be efficiently found using a stable algorithm such as Brent's method.\n5.  If $\\chi(T)$ is numerically indistinguishable from $\\chi_c$, the single solution is $\\phi_c$. A small tolerance must be used to handle this case in floating-point arithmetic.\n\nOne of the test temperatures is $T^*=378.7878787879$ K. This value is slightly greater than the calculated critical temperature $T_c \\approx 378.423$ K. At this temperature, $\\chi(T^*) \\approx 0.5320  \\chi_c$, placing the system in the one-phase (miscible) region. Therefore, according to rigorous application of the theory, no spinodal compositions should exist at this temperature. The algorithm will correctly identify this case.\n\nThe algorithm proceeds as follows for each input temperature $T$:\n- Calculate $\\chi(T)$.\n- The function to find roots of is $g(\\phi) = \\frac{1}{N_1\\phi} + \\frac{1}{N_2(1-\\phi)} - 2\\chi(T)$. The minimum value of the first two terms is $2\\chi_c$, occurring at $\\phi_c$. Therefore, the minimum value of $g(\\phi)$ is $2(\\chi_c - \\chi(T))$.\n- If $2(\\chi_c - \\chi(T)) > \\epsilon$ (a small positive tolerance), the minimum of $g(\\phi)$ is positive, so there are no roots.\n- If $|2(\\chi_c - \\chi(T))| \\le \\epsilon$, we are at the critical point, and the solution is $[\\phi_c]$.\n- If $2(\\chi_c - \\chi(T))  -\\epsilon$, the minimum is negative, and two roots exist. They are found using `scipy.optimize.brentq` in the intervals $(0, \\phi_c)$ and $(\\phi_c, 1)$. Small offsets are used to avoid the singular endpoints.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes Flory-Huggins spinodal compositions for given parameters and temperatures.\n    \"\"\"\n    # Define the problem parameters as floating-point numbers for precision.\n    N1 = 1.0\n    N2 = 1000.0\n    \n    # --- Step 1: Calculate critical point (phi_c, chi_c) from first principles ---\n    # Critical composition phi_c = sqrt(N2) / (sqrt(N1) + sqrt(N2))\n    phi_c = np.sqrt(N2) / (np.sqrt(N1) + np.sqrt(N2))\n    \n    # Critical interaction parameter chi_c = 0.5 * (1/sqrt(N1) + 1/sqrt(N2))^2\n    chi_c = 0.5 * (1.0 / np.sqrt(N1) + 1.0 / np.sqrt(N2))**2\n    \n    def chi_from_T(T):\n        \"\"\"Calculates the temperature-dependent chi parameter.\"\"\"\n        return 0.4 + 50.0 / T\n\n    def find_spinodal_compositions(T, n1_val, n2_val, phi_c_val, chi_c_val):\n        \"\"\"\n        Finds the spinodal compositions for a given temperature T.\n        \n        Returns:\n            list: A list of spinodal compositions (empty, 1, or 2 elements).\n        \"\"\"\n        current_chi = chi_from_T(T)\n        \n        # The function whose roots define the spinodal compositions.\n        # f''(phi) = 1/(n1*phi) + 1/(n2*(1-phi)) - 2*chi\n        # The minimum value of the first part is 2*chi_c at phi_c.\n        # Thus, the minimum value of f''(phi) is 2*(chi_c - current_chi).\n        min_f_double_prime = 2.0 * (chi_c_val - current_chi)\n\n        # A small tolerance for floating-point comparisons near the critical point.\n        tolerance = 1e-9\n\n        if min_f_double_prime > tolerance:\n            # chi  chi_c: One-phase region, no spinodal points.\n            return []\n        elif abs(min_f_double_prime) = tolerance:\n            # chi = chi_c: Critical point, one spinodal composition.\n            return [phi_c_val]\n        else:\n            # chi > chi_c: Two-phase region, two spinodal compositions.\n            spinodal_equation = lambda phi: 1.0 / (n1_val * phi) + 1.0 / (n2_val * (1.0 - phi)) - 2.0 * current_chi\n            \n            # The function f''(phi) is guaranteed to be positive at the boundaries\n            # (phi -> 0+ or phi -> 1-) and negative at its minimum (phi_c).\n            # This ensures the bracketing for brentq is valid.\n            epsilon = 1e-12  # Small offset to avoid division by zero at boundaries.\n            \n            # Find the root in the interval (0, phi_c)\n            root1 = brentq(spinodal_equation, epsilon, phi_c_val)\n            \n            # Find the root in the interval (phi_c, 1)\n            root2 = brentq(spinodal_equation, phi_c_val, 1.0 - epsilon)\n            \n            return sorted([root1, root2])\n\n    test_cases = [200.0, 300.0, 350.0, 378.7878787879, 400.0, 1000.0]\n    \n    # --- Step 2: Iterate through test temperatures and compute solutions ---\n    all_results = []\n    for T in test_cases:\n        solutions = find_spinodal_compositions(T, N1, N2, phi_c, chi_c)\n        all_results.append(solutions)\n\n    # --- Step 3: Format the output according to specifications ---\n    formatted_results = []\n    for result_list in all_results:\n        # Round each composition to 8 decimal places and format as a string.\n        formatted_list = [f\"{sol:.8f}\" for sol in result_list]\n        # Enclose the list of strings in brackets.\n        formatted_results.append(f\"[{','.join(formatted_list)}]\")\n    \n    # Final output as a single line.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2930568"}]}