{"hands_on_practices": [{"introduction": "To understand the electronic properties of conducting polymers, we must first start at the quantum mechanical level. A conjugated polymer can be viewed as a one-dimensional crystal, and its electronic structure can be described by simple but powerful models. This first practice [@problem_id:2910328] invites you to use the foundational tight-binding model to explore how the discrete energy levels of a finite polymer chain (an oligomer) are formed. By solving for the energy spectrum, you will derive one of the most important relationships in the field: how the HOMO-LUMO gap, which determines the material's color and intrinsic conductivity, scales with the length of the polymer chain.", "problem": "A linear conjugated polymer oligomer is modeled as a $1$-dimensional chain of $N$ identical repeat units with open boundaries. Each repeat unit contributes one $\\pi$-electron orbital, and the electronic structure is described by a nearest-neighbor tight-binding Hamiltonian with on-site energy set to $0$ and a nearest-neighbor hopping integral of $-t$, where $t$ is a real, positive constant. The lattice spacing is $a$. Assume spin degeneracy and a half-filled chain with $N$ even, so that the total number of electrons is $N$ and each single-particle eigenstate can hold $2$ electrons. All angles are to be interpreted in radians.\n\nStarting from the tight-binding difference equation obtained from the stationary Schrödinger equation and enforcing open-boundary conditions at both ends, construct the quantized wavevectors $k_{n}$ for the standing-wave eigenstates and the corresponding energy spectrum. Use these results to identify the indices of the Highest Occupied Molecular Orbital (HOMO) and the Lowest Unoccupied Molecular Orbital (LUMO), and from the tight-binding spectrum estimate how the HOMO–LUMO energy gap scales with $N$. Provide, as your final answer, a single closed-form analytic expression for the HOMO–LUMO gap $\\Delta_{\\mathrm{HL}}(N)$ in terms of $t$ and $N$. Do not substitute numerical values. Express your answer symbolically; no units are required in the final expression.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It represents a standard, solvable problem in condensed matter physics and quantum chemistry, specifically the application of the Hückel or tight-binding model to a finite system. All necessary parameters and conditions are provided, and there are no internal contradictions. Therefore, we proceed to the solution.\n\nThe system is a $1$-dimensional chain of $N$ sites. The electronic wavefunction $|\\psi\\rangle$ can be expressed in the basis of localized orbitals $|j\\rangle$ centered at each site $j=1, 2, \\dots, N$:\n$$ |\\psi\\rangle = \\sum_{j=1}^{N} c_j |j\\rangle $$\nwhere $c_j$ is the complex amplitude of the wavefunction at site $j$. The stationary Schrödinger equation is $H|\\psi\\rangle = E|\\psi\\rangle$. In the tight-binding approximation with nearest-neighbor interactions, this becomes a set of difference equations for the amplitudes $c_j$. The on-site energy is given as $0$, and the nearest-neighbor hopping integral is $-t$. For a generic site $j$ (where $2 \\le j \\le N-1$), the equation is:\n$$ -t c_{j-1} - t c_{j+1} = E c_j $$\nThis is a second-order linear homogeneous difference equation. For a finite chain with open boundaries, the wavefunction amplitude must be zero at fictitious sites $j=0$ and $j=N+1$. This means $c_0 = 0$ and $c_{N+1} = 0$.\n\nWe seek solutions in the form of standing waves, which can be constructed from a superposition of left- and right-propagating plane waves. A suitable ansatz that satisfies the boundary condition at $j=0$ is:\n$$ c_j = \\mathcal{A} \\sin(k j a) $$\nwhere $k$ is the wavevector, $a$ is the lattice spacing, and $\\mathcal{A}$ is a normalization constant. The condition $c_0 = \\mathcal{A} \\sin(0) = 0$ is automatically satisfied.\nThe second boundary condition, $c_{N+1}=0$, imposes a quantization condition on the wavevector $k$:\n$$ \\mathcal{A} \\sin(k (N+1) a) = 0 $$\nFor a non-trivial solution ($\\mathcal{A} \\neq 0$), this requires $k(N+1)a = n\\pi$ for an integer $n$. The allowed wavevectors are therefore:\n$$ k_n = \\frac{n\\pi}{(N+1)a} $$\nThe distinct, physically meaningful eigenstates correspond to $n = 1, 2, \\dots, N$. The value $n=0$ gives a trivial null state ($c_j=0$ for all $j$), and values of $n$ beyond $N$ do not produce new independent states. The normalized eigenstates are:\n$$ c_j^{(n)} = \\sqrt{\\frac{2}{N+1}} \\sin\\left(\\frac{n\\pi j}{N+1}\\right) $$\nTo find the energy eigenvalues, we substitute the ansatz back into the bulk difference equation:\n$$ -t \\left[ \\sin(k(j-1)a) + \\sin(k(j+1)a) \\right] = E \\sin(kja) $$\nUsing the trigonometric identity $\\sin(X-Y) + \\sin(X+Y) = 2\\sin(X)\\cos(Y)$, we get:\n$$ -t \\left[ 2\\sin(kja)\\cos(ka) \\right] = E \\sin(kja) $$\nThis yields the dispersion relation $E(k) = -2t \\cos(ka)$. Substituting the quantized wavevectors $k_n$, we obtain the discrete energy spectrum:\n$$ E_n = -2t \\cos(k_n a) = -2t \\cos\\left(\\frac{n\\pi}{N+1}\\right), \\quad n=1, 2, \\dots, N $$\nThe problem states that $t$ is positive. Since the function $\\cos(x)$ is monotonically decreasing for $x \\in [0, \\pi]$, the function $-\\cos(x)$ is monotonically increasing. The argument $\\frac{n\\pi}{N+1}$ ranges from near $0$ to near $\\pi$ as $n$ goes from $1$ to $N$. Therefore, the energy levels $E_n$ increase as the quantum number $n$ increases. The lowest energy state is $E_1$ and the highest is $E_N$.\n\nThe system has $N$ electrons, and each energy level can accommodate $2$ electrons due to spin degeneracy. To achieve the ground state, we must fill the $N/2$ lowest available energy levels. Since the energies are ordered as $E_1  E_2  \\dots  E_N$, the occupied states will be those with the smallest quantum numbers.\nThe set of quantum numbers for the occupied states is $\\{1, 2, \\dots, N/2\\}$.\n\nThe Highest Occupied Molecular Orbital (HOMO) is the occupied state with the highest energy. This corresponds to the state with the largest quantum number among the occupied levels.\n$$ n_{\\mathrm{HOMO}} = \\frac{N}{2} $$\nThe energy of the HOMO level is:\n$$ E_{\\mathrm{HOMO}} = E_{N/2} = -2t \\cos\\left(\\frac{(\\frac{N}{2})\\pi}{N+1}\\right) = -2t \\cos\\left(\\frac{N\\pi}{2(N+1)}\\right) $$\nThe Lowest Unoccupied Molecular Orbital (LUMO) is the unoccupied state with the lowest energy. The set of quantum numbers for the unoccupied states is $\\{N/2 + 1, N/2 + 2, \\dots, N\\}$. The lowest energy among these corresponds to the state with the smallest quantum number $n$.\n$$ n_{\\mathrm{LUMO}} = \\frac{N}{2} + 1 $$\nThe energy of the LUMO level is:\n$$ E_{\\mathrm{LUMO}} = E_{N/2+1} = -2t \\cos\\left(\\frac{(\\frac{N}{2}+1)\\pi}{N+1}\\right) = -2t \\cos\\left(\\frac{(N+2)\\pi}{2(N+1)}\\right) $$\nThe HOMO-LUMO gap, $\\Delta_{\\mathrm{HL}}$, is the energy difference between the LUMO and HOMO.\n$$ \\Delta_{\\mathrm{HL}} = E_{\\mathrm{LUMO}} - E_{\\mathrm{HOMO}} = -2t \\left[ \\cos\\left(\\frac{(N+2)\\pi}{2(N+1)}\\right) - \\cos\\left(\\frac{N\\pi}{2(N+1)}\\right) \\right] $$\nTo simplify this expression, we use the trigonometric identities involving $\\pi/2$. Let $x = \\frac{\\pi}{2(N+1)}$.\nThe argument of the first cosine in the brackets is $\\frac{(N+2)\\pi}{2(N+1)} = \\frac{(N+1+1)\\pi}{2(N+1)} = \\frac{\\pi}{2} + \\frac{\\pi}{2(N+1)} = \\frac{\\pi}{2}+x$.\nThe argument of the second cosine is $\\frac{N\\pi}{2(N+1)} = \\frac{(N+1-1)\\pi}{2(N+1)} = \\frac{\\pi}{2} - \\frac{\\pi}{2(N+1)} = \\frac{\\pi}{2}-x$.\nUsing $\\cos(\\frac{\\pi}{2}+x) = -\\sin(x)$ and $\\cos(\\frac{\\pi}{2}-x) = \\sin(x)$, the gap becomes:\n$$ \\Delta_{\\mathrm{HL}} = -2t \\left[ -\\sin\\left(\\frac{\\pi}{2(N+1)}\\right) - \\sin\\left(\\frac{\\pi}{2(N+1)}\\right) \\right] $$\n$$ \\Delta_{\\mathrm{HL}} = -2t \\left[ -2 \\sin\\left(\\frac{\\pi}{2(N+1)}\\right) \\right] $$\nThis gives the final closed-form expression for the HOMO-LUMO gap.\nFor large $N$, $\\frac{\\pi}{2(N+1)}$ is small, and using the approximation $\\sin(x) \\approx x$, we find that $\\Delta_{\\mathrm{HL}} \\approx 4t \\left(\\frac{\\pi}{2(N+1)}\\right) = \\frac{2\\pi t}{N+1}$. The gap scales as $1/N$ for long chains, a characteristic result.", "answer": "$$\n\\boxed{4t \\sin\\left(\\frac{\\pi}{2(N+1)}\\right)}\n$$", "id": "2910328"}, {"introduction": "Most pristine conjugated polymers are semiconductors due to their intrinsic band gap. The magic of \"conducting polymers\" lies in our ability to introduce charge carriers through a process called doping, which dramatically increases their conductivity. This practice [@problem_id:1546080] bridges the gap between lab-scale experiments and the microscopic picture of doping. You will use fundamental electrochemical principles to calculate the average doping level in a polymer film from real-world experimental data, providing a quantitative understanding of how we control and measure the carrier concentration in these materials.", "problem": "In materials science, the properties of conducting polymers can be tuned through a process called electrochemical doping. Consider a thin film of a neutral conducting polymer, poly(3-hexylthiophene), deposited onto an inert electrode. The monomer unit of this polymer has a molar mass of $M = 166.28 \\text{ g/mol}$. A sample of this film with a mass of $m = 1.25 \\text{ mg}$ is subjected to controlled-potential coulometry. During the experiment, the polymer is electrochemically oxidized, which removes electrons from the polymer backbone and creates mobile positive charges. This process continues until a total charge of $Q = 43.6 \\text{ mC}$ has passed, converting the neutral polymer into a positively charged (p-doped) state.\n\nThe average doping level, $y$, is defined as the average number of positive elementary charges created per monomer unit in the polymer. Using the provided data and Faraday's constant, $F = 96485 \\text{ C}\\cdot\\text{mol}^{-1}$, calculate the average doping level, $y$. Report your answer as a dimensionless decimal value, rounded to three significant figures.", "solution": "The oxidation removes electrons from the polymer, creating positive charges (holes). By Faraday’s law, the moles of electrons transferred are given by $n_{e} = \\frac{Q}{F}$. The moles of monomer units present in the film are $n_{m} = \\frac{m}{M}$. The average doping level, defined as the number of positive charges per monomer unit, is the ratio\n$$\ny = \\frac{n_{e}}{n_{m}} = \\frac{\\frac{Q}{F}}{\\frac{m}{M}} = \\frac{Q M}{F m}.\n$$\nConvert the given quantities to base units: $m = 1.25 \\times 10^{-3}\\ \\text{g}$ and $Q = 4.36 \\times 10^{-2}\\ \\text{C}$. Substituting the numerical values,\n$$\ny = \\frac{\\left(4.36 \\times 10^{-2}\\ \\text{C}\\right)\\left(166.28\\ \\text{g}\\cdot\\text{mol}^{-1}\\right)}{\\left(96485\\ \\text{C}\\cdot\\text{mol}^{-1}\\right)\\left(1.25 \\times 10^{-3}\\ \\text{g}\\right)}.\n$$\nCompute numerator and denominator separately:\n$$\nQ M = 4.36 \\times 10^{-2} \\times 166.28 = 7.249808,\n$$\n$$\nF m = 96485 \\times 1.25 \\times 10^{-3} = 120.60625.\n$$\nThus,\n$$\ny = \\frac{7.249808}{120.60625} \\approx 0.0601,\n$$\nrounded to three significant figures. This is a dimensionless quantity as required by the definition of $y$.", "answer": "$$\\boxed{0.0601}$$", "id": "1546080"}, {"introduction": "Our final practice applies the principles of doping and charge transport to model a state-of-the-art electronic device, the Organic Electrochemical Transistor (OECT). These devices are central to bioelectronics and sensing, and their operation relies on modulating the electronic conductivity of a polymer channel via ionic doping from an electrolyte. In this capstone problem [@problem_id:2910304], you will develop a complete physical model of an OECT's transient response from first principles, combining ion diffusion and electronic conduction. By implementing this model computationally, you will learn how to analyze device characteristics to extract fundamental material parameters, a skill essential for both device engineers and materials scientists.", "problem": "An Organic Electrochemical Transistor (OECT) consists of a mixed ionic-electronic conducting polymer channel of thickness $T$ in intimate contact with an electrolyte at $x=0$ and supported by an insulating substrate at $x=T$. At time $t=0^{+}$ a gate voltage step drives counter-ions from the electrolyte into the polymer, establishing a fixed ion concentration $c_{s}$ at the electrolyte interface for all $t0$. Assume one-dimensional transport of ions across the thickness direction $x \\in [0,T]$, governed by Fick’s second law and local electroneutral volumetric charging so that electronic hole density is proportional to the local ionic concentration. The fundamental bases you must start from are: (i) Fick’s law of diffusion for the ionic concentration $c(x,t)$, (ii) charge conservation, and (iii) the definition of electronic conductivity $\\sigma(x,t)=q \\mu_{e} \\beta c(x,t)$, where $q$ is the elementary charge, $\\mu_{e}$ is the electronic mobility, and $\\beta$ is a dimensionless stoichiometric proportionality constant.\n\nYour tasks are:\n- Starting from Fick’s second law, with boundary conditions $c(0,t)=c_{s}$ and $\\partial c/\\partial x|_{x=T}=0$, and initial condition $c(x,0)=0$, derive an expression for the spatially averaged ionic concentration $\\bar{c}(t) \\equiv \\frac{1}{T}\\int_{0}^{T} c(x,t)\\,dx$ as a function of the ionic diffusion coefficient $D$, the thickness $T$, and time $t$. Do not assume any result beyond the stated fundamental bases.\n- Using the constitutive relation $\\sigma(x,t)=q \\mu_{e} \\beta c(x,t)$ and Ohm’s law in the diffusive limit, show how the channel conductance $G(t)$ along the channel (length $L_{\\mathrm{ch}}$, width $W$) relates to $\\bar{c}(t)$ via $G(t) = \\frac{W}{L_{\\mathrm{ch}}} \\int_{0}^{T} \\sigma(x,t)\\,dx$.\n- Devise an algorithmic method to estimate $D$ and $\\mu_{e}$ from a measured conductance transient $G(t)$ produced by a concentration step $c_{s}$, given $q$, $\\beta$, $T$, $W$, $L_{\\mathrm{ch}}$, and the time samples $\\{t_{i}\\}$. Your method must rely only on the fundamental laws above and must explain how to decouple the shape parameter $D$ from the amplitude parameter $\\mu_{e}$.\n- Implement the method as a complete, runnable program that: (a) generates synthetic, noise-free conductance transients $G(t)$ for each test case using the physics specified above and known $(D_{\\mathrm{true}},\\mu_{e,\\mathrm{true}})$, (b) estimates $(\\hat{D},\\hat{\\mu}_{e})$ from the synthetic $G(t)$, and (c) outputs the estimated parameters.\n\nUse the following test suite, with all quantities in the International System of Units (SI). Use $q=1.602176634\\times 10^{-19}\\,\\mathrm{C}$ and $\\beta=1$ for all cases. For each test, the program must generate $G(t)$ using the true parameters and time vector, then produce the corresponding estimates.\n\n- Test $1$:\n  - $T=1.0\\times 10^{-7}\\,\\mathrm{m}$, $W=1.0\\times 10^{-4}\\,\\mathrm{m}$, $L_{\\mathrm{ch}}=1.0\\times 10^{-5}\\,\\mathrm{m}$, $c_{s}=1.0\\times 10^{26}\\,\\mathrm{m^{-3}}$.\n  - $D_{\\mathrm{true}}=1.0\\times 10^{-10}\\,\\mathrm{m^{2}\\,s^{-1}}$, $\\mu_{e,\\mathrm{true}}=4.0\\times 10^{-4}\\,\\mathrm{m^{2}\\,V^{-1}\\,s^{-1}}$.\n  - Time samples: $N_{t}=200$ points logarithmically spaced from $t_{\\min}=1.0\\times 10^{-7}\\,\\mathrm{s}$ to $t_{\\max}=1.0\\times 10^{-2}\\,\\mathrm{s}$.\n- Test $2$:\n  - $T=8.0\\times 10^{-8}\\,\\mathrm{m}$, $W=5.0\\times 10^{-5}\\,\\mathrm{m}$, $L_{\\mathrm{ch}}=5.0\\times 10^{-6}\\,\\mathrm{m}$, $c_{s}=5.0\\times 10^{25}\\,\\mathrm{m^{-3}}$.\n  - $D_{\\mathrm{true}}=5.0\\times 10^{-10}\\,\\mathrm{m^{2}\\,s^{-1}}$, $\\mu_{e,\\mathrm{true}}=1.5\\times 10^{-3}\\,\\mathrm{m^{2}\\,V^{-1}\\,s^{-1}}$.\n  - Time samples: $N_{t}=200$ points logarithmically spaced from $t_{\\min}=1.0\\times 10^{-7}\\,\\mathrm{s}$ to $t_{\\max}=2.0\\times 10^{-3}\\,\\mathrm{s}$.\n- Test $3$:\n  - $T=2.0\\times 10^{-7}\\,\\mathrm{m}$, $W=2.0\\times 10^{-4}\\,\\mathrm{m}$, $L_{\\mathrm{ch}}=2.5\\times 10^{-5}\\,\\mathrm{m}$, $c_{s}=2.0\\times 10^{26}\\,\\mathrm{m^{-3}}$.\n  - $D_{\\mathrm{true}}=1.0\\times 10^{-11}\\,\\mathrm{m^{2}\\,s^{-1}}$, $\\mu_{e,\\mathrm{true}}=8.0\\times 10^{-4}\\,\\mathrm{m^{2}\\,V^{-1}\\,s^{-1}}$.\n  - Time samples: $N_{t}=220$ points logarithmically spaced from $t_{\\min}=1.0\\times 10^{-6}\\,\\mathrm{s}$ to $t_{\\max}=5.0\\times 10^{-1}\\,\\mathrm{s}$.\n\nProgram requirements:\n- Physics engine: implement the analytic series solution implied by separation of variables for Fick’s equation under the stated boundary conditions to compute $\\bar{c}(t)$ without numerical instability. Use a truncation strategy with enough terms to ensure convergence.\n- Estimation method: estimate $\\hat{D}$ by minimizing the sum of squared deviations between the normalized measured conductance transient and the normalized model transient, where normalization is with respect to the steady-state value. Then compute $\\hat{\\mu}_{e}$ from the steady-state conductance magnitude. State how you approximate the steady state from the finite time samples.\n- Output: For each test case, produce the pair $(\\hat{D},\\hat{\\mu}_{e})$ in SI units. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[\\hat{D}_{1},\\hat{\\mu}_{e,1},\\hat{D}_{2},\\hat{\\mu}_{e,2},\\hat{D}_{3},\\hat{\\mu}_{e,3}]$. Express each number in SI units and round each to $6$ significant digits. Angles are not used. Do not include percentage signs; if any ratios are reported, they must be decimals.", "solution": "We begin from Fick’s second law for the ionic concentration $c(x,t)$ in one dimension,\n$$\n\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^{2} c}{\\partial x^{2}},\n$$\non the domain $x \\in [0,T]$ with initial condition $c(x,0)=0$ and mixed boundary conditions $c(0,t)=c_{s}$ and $\\left.\\frac{\\partial c}{\\partial x}\\right|_{x=T}=0$. Introduce $u(x,t) \\equiv c_{s}-c(x,t)$ so that $u$ satisfies\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^{2} u}{\\partial x^{2}}, \\quad u(0,t)=0, \\quad \\left.\\frac{\\partial u}{\\partial x}\\right|_{x=T}=0, \\quad u(x,0)=c_{s}.\n$$\nWe solve by separation of variables with $u(x,t)=X(x)T(t)$, yielding\n$$\n\\frac{1}{D}\\frac{1}{T}\\frac{dT}{dt} = \\frac{1}{X}\\frac{d^{2}X}{dx^{2}} = -\\lambda,\n$$\nwith eigenfunctions $X_{n}(x)=\\sin(k_{n} x)$ that satisfy $X_{n}(0)=0$ and $X_{n}'(T)=k_{n}\\cos(k_{n} T)=0$, hence $\\cos(k_{n} T)=0$. The allowed wavenumbers are\n$$\nk_{n} = \\frac{(2n+1)\\pi}{2T}, \\quad n=0,1,2,\\dots,\n$$\nand the temporal factors are $T_{n}(t)=\\exp(-D k_{n}^{2} t)$. Expanding the initial condition $u(x,0)=c_{s}$ in this sine basis,\n$$\nu(x,0) = \\sum_{n=0}^{\\infty} A_{n} \\sin(k_{n} x),\n$$\nwith orthogonality $\\int_{0}^{T} \\sin(k_{m} x)\\sin(k_{n} x)\\,dx = \\frac{T}{2}\\delta_{mn}$, we obtain\n$$\nA_{n} = \\frac{2}{T} \\int_{0}^{T} c_{s} \\sin(k_{n} x)\\,dx = \\frac{2 c_{s}}{T k_{n}} \\left[1 - \\cos(k_{n} T)\\right] = \\frac{2 c_{s}}{T k_{n}},\n$$\nsince $\\cos(k_{n} T)=\\cos\\left(\\frac{(2n+1)\\pi}{2}\\right)=0$. Thus,\n$$\nu(x,t) = \\sum_{n=0}^{\\infty} \\frac{2 c_{s}}{T k_{n}} \\sin(k_{n} x) \\exp(-D k_{n}^{2} t),\n$$\nand\n$$\nc(x,t) = c_{s} - u(x,t) = c_{s} \\left[1 - \\sum_{n=0}^{\\infty} \\frac{2}{T k_{n}} \\sin(k_{n} x) \\exp(-D k_{n}^{2} t)\\right].\n$$\nWe seek the spatial average $\\bar{c}(t) = \\frac{1}{T}\\int_{0}^{T} c(x,t)\\,dx$. Using $\\int_{0}^{T} \\sin(k_{n} x)\\,dx = \\frac{1 - \\cos(k_{n}T)}{k_{n}} = \\frac{1}{k_{n}}$, we obtain\n$$\n\\bar{c}(t) = \\frac{1}{T}\\int_{0}^{T} c(x,t)\\,dx = c_{s}\\left[1 - \\sum_{n=0}^{\\infty} \\frac{2}{T k_{n}} \\frac{1}{T k_{n}} \\exp(-D k_{n}^{2} t)\\right].\n$$\nWith $k_{n} = \\frac{(2n+1)\\pi}{2T}$, we have $(T k_{n})^{2}=\\frac{(2n+1)^{2}\\pi^{2}}{4}$ and hence\n$$\n\\bar{c}(t) = c_{s}\\left[1 - \\sum_{n=0}^{\\infty} \\frac{8}{(2n+1)^{2}\\pi^{2}} \\exp\\left(- \\frac{(2n+1)^{2}\\pi^{2} D}{4 T^{2}} t\\right)\\right].\n$$\n\nNext, the local electronic conductivity is $\\sigma(x,t)=q \\mu_{e} \\beta c(x,t)$. The channel conductance $G(t)$ for a rectangular channel of width $W$, length $L_{\\mathrm{ch}}$, and thickness $T$ is found by integrating the conductivity over the thickness to get the cross-sectional conductance per unit length, then dividing by the length:\n$$\nG(t) = \\frac{W}{L_{\\mathrm{ch}}} \\int_{0}^{T} \\sigma(x,t)\\,dx = \\frac{W}{L_{\\mathrm{ch}}} q \\mu_{e} \\beta \\int_{0}^{T} c(x,t)\\,dx = \\frac{W}{L_{\\mathrm{ch}}} q \\mu_{e} \\beta\\, T\\, \\bar{c}(t).\n$$\nTherefore, the time dependence enters through $\\bar{c}(t)$ alone, while the amplitude scales linearly with $\\mu_{e}$. At steady state $t\\to\\infty$, $\\bar{c}(\\infty)=c_{s}$, and we have\n$$\nG_{\\infty} = \\frac{W}{L_{\\mathrm{ch}}} q \\mu_{e} \\beta\\, T\\, c_{s}.\n$$\nThis directly yields\n$$\n\\mu_{e} = \\frac{G_{\\infty}\\,L_{\\mathrm{ch}}}{W\\,q\\,\\beta\\,T\\,c_{s}}.\n$$\n\nEstimation strategy:\n- Normalize the conductance transient as $g(t) \\equiv \\frac{G(t)}{G_{\\infty}} = \\frac{\\bar{c}(t)}{c_{s}}$, which depends only on $D$ and $T$:\n$$\ng(t;D,T) = 1 - \\sum_{n=0}^{\\infty} \\frac{8}{(2n+1)^{2}\\pi^{2}} \\exp\\left(- \\frac{(2n+1)^{2}\\pi^{2} D}{4 T^{2}} t\\right).\n$$\n- Given time samples $\\{t_{i}\\}$ and measured $G(t_{i})$, approximate $G_{\\infty}$ by the final sampled value $G(t_{N})$ when the time window is much larger than the characteristic diffusion time $\\tau_{D} \\sim \\frac{T^{2}}{D}$. Compute the normalized data $\\tilde{g}_{i}=G(t_{i})/G(t_{N})$.\n- Estimate $\\hat{D}$ by minimizing the sum of squared residuals $\\sum_{i} \\left[\\tilde{g}_{i} - g(t_{i};D,T)\\right]^{2}$ over a positive range of $D$ values. This can be done via a grid search over logarithmically spaced $D$ candidates and selecting the minimizer.\n- Having obtained $\\hat{D}$, estimate $\\hat{\\mu}_{e}$ using the steady-state relation and the measured final conductance $G(t_{N})$:\n$$\n\\hat{\\mu}_{e} = \\frac{G(t_{N})\\,L_{\\mathrm{ch}}}{W\\,q\\,\\beta\\,T\\,c_{s}}.\n$$\n\nAlgorithmic design:\n- For efficient and stable computation of $g(t;D,T)$, truncate the infinite series to a finite number $N$ of terms. The series terms decay as $(2n+1)^{-2}$ and exponentially in time; in practice, choosing $N$ sufficiently large (for example, $N=400$) ensures convergence to within machine precision for the given time windows.\n- Vectorize over $n$ and $t$ using numerical arrays to compute $g(t;D,T)$ efficiently.\n- For the grid search, choose logarithmically spaced $D$ candidates over a bracket that contains the true values (for example from $10^{-12}\\,\\mathrm{m^{2}\\,s^{-1}}$ to $10^{-8}\\,\\mathrm{m^{2}\\,s^{-1}}$) with adequate resolution.\n\nUnits and output:\n- All inputs and outputs are in the International System of Units. The estimated $\\hat{D}$ must be in $\\mathrm{m^{2}\\,s^{-1}}$ and $\\hat{\\mu}_{e}$ must be in $\\mathrm{m^{2}\\,V^{-1}\\,s^{-1}}$.\n- Round each reported number to $6$ significant digits.\n- The final program output is a single line: a comma-separated list enclosed in square brackets in the order $[\\hat{D}_{1},\\hat{\\mu}_{e,1},\\hat{D}_{2},\\hat{\\mu}_{e,2},\\hat{D}_{3},\\hat{\\mu}_{e,3}]$.\n\nThis approach is principled: the diffusion equation and boundary conditions produce a normalized transient shape governed solely by $D$, while the steady-state amplitude encodes $\\mu_{e}$. The separation of variables solution provides a fast and accurate forward model for both generating synthetic data and performing parameter estimation. The chosen test windows have $t_{\\max} \\gg \\tau_{D}$ to ensure that the last time point is a good approximation to steady state, enabling accurate inference of $\\mu_{e}$ from the final conductance value.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Constants\nq = 1.602176634e-19  # Coulombs\nbeta = 1.0           # dimensionless\n\ndef series_normalized_avg_c(t, D, T, n_terms=500):\n    \"\"\"\n    Compute the normalized average concentration g(t; D, T) = c_avg(t)/c_s\n    using the analytic series solution for the 1D diffusion problem with\n    Dirichlet at x=0 and Neumann at x=T.\n\n    Parameters:\n        t : array of time points [s]\n        D : diffusion coefficient [m^2/s]\n        T : thickness [m]\n        n_terms : number of terms in the series truncation\n\n    Returns:\n        g : array of same shape as t with normalized average concentration\n    \"\"\"\n    # Prepare mode indices n = 0..n_terms-1\n    n = np.arange(n_terms, dtype=np.float64)\n    # Precompute coefficients: a_n = 8 / ((2n+1)^2 * pi^2)\n    odd = 2.0 * n + 1.0\n    a_n = 8.0 / (odd**2 * np.pi**2)\n    # Exponential rate factors: lambda_n = ((2n+1)^2 * pi^2 * D) / (4 T^2)\n    lam_n = (odd**2 * np.pi**2 * D) / (4.0 * T**2)\n\n    # Compute exp(-lambda_n * t) for all n and t\n    t = np.asarray(t, dtype=np.float64)\n    # Shape: (n_terms, len(t))\n    exp_matrix = np.exp(-np.outer(lam_n, t))\n    # Sum over n: sum a_n * exp(-lambda_n t)\n    sum_terms = a_n @ exp_matrix  # shape (len(t),)\n    g = 1.0 - sum_terms\n    return g\n\ndef conductance_transient(D, mu_e, T, W, Lch, c_s, t, n_terms=500):\n    \"\"\"\n    Compute the conductance transient G(t) using\n    G(t) = (W/Lch) * q * mu_e * beta * T * c_avg(t)\n    where c_avg(t) = c_s * g(t; D, T).\n    \"\"\"\n    g = series_normalized_avg_c(t, D, T, n_terms=n_terms)\n    A = (W / Lch) * q * beta * T\n    G = A * mu_e * c_s * g\n    return G\n\ndef estimate_D_from_normalized(G, t, T, D_min=1e-12, D_max=1e-8, n_grid=401, n_terms=500):\n    \"\"\"\n    Estimate D by grid-search minimizing squared error between\n    normalized data G/G_final and the model g(t; D, T).\n    \"\"\"\n    # Normalize data by final value (approximate steady-state)\n    G_final = G[-1]\n    g_data = G / G_final\n\n    # Grid search over D\n    D_grid = np.logspace(np.log10(D_min), np.log10(D_max), n_grid)\n    # Compute model curves for all D candidates\n    # We'll evaluate cost for each D: sum((g_data - g_model)^2)\n    best_cost = np.inf\n    best_D = None\n    for D in D_grid:\n        g_model = series_normalized_avg_c(t, D, T, n_terms=n_terms)\n        # Use squared error; optionally weight early/late equally\n        cost = np.sum((g_data - g_model)**2)\n        if cost  best_cost:\n            best_cost = cost\n            best_D = D\n    return best_D\n\ndef estimate_mu_from_final(G, T, W, Lch, c_s):\n    \"\"\"\n    Estimate mu_e using the steady-state relation:\n    mu_e = G_infty * Lch / (W * q * beta * T * c_s)\n    Approximating G_infty by the last sampled G value.\n    \"\"\"\n    G_final = G[-1]\n    mu_e = G_final * Lch / (W * q * beta * T * c_s)\n    return mu_e\n\ndef fmt_sig6(x):\n    \"\"\"Format a float with 6 significant digits, using general format.\"\"\"\n    return format(float(x), \".6g\")\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Each case: dict with parameters and time vector construction\n        {\n            \"T\": 1.0e-7,\n            \"W\": 1.0e-4,\n            \"Lch\": 1.0e-5,\n            \"c_s\": 1.0e26,\n            \"D_true\": 1.0e-10,\n            \"mu_true\": 4.0e-4,\n            \"t\": np.logspace(np.log10(1.0e-7), np.log10(1.0e-2), 200)\n        },\n        {\n            \"T\": 8.0e-8,\n            \"W\": 5.0e-5,\n            \"Lch\": 5.0e-6,\n            \"c_s\": 5.0e25,\n            \"D_true\": 5.0e-10,\n            \"mu_true\": 1.5e-3,\n            \"t\": np.logspace(np.log10(1.0e-7), np.log10(2.0e-3), 200)\n        },\n        {\n            \"T\": 2.0e-7,\n            \"W\": 2.0e-4,\n            \"Lch\": 2.5e-5,\n            \"c_s\": 2.0e26,\n            \"D_true\": 1.0e-11,\n            \"mu_true\": 8.0e-4,\n            \"t\": np.logspace(np.log10(1.0e-6), np.log10(5.0e-1), 220)\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        T = case[\"T\"]; W = case[\"W\"]; Lch = case[\"Lch\"]; c_s = case[\"c_s\"]\n        D_true = case[\"D_true\"]; mu_true = case[\"mu_true\"]; t = case[\"t\"]\n\n        # Generate synthetic conductance transient (noise-free)\n        G = conductance_transient(D_true, mu_true, T, W, Lch, c_s, t, n_terms=600)\n\n        # Estimate D from normalized transient\n        D_est = estimate_D_from_normalized(G, t, T, D_min=1e-12, D_max=1e-8, n_grid=501, n_terms=600)\n\n        # Estimate mu from steady-state amplitude (last time sample)\n        mu_est = estimate_mu_from_final(G, T, W, Lch, c_s)\n\n        results.append(fmt_sig6(D_est))\n        results.append(fmt_sig6(mu_est))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2910304"}]}