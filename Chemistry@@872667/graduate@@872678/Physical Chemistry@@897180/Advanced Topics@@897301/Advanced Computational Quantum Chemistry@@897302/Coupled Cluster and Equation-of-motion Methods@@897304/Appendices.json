{"hands_on_practices": [{"introduction": "A core reason for the success of coupled cluster theory is its size-extensivity, a property ensuring that the energy of two non-interacting systems is the sum of their individual energies. This exercise provides a rigorous, hands-on demonstration of this fundamental principle. You will formally prove why the exponential ansatz of CCSD naturally leads to size-extensivity, and through a contrasting minimal model, reveal why truncated configuration interaction methods fail this crucial test.", "problem": "Two helium atoms labeled $A$ and $B$ are placed at a separation so large that they are noninteracting. The electronic Hamiltonian is the sum $H = H_{A} + H_{B}$, and the Hartree–Fock reference for the supersystem is the product determinant $|\\Phi_{AB}\\rangle = |\\Phi_{A}\\rangle \\otimes |\\Phi_{B}\\rangle$. You will analyze the size-extensivity (also called size-consistency) of two different wave function models for the ground-state energy under these conditions.\n\n- In coupled cluster with singles and doubles (CCSD), the ansatz is $|\\Psi\\rangle = \\exp(T) |\\Phi\\rangle$ with $T = T_{1} + T_{2}$, and the energy is $E = \\langle\\Phi| \\exp(-T) H \\exp(T) |\\Phi\\rangle$ with amplitudes determined by the projected equations that set the singly and doubly excited residuals to zero.\n- In configuration interaction with singles and doubles (CISD), the ansatz is $|\\Psi\\rangle = (1 + C_{1} + C_{2}) |\\Phi\\rangle$, and the energy is obtained variationally from the Rayleigh–Ritz principle within the given configuration space.\n\nPart I (derivation from first principles): Starting from the operator additivity $H = H_{A} + H_{B}$ and the fact that the one-particle Hilbert spaces of $A$ and $B$ are disjoint in the noninteracting limit, show that in CCSD the cluster operator separates as $T = T_{A} + T_{B}$ with $[T_{A},T_{B}] = 0$ and $[H_{A},T_{B}] = [H_{B},T_{A}] = 0$. Use these commutation relations, the Baker–Campbell–Hausdorff expansion, and the definition of the CC energy to demonstrate that the CCSD ground-state energy of the supersystem equals the sum of the monomer CCSD energies, i.e., $E_{\\mathrm{CCSD}}(AB) = E_{\\mathrm{CCSD}}(A) + E_{\\mathrm{CCSD}}(B)$.\n\nPart II (explicit minimal model for truncated configuration interaction): Consider a minimal independent-fragment model for helium in which each monomer has one doubly occupied spatial orbital $i$ and one virtual spatial orbital $a$. Define the monomer orbital energy gap $\\Delta = 2(\\varepsilon_{a} - \\varepsilon_{i})$ and a single nonzero coupling matrix element $V = \\langle ii || aa \\rangle$ that mixes the Hartree–Fock reference $|\\Phi\\rangle$ and the double excitation $|D\\rangle$. For the monomer CISD problem in the basis $\\{|\\Phi\\rangle, |D\\rangle\\}$, the Hamiltonian matrix is\n$$\nH_{\\text{mono}} = \\begin{pmatrix}\nE_{0} & V \\\\\nV & E_{0} + \\Delta\n\\end{pmatrix},\n$$\nwith $E_{0}$ the Hartree–Fock energy. For the dimer CISD in the truncated space that excludes simultaneous double excitations on both fragments (which would be a quadruple excitation relative to $|\\Phi_{AB}\\rangle$), use the basis $\\{|\\Phi_{A}\\Phi_{B}\\rangle, |D_{A}\\Phi_{B}\\rangle, |\\Phi_{A}D_{B}\\rangle\\}$ and write down the $3 \\times 3$ Hamiltonian. Diagonalize it to obtain the lowest eigenvalue and then compare it to twice the monomer CISD lowest eigenvalue. Derive the leading nonvanishing term of the size-extensivity error for CISD,\n$$\n\\Delta_{\\text{size}}^{\\text{CISD}} \\equiv E_{\\text{CISD}}(AB) - E_{\\text{CISD}}(A) - E_{\\text{CISD}}(B),\n$$\nas a series in the small ratio $V/\\Delta$ up to order $(V/\\Delta)^{4}$.\n\nReport the CCSD size-extensivity error,\n$$\n\\Delta_{\\text{size}}^{\\text{CCSD}} \\equiv E_{\\text{CCSD}}(AB) - E_{\\text{CCSD}}(A) - E_{\\text{CCSD}}(B),\n$$\nfor the noninteracting helium dimer. Express your final numerical value in hartree. No rounding is needed.", "solution": "The problem requires a two-part analysis comparing the size-extensivity of coupled cluster with singles and doubles (CCSD) and configuration interaction with singles and doubles (CISD), followed by a specific question regarding the CCSD error.\n\nPart I: Proof of CCSD Size-Extensivity\n\nWe are given two non-interacting subsystems, $A$ and $B$, described by a total Hamiltonian $H = H_A + H_B$. The Hartree-Fock reference wave function is a product of the monomer wave functions, $|\\Phi_{AB}\\rangle = |\\Phi_A\\rangle |\\Phi_B\\rangle$. The molecular orbitals of the supersystem can be partitioned into those localized on fragment $A$ and those localized on fragment $B$.\n\nThe cluster operator $T$ is a sum of excitation operators. An excitation operator creates a particle-hole pair. Since the fragments are non-interacting, the Hamiltonian $H$ does not contain any terms that couple orbitals of $A$ with orbitals of $B$. The coupled cluster amplitude equations, which determine the coefficients of the excitation operators in $T$, depend on matrix elements of the form $\\langle \\mu | \\exp(-T) H \\exp(T) | \\Phi_{AB} \\rangle$, where $|\\mu\\rangle$ is an excited determinant. If an excitation involves orbitals from both $A$ and $B$ (a so-called \"mixed\" excitation), the corresponding amplitude will be zero because there is no interaction in $H$ to generate it. Consequently, any excitation in the cluster operator $T$ for the supersystem must be localized entirely on either subsystem $A$ or subsystem $B$. The total cluster operator thus separates into a sum of monomer cluster operators:\n$$\nT = T_A + T_B\n$$\nwhere $T_A$ contains excitations involving only orbitals of $A$, and $T_B$ contains excitations involving only orbitals of $B$.\n\nGiven this separation, we establish the required commutation relations:\n1.  $[T_A, T_B] = 0$: The operators $T_A$ and $T_B$ act on disjoint sets of one-particle orbitals (fermionic creation and annihilation operators). Any two such operators commute.\n2.  $[H_A, T_B] = 0$ and $[H_B, T_A] = 0$: The Hamiltonian $H_A$ acts only on the Hilbert space of subsystem $A$, while the operator $T_B$ acts only on the Hilbert space of subsystem $B$. Operators acting on different, independent spaces commute. The same logic applies to $H_B$ and $T_A$.\n\nThe CCSD energy of the supersystem is given by $E_{\\mathrm{CCSD}}(AB) = \\langle \\Phi_{AB} | \\exp(-T) H \\exp(T) | \\Phi_{AB} \\rangle$. Let us analyze the similarity-transformed Hamiltonian, $\\bar{H} = \\exp(-T) H \\exp(T)$. Using the properties derived above:\n$$\n\\bar{H} = \\exp(-(T_A + T_B))(H_A + H_B)\\exp(T_A + T_B)\n$$\nSince $[T_A, T_B] = 0$, the exponential can be separated: $\\exp(T_A + T_B) = \\exp(T_A)\\exp(T_B)$.\n$$\n\\bar{H} = \\exp(-T_B)\\exp(-T_A)(H_A + H_B)\\exp(T_A)\\exp(T_B)\n$$\n$$\n\\bar{H} = \\exp(-T_B) \\left[ \\exp(-T_A)H_A\\exp(T_A) + \\exp(-T_A)H_B\\exp(T_A) \\right] \\exp(T_B)\n$$\nUsing the commutation relation $[H_B, T_A] = 0$, we have $\\exp(-T_A)H_B\\exp(T_A) = H_B$. So,\n$$\n\\bar{H} = \\exp(-T_B) \\left[ \\bar{H}_A + H_B \\right] \\exp(T_B)\n$$\nwhere $\\bar{H}_A = \\exp(-T_A)H_A\\exp(T_A)$ is the transformed Hamiltonian for system $A$. Distributing the terms:\n$$\n\\bar{H} = \\exp(-T_B)\\bar{H}_A\\exp(T_B) + \\exp(-T_B)H_B\\exp(T_B)\n$$\nThe operator $\\bar{H}_A$ is constructed from $H_A$ and $T_A$, and thus acts only on the space of $A$. Therefore, it commutes with $T_B$, i.e., $[\\bar{H}_A, T_B] = 0$. This leads to $\\exp(-T_B)\\bar{H}_A\\exp(T_B) = \\bar{H}_A$. The expression for $\\bar{H}$ simplifies to:\n$$\n\\bar{H} = \\bar{H}_A + \\bar{H}_B\n$$\nwhere $\\bar{H}_B = \\exp(-T_B)H_B\\exp(T_B)$. The transformed Hamiltonian is additive, just like the original Hamiltonian.\n\nNow, we compute the energy:\n$$\nE_{\\mathrm{CCSD}}(AB) = \\langle \\Phi_A \\Phi_B | \\bar{H}_A + \\bar{H}_B | \\Phi_A \\Phi_B \\rangle\n$$\n$$\nE_{\\mathrm{CCSD}}(AB) = \\langle \\Phi_A \\Phi_B | \\bar{H}_A | \\Phi_A \\Phi_B \\rangle + \\langle \\Phi_A \\Phi_B | \\bar{H}_B | \\Phi_A \\Phi_B \\rangle\n$$\nSince $\\bar{H}_A$ acts only on $A$ and $\\bar{H}_B$ acts only on $B$, we can separate the integrals:\n$$\nE_{\\mathrm{CCSD}}(AB) = \\langle \\Phi_A | \\bar{H}_A | \\Phi_A \\rangle \\langle \\Phi_B | \\Phi_B \\rangle + \\langle \\Phi_A | \\Phi_A \\rangle \\langle \\Phi_B | \\bar{H}_B | \\Phi_B \\rangle\n$$\nUsing the normalization condition $\\langle \\Phi_i | \\Phi_i \\rangle = 1$ for $i \\in \\{A, B\\}$, and recognizing the definition of the monomer CCSD energies, $E_{\\mathrm{CCSD}}(A) = \\langle \\Phi_A | \\bar{H}_A | \\Phi_A \\rangle$ and $E_{\\mathrm{CCSD}}(B) = \\langle \\Phi_B | \\bar{H}_B | \\Phi_B \\rangle$, we arrive at the final result:\n$$\nE_{\\mathrm{CCSD}}(AB) = E_{\\mathrm{CCSD}}(A) + E_{\\mathrm{CCSD}}(B)\n$$\nThis demonstrates that CCSD is rigorously size-extensive.\n\nPart II: Analysis of CISD Size-Extensivity Error\n\nWe analyze the minimal model provided for CISD.\nFor the monomer, the basis is $\\{|\\Phi\\rangle, |D\\rangle\\}$ and the Hamiltonian is $H_{\\text{mono}} = \\begin{pmatrix} E_0 & V \\\\ V & E_0 + \\Delta \\end{pmatrix}$. To find the lowest energy eigenvalue, we solve the characteristic equation $\\det(H_{\\text{mono}} - E I) = 0$:\n$$\n(E_0 - E)(E_0 + \\Delta - E) - V^2 = 0\n$$\nLet $E' = E - E_0$. The equation becomes $-E'(\\Delta - E') - V^2 = 0$, or ${E'}^2 - \\Delta E' - V^2 = 0$. The solutions are $E' = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 4V^2}}{2}$. The lowest energy corresponds to the negative root:\n$$\nE_{\\text{CISD}}(\\text{mono}) = E_0 + \\frac{\\Delta - \\sqrt{\\Delta^2 + 4V^2}}{2}\n$$\n\nFor the dimer, the basis is $\\{|\\Phi_A\\Phi_B\\rangle, |D_A\\Phi_B\\rangle, |\\Phi_AD_B\\rangle\\}$. The total Hamiltonian is $H = H_A + H_B$. The matrix elements are:\n$H_{11} = \\langle \\Phi_A\\Phi_B | H_A+H_B | \\Phi_A\\Phi_B \\rangle = E_0 + E_0 = 2E_0$.\n$H_{22} = \\langle D_A\\Phi_B | H_A+H_B | D_A\\Phi_B \\rangle = \\langle D_A|H_A|D_A\\rangle + \\langle\\Phi_B|H_B|\\Phi_B\\rangle = (E_0+\\Delta) + E_0 = 2E_0+\\Delta$.\n$H_{33} = \\langle \\Phi_AD_B | H_A+H_B | \\Phi_AD_B \\rangle = \\langle \\Phi_A|H_A|\\Phi_A\\rangle + \\langle D_B|H_B|D_B\\rangle = E_0 + (E_0+\\Delta) = 2E_0+\\Delta$.\n$H_{12} = \\langle \\Phi_A\\Phi_B | H_A+H_B | D_A\\Phi_B \\rangle = \\langle\\Phi_A|H_A|D_A\\rangle = V$.\n$H_{13} = \\langle \\Phi_A\\Phi_B | H_A+H_B | \\Phi_AD_B \\rangle = \\langle\\Phi_B|H_B|D_B\\rangle = V$.\n$H_{23} = \\langle D_A\\Phi_B | H_A+H_B | \\Phi_AD_B \\rangle = 0$, because $H_A$ and $H_B$ are one-body operators that cannot simultaneously act on different subsystems.\nThe dimer Hamiltonian matrix is:\n$$\nH_{\\text{dimer}} = \\begin{pmatrix} 2E_0 & V & V \\\\ V & 2E_0+\\Delta & 0 \\\\ V & 0 & 2E_0+\\Delta \\end{pmatrix}\n$$\nTo find the lowest eigenvalue $E$, we solve $\\det(H_{\\text{dimer}} - E I) = 0$. Let $E' = E - 2E_0$:\n$$\n\\det \\begin{pmatrix} -E' & V & V \\\\ V & \\Delta-E' & 0 \\\\ V & 0 & \\Delta-E' \\end{pmatrix} = 0\n$$\n$$\n-E'(\\Delta-E')^2 - V(V(\\Delta-E')) - V(-V(\\Delta-E')) = 0\n$$\n$$\n-E'(\\Delta-E')^2 - 2V^2(\\Delta-E') = 0\n$$\n$$\n(\\Delta-E')[-E'(\\Delta-E') - 2V^2] = 0\n$$\nOne solution is $E'=\\Delta$. The other solutions come from ${E'}^2 - \\Delta E' - 2V^2 = 0$, which gives $E' = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 8V^2}}{2}$. The lowest energy eigenvalue for the dimer is:\n$$\nE_{\\text{CISD}}(AB) = 2E_0 + \\frac{\\Delta - \\sqrt{\\Delta^2 + 8V^2}}{2}\n$$\nThe size-extensivity error is $\\Delta_{\\text{size}}^{\\text{CISD}} = E_{\\text{CISD}}(AB) - 2 E_{\\text{CISD}}(\\text{mono})$.\n$$\n\\Delta_{\\text{size}}^{\\text{CISD}} = \\left(2E_0 + \\frac{\\Delta - \\sqrt{\\Delta^2 + 8V^2}}{2}\\right) - 2\\left(E_0 + \\frac{\\Delta - \\sqrt{\\Delta^2 + 4V^2}}{2}\\right)\n$$\n$$\n\\Delta_{\\text{size}}^{\\text{CISD}} = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8V^2}}{2} - (\\Delta - \\sqrt{\\Delta^2 + 4V^2})\n$$\n$$\n\\Delta_{\\text{size}}^{\\text{CISD}} = \\frac{2\\sqrt{\\Delta^2 + 4V^2} - \\sqrt{\\Delta^2 + 8V^2} - \\Delta}{2}\n$$\nTo find the leading nonvanishing term, we perform a series expansion in the small parameter $x = V/\\Delta$:\n$\\sqrt{\\Delta^2 + k V^2} = \\Delta \\sqrt{1 + k(V/\\Delta)^2} = \\Delta (1 + \\frac{k}{2}(V/\\Delta)^2 - \\frac{k^2}{8}(V/\\Delta)^4 + O((V/\\Delta)^6))$.\n$2\\sqrt{\\Delta^2 + 4V^2} \\approx 2\\Delta(1 + 2(V/\\Delta)^2 - 2(V/\\Delta)^4) = 2\\Delta + 4\\Delta(V/\\Delta)^2 - 4\\Delta(V/\\Delta)^4$.\n$\\sqrt{\\Delta^2 + 8V^2} \\approx \\Delta(1 + 4(V/\\Delta)^2 - 8(V/\\Delta)^4)$.\nSubstituting these into the numerator of $\\Delta_{\\text{size}}^{\\text{CISD}}$:\nNumerator $\\approx (2\\Delta + 4 V^2/\\Delta - 4 V^4/\\Delta^3) - (\\Delta + 4 V^2/\\Delta - 8 V^4/\\Delta^3) - \\Delta$\nNumerator $\\approx (2\\Delta - \\Delta - \\Delta) + (4 V^2/\\Delta - 4 V^2/\\Delta) + (-4 V^4/\\Delta^3 + 8 V^4/\\Delta^3)$\nNumerator $\\approx 0 + 0 + 4 V^4/\\Delta^3$.\nTherefore, the size-extensivity error is:\n$$\n\\Delta_{\\text{size}}^{\\text{CISD}} \\approx \\frac{4V^4/\\Delta^3}{2} = \\frac{2V^4}{\\Delta^3}\n$$\nThis demonstrates that CISD is not size-extensive, with an error that appears at the fourth order in perturbation theory.\n\nFinal Question: CCSD Size-Extensivity Error\n\nThe final question asks for the CCSD size-extensivity error, $\\Delta_{\\text{size}}^{\\text{CCSD}} \\equiv E_{\\text{CCSD}}(AB) - E_{\\text{CCSD}}(A) - E_{\\text{CCSD}}(B)$, for the noninteracting helium dimer.\nAs rigorously proven in Part I, the CCSD method is size-extensive for any pair of non-interacting systems. This result is general and applies directly to the case of two non-interacting helium atoms. The additivity of the energy, $E_{\\mathrm{CCSD}}(AB) = E_{\\mathrm{CCSD}}(A) + E_{\\mathrm{CCSD}}(B)$, holds exactly. Therefore, the size-extensivity error is identically zero.\n$$\n\\Delta_{\\text{size}}^{\\text{CCSD}} = 0\n$$\nThe problem asks for this value to be expressed in hartree. The numerical value is 0.", "answer": "$$\n\\boxed{0}\n$$", "id": "2632869"}, {"introduction": "The high accuracy of coupled cluster methods comes at a steep computational price, which often limits their application. This practice demystifies these computational demands by guiding you through a formal scaling analysis. By inspecting the key tensor contractions in the CCSD and EOM-EE-CCSD equations, you will derive the polynomial scaling laws for both CPU time and memory, a fundamental skill for any computational chemist planning research.", "problem": "Consider a closed-shell molecular system treated in the canonical Hartree–Fock molecular orbital basis. Let the number of occupied spin orbitals be denoted by $n_{o}$ and the number of virtual spin orbitals be denoted by $n_{v}$. Define $n \\equiv n_{o}+n_{v}$. You will analyze the coupled cluster with single and double excitations (CCSD) and the Equation-of-Motion for Excitation Energies at the CCSD level (EOM-EE-CCSD) using index-loop analysis to determine the formal computational cost and memory requirements.\n\nFundamental bases and definitions:\n- The coupled cluster ansatz is $|\\Psi\\rangle=\\exp(\\hat{T})|\\Phi_{0}\\rangle$ with the cluster operator truncated at singles and doubles, $\\hat{T}=\\hat{T}_{1}+\\hat{T}_{2}$. The amplitude equations are obtained by projecting $\\langle\\Phi_{0}|(1+\\hat{\\Lambda})\\exp(-\\hat{T})\\hat{H}\\exp(\\hat{T})$ onto the singly and doubly excited determinants, yielding tensor contractions over occupied indices $i,j,m,n\\in\\{1,\\dots,n_{o}\\}$ and virtual indices $a,b,e,f\\in\\{1,\\dots,n_{v}\\}$.\n- The Equation-of-Motion coupled cluster for excitation energies represents excited states as $|\\Psi_{k}\\rangle=\\hat{R}_{k}\\exp(\\hat{T})|\\Phi_{0}\\rangle$ with $\\hat{R}_{k}=\\hat{R}_{1}+\\hat{R}_{2}$, where $\\hat{R}_{1}$ and $\\hat{R}_{2}$ contain amplitudes $r_{i}^{a}$ and $r_{ij}^{ab}$, respectively. The excitation energies follow from a non-Hermitian eigenvalue problem formulated via $\\bar{H}\\hat{R}_{k}|\\Phi_{0}\\rangle=\\omega_{k}\\hat{R}_{k}|\\Phi_{0}\\rangle$, where $\\bar{H}=\\exp(-\\hat{T})\\hat{H}\\exp(\\hat{T})$.\n- Two-electron integrals in the molecular orbital basis are stored as the antisymmetrized tensor $v_{pq}^{rs}$ with spin-orbital indices $p,q,r,s\\in\\{1,\\dots,n\\}$, and are assumed to be explicitly stored without density fitting or Cholesky factorization.\n- For operation counts, assume conventional spin-orbital tensor contractions without spin adaptation, count scalar multiply-adds per contraction, ignore constant multiplicative factors and permutation symmetries, and focus on the key contractions that determine the asymptotic scaling.\n\nTasks:\n1) Using index-loop analysis, derive the leading-order floating-point operation count for one CCSD amplitude-update iteration by identifying the dominant tensor contractions in the doubles equations. Give your answer as an algebraic expression in $n_{o}$ and $n_{v}$ that includes all distinct leading terms arising from contractions that sum over two virtual indices and, separately, over two occupied indices.\n2) Using index-loop analysis, derive the leading-order floating-point operation count for one $\\boldsymbol{\\sigma}=\\bar{H}\\mathbf{r}$ build in EOM-EE-CCSD (that is, the application of the similarity-transformed Hamiltonian to a trial vector comprising singles and doubles components). Include the analogous dominant contractions and provide the algebraic expression in $n_{o}$ and $n_{v}$.\n3) Determine the formal memory required to store simultaneously the following tensors during a CCSD iteration: the two-electron integrals $v_{pq}^{rs}$, the singles amplitudes $t_{i}^{a}$, and the doubles amplitudes $t_{ij}^{ab}$. Express your result in $n_{o}$ and $n_{v}$, counting only the number of real scalar elements to be stored and ignoring constant factors from symmetry.\n4) Determine the formal memory required to store, in addition to the CCSD data above, one EOM trial vector and one corresponding $\\boldsymbol{\\sigma}$ vector, each with singles and doubles blocks, that is, $r_{i}^{a}$, $r_{ij}^{ab}$, $\\sigma_{i}^{a}$, and $\\sigma_{ij}^{ab}$, all stored simultaneously with $v_{pq}^{rs}$, $t_{i}^{a}$, and $t_{ij}^{ab}$.\n\nReport your final results as four algebraic expressions in the order:\n- $C_{\\mathrm{CCSD}}$ (one-iteration CCSD cost),\n- $M_{\\mathrm{CCSD}}$ (CCSD memory),\n- $C_{\\mathrm{EOM}}$ (one $\\boldsymbol{\\sigma}$-build cost in EOM-EE-CCSD),\n- $M_{\\mathrm{EOM}}$ (EOM-EE-CCSD memory with one trial and one $\\boldsymbol{\\sigma}$ vector).\n\nProvide your final answer as a single row matrix $\\begin{pmatrix}C_{\\mathrm{CCSD}} & M_{\\mathrm{CCSD}} & C_{\\mathrm{EOM}} & M_{\\mathrm{EOM}}\\end{pmatrix}$. No rounding is required. Units are the number of real scalar floating-point operations for costs and the number of real scalars stored for memory.", "solution": "The analysis hinges on identifying the computational complexity of tensor contractions within the coupled cluster with singles and doubles (CCSD) and equation-of-motion CCSD (EOM-EE-CCSD) theories. The number of occupied spin-orbitals is $n_o$ and the number of virtual spin-orbitals is $n_v$. Occupied indices are denoted by $i, j, m, n$, and virtual indices by $a, b, e, f$. We are instructed to count floating-point operations (multiply-adds) for the leading-order terms and the number of scalar elements for memory storage, based on a spin-orbital formulation without exploiting symmetry.\n\n**Task 1: Computational Cost of one CCSD Iteration ($C_{\\mathrm{CCSD}}$)**\n\nThe computational cost of a single CCSD iteration is dominated by the update of the doubles amplitudes, $t_{ij}^{ab}$. The equations for these amplitudes are derived by projecting the Schrödinger equation, premultiplied by $\\exp(-\\hat{T})$, onto the space of doubly excited determinants: $\\langle \\Phi_{ij}^{ab} | \\exp(-\\hat{T})\\hat{H}\\exp(\\hat{T}) | \\Phi_0 \\rangle = 0$. The resulting expressions involve numerous tensor contractions. The problem requires identifying the leading-order costs from two specific classes of contractions: those summing over two virtual indices and those summing over two occupied indices.\n\n1.  **Contraction over two virtual indices:** This contribution arises from terms involving the contraction of the four-virtual block of the two-electron integrals, $v_{ef}^{ab}$, with the doubles amplitudes, $t_{ij}^{ef}$. A representative term is $\\sum_{e,f} v_{ef}^{ab} t_{ij}^{ef}$. To compute all elements of the resulting tensor, one must loop over external indices $i,j,a,b$ and internal summation indices $e,f$.\n    The number of floating-point operations is determined by the product of the ranges of all indices:\n    $$ \\text{Cost}_1 = n_o \\times n_o \\times n_v \\times n_v \\times n_v \\times n_v = n_o^2 n_v^4 $$\n\n2.  **Contraction over two occupied indices:** This contribution originates from terms involving the four-occupied block of the two-electron integrals, $v_{ij}^{mn}$, with the doubles amplitudes, $t_{mn}^{ab}$. A representative term is $\\sum_{m,n} v_{ij}^{mn} t_{mn}^{ab}$. The operation count is determined by loops over external indices $i,j,a,b$ and internal summation indices $m,n$.\n    The number of floating-point operations is:\n    $$ \\text{Cost}_2 = n_o \\times n_o \\times n_v \\times n_v \\times n_o \\times n_o = n_o^4 n_v^2 $$\n\nThe total leading-order cost for one CCSD iteration, $C_{\\mathrm{CCSD}}$, is the sum of these contributions.\n$$ C_{\\mathrm{CCSD}} = n_o^2 n_v^4 + n_o^4 n_v^2 $$\n\n**Task 2: Computational Cost of one EOM-EE-CCSD $\\sigma$-build ($C_{\\mathrm{EOM}}$)**\n\nIn the EOM-EE-CCSD method, excitation energies are found by solving the eigenvalue problem $\\bar{H}\\mathbf{r} = \\omega \\mathbf{r}$, where $\\bar{H} = \\exp(-\\hat{T})\\hat{H}\\exp(\\hat{T})$ and $\\mathbf{r}$ is a vector of excitation amplitudes. This is typically solved iteratively, requiring repeated calculation of the matrix-vector product $\\boldsymbol{\\sigma} = \\bar{H}\\mathbf{r}$. The vector $\\mathbf{r}$ has components $r_i^a$ and $r_{ij}^{ab}$.\n\nThe cost of this operation is dominated by the action of the doubles-doubles block of $\\bar{H}$ on the doubles part of the vector, $\\mathbf{r}_2$. The structure of the $\\bar{H}$ operator is such that the tensor contractions required to compute $\\sigma_{ij}^{ab}$ are analogous to those required for the CCSD amplitude update. The dominant contractions are:\n\n1.  **Contraction over two virtual indices:** A term of the form $\\sum_{e,f} \\bar{H}_{ij,ab;ij,ef} r_{ij}^{ef}$, where a key contribution to the $\\bar{H}$ matrix element comes from the bare integral $v_{ef}^{ab}$. The formal cost of this contraction, $\\sum_{e,f} v_{ef}^{ab} r_{ij}^{ef}$, is identical in structure to the corresponding CCSD term.\n    $$ \\text{Cost}_1 = n_o^2 n_v^4 $$\n\n2.  **Contraction over two occupied indices:** A term of the form $\\sum_{m,n} \\bar{H}_{ij,ab;mn,ab} r_{mn}^{ab}$, where a key contribution comes from the bare integral $v_{ij}^{mn}$. The formal cost of this contraction, $\\sum_{m,n} v_{ij}^{mn} r_{mn}^{ab}$, is also identical in structure to its CCSD counterpart.\n    $$ \\text{Cost}_2 = n_o^4 n_v^2 $$\n\nThe total leading-order cost for one EOM-EE-CCSD $\\boldsymbol{\\sigma}$-vector build, $C_{\\mathrm{EOM}}$, is the sum of these analogous dominant terms.\n$$ C_{\\mathrm{EOM}} = n_o^2 n_v^4 + n_o^4 n_v^2 $$\n\n**Task 3: Memory Requirement for CCSD ($M_{\\mathrm{CCSD}}$)**\n\nThe formal memory requirement is the number of scalar elements needed to store the specified tensors simultaneously. We ignore constant factors from symmetry as instructed.\n\n1.  **Two-electron integrals $v_{pq}^{rs}$:** The indices $p,q,r,s$ run over all $n = n_o+n_v$ spin-orbitals. The problem states these are explicitly stored. The total number of elements is $n^4$.\n    $$ \\text{Storage}(v) = (n_o + n_v)^4 $$\n\n2.  **Singles amplitudes $t_i^a$:** The index $i$ runs over $n_o$ occupied orbitals and $a$ runs over $n_v$ virtual orbitals.\n    $$ \\text{Storage}(t_1) = n_o n_v $$\n\n3.  **Doubles amplitudes $t_{ij}^{ab}$:** The indices $i,j$ run over $n_o$ occupied orbitals and $a,b$ run over $n_v$ virtual orbitals.\n    $$ \\text{Storage}(t_2) = n_o^2 n_v^2 $$\n\nThe total memory for the CCSD calculation, $M_{\\mathrm{CCSD}}$, is the sum of these quantities.\n$$ M_{\\mathrm{CCSD}} = (n_o + n_v)^4 + n_o^2 n_v^2 + n_o n_v $$\n\n**Task 4: Memory Requirement for EOM-EE-CCSD ($M_{\\mathrm{EOM}}$)**\n\nFor the EOM-EE-CCSD calculation, we must store the tensors from the CCSD calculation, plus one trial vector $\\mathbf{r}$ and one $\\boldsymbol{\\sigma}$ vector. Each of these vectors has a singles and a doubles component.\n\n1.  **Trial vector $\\mathbf{r}$:**\n    -   Singles part $r_i^a$: $n_o n_v$ elements.\n    -   Doubles part $r_{ij}^{ab}$: $n_o^2 n_v^2$ elements.\n    Total storage for $\\mathbf{r}$ is $n_o n_v + n_o^2 n_v^2$.\n\n2.  **Sigma vector $\\boldsymbol{\\sigma}$:**\n    -   Singles part $\\sigma_i^a$: $n_o n_v$ elements.\n    -   Doubles part $\\sigma_{ij}^{ab}$: $n_o^2 n_v^2$ elements.\n    Total storage for $\\boldsymbol{\\sigma}$ is $n_o n_v + n_o^2 n_v^2$.\n\nThe total memory for the EOM-EE-CCSD calculation, $M_{\\mathrm{EOM}}$, is $M_{\\mathrm{CCSD}}$ plus the storage for these two additional vectors.\n$$ M_{\\mathrm{EOM}} = M_{\\mathrm{CCSD}} + 2(n_o n_v + n_o^2 n_v^2) $$\n$$ M_{\\mathrm{EOM}} = ((n_o + n_v)^4 + n_o^2 n_v^2 + n_o n_v) + 2(n_o^2 n_v^2 + n_o n_v) $$\n$$ M_{\\mathrm{EOM}} = (n_o + n_v)^4 + 3n_o^2 n_v^2 + 3n_o n_v $$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nn_{o}^{2} n_{v}^{4} + n_{o}^{4} n_{v}^{2} & (n_{o} + n_{v})^{4} + n_{o}^{2} n_{v}^{2} + n_{o} n_{v} & n_{o}^{2} n_{v}^{4} + n_{o}^{4} n_{v}^{2} & (n_{o} + n_{v})^{4} + 3 n_{o}^{2} n_{v}^{2} + 3 n_{o} n_{v}\n\\end{pmatrix}\n}\n$$", "id": "2632889"}, {"introduction": "Coupled cluster methods are built upon a single-reference assumption, which can fail dramatically for systems with significant static correlation. This exercise focuses on the vital practical skill of diagnosing such failures before drawing incorrect scientific conclusions. By interpreting common diagnostics like the $T_1$ norm and natural orbital occupations for two distinct molecular systems, you will learn to identify when a CCSD calculation is reliable and when a more sophisticated multireference treatment is necessary.", "problem": "A central assumption behind single-reference Coupled Cluster (CC) theory is that the exact many-electron wavefunction is well described by a dominant single Slater determinant (often the Hartree–Fock (HF) determinant), with correlation captured by excitations acting on that reference. Equation-of-Motion Coupled Cluster (EOM-CC) methods for excited states rely on the same reference, with EOM-CC with singles and doubles (EOM-CCSD) being accurate when target states are dominated by one-particle–one-hole character. When nondynamical (static) correlation is significant and more than one determinant contributes strongly, diagnostics such as the CC singles-amplitude norms and natural orbital occupations can reveal multireference character and warn of potential CC/EOM-CC breakdown.\n\nConsider two neutral, closed-shell molecules, system X and system Y. For each, a CC with singles and doubles (CCSD) ground-state calculation is performed with canonical restricted HF orbitals and a balanced valence basis. From the converged CCSD solution, the following quantities are extracted: the so-called $T_1$ and $D_1$ diagnostics that measure, in different ways, the overall magnitude or principal component of the CC singles amplitudes, and the natural orbital occupations from the one-particle reduced density matrix of the correlated ground state. You are given the following data:\n\n- System X: $T_1 = 0.011$, $D_1 = 0.028$, highest occupied natural orbital (HONO) occupation $n_{\\text{HONO}} = 1.98$, lowest unoccupied natural orbital (LUNO) occupation $n_{\\text{LUNO}} = 0.02$.\n- System Y: $T_1 = 0.051$, $D_1 = 0.089$, $n_{\\text{HONO}} = 1.22$, $n_{\\text{LUNO}} = 0.78$.\n\nAssume both systems are electronically well behaved (no severe intruder-state problems or symmetry breaking in the reference for X), the basis qualitatively describes the valence space, and all computations are converged. Based on fundamental definitions and qualitative trends, choose the statements that are most justified:\n\nA. For system X, the proximity of $n_{\\text{HONO}}$ and $n_{\\text{LUNO}}$ to $2$ and $0$, respectively, together with modest $T_1$ and $D_1$, is consistent with a dominant single-determinant character; ground-state energetics from CC with singles, doubles, and perturbative triples (CCSD(T)) are likely reliable, and EOM-CCSD should be accurate for low-lying singly excited states built on X.\n\nB. For system Y, the large $T_1$ and $D_1$ together with near-half occupations indicate strong nondynamical correlation; single-reference EOM-CCSD may incur large errors for states with significant double-excitation or polyradical character, so a multireference treatment (e.g., Complete Active Space Self-Consistent Field (CASSCF) followed by second-order perturbation, or spin-flip EOM-CCSD) is advisable.\n\nC. The $D_1$ diagnostic is strictly size extensive and is guaranteed to be smaller than $T_1$ for any system; therefore, $D_1$ is universally a safer, system-size-independent indicator than $T_1$.\n\nD. If one transforms to Brueckner orbitals that nullify the CCSD singles amplitudes, then both $T_1$ and $D_1$ vanish even when the state is strongly multireference; therefore, these diagnostics cannot be used to detect multireference character.\n\nE. For open-shell analogs of Y, it is appropriate to use the same closed-shell threshold heuristics (e.g., $T_1 \\approx 0.02$) to judge reliability; unusually high diagnostic values in such cases primarily reflect basis-set incompleteness rather than genuine nondynamical correlation.\n\nSelect all that apply.", "solution": "The solution requires interpreting standard diagnostics for static (nondynamical) correlation to assess the reliability of single-reference coupled cluster methods for the two systems, X and Y. A single-reference approach is appropriate when the electronic wavefunction is dominated by one Slater determinant, as indicated by small diagnostic values and natural orbital occupations (NOOs) close to integer values (2 for occupied, 0 for virtual in a closed-shell system).\n\n- The **$T_1$ diagnostic** measures the norm of the single-excitation amplitudes. A common heuristic for closed-shell systems suggests that values greater than 0.02 indicate significant static correlation and a poor Hartree-Fock reference.\n- **Natural Orbital Occupations (NOOs)** deviating significantly from 2 and 0 also signal strong static correlation, as they reflect the mixing of multiple determinants in the true wavefunction.\n\n**Analysis of the Options:**\n\n**A. Correct.** System X shows a $T_1$ diagnostic of 0.011 (below the 0.02 threshold) and HONO/LUNO occupations of 1.98/0.02 (very close to the ideal 2/0). These data points strongly suggest that System X has a dominant single-determinant character. Consequently, high-accuracy single-reference methods like CCSD(T) for the ground state and EOM-CCSD for low-lying, predominantly single-excitation states are expected to be reliable.\n\n**B. Correct.** System Y exhibits a large $T_1$ diagnostic of 0.051 and HONO/LUNO occupations of 1.22/0.78. These values are classic indicators of strong nondynamical correlation, typical of systems with diradical character or stretched bonds where multiple determinants are nearly degenerate. For such systems, single-reference CCSD and EOM-CCSD are prone to large errors. A more robust multireference treatment, such as CASSCF/CASPT2 or spin-flip EOM-CCSD, is necessary for a qualitatively correct description.\n\n**C. Incorrect.** This statement claims that $D_1$ is guaranteed to be smaller than $T_1$. However, the data for system X provides a counterexample ($D_1 = 0.028 > T_1 = 0.011$). The relative size of the $T_1$ (a root-mean-square average) and $D_1$ (the maximum amplitude) diagnostics depends on the distribution of the $t_1$ amplitudes.\n\n**D. Incorrect.** While it is true that using Brueckner orbitals will, by definition, make the $t_1$ amplitudes (and thus $T_1$ and $D_1$) vanish, this does not invalidate their use as diagnostics. The purpose of these diagnostics is to assess the quality of a standard reference, typically the Hartree-Fock determinant. A large deviation between the HF orbitals and the Brueckner orbitals is itself a strong indicator of multireference character. The statement misrepresents the context in which these diagnostics are used.\n\n**E. Incorrect.** The heuristic thresholds for diagnostics like $T_1$ are generally relaxed for open-shell systems compared to closed-shell systems, not kept the same. Furthermore, while basis set incompleteness is a source of error, unusually high diagnostic values are primary indicators of electronic structure effects (i.e., genuine nondynamical correlation), not basis set issues.\n\nBased on this analysis, statements A and B are the only ones that are justified.", "answer": "$$\\boxed{AB}$$", "id": "2632927"}]}