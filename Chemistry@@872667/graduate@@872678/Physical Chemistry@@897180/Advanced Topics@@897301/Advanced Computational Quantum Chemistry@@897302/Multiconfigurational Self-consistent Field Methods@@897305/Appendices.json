{"hands_on_practices": [{"introduction": "A crucial first step in any MCSCF calculation is defining the active space. This exercise provides fundamental practice in using molecular symmetry, a powerful tool for systematically constructing and classifying the orbitals and electronic states that constitute the active space. By working through the example of ethylene's $\\pi$-system, you will see how group theory helps to simplify the multiconfigurational problem and provides deep insight into the electronic structure.", "problem": "Ethylene is planar and belongs to the point group $D_{2h}$. Adopt the standard $D_{2h}$ axis convention: the molecular plane is the $xy$-plane, the carbon–carbon double bond lies along the $x$-axis, and the $z$-axis is perpendicular to the molecular plane. In a minimal complete active space with two electrons in two spatial orbitals, denoted $\\mathrm{CAS}(2,2)$, choose the active orbitals to be the $\\pi$ and $\\pi^{\\ast}$ orbitals arising from the two carbon $p_{z}$ atomic orbitals.\n\nStarting from the definitions of symmetry-adapted linear combinations and irreducible representations, and using only character properties of the $D_{2h}$ operations $C_{2}(x)$, $C_{2}(y)$, $C_{2}(z)$, and inversion $i$, do the following:\n\n1. Construct the two symmetry-adapted linear combinations of the two $p_{z}$ atomic orbitals and determine their transformation properties under $C_{2}(x)$, $C_{2}(y)$, $C_{2}(z)$, and $i$. Assign the corresponding $D_{2h}$ irreducible representations to the bonding $\\pi$ and antibonding $\\pi^{\\ast}$ molecular orbitals.\n\n2. Form the spin-adapted singlet configuration state functions that can be built within the $\\mathrm{CAS}(2,2)$ space and use direct products of irreducible representations to assign the spatial symmetry to each singlet configuration.\n\nWhat is the dimension of the spin-adapted singlet $\\mathrm{A}_{g}$ subspace of the corresponding complete active space configuration interaction (CAS-CI) problem? Provide your final answer as a single integer with no units. If you obtain a numerical value, do not round it.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n**Step 1: Extract Givens**\n- Molecule: Ethylene ($\\mathrm{C}_2\\mathrm{H}_4$)\n- Point group: $D_{2h}$\n- Axis convention: The molecular plane is the $xy$-plane, the carbon–carbon double bond lies along the $x$-axis, and the $z$-axis is perpendicular to the molecular plane.\n- Active space: $\\mathrm{CAS}(2,2)$, two electrons in two spatial orbitals.\n- Active orbitals: $\\pi$ and $\\pi^{\\ast}$ orbitals derived from the two carbon $p_{z}$ atomic orbitals.\n- Operations for analysis: $C_{2}(x)$, $C_{2}(y)$, $C_{2}(z)$, and inversion $i$.\n- Task 1: Construct symmetry-adapted linear combinations (SALCs) of the two $p_{z}$ atomic orbitals, determine their transformation properties under the specified operations, and assign the corresponding $D_{2h}$ irreducible representations (irreps).\n- Task 2: Form spin-adapted singlet configuration state functions (CSFs) within the $\\mathrm{CAS}(2,2)$ space and assign their spatial symmetry.\n- Final question: Determine the dimension of the spin-adapted singlet $\\mathrm{A}_{g}$ subspace of the CAS-CI problem.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Groundedness**: The problem is a standard application of group theory to molecular orbital theory and configuration interaction, a fundamental topic in quantum chemistry. It is scientifically sound.\n- **Well-Posedness**: The problem is well-posed, providing a clear question with sufficient information to derive a unique, integer-valued answer.\n- **Objectivity**: The problem is stated in precise, objective, and technical language.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A rigorous solution will be constructed.\n\nThe solution proceeds in two parts as requested by the problem statement.\n\n**Part 1: Symmetry of Molecular Orbitals**\n\nWe begin by defining the basis. Let the two carbon atoms be denoted $C_A$ and $C_B$. According to the specified axis convention, we place them at coordinates $C_A = (-d, 0, 0)$ and $C_B = (d, 0, 0)$ for some distance $d > 0$. The basis set consists of the two $p_z$ atomic orbitals, $\\phi_A$ centered on $C_A$ and $\\phi_B$ centered on $C_B$. A $p_z$ orbital has the functional form $f(r)z$, which is antisymmetric with respect to the $xy$-plane.\n\nWe analyze the transformation of the basis orbitals $\\phi_A$ and $\\phi_B$ under the specified symmetry operations of the $D_{2h}$ group.\n1.  **$C_{2}(x)$ rotation**: Rotation by $\\pi$ radians about the $x$-axis. The coordinates transform as $(x, y, z) \\rightarrow (x, -y, -z)$. The atoms $C_A$ and $C_B$ lie on the axis and are not exchanged. The $z$ coordinate inverts, so the $p_z$ orbital flips its sign.\n    $$\n    C_{2}(x)\\phi_A = -\\phi_A \\quad ; \\quad C_{2}(x)\\phi_B = -\\phi_B\n    $$\n2.  **$C_{2}(y)$ rotation**: Rotation by $\\pi$ radians about the $y$-axis. The coordinates transform as $(x, y, z) \\rightarrow (-x, y, -z)$. This operation exchanges the carbon atoms, $C_A \\leftrightarrow C_B$. The $z$ coordinate also inverts.\n    $$\n    C_{2}(y)\\phi_A = -\\phi_B \\quad ; \\quad C_{2}(y)\\phi_B = -\\phi_A\n    $$\n3.  **$C_{2}(z)$ rotation**: Rotation by $\\pi$ radians about the $z$-axis. The coordinates transform as $(x, y, z) \\rightarrow (-x, -y, z)$. This operation exchanges the carbon atoms, $C_A \\leftrightarrow C_B$. The $z$ coordinate is unchanged, so the $p_z$ orbital sign is preserved.\n    $$\n    C_{2}(z)\\phi_A = \\phi_B \\quad ; \\quad C_{2}(z)\\phi_B = \\phi_A\n    $$\n4.  **Inversion $i$**: Inversion through the origin $(0, 0, 0)$. The coordinates transform as $(x, y, z) \\rightarrow (-x, -y, -z)$. This operation exchanges the carbon atoms, $C_A \\leftrightarrow C_B$, and inverts the $z$ coordinate.\n    $$\n    i\\phi_A = -\\phi_B \\quad ; \\quad i\\phi_B = -\\phi_A\n    $$\n\nNext, we construct the symmetry-adapted linear combinations (SALCs). These are the bonding ($\\pi$) and antibonding ($\\pi^{\\ast}$) molecular orbitals (MOs). Let $\\psi_1$ be the bonding $\\pi$ MO and $\\psi_2$ be the antibonding $\\pi^{\\ast}$ MO, ignoring normalization constants.\n$$\n\\psi_1 = \\phi_A + \\phi_B \\quad (\\text{bonding } \\pi \\text{ orbital})\n$$\n$$\n\\psi_2 = \\phi_A - \\phi_B \\quad (\\text{antibonding } \\pi^{\\ast} \\text{ orbital})\n$$\nWe determine the irrep for each MO by finding its character under the specified operations.\n\nFor the bonding $\\pi$ orbital, $\\psi_1$:\n- $C_{2}(x)\\psi_1 = C_{2}(x)(\\phi_A + \\phi_B) = -\\phi_A - \\phi_B = -1 \\cdot \\psi_1$. The character is $\\chi(C_{2}(x)) = -1$.\n- $C_{2}(y)\\psi_1 = C_{2}(y)(\\phi_A + \\phi_B) = -\\phi_B - \\phi_A = -1 \\cdot \\psi_1$. The character is $\\chi(C_{2}(y)) = -1$.\n- $C_{2}(z)\\psi_1 = C_{2}(z)(\\phi_A + \\phi_B) = \\phi_B + \\phi_A = +1 \\cdot \\psi_1$. The character is $\\chi(C_{2}(z)) = +1$.\n- $i\\psi_1 = i(\\phi_A + \\phi_B) = -\\phi_B - \\phi_A = -1 \\cdot \\psi_1$. The character is $\\chi(i) = -1$.\nThe characters for $(\\chi(C_{2}(z)), \\chi(C_{2}(y)), \\chi(C_{2}(x)))$ are $(+1, -1, -1)$. The character under inversion is $-1$ (ungerade, $u$). Consulting the $D_{2h}$ character table, the irrep with these characters is $B_{1u}$. Thus, the $\\pi$ orbital has $b_{1u}$ symmetry.\n\nFor the antibonding $\\pi^{\\ast}$ orbital, $\\psi_2$:\n- $C_{2}(x)\\psi_2 = C_{2}(x)(\\phi_A - \\phi_B) = -\\phi_A - (-\\phi_B) = -(\\phi_A - \\phi_B) = -1 \\cdot \\psi_2$. The character is $\\chi(C_{2}(x)) = -1$.\n- $C_{2}(y)\\psi_2 = C_{2}(y)(\\phi_A - \\phi_B) = -\\phi_B - (-\\phi_A) = \\phi_A - \\phi_B = +1 \\cdot \\psi_2$. The character is $\\chi(C_{2}(y)) = +1$.\n- $C_{2}(z)\\psi_2 = C_{2}(z)(\\phi_A - \\phi_B) = \\phi_B - \\phi_A = -(\\phi_A - \\phi_B) = -1 \\cdot \\psi_2$. The character is $\\chi(C_{2}(z)) = -1$.\n- $i\\psi_2 = i(\\phi_A - \\phi_B) = -\\phi_B - (-\\phi_A) = \\phi_A - \\phi_B = +1 \\cdot \\psi_2$. The character is $\\chi(i) = +1$.\nThe characters for $(\\chi(C_{2}(z)), \\chi(C_{2}(y)), \\chi(C_{2}(x)))$ are $(-1, +1, -1)$. The character under inversion is $+1$ (gerade, $g$). Consulting the $D_{2h}$ character table, the irrep with these characters is $B_{2g}$. Thus, the $\\pi^{\\ast}$ orbital has $b_{2g}$ symmetry.\n\n**Part 2: Symmetry of Configuration State Functions and Final Dimension**\n\nThe active space is $\\mathrm{CAS}(2,2)$, with two electrons distributed among the two active orbitals: $\\psi_{b_{1u}}$ ($\\pi$) and $\\psi_{b_{2g}}$ ($\\pi^{\\ast}$). The possible electronic configurations are:\n1.  $(\\psi_{b_{1u}})^2 (\\psi_{b_{2g}})^0$\n2.  $(\\psi_{b_{1u}})^1 (\\psi_{b_{2g}})^1$\n3.  $(\\psi_{b_{1u}})^0 (\\psi_{b_{2g}})^2$\n\nWe are concerned with spin-adapted singlet CSFs. The spatial symmetry of a CSF is determined by the direct product of the irreps of the occupied one-electron orbitals.\n\n1.  **Configuration $(\\psi_{b_{1u}})^2$**: This configuration has a doubly occupied orbital, which uniquely forms a singlet state. The spatial symmetry $\\Gamma_1$ is given by the direct product:\n    $$\n    \\Gamma_1 = B_{1u} \\otimes B_{1u} = A_g\n    $$\n    The direct product of any irrep with itself is always the totally symmetric irrep, $A_g$. This configuration contributes one CSF of $A_g$ symmetry to the singlet manifold.\n\n2.  **Configuration $(\\psi_{b_{1u}})^1 (\\psi_{b_{2g}})^1$**: This configuration of two electrons in two different orbitals gives rise to one singlet state and one triplet state. The spatial symmetry $\\Gamma_2$ of both the singlet and triplet CSFs is given by the direct product:\n    $$\n    \\Gamma_2 = B_{1u} \\otimes B_{2g}\n    $$\n    We find the resulting irrep by multiplying the characters of $B_{1u}$ and $B_{2g}$:\n    - $\\chi(C_{2}(z)) = (+1) \\times (-1) = -1$\n    - $\\chi(C_{2}(y)) = (-1) \\times (+1) = -1$\n    - $\\chi(C_{2}(x)) = (-1) \\times (-1) = +1$\n    - $\\chi(i) = (-1) \\times (+1) = -1$ (ungerade, $u$)\n    The character set $(\\chi(C_{2}(z)), \\chi(C_{2}(y)), \\chi(C_{2}(x))) = (-1,-1,+1)$ corresponds to the $B_3$ representation. Combined with the ungerade parity, the symmetry is $B_{3u}$. This configuration contributes one singlet CSF of $B_{3u}$ symmetry. It does not contribute to the $A_g$ subspace.\n\n3.  **Configuration $(\\psi_{b_{2g}})^2$**: This is another doubly occupied configuration, forming a singlet state. The spatial symmetry $\\Gamma_3$ is:\n    $$\n    \\Gamma_3 = B_{2g} \\otimes B_{2g} = A_g\n    $$\n    This configuration contributes a second CSF of $A_g$ symmetry to the singlet manifold.\n\nThe spin-adapted singlet $A_g$ subspace of the CAS-CI problem is spanned by the singlet CSFs that transform according to the $A_g$ irrep. We have found two such CSFs: one arising from the $(\\psi_{b_{1u}})^2$ configuration and one from the $(\\psi_{b_{2g}})^2$ configuration. These two CSFs form a basis for the $A_g$ singlet block of the CI matrix.\n\nTherefore, the dimension of the spin-adapted singlet $A_g$ subspace is $2$.", "answer": "$$\\boxed{2}$$", "id": "2906791"}, {"introduction": "The true power of MCSCF methods is revealed when they are used to describe chemical processes that involve the near-degeneracy of electronic configurations, such as the breaking of a chemical bond. This thought experiment illustrates how the CASSCF wavefunction correctly adapts its character, smoothly transitioning from a single-reference description at equilibrium to a fundamentally multi-reference one at the dissociation limit. Understanding this evolution is key to recognizing why single-reference methods like Hartree-Fock fail for such systems and why MCSCF is the appropriate theoretical tool.", "problem": "Consider a homonuclear diatomic diradical described within the Born–Oppenheimer approximation by the nonrelativistic electronic Hamiltonian and treated using a Complete Active Space Self-Consistent Field (CASSCF) calculation with an active space of $2$ electrons in $2$ spatial orbitals, denoted $\\mathrm{CAS}(2,2)$. Let the active orbitals be the bonding $\\phi_{g}$ and antibonding $\\phi_{u}$ molecular orbitals for the relevant valence symmetry. Focus on the lowest singlet state. The CASSCF wave function is a linear combination of spin-adapted configuration state functions (CSFs) spanning the singlet sector of the active space,\n$$\n\\vert \\Psi_{\\mathrm{CAS}} \\rangle \\;=\\; c_{1}\\,\\vert \\phi_{g}^{2} \\rangle \\;+\\; c_{2}\\,\\vert \\phi_{g}^{1}\\phi_{u}^{1}; S=0 \\rangle \\;+\\; c_{3}\\,\\vert \\phi_{u}^{2} \\rangle,\n$$\nwith $\\sum_{i=1}^{3}\\lvert c_{i}\\rvert^{2}=1$. The Configuration Interaction (CI) weights are the squared moduli $\\lvert c_{i}\\rvert^{2}$. The natural orbital occupation numbers $n_{p}$ are the eigenvalues of the one-particle reduced density matrix and, for this active space, satisfy $n_{g}+n_{u}=2$.\n\nUsing only fundamental variational reasoning and standard model reductions, analyze the qualitative evolution of the CI weights and the natural occupations as the internuclear distance $R$ increases from near the equilibrium value $R_{e}$ to the dissociation limit $R\\to\\infty$ under state-specific CASSCF orbital optimization. In particular, consider that:\n- Near $R_{e}$, the one-electron gap $\\Delta \\equiv \\epsilon_{u}-\\epsilon_{g}$ is large compared to configuration interaction couplings between the CSFs.\n- As $R$ increases, $\\Delta$ shrinks and the optimal active orbitals can rotate to become localized on the two atomic centers, while on-site electron repulsion remains finite.\n\nWhich of the following best captures the correct qualitative trend for the CI weights $\\lvert c_{i}\\rvert^{2}$ and the natural occupations $\\{n_{g},n_{u}\\}$ along this stretch within CASSCF, and correctly relates this to the emergence of multireference character?\n\nA. Near $R_{e}$, $\\lvert c_{1}\\rvert^{2}\\approx 1$ and $\\lvert c_{2}\\rvert^{2},\\lvert c_{3}\\rvert^{2}\\approx 0$; as $R\\to\\infty$, the variationally optimized orbitals localize and the open-shell CSF dominates with $\\lvert c_{2}\\rvert^{2}\\to 1$ while $\\lvert c_{1}\\rvert^{2},\\lvert c_{3}\\rvert^{2}\\to 0$, and the natural occupations evolve from $\\{n_{g},n_{u}\\}\\approx \\{2,0\\}$ at $R_{e}$ to $\\{1,1\\}$ at dissociation, reflecting strong multireference character.\n\nB. Near $R_{e}$, $\\lvert c_{1}\\rvert^{2}\\approx 1$; as $R\\to\\infty$, the lowest singlet becomes an equal mixture of the two closed-shell CSFs with $\\lvert c_{1}\\rvert^{2}=\\lvert c_{3}\\rvert^{2}=1/2$ and $\\lvert c_{2}\\rvert^{2}=0$, while the natural occupations remain fixed at $\\{2,0\\}$ for all $R$, indicating no change in multireference character.\n\nC. Near $R_{e}$, the antibonding closed-shell configuration is stabilized so $\\lvert c_{3}\\rvert^{2}\\approx 1$; as $R$ increases, $\\lvert c_{1}\\rvert^{2}$ grows and dominates at dissociation, with natural occupations evolving from $\\{0,2\\}$ at $R_{e}$ to $\\{2,0\\}$ at dissociation, indicating decreasing multireference character.\n\nD. The CI weights are invariant with $R$ in CASSCF because the active space is fixed, so $\\lvert c_{i}\\rvert^{2}$ and $\\{n_{g},n_{u}\\}$ do not change along the stretch; multireference character is constant.\n\nE. As $R\\to\\infty$, all three CSFs acquire equal weight $\\lvert c_{1}\\rvert^{2}=\\lvert c_{2}\\rvert^{2}=\\lvert c_{3}\\rvert^{2}=1/3$, and the natural occupations approach $\\{4/3,2/3\\}$, reflecting maximal multireference character.", "solution": "The problem statement must first be validated for scientific soundness and consistency.\n\n### Step 1: Extract Givens\n\n-   **System**: A homonuclear diatomic diradical.\n-   **Theoretical Framework**: Born–Oppenheimer approximation, nonrelativistic electronic Hamiltonian.\n-   **Method**: Complete Active Space Self-Consistent Field (CASSCF) with a $(2,2)$ active space, meaning $2$ electrons in $2$ spatial orbitals.\n-   **Active Orbitals**: Bonding $\\phi_{g}$ and antibonding $\\phi_{u}$ molecular orbitals.\n-   **State of Interest**: The lowest singlet state.\n-   **Wave Function Ansatz**: $\\vert \\Psi_{\\mathrm{CAS}} \\rangle = c_{1}\\,\\vert \\phi_{g}^{2} \\rangle + c_{2}\\,\\vert \\phi_{g}^{1}\\phi_{u}^{1}; S=0 \\rangle + c_{3}\\,\\vert \\phi_{u}^{2} \\rangle$, where $\\sum_{i=1}^{3}\\lvert c_{i}\\rvert^{2}=1$.\n-   **observables**: Configuration Interaction (CI) weights $\\lvert c_{i}\\rvert^{2}$ and natural orbital occupation numbers (NOONs) $\\{n_{g}, n_{u}\\}$.\n-   **NOON Constraint**: $n_{g}+n_{u}=2$.\n-   **Condition at Equilibrium ($R_e$)**: The one-electron gap $\\Delta \\equiv \\epsilon_{u}-\\epsilon_{g}$ is large.\n-   **Condition at Dissociation ($R\\to\\infty$)**: $\\Delta$ shrinks, orbitals can localize.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientific Grounding**: The problem describes the dissociation of a chemical bond in a homonuclear diatomic molecule, a canonical example for illustrating the necessity of multiconfigurational methods. The CAS(2,2) model is the minimal correct model for this process. All terms—CASSCF, CSF, CI weights, natural orbitals, Born-Oppenheimer approximation—are standard and correctly used. The description of orbital energy gaps and localization is qualitatively accurate. The problem is scientifically sound.\n-   **Well-Posedness and Objectivity**: The problem is well-posed, asking for a qualitative analysis of a well-defined process within a standard theoretical model. The language is objective and precise.\n-   **Completeness and Consistency**: The problem provides sufficient information for a qualitative analysis based on fundamental principles of quantum chemistry. There are no internal contradictions.\n\n### Step 3: Verdict and Action\n\nThe problem statement is valid. I will proceed with a full derivation and analysis.\n\n### Derivation of the Correct Physical Behavior\n\nThe CASSCF method variationally optimizes both the CI coefficients $\\{c_i\\}$ and the molecular orbitals $\\{\\phi_p\\}$ to minimize the energy for a specific electronic state. Here, we analyze the lowest singlet state. For a homonuclear diatomic molecule (point group $D_{\\infty h}$), symmetry considerations are critical.\n\nThe CSFs given span the singlet manifold of the $(2,2)$ active space. We must determine their symmetries. The orbitals have symmetries $\\phi_g \\in \\Sigma_g$ and $\\phi_u \\in \\Sigma_u$ (assuming a $\\sigma$ bond).\n-   $\\vert \\phi_{g}^{2} \\rangle$: This closed-shell configuration has symmetry $\\Sigma_g \\otimes \\Sigma_g = \\Sigma_g$. Spin part is singlet. Overall state symmetry is $^1\\Sigma_g^+$.\n-   $\\vert \\phi_{u}^{2} \\rangle$: This closed-shell configuration has symmetry $\\Sigma_u \\otimes \\Sigma_u = \\Sigma_g$. Spin part is singlet. Overall state symmetry is $^1\\Sigma_g^+$.\n-   $\\vert \\phi_{g}^{1}\\phi_{u}^{1}; S=0 \\rangle$: This open-shell configuration has spatial symmetry $\\Sigma_g \\otimes \\Sigma_u = \\Sigma_u$. Spin part is singlet. Overall state symmetry is $^1\\Sigma_u^+$.\n\nThe electronic Hamiltonian is totally symmetric. Therefore, it does not mix states of different symmetries. The lowest electronic state of a typical homonuclear diatomic molecule like $\\mathrm{H}_2$ is of $^1\\Sigma_g^+$ symmetry for all internuclear distances $R$. Consequently, its wave function can only be a linear combination of CSFs with $^1\\Sigma_g^+$ symmetry. This imposes the constraint that $c_{2}=0$ for all $R$.\n\nThe wave function for the lowest singlet state is correctly written as:\n$$\n\\vert \\Psi_{\\mathrm{CAS}} \\rangle \\;=\\; c_{1}\\,\\vert \\phi_{g}^{2} \\rangle \\;+\\; c_{3}\\,\\vert \\phi_{u}^{2} \\rangle\n$$\nwith $\\lvert c_{1}\\rvert^{2} + \\lvert c_{3}\\rvert^{2}=1$.\n\nThe natural orbital occupation numbers (NOONs) are the expectation values of the number operators for each orbital. They are given by:\n$n_{g} = \\langle \\Psi_{\\mathrm{CAS}} | \\hat{n}_g | \\Psi_{\\mathrm{CAS}} \\rangle = 2\\lvert c_{1}\\rvert^{2} + 1\\lvert c_{2}\\rvert^{2} + 0\\lvert c_{3}\\rvert^{2}$\n$n_{u} = \\langle \\Psi_{\\mathrm{CAS}} | \\hat{n}_u | \\Psi_{\\mathrm{CAS}} \\rangle = 0\\lvert c_{1}\\rvert^{2} + 1\\lvert c_{2}\\rvert^{2} + 2\\lvert c_{3}\\rvert^{2}$\nWith $c_{2}=0$, these simplify to $n_{g} = 2\\lvert c_{1}\\rvert^{2}$ and $n_{u} = 2\\lvert c_{3}\\rvert^{2}$.\n\nLet us analyze the two limits:\n\n1.  **Near Equilibrium ($R \\approx R_e$)**: The energy gap $\\Delta = \\epsilon_{u}-\\epsilon_{g}$ is large. To minimize the energy, the system will preferentially occupy the lowest-energy orbital, $\\phi_g$. The ground state is therefore dominated by the Hartree-Fock-like configuration $\\vert \\phi_{g}^{2} \\rangle$.\n    -   **CI Weights**: $\\lvert c_{1}\\rvert^{2} \\approx 1$ and $\\lvert c_{3}\\rvert^{2} \\approx 0$.\n    -   **NOONs**: $n_{g} \\approx 2(1)=2$ and $n_{u} \\approx 2(0)=0$.\n    -   **Character**: The system is of single-reference character.\n\n2.  **At Dissociation ($R \\to \\infty$)**: The molecule separates into two neutral atoms, each with one of the active electrons. The orbitals $\\phi_g$ and $\\phi_u$ become degenerate combinations of the atomic orbitals $\\chi_A$ and $\\chi_B$: $\\phi_g \\propto (\\chi_A + \\chi_B)$ and $\\phi_u \\propto (\\chi_A - \\chi_B)$.\n    A correct description of two neutral atoms requires the total wave function to be purely covalent, with no ionic contributions like $\\mathrm{A}^+\\mathrm{B}^-$ or $\\mathrm{A}^-\\mathrm{B}^+$. Expressing the CSFs in terms of atomic orbitals reveals that both $\\vert \\phi_{g}^{2} \\rangle$ and $\\vert \\phi_{u}^{2} \\rangle$ contain equal parts covalent and ionic character. The specific linear combination that perfectly cancels the ionic terms is $\\frac{1}{\\sqrt{2}}(\\vert \\phi_g^2 \\rangle - \\vert \\phi_u^2 \\rangle)$. The variational principle within CASSCF finds precisely this solution at the dissociation limit.\n    -   **CI Weights**: This requires $c_{1} = -c_{3}$. With the normalization condition $\\lvert c_{1}\\rvert^{2} + \\lvert c_{3}\\rvert^{2}=1$, we get $\\lvert c_{1}\\rvert^{2} = \\lvert c_{3}\\rvert^{2} = 1/2$.\n    -   **NOONs**: $n_{g} = 2(1/2)=1$ and $n_{u} = 2(1/2)=1$.\n    -   **Character**: Two CSFs having equal, large weights is the definition of strong (or static) multireference character. The NOONs deviating significantly from $2$ and $0$ to become $1$ and $1$ is a key signature of this diradical character.\n\n**Summary of Correct Trend**: As $R$ increases from $R_e$ to $\\infty$:\n-   CI weights $(\\lvert c_{1}\\rvert^{2}, \\lvert c_{2}\\rvert^{2}, \\lvert c_{3}\\rvert^{2})$ evolve from $(\\approx 1, 0, \\approx 0)$ to $(1/2, 0, 1/2)$.\n-   NOONs $\\{n_{g}, n_{u}\\}$ evolve from $\\{\\approx 2, \\approx 0\\}$ to $\\{1, 1\\}$.\n-   The system transitions from single-reference to strongly multireference.\n\n### Option-by-Option Analysis\n\nNow I will evaluate each option against this correct derivation.\n\n**A. Near $R_{e}$, $\\lvert c_{1}\\rvert^{2}\\approx 1$ and $\\lvert c_{2}\\rvert^{2},\\lvert c_{3}\\rvert^{2}\\approx 0$; as $R\\to\\infty$, the variationally optimized orbitals localize and the open-shell CSF dominates with $\\lvert c_{2}\\rvert^{2}\\to 1$ while $\\lvert c_{1}\\rvert^{2},\\lvert c_{3}\\rvert^{2}\\to 0$, and the natural occupations evolve from $\\{n_{g},n_{u}\\}\\approx \\{2,0\\}$ at $R_{e}$ to $\\{1,1\\}$ at dissociation, reflecting strong multireference character.**\n\n-   The description at $R_e$ is correct.\n-   The description of CI weights at $R\\to\\infty$ is **Incorrect**. It claims $\\lvert c_2 \\rvert^2 \\to 1$. As established by symmetry, $c_2$ must be zero for the lowest singlet state ($^1\\Sigma_g^+$). This option describes the behavior of an excited state, $^1\\Sigma_u^+$, or the lowest triplet state.\n-   The evolution of natural occupations from $\\{\\approx 2,0\\}$ to $\\{1,1\\}$ is **Correct**. This is a key physical signature of bond breaking.\n-   The conclusion that this reflects strong multireference character is **Correct**.\n-   **Verdict**: This option describes the correct overall physical transformation—the emergence of multireference character and the resulting NOONs—but it incorrectly identifies the contributing CSFs. The error is in the specifics of the wave function composition.\n\n**B. Near $R_{e}$, $\\lvert c_{1}\\rvert^{2}\\approx 1$; as $R\\to\\infty$, the lowest singlet becomes an equal mixture of the two closed-shell CSFs with $\\lvert c_{1}\\rvert^{2}=\\lvert c_{3}\\rvert^{2}=1/2$ and $\\lvert c_{2}\\rvert^{2}=0$, while the natural occupations remain fixed at $\\{2,0\\}$ for all $R$, indicating no change in multireference character.**\n\n-   The description at $R_e$ is correct.\n-   The description of CI weights at $R\\to\\infty$ ($\\lvert c_1 \\rvert^2 = \\lvert c_3 \\rvert^2 = 1/2, c_2 = 0$) is **Correct**.\n-   The claim that NOONs remain fixed at $\\{2,0\\}$ is **Incorrect**. It is also logically inconsistent with the stated change in CI weights. If the weights change, the NOONs must change.\n-   The conclusion of \"no change in multireference character\" is **Incorrect**.\n-   **Verdict**: This option correctly identifies the CI coefficients but draws patently false and self-contradictory conclusions about the physical properties (NOONs) and the nature of the electronic structure change.\n\n**C. Near $R_{e}$, the antibonding closed-shell configuration is stabilized so $\\lvert c_{3}\\rvert^{2}\\approx 1$; as $R$ increases, $\\lvert c_{1}\\rvert^{2}$ grows and dominates at dissociation, with natural occupations evolving from $\\{0,2\\}$ at $R_{e}$ to $\\{2,0\\}$ at dissociation, indicating decreasing multireference character.**\n\n-   The initial condition $\\lvert c_3 \\rvert^2 \\approx 1$ for the lowest singlet state is physically absurd, as it implies double occupation of the high-energy antibonding orbital at equilibrium.\n-   **Verdict**: **Incorrect**.\n\n**D. The CI weights are invariant with $R$ in CASSCF because the active space is fixed, so $\\lvert c_{i}\\rvert^{2}$ and $\\{n_{g},n_{u}\\}$ do not change along the stretch; multireference character is constant.**\n\n-   This statement fundamentally misunderstands the \"SCF\" part of CASSCF, where orbitals and CI coefficients are simultaneously optimized at each geometry $R$. Both change dramatically during bond dissociation.\n-   **Verdict**: **Incorrect**.\n\n**E. As $R\\to\\infty$, all three CSFs acquire equal weight $\\lvert c_{1}\\rvert^{2}=\\lvert c_{2}\\rvert^{2}=\\lvert c_{3}\\rvert^{2}=1/3$, and the natural occupations approach $\\{4/3,2/3\\}$, reflecting maximal multireference character.**\n\n-   The claim of equal weights for all three CSFs is **Incorrect**. It violates symmetry ($c_2=0$) and there is no physical basis for such equipartition.\n-   The stated NOONs $\\{4/3, 2/3\\}$ are inconsistent with the stated weights. With $|c_i|^2 = 1/3$, the NOONs would be $n_g = 2(1/3)+1(1/3)=1$ and $n_u = 1(1/3)+2(1/3)=1$.\n-   **Verdict**: **Incorrect**.\n\n### Conclusion\n\nNone of the options are entirely correct. Option A incorrectly identifies the form of the wave function at dissociation but correctly describes the initial state, the evolution of the natural occupations, and the emergence of strong multireference character. Option B correctly identifies the form of the wave function but is grossly incorrect and self-contradictory regarding the consequences for occupations and multireference character.\n\nThe question asks for the option that **best captures** the qualitative trend. The central physical concept being tested is the transition from a single-reference to a multireference state upon bond breaking, which is most directly diagnosed by the evolution of the NOONs from integer values ($2,0$) to degenerate values ($1,1$). Option A correctly identifies this crucial trend and its interpretation. The error in Option A is misidentifying the specific CSFs for the lowest state, a mistake of symmetry analysis. The error in Option B is a fundamental logical failure to connect the wave function to its properties. Therefore, Option A provides a superior, albeit flawed, description of the overall physics.", "answer": "$$\\boxed{A}$$", "id": "2653994"}, {"introduction": "Beyond computing energies, a primary application of MCSCF methods is exploring potential energy surfaces, which requires the calculation of energy gradients with respect to nuclear coordinates. This final practice takes you \"under the hood\" of a computational chemistry program to tackle the verification of such an analytic gradient. By implementing a finite-difference check for a simplified CAS(2,2) model system, you will gain hands-on experience with the principles of numerical verification and error analysis, essential skills for both developing and critically using computational chemistry software.", "problem": "You are asked to implement a principled finite-difference verification of a single analytic gradient component in a minimal multiconfigurational self-consistent field (MCSCF) model, specifically a Complete Active Space with two electrons in two spatial orbitals (CAS(2,2)). Consider a two-configuration interaction within the active space represented by a symmetric $2 \\times 2$ electronic Hamiltonian in the active configuration basis,\n$$\n\\mathbf{H}(R) \\;=\\; \\begin{pmatrix}\na(R) & b(R)\\\\\nb(R) & d(R)\n\\end{pmatrix},\n$$\nwhere $R$ is a single nuclear coordinate (in Bohr), and the matrix elements are smooth functions of $R$ defined in atomic units (Hartree) by\n$$\na(R) \\;=\\; \\alpha \\;+\\; \\frac{\\beta}{R}, \\qquad\nd(R) \\;=\\; \\gamma \\;-\\; \\frac{\\beta}{R}, \\qquad\nb(R) \\;=\\; \\delta \\, e^{-\\kappa R}.\n$$\nUse the following fixed parameter values (in atomic units): $\\alpha = -0.5$, $\\gamma = -0.3$, $\\beta = 0.2$, $\\delta = 0.15$, and $\\kappa = 0.8$. In this model, the CAS(2,2) ground-state energy is the lower eigenvalue of $\\mathbf{H}(R)$.\n\nTasks:\n1. Starting from the definition that the ground-state energy is the lowest eigenvalue of the $2 \\times 2$ Hamiltonian $\\mathbf{H}(R)$ and using standard linear algebra together with the stationarity underpinning multiconfigurational self-consistent field methods and the Hellmann–Feynman theorem, derive an explicit analytic expression for the ground-state energy $E(R)$ and its gradient component $\\frac{dE}{dR}$ in terms of $a(R)$, $d(R)$, $b(R)$ and their derivatives with respect to $R$. Express the gradient in Hartree per Bohr.\n2. Implement a central finite-difference estimate for the gradient,\n$$\n\\left(\\frac{dE}{dR}\\right)_{\\mathrm{FD}}(R; h) \\;=\\; \\frac{E(R+h) - E(R-h)}{2h},\n$$\nfor a given step size $h$ (in Bohr).\n3. Estimate the numerical error due to step size for the central difference as the sum of a truncation component and a rounding component:\n   - The leading truncation error magnitude scales as $C \\, h^2$, where $C$ is proportional to $\\left|E^{(3)}(R)\\right|$. Estimate $\\left|E^{(3)}(R)\\right|$ numerically from the energy function using a symmetric five-point third-derivative stencil with step $h$.\n   - The rounding error magnitude scales as $D / h$, where $D$ is proportional to the floating-point machine epsilon multiplied by an energy scale near $R$. Use the double-precision machine epsilon and a local energy scale constructed from $E(R+h)$ and $E(R-h)$.\n   - Report the truncation error estimate, the rounding error estimate, and their sum as the total error estimate, all in Hartree per Bohr.\n4. Using your estimates of the truncation and rounding error constants, compute an estimate for the step size $h_{\\mathrm{opt}}$ that minimizes the sum of the two error models for the central difference at each $R$. Report $h_{\\mathrm{opt}}$ in Bohr.\n5. Implement a complete program that, for each test case, computes:\n   - the finite-difference gradient $\\left(\\frac{dE}{dR}\\right)_{\\mathrm{FD}}(R; h)$,\n   - the analytic gradient $\\frac{dE}{dR}(R)$,\n   - the absolute difference between the two,\n   - the truncation error estimate,\n   - the rounding error estimate,\n   - the total error estimate (sum of the previous two),\n   - and the estimated optimal step size $h_{\\mathrm{opt}}$.\n   All gradients must be expressed in Hartree per Bohr, and all step sizes must be expressed in Bohr. Do not round; report the raw double-precision decimal values.\n\nTest suite:\n- Case $1$: $R = 1.5$ Bohr, $h = 1.0 \\times 10^{-3}$ Bohr.\n- Case $2$: $R = 1.5$ Bohr, $h = 1.0 \\times 10^{-1}$ Bohr.\n- Case $3$: $R = 1.5$ Bohr, $h = 1.0 \\times 10^{-6}$ Bohr.\n- Case $4$: $R = 4.0$ Bohr, $h = 1.0 \\times 10^{-3}$ Bohr.\n\nFinal output format:\nYour program should produce a single line of output containing a JSON-like list of lists, one inner list per test case, each inner list ordered as\n$$\n\\big[\\;(\\tfrac{dE}{dR})_{\\mathrm{FD}},\\; \\tfrac{dE}{dR},\\; |\\;(\\tfrac{dE}{dR})_{\\mathrm{FD}} - \\tfrac{dE}{dR}\\;|,\\; \\text{trunc\\_err},\\; \\text{round\\_err},\\; \\text{total\\_err},\\; h_{\\mathrm{opt}}\\;\\big],\n$$\nwhere the first six entries have units of Hartree per Bohr and the last entry has units of Bohr. The single printed line must be exactly the bracketed list representation with comma separators (for example, \"[[...],[...],...]\").", "solution": "The problem is valid. It is scientifically grounded in the principles of quantum chemistry and numerical analysis, specifically within the context of multiconfigurational electronic structure theory and finite-difference methods. The problem is well-posed, providing all necessary parameters, functional forms, and definitions to arrive at a unique, verifiable solution. The language is objective and mathematically precise. There are no contradictions, ambiguities, or unsound premises.\n\nThe solution proceeds in several steps: first, the derivation of the analytical ground-state energy and its gradient; second, the formulation of the numerical procedures for finite-difference gradient calculation and error analysis; and third, the algorithmic implementation to compute the required quantities for the given test cases.\n\n**1. Analytic Ground-State Energy and Gradient**\n\nThe electronic Hamiltonian for the two-configuration model is given by the symmetric $2 \\times 2$ matrix:\n$$\n\\mathbf{H}(R) = \\begin{pmatrix} a(R) & b(R) \\\\ b(R) & d(R) \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ are found by solving the characteristic equation $\\det(\\mathbf{H}(R) - \\lambda\\mathbf{I}) = 0$:\n$$\n(a(R) - \\lambda)(d(R) - \\lambda) - b(R)^2 = 0\n$$\nThis yields a quadratic equation for the eigenvalues:\n$$\n\\lambda^2 - (a(R) + d(R))\\lambda + a(R)d(R) - b(R)^2 = 0\n$$\nThe solutions are given by the quadratic formula:\n$$\n\\lambda_{\\pm}(R) = \\frac{a(R)+d(R)}{2} \\pm \\frac{1}{2}\\sqrt{(a(R)+d(R))^2 - 4(a(R)d(R) - b(R)^2)}\n$$\nSimplifying the term under the square root:\n$$\n(a+d)^2 - 4(ad-b^2) = a^2+2ad+d^2 - 4ad+4b^2 = a^2-2ad+d^2+4b^2 = (a-d)^2+4b^2\n$$\nThus, the two eigenvalues are:\n$$\n\\lambda_{\\pm}(R) = \\frac{a(R)+d(R)}{2} \\pm \\frac{1}{2}\\sqrt{(a(R)-d(R))^2 + 4b(R)^2}\n$$\nThe ground-state energy, $E(R)$, is the lower eigenvalue, corresponding to the minus sign:\n$$\nE(R) = \\frac{a(R)+d(R)}{2} - \\frac{1}{2}\\sqrt{(a(R)-d(R))^2 + 4b(R)^2}\n$$\n\nNext, we derive the analytic gradient, $\\frac{dE}{dR}$. Although the Hellmann-Feynman theorem can be used, direct differentiation of the expression for $E(R)$ is more straightforward. Let $X(R) = a(R)-d(R)$ and $Y(R) = 2b(R)$. Then $E(R) = \\frac{1}{2}(a(R)+d(R)) - \\frac{1}{2}\\sqrt{X(R)^2 + Y(R)^2}$. Using the chain rule:\n$$\n\\frac{dE}{dR} = \\frac{1}{2}(a'(R)+d'(R)) - \\frac{1}{4\\sqrt{X(R)^2+Y(R)^2}} \\left(2X(R)X'(R)+2Y(R)Y'(R)\\right)\n$$\nwhere primes denote differentiation with respect to $R$. The derivatives of the Hamiltonian matrix elements are:\n$$\na'(R) = \\frac{d}{dR}\\left(\\alpha + \\frac{\\beta}{R}\\right) = -\\frac{\\beta}{R^2}\n$$\n$$\nd'(R) = \\frac{d}{dR}\\left(\\gamma - \\frac{\\beta}{R}\\right) = \\frac{\\beta}{R^2}\n$$\n$$\nb'(R) = \\frac{d}{dR}\\left(\\delta e^{-\\kappa R}\\right) = -\\kappa \\delta e^{-\\kappa R} = -\\kappa b(R)\n$$\nA key simplification arises: $a'(R)+d'(R) = 0$. The derivatives of $X(R)$ and $Y(R)$ are:\n$$\nX'(R) = a'(R) - d'(R) = -\\frac{2\\beta}{R^2}\n$$\n$$\nY'(R) = 2b'(R) = -2\\kappa b(R) = -\\kappa Y(R)\n$$\nSubstituting these into the expression for $\\frac{dE}{dR}$:\n$$\n\\frac{dE}{dR} = 0 - \\frac{X(R)(-\\frac{2\\beta}{R^2}) + Y(R)(-\\kappa Y(R))}{2\\sqrt{X(R)^2+Y(R)^2}} = \\frac{X(R)\\frac{2\\beta}{R^2} + \\kappa Y(R)^2}{2\\sqrt{X(R)^2+Y(R)^2}}\n$$\nSubstituting back $X(R) = a(R)-d(R)$ and $Y(R)=2b(R)$:\n$$\n\\frac{dE}{dR} = \\frac{(a(R)-d(R))\\frac{2\\beta}{R^2} + \\kappa (2b(R))^2}{2\\sqrt{(a(R)-d(R))^2+(2b(R))^2}} = \\frac{(a(R)-d(R))\\frac{2\\beta}{R^2} + 4\\kappa b(R)^2}{2\\sqrt{(a(R)-d(R))^2+4b(R)^2}}\n$$\nThis expression provides the required analytical gradient.\n\n**2. Numerical Procedures**\n\n*   **Finite-Difference Gradient:** The central-difference formula is given:\n    $$\n    \\left(\\frac{dE}{dR}\\right)_{\\mathrm{FD}}(R; h) = \\frac{E(R+h) - E(R-h)}{2h}\n    $$\n    This will be implemented by evaluating the analytic energy function $E(R)$ at a positive and negative displacement $h$ from the point $R$.\n\n*   **Error Analysis:** The total numerical error is modeled as a sum of truncation and rounding errors.\n    *   **Truncation Error:** The leading truncation error of the central difference formula is $\\mathcal{E}_{\\text{trunc}} = -\\frac{h^2}{6}E^{(3)}(R) + O(h^4)$. We estimate its magnitude by first estimating the third derivative, $E^{(3)}(R)$, using the symmetric five-point stencil:\n        $$\n        E^{(3)}_{\\text{num}}(R; h) = \\frac{-E(R-2h) + 2E(R-h) - 2E(R+h) + E(R+2h)}{2h^3}\n        $$\n        The magnitude of the truncation error is then estimated as:\n        $$\n        \\text{trunc\\_err} = \\left|-\\frac{h^2}{6}E^{(3)}_{\\text{num}}(R; h)\\right| = \\frac{h^2}{6}|E^{(3)}_{\\text{num}}(R; h)|\n        $$\n\n    *   **Rounding Error:** The computation of $E(R \\pm h)$ is subject to floating-point rounding error, proportional to the energy's magnitude and the machine epsilon, $\\epsilon_{\\text{machine}}$. The error in the difference $E(R+h) - E(R-h)$ is bounded by approximately $\\epsilon_{\\text{machine}}(|E(R+h)| + |E(R-h)|)$. This error is then divided by $2h$. A standard model for the rounding error magnitude in the gradient is:\n        $$\n        \\text{round\\_err} = \\frac{\\epsilon_{\\text{machine}}(|E(R+h)| + |E(R-h)|)}{2h}\n        $$\n        For this problem, $\\epsilon_{\\text{machine}}$ is the double-precision floating-point epsilon.\n\n    *   **Total Error Estimate:** The total error is the sum of the magnitudes of these two components:\n        $$\n        \\text{total\\_err} = \\text{trunc\\_err} + \\text{round\\_err}\n        $$\n\n*   **Optimal Step Size:** The total error model as a function of $h$ is $\\mathcal{E}_{\\text{total}}(h) = Ch^2 + D/h$. To find the step size $h_{\\mathrm{opt}}$ that minimizes this error, we set its derivative with respect to $h$ to zero:\n    $$\n    \\frac{d\\mathcal{E}_{\\text{total}}}{dh} = 2Ch - \\frac{D}{h^2} = 0 \\implies h_{\\mathrm{opt}} = \\left(\\frac{D}{2C}\\right)^{1/3}\n    $$\n    We use the estimates for the constants $C$ and $D$ derived from a calculation at the given step size $h$:\n    $$\n    C \\approx C_{\\text{est}} = \\frac{|E^{(3)}_{\\text{num}}(R; h)|}{6}\n    $$\n    $$\n    D \\approx D_{\\text{est}} = \\frac{\\epsilon_{\\text{machine}}(|E(R+h)| + |E(R-h)|)}{2}\n    $$\n    Therefore, the estimated optimal step size is:\n    $$\n    h_{\\mathrm{opt}} = \\left(\\frac{D_{\\text{est}}}{2C_{\\text{est}}}\\right)^{1/3} = \\left(\\frac{3 \\cdot \\epsilon_{\\text{machine}}(|E(R+h)| + |E(R-h)|)}{2|E^{(3)}_{\\text{num}}(R; h)|}\\right)^{1/3}\n    $$\n    A small tolerance will be added to the denominator in the implementation to prevent division by zero in case $E^{(3)}_{\\text{num}}(R; h)$ is numerically zero.\n\n**3. Implementation**\n\nThe final program implements these formulas in Python using the `numpy` library. A function is created to calculate $E(R)$ given the model parameters. This energy function is then used to compute all other quantities for each test case: the finite-difference and analytic gradients, their absolute difference, the error components (truncation and rounding), the total error estimate, and the estimated optimal step size. The results are collected and printed in the specified format.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the finite-difference verification and error analysis for a \n    minimal MCSCF model as specified in the problem statement.\n    \"\"\"\n    # Define fixed parameter values in atomic units\n    alpha = -0.5\n    gamma = -0.3\n    beta = 0.2\n    delta = 0.15\n    kappa = 0.8\n\n    # Double-precision machine epsilon\n    eps = np.finfo(float).eps\n\n    # Define the test suite\n    test_cases = [\n        (1.5, 1.0e-3),\n        (1.5, 1.0e-1),\n        (1.5, 1.0e-6),\n        (4.0, 1.0e-3),\n    ]\n\n    # --- Helper functions for Hamiltonian elements and energy ---\n    def a(r_val):\n        return alpha + beta / r_val\n\n    def d(r_val):\n        return gamma - beta / r_val\n\n    def b(r_val):\n        return delta * np.exp(-kappa * r_val)\n\n    def E(r_val):\n        \"\"\"Computes the ground-state energy (lower eigenvalue) at a given R.\"\"\"\n        a_r, d_r, b_r = a(r_val), d(r_val), b(r_val)\n        term_ad_sum = a_r + d_r\n        term_ad_diff_sq = (a_r - d_r)**2\n        term_b_sq = 4.0 * b_r**2\n        return 0.5 * term_ad_sum - 0.5 * np.sqrt(term_ad_diff_sq + term_b_sq)\n\n    def analytic_grad(r_val):\n        \"\"\"Computes the analytic gradient dE/dR at a given R.\"\"\"\n        a_r, d_r, b_r = a(r_val), d(r_val), b(r_val)\n        a_minus_d = a_r - d_r\n        \n        numerator = a_minus_d * (2.0 * beta / r_val**2) + 4.0 * kappa * b_r**2\n        denominator = 2.0 * np.sqrt(a_minus_d**2 + 4.0 * b_r**2)\n        \n        # Add a small value to denominator to avoid division by zero if states are degenerate\n        # Although with b(R) > 0 for finite R, this should not happen.\n        if denominator  1e-15:\n            return 0.0\n            \n        return numerator / denominator\n\n    results = []\n    for R, h in test_cases:\n        # --- Task 2: Finite-difference gradient ---\n        E_p = E(R + h)\n        E_m = E(R - h)\n        fd_grad = (E_p - E_m) / (2.0 * h)\n\n        # --- Task 1: Analytic gradient ---\n        an_grad = analytic_grad(R)\n\n        # --- Absolute difference ---\n        abs_diff = np.abs(fd_grad - an_grad)\n\n        # --- Task 3: Error estimation ---\n        # Truncation error estimate\n        E_p2 = E(R + 2.0 * h)\n        E_m2 = E(R - 2.0 * h)\n        \n        # Symmetric 5-point third derivative stencil\n        E3_num = (-E_m2 + 2.0 * E_m - 2.0 * E_p + E_p2) / (2.0 * h**3)\n        trunc_err = (h**2 / 6.0) * np.abs(E3_num)\n\n        # Rounding error estimate\n        round_err = eps * (np.abs(E_p) + np.abs(E_m)) / (2.0 * h)\n        \n        # Total error estimate\n        total_err = trunc_err + round_err\n\n        # --- Task 4: Optimal step size estimate ---\n        C_est = np.abs(E3_num) / 6.0\n        D_est = eps * (np.abs(E_p) + np.abs(E_m)) / 2.0\n        \n        # Add a small tolerance to prevent division by zero\n        h_opt = (D_est / (2.0 * C_est + 1e-30))**(1.0/3.0)\n\n        # --- Collate results ---\n        case_results = [\n            fd_grad,\n            an_grad,\n            abs_diff,\n            trunc_err,\n            round_err,\n            total_err,\n            h_opt\n        ]\n        results.append(case_results)\n\n    # --- Final Output Formatting ---\n    # Convert list of lists to the required string representation\n    output_str = \"[\" + \",\".join([\n        \"[\" + \",\".join([f\"{val:.15e}\" for val in inner_list]) + \"]\" \n        for inner_list in results\n    ]) + \"]\"\n\n    print(output_str)\n\nsolve()\n```", "id": "2654021"}]}