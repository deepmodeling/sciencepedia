{"hands_on_practices": [{"introduction": "The foundation of femtochemistry lies in the pump-probe technique, where an ultrashort pump pulse initiates a chemical process, and a time-delayed probe pulse monitors the subsequent changes. This exercise provides a first-principles simulation of a transient absorption signal, the most common observable in such experiments. By modeling the population dynamics with rate equations and accounting for the finite duration of the laser pulses through convolution with an Instrument Response Function (IRF), you will construct a realistic data trace, bridging the gap between a microscopic kinetic model and a macroscopic experimental measurement [@problem_id:2640598]. This practice is essential for understanding how to extract intrinsic molecular dynamics from experimentally measured signals.", "problem": "Consider a pump–probe transient absorption measurement designed to resolve a transition state in real time. A short pump pulse at laboratory time $t=0$ prepares a nonequilibrium population in an excited state. The probe pulse, delayed by a controllable time delay $\\tau$, interrogates the sample’s instantaneous absorption change, but the measured signal is temporally blurred by the finite Instrument Response Function (IRF) of the setup. The goal is to compute the transient absorption signal from first principles given a minimal kinetic model and a Gaussian IRF.\n\nAssume the following physically motivated model.\n\n1. States and population dynamics. A fraction $p_0$ of molecules is instantaneously promoted from the ground state $G$ to an excited state $E$ at $t=0^+$. The excited population $E$ relaxes sequentially to an intermediate state $B$, which then returns to $G$. Let $N_E(t)$, $N_B(t)$, and $N_G(t)$ denote the state populations, constrained by $N_E(t)+N_B(t)+N_G(t)=1$. The population dynamics are governed by the coupled linear ordinary differential equations\n$\n\\frac{dN_E}{dt} = -k_1 N_E,\\quad\n\\frac{dN_B}{dt} = k_1 N_E - k_2 N_B,\n$\nwith initial conditions\n$\nN_E(0^+) = p_0,\\quad N_B(0^+) = 0,\\quad N_G(0^+) = 1 - p_0.\n$\nAll times are expressed in femtoseconds (fs), and the first-order rate constants $k_1$ and $k_2$ are in $\\mathrm{fs}^{-1}$.\n\n2. Instantaneous absorption change at the probe frequency. The differential absorption coefficient change (per unit length) is modeled as a linear combination of state populations using spectral weights that encode ground-state bleach (GSB), stimulated emission (SE), and excited-state absorption (ESA),\n$\n\\Delta \\alpha(t) = -w_{\\mathrm{GSB}}\\bigl(N_E(t)+N_B(t)\\bigr)\\;-\\;w_{\\mathrm{SE}}\\,N_E(t)\\;+\\;w_{\\mathrm{ESA,E}}\\,N_E(t)\\;+\\;w_{\\mathrm{ESA,B}}\\,N_B(t).\n$\nThe weights $w_{\\mathrm{GSB}}, w_{\\mathrm{SE}}, w_{\\mathrm{ESA,E}}, w_{\\mathrm{ESA,B}}$ are real, nonnegative scalars that absorb the path length and probe spectral factors and are expressed in arbitrary but consistent units such that the final transient absorption signal is a dimensionless differential optical density.\n\n3. Finite temporal resolution. The measured signal at probe delay $\\tau$ is the IRF-weighted time average of the instantaneous absorption change. The IRF is a normalized Gaussian with standard deviation $\\sigma$,\n$\n\\mathrm{IRF}(t) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\Bigl(-\\frac{t^2}{2\\sigma^2}\\Bigr),\n$\nwhere $\\sigma$ is in femtoseconds. The detected transient absorption signal is\n$\nS(\\tau) = \\int_{-\\infty}^{+\\infty} \\mathrm{IRF}(\\tau - t)\\,\\Delta \\alpha(t)\\,dt,\n$\nwith the physical causality condition $\\Delta \\alpha(t)=0$ for $t<0$ implied by the pump excitation occurring at $t=0$.\n\nYour task is to write a program that, for each parameter set given below, evaluates $S(\\tau)$ exactly or numerically to high accuracy by solving the rate equations for $N_E(t)$ and $N_B(t)$ and carrying out the convolution integral with the Gaussian IRF. You must not assume any delta-function pulses; finite $\\sigma$ must be treated explicitly. You may use any mathematically equivalent approach that follows from the stated model, including, but not limited to, solving the linear system analytically and evaluating the convolution integral by quadrature or by closed-form evaluation of the Gaussian–exponential convolution.\n\nAll answers must be reported as dimensionless floating-point numbers. Angles do not appear. No percentages appear.\n\nTest suite. For each case, the tuple $(\\tau,\\sigma,p_0,k_1,k_2,w_{\\mathrm{GSB}},w_{\\mathrm{SE}},w_{\\mathrm{ESA,E}},w_{\\mathrm{ESA,B}})$ is specified in femtoseconds and $\\mathrm{fs}^{-1}$ as stated.\n\n- Case $1$: $(\\tau,\\sigma,p_0,k_1,k_2,w_{\\mathrm{GSB}},w_{\\mathrm{SE}},w_{\\mathrm{ESA,E}},w_{\\mathrm{ESA,B}}) = (\\,0,\\;30,\\;0.1,\\;0.005,\\;0.001,\\;1.0,\\;0.4,\\;0.2,\\;0.1\\,)$.\n- Case $2$: $(\\,100,\\;30,\\;0.1,\\;0.005,\\;0.001,\\;1.0,\\;0.4,\\;0.2,\\;0.1\\,)$.\n- Case $3$: $(\\,-100,\\;30,\\;0.1,\\;0.005,\\;0.001,\\;1.0,\\;0.4,\\;0.2,\\;0.1\\,)$.\n- Case $4$: $(\\,0,\\;50,\\;0.1,\\;0.1,\\;0.01,\\;1.0,\\;0.4,\\;0.2,\\;0.1\\,)$.\n- Case $5$: $(\\,2000,\\;20,\\;0.1,\\;0.006666666666666667,\\;0.0002,\\;1.0,\\;0.5,\\;0.3,\\;0.0\\,)$.\n\nRequired final output format. Your program should produce a single line of output containing a Python-style list literal with the five results in order, rounded to six digits after the decimal point, for example, \"[x1,x2,x3,x4,x5]\" where each $x_i$ is the computed $S(\\tau)$ for Case $i$ rounded to six decimals. No other text should be printed.", "solution": "We derive a computable expression for the transient absorption signal from fundamental laws and definitions, then translate it into an algorithm.\n\nThe Beer–Lambert law states that the optical density is proportional to the absorption coefficient and path length. In a differential measurement, the transient absorption signal is proportional to the change in the absorption coefficient. With the path length and probe calibration absorbed into weights, the dimensionless transient absorption signal can be computed from the change in absorption coefficient $\\Delta \\alpha(t)$.\n\nPopulation dynamics. We start from the linear, time-invariant, first-order kinetic scheme $E \\xrightarrow{k_1} B \\xrightarrow{k_2} G$ with $N_E(0^+)=p_0$ and $N_B(0^+)=0$. The system\n$\n\\frac{dN_E}{dt} = -k_1 N_E,\\quad \\frac{dN_B}{dt} = k_1 N_E - k_2 N_B\n$\nis solved sequentially from first principles. The first equation yields directly\n$\nN_E(t) = p_0\\,e^{-k_1 t},\\quad t\\ge 0.\n$\nSubstituting into the second equation gives an inhomogeneous linear first-order ordinary differential equation\n$\n\\frac{dN_B}{dt} + k_2 N_B = k_1 p_0 e^{-k_1 t},\\quad N_B(0)=0.\n$\nThe integrating factor method uses $\\mu(t)=e^{k_2 t}$, so\n$\n\\frac{d}{dt}\\bigl(e^{k_2 t} N_B(t)\\bigr) = k_1 p_0 e^{(k_2 - k_1) t}.\n$\nIntegrating from $0$ to $t$ gives\n$\ne^{k_2 t} N_B(t) - e^{k_2 \\cdot 0} N_B(0) = k_1 p_0 \\int_{0}^{t} e^{(k_2 - k_1) s}\\,ds.\n$\nWith $N_B(0)=0$ and $k_1 \\ne k_2$, we obtain\n$\nN_B(t) = k_1 p_0\\, e^{-k_2 t}\\,\\frac{e^{(k_2 - k_1) t}-1}{k_2 - k_1}\n= p_0\\,\\frac{k_1}{k_2 - k_1}\\,\\bigl(e^{-k_1 t} - e^{-k_2 t}\\bigr).\n$\nCausality imposes $N_E(t)=0$ and $N_B(t)=0$ for $t<0$.\n\nInstantaneous absorption change. The change at the probe frequency is modeled as\n$\n\\Delta \\alpha(t) = -w_{\\mathrm{GSB}}\\bigl(N_E(t)+N_B(t)\\bigr)\\;-\\;w_{\\mathrm{SE}}\\,N_E(t)\\;+\\;w_{\\mathrm{ESA,E}}\\,N_E(t)\\;+\\;w_{\\mathrm{ESA,B}}\\,N_B(t).\n$\nGrouping terms proportional to $N_E$ and $N_B$ yields\n$\n\\Delta \\alpha(t) = A_E\\,N_E(t) + A_B\\,N_B(t),\n$\nwhere\n$\nA_E = -w_{\\mathrm{GSB}} - w_{\\mathrm{SE}} + w_{\\mathrm{ESA,E}},\\quad\nA_B = -w_{\\mathrm{GSB}} + w_{\\mathrm{ESA,B}}.\n$\nSubstituting the solutions for $N_E$ and $N_B$ gives a linear combination of decaying exponentials for $t\\ge 0$,\n$\n\\Delta \\alpha(t) = p_0\\Bigl[\\bigl(A_E + A_B\\,c\\bigr)\\,e^{-k_1 t} - A_B\\,c\\,e^{-k_2 t}\\Bigr],\\quad c \\equiv \\frac{k_1}{k_2 - k_1}.\n$\nBy causality, $\\Delta \\alpha(t)=0$ for $t<0$.\n\nFinite temporal resolution via convolution. The measured signal at delay $\\tau$ is the convolution of the IRF with the instantaneous response,\n$\nS(\\tau) = \\int_{-\\infty}^{+\\infty} \\mathrm{IRF}(\\tau - t)\\,\\Delta \\alpha(t)\\,dt\n= \\int_{0}^{+\\infty} \\mathrm{IRF}(\\tau - t)\\,\\Delta \\alpha(t)\\,dt,\n$\nbecause $\\Delta \\alpha(t)=0$ for $t<0$. The IRF is the normalized Gaussian\n$\n\\mathrm{IRF}(t) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\Bigl(-\\frac{t^2}{2\\sigma^2}\\Bigr).\n$\nTherefore, $S(\\tau)$ reduces to a linear combination of Gaussian–exponential convolutions of the form\n$\n\\Phi(\\tau;k,\\sigma) \\equiv \\int_{0}^{+\\infty} \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\n\\exp\\!\\Bigl(-\\frac{(\\tau - t)^2}{2\\sigma^2}\\Bigr)\\,e^{-k t}\\,dt.\n$\nThis integral is a standard result (convolution of a one-sided exponential with a Gaussian), and it evaluates in closed form to an exponentially modified Gaussian expressed via the complementary error function,\n$\n\\Phi(\\tau;k,\\sigma) = \\frac{1}{2}\\,\\exp\\!\\Bigl(\\frac{1}{2}\\sigma^2 k^2 - k\\,\\tau\\Bigr)\\,\n\\operatorname{erfc}\\!\\Bigl(\\frac{\\sigma^2 k - \\tau}{\\sqrt{2}\\,\\sigma}\\Bigr),\n$\nwhich follows from completing the square in the exponent and using the definition of the error function in Gaussian integrals. Substituting the linear combination for $\\Delta \\alpha(t)$ into the convolution gives\n$\nS(\\tau) = p_0\\Bigl[\\bigl(A_E + A_B\\,c\\bigr)\\,\\Phi(\\tau;k_1,\\sigma)\\;-\\;A_B\\,c\\,\\Phi(\\tau;k_2,\\sigma)\\Bigr],\\quad c=\\frac{k_1}{k_2-k_1}.\n$\nThis expression is dimensionless, consistent with the absorption-change normalization in the weights.\n\nAlgorithmic realization.\n- Inputs: $(\\tau,\\sigma,p_0,k_1,k_2,w_{\\mathrm{GSB}},w_{\\mathrm{SE}},w_{\\mathrm{ESA,E}},w_{\\mathrm{ESA,B}})$ with $\\tau$ and $\\sigma$ in femtoseconds and $k_1,k_2$ in $\\mathrm{fs}^{-1}$.\n- Compute $A_E=-w_{\\mathrm{GSB}} - w_{\\mathrm{SE}} + w_{\\mathrm{ESA,E}}$ and $A_B=-w_{\\mathrm{GSB}} + w_{\\mathrm{ESA,B}}$.\n- Compute $c=k_1/(k_2-k_1)$, ensuring $k_1\\ne k_2$ (the test suite uses distinct rates). If needed, a limiting procedure for $k_1\\to k_2$ would yield a Gaussian–exponential–polynomial form, but is not required here.\n- Evaluate $\\Phi(\\tau;k_1,\\sigma)$ and $\\Phi(\\tau;k_2,\\sigma)$ using the closed form with the complementary error function.\n- Assemble $S(\\tau)$ from the linear combination above.\n- Round to six digits after the decimal point.\n\nSanity checks and limiting behavior.\n- For $\\tau \\ll -\\sigma$, $\\operatorname{erfc}$ tends to $2$ with exponential suppression from $\\exp(-k\\tau)$, but the Gaussian tail suppresses the overall result, yielding $S(\\tau)\\to 0$, consistent with causality subject to finite IRF.\n- For $\\sigma \\to 0^+$, $\\mathrm{IRF}$ approaches a Dirac delta and $\\Phi(\\tau;k,\\sigma)\\to H(\\tau)\\,e^{-k \\tau}$, where $H$ is the Heaviside step function, so $S(\\tau)\\to \\Delta \\alpha(\\tau)$, as expected for an impulsive probe.\n- For large positive $\\tau$ relative to $1/k_1$ and $1/k_2$, $S(\\tau)$ decays dominated by the slower rate $k_2$ with prefactor proportional to $-A_B c$.\n\nThe program implements the closed-form evaluation to ensure accuracy and performance, and applies it to the five test cases. The final output is a single list of five floating-point numbers, each the computed $S(\\tau)$ for the corresponding case, rounded to six decimals.", "answer": "```python\nimport math\n\ndef phi_exgauss(tau, k, sigma):\n    \"\"\"\n    Closed-form convolution of a one-sided exponential e^{-k t} (t>=0)\n    with a normalized Gaussian IRF of standard deviation sigma:\n    Phi(tau;k,sigma) = 0.5 * exp(0.5*sigma^2*k^2 - k*tau) * erfc((sigma^2*k - tau)/(sqrt(2)*sigma))\n    All times in fs, k in fs^-1, sigma in fs, tau in fs.\n    \"\"\"\n    if sigma = 0:\n        # In the impulsive limit, Gaussian -> delta; reduce to Heaviside * exp(-k*tau)\n        return math.exp(-k * tau) if tau >= 0 else 0.0\n    arg = (sigma * sigma * k - tau) / (math.sqrt(2.0) * sigma)\n    expo = 0.5 * (sigma * sigma) * (k * k) - k * tau\n    return 0.5 * math.exp(expo) * math.erfc(arg)\n\ndef transient_absorption_signal(tau, sigma, p0, k1, k2, w_gsb, w_se, w_esa_e, w_esa_b):\n    \"\"\"\n    Compute S(tau) for the sequential kinetics E --k1--> B --k2--> G with\n    instantaneous excitation fraction p0 at t=0+, Gaussian IRF of width sigma,\n    and spectral weights w_gsb, w_se, w_esa_e, w_esa_b.\n    \"\"\"\n    # Coefficients for instantaneous absorption change\n    A_E = -w_gsb - w_se + w_esa_e\n    A_B = -w_gsb + w_esa_b\n\n    # Avoid division by zero if k1 == k2; test suite guarantees k1 != k2.\n    denom = (k2 - k1)\n    c = k1 / denom\n\n    # Convolution terms (exponentially modified Gaussians)\n    phi1 = phi_exgauss(tau, k1, sigma)\n    phi2 = phi_exgauss(tau, k2, sigma)\n\n    # Linear combination\n    S = p0 * ((A_E + A_B * c) * phi1 - (A_B * c) * phi2)\n    return S\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (tau, sigma, p0, k1, k2, w_gsb, w_se, w_esa_e, w_esa_b)\n    test_cases = [\n        (0.0, 30.0, 0.1, 0.005, 0.001, 1.0, 0.4, 0.2, 0.1),           # Case 1\n        (100.0, 30.0, 0.1, 0.005, 0.001, 1.0, 0.4, 0.2, 0.1),         # Case 2\n        (-100.0, 30.0, 0.1, 0.005, 0.001, 1.0, 0.4, 0.2, 0.1),        # Case 3\n        (0.0, 50.0, 0.1, 0.1, 0.01, 1.0, 0.4, 0.2, 0.1),              # Case 4\n        (2000.0, 20.0, 0.1, 0.006666666666666667, 0.0002, 1.0, 0.5, 0.3, 0.0),  # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        tau, sigma, p0, k1, k2, w_gsb, w_se, w_esa_e, w_esa_b = case\n        result = transient_absorption_signal(tau, sigma, p0, k1, k2, w_gsb, w_se, w_esa_e, w_esa_b)\n        # Round to six digits after the decimal point\n        results.append(f\"{result:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2640598"}, {"introduction": "While kinetic models describe the rates of transitions between states, they do not explain the underlying quantum mechanical origin of these transitions. Many chemical reactions, especially those involving excited states, proceed through regions where potential energy surfaces approach each other in an \"avoided crossing.\" This exercise delves into the heart of the transition state by applying the Landau-Zener formula to calculate the probability of a nonadiabatic transition—a \"hop\" between electronic states [@problem_id:2640532]. By connecting the abstract transition probability to tangible experimental parameters like kinetic energy and potential energy gradients, you will gain a deeper appreciation for the quantum nature of chemical reactivity.", "problem": "A femtosecond pump excites a nuclear wavepacket on an excited electronic state of a diatomic fragmenting along a single dominant reaction coordinate $q$ (taken as a mass-weighted Cartesian displacement, approximated locally by a simple distance coordinate). Near a transition-state region, two diabatic electronic states $|1\\rangle$ and $|2\\rangle$ form an avoided crossing as functions of $q$. In the diabatic representation and in the vicinity of the crossing coordinate $q_{c}$, the diabatic potentials are locally linear, $E_{1}(q) \\approx E_{c} + F\\,(q - q_{c})$ and $E_{2}(q) \\approx E_{c} - F\\,(q - q_{c})$, with a constant diabatic electronic coupling $V$.\n\nAssume that the pump prepares a wavepacket that reaches $q_{c}$ with a well-defined mean kinetic energy along $q$ equal to $K$, and that the nuclear motion near $q_{c}$ is well approximated as classical with instantaneous velocity $v_{q}$ given by $v_{q} = \\sqrt{2K/\\mu}$, where $\\mu$ is the reduced mass associated with the coordinate $q$. In the diabatic basis $\\{|1\\rangle, |2\\rangle\\}$, the nuclear motion maps the time dependence of the diabatic energy difference to $E_{1}(t) - E_{2}(t) \\approx \\alpha t$ with $\\alpha = 2 F v_{q}$, and the coupled time-dependent electronic dynamics near $t=0$ are generated by the $2\\times 2$ Hamiltonian\n$$\nH(t) = \\begin{pmatrix}\n\\frac{1}{2}\\alpha t  V \\\\\nV  -\\frac{1}{2}\\alpha t\n\\end{pmatrix}.\n$$\nStarting from the time-dependent Schrödinger equation and the above Hamiltonian, derive the nonadiabatic Landau–Zener transition probability $P_{\\mathrm{LZ}}$ for a single passage through the avoided crossing in terms of $V$, $\\alpha$, and fundamental constants. Then, evaluate $P_{\\mathrm{LZ}}$ numerically for the following physically realistic parameters that could arise in a femtochemistry pump–probe experiment probing a transition state:\n\n- Diabatic slope magnitude $F = 0.6\\ \\mathrm{eV\\,\\AA^{-1}}$.\n- Diabatic electronic coupling $V = 180\\ \\mathrm{cm^{-1}}$.\n- Reduced mass $\\mu = 10\\ \\mathrm{amu}$.\n- Mean kinetic energy at the crossing $K = 0.12\\ \\mathrm{eV}$.\n\nUse the following constants and conversions: $h = 6.62607015\\times 10^{-34}\\ \\mathrm{J\\,s}$, $\\hbar = h/(2\\pi)$, $c = 2.99792458\\times 10^{8}\\ \\mathrm{m\\,s^{-1}}$, $1\\ \\mathrm{eV} = 1.602176634\\times 10^{-19}\\ \\mathrm{J}$, $1\\ \\mathrm{amu} = 1.66053906660\\times 10^{-27}\\ \\mathrm{kg}$, $1\\ \\mathrm{\\AA} = 10^{-10}\\ \\mathrm{m}$, and $E = h c\\,\\tilde{\\nu}$ for converting wavenumber $\\tilde{\\nu}$ in $\\mathrm{cm^{-1}}$ to energy.\n\nReport the final value of $P_{\\mathrm{LZ}}$ as a unitless decimal number rounded to three significant figures.", "solution": "The problem requires the derivation and subsequent numerical evaluation of the Landau-Zener nonadiabatic transition probability, $P_{\\mathrm{LZ}}$.\n\nThe dynamics of the two-level electronic system are governed by the time-dependent Schrödinger equation (TDSE):\n$$i\\hbar \\frac{d}{dt}|\\Psi(t)\\rangle = H(t)|\\Psi(t)\\rangle$$\nThe electronic state vector $|\\Psi(t)\\rangle$ is expanded in the diabatic basis $\\{|1\\rangle, |2\\rangle\\}$ as $|\\Psi(t)\\rangle = c_1(t)|1\\rangle + c_2(t)|2\\rangle$. Substituting this into the TDSE with the given Hamiltonian\n$$\nH(t) = \\begin{pmatrix}\n\\frac{1}{2}\\alpha t  V \\\\\nV  -\\frac{1}{2}\\alpha t\n\\end{pmatrix}\n$$\nyields a system of two coupled first-order ordinary differential equations for the time-dependent complex amplitudes $c_1(t)$ and $c_2(t)$:\n$$\ni\\hbar \\frac{dc_1}{dt} = \\frac{1}{2}\\alpha t \\, c_1(t) + V c_2(t)\n$$\n$$\ni\\hbar \\frac{dc_2}{dt} = V c_1(t) - \\frac{1}{2}\\alpha t \\, c_2(t)\n$$\nWe assume the system is prepared in the diabatic state $|1\\rangle$ long before the crossing, i.e., at $t \\to -\\infty$. The initial conditions are therefore $|c_1(-\\infty)|^2 = 1$ and $|c_2(-\\infty)| = 0$. We wish to find the probability of a nonadiabatic transition.\n\nIn the diabatic representation given, for $t \\to -\\infty$, the state $|1\\rangle$ has energy $E_1 \\to -\\infty$ and state $|2\\rangle$ has energy $E_2 \\to +\\infty$. Thus, $|1\\rangle$ corresponds to the lower adiabatic state at $t \\to -\\infty$. For $t \\to +\\infty$, state $|1\\rangle$ has energy $E_1 \\to +\\infty$ and state $|2\\rangle$ has energy $E_2 \\to -\\infty$. Thus, $|2\\rangle$ corresponds to the lower adiabatic state at $t \\to +\\infty$.\n\nA nonadiabatic transition (a \"hop\") is defined as a transition between adiabatic potential energy surfaces. In this case, it corresponds to the system starting on the lower adiabatic surface (which is diabat $|1\\rangle$ at $t \\to -\\infty$) and ending on the upper adiabatic surface (which is diabat $|1\\rangle$ at $t \\to +\\infty$). Therefore, the nonadiabatic transition probability $P_{\\mathrm{LZ}}$ is the probability of the system remaining in diabatic state $|1\\rangle$ after passing through the crossing region, i.e., $P_{\\mathrm{LZ}} = |c_1(t \\to +\\infty)|^2$.\n\nTo solve the system of equations, we decouple them. We can express $c_1(t)$ from the second equation and substitute it into the first. This procedure leads to a second-order differential equation for $c_2(t)$:\n$$\n\\frac{d^2c_2}{dt^2} + \\left( \\frac{V^2}{\\hbar^2} + \\frac{\\alpha^2 t^2}{4\\hbar^2} - \\frac{i\\alpha}{2\\hbar} \\right) c_2(t) = 0\n$$\nThis equation is a form of the Weber differential equation, whose solutions are parabolic cylinder functions. The rigorous solution involves transforming this equation to its standard form and analyzing the asymptotic behavior of its solutions for $t \\to \\pm\\infty$ to satisfy the initial conditions. This is a standard but lengthy procedure in mathematical physics.\n\nThe result of this analysis for the probability of finding the system in state $|2\\rangle$ at $t \\to +\\infty$, given that it started in state $|1\\rangle$ at $t \\to -\\infty$, is\n$$\n|c_2(+\\infty)|^2 = 1 - \\exp\\left(-\\frac{2\\pi V^2}{\\hbar\\alpha}\\right)\n$$\nThis represents the probability of an adiabatic transition, i.e., staying on the lower adiabatic potential energy curve throughout the passage.\nBy the conservation of probability (unitarity), the sum of probabilities must be one: $|c_1(+\\infty)|^2 + |c_2(+\\infty)|^2 = 1$.\nThus, the nonadiabatic transition probability $P_{\\mathrm{LZ}}$ is:\n$$\nP_{\\mathrm{LZ}} = |c_1(+\\infty)|^2 = 1 - |c_2(+\\infty)|^2 = \\exp\\left(-\\frac{2\\pi V^2}{\\hbar\\alpha}\\right)\n$$\nThe parameter $\\alpha$ is given by $\\alpha = 2 F v_{q}$, where $v_{q} = \\sqrt{2K/\\mu}$. Substituting these into the expression for $P_{\\mathrm{LZ}}$ gives the full symbolic solution:\n$$\nP_{\\mathrm{LZ}} = \\exp\\left(-\\frac{2\\pi V^2}{\\hbar (2 F \\sqrt{2K/\\mu})}\\right) = \\exp\\left(-\\frac{\\pi V^2 \\sqrt{\\mu}}{\\hbar F \\sqrt{2K}}\\right)\n$$\nNow, we must evaluate this expression numerically. For consistency, all parameters must be converted to base SI units (meters, kilograms, seconds, Joules).\n\nThe given parameters are:\n$F = 0.6\\ \\mathrm{eV\\,\\AA^{-1}}$\n$V = 180\\ \\mathrm{cm^{-1}}$\n$\\mu = 10\\ \\mathrm{amu}$\n$K = 0.12\\ \\mathrm{eV}$\n\nThe constants and conversion factors are:\n$\\hbar \\approx 1.05457 \\times 10^{-34}\\ \\mathrm{J\\,s}$\n$1\\ \\mathrm{eV} \\approx 1.60218 \\times 10^{-19}\\ \\mathrm{J}$\n$1\\ \\mathrm{amu} \\approx 1.66054 \\times 10^{-27}\\ \\mathrm{kg}$\n$1\\ \\mathrm{\\AA} = 10^{-10}\\ \\mathrm{m}$\n$E = hc\\tilde{\\nu}$, with $h \\approx 6.62607 \\times 10^{-34}\\ \\mathrm{J\\,s}$ and $c \\approx 2.99792 \\times 10^{8}\\ \\mathrm{m\\,s^{-1}}$.\n\nConversion to SI units:\n$F = 0.6\\ \\mathrm{\\frac{eV}{\\AA}} \\times \\frac{1.60218 \\times 10^{-19}\\ \\mathrm{J}}{1\\ \\mathrm{eV}} \\times \\frac{1\\ \\mathrm{\\AA}}{10^{-10}\\ \\mathrm{m}} = 9.61308 \\times 10^{-10}\\ \\mathrm{J\\,m^{-1}}$\n$V = 180\\ \\mathrm{cm^{-1}} = 18000\\ \\mathrm{m^{-1}}$. The energy is $V = hc\\tilde{\\nu} = (6.62607 \\times 10^{-34}) \\times (2.99792 \\times 10^{8}) \\times (18000) \\approx 3.57685 \\times 10^{-21}\\ \\mathrm{J}$.\n$\\mu = 10\\ \\mathrm{amu} \\times \\frac{1.66054 \\times 10^{-27}\\ \\mathrm{kg}}{1\\ \\mathrm{amu}} = 1.66054 \\times 10^{-26}\\ \\mathrm{kg}$\n$K = 0.12\\ \\mathrm{eV} \\times \\frac{1.60218 \\times 10^{-19}\\ \\mathrm{J}}{1\\ \\mathrm{eV}} = 1.922616 \\times 10^{-20}\\ \\mathrm{J}$\n\nFirst, we calculate the nuclear velocity $v_q$:\n$$\nv_q = \\sqrt{\\frac{2K}{\\mu}} = \\sqrt{\\frac{2 \\times (1.922616 \\times 10^{-20}\\ \\mathrm{J})}{1.66054 \\times 10^{-26}\\ \\mathrm{kg}}} \\approx \\sqrt{2.31566 \\times 10^6\\ \\mathrm{m^2\\,s^{-2}}} \\approx 1521.73\\ \\mathrm{m\\,s^{-1}}\n$$\nNext, we calculate the parameter $\\alpha$:\n$$\n\\alpha = 2 F v_q = 2 \\times (9.61308 \\times 10^{-10}\\ \\mathrm{J\\,m^{-1}}) \\times (1521.73\\ \\mathrm{m\\,s^{-1}}) \\approx 2.92594 \\times 10^{-6}\\ \\mathrm{J\\,s^{-1}}\n$$\nFinally, we calculate the argument of the exponential, $\\gamma = \\frac{2\\pi V^2}{\\hbar\\alpha}$:\n$$\n\\gamma = \\frac{2\\pi (3.57685 \\times 10^{-21}\\ \\mathrm{J})^2}{(1.05457 \\times 10^{-34}\\ \\mathrm{J\\,s}) \\times (2.92594 \\times 10^{-6}\\ \\mathrm{J\\,s^{-1}})} \\approx \\frac{8.03867 \\times 10^{-41}\\ \\mathrm{J^2}}{3.08558 \\times 10^{-40}\\ \\mathrm{J^2}} \\approx 0.26052\n$$\nThe nonadiabatic transition probability is then:\n$$\nP_{\\mathrm{LZ}} = \\exp(-\\gamma) = \\exp(-0.26052) \\approx 0.77065\n$$\nRounding the result to three significant figures, as required, we obtain $P_{\\mathrm{LZ}} \\approx 0.771$.", "answer": "$$\\boxed{0.771}$$", "id": "2640532"}, {"introduction": "Beyond tracking when a molecule reacts, femtochemistry aims to uncover *how* it reacts, including the geometry and orientation of the transition state. Velocity Map Imaging (VMI) is a powerful technique that provides this spatial information by measuring the angular distribution of reaction fragments. This distribution is characterized by an anisotropy parameter, $\\beta(t)$, which evolves in time as the molecules rotate and dissociate. This exercise challenges you to model the time-dependent angular distribution, incorporating the effects of rotational dephasing and the finite instrument response time [@problem_id:2640592]. Mastering this analysis allows you to interpret the rich, multidimensional data from modern femtochemistry experiments and reconstruct a more complete \"molecular movie\" of the reaction.", "problem": "You are modeling a pump–probe femtochemistry experiment where Velocity Map Imaging (VMI) is used to record the angular distribution of recoiling fragments at a fixed kinetic energy, under one-photon dipole excitation with linear polarization. Assume perfect velocity slicing so that the two-dimensional projection on the detector preserves the three-dimensional angular dependence at the selected speed. Let the differential intensity at delay time $t$ be cylindrically symmetric about the polarization axis and described (at fixed speed) by\n$$\nI(\\theta,t) \\propto 1 + \\beta(t)\\,P_2(\\cos\\theta),\n$$\nwhere $\\theta$ is the polar angle (measured in radians), $P_2$ is the second Legendre polynomial, and $\\beta(t)$ is the time-dependent anisotropy parameter. You may assume a single one-photon dipole pathway so that only even Legendre orders up to $l=2$ contribute.\n\nFundamental base:\n- In the dipole approximation, the transition probability is proportional to $|\\boldsymbol\\mu\\cdot\\mathbf{E}|^2\\propto\\cos^2\\theta$, and the angular distribution can be expanded in Legendre polynomials with cylindrical symmetry around the polarization axis.\n- The Legendre polynomials are orthogonal on the unit sphere: $\\int P_{\\ell}(\\cos\\theta)P_{m}(\\cos\\theta)\\,d\\Omega = \\frac{4\\pi}{2\\ell+1}\\delta_{\\ell m}$, where $d\\Omega$ is the element of solid angle.\n- The Heaviside step function $H(t)$ is defined by $H(t)=0$ for $t0$ and $H(t)=1$ for $t\\ge 0$.\n\nModel for dynamics and instrument response:\n- The true anisotropy parameter decays due to rotational dephasing as $\\beta_{\\mathrm{true}}(t)=\\beta_0\\,\\exp(-t/\\tau)\\,H(t)$, where $\\beta_0$ is the initial anisotropy at $t=0$ and $\\tau$ is a positive rotational correlation time.\n- The probe temporal profile (instrument response) is a normalized Gaussian $g(t)=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma_t}\\exp\\!\\left(-\\frac{t^2}{2\\sigma_t^2}\\right)$ with standard deviation $\\sigma_t0$. The measured anisotropy is the convolution $\\beta_{\\mathrm{eff}}(t) = \\int_{-\\infty}^{\\infty}\\beta_{\\mathrm{true}}(t')\\,g(t-t')\\,dt'$.\n\nObservable to report:\n- Define the normalized second Legendre moment of the measured angular distribution as\n$$\nM_2(t) \\equiv \\frac{\\int P_2(\\cos\\theta)\\,I(\\theta,t)\\,d\\Omega}{\\int I(\\theta,t)\\,d\\Omega}.\n$$\nUsing only the fundamental orthogonality of Legendre polynomials, this moment is directly proportional to $\\beta_{\\mathrm{eff}}(t)$.\n\nTask:\n- For each test case below, compute $M_2(t)$ implied by the model. The times $t$, correlation times $\\tau$, and Gaussian widths $\\sigma_t$ are all given in femtoseconds (fs). The anisotropy parameters $\\beta_0$ are dimensionless and must lie in the physically allowed range $[-1,2]$. Angles are measured in radians. Express the final answers for $M_2(t)$ as dimensionless floats rounded to six decimal places.\n\nTest suite (each test case is a tuple $(\\beta_0,\\ \\tau,\\ \\sigma_t,\\ t)$):\n1. $(2.0,\\ 400,\\ 20,\\ 1)$\n2. $(1.5,\\ 300,\\ 30,\\ 3)$\n3. $(1.0,\\ 150,\\ 0,\\ 150)$\n4. $(0.0,\\ 350,\\ 50,\\ 100)$\n5. $(-0.5,\\ 250,\\ 40,\\ -200)$\n\nFinal output format:\n- Your program should produce a single line of output containing the five results as a comma-separated list enclosed in square brackets, for example $[x_1,x_2,x_3,x_4,x_5]$, where each $x_i$ is $M_2(t)$ for test case $i$ rounded to six decimal places and printed as a standard decimal string.", "solution": "The objective is to compute the normalized second Legendre moment of the measured angular distribution, defined as:\n$$\nM_2(t) \\equiv \\frac{\\int P_2(\\cos\\theta)\\,I(\\theta,t)\\,d\\Omega}{\\int I(\\theta,t)\\,d\\Omega}\n$$\nThe analysis proceeds in two main steps: first, to simplify this expression for $M_2(t)$ using the provided form of the intensity $I(\\theta,t)$ and the properties of Legendre polynomials; and second, to derive an analytical expression for the effective time-dependent anisotropy parameter $\\beta_{\\mathrm{eff}}(t)$.\n\nFirst, let us establish the relationship between $M_2(t)$ and $\\beta_{\\mathrm{eff}}(t)$. The intensity is given as $I(\\theta,t) \\propto 1 + \\beta_{\\mathrm{eff}}(t)P_2(\\cos\\theta)$. We can write this with a proportionality constant $C$ as $I(\\theta,t) = C(1 + \\beta_{\\mathrm{eff}}(t)P_2(\\cos\\theta))$. Recognizing that the zeroth Legendre polynomial is $P_0(x) = 1$, we have:\n$$\nI(\\theta,t) = C(P_0(\\cos\\theta) + \\beta_{\\mathrm{eff}}(t)P_2(\\cos\\theta))\n$$\nThe integrals will be evaluated over the full solid angle $\\Omega$. The problem provides the orthogonality relation for Legendre polynomials over the unit sphere:\n$$\n\\int P_{\\ell}(\\cos\\theta)P_{m}(\\cos\\theta)\\,d\\Omega = \\frac{4\\pi}{2\\ell+1}\\delta_{\\ell m}\n$$\nwhere $\\delta_{\\ell m}$ is the Kronecker delta.\n\nThe denominator of $M_2(t)$ is the total intensity integrated over the solid angle:\n$$\n\\int I(\\theta,t)\\,d\\Omega = \\int C(P_0(\\cos\\theta) + \\beta_{\\mathrm{eff}}(t)P_2(\\cos\\theta))\\,d\\Omega\n$$\n$$\n= C \\left( \\int P_0(\\cos\\theta)P_0(\\cos\\theta)\\,d\\Omega + \\beta_{\\mathrm{eff}}(t) \\int P_0(\\cos\\theta)P_2(\\cos\\theta)\\,d\\Omega \\right)\n$$\nUsing the orthogonality relation, the second integral is zero (for $\\ell=0, m=2$). The first integral evaluates to $\\frac{4\\pi}{2(0)+1} = 4\\pi$. Thus, the denominator is:\n$$\n\\int I(\\theta,t)\\,d\\Omega = C \\cdot 4\\pi\n$$\nThe numerator of $M_2(t)$ is:\n$$\n\\int P_2(\\cos\\theta)I(\\theta,t)\\,d\\Omega = \\int P_2(\\cos\\theta) C(P_0(\\cos\\theta) + \\beta_{\\mathrm{eff}}(t)P_2(\\cos\\theta))\\,d\\Omega\n$$\n$$\n= C \\left( \\int P_2(\\cos\\theta)P_0(\\cos\\theta)\\,d\\Omega + \\beta_{\\mathrm{eff}}(t) \\int P_2(\\cos\\theta)P_2(\\cos\\theta)\\,d\\Omega \\right)\n$$\nHere, the first integral is zero (for $\\ell=2, m=0$), and the second integral evaluates to $\\frac{4\\pi}{2(2)+1} = \\frac{4\\pi}{5}$. The numerator is:\n$$\n\\int P_2(\\cos\\theta)I(\\theta,t)\\,d\\Omega = C \\cdot \\beta_{\\mathrm{eff}}(t) \\frac{4\\pi}{5}\n$$\nCombining the numerator and denominator, the constant $C$ cancels, yielding a simple direct relationship:\n$$\nM_2(t) = \\frac{C \\cdot \\beta_{\\mathrm{eff}}(t) \\frac{4\\pi}{5}}{C \\cdot 4\\pi} = \\frac{1}{5}\\beta_{\\mathrm{eff}}(t)\n$$\nThe problem is therefore reduced to calculating $\\beta_{\\mathrm{eff}}(t)$.\n\nSecond, we derive the analytical form of $\\beta_{\\mathrm{eff}}(t)$. It is defined as the convolution of the true anisotropy $\\beta_{\\mathrm{true}}(t')$ with the Gaussian instrument response function (IRF) $g(t')$:\n$$\n\\beta_{\\mathrm{eff}}(t) = \\int_{-\\infty}^{\\infty}\\beta_{\\mathrm{true}}(t')\\,g(t-t')\\,dt'\n$$\nSubstituting the given functions $\\beta_{\\mathrm{true}}(t')=\\beta_0\\,\\exp(-t'/\\tau)\\,H(t')$ and $g(t')=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma_t}\\exp(-t'^2/(2\\sigma_t^2))$:\n$$\n\\beta_{\\mathrm{eff}}(t) = \\int_{-\\infty}^{\\infty} \\beta_0 e^{-t'/\\tau} H(t') \\frac{1}{\\sqrt{2\\pi}\\,\\sigma_t} e^{-\\frac{(t-t')^2}{2\\sigma_t^2}} dt'\n$$\nThe Heaviside function $H(t')$ restricts the integration domain to $[0, \\infty)$:\n$$\n\\beta_{\\mathrm{eff}}(t) = \\frac{\\beta_0}{\\sqrt{2\\pi}\\,\\sigma_t} \\int_{0}^{\\infty} e^{-t'/\\tau} e^{-\\frac{(t-t')^2}{2\\sigma_t^2}} dt'\n$$\nTo solve this integral, we complete the square in the exponent for the variable $t'$. The combined terms in the exponent are:\n$$\n-\\frac{t'}{\\tau} - \\frac{t'^2 - 2tt' + t^2}{2\\sigma_t^2} = -\\frac{1}{2\\sigma_t^2} \\left( t'^2 - 2\\left(t - \\frac{\\sigma_t^2}{\\tau}\\right)t' + t^2 \\right)\n$$\nCompleting the square for $t'$ yields:\n$$\n-\\frac{1}{2\\sigma_t^2} \\left[ \\left(t' - \\left(t - \\frac{\\sigma_t^2}{\\tau}\\right)\\right)^2 - \\left(t - \\frac{\\sigma_t^2}{\\tau}\\right)^2 + t^2 \\right] = -\\frac{\\left(t' - (t - \\frac{\\sigma_t^2}{\\tau})\\right)^2}{2\\sigma_t^2} - \\frac{t}{\\tau} + \\frac{\\sigma_t^2}{2\\tau^2}\n$$\nFactoring out the terms not dependent on $t'$ from the integral:\n$$\n\\beta_{\\mathrm{eff}}(t) = \\beta_0 \\exp\\left(-\\frac{t}{\\tau} + \\frac{\\sigma_t^2}{2\\tau^2}\\right) \\frac{1}{\\sqrt{2\\pi}\\,\\sigma_t} \\int_{0}^{\\infty} \\exp\\left(-\\frac{(t' - (t - \\sigma_t^2/\\tau))^2}{2\\sigma_t^2} \\right) dt'\n$$\nThe remaining integral is related to the complementary error function, $\\text{erfc}(x) = \\frac{2}{\\sqrt{\\pi}}\\int_x^\\infty e^{-z^2}dz$. By performing a change of variables $u = \\frac{t' - (t - \\sigma_t^2/\\tau)}{\\sqrt{2}\\sigma_t}$, the integral resolves to:\n$$\n\\frac{1}{\\sqrt{\\pi}} \\int_{- \\frac{t - \\sigma_t^2/\\tau}{\\sqrt{2}\\sigma_t}}^{\\infty} e^{-u^2}du = \\frac{1}{2}\\text{erfc}\\left(\\frac{\\sigma_t^2/\\tau - t}{\\sqrt{2}\\sigma_t}\\right) = \\frac{1}{2}\\text{erfc}\\left(\\frac{\\sigma_t}{\\sqrt{2}\\tau} - \\frac{t}{\\sqrt{2}\\sigma_t}\\right)\n$$\nCombining all parts gives the final expression for $\\beta_{\\mathrm{eff}}(t)$:\n$$\n\\beta_{\\mathrm{eff}}(t) = \\frac{\\beta_0}{2} \\exp\\left(\\frac{\\sigma_t^2}{2\\tau^2} - \\frac{t}{\\tau}\\right) \\text{erfc}\\left( \\frac{\\sigma_t}{\\sqrt{2}\\tau} - \\frac{t}{\\sqrt{2}\\sigma_t} \\right)\n$$\nFor the special case where $\\sigma_t=0$, the Gaussian IRF $g(t')$ becomes a Dirac delta function $\\delta(t')$. The convolution simplifies to $\\beta_{\\mathrm{eff}}(t) = \\beta_{\\mathrm{true}}(t) = \\beta_0 \\exp(-t/\\tau)H(t)$. This means for $t  0$, $\\beta_{\\mathrm{eff}}(t)=0$, and for $t \\ge 0$, $\\beta_{\\mathrm{eff}}(t)=\\beta_0 \\exp(-t/\\tau)$. Also, if $\\beta_0=0$, then $\\beta_{\\mathrm{eff}}(t)=0$ for all time.\n\nThese final expressions are used to calculate the values for each test case.", "answer": "```python\nimport numpy as np\nfrom scipy.special import erfc\n\ndef solve():\n    \"\"\"\n    Solves for the normalized second Legendre moment M2(t) for a series\n    of femtochemistry pump-probe experiment models.\n    \"\"\"\n    # Test suite: each tuple is (beta_0, tau, sigma_t, t)\n    # beta_0 is dimensionless initial anisotropy.\n    # tau is rotational correlation time in fs.\n    # sigma_t is Gaussian IRF width in fs.\n    # t is the pump-probe delay time in fs.\n    test_cases = [\n        (2.0, 400.0, 20.0, 1.0),\n        (1.5, 300.0, 30.0, 3.0),\n        (1.0, 150.0, 0.0, 150.0),\n        (0.0, 350.0, 50.0, 100.0),\n        (-0.5, 250.0, 40.0, -200.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        beta_0, tau, sigma_t, t = case\n\n        beta_eff = 0.0\n        # The problem states tau is a positive rotational correlation time.\n        # Thus, we do not need to handle tau = 0.\n        if beta_0 == 0.0:\n            # If initial anisotropy is zero, the effective anisotropy is always zero.\n            beta_eff = 0.0\n        elif sigma_t == 0.0:\n            # Case of an infinitely short probe pulse (Dirac delta IRF).\n            # The convolution yields the true anisotropy itself.\n            # Heaviside function H(t) is 1 for t >= 0 and 0 for t  0.\n            if t >= 0:\n                beta_eff = beta_0 * np.exp(-t / tau)\n            else:\n                beta_eff = 0.0\n        else: # sigma_t > 0\n            # Full convolution of exponential decay with a Gaussian.\n            # val_exp is the argument of the exponential function.\n            val_exp = (sigma_t**2) / (2 * tau**2) - t / tau\n            # arg_erfc is the argument of the complementary error function.\n            arg_erfc = (sigma_t / (np.sqrt(2) * tau)) - (t / (np.sqrt(2) * sigma_t))\n            \n            beta_eff = (beta_0 / 2.0) * np.exp(val_exp) * erfc(arg_erfc)\n\n        # The normalized second Legendre moment M2(t) is beta_eff(t) / 5.\n        m2 = beta_eff / 5.0\n        results.append(f\"{m2:.6f}\")\n\n    # Print the results in the required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2640592"}]}