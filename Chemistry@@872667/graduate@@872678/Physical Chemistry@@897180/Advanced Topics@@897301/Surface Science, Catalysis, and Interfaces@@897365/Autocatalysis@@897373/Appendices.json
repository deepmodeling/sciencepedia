{"hands_on_practices": [{"introduction": "To begin our practical exploration, we will analyze the archetypal autocatalytic reaction in a closed batch reactor. This foundational exercise guides you through deriving the temporal evolution of the autocatalyst concentration from first principles. By solving the governing differential equation, you will uncover the quantitative origin of the characteristic sigmoidal growth curve and understand how the initial catalyst amount dictates the reaction's lag phase [@problem_id:2624643].", "problem": "A well-mixed, isothermal, constant-volume batch reactor contains species with concentrations $A(t)$ and $X(t)$ undergoing the autocatalytic reaction $A+X \\xrightarrow{k} 2X$ with a second-order rate law $r(t)=k\\,A(t)\\,X(t)$, where $k>0$ is the rate constant. Assume there are no side reactions, no reverse reaction, and that mass action kinetics holds exactly. The initial concentrations at $t=0$ are $A(0)=A_{0}>0$ and $X(0)=X_{0}>0$, and the system is closed so that total moles are conserved. Consider the case $0<X_{0}<A_{0}$ so that the concentration $X(t)$ is initially below half of the conserved total.\n\nStarting only from the law of mass action and conservation of mass, derive the exact time $t_{1/2}$ at which $X(t)$ first reaches the value $(A_{0}+X_{0})/2$. Express your final result as a closed-form analytic expression in terms of $k$, $A_{0}$, and $X_{0}$. Additionally, provide a qualitative discussion of how $t_{1/2}$ depends on the initial “seed” $X_{0}$ when $A_{0}$ and $k$ are held fixed.\n\nYour final answer must be a single closed-form expression for $t_{1/2}$; do not provide a numerical approximation.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard scenario in chemical kinetics that is solvable using fundamental principles. The provided information is complete and consistent. Therefore, we may proceed with the derivation.\n\nThe autocatalytic reaction is given by $A+X \\xrightarrow{k} 2X$. The rate of reaction, $r(t)$, based on the law of mass action for this second-order process is $r(t)=k\\,A(t)\\,X(t)$, where $A(t)$ and $X(t)$ are the concentrations of species $A$ and $X$ at time $t$, and $k$ is the rate constant.\n\nThe rates of change of the concentrations are derived from the stoichiometry of the reaction. For each mole of $A$ consumed, one mole of $X$ is consumed and two moles of $X$ are produced, resulting in a net production of one mole of $X$.\nThe corresponding differential rate equations are:\n$$\n\\frac{dA}{dt} = -k\\,A(t)\\,X(t)\n$$\n$$\n\\frac{dX}{dt} = +k\\,A(t)\\,X(t)\n$$\nSumming these two equations yields:\n$$\n\\frac{dA}{dt} + \\frac{dX}{dt} = \\frac{d}{dt}(A(t) + X(t)) = -k\\,A(t)\\,X(t) + k\\,A(t)\\,X(t) = 0\n$$\nThis equation implies that the sum of the concentrations of $A$ and $X$ is a conserved quantity. We can integrate this equation with respect to time from $t=0$ to a general time $t$:\n$$\nA(t) + X(t) = \\text{constant}\n$$\nUsing the initial conditions $A(0) = A_{0}$ and $X(0) = X_{0}$, we find the value of this constant:\n$$\nA(t) + X(t) = A_{0} + X_{0}\n$$\nThis conservation law holds for all time $t \\ge 0$. We can use this to express $A(t)$ in terms of $X(t)$:\n$$\nA(t) = (A_{0} + X_{0}) - X(t)\n$$\nSubstituting this expression for $A(t)$ into the rate equation for $X(t)$ gives a single differential equation in terms of $X(t)$:\n$$\n\\frac{dX}{dt} = k\\,X(t)\\,[(A_{0} + X_{0}) - X(t)]\n$$\nThis is a first-order, nonlinear, separable ordinary differential equation. We can separate the variables to prepare for integration:\n$$\n\\frac{dX}{X(t)\\,[(A_{0} + X_{0}) - X(t)]} = k\\,dt\n$$\nTo integrate the left-hand side, we use the method of partial fraction decomposition. Let the total initial concentration be $C_{total} = A_{0} + X_{0}$. The integrand is $\\frac{1}{X(C_{total} - X)}$.\n$$\n\\frac{1}{X(C_{total} - X)} = \\frac{P}{X} + \\frac{Q}{C_{total} - X}\n$$\nSolving for the coefficients gives $P=Q=\\frac{1}{C_{total}}$. Therefore:\n$$\n\\frac{1}{C_{total}}\\left(\\frac{1}{X} + \\frac{1}{C_{total} - X}\\right)dX = k\\,dt\n$$\nWe integrate both sides from the initial state at $t=0$ (where $X=X_{0}$) to the state at time $t$ (where the concentration is $X(t)$):\n$$\n\\frac{1}{A_{0} + X_{0}} \\int_{X_{0}}^{X(t)} \\left(\\frac{1}{X'} + \\frac{1}{(A_{0} + X_{0}) - X'}\\right) dX' = \\int_{0}^{t} k\\,dt'\n$$\nThe reaction progresses from $X_0$ towards $A_0+X_0$, with $A$ decreasing from $A_0$ to $0$. In the range of interest, $X(t)$ and $A(t)=(A_0+X_0)-X(t)$ are positive, so we can omit absolute value signs in the logarithms.\n$$\n\\frac{1}{A_{0} + X_{0}} \\left[ \\ln(X') - \\ln((A_{0} + X_{0}) - X') \\right]_{X_{0}}^{X(t)} = k[t']_{0}^{t}\n$$\n$$\n\\frac{1}{A_{0} + X_{0}} \\left[ \\ln\\left(\\frac{X(t)}{(A_{0} + X_{0}) - X(t)}\\right) - \\ln\\left(\\frac{X_{0}}{(A_{0} + X_{0}) - X_{0}}\\right) \\right] = kt\n$$\nRecognizing that $(A_{0} + X_{0}) - X(t) = A(t)$ and $(A_{0} + X_{0}) - X_{0} = A_{0}$, we can simplify the expression:\n$$\n\\frac{1}{A_{0} + X_{0}} \\left[ \\ln\\left(\\frac{X(t)}{A(t)}\\right) - \\ln\\left(\\frac{X_{0}}{A_{0}}\\right) \\right] = kt\n$$\n$$\nkt = \\frac{1}{A_{0} + X_{0}} \\ln\\left(\\frac{A_{0}X(t)}{A(t)X_{0}}\\right)\n$$\nWe are asked to find the time $t_{1/2}$ at which $X(t)$ reaches the value $\\frac{A_{0}+X_{0}}{2}$. Let's evaluate the state of the system at this specific time.\nAt $t=t_{1/2}$, we have $X(t_{1/2}) = \\frac{A_{0}+X_{0}}{2}$.\nUsing the conservation law, the concentration of $A$ at this time is:\n$$\nA(t_{1/2}) = (A_{0} + X_{0}) - X(t_{1/2}) = (A_{0} + X_{0}) - \\frac{A_{0}+X_{0}}{2} = \\frac{A_{0}+X_{0}}{2}\n$$\nThus, at time $t_{1/2}$, the concentrations of $A$ and $X$ are equal: $A(t_{1/2}) = X(t_{1/2})$. The ratio $\\frac{X(t_{1/2})}{A(t_{1/2})} = 1$.\nSubstituting this condition into our integrated rate equation:\n$$\nk t_{1/2} = \\frac{1}{A_{0} + X_{0}} \\ln\\left(\\frac{A_{0}}{X_{0}} \\cdot \\frac{X(t_{1/2})}{A(t_{1/2})}\\right) = \\frac{1}{A_{0} + X_{0}} \\ln\\left(\\frac{A_{0}}{X_{0}} \\cdot 1\\right)\n$$\nSolving for $t_{1/2}$, we obtain the final expression:\n$$\nt_{1/2} = \\frac{1}{k(A_{0}+X_{0})} \\ln\\left(\\frac{A_{0}}{X_{0}}\\right)\n$$\nThe problem constraint $0<X_{0}<A_{0}$ ensures that the argument of the logarithm, $\\frac{A_{0}}{X_{0}}$, is greater than $1$, so $\\ln(\\frac{A_{0}}{X_{0}})$ is positive. Thus, $t_{1/2}$ is positive, which is physically required.\n\nFor the qualitative discussion, we analyze the dependence of $t_{1/2}$ on the initial \"seed\" concentration $X_{0}$, holding $A_{0}$ and $k$ constant.\nThe expression is $t_{1/2}(X_{0}) = \\frac{1}{k(A_{0}+X_{0})} \\ln\\left(\\frac{A_{0}}{X_{0}}\\right)$.\nConsider the limit as $X_{0} \\to 0^{+}$. The term $\\frac{1}{k(A_{0}+X_{0})}$ approaches the finite value $\\frac{1}{k A_{0}}$, while the term $\\ln(\\frac{A_{0}}{X_{0}})$ approaches $+\\infty$. Therefore, $t_{1/2} \\to \\infty$ as $X_{0} \\to 0^{+}$. This is physically sensible: an infinitesimal amount of autocatalyst results in an infinitely long time to reach the specified conversion, as the initial reaction rate is infinitesimally small.\nConsider the other limit as $X_{0} \\to A_{0}^{-}$. The term $\\frac{1}{k(A_{0}+X_{0})}$ approaches the finite value $\\frac{1}{2k A_{0}}$, while the term $\\ln(\\frac{A_{0}}{X_{0}})$ approaches $\\ln(1)=0$. Therefore, $t_{1/2} \\to 0$ as $X_{0} \\to A_{0}^{-}$. This is also logical: if the initial concentration of catalyst $X_{0}$ is already very close to the final concentration $X(t_{1/2})=\\frac{A_0+X_0}{2}$ (since as $X_0 \\to A_0$, the target is $A_0$), the time required to bridge this small gap is very short.\nTo be more rigorous, the derivative of $t_{1/2}$ with respect to $X_{0}$ is strictly negative for $X_{0} \\in (0, A_{0})$, confirming that $t_{1/2}$ is a monotonically decreasing function of $X_{0}$. A larger initial seed $X_{0}$ always shortens the time required to reach the state where $A=X$. The dependence is most sensitive for small values of $X_0$ due to the logarithmic term, which is characteristic of the \"induction period\" of autocatalytic reactions.", "answer": "$$\n\\boxed{\\frac{1}{k(A_{0}+X_{0})} \\ln\\left(\\frac{A_{0}}{X_{0}}\\right)}\n$$", "id": "2624643"}, {"introduction": "Having mastered the closed system, we now introduce new complexity by placing the autocatalytic reaction within an open system—a continuously stirred-tank reactor (CSTR). This practice demonstrates how the interplay between reaction kinetics and continuous flow can generate multiple steady states. Through linear stability analysis, you will determine the conditions under which the system can exist in either a \"washout\" state or a stable \"reaction\" state, a classic example of bistability in chemical engineering [@problem_id:2624731].", "problem": "Consider an isothermal, perfectly mixed continuous stirred-tank reactor (CSTR) of constant volume in which the autocatalytic reaction $\\mathrm{A} + \\mathrm{X} \\to 2\\,\\mathrm{X}$ proceeds with mass-action rate $r = k a x$, where $a$ and $x$ denote the concentrations of species $\\mathrm{A}$ and $\\mathrm{X}$, respectively, and $k>0$ is the rate constant. The reactor is fed at volumetric flow rate such that the residence time is $\\tau>0$, with feed concentrations $a_f>0$ for $\\mathrm{A}$ and $x_f = 0$ for $\\mathrm{X}$. Assume constant density and perfect mixing. The deterministic species balances are\n$$\n\\frac{d a}{d t} = \\frac{a_f - a}{\\tau} - k a x,\\qquad\n\\frac{d x}{d t} = \\frac{x_f - x}{\\tau} + k a x,\n$$\nwith $x_f = 0$.\n\nStarting from these balances and the law of mass action, do the following:\n- Derive all steady states $(a^{*}, x^{*})$ of the reactor.\n- Linearize the dynamics about each steady state to obtain the Jacobian matrix $J(a^{*}, x^{*})$.\n- Compute the eigenvalues of $J(a^{*}, x^{*})$ at the steady state with $x^{*} = 0$ and at the steady state with $x^{*} > 0$ (when such a state exists), and use their signs to assess local stability in each case. You must provide the eigenvalues in closed form as functions of $k$, $a_f$, and $\\tau$.\n\nAnswer specification:\n- Report the four eigenvalues, ordered as $\\lambda_{0,1}$, $\\lambda_{0,2}$ (for the steady state with $x^{*}=0$), followed by $\\lambda_{+,1}$, $\\lambda_{+,2}$ (for the steady state with $x^{*}>0$), as a single row matrix using the $\\mathrm{pmatrix}$ notation.\n- Express the eigenvalues in $\\mathrm{s}^{-1}$.\n- No numerical substitution or rounding is required; provide exact symbolic expressions only.", "solution": "The problem as stated constitutes a well-posed, scientifically grounded exercise in chemical reaction engineering and nonlinear dynamics. It is based on fundamental principles of mass balance and mass-action kinetics, is mathematically self-contained, and has a unique, verifiable solution. We shall proceed with the derivation.\n\nThe dynamics of the concentrations of species $\\mathrm{A}$ and $\\mathrm{X}$, denoted by $a(t)$ and $x(t)$ respectively, are described by the following system of ordinary differential equations:\n$$\n\\frac{d a}{d t} = \\frac{a_f - a}{\\tau} - k a x\n$$\n$$\n\\frac{d x}{d t} = -\\frac{x}{\\tau} + k a x\n$$\nHere, $a_f > 0$ is the feed concentration of $\\mathrm{A}$, $\\tau > 0$ is the reactor residence time, and $k > 0$ is the reaction rate constant. The feed concentration of $\\mathrm{X}$ is given as $x_f = 0$.\n\nFirst, we determine the steady states $(a^*, x^*)$ of the system by setting the time derivatives to zero:\n$$\n\\frac{a_f - a^*}{\\tau} - k a^* x^* = 0 \\quad (1)\n$$\n$$\n-\\frac{x^*}{\\tau} + k a^* x^* = 0 \\quad (2)\n$$\nFrom equation $(2)$, we can factor out $x^*$:\n$$\nx^* \\left( k a^* - \\frac{1}{\\tau} \\right) = 0\n$$\nThis equation admits two possible solutions for the steady state.\n\nCase 1: The washout steady state.\nThe first solution is $x^* = 0$. Substituting this into equation $(1)$:\n$$\n\\frac{a_f - a^*}{\\tau} - k a^* (0) = 0 \\implies a_f - a^* = 0 \\implies a^* = a_f\n$$\nThus, the first steady state is $(a_0^*, x_0^*) = (a_f, 0)$. This state corresponds to the complete washout of the autocatalyst $\\mathrm{X}$, where only the feed species $\\mathrm{A}$ is present at its feed concentration.\n\nCase 2: The reaction steady state.\nThe second solution arises from the other factor in the factored equation $(2)$:\n$$\nk a^* - \\frac{1}{\\tau} = 0 \\implies a^* = \\frac{1}{k \\tau}\n$$\nWe substitute this value of $a^*$ back into equation $(1)$ to solve for $x^*$:\n$$\n\\frac{a_f - (1/k\\tau)}{\\tau} - k \\left(\\frac{1}{k\\tau}\\right) x^* = 0\n$$\n$$\n\\frac{a_f}{\\tau} - \\frac{1}{k\\tau^2} - \\frac{x^*}{\\tau} = 0\n$$\nMultiplying by $\\tau$ and rearranging gives:\n$$\nx^* = a_f - \\frac{1}{k\\tau}\n$$\nFor this steady state to be physically meaningful, the concentration $x^*$ must be non-negative. Since $k, \\tau, a_f$ are all positive, $a^*$ is always positive. The condition $x^* > 0$ requires $a_f > 1/(k\\tau)$, which is equivalent to the condition $k \\tau a_f > 1$.\nThus, the second steady state is $(a_+^*, x_+^*) = \\left(\\frac{1}{k\\tau}, a_f - \\frac{1}{k\\tau}\\right)$, and it exists only when $k \\tau a_f > 1$.\n\nNext, we linearize the system by computing the Jacobian matrix $J(a, x)$. Let the vector of functions be $\\mathbf{f}(a,x) = \\left( \\frac{a_f - a}{\\tau} - k a x, -\\frac{x}{\\tau} + k a x \\right)^T$. The Jacobian is:\n$$\nJ(a, x) = \\begin{pmatrix} \\frac{\\partial f_a}{\\partial a} & \\frac{\\partial f_a}{\\partial x} \\\\ \\frac{\\partial f_x}{\\partial a} & \\frac{\\partial f_x}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{\\tau} - kx & -ka \\\\ kx & -\\frac{1}{\\tau} + ka \\end{pmatrix}\n$$\n\nWe now evaluate the Jacobian at each steady state to determine local stability.\n\nAnalysis of the washout steady state $(a_f, 0)$:\nSubstituting $(a, x) = (a_f, 0)$ into the Jacobian matrix:\n$$\nJ(a_f, 0) = \\begin{pmatrix} -\\frac{1}{\\tau} - k(0) & -ka_f \\\\ k(0) & -\\frac{1}{\\tau} + ka_f \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{\\tau} & -ka_f \\\\ 0 & ka_f - \\frac{1}{\\tau} \\end{pmatrix}\n$$\nSince this is an upper triangular matrix, the eigenvalues are its diagonal entries.\nThe eigenvalues for the washout state are:\n$$\n\\lambda_{0,1} = -\\frac{1}{\\tau}\n$$\n$$\n\\lambda_{0,2} = k a_f - \\frac{1}{\\tau}\n$$\nFor stability, all eigenvalues must have negative real parts. $\\lambda_{0,1}$ is always negative since $\\tau > 0$. The sign of $\\lambda_{0,2}$ depends on the value of $k \\tau a_f$.\nIf $k \\tau a_f < 1$, both eigenvalues are negative, and the washout state is a stable node.\nIf $k \\tau a_f > 1$, $\\lambda_{0,2}$ becomes positive, and the washout state is an unstable saddle point.\n\nAnalysis of the reaction steady state $(\\frac{1}{k\\tau}, a_f - \\frac{1}{k\\tau})$:\nThis state exists for $k \\tau a_f > 1$. We substitute $(a_+^*, x_+^*) = (\\frac{1}{k\\tau}, a_f - \\frac{1}{k\\tau})$ into the Jacobian:\n$$\nJ(a_+^*, x_+^*) = \\begin{pmatrix} -\\frac{1}{\\tau} - k(a_f - \\frac{1}{k\\tau}) & -k(\\frac{1}{k\\tau}) \\\\ k(a_f - \\frac{1}{k\\tau}) & -\\frac{1}{\\tau} + k(\\frac{1}{k\\tau}) \\end{pmatrix}\n$$\n$$\nJ(a_+^*, x_+^*) = \\begin{pmatrix} -ka_f & -\\frac{1}{\\tau} \\\\ ka_f - \\frac{1}{\\tau} & 0 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ are found from the characteristic equation $\\det(J - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -ka_f - \\lambda & -\\frac{1}{\\tau} \\\\ ka_f - \\frac{1}{\\tau} & -\\lambda \\end{pmatrix} = 0\n$$\n$$\n(-\\lambda)(-ka_f - \\lambda) - \\left(-\\frac{1}{\\tau}\\right)\\left(ka_f - \\frac{1}{\\tau}\\right) = 0\n$$\n$$\n\\lambda^2 + ka_f \\lambda + \\left(\\frac{ka_f}{\\tau} - \\frac{1}{\\tau^2}\\right) = 0\n$$\nThe sum of the roots is $\\lambda_{+,1} + \\lambda_{+,2} = -ka_f < 0$. The product of the roots is $\\lambda_{+,1} \\lambda_{+,2} = \\frac{ka_f}{\\tau} - \\frac{1}{\\tau^2} = \\frac{k\\tau a_f - 1}{\\tau^2}$. Since this state exists only for $k\\tau a_f > 1$, the product of the roots is positive. A negative sum and positive product implies that both eigenvalues have negative real parts. Therefore, the reaction steady state is always locally stable when it exists.\n\nTo find the eigenvalues in closed form, we solve the quadratic equation:\n$$\n\\lambda = \\frac{-ka_f \\pm \\sqrt{(ka_f)^2 - 4\\left(\\frac{ka_f}{\\tau} - \\frac{1}{\\tau^2}\\right)}}{2}\n$$\n$$\n\\lambda = \\frac{-ka_f \\pm \\sqrt{k^2 a_f^2 - \\frac{4ka_f}{\\tau} + \\frac{4}{\\tau^2}}}{2}\n$$\nThe term under the square root is a perfect square: $(ka_f - \\frac{2}{\\tau})^2$.\n$$\n\\lambda = \\frac{-ka_f \\pm \\sqrt{\\left(ka_f - \\frac{2}{\\tau}\\right)^2}}{2} = \\frac{-ka_f \\pm \\left|ka_f - \\frac{2}{\\tau}\\right|}{2}\n$$\nThis gives two eigenvalues. Let us take the two solutions from removing the absolute value:\n$$\n\\lambda_{+,1} = \\frac{-ka_f + (ka_f - \\frac{2}{\\tau})}{2} = \\frac{-2/\\tau}{2} = -\\frac{1}{\\tau}\n$$\n$$\n\\lambda_{+,2} = \\frac{-ka_f - (ka_f - \\frac{2}{\\tau})}{2} = \\frac{-2ka_f + 2/\\tau}{2} = \\frac{1}{\\tau} - ka_f\n$$\nThese are the two eigenvalues for the reaction state. As established, both are negative for $k\\tau a_f > 1$.\n\nThe four requested eigenvalues are:\nFor the steady state with $x^*=0$: $\\lambda_{0,1} = -\\frac{1}{\\tau}$, $\\lambda_{0,2} = k a_f - \\frac{1}{\\tau}$.\nFor the steady state with $x^*>0$: $\\lambda_{+,1} = -\\frac{1}{\\tau}$, $\\lambda_{+,2} = \\frac{1}{\\tau} - k a_f$.", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{\\tau} & k a_f - \\frac{1}{\\tau} & -\\frac{1}{\\tau} & \\frac{1}{\\tau} - k a_f \\end{pmatrix}}\n$$", "id": "2624731"}, {"introduction": "Our final practice transitions from the deterministic world of concentrations to the stochastic reality of individual molecules, which is essential for understanding phenomena at the nanoscale or in biological cells. This problem challenges you to model the lag time not as a fixed number, but as a statistical distribution arising from the inherently random nature of molecular collisions. By analyzing the underlying pure birth process, you will derive the distribution of first-passage times and appreciate how intrinsic noise governs the initiation of autocatalytic reactions [@problem_id:2624746].", "problem": "Consider a well-mixed, isothermal, isochoric nanoscopic reactor in which the only chemically relevant process is the autocatalytic reaction $\\mathrm{A} + \\mathrm{X} \\to 2\\mathrm{X}$ under dilute solution conditions. Assume elementary mass-action kinetics and a stochastic description via the chemical master equation. Let the total volume be $V$ in liters, the initial number of substrate molecules be $A_0$ (dimensionless count), the bimolecular rate constant be $k$ in $\\mathrm{M^{-1}\\,s^{-1}}$, and the initial autocatalyst count be $X(0)=1$ molecule. Define the lag time $T_N$ as the random first-passage time (in seconds) at which the autocatalyst count first reaches $X=N$ molecules. Assume substrate is not replenished and is consumed only by the autocatalytic reaction. For small targets $N$ relative to $A_0$, it is physically justified to approximate the substrate concentration as effectively constant up to the threshold $N$.\n\nStarting only from the law of mass action, the definition of the chemical master equation (CME), and the conversion between molecule counts and molar concentration via Avogadro’s number $N_\\mathrm{A}=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$, implement a program that, for each specified parameter set, estimates the distribution of $T_N$ under the constant-substrate approximation and reports the $\\alpha$-quantiles for $\\alpha\\in\\{0.1,0.5,0.9\\}$. Your method must be derived from first principles, either by an exact computation from the CME for this approximation or by a statistically correct stochastic simulation that is consistent with the CME. All times must be expressed in seconds and rounded to six decimal places.\n\nUnder the constant-substrate approximation up to the threshold $N$, take the substrate molar concentration as $[\\mathrm{A}]=A_0/(N_\\mathrm{A} V)$ in $\\mathrm{M}$ so that the per-molecule autocatalytic propensity factor is $\\lambda = k[\\mathrm{A}]$ in $\\mathrm{s^{-1}}$. Use this to construct a principled estimator for the cumulative distribution function of $T_N$ and compute the required quantiles.\n\nTest suite:\n- Case 1 (happy path): $V=1\\times 10^{-15}\\,\\mathrm{L}$, $A_0=100$, $k=1.0\\times 10^{6}\\,\\mathrm{M^{-1}\\,s^{-1}}$, $N=10$.\n- Case 2 (rate reduced): $V=1\\times 10^{-15}\\,\\mathrm{L}$, $A_0=100$, $k=5.0\\times 10^{5}\\,\\mathrm{M^{-1}\\,s^{-1}}$, $N=10$.\n- Case 3 (volume halved): $V=5\\times 10^{-16}\\,\\mathrm{L}$, $A_0=100$, $k=1.0\\times 10^{6}\\,\\mathrm{M^{-1}\\,s^{-1}}$, $N=10$.\n- Case 4 (boundary in target size): $V=1\\times 10^{-15}\\,\\mathrm{L}$, $A_0=100$, $k=1.0\\times 10^{6}\\,\\mathrm{M^{-1}\\,s^{-1}}$, $N=2$.\n\nYour program should produce a single line of output containing the $0.1$, $0.5$, and $0.9$ quantiles of $T_N$ for each case, in seconds, rounded to six decimal places, aggregated into a comma-separated list enclosed in square brackets, in the order: Case $1$ then Case $2$ then Case $3$ then Case $4$, each case contributing the three quantiles in the order $\\alpha=0.1,0.5,0.9$. For example, the output format must be exactly like $[q_{1,0.1},q_{1,0.5},q_{1,0.9},q_{2,0.1},q_{2,0.5},q_{2,0.9},q_{3,0.1},q_{3,0.5},q_{3,0.9},q_{4,0.1},q_{4,0.5},q_{4,0.9}]$ where each $q_{\\cdot,\\cdot}$ is a float in seconds rounded to six decimal places.", "solution": "The problem statement is evaluated and determined to be valid. It is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard problem in stochastic chemical kinetics that is solvable from first principles as requested.\n\nWe are tasked with finding the quantiles of the first-passage time $T_N$ for an autocatalytic reaction $\\mathrm{A} + \\mathrm{X} \\to 2\\mathrm{X}$ in a constant volume $V$, starting with $X(0)=1$ molecule. The analysis is to be performed under the approximation that the substrate concentration $[\\mathrm{A}]$ is constant.\n\nThe fundamental description of this stochastic process is the Chemical Master Equation (CME). The rate of a chemical reaction event is described by the propensity function. For the bimolecular reaction $\\mathrm{A} + \\mathrm{X} \\to 2\\mathrm{X}$, the law of mass action gives the propensity function $a(n_A, n_X)$ for a single reaction event to occur in a system containing $n_A$ molecules of $\\mathrm{A}$ and $n_X$ molecules of $\\mathrm{X}$:\n$$\na(n_A, n_X) = c \\cdot n_A \\cdot n_X\n$$\nwhere $c$ is the stochastic rate constant. This constant is related to the deterministic rate constant $k$ (in units of $\\mathrm{M^{-1}\\,s^{-1}}$) by $c = k / (N_\\mathrm{A} V)$, where $N_\\mathrm{A}$ is Avogadro's number. Thus,\n$$\na(n_A, n_X) = \\frac{k}{N_\\mathrm{A} V} n_A n_X\n$$\nThe problem specifies that for the purpose of calculating the lag time $T_N$, the substrate concentration is to be considered constant at its initial value, $[\\mathrm{A}]_0 = A_0 / (N_\\mathrm{A} V)$, where $A_0$ is the initial number of substrate molecules. This implies that the number of substrate molecules $n_A$ in the propensity function is treated as constant, $n_A = A_0$. Note that species $\\mathrm{A}$ is consumed, so this is an approximation valid for $N \\ll A_0$. Under this approximation, the propensity for the number of $\\mathrm{X}$ molecules to increase by one (a \"birth\" event) depends only on the current number of $\\mathrm{X}$ molecules, which we denote by $j$. Let this propensity be $a_j$:\n$$\na_j = \\frac{k}{N_\\mathrm{A} V} A_0 j\n$$\nWe define a constant rate parameter $\\lambda$ as specified in the problem statement:\n$$\n\\lambda = k [\\mathrm{A}]_0 = k \\frac{A_0}{N_\\mathrm{A} V}\n$$\nThe units of $\\lambda$ are $\\mathrm{s^{-1}}$. The propensity for a birth event can now be written as:\n$$\na_j = \\lambda j\n$$\nThis describes a pure birth process, also known as a Yule process. The state of the system is fully characterized by the number of $\\mathrm{X}$ molecules.\n\nThe lag time $T_N$ is the first-passage time to reach the state $N$ starting from the state $X(0)=1$. This process requires $N-1$ successive birth events (from $j=1$ to $j=2$, from $j=2$ to $j=3$, ..., from $j=N-1$ to $j=N$). The total time $T_N$ is the sum of the waiting times for each of these steps:\n$$\nT_N = \\sum_{j=1}^{N-1} \\tau_j\n$$\nwhere $\\tau_j$ is the random waiting time for the reaction to occur when the system is in state $j$ (i.e., has $j$ molecules of $\\mathrm{X}$).\n\nFrom the theory of stochastic processes described by the CME, the waiting time in any given state is an exponentially distributed random variable. The rate parameter of this exponential distribution is the total propensity to exit the state. In our case, the waiting time $\\tau_j$ for the transition $j \\to j+1$ is exponentially distributed with rate $a_j = \\lambda j$:\n$$\n\\tau_j \\sim \\mathrm{Exponential}(\\lambda j)\n$$\nThe random variables $\\tau_j$ are mutually independent. Therefore, $T_N$ is a sum of $N-1$ independent but not identically distributed exponential random variables. Such a sum follows a hypoexponential distribution.\n\nThe cumulative distribution function (CDF) of $T_N$, denoted $F_{T_N}(t)$, can be derived systematically. The Laplace transform of the probability density function (PDF) of $\\tau_j$ is $\\mathcal{L}_{\\tau_j}(s) = \\frac{\\lambda j}{s + \\lambda j}$. Due to independence, the Laplace transform of the PDF of $T_N$ is the product:\n$$\n\\mathcal{L}_{T_N}(s) = \\prod_{j=1}^{N-1} \\mathcal{L}_{\\tau_j}(s) = \\prod_{j=1}^{N-1} \\frac{\\lambda j}{s + \\lambda j}\n$$\nBy performing a partial fraction expansion of $\\mathcal{L}_{T_N}(s)$ and then applying the inverse Laplace transform, one can obtain the PDF and, by integration, the CDF. A known result for this specific series of rates ($\\lambda, 2\\lambda, \\dots, (N-1)\\lambda$) is the elegant expression for the CDF:\n$$\nF_{T_N}(t) = (1 - e^{-\\lambda t})^{N-1}\n$$\nThis can be confirmed by showing that the general formula for the hypoexponential CDF, $F_{T_N}(t) = \\sum_{j=1}^{N-1} \\left( \\prod_{i=1, i\\neq j}^{N-1} \\frac{i}{i-j} \\right) (1-e^{-j\\lambda t})$, simplifies to $(1-e^{-\\lambda t})^{N-1}$ through combinatorial identities related to the binomial theorem.\n\nTo find the $\\alpha$-quantile of the distribution, denoted $t_\\alpha$, we must solve the equation $F_{T_N}(t_\\alpha) = \\alpha$ for $t_\\alpha$:\n$$\n(1 - e^{-\\lambda t_\\alpha})^{N-1} = \\alpha\n$$\nSolving for $t_\\alpha$ proceeds as follows:\n$$\n1 - e^{-\\lambda t_\\alpha} = \\alpha^{\\frac{1}{N-1}}\n$$\n$$\ne^{-\\lambda t_\\alpha} = 1 - \\alpha^{\\frac{1}{N-1}}\n$$\n$$\n-\\lambda t_\\alpha = \\ln\\left(1 - \\alpha^{\\frac{1}{N-1}}\\right)\n$$\n$$\nt_\\alpha = -\\frac{1}{\\lambda} \\ln\\left(1 - \\alpha^{\\frac{1}{N-1}}\\right)\n$$\nThis formula provides an exact analytical expression for the quantiles of the first-passage time under the stated approximation.\n\nThe computational procedure is as follows. For each given set of parameters $(V, A_0, k, N)$:\n$1$. Calculate the rate parameter $\\lambda = \\frac{k A_0}{N_\\mathrm{A} V}$.\n$2$. For each required quantile level $\\alpha \\in \\{0.1, 0.5, 0.9\\}$, compute the corresponding time $t_\\alpha$ using the derived quantile function.\n$3$. The results are then rounded to six decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the autocatalysis first-passage time problem based on the\n    derived analytical solution for the quantiles.\n    \"\"\"\n    \n    # Avogadro's number\n    N_A = 6.02214076e23  # mol^-1\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (V in L, A0 count, k in M^-1 s^-1, N target count)\n        (1.0e-15, 100, 1.0e6, 10),  # Case 1\n        (1.0e-15, 100, 5.0e5, 10),  # Case 2\n        (5.0e-16, 100, 1.0e6, 10),  # Case 3\n        (1.0e-15, 100, 1.0e6, 2),   # Case 4\n    ]\n\n    # Quantile levels to calculate\n    alphas = [0.1, 0.5, 0.9]\n\n    # Store all results in a single flat list\n    all_results = []\n\n    for case in test_cases:\n        V, A0, k, N = case\n\n        # Calculate the per-capita rate parameter lambda\n        # lambda = k * [A]_0 = k * (A0 / (N_A * V))\n        lambda_val = (k * A0) / (N_A * V)\n        \n        # The initial number of autocatalyst molecules X is 1.\n        # The target N must be greater than 1 for the time to be non-zero.\n        if N <= 1:\n            # First-passage time is 0 if N is not greater than the start count.\n            # Append three zeros for the three quantiles.\n            all_results.extend([0.0, 0.0, 0.0])\n            continue\n            \n        case_quantiles = []\n        for alpha in alphas:\n            # Derived quantile function: t_alpha = -1/lambda * ln(1 - alpha^(1/(N-1)))\n            exponent = 1.0 / (N - 1)\n            base = alpha\n            \n            # alpha^(1/(N-1))\n            term = base ** exponent\n            \n            # Argument of the natural logarithm\n            log_arg = 1.0 - term\n            \n            # Calculate the quantile t_alpha\n            t_alpha = - (1.0 / lambda_val) * np.log(log_arg)\n            case_quantiles.append(t_alpha)\n            \n        all_results.extend(case_quantiles)\n\n    # Format the results to six decimal places and create the final output string.\n    # The print statement must produce ONLY the single-line formatted output.\n    formatted_results = [f\"{r:.6f}\" for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2624746"}]}