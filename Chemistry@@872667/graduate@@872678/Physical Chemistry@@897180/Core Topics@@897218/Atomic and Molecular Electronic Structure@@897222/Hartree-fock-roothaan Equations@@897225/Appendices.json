{"hands_on_practices": [{"introduction": "To truly understand the self-consistent field (SCF) procedure, there is no substitute for performing an iteration by hand. This exercise demystifies the abstract matrix equations by applying them to a minimal toy system. By manually constructing the Fock matrix, solving the generalized eigenvalue problem, and updating the density matrix, you will gain a concrete understanding of the iterative process at the heart of Hartree-Fock theory [@problem_id:2643602].", "problem": "Consider a minimal toy system intended to illustrate the Hartree–Fock–Roothaan equations for a closed-shell molecule in a non-orthonormal atomic orbital (AO) basis. There are $2$ electrons occupying one spatial molecular orbital doubly (restricted closed shell). The basis has dimension $2$ with AO overlap matrix\n$$\nS \\;=\\; \\begin{pmatrix}\n1.0 & 0.2 \\\\\n0.2 & 1.0\n\\end{pmatrix}.\n$$\nThe one-electron core Hamiltonian matrix (in Hartree atomic units) is\n$$\nH^{\\text{core}} \\;=\\; \\begin{pmatrix}\n-1.0 & -0.2 \\\\\n-0.2 & -0.5\n\\end{pmatrix}.\n$$\nElectron repulsion integrals are given in chemists’ notation $(\\mu\\nu|\\lambda\\sigma)$ and respect the standard permutational symmetries. The only nonzero two-electron integrals (in Hartree) are\n$$\n(11|11)=0.7,\\quad (22|22)=0.6,\\quad (11|22)=(22|11)=0.2,\\quad (12|12)=(21|21)=(12|21)=(21|12)=0.25,\n$$\nand all other $(\\mu\\nu|\\lambda\\sigma)$ are zero. Assume the nuclear repulsion energy is $0$ Hartree.\n\nStarting from an initial zero density, perform one self-consistent-field (SCF) iteration explicitly in the sense of the Hartree–Fock–Roothaan method for a restricted closed-shell system: diagonalize the generalized eigenvalue problem for the initial Fock matrix in the AO basis to obtain the lowest-energy normalized molecular orbital (with $S$-orthonormalization), construct the updated AO density matrix, rebuild the Fock matrix using the updated density, and then evaluate the closed-shell electronic energy. Use the standard closed-shell definitions appropriate to Hartree–Fock theory in a non-orthonormal AO basis.\n\nExpress the final electronic energy (excluding nuclear repulsion) in Hartree and round your answer to four significant figures. Your final answer must be a single real number.", "solution": "The problem requires performing one full iteration of the self-consistent-field (SCF) procedure for a restricted closed-shell system, as described by the Hartree-Fock-Roothaan equations. The system consists of $2$ electrons in a non-orthogonal basis of two atomic orbitals (AOs). The final goal is to compute the electronic energy after this single iteration.\n\nThe Hartree-Fock-Roothaan equation in the AO basis is a generalized eigenvalue problem:\n$$ FC = SCE $$\nwhere $F$ is the Fock matrix, $C$ is the matrix of molecular orbital (MO) coefficients, $S$ is the AO overlap matrix, and $E$ is a diagonal matrix of orbital energies $\\epsilon_i$.\n\nFor a restricted closed-shell system, the elements of the Fock matrix $F_{\\mu\\nu}$ are given by:\n$$ F_{\\mu\\nu} = H_{\\mu\\nu}^{\\text{core}} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right] $$\nHere, $H^{\\text{core}}$ is the core Hamiltonian, $(\\mu\\nu|\\lambda\\sigma)$ are the two-electron repulsion integrals in chemists' notation, and $P$ is the density matrix. The density matrix elements $P_{\\lambda\\sigma}$ for a system with $N$ electrons are defined as:\n$$ P_{\\lambda\\sigma} = 2 \\sum_{i=1}^{N/2} C_{\\lambda i} C_{\\sigma i}^* $$\nwhere the sum is over the occupied MOs. For this problem, $N=2$, so the sum is only over the lowest-energy MO, $i=1$.\n\nThe electronic energy $E_{elec}$ is calculated using the converged density and Fock matrices:\n$$ E_{elec} = \\frac{1}{2} \\sum_{\\mu\\nu} P_{\\nu\\mu} (H_{\\mu\\nu}^{\\text{core}} + F_{\\mu\\nu}) $$\nGiven that the matrices are real and symmetric, this is equivalent to $E_{elec} = \\frac{1}{2} \\text{Tr}[P(H^{\\text{core}} + F)]$.\n\nThe SCF procedure begins with an initial guess for the density matrix $P^{(0)}$.\n**Step 0: Initial Guess**\nThe problem specifies an initial zero density. Thus, the initial density matrix $P^{(0)}$ is the $2 \\times 2$ zero matrix:\n$$ P^{(0)} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix} $$\n\n**Step 1: Initial Fock Matrix**\nUsing $P^{(0)}$, we construct the initial Fock matrix, $F^{(0)}$. Since $P^{(0)}$ is a zero matrix, the two-electron term in the Fock matrix expression vanishes. Therefore, the initial Fock matrix is equal to the core Hamiltonian:\n$$ F^{(0)} = H^{\\text{core}} = \\begin{pmatrix} -1.0 & -0.2 \\\\ -0.2 & -0.5 \\end{pmatrix} $$\n\n**Step 2: Solve the Generalized Eigenvalue Problem**\nWe solve the generalized eigenvalue problem $F^{(0)}C^{(1)} = SC^{(1)}E^{(1)}$ to find the first iteration of MO coefficients $C^{(1)}$ and energies $E^{(1)}$. This requires solving the secular equation $\\det(F^{(0)} - \\epsilon S) = 0$.\n$$ \\det \\left( \\begin{pmatrix} -1.0 & -0.2 \\\\ -0.2 & -0.5 \\end{pmatrix} - \\epsilon \\begin{pmatrix} 1.0 & 0.2 \\\\ 0.2 & 1.0 \\end{pmatrix} \\right) = 0 $$\n$$ \\det \\begin{pmatrix} -1.0 - \\epsilon & -0.2 - 0.2\\epsilon \\\\ -0.2 - 0.2\\epsilon & -0.5 - \\epsilon \\end{pmatrix} = 0 $$\nThe determinant is:\n$$ (-1.0 - \\epsilon)(-0.5 - \\epsilon) - (-0.2 - 0.2\\epsilon)^2 = 0 $$\n$$ (1.0 + \\epsilon)(0.5 + \\epsilon) - (0.2)^2(1.0 + \\epsilon)^2 = 0 $$\n$$ (1.0 + \\epsilon) \\left[ (0.5 + \\epsilon) - 0.04(1.0 + \\epsilon) \\right] = 0 $$\n$$ (1.0 + \\epsilon) (0.5 + \\epsilon - 0.04 - 0.04\\epsilon) = 0 $$\n$$ (1.0 + \\epsilon) (0.96\\epsilon + 0.46) = 0 $$\nThis equation yields two orbital energies: $\\epsilon_1 = -1.0$ and $\\epsilon_2 = -0.46/0.96 \\approx -0.47917$. The lowest energy orbital is $\\epsilon_1 = -1.0$.\n\n**Step 3: Determine and Normalize the Lowest-Energy MO**\nWe find the eigenvector $C_1$ corresponding to $\\epsilon_1 = -1.0$ by solving $(F^{(0)} - \\epsilon_1 S)C_1 = 0$:\n$$ \\left( \\begin{pmatrix} -1.0 & -0.2 \\\\ -0.2 & -0.5 \\end{pmatrix} - (-1.0) \\begin{pmatrix} 1.0 & 0.2 \\\\ 0.2 & 1.0 \\end{pmatrix} \\right) \\begin{pmatrix} c_{11} \\\\ c_{21} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0.5 \\end{pmatrix} \\begin{pmatrix} c_{11} \\\\ c_{21} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\nThe second row gives $0.5 c_{21} = 0$, so $c_{21}=0$. The first row $0=0$ provides no constraint on $c_{11}$. We can set $c_{11}=1$, giving the unnormalized eigenvector $C_1' = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\nThe MO must be normalized according to $C_1^\\dagger S C_1 = 1$.\n$$ \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1.0 & 0.2 \\\\ 0.2 & 1.0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1.0 \\\\ 0.2 \\end{pmatrix} = 1.0 $$\nThe normalization constant is $1$, so the normalized MO coefficient vector is $C_1^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\n\n**Step 4: Construct the Updated Density Matrix**\nWith $2$ electrons in the single occupied MO $\\psi_1$, the new density matrix $P^{(1)}$ is:\n$$ P_{\\mu\\nu}^{(1)} = 2 C_{\\mu 1}^{(1)} C_{\\nu 1}^{(1)} $$\nUsing $C_1^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$, we get:\n$P_{11}^{(1)} = 2(1)(1) = 2$\n$P_{12}^{(1)} = P_{21}^{(1)} = 2(1)(0) = 0$\n$P_{22}^{(1)} = 2(0)(0) = 0$\n$$ P^{(1)} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 0 \\end{pmatrix} $$\n\n**Step 5: Rebuild the Fock Matrix**\nThe updated Fock matrix $F^{(1)}$ is built using $P^{(1)}$. The general expression for an element is:\n$$ F_{\\mu\\nu}^{(1)} = H_{\\mu\\nu}^{\\text{core}} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma}^{(1)} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right] $$\nSince only $P_{11}^{(1)} = 2$ is non-zero, the sum simplifies to the term where $\\lambda=\\sigma=1$:\n$$ F_{\\mu\\nu}^{(1)} = H_{\\mu\\nu}^{\\text{core}} + P_{11}^{(1)} \\left[ (\\mu\\nu|11) - \\frac{1}{2}(\\mu 1|\\nu 1) \\right] = H_{\\mu\\nu}^{\\text{core}} + 2 \\left[ (\\mu\\nu|11) - \\frac{1}{2}(\\mu 1|\\nu 1) \\right] $$\nThe integrals not listed are zero.\nFor $F_{11}^{(1)}$: $(\\mu=1, \\nu=1)$\n$$ F_{11}^{(1)} = H_{11}^{\\text{core}} + 2 \\left[ (11|11) - \\frac{1}{2}(11|11) \\right] = H_{11}^{\\text{core}} + (11|11) = -1.0 + 0.7 = -0.3 $$\nFor $F_{22}^{(1)}$: $(\\mu=2, \\nu=2)$\n$$ F_{22}^{(1)} = H_{22}^{\\text{core}} + 2 \\left[ (22|11) - \\frac{1}{2}(21|21) \\right] = -0.5 + 2 \\left[ 0.2 - \\frac{1}{2}(0.25) \\right] = -0.5 + 2(0.075) = -0.35 $$\nFor $F_{12}^{(1)}$: $(\\mu=1, \\nu=2)$\n$$ F_{12}^{(1)} = H_{12}^{\\text{core}} + 2 \\left[ (12|11) - \\frac{1}{2}(11|21) \\right] $$\nThe integrals $(12|11)$ and $(11|21)$ are not in the list of non-zero integrals, thus they are $0$.\n$$ F_{12}^{(1)} = H_{12}^{\\text{core}} + 0 = -0.2 $$\nBy symmetry, $F_{21}^{(1)} = -0.2$. The new Fock matrix is:\n$$ F^{(1)} = \\begin{pmatrix} -0.3 & -0.2 \\\\ -0.2 & -0.35 \\end{pmatrix} $$\n\n**Step 6: Evaluate the Electronic Energy**\nThe electronic energy after one iteration, $E_{elec}^{(1)}$, is calculated using $P^{(1)}$ and $F^{(1)}$:\n$$ E_{elec}^{(1)} = \\frac{1}{2} \\sum_{\\mu\\nu} P_{\\mu\\nu}^{(1)} (H_{\\mu\\nu}^{\\text{core}} + F_{\\mu\\nu}^{(1)}) $$\nSince $P^{(1)}$ has only one non-zero element, $P_{11}^{(1)}=2$:\n$$ E_{elec}^{(1)} = \\frac{1}{2} P_{11}^{(1)} (H_{11}^{\\text{core}} + F_{11}^{(1)}) = \\frac{1}{2} (2) (-1.0 + (-0.3)) = 1 \\cdot (-1.3) = -1.3 $$\nThe electronic energy, excluding nuclear repulsion, after one SCF iteration is $-1.3$ Hartree.\n\nThe problem asks for the answer to be rounded to four significant figures. This gives $-1.300$.", "answer": "$$\\boxed{-1.300}$$", "id": "2643602"}, {"introduction": "The power of the Hartree-Fock-Roothaan method is realized through the choice of a basis set, but this choice is not arbitrary. This practice explores the profound consequences of selecting a physically inappropriate basis by attempting to describe the ground state of a hydrogen atom using only $p$-type orbitals. This hypothetical scenario serves as a powerful reminder that the variational principle provides a lower bound for the energy within the flexibility allowed by the basis, and a poor basis can lead to physically nonsensical results [@problem_id:2464734].", "problem": "You are asked to implement a complete, runnable program that determines the lowest Hartree-Fock total energy for a one-electron hydrogen atom using the Hartree-Fock-Roothaan (HFR) equations with a basis set composed exclusively of Cartesian $p$-type Gaussian-type orbitals (GTOs). The system is a single nucleus with charge $Z=1$ located at the origin, and a single electron. The one-electron Hamiltonian operator is $h(\\mathbf{r}) = -\\tfrac{1}{2}\\nabla^2 - \\tfrac{Z}{r}$, where $r = \\lVert \\mathbf{r} \\rVert$ and all quantities are in atomic units. The basis consists only of unnormalized Cartesian $p$-type primitives centered on the nucleus, with functions\n$\\phi_{p_x}(\\alpha,\\mathbf{r}) = x \\exp(-\\alpha r^2)$, $\\phi_{p_y}(\\alpha,\\mathbf{r}) = y \\exp(-\\alpha r^2)$, and $\\phi_{p_z}(\\alpha,\\mathbf{r}) = z \\exp(-\\alpha r^2)$,\nfor each exponent $\\alpha$ in a provided set. You must construct the one-electron integral matrices required by the Hartree-Fock-Roothaan framework directly from first principles as integrals over $\\mathbb{R}^3$:\n- the overlap matrix elements $S_{\\mu\\nu} = \\int \\phi_{\\mu}(\\mathbf{r}) \\, \\phi_{\\nu}(\\mathbf{r}) \\, d^3\\mathbf{r}$,\n- the kinetic energy matrix elements $T_{\\mu\\nu} = -\\tfrac{1}{2} \\int \\phi_{\\mu}(\\mathbf{r}) \\, \\nabla^2 \\phi_{\\nu}(\\mathbf{r}) \\, d^3\\mathbf{r}$,\n- the nuclear attraction matrix elements $V_{\\mu\\nu} = \\int \\phi_{\\mu}(\\mathbf{r}) \\, \\left(-\\tfrac{Z}{r}\\right) \\, \\phi_{\\nu}(\\mathbf{r}) \\, d^3\\mathbf{r}$,\nand the core Hamiltonian matrix $H_{\\mu\\nu} = T_{\\mu\\nu} + V_{\\mu\\nu}$. For a one-electron system, there are no two-electron contributions and the Hartree-Fock total energy equals the lowest eigenvalue obtained from the Hartree-Fock-Roothaan condition. Using only the information herein, determine the lowest energy value in Hartree for each of the specified test cases.\n\nImportant requirements:\n- All energies must be expressed in Hartree, rounded to $6$ decimal places.\n- Use unnormalized Cartesian GTOs as defined above, all centered at the nucleus at the origin, and do not introduce any functions other than the $p$-type primitives.\n- Treat each provided set of exponents as defining a basis composed of three Cartesian $p$-type primitives per exponent (one each for $p_x$, $p_y$, and $p_z$), all centered on the nucleus.\n- An energy is physically admissible for a bound electron in this potential if it is strictly less than $0$ Hartree. The program’s output should report only the lowest energy per test case; no additional flags are required in the output.\n\nTest suite:\n- Case $1$: $\\{\\alpha\\} = \\{1.0\\}$.\n- Case $2$: $\\{\\alpha\\} = \\{10.0\\}$.\n- Case $3$: $\\{\\alpha\\} = \\{0.05\\}$.\n- Case $4$: $\\{\\alpha\\} = \\{0.3, 1.5\\}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the cases above. Each entry must be the lowest energy for that case, in Hartree, rounded to $6$ decimal places. For example, a syntactically correct output line has the form $[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4]$, where each $\\varepsilon_k$ is a floating-point number with exactly $6$ digits after the decimal point.", "solution": "The problem requires the calculation of the lowest Hartree-Fock energy for a one-electron hydrogen atom ($Z=1$) using a basis set of unnormalized Cartesian $p$-type Gaussian-type orbitals (GTOs). For a one-electron system, the Hartree-Fock-Roothaan (HFR) equations simplify significantly. The two-electron repulsion integrals vanish, and the Fock matrix $\\mathbf{F}$ becomes identical to the core Hamiltonian matrix $\\mathbf{H}$, which is the sum of the kinetic energy matrix $\\mathbf{T}$ and the nuclear attraction matrix $\\mathbf{V}$. The problem thus reduces to solving the generalized eigenvalue equation:\n$$\n\\mathbf{H} \\mathbf{C} = \\mathbf{S} \\mathbf{C} \\boldsymbol{\\epsilon}\n$$\nwhere $\\mathbf{S}$ is the overlap matrix, $\\mathbf{C}$ is the matrix of molecular orbital coefficients, and $\\boldsymbol{\\epsilon}$ is the diagonal matrix of orbital energies. The total energy of the system is the energy of the single occupied orbital, which, according to the variational principle, is the lowest eigenvalue $\\epsilon_{\\min}$ from the solution of this equation.\n\nThe basis consists of unnormalized Cartesian p-type GTOs centered at the origin:\n$$\n\\phi_{p_x}(\\alpha, \\mathbf{r}) = x \\exp(-\\alpha r^2) \\\\\n\\phi_{p_y}(\\alpha, \\mathbf{r}) = y \\exp(-\\alpha r^2) \\\\\n\\phi_{p_z}(\\alpha, \\mathbf{r}) = z \\exp(-\\alpha r^2)\n$$\nA given set of exponents $\\{\\alpha_1, \\alpha_2, \\dots, \\alpha_N\\}$ defines a basis of size $3N$. However, due to the symmetry of the Hamiltonian and the basis functions, the matrices $\\mathbf{S}$, $\\mathbf{T}$, and $\\mathbf{V}$ are block-diagonal, consisting of three identical blocks corresponding to the $p_x$, $p_y$, and $p_z$ functions. Consequently, the eigenvalues will be triply degenerate, and we only need to construct and solve the $N \\times N$ problem for one block, for instance, the $p_x$ block.\n\nThe matrix elements are derived from first principles by evaluating three-dimensional integrals over all space. Let two basis functions be $\\phi_i(\\mathbf{r}) = x \\exp(-\\alpha_i r^2)$ and $\\phi_j(\\mathbf{r}) = x \\exp(-\\alpha_j r^2)$. Let $p_{ij} = \\alpha_i + \\alpha_j$.\n\n1.  **Overlap Matrix Elements, $S_{ij}$**:\n    The overlap integral is given by $S_{ij} = \\int \\phi_i(\\mathbf{r}) \\phi_j(\\mathbf{r}) d^3\\mathbf{r}$.\n    $$\n    S_{ij} = \\int x^2 \\exp(-p_{ij} r^2) d^3\\mathbf{r}\n    $$\n    This integral is solved by separation of variables:\n    $$\n    S_{ij} = \\left(\\int_{-\\infty}^{\\infty} x^2 e^{-p_{ij}x^2} dx\\right) \\left(\\int_{-\\infty}^{\\infty} e^{-p_{ij}y^2} dy\\right) \\left(\\int_{-\\infty}^{\\infty} e^{-p_{ij}z^2} dz\\right)\n    $$\n    Using the standard Gaussian integral formulas $\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$ and $\\int_{-\\infty}^{\\infty} x^2 e^{-ax^2} dx = \\frac{1}{2a}\\sqrt{\\pi/a}$, we obtain:\n    $$\n    S_{ij} = \\left(\\frac{1}{2p_{ij}}\\sqrt{\\frac{\\pi}{p_{ij}}}\\right) \\left(\\sqrt{\\frac{\\pi}{p_{ij}}}\\right) \\left(\\sqrt{\\frac{\\pi}{p_{ij}}}\\right) = \\frac{1}{2p_{ij}} \\left(\\frac{\\pi}{p_{ij}}\\right)^{3/2} = \\frac{\\pi^{3/2}}{2 p_{ij}^{5/2}}\n    $$\n\n2.  **Kinetic Energy Matrix Elements, $T_{ij}$**:\n    The kinetic energy integral is $T_{ij} = -\\frac{1}{2} \\int \\phi_i(\\mathbf{r}) \\nabla^2 \\phi_j(\\mathbf{r}) d^3\\mathbf{r}$. Using the Hermitian property of the kinetic energy operator, this is equivalent to $T_{ij} = \\frac{1}{2} \\int (\\nabla \\phi_i(\\mathbf{r})) \\cdot (\\nabla \\phi_j(\\mathbf{r})) d^3\\mathbf{r}$. Evaluation of this integral yields:\n    $$\n    T_{ij} = \\frac{5 \\alpha_i \\alpha_j}{p_{ij}} S_{ij} = \\frac{5 \\alpha_i \\alpha_j}{\\alpha_i + \\alpha_j} S_{ij}\n    $$\n\n3.  **Nuclear Attraction Matrix Elements, $V_{ij}$**:\n    The nuclear attraction integral for a nucleus of charge $Z$ at the origin is $V_{ij} = -Z \\int \\phi_i(\\mathbf{r}) \\frac{1}{r} \\phi_j(\\mathbf{r}) d^3\\mathbf{r}$. With $Z=1$:\n    $$\n    V_{ij} = - \\int \\frac{x^2}{r} \\exp(-p_{ij} r^2) d^3\\mathbf{r}\n    $$\n    This integral can be solved in spherical coordinates or by using the Gaussian integral transform for $1/r$. The result is:\n    $$\n    V_{ij} = -\\frac{2\\pi}{3 p_{ij}^2}\n    $$\n\nThe core Hamiltonian matrix elements are $H_{ij} = T_{ij} + V_{ij}$. For each test case defined by a set of exponents $\\{\\alpha_k\\}$, we construct the $N \\times N$ matrices $\\mathbf{S}$ and $\\mathbf{H}$ using the formulas above. The generalized eigenvalue problem is then solved numerically using `scipy.linalg.eigh` to find the orbital energies $\\epsilon$. The lowest of these eigenvalues is the required ground-state energy for the given p-orbital basis.\n\nThe computational procedure is as follows:\n1.  For a given test case with $N$ exponents $\\{\\alpha_1, \\dots, \\alpha_N\\}$, initialize $N \\times N$ matrices $\\mathbf{S}$ and $\\mathbf{H}$.\n2.  Iterate over all pairs $(i, j)$ to compute the matrix elements $S_{ij}$ and $H_{ij} = T_{ij} + V_{ij}$.\n3.  Solve the generalized eigenvalue problem $\\mathbf{H}\\mathbf{C} = \\boldsymbol{\\epsilon}\\mathbf{S}\\mathbf{C}$ for the eigenvalues $\\epsilon_k$.\n4.  The lowest eigenvalue, $\\min_k(\\epsilon_k)$, is the result for the given test case.\n5.  The final result is rounded to $6$ decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Calculates the lowest Hartree-Fock energy for a hydrogen atom using a\n    basis of Cartesian p-type GTOs.\n    \"\"\"\n    # Test cases defined as lists of alpha exponents.\n    test_cases = [\n        [1.0],         # Case 1\n        [10.0],        # Case 2\n        [0.05],        # Case 3\n        [0.3, 1.5],    # Case 4\n    ]\n\n    results = []\n    Z = 1.0  # Nuclear charge for hydrogen atom\n\n    for alphas in test_cases:\n        n_basis = len(alphas)\n        S = np.zeros((n_basis, n_basis))\n        H = np.zeros((n_basis, n_basis))\n\n        # Construct the overlap (S) and core Hamiltonian (H) matrices.\n        # The problem reduces to an N x N system for p_x orbitals due to symmetry,\n        # yielding triply degenerate eigenvalues.\n        for i in range(n_basis):\n            for j in range(i, n_basis):\n                alpha_i = alphas[i]\n                alpha_j = alphas[j]\n                p_ij = alpha_i + alpha_j\n\n                # Overlap matrix element S_ij\n                # S_ij = integral(x*exp(-ai*r^2) * x*exp(-aj*r^2) dV)\n                # Formula: pi^(3/2) / (2 * p_ij^(5/2))\n                s_ij = (np.pi**1.5) / (2 * p_ij**2.5)\n                S[i, j] = S[j, i] = s_ij\n\n                # Kinetic energy matrix element T_ij\n                # T_ij = -1/2 * integral(phi_i * grad^2(phi_j) dV)\n                # Simplified relation: T_ij = (5 * alpha_i * alpha_j / p_ij) * S_ij\n                t_ij = (5.0 * alpha_i * alpha_j / p_ij) * s_ij\n                \n                # Nuclear attraction matrix element V_ij\n                # V_ij = integral(phi_i * (-Z/r) * phi_j dV)\n                # Formula: -2 * pi * Z / (3 * p_ij^2)\n                v_ij = (-2.0 * np.pi * Z) / (3.0 * p_ij**2)\n                \n                # Core Hamiltonian matrix element H_ij\n                H[i, j] = H[j, i] = t_ij + v_ij\n\n        # Solve the generalized eigenvalue problem H*C = S*C*e\n        # where 'e' are the orbital energies.\n        # eigh is used for Hermitian matrices; S and H are real symmetric.\n        try:\n            eigenvalues = eigh(H, S, eigvals_only=True)\n            lowest_energy = np.min(eigenvalues)\n        except np.linalg.LinAlgError:\n            # This might happen if the overlap matrix S is singular,\n            # which indicates a poorly chosen (linearly dependent) basis set.\n            lowest_energy = np.nan\n\n        results.append(lowest_energy)\n\n    # Format the results to 6 decimal places and print in the required format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2464734"}, {"introduction": "In practical quantum chemical calculations, achieving convergence in the SCF procedure can be a significant challenge, often plagued by slow convergence or oscillation. This exercise delves into the mathematical machinery of the Direct Inversion in the Iterative Subspace (DIIS) method, a powerful and widely used convergence acceleration technique. By deriving the core equations of DIIS, you will learn how information from previous iterations is intelligently combined to extrapolate a better guess for the Fock matrix and guide the calculation efficiently towards self-consistency [@problem_id:2643564].", "problem": "In a non-orthogonal atomic orbital basis with overlap matrix $S$, the Hartree–Fock–Roothaan equations for the molecular orbital coefficient matrix $C$ and diagonal orbital energy matrix $\\varepsilon$ read $F C = S C \\varepsilon$ with $C^{\\top} S C = I$. Let $P_i$ be the density matrix corresponding to the occupied orbitals at self-consistent field (SCF) iteration $i$, and $F_i$ the corresponding Fock matrix. Define the commutator residual (error) at iteration $i$ by $e_i = F_i P_i S - S P_i F_i$. At self-consistency, the exact solution satisfies $e = 0$.\n\nThe Direct Inversion in the Iterative Subspace (DIIS) procedure constructs an extrapolated Fock matrix $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$ from a set of $m$ stored pairs $\\{(F_i, e_i)\\}$, with coefficients $\\{c_i\\}$ chosen to minimize the norm of the extrapolated error $E = \\sum_{i=1}^{m} c_i e_i$. Adopt the Frobenius inner product $\\langle A, B \\rangle = \\mathrm{Tr}(A^{\\top} B)$ on the space of real matrices and the corresponding Frobenius norm $\\|A\\|_{\\mathrm{F}}^{2} = \\langle A, A \\rangle$. Impose the affine constraint $\\sum_{i=1}^{m} c_i = 1$.\n\nStarting only from the generalized Roothaan equations, the definition of $e_i$, and the stated inner product, derive the conditions that characterize the minimizer of $\\|E\\|_{\\mathrm{F}}^{2}$ subject to $\\sum_{i=1}^{m} c_i = 1$, and write the resulting linear system for the coefficients $\\{c_i\\}$ and the Lagrange multiplier, as well as the expression for $F^{\\ast}$. Which option below correctly gives this system and the extrapolated Fock matrix in terms of the overlap matrix $B$ with entries $B_{ij} = \\langle e_i, e_j \\rangle$?\n\nA. Use $B_{ij} = \\mathrm{Tr}(e_i^{\\top} e_j)$. Solve\n$$\n\\begin{bmatrix}\nB & \\mathbf{1} \\\\\n\\mathbf{1}^{\\top} & 0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n1\n\\end{bmatrix},\n$$\nwith $\\mathbf{c} = (c_1,\\dots,c_m)^{\\top}$ and $\\mathbf{1}$ the vector of $m$ entries all equal to $1$, and set $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$.\n\nB. Use $B_{ij} = \\mathrm{Tr}(e_i^{\\top} e_j)$. Solve the unconstrained normal equations $B\\,\\mathbf{c} = \\mathbf{0}$ and then normalize $\\mathbf{c}$ by dividing by $\\sum_{i=1}^{m} c_i$ to enforce $\\sum_{i=1}^{m} c_i = 1$, finally setting $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$.\n\nC. Define density residuals $d_i = P_i^2 - P_i$ and $B_{ij} = \\mathrm{Tr}(d_i^{\\top} d_j)$. Solve\n$$\n\\begin{bmatrix}\nB & \\mathbf{1} \\\\\n\\mathbf{1}^{\\top} & 0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n1\n\\end{bmatrix},\n$$\nand take $F^{\\ast} = \\sum_{i=1}^{m} c_i P_i$.\n\nD. Use the $S$-weighted metric $B_{ij} = \\mathrm{Tr}(e_i^{\\top} S\\, e_j\\, S)$ and solve\n$$\n\\begin{bmatrix}\nB & \\mathbf{1} \\\\\n\\mathbf{1}^{\\top} & 0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n1\n\\end{bmatrix},\n$$\nwith $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$.", "solution": "### Derivation\n\nThe objective is to find the coefficients $\\{c_i\\}_{i=1}^m$ that minimize the squared Frobenius norm of the extrapolated error, $\\|E\\|_{\\mathrm{F}}^{2}$, subject to the constraint $\\sum_{i=1}^{m} c_i = 1$.\n\nThe extrapolated error is $E = \\sum_{i=1}^{m} c_i e_i$. Its squared norm is:\n$$\n\\|E\\|_{\\mathrm{F}}^{2} = \\langle E, E \\rangle = \\left\\langle \\sum_{i=1}^{m} c_i e_i, \\sum_{j=1}^{m} c_j e_j \\right\\rangle\n$$\nUsing the linearity of the inner product, we expand this expression:\n$$\n\\|E\\|_{\\mathrm{F}}^{2} = \\sum_{i=1}^{m} \\sum_{j=1}^{m} c_i c_j \\langle e_i, e_j \\rangle\n$$\nThe problem defines the matrix $B$ with entries $B_{ij} = \\langle e_i, e_j \\rangle$. The expression for the squared norm can be written in matrix form as:\n$$\n\\|E\\|_{\\mathrm{F}}^{2} = \\mathbf{c}^{\\top} B \\mathbf{c}\n$$\nwhere $\\mathbf{c} = (c_1, c_2, \\dots, c_m)^{\\top}$ is the column vector of coefficients.\n\nThe minimization is performed under the affine constraint:\n$$\n\\sum_{i=1}^{m} c_i = 1\n$$\nIn vector notation, this is $\\mathbf{1}^{\\top} \\mathbf{c} = 1$, where $\\mathbf{1}$ is a column vector of $m$ entries, all equal to $1$.\n\nThis is a constrained optimization problem. We use the method of Lagrange multipliers. We construct the Lagrangian function $\\mathcal{L}$, for which we seek a stationary point. To match the form in the options, we define the Lagrangian as:\n$$\n\\mathcal{L}(\\mathbf{c}, \\lambda) = \\frac{1}{2} \\mathbf{c}^{\\top} B \\mathbf{c} + \\lambda \\left(\\mathbf{1}^{\\top} \\mathbf{c} - 1\\right)\n$$\nNote that minimizing $\\mathbf{c}^{\\top} B \\mathbf{c}$ is equivalent to minimizing $\\frac{1}{2}\\mathbf{c}^{\\top} B \\mathbf{c}$. The factor of $\\frac{1}{2}$ simplifies the derivative. The variable $\\lambda$ is a Lagrange multiplier.\n\nTo find the minimum, we set the gradient of $\\mathcal{L}$ with respect to $\\mathbf{c}$ and the derivative with respect to $\\lambda$ to zero.\nThe gradient with respect to the vector $\\mathbf{c}$ is:\n$$\n\\nabla_{\\mathbf{c}} \\mathcal{L} = \\frac{\\partial}{\\partial \\mathbf{c}} \\left(\\frac{1}{2} \\mathbf{c}^{\\top} B \\mathbf{c} + \\lambda (\\mathbf{1}^{\\top} \\mathbf{c} - 1)\\right) = B \\mathbf{c} + \\lambda \\mathbf{1}\n$$\n(Here we used the fact that $B$ is symmetric, since $\\langle e_i, e_j \\rangle = \\langle e_j, e_i \\rangle$).\nSetting the gradient to zero gives the first condition:\n$$\nB \\mathbf{c} + \\lambda \\mathbf{1} = \\mathbf{0}\n$$\nThe derivative with respect to $\\lambda$ is:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = \\mathbf{1}^{\\top} \\mathbf{c} - 1\n$$\nSetting this to zero gives the second condition, which is the original constraint:\n$$\n\\mathbf{1}^{\\top} \\mathbf{c} = 1\n$$\nWe now have a system of $m+1$ linear equations for the $m$ coefficients $c_i$ and the Lagrange multiplier $\\lambda$. We can write this system in a single block matrix equation. The unknowns are the vector $\\mathbf{c}$ and the scalar $\\lambda$. Let the unknown vector be $\\begin{bmatrix} \\mathbf{c} \\\\ \\lambda \\end{bmatrix}$.\n\nThe first equation, $B \\mathbf{c} + \\lambda \\mathbf{1} = \\mathbf{0}$, can be written as $[B \\quad \\mathbf{1}] \\begin{bmatrix} \\mathbf{c} \\\\ \\lambda \\end{bmatrix} = \\mathbf{0}$.\nThe second equation, $\\mathbf{1}^{\\top} \\mathbf{c} = 1$, can be written as $[\\mathbf{1}^{\\top} \\quad 0] \\begin{bmatrix} \\mathbf{c} \\\\ \\lambda \\end{bmatrix} = 1$.\n\nCombining these two gives the block matrix system:\n$$\n\\begin{bmatrix}\nB & \\mathbf{1} \\\\\n\\mathbf{1}^{\\top} & 0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n1\n\\end{bmatrix}\n$$\nSolving this system yields the desired coefficients $\\mathbf{c}$. The extrapolated Fock matrix is then constructed as $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$.\n\n### Option-by-Option Analysis\n\n**A. Use $B_{ij} = \\mathrm{Tr}(e_i^{\\top} e_j)$. Solve\n$$\n\\begin{bmatrix}\nB & \\mathbf{1} \\\\\n\\mathbf{1}^{\\top} & 0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n1\n\\end{bmatrix},\n$$\nwith $\\mathbf{c} = (c_1,\\dots,c_m)^{\\top}$ and $\\mathbf{1}$ the vector of $m$ entries all equal to $1$, and set $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$.**\n\nThis option correctly identifies the formation of the matrix $B$ using the specified Frobenius inner product, since $B_{ij} = \\langle e_i, e_j \\rangle = \\mathrm{Tr}(e_i^{\\top} e_j)$. The presented linear system is exactly the one derived above from the constrained minimization principle. The expression for the extrapolated Fock matrix $F^{\\ast}$ is also correct as per the problem definition.\n**Verdict: Correct.**\n\n**B. Use $B_{ij} = \\mathrm{Tr}(e_i^{\\top} e_j)$. Solve the unconstrained normal equations $B\\,\\mathbf{c} = \\mathbf{0}$ and then normalize $\\mathbf{c}$ by dividing by $\\sum_{i=1}^{m} c_i$ to enforce $\\sum_{i=1}^{m} c_i = 1$, finally setting $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$.**\n\nThis procedure is flawed. It attempts to find a solution to the unconstrained minimization problem by setting the gradient of $\\|E\\|_{\\mathrm{F}}^{2}$ to zero, which would be $2B\\mathbf{c}=\\mathbf{0}$. This seeks a linear combination of error vectors that is exactly zero, which is generally not possible. If the matrix $B$ is non-singular, the only solution is the trivial one, $\\mathbf{c} = \\mathbf{0}$, which violates the constraint $\\sum c_i = 1$. If $B$ is singular, non-trivial solutions may exist, but the subsequent normalization is an ad-hoc procedure that does not correspond to the solution of the original constrained minimization problem. The constraint must be included during the optimization via the Lagrange multiplier method, not enforced afterwards.\n**Verdict: Incorrect.**\n\n**C. Define density residuals $d_i = P_i^2 - P_i$ and $B_{ij} = \\mathrm{Tr}(d_i^{\\top} d_j)$. Solve\n$$\n\\begin{bmatrix}\nB & \\mathbf{1} \\\\\n\\mathbf{1}^{\\top} & 0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n1\n\\end{bmatrix},\n$$\nand take $F^{\\ast} = \\sum_{i=1}^{m} c_i P_i$.**\n\nThis option deviates from the problem statement in two fundamental ways. First, it defines the error vector using density matrix idempotency, $d_i = P_i^2 - P_i$, whereas the problem explicitly defines the error as $e_i = F_i P_i S - S P_i F_i$. Second, it attempts to extrapolate the density matrices ($F^{\\ast} = \\sum c_i P_i$), whereas the problem defines the DIIS procedure as an extrapolation of Fock matrices ($F^{\\ast} = \\sum c_i F_i$). Both changes contradict the given premises.\n**Verdict: Incorrect.**\n\n**D. Use the $S$-weighted metric $B_{ij} = \\mathrm{Tr}(e_i^{\\top} S\\, e_j\\, S)$ and solve\n$$\n\\begin{bmatrix}\nB & \\mathbf{1} \\\\\n\\mathbf{1}^{\\top} & 0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n1\n\\end{bmatrix},\n$$\nwith $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$.**\n\nThis option proposes a different inner product, a metric weighted by the overlap matrix $S$. The problem statement, however, is unambiguous: \"Adopt the Frobenius inner product $\\langle A, B \\rangle = \\mathrm{Tr}(A^{\\top} B)$\". This dictates that $B_{ij}$ must be $\\langle e_i, e_j \\rangle = \\mathrm{Tr}(e_i^{\\top} e_j)$. Using an alternative metric, however valid it might be in other contexts, contradicts the explicit instructions of the problem.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2643564"}]}