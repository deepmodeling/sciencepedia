{"hands_on_practices": [{"introduction": "The Sackur-Tetrode equation is a cornerstone of classical statistical mechanics for ideal gases, but it is essential to understand its domain of validity. This exercise challenges you to explore the breakdown of this classical model at low temperatures, a phenomenon related to the Third Law of Thermodynamics [@problem_id:1964187]. By calculating the critical temperature at which the equation predicts an unphysical negative entropy, you will gain a deeper appreciation for the necessity of a quantum mechanical description of matter at low energies.", "problem": "In the study of condensed matter physics, systems are often explored under extreme conditions. Consider a scenario where one mole of hydrogen gas (H₂) is confined within a high-pressure chamber with a fixed internal volume of 1.00 cubic centimeter. The thermodynamic properties of this gas are modeled using the Sackur-Tetrode equation, which describes the entropy of a monatomic ideal gas. This classical model, however, is only an approximation and is known to fail at sufficiently low temperatures, where quantum mechanical effects become dominant. A key signature of this failure is the unphysical prediction of negative entropy.\n\nYour task is to determine the critical temperature below which the Sackur-Tetrode equation predicts a negative entropy for this system.\n\nFor the purpose of this problem, you should treat the hydrogen molecules (H₂) as indistinguishable, non-interacting point-like particles, effectively modeling them as a monatomic ideal gas. Use the following values for the necessary physical constants:\n\n- Molar mass of molecular hydrogen, $M = 2.016 \\times 10^{-3} \\text{ kg/mol}$\n- Avogadro's number, $N_A = 6.022 \\times 10^{23} \\text{ mol}^{-1}$\n- Planck's constant, $h = 6.626 \\times 10^{-34} \\text{ J}\\cdot\\text{s}$\n- Boltzmann constant, $k_B = 1.381 \\times 10^{-23} \\text{ J/K}$\n\nExpress your answer in Kelvin (K). Round your final answer to three significant figures.", "solution": "We model the gas with the Sackur–Tetrode entropy (monatomic ideal gas), written in terms of temperature:\n$$\nS = N k_{B}\\left[\\ln\\!\\left(\\frac{V}{N}\\left(\\frac{2\\pi m k_{B} T}{h^{2}}\\right)^{3/2}\\right)+\\frac{5}{2}\\right]\n$$.\nThe critical temperature for which the Sackur–Tetrode formula predicts zero entropy is obtained by setting $S=0$ and solving for $T$:\n$$\n\\ln\\!\\left(\\frac{V}{N}\\left(\\frac{2\\pi m k_{B} T}{h^{2}}\\right)^{3/2}\\right) = -\\frac{5}{2}\n$$,\n$$\n\\frac{V}{N}\\left(\\frac{2\\pi m k_{B} T}{h^{2}}\\right)^{3/2} = \\exp\\!\\left(-\\frac{5}{2}\\right)\n$$,\n$$\n\\left(\\frac{2\\pi m k_{B} T}{h^{2}}\\right)^{3/2} = \\frac{N}{V}\\exp\\!\\left(-\\frac{5}{2}\\right)\n$$,\n$$\n\\frac{2\\pi m k_{B} T}{h^{2}} = \\left(\\frac{N}{V}\\right)^{2/3}\\exp\\!\\left(-\\frac{5}{3}\\right)\n$$,\n$$\nT_{c} = \\frac{h^{2}}{2\\pi m k_{B}}\\left(\\frac{N}{V}\\right)^{2/3}\\exp\\!\\left(-\\frac{5}{3}\\right)\n$$.\nFor one mole, $N=N_{A}$, and for hydrogen molecules treated as point particles, $m = M/N_{A}$. With $V=1.00\\times 10^{-6}\\ \\text{m}^{3}$, the numerical inputs are:\n$$\nm = \\frac{M}{N_{A}} = \\frac{2.016\\times 10^{-3}\\ \\text{kg/mol}}{6.022\\times 10^{23}\\ \\text{mol}^{-1}} \\approx 3.3477\\times 10^{-27}\\ \\text{kg}\n$$,\n$$\n\\frac{N}{V} = \\frac{N_{A}}{1.00\\times 10^{-6}\\ \\text{m}^{3}} = 6.022\\times 10^{29}\\ \\text{m}^{-3}\n$$.\nTherefore,\n$$\nT_{c} = \\frac{h^{2}}{2\\pi m k_{B}}\\left(\\frac{N}{V}\\right)^{2/3}\\exp\\!\\left(-\\frac{5}{3}\\right)\n$$.\nSubstituting $h=6.626\\times 10^{-34}\\ \\text{J}\\cdot\\text{s}$, $k_{B}=1.381\\times 10^{-23}\\ \\text{J/K}$, $m\\approx 3.3477\\times 10^{-27}\\ \\text{kg}$, and $(N/V)^{2/3}\\approx 7.1309\\times 10^{19}\\ \\text{m}^{-2}$, we obtain\n$$\nT_{c} \\approx \\left(\\frac{(6.626\\times 10^{-34})^{2}}{2\\pi\\,(3.3477\\times 10^{-27})(1.381\\times 10^{-23})}\\right)\\left(7.1309\\times 10^{19}\\right)\\exp\\!\\left(-\\frac{5}{3}\\right) \\approx 20.356\\ \\text{K}\n$$.\nRounding to three significant figures gives $T_{c} = 20.4\\ \\text{K}$.", "answer": "$$\\boxed{20.4}$$", "id": "1964187"}, {"introduction": "Real gases deviate from ideal behavior due to intermolecular forces, a reality not captured by the basic Sackur-Tetrode equation. This practice guides you to extend the ideal gas framework by incorporating weak, attractive interactions using a mean-field approximation [@problem_id:513516]. Deriving the first-order correction to the entropy provides a valuable exercise in perturbation methods and deepens your understanding of how statistical mechanics models can be refined to describe more realistic, non-ideal systems.", "problem": "Consider a monoatomic gas of $N$ identical, indistinguishable particles of mass $m$ confined to a three-dimensional volume $V$. In the absence of interactions, the entropy of this ideal gas is described by the Sackur-Tetrode equation:\n$$S(T, V, N) = N k_B \\left[ \\ln\\left(\\frac{V}{N\\Lambda^3}\\right) + \\frac{5}{2} \\right]$$\nwhere $k_B$ is the Boltzmann constant, $T$ is the temperature, and $\\Lambda = \\frac{h}{\\sqrt{2\\pi m k_B T}}$ is the thermal de Broglie wavelength ($h$ is Planck's constant).\n\nNow, introduce a weak, long-range attractive interaction between the particles. This interaction can be modeled as a uniform, mean-field potential energy, $U_{int}$, which is added to the total kinetic energy of the system. This potential energy is proportional to the square of the particle number density and is given by:\n$$U_{int} = -\\alpha \\frac{N^2}{V}$$\nwhere $\\alpha$ is a positive constant representing the strength of the interaction. The total internal energy of the gas is $U = E_{kin} + U_{int}$, where $E_{kin}$ is the total kinetic energy.\n\nWorking within the microcanonical ensemble (where the total energy $U$ is constant), derive the first-order correction to the entropy, $\\Delta S$, caused by this interaction. Assume the interaction is weak, such that $|U_{int}| \\ll U$. Express your final answer in terms of $N, V, T, \\alpha$, and $k_B$. For the final step, you may relate the internal energy $U$ to the temperature $T$ using the unperturbed ideal gas relation, $U \\approx \\frac{3}{2} N k_B T$.", "solution": "1. For an ideal monoatomic gas in the microcanonical ensemble the entropy as a function of kinetic energy $E_{\\rm kin}$ is\n$$S(E_{\\rm kin},V,N)=k_B\\ln\\Omega(E_{\\rm kin})\\,,\\qquad \n\\frac{\\partial S}{\\partial E_{\\rm kin}}=\\frac1T\\,. $$\n2. When a weak mean‐field interaction is added, the total internal energy $U$ is fixed but the kinetic energy becomes\n$$E_{\\rm kin}=U-U_{int}=U+\\alpha\\,\\frac{N^2}{V}\\,,\\quad |U_{int}|\\ll U\\,. $$\n3. Expanding the entropy to first order in $U_{int}$ gives\n$$S(U-U_{int})\\approx S(U)-\\frac{U_{int}}{T}\\quad\\Longrightarrow\\quad\n\\Delta S=S-S(U)=-\\frac{U_{int}}{T}\\,. $$\n4. Substitute $U_{int}=-\\alpha\\,\\frac{N^2}{V}$:\n$$\\Delta S=\\frac{\\alpha\\,N^2}{V\\,T}$$.\n5. (Optionally one may use $U \\approx \\frac{3}{2} N k_B T$ to check consistency, but no further substitution is needed.)", "answer": "$$\\boxed{\\frac{\\alpha N^2}{V T}}$$", "id": "513516"}, {"introduction": "A profound concept in statistical mechanics is the equivalence of ensembles, which asserts that macroscopic thermodynamic properties are independent of the specific statistical ensemble chosen in the thermodynamic limit. This advanced computational practice tasks you with a rigorous verification of this principle by deriving and calculating the entropy of an ideal gas from the ground up using both the canonical and microcanonical ensembles [@problem_id:2679956]. By comparing the numerical results, you will bridge the gap between abstract theory and concrete computation, gaining a tangible appreciation for the consistency of the foundations of statistical thermodynamics.", "problem": "You are to write a program that, for a monatomic ideal gas of $N$ identical particles of mass $m$ confined to volume $V$ at absolute temperature $T$, computes the entropy $S$ numerically in two independent ways based on first-principles statistical mechanics, and then compares the results.\n\nFundamental base to be used:\n- Canonical ensemble: The canonical partition function $Q_N(V,T)$ is defined by\n$$\nQ_N(V,T) \\equiv \\frac{1}{N!\\,h^{3N}} \\int_{\\mathbb{R}^{3N}} \\int_{V^N} \\exp\\!\\big(-\\beta\\,H(\\mathbf{p},\\mathbf{q})\\big)\\,d^{3N}\\mathbf{p}\\,d^{3N}\\mathbf{q},\n$$\nwhere $H(\\mathbf{p},\\mathbf{q}) = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i^2}{2m}$ is the classical Hamiltonian for a monatomic ideal gas, $\\beta \\equiv 1/(k_{\\mathrm{B}}T)$, $h$ is Planck’s constant, and $k_{\\mathrm{B}}$ is Boltzmann’s constant. The Helmholtz free energy is $F = -k_{\\mathrm{B}}T \\ln Q_N$, the internal energy is $U = -\\partial \\ln Q_N/\\partial \\beta$, and the entropy is $S_{\\mathrm{can}} = (U - F)/T = k_{\\mathrm{B}}\\big(\\ln Q_N + \\beta U\\big)$.\n- Microcanonical ensemble: The integrated phase volume (the cumulative number of states) is\n$$\n\\Gamma(E,V,N) \\equiv \\frac{1}{N!\\,h^{3N}} \\int_{\\mathbb{R}^{3N}} \\int_{V^N} \\Theta\\!\\big(E - H(\\mathbf{p},\\mathbf{q})\\big)\\,d^{3N}\\mathbf{p}\\,d^{3N}\\mathbf{q},\n$$\nwhere $\\Theta(\\cdot)$ is the Heaviside step function. The microcanonical entropy is defined as $S_{\\mu}(E,V,N) \\equiv k_{\\mathrm{B}}\\ln \\Gamma(E,V,N)$.\n\nConstraints for numerical implementation:\n- You must not perform any high-dimensional numerical integration. Instead, reduce the definitions above analytically to low-dimensional expressions involving well-known special functions that can be evaluated numerically with high accuracy. Your derivation must start only from the stated definitions and universal facts such as Gaussian integrals, properties of the Gamma function, and equipartition for quadratic degrees of freedom. Do not assume or quote any final closed-form entropy formula in the problem statement.\n- To compare the two entropies at the same intensive conditions, set the energy for the microcanonical calculation to the canonical mean energy for a monatomic ideal gas, namely $E \\equiv \\frac{3}{2}N k_{\\mathrm{B}} T$. This ensures both calculations refer to the same temperature $T$.\n- All entropies must be reported in $\\mathrm{J\\,K^{-1}}$. The final comparison metric to output is the absolute difference per particle in units of $k_{\\mathrm{B}}$, namely $\\Delta \\equiv \\frac{\\lvert S_{\\mathrm{can}} - S_{\\mu}\\rvert}{N\\,k_{\\mathrm{B}}}$, which is dimensionless.\n\nNumerical stability requirements:\n- Evaluate logarithms of factorials and Gamma functions using numerically stable special functions (for example, the logarithm of the Gamma function) to avoid overflow or underflow.\n- Treat $N$ as an integer, $m$ in $\\mathrm{kg}$, $T$ in $\\mathrm{K}$, and $V$ in $\\mathrm{m^3}$.\n\nTest suite:\nCompute $\\Delta$ for each of the following parameter sets $(m, T, V, N)$:\n- Case $1$ (edge case, single particle): $m = 6.646\\,476\\times 10^{-27}\\,\\mathrm{kg}$, $T = 300\\,\\mathrm{K}$, $N = 1$, $V = 4.0\\times 10^{-26}\\,\\mathrm{m^3}$.\n- Case $2$ (few particles, cryogenic temperature): $m = 6.633\\,520\\,9\\times 10^{-26}\\,\\mathrm{kg}$, $T = 2.7\\,\\mathrm{K}$, $N = 3$, $V = 1.2\\times 10^{-25}\\,\\mathrm{m^3}$.\n- Case $3$ (mesoscopic, high temperature): $m = 6.633\\,520\\,9\\times 10^{-26}\\,\\mathrm{kg}$, $T = 1500\\,\\mathrm{K}$, $N = 100$, $V = 4.0\\times 10^{-24}\\,\\mathrm{m^3}$.\n- Case $4$ (thermodynamic trend): $m = 6.646\\,476\\times 10^{-27}\\,\\mathrm{kg}$, $T = 300\\,\\mathrm{K}$, $N = 1000$, $V = 4.0\\times 10^{-23}\\,\\mathrm{m^3}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the four computed values of $\\Delta$ for the cases above, as a comma-separated list enclosed in square brackets (for example, $\"[x_1,x_2,x_3,x_4]\"$), where each $x_i$ is a floating-point number.", "solution": "The problem statement has been examined and found to be valid. It is a well-posed exercise in fundamental statistical mechanics, requiring the derivation and numerical comparison of entropy for a monatomic ideal gas in the canonical and microcanonical ensembles. The problem is scientifically sound, self-contained, and objective. We shall proceed with a rigorous, first-principles derivation as mandated.\n\nThe objective is to compute the entropy of a monatomic ideal gas of $N$ particles of mass $m$ in a volume $V$ at temperature $T$ using two statistical ensembles and to compare the results.\n\nFirst, we derive the expression for entropy in the canonical ensemble, denoted $S_{\\mathrm{can}}$.\nThe canonical partition function $Q_N(V,T)$ is given by:\n$$\nQ_N(V,T) = \\frac{1}{N!\\,h^{3N}} \\int_{\\mathbb{R}^{3N}} \\int_{V^N} \\exp\\!\\big(-\\beta\\,H(\\mathbf{p},\\mathbf{q})\\big)\\,d^{3N}\\mathbf{p}\\,d^{3N}\\mathbf{q}\n$$\nThe Hamiltonian for an ideal gas, $H(\\mathbf{p},\\mathbf{q}) = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i^2}{2m}$, depends only on the momenta $\\mathbf{p}_i$, not the positions $\\mathbf{q}_i$. The integral over the spatial coordinates can be performed immediately:\n$$\n\\int_{V^N} d^{3N}\\mathbf{q} = \\left(\\int_V d^3\\mathbf{q}\\right)^N = V^N\n$$\nThe momentum integral is over $3N$ dimensions. Since the exponential of a sum is the product of exponentials, the integral separates into a product of $N$ identical integrals for each particle:\n$$\n\\int_{\\mathbb{R}^{3N}} \\exp\\left(-\\beta \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i^2}{2m}\\right) d^{3N}\\mathbf{p} = \\left[ \\int_{\\mathbb{R}^3} \\exp\\left(-\\frac{\\beta}{2m} \\mathbf{p}^2\\right) d^3\\mathbf{p} \\right]^N\n$$\nThe three-dimensional integral over a single particle's momentum $\\mathbf{p} = (p_x, p_y, p_z)$ can be separated into a product of three one-dimensional Gaussian integrals:\n$$\n\\int_{\\mathbb{R}^3} e^{-\\frac{\\beta}{2m}(p_x^2+p_y^2+p_z^2)} dp_x dp_y dp_z = \\left( \\int_{-\\infty}^{\\infty} e^{-\\frac{\\beta}{2m}p^2} dp \\right)^3\n$$\nUsing the standard result for a Gaussian integral, $\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$, with $a = \\beta/(2m)$, we find:\n$$\n\\int_{-\\infty}^{\\infty} e^{-\\frac{\\beta}{2m}p^2} dp = \\sqrt{\\frac{2m\\pi}{\\beta}}\n$$\nThus, the three-dimensional momentum integral for one particle is $(2m\\pi/\\beta)^{3/2}$.\nSubstituting these results back into the expression for $Q_N(V,T)$:\n$$\nQ_N(V,T) = \\frac{V^N}{N!h^{3N}} \\left( \\left(\\frac{2m\\pi}{\\beta}\\right)^{3/2} \\right)^N = \\frac{1}{N!} \\left[ \\frac{V}{h^3} (2\\pi m k_{\\mathrm{B}}T)^{3/2} \\right]^N\n$$\nwhere we used $\\beta = 1/(k_{\\mathrm{B}}T)$.\nTo find the entropy, we first compute the logarithm of the partition function. For numerical stability with large $N$, we use the log-gamma function, as $\\ln(N!) = \\ln(\\Gamma(N+1))$:\n$$\n\\ln Q_N = N \\ln V + \\frac{3N}{2} \\ln(2\\pi m k_{\\mathrm{B}}T) - 3N \\ln h - \\ln(\\Gamma(N+1))\n$$\nThe internal energy $U$ is given by $U = -\\partial (\\ln Q_N)/\\partial \\beta$. The only term in $\\ln Q_N$ dependent on $\\beta$ is $\\frac{3N}{2} \\ln(1/\\beta) = -\\frac{3N}{2} \\ln \\beta$.\n$$\nU = -\\frac{\\partial}{\\partial\\beta} \\left( -\\frac{3N}{2} \\ln\\beta \\right) = \\frac{3N}{2\\beta} = \\frac{3}{2}N k_{\\mathrm{B}}T\n$$\nThis is the expected result from the equipartition theorem for a monatomic gas.\nThe canonical entropy $S_{\\mathrm{can}}$ is then $S_{\\mathrm{can}} = (U - F)/T = (U + k_{\\mathrm{B}}T\\ln Q_N)/T = k_{\\mathrm{B}}(\\beta U + \\ln Q_N)$.\n$$\nS_{\\mathrm{can}} = k_{\\mathrm{B}} \\left( \\ln Q_N + \\frac{3N}{2} \\right) = k_{\\mathrm{B}} \\left[ N \\ln V + \\frac{3N}{2} \\ln(2\\pi m k_{\\mathrm{B}}T) - 3N \\ln h - \\ln(\\Gamma(N+1)) + \\frac{3N}{2} \\right]\n$$\nThis is the final expression for the canonical entropy that will be implemented numerically.\n\nNext, we derive the expression for the microcanonical entropy, $S_{\\mu}$.\nThe microcanonical entropy is defined as $S_{\\mu}(E,V,N) = k_{\\mathrm{B}}\\ln \\Gamma(E,V,N)$, where $\\Gamma(E,V,N)$ is the integrated phase volume:\n$$\n\\Gamma(E,V,N) = \\frac{1}{N!\\,h^{3N}} \\int_{\\mathbb{R}^{3N}} \\int_{V^N} \\Theta\\left(E - \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i^2}{2m}\\right)\\,d^{3N}\\mathbf{p}\\,d^{3N}\\mathbf{q}\n$$\nThe Heaviside step function $\\Theta(\\cdot)$ restricts the integration to the region of phase space where the total energy is less than or equal to $E$. As before, the spatial integral yields $V^N$. The momentum integral is the volume of the region defined by $\\sum_{i=1}^{N} \\mathbf{p}_i^2 \\le 2mE$. This inequality describes a $3N$-dimensional ball in momentum space with radius $R = \\sqrt{2mE}$.\nThe volume of a $d$-dimensional ball of radius $R$ is given by the formula $V_d(R) = \\frac{\\pi^{d/2}}{\\Gamma(d/2 + 1)} R^d$.\nIn our case, the dimension is $d = 3N$. The volume of the accessible momentum space is:\n$$\n\\text{Vol}(\\mathbf{p}) = \\frac{\\pi^{3N/2}}{\\Gamma(3N/2 + 1)} (2mE)^{3N/2}\n$$\nSubstituting this into the expression for $\\Gamma(E,V,N)$:\n$$\n\\Gamma(E,V,N) = \\frac{V^N}{N!h^{3N}} \\frac{\\pi^{3N/2}}{\\Gamma(3N/2 + 1)} (2mE)^{3N/2}\n$$\nThe microcanonical entropy is $S_{\\mu} = k_{\\mathrm{B}}\\ln\\Gamma$. Again, using $\\ln(N!) = \\ln(\\Gamma(N+1))$:\n$$\n\\ln \\Gamma = N\\ln V - \\ln(\\Gamma(N+1)) - 3N\\ln h + \\frac{3N}{2}\\ln(\\pi) + \\frac{3N}{2}\\ln(2mE) - \\ln\\left(\\Gamma\\left(\\frac{3N}{2}+1\\right)\\right)\n$$\nCombining the $\\pi$ term with the $2mE$ term:\n$$\nS_{\\mu} = k_{\\mathrm{B}} \\left[ N\\ln V - \\ln(\\Gamma(N+1)) - 3N\\ln h + \\frac{3N}{2}\\ln(2\\pi mE) - \\ln\\left(\\Gamma\\left(\\frac{3N}{2}+1\\right)\\right) \\right]\n$$\nTo compare this with the canonical entropy at temperature $T$, we must evaluate it at an equivalent energy. The correct choice is the average energy of the canonical ensemble at that temperature, which we found to be $E = \\frac{3}{2}N k_{\\mathrm{B}} T$. This ensures both calculations describe the same thermodynamic state. Substituting for $E$:\n$$\nS_{\\mu} = k_{\\mathrm{B}} \\left[ N\\ln V + \\frac{3N}{2}\\ln\\left(2\\pi m \\left(\\frac{3}{2}N k_{\\mathrm{B}}T\\right)\\right) - 3N\\ln h - \\ln(\\Gamma(N+1)) - \\ln\\left(\\Gamma\\left(\\frac{3N}{2}+1\\right)\\right) \\right]\n$$\nThis is the final expression for the microcanonical entropy.\n\nFinally, we compute the required comparison metric, $\\Delta$, defined as the absolute difference in entropy per particle, in units of $k_{\\mathrm{B}}$:\n$$\n\\Delta = \\frac{\\lvert S_{\\mathrm{can}} - S_{\\mu}\\rvert}{N\\,k_{\\mathrm{B}}}\n$$\nThe discrepancy between $S_{\\mathrm{can}}$ and $S_{\\mu}$ is a known feature of statistical mechanics, originating from the different constraints of the ensembles (fixed $T$ vs. fixed $E$). This difference becomes negligible in the thermodynamic limit ($N \\to \\infty$), which is a manifestation of the equivalence of ensembles. For finite $N$, a small difference is expected.\n\nThe numerical implementation will compute $S_{\\mathrm{can}}$ and $S_{\\mu}$ using the derived formulae for each test case. The use of log-gamma functions (`scipy.special.gammaln`) is critical for avoiding numerical overflow with factorial and gamma function terms involving large $N$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import constants\nfrom scipy.special import gammaln\n\ndef solve():\n    \"\"\"\n    Computes entropy in canonical and microcanonical ensembles for a monatomic ideal gas,\n    and calculates the difference per particle.\n    \"\"\"\n    # Define physical constants from scipy.constants\n    k_B = constants.k  # Boltzmann constant in J/K\n    h = constants.h    # Planck constant in J*s\n\n    # Define the test cases from the problem statement.\n    # Format: (mass in kg, temperature in K, volume in m^3, number of particles)\n    test_cases = [\n        (6.646476e-27, 300.0, 4.0e-26, 1),\n        (6.6335209e-26, 2.7, 1.2e-25, 3),\n        (6.6335209e-26, 1500.0, 4.0e-24, 100),\n        (6.646476e-27, 300.0, 4.0e-23, 1000),\n    ]\n\n    results = []\n    for m, T, V, N_float in test_cases:\n        # Per problem, N is an integer.\n        N = int(N_float)\n\n        # --- Canonical Ensemble Entropy (S_can) ---\n        # S_can = k_B * [ N*ln(V) + (3N/2)*ln(2*pi*m*k_B*T) - 3N*ln(h) - ln(N!) + 3N/2 ]\n        \n        # We calculate the term inside the brackets to maintain precision.\n        # ln(N!) is computed using the log-gamma function: gammaln(N + 1)\n        log_term_can = (\n            N * np.log(V)\n            + (3.0 * N / 2.0) * np.log(2.0 * np.pi * m * k_B * T)\n            - 3.0 * N * np.log(h)\n            - gammaln(N + 1.0)\n            + (3.0 * N / 2.0)\n        )\n        S_can = k_B * log_term_can\n\n        # --- Microcanonical Ensemble Entropy (S_mu) ---\n        # The energy E is set to the canonical mean energy.\n        E = (3.0 / 2.0) * N * k_B * T\n        \n        # S_mu = k_B * [ N*ln(V) - ln(N!) - 3N*ln(h) + (3N/2)*ln(2*pi*m*E) - ln(Γ(3N/2 + 1)) ]\n        \n        if N == 0:\n            # Although not in test cases, for completeness S=0 for N=0.\n            # Delta would be undefined. We assume N >= 1 as per tests.\n            continue\n            \n        log_term_mu = (\n            N * np.log(V)\n            - gammaln(N + 1.0)\n            - 3.0 * N * np.log(h)\n            + (3.0 * N / 2.0) * np.log(2.0 * np.pi * m * E)\n            - gammaln(3.0 * N / 2.0 + 1.0)\n        )\n        S_mu = k_B * log_term_mu\n\n        # --- Comparison Metric (Delta) ---\n        # Delta = |S_can - S_mu| / (N * k_B)\n        delta = np.abs(S_can - S_mu) / (N * k_B)\n        \n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "2679956"}]}