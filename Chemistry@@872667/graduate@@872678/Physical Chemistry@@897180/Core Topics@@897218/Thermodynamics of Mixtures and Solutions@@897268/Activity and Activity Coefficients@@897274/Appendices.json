{"hands_on_practices": [{"introduction": "To describe the behavior of real solutions, we use models for the excess Gibbs free energy ($g^E$), such as the Margules equation. A crucial skill is connecting this macroscopic property to the activity coefficients ($\\gamma_i$) of individual components. This practice guides you through the fundamental thermodynamic derivation of $\\ln \\gamma_i$ from a given $g^E$ model, a cornerstone of solution thermodynamics [@problem_id:2622604].", "problem": "A binary liquid mixture at temperature $T$ and pressure $P$ is described by a three-suffix Margules excess Gibbs free energy model at constant $T$ and $P$. The molar excess Gibbs free energy $g^{E}$ satisfies\n$$\n\\frac{g^{E}}{R T} \\;=\\; x_{1} x_{2} \\left( A_{12} x_{2} \\;+\\; A_{21} x_{1} \\right),\n$$\nwhere $x_{1}$ and $x_{2}$ are mole fractions with $x_{1} + x_{2} = 1$, $R$ is the universal gas constant, $A_{12}$ and $A_{21}$ are composition-independent parameters, and $g^{E}$ is the mixture molar excess Gibbs free energy. Using only fundamental thermodynamic definitions and relations, derive explicit closed-form expressions for $\\ln \\gamma_{1}$ and $\\ln \\gamma_{2}$ as functions of $x_{1}$, $x_{2}$, $A_{12}$, and $A_{21}$, where $\\gamma_{i}$ is the activity coefficient of component $i$ on the mole-fraction scale.\n\nYour derivation must begin from the definitions of excess chemical potential and activity coefficient and from the definition of partial molar properties, including\n- the relation between excess chemical potential and activity coefficient, and\n- the definition of a partial molar quantity as the partial derivative of the corresponding extensive excess property with respect to mole number at fixed $T$, $P$, and the other mole numbers.\n\nExpress your final result as a single row vector $\\big[\\ln \\gamma_{1},\\;\\ln \\gamma_{2}\\big]$ in a single closed-form analytic expression. No numerical evaluation is required, and no rounding is needed. Do not include units in your final expression.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a standard derivation in chemical thermodynamics based on established principles and a widely used model for excess Gibbs free energy. All necessary information is provided, and the problem is free of contradictions or ambiguities. The problem is therefore valid, and a solution will be provided.\n\nThe objective is to derive expressions for the natural logarithm of the activity coefficients, $\\ln \\gamma_{1}$ and $\\ln \\gamma_{2}$, for a binary mixture described by the three-suffix Margules model for the molar excess Gibbs free energy, $g^{E}$. The derivation will proceed from first principles as required.\n\nThe fundamental relationship between the excess chemical potential of component $i$, $\\mu_{i}^{E}$, and its activity coefficient, $\\gamma_{i}$, is given by:\n$$\n\\mu_{i}^{E} = R T \\ln \\gamma_{i}\n$$\nwhere $R$ is the universal gas constant and $T$ is the absolute temperature. This can be rearranged to express $\\ln \\gamma_{i}$:\n$$\n\\ln \\gamma_{i} = \\frac{\\mu_{i}^{E}}{R T}\n$$\nThe excess chemical potential, $\\mu_{i}^{E}$, is defined as the partial molar excess Gibbs free energy. For a system with a total of $n$ moles, the extensive total excess Gibbs free energy is $G^{E} = n g^{E}$. The partial molar excess Gibbs free energy for component $i$ is defined as the partial derivative of the total excess Gibbs free energy with respect to the number of moles of component $i$, $n_{i}$, holding temperature $T$, pressure $P$, and the moles of all other components $n_{j \\neq i}$ constant:\n$$\n\\mu_{i}^{E} = \\left( \\frac{\\partial (n g^{E})}{\\partial n_{i}} \\right)_{T, P, n_{j \\neq i}} = \\left( \\frac{\\partial G^{E}}{\\partial n_{i}} \\right)_{T, P, n_{j \\neq i}}\n$$\nCombining these definitions, we have:\n$$\n\\ln \\gamma_{i} = \\frac{1}{R T} \\left( \\frac{\\partial G^{E}}{\\partial n_{i}} \\right)_{T, P, n_{j \\neq i}} = \\left( \\frac{\\partial (G^{E} / R T)}{\\partial n_{i}} \\right)_{T, P, n_{j \\neq i}}\n$$\nThe problem provides the molar excess Gibbs free energy as:\n$$\n\\frac{g^{E}}{R T} = x_{1} x_{2} \\left( A_{12} x_{2} + A_{21} x_{1} \\right)\n$$\nwhere $x_{1}$ and $x_{2}$ are the mole fractions of components $1$ and $2$, respectively. To perform the partial differentiation with respect to mole numbers $n_{1}$ and $n_{2}$, we must first express the total excess Gibbs free energy, $G^{E} = n g^{E}$, in terms of $n_{1}$ and $n_{2}$. We use the definitions $x_{1} = \\frac{n_{1}}{n_{1} + n_{2}}$ and $x_{2} = \\frac{n_{2}}{n_{1} + n_{2}}$, where $n = n_{1} + n_{2}$ is the total number of moles.\n$$\n\\frac{G^{E}}{R T} = n \\frac{g^{E}}{R T} = (n_{1} + n_{2}) \\left( \\frac{n_{1}}{n_{1} + n_{2}} \\right) \\left( \\frac{n_{2}}{n_{1} + n_{2}} \\right) \\left[ A_{12} \\left( \\frac{n_{2}}{n_{1} + n_{2}} \\right) + A_{21} \\left( \\frac{n_{1}}{n_{1} + n_{2}} \\right) \\right]\n$$\nSimplifying this expression yields:\n$$\n\\frac{G^{E}}{R T} = \\frac{n_{1} n_{2}}{(n_{1} + n_{2})^{2}} \\left( A_{12} n_{2} + A_{21} n_{1} \\right) = \\frac{A_{12} n_{1} n_{2}^{2} + A_{21} n_{1}^{2} n_{2}}{(n_{1} + n_{2})^{2}}\n$$\nNow, we can find $\\ln \\gamma_{1}$ by differentiating this expression with respect to $n_{1}$ while holding $n_{2}$ constant. We apply the quotient rule for differentiation, $\\left(\\frac{u}{v}\\right)' = \\frac{u'v - uv'}{v^{2}}$, where $u = A_{12} n_{1} n_{2}^{2} + A_{21} n_{1}^{2} n_{2}$ and $v = (n_{1} + n_{2})^{2}$.\nThe partial derivatives with respect to $n_{1}$ are:\n$$\n\\frac{\\partial u}{\\partial n_{1}} = A_{12} n_{2}^{2} + 2 A_{21} n_{1} n_{2}\n$$\n$$\n\\frac{\\partial v}{\\partial n_{1}} = 2 (n_{1} + n_{2})\n$$\nApplying the quotient rule:\n$$\n\\ln \\gamma_{1} = \\frac{\\left( A_{12} n_{2}^{2} + 2 A_{21} n_{1} n_{2} \\right) (n_{1} + n_{2})^{2} - \\left( A_{12} n_{1} n_{2}^{2} + A_{21} n_{1}^{2} n_{2} \\right) 2 (n_{1} + n_{2})}{(n_{1} + n_{2})^{4}}\n$$\nWe can cancel a factor of $(n_{1} + n_{2})$ from the numerator and denominator:\n$$\n\\ln \\gamma_{1} = \\frac{\\left( A_{12} n_{2}^{2} + 2 A_{21} n_{1} n_{2} \\right) (n_{1} + n_{2}) - 2 \\left( A_{12} n_{1} n_{2}^{2} + A_{21} n_{1}^{2} n_{2} \\right)}{(n_{1} + n_{2})^{3}}\n$$\nExpanding the numerator:\n$$\n\\text{Numerator} = (A_{12} n_{1} n_{2}^{2} + A_{12} n_{2}^{3} + 2 A_{21} n_{1}^{2} n_{2} + 2 A_{21} n_{1} n_{2}^{2}) - (2 A_{12} n_{1} n_{2}^{2} + 2 A_{21} n_{1}^{2} n_{2})\n$$\n$$\n\\text{Numerator} = -A_{12} n_{1} n_{2}^{2} + A_{12} n_{2}^{3} + 2 A_{21} n_{1} n_{2}^{2} = n_{2}^{2}(-A_{12} n_{1} + A_{12} n_{2} + 2 A_{21} n_{1})\n$$\nSubstituting this back gives:\n$$\n\\ln \\gamma_{1} = \\frac{n_{2}^{2}(-A_{12} n_{1} + A_{12} n_{2} + 2 A_{21} n_{1})}{(n_{1} + n_{2})^{3}}\n$$\nTo express this in terms of mole fractions, we divide the numerator and denominator by $(n_{1} + n_{2})^{3}$:\n$$\n\\ln \\gamma_{1} = \\left(\\frac{n_{2}}{n_{1} + n_{2}}\\right)^{2} \\left(\\frac{-A_{12} n_{1} + A_{12} n_{2} + 2 A_{21} n_{1}}{n_{1} + n_{2}}\\right) = x_{2}^{2} \\left[ -A_{12} x_{1} + A_{12} x_{2} + 2 A_{21} x_{1} \\right]\n$$\nThis can be rearranged as:\n$$\n\\ln \\gamma_{1} = x_{2}^{2} \\left[ A_{12} (x_{2} - x_{1}) + 2 A_{21} x_{1} \\right]\n$$\nUsing the relation $x_{2} = 1 - x_{1}$, this becomes:\n$$\n\\ln \\gamma_{1} = x_{2}^{2} \\left[ A_{12} (1 - x_{1} - x_{1}) + 2 A_{21} x_{1} \\right] = x_{2}^{2} \\left[ A_{12} (1 - 2x_{1}) + 2 A_{21} x_{1} \\right]\n$$\nFactoring this expression gives the standard form:\n$$\n\\ln \\gamma_{1} = x_{2}^{2} \\left[ A_{12} + 2(A_{21} - A_{12})x_{1} \\right]\n$$\nTo find $\\ln \\gamma_{2}$, we differentiate $\\frac{G^{E}}{R T}$ with respect to $n_{2}$ while holding $n_{1}$ constant. The expression for $G^{E}$ is symmetric upon interchange of indices $1 \\leftrightarrow 2$ and $A_{12} \\leftrightarrow A_{21}$. One could invoke this symmetry to write down the expression for $\\ln \\gamma_{2}$ directly. However, for rigor, we perform the differentiation.\n$$\nu = A_{12} n_{1} n_{2}^{2} + A_{21} n_{1}^{2} n_{2}, \\quad v = (n_{1} + n_{2})^{2}\n$$\nThe partial derivatives with respect to $n_{2}$ are:\n$$\n\\frac{\\partial u}{\\partial n_{2}} = 2 A_{12} n_{1} n_{2} + A_{21} n_{1}^{2}\n$$\n$$\n\\frac{\\partial v}{\\partial n_{2}} = 2 (n_{1} + n_{2})\n$$\nApplying the quotient rule:\n$$\n\\ln \\gamma_{2} = \\frac{\\left( 2 A_{12} n_{1} n_{2} + A_{21} n_{1}^{2} \\right) (n_{1} + n_{2})^{2} - \\left( A_{12} n_{1} n_{2}^{2} + A_{21} n_{1}^{2} n_{2} \\right) 2 (n_{1} + n_{2})}{(n_{1} + n_{2})^{4}}\n$$\nCanceling a factor of $(n_{1} + n_{2})$:\n$$\n\\ln \\gamma_{2} = \\frac{\\left( 2 A_{12} n_{1} n_{2} + A_{21} n_{1}^{2} \\right) (n_{1} + n_{2}) - 2 \\left( A_{12} n_{1} n_{2}^{2} + A_{21} n_{1}^{2} n_{2} \\right)}{(n_{1} + n_{2})^{3}}\n$$\nExpanding the numerator:\n$$\n\\text{Numerator} = (2 A_{12} n_{1}^{2} n_{2} + 2 A_{12} n_{1} n_{2}^{2} + A_{21} n_{1}^{3} + A_{21} n_{1}^{2} n_{2}) - (2 A_{12} n_{1} n_{2}^{2} + 2 A_{21} n_{1}^{2} n_{2})\n$$\n$$\n\\text{Numerator} = 2 A_{12} n_{1}^{2} n_{2} + A_{21} n_{1}^{3} - A_{21} n_{1}^{2} n_{2} = n_{1}^{2}(2 A_{12} n_{2} + A_{21} n_{1} - A_{21} n_{2})\n$$\nSubstituting this back gives:\n$$\n\\ln \\gamma_{2} = \\frac{n_{1}^{2}(2 A_{12} n_{2} + A_{21} n_{1} - A_{21} n_{2})}{(n_{1} + n_{2})^{3}}\n$$\nConverting to mole fractions:\n$$\n\\ln \\gamma_{2} = \\left(\\frac{n_{1}}{n_{1} + n_{2}}\\right)^{2} \\left(\\frac{2 A_{12} n_{2} + A_{21} n_{1} - A_{21} n_{2}}{n_{1} + n_{2}}\\right) = x_{1}^{2} \\left[ 2 A_{12} x_{2} + A_{21} x_{1} - A_{21} x_{2} \\right]\n$$\nThis can be rearranged as:\n$$\n\\ln \\gamma_{2} = x_{1}^{2} \\left[ A_{21} (x_{1} - x_{2}) + 2 A_{12} x_{2} \\right]\n$$\nUsing the relation $x_{1} = 1 - x_{2}$:\n$$\n\\ln \\gamma_{2} = x_{1}^{2} \\left[ A_{21} (1 - x_{2} - x_{2}) + 2 A_{12} x_{2} \\right] = x_{1}^{2} \\left[ A_{21} (1 - 2x_{2}) + 2 A_{12} x_{2} \\right]\n$$\nFactoring this expression gives the standard form:\n$$\n\\ln \\gamma_{2} = x_{1}^{2} \\left[ A_{21} + 2(A_{12} - A_{21})x_{2} \\right]\n$$\nThe derived expressions for $\\ln \\gamma_{1}$ and $\\ln \\gamma_{2}$ are the required closed-form results. They are presented as a row vector as requested.", "answer": "$$\n\\boxed{\\begin{pmatrix} x_{2}^{2} \\left[ A_{12} + 2(A_{21} - A_{12})x_{1} \\right]  x_{1}^{2} \\left[ A_{21} + 2(A_{12} - A_{21})x_{2} \\right] \\end{pmatrix}}\n$$", "id": "2622604"}, {"introduction": "The properties of components in a mixture are thermodynamically linked; they cannot vary independently. This hands-on practice explores this interdependence through the Gibbs-Duhem equation, a fundamental constraint on activity coefficients [@problem_id:2622647]. By starting with the known behavior of one component, you will use this powerful relation to predict the behavior of the other, a technique essential for validating both experimental data and theoretical models.", "problem": "A binary liquid solution of components $1$ and $2$ at constant temperature $T$ and pressure $P$ is described by a composition-dependent activity coefficient for component $1$ given by the function\n$$\n\\ln \\gamma_{1}(x_{1}) \\;=\\; A\\,(1 - x_{1})^{2} \\;+\\; B\\,x_{1}\\,(1 - x_{1})^{3},\n$$\nwhere $x_{1}$ is the mole fraction of component $1$, and $A$ and $B$ are composition-independent parameters. For this system, take $A = 0.80$ and $B = 0.50$. Assume the conventional liquid standard state in which $\\lim_{x_{i}\\to 1}\\gamma_{i}=1$ for each component $i$.\n\nUsing only fundamental thermodynamic consistency for binary mixtures at fixed $T$ and $P$, determine the value of $\\ln \\gamma_{2}$ at $x_{1}=0.40$. Clearly state and apply any boundary condition required by the standard-state convention. Round your final numerical answer to four significant figures. Express your answer as a pure number (dimensionless).", "solution": "The problem statement is first subjected to rigorous validation.\n\n**Step 1: Extract Givens**\n- The system is a binary liquid solution of components $1$ and $2$ at constant temperature $T$ and pressure $P$.\n- The activity coefficient of component $1$ is given by:\n$$\n\\ln \\gamma_{1}(x_{1}) \\;=\\; A\\,(1 - x_{1})^{2} \\;+\\; B\\,x_{1}\\,(1 - x_{1})^{3}\n$$\n- $x_{1}$ is the mole fraction of component $1$.\n- Parameters are given as $A = 0.80$ and $B = 0.50$.\n- The standard state is the conventional liquid standard state, for which $\\lim_{x_{i}\\to 1}\\gamma_{i}=1$ for each component $i=1, 2$.\n- The objective is to calculate $\\ln \\gamma_{2}$ at $x_{1}=0.40$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, relying on the established principles of chemical thermodynamics, specifically the Gibbs-Duhem equation. The provided functional form for $\\ln \\gamma_{1}$ is a polynomial-type expression consistent with models for excess Gibbs energy. The stated standard state condition, $\\lim_{x_{1}\\to 1}\\gamma_{1}=1$, is checked against the given function:\n$$\n\\lim_{x_{1}\\to 1} \\ln \\gamma_{1}(x_{1}) = \\lim_{x_{1}\\to 1} \\left[ A\\,(1 - x_{1})^{2} \\;+\\; B\\,x_{1}\\,(1 - x_{1})^{3} \\right] = A(0)^2 + B(1)(0)^3 = 0\n$$\nThis implies $\\lim_{x_{1}\\to 1} \\gamma_{1} = \\exp(0) = 1$, so the function is consistent with the boundary condition. The problem is self-contained, objective, and well-posed, providing all necessary information for a unique solution.\n\n**Verdict:** The problem is valid. We proceed to the solution.\n\nThe fundamental thermodynamic relation for activity coefficients in a binary mixture at constant temperature $T$ and pressure $P$ is the Gibbs-Duhem equation:\n$$\nx_{1} d(\\ln \\gamma_{1}) + x_{2} d(\\ln \\gamma_{2}) = 0\n$$\nwhere $x_{2} = 1 - x_{1}$. This equation enforces thermodynamic consistency. We rearrange it to solve for the differential of $\\ln \\gamma_{2}$:\n$$\nd(\\ln \\gamma_{2}) = -\\frac{x_{1}}{x_{2}} d(\\ln \\gamma_{1}) = -\\frac{x_{1}}{1-x_{1}} d(\\ln \\gamma_{1})\n$$\nThe differential $d(\\ln \\gamma_{1})$ is found by differentiating the given expression for $\\ln \\gamma_{1}(x_{1})$ with respect to $x_{1}$:\n$$\n\\frac{d(\\ln \\gamma_{1})}{dx_{1}} = \\frac{d}{dx_{1}} \\left[ A(1-x_{1})^2 + Bx_{1}(1-x_{1})^3 \\right]\n$$\nUsing the chain rule and product rule for differentiation:\n$$\n\\frac{d(\\ln \\gamma_{1})}{dx_{1}} = A \\cdot 2(1-x_{1})(-1) + B \\left[ (1)(1-x_{1})^3 + x_{1} \\cdot 3(1-x_{1})^2(-1) \\right]\n$$\n$$\n\\frac{d(\\ln \\gamma_{1})}{dx_{1}} = -2A(1-x_{1}) + B(1-x_{1})^3 - 3Bx_{1}(1-x_{1})^2\n$$\nFactoring out a term $(1-x_{1})^2$ from the terms involving $B$:\n$$\n\\frac{d(\\ln \\gamma_{1})}{dx_{1}} = -2A(1-x_{1}) + B(1-x_{1})^2 [ (1-x_{1}) - 3x_{1} ]\n$$\n$$\n\\frac{d(\\ln \\gamma_{1})}{dx_{1}} = -2A(1-x_{1}) + B(1-4x_{1})(1-x_{1})^2\n$$\nNow, we substitute this derivative into the Gibbs-Duhem relation for $d(\\ln \\gamma_{2})$:\n$$\nd(\\ln \\gamma_{2}) = -\\frac{x_{1}}{1-x_{1}} \\left[ -2A(1-x_{1}) + B(1-4x_{1})(1-x_{1})^2 \\right] dx_{1}\n$$\nSimplifying the expression:\n$$\n\\frac{d(\\ln \\gamma_{2})}{dx_{1}} = -x_{1} \\left[ -2A + B(1-4x_{1})(1-x_{1}) \\right]\n$$\n$$\n\\frac{d(\\ln \\gamma_{2})}{dx_{1}} = 2Ax_{1} - Bx_{1}(1 - 5x_{1} + 4x_{1}^2)\n$$\n$$\n\\frac{d(\\ln \\gamma_{2})}{dx_{1}} = 2Ax_{1} - Bx_{1} + 5Bx_{1}^2 - 4Bx_{1}^3\n$$\n$$\n\\frac{d(\\ln \\gamma_{2})}{dx_{1}} = (2A-B)x_{1} + 5Bx_{1}^2 - 4Bx_{1}^3\n$$\nTo find $\\ln \\gamma_{2}(x_1)$, we must integrate this expression. The integration constant is determined by the boundary condition for component $2$. The standard state convention requires $\\lim_{x_{2}\\to 1}\\gamma_{2}=1$, which is equivalent to $\\lim_{x_{1}\\to 0}\\gamma_{2}=1$. In terms of the logarithm, this condition is $\\ln \\gamma_{2}(x_1=0) = 0$.\nWe integrate from $x'_{1}=0$ to $x'_{1}=x_{1}$:\n$$\n\\int_{0}^{\\ln \\gamma_{2}(x_{1})} d(\\ln \\gamma_{2}) = \\int_{0}^{x_{1}} \\left[ (2A-B)x'_{1} + 5B(x'_{1})^2 - 4B(x'_{1})^3 \\right] dx'_{1}\n$$\n$$\n\\ln \\gamma_{2}(x_{1}) - \\ln \\gamma_{2}(0) = \\left[ (2A-B)\\frac{(x'_{1})^2}{2} + 5B\\frac{(x'_{1})^3}{3} - 4B\\frac{(x'_{1})^4}{4} \\right]_{0}^{x_{1}}\n$$\nWith $\\ln \\gamma_{2}(0)=0$, we obtain the final analytical expression for $\\ln \\gamma_{2}(x_{1})$:\n$$\n\\ln \\gamma_{2}(x_{1}) = \\left(A - \\frac{B}{2}\\right)x_{1}^2 + \\frac{5B}{3}x_{1}^3 - Bx_{1}^4\n$$\nWe are asked to find the value of $\\ln \\gamma_{2}$ at $x_{1}=0.40$, given $A=0.80$ and $B=0.50$. We substitute these values into the derived expression:\n$$\n\\ln \\gamma_{2}(0.40) = \\left(0.80 - \\frac{0.50}{2}\\right)(0.40)^2 + \\frac{5(0.50)}{3}(0.40)^3 - (0.50)(0.40)^4\n$$\n$$\n\\ln \\gamma_{2}(0.40) = (0.80 - 0.25)(0.16) + \\frac{2.5}{3}(0.064) - (0.50)(0.0256)\n$$\n$$\n\\ln \\gamma_{2}(0.40) = (0.55)(0.16) + \\frac{0.16}{3} - 0.0128\n$$\n$$\n\\ln \\gamma_{2}(0.40) = 0.088 + 0.053333... - 0.0128\n$$\n$$\n\\ln \\gamma_{2}(0.40) = 0.141333... - 0.0128 = 0.1285333...\n$$\nRounding the result to four significant figures as required by the problem statement gives $0.1285$. This value is dimensionless.", "answer": "$$\n\\boxed{0.1285}\n$$", "id": "2622647"}, {"introduction": "Bridging theory with experimental observation is a central task in physical chemistry. This comprehensive exercise challenges you to act as a thermodynamic modeler, using real-world numerical techniques to analyze activity coefficient data [@problem_id:2622642]. You will fit the parameters of the Margules model to a dataset and then apply a numerical form of the Gibbs-Duhem test to assess the thermodynamic consistency of the original data itself.", "problem": "You are given binary-mixture activity coefficient data $\\gamma_i(x_1)$ at constant temperature and pressure for a set of compositions $x_1 \\in (0,1)$, where $x_2 = 1 - x_1$. The activity coefficient $\\gamma_i$ is defined by the thermodynamic relation $\\mu_i = \\mu_i^\\circ + R T \\ln a_i$ with $a_i = \\gamma_i x_i$, where $\\mu_i$ is the chemical potential of component $i$, $\\mu_i^\\circ$ is a reference chemical potential, $R$ is the universal gas constant, and $T$ is the temperature. The task is to fit parameters of a three-suffix Margules model to the provided data via least squares and then assess thermodynamic consistency via the Gibbs–Duhem relation.\n\nUse the following physical-chemistry fundamentals as your starting base:\n- The excess Gibbs free energy per mole, $g^E \\equiv G^E/n$, is related to activity coefficients via the definition\n$$\n\\ln \\gamma_i = \\left(\\frac{\\partial (n g^E / R T)}{\\partial n_i}\\right)_{T,P,\\{n_{j \\neq i}\\}},\n$$\nwhere $n$ is the total number of moles and $n_i$ is the number of moles of component $i$.\n- The three-suffix Margules excess Gibbs free energy model (per mole) is\n$$\n\\frac{g^E}{R T} = x_1 x_2 \\left( A_{12} x_2 + A_{21} x_1 \\right),\n$$\nwith composition-independent parameters $A_{12}$ and $A_{21}$.\n- The Gibbs–Duhem relation for a binary mixture at constant temperature and pressure implies\n$$\nx_1 \\, d \\ln \\gamma_1 + x_2 \\, d \\ln \\gamma_2 = 0,\n$$\nfor all compositions $x_1 \\in (0,1)$.\n\nYour program must:\n1) Derive from first principles, starting from the definitions above, expressions for $\\ln \\gamma_1(x_1; A_{12}, A_{21})$ and $\\ln \\gamma_2(x_1; A_{12}, A_{21})$ implied by the three-suffix Margules model. The derivation is part of the solution, not the program. The program should implement the resulting expressions.\n2) Given a dataset $\\{(x_1^{(j)}, \\gamma_1^{(j)}, \\gamma_2^{(j)})\\}_{j=1}^{N}$, determine the parameters $A_{12}$ and $A_{21}$ by minimizing the unweighted sum of squared residuals\n$$\nS(A_{12},A_{21}) = \\sum_{j=1}^{N} \\left[ \\ln \\gamma_1^{(j)} - \\ln \\gamma_1\\!\\left(x_1^{(j)}; A_{12}, A_{21}\\right) \\right]^2 + \\left[ \\ln \\gamma_2^{(j)} - \\ln \\gamma_2\\!\\left(x_1^{(j)}; A_{12}, A_{21}\\right) \\right]^2,\n$$\nwhere $\\ln$ denotes the natural logarithm. All activity coefficients are dimensionless. There are no physical units to report.\n3) Assess thermodynamic consistency of the dataset using Gibbs–Duhem integration by computing the scalar consistency metric\n$$\n\\mathcal{M} = \\int_{x_{\\min}}^{x_{\\max}} \\left| x_1 \\frac{d \\ln \\gamma_1}{d x_1} + x_2 \\frac{d \\ln \\gamma_2}{d x_1} \\right| \\, d x_1,\n$$\napproximated numerically via the trapezoidal rule on the provided abscissae and using finite differences to approximate the derivatives from the measured $\\ln \\gamma_i$ data:\n- Use forward difference at the left endpoint, backward difference at the right endpoint, and central difference at interior points.\n- Then integrate the absolute value of the Gibbs–Duhem residual density over the given $x_1$ domain.\n\nDatasets (test suite):\n- Test case 1 (exact data from the Margules model):\n  - Compositions: $x_1 = [0.1, 0.3, 0.5, 0.7, 0.9]$.\n  - Parameters used to generate data: $A_{12} = 1.2$, $A_{21} = 0.6$.\n  - Generate the data as follows: compute $\\ln \\gamma_i(x_1)$ from the derived expressions and set $\\gamma_i(x_1) = \\exp(\\ln \\gamma_i(x_1))$ with no added noise.\n- Test case 2 (symmetric mixture with small noise near the boundaries and mid-composition):\n  - Compositions: $x_1 = [0.01, 0.1, 0.5, 0.9, 0.99]$.\n  - Clean parameters: $A_{12} = 1.5$, $A_{21} = 1.5$.\n  - Noise sequences (additive in $\\ln \\gamma$): for component $1$, $\\varepsilon_1 = [0.0030, -0.0010, 0.0005, -0.0020, 0.0015]$; for component $2$, $\\varepsilon_2 = [-0.0020, 0.0015, -0.0005, 0.0025, -0.0010]$.\n  - Generate the data as follows: compute the clean $\\ln \\gamma_i(x_1)$ from the derived expressions, then set $\\ln \\gamma_1^{\\text{data}} = \\ln \\gamma_1^{\\text{clean}} + \\varepsilon_1$, $\\ln \\gamma_2^{\\text{data}} = \\ln \\gamma_2^{\\text{clean}} + \\varepsilon_2$, and finally $\\gamma_i = \\exp(\\ln \\gamma_i^{\\text{data}})$.\n- Test case 3 (asymmetric mixture with small noise):\n  - Compositions: $x_1 = [0.05, 0.2, 0.4, 0.6, 0.8, 0.95]$.\n  - Clean parameters: $A_{12} = 2.0$, $A_{21} = 0.2$.\n  - Noise sequences (additive in $\\ln \\gamma$): for component $1$, $\\varepsilon_1 = [0.0010, -0.0005, 0.0008, -0.0012, 0.0007, -0.0009]$; for component $2$, $\\varepsilon_2 = [-0.0007, 0.0011, -0.0006, 0.0004, -0.0013, 0.0009]$.\n  - Generate the data as follows: compute the clean $\\ln \\gamma_i(x_1)$ from the derived expressions, then set $\\ln \\gamma_1^{\\text{data}} = \\ln \\gamma_1^{\\text{clean}} + \\varepsilon_1$, $\\ln \\gamma_2^{\\text{data}} = \\ln \\gamma_2^{\\text{clean}} + \\varepsilon_2$, and finally $\\gamma_i = \\exp(\\ln \\gamma_i^{\\text{data}})$.\n\nImplementation and output requirements:\n- Use the natural logarithm for all $\\ln$ operations.\n- For each test case, output the fitted parameters and the consistency metric as the triplet $[A_{12}^{\\text{fit}}, A_{21}^{\\text{fit}}, \\mathcal{M}]$ with each value rounded to six decimal places.\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list of triplets enclosed in square brackets, for example, the exact format must be:\n\"[[A12_1,A21_1,M_1],[A12_2,A21_2,M_2],[A12_3,A21_3,M_3]]\"\n- All reported quantities are dimensionless; do not include any units or percentage signs. Angles are not involved in this problem.\n\nYour solution must be a complete, runnable program that implements the derivation-derived formulas, performs the least-squares fits, computes the Gibbs–Duhem consistency metric via numerical differentiation and trapezoidal integration, and prints the result for all test cases in the exact required single-line format. No user input is needed; all data are specified above and must be embedded in the program.", "solution": "The problem presented is a standard exercise in chemical thermodynamics, specifically the modeling of non-ideal liquid mixtures. It is scientifically sound, well-posed, and contains all necessary information for a unique solution. The procedures for parameter estimation and thermodynamic consistency testing are clearly defined. Therefore, the problem is deemed valid and a full solution will be provided.\n\nThe solution requires three main components: first, the derivation of the activity coefficient expressions from the given model for the excess Gibbs free energy; second, the implementation of a linear least-squares procedure to fit the model parameters to data; and third, a numerical assessment of the thermodynamic consistency of the data via the Gibbs-Duhem relation.\n\n**1. Derivation of Activity Coefficient Expressions**\n\nWe begin with the fundamental definition relating the natural logarithm of the activity coefficient, $\\ln \\gamma_i$, to the molar excess Gibbs free energy, $g^E$:\n$$\n\\ln \\gamma_i = \\left(\\frac{\\partial (n g^E / R T)}{\\partial n_i}\\right)_{T,P,\\{n_{j \\neq i}\\}}\n$$\nwhere $n = \\sum_k n_k$ is the total number of moles and $n_i$ is the number of moles of component $i$. For a binary mixture, $n = n_1 + n_2$. The mole fractions are $x_1 = n_1/n$ and $x_2 = n_2/n$.\n\nThe three-suffix Margules model for $g^E$ is given as:\n$$\n\\frac{g^E}{R T} = x_1 x_2 \\left( A_{12} x_2 + A_{21} x_1 \\right)\n$$\nTo perform the partial differentiation, we first express the quantity $n g^E / R T$ in terms of mole numbers $n_1$ and $n_2$:\n$$\n\\frac{n g^E}{R T} = n \\left( \\frac{n_1}{n} \\right) \\left( \\frac{n_2}{n} \\right) \\left[ A_{12} \\left( \\frac{n_2}{n} \\right) + A_{21} \\left( \\frac{n_1}{n} \\right) \\right] = \\frac{n_1 n_2}{n^2} (A_{12} n_2 + A_{21} n_1)\n$$\nSubstituting $n = n_1+n_2$, we have:\n$$\n\\frac{n g^E}{R T} = \\frac{n_1 n_2 (A_{12} n_2 + A_{21} n_1)}{(n_1+n_2)^2}\n$$\nA more direct method for deriving $\\ln \\gamma_i$ for a binary system uses the relation:\n$$\n\\ln \\gamma_1 = \\frac{g^E}{RT} + (1-x_1) \\frac{d(g^E/RT)}{dx_1} = \\frac{g^E}{RT} + x_2 \\frac{d(g^E/RT)}{dx_1}\n$$\nand symmetrically for component $2$:\n$$\n\\ln \\gamma_2 = \\frac{g^E}{RT} - x_1 \\frac{d(g^E/RT)}{dx_1}\n$$\nLet $f(x_1) = g^E/RT = x_1(1-x_1)[A_{12}(1-x_1) + A_{21}x_1]$. We first compute the derivative of $f(x_1)$ with respect to $x_1$:\n$$\n\\frac{df}{dx_1} = \\frac{d}{dx_1} \\left( (x_1 - x_1^2) (A_{12} + (A_{21}-A_{12})x_1) \\right)\n$$\n$$\n\\frac{df}{dx_1} = (1 - 2x_1) (A_{12} + (A_{21}-A_{12})x_1) + (x_1 - x_1^2) (A_{21}-A_{12})\n$$\n$$\n\\frac{df}{dx_1} = (x_2 - x_1) [A_{12}x_2 + A_{21}x_1] + x_1 x_2 (A_{21} - A_{12})\n$$\nNow we substitute this into the expression for $\\ln \\gamma_1$:\n$$\n\\ln \\gamma_1 = x_1 x_2 (A_{12} x_2 + A_{21} x_1) + x_2 \\left[ (x_2-x_1)(A_{12}x_2 + A_{21}x_1) + x_1 x_2 (A_{21}-A_{12}) \\right]\n$$\nFactoring out $x_2$ and combining terms:\n$$\n\\ln \\gamma_1 = x_2 \\left[ (x_1 + x_2 - x_1)(A_{12}x_2 + A_{21}x_1) + x_1 x_2 (A_{21}-A_{12}) \\right]\n$$\n$$\n\\ln \\gamma_1 = x_2 \\left[ x_2(A_{12}x_2 + A_{21}x_1) + x_1 x_2 (A_{21}-A_{12}) \\right]\n$$\n$$\n\\ln \\gamma_1 = x_2^2 \\left[ (A_{12}x_2 + A_{21}x_1) + x_1 (A_{21}-A_{12}) \\right]\n$$\n$$\n\\ln \\gamma_1 = x_2^2 \\left[ A_{12}x_2 + A_{21}x_1 + A_{21}x_1 - A_{12}x_1 \\right]\n$$\n$$\n\\ln \\gamma_1 = x_2^2 \\left[ A_{12}(x_2 - x_1) + 2 A_{21} x_1 \\right]\n$$\nSubstituting $x_2 = 1 - x_1$, we obtain the final form for implementation:\n$$\n\\ln \\gamma_1(x_1) = (1-x_1)^2 \\left[ A_{12}(1 - 2x_1) + 2 A_{21} x_1 \\right]\n$$\nBy symmetry, one can obtain the expression for $\\ln \\gamma_2$ by interchanging indices $1 \\leftrightarrow 2$ and parameters $A_{12} \\leftrightarrow A_{21}$. However, a direct derivation using $\\ln \\gamma_2 = f(x_1) - x_1 \\frac{df}{dx_1}$ is more rigorous and less prone to error.\n$$\n\\ln \\gamma_2 = x_1 x_2 (A_{12} x_2 + A_{21} x_1) - x_1 \\left[ (x_2-x_1)(A_{12}x_2 + A_{21}x_1) + x_1 x_2 (A_{21}-A_{12}) \\right]\n$$\n$$\n\\ln \\gamma_2 = x_1 \\left[ (x_2 - (x_2-x_1))(A_{12}x_2 + A_{21}x_1) - x_1 x_2 (A_{21}-A_{12}) \\right]\n$$\n$$\n\\ln \\gamma_2 = x_1 \\left[ x_1(A_{12}x_2 + A_{21}x_1) - x_1 x_2 (A_{21}-A_{12}) \\right]\n$$\n$$\n\\ln \\gamma_2 = x_1^2 \\left[ (A_{12}x_2 + A_{21}x_1) - x_2 (A_{21}-A_{12}) \\right]\n$$\n$$\n\\ln \\gamma_2 = x_1^2 \\left[ A_{12}x_2 + A_{21}x_1 - A_{21}x_2 + A_{12}x_2 \\right]\n$$\n$$\n\\ln \\gamma_2 = x_1^2 \\left[ A_{21}(x_1 - x_2) + 2 A_{12} x_2 \\right]\n$$\nSubstituting $x_2 = 1-x_1$ and $x_1-x_2 = 2x_1-1$:\n$$\n\\ln \\gamma_2(x_1) = x_1^2 \\left[ A_{21}(2x_1 - 1) + 2 A_{12} (1-x_1) \\right]\n$$\nThese derived expressions form the basis for the regression.\n\n**2. Parameter Fitting via Linear Least Squares**\n\nThe objective is to find parameters $A_{12}$ and $A_{21}$ that minimize the sum of squared residuals, $S$:\n$$\nS(A_{12},A_{21}) = \\sum_{j=1}^{N} \\left[ \\left( \\ln \\gamma_1^{(j)} - \\ln \\gamma_1^{\\text{model}}(x_{1}^{(j)}) \\right)^2 + \\left( \\ln \\gamma_2^{(j)} - \\ln \\gamma_2^{\\text{model}}(x_{1}^{(j)}) \\right)^2 \\right]\n$$\nThe model equations are linear with respect to the parameters $A_{12}$ and $A_{21}$. We can rewrite them as:\n$$\n\\ln \\gamma_1^{\\text{model}}(x_1) = A_{12} \\cdot \\left[ (1-x_1)^2 (1-2x_1) \\right] + A_{21} \\cdot \\left[ (1-x_1)^2 (2x_1) \\right]\n$$\n$$\n\\ln \\gamma_2^{\\text{model}}(x_1) = A_{12} \\cdot \\left[ x_1^2 \\cdot 2(1-x_1) \\right] + A_{21} \\cdot \\left[ x_1^2 (2x_1 - 1) \\right]\n$$\nThis structure defines a system of linear equations of the form $\\mathbf{Y} = \\mathbf{Xp}$, where $\\mathbf{p} = [A_{12}, A_{21}]^T$ is the parameter vector. For $N$ data points, the observation vector $\\mathbf{Y}$ has $2N$ elements, $\\mathbf{Y} = [\\ln\\gamma_1^{(1)}, \\ln\\gamma_2^{(1)}, \\dots, \\ln\\gamma_1^{(N)}, \\ln\\gamma_2^{(N)}]^T$. The design matrix $\\mathbf{X}$ is of size $2N \\times 2$. For each data point $j$, the corresponding two rows in $\\mathbf{X}$ are:\n$$\n\\mathbf{X}_j = \n\\begin{pmatrix}\n(1-x_1^{(j)})^2 (1-2x_1^{(j)})  (1-x_1^{(j)})^2 (2x_1^{(j)}) \\\\\n(x_1^{(j)})^2 \\cdot 2(1-x_1^{(j)})  (x_1^{(j)})^2 (2x_1^{(j)} - 1)\n\\end{pmatrix}\n$$\nThe least-squares solution for $\\mathbf{p}$ is given by $\\mathbf{p} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{Y}$. This will be implemented numerically.\n\n**3. Thermodynamic Consistency Assessment**\n\nThe Gibbs-Duhem equation at constant temperature and pressure for a binary mixture is $x_1 d\\ln\\gamma_1 + x_2 d\\ln\\gamma_2 = 0$. Dividing by $dx_1$, we obtain the differential form:\n$$\nx_1 \\frac{d\\ln\\gamma_1}{dx_1} + x_2 \\frac{d\\ln\\gamma_2}{dx_1} = 0\n$$\nThe consistency metric $\\mathcal{M}$ measures the integrated deviation from this identity using the provided experimental data.\n$$\n\\mathcal{M} = \\int_{x_{\\min}}^{x_{\\max}} \\left| x_1 \\frac{d\\ln\\gamma_1}{dx_1} + x_2 \\frac{d\\ln\\gamma_2}{dx_1} \\right| dx_1\n$$\nThis calculation is performed numerically.\nFirst, the derivatives $d\\ln\\gamma_i/dx_1$ are approximated at each data point $x_1^{(j)}$ using finite differences on the experimental $\\ln\\gamma_i$ values. For a set of points $(x_j, y_j)$:\n- Forward difference at the first point ($j=0$): $y'_0 \\approx (y_1 - y_0) / (x_1 - x_0)$\n- Backward difference at the last point ($j=N-1$): $y'_{N-1} \\approx (y_{N-1} - y_{N-2}) / (x_{N-1} - x_{N-2})$\n- Central difference for interior points ($0  j  N-1$): $y'_j \\approx (y_{j+1} - y_{j-1}) / (x_{j+1} - x_{j-1})$\n\nSecond, the absolute value of the Gibbs-Duhem residual, $I_j = |x_1^{(j)}(d\\ln\\gamma_1/dx_1)_j + (1-x_1^{(j)})(d\\ln\\gamma_2/dx_1)_j|$, is computed at each point.\n\nThird, the integral $\\mathcal{M}$ is approximated using the trapezoidal rule over the non-uniformly spaced abscissae $x_1^{(j)}$:\n$$\n\\mathcal{M} \\approx \\sum_{j=0}^{N-2} \\frac{I_j + I_{j+1}}{2} (x_1^{(j+1)} - x_1^{(j)})\n$$\nA small value of $\\mathcal{M}$ indicates a high degree of thermodynamic consistency in the dataset. A value of zero (or near machine precision) is expected for data generated directly from a thermodynamically consistent model, such as the Margules equation.\n\nThe program will implement these three stages for each provided test case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting Margules parameters and assessing\n    thermodynamic consistency for three test cases.\n    \"\"\"\n\n    # --- Test Case Definitions ---\n    test_cases = [\n        {\n            \"name\": \"Test Case 1: Exact Data\",\n            \"x1\": np.array([0.1, 0.3, 0.5, 0.7, 0.9]),\n            \"A12_true\": 1.2,\n            \"A21_true\": 0.6,\n            \"noise_1\": np.zeros(5),\n            \"noise_2\": np.zeros(5),\n        },\n        {\n            \"name\": \"Test Case 2: Symmetric Mixture with Noise\",\n            \"x1\": np.array([0.01, 0.1, 0.5, 0.9, 0.99]),\n            \"A12_true\": 1.5,\n            \"A21_true\": 1.5,\n            \"noise_1\": np.array([0.0030, -0.0010, 0.0005, -0.0020, 0.0015]),\n            \"noise_2\": np.array([-0.0020, 0.0015, -0.0005, 0.0025, -0.0010]),\n        },\n        {\n            \"name\": \"Test Case 3: Asymmetric Mixture with Noise\",\n            \"x1\": np.array([0.05, 0.2, 0.4, 0.6, 0.8, 0.95]),\n            \"A12_true\": 2.0,\n            \"A21_true\": 0.2,\n            \"noise_1\": np.array([0.0010, -0.0005, 0.0008, -0.0012, 0.0007, -0.0009]),\n            \"noise_2\": np.array([-0.0007, 0.0011, -0.0006, 0.0004, -0.0013, 0.0009]),\n        },\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        x1_data = case[\"x1\"]\n        x2_data = 1.0 - x1_data\n\n        # --- 1. Generate Data ---\n        # Compute clean ln(gamma) values from the Margules model\n        ln_gamma1_clean = (x2_data**2) * (case[\"A12_true\"] * (x2_data - x1_data) + 2 * case[\"A21_true\"] * x1_data)\n        ln_gamma2_clean = (x1_data**2) * (case[\"A21_true\"] * (x1_data - x2_data) + 2 * case[\"A12_true\"] * x2_data)\n\n        # Add noise\n        ln_gamma1_data = ln_gamma1_clean + case[\"noise_1\"]\n        ln_gamma2_data = ln_gamma2_clean + case[\"noise_2\"]\n        \n        # Note: experimental gamma values are not explicitly needed for the calculation,\n        # as the tasks operate on ln(gamma).\n\n        # --- 2. Fit Parameters ---\n        num_points = len(x1_data)\n        # Design matrix X (2N x 2) and observation vector Y (2N x 1)\n        X = np.zeros((2 * num_points, 2))\n        Y = np.zeros(2 * num_points)\n\n        for j in range(num_points):\n            x1 = x1_data[j]\n            x2 = 1.0 - x1\n\n            # Row for gamma1 data point\n            X[2 * j, 0] = (x2**2) * (1 - 2 * x1)          # Coefficient of A12\n            X[2 * j, 1] = (x2**2) * (2 * x1)              # Coefficient of A21\n            Y[2 * j] = ln_gamma1_data[j]\n\n            # Row for gamma2 data point\n            X[2 * j + 1, 0] = (x1**2) * (2 * x2)          # Coefficient of A12\n            X[2 * j + 1, 1] = (x1**2) * (2 * x1 - 1)      # Coefficient of A21\n            Y[2 * j + 1] = ln_gamma2_data[j]\n\n        # Solve the linear least-squares problem\n        params, _, _, _ = np.linalg.lstsq(X, Y, rcond=None)\n        A12_fit, A21_fit = params\n\n        # --- 3. Assess Thermodynamic Consistency ---\n        # Numerical differentiation of ln(gamma) data\n        def finite_difference(x, y):\n            n = len(x)\n            dydx = np.zeros(n)\n            # Forward difference at the first point\n            dydx[0] = (y[1] - y[0]) / (x[1] - x[0])\n            # Central difference for interior points\n            for i in range(1, n - 1):\n                dydx[i] = (y[i+1] - y[i-1]) / (x[i+1] - x[i-1])\n            # Backward difference at the last point\n            dydx[n-1] = (y[n-1] - y[n-2]) / (x[n-1] - x[n-2])\n            return dydx\n\n        d_lng1_dx1 = finite_difference(x1_data, ln_gamma1_data)\n        d_lng2_dx1 = finite_difference(x1_data, ln_gamma2_data)\n\n        # Calculate Gibbs-Duhem residual density\n        gd_residual_density = x1_data * d_lng1_dx1 + x2_data * d_lng2_dx1\n        abs_gd_residual_density = np.abs(gd_residual_density)\n        \n        # Integrate using the trapezoidal rule\n        consistency_metric_M = np.trapz(abs_gd_residual_density, x1_data)\n\n        # Append results rounded to six decimal places\n        all_results.append(\n            f\"[{A12_fit:.6f},{A21_fit:.6f},{consistency_metric_M:.6f}]\"\n        )\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2622642"}]}