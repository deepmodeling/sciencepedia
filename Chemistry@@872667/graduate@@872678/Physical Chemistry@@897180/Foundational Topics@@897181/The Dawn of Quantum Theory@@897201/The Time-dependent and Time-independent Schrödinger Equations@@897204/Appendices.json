{"hands_on_practices": [{"introduction": "While the quantum harmonic oscillator provides a fundamental model for molecular vibrations, real chemical bonds are not perfectly harmonic. This practice delves into how we can refine our models to account for this anharmonicity using perturbation theory. By treating the anharmonic term as a small correction to the harmonic potential, you will apply Rayleigh-Schrödinger perturbation theory to calculate the shift in the ground-state energy, a crucial skill for accurately interpreting vibrational spectra and understanding molecular potential energy surfaces [@problem_id:2822957].", "problem": "A single vibrational normal mode of a diatomic molecule is modeled along a one-dimensional coordinate by a harmonic potential with a weak quartic anharmonic correction. The time-independent Schrödinger equation (TISE) for a particle of mass $m$ in this potential is\n$$\\hat{H}\\psi(x)=E\\psi(x),\\qquad \\hat{H}=\\frac{\\hat{p}^{2}}{2m}+\\frac{1}{2}m\\omega^{2}x^{2}+\\lambda x^{4},$$\nwhere $\\omega$ is the harmonic frequency and $\\lambda$ is a small, positive real parameter characterizing the anharmonicity. Treat the quartic term as a perturbation to the harmonic oscillator. Starting from the TISE and the unperturbed harmonic oscillator eigenproblem, and using non-degenerate Rayleigh–Schrödinger perturbation theory consistently up to and including second order in $\\lambda$, derive a closed-form expression for the ground-state energy $E_{0}$ through $\\mathcal{O}(\\lambda^{2})$. Your derivation should:\n- Begin with the unperturbed harmonic oscillator eigenstates and energies, obtained from the TISE with $\\lambda=0$.\n- Use operator methods that are standard for the harmonic oscillator to evaluate needed matrix elements, explicitly justifying any selection rules you invoke.\n- Keep all constants and parameters symbolic (for example, $\\hbar$, $m$, $\\omega$, $\\lambda$), and do not insert numerical values at any stage.\n\nExpress the final ground-state energy as a single analytic expression in terms of $\\hbar$, $m$, $\\omega$, and $\\lambda$. Do not provide a numerical evaluation. No rounding is required. Do not include units in your final expression; provide only the exact symbolic result.", "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information for a unique solution. It is a standard problem in quantum mechanics, requiring the application of Rayleigh-Schrödinger perturbation theory. We shall proceed with the derivation.\n\nThe total Hamiltonian $\\hat{H}$ is decomposed into an unperturbed part $\\hat{H}^{(0)}$, representing the simple quantum harmonic oscillator (QHO), and a perturbation $\\hat{H}'$, representing the anharmonic correction.\n$$\n\\hat{H}^{(0)} = \\frac{\\hat{p}^{2}}{2m}+\\frac{1}{2}m\\omega^{2}x^{2}\n$$\n$$\n\\hat{H}' = \\lambda x^{4}\n$$\nThe unperturbed time-independent Schrödinger equation is $\\hat{H}^{(0)}|n\\rangle = E_n^{(0)}|n\\rangle$. Its solutions are well-known: the energy eigenvalues are $E_n^{(0)} = \\hbar\\omega(n+\\frac{1}{2})$ for non-negative integers $n$, and the corresponding orthonormal eigenstates are $|n\\rangle$. The ground state of the QHO is $|0\\rangle$, which is non-degenerate, with an unperturbed energy of $E_0^{(0)} = \\frac{1}{2}\\hbar\\omega$.\n\nWe use non-degenerate Rayleigh-Schrödinger perturbation theory to find the corrected ground-state energy $E_0$ up to second order in the perturbation parameter $\\lambda$. The energy is given by the expansion:\n$$\nE_0 = E_0^{(0)} + E_0^{(1)} + E_0^{(2)} + \\mathcal{O}(\\lambda^2)\n$$\nThe first-order correction to the energy is given by the expectation value of the perturbation in the unperturbed state:\n$$\nE_0^{(1)} = \\langle 0 | \\hat{H}' | 0 \\rangle = \\lambda \\langle 0 | \\hat{x}^4 | 0 \\rangle\n$$\nThe second-order correction is given by the sum over all other unperturbed states:\n$$\nE_0^{(2)} = \\sum_{k \\neq 0} \\frac{|\\langle k | \\hat{H}' | 0 \\rangle|^2}{E_0^{(0)} - E_k^{(0)}} = \\lambda^2 \\sum_{k \\neq 0} \\frac{|\\langle k | \\hat{x}^4 | 0 \\rangle|^2}{E_0^{(0)} - E_k^{(0)}}\n$$\nTo evaluate the matrix elements of $\\hat{x}^4$, we utilize the operator method. The position operator $\\hat{x}$ is expressed in terms of the lowering (annihilation) operator $\\hat{a}$ and the raising (creation) operator $\\hat{a}^{\\dagger}$:\n$$\n\\hat{x} = \\sqrt{\\frac{\\hbar}{2m\\omega}}(\\hat{a} + \\hat{a}^{\\dagger})\n$$\nThe actions of these operators on the eigenstates are $\\hat{a}|n\\rangle = \\sqrt{n}|n-1\\rangle$ (with $\\hat{a}|0\\rangle=0$) and $\\hat{a}^{\\dagger}|n\\rangle = \\sqrt{n+1}|n+1\\rangle$.\n\nFirst, we compute the first-order correction $E_0^{(1)}$. We must evaluate the matrix element $\\langle 0 | \\hat{x}^4 | 0 \\rangle$.\n$$\n\\langle 0 | \\hat{x}^4 | 0 \\rangle = \\left(\\frac{\\hbar}{2m\\omega}\\right)^2 \\langle 0 | (\\hat{a} + \\hat{a}^{\\dagger})^4 | 0 \\rangle\n$$\nTo find the matrix element, we compute the state vector resulting from the action of $(\\hat{a} + \\hat{a}^{\\dagger})^4$ on the ground state $|0\\rangle$ by sequential application:\n$$\n(\\hat{a} + \\hat{a}^{\\dagger})|0\\rangle = |1\\rangle\n$$\n$$\n(\\hat{a} + \\hat{a}^{\\dagger})^2|0\\rangle = (\\hat{a} + \\hat{a}^{\\dagger})|1\\rangle = \\hat{a}|1\\rangle + \\hat{a}^{\\dagger}|1\\rangle = |0\\rangle + \\sqrt{2}|2\\rangle\n$$\n$$\n(\\hat{a} + \\hat{a}^{\\dagger})^3|0\\rangle = (\\hat{a} + \\hat{a}^{\\dagger})(|0\\rangle + \\sqrt{2}|2\\rangle) = |1\\rangle + \\sqrt{2}(\\sqrt{2}|1\\rangle + \\sqrt{3}|3\\rangle) = 3|1\\rangle + \\sqrt{6}|3\\rangle\n$$\n$$\n(\\hat{a} + \\hat{a}^{\\dagger})^4|0\\rangle = (\\hat{a} + \\hat{a}^{\\dagger})(3|1\\rangle + \\sqrt{6}|3\\rangle) = 3(|0\\rangle + \\sqrt{2}|2\\rangle) + \\sqrt{6}(\\sqrt{3}|2\\rangle + \\sqrt{4}|4\\rangle) = 3|0\\rangle + (3\\sqrt{2}+\\sqrt{18})|2\\rangle + \\sqrt{24}|4\\rangle = 3|0\\rangle + 6\\sqrt{2}|2\\rangle + 2\\sqrt{6}|4\\rangle\n$$\nUsing the orthonormality of the eigenstates, $\\langle m|n\\rangle=\\delta_{mn}$, we take the inner product with $\\langle 0 |$:\n$$\n\\langle 0 | (\\hat{a} + \\hat{a}^{\\dagger})^4 | 0 \\rangle = \\langle 0 | (3|0\\rangle + 6\\sqrt{2}|2\\rangle + 2\\sqrt{6}|4\\rangle) = 3\\langle 0|0 \\rangle = 3\n$$\nThus, the first-order energy correction is:\n$$\nE_0^{(1)} = \\lambda \\left(\\frac{\\hbar}{2m\\omega}\\right)^2 \\cdot 3 = \\frac{3\\lambda\\hbar^2}{4m^2\\omega^2}\n$$\nNext, we compute the second-order correction $E_0^{(2)}$. The energy denominator is $E_0^{(0)} - E_k^{(0)} = \\frac{1}{2}\\hbar\\omega - (k+\\frac{1}{2})\\hbar\\omega = -k\\hbar\\omega$.\n$$\nE_0^{(2)} = \\lambda^2 \\sum_{k \\neq 0} \\frac{|\\langle k | \\hat{x}^4 | 0 \\rangle|^2}{-k\\hbar\\omega} = \\lambda^2 \\left(\\frac{\\hbar}{2m\\omega}\\right)^4 \\sum_{k \\neq 0} \\frac{|\\langle k | (\\hat{a} + \\hat{a}^{\\dagger})^4 | 0 \\rangle|^2}{-k\\hbar\\omega}\n$$\nThe justification for the selection rule is now explicit. From our calculation of $(\\hat{a} + \\hat{a}^{\\dagger})^4|0\\rangle = 3|0\\rangle + 6\\sqrt{2}|2\\rangle + 2\\sqrt{6}|4\\rangle$, it is clear that the matrix element $\\langle k | (\\hat{a} + \\hat{a}^{\\dagger})^4 | 0 \\rangle$ is non-zero only for $k=0$, $k=2$, and $k=4$. The sum for $E_0^{(2)}$ runs over $k \\neq 0$, so only the terms for $k=2$ and $k=4$ contribute.\n\nFor $k=2$:\n$$\n\\langle 2 | (\\hat{a} + \\hat{a}^{\\dagger})^4 | 0 \\rangle = \\langle 2 | (3|0\\rangle + 6\\sqrt{2}|2\\rangle + 2\\sqrt{6}|4\\rangle) = 6\\sqrt{2}\n$$\nThe contribution to $E_0^{(2)}$ from this term is:\n$$\n\\lambda^2 \\frac{|\\langle 2|\\hat{x}^4|0\\rangle|^2}{-2\\hbar\\omega} = \\lambda^2 \\frac{|\\left(\\frac{\\hbar}{2m\\omega}\\right)^2 \\cdot 6\\sqrt{2}|^2}{-2\\hbar\\omega} = \\frac{\\lambda^2}{-2\\hbar\\omega} \\left(\\frac{\\hbar^2}{4m^2\\omega^2}\\right)^2 (72) = -\\frac{9}{4}\\frac{\\lambda^2\\hbar^3}{m^4\\omega^5}\n$$\nFor $k=4$:\n$$\n\\langle 4 | (\\hat{a} + \\hat{a}^{\\dagger})^4 | 0 \\rangle = \\langle 4 | (3|0\\rangle + 6\\sqrt{2}|2\\rangle + 2\\sqrt{6}|4\\rangle) = 2\\sqrt{6}\n$$\nThe contribution to $E_0^{(2)}$ from this term is:\n$$\n\\lambda^2 \\frac{|\\langle 4|\\hat{x}^4|0\\rangle|^2}{-4\\hbar\\omega} = \\lambda^2 \\frac{|\\left(\\frac{\\hbar}{2m\\omega}\\right)^2 \\cdot 2\\sqrt{6}|^2}{-4\\hbar\\omega} = \\frac{\\lambda^2}{-4\\hbar\\omega} \\left(\\frac{\\hbar^2}{4m^2\\omega^2}\\right)^2 (24) = -\\frac{3}{8}\\frac{\\lambda^2\\hbar^3}{m^4\\omega^5}\n$$\nThe total second-order correction is the sum of these two contributions:\n$$\nE_0^{(2)} = -\\frac{9}{4}\\frac{\\lambda^2\\hbar^3}{m^4\\omega^5} - \\frac{3}{8}\\frac{\\lambda^2\\hbar^3}{m^4\\omega^5} = \\left(-\\frac{18}{8} - \\frac{3}{8}\\right)\\frac{\\lambda^2\\hbar^3}{m^4\\omega^5} = -\\frac{21\\lambda^2\\hbar^3}{8m^4\\omega^5}\n$$\nFinally, the ground-state energy up to second order in $\\lambda$ is obtained by summing the zeroth, first, and second-order terms:\n$$\nE_0 = E_0^{(0)} + E_0^{(1)} + E_0^{(2)} = \\frac{1}{2}\\hbar\\omega + \\frac{3\\lambda\\hbar^2}{4m^2\\omega^2} - \\frac{21\\lambda^2\\hbar^3}{8m^4\\omega^5}\n$$\nThis is the required closed-form expression.", "answer": "$$\n\\boxed{\\frac{1}{2}\\hbar\\omega + \\frac{3\\lambda\\hbar^2}{4m^2\\omega^2} - \\frac{21\\lambda^2\\hbar^3}{8m^4\\omega^5}}\n$$", "id": "2822957"}, {"introduction": "Solving the time-dependent Schrödinger equation (TDSE) analytically is only possible for a handful of simple systems, yet understanding quantum dynamics is essential for modeling chemical reactions and spectroscopy. This computational exercise guides you through building a numerical propagator from the ground up using the powerful split-operator Fourier method. This hands-on implementation will demonstrate how to simulate the evolution of a wavepacket in time, providing a tangible connection between the formal theory of time-evolution operators and the practical tools of modern computational chemistry [@problem_id:2822573].", "problem": "Implement a one-dimensional numerical propagator for the time-dependent Schrödinger equation based on a symmetric split-operator factorization for Hamiltonians of the form $H(t)=T+V(t)$, where $T=\\frac{\\hat{p}^{2}}{2m}$ and $V(t)=V(\\hat{x},t)$. Work entirely in dimensionless units such that $\\hbar=1$ and $m=1$. Angles in trigonometric functions must be in radians. The program must use a periodic spatial grid and the Discrete Fourier Transform to implement the kinetic energy operator in wavevector space. The spatial Fourier transform should be used in a normalization that makes it unitary on the discrete grid.\n\nStarting from the time-dependent Schrödinger equation $i\\,\\partial_{t}\\psi(t)=H(t)\\psi(t)$ and the definitions of $T$ and $V(t)$ above, implement a single-step propagator that uses midpoint sampling of the potential in time and a symmetric product of exponentials of $T$ and $V$ to approximate the time-ordered evolution from $t$ to $t+\\Delta t$. Then, analyze and verify the second-order accuracy in $\\Delta t$ of your implementation using a self-convergence study.\n\nThe numerical setting must be as follows.\n\n- Spatial grid and transforms:\n  - Use $N=1024$ equispaced grid points spanning an interval of length $L=200$ centered at $x=0$, that is, $x\\in[-L/2,L/2)$.\n  - Use the wavevector grid $k$ corresponding to the unitary discrete Fourier transform on this spatial grid.\n  - Use a unitary discrete Fourier transform so that the discrete $\\ell^{2}$ norm $\\|\\psi\\|_{h}^{2}=\\sum_{j=0}^{N-1}|\\psi_{j}|^{2}$ is preserved by the transform.\n\n- Initial state:\n  - Use a Gaussian wavepacket with center $x_{0}=-10$, width $\\sigma=1.0$, and mean wavevector $k_{0}=2.0$, namely\n    $$\\psi_{0}(x)=C\\exp\\!\\left(-\\frac{(x-x_{0})^{2}}{4\\sigma^{2}}+i\\,k_{0}(x-x_{0})\\right),$$\n    where $C$ is chosen to make the discrete norm equal to $1$.\n\n- Potentials:\n  - Driven harmonic trap (time-dependent): $$V_{\\mathrm{drv}}(x,t)=\\tfrac{1}{2}\\,\\omega^{2}x^{2}+E_{0}\\,x\\cos(\\Omega t),$$ with $\\omega=0.2$, $E_{0}=0.1$, and $\\Omega=1.0$.\n  - Free particle: $$V_{\\mathrm{free}}(x,t)=0.$$\n  - Static harmonic trap (time-independent): $$V_{\\mathrm{ho}}(x,t)=\\tfrac{1}{2}\\,\\omega^{2}x^{2},$$ with $\\omega=0.2$.\n\n- Time stepping and tests:\n  - All propagations must use a symmetric split-operator with midpoint sampling in time for the potential and the exact kinetic phase in $k$-space.\n  - Self-convergence order test for the driven trap:\n    - Final time $T=0.512$.\n    - Use three step sizes $\\Delta t_{1}=0.008$, $\\Delta t_{2}=0.004$, and $\\Delta t_{3}=0.002$ so that each divides $T$ exactly.\n    - Compute the final states $\\psi^{(1)}$, $\\psi^{(2)}$, and $\\psi^{(3)}$ using $\\Delta t_{1}$, $\\Delta t_{2}$, and $\\Delta t_{3}$, respectively.\n    - Estimate the observed order $p_{\\mathrm{drv}}$ by the refinement relation\n      $$p_{\\mathrm{drv}}=\\log_{2}\\left(\\frac{\\|\\psi^{(1)}-\\psi^{(2)}\\|_{h}}{\\|\\psi^{(2)}-\\psi^{(3)}\\|_{h}}\\right),$$\n      where $\\|\\cdot\\|_{h}$ is the discrete $\\ell^{2}$ norm defined above.\n  - Exactness check for the free particle:\n    - Final time $T=1.0$ and step $\\Delta t=0.01$.\n    - Evolve with the split-operator and compare to applying in a single step the exact kinetic phase $e^{-i\\,k^{2}T/2}$ in $k$-space.\n    - Return a boolean flag $b_{\\mathrm{free}}$ that is true if the discrete norm of the difference between the two final states is less than $5\\times 10^{-12}$.\n  - Self-convergence order test for the static harmonic trap:\n    - Final time $T=0.512$.\n    - Use the same three step sizes $\\Delta t_{1}=0.008$, $\\Delta t_{2}=0.004$, and $\\Delta t_{3}=0.002$.\n    - Compute the observed order $p_{\\mathrm{ho}}$ analogously to the driven case.\n  - Discrete unitarity preservation check:\n    - Use the driven harmonic trap $V_{\\mathrm{drv}}(x,t)$, final time $T=1.0$, and step $\\Delta t=0.05$.\n    - Record the discrete norm $\\|\\psi^{n}\\|_{h}^{2}$ after each step $n$.\n    - Return a boolean flag $b_{\\mathrm{uni}}$ that is true if the maximum absolute deviation of $\\|\\psi^{n}\\|_{h}^{2}$ from $1$ over all steps is less than $5\\times 10^{-12}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the exact order $[p_{\\mathrm{drv}}, b_{\\mathrm{free}}, p_{\\mathrm{ho}}, b_{\\mathrm{uni}}]$. The two real numbers $p_{\\mathrm{drv}}$ and $p_{\\mathrm{ho}}$ must be rounded to three decimal places; the booleans must be printed as language-native boolean literals. No other text should be printed. The computation is dimensionless; no physical units are to be reported in the output. All trigonometric angles are in radians.", "solution": "The problem statement has been critically evaluated and is determined to be valid. It is scientifically grounded in the principles of quantum mechanics and numerical analysis, is well-posed with a complete and consistent set of parameters, and is expressed in objective, formal language. We may therefore proceed with the solution.\n\nThe problem requires the implementation and verification of a numerical propagator for the one-dimensional time-dependent Schrödinger equation (TDSE):\n$$ i\\hbar \\frac{\\partial}{\\partial t} \\psi(x,t) = H(t) \\psi(x,t) $$\nThe problem is set in dimensionless units where $\\hbar=1$ and the particle mass $m=1$. The Hamiltonian $H(t)$ is given in the form $H(t) = T + V(t)$, where $T = \\frac{\\hat{p}^2}{2m} = \\frac{\\hat{p}^2}{2}$ is the kinetic energy operator and $V(t) = V(\\hat{x}, t)$ is a time-dependent potential energy operator.\n\nThe formal solution to the TDSE over a time interval from $t$ to $t+\\Delta t$ is given by\n$$ \\psi(t+\\Delta t) = U(t+\\Delta t, t) \\psi(t) $$\nwhere $U(t+\\Delta t, t)$ is the time-evolution operator, which is a time-ordered exponential:\n$$ U(t+\\Delta t, t) = \\mathcal{T} \\exp\\left(-i \\int_t^{t+\\Delta t} H(\\tau) \\,d\\tau\\right) $$\nIn general, the kinetic and potential energy operators do not commute, i.e., $[T, V] \\neq 0$. This non-commutativity prevents a simple decomposition of the exponential of the sum into a product of exponentials. Numerical methods are required to approximate the action of $U$.\n\nThe problem specifies the use of a symmetric split-operator factorization, a second-order Trotter-Suzuki decomposition. For a time-dependent potential, we approximate the integral of the potential over the time step $\\Delta t$ using the midpoint rule: $\\int_t^{t+\\Delta t} V(\\tau) d\\tau \\approx V(t+\\Delta t/2) \\Delta t$. The single-step propagator is then approximated as:\n$$ U_{\\text{step}}(t, \\Delta t) \\approx e^{-i T \\Delta t / 2} e^{-i V(t+\\Delta t/2) \\Delta t} e^{-i T \\Delta t / 2} $$\nThe error for a single step using this symmetric splitting is of order $\\mathcal{O}(\\Delta t^3)$, leading to a global error of order $\\mathcal{O}(\\Delta t^2)$ after propagating over a finite time interval, making the method second-order accurate in time.\n\nThe numerical implementation of this propagator is performed on a discrete spatial grid using the split-step Fourier method. This method leverages the fact that the kinetic energy operator $T$ is diagonal in the momentum (wavevector) representation, while the potential energy operator $V$ is diagonal in the position representation. The Fourier transform is used to switch between these two representations.\n1.  The spatial domain $x \\in [-L/2, L/2)$ is discretized into $N=1024$ points $x_j = -L/2 + j \\cdot \\Delta x$ for $j=0, \\dots, N-1$, where $\\Delta x = L/N$. Here, $L=200$.\n2.  The corresponding wavevector grid $k_n$ is obtained via the discrete Fourier transform relationship. For a grid spacing $\\Delta x$, the wavevectors are given by $k_n=2\\pi f_n$, where $f_n$ are the frequencies provided by standard FFT libraries.\n3.  The action of the potential operator $e^{-i V(x_j, t+\\Delta t/2) \\Delta t}$ is a simple element-wise multiplication on the wavefunction array $\\psi_j$ in position space.\n4.  The action of the kinetic operator $e^{-i T \\Delta t/2}$ is implemented in wavevector space. After a Fourier transform $\\psi(x) \\to \\tilde{\\psi}(k)$, the operator $\\hat{p}$ becomes multiplication by $k$, so $T = \\hat{p}^2/2$ becomes $k^2/2$. The action is an element-wise multiplication by $e^{-i (k_n^2/2) \\Delta t/2}$ on the transformed wavefunction array $\\tilde{\\psi}_n$.\n5.  To preserve the norm of the wavefunction (total probability), the discrete Fourier transform must be unitary. This is achieved by appropriate normalization of the forward and inverse transforms.\n\nThe algorithm for a single propagation step from time $t$ to $t+\\Delta t$ on a state $\\psi(x,t)$ is as follows:\na.  Calculate the kinetic phase factor for a half-step: $P_K = \\exp(-i (k^2/2) (\\Delta t/2))$.\nb.  Transform the state to wavevector space: $\\tilde{\\psi} = \\mathcal{F}[\\psi]$, where $\\mathcal{F}$ is the unitary discrete Fourier transform.\nc.  Apply the first kinetic half-step: $\\tilde{\\psi}' = P_K \\odot \\tilde{\\psi}$ (element-wise product).\nd.  Transform back to position space: $\\psi' = \\mathcal{F}^{-1}[\\tilde{\\psi}']$.\ne.  Calculate the potential at the midpoint time $t+\\Delta t/2$ on the spatial grid: $V_{mid} = V(x, t+\\Delta t/2)$.\nf.  Calculate the potential phase factor: $P_V = \\exp(-i V_{mid} \\Delta t)$.\ng.  Apply the full potential step: $\\psi'' = P_V \\odot \\psi'$.\nh.  Transform to wavevector space: $\\tilde{\\psi}'' = \\mathcal{F}[\\psi'']$.\ni.  Apply the second kinetic half-step: $\\tilde{\\psi}''' = P_K \\odot \\tilde{\\psi}''$.\nj.  Transform back to position space to obtain the final state: $\\psi(x, t+\\Delta t) = \\mathcal{F}^{-1}[\\tilde{\\psi}''']$.\n\nThis step-by-step procedure is used to implement a reusable function for a single time step. The full evolution from $t=0$ to $t=T$ is achieved by repeatedly applying this single-step propagator. The verification tests are then performed as specified:\n-   **Self-convergence tests ($p_{\\mathrm{drv}}$, $p_{\\mathrm{ho}}$)**: The order of convergence $p$ is estimated using three simulations with decreasing step sizes $\\Delta t_1$, $\\Delta t_2 = \\Delta t_1/2$, and $\\Delta t_3 = \\Delta t_2/2$. The error is estimated by comparing the resulting final states. The observed order is calculated as $p = \\log_2(\\|\\psi^{(1)}-\\psi^{(2)}\\|_h / \\|\\psi^{(2)}-\\psi^{(3)}\\|_h)$. For a second-order method, we expect $p \\approx 2$. This test confirms the temporal accuracy of the implementation.\n-   **Free particle exactness test ($b_{\\mathrm{free}}$)**: For a free particle ($V=0$), the split-operator propagator becomes exact: $U_{\\text{step}} = e^{-iT\\Delta t/2} e^0 e^{-iT\\Delta t/2} = e^{-iT\\Delta t}$. A sequence of steps results in $e^{-iT T_{final}}$. This result must be identical, up to machine precision, to applying the exact free-particle propagator for the total time $T_{final}$ in a single step. This test verifies the correct implementation of the kinetic propagation.\n-   **Unitarity preservation test ($b_{\\mathrm{uni}}$)**: The exact Schrödinger evolution is unitary, meaning it conserves the total probability, $\\|\\psi\\|_h^2$. The numerical propagator, being a product of unitary operators (when using unitary FFTs), must also be unitary. This test verifies that the norm of the wavefunction remains constant throughout the simulation, confirming that the numerical scheme does not artificially create or destroy probability.\n\nThe initial state is a normalized Gaussian wavepacket given by $\\psi_{0}(x)=C\\exp (-(x-x_{0})^{2}/(4\\sigma^{2})+i\\,k_{0}(x-x_{0}) )$. The constant $C$ is chosen such that the discrete $\\ell^2$ norm, $\\|\\psi_0\\|_h^2 = \\sum_{j=0}^{N-1}|\\psi_{0,j}|^2$, is equal to $1$. All calculations are performed according to the parameters specified in the problem statement.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and verifies a split-operator propagator for the 1D time-dependent Schrödinger equation.\n    \"\"\"\n\n    # --- 1. Define constants and grid parameters ---\n    N = 1024\n    L = 200.0\n    m = 1.0\n    hbar = 1.0 # Implicit in formulation, but useful for clarity\n\n    # Spatial grid\n    dx = L / N\n    x = np.arange(N) * dx - L / 2\n\n    # Wavevector grid (uses unitary FFT convention)\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # Initial wavepacket parameters\n    x0 = -10.0\n    sigma = 1.0\n    k0 = 2.0\n\n    # Potential parameters\n    omega = 0.2\n    E0 = 0.1\n    Omega = 1.0\n\n    # --- 2. Define potentials and initial state ---\n    def V_drv(x_grid, t):\n        return 0.5 * (omega**2) * (x_grid**2) + E0 * x_grid * np.cos(Omega * t)\n\n    def V_free(x_grid, t):\n        return np.zeros_like(x_grid)\n\n    def V_ho(x_grid, t):\n        return 0.5 * (omega**2) * (x_grid**2)\n    \n    # Create and normalize initial state\n    psi0_unnormalized = np.exp(-(x - x0)**2 / (4 * sigma**2) + 1j * k0 * (x - x0))\n    norm_sq = np.sum(np.abs(psi0_unnormalized)**2)\n    psi0 = psi0_unnormalized / np.sqrt(norm_sq)\n\n    # --- 3. Define propagation functions ---\n    \n    def propagate_one_step(psi_in, t, dt, potential_func):\n        \"\"\"Propagates the wavefunction by one time step dt.\"\"\"\n        \n        # Kinetic propagator for a half step\n        kinetic_propagator_half = np.exp(-1j * (k**2 / (2 * m)) * dt / 2.0)\n        \n        # 1. First kinetic half-step\n        psi_k = np.fft.fft(psi_in, norm='ortho')\n        psi_k = kinetic_propagator_half * psi_k\n        psi_x = np.fft.ifft(psi_k, norm='ortho')\n        \n        # 2. Full potential step at midpoint time\n        t_mid = t + dt / 2.0\n        V_mid = potential_func(x, t_mid)\n        potential_propagator = np.exp(-1j * V_mid * dt)\n        psi_x = potential_propagator * psi_x\n        \n        # 3. Second kinetic half-step\n        psi_k = np.fft.fft(psi_x, norm='ortho')\n        psi_k = kinetic_propagator_half * psi_k\n        psi_out = np.fft.ifft(psi_k, norm='ortho')\n        \n        return psi_out\n\n    def full_propagation(psi_start, T_final, dt, potential_func):\n        \"\"\"Performs a full propagation from t=0 to T_final.\"\"\"\n        num_steps = int(round(T_final / dt))\n        psi_current = psi_start.copy()\n        t_current = 0.0\n        for _ in range(num_steps):\n            psi_current = propagate_one_step(psi_current, t_current, dt, potential_func)\n            t_current += dt\n        return psi_current\n\n    # --- 4. Perform verification tests ---\n\n    # Test 1: Self-convergence for driven trap\n    T_conv = 0.512\n    dt_vals_conv = [0.008, 0.004, 0.002]\n    psi_final_drv = [full_propagation(psi0, T_conv, dt, V_drv) for dt in dt_vals_conv]\n    \n    err_12_drv = np.linalg.norm(psi_final_drv[0] - psi_final_drv[1])\n    err_23_drv = np.linalg.norm(psi_final_drv[1] - psi_final_drv[2])\n    p_drv = np.log2(err_12_drv / err_23_drv) if err_23_drv > 0 else 0.0\n\n    # Test 2: Exactness for free particle\n    T_free = 1.0\n    dt_free = 0.01\n    psi_split_free = full_propagation(psi0, T_free, dt_free, V_free)\n    \n    # Exact single-step evolution\n    psi0_k = np.fft.fft(psi0, norm='ortho')\n    exact_kinetic_prop = np.exp(-1j * (k**2 / (2 * m)) * T_free)\n    psi_exact_free_k = exact_kinetic_prop * psi0_k\n    psi_exact_free = np.fft.ifft(psi_exact_free_k, norm='ortho')\n    \n    err_free = np.linalg.norm(psi_split_free - psi_exact_free)\n    b_free = err_free  5e-12\n\n    # Test 3: Self-convergence for static harmonic trap\n    psi_final_ho = [full_propagation(psi0, T_conv, dt, V_ho) for dt in dt_vals_conv]\n    \n    err_12_ho = np.linalg.norm(psi_final_ho[0] - psi_final_ho[1])\n    err_23_ho = np.linalg.norm(psi_final_ho[1] - psi_final_ho[2])\n    p_ho = np.log2(err_12_ho / err_23_ho) if err_23_ho > 0 else 0.0\n\n    # Test 4: Unitarity preservation check\n    T_uni = 1.0\n    dt_uni = 0.05\n    num_steps_uni = int(round(T_uni / dt_uni))\n    psi_current = psi0.copy()\n    t_current = 0.0\n    norms_sq = []\n    \n    for _ in range(num_steps_uni):\n        psi_current = propagate_one_step(psi_current, t_current, dt_uni, V_drv)\n        t_current += dt_uni\n        norms_sq.append(np.sum(np.abs(psi_current)**2))\n    \n    max_dev = np.max(np.abs(np.array(norms_sq) - 1.0))\n    b_uni = max_dev  5e-12\n\n    # --- 5. Format and print results ---\n    results_list = [\n        f\"{p_drv:.3f}\",\n        str(b_free),\n        f\"{p_ho:.3f}\",\n        str(b_uni)\n    ]\n    print(f\"[{','.join(results_list)}]\")\n\n# Execute the solution\nsolve()\n\n```", "id": "2822573"}, {"introduction": "The physical predictions of quantum mechanics, such as real energy eigenvalues and conserved probability, rely on the Hamiltonian operator having a specific mathematical property: self-adjointness. This property is not automatic and depends critically on the boundary conditions imposed on the wavefunction. This practice challenges you to explore the mathematical foundations of the classic \"particle in a box\" problem, justifying why the familiar Dirichlet conditions ($\\psi=0$) are physically selected from a broader family of mathematically permissible self-adjoint extensions [@problem_id:2681149].", "problem": "A nonrelativistic particle of mass $m$ is confined to the one-dimensional ($1$D) interval $[0,L]$ by an infinite potential outside $[0,L]$. Inside the interval, the Hamiltonian is given formally by the differential expression $\\hat H = -\\dfrac{\\hbar^2}{2m}\\dfrac{d^2}{dx^2}$. In the Hilbert space $L^2(0,L)$ with inner product $\\langle \\psi,\\phi\\rangle = \\int_0^L \\psi(x)^{\\ast}\\,\\phi(x)\\,dx$, self-adjointness of $\\hat H$ is required to guarantee unitary time evolution under the time-dependent Schrödinger equation and a real spectrum for the time-independent Schrödinger equation. A linear differential operator is self-adjoint if it is symmetric (Hermitian) and its domain equals the domain of its adjoint. Probability conservation for the time-dependent Schrödinger equation implies a continuity equation with a probability current density $j(x,t)$, and an infinite barrier should enforce no net probability flow across the boundaries.\n\nWhich of the following statements about boundary conditions on the wavefunction $\\psi$ at $x=0$ and $x=L$ are correct in this setting?\n\nA. The operator $\\hat H$ is self-adjoint only if $\\psi(0)=\\psi(L)=0$ (Dirichlet boundary conditions).\n\nB. The operator $\\hat H$ admits a $\\mathrm{U}(2)$ family of self-adjoint realizations on $[0,L]$, parameterizing all linear boundary conditions that make the boundary form vanish; Dirichlet, Neumann, Robin, periodic or quasi-periodic, and certain mixed conditions are all special cases within this family.\n\nC. For the infinite-well potential (zero in $(0,L)$ and infinite outside), the physically selected boundary condition is $\\psi(0)=\\psi(L)=0$ because the wavefunction must vanish where the potential is infinite, which in turn enforces zero probability current across the walls.\n\nD. The periodic boundary conditions $\\psi(0)=\\psi(L)$ and $\\psi'(0)=\\psi'(L)$ define a self-adjoint realization of $\\hat H$ on $[0,L]$, but such a choice corresponds physically to a particle on a ring rather than to an infinite well.\n\nE. The Neumann boundary conditions $\\psi'(0)=\\psi'(L)=0$ do not produce a self-adjoint operator and must be discarded even as a mathematical idealization.\n\nF. The mixed separated boundary conditions $\\psi(0)=0$ and $\\psi'(L)=0$ produce a self-adjoint operator.\n\nSelect all that apply.", "solution": "The problem statement is a valid inquiry into the mathematical and physical aspects of defining the quantum mechanical Hamiltonian for a particle on a finite interval. It is well-posed and scientifically sound.\n\nThe core of the problem lies in the distinction between a formal differential expression and a well-defined self-adjoint operator in a Hilbert space. For the Hamiltonian $\\hat{H} = -\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}$ to be a self-adjoint operator on the Hilbert space $L^2(0,L)$, its domain $D(\\hat{H})$ must be specified. The domain consists of a subset of functions in $L^2(0,L)$ that satisfy certain boundary conditions at $x=0$ and $x=L$.\n\nAn operator $\\hat{A}$ is symmetric (or Hermitian) if for any two functions $\\psi, \\phi$ in its domain $D(\\hat{A})$, the equality $\\langle \\psi, \\hat{A}\\phi \\rangle = \\langle \\hat{A}\\psi, \\phi \\rangle$ holds.\nFor the given Hamiltonian, we use integration by parts twice:\n$$ \\langle \\psi, \\hat{H}\\phi \\rangle = \\int_0^L \\psi^*(x) \\left(-\\frac{\\hbar^2}{2m}\\frac{d^2\\phi(x)}{dx^2}\\right) dx $$\n$$ = -\\frac{\\hbar^2}{2m} \\left[ \\psi^*(x)\\phi'(x) \\right]_0^L + \\frac{\\hbar^2}{2m} \\int_0^L (\\psi^*)'(x)\\phi'(x) dx $$\n$$ = -\\frac{\\hbar^2}{2m} \\left[ \\psi^*(x)\\phi'(x) - (\\psi^*)'(x)\\phi(x) \\right]_0^L + \\int_0^L \\left(-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi^*(x)}{dx^2}\\right)\\phi(x) dx $$\n$$ = \\langle \\hat{H}\\psi, \\phi \\rangle - \\frac{\\hbar^2}{2m} \\left[ \\psi^*(x)\\phi'(x) - (\\psi^*)'(x)\\phi(x) \\right]_0^L $$\nThe symmetry condition requires the boundary term, also known as the boundary form, to vanish for all $\\psi, \\phi \\in D(\\hat{H})$:\n$$ B(\\psi, \\phi) = \\left[ \\psi^*(x)\\phi'(x) - (\\psi^*)'(x)\\phi(x) \\right]_0^L = 0 $$\nAn operator is self-adjoint if it is symmetric and its domain is equal to the domain of its adjoint, $D(\\hat{H}) = D(\\hat{H}^\\dagger)$. The domain of the adjoint, $D(\\hat{H}^\\dagger)$, is the set of functions $\\phi$ for which the relation $\\langle \\phi, \\hat{H}\\psi \\rangle = \\langle \\hat{H}^\\dagger\\phi, \\psi \\rangle$ holds for all $\\psi \\in D(\\hat{H})$. This condition, $D(\\hat{H}) = D(\\hat{H}^\\dagger)$, stringently restricts the allowed boundary conditions.\n\nWe now evaluate each statement.\n\n**A. The operator $\\hat H$ is self-adjoint only if $\\psi(0)=\\psi(L)=0$ (Dirichlet boundary conditions).**\nWith Dirichlet boundary conditions, $\\psi(0)=0$ and $\\psi(L)=0$ for all functions in the domain. The boundary form becomes:\n$$ B(\\psi, \\phi) = (\\psi^*(L)\\phi'(L) - (\\psi^*)'(L)\\phi(L)) - (\\psi^*(0)\\phi'(0) - (\\psi^*)'(0)\\phi(0)) = (0-0) - (0-0) = 0 $$\nThe operator is symmetric. It is a standard result that this choice of domain leads to a self-adjoint operator. However, the statement claims this is the *only* way. As we will see in the analysis of other options (e.g., D, F), other self-adjoint boundary conditions exist. Therefore, the word \"only\" makes the statement false.\n**Verdict: Incorrect.**\n\n**B. The operator $\\hat H$ admits a $\\mathrm{U}(2)$ family of self-adjoint realizations on $[0,L]$, parameterizing all linear boundary conditions that make the boundary form vanish; Dirichlet, Neumann, Robin, periodic or quasi-periodic, and certain mixed conditions are all special cases within this family.**\nThis statement is a precise summary of the von Neumann theory of self-adjoint extensions as applied to the operator $-\\frac{d^2}{dx^2}$ on a finite interval. The minimal symmetric operator (defined on functions that vanish along with their derivatives at the boundary) has deficiency indices $(2,2)$. This implies that its self-adjoint extensions are in one-to-one correspondence with the elements of the unitary group $\\mathrm{U}(2)$. This family of extensions precisely comprises all the possible boundary conditions that result in a self-adjoint Hamiltonian. The listed examples are all valid members of this family.\n**Verdict: Correct.**\n\n**C. For the infinite-well potential (zero in $(0,L)$ and infinite outside), the physically selected boundary condition is $\\psi(0)=\\psi(L)=0$ because the wavefunction must vanish where the potential is infinite, which in turn enforces zero probability current across the walls.**\nThis statement addresses the physical interpretation of the \"particle in a box\" model. If the potential $V(x)$ is infinite for $x \\notin [0,L]$, the Schrödinger equation can only be satisfied if the wavefunction $\\psi(x) = 0$ in those regions. A physically reasonable wavefunction must be continuous. This forces the wavefunction to be zero at the boundaries of the interval: $\\psi(0) = \\psi(L) = 0$. This is the physical justification for selecting the Dirichlet boundary conditions out of the many mathematically possible self-adjoint extensions. Furthermore, the probability current density is $j(x,t) = \\frac{\\hbar}{2mi}(\\psi^*\\frac{\\partial\\psi}{\\partial x} - \\psi\\frac{\\partial\\psi^*}{\\partial x})$. If $\\psi=0$ at a point, then $j=0$ at that point. Thus, $\\psi(0)=\\psi(L)=0$ ensures zero current flow into or out of the box, $j(0)=j(L)=0$, consistent with confinement by infinite walls. The reasoning is sound.\n**Verdict: Correct.**\n\n**D. The periodic boundary conditions $\\psi(0)=\\psi(L)$ and $\\psi'(0)=\\psi'(L)$ define a self-adjoint realization of $\\hat H$ on $[0,L]$, but such a choice corresponds physically to a particle on a ring rather than to an infinite well.**\nLet's check the boundary form for any two functions $\\psi, \\phi$ satisfying these conditions:\n$$ B(\\psi, \\phi) = (\\psi^*(L)\\phi'(L) - (\\psi^*)'(L)\\phi(L)) - (\\psi^*(0)\\phi'(0) - (\\psi^*)'(0)\\phi(0)) $$\nUsing $\\psi(L)=\\psi(0)$, $\\psi'(L)=\\psi'(0)$, etc., the first parenthesis equals the second.\n$$ B(\\psi, \\phi) = (\\psi^*(0)\\phi'(0) - (\\psi^*)'(0)\\phi(0)) - (\\psi^*(0)\\phi'(0) - (\\psi^*)'(0)\\phi(0)) = 0 $$\nThese conditions define a self-adjoint operator. Physically, identifying the properties of the wavefunction at $x=0$ with those at $x=L$ is equivalent to considering the interval $[0,L]$ as a circle of circumference $L$. This is distinct from a particle confined between two separate walls. The statement is entirely correct, both mathematically and in its physical interpretation.\n**Verdict: Correct.**\n\n**E. The Neumann boundary conditions $\\psi'(0)=\\psi'(L)=0$ do not produce a self-adjoint operator and must be discarded even as a mathematical idealization.**\nLet us test the boundary form for the domain where $\\psi'(0)=\\psi'(L)=0$:\n$$ B(\\psi, \\phi) = (\\psi^*(L)\\phi'(L) - (\\psi^*)'(L)\\phi(L)) - (\\psi^*(0)\\phi'(0) - (\\psi^*)'(0)\\phi(0)) $$\n$$ = (\\psi^*(L)\\cdot 0 - 0 \\cdot \\phi(L)) - (\\psi^*(0)\\cdot 0 - 0 \\cdot \\phi(0)) = 0-0 = 0 $$\nThe Neumann boundary conditions define a perfectly valid symmetric operator. A full analysis shows $D(\\hat{H})=D(\\hat{H}^\\dagger)$, confirming it is self-adjoint. The statement that it is not self-adjoint is false.\n**Verdict: Incorrect.**\n\n**F. The mixed separated boundary conditions $\\psi(0)=0$ and $\\psi'(L)=0$ produce a self-adjoint operator.**\nThese are a form of separated boundary conditions, where one condition is imposed at $x=0$ and another at $x=L$. To rigorously check for self-adjointness, we find the domain of the adjoint, $D(\\hat{H}^\\dagger)$. $D(\\hat{H}^\\dagger)$ is the set of functions $\\phi$ for which the boundary form $B(\\phi, \\psi)=0$ for all $\\psi \\in D(\\hat{H})$.\nHere $D(\\hat{H}) = \\{\\psi \\in H^2(0,L) \\mid \\psi(0)=0, \\psi'(L)=0\\}$.\n$$ B(\\phi, \\psi) = (\\phi^*(L)\\psi'(L) - \\phi^{*'}(L)\\psi(L)) - (\\phi^*(0)\\psi'(0) - \\phi^{*'}(0)\\psi(0)) $$\nSubstituting the conditions on $\\psi$:\n$$ B(\\phi, \\psi) = (\\phi^*(L)\\cdot 0 - \\phi^{*'}(L)\\psi(L)) - (\\phi^*(0)\\psi'(0) - \\phi^{*'}(0)\\cdot 0) = -\\phi^{*'}(L)\\psi(L) - \\phi^*(0)\\psi'(0) $$\nFor this to be zero for all $\\psi \\in D(\\hat{H})$, where $\\psi(L)$ and $\\psi'(0)$ can be chosen independently, their coefficients must be zero. This requires $\\phi^{*'}(L)=0$ and $\\phi^*(0)=0$, which implies $\\phi'(L)=0$ and $\\phi(0)=0$.\nThe domain of the adjoint is thus $D(\\hat{H}^\\dagger) = \\{\\phi \\in H^2(0,L) \\mid \\phi(0)=0, \\phi'(L)=0\\}$.\nSince $D(\\hat{H}) = D(\\hat{H}^\\dagger)$, the operator is self-adjoint. The statement is correct.\n**Verdict: Correct.**", "answer": "$$\\boxed{BCDF}$$", "id": "2681149"}]}