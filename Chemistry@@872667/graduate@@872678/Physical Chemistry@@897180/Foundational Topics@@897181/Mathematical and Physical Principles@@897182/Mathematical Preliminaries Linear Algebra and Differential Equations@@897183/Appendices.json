{"hands_on_practices": [{"introduction": "In quantum mechanics and variational methods, it is common to approximate complex functions by expanding them in a basis of simpler functions. To ensure that the expansion coefficients and relevant matrix elements are easy to calculate, this basis should be orthonormal. This exercise provides fundamental practice with the Gram-Schmidt process, a core linear algebra algorithm for converting any linearly independent set of functions into an orthonormal one, which is a crucial first step in many theoretical chemistry problems [@problem_id:2648934].", "problem": "In many variational approximations in physical chemistry, one expands a trial function in a low-degree polynomial basis that is orthonormal on a finite interval. Consider the space $L^{2}([-1,1])$ of square-integrable functions on $[-1,1]$ equipped with the weighted inner product\n$$\\langle f,g\\rangle=\\int_{-1}^{1} f(x)\\,g(x)\\,w(x)\\,dx,$$\nwith weight $w(x)=1$. Starting from the ordered set $\\{1,x,x^{2}\\}$, apply the Gram–Schmidt orthonormalization procedure (using this inner product) to construct an orthonormal basis $\\{\\varphi_{0}(x),\\varphi_{1}(x),\\varphi_{2}(x)\\}$. Then, identify each $\\varphi_{n}(x)$ with the corresponding normalized Legendre polynomial on $[-1,1]$ for $n=0,1,2$.\n\nProvide the final orthonormal basis explicitly as three closed-form expressions in $x$, in increasing degree order. Your final answer must be a single row matrix containing these three expressions. No rounding is required.", "solution": "The problem as stated is valid. It is a standard, well-posed exercise in applying the Gram-Schmidt orthonormalization procedure to a set of basis functions in a function space, a fundamental technique in physical chemistry and quantum mechanics. All necessary components—the initial set of functions, the interval, and the definition of the inner product—are provided and are mathematically and scientifically sound. We shall proceed with the solution.\n\nLet the initial, linearly independent set of functions be denoted as $\\{v_{0}(x), v_{1}(x), v_{2}(x)\\}$, where $v_{0}(x) = 1$, $v_{1}(x) = x$, and $v_{2}(x) = x^{2}$. The inner product on the space $L^{2}([-1,1])$ is given by $\\langle f, g \\rangle = \\int_{-1}^{1} f(x)g(x)dx$, as the weight function is $w(x) = 1$. The Gram-Schmidt procedure generates an orthogonal basis $\\{u_{0}(x), u_{1}(x), u_{2}(x)\\}$ which is then normalized to produce the orthonormal basis $\\{\\varphi_{0}(x), \\varphi_{1}(x), \\varphi_{2}(x)\\}$, where $\\varphi_{n}(x) = \\frac{u_{n}(x)}{\\|u_{n}(x)\\|}$ and $\\|f(x)\\| = \\sqrt{\\langle f, f \\rangle}$.\n\nStep 1: Construct $\\varphi_{0}(x)$.\nThe first orthogonal function is $u_{0}(x) = v_{0}(x) = 1$.\nWe calculate its norm squared:\n$$ \\|u_{0}(x)\\|^{2} = \\langle 1, 1 \\rangle = \\int_{-1}^{1} (1)(1) \\, dx = [x]_{-1}^{1} = 1 - (-1) = 2. $$\nThe norm is $\\|u_{0}(x)\\| = \\sqrt{2}$.\nThe first orthonormal function is:\n$$ \\varphi_{0}(x) = \\frac{u_{0}(x)}{\\|u_{0}(x)\\|} = \\frac{1}{\\sqrt{2}}. $$\nThis corresponds to the normalized Legendre polynomial of degree $0$, as $P_{0}(x) = 1$ and the normalization constant on $[-1,1]$ is $\\sqrt{\\frac{2(0)+1}{2}} = \\frac{1}{\\sqrt{2}}$.\n\nStep 2: Construct $\\varphi_{1}(x)$.\nThe second orthogonal function $u_{1}(x)$ is found by subtracting the projection of $v_{1}(x)$ onto $u_{0}(x)$:\n$$ u_{1}(x) = v_{1}(x) - \\frac{\\langle v_{1}, u_{0} \\rangle}{\\|u_{0}\\|^{2}} u_{0}(x). $$\nFirst, compute the inner product $\\langle v_{1}, u_{0} \\rangle$:\n$$ \\langle v_{1}, u_{0} \\rangle = \\langle x, 1 \\rangle = \\int_{-1}^{1} x \\cdot 1 \\, dx = \\left[\\frac{x^{2}}{2}\\right]_{-1}^{1} = \\frac{1^{2}}{2} - \\frac{(-1)^{2}}{2} = 0. $$\nSince the inner product is $0$, the functions $v_{1}(x)=x$ and $u_{0}(x)=1$ are already orthogonal. Thus,\n$$ u_{1}(x) = v_{1}(x) = x. $$\nNow, we calculate the norm squared of $u_{1}(x)$:\n$$ \\|u_{1}(x)\\|^{2} = \\langle x, x \\rangle = \\int_{-1}^{1} x^{2} \\, dx = \\left[\\frac{x^{3}}{3}\\right]_{-1}^{1} = \\frac{1^{3}}{3} - \\frac{(-1)^{3}}{3} = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}. $$\nThe norm is $\\|u_{1}(x)\\| = \\sqrt{\\frac{2}{3}}$.\nThe second orthonormal function is:\n$$ \\varphi_{1}(x) = \\frac{u_{1}(x)}{\\|u_{1}(x)\\|} = \\frac{x}{\\sqrt{2/3}} = \\sqrt{\\frac{3}{2}}x. $$\nThis corresponds to the normalized Legendre polynomial of degree $1$, as $P_{1}(x) = x$ and the normalization constant is $\\sqrt{\\frac{2(1)+1}{2}} = \\sqrt{\\frac{3}{2}}$.\n\nStep 3: Construct $\\varphi_{2}(x)$.\nThe third orthogonal function, $u_{2}(x)$, is found by subtracting the projections of $v_{2}(x)$ onto $u_{0}(x)$ and $u_{1}(x)$:\n$$ u_{2}(x) = v_{2}(x) - \\frac{\\langle v_{2}, u_{0} \\rangle}{\\|u_{0}\\|^{2}} u_{0}(x) - \\frac{\\langle v_{2}, u_{1} \\rangle}{\\|u_{1}\\|^{2}} u_{1}(x). $$\nWe compute the required inner products:\n$$ \\langle v_{2}, u_{0} \\rangle = \\langle x^{2}, 1 \\rangle = \\int_{-1}^{1} x^{2} \\, dx = \\left[\\frac{x^{3}}{3}\\right]_{-1}^{1} = \\frac{2}{3}. $$\n$$ \\langle v_{2}, u_{1} \\rangle = \\langle x^{2}, x \\rangle = \\int_{-1}^{1} x^{3} \\, dx = \\left[\\frac{x^{4}}{4}\\right]_{-1}^{1} = 0. $$\nSubstituting the known values $\\|u_{0}\\|^{2}=2$ and $\\|u_{1}\\|^{2}=2/3$:\n$$ u_{2}(x) = x^{2} - \\frac{2/3}{2}(1) - \\frac{0}{2/3}(x) = x^{2} - \\frac{1}{3}. $$\nNext, we calculate the norm squared of $u_{2}(x)$:\n$$ \\|u_{2}(x)\\|^{2} = \\left\\langle x^{2} - \\frac{1}{3}, x^{2} - \\frac{1}{3} \\right\\rangle = \\int_{-1}^{1} \\left(x^{2} - \\frac{1}{3}\\right)^{2} dx = \\int_{-1}^{1} \\left(x^{4} - \\frac{2}{3}x^{2} + \\frac{1}{9}\\right) dx. $$\n$$ = \\left[\\frac{x^{5}}{5} - \\frac{2}{9}x^{3} + \\frac{1}{9}x\\right]_{-1}^{1} = \\left(\\frac{1}{5} - \\frac{2}{9} + \\frac{1}{9}\\right) - \\left(-\\frac{1}{5} + \\frac{2}{9} - \\frac{1}{9}\\right) = 2\\left(\\frac{1}{5} - \\frac{1}{9}\\right) = 2\\left(\\frac{9-5}{45}\\right) = \\frac{8}{45}. $$\nThe norm is $\\|u_{2}(x)\\| = \\sqrt{\\frac{8}{45}}$.\nThe third orthonormal function is:\n$$ \\varphi_{2}(x) = \\frac{u_{2}(x)}{\\|u_{2}(x)\\|} = \\frac{x^{2} - \\frac{1}{3}}{\\sqrt{8/45}} = \\sqrt{\\frac{45}{8}}\\left(x^{2} - \\frac{1}{3}\\right). $$\nTo align this with the standard Legendre polynomial $P_{2}(x) = \\frac{1}{2}(3x^{2}-1)$, we can rewrite $u_{2}(x) = x^{2} - \\frac{1}{3} = \\frac{3x^{2}-1}{3} = \\frac{2}{3}P_{2}(x)$.\nThe normalization factor is $\\sqrt{\\frac{45}{8}} = \\sqrt{\\frac{9 \\cdot 5}{4 \\cdot 2}} = \\frac{3\\sqrt{5}}{2\\sqrt{2}}$. Thus,\n$$ \\varphi_{2}(x) = \\frac{3\\sqrt{5}}{2\\sqrt{2}}\\left(\\frac{1}{3}(3x^{2}-1)\\right) = \\frac{\\sqrt{5}}{2\\sqrt{2}}(3x^{2}-1) = \\sqrt{\\frac{5}{8}}(3x^{2}-1). $$\nThis corresponds to the normalized Legendre polynomial of degree $2$, as the normalization constant is $\\sqrt{\\frac{2(2)+1}{2}} = \\sqrt{\\frac{5}{2}}$, and $\\varphi_{2}(x) = \\sqrt{\\frac{5}{2}}P_{2}(x)$.\n\nThe resulting orthonormal basis is $\\{\\varphi_{0}(x), \\varphi_{1}(x), \\varphi_{2}(x)\\}$. The explicit forms are:\n$\\varphi_{0}(x) = \\frac{1}{\\sqrt{2}}$\n$\\varphi_{1}(x) = \\sqrt{\\frac{3}{2}}x$\n$\\varphi_{2}(x) = \\sqrt{\\frac{5}{8}}(3x^{2}-1)$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}  \\sqrt{\\frac{3}{2}}x  \\sqrt{\\frac{5}{8}}(3x^2-1)\n\\end{pmatrix}\n}\n$$", "id": "2648934"}, {"introduction": "The time evolution of chemical systems, from reaction kinetics to quantum dynamics, is often governed by \"stiff\" systems of differential equations involving processes on vastly different timescales. This practice addresses the numerical challenge of solving such systems, for which standard explicit methods often fail. You will derive and analyze the implicit midpoint method, a robust algorithm for stiff problems, and through a combination of analysis and implementation, verify its essential properties of second-order accuracy and A-stability [@problem_id:2648885].", "problem": "Consider the constant-coefficient linear initial value problem in vector form, $ \\dot{\\mathbf{y}}(t) = \\mathbf{A}\\,\\mathbf{y}(t) $, with $ \\mathbf{y}(0) = \\mathbf{y}_0 $, where $ \\mathbf{A} \\in \\mathbb{C}^{m \\times m} $ is a fixed matrix. Your task is to derive and implement the implicit midpoint time-stepping method for this problem starting from the integral form $ \\mathbf{y}(t_{n+1}) = \\mathbf{y}(t_n) + \\int_{t_n}^{t_{n+1}} \\mathbf{A}\\,\\mathbf{y}(t)\\,\\mathrm{d}t $ and the midpoint quadrature rule. Use the resulting scheme to study both accuracy and stability on the scalar test equation $ \\dot{y}(t) = \\lambda\\,y(t) $ with $ \\lambda \\in \\mathbb{C} $. Do not assume any formula not derived from these bases.\n\nYour program must:\n- Implement the implicit midpoint method for constant $ \\mathbf{A} $ by reducing each step to the solution of a linear system with the same coefficient matrix for all steps of a fixed step size $ h $, and apply it repeatedly over $ N = T/h $ steps to compute an approximation at time $ T $.\n- For the scalar test equation, derive the amplification factor $ R(z) $, where $ z = h\\,\\lambda $, and use it to assess linear stability in the complex plane.\n\nTest suite specification:\n1. Second-order accuracy (global order) on the scalar test equation:\n   - Use $ \\lambda = -50 $, $ y(0) = 1 $, and final time $ T = 1 $.\n   - Use step sizes $ h \\in \\{ 2^{-4},\\,2^{-5},\\,2^{-6},\\,2^{-7} \\} $ so that $ N = T/h $ is an integer in each case.\n   - For each $ h $, compute the absolute error at $ T $, namely $ e(h) = \\lvert y_N - \\exp(\\lambda\\,T) \\rvert $.\n   - Estimate the observed order $ p $ by a least-squares fit of $ \\log(e(h)) $ versus $ \\log(h) $ over the set of $ h $ values. Report $ p $ rounded to three decimals.\n\n2. $ A $-stability on the scalar test equation via the amplification factor:\n   - Derive $ R(z) $ for the method applied to $ \\dot{y} = \\lambda\\,y $.\n   - For the set $ \\mathcal{Z} = \\{ 0,\\,-1,\\,-10,\\,-1000,\\,-1+10\\,\\mathrm{i},\\,-1-10\\,\\mathrm{i},\\,100\\,\\mathrm{i},\\,-100\\,\\mathrm{i} \\} $, compute the boolean values $ b(z) $ that are true if and only if $ \\lvert R(z) \\rvert \\le 1 + \\epsilon $ with tolerance $ \\epsilon = 10^{-12} $ and false otherwise. Report the list $ [\\,b(z)\\,:\\,z \\in \\mathcal{Z}\\,] $ preserving the order given.\n\n3. Stiff linear system propagation check:\n   - Let $ \\mathbf{A} = \\mathrm{diag}(-1000,\\,-1) \\in \\mathbb{R}^{2 \\times 2} $, $ \\mathbf{y}_0 = [\\,1,\\,1\\,]^\\top $, and $ h = 1 $, $ T = 1 $ (so $ N = 1 $ step).\n   - Compute the one-step amplification matrix $ \\mathbf{M}(h) $ of the implicit midpoint method for this $ \\mathbf{A} $, and then its spectral radius $ \\rho(\\mathbf{M}(h)) $.\n   - Report $ \\rho(\\mathbf{M}(h)) $ rounded to six decimals, and a boolean $ b_\\rho $ that is true if and only if $ \\rho(\\mathbf{M}(h)) \\le 1 + \\epsilon $ with the same $ \\epsilon $ as above.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces.\n- The output must be of the form\n  $ [\\,p,\\,[b(0),b(-1),b(-10),b(-1000),b(-1+10\\,\\mathrm{i}),b(-1-10\\,\\mathrm{i}),b(100\\,\\mathrm{i}),b(-100\\,\\mathrm{i})],\\,\\rho(\\mathbf{M}(1)),\\,b_\\rho\\,] $,\n  where $ p $ is rounded to three decimals and $ \\rho(\\mathbf{M}(1)) $ is rounded to six decimals, and all booleans are unrounded.\n- No physical units are involved in this problem, and no angles are used. All numerical values should be treated as dimensionless real or complex numbers as specified.", "solution": "The problem is valid as it constitutes a standard, well-posed exercise in numerical analysis for ordinary differential equations, grounded in established mathematical principles and containing all necessary information for a unique solution.\n\nWe begin by deriving the implicit midpoint method for the vector-form linear initial value problem $\\dot{\\mathbf{y}}(t) = \\mathbf{A}\\,\\mathbf{y}(t)$. The starting point is the exact integral representation of the solution over a time step from $t_n$ to $t_{n+1} = t_n + h$:\n$$\n\\mathbf{y}(t_{n+1}) = \\mathbf{y}(t_n) + \\int_{t_n}^{t_{n+1}} \\mathbf{A}\\,\\mathbf{y}(t)\\,\\mathrm{d}t\n$$\nThe integral is approximated using the midpoint quadrature rule, which states $\\int_{a}^{b} f(t)\\,\\mathrm{d}t \\approx (b-a) f(\\frac{a+b}{2})$. Applying this to our equation with integrand $\\mathbf{A}\\,\\mathbf{y}(t)$, step size $h = t_{n+1} - t_n$, and midpoint time $t_{n+1/2} = t_n + h/2$, we obtain the numerical scheme:\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + h (\\mathbf{A}\\,\\mathbf{y}(t_{n+1/2}))\n$$\nThis scheme is implicit, as it depends on the solution at the yet-unknown time $t_{n+1/2}$. For the implicit midpoint rule, the value $\\mathbf{y}(t_{n+1/2})$ is approximated by the average of the values at the beginning and end of the interval:\n$$\n\\mathbf{y}(t_{n+1/2}) \\approx \\frac{\\mathbf{y}_n + \\mathbf{y}_{n+1}}{2}\n$$\nSubstituting this approximation into the scheme gives:\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + h \\mathbf{A} \\left( \\frac{\\mathbf{y}_n + \\mathbf{y}_{n+1}}{2} \\right)\n$$\nTo solve for $\\mathbf{y}_{n+1}$, we rearrange the terms:\n$$\n\\mathbf{y}_{n+1} - \\frac{h}{2} \\mathbf{A} \\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{h}{2} \\mathbf{A} \\mathbf{y}_n\n$$\nFactoring out $\\mathbf{y}_{n+1}$ on the left and $\\mathbf{y}_n$ on the right, where $\\mathbf{I}$ is the identity matrix, we get:\n$$\n\\left(\\mathbf{I} - \\frac{h}{2} \\mathbf{A}\\right) \\mathbf{y}_{n+1} = \\left(\\mathbf{I} + \\frac{h}{2} \\mathbf{A}\\right) \\mathbf{y}_n\n$$\nThis is a linear system for $\\mathbf{y}_{n+1}$ with a coefficient matrix $(\\mathbf{I} - \\frac{h}{2}\\mathbf{A})$ that is constant for a fixed step size $h$. The formal solution is obtained by matrix inversion:\n$$\n\\mathbf{y}_{n+1} = \\left(\\mathbf{I} - \\frac{h}{2} \\mathbf{A}\\right)^{-1} \\left(\\mathbf{I} + \\frac{h}{2} \\mathbf{A}\\right) \\mathbf{y}_n\n$$\nThe matrix $\\mathbf{M}(h) = (\\mathbf{I} - \\frac{h}{2} \\mathbf{A})^{-1} (\\mathbf{I} + \\frac{h}{2} \\mathbf{A})$ is the one-step amplification matrix.\n\nFor the scalar test equation $\\dot{y}(t) = \\lambda y(t)$, the matrix $\\mathbf{A}$ is simply the scalar $\\lambda \\in \\mathbb{C}$. The scheme becomes:\n$$\ny_{n+1} = \\left(1 - \\frac{h\\lambda}{2}\\right)^{-1} \\left(1 + \\frac{h\\lambda}{2}\\right) y_n\n$$\nThe amplification factor $R(z)$, where $z = h\\lambda$, is therefore:\n$$\nR(z) = \\frac{1 + z/2}{1 - z/2}\n$$\n\nTask 1: Accuracy. The implicit midpoint rule is a symmetric method and is known to have a global error of order $2$, i.e., $e(h) = \\mathcal{O}(h^2)$. This means the error $e(h)$ at a fixed time $T$ behaves as $e(h) \\approx C h^p$ for some constant $C$ and order $p$. Taking the natural logarithm, we have $\\log(e(h)) \\approx \\log(C) + p \\log(h)$. A linear least-squares fit of $\\log(e(h))$ versus $\\log(h)$ will yield the observed order $p$ as the slope. We compute this for $\\lambda = -50$, $y(0) = 1$, $T=1$, and $h \\in \\{2^{-4}, 2^{-5}, 2^{-6}, 2^{-7}\\}$. The exact solution is $y(T) = \\exp(\\lambda T)$. The numerical solution is $y_N = (R(h\\lambda))^N y_0$ where $N=T/h$.\n\nTask 2: A-stability. A method is A-stable if its region of absolute stability includes the entire left half of the complex plane, i.e., $|R(z)| \\le 1$ for all $z \\in \\mathbb{C}$ with $\\mathrm{Re}(z) \\le 0$. For our $R(z)$, let $z = x + iy$ with $x \\le 0$.\n$$\n|R(z)|^2 = \\left| \\frac{1 + (x+iy)/2}{1 - (x+iy)/2} \\right|^2 = \\frac{|(1+x/2) + i(y/2)|^2}{|(1-x/2) - i(y/2)|^2} = \\frac{(1+x/2)^2 + (y/2)^2}{(1-x/2)^2 + (y/2)^2} = \\frac{1 + x + (x^2+y^2)/4}{1 - x + (x^2+y^2)/4}\n$$\nSince $x \\le 0$, we have $1+x \\le 1-x$. The numerator is less than or equal to the denominator, so $|R(z)|^2 \\le 1$. The method is A-stable. We will verify $|R(z)| \\le 1 + \\epsilon$ for a set of test points $\\mathcal{Z}$, all of which lie in the left half-plane or on the imaginary axis.\n\nTask 3: Stiff system. The stability of the method for a linear system is determined by the spectral radius of the amplification matrix, $\\rho(\\mathbf{M}(h))$. If $\\mathbf{A}$ is diagonalizable with eigenvalues $\\{\\lambda_i\\}$, then the eigenvalues of $\\mathbf{M}(h)$ are $\\{R(h\\lambda_i)\\}$. The spectral radius is $\\rho(\\mathbf{M}(h)) = \\max_i |R(h\\lambda_i)|$. For the given diagonal matrix $\\mathbf{A} = \\mathrm{diag}(-1000, -1)$, the eigenvalues are $\\lambda_1 = -1000$ and $\\lambda_2 = -1$. With $h=1$, the arguments to $R$ are $z_1 = -1000$ and $z_2 = -1$. The spectral radius is $\\rho(\\mathbf{M}(1)) = \\max(|R(-1000)|, |R(-1)|)$. We compute this value and check if it is bounded by $1 + \\epsilon$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the specified numerical analysis problem involving the implicit midpoint method.\n    \"\"\"\n\n    # --- Task 1: Second-order accuracy (global order) ---\n    lambda_val = -50.0\n    y0 = 1.0\n    T = 1.0\n    h_values = np.array([2**-4, 2**-5, 2**-6, 2**-7])\n\n    # Amplification factor R(z) for the implicit midpoint method\n    R = lambda z: (1 + z / 2.0) / (1 - z / 2.0)\n\n    # Exact solution at time T\n    y_exact = np.exp(lambda_val * T)\n\n    errors = []\n    for h in h_values:\n        N = int(T / h)\n        z = h * lambda_val\n        # For a linear scalar problem, y_N = R(z)^N * y_0\n        y_N = (R(z)**N) * y0\n        errors.append(np.abs(y_N - y_exact))\n    \n    errors = np.array(errors)\n\n    # Estimate order p by fitting log(error) vs log(h)\n    # log(error) = p * log(h) + C\n    p = np.polyfit(np.log(h_values), np.log(errors), 1)[0]\n    p_rounded = round(p, 3)\n\n    # --- Task 2: A-stability on the scalar test equation ---\n    epsilon = 1e-12\n    z_values_complex = [\n        complex(0, 0), complex(-1, 0), complex(-10, 0), complex(-1000, 0),\n        complex(-1, 10), complex(-1, -10),\n        complex(0, 100), complex(0, -100)\n    ]\n\n    b_values = []\n    for z in z_values_complex:\n        # np.abs for complex numbers gives the modulus\n        is_stable = np.abs(R(z)) = 1.0 + epsilon\n        b_values.append(is_stable)\n\n    # --- Task 3: Stiff linear system propagation check ---\n    # A = diag(-1000, -1), so eigenvalues are lambda_1 = -1000, lambda_2 = -1\n    lambda_1 = -1000.0\n    lambda_2 = -1.0\n    h_stiff = 1.0\n\n    # The arguments for the amplification factor R(z)\n    z1 = h_stiff * lambda_1\n    z2 = h_stiff * lambda_2\n    \n    # The spectral radius of the amplification matrix M(h) is max(|R(h*lambda_i)|)\n    rho_M_h = np.max([np.abs(R(z1)), np.abs(R(z2))])\n    rho_M_h_rounded = round(rho_M_h, 6)\n\n    # Check if the method is stable for this stiff problem (rho = 1)\n    b_rho = rho_M_h = 1.0 + epsilon\n\n    # --- Final Output Formatting ---\n    # The format requires a list-like string with no spaces.\n    # Python's bool string representation 'True'/'False' is what is expected.\n    b_values_str = f\"[{','.join(map(str, b_values))}]\"\n    final_output = f\"[{p_rounded},{b_values_str},{rho_M_h_rounded},{b_rho}]\"\n    # Remove all spaces for the final strict format\n    print(final_output.replace(\" \", \"\"))\n\nsolve()\n```", "id": "2648885"}, {"introduction": "The eigenvalues of operators in physical chemistry often correspond to measurable quantities like energy levels or spectroscopic frequencies. This exercise explores the crucial concept of model stability, investigating how these calculated eigenvalues respond to small perturbations in the underlying physical model. By analyzing a non-Hermitian system, you will learn how the sensitivity of an eigenvalue is linked to the geometric relationship between its left and right eigenvectors, providing a powerful tool to assess the robustness of theoretical predictions [@problem_id:2648932].", "problem": "A two-resonance linear response operator in the frequency domain (rotating frame) for a weakly driven molecular system can be modeled by a non-Hermitian $2\\times 2$ matrix whose simple poles determine spectroscopic peak positions. Consider\n$$\nA \\;=\\; \\begin{pmatrix}\n-1.50\\times 10^{8} + i\\,6.00\\times 10^{9}  6.00\\times 10^{7} \\\\\n0  -1.60\\times 10^{8} + i\\,5.98\\times 10^{9}\n\\end{pmatrix}\\ \\ (\\mathrm{s}^{-1})\\,,\n$$\nwhose eigenvalues are the pole locations. Let $\\lambda_{1}$ denote the eigenvalue associated with the first diagonal entry. Small environmental fluctuations induce an additive perturbation $\\delta A$ with spectral norm $\\|\\delta A\\|_{2} = 5.00\\times 10^{6}\\ \\mathrm{s}^{-1}$.\n\nStarting from the definitions of right and left eigenvectors $A v = \\lambda v$ and $A^{\\dagger} w = \\overline{\\lambda}\\, w$ for a simple eigenvalue, and using linear perturbation analysis together with the Cauchy–Schwarz inequality in the spectral norm, express the sensitivity of $\\lambda_{1}$ to $\\delta A$ through the acute angle $\\theta$ between the unit-norm left and right eigenvectors associated with $\\lambda_{1}$. Then, for the given $A$:\n- determine the angle factor implied by these eigenvectors,\n- use it to obtain the tightest first-order upper bound on the magnitude of the shift of the resonance angular frequency, i.e., $|\\delta\\,\\mathrm{Im}\\,\\lambda_{1}|$.\n\nReport the numerical value of this upper bound in $\\mathrm{s}^{-1}$, rounded to $3$ significant figures. The final answer must be a single number.", "solution": "The problem is valid as it is scientifically grounded in the principles of linear algebra and perturbation theory as applied to physical chemistry, is well-posed with all necessary information provided, and is expressed objectively.\n\nWe are asked to analyze the first-order sensitivity of a simple eigenvalue of a non-Hermitian matrix $A$ to a perturbation $\\delta A$. Let $\\lambda$ be a simple eigenvalue of $A$ with corresponding right eigenvector $v$ and left eigenvector $w$. By definition, they satisfy:\n$$Av = \\lambda v$$\n$$w^{\\dagger}A = \\lambda w^{\\dagger}$$\nThe second equation is the definition of the left eigenvector, which is equivalent to $A^{\\dagger}w = \\overline{\\lambda} w$ as stated in the problem.\nConsider the perturbed matrix $A' = A + \\delta A$. The perturbed eigenvalue $\\lambda' = \\lambda + \\delta\\lambda$ and eigenvector $v' = v + \\delta v$ satisfy $(A + \\delta A)(v + \\delta v) = (\\lambda + \\delta\\lambda)(v + \\delta v)$. Expanding this equation and keeping only terms of first order in the perturbations gives:\n$$Av + A(\\delta v) + (\\delta A)v \\approx \\lambda v + \\lambda(\\delta v) + (\\delta\\lambda)v$$\nUsing $Av = \\lambda v$, we simplify the expression to:\n$$A(\\delta v) + (\\delta A)v \\approx \\lambda(\\delta v) + (\\delta\\lambda)v$$\nRearranging gives:\n$$(A - \\lambda I)\\delta v \\approx (\\delta\\lambda)v - (\\delta A)v$$\nLeft-multiplying by the adjoint of the left eigenvector, $w^{\\dagger}$, we get:\n$$w^{\\dagger}(A - \\lambda I)\\delta v \\approx w^{\\dagger}(\\delta\\lambda)v - w^{\\dagger}(\\delta A)v$$\nThe term on the left is zero since $w^{\\dagger}(A - \\lambda I) = w^{\\dagger}A - \\lambda w^{\\dagger} = \\lambda w^{\\dagger} - \\lambda w^{\\dagger} = 0^{\\dagger}$. Thus, we have:\n$$0 \\approx (\\delta\\lambda)w^{\\dagger}v - w^{\\dagger}(\\delta A)v$$\nSolving for the first-order correction $\\delta\\lambda$ yields the standard result:\n$$\\delta\\lambda \\approx \\frac{w^{\\dagger}(\\delta A)v}{w^{\\dagger}v}$$\nTo find an upper bound for the magnitude of this correction, $|\\delta\\lambda|$, we take the absolute value and apply the Cauchy-Schwarz inequality to the numerator, along with the definition of the spectral norm $\\|\\cdot\\|_2$:\n$$|\\delta\\lambda| \\approx \\frac{|w^{\\dagger}(\\delta A)v|}{|w^{\\dagger}v|} \\le \\frac{\\|w\\|_2 \\|(\\delta A)v\\|_2}{|w^{\\dagger}v|} \\le \\frac{\\|w\\|_2 \\|\\delta A\\|_2 \\|v\\|_2}{|w^{\\dagger}v|}$$\nFor unit-norm eigenvectors, $\\|v\\|_2 = 1$ and $\\|w\\|_2 = 1$, the expression simplifies. The term $w^{\\dagger}v$ is the inner product $\\langle w, v \\rangle$. Its magnitude is given by $|w^{\\dagger}v| = \\cos\\theta$, where $\\theta$ is the angle between the eigenvectors. The problem specifies $\\theta$ as the acute angle, so $\\cos\\theta \\ge 0$. The sensitivity of the eigenvalue is thus expressed as:\n$$|\\delta\\lambda| \\le \\frac{\\|\\delta A\\|_2}{\\cos\\theta}$$\nThe sensitivity is therefore determined by the factor $1/\\cos\\theta$, which is the condition number of the eigenvalue. This is the \"angle factor\" requested.\n\nThe problem asks for the tightest first-order upper bound on $|\\delta\\,\\mathrm{Im}\\,\\lambda_1|$. We note that $|\\delta\\,\\mathrm{Im}\\,\\lambda_1| = |\\mathrm{Im}(\\delta\\lambda_1)| \\le |\\delta\\lambda_1|$. The bound is tight because a perturbation $\\delta A$ can be constructed (specifically, a rank-one perturbation of the form $k w v^\\dagger$ with an appropriate complex phase for $k$) that makes $\\delta\\lambda_1$ purely imaginary and equal in magnitude to the upper bound. Therefore, the tightest bound on $|\\delta\\,\\mathrm{Im}\\,\\lambda_1|$ is the same as for $|\\delta\\lambda_1|$:\n$$\\max |\\delta\\,\\mathrm{Im}\\,\\lambda_1| = \\frac{\\|\\delta A\\|_2}{\\cos\\theta_1}$$\nwhere $\\theta_1$ is the angle between the left and right eigenvectors corresponding to $\\lambda_1$.\n\nNow, we apply this to the given matrix:\n$$A = \\begin{pmatrix} -1.50\\times 10^{8} + i\\,6.00\\times 10^{9}  6.00\\times 10^{7} \\\\ 0  -1.60\\times 10^{8} + i\\,5.98\\times 10^{9} \\end{pmatrix}$$\nSince $A$ is an upper triangular matrix, its eigenvalues are its diagonal entries. The eigenvalue associated with the first diagonal entry is $\\lambda_1$:\n$$\\lambda_1 = -1.50\\times 10^{8} + i\\,6.00\\times 10^{9}\\ \\mathrm{s}^{-1}$$\nThe right eigenvector $v_1$ is found by solving $(A - \\lambda_1 I)v_1 = 0$:\n$$\\begin{pmatrix} 0  6.00\\times 10^{7} \\\\ 0  (-1.60\\times 10^{8} + i\\,5.98\\times 10^{9}) - (-1.50\\times 10^{8} + i\\,6.00\\times 10^{9}) \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n$$\\begin{pmatrix} 0  6.00\\times 10^{7} \\\\ 0  -1.0\\times 10^{7} - i\\,2.0\\times 10^{7} \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\nThe first row gives $(6.00\\times 10^{7})y = 0$, which implies $y=0$. We can choose $x=1$. The normalized right eigenvector is $v_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\n\nThe left eigenvector $w_1$ is found by solving $w_1^{\\dagger}(A - \\lambda_1 I) = 0^{\\dagger}$:\n$$\\begin{pmatrix} \\bar{p}  \\bar{q} \\end{pmatrix} \\begin{pmatrix} 0  6.00\\times 10^{7} \\\\ 0  -1.0\\times 10^{7} - i\\,2.0\\times 10^{7} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\end{pmatrix}$$\nThis yields the single equation: $\\bar{p}(6.00\\times 10^{7}) + \\bar{q}(-1.0\\times 10^{7} - i\\,2.0\\times 10^{7}) = 0$.\n$$6\\bar{p} = \\bar{q}(1+2i) \\implies \\bar{q} = \\frac{6\\bar{p}}{1+2i} = \\frac{6(1-2i)}{1^2+2^2}\\bar{p} = \\frac{6}{5}(1-2i)\\bar{p}$$\nChoosing $p=1$, we get $q = \\frac{6}{5}(1+2i)$. The unnormalized left eigenvector is $w_{1, \\text{un-norm}} = \\begin{pmatrix} 1 \\\\ \\frac{6}{5}(1+2i) \\end{pmatrix}$.\nThe squared norm is $\\|w_{1, \\text{un-norm}}\\|_2^2 = |1|^2 + |\\frac{6}{5}(1+2i)|^2 = 1 + \\frac{36}{25}(1^2+2^2) = 1 + \\frac{36}{25}(5) = 1 + \\frac{36}{5} = \\frac{41}{5}$.\nThe norm is $\\|w_{1, \\text{un-norm}}\\|_2 = \\sqrt{41/5}$.\nThe normalized left eigenvector is $w_1 = \\sqrt{\\frac{5}{41}} \\begin{pmatrix} 1 \\\\ \\frac{6}{5}(1+2i) \\end{pmatrix}$.\n\nNext, we find $\\cos\\theta_1 = |w_1^{\\dagger}v_1|$:\n$$w_1^{\\dagger}v_1 = \\sqrt{\\frac{5}{41}} \\begin{pmatrix} 1  \\frac{6}{5}(1-2i) \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\sqrt{\\frac{5}{41}}$$\nSo, $\\cos\\theta_1 = \\sqrt{5/41}$.\nThe angle factor, which is the condition number, is $1/\\cos\\theta_1 = \\sqrt{41/5} = \\sqrt{8.2}$.\n\nFinally, we calculate the tightest first-order upper bound on $|\\delta\\,\\mathrm{Im}\\,\\lambda_1|$ using the given norm of the perturbation, $\\|\\delta A\\|_2 = 5.00\\times 10^{6}\\ \\mathrm{s}^{-1}$:\n$$\\text{Upper Bound} = \\frac{\\|\\delta A\\|_2}{\\cos\\theta_1} = (5.00\\times 10^{6}) \\times \\sqrt{8.2}$$\n$$\\text{Upper Bound} \\approx (5.00\\times 10^{6}) \\times 2.863564 = 14.31782 \\times 10^{6} = 1.431782 \\times 10^{7}\\ \\mathrm{s}^{-1}$$\nRounding to $3$ significant figures, the upper bound is $1.43 \\times 10^{7}\\ \\mathrm{s}^{-1}$.", "answer": "$$\\boxed{1.43 \\times 10^{7}}$$", "id": "2648932"}]}