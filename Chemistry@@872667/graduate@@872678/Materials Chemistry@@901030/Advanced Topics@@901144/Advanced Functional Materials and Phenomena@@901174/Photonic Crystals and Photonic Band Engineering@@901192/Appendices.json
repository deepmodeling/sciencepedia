{"hands_on_practices": [{"introduction": "Understanding the behavior of light in a photonic crystal begins with understanding the mathematical space in which its waves propagate: the reciprocal lattice. This exercise is a foundational practice in translating a real-space crystal structure into its corresponding Brillouin zone in reciprocal space. By deriving the coordinates of the high-symmetry points, you will build the essential map used to plot and interpret photonic band diagrams, a crucial skill for analyzing any periodic photonic material [@problem_id:2509781].", "problem": "A two-dimensional ($2$D) hexagonal Bravais lattice is used to describe a dielectric photonic crystal relevant to materials chemistry, with real-space primitive vectors given in Cartesian coordinates by $\\mathbf{a}_{1} = a\\,(1,\\,0)$ and $\\mathbf{a}_{2} = a\\,\\left(\\tfrac{1}{2},\\,\\tfrac{\\sqrt{3}}{2}\\right)$, where $a$ is the real-space lattice constant. Starting from the standard definition of the reciprocal lattice $\\mathbf{b}_{i}$ that satisfies $\\mathbf{b}_{i} \\cdot \\mathbf{a}_{j} = 2\\pi\\,\\delta_{ij}$, determine the reciprocal lattice vectors and construct the first Brillouin zone (the Wigner–Seitz cell in reciprocal space).\n\nUsing only these fundamental definitions:\n- Derive explicit Cartesian coordinates for the high-symmetry points $\\Gamma$, $M$, and $K$ of this Brillouin zone for the given choice of $\\mathbf{a}_{1}$ and $\\mathbf{a}_{2}$. Here $\\Gamma$ is the zone center, $M$ is a center of a Brillouin-zone edge, and $K$ is a Brillouin-zone corner (vertex).\n- Briefly outline the standard high-symmetry path used to plot photonic band structures for a $2$D hexagonal photonic crystal.\n\nFinally, compute the dimensionless ratio $R = \\dfrac{|\\Gamma K|}{|\\Gamma M|}$ using your derived coordinates. Provide the final ratio as a simplified exact expression with no units. Do not approximate the result.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains sufficient information for a unique solution. It is a standard exercise in solid-state physics, applicable to the study of photonic crystals. We proceed with the derivation.\n\nThe first step is to determine the primitive reciprocal lattice vectors, $\\mathbf{b}_{1}$ and $\\mathbf{b}_{2}$, from the given real-space primitive vectors $\\mathbf{a}_{1} = a(1, 0)$ and $\\mathbf{a}_{2} = a(\\frac{1}{2}, \\frac{\\sqrt{3}}{2})$. The definition of the reciprocal lattice vectors in two dimensions ($2$D) is given by the relation $\\mathbf{b}_{i} \\cdot \\mathbf{a}_{j} = 2\\pi\\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\nLet the reciprocal vectors be represented in Cartesian coordinates as $\\mathbf{b}_{1} = (b_{1x}, b_{1y})$ and $\\mathbf{b}_{2} = (b_{2x}, b_{2y})$. We solve the system of linear equations derived from the defining relation.\n\nFor $\\mathbf{b}_{1}$:\nThe condition $\\mathbf{b}_{1} \\cdot \\mathbf{a}_{1} = 2\\pi$ implies $b_{1x} \\cdot a + b_{1y} \\cdot 0 = 2\\pi$, which gives $b_{1x} = \\frac{2\\pi}{a}$.\nThe condition $\\mathbf{b}_{1} \\cdot \\mathbf{a}_{2} = 0$ implies $b_{1x} \\cdot \\frac{a}{2} + b_{1y} \\cdot \\frac{a\\sqrt{3}}{2} = 0$. Substituting the value of $b_{1x}$, we have $(\\frac{2\\pi}{a})(\\frac{a}{2}) + b_{1y}(\\frac{a\\sqrt{3}}{2}) = 0$, which simplifies to $\\pi + b_{1y}(\\frac{a\\sqrt{3}}{2}) = 0$. Solving for $b_{1y}$ yields $b_{1y} = -\\frac{2\\pi}{a\\sqrt{3}}$.\nThus, the first reciprocal lattice vector is $\\mathbf{b}_{1} = (\\frac{2\\pi}{a}, -\\frac{2\\pi}{a\\sqrt{3}}) = \\frac{2\\pi}{a}(1, -\\frac{1}{\\sqrt{3}})$.\n\nFor $\\mathbf{b}_{2}$:\nThe condition $\\mathbf{b}_{2} \\cdot \\mathbf{a}_{1} = 0$ implies $b_{2x} \\cdot a + b_{2y} \\cdot 0 = 0$, which gives $b_{2x} = 0$.\nThe condition $\\mathbf{b}_{2} \\cdot \\mathbf{a}_{2} = 2\\pi$ implies $b_{2x} \\cdot \\frac{a}{2} + b_{2y} \\cdot \\frac{a\\sqrt{3}}{2} = 2\\pi$. Substituting the value of $b_{2x}$, we get $0 + b_{2y}(\\frac{a\\sqrt{3}}{2}) = 2\\pi$, which gives $b_{2y} = \\frac{4\\pi}{a\\sqrt{3}}$.\nThus, the second reciprocal lattice vector is $\\mathbf{b}_{2} = (0, \\frac{4\\pi}{a\\sqrt{3}}) = \\frac{2\\pi}{a}(0, \\frac{2}{\\sqrt{3}})$.\n\nThe first Brillouin zone (BZ) is the Wigner–Seitz cell of the reciprocal lattice, centered at the origin. It is formed by the region enclosed by the perpendicular bisectors of the vectors to the nearest-neighbor reciprocal lattice points. For a hexagonal lattice, the BZ is a regular hexagon.\n\nThe high-symmetry points are defined by the geometry of this hexagon.\n- The $\\Gamma$ point is the center of the BZ, so its coordinates are $\\Gamma=(0, 0)$.\n- The $M$ point is the center of any of the six edges of the BZ. An edge is the perpendicular bisector of a vector to a nearest neighbor. We can find the coordinates of an $M$ point by taking half of a nearest-neighbor reciprocal lattice vector. Choosing the vector $\\mathbf{b}_2$ for its simple orientation along the $k_y$-axis, we find the coordinates for one of the $M$ points:\n$$M = \\frac{1}{2}\\mathbf{b}_{2} = \\frac{1}{2} \\left(0, \\frac{4\\pi}{a\\sqrt{3}}\\right) = \\left(0, \\frac{2\\pi}{a\\sqrt{3}}\\right)$$\n- The $K$ point is a vertex of the hexagonal BZ. A vertex is located at the intersection of two adjacent edges. It can also be expressed as a linear combination of the primitive reciprocal vectors. For the hexagonal BZ, a vertex $K$ can be found at the position $K = \\frac{1}{3}(\\mathbf{b}_1 + 2\\mathbf{b}_2)$. We calculate its coordinates:\n$$K = \\frac{1}{3}\\left[ \\left(\\frac{2\\pi}{a}, -\\frac{2\\pi}{a\\sqrt{3}}\\right) + 2\\left(0, \\frac{4\\pi}{a\\sqrt{3}}\\right) \\right] = \\frac{1}{3}\\left(\\frac{2\\pi}{a}, -\\frac{2\\pi}{a\\sqrt{3}} + \\frac{8\\pi}{a\\sqrt{3}}\\right)$$\n$$K = \\frac{1}{3}\\left(\\frac{2\\pi}{a}, \\frac{6\\pi}{a\\sqrt{3}}\\right) = \\left(\\frac{2\\pi}{3a}, \\frac{2\\pi}{a\\sqrt{3}}\\right)$$\n\nThe standard high-symmetry path for plotting the photonic band structure of a $2$D hexagonal crystal typically traverses the boundary of the irreducible Brillouin zone (IBZ), which is the triangle with vertices $\\Gamma$, $M$, and $K$. The path is conventionally defined as $\\Gamma \\rightarrow M \\rightarrow K \\rightarrow \\Gamma$.\n\nFinally, we compute the dimensionless ratio $R = \\frac{|\\Gamma K|}{|\\Gamma M|}$. We first calculate the magnitudes of the vectors from the origin $\\Gamma$ to the points $M$ and $K$.\nThe distance $|\\Gamma M|$ is:\n$$|\\Gamma M| = \\sqrt{0^2 + \\left(\\frac{2\\pi}{a\\sqrt{3}}\\right)^2} = \\frac{2\\pi}{a\\sqrt{3}}$$\nThe distance $|\\Gamma K|$ is:\n$$|\\Gamma K| = \\sqrt{\\left(\\frac{2\\pi}{3a}\\right)^2 + \\left(\\frac{2\\pi}{a\\sqrt{3}}\\right)^2} = \\sqrt{\\frac{4\\pi^2}{9a^2} + \\frac{4\\pi^2}{3a^2}} = \\sqrt{\\frac{4\\pi^2 + 12\\pi^2}{9a^2}} = \\sqrt{\\frac{16\\pi^2}{9a^2}} = \\frac{4\\pi}{3a}$$\nThe ratio $R$ is then:\n$$R = \\frac{|\\Gamma K|}{|\\Gamma M|} = \\frac{4\\pi/(3a)}{2\\pi/(a\\sqrt{3})} = \\frac{4\\pi}{3a} \\cdot \\frac{a\\sqrt{3}}{2\\pi} = \\frac{2\\sqrt{3}}{3}$$\nThis result rightly confirms the known geometric relationship between the circumradius and the apothem of a regular hexagon.", "answer": "$$\\boxed{\\frac{2\\sqrt{3}}{3}}$$", "id": "2509781"}, {"introduction": "With the Brillouin zone mapped, we now turn to the vertical axis of the band diagram—frequency. Photonic crystals obey a powerful scaling law, a direct consequence of the scale-invariance of Maxwell's equations. This practice challenges you to derive this law from first principles, revealing why eigenfrequencies scale inversely with the crystal's physical size and justifying the universal use of normalized frequency units like $\\omega a / (2\\pi c)$ in band structure calculations [@problem_id:2509800].", "problem": "A two-dimensional square-lattice photonic crystal in the plane, with lattice constant $a$ and a spatially periodic relative permittivity distribution $\\varepsilon(\\mathbf{r})$ satisfying $\\varepsilon(\\mathbf{r}+\\mathbf{R})=\\varepsilon(\\mathbf{r})$ for any direct lattice vector $\\mathbf{R}$, is considered. Assume nonmagnetic media with uniform magnetic permeability $\\mu=\\mu_{0}$ and adopt the source-free, time-harmonic Maxwell equations with angular frequency $\\omega$. Let $\\mathbf{k}$ denote the Bloch wavevector, and impose Bloch boundary conditions on the primitive cell.\n\nStarting from the frequency-domain Maxwell curl equations and the Bloch theorem, recast the eigenvalue problem over a primitive cell into a dimensionless form using the reduced coordinate $\\boldsymbol{\\rho}=\\mathbf{r}/a$ and the reduced wavevector $\\boldsymbol{\\kappa}=a\\,\\mathbf{k}$. Then consider a uniform geometric scaling of the crystal by a factor $s>0$, so that the new lattice constant is $a'=s\\,a$ and the permittivity profile scales as $\\varepsilon'(\\mathbf{r})=\\varepsilon(\\mathbf{r}/s)$. Impose Bloch boundary conditions on the scaled primitive cell at a wavevector $\\mathbf{k}'$ such that the Bloch phase across a primitive translation is preserved in reduced coordinates.\n\nUsing only these principles and no additional shortcut formulas, compute the scaling factor $R(s)$ defined by the ratio of corresponding eigenfrequencies at the same reduced wavevector,\n$$\nR(s)\\equiv\\frac{\\omega'(\\boldsymbol{\\kappa})}{\\omega(\\boldsymbol{\\kappa})},\n$$\nwhere $\\omega(\\boldsymbol{\\kappa})$ is an eigenfrequency of the original crystal at reduced wavevector $\\boldsymbol{\\kappa}$ and $\\omega'(\\boldsymbol{\\kappa})$ is the corresponding eigenfrequency of the scaled crystal at the same $\\boldsymbol{\\kappa}$. Report your result as a single closed-form expression in terms of $s$ only.\n\nFinally, justify the invariance properties of the normalized frequency $\\omega a/(2\\pi c)$ under this scaling by explicitly identifying the dimensionless eigenvalue that governs the photonic bands and explaining how the Bloch boundary conditions enter. No numerical evaluation is required, and no units are to be included in the final reported expression for $R(s)$.", "solution": "The problem statement has been validated and found to be scientifically grounded, well-posed, and free of contradictions or ambiguities. We may proceed with the solution.\n\nThe problem requires the derivation of a scaling law for the eigenfrequencies of a photonic crystal. We begin from fundamental principles, namely the time-harmonic, source-free Maxwell's equations in a nonmagnetic medium with uniform permeability $\\mu_0$ and a spatially periodic relative permittivity $\\varepsilon(\\mathbf{r})$.\n\nMaxwell's curl equations are:\n$$ \\nabla \\times \\mathbf{E} = i\\omega\\mu_0\\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = -i\\omega\\varepsilon_0\\varepsilon(\\mathbf{r})\\mathbf{E} $$\nHere, $\\mathbf{E}$ and $\\mathbf{H}$ are the complex amplitudes of the electric and magnetic fields, $\\omega$ is the angular frequency, $\\varepsilon_0$ and $\\mu_0$ are the vacuum permittivity and permeability, respectively, and $c = 1/\\sqrt{\\varepsilon_0\\mu_0}$ is the speed of light in vacuum.\n\nWe can decouple these equations to obtain an eigenvalue equation for the magnetic field $\\mathbf{H}$. From the second equation, we have $\\mathbf{E} = \\frac{i}{\\omega\\varepsilon_0\\varepsilon(\\mathbf{r})} \\nabla \\times \\mathbf{H}$. Substituting this into the first equation yields:\n$$ \\nabla \\times \\left( \\frac{i}{\\omega\\varepsilon_0\\varepsilon(\\mathbf{r})} \\nabla \\times \\mathbf{H} \\right) = i\\omega\\mu_0\\mathbf{H} $$\nRearranging the terms, we arrive at the master equation for the magnetic field, which is a Hermitian eigenvalue problem for the eigenvalue $(\\omega/c)^2$:\n$$ \\nabla \\times \\left( \\frac{1}{\\varepsilon(\\mathbf{r})} \\nabla \\times \\mathbf{H}(\\mathbf{r}) \\right) = \\left(\\frac{\\omega}{c}\\right)^2 \\mathbf{H}(\\mathbf{r}) $$\nThe analysis is simplified by using this form because $\\nabla \\cdot \\mathbf{B} = 0$, implying $\\nabla \\cdot \\mathbf{H} = 0$ in a uniform magnetic medium, which obviates the need for an additional term from the vector identity $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$.\n\nThe crystal possesses translational symmetry, so the permittivity is periodic: $\\varepsilon(\\mathbf{r}+\\mathbf{R})=\\varepsilon(\\mathbf{r})$ for any direct lattice vector $\\mathbf{R}$. According to the Bloch theorem, the solutions to the wave equation in such a periodic medium can be written in the form:\n$$ \\mathbf{H}(\\mathbf{r}) = \\mathbf{h_k}(\\mathbf{r}) e^{i\\mathbf{k}\\cdot\\mathbf{r}} $$\nwhere $\\mathbf{h_k}(\\mathbf{r})$ has the same periodicity as the lattice, $\\mathbf{h_k}(\\mathbf{r}+\\mathbf{R}) = \\mathbf{h_k}(\\mathbf{r})$, and $\\mathbf{k}$ is the Bloch wavevector. Substituting this into the master equation, the curl operator $\\nabla$ acting on the Bloch function $\\mathbf{H}(\\mathbf{r})$ can be replaced by $(\\nabla + i\\mathbf{k})$ acting on the periodic part $\\mathbf{h_k}(\\mathbf{r})$. This transforms the eigenvalue problem over all space into a problem on a single primitive cell with periodic boundary conditions on $\\mathbf{h_k}(\\mathbf{r})$:\n$$ (\\nabla + i\\mathbf{k}) \\times \\left( \\frac{1}{\\varepsilon(\\mathbf{r})} (\\nabla + i\\mathbf{k}) \\times \\mathbf{h_k}(\\mathbf{r}) \\right) = \\left(\\frac{\\omega(\\mathbf{k})}{c}\\right)^2 \\mathbf{h_k}(\\mathbf{r}) $$\nThe frequency $\\omega$ is now denoted as $\\omega(\\mathbf{k})$ to emphasize that it is an eigenvalue corresponding to the wavevector $\\mathbf{k}$.\n\nNext, we recast this equation into a dimensionless form using the reduced coordinate $\\boldsymbol{\\rho} = \\mathbf{r}/a$ and the reduced wavevector $\\boldsymbol{\\kappa} = a\\mathbf{k}$, where $a$ is the lattice constant. The gradient operator transforms as $\\nabla_{\\mathbf{r}} = (1/a)\\nabla_{\\boldsymbol{\\rho}}$. The permittivity function $\\varepsilon(\\mathbf{r})$ and the periodic field envelope $\\mathbf{h_k}(\\mathbf{r})$ can be considered functions of the reduced coordinate $\\boldsymbol{\\rho}$. Let us denote them as $\\varepsilon(\\boldsymbol{\\rho})$ and $\\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho})$, respectively. Substituting these dimensionless quantities into the equation gives:\n$$ \\left(\\frac{1}{a}\\nabla_{\\boldsymbol{\\rho}} + i\\frac{\\boldsymbol{\\kappa}}{a}\\right) \\times \\left( \\frac{1}{\\varepsilon(\\boldsymbol{\\rho})} \\left(\\frac{1}{a}\\nabla_{\\boldsymbol{\\rho}} + i\\frac{\\boldsymbol{\\kappa}}{a}\\right) \\times \\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) \\right) = \\left(\\frac{\\omega(\\boldsymbol{\\kappa})}{c}\\right)^2 \\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) $$\nFactoring out the $1/a^2$ term from the left-hand side, we obtain:\n$$ \\frac{1}{a^2} (\\nabla_{\\boldsymbol{\\rho}} + i\\boldsymbol{\\kappa}) \\times \\left( \\frac{1}{\\varepsilon(\\boldsymbol{\\rho})} (\\nabla_{\\boldsymbol{\\rho}} + i\\boldsymbol{\\kappa}) \\times \\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) \\right) = \\left(\\frac{\\omega(\\boldsymbol{\\kappa})}{c}\\right)^2 \\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) $$\nRearranging yields the dimensionless eigenvalue equation:\n$$ (\\nabla_{\\boldsymbol{\\rho}} + i\\boldsymbol{\\kappa}) \\times \\left( \\frac{1}{\\varepsilon(\\boldsymbol{\\rho})} (\\nabla_{\\boldsymbol{\\rho}} + i\\boldsymbol{\\kappa}) \\times \\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) \\right) = \\left(\\frac{\\omega(\\boldsymbol{\\kappa})a}{c}\\right)^2 \\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) $$\nThis equation defines the photonic band structure. The operator on the left, let's call it $\\mathcal{L}_{\\boldsymbol{\\kappa}}$, depends only on the reduced wavevector $\\boldsymbol{\\kappa}$ and the permittivity profile as a function of the reduced coordinates, $\\varepsilon(\\boldsymbol{\\rho})$. The solutions yield the dimensionless eigenvalues $(\\omega a / c)^2$ and the corresponding dimensionless periodic eigenfunctions $\\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho})$.\n\nNow consider the scaled crystal with lattice constant $a' = sa$ and permittivity profile $\\varepsilon'(\\mathbf{r}) = \\varepsilon(\\mathbf{r}/s)$. The dimensionless eigenvalue equation for this scaled system (primed quantities) is:\n$$ (\\nabla_{\\boldsymbol{\\rho}'} + i\\boldsymbol{\\kappa}') \\times \\left( \\frac{1}{\\varepsilon'(\\boldsymbol{\\rho}')} (\\nabla_{\\boldsymbol{\\rho}'} + i\\boldsymbol{\\kappa}') \\times \\mathbf{h}'_{\\boldsymbol{\\kappa}'}(\\boldsymbol{\\rho}') \\right) = \\left(\\frac{\\omega'(\\boldsymbol{\\kappa'})a'}{c}\\right)^2 \\mathbf{h}'_{\\boldsymbol{\\kappa}'}(\\boldsymbol{\\rho}') $$\nwhere $\\boldsymbol{\\rho}' = \\mathbf{r}/a'$ and $\\boldsymbol{\\kappa}' = a'\\mathbf{k}'$. The problem requires a comparison at the same reduced wavevector, so we set $\\boldsymbol{\\kappa}' = \\boldsymbol{\\kappa}$. This preserves the Bloch phase factor across a primitive cell in reduced coordinates.\n\nLet us examine the permittivity profile of the scaled crystal in its reduced coordinates:\n$$ \\varepsilon'(\\boldsymbol{\\rho}') = \\varepsilon'(a'\\boldsymbol{\\rho}') = \\varepsilon'((sa)\\boldsymbol{\\rho}') $$\nUsing the definition $\\varepsilon'(\\mathbf{r}) = \\varepsilon(\\mathbf{r}/s)$, we set $\\mathbf{r} = sa\\boldsymbol{\\rho}'$:\n$$ \\varepsilon'(\\boldsymbol{\\rho}') = \\varepsilon\\left(\\frac{sa\\boldsymbol{\\rho}'}{s}\\right) = \\varepsilon(a\\boldsymbol{\\rho}') $$\nThis has the same functional form as the original permittivity in its reduced coordinates, $\\varepsilon(\\boldsymbol{\\rho}) = \\varepsilon(a\\boldsymbol{\\rho})$. Therefore, in the space of reduced coordinates, the dielectric function is identical for both the original and scaled systems: $\\varepsilon'(\\cdot) = \\varepsilon(\\cdot)$.\n\nSubstituting $\\boldsymbol{\\kappa}'=\\boldsymbol{\\kappa}$, $a'=sa$, and $\\varepsilon'(\\cdot) = \\varepsilon(\\cdot)$ into the scaled dimensionless equation, we get:\n$$ (\\nabla_{\\boldsymbol{\\rho}} + i\\boldsymbol{\\kappa}) \\times \\left( \\frac{1}{\\varepsilon(\\boldsymbol{\\rho})} (\\nabla_{\\boldsymbol{\\rho}} + i\\boldsymbol{\\kappa}) \\times \\mathbf{h}'_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) \\right) = \\left(\\frac{\\omega'(\\boldsymbol{\\kappa})sa}{c}\\right)^2 \\mathbf{h}'_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) $$\nNotice that the operator on the left is exactly the same operator $\\mathcal{L}_{\\boldsymbol{\\kappa}}$ as in the original problem. Since the operator and the periodic boundary conditions on the reduced unit cell are identical, the set of eigenvalues must also be identical.\nBy equating the eigenvalues of the original and scaled systems:\n$$ \\left(\\frac{\\omega(\\boldsymbol{\\kappa})a}{c}\\right)^2 = \\left(\\frac{\\omega'(\\boldsymbol{\\kappa})sa}{c}\\right)^2 $$\nSince frequencies are positive, we can take the square root of both sides:\n$$ \\frac{\\omega(\\boldsymbol{\\kappa})a}{c} = \\frac{\\omega'(\\boldsymbol{\\kappa})sa}{c} $$\n$$ \\omega(\\boldsymbol{\\kappa}) = s \\cdot \\omega'(\\boldsymbol{\\kappa}) $$\nThe problem asks for the ratio $R(s) = \\omega'(\\boldsymbol{\\kappa})/\\omega(\\boldsymbol{\\kappa})$. From the above relation, we find:\n$$ R(s) = \\frac{\\omega'(\\boldsymbol{\\kappa})}{\\omega(\\boldsymbol{\\kappa})} = \\frac{1}{s} $$\n\nFinally, we must justify the invariance properties of the normalized frequency $\\omega a / (2\\pi c)$ and discuss the roles of the dimensionless eigenvalue and Bloch conditions.\nThe dimensionless eigenvalue that governs the photonic bands is $(\\omega a / c)^2$. Its square root, $\\omega a / c$, or the commonly used normalized frequency $\\tilde{\\omega} = \\omega a / (2\\pi c)$, is the quantity whose constancy we must explain. Our derivation showed that for any eigenmode, the eigenvalues of the dimensionless operator must be the same for the original and the scaled systems:\n$$ \\frac{\\omega(\\boldsymbol{\\kappa})a}{c} = \\frac{\\omega'(\\boldsymbol{\\kappa})a'}{c} $$\nThis equality explicitly demonstrates that the normalized frequency is an invariant of the scaling transformation, provided the systems are compared at the same reduced wavevector $\\boldsymbol{\\kappa}$. This is why a single photonic band diagram, plotted as normalized frequency versus reduced wavevector, describes an entire family of geometrically similar crystals, differing only by the scale factor $s$.\n\nThe Bloch boundary conditions are central to this entire framework. By postulating the Bloch form of the solution, $\\mathbf{H}(\\mathbf{r}) = \\mathbf{h_k}(\\mathbf{r}) e^{i\\mathbf{k}\\cdot\\mathbf{r}}$, we are able to transform the problem from an infinite domain into an eigenvalue problem on a single primitive cell. This introduces the wavevector $\\mathbf{k}$ into the differential operator. The subsequent non-dimensionalization with respect to the lattice constant $a$ naturally groups $\\omega$ with $a$ to form the dimensionless eigenvalue $(\\omega a / c)^2$, and $\\mathbf{k}$ with $a$ to form the reduced wavevector $\\boldsymbol{\\kappa} = a\\mathbf{k}$, which parameterizes the dimensionless operator. The condition to compare eigenfrequencies at the same $\\boldsymbol{\\kappa}$ is a condition on the Bloch phase, which makes the dimensionless operators identical and leads directly to the scaling law and the invariance of the normalized frequency.", "answer": "$$\\boxed{\\frac{1}{s}}$$", "id": "2509800"}, {"introduction": "The true power of photonic crystals lies in our ability to engineer defects to create functional devices like waveguides and cavities. This exercise moves from the analysis of perfect crystals to the practical design of a line-defect waveguide, a structure that guides light by introducing a controlled break in periodicity. You will apply coupled-mode theory and the concept of the light line to build a computational model that assesses a design's performance, bridging the gap between theoretical understanding and the evaluation of a functional photonic component [@problem_id:2509811].", "problem": "A two-dimensional triangular-lattice slab photonic crystal (PhC) waveguide can be formed by removing a single row of air holes, creating a line defect that supports a propagating guided mode along the defect direction. Begin from the frequency-domain source-free Maxwell equations in linear, lossless, nonmagnetic media with relative permeability $\\mu_{r} = 1$ and spatially periodic relative permittivity $\\varepsilon(\\mathbf{r})$,\n$$\n\\nabla \\times \\nabla \\times \\mathbf{E}(\\mathbf{r}) = \\frac{\\omega^{2}}{c^{2}} \\, \\varepsilon(\\mathbf{r}) \\, \\mathbf{E}(\\mathbf{r}) \\, ,\n$$\ntogether with Bloch’s theorem for periodic media, and the physical picture that a line defect in a two-dimensional PhC forms a one-dimensional array of coupled localized resonances. Using these foundations only, derive a nearest-neighbor coupled-resonator dispersion relation for the fundamental line-defect guided mode in terms of a characteristic resonance angular frequency $\\omega_{0}$ of an isolated defect and a nearest-neighbor coupling parameter $\\kappa$. Translate this dispersion into a normalized frequency representation $f \\equiv \\omega a / (2\\pi c)$, where $a$ is the in-plane lattice constant and $c$ is the speed of light in vacuum. Separately, derive the light-line relation for out-of-plane radiation into a homogeneous cladding of refractive index $n_{\\mathrm{clad}}$, expressed as a normalized frequency $f_{\\mathrm{LL}}$ as a function of the in-plane Bloch wavevector magnitude $k_{\\parallel}$. Use the guiding condition that the defect mode is vertically confined if and only if its normalized frequency lies strictly below the cladding light line at the same in-plane wavevector.\n\nYour task is to implement these derivations in a complete, runnable program that evaluates whether a given PhC line-defect design achieves low radiation loss in a designated high-wavevector operational window near the Brillouin-zone edge. Proceed as follows for each test case:\n\n- Treat the waveguide as a one-dimensional periodic chain with period $a$ along the propagation direction. Work in the first Brillouin zone and sample $M$ equally spaced values of the dimensionless quantity $ka$ from $0$ to $\\pi$, inclusive, where $k$ is the scalar wavevector component along the defect and angles are in radians. Use $M = 1001$.\n- From your derived nearest-neighbor dispersion, compute the normalized defect-band frequency $f_{\\mathrm{def}}(ka)$ at each sampled $ka$.\n- From your derived light-line relation, compute the normalized light-line frequency $f_{\\mathrm{LL}}(ka)$ at each sampled $ka$ for a homogeneous cladding index $n_{\\mathrm{clad}}$.\n- Define the high-wavevector operational window as $ka \\in [0.8\\pi, \\pi]$. Within this window, determine:\n  1. The guided-point fraction $\\phi$, defined as the fraction of sampled points in the window satisfying $f_{\\mathrm{def}}(ka)  f_{\\mathrm{LL}}(ka)$.\n  2. The minimum relative separation $s_{\\min}$ over the guided points in the window, defined as the minimum of $\\left( f_{\\mathrm{LL}} - f_{\\mathrm{def}} \\right) / f_{\\mathrm{LL}}$ evaluated on those guided points. If there are no guided points in the window, define $s_{\\min} = 0$ and $\\phi = 0$.\n- Declare that the design meets a low-radiation-loss criterion if and only if both $\\phi \\ge \\phi_{\\mathrm{req}}$ and $s_{\\min} \\ge s_{\\mathrm{req}}$, where $\\phi_{\\mathrm{req}}$ and $s_{\\mathrm{req}}$ are prescribed thresholds.\n\nExpress normalized frequencies $f$ without physical units because they are dimensionless by definition. Angles for $ka$ are in radians. The final program must produce results rounded to six decimal places for all floating-point outputs.\n\nTest suite. For each test case, you are given $a$ in nanometers (nm), $n_{\\mathrm{clad}}$, the isolated-defect normalized resonance $f_{0} \\equiv \\omega_{0} a / (2\\pi c)$, the nearest-neighbor coupling in normalized-frequency units $t$ (proportional to $\\kappa a / (2\\pi c)$ from your derivation), and the acceptance thresholds $s_{\\mathrm{req}}$ and $\\phi_{\\mathrm{req}}$:\n\n- Case A (happy path): $a = 420 \\,\\mathrm{nm}$, $n_{\\mathrm{clad}} = 1.44$, $f_{0} = 0.275$, $t = 0.020$, $s_{\\mathrm{req}} = 0.100$, $\\phi_{\\mathrm{req}} = 0.950$.\n- Case B (boundary-like): $a = 420 \\,\\mathrm{nm}$, $n_{\\mathrm{clad}} = 1.44$, $f_{0} = 0.335$, $t = 0.005$, $s_{\\mathrm{req}} = 0.200$, $\\phi_{\\mathrm{req}} = 0.900$.\n- Case C (edge case, no guided window): $a = 420 \\,\\mathrm{nm}$, $n_{\\mathrm{clad}} = 3.10$, $f_{0} = 0.220$, $t = 0.010$, $s_{\\mathrm{req}} = 0.050$, $\\phi_{\\mathrm{req}} = 0.500$.\n\nYour program must compute, for each case, the triple `[phi, s_min, pass]` where $\\phi$ and $s_{\\min}$ are floats rounded to six decimal places and `pass` is a boolean indicating whether both thresholds are met. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself the list `[phi, s_min, pass]` for one test case, in the order A, B, C. For example, a syntactically valid output format is `[[0.123456,0.234567,True],[...],[...]]`.", "solution": "The problem presented is a valid and well-posed task in the field of materials science and photonics, specifically concerning the design of photonic crystal waveguides. The problem is scientifically grounded in Maxwell's equations and the principles of solid-state physics, such as Bloch's theorem and coupled-mode theory. It is objective, complete, and contains all necessary data and definitions for a unique solution to be derived and computed. I will therefore proceed with a complete solution.\n\nThe solution requires two key derivations followed by a numerical implementation.\n\nFirst, we must derive the dispersion relation for the guided mode in the line-defect waveguide. The problem instructs us to model the waveguide as a one-dimensional chain of coupled localized resonators with a spatial period equal to the lattice constant, $a$. Let $A_n(t)$ be the field amplitude at the $n$-th resonator. Based on the principles of coupled-mode theory for nearest-neighbor interactions, the time evolution of the amplitude at site $n$ is governed by the equation:\n$$\ni \\frac{d A_n}{dt} = \\omega_0 A_n + \\kappa (A_{n-1} + A_{n+1})\n$$\nHere, $\\omega_0$ is the resonance angular frequency of an isolated resonator, and $\\kappa$ is the coupling coefficient between adjacent resonators. The sign of $\\kappa$ depends on the physical nature of the coupling; we will assume it is absorbed into the provided parameter $t$.\n\nWe seek modal solutions, which are waves propagating along the chain. According to Bloch's theorem for a one-dimensional periodic system, such a solution must have the form $A_n(t) = A_k e^{i(k(na) - \\omega t)}$, where $k$ is the Bloch wavevector and $\\omega$ is the corresponding angular frequency. Substituting this ansatz into the coupled-mode equation yields:\n$$\ni \\left( -i\\omega \\right) A_k e^{i(kna - \\omega t)} = \\omega_0 A_k e^{i(kna - \\omega t)} + \\kappa \\left( A_k e^{i(k(n-1)a - \\omega t)} + A_k e^{i(k(n+1)a - \\omega t)} \\right)\n$$\nAfter substituting the time derivative and canceling the common factor $A_k e^{i(kna - \\omega t)}$, we obtain:\n$$\n\\omega = \\omega_0 + \\kappa \\left( e^{-ika} + e^{ika} \\right)\n$$\nUsing Euler's identity, $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, we find the dispersion relation:\n$$\n\\omega(k) = \\omega_0 + 2\\kappa \\cos(ka)\n$$\nThe problem requires this to be expressed in terms of normalized frequency, $f = \\omega a / (2\\pi c)$. We divide the equation by $2\\pi c/a$:\n$$\n\\frac{\\omega a}{2\\pi c} = \\frac{\\omega_0 a}{2\\pi c} + \\frac{2\\kappa a}{2\\pi c} \\cos(ka)\n$$\nWe are given the normalized isolated resonance frequency $f_0 = \\omega_0 a / (2\\pi c)$ and a normalized coupling parameter $t$, which is proportional to $\\kappa a / (2\\pi c)$. The standard interpretation in tight-binding models is that the provided normalized coupling $t$ corresponds to the basic hopping integral, which in our derivation is $\\kappa a/(2\\pi c)$. The factor of $2$ arises from summing over two nearest neighbors. Therefore, the dispersion relation for the defect mode, $f_{\\mathrm{def}}$, is:\n$$\nf_{\\mathrm{def}}(ka) = f_0 + 2t \\cos(ka)\n$$\n\nSecond, we derive the light-line relation, which defines the boundary for radiative loss into the cladding. A mode is guided by total internal reflection (or, in this case, confinement by the photonic bandgap) if its in-plane wavevector $k$ is larger than that of any radiation mode in the cladding at the same frequency $\\omega$. A radiation mode propagating in the cladding (refractive index $n_{\\mathrm{clad}}$) has a dispersion relation $\\omega = (c/n_{\\mathrm{clad}}) \\cdot |\\mathbf{k}_{\\mathrm{clad}}|$. For a mode to leak from the waveguide, its frequency $\\omega$ and in-plane wavevector component $k$ must be conserved. Let the waveguide axis be the $x$-direction. The cladding mode's wavevector is $\\mathbf{k}_{\\mathrm{clad}} = (k_x, k_y, k_z)$. Phase matching requires $k_x = k$. Radiative modes are those for which the out-of-plane component $k_z$ is real, which means $k_z^2 \\ge 0$. The magnitude of the cladding wavevector is $|\\mathbf{k}_{\\mathrm{clad}}|^2 = k_x^2 + k_y^2 + k_z^2$. Considering radiation propagating primarily away from the waveguide ($k_y=0$), we have $|\\mathbf{k}_{\\mathrm{clad}}|^2 = k^2 + k_z^2$.\nThe condition for a propagating wave in the cladding is thus:\n$$\n|\\mathbf{k}_{\\mathrm{clad}}|^2 - k^2 \\ge 0 \\implies \\left(\\frac{\\omega n_{\\mathrm{clad}}}{c}\\right)^2 \\ge k^2 \\implies \\omega \\ge \\frac{c k}{n_{\\mathrm{clad}}}\n$$\nThe boundary of this radiative region is the light line, $\\omega_{\\mathrm{LL}}(k) = c k / n_{\\mathrm{clad}}$. The guided mode is confined (non-leaky) if its frequency is strictly below this line, $\\omega_{\\mathrm{def}}  \\omega_{\\mathrm{LL}}$.\nIn normalized frequency units, the light line is:\n$$\nf_{\\mathrm{LL}}(ka) = \\frac{\\omega_{\\mathrm{LL}} a}{2\\pi c} = \\frac{(ck/n_{\\mathrm{clad}})a}{2\\pi c} = \\frac{ka}{2\\pi n_{\\mathrm{clad}}}\n$$\n\nWith these two equations, we can proceed to the numerical evaluation. For each test case, we will sample $M=1001$ points for the dimensionless wavevector $ka$ in the range $[0, \\pi]$. We then identify the subset of these points that fall within the high-wavevector operational window, $ka \\in [0.8\\pi, \\pi]$. Within this window, we calculate the fraction of points $\\phi$ satisfying the guiding condition $f_{\\mathrm{def}}(ka)  f_{\\mathrm{LL}}(ka)$. For these guided points, we compute the relative separation $(f_{\\mathrm{LL}} - f_{\\mathrm{def}})/f_{\\mathrm{LL}}$ and find its minimum value, $s_{\\min}$. If no points are guided, $\\phi=0$ and $s_{\\min}=0$. Finally, we compare these computed metrics against the thresholds $\\phi_{\\mathrm{req}}$ and $s_{\\mathrm{req}}$ to determine if the design passes the low-radiation-loss criterion.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the photonic crystal waveguide design problem for a suite of test cases.\n    \"\"\"\n    \n    # Test suite parameters:\n    # (a [nm], n_clad, f0, t, s_req, phi_req)\n    # The lattice constant 'a' is not needed as all calculations are dimensionless.\n    test_cases = [\n        (420, 1.44, 0.275, 0.020, 0.100, 0.950),  # Case A\n        (420, 1.44, 0.335, 0.005, 0.200, 0.900),  # Case B\n        (420, 3.10, 0.220, 0.010, 0.050, 0.500),  # Case C\n    ]\n    \n    results = []\n    \n    # Constants for the numerical evaluation\n    M = 1001  # Number of sampling points\n    alpha = 0.8  # Start of the high-wavevector window\n    \n    # Generate the dimensionless wavevector array ka from 0 to pi\n    ka_vals = np.linspace(0, np.pi, M)\n    \n    for case in test_cases:\n        a_nm, n_clad, f0, t, s_req, phi_req = case\n        \n        # 1. Compute the normalized defect-band frequency f_def(ka)\n        # f_def(ka) = f0 + 2*t*cos(ka)\n        f_def = f0 + 2 * t * np.cos(ka_vals)\n        \n        # 2. Compute the normalized light-line frequency f_ll(ka)\n        # f_ll(ka) = ka / (2*pi*n_clad)\n        f_ll = ka_vals / (2 * np.pi * n_clad)\n        \n        # 3. Define the high-wavevector operational window\n        window_mask = ka_vals >= alpha * np.pi\n        ka_window = ka_vals[window_mask]\n        f_def_window = f_def[window_mask]\n        f_ll_window = f_ll[window_mask]\n        \n        total_points_in_window = len(ka_window)\n        \n        phi = 0.0\n        s_min = 0.0\n        \n        if total_points_in_window > 0:\n            # 4. Determine the guided points within the window\n            guided_mask = f_def_window  f_ll_window\n            num_guided_points = np.sum(guided_mask)\n\n            # 5. Calculate the guided-point fraction phi\n            phi = num_guided_points / total_points_in_window\n            \n            if num_guided_points > 0:\n                # 6. Calculate the minimum relative separation s_min\n                f_def_guided = f_def_window[guided_mask]\n                f_ll_guided = f_ll_window[guided_mask]\n                \n                relative_separation = (f_ll_guided - f_def_guided) / f_ll_guided\n                s_min = np.min(relative_separation)\n            # If no guided points, phi and s_min remain 0 as per the problem statement\n        \n        # 7. Check if the low-radiation-loss criterion is met\n        is_pass = (phi >= phi_req) and (s_min >= s_req)\n        \n        # Store results for the current case\n        results.append([phi, s_min, is_pass])\n\n    # Format the final output string as specified: [[phi,s_min,pass],[...],...]\n    result_strings = []\n    for res in results:\n        phi_val, s_min_val, pass_val = res\n        # Format floats to 6 decimal places and create the string for one result\n        pass_str = str(pass_val) # 'True' or 'False'\n        result_str = f\"[{phi_val:.6f},{s_min_val:.6f},{pass_str}]\"\n        result_strings.append(result_str)\n        \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2509811"}]}