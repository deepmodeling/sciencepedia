{"hands_on_practices": [{"introduction": "The Goldschmidt tolerance factor, $t$, is the cornerstone for predicting the stability of the perovskite crystal structure. This first exercise provides essential practice by guiding you through the derivation of $t$ directly from the geometric principles of an ideal cubic lattice. By calculating the tolerance factor for a given set of ionic radii, you will develop the fundamental skill of connecting ionic size to the expected crystal symmetry and potential structural distortions. [@problem_id:2506459]", "problem": "An ideal cubic perovskite of composition $\\mathrm{ABO}_{3}$ (space group $Pm\\bar{3}m$) can be modeled by hard-sphere ionic packing where cation–anion contacts are satisfied without overlap. In this structure, the $\\mathrm{B}$ cation is octahedrally coordinated by oxygen and sits at the body center, the $\\mathrm{A}$ cation occupies the cube corners, and oxygen occupies the face centers. Using only geometric relations arising from this lattice and the definition of an ionic radius as the distance from the ion center to the point of anion–cation contact, first derive a dimensionless ratio that compares how well the $\\mathrm{A}$–O and $\\mathrm{B}$–O contact requirements can be simultaneously satisfied by a single cubic lattice parameter. This ratio is known as the Goldschmidt tolerance factor $t$ and is expressed solely in terms of $r_{A}$, $r_{B}$, and $r_{O}$.\n\nThen, for $r_{A}=1.61$ Å, $r_{B}=0.645$ Å, and $r_{O}=1.40$ Å (all radii understood as appropriate Shannon effective ionic radii for the perovskite coordination environments), evaluate $t$. Express $t$ as a pure number and round your answer to four significant figures.\n\nFinally, based on experimentally established trends of perovskite stability as a function of the magnitude of $t$ relative to $1$, provide a brief qualitative assessment of the expected structural distortions relative to the ideal cubic phase. Do not report this qualitative assessment in the final numerical answer; include it only in your reasoning.", "solution": "The problem is first validated. The givens are: an ideal cubic perovskite $\\mathrm{ABO}_{3}$ with the space group $Pm\\bar{3}m$, where the $\\mathrm{A}$ cation is at the cube corners, the $\\mathrm{B}$ cation is at the body center, and the $\\mathrm{O}$ anions are at the face centers. Ionic radii are given as $r_{A}=1.61$ Å, $r_{B}=0.645$ Å, and $r_{O}=1.40$ Å. The problem is scientifically grounded, well-posed, and objective, with all necessary data provided for a formal solution. No flaws are identified. The problem is deemed valid.\n\nThe solution proceeds in three parts as requested: derivation of the Goldschmidt tolerance factor $t$, numerical calculation of $t$, and a qualitative assessment of structural stability.\n\nFirst, we derive the Goldschmidt tolerance factor, $t$, from the geometric constraints of the ideal cubic perovskite structure, modeled as a hard-sphere packing. Let the lattice parameter of the cubic unit cell be $a$.\n\nThe $\\mathrm{B}$ cation is located at the body-center position, with coordinates $(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})a$. The $\\mathrm{O}$ anions are at the face-center positions, such as $(\\frac{1}{2}, \\frac{1}{2}, 0)a$. The distance between the $\\mathrm{B}$ cation and an adjacent $\\mathrm{O}$ anion, $d(\\mathrm{B-O})$, is along the line connecting the body center to a face center. This distance is half the lattice parameter.\n$$d(\\mathrm{B-O}) = \\frac{a}{2}$$\nIn the hard-sphere model, this contact distance is the sum of the ionic radii of the $\\mathrm{B}$ cation and the $\\mathrm{O}$ anion.\n$$d(\\mathrm{B-O}) = r_{B} + r_{O}$$\nFor perfect contact along the $\\mathrm{B-O}$ bond, these two expressions must be equal, which defines a lattice parameter $a_{\\mathrm{BO}}$ based on the $\\mathrm{B-O}$ bond length.\n$$\\frac{a_{\\mathrm{BO}}}{2} = r_{B} + r_{O} \\implies a_{\\mathrm{BO}} = 2(r_{B} + r_{O})$$\n\nNext, we consider the $\\mathrm{A}$ cation, located at a corner of the cube, for instance, at position $(0, 0, 0)a$. It is coordinated by $\\mathrm{O}$ anions at adjacent face centers, such as $(\\frac{1}{2}, \\frac{1}{2}, 0)a$. The distance between the $\\mathrm{A}$ cation and this $\\mathrm{O}$ anion, $d(\\mathrm{A-O})$, is along the face diagonal of the cube. The length of this distance is calculated using the Pythagorean theorem in three dimensions.\n$$d(\\mathrm{A-O}) = \\sqrt{\\left(\\frac{a}{2}\\right)^{2} + \\left(\\frac{a}{2}\\right)^{2} + (0)^{2}} = \\sqrt{\\frac{a^{2}}{4} + \\frac{a^{2}}{4}} = \\sqrt{\\frac{2a^{2}}{4}} = \\frac{a\\sqrt{2}}{2} = \\frac{a}{\\sqrt{2}}$$\nIn the hard-sphere model, this contact distance is the sum of the ionic radii of the $\\mathrm{A}$ cation and the $\\mathrm{O}$ anion.\n$$d(\\mathrm{A-O}) = r_{A} + r_{O}$$\nFor perfect contact along the $\\mathrm{A-O}$ bond, these two expressions for $d(\\mathrm{A-O})$ would be equal, defining a lattice parameter $a_{\\mathrm{AO}}$ based on the $\\mathrm{A-O}$ bond length.\n$$\\frac{a_{\\mathrm{AO}}}{\\sqrt{2}} = r_{A} + r_{O} \\implies a_{\\mathrm{AO}} = \\sqrt{2}(r_{A} + r_{O})$$\n\nFor an ideal cubic perovskite, both contact conditions must be satisfied simultaneously by a single lattice parameter $a$, meaning $a_{\\mathrm{BO}} = a_{\\mathrm{AO}} = a$. The Goldschmidt tolerance factor, $t$, is a dimensionless parameter that quantifies the degree of mismatch between the two ideal bond lengths. It is defined as the ratio of the $\\mathrm{A-O}$ bond distance to the space available for it within the framework defined by the $\\mathrm{B-O}$ bonds.\n$$t = \\frac{d(\\mathrm{A-O})_{\\text{ideal}}}{d(\\mathrm{A-O})_{\\text{framework}}}$$\nHere, the ideal $\\mathrm{A-O}$ distance is $r_{A} + r_{O}$. The space available within the framework, $d(\\mathrm{A-O})_{\\text{framework}}$, is the geometric distance from a corner to a face center, $\\frac{a}{\\sqrt{2}}$, where the lattice parameter $a$ is determined by the more rigid $\\mathrm{BO}_{6}$ octahedral network. Thus, we substitute $a = a_{\\mathrm{BO}} = 2(r_{B} + r_{O})$.\n$$d(\\mathrm{A-O})_{\\text{framework}} = \\frac{2(r_{B} + r_{O})}{\\sqrt{2}} = \\sqrt{2}(r_{B} + r_{O})$$\nSubstituting these expressions into the definition of $t$ gives the final derived form of the Goldschmidt tolerance factor.\n$$t = \\frac{r_{A} + r_{O}}{\\sqrt{2}(r_{B} + r_{O})}$$\nThis completes the derivation.\n\nSecond, we evaluate $t$ numerically using the provided ionic radii: $r_{A}=1.61$ Å, $r_{B}=0.645$ Å, and $r_{O}=1.40$ Å. The units of angstroms (Å) are present in both the numerator and denominator and will cancel, yielding a dimensionless quantity as required.\n$$t = \\frac{1.61 + 1.40}{\\sqrt{2}(0.645 + 1.40)}$$\n$$t = \\frac{3.01}{\\sqrt{2}(2.045)}$$\n$$t = \\frac{3.01}{2.892015...}$$\n$$t \\approx 1.04080$$\nRounding the result to four significant figures gives:\n$$t = 1.041$$\n\nFinally, we provide a qualitative assessment of the expected structural distortion. The ideal cubic perovskite structure is most stable when $t=1$. Our calculated value is $t = 1.041$, which is greater than 1. When $t > 1$, the $\\mathrm{A}$ cation is relatively too large for the cavity defined by the $\\mathrm{BO}_{6}$ octahedral framework. The $\\mathrm{A-O}$ bonds are under compressive stress, while the $\\mathrm{B-O}$ bonds are under tensile stress. To relieve this strain, the crystal structure will distort from the ideal cubic symmetry. Unlike the case for $t  1$, cooperative octahedral tilting is energetically unfavorable as it would shrink the A-site cavity. Instead, strain is often relieved by the B-cation displacing from its central position, which leads to polar distortions (ferroelectricity) and lowers the symmetry, typically to a tetragonal or orthorhombic phase. For values of $t$ significantly greater than $1$, the perovskite structure may transform into non-perovskite hexagonal phases. Given that $t=1.041$ is only slightly greater than $1$, a distortion to a lower-symmetry polar phase, such as a tetragonal perovskite structure, is expected.", "answer": "$$\\boxed{1.041}$$", "id": "2506459"}, {"introduction": "While the tolerance factor is a powerful predictive tool, it is based on a simplified hard-sphere ionic model that does not capture the full complexity of chemical bonding. This practice challenges you to think like a materials chemist and rationalize why a perovskite structure can be stable even when its tolerance factor ($t \\approx 0.80$) is far from the ideal value of $1$. You will learn to integrate concepts such as bond covalency, lattice dynamics, and the bond valence model to develop a more sophisticated understanding of structural stability. [@problem_id:2506493]", "problem": "An oxide with nominal composition $ABO_3$ is assessed using Shannon effective ionic radii and found to have a Goldschmidt tolerance factor $t \\approx 0.80$, which is typically considered borderline for the formation of a corner-sharing perovskite network. The cation charges are $A^{3+}$ and $B^{3+}$, and the compound is observed experimentally to crystallize in a distorted, tilted perovskite structure with cooperative octahedral rotations. You are asked to rationalize this stability using fundamental concepts of local bonding and lattice mechanics rather than relying on hard-sphere packing alone.\n\nThe following experimentally relevant descriptors are available for this family:\n- Pauling electronegativities: $\\chi_A \\approx 1.20$, $\\chi_B \\approx 1.83$, $\\chi_O \\approx 3.44$.\n- A representative average $B$–$O$ bond length in related octahedral oxides is $R_{B\\text{–}O} \\approx 2.00\\,\\text{\\AA}$.\n- Bond valence parameters for $B^{3+}$–$O^{2-}$: $R_0 \\approx 1.76\\,\\text{\\AA}$, $B \\approx 0.37\\,\\text{\\AA}$.\n- Infrared and Raman spectroscopy indicate a larger stretching frequency for $B$–$O$ compared to $A$–$O$ in this class: $\\omega_{B\\text{–}O} \\sim 600\\,\\text{cm}^{-1}$ and $\\omega_{A\\text{–}O} \\sim 300\\,\\text{cm}^{-1}$, with the $B$–$O$–$B$ bending mode softening relative to $B$–$O$ stretching upon tilting.\n\nAssume the usual corner-sharing octahedral connectivity for perovskites and that the sum of bond valences around each ion must approximately match its formal valence to minimize electrostatic misfit. Also assume that covalent bonds exhibit directionality that penalizes large deviations from preferred coordination geometry more than purely ionic interactions.\n\nWhich of the following statements best rationalize why a perovskite framework can remain stable at $t \\approx 0.80$ in this system? Select all that apply.\n\nA. Strong $B$–$O$ covalency and bond directionality make $B$–$O$ bonds comparatively stiff in length, so the $BO_6$ units behave as near-rigid octahedra whose cooperative rotations accommodate an undersized $A$ cation without large $B$–$O$ bond-length changes. This preserves $B$-site bond-valence sums while reducing the $A$-site cavity.\n\nB. Because $t1$, the structure eliminates octahedral tilting and instead uniformly shortens all $B$–$O$ bonds to pack the undersized $A$ cation more tightly, which is favorable since $B$–$O$ bonds are highly compressible in covalent oxides.\n\nC. The undersized $A$ increases $A$–$O$ covalency to such an extent that linear $A$–$O$–$A$ chains stabilize the perovskite lattice even if the corner-sharing $BO_6$ network breaks into isolated octahedra.\n\nD. The empirical tolerance criterion assumes isotropic, ionic hard spheres; when $B$–$O$ bonding is partially covalent and directional, the effective geometric constraints are anisotropic. The lattice preferentially lowers energy via octahedral tilts and modest $A$-site off-centering that keep both $A$- and $B$-site bond-valence sums near their formal charges, shifting the practical lower bound of $t$ to values below $0.80$ in such systems.\n\nE. Second-order Jahn–Teller off-centering at the $B$ site with a $d^0$ configuration is strictly required for the stability of any perovskite with $t \\approx 0.80$; without it, the corner-sharing network necessarily transforms to a hexagonal polytype.\n\nChoose the correct option(s).", "solution": "We begin from the core geometric and bonding definitions relevant to perovskites:\n\n- The Goldschmidt tolerance factor $t$ compares the $A$–$O$ cage size set by the $BO_6$ framework to the size of the $A$ cation and is given by\n$$\nt \\equiv \\frac{r_A + r_O}{\\sqrt{2}\\,(r_B + r_O)}.\n$$\nFor $t \\approx 1$, cubic perovskite is geometrically compatible; for $t  1$, the framework typically accommodates via cooperative octahedral tilts to reduce the $A$-site cavity while preserving $B$–$O$ bond lengths.\n\n- The bond valence model connects bond length $R$ to bond valence $s$ via\n$$\ns(R) = \\exp\\!\\left(\\frac{R_0 - R}{B}\\right),\n$$\nwith the requirement that the sum around each site matches its formal valence to minimize electrostatic and covalent mismatch. For $B^{3+}$ in an octahedron, the target sum is $+3$, so the average per bond is approximately $+0.5$.\n\n- Pauling’s concept relates electronegativity difference $\\Delta \\chi$ to ionicity; smaller $\\Delta \\chi$ implies more covalency and thus stronger directionality and angular preferences in the bonding network.\n\n- Lattice mechanics of corner-sharing $BO_6$ networks allows low-energy “rigid unit modes,” in which octahedra rotate as nearly rigid bodies, keeping $B$–$O$ bond lengths approximately constant while adjusting $B$–$O$–$B$ angles and the $A$-site cage.\n\nQuantifying octahedral rigidity via bond valence stiffness. Using the supplied parameters for $B^{3+}$–$O^{2-}$,\n$$\nR_0 \\approx 1.76\\,\\text{\\AA}, \\quad B \\approx 0.37\\,\\text{\\AA},\n$$\nevaluate the bond valence at a representative $B$–$O$ distance $R_{B\\text{–}O} \\approx 2.00\\,\\text{\\AA}$:\n$$\ns\\!\\left(2.00\\,\\text{\\AA}\\right) = \\exp\\!\\left(\\frac{1.76 - 2.00}{0.37}\\right) = \\exp\\!\\left(-\\frac{0.24}{0.37}\\right) \\approx \\exp(-0.6486) \\approx 0.523.\n$$\nSix such bonds would sum to approximately\n$$\n6 \\times 0.523 \\approx 3.14,\n$$\nwhich is close to the required $+3$ at the $B$ site and within the tolerance expected for a distorted perovskite.\n\nThe sensitivity of $s$ to $R$ is\n$$\n\\frac{ds}{dR} = -\\frac{1}{B}\\,\\exp\\!\\left(\\frac{R_0 - R}{B}\\right) = -\\frac{s}{B}.\n$$\nAt $R \\approx 2.00\\,\\text{\\AA}$, with $s \\approx 0.523$ and $B \\approx 0.37\\,\\text{\\AA}$,\n$$\n\\frac{ds}{dR} \\approx -\\frac{0.523}{0.37}\\,\\text{\\AA}^{-1} \\approx -1.41\\,\\text{\\AA}^{-1}.\n$$\nThus a modest uniform shortening of the $B$–$O$ bond by $\\Delta R \\approx 0.05\\,\\text{\\AA}$ would change each bond valence by\n$$\n\\Delta s \\approx \\left(-1.41\\,\\text{\\AA}^{-1}\\right)\\times \\left(-0.05\\,\\text{\\AA}\\right) \\approx +0.070,\n$$\nleading to an overbonding at the $B$ site of about\n$$\n6 \\times 0.070 \\approx 0.42,\n$$\nthat is, a bond-valence sum of approximately $+3.56$, which is energetically unfavorable. This steep response indicates that $B$–$O$ bond lengths are stiff with respect to uniform compression, i.e., the octahedra are effectively rigid in bond length.\n\nCovalency and directionality. The electronegativity differences are\n$$\n\\Delta \\chi_{B\\text{–}O} = \\chi_O - \\chi_B \\approx 3.44 - 1.83 = 1.61,\n$$\n$$\n\\Delta \\chi_{A\\text{–}O} = \\chi_O - \\chi_A \\approx 3.44 - 1.20 = 2.24.\n$$\nA smaller $\\Delta \\chi_{B\\text{–}O}$ than $\\Delta \\chi_{A\\text{–}O}$ implies $B$–$O$ bonds are more covalent and directional than $A$–$O$. Directional covalent bonds favor maintaining near-optimal $B$–$O$ bond lengths and local octahedral geometry. Spectroscopic evidence of higher $B$–$O$ stretching frequency,\n$$\n\\omega_{B\\text{–}O} \\sim 600\\,\\text{cm}^{-1} \\gg \\omega_{A\\text{–}O} \\sim 300\\,\\text{cm}^{-1},\n$$\nfurther supports a larger force constant for $B$–$O$ stretching relative to $A$–$O$, reinforcing the picture of rigid $BO_6$ units.\n\nAccommodation at small $t$. When $t \\approx 0.80$, the $A$-site is undersized relative to the ideal cubic cage. The lattice can lower its energy by cooperative octahedral tilts that reduce the $A$-site cavity without significantly changing $B$–$O$ bond lengths. These tilts predominantly adjust $B$–$O$–$B$ angles, which is less costly than compressing $B$–$O$ bonds because bending involves softer modes than stretching (consistent with the observed softening of $B$–$O$–$B$ bending modes). Because the $A$–$O$ interactions are more ionic and softer, modest $A$-site off-centering can further tune bond-valence sums without compromising the integrity of the $BO_6$ network.\n\nImplications for the tolerance factor. The standard tolerance factor treats ions as isotropic hard spheres. In systems with significant $B$–$O$ covalency and directional bonding, the effective size and shape constraints deviate from this idealization, and the network’s ability to accommodate undersized $A$ cations via rotations and $A$-site displacements expands the range of $t$ that still permits a perovskite.\n\nOption-by-option analysis:\n\nA. This option accurately captures three key points grounded in the above analysis: ($i$) $B$–$O$ bonds are stiff in length due to covalency and bond-valence constraints, ($ii$) $BO_6$ octahedra behave as near-rigid units, and ($iii$) cooperative tilts shrink the $A$-site cage while preserving $B$–$O$ bond lengths and $B$-site bond-valence sums. This is consistent with the quantitative bond-valence stiffness estimate and the spectroscopic evidence. Verdict: Correct.\n\nB. This proposes eliminating tilts and uniformly shortening $B$–$O$ bonds, which contradicts both the geometric mechanism known to accommodate $t1$ and the calculated bond-valence stiffness showing that uniform $B$–$O$ compression causes severe overbonding at the $B$ site. The spectroscopic indication of stiff $B$–$O$ stretching also argues against this pathway. Verdict: Incorrect.\n\nC. This suggests stabilization via linear $A$–$O$–$A$ chains and breaking the $BO_6$ network into isolated octahedra. Perovskite stability relies on a corner-sharing $BO_6$ network, not isolated units; moreover, $A$–$O$ bonding is more ionic and less directional than $B$–$O$, as indicated by the larger $\\Delta \\chi_{A\\text{–}O}$. There is no mechanism by which $A$–$O$ linear chains would supplant the corner-sharing network to stabilize perovskite topology. Verdict: Incorrect.\n\nD. This option correctly identifies the limitation of the hard-sphere tolerance model and emphasizes that partial covalency and directionality lead to anisotropic constraints and alternative low-energy accommodation modes: octahedral tilts and modest $A$-site off-centering that maintain bond-valence sums. This is consistent with the bond-valence analysis, the role of bending versus stretching stiffness, and the empirical observation that some systems form perovskites at $t$ below the canonical lower bound. Verdict: Correct.\n\nE. While second-order Jahn–Teller off-centering at $B$ with a $d^0$ configuration can stabilize perovskites and induce ferroelectricity in some cases, it is not strictly required for perovskite stability at $t \\approx 0.80$. Many orthorhombic rare-earth ferrites with $B^{3+}$ high-spin $d^5$ (not $d^0$) remain perovskites at $t \\approx 0.80\\text{–}0.83$ via octahedral tilting, without $B$-site off-centering. The assertion of necessity and the inevitability of hexagonal polytypes are both incorrect. Verdict: Incorrect.\n\nTherefore, the correct rationalizations are A and D.", "answer": "$$\\boxed{AD}$$", "id": "2506493"}, {"introduction": "Modern materials science increasingly relies on data-driven methods to discover and design new materials. This final practice bridges the gap between traditional crystal chemistry rules and computational materials informatics. You will implement and benchmark several stability descriptors, including the tolerance factor and a more advanced bond-valence-based metric, against a dataset of known compounds, using a standard cross-validation technique to assess their predictive power. [@problem_id:2506478]", "problem": "You are given a binary classification task grounded in crystal chemistry of perovskites. A perovskite of nominal stoichiometry $\\mathrm{ABO_3}$ can often be rationalized using ionic packing arguments and bond-valence constraints. You must implement, from first principles, a benchmarking program that compares three scalar descriptors for their ability to classify a small dataset of $\\mathrm{ABO_3}$ compositions as perovskite-forming or non-perovskite-forming.\n\nStart from the following foundational bases:\n\n- Hard-sphere contact geometry for the ideal cubic perovskite structure $\\mathrm{ABO_3}$ with $A$ cations at the cube corners, $B$ cations at the body center, and oxygen anions at the face centers. In an idealized picture, the $\\mathrm{B}\\text{-}\\mathrm{O}$ sublattice forms corner-sharing octahedra that set the cubic lattice parameter.\n- Ionic radii in angstroms (International System of Units unit for length $\\mathrm{\\AA}$) for cations and anions dependent on coordination number, and formal oxidation states for charge balance.\n- Brown’s bond valence model, where a single $\\mathrm{A}\\text{-}\\mathrm{O}$ bond valence $s$ is given by $s = \\exp\\!\\left((R_0 - R)/b\\right)$ with $R$ the bond length in $\\mathrm{\\AA}$, $R_0$ an empirical parameter in $\\mathrm{\\AA}$ characteristic of the cation–anion pair and oxidation state, and $b$ a softening parameter in $\\mathrm{\\AA}$. The bond valence sum at a site is the sum of bond valences to that site.\n\nYour program must, for each composition, compute three descriptors:\n\n- Descriptor $t$: a purely geometric packing measure derived from the ideal cubic perovskite contact conditions using a single anion radius for both $\\mathrm{A}\\text{-}\\mathrm{O}$ and $\\mathrm{B}\\text{-}\\mathrm{O}$ contacts.\n- Descriptor $t'$: a variant of the geometric packing measure that distinguishes anion size by coordination, using a $12$-fold anion radius for $\\mathrm{A}\\text{-}\\mathrm{O}$ and a $6$-fold anion radius for $\\mathrm{B}\\text{-}\\mathrm{O}$.\n- Descriptor $D_{\\mathrm{BV}}$: a bond-valence mismatch computed by enforcing the $\\mathrm{B}\\text{-}\\mathrm{O}$ distance from the octahedral network and quantifying the deviation of the $\\mathrm{A}$-site bond valence sum from its formal oxidation state, using Brown’s exponential relation with a fixed $b$ and cation-specific $R_0$ calibrated at the $\\mathrm{A}$-site’s reference coordination.\n\nDerive every formula you use from these bases in your implementation and in your reasoning. Do not use any externally provided “shortcut” formulas beyond these bases.\n\nConstants to use:\n\n- Oxygen anion radii: $r_{\\mathrm{O}}^{(\\mathrm{VI})} = 1.40\\,\\mathrm{\\AA}$ and $r_{\\mathrm{O}}^{(\\mathrm{XII})} = 1.44\\,\\mathrm{\\AA}$.\n- Brown’s softening parameter: $b = 0.37\\,\\mathrm{\\AA}$.\n\nCation radii are given below and must be used as provided in $\\mathrm{\\AA}$; subscripts denote coordination number: $r_{\\mathrm{A}}^{(\\mathrm{XII})}$ for $\\mathrm{A}$-site and $r_{\\mathrm{B}}^{(\\mathrm{VI})}$ for $\\mathrm{B}$-site.\n\nYou must benchmark the three descriptors by classification accuracy using leave-one-out cross-validation (LOOCV) on the dataset provided below. For each fold and for each descriptor independently:\n\n1. Using the training subset (all but the held-out composition), determine an optimal scalar threshold $\\theta$ and a polarity $p \\in \\{\\text{predict perovskite if } x \\le \\theta,\\ \\text{predict perovskite if } x \\ge \\theta\\}$ that maximize training accuracy. To do this, evaluate candidate thresholds taken as midpoints between sorted distinct training descriptor values, and include two sentinel thresholds strictly below the minimum and strictly above the maximum training values. For each candidate threshold, evaluate both polarities and select the combination with the highest training accuracy. If there is a tie in accuracy, break ties by choosing the smaller threshold; if still tied, choose the polarity that yields the larger true positive rate (fraction of perovskites correctly identified among those labeled perovskite in the training set); if still tied, choose the polarity “predict perovskite if $x \\le \\theta$.”\n2. Apply the selected threshold and polarity to the held-out sample to produce a predicted class.\n\nCompute the LOOCV accuracy for each descriptor as the fraction of correctly predicted labels across all folds. Express each accuracy as a decimal number rounded to three decimal places.\n\nDataset (each entry is $(\\text{name}, r_{\\mathrm{A}}^{(\\mathrm{XII})}\\ \\mathrm{\\AA}, V_{\\mathrm{A}}, r_{\\mathrm{B}}^{(\\mathrm{VI})}\\ \\mathrm{\\AA}, V_{\\mathrm{B}}, \\text{label})$, where label $= 1$ for perovskite-forming and $= 0$ otherwise):\n\n- $\\left(\\mathrm{SrTiO_3},\\ 1.44,\\ 2,\\ 0.605,\\ 4,\\ 1\\right)$\n- $\\left(\\mathrm{BaTiO_3},\\ 1.61,\\ 2,\\ 0.605,\\ 4,\\ 1\\right)$\n- $\\left(\\mathrm{CaTiO_3},\\ 1.34,\\ 2,\\ 0.605,\\ 4,\\ 1\\right)$\n- $\\left(\\mathrm{LaAlO_3},\\ 1.36,\\ 3,\\ 0.535,\\ 3,\\ 1\\right)$\n- $\\left(\\mathrm{KNbO_3},\\ 1.64,\\ 1,\\ 0.64,\\ 5,\\ 1\\right)$\n- $\\left(\\mathrm{NaNbO_3},\\ 1.39,\\ 1,\\ 0.64,\\ 5,\\ 1\\right)$\n- $\\left(\\mathrm{CaZrO_3},\\ 1.34,\\ 2,\\ 0.72,\\ 4,\\ 1\\right)$\n- $\\left(\\mathrm{LiNbO_3},\\ 1.18,\\ 1,\\ 0.64,\\ 5,\\ 0\\right)$\n- $\\left(\\mathrm{LiTaO_3},\\ 1.18,\\ 1,\\ 0.64,\\ 5,\\ 0\\right)$\n- $\\left(\\mathrm{YMnO_3},\\ 1.28,\\ 3,\\ 0.645,\\ 3,\\ 0\\right)$\n- $\\left(\\mathrm{ScFeO_3},\\ 1.16,\\ 3,\\ 0.645,\\ 3,\\ 0\\right)$\n- $\\left(\\mathrm{LuFeO_3},\\ 1.17,\\ 3,\\ 0.645,\\ 3,\\ 0\\right)$\n\nMathematical and algorithmic requirements and definitions that must be respected:\n\n- Use the hard-sphere ideal cubic perovskite argument to relate the ideal $\\mathrm{B}\\text{-}\\mathrm{O}$ distance to the cubic lattice parameter, and the ideal $\\mathrm{A}\\text{-}\\mathrm{O}$ distance to the same lattice parameter. From these relations, construct descriptor $t$ without inserting any empirical correction beyond the single anion radius $r_{\\mathrm{O}}^{(\\mathrm{VI})}$.\n- Construct descriptor $t'$ identically except that for the $\\mathrm{A}\\text{-}\\mathrm{O}$ contact you must use $r_{\\mathrm{O}}^{(\\mathrm{XII})}$ while maintaining $r_{\\mathrm{O}}^{(\\mathrm{VI})}$ for the $\\mathrm{B}\\text{-}\\mathrm{O}$ contact.\n- For the bond-valence mismatch descriptor $D_{\\mathrm{BV}}$:\n  - Take the ideal octahedral framework to fix the $\\mathrm{B}\\text{-}\\mathrm{O}$ distance $R_{\\mathrm{B}\\text{-}\\mathrm{O}}$ from hard-sphere contact using $r_{\\mathrm{B}}^{(\\mathrm{VI})}$ and $r_{\\mathrm{O}}^{(\\mathrm{VI})}$.\n  - From the ideal geometry, infer the corresponding $\\mathrm{A}\\text{-}\\mathrm{O}$ distance $R_{\\mathrm{A}\\text{-}\\mathrm{O}}$ that is enforced by the $\\mathrm{B}\\text{-}\\mathrm{O}$ network.\n  - Calibrate $R_0$ for the $\\mathrm{A}\\text{-}\\mathrm{O}$ cation–anion pair and oxidation state by taking a $12$-fold reference environment with contact distance $R_{\\mathrm{ref},\\mathrm{A}} = r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}$ and equal-bond partitioning $s_{\\mathrm{ref},\\mathrm{A}} = V_{\\mathrm{A}}/12$, and set $R_{0,\\mathrm{A}\\text{-}\\mathrm{O}} = R_{\\mathrm{ref},\\mathrm{A}} + b \\ln\\!\\left(s_{\\mathrm{ref},\\mathrm{A}}\\right)$ so that Brown’s formula reproduces $s_{\\mathrm{ref},\\mathrm{A}}$ at $R_{\\mathrm{ref},\\mathrm{A}}$.\n  - Compute the $\\mathrm{A}$-site bond valence sum under the enforced $R_{\\mathrm{A}\\text{-}\\mathrm{O}}$ as $S_{\\mathrm{A}} = 12 \\exp\\!\\left((R_{0,\\mathrm{A}\\text{-}\\mathrm{O}} - R_{\\mathrm{A}\\text{-}\\mathrm{O}})/b\\right)$ and define $D_{\\mathrm{BV}} = \\left|S_{\\mathrm{A}} - V_{\\mathrm{A}}\\right|$.\n- All distances must be treated in $\\mathrm{\\AA}$. The final reported accuracies are unitless decimals.\n\nTest suite and output specification:\n\n- Apply leave-one-out cross-validation exactly as specified above on the provided dataset for each of the three descriptors separately.\n- Your program should produce a single line of output containing the three LOOCV accuracies in the order $\\left[t,\\ t',\\ D_{\\mathrm{BV}}\\right]$, rounded to three decimal places, as a comma-separated list enclosed in square brackets, for example $\\left[0.917,0.917,0.833\\right]$ if those were the results.\n\nYour program must be self-contained, require no input, and follow the exact output format.", "solution": "The problem presented is a well-defined task in computational materials chemistry, requiring the implementation and benchmarking of three distinct scalar descriptors for perovskite stability. The problem is scientifically grounded in established principles of crystal chemistry—specifically, the hard-sphere model for ionic packing and the bond valence model for chemical bonding. It is algorithmically rigorous, providing a complete set of data, constants, and a detailed procedure for leave-one-out cross-validation (LOOCV), including unambiguous tie-breaking rules. Therefore, the problem is deemed valid and a full solution shall be provided.\n\nThe solution is structured as follows: First, we derive the mathematical expressions for the three descriptors ($t$, $t'$, and $D_{\\mathrm{BV}}$) from the first principles given. Second, we formalize the LOOCV benchmarking procedure, including the method for determining the optimal classification threshold.\n\n### Derivation of Descriptors\n\nThe geometry of an ideal cubic perovskite $\\mathrm{ABO_3}$ provides the foundation. In a cube with lattice parameter $a$, the B-cation at the body center and O-anions at the face centers form a network of corner-sharing octahedra. The A-cation resides at the cube corners, coordinated by $12$ oxygen anions.\n\nThe bond lengths are geometrically constrained:\n-   The B-O bond length, connecting the body center to a face center, is $R_{\\mathrm{B}\\text{-}\\mathrm{O}} = a/2$.\n-   The A-O bond length, connecting a corner to an adjacent face center, is $R_{\\mathrm{A}\\text{-}\\mathrm{O}} = a/\\sqrt{2}$.\n\nFrom these relationships, we derive the descriptors.\n\n**1. Descriptor $t$ (Goldschmidt-type Tolerance Factor)**\n\nThis descriptor is a geometric packing ratio. We assume hard-sphere contact for both A-O and B-O bonds. The B-O octahedra are assumed to define the lattice parameter $a$.\nIdeal B-O contact implies $R_{\\mathrm{B}\\text{-}\\mathrm{O}} = r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}$, where $r_{\\mathrm{B}}^{(\\mathrm{VI})}$ is the ionic radius of the B-cation in $6$-fold coordination and $r_{\\mathrm{O}}$ is the oxygen anion radius.\nFrom this, the lattice parameter is $a = 2 R_{\\mathrm{B}\\text{-}\\mathrm{O}} = 2(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}})$.\n\nThe space available for the A-O bond is geometrically fixed at $R_{\\mathrm{A}\\text{-}\\mathrm{O, geom}} = a/\\sqrt{2}$. Substituting the expression for $a$:\n$$R_{\\mathrm{A}\\text{-}\\mathrm{O, geom}} = \\frac{2(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}})}{\\sqrt{2}} = \\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}})$$\n\nThe ideal A-O bond length, assuming hard-sphere contact, is $R_{\\mathrm{A}\\text{-}\\mathrm{O, ideal}} = r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}$, where $r_{\\mathrm{A}}^{(\\mathrm{XII})}$ is the radius for the A-cation in $12$-fold coordination.\n\nThe tolerance factor $t$ is the ratio of the ideal A-O length to the geometric space available for it:\n$$t = \\frac{R_{\\mathrm{A}\\text{-}\\mathrm{O, ideal}}}{R_{\\mathrm{A}\\text{-}\\mathrm{O, geom}}} = \\frac{r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}}{\\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}})}$$\nThe problem specifies using a single anion radius, which, given the context, is logically the radius for the coordinating octahedra, $r_{\\mathrm{O}} = r_{\\mathrm{O}}^{(\\mathrm{VI})} = 1.40\\,\\mathrm{\\AA}$.\n$$t = \\frac{r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{VI})}}{\\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})}$$\n\n**2. Descriptor $t'$ (Coordination-Corrected Tolerance Factor)**\n\nThis descriptor is a refinement of $t$ that accounts for the different coordination environments of the anion.\n-   For the B-O bond (O is $2$-coordinate with respect to B, but O itself is in a distorted $6$-coordinate site, while B is $6$-coordinate), we use $r_{\\mathrm{O}}^{(\\mathrm{VI})} = 1.40\\,\\mathrm{\\AA}$.\n-   For the A-O bond (A is $12$-coordinate), we use $r_{\\mathrm{O}}^{(\\mathrm{XII})} = 1.44\\,\\mathrm{\\AA}$.\n\nThe lattice parameter is still set by the B-O framework: $a = 2(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})$.\nThe geometric A-O distance remains $R_{\\mathrm{A}\\text{-}\\mathrm{O, geom}} = \\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})$.\nThe ideal A-O bond length, however, now uses the coordination-specific anion radius: $R_{\\mathrm{A}\\text{-}\\mathrm{O, ideal}}' = r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}$.\n\nThe descriptor $t'$ is then:\n$$t' = \\frac{R_{\\mathrm{A}\\text{-}\\mathrm{O, ideal}}'}{R_{\\mathrm{A}\\text{-}\\mathrm{O, geom}}} = \\frac{r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}}{\\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})}$$\n\n**3. Descriptor $D_{\\mathrm{BV}}$ (Bond-Valence Mismatch)**\n\nThis descriptor quantifies the strain on the A-site cation from a bond-valence perspective.\nFirst, we establish the enforced A-O bond length, $R_{\\mathrm{A}\\text{-}\\mathrm{O}}$, from the rigid octahedral framework assumption.\n$$R_{\\mathrm{B}\\text{-}\\mathrm{O}} = r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})}$$\n$$R_{\\mathrm{A}\\text{-}\\mathrm{O}} = \\sqrt{2}\\,R_{\\mathrm{B}\\text{-}\\mathrm{O}} = \\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})$$\n\nNext, we use Brown's bond valence model, $s = \\exp((R_0 - R)/b)$, where $s$ is the valence of a bond of length $R$. The parameters $R_0$ and $b$ are empirical. $b$ is given as $0.37\\,\\mathrm{\\AA}$. We must calibrate $R_{0,\\mathrm{A}\\text{-}\\mathrm{O}}$ for the A-O pair.\nCalibration is performed in a hypothetical, ideal reference environment for the A-cation: $12$-fold coordination. Here, the bond valence is equally distributed, $s_{\\mathrm{ref},\\mathrm{A}} = V_{\\mathrm{A}}/12$, where $V_{\\mathrm{A}}$ is the formal oxidation state. The reference bond length is the sum of ionic radii, $R_{\\mathrm{ref},\\mathrm{A}} = r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}$.\nWe require that at this reference length, the formula yields the reference valence:\n$$s_{\\mathrm{ref},\\mathrm{A}} = \\exp\\left(\\frac{R_{0,\\mathrm{A}\\text{-}\\mathrm{O}} - R_{\\mathrm{ref},\\mathrm{A}}}{b}\\right)$$\nSolving for $R_{0,\\mathrm{A}\\text{-}\\mathrm{O}}$:\n$$R_{0,\\mathrm{A}\\text{-}\\mathrm{O}} = R_{\\mathrm{ref},\\mathrm{A}} + b \\ln(s_{\\mathrm{ref},\\mathrm{A}}) = (r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}) + b \\ln(V_{\\mathrm{A}}/12)$$\n\nWith the calibrated $R_{0,\\mathrm{A}\\text{-}\\mathrm{O}}$ and the enforced distance $R_{\\mathrm{A}\\text{-}\\mathrm{O}}$, we compute the bond valence sum at the A-site. In the ideal cubic cell, all $12$ A-O bonds are equivalent.\n$$S_{\\mathrm{A}} = \\sum_{i=1}^{12} s_i = 12 \\exp\\left(\\frac{R_{0,\\mathrm{A}\\text{-}\\mathrm{O}} - R_{\\mathrm{A}\\text{-}\\mathrm{O}}}{b}\\right)$$\nSubstituting the expressions for $R_{0,\\mathrm{A}\\text{-}\\mathrm{O}}$ and $R_{\\mathrm{A}\\text{-}\\mathrm{O}}$:\n$$S_{\\mathrm{A}} = 12 \\exp\\left( \\frac{ [(r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}) + b \\ln(V_{\\mathrm{A}}/12)] - [\\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})] }{b} \\right)$$\n$$S_{\\mathrm{A}} = 12 \\cdot \\exp(\\ln(V_{\\mathrm{A}}/12)) \\cdot \\exp\\left( \\frac{(r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}) - \\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})}{b} \\right)$$\n$$S_{\\mathrm{A}} = V_{\\mathrm{A}} \\exp\\left( \\frac{(r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}) - \\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})}{b} \\right)$$\n\nThe descriptor $D_{\\mathrm{BV}}$ is the magnitude of the deviation of this sum from the expected formal valence $V_{\\mathrm{A}}$:\n$$D_{\\mathrm{BV}} = |S_{\\mathrm{A}} - V_{\\mathrm{A}}|$$\n\n### Benchmarking via Leave-One-Out Cross-Validation (LOOCV)\n\nThe classification performance of each descriptor is assessed using LOOCV on the provided dataset of $N=12$ compounds. For each of the $N$ folds:\n1.  One compound is held out as the test set; the remaining $N-1$ compounds form the training set.\n2.  For each descriptor ($t$, $t'$, $D_{\\mathrm{BV}}$) independently, an optimal 1D classifier is trained on the training set.\n3.  The classifier consists of a threshold $\\theta$ and a polarity $p$, where $p$ determines whether values below or above $\\theta$ are classified as perovskite (label $1$).\n4.  To find the optimal $(\\theta, p)$, we test a set of candidate thresholds. These are the midpoints between adjacent unique descriptor values in the sorted training set, plus two sentinel thresholds, one below the minimum value and one above the maximum.\n5.  For each candidate $\\theta$, both polarities ($p \\in \\{\\text{predict } 1 \\text{ if } x \\le \\theta, \\text{predict } 1 \\text{ if } x \\ge \\theta\\}$) are evaluated. The combination $(\\theta, p)$ that maximizes classification accuracy on the training set is chosen.\n6.  Ties are broken systematically:\n    a.  Select the candidate(s) with the highest accuracy.\n    b.  From these, select the one(s) with the smallest threshold value $\\theta$.\n    c.  From these, select the one(s) with the largest true positive rate (TPR) on the training set.\n    d.  If a tie persists, the polarity \"predict perovskite if $x \\le \\theta$\" is chosen.\n7.  The optimal classifier $(\\theta, p)$ is then used to predict the class of the held-out test compound.\n8.  The LOOCV accuracy for each descriptor is the total number of correct predictions across all $N$ folds, divided by $N$.\n\nThis procedure ensures a deterministic and reproducible evaluation of each descriptor's predictive power. The following program implements these derivations and the specified validation protocol.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the full validation and benchmarking of three perovskite stability descriptors.\n    \"\"\"\n\n    # --- Constants ---\n    R_O_VI = 1.40  # Oxygen radius in 6-fold coordination (Angstrom)\n    R_O_XII = 1.44 # Oxygen radius in 12-fold coordination (Angstrom)\n    B_BVM = 0.37   # Brown's softening parameter (Angstrom)\n    SQRT2 = np.sqrt(2)\n\n    # --- Dataset ---\n    # (name, r_A(XII), V_A, r_B(VI), V_B, label)\n    # label=1: perovskite, label=0: non-perovskite\n    dataset = [\n        ('SrTiO3', 1.44, 2, 0.605, 4, 1),\n        ('BaTiO3', 1.61, 2, 0.605, 4, 1),\n        ('CaTiO3', 1.34, 2, 0.605, 4, 1),\n        ('LaAlO3', 1.36, 3, 0.535, 3, 1),\n        ('KNbO3', 1.64, 1, 0.64, 5, 1),\n        ('NaNbO3', 1.39, 1, 0.64, 5, 1),\n        ('CaZrO3', 1.34, 2, 0.72, 4, 1),\n        ('LiNbO3', 1.18, 1, 0.64, 5, 0),\n        ('LiTaO3', 1.18, 1, 0.64, 5, 0),\n        ('YMnO3', 1.28, 3, 0.645, 3, 0),\n        ('ScFeO3', 1.16, 3, 0.645, 3, 0),\n        ('LuFeO3', 1.17, 3, 0.645, 3, 0),\n    ]\n\n    # --- Descriptor Calculation Functions ---\n\n    def calculate_t(r_A_XII, V_A, r_B_VI, V_B):\n        # t = (r_A_XII + r_O_VI) / (sqrt(2) * (r_B_VI + r_O_VI))\n        num = r_A_XII + R_O_VI\n        den = SQRT2 * (r_B_VI + R_O_VI)\n        return num / den\n\n    def calculate_t_prime(r_A_XII, V_A, r_B_VI, V_B):\n        # t' = (r_A_XII + r_O_XII) / (sqrt(2) * (r_B_VI + r_O_VI))\n        num = r_A_XII + R_O_XII\n        den = SQRT2 * (r_B_VI + R_O_VI)\n        return num / den\n\n    def calculate_d_bv(r_A_XII, V_A, r_B_VI, V_B):\n        # S_A = V_A * exp(((r_A_XII + r_O_XII) - sqrt(2)*(r_B_VI + r_O_VI)) / b)\n        # D_BV = |S_A - V_A|\n        exponent_num = (r_A_XII + R_O_XII) - SQRT2 * (r_B_VI + R_O_VI)\n        S_A = V_A * np.exp(exponent_num / B_BVM)\n        return np.abs(S_A - V_A)\n    \n    descriptor_funcs = [calculate_t, calculate_t_prime, calculate_d_bv]\n    num_samples = len(dataset)\n    \n    # Pre-calculate all descriptors for the full dataset\n    all_labels = np.array([d[5] for d in dataset])\n    all_descriptors = []\n    for func in descriptor_funcs:\n        values = np.array([func(d[1], d[2], d[3], d[4]) for d in dataset])\n        all_descriptors.append(values)\n\n    loocv_accuracies = []\n\n    # --- Benchmarking Logic ---\n    \n    def train_classifier(train_x, train_y):\n        sorted_unique_x = sorted(list(set(train_x)))\n        \n        # Generate candidate thresholds\n        thresholds = []\n        if len(sorted_unique_x) > 0:\n            thresholds.append(sorted_unique_x[0] - 1.0) # Sentinel min\n            thresholds.append(sorted_unique_x[-1] + 1.0) # Sentinel max\n        if len(sorted_unique_x) > 1:\n            for i in range(len(sorted_unique_x) - 1):\n                thresholds.append((sorted_unique_x[i] + sorted_unique_x[i+1]) / 2.0)\n        \n        num_positives_in_train = np.sum(train_y)\n        \n        candidates = []\n        for theta in thresholds:\n            # Polarity p=0 (predict 1 if x = theta)\n            preds_p0 = (train_x = theta).astype(int)\n            acc_p0 = np.mean(preds_p0 == train_y)\n            tp_p0 = np.sum((preds_p0 == 1)  (train_y == 1))\n            tpr_p0 = tp_p0 / num_positives_in_train if num_positives_in_train > 0 else 0\n            candidates.append({'acc': acc_p0, 'theta': theta, 'tpr': tpr_p0, 'pol': 0})\n            \n            # Polarity p=1 (predict 1 if x >= theta)\n            preds_p1 = (train_x >= theta).astype(int)\n            acc_p1 = np.mean(preds_p1 == train_y)\n            tp_p1 = np.sum((preds_p1 == 1)  (train_y == 1))\n            tpr_p1 = tp_p1 / num_positives_in_train if num_positives_in_train > 0 else 0\n            candidates.append({'acc': acc_p1, 'theta': theta, 'tpr': tpr_p1, 'pol': 1})\n\n        # Apply tie-breaking rules by sorting\n        # 1. Higher accuracy (-acc)\n        # 2. Smaller threshold (theta)\n        # 3. Higher TPR (-tpr)\n        # 4. Polarity 'predict if = theta' (pol=0)\n        best = sorted(candidates, key=lambda c: (-c['acc'], c['theta'], -c['tpr'], c['pol']))[0]\n        \n        return best['theta'], best['pol']\n\n    def predict(x, theta, polarity):\n        if polarity == 0: # predict 1 if x = theta\n            return 1 if x = theta else 0\n        else: # polarity == 1, predict 1 if x >= theta\n            return 1 if x >= theta else 0\n\n    # Main LOOCV loop\n    for descriptor_values in all_descriptors:\n        correct_predictions = 0\n        for i in range(num_samples):\n            # Split data for LOOCV\n            train_mask = np.ones(num_samples, dtype=bool)\n            train_mask[i] = False\n            \n            train_x = descriptor_values[train_mask]\n            train_y = all_labels[train_mask]\n            \n            test_x = descriptor_values[i]\n            test_y = all_labels[i]\n            \n            # Train and predict\n            theta, polarity = train_classifier(train_x, train_y)\n            prediction = predict(test_x, theta, polarity)\n            \n            if prediction == test_y:\n                correct_predictions += 1\n        \n        accuracy = correct_predictions / num_samples\n        loocv_accuracies.append(accuracy)\n\n    # Format and print the final result\n    formatted_accuracies = [f\"{acc:.3f}\" for acc in loocv_accuracies]\n    print(f\"[{','.join(formatted_accuracies)}]\")\n\nsolve()\n```", "id": "2506478"}]}