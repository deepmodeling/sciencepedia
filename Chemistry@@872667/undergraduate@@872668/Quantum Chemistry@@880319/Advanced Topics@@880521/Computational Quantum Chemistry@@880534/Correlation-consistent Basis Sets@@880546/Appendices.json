{"hands_on_practices": [{"introduction": "A crucial first step in any quantum chemical calculation is selecting a basis set, a choice that directly balances the desired accuracy against computational expense. The cost of a calculation scales steeply with the number of basis functions. This exercise will give you a concrete understanding of this relationship by having you calculate the total number of basis functions for a water molecule using three different correlation-consistent basis sets. By manually counting the functions, you will see firsthand how the size, and thus the computational demand, grows as we move up the cc-pVXZ ladder from double-zeta to quadruple-zeta quality. [@problem_id:1362299]", "problem": "In modern computational chemistry, the choice of a basis set is a crucial step that balances accuracy against computational cost. The correlation-consistent polarized Valence X-Zeta (cc-pVXZ) basis sets, developed by Dunning and coworkers, provide a systematic way to approach the complete basis set limit.\n\nA student is performing a series of calculations on a single water molecule ($\\text{H}_2\\text{O}$). They plan to use three different basis sets from this family: `cc-pVDZ` (X=2), `cc-pVTZ` (X=3), and `cc-pVQZ` (X=4). To estimate the computational resources required, they need to determine the total number of atomic basis functions for the molecule with each basis set.\n\nThe compositions of these basis sets for Hydrogen and Oxygen are given in the contracted notation `[ns, mp, ld, ...]`, which specifies the number of contracted functions of each angular momentum type.\n\n- For `cc-pVDZ`:\n  - Hydrogen (H): `[2s1p]`\n  - Oxygen (O): `[3s2p1d]`\n\n- For `cc-pVTZ`:\n  - Hydrogen (H): `[3s2p1d]`\n  - Oxygen (O): `[4s3p2d1f]`\n\n- For `cc-pVQZ`:\n  - Hydrogen (H): `[4s3p2d1f]`\n  - Oxygen (O): `[5s4p3d2f1g]`\n\nAssume that spherical harmonic functions are used. The number of functions for each angular momentum type is: `s` (1), `p` (3), `d` (5), `f` (7), and `g` (9).\n\nCalculate the total number of basis functions for the water molecule for each of the three basis sets. Let these numbers be $N_{DZ}$, $N_{TZ}$, and $N_{QZ}$ for `cc-pVDZ`, `cc-pVTZ`, and `cc-pVQZ`, respectively. Present your three results as a row matrix in the order ($N_{DZ}$, $N_{TZ}$, $N_{QZ}$).", "solution": "We count contracted spherical-harmonic basis functions by angular momentum using the degeneracies\n$$g_{s}=1,\\quad g_{p}=3,\\quad g_{d}=5,\\quad g_{f}=7,\\quad g_{g}=9.$$\nFor an atom with contracted composition $[n_{s}s, n_{p}p, n_{d}d, n_{f}f, n_{g}g]$, the number of basis functions is\n$$N_{\\text{atom}}=n_{s}g_{s}+n_{p}g_{p}+n_{d}g_{d}+n_{f}g_{f}+n_{g}g_{g}.$$\nFor the water molecule with two hydrogens and one oxygen, the molecular total is the sum over atoms.\n\nFor cc-pVDZ:\nHydrogen has $[2s1p]$, so for one H,\n$$N_{\\mathrm{H},\\mathrm{DZ}}=2g_{s}+1g_{p}=2\\cdot 1+1\\cdot 3=5.$$\nTwo hydrogens give $2\\times 5=10$.\nOxygen has $[3s2p1d]$, so\n$$N_{\\mathrm{O},\\mathrm{DZ}}=3g_{s}+2g_{p}+1g_{d}=3\\cdot 1+2\\cdot 3+1\\cdot 5=14.$$\nThus\n$$N_{DZ}=10+14=24.$$\n\nFor cc-pVTZ:\nHydrogen has $[3s2p1d]$, so for one H,\n$$N_{\\mathrm{H},\\mathrm{TZ}}=3g_{s}+2g_{p}+1g_{d}=3\\cdot 1+2\\cdot 3+1\\cdot 5=14,$$\nand two hydrogens give $2\\times 14=28$.\nOxygen has $[4s3p2d1f]$, so\n$$N_{\\mathrm{O},\\mathrm{TZ}}=4g_{s}+3g_{p}+2g_{d}+1g_{f}=4\\cdot 1+3\\cdot 3+2\\cdot 5+1\\cdot 7=30.$$\nThus\n$$N_{TZ}=28+30=58.$$\n\nFor cc-pVQZ:\nHydrogen has $[4s3p2d1f]$, so for one H,\n$$N_{\\mathrm{H},\\mathrm{QZ}}=4g_{s}+3g_{p}+2g_{d}+1g_{f}=4\\cdot 1+3\\cdot 3+2\\cdot 5+1\\cdot 7=30,$$\nand two hydrogens give $2\\times 30=60$.\nOxygen has $[5s4p3d2f1g]$, so\n$$N_{\\mathrm{O},\\mathrm{QZ}}=5g_{s}+4g_{p}+3g_{d}+2g_{f}+1g_{g}=5\\cdot 1+4\\cdot 3+3\\cdot 5+2\\cdot 7+1\\cdot 9=55.$$\nThus\n$$N_{QZ}=60+55=115.$$\n\nTherefore, the requested row matrix $(N_{DZ},N_{TZ},N_{QZ})$ is\n$$\\begin{pmatrix}24 & 58 & 115\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}24 & 58 & 115\\end{pmatrix}}$$", "id": "1362299"}, {"introduction": "The true power of correlation-consistent basis sets lies not in any single calculation, but in their systematic and predictable convergence towards the Complete Basis Set (CBS) limit. This property allows us to extrapolate from the results of smaller basis sets to estimate the energy that would be obtained with an infinitely large one. This practice demonstrates this powerful technique by asking you to perform a two-point extrapolation for the Neon atom, using a standard formula to turn finite basis set results into a highly accurate CBS energy estimate. [@problem_id:2454379]", "problem": "In a non-relativistic, clamped-nuclei calculation for the Neon atom, total electronic energies were obtained using Dunning’s correlation-consistent basis sets cc-pVDZ and cc-pVTZ with the Coupled-Cluster with Singles, Doubles, and perturbative Triples (CCSD(T)) method. The total energies are:\n- cc-pVDZ (cardinal number $X=2$): $E(2) = -128.928521$ in Hartree,\n- cc-pVTZ (cardinal number $X=3$): $E(3) = -128.935644$ in Hartree.\n\nFor correlation-consistent basis sets, assume the dominant basis-set incompleteness error in the correlated total energy follows the asymptotic scaling\n$$E(X) = E_{\\mathrm{CBS}} + A X^{-3},$$\nwhere $E_{\\mathrm{CBS}}$ is the Complete Basis Set (CBS) limit and $A$ is a constant independent of $X$.\n\nUsing only the data above and this scaling assumption, determine $E_{\\mathrm{CBS}}$ for Neon. Express your final answer in Hartree and round your answer to six significant figures.", "solution": "The problem provides a scaling law for the total electronic energy $E(X)$ as a function of the basis set cardinal number $X$:\n$$E(X) = E_{\\mathrm{CBS}} + A X^{-3}$$\nHere, $E_{\\mathrm{CBS}}$ is the desired energy at the complete basis set limit, and $A$ is a fitting parameter. The cardinal numbers for the given Dunning basis sets are $X=2$ for cc-pVDZ and $X=3$ for cc-pVTZ.\n\nWe are given two data points:\n1. For $X=2$: $E(2) = -128.928521$ Hartree\n2. For $X=3$: $E(3) = -128.935644$ Hartree\n\nSubstituting these values into the scaling equation yields a system of two linear equations in two unknowns, $E_{\\mathrm{CBS}}$ and $A$:\n$$E(2) = E_{\\mathrm{CBS}} + A (2)^{-3} \\implies -128.928521 = E_{\\mathrm{CBS}} + \\frac{A}{8}$$\n$$E(3) = E_{\\mathrm{CBS}} + A (3)^{-3} \\implies -128.935644 = E_{\\mathrm{CBS}} + \\frac{A}{27}$$\n\nTo solve for $E_{\\mathrm{CBS}}$, we can first eliminate the parameter $A$. A general formula for this two-point extrapolation scheme can be derived by first isolating $A$ and then solving for $E_{\\mathrm{CBS}}$.\nSubtracting the second original equation from the first:\n$$E(2) - E(3) = \\left( E_{\\mathrm{CBS}} + \\frac{A}{8} \\right) - \\left( E_{\\mathrm{CBS}} + \\frac{A}{27} \\right)$$\n$$E(2) - E(3) = A \\left( \\frac{1}{8} - \\frac{1}{27} \\right) = A \\frac{19}{216}$$\nSolving for $A$:\n$$A = \\frac{216}{19} (E(2) - E(3))$$\n\nNow we substitute this expression for $A$ back into the first original equation, $E_{\\mathrm{CBS}} = E(2) - A/8$:\n$$E_{\\mathrm{CBS}} = E(2) - \\frac{1}{8} \\left( \\frac{216}{19} (E(2) - E(3)) \\right)$$\n$$E_{\\mathrm{CBS}} = E(2) - \\frac{27}{19} (E(2) - E(3))$$\nExpanding and collecting terms for $E(2)$ and $E(3)$:\n$$E_{\\mathrm{CBS}} = \\frac{19 E(2) - 27 E(2) + 27 E(3)}{19}$$\n$$E_{\\mathrm{CBS}} = \\frac{-8 E(2) + 27 E(3)}{19}$$\nThis is the general extrapolation formula for this two-point scheme using $X=2$ and $X=3$.\n\nNow we substitute the given numerical energy values:\n$E(2) = -128.928521$\n$E(3) = -128.935644$\n\n$$E_{\\mathrm{CBS}} = \\frac{-8(-128.928521) + 27(-128.935644)}{19}$$\n$$E_{\\mathrm{CBS}} = \\frac{1031.428168 - 3481.262388}{19}$$\n$$E_{\\mathrm{CBS}} = \\frac{-2449.83422}{19}$$\n$$E_{\\mathrm{CBS}} \\approx -128.93864315789...$$\n\nThe problem requires the answer to be rounded to six significant figures. Starting from the first non-zero digit, the six significant figures of the result $-128.938643...$ are $1, 2, 8, 9, 3, 8$. The seventh digit is $6$, which is greater than or equal to $5$, so we must round up the sixth digit. The sixth digit, $8$, becomes $9$.\nTherefore, the rounded value is $-128.939$.", "answer": "$$\n\\boxed{-128.939}\n$$", "id": "2454379"}, {"introduction": "When we use finite basis sets to study non-covalent interactions between two or more molecules, a subtle artifact known as Basis Set Superposition Error (BSSE) can artificially inflate the calculated binding energy. Correcting for this error is essential for obtaining physically meaningful results. This exercise introduces you to the standard Boys and Bernardi counterpoise correction method, providing a hands-on opportunity to calculate the BSSE for a water dimer from a set of hypothetical energy values. [@problem_id:2454361]", "problem": "You are given the task of computing the Basis Set Superposition Error (BSSE) for a hydrogen-bonded dimer using Dunning’s correlation-consistent polarized valence double-zeta (cc-pVDZ) basis set. Basis Set Superposition Error (BSSE) is defined for a dimer composed of monomer A and monomer B as the positive quantity measuring the artificial stabilization due to basis set incompleteness when basis functions from one monomer are used by the other. Consider the following definitions for a dimer AB:\n- The total energy of the dimer computed in the full dimer basis is denoted by $E_{AB}^{AB}$ in units of Hartree.\n- The total energy of monomer A computed in its own basis is denoted by $E_{A}^{A}$ in units of Hartree.\n- The total energy of monomer B computed in its own basis is denoted by $E_{B}^{B}$ in units of Hartree.\n- The total energy of monomer A computed in the presence of the basis functions of B (ghost basis functions only, no nuclei or electrons from B) is denoted by $E_{A}^{AB}$ in units of Hartree.\n- The total energy of monomer B computed in the presence of the basis functions of A (ghost basis functions only, no nuclei or electrons from A) is denoted by $E_{B}^{AB}$ in units of Hartree.\n\nDefine the uncorrected interaction energy as $E_{\\text{int}}^{\\text{raw}} = E_{AB}^{AB} - \\left(E_{A}^{A} + E_{B}^{B}\\right)$ and the counterpoise-corrected interaction energy as $E_{\\text{int}}^{\\text{CP}} = E_{AB}^{AB} - \\left(E_{A}^{AB} + E_{B}^{AB}\\right)$. The Basis Set Superposition Error (BSSE) magnitude is the difference between these two interaction energies expressed as a positive quantity,\n$$\n\\text{BSSE} = \\left(E_{A}^{A} - E_{A}^{AB}\\right) + \\left(E_{B}^{B} - E_{B}^{AB}\\right),\n$$\nin units of Hartree. Convert the BSSE to kilojoules per mole using the Hartree energy and Avogadro constant:\n- Hartree energy $E_{\\mathrm{h}} = 4.3597447222071\\times 10^{-18}\\ \\text{J}$,\n- Avogadro constant $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\ \\text{mol}^{-1}$,\nand the conversion $1\\ \\text{J} = 10^{-3}\\ \\text{kJ}$ for the final answer. All inputs are energies in Hartree. All outputs must be BSSE values in $\\text{kJ}\\ \\text{mol}^{-1}$, rounded to three decimal places.\n\nTest suite:\nProvide a program that, for each test case below (each consisting of the quadruple $(E_{A}^{A}, E_{B}^{B}, E_{A}^{AB}, E_{B}^{AB})$ in Hartree), computes the BSSE in $\\text{kJ}\\ \\text{mol}^{-1}$:\n1. Water dimer at its equilibrium geometry computed using second-order Møller–Plesset perturbation theory (MP2) with cc-pVDZ:\n   - $E_{A}^{A} = -76.230000$, $E_{B}^{B} = -76.230000$, $E_{A}^{AB} = -76.230950$, $E_{B}^{AB} = -76.230950$.\n2. Boundary case with no BSSE (perfectly balanced basis by construction):\n   - $E_{A}^{A} = -1.000000$, $E_{B}^{B} = -2.000000$, $E_{A}^{AB} = -1.000000$, $E_{B}^{AB} = -2.000000$.\n3. Asymmetric dimer with unequal BSSE contributions from the two monomers:\n   - $E_{A}^{A} = -10.000000$, $E_{B}^{B} = -20.000000$, $E_{A}^{AB} = -10.000400$, $E_{B}^{AB} = -20.000050$.\n\nFinal output format:\nYour program should produce a single line of output containing the three BSSE values corresponding to the test cases above, as a comma-separated list enclosed in square brackets, with each number rounded to three decimal places (e.g., $[x_{1},x_{2},x_{3}]$).", "solution": "The problem requires the calculation of the Basis Set Superposition Error (BSSE) for a molecular dimer. In quantum chemical calculations, the properties of a molecule are described using a set of mathematical functions known as a basis set. When this basis set is finite, or incomplete, an artificial stabilization can occur when calculating the interaction energy of a dimer $AB$. This error arises because the basis functions centered on monomer $A$ can be used to improve the description of monomer $B$, and vice-versa. This effect is non-physical as it depends on the basis set choice rather than the true physics of the system.\n\nThe Boys and Bernardi counterpoise correction method is the standard procedure to correct for this error. The BSSE is defined as the magnitude of this artificial stabilization. The problem provides the correct formula for the BSSE, which is derived from the difference between the uncorrected interaction energy, $E_{\\text{int}}^{\\text{raw}}$, and the counterpoise-corrected interaction energy, $E_{\\text{int}}^{\\text{CP}}$. The BSSE, measured in units of Hartree, is given by:\n$$\n\\text{BSSE} = \\left(E_{A}^{A} - E_{A}^{AB}\\right) + \\left(E_{B}^{B} - E_{B}^{AB}\\right)\n$$\nHere, $E_{X}^{X}$ is the energy of monomer $X$ calculated with its own basis set, and $E_{X}^{XY}$ is the energy of monomer $X$ calculated in the presence of the basis functions of monomer $Y$ (so-called \"ghost\" orbitals). According to the variational principle of quantum mechanics, expanding the basis set for a given monomer (by including ghost orbitals from its partner) must lead to a lower or equal calculated energy. Thus, $E_{A}^{AB} \\le E_{A}^{A}$ and $E_{B}^{AB} \\le E_{B}^{B}$. Consequently, the terms $(E_{A}^{A} - E_{A}^{AB})$ and $(E_{B}^{B} - E_{B}^{AB})$ are inherently non-negative, and the BSSE is correctly defined as a positive quantity representing the stabilization.\n\nThe problem requires the final result in units of kilojoules per mole ($\\text{kJ}\\ \\text{mol}^{-1}$). We must first establish the conversion factor from the atomic unit of energy, the Hartree ($E_{\\text{h}}$), to the molar unit $\\text{kJ}\\ \\text{mol}^{-1}$. We are given:\n- Hartree energy $E_{\\mathrm{h}} = 4.3597447222071 \\times 10^{-18}\\ \\text{J}$\n- Avogadro constant $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\ \\text{mol}^{-1}$\n\nThe conversion factor, $C$, is calculated as follows:\n$$\nC = E_{\\mathrm{h}} \\left(\\frac{\\text{J}}{\\text{Hartree}}\\right) \\times N_{\\mathrm{A}} \\left(\\frac{1}{\\text{mol}}\\right) \\times 10^{-3} \\left(\\frac{\\text{kJ}}{\\text{J}}\\right)\n$$\nSubstituting the given values:\n$$\nC = (4.3597447222071 \\times 10^{-18}) \\times (6.02214076 \\times 10^{23}) \\times 10^{-3}\\ \\text{kJ}\\ \\text{mol}^{-1}\\ \\text{Hartree}^{-1}\n$$\n$$\nC \\approx 2625.5\\ \\text{kJ}\\ \\text{mol}^{-1}\\ \\text{Hartree}^{-1}\n$$\nWe will use this conversion factor to compute the BSSE for each test case. The final value must be rounded to $3$ decimal places.\n\nCase 1: Water dimer\n- $E_{A}^{A} = -76.230000\\ E_{\\text{h}}$\n- $E_{B}^{B} = -76.230000\\ E_{\\text{h}}$\n- $E_{A}^{AB} = -76.230950\\ E_{\\text{h}}$\n- $E_{B}^{AB} = -76.230950\\ E_{\\text{h}}$\n\nThe BSSE in Hartrees is:\n$$\n\\text{BSSE}_{E_{\\text{h}}} = (-76.230000 - (-76.230950)) + (-76.230000 - (-76.230950))\n$$\n$$\n\\text{BSSE}_{E_{\\text{h}}} = 0.000950 + 0.000950 = 0.001900\\ E_{\\text{h}}\n$$\nConverting to $\\text{kJ}\\ \\text{mol}^{-1}$:\n$$\n\\text{BSSE}_{\\text{kJ/mol}} = 0.001900 \\times C \\approx 4.988449\\ \\text{kJ}\\ \\text{mol}^{-1}\n$$\nRounded to $3$ decimal places, the result is $4.988$.\n\nCase 2: Boundary case with no BSSE\n- $E_{A}^{A} = -1.000000\\ E_{\\text{h}}$\n- $E_{B}^{B} = -2.000000\\ E_{\\text{h}}$\n- $E_{A}^{AB} = -1.000000\\ E_{\\text{h}}$\n- $E_{B}^{AB} = -2.000000\\ E_{\\text{h}}$\n\nThe BSSE in Hartrees is:\n$$\n\\text{BSSE}_{E_{\\text{h}}} = (-1.000000 - (-1.000000)) + (-2.000000 - (-2.000000))\n$$\n$$\n\\text{BSSE}_{E_{\\text{h}}} = 0.0 + 0.0 = 0.0\\ E_{\\text{h}}\n$$\nConverting to $\\text{kJ}\\ \\text{mol}^{-1}$:\n$$\n\\text{BSSE}_{\\text{kJ/mol}} = 0.0 \\times C = 0.0\\ \\text{kJ}\\ \\text{mol}^{-1}\n$$\nRounded to $3$ decimal places, the result is $0.000$.\n\nCase 3: Asymmetric dimer\n- $E_{A}^{A} = -10.000000\\ E_{\\text{h}}$\n- $E_{B}^{B} = -20.000000\\ E_{\\text{h}}$\n- $E_{A}^{AB} = -10.000400\\ E_{\\text{h}}$\n- $E_{B}^{AB} = -20.000050\\ E_{\\text{h}}$\n\nThe BSSE in Hartrees is:\n$$\n\\text{BSSE}_{E_{\\text{h}}} = (-10.000000 - (-10.000400)) + (-20.000000 - (-20.000050))\n$$\n$$\n\\text{BSSE}_{E_{\\text{h}}} = 0.000400 + 0.000050 = 0.000450\\ E_{\\text{h}}\n$$\nConverting to $\\text{kJ}\\ \\text{mol}^{-1}$:\n$$\n\\text{BSSE}_{\\text{kJ/mol}} = 0.000450 \\times C \\approx 1.181475\\ \\text{kJ}\\ \\text{mol}^{-1}\n$$\nRounded to $3$ decimal places, the result is $1.181$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Basis Set Superposition Error (BSSE) for given test cases\n    and formats the output as specified.\n    \"\"\"\n    # Define physical constants according to the problem statement.\n    # Hartree energy in Joules (CODATA 2018)\n    E_HARTREE_IN_J = 4.3597447222071e-18\n    # Avogadro constant in mol^-1 (CODATA 2018)\n    N_AVOGADRO = 6.02214076e23\n    # Conversion factor from Joules to kiloJoules\n    J_PER_KJ = 1000.0\n\n    # Calculate the conversion factor from Hartree to kJ/mol.\n    # The unit of the factor is (kJ/mol) per Hartree.\n    HARTREE_TO_KJ_PER_MOL = (E_HARTREE_IN_J * N_AVOGADRO) / J_PER_KJ\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (E_A^A, E_B^B, E_A^{AB}, E_B^{AB}) in Hartree.\n    test_cases = [\n        # Case 1: Water dimer at MP2/cc-pVDZ level\n        (-76.230000, -76.230000, -76.230950, -76.230950),\n        # Case 2: Boundary case with zero BSSE\n        (-1.000000, -2.000000, -1.000000, -2.000000),\n        # Case 3: Asymmetric dimer with unequal BSSE contributions\n        (-10.000000, -20.000000, -10.000400, -20.000050),\n    ]\n\n    results = []\n    for case in test_cases:\n        e_a_a, e_b_b, e_a_ab, e_b_ab = case\n\n        # Calculate the BSSE in Hartree using the provided formula:\n        # BSSE = (E_A^A - E_A^{AB}) + (E_B^B - E_B^{AB})\n        # The terms (E_X^X - E_X^{XY}) are non-negative due to the variational principle.\n        bsse_hartree = (e_a_a - e_a_ab) + (e_b_b - e_b_ab)\n\n        # Convert the BSSE from Hartree to kJ/mol.\n        bsse_kj_mol = bsse_hartree * HARTREE_TO_KJ_PER_MOL\n\n        # Append the result formatted to three decimal places.\n        # Using an f-string with a format specifier handles rounding correctly.\n        results.append(f\"{bsse_kj_mol:.3f}\")\n\n    # Final print statement in the exact required format: [x1,x2,x3]\n    print(f\"[{','.join(results)}]\")\n\n# Execute the solution.\nsolve()\n```", "id": "2454361"}]}