{"hands_on_practices": [{"introduction": "A fundamental strategy for improving the quality of a measurement plagued by random noise is signal averaging. This technique relies on the principle that if a signal is consistent and the noise is random, averaging multiple acquisitions will cause the signal to stand out as the noise statistically cancels itself out. This practice problem [@problem_id:1471994] allows you to calculate the precise number of measurements required to achieve a desired signal-to-noise ratio, demonstrating the powerful relationship between averaging and data quality.", "problem": "An analytical chemist is using a spectroscopic technique to detect a trace amount of a specific environmental pollutant in a river water sample. The instrument noise, which is primarily random thermal noise, is significant relative to the weak signal from the pollutant. A preliminary analysis consisting of a single rapid scan produces a spectrum where the characteristic peak of the pollutant has a signal-to-noise ratio (S/N) of 3.0. To ensure a confident identification and quantification, the laboratory's protocol requires that the S/N for this peak be improved to a value of at least 30. This can be achieved by acquiring multiple scans and averaging them. Assuming the signal is coherent and the noise is random and uncorrelated between scans, determine the minimum number of scans that must be collected and averaged to achieve the target S/N of 30.", "solution": "For multiple scans with coherent signal and random, uncorrelated noise, averaging $N$ scans reduces the noise standard deviation by a factor $\\sqrt{N}$ while leaving the mean signal unchanged. Therefore, the signal-to-noise ratio scales as\n$$\n\\left(\\frac{S}{N}\\right)_{N}=\\left(\\frac{S}{N}\\right)_{1}\\sqrt{N}.\n$$\nLet the single-scan value be $\\left(\\frac{S}{N}\\right)_{1}=3$ and the target be $\\left(\\frac{S}{N}\\right)_{\\text{target}}=30$. The requirement is\n$$\n\\left(\\frac{S}{N}\\right)_{1}\\sqrt{N}\\geq \\left(\\frac{S}{N}\\right)_{\\text{target}} \\quad \\Longrightarrow \\quad \\sqrt{N}\\geq \\frac{\\left(\\frac{S}{N}\\right)_{\\text{target}}}{\\left(\\frac{S}{N}\\right)_{1}}.\n$$\nSquaring both sides gives\n$$\nN \\geq \\left(\\frac{\\left(\\frac{S}{N}\\right)_{\\text{target}}}{\\left(\\frac{S}{N}\\right)_{1}}\\right)^{2}.\n$$\nThus the minimum integer number of scans required is\n$$\nN_{\\min}=\\left\\lceil \\left(\\frac{30}{3}\\right)^{2} \\right\\rceil=\\left\\lceil 10^{2} \\right\\rceil=100.\n$$\nSince the square is already an integer, no additional rounding is needed beyond confirming the inequality.", "answer": "$$\\boxed{100}$$", "id": "1471994"}, {"introduction": "Beyond averaging multiple datasets, we often need to smooth a single data stream using digital filters. However, not all filters are created equal, and their effectiveness depends on the nature of the noise. This exercise [@problem_id:1471977] presents a classic comparison between a moving average filter and a median filter, challenging you to identify their outputs based on how they handle a sharp outlier. Understanding this difference is key to choosing the appropriate smoothing technique, particularly for rejecting spurious spikes without distorting the underlying signal.", "problem": "An analytical chemist is working with a data stream from a chromatograph detector. The signal, which represents chemical absorbance, is generally stable but is corrupted by a single, sharp noise spike. To improve the signal-to-noise ratio, the chemist decides to apply two common digital smoothing filters to the raw data: a 3-point moving average filter and a 3-point median filter.\n\nA segment of the raw data signal, let's call it $S_{raw}$, is given by the following sequence of absorbance values (in arbitrary units):\n$$\nS_{raw} = [20.10, 20.50, 21.20, 98.50, 21.50, 20.80, 20.20]\n$$\nAfter applying each of the two filters (moving average and median, both with a 3-point window) to this segment, the chemist obtains the two smoothed signals below, labeled Signal A and Signal B. The order is mixed up.\n\nSignal A: $[20.50, 21.20, 21.50, 21.50, 20.80]$\nSignal B: $[20.60, 46.73, 47.07, 46.93, 20.83]$\n\nBased on your understanding of how these filters operate, identify which signal was produced by which filter.\n\nA. Signal A is from the moving average filter; Signal B is from the median filter.\n\nB. Signal A is from the median filter; Signal B is from the moving average filter.\n\nC. Both signals are from a moving average filter, but with different window sizes.\n\nD. Both signals are from a median filter, but with different window sizes.", "solution": "Let the raw sequence be indexed as $x_{1},x_{2},\\ldots,x_{7}$ with $[x_{1},x_{2},x_{3},x_{4},x_{5},x_{6},x_{7}]=[20.10,20.50,21.20,98.50,21.50,20.80,20.20]$. For a 3-point window, both filters produce outputs for indices $i=2,3,4,5,6$.\n\nThe 3-point moving average filter is defined by\n$$\ny_{i}^{(\\text{MA})}=\\frac{1}{3}\\left(x_{i-1}+x_{i}+x_{i+1}\\right).\n$$\nCompute each output:\n$$\ny_{2}^{(\\text{MA})}=\\frac{1}{3}(20.10+20.50+21.20)=\\frac{61.80}{3}=20.60,\n$$\n$$\ny_{3}^{(\\text{MA})}=\\frac{1}{3}(20.50+21.20+98.50)=\\frac{140.20}{3}=46.73\\ \\text{(rounded to two decimals)},\n$$\n$$\ny_{4}^{(\\text{MA})}=\\frac{1}{3}(21.20+98.50+21.50)=\\frac{141.20}{3}=47.07\\ \\text{(rounded)},\n$$\n$$\ny_{5}^{(\\text{MA})}=\\frac{1}{3}(98.50+21.50+20.80)=\\frac{140.80}{3}=46.93\\ \\text{(rounded)},\n$$\n$$\ny_{6}^{(\\text{MA})}=\\frac{1}{3}(21.50+20.80+20.20)=\\frac{62.50}{3}=20.83\\ \\text{(rounded)}.\n$$\nThus the moving average output is\n$$\n[20.60,46.73,47.07,46.93,20.83],\n$$\nwhich matches Signal B.\n\nThe 3-point median filter is defined by\n$$\ny_{i}^{(\\text{Med})}=\\operatorname{median}\\{x_{i-1},x_{i},x_{i+1}\\}.\n$$\nCompute each output by sorting each triple:\n$$\n\\{x_{1},x_{2},x_{3}\\}=\\{20.10,20.50,21.20\\}\\ \\Rightarrow\\ \\text{median}=20.50,\n$$\n$$\n\\{x_{2},x_{3},x_{4}\\}=\\{20.50,21.20,98.50\\}\\ \\Rightarrow\\ \\text{median}=21.20,\n$$\n$$\n\\{x_{3},x_{4},x_{5}\\}=\\{21.20,98.50,21.50\\}\\ \\Rightarrow\\ \\text{median}=21.50,\n$$\n$$\n\\{x_{4},x_{5},x_{6}\\}=\\{98.50,21.50,20.80\\}\\ \\Rightarrow\\ \\text{median}=21.50,\n$$\n$$\n\\{x_{5},x_{6},x_{7}\\}=\\{21.50,20.80,20.20\\}\\ \\Rightarrow\\ \\text{median}=20.80.\n$$\nThus the median filter output is\n$$\n[20.50,21.20,21.50,21.50,20.80],\n$$\nwhich matches Signal A.\n\nTherefore, Signal A is from the median filter and Signal B is from the moving average filter, corresponding to option B.", "answer": "$$\\boxed{B}$$", "id": "1471977"}, {"introduction": "While simple moving averages can reduce noise, they often come at the cost of distorting important signal features, such as peak heights and shapes. The Savitzky-Golay filter offers a more advanced solution by fitting a polynomial to the data within a moving window, which excels at smoothing noise while preserving the underlying signal structure. This practice [@problem_id:1471959] provides a concrete application of this technique, allowing you to manually compute a smoothed data point using a given set of Savitzky-Golay convolution weights.", "problem": "In a kinetic study using spectrophotometry, the absorbance of a solution is monitored over time. Due to inherent electronic noise in the detector, the raw data needs to be smoothed to better determine the reaction rate. The Savitzky-Golay filtering method is a common technique for this purpose. It works by applying a set of convolution integers, or weights, to a moving window of data points.\n\nConsider the following sequence of seven consecutive raw absorbance measurements, which are unitless:\n$y_1 = 0.112$, $y_2 = 0.203$, $y_3 = 0.388$, $y_4 = 0.495$, $y_5 = 0.401$, $y_6 = 0.215$, $y_7 = 0.098$\n\nTo smooth this data, a 5-point quadratic Savitzky-Golay filter is used. The set of weights for this filter, from the leftmost point in the window to the rightmost, is given by the integers `[-3, 12, 17, 12, -3]`. The value of the smoothed central point is calculated by taking the sum of the products of each data point in the window with its corresponding weight, and then dividing this sum by a normalization constant. For this specific set of weights, the normalization constant is $35$.\n\nUsing the provided data, weights, and normalization constant, calculate the smoothed absorbance value that corresponds to the original fourth data point, $y_4$. Round your final answer to four significant figures.", "solution": "To obtain the smoothed value at the central point corresponding to $y_{4}$ using a 5-point quadratic Savitzky-Golay filter with weights $[-3,12,17,12,-3]$ and normalization constant $35$, apply the convolution to the 5-point window centered at $y_{4}$, which is $\\{y_{2},y_{3},y_{4},y_{5},y_{6}\\}$. The smoothed value is\n$$\n\\tilde{y}_{4}=\\frac{1}{35}\\left[-3y_{2}+12y_{3}+17y_{4}+12y_{5}-3y_{6}\\right].\n$$\nSubstitute the given values:\n$$\n\\tilde{y}_{4}=\\frac{1}{35}\\left[-3(0.203)+12(0.388)+17(0.495)+12(0.401)-3(0.215)\\right].\n$$\nCompute each term:\n$$\n-3(0.203)=-0.609,\\quad 12(0.388)=4.656,\\quad 17(0.495)=8.415,\\quad 12(0.401)=4.812,\\quad -3(0.215)=-0.645.\n$$\nSum the numerator:\n$$\n-0.609+4.656+8.415+4.812-0.645=16.629.\n$$\nDivide by the normalization constant:\n$$\n\\tilde{y}_{4}=\\frac{16.629}{35}=0.475114\\ldots\n$$\nRounded to four significant figures, this is $0.4751$.", "answer": "$$\\boxed{0.4751}$$", "id": "1471959"}]}