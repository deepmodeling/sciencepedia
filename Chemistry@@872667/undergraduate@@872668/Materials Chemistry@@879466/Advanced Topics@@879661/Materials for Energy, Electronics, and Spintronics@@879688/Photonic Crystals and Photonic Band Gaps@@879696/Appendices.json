{"hands_on_practices": [{"introduction": "The simplest yet one of the most widely used photonic crystals is the one-dimensional Distributed Bragg Reflector (DBR). This exercise [@problem_id:1322384] explores the fundamental design principle behind these structures, known as the quarter-wave stack condition. By precisely controlling the thickness of alternating dielectric layers, we can engineer constructive interference to create a near-perfect mirror at a specific wavelength, a foundational skill in photonic design.", "problem": "A crucial component in modern telecommunications is the Vertical-Cavity Surface-Emitting Laser (VCSEL), which relies on highly reflective mirrors to form its optical cavity. These mirrors, known as Distributed Bragg Reflectors (DBRs), are fabricated by depositing alternating layers of two different dielectric materials.\n\nConsider the design of a DBR for a VCSEL intended to operate at a specific vacuum wavelength $\\lambda_0$. The DBR is constructed from alternating layers of Material 1, with refractive index $n_1$, and Material 2, with refractive index $n_2$. To achieve maximum reflectivity for light at normal incidence, a specific design rule must be followed: the optical path length within each individual layer must be precisely one-quarter of the target wavelength $\\lambda_0$. The optical path length is defined as the product of the physical thickness of a layer and its refractive index.\n\nAssuming this design rule is perfectly implemented, determine the total physical thickness of a single, fundamental repeating bilayer unit, which consists of one layer of Material 1 adjacent to one layer of Material 2. Express your answer as a single symbolic expression in terms of $\\lambda_0$, $n_1$, and $n_2$.", "solution": "For a quarter-wave Distributed Bragg Reflector at normal incidence, the design condition for each layer is that its optical path length equals one-quarter of the target wavelength. If $d_{1}$ and $d_{2}$ are the physical thicknesses of Material 1 and Material 2, respectively, and the optical path length is $n d$, then the quarter-wave conditions are:\n$$\nn_{1} d_{1} = \\frac{\\lambda_{0}}{4}, \\quad n_{2} d_{2} = \\frac{\\lambda_{0}}{4}.\n$$\nSolving for the physical thicknesses gives:\n$$\nd_{1} = \\frac{\\lambda_{0}}{4 n_{1}}, \\quad d_{2} = \\frac{\\lambda_{0}}{4 n_{2}}.\n$$\nThe total physical thickness of one bilayer (one layer of each material) is the sum:\n$$\nd_{\\text{bilayer}} = d_{1} + d_{2} = \\frac{\\lambda_{0}}{4} \\left( \\frac{1}{n_{1}} + \\frac{1}{n_{2}} \\right).\n$$", "answer": "$$\\boxed{\\frac{\\lambda_{0}}{4}\\left(\\frac{1}{n_{1}}+\\frac{1}{n_{2}}\\right)}$$", "id": "1322384"}, {"introduction": "Nature provides stunning examples of 3D photonic crystals, such as the iridescent colors of an opal. This problem [@problem_id:1322381] challenges you to think like a materials scientist characterizing a synthetic opal. Using the position of a measured reflection peak, you will apply the Bragg diffraction condition in an effective medium to determine a key structural parameter of the crystal, demonstrating how macroscopic optical properties can reveal microscopic order.", "problem": "A synthetic opal is fabricated by the self-assembly of monodisperse silica nanospheres, which pack into a crystalline structure analogous to a face-centered cubic (FCC) lattice. The voids between the silica spheres are filled with air. To characterize the optical properties of this material, a normal-incidence reflectance measurement is performed. A strong reflection peak, corresponding to the first-order photonic stop band, is observed at a central wavelength of $\\lambda_{peak} = 615$ nm. This reflection is attributed to Bragg diffraction from the family of (111) crystallographic planes.\n\nAssume the following values:\n- The refractive index of the silica spheres is $n_{silica} = 1.45$.\n- The refractive index of the air in the voids is $n_{air} = 1.00$.\n- The volume filling fraction of the silica spheres is $\\phi = 0.740$.\n\nThe effective refractive index, $n_{eff}$, of this composite material can be estimated by the volume-weighted average of the dielectric constants (where the dielectric constant $\\epsilon$ is the square of the refractive index, $\\epsilon = n^2$). The relationship is given by:\n$n_{eff}^2 = \\phi \\cdot n_{silica}^2 + (1 - \\phi) \\cdot n_{air}^2$\n\nCalculate the interplanar spacing, $d_{111}$, corresponding to the (111) planes of the crystal structure. Express your answer in nanometers (nm), rounded to three significant figures.", "solution": "The strong reflection at normal incidence arises from first-order Bragg diffraction from the family of $(111)$ planes in a medium characterized by an effective refractive index. The Bragg condition for constructive interference in a dielectric medium is\n$$\nm\\,\\lambda_{\\text{peak}}=2\\,n_{\\text{eff}}\\,d_{hkl}\\,\\sin\\theta,\n$$\nwhere $m$ is the diffraction order, $\\lambda_{\\text{peak}}$ is the free-space wavelength, $n_{\\text{eff}}$ is the effective refractive index, $d_{hkl}$ is the interplanar spacing, and $\\theta$ is the angle between the incident beam and the lattice planes. For normal incidence onto planes parallel to the sample surface (here the $(111)$ planes), the beam is perpendicular to the planes, so $\\theta=\\frac{\\pi}{2}$ and $\\sin\\theta=1$. For first order ($m=1$), this reduces to\n$$\n\\lambda_{\\text{peak}}=2\\,n_{\\text{eff}}\\,d_{111}.\n$$\nThus,\n$$\nd_{111}=\\frac{\\lambda_{\\text{peak}}}{2\\,n_{\\text{eff}}}.\n$$\n\nThe effective refractive index is obtained from the given mixing rule for dielectric constants:\n$$\nn_{\\text{eff}}^{2}=\\phi\\,n_{\\text{silica}}^{2}+(1-\\phi)\\,n_{\\text{air}}^{2}.\n$$\nWith the given values,\n$$\nn_{\\text{eff}}^{2}=0.740\\,(1.45)^{2}+0.260\\,(1.00)^{2}\n=0.740\\cdot 2.1025+0.260\\cdot 1\n=1.55585+0.260\n=1.81585,\n$$\nso\n$$\nn_{\\text{eff}}=\\sqrt{1.81585}\\approx 1.347535.\n$$\n\nTherefore,\n$$\nd_{111}=\\frac{615\\ \\text{nm}}{2\\times 1.347535}\\approx \\frac{615}{2.69507}\\ \\text{nm}\\approx 228.194\\ \\text{nm}.\n$$\nRounded to three significant figures, this is $228$ nm.", "answer": "$$\\boxed{228}$$", "id": "1322381"}, {"introduction": "While simple models can predict the center of a photonic stop band, a full understanding requires mapping the entire band structureâ€”the ranges of frequency that are allowed or forbidden to propagate. This advanced computational exercise [@problem_id:2387580] introduces the powerful transfer matrix method, a standard technique for analyzing layered systems. By implementing this method, you will move beyond single-wavelength calculations to determine the precise edges and widths of the photonic band gaps, gaining a comprehensive view of how the crystal controls light.", "problem": "A one-dimensional photonic crystal is formed by the infinite periodic repetition of a unit cell consisting of two homogeneous, isotropic, lossless, nonmagnetic dielectric layers at normal incidence. Let layer 1 have relative permittivity $\\varepsilon_{r1}$ and thickness $d_1$ (in meters), and layer 2 have relative permittivity $\\varepsilon_{r2}$ and thickness $d_2$ (in meters). Assume vacuum permeability $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{N/A^2}$, speed of light in vacuum $c = 299{,}792{,}458\\,\\mathrm{m/s}$, and vacuum permittivity $\\varepsilon_0 = 1/(\\mu_0 c^2)\\,\\mathrm{F/m}$. The refractive index of layer $j$ is $n_j = \\sqrt{\\varepsilon_{rj}}$. The unit cell is ordered as layer 1 followed by layer 2, with period $a = d_1 + d_2$. Consider time-harmonic fields with angular frequency $\\omega = 2\\pi f$ at normal incidence and require the existence of nontrivial Bloch waves consistent with the periodic structure. For each frequency $f$ (in hertz), determine whether a propagating Bloch solution exists; frequencies for which no propagating Bloch solution exists form photonic band gaps. For each test case below, identify all frequency intervals within the provided range $[f_{\\min}, f_{\\max}]$ that constitute photonic band gaps, and report each interval as a two-element list $[f_\\mathrm{lower}, f_\\mathrm{upper}]$ in hertz. Express all reported frequencies in hertz (Hz), rounded to the nearest $1.0\\times 10^{10}\\,\\mathrm{Hz}$. If there are no photonic band gaps within the specified range, report an empty list for that test case.\n\nTest suite (each tuple is $(\\varepsilon_{r1}, \\varepsilon_{r2}, d_1, d_2, f_{\\min}, f_{\\max})$, with thicknesses in meters and frequencies in hertz):\n- Case 1 (high-contrast, quarter-wave design near a central frequency): $\\left(2.25,\\ 12.25,\\ \\frac{c}{4\\,\\sqrt{2.25}\\,2.0\\times 10^{14}},\\ \\frac{c}{4\\,\\sqrt{12.25}\\,2.0\\times 10^{14}},\\ 1.0\\times 10^{14},\\ 4.0\\times 10^{14}\\right)$.\n- Case 2 (homogeneous limit): $\\left(4.0,\\ 4.0,\\ 2.0\\times 10^{-7},\\ 3.0\\times 10^{-7},\\ 1.0\\times 10^{14},\\ 3.0\\times 10^{14}\\right)$.\n- Case 3 (low-contrast, quarter-wave design near a central frequency): $\\left(2.25,\\ 2.56,\\ \\frac{c}{4\\,\\sqrt{2.25}\\,3.0\\times 10^{14}},\\ \\frac{c}{4\\,\\sqrt{2.56}\\,3.0\\times 10^{14}},\\ 1.5\\times 10^{14},\\ 4.5\\times 10^{14}\\right)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The $i$-th element corresponds to the $i$-th test case and must itself be a list of the photonic band gaps found for that test case, where each band gap is reported as a two-element list $[f_\\mathrm{lower}, f_\\mathrm{upper}]$ in hertz, using the rounding rule above. For example, a valid output structure with two gaps for the first case and none for the second case would look like: $[[f_{1,\\mathrm{low}},f_{1,\\mathrm{high}}],[f_{2,\\mathrm{low}},f_{2,\\mathrm{high}}]],[]$. The program must aggregate the three test cases into one line, for example: $[[\\dots],[\\dots,\\dots]],[],[[\\dots]]]$. No additional text should be printed.", "solution": "The problem is to determine the frequency intervals corresponding to photonic band gaps for a one-dimensional, infinite photonic crystal at normal incidence. The problem is well-posed and scientifically sound, based on the standard transfer matrix method for analyzing periodic dielectric structures.\n\nA photonic band gap consists of frequencies for which no propagating Bloch waves can exist in the periodic structure. The condition for the existence of a propagating Bloch wave with Bloch wavevector $K$ in a one-dimensional periodic structure with period $a$ is given by the dispersion relation, which can be derived using the transfer matrix method.\n\nLet the unit cell consist of two layers with refractive indices $n_1 = \\sqrt{\\varepsilon_{r1}}$, $n_2 = \\sqrt{\\varepsilon_{r2}}$ and thicknesses $d_1$, $d_2$. The period is $a = d_1 + d_2$. For a time-harmonic electromagnetic wave with angular frequency $\\omega = 2\\pi f$ at normal incidence, the propagation through the layered structure can be described by a $2 \\times 2$ transfer matrix. This matrix relates the tangential components of the electric and magnetic fields, $(E, H)$, at the beginning of a unit cell to the fields at the end of the cell.\n\nThe transfer matrix $U_{cell}$ for one period ($a=d_1+d_2$) is the product of the matrices for each layer, $U_{cell} = U_2 U_1$, where $U_j$ is the forward-propagating transfer matrix for layer $j$. The matrix for a single layer of thickness $d_j$ and refractive index $n_j$ is:\n$$\nU_j = \\begin{pmatrix} \\cos(k_j d_j) & -i\\eta_j \\sin(k_j d_j) \\\\ -i\\frac{1}{\\eta_j} \\sin(k_j d_j) & \\cos(k_j d_j) \\end{pmatrix}\n$$\nHere, $k_j = n_j \\omega/c = 2\\pi f n_j / c$ is the wavenumber in the layer, and $\\eta_j = \\eta_0/n_j$ is the wave impedance, with $\\eta_0 = \\sqrt{\\mu_0/\\varepsilon_0}$ being the impedance of free space. Since the problem concerns lossless, nonmagnetic media, this formulation is appropriate. The product of the individual matrices gives the transfer matrix for the unit cell: $U_{cell} = U_2 U_1$.\n\nAccording to Bloch's theorem, for an eigenmode in a periodic system, the fields at the end of a unit cell must be equal to the fields at the beginning, multiplied by a phase factor $e^{iKa}$, where $K$ is the Bloch wavevector. This implies that $e^{iKa}$ must be an eigenvalue of the unit cell transfer matrix $U_{cell}$. The eigenvalues $\\lambda$ of a $2 \\times 2$ matrix with determinant $1$ (which is the case here as $\\det(U_j)=1$) are given by the characteristic equation $\\lambda^2 - \\text{Tr}(U_{cell})\\lambda + 1 = 0$.\n\nThe eigenvalues are $e^{\\pm iKa}$, and their sum is $2\\cos(Ka) = \\text{Tr}(U_{cell})$. This leads to the dispersion relation:\n$$\n\\cos(Ka) = \\frac{1}{2} \\text{Tr}(U_{cell})\n$$\nPropagating waves (real $K$) exist only when the right-hand side is within the range $[-1, 1]$. Frequencies for which $|\\frac{1}{2} \\text{Tr}(U_{cell})| > 1$ correspond to complex $K$, representing evanescent waves that cannot propagate indefinitely. These frequency ranges are the photonic band gaps.\n\nLet's compute the trace of $U_{cell} = U_2 U_1$:\n$$\n\\text{Tr}(U_{cell}) = 2\\cos(k_1d_1)\\cos(k_2d_2) - \\left(\\frac{\\eta_2}{\\eta_1} + \\frac{\\eta_1}{\\eta_2}\\right)\\sin(k_1d_1)\\sin(k_2d_2)\n$$\nSince $\\eta_j = \\eta_0/n_j$, the ratio $\\eta_2/\\eta_1 = n_1/n_2$. Substituting this, we define a function $H(f)$:\n$$\nH(f) = \\frac{1}{2}\\text{Tr}(U_{cell}) = \\cos(k_1d_1)\\cos(k_2d_2) - \\frac{1}{2}\\left(\\frac{n_1}{n_2} + \\frac{n_2}{n_1}\\right)\\sin(k_1d_1)\\sin(k_2d_2)\n$$\nThe photonic band gaps are the frequency intervals where $|H(f)| > 1$.\n\nThe algorithmic procedure to find these gaps is as follows:\n1.  For each test case, define the parameters $\\varepsilon_{r1}, \\varepsilon_{r2}, d_1, d_2, f_{\\min}, f_{\\max}$. The refractive indices are $n_j = \\sqrt{\\varepsilon_{rj}}$. The speed of light $c$ is given as $299{,}792{,}458\\,\\mathrm{m/s}$. A special case is when $n_1=n_2$, which corresponds to a homogeneous medium. In this case, the term $\\frac{1}{2}(\\frac{n_1}{n_2} + \\frac{n_2}{n_1}) = 1$, and $H(f)$ simplifies to $\\cos(k_1(d_1+d_2))$. Since a cosine function is always bounded between $-1$ and $1$, there are no band gaps.\n2.  The band edges are the frequencies $f$ where $|H(f)| = 1$, i.e., $H(f) = 1$ or $H(f) = -1$.\n3.  We find these band-edge frequencies numerically. The frequency range $[f_{\\min}, f_{\\max}]$ is discretized into a fine grid. We search for intervals on this grid where the functions $H(f)-1$ or $H(f)+1$ change sign, indicating the presence of a root.\n4.  The `scipy.optimize.brentq` function is used to find the precise location of each root within these bracketing intervals.\n5.  All found roots, along with $f_{\\min}$ and $f_{\\max}$, form a set of boundary points that partition the frequency range.\n6.  For each subinterval between two consecutive boundary points, we check if it lies within a band gap by evaluating $H(f)$ at the midpoint of the subinterval. If $|H(f_{mid})| > 1$, the subinterval is part of a band gap.\n7.  The resulting band gap intervals are collected. Adjacent intervals forming a single continuous gap are merged.\n8.  The lower and upper bounds of each final gap interval are rounded to the nearest $1.0\\times 10^{10}\\,\\mathrm{Hz}$ as specified.\n9.  The final result for each test case is a list of these rounded band gap intervals. If no gaps are found, an empty list is reported.\n\nThis numerical approach is general and robust for any set of parameters. For the special cases of quarter-wave stacks (Cases 1 and 3), analytical solutions exist and can be used to verify the numerical results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for photonic band gaps in a 1D photonic crystal for given test cases.\n\n    The method is based on the transfer matrix formalism for 1D periodic systems.\n    A band gap exists for frequencies where the magnitude of the half-trace of\n    the unit cell transfer matrix exceeds 1. This condition is checked across the\n    specified frequency range for each test case.\n    \"\"\"\n\n    C_LIGHT = 299792458.0  # Speed of light in vacuum, m/s\n\n    def setup_test_cases():\n        \"\"\"Pre-calculates parameters for test cases to avoid using eval().\"\"\"\n        \n        # Case 1: High-contrast quarter-wave stack\n        c1_eps1, c1_eps2 = 2.25, 12.25\n        c1_n1, c1_n2 = np.sqrt(c1_eps1), np.sqrt(c1_eps2)\n        c1_fc = 2.0e14\n        c1_d1 = C_LIGHT / (4.0 * c1_n1 * c1_fc)\n        c1_d2 = C_LIGHT / (4.0 * c1_n2 * c1_fc)\n        c1_fmin, c1_fmax = 1.0e14, 4.0e14\n        case1 = (c1_eps1, c1_eps2, c1_d1, c1_d2, c1_fmin, c1_fmax)\n\n        # Case 2: Homogeneous medium\n        c2_eps1, c2_eps2 = 4.0, 4.0\n        c2_d1, c2_d2 = 2.0e-7, 3.0e-7\n        c2_fmin, c2_fmax = 1.0e14, 3.0e14\n        case2 = (c2_eps1, c2_eps2, c2_d1, c2_d2, c2_fmin, c2_fmax)\n\n        # Case 3: Low-contrast quarter-wave stack\n        c3_eps1, c3_eps2 = 2.25, 2.56\n        c3_n1, c3_n2 = np.sqrt(c3_eps1), np.sqrt(c3_eps2)\n        c3_fc = 3.0e14\n        c3_d1 = C_LIGHT / (4.0 * c3_n1 * c3_fc)\n        c3_d2 = C_LIGHT / (4.0 * c3_n2 * c3_fc)\n        c3_fmin, c3_fmax = 1.5e14, 4.5e14\n        case3 = (c3_eps1, c3_eps2, c3_d1, c3_d2, c3_fmin, c3_fmax)\n        \n        return [case1, case2, case3]\n\n    test_cases = setup_test_cases()\n    all_results = []\n    \n    for case in test_cases:\n        eps1, eps2, d1, d2, f_min, f_max = case\n        \n        n1 = np.sqrt(eps1)\n        n2 = np.sqrt(eps2)\n        \n        # Handle the homogeneous case where no contrast means no band gaps\n        if np.isclose(n1, n2):\n            all_results.append([])\n            continue\n\n        def H_func(f):\n            \"\"\"Calculates the half-trace of the transfer matrix.\"\"\"\n            f = np.asarray(f)\n            k1 = n1 * 2.0 * np.pi * f / C_LIGHT\n            k2 = n2 * 2.0 * np.pi * f / C_LIGHT\n            \n            cos_k1d1 = np.cos(k1 * d1)\n            cos_k2d2 = np.cos(k2 * d2)\n            sin_k1d1 = np.sin(k1 * d1)\n            sin_k2d2 = np.sin(k2 * d2)\n            \n            ratio_term = 0.5 * (n1 / n2 + n2 / n1)\n            \n            return cos_k1d1 * cos_k2d2 - ratio_term * sin_k1d1 * sin_k2d2\n\n        # Find roots of H(f) = +/- 1, which are the band edges\n        boundaries = {f_min, f_max}\n        num_points = 20000\n        freqs = np.linspace(f_min, f_max, num_points)\n        h_vals = H_func(freqs)\n        \n        h_plus_1 = h_vals + 1.0\n        h_minus_1 = h_vals - 1.0\n\n        for i in range(num_points - 1):\n            if h_plus_1[i] * h_plus_1[i+1] < 0:\n                try:\n                    root = brentq(lambda f: H_func(f) + 1.0, freqs[i], freqs[i+1])\n                    boundaries.add(root)\n                except ValueError:\n                    pass\n            if h_minus_1[i] * h_minus_1[i+1] < 0:\n                try:\n                    root = brentq(lambda f: H_func(f) - 1.0, freqs[i], freqs[i+1])\n                    boundaries.add(root)\n                except ValueError:\n                    pass\n        \n        sorted_boundaries = sorted(list(boundaries))\n        \n        gaps = []\n        rounding_precision = 1.0e10\n        \n        for i in range(len(sorted_boundaries) - 1):\n            f_low = sorted_boundaries[i]\n            f_high = sorted_boundaries[i+1]\n            \n            if f_high - f_low < 1e-9 * (f_max - f_min):\n                continue\n\n            mid_f = (f_low + f_high) / 2.0\n            h_mid = H_func(mid_f)\n            \n            # Check if the interval is a band gap\n            if h_mid > 1.0 or h_mid < -1.0:\n                f_low_rounded = round(f_low / rounding_precision) * rounding_precision\n                f_high_rounded = round(f_high / rounding_precision) * rounding_precision\n                \n                if f_low_rounded < f_high_rounded:\n                    # Merge with previous gap if adjacent\n                    if gaps and np.isclose(gaps[-1][1], f_low_rounded):\n                        gaps[-1][1] = f_high_rounded\n                    else:\n                        gaps.append([f_low_rounded, f_high_rounded])\n\n        all_results.append(gaps)\n\n    # Format the final output string as specified\n    output_str_parts = []\n    for res in all_results:\n        # Custom string formatting to avoid extra spaces and ensure correct structure\n        if not res:\n            output_str_parts.append(\"[]\")\n        else:\n            gap_strs = [f\"[{g[0]},{g[1]}]\" for g in res]\n            output_str_parts.append(f\"[{','.join(gap_strs)}]\")\n            \n    print(f\"[{','.join(output_str_parts)}]\")\n\nsolve()\n```", "id": "2387580"}]}