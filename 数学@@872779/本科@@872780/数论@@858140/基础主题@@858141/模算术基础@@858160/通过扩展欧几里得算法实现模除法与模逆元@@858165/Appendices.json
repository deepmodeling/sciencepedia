{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。此处的第一个练习将引导您完成使用扩展欧几里得算法计算模逆元的核心过程。这个基本练习旨在强化计算技能，首先使用欧几里得算法验证可逆性（即最大公约数为1），然后通过反向代入找到贝祖等式中的系数，从而得到模逆元。通过这个练习 [@problem_id:3087285]，您将为解决更复杂的问题打下坚实的基础。", "problem": "在模 $n$ 整数环中，一个整数 $a$ 是模 $n$ 乘法可逆的，当且仅当存在一个整数 $x$ 使得 $a x \\equiv 1 \\pmod{n}$。根据贝祖等式，这样的 $x$ 的存在性等价于最大公约数条件 $\\gcd(a,n)=1$。贝祖等式断言，存在整数 $u$ 和 $v$ 满足 $u a + v n = \\gcd(a,n)$。扩展欧几里得算法（EEA）是找到这样整数 $u$ 和 $v$ 的一种构造性方法。\n\n从这些基本定义和事实出发，通过计算 $\\gcd(425,987)$ 来判断 $a = 425$ 是否在模 $n = 987$ 下可逆。如果可逆，使用扩展欧几里得算法计算唯一的最小非负剩余 $x \\in \\{0,1,\\dots,986\\}$，使得 $425 x \\equiv 1 \\pmod{987}$。请以指定范围内的单个整数形式提供最终答案。无需四舍五入。", "solution": "用户提交了一道数论问题。作为一位严谨的教授，我将首先验证题目的陈述。\n\n### 步骤1：提取已知条件\n- 模算术问题中的整数：$a = 425$ 和 $n = 987$。\n- 任务：通过计算 $\\gcd(425, 987)$ 来判断 $a=425$ 是否在模 $n=987$ 下可逆。\n- 如果可逆，求出唯一的最小非负剩余 $x \\in \\{0, 1, \\dots, 986\\}$，使得 $425x \\equiv 1 \\pmod{987}$。\n- 要求的方法：扩展欧几里得算法（EEA）。\n- 提供的理论背景：\n    - 乘法逆元的定义：$ax \\equiv 1 \\pmod{n}$。\n    - 可逆性条件：$\\gcd(a,n)=1$。\n    - 贝祖等式：对于某些整数 $u,v$，有 $ua + vn = \\gcd(a,n)$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题是计算数论中的一个标准练习，基于模算术、欧几里得算法和贝祖等式的成熟原理。它没有任何科学或事实上的不严谨之处。\n- **适定性：** 该问题是适定的。它要求一个特定的值，即模逆元，如果存在，则在指定的剩余范围内是唯一的。所有必要的输入值均已提供。\n- **客观性：** 问题以客观的数学语言陈述，没有主观或含糊不清的术语。\n- **完整性和一致性：** 问题是自洽的，且内部一致。\n\n### 步骤3：结论与行动\n该问题有效。我现在将提供一个完整、有理有据的解答。\n\n问题要求在模 $n=987$ 的整数环中求整数 $a=425$ 的乘法逆元。一个整数 $a$ 在模 $n$ 下有乘法逆元，当且仅当 $a$ 和 $n$ 的最大公约数为 $1$，即 $\\gcd(a, n) = 1$。\n\n首先，我们应用欧几里得算法来计算 $\\gcd(425, 987)$。\n除法序列如下：\n$$987 = 2 \\cdot 425 + 137$$\n$$425 = 3 \\cdot 137 + 14$$\n$$137 = 9 \\cdot 14 + 11$$\n$$14 = 1 \\cdot 11 + 3$$\n$$11 = 3 \\cdot 3 + 2$$\n$$3 = 1 \\cdot 2 + 1$$\n$$2 = 2 \\cdot 1 + 0$$\n这个序列中最后一个非零余数是 $1$。因此，我们有 $\\gcd(425, 987) = 1$。由于最大公约数为 $1$，整数 $425$ 确实在模 $987$ 下是可逆的。\n\n接下来，我们使用扩展欧几里得算法来找到整数 $u$ 和 $v$，使得 $425u + 987v = 1$。我们通过从欧几里得算法的步骤中回溯，将最大公约数（$1$）表示为前面步骤中各数的线性组合来实现这一点。\n\n从算法的倒数第二行开始：\n$$1 = 3 - 1 \\cdot 2$$\n用方程 $11 = 3 \\cdot 3 + 2$（即 $2 = 11 - 3 \\cdot 3$）代入余数 $2$：\n$$1 = 3 - 1 \\cdot (11 - 3 \\cdot 3) = 3 - 1 \\cdot 11 + 3 \\cdot 3 = 4 \\cdot 3 - 1 \\cdot 11$$\n用方程 $14 = 1 \\cdot 11 + 3$（即 $3 = 14 - 1 \\cdot 11$）代入余数 $3$：\n$$1 = 4 \\cdot (14 - 1 \\cdot 11) - 1 \\cdot 11 = 4 \\cdot 14 - 4 \\cdot 11 - 1 \\cdot 11 = 4 \\cdot 14 - 5 \\cdot 11$$\n用方程 $137 = 9 \\cdot 14 + 11$（即 $11 = 137 - 9 \\cdot 14$）代入余数 $11$：\n$$1 = 4 \\cdot 14 - 5 \\cdot (137 - 9 \\cdot 14) = 4 \\cdot 14 - 5 \\cdot 137 + 45 \\cdot 14 = 49 \\cdot 14 - 5 \\cdot 137$$\n用方程 $425 = 3 \\cdot 137 + 14$（即 $14 = 425 - 3 \\cdot 137$）代入余数 $14$：\n$$1 = 49 \\cdot (425 - 3 \\cdot 137) - 5 \\cdot 137 = 49 \\cdot 425 - 147 \\cdot 137 - 5 \\cdot 137 = 49 \\cdot 425 - 152 \\cdot 137$$\n最后，用方程 $987 = 2 \\cdot 425 + 137$（即 $137 = 987 - 2 \\cdot 425$）代入余数 $137$：\n$$1 = 49 \\cdot 425 - 152 \\cdot (987 - 2 \\cdot 425) = 49 \\cdot 425 - 152 \\cdot 987 + 304 \\cdot 425$$\n合并包含 $425$ 的项，我们得到：\n$$1 = (49 + 304) \\cdot 425 - 152 \\cdot 987$$\n$$1 = 353 \\cdot 425 - 152 \\cdot 987$$\n这个方程就是 $a=425$ 和 $n=987$ 的贝祖等式，其中 $u=353$，$v=-152$。\n\n为了找到 $425$ 模 $987$ 的乘法逆元，我们在模 $987$ 的整数环中考虑这个等式：\n$$353 \\cdot 425 - 152 \\cdot 987 \\equiv 1 \\pmod{987}$$\n由于 $152 \\cdot 987$ 是 $987$ 的倍数，它模 $987$ 的余数是 $0$。\n$$353 \\cdot 425 - 0 \\equiv 1 \\pmod{987}$$\n$$353 \\cdot 425 \\equiv 1 \\pmod{987}$$\n这个同余关系表明 $x=353$ 是 $425$ 模 $987$ 的乘法逆元。\n\n问题要求在集合 $\\{0, 1, \\dots, 986\\}$ 中唯一的最小非负剩余 $x$。由于 $0 \\le 353 \\le 986$，我们的值 $x=353$ 就是所求的答案。", "answer": "$$\\boxed{353}$$", "id": "3087285"}, {"introduction": "在掌握了如何计算模逆元之后，一个自然而然的问题是：模逆元是否总是存在？这个练习 [@problem_id:3087269] 探讨了模逆元存在的根本条件。通过处理一个逆元不存在的情形，您将深入理解最大公约数在其中扮演的关键角色。这个过程不仅是关于计算，更是关于理解模算术的内在结构，以及为什么 $a$ 和 $n$ 互质（即 $\\gcd(a, n) = 1$）是 $a$ 在模 $n$ 下可逆的充要条件。", "problem": "考虑模 $n$ 的整数。仅使用基本定义，从第一性原理出发构建论证来判断可逆性，而不是借助预先记忆的公式。给定 $a=840$ 和 $n=1001$，使用扩展欧几里得算法 (EEA) 来确定 $a$ 是否存在模 $n$ 的乘法逆元，如果存在则计算它。如果逆元不存在，请根据整除性解释其结构性障碍，并为了评分，将 $d=\\gcd(a,n)$ 的值作为最终答案，其中 $\\gcd$ 表示最大公约数 (gcd)。你的推理必须基于模逆元、最大公约数和整数线性组合的定义。最终答案必须是一个数字。不需要四舍五入。", "solution": "问题要求我们确定整数 $a=840$ 是否存在模 $n=1001$ 的乘法逆元，如果存在则计算它。分析必须基于第一性原理并使用扩展欧几里得算法。\n\n首先，让我们明确基本定义。如果同余式 $ax \\equiv 1 \\pmod{n}$ 成立，则整数 $x$ 是 $a$ 模 $n$ 的乘法逆元。根据模同余的定义，这等价于说 $ax - 1$ 是 $n$ 的倍数。这意味着存在某个整数 $k$，使得 $ax - 1 = kn$。整理这个方程得到线性丢番图方程 $ax - kn = 1$。令 $y = -k$，我们寻求方程 $ax + ny = 1$ 的整数解 $(x, y)$。\n\n此类方程整数解的存在性由一个与最大公约数 (gcd) 相关的基本性质决定。两个整数 $a$ 和 $n$ 的最大公约数，记为 $d = \\gcd(a, n)$，是能同时整除 $a$ 和 $n$ 的最大正整数。一个关键结果，通常称为裴蜀定理 (Bézout's identity)，指出最大公约数 $d$ 可以表示为 $a$ 和 $n$ 的整数线性组合。也就是说，存在整数 $x'$ 和 $y'$ 使得 $ax' + ny' = d$。此外，$d$ 是可以以这种形式表示的最小正整数。因此，任何线性组合 $ax + ny$ 都必须是 $d = \\gcd(a, n)$ 的倍数。\n\n结合这些原理，$a$ 模 $n$ 的乘法逆元存在的充要条件是方程 $ax + ny = 1$ 有整数解。而这又当且仅当 $1$ 是 $d = \\gcd(a, n)$ 的倍数时才可能。由于 $d$ 是一个正整数，这个条件简化为 $d = 1$。因此，$a$ 模 $n$ 可逆的充要条件是 $a$ 和 $n$ 互质，即 $\\gcd(a, n) = 1$。\n\n我们现在使用欧几里得算法来计算 $a=840$ 和 $n=1001$ 的最大公约数。该算法通过一系列带余除法进行：\n$$1001 = 1 \\cdot 840 + 161$$\n$$840 = 5 \\cdot 161 + 35$$\n$$161 = 4 \\cdot 35 + 21$$\n$$35 = 1 \\cdot 21 + 14$$\n$$21 = 1 \\cdot 14 + 7$$\n$$14 = 2 \\cdot 7 + 0$$\n最后一个非零余数就是最大公约数。在本例中，我们发现 $\\gcd(840, 1001) = 7$。\n\n由于 $\\gcd(840, 1001) = 7 \\neq 1$，整数 $a=840$ 不存在模 $n=1001$ 的乘法逆元。\n\n这个结构性障碍是最大公约数的直接结果。$840$ 和 $1001$ 的任何线性组合都必须是它们的最大公约数 $7$ 的倍数。具体来说，由于 $7$ 整除 $840$（即 $840 = 120 \\cdot 7$）且 $7$ 整除 $1001$（即 $1001 = 143 \\cdot 7$），对于整数 $x$ 和 $y$，任何形如 $840x + 1001y$ 的表达式都可以因式分解为：\n$$840x + 1001y = (120 \\cdot 7)x + (143 \\cdot 7)y = 7(120x + 143y)$$\n这表明，任何可以表示为 $840$ 和 $1001$ 的线性组合的整数都必须能被 $7$ 整除。整数 $1$ 不能被 $7$ 整除，因此方程 $840x + 1001y = 1$ 没有整数解。这直接意味着同余式 $840x \\equiv 1 \\pmod{1001}$ 对于 $x$ 没有解。\n\n问题说明，如果逆元不存在，我们必须报告 $d = \\gcd(a, n)$ 的值。如计算所得，这个值是 $7$。", "answer": "$$\\boxed{7}$$", "id": "3087269"}, {"introduction": "模逆元的一个关键应用是求解线性同余方程。这个练习将问题从求解 $ax \\equiv 1 \\pmod{n}$ 推广到更一般的形式 $ax \\equiv b \\pmod{m}$。您将学习如何处理 $\\gcd(a, m)  1$ 的情况，此时需要先对方程进行化简，然后再求解。此练习 [@problem_id:3087279] 不仅展示了模逆元作为“模除法”工具的强大功能，还揭示了当系数与模不互质时可能出现多个解的有趣现象。", "problem": "设 $a$、$b$ 和 $m$ 为整数，其中 $m \\geq 2$。回顾一下，$a x \\equiv b \\pmod{m}$ 表示 $m$ 整除 $a x - b$，并且最大公约数 $\\gcd(a,m)$ 是能同时整除 $a$ 和 $m$ 的最大正整数。从这些定义和基本的整除性质出发，对特定的同余方程 $14 x \\equiv 21 \\pmod{35}$ 按以下步骤进行：\n1. 确定 $\\gcd(14,35)$ 并用它来判断该同余方程是否可解。如果可解，则通过除以 $\\gcd(14,35)$ 将其化简为一个具有更小模的等价同余方程。\n2. 求解化简后的同余方程，方法是使用扩展欧几里得算法（EEA）找到一个乘法逆元，并得到一个关于化简后模的规范解。\n3. 解释原同余方程有多少个模 $35$ 的不同余解，并仅使用整除性和同余的论证，通过从化简后的模提升到模 $35$ 的方法来证明所有解的形式。\n4. 将所有模 $35$ 的不同余解作为集合 $\\{0,1,2,\\dots,34\\}$ 中的整数，并按升序排列。\n\n你的最终答案应该是这些整数的完整列表，使用 LaTeX 的 $\\pmatrix$ 符号写成单行，并按升序排列。无需四舍五入。", "solution": "问题是求解线性同余方程 $14x \\equiv 21 \\pmod{35}$。设 $a = 14$，$b = 21$，$m = 35$。该同余方程的形式为 $ax \\equiv b \\pmod{m}$。\n\n1. 首先，我们确定 $a$ 和 $m$ 的最大公约数，即 $\\gcd(14, 35)$。我们使用欧几里得算法：\n$$35 = 2 \\cdot 14 + 7$$\n$$14 = 2 \\cdot 7 + 0$$\n最后一个非零余数是 $7$，所以 $d = \\gcd(14, 35) = 7$。\n线性同余方程 $ax \\equiv b \\pmod{m}$ 有解当且仅当 $d$ 整除 $b$。在本例中，$d=7$ 且 $b=21$。因为 $21 = 3 \\cdot 7$，所以 $d$ 整除 $b$，因此该同余方程是可解的。\n为了化简该同余方程，我们可以使用定义 $ax \\equiv b \\pmod{m}$ 等价于 $ax - b = mk$（对于某个整数 $k$）。对于我们的具体问题，这即是 $14x - 21 = 35k$。我们可以将整个方程除以 $d=7$：\n$$(14/7)x - (21/7) = (35/7)k$$\n$$2x - 3 = 5k$$\n这个丢番图方程等价于化简后的同余方程 $2x \\equiv 3 \\pmod{5}$。新的模是 $m' = m/d = 35/7 = 5$。\n\n2. 接下来，我们求解化简后的同余方程 $2x \\equiv 3 \\pmod{5}$。为此，我们求 $2$ 模 $5$ 的乘法逆元。因为 $\\gcd(2, 5) = 1$，所以逆元存在。我们使用扩展欧几里得算法（EEA）。对 $\\gcd(2, 5)$ 使用欧几里得算法：\n$$5 = 2 \\cdot 2 + 1$$\n我们现在通过反向回代，将最大公约数 $1$ 表示为 $5$ 和 $2$ 的线性组合：\n$$1 = 5 - 2 \\cdot 2$$\n$$1 = (1) \\cdot 5 + (-2) \\cdot 2$$\n将此方程模 $5$ 运算，我们得到：\n$$(1) \\cdot 5 + (-2) \\cdot 2 \\equiv 1 \\pmod{5}$$\n$$0 + (-2) \\cdot 2 \\equiv 1 \\pmod{5}$$\n所以，$2$ 模 $5$ 的乘法逆元是 $-2$。在集合 $\\{0, 1, 2, 3, 4\\}$ 中的规范代表是 $-2 + 5 = 3$。我们可以检验 $2 \\cdot 3 = 6 \\equiv 1 \\pmod{5}$。\n现在，我们将化简后的同余方程 $2x \\equiv 3 \\pmod{5}$ 的两边都乘以逆元 $3$：\n$$3 \\cdot (2x) \\equiv 3 \\cdot 3 \\pmod{5}$$\n$$(3 \\cdot 2)x \\equiv 9 \\pmod{5}$$\n$$1 \\cdot x \\equiv 4 \\pmod{5}$$\n$$x \\equiv 4 \\pmod{5}$$\n关于化简后的模 $5$ 的规范解是 $x_0 = 4$。\n\n3. 同余方程 $ax \\equiv b \\pmod{m}$ 的不同余解的数量由 $d = \\gcd(a, m)$ 给出，前提是 $d|b$。在这里，$d=7$，所以有 $7$ 个模 $35$ 的不同余解。\n化简后同余方程的解 $x \\equiv 4 \\pmod{5}$ 意味着任何解 $x$ 都必须满足关系式 $x = 4 + 5k$，其中 $k$ 是某个整数。我们现在需要找出哪些 $k$ 值能生成模 $35$ 的不同解。\n假设有两个解 $x_1 = 4 + 5k_1$ 和 $x_2 = 4 + 5k_2$，它们模 $35$ 同余。\n$$4 + 5k_1 \\equiv 4 + 5k_2 \\pmod{35}$$\n$$5k_1 \\equiv 5k_2 \\pmod{35}$$\n根据同余的定义，这意味着 $35 | (5k_1 - 5k_2)$，或者说 $35 | 5(k_1 - k_2)$。\n这意味着存在一个整数 $c$，使得 $5(k_1 - k_2) = 35c$。两边除以 $5$，我们得到 $k_1 - k_2 = 7c$，这意味着 $7 | (k_1 - k_2)$，或者说 $k_1 \\equiv k_2 \\pmod{7}$。\n因此，我们通过选择模 $7$ 不同余的 $k$ 值来获得模 $35$ 的不同解。一个 $k$ 模 $7$ 的完全代表集是 $\\{0, 1, 2, 3, 4, 5, 6\\}$。这证实了恰好有 $7$ 个不同的解。\n完整的解集是通过将基础解 $x_0 = 4$ 从化简后的模 $5$ “提升”到原始模 $35$ 来生成的。解的一般形式是 $x_k = x_0 + k(m/d)$，其中 $k = 0, 1, \\dots, d-1$。在我们的例子中，即为 $x_k = 4 + k(35/7) = 4 + 5k$，其中 $k \\in \\{0, 1, 2, 3, 4, 5, 6\\}$。\n\n4. 最后，我们将 $k$ 的值从 $0$ 到 $6$ 代入公式 $x = 4 + 5k$，列出所有 $7$ 个模 $35$ 的不同余解。解必须在集合 $\\{0, 1, \\dots, 34\\}$ 中。\n当 $k=0$ 时：$x = 4 + 5(0) = 4$\n当 $k=1$ 时：$x = 4 + 5(1) = 9$\n当 $k=2$ 时：$x = 4 + 5(2) = 14$\n当 $k=3$ 时：$x = 4 + 5(3) = 19$\n当 $k=4$ 时：$x = 4 + 5(4) = 24$\n当 $k=5$ 时：$x = 4 + 5(5) = 29$\n当 $k=6$ 时：$x = 4 + 5(6) = 34$\n按升序排列的完整不同余解列表是 $4, 9, 14, 19, 24, 29, 34$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4  9  14  19  24  29  34\n\\end{pmatrix}\n}\n$$", "id": "3087279"}]}