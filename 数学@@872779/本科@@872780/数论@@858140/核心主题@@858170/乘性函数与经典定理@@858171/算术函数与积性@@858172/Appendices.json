{"hands_on_practices": [{"introduction": "理论需要通过应用来加深理解。我们的动手实践将从探索数论中最基本的操作之一——狄利克雷卷积开始。这个练习将引导你计算常数函数 $1$ 与自身的卷积，你会惊奇地发现这个简单的操作揭示了著名的除数函数 $d(n)$。通过解决这个问题 [@problem_id:3008283]，你不仅能计算一个基本的卷积，还能练习如何直接根据定义来证明一个函数的积性性质。", "problem": "设 $f:\\mathbb{N}\\to\\mathbb{C}$ 是一个数论函数，其中 $\\mathbb{N}$ 表示正整数。两个数论函数 $f$ 和 $g$ 的狄利克雷卷积定义为 $$(f*g)(n)\\coloneqq\\sum_{d\\mid n} f(d)\\,g\\!\\left(\\frac{n}{d}\\right),$$ 其中求和遍历 $n$ 的所有正因子 $d$。定义常数1函数 $1:\\mathbb{N}\\to\\mathbb{C}$ 为，对所有 $n\\in\\mathbb{N}$，$1(n)\\coloneqq 1$。如果一个函数 $h:\\mathbb{N}\\to\\mathbb{C}$ 满足 $h(1)=1$ 并且在 $\\gcd(m,n)=1$ 时有 $h(mn)=h(m)\\,h(n)$，则称其为积性函数，其中 $\\gcd$ 表示最大公约数。\n\n从这些定义出发，不作任何进一步假设，完成以下任务：\n\n1. 用 $n$ 的因子表示 $(1*1)(n)$ 的计算结果。\n2. 直接根据定义证明 $(1*1)(n)$ 是积性函数。\n3. 计算当 $p$ 为素数且整数 $k\\geq 0$ 时 $(1*1)(p^{k})$ 的值。\n4. 使用素数分解 $n=\\prod_{i=1}^{r} p_{i}^{\\alpha_{i}}$（其中 $p_{1},\\dots,p_{r}$ 为不同素数，指数 $\\alpha_{i}\\in\\mathbb{N}$），将 $(1*1)(n)$ 表示为关于 $\\alpha_{i}$ 的单个闭式解析表达式。\n\n以关于素数指数 $\\alpha_{i}$ 的单个符号表达式的形式提供您的最终答案。无需四舍五入。", "solution": "首先验证问题陈述，以确保其科学基础扎实、问题提法恰当、客观且完整。\n\n### 第1步：提取已知条件\n- 数论函数是函数 $f:\\mathbb{N}\\to\\mathbb{C}$，其中 $\\mathbb{N}$ 是正整数。\n- 狄利克雷卷积定义为 $(f*g)(n)\\coloneqq\\sum_{d\\mid n} f(d)\\,g\\!\\left(\\frac{n}{d}\\right)$。\n- 常数1函数定义为，对所有 $n\\in\\mathbb{N}$，$1(n)\\coloneqq 1$。\n- 如果一个函数 $h:\\mathbb{N}\\to\\mathbb{C}$ 满足 $h(1)=1$ 并且在 $\\gcd(m,n)=1$ 时有 $h(mn)=h(m)\\,h(n)$，则称其为积性函数。\n- 整数 $n$ 的素数分解形式为 $n=\\prod_{i=1}^{r} p_{i}^{\\alpha_{i}}$，其中 $p_{1},\\dots,p_{r}$ 为不同素数，指数 $\\alpha_{i}\\in\\mathbb{N}$。\n\n任务如下：\n1. 计算 $(1*1)(n)$。\n2. 证明 $(1*1)(n)$ 是积性函数。\n3. 计算当 $p$ 为素数且整数 $k\\geq 0$ 时 $(1*1)(p^{k})$ 的值。\n4. 将 $(1*1)(n)$ 表示为关于 $\\alpha_{i}$ 的闭式解析表达式。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学基础扎实**：该问题属于数论领域，使用了数论函数、狄利克雷卷积和积性函数的标准、普遍接受的定义。所有概念在数学上都是合理的。\n- **问题提法恰当**：该问题被分解为一系列逻辑步骤，每一步都定义明确，并导向一个唯一的、有意义的结果。最终任务要求一个可从前面部分推导出的特定表达式。\n- **客观性**：问题以精确、无歧义的数学语言陈述。\n- **完整性与一致性**：所提供的定义是自洽的，足以解决问题的所有部分。没有矛盾之处。\n- **主题相关性**：该问题是数论函数和积性这一主题的核心。\n\n### 第3步：结论与行动\n该问题有效。将提供完整解答。\n\n---\n\n设函数 $h:\\mathbb{N}\\to\\mathbb{C}$ 定义为 $h(n) \\coloneqq (1*1)(n)$。我们将依次解决问题的四个部分。\n\n_1. 计算 $(1*1)(n)$_\n\n根据狄利克雷卷积的定义，我们有：\n$$h(n) = (1*1)(n) = \\sum_{d\\mid n} 1(d)\\,1\\!\\left(\\frac{n}{d}\\right)$$\n根据常数1函数 $1$ 的定义，我们知道对于任何整数 $k \\in \\mathbb{N}$，$1(k) = 1$。因此，对于 $n$ 的任何因子 $d$，都有 $1(d)=1$ 和 $1\\!\\left(\\frac{n}{d}\\right)=1$。\n将这些值代入求和中得到：\n$$h(n) = \\sum_{d\\mid n} 1 \\cdot 1 = \\sum_{d\\mid n} 1$$\n这个和计算的是 $n$ 的正因子数量。这个函数通常表示为因子函数，记作 $\\tau(n)$ 或 $d(n)$。\n\n_2. 证明 $(1*1)(n)$ 是积性函数_\n\n要证明 $h(n)=(1*1)(n)$ 是积性函数，我们必须证明满足两个条件：\na) $h(1)=1$。\nb) 对于任意两个互素整数 $m, n \\in \\mathbb{N}$（即 $\\gcd(m,n)=1$），有 $h(mn)=h(m)\\,h(n)$。\n\na) 对于 $n=1$，唯一的正因子是 $d=1$。\n$$h(1) = (1*1)(1) = \\sum_{d\\mid 1} 1 = 1$$\n第一个条件满足。\n\nb) 设 $m, n \\in \\mathbb{N}$ 且 $\\gcd(m,n)=1$。\n$h(m) = \\sum_{d_1 \\mid m} 1$ 是 $m$ 的正因子数量。\n$h(n) = \\sum_{d_2 \\mid n} 1$ 是 $n$ 的正因子数量。\n$h(mn) = \\sum_{d \\mid mn} 1$ 是 $mn$ 的正因子数量。\n\n我们需要证明 $mn$ 的因子数量是 $m$ 的因子数量与 $n$ 的因子数量的乘积。\n设 $d$ 是 $mn$ 的一个正因子。由于 $\\gcd(m, n) = 1$，$mn$ 的任何因子 $d$ 都可以唯一地表示为乘积 $d = d_1 d_2$，其中 $d_1$ 是 $m$ 的因子，$d_2$ 是 $n$ 的因子。\n\n我们来建立这种一一对应关系。\n- 定义一个从 $m$ 和 $n$ 的因子集的笛卡尔积到 $mn$ 的因子集的映射 $\\phi$：$\\phi(d_1, d_2) = d_1 d_2$，其中 $d_1 \\mid m$ 且 $d_2 \\mid n$。如果 $d_1 \\mid m$ 且 $d_2 \\mid n$，那么 $d_1 d_2 \\mid mn$，所以 $\\phi$ 的像确实是 $mn$ 的因子的一个子集。\n- 为了证明 $\\phi$ 是一个双射，我们证明它既是单射也是满射。\n- **单射性**：假设 $\\phi(d_1, d_2) = \\phi(d'_1, d'_2)$，这意味着 $d_1 d_2 = d'_1 d'_2$。这里，$d_1, d'_1$ 是 $m$ 的因子，$d_2, d'_2$ 是 $n$ 的因子。因为 $\\gcd(m,n)=1$，所以 $\\gcd(d_1, d'_2)=1$。由 $d_1 d_2 = d'_1 d'_2$，我们有 $d_1$ 整除 $d'_1 d'_2$。因为 $d_1$ 和 $d'_2$ 互素，我们必然有 $d_1 \\mid d'_1$。通过对称的论证（$d'_1 \\mid d_1 d_2$ 且 $\\gcd(d'_1, d_2)=1$），我们得到 $d'_1 \\mid d_1$。由于这些都是正整数，所以 $d_1 = d'_1$。这意味着 $d_2 = d'_2$。因此，数对 $(d_1, d_2)$ 是唯一的，该映射是单射的。\n- **满射性**：设 $d$ 是 $mn$ 的任意因子。定义 $d_1 = \\gcd(d, m)$ 和 $d_2 = \\gcd(d, n)$。显然 $d_1 \\mid m$ 且 $d_2 \\mid n$。由于 $\\gcd(m, n)=1$，最大公约数的一个已知性质表明 $\\gcd(d, mn) = \\gcd(d, m) \\gcd(d, n)$。因为 $d$ 是 $mn$ 的一个因子，所以 $\\gcd(d, mn) = d$。因此，$d = d_1 d_2$。这表明 $mn$ 的任何因子 $d$ 都可以从一个数对 $(d_1, d_2)$ 得到，其中 $d_1 \\mid m$ 且 $d_2 \\mid n$。该映射是满射的。\n\n由于在数对集合 $(d_1, d_2)$（其中 $d_1|m, d_2|n$）与 $mn$ 的因子集合之间存在一个双射，这些集合中的元素数量必须相等。此类数对的数量是 $d_1$ 的选择数量与 $d_2$ 的选择数量的乘积。\n$$h(mn) = (\\text{number of divisors of } m) \\times (\\text{number of divisors of } n) = h(m)h(n)$$\n这便完成了 $h(n)=(1*1)(n)$ 是积性函数的证明。\n\n_3. 计算当 $p$ 为素数且整数 $k\\geq 0$ 时 $(1*1)(p^{k})$ 的值_\n\n设 $h(n) = (1*1)(n)$。我们想计算 $h(p^k)$。\n$$h(p^k) = (1*1)(p^k) = \\sum_{d \\mid p^k} 1$$\n对于一个素数 $p$，$p^k$ 的正因子（其中 $k \\ge 0$ 是一个整数）恰好是 $p^0, p^1, p^2, \\dots, p^k$。\n因子集合是 $\\{p^0, p^1, \\dots, p^k\\}$。该集合中的元素数量为 $(k-0)+1 = k+1$。\n因此，\n$$(1*1)(p^k) = k+1$$\n\n_4. 将 $(1*1)(n)$ 表示为单个闭式解析表达式_\n\n给定 $n$ 的素数分解为 $n=\\prod_{i=1}^{r} p_{i}^{\\alpha_{i}}$，其中 $p_i$ 是不同的素数，$\\alpha_i \\in \\mathbb{N}$。设 $h(n) = (1*1)(n)$。\n在第2部分，我们证明了 $h(n)$ 是一个积性函数。\n设 $n_i = p_i^{\\alpha_i}$，其中 $i=1, \\dots, r$。由于素数 $p_i$ 是不同的，整数 $n_i$ 两两互素，即当 $i \\neq j$ 时，$\\gcd(n_i, n_j) = 1$。\n将 $h$ 的积性性质应用于 $n$ 的分解：\n$$h(n) = h\\left(\\prod_{i=1}^{r} p_{i}^{\\alpha_{i}}\\right) = h(p_1^{\\alpha_1} p_2^{\\alpha_2} \\cdots p_r^{\\alpha_r}) = \\prod_{i=1}^{r} h(p_i^{\\alpha_i})$$\n在第3部分，我们发现 $h(p^k) = k+1$。我们可以将此结果应用于乘积中的每一项 $h(p_i^{\\alpha_i})$，方法是设 $p=p_i$ 和 $k=\\alpha_i$：\n$$h(p_i^{\\alpha_i}) = \\alpha_i + 1$$\n将此代回 $h(n)$ 的表达式中：\n$$h(n) = (1*1)(n) = \\prod_{i=1}^{r} (\\alpha_i + 1)$$\n这就是所要求的 $(1*1)(n)$ 关于其素数分解中指数 $\\alpha_i$ 的闭式表达式。", "answer": "$$\\boxed{\\prod_{i=1}^{r} (\\alpha_{i} + 1)}$$", "id": "3008283"}, {"introduction": "在建立了积性函数的概念后，我们现在转向数论的另一个基石——莫比乌斯函数，并通过它的“近亲” $\\mu^2(n)$ 来进行研究。这个练习 [@problem_id:3081494] 要求你证明 $\\mu^2(n)$ 是无平方因子数的特征函数并且是积性函数。更重要的是，它将介绍一种强大且广泛使用的技巧：通过首先分析其在素数幂上的行为，来计算一个积性函数的因数和。这种方法能将复杂的求和过程大大简化，并揭示出优美的数论恒等式。", "problem": "设 $\\mu(n)$ 表示 Möbius 函数，对所有正整数 $n$ 定义如下：$\\mu(1)=1$；如果存在素数 $p$ 使得 $p^{2}\\mid n$，则 $\\mu(n)=0$；如果 $n$ 是 $k$ 个不同素数的乘积，则 $\\mu(n)=(-1)^{k}$。定义 $\\mu^{2}(n)$ 为 $\\mu(n)$ 的逐点平方，即 $\\mu^{2}(n)=(\\mu(n))^{2}$。如果一个函数 $f:\\mathbb{N}\\to\\mathbb{C}$ 满足 $f(1)=1$ 且对于任意 $\\gcd(m,n)=1$ 都有 $f(mn)=f(m)f(n)$，则称该函数为积性函数，其中 $\\gcd$ 表示最大公约数 (gcd)。从这些定义和算术基本定理（唯一素数分解）出发，完成以下任务：证明 $\\mu^{2}(n)$ 是积性函数，并且证明当 $n$ 是无平方因子数时 $\\mu^{2}(n)$ 等于 $1$，否则等于 $0$。然后，仅使用关于积性和因数和的第一性原理，根据 $n$ 的素数分解显式地计算因数和 $\\sum_{d\\mid n}\\mu^{2}(d)$。你可以将最终结果用 $\\omega(n)$（$n$ 的不同素因数的个数）来表示。以关于 $n$ 的单一闭式表达式给出你的最终答案；不需要数值舍入。", "solution": "题目要求对函数 $\\mu^2(n)$ 进行若干证明，并计算其因数和。我们将从给定的定义开始，逐步进行。\n\n设 $\\mu(n)$ 为 Möbius 函数。函数 $\\mu^2(n)$ 定义为 $(\\mu(n))^2$。\n\n首先，我们证明 $\\mu^2(n)$ 是无平方因子数的特征函数。无平方因子数是指除了 $1$ 之外不能被任何完全平方数整除的正整数。\n\n情况 $1$：$n$ 不是无平方因子数。\n如果 $n$ 不是无平方因子数，那么根据定义，存在一个素数 $p$ 使得 $p^2 \\mid n$。根据 Möbius 函数的定义，如果存在这样的素数，则 $\\mu(n) = 0$。\n因此，$\\mu^2(n) = (\\mu(n))^2 = 0^2 = 0$。\n\n情况 $2$：$n$ 是无平方因子数。\n如果 $n$ 是无平方因子数，那么它的素数分解为 $n = p_1 p_2 \\cdots p_k$，其中 $k \\ge 0$ 且素数各不相同。\n如果 $k=0$，则 $n=1$。根据定义，$\\mu(1) = 1$。因此，$\\mu^2(1) = 1^2 = 1$。整数 $1$ 是无平方因子数。\n如果 $k \\ge 1$，则 $n$ 是 $k$ 个不同素数的乘积。根据定义，$\\mu(n) = (-1)^k$。\n因此，$\\mu^2(n) = ((-1)^k)^2 = 1$。\n在这两种子情况下，如果 $n$ 是无平方因子数，则 $\\mu^2(n)=1$。\n\n综合这两种情况，我们证明了当 $n$ 是无平方因子数时 $\\mu^2(n) = 1$，否则 $\\mu^2(n) = 0$。这正是无平方因子数的特征函数的定义。\n\n第二，我们证明 $\\mu^2(n)$ 是一个积性函数。一个函数 $f$ 是积性函数，如果 $f(1) = 1$ 且对于所有互素的整数 $m, n$（即 $\\gcd(m,n)=1$），都有 $f(mn) = f(m)f(n)$。\n令 $f(n) = \\mu^2(n)$。\n第一个条件是 $f(1)=1$。如上所示，$\\mu^2(1)=1$，因此该条件满足。\n\n对于第二个条件，设 $m, n$ 是两个满足 $\\gcd(m,n)=1$ 的正整数。我们必须证明 $\\mu^2(mn) = \\mu^2(m)\\mu^2(n)$。我们使用刚刚证明的性质。\n\n情况 A：$m$ 或 $n$ 中至少有一个不是无平方因子数。\n假设 $m$ 不是无平方因子数。那么 $\\mu^2(m) = 0$。等式右边为 $\\mu^2(m)\\mu^2(n) = 0 \\cdot \\mu^2(n) = 0$。\n由于 $m$ 不是无平方因子数，存在一个素数 $p$ 使得 $p^2 \\mid m$。因为 $p^2 \\mid m$，所以 $p^2 \\mid mn$。因此，$mn$ 不是无平方因子数。\n这意味着 $\\mu^2(mn)=0$。\n等式变为 $0=0$，成立。如果 $n$ 不是无平方因子数，同样的论证也成立。\n\n情况 B：$m$ 和 $n$ 都是无平方因子数。\n如果 $m$ 和 $n$ 都是无平方因子数，那么 $\\mu^2(m) = 1$ 且 $\\mu^2(n) = 1$。等式右边为 $\\mu^2(m)\\mu^2(n) = 1 \\cdot 1 = 1$。\n现在我们考察等式左边 $\\mu^2(mn)$。\n由于 $m$ 和 $n$ 是无平方因子数，它们的素数分解由不同的素数组成。设 $m = p_1 \\cdots p_r$ 和 $n = q_1 \\cdots q_s$，其中 $\\{p_i\\}$ 和 $\\{q_j\\}$ 是不同的素数集合。\n因为 $\\gcd(m,n)=1$，$m$ 的素因数集合与 $n$ 的素因数集合不相交。即，对所有的 $i,j$ 都有 $p_i \\ne q_j$。\n因此，$mn$ 的素数分解是 $p_1 \\cdots p_r q_1 \\cdots q_s$。这是 $r+s$ 个不同素数的乘积。\n因此，$mn$ 是无平方因子数，这意味着 $\\mu^2(mn) = 1$。\n等式变为 $1=1$，成立。\n\n在所有情况下，对于 $\\gcd(m,n)=1$，我们都有 $\\mu^2(mn) = \\mu^2(m)\\mu^2(n)$。因此，$\\mu^2(n)$ 是一个积性函数。\n\n第三，我们计算因数和 $F(n) = \\sum_{d|n}\\mu^2(d)$。\n数论中有一个基本定理指出，如果 $f(n)$ 是一个积性函数，那么它的求和函数 $F(n) = \\sum_{d|n}f(d)$ 也是积性函数。\n因为我们已经证明了 $\\mu^2(n)$ 是积性函数，所以函数 $F(n) = \\sum_{d|n}\\mu^2(d)$ 也是积性函数。\n\n为了找到一个积性函数 $F(n)$ 的显式公式，我们只需在素数幂上计算它的值，即对于 $n=p^a$，其中 $p$ 是素数且 $a \\ge 1$ 是整数。然后，对于具有素数分解 $n = p_1^{a_1} p_2^{a_2} \\cdots p_k^{a_k}$ 的一般整数 $n$，由于 $F(n)$ 的积性，其值为 $F(n) = F(p_1^{a_1}) F(p_2^{a_2}) \\cdots F(p_k^{a_k})$。\n\n让我们计算当 $a \\ge 1$ 时 $F(p^a)$ 的值：\n$p^a$ 的因数 $d$ 是 $1, p, p^2, \\ldots, p^a$。\n所以，$F(p^a) = \\sum_{j=0}^{a} \\mu^2(p^j) = \\mu^2(p^0) + \\mu^2(p^1) + \\mu^2(p^2) + \\dots + \\mu^2(p^a)$。\n我们使用前面关于 $\\mu^2(n)$ 的结论：\n$\\mu^2(p^0) = \\mu^2(1) = 1$（因为 $1$ 是无平方因子数）。\n$\\mu^2(p^1) = \\mu^2(p) = 1$（因为素数 $p$ 是无平方因子数）。\n对于任何 $j \\ge 2$，整数 $p^j$ 能被 $p^2$ 整除，所以它不是无平方因子数。因此，对于 $j \\ge 2$，$\\mu^2(p^j) = 0$。\n\n将这些值代入 $F(p^a)$ 的和式中：\n$F(p^a) = 1 + 1 + 0 + \\dots + 0 = 2$。\n这个结果对任何素数 $p$ 和任何指数 $a \\ge 1$ 都成立。\n\n现在我们可以找到 $F(n)$ 的通用公式。设 $n$ 的素数分解为 $n = p_1^{a_1} p_2^{a_2} \\cdots p_k^{a_k}$，其中 $p_1, \\ldots, p_k$ 是 $n$ 的不同素因数，且 $a_i \\ge 1$。$n$ 的不同素因数的个数用 $\\omega(n)$ 表示，在此分解中即为 $k$。\n利用 $F(n)$ 的积性：\n$F(n) = F(p_1^{a_1} p_2^{a_2} \\cdots p_k^{a_k}) = F(p_1^{a_1}) F(p_2^{a_2}) \\cdots F(p_k^{a_k})$。\n因为对于每个 $i=1, \\ldots, k$，都有 $F(p_i^{a_i}) = 2$：\n$F(n) = \\underbrace{2 \\cdot 2 \\cdots 2}_{k \\text{ 次}} = 2^k$。\n\n由于 $k = \\omega(n)$，即 $n$ 的不同素因数的个数，我们有：\n$\\sum_{d|n}\\mu^2(d) = 2^{\\omega(n)}$。\n\n这个公式也对 $n=1$ 的边界情况成立。$1$ 的素因数集合是空的，所以 $\\omega(1)=0$。该公式给出 $2^{\\omega(1)} = 2^0 = 1$。直接计算为 $\\sum_{d|1}\\mu^2(d) = \\mu^2(1) = 1$。结果一致。\n因此，最终结果用 $\\omega(n)$ 表示。", "answer": "$$\n\\boxed{2^{\\omega(n)}}\n$$", "id": "3081494"}, {"introduction": "我们的最后一个练习将视角提升到代数结构的高度，来审视算术函数的集合。我们将探讨狄利克雷逆元这一概念，它赋予了算术函数集合在卷积运算下成为一个群的结构。在这个练习 [@problem_id:3081490] 中，你将计算基本幂函数 $f(n)=n^r$ 的逆。这个过程将演示一种在素数幂上寻找逆元的递推方法，并最终揭示一个连接幂函数、其逆元和莫比乌斯函数的深刻恒等式，彰显了这些概念之间内在的紧密联系。", "problem": "设 $r$ 为一个固定的实数，并定义算术函数 $f:\\mathbb{N}\\to\\mathbb{R}$ 为 $f(n)=n^{r}$。考虑狄利克雷卷积，对于算术函数 $f$ 和 $g$，其定义为\n$$\n(f*g)(n)\\;=\\;\\sum_{d\\mid n} f(d)\\,g\\!\\left(\\frac{n}{d}\\right).\n$$\n令 $\\varepsilon$ 表示狄利克雷卷积的单位元，其定义为 $\\varepsilon(1)=1$ 且当 $n>1$ 时 $\\varepsilon(n)=0$。$f$ 的狄利克雷逆 $f^{-1}$ 是满足 $f*f^{-1}=\\varepsilon$ 的唯一算术函数。\n\n仅使用这些定义以及积性函数的基本性质，完成以下任务：\n- 对于素数 $p$ 和整数 $k\\geq 0$，明确地求出 $f^{-1}(p^{k})$。\n- 推导出对于所有 $n\\in\\mathbb{N}$，$f^{-1}(n)$ 的闭式表达式，用莫比乌斯函数 $\\mu$ 表示。其中 $\\mu$ 的定义为 $\\mu(1)=1$，对于素数 $p$，$\\mu(p)=-1$，对于所有整数 $k\\geq 2$，$\\mu(p^{k})=0$，并以积性方式扩展到所有 $n$。\n\n你的最终答案必须是 $f^{-1}(n)$ 的一个用 $\\mu$ 和 $r$ 表示的单一闭式解析表达式。请提供精确表达式（无需四舍五入）。", "solution": "这个问题是有效的，因为它在数学上是适定的，其科学基础在于标准数论，并且其术语定义精确。我们可以开始解题。\n\n问题要求解算術函数 $f(n)=n^r$ （其中 $r$ 为固定实数）的狄利克雷逆 $f^{-1}$。狄利克雷逆 $f^{-1}$ 由关系式 $(f*f^{-1})(n) = \\varepsilon(n)$ 定义，其中 $*$ 表示狄利克雷卷积，$\\varepsilon$ 是卷积的乘法单位元，定义为 $\\varepsilon(1)=1$ 且当 $n>1$ 时 $\\varepsilon(n)=0$。\n\n函数 $f(n)=n^r$ 是完全积性函数，即对于所有正整数 $a$ 和 $b$，都有 $f(ab)=f(a)f(b)$。狄利克雷卷积的一个基本性质是，一个积性函数的逆也是积性函数。由于 $f$ 是完全积性的，所以它也是积性的，因此其逆 $f^{-1}$ 也必然是积性的。\n\n一个积性函数由其在素数幂上的取值唯一确定。因此，我们的第一步是确定对于素数 $p$ 和整数 $k \\geq 0$，$f^{-1}(p^k)$ 的值。\n\n对于 $n=1=p^0$，根据逆的定义有 $(f*f^{-1})(1) = \\varepsilon(1)=1$。卷积计算如下：\n$$ (f*f^{-1})(1) = \\sum_{d|1} f(d)f^{-1}\\left(\\frac{1}{d}\\right) = f(1)f^{-1}(1) $$\n由于 $f(1)=1^r=1$，我们得到 $1 \\cdot f^{-1}(1) = 1$，这意味着 $f^{-1}(1)=1$。这就给出了 $k=0$ 时的值。\n\n对于 $n=p^k$ 且 $k \\geq 1$，我们有 $(f*f^{-1})(p^k) = \\varepsilon(p^k)=0$。卷积为：\n$$ (f*f^{-1})(p^k) = \\sum_{d|p^k} f(d)f^{-1}\\left(\\frac{p^k}{d}\\right) = 0 $$\n$p^k$ 的因子是 $p^j$，其中 $j \\in \\{0, 1, \\dots, k\\}$。于是求和变为：\n$$ \\sum_{j=0}^{k} f(p^j)f^{-1}(p^{k-j}) = 0 $$\n代入 $f(p^j) = (p^j)^r = p^{jr}$，我们得到：\n$$ \\sum_{j=0}^{k} p^{jr}f^{-1}(p^{k-j}) = 0 $$\n我们可以展开这个和式，并分离出含有 $f^{-1}(p^k)$ 的项（对应于 $j=0$）：\n$$ f^{-1}(p^k) + \\sum_{j=1}^{k} p^{jr}f^{-1}(p^{k-j}) = 0 $$\n这为 $f^{-1}(p^k)$ 提供了一个递推关系：\n$$ f^{-1}(p^k) = -\\sum_{j=1}^{k} p^{jr}f^{-1}(p^{k-j}) $$\n让我们用这个关系式来求前几个值。\n当 $k=1$ 时：\n$$ f^{-1}(p) = -p^{1 \\cdot r}f^{-1}(p^{1-1}) = -p^r f^{-1}(1) = -p^r \\cdot 1 = -p^r $$\n当 $k=2$ 时：\n$$ f^{-1}(p^2) = -\\left( p^r f^{-1}(p) + p^{2r} f^{-1}(1) \\right) = -\\left( p^r(-p^r) + p^{2r}(1) \\right) = -(-p^{2r} + p^{2r}) = 0 $$\n当 $k=3$ 时：\n$$ f^{-1}(p^3) = -\\left( p^r f^{-1}(p^2) + p^{2r} f^{-1}(p) + p^{3r} f^{-1}(1) \\right) = -\\left( p^r(0) + p^{2r}(-p^r) + p^{3r}(1) \\right) = -(-p^{3r} + p^{3r}) = 0 $$\n这个规律表明，对于所有 $k \\geq 2$，$f^{-1}(p^k) = 0$。我们用数学归纳法证明这一点。奠基步骤 $k=2$ 已经成立。假设对于某个整数 $K > 2$，对于所有 $2 \\leq j  K$，都有 $f^{-1}(p^j)=0$。我们要证明 $f^{-1}(p^K)=0$。\n根据递推关系：\n$$ f^{-1}(p^K) = - \\sum_{j=1}^{K} p^{jr}f^{-1}(p^{K-j}) = -\\left( p^r f^{-1}(p^{K-1}) + \\sum_{j=2}^{K-2} p^{jr}f^{-1}(p^{K-j}) + p^{(K-1)r}f^{-1}(p) + p^{Kr}f^{-1}(1) \\right) $$\n根据归纳假设，当 $j$ 满足 $2 \\leq K-j  K$ 时，$f^{-1}(p^{K-j})=0$。这个条件等价于 $0  j \\leq K-2$。因此，和式中 $j=1, \\dots, K-2$ 的所有项都为零。和式简化为 $j=K-1$ 和 $j=K$ 的项：\n$$ f^{-1}(p^K) = -\\left( p^{(K-1)r}f^{-1}(p^1) + p^{Kr}f^{-1}(p^0) \\right) $$\n使用 $f^{-1}(p)=-p^r$ 和 $f^{-1}(1)=1$，我们得到：\n$$ f^{-1}(p^K) = -\\left( p^{(K-1)r}(-p^r) + p^{Kr}(1) \\right) = -\\left( -p^{Kr} + p^{Kr} \\right) = 0 $$\n归纳完成。所以，我们已经明确地确定了 $f^{-1}(p^k)$：\n$$ f^{-1}(p^k) = \\begin{cases} 1  \\text{if } k=0 \\\\ -p^r  \\text{if } k=1 \\\\ 0  \\text{if } k \\geq 2 \\end{cases} $$\n现在我们推导 $f^{-1}(n)$ 的闭式表达式。由于 $f^{-1}$ 是积性函数，如果 $n$ 的素数分解为 $n = p_1^{k_1} p_2^{k_2} \\cdots p_m^{k_m}$，那么：\n$$ f^{-1}(n) = f^{-1}(p_1^{k_1}) f^{-1}(p_2^{k_2}) \\cdots f^{-1}(p_m^{k_m}) $$\n我们考虑关于 $n$ 的两种情况。\n\n情况1：$n$ 不是无平方因子数。\n这意味着至少存在一个素因子 $p_i$，其指数 $k_i$ 大于或等于 $2$。在这种情况下，乘积中的因子 $f^{-1}(p_i^{k_i})$ 将为 $0$，从而使整个乘积为零。所以，如果 $n$ 不是无平方因子数，$f^{-1}(n)=0$。\n根据定义，如果 $n$ 不是无平方因子数，莫比乌斯函数 $\\mu(n)$ 也为 $0$。因此，对于这样的 $n$，$f^{-1}(n) = 0 = \\mu(n)n^r$。\n\n情况2：$n$ 是无平方因子数。\n这意味着素数分解中的所有指数 $k_i$ 都等于 $1$。所以 $n=p_1 p_2 \\cdots p_m$，其中 $p_i$ 是不同的素数（如果 $n=1$，则 $m=0$）。\n如果 $n=1$，我们有 $f^{-1}(1)=1$，并且 $\\mu(1)1^r=1$。该公式成立。\n如果 $n = p_1 p_2 \\cdots p_m$ 且 $m \\geq 1$：\n$$ f^{-1}(n) = \\prod_{i=1}^m f^{-1}(p_i) $$\n使用我们的结果 $f^{-1}(p)=-p^r$，我们有：\n$$ f^{-1}(n) = \\prod_{i=1}^m (-p_i^r) = (-1)^m \\prod_{i=1}^m p_i^r = (-1)^m \\left( \\prod_{i=1}^m p_i \\right)^r = (-1)^m n^r $$\n对于无平方因子数 $n = p_1 p_2 \\cdots p_m$，莫比乌斯函数定义为 $\\mu(n)=(-1)^m$。\n将此代入我们关于 $f^{-1}(n)$ 的表达式中：\n$$ f^{-1}(n) = \\mu(n)n^r $$\n这个公式对所有无平方因子数的 $n$ 都成立。\n\n由于表达式 $f^{-1}(n) = \\mu(n)n^r$ 对无平方因子数和非无平方因子数都成立，因此它是对于所有 $n \\in \\mathbb{N}$，$f^{-1}(n)$ 的通用闭式表达式。", "answer": "$$\n\\boxed{\\mu(n)n^{r}}\n$$", "id": "3081490"}]}