{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式莫过于亲手实践。本节将引导你通过具体的计算，来掌握求解佩尔方程的核心方法。第一个练习将聚焦于负佩尔方程 $x^2 - Dy^2 = -1$ 的可解性，这完全取决于 $\\sqrt{D}$ 的连分数展开的周期长度。通过完成这个练习 ([@problem_id:3085364])，你将完整地走过一遍从计算连分数到确定最小正整数解的全过程，为处理更复杂的问题打下坚实的基础。", "problem": "设 $D$ 为一个无平方因子的正整数，考虑负佩尔方程 $x^{2} - D y^{2} = -1$。利用以下基本事实：\n- 对于无平方因子的 $D  1$，$\\sqrt{D}$ 的简单连分数是周期的。\n- $\\sqrt{D}$ 的收敛子 $p_{n}/q_{n}$ 由初始条件 $p_{-1} = 1$, $q_{-1} = 0$, $p_{0} = a_{0}$, $q_{0} = 1$ 和递推关系 $p_{n} = a_{n} p_{n-1} + p_{n-2}$, $q_{n} = a_{n} q_{n-1} + q_{n-2}$ (对于 $n \\ge 1$) 定义，其中 $[a_{0}; a_{1}, a_{2}, \\dots]$ 是 $\\sqrt{D}$ 的连分数。\n\n通过标准的二次无理数连分数算法明确计算出 $\\sqrt{29}$ 的简单连分数展开的周期，来研究 $D = 29$ 的具体情况，并利用周期的奇偶性判断方程 $x^{2} - 29 y^{2} = -1$ 是否在正整数上有解。如果有解，确定最小的正整数 $x$，使得存在一个正整数 $y$ 满足 $x^{2} - 29 y^{2} = -1$。您的最终答案必须是这个最小 $x$ 的值，以整数形式写出。无需四舍五入。", "solution": "该问题提法严谨且科学上成立，以既有的佩尔方程和连分数数学理论为基础。所有提供的信息均自洽且一致。\n\n该问题要求解负佩尔方程 $x^{2} - 29 y^{2} = -1$ 的最小正整数解 $x$。该方程的可解性与 $\\sqrt{29}$ 的简单连分数展开的周期长度的奇偶性直接相关。\n\n首先，我们使用标准算法计算 $\\sqrt{29}$ 的连分数展开。令 $\\xi_0 = \\sqrt{29}$。我们如下生成一个整数序列 $a_n$ 和余项 $\\xi_{n+1}$：$a_n = \\lfloor \\xi_n \\rfloor$ 且 $\\xi_{n+1} = \\frac{1}{\\xi_n - a_n}$。\n\n对于 $n=0$:\n$a_0 = \\lfloor \\sqrt{29} \\rfloor = 5$。\n$\\xi_1 = \\frac{1}{\\sqrt{29} - 5} = \\frac{\\sqrt{29} + 5}{29 - 25} = \\frac{\\sqrt{29} + 5}{4}$。\n\n对于 $n=1$:\n$a_1 = \\left\\lfloor \\frac{\\sqrt{29} + 5}{4} \\right\\rfloor = \\left\\lfloor \\frac{5.385... + 5}{4} \\right\\rfloor = \\lfloor 2.596... \\rfloor = 2$。\n$\\xi_2 = \\frac{1}{\\frac{\\sqrt{29} + 5}{4} - 2} = \\frac{4}{\\sqrt{29} - 3} = \\frac{4(\\sqrt{29} + 3)}{29 - 9} = \\frac{\\sqrt{29} + 3}{5}$。\n\n对于 $n=2$:\n$a_2 = \\left\\lfloor \\frac{\\sqrt{29} + 3}{5} \\right\\rfloor = \\left\\lfloor \\frac{5.385... + 3}{5} \\right\\rfloor = \\lfloor 1.677... \\rfloor = 1$。\n$\\xi_3 = \\frac{1}{\\frac{\\sqrt{29} + 3}{5} - 1} = \\frac{5}{\\sqrt{29} - 2} = \\frac{5(\\sqrt{29} + 2)}{29 - 4} = \\frac{\\sqrt{29} + 2}{5}$。\n\n对于 $n=3$:\n$a_3 = \\left\\lfloor \\frac{\\sqrt{29} + 2}{5} \\right\\rfloor = \\left\\lfloor \\frac{5.385... + 2}{5} \\right\\rfloor = \\lfloor 1.477... \\rfloor = 1$。\n$\\xi_4 = \\frac{1}{\\frac{\\sqrt{29} + 2}{5} - 1} = \\frac{5}{\\sqrt{29} - 3} = \\frac{5(\\sqrt{29} + 3)}{29 - 9} = \\frac{\\sqrt{29} + 3}{4}$。\n\n对于 $n=4$:\n$a_4 = \\left\\lfloor \\frac{\\sqrt{29} + 3}{4} \\right\\rfloor = \\left\\lfloor \\frac{5.385... + 3}{4} \\right\\rfloor = \\lfloor 2.096... \\rfloor = 2$。\n$\\xi_5 = \\frac{1}{\\frac{\\sqrt{29} + 3}{4} - 2} = \\frac{4}{\\sqrt{29} - 5} = \\frac{4(\\sqrt{29} + 5)}{29 - 25} = \\sqrt{29} + 5$。\n\n对于 $n=5$:\n$a_5 = \\lfloor \\sqrt{29} + 5 \\rfloor = 5 + 5 = 10$。\n$\\xi_6 = \\frac{1}{(\\sqrt{29} + 5) - 10} = \\frac{1}{\\sqrt{29} - 5} = \\xi_1$。\n\n由于 $\\xi_6 = \\xi_1$，对于 $n \\geq 1$ 的系数序列 $a_n$ 是周期的。$\\sqrt{29}$ 的连分数展开式为 $[a_0; \\overline{a_1, a_2, a_3, a_4, a_5}]$。\n系数为 $a_0 = 5$，周期部分为 $(a_1, a_2, a_3, a_4, a_5) = (2, 1, 1, 2, 10)$。\n周期长度为 $k=5$。\n\n数论中的一个基本定理指出，负佩尔方程 $x^2 - Dy^2 = -1$ 在正整数上有解，当且仅当 $\\sqrt{D}$ 的连分数周期长度 $k$ 是奇数。对于 $D=29$，周期长度为 $k=5$，这是一个奇数。因此，方程 $x^2 - 29y^2 = -1$ 在正整数上有解。\n\n同一定理指出，$x^2 - Dy^2 = -1$ 的基本解（最小正整数解）$(x_1, y_1)$ 由收敛子 $(x_1, y_1) = (p_{k-1}, q_{k-1})$ 给出，其中 $p_{k-1}/q_{k-1}$ 是 $\\sqrt{D}$ 的第 $(k-1)$ 个收敛子。当 $k=5$ 时，我们需要计算收敛子 $p_4/q_4$。\n\n我们使用给定的递推关系：\n$p_n = a_n p_{n-1} + p_{n-2}$\n$q_n = a_n q_{n-1} + q_{n-2}$\n初始条件为 $p_{-1} = 1$，$q_{-1} = 0$，$p_0 = a_0 = 5$，以及 $q_0 = 1$。所需的系数为 $a_1=2, a_2=1, a_3=1, a_4=2$。\n\n对于 $n=1$:\n$p_1 = a_1 p_0 + p_{-1} = 2(5) + 1 = 11$。\n$q_1 = a_1 q_0 + q_{-1} = 2(1) + 0 = 2$。\n\n对于 $n=2$:\n$p_2 = a_2 p_1 + p_0 = 1(11) + 5 = 16$。\n$q_2 = a_2 q_1 + q_0 = 1(2) + 1 = 3$。\n\n对于 $n=3$:\n$p_3 = a_3 p_2 + p_1 = 1(16) + 11 = 27$。\n$q_3 = a_3 q_2 + q_1 = 1(3) + 2 = 5$。\n\n对于 $n=4$:\n$p_4 = a_4 p_3 + p_2 = 2(27) + 16 = 54 + 16 = 70$。\n$q_4 = a_4 q_3 + q_2 = 2(5) + 3 = 10 + 3 = 13$。\n\n基本解是 $(x_1, y_1) = (p_4, q_4) = (70, 13)$。我们可以验证这个结果：\n$x_1^2 - 29 y_1^2 = 70^2 - 29(13^2) = 4900 - 29(169) = 4900 - 4901 = -1$。\n该解是正确的。问题要求满足该方程的最小正整数 $x$。这对应于基本解的 $x$ 分量。\n因此，$x$ 的最小值为 $70$。", "answer": "$$\n\\boxed{70}\n$$", "id": "3085364"}, {"introduction": "掌握了基本方法后，让我们来挑战一个更著名也更具挑战性的例子。佩尔方程的解有时会出人意料地巨大，而 $D=61$ 的情形正是一个经典范例。这个练习 ([@problem_id:3085362]) 不仅要求你应用连分数法处理一个更长的周期，还将让你亲身體会到，当连分数周期为奇数时，如何通过代数上的“平方”操作从负佩尔方程的解过渡到正佩尔方程的解。这个过程会清晰地揭示为何某些佩尔方程的最小解会如此庞大。", "problem": "设 $D$ 为一个非平方正整数，考虑佩尔方程 $x^{2} - D y^{2} = 1$。其基本解是指满足该方程且拥有最小正 $x_{1}$ 的整数对 $(x_{1}, y_{1}) \\in \\mathbb{Z}_{0}^{2}$。佩尔方程与 $\\sqrt{D}$ 的连分数（CF）展开之间的经典联系如下：$\\sqrt{D}$ 的正则连分数的渐近分数可以产生无穷多对整数解 $(x, y)$，满足 $x^{2} - D y^{2} = \\pm 1$，并且周期的长度的奇偶性决定了负佩尔方程 $x^{2} - D y^{2} = -1$ 是否有解。\n\n仅根据这些原理和定义（不借助任何预先制成的表格结果），对 $D = 61$ 完成以下操作：\n- 构建 $\\sqrt{61}$ 的连分数展开，至少包含一个完整周期，并确定周期长度。\n- 使用渐近分数来验证 $x^{2} - 61 y^{2} = -1$ 是否可解。\n- 由此推导出 $x^{2} - 61 y^{2} = 1$ 的基本解 $(x_{1}, y_{1})$。\n- 根据你找到的周期长度，论证为何 $x^{2} - 61 y^{2} = 1$ 的最小正整数解相对于 $D$ 异常地大，并精确说明周期奇偶性如何使得从 $x^{2} - 61 y^{2} = -1$ 的解到 $x^{2} - 61 y^{2} = 1$ 的解的过程中，必然出现一个平方现象。\n\n你的最终答案只需报告 $x^{2} - 61 y^{2} = 1$ 的基本解的最小 $x$ 坐标 $x_{1}$。无需四舍五入；请提供精确的整数。", "solution": "该问题是有效的，因为它是数论中一个良构问题，其基础是连分数和佩尔方程的既定原理。\n\n该问题要求对整数 $D=61$ 执行几个步骤。\n\n首先，我们构建 $\\sqrt{61}$ 的连分数展开。我们使用标准算法。设 $\\alpha_0 = \\sqrt{61}$。其整数部分为 $a_0 = \\lfloor\\sqrt{61}\\rfloor = 7$，因为 $7^2=49$ 且 $8^2=64$。\n递归过程定义为 $a_n = \\lfloor\\alpha_n\\rfloor$ 和 $\\alpha_{n+1} = \\frac{1}{\\alpha_n - a_n}$。\n\n当 $n=0$ 时：\n$a_0 = \\lfloor\\sqrt{61}\\rfloor = 7$。\n$\\alpha_1 = \\frac{1}{\\sqrt{61}-7} = \\frac{\\sqrt{61}+7}{61-49} = \\frac{\\sqrt{61}+7}{12}$。\n\n当 $n=1$ 时：\n$a_1 = \\lfloor\\frac{\\sqrt{61}+7}{12}\\rfloor = \\lfloor\\frac{7.81\\dots+7}{12}\\rfloor = \\lfloor\\frac{14.81\\dots}{12}\\rfloor = 1$。\n$\\alpha_2 = \\frac{1}{\\frac{\\sqrt{61}+7}{12}-1} = \\frac{12}{\\sqrt{61}-5} = \\frac{12(\\sqrt{61}+5)}{61-25} = \\frac{12(\\sqrt{61}+5)}{36} = \\frac{\\sqrt{61}+5}{3}$。\n\n当 $n=2$ 时：\n$a_2 = \\lfloor\\frac{\\sqrt{61}+5}{3}\\rfloor = \\lfloor\\frac{7.81\\dots+5}{3}\\rfloor = \\lfloor\\frac{12.81\\dots}{3}\\rfloor = 4$。\n$\\alpha_3 = \\frac{1}{\\frac{\\sqrt{61}+5}{3}-4} = \\frac{3}{\\sqrt{61}-7} = \\frac{3(\\sqrt{61}+7)}{61-49} = \\frac{3(\\sqrt{61}+7)}{12} = \\frac{\\sqrt{61}+7}{4}$。\n\n当 $n=3$ 时：\n$a_3 = \\lfloor\\frac{\\sqrt{61}+7}{4}\\rfloor = \\lfloor\\frac{7.81\\dots+7}{4}\\rfloor = \\lfloor\\frac{14.81\\dots}{4}\\rfloor = 3$。\n$\\alpha_4 = \\frac{1}{\\frac{\\sqrt{61}+7}{4}-3} = \\frac{4}{\\sqrt{61}-5} = \\frac{4(\\sqrt{61}+5)}{61-25} = \\frac{4(\\sqrt{61}+5)}{36} = \\frac{\\sqrt{61}+5}{9}$。\n\n当 $n=4$ 时：\n$a_4 = \\lfloor\\frac{\\sqrt{61}+5}{9}\\rfloor = \\lfloor\\frac{7.81\\dots+5}{9}\\rfloor = \\lfloor\\frac{12.81\\dots}{9}\\rfloor = 1$。\n$\\alpha_5 = \\frac{1}{\\frac{\\sqrt{61}+5}{9}-1} = \\frac{9}{\\sqrt{61}-4} = \\frac{9(\\sqrt{61}+4)}{61-16} = \\frac{9(\\sqrt{61}+4)}{45} = \\frac{\\sqrt{61}+4}{5}$。\n\n当 $n=5$ 时：\n$a_5 = \\lfloor\\frac{\\sqrt{61}+4}{5}\\rfloor = \\lfloor\\frac{7.81\\dots+4}{5}\\rfloor = \\lfloor\\frac{11.81\\dots}{5}\\rfloor = 2$。\n$\\alpha_6 = \\frac{1}{\\frac{\\sqrt{61}+4}{5}-2} = \\frac{5}{\\sqrt{61}-6} = \\frac{5(\\sqrt{61}+6)}{61-36} = \\frac{5(\\sqrt{61}+6)}{25} = \\frac{\\sqrt{61}+6}{5}$。\n\n当 $n=6$ 时：\n$a_6 = \\lfloor\\frac{\\sqrt{61}+6}{5}\\rfloor = \\lfloor\\frac{7.81\\dots+6}{5}\\rfloor = \\lfloor\\frac{13.81\\dots}{5}\\rfloor = 2$。\n$\\alpha_7 = \\frac{1}{\\frac{\\sqrt{61}+6}{5}-2} = \\frac{5}{\\sqrt{61}-4} = \\frac{5(\\sqrt{61}+4)}{61-16} = \\frac{\\sqrt{61}+4}{9}$。\n\n当 $n=7$ 时：\n$a_7 = \\lfloor\\frac{\\sqrt{61}+4}{9}\\rfloor = \\lfloor\\frac{7.81\\dots+4}{9}\\rfloor = \\lfloor\\frac{11.81\\dots}{9}\\rfloor = 1$。\n$\\alpha_8 = \\frac{1}{\\frac{\\sqrt{61}+4}{9}-1} = \\frac{9}{\\sqrt{61}-5} = \\frac{9(\\sqrt{61}+5)}{61-25} = \\frac{\\sqrt{61}+5}{4}$。\n\n当 $n=8$ 时：\n$a_8 = \\lfloor\\frac{\\sqrt{61}+5}{4}\\rfloor = \\lfloor\\frac{7.81\\dots+5}{4}\\rfloor = \\lfloor\\frac{12.81\\dots}{4}\\rfloor = 3$。\n$\\alpha_9 = \\frac{1}{\\frac{\\sqrt{61}+5}{4}-3} = \\frac{4}{\\sqrt{61}-7} = \\frac{4(\\sqrt{61}+7)}{61-49} = \\frac{\\sqrt{61}+7}{3}$。\n\n当 $n=9$ 时：\n$a_9 = \\lfloor\\frac{\\sqrt{61}+7}{3}\\rfloor = \\lfloor\\frac{7.81\\dots+7}{3}\\rfloor = \\lfloor\\frac{14.81\\dots}{3}\\rfloor = 4$。\n$\\alpha_{10} = \\frac{1}{\\frac{\\sqrt{61}+7}{3}-4} = \\frac{3}{\\sqrt{61}-5} = \\frac{3(\\sqrt{61}+5)}{61-25} = \\frac{\\sqrt{61}+5}{12}$。\n\n当 $n=10$ 时：\n$a_{10} = \\lfloor\\frac{\\sqrt{61}+5}{12}\\rfloor = \\lfloor\\frac{7.81\\dots+5}{12}\\rfloor = \\lfloor\\frac{12.81\\dots}{12}\\rfloor = 1$。\n$\\alpha_{11} = \\frac{1}{\\frac{\\sqrt{61}+5}{12}-1} = \\frac{12}{\\sqrt{61}-7} = \\frac{12(\\sqrt{61}+7)}{61-49} = \\sqrt{61}+7$。\n\n当 $n=11$ 时：\n$a_{11} = \\lfloor\\sqrt{61}+7\\rfloor = \\lfloor 7.81\\dots+7 \\rfloor = 14$。\n$\\alpha_{12} = \\frac{1}{(\\sqrt{61}+7)-14} = \\frac{1}{\\sqrt{61}-7} = \\alpha_1$。\n由于 $\\alpha_{12}=\\alpha_1$，不完全商序列是周期的。$\\sqrt{61}$ 的连分数展开为 $[7; \\overline{1, 4, 3, 1, 2, 2, 1, 3, 4, 1, 14}]$。\n周期长度为 $k=11$。\n\n接下来，我们验证 $x^2 - 61y^2 = -1$ 是否可解。佩尔方程理论中的一个关键定理指出，负佩尔方程 $x^2 - Dy^2 = -1$ 有整数解当且仅当 $\\sqrt{D}$ 的连分数周期长度 $k$ 为奇数。由于我们求得 $k=11$，是一个奇数，方程 $x^2 - 61y^2 = -1$ 确实可解。\n\n现在，我们推导 $x^2 - 61y^2 = 1$ 的基本解 $(x_1, y_1)$。当周期长度 $k$ 为奇数时，$x^2 - Dy^2 = -1$ 的基本解，我们称之为 $(x_f, y_f)$，由 $\\sqrt{D}$ 的第 $(k-1)$ 个渐近分数给出，即 $(p_{k-1}, q_{k-1}) = (p_{10}, q_{10})$。我们使用递推关系 $p_n = a_n p_{n-1} + p_{n-2}$ 和 $q_n = a_n q_{n-1} + q_{n-2}$ 来计算渐近分数 $p_n/q_n$，初始值为 $p_{-1}=1, p_{-2}=0$ 和 $q_{-1}=0, q_{-2}=1$。\n$a_0=7: p_0=7, q_0=1$\n$a_1=1: p_1=8, q_1=1$\n$a_2=4: p_2=4(8)+7=39, q_2=4(1)+1=5$\n$a_3=3: p_3=3(39)+8=125, q_3=3(5)+1=16$\n$a_4=1: p_4=1(125)+39=164, q_4=1(16)+5=21$\n$a_5=2: p_5=2(164)+125=453, q_5=2(21)+16=58$\n$a_6=2: p_6=2(453)+164=1070, q_6=2(58)+21=137$\n$a_7=1: p_7=1(1070)+453=1523, q_7=1(137)+58=195$\n$a_8=3: p_8=3(1523)+1070=5639, q_8=3(195)+137=722$\n$a_9=4: p_9=4(5639)+1523=24079, q_9=4(722)+195=3083$\n$a_{10}=1: p_{10}=1(24079)+5639=29718, q_{10}=1(3083)+722=3805$\n所以，$x^2-61y^2 = -1$ 的基本解是 $(x_f, y_f) = (29718, 3805)$。我们可以验证：$29718^2 - 61 \\cdot 3805^2 = 883159524 - 61 \\cdot 14478025 = 883159524 - 883159525 = -1$。\n\n为了找到 $x^2 - 61y^2 = 1$ 的基本解 $(x_1, y_1)$，我们利用解的代数结构。如果 $x_f+y_f\\sqrt{D}$ 对应于 $x^2-Dy^2=-1$ 的一个解，那么它的平方 $(x_f+y_f\\sqrt{D})^2$ 就对应于 $x^2-Dy^2=1$ 的一个解，因为 $(x_f^2-Dy_f^2)^2 = (-1)^2=1$。\n基本解 $(x_1, y_1)$ 通过展开下式得到：\n$x_1 + y_1\\sqrt{61} = (x_f + y_f\\sqrt{61})^2 = (29718 + 3805\\sqrt{61})^2$\n$x_1 + y_1\\sqrt{61} = (29718^2 + 61 \\cdot 3805^2) + (2 \\cdot 29718 \\cdot 3805)\\sqrt{61}$\n比较有理数部分，我们得到 $x_1 = x_f^2 + 61 y_f^2$。\n使用我们的验证值，$x_1 = 883159524 + 883159525 = 1766319049$。\n基本解是 $(x_1, y_1) = (1766319049, 226154980)$。\n\n最后，我们说明为什么这个解异常地大。$x^2 - Dy^2 = 1$ 的基本解的大小与 $\\sqrt{D}$ 连分数的周期长度 $k$ 有关。\n如果 $k$ 是偶数，基本解将是 $(p_{k-1}, q_{k-1})$。\n然而，对于 $D=61$，周期长度 $k=11$ 是奇数。这导致了两个后果，从而产生一个很大的解。首先，周期长度11相对较长，这意味着渐近分数 $p_{10}/q_{10}$ 的分量本身已经是很大的数。其次，更关键的是，周期的奇数性导致了一个“平方现象”。$x^2-61y^2=1$ 的第一个正整数解不是 $(p_{10}, q_{10})$，而是由它派生出来的。第 $(k-1)$ 个渐近分数只给出了负佩尔方程 $x^2-61y^2=-1$ 的基本解。为了得到正佩尔方程的解，我们必须有效地进行到连分数展开的第二个周期结束，得到解 $(p_{2k-1}, q_{2k-1})=(p_{21}, q_{21})$。从代数上讲，这对应于将数域 $\\mathbb{Q}(\\sqrt{61})$ 中范数为 $-1$ 的基本单位进行平方。因此，基本解 $(x_1, y_1)$ 的坐标是基于 $(x_f, y_f)$ 本身已经很大的坐标的二次方，从而导致 $x_1$ 的值异常地大。\n\n所要求的最终答案是最小正整数 $x$ 坐标，$x_1$。\n$x_1 = 1766319049$。", "answer": "$$\\boxed{1766319049}$$", "id": "3085362"}, {"introduction": "求解佩尔方程并非只有连分数这一条路。在欧洲数学家之前，印度数学家早已发展出一种名为“查克拉瓦拉法”（Chakravala method）的巧妙算法。该方法基于婆羅摩笈多恒等式，通过迭代逐步“修正”辅助方程 $a^2 - Db^2 = k$ 中的 $k$ 值，直至其变为 $1$。这个练习 ([@problem_id:3085416]) 将指导你推导并应用这一古老而高效的方法，让你领略到代数恒等式和同余理论在解决丢番图方程中的威力，并感受数论跨越文明的魅力。", "problem": "考虑佩尔方程 $x^{2}-D y^{2}=1$，其中 $D0$ 是一个非平方整数。Chakravala 方法是一种循环算法，其基础是环 $\\mathbb{Z}[\\sqrt{D}]$ 中范数的复合属性，该属性源于婆罗摩笈多恒等式，即对于所有整数 $a, b, c, d$，有\n$$\n(a^{2}-D b^{2})(c^{2}-D d^{2})=(ac+D bd)^{2}-D(ad+bc)^{2}.\n$$\n从该恒等式和初等数论出发，推导一个通用的一步更新规则。给定一个满足 $a^{2}-D b^{2}=k$（其中 $k \\neq 0$）的三元组 $(a,b,k)$，该规则能生成一个同样形式的新三元组 $(a',b',k')$。解释整数参数 $m$ 的选择标准，该标准能使更新有效，并使 $|k|$ 趋向于 $1$。\n\n然后，将您的推导应用于 $D=26$ 的特定情况。从一个自然选择的初始值开始执行 Chakravala 迭代，并根据您的标准论证每次对 $m$ 的选择。继续迭代，直到获得 $k=\\pm 1$ 为止，然后解释 $x^{2}-26 y^{2}=1$ 的最小正整数解 $(x,y)$ 是如何产生的。您的最终答案必须是最小正整数 $x$。\n\n以单个整数形式提供最终答案。无需四舍五入。", "solution": "该问题是有效的，因为它在数论方面有科学依据，问题提出得当且客观。它包含求解佩尔方程的 Chakravala 方法的标准推导和应用，这是数学中的一个经典课题。\n\n该问题要求分为三个主要部分：首先，推导 Chakravala 方法的通用一步更新规则；其次，将此方法应用于特定的佩尔方程 $x^{2}-26 y^{2}=1$；第三，求出 $x$ 的最小正整数解。\n\n**第一部分：Chakravala 更新规则及选择标准的推导**\n\nChakravala 方法是一种求解佩尔方程 $x^{2}-D y^{2}=1$ 的迭代算法，其中 $D$ 是一个非平方正整数。该方法从一个整数三元组 $(a, b, k)$ 开始，满足 $a^{2}-D b^{2}=k$，其中 $k$ 是某个非零整数。目标是生成一系列这样的三元组 $(a_i, b_i, k_i)$，其中 $|k_i|$ 的值逐渐减小，直到找到一个 $k_n=1$ 的三元组。\n\n该方法的核心基于婆罗摩笈多恒等式：\n$$\n(x_1^2 - D y_1^2)(x_2^2 - D y_2^2) = (x_1 x_2 + D y_1 y_2)^2 - D (x_1 y_2 + x_2 y_1)^2\n$$\n该恒等式表明，如果我们有两个数对 $(x_1, y_1)$ 和 $(x_2, y_2)$，在类佩尔形式中分别得到结果 $k_1$ 和 $k_2$，它们的复合会为结果 $k_1 k_2$ 提供一个新的数对。\n\nChakravala 方法巧妙地将当前解 $(a, b, k)$ 与一个形如 $(m, 1)$ 的平凡解复合，该平凡解满足 $m^{2}-D(1)^{2} = m^{2}-D$。将婆罗摩笈多恒等式应用于 $(a, b)$ 和 $(m, 1)$ 会得到：\n$$\nk(m^2-D) = (am + Db)^2 - D(a+bm)^2\n$$\n这本身不是更新规则，但它构成了基础。关键的洞察是通过缩放构造一个新的、“更小”的解。一步更新规则定义如下：给定一个三元组 $(a, b, k)$ 满足 $a^{2}-D b^{2}=k$，我们找到一个整数 $m$ 并通过以下关系定义一个新的三元组 $(a', b', k')$：\n$$\na' = \\frac{am+Db}{k}, \\quad b' = \\frac{a+bm}{k}, \\quad k' = \\frac{m^2-D}{k}\n$$\n我们必须首先验证这个新的三元组满足同样的形式，即 $a'^{2} - D b'^{2} = k'$。暂时假设 $a', b', k'$ 均为整数，我们有：\n$$\na'^{2} - D b'^{2} = \\left(\\frac{am+Db}{k}\\right)^2 - D \\left(\\frac{a+bm}{k}\\right)^2 \\\\\n= \\frac{1}{k^2} \\left[ (a^2m^2 + 2abDm + D^2b^2) - D(a^2 + 2abm + b^2m^2) \\right] \\\\\n= \\frac{1}{k^2} \\left[ a^2m^2 + 2abDm + D^2b^2 - Da^2 - 2abDm - Db^2m^2 \\right] \\\\\n= \\frac{1}{k^2} \\left[ m^2(a^2 - Db^2) - D(a^2 - Db^2) \\right] \\\\\n= \\frac{1}{k^2} \\left[ m^2k - Dk \\right] = \\frac{k(m^2-D)}{k^2} = \\frac{m^2-D}{k} = k'\n$$\n这就证实了更新规则的有效性，前提是 $a', b', k'$ 均为整数。\n\n整数参数 $m$ 的选择标准旨在确保两件事：第一，$a', b', k'$ 是整数；第二，迭代通过减小 $|k|$ 来取得进展。\n\n为了使 $a', b', k'$ 为整数，它们定义中的分子必须能被 $k$ 整除。\n我们来分析这些整除性条件。我们要求：\n$1.$ $a+bm \\equiv 0 \\pmod{|k|}$\n$2.$ $am+Db \\equiv 0 \\pmod{|k|}$\n$3.$ $m^2-D \\equiv 0 \\pmod{|k|}$\n\n我们假设从一个本原解开始，即 $\\gcd(a, b) = 1$。由 $a^2-Db^2=k$，我们有 $\\gcd(b,k) = \\gcd(b, a^2-Db^2) = \\gcd(b, a^2)$。由于 $\\gcd(a,b)=1$，我们必有 $\\gcd(b, a^2)=1$，所以 $\\gcd(b,k)=1$。\n\n在 $\\gcd(b,k)=1$ 的条件下，同余式 $a+bm \\equiv 0 \\pmod{|k|}$（或 $bm \\equiv -a \\pmod{|k|}$）对于 $m$ 模 $|k|$ 有唯一解。我们来证明这个单一条件蕴含了另外两个条件。\n如果 $a+bm \\equiv 0 \\pmod{|k|}$，那么 $a \\equiv -bm \\pmod{|k|}$。\n将此代入初始方程模 $|k|$：\n$a^2 - Db^2 = k \\implies a^2 - Db^2 \\equiv 0 \\pmod{|k|}$\n$(-bm)^2 - Db^2 \\equiv 0 \\pmod{|k|}$\n$b^2m^2 - Db^2 \\equiv 0 \\pmod{|k|}$\n$b^2(m^2-D) \\equiv 0 \\pmod{|k|}$\n既然我们已经确定 $\\gcd(b,k)=1$，我们也有 $\\gcd(b^2, |k|)=1$。因此，我们可以除以 $b^2$ 得到 $m^2-D \\equiv 0 \\pmod{|k|}$。这证明了条件1蕴含了条件3。\n\n现在，我们来证明条件1和条件3蕴含了条件2：\n$am+Db \\equiv (-bm)m+Db \\pmod{|k|} \\quad$ (使用 $a \\equiv -bm$)\n$\\equiv -bm^2+Db = -b(m^2-D) \\pmod{|k|}$\n由于 $m^2-D \\equiv 0 \\pmod{|k|}$，因此 $-b(m^2-D) \\equiv 0 \\pmod{|k|}$。这就证明了条件2。\n\n所以，对 $m$ 的主要要求是它是线性同余式 $a+bm \\equiv 0 \\pmod{|k|}$ 的一个解。这为 $m$ 产生了一组可能的值，形式为 $m = m_0 + n|k|$，其中 $n$ 是任意整数，$m_0$ 是一个特解。\n\n为了使 $|k|$ 趋向于 $1$，我们必须选择使下一个 $|k'| = |\\frac{m^2-D}{k}|$ 尽可能小的 $m$。这可以通过从 $m$ 的同余类中选择使 $|m^2-D|$ 最小化的整数 $m$ 来实现。这意味着我们应该选择一个接近 $\\sqrt{D}$ 的整数 $m$。\n\n**第二部分：应用于 $D=26$**\n\n我们需要求解 $x^2-26y^2=1$。这里，$D=26$。\n首先，我们需要为满足 $a^2-26b^2=k$ 的三元组 $(a, b, k)$ 选择一个自然的初始值。一个好的起点是选择 $b=1$ 并找到一个整数 $a$ 使得 $a^2$ 接近 $D=26$。\n如果我们选择 $a=5$，我们得到 $5^2 - 26(1^2) = 25-26 = -1$。这给出了三元组 $(5, 1, -1)$。虽然这是一个有效的起点，但它立即给出了 $x^2-26y^2=-1$ 的一个解，这会跳过完整的迭代方法的演示过程。\n为了更好地说明这个过程，我们选择另一个自然的起点。我们试试 $a=6$ 和 $b=1$。\n$a^2-26b^2 = 6^2-26(1^2) = 36-26=10$。\n所以我们的初始三元组是 $(a_0, b_0, k_0) = (6, 1, 10)$。我们有 $\\gcd(6,1)=1$，符合要求。\n\n**迭代 1：**\n- 当前三元组：$(a, b, k) = (6, 1, 10)$。\n- $m$ 的选择：\n  $1.$ 我们必须满足同余式 $a+bm \\equiv 0 \\pmod{|k|}$，即 $6+1 \\cdot m \\equiv 0 \\pmod{10}$，或 $m \\equiv -6 \\equiv 4 \\pmod{10}$。\n  $m$ 的可能值形式为 $10n+4$，即 $\\{\\dots, -16, -6, 4, 14, \\dots\\}$。\n  $2.$ 我们必须从此集合中选择 $m$ 以最小化 $|m^2-D| = |m^2-26|$。\n     - 对于 $m=4$，$|4^2-26| = |16-26| = 10$。\n     - 对于 $m=-6$，$|(-6)^2-26| = |36-26| = 10$。\n     - 对于 $m=14$，$|14^2-26| = |196-26| = 170$。\n     最小的绝对值为 $10$，在 $m=4$ 和 $m=-6$ 时取得。选择 $m=-6$ 会导致 $b'=(a+bm)/k = (6+1(-6))/10 = 0$，这是一个平凡解。我们舍弃这个选择，并选择 $m=4$ 以继续寻找非平凡解。\n- 用 $m=4$ 计算新的三元组 $(a', b', k')$：\n  $a' = \\frac{am+Db}{k} = \\frac{6(4)+26(1)}{10} = \\frac{24+26}{10} = \\frac{50}{10} = 5$。\n  $b' = \\frac{a+bm}{k} = \\frac{6+1(4)}{10} = \\frac{10}{10} = 1$。\n  $k' = \\frac{m^2-D}{k} = \\frac{4^2-26}{10} = \\frac{16-26}{10} = \\frac{-10}{10} = -1$。\n- 新的三元组是 $(a_1, b_1, k_1) = (5, 1, -1)$。\n\n**终止与最终解：**\n迭代产生了一个 $k_1 = -1$ 的三元组。算法终止，因为我们已经找到了 $x^2-26y^2=-1$ 的一个解，即 $(x,y)=(5,1)$。\n问题要求解 $x^2-26y^2=1$。我们可以通过使用婆罗摩笈多恒等式将 $k=-1$ 的解 $(5,1)$ 与自身复合来得到这个解（这个过程在数域 $\\mathbb{Q}(\\sqrt{26})$ 中称为“平方”）。\n令 $(a,b) = (5,1)$ 使得 $a^2-Db^2=-1$。那么：\n$(-1)^2 = (a^2-Db^2)^2 = (a^2+Db^2)^2-D(2ab)^2 = 1$。\n方程 $X^2-DY^2=1$ 的新解 $(X,Y)$ 由以下公式给出：\n$X = a^2+Db^2 = 5^2+26(1^2) = 25+26 = 51$。\n$Y = 2ab = 2(5)(1) = 10$。\n因此，数对 $(51, 10)$ 是 $x^2-26y^2=1$ 的一个解。\n检验：$51^2-26(10^2) = 2601 - 26(100) = 2601-2600=1$。\n这个解是最小正整数解（或称基本解），因为它是从 $x^2-26y^2=-1$ 的基本解推导出来的。\n\n问题要求的是最小正整数 $x$，即 $51$。", "answer": "$$\\boxed{51}$$", "id": "3085416"}]}