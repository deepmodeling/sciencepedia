{"hands_on_practices": [{"introduction": "在学习了如何生成三元组之后，我们现在来解决逆问题：给定一个本原毕达哥拉斯三元组，如何找到其唯一的生成参数？本练习将引导你仅用奇偶性和整除性论证，从第一性原理推导出其结构关系。掌握这种“逆向工程”过程可以加深你对欧几里得公式为何有效以及是什么决定了一个三元组是本原的理解 [@problem_id:3088887]。", "problem": "设 $a$、$b$ 和 $c$ 为正整数，满足 $a^{2}+b^{2}=c^{2}$。一个毕达哥拉斯三元组 $(a,b,c)$ 如果满足 $\\gcd(a,b,c)=1$，则称为本原的。仅使用恒等式 $a^{2}+b^{2}=c^{2}$、最大公约数的性质以及奇偶性分析，推导刻画本原毕达哥拉斯三元组的结构关系。然后，对于本原三元组 $(20,21,29)$，首先将其排列使得奇数直角边为 $a$，偶数直角边为 $b$，并利用推导出的结构来确定通过经典欧几里得参数化生成该三元组的一对正整数 $(m,n)$（其中 $m>n$）。计算 $m$ 和 $n$ 的精确值，并以有序数对 $(m,n)$ 的形式给出你的最终答案。无需四舍五入。", "solution": "该问题是有效的，因为它在数论中有科学依据，问题表述清晰，客观且内部一致。我们将首先推导本原毕达哥拉斯三元组的结构关系，然后将其应用于给定的具体案例。\n\n一个毕达哥拉斯三元组由三个正整数 $(a,b,c)$ 组成，满足 $a^{2}+b^{2}=c^{2}$。如果 $\\gcd(a,b,c)=1$，则该三元组称为本原的。\n\n首先，我们确定本原毕达哥拉斯三元组 $(a,b,c)$ 的一些性质。如果一个素数 $p$ 同时整除 $a$ 和 $b$，即 $a \\equiv 0 \\pmod{p}$ 且 $b \\equiv 0 \\pmod{p}$，那么 $a^{2} \\equiv 0 \\pmod{p^2}$ 且 $b^{2} \\equiv 0 \\pmod{p^2}$。这将意味着 $c^2 = a^2+b^2 \\equiv 0 \\pmod{p^2}$，也就是说 $c \\equiv 0 \\pmod{p}$。如果 $p$ 同时整除 $a$、$b$ 和 $c$，这就与条件 $\\gcd(a,b,c)=1$ 相矛盾。因此，$a$ 和 $b$ 必须互质，即 $\\gcd(a,b)=1$。类似的论证可以表明 $\\gcd(a,c)=1$ 且 $\\gcd(b,c)=1$。因此，本原毕达哥拉斯三元组中的整数是两两互质的。\n\n接下来，我们分析 $a$、$b$ 和 $c$ 的奇偶性。\n1. $a$ 和 $b$ 能都是偶数吗？如果 $a$ 和 $b$ 都是偶数，那么 $\\gcd(a,b) \\ge 2$，这与我们刚刚证明的两两互质的性质相矛盾。\n2. $a$ 和 $b$ 能都是奇数吗？如果 $a$ 是奇数，$a = 2k+1$（对于某个整数 $k$），那么 $a^2 = (2k+1)^2 = 4k^2+4k+1 \\equiv 1 \\pmod{4}$。类似地，如果 $b$ 是奇数，则 $b^2 \\equiv 1 \\pmod{4}$。那么 $c^2 = a^2+b^2 \\equiv 1+1 \\equiv 2 \\pmod{4}$。然而，任何整数的平方模4 要么是0（如果该整数是偶数），要么是1（如果该整数是奇数）。不存在一个整数，其平方与2模4同余。因此，$a$ 和 $b$ 不能都是奇数。\n由这两点，我们得出结论：$a$ 和 $b$ 中必须一个为偶数，另一个为奇数。\n如果一条直角边是奇数，另一条是偶数，那么 $c^2 = (\\text{奇数})^2 + (\\text{偶数})^2 = \\text{奇数} + \\text{偶数} = \\text{奇数}$。这意味着 $c$ 必须是奇数。\n所以，对于任何本原毕达哥拉斯三元组，一条直角边是奇数，一条直角边是偶数，斜边是奇数。\n\n不失一般性，设 $a$ 为奇数直角边，$b$ 为偶数直角边。方程 $a^2+b^2=c^2$ 可以重排为：\n$$b^2 = c^2 - a^2 = (c-a)(c+a)$$\n因为 $a$ 和 $c$ 都是奇数，它们的差 $c-a$ 和它们的和 $c+a$ 都是偶数。我们可以写成 $c-a=2u$ 和 $c+a=2v$，其中 $u$ 和 $v$ 是正整数。\n将它们代入关于 $b^2$ 的方程中：\n$$b^2 = (2u)(2v) = 4uv$$\n因为 $b$ 是偶数，我们可以写成 $b=2k$，所以 $b^2=4k^2$。这得到 $4k^2 = 4uv$，即 $k^2 = uv$。这等价于：\n$$(\\frac{b}{2})^2 = uv$$\n现在我们来研究 $u$ 和 $v$。我们有 $u = \\frac{c-a}{2}$ 和 $v = \\frac{c+a}{2}$。它们的和是 $u+v = \\frac{c-a}{2} + \\frac{c+a}{2} = \\frac{2c}{2} = c$。它们的差是 $v-u = \\frac{c+a}{2} - \\frac{c-a}{2} = \\frac{2a}{2} = a$。\n我们来求 $u$ 和 $v$ 的最大公约数。$u$ 和 $v$ 的任何公约数也必须整除它们的和 $u+v=c$ 和它们的差 $v-u=a$。所以，$\\gcd(u,v)$ 必须整除 $\\gcd(a,c)$。由于该三元组是本原的，我们已经确定 $\\gcd(a,c)=1$。因此，$\\gcd(u,v)=1$。\n我们有两个互质的整数 $u$ 和 $v$，它们的乘积 $uv$ 是一个完全平方数。要使之成立，$u$ 和 $v$ 本身都必须是完全平方数。\n设 $u = n^2$ 和 $v = m^2$，其中 $m$ 和 $n$ 是正整数。\n因为 $c$ 和 $a$ 是正数，所以 $v>u>0$，这意味着 $m^2 > n^2 > 0$，所以 $m > n > 0$。\n现在我们可以用 $m$ 和 $n$ 来表示 $a$、$b$ 和 $c$：\n$a = v-u = m^2 - n^2$\n$c = v+u = m^2 + n^2$\n从 $(\\frac{b}{2})^2 = uv = m^2 n^2$，我们得到 $\\frac{b}{2}=mn$，即 $b=2mn$。\n\n生成的三元组 $(a,b,c)$ 是本原的条件可以从 $m$ 和 $n$ 的性质中导出。\n1. $m > n > 0$ 是正整数。\n2. $\\gcd(u,v) = \\gcd(n^2,m^2) = 1$，这意味着 $\\gcd(m,n)=1$。\n3. $a = m^2-n^2$ 必须是奇数。这发生在 $m^2, n^2$ 一奇一偶的情况下。这又要求 $m, n$ 一奇一偶。它们必须具有相反的奇偶性。\n\n所以，结构关系是 $a=m^2-n^2$，$b=2mn$，$c=m^2+n^2$，其中 $m,n$ 是互质、奇偶性相反且满足 $m>n>0$ 的整数。\n\n现在，我们将此应用于本原三元组 $(20,21,29)$。我们必须将其排列成 $a$ 是奇数直角边，$b$ 是偶数直角边。\n$a = 21$\n$b = 20$\n$c = 29$\n我们使用推导出的结构来找到生成对 $(m,n)$：\n$$a = m^2 - n^2 = 21$$\n$$b = 2mn = 20$$\n$$c = m^2 + n^2 = 29$$\n我们得到了一个关于 $m$ 和 $n$ 的方程组。我们可以使用关于 $a$ 和 $c$ 的方程来求解它：\n$$m^2 + n^2 = 29$$\n$$m^2 - n^2 = 21$$\n将这两个方程相加得到：\n$$(m^2 + n^2) + (m^2 - n^2) = 29 + 21$$\n$$2m^2 = 50$$\n$$m^2 = 25$$\n因为 $m$ 必须是正整数，所以 $m=5$。\n将 $m^2=25$ 代入第一个方程：\n$$25 + n^2 = 29$$\n$$n^2 = 4$$\n因为 $n$ 必须是正整数，所以 $n=2$。\n这对整数是 $(m,n) = (5,2)$。我们来检查条件：$m>n>0$（$5>2>0$，成立），$\\gcd(m,n)=1$（$\\gcd(5,2)=1$，成立），以及 $m,n$ 奇偶性相反（5是奇数，2是偶数，成立）。这对数满足所有条件。\n我们也可以用关于 $b$ 的方程来验证：$b=2mn = 2(5)(2)=20$，这是正确的。\n这对正整数 $(m,n)$ 是 $(5,2)$。", "answer": "$$\\boxed{\\begin{pmatrix} 5  2 \\end{pmatrix}}$$", "id": "3088887"}, {"introduction": "最后一个练习将从单个计算转向系统性枚举，将数学理论转化为计算算法。你将设计一个程序，应用已学到的生成参数条件，生成所有给定大小范围内的本原毕达哥拉斯三元组。这个任务弥合了抽象数论与实际计算之间的鸿沟，是现代数学中的一项关键技能 [@problem_id:3088891]。", "problem": "你的任务是设计并实现一个程序，该程序从基本定义出发，在算法上使用参数化之前先推导出它，以枚举出所有小于等于预定斜边上限的本原勾股数。勾股数是满足 $a^2+b^2=c^2$ 的正整数三元组 $(a,b,c)$。如果 $a$、$b$ 和 $c$ 的最大公约数 (GCD) 为 $1$，即 $\\gcd(a,b,c)=1$，则称三元组 $(a,b,c)$ 为本原的。你的出发点是丢番图方程 $a^2+b^2=c^2$、本原三元组的定义，以及对于任何本原三元组，$\\gcd(a,b)=1$ 且 $a$ 或 $b$ 中恰好有一个是偶数这一事实。\n\n以此为基础，推导出所有本原勾股数的完整参数化形式，以及确保本原性的整数参数的充要条件，包括互质和奇偶性约束。然后，实现一个算法，使用此参数化形式生成所有满足 $c\\le C$ 的本原三元组 $(a,b,c)$，其中 $C$ 为给定的上限，并确保：\n- 用于参数化的整数参数满足 $\\gcd(m,n)=1$ 和 $m\\not\\equiv n\\pmod{2}$，\n- 生成的三元组的唯一性，\n- 两条直角边的排序使得 $a\\le b$，\n- 每个测试用例的输出列表按 $c$ 递增排序，然后按 $a$ 递增排序，再按 $b$ 排序。\n\n你的程序必须处理以下斜边上限 $C$ 的测试套件：\n- $C=1$ (无解的边界情况)，\n- $C=5$ (第一个非平凡情况)，\n- $C=25$ (中等范围情况)，\n- $C=50$ (缩略图指令中指定)。\n\n对于每个测试用例的上限 $C$，你的程序应生成所有满足 $c\\le C$ 的本原三元组 $(a,b,c)$ 的完整列表，格式化为整数列表的列表 $[a,b,c]$。将所有测试用例的结果汇总到单行输出中，该输出包含一个用方括号括起来的逗号分隔列表，且不含空格。具体来说，最终输出必须是 $[[\\text{C=1 的三元组}],[\\text{C=5 的三元组}],[\\text{C=25 的三元组}],[\\text{C=50 的三元组}]]$ 的形式，其中每个内部列表本身都是 $[a,b,c]$ 三元组的逗号分隔列表。\n\n此问题不涉及物理单位或角度单位，也不需要百分比。输出仅为整数列表。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果 (例如 $[result_1,result_2,result_3,result_4]$)，其中每个 $result_i$ 是测试套件中对应 $C$ 的本原三元组列表。", "solution": "用户希望找到斜边最大为 $C$ 的所有本原勾股数 $(a,b,c)$。这是数论中的一个经典问题。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **方程**：勾股数是满足 $a^2+b^2=c^2$ 的正整数三元组 $(a,b,c)$。\n- **定义**：如果 $\\gcd(a,b,c)=1$，则三元组 $(a,b,c)$ 是本原的。\n- **已知事实**：对于一个本原三元组，$\\gcd(a,b)=1$ 且 $a$ 或 $b$ 中恰好有一个是偶数。\n- **任务**：推导本原勾股数的参数化形式，并用它来实现一个算法。\n- **算法约束**：\n    1. 生成所有满足 $c \\le C$ 的本原三元组 $(a,b,c)$。\n    2. 使用满足 $\\gcd(m,n)=1$ 和 $m\\not\\equiv n\\pmod{2}$ 的整数参数 $m, n$。\n    3. 确保生成的三元组的唯一性。\n    4. 对两直角边排序，使得 $a \\le b$。\n    5. 对每个 $C$ 的最终三元组列表按 $c$ 递增排序，然后按 $a$ 递增排序，再按 $b$ 排序。\n- **测试套件**：$C \\in \\{1, 5, 25, 50\\}$。\n- **输出格式**：单行 `[[C=1 的三元组],[C=5 的三元组],[C=25 的三元组],[C=50 的三元组]]`，列表结构内无空格。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在数学上是良定义的、内部一致的且自洽的。它要求推导和应用数论中的一个标准结果（用于生成勾股数的欧几里得公式）。\n\n- **科学依据**：是的。该问题植根于初等数论和丢番图方程。其概念是基于事实且逻辑严谨的。\n- **良构性**：是的。对于任何有限的上限 $C$，都存在一个满足条件的、有限且唯一的本原勾股数集合。排序标准确保了唯一的最终顺序。\n- **客观性**：是的。语言精确，要求明确。\n\n问题是有效的。\n\n**步骤 3：结论与行动**\n问题是有效的。我将继续提供解决方案。\n\n### 参数化形式的推导\n\n我们要寻找丢番图方程 $a^2 + b^2 = c^2$ 的本原解，其中 $a, b, c$ 是正整数。\n\n1. **奇偶性分析**：\n    对于一个本原三元组 $(a,b,c)$，有 $\\gcd(a,b,c)=1$。\n    - 如果 $a$ 和 $b$ 都是偶数，那么 $c^2 = a^2+b^2$ 也将是偶数，从而 $c$ 也是偶数。这将意味着 $\\gcd(a,b,c) \\ge 2$，与本原性矛盾。\n    - 如果 $a$ 和 $b$ 都是奇数，它们的平方也是奇数。$a^2 \\equiv 1 \\pmod{4}$ 且 $b^2 \\equiv 1 \\pmod{4}$。那么 $c^2 = a^2+b^2 \\equiv 1+1 \\equiv 2 \\pmod{4}$。然而，没有整数的平方会同余于 $2 \\pmod{4}$（平方数模4只能是 $0$ 或 $1$）。这是一个矛盾。\n    - 因此，$a$ 和 $b$ 中必须一个为偶数，另一个为奇数。这意味着 $c^2$ 是奇数，所以 $c$ 也必须是奇数。\n\n2. **代数推导**：\n    不失一般性，设 $a$ 为偶数直角边，$b$ 为奇数直角边。方程可以重排为：\n    $$a^2 = c^2 - b^2 = (c-b)(c+b)$$\n    由于 $b$ 和 $c$ 都是奇数，它们的差 $(c-b)$ 和它们的和 $(c+b)$ 都是偶数。我们可以写成 $a=2k$，$c-b=2u$ 和 $c+b=2v$，其中 $k, u, v$ 是某个整数。将这些代入方程：\n    $$(2k)^2 = (2u)(2v) \\implies 4k^2 = 4uv \\implies k^2 = uv$$\n    现在，我们来考察 $u$ 和 $v$ 的最大公约数。\n    $$\\gcd(u,v) = \\gcd\\left(\\frac{c-b}{2}, \\frac{c+b}{2}\\right)$$\n    $u$ 和 $v$ 的任何公约数也必须能整除它们的和 $u+v = \\frac{c-b}{2} + \\frac{c+b}{2} = c$ 以及它们的差 $v-u = \\frac{c+b}{2} - \\frac{c-b}{2} = b$。因此，$\\gcd(u,v)$ 整除 $\\gcd(b,c)$。对于本原三元组，一个已知的性质是其分量两两互质，所以 $\\gcd(b,c)=1$。因此，$\\gcd(u,v)=1$。\n\n    我们有两个互质的整数 $u$ 和 $v$，它们的乘积 $uv=k^2$ 是一个完全平方数。这意味着 $u$ 和 $v$ 本身必须是完全平方数。我们设：\n    $$u = n^2 \\quad \\text{和} \\quad v = m^2$$\n    其中 $m, n$ 是某个正整数。\n    由于 $\\gcd(u,v)=1$，可得 $\\gcd(m^2, n^2)=1$，这意味着 $\\gcd(m,n)=1$。\n\n    现在我们可以用 $m$ 和 $n$ 来解出 $a, b, c$。\n    - $c+b = 2v = 2m^2$\n    - $c-b = 2u = 2n^2$\n    将这两个方程相加得到 $2c = 2m^2 + 2n^2$，化简为：\n    $$c = m^2 + n^2$$\n    用第一个方程减去第二个方程得到 $2b = 2m^2 - 2n^2$，化简为：\n    $$b = m^2 - n^2$$\n    最后，从 $k^2 = uv = m^2n^2$ 我们得到 $k=mn$。由于 $a=2k$，我们有：\n    $$a = 2mn$$\n\n3. **参数 $m$ 和 $n$ 的条件**：\n    这就得到了被称为欧几里得公式的参数化形式：$(a,b,c) = (2mn, m^2-n^2, m^2+n^2)$。为了使该公式能生成所有*本原*勾股数，我们必须确立对整数参数 $m$ 和 $n$ 的条件。\n    - 为确保 $a, b, c$ 是正整数，我们必须有 $m^2-n^2 > 0 \\implies m>n$，以及 $2mn > 0$。我们可以假设 $m, n$ 是正数，所以条件变为 $m > n > 0$。\n    - 我们已经证明了 $\\gcd(m,n)=1$ 是 $\\gcd(u,v)=1$ 的必要条件。\n    - 关于奇偶性，我们假设了 $b$ 是奇数。$b=m^2-n^2$ 是奇数当且仅当 $m^2, n^2$ 中一个为偶数另一个为奇数。这当且仅当 $m, n$ 中一个为偶数另一个为奇数时成立。这个条件可以正式表述为 $m \\not\\equiv n \\pmod{2}$。如果此条件成立，$a=2mn$ 是偶数，$b=m^2-n^2$ 是奇数，而 $c=m^2+n^2$ 是奇数，这与我们最初的奇偶性分析一致。\n\n    总结来说，每个本原勾股数 $(a,b,c)$ 都可以通过以下公式生成：\n    $$a' = 2mn, \\quad b' = m^2 - n^2, \\quad c = m^2 + n^2$$\n    其中 $m, n$ 是满足以下条件的整数：\n    1.  $m > n > 0$\n    2.  $\\gcd(m, n) = 1$\n    3.  $m \\not\\equiv n \\pmod{2}$ (一个偶数，一个奇数)\n    然后将直角边 $a,b$ 设置为 $a = \\min(a', b')$ 和 $b = \\max(a', b')$。\n\n### 算法设计\n寻找所有满足 $c \\le C$ 的本原三元组的算法如下：\n1. 遍历所有可能产生有效斜边 $c \\le C$ 的整数 $m$ 和 $n$。\n2. 斜边是 $c = m^2 + n^2$。条件 $c \\le C$ 意味着 $m^2 + n^2 \\le C$。\n3. 由于 $m>n>0$，我们有 $m^2  m^2+n^2 \\le C$，所以 $m \\le \\sqrt{C}$。$m$ 的外层循环可以从 $2$ 运行到 $\\lfloor\\sqrt{C}\\rfloor$。\n4. 对于每个 $m$，$n$ 的内层循环从 $1$ 运行到 $m-1$。\n5. 在循环内部，我们应用本原性筛选条件：\n    a. 检查是否 $\\gcd(m,n)=1$。\n    b. 检查 $m$ 和 $n$ 是否具有相反的奇偶性，即 $(m-n)\\%2 == 1$。\n6. 如果两个条件都满足，计算三元组：\n    - $c = m^2 + n^2$。我们必须进行最后一次检查 $c \\le C$。这是因为循环的边界仅基于 $m$；对于较大的 $n$，$c$ 可能会超过 $C$。\n    - $a_{temp} = 2mn$\n    - $b_{temp} = m^2 - n^2$\n    - $a = \\min(a_{temp}, b_{temp})$\n    - $b = \\max(a_{temp}, b_{temp})$\n    - 存储三元组 $[a, b, c]$。\n7. 在遍历所有有效的 $(m,n)$ 对之后，收集所有生成的三元组。\n8. 根据键 $(c, a, b)$ 按升序对三元组列表进行排序。\n对于测试套件中的每个 $C$ 值，都将执行此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef generate_primitive_triples(C: int) - list[list[int]]:\n    \"\"\"\n    Generates all primitive Pythagorean triples (a, b, c) with c = C.\n\n    The generation is based on Euclid's formula:\n    a = m^2 - n^2\n    b = 2mn\n    c = m^2 + n^2\n    where m  n  0, gcd(m, n) = 1, and m, n have opposite parity.\n\n    Args:\n        C: The maximum value for the hypotenuse c.\n\n    Returns:\n        A list of primitive Pythagorean triples, sorted by c, then a.\n    \"\"\"\n    triples = []\n    # Loop for m: m^2  c = C, so m = sqrt(C).\n    # m must be at least 2 since n must be at least 1 and m  n.\n    m_limit = int(np.sqrt(C))\n    for m in range(2, m_limit + 1):\n        # Loop for n: n  m.\n        for n in range(1, m):\n            # Condition 1: gcd(m, n) = 1\n            if np.gcd(m, n) == 1:\n                # Condition 2: m and n have opposite parity (m - n is odd)\n                if (m - n) % 2 == 1:\n                    # Calculate the triple\n                    c = m*m + n*n\n                    if c  C:\n                        # Since n increases, c will only get larger for this m.\n                        # We can break the inner loop.\n                        break\n                    \n                    # Using the two forms from the parametrization\n                    a_temp = 2 * m * n\n                    b_temp = m * m - n * n\n                    \n                    # Order the legs a = b\n                    a = min(a_temp, b_temp)\n                    b = max(a_temp, b_temp)\n                    \n                    triples.append([a, b, c])\n\n    # Sort the triples: by increasing c, then by increasing a.\n    # The third element (b) is implicitly sorted as a tie-breaker.\n    triples.sort(key=lambda x: (x[2], x[0], x[1]))\n    \n    return triples\n\ndef solve():\n    \"\"\"\n    Main function to process the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [1, 5, 25, 50]\n\n    all_results = []\n    for C in test_cases:\n        # Generate triples for the current hypotenuse bound\n        result = generate_primitive_triples(C)\n        all_results.append(result)\n\n    # Format the results into a single string as specified.\n    # str() on a list adds spaces, so we remove them.\n    # E.g., str([[3, 4, 5]]) becomes '[[3, 4, 5]]'.\n    # .replace(' ', '') converts it to '[[3,4,5]]'.\n    stringified_results = [str(res).replace(\" \", \"\") for res in all_results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(stringified_results)}]\")\n\nsolve()\n```", "id": "3088891"}]}