{"hands_on_practices": [{"introduction": "掌握乘法阶的强大功能最直接的方法就是将其付诸实践。这个练习 ([@problem_id:3087787]) 将指导你首先计算一个元素的阶，然后运用它来极大地简化一个大指数模幂运算。通过这个过程，你将体会到基于阶的方法相比于更直接的计算方法在效率上的显著优势。", "problem": "设 $n=17$ 且 $a=3$。定义乘法阶 $\\operatorname{ord}_{n}(a)$ 为满足 $\\gcd(a,n)=1$ 和 $a^{t}\\equiv 1 \\pmod{n}$ 的最小正整数 $t$。在整数模 $n$ 环以及模 $n$ 的单位群中进行运算。仅使用以下基础事实：对于素数 $p$，非零剩余类模 $p$ 在乘法下构成一个阶为 $p-1$ 的有限群，以及在任何有限群中，元素的阶整除群的阶。请按如下步骤进行：\n\n- 通过检验 $\\varphi(17)$ 的适当因子来确定 $\\operatorname{ord}_{17}(3)$，其中 $\\varphi$ 表示欧拉函数。\n- 使用 $\\operatorname{ord}_{17}(3)$ 的值来化简指数并计算余数 $3^{2023}\\bmod 17$。\n- 通过计算每种方法中的模乘法次数，简要对比这种基于阶的降幂方法与直接的二进制幂算法（即从左到右重复平方，不事先降幂）的差异。在你的比较中，将一次模平方计为一次模乘法，假设在有利的情况下可重用任何已计算的中间次幂，并考虑指数的二进制展开。\n\n仅报告集合 $\\{0,1,\\dots,16\\}$ 中的最终剩余类代表作为你的数值答案。无需四舍五入，不涉及单位。", "solution": "该问题要求完成三个关于模数为 $n=17$、底为 $a=3$ 的模运算的不同但相关的任务。我们将按顺序逐一解决。\n\n首先，我们确定 $3$ 模 $17$ 的乘法阶，记为 $\\operatorname{ord}_{17}(3)$。问题说明我们要在模 $n$ 的单位群中进行运算。对于 $n=17$ 这个素数，单位群 $(\\mathbb{Z}/17\\mathbb{Z})^\\times$ 由非零剩余类 $\\{1, 2, \\dots, 16\\}$ 在乘法下构成。该群的阶由欧拉函数给出，即 $|\\left(\\mathbb{Z}/17\\mathbb{Z}\\right)^\\times|=\\varphi(17)$。由于 $17$ 是素数，$\\varphi(17) = 17 - 1 = 16$。\n$\\operatorname{ord}_{n}(a)$ 的定义要求 $\\gcd(a,n)=1$。对于 $a=3$ 和 $n=17$，我们有 $\\gcd(3,17)=1$，符合要求。\n群论的一个基本原理（拉格朗日定理）指出，元素的阶必须整除群的阶。因此，$\\operatorname{ord}_{17}(3)$ 必须是 $16$ 的一个因子。$16$ 的正因子是 $1, 2, 4, 8, 16$。为了找到这个阶，也就是最小的那个正整数，我们按从小到大的顺序测试这些因子。\n所有同余式均以 $17$ 为模。\n\\begin{itemize}\n    \\item 对于指数 $t=1$：$3^1 \\equiv 3 \\not\\equiv 1 \\pmod{17}$。\n    \\item 对于指数 $t=2$：$3^2 = 9 \\equiv 9 \\not\\equiv 1 \\pmod{17}$。\n    \\item 对于指数 $t=4$：$3^4 = (3^2)^2 \\equiv 9^2 = 81$。由于 $81 = 4 \\times 17 + 13$，我们有 $3^4 \\equiv 13 \\not\\equiv 1 \\pmod{17}$。\n    \\item 对于指数 $t=8$：$3^8 = (3^4)^2 \\equiv 13^2 = 169$。由于 $169 = 9 \\times 17 + 16$，我们有 $3^8 \\equiv 16 \\equiv -1 \\pmod{17}$。这不等于 $1$。\n\\end{itemize}\n由于阶不是 $1, 2, 4, 8$，它必定是 $16$。我们可以验证这一点：$3^{16} = (3^8)^2 \\equiv (-1)^2 \\equiv 1 \\pmod{17}$。这也是费马小定理的直接推论。\n因此，$3$ 模 $17$ 的乘法阶是 $\\operatorname{ord}_{17}(3) = 16$。\n\n第二，我们使用这个阶来计算 $3^{2023}$ 模 $17$ 的余数。阶的性质允许我们将指数对阶取模。具体来说，如果 $t = \\operatorname{ord}_{n}(a)$，那么 $a^k \\equiv a^{k \\pmod t} \\pmod n$。\n我们需要求 $2023$ 除以阶 $16$ 的余数。\n$$2023 = 16 \\times 126 + 7$$\n这意味着 $2023 \\equiv 7 \\pmod{16}$。\n因此，我们可以简化原计算：\n$$3^{2023} \\equiv 3^{16 \\times 126 + 7} \\equiv (3^{16})^{126} \\cdot 3^7 \\pmod{17}$$\n由于 $3^{16} \\equiv 1 \\pmod{17}$，上式简化为：\n$$1^{126} \\cdot 3^7 \\equiv 3^7 \\pmod{17}$$\n现在我们计算 $3^7 \\pmod{17}$。我们可以使用之前计算的中间次幂：$3^1 \\equiv 3$，$3^2 \\equiv 9$ 和 $3^4 \\equiv 13$。\n$$3^7 = 3^{4+2+1} = 3^4 \\cdot 3^2 \\cdot 3^1$$\n$$3^7 \\equiv 13 \\cdot 9 \\cdot 3 \\pmod{17}$$\n首先，我们计算 $13 \\cdot 9 = 117$。除以 $17$，$117 = 6 \\times 17 + 15$，所以 $117 \\equiv 15 \\pmod{17}$。\n接下来，我们计算 $15 \\cdot 3 = 45$。除以 $17$，$45 = 2 \\times 17 + 11$，所以 $45 \\equiv 11 \\pmod{17}$。\n因此，$3^{2023} \\equiv 11 \\pmod{17}$。所求的剩余类代表是 $11$。\n\n第三，我们对比两种方法的模乘法次数。一次模平方计为一次模乘法。\n\n方法1：基于阶的降幂法。\n\\begin{enumerate}\n    \\item 求阶 $\\operatorname{ord}_{17}(3)$。这涉及计算 $3^2$, $3^4$ 和 $3^8$。\n    \\begin{itemize}\n        \\item $3^2 = 3 \\cdot 3$：1 次乘法（一次平方）。\n        \\item $3^4 = (3^2)^2$：1 次平方。\n        \\item $3^8 = (3^4)^2$：1 次平方。\n    \\end{itemize}\n    此步骤共需要 3 次模乘法。\n    \\item 计算 $3^7 \\pmod{17}$。我们重用已计算的 $3^1, 3^2, 3^4$。\n    $3^7 = 3^4 \\cdot 3^2 \\cdot 3^1$。\n    \\begin{itemize}\n        \\item 令 $P = 3^4 \\cdot 3^2$：1 次乘法。\n        \\item 结果 $= P \\cdot 3^1$：1 次乘法。\n    \\end{itemize}\n    此步骤需要额外 2 次模乘法。\n\\end{enumerate}\n基于阶的方法总共需要 $3 + 2 = 5$ 次模乘法。\n\n方法2：直接二进制幂算法（从左到右重复平方）。\n我们直接计算 $3^{2023} \\pmod{17}$。\n指数是 $2023$。其二进制表示为：\n$2023 = 1024 + 512 + 256 + 128 + 64 + 32 + 4 + 2 + 1 = 2^{10} + 2^9 + 2^8 + 2^7 + 2^6 + 2^5 + 2^2 + 2^1 + 2^0$。\n所以，$2023_{10} = 11111100111_2$。\n二进制表示有 $11$ 位（从第 $0$ 位到第 $10$ 位）。该算法所需的平方次数是最高位的位置，即 $10$ 次。\n乘法次数是二进制字符串中为 1 的位数（汉明权重），减去最高位的那一位。1 的个数（汉明权重）是 $9$。所以，乘法次数是 $9-1=8$ 次。\n总运算次数是平方和乘法次数的总和。\n总模乘法次数 = $10$ 次（平方） $+ 8$ 次（乘法） $= 18$ 次。\n对于此特定问题，比较显示，基于阶的方法（5 次乘法）比直接二进制幂算法（18 次乘法）效率显著更高。\n\n所要求的最终数值答案是 $3^{2023} \\bmod 17$ 的余数，即 $11$。", "answer": "$$\n\\boxed{11}\n$$", "id": "3087787"}, {"introduction": "在理解了阶的基本定义后，下一步是探索阶的性质。这个练习 ([@problem_id:3087796]) 聚焦于一个基本关系：一个元素的阶 $\\operatorname{ord}_n(a)$ 如何与其幂 $a^k$ 的阶相关联。正如问题所要求的，从第一性原理推导这个关系，将帮助你建立超越公式记忆的更深刻的理论理解。", "problem": "设 $a$ 为乘法群 $\\left(\\mathbb{Z}/37\\mathbb{Z}\\right)^{\\times}$ 中的一个元素，其阶为 $\\operatorname{ord}_{37}(a)=36$，其中 $\\operatorname{ord}_{37}(a)$ 表示 $a$ 模 $37$ 的乘法阶，定义为满足 $a^{t}\\equiv 1 \\pmod{37}$ 的最小正整数 $t$。求 $\\operatorname{ord}_{37}(a^{9})$。你的证明必须从乘法阶的定义出发，并且只使用基本的整除性质，包括：若 $a^{n}\\equiv 1 \\pmod{37}$，则 $\\operatorname{ord}_{37}(a)$ 整除 $n$。在你的推理过程中，必须从第一性原理出发，清晰地推导你所使用的 $\\operatorname{ord}_{37}(a)$ 和 $\\operatorname{ord}_{37}(a^{k})$ 之间的一般关系，并明确指出最大公约数（GCD）所起的作用。最终答案以单个整数形式给出。", "solution": "设 $o = \\operatorname{ord}_{37}(a)$ 且 $m = \\operatorname{ord}_{37}(a^{9})$。已知 $o=36$。我们的任务是求出 $m$ 的值。\n\n根据明确的指示，我们首先从第一性原理出发，推导元素 $a$ 的阶与该元素幂 $a^k$ 的阶之间的一般关系。设模为一个一般的整数 $N1$，尽管在我们的例子中 $N=37$。设 $o = \\operatorname{ord}_{N}(a)$ 且对于某个整数 $k$，设 $m' = \\operatorname{ord}_{N}(a^k)$。\n\n根据阶的定义，$m'$ 是使得 $(a^k)^{m'} \\equiv 1 \\pmod{N}$ 成立的最小正整数。这等价于同余式 $a^{km'} \\equiv 1 \\pmod{N}$。\n\n我们要使用这个性质：如果 $a^n \\equiv 1 \\pmod{N}$，那么 $\\operatorname{ord}_{N}(a)$ 必定整除 $n$。将此性质应用于同余式 $a^{km'} \\equiv 1 \\pmod{N}$，我们推断 $o$ 必定整除指数 $km'$。\n所以，我们得到条件 $o | km'$。\n\n设 $d$ 为 $k$ 和 $o$ 的最大公约数，记为 $d = \\gcd(k,o)$。根据 GCD 的定义，我们可以写成 $k = k'd$ 和 $o = o'd$，其中 $k'$ 和 $o'$ 是某个整数，使得 $\\gcd(k', o') = 1$。GCD 的作用是分解出 $k$ 和 $o$ 的公共部分，剩下两个互素的整数 $k'$ 和 $o'$。\n\n将这些表达式代入我们的整除条件 $o | km'$，我们得到：\n$o'd | (k'd)m'$\n\n因为 $d = \\gcd(k,o)$ 是一个正整数，我们可以在整除关系的两边同时除以 $d$：\n$o' | k'm'$\n\n根据欧几里得引理，因为 $\\gcd(k', o') = 1$，必然有 $o'$ 整除 $m'$。这意味着 $m'$ 必须是 $o'$ 的倍数。由于 $m'$ 被定义为满足其同余式的*最小正*整数，它必须是 $o'$ 的最小正倍数。让我们检验 $m' = o'$ 是否为一个有效的解。\n\n我们必须检查是否 $(a^k)^{o'} \\equiv 1 \\pmod{N}$。\n$(a^k)^{o'} = a^{ko'} = a^{(k'd)o'} = a^{k'(do')} = a^{k'o}$\n\n因为 $o = \\operatorname{ord}_{N}(a)$，我们有 $a^o \\equiv 1 \\pmod{N}$。因此：\n$a^{k'o} = (a^o)^{k'} \\equiv 1^{k'} \\equiv 1 \\pmod{N}$\n\n条件对于 $m' = o'$ 是满足的。因为我们已经确定了任何有效的 $m'$ 都必须是 $o'$ 的倍数，所以 $m'$ 的最小正值必须是 $o'$ 本身。\n因此，我们推导出了这个一般关系：\n$m' = o' = \\frac{o}{d} = \\frac{\\operatorname{ord}_{N}(a)}{\\gcd(k, \\operatorname{ord}_{N}(a))}$\n\n现在，我们将这个推导出的公式应用到给定的具体问题中。\n我们有 $a \\in \\left(\\mathbb{Z}/37\\mathbb{Z}\\right)^{\\times}$，所以模数是 $N=37$。\n已知 $\\operatorname{ord}_{37}(a) = 36$。\n我们想求 $\\operatorname{ord}_{37}(a^9)$。在这种情况下，$k=9$。\n\n使用我们的公式：\n$\\operatorname{ord}_{37}(a^9) = \\frac{\\operatorname{ord}_{37}(a)}{\\gcd(9, \\operatorname{ord}_{37}(a))}$\n\n代入给定值 $\\operatorname{ord}_{37}(a)=36$：\n$\\operatorname{ord}_{37}(a^9) = \\frac{36}{\\gcd(9, 36)}$\n\n为了求 $9$ 和 $36$ 的最大公约数，我们注意到 $36 = 4 \\times 9$。因此，$9$ 是 $36$ 的一个因子。所以，最大公约数是 $9$：\n$\\gcd(9, 36) = 9$\n\n将这个值代回到表达式中：\n$\\operatorname{ord}_{37}(a^9) = \\frac{36}{9} = 4$\n\n$a^9$ 模 $37$ 的阶是 $4$。", "answer": "$$\\boxed{4}$$", "id": "3087796"}, {"introduction": "掌握了阶及其性质后，理解基于阶的方法的适用范围和局限性也同样重要。这个练习 ([@problem_id:3087740]) 探讨了为什么像离散对数这样强大的技术，虽然依赖于阶，却并非普遍适用。通过分析，你将把模 $n$ 乘法群 $(\\mathbb{Z}/n\\mathbb{Z})^\\times$ 的抽象结构与解决特定同余方程的实际可行性联系起来。", "problem": "考虑模 $n$ 的乘法单位群，记作 $(\\mathbb{Z}/n\\mathbb{Z})^\\times$。在循环群中，生成元 $g$ 的存在允许我们将同余式 $x^k \\equiv a \\pmod{n}$ 通过写作 $x = g^u$ 和 $a = g^v$ 的形式，转换成一个关于指数的线性同余式。相反，当 $(\\mathbb{Z}/n\\mathbb{Z})^\\times$ 不是循环群时，单一生成元的缺失会使基于阶的方法变得复杂。选择所有正确指出了一个合数模 $n$（其对应的 $(\\mathbb{Z}/n\\mathbb{Z})^\\times$ 不是循环群）并准确解释了这种情况如何阻碍直接使用离散对数来求解 $x^k \\equiv a \\pmod{n}$ 的选项。\n\nA. $n = 15$。因为 $(\\mathbb{Z}/15\\mathbb{Z})^\\times \\cong (\\mathbb{Z}/3\\mathbb{Z})^\\times \\times (\\mathbb{Z}/5\\mathbb{Z})^\\times \\cong C_2 \\times C_4$，所以该群不是循环群。由于没有单一的生成元 $g$，我们无法将每个 $x$ 和 $a$ 都统一地表示为 $g$ 的幂，因此方程 $x^k \\equiv a \\pmod{15}$ 不能被化简为单个关于指数的线性同余式；相反，必须在不同的循环分量中求解联立的同余方程组。\n\nB. $n = 14$。因为 $\\varphi(14) = 6$ 不是素数，所以 $(\\mathbb{Z}/14\\mathbb{Z})^\\times$ 不是循环群。这使得我们无法选择模 14 的原根，因此离散对数方法无法将 $x^k \\equiv a \\pmod{14}$ 线性化。\n\nC. $n = 8$。群 $(\\mathbb{Z}/8\\mathbb{Z})^\\times$ 不是循环群；事实上它同构于 $C_2 \\times C_2$，所以每个元素的阶都整除 $2$。因此，不存在单一的生成元可以将所有的 $x$ 写成 $x = g^u$ 的形式，并且当 $k$ 是偶数时，对于所有的单位 $x$，都有 $x^k \\equiv 1 \\pmod{8}$，这表明单个离散对数无法将 $x^k \\equiv a \\pmod{8}$ 化简为单个关于指数的线性同余式。\n\nD. $n = 9$。因为 $\\varphi(9) = 6$ 是合数，所以 $(\\mathbb{Z}/9\\mathbb{Z})^\\times$ 不是循环群，因此不存在原根。没有生成元，离散对数就无法将 $x^k \\equiv a \\pmod{9}$ 简化为单个线性同余式。", "solution": "这个问题的核心在于理解模 $n$ 整数乘法群 $(\\mathbb{Z}/n\\mathbb{Z})^\\times$ 的结构。这个群是循环群（即拥有一个生成元，也称为原根）当且仅当模 $n$ 的形式为 $1$, $2$, $4$, $p^k$ 或 $2p^k$，其中 $p$ 是一个奇素数，$k \\ge 1$ 是一个整数。\n\n求解 $x^k \\equiv a \\pmod{n}$ 的离散对数方法关键依赖于群 $(\\mathbb{Z}/n\\mathbb{Z})^\\times$ 是循环群。如果存在一个生成元 $g$，那么任何单位 $x$ 和 $a$ 都可以唯一地表示为 $x \\equiv g^u \\pmod{n}$ 和 $a \\equiv g^v \\pmod{n}$，其中指数 $u, v \\in \\{0, 1, \\dots, \\varphi(n)-1\\}$，$\\varphi(n)$ 是群的阶。同余式 $x^k \\equiv a \\pmod{n}$ 随后被转换为 $(g^u)^k \\equiv g^v \\pmod{n}$，这等价于线性同余式 $uk \\equiv v \\pmod{\\varphi(n)}$。\n\n如果 $(\\mathbb{Z}/n\\mathbb{Z})^\\times$ 不是循环群，那么没有任何单个元素 $g$ 能生成该群的所有元素。因此，不可能将每个元素都表示为单个底数 $g$ 的幂，从而阻碍了向单个线性同余式的直接简化。\n\n我们现在来分析每个选项。\n\n**A. $n = 15$。**\n- **模数分析：** 模数是 $n=15$。这是一个合数。其素因数分解为 $15 = 3 \\times 5$。这不属于 $1, 2, 4, p^k,$ 或 $2p^k$ 的形式。因此，$(\\mathbb{Z}/15\\mathbb{Z})^\\times$ 不是一个循环群。\n- **群结构：** 根据中国剩余定理，$(\\mathbb{Z}/15\\mathbb{Z})^\\times \\cong (\\mathbb{Z}/3\\mathbb{Z})^\\times \\times (\\mathbb{Z}/5\\mathbb{Z})^\\times$。其分量群是循环群：$(\\mathbb{Z}/3\\mathbb{Z})^\\times \\cong C_{\\varphi(3)} \\cong C_2$ 且 $(\\mathbb{Z}/5\\mathbb{Z})^\\times \\cong C_{\\varphi(5)} \\cong C_4$。因此，$(\\mathbb{Z}/15\\mathbb{Z})^\\times \\cong C_2 \\times C_4$。循环群的直积 $C_m \\times C_k$ 是循环群当且仅当 $\\gcd(m,k)=1$。此处，$\\gcd(2,4)=2 \\ne 1$，所以该群确实不是循环群。\n- **解释分析：** 该解释指出，由于群不是循环群，我们无法将每个元素都写成单个生成元 $g$ 的幂。这是非循环群的定义。它进一步解释说，问题 $x^k \\equiv a \\pmod{15}$ 必须分解为针对不同循环分量的同余方程组：\n$$ x^k \\equiv a \\pmod{3} $$\n$$ x^k \\equiv a \\pmod{5} $$\n其中每一个都可以在其各自的（循环）群中使用离散对数求解，从而得到一个关于指数的线性同余方程组。这是对如何处理这种情况的完全准确的描述。\n- **结论：** 正确。\n\n**B. $n = 14$。**\n- **模数分析：** 模数是 $n=14$。其素因数分解为 $14 = 2 \\times 7$。这是 $2p^k$ 的形式，其中奇素数 $p=7$ 且 $k=1$。因此，$(\\mathbb{Z}/14\\mathbb{Z})^\\times$ **是** 一个循环群。该陈述声称它不是循环群，这在事实上是错误的。\n- **解释分析：** 给出的理由是“因为 $\\varphi(14) = \\varphi(2)\\varphi(7) = 1 \\times 6 = 6$ 不是素数，所以 $(\\mathbb{Z}/14\\mathbb{Z})^\\times$ 不是循环群。”这个推理是错误的。循环群的阶不必是素数。例如，$(\\mathbb{Z}/9\\mathbb{Z})^\\times$ 是一个阶为 $\\varphi(9) = 6$ 的循环群，而 6 不是素数。\n- **结论：** 不正确。关于 $(\\mathbb{Z}/14\\mathbb{Z})^\\times$ 不是循环群的主要断言是错误的。\n\n**C. $n = 8$。**\n- **模数分析：** 模数是 $n=8=2^3$。对于 $k \\ge 3$，形式为 $2^k$ 的模数没有原根。因此，$(\\mathbb{Z}/8\\mathbb{Z})^\\times$ 不是一个循环群。\n- **群结构：** 模 8 的单位群是 $(\\mathbb{Z}/8\\mathbb{Z})^\\times = \\{1, 3, 5, 7\\}$。已知其群结构为 $(\\mathbb{Z}/2^3\\mathbb{Z})^\\times \\cong C_2 \\times C_{2^{3-2}} = C_2 \\times C_2$。这不是循环群。除单位元外，每个元素的阶都是 2：$3^2 \\equiv 9 \\equiv 1 \\pmod 8$，$5^2 \\equiv 25 \\equiv 1 \\pmod 8$，$7^2 \\equiv 49 \\equiv 1 \\pmod 8$。\n- **解释分析：** 该选项正确地指出了群结构为 $C_2 \\times C_2$ 且它不是循环群。它正确地陈述了每个元素的阶都整除 2。其指出的后果是，对于任何偶数指数 $k$，对于任何单位 $x$，都有 $x^k = (x^2)^{k/2} \\equiv 1^{k/2} \\equiv 1 \\pmod 8$。这意味着像 $x^k \\equiv a \\pmod 8$（对于偶数 $k$）这样的同余式只有在 $a \\equiv 1 \\pmod 8$ 时才可能有解。这是一个严重的障碍，也是一个有力的例证，说明了为何通用的离散对数框架会失败。例如，$x^2 \\equiv 3 \\pmod 8$ 无解。该解释是准确且有见地的。\n- **结论：** 正确。\n\n**D. $n = 9$。**\n- **模数分析：** 模数是 $n=9=3^2$。这是 $p^k$ 的形式，其中奇素数 $p=3$ 且 $k=2$。因此，$(\\mathbb{Z}/9\\mathbb{Z})^\\times$ **是** 一个循环群。该陈述声称它不是循环群，这在事实上是错误的。例如，2 是一个生成元，因为它的幂模 9 为 $2, 4, 8, 7, 5, 1$。\n- **解释分析：** 给出的理由是“因为 $\\varphi(9)=6$ 是合数，所以 $(\\mathbb{Z}/9\\mathbbZ})^\\times$ 不是循环群”。正如在选项 B 中解释的那样，这个推理是错误的。循环群的阶可以是合数。\n- **结论：** 不正确。关于 $(\\mathbb{Z}/9\\mathbb{Z})^\\times$ 不是循环群的主要断言是错误的。", "answer": "$$\\boxed{AC}$$", "id": "3087740"}]}