{"hands_on_practices": [{"introduction": "掌握一个算法的最佳方式之一是观察它在理想情况下的运作。本练习将米勒-拉宾检验应用于一个已知的素数 $p=29$。通过逐步计算检验序列，你将亲眼见证该算法的理论基础——即在一个素数模下，1的平方根只有 $1$ 和 $-1$——是如何确保一个素数能够通过检验的 [@problem_id:3092066]。", "problem": "设 $p$ 为一个奇素数， $a$ 为一个与 $p$ 互素的整数，即 $\\gcd(a,p)=1$。米勒-拉宾素性检验（MR）基于费马小定理和模 $p$ 的乘法群的性质。从费马小定理 $a^{p-1} \\equiv 1 \\pmod p$ 出发，解释为什么将 $p-1=2^{s}d$（其中 $d$ 为奇数）写成这种形式会产生一个平方链\n$$\nx_{0} \\equiv a^{d} \\pmod p,\\quad x_{1} \\equiv x_{0}^{2} \\pmod p,\\quad \\ldots,\\quad x_{s} \\equiv x_{s-1}^{2} \\pmod p,\n$$\n该链在 $x_{s} \\equiv 1 \\pmod p$ 处终止，并解释为什么在素数模下，该链中紧接在 $1$ 前面的唯一可能值是模 $p$ 的 $1$ 或 $-1$。\n\n对于 $p=29$ 和底数 $a=10$ 的具体情况：\n- 计算 $p-1=2^{s}d$（其中 $d$ 为奇数）的分解，并确定 $x_{0} \\equiv a^{d} \\pmod p$。\n- 连续平方以得到所需的 $x_{1}, x_{2}$，并验证米勒-拉宾检验因在适当阶段达到 $-1$ 或 $1$ 而通过测试。\n\n报告满足 $x_{t} \\equiv -1 \\pmod p$ 的最小整数 $t$（其中 $0 \\leq t  s$）作为你的最终数值答案。如果 $x_{0} \\equiv -1 \\pmod p$，则 $t=0$。如果不存在这样的 $t$，则定义 $t=s$。", "solution": "该问题陈述经核实具有科学依据，表述清晰且客观。它基于数论的既定原理，特别是费马小定理和模素数的二次剩余性质，这些是米勒-拉宾素性检验的基础。问题是自洽的，提供了所有必要信息，并要求一个可验证的结果。因此，有必要提供完整的解答。\n\n问题要求进行两个概念性解释，然后进行一个具体的计算。\n\n首先，我们解决概念部分。设 $p$ 为一个奇素数， $a$ 为一个与 $p$ 互素的整数，即 $\\gcd(a,p)=1$。我们已知 $p-1$ 的分解形式为 $p-1=2^{s}d$，其中 $d$ 是奇数且 $s \\geq 1$（因为 $p-1$ 是偶数）。序列定义为 $x_{0} \\equiv a^{d} \\pmod p$ 和 $x_{k} \\equiv x_{k-1}^{2} \\pmod p$ (对于 $k \\ge 1$）。\n\n第一个任务是解释为什么该链在 $x_{s} \\equiv 1 \\pmod p$ 处终止。\n我们可以用 $a$, $d$ 和 $k$ 直接表示每一项 $x_k$。\n基本情况是 $x_{0} \\equiv a^{d} \\pmod p$。\n对于 $k=1$，我们有 $x_{1} \\equiv x_{0}^{2} \\equiv (a^{d})^{2} \\equiv a^{d \\cdot 2^{1}} \\pmod p$。\n对于 $k=2$，我们有 $x_{2} \\equiv x_{1}^{2} \\equiv (a^{d \\cdot 2^{1}})^{2} \\equiv a^{d \\cdot 2^{2}} \\pmod p$。\n通过数学归纳法，可以清楚地得出，对于任何 $k \\ge 0$，序列中的第 $k$ 项由下式给出：\n$$x_{k} \\equiv a^{d \\cdot 2^{k}} \\pmod p$$\n为了找到链的末项 $x_s$，我们代入 $k=s$：\n$$x_{s} \\equiv a^{d \\cdot 2^{s}} \\pmod p$$\n根据给定的 $p-1$ 的分解，我们有 $2^{s}d = p-1$。将此代入指数，得到：\n$$x_{s} \\equiv a^{p-1} \\pmod p$$\n根据费马小定理，对于素数 $p$ 和不能被 $p$ 整除的整数 $a$ （即 $\\gcd(a,p)=1$），有 $a^{p-1} \\equiv 1 \\pmod p$ 成立。\n因此，我们可以得出结论，该平方链必然在 $x_{s} \\equiv 1 \\pmod p$ 处终止。\n\n第二个任务是解释为什么在该链中紧接在 $1$ 前面的唯一可能值是模 $p$ 的 $1$ 或 $-1$。\n假设对于某个 $k$（其中 $0  k \\le s$），我们有 $x_{k} \\equiv 1 \\pmod p$。我们关心前一项 $x_{k-1}$ 的值。这些项之间的关系由 $x_{k} \\equiv x_{k-1}^{2} \\pmod p$ 给出。\n代入 $x_{k} \\equiv 1 \\pmod p$，我们得到同余式：\n$$x_{k-1}^{2} \\equiv 1 \\pmod p$$\n这可以改写为：\n$$x_{k-1}^{2} - 1 \\equiv 0 \\pmod p$$\n将左侧因式分解为平方差，得到：\n$$(x_{k-1} - 1)(x_{k-1} + 1) \\equiv 0 \\pmod p$$\n这意味着素数 $p$ 必须整除乘积 $(x_{k-1} - 1)(x_{k-1} + 1)$。素数的一个基本性质（欧几里得引理）指出，如果一个素数整除两个整数的乘积，那么它必须至少整除其中一个整数。因此，我们有两种可能性：\n1. $p$ 整除 $(x_{k-1} - 1)$，这意味着 $x_{k-1} - 1 \\equiv 0 \\pmod p$，即 $x_{k-1} \\equiv 1 \\pmod p$。\n2. $p$ 整除 $(x_{k-1} + 1)$，这意味着 $x_{k-1} + 1 \\equiv 0 \\pmod p$，即 $x_{k-1} \\equiv -1 \\pmod p$。\n在模素数 $p$ 的整数域中，这是 $1$ 的平方根的仅有的两个解。因此，如果链中的某一项 $x_k$ 为 $1$，它的前一项 $x_{k-1}$ 必须是模 $p$ 的 $1$ 或 $-1$。\n\n现在，我们来处理 $p=29$ 和底数 $a=10$ 的具体情况。\n首先，我们计算 $p-1 = 2^{s}d$ 的分解。\n给定 $p=29$，我们有 $p-1 = 28$。\n分解出 $2$ 的幂：$28 = 4 \\times 7 = 2^{2} \\times 7$。\n与 $p-1=2^{s}d$ 比较，我们确定 $s=2$ 和 $d=7$。$d=7$ 是奇数，符合要求。\n\n接下来，我们计算 $x_{0} \\equiv a^{d} \\pmod p$。\n$$x_{0} \\equiv 10^{7} \\pmod{29}$$\n我们可以使用模幂运算（快速幂）来计算：\n$10^{1} \\equiv 10 \\pmod{29}$\n$10^{2} \\equiv 100 \\equiv 3 \\times 29 + 13 \\equiv 13 \\pmod{29}$\n$10^{4} \\equiv 13^{2} \\equiv 169 \\equiv 5 \\times 29 + 24 \\equiv 24 \\equiv -5 \\pmod{29}$\n由于指数是 $7 = 4+2+1$，我们有：\n$x_{0} \\equiv 10^{7} \\equiv 10^{4} \\cdot 10^{2} \\cdot 10^{1} \\pmod{29}$\n$x_{0} \\equiv 24 \\cdot 13 \\cdot 10 \\pmod{29}$\n首先，$24 \\cdot 13 \\equiv (-5) \\cdot 13 = -65 \\pmod{29}$。由于 $-65 = -3 \\times 29 + 22 = -87 + 22$，我们有 $-65 \\equiv 22 \\pmod{29}$。\n然后，$22 \\cdot 10 = 220 \\pmod{29}$。由于 $220 = 7 \\times 29 + 17 = 203 + 17$，我们有 $220 \\equiv 17 \\pmod{29}$。\n所以，$x_{0} \\equiv 17 \\pmod{29}$。\n\n米勒-拉宾检验通过的条件是，要么 $x_{0} \\equiv 1 \\pmod p$，要么后续某项 $x_t$（对于 $0 \\le t  s$）与 $-1 \\pmod p$ 同余。\n这里，$x_{0} = 17 \\not\\equiv 1 \\pmod{29}$。并且，$x_{0} \\not\\equiv -1 \\pmod{29}$。所以我们继续计算 $x_1$。\n平方链是 $x_{0}, x_{1}, \\ldots, x_{s}$，对于 $s=2$ 来说就是 $x_{0}, x_{1}, x_{2}$。\n我们计算 $x_{1} \\equiv x_{0}^{2} \\pmod{29}$：\n$$x_{1} \\equiv 17^{2} \\pmod{29}$$\n$17^{2} = 289$。我们将 $289$ 除以 $29$：$289 = 9 \\times 29 + 28 = 261 + 28$。\n因此，$x_{1} \\equiv 28 \\pmod{29}$。\n由于 $28 \\equiv -1 \\pmod{29}$，我们发现 $x_{1} \\equiv -1 \\pmod{29}$。\n米勒-拉宾检验通过，因为我们在链的末端之前找到了一个与 $-1$ 同余的项。为完整起见，我们计算 $x_2$：\n$x_2 \\equiv x_1^2 \\equiv (-1)^2 \\equiv 1 \\pmod{29}$，这证实了链如预期那样终止。\n同余序列是 $x_0 \\equiv 17$, $x_1 \\equiv -1$, $x_2 \\equiv 1 \\pmod{29}$。\n\n最后的任务是找到满足 $x_{t} \\equiv -1 \\pmod p$ 的最小整数 $t$（其中 $0 \\leq t  s$）。\n这里，$s=2$，所以我们在寻找集合 $\\{0, 1\\}$ 中的最小 $t$。\n对于 $t=0$：$x_{0} \\equiv 17 \\pmod{29}$，不等于 $-1 \\pmod{29}$。\n对于 $t=1$：$x_{1} \\equiv -1 \\pmod{29}$。\n条件在 $t=1$ 时满足。由于对任何更小的非负整数都不满足该条件，所以 $t$ 的最小值为 $1$。", "answer": "$$\\boxed{1}$$", "id": "3092066"}, {"introduction": "米勒-拉宾检验的真正威力在于它如何揭示合数的内在结构。本练习将检验应用于合数 $n=341$，这是一个能够骗过简单费马检验的数。你将通过计算发现一个“非平凡的1的平方根”，这不仅是该数是合数的铁证，还为我们提供了一种利用最大公约数（GCD）来分解它的强大工具 [@problem_id:3092062]。", "problem": "设 $n=341$。从费马小定理开始：对于一个素数 $p$ 和任意整数 $a$ 且 $\\gcd(a,p)=1$，有 $a^{p-1} \\equiv 1 \\pmod{p}$。Miller–Rabin 素性检验在此基础上，通过重复平方来探测模奇数 $n$ 的余数结构。将 $n-1$ 写成 $2^{s} d$ 的形式，其中 $d$ 为奇数，选择一个底数 $a=2$ 使得 $\\gcd(2,n)=1$，并计算由 $x_{0} \\equiv 2^{d} \\pmod{n}$ 和 $x_{i+1} \\equiv x_{i}^{2} \\pmod{n}$ (对于 $i \\geq 0$) 定义的序列。仅使用模算术的性质和上述基本事实，确定这个序列是否揭示了模 $n$ 下 $1$ 的一个非平凡平方根，即一个满足 $x^{2} \\equiv 1 \\pmod{n}$ 但 $x \\not\\equiv \\pm 1 \\pmod{n}$ 的 $x$。如果找到了这样的 $x$，解释它如何证明 $n$ 是合数，并用它通过计算两个与 $n$ 的最大公约数来得到 $n$ 的一个非平凡因式分解。将您的最终结果以单行矩阵的形式报告，其中包含您找到的非平凡平方根，后跟 $n$ 的两个素数因子，形式为精确整数。不需要四舍五入。", "solution": "该问题陈述经评估具有科学依据、问题明确、客观且完整。满足了数论中一个有效问题的所有条件。我们开始解题。\n\n问题要求对整数 $n=341$ 和底数 $a=2$ 执行一组与 Miller-Rabin 素性检验相关的特定步骤。目标是确定是否能找到模 $n$ 下 $1$ 的一个非平凡平方根，如果找到，则用它来对 $n$ 进行因式分解。\n\n首先，我们必须将 $n-1$ 分解为 $2^s d$ 的形式，其中 $d$ 是奇数且 $s \\ge 1$。\n给定 $n=341$，我们有 $n-1 = 340$。\n为了找到 $s$ 和 $d$，我们从 $340$ 中分解出 $2$ 的幂：\n$$340 = 2 \\times 170 = 2 \\times (2 \\times 85) = 2^2 \\times 85$$\n这里，$d = 85$ 是奇数。因此，我们有 $s=2$ 和 $d=85$。\n\n问题指定使用底数 $a=2$。该测试的一个先决条件是 $\\gcd(a, n) = 1$。\n我们检查此条件：$\\gcd(2, 341) = 1$，因为 $341$ 是一个奇数。条件成立。\n\n接下来，我们被要求计算由 $x_0 \\equiv a^d \\pmod{n}$ 和 $x_{i+1} \\equiv x_i^2 \\pmod{n}$ 定义的序列。这个序列是 $a^d, a^{2d}, a^{4d}, \\dots, a^{2^{s-1}d}$ 模 $n$ 的值。\n对于我们的数值，我们计算 $x_0 \\equiv 2^{85} \\pmod{341}$。\n我们可以使用模幂运算来执行此计算。一个有效的方法是首先注意到 $341 = 11 \\times 31$。根据费马小定理，对于一个素数 $p$ 和不能被 $p$ 整除的整数 $a$，有 $a^{p-1} \\equiv 1 \\pmod{p}$。\n对于 $p=11$，$2^{11-1} = 2^{10} \\equiv 1 \\pmod{11}$。\n对于 $p=31$，$2^5 = 32 \\equiv 1 \\pmod{31}$，这意味着 $2^{10} = (2^5)^2 \\equiv 1^2 \\equiv 1 \\pmod{31}$。\n由于 $2^{10} - 1$ 能被 $11$ 和 $31$ 整除，且 $\\gcd(11, 31) = 1$，它必定能被它们的乘积 $11 \\times 31 = 341$ 整除。因此，$2^{10} \\equiv 1 \\pmod{341}$。\n\n使用这个性质，我们可以简化 $x_0$ 的计算：\n$$x_0 \\equiv 2^{85} \\pmod{341}$$\n$$2^{85} = 2^{10 \\times 8 + 5} = (2^{10})^8 \\cdot 2^5$$\n$$x_0 \\equiv (1)^8 \\cdot 2^5 \\pmod{341}$$\n$$x_0 \\equiv 32 \\pmod{341}$$\n\n我们序列中的第一项是 $x_0 = 32$。Miller-Rabin 检验会检查此项是否为 $1$ 或 $-1$。\n$$32 \\not\\equiv 1 \\pmod{341}$$\n$$32 \\not\\equiv -1 \\pmod{341} \\quad (\\text{因为 } -1 \\equiv 340 \\pmod{341})$$\n由于 $x_0$ 不是 $\\pm 1$，我们继续计算序列中的下一项 $x_1$。\n$$x_1 \\equiv x_0^2 \\pmod{341}$$\n$$x_1 \\equiv 32^2 \\pmod{341}$$\n$$x_1 \\equiv 1024 \\pmod{341}$$\n为了简化 $1024 \\pmod{341}$，我们进行除法运算：$1024 = 3 \\times 341 + 1$。\n所以，$x_1 \\equiv 1 \\pmod{341}$。\n\n我们在序列中找到了一个项 $x_1$，它与 $1 \\pmod{n}$ 同余。Miller-Rabin 检验的核心在于检查前一项 $x_0$。我们发现 $x_0 = 32$ 且 $x_0^2 \\equiv 1 \\pmod{341}$。然而，$x_0$ 本身与模 $341$ 下的 $1$ 或 $-1$ 都不同余。\n这意味着 $x_0=32$ 是模 $341$ 下 $1$ 的一个非平凡平方根。\n\n这样一个根的存在是 $n$ 为合数的明确证据。如果 $n$ 是一个素数，同余式 $x^2 \\equiv 1 \\pmod n$ 将等价于域 $\\mathbb{Z}_n$ 中的多项式方程 $x^2-1=0$。根据拉格朗日定理，一个 $k$ 次多项式在一个域中最多有 $k$ 个根。对于 $x^2-1=0$，根总是 $x=1$ 和 $x=-1$。发现第三个根 $x=32$ 证明了模 $n$ 的整数环 $\\mathbb{Z}_n$ 不是一个域，因此 $n$ 不是素数。\n\n关系式 $x_0^2 \\equiv 1 \\pmod{n}$ 意味着 $x_0^2 - 1 \\equiv 0 \\pmod{n}$，可以写成 $(x_0-1)(x_0+1) \\equiv 0 \\pmod{n}$。这意味着 $n$ 整除乘积 $(x_0-1)(x_0+1)$。\n由于 $x_0 \\not\\equiv 1 \\pmod{n}$，$n$ 不整除 $x_0-1$。\n由于 $x_0 \\not\\equiv -1 \\pmod{n}$，$n$ 不整除 $x_0+1$。\n要使 $n$ 整除该乘积而不整除任何一个因子，$n$ 必须是合数，并且它的因子必须分布在 $(x_0-1)$ 和 $(x_0+1)$ 之间。具体来说，$\\gcd(x_0 - 1, n)$ 和 $\\gcd(x_0 + 1, n)$ 必须是 $n$ 的非平凡因子。\n\n我们现在使用我们的非平凡平方根 $x_0=32$ 来计算这些因子。\n第一个因子是 $\\gcd(x_0 - 1, n) = \\gcd(32 - 1, 341) = \\gcd(31, 341)$。\n通过试除法，我们发现 $341 = 11 \\times 31$。因此，$\\gcd(31, 341) = 31$。\n\n第二个因子是 $\\gcd(x_0 + 1, n) = \\gcd(32 + 1, 341) = \\gcd(33, 341)$。\n使用欧几里得算法或素因数分解：$33 = 3 \\times 11$ 和 $341 = 11 \\times 31$。最大公约数是 $11$。\n所以，$\\gcd(33, 341) = 11$。\n\n该过程揭示了非平凡平方根 $32$ 以及 $n=341$ 的因子 $11$ 和 $31$。我们可以验证 $11 \\times 31 = 341$。问题要求以单行矩阵报告这三个数。\n\n找到的非平凡平方根是 $32$。\n找到的两个素数因子是 $11$ 和 $31$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n32  11  31\n\\end{pmatrix}\n}\n$$", "id": "3092062"}, {"introduction": "卡米切尔数是费马素性检验的“克星”，因为它们对所有互质的底数都表现得像素数。这个高级练习将米勒-拉宾检验应用于最小的卡米切尔数 $n=561$。通过测试多个不同的底数，你将理解为什么米勒-拉宾检验是一个强大的概率性算法，以及它如何通过发现非平凡的1的平方根来成功“揭穿”这些最具欺骗性的合数 [@problem_id:3092071]。", "problem": "设 $n$ 是一个奇合数，设 $a$ 是一个满足 $1 \\leq a \\leq n-1$ 和 $\\gcd(a,n)=1$ 的整数。卡米切尔数是一个合数 $n$，对于所有满足 $\\gcd(a,n)=1$ 的整数 $a$，它都满足 $a^{n-1} \\equiv 1 \\pmod{n}$。米勒-拉宾（Miller–Rabin, MR）素性检验的过程如下：将 $n-1$ 写成 $n-1=2^{s}d$ 的形式，其中 $d$ 是奇数；构造序列 $x_{0} \\equiv a^{d} \\pmod{n}$ 以及 $x_{i+1} \\equiv x_{i}^{2} \\pmod{n}$（对于 $i \\geq 0$）；如果 $x_{0} \\not\\equiv \\pm 1 \\pmod{n}$ 并且对于 $1 \\leq i \\leq s-1$ 没有 $x_{i}$ 与 $-1 \\pmod{n}$ 同余，则判定 $n$ 为合数。否则，对于底数 $a$ 的检验结果是不确定的（称 $n$ 为关于底数 $a$ 的“概率素数”）。\n\n仅从这些定义和中国剩余定理（Chinese Remainder Theorem, CRT）出发，解释为什么即使卡米切尔数对所有互素的 $a$ 都满足 $a^{n-1} \\equiv 1 \\pmod{n}$，米勒-拉宾检验仍然能对许多底数 $a$ 揭示其合数性质。你的解释应基于对 $n$ 的素因子取模并进行平方运算，如何能迫使序列 $x_{i}$ 遇到一个模 $n$ 的1的非平凡平方根。\n\n然后，取特定的卡米切尔数 $n=561$ 并执行以下操作：\n- 计算 $s$ 和 $d$，使得 $n-1=2^{s}d$，其中 $d$ 为奇数。\n- 对每个满足 $\\gcd(a,n)=1$ 的底数 $a \\in \\{2,10,50\\}$，执行米勒-拉宾检验的步骤，以确定该检验对该底数是判定为“合数”还是“不确定”。通过基于基本性质的显式模运算来证明每个结论（不得依赖未经证实的启发式方法）。\n- 如果检验对底数 $a$ 判定为“合数”，则定义 $w(a)=1$；如果结果是“不确定”，则定义 $w(a)=0$。令 $W=\\sum_{a\\in\\{2,10,50\\}} w(a)$。\n\n报告单个数字 $W$ 作为你的最终答案。无需四舍五入。最终数字不带任何单位。", "solution": "该问题有效，因为它在数学上是合理的、自洽的、定义明确的，并且直接关系到数论中指定的专题。\n\n该问题包含两部分：关于米勒-拉宾检验对卡米切尔数有效性的概念性解释，以及将该检验应用于卡米切尔数 $n=561$ 的具体实例。\n\n**第一部分：概念性解释**\n\n卡米切尔数 $n$ 是一个合数，对于所有与 $n$ 互素的整数 $a$ 都满足同余式 $a^{n-1} \\equiv 1 \\pmod{n}$。这一性质使得卡米切尔数成为对所有可能底数 $a$ 的“费马伪素数”，这意味着它们是合数，但无法通过使用随机选择的互素底数的费马素性检验来检测出来。米勒-拉宾（MR）检验是费马检验的一种改进，在许多情况下可以检测出卡米切尔数的合数性质。\n\n设 $n$ 是一个奇合数，其素数分解为 $n=p_1 p_2 \\cdots p_k$，其中 $k \\ge 2$。对于 MR 检验，我们将 $n-1$ 写成 $n-1=2^s d$ 的形式，其中 $d$ 是一个奇数且 $s \\ge 1$。对于一个选定的与 $n$ 互素的底数 $a$，我们检验以下数值序列：\n$$x_0 \\equiv a^d \\pmod{n}$$\n$$x_1 \\equiv x_0^2 \\equiv a^{2d} \\pmod{n}$$\n$$x_2 \\equiv x_1^2 \\equiv a^{4d} \\pmod{n}$$\n$$\\vdots$$\n$$x_s \\equiv x_{s-1}^2 \\equiv a^{2^s d} \\equiv a^{n-1} \\pmod{n}$$\n由于 $n$ 是一个卡米切尔数，我们知道最后一项是 $x_s \\equiv a^{n-1} \\equiv 1 \\pmod{n}$。\n\n如果 $n$ 是一个素数，那么同余方程 $x^2 \\equiv 1 \\pmod{n}$ 的唯一解是 $x \\equiv 1 \\pmod{n}$ 和 $x \\equiv -1 \\pmod{n}$。因此，对于一个素数 $n$，如果我们检查 MR 序列，第一个等于 $1$ 的项必须由一个等于 $-1$ 的项所前导，除非序列的第一项 $x_0$ 本身就是 $1$。任何其他行为都表明 $n$ 是合数。\n\nMR 检验的威力在于其能够检测出“1 的非平凡平方根”。模 $n$ 的 1 的非平凡平方根是一个整数 $x$，满足 $x^2 \\equiv 1 \\pmod{n}$ 但 $x \\not\\equiv \\pm 1 \\pmod{n}$。这样的根存在的充要条件是 $n$ 是一个不等于素数幂的合数。\n\n这些非平凡平方根的存在可以用中国剩余定理（CRT）来解释。由于 $n=p_1 p_2 \\cdots p_k$，同余方程 $x^2 \\equiv 1 \\pmod{n}$ 等价于以下同余方程组：\n$$x^2 \\equiv 1 \\pmod{p_1}$$\n$$x^2 \\equiv 1 \\pmod{p_2}$$\n$$\\vdots$$\n$$x^2 \\equiv 1 \\pmod{p_k}$$\n对于每个素数模 $p_i$，解是 $x \\equiv \\pm 1 \\pmod{p_i}$。根据 CRT，我们可以为每种符号选择的组合构造一个模 $n$ 的唯一解。总共有 $2^k$ 种这样的组合。选择 $(+1, +1, \\dots, +1)$ 对应于 $x \\equiv 1 \\pmod{n}$，选择 $(-1, -1, \\dots, -1)$ 对应于 $x \\equiv -1 \\pmod{n}$。如果 $k \\ge 2$，则还有 $2^k - 2$ 种其他组合，例如 $(+1, -1, \\dots)$，这些组合对应于模 $n$ 的 1 的非平凡平方根。\n\n如果对于一个选定的底数 $a$，序列 $x_0, x_1, \\dots, x_{s-1}$ 中包含一个项 $x_i$ 是 1 的非平凡平方根，那么 MR 检验就能揭示卡米切尔数 $n$ 的合数性质。这意味着 $x_i \\not\\equiv \\pm 1 \\pmod{n}$ 但 $x_{i+1} = x_i^2 \\equiv 1 \\pmod{n}$。这个序列不具备“类素数”性质，即 1 的前一项是 -1。\n\n即使对于 $n$ 的所有素因子 $p_j$ 都有 $a^{n-1} \\equiv 1 \\pmod{p_j}$，得到 1 所需的指数对于每个模数可能不同。对于给定的底数 $a$，可能对于某个素因子 $p_1$，我们有 $a^{2^i d} \\equiv -1 \\pmod{p_1}$，而对于另一个素因子 $p_2$，我们有 $a^{2^i d} \\equiv 1 \\pmod{p_2}$。在这种情况下，项 $x_i \\equiv a^{2^i d} \\pmod{n}$ 通过 CRT 对应于余数组 $(\\dots, -1, \\dots, 1, \\dots)$。这个 $x_i$ 不可能等于 $1$ 或 $-1 \\pmod{n}$。然而，它的平方 $x_{i+1} = x_i^2$ 将对应于元组 $(\\dots, (-1)^2, \\dots, 1^2, \\dots) = (1, 1, \\dots, 1)$，这意味着 $x_{i+1} \\equiv 1 \\pmod{n}$。该检验找到了一个 1 的非平凡平方根 ($x_i$)，从而证明 $n$ 是合数。虽然并非所有底数 $a$ 都能揭示卡米切尔数的合数性质，但已知对于任何合数 $n$，至少有 $3/4$ 的可能底数是“证据”(witnesses)。\n\n**第二部分：对 n=561 进行米勒-拉宾检验**\n\n首先，我们为 $n=561$ 准备必要的参数。\n整数是 $n=561$。其素数分解是 $561=3 \\times 11 \\times 17$。\n我们必须找到 $s$ 和 $d$，使得 $n-1 = 2^s d$，其中 $d$ 是奇数。\n$n-1 = 560 = 56 \\times 10 = (8 \\times 7) \\times (2 \\times 5) = (2^3 \\times 7) \\times (2 \\times 5) = 2^4 \\times 35$。\n因此，$s=4$ 且 $d=35$。\n\n如果 $a^d \\equiv \\pm 1 \\pmod{561}$ 或者对于某个 $i \\in \\{1, 2, 3\\}$ 有 $a^{2^i d} \\equiv -1 \\pmod{561}$，则检验结果为“不确定”。否则，检验判定为“合数”。\n\n**情况 1：底数 a = 2**\n$\\gcd(2, 561) = 1$。我们计算序列 $x_i \\equiv 2^{2^i \\cdot 35} \\pmod{561}$。\n$x_0 = 2^{35} \\pmod{561}$。我们使用中国剩余定理，模数为 $3, 11, 17$。\n$2^{35} \\equiv (-1)^{35} \\equiv -1 \\equiv 2 \\pmod 3$。\n$2^{35} = (2^{10})^3 \\cdot 2^5 \\equiv 1^3 \\cdot 32 \\equiv 10 \\equiv -1 \\pmod{11}$。\n$2^{35} = (2^{16})^2 \\cdot 2^3 \\equiv 1^2 \\cdot 8 \\equiv 8 \\pmod{17}$。\n解方程组 $x \\equiv 2 \\pmod 3$，$x \\equiv 10 \\pmod{11}$，$x \\equiv 8 \\pmod{17}$ 得到 $x_0 \\equiv 263 \\pmod{561}$。\n$x_0 \\equiv 263 \\not\\equiv \\pm 1 \\pmod{561}$。\n\n$x_1 = x_0^2 = 263^2 = 69169 \\equiv 166 \\pmod{561}$。\n$x_1 \\equiv 166 \\not\\equiv -1 \\pmod{561}$。\n\n$x_2 = x_1^2 = 166^2 = 27556 \\equiv 67 \\pmod{561}$。\n$x_2 \\equiv 67 \\not\\equiv -1 \\pmod{561}$。\n使用 CRT，$67 \\equiv 1 \\pmod 3$，$67 \\equiv 1 \\pmod{11}$，以及 $67 \\equiv 16 \\equiv -1 \\pmod{17}$。所以 $67$ 对应于 $(1,1,-1)$。\n\n$x_3 = x_2^2 = 67^2 = 4489 \\equiv 1 \\pmod{561}$。\n$x_3 \\equiv 1 \\not\\equiv -1 \\pmod{561}$。\n注意 $x_2=67$ 是模 $561$ 的 1 的一个非平凡平方根。\n\n不满足不确定性的条件。根据问题的规则，检验结果为合数：$x_0 \\not\\equiv \\pm 1 \\pmod{561}$ 为真，且对于 $i \\in \\{1,2,3\\}$ 没有 $x_i$ 等于 $-1 \\pmod{561}$。\n因此，对于底数 $a=2$，检验判定 $n=561$ 为“合数”。所以，$w(2)=1$。\n\n**情况 2：底数 a = 10**\n$\\gcd(10, 561)=1$。我们计算 $x_0 = 10^{35} \\pmod{561}$。\n$10^{35} \\equiv 1^{35} \\equiv 1 \\pmod 3$。\n$10^{35} \\equiv (-1)^{35} \\equiv -1 \\equiv 10 \\pmod{11}$。\n$10^{35} = (10^{16})^2 \\cdot 10^3 \\equiv 1^2 \\cdot 1000 \\equiv 14 \\pmod{17}$。\n解方程组 $x \\equiv 1 \\pmod 3$，$x \\equiv 10 \\pmod{11}$，$x \\equiv 14 \\pmod{17}$ 得到 $x_0 \\equiv 439 \\pmod{561}$。\n$x_0 \\equiv 439 \\not\\equiv \\pm 1 \\pmod{561}$。\n\n$x_1 = x_0^2 = 439^2 = 192721 \\equiv 298 \\pmod{561}$。\n$x_1 \\equiv 298 \\not\\equiv -1 \\pmod{561}$。\n\n$x_2 = x_1^2 = 298^2 = 88804 \\equiv 166 \\pmod{561}$。\n$x_2 \\equiv 166 \\not\\equiv -1 \\pmod{561}$。\n\n$x_3 = x_2^2 = 166^2 = 27556 \\equiv 67 \\pmod{561}$。\n$x_3 \\equiv 67 \\not\\equiv -1 \\pmod{561}$。\n\n下一项将是 $x_4 = x_3^2 = 67^2 \\equiv 1 \\pmod{561}$，这证实了 $a^{n-1} \\equiv 1 \\pmod n$。\n该序列不满足不确定性的条件。根据问题的规则，检验结果为合数：$x_0 \\not\\equiv \\pm 1 \\pmod{561}$ 且对于 $i \\in \\{1,2,3\\}$ 没有 $x_i$ 等于 $-1 \\pmod{561}$。\n因此，对于底数 $a=10$，检验判定 $n=561$ 为“合数”。所以，$w(10)=1$。\n\n**情况 3：底数 a = 50**\n$\\gcd(50, 561)=1$。我们计算 $x_0 = 50^{35} \\pmod{561}$。\n$50 \\equiv 2 \\equiv -1 \\pmod 3 \\implies 50^{35} \\equiv (-1)^{35} \\equiv -1 \\pmod 3$。\n$50 \\equiv 6 \\pmod{11}$。$50^{35} \\equiv 6^{35} = (6^{10})^3 \\cdot 6^5 \\equiv 1^3 \\cdot 7776 \\equiv 7776 \\pmod{11}$。\n$7776 = 706 \\times 11 + 10 \\implies 50^{35} \\equiv 10 \\equiv -1 \\pmod{11}$。\n$50 \\equiv 16 \\equiv -1 \\pmod{17} \\implies 50^{35} \\equiv (-1)^{35} \\equiv -1 \\pmod{17}$。\n同余方程组为 $x_0 \\equiv -1 \\pmod 3$，$x_0 \\equiv -1 \\pmod{11}$，以及 $x_0 \\equiv -1 \\pmod{17}$。\n根据 CRT，唯一解是 $x_0 \\equiv -1 \\pmod{3 \\cdot 11 \\cdot 17}$，即 $x_0 \\equiv -1 \\pmod{561}$。\n\n如果 $x_0 \\equiv \\pm 1 \\pmod n$，则检验过程为不确定。这里，$x_0 \\equiv -1 \\pmod{561}$。此条件得到满足。\n因此，对于底数 $a=50$，检验结果为“不确定”。所以，$w(50)=0$。\n\n**最终计算**\n$W$ 的值是所有 $w(a)$ 值的总和：\n$W = w(2) + w(10) + w(50) = 1 + 1 + 0 = 2$。", "answer": "$$\n\\boxed{2}\n$$", "id": "3092071"}]}