{"hands_on_practices": [{"introduction": "掌握 Lenstra 椭圆曲线分解法的第一步是熟悉其基本构成单元：定义在有限域上的椭圆曲线。这个练习将引导你亲手计算一条特定椭圆曲线上的点数，让你对这些抽象的数学对象有一个具体的感受。通过这个过程 [@problem_id:3091819]，你不仅能理解点的构成，还将验证椭圆曲线理论中的一个基石——哈斯定理 (Hasse's theorem)，它为曲线上点的数量给出了一个惊人的精确界限。", "problem": "考虑定义在有限域 $\\mathbb{F}_{11}$ 上的椭圆曲线 $E$，其方程为 $y^{2}=x^{3}+4x+1$。在用于整数分解的 Lenstra 椭圆曲线方法（ECM）中，研究的是模素数和合数的椭圆曲线；作为基础，在素数 $p$ 的有限域 $\\mathbb{F}_{p}$ 上的工作依赖于椭圆曲线在有限域上的基本性质。从椭圆曲线作为非奇异射影三次曲线的定义以及包含无穷远点的 $\\mathbb{F}_{p}$-有理点群的定义出发，并利用对于每个 $x \\in \\mathbb{F}_{p}$，求解 $y^{2}=\\text{RHS}(x)$ 的 $y \\in \\mathbb{F}_{p}$ 的数量取决于 $\\text{RHS}(x)$ 是否为二次剩余这一事实，按以下步骤进行：\n\n1. 通过检查其判别式模 $11$ 不为零，来验证 $E$ 在 $\\mathbb{F}_{11}$ 上是非奇异的。\n2. 通过确定对于每个 $x \\in \\mathbb{F}_{11}$，方程 $y^{2}=x^{3}+4x+1$ 的解 $y \\in \\mathbb{F}_{11}$ 的数量，然后加上无穷远点，来枚举 $E(\\mathbb{F}_{11})$ 的所有点。\n3. 令 $q=11$ 和 $N=\\#E(\\mathbb{F}_{11})$。使用 Hasse 界，即 $|N-(q+1)|\\leq 2\\sqrt{q}$，检查你计算出的 $N$ 是否满足这个不等式。\n\n仅返回 $N$ 的值作为最终答案。无需四舍五入，不涉及单位。", "solution": "问题要求计算在有限域 $\\mathbb{F}_{11}$ 上的椭圆曲线 $E$（由方程 $y^{2}=x^{3}+4x+1$ 给出）上的点的数量 $N$。点的总数，记为 $\\#E(\\mathbb{F}_{11})$，包括所有满足曲线方程的点对 $(x, y) \\in \\mathbb{F}_{11} \\times \\mathbb{F}_{11}$，以及一个无穷远点 $\\mathcal{O}$。该过程包括问题陈述中概述的三个步骤。\n\n首先，我们验证曲线 $E$ 在 $\\mathbb{F}_{11}$ 上是非奇异的。形式为 $y^{2}=x^{3}+Ax+B$ 的椭圆曲线是非奇异的，当且仅当其判别式 $\\Delta = -16(4A^3 + 27B^2)$ 不为零。对于给定的曲线，我们有 $A=4$ 和 $B=1$。所有计算都在模 $11$ 下进行。\n判别式为：\n$$ \\Delta = -16(4A^3 + 27B^2) $$\n代入 $A$ 和 $B$ 的值并在 $\\mathbb{F}_{11}$ 中计算：\n$$ -16 \\equiv -5 \\equiv 6 \\pmod{11} $$\n$$ 4 \\equiv 4 \\pmod{11} $$\n$$ 27 \\equiv 5 \\pmod{11} $$\n因此，判别式模 $11$ 为：\n$$ \\Delta \\equiv 6(4 \\cdot 4^3 + 5 \\cdot 1^2) \\pmod{11} $$\n$$ \\Delta \\equiv 6(4 \\cdot 64 + 5) \\pmod{11} $$\n因为 $64 = 5 \\times 11 + 9$，我们有 $64 \\equiv 9 \\pmod{11}$。\n$$ \\Delta \\equiv 6(4 \\cdot 9 + 5) \\pmod{11} $$\n$$ \\Delta \\equiv 6(36 + 5) \\pmod{11} $$\n因为 $36 = 3 \\times 11 + 3$，我们有 $36 \\equiv 3 \\pmod{11}$。\n$$ \\Delta \\equiv 6(3 + 5) \\pmod{11} $$\n$$ \\Delta \\equiv 6(8) \\pmod{11} $$\n$$ \\Delta \\equiv 48 \\pmod{11} $$\n因为 $48 = 4 \\times 11 + 4$，我们有 $48 \\equiv 4 \\pmod{11}$。\n判别式为 $\\Delta = 4$，在 $\\mathbb{F}_{11}$ 中不为零。因此，曲线 $E$ 是非奇异的。\n\n其次，我们枚举 $E(\\mathbb{F}_{11})$ 上的点。我们必须对每个 $z = x^3+4x+1$ 的值，求出方程 $y^2 = z$ 的解 $y \\in \\mathbb{F}_{11}$ 的数量，其中 $x$ 取遍 $\\mathbb{F}_{11} = \\{0, 1, 2, \\dots, 10\\}$ 的所有元素。\n$y$ 的解的数量取决于 $z$ 是否为模 $11$ 的二次剩余。我们首先确定 $\\mathbb{F}_{11}$ 中的二次剩余集合。我们对 $\\mathbb{F}_{11}$ 中的元素进行平方：\n$0^2 \\equiv 0$\n$1^2 \\equiv 1$, $10^2 \\equiv (-1)^2 \\equiv 1$\n$2^2 \\equiv 4$, $9^2 \\equiv (-2)^2 \\equiv 4$\n$3^2 \\equiv 9$, $8^2 \\equiv (-3)^2 \\equiv 9$\n$4^2 = 16 \\equiv 5$, $7^2 \\equiv (-4)^2 \\equiv 5$\n$5^2 = 25 \\equiv 3$, $6^2 \\equiv (-5)^2 \\equiv 3$\n二次剩余（QR）的集合是 $\\{0, 1, 3, 4, 5, 9\\}$。二次非剩余（QNR）的集合是 $\\{2, 6, 7, 8, 10\\}$。\n对于 $y^2 = z$：\n- 如果 $z=0$，有一个解：$y=0$。\n- 如果 $z$ 是一个非零 QR，有两个解。\n- 如果 $z$ 是一个 QNR，没有解。\n\n现在我们遍历所有 $x \\in \\mathbb{F}_{11}$，计算 $z(x) = x^3+4x+1 \\pmod{11}$，并计算相应的 $y$ 的解的数量。\n\n- 对于 $x=0$：$z(0) = 0^3+4(0)+1 = 1$。$1$ 是一个 QR。$y$ 的解的数量：$2$。\n- 对于 $x=1$：$z(1) = 1^3+4(1)+1 = 6$。$6$ 是一个 QNR。$y$ 的解的数量：$0$。\n- 对于 $x=2$：$z(2) = 2^3+4(2)+1 = 8+8+1 = 17 \\equiv 6$。$6$ 是一个 QNR。$y$ 的解的数量：$0$。\n- 对于 $x=3$：$z(3) = 3^3+4(3)+1 = 27+12+1 \\equiv 5+1+1=7$。$7$ 是一个 QNR。$y$ 的解的数量：$0$。\n- 对于 $x=4$：$z(4) = 4^3+4(4)+1 = 64+16+1 \\equiv 9+5+1=15 \\equiv 4$。$4$ 是一个 QR。$y$ 的解的数量：$2$。\n- 对于 $x=5$：$z(5) = 5^3+4(5)+1 = 125+20+1 \\equiv 4+9+1=14 \\equiv 3$。$3$ 是一个 QR。$y$ 的解的数量：$2$。\n- 对于 $x=6$：$z(6) = 6^3+4(6)+1 = 216+24+1 \\equiv 7+2+1=10$。$10$ 是一个 QNR。$y$ 的解的数量：$0$。\n- 对于 $x=7$：$z(7) = 7^3+4(7)+1 = 343+28+1 \\equiv 2+6+1=9$。$9$ 是一个 QR。$y$ 的解的数量：$2$。\n- 对于 $x=8$：$z(8) = 8^3+4(8)+1 = 512+32+1 \\equiv 6+10+1=17 \\equiv 6$。$6$ 是一个 QNR。$y$ 的解的数量：$0$。\n- 对于 $x=9$：$z(9) = 9^3+4(9)+1 = 729+36+1 \\equiv 3+3+1=7$。$7$ 是一个 QNR。$y$ 的解的数量：$0$。\n- 对于 $x=10$：$z(10) = 10^3+4(10)+1 = 1000+40+1 \\equiv 10+7+1=18 \\equiv 7$。$7$ 是一个 QNR。$y$ 的解的数量：$0$。\n\n仿射点（具有有限坐标的点）的总数是 $y$ 的解的数量之和：\n$$ 2 + 0 + 0 + 0 + 2 + 2 + 0 + 2 + 0 + 0 + 0 = 8 $$\n曲线上点的总数是仿射点和无穷远点 $\\mathcal{O}$ 的数量之和。\n$$ N = \\#E(\\mathbb{F}_{11}) = 8 + 1 = 9 $$\n\n第三，我们将此结果与 Hasse 界进行核对。对于有限域 $\\mathbb{F}_q$ 上的椭圆曲线，Hasse 界指出 $| \\#E(\\mathbb{F}_q) - (q+1) | \\leq 2\\sqrt{q}$。\n在我们的例子中，$q=11$ 并且我们得到 $N=9$。我们必须检查是否 $|9 - (11+1)| \\leq 2\\sqrt{11}$。\n$$ |9 - 12| \\leq 2\\sqrt{11} $$\n$$ |-3| \\leq 2\\sqrt{11} $$\n$$ 3 \\leq 2\\sqrt{11} $$\n为了验证这个不等式，我们可以对两边进行平方，因为两边都是正数：\n$$ 3^2 \\leq (2\\sqrt{11})^2 $$\n$$ 9 \\leq 4 \\times 11 $$\n$$ 9 \\leq 44 $$\n该不等式成立，这意味着我们计算出的点的数量 $N=9$ 与 Hasse 定理一致。\n\n$N = \\#E(\\mathbb{F}_{11})$ 的值是 $9$。", "answer": "$$\n\\boxed{9}\n$$", "id": "3091819"}, {"introduction": "椭圆曲线的魅力不仅在于它的点集，更在于这些点构成了一个阿贝尔群。这个群的运算，即“点加法”，是 Lenstra 方法的核心引擎。这个练习 [@problem_id:3091839] 让你在一个安全的素数域 $\\mathbb{F}_p$ 上，实践点加法和点倍乘的运算，此时所有必要的求逆运算都能成功。通过亲自推导和计算，你将掌握这些操作的底层机制，为理解下一步中这些运算如何“失败”并揭示因子打下坚实的基础。", "problem": "考虑有限域 $\\mathbb{F}_{101}$ 上的椭圆曲线 $E$，其方程为 $y^{2}=x^{3}+2x+3$。在 Lenstra 椭圆曲线分解法 (ECM) 中，我们在模一个合数的椭圆曲线上执行群运算，其中逆元可能不存在，从而揭示一个非平凡因子。为了在一个所有非零元素都可逆的环境中练习底层的群运算，我们在素数域 $\\mathbb{F}_{101}$ 上进行操作，并令 $(x_{1},y_{1})=(1,39)$ 和 $(x_{2},y_{2})=(3,6)$。\n\n任务：\n- 首先，通过直接在 $\\mathbb{F}_{101}$ 中检验定义方程 $y^{2}=x^{3}+2x+3$，从基本原理验证点 $(x_{1},y_{1})$ 和 $(x_{2},y_{2})$ 位于曲线 $E$ 上。\n- 仅使用弦切线几何群律作为基本依据（即，通过两点的直线或在一点的切线与三次曲线交于第三点，群和是该第三个交点关于 $x$ 轴的反射点），在 $\\mathbb{F}_{101}$ 上推导出 $(x_{3},y_{3})=(x_{1},y_{1})+(x_{2},y_{2})$ 和 $(x_{4},y_{4})=2(x_{1},y_{1})$ 的代数公式。证明您所使用的乘法逆元在 $\\mathbb{F}_{101}$ 中存在，并明确地执行计算以获得 $(x_{3},y_{3})$ 和 $(x_{4},y_{4})$。\n- 令 $s$ 为 $x$ 坐标 $x_{3}$ 和 $x_{4}$ 之和对 101 取模的结果；即 $s\\equiv x_{3}+x_{4}\\pmod{101}$，其中 $s\\in\\{0,1,\\dots,100\\}$。将单个整数 $s$ 作为您的最终答案。\n\n您的最终答案必须是规范代表集 $\\{0,1,\\dots,100\\}$ 中的单个整数 $s$。不需要四舍五入，也不涉及单位。不要在最终答案中报告中间坐标；只提供 $s$。", "solution": "我们在素数域 $\\mathbb{F}_{101}$ 上工作，因此每个非零元素都存在模 $101$ 的乘法逆元。\n\n步骤 $1$：验证 $(x_{1},y_{1})$ 和 $(x_{2},y_{2})$ 位于 $E$ 上。\n\n- 对于 $(x_{1},y_{1})=(1,39)$，计算 $y_{1}^{2}$ 和 $x_{1}^{3}+2x_{1}+3$ 模 $101$：\n$$y_{1}^{2}\\equiv 39^{2}\\equiv 1521\\equiv 1521-101\\cdot 15=1521-1515=6\\pmod{101}.$$\n$$x_{1}^{3}+2x_{1}+3\\equiv 1^{3}+2\\cdot 1+3=1+2+3=6\\pmod{101}.$$\n因此 $(1,39)$ 在 $\\mathbb{F}_{101}$ 中满足 $y^{2}=x^{3}+2x+3$。\n\n- 对于 $(x_{2},y_{2})=(3,6)$：\n$$y_{2}^{2}\\equiv 6^{2}=36\\pmod{101},$$\n$$x_{2}^{3}+2x_{2}+3\\equiv 3^{3}+2\\cdot 3+3=27+6+3=36\\pmod{101}.$$\n因此 $(3,6)$ 满足曲线方程。\n\n步骤 $2$：从弦切线法则推导加法和倍点公式。\n\n基本依据：对于特征不为 $2$ 或 $3$ 的域上的短 Weierstrass 方程 $y^{2}=x^{3}+ax+b$，群律的几何定义如下。给定两个点 $P=(x_{1},y_{1})$ 和 $Q=(x_{2},y_{2})$，其中 $x_{1}\\neq x_{2}$，通过 $P$ 和 $Q$ 的唯一一条直线 $\\ell$ 的斜率为 $m$，方程为 $y=m(x-x_{1})+y_{1}$。将 $y$ 代入 $y^{2}=x^{3}+ax+b$ 会得到一个关于 $x$ 的三次方程，其根是直线 $\\ell$ 与曲线的三个交点的 $x$ 坐标。由于 $x_{1}$ 和 $x_{2}$ 是两个根，设 $x_{3}$ 是第三个根。根据韦达定理，根的和等于 $m^{2}$，因此\n$$x_{1}+x_{2}+x_{3}=m^{2},\\quad\\text{所以}\\quad x_{3}=m^{2}-x_{1}-x_{2}.$$\n曲线上的第三个交点是 $(x_{3},y_{3}^{\\prime})$，其中 $y_{3}^{\\prime}=m(x_{3}-x_{1})+y_{1}$ 位于直线上；群和通过关于 $x$ 轴反射得到，所以\n$$P+Q=(x_{3},-y_{3}^{\\prime})=(x_{3},\\,m(x_{1}-x_{3})-y_{1}).$$\n当 $P=Q$ 时，该直线是点 $P$ 处的切线，其斜率通过对 $y^{2}=x^{3}+ax+b$ 进行隐式微分得到：\n$$2y\\,\\frac{dy}{dx}=3x^{2}+a\\quad\\Rightarrow\\quad m=\\frac{3x_{1}^{2}+a}{2y_{1}}.$$\n将此 $m$ 代入相同的代数关系式，得到\n$$x_{4}=m^{2}-2x_{1},\\qquad y_{4}=m(x_{1}-x_{4})-y_{1},$$\n对于 $2P=(x_{4},y_{4})$。在 $\\mathbb{F}_{101}$ 上，只要分母非零就是可逆的。在我们的例子中，$x_{1}\\neq x_{2}$ 所以 $x_{2}-x_{1}\\neq 0$，并且 $y_{1}\\neq 0$，所以 $2y_{1}\\neq 0$；因此逆元存在。\n\n现在我们在 $\\mathbb{F}_{101}$ 中，当 $a=2$ 时进行显式计算。\n\n步骤 $3$：计算 $(x_{3},y_{3})=(x_{1},y_{1})+(x_{2},y_{2})$。\n\n- 斜率 $m$：\n$$m\\equiv \\frac{y_{2}-y_{1}}{x_{2}-x_{1}}\\equiv \\frac{6-39}{3-1}\\equiv \\frac{-33}{2}\\equiv \\frac{68}{2}\\pmod{101}.$$\n模 101 下 $2$ 的逆元是 $51$，因为 $2\\cdot 51\\equiv 102\\equiv 1\\pmod{101}$。因此\n$$m\\equiv 68\\cdot 51\\equiv 3468\\equiv 3468-101\\cdot 34=3468-3434=34\\pmod{101}.$$\n\n- $x$ 坐标：\n$$x_{3}\\equiv m^{2}-x_{1}-x_{2}\\equiv 34^{2}-1-3\\pmod{101}.$$\n由于 $34^{2}=1156\\equiv 45\\pmod{101}$，我们得到\n$$x_{3}\\equiv 45-4=41\\pmod{101}.$$\n\n- $y$ 坐标：\n$$y_{3}\\equiv m(x_{1}-x_{3})-y_{1}\\equiv 34(1-41)-39\\equiv 34\\cdot (-40)-39\\pmod{101}.$$\n计算 $1-41\\equiv -40\\equiv 61\\pmod{101}$，所以\n$$y_{3}\\equiv 34\\cdot 61-39\\equiv 2074-39\\equiv (2074-101\\cdot 20)-39\\equiv 54-39=15\\pmod{101}.$$\n因此 $(x_{3},y_{3})=(41,15)$。快速检验：$y_{3}^{2}\\equiv 15^{2}=225\\equiv 23$，而 $x_{3}^{3}+2x_{3}+3\\equiv 41^{3}+82+3$。使用 $41^{2}\\equiv 65$ 得到 $41^{3}\\equiv 41\\cdot 65=2665\\equiv 39$，所以 $39+85\\equiv 124\\equiv 23$，与 $y_{3}^{2}$ 一致。\n\n步骤 $4$：计算 $(x_{4},y_{4})=2(x_{1},y_{1})$。\n\n- 切线斜率 $m$：\n$$m\\equiv \\frac{3x_{1}^{2}+a}{2y_{1}}\\equiv \\frac{3\\cdot 1^{2}+2}{2\\cdot 39}\\equiv \\frac{5}{78}\\pmod{101}.$$\n求 78 模 101 的逆元。使用扩展欧几里得算法：\n$$101=78+23,\\quad 78=3\\cdot 23+9,\\quad 23=2\\cdot 9+5,\\quad 9=1\\cdot 5+4,\\quad 5=1\\cdot 4+1,$$\n回代得到 $-22\\cdot 78+17\\cdot 101=1$，所以 $78^{-1}\\equiv -22\\equiv 79\\pmod{101}$。因此\n$$m\\equiv 5\\cdot 79\\equiv 395\\equiv 395-101\\cdot 3=395-303=92\\pmod{101}.$$\n\n- $x$ 坐标：\n$$x_{4}\\equiv m^{2}-2x_{1}\\equiv 92^{2}-2\\cdot 1\\pmod{101}.$$\n由于 $92\\equiv -9$，$92^{2}\\equiv 81$，得到\n$$x_{4}\\equiv 81-2=79\\pmod{101}.$$\n\n- $y$ 坐标：\n$$y_{4}\\equiv m(x_{1}-x_{4})-y_{1}\\equiv 92(1-79)-39\\equiv 92\\cdot (-78)-39\\pmod{101}.$$\n由于 $-78\\equiv 23$，我们有\n$$y_{4}\\equiv 92\\cdot 23-39\\equiv 2116-39\\equiv (2116-101\\cdot 20)-39\\equiv 96-39=57\\pmod{101}.$$\n因此 $(x_{4},y_{4})=(79,57)$。快速检验：$y_{4}^{2}\\equiv 57^{2}=3249\\equiv 17$，而 $x_{4}^{3}+2x_{4}+3\\equiv 79^{3}+161\\equiv 58+60=118\\equiv 17$。\n\n步骤 $5$：计算所要求的单个整数 $s$。\n\n根据定义，$s\\equiv x_{3}+x_{4}\\pmod{101}$，其中 $s\\in\\{0,1,\\dots,100\\}$。我们有 $x_{3}=41$ 和 $x_{4}=79$，所以\n$$s\\equiv 41+79=120\\equiv 120-101=19\\pmod{101}.$$\n因此，在规范代表集中 $s=19$。\n\n关于与 Lenstra 椭圆曲线分解法 (ECM) 的相关性说明：在 ECM 中，我们在模一个合数 $N$ 的情况下执行相同的有理斜率计算。当一个分母（例如 $x_{2}-x_{1}$ 或 $2y_{1}$）在模 $N$ 下不可逆时，计算它与 $N$ 的最大公约数会得到一个非平凡因子。上面的显式计算展示了 ECM 所依赖的群律步骤，这里是在素数模 $101$ 这个安全的环境下进行的，其中所有非零分母都是可逆的。", "answer": "$$\\boxed{19}$$", "id": "3091839"}, {"introduction": "前面的练习展示了在理想环境下（即在域上）椭圆曲线运算如何完美运行。现在，我们将进入真实世界，看看当我们将运算置于一个合数模 $N$ 的环上时会发生什么。这个练习 [@problem_id:3091785] 模拟了 Lenstra 方法的关键时刻：一次看似常规的点运算尝试，却因为一个无法完成的模逆运算而“失败”。正是这次失败，通过计算最大公约数 (GCD)，将直接揭示出 $N$ 的一个非平凡因子，完美地展示了该算法从计算失败中提取信息的精髓。", "problem": "设 $N$ 是合数模 $N = 10403$，并考虑由下式定义的三次同余类\n$$\nE: \\ y^{2} \\equiv x^{3} + a x + b \\pmod{N}\n$$\n其系数为 $a = 99$ 和 $b = 454$。设 $P = (x_{0}, y_{0}) = (26, 101)$ 是在 $\\mathbb{Z}_{N}$ 上应用 Lenstra 椭圆曲线分解法（ECM）的选定起始点。您可以将以下事实作为基础：在一个环上，Weierstrass 模型的标准弦切加法法则要求对某些分母模 $N$ 求逆，并且 $\\mathbb{Z}_{N}$ 中的一个非零元素是可逆的，当且仅当它与 $N$ 互质。\n\n任务：\n1. 验证点 $P$ 满足曲线方程 $E$ 模 $N$。\n2. 从 Weierstrass 模型上的群法则以及并非所有 $\\mathbb{Z}_{N}$ 中的非零元素都可逆这一事实出发，解释为什么尝试第一次倍点运算 $2P$ 会强制计算形如 $2 y_{0} \\bmod N$ 的分母的逆，以及为什么不可逆性会揭示一个与 $N$ 的非平凡最大公约数。\n3. 对该 $E$ 和 $P$ 显式计算这个最大公约数，从而得到 $N$ 的一个非平凡素因子 $p$。作为基于奇异性定义的相容性检验，通过检查判别式因子 $4 a^{3} + 27 b^{2}$ 模 $p$ 和模 $q$ 的值，简要说明为什么曲线 $E$ 模此 $p$ 是奇异的，而模 $N$ 的互补素因子 $q$ 是非奇异的。\n\n将您得到的素数 $p$ 作为最终答案。无需四舍五入，也不涉及单位。您的答案必须是一个整数。", "solution": "我们从环 $\\mathbb{Z}_{N}$ 上的标准 Weierstrass 模型 $E: y^{2} \\equiv x^{3} + a x + b \\pmod{N}$ 开始。在 Lenstra 椭圆曲线分解法（ECM）中，我们使用通常的弦切公式来执行模 $N$ 的椭圆曲线加法和标量乘法。这些公式需要计算一个包含分子和分母的斜率 $\\lambda$；必须对分母模 $N$ 求逆才能完成加法运算。在域上，每个非零元素都是可逆的，但在合数 $N$ 构成的环 $\\mathbb{Z}_{N}$ 上，一个非零元素是可逆的，当且仅当它与 $N$ 的最大公约数为 $1$。如果所需分母与 $N$ 有一个非平凡的最大公约数，则求逆尝试会失败，而这个最大公约数就给出了 $N$ 的一个因子。\n\n步骤 1：验证点 $P$ 位于曲线 $E$ 上模 $N$。\n我们计算\n$$\nx_{0}^{3} + a x_{0} + b \\equiv 26^{3} + 99 \\cdot 26 + 454 \\pmod{10403}.\n$$\n首先，$26^{3} = 17576$，且 $99 \\cdot 26 = 2574$，所以\n$$\nx_{0}^{3} + a x_{0} + b = 17576 + 2574 + 454 = 20604.\n$$\n模 $10403$ 进行约化：\n$$\n20604 \\equiv 20604 - 10403 = 10201 \\pmod{10403}.\n$$\n此外，\n$$\ny_{0}^{2} = 101^{2} = 10201.\n$$\n因此 $y_{0}^{2} \\equiv x_{0}^{3} + a x_{0} + b \\pmod{10403}$，所以点 $P$ 满足曲线方程。\n\n步骤 2：解释分母和最大公约数的作用。\n对于点 $P = (x_{0}, y_{0})$ 且 $y_{0} \\not\\equiv 0 \\pmod{N}$，Weierstrass 模型上的切线（倍点）公式使用斜率\n$$\n\\lambda \\equiv \\frac{3 x_{0}^{2} + a}{2 y_{0}} \\pmod{N},\n$$\n并且该计算需要 $2 y_{0}$ 模 $N$ 的模逆。在 $\\mathbb{Z}_{N}$ 上，这样的逆存在当且仅当 $\\gcd(2 y_{0}, N) = 1$。如果 $\\gcd(2 y_{0}, N) = d > 1$，则求逆失败，并且计算 $\\gcd(2 y_{0}, N)$ 会立即得到 $N$ 的一个非平凡因子 $d$。这正是 ECM 如何利用模 $N$ 的一个隐藏素因子 $p$ 上的偶然奇异性：在模 $p$ 的奇异纤维上，群法则的分母在域 $\\mathbb{F}_{p}$ 中可能为零，而在 $\\mathbb{Z}_{N}$ 上，这表现为分母与 $N$ 共享一个非平凡公约数，通过最大公约数计算揭示该公约数。\n\n步骤 3：为此示例计算揭示性的最大公约数。\n对于我们的点 $P = (26, 101)$，倍点运算的分母是 $2 y_{0} = 2 \\cdot 101 = 202$。计算\n$$\n\\gcd(2 y_{0}, N) = \\gcd(202, 10403).\n$$\n我们执行欧几里得算法：\n$$\n10403 = 202 \\cdot 51 + 101, \\quad 202 = 101 \\cdot 2 + 0,\n$$\n因此 $\\gcd(202, 10403) = 101$。所以 $p = 101$ 是一个由倍点分母求逆失败所揭示的 $N$ 的非平凡素因子。\n\n通过模素因子的奇异性和非奇异性进行相容性检验。\n$y^{2} = x^{3} + a x + b$ 的判别式是 $\\Delta = -16(4 a^{3} + 27 b^{2})$。模素数 $r$ 的奇异性等价于 $4 a^{3} + 27 b^{2} \\equiv 0 \\pmod{r}$。我们验证模 $p = 101$ 和模互补素数 $q = N / p = 10403 / 101 = 103$ 的情况。\n\n计算模 $p = 101$：\n$$\na \\equiv 99 \\equiv -2 \\pmod{101}, \\quad b \\equiv 454 \\equiv 50 \\pmod{101}.\n$$\n那么\n$$\n4 a^{3} + 27 b^{2} \\equiv 4(-2)^{3} + 27 \\cdot 50^{2} \\equiv 4(-8) + 27 \\cdot 2500 \\pmod{101}.\n$$\n将每一项模 $101$ 进行约化：\n$$\n4(-8) \\equiv -32 \\equiv 69 \\pmod{101},\n$$\n以及\n$$\n50^{2} = 2500 \\equiv 2500 - 24 \\cdot 101 = 2500 - 2424 = 76 \\pmod{101}, \\quad 27 \\cdot 76 = 2052 \\equiv 2052 - 20 \\cdot 101 = 32 \\pmod{101}.\n$$\n因此\n$$\n4 a^{3} + 27 b^{2} \\equiv 69 + 32 = 101 \\equiv 0 \\pmod{101},\n$$\n所以 $E$ 模 $p$ 是奇异的。\n\n计算模 $q = 103$：\n$$\na \\equiv 99 \\pmod{103}, \\quad b \\equiv 454 \\equiv 42 \\pmod{103}.\n$$\n我们有 $a^{3} \\equiv 99^{3} \\equiv (-4)^{3} \\equiv -64 \\equiv 39 \\pmod{103}$，所以 $4 a^{3} \\equiv 4 \\cdot 39 \\equiv 156 \\equiv 53 \\pmod{103}$。此外 $b^{2} \\equiv 42^{2} = 1764 \\equiv 1764 - 17 \\cdot 103 = 13 \\pmod{103}$，因此 $27 b^{2} \\equiv 27 \\cdot 13 = 351 \\equiv 351 - 3 \\cdot 103 = 42 \\pmod{103}$。所以\n$$\n4 a^{3} + 27 b^{2} \\equiv 53 + 42 = 95 \\not\\equiv 0 \\pmod{103},\n$$\n所以 $E$ 模 $q$ 是非奇异的。\n\n这证实了我们选择的例子在模隐藏因子 $p$ 时是奇异的，并且第一步倍点运算立即触发了一次最大公约数计算，从而得到了 $p$。\n\n因此，通过早期 ECM 算术揭示的素因子是 $p = 101$。", "answer": "$$\\boxed{101}$$", "id": "3091785"}]}