{"hands_on_practices": [{"introduction": "在我们运用高斯整数解决平方和问题之前，必须先熟练掌握其基本算术。欧几里得算法是数论的基石，它可以优美地推广到高斯整数环中。[@problem_id:3090032] 这项练习提供了在 $\\mathbb{Z}[i]$ 中进行带余除法和求最大公约数 (GCD) 的必要实践。掌握这项计算技能是揭示高斯整数环更深层结构性质的第一步。", "problem": "令 $\\mathbb{Z}[i]$ 表示高斯整数环，它由所有形如 $a+bi$（其中 $a,b\\in\\mathbb{Z}$）的复数组成，其加法和乘法继承自 $\\mathbb{C}$。$\\mathbb{Z}[i]$ 上的欧几里得函数是范数 $N(a+bi)=a^{2}+b^{2}$，该范数是积性的，并满足带余除法性质：对于任意 $x,y\\in\\mathbb{Z}[i]$ 且 $y\\neq 0$，存在 $q,r\\in\\mathbb{Z}[i]$ 使得 $x=qy+r$ 且 $N(r)  N(y)$。使用欧几里得算法计算 $7+5i$ 和 $3+8i$ 的最大公约数 (gcd)。然后，将此 gcd 表示为 $z_1 = 7+5i$ 和 $z_2 = 3+8i$ 的线性组合 $Uz_1+Vz_2$。在你的最终答案中，以实部为正的相伴元表示 gcd。", "solution": "该问题被评估为有效，因为它在数学上是适定的，科学上基于已建立的高斯整数理论，并以精确、客观的语言表达。这是计算代数数论中的一个标准练习。\n\n任务是使用欧几里得算法计算两个高斯整数 $z_1 = 7+5i$ 和 $z_2 = 3+8i$ 的最大公约数 (gcd)，然后将此 gcd 表示为 $z_1$ 和 $z_2$ 的线性组合。\n\n高斯整数环 $\\mathbb{Z}[i]$ 是一个关于范数函数 $N(a+bi) = a^2+b^2$ 的欧几里得整环。欧几里得算法可以直接应用。我们记 $z_1 = 7+5i$ 和 $z_2 = 3+8i$。\n\n首先，我们比较它们的范数：\n$N(z_1) = N(7+5i) = 7^2 + 5^2 = 49 + 25 = 74$。\n$N(z_2) = N(3+8i) = 3^2 + 8^2 = 9 + 64 = 73$。\n由于 $N(z_1) > N(z_2)$，我们将用 $z_2$ 除 $z_1$。\n\n步骤 1：用 $z_2$ 除 $z_1$。\n为了在 $\\mathbb{Z}[i]$ 中找到商 $q_1$ 和余数 $r_1$，使得 $z_1 = q_1 z_2 + r_1$ 且 $N(r_1)  N(z_2)$，我们首先在 $\\mathbb{C}$ 中计算商：\n$$ \\frac{z_1}{z_2} = \\frac{7+5i}{3+8i} = \\frac{(7+5i)(3-8i)}{(3+8i)(3-8i)} = \\frac{21 - 56i + 15i - 40i^2}{3^2+8^2} = \\frac{61 - 41i}{73} = \\frac{61}{73} - \\frac{41}{73}i $$\n我们将商的实部和虚部四舍五入到最近的整数来选取 $q_1$。实部 $\\frac{61}{73} \\approx 0.835$ 四舍五入为 $1$；虚部 $-\\frac{41}{73} \\approx -0.561$ 四舍五入为 $-1$。\n所以，我们选择商 $q_1 = 1-i$。\n\n现在，我们计算余数 $r_1$：\n$$ r_1 = z_1 - q_1 z_2 = (7+5i) - (1-i)(3+8i) $$\n$$ r_1 = (7+5i) - (3+8i-3i-8i^2) = (7+5i) - (3+5i+8) = (7+5i) - (11+5i) = -4 $$\n第一个除法方程是 $7+5i = (1-i)(3+8i) - 4$。\n我们检查余数的范数：$N(r_1) = N(-4) = (-4)^2 = 16$。这满足条件 $N(r_1)  N(z_2)$，因为 $16  73$。\n\n步骤 2：用 $r_1$ 除 $z_2$。\n现在我们用余数 $r_1 = -4$ 除 $z_2 = 3+8i$。\n$$ \\frac{z_2}{r_1} = \\frac{3+8i}{-4} = -\\frac{3}{4} - 2i $$\n我们将商的实部和虚部四舍五入到最近的整数。实部 $-\\frac{3}{4} = -0.75$ 四舍五入为 $-1$；虚部为整数 $-2$。\n所以，我们选择商 $q_2 = -1-2i$。\n\n现在，我们计算新的余数 $r_2$：\n$$ r_2 = z_2 - q_2 r_1 = (3+8i) - (-1-2i)(-4) = (3+8i) - (4+8i) = -1 $$\n第二个除法方程是 $3+8i = (-1-2i)(-4) - 1$。\n我们检查余数的范数：$N(r_2) = N(-1) = (-1)^2 = 1$。这满足 $N(r_2)  N(r_1)$，因为 $1  16$。\n\n步骤 3：用 $r_2$ 除 $r_1$。\n现在我们用 $r_2 = -1$ 除 $r_1 = -4$。\n$$ \\frac{r_1}{r_2} = \\frac{-4}{-1} = 4 $$\n商恰好是 $q_3 = 4$，余数是 $r_3 = 0$。\n第三个除法方程是 $-4 = (4)(-1) + 0$。\n\n算法因余数为 $0$ 而终止。最大公约数是最后一个非零余数，即 $r_2 = -1$。gcd 在 $\\mathbb{Z}[i]$ 中在一个单位乘法下是唯一的。单位是 $\\{1, -1, i, -i\\}$。$-1$ 的相伴元是 $\\{-1, 1, -i, i\\}$。问题指定 gcd 应由实部为正的相伴元表示。在这些相伴元中，只有 $1$ 的实部为正。\n因此，$\\text{gcd}(7+5i, 3+8i) = 1$。\n\n接下来，我们使用扩展欧几里得算法（包括回代）将 gcd 表示为线性组合 $1 = U(7+5i) + V(3+8i)$。\n从步骤 2 中，我们有最后一个非零余数 $-1$ 的表达式：\n$$ -1 = (3+8i) - (-1-2i)(-4) $$\n从步骤 1 中，我们可以用原始数字表示前一个余数 $-4$：\n$$ -4 = (7+5i) - (1-i)(3+8i) $$\n将 $-4$ 的这个表达式代入 $-1$ 的方程中：\n$$ -1 = (3+8i) - (-1-2i)\\left[ (7+5i) - (1-i)(3+8i) \\right] $$\n现在，我们分配并收集涉及 $(7+5i)$ 和 $(3+8i)$ 的项：\n$$ -1 = (3+8i) - (-1-2i)(7+5i) + (-1-2i)(1-i)(3+8i) $$\n让我们对每个原始数的系数进行分组：\n$(7+5i)$ 的系数是 $-(-1-2i) = 1+2i$。\n$(3+8i)$ 的系数是 $1 + (-1-2i)(1-i)$。\n我们计算乘积：\n$$ (-1-2i)(1-i) = -1(1-i) - 2i(1-i) = -1+i-2i+2i^2 = -1-i-2 = -3-i $$\n所以，$(3+8i)$ 的系数是 $1 + (-3-i) = -2-i$。\n这给出了 $-1$ 的线性组合：\n$$ -1 = (1+2i)(7+5i) + (-2-i)(3+8i) $$\n为了找到 gcd $1$ 的线性组合，我们将整个方程乘以 $-1$：\n$$ 1 = -(1+2i)(7+5i) - (-2-i)(3+8i) $$\n$$ 1 = (-1-2i)(7+5i) + (2+i)(3+8i) $$\n这就是所要求的表达式。我们有 $U = -1-2i$ 和 $V = 2+i$，它们都在 $\\mathbb{Z}[i]$ 中。\n最终的 gcd 是 $1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "3090032"}, {"introduction": "当我们用高斯整数来分解普通整数时，其真正的威力就得以显现。一个素数 $p$ 能被写成两个平方数之和，当且仅当它在 $\\mathbb{Z}[i]$ 中不再是素数。[@problem_id:3090039] 这个练习将引导你完成一个具体的例子，通过欧几里得算法找出有理素数 $p \\equiv 1 \\pmod{4}$ 的高斯整数因子。这个过程会直接揭示那两个平方和为 $p$ 的数，从而将抽象的因子分解与具体的数值结果联系起来。", "problem": "在高斯整数环 $\\mathbb{Z}[i]=\\{a+bi: a,b\\in\\mathbb{Z}\\}$ 中进行运算，该环赋有范数 $N(a+bi)=a^{2}+b^{2}$ 和复共轭 $\\overline{a+bi}=a-bi$。环 $\\mathbb{Z}[i]$ 是一个关于范数 $N(\\,\\cdot\\,)$ 的欧几里得整环，因此欧几里得算法和带余除法适用。$\\mathbb{Z}[i]$ 中的单位元是 $\\{\\pm 1,\\pm i\\}$。\n\n仅使用关于 $\\mathbb{Z}[i]$ 的这些基本事实以及在 $\\mathbb{Z}/41\\mathbb{Z}$ 中的同余，完成以下步骤：\n\n- 找到一个整数 $x$，满足 $0  x  p$ 且 $x^2 \\equiv -1 \\pmod{41}$。\n- 在 $\\mathbb{Z}[i]$ 中，使用欧几里得算法计算 $z = \\text{gcd}(41, x+i)$。\n- 从 $z$ 中提取两个正整数 $a$ 和 $b$ 使得 $41=a^2+b^2$。\n\n你的最终答案必须是一个 $1\\times 2$ 的矩阵，其元素为满足 $a\\ge b$ 的对 $(a,b)$。", "solution": "题目要求我们通过一个涉及高斯整数环 $\\mathbb{Z}[i]$ 的特定过程，找到两个正整数 $a$ 和 $b$ 满足 $a \\geq b$ 且 $41 = a^2+b^2$。该过程被分解为几个不同的步骤，我们将严格遵循这些步骤。\n\n其基本原理是，一个奇素数 $p$ 可以被写成两个平方数之和，当且仅当 $p \\equiv 1 \\pmod{4}$。如果这个条件成立，$p$ 在环 $\\mathbb{Z}[i]$ 中不再是素元，而是分解为 $p = \\pi \\bar{\\pi}$，其中 $\\pi = a+bi$ 是某个高斯素数。对该方程取范数得到 $N(p) = N(\\pi)N(\\bar{\\pi})$。因为 $p$ 是一个实整数，所以 $N(p) = p^2$。$\\pi=a+bi$ 的范数是 $N(\\pi) = a^2+b^2$ 并且 $N(\\bar{\\pi}) = a^2+(-b)^2 = a^2+b^2$。因此，$p^2 = (a^2+b^2)^2$，这意味着 $p=a^2+b^2$。题目引导我们找到这样一个因子 $\\pi$。\n\n首先，我们检查素数 $p=41$ 的条件。我们有 $41 = 4 \\times 10 + 1$，所以 $41 \\equiv 1 \\pmod{4}$。因此，41 可以表示为两个平方数之和。\n\n步骤 1：找到一个整数 $x$，满足 $0  x  41$ 且 $x^2 \\equiv -1 \\pmod{41}$。\n我们需要在模 $41$ 下找到 $-1$ 的平方根。我们可以通过试错法找到它。\n$1^2=1$, $2^2=4$, $3^2=9$, $4^2=16$, $5^2=25$, $6^2=36 \\equiv -5$, $7^2=49 \\equiv 8$, $8^2=64 \\equiv 23$, $9^2=81 = 2 \\times 41 - 1 \\equiv -1 \\pmod{41}$。\n所以，一个解是 $x=9$。\n\n步骤 2：在 $\\mathbb{Z}[i]$ 中计算 $\\text{gcd}(41, 9+i)$。\n我们应用欧几里得算法。\n$$ \\frac{41}{9+i} = \\frac{41(9-i)}{(9+i)(9-i)} = \\frac{41(9-i)}{81+1} = \\frac{41(9-i)}{82} = \\frac{9-i}{2} = 4.5 - 0.5i $$\n我们将其实部和虚部分别四舍五入到最近的整数，得到 $q_1=4-i$。（其他选择如 $4$, $5$, $5-i$ 也是有效的。）\n现在计算余数 $r_1$：\n$$ r_1 = 41 - q_1(9+i) = 41 - (4-i)(9+i) = 41 - (36+4i-9i-i^2) = 41 - (36-5i+1) = 41 - (37-5i) = 4+5i $$\n我们检查余数的范数：$N(r_1) = N(4+5i) = 4^2+5^2 = 16+25=41$。\n由于 $N(r_1) = 41  N(41)=41^2$，这是一个有效的余数。\n算法的下一步是用 $r_1$ 去除 $9+i$。然而，由于 $N(r_1)=41$，我们知道 $41$ 是一个有理素数，这意味着 $r_1$ 是 $\\mathbb{Z}[i]$ 中的一个高斯素数。由于 $r_1$ 整除 $41$（因为 $41 = (9-i)r_1$），并且 $r_1$ 是一个素数，所以 $r_1$ 必定是 $41$ 和 $9+i$ 的一个最大公约数。\n因此，$\\text{gcd}(41, 9+i) = 4+5i$（在一个单位下唯一）。\n\n步骤 3：从 $z=4+5i$ 中提取 $a$ 和 $b$。\n我们已经找到了 $\\text{gcd}(41, 9+i) = 4+5i$。这个高斯整数的范数是 $N(4+5i) = 4^2+5^2=41$。\n这直接给出了 $41$ 的一个两平方和表示：$41=4^2+5^2$。\n我们被要求找到正整数 $a,b$ 满足 $a \\ge b$。从我们的结果中，整数是 $4$ 和 $5$。为了满足 $a \\ge b$ 的条件，我们取 $a=5$ 和 $b=4$。\n\n最终的答案对是 $(5,4)$。", "answer": "$$\n\\boxed{\\begin{pmatrix}\n5  4\n\\end{pmatrix}}\n$$", "id": "3090039"}, {"introduction": "平方和与高斯整数因子分解之间的联系并不仅限于素数。对于一个合数，它能被写成两个平方数之和的方式数量，取决于它在 $\\mathbb{Z}[i]$ 中的素因子分解。[@problem_id:3090046] 这个问题挑战你应用该理论，找出一个合数所有可能的平方和表示法。通过系统地组合其高斯素因子，你将看到 $\\mathbb{Z}[i]$ 中的唯一因子分解性质如何决定解的存在性和多样性，从而为问题提供一个完整而优美的答案。", "problem": "设 $\\mathbb{Z}[i]$ 表示高斯整数环，设 $N:\\mathbb{Z}[i]\\to\\mathbb{Z}_{\\ge 0}$ 是由 $N(a+bi)=a^{2}+b^{2}$ 定义的范数。仅依据以下基本事实：$\\mathbb{Z}[i]$ 是一个欧几里得整环（因此是唯一分解整环），其单位群为 $\\{\\pm 1,\\pm i\\}$，范数 $N$ 是积性的，以及一个有理素数 $p$ 在 $\\mathbb{Z}[i]$ 中是可约的当且仅当 $p=2$ 或 $p\\equiv 1\\pmod{4}$，判断 $130$ 是否能表示为两个整数的平方和。如果可以，找出在两个加数的置换和符号改变所生成的等价关系下的所有表示；也就是说，列出所有满足 $a\\ge b$ 的不同非负整数对 $(a,b)$，使得 $a^{2}+b^{2}=130$。你的最终答案必须是一个单行矩阵，其元素为按 $(a_{1},b_{1},a_{2},b_{2},\\dots)$ 形式拼接的规范对，其中每个 $(a_{j},b_{j})$ 是一个满足 $a_{j}\\ge b_{j}\\ge 0$ 的不同等价类代表。无需四舍五入。最终答案中不要包含任何文本解释。", "solution": "问题要求判断整数 $130$ 是否能表示为两个整数的平方和，如果可以，找出所有唯一的表示。一个整数 $n$ 可以写成两个整数的平方和 $n = a^2 + b^2$（其中 $a, b \\in \\mathbb{Z}$），当且仅当存在一个范数为 $n$ 的高斯整数 $\\alpha = a+bi \\in \\mathbb{Z}[i]$。范数定义为 $N(\\alpha) = N(a+bi) = a^2+b^2$。因此，该问题等价于找到所有满足 $N(\\alpha)=130$ 的高斯整数 $\\alpha$，并从中推导出满足 $a \\ge b$ 的唯一非负整数对 $(a,b)$。\n\n首先，我们必须确定是否存在这样的表示。题目给出了一个关键事实：一个有理素数 $p$ 在 $\\mathbb{Z}[i]$ 中是可约的，当且仅当 $p=2$ 或 $p \\equiv 1 \\pmod{4}$。数论中的一个基石定理（可由这些性质推导出）指出，一个正整数 $n$ 能写成两个平方数之和，当且仅当 $n$ 在 $\\mathbb{Z}$ 中的素因数分解不包含任何形如 $4k+3$ 的素数的奇次幂。\n\n让我们在整数环 $\\mathbb{Z}$ 中对 $130$ 进行素因数分解：\n$$130 = 10 \\times 13 = 2 \\times 5 \\times 13$$\n素因数是 $2$、$5$ 和 $13$。\n- 素数 $2$ 是给定规则中提到的特殊情况。\n- 素数 $5$ 满足 $5 \\equiv 1 \\pmod{4}$。\n- 素数 $13$ 满足 $13 \\equiv 1 \\pmod{4}$。\n$130$ 的素因数分解不包含任何形如 $4k+3$ 的素因数。因此，$130$ 可以表示为两个平方数之和。\n\n为了找到所有这样的表示，我们利用 $\\mathbb{Z}[i]$ 是唯一分解整环（UFD）这一事实。我们需在 $\\mathbb{Z}[i]$ 中找到 $130$ 的素因数分解。这涉及到将其有理素因数（$2$、$5$、$13$）分解为高斯素数。\n\n1.  分解 $2$：$2 = 1^2 + 1^2 = (1+i)(1-i)$。在 $\\mathbb{Z}[i]$ 中，素数 $1+i$ 和 $1-i$ 是相伴的，因为 $1-i = (-i)(1+i)$。其范数为 $N(1+i) = 1^2+1^2=2$。\n2.  分解 $5$：由于 $5 \\equiv 1 \\pmod{4}$，它是可约的。通过检验我们发现 $5 = 2^2+1^2$。这给出了分解 $5 = (2+i)(2-i)$。因子 $2+i$ 和 $2-i$ 是高斯素数，因为它们的范数是 $5$，一个有理素数。它们不是相伴的，因为 $\\frac{2+i}{2-i} = \\frac{(2+i)^2}{5} = \\frac{3+4i}{5}$，它在 $\\mathbb{Z}[i]$ 中不是一个单位。\n3.  分解 $13$：由于 $13 \\equiv 1 \\pmod{4}$，它是可约的。通过检验我们发现 $13=3^2+2^2$。这给出了分解 $13 = (3+2i)(3-2i)$。因子 $3+2i$ 和 $3-2i$ 是高斯素数，因为它们的范数是 $13$，一个有理素数。它们不是相伴的。\n\n综合这些，$130$ 在 $\\mathbb{Z}[i]$ 中的素因数分解是：\n$$130 = (1+i)(1-i)(2+i)(2-i)(3+2i)(3-2i)$$\n我们正在寻找 $\\alpha = a+bi$ 使得 $N(\\alpha) = \\alpha \\bar{\\alpha} = 130$。根据唯一分解性质，$\\alpha$ 的素因数必须从 $130$ 的素因数集合中选择。具体来说，对于每个在 $\\mathbb{Z}[i]$ 中分裂为 $p = \\pi \\bar{\\pi}$ 的有理素数 $p$，任何范数包含因子 $p$ 的 $\\alpha$ 都必须有因子 $\\pi$ 或 $\\bar{\\pi}$（或它们的相伴元）。\n所以，$\\alpha$ 必须具有以下形式：\n$$\\alpha = u \\cdot \\gamma_1 \\cdot \\gamma_2 \\cdot \\gamma_3$$\n其中 $u$ 是 $\\{\\pm 1, \\pm i\\}$ 中的一个单位，并且：\n- $\\gamma_1$ 是 $2$ 的一个素因数，例如 $\\gamma_1=1+i$。\n- $\\gamma_2$ 是 $5$ 的一个素因数，即 $\\gamma_2 \\in \\{2+i, 2-i\\}$。\n- $\\gamma_3$ 是 $13$ 的一个素因数，即 $\\gamma_3 \\in \\{3+2i, 3-2i\\}$。\n\n为了找到不同的非负数对 $(a,b)$，我们可以通过从每个共轭对中选取一个因子来计算 $\\alpha$ 的可能值。单位 $u$ 的选择和 $\\alpha$ 的整体共轭只影响 $a$ 和 $b$ 的符号和顺序。因此，我们可以固定 $\\gamma_1 = 1+i$（因为 $1-i$ 是其相伴元）并测试 $\\gamma_2$ 和 $\\gamma_3$ 的组合。共有 $2 \\times 1 = 2$ 种本质不同的组合（因为 $\\alpha$ 和 $\\bar{\\alpha}$ 会给出相同的平方和）。\n\n情况1：$\\alpha_1 = (1+i)(2+i)(3+2i)$\n首先，$(1+i)(2+i) = 2+i+2i+i^2 = 1+3i$。\n然后，$\\alpha_1 = (1+3i)(3+2i) = 3+2i+9i+6i^2 = 3+11i-6 = -3+11i$。\n范数为 $N(\\alpha_1) = (-3)^2 + 11^2 = 9+121 = 130$。这个表示对应于和 $3^2+11^2=130$。满足 $a \\ge b \\ge 0$ 的规范对是 $(11,3)$。\n\n情况2：$\\alpha_2 = (1+i)(2+i)(3-2i)$\n使用上面的 $(1+i)(2+i)=1+3i$，\n$\\alpha_2 = (1+3i)(3-2i) = 3-2i+9i-6i^2 = 3+7i+6 = 9+7i$。\n范数为 $N(\\alpha_2) = 9^2+7^2 = 81+49 = 130$。这个表示对应于和 $9^2+7^2=130$。规范对是 $(9,7)$。\n\n其他组合，例如 $(1+i)(2-i)(3+2i) = (3+i)(3+2i) = 7+9i$，会给出相同的规范对 $(9,7)$。同样，$(1+i)(2-i)(3-2i)=(3+i)(3-2i)=11-3i$ 会给出相同的规范对 $(11,3)$。\n因子的其他可能选择（例如，从 $1-i$ 而不是 $1+i$ 开始）将产生与上面计算出的高斯整数共轭或相伴的高斯整数，从而得到相同的平方和对。\n例如，$(1-i)(2-i)(3-2i) = \\overline{(1+i)(2+i)(3+2i)} = \\overline{-3+11i} = -3-11i$，它仍然给出和 $(-3)^2+(-11)^2=130$。\n\n因此，满足 $a \\ge b \\ge 0$ 且 $a^2+b^2=130$ 的不同非负整数对 $(a,b)$ 是 $(11,3)$ 和 $(9,7)$。\n问题要求将这些对拼接成一个单行矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n11  3  9  7\n\\end{pmatrix}\n}\n$$", "id": "3090046"}]}