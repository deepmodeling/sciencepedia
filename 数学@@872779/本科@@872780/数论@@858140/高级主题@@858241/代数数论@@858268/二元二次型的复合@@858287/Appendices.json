{"hands_on_practices": [{"introduction": "我们从一个最基础的例子开始，探讨判别式为 $D=-4$ 的情形。这个练习将引导你通过“简化”过程，发现此时只存在一个二次型等价类，并验证其在复合运算下的封闭性。这有助于你直观地理解为何主类（principal class）在类群中扮演着单位元的角色。[@problem_id:3015035]", "problem": "令 $Q(x,y) = ax^2 + bxy + cy^2$ 为一个整系数二元二次型，其判别式为 $D = b^2 - 4ac$。并假设 $Q$ 是本原的，即 $\\gcd(a,b,c) = 1$，且是正定的，即 $D  0$ 且 $a > 0$。如果存在一个矩阵 $\\gamma \\in \\mathrm{SL}_{2}(\\mathbb{Z})$ 使得 $Q' = Q \\circ \\gamma$，则两个型 $Q$ 和 $Q'$ 是真等价的，其中 $Q \\circ \\gamma$ 表示由 $\\gamma$ 导出的变量替换。对于固定的判别式 $D$，所有本原正定型的真等价类在高斯复合下构成一个有限阿贝尔群。一个简化型是其等价类中的一个代表元 $Q$，满足简化不等式 $|b| \\leq a \\leq c$，以及一个决胜条件，即若 $|b| = a$ 或 $a = c$，则 $b \\geq 0$。\n\n在判别式 $D = -4$ 的情况下，仅根据上述定义和事实，完成以下任务：\n\n1. 确定判别式为 $D = -4$ 的所有本原正定简化二元二次型的完整列表，并推导出类数 $h(-4)$。\n\n2. 使用高斯复合（根据二元二次型复合律的基本定义构建），计算判别式为 $-4$ 的主简化型与其自身的显式复合，以得到判别式为 $-4$ 的复合型，其系数为三元组 $(a'', b'', c'')$。通过求解必要的同余方程和整性约束来执行复合，以确保所得系数定义了一个判别式为 $-4$ 的本原型。\n\n将你的最终答案表示为一个单行矩阵，其中首先包含类数 $h(-4)$，然后按顺序包含复合型的系数 $(a'', b'', c'')$。无需四舍五入。", "solution": "该问题分为两部分。首先，我们必须确定判别式为 $D = -4$ 的所有本原正定简化二元二次型的完整列表，从而求出类数 $h(-4)$。其次，我们必须计算主简化型与自身的高斯复合。\n\n第一部分：简化型的确定与类数 $h(-4)$\n\n一个二元二次型 $Q(x,y) = ax^2 + bxy + cy^2$ 由其整系数 $(a, b, c)$ 指定。判别式为 $D = b^2 - 4ac$。我们已知 $D = -4$。该型必须是本原的，即 $\\gcd(a, b, c) = 1$，并且是正定的，即 $D  0$ 且 $a > 0$。\n\n如果一个型满足不等式 $|b| \\leq a \\leq c$，以及附加条件，即如果 $|b| = a$ 或 $a = c$，则 $b \\geq 0$，那么这个型是简化的。\n\n让我们找出所有满足 $D=-4$ 这些条件的整数三元组 $(a, b, c)$。\n判别式方程为 $b^2 - 4ac = -4$，可以改写为 $4ac = b^2 + 4$。\n由于 $a$ 和 $c$ 是整数，$b^2+4$ 必须能被 $4$ 整除。这意味着 $b^2$ 必须能被 $4$ 整除，这又意味着 $b$ 必须是一个偶数。设 $b = 2k$，其中 $k$ 为某个整数。\n\n我们使用简化不等式来约束 $a$、$b$ 和 $c$ 的可能取值。\n由正定条件可知，$a > 0$。\n简化条件为 $|b| \\leq a$ 和 $a \\leq c$。\n由于 $a \\leq c$，我们有 $4a^2 \\leq 4ac$。代入 $4ac = b^2 + 4$，得到 $4a^2 \\leq b^2 + 4$。\n由 $|b| \\leq a$ 可得 $b^2 \\leq a^2$。\n结合这些不等式，我们有：\n$4a^2 \\leq b^2 + 4 \\leq a^2 + 4$\n这导出 $3a^2 \\leq 4$。\n\n由于 $a$ 必须是正整数，所以 $a^2$ 也必须是正整数。不等式 $a^2 \\leq \\frac{4}{3}$ 对 $a^2$ 只有一个正整数解，即 $a^2 = 1$。这意味着 $a = 1$。\n\n既然我们已确定 $a=1$，我们使用条件 $|b| \\leq a$ 来求 $b$。\n$|b| \\leq 1$。\n如前所述，$b$ 必须是偶数。满足 $|b| \\leq 1$ 的唯一偶数是 $b = 0$。\n\n最后，我们使用判别式方程求出 $c$ 的值：\n$b^2 - 4ac = -4$\n$0^2 - 4(1)c = -4$\n$-4c = -4$\n$c = 1$。\n\n这给了我们一个唯一的简化型候选：系数三元组 $(a,b,c) = (1, 0, 1)$。我们必须验证这个型满足所有要求的条件。\n1. 型：$Q(x,y) = 1x^2 + 0xy + 1y^2 = x^2 + y^2$。\n2. 判别式：$D = 0^2 - 4(1)(1) = -4$。正确。\n3. 正定：$D  0$ 且 $a = 1 > 0$。正确。\n4. 本原：$\\gcd(a, b, c) = \\gcd(1, 0, 1) = 1$。正确。\n5. 简化：\n   - $|b| \\leq a \\implies |0| \\leq 1$，成立。\n   - $a \\leq c \\implies 1 \\leq 1$，成立。\n   - 决胜条件：由于 $a=c=1$，我们必须有 $b \\geq 0$。我们的值 $b=0$ 满足此条件。\n因此，型 $(1, 0, 1)$ 确实是判别式为 $D=-4$ 的一个本原正定简化型。由于这是我们找到的唯一一个这样的型，所以此类型的完整列表仅包含这一个型。\n\n类数，记为 $h(D)$，是判别式为 $D$ 的本原正定型的不同真等价类的数量。这等于简化型的数量。\n由于只有一个简化型，所以类数为 $h(-4) = 1$。\n\n第二部分：高斯复合\n\n我们被要求将判别式为 $D=-4$ 的主简化型与自身进行复合。主型是代表类群单位元的型。对于正定型，这是 $a=1$ 的型。在我们的例子中，唯一的简化型是 $(1, 0, 1)$，因此它必然是主型。\n\n令 $Q_1(x_1, y_1) = x_1^2 + y_1^2$ 和 $Q_2(x_2, y_2) = x_2^2 + y_2^2$。系数分别为 $(a_1, b_1, c_1) = (1, 0, 1)$ 和 $(a_2, b_2, c_2) = (1, 0, 1)$。我们想要求出复合型 $Q'' = Q_1 \\circ Q_2$ 的系数 $(a'', b'', c'')$。\n\n高斯复合理论提供了一种构造复合型的方法。首先，我们计算 $g = \\gcd(a_1, a_2, \\frac{b_1+b_2}{2})$。\n代入我们的值，$g = \\gcd(1, 1, \\frac{0+0}{2}) = \\gcd(1, 1, 0) = 1$。\n\n复合型的第一个系数 $a''$ 由 $a'' = \\frac{a_1 a_2}{g^2}$ 给出。\n$a'' = \\frac{1 \\cdot 1}{1^2} = 1$。\n\n第二个系数 $b''$ 是一个整数 $B$，它是以下同余方程组的联立解：\n1. $B \\equiv b_1 \\pmod{2a_1/g}$\n2. $B \\equiv b_2 \\pmod{2a_2/g}$\n3. $B^2 \\equiv D \\pmod{4a_1 a_2 / g^2}$\n\n代入给定值 ($a_1=1, b_1=0, a_2=1, b_2=0, D=-4, g=1$)：\n1. $B \\equiv 0 \\pmod{2(1)/1} \\implies B \\equiv 0 \\pmod 2$.\n2. $B \\equiv 0 \\pmod{2(1)/1} \\implies B \\equiv 0 \\pmod 2$.\n3. $B^2 \\equiv -4 \\pmod{4(1)(1)/1^2} \\implies B^2 \\equiv 0 \\pmod 4$.\n\n由第一个同余式，$B$ 必须是偶数。设 $B = 2k$，其中 $k \\in \\mathbb{Z}$ 是某个整数。\n将此代入第三个同余式：$(2k)^2 = 4k^2$。这个数总能被 $4$ 整除，所以对任何整数 $k$ 都有 $4k^2 \\equiv 0 \\pmod 4$。\n因此，任何偶数 $B$ 都是该同余方程组的有效解。$B$ 的具体选择会影响到所生成的等价类中的具体型。我们可以选择最简单的解，$B = 0$。\n所以，我们取 $b'' = 0$。\n\n第三个系数 $c''$ 由复合型也必须具有判别式 $D = -4$ 这一要求确定：\n$b''^2 - 4a''c'' = D$\n$0^2 - 4(1)c'' = -4$\n$-4c'' = -4$\n$c'' = 1$。\n\n得到的复合型由系数 $(a'', b'', c'') = (1, 0, 1)$ 给出。\n我们必须检查这个型是本原的：$\\gcd(a'', b'', c'') = \\gcd(1, 0, 1) = 1$。确实是本原的。\n\n因此，主型 $(1, 0, 1)$ 与自身的复合得到型 $(1, 0, 1)$。这个结果是预料之中的，因为类群 $Cl(-4)$ 的阶为 $h(-4)=1$。唯一的元素是单位类，它必须是其自身的逆元，它与自身的复合必然再次得到单位元。\n\n最终答案要求给出类数 $h(-4)$ 和复合型的系数 $(a'', b'', c'')$。\n$h(-4) = 1$\n$(a'', b'', c'') = (1, 0, 1)$", "answer": "$$\\boxed{\\begin{pmatrix} 1  1  0  1 \\end{pmatrix}}$$", "id": "3015035"}, {"introduction": "掌握了单位元的情形后，我们来研究一个更有趣的例子：判别式为 $D=-20$ 的二次型。这个练习将带你完整地体验一次构建并理解一个非平凡类群的全过程，从找出所有等价类（简化型）到通过高斯复合揭示它们之间的群结构。通过计算非主类的自复合，你将亲眼见证它如何生成单位元，从而确定类数和群的阶。[@problem_id:3083509]", "problem": "设一个二元二次型被定义为一个函数 $f(x,y)=ax^2+bxy+cy^2$，其中系数 $a$、$b$ 和 $c$ 为整数。其判别式为 $D=b^2-4ac$。如果 $\\gcd(a,b,c)=1$，则该二次型称为本原的；如果 $D0$ 且 $a>0$，则称为正定的。一个正定二次型被称为简化的，如果它满足简化不等式 $|b|\\leq a\\leq c$，并且当 $|b|=a$ 或 $a=c$ 时，额外满足 $b\\geq 0$。如果两个二次型可以通过一个行列式为1的 $2\\times 2$ 整数矩阵（即特殊线性群中的矩阵）作变量替换而相互转化，则称它们为真等价的。\n\n仅从这些定义出发，对判别式 $D=-20$ 执行以下操作：\n1. 直接根据简化不等式和定义条件 $b^2-4ac=-20$，枚举出所有判别式为 $D=-20$ 的简化正定二次型。对于每个候选二次型，通过检查 $\\gcd(a,b,c)=1$ 来验证其是否是本原的。\n2. 使用固定判别式等价类上的经典高斯（Gauss）二元二次型复合方法，将非主简化型与自身复合。在此复合中，通过以下方法确定乘积形式 $(A,B,C)$：首先计算 $g=\\gcd(a,a',(b+b')/2)$，然后令 $A=\\frac{aa'}{g^2}$，接着选择 $B$ 以满足同余式 $B\\equiv b \\pmod{2a}$ 和 $B\\equiv b' \\pmod{2a'}$，并与 $B$ 在模 $2A$ 下的定义方式保持一致，最后通过判别式条件 $B^2-4AC=D$ 确定 $C$。\n3. 根据你的复合结果，推导出非主类的阶，并确定类数 $h(-20)$，其定义为判别式为 $-20$ 的本原正定二元二次型的真等价类的数量。\n\n将你的最终答案表示为等于 $h(-20)$ 的单个整数。", "solution": "该问题要求对判别式为 $D=-20$ 的二元二次型进行三部分分析，最终确定类数 $h(-20)$。我们将验证问题的有效性，然后进行求解。\n\n### 问题验证\n**第1步：提取已知条件**\n- 二元二次型：$f(x,y)=ax^2+bxy+cy^2$，其中系数 $a$、$b$、$c$ 为整数。\n- 判别式：$D=b^2-4ac$。\n- 本原形式：$\\gcd(a,b,c)=1$。\n- 正定形式：$D0$ 且 $a>0$。\n- 简化形式：$|b|\\leq a\\leq c$，且当 $|b|=a$ 或 $a=c$ 时，$b\\geq 0$。\n- 真等价：通过 $SL_2(\\mathbb{Z})$ 中的矩阵进行变换。\n- 问题的特定判别式：$D=-20$。\n- 任务1：枚举所有判别式为 $D=-20$ 的简化正定本原形式。\n- 任务2：使用指定的高斯复合方法将非主形式与自身复合。该方法描述为：$g=\\gcd(a,a',(b+b')/2)$，$A=\\frac{aa'}{g^2}$，$B$ 通过同余式 $B\\equiv b \\pmod{2a}$ 和 $B\\equiv b' \\pmod{2a'}$ 找到，而 $C$ 通过 $B^2 - 4AC = D$ 找到。\n- 任务3：推断非主类的阶并确定类数 $h(-20)$。\n- 最终答案：$h(-20)$ 的整数值。\n\n**第2步：使用提取的已知条件进行验证**\n该问题在科学上植根于经典数论，特别是高斯（Gauss）建立的二元二次型理论。所有定义，包括本原、正定和简化形式的定义，都是标准且正确的。该问题是适定 (well-posed) 的，因为正定形式的简化过程保证了每个等价类都有一个唯一的简化代表。任务是客观且可形式化的，需要基于所提供的定义和算法进行直接计算。不存在会妨碍唯一解的矛盾、信息缺失或歧义。所描述的复合算法，虽然是一个更通用方法的具体实例，但在计算上对于当前任务是明确定义的。该问题没有违反任何无效性标准。\n\n**第3步：结论与行动**\n问题有效。我们继续进行求解。\n\n### 解题过程\n\n**第1部分：枚举简化形式**\n我们旨在找到所有满足判别式为 $D=-20$ 的简化、本原、正定二次型给定条件的整数三元组 $(a,b,c)$。\n条件如下：\n1. $b^2 - 4ac = -20$，这意味着 $4ac = b^2 + 20$。\n2. $a > 0$。\n3. $|b| \\leq a \\leq c$。\n4. 如果 $|b|=a$ 或 $a=c$，则 $b \\geq 0$。\n5. $\\gcd(a,b,c)=1$。\n\n从条件3，我们有 $|b| \\leq a$ 和 $a \\leq c$。\n将 $a \\leq c$ 代入判别式方程得到 $4a^2 \\leq 4ac = b^2 + 20$。\n此外， $|b| \\leq a$ 意味着 $b^2 \\leq a^2$。\n结合这些不等式，我们得到 $4a^2 \\leq b^2 + 20 \\leq a^2 + 20$。\n这导出了不等式 $3a^2 \\leq 20$，即 $a^2 \\leq \\frac{20}{3} \\approx 6.67$。\n因为 $a$ 必须是正整数，所以 $a$ 的唯一可能值是 $1$ 和 $2$。\n\n情况1：$a=1$。\n简化条件 $|b| \\leq a$ 意味着 $|b| \\leq 1$，所以 $b \\in \\{-1, 0, 1\\}$。\n- 如果 $b=0$：方程 $4ac = b^2 + 20$ 变为 $4(1)c = 0^2 + 20$，所以 $4c=20$，得到 $c=5$。我们得到形式 $(1, 0, 5)$。\n  - 检查简化性：$|b|=0 \\leq a=1 \\leq c=5$。条件 $a \\leq c$ 满足。$|b|=a$ 或 $a=c$ 的特殊条件不适用。该形式是简化的。\n  - 检查本原性：$\\gcd(1, 0, 5) = 1$。该形式是本原的。\n  - 因此，$x^2+5y^2$ 是一个有效的形式。这是主形式。\n\n- 如果 $b=1$：方程为 $4(1)c = 1^2 + 20$，所以 $4c=21$。这不会得到整数的 $c$ 值，所以不存在这样的形式。\n- 如果 $b=-1$：简化条件 $|b|=1 \\leq a=1$ 满足。然而，由于 $|b|=a$，我们必须有 $b \\geq 0$。因为 $b=-1  0$，所以这个形式不是简化的。\n\n情况2：$a=2$。\n简化条件 $|b| \\leq a$ 意味着 $|b| \\leq 2$，所以 $b \\in \\{-2, -1, 0, 1, 2\\}$。\n判别式方程为 $4(2)c = b^2+20$，即 $8c = b^2+20$。为了使 $c$ 为整数，$b^2+20$ 必须能被 $8$ 整除。\n- 如果 $b=0$，$8c=20$，无整数解 $c$。\n- 如果 $b=\\pm 1$，$8c=21$，无整数解 $c$。\n- 如果 $b=\\pm 2$，$8c = (\\pm 2)^2+20 = 24$，得到 $c=3$。\n  - 考虑由 $b=2$ 得到的可能形式 $(2, 2, 3)$：\n    - 检查简化性：$|b|=2 \\leq a=2 \\leq c=3$。条件 $|b|\\leq a \\leq c$ 成立。由于 $|b|=a=2$，我们必须检查 $b \\geq 0$。因为 $b=2 \\geq 0$，所以该形式是简化的。\n    - 检查本原性：$\\gcd(2, 2, 3) = 1$。该形式是本原的。\n    - 因此，$2x^2+2xy+3y^2$ 是一个有效的形式。\n  - 考虑由 $b=-2$ 得到的可能形式 $(2, -2, 3)$：\n    - 检查简化性：$|b|=2 \\leq a=2 \\leq c=3$ 成立。然而，由于 $|b|=a=2$，我们必须有 $b\\geq 0$。因为 $b=-2  0$，所以这个形式不是简化的。\n\n综上所述，判别式为 $D=-20$ 的简化、本原、正定二次型恰好有两个：\n1. $(1, 0, 5)$\n2. $(2, 2, 3)$\n\n**第2部分：高斯复合**\n主形式是 $(1, 0, 5)$，代表类群的单位元。非主形式是 $(2, 2, 3)$。题目要求我们将非主形式与自身复合。\n设待复合的形式为 $f_1 = (a_1, b_1, c_1) = (2, 2, 3)$ 和 $f_2 = (a_2, b_2, c_2) = (2, 2, 3)$。我们使用指定的算法。\n\n1. 计算 $g$：\n$g = \\gcd(a_1, a_2, (b_1+b_2)/2) = \\gcd(2, 2, (2+2)/2) = \\gcd(2, 2, 2) = 2$。\n\n2. 计算 $A$：\n$A = \\frac{a_1 a_2}{g^2} = \\frac{2 \\times 2}{2^2} = \\frac{4}{4} = 1$。\n\n3. 确定 $B$：\n问题指出 $B$ 必须满足同余式 $B \\equiv b_1 \\pmod{2 a_1}$ 和 $B \\equiv b_2 \\pmod{2 a_2}$。\n$B \\equiv 2 \\pmod{2 \\times 2} \\implies B \\equiv 2 \\pmod{4}$。\n$B \\equiv 2 \\pmod{2 \\times 2} \\implies B \\equiv 2 \\pmod{4}$。\n这些同余式意味着对于某个整数 $k$，$B$ 必须是 $4k+2$ 的形式。问题还指出，这个选择必须与“$B$ 在模 $2A$ 下定义”相一致。这里，$2A = 2(1)=2$。任何 $4k+2$ 形式的数都是偶数，所以 $B \\equiv 0 \\pmod{2}$，这在模 $2$ 下是一个唯一的值。这是一致的。\n\n4. 计算 $C$：\n第三个系数 $C$ 由判别式条件确定：$B^2 - 4AC = D$。\n$B^2 - 4(1)C = -20 \\implies 4C = B^2 + 20$。\n代入 $B=4k+2$：\n$4C = (4k+2)^2 + 20 = 16k^2 + 16k + 4 + 20 = 16k^2+16k+24$。\n$C = 4k^2 + 4k + 6$。\n得到的二次型为 $(A, B, C) = (1, 4k+2, 4k^2+4k+6)$。对于不同的整数 $k$，所有这些形式都属于同一个真等价类。我们选择最简单的情况，$k=0$，得到 $B=2$ 和 $C=6$。\n乘积形式为 $(1, 2, 6)$。\n\n5. 简化乘积形式：\n形式 $(1, 2, 6)$ 不是简化的，因为 $|b|=2 > a=1$。我们必须应用简化算法。我们使用一个 $\\begin{pmatrix} 1  m \\\\ 0  1 \\end{pmatrix}$ 类型的 $SL_2(\\mathbb{Z})$ 变换，它将一个形式 $(a,b,c)$ 变换为 $(a, b+2am, am^2+bm+c)$。\n我们有 $(a,b,c)=(1,2,6)$。我们想选择一个整数 $m$ 来最小化 $|b+2am| = |2+2(1)m| = |2+2m|$。选择 $m=-1$ 得到新的中间系数 $b' = 2+2(-1)=0$。\n新的形式 $(a', b', c')$ 具有：\n$a' = a = 1$。\n$b' = b+2am = 0$。\n$c' = am^2+bm+c = 1(-1)^2 + 2(-1) + 6 = 1-2+6 = 5$。\n简化形式为 $(1, 0, 5)$。\n\n$(2, 2, 3)$ 的类与自身的复合得到 $(1, 0, 5)$ 的类。\n\n**第3部分：阶与类数**\n令 $[f]$ 表示形式 $f$ 的等价类。在复合运算下，等价类的集合构成一个有限阿贝尔群，称为类群。该群的阶是类数，记为 $h(D)$。主形式的类 $[(1,0,5)]$ 是该群的单位元。\n从第2部分我们发现，非主形式的类 $[(2,2,3)]$ 与自身的复合结果是单位类：\n$$[(2, 2, 3)] \\circ [(2, 2, 3)] = [(1, 0, 5)]$$\n这意味着类 $[(2, 2, 3)]$ 是类群中一个阶为 $2$ 的元素。\n在第1部分中，我们发现判别式为 $D=-20$ 的本原正定二次型恰有两个等价类，由简化形式 $(1, 0, 5)$ 和 $(2, 2, 3)$ 代表。\n根据定义，类数 $h(-20)$ 是这类等价类的数量。\n因此，类数为 $h(-20)=2$。类群是一个阶为 $2$ 的群，同构于 $\\mathbb{Z}/2\\mathbb{Z}$，其元素是单位类 $[(1,0,5)]$ 和阶为 $2$ 的类 $[(2,2,3)]$。这与我们的复合结果一致。\n\n所要求的最终答案是 $h(-20)$ 的值。\n$h(-20) = 2$。", "answer": "$$\\boxed{2}$$", "id": "3083509"}, {"introduction": "为巩固你对高斯复合算法的理解，我们将通过一个具体的计算任务来聚焦于复合与简化的核心步骤。本练习选取判别式 $D=-15$ 的情形，要求你计算一个非主二次型的自复合，并将其结果简化为唯一的标准形式。这个过程将强化你对复合运算具体步骤的掌握，并加深对二次型等价类概念的理解。[@problem_id:3085624]", "problem": "设 $D$ 为一个本原正定二元二次型的判别式，对于代表齐次多项式 $ax^2 + bxy + cy^2$ 的型 $[a,b,c]$，其定义为 $D = b^2 - 4ac$。一个简化型满足 $|b| \\leq a \\leq c$，并且在 $|b| = a$ 或 $a = c$ 的情况下，要求 $b \\geq 0$。具有固定判别式的二元二次型类的复合律定义了一个群结构（高斯复合），而简化算法在每个等价类中产生一个唯一的简化代表元。\n\n考虑两个具有相同负判别式 $D = -15$ 的简化本原正定二元二次型：\n- $f(x,y) = 2x^2 + xy + 2y^2$，即 $[a,b,c] = [2,1,2]$;\n- $g(x,y) = 2x^2 + xy + 2y^2$，即 $[a',b',c'] = [2,1,2]$。\n\n使用判别式为 $D = -15$ 的型的类的复合律，计算 $f$ 和 $g$ 的复合，然后将得到的型简化为其简化代表元。报告简化复合型的首项系数 $a$。提供精确的整数值，无需四舍五入。", "solution": "该问题要求计算一个本原正定二元二次型与其自身的复合，然后对所得的型进行简化。给定的型是 $f(x,y) = 2x^2 + xy + 2y^2$，由系数三元组 $[a,b,c] = [2,1,2]$ 表示。第二个型 $g(x,y)$ 与 $f(x,y)$ 相同。此型的判别式为 $D = b^2 - 4ac = 1^2 - 4(2)(2) = 1 - 16 = -15$。题目说明判别式为 $D = -15$，这与计算结果一致。型 $[2,1,2]$ 是本原的，因为 $\\text{gcd}(2,1,2) = 1$。它也是简化的，因为它满足条件 $|b| \\leq a \\leq c$（即 $|1| \\leq 2 \\leq 2$）以及在 $a=c$ 的情况下 $b \\geq 0$。\n\n我们需要计算 $f$ 所在的类与 $g$ 所在的类的复合。由于 $f$ 和 $g$ 代表同一个型，我们实际上是在类群 $Cl(D) = Cl(-15)$ 中对 $[2,1,2]$ 所在的类进行平方运算。我们将使用 Dirichlet 复合算法。\n\n设两个型为 $f_1 = [a_1, b_1, c_1] = [2,1,2]$ 和 $f_2 = [a_2, b_2, c_2] = [2,1,2]$。两个型都具有判别式 $D = -15$。\n复合两个具有相同判别式的本原型的通用算法需要找到一个满足同余方程组的整数 $B$。首先，我们计算值 $g = \\text{gcd}(a_1, a_2, \\frac{b_1+b_2}{2})$。\n在这种情况下，$a_1=2$，$a_2=2$，$b_1=1$，$b_2=1$。\n因此，$\\frac{b_1+b_2}{2} = \\frac{1+1}{2} = 1$。\n$g = \\text{gcd}(2, 2, 1) = 1$。\n\n整数 $B$ 必须满足以下同余式：\n1. $B \\equiv b_1 \\pmod{2a_1/g}$\n2. $B \\equiv b_2 \\pmod{2a_2/g}$\n3. $B^2 \\equiv D \\pmod{4a_1a_2/g^2}$\n\n代入给定值：\n1. $B \\equiv 1 \\pmod{2(2)/1} \\implies B \\equiv 1 \\pmod{4}$。\n2. $B \\equiv 1 \\pmod{2(2)/1} \\implies B \\equiv 1 \\pmod{4}$。这是多余的。\n3. $B^2 \\equiv -15 \\pmod{4(2)(2)/1^2} \\implies B^2 \\equiv -15 \\pmod{16}$。\n\n我们必须求解这个关于 $B$ 的方程组。第三个同余式简化为 $B^2 \\equiv 1 \\pmod{16}$，因为 $-15 \\equiv 1 \\pmod{16}$。\n根据第一个同余式，$B$ 必须具有 $B=4k+1$ 的形式，其中 $k$ 为某个整数。\n将此代入第二个条件中：\n$(4k+1)^2 \\equiv 1 \\pmod{16}$\n$16k^2 + 8k + 1 \\equiv 1 \\pmod{16}$\n$8k \\equiv 0 \\pmod{16}$\n这意味着 $8k$ 是 $16$ 的倍数，所以 $k$ 必须是偶数。设 $k = 2j$，其中 $j$ 为某个整数。\n那么 $B = 4(2j)+1 = 8j+1$。这意味着 $B$ 必须满足 $B \\equiv 1 \\pmod 8$。\n我们可以选择最简单的解，即当 $j=0$ 时，得到 $B=1$。\n\n复合型 $F = [A, B, C]$ 的系数由以下公式给出：\n$A = \\frac{a_1 a_2}{g^2} = \\frac{2 \\cdot 2}{1^2} = 4$。\n$B = 1$ (根据我们上面的选择)。\n$C = \\frac{B^2-D}{4A} = \\frac{1^2 - (-15)}{4 \\cdot 4} = \\frac{1+15}{16} = \\frac{16}{16} = 1$。\n\n所以，复合型为 $F = [4,1,1]$。\n该型的判别式是 $1^2 - 4(4)(1) = 1-16 = -15$，符合预期。\n\n接下来，我们必须找到型 $F = [4,1,1]$ 所在类的唯一简化代表元。一个正定型 $[a,b,c]$ 是简化的，如果 $|b| \\leq a \\leq c$，并附加条件：若 $|b|=a$ 或 $a=c$，则 $b \\geq 0$。\n对于型 $[4,1,1]$，我们有 $a=4, b=1, c=1$。条件 $a \\leq c$ 不满足，因为 $4 > 1$。因此，该型不是简化的。\n\n我们应用简化算法。\n步骤1：当前型为 $[4,1,1]$。由于 $a > c$，我们应用变换 $(a,b,c) \\to (c, -b, a)$，这是一个等价于代换 $(x,y) \\to (-y,x)$ 的等价变换。\n应用此变换，我们得到新的型 $[1, -1, 4]$。\n\n步骤2：现在我们考察型 $[1,-1,4]$。令系数为 $a'=1, b'=-1, c'=4$。我们检查简化条件：\n$|b'| \\leq a' \\leq c'$ 转换为 $|-1| \\leq 1 \\leq 4$，即 $1 \\leq 1 \\leq 4$。这是成立的。\n然而，我们遇到了 $|b'|=a'$ 的情况。简化条件要求在这种情况下，中间系数必须为非负数，即 $b' \\geq 0$。我们的型有 $b'=-1$，这违反了该条件。所以，$[1,-1,4]$ 尚未简化。\n\n步骤3：为了解决这个问题，我们应用类型为 $(a',b',c') \\to (a', b'+2a'k, c'')$ 的等价变换，其中 $k$ 为整数，选择 $k$ 使得新的中间系数 $b'' = b'+2a'k$ 落在 $[-a', a']$ 范围内，并在需要时满足非负性条件。\n当 $a'=1$ 和 $b'=-1$ 时，我们有 $b'' = -1+2(1)k$。我们希望 $|b''| \\leq a'$，即 $|-1+2k| \\leq 1$。\n如果我们选择 $k=1$，那么 $b'' = -1+2(1) = 1$。条件 $|1| \\leq 1$ 得到满足。由于现在我们有 $|b''|=a'$，我们需要 $b'' \\geq 0$。我们新的 $b''=1$ 满足这个要求。\n因此，我们使用 $k=1$。新的型 $[a'', b'', c'']$ 将有 $a''=a'=1$ 和 $b''=1$。\n第三个系数 $c''$ 由判别式确定：\n$c'' = \\frac{(b'')^2-D}{4a''} = \\frac{1^2 - (-15)}{4 \\cdot 1} = \\frac{16}{4} = 4$。\n因此，新的型是 $[1,1,4]$。\n\n步骤4：最后，我们检查型 $[1,1,4]$ 是否是简化的。令 $a''=1, b''=1, c''=4$。\n条件 $|b''| \\leq a'' \\leq c''$ 转换为 $|1| \\leq 1 \\leq 4$，这是成立的。\n我们有 $|b''|=a''$，所以必须检查 $b'' \\geq 0$ 是否成立。由于 $b''=1$，这也是成立的。\n型 $[1,1,4]$ 是简化的。这是复合类的唯一简化代表元。\n\n问题要求的是简化复合型的首项系数 $a$。\n简化复合型是 $[1,1,4]$。其首项系数是 $1$。\n这个结果与类群 $Cl(-15)$ 的结构一致，这是一个2阶群。其元素是主型 $[1,1,4]$（单位元）的类和型 $[2,1,2]$ 的类。将非单位元 $[2,1,2]$ 平方得到单位元 $[1,1,4]$。\n简化复合型的首项系数是 $1$。", "answer": "$$\\boxed{1}$$", "id": "3085624"}]}