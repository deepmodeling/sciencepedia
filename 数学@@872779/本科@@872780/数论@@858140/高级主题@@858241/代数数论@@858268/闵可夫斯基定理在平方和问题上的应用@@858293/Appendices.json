{"hands_on_practices": [{"introduction": "在我们运用闵可夫斯基这一定理之前，必须先将数论问题——也就是将一个素数表示为两个平方数之和——转换成几何语言。这个转换的核心是构建一个名为“格”的数学结构，其上的点巧妙地编码了我们原始问题的解的性质。这个练习 [@problem_id:3081185] 将引导你完成定义格、寻找其基向量以及计算其行列式（或称“协体积”）这些基本步骤，而行列式正是应用闵可夫斯基定理的关键参数。", "problem": "设 $p$ 为一个奇素数，且存在一个整数 $a$ 使得 $a^{2} \\equiv -1 \\pmod{p}$。考虑由下式定义的子集 $\\Lambda \\subset \\mathbb{R}^{2}$\n$$\n\\Lambda \\;=\\; \\{(x,y) \\in \\mathbb{Z}^{2} \\;:\\; x \\equiv a y \\pmod{p}\\}.\n$$\n在通过闵可夫斯基凸体定理将 $p$ 表示为两平方和的数的几何方法中，出现了这个格。从 $\\mathbb{R}^{2}$ 中格的基本定义以及格的行列式（余体积）作为基本平行四边形面积的定义出发，完成以下任务：\n- 证明 $\\Lambda$ 是 $\\mathbb{R}^{2}$ 中的一个满秩格。\n- 用 $p$ 和 $a$ 构造 $\\Lambda$ 的一个显式 $\\mathbb{Z}$-基。\n- 从你构造的基直接计算行列式 $\\det(\\Lambda)$。\n\n你的最终答案必须是 $\\det(\\Lambda)$ 关于 $p$ 和 $a$ 的精确封闭形式表达式。无需四舍五入。", "solution": "问题要求分析集合 $\\Lambda$ 并计算其行列式。\n题目陈述给出了以下已知条件：\n- $p$ 是一个奇素数。\n- 存在一个整数 $a$ 使得 $a^{2} \\equiv -1 \\pmod{p}$。\n- 集合 $\\Lambda \\subset \\mathbb{R}^{2}$ 定义为 $\\Lambda = \\{(x,y) \\in \\mathbb{Z}^{2} \\;:\\; x \\equiv a y \\pmod{p}\\}$。\n\n该问题被验证为是合理的。这是数的几何中的一个标准问题，而数的几何是数论的一个分支。所有术语都定义明确，前提在数学上是正确的，目标是可形式化和可解决的。条件 $a^{2} \\equiv -1 \\pmod{p}$ 是将 $p$ 表示为两平方和的一个著名先决条件，这也是本问题的背景。\n\n我们继续完成所要求的三个任务。\n\n**1. 证明 $\\Lambda$ 是 $\\mathbb{R}^{2}$ 中的一个满秩格。**\n\n如果 $\\mathbb{R}^{n}$ 的一个子集是加法群 $(\\mathbb{R}^{n}, +)$ 的离散子群，那么它就是一个格。首先，我们证明 $\\Lambda$ 是 $(\\mathbb{Z}^{2}, +)$ 的一个子群。由于 $(\\mathbb{Z}^{2}, +)$ 是 $(\\mathbb{R}^{2}, +)$ 的一个离散子群，它的任何子群（包括 $\\Lambda$）也将是离散的。\n\n为了证明 $\\Lambda$ 是一个子群，我们使用子群判别法。\n- 集合 $\\Lambda$ 非空，因为 $(0,0) \\in \\mathbb{Z}^{2}$ 且 $0 \\equiv a \\cdot 0 \\pmod{p}$，所以 $(0,0) \\in \\Lambda$。\n- 设 $v_1 = (x_1, y_1)$ 和 $v_2 = (x_2, y_2)$ 是 $\\Lambda$ 的两个任意元素。根据定义，$x_1, y_1, x_2, y_2$ 都是整数。它们属于 $\\Lambda$ 的条件是：\n  $x_1 \\equiv a y_1 \\pmod{p}$\n  $x_2 \\equiv a y_2 \\pmod{p}$\n- 考虑差 $v_1 - v_2 = (x_1 - x_2, y_1 - y_2)$。由于 $x_1, x_2, y_1, y_2$ 是整数，差的分量也是整数，所以 $v_1 - v_2 \\in \\mathbb{Z}^{2}$。\n- 现在我们检查 $v_1 - v_2$ 的同余条件：\n  $$x_1 - x_2 \\equiv a y_1 - a y_2 \\pmod{p}$$\n  $$x_1 - x_2 \\equiv a(y_1 - y_2) \\pmod{p}$$\n- 这表明 $v_1 - v_2 \\in \\Lambda$。根据子群判别法，$\\Lambda$ 是 $(\\mathbb{Z}^{2}, +)$ 的一个子群。如前所述，这意味着 $\\Lambda$ 是 $\\mathbb{R}^{2}$ 的一个离散子群，因此是一个格。\n\n要证明 $\\Lambda$ 是 $\\mathbb{R}^{2}$ 中的一个*满秩*格，我们必须证明它包含两个在 $\\mathbb{R}$ 上线性无关的向量。这等价于证明由 $\\Lambda$ 的元素张成的实向量空间是 $\\mathbb{R}^{2}$ 本身。\n\n让我们在 $\\Lambda$ 中找到两个这样的向量。\n- 考虑一个 $y$ 分量为 $y=0$ 的向量。条件变为 $x \\equiv a \\cdot 0 \\pmod{p}$，化简为 $x \\equiv 0 \\pmod{p}$。这意味着 $x$ 必须是 $p$ 的倍数。最简单的非零整数选择是 $x=p$。因此，向量 $v_1 = (p, 0)$ 在 $\\Lambda$ 中。\n- 考虑一个 $y$ 分量为 $y=1$ 的向量。条件变为 $x \\equiv a \\cdot 1 \\pmod p$。一个简单的整数选择是 $x=a$。因此，向量 $v_2 = (a, 1)$ 在 $\\Lambda$ 中。\n\n现在我们检查向量 $v_1 = (p, 0)$ 和 $v_2 = (a, 1)$ 是否在 $\\mathbb{R}$ 上线性无关。我们可以通过用这些向量组成一个矩阵并检查其行列式是否为零来做到这一点。\n$$\n\\det\\begin{pmatrix} p  a \\\\ 0  1 \\end{pmatrix} = (p)(1) - (a)(0) = p\n$$\n由于 $p$ 是一个素数，$p \\neq 0$。因此，向量 $v_1$ 和 $v_2$ 在 $\\mathbb{R}$ 上是线性无关的。由于 $\\Lambda$ 包含 $\\mathbb{R}^{2}$ 中的两个线性无关向量，它张成 $\\mathbb{R}^{2}$，是一个满秩格。\n\n**2. 构造 $\\Lambda$ 的一个显式 $\\mathbb{Z}$-基。**\n\n我们提出，上面找到的两个向量 $v_1 = (p, 0)$ 和 $v_2 = (a, 1)$ 构成 $\\Lambda$ 的一个 $\\mathbb{Z}$-基。为了证明这一点，我们必须证明 $\\Lambda$ 中的任何向量 $v = (x, y)$ 都可以写成 $v_1$ 和 $v_2$ 的唯一整系数线性组合。\n\n设 $v = (x,y)$ 是 $\\Lambda$ 中的一个任意元素。我们要找到整数 $c_1, c_2$ 使得：\n$$ (x,y) = c_1 v_1 + c_2 v_2 = c_1(p, 0) + c_2(a, 1) $$\n展开右边得到：\n$$ (x,y) = (c_1 p + c_2 a, c_2) $$\n令各分量相等，我们得到一个由两个方程组成的方程组：\n1. $y = c_2$\n2. $x = c_1 p + c_2 a$\n\n由第一个方程，$c_2 = y$。由于 $v=(x,y) \\in \\Lambda \\subset \\mathbb{Z}^{2}$，$y$ 是一个整数。所以 $c_2$ 是一个整数。\n将 $c_2=y$ 代入第二个方程得到：\n$$ x = c_1 p + y a $$\n$$ c_1 p = x - ya $$\n为了求出 $c_1$，我们必须检查 $x-ya$ 是否能被 $p$ 整除。根据 $\\Lambda$ 的定义，由于 $(x,y) \\in \\Lambda$，我们有 $x \\equiv ya \\pmod{p}$。这意味着 $x-ya$ 是 $p$ 的整数倍。设 $x - ya = k p$，其中 $k$ 是某个整数。\n那么 $c_1 p = kp$，这意味着 $c_1 = k$。由于 $k$ 是一个整数，$c_1$ 也是一个整数。\n因此，对于 $\\Lambda$ 中的任何 $v=(x,y)$，我们都可以找到唯一的整数 $c_1 = \\frac{x-ya}{p}$ 和 $c_2 = y$ 使得 $v = c_1 v_1 + c_2 v_2$。\n这证明了集合 $\\{v_1, v_2\\} = \\{(p, 0), (a, 1)\\}$ 构成格 $\\Lambda$ 的一个 $\\mathbb{Z}$-基。\n\n**3. 从你构造的基直接计算行列式 $\\det(\\Lambda)$。**\n\n$\\mathbb{R}^{n}$ 中格 $\\Lambda$ 的行列式（也称为其余体积）定义为一个矩阵的行列式的绝对值，该矩阵的行（或列）是该格的基向量。\n使用我们构造的基 $v_1 = (p, 0)$ 和 $v_2 = (a, 1)$，我们构成基矩阵 $B$（以基向量为列）：\n$$\nB = \\begin{pmatrix} p  a \\\\ 0  1 \\end{pmatrix}\n$$\n这个矩阵的行列式是：\n$$ \\det(B) = (p)(1) - (a)(0) = p $$\n格 $\\Lambda$ 的行列式是 $\\det(B)$ 的绝对值：\n$$ \\det(\\Lambda) = |\\det(B)| = |p| $$\n因为 $p$ 是一个素数，所以它是正数。因此， $|p| = p$。\n格 $\\Lambda$ 的行列式是 $p$。", "answer": "$$\\boxed{p}$$", "id": "3081185"}, {"introduction": "在建立了理论框架之后，我们通过一个具体的例子将其付诸实践，这是理解格与凸体这些抽象工具如何导出确切数值解的最佳方式。我们将对特定的素数 $p=29$ 应用闵可夫斯基定理，以确保在一个有界区域内存在一个特殊的整数解。这项练习 [@problem_id:3081193] 将引导你完成寻找整数对 $(x,y)$ 使得 $x^2 + y^2 = 29$ 的确切计算步骤，从而揭开费马平方和定理证明的神秘面纱。", "problem": "设 $p=29$。利用平面 $\\mathbb{R}^{2}$ 上的闵可夫斯基凸体定理 (Minkowski's convex body theorem) 的原理，以及当 $p \\equiv 1 \\pmod{4}$ 时，同余类 $-1$ 存在模 $p$ 的平方根这一基本事实，完成以下步骤。\n\n- 构造一个行列式为 $p$ 的满秩格 $\\Lambda \\subset \\mathbb{R}^{2}$，该格为整数向量 $(x,y) \\in \\Lambda$ 编码了同余约束 $x^{2}+y^{2} \\equiv 0 \\pmod{p}$。\n- 选择一个中心对称的凸正方形 $B \\subset \\mathbb{R}^{2}$，其面积严格超过 Minkowski 凸体定理对 $\\Lambda$ 所要求的阈值，并解释为什么 Minkowski 定理保证存在一个非零格点 $(x,y) \\in \\Lambda \\cap B$。\n- 证明你的选择使得对于上面找到的非零点 $(x,y)$ 有 $0  x^{2}+y^{2}  2p$ 成立，并由此推导出 $x^{2}+y^{2}=p$。\n- 计算一个由该方法产生的、满足 $x^{2}+y^{2}=29$ 且坐标为最小非负整数的明确整数对 $(x,y)$。\n\n使用 $\\pmatrix{\\cdot \\cdot}$ 记法，将你最终的 $(x,y)$ 以单行的形式给出。无需四舍五入，不涉及单位。", "solution": "该问题要求应用 Minkowski 凸体定理来为素数 $p=29$ 找到方程 $x^2+y^2=p$ 的一个整数解。整个过程分为四个步骤，我们将系统地遵循这些步骤。\n\n首先，我们验证同余方程 $u^2 \\equiv -1 \\pmod{p}$ 有解这一前提。给定 $p=29$。该素数满足 $29 \\equiv 1 \\pmod{4}$。根据费马平方和定理（或者更初等地，根据二次剩余的性质），同余方程 $u^2 \\equiv -1 \\pmod{p}$ 保证有整数解。对于 $p=29$，我们需要找到一个整数 $u$ 使得 $u^2 \\equiv -1 \\pmod{29}$，即 $u^2 \\equiv 28 \\pmod{29}$。通过测试较小的整数值，我们发现 $12^2 = 144$。$144$ 除以 $29$ 得到 $144 = 4 \\times 29 + 28$。因此，$12^2 \\equiv 28 \\pmod{29}$，我们可以选择 $u=12$。\n\n**步骤 1：构造格 $\\Lambda$**\n\n我们需要构造一个行列式为 $p=29$ 的满秩格 $\\Lambda \\subset \\mathbb{R}^2$，使得任意整数向量 $(x,y) \\in \\Lambda$ 都满足 $x^2+y^2 \\equiv 0 \\pmod{29}$。\n使用我们的 $u$ 值，同余方程 $x^2+y^2 \\equiv 0 \\pmod{p}$ 可以改写为：\n$x^2 - u^2y^2 \\equiv 0 \\pmod{p} \\implies (x-uy)(x+uy) \\equiv 0 \\pmod{p}$。\n如果 $x \\equiv uy \\pmod{p}$ 或 $x \\equiv -uy \\pmod{p}$，则该同余式成立。我们可以选择其中一个条件来定义我们的格。我们选择 $x \\equiv uy \\pmod{p}$。当 $u=12$ 且 $p=29$ 时，该条件为 $x \\equiv 12y \\pmod{29}$。\n\n格是一组基向量的所有整系数线性组合的集合。我们寻求满足 $x \\equiv 12y \\pmod{29}$ 的整数向量集合 $(x,y) \\in \\mathbb{Z}^2$ 的一组基 $\\{\\mathbf{v}_1, \\mathbf{v}_2\\}$。\n格中的一个点具有形式 $\\mathbf{v} = (x,y) = a\\mathbf{v}_1 + b\\mathbf{v}_2$，其中 $a, b$ 为整数。\n我们来构造一组基。条件 $x - 12y = 29k$（对于某个整数 $k$）定义了这个点的集合。\n一个满足此条件的明显向量是 $(29,0)$，因为 $29 - 12(0) = 29(1)$。所以我们可以取 $\\mathbf{v}_1 = (29, 0)$。\n另一个简单的向量可以通过设 $y=1$ 并找到满足 $x \\equiv 12 \\pmod{29}$ 的最小非负 $x$ 来得到。这个值是 $x=12$。所以，向量 $(12,1)$ 满足该同余关系。我们选择 $\\mathbf{v}_2 = (12,1)$。\n\n格 $\\Lambda$ 是这些向量的所有整系数线性组合的集合：\n$$ \\Lambda = \\{ a(29, 0) + b(12, 1) \\mid a, b \\in \\mathbb{Z} \\} $$\n任何向量 $(x,y) \\in \\Lambda$ 都可以写成 $(x,y) = (29a+12b, b)$。对于这样的向量，我们来验证同余关系：\n$x - 12y = (29a+12b) - 12(b) = 29a$。\n因为 $29a \\equiv 0 \\pmod{29}$，我们有 $x \\equiv 12y \\pmod{29}$，这意味着 $x^2 \\equiv 144y^2 \\equiv -y^2 \\pmod{29}$，因此 $x^2+y^2 \\equiv 0 \\pmod{29}$。该格正确地编码了此约束。\n\n格的行列式 $\\det(\\Lambda)$ 是由基向量构成的矩阵的行列式的绝对值：\n$$ \\det(\\Lambda) = \\left| \\det \\begin{pmatrix} 29  12 \\\\ 0  1 \\end{pmatrix} \\right| = |29 \\cdot 1 - 12 \\cdot 0| = 29 $$\n所以 $\\det(\\Lambda)=p=29$，符合要求。\n\n**步骤 2：选择凸体并应用 Minkowski 定理**\n\n我们必须选择一个中心对称的凸正方形 $B \\subset \\mathbb{R}^2$，其面积严格大于 $4 \\det(\\Lambda)$。Minkowski 凸体定理指出，对于 $\\mathbb{R}^2$ 中的一个中心对称凸体 $B$，如果 $\\text{Area}(B)  4 \\det(\\Lambda)$，那么 $B$ 必须包含至少一个 $\\Lambda$ 中的非零点。\n\n设 $B$ 是一个以原点为中心的开正方形，定义为 $B = \\{ (x,y) \\in \\mathbb{R}^2 \\mid |x|  s, |y|  s \\}$，其中 $s$ 为某个实数。该集合是凸集且中心对称。\n其面积为 $\\text{Area}(B) = (2s)^2 = 4s^2$。\n根据 Minkowski 定理，条件是 $4s^2  4 \\det(\\Lambda) = 4p = 4(29) = 116$。\n这可以简化为 $s^2  29$。\n为了满足问题的下一步，我们需要审慎地选择 $s$。让我们做一个具体的选择。我们需要 $s  \\sqrt{29} \\approx 5.385$。我们选择的 $s$ 应满足 $s^2  29$ 但又不能太大。例如，取 $s=5.5$ 得到 $s^2 = 30.25$。\n由于 $30.25  29$，条件 $s^2  p$ 得到满足。通过这个选择，$\\text{Area}(B) = 4(30.25) = 121  116$。\nMinkowski 定理保证存在一个非零整数向量 $(x,y) \\in \\Lambda \\cap B$。\n\n**步骤 3：推导 $x^2+y^2=p$**\n\n在步骤 2 中找到的非零向量 $(x,y)$ 具有整数坐标，并且同时属于格 $\\Lambda$ 和正方形 $B$。\n- 由于 $(x,y) \\in B$，我们有 $|x|  5.5$ 和 $|y|  5.5$。因为 $x$ 和 $y$ 是整数，这些不等式意味着 $|x| \\le 5$ 和 $|y| \\le 5$。\n- 根据这些整数界限，我们可以限定平方和：$x^2 \\le 25$ 且 $y^2 \\le 25$，所以 $x^2+y^2 \\le 25+25=50$。\n- 由于 $(x,y) \\in \\Lambda$，我们知道 $x^2+y^2$ 必须是 $p=29$ 的倍数。所以，$x^2+y^2 = k \\cdot 29$，其中 $k$ 为某个整数。\n- 由于 $(x,y)$ 是一个非零向量，$(x,y) \\ne (0,0)$，这意味着 $x^2+y^2  0$。因此，$k$ 必须是一个正整数，$k \\ge 1$。\n\n结合这些条件，我们得到 $x^2+y^2 = 29k \\le 50$。\n满足这个不等式的唯一正整数 $k$ 是 $k=1$。\n因此，我们必然有 $x^2+y^2=29$。\n\n这个结果 $x^2+y^2=29$ 满足条件 $0  x^2+y^2  2p$，因为 $0  29  2(29)=58$。选择边长参数为 $s=5.5$ 的正方形 $B$ 使得我们得出了所期望的结论。\n\n**步骤 4：计算明确的整数对**\n\n我们需要找到一个位于我们正方形 $B$ 内的明确非零向量 $(x,y) \\in \\Lambda$。$\\Lambda$ 中的向量形式为 $(x,y) = (29a+12b, b)$，其中 $a,b$ 为整数。条件是 $|x| \\le 5$ 和 $|y| \\le 5$。\n条件 $|y| \\le 5$ 转化为 $|b| \\le 5$。我们搜索满足这些约束的整数对 $(a,b)$（不全为零）。\n我们来测试 $b$ 从 $1$ 到 $5$ 的值：\n- 如果 $b=1$：$|29a+12| \\le 5 \\implies -17 \\le 29a \\le -7$。没有整数解 $a$。\n- 如果 $b=2$：$|29a+24| \\le 5 \\implies -29 \\le 29a \\le -19$。这蕴含 $a=-1$。\n  我们来检验这对 $(a,b)=(-1,2)$：\n  $x = 29(-1) + 12(2) = -29+24 = -5$。\n  $y = b = 2$。\n  向量是 $(-5, 2)$。这是一个非零向量。其坐标满足 $|-5| \\le 5$ 和 $|2| \\le 5$。其平方和为 $(-5)^2+2^2 = 25+4=29$。这是这样一个向量。\n- 如果 $b=3$：$|29a+36| \\le 5 \\implies -41 \\le 29a \\le -31$。没有整数解 $a$。\n- 如果 $b=4$：$|29a+48| \\le 5 \\implies -53 \\le 29a \\le -43$。没有整数解 $a$。\n- 如果 $b=5$：$|29a+60| \\le 5 \\implies -65 \\le 29a \\le -55$。这蕴含 $a=-2$。\n  我们来检验这对 $(a,b)=(-2,5)$：\n  $x=29(-2)+12(5) = -58+60 = 2$。\n  $y=b=5$。\n  向量是 $(2,5)$。这是一个非零向量。其坐标满足 $|2|\\le 5$ 和 $|5|\\le 5$。其平方和为 $2^2+5^2=4+25=29$。\n\n我们找到了两对候选解（不计符号和顺序）：$(2,5)$ 和 $(5,2)$。问题要求找到具有最小非负坐标的整数对 $(x,y)$。具有非负坐标的整数对是来自 $(a,b)=(-2,5)$ 的 $(2,5)$，以及可能通过改变 $u$ 得到的其他解。在我们的构造中，我们找到了 $(2,5)$。按照惯例，我们将较小的坐标写在前面。\n\n整数对 $(2,5)$（其中 $x=2, y=5$）由非负整数组成，满足 $2^2+5^2=29$，并且是我们为寻找 Minkowski 定理所保证的点而进行的系统搜索中得到的。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  5\n\\end{pmatrix}\n}\n$$", "id": "3081193"}, {"introduction": "对每个素数都手动执行这些计算虽然富有启发性，但效率低下。一个数学方法的真正力量，往往在于它被转化为一个通用的、可自动执行的程序之时。这个最终的练习旨在挑战你将整个过程——从计算模平方根到约简格的基——系统化为一个连贯的算法。通过将理论转化为代码 [@problem_id:3081159]，你不仅能巩固对每个环节的理解，还能创造出一个强大的工具，用以为任何符合条件的素数找到其平方和表示。", "problem": "令 $p$ 为一个满足 $p \\equiv 1 \\pmod{4}$ 的奇素数。目标是实现一个算法，对每个这样的 $p$，利用源自闵可夫斯基凸体定理的格方法，构造一个表示 $p = x^2 + y^2$。\n\n理论基础：\n- 闵可夫斯基凸体定理（源于数之几何）：若 $\\Lambda \\subset \\mathbb{R}^n$ 是一个协体积为 $\\operatorname{covol}(\\Lambda)$ 的格，且 $K \\subset \\mathbb{R}^n$ 是一个中心对称凸体，其体积 $\\operatorname{vol}(K)  2^n \\operatorname{covol}(\\Lambda)$，则 $K$ 包含一个非零格点。\n- 定义：格 $\\Lambda \\subset \\mathbb{R}^2$ 是由两个线性无关向量生成的离散子群。协体积是基矩阵行列式的绝对值。$(x,y)$ 的范数是 $\\sqrt{x^2 + y^2}$。\n- 模素数的二次剩余：对于奇素数 $p$，$-1$ 是二次剩余当且仅当 $p \\equiv 1 \\pmod{4}$。\n\n您的程序必须：\n1. 对于每个满足 $p \\equiv 1 \\pmod{4}$ 的输入素数 $p$，使用一个对任何奇素数都有效的通用模平方根算法（例如，不依赖于 $p$ 除素性之外的特殊同余式的 Tonelli–Shanks 算法的变体），计算一个整数 $a$ 使得 $a^2 \\equiv -1 \\pmod{p}$。\n2. 构造格 $\\Lambda = \\{(x,y) \\in \\mathbb{Z}^2 : x \\equiv a y \\pmod{p}\\}$。展示 $\\Lambda$ 的一个 $\\mathbb{Z}$-基，并执行二维格规约（高斯规约）以获得一个短非零向量 $(x,y) \\in \\Lambda$。\n3. 通过应用闵可夫斯基凸体定理来证明，存在一个非零向量 $(x,y) \\in \\Lambda$ 满足 $x^2 + y^2  2p$。解释为什么当 $p$ 是素数且 $a^2 \\equiv -1 \\pmod{p}$ 时，任何这样的 $(x,y)$ 都必须满足 $x^2 + y^2 = p$。您的实现必须仅在闵可夫斯基定理所证明的界限内搜索，即必须找到一个非零向量 $(x,y) \\in \\Lambda$ 满足 $x^2 + y^2  2p$。\n4. 通过要求 $x \\ge 0$、$y \\ge 0$ 和 $x \\le y$ 来规范化每个 $p$ 的输出对。\n\n输入规范是隐式的：您的程序没有外部输入，必须在下面列出的固定测试套件上运行。\n\n测试套件：\n- 情况 1：$p = 5$。\n- 情况 2：$p = 13$。\n- 情况 3：$p = 29$。\n- 情况 4：$p = 37$。\n- 情况 5：$p = 97$。\n- 情况 6：$p = 101$。\n\n答案规范：\n- 对于每个测试用例素数 $p$，输出一对非负整数 $[x,y]$，满足 $x^2 + y^2 = p$ 且 $x \\le y$。整个测试套件的结果必须是与测试套件顺序相同的这些对的单个列表。最终输出必须是单行字符串，其格式与 Python 的列表字面量完全一致，例如 $[[x_1,y_1],[x_2,y_2],\\dots]$，除了列表语法要求的空格外，不添加或删除任何空格。\n- 所有量均为纯整数；没有物理单位。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[[x1,y1],[x2,y2],[x3,y3]]”）。", "solution": "我们从数论和数之几何的标准原理开始。\n\n第1步：模 $p$ 的 $-1$ 平方根的存在性及其计算方法。\n- 对于奇素数 $p$，欧拉准则指出，对于任何 $n \\not\\equiv 0 \\pmod{p}$，有 $n^{(p-1)/2} \\equiv \\left(\\frac{n}{p}\\right) \\pmod{p}$，其中 $\\left(\\frac{n}{p}\\right)$ 是勒让德符号。特别地，$\\left(\\frac{-1}{p}\\right) = 1$ 当且仅当 $p \\equiv 1 \\pmod{4}$，这确保了存在 $a$ 使得 $a^2 \\equiv -1 \\pmod{p}$。\n- 要通过算法计算这样的 $a$，对于一个通用的奇素数 $p$，我们可以使用 Tonelli–Shanks 算法。给定 $n \\equiv -1 \\pmod{p}$，Tonelli–Shanks 算法通过以下步骤计算满足 $a^2 \\equiv n \\pmod{p}$ 的 $a$：\n  - 将 $p-1$ 写成 $p-1 = Q \\cdot 2^S$，其中 $Q$ 为奇数。\n  - 找到一个 $z$ 使得 $\\left(\\frac{z}{p}\\right) = -1$。\n  - 设置 $M = S$， $c \\equiv z^Q \\pmod{p}$， $t \\equiv n^Q \\pmod{p}$， $R \\equiv n^{(Q+1)/2} \\pmod{p}$。\n  - 迭代直到 $t \\equiv 1 \\pmod{p}$，使用连续平方来校正 $R$、$t$ 和 $c$ 以强制收敛。此算法是经过充分检验的标准算法，不依赖于像 $p \\equiv 3 \\pmod{4}$ 指数技巧那样的特殊情况捷径。\n\n第2步：构造格 $\\Lambda$ 及其基。\n- 定义格 $\\Lambda = \\{ (x,y) \\in \\mathbb{Z}^2 : x \\equiv a y \\pmod{p} \\}$。这是 $\\mathbb{R}^2$ 中的一个满秩格。一个方便的 $\\mathbb{Z}$-基由以下两个向量给出\n  $$\n  \\mathbf{b}_1 = (a,1), \\quad \\mathbf{b}_2 = (p,0).\n  $$\n  确实，任何整数组合 $m \\mathbf{b}_1 + n \\mathbf{b}_2 = (ma + np, m)$ 都在 $\\Lambda$ 中，因为 $ma + np \\equiv a m \\equiv a y \\pmod{p}$。基矩阵\n  $$\n  B = \\begin{pmatrix} a  p \\\\ 1  0 \\end{pmatrix}\n  $$\n  的行列式为 $-p$，所以 $\\Lambda$ 的协体积是 $|\\det(B)| = p$。\n\n第3步：应用闵可夫斯基凸体定理界定搜索范围。\n- 考虑闭欧几里得圆盘\n  $$\n  K = \\{ (x,y) \\in \\mathbb{R}^2 : x^2 + y^2 \\le 2p \\}.\n  $$\n  这是 $\\mathbb{R}^2$ 中的一个中心对称凸体，其面积为 $\\operatorname{vol}(K) = \\pi ( \\sqrt{2p} )^2 = 2 \\pi p$。因为 $2 \\pi p > 4 p = 2^2 \\cdot \\operatorname{covol}(\\Lambda)$（因为 $\\pi > 2$），闵可夫斯基凸体定理保证了存在一个非零格点 $(x,y) \\in \\Lambda \\cap K$。因此，存在一个非零向量 $(x,y) \\in \\Lambda$ 满足\n  $$\n  x^2 + y^2 \\le 2p.\n  $$\n  使用鸽巢原理或考虑一个稍小的半径进行细化，可以得到严格不等式 $x^2 + y^2  2p$ 对某个非零格向量成立。特别地，$\\Lambda$ 中最小非零范数的平方严格小于 $2p$。\n- 根据 $\\Lambda$ 的定义同余式和 $a$ 的选择，任何 $(x,y) \\in \\Lambda$ 都满足\n  $$\n  x \\equiv a y \\pmod{p} \\quad \\Longrightarrow \\quad x^2 + y^2 \\equiv (a^2 + 1) y^2 \\equiv 0 \\pmod{p}.\n  $$\n  因此，对于任何非零向量 $(x,y) \\in \\Lambda$，整数 $x^2 + y^2$ 是 $p$ 的一个正倍数。如果额外有 $x^2 + y^2  2p$，那么唯一可能性是\n  $$\n  x^2 + y^2 = p.\n  $$\n\n第4步：算法提取短非零格向量。\n- 在二维空间中，高斯规约为寻找格的一个非常短的基提供了一种有效方法。从 $(\\mathbf{b}_1,\\mathbf{b}_2)$ 开始，重复执行以下操作：\n  - 如果 $\\|\\mathbf{b}_2\\|  \\|\\mathbf{b}_1\\|$，交换它们。\n  - 设置 $\\mu = \\left\\lfloor \\frac{\\langle \\mathbf{b}_1, \\mathbf{b}_2 \\rangle}{\\|\\mathbf{b}_1\\|^2} \\right\\rceil$（最近整数），并替换 $\\mathbf{b}_2 \\leftarrow \\mathbf{b}_2 - \\mu \\mathbf{b}_1$。\n  - 当 $|\\langle \\mathbf{b}_1, \\mathbf{b}_2 \\rangle| \\le \\frac{1}{2} \\|\\mathbf{b}_1\\|^2$ 且 $\\|\\mathbf{b}_1\\| \\le \\|\\mathbf{b}_2\\|$ 时终止。\n- 得到的第一个基向量是该二维格中的一个最短非零向量。根据上面的闵可夫斯基论证，其范数的平方严格小于 $2p$，因此它得到 $x^2 + y^2 = p$。\n\n第5步：规范化。\n- 为了使输出唯一，通过变号并在需要时交换坐标来转换 $(x,y)$，以使得 $x \\ge 0$，$y \\ge 0$，且 $x \\le y$。\n\n算法总结（结合原理与计算）：\n- 对 $n \\equiv -1 \\pmod{p}$ 使用 Tonelli–Shanks 算法找到满足 $a^2 \\equiv -1 \\pmod{p}$ 的 $a$。\n- 形成格基 $\\mathbf{b}_1 = (a,1)$，$\\mathbf{b}_2 = (p,0)$。\n- 应用高斯规约得到 $\\Lambda$ 中的一个最短非零向量 $(x,y)$。\n- 根据模性质和闵可夫斯基界，验证 $x^2 + y^2 = p$。\n- 将 $(x,y)$ 规范化为非负、有序的形式。\n\n正确性证明：\n- $a$ 的存在性源于 $p \\equiv 1 \\pmod{4}$ 和欧拉准则；Tonelli–Shanks 算法在 $\\log p$ 的多项式时间内计算出它。\n- 格 $\\Lambda$ 的协体积为 $p$；根据闵可夫斯基定理，存在一个范数平方小于 $2p$ 的非零点。\n- 对于这样的 $(x,y)$，$x^2 + y^2$ 是 $p$ 的一个正倍数且小于 $2p$，因此等于 $p$。\n- 高斯规约在二维中能找到最短向量，因此它能找到一个达到严格界限的向量。\n\n测试套件和输出：\n- 将该算法应用于 $p \\in \\{5, 13, 29, 37, 97, 101\\}$。\n- 输出一个单行字符串，该字符串是一个 Python 列表，其中包含按所列素数顺序排列的配对 $[x,y]$（其中 $x \\ge 0$，$y \\ge 0$，$x \\le y$）。", "answer": "[[1, 2], [2, 3], [2, 5], [1, 6], [4, 9], [1, 10]]", "id": "3081159"}]}