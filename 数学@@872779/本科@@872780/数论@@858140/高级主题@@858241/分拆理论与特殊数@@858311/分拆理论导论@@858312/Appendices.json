{"hands_on_practices": [{"introduction": "整数分拆理论中最优美且基础的工具之一是费勒斯图。这个练习将引导你通过构造和变换这些直观的图形，来发现一个深刻的对偶关系。你将亲手验证一个经典的组合学结论：一个整数 $n$ 的分拆中部分数不超过 $m$ 的分拆数量，等于其最大部分不超过 $m$ 的分拆数量，从而体会到共轭变换在建立一一对应中的巧妙作用。[@problem_id:3086504]", "problem": "设 $n$ 是一个正整数，一个 $n$ 的划分是一个和为 $n$ 的非递增正整数有限序列。一个划分的费勒斯图是左对齐的点阵，每个部分对应一行，其中第 $i$ 行的点的数量等于第 $i$ 个部分。一个划分的共轭被定义为其费勒斯图通过转置原始费勒斯图（交换行和列）得到的划分。\n\n对于 $m=3$ 和 $n=7$，仅根据这些定义：\n- 通过明确列出所有部分数至多为 $3$ 的 $n=7$ 的划分。\n- 对每个这样的划分，通过费勒斯图转置构造其共轭划分，并验证其共轭划分的最大部分至多为 $3$。\n- 从费勒斯图的角度简要说明，为什么这个共轭映射给出了“$n$ 的部分数至多为 $m$ 的划分”与“$n$ 的最大部分至多为 $m$ 的划分”之间的一一对应关系。\n- 确定当 $m=3$ 和 $n=7$ 时，这两个划分族的共同基数。\n\n提供最终答案，即这个共同基数，形式为一个整数。无需四舍五入。", "solution": "该问题经验证是合理的。这是一个在数论领域中提法恰当、内容完整的问题，具体涉及初等划分理论。所有术语都是标准的，任务是明确的。\n\n问题要求分析在与整数 $m=3$ 相关的约束条件下，整数 $n=7$ 的划分。一个正整数 $n$ 的划分是一个非递增正整数序列 $\\lambda = (\\lambda_1, \\lambda_2, \\dots, \\lambda_k)$，满足 $\\sum_{i=1}^{k} \\lambda_i = n$。整数 $\\lambda_i$ 被称为划分的部分。\n\n该问题涉及四个连续的任务。\n\n首先，我们必须枚举所有部分数至多为 $m=3$ 的 $n=7$ 的划分。这意味着我们正在寻找具有一个、两个或三个部分的划分。\n\n部分数为 $1$ 的划分：\n只有一个这样的划分，其唯一的部分必须是 $7$。\n$\\bullet (7)$\n\n部分数为 $2$ 的划分：\n我们需要找到数对 $(\\lambda_1, \\lambda_2)$，满足 $\\lambda_1 + \\lambda_2 = 7$ 和 $\\lambda_1 \\ge \\lambda_2 \\ge 1$。\n如果 $\\lambda_1 = 6$，则 $\\lambda_2 = 1$。得到 $(6,1)$。\n如果 $\\lambda_1 = 5$，则 $\\lambda_2 = 2$。得到 $(5,2)$。\n如果 $\\lambda_1 = 4$，则 $\\lambda_2 = 3$。得到 $(4,3)$。\n如果 $\\lambda_1$ 是 $3$，$\\lambda_2$ 将是 $4$，这违反了 $\\lambda_1 \\ge \\lambda_2$。\n所以，部分数为 $2$ 的划分是：\n$\\bullet (6,1)$\n$\\bullet (5,2)$\n$\\bullet (4,3)$\n\n部分数为 $3$ 的划分：\n我们需要找到三元组 $(\\lambda_1, \\lambda_2, \\lambda_3)$，满足 $\\lambda_1 + \\lambda_2 + \\lambda_3 = 7$ 和 $\\lambda_1 \\ge \\lambda_2 \\ge \\lambda_3 \\ge 1$。\n如果 $\\lambda_1 = 5$，则 $\\lambda_2 + \\lambda_3 = 2$。由于 $\\lambda_2 \\ge \\lambda_3 \\ge 1$，唯一的解是 $\\lambda_2 = 1, \\lambda_3 = 1$。得到 $(5,1,1)$。\n如果 $\\lambda_1 = 4$，则 $\\lambda_2 + \\lambda_3 = 3$。由于 $4 \\ge \\lambda_2 \\ge \\lambda_3 \\ge 1$ 且 $\\lambda_2 \\ge \\lceil 3/2 \\rceil = 2$，我们必须有 $\\lambda_2=2$，这意味着 $\\lambda_3=1$。得到 $(4,2,1)$。\n如果 $\\lambda_1 = 3$，则 $\\lambda_2 + \\lambda_3 = 4$。由于 $3 \\ge \\lambda_2 \\ge \\lambda_3 \\ge 1$ 且 $\\lambda_2 \\ge \\lceil 4/2 \\rceil = 2$，我们可以有 $\\lambda_2 = 3$（因此 $\\lambda_3=1$）或 $\\lambda_2=2$（因此 $\\lambda_3=2$）。得到 $(3,3,1)$ 和 $(3,2,2)$。\n如果 $\\lambda_1$ 是 $2$，三个部分（每个至多为 $2$）的和最多为 $2+2+2=6$，小于 $7$。\n所以，部分数为 $3$ 的划分是：\n$\\bullet (5,1,1)$\n$\\bullet (4,2,1)$\n$\\bullet (3,3,1)$\n$\\bullet (3,2,2)$\n\n综合这些列表，所有部分数至多为 $m=3$ 的 $n=7$ 的划分的集合是：\n$(7)$, $(6,1)$, $(5,2)$, $(4,3)$, $(5,1,1)$, $(4,2,1)$, $(3,3,1)$, $(3,2,2)$。\n\n其次，对这些划分中的每一个，我们构造其共轭划分，并验证共轭划分的最大部分至多为 $3$。一个划分 $\\lambda$ 的共轭划分 $\\lambda'$ 是通过转置 $\\lambda$ 的费勒斯-杨图得到的。$\\lambda'$ 的第 $j$ 个部分是 $\\lambda$ 中大于或等于 $j$ 的部分数量。\n让我们分析每个划分：\n1. $\\lambda = (7)$。其图是一个包含 $7$ 个点的行。转置后得到 $7$ 行，每行 $1$ 个点。共轭划分为 $\\lambda' = (1,1,1,1,1,1,1)$。最大部分为 $1$，满足 $\\le 3$。\n2. $\\lambda = (6,1)$。其图有一个含 $6$ 个点的行和一个含 $1$ 个点的行。各列的大小为 $2,1,1,1,1,1$。共轭划分为 $\\lambda' = (2,1,1,1,1,1)$。最大部分为 $2$，满足 $\\le 3$。\n3. $\\lambda = (5,2)$。其图有一个含 $5$ 个点的行和一个含 $2$ 个点的行。各列的大小为 $2,2,1,1,1$。共轭划分为 $\\lambda' = (2,2,1,1,1)$。最大部分为 $2$，满足 $\\le 3$。\n4. $\\lambda = (4,3)$。其图有一个含 $4$ 个点的行和一个含 $3$ 个点的行。各列的大小为 $2,2,2,1$。共轭划分为 $\\lambda' = (2,2,2,1)$。最大部分为 $2$，满足 $\\le 3$。\n5. $\\lambda = (5,1,1)$。其图有含 $5,1,1$ 个点的行。各列的大小为 $3,1,1,1,1$。共轭划分为 $\\lambda' = (3,1,1,1,1)$。最大部分为 $3$，满足 $\\le 3$。\n6. $\\lambda = (4,2,1)$。其图有含 $4,2,1$ 个点的行。各列的大小为 $3,2,1,1$。共轭划分为 $\\lambda' = (3,2,1,1)$。最大部分为 $3$，满足 $\\le 3$。\n7. $\\lambda = (3,3,1)$。其图有含 $3,3,1$ 个点的行。各列的大小为 $3,2,2$。共轭划分为 $\\lambda' = (3,2,2)$。最大部分为 $3$，满足 $\\le 3$。\n8. $\\lambda = (3,2,2)$。其图有含 $3,2,2$ 个点的行。各列的大小为 $3,3,1$。共轭划分为 $\\lambda' = (3,3,1)$。最大部分为 $3$，满足 $\\le 3$。\n\n在所有情况下，共轭划分的最大部分都至多为 $m=3$，符合要求。\n\n第三，我们说明为什么共轭是“$n$ 的部分数至多为 $m$ 的划分”与“$n$ 的最大部分至多为 $m$ 的划分”之间的一一对应关系。\n设 $S_A$ 是 $n$ 的部分数至多为 $m$ 的划分的集合。设 $S_B$ 是 $n$ 的最大部分至多为 $m$ 的划分的集合。设 $C$ 是共轭映射，$C(\\lambda) = \\lambda'$。\n- 设 $\\lambda \\in S_A$。$\\lambda$ 的部分数至多为 $m$。一个划分的部分数对应于其费勒斯图中的行数。因此，$\\lambda$ 的图至多有 $m$ 行。当我们转置该图得到 $\\lambda'$ 的图时，$\\lambda$ 的行数变成了 $\\lambda'$ 图的第一列的点数，这又等于 $\\lambda'$ 的第一行的点数。$\\lambda'$ 第一行的点数是其最大的部分 $\\lambda'_1$。因此，$\\lambda'_1$ 等于 $\\lambda$ 的部分数。由于 $\\lambda$ 的部分数 $\\le m$，我们有 $\\lambda'_1 \\le m$。这意味着 $\\lambda' \\in S_B$。所以，映射 $C$ 将 $S_A$ 映射到 $S_B$。\n- 设 $\\mu \\in S_B$。$\\mu$ 的最大部分至多为 $m$，即 $\\mu_1 \\le m$。一个划分的最大部分对应于其费勒斯图第一行的点数，也即图中的列数。所以，$\\mu$ 的图至多有 $m$ 列。当我们转置该图得到其共轭 $\\mu'$ 的图时，$\\mu$ 的列数变成了 $\\mu'$ 的行数。$\\mu'$ 的行数就是 $\\mu'$ 的部分数。因此，$\\mu'$ 的部分数等于 $\\mu$ 的最大部分 $\\mu_1$。由于 $\\mu_1 \\le m$，$\\mu'$ 的部分数至多为 $m$。这意味着 $\\mu' \\in S_A$。所以，映射 $C$ 也将 $S_B$ 映射到 $S_A$。\n- 共轭映射是一个对合，这意味着应用两次会返回原始划分：$C(C(\\lambda)) = (\\lambda')' = \\lambda$。这是因为将一个矩阵转置两次会得到原始矩阵。由于 $C$ 将 $S_A$ 映射到 $S_B$，且其逆映射（即 $C$ 本身）将 $S_B$ 映射到 $S_A$，所以映射 $C$ 是集合 $S_A$ 和 $S_B$ 之间的一个双射，或一一对应关系。\n\n第四，我们确定当 $n=7$ 和 $m=3$ 时，这两个划分族的共同基数。\n在第一步中，我们明确地枚举了部分数至多为 $m=3$ 的 $n=7$ 的划分集合。其成员为 $(7)$、$(6,1)$、$(5,2)$、$(4,3)$、$(5,1,1)$、$(4,2,1)$、$(3,3,1)$ 和 $(3,2,2)$。\n计算这些划分的数量，我们发现有 $8$ 个。\n由于共轭是“$n$ 的部分数至多为 $m$ 的划分”集合与“$n$ 的最大部分至多为 $m$ 的划分”集合之间的一个双射，这两个集合的大小必须相同。因此，它们的共同基数是 $8$。\n作为检验，最大部分至多为 $3$ 的 $7$ 的划分有：\n$(3,3,1)$, $(3,2,2)$, $(3,2,1,1)$, $(3,1,1,1,1)$, $(2,2,2,1)$, $(2,2,1,1,1)$, $(2,1,1,1,1,1)$, 和 $(1,1,1,1,1,1,1)$。\n确实有 $8$ 个这样的划分，这证实了我们的结果。\n\n共同基数是找到的划分数量。\n划分数量 = $1$ (1个部分) $+ 3$ (2个部分) $+ 4$ (3个部分) $= 8$。\n最终答案是 $8$。", "answer": "$$\\boxed{8}$$", "id": "3086504"}, {"introduction": "计算分拆函数 $p(n)$ 的值是该领域的一项核心任务，而欧拉的五边形数定理为此提供了一个强大的递推公式。这个练习将带你应用这一著名公式，逐步计算出特定 $p(n)$ 的值。更重要的是，通过这些计算，你将有机会亲眼见证拉马努金发现的惊人同余性质，初步窥探分拆数序列背后隐藏的算术规律。[@problem_id:3086544]", "problem": "设 $p(n)$ 表示 $n$ 的整数分拆数，即，将 $n$ 写成正整数之和且不考虑顺序的方法数。仅使用关于分拆的生成函数的基本定义和经过充分验证的事实，确定 $p(4)$、$p(9)$ 和 $p(14)$ 的精确值，并严格验证同余式 $p(4) \\equiv 0 \\pmod{5}$、$p(9) \\equiv 0 \\pmod{5}$ 和 $p(14) \\equiv 0 \\pmod{5}$。将你的最终答案报告为单个整数 $p(4)+p(9)+p(14)$。将最终答案表示为精确整数；不需要四舍五入。", "solution": "问题要求计算分拆函数值 $p(4)$、$p(9)$ 和 $p(14)$，验证特定的同余式，并计算这些值的和。分拆函数 $p(n)$ 计算将一个正整数 $n$ 写成正整数之和的方法数，其中加数的顺序无关紧要。\n\n分拆理论中的一个基本且经过充分验证的事实是 $p(n)$ 的生成函数，记为 $P(x)$，由 Euler 的乘积公式给出：\n$$ P(x) = \\sum_{n=0}^{\\infty} p(n)x^n = \\prod_{k=1}^{\\infty} \\frac{1}{1-x^k} $$\n根据定义，$p(0)=1$。$p(n)$ 的值是 $P(x)$ 级数展开式中 $x^n$ 项的系数。虽然这些系数可以通过直接展开乘积来找到，但对于较大的 $n$ 值，计算量会变得非常大。\n\n一种更有效的方法是使用从 Euler 的五边形数定理导出的递推关系，这也基于一个关于生成函数的经过充分验证的事实。该定理表明：\n$$ \\prod_{k=1}^{\\infty} (1-x^k) = \\sum_{j=-\\infty}^{\\infty} (-1)^j x^{g_j} = 1 + \\sum_{j=1}^{\\infty} (-1)^j (x^{g_j} + x^{g_{-j}}) $$\n其中 $g_j = \\frac{j(3j-1)}{2}$ 是广义五边形数。对于 $j \\ge 1$ 的前几个值是 $g_1=1, g_2=5, g_3=12, g_4=22, \\dots$，以及 $g_{-1}=2, g_{-2}=7, g_{-3}=15, g_{-4}=28, \\dots$。\n\n由于 $P(x) = \\left( \\prod_{k=1}^{\\infty} (1-x^k) \\right)^{-1}$，我们有恒等式：\n$$ \\left( \\sum_{n=0}^{\\infty} p(n)x^n \\right) \\left( 1 - x - x^2 + x^5 + x^7 - x^{12} - x^{15} + \\dots \\right) = 1 $$\n通过将两边 $n > 0$ 时 $x^n$ 的系数设为零，我们得到 Euler 关于 $p(n)$ 的递推关系：\n$$ p(n) - p(n-1) - p(n-2) + p(n-5) + p(n-7) - \\dots = 0 $$\n或者，更方便地，\n$$ p(n) = p(n-1) + p(n-2) - p(n-5) - p(n-7) + p(n-12) + p(n-15) - \\dots $$\n求和遍及所有小于或等于 $n$ 的广义五边形数。我们现在使用这个递推关系来计算直到 $n=14$ 的 $p(n)$，从 $p(0)=1$ 开始。\n\n$p(1) = p(1-1) = p(0) = 1$\n$p(2) = p(2-1) + p(2-2) = p(1) + p(0) = 1+1=2$\n$p(3) = p(3-1) + p(3-2) = p(2) + p(1) = 2+1=3$\n$p(4) = p(4-1) + p(4-2) = p(3) + p(2) = 3+2=5$\n$p(5) = p(5-1) + p(5-2) - p(5-5) = p(4) + p(3) - p(0) = 5+3-1=7$\n$p(6) = p(6-1) + p(6-2) - p(6-5) = p(5) + p(4) - p(1) = 7+5-1=11$\n$p(7) = p(7-1) + p(7-2) - p(7-5) - p(7-7) = p(6) + p(5) - p(2) - p(0) = 11+7-2-1=15$\n$p(8) = p(8-1) + p(8-2) - p(8-5) - p(8-7) = p(7) + p(6) - p(3) - p(1) = 15+11-3-1=22$\n$p(9) = p(9-1) + p(9-2) - p(9-5) - p(9-7) = p(8) + p(7) - p(4) - p(2) = 22+15-5-2=30$\n$p(10) = p(10-1) + p(10-2) - p(10-5) - p(10-7) = p(9) + p(8) - p(5) - p(3) = 30+22-7-3=42$\n$p(11) = p(11-1) + p(11-2) - p(11-5) - p(11-7) = p(10) + p(9) - p(6) - p(4) = 42+30-11-5=56$\n$p(12) = p(12-1) + p(12-2) - p(12-5) - p(12-7) + p(12-12) = p(11) + p(10) - p(7) - p(5) + p(0) = 56+42-15-7+1=77$\n$p(13) = p(13-1) + p(13-2) - p(13-5) - p(13-7) + p(13-12) = p(12) + p(11) - p(8) - p(6) + p(1) = 77+56-22-11+1=101$\n$p(14) = p(14-1) + p(14-2) - p(14-5) - p(14-7) + p(14-12) = p(13) + p(12) - p(9) - p(7) + p(2) = 101+77-30-15+2=135$\n\n通过这些计算，我们确定了所需的值：\n$p(4) = 5$\n$p(9) = 30$\n$p(14) = 135$\n\n接下来，我们严格验证指定的同余式。\n对于 $p(4)$：我们有 $p(4) = 5$。由于 $5 = 1 \\cdot 5 + 0$，显然 $p(4) \\equiv 0 \\pmod{5}$。\n对于 $p(9)$：我们有 $p(9) = 30$。由于 $30 = 6 \\cdot 5 + 0$，显然 $p(9) \\equiv 0 \\pmod{5}$。\n对于 $p(14)$：我们有 $p(14) = 135$。由于 $135$ 的个位数字是 $5$，它可以被 $5$ 整除。明确地说，$135 = 27 \\cdot 5 + 0$，所以 $p(14) \\equiv 0 \\pmod{5}$。\n验证完成。这些结果是著名的 Ramanujan 同余式 $p(5k+4) \\equiv 0 \\pmod{5}$ 在 $k=0, 1, 2$ 时的特例。\n\n最后，我们计算和 $p(4) + p(9) + p(14)$：\n$$ p(4) + p(9) + p(14) = 5 + 30 + 135 = 170 $$", "answer": "$$\\boxed{170}$$", "id": "3086544"}, {"introduction": "生成函数不仅是理论工具，也是强大的计算框架。本练习将让你从算法的角度来理解分拆函数的生成函数，通过编写程序直接从其定义出发来提取系数。你将实现一个截断乘积的近似方法和一个精确计算方法，并比较它们的结果，从而深入理解生成函数如何从一个抽象的无穷乘积转化为具体的计算过程。[@problem_id:3086557]", "problem": "考虑整数分拆函数 $p(n)$，它计算了将非负整数 $n$ 写成正整数之和（不考虑顺序）的方法数。整数分拆理论中的一个基础工具是普通生成函数\n$$\nP(q) \\;=\\; \\sum_{n=0}^{\\infty} p(n)\\,q^n \\;=\\; \\prod_{k=1}^{\\infty} \\frac{1}{1 - q^k}.\n$$\n根据定义，提取 $P(q)$ 中 $q^n$ 的系数即可得到 $p(n)$。在实践中，系数提取可以通过将截断级数相乘至一个固定的最大次数来实现。将无限乘积截断为有限个因子可以提供一个估计值：对于一个截断值 $K$，截断生成函数\n$$\nP_K(q) \\;=\\; \\prod_{k=1}^{K} \\frac{1}{1 - q^k}\n$$\n其系数计算的是分拆部分取自集合 $\\{1,2,\\dots,K\\}$ 的分拆数量，因此当存在包含大于 $K$ 的部分的 $n$ 的分拆时，$P_K(q)$ 中 $q^n$ 的系数是 $p(n)$ 的一个低估值。\n\n你的任务是以两种方式实现 $P(q)$ 的系数提取：\n- 使用截断乘积 $P_{K}(q)$（截断值 $K = 10$）进行估计，通过提取最高到 $n$ 次的 $q^n$ 的系数。\n- 使用完整的生成函数逻辑精确计算 $p(n)$，利用以下事实：对于 $q^n$ 的系数，因子中 $k > n$ 的项没有贡献，因此在 $K = n$ 处截断会得到 $P(q)$ 中 $q^n$ 的精确系数。\n\n算法要求：\n- 完全在整系数多项式环中进行运算，并截断到 $n$ 次。对每个因子 $\\frac{1}{1 - q^k}$，使用其几何级数展开 $\\sum_{m=0}^{\\lfloor n/k \\rfloor} q^{km}$，并将其乘入当前的多项式，只保留最高到 $n$ 次的项。\n- 实现一个清晰的系数提取例程，该例程在给定目标 $n$ 和截断值 $K$ 的情况下，返回在 $\\prod_{k=1}^{K} \\frac{1}{1 - q^k}$（截断到 $n$ 次）中 $q^n$ 的系数。\n\n测试套件：\n在以下目标次数 $n$ 的集合上评估程序：\n- $n = 0$（边界情况），\n- $n = 1$（最小正数情况），\n- $n = 10$（截断值 $K = 10$ 足以得到精确值的情况），\n- $n = 11$（首次可能出现大于 10 的分拆部分的情况），\n- $n = 15$（本任务中主要关注的情况）。\n\n对于每个测试用例 $n$，计算：\n- 截断估计值 $\\hat{p}_{10}(n)$，即 $P_{10}(q)$ 中 $q^n$ 的系数，\n- 精确值 $p(n)$，即 $P_{n}(q)$ 中 $q^n$ 的系数，以及\n- 差值 $p(n) - \\hat{p}_{10}(n)$。\n\n答案规范：\n- 对于每个测试用例 $n$，生成一个包含三个整数的列表 $[\\hat{p}_{10}(n), p(n), p(n) - \\hat{p}_{10}(n)]$。\n- 将所有测试用例的结果汇总到单行输出中，形式为用方括号括起来的逗号分隔列表，例如 $[[a,b,c],[d,e,f]]$。\n- 不涉及物理单位或角度。所有输出均为整数。\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如 $[result_1,result_2,\\dots]$），其中每个 $result_i$ 是对应测试套件中 $n_i$ 的列表 $[\\hat{p}_{10}(n_i), p(n_i), p(n_i) - \\hat{p}_{10}(n_i)]$。", "solution": "### 第 1 步：提取已知信息\n- **分拆函数**：$p(n)$ 计算将一个非负整数 $n$ 写成正整数之和（不考虑顺序）的方法数。\n- **普通生成函数**：$P(q) = \\sum_{n=0}^{\\infty} p(n)q^n = \\prod_{k=1}^{\\infty} \\frac{1}{1 - q^k}$。\n- **截断生成函数**：$P_K(q) = \\prod_{k=1}^{K} \\frac{1}{1 - q^k}$。$P_K(q)$ 中 $q^n$ 的系数计算的是 $n$ 的分拆数，其分拆部分来自集合 $\\{1, 2, \\dots, K\\}$。\n- **任务 1（估计）**：通过从 $P_{10}(q)$ 中提取 $q^n$ 的系数来计算估计值 $\\hat{p}_{10}(n)$。\n- **任务 2（精确）**：通过从 $P(q)$ 中提取 $q^n$ 的系数来计算精确值 $p(n)$，利用在 $K=n$ 处截断即足够的事实，即使用 $P_n(q)$。\n- **算法要求**：对每个因子 $\\frac{1}{1 - q^k}$，使用其几何级数展开 $\\sum_{m=0}^{\\lfloor n/k \\rfloor} q^{km}$ 并乘入当前的多项式乘积，将所有结果截断到 $n$ 次。\n- **测试套件**：$n \\in \\{0, 1, 10, 11, 15\\}$。\n- **输出规范**：对每个 $n$，生成一个列表 $[\\hat{p}_{10}(n), p(n), p(n) - \\hat{p}_{10}(n)]$。将所有结果汇总成一个由列表组成的逗号分隔列表，例如 $[[a,b,c],[d,e,f]]$。\n\n### 第 2 步：使用提取的已知信息进行验证\n问题陈述是计算数论中一个明确定义的练习。\n- **科学依据**：整数分拆函数 $p(n)$ 及其生成函数 $P(q)$ 的定义和性质是组合数学和数论中的标准和基本概念。欧拉乘积公式 $P(q) = \\prod_{k=1}^{\\infty} (1 - q^k)^{-1}$ 是该领域的基石。对截断乘积 $P_K(q)$ 系数的解释也是正确的。对于 $q^n$ 的系数，只有 $k \\le n$ 的部分才能有贡献，因此使用 $P_n(q)$ 足以计算 $p(n)$ 的逻辑是合理的。该问题在数学上和事实上都是正确的。\n- **适定性**：该问题提供了明确的目标（计算与 $p(n)$ 相关的特定值）、特定的输入（$n$ 的测试套件）以及一个要实现的清晰算法。预期的输出格式有精确的定义。存在一个唯一且有意义的解。\n- **客观性**：该问题使用客观的数学语言表述，没有歧义、主观性或个人观点。\n\n### 第 3 步：结论与行动\n该问题是有效的。将提供一个完整的解决方案。\n\n### 基于原理的解决方案\n该问题要求从整数分拆的生成函数 $P(q)$ 中提取系数。该生成函数以无限乘积的形式给出：\n$$\nP(q) = \\sum_{n=0}^{\\infty} p(n)q^n = \\prod_{k=1}^{\\infty} \\frac{1}{1 - q^k}\n$$\n$P(q)$ 级数展开中 $q^n$ 的系数是 $p(n)$。任务是通过处理截断到最大次数的多项式来计算这些系数。一个多项式 $A(q) = \\sum_{i=0}^{N} a_i q^i$ 可以用其系数数组 $[a_0, a_1, \\dots, a_N]$ 来表示。\n\n计算基于迭代构建截断乘积 $P_K(q) = \\prod_{k=1}^{K} \\frac{1}{1 - q^k}$。我们从 $P_0(q)=1$ 开始。然后，对于从 1 到 $K$ 的每个 $k$，我们从 $P_{k-1}(q)$ 计算 $P_k(q)$：\n$$\nP_k(q) = P_{k-1}(q) \\cdot \\frac{1}{1 - q^k}\n$$\n因子 $\\frac{1}{1 - q^k}$ 展开为几何级数：\n$$\n\\frac{1}{1 - q^k} = 1 + q^k + q^{2k} + q^{3k} + \\dots = \\sum_{m=0}^{\\infty} q^{mk}\n$$\n令 $c^{(k)}_n$ 为 $P_k(q)$ 展开式中 $q^n$ 的系数。则 $P_k(q) = \\sum_{n=0}^\\infty c^{(k)}_n q^n$。关系式 $P_k(q) = P_{k-1}(q) \\cdot \\sum_{m=0}^{\\infty} q^{mk}$ 意味着系数存在一个递推关系。通过令等式两边 $q^n$ 的系数相等，我们得到：\n$$\nc^{(k)}_n = [q^n] \\left( \\left( \\sum_{j=0}^{\\infty} c^{(k-1)}_j q^j \\right) \\left( \\sum_{m=0}^{\\infty} q^{mk} \\right) \\right) = \\sum_{m=0}^{\\lfloor n/k \\rfloor} c^{(k-1)}_{n-mk}\n$$\n这给出了关系式 $c^{(k)}_n = c^{(k-1)}_n + c^{(k-1)}_{n-k} + c^{(k-1)}_{n-2k} + \\dots$。\n我们可以推导出一个更高效的递推关系。注意到：\n$$\nc^{(k)}_{n-k} = c^{(k-1)}_{n-k} + c^{(k-1)}_{n-2k} + \\dots\n$$\n将此代入 $c^{(k)}_n$ 的表达式中，得到一个简单的递推关系：\n$$\nc^{(k)}_n = c^{(k-1)}_n + c^{(k)}_{n-k}\n$$\n这个递推关系是我们动态规划算法的基础。我们维护一个大小为 $n_{max}+1$ 的系数数组 `coeffs`，其中 $n_{max}$ 是最高的目标次数。让这个数组保存系数 $c^{(k-1)}_j$，其中 $j=0, \\dots, n_{max}$。为了计算系数 $c^{(k)}_j$，我们可以原地更新数组。通过从 $k$ 到 $n_{max}$ 迭代 $j$ 并应用更新 `coeffs[j] = coeffs[j] + coeffs[j-k]` 来实现递推关系 $c^{(k)}_j = c^{(k-1)}_j + c^{(k)}_{j-k}$。外层循环从 1 到截断值 $K$ 迭代 $k$。\n\n算法如下：\n1.  初始化一个大小为 $n+1$ 的整数数组 `coeffs`，其中 `coeffs[0] = 1`，对于 $i > 0$ 则 `coeffs[i] = 0`。这代表 $P_0(q)=1$。\n2.  用 $k$ 从 1 迭代到指定的截断值 $K$。\n3.  对于每个 $k$，用 $j$ 从 $k$ 迭代到 $n$。\n4.  使用递推关系更新索引 $j$ 处的系数：`coeffs[j] = coeffs[j] + coeffs[j-k]`。\n5.  循环完成后，`coeffs[n]` 保存了 $P_K(q)$ 中 $q^n$ 的期望系数。\n\n这个过程被封装在一个函数 `compute_partition_coefficient(target_n, cutoff_K)` 中。\n\n对于测试套件 $\\{0, 1, 10, 11, 15\\}$ 中的每个测试用例 $n$：\n- 通过调用函数 `target_n = n` 和 `cutoff_K = 10` 来计算估计值 $\\hat{p}_{10}(n)$。\n- 通过调用函数 `target_n = n` 和 `cutoff_K = n` 来计算精确值 $p(n)$。这是有效的，因为 $n$ 的任何分拆都不能包含大于 $n$ 的部分。\n- 然后计算差值 $p(n) - \\hat{p}_{10}(n)$。\n\n最终输出是测试套件中每个 $n$ 的结果列表 $[\\hat{p}_{10}(n), p(n), p(n) - \\hat{p}_{10}(n)]$ 的集合，格式化为单个字符串。", "answer": "[[1,1,0],[1,1,0],[42,42,0],[55,56,1],[164,176,12]]", "id": "3086557"}]}