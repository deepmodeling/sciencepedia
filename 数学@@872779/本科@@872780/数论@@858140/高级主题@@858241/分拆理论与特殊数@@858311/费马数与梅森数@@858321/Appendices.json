{"hands_on_practices": [{"introduction": "费马数的素性检验有一个专门而强大的工具，即由 Théophile Pépin 提出的佩潘检验 (Pépin's test)。这个练习将让你亲手应用这一定理于一个基础案例 $F_1$，通过具体的模幂运算来验证其素性，从而将抽象的理论与实际计算联系起来。通过这个实践，你不仅能掌握一个重要的素性测试方法，还能锻炼在模算术框架下的计算能力。[@problem_id:3085141]", "problem": "令 $F_n$ 表示第 $n$ 个费马数，定义为 $F_n = 2^{2^n} + 1$。费马数有一个由 Pépin 提出的素性判定法，该方法将一个特定的模幂运算的剩余类与 $F_n$ 的素性联系起来。对于 $n = 1$，计算 $3^{(F_1 - 1)/2}$ 模 $F_1$ 的最小非负余数 $r \\in \\{0,1,2,3,4\\}$。然后，解释这个 $r$ 值如何与 $F_1$ 的素性判定法相符。仅报告余数 $r$ 作为你的最终答案。", "solution": "该问题要求计算一个涉及第一个费马数 $F_1$ 的特定模幂运算，并解释其结果如何与 Pépin 素性检验相关联。\n\n首先，我们确定所涉及的量。第 $n$ 个费马数定义为 $F_n = 2^{2^n} + 1$。对于 $n=1$ 的情况，我们有：\n$$F_1 = 2^{2^1} + 1 = 2^2 + 1 = 4 + 1 = 5$$\n问题要求计算表达式 $3^{(F_1 - 1)/2}$ 模 $F_1$ 的最小非负余数 $r$。我们将 $F_1=5$ 的值代入此表达式。需要计算的量是：\n$$3^{(5-1)/2} \\pmod{5}$$\n我们首先计算指数：\n$$\\frac{5-1}{2} = \\frac{4}{2} = 2$$\n因此，模幂运算简化为：\n$$3^2 \\pmod{5}$$\n计算幂，我们得到 $3^2 = 9$。现在我们求 $9$ 模 $5$ 的最小非负余数。\n$$9 = 1 \\cdot 5 + 4$$\n因此，$9 \\equiv 4 \\pmod{5}$。最小非负余数是 $r=4$。\n\n问题的第二部分是解释这个 $r$ 值如何与 Pépin 检验给出的 $F_1$ 的素性判定法相符。Pépin 检验为费马数提供了一个素性条件。对于整数 $n \\ge 1$，该检验指出，费马数 $F_n$ 是素数当且仅当以下同余式成立：\n$$3^{(F_n - 1)/2} \\equiv -1 \\pmod{F_n}$$\n让我们将此检验应用于我们的情况，$n=1$。该检验断言 $F_1$ 是素数当且仅当：\n$$3^{(F_1 - 1)/2} \\equiv -1 \\pmod{F_1}$$\n代入 $F_1=5$，条件变为：\n$$3^{(5-1)/2} \\equiv -1 \\pmod{5}$$\n我们之前的计算表明 $3^{(5-1)/2} \\equiv 4 \\pmod{5}$。Pépin 检验的条件是这个余数应该同余于 $-1$ 模 $5$。我们可以验证情况确实如此，因为 $-1$ 模 $5$ 的最小非负余数是 $4$：\n$$-1 \\equiv -1 + 5 \\equiv 4 \\pmod{5}$$\n由于我们计算出的余数 $r=4$ 与 $-1 \\pmod{5}$ 的值相匹配，Pépin 检验的条件得到满足。因此，该检验意味着 $F_1$ 是一个素数。这与已知事实 $F_1 = 5$ 是一个素数相符。计算出的值 $r=4$ 正是根据此素性判定法确认 $F_1$ 素性的值。", "answer": "$$\\boxed{4}$$", "id": "3085141"}, {"introduction": "现在我们将目光转向梅森数，$M_p = 2^p - 1$。由 Edouard Lucas 提出并由 Derrick Henry Lehmer 改进的卢卡斯-莱默检验（Lucas-Lehmer test, LLT）是确定梅森数素性的黄金标准。这个练习将指导你对梅森数 $M_7$ 执行该检验的迭代计算，亲眼见证序列的最终项如何揭示一个数的素性，这是现代计算数论中寻找巨素数的核心方法之一。[@problem_id:3085172]", "problem": "令 $M_p$ 表示一个梅森数，其定义为 $M_p = 2^p - 1$，其中 $p$ 是一个素数。考虑 $M_7 = 2^7 - 1 = 127$。定义 Lucas–Lehmer 序列 $\\{s_n\\}$ 为 $s_0 = 4$ 且对所有 $n \\geq 0$ 有 $s_{n+1} = s_n^2 - 2$。在模 127 的算术体系下，通过在每个递推步骤后进行取模运算，计算序列项 $s_1, s_2, s_3, s_4, s_5$。然后，确定 $s_5$ 模 127 的最小非负余数。请以 $\\{0,1,\\dots,126\\}$ 中的一个整数作为最终答案。", "solution": "问题要求计算 Lucas–Lehmer 序列中的第 $s_5$ 项，该序列由 $s_0 = 4$ 和 $s_{n+1} = s_n^2 - 2$ 定义，所有算术运算均在模梅森数 $M_7 = 127$ 下进行。目标是找到 $s_5$ 模 127 的最小非负余数。\n\n递推关系为 $s_{n+1} \\equiv s_n^2 - 2 \\pmod{127}$（对于 $n \\ge 0$），初始项为 $s_0 = 4$。\n\n我们逐步计算序列的各项。\n\n对于 $n=0$：\n初始项给定为 $s_0 = 4$。\n\n对于 $n=1$：\n我们使用递推关系计算 $s_1$：\n$$s_1 = s_0^2 - 2 = 4^2 - 2 = 16 - 2 = 14$$\n由于 $14  127$，最小非负余数是 $14$。\n因此，$s_1 \\equiv 14 \\pmod{127}$。\n\n对于 $n=2$：\n我们使用 $s_1$ 的值计算 $s_2$：\n$$s_2 = s_1^2 - 2 = 14^2 - 2 = 196 - 2 = 194$$\n为了求模 127 的余数，我们做除法：$194 = 1 \\times 127 + 67$。\n因此，$s_2 \\equiv 67 \\pmod{127}$。\n\n对于 $n=3$：\n我们使用 $s_2$ 的值计算 $s_3$：\n$$s_3 \\equiv s_2^2 - 2 \\pmod{127}$$\n$$s_3 \\equiv 67^2 - 2 \\pmod{127}$$\n首先，我们计算 $67^2$：$67^2 = 4489$。\n为了求 $4489$ 模 127 的余数，我们做除法：$4489 = 35 \\times 127 + 44$。\n所以，$67^2 \\equiv 44 \\pmod{127}$。\n将此结果代回 $s_3$ 的表达式中：\n$$s_3 \\equiv 44 - 2 = 42 \\pmod{127}$$\n\n对于 $n=4$：\n我们使用 $s_3$ 的值计算 $s_4$：\n$$s_4 \\equiv s_3^2 - 2 \\pmod{127}$$\n$$s_4 \\equiv 42^2 - 2 \\pmod{127}$$\n首先，我们计算 $42^2$：$42^2 = 1764$。\n为了求 $1764$ 模 127 的余数，我们做除法：$1764 = 13 \\times 127 + 113$。\n所以，$42^2 \\equiv 113 \\pmod{127}$。\n将此结果代回 $s_4$ 的表达式中：\n$$s_4 \\equiv 113 - 2 = 111 \\pmod{127}$$\n\n对于 $n=5$：\n最后，我们使用 $s_4$ 的值计算 $s_5$：\n$$s_5 \\equiv s_4^2 - 2 \\pmod{127}$$\n$$s_5 \\equiv 111^2 - 2 \\pmod{127}$$\n为了简化 $111$ 的平方运算，我们可以使用其对应的负余数。$111$ 模 127 的余数也可以表示为 $111 - 127 = -16$。\n所以，$111 \\equiv -16 \\pmod{127}$。\n现在我们可以计算平方：\n$$111^2 \\equiv (-16)^2 = 256 \\pmod{127}$$\n为了求 $256$ 模 127 的余数，我们做除法：$256 = 2 \\times 127 + 2$。\n所以，$111^2 \\equiv 2 \\pmod{127}$。\n将此结果代回 $s_5$ 的表达式中：\n$$s_5 \\equiv 2 - 2 = 0 \\pmod{127}$$\n\n模 127 的余数序列为：\n$s_0 \\equiv 4$\n$s_1 \\equiv 14$\n$s_2 \\equiv 67$\n$s_3 \\equiv 42$\n$s_4 \\equiv 111$\n$s_5 \\equiv 0$\n\n$s_5$ 模 127 的最小非负余数是 $0$。这个结果与用于判断 $M_7=127$ 素性的 Lucas-Lehmer 检验法一致，该检验法指出，$M_p$ 是素数当且仅当 $s_{p-2} \\equiv 0 \\pmod{M_p}$。对于 $p=7$，这意味着我们要检验是否 $s_5 \\equiv 0 \\pmod{M_7}$，我们的计算证实了这一点。", "answer": "$$\\boxed{0}$$", "id": "3085172"}, {"introduction": "卢卡斯-莱默检验的强大之处在于其“当且仅当”的特性，它不仅能证明素数，也能同样确定地证明合数。通过将该检验应用于 $M_{11}$，你将计算出一个非零的结果，从而证明 $M_{11}$ 是一个合数。这个练习旨在通过一个反例来加深你对 LLT 双向判定能力的理解，并展示为何该测试在排除非素数梅森数方面同样高效。[@problem_id:3085190]", "problem": "令 $M_{p}$ 表示素数 $p$ 的 Mersenne 数 $M_{p}=2^{p}-1$。定义 Lucas–Lehmer 序列为 $s_{0}=4$ 且对所有整数 $n \\geq 0$ 有 $s_{n+1}=s_{n}^{2}-2$。Lucas–Lehmer 检验 (LLT) 指出，对于素数 $p \\geq 3$，Mersenne 数 $M_{p}$ 是素数当且仅当 $s_{p-2} \\equiv 0 \\pmod{M_{p}}$。仅使用这些定义和模算术的标准性质，计算 $s_{9}$ 模 $M_{11}$ 的最小非负余数，其中 $M_{11}=2^{11}-1$。完全在模算术内进行运算，通过在每次平方步骤后进行约减来控制增长。然后，根据 Lucas–Lehmer 检验，判断 $M_{11}$ 是素数还是合数。仅报告 $s_{9}$ 模 $M_{11}$ 的最小非负余数作为您的最终答案。无需四舍五入。", "solution": "问题要求计算 $s_{9}$ 模 $M_{11}$ 的最小非负余数，其中 $M_{p} = 2^{p}-1$ 是一个 Mersenne 数，序列 $s_n$ 由 Lucas-Lehmer 递推关系 $s_{n+1} = s_{n}^{2}-2$ 和 $s_{0}=4$ 定义。然后，我们被要求使用此结果，根据 Lucas-Lehmer 检验 (LLT) 来判断 $M_{11}$ 是否为素数。\n\n首先，我们确定该问题的具体参数。素数是 $p=11$。\nMersenne 数是 $M_{11} = 2^{11}-1$。我们计算其值：$2^{10} = 1024$，所以 $2^{11} = 2 \\times 1024 = 2048$。因此，$M_{11} = 2048 - 1 = 2047$。\n\nLucas-Lehmer 序列由 $s_{0}=4$ 和对 $n \\geq 0$ 的 $s_{n+1} = s_{n}^{2}-2$ 给出。我们需要计算该序列直到 $s_9$ 的项，所有计算都在模 $M_{11} = 2047$ 下进行。这意味着我们将计算 $s_{n+1} \\equiv s_{n}^{2}-2 \\pmod{2047}$。\n\n序列以 $s_{0} = 4$ 开始。我们迭代进行：\n\n对于 $n=0$：\n$s_{1} \\equiv s_{0}^{2}-2 \\pmod{2047}$\n$s_{1} \\equiv 4^{2}-2 = 16-2 = 14 \\pmod{2047}$。\n余数是 $14$。\n\n对于 $n=1$：\n$s_{2} \\equiv s_{1}^{2}-2 \\pmod{2047}$\n$s_{2} \\equiv 14^{2}-2 = 196-2 = 194 \\pmod{2047}$。\n余数是 $194$。\n\n对于 $n=2$：\n$s_{3} \\equiv s_{2}^{2}-2 \\pmod{2047}$\n$s_{3} \\equiv 194^{2}-2 = 37636-2 \\pmod{2047}$。\n为了找到 $37636$ 模 $2047$ 的余数，我们进行除法：$37636 = 18 \\times 2047 + 790$。\n所以，$37636 \\equiv 790 \\pmod{2047}$。\n$s_{3} \\equiv 790-2 = 788 \\pmod{2047}$。\n\n对于 $n=3$：\n$s_{4} \\equiv s_{3}^{2}-2 \\pmod{2047}$\n$s_{4} \\equiv 788^{2}-2 = 620944-2 \\pmod{2047}$。\n除法得出 $620944 = 303 \\times 2047 + 703$。\n所以，$620944 \\equiv 703 \\pmod{2047}$。\n$s_{4} \\equiv 703-2 = 701 \\pmod{2047}$。\n\n对于 $n=4$：\n$s_{5} \\equiv s_{4}^{2}-2 \\pmod{2047}$\n$s_{5} \\equiv 701^{2}-2 = 491401-2 \\pmod{2047}$。\n除法得出 $491401 = 240 \\times 2047 + 121$。\n所以，$491401 \\equiv 121 \\pmod{2047}$。\n$s_{5} \\equiv 121-2 = 119 \\pmod{2047}$。\n\n对于 $n=5$：\n$s_{6} \\equiv s_{5}^{2}-2 \\pmod{2047}$\n$s_{6} \\equiv 119^{2}-2 = 14161-2 \\pmod{2047}$。\n除法得出 $14161 = 6 \\times 2047 + 1879$。\n所以，$14161 \\equiv 1879 \\pmod{2047}$。\n$s_{6} \\equiv 1879-2 = 1877 \\pmod{2047}$。\n\n对于 $n=6$：\n$s_{7} \\equiv s_{6}^{2}-2 \\pmod{2047}$\n$s_{7} \\equiv 1877^{2}-2 \\pmod{2047}$。\n我们可以利用 $1877 \\equiv 1877 - 2047 \\equiv -170 \\pmod{2047}$ 这一事实。\n那么 $1877^{2} \\equiv (-170)^{2} = 28900 \\pmod{2047}$。\n除法得出 $28900 = 14 \\times 2047 + 242$。\n所以，$1877^{2} \\equiv 242 \\pmod{2047}$。\n$s_{7} \\equiv 242-2 = 240 \\pmod{2047}$。\n\n对于 $n=7$：\n$s_{8} \\equiv s_{7}^{2}-2 \\pmod{2047}$\n$s_{8} \\equiv 240^{2}-2 = 57600-2 \\pmod{2047}$。\n除法得出 $57600 = 28 \\times 2047 + 284$。\n所以，$57600 \\equiv 284 \\pmod{2047}$。\n$s_{8} \\equiv 284-2 = 282 \\pmod{2047}$。\n\n对于 $n=8$：\n$s_{9} \\equiv s_{8}^{2}-2 \\pmod{2047}$\n$s_{9} \\equiv 282^{2}-2 = 79524-2 \\pmod{2047}$。\n除法得出 $79524 = 38 \\times 2047 + 1738$。\n所以，$79524 \\equiv 1738 \\pmod{2047}$。\n$s_{9} \\equiv 1738-2 = 1736 \\pmod{2047}$。\n\n$s_{9}$ 模 $M_{11}$ 的最小非负余数是 $1736$。\n\nLucas-Lehmer 检验指出，对于一个素数 $p \\geq 3$，$M_p$ 是素数当且仅当 $s_{p-2} \\equiv 0 \\pmod{M_p}$。对于 $p=11$，这个条件是 $s_{11-2} = s_{9} \\equiv 0 \\pmod{M_{11}}$。\n我们的计算表明 $s_{9} \\equiv 1736 \\pmod{2047}$。\n由于 $1736 \\neq 0$，Lucas-Lehmer 检验表明 $M_{11}$ 是合数。\n\n问题要求的是 $s_{9}$ 模 $M_{11}$ 的最小非负余数。这个值是 $1736$。", "answer": "$$\\boxed{1736}$$", "id": "3085190"}]}