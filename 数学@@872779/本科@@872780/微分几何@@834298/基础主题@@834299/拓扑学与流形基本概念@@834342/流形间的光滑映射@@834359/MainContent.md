## 引言
在探索[光滑流形](@entry_id:160799)的几何[世界时](@entry_id:275204)，我们不仅关心单个[流形](@entry_id:153038)的结构，更关心它们之间如何相互作用。[流形](@entry_id:153038)间的[光滑映射](@entry_id:203730)，正如线性代数中的线性变换或群论中的[群同态](@entry_id:140603)，是连接不同几何空间的桥梁，构成了[微分几何](@entry_id:145818)与拓扑学的核心研究对象。然而，如何在没有全局线性结构的弯曲空间上严格定义“[光滑性](@entry_id:634843)”？这正是本文旨在解决的核心问题。

本文将系统地引导读者穿越这一关键领域。在“原理与机制”一章中，我们将利用[流形](@entry_id:153038)的局部欧几里得性质建立[光滑映射](@entry_id:203730)的严格定义，并介绍其线性近似——[微分](@entry_id:158718)，进而根据[微分](@entry_id:158718)的性质对映射进行分类，并阐述[反函数定理](@entry_id:275014)、[常秩定理](@entry_id:159251)和[正则值定理](@entry_id:158611)等基石性成果。随后，在“应用与跨学科联系”一章中，我们将展示这些抽象理论如何在李群、动力系统、物理学和黎曼几何等领域中发挥强大作用。最后，“动手实践”部分将提供具体问题，帮助读者巩固理论知识，并将其应用于解决实际计算问题。通过这三个层次的深入学习，读者将不仅掌握[光滑映射](@entry_id:203730)的理论框架，更能体会到它作为一种通用语言在现代科学中的力量和美感。

## 原理与机制

在前一章中，我们已经建立了[光滑流形](@entry_id:160799)作为欧几里得空间局部推广的严格概念。现在，我们将注意力转向这些对象之间的相互作用，即[流形](@entry_id:153038)之间的[光滑映射](@entry_id:203730)。正如线性变换是[向量空间](@entry_id:151108)理论的核心，[群同态](@entry_id:140603)是群论的核心一样，[光滑映射](@entry_id:203730)构成了微分几何和拓扑学的基本研究对象。本章将深入探讨[光滑映射](@entry_id:203730)的定义、其局部行为的分类，以及一系列深刻的定理，这些定理将[映射的微分](@entry_id:269524)性质与其在局部乃至全局上的几何结构联系起来。

### [光滑映射](@entry_id:203730)的定义

我们如何在两个[流形](@entry_id:153038) $M$ 和 $N$ 之间定义一个映射 $f: M \to N$ 的“[光滑性](@entry_id:634843)”？直接定义是困难的，因为[流形](@entry_id:153038)本身可能没有一个全局的线性结构。然而，其核心思想是利用[流形](@entry_id:153038)的局部欧几里得性质。既然我们已经掌握了[欧几里得空间](@entry_id:138052)之间映射的光滑性（即所有阶的[偏导数](@entry_id:146280)都存在且连续），我们可以通过[坐标卡](@entry_id:262338)将[流形](@entry_id:153038)上的问题转化为欧几里得空间中的问题。

一个连续映射 $f: M \to N$ 被称为在点 $p \in M$ 处是**光滑的**（或 $C^\infty$），如果存在一个包含 $p$ 的 $M$ 上的坐标卡 $(U, \varphi)$ 和一个包含 $f(p)$ 的 $N$ 上的[坐标卡](@entry_id:262338) $(V, \psi)$，使得 $f$ 的**[局部坐标](@entry_id:181200)表示**，即复合映射：
$$ \psi \circ f \circ \varphi^{-1}: \varphi(U \cap f^{-1}(V)) \to \psi(V) $$
是 $\mathbb{R}^m$ 的一个开集到 $\mathbb{R}^n$ 的一个开集之间的[光滑映射](@entry_id:203730)（其中 $m = \dim M, n = \dim N$）。如果 $f$ 在 $M$ 的每一点都光滑，那么我们称 $f$ 是一个**[光滑映射](@entry_id:203730)**。[@problem_id:3033563]

这个定义依赖于“存在”一对坐标卡。一个自然的问题是：这个定义是否依赖于我们所选择的特定[坐标卡](@entry_id:262338)？如果对于另一对坐标卡 $(U', \varphi')$ 和 $(V', \psi')$，局部表示不再光滑怎么办？幸运的是，[流形](@entry_id:153038)的[光滑结构](@entry_id:159394)保证了这种情况不会发生。任何两个兼容的[坐标图](@entry_id:156506)之间的**转换映射**（例如 $\psi' \circ \psi^{-1}$ 和 $\varphi \circ (\varphi')^{-1}$）根据定义都是光滑的。新的局部表示可以通过与转换映射复合来从旧的表示中得到：
$$ \psi' \circ f \circ (\varphi')^{-1} = (\psi' \circ \psi^{-1}) \circ (\psi \circ f \circ \varphi^{-1}) \circ (\varphi \circ (\varphi')^{-1}) $$
由于[光滑映射](@entry_id:203730)的复合仍然是光滑的，如果 $\psi \circ f \circ \varphi^{-1}$ 是光滑的，那么新的局部表示也必然是光滑的。因此，光滑性的定义是内在的，不依赖于[坐标卡](@entry_id:262338)的选择，而是依赖于[流形](@entry_id:153038)的[光滑结构](@entry_id:159394)本身。这引出了一个等价且更强的定义：$f: M \to N$ 是光滑的当且仅当对于 $M$ 和 $N$ 上的*任何*一对坐标卡 $(U, \varphi)$ 和 $(V, \psi)$，局部表示 $\psi \circ f \circ \varphi^{-1}$ 都是光滑的。[@problem_id:3033563]

为了使概念更清晰，我们必须注意，检查光滑性时，仅检查到 $C^1$ 是不够的；必须是无穷阶可微，即 $C^\infty$。并且，[流形](@entry_id:153038)图册中转换映射的[光滑性](@entry_id:634843)是保证此定义自洽性的基石。[@problem_id:3033563]

### [微分](@entry_id:158718)：线性近似

一旦我们确定一个映射是光滑的，我们就可以像在微积分中那样，讨论它的[最佳线性近似](@entry_id:164642)，这就是**[微分](@entry_id:158718)**（或**切映射**）的概念。对于一个[光滑映射](@entry_id:203730) $f: M \to N$ 和一点 $p \in M$，其[微分](@entry_id:158718) $df_p$ 是一个从 $p$ 点的[切空间](@entry_id:199137) $T_pM$ 到 $f(p)$ 点的[切空间](@entry_id:199137) $T_{f(p)}N$ 的[线性映射](@entry_id:185132)：
$$ df_p: T_pM \to T_{f(p)}N $$
这个线性映射捕捉了 $f$ 在 $p$ 点附近的局部行为。在[局部坐标](@entry_id:181200)中，这个映射可以非常具体地表示出来。给定 $M$ 在 $p$ 附近的坐标 $(x^1, \dots, x^m)$ 和 $N$ 在 $f(p)$ 附近的坐标 $(y^1, \dots, y^n)$，映射 $f$ 可以写成 $y^j = f^j(x^1, \dots, x^m)$。那么，[微分](@entry_id:158718) $df_p$ 在由[坐标基](@entry_id:270149)向量 $\{\frac{\partial}{\partial x^i}|_p\}$ 和 $\{\frac{\partial}{\partial y^j}|_{f(p)}\}$ 张成的[切空间](@entry_id:199137)之间，其[矩阵表示](@entry_id:146025)就是我们熟悉的**雅可比矩阵**：
$$ (J_f)_p = \left( \frac{\partial f^j}{\partial x^i}(p) \right) $$
这是一个 $n \times m$ 的矩阵。它的每一列都是一个切向量，具体来说，第 $i$ 列是 $df_p(\frac{\partial}{\partial x^i}|_p)$ 在基 $\{\frac{\partial}{\partial y^j}|_{f(p)}\}$ 下的坐标。

一个经典且重要的例子是**[球极平面投影](@entry_id:142378)**的逆映射 $F: \mathbb{R}^2 \to S^2$，它将平面上的点 $(u,v)$ 映射到[单位球](@entry_id:142558)面上的点。这个映射由分量函数给出。通过计算这些分量函数关于 $u$ 和 $v$ 的偏导数，我们可以得到一个 $3 \times 2$ 的雅可比矩阵，它在每一点 $p=(u,v)$ 都给出了[微分](@entry_id:158718) $dF_p$ 的具体形式。这个矩阵的列向量正是 $T_{F(p)}S^2$ 中的[切向量](@entry_id:265494)，张成了 $dF_p$ 的像空间。[@problem_id:1662669]

与[函数复合](@entry_id:144881)相对应，[微分](@entry_id:158718)遵循**[链式法则](@entry_id:190743)**。如果 $f: M \to N$ 和 $g: N \to P$ 是[光滑映射](@entry_id:203730)，那么复合映射 $g \circ f: M \to P$ 也是光滑的，其[微分](@entry_id:158718)满足：
$$ d(g \circ f)_p = dg_{f(p)} \circ df_p $$
这表明，线性近似的复合就是复合映射的线性近似。这个法则在计算中非常有用。例如，考虑一个从[单位圆](@entry_id:267290) $S^1$ 到自身的复合映射 $H = F \circ \gamma$，其中 $\gamma$ 是一个嵌入，而 $F$ 是一个更复杂的映射。我们可以通过分别计算 $dF$ 和 $d\gamma$，然后将它们的雅可比矩阵相乘，来得到 $dH$ 的[雅可比矩阵](@entry_id:264467)，从而计算出某一切向量在 $dH$ 下的像。[@problem_id:1662652]

### [光滑映射](@entry_id:203730)的分类

[微分](@entry_id:158718) $df_p$ 是一个线性映射，它的代数性质（如[单射性](@entry_id:147722)、满射性）在每一点都深刻地决定了映射 $f$ 的局部几何行为。基于 $df_p$ 的性质，我们可以对[光滑映射](@entry_id:203730)进行分类。

*   **[浸入](@entry_id:161534) (Immersion):** 如果在每一点 $p \in M$，[微分](@entry_id:158718) $df_p$ 都是**单射**的，那么[光滑映射](@entry_id:203730) $f: M \to N$ 被称为一个**浸入**。这意味着 $f$ 在局部不会“压扁”或“折叠”[流形](@entry_id:153038)。为了使 $df_p$ 成为单射，其定义域维数不能超过值域维数，因此[浸入](@entry_id:161534)要求 $\dim M \le \dim N$。一个浸入在局部将 $M$ 的[切空间](@entry_id:199137)同构地映射到 $N$ 的切空间的一个[子空间](@entry_id:150286)上。[@problem_id:2990348]

*   **淹没 (Submersion):** 如果在每一点 $p \in M$，[微分](@entry_id:158718) $df_p$ 都是**满射**的，那么[光滑映射](@entry_id:203730) $f: M \to N$ 被称为一个**淹没**。这意味着 $f$ 在局部“铺满”了目标[流形](@entry_id:153038)。为了使 $df_p$ 成为满射，其定义域维数不能小于值域维数，因此淹没要求 $\dim M \ge \dim N$。[@problem_id:2990348]

*   **[局部微分同胚](@entry_id:203529) (Local Diffeomorphism):** 如果在每一点 $p \in M$，[微分](@entry_id:158718) $df_p$ 都是一个**[线性同构](@entry_id:270529)**（即既[单射](@entry_id:183792)又满射），那么 $f$ 被称为一个**[局部微分同胚](@entry_id:203529)**。这要求 $\dim M = \dim N$。根据线性代数，对于维数相同的[有限维向量空间](@entry_id:265491)之间的[线性映射](@entry_id:185132)，[单射](@entry_id:183792)、满射和同构是等价的。因此，当 $\dim M = \dim N$ 时，浸入、淹没和[局部微分同胚](@entry_id:203529)这三个概念是等价的。[@problem_id:2980349]

*   **嵌入 (Embedding):** 这是一个全局概念。一个[光滑映射](@entry_id:203730) $f: M \to N$ 如果是一个单射的浸入，并且还是其像 $f(M)$ 上的一个同胚（当 $f(M)$ 被赋予 $N$ 的[子空间拓扑](@entry_id:147159)时），则称之为一个**嵌入**。一个嵌入不仅在局部保持了[微分](@entry_id:158718)结构，还在全局上忠实地再现了原[流形的拓扑](@entry_id:267834)结构。

一个映射可以是[局部微分同胚](@entry_id:203529)（因此也是[浸入](@entry_id:161534)），但如果它不是全局单射的，它就不是一个嵌入。一个典型的例子是复平面上的映射 $z \mapsto z^2$ 限制在[单位圆](@entry_id:267290) $S^1$ 上。这个映射 $f: S^1 \to S^1$ 将圆“包裹”了两次。在每一点，它的[微分](@entry_id:158718)都是一个乘以 2 的同构，所以它是一个[局部微分同胚](@entry_id:203529)。然而，它不是[单射](@entry_id:183792)的（例如 $1$ 和 $-1$ 都映射到 $1$），因此它不是一个嵌入。[@problem_id:2980349] 另一个例子是一个[参数曲线](@entry_id:634039)，它在不同的参数值下经过了同一个点，例如一个在 $(0, 4\pi)$ 上定义的描绘三尖瓣线的参数映射，它在 $t$ 和 $t+2\pi$ 处取相同的值，因此不是[单射](@entry_id:183792)的，从而不是嵌入。[@problem_id:1662670]

此外，即使一个映射是光滑的，它也可能在某些点不是[浸入](@entry_id:161534)。这种情况发生在[微分](@entry_id:158718) $df_p$ 的秩在这些点下降时。例如，[参数曲线](@entry_id:634039) $F(t) = (t^2, |t|^3)$ 在 $t=0$ 点的导数是 $(0,0)$，因此在该点不是[浸入](@entry_id:161534)。这个例子还揭示了[光滑性](@entry_id:634843)的细微差别：尽管其分量函数在 $t=0$ 处表现出某种“[尖点](@entry_id:636792)”行为，但映射本身是 $C^2$ 的，只是在 $C^3$ 层面才失去[光滑性](@entry_id:634843)。[@problem_id:1662632]

### 基本定理：预测局部结构

关于[光滑映射](@entry_id:203730)最强大的一系列定理，是那些能够从[微分](@entry_id:158718) $df_p$ 的性质推断出映射 $f$ 本身局部形式的定理。

#### [反函数定理](@entry_id:275014) (The Inverse Function Theorem)
这是最基本的结构定理。它表明，如果 $f: M \to N$ 是一个[光滑映射](@entry_id:203730)，且在点 $p$ 的[微分](@entry_id:158718) $df_p$ 是一个[线性同构](@entry_id:270529)（这要求 $\dim M = \dim N$），那么 $f$ 在 $p$ 的一个邻域内就是一个**[微分同胚](@entry_id:147249)**。这意味着存在 $p$ 的一个开邻域 $U$ 和 $f(p)$ 的一个[开邻域](@entry_id:268496) $V$，使得 $f$ 将 $U$ [微分同胚](@entry_id:147249)地映射到 $V$。

在实际应用中，例如，一位物理学家可能希望引入一个新的[坐标系](@entry_id:156346) $(u,v)$ 来简化对一个物理系统的描述，而这个新[坐标系](@entry_id:156346)通过一个[光滑映射](@entry_id:203730) $F(x,y) = (u(x,y), v(x,y))$ 与旧的笛卡尔坐标 $(x,y)$ 联系起来。要使 $(u,v)$ 在某点附近成为一个有效的[局部坐标系](@entry_id:751394)，映射 $F$ 在该点必须是一个[局部微分同胚](@entry_id:203529)。根据[反函数定理](@entry_id:275014)，这当且仅当 $F$ 在该点的[雅可比矩阵](@entry_id:264467)[行列式](@entry_id:142978)非零。因此，所有使得[雅可比行列式](@entry_id:137120)为零的点构成的集合，就是该坐标变换失效的点集。[@problem_id:1677179]

#### [常秩定理](@entry_id:159251) (The Constant Rank Theorem)
[反函数定理](@entry_id:275014)是[常秩定理](@entry_id:159251)的一个特例。[常秩定理](@entry_id:159251)指出，如果一个[光滑映射](@entry_id:203730) $f: M^m \to N^n$ 在点 $p$ 的一个邻域内具有常数秩 $k$（即 $\text{rank}(df_x) = k$ 对邻域内所有 $x$ 成立），那么总可以找到 $p$ 附近的[局部坐标](@entry_id:181200) $(x_1, \dots, x_m)$ 和 $f(p)$ 附近的[局部坐标](@entry_id:181200) $(y_1, \dots, y_n)$，使得在这些坐标下，$f$ 具有非常简单的标准形式：
$$ f(x_1, \dots, x_m) = (x_1, \dots, x_k, 0, \dots, 0) $$
这个定理揭示了一个深刻的机制：任何具有常秩的[光滑映射](@entry_id:203730)，在局部上都等价于一个线性投影。寻找这些“拉直”映射的坐标变换的过程本身也具有启发性。通常，我们可以通过组合 $f$ 的 $k$ 个分量函数和 $m-k$ 个原始坐标来构造源空间的新[坐标系](@entry_id:156346)，并通过[反函数定理](@entry_id:275014)证明这确实是一个有效的[局部坐标](@entry_id:181200)变换。[@problem_id:2990359]

浸入定理和淹没定理是[常秩定理](@entry_id:159251)的直接推论：
*   **浸入定理**: 如果 $f: M^m \to N^n$ 是一个[浸入](@entry_id:161534)（秩恒为 $m$），那么在每点附近，$f$ 都局部等价于标准包含映射 $(x_1, \dots, x_m) \mapsto (x_1, \dots, x_m, 0, \dots, 0)$。[@problem_id:2990348]
*   **淹没定理**: 如果 $f: M^m \to N^n$ 是一个淹没（秩恒为 $n$），那么在每点附近，$f$ 都局部等价于标准[投影映射](@entry_id:153398) $(x_1, \dots, x_m) \mapsto (x_1, \dots, x_n)$。[@problem_id:2990348]

### [正则值定理](@entry_id:158611)：构造[流形](@entry_id:153038)

淹没定理的一个极其重要的应用是构造新的[流形](@entry_id:153038)。这通过[正则值定理](@entry_id:158611)（也称为[原像定理](@entry_id:637320)）来实现。

首先，我们需要定义一些术语。对于[光滑映射](@entry_id:203730) $f: M \to N$：
*   如果 $df_p$ 是满射，则称点 $p \in M$ 是 $f$ 的一个**正则点**。
*   如果 $df_p$ 不是满射，则称点 $p \in M$ 是 $f$ 的一个**[临界点](@entry_id:144653)**。
*   如果点 $q \in N$ 的原像 $f^{-1}(q)$ 中不包含任何[临界点](@entry_id:144653)（即 $f^{-1}(q)$ 中的每一点都是正则点），则称 $q$ 是 $f$ 的一个**[正则值](@entry_id:161151)**。注意，如果 $f^{-1}(q)$ 是[空集](@entry_id:261946)，那么 $q$ 也被视作[正则值](@entry_id:161151)。
*   如果 $q$ 是至少一个[临界点](@entry_id:144653)的像，则称 $q$ 是一个**临界值**。[@problem_id:2980347]

**[正则值定理](@entry_id:158611) (Regular Value Theorem):**
设 $f: M^m \to N^n$ 是一个[光滑映射](@entry_id:203730)。如果 $q \in N$ 是 $f$ 的一个[正则值](@entry_id:161151)，那么原像（或[水平集](@entry_id:751248)）$f^{-1}(q)$ 是 $M$ 的一个正常[嵌入子流形](@entry_id:273162)，其维数为 $m-n$。此外，对于任意 $p \in f^{-1}(q)$，该子流形的[切空间](@entry_id:199137)由 $df_p$ 的核给出：
$$ T_p(f^{-1}(q)) = \ker(df_p) $$

这个定理是微分几何中构造[流形](@entry_id:153038)最强大的工具之一。一个典型的例子是函数 $f: \mathbb{R}^3 \to \mathbb{R}$ 定义为 $f(x,y,z) = x^2+y^2+z^2$。它的[微分](@entry_id:158718)是 $df_p = \begin{pmatrix} 2x  2y  2z \end{pmatrix}$。这个[微分](@entry_id:158718)只在原点 $p=(0,0,0)$ 处不是满射（即为零映射）。因此，原点是唯一的[临界点](@entry_id:144653)，而 $f(0,0,0)=0$ 是唯一的临界值。对于任何 $q  0$，$q$ 都是一个[正则值](@entry_id:161151)。根据定理，$f^{-1}(q)$ 是 $\mathbb{R}^3$ 中的一个 $3-1=2$ 维[子流形](@entry_id:159439)。我们知道 $f^{-1}(q)$ 就是半径为 $\sqrt{q}$ 的球面，这确实是一个[二维流形](@entry_id:188198)，与定理的预测完全一致。[@problem_id:2990328]

那么，[正则值](@entry_id:161151)是普遍存在的吗？**Sard 定理**给出了肯定的回答。它指出，任何[光滑映射](@entry_id:203730) $f: M \to N$ 的临界值集合在 $N$ 中的[勒贝格测度](@entry_id:139781)为零。直观上讲，这意味着临界值是“稀疏的”，而“几乎所有”的值都是[正则值](@entry_id:161151)。因此，[正则值定理](@entry_id:158611)具有广泛的适用性。例如，对于任何从紧流形（如 $S^2$）到 $\mathbb{R}$ 的[光滑映射](@entry_id:203730)，其临界值集合不可能覆盖整个 $\mathbb{R}$，因为一个测度为零的集合不可能等于测度无穷大的 $\mathbb{R}$。[@problem_id:1660388]

### 全局性质与应用

虽然本章的重点是[光滑映射](@entry_id:203730)的局部性质，但这些局部性质的累积效应决定了全局行为和拓扑不变量。

我们已经看到，一个[局部微分同胚](@entry_id:203529)（如 $f: S^1 \to S^1, z \mapsto z^2$）由于不是全局[单射](@entry_id:183792)而可能不是一个嵌入。这个映射在拓扑上被称为一个**[覆盖映射](@entry_id:169347)**。这个映射的局部性质（[微分](@entry_id:158718)处处非零）与它的全局性质（将圆环绕两圈）之间存在深刻的联系。

这种联系可以通过**[映射度](@entry_id:268707)** (degree of a map) 来量化。对于两个同维度的、紧致、有向的闭[流形](@entry_id:153038)之间的[光滑映射](@entry_id:203730) $f: M \to N$，其[映射度](@entry_id:268707) $\deg(f)$ 是一个整数，直观上衡量了 $f$ 将 $M$ “包裹”到 $N$ 上的次数。它可以通[过积分](@entry_id:753033)来计算：取 $N$ 上的任意一个体积形式 $\omega$（一个处处非零的顶级[微分形式](@entry_id:146747)），其总积分为 $\int_N \omega \neq 0$。[映射度](@entry_id:268707)由以下公式给出：
$$ \deg(f) = \frac{\int_M f^*\omega}{\int_N \omega} $$
其中 $f^*\omega$ 是将 $\omega$ 通过 $f$ [拉回](@entry_id:160816)到 $M$ 上得到的微分形式。对于前面提到的 $S^1$ 上的映射 $f(\theta) = 2\theta$，我们可以取 $S^1$ 上的标准 1-形式 $\omega = d\theta$。通过计算，我们发现 $f^*\omega = d(2\theta) = 2d\theta$。因此，分子上的积分是分母的两倍，得到 $\deg(f)=2$。[@problem_id:2980349] 这个整数[不变量](@entry_id:148850)是一个纯粹的拓扑量，但它可以通过[微分](@entry_id:158718)计算得出，完美地体现了微分几何中分析工具与拓扑性质之间的深刻联系。