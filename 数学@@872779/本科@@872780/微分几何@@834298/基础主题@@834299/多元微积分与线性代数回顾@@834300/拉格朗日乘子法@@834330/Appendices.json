{"hands_on_practices": [{"introduction": "让我们从一个经典且直观的问题开始：寻找曲面上离给定外部点最近的点。这个练习 [@problem_id:1649764] 是拉格朗日乘数法的绝佳入门，我们将在保持在曲面上的约束条件下，最小化距离的平方函数。掌握这种设定是解决各种几何优化问题的基础。", "problem": "一个质点被约束在由方程 $z = x^2 - y^2$ 定义的双曲抛物面上运动。外部的一个固定点位于坐标 $P_0 = (0, 2, 3.5)$ 处。求该曲面上距离点 $P_0$ 最近且位于第一卦限（其中 $x>0, y>0, z>0$）的点的坐标 $(x, y, z)$。\n\n将你的答案，即坐标 $(x,y,z)$，以行矩阵的形式表示。", "solution": "我们需要最小化从曲面 $z=x^{2}-y^{2}$ 上的点 $(x,y,z)$ 到点 $P_{0}=(0,2,\\frac{7}{2})$ 的欧几里得距离的平方。最小化距离的平方可以避免开方运算，并得到相同的最小值点。定义\n$$\nS(x,y,z)=x^{2}+(y-2)^{2}+\\left(z-\\frac{7}{2}\\right)^{2}\n$$\n约束条件为\n$$\nc(x,y,z)=z-x^{2}+y^{2}=0.\n$$\n使用拉格朗日乘子 $\\lambda$，联立方程 $\\nabla S=\\lambda\\,\\nabla c$ 和 $c=0$。计算梯度：\n$$\n\\frac{\\partial S}{\\partial x}=2x,\\quad \\frac{\\partial S}{\\partial y}=2(y-2),\\quad \\frac{\\partial S}{\\partial z}=2\\left(z-\\frac{7}{2}\\right),\n$$\n$$\n\\frac{\\partial c}{\\partial x}=-2x,\\quad \\frac{\\partial c}{\\partial y}=2y,\\quad \\frac{\\partial c}{\\partial z}=1.\n$$\n拉格朗日方程组为\n$$\n2x=\\lambda(-2x),\\qquad 2(y-2)=\\lambda(2y),\\qquad 2\\left(z-\\frac{7}{2}\\right)=\\lambda,\\qquad z-x^{2}+y^{2}=0.\n$$\n我们寻找在第一卦限内的解，这要求 $x>0$, $y>0$, $z>0$。因此 $x\\neq 0$，从 $2x=-2\\lambda x$ 我们得到\n$$\n1=-\\lambda\\;\\;\\Longrightarrow\\;\\; \\lambda=-1.\n$$\n将 $\\lambda=-1$ 代入其他方程：\n$$\n2(y-2)=-2y\\;\\;\\Longrightarrow\\;\\; 2y-4=-2y\\;\\;\\Longrightarrow\\;\\; 4y=4\\;\\;\\Longrightarrow\\;\\; y=1,\n$$\n$$\n2\\left(z-\\frac{7}{2}\\right)=-1\\;\\;\\Longrightarrow\\;\\; z-\\frac{7}{2}=-\\frac{1}{2}\\;\\;\\Longrightarrow\\;\\; z=3.\n$$\n应用约束条件 $z=x^{2}-y^{2}$：\n$$\n3=x^{2}-1\\;\\;\\Longrightarrow\\;\\; x^{2}=4\\;\\;\\Longrightarrow\\;\\; x=\\pm 2.\n$$\n第一卦限要求 $x>0$，所以 $x=2$。这个候选解满足 $y=1>0$ 和 $z=3>0$，因此它位于第一卦限。因此，在第一卦限内，曲面上距离 $P_0$ 最近的点是 $(2,1,3)$。", "answer": "$$\\boxed{\\begin{pmatrix}2  1  3\\end{pmatrix}}$$", "id": "1649764"}, {"introduction": "在之前例子的基础上，我们现在来解决一个更进一步的问题：寻找一个椭球体和一个平面这两个独立几何对象之间的最短距离。这个练习 [@problem_id:1649731] 展示了拉格朗日乘数法的强大功能和通用性。它教我们如何将问题构建为在点必须位于椭球体上的约束下，优化点在平面法向量上的投影值。", "problem": "考虑一个三维欧几里得空间中的场景，其中包含一个椭球体和一个平面。椭球体的表面由方程 $\\frac{x^2}{4} + \\frac{y^2}{9} + z^2 = 1$ 描述。该平面由方程 $2x + y - z = 10$ 定义。你的任务是确定椭球体表面与该平面之间的最短距离。\n\n请用一个单一的封闭形式解析表达式来表示你的最终答案。坐标和方程均以一组一致的无量纲单位给出。", "solution": "设平面方程为 $n\\cdot r = d$，其中 $n=(2,1,-1)$ 且 $d=10$。从点 $r=(x,y,z)$ 到该平面的欧几里得距离为\n$$\n\\frac{|n\\cdot r - d|}{\\|n\\|},\n$$\n因此，椭球体到该平面的最短距离为\n$$\n\\min_{(x,y,z)\\in S}\\frac{|2x+y-z-10|}{\\sqrt{6}},\n$$\n其中 $S$ 是椭球体 $\\frac{x^{2}}{4}+\\frac{y^{2}}{9}+z^{2}=1$ 且 $\\|n\\|=\\sqrt{2^{2}+1^{2}+(-1)^{2}}=\\sqrt{6}$。\n\n由于椭球体以原点为中心且对称，在 $S$ 上最小化 $|2x+y-z-10|$ 的问题可以简化为在 $S$ 上最大化 $2x+y-z$；如果最大值 $M$ 满足 $M10$，则 $|2x+y-z-10|$ 的最小值等于 $10-M$。因此，我们计算\n$$\nM=\\max_{\\frac{x^{2}}{4}+\\frac{y^{2}}{9}+z^{2}=1}(2x+y-z).\n$$\n\n使用拉格朗日乘数法。定义\n$$\n\\mathcal{L}(x,y,z,\\lambda)=2x+y-z-\\lambda\\left(\\frac{x^{2}}{4}+\\frac{y^{2}}{9}+z^{2}-1\\right).\n$$\n令偏导数为零：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial x}=2-\\lambda\\frac{x}{2}=0 \\quad\\Rightarrow\\quad x=\\frac{4}{\\lambda},\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial y}=1-\\lambda\\frac{2y}{9}=0 \\quad\\Rightarrow\\quad y=\\frac{9}{2\\lambda},\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial z}=-1-2\\lambda z=0 \\quad\\Rightarrow\\quad z=-\\frac{1}{2\\lambda}.\n$$\n代入约束条件：\n$$\n\\frac{(4/\\lambda)^2}{4} + \\frac{(9/(2\\lambda))^2}{9} + (-1/(2\\lambda))^2 = \\frac{4}{\\lambda^2} + \\frac{9}{4\\lambda^2} + \\frac{1}{4\\lambda^2} = \\frac{16+9+1}{4\\lambda^2} = \\frac{13}{2\\lambda^2} = 1\n$$\n因此 $\\lambda^{2}=\\frac{13}{2}$。对应的目标值为\n$$\n2x+y-z=2\\cdot\\frac{4}{\\lambda}+\\frac{9}{2\\lambda}-\\left(-\\frac{1}{2\\lambda}\\right)=\\frac{13}{\\lambda}.\n$$\n选择使值最大化的 $\\lambda$ 的符号，得到 $\\lambda=\\sqrt{\\frac{13}{2}}$，因此\n$$\nM=\\frac{13}{\\sqrt{\\frac{13}{2}}}=\\sqrt{26}.\n$$\n由于 $10\\sqrt{26}$，该平面与椭球体不相交，且最小距离为\n$$\n\\frac{10-\\sqrt{26}}{\\|n\\|}=\\frac{10-\\sqrt{26}}{\\sqrt{6}}.\n$$", "answer": "$$\\boxed{\\frac{10-\\sqrt{26}}{\\sqrt{6}}}$$", "id": "1649731"}, {"introduction": "许多现实世界中的优化问题涉及不止一个限制条件。这最后一个练习 [@problem_id:1649749] 介绍了拉格朗日乘数法处理多个约束的关键扩展。通过寻找由圆柱体和平面相交形成的曲线上坐标的极值点，我们学习到目标函数的梯度如何必须位于所有约束函数梯度的生成空间中。", "problem": "三维欧几里得空间中的一条曲线由两个曲面的交线定义：一个由方程 $y^2 + z^2 = 1$ 给出的圆柱面，以及一个由方程 $x - y - z = 0$ 给出的平面。该曲线有两个点，其 $x$ 坐标达到极值（一个最大值和一个最小值）。计算这两个极值点之间距离的平方。", "solution": "设待优化的函数为 $x$ 坐标，因此我们有 $f(x, y, z) = x$。\n该优化受两个约束条件限制。我们可以将约束条件写为函数等于零的形式：\n1.  圆柱面方程：$g_1(x, y, z) = y^2 + z^2 - 1 = 0$。\n2.  平面方程：$g_2(x, y, z) = x - y - z = 0$。\n\n我们使用针对两个约束条件的拉格朗日乘数法。该方法指出，在极值点，如果约束函数的梯度是线性无关的，那么目标函数的梯度是约束函数梯度的线性组合。该条件表示为 $\\nabla f = \\lambda \\nabla g_1 + \\mu \\nabla g_2$，其中 $\\lambda$ 和 $\\mu$ 是拉格朗日乘数。\n\n首先，我们计算函数 $f$、$g_1$ 和 $g_2$ 的梯度：\n$\\nabla f(x, y, z) = \\langle \\frac{\\partial f}{\\partial x}, \\frac{\\partial f}{\\partial y}, \\frac{\\partial f}{\\partial z} \\rangle = \\langle 1, 0, 0 \\rangle$\n$\\nabla g_1(x, y, z) = \\langle \\frac{\\partial g_1}{\\partial x}, \\frac{\\partial g_1}{\\partial y}, \\frac{\\partial g_1}{\\partial z} \\rangle = \\langle 0, 2y, 2z \\rangle$\n$\\nabla g_2(x, y, z) = \\langle \\frac{\\partial g_2}{\\partial x}, \\frac{\\partial g_2}{\\partial y}, \\frac{\\partial g_2}{\\partial z} \\rangle = \\langle 1, -1, -1 \\rangle$\n\n现在，我们根据 $\\nabla f = \\lambda \\nabla g_1 + \\mu \\nabla g_2$ 建立方程组：\n$\\langle 1, 0, 0 \\rangle = \\lambda \\langle 0, 2y, 2z \\rangle + \\mu \\langle 1, -1, -1 \\rangle$\n$\\langle 1, 0, 0 \\rangle = \\langle \\mu, 2\\lambda y - \\mu, 2\\lambda z - \\mu \\rangle$\n\n这个向量方程给了我们三个标量方程：\n(1) $1 = \\mu$\n(2) $0 = 2\\lambda y - \\mu$\n(3) $0 = 2\\lambda z - \\mu$\n\n我们还有两个约束方程：\n(4) $y^2 + z^2 = 1$\n(5) $x = y + z$\n\n我们接下来解这个包含五个方程的方程组，求出变量 $x, y, z, \\lambda, \\mu$。\n从方程(1)，我们立即得出 $\\mu = 1$。\n\n将 $\\mu = 1$ 代入方程(2)和(3)：\n(2') $0 = 2\\lambda y - 1 \\implies 2\\lambda y = 1$\n(3') $0 = 2\\lambda z - 1 \\implies 2\\lambda z = 1$\n\n从(2')和(3')可以看出，$2\\lambda y = 2\\lambda z$。如果 $\\lambda \\neq 0$，我们可以两边除以 $2\\lambda$ 得到 $y = z$。如果 $\\lambda = 0$，方程(2')和(3')将变为 $0 = -1$，这是一个矛盾。因此，$\\lambda$ 必须非零，可以得出结论 $y=z$。\n\n现在我们将 $y=z$ 代入约束方程(4)：\n$y^2 + y^2 = 1$\n$2y^2 = 1$\n$y^2 = \\frac{1}{2}$\n这给出了 $y$ 的两个可能值：$y = \\frac{1}{\\sqrt{2}}$ 和 $y = -\\frac{1}{\\sqrt{2}}$。\n\n由于 $z=y$，我们得到两组 $(y, z)$ 的解：\n情况1：$y = \\frac{1}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2}$ 且 $z = \\frac{\\sqrt{2}}{2}$。\n情况2：$y = -\\frac{1}{\\sqrt{2}} = -\\frac{\\sqrt{2}}{2}$ 且 $z = -\\frac{\\sqrt{2}}{2}$。\n\n接下来，我们使用约束方程(5)，$x = y + z$，来求出每种情况下对应的 $x$ 值。\n对于情况1：\n$x_1 = \\frac{\\sqrt{2}}{2} + \\frac{\\sqrt{2}}{2} = \\sqrt{2}$。\n这给了我们点 $P_1 = (\\sqrt{2}, \\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2})$。由于 $\\sqrt{2}  0$，这对应于 $x$ 坐标的最大值。\n\n对于情况2：\n$x_2 = -\\frac{\\sqrt{2}}{2} - \\frac{\\sqrt{2}}{2} = -\\sqrt{2}$。\n这给了我们点 $P_2 = (-\\sqrt{2}, -\\frac{\\sqrt{2}}{2}, -\\frac{\\sqrt{2}}{2})$。这对应于 $x$ 坐标的最小值。\n\n我们已经找到了两个极值点：$P_{max} = (\\sqrt{2}, \\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2})$ 和 $P_{min} = (-\\sqrt{2}, -\\frac{\\sqrt{2}}{2}, -\\frac{\\sqrt{2}}{2})$。\n\n最后一步是计算这两点之间距离的平方 $d^2$。两点 $(x_a, y_a, z_a)$ 和 $(x_b, y_b, z_b)$ 之间距离的平方公式为 $d^2 = (x_a - x_b)^2 + (y_a - y_b)^2 + (z_a - z_b)^2$。\n$d^2 = (\\sqrt{2} - (-\\sqrt{2}))^2 + \\left(\\frac{\\sqrt{2}}{2} - \\left(-\\frac{\\sqrt{2}}{2}\\right)\\right)^2 + \\left(\\frac{\\sqrt{2}}{2} - \\left(-\\frac{\\sqrt{2}}{2}\\right)\\right)^2$\n$d^2 = (2\\sqrt{2})^2 + \\left(\\frac{2\\sqrt{2}}{2}\\right)^2 + \\left(\\frac{2\\sqrt{2}}{2}\\right)^2$\n$d^2 = (2\\sqrt{2})^2 + (\\sqrt{2})^2 + (\\sqrt{2})^2$\n$d^2 = (4 \\cdot 2) + 2 + 2$\n$d^2 = 8 + 2 + 2 = 12$。", "answer": "$$\\boxed{12}$$", "id": "1649749"}]}