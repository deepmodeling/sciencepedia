{"hands_on_practices": [{"introduction": "要真正掌握自助法，最好的方法就是亲自动手操作。这个练习将引导我们完成一个基础但非常重要的任务：为一个样本量很小的数据集估计总体中位数。通过直接处理一组已排序的自助法中位数样本，我们可以亲身体验百分位法置信区间的构建过程，并理解其在处理非正态数据或小样本时的核心价值 [@problem_id:1901792]。", "problem": "一位分子生物学家正在研究一种特定基因“Gene-X”在特定条件下的表达水平。表达水平以标准化的荧光强度来衡量。由于实验成本高昂，只能获得一个包含五个测量值的小样本。观察到的表达水平为：\n$$\n3.1, 4.5, 2.8, 5.9, 3.4\n$$\n为了估计总体中位数表达水平的变异性，该生物学家采用了一种非参数自助法（bootstrap）程序。通过对原始五个数据点进行有放回的重抽样，创建了大量的自助样本。对每个自助样本，计算其中位数。在生成了20个这样的自助中位数并按升序排列后，得到以下有序中位数列表：\n$$\n2.8, 2.9, 3.1, 3.1, 3.1, 3.2, 3.3, 3.4, 3.4, 3.4, 3.5, 3.6, 3.9, 4.1, 4.2, 4.5, 4.5, 4.5, 4.8, 5.1\n$$\n使用百分位数法对这组20个已排序的自助中位数，构建总体中位数表达水平的90%置信区间。以下哪个选项代表了正确的区间？\n\nA. [2.8, 4.8]\n\nB. [2.9, 5.1]\n\nC. [2.8, 5.1]\n\nD. [3.1, 4.5]\n\nE. [2.9, 4.8]", "solution": "我们需要使用已排序的自助中位数来寻找总体中位数的百分位数自助置信区间。对于置信水平 $1-\\alpha=0.90$，百分位数法使用自助分布在概率 $\\alpha/2=0.05$ 和 $1-\\alpha/2=0.95$ 处的经验分位数。\n\n设 $B=20$ 为自助中位数的数量，并将排序后的自助中位数表示为 $m_{(1)} \\leq m_{(2)} \\leq \\cdots \\leq m_{(20)}$。使用经验分位数的最近秩定义，与概率 $p$ 对应的秩为\n$$\nr(p)=\\lceil B p \\rceil.\n$$\n因此，\n$$\nr(0.05)=\\lceil 20 \\times 0.05 \\rceil=\\lceil 1 \\rceil=1,\\quad r(0.95)=\\lceil 20 \\times 0.95 \\rceil=\\lceil 19 \\rceil=19.\n$$\n因此，90%的百分位置信区间为\n$$\n\\left[m_{(1)},\\,m_{(19)}\\right].\n$$\n从给定的排序列表中，$m_{(1)}=2.8$ 且 $m_{(19)}=4.8$，所以区间是 $[2.8, 4.8]$，这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1901792"}, {"introduction": "在掌握了基本流程后，让我们来探索自助法更广泛的应用。此练习展示了如何为变异系数（即标准差与均值的比率 $\\frac{\\sigma}{\\mu}$）构建置信区间，这是一个衡量相对变异性的重要统计量。这个例子说明了自助法的强大之处：无论统计量本身多么复杂，我们都无需推导其复杂的解析抽样分布，而是可以通过模拟直接估计其置信区间 [@problem_id:1901798]。", "problem": "一位质量控制工程师正在评估一个电阻器制造过程的一致性。抽取了六个电阻器作为样本，并以欧姆（$\\Omega$）为单位测量了它们的电阻。测量结果如下：\n$$ [48.2, 51.5, 49.8, 52.1, 47.9, 50.7] $$\n该工程师关心的是变异系数，它被定义为总体标准差与总体均值的比值（$\\frac{\\sigma}{\\mu}$），以此作为相对变异性的度量。为了估计这个量，使用了百分位数自助法程序。一个计算机模拟从原始数据中生成了大量的自助样本。对每个自助样本，都计算其变异系数。从这些自助统计量的结果分布中，发现第2.5个百分位数是 $0.01673$，第97.5个百分位数是 $0.05598$。\n\n根据这些信息，确定电阻真实变异系数的95%百分位数自助置信区间。请以一对数字的形式提供该区间的下界和上界。将每个界限四舍五入到三位有效数字。", "solution": "目标参数是变异系数 $\\theta=\\sigma/\\mu$。水平为 $1-\\alpha$ 的百分位数自助置信区间使用统计量的自助抽样分布的经验分位数。具体来说，如果 $\\hat{\\theta}^{*(p)}$ 表示统计量的自助分布的 $p$-分位数，那么百分位数自助区间为\n$$\n\\left[\\hat{\\theta}^{*\\left(\\frac{\\alpha}{2}\\right)},\\ \\hat{\\theta}^{*\\left(1-\\frac{\\alpha}{2}\\right)}\\right].\n$$\n对于一个 $95$% 的置信区间，$\\alpha=0.05$，所以其界限是 $0.025$ 和 $0.975$ 分位数。模拟提供的这些值分别为 $0.01673$ 和 $0.05598$。\n\n将每个界限四舍五入到三位有效数字：\n- 对于 $0.01673$，前三位有效数字是 $1,6,7$，下一位数字是 $3$，所以舍入为 $0.0167$。\n- 对于 $0.05598$，前三位有效数字是 $5,5,9$，下一位数字是 $8$，所以向上进位为 $0.0560$ 以保留三位有效数字。\n\n因此，$95$%的百分位数自助置信区间是\n$$\n\\left[0.0167,\\ 0.0560\\right].\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.0167  0.0560\\end{pmatrix}}$$", "id": "1901798"}, {"introduction": "现在，让我们进入一个更高级的应用场景，看看自助法如何解决经典统计模型中的难题。在线性回归中，一个关键假设是误差项的方差恒定（同方差性），但这个假设在现实世界中常常不成立。此练习介绍了一种名为“野性自助法”(wild bootstrap)的先进技术，它专门用于在存在异方差性的情况下，为回归系数构建更可靠的置信区间，这展示了自助法作为一种稳健统计推断工具的强大能力 [@problem_id:1901772]。", "problem": "一位材料工程师正在研究一种新型聚合物复合材料的性能。她研究了一种新型硬化剂的浓度与材料最终拉伸强度之间的关系。假设存在一种线性关系：$S_i = \\beta_0 + \\beta_1 C_i + \\epsilon_i$，其中 $S_i$ 是拉伸强度，单位为吉帕斯卡 (GPa)；$C_i$ 是硬化剂浓度，单位为百分比 (%)；$\\epsilon_i$ 是误差项。该工程师对系数 $\\beta_1$ 特别感兴趣，它代表硬化剂浓度每增加一个百分点，拉伸强度增加的边际量（单位为 GPa）。\n\n收集数据后，初步分析表明误差项 $\\epsilon_i$ 的方差在不同浓度水平下可能不是恒定的，这种情况会使 $\\beta_1$ 的标准置信区间无效。为了获得更可靠的区间，采用了一种稳健的计算方法。该方法包括以下步骤，以生成一个合理的斜率估计值分布：\n1.  对原始数据进行初步的普通最小二乘 (OLS) 回归，以找出估计系数 $\\hat{\\beta}_0, \\hat{\\beta}_1$ 和残差 $\\hat{\\epsilon}_i = S_i - (\\hat{\\beta}_0 + \\hat{\\beta}_1 C_i)$。\n2.  生成大量的（$B$ 个）新的“自助法”数据集。对于每次复制 $b \\in \\{1, \\dots, B\\}$，通过 $\\epsilon_{i,b}^* = \\hat{\\epsilon}_i \\cdot v_{i,b}$ 创建一组新的伪误差，其中每个 $v_{i,b}$ 是从均值为 0、方差为 1 的分布中独立随机抽取的。\n3.  使用原始拟合值构建新的伪响应：$S_{i,b}^* = (\\hat{\\beta}_0 + \\hat{\\beta}_1 C_i) + \\epsilon_{i,b}^*$。\n4.  对于每次复制 $b$，通过对 $S_b^*$ 和原始浓度 $C$ 进行 OLS 回归，估计一个新的斜率系数 $\\hat{\\beta}_{1,b}^*$。\n\n该过程进行了 $B=4999$ 次复制。将得到的 4999 个斜率估计值 $\\{\\hat{\\beta}_{1,b}^*\\}$ 按升序排序。分析从排序后的列表中得出了以下关键值：\n- 第 125 个值为 $2.18$。\n- 来自原始数据的 OLS 估计值为 $\\hat{\\beta}_1 = 2.51$。\n- 第 4875 个值为 $2.93$。\n\n基于这些信息，确定斜率系数 $\\beta_1$ 的 95% 自助法百分位数置信区间。将您的答案表示为行矩阵 `[lower_bound, upper_bound]`，值的单位为 GPa/%。所提供的值已达到所需精度，无需进一步四舍五入。", "solution": "题目要求我们基于 $B=4999$ 个自助法斜率估计值，求出斜率系数 $\\beta_{1}$ 的 95% 自助法百分位数置信区间。设排序后的自助法斜率为顺序统计量 $\\hat{\\beta}_{1,(1)}^{*} \\leq \\cdots \\leq \\hat{\\beta}_{1,(B)}^{*}$。\n\n对于名义双侧置信水平 $1-\\alpha=0.95$（即 $\\alpha=0.05$），百分位数法取自助法分布的经验 $\\alpha/2$ 和 $1-\\alpha/2$ 分位数。使用标准的 $(B+1)$ 索引规则，分位数索引为\n$$\nk_{\\ell} = \\alpha/2 \\cdot (B+1), \\qquad k_{u} = (1-\\alpha/2) \\cdot (B+1).\n$$\n当 $B=4999$ 和 $\\alpha=0.05$ 时，\n$$\nk_{\\ell} = 0.025 \\cdot 5000 = 125, \\qquad k_{u} = 0.975 \\cdot 5000 = 4875.\n$$\n因此，95% 自助法百分位数置信区间为\n$$\n\\left[\\, \\hat{\\beta}_{1,(125)}^{*},\\ \\hat{\\beta}_{1,(4875)}^{*} \\,\\right].\n$$\n从提供的排序后的自助法输出中，我们得到 $\\hat{\\beta}_{1,(125)}^{*} = 2.18$ 和 $\\hat{\\beta}_{1,(4875)}^{*} = 2.93$。因此，95% 自助法百分位数置信区间是\n$$\n[\\,2.18,\\ 2.93\\,].\n$$\n原始的 OLS 估计值 $\\hat{\\beta}_{1}=2.51$ 对于构建百分位数区间不是必需的；报告该值是为了提供上下文信息。", "answer": "$$\\boxed{\\begin{pmatrix} 2.18  2.93 \\end{pmatrix}}$$", "id": "1901772"}]}