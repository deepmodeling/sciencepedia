{"hands_on_practices": [{"introduction": "我们将通过一个来自可靠性工程领域的具体例子，开启我们的动手实践。在许多应用中，我们使用的估计量虽然很直观（例如，使用样本均值的倒数来估计指数分布的率参数 $ \\lambda $），但可能存在系统性偏差。本练习 [@problem_id:1961125] 将指导你一步步应用刀切法，对一个给定的数据集进行数值计算，从而亲手量化这种偏差，让你对刀切法的核心操作流程建立起坚实的理解。", "problem": "在可靠性工程中，某个电子元件的寿命通常用带有率参数 $\\lambda$ 的指数分布来建模。参数 $\\lambda$ 代表恒定的失效率。基于观测寿命样本 $X_1, X_2, \\ldots, X_n$，该参数的一个常用估计量是样本均值的倒数，即 $\\hat{\\lambda} = 1/\\bar{X}$，其中 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$。虽然这个估计量是最大似然估计量，但已知它是有偏的。\n\n假设收集了一个大小为 $n=4$ 的元件寿命小样本，观测值（单位为分钟）如下：\n$$ \\{2.3, 1.5, 3.1, 2.5\\} $$\n应用刀切法重抽样方法来计算估计量 $\\hat{\\lambda}$ 偏差的数值估计。\n\n以 min⁻¹ 为单位，将您的答案四舍五入到四位有效数字。", "solution": "题目要求计算给定数据集下估计量 $\\hat{\\lambda} = 1/\\bar{X}$ 偏差的刀切法估计值。数据集为 $X = \\{2.3, 1.5, 3.1, 2.5\\}$，样本大小为 $n=4$。数据的单位是分钟，所以 $\\lambda$ 及其偏差的单位将是 min⁻¹。\n\n首先，我们根据完整样本计算样本均值 $\\bar{X}$ 和估计值 $\\hat{\\lambda}$。\n观测值的总和是 $\\sum_{i=1}^4 X_i = 2.3 + 1.5 + 3.1 + 2.5 = 9.4$。\n样本均值为 $\\bar{X} = \\frac{9.4}{4} = 2.35$ 分钟。\n基于完整样本的 $\\lambda$ 估计值为 $\\hat{\\lambda} = \\frac{1}{\\bar{X}} = \\frac{1}{2.35} \\text{ min}^{-1}$。\n\n接下来，我们应用刀切法程序。这包括创建 $n=4$ 个子样本，每个子样本都是通过从原始样本中一次移除一个观测值而形成的。对于每个子样本，我们计算相应的 $\\lambda$ 估计值。令 $X_{(i)}$ 表示移除了第 $i$ 个观测值的子样本，令 $\\hat{\\lambda}_{(i)}$ 为由该子样本计算出的估计值。\n\n移除了观测值 $X_i$ 的子样本的均值 $\\bar{X}_{(i)}$ 可以计算为 $\\bar{X}_{(i)} = \\frac{n\\bar{X} - X_i}{n-1}$。相应的估计值为 $\\hat{\\lambda}_{(i)} = 1/\\bar{X}_{(i)}$。\n\n让我们为每个 $i=1, 2, 3, 4$ 计算 $\\hat{\\lambda}_{(i)}$：\n当 $i=1$ 时，我们移除 $X_1 = 2.3$。\n$\\bar{X}_{(1)} = \\frac{4 \\times 2.35 - 2.3}{4-1} = \\frac{9.4 - 2.3}{3} = \\frac{7.1}{3}$ min。\n$\\hat{\\lambda}_{(1)} = \\frac{1}{\\bar{X}_{(1)}} = \\frac{3}{7.1} \\text{ min}^{-1}$。\n\n当 $i=2$ 时，我们移除 $X_2 = 1.5$。\n$\\bar{X}_{(2)} = \\frac{4 \\times 2.35 - 1.5}{4-1} = \\frac{9.4 - 1.5}{3} = \\frac{7.9}{3}$ min。\n$\\hat{\\lambda}_{(2)} = \\frac{1}{\\bar{X}_{(2)}} = \\frac{3}{7.9} \\text{ min}^{-1}$。\n\n当 $i=3$ 时，我们移除 $X_3 = 3.1$。\n$\\bar{X}_{(3)} = \\frac{4 \\times 2.35 - 3.1}{4-1} = \\frac{9.4 - 3.1}{3} = \\frac{6.3}{3} = 2.1$ min。\n$\\hat{\\lambda}_{(3)} = \\frac{1}{\\bar{X}_{(3)}} = \\frac{1}{2.1} \\text{ min}^{-1}$。\n\n当 $i=4$ 时，我们移除 $X_4 = 2.5$。\n$\\bar{X}_{(4)} = \\frac{4 \\times 2.35 - 2.5}{4-1} = \\frac{9.4 - 2.5}{3} = \\frac{6.9}{3} = 2.3$ min。\n$\\hat{\\lambda}_{(4)} = \\frac{1}{\\bar{X}_{(4)}} = \\frac{1}{2.3} \\text{ min}^{-1}$。\n\n偏差的刀切法估计由以下公式给出：\n$$ \\widehat{\\text{Bias}}_{jack}(\\hat{\\lambda}) = (n-1)(\\bar{\\hat{\\lambda}}_{(\\cdot)} - \\hat{\\lambda}) $$\n其中 $\\bar{\\hat{\\lambda}}_{(\\cdot)}$ 是留一法估计值的平均值：\n$$ \\bar{\\hat{\\lambda}}_{(\\cdot)} = \\frac{1}{n} \\sum_{i=1}^n \\hat{\\lambda}_{(i)} $$\n\n首先，我们计算这些估计的数值，为中间计算保留足够的精度。\n$\\hat{\\lambda} = \\frac{1}{2.35} \\approx 0.42553191 \\text{ min}^{-1}$\n$\\hat{\\lambda}_{(1)} = \\frac{3}{7.1} \\approx 0.42253521 \\text{ min}^{-1}$\n$\\hat{\\lambda}_{(2)} = \\frac{3}{7.9} \\approx 0.37974684 \\text{ min}^{-1}$\n$\\hat{\\lambda}_{(3)} = \\frac{1}{2.1} \\approx 0.47619048 \\text{ min}^{-1}$\n$\\hat{\\lambda}_{(4)} = \\frac{1}{2.3} \\approx 0.43478261 \\text{ min}^{-1}$\n\n现在，我们计算这些留一法估计值的平均值：\n$$ \\bar{\\hat{\\lambda}}_{(\\cdot)} = \\frac{1}{4} (0.42253521 + 0.37974684 + 0.47619048 + 0.43478261) $$\n$$ \\bar{\\hat{\\lambda}}_{(\\cdot)} = \\frac{1}{4} (1.71325514) \\approx 0.42831379 \\text{ min}^{-1} $$\n\n最后，我们使用刀切法偏差公式：\n$$ \\widehat{\\text{Bias}}_{jack}(\\hat{\\lambda}) = (4-1) (0.42831379 - 0.42553191) $$\n$$ \\widehat{\\text{Bias}}_{jack}(\\hat{\\lambda}) = 3 \\times (0.00278188) $$\n$$ \\widehat{\\text{Bias}}_{jack}(\\hat{\\lambda}) \\approx 0.00834564 \\text{ min}^{-1} $$\n\n题目要求答案四舍五入到四位有效数字。\n$$ \\widehat{\\text{Bias}}_{jack}(\\hat{\\lambda}) \\approx 0.008346 \\text{ min}^{-1} $$", "answer": "$$\\boxed{0.008346}$$", "id": "1961125"}, {"introduction": "在掌握了如何为特定数据集计算偏差估计之后，让我们将挑战提升一个层次：从具体的数值计算转向普适的符号推导。本练习 [@problem_id:1961131] 要求你为伯努利分布的方差估计量推导出其刀切偏差的解析表达式。这个过程不仅能加深你对刀切法公式背后代数结构的理解，更展示了该方法提供分析性洞见的能力，而不仅仅是输出数值结果。", "problem": "设 $X_1, X_2, \\ldots, X_n$ 是一个大小为 $n > 1$ 的独立同分布随机样本，来自一个未知参数为 $p$ 的伯努利分布，其中 $0 < p < 1$。样本均值记为 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$。\n\n考虑总体方差 $\\theta = p(1-p)$ 的估计量 $\\hat{\\theta} = \\bar{X}(1-\\bar{X})$。\n\n使用刀切重抽样法，求出 $\\hat{\\theta}$ 偏差的一个估计。请用 $\\bar{X}$ 和 $n$ 将你的答案表示为一个闭式解析表达式。", "solution": "我们使用标量参数的刀切偏差估计量，其定义为\n$$\n\\widehat{\\operatorname{bias}}_{\\text{JK}}(\\hat{\\theta})=(n-1)\\left(\\bar{\\theta}_{(\\cdot)}-\\hat{\\theta}\\right),\n$$\n其中 $\\hat{\\theta}=\\bar{X}(1-\\bar{X})$，$\\hat{\\theta}_{(i)}$ 是移除第 $i$ 个观测值后计算的留一法版本，且\n$$\n\\bar{\\theta}_{(\\cdot)}=\\frac{1}{n}\\sum_{i=1}^{n}\\hat{\\theta}_{(i)}.\n$$\n\n令 $\\bar{X}_{(i)}$ 表示留一法样本均值：\n$$\n\\bar{X}_{(i)}=\\frac{1}{n-1}\\sum_{j\\neq i}X_{j}=\\frac{n\\bar{X}-X_{i}}{n-1}.\n$$\n那么\n$$\n\\hat{\\theta}_{(i)}=\\bar{X}_{(i)}\\left(1-\\bar{X}_{(i)}\\right)=\\bar{X}_{(i)}-\\bar{X}_{(i)}^{2}.\n$$\n因此，\n$$\n\\bar{\\theta}_{(\\cdot)}=\\frac{1}{n}\\sum_{i=1}^{n}\\left[\\bar{X}_{(i)}-\\bar{X}_{(i)}^{2}\\right]=\\left(\\frac{1}{n}\\sum_{i=1}^{n}\\bar{X}_{(i)}\\right)-\\left(\\frac{1}{n}\\sum_{i=1}^{n}\\bar{X}_{(i)}^{2}\\right).\n$$\n首先计算 $\\bar{X}_{(i)}$ 的平均值：\n$$\n\\frac{1}{n}\\sum_{i=1}^{n}\\bar{X}_{(i)}=\\frac{1}{n}\\sum_{i=1}^{n}\\frac{n\\bar{X}-X_{i}}{n-1}=\\frac{1}{n-1}\\left(n\\bar{X}-\\frac{1}{n}\\sum_{i=1}^{n}X_{i}\\right)=\\frac{1}{n-1}\\left(n\\bar{X}-\\bar{X}\\right)=\\bar{X}.\n$$\n接着计算 $\\frac{1}{n}\\sum_{i=1}^{n}\\bar{X}_{(i)}^{2}$。记 $b_{i}=\\bar{X}_{(i)}=\\frac{n\\bar{X}-X_{i}}{n-1}$，则\n$$\n\\sum_{i=1}^{n}b_{i}^{2}=\\frac{1}{(n-1)^{2}}\\sum_{i=1}^{n}(n\\bar{X}-X_{i})^{2}\n=\\frac{1}{(n-1)^{2}}\\left(\\sum_{i=1}^{n}n^{2}\\bar{X}^{2}-2n\\bar{X}\\sum_{i=1}^{n}X_{i}+\\sum_{i=1}^{n}X_{i}^{2}\\right).\n$$\n由于 $X_{i}\\in\\{0,1\\}$，我们有 $X_{i}^{2}=X_{i}$，所以 $\\sum_{i=1}^{n}X_{i}^{2}=\\sum_{i=1}^{n}X_{i}=n\\bar{X}$。因此，\n$$\n\\sum_{i=1}^{n}b_{i}^{2}=\\frac{1}{(n-1)^{2}}\\left(n\\cdot n^{2}\\bar{X}^{2}-2n\\bar{X}\\cdot n\\bar{X}+n\\bar{X}\\right)\n=\\frac{1}{(n-1)^{2}}\\left(n^{3}\\bar{X}^{2}-2n^{2}\\bar{X}^{2}+n\\bar{X}\\right)\n=\\frac{n^{2}(n-2)\\bar{X}^{2}+n\\bar{X}}{(n-1)^{2}}.\n$$\n于是\n$$\n\\frac{1}{n}\\sum_{i=1}^{n}\\bar{X}_{(i)}^{2}=\\frac{n(n-2)\\bar{X}^{2}+\\bar{X}}{(n-1)^{2}}.\n$$\n由此可得\n$$\n\\bar{\\theta}_{(\\cdot)}=\\bar{X}-\\frac{n(n-2)\\bar{X}^{2}+\\bar{X}}{(n-1)^{2}}.\n$$\n现在计算\n$$\n\\bar{\\theta}_{(\\cdot)}-\\hat{\\theta}=\\left[\\bar{X}-\\frac{n(n-2)\\bar{X}^{2}+\\bar{X}}{(n-1)^{2}}\\right]-\\left(\\bar{X}-\\bar{X}^{2}\\right)\n=\\bar{X}^{2}-\\frac{n(n-2)\\bar{X}^{2}+\\bar{X}}{(n-1)^{2}}.\n$$\n对分母 $(n-1)^{2}$ 合并各项：\n$$\n\\bar{\\theta}_{(\\cdot)}-\\hat{\\theta}=\\frac{\\bar{X}^{2}(n-1)^{2}-n(n-2)\\bar{X}^{2}-\\bar{X}}{(n-1)^{2}}.\n$$\n由于 $(n-1)^{2}-n(n-2)=1$，分子可简化为 $\\bar{X}^{2}-\\bar{X}=-\\bar{X}(1-\\bar{X})$，因此\n$$\n\\bar{\\theta}_{(\\cdot)}-\\hat{\\theta}=-\\frac{\\bar{X}(1-\\bar{X})}{(n-1)^{2}}.\n$$\n因此，偏差的刀切估计为\n$$\n\\widehat{\\operatorname{bias}}_{\\text{JK}}(\\hat{\\theta})=(n-1)\\left(\\bar{\\theta}_{(\\cdot)}-\\hat{\\theta}\\right)\n=-(n-1)\\frac{\\bar{X}(1-\\bar{X})}{(n-1)^{2}}=-\\frac{\\bar{X}(1-\\bar{X})}{n-1}.\n$$\n该表达式是用 $\\bar{X}$ 和 $n$ 表示的闭式形式。", "answer": "$$\\boxed{-\\frac{\\bar{X}\\left(1-\\bar{X}\\right)}{n-1}}$$", "id": "1961131"}, {"introduction": "刀切法的应用不止于偏差估计，它同样是估计方差的有力工具。这个练习 [@problem_id:1961127] 将我们的视野拓宽到方差估计，并揭示一个至关重要的实践问题：估计量的稳定性。通过对比一个异常值（离群点）出现前后刀切方差估计值的巨大变化，你将直观地感受到刀切法对数据质量的敏感性，并理解在实际数据分析中考察估计量稳健性的必要性。", "problem": "一位数据科学家正在分析一个小数据集，并担心其方差估计的稳定性。他们决定使用刀切法（jackknife）重采样方法来评估这一点。基于一个大小为 $n$ 的样本，估计量 $\\hat{\\theta}$ 的方差的刀切法估计由以下公式给出：\n$$ \\widehat{\\text{Var}}_{\\text{jack}}(\\hat{\\theta}) = \\frac{n-1}{n} \\sum_{i=1}^{n} \\left(\\hat{\\theta}_{(i)} - \\bar{\\theta}_{(\\cdot)}\\right)^2 $$\n其中 $\\hat{\\theta}_{(i)}$ 是从移除了第 $i$ 个数据点的样本中计算出的估计值，而 $\\bar{\\theta}_{(\\cdot)} = \\frac{1}{n} \\sum_{i=1}^{n} \\hat{\\theta}_{(i)}$ 是这些“留一法”（leave-one-out）估计的平均值。\n\n感兴趣的参数是总体均值，使用的估计量是样本均值，即 $\\hat{\\theta} = \\bar{x}$。\n\n最初，数据集为 $S_1 = \\{10, 12, 13, 15\\}$。计算该数据集样本均值的刀切法方差估计 $V_1$。\n\n随后，发现一个测量值是异常的，数据集更新为 $S_2 = \\{10, 12, 13, 40\\}$。计算这个修改后的数据集样本均值的新的刀切法方差估计 $V_2$。\n\n确定比率 $V_2 / V_1$，该比率量化了单个离群值对方差估计的影响。将你的最终答案四舍五入至三位有效数字。", "solution": "我们使用刀切法方差估计量\n$$\\widehat{\\text{Var}}_{\\text{jack}}(\\hat{\\theta})=\\frac{n-1}{n}\\sum_{i=1}^{n}\\left(\\hat{\\theta}_{(i)}-\\bar{\\theta}_{(\\cdot)}\\right)^{2},$$\n其中 $\\hat{\\theta}_{(i)}$ 是移除第 $i$ 个观测值后计算出的估计量，而 $\\bar{\\theta}_{(\\cdot)}=\\frac{1}{n}\\sum_{i=1}^{n}\\hat{\\theta}_{(i)}$。在这里，$\\hat{\\theta}$ 是样本均值，所以 $\\hat{\\theta}_{(i)}$ 是排除第 $i$ 个观测值后剩下的 $n-1$ 个观测值的均值。\n\n对于 $S_{1}=\\{10,12,13,15\\}$，$n=4$。“留一法”均值为\n$$\\hat{\\theta}_{(1)}=\\frac{12+13+15}{3}=\\frac{40}{3},\\quad \\hat{\\theta}_{(2)}=\\frac{10+13+15}{3}=\\frac{38}{3},$$\n$$\\hat{\\theta}_{(3)}=\\frac{10+12+15}{3}=\\frac{37}{3},\\quad \\hat{\\theta}_{(4)}=\\frac{10+12+13}{3}=\\frac{35}{3}.$$\n它们的平均值为\n$$\\bar{\\theta}_{(\\cdot)}=\\frac{1}{4}\\left(\\frac{40}{3}+\\frac{38}{3}+\\frac{37}{3}+\\frac{35}{3}\\right)=\\frac{50}{4}=\\frac{25}{2},$$\n这等于 $S_{1}$ 的样本均值。偏差及其平方为\n$$\\frac{40}{3}-\\frac{25}{2}=\\frac{5}{6}\\;\\Rightarrow\\;\\left(\\frac{5}{6}\\right)^{2}=\\frac{25}{36},\\quad \\frac{38}{3}-\\frac{25}{2}=\\frac{1}{6}\\;\\Rightarrow\\;\\frac{1}{36},$$\n$$\\frac{37}{3}-\\frac{25}{2}=-\\frac{1}{6}\\;\\Rightarrow\\;\\frac{1}{36},\\quad \\frac{35}{3}-\\frac{25}{2}=-\\frac{5}{6}\\;\\Rightarrow\\;\\frac{25}{36}.$$\n因此\n$$\\sum_{i=1}^{4}\\left(\\hat{\\theta}_{(i)}-\\bar{\\theta}_{(\\cdot)}\\right)^{2}=\\frac{25+1+1+25}{36}=\\frac{52}{36}=\\frac{13}{9},$$\n且\n$$V_{1}=\\widehat{\\text{Var}}_{\\text{jack}}(\\bar{x};S_{1})=\\frac{3}{4}\\cdot\\frac{13}{9}=\\frac{13}{12}.$$\n\n对于 $S_{2}=\\{10,12,13,40\\}$，$n=4$。“留一法”均值为\n$$\\hat{\\theta}_{(1)}=\\frac{12+13+40}{3}=\\frac{65}{3},\\quad \\hat{\\theta}_{(2)}=\\frac{10+13+40}{3}=\\frac{63}{3}=21,$$\n$$\\hat{\\theta}_{(3)}=\\frac{10+12+40}{3}=\\frac{62}{3},\\quad \\hat{\\theta}_{(4)}=\\frac{10+12+13}{3}=\\frac{35}{3}.$$\n它们的平均值为\n$$\\bar{\\theta}_{(\\cdot)}=\\frac{1}{4}\\left(\\frac{65}{3}+\\frac{63}{3}+\\frac{62}{3}+\\frac{35}{3}\\right)=\\frac{75}{4},$$\n这等于 $S_{2}$ 的样本均值。偏差及其平方为\n$$\\frac{65}{3}-\\frac{75}{4}=\\frac{35}{12}\\;\\Rightarrow\\;\\frac{1225}{144},\\quad 21-\\frac{75}{4}=\\frac{9}{4}\\;\\Rightarrow\\;\\frac{81}{16}=\\frac{729}{144},$$\n$$\\frac{62}{3}-\\frac{75}{4}=\\frac{23}{12}\\;\\Rightarrow\\;\\frac{529}{144},\\quad \\frac{35}{3}-\\frac{75}{4}=-\\frac{85}{12}\\;\\Rightarrow\\;\\frac{7225}{144}.$$\n因此\n$$\\sum_{i=1}^{4}\\left(\\hat{\\theta}_{(i)}-\\bar{\\theta}_{(\\cdot)}\\right)^{2}=\\frac{1225+729+529+7225}{144}=\\frac{9708}{144}=\\frac{809}{12},$$\n且\n$$V_{2}=\\widehat{\\text{Var}}_{\\text{jack}}(\\bar{x};S_{2})=\\frac{3}{4}\\cdot\\frac{809}{12}=\\frac{809}{16}.$$\n\n所求的比率为\n$$\\frac{V_{2}}{V_{1}}=\\frac{\\frac{809}{16}}{\\frac{13}{12}}=\\frac{809}{16}\\cdot\\frac{12}{13}=\\frac{2427}{52}\\approx 46.6730769,$$\n保留三位有效数字后，结果为 $46.7$。", "answer": "$$\\boxed{46.7}$$", "id": "1961127"}]}