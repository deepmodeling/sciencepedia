{"hands_on_practices": [{"introduction": "贝叶斯统计中的一个核心任务是根据观测数据更新我们对未知参数的信念。泊松-伽马模型是处理计数数据的经典范例，其中伽马分布是泊松分布率参数的共轭先验。这个练习将带你亲手实践如何在一个具体的物理学场景中，利用新观测到的事件数来更新我们对事件发生率的后验分布 [@problem_id:1909044]。", "problem": "一位物理学家正在使用一种新传感器研究宇宙射线的探测率。在固定的时间间隔内，探测次数 $k$ 服从泊松（Poisson）分布，其率参数 $\\lambda$ 未知。泊松分布的概率质量函数为 $P(k|\\lambda) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$，其中 $k = 0, 1, 2, \\dots$。\n\n在进行实验之前，该物理学家关于率参数 $\\lambda$（单位：次/小时）的先验信念由一个伽马（Gamma）分布描述。形状参数为 $\\alpha$、率参数为 $\\beta$ 的伽马分布的概率密度函数为 $p(\\lambda|\\alpha, \\beta) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta\\lambda)$，其中 $\\lambda  0$。该物理学家的先验分布由形状参数 $\\alpha_{prior} = 10$ 和率参数 $\\beta_{prior} = 2$ 指定。\n\n在单次一小时的观测周期内，该物理学家记录到 5 次宇宙射线探测。\n\n根据这次观测，确定 $\\lambda$ 的后验分布的形状参数和率参数。请将你的答案表示为一对数字：后验形状参数，后验率参数。", "solution": "我们将一小时内的计数建模为 $k \\sim \\text{Poisson}(\\lambda)$，其似然函数为\n$$\nP(k \\mid \\lambda)=\\frac{\\lambda^{k}\\exp(-\\lambda)}{k!}.\n$$\n$\\lambda$ 的先验分布为 $\\lambda \\sim \\text{Gamma}(\\alpha_{\\text{prior}},\\beta_{\\text{prior}})$，其密度函数为\n$$\np(\\lambda \\mid \\alpha_{\\text{prior}},\\beta_{\\text{prior}})=\\frac{\\beta_{\\text{prior}}^{\\alpha_{\\text{prior}}}}{\\Gamma(\\alpha_{\\text{prior}})}\\lambda^{\\alpha_{\\text{prior}}-1}\\exp(-\\beta_{\\text{prior}}\\lambda), \\quad \\lambda0.\n$$\n根据贝叶斯法则（Bayes’ rule），后验分布正比于似然函数乘以先验分布：\n$$\np(\\lambda \\mid k)\\propto P(k\\mid \\lambda)\\,p(\\lambda \\mid \\alpha_{\\text{prior}},\\beta_{\\text{prior}})\n\\propto \\left[\\lambda^{k}\\exp(-\\lambda)\\right]\\left[\\lambda^{\\alpha_{\\text{prior}}-1}\\exp(-\\beta_{\\text{prior}}\\lambda)\\right].\n$$\n合并 $\\lambda$ 的幂次项和指数项：\n$$\np(\\lambda \\mid k)\\propto \\lambda^{(\\alpha_{\\text{prior}}+k)-1}\\exp\\!\\left(-(\\beta_{\\text{prior}}+1)\\lambda\\right).\n$$\n这是一个伽马（Gamma）分布的核，其形状参数为 $\\alpha_{\\text{post}}=\\alpha_{\\text{prior}}+k$，率参数为 $\\beta_{\\text{post}}=\\beta_{\\text{prior}}+1$（其中的 $+1$ 来自于一小时的观测窗口）。\n\n代入给定值 $\\alpha_{\\text{prior}}=10$, $\\beta_{\\text{prior}}=2$ 和 $k=5$：\n$$\n\\alpha_{\\text{post}}=10+5=15, \\quad \\beta_{\\text{post}}=2+1=3.\n$$\n因此，后验分布为 $\\text{Gamma}(15,3)$，所以所求的数对是后验形状参数和率参数 $(15,3)$。", "answer": "$$\\boxed{\\begin{pmatrix}15  3\\end{pmatrix}}$$", "id": "1909044"}, {"introduction": "当我们处理的不是单一事件，而是多个互斥类别的分类问题时，狄利克雷-多项分布模型就显得尤为重要。狄利克雷分布作为多项分布概率向量的共轭先验，极大地简化了多分类问题中的后验推断。通过这个天文学分类的例子，你将学会如何将共轭先验的思想从单一参数推广到多维参数空间 [@problem_id:1909019]。", "problem": "一位天文学家正在使用一种新的自动分类算法，对巡天望远镜观测到的天体进行分类。该算法将每个探测到的天体分为三类之一：恒星、星系或星云。设任意给定天体属于这几类的未知概率分别为 $p_S$、$p_G$ 和 $p_N$，其中 $p_S + p_G + p_N = 1$。\n\n天文学家对概率向量 $\\mathbf{p} = (p_S, p_G, p_N)$ 的先验信念由一个狄利克雷分布建模，其参数为 $\\boldsymbol{\\alpha} = (\\alpha_S, \\alpha_G, \\alpha_N) = (3, 5, 2)$。\n\n经过一次试运行后，该算法被应用于一组新的观测数据，得到以下计数：40个恒星，50个星系和10个星云。\n\n在观测到这些新数据后，概率向量 $\\mathbf{p}$ 的后验狄利克雷分布的参数是什么？请以行矩阵 $\\begin{pmatrix} \\alpha'_S  \\alpha'_G  \\alpha'_N \\end{pmatrix}$ 的形式给出你的答案。", "solution": "我们将类别概率 $\\mathbf{p}=(p_{S},p_{G},p_{N})$ 用一个参数为 $\\boldsymbol{\\alpha}=(\\alpha_{S},\\alpha_{G},\\alpha_{N})=(3,5,2)$ 的狄利克雷先验进行建模，记作 $\\mathbf{p}\\sim\\mathrm{Dir}(\\alpha_{S},\\alpha_{G},\\alpha_{N})$。数据由多项式采样得到，其计数为：$n_{S}=40$，$n_{G}=50$ 和 $n_{N}=10$。根据狄利克雷-多项式共轭性，后验分布也是狄利克雷分布，其更新后的参数按分量由以下公式给出：\n$$\n\\alpha'_{k}=\\alpha_{k}+n_{k}\\quad\\text{for}\\quad k\\in\\{S,G,N\\}.\n$$\n应用此更新规则可得\n$$\n\\alpha'_{S}=3+40=43,\\quad \\alpha'_{G}=5+50=55,\\quad \\alpha'_{N}=2+10=12.\n$$\n因此，后验狄利克雷分布的参数为\n$$\n\\begin{pmatrix}43  55  12\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}43  55  12\\end{pmatrix}}$$", "id": "1909019"}, {"introduction": "在数据分析中，观测到“无事件发生”本身就是一种重要的信息。这个练习将引导我们思考“零观测”如何量化地影响我们对一个稀有事件发生率的信念。通过计算后验均值与先验均值的比率，你将从概念上理解贝叶斯更新如何系统地根据新证据（即使是“无”证据）来调整我们的认知 [@problem_id:1909067]。", "problem": "一位数据科学家正在对一个大型分布式计算系统中一种罕见但关键的警报的发生情况进行建模。他们将一小时内警报发生的次数建模为一个随机变量 $X$，该变量服从泊松分布，其率参数 $\\lambda$ 未知，其中 $\\lambda$ 表示每小时的平均警报次数。泊松分布的概率质量函数为 $P(X=k|\\lambda) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$，其中 $k = 0, 1, 2, \\dots$。\n\n根据来自类似系统的性能指标，该数据科学家对 $\\lambda$ 的先验信念由一个伽马分布建模，其形状参数为 $\\alpha_0  0$，率参数为 $\\beta_0  0$。伽马分布的概率密度函数为 $p(\\lambda) = \\frac{\\beta_0^{\\alpha_0}}{\\Gamma(\\alpha_0)} \\lambda^{\\alpha_0 - 1} \\exp(-\\beta_0 \\lambda)$，其中 $\\lambda  0$。\n\n在部署了一个新的监控工具后，对系统进行了一个小时的观察，记录到零次关键警报。数据科学家利用这一新信息更新他们对 $\\lambda$ 的信念，以形成后验分布。\n\n求 $\\lambda$ 的后验均值与先验均值之比。请用初始先验参数的符号表达式表示你的答案。", "solution": "我们将 $X \\mid \\lambda \\sim \\mathrm{Poisson}(\\lambda)$ 建模，其先验为 $\\lambda \\sim \\mathrm{Gamma}(\\alpha_{0}, \\beta_{0})$，采用率参数化，其密度为\n$$\np(\\lambda)=\\frac{\\beta_{0}^{\\alpha_{0}}}{\\Gamma(\\alpha_{0})}\\lambda^{\\alpha_{0}-1}\\exp(-\\beta_{0}\\lambda), \\quad \\lambda0.\n$$\n观测数据为一小时内的单次计数 $x=0$。$x=0$ 的似然函数为\n$$\np(x=0 \\mid \\lambda)=\\frac{\\lambda^{0}\\exp(-\\lambda)}{0!}=\\exp(-\\lambda).\n$$\n根据贝叶斯定理，后验分布正比于似然函数与先验分布的乘积：\n$$\np(\\lambda \\mid x=0)\\propto p(x=0 \\mid \\lambda)\\,p(\\lambda)=\\exp(-\\lambda)\\,\\lambda^{\\alpha_{0}-1}\\exp(-\\beta_{0}\\lambda)=\\lambda^{\\alpha_{0}-1}\\exp\\!\\bigl(-(\\beta_{0}+1)\\lambda\\bigr).\n$$\n识别出这是一个具有相同形状和更新后率参数的伽马分布的核，我们得到\n$$\n\\lambda \\mid x=0 \\sim \\mathrm{Gamma}(\\alpha_{0},\\,\\beta_{0}+1),\n$$\n其密度为\n$$\np(\\lambda \\mid x=0)=\\frac{(\\beta_{0}+1)^{\\alpha_{0}}}{\\Gamma(\\alpha_{0})}\\lambda^{\\alpha_{0}-1}\\exp\\!\\bigl(-(\\beta_{0}+1)\\lambda\\bigr).\n$$\n对于一个率参数为 $\\beta$ 的 $\\mathrm{Gamma}(\\alpha,\\beta)$ 分布，其均值为 $\\alpha/\\beta$。因此，\n$$\n\\mathbb{E}[\\lambda]=\\frac{\\alpha_{0}}{\\beta_{0}}, \\qquad \\mathbb{E}[\\lambda \\mid x=0]=\\frac{\\alpha_{0}}{\\beta_{0}+1}.\n$$\n后验均值与先验均值之比为\n$$\n\\frac{\\mathbb{E}[\\lambda \\mid x=0]}{\\mathbb{E}[\\lambda]}=\\frac{\\alpha_{0}/(\\beta_{0}+1)}{\\alpha_{0}/\\beta_{0}}=\\frac{\\beta_{0}}{\\beta_{0}+1}.\n$$", "answer": "$$\\boxed{\\frac{\\beta_{0}}{\\beta_{0}+1}}$$", "id": "1909067"}]}