{"hands_on_practices": [{"introduction": "贝叶斯分析的一个关键部分是将先验知识量化。这个练习展示了一种实用的方法，可以将专家的定性陈述（如中位数和置信区间）转化为贝塔分布的定量参数 $\\alpha$ 和 $\\beta$，这是一种常用于比例参数的先验分布。这项练习将先验分布的抽象概念置于一个现实的任务中，即如何为未知比例 $\\theta$ 构建一个合理的先验分布。", "problem": "一个天体物理学家团队正在尝试估计某一类系外行星拥有大气生物印记的比例 $\\theta$。为了给这个未知比例建立一个先验分布，他们咨询了一位行星科学领域的资深专家。该专家表示，其主观看法是 $\\theta$ 的中位数为 0.5，并且真实比例 $\\theta$ 有 50% 的概率落在 0.42 和 0.58 之间。\n\n该团队决定使用 Beta($\\alpha, \\beta$) 分布为该先验信念建模，其概率密度函数在 $x \\in [0, 1]$ 和参数 $\\alpha, \\beta > 0$ 的条件下，正比于 $x^{\\alpha-1}(1-x)^{\\beta-1}$。在本任务中，您可以假设对于没有严重偏斜且参数足够大的 Beta 分布，其中心分位数可以用正态分布来近似。具体而言，第25百分位数和第75百分位数可分别近似为 $\\mu - z^* \\sigma$ 和 $\\mu + z^* \\sigma$，其中 $\\mu$ 是均值，$\\sigma$ 是标准差，常数 $z^*$ 约等于 $0.6745$。\n\n假设专家的主观看法可由此模型和近似方法充分描述，请确定 Beta 分布的参数 $\\alpha$ 和 $\\beta$。按顺序报告您的 $\\alpha$ 和 $\\beta$ 值，并四舍五入至三位有效数字。", "solution": "我们将先验分布建模为 $\\theta \\sim \\text{Beta}(\\alpha,\\beta)$。对于 Beta 分布，其均值和方差为\n$$\\mu=\\frac{\\alpha}{\\alpha+\\beta}, \\qquad \\sigma^{2}=\\frac{\\alpha\\beta}{(\\alpha+\\beta)^{2}(\\alpha+\\beta+1)}.$$\n\n专家表示其中位数为 $0.5$，并且分布的中心 $50\\%$ 位于 $0.42$ 和 $0.58$ 之间。根据给定的中心分位数正态近似，第一和第三四分位数满足\n$$Q_{1}\\approx \\mu - z^{*}\\sigma, \\qquad Q_{3}\\approx \\mu + z^{*}\\sigma,$$\n其中 $z^{*}\\approx 0.6745$。区间 $[0.42,\\,0.58]$ 代表四分位距，因此\n$$Q_{1}=0.42, \\qquad Q_{3}=0.58.$$\n\n将这两者相加再除以 $2$ 即可得到均值：\n$$\\mu \\approx \\frac{Q_{1}+Q_{3}}{2}=\\frac{0.42+0.58}{2}=0.5.$$\n因此\n$$\\frac{\\alpha}{\\alpha+\\beta}=0.5 \\quad \\Longrightarrow \\quad \\alpha=\\beta.$$\n令 $\\alpha=\\beta=a$。则方差可简化为\n$$\\sigma^{2}=\\frac{a^{2}}{(2a)^{2}(2a+1)}=\\frac{1}{4(2a+1)}, \\qquad \\sigma=\\frac{1}{2\\sqrt{2a+1}}.$$\n\n从 $Q_{3}-\\mu\\approx z^{*}\\sigma$ 可得\n$$0.58-0.50 = z^{*}\\sigma \\quad \\Longrightarrow \\quad \\sigma=\\frac{0.08}{z^{*}}.$$\n将此结果与用 $a$ 表示的 $\\sigma$ 的表达式相等，\n$$\\frac{1}{2\\sqrt{2a+1}}=\\frac{0.08}{z^{*}} \\quad \\Longrightarrow \\quad \\sqrt{2a+1}=\\frac{z^{*}}{0.16} \\quad \\Longrightarrow \\quad 2a+1=\\left(\\frac{z^{*}}{0.16}\\right)^{2}.$$\n因此\n$$a=\\frac{1}{2}\\left[\\left(\\frac{z^{*}}{0.16}\\right)^{2}-1\\right].$$\n\n代入 $z^{*}=0.6745$，\n$$\\frac{z^{*}}{0.16}=\\frac{0.6745}{0.16}=4.215625,\\quad \\left(\\frac{z^{*}}{0.16}\\right)^{2}=17.771494140625,$$\n所以\n$$a=\\frac{17.771494140625-1}{2}=8.3857470703125.$$\n\n因此，$\\alpha=\\beta\\approx 8.3857470703125$，四舍五入到三位有效数字后得到\n$$\\alpha\\approx 8.39,\\qquad \\beta\\approx 8.39.$$", "answer": "$$\\boxed{\\begin{pmatrix}8.39  8.39\\end{pmatrix}}$$", "id": "1898866"}, {"introduction": "一旦建立了先验分布，下一步就是用观测数据来更新它。这个问题阐释了使用共轭先验的优雅之处，即后验分布与先验分布属于同一族分布，从而简化了计算。我们将看到，观测一个玩家解决谜题所需的尝试次数（几何分布似然）如何更新一个关于成功概率 $p$ 的贝塔先验分布，并计算后验均值作为修正后的估计值。", "problem": "一家教育科技公司的数据科学家正在分析玩家在一款新谜题上的表现。玩家为取得首次成功所需的尝试次数 $K$ 由一个几何分布建模，其概率质量函数为 $P(K=k|p) = p(1-p)^{k-1}$，其中 $k=1, 2, 3, \\dots$。此处，$p$ 是在任何单次尝试中解开谜题的未知概率，对于给定玩家，该概率假定为常数。\n\n这位科学家使用贝叶斯方法来更新她对参数 $p$ 的信念。她对 $p$ 的先验信念由一个参数为 $\\alpha_0 = 4$ 和 $\\beta_0 = 6$ 的贝塔分布描述。\n\n一名来自目标受众的玩家被招募进行测试，观测到他/她用了 $k_{obs} = 8$ 次尝试才首次解开谜题。根据这一观测结果，计算该科学家对概率 $p$ 的更新估计值。具体来说，计算 $p$ 的后验均值。\n\n将您的最终答案四舍五入至四位有效数字。", "solution": "我们用几何似然来对首次成功前的尝试次数进行建模\n$$\nP(K=k \\mid p)=p(1-p)^{k-1}, \\quad k=1,2,3,\\dots .\n$$\n$p$ 的先验是 $\\operatorname{Beta}(\\alpha_{0},\\beta_{0})$，其密度正比于\n$$\n\\pi(p)\\propto p^{\\alpha_{0}-1}(1-p)^{\\beta_{0}-1}.\n$$\n给定单个观测值 $k_{\\text{obs}}$，根据贝叶斯法则，后验与似然和先验的乘积成正比：\n$$\n\\pi(p \\mid k_{\\text{obs}})\\propto \\left[p(1-p)^{k_{\\text{obs}}-1}\\right]\\cdot p^{\\alpha_{0}-1}(1-p)^{\\beta_{0}-1}\n= p^{\\alpha_{0}}(1-p)^{\\beta_{0}+k_{\\text{obs}}-2}.\n$$\n识别出贝塔核，后验分布为\n$$\np \\mid k_{\\text{obs}} \\sim \\operatorname{Beta}\\big(\\alpha_{0}+1,\\ \\beta_{0}+k_{\\text{obs}}-1\\big).\n$$\n对于一个 $\\operatorname{Beta}(\\alpha,\\beta)$ 分布，其后验均值为\n$$\n\\mathbb{E}[p \\mid k_{\\text{obs}}]=\\frac{\\alpha}{\\alpha+\\beta}.\n$$\n代入 $\\alpha_{0}=4$、$\\beta_{0}=6$ 和 $k_{\\text{obs}}=8$，我们得到\n$$\n\\alpha=\\alpha_{0}+1=5,\\qquad \\beta=\\beta_{0}+k_{\\text{obs}}-1=13,\n$$\n所以\n$$\n\\mathbb{E}[p \\mid k_{\\text{obs}}]=\\frac{5}{5+13}=\\frac{5}{18}.\n$$\n数值上，$\\frac{5}{18}=0.277777\\ldots$，四舍五入到四位有效数字为 $0.2778$。", "answer": "$$\\boxed{0.2778}$$", "id": "1898877"}, {"introduction": "除了后验均值，另一种总结后验分布的常用方法是找到它的峰值或众数，这被称为最大后验（MAP）估计。这个练习在一个涉及均匀分布的非标准场景中探讨了MAP估计，揭示了观测数据如何直接约束参数空间并影响最终的估计结果。通过这个例子，你可以理解MAP估计与最大似然估计的联系与区别，以及先验信息在其中的作用。", "problem": "一位材料科学家正在开发一种用于3D打印的新型线材。这种线材的断裂强度（以兆帕斯卡(MPa)为单位）在理论上服从0和一个最大强度 $\\theta$ 之间的均匀分布。这个最大强度 $\\theta$ 是一个未知参数，它取决于特定的生产批次。\n\n根据材料成分理论，该科学家对 $\\theta$ 的先验信念由一个逆伽马分布描述，其形状参数为 $\\alpha = 4$，尺度参数为 $\\beta = 120$。$\\theta$ 的先验概率密度函数为 $p(\\theta) \\propto \\theta^{-(\\alpha+1)} \\exp(-\\frac{\\beta}{\\theta})$ (当 $\\theta > 0$ 时)。\n\n为了估计一个新批次的 $\\theta$，随机抽取 $n=6$ 根线材样本进行测试，直到它们断裂。记录的断裂强度为：\n$S = \\{32.5, 41.2, 28.9, 35.1, 45.8, 38.0\\}$ MPa。\n\n假设观测到的强度是来自均匀分布 Uniform$(0, \\theta)$ 的独立同分布样本，请确定参数 $\\theta$ 的最大后验（MAP）估计值。\n\n将您的答案（估计的最大强度）以MPa为单位表示，并四舍五入到四位有效数字。", "solution": "问题要求解参数 $\\theta$ 的最大后验（MAP）估计。MAP估计是使后验分布 $p(\\theta|\\mathbf{s})$ 最大化的 $\\theta$ 值，后验分布由贝叶斯定理确定：$p(\\theta|\\mathbf{s}) \\propto L(\\mathbf{s}|\\theta) p(\\theta)$，其中 $L(\\mathbf{s}|\\theta)$ 是似然函数，$p(\\theta)$ 是先验分布。\n\n**步骤1：定义似然函数**\n观测值 $s_1, \\ldots, s_n$ 是来自均匀分布 Uniform$(0, \\theta)$ 的独立同分布（i.i.d.）样本。单个观测值 $s_i$ 的概率密度函数（PDF）为 $f(s_i|\\theta) = \\frac{1}{\\theta}$ (当 $0 \\le s_i \\le \\theta$ 时)，否则为0。\n\n似然函数 $L(\\mathbf{s}|\\theta)$ 是在给定参数 $\\theta$ 的条件下观测到数据 $\\mathbf{s} = \\{s_1, \\ldots, s_n\\}$ 的联合概率：\n$$L(\\mathbf{s}|\\theta) = \\prod_{i=1}^{n} f(s_i|\\theta) = \\prod_{i=1}^{n} \\left(\\frac{1}{\\theta}\\right) I(0 \\le s_i \\le \\theta)$$\n其中 $I(\\cdot)$ 是指示函数。条件 $0 \\le s_i \\le \\theta$ 必须对所有的 $i$ 都成立。这等价于要求 $\\theta$ 必须大于或等于样本中的最大值。令 $s_{\\max} = \\max(s_1, \\ldots, s_n)$。似然函数可以写为：\n$$L(\\mathbf{s}|\\theta) = \\left(\\frac{1}{\\theta}\\right)^n I(\\theta \\ge s_{\\max}) = \\theta^{-n} I(\\theta \\ge s_{\\max})$$\n\n**步骤2：定义先验分布**\n$\\theta$ 的先验分布是逆伽马分布 IG$(\\alpha, \\beta)$，其概率密度函数（PDF）正比于：\n$$p(\\theta) \\propto \\theta^{-(\\alpha+1)} \\exp\\left(-\\frac{\\beta}{\\theta}\\right) \\quad \\text{for } \\theta > 0$$\n给定的超参数为 $\\alpha = 4$ 和 $\\beta = 120$。\n\n**步骤3：确定后验分布**\n后验分布正比于似然函数与先验分布的乘积：\n$$p(\\theta|\\mathbf{s}) \\propto L(\\mathbf{s}|\\theta) p(\\theta)$$\n$$p(\\theta|\\mathbf{s}) \\propto \\left( \\theta^{-n} I(\\theta \\ge s_{\\max}) \\right) \\left( \\theta^{-(\\alpha+1)} \\exp\\left(-\\frac{\\beta}{\\theta}\\right) \\right)$$\n合并各项并将指示函数纳入 $\\theta$ 的定义域：\n$$p(\\theta|\\mathbf{s}) \\propto \\theta^{-n - (\\alpha+1)} \\exp\\left(-\\frac{\\beta}{\\theta}\\right) = \\theta^{-(n+\\alpha+1)} \\exp\\left(-\\frac{\\beta}{\\theta}\\right), \\quad \\text{for } \\theta \\ge s_{\\max}$$\n\n**步骤4：求解MAP估计**\nMAP估计是使后验分布最大化的 $\\theta$ 值。通常，最大化后验分布的自然对数会更容易，因为对数是单调函数。\n令 $g(\\theta) = \\ln(p(\\theta|\\mathbf{s}))$。对于 $\\theta \\ge s_{\\max}$：\n$$g(\\theta) = \\text{const} - (n+\\alpha+1)\\ln(\\theta) - \\frac{\\beta}{\\theta}$$\n为了找到最大值，我们对 $g(\\theta)$ 关于 $\\theta$ 求导，并令其等于零。\n$$\\frac{dg}{d\\theta} = -\\frac{n+\\alpha+1}{\\theta} + \\frac{\\beta}{\\theta^2}$$\n令导数为零，得到临界点，我们记为 $\\theta^*$：\n$$-\\frac{n+\\alpha+1}{\\theta^*} + \\frac{\\beta}{(\\theta^*)^2} = 0 \\implies \\frac{\\beta}{(\\theta^*)^2} = \\frac{n+\\alpha+1}{\\theta^*} \\implies \\theta^* = \\frac{\\beta}{n+\\alpha+1}$$\n这个值 $\\theta^*$ 是无约束后验分布的众数。二阶导数 $\\frac{d^2g}{d\\theta^2} = \\frac{n+\\alpha+1}{\\theta^2} - \\frac{2\\beta}{\\theta^3}$ 在 $\\theta=\\theta^*$ 处为负，确认了该点是一个极大值点。\n\n然而，后验分布仅在 $\\theta \\ge s_{\\max}$ 时有定义。我们必须在这个受限的定义域上找到后验函数的最大值。\n函数 $g(\\theta)$ 在 $\\theta  \\theta^*$ 时是增函数，在 $\\theta  \\theta^*$ 时是减函数。这导致两种情况：\n1. 如果 $\\theta^* \\ge s_{\\max}$：无约束的最大值点位于有效定义域内。因此，MAP估计为 $\\theta_{\\text{MAP}} = \\theta^*$。\n2. 如果 $\\theta^*  s_{\\max}$：无约束的最大值点位于有效定义域之外。在定义域 $[\\,s_{\\max}, \\infty)$ 上，函数是严格递减的。因此，最大值出现在边界处，即 $\\theta_{\\text{MAP}} = s_{\\max}$。\n\n综合这两种情况，MAP估计由 $\\theta_{\\text{MAP}} = \\max(s_{\\max}, \\theta^*)$ 给出。\n\n**步骤5：计算数值**\n题目给出了以下数值：\n- $n = 6$\n- $\\alpha = 4$\n- $\\beta = 120$\n- 数据 $\\mathbf{s} = \\{32.5, 41.2, 28.9, 35.1, 45.8, 38.0\\}$ MPa\n\n首先，我们找到数据样本中的最大值：\n$$s_{\\max} = \\max\\{32.5, 41.2, 28.9, 35.1, 45.8, 38.0\\} = 45.8 \\text{ MPa}$$\n\n接下来，我们计算无约束的众数 $\\theta^*$：\n$$\\theta^* = \\frac{\\beta}{n+\\alpha+1} = \\frac{120}{6+4+1} = \\frac{120}{11} \\approx 10.909 \\text{ MPa}$$\n\n现在，我们通过比较 $s_{\\max}$ 和 $\\theta^*$ 来找到MAP估计：\n$$\\theta_{\\text{MAP}} = \\max(s_{\\max}, \\theta^*) = \\max(45.8, 10.909) = 45.8 \\text{ MPa}$$\n\n题目要求答案四舍五入到四位有效数字。\n$$\\theta_{\\text{MAP}} = 45.80$$", "answer": "$$\\boxed{45.80}$$", "id": "1898906"}]}