{"hands_on_practices": [{"introduction": "让我们从一个直观的例子开始，探索预测分布的基本机制。在这个练习中 [@problem_id:1946862]，我们将处理一个参数（骰子的面数 $N$）不确定的情况。通过结合我们对骰子面数的先验知识和一次投掷的观测数据，我们将学习如何更新我们的信念，并对下一次投掷的结果做出预测，这是贝叶斯推理的核心过程。", "problem": "一家游戏博物馆的档案管理员正在对一批来自某历史学会的特殊多面体骰子进行编目。已知这些骰子是公平的（即，对于一个有 $N$ 个面的骰子，任何给定结果的概率为 $1/N$）。这批收藏中的骰子有 4、6 或 8 个面，其面上的数字从 1 开始连续编号。根据该学会的收藏记录，档案管理员为一个随机选取的骰子的面数 $N$ 建立了一个先验概率分布。先验概率如下：\n- 骰子有 4 个面的概率是 $P(N=4) = \\frac{1}{2}$。\n- 骰子有 6 个面的概率是 $P(N=6) = \\frac{1}{3}$。\n- 骰子有 8 个面的概率是 $P(N=8) = \\frac{1}{6}$。\n\n档案管理员从收藏中随机选取一个骰子并掷了一次，观察其结果。第一次投掷的结果，我们称之为 $D_1$，是 3。档案管理员计划将同一个骰子再掷一次。设第二次投掷的结果为 $D_2$。\n\n计算在已知第一次投掷结果的情况下，第二次投掷结果为 7 的概率。换句话说，求 $P(D_2=7 | D_1=3)$。请将你的答案表示为一个最简分数。", "solution": "设 $N\\in\\{4,6,8\\}$ 表示骰子的面数。先验概率为 $P(N=4)=\\frac{1}{2}$，$P(N=6)=\\frac{1}{3}$，以及 $P(N=8)=\\frac{1}{6}$。给定一个公平的 $N$ 面骰子，对于任何 $k\\in\\{1,\\dots,N\\}$，我们有 $P(D=k\\mid N)=\\frac{1}{N}$。因为 $3\\leq 4,6,8$，所以对于 $n\\in\\{4,6,8\\}$，似然函数为 $P(D_{1}=3\\mid N=n)=\\frac{1}{n}$。\n\n根据贝叶斯定理，\n$$\nP(N=n\\mid D_{1}=3)=\\frac{P(D_{1}=3\\mid N=n)P(N=n)}{\\sum_{m\\in\\{4,6,8\\}}P(D_{1}=3\\mid N=m)P(N=m)}=\\frac{\\frac{1}{n}P(N=n)}{\\frac{1}{4}\\cdot\\frac{1}{2}+\\frac{1}{6}\\cdot\\frac{1}{3}+\\frac{1}{8}\\cdot\\frac{1}{6}}.\n$$\n计算归一化分母：\n$$\n\\frac{1}{4}\\cdot\\frac{1}{2}+\\frac{1}{6}\\cdot\\frac{1}{3}+\\frac{1}{8}\\cdot\\frac{1}{6}=\\frac{1}{8}+\\frac{1}{18}+\\frac{1}{48}=\\frac{29}{144}.\n$$\n因此，\n$$\nP(N=4\\mid D_{1}=3)=\\frac{\\frac{1}{8}}{\\frac{29}{144}}=\\frac{18}{29},\\quad\nP(N=6\\mid D_{1}=3)=\\frac{\\frac{1}{18}}{\\frac{29}{144}}=\\frac{8}{29},\\quad\nP(N=8\\mid D_{1}=3)=\\frac{\\frac{1}{48}}{\\frac{29}{144}}=\\frac{3}{29}.\n$$\n\n给定 $N$，各次投掷是独立的，并且如果 $k \\le n$，则 $P(D_{2}=k\\mid N=n)$ 等于 $\\frac{1}{n}$，否则为 0。当 $k=7$ 时，只有当 $n=8$ 时，$P(D_2=7|N=n)$ 才非零。所以，\n$$\nP(D_{2}=7\\mid D_{1}=3)=\\sum_{n\\in\\{4,6,8\\}}P(D_{2}=7\\mid N=n)\\,P(N=n\\mid D_{1}=3) = P(D_2=7|N=8) P(N=8|D_1=3) = \\frac{1}{8}\\cdot\\frac{3}{29}=\\frac{3}{232}.\n$$", "answer": "$$\\boxed{\\frac{3}{232}}$$", "id": "1946862"}, {"introduction": "在许多科学应用中，我们处理的是连续参数和测量值。这个练习 [@problem_id:1946911] 将带你进入贝叶斯分析最常用的模型之一：正态-正态共轭模型。你将扮演一位材料科学家的角色，利用实验数据来更新对材料某一特性 $\\mu$ 的认识，并预测未来测量的可能范围，这在实验设计和结果解释中至关重要。", "problem": "一位材料科学家正在研究一个与新制造晶体的压电响应相关的无量纲参数 $\\mu$。已知测量仪器产生的读数服从正态分布，其真实均值为 $\\mu$，已知方差为1。\n\n基于对类似材料的先验理论计算，该科学家使用均值为0.5、方差为0.25的正态分布来为其对 $\\mu$ 的信念建模。\n\n然后，该科学家进行了四次独立测量，获得了以下数值：1.2、1.8、2.0 和 1.0。\n\n在使用这些数据更新其对 $\\mu$ 的信念后，下一次单次测量值落在区间 $(-1, 1)$ 内的概率是多少？\n\n将您的最终答案四舍五入到三位有效数字。", "solution": "设测量模型为 $y_{i} \\mid \\mu \\sim \\text{Normal}(\\mu, \\sigma^{2})$，其中 $\\sigma^{2}=1$；先验分布为 $\\mu \\sim \\text{Normal}(m_{0}, v_{0})$，其中 $m_{0}=0.5$ 且 $v_{0}=\\frac{1}{4}$。定义精度 $\\tau_{0}=\\frac{1}{v_{0}}$ 和 $\\tau=\\frac{1}{\\sigma^{2}}$。\n\n对于 $n$ 个独立观测值 $y_{1},\\dots,y_{n}$，共轭正态后验分布为\n$$\nv_{n}=\\frac{1}{\\tau_{0}+n\\tau}, \\qquad m_{n}=v_{n}\\left(\\tau_{0}m_{0}+\\tau\\sum_{i=1}^{n}y_{i}\\right).\n$$\n这里 $n=4$，数据总和为 $\\sum_{i=1}^{4}y_{i}=1.2+1.8+2.0+1.0=6.0$。当 $v_{0}=\\frac{1}{4}$ 时，我们有 $\\tau_{0}=4$；当 $\\sigma^{2}=1$ 时，我们有 $\\tau=1$。因此\n$$\nv_{n}=\\frac{1}{4+4}=\\frac{1}{8}, \\qquad m_{n}=\\frac{1}{8}\\left(4\\cdot 0.5+1\\cdot 6\\right)=\\frac{1}{8}(2+6)=1.\n$$\n\n对 $\\mu$ 进行边缘化后，新测量值 $Y_{\\text{new}}$ 的后验预测分布是均值为 $m_{n}$、方差为 $\\sigma^{2}+v_{n}$ 的正态分布：\n$$\nY_{\\text{new}} \\mid \\text{data} \\sim \\text{Normal}\\left(m_{n},\\,\\sigma^{2}+v_{n}\\right)=\\text{Normal}\\left(1,\\,1+\\frac{1}{8}\\right)=\\text{Normal}\\left(1,\\,\\frac{9}{8}\\right).\n$$\n\n我们要求解 $P(-1  Y_{\\text{new}}  1)$。设 $Z$ 为标准正态随机变量。\n$$\nP(-1  Y_{\\text{new}}  1) = P\\left(\\frac{-1-1}{\\sqrt{9/8}}  Z  \\frac{1-1}{\\sqrt{9/8}}\\right) = P\\left(-1.8856  Z  0\\right).\n$$\n这等于\n$$\n\\Phi(0) - \\Phi(-1.8856) = 0.5 - (1 - \\Phi(1.8856)) = \\Phi(1.8856) - 0.5 \\approx 0.97034 - 0.5 = 0.47034.\n$$\n四舍五入到三位有效数字，结果是 0.470。", "answer": "$$\\boxed{0.470}$$", "id": "1946911"}, {"introduction": "贝叶斯分析的一个核心特点是它能够量化和更新信念，而先验分布的选择是这一过程的关键。这个练习 [@problem_id:1946883] 通过一个质量控制的场景，对比了信息贫乏的先验（均匀分布）和信息丰富的先验对预测结果的影响。通过计算和比较两位分析师的后验预测方差，你将深刻理解先验选择如何影响我们对未来事件预测的确定性。", "problem": "在一家半导体制造厂中，一批集成电路的质量通过单个随机选取的电路是次品的概率 $\\theta$ 来评估。假设大小为 $N$ 的样本中次品的数量服从参数为 $\\theta$ 的二项分布。\n\n两名统计学家，一位初级分析师和一位高级分析师，负责预测未来一批产品中的次品数量。他们从贝叶斯角度来解决这个问题。\n\n初级分析师由于缺乏这一新工艺的具体历史数据，对 $\\theta$ 采用无信息先验。他们使用参数为 $\\alpha_J = 1$ 和 $\\beta_J = 1$ 的贝塔分布来为其信念建模。\n\n高级分析师根据类似制造工艺的经验，认为次品率可能接近 0.5。他们使用一个信息更丰富的先验，即参数为 $\\alpha_S = 10$ 和 $\\beta_S = 10$ 的贝塔分布。\n\n之后，两位分析师观察了来自一个测试批次的相同初始数据：检查了 $n=20$ 个电路的样本，发现其中有 $k=15$ 个是次品。在用这些数据更新了他们的信念之后，他们被要求对未来一批 $m=50$ 个电路的产品进行预测。\n\n设 $V_J$ 为初级分析师对新批次中次品数量的后验预测分布的方差，设 $V_S$ 为高级分析师的后验预测分布的方差。\n\n计算比率 $\\frac{V_J}{V_S}$。将你的最终答案四舍五入到四位有效数字。", "solution": "设次品概率为 $\\theta$，测试批次的数据为 $n$ 个项目中存在 $k$ 个次品。对于 $\\mathrm{Beta}(\\alpha,\\beta)$ 先验和二项似然，后验分布为 $\\mathrm{Beta}(\\alpha',\\beta')$，其中 $\\alpha'=\\alpha+k$ 且 $\\beta'=\\beta+n-k$。对于未来一批大小为 $m$ 的产品，次品数量 $X$ 的后验预测分布是 $\\mathrm{Beta\\text{-}Binomial}(m,\\alpha',\\beta')$，其方差为\n$$\n\\operatorname{Var}(X)=m\\,\\frac{\\alpha'\\beta'}{(\\alpha'+\\beta')^{2}}\\cdot\\frac{\\alpha'+\\beta'+m}{\\alpha'+\\beta'+1}\n= m\\,\\frac{\\alpha'\\beta'(\\alpha'+\\beta'+m)}{(\\alpha'+\\beta')^{2}(\\alpha'+\\beta'+1)}.\n$$\n\n初级分析师：先验为 $\\mathrm{Beta}(1,1)$，因此对于 $n=20$ 和 $k=15$，\n$$\n\\alpha'_{J}=1+15=16,\\quad \\beta'_{J}=1+5=6.\n$$\n因此\n$$\nV_{J}=m\\,\\frac{16\\cdot 6\\,(16+6+m)}{(16+6)^{2}(16+6+1)}\n=50\\,\\frac{96\\cdot(22+50)}{22^{2}\\cdot 23}\n=50\\,\\frac{96\\cdot 72}{484\\cdot 23}\n=\\frac{345600}{11132}.\n$$\n\n高级分析师：先验为 $\\mathrm{Beta}(10,10)$，因此\n$$\n\\alpha'_{S}=10+15=25,\\quad \\beta'_{S}=10+5=15.\n$$\n因此\n$$\nV_{S}=m\\,\\frac{25\\cdot 15\\,(25+15+m)}{(25+15)^{2}(25+15+1)}\n=50\\,\\frac{375\\cdot(40+50)}{40^{2}\\cdot 41}\n=50\\,\\frac{375\\cdot 90}{1600\\cdot 41}\n=\\frac{1687500}{65600}.\n$$\n\n该比率为\n$$\n\\frac{V_{J}}{V_{S}}=\\frac{345600}{11132}\\cdot\\frac{65600}{1687500}\n=\\frac{345600\\cdot 65600}{11132\\cdot 1687500}.\n$$\n数值上，\n$$\n\\frac{V_{J}}{V_{S}} \\approx \\frac{31.04563}{25.72409} \\approx 1.20687\n$$\n精确到四位有效数字是 $1.207$。", "answer": "$$\\boxed{1.207}$$", "id": "1946883"}]}