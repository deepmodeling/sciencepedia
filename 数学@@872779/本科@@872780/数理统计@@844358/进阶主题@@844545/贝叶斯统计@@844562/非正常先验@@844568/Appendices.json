{"hands_on_practices": [{"introduction": "非正常先验的核心挑战在于它们本身不是真正的概率分布。因此，它们在贝叶斯分析中的应用价值完全取决于能否通过结合观测数据，得到一个“正常”的后验分布。本练习将引导你探讨一个关键问题：需要多少数据才能“修正”一个非正常先验，从而得到一个有效的推断基础。通过这个例子 [@problem_id:1922090]，你将亲手计算确保后验分布正常性所需的最小样本量，这在任何使用非正常先验的分析中都是至关重要的第一步。", "problem": "一位统计学家正在分析某种电子元件的寿命。单个元件的寿命 $X$ 由一个指数分布建模，其率参数 $\\lambda  0$ 未知。单个观测值的概率密度函数 (PDF) 为 $f(x|\\lambda) = \\lambda \\exp(-\\lambda x)$，其中 $x  0$。\n\n为了对包含 $n$ 个元件的随机样本 $X_1, X_2, \\ldots, X_n$ 进行贝叶斯分析，该统计学家为参数 $\\lambda$ 选择了一个非正常先验分布。该先验由关系式 $p(\\lambda) \\propto \\lambda^{-3}$ 定义，其中 $\\lambda  0$。非正常先验是指在其定义域上的积分不为有限值的先验。\n\n为使贝叶斯推断有效，得到的后验分布 $p(\\lambda | X_1, \\ldots, X_n)$ 必须是一个正常分布。如果一个分布在其整个定义域上的积分为有限值，则该分布被认为是“正常的”，这使得它可以被归一化为一个有效的概率分布。\n\n假设对于任何抽取的样本（即，对于 $n \\geq 1$），观测寿命的总和为正，确定为确保 $\\lambda$ 的后验分布是正常的所需的最小整数样本量 $n$。", "solution": "设 $X_{1},\\ldots,X_{n}$ 是独立同分布 (i.i.d.) 的 $\\operatorname{Exp}(\\lambda)$ 随机变量，其密度函数为 $f(x \\mid \\lambda)=\\lambda \\exp(-\\lambda x)$，其中 $x0$。联合似然函数为\n$$\nL(\\lambda \\mid x_{1},\\ldots,x_{n})=\\prod_{i=1}^{n}\\lambda \\exp(-\\lambda x_{i})=\\lambda^{n}\\exp\\!\\left(-\\lambda \\sum_{i=1}^{n}x_{i}\\right).\n$$\n设 $S=\\sum_{i=1}^{n}x_{i}$。先验是非正常的，其密度核为 $p(\\lambda)\\propto \\lambda^{-3}$，其中 $\\lambda0$。那么后验密度核为\n$$\np(\\lambda \\mid x_{1},\\ldots,x_{n}) \\propto L(\\lambda \\mid x_{1},\\ldots,x_{n})\\,p(\\lambda)\n= \\lambda^{n}\\exp(-\\lambda S)\\cdot \\lambda^{-3}\n= \\lambda^{n-3}\\exp(-\\lambda S), \\quad \\lambda0.\n$$\n假设 $S0$，这与一个伽玛分布的密度成正比，其形状参数为 $\\alpha=n-2$，率参数为 $\\beta=S$，因为伽玛核为 $\\lambda^{\\alpha-1}\\exp(-\\beta \\lambda)$。后验分布是正常的当且仅当其在 $(0,\\infty)$ 上的积分为有限值：\n$$\n\\int_{0}^{\\infty}\\lambda^{n-3}\\exp(-S\\lambda)\\,d\\lambda  \\infty.\n$$\n使用标准的伽玛积分，\n$$\n\\int_{0}^{\\infty}\\lambda^{a-1}\\exp(-\\beta \\lambda)\\,d\\lambda=\\frac{\\Gamma(a)}{\\beta^{a}} \\quad \\text{for } a0,\\ \\beta0,\n$$\n我们识别出 $a=n-2$ 和 $\\beta=S$。由于根据假设 $S0$，积分的有限性要求 $a0$，即，\n$$\nn-20 \\quad \\Longleftrightarrow \\quad n2.\n$$\n因为 $n$ 是一个整数，确保后验分布正常的最小 $n$ 值为 $n=3$。当 $n=2$ 时，被积函数在 $0$ 附近的行为类似于 $\\lambda^{-1}$，积分发散；当 $n=1$ 时，其行为类似于 $\\lambda^{-2}$，积分也发散。", "answer": "$$\\boxed{3}$$", "id": "1922090"}, {"introduction": "在确立了后验分布需要正常之后，我们面临下一个实际问题：如何选择一个“无信息”的非正常先验？这个练习 [@problem_id:1922111] 旨在对比两种看似简单但有本质区别的非正常先验对推断结果的影响。通过为一个正态分布的均值参数 $\\mu$ 分别推导和计算不同先验下的后验期望，你将具体看到，即使是微小的先验设定差异（例如是否将参数限制在正数），也会如何显著地改变我们从数据中得出的结论。", "problem": "考虑从一个正态分布中抽取的单个观测值 $x$，该分布的均值 $\\mu$ 未知，方差已知为 1。在给定参数 $\\mu$ 的条件下，该观测值的概率密度函数 (PDF) 为 $f(x|\\mu) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2}(x-\\mu)^2\\right)$。\n\n提出了两种不同的贝叶斯模型来对未知参数 $\\mu$ 进行推断。\n\n- **模型 1**：该模型对 $\\mu$ 使用一个不当先验分布，其密度定义为 $p_1(\\mu) \\propto 1$，适用于所有实数 $\\mu$。\n- **模型 2**：该模型对 $\\mu$ 使用另一个不当先验分布，其密度定义为 $p_2(\\mu) \\propto I(\\mu  0)$，其中 $I(\\cdot)$ 是指示函数，当其参数为真时取值为 1，否则为 0。\n\n令 $E_1[\\mu]$ 为根据模型 1 推导出的后验分布下 $\\mu$ 的期望值，令 $E_2[\\mu]$ 为根据模型 2 推导出的后验分布下 $\\mu$ 的期望值。\n\n确定比率 $\\frac{E_2[\\mu]}{E_1[\\mu]}$ 作为观测值 $x$ 的函数。最终表达式可能包含标准正态 PDF $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-z^2/2)$ 和标准正态累积分布函数 (CDF) $\\Phi(z) = \\int_{-\\infty}^{z} \\phi(t) dt$。", "solution": "我们有一个来自 $X \\mid \\mu \\sim \\mathcal{N}(\\mu,1)$ 的观测值 $x$，因此作为 $\\mu$ 的函数的似然函数与 $f(x \\mid \\mu) \\propto \\exp\\!\\left(-\\frac{1}{2}(x-\\mu)^{2}\\right)$ 成正比，等价于 $f(x \\mid \\mu) \\propto \\phi(x-\\mu)$，其中 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{z^{2}}{2}\\right)$。\n\n模型 1 的先验为 $p_{1}(\\mu) \\propto 1$，适用于 $\\mu \\in \\mathbb{R}$。后验分布为\n$$\np_{1}(\\mu \\mid x) \\propto f(x \\mid \\mu) p_{1}(\\mu) \\propto \\phi(x-\\mu).\n$$\n由于 $\\int_{-\\infty}^{\\infty} \\phi(x-\\mu)\\,d\\mu = 1$，归一化的后验分布为 $p_{1}(\\mu \\mid x) = \\phi(\\mu - x)$，即 $\\mu \\mid x \\sim \\mathcal{N}(x,1)$。因此，\n$$\nE_{1}[\\mu] \\;=\\; \\int_{-\\infty}^{\\infty} \\mu\\, \\phi(\\mu - x)\\, d\\mu.\n$$\n通过变量代换 $t = \\mu - x$（因此 $\\mu = t + x$ 且 $d\\mu = dt$），我们得到\n$$\nE_{1}[\\mu] = \\int_{-\\infty}^{\\infty} (t + x)\\, \\phi(t)\\, dt \\;=\\; x \\int_{-\\infty}^{\\infty} \\phi(t)\\, dt \\;+\\; \\int_{-\\infty}^{\\infty} t\\, \\phi(t)\\, dt \\;=\\; x + 0 \\;=\\; x.\n$$\n\n模型 2 的先验为 $p_{2}(\\mu) \\propto I(\\mu  0)$。后验分布为\n$$\np_{2}(\\mu \\mid x) \\propto \\phi(x-\\mu)\\, I(\\mu  0).\n$$\n为了归一化，计算\n$$\n\\int_{0}^{\\infty} \\phi(x-\\mu)\\, d\\mu \\;=\\; \\int_{0}^{\\infty} \\phi(\\mu - x)\\, d\\mu \\;=\\; \\int_{-x}^{\\infty} \\phi(t)\\, dt \\;=\\; 1 - \\Phi(-x) \\;=\\; \\Phi(x),\n$$\n其中 $\\Phi$ 是标准正态 CDF，并且我们使用了 $\\Phi(-x) = 1 - \\Phi(x)$。因此，归一化的后验分布为\n$$\np_{2}(\\mu \\mid x) \\;=\\; \\frac{\\phi(\\mu - x)}{\\Phi(x)}\\, I(\\mu  0).\n$$\n因此，\n$$\nE_{2}[\\mu] \\;=\\; \\int_{0}^{\\infty} \\mu\\, \\frac{\\phi(\\mu - x)}{\\Phi(x)}\\, d\\mu \\;=\\; \\frac{1}{\\Phi(x)} \\int_{0}^{\\infty} \\mu\\, \\phi(\\mu - x)\\, d\\mu.\n$$\n应用变量代换 $t = \\mu - x$（因此 $\\mu = t + x$，$d\\mu = dt$，积分下限变为 $t = -x$）：\n$$\nE_{2}[\\mu] \\;=\\; \\frac{1}{\\Phi(x)} \\int_{-x}^{\\infty} (t + x)\\, \\phi(t)\\, dt \\;=\\; \\frac{1}{\\Phi(x)} \\left[ x \\int_{-x}^{\\infty} \\phi(t)\\, dt \\;+\\; \\int_{-x}^{\\infty} t\\, \\phi(t)\\, dt \\right].\n$$\n计算积分：\n- $\\int_{-x}^{\\infty} \\phi(t)\\, dt = 1 - \\Phi(-x) = \\Phi(x)$。\n- 对于第二个积分，使用 $\\frac{d}{dt}\\phi(t) = -t\\,\\phi(t)$，因此 $\\int t\\, \\phi(t)\\, dt = -\\phi(t) + C$，得到\n$$\n\\int_{-x}^{\\infty} t\\, \\phi(t)\\, dt \\;=\\; \\left[-\\phi(t)\\right]_{-x}^{\\infty} \\;=\\; 0 - \\left(-\\phi(-x)\\right) \\;=\\; \\phi(-x) \\;=\\; \\phi(x).\n$$\n因此，\n$$\nE_{2}[\\mu] \\;=\\; \\frac{1}{\\Phi(x)} \\left[ x\\, \\Phi(x) + \\phi(x) \\right] \\;=\\; x \\;+\\; \\frac{\\phi(x)}{\\Phi(x)}.\n$$\n\n最后，比率为\n$$\n\\frac{E_{2}[\\mu]}{E_{1}[\\mu]} \\;=\\; \\frac{x + \\frac{\\phi(x)}{\\Phi(x)}}{x} \\;=\\; 1 + \\frac{\\phi(x)}{x\\, \\Phi(x)},\n$$\n该表达式在 $x \\neq 0$ 时有定义；在 $x=0$ 时，由于 $E_{1}[\\mu]=0$，该比率未定义。", "answer": "$$\\boxed{1+\\frac{\\phi(x)}{x\\,\\Phi(x)}}$$", "id": "1922111"}, {"introduction": "理想的“无信息”先验应具有一个重要特性：我们对模型的推断不应因参数化的方式而改变（例如，我们是使用标准差 $\\sigma$ 还是方差 $\\phi$ 来描述模型）。这个练习 [@problem_id:1922146] 让你探索这一“不变性”概念。你将通过变量变换法则，从一个尺度参数 $\\sigma$ 的标准Jeffreys先验出发，推导其对应的方差参数 $\\phi = \\sigma^2$ 的先验形式，从而揭示Jeffreys先验在众多应用中备受青睐的一个关键性质。", "problem": "在贝叶斯统计推断中，先验分布被赋予一个未知参数，以表示在观察到数据之前关于该参数的信念。有时，对于可以在无界范围内取任何值的参数，分析师会使用所谓的非正常先验。这些函数类似于概率密度，但它们在其定义域上的积分不为有限值。尽管如此，它们通常可以导出有效的后验分布。\n\n考虑一个包含正尺度参数 $\\sigma$ 的统计模型，其中 $\\sigma  0$。对于此类尺度参数，一个广泛使用的无信息非正常先验是 Jeffreys 先验，其概率密度函数 $p(\\sigma)$ 与 $\\frac{1}{\\sigma}$ 成正比。\n\n假设一位分析师决定对模型进行重新参数化。他们选择使用方差参数 $\\phi$ 而不是尺度参数 $\\sigma$，该参数由变换 $\\phi = \\sigma^2$ 定义。你的任务是找到方差参数 $\\phi$ 对应的非正常先验。具体来说，确定函数 $f(\\phi)$，使得 $\\phi$ 的先验密度（记为 $p(\\phi)$）与 $f(\\phi)$ 成正比。", "solution": "我们从正尺度参数 $\\sigma$ 的 Jeffreys 先验开始，在比例常数范围内，其形式为 $p_{\\sigma}(\\sigma) \\propto \\frac{1}{\\sigma}$，其中 $\\sigma  0$。\n\n引入重新参数化 $\\phi = \\sigma^{2}$，其中 $\\phi  0$。那么 $\\sigma = \\phi^{1/2}$，根据密度的变量变换公式可得\n$$\np_{\\phi}(\\phi) \\propto p_{\\sigma}(\\sigma(\\phi)) \\left|\\frac{d\\sigma}{d\\phi}\\right|.\n$$\n计算雅可比行列式：\n$$\n\\frac{d\\sigma}{d\\phi} = \\frac{d}{d\\phi}\\left(\\phi^{1/2}\\right) = \\frac{1}{2}\\phi^{-1/2}.\n$$\n将 $p_{\\sigma}(\\sigma) \\propto \\frac{1}{\\sigma}$ 和 $\\sigma = \\phi^{1/2}$ 代入：\n$$\np_{\\phi}(\\phi) \\propto \\left(\\frac{1}{\\sigma(\\phi)}\\right)\\left|\\frac{d\\sigma}{d\\phi}\\right| = \\left(\\frac{1}{\\phi^{1/2}}\\right)\\left(\\frac{1}{2}\\phi^{-1/2}\\right) = \\frac{1}{2}\\phi^{-1}.\n$$\n由于在比例常数范围内指定先验时，比例常数是无关紧要的，我们得出结论\n$$\np_{\\phi}(\\phi) \\propto \\frac{1}{\\phi}, \\quad \\phi  0.\n$$\n因此，所求函数为 $f(\\phi) = \\frac{1}{\\phi}$。", "answer": "$$\\boxed{\\frac{1}{\\phi}}$$", "id": "1922146"}]}