{"hands_on_practices": [{"introduction": "贝叶斯推断的核心在于利用数据更新我们的信念。本练习 [@problem_id:1923967] 完美地诠释了这一过程，它引导你为一个未知成功概率 $p$ 更新先验知识。你将看到，为伯努利试验的概率选择一个贝叶塔（Beta）分布作为先验，如何优雅地与几何分布的似然函数结合，从而得到一个同样是贝叶塔分布的后验分布，这个过程体现了共轭先验在简化贝叶斯计算中的强大作用。", "problem": "一位量子工程师正在测试一种新的量子比特（qubit）初始化协议。在任何一次尝试中，初始化成功的概率是一个未知常数 $p$，其中 $0  p  1$。每次初始化尝试都是一次独立的试验。\n\n该工程师对概率 $p$ 的先验信念由一个具有已知超参数 $\\alpha_0  0$ 和 $\\beta_0  0$ 的贝塔分布（Beta distribution）描述。对于一个变量 $x \\in [0, 1]$，$\\text{Beta}(\\alpha, \\beta)$ 分布的概率密度函数正比于 $x^{\\alpha-1}(1-x)^{\\beta-1}$。\n\n在一个实验中，工程师重复进行初始化尝试，直到第一次成功初始化。观察到第一次成功发生在第 $k$ 次尝试。\n\n根据这个观察结果，工程师更新了他们对 $p$ 的信念。$p$ 的后验分布也是一个贝塔分布。以下哪项代表了这个后验分布的新参数 $(\\alpha_{\\text{post}}, \\beta_{\\text{post}})$？\n\nA. $(\\alpha_0 + k, \\beta_0 + 1)$\n\nB. $(\\alpha_0 + k - 1, \\beta_0 + 1)$\n\nC. $(\\alpha_0 + 1, \\beta_0 + k)$\n\nD. $(\\alpha_0 + 1, \\beta_0 + k - 1)$\n\nE. $(\\alpha_0, \\beta_0 + k - 1)$", "solution": "令 $p \\in (0,1)$ 表示每次尝试的成功概率。$p$ 的先验分布为 $\\text{Beta}(\\alpha_{0},\\beta_{0})$，其密度（在忽略归一化常数的情况下）为\n$$\nf(p)\\propto p^{\\alpha_{0}-1}(1-p)^{\\beta_{0}-1}.\n$$\n观察结果是第一次成功发生在第 $k$ 次尝试。在成功概率为 $p$ 的独立伯努利试验（Bernoulli trials）下，该事件的似然由几何模型给出：\n$$\n\\mathcal{L}(p;k)=P(K=k\\mid p)=(1-p)^{k-1}p,\n$$\n因为它包含 $k-1$ 次失败和随后的 1 次成功。\n\n根据贝叶斯法则（Bayes' rule），后验密度为\n$$\nf(p\\mid k)=\\frac{\\mathcal{L}(p;k)f(p)}{\\int_{0}^{1}\\mathcal{L}(p;k)f(p)\\,dp}\\propto \\mathcal{L}(p;k)f(p).\n$$\n代入先验核与似然函数，\n$$\nf(p\\mid k)\\propto \\left[p^{\\alpha_{0}-1}(1-p)^{\\beta_{0}-1}\\right]\\left[(1-p)^{k-1}p\\right]\n= p^{\\alpha_{0}-1+1}(1-p)^{\\beta_{0}-1+k-1}\n= p^{\\alpha_{0}}(1-p)^{\\beta_{0}+k-2}.\n$$\n识别出贝塔核 $p^{\\alpha_{\\text{post}}-1}(1-p)^{\\beta_{\\text{post}}-1}$ 的形式，我们确定\n$$\n\\alpha_{\\text{post}}-1=\\alpha_{0}\\quad\\Rightarrow\\quad \\alpha_{\\text{post}}=\\alpha_{0}+1,\\qquad\n\\beta_{\\text{post}}-1=\\beta_{0}+k-2\\quad\\Rightarrow\\quad \\beta_{\\text{post}}=\\beta_{0}+k-1.\n$$\n等价地，观察结果“第 $k$ 次首次成功”编码了 1 次成功和 $k-1$ 次失败，这产生了标准的贝塔更新 $\\alpha_{0}\\mapsto \\alpha_{0}+1$ 和 $\\beta_{0}\\mapsto \\beta_{0}+k-1$。因此，正确选项是 $(\\alpha_{0}+1,\\beta_{0}+k-1)$。", "answer": "$$\\boxed{D}$$", "id": "1923967"}, {"introduction": "在获得代表我们更新后知识的后验分布之后，下一个关键步骤是中提取有意义的结论。本练习 [@problem_id:1923968] 将教你如何计算后验中位数，这是一种稳健的点估计，为未知参数提供了一个简洁的总结。通过一个在多次试验中均未观察到成功的特殊情景，该问题凸显了贝叶斯方法即使在数据稀疏的情况下，也能有效量化和更新不确定性的能力。", "problem": "一种新的高风险外科手术正在为一种以前被认为无法治疗的疾病进行开发。该手术的真实成功概率（用 $p$ 表示）是未知的。在进行任何临床试验之前，医学研究人员对这个概率没有任何预设偏见，因此认为区间 $[0, 1]$ 中 $p$ 的每个可能值都是等可能的。\n\n该手术随后在 $n$ 个不同的患者身上进行了尝试。在这 $n$ 次独立试验的每一次中，手术都未能取得成功的结果。\n\n基于在 $n$ 次试验中观察到的零次成功的数据，形成了关于成功概率 $p$ 的更新信念。一位医学统计学家决定通过计算一个中心值 $p_{med}$ 来总结这个更新的信念。这个值的定义是：在给定观察数据的情况下，真实成功率 $p$ 小于或等于 $p_{med}$ 的概率与大于 $p_{med}$ 的概率相等。\n\n求出 $p_{med}$ 关于 $n$ 的封闭形式解析表达式。", "solution": "令 $p$ 表示成功概率。先验信念在 $[0,1]$ 上是均匀的，即 $\\operatorname{Beta}(1,1)$ 先验，其密度为 $\\pi(p)=1$（对于 $p\\in[0,1]$）。\n\n我们观察到 $n$ 次独立的伯努利试验，其中有 $k=0$ 次成功。似然函数为\n$$\nL(p\\mid \\text{data}) \\propto p^{k}(1-p)^{n-k}=(1-p)^{n}.\n$$\n根据贝叶斯定理，后验概率正比于先验概率乘以似然函数：\n$$\n\\pi(p\\mid \\text{data}) \\propto \\pi(p)L(p\\mid \\text{data}) \\propto (1-p)^{n}, \\quad 0\\leq p\\leq 1.\n$$\n这是一个 $\\operatorname{Beta}(1,n+1)$ 分布。进行显式归一化，\n$$\n\\int_{0}^{1} (1-p)^{n}\\,dp=\\frac{1}{n+1},\n$$\n所以后验密度为\n$$\nf(p\\mid \\text{data})=(n+1)(1-p)^{n}, \\quad 0\\leq p\\leq 1.\n$$\n后验累积分布函数为\n$$\nF(p)=\\int_{0}^{p} (n+1)(1-t)^{n}\\,dt.\n$$\n通过 $u=1-t$, $du=-dt$ 计算积分：\n$$\nF(p)=(n+1)\\int_{0}^{p} (1-t)^{n}\\,dt=(n+1)\\int_{1-p}^{1} u^{n}\\,du\n= (n+1)\\left[\\frac{u^{n+1}}{n+1}\\right]_{1-p}^{1}\n=1-(1-p)^{n+1}.\n$$\n后验中位数 $p_{med}$ 满足 $F(p_{med})=\\frac{1}{2}$，因此\n$$\n1-(1-p_{med})^{n+1}=\\frac{1}{2}\n\\;\\;\\Longrightarrow\\;\\;\n(1-p_{med})^{n+1}=\\frac{1}{2}.\n$$\n取 $(n+1)$ 次方根，得到\n$$\n1-p_{med}=2^{-\\frac{1}{n+1}},\n$$\n所以\n$$\np_{med}=1-2^{-\\frac{1}{n+1}}.\n$$\n这个表达式对所有 $n\\geq 0$ 都有效，特别是对于问题情境中的 $n\\geq 1$。", "answer": "$$\\boxed{1-2^{-\\frac{1}{n+1}}}$$", "id": "1923968"}, {"introduction": "贝叶斯框架的一个主要优势在于其能够对未来事件进行概率性预测。本练习 [@problem_id:1923970] 聚焦于这一实用功能，通过计算后验预测概率来回答一个核心问题：“根据已有的观测数据，接下来某个特定结果发生的概率是多少？”。这个问题利用泊松-伽马（Poisson-Gamma）共轭模型，清晰地展示了如何从理解系统参数（如事件发生率 $\\lambda$）过渡到对未来结果进行量化预测。", "problem": "一家软件开发公司正在为其新应用程序进行封闭 Beta 测试。他们使用泊松分布对每月报告的错误数量 $X$ 进行建模，其未知平均率为 $\\lambda$。其概率质量函数为 $P(X=k | \\lambda) = \\frac{\\exp(-\\lambda) \\lambda^{k}}{k!}$，其中 $k=0, 1, 2, \\dots$。\n\n根据类似项目的历史数据，项目经理对率 $\\lambda$ 的先验信念由一个 Gamma 分布描述，其形状参数为 $\\alpha = 2$，率参数为 $\\beta = 1$。该先验的概率密度函数为 $f(\\lambda) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda)$，其中 $\\lambda  0$。\n\n在 Beta 测试的第一个月，测试人员共报告了 3 个错误。\n\n假设潜在的错误率 $\\lambda$ 保持不变，计算在第二个月测试中报告零个错误的概率。将您的最终答案四舍五入到四位有效数字。", "solution": "我们将 $X \\mid \\lambda \\sim \\text{Poisson}(\\lambda)$ 建模，其概率质量函数为 $P(X=k \\mid \\lambda)=\\frac{\\exp(-\\lambda)\\lambda^{k}}{k!}$，先验为 $\\lambda \\sim \\text{Gamma}(\\alpha,\\beta)$，其密度函数为 $f(\\lambda)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}\\lambda^{\\alpha-1}\\exp(-\\beta\\lambda)$，其中 $\\alpha=2$ 且 $\\beta=1$。\n\n给定第一个月的观测值 $X_{1}=3$，似然函数为\n$$\nL(\\lambda \\mid X_{1}=3)\\propto \\exp(-\\lambda)\\lambda^{3}.\n$$\n与先验结合，\n$$\np(\\lambda \\mid X_{1}=3)\\propto \\lambda^{\\alpha-1}\\exp(-\\beta\\lambda)\\cdot \\exp(-\\lambda)\\lambda^{3}\n=\\lambda^{\\alpha+3-1}\\exp\\big(-( \\beta+1)\\lambda\\big).\n$$\n识别出 Gamma 密度的核，后验分布为\n$$\n\\lambda \\mid X_{1}=3 \\sim \\text{Gamma}(\\alpha',\\beta'), \\quad \\alpha'=\\alpha+3,\\ \\beta'=\\beta+1,\n$$\n因此这里 $\\alpha'=5$ 且 $\\beta'=2$。\n\n第二个月零个错误的后验预测概率为\n$$\nP(X_{2}=0 \\mid X_{1}=3)=\\int_{0}^{\\infty}P(X_{2}=0 \\mid \\lambda)\\,p(\\lambda \\mid X_{1}=3)\\,d\\lambda\n=\\int_{0}^{\\infty}\\exp(-\\lambda)\\,\\frac{(\\beta')^{\\alpha'}}{\\Gamma(\\alpha')}\\lambda^{\\alpha'-1}\\exp(-\\beta'\\lambda)\\,d\\lambda.\n$$\n使用 Gamma 积分恒等式 $\\int_{0}^{\\infty}\\lambda^{\\alpha'-1}\\exp(-c\\lambda)\\,d\\lambda=\\frac{\\Gamma(\\alpha')}{c^{\\alpha'}}$（对于 $c0$）来计算该积分：\n$$\nP(X_{2}=0 \\mid X_{1}=3)=\\frac{(\\beta')^{\\alpha'}}{\\Gamma(\\alpha')}\\cdot \\frac{\\Gamma(\\alpha')}{(\\beta'+1)^{\\alpha'}}=\\left(\\frac{\\beta'}{\\beta'+1}\\right)^{\\alpha'}.\n$$\n代入 $\\alpha'=5$ 和 $\\beta'=2$ 得\n$$\nP(X_{2}=0 \\mid X_{1}=3)=\\left(\\frac{2}{3}\\right)^{5}=\\frac{32}{243}\\approx 0.131687\\ldots\n$$\n四舍五入到四位有效数字，结果为 $0.1317$。", "answer": "$$\\boxed{0.1317}$$", "id": "1923970"}]}