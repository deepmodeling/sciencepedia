{"hands_on_practices": [{"introduction": "非参数方法提供了一种无需严格分布假设即可估计总体参数的稳健途径。一项常见任务是为中位数构建一个置信区间，这在数据可能偏斜或包含异常值时尤其有用。本练习将演示如何仅使用样本的顺序统计量为总体中位数构建置信区间，这是非参数推断中的一项基本技能。通过将顺序统计量与二项分布联系起来，您将掌握一种不依赖于均值或标准差等参数来量化不确定性的方法 ([@problem_id:1924528])。", "problem": "在一项针对新型抗炎药的临床研究中，研究人员测量了受试者在给药后某一特定生物标志物的恢复时间。观测了一个包含 $n=15$ 名受试者的随机样本，并记录了他们的恢复时间 $T_1, T_2, \\dots, T_{15}$。假设这些时间是从一个连续分布中抽样的，其未知的中位恢复时间记为 $\\eta$。\n\n一种估计中位数的常用非参数方法是使用排序后的样本值（顺序统计量）$T_{(1)} \\le T_{(2)} \\le \\dots \\le T_{(15)}$ 来构建一个置信区间。我们感兴趣的是寻找一个形式为 $[T_{(i)}, T_{(j)}]$ 的对称置信区间，其中下标满足关系 $j = n - i + 1$。\n\n哪一对下标 $(i, j)$ 所产生的关于中位数 $\\eta$ 的置信区间的置信水平最接近90%？\n\nA. $(3, 13)$\n\nB. $(4, 12)$\n\nC. $(5, 11)$\n\nD. $(6, 10)$\n\nE. $(7, 9)$", "solution": "令 $X$ 为严格小于（未知）中位数 $\\eta$ 的观测值的数量。在从连续分布进行独立同分布抽样的假设下，$X \\sim \\mathrm{Binomial}(n, \\frac{1}{2})$，并且由于相同值出现的概率为零，可以使用顺序统计量的逻辑计算 $\\mathbb{P}(T_{(i)} \\le \\eta \\le T_{(j)})$。\n\n对于一个固定的 $\\eta$：\n- $T_{(i)} \\le \\eta$ 当且仅当至少有 $i$ 个观测值小于 $\\eta$，即 $X \\ge i$。\n- $\\eta \\le T_{(j)}$ 当且仅当至多有 $j-1$ 个观测值小于 $\\eta$，即 $X \\le j-1$。\n\n因此，\n$$\n\\{ T_{(i)} \\le \\eta \\le T_{(j)} \\} \\iff \\{ i \\le X \\le j-1 \\}.\n$$\n对于一个对称区间，有 $j = n - i + 1$，我们得到 $j - 1 = n - i$，因此\n$$\n\\mathbb{P}(T_{(i)} \\le \\eta \\le T_{(n-i+1)}) = \\mathbb{P}(i \\le X \\le n - i).\n$$\n由于 $X \\sim \\mathrm{Binomial}(n, \\frac{1}{2})$ 且具有对称性，\n$$\n\\mathbb{P}(i \\le X \\le n - i) = 1 - 2\\,\\mathbb{P}(X \\le i - 1).\n$$\n\n对于 $n = 15$，我们写作\n$$\n\\mathbb{P}(X \\le k) = 2^{-15} \\sum_{x=0}^{k} \\binom{15}{x}.\n$$\n令 $S_{k} = \\sum_{x=0}^{k} \\binom{15}{x}$。那么对于下标 $i$ 的覆盖率为\n$$\n\\mathbb{P}(i \\le X \\le 15 - i) = 1 - 2 \\cdot 2^{-15} S_{i-1} = 1 - 2^{-14} S_{i-1}.\n$$\n\n计算所需的二项式系数和部分和：\n$$\n\\binom{15}{0}=1,\\ \\binom{15}{1}=15,\\ \\binom{15}{2}=105,\\ \\binom{15}{3}=455,\\ \\binom{15}{4}=1365,\\ \\binom{15}{5}=3003,\\ \\binom{15}{6}=5005,\\ \\binom{15}{7}=6435,\n$$\n$$\nS_{0}=1,\\ S_{1}=16,\\ S_{2}=121,\\ S_{3}=576,\\ S_{4}=1941,\\ S_{5}=4944,\\ S_{6}=9949,\\quad 2^{14}=16384.\n$$\n\n因此，对于候选的 $i$ 值，其覆盖率分别为：\n- $i=3$: $1 - \\frac{121}{16384} = \\frac{16263}{16384}$，\n- $i=4$: $1 - \\frac{576}{16384} = \\frac{15808}{16384}$，\n- $i=5$: $1 - \\frac{1941}{16384} = \\frac{14443}{16384}$，\n- $i=6$: $1 - \\frac{4944}{16384} = \\frac{11440}{16384}$，\n- $i=7$: $1 - \\frac{9949}{16384} = \\frac{6435}{16384}$。\n\n我们通过计算精确差值，将每个覆盖率与 $9/10$ 进行比较：\n- 对于 $i=5$：$\\left|\\frac{14443}{16384} - \\frac{9}{10}\\right| = \\frac{|144430 - 147456|}{163840} = \\frac{3026}{163840}$。\n- 对于 $i=4$：$\\left|\\frac{15808}{16384} - \\frac{9}{10}\\right| = \\frac{|158080 - 147456|}{163840} = \\frac{10624}{163840}$。\n- 对于 $i=3$：$\\left|\\frac{16263}{16384} - \\frac{9}{10}\\right| = \\frac{|162630 - 147456|}{163840} = \\frac{15174}{163840}$。\n- 对于 $i=6$：$\\left|\\frac{11440}{16384} - \\frac{9}{10}\\right| = \\frac{|114400 - 147456|}{163840} = \\frac{33056}{163840}$。\n- 对于 $i=7$：$\\left|\\frac{6435}{16384} - \\frac{9}{10}\\right| = \\frac{|64350 - 147456|}{163840} = \\frac{83106}{163840}$。\n\n最小的差值出现在 $i=5$ 时，对应于区间 $(i,j) = (5,11)$。\n\n因此，置信水平最接近 $9/10$ 的选项是C。", "answer": "$$\\boxed{C}$$", "id": "1924528"}, {"introduction": "在评估一个统计或机器学习模型时，检验其误差的性质至关重要。一个常见的理想属性是预测误差的分布关于零对称，这表明模型没有系统性的偏差。本练习介绍 Wilcoxon 符号秩检验，这是一个强大的非参数工具，用于检验单个样本的分布是否关于某个特定值（此处为零）对称。您将学习如何计算 $W^+$ 统计量，该过程巧妙地利用绝对值的秩来评估对称性，这对于模型验证至关重要 ([@problem_id:1924555])。", "problem": "一位数据科学家正在评估一个旨在预测某个金融指数的新机器学习模型。模型的性能通过分析其预测误差来严格评估，预测误差定义为 $e_i = (\\text{actual value})_i - (\\text{predicted value})_i$。为了使模型被认为是无偏的（这是后续风险分析的一项要求），其误差的潜在分布应关于零对称。\n\n从该模型近期的性能表现中收集了一个包含11个预测误差的样本：\n$$ \\{1.2, -0.8, 2.5, -1.5, -0.8, 3.1, 0.0, -2.1, 1.7, 0.9, 1.4\\} $$\n\n为了正式研究误差分布的对称性，你需要计算一个基于秩的检验统计量。计算该统计量（我们将其记为 $W^+$）的步骤如下：\n1.  从数据集中移除所有等于零的观测值。设新的、缩减后的样本大小为 $n$。\n2.  取剩余的 $n$ 个非零观测值的绝对值。\n3.  将这 $n$ 个绝对值从小到大（秩从1到 $n$）进行排序。如果绝对值出现相同的情况，则将它们本应占据的秩的平均值赋给每个具有相同值的观测值。\n4.  检验统计量 $W^+$ 定义为非零数据集中原始值为正的观测值所对应的秩的总和。\n\n计算检验统计量 $W^+$ 的值。", "solution": "我们从误差数据集 $\\{1.2, -0.8, 2.5, -1.5, -0.8, 3.1, 0.0, -2.1, 1.7, 0.9, 1.4\\}$ 开始。按照步骤进行：\n1) 移除零值：丢弃 $0.0$，剩下 $n=10$ 个非零观测值。\n2) 取非零观测值的绝对值：\n$$ \\{1.2, 0.8, 2.5, 1.5, 0.8, 3.1, 2.1, 1.7, 0.9, 1.4\\}. $$\n3) 将这些绝对值从小到大排序，对相同的值取秩的平均值。排序后的绝对值为\n$$0.8, 0.8, 0.9, 1.2, 1.4, 1.5, 1.7, 2.1, 2.5, 3.1,$$\n因此，秩的分配如下：\n- $0.8$（出现两次）的秩分别为 $\\frac{1+2}{2}=1.5$，\n- $0.9 \\to 3$，\n- $1.2 \\to 4$，\n- $1.4 \\to 5$，\n- $1.5 \\to 6$，\n- $1.7 \\to 7$，\n- $2.1 \\to 8$，\n- $2.5 \\to 9$，\n- $3.1 \\to 10$。\n将秩按顺序映射回原始的非零观测值：\n- $1.2$（正）的秩为 $4$，\n- $-0.8$（负）的秩为 $1.5$，\n- $2.5$（正）的秩为 $9$，\n- $-1.5$（负）的秩为 $6$，\n- $-0.8$（负）的秩为 $1.5$，\n- $3.1$（正）的秩为 $10$，\n- $-2.1$（负）的秩为 $8$，\n- $1.7$（正）的秩为 $7$，\n- $0.9$（正）的秩为 $3$，\n- $1.4$（正）的秩为 $5$。\n4) 将原始值为正的观测值所对应的秩相加，得到 $W^{+}$：\n$$W^{+} = 4 + 9 + 10 + 7 + 3 + 5 = 38.$$\n作为一致性检查，所有秩的总和为 $ \\frac{n(n+1)}{2} = \\frac{10 \\cdot 11}{2} = 55$，因此负观测值的秩之和为 $55 - 38 = 17$，这与分配给负值的秩相符，从而证实了计算的正确性。\n因此，所求的检验统计量为 $W^{+} = 38$。", "answer": "$$\\boxed{38}$$", "id": "1924555"}, {"introduction": "从一个样本的检验扩展到比较两个独立的组，这是数据分析中更常见的挑战。当我们不能假设数据服从正态分布时，像 t 检验这样的参数检验可能不再适用。Wilcoxon 秩和检验（也称为 Mann-Whitney U 检验）提供了一个经典的无分布方法来确定一个总体的中心位置是否与另一个不同。本练习将指导您完成该检验的核心步骤：合并数据、分配秩次（包括处理平局值）以及计算检验统计量，这是比较两组数据的基本技能 ([@problem_id:1924536])。", "problem": "一名数据分析师正在研究两款独立开发的视频游戏“Aetherfall”和“Byte Runner”的初期市场反响。该分析师收集了每款游戏在短期内的每日下载量数据。目标是在不对其分布形状做任何假设（例如，不假设它们呈正态分布）的情况下，比较两个下载量计数分布的位置。\n\n记录的每日下载量如下：\n- **Aetherfall**：$X = \\{155, 190, 172, 215, 160, 185, 205\\}$\n- **Byte Runner**：$Y = \\{180, 220, 195, 230, 172, 210, 200, 240, 165\\}$\n\n为了执行一个对基础分布稳健的双样本检验，通常的第一步是合并所有观测值，将它们从小到大排序，然后基于这些秩计算一个检验统计量。\n\n计算与游戏“Aetherfall”的每日下载量相对应的秩之和。", "solution": "我们的目标是计算 Aetherfall 样本的 Wilcoxon 型秩和。步骤如下：\n- 合并两个样本，并将所有观测值从小到大排序，为结指定平均秩。\n- 将与 Aetherfall 观测值相对应的秩相加。\n\n合并并排序所有观测值（Aetherfall 标记为 X，Byte Runner 标记为 Y）：155(X), 160(X), 165(Y), 172(X), 172(Y), 180(Y), 185(X), 190(X), 195(Y), 200(Y), 205(X), 210(Y), 215(X), 220(Y), 230(Y), 240(Y)。总共有 $n=16$ 个观测值，所以秩为 $1,2,\\ldots,16$。唯一的结出现在 $172$，有两个观测值；对应的秩 $4$ 和 $5$ 被它们的平均值 $4.5$ 所取代。\n\n因此，分配的秩如下：\n- $155(X)\\to 1$, $160(X)\\to 2$, $165(Y)\\to 3$, $172(X)\\to 4.5$, $172(Y)\\to 4.5$, $180(Y)\\to 6$, $185(X)\\to 7$, $190(X)\\to 8$, $195(Y)\\to 9$, $200(Y)\\to 10$, $205(X)\\to 11$, $210(Y)\\to 12$, $215(X)\\to 13$, $220(Y)\\to 14$, $230(Y)\\to 15$, $240(Y)\\to 16$.\n\n将 Aetherfall (X) 的秩相加：\n$$1+2+4.5+7+8+11+13=46.5.$$\n作为检验，总秩和为 $\\frac{n(n+1)}{2}=\\frac{16\\cdot 17}{2}=136$，所以 Byte Runner 的秩和是 $136-46.5=89.5$，这与分配的秩一致。", "answer": "$$\\boxed{46.5}$$", "id": "1924536"}]}