{"hands_on_practices": [{"introduction": "夏皮罗-威尔克检验最常见的用途之一是验证统计模型的基本假设。本练习将您置于数据科学家的角色，面对一个典型的真实世界场景：检验模型的残差是否符合正态分布。通过解读检验得出的p值，您将练习如何做出关键的统计决策 ([@problem_id:1954981])。", "problem": "一位数据科学家正在建立一个线性回归模型，以预测商业建筑的月度能耗。为了使模型的标准统计推断（例如模型系数的置信区间和假设检验）可靠，一个关键的假设是模型的残差来自正态分布。为了评估这一假设，该数据科学家对从模型中获得的残差集进行 Shapiro-Wilk 检验。该检验得出的 p 值为 $0.02$。检验使用的显著性水平为 $\\alpha = 0.05$。\n\n根据这一结果，以下哪个是最准确的实践结论？\n\nA. 有充分的证据表明残差是正态分布的，因此满足模型假设。\n\nB. 证据表明正态分布残差的假设被违反了。\n\nC. p 值为 $0.02$ 表明残差实际上是正态分布的概率为 $2\\%$。\n\nD. 该模型被证明是一个好的预测模型，因为检验结果在统计上是显著的。\n\nE. 检验结果不确定，因为 p 值非常小，需要一个更大的 p 值才能做出决定。", "solution": "系数的线性回归推断通常假设残差 $e_{i}$ 是独立同分布的，即 $e_{i} \\sim \\mathcal{N}(0,\\sigma^{2})$。为了评估正态性，应用了 Shapiro–Wilk 检验。\n\n建立假设：\n$$\nH_{0}：\\ \\text{残差来自正态分布}，\\quad\nH_{1}：\\ \\text{残差不来自正态分布}。\n$$\n\n检验提供的 p 值为 $p=0.02$，选择的显著性水平为 $\\alpha=0.05$。决策规则是：\n$$\n\\text{如果}\\ p \\leq \\alpha\\ \\text{，则拒绝 }H_{0}。\n$$\n由于 $0.02  0.05$，我们拒绝 $H_{0}$。实践结论是，有统计证据表明残差不是正态分布的；因此，正态性假设很可能被违反了。\n\n选项的解释：\n- A 是不正确的，因为拒绝 $H_{0}$ 与得出正态性的结论相矛盾。\n- B 是正确的，因为拒绝表示有证据反对正态性。\n- C 是不正确的，因为 p 值不是 $H_{0}$ 为真的概率；它是在 $H_{0}$ 为真的前提下，观察到至少与已观察到的检验统计量一样极端的检验统计量的概率。\n- D 是不正确的，因为这里的显著性反映的是偏离正态性，而不是预测性能。\n- E 是不正确的，因为在给定的 $\\alpha$ 水平下，一个小的 p 值会导致明确的拒绝 $H_{0}$ 的决定。\n\n因此，最准确的实践结论是 B。", "answer": "$$\\boxed{B}$$", "id": "1954981"}, {"introduction": "理论联系实践是掌握任何统计工具的关键。本练习将带您深入夏皮罗-威尔克检验的“引擎盖下”，亲手计算其核心统计量 $W$。通过对一个特意设计的小样本进行分步计算，您将直观地理解该检验是如何将数据与正态分布的理论期望进行比较，并量化它们之间的差异 ([@problem_id:1954943])。", "problem": "在新一代微机电系统（MEMS）的质量控制中，一位材料科学家测量了一小批六个原型谐振器的谐振频率。其目的是评估这些频率是否可以用正态分布来建模，这是后续统计过程控制方法的关键假设。测得的频率，单位为千赫兹（kHz），如下：\n$$ \\{11.2, 13.2, 11.2, 13.2, 11.2, 13.2\\} $$\n这位科学家决定使用夏皮罗-威尔克（Shapiro-Wilk）检验进行正态性检验。夏皮罗-威尔克统计量 $W$ 使用以下公式计算：\n$$ W = \\frac{b^2}{S^2} $$\n其中，$S^2$ 是与样本均值的离差平方和，由 $S^2 = \\sum_{j=1}^{n} (x_j - \\bar{x})^2$ 给出。项 $b$ 是对称顺序统计量之间差异的加权和，计算公式为 $b = \\sum_{i=1}^{k} a_i (x_{(n-i+1)} - x_{(i)})$，其中 $x_{(j)}$ 是样本中第 $j$ 小的值。对于样本量 $n=6$，整数 $k$ 为 $3$，所需的系数 $a_i$ 为：\n$a_1 = 0.6431$\n$a_2 = 0.2806$\n$a_3 = 0.0875$\n\n计算该数据集的夏皮罗-威尔克统计量 $W$ 的值。统计量 $W$ 是一个无量纲量。将你的最终答案四舍五入到四位有效数字。", "solution": "问题要求我们为给定的六个测量值的数据集计算夏皮罗-威尔克统计量 $W$。数据集为 $X = \\{11.2, 13.2, 11.2, 13.2, 11.2, 13.2\\}$。\n\n步骤1：确定样本量并计算样本均值。\n样本量为 $n=6$。\n样本均值 $\\bar{x}$ 是所有观测值的总和除以样本量。\n$$ \\bar{x} = \\frac{11.2 + 13.2 + 11.2 + 13.2 + 11.2 + 13.2}{6} = \\frac{3 \\times 11.2 + 3 \\times 13.2}{6} = \\frac{33.6 + 39.6}{6} = \\frac{73.2}{6} = 12.2 $$\n样本均值为 $\\bar{x} = 12.2$ kHz。\n\n步骤2：计算离差平方和 $S^2$。\n$S^2$ 是 $W$ 统计量的分母。\n每个数据点与均值的离差 $(x_j - \\bar{x})$ 为：\n对于三个值为 $11.2$ 的数据点：$11.2 - 12.2 = -1.0$\n对于三个值为 $13.2$ 的数据点：$13.2 - 12.2 = 1.0$\n现在，我们对这些离差的平方求和：\n$$ S^2 = \\sum_{j=1}^{6} (x_j - \\bar{x})^2 = 3 \\times (-1.0)^2 + 3 \\times (1.0)^2 = 3 \\times 1 + 3 \\times 1 = 6 $$\n所以，$S^2 = 6$。\n\n步骤3：确定样本的顺序统计量。\n顺序统计量 $x_{(i)}$ 是按升序排列的样本值。\n$x_{(1)} = 11.2$\n$x_{(2)} = 11.2$\n$x_{(3)} = 11.2$\n$x_{(4)} = 13.2$\n$x_{(5)} = 13.2$\n$x_{(6)} = 13.2$\n\n步骤4：计算项 $b$。\n对于 $n=6$，$b$ 的公式为 $b = \\sum_{i=1}^{3} a_i (x_{(6-i+1)} - x_{(i)})$。\n展开为：\n$$ b = a_1 (x_{(6)} - x_{(1)}) + a_2 (x_{(5)} - x_{(2)}) + a_3 (x_{(4)} - x_{(3)}) $$\n使用给定的系数和顺序统计量：\n$a_1 = 0.6431$\n$a_2 = 0.2806$\n$a_3 = 0.0875$\n\n顺序统计量的差异为：\n$x_{(6)} - x_{(1)} = 13.2 - 11.2 = 2.0$\n$x_{(5)} - x_{(2)} = 13.2 - 11.2 = 2.0$\n$x_{(4)} - x_{(3)} = 13.2 - 11.2 = 2.0$\n\n现在，将这些值代入 $b$ 的表达式中：\n$$ b = 0.6431 \\times (2.0) + 0.2806 \\times (2.0) + 0.0875 \\times (2.0) $$\n$$ b = (0.6431 + 0.2806 + 0.0875) \\times 2.0 $$\n$$ b = (1.0112) \\times 2.0 = 2.0224 $$\n\n步骤5：计算夏皮罗-威尔克统计量 $W$。\n公式为 $W = b^2 / S^2$。\n$$ W = \\frac{(2.0224)^2}{6} = \\frac{4.09006176}{6} = 0.68167696 $$\n\n步骤6：将结果四舍五入到四位有效数字。\n计算值为 $0.68167696...$。前四位有效数字是 6、8、1、6。第五位有效数字是 7，大于或等于 5，因此我们将第四位数字向上舍入。\n$$ W \\approx 0.6817 $$", "answer": "$$\\boxed{0.6817}$$", "id": "1954943"}, {"introduction": "正态性检验的强大之处在于其能识别各种偏离正态分布的模式，而不仅仅是简单的偏斜。本练习提出了一个更具挑战性的情景：一个由两个正态分布混合而成的对称双峰分布。分析这种情况下的检验结果，将加深您对夏皮罗-威尔克检验敏感性的理解，并揭示为何对称性本身并不等同于正态性 ([@problem_id:1954962])。", "problem": "一位统计学家正在研究一个从两个不同正态分布的混合分布中生成数据点的过程。每个数据点 $X$ 的生成方式如下：首先，抛掷一枚均匀的硬币。如果正面朝上，则数据点从均值为 $\\mu_1 = -4$、标准差为 $\\sigma = 1$ 的正态分布中抽取。如果反面朝上，则数据点从均值为 $\\mu_2 = 4$、标准差为 $\\sigma = 1$ 的正态分布中抽取。\n\n从这个过程中收集了一个大样本数据点。该统计学家决定进行 Shapiro-Wilk 检验，以评估样本数据是否来自一个正态分布的总体，并使用标准的显著性水平（例如 $\\alpha = 0.05$）。\n\n基于该数据生成过程的理论性质，以下哪项描述了 Shapiro-Wilk 检验最可能的结果及其正确理由？\n\nA. 检验将未能拒绝正态性的原假设，因为混合分布的底层成分是正态分布。\n\nB. 检验将拒绝正态性的原假设，因为得到的分布是对称的，但具有比正态分布更重的尾部，从而导致一个低的检验统计量。\n\nC. 检验将拒绝正态性的原假设，因为总体的双峰性质将导致排序后的样本数据相对于单个正态分布的期望分位数表现出系统性的 S 形偏差，从而得到一个显著小于 1 的检验统计量。\n\nD. 检验将未能拒绝正态性的原假设，因为得到的分布是完全对称的，而 Shapiro-Wilk 检验主要对偏度敏感，而不是其他形式的非正态性。\n\nE. 检验将拒绝正态性的原假设，因为样本方差将远大于成分分布的方差。", "solution": "设数据生成过程是两个具有共同标准差的正态分布的等权重混合。记\n$$\nX = Z a + Y,\n$$\n其中 $Z \\in \\{-1,1\\}$ 且 $\\mathbb{P}(Z=1)=\\mathbb{P}(Z=-1)=\\frac{1}{2}$，$a0$ 是成分均值的大小，$Y \\sim \\mathcal{N}(0,s^{2})$ 与 $Z$ 独立。在题目中，$a=4$ 且 $s^{2}=1$，但下面的推理是通用的。\n\n在 Shapiro-Wilk 检验下，原假设为\n$$\nH_{0}:\\ \\text{数据来自 } \\mathcal{N}(\\mu,\\sigma^{2}) \\text{，对于某些 } \\mu \\in \\mathbb{R},\\ \\sigma^{2}0。\n$$\nShapiro-Wilk 检验统计量可以写为\n$$\nW=\\frac{\\left(\\sum_{i=1}^{n} a_{i}\\,x_{(n+1-i)}\\right)^{2}}{\\sum_{i=1}^{n} \\left(x_{i}-\\bar{x}\\right)^{2}},\n$$\n其中 $x_{(1)}\\leq \\cdots \\leq x_{(n)}$ 是样本的顺序统计量，$\\bar{x}$ 是样本均值，系数 $a_{i}$ 依赖于期望的正态顺序统计量。对于来自单个正态分布的数据，$W$ 接近于 1；对正态性的系统性偏离（包括双峰性）会使排序后的样本偏离正态性下预期的线性模式，从而使 $W$ 显著低于 1。\n\n首先，$X$ 的分布不是正态的，除非 $a=0$。其密度是两个分离的正态成分密度之和，当 $a$ 相对于 $s$ 足够大时，该分布是双峰的。因此，尽管每个成分都是正态的，但它们的混合分布不是单个正态分布，所以对于该数据生成过程而言，原假设是错误的。\n\n第二，为了评估尾部行为并讨论选项 B，我们计算二阶矩和四阶矩。利用独立性和对称性，\n$$\n\\mathbb{E}[X]=0,\\qquad \\mathbb{E}[X^{2}]=a^{2}+s^{2}.\n$$\n对于四阶矩，展开 $(Za+Y)^{4}$ 并取期望；奇数项消失，对于正态分布有 $\\mathbb{E}[Y^{4}]=3s^{4}$：\n$$\n\\mathbb{E}[X^{4}]=a^{4}+6a^{2}s^{2}+3s^{4}.\n$$\n相对于具有相同方差的正态分布，其峰度为\n$$\n\\frac{\\mathbb{E}[X^{4}]}{\\left(\\mathbb{E}[X^{2}]\\right)^{2}}=\\frac{a^{4}+6a^{2}s^{2}+3s^{4}}{(a^{2}+s^{2})^{2}}.\n$$\n超额峰度为\n$$\n\\gamma_{2}=\\frac{a^{4}+6a^{2}s^{2}+3s^{4}}{(a^{2}+s^{2})^{2}}-3=\\frac{-2a^{4}}{(a^{2}+s^{2})^{2}}  0 \\quad \\text{对于 } a\\neq 0.\n$$\n因此，该混合分布相对于具有相同方差的单个正态分布是阔峰的（platykurtic）；它不具有比该正态分布更重的尾部。所以，选项 B 中的理由（更重的尾部）是不正确的。\n\n第三，讨论选项 E：虽然混合分布的方差为 $\\mathbb{V}[X]=a^{2}+s^{2}$，但 Shapiro-Wilk 检验的原假设允许任何 $\\sigma^{2}0$ 并从样本中估计它。方差大于成分方差本身并不会导致拒绝；问题在于非正态的形状（这里是双峰性），而不是方差的大小。因此 E 的理由是不正确的。\n\n第四，讨论选项 D：Shapiro-Wilk 检验对多种偏离正态性的情况都敏感，而不仅仅是偏度。仅有对称性并不能保证不拒绝原假设；对称的双峰分布通常会在正态 Q-Q 图中产生 S 形偏差，并减小 $W$ 值。\n\n最后，因为该混合分布是双峰的且非正态，大样本将产生系统性偏离单个正态分布下预期直线模式的顺序统计量。在 Q-Q 图中，这表现为一条 S 形曲线：当总体是双峰时，中心分位数和尾部分位数与正态分位数不呈线性排列。因此，Shapiro-Wilk 统计量将显著小于 1，并且随着样本量的增大，该检验将以高概率在标准显著性水平下拒绝 $H_{0}$。\n\n因此，最准确的结果和理由是，由于双峰性引起的、相对于单个正态分布分位数的 S 形偏离，检验会拒绝正态性。\n\n选项分析总结：\n- A 是错误的：分离的正态分布的混合不是正态分布。\n- B 是错误的：该混合分布相对于具有相同方差的正态分布是阔峰的；“更重的尾部”这一说法不正确。\n- C 是正确的：双峰性导致 S 形的 Q-Q 偏差，降低了 $W$ 值并导致拒绝。\n- D 是错误的：Shapiro-Wilk 检验能检测出除偏度之外的非正态性。\n- E 是错误的：原假设允许任何方差；拒绝是由于形状，而非方差大本身。", "answer": "$$\\boxed{C}$$", "id": "1954962"}]}