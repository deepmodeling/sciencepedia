{"hands_on_practices": [{"introduction": "Kruskal-Wallis 检验是一种非参数方法，这意味着它不依赖于数据的原始数值，而是依赖于它们的排序或秩。因此，执行该检验的第一个关键步骤是将所有组合数据从最小到最大进行排序，并分配秩。这个练习旨在让你亲手实践这一核心的转化过程，为后续计算检验统计量奠定坚实的基础。", "problem": "一位土壤科学家正在研究三种不同的有机堆肥方法对某一特定品种番茄植株产量的影响。研究人员准备了三组地块。A组使用标准堆肥混合物，B组使用蚯蚓堆肥（蚯蚓粪）混合物，C组使用Bokashi发酵混合物。在生长季结束时，记录每个地块的总产量（单位：千克）。数据如下：\n\n- **A组（标准）：** 11.2, 13.5, 10.8, 12.1\n- **B组（蚯蚓堆肥）：** 14.0, 15.1, 13.8, 14.5\n- **C组（Bokashi）：** 12.5, 13.9, 11.9\n\n为了确定三种堆肥方法的中位数产量是否存在统计学上的显著差异，该科学家决定使用Kruskal-Wallis检验。这种非参数检验的第一步是将所有组的所有观测值合并，从最小到最大进行排序。\n\n计算B组数据的秩和。", "solution": "我们应用Kruskal-Wallis检验的第一步：将所有组的观测值汇集在一起，从最小到最大排序，并分配秩次。在没有相同值的情况下，每个观测值都会获得一个从$1$开始的唯一整数秩次。\n\n总共有$N=11$个观测值。对所有值进行排序并分配秩次：\n$10.8$ (A) $\\to$ 秩 $1$\n$11.2$ (A) $\\to$ 秩 $2$\n$11.9$ (C) $\\to$ 秩 $3$\n$12.1$ (A) $\\to$ 秩 $4$\n$12.5$ (C) $\\to$ 秩 $5$\n$13.5$ (A) $\\to$ 秩 $6$\n$13.8$ (B) $\\to$ 秩 $7$\n$13.9$ (C) $\\to$ 秩 $8$\n$14.0$ (B) $\\to$ 秩 $9$\n$14.5$ (B) $\\to$ 秩 $10$\n$15.1$ (B) $\\to$ 秩 $11$\n\n提取B组的秩次：$13.8 \\to 7$，$14.0 \\to 9$，$14.5 \\to 10$，$15.1 \\to 11$。B组的秩和为\n$$R_{B}=7+9+10+11=37.$$", "answer": "$$\\boxed{37}$$", "id": "1961641"}, {"introduction": "在掌握了如何为数据分配秩之后，我们自然会好奇检验统计量 $H$ 及其对应的 p 值是如何产生的。这个练习将带你深入了解 Kruskal-Wallis 检验的理论核心，通过枚举一个小样本案例中所有可能的秩分配方式，从零开始构建 $H$ 统计量的精确概率分布。这种“第一性原理”的探索有助于揭开统计检验的神秘面纱，让你深刻理解其做出判断的逻辑依据，尤其是在样本量较小，无法依赖近似分布的情况下。", "problem": "在一项非参数统计分析中，一名实验者从三个独立的小组中收集数据。样本大小为 $n_1=2$、$n_2=1$ 和 $n_3=1$。实验者希望检验原假设 $H_0$，即这些样本所来自的连续潜在分布是相同的。为此，他们采用克鲁斯卡尔-沃利斯检验。\n\n克鲁斯卡尔-沃利斯检验统计量 $H$ 由以下公式定义：\n$$H = \\frac{12}{N(N+1)} \\sum_{i=1}^{k} \\frac{R_i^2}{n_i} - 3(N+1)$$\n其中 $k$ 是组数，$n_i$ 是第 $i$ 组中的观测数，$N$ 是所有组的总观测数，而 $R_i$ 是将所有 $N$ 个观测值一起排序后，第 $i$ 组中观测值的秩之和。\n\n通过枚举所有可能的对观测值的不同秩分配，确定在此特定情况下，原假设下统计量 $H$ 的精确概率分布。该分布表示为一组数对 $(h, P(H=h))$，其中 $h$ 是统计量的一个可能值，$P(H=h)$ 是其对应的概率。以下哪个选项正确描述了此分布？\n\nA. $\\{ (0.3, \\frac{1}{6}), (1.8, \\frac{1}{3}), (2.7, \\frac{1}{2}) \\}$\n\nB. $\\{ (0.3, \\frac{1}{3}), (1.8, \\frac{1}{3}), (2.7, \\frac{1}{3}) \\}$\n\nC. $\\{ (0.3, \\frac{1}{2}), (1.8, \\frac{1}{3}), (2.7, \\frac{1}{6}) \\}$\n\nD. $\\{ (4.125, \\frac{1}{6}), (6.0, \\frac{1}{3}), (7.125, \\frac{1}{2}) \\}$\n\nE. $\\{ (0.3, \\frac{1}{6}), (1.8, \\frac{1}{6}), (2.7, \\frac{1}{6}), (5.4, \\frac{1}{6}), (6.6, \\frac{1}{6}), (9.9, \\frac{1}{6}) \\}$", "solution": "首先，我们确定实验的基本参数。总样本量 $N = n_1 + n_2 + n_3 = 2 + 1 + 1 = 4$。组数 $k=3$。待分配的秩为 $\\{1, 2, 3, 4\\}$。\n\n克鲁斯卡尔-沃利斯统计量 $H$ 的公式为：\n$$H = \\frac{12}{N(N+1)} \\sum_{i=1}^{k} \\frac{R_i^2}{n_i} - 3(N+1)$$\n将 $N=4$, $k=3$, $n_1=2$, $n_2=1$, $n_3=1$ 代入，我们得到：\n$$H = \\frac{12}{4(5)} \\left( \\frac{R_1^2}{2} + \\frac{R_2^2}{1} + \\frac{R_3^2}{1} \\right) - 3(5) = \\frac{3}{5} \\left( \\frac{R_1^2}{2} + R_2^2 + R_3^2 \\right) - 15$$\n其中 $R_i$ 是第 $i$ 组的秩和。秩的总和为 $1+2+3+4=10$，所以 $R_1 + R_2 + R_3 = 10$。\n\n在原假设下，所有将秩 $\\{1, 2, 3, 4\\}$ 分配给三个组的方式都是等可能的。分配方式的总数为将4个不同秩分配给大小为(2, 1, 1)的组，即 $\\binom{4}{2}\\binom{2}{1}\\binom{1}{1} = \\frac{4!}{2!1!1!} = 12$ 种。\n\n我们枚举所有可能的秩分配情况，计算对应的秩和 $(R_1, R_2, R_3)$ 以及 $H$ 值：\n\n1.  第1组的秩为 $\\{1, 2\\}$ ($R_1=3$)：剩下的秩为 $\\{3, 4\\}$。\n    -   $R_2=3, R_3=4$。秩和为 $(3, 3, 4)$。\n    -   $R_2=4, R_3=3$。秩和为 $(3, 4, 3)$。\n    -   对于这两种情况，$H = \\frac{3}{5}(\\frac{3^2}{2} + 3^2 + 4^2) - 15 = \\frac{3}{5}(4.5 + 9 + 16) - 15 = \\frac{3}{5}(29.5) - 15 = 17.7 - 15 = 2.7$。\n\n2.  第1组的秩为 $\\{1, 3\\}$ ($R_1=4$)：剩下的秩为 $\\{2, 4\\}$。\n    -   $R_2=2, R_3=4$。秩和为 $(4, 2, 4)$。\n    -   $R_2=4, R_3=2$。秩和为 $(4, 4, 2)$。\n    -   对于这两种情况，$H = \\frac{3}{5}(\\frac{4^2}{2} + 2^2 + 4^2) - 15 = \\frac{3}{5}(8 + 4 + 16) - 15 = \\frac{3}{5}(28) - 15 = 16.8 - 15 = 1.8$。\n\n3.  第1组的秩为 $\\{1, 4\\}$ ($R_1=5$)：剩下的秩为 $\\{2, 3\\}$。\n    -   $R_2=2, R_3=3$。秩和为 $(5, 2, 3)$。\n    -   $R_2=3, R_3=2$。秩和为 $(5, 3, 2)$。\n    -   对于这两种情况，$H = \\frac{3}{5}(\\frac{5^2}{2} + 2^2 + 3^2) - 15 = \\frac{3}{5}(12.5 + 4 + 9) - 15 = \\frac{3}{5}(25.5) - 15 = 15.3 - 15 = 0.3$。\n\n4.  第1组的秩为 $\\{2, 3\\}$ ($R_1=5$)：剩下的秩为 $\\{1, 4\\}$。\n    -   $R_2=1, R_3=4$。秩和为 $(5, 1, 4)$。\n    -   $R_2=4, R_3=1$。秩和为 $(5, 4, 1)$。\n    -   对于这两种情况，$H = \\frac{3}{5}(\\frac{5^2}{2} + 1^2 + 4^2) - 15 = \\frac{3}{5}(12.5 + 1 + 16) - 15 = \\frac{3}{5}(29.5) - 15 = 17.7 - 15 = 2.7$。\n\n5.  第1组的秩为 $\\{2, 4\\}$ ($R_1=6$)：剩下的秩为 $\\{1, 3\\}$。\n    -   $R_2=1, R_3=3$。秩和为 $(6, 1, 3)$。\n    -   $R_2=3, R_3=1$。秩和为 $(6, 3, 1)$。\n    -   对于这两种情况，$H = \\frac{3}{5}(\\frac{6^2}{2} + 1^2 + 3^2) - 15 = \\frac{3}{5}(18 + 1 + 9) - 15 = \\frac{3}{5}(28) - 15 = 16.8 - 15 = 1.8$。\n\n6.  第1组的秩为 $\\{3, 4\\}$ ($R_1=7$)：剩下的秩为 $\\{1, 2\\}$。\n    -   $R_2=1, R_3=2$。秩和为 $(7, 1, 2)$。\n    -   $R_2=2, R_3=1$。秩和为 $(7, 2, 1)$。\n    -   对于这两种情况，$H = \\frac{3}{5}(\\frac{7^2}{2} + 1^2 + 2^2) - 15 = \\frac{3}{5}(24.5 + 1 + 4) - 15 = \\frac{3}{5}(29.5) - 15 = 17.7 - 15 = 2.7$。\n\n现在，我们总结 $H$ 的概率分布：\n-   $P(H=0.3)$：当第1组秩为 $\\{1, 4\\}$ 时，有2种情况。概率为 $2/12 = 1/6$。\n-   $P(H=1.8)$：当第1组秩为 $\\{1, 3\\}$ 或 $\\{2, 4\\}$ 时，有 $2+2=4$ 种情况。概率为 $4/12 = 1/3$。\n-   $P(H=2.7)$：当第1组秩为 $\\{1, 2\\}$, $\\{2, 3\\}$,或 $\\{3, 4\\}$ 时，有 $2+2+2=6$ 种情况。概率为 $6/12 = 1/2$。\n\n因此，$H$ 的精确概率分布为 $\\{ (0.3, \\frac{1}{6}), (1.8, \\frac{1}{3}), (2.7, \\frac{1}{2}) \\}$。这与选项A相匹配。", "answer": "$$\\boxed{A}$$", "id": "1961656"}, {"introduction": "统计分析的终点并非仅仅是计算出一个 p 值，更重要的是如何正确地解读这个结果。此练习聚焦于一个在科学研究中至关重要的逻辑环节：如何解释一个不显著的检验结果。通过分析一个常见的错误结论，你可以学会避免“没有证据证明差异存在”与“证明了没有差异”之间的混淆，这是所有假设检验都必须遵循的基本原则。", "problem": "一位生物医学研究员正在研究三种不同的实验性药物配方（配方X、配方Y和配方Z）对减小小白鼠肿瘤大小的有效性。一组具有相似初始肿瘤大小的小白鼠被随机分为三组，每组接受其中一种配方。在固定的时间段后，测量每只小白鼠肿瘤大小的百分比减少量。研究员注意到，对于任何一组，肿瘤大小减少百分比的数据都呈高度偏态，并且不服从正态分布。\n\n因此，研究员决定使用非参数检验，并进行Kruskal-Wallis检验来比较三种配方下肿瘤大小减少量的分布。该检验得出的统计量为 $H$，相应的p值为 $p = 0.31$。\n\n基于此结果，研究员得出以下结论：“p值为0.31，在任何常规显著性水平（例如 $\\alpha = 0.05$）下都不具有统计显著性。因此，我们已经证明了这三种药物配方在减小肿瘤大小方面的效果是相同的。”\n\n下列哪个陈述指出了研究员结论中最根本的逻辑谬误？\n\nA. 研究员应该使用不同的非参数检验，例如Mann-Whitney U检验，因为它更适合三个组。\n\nB. 不显著的结果表明原假设为真，从而证实所有组都来自相同的总体分布。\n\nC. Kruskal-Wallis检验的统计功效不足以检测出任何差异，除非样本量极大，因此结果是不确定的。\n\nD. 未能拒绝原假设并不证明原假设为真；它仅表示没有足够的证据得出分布不同的结论。\n\nE. 0.31的高p值意味着即使在统计上不显著，该效应也具有实际显著性，因此这些药物很可能不同。", "solution": "目标是找出在解释假设检验（特别是Kruskal-Wallis检验）的非显著性结果时的主要逻辑错误。\n\n首先，让我们建立所进行的假设检验的框架。Kruskal-Wallis检验是一种非参数方法，用于确定一个自变量的两个或多个组在一个连续或有序的因变量上是否存在统计显著性差异。\n\nKruskal-Wallis检验的原假设（$H_0$）和备择假设（$H_A$）是：\n-   $H_0$：所有组的因变量分布都是相同的。在此背景下，配方X、配方Y和配方Z的肿瘤大小减少量的分布是相同的。\n-   $H_A$：至少有一组的因变量分布与其他组不同。也就是说，至少有一种配方导致的肿瘤大小减少量的分布与其他配方不同（通常解释为中位数的差异）。\n\np值代表在原假设（$H_0$）为真的前提下，观测到当前样本数据或更极端情况的概率。在这里，p值为0.31。常规的显著性水平 $\\alpha$ 是一个预先设定的用于做出决策的阈值（例如 $\\alpha = 0.05$）。\n\n决策规则是：\n-   如果 $p \\le \\alpha$，我们拒绝原假设（$H_0$）。\n-   如果 $p > \\alpha$，我们未能拒绝原假设（$H_0$）。\n\n在本例中，$p = 0.31$，它大于任何标准的 $\\alpha$ 值（如0.10、0.05或0.01）。因此，正确的统计决策是**未能拒绝原假设**。\n\n现在我们来分析研究员的结论：“……我们已经证明了这三种药物配方在效果上是相同的……” 这是一个断言，即原假设（$H_0$）为真。\n\n这就是核心的逻辑谬误。在频率学派假设检验的框架中，我们从不“接受”或“证明”原假设。一个不显著的结果（未能拒绝 $H_0$）仅仅意味着数据没有提供足够的证据让我们相信 $H_0$ 是错误的。一个不显著的结果有两种可能性：\n1.  原假设实际上是真的（药物的效果确实相同）。\n2.  原假设是假的（药物的效果不同），但研究缺乏检测出这种差异的统计功效。这可能是由于样本量小、数据变异性大或真实效应量小所致。\n\n因为仅凭一个不显著的结果，我们无法区分这两种可能性，所以我们不能断定 $H_0$ 为真。缺乏证据并非不存在的证据。正确的结论是，没有足够的证据声称药物配方之间存在差异。\n\n让我们根据这一理解来评估给出的选项：\n\n-   **A:** 这是不正确的。Mann-Whitney U检验仅用于比较*两个*独立的组。而Kruskal-Wallis检验是单因素方差分析（one-way ANOVA）的正确非参数等价方法，用于比较*三个或更多*的组。\n-   **B:** 这个陈述恰恰代表了研究员所犯的逻辑谬误。一个不显著的结果并*不*能证实原假设为真。\n-   **C:** 虽然统计功效确实是一个需要考虑的问题，但这个陈述过于绝对，可能不准确。如果效应量很大，即使样本量适中，Kruskal-Wallis检验也可能具有足够的功效。主要问题不在于该检验固有的弱点，而在于解释不显著p值的普遍逻辑。\n-   **D:** 这个陈述准确地描述了在假设检验中对不显著结果的正确解释。“未能拒绝”与“证明”或“接受”原假设是不同的。它正确地指出问题在于缺乏足够的证据。这是最根本的逻辑谬误。\n-   **E:** 这误解了p值。高的p值表示观测到的数据与原假设相容，而不是说存在实际效应。P值不衡量效应的大小或实际显著性。\n\n因此，选项D正确地指出了研究员推理中的根本错误。", "answer": "$$\\boxed{D}$$", "id": "1961681"}]}