{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是亲身实践。这个练习将带你逐步完成一个贯序概率比检验 (SPRT) 的核心流程。通过计算在接收到新数据点后似然比的更新，你将体验到证据是如何一步步积累，并最终导向一个统计决策（接受零假设、接受备择假设，或继续观察）的过程。[@problem_id:1954406]", "problem": "在一个新型半导体的质量控制流程中，元件被依次进行测试。每个元件要么是次品，要么是合格品。生产过程可能处于两种状态之一。在“正常”状态下，生产出次品的概率是 $p_0 = 1/3$。在“退化”状态下，这个概率是 $p_1 = 2/3$。\n\n为了监控这一过程，一位统计学家采用贯序概率比检验（SPRT）。设第 $i$ 次测试的结果为 $X_i$，其中如果元件是次品，则 $X_i=1$，如果元件是合格品，则 $X_i=0$。该检验基于以下假设：\n- 原假设，$H_0$：生产过程处于“正常”状态 ($p = p_0 = 1/3$)。\n- 备择假设，$H_1$：生产过程处于“退化”状态 ($p = p_1 = 2/3$)。\n\n检验通过计算 $n$ 次观测后的似然比 $\\Lambda_n$ 来进行。决策规则是：如果 $\\Lambda_n \\ge A$，则停止并接受 $H_1$；如果 $\\Lambda_n \\le B$，则停止并接受 $H_0$；如果 $B  \\Lambda_n  A$，则继续检验。常数 $A$ 和 $B$ 被选择用来控制错误率，并通过其自然对数给出，即 $\\ln A = \\ln(4)$ 和 $\\ln B = -\\ln(4)$。\n\n确定导致检验终止并接受备择假设 $H_1$ 的两次观测的具体序列 $(X_1, X_2)$。答案应该是一个由两个数字（0 或 1）组成的序列。", "solution": "在假设 $H_{0}: p=p_{0}=\\frac{1}{3}$ 和 $H_{1}: p=p_{1}=\\frac{2}{3}$ 下，贯序概率比检验使用 $n$ 次观测后的似然比，\n$$\n\\Lambda_{n}=\\prod_{i=1}^{n}\\frac{p_{1}^{X_{i}}(1-p_{1})^{1-X_{i}}}{p_{0}^{X_{i}}(1-p_{0})^{1-X_{i}}}.\n$$\n令 $S_{n}=\\sum_{i=1}^{n}X_{i}$ 为 $n$ 次观测中次品的数量。则\n$$\n\\Lambda_{n}=\\left(\\frac{p_{1}}{p_{0}}\\right)^{S_{n}}\\left(\\frac{1-p_{1}}{1-p_{0}}\\right)^{n-S_{n}}.\n$$\n代入 $p_{0}=\\frac{1}{3}$ 和 $p_{1}=\\frac{2}{3}$ 可得\n$$\n\\frac{p_{1}}{p_{0}}=\\frac{2/3}{1/3}=2,\\qquad \\frac{1-p_{1}}{1-p_{0}}=\\frac{1/3}{2/3}=\\frac{1}{2},\n$$\n因此\n$$\n\\Lambda_{n}=2^{S_{n}}\\left(\\frac{1}{2}\\right)^{n-S_{n}}=2^{2S_{n}-n}.\n$$\n决策阈值满足 $\\ln A=\\ln(4)$ 和 $\\ln B=-\\ln(4)$，所以 $A=4$ 且 $B=\\frac{1}{4}$。停止规则是：如果 $\\Lambda_{n}\\geq 4$，接受 $H_{1}$；如果 $\\Lambda_{n}\\leq \\frac{1}{4}$，接受 $H_{0}$；否则继续检验。\n\n对于 $n=1$, $S_{1}\\in\\{0,1\\}$:\n- 如果 $X_{1}=1$, 则 $\\Lambda_{1}=2^{2\\cdot 1-1}=2$.\n- 如果 $X_{1}=0$, 则 $\\Lambda_{1}=2^{2\\cdot 0-1}=\\frac{1}{2}$.\n两种情况下似然比都满足 $\\frac{1}{4}  \\Lambda_1  4$, 因此在一次观测后不做任何决策，继续检验。\n\n对于 $n=2$，枚举所有序列并计算 $S_{2}$ 和 $\\Lambda_{2}=2^{2S_{2}-2}$：\n- $(0,0)$：$S_{2}=0$，$\\Lambda_{2}=2^{-2}=\\frac{1}{4}$。因为 $\\Lambda_2 \\leq \\frac{1}{4}$, 所以接受 $H_{0}$。\n- $(1,0)$ 或 $(0,1)$：$S_{2}=1$，$\\Lambda_{2}=2^{2(1)-2}=1$。因为 $\\frac{1}{4}  1  4$, 所以继续检验。\n- $(1,1)$：$S_{2}=2$，$\\Lambda_{2}=2^{2(2)-2}=4$。因为 $\\Lambda_2 \\geq 4$, 所以接受 $H_{1}$。\n\n因此，唯一导致检验在两次观测后终止并接受 $H_{1}$ 的序列是 $(1,1)$。", "answer": "$$\\boxed{(1, 1)}$$", "id": "1954406"}, {"introduction": "贯序概率比检验的威力不仅限于处理伯努利试验这类离散结果。这个练习将展示它如何应用于连续分布，并揭示似然比方法一个深刻而有趣的特性。在某些情况下，单个观测数据可能携带极大的信息量，其本身就足以推翻一个假设，从而立即终止检验。[@problem_id:1954394]", "problem": "一位质量控制工程师正在评估一种特种电子元件的新制造工艺。已知一个元件的寿命（以千小时为单位）服从区间 $(0, \\theta)$ 上的均匀分布，记为 $U(0, \\theta)$。标准工艺生产的元件其参数 $\\theta$ 已知为 $\\theta_0 = 1$。正在测试一种新的、可能经过改进的工艺，据称该工艺生产的元件其参数为 $\\theta_1 = 2$。\n\n工程师采用序贯概率比检验（SPRT）来在这两个对立的假设之间做出决策：\n- 零假设 $H_0: \\theta = \\theta_0 = 1$\n- 备择假设 $H_1: \\theta = \\theta_1 = 2$\n\n该检验的设计要求最大 I 型错误概率为 $\\alpha = 0.05$，最大 II 型错误概率为 $\\beta = 0.10$。SPRT 过程涉及序贯地收集元件的寿命数据。在第 $n$ 次观测后，计算似然比 $\\lambda_n$ 并与两个阈值 $A$ 和 $B$ 进行比较。决策规则如下：\n- 如果 $\\lambda_n \\ge A$，停止抽样并拒绝 $H_0$。\n- 如果 $\\lambda_n \\le B$，停止抽样并接受 $H_0$。\n- 如果 $B  \\lambda_n  A$，继续抽样。\n\n阈值使用公式 $A \\approx (1-\\beta)/\\alpha$ 和 $B \\approx \\beta/(1-\\alpha)$ 进行近似。\n\n在测试过程中，观察到从新工艺中选出的第一个元件的寿命为 $x_1 = 1.3$ 千小时。根据这单次观测，以下哪个陈述正确地描述了即时结果及其原因？\n\nA. 继续测试，因为单个数据点不足以做出决策。\n\nB. 接受 $H_0$，因为观测值相对接近 $H_0$ 下的均值。\n\nC. 拒绝 $H_0$，因为在 $H_0$ 下该观测值的似然为零，使得似然比为无穷大。\n\nD. 继续测试，因为该观测的似然比落在决策阈值 $A$ 和 $B$ 之间。\n\nE. 拒绝 $H_0$，因为似然比为负，低于下阈值 $B$。", "solution": "参数为 $\\theta$ 时的寿命模型是 $X \\sim U(0,\\theta)$，其概率密度函数 (PDF) 为\n$$\nf(x | \\theta) = \\begin{cases}\n\\frac{1}{\\theta},  0  x  \\theta, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n我们的假设为 $H_{0}:\\theta=\\theta_{0}=1$ 和 $H_{1}:\\theta=\\theta_{1}=2$。因此，在 $H_{0}$ 和 $H_{1}$ 下的密度函数分别为：\n$$\nf(x | H_0) = \\begin{cases}\n1,  0  x  1, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n\\qquad\nf(x | H_1) = \\begin{cases}\n\\frac{1}{2},  0  x  2, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n对于单次观测 $x_1 = 1.3$，我们计算其在两个假设下的似然值：\n- 在 $H_0$ 下，$f(1.3 | H_0) = 0$，因为 $1.3$ 不在区间 $(0, 1)$ 内。\n- 在 $H_1$ 下，$f(1.3 | H_1) = 1/2$，因为 $1.3$ 在区间 $(0, 2)$ 内。\n\n似然比 $\\lambda_1$ 定义为：\n$$\n\\lambda_1 = \\frac{f(1.3 | H_1)}{f(1.3 | H_0)} = \\frac{1/2}{0}\n$$\n这个比值是无穷大 ($\\infty$)。\n\n根据SPRT的决策规则，我们需要将 $\\lambda_1$ 与上阈值 $A \\approx (1-0.10)/0.05 = 18$ 进行比较。由于 $\\lambda_1 = \\infty$，它显然大于 $A$。因此，我们立即停止检验并拒绝零假设 $H_0$。\n\n这个结果的直观解释是：观测到 $1.3$ 这个值在零假设（寿命最长为1）下是不可能发生的事件（概率为零）。因此，仅这一个观测就提供了决定性的证据来反驳 $H_0$。\n\n因此，正确的陈述是 C。", "answer": "$$\\boxed{C}$$", "id": "1954394"}, {"introduction": "贯序分析的一个主要优势在于其高效性，即平均而言，它比固定样本量检验需要更少的观测就能得出结论。这个练习将我们的关注点从“如何执行检验”转向“如何评估检验的效率”。你将学习并应用 Wald 的近似公式来估算检验所需的期望样本数量，这是设计和规划高效实验（例如临床试验或A/B测试）时的一个关键性能指标。[@problem_id:1954399]", "problem": "一家医疗设备公司正在测试一种用于检测特定生物标志物的新型生物传感器。该公司采用序贯概率比检验（SPRT）来对样本测量值 $X$ 的两种假设做出决策：\n- 原假设 $H_0$：生物标志物不存在。\n- 备择假设 $H_1$：生物标志物存在。\n\n该检验的设计要求I型错误概率（假阳性率）为 $\\alpha = 0.1$，II型错误概率（假阴性率）为 $\\beta = 0.1$。对于每个测试的样本，都会计算一个随机变量 $Z$，即对数似然比。根据来自类似传感器的历史数据，已知如果生物标志物确实存在（即 $H_1$ 为真），单个样本的该对数似然比的期望值为 $E_{H_1}[Z] = 0.5$。\n\n使用Wald关于停止边界和期望样本量的近似，计算在假设被测材料中确实存在生物标志物的情况下，达到决策所需的期望样本数量。请用闭式解析表达式表示您的答案。", "solution": "我们考虑序贯概率比检验（SPRT），其中每个样本的对数似然比增量为 $Z_{i}$，累积对数似然为 $S_{n}=\\sum_{i=1}^{n}Z_{i}$。为与正文保持一致，我们使用 Wald 近似在对数域中设定决策边界如下：\n$$\nb \\approx \\ln\\left(\\frac{1-\\beta}{\\alpha}\\right) \\quad (\\text{上边界}), \\qquad a \\approx \\ln\\left(\\frac{\\beta}{1-\\alpha}\\right) \\quad (\\text{下边界})\n$$\n其中，当 $S_{n}\\geq b$ 时接受 $H_{1}$，当 $S_{n}\\leq a$ 时接受 $H_{0}$。\n\n在 $H_{1}$ 成立的情况下，接受 $H_{1}$ 的概率近似为 $1-\\beta$，接受 $H_{0}$ 的概率近似为 $\\beta$。忽略过冲效应，在 $H_{1}$ 下对数似然的期望终值为：\n$$\nE_{H_{1}}[S_{N}]\\approx (1-\\beta)b+\\beta a\n$$\n根据Wald恒等式，对于具有有限均值的独立同分布增量，$E_{H_{1}}[S_{N}]=E_{H_{1}}[Z]\\cdot E_{H_{1}}[N]$。因此，在 $H_{1}$ 下的期望样本量近似为：\n$$\nE_{H_{1}}[N]\\approx \\frac{(1-\\beta)b+\\beta a}{E_{H_{1}}[Z]}\n$$\n\n给定 $\\alpha=0.1$ 和 $\\beta=0.1$，我们计算边界：\n$$\nb \\approx \\ln\\left(\\frac{1-0.1}{0.1}\\right)=\\ln\\left(\\frac{0.9}{0.1}\\right)=\\ln(9)\n$$\n$$\na \\approx \\ln\\left(\\frac{0.1}{1-0.1}\\right)=\\ln\\left(\\frac{0.1}{0.9}\\right)=\\ln\\left(\\frac{1}{9}\\right)=-\\ln(9)\n$$\n将这些值代入期望终值的公式：\n$$\n(1-\\beta)b+\\beta a \\approx \\left(1-0.1\\right)\\ln(9)+0.1\\left(-\\ln(9)\\right) = 0.9\\ln(9) - 0.1\\ln(9) = 0.8\\ln(9) = \\frac{4}{5}\\ln(9)\n$$\n已知 $E_{H_{1}}[Z]=0.5 = \\frac{1}{2}$，我们可以计算期望样本数：\n$$\nE_{H_{1}}[N]\\approx \\frac{\\frac{4}{5}\\ln(9)}{\\frac{1}{2}}=\\frac{8}{5}\\ln(9)\n$$\n利用对数性质 $\\ln(9) = \\ln(3^2) = 2\\ln(3)$, 结果也可以表示为 $\\frac{16}{5}\\ln(3)$。\n\n这就是在Wald近似下，当生物标志物确实存在时，所需期望样本数量的闭式解析表达式。", "answer": "$$\\boxed{\\frac{8}{5}\\ln(9)}$$", "id": "1954399"}]}