{"hands_on_practices": [{"introduction": "M-估计量的概念起初可能看起来很抽象。让我们从一个具体的例子开始，这个例子将M-估计量与一个你已经非常熟悉的统计量——样本中位数——联系起来。通过选择绝对值函数 $\\rho(u) = |u|$ 作为我们的损失函数，我们将看到最小化总损失的过程如何自然地导出了中位数。这个练习旨在揭示M-估计量框架的内在简洁性和它与经典稳健统计思想的联系。[@problem_id:1932002]", "problem": "在稳健统计学中，M-估计量为定义位置估计量提供了一个通用框架。对于给定的数据样本 $\\{x_1, x_2, \\dots, x_n\\}$ 和一个选定的凸函数 $\\rho$，位置的M-估计量（记为 $\\hat{\\theta}$）是使目标函数 $S(\\theta) = \\sum_{i=1}^n \\rho(x_i - \\theta)$ 最小化的 $\\theta$ 值。\n\n考虑一个由绝对值函数 $\\rho(u) = |u|$ 定义的M-估计量。计算对于数据样本 $X = \\{2.5, 9.8, 15.1, 4.0, 21.3\\}$，该M-估计量的值。请将答案表示为一个数字。", "solution": "我们得到由 $\\rho(u)=|u|$ 定义的M-估计量的目标函数为\n$$\nS(\\theta)=\\sum_{i=1}^{n} |x_{i}-\\theta|.\n$$\n由于 $|\\,\\cdot\\,|$ 是凸函数，所以 $S(\\theta)$ 关于 $\\theta$ 是凸的。$\\hat{\\theta}$ 最小化 $S(\\theta)$ 的一个充分必要条件是次梯度最优性条件\n$$\n0 \\in \\partial S(\\theta)=\\sum_{i=1}^{n} \\partial |x_{i}-\\theta|.\n$$\n对于每一项，关于 $\\theta$ 的次梯度是\n$$\n\\partial |x_{i}-\\theta|=\n\\begin{cases}\n\\{-1\\},  \\theta  x_{i},\\\\\n[-1,1],  \\theta = x_{i},\\\\\n\\{1\\},  \\theta  x_{i}.\n\\end{cases}\n$$\n令 $L(\\theta)$ 为严格小于 $\\theta$ 的 $x_i$ 的数量，$G(\\theta)$ 为严格大于 $\\theta$ 的 $x_i$ 的数量，$E(\\theta)$ 为等于 $\\theta$ 的 $x_i$ 的数量。那么次梯度之和是一个区间\n$$\n\\partial S(\\theta)=\\left[\\, -L(\\theta)+G(\\theta)-E(\\theta),\\; -L(\\theta)+G(\\theta)+E(\\theta)\\,\\right].\n$$\n条件 $0 \\in \\partial S(\\theta)$ 等价于\n$$\n-L(\\theta)+G(\\theta) \\in [-E(\\theta),\\,E(\\theta)],\n$$\n这又等价于下面这对不等式\n$$\nL(\\theta) \\leq \\frac{n}{2} \\quad \\text{and} \\quad G(\\theta) \\leq \\frac{n}{2}.\n$$\n因此，任何最小化子 $\\hat{\\theta}$ 都必须是样本的中位数。对于一个样本量为奇数 $n$ 且所有值都不同的样本，唯一的最小化子是样本中位数，即中间的次序统计量。\n\n对于数据 $X=\\{2.5, 9.8, 15.1, 4.0, 21.3\\}$，对这些值进行排序得到\n$$\n2.5 \\quad 4.0 \\quad 9.8 \\quad 15.1 \\quad 21.3.\n$$\n当 $n=5$ 时，中位数是第三个次序统计量，即 $9.8$。因此，由 $\\rho(u)=|u|$ 定义的M-估计量是\n$$\n\\hat{\\theta}=9.8.\n$$", "answer": "$$\\boxed{9.8}$$", "id": "1932002"}, {"introduction": "虽然中位数对异常值具有很强的稳健性，但它可能牺牲了部分统计效率。Huber估计量提供了一种巧妙的折中方案，它对中心附近的数据点使用平方损失（类似于均值），而对远离中心的异常值使用绝对值损失（类似于中位数）。这个练习将带你动手计算一个Huber M-估计量，让你亲身体验它是如何通过“裁剪”大偏差的影响来获得稳健性的，这是现代稳健统计中的核心技巧。[@problem_id:1952425]", "problem": "在稳健统计学中，M-估计量是一大类对异常值具有稳健性的估计量。对于一个数据集 $\\{x_1, x_2, \\ldots, x_n\\}$，其位置M-估计量（记为 $\\hat{\\theta}$）被定义为以下方程的解：\n$$\n\\sum_{i=1}^{n} \\psi\\left(\\frac{x_i - \\theta}{S}\\right) = 0\n$$\n其中 $S$ 是一个稳健的尺度估计量，而 $\\psi$ 是一个选定的影响函数。\n\n考虑Huber的 $\\psi$ 函数，对于给定的调节常数 $k  0$，其定义为：\n$$\n\\psi_k(u) = \\begin{cases}\n-k  \\text{如果 } u  -k \\\\\nu  \\text{如果 } |u| \\leq k \\\\\nk  \\text{如果 } u  k\n\\end{cases}\n$$\n该函数通过在 $\\pm k$ 处“截断”大残差来限制其影响。\n\n一位工程师正在分析一组关于某个组件长度的五次独立测量。获得的测量值是：\n$$\n\\{2.1, 2.5, 2.3, 2.6, 4.5\\}\n$$\n为了获得一个对单个大数值不那么敏感的位置估计，该工程师决定使用M-估计量。在计算中，将使用一个固定的尺度估计量 $S=1$ 和一个调节常数 $k=1.5$。\n\n计算该数据集的位置M-估计量 $\\hat{\\theta}$。你的答案应四舍五入至三位有效数字。", "solution": "我们寻求 $\\hat{\\theta}$ 以求解M-估计方程\n$$\n\\sum_{i=1}^{5} \\psi_{k}\\!\\left(\\frac{x_{i}-\\theta}{S}\\right)=0,\n$$\n其中 $S=1$, $k=1.5$, 且 $x=\\{2.1,2.5,2.3,2.6,4.5\\}$。当 $S=1$ 时，方程变为\n$$\n\\sum_{i=1}^{5} \\psi_{k}(x_{i}-\\theta)=0,\n$$\n其中Huber函数为：当 $|u|\\leq k$ 时，$\\psi_{k}(u)=u$；当 $|u|k$ 时，$\\psi_{k}(u)=\\pm k$，符号与 $u$ 相同。\n\n对于每个 $x_i$，当 $|x_{i}-\\theta|\\leq 1.5$ 时，该项是线性的（即未被截断），等价于 $\\theta\\in[x_{i}-1.5,\\,x_{i}+1.5]$。这些区间是：\n- $x_{1}=2.1$：$\\theta\\in[0.6,\\,3.6]$，\n- $x_{2}=2.5$：$\\theta\\in[1.0,\\,4.0]$，\n- $x_{3}=2.3$：$\\theta\\in[0.8,\\,3.8]$，\n- $x_{4}=2.6$：$\\theta\\in[1.1,\\,4.1]$，\n- $x_{5}=4.5$：$\\theta\\in[3.0,\\,6.0]$。\n\n考虑 $\\theta\\in[1.1,3.0)$，在此区间内，前四项是线性的，而第五项由于 $4.5-\\theta1.5$ 被截断为 $+1.5$。于是\n$$\n\\sum_{i=1}^{5} \\psi_{k}(x_{i}-\\theta)=\\sum_{i=1}^{4} (x_{i}-\\theta) + 1.5.\n$$\n使用 $\\sum_{i=1}^{4} x_{i}=2.1+2.5+2.3+2.6=9.5$，我们得到\n$$\n9.5 - 4\\theta + 1.5 = 0 \\;\\;\\Longrightarrow\\;\\; 11 - 4\\theta = 0 \\;\\;\\Longrightarrow\\;\\; \\hat{\\theta}=\\frac{11}{4}=2.75.\n$$\n在 $\\hat{\\theta}=2.75$ 处检查区域一致性：\n- 对于 $x_{1},x_{2},x_{3},x_{4}$， $|x_{i}-\\hat{\\theta}|\\in\\{0.65,0.25,0.45,0.15\\}\\leq 1.5$，所以将它们作为线性项处理是正确的。\n- 对于 $x_{5}$， $|4.5-2.75|=1.751.5$，所以它被正确地截断为 $+1.5$。\n\n因此，该解在此区域内是有效且唯一的。四舍五入至三位有效数字得到 $2.75$。", "answer": "$$\\boxed{2.75}$$", "id": "1952425"}, {"introduction": "M-估计量的强大之处在于其灵活性——我们可以通过设计不同的 $\\rho$ 函数来创造具有特定性质的新估计量。这个练习将引导你探索一个不常见的选择：基于双曲余弦函数的M-估计量。你需要运用微积分来推导并求解相应的估计方程，这不仅能加深你对M-估计量背后数学原理的理解，也展示了该框架的普适性和创造性。[@problem_id:1931982]", "problem": "在数理统计中，M-估计量为位置参数 $\\theta$ 提供了一类普适的稳健估计量。对于一组观测值 $x_1, x_2, \\ldots, x_n$，M-估计值 $\\hat{\\theta}$ 是使目标函数 $S(\\theta) = \\sum_{i=1}^n \\rho(x_i - \\theta)$ 最小化的 $\\theta$ 值，其中 $\\rho$ 是一个给定的实值函数。为了使得到的估计具有理想的统计性质，函数 $\\rho(u)$ 通常被选为一个对称（偶）函数，它是凸的，并在 $u=0$ 处有唯一的最小值。一个常见的选择 $\\rho(u) = \\frac{1}{2}u^2$ 会导出样本均值作为 M-估计值。\n\n考虑一个由函数 $\\rho(u) = \\cosh(u) - 1$ 定义的新 M-估计量。\n给定一个包含三个观测值 $\\{-\\ln(2), \\ln(2), \\ln(5)\\}$ 的小数据集，请基于这个特定的 $\\rho$ 函数，确定位置参数的 M-估计值 $\\hat{\\theta}$ 的精确值。", "solution": "我们已知 M-估计量是通过最小化 $S(\\theta)=\\sum_{i=1}^{n}\\rho(x_{i}-\\theta)$ 来定义的，其中 $\\rho(u)=\\cosh(u)-1$。由于 $\\cosh$ 是凸函数且在 $u=0$ 处有唯一最小值，因此 $S(\\theta)$ 关于 $\\theta$ 是严格凸的，所以其最小值点是唯一的，并由一阶条件确定。\n\n计算导数：\n$$\n\\frac{d}{d\\theta}\\rho(x_{i}-\\theta)=-\\rho'(x_{i}-\\theta)=-\\sinh(x_{i}-\\theta).\n$$\n因此，\n$$\nS'(\\theta)=-\\sum_{i=1}^{n}\\sinh(x_{i}-\\theta).\n$$\n因此，估计方程为\n$$\n\\sum_{i=1}^{n}\\sinh(x_{i}-\\theta)=0.\n$$\n使用 $\\sinh(y)=\\frac{\\exp(y)-\\exp(-y)}{2}$，我们得到\n$$\n\\sum_{i=1}^{n}\\left(\\frac{\\exp(x_{i}-\\theta)-\\exp(\\theta-x_{i})}{2}\\right)=0\n\\;\\Longleftrightarrow\\;\n\\sum_{i=1}^{n}\\left(\\frac{\\exp(x_{i})}{\\exp(\\theta)}-\\frac{\\exp(\\theta)}{\\exp(x_{i})}\\right)=0.\n$$\n令 $T=\\exp(\\theta)$。则方程变为\n$$\n\\frac{1}{T}\\sum_{i=1}^{n}\\exp(x_{i})-T\\sum_{i=1}^{n}\\exp(-x_{i})=0\n\\;\\Longleftrightarrow\\;\n\\sum_{i=1}^{n}\\exp(x_{i})-T^{2}\\sum_{i=1}^{n}\\exp(-x_{i})=0,\n$$\n所以\n$$\nT^{2}=\\frac{\\sum_{i=1}^{n}\\exp(x_{i})}{\\sum_{i=1}^{n}\\exp(-x_{i})}\n\\quad\\Longrightarrow\\quad\n\\theta=\\frac{1}{2}\\ln\\!\\left(\\frac{\\sum_{i=1}^{n}\\exp(x_{i})}{\\sum_{i=1}^{n}\\exp(-x_{i})}\\right).\n$$\n\n对于数据 $\\{-\\ln(2),\\,\\ln(2),\\,\\ln(5)\\}$，计算\n$$\n\\sum_{i=1}^{3}\\exp(x_{i})=\\exp(-\\ln 2)+\\exp(\\ln 2)+\\exp(\\ln 5)=\\frac{1}{2}+2+5=\\frac{15}{2},\n$$\n$$\n\\sum_{i=1}^{3}\\exp(-x_{i})=\\exp(\\ln 2)+\\exp(-\\ln 2)+\\exp(-\\ln 5)=2+\\frac{1}{2}+\\frac{1}{5}=\\frac{27}{10}.\n$$\n因此，\n$$\n\\frac{\\sum_{i=1}^{3}\\exp(x_{i})}{\\sum_{i=1}^{3}\\exp(-x_{i})}\n=\\frac{\\frac{15}{2}}{\\frac{27}{10}}\n=\\frac{15}{2}\\cdot\\frac{10}{27}\n=\\frac{150}{54}\n=\\frac{25}{9},\n$$\n所以\n$$\n\\hat{\\theta}=\\frac{1}{2}\\ln\\!\\left(\\frac{25}{9}\\right)=\\ln\\!\\left(\\frac{5}{3}\\right).\n$$\n根据严格凸性，这是唯一的最小值点。", "answer": "$$\\boxed{\\ln\\!\\left(\\frac{5}{3}\\right)}$$", "id": "1931982"}]}