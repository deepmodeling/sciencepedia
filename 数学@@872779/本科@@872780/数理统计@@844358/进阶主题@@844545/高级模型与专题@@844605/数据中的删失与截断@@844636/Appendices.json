{"hands_on_practices": [{"introduction": "这个问题提供了一个典型的右删失场景，这在从临床试验到心理学实验的许多领域中都很常见。我们通常无法无限期地等待一个事件发生，因此观察会在特定时间点停止。本练习将演示如何正确运用最大似然估计（Maximum Likelihood Estimation, MLE）方法，来估算平均事件时间，即使部分数据点因这种删失而不完整 [@problem_id:1902749]。", "problem": "在一项认知心理学实验中，一组学生被要求解决一个复杂的谜题。假设学生解决谜题所需的时间服从指数分布，其未知平均时间为 $\\theta$。该实验有时间限制：每名学生最多有15.0分钟的时间来解决这个谜题。如果学生在此时间内未能解决谜题，他们的尝试将被终止，其解题时间被记录为大于15.0分钟。这是一种右删失情况。\n\n在一次实验中，有十名学生参与。成功完成谜题的五名学生的记录时间分别为5.2、8.7、10.1、12.5和14.8分钟。剩下的五名学生未能在15.0分钟的截止时间内解决谜题。\n\n使用所提供的数据，计算平均解题时间 $\\theta$ 的最大似然估计（MLE）。答案以分钟为单位，并四舍五入至三位有效数字。", "solution": "假设解题时间是独立的，服从均值为 $\\theta$ 的指数分布，并在 $c=15.0$ 处进行右删失。对于每个未删失的时间 $t_{i}$，其对似然函数的贡献是 $f(t_{i}\\mid\\theta)=\\frac{1}{\\theta}\\exp(-t_{i}/\\theta)$，而对于每个删失的观测值，其贡献是 $S(c\\mid\\theta)=\\exp(-c/\\theta)$。\n\n设 $n=10$，$d=5$ 为未删失观测值的数量，$n-d=5$ 为在 $c=15.0$ 处被删失的观测值数量。观测到的未删失时间为 $t_{1}=5.2$、$t_{2}=8.7$、$t_{3}=10.1$、$t_{4}=12.5$、$t_{5}=14.8$。似然函数为\n$$\nL(\\theta)=\\prod_{i=1}^{d}\\left(\\frac{1}{\\theta}\\exp\\left(-\\frac{t_{i}}{\\theta}\\right)\\right)\\times\\prod_{j=1}^{n-d}\\exp\\left(-\\frac{c}{\\theta}\\right)\n=\\theta^{-d}\\exp\\left(-\\frac{\\sum_{i=1}^{d}t_{i}+c(n-d)}{\\theta}\\right).\n$$\n定义 $T=\\sum_{i=1}^{d}t_{i}+c(n-d)$。对数似然函数为\n$$\n\\ell(\\theta)=-d\\ln\\theta-\\frac{T}{\\theta}.\n$$\n求导并令其等于零：\n$$\n\\frac{\\partial \\ell}{\\partial \\theta}=-\\frac{d}{\\theta}+\\frac{T}{\\theta^{2}}=0\n\\quad\\Longrightarrow\\quad\n\\hat{\\theta}=\\frac{T}{d}.\n$$\n二阶导数为\n$$\n\\frac{\\partial^{2}\\ell}{\\partial \\theta^{2}}=\\frac{d}{\\theta^{2}}-\\frac{2T}{\\theta^{3}},\n$$\n在 $\\hat{\\theta}=T/d$ 处，其值为 $-\\frac{d^{3}}{T^{2}}0$，确认了这是一个极大值。\n\n计算 $T$：\n$$\n\\sum_{i=1}^{5}t_{i}=5.2+8.7+10.1+12.5+14.8=51.3,\\quad c(n-d)=15.0\\times 5=75.0,\n$$\n因此\n$$\nT=51.3+75.0=126.3,\\quad \\hat{\\theta}=\\frac{126.3}{5}=25.26\\ \\text{分钟}.\n$$\n四舍五入至三位有效数字，$\\hat{\\theta}=25.3$ 分钟。", "answer": "$$\\boxed{25.3}$$", "id": "1902749"}, {"introduction": "在基本删失概念的基础上，这个问题引入了竞争风险（competing risks）的思想。在许多现实世界的情境中，删失不仅仅是一个简单的时间限制，而是与我们感兴趣的主要事件“竞争”的另一个事件。本练习模拟了LED的失效与安全协议触发的关停之间的竞争，这是可靠性工程中的一个常见场景，它将引导你推导出失效率的最大似然估计，并揭示一个在生存分析中广泛适用且非常重要的结论 [@problem_id:1902740]。", "problem": "一个材料科学实验室正在对新一代大功率发光二极管（LED）进行可靠性研究。LED的寿命 $T$ 定义为其失效前的时间，被建模为一个服从指数分布的随机变量，其未知但恒定的失效率参数为 $\\lambda  0$。\n\n对于每个被测试的LED，都有一项关键的安全协议。如果某个特定单元的内部工作温度超过了预设的安全阈值，则该单元的测试将立即终止。这种删失事件是由随机因素引起的，例如微观缺陷或冷却系统的波动。由于此温度限制而终止单元测试的时间 $C$ 也被建模为一个随机变量。根据来自相似组件的历史数据，假定 $C$ 服从一个速率参数为 $\\mu  0$ 的指数分布。寿命 $T$ 和删失时间 $C$ 被假定为独立的随机变量。\n\n在一批包含 $N$ 个相同LED的样品上进行了一项实验。对于每个LED $i$（其中 $i=1, 2, \\ldots, N$），实验记录了观测时间 $y_i$ 和一个状态指示符 $\\delta_i$。时间 $y_i$ 是失效时间或删失时间，以先发生者为准。如果第 $i$ 个LED失效，则指示符为 $\\delta_i=1$；如果测试因温度安全协议而停止，则指示符为 $\\delta_i=0$。\n\n推导失效率的最大似然估计量（MLE），记为 $\\hat{\\lambda}$。请将您的最终结果表示为一个封闭形式的解析表达式，用以下来自观测数据的汇总统计量表示：观测到的总失效数 $D = \\sum_{i=1}^{N} \\delta_i$，以及所有观测时间的总和（总测试时间） $Y = \\sum_{i=1}^{N} y_i$。", "solution": "设 $T \\sim \\text{Exp}(\\lambda)$ 和 $C \\sim \\text{Exp}(\\mu)$ 相互独立。它们的概率密度函数 (PDF) 和生存函数 (Survival Function) 分别为：\n- $f_T(t) = \\lambda e^{-\\lambda t}$, $S_T(t) = e^{-\\lambda t}$\n- $f_C(c) = \\mu e^{-\\mu c}$, $S_C(c) = e^{-\\mu c}$\n\n对于第 $i$ 个观测，我们记录了 $y_i = \\min(T_i, C_i)$ 和指示符 $\\delta_i = \\mathbf{1}\\{T_i \\le C_i\\}$。\n\n该观测对似然函数的贡献是其观测结果 $(y_i, \\delta_i)$ 的联合概率密度。我们可以分两种情况考虑：\n1.  **观测到失效 ($\\delta_i = 1$)**: 这意味着 $T_i = y_i$ 并且 $C_i > y_i$。由于 $T_i$ 和 $C_i$ 独立，该事件的联合概率密度为 $f_T(y_i) \\times P(C_i > y_i) = f_T(y_i) S_C(y_i)$。\n2.  **观测到删失 ($\\delta_i = 0$)**: 这意味着 $C_i = y_i$ 并且 $T_i > y_i$。同样，由于独立性，该事件的联合概率密度为 $f_C(y_i) \\times P(T_i > y_i) = f_C(y_i) S_T(y_i)$。\n\n我们可以将这两种情况统一成一个表达式。第 $i$ 个观测对似然函数的贡献为：\n$$\nL_i(\\lambda, \\mu) = [f_T(y_i) S_C(y_i)]^{\\delta_i} [f_C(y_i) S_T(y_i)]^{1-\\delta_i}\n$$\n代入指数分布的表达式：\n$$\nL_i(\\lambda, \\mu) = [\\lambda e^{-\\lambda y_i} \\cdot e^{-\\mu y_i}]^{\\delta_i} [\\mu e^{-\\mu y_i} \\cdot e^{-\\lambda y_i}]^{1-\\delta_i}\n$$\n简化指数项：\n$$\nL_i(\\lambda, \\mu) = [\\lambda e^{-(\\lambda+\\mu)y_i}]^{\\delta_i} [\\mu e^{-(\\lambda+\\mu)y_i}]^{1-\\delta_i} = \\lambda^{\\delta_i} \\mu^{1-\\delta_i} e^{-(\\lambda+\\mu)y_i}\n$$\n整个样本的似然函数是所有独立观测贡献的乘积：\n$$\nL(\\lambda, \\mu) = \\prod_{i=1}^{N} L_i(\\lambda, \\mu) = \\prod_{i=1}^{N} \\left(\\lambda^{\\delta_i} \\mu^{1-\\delta_i} e^{-(\\lambda+\\mu)y_i}\\right)\n$$\n将乘积拆分并使用汇总统计量 $D = \\sum_{i=1}^{N} \\delta_i$ 和 $Y = \\sum_{i=1}^{N} y_i$：\n$$\nL(\\lambda, \\mu) = \\lambda^{\\sum \\delta_i} \\mu^{\\sum (1-\\delta_i)} e^{-(\\lambda+\\mu)\\sum y_i} = \\lambda^D \\mu^{N-D} e^{-(\\lambda+\\mu)Y}\n$$\n对数似然函数为：\n$$\n\\ell(\\lambda, \\mu) = \\ln L(\\lambda, \\mu) = D \\ln \\lambda + (N-D) \\ln \\mu - (\\lambda+\\mu)Y\n$$\n为了找到 $\\lambda$ 的最大似然估计量 (MLE) $\\hat{\\lambda}$，我们对 $\\ell(\\lambda, \\mu)$ 关于 $\\lambda$ 求偏导，并令其等于零。注意，$\\mu$ 在此被视为一个无关参数 (nuisance parameter)。\n$$\n\\frac{\\partial \\ell}{\\partial \\lambda} = \\frac{D}{\\lambda} - Y\n$$\n令偏导数为零：\n$$\n\\frac{D}{\\hat{\\lambda}} - Y = 0 \\implies \\hat{\\lambda} = \\frac{D}{Y}\n$$\n这个结果非常直观：失效率的估计量就是观测到的总失效数除以总测试时间。值得注意的是，这个估计量不依赖于删失率 $\\mu$。", "answer": "$$\\boxed{\\frac{D}{Y}}$$", "id": "1902740"}, {"introduction": "这个问题提出了一个更复杂、更现实的数据挑战，涉及区间删失（interval censoring），也称为“现状数据”（current status data）。在这类研究中，我们无法观测到确切的事件发生时间，只知道在某个单一检查时间点事件是否已经发生。更具挑战性的是，本问题还引入了测量误差，即诊断测试可能产生假阳性或假阴性结果。你的任务是从第一性原理出发，构建对数似然函数，这是为非标准数据开发统计模型的一项基本技能 [@problem_id:1902717]。", "problem": "在一项微生物学研究中，研究人员对事件发生时间 $T$ 感兴趣，它代表了在一个细菌菌落中出现特定有益突变所需的时间。时间 $T$ 被建模为一个随机变量，服从一个未知的率参数为 $\\lambda  0$ 的指数分布。\n\n由于资源限制，实验中的 $n$ 个菌落每个只被检查一次。对于第 $i$ 个菌落（其中 $i=1, \\dots, n$），检查在一个预定的时间 $c_i  0$ 进行。此时，会进行一次测试以确定突变是否已经发生。\n\n这个诊断测试并非完美。它有一个已知的假阴性率 $\\alpha$ 和一个已知的假阳性率 $\\beta$。具体来说：\n- 当突变在时间 $c_i$ 前实际已经发生时，测试结果显示没有突变的概率是 $P(\\text{测试阴性} | T_i \\le c_i) = \\alpha$。\n- 当突变在时间 $c_i$ 前实际没有发生时，测试结果显示有突变的概率是 $P(\\text{测试阳性} | T_i  c_i) = \\beta$。\n\n实验的观测数据由 $n$ 个数据对组成，$\\{(c_1, y_1), (c_2, y_2), \\dots, (c_n, y_n)\\}$，其中 $c_i$ 是第 $i$ 个菌落的检查时间，$y_i$ 是测试的二元结果，其中 $y_i=1$ 表示阳性结果（检测到突变），$y_i=0$ 表示阴性结果（未检测到突变）。假设 $0  \\alpha  1$ 和 $0  \\beta  1$。\n\n基于观测数据，推导出参数 $\\lambda$ 的对数似然函数 $\\ell(\\lambda)$。用观测数据 $(c_i, y_i)$、样本量 $n$ 以及常数 $\\alpha$ 和 $\\beta$ 来表示你的答案。", "solution": "设 $T_{i}$ 表示第 $i$ 个菌落发生突变的时间，建模为 $T_{i} \\sim \\text{Exponential}(\\lambda)$，并且对于 $i=1,\\dots,n$ 是相互独立的。对于一个率参数为 $\\lambda$ 的指数分布，其累积分布函数和生存函数分别为\n$$\nF(t)=P(T_{i}\\le t)=1-\\exp(-\\lambda t), \\qquad S(t)=P(T_{i}>t)=\\exp(-\\lambda t).\n$$\n在检查时间 $c_{i}>0$ 时，定义真实状态指示变量 $Z_{i}=\\mathbf{1}\\{T_{i}\\le c_{i}\\}$。那么\n$$\nP(Z_{i}=1)=F(c_{i})=1-\\exp(-\\lambda c_{i}), \\qquad P(Z_{i}=0)=S(c_{i})=\\exp(-\\lambda c_{i}).\n$$\n诊断测试的假阴性率为 $\\alpha$，假阳性率为 $\\beta$，因此\n$$\nP(y_{i}=1 \\mid Z_{i}=1)=1-\\alpha, \\quad P(y_{i}=0 \\mid Z_{i}=1)=\\alpha, \\quad P(y_{i}=1 \\mid Z_{i}=0)=\\beta, \\quad P(y_{i}=0 \\mid Z_{i}=0)=1-\\beta.\n$$\n对 $Z_{i}$ 进行边缘化，对每个 $i$ 可得，\n$$\nP(y_{i}=1 \\mid \\lambda,c_{i})=(1-\\alpha)\\bigl(1-\\exp(-\\lambda c_{i})\\bigr)+\\beta\\,\\exp(-\\lambda c_{i})\n=(1-\\alpha)+(\\alpha+\\beta-1)\\exp(-\\lambda c_{i}),\n$$\n和\n$$\nP(y_{i}=0 \\mid \\lambda,c_{i})=\\alpha\\bigl(1-\\exp(-\\lambda c_{i})\\bigr)+(1-\\beta)\\exp(-\\lambda c_{i})\n=\\alpha+(1-\\alpha-\\beta)\\exp(-\\lambda c_{i}).\n$$\n假设菌落之间相互独立，给定数据 $\\{(c_{i},y_{i})\\}_{i=1}^{n}$ 时 $\\lambda$ 的似然函数为\n$$\nL(\\lambda)=\\prod_{i=1}^{n}\\left\\{\\left[(1-\\alpha)+(\\alpha+\\beta-1)\\exp(-\\lambda c_{i})\\right]^{y_{i}}\n\\left[\\alpha+(1-\\alpha-\\beta)\\exp(-\\lambda c_{i})\\right]^{1-y_{i}}\\right\\}.\n$$\n取自然对数得到对数似然函数\n$$\n\\ell(\\lambda)=\\sum_{i=1}^{n}\\left[\ny_{i}\\,\\ln\\!\\left((1-\\alpha)+(\\alpha+\\beta-1)\\exp(-\\lambda c_{i})\\right)\n+(1-y_{i})\\,\\ln\\!\\left(\\alpha+(1-\\alpha-\\beta)\\exp(-\\lambda c_{i})\\right)\n\\right].\n$$\n此表达式仅用观测数据 $(c_{i},y_{i})$、样本量 $n$ 以及已知的常数 $\\alpha$ 和 $\\beta$ 表示。", "answer": "$$\\boxed{\\ell(\\lambda)=\\sum_{i=1}^{n}\\left[\ny_{i}\\,\\ln\\!\\left((1-\\alpha)+(\\alpha+\\beta-1)\\exp(-\\lambda c_{i})\\right)\n+(1-y_{i})\\,\\ln\\!\\left(\\alpha+(1-\\alpha-\\beta)\\exp(-\\lambda c_{i})\\right)\n\\right]}$$", "id": "1902717"}]}