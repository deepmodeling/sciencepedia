{"hands_on_practices": [{"introduction": "在深入单因素方差分析（ANOVA）的计算之前，我们必须首先理解其结构基础：自由度。这项练习将引导你计算总自由度、组间自由度和组内自由度，这些是划分方差和为我们的检验统计量确定正确统计分布的基础 [@problem_id:1941973]。", "problem": "一位农业科学家正在研究不同肥料成分对作物产量的影响。该实验涉及六种不同的肥料处理。每种处理方法都应用于10块相同的地块，并记录每块地块的产量。该科学家计划进行单向方差分析（ANOVA），以确定六种肥料处理的平均产量之间是否存在统计学上的显著差异。\n\n作为该分析的第一步，计算方差分析表所需的自由度。确定总自由度、组间（处理）自由度和组内（误差）自由度。\n\n你的最终答案应该是一组三个整数，按特定顺序分别对应（1）总自由度，（2）组间自由度和（3）组内自由度。", "solution": "在单向方差分析中，若有 $k$ 个组，第 $j$ 组有 $n_{j}$ 个观测值，则总观测值为 $N=\\sum_{j=1}^{k} n_{j}$。方差分析将总变异分解为组间（处理）和组内（误差）两部分，相应的自由度满足\n$$\n\\text{df}_{\\text{Total}} = N - 1,\\quad \\text{df}_{\\text{Between}} = k - 1,\\quad \\text{df}_{\\text{Within}} = N - k,\n$$\n并且满足恒等式 $\\text{df}_{\\text{Total}} = \\text{df}_{\\text{Between}} + \\text{df}_{\\text{Within}}$。\n\n在本题中，有 $k=6$ 种处理，每种处理有 $10$ 个地块，因此每个 $n_{j}=10$，故\n$$\nN=\\sum_{j=1}^{6} n_{j} = 6 \\times 10 = 60.\n$$\n因此，\n$$\n\\text{df}_{\\text{Total}} = N - 1 = 60 - 1 = 59,\n$$\n$$\n\\text{df}_{\\text{Between}} = k - 1 = 6 - 1 = 5,\n$$\n$$\n\\text{df}_{\\text{Within}} = N - k = 60 - 6 = 54.\n$$\n等价地，$\\text{df}_{\\text{Within}} = \\sum_{j=1}^{6} (n_{j}-1) = 6 \\times (10 - 1) = 54$，并且检验 $59 = 5 + 54$ 成立。", "answer": "$$\\boxed{\\begin{pmatrix}59  5  54\\end{pmatrix}}$$", "id": "1941973"}, {"introduction": "方差分析的核心思想是将数据中的总变异分解到不同的来源中。这个练习题聚焦于平方和的基本恒等式，即总平方和（SST）等于组间平方和（SSB）与组内平方和（SSW）之和 [@problem_id:1942000]。掌握这种关系是理解方差分析如何将变异归因于处理效应或随机误差的关键。", "problem": "一位农业科学家正在研究四种不同类型的土壤处理方法对一种新型小麦产量的影响。为了比较四个处理组的平均产量，进行了一项单因素方差分析（ANOVA）。对收集到的数据的分析显示，衡量数据总变异的总平方和（SST）为 $100.0$。衡量由不同土壤处理引起的变异的组间平方和（SSB）经计算为 $40.0$。确定组内平方和（SSW）的值，该值代表由随机误差或与土壤处理无关的因素引起的变异。", "solution": "在单因素方差分析中，总变异可加性地分解为组间变异和组内变异。基本恒等式为：\n$$\n\\mathrm{SST}=\\mathrm{SSB}+\\mathrm{SSW}.\n$$\n求解组内平方和可得：\n$$\n\\mathrm{SSW}=\\mathrm{SST}-\\mathrm{SSB}.\n$$\n代入给定值可得：\n$$\n\\mathrm{SSW}=100.0-40.0=60.0.\n$$\n因此，组内平方和为 $60.0$。", "answer": "$$\\boxed{60.0}$$", "id": "1942000"}, {"introduction": "为了巩固我们对 F 统计量的理解，让我们来看一个具有启发性的思想实验。这个问题探讨了一个所有组的样本均值完全相同的特殊情况，这迫使我们直面“组间”变异的含义 [@problem_id:1960676]。通过计算这种情况下的 F 统计量，你将对其如何量化组间均值差异（相对于组内变异）获得更深刻的直觉。", "problem": "一个生物统计学家团队正在进行一项研究，以比较$k$种旨在降低收缩压的新药物制剂的功效。该研究涉及$N$名受试者，他们被随机分配到$k$个治疗组中的一个。设$n_i$为第$i$组的受试者人数，其中$i=1, \\dots, k$。研究的设计使得$k \\ge 2$且每组至少有两名受试者，即对所有的$i$都有$n_i \\ge 2$。\n\n治疗期结束后，测量每位受试者的收缩压降低值。设$y_{ij}$为第$i$组中第$j$位受试者的测量值。第$i$组血压降低值的样本均值记为$\\bar{y}_{i.}$。\n\n在分析初步结果时，该团队观察到一个奇特的结果：所有$k$个组的样本均值降低值完全相同。即$\\bar{y}_{1.} = \\bar{y}_{2.} = \\dots = \\bar{y}_{k.}$。然而，至少有一个组内的测量值不完全相同，这意味着整个数据集中存在非零的样本方差。\n\n该团队决定进行单因素方差分析 (ANOVA) 来正式检验各组均值之间是否存在差异。基于所有样本均值均相同的观察，他们将计算出的F-统计量的数值是多少？", "solution": "在一个有$k$个组、总样本量为$N=\\sum_{i=1}^{k} n_{i}$的单因素方差分析中，定义组均值为$\\bar{y}_{i.}=\\frac{1}{n_{i}}\\sum_{j=1}^{n_{i}} y_{ij}$，总均值为\n$$\n\\bar{y}_{..}=\\frac{1}{N}\\sum_{i=1}^{k}\\sum_{j=1}^{n_{i}} y_{ij}=\\frac{1}{N}\\sum_{i=1}^{k} n_{i}\\bar{y}_{i.}.\n$$\n组间平方和为\n$$\nSS_{\\text{B}}=\\sum_{i=1}^{k} n_{i}\\bigl(\\bar{y}_{i.}-\\bar{y}_{..}\\bigr)^{2}.\n$$\n根据所有样本均值均相同的观察，即$\\bar{y}_{1.}=\\cdots=\\bar{y}_{k.}$，可得对每个$i$都有$\\bar{y}_{i.}=\\bar{y}_{..}$，因此\n$$\nSS_{\\text{B}}=\\sum_{i=1}^{k} n_{i}\\cdot 0^{2}=0.\n$$\n组内平方和为\n$$\nSS_{\\text{W}}=\\sum_{i=1}^{k}\\sum_{j=1}^{n_{i}}\\bigl(y_{ij}-\\bar{y}_{i.}\\bigr)^{2}.\n$$\n由于至少有一个组的测量值不完全相同，所以这个和式中至少有一项是正的，且所有项都是非负的，因此$SS_{\\text{W}}>0$。\n\n均方为\n$$\nMS_{\\text{B}}=\\frac{SS_{\\text{B}}}{k-1}, \\qquad MS_{\\text{W}}=\\frac{SS_{\\text{W}}}{N-k}.\n$$\n因为$k\\ge 2$，分母$k-1>0$，因此$MS_{\\text{B}}=0$。另外，由于每个$n_{i}\\ge 2$且$k\\ge 2$，我们有$N\\ge 2k$，因此$N-k\\ge k\\ge 2$，所以$MS_{\\text{W}}$的分母为正，并且由于$SS_{\\text{W}}>0$，可得$MS_{\\text{W}}>0$。\n\nANOVA F-统计量为\n$$\nF=\\frac{MS_{\\text{B}}}{MS_{\\text{W}}}=\\frac{0}{MS_{\\text{W}}}=0.\n$$\n因此，计算出的F-统计量为零。", "answer": "$$\\boxed{0}$$", "id": "1960676"}]}