{"hands_on_practices": [{"introduction": "在统计学中，一个核心任务是从样本数据中估计总体参数。对于多变量数据，Wishart 分布为样本协方差矩阵提供了一个强大的模型，它的期望值与总体协方差矩阵 $\\Sigma$ 直接相关。这项练习 [@problem_id:1967888] 将这一原理应用于一个具体的生物统计学场景，要求您计算样本数据的期望总变异，从而帮助您巩固抽象理论与实际数据分析之间的联系。", "problem": "一位生物统计学家正在分析一种新发现的兰花物种的表型数据。每个样本记录了四个关键的花部测量值：萼片长度、花瓣宽度、唇瓣长度和蕊柱高度。这些测量值被建模为一个四元随机向量，该向量假定服从一个多元正态分布，其均值向量 $\\mu$ 和总体协方差矩阵 $\\Sigma$ 未知。\n\n收集了一个包含 $n=25$ 株兰花的随机样本。设第 $i$ 株兰花的测量向量表示为 $X_i \\in \\mathbb{R}^4$。样本均值向量计算如下：$\\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i$。\n\n平方和与叉积 (SSCP) 矩阵 $A$ 由公式 $A = \\sum_{i=1}^{n} (X_i - \\bar{X})(X_i - \\bar{X})^T$ 计算得出。在多元统计中，一个标准结论是矩阵 $A$ 服从 Wishart 分布，记作 $A \\sim W_p(k, \\Sigma)$，其中 $p$ 是数据的维度，$k$ 是自由度。\n\n根据对相关物种的广泛先前遗传分析，这四项测量（萼片长度、花瓣宽度、唇瓣长度和蕊柱高度）的总体方差被可靠地估计为分别为 $10 \\text{ mm}^2$、$3 \\text{ mm}^2$、$8 \\text{ mm}^2$ 和 $4 \\text{ mm}^2$。\n\n这位生物统计学家对中心化数据所捕获的总变异的期望值感兴趣。这对应于 SSCP 矩阵 $A$ 的迹的期望值。计算 $A$ 的迹的期望值。请以 $\\text{mm}^2$ 为单位表示您的答案。", "solution": "设 $X_{i} \\in \\mathbb{R}^{4}$ 为独立同分布的 $N_{4}(\\mu,\\Sigma)$ 随机变量，并定义 SSCP 矩阵 $A=\\sum_{i=1}^{n}(X_{i}-\\bar{X})(X_{i}-\\bar{X})^{T}$，其中 $n=25$。一个标准结论是 $A \\sim W_{p}(k, \\Sigma)$，其中 $p=4$ 且 $k=n-1=24$。对于一个 Wishart 随机矩阵 $W \\sim W_{p}(k, \\Sigma)$，其期望满足 $\\mathbb{E}[W]=k\\Sigma$。利用迹的线性和 $\\operatorname{tr}(cM)=c\\,\\operatorname{tr}(M)$，我们有\n$$\n\\mathbb{E}[\\operatorname{tr}(A)]=\\operatorname{tr}(\\mathbb{E}[A])=\\operatorname{tr}(k\\Sigma)=k\\,\\operatorname{tr}(\\Sigma).\n$$\n$\\Sigma$ 的迹等于四项测量的总体方差之和，这些方差给定为 $10$、$3$、$8$ 和 $4$（单位为 $\\text{mm}^{2}$）。因此，\n$$\n\\operatorname{tr}(\\Sigma)=10+3+8+4=25 \\text{ mm}^{2},\n$$\n所以\n$$\n\\mathbb{E}[\\operatorname{tr}(A)]=24 \\times 25=600 \\text{ mm}^{2}.\n$$", "answer": "$$\\boxed{600}$$", "id": "1967888"}, {"introduction": "在理解了整个 Wishart 矩阵的期望之后，一个自然的进阶是探究其各个元素的变异性。这项练习 [@problem_id:1967831] 专注于计算 Wishart 矩阵对角线元素的方差。要解决这个问题，您需要回顾 Wishart 分布的基本构造性定义，即它是由正态分布向量的外积之和构成的。通过这种方式，您可以深化对该分布底层结构及其与更简单、我们熟知的正态分布之间联系的理解。", "problem": "在多元统计领域，Wishart 分布是卡方分布向多维的推广，对于推断协方差矩阵的性质至关重要。\n\n令 $W$ 是一个服从 Wishart 分布的 $p \\times p$ 随机矩阵，记作 $W \\sim W_p(n, \\Sigma)$，其中 $n$ 是自由度，$\\Sigma$ 是一个 $p \\times p$ 的对称正定尺度矩阵。随机矩阵 $W$ 的元素用 $W_{ij}$ 表示，常数尺度矩阵 $\\Sigma$ 的元素用 $\\Sigma_{ij}$ 表示。\n\n根据这些定义，请确定随机矩阵 $W$ 的对角元素 $W_{ii}$ 的方差，记作 $Var(W_{ii})$，其中 $i \\in \\{1, 2, ..., p\\}$。你的最终答案应该是一个用自由度 $n$ 和尺度矩阵相应的对角元素 $\\Sigma_{ii}$ 表示的闭式解析表达式。", "solution": "从 Wishart 分布的构造性定义出发：如果 $X_{1},\\dots,X_{n}$ 独立同分布于 $N_{p}(0,\\Sigma)$，那么\n$$\nW \\equiv \\sum_{t=1}^{n} X_{t} X_{t}^{\\top} \\sim W_{p}(n,\\Sigma).\n$$\n对于固定的索引 $i \\in \\{1,\\dots,p\\}$，$W$ 的 $(i,i)$ 元素是\n$$\nW_{ii}=\\sum_{t=1}^{n} X_{ti}^{2},\n$$\n其中 $X_{ti}$ 表示 $X_{t}$ 的第 $i$ 个分量。由于向量 $X_{t}$ 关于 $t$ 是独立的，因此对于固定的 $i$，随机变量 $X_{ti}^{2}$ 也关于 $t$ 独立。所以，\n$$\n\\operatorname{Var}(W_{ii})=\\operatorname{Var}\\!\\left(\\sum_{t=1}^{n} X_{ti}^{2}\\right)=\\sum_{t=1}^{n} \\operatorname{Var}(X_{ti}^{2})=n\\,\\operatorname{Var}(X_{1i}^{2}).\n$$\n因为 $X_{1i}\\sim N(0,\\Sigma_{ii})$，其二阶矩和四阶矩为\n$$\n\\mathbb{E}[X_{1i}^{2}] = \\Sigma_{ii}, \\qquad \\mathbb{E}[X_{1i}^{4}] = 3\\,\\Sigma_{ii}^{2}.\n$$\n因此，\n$$\n\\operatorname{Var}(X_{1i}^{2})=\\mathbb{E}[X_{1i}^{4}] - \\left(\\mathbb{E}[X_{1i}^{2}]\\right)^{2} = 3\\,\\Sigma_{ii}^{2} - \\Sigma_{ii}^{2} = 2\\,\\Sigma_{ii}^{2}.\n$$\n代回可得\n$$\n\\operatorname{Var}(W_{ii}) = n \\cdot 2\\,\\Sigma_{ii}^{2} = 2 n \\Sigma_{ii}^{2}.\n$$\n这个结果也与 Wishart 分布元素的一般协方差公式 $\\operatorname{Cov}(W_{ij},W_{kl})=n(\\Sigma_{ik}\\Sigma_{jl}+\\Sigma_{il}\\Sigma_{jk})$ 一致，当 $(i,j,k,l)=(i,i,i,i)$ 时，该公式简化为 $2 n \\Sigma_{ii}^{2}$。", "answer": "$$\\boxed{2 n \\Sigma_{ii}^{2}}$$", "id": "1967831"}, {"introduction": "在许多现代统计应用中，尤其是在贝叶斯推断领域，协方差矩阵的逆矩阵（即“精度矩阵”）往往比协方差矩阵本身更受关注。这项练习 [@problem_id:1967861] 要求您推导一个服从 Wishart 分布的随机矩阵其逆矩阵的期望值。这个结果是多变量正态数据贝叶斯模型的基石。完成这个问题不仅能让您熟悉一个关键的公式，还将引导您了解逆 Wishart 分布的概念，这是统计学家工具箱中的一个重要工具。", "problem": "在多元数据的贝叶斯分析中，协方差矩阵的逆矩阵，即精度矩阵，通常起着核心作用。对协方差结构进行建模的一个基本工具是Wishart分布。\n\n考虑一组$n$个独立同分布的随机向量$X_1, X_2, \\dots, X_n$，每个向量都从一个均值向量为零、协方差矩阵为正定矩阵$\\Sigma$的$p$维正态分布中抽取，记为$X_i \\sim N_p(0, \\Sigma)$。散布矩阵定义为$W = \\sum_{i=1}^{n} X_i X_i^T$，它服从自由度为$n$、尺度矩阵为$\\Sigma$的Wishart分布，记为$W \\sim W_p(n, \\Sigma)$。\n\n为使Wishart矩阵$W$以概率一可逆，自由度$n$必须大于或等于维度$p$。为其逆矩阵的期望值存在，需要一个更严格的条件：$n > p+1$。\n\n假设$n > p+1$，计算逆Wishart矩阵的期望值$E[W^{-1}]$。您的答案应为一个以$n$、$p$和尺度矩阵$\\Sigma$表示的闭式解析表达式。", "solution": "设$X_{i} \\sim N_{p}(0,\\Sigma)$为独立同分布，其中$\\Sigma$为正定矩阵。散布矩阵$W=\\sum_{i=1}^{n} X_{i}X_{i}^{T}$服从Wishart分布$W \\sim W_{p}(n,\\Sigma)$，其在$p \\times p$对称正定矩阵锥上的密度为\n$$\nf_{W}(W)=\\frac{1}{2^{np/2}|\\Sigma|^{n/2}\\Gamma_{p}\\!\\left(\\frac{n}{2}\\right)}\\,|W|^{(n-p-1)/2}\\exp\\!\\left(-\\frac{1}{2}\\operatorname{tr}(\\Sigma^{-1}W)\\right),\n$$\n其中$\\Gamma_{p}(\\cdot)$是多元伽马函数，且$n \\geq p$确保了矩阵以概率一可逆。\n\n定义矩阵求逆变换$S=W^{-1}$。在对称锥上，矩阵求逆的雅可比行列式为\n$$\ndW=|S|^{-(p+1)}\\,dS.\n$$\n将$W=S^{-1}$代入$f_{W}(W)$，得到$S$的密度：\n$$\nf_{S}(S)=\\frac{|\\Sigma|^{-n/2}}{2^{np/2}\\Gamma_{p}\\!\\left(\\frac{n}{2}\\right)}\\,|S^{-1}|^{(n-p-1)/2}\\exp\\!\\left(-\\frac{1}{2}\\operatorname{tr}(\\Sigma^{-1}S^{-1})\\right)\\,|S|^{-(p+1)}.\n$$\n使用$|S^{-1}|=|S|^{-1}$，上式可简化为\n$$\nf_{S}(S)=\\frac{|\\Sigma|^{-n/2}}{2^{np/2}\\Gamma_{p}\\!\\left(\\frac{n}{2}\\right)}\\,|S|^{-(n+p+1)/2}\\exp\\!\\left(-\\frac{1}{2}\\operatorname{tr}(\\Sigma^{-1}S^{-1})\\right).\n$$\n这就是自由度为$n$、尺度矩阵为$\\Sigma^{-1}$的逆Wishart分布的密度，记为$S \\sim IW_{p}(n,\\Sigma^{-1})$。\n\n逆Wishart分布的一个标准矩公式表明，如果$S \\sim IW_{p}(\\nu,\\Psi)$且$\\nu>p+1$，则\n$$\nE[S]=\\frac{\\Psi}{\\nu-p-1}.\n$$\n该结果通过使用逆Wishart分布的归一化常数和矩阵变量伽马函数计算一阶矩积分得出，而该积分的有限性恰好在所述条件$\\nu>p+1$下成立。\n\n将$\\nu=n$和$\\Psi=\\Sigma^{-1}$应用于此公式，对于$n>p+1$的情况，可得\n$$\nE[W^{-1}]=E[S]=\\frac{\\Sigma^{-1}}{n-p-1}.\n$$\n这就是所求的以$n$、$p$和$\\Sigma$表示的闭式表达式。", "answer": "$$\\boxed{\\frac{1}{n - p - 1}\\,\\Sigma^{-1}}$$", "id": "1967861"}]}