{"hands_on_practices": [{"introduction": "多元正态分布的一个最基本且强大的性质是，其分量的线性组合仍然服从正态分布。这个练习将带你应用这一核心原理，通过一个流行病学研究的实际场景，计算脉压（收缩压与舒张压之差）的概率分布。掌握这个技巧可以帮助你分析和理解许多领域中由多个相关变量派生出的新指标 [@problem_id:1939198]。", "problem": "在一项大规模流行病学研究中，个体收缩压 (SBP) 和舒张压 (DBP) 之间的关系采用二元正态分布模型。设随机变量 $X$ 代表收缩压，随机变量 $Y$ 代表舒张压，两者均以毫米汞柱 (mmHg) 为单位。对于一个特定人群，该分布的参数如下：\n\n- 平均收缩压为 $\\mu_X = 125$ mmHg。\n- 平均舒张压为 $\\mu_Y = 80$ mmHg。\n- 收缩压的标准差为 $\\sigma_X = 15$ mmHg。\n- 舒张压的标准差为 $\\sigma_Y = 10$ mmHg。\n- 收缩压和舒张压之间的相关系数为 $\\rho = 0.6$。\n\n心血管健康的一个关键临床指标是脉压，其定义为收缩压与舒张压之差。对于从该人群中随机抽取的一名个体，计算其脉压大于 55 mmHg 的概率。将您的最终答案表示为小数，并四舍五入到四位有效数字。", "solution": "设 $X$ 和 $Y$ 服从联合正态分布，其均值分别为 $\\mu_{X}$ 和 $\\mu_{Y}$，标准差分别为 $\\sigma_{X}$ 和 $\\sigma_{Y}$，相关系数为 $\\rho$。对于任意线性组合 $Z = aX + bY$，$Z$ 服从正态分布，其\n$$\n\\mu_{Z} = a\\mu_{X} + b\\mu_{Y}, \\quad \\sigma_{Z}^{2} = a^{2}\\sigma_{X}^{2} + b^{2}\\sigma_{Y}^{2} + 2ab\\,\\rho\\,\\sigma_{X}\\sigma_{Y}.\n$$\n将脉压定义为 $Z = X - Y$（因此 $a=1$, $b=-1$）。那么\n$$\n\\mu_{Z} = \\mu_{X} - \\mu_{Y}, \\quad \\sigma_{Z}^{2} = \\sigma_{X}^{2} + \\sigma_{Y}^{2} - 2\\rho\\,\\sigma_{X}\\sigma_{Y}.\n$$\n代入给定参数，\n$$\n\\mu_{Z} = 125 - 80 = 45, \\quad \\sigma_{Z}^{2} = 15^{2} + 10^{2} - 2(0.6)(15)(10) = 225 + 100 - 180 = 145.\n$$\n因此 $Z \\sim \\mathcal{N}(45, 145)$。我们所求的概率为\n$$\n\\mathbb{P}(Z > 55) = \\mathbb{P}\\!\\left(\\frac{Z - \\mu_{Z}}{\\sigma_{Z}} > \\frac{55 - 45}{\\sqrt{145}}\\right) = 1 - \\Phi\\!\\left(\\frac{10}{\\sqrt{145}}\\right),\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。数值上，$\\frac{10}{\\sqrt{145}} \\approx 0.8304548$，得出\n$$\n\\mathbb{P}(Z > 55) \\approx 1 - \\Phi(0.8304548) \\approx 0.2031,\n$$\n四舍五入至四位有效数字。", "answer": "$$\\boxed{0.2031}$$", "id": "1939198"}, {"introduction": "在处理多元数据时，变量之间的相关性常常使分析变得复杂。一个关键技术是通过线性变换将相关的变量转化为不相关（在正态分布下即为独立）的变量。这个练习 [@problem_id:1320485] 让你亲手找到实现这种“去相关”的变换，这一思想是许多高级统计方法（如主成分分析 PCA）的基石。", "problem": "在一个信号处理应用中，两个含噪声的电子信号 $X$ 和 $Y$ 被建模为均值为零的联合正态随机变量。测得信号 $X$ 的方差为 $\\text{Var}(X) = 16.0 \\text{ V}^2$，信号 $Y$ 的方差为 $\\text{Var}(Y) = 9.0 \\text{ V}^2$。这两个信号之间的相关系数为 $\\rho_{XY} = 0.60$。\n\n为了生成一对用于后续处理的去相关信号，通过以下线性变换生成了两个新信号 $U$ 和 $V$：\n$$U = X + aY$$\n$$V = X - aY$$\n其中 $a$ 是一个无量纲的实数常数。\n\n确定常数 $a$ 的正值，使得信号 $U$ 和 $V$ 统计独立。请将您的答案表示为最简分数形式。", "solution": "题目说明信号 $X$ 和 $Y$ 是联合正态随机变量。多元正态分布的一个关键性质是，联合正态向量的任何线性变换其结果仍然是联合正态向量。在这里，向量 $(U, V)$ 是向量 $(X, Y)$ 的一个线性变换：\n$$\n\\begin{pmatrix} U \\\\ V \\end{pmatrix} = \\begin{pmatrix} 1 & a \\\\ 1 & -a \\end{pmatrix} \\begin{pmatrix} X \\\\ Y \\end{pmatrix}\n$$\n因此，$U$ 和 $V$ 也是联合正态随机变量。\n\n联合正态变量的另一个基本性质是，它们统计独立当且仅当它们的协方差为零。我们的目标是找到使 $U$ 和 $V$ 独立的值 $a$，这等价于找到使 $\\text{Cov}(U, V) = 0$ 的 $a$。\n\n我们可以利用协方差算子的性质来计算 $U$ 和 $V$ 的协方差。具体来说，对于随机变量 $W_1, W_2, W_3, W_4$ 和常数 $c_1, c_2$，协方差是双线性的：$\\text{Cov}(c_1 W_1 + c_2 W_2, W_3) = c_1 \\text{Cov}(W_1, W_3) + c_2 \\text{Cov}(W_2, W_3)$。\n\n让我们展开 $\\text{Cov}(U, V)$ 的表达式：\n$$\n\\text{Cov}(U, V) = \\text{Cov}(X + aY, X - aY)\n$$\n利用协方差的双线性性质，我们可以将此表达式展开为：\n$$\n\\text{Cov}(U, V) = \\text{Cov}(X, X - aY) + \\text{Cov}(aY, X - aY)\n$$\n$$\n\\text{Cov}(U, V) = \\text{Cov}(X, X) - \\text{Cov}(X, aY) + \\text{Cov}(aY, X) - \\text{Cov}(aY, aY)\n$$\n现在，我们使用性质 $\\text{Cov}(c_1 W_1, c_2 W_2) = c_1 c_2 \\text{Cov}(W_1, W_2)$ 和定义 $\\text{Var}(W) = \\text{Cov}(W, W)$：\n$$\n\\text{Cov}(U, V) = \\text{Var}(X) - a\\text{Cov}(X, Y) + a\\text{Cov}(Y, X) - a^2\\text{Var}(Y)\n$$\n由于协方差是对称的，即 $\\text{Cov}(X, Y) = \\text{Cov}(Y, X)$，所以中间的两项相互抵消：\n$$\n\\text{Cov}(U, V) = \\text{Var}(X) - a\\text{Cov}(X, Y) + a\\text{Cov}(X, Y) - a^2\\text{Var}(Y)\n$$\n$$\n\\text{Cov}(U, V) = \\text{Var}(X) - a^2\\text{Var}(Y)\n$$\n一个重要的观察是，$\\text{Cov}(U, V)$ 的这个表达式不依赖于 $\\text{Cov}(X, Y)$，因此也不依赖于相关系数 $\\rho_{XY}$。对于这个特定的变换，给定的值 $\\rho_{XY} = 0.60$ 是无关信息。\n\n为了实现独立性，我们将协方差设为零：\n$$\n\\text{Var}(X) - a^2\\text{Var}(Y) = 0\n$$\n现在我们可以求解 $a^2$：\n$$\na^2 = \\frac{\\text{Var}(X)}{\\text{Var}(Y)}\n$$\n问题给出了方差的值：$\\text{Var}(X) = 16.0 \\text{ V}^2$ 和 $\\text{Var}(Y) = 9.0 \\text{ V}^2$。将这些值代入方程中：\n$$\na^2 = \\frac{16.0}{9.0} = \\frac{16}{9}\n$$\n对两边取平方根，得到 $a$ 的两个可能值：\n$$\na = \\pm\\sqrt{\\frac{16}{9}} = \\pm\\frac{4}{3}\n$$\n问题要求的是 $a$ 的正值。因此，所需的常数是：\n$$\na = \\frac{4}{3}\n$$", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "1320485"}, {"introduction": "理论的理解最终要通过实践来检验，而生成符合特定分布的随机数据是统计模拟中的一项基本功。本练习 [@problem_id:1939256] 将指导你完成一个标准流程：如何利用协方差矩阵的 Cholesky 分解，从独立的标准正态随机数出发，生成一个服从指定多元正态分布的随机观测向量。这个过程直观地展示了多元正态分布的构造性定义。", "problem": "在一次机械臂定位的仿真中，其末端点坐标 $(x, y)$ 的误差被建模为一个随机向量 $\\boldsymbol{X} = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$，该向量服从二元正态分布。该分布的均值向量 $\\boldsymbol{\\mu}$ 和协方差矩阵 $\\boldsymbol{\\Sigma}$ 如下：\n$$\n\\boldsymbol{\\mu} = \\begin{pmatrix} 5 \\\\ -2 \\end{pmatrix}, \\quad \\boldsymbol{\\Sigma} = \\begin{pmatrix} 4 & 1.2 \\\\ 1.2 & 9 \\end{pmatrix}\n$$\n为生成这些误差的单个随机观测值，我们从一对独立的标准正态离差开始，这些离差是从标准正态分布 $N(0, 1)$ 中抽取的随机值。假设在某一次特定的仿真运行中，标准正态离差由向量 $\\boldsymbol{Z} = \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix} = \\begin{pmatrix} 0.5 \\\\ -1.5 \\end{pmatrix}$ 给出。\n\n你的任务是变换这个标准正态离差向量 $\\boldsymbol{Z}$，以从指定的二元正态分布 $N(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$ 生成相应的随机观测向量 $\\boldsymbol{X}$。\n\n计算向量 $\\boldsymbol{X}$ 的分量，并以包含两个分量 $(x, y)$ 的行矩阵形式提供你的答案，结果保留三位有效数字。", "solution": "对于一个多元正态向量，可以通过仿射变换\n$$\n\\boldsymbol{X}=\\boldsymbol{\\mu}+A\\boldsymbol{Z},\n$$\n从 $\\boldsymbol{Z} \\sim N(\\boldsymbol{0}, \\boldsymbol{I})$ 生成 $X \\sim N(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$，其中 $A$ 满足 $A A^{\\mathsf{T}}=\\boldsymbol{\\Sigma}$。一个方便的选择是 Cholesky 因子 $L$，它是一个满足 $\\boldsymbol{\\Sigma}=L L^{\\mathsf{T}}$ 的下三角矩阵。\n\n令\n$$\n\\boldsymbol{\\mu}=\\begin{pmatrix}5\\\\-2\\end{pmatrix},\\quad\n\\boldsymbol{\\Sigma}=\\begin{pmatrix}4 & \\frac{6}{5}\\\\ \\frac{6}{5} & 9\\end{pmatrix},\\quad\n\\boldsymbol{Z}=\\begin{pmatrix}\\frac{1}{2}\\\\ -\\frac{3}{2}\\end{pmatrix}.\n$$\n通过求解 $L L^{\\mathsf{T}}=\\boldsymbol{\\Sigma}$ 来计算 Cholesky 因子 $L=\\begin{pmatrix}l_{11} & 0\\\\ l_{21} & l_{22}\\end{pmatrix}$：\n- 从 $l_{11}^{2}=4$ 可得 $l_{11}=2$。\n- 从 $l_{11}l_{21}=\\frac{6}{5}$ 可得 $l_{21}=\\frac{6}{5}\\cdot\\frac{1}{2}=\\frac{3}{5}$。\n- 从 $l_{21}^{2}+l_{22}^{2}=9$ 可得 $l_{22}^{2}=9-\\left(\\frac{3}{5}\\right)^{2}=9-\\frac{9}{25}=\\frac{216}{25}$，因此 $l_{22}=\\frac{6\\sqrt{6}}{5}$。\n\n因此\n$$\nL=\\begin{pmatrix}2 & 0\\\\ \\frac{3}{5} & \\frac{6\\sqrt{6}}{5}\\end{pmatrix}.\n$$\n计算 $L\\boldsymbol{Z}$：\n$$\nL\\boldsymbol{Z}=\n\\begin{pmatrix}\n2 & 0\\\\\n\\frac{3}{5} & \\frac{6\\sqrt{6}}{5}\n\\end{pmatrix}\n\\begin{pmatrix}\\frac{1}{2}\\\\-\\frac{3}{2}\\end{pmatrix}\n=\n\\begin{pmatrix}\n2\\cdot\\frac{1}{2}+0\\cdot\\left(-\\frac{3}{2}\\right)\\\\\n\\frac{3}{5}\\cdot\\frac{1}{2}+\\frac{6\\sqrt{6}}{5}\\cdot\\left(-\\frac{3}{2}\\right)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1\\\\\n\\frac{3}{10}-\\frac{9}{5}\\sqrt{6}\n\\end{pmatrix}.\n$$\n所以，\n$$\n\\boldsymbol{X}=\\boldsymbol{\\mu}+L\\boldsymbol{Z}\n=\n\\begin{pmatrix}\n5\\\\-2\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n1\\\\\n\\frac{3}{10}-\\frac{9}{5}\\sqrt{6}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n6\\\\-\\frac{17}{10}-\\frac{9}{5}\\sqrt{6}\n\\end{pmatrix}.\n$$\n数值上，$\\sqrt{6}\\approx 2.449489743$，所以\n$$\nx\\approx 6,\\qquad y\\approx -6.1090815374.\n$$\n将每个分量保留三位有效数字，得到\n$$\nx\\approx 6.00,\\qquad y\\approx -6.11.\n$$\n因此所求的行矩阵是 $\\begin{pmatrix}6.00 & -6.11\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix}6.00 & -6.11\\end{pmatrix}}$$", "id": "1939256"}]}