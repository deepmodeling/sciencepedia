{"hands_on_practices": [{"introduction": "理解一个统计检验的最好方法就是亲自动手计算。这个练习将引导你完成 Levene 检验的详细计算步骤，具体来说，是基于中位数的稳健版本（也称为 Brown-Forsythe 检验）。通过一个农业领域的直观例子，你将掌握检验统计量 $W$ 的核心计算方法，为后续更复杂的应用打下坚实的基础。[@problem_id:1930187]", "problem": "一位园艺师正在研究三种不同灌溉技术下葡萄糖分含量的一致性。对于每种技术，记录了若干葡萄样本的糖分含量，单位为白利糖度（degrees Brix）。数据如下：\n\n*   **技术1（滴灌）：** 20.1, 20.4, 20.0, 20.7, 20.3\n*   **技术2（喷灌）：** 21.5, 20.5, 22.0, 21.0, 21.2\n*   **技术3（沟灌）：** 19.0, 22.5, 20.0, 21.5, 18.0\n\n为了评估糖分含量的一致性，提出了一种特定的统计检验。该检验统计量记为 $W$，是根据测量值与其各自组中位数的绝对偏差计算得出的。设 $Y_{ij}$ 为第 $i$ 组的第 $j$ 个测量值，$\\tilde{Y}_i$ 为第 $i$ 组的中位数。绝对偏差定义为 $Z_{ij} = |Y_{ij} - \\tilde{Y}_i|$。\n\n检验统计量 $W$ 由以下公式给出：\n$$ W = \\frac{N-k}{k-1} \\cdot \\frac{\\sum_{i=1}^{k} n_i (\\bar{Z}_{i\\cdot} - \\bar{Z}_{\\cdot\\cdot})^{2}}{\\sum_{i=1}^{k} \\sum_{j=1}^{n_i} (Z_{ij} - \\bar{Z}_{i\\cdot})^{2}} $$\n其中 $k$ 是组数，$n_i$ 是第 $i$ 组的样本量，$N$ 是总样本数，$\\bar{Z}_{i\\cdot}$ 是第 $i$ 组绝对偏差的均值，$\\bar{Z}_{\\cdot\\cdot}$ 是所有绝对偏差的总均值。\n\n计算检验统计量 $W$ 的值。将您的最终答案四舍五入到四位有效数字。", "solution": "我们有三个组，其中 $k=3$ 且 $n_{1}=n_{2}=n_{3}=5$，因此 $N=15$。对于每组，计算组中位数 $\\tilde{Y}_{i}$、绝对偏差 $Z_{ij}=|Y_{ij}-\\tilde{Y}_{i}|$、组均值 $\\bar{Z}_{i\\cdot}$ 和总均值 $\\bar{Z}_{\\cdot\\cdot}$。\n\n第1组 (20.1, 20.4, 20.0, 20.7, 20.3)：排序后得到中位数 $\\tilde{Y}_{1}=20.3$。则 $Z_{1j}\\in\\{0.2,0.1,0.3,0.4,0.0\\}$，因此 $\\sum_{j}Z_{1j}=1$ 且 $\\bar{Z}_{1\\cdot}=\\frac{1}{5}=0.2$。\n\n第2组 (21.5, 20.5, 22.0, 21.0, 21.2)：排序后得到中位数 $\\tilde{Y}_{2}=21.2$。则 $Z_{2j}\\in\\{0.3,0.7,0.8,0.2,0.0\\}$，因此 $\\sum_{j}Z_{2j}=2$ 且 $\\bar{Z}_{2\\cdot}=\\frac{2}{5}=0.4$。\n\n第3组 (19.0, 22.5, 20.0, 21.5, 18.0)：排序后得到中位数 $\\tilde{Y}_{3}=20.0$。则 $Z_{3j}\\in\\{1.0,2.5,0.0,1.5,2.0\\}$，因此 $\\sum_{j}Z_{3j}=7$ 且 $\\bar{Z}_{3\\cdot}=\\frac{7}{5}=1.4$。\n\n所有绝对偏差的总均值为\n$$\n\\bar{Z}_{\\cdot\\cdot}=\\frac{\\sum_{i=1}^{3}\\sum_{j=1}^{5}Z_{ij}}{15}=\\frac{1+2+7}{15}=\\frac{10}{15}=\\frac{2}{3}.\n$$\n\n计算分子中的和：\n$$\n\\sum_{i=1}^{3}n_{i}\\left(\\bar{Z}_{i\\cdot}-\\bar{Z}_{\\cdot\\cdot}\\right)^{2}\n=5\\left[\\left(\\frac{1}{5}-\\frac{2}{3}\\right)^{2}+\\left(\\frac{2}{5}-\\frac{2}{3}\\right)^{2}+\\left(\\frac{7}{5}-\\frac{2}{3}\\right)^{2}\\right]\n=5\\left[\\left(-\\frac{7}{15}\\right)^{2}+\\left(-\\frac{4}{15}\\right)^{2}+\\left(\\frac{11}{15}\\right)^{2}\\right]\n$$\n$$\n=5\\left(\\frac{49}{225}+\\frac{16}{225}+\\frac{121}{225}\\right)\n=5\\cdot\\frac{186}{225}\n=\\frac{62}{15}.\n$$\n\n计算分母中的组内和：\n- 第1组：$\\sum_{j=1}^{5}(Z_{1j}-\\bar{Z}_{1\\cdot})^{2}=\\frac{1}{10}$。\n- 第2组：$\\sum_{j=1}^{5}(Z_{2j}-\\bar{Z}_{2\\cdot})^{2}=\\frac{23}{50}$。\n- 第3组：$\\sum_{j=1}^{5}(Z_{3j}-\\bar{Z}_{3\\cdot})^{2}=\\frac{37}{10}$。\n\n因此，\n$$\n\\sum_{i=1}^{3}\\sum_{j=1}^{5}(Z_{ij}-\\bar{Z}_{i\\cdot})^{2}\n=\\frac{1}{10}+\\frac{23}{50}+\\frac{37}{10}\n=\\frac{213}{50}.\n$$\n\n现在计算\n$$\nW=\\frac{N-k}{k-1}\\cdot\\frac{\\sum_{i=1}^{k}n_{i}(\\bar{Z}_{i\\cdot}-\\bar{Z}_{\\cdot\\cdot})^{2}}{\\sum_{i=1}^{k}\\sum_{j=1}^{n_{i}}(Z_{ij}-\\bar{Z}_{i\\cdot})^{2}}\n=\\frac{15-3}{3-1}\\cdot\\frac{\\frac{62}{15}}{\\frac{213}{50}}\n=6\\cdot\\frac{62}{15}\\cdot\\frac{50}{213}\n=\\frac{1240}{213}\\approx 5.8216.\n$$\n\n四舍五入到四位有效数字，得到 $W=5.822$。", "answer": "$$\\boxed{5.822}$$", "id": "1930187"}, {"introduction": "Levene 检验的应用远不止比较原始数据组的方差。本练习展示了它在更复杂的统计分析中的威力，例如评估不同统计估计量的稳定性。通过比较自助法（bootstrap）样本均值和样本中位数的方差，我们可以判断在处理偏态分布数据时哪种中心趋势估计量更可靠，这突显了 Levene 检验在模型评估和比较中的实用价值。[@problem_id:1930137]", "problem": "一位统计学家有兴趣比较从一个右偏分布中抽样时，两种不同集中趋势估计量——样本均值和样本中位数——的稳定性。为此，他们进行了一项自助法分析。他们从一个初始的小样本中生成了大量的自助法重抽样样本。对于每个重抽样样本，他们都计算了样本均值和样本中位数。\n\n这个过程产生了两个数据集：一个包含均值的自助法估计值，另一个包含中位数的自助法估计值。估计量的稳定性与其抽样分布的方差成反比；方差越小，意味着估计量越稳定。该统计学家想要检验这两组自助法估计值的方差是否相等。\n\n现给出 10 个自助法重抽样样本的结果：\n\n集合 M (自助法样本均值)：\n$\\{10.1, 14.5, 9.8, 15.2, 11.0, 13.8, 16.1, 8.9, 12.5, 13.1\\}$\n\n集合 E (自助法样本中位数)：\n$\\{7.0, 4.0, 7.0, 6.0, 4.0, 7.0, 5.0, 7.0, 4.0, 5.0\\}$\n\n为了检验从这两个集合抽取的总体的方差相等的原假设，请计算 Levene 检验统计量 $W$。使用该检验的稳健版本，即使用组中位数对每组数据进行中心化（这也称为 Brown-Forsythe 检验）。\n\n计算检验统计量 $W$ 的值，并将您的最终答案四舍五入至三位有效数字。", "solution": "我们有两个组：样本均值 (M) 和样本中位数 (E)。设组数 $k=2$，总观测数 $N=20$。Brown–Forsythe（以中位数为中心的 Levene）检验使用 $z_{ij}=|y_{ij}-\\tilde{y}_{i}|$，其中 $\\tilde{y}_{i}$ 是第 $i$ 组的中位数。检验统计量是对 $z_{ij}$ 进行的单因素方差分析的 $F$ 统计量：\n$$\nW=\\frac{N-k}{k-1}\\cdot \\frac{\\sum_{i=1}^{k} n_{i}\\left(\\bar{z}_{i\\cdot}-\\bar{z}_{\\cdot\\cdot}\\right)^{2}}{\\sum_{i=1}^{k}\\sum_{j=1}^{n_{i}}\\left(z_{ij}-\\bar{z}_{i\\cdot}\\right)^{2}}.\n$$\n\nM 组：数据 $\\{10.1, 14.5, 9.8, 15.2, 11.0, 13.8, 16.1, 8.9, 12.5, 13.1\\}$。\n排序后为：$8.9,9.8,10.1,11.0,12.5,13.1,13.8,14.5,15.2,16.1$，所以中位数为\n$$\n\\tilde{y}_{M}=\\frac{12.5+13.1}{2}=12.8.\n$$\n因此 $z_{Mj}=|y_{Mj}-12.8|$ 给出\n$$\n\\{2.7,1.7,3.0,2.4,1.8,1.0,3.3,3.9,0.3,0.3\\}.\n$$\n它们的均值为\n$$\n\\bar{z}_{M\\cdot}=\\frac{2.7+1.7+3.0+2.4+1.8+1.0+3.3+3.9+0.3+0.3}{10}=\\frac{20.4}{10}=2.04.\n$$\n\nE 组：数据 $\\{7.0,4.0,7.0,6.0,4.0,7.0,5.0,7.0,4.0,5.0\\}$。\n排序后为：$4.0,4.0,4.0,5.0,5.0,6.0,7.0,7.0,7.0,7.0$，所以中位数为\n$$\n\\tilde{y}_{E}=\\frac{5.0+6.0}{2}=5.5.\n$$\n因此 $z_{Ej}=|y_{Ej}-5.5|$ 给出\n$$\n\\{1.5,1.5,1.5,0.5,1.5,1.5,0.5,1.5,1.5,0.5\\}.\n$$\n它们的均值为\n$$\n\\bar{z}_{E\\cdot}=\\frac{7\\cdot 1.5+3\\cdot 0.5}{10}=\\frac{10.5+1.5}{10}=\\frac{12.0}{10}=1.2.\n$$\n\n所有 $z$ 值的总均值为\n$$\n\\bar{z}_{\\cdot\\cdot}=\\frac{10\\cdot 2.04+10\\cdot 1.2}{20}=\\frac{20.4+12.0}{20}=1.62.\n$$\n\n计算 $z$ 值的组间平方和：\n$$\nSS_{\\text{between}}=\\sum_{i=1}^{2} n_{i}\\left(\\bar{z}_{i\\cdot}-\\bar{z}_{\\cdot\\cdot}\\right)^{2}\n=10(2.04-1.62)^{2}+10(1.2-1.62)^{2}\n=10(0.42)^{2}+10(-0.42)^{2}\n=1.764+1.764=3.528.\n$$\n\n计算 $z$ 值的组内平方和：\n- 对于 M 组，使用 $SS=\\sum z^{2}-n\\bar{z}^{2}$，\n$$\n\\sum z_{Mj}^{2}=2.7^{2}+1.7^{2}+3.0^{2}+2.4^{2}+1.8^{2}+1.0^{2}+3.3^{2}+3.9^{2}+0.3^{2}+0.3^{2}=55.46,\n$$\n所以\n$$\nSS_{M}=55.46-10\\cdot(2.04)^{2}=55.46-41.616=13.844.\n$$\n- 对于 E 组，\n$$\n\\sum z_{Ej}^{2}=7\\cdot(1.5)^{2}+3\\cdot(0.5)^{2}=7\\cdot 2.25+3\\cdot 0.25=15.75+0.75=16.5,\n$$\n所以\n$$\nSS_{E}=16.5-10\\cdot(1.2)^{2}=16.5-14.4=2.1.\n$$\n因此\n$$\nSS_{\\text{within}}=SS_{M}+SS_{E}=13.844+2.1=15.944.\n$$\n\n最后，当 $k=2$ 且 $N=20$ 时，\n$$\nW=\\frac{N-k}{k-1}\\cdot \\frac{SS_{\\text{between}}}{SS_{\\text{within}}}\n=\\frac{18}{1}\\cdot \\frac{3.528}{15.944}\n=18\\cdot \\frac{441}{1993}\n=\\frac{7938}{1993}\\approx 3.98294.\n$$\n四舍五入到三位有效数字，得到 $W=3.98$。", "answer": "$$\\boxed{3.98}$$", "id": "1930137"}, {"introduction": "标准的 Levene 检验依赖于一个重要假设，即绝对离差值近似服从正态分布，以便使用 $F$ 分布进行推断。当样本量较小或数据分布未知时，这个假设可能不成立。本练习介绍了一种强大的替代方法——置换检验（permutation test），它利用 Levene 统计量但无需分布假设。通过这个练习，你将学会如何解释置换检验的结果，并理解这种现代计算密集型方法在假设检验中的优势。[@problem_id:1930139]", "problem": "一位材料科学家正在比较两种不同制造工艺生产特定聚合物纤维的一致性。工艺A和工艺B被用于生产多批次纤维，并测量了从每种工艺中抽取的一批纤维样本的拉伸强度（单位：兆帕，MPa）。这位科学家想要检验两种工艺在拉伸强度上方差相等的原假设，$H_0: \\sigma_A^2 = \\sigma_B^2$。然而，由于样本量较小，并且怀疑数据可能不服从正态分布，她决定不使用标准的F检验。她选择了基于Levene型统计量的置换检验，这种方法更为稳健。\n\n收集到的拉伸强度数据如下：\n- **工艺A:** $\\{10, 12, 15, 18\\}$\n- **工艺B:** $\\{20, 21, 23, 24, 30, 32\\}$\n\n该检验的步骤如下：\n1.  对每个组 $g \\in \\{A, B\\}$，计算组中位数 $\\tilde{y}_g$。\n2.  通过计算每个数据点 $y_{gi}$ 与其组中位数 $\\tilde{y}_g$ 的绝对偏差，将原始数据点转换为一组新数据 $z_{gi}$：$z_{gi} = |y_{gi} - \\tilde{y}_g|$。\n3.  计算检验统计量 $T$，其定义为这些变换后的 $z$ 值的组间平方和。对于两个组，$T$ 的计算公式为：\n    $$T = n_A(\\bar{z}_A - \\bar{z})^2 + n_B(\\bar{z}_B - \\bar{z})^2$$\n    其中 $n_A$ 和 $n_B$ 是样本量，$\\bar{z}_A$ 和 $\\bar{z}_B$ 是每组变换后数据的均值，而 $\\bar{z}$ 是所有变换后数据点合并后的总均值。\n\n为了确定观测到的检验统计量 $T_{obs}$ 的显著性，需要生成一个置换分布。这包括合并所有计算出的 $z_{gi}$ 值，然后以所有可能的方式将它们重复划分为大小为 $n_A$ 和 $n_B$ 的新组，并为每个划分重新计算统计量 $T$。唯一划分的总数构成了完整的置换分布。\n\n通过对这个完整置换分布的分析发现，共有18个置换检验统计量严格大于从原始未打乱数据中观测到的统计量 ($T_{obs}$)。此外，由于数据中存在相同值，恰好有一个其他置换产生的检验统计量与 $T_{obs}$ 完全相同。\n\n计算置换检验的p值，即在完整置换分布（包括原始数据得出的统计量）中，大于或等于 $T_{obs}$ 的检验统计量的比例。将最终答案四舍五入到四位有效数字。", "solution": "我们的样本量为 $n_{A}=4$ 和 $n_{B}=6$，因此合并后的变换观测值总数为 $n=n_{A}+n_{B}=10$。\n\n在置换检验下，零分布是通过以所有可能的方式将 $n$ 个合并的 $z$ 值分配到大小为 $n_{A}$ 和 $n_{B}$ 的组中来生成的。这种分配方式（包括原始分配）的总数为\n$$\nN=\\binom{n}{n_{A}}=\\binom{10}{4}=210.\n$$\n\n设 $b$ 为严格大于观测统计量 $T_{obs}$ 的置换检验统计量的数量，设 $e$ 为其统计量等于 $T_{obs}$ 的其他置换的数量。根据题意，$b=18$ 且 $e=1$。原始（未打乱）的配置也产生 $T_{obs}$，因此它对大于或等于 $T_{obs}$ 的统计量计数再加一。\n\n因此，置换检验的p值，定义为在完整置换集（包括原始数据）中大于或等于 $T_{obs}$ 的统计量的比例，为\n$$\np=\\frac{b+e+1}{N}=\\frac{18+1+1}{210}=\\frac{20}{210}=\\frac{2}{21}.\n$$\n数值上，\n$$\n\\frac{2}{21}\\approx 0.095238\\ldots\n$$\n四舍五入到四位有效数字，得到 $0.09524$。", "answer": "$$\\boxed{0.09524}$$", "id": "1930139"}]}