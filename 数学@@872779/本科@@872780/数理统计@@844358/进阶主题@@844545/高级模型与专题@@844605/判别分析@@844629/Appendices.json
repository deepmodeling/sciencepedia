{"hands_on_practices": [{"introduction": "线性判别分析 (LDA) 的一个关键假设是组间的协方差矩阵相等。本练习 [@problem_id:1914041] 演示了应用 LDA 的第一个关键步骤：计算合并协方差矩阵。该矩阵为这个共同的方差提供了一个单一、稳健的估计，是为判别分析准备数据的一项基本技能。", "problem": "一家电子商务公司的数据科学家正在进行一项初步分析，为一个潜在的线性判别分析 (LDA) 模型对客户进行分类。目标是区分两组客户：“高级订阅者”和“标准用户”。针对从每个组中抽取的小型随机样本，测量了两项关键指标：\n- $X_1$：平均会话持续时间（分钟）。\n- $X_2$：上个月购买的商品数量。\n\n数据以二维向量 $\\mathbf{x} = [X_1, X_2]^T$ 的形式收集。\n\n“高级订阅者”组（第1组）的样本由 $n_1=4$ 名客户组成：\n$$ \\mathbf{x}_1^{(1)} = \\begin{pmatrix} 15 \\\\ 8 \\end{pmatrix}, \\quad \\mathbf{x}_2^{(1)} = \\begin{pmatrix} 20 \\\\ 10 \\end{pmatrix}, \\quad \\mathbf{x}_3^{(1)} = \\begin{pmatrix} 18 \\\\ 6 \\end{pmatrix}, \\quad \\mathbf{x}_4^{(1)} = \\begin{pmatrix} 17 \\\\ 8 \\end{pmatrix} $$\n\n“标准用户”组（第2组）的样本由 $n_2=5$ 名客户组成：\n$$ \\mathbf{x}_1^{(2)} = \\begin{pmatrix} 8 \\\\ 2 \\end{pmatrix}, \\quad \\mathbf{x}_2^{(2)} = \\begin{pmatrix} 12 \\\\ 4 \\end{pmatrix}, \\quad \\mathbf{x}_3^{(2)} = \\begin{pmatrix} 10 \\\\ 3 \\end{pmatrix}, \\quad \\mathbf{x}_4^{(2)} = \\begin{pmatrix} 6 \\\\ 1 \\end{pmatrix}, \\quad \\mathbf{x}_5^{(2)} = \\begin{pmatrix} 9 \\\\ 5 \\end{pmatrix} $$\n\n标准LDA的一个关键假设是不同组的协方差矩阵相等。为了继续分析，数据科学家需要计算这个共同协方差矩阵的单一估计值，即合并样本协方差矩阵 $S_p$。\n\n根据所提供的数据，计算合并样本协方差矩阵 $S_p$。", "solution": "我们通过合并样本协方差矩阵来估计共同协方差\n$$\nS_{p}=\\frac{(n_{1}-1)S_{1}+(n_{2}-1)S_{2}}{n_{1}+n_{2}-2},\n$$\n其中，对于大小为 $n_k$ 的组 $k\\in\\{1,2\\}$，样本协方差为\n$$\nS_{k}=\\frac{1}{n_{k}-1}\\sum_{i=1}^{n_{k}}\\left(\\mathbf{x}_{i}^{(k)}-\\bar{\\mathbf{x}}^{(k)}\\right)\\left(\\mathbf{x}_{i}^{(k)}-\\bar{\\mathbf{x}}^{(k)}\\right)^{T},\n$$\n且 $\\bar{\\mathbf{x}}^{(k)}=\\frac{1}{n_{k}}\\sum_{i=1}^{n_{k}}\\mathbf{x}_{i}^{(k)}$。\n\n首先计算样本均值。\n\n对于第1组 ($n_{1}=4$)：\n$$\n\\bar{\\mathbf{x}}^{(1)}=\\frac{1}{4}\\begin{pmatrix}15+20+18+17\\\\ 8+10+6+8\\end{pmatrix}=\\begin{pmatrix}17.5\\\\ 8\\end{pmatrix}.\n$$\n对于第2组 ($n_{2}=5$)：\n$$\n\\bar{\\mathbf{x}}^{(2)}=\\frac{1}{5}\\begin{pmatrix}8+12+10+6+9\\\\ 2+4+3+1+5\\end{pmatrix}=\\begin{pmatrix}9\\\\ 3\\end{pmatrix}.\n$$\n\n接下来计算 $S_{1}$。令 $\\mathbf{d}_{i}^{(1)}=\\mathbf{x}_{i}^{(1)}-\\bar{\\mathbf{x}}^{(1)}$。\n偏差和外积如下：\n$$\n\\mathbf{d}_{1}^{(1)}=\\begin{pmatrix}-2.5\\\\ 0\\end{pmatrix},\\quad \\mathbf{d}_{1}^{(1)}\\mathbf{d}_{1}^{(1)T}=\\begin{pmatrix}6.25 & 0 \\\\ 0 & 0\\end{pmatrix},\n$$\n$$\n\\mathbf{d}_{2}^{(1)}=\\begin{pmatrix}2.5\\\\ 2\\end{pmatrix},\\quad \\mathbf{d}_{2}^{(1)}\\mathbf{d}_{2}^{(1)T}=\\begin{pmatrix}6.25 & 5 \\\\ 5 & 4\\end{pmatrix},\n$$\n$$\n\\mathbf{d}_{3}^{(1)}=\\begin{pmatrix}0.5\\\\ -2\\end{pmatrix},\\quad \\mathbf{d}_{3}^{(1)}\\mathbf{d}_{3}^{(1)T}=\\begin{pmatrix}0.25 & -1 \\\\ -1 & 4\\end{pmatrix},\n$$\n$$\n\\mathbf{d}_{4}^{(1)}=\\begin{pmatrix}-0.5\\\\ 0\\end{pmatrix},\\quad \\mathbf{d}_{4}^{(1)}\\mathbf{d}_{4}^{(1)T}=\\begin{pmatrix}0.25 & 0 \\\\ 0 & 0\\end{pmatrix}.\n$$\n求和得到\n$$\n\\sum_{i=1}^{4}\\mathbf{d}_{i}^{(1)}\\mathbf{d}_{i}^{(1)T}=\\begin{pmatrix}13 & 4 \\\\ 4 & 8\\end{pmatrix},\n$$\n因此\n$$\nS_{1}=\\frac{1}{n_{1}-1}\\begin{pmatrix}13 & 4 \\\\ 4 & 8\\end{pmatrix}=\\frac{1}{3}\\begin{pmatrix}13 & 4 \\\\ 4 & 8\\end{pmatrix}.\n$$\n\n现在计算 $S_{2}$。令 $\\mathbf{d}_{i}^{(2)}=\\mathbf{x}_{i}^{(2)}-\\bar{\\mathbf{x}}^{(2)}$。\n偏差和外积如下：\n$$\n\\mathbf{d}_{1}^{(2)}=\\begin{pmatrix}-1\\\\ -1\\end{pmatrix},\\ \\ \\mathbf{d}_{1}^{(2)}\\mathbf{d}_{1}^{(2)T}=\\begin{pmatrix}1 & 1 \\\\ 1 & 1\\end{pmatrix},\n$$\n$$\n\\mathbf{d}_{2}^{(2)}=\\begin{pmatrix}3\\\\ 1\\end{pmatrix},\\ \\ \\mathbf{d}_{2}^{(2)}\\mathbf{d}_{2}^{(2)T}=\\begin{pmatrix}9 & 3 \\\\ 3 & 1\\end{pmatrix},\n$$\n$$\n\\mathbf{d}_{3}^{(2)}=\\begin{pmatrix}1\\\\ 0\\end{pmatrix},\\ \\ \\mathbf{d}_{3}^{(2)}\\mathbf{d}_{3}^{(2)T}=\\begin{pmatrix}1 & 0 \\\\ 0 & 0\\end{pmatrix},\n$$\n$$\n\\mathbf{d}_{4}^{(2)}=\\begin{pmatrix}-3\\\\ -2\\end{pmatrix},\\ \\ \\mathbf{d}_{4}^{(2)}\\mathbf{d}_{4}^{(2)T}=\\begin{pmatrix}9 & 6 \\\\ 6 & 4\\end{pmatrix},\n$$\n$$\n\\mathbf{d}_{5}^{(2)}=\\begin{pmatrix}0\\\\ 2\\end{pmatrix},\\ \\ \\mathbf{d}_{5}^{(2)}\\mathbf{d}_{5}^{(2)T}=\\begin{pmatrix}0 & 0 \\\\ 0 & 4\\end{pmatrix}.\n$$\n求和得到\n$$\n\\sum_{i=1}^{5}\\mathbf{d}_{i}^{(2)}\\mathbf{d}_{i}^{(2)T}=\\begin{pmatrix}20 & 10 \\\\ 10 & 10\\end{pmatrix},\n$$\n因此\n$$\nS_{2}=\\frac{1}{n_{2}-1}\\begin{pmatrix}20 & 10 \\\\ 10 & 10\\end{pmatrix}=\\frac{1}{4}\\begin{pmatrix}20 & 10 \\\\ 10 & 10\\end{pmatrix}.\n$$\n\n最后，合并协方差为\n$$\nS_{p}=\\frac{(n_{1}-1)S_{1}+(n_{2}-1)S_{2}}{n_{1}+n_{2}-2}=\\frac{\\begin{pmatrix}13 & 4\\\\ 4 & 8\\end{pmatrix}+\\begin{pmatrix}20 & 10\\\\ 10 & 10\\end{pmatrix}}{7}=\\frac{1}{7}\\begin{pmatrix}33 & 14\\\\ 14 & 18\\end{pmatrix}=\\begin{pmatrix}\\frac{33}{7} & 2\\\\ 2 & \\frac{18}{7}\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{33}{7} & 2 \\\\ 2 & \\frac{18}{7}\\end{pmatrix}}$$", "id": "1914041"}, {"introduction": "在确定模型参数后，下一步是使用它进行分类。本实践 [@problem_id:1914060] 展示了如何通过计算新观测值与每个组中心的马氏距离 (Mahalanobis distance) 来对其进行分类。该方法提供了一种统计上合理的方式，将新数据点分配到“最近”的组，同时考虑了特征的方差和协方差。", "problem": "一个天体物理学家团队正在开发一种自动分类算法，该算法基于两个测量特征来区分两种类型的天体。这两个特征是“大气甲烷浓度指数”($x_1$)和“行星反照率指数”($x_2$)。数据是为两个已确定的组收集的：第1组，由“潜在宜居系外行星”组成；第2组，由“非宜居气态巨行星”组成。\n\n基于大量先前的观测，该团队计算了每组的样本均值向量 $\\bar{\\mathbf{x}}_1$ 和 $\\bar{\\mathbf{x}}_2$，以及一个合并样本协方差矩阵 $\\mathbf{S}_p$。一个天体的特征向量由 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ 给出。\n\n计算出的统计数据如下：\n- 第1组的均值：$\\bar{\\mathbf{x}}_1 = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$\n- 第2组的均值：$\\bar{\\mathbf{x}}_2 = \\begin{pmatrix} 6 \\\\ 5 \\end{pmatrix}$\n- 合并协方差矩阵：$\\mathbf{S}_p = \\begin{pmatrix} 3  1 \\\\ 1  1 \\end{pmatrix}$\n\n一个特征向量为 $\\mathbf{x}_{new} = \\begin{pmatrix} 4 \\\\ 5 \\end{pmatrix}$ 的新的未分类天体被探测到。\n\n您需要将这个新天体分到具有较小平方马氏距离的组中。这个距离，从一个点 $\\mathbf{x}$ 到第 $k$ 组的中心，定义为 $D_k^2(\\mathbf{x}) = (\\mathbf{x} - \\bar{\\mathbf{x}}_k)^T \\mathbf{S}_p^{-1} (\\mathbf{x} - \\bar{\\mathbf{x}}_k)$，其中上标 $T$ 表示转置。假设一个天体属于任一组的先验概率相等。根据这个规则，以下哪个结论是正确的？\n\nA. 该天体应被分类到第1组（潜在宜居系外行星）。\n\nB. 该天体应被分类到第2组（非宜居气态巨行星）。\n\nC. 该天体与两组中心的距离相等，因此分类不明确。\n\nD. 提供的合并协方差矩阵对此类计算无效，使得分类无法进行。", "solution": "我们必须将新天体分配到具有较小平方马氏距离的组中，该距离由 $D_{k}^{2}(\\mathbf{x})=(\\mathbf{x}-\\bar{\\mathbf{x}}_{k})^{T}\\mathbf{S}_{p}^{-1}(\\mathbf{x}-\\bar{\\mathbf{x}}_{k})$ 定义。\n\n首先计算合并协方差矩阵的逆矩阵。对于 $\\mathbf{S}_{p}=\\begin{pmatrix}3  1 \\\\ 1  1\\end{pmatrix}$，其行列式为 $\\det(\\mathbf{S}_{p})=3\\cdot 1-1\\cdot 1=2$。使用 $2\\times 2$ 逆矩阵公式，\n$$\n\\mathbf{S}_{p}^{-1}=\\frac{1}{\\det(\\mathbf{S}_{p})}\\begin{pmatrix}1  -1 \\\\ -1  3\\end{pmatrix}=\\frac{1}{2}\\begin{pmatrix}1  -1 \\\\ -1  3\\end{pmatrix}.\n$$\n\n计算中心化向量：\n$$\n\\mathbf{v}_{1}=\\mathbf{x}_{new}-\\bar{\\mathbf{x}}_{1}=\\begin{pmatrix}4 \\\\ 5\\end{pmatrix}-\\begin{pmatrix}2 \\\\ 3\\end{pmatrix}=\\begin{pmatrix}2 \\\\ 2\\end{pmatrix},\\quad\n\\mathbf{v}_{2}=\\mathbf{x}_{new}-\\bar{\\mathbf{x}}_{2}=\\begin{pmatrix}4 \\\\ 5\\end{pmatrix}-\\begin{pmatrix}6 \\\\ 5\\end{pmatrix}=\\begin{pmatrix}-2 \\\\ 0\\end{pmatrix}.\n$$\n\n计算 $D_{1}^{2}$：\n$$\n\\mathbf{S}_{p}^{-1}\\mathbf{v}_{1}=\\frac{1}{2}\\begin{pmatrix}1  -1 \\\\ -1  3\\end{pmatrix}\\begin{pmatrix}2 \\\\ 2\\end{pmatrix}\n=\\frac{1}{2}\\begin{pmatrix}0 \\\\ 4\\end{pmatrix}\n=\\begin{pmatrix}0 \\\\ 2\\end{pmatrix},\n$$\n$$\nD_{1}^{2}=\\mathbf{v}_{1}^{T}\\mathbf{S}_{p}^{-1}\\mathbf{v}_{1}=\\begin{pmatrix}2 & 2\\end{pmatrix}\\begin{pmatrix}0 \\\\ 2\\end{pmatrix}=4.\n$$\n\n计算 $D_{2}^{2}$：\n$$\n\\mathbf{S}_{p}^{-1}\\mathbf{v}_{2}=\\frac{1}{2}\\begin{pmatrix}1  -1 \\\\ -1  3\\end{pmatrix}\\begin{pmatrix}-2 \\\\ 0\\end{pmatrix}\n=\\frac{1}{2}\\begin{pmatrix}-2 \\\\ 2\\end{pmatrix}\n=\\begin{pmatrix}-1 \\\\ 1\\end{pmatrix},\n$$\n$$\nD_{2}^{2}=\\mathbf{v}_{2}^{T}\\mathbf{S}_{p}^{-1}\\mathbf{v}_{2}=\\begin{pmatrix}-2 & 0\\end{pmatrix}\\begin{pmatrix}-1 \\\\ 1\\end{pmatrix}=2.\n$$\n\n由于 $D_{2}^{2}=2  D_{1}^{2}=4$，新天体将被分类到第2组。", "answer": "$$\\boxed{B}$$", "id": "1914060"}, {"introduction": "除了对单个数据点进行分类，将整个分类规则理解为一个几何边界通常更具洞察力。最后一个练习 [@problem_id:1914104] 将指导您推导 LDA 模型中线性决策边界的方程。这条直线将特征空间划分为对应于每个类别的区域，为分类器提供了清晰的视觉表示。", "problem": "一家半导体制造厂使用自动光学检测系统对硅晶圆进行分类。该系统测量晶圆的两个关键几何特性：其翘曲度 ($x_1$) 和其扭曲度 ($x_2$)，单位均为微米。根据历史数据，晶圆被分为两类：“优等品”（高质量）和“测试品”（质量较低，需要进一步测试）。\n\n一个基于线性判别分析 (LDA) 的统计模型被用来创建一个决策边界以区分这两个类别。该分析假设两个类别的特征向量 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ 均服从具有相同协方差矩阵的二元正态分布。同时假设晶圆为“优等品”或“测试品”的先验概率相等。\n\n历史数据提供了以下统计摘要：\n- “优等品”晶圆的均值向量为 $\\boldsymbol{\\mu}_P = \\begin{pmatrix} 10 \\\\ 5 \\end{pmatrix}$。\n- “测试品”晶圆的均值向量为 $\\boldsymbol{\\mu}_T = \\begin{pmatrix} 6 \\\\ 9 \\end{pmatrix}$。\n- 两个类别的合并协方差矩阵为 $\\boldsymbol{\\Sigma} = \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix}$。\n\n确定线性判别函数 $f(x_1, x_2)$，使得决策边界由方程 $f(x_1, x_2) = 0$ 给出。该函数的形式应为 $f(x_1, x_2) = a_1 x_1 + a_2 x_2 + a_0$，其中系数 $a_1$、$a_2$ 和 $a_0$ 是没有公因数的整数，且 $a_1$ 为正。", "solution": "对于具有均值 $\\boldsymbol{\\mu}_{P}$ 和 $\\boldsymbol{\\mu}_{T}$、共同协方差 $\\boldsymbol{\\Sigma}$ 以及相等先验概率的两个类别，线性判别分析得出类别分数为\n$$\n\\delta_{k}(\\mathbf{x})= \\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{k} - \\frac{1}{2}\\boldsymbol{\\mu}_{k}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{k} + \\ln \\pi_{k},\n$$\n其中 $\\pi_{k}$ 是先验概率。当 $\\pi_{P}=\\pi_{T}$ 时，决策边界为 $\\delta_{P}(\\mathbf{x})=\\delta_{T}(\\mathbf{x})$，等价于\n$$\n\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{\\mu}_{P}-\\boldsymbol{\\mu}_{T}) - \\frac{1}{2}\\left(\\boldsymbol{\\mu}_{P}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{P} - \\boldsymbol{\\mu}_{T}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{T}\\right)=0.\n$$\n因此，线性判别函数可以写成\n$$\nf(x_{1},x_{2})= \\mathbf{w}^{\\top}\\mathbf{x} + a_{0},\n$$\n其中 $\\mathbf{w}=\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{\\mu}_{P}-\\boldsymbol{\\mu}_{T})$ 且 $a_{0}= -\\frac{1}{2}\\left(\\boldsymbol{\\mu}_{P}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{P} - \\boldsymbol{\\mu}_{T}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{T}\\right)$。\n\n给定\n$$\n\\boldsymbol{\\mu}_{P}=\\begin{pmatrix}10\\\\ 5\\end{pmatrix},\\quad\n\\boldsymbol{\\mu}_{T}=\\begin{pmatrix}6\\\\ 9\\end{pmatrix},\\quad\n\\boldsymbol{\\Sigma}=\\begin{pmatrix}2  1\\\\ 1  3\\end{pmatrix},\n$$\n计算 $\\boldsymbol{\\Sigma}^{-1}$。其行列式为 $\\det(\\boldsymbol{\\Sigma})=2\\cdot 3 - 1\\cdot 1 = 5$，所以\n$$\n\\boldsymbol{\\Sigma}^{-1}=\\frac{1}{5}\\begin{pmatrix}3  -1\\\\ -1  2\\end{pmatrix}.\n$$\n计算权重向量：\n$$\n\\boldsymbol{\\mu}_{P}-\\boldsymbol{\\mu}_{T}=\\begin{pmatrix}4\\\\ -4\\end{pmatrix},\\quad\n\\mathbf{w}=\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{\\mu}_{P}-\\boldsymbol{\\mu}_{T})=\\frac{1}{5}\\begin{pmatrix}3  -1\\\\ -1  2\\end{pmatrix}\\begin{pmatrix}4\\\\ -4\\end{pmatrix}=\\frac{1}{5}\\begin{pmatrix}16\\\\ -12\\end{pmatrix}=\\begin{pmatrix}\\frac{16}{5}\\\\ -\\frac{12}{5}\\end{pmatrix}.\n$$\n计算常数项：\n$$\n\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{P}=\\frac{1}{5}\\begin{pmatrix}3  -1\\\\ -1  2\\end{pmatrix}\\begin{pmatrix}10\\\\ 5\\end{pmatrix}=\\begin{pmatrix}5\\\\ 0\\end{pmatrix}\\Rightarrow \\boldsymbol{\\mu}_{P}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{P}=50,\n$$\n$$\n\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{T}=\\frac{1}{5}\\begin{pmatrix}3  -1\\\\ -1  2\\end{pmatrix}\\begin{pmatrix}6\\\\ 9\\end{pmatrix}=\\begin{pmatrix}\\frac{9}{5}\\\\ \\frac{12}{5}\\end{pmatrix}\\Rightarrow \\boldsymbol{\\mu}_{T}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{T}=\\frac{162}{5}.\n$$\n因此，\n$$\na_{0}=-\\frac{1}{2}\\left(50-\\frac{162}{5}\\right)=-\\frac{1}{2}\\cdot \\frac{88}{5}=-\\frac{44}{5}.\n$$\n因此\n$$\nf(x_{1},x_{2})=\\frac{16}{5}x_{1}-\\frac{12}{5}x_{2}-\\frac{44}{5}.\n$$\n乘以正因子 $5$ 得到一个等价的判别函数 $16x_{1}-12x_{2}-44$。进一步化简为互质的整数系数，得到 $f(x_{1},x_{2})=4x_{1}-3x_{2}-11,$", "answer": "$$\\boxed{4 x_{1} - 3 x_{2} - 11}$$", "id": "1914104"}]}