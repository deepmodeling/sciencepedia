{"hands_on_practices": [{"introduction": "要真正理解斯坦悖论，我们必须首先掌握其核心工具——詹姆斯-斯坦（James-Stein, JS）估计量的计算方法。这个练习提供了一个来自生物统计学实验的具体数据集，引导您逐步完成计算。通过直接应用公式，您将亲眼看到原始数据向量如何向原点“收缩”，这是其改进性能的基础。", "problem": "一位生物统计学家正在分析来自一项高通量实验的数据，该实验同时测量了多个基因的表达水平。测量向量 $X = (X_1, X_2, \\dots, X_p)^T$ 被建模为来自一个 $p$ 维正态分布 $N_p(\\theta, \\sigma^2 I_p)$ 的单次抽样。在这个模型中，$\\theta = (\\theta_1, \\theta_2, \\dots, \\theta_p)^T$ 代表基因的真实但未知的平均表达水平向量，而 $I_p$ 是 $p \\times p$ 的单位矩阵。已知该测量过程中，每个基因的测量都具有共同的方差 $\\sigma^2$，且各测量值在统计上是独立的。\n\n对于一个包含 $p=5$ 个基因的特定实验，已知其共同方差为 $\\sigma^2 = 2.25$。观测到的测量向量如下：\n$$\nx = \\begin{pmatrix} 4.1 \\\\ -2.3 \\\\ 0.8 \\\\ 5.0 \\\\ -1.5 \\end{pmatrix}\n$$\n为了估计真实均值向量 $\\theta$，该统计学家决定使用 James-Stein 估计量 $\\hat{\\theta}_{JS}$。对于来自 $N_p(\\theta, \\sigma^2 I_p)$ 的一个观测值 $x$，该估计量定义如下：\n$$\n\\hat{\\theta}_{JS} = \\left(1 - \\frac{(p-2)\\sigma^2}{\\|x\\|^2}\\right) x\n$$\n其中 $\\|x\\|^2 = \\sum_{i=1}^{p} x_i^2$ 是向量 $x$ 的欧几里得范数的平方。该估计量的一个显著特点是，当 $p \\ge 3$ 时，其总均方误差一致地低于标准的最大似然估计量 (MLE)（即 $x$）。\n\n基于给定数据，计算真实平均表达水平的 James-Stein 估计值 $\\hat{\\theta}_{JS}$。将最终答案表示为一个行向量，其中每个分量四舍五入到三位有效数字。", "solution": "我们给定来自 $N_{p}(\\theta,\\sigma^{2}I_{p})$ 的单个观测值 $x \\in \\mathbb{R}^{p}$ 以及 James-Stein 估计量\n$$\n\\hat{\\theta}_{JS}=\\left(1-\\frac{(p-2)\\sigma^{2}}{\\|x\\|^{2}}\\right)x,\n$$\n其中 $\\|x\\|^{2}=\\sum_{i=1}^{p}x_{i}^{2}$。对于本题，有 $p=5$，$\\sigma^{2}=2.25$，以及\n$$\nx=\\begin{pmatrix}4.1\\\\-2.3\\\\0.8\\\\5.0\\\\-1.5\\end{pmatrix}.\n$$\n首先计算范数的平方：\n$$\n\\|x\\|^{2}=4.1^{2}+(-2.3)^{2}+0.8^{2}+5.0^{2}+(-1.5)^{2}=16.81+5.29+0.64+25+2.25=49.99.\n$$\n计算收缩因子：\n$$\n1-\\frac{(p-2)\\sigma^{2}}{\\|x\\|^{2}}=1-\\frac{3\\cdot 2.25}{49.99}=1-\\frac{6.75}{49.99}=\\frac{49.99-6.75}{49.99}=\\frac{43.24}{49.99}\\approx 0.8649729946.\n$$\n因此，\n$$\n\\hat{\\theta}_{JS}=\\left(\\frac{43.24}{49.99}\\right)x.\n$$\n将此标量应用于每个分量：\n$$\n\\hat{\\theta}_{JS,1}=4.1\\cdot\\frac{43.24}{49.99}\\approx 3.5463893,\\quad\n\\hat{\\theta}_{JS,2}=-2.3\\cdot\\frac{43.24}{49.99}\\approx -1.9894379,\n$$\n$$\n\\hat{\\theta}_{JS,3}=0.8\\cdot\\frac{43.24}{49.99}\\approx 0.6919784,\\quad\n\\hat{\\theta}_{JS,4}=5.0\\cdot\\frac{43.24}{49.99}\\approx 4.324865,\n$$\n$$\n\\hat{\\theta}_{JS,5}=-1.5\\cdot\\frac{43.24}{49.99}=-\\frac{64.86}{49.99}\\approx -1.2974595.\n$$\n将每个分量四舍五入到三位有效数字，得到\n$$\n\\begin{pmatrix}\n3.55  -1.99  0.692  4.32  -1.30\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 3.55  -1.99  0.692  4.32  -1.30 \\end{pmatrix}}$$", "id": "1956802"}, {"introduction": "尽管JS估计量因其较低的平均风险而备受赞誉，但在某些特定情况下，它会表现出一些令人惊讶甚至不希望看到的行为。这个问题探讨了当观测数据接近原点，特别是当数据向量的平方范数小于 $p-2$ 时的情形。在这种情况下计算估计值，会揭示一个反直觉的结果：估计值的方向与观测值的方向完全相反。这突显了标准JS估计量的一个关键局限性，并为后续发展的“正部”估计量提供了动因。", "problem": "一位天体物理学家正在测量天空中五个不同的、不重叠区域的微弱微波各向异性。理论上的“零模型”预测宇宙微波背景是完全均匀的，这意味着每个区域 $i$ 的真实平均各向异性 $\\theta_i$ 为零。因此，真实均值向量被假设为 $\\theta = (0, 0, 0, 0, 0)$。\n\n实验测量值在经过归一化和减去全局平均值后，被收集到一个向量 $X = (x_1, x_2, x_3, x_4, x_5)$ 中。由于仪器噪声和量子涨落，该测量过程被建模为一个5维多元正态分布，$X \\sim N_5(\\theta, I_5)$，其中 $\\theta \\in \\mathbb{R}^5$ 是未知的均值向量，$I_5$ 是 $5 \\times 5$ 的单位矩阵。\n\n$\\theta$ 的常规估计是最大似然估计 (MLE)，它就是观测到的向量 $X$。另一种方法是 James-Stein 估计量，当维度 $p \\ge 3$ 时，其定义为：\n$$ \\delta_{JS}(X) = \\left(1 - \\frac{p-2}{||X||^2}\\right)X $$\n其中 $p$ 是向量 $X$ 的维度，并且 $||X||^2 = \\sum_{i=1}^p x_i^2$。已知当对 $\\theta$ 的所有可能值取平均时，该估计量比 MLE 具有更低的总均方误差。\n\n假设实验观测得到的向量为 $X = (1.10, 0.60, -0.40, 0.30, 0.20)$。\n\n基于此观测结果，计算 James-Stein 估计 $\\delta_{JS}(X)$ 的第一分量和第二分量的数值。以数对的形式给出你的答案，按第一分量到第二分量的顺序排列。将两个分量的最终答案四舍五入到三位有效数字。", "solution": "我们使用维度 $p=5$ 的 James-Stein 估计量：\n$$\n\\delta_{JS}(X)=\\left(1-\\frac{p-2}{\\|X\\|^{2}}\\right)X.\n$$\n给定 $X=(1.10,0.60,-0.40,0.30,0.20)$，首先计算其范数的平方：\n$$\n\\|X\\|^{2}=\\sum_{i=1}^{5}x_{i}^{2}=1.10^{2}+0.60^{2}+(-0.40)^{2}+0.30^{2}+0.20^{2}=1.21+0.36+0.16+0.09+0.04=1.86.\n$$\n当 $p=5$ 时，我们有 $p-2=3$，所以收缩因子是\n$$\n1-\\frac{p-2}{\\|X\\|^{2}}=1-\\frac{3}{1.86} \\approx 1 - 1.6129 = -0.6129.\n$$\n因此，\n$$\n\\delta_{JS}(X) \\approx -0.6129 X.\n$$\n第一个分量是\n$$\n\\delta_{JS,1} \\approx -0.6129 \\times 1.10 \\approx -0.67419 \\ \\Rightarrow\\ \\text{保留三位有效数字为：}-0.674.\n$$\n第二个分量是\n$$\n\\delta_{JS,2} \\approx -0.6129 \\times 0.60 \\approx -0.36774 \\ \\Rightarrow\\ \\text{保留三位有效数字为：}-0.368.\n$$\n因此，所求的按第一分量到第二分量顺序排列的数对是 $(-0.674,-0.368)$。", "answer": "$$\\boxed{\\begin{pmatrix}-0.674  -0.368\\end{pmatrix}}$$", "id": "1956809"}, {"introduction": "詹姆斯-斯坦估计量的真正威力不仅在于其公式本身，更在于它与其他统计学原理的深刻联系。这个练习在JS收缩因子与用于假设检验的F统计量之间建立了一座桥梁。通过推导这一关系，您将获得一种强大的直觉：收缩的程度与反对原假设（即真实均值为零）的证据强度成反比，这使得收缩不再仅仅是一个数学技巧，而是一种复杂且由数据驱动的统计推断形式。", "problem": "在一个高通量生物实验中，我们感兴趣的是估计一种处理对 $p$ 个不同基因表达的真实平均效应 $\\theta = (\\theta_1, \\dots, \\theta_p)^T$，其中 $p \\ge 3$。观测到的平均效应被建模为一个随机向量 $Y = (Y_1, \\dots, Y_p)^T$，该向量服从均值向量为 $\\theta$、协方差矩阵为 $\\sigma^2 I_p$ 的 $p$ 元正态分布，其中 $I_p$ 是 $p \\times p$ 的单位矩阵。方差 $\\sigma^2$ 是未知的。幸运的是，我们有一个独立的方差估计量 $S^2$，使得 $\\frac{\\nu S^2}{\\sigma^2}$ 服从自由度为 $\\nu$ 的卡方分布。\n\n为了进行初步分析，我们考虑两种不同的统计程序：\n\n1.  **估计**：使用 James-Stein (JS) 估计量来估计真实均值向量 $\\theta$。该估计量的形式为 $\\hat{\\theta}_{JS} = (1-k)Y$，其中依赖于数据的收缩因子 $k$ 由 $k = \\frac{c S^2}{\\|Y\\|^2}$ 给出，$c$ 是一个常数，且 $\\|Y\\|^2 = \\sum_{i=1}^p Y_i^2$。对于本问题，假设常数具有特定形式 $c=p-2$。\n\n2.  **假设检验**：进行 F 检验以检验原假设 $H_0: \\theta = 0$ 与备择假设 $H_1: \\theta \\ne 0$。为此目的的检验统计量由 $F = \\frac{\\|Y\\|^2}{p S^2}$ 给出。\n\n为了理解这两个程序之间的联系，请将收缩因子 $k$ 表示为 F 统计量 $F$ 和维度 $p$ 的函数。", "solution": "我们已知 James-Stein 收缩因子为\n$$\nk=\\frac{c S^{2}}{\\|Y\\|^{2}}\n$$\n其中 $c=p-2$，因此\n$$\nk=\\frac{(p-2) S^{2}}{\\|Y\\|^{2}}.\n$$\n用于检验 $H_{0}:\\theta=0$ 的 F 统计量为\n$$\nF=\\frac{\\|Y\\|^{2}}{p S^{2}}.\n$$\n整理该表达式可得\n$$\n\\frac{\\|Y\\|^{2}}{S^{2}}=pF \\quad \\Longrightarrow \\quad \\frac{S^{2}}{\\|Y\\|^{2}}=\\frac{1}{pF}.\n$$\n将此结果代入 $k$ 的表达式中，得到\n$$\nk=(p-2)\\cdot \\frac{S^{2}}{\\|Y\\|^{2}}=(p-2)\\cdot \\frac{1}{pF}=\\frac{p-2}{pF}.\n$$\n因此，用 $F$ 和 $p$ 表示的收缩因子为 $\\frac{p-2}{pF}$。", "answer": "$$\\boxed{\\frac{p-2}{p F}}$$", "id": "1956810"}]}