{"hands_on_practices": [{"introduction": "多重插补的成功在很大程度上取决于选择一个与数据内在属性相符的插补模型。盲目应用默认方法（如线性回归）可能会产生不可能的数值（例如，大于1的比例），从而导致结果有偏。此练习 [@problem_id:1938743] 旨在挑战您批判性地思考数据约束，并为受限变量（如比例）选择合适的插补策略。", "problem": "一位社会科学家正在分析一个家庭调查数据集，以了解其支出模式。该数据集包含每个家庭的以下完全观测到的变量：\n- `LogIncome`：家庭月总收入的自然对数。\n- `HouseholdSize`：家庭中的人口数量。\n\n主要关注的变量是`FoodProportion`，它代表每月收入中用于食品的比例。这个变量是连续的，并且理论上被限制在区间 $[0, 1]$ 内。然而，由于调查中的无应答情况，`FoodProportion`变量存在缺失值。研究人员决定在进行主要分析之前，使用多重插补（MI）来处理缺失数据。\n\n研究人员提出了几种针对`FoodProportion`变量的插补策略，使用`LogIncome`和`HouseholdSize`作为预测变量。\n\nA. 直接使用标准线性回归模型对`FoodProportion`进行插补。\n\nB. 使用预测均值匹配（PMM），其基础模型是`FoodProportion`对预测变量的线性回归。\n\nC. 使用Beta回归对`FoodProportion`进行建模，其中均值使用logit链接函数。\n\nD. 对`FoodProportion`应用反正弦平方根变换（即 $Y' = \\arcsin(\\sqrt{\\text{FoodProportion}})$），使用线性回归对变换后的变量$Y'$进行插补，然后将结果进行逆变换。\n\nE. 对`FoodProportion`应用logit变换（即 $Y' = \\ln(\\frac{\\text{FoodProportion}}{1-\\text{FoodProportion}})$），使用线性回归对变换后的变量$Y'$进行插补，然后将结果进行逆变换。\n\nF. 将`FoodProportion`离散化为三个类别（'低'、'中'、'高'），然后使用多项逻辑斯谛回归对缺失的类别进行插补。\n\n假设`FoodProportion`的观测值中没有恰好为0或1的，请从以上列表中选择所有在统计学上适合此任务的策略。", "solution": "目标变量是一个支撑集为 $[0,1]$ 的连续比例，并且问题陈述没有观测值恰好为 $0$ 或 $1$，因此观测数据实际上位于 $(0,1)$ 区间内。为了使多重插补在统计学上是适当的，插补模型应该 (i) 生成的插补值要尊重变量的支撑集，(ii) 与分数响应的数据生成结构相容（congenial），以及 (iii) 避免可能导致插补偏差和扭曲不确定性的临时截断。\n\n评估每种提出的策略：\n\nA. 对原始比例进行标准线性回归插补不会将插补值限制在 $[0,1]$ 范围内。在正态误差线性模型下，预测值加上随机残差的抽样值可能会落在 $[0,1]$ 之外，从而违反了支撑集。在 $0$ 和 $1$ 处进行事后截断是一种临时性做法，可能会引入偏差和不恰当的不确定性量化。因此，这在统计学上是不适当的。\n\nB. 预测均值匹配（PMM）使用线性模型来定义邻域，但插补的是实际观测到的捐赠者值。由于问题的假设是所有捐赠者值都位于 $(0,1)$ 内，PMM保留了支撑集，并且对非正态性和异方差性具有稳健性。在随机缺失和预测变量正确设定的条件下，PMM对于有界连续结果在统计学上是适当的。因此，B是适当的。\n\nC. 带有logit链接的Beta回归使用Beta分布对支撑集在 $(0,1)$ 上的响应进行建模，该分布的密度函数在 $(0,1)$ 上，并且能够适应比例数据典型的均值-方差关系。由于没有观测到零或一，Beta似然函数是良定义的，在多重插补中进行适当的贝叶斯抽样或近似贝叶斯抽样会产生在 $(0,1)$ 范围内的插补值。因此，C是适当的。\n\nD. 反正弦平方根变换 $Y'=\\arcsin(\\sqrt{p})$ 将 $p\\in(0,1)$ 映射到 $Y'\\in(0,\\frac{\\pi}{2})$。对 $Y'$ 进行线性插补可能会产生在 $(0,\\frac{\\pi}{2})$ 之外的值，但逆变换 $p=\\sin^{2}(Y')$ 会将任何实数 $Y'$ 映射到 $[0,1]$ 内。尽管在逆变换后保留了边界，但这种变换是一种用于已知分母的二项比例的方差稳定方法，它依赖于方差与 $p(1-p)/n$ 成正比的假设。对于没有已知 $n$ 的一般连续比例，它缺乏有原则的分布合理性，并且如果插补的 $Y'$ 偏离了主区间，逆变换后可能会引发非单调关系，从而导致失真。鉴于存在可以正确设定的有界模型（B, C, E），这种方法不被认为是统计学上适当的。\n\nE. logit变换 $Y'=\\ln\\!\\left(\\frac{p}{1-p}\\right)$ 将 $(0,1)$ 映射到 $\\mathbb{R}$。在 $\\mathbb{R}$ 上对带有随机残差的 $Y'$ 进行线性回归插补是良定义的，并且逆logit变换 $p=\\frac{\\exp(Y')}{1+\\exp(Y')}$ 保证插补值在 $(0,1)$ 内。在没有观测到零或一的情况下，这种方法对于分数响应是标准的，并且在统计学上是适当的。因此，E是适当的。\n\nF. 将连续比例离散化为类别，并通过多项逻辑斯谛回归进行插补，会丢弃类别内的信息，引入测量误差，并且如果分析中将该变量用作连续变量，则会产生不相容性。这可能会使参数估计和标准误产生偏差。因此，F对于插补连续比例在统计学上是不适当的。\n\n因此，在统计学上适当的策略是 B、C 和 E。", "answer": "$$\\boxed{BCE}$$", "id": "1938743"}, {"introduction": "生成插补值后，我们不能简单地假设它们是正确的；进行诊断性检查是至关重要的一步。这个练习 [@problem_id:1938796] 介绍了一种标准图形技术，用于直观地比较插补数据与原始观测数据的分布。这种检查有助于确保插补值是合理的，并且插补模型没有引入意外的偏差。", "problem": "一位临床研究人员正在分析一项健康研究的数据集。其中一个关键的连续变量“收缩压”（Systolic Blood Pressure, SBP）存在许多缺失值。研究人员假设导致数据缺失的机制是随机缺失（Missing At Random, MAR），这意味着一个值缺失的概率可能取决于其他观察到的患者变量。为了解决这个问题，研究人员采用链式方程多重插补（Multiple Imputation by Chained Equations, MICE）方法，生成了数据集的 $m=5$ 个不同的完整版本。\n\n此过程中的一个关键步骤是进行诊断性检查，以确保插补的SBP值是合理的。研究人员的目标是，以图形方式比较原始观测到的SBP值的边际分布与五个新生成的完整数据集中SBP变量的边际分布。\n\n对于这一特定目的，以下哪种图形方法最有效、最全面？\n\nA. 创建五个独立的箱线图，每个箱线图对应五个完整数据集中的一个SBP变量。\n\nB. 构建一个单一的散点图，显示插补的SBP值与患者年龄的关系，使用汇集自所有五个插补的数据。\n\nC. 绘制一个单一的直方图，将所有观测到的SBP值与来自所有五个数据集的所有插补SBP值合并成一个大样本。\n\nD. 生成一个单一的图，其中叠加了六条不同的密度曲线：一条实线代表原始观测到的SBP值的分布，另外五条半透明的线分别代表来自五个完整数据集中（观测值加插补值）的完整SBP变量的分布。\n\nE. 计算观测数据的SBP均值和方差，以及五个完整数据集中每一个的SBP均值和方差，并将它们呈现在一个表格中。", "solution": "核心任务是找到最佳的图形方法，以比较一个观测变量的分布与经过多重插补后同一变量的分布。一种有效的方法应该能够直接比较分布的形状（中心、离散程度、偏度、峰态），并且还应该能够可视化插补过程引入的不确定性（即 $m=5$ 个插补数据集之间的差异）。\n\n让我们根据这些标准来评估每个选项：\n\n*   **选项A**：这涉及创建五个独立的箱线图。箱线图提供了分布的五数概括。虽然有用，但它们可能会掩盖重要的分布特征，如双峰性。此外，使用五个独立的图表使得与原始观测数据分布的直接比较变得繁琐。这种方法的信息量不如显示完整分布形状的方法。\n\n*   **选项B**：这建议绘制插补SBP与年龄的散点图。这类图表是检查插补模型是否保留了SBP与年龄之间*条件关系*（或二元分布）的关键诊断工具。然而，问题明确要求的是一种检查SBP变量本身*边际分布*的方法。因此，这个图表没有解决主要目标。\n\n*   **选项C**：将所有观测值和插补值合并成一个单一的直方图是一种糟糕的诊断技术。此项检查的目的是*比较*观测数据的分布与插补数据的分布，而不是将它们合并。将数据合并到一个直方图中，使得无法检测出（例如）插补值是否与观测值具有不同的均值或形状。这种方法掩盖了插补模型可能存在的问题。\n\n*   **选项D**：这描述了叠加多个密度图的方法。这是执行此诊断任务的标准且最有效的方法。密度图提供了整个概率分布的平滑估计，揭示了其形状、中心、离散程度和任何峰值。通过将观测数据的密度绘制为实线参考线，并叠加五个完整数据集的密度，研究人员可以进行即时且详细的视觉比较。这种方法同时实现了两个关键目标：\n    1.  它允许检查完整数据集的分布是否与观测数据的分布相似。巨大的差异可能表明插补模型存在问题。\n    2.  五条半透明的完整数据集密度曲线之间的离散程度，直接可视化了插补的不确定性。如果这些曲线差异很大，则表明插补值的不确定性很高。\n\n*   **选项E**：这个选项建议以表格形式呈现数值摘要（均值和方差）。虽然这是一个有价值的定量检查，但问题明确要求的是一种*图形方法*。该选项未能满足此要求。此外，像均值和方差这样的汇总统计量无法捕捉分布的完整形状，而这正是此诊断检查的一个关键方面。\n\n基于此分析，选项D是实现研究人员既定目标的最全面、最合适的图形方法。它直接比较了完整的边际分布，同时还说明了多重插补之间的变异性。", "answer": "$$\\boxed{D}$$", "id": "1938796"}, {"introduction": "在对每个填补完成的数据集运行分析之后，最后一步是将这些单独的结果合成为一个最终的推断。这个练习 [@problem_id:1938746] 提供了应用鲁宾法则 (Rubin's Rules) 的直接实践，这套法则是合并点估计及其方差的标准方法。掌握这个计算过程对于从多重插补分析中得出有效结论至关重要。", "problem": "一位数据分析师正在研究一个人的每周平均屏幕时间（以小时为单位）与他们在标准化健康问卷上的得分之间的关系。由于调查无应答，部分屏幕时间数据缺失。为解决此问题，该分析师采用多重插补法，创建了 $m=5$ 个不同的完整数据集。\n\n对于这 $m=5$ 个数据集中的每一个，都进行了一次简单线性回归分析。分析得出了一个估计的回归系数 $\\hat{\\beta}_j$，该系数表示每周屏幕时间每增加一小时，健康问卷得分的变化，以及其对应的估计方差 $U_j$。五次独立分析的结果如下：\n\n- 数据集 1：$\\hat{\\beta}_1 = -0.45$, $U_1 = 0.012$\n- 数据集 2：$\\hat{\\beta}_2 = -0.51$, $U_2 = 0.015$\n- 数据集 3：$\\hat{\\beta}_3 = -0.48$, $U_3 = 0.014$\n- 数据集 4：$\\hat{\\beta}_4 = -0.55$, $U_4 = 0.013$\n- 数据集 5：$\\hat{\\beta}_5 = -0.46$, $U_5 = 0.011$\n\n使用 Rubin 法则来合并多重插补的估计值，计算回归系数的最终合并点估计值及其相关的总方差。以两个数值的形式给出你的答案：首先是合并后的系数，然后是总方差。将你的最终答案都四舍五入到三位有效数字。", "solution": "我们使用 Rubin 法则进行多重插补。设 $m$ 为插补次数，$\\hat{\\beta}_{j}$ 为点估计值， $U_{j}$ 为其估计方差。合并点估计值为\n$$\n\\bar{\\beta}=\\frac{1}{m}\\sum_{j=1}^{m}\\hat{\\beta}_{j},\n$$\n插补内方差为\n$$\n\\bar{U}=\\frac{1}{m}\\sum_{j=1}^{m}U_{j},\n$$\n插补间方差为\n$$\nB=\\frac{1}{m-1}\\sum_{j=1}^{m}\\left(\\hat{\\beta}_{j}-\\bar{\\beta}\\right)^{2},\n$$\n总方差为\n$$\nT=\\bar{U}+\\left(1+\\frac{1}{m}\\right)B.\n$$\n\n给定 $m=5$，$\\hat{\\beta}_{j}\\in\\{-0.45,-0.51,-0.48,-0.55,-0.46\\}$ 以及 $U_{j}\\in\\{0.012,0.015,0.014,0.013,0.011\\}$：\n\n1) 合并估计值：\n$$\n\\sum_{j=1}^{5}\\hat{\\beta}_{j}=-0.45-0.51-0.48-0.55-0.46=-2.45,\\quad\n\\bar{\\beta}=\\frac{-2.45}{5}=-0.49.\n$$\n\n2) 插补内方差：\n$$\n\\sum_{j=1}^{5}U_{j}=0.012+0.015+0.014+0.013+0.011=0.065,\\quad\n\\bar{U}=\\frac{0.065}{5}=0.013.\n$$\n\n3) 插补间方差。与 $\\bar{\\beta}$ 的偏差为：\n$$\n0.04,\\,-0.02,\\,0.01,\\,-0.06,\\,0.03,\n$$\n平方和为：\n$$\n0.04^{2}+(-0.02)^{2}+0.01^{2}+(-0.06)^{2}+0.03^{2}=0.0016+0.0004+0.0001+0.0036+0.0009=0.0066,\n$$\n因此\n$$\nB=\\frac{0.0066}{5-1}=0.00165.\n$$\n\n4) 总方差：\n$$\nT=\\bar{U}+\\left(1+\\frac{1}{5}\\right)B=0.013+1.2\\times 0.00165=0.013+0.00198=0.01498.\n$$\n\n四舍五入到三位有效数字，得到 $\\bar{\\beta}=-0.490$ 和 $T=0.0150$。", "answer": "$$\\boxed{\\begin{pmatrix}-0.490  0.0150\\end{pmatrix}}$$", "id": "1938746"}]}