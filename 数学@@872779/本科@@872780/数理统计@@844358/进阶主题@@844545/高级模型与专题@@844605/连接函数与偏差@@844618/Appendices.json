{"hands_on_practices": [{"introduction": "在广义线性模型中，连接函数的选择并非随心所欲。它必须严格遵守一个基本原则：将响应变量均值 $\\mu$ 的可能取值范围（定义域）映射到线性预测变量 $\\eta$ 的整个实数范围（值域）。这个练习通过一个思想实验，要求你评估一个假设的连接函数是否满足这一根本要求，从而帮助你深入理解连接函数有效性的核心标准。[@problem_id:1930962]", "problem": "在广义线性模型 (GLM) 的框架中，响应变量的期望值 $\\mu = E[Y]$ 与线性预测子 $\\eta = \\mathbf{x}^T\\beta$ 之间的关系是通过一个连接函数 $g$ 建立的。核心方程是 $g(\\mu) = \\eta$。为使该模型良定义，连接函数必须将均值 $\\mu$ 的可能取值空间映射到线性预测子 $\\eta$ 的可能取值空间。\n\n考虑一个服从伯努利分布的响应变量 $Y$，其中 $Y$ 可以取值 $0$ 或 $1$。因此，该变量的均值 $\\mu = P(Y=1)$ 被限制在开区间 $(0,1)$ 内。线性预测子 $\\eta$ 作为解释变量的线性组合，理论上可以在实数线上取任何值，即 $\\eta \\in (-\\infty, \\infty)$。\n\n一位分析师建议使用函数 $g(\\mu) = \\mu^2$ 作为此伯努利 GLM 的连接函数。以下哪个陈述指出了该函数不适用于此目的的根本原因？\n\nA. 函数 $g(\\mu) = \\mu^2$ 不是伯努利分布的典则连接函数。\nB. 函数 $g(\\mu) = \\mu^2$ 在整个实数线上不是一对一的。\nC. 当 $\\mu \\in (0,1)$ 时，函数 $g(\\mu)$ 的值域没有覆盖所有实数的集合。\nD. 连接函数的反函数 $g^{-1}(\\eta)$ 不存在。\nE. 连接函数的二阶导数 $g''(\\mu)$ 不为零。", "solution": "在广义线性模型中，连接函数 $g$ 必须将均值参数空间映射到线性预测子空间，并且是可逆的，以便对于任何 $\\eta \\in (-\\infty,\\infty)$，其反函数 $g^{-1}(\\eta)$ 能在允许范围内产生一个有效的均值 $\\mu$。对于伯努利响应，均值满足 $\\mu \\in (0,1)$，因此一个有效的连接函数必须满足\n$$\ng:(0,1)\\to(-\\infty,\\infty)\n$$\n并且是一对一的，其反函数为\n$$\ng^{-1}:(-\\infty,\\infty)\\to(0,1).\n$$\n\n考虑 $g(\\mu)=\\mu^{2}$。对于 $\\mu \\in (0,1)$，我们有 $0  \\mu^2  1$，因此\n$$\ng\\big((0,1)\\big)=(0,1).\n$$\n因此，$g$ 在 $\\mu$ 的允许定义域上的值域是 $(0,1)$，这并没有覆盖 $(-\\infty,\\infty)$。所以，对于任何 $\\eta \\notin (0,1)$，不存在 $\\mu \\in (0,1)$ 使得 $g(\\mu)=\\eta$ 成立，并且反函数 $g^{-1}(\\eta)=\\sqrt{\\eta}$ 无法对所有 $\\eta \\in (-\\infty,\\infty)$ 定义。这违反了连接映射必须是到线性预测子空间上的满射的要求。\n\n评估各个选项：\n- A 不是根本原因；非典则连接函数仍然可以是有效的。\n- B 与所需的定义域无关；在 $(0,1)$ 上，$g$ 是一对一的。\n- C 正确地指出 $g\\big((0,1)\\big)\\neq(-\\infty,\\infty)$，这是根本性的问题。\n- D 的陈述是错误的；反函数存在，但仅在受限的值域 $(0,1)$ 上，而不是在 $(-\\infty,\\infty)$ 上。\n- E 与连接函数的有效性无关。\n\n因此，根本原因是 C 中描述的值域不匹配。", "answer": "$$\\boxed{C}$$", "id": "1930962"}, {"introduction": "对于二元响应变量，存在多种有效的连接函数，如 logit、probit 和 cloglog。我们该如何选择？这个练习提供了一种量化的比较方法。通过计算导数 $\\frac{d\\mu}{d\\eta}$，你将探索在均值 $\\mu$ 相同的点上，不同模型中响应概率对线性预测变量变化的敏感度，从而具体地理解这些常用连接函数在行为上的细微差别。[@problem_id:1930929]", "problem": "在用于二元数据的广义线性模型 (GLM) 框架中，连接函数 $g(\\mu)$ 将响应变量的期望值 $\\mu = E[Y]$ 与线性预测子 $\\eta$ 联系起来。线性预测子是解释变量的线性组合。该关系由 $\\eta = g(\\mu)$ 给出，其中 $0  \\mu  1$。量 $\\frac{d\\mu}{d\\eta}$ 表示平均响应对线性预测子微小变化的敏感度。\n\n考虑以下三种常用的连接函数：\n1.  **Logit（逻辑斯蒂）**: $\\eta = \\ln\\left(\\frac{\\mu}{1-\\mu}\\right)$\n2.  **Probit（概率单位）**: $\\eta = \\Phi^{-1}(\\mu)$，其中 $\\Phi^{-1}$ 是标准正态分布的分位数函数（累积分布函数的逆函数）。标准正态分布的概率密度函数为 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{z^{2}}{2}\\right)$。\n3.  **互补log-log (cloglog)**: $\\eta = \\ln(-\\ln(1-\\mu))$\n\n对于这三种模型中的每一种，计算当平均响应为 $\\mu = 0.5$ 时导数 $\\frac{d\\mu}{d\\eta}$ 的数值。\n\n将您的三个结果表示为一组数字，按 logit、probit 和 cloglog 模型的特定顺序排列。将每个数值四舍五入到四位有效数字。", "solution": "我们要求在 $\\mu=0.5$ 时，每个连接函数的 $d\\mu/d\\eta$。在一个 GLM 中，对于连接函数 $\\eta=g(\\mu)$，其反向连接函数为 $\\mu=g^{-1}(\\eta)$，且导数满足\n$$\n\\frac{d\\mu}{d\\eta}=\\frac{1}{g'(\\mu)}.\n$$\n\nLogit 连接函数: $g(\\mu)=\\ln\\!\\left(\\frac{\\mu}{1-\\mu}\\right)$。求导：\n$$\ng'(\\mu)=\\frac{d}{d\\mu}\\left[\\ln(\\mu)-\\ln(1-\\mu)\\right]=\\frac{1}{\\mu}+\\frac{1}{1-\\mu}=\\frac{1}{\\mu(1-\\mu)}.\n$$\n因此，\n$$\n\\frac{d\\mu}{d\\eta}=\\mu(1-\\mu).\n$$\n在 $\\mu=0.5$ 时，$\\frac{d\\mu}{d\\eta}=0.5\\times 0.5=0.25$。\n\nProbit 连接函数: $g(\\mu)=\\Phi^{-1}(\\mu)$。使用反函数求导法则，\n$$\ng'(\\mu)=\\frac{1}{\\Phi'\\!\\left(\\Phi^{-1}(\\mu)\\right)}=\\frac{1}{\\phi\\!\\left(\\Phi^{-1}(\\mu)\\right)}.\n$$\n因此，\n$$\n\\frac{d\\mu}{d\\eta}=\\phi\\!\\left(\\Phi^{-1}(\\mu)\\right).\n$$\n在 $\\mu=0.5$ 时，$\\eta=\\Phi^{-1}(0.5)=0$，且 $\\phi(0)=\\frac{1}{\\sqrt{2\\pi}}$。数值上，$\\frac{1}{\\sqrt{2\\pi}}\\approx 0.3989$（保留四位有效数字）。\n\n互补 log-log 连接函数: $g(\\mu)=\\ln\\!\\big(-\\ln(1-\\mu)\\big)$。使用链式法则求导：\n$$\ng'(\\mu)=\\frac{1}{-\\ln(1-\\mu)}\\cdot\\frac{d}{d\\mu}\\big[-\\ln(1-\\mu)\\big]=\\frac{1}{-\\ln(1-\\mu)}\\cdot\\frac{1}{1-\\mu}=\\frac{1}{(1-\\mu)\\big(-\\ln(1-\\mu)\\big)}.\n$$\n因此，\n$$\n\\frac{d\\mu}{d\\eta}=(1-\\mu)\\big(-\\ln(1-\\mu)\\big).\n$$\n在 $\\mu=0.5$ 时，此值为 $(1-0.5)\\big(-\\ln(0.5)\\big)=0.5\\ln 2\\approx 0.3466$（保留四位有效数字）。\n\n按 logit、probit、cloglog 的顺序汇总结果，并四舍五入到四位有效数字，得到 $0.2500$、$0.3989$、$0.3466$。", "answer": "$$\\boxed{\\begin{pmatrix}0.2500  0.3989  0.3466\\end{pmatrix}}$$", "id": "1930929"}, {"introduction": "建立模型后，评估其拟合优度至关重要。偏差（Deviance）是衡量模型拟合数据程度的核心指标，它通过比较当前模型与一个能完美拟合数据的“饱和模型”的对数似然值得出。本练习将指导你为一个泊松分布的数据集计算总偏差，让你亲手实践如何通过对数似然函数来量化模型的拟合差异，从而掌握评估模型性能的关键技能。[@problem_id:1930961]", "problem": "一家大型电子商务公司的运营分析师正在监控每小时的服务器崩溃次数。在三小时的观察期内，观测到的崩溃次数分别为 $y_1=2$、$y_2=5$ 和 $y_3=8$。分析师希望用一个简单的统计模型来拟合这些数据。该模型假设每小时的崩溃次数 $Y_i$ 服从一个具有恒定均值 $\\mu$ 的泊松分布，即 $Y_i \\sim \\text{Poisson}(\\mu)$。对于均值为 $\\mu$ 的单个泊松观测值 $y$，其对数似然函数由 $\\ell(\\mu; y) = y \\ln(\\mu) - \\mu - \\ln(y!)$ 给出。\n\n分析师拟合了该模型，并求得均值的最大似然估计为 $\\hat{\\mu} = 5$。为了评估模型的拟合优度，分析师决定计算偏差（deviance）。偏差定义为 $D = 2(\\ell_{\\text{sat}} - \\ell_{\\text{fit}})$，其中 $\\ell_{\\text{fit}}$ 是在最大似然估计处评估的拟合模型的对数似然，而 $\\ell_{\\text{sat}}$ 是饱和模型的对数似然。在饱和模型中，每个观测值的拟合值就是观测值本身（即第 $i$ 个观测值的参数估计为 $\\hat{\\mu}_i=y_i$），从而达到完美拟合。\n\n计算该分析师模型的偏差值。请注意，对于任何涉及观测值 $y_i=0$ 的计算，项 $y_i \\ln(y_i)$ 应被视为 0。将您的答案四舍五入到四位有效数字。", "solution": "对于均值为 $\\mu$ 的泊松观测值 $y$，其对数似然函数为 $\\ell(\\mu;y)=y\\ln(\\mu)-\\mu-\\ln(y!)$。对于三个独立的观测值 $y_{1}=2$、$y_{2}=5$、$y_{3}=8$ 和一个拟合的恒定均值 $\\hat{\\mu}=5$，拟合模型的对数似然为\n$$\n\\ell_{\\text{fit}}=\\sum_{i=1}^{3}\\left[y_{i}\\ln(5)-5-\\ln(y_{i}!)\\right].\n$$\n饱和模型的对数似然（其中 $\\hat{\\mu}_{i}=y_{i}$）为\n$$\n\\ell_{\\text{sat}}=\\sum_{i=1}^{3}\\left[y_{i}\\ln(y_{i})-y_{i}-\\ln(y_{i}!)\\right].\n$$\n因此，偏差为\n$$\nD=2\\left(\\ell_{\\text{sat}}-\\ell_{\\text{fit}}\\right)=2\\sum_{i=1}^{3}\\left[y_{i}\\ln\\!\\left(\\frac{y_{i}}{5}\\right)-(y_{i}-5)\\right].\n$$\n代入 $y_{1}=2$、$y_{2}=5$、$y_{3}=8$ 可得\n$$\nD=2\\Big(2\\ln\\!\\left(\\frac{2}{5}\\right)-(2-5)+5\\ln\\!\\left(\\frac{5}{5}\\right)-(5-5)+8\\ln\\!\\left(\\frac{8}{5}\\right)-(8-5)\\Big).\n$$\n化简后可得\n$$\nD=2\\left(2\\ln\\!\\left(\\frac{2}{5}\\right)+8\\ln\\!\\left(\\frac{8}{5}\\right)\\right),\n$$\n因为 $5\\ln(1)=0$ 并且常数项 $+3$ 和 $-3$相互抵消。数值上，\n$$\n\\ln\\!\\left(\\frac{2}{5}\\right)\\approx -0.916290731874,\\qquad \\ln\\!\\left(\\frac{8}{5}\\right)\\approx 0.470003629246,\n$$\n所以\n$$\nD\\approx 2\\left[2(-0.916290731874)+8(0.470003629246)\\right]\\approx 3.854895140435\\ldots\n$$\n四舍五入到四位有效数字， $D\\approx 3.855$。没有一个 $y_i$ 为零，因此不需要对 $y_{i}\\ln(y_{i})$ 进行特殊处理。", "answer": "$$\\boxed{3.855}$$", "id": "1930961"}]}