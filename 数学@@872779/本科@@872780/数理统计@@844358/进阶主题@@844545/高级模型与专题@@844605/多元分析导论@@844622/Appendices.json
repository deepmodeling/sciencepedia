{"hands_on_practices": [{"introduction": "在多元分析中，协方差矩阵是基石，它不仅描述了单个变量的离散程度，更关键的是揭示了变量之间的线性关系。正如在单变量统计中计算方差一样，掌握如何从原始数据计算样本协方差矩阵是理解其背后含义的第一步。这项实践将通过一个简单直观的二维数据集，带你一步步手动计算协方差矩阵 [@problem_id:1924314]，让你对变量间的相互作用有一个具体而深刻的认识。", "problem": "一位农业科学家正在研究一种新的植物物种。他们收集了一个包含三株植物的小样本，记录了它们的高度（单位：厘米）和叶子数量的数据。测量结果以（高度，叶子数量）对的形式记录。这三个数据点被视为二维列向量，如下所示：\n$$ \\mathbf{x}_1 = \\begin{pmatrix} 1 \\\\ 4 \\end{pmatrix}, \\quad \\mathbf{x}_2 = \\begin{pmatrix} 2 \\\\ 7 \\end{pmatrix}, \\quad \\mathbf{x}_3 = \\begin{pmatrix} 6 \\\\ 1 \\end{pmatrix} $$\n假设这三个数据点代表来自一个更大总体的一个随机样本，计算这个二元数据集的无偏样本协方差矩阵 $S$。请将您的答案表示为一个 2x2 矩阵。", "solution": "要计算二元样本的无偏样本协方差矩阵，使用以下定义\n$$S=\\frac{1}{n-1}\\sum_{i=1}^{n}\\left(\\mathbf{x}_{i}-\\bar{\\mathbf{x}}\\right)\\left(\\mathbf{x}_{i}-\\bar{\\mathbf{x}}\\right)^{T},$$\n其中 $n$ 是样本大小，$\\bar{\\mathbf{x}}$ 是样本均值向量，由下式给出\n$$\\bar{\\mathbf{x}}=\\frac{1}{n}\\sum_{i=1}^{n}\\mathbf{x}_{i}.$$\n当 $n=3$ 且数据为 $\\mathbf{x}_{1}=\\begin{pmatrix}1\\\\4\\end{pmatrix}$，$\\mathbf{x}_{2}=\\begin{pmatrix}2\\\\7\\end{pmatrix}$，$\\mathbf{x}_{3}=\\begin{pmatrix}6\\\\1\\end{pmatrix}$ 时，均值向量为\n$$\\bar{\\mathbf{x}}=\\frac{1}{3}\\begin{pmatrix}1+2+6\\\\4+7+1\\end{pmatrix}=\\begin{pmatrix}3\\\\4\\end{pmatrix}.$$\n计算偏差：\n$$\\mathbf{d}_{1}=\\mathbf{x}_{1}-\\bar{\\mathbf{x}}=\\begin{pmatrix}-2\\\\0\\end{pmatrix},\\quad \\mathbf{d}_{2}=\\mathbf{x}_{2}-\\bar{\\mathbf{x}}=\\begin{pmatrix}-1\\\\3\\end{pmatrix},\\quad \\mathbf{d}_{3}=\\mathbf{x}_{3}-\\bar{\\mathbf{x}}=\\begin{pmatrix}3\\\\-3\\end{pmatrix}.$$\n计算外积：\n$$\\mathbf{d}_{1}\\mathbf{d}_{1}^{T}=\\begin{pmatrix} 4  0 \\\\ 0  0 \\end{pmatrix},\\quad \\mathbf{d}_{2}\\mathbf{d}_{2}^{T}=\\begin{pmatrix} 1  -3 \\\\ -3  9 \\end{pmatrix},\\quad \\mathbf{d}_{3}\\mathbf{d}_{3}^{T}=\\begin{pmatrix} 9  -9 \\\\ -9  9 \\end{pmatrix}.$$\n将它们相加：\n$$\\sum_{i=1}^{3}\\mathbf{d}_{i}\\mathbf{d}_{i}^{T}=\\begin{pmatrix}4+1+9  0-3-9 \\\\ 0-3-9  0+9+9\\end{pmatrix}=\\begin{pmatrix}14  -12\\\\-12  18\\end{pmatrix}.$$\n除以 $n-1=2$ 以获得无偏样本协方差矩阵：\n$$S=\\frac{1}{2}\\begin{pmatrix}14  -12\\\\-12  18\\end{pmatrix}=\\begin{pmatrix}7  -6\\\\-6  9\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}7  -6 \\\\ -6  9\\end{pmatrix}}$$", "id": "1924314"}, {"introduction": "计算出协方差矩阵后，我们如何解读它所蕴含的信息呢？协方差矩阵的数学性质，例如其行列式，能告诉我们关于数据集几何结构的深刻见解。这项实践是一个思想实验，旨在探讨当样本协方差矩阵的行列式为零时，背后隐藏的物理意义 [@problem_id:1924300]。通过这个练习，你将学会把一个抽象的代数性质（奇异矩阵）与一个具体的数据现象（多重共线性）联系起来，这对于理解数据冗余和降维至关重要。", "problem": "一位工程专业的学生正在分析一个新型机械臂的运动。该机械臂的末端执行器被设计为在三维空间中自由移动。为了描述其典型的操作空间，该学生收集了一个包含 $n$ 个位置测量值的大样本，其中每个测量值都是一个三维坐标向量 $\\mathbf{x}_i = (x_i, y_i, z_i)$，其中 $i=1, ..., n$。\n\n然后，该学生计算了这个数据集的 $3 \\times 3$ 样本协方差矩阵 $S$。完成计算后，他们惊讶地发现协方差矩阵的行列式恰好为零，即 $\\det(S) = 0$。假设该学生的计算是正确的，并且样本量 $n$ 大于3，以下哪项为这一结果提供了最准确和最普遍的解释？\n\nA. 所有收集到的数据点完全位于三维空间中的同一个平面或同一条直线上。\nB. 三个位置变量 $x$、$y$ 和 $z$ 相互不相关。\nC. 所有收集到的数据点都相同，即 $\\mathbf{x}_1 = \\mathbf{x}_2 = \\dots = \\mathbf{x}_n$。\nD. 数据的样本均值 $(\\bar{x}, \\bar{y}, \\bar{z})$ 必须是原点 $(0, 0, 0)$。\nE. 一定发生了计算错误，因为真实世界测量的样本协方差矩阵的行列式不可能是精确的零。", "solution": "设观测值排列为一个 $n \\times 3$ 矩阵 $X$ 的行，并设 $\\bar{\\mathbf{x}} \\in \\mathbb{R}^{3}$ 为样本均值。定义中心化数据矩阵 $X_{c} = X - \\mathbf{1}\\bar{\\mathbf{x}}^{\\top}$，其中 $\\mathbf{1} \\in \\mathbb{R}^{n}$ 是全为1的向量。这个 $3 \\times 3$ 的样本协方差矩阵是\n$$\nS = \\frac{1}{n-1} X_{c}^{\\top} X_{c}.\n$$\n这是一个格拉姆矩阵（Gram matrix），因此是对称半正定矩阵。条件 $\\det(S) = 0$ 等价于 $S$ 是奇异矩阵，这又等价于 $\\operatorname{rank}(S)  3$。\n\n由于 $S = \\frac{1}{n-1} X_{c}^{\\top} X_{c}$，S 的奇异性等价于 $\\operatorname{rank}(X_{c}^{\\top} X_{c})  3$，这又等价于 $\\operatorname{rank}(X_{c})  3$。等价地，存在一个非零向量 $v \\in \\mathbb{R}^{3}$ 使得\n$$\nS v = \\frac{1}{n-1} X_{c}^{\\top} X_{c} v = 0.\n$$\n由于 $v^{\\top} S v = \\frac{1}{n-1} \\| X_{c} v \\|^{2}$，等式 $S v = 0$ 意味着 $X_{c} v = 0$。逐行写出，对于每个 $i$，我们有\n$$\n(\\mathbf{x}_{i} - \\bar{\\mathbf{x}})^{\\top} v = 0,\n$$\n所以每个中心化的观测值都位于穿过原点且与 $v$ 正交的平面上。因此，原始观测值 $\\mathbf{x}_{i}$ 都位于仿射平面 $\\{\\bar{\\mathbf{x}} + w : v^{\\top} w = 0\\}$ 中。如果 $\\operatorname{rank}(X_{c}) = 2$，这是一个平面；如果 $\\operatorname{rank}(X_{c}) = 1$，这些点位于一条直线上；如果 $\\operatorname{rank}(X_{c}) = 0$，所有点都相同（一个点）。因此，最准确和最普遍的解释是，所有数据点都完全位于一个共同的平面或直线上（其中所有点相同的情况被视为一个退化的子情况）。\n\n对各选项的评估：\n- A是正确的：它精确地指出数据位于一个低维仿射子空间（一个平面或一条直线）中，这等价于 $\\operatorname{rank}(X_{c})  3$，因此 $\\det(S)=0$。\n- B是不正确的：相互不相关会使 $S$ 成为对角矩阵，但 $\\det(S)=0$ 并不意味着 $S$ 是对角矩阵；反之，一个具有正方差的对角矩阵 $S$ 会使得 $\\det(S) > 0$。\n- C的条件太强了：所有点相同确实意味着 $\\det(S)=0$，但反之不一定成立；数据可以在一个或两个方向上变化（直线或平面）而无需所有点都相同。\n- D是错误的：S 的行列式只依赖于中心化数据，并不会强制样本均值为原点。\n- E是错误的：只要坐标之间存在精确的线性相关性，就可能出现精确的奇异性，因此不一定是计算错误。\n\n因此，正确选项是A。", "answer": "$$\\boxed{A}$$", "id": "1924300"}, {"introduction": "我们已经学会了如何计算和解读协方差矩阵，现在是时候运用它来执行一项强大的分析技术了：主成分分析（PCA）。PCA的核心思想是利用数据的协方差结构，找到一组全新的、互不相关的变量（即主成分），这些新变量能够最大程度地保留原始数据的变异信息。这项实践将引导你完成一个标准的PCA流程 [@problem_id:1924285]：通过对协方差矩阵进行特征分解，找到一个正交变换，将相关的原始变量转化为一组不相关的、信息量集中的新变量。", "problem": "一位分析师正在研究一个关于两只股票每日收益率百分比的简化模型。这些收益由一个零均值随机向量 $\\mathbf{X} = \\begin{pmatrix} X_1 \\\\ X_2 \\end{pmatrix}$ 表示，其协方差矩阵为\n$$\n\\Sigma = \\begin{pmatrix} 13  -4 \\\\ -4  7 \\end{pmatrix}\n$$\n该分析师希望通过应用线性变换 $\\mathbf{Y} = \\mathbf{A} \\mathbf{X}$ 来构建一对新的变量，称为主成分，$\\mathbf{Y} = \\begin{pmatrix} Y_1 \\\\ Y_2 \\end{pmatrix}$，其中 $\\mathbf{A}$ 是一个 $2 \\times 2$ 的实矩阵。该变换必须满足以下三个条件：\n1.  新变量 $Y_1$ 和 $Y_2$ 必须不相关。\n2.  变换矩阵 $\\mathbf{A}$ 必须是正交矩阵。\n3.  为确保唯一解，$Y_1$ 的方差必须大于或等于 $Y_2$ 的方差，并且矩阵 $\\mathbf{A}$ 的每一行的第一个元素必须是非负的。\n\n求变换矩阵 $\\mathbf{A}$。", "solution": "我们寻找一个线性变换 $\\mathbf{Y}=\\mathbf{A}\\mathbf{X}$，其中 $\\mathbf{A}$ 是一个 $2\\times 2$ 的实矩阵，使得：\n- $Y_{1}$ 和 $Y_{2}$ 不相关，即 $\\operatorname{Cov}(\\mathbf{Y})=\\mathbf{A}\\Sigma\\mathbf{A}^{\\top}$ 是对角矩阵。\n- $\\mathbf{A}$ 是正交的，即 $\\mathbf{A}\\mathbf{A}^{\\top}=\\mathbf{I}$。\n- $\\operatorname{Var}(Y_{1})\\geq\\operatorname{Var}(Y_{2})$，并且 $\\mathbf{A}$ 的每一行的第一个元素是非负的。\n\n对于一个实对称协方差矩阵 $\\Sigma$，存在一个正交矩阵，其行是 $\\Sigma$ 的标准正交特征向量，这个矩阵可以正交对角化 $\\Sigma$。因此，我们选择 $\\mathbf{A}$ 的行作为 $\\Sigma$ 的标准正交特征向量，并按特征值从大到小的顺序排列，使得第一行对应较大的特征值。那么 $\\mathbf{A}\\Sigma\\mathbf{A}^{\\top}$ 就是一个对角矩阵，其对角线上的元素是特征值。\n\n通过特征方程计算 $\\Sigma=\\begin{pmatrix}13  -4 \\\\ -4  7\\end{pmatrix}$ 的特征值：\n$$\n\\det(\\Sigma-\\lambda \\mathbf{I})=\\det\\begin{pmatrix}13-\\lambda  -4 \\\\ -4  7-\\lambda\\end{pmatrix}\n=(13-\\lambda)(7-\\lambda)-16\n=\\lambda^{2}-20\\lambda+75=0.\n$$\n因此\n$$\n\\lambda_{1,2}=\\frac{20\\pm\\sqrt{400-300}}{2}=\\frac{20\\pm 10}{2},\n$$\n所以特征值为 $\\lambda_{1}=15$ 和 $\\lambda_{2}=5$，其中 $\\lambda_{1}\\lambda_{2}$。\n\n通过求解 $(\\Sigma-15\\mathbf{I})\\mathbf{v}=\\mathbf{0}$ 找到对应于 $\\lambda_{1}=15$ 的特征向量：\n$$\n\\begin{pmatrix}-2  -4 \\\\ -4  -8\\end{pmatrix}\\begin{pmatrix}x \\\\ y\\end{pmatrix}=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}\n\\implies -2x-4y=0 \\implies x=-2y.\n$$\n一个特征向量是 $\\begin{pmatrix}-2 \\\\ 1\\end{pmatrix}$。为了满足符号约定（第一个元素非负），乘以 $-1$ 得到 $\\begin{pmatrix}2 \\\\ -1\\end{pmatrix}$。归一化为单位长度：\n$$\n\\left\\|\\begin{pmatrix}2 \\\\ -1\\end{pmatrix}\\right\\|=\\sqrt{2^{2}+(-1)^{2}}=\\sqrt{5},\\quad\n\\mathbf{u}_{1}=\\begin{pmatrix}\\frac{2}{\\sqrt{5}} \\\\ -\\frac{1}{\\sqrt{5}}\\end{pmatrix}.\n$$\n\n对于 $\\lambda_{2}=5$，求解 $(\\Sigma-5\\mathbf{I})\\mathbf{v}=\\mathbf{0}$：\n$$\n\\begin{pmatrix}8  -4 \\\\ -4  2\\end{pmatrix}\\begin{pmatrix}x \\\\ y\\end{pmatrix}=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}\n\\implies 8x-4y=0 \\implies y=2x.\n$$\n一个特征向量是 $\\begin{pmatrix}1 \\\\ 2\\end{pmatrix}$，其第一个元素已经是-非负的。归一化：\n$$\n\\left\\|\\begin{pmatrix}1 \\\\ 2\\end{pmatrix}\\right\\|=\\sqrt{1^{2}+2^{2}}=\\sqrt{5},\\quad\n\\mathbf{u}_{2}=\\begin{pmatrix}\\frac{1}{\\sqrt{5}} \\\\ \\frac{2}{\\sqrt{5}}\\end{pmatrix}.\n$$\n\n选择这些标准正交特征向量作为 $\\mathbf{A}$ 的行，并按顺序排列，使得第一行对应于较大的特征值 $\\lambda_{1}=15$，以确保 $\\operatorname{Var}(Y_{1})\\geq\\operatorname{Var}(Y_{2})$。因此\n$$\n\\mathbf{A}=\\begin{pmatrix}\n\\frac{2}{\\sqrt{5}}  -\\frac{1}{\\sqrt{5}} \\\\\n\\frac{1}{\\sqrt{5}}  \\frac{2}{\\sqrt{5}}\n\\end{pmatrix}.\n$$\n这个矩阵 $\\mathbf{A}$ 是正交的（其行是标准正交的），每行的第一个元素都是非负的，并且可以得到\n$$\n\\operatorname{Cov}(\\mathbf{Y})=\\mathbf{A}\\Sigma\\mathbf{A}^{\\top}=\\begin{pmatrix}15  0 \\\\ 0  5\\end{pmatrix},\n$$\n因此 $Y_{1}$ 和 $Y_{2}$ 不相关，且 $\\operatorname{Var}(Y_{1})\\operatorname{Var}(Y_{2})$，符合要求。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{2}{\\sqrt{5}}  -\\frac{1}{\\sqrt{5}} \\\\ \\frac{1}{\\sqrt{5}}  \\frac{2}{\\sqrt{5}}\\end{pmatrix}}$$", "id": "1924285"}]}