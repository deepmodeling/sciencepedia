{"hands_on_practices": [{"introduction": "在我们可以最小化最大风险之前，我们必须首先熟练地计算风险函数本身。本练习将训练我们计算在平方误差损失下，两种不同估计量的风险。它突显了一个关键点：一个估计量的性能可能严重依赖于我们试图估计的参数的真实值，这也是极小化极大方法的根本动机。", "problem": "一位物理学家正在使用一个探测器来测量一个粒子的位置参数 $\\theta$，该参数可以是任意实数。记录了一次测量值 $X$。已知该探测器的响应函数是一个以真实位置 $\\theta$ 为中心、总宽度为 2 的均匀分布。也就是说，$X$ 是一个随机变量，其概率密度函数对应于 $U(\\theta - 1, \\theta + 1)$。\n\n提出了两种不同的算法来从测量值 $X$ 中生成估计值：\n1.  算法 A 使用估计量 $\\delta_A(X) = X$。\n2.  算法 B 使用估计量 $\\delta_B(X) = \\frac{3}{5}X$。\n\n对于一个特定的 $\\theta$ 值，估计量 $\\delta$ 的性能通过其风险 $R(\\theta, \\delta)$ 来评估，该风险定义为期望平方误差：\n$$R(\\theta, \\delta) = E_{\\theta}[(\\delta(X) - \\theta)^2]$$\n其中期望 $E_{\\theta}[\\cdot]$ 是关于 $X$ 的分布计算的。\n\n算法 A 的风险（我们称之为 $R_A$）是一个与 $\\theta$ 值无关的常数，而算法 B 的风险 $R_B(\\theta)$ 则依赖于 $\\theta$。找到位置参数的正值 $\\theta^*$，使得算法 B 的风险恰好是算法 A 风险的 5 倍。即，找到 $\\theta^* > 0$ 使得 $R_B(\\theta^*) = 5 R_A$。\n\n将您的答案表示为单个闭式解析表达式。", "solution": "问题要求我们找到 $\\theta$ 的正值，记为 $\\theta^*$，使得估计量 $\\delta_B(X)$ 的风险是估计量 $\\delta_A(X)$ 风险的 5 倍。\n\n首先，我们确定测量值 $X$ 的概率密度函数（PDF）。它服从区间 $[\\theta - 1, \\theta + 1]$ 上的均匀分布。该区间的长度为 $(\\theta + 1) - (\\theta - 1) = 2$。因此，概率密度函数 $f(x|\\theta)$ 为：\n$$ f(x|\\theta) = \\begin{cases} \\frac{1}{2}  \\text{若 } \\theta - 1 \\le x \\le \\theta + 1 \\\\ 0  \\text{其他} \\end{cases} $$\n\n风险定义为 $R(\\theta, \\delta) = E_{\\theta}[(\\delta(X) - \\theta)^2] = \\int_{-\\infty}^{\\infty} (\\delta(x) - \\theta)^2 f(x|\\theta) dx$。\n\n**第 1 步：计算算法 A 的风险 $R_A$。**\n算法 A 的估计量为 $\\delta_A(X) = X$。\n风险 $R_A(\\theta)$ 为：\n$$ R_A(\\theta) = \\int_{\\theta-1}^{\\theta+1} (x - \\theta)^2 \\frac{1}{2} dx $$\n为了简化积分，我们进行变量替换。令 $u = x - \\theta$。那么 $du = dx$。当 $x = \\theta - 1$ 时，$u = -1$。当 $x = \\theta + 1$ 时，$u = 1$。\n$$ R_A(\\theta) = \\frac{1}{2} \\int_{-1}^{1} u^2 du $$\n现在，我们计算该积分：\n$$ R_A(\\theta) = \\frac{1}{2} \\left[ \\frac{u^3}{3} \\right]_{-1}^{1} = \\frac{1}{2} \\left( \\frac{1^3}{3} - \\frac{(-1)^3}{3} \\right) = \\frac{1}{2} \\left( \\frac{1}{3} - (-\\frac{1}{3}) \\right) = \\frac{1}{2} \\left( \\frac{2}{3} \\right) = \\frac{1}{3} $$\n算法 A 的风险对于所有 $\\theta$ 都是常数。所以，$R_A = \\frac{1}{3}$。\n\n**第 2 步：计算算法 B 的风险 $R_B(\\theta)$。**\n算法 B 的估计量为 $\\delta_B(X) = \\frac{3}{5}X$。\n风险 $R_B(\\theta)$ 为：\n$$ R_B(\\theta) = \\int_{\\theta-1}^{\\theta+1} \\left(\\frac{3}{5}x - \\theta\\right)^2 \\frac{1}{2} dx $$\n我们展开被积函数中的平方项：\n$$ \\left(\\frac{3}{5}x - \\theta\\right)^2 = \\frac{9}{25}x^2 - \\frac{6}{5}x\\theta + \\theta^2 $$\n现在我们逐项对这个多项式进行积分：\n$$ R_B(\\theta) = \\frac{1}{2} \\int_{\\theta-1}^{\\theta+1} \\left(\\frac{9}{25}x^2 - \\frac{6}{5}x\\theta + \\theta^2\\right) dx $$\n$$ R_B(\\theta) = \\frac{1}{2} \\left[ \\frac{9}{25}\\frac{x^3}{3} - \\frac{6}{5}\\frac{x^2}{2}\\theta + \\theta^2 x \\right]_{\\theta-1}^{\\theta+1} $$\n$$ R_B(\\theta) = \\frac{1}{2} \\left[ \\frac{3}{25}x^3 - \\frac{3}{5}x^2\\theta + \\theta^2 x \\right]_{\\theta-1}^{\\theta+1} $$\n代入积分上下限：\n$$ R_B(\\theta) = \\frac{1}{2} \\left\\{ \\left(\\frac{3}{25}(\\theta+1)^3 - \\frac{3}{5}(\\theta+1)^2\\theta + \\theta^2(\\theta+1)\\right) - \\left(\\frac{3}{25}(\\theta-1)^3 - \\frac{3}{5}(\\theta-1)^2\\theta + \\theta^2(\\theta-1)\\right) \\right\\} $$\n我们使用恒等式 $(a+b)^n - (a-b)^n$：\n$(\\theta+1)^3 - (\\theta-1)^3 = (\\theta^3+3\\theta^2+3\\theta+1) - (\\theta^3-3\\theta^2+3\\theta-1) = 6\\theta^2+2$\n$(\\theta+1)^2 - (\\theta-1)^2 = (\\theta^2+2\\theta+1) - (\\theta^2-2\\theta+1) = 4\\theta$\n$(\\theta+1) - (\\theta-1) = 2$\n\n将这些代入 $R_B(\\theta)$ 的表达式中：\n$$ R_B(\\theta) = \\frac{1}{2} \\left\\{ \\frac{3}{25}(6\\theta^2+2) - \\frac{3}{5}(4\\theta)\\theta + \\theta^2(2) \\right\\} $$\n$$ R_B(\\theta) = \\frac{1}{2} \\left\\{ \\frac{18}{25}\\theta^2 + \\frac{6}{25} - \\frac{12}{5}\\theta^2 + 2\\theta^2 \\right\\} $$\n合并含有 $\\theta^2$ 的项：\n$$ R_B(\\theta) = \\frac{1}{2} \\left\\{ \\left(\\frac{18}{25} - \\frac{60}{25} + \\frac{50}{25}\\right)\\theta^2 + \\frac{6}{25} \\right\\} $$\n$$ R_B(\\theta) = \\frac{1}{2} \\left\\{ \\frac{8}{25}\\theta^2 + \\frac{6}{25} \\right\\} = \\frac{4}{25}\\theta^2 + \\frac{3}{25} $$\n\n**第 3 步：求解 $\\theta^*$。**\n我们要寻找 $\\theta^* > 0$ 使得 $R_B(\\theta^*) = 5 R_A$。\n代入我们求得的风险表达式：\n$$ \\frac{4}{25}(\\theta^*)^2 + \\frac{3}{25} = 5 \\times \\frac{1}{3} $$\n$$ \\frac{4}{25}(\\theta^*)^2 + \\frac{3}{25} = \\frac{5}{3} $$\n现在，我们求解 $(\\theta^*)^2$：\n$$ \\frac{4}{25}(\\theta^*)^2 = \\frac{5}{3} - \\frac{3}{25} $$\n为了进行分数减法，我们找到公分母，即 $3 \\times 25 = 75$。\n$$ \\frac{4}{25}(\\theta^*)^2 = \\frac{5 \\times 25}{75} - \\frac{3 \\times 3}{75} = \\frac{125 - 9}{75} = \\frac{116}{75} $$\n接下来，分离出 $(\\theta^*)^2$：\n$$ (\\theta^*)^2 = \\frac{116}{75} \\times \\frac{25}{4} $$\n我们可以简化这个表达式：$116 = 4 \\times 29$ 且 $75 = 3 \\times 25$。\n$$ (\\theta^*)^2 = \\frac{4 \\times 29}{3 \\times 25} \\times \\frac{25}{4} = \\frac{29}{3} $$\n问题要求的是正值 $\\theta^*$。\n$$ \\theta^* = \\sqrt{\\frac{29}{3}} $$\n这就是所要求的值的最终解析表达式。", "answer": "$$\\boxed{\\sqrt{\\frac{29}{3}}}$$", "id": "1935794"}, {"introduction": "如果一个估计量的风险对于参数的所有可能值都是一个常数，那么它就特别有吸引力，因为它保证了无论自然界的真实状态如何，其性能水平都相同。这样的估计量通常是极小化极大估计量的有力候选者。本问题 [@problem_id:1935795] 探讨了一种情况，其中一个标准估计量与一个精心选择的损失函数相结合，实现了这种理想的常数风险特性。", "problem": "一位群体遗传学家正在研究一个大的随机交配群体中，某个基因座上特定等位基因 'A' 的频率。等位基因 'A' 的真实但未知的频率用 $p$ 表示，其中 $0  p  1$。为了估计 $p$，这位遗传学家从群体中收集了一个包含 $n$ 个等位基因的随机样本，发现其中有 $X$ 个是 'A' 型。'A' 等位基因的数量 $X$ 可以被建模为一个服从参数为 $n$ 和 $p$ 的二项分布的随机变量。\n\n遗传学家使用样本比例 $\\hat{p} = X/n$ 作为 $p$ 的估计量。在该领域，通常使用一种考虑了内在群体方差的标准化损失函数来评估估计量。该损失函数由下式给出：\n$$L(p, a) = \\frac{(a-p)^2}{p(1-p)}$$\n其中 $a$ 是估计的等位基因频率。\n\n估计量 $\\hat{p}$ 的风险定义为损失函数的期望值，$R(p, \\hat{p}) = E[L(p, \\hat{p})]$。请确定估计量 $\\hat{p}$ 的风险函数。\n\nA. $R(p, \\hat{p}) = \\frac{1}{n^2}$\nB. $R(p, \\hat{p}) = \\frac{p(1-p)}{n}$\nC. $R(p, \\hat{p}) = \\frac{1}{n}$\nD. $R(p, \\hat{p}) = 1$\nE. $R(p, \\hat{p}) = \\frac{1}{n \\cdot p(1-p)}$", "solution": "我们已知群体等位基因频率参数 $p$ 满足 $0  p  1$。样本中 'A' 等位基因的数量 $X$ 服从二项分布 $B(n, p)$。$p$ 的估计量为 $\\hat{p} = X/n$。损失函数为 $L(p, a) = \\frac{(a-p)^2}{p(1-p)}$。\n\n估计量 $\\hat{p}$ 的风险函数 $R(p, \\hat{p})$ 是其损失的期望值：\n$$ R(p, \\hat{p}) = E\\left[L(p, \\hat{p})\\right] = E\\left[\\frac{(\\hat{p}-p)^2}{p(1-p)}\\right] $$\n由于分母 $p(1-p)$ 是一个关于 $p$ 的常数（对于给定的 $p$），我们可以将其移出期望算子：\n$$ R(p, \\hat{p}) = \\frac{1}{p(1-p)} E\\left[(\\hat{p}-p)^2\\right] $$\n$E\\left[(\\hat{p}-p)^2\\right]$ 的定义是估计量 $\\hat{p}$ 的均方误差（MSE）。我们知道 $E[X] = np$，所以 $E[\\hat{p}] = E[X/n] = (np)/n = p$。由于估计量是无偏的，其均方误差等于其方差：\n$$ E\\left[(\\hat{p}-p)^2\\right] = \\text{Var}(\\hat{p}) $$\n我们来计算 $\\hat{p}$ 的方差：\n$$ \\text{Var}(\\hat{p}) = \\text{Var}\\left(\\frac{X}{n}\\right) = \\frac{1}{n^2}\\text{Var}(X) $$\n对于二项分布 $B(n, p)$，方差 $\\text{Var}(X) = np(1-p)$。因此：\n$$ \\text{Var}(\\hat{p}) = \\frac{1}{n^2} [np(1-p)] = \\frac{p(1-p)}{n} $$\n最后，我们将此结果代入风险函数的表达式中：\n$$ R(p, \\hat{p}) = \\frac{1}{p(1-p)} \\times \\text{Var}(\\hat{p}) = \\frac{1}{p(1-p)} \\times \\frac{p(1-p)}{n} = \\frac{1}{n} $$\n风险函数 $R(p, \\hat{p}) = 1/n$，它是一个不依赖于参数 $p$ 的常数。\n\n因此，正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "1935795"}, {"introduction": "极小化极大原则的核心是选择一个能使最坏情况（最大）风险最小化的估计量。本练习通过比较均匀分布参数的两个估计量，将该原则直接付诸实践。我们将明确看到 [@problem_id:1935772]，如何通过修正一个标准估计量（最大似然估计量）来得到另一个具有更低最大风险的估计量，从而使其从极小化极大的角度来看更为可取。", "problem": "设 $X_1, X_2, \\dots, X_n$ 是来自区间 $[0, \\theta]$ 上连续均匀分布的一个随机样本，其中 $\\theta  0$ 是一个未知参数。参数 $\\theta$ 的估计量 $\\delta$ 的性能由缩放平方误差损失函数 $L(\\delta, \\theta) = \\left(\\frac{\\delta - \\theta}{\\theta}\\right)^2$ 来评估。估计量 $\\delta$ 的风险是其期望损失，由 $R(\\theta, \\delta) = E[L(\\delta, \\theta)]$ 给出。\n\n令 $X_{(n)}$ 表示样本中的最大值，即 $X_{(n)} = \\max\\{X_1, X_2, \\dots, X_n\\}$。\n\n考虑以下两个 $\\theta$ 的估计量：\n1.  $\\hat{\\theta}_1 = X_{(n)}$\n2.  $\\hat{\\theta}_2 = \\frac{n+2}{n+1} X_{(n)}$\n\n对于每个估计量 $\\hat{\\theta}_i$，其最大风险定义为 $R_{\\text{max}, i} = \\sup_{\\theta  0} R(\\theta, \\hat{\\theta}_i)$。\n\n计算比率 $\\frac{R_{\\text{max}, 2}}{R_{\\text{max}, 1}}$。你的最终答案应为一个用样本大小 $n$ 表示的闭式表达式。", "solution": "设 $X_{1},\\dots,X_{n}\\sim \\text{Uniform}(0,\\theta)$ 独立同分布，且 $X_{(n)}=\\max_{1\\leq i\\leq n}X_{i}$。对于形式为 $\\delta=cX_{(n)}$ 的估计量，其缩放平方误差损失为\n$$\nL(\\delta,\\theta)=\\left(\\frac{\\delta-\\theta}{\\theta}\\right)^{2}=\\left(c\\frac{X_{(n)}}{\\theta}-1\\right)^{2}.\n$$\n定义 $Y=X_{(n)}/\\theta$。$Y$ 的分布不依赖于 $\\theta$；实际上，$Y$ 的密度函数为 $f_{Y}(y)=n y^{n-1}$，$0\\leq y\\leq 1$（即 $Y\\sim \\text{Beta}(n,1)$）。因此风险为\n$$\nR(\\theta,cX_{(n)})=E\\left[\\left(cY-1\\right)^{2}\\right]=c^{2}E[Y^{2}]-2cE[Y]+1,\n$$\n该值与 $\\theta$ 无关，因此在 $\\theta0$ 上的最大值就等于这个常数值。\n\n计算 $Y$ 的矩：\n$$\nE[Y]=\\int_{0}^{1} y\\cdot n y^{n-1}\\,dy=n\\int_{0}^{1} y^{n}\\,dy=\\frac{n}{n+1},\n$$\n$$\nE[Y^{2}]=\\int_{0}^{1} y^{2}\\cdot n y^{n-1}\\,dy=n\\int_{0}^{1} y^{n+1}\\,dy=\\frac{n}{n+2}.\n$$\n因此，对于一般的 $c$，\n$$\nR(c)=c^{2}\\frac{n}{n+2}-2c\\frac{n}{n+1}+1.\n$$\n\n对于 $\\hat{\\theta}_{1}=X_{(n)}$，我们有 $c=1$，因此\n$$\nR_{\\text{max},1}=R(1)=\\frac{n}{n+2}-2\\frac{n}{n+1}+1=\\frac{2}{(n+1)(n+2)}.\n$$\n对于 $\\hat{\\theta}_{2}=\\frac{n+2}{n+1}X_{(n)}$，我们有 $c=\\frac{n+2}{n+1}$，因此\n$$\nR_{\\text{max},2}=R\\!\\left(\\frac{n+2}{n+1}\\right)=\\frac{n}{n+2}\\left(\\frac{n+2}{n+1}\\right)^{2}-2\\frac{n}{n+1}\\left(\\frac{n+2}{n+1}\\right)+1\n=1-\\frac{n(n+2)}{(n+1)^{2}}=\\frac{1}{(n+1)^{2}}.\n$$\n\n因此所求的比率为\n$$\n\\frac{R_{\\text{max},2}}{R_{\\text{max},1}}=\\frac{\\frac{1}{(n+1)^{2}}}{\\frac{2}{(n+1)(n+2)}}=\\frac{n+2}{2(n+1)}.\n$$", "answer": "$$\\boxed{\\frac{n+2}{2(n+1)}}$$", "id": "1935772"}]}