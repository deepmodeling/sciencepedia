{"hands_on_practices": [{"introduction": "理论是根基，但真正的理解始于实践。本节的练习将带你动手计算和推导自相关函数，从而加深对时间序列结构和动态的理解。我们从最基本的技能开始：根据一组观测数据计算样本自相关函数。这个练习 [@problem_id:1897249] 模拟了数据分析的第一步，即通过探索性分析来初步判断数据中是否存在时间依赖性。", "problem": "考虑一个表示四个连续观测值的离散时间序列，由序列 $\\{X_t\\}_{t=1}^4 = \\{2, 8, 4, 10\\}$ 给出。为了本次计算，你需要假设生成此数据的过程的真实均值为零，因此，样本均值 $\\bar{X}$ 应取为 0。\n\n对于一个样本均值为 $\\bar{X}$ 的时间序列 $\\{X_t\\}_{t=1}^n$，其在给定滞后 $h$ 时的样本自相关函数 (ACF) 定义为：\n$$r_h = \\frac{\\sum_{t=1}^{n-h} (X_t - \\bar{X})(X_{t+h} - \\bar{X})}{\\sum_{t=1}^{n} (X_t - \\bar{X})^2}$$\n你的任务是计算所提供的时间序列在滞后 $h=1$ 时的样本自相关函数的值。\n\n将你的最终答案表示为最简分数形式。", "solution": "我们已知时间序列为 $\\{X_{t}\\}_{t=1}^{4}=\\{2,8,4,10\\}$，并被告知取 $\\bar{X}=0$。滞后 $h=1$ 时的样本自相关函数定义为\n$$\nr_{1}=\\frac{\\sum_{t=1}^{n-1}\\left(X_{t}-\\bar{X}\\right)\\left(X_{t+1}-\\bar{X}\\right)}{\\sum_{t=1}^{n}\\left(X_{t}-\\bar{X}\\right)^{2}}.\n$$\n当 $\\bar{X}=0$ 且 $n=4$ 时，分子为\n$$\n\\sum_{t=1}^{3}X_{t}X_{t+1}=X_{1}X_{2}+X_{2}X_{3}+X_{3}X_{4}=2\\cdot 8+8\\cdot 4+4\\cdot 10=16+32+40=88.\n$$\n分母为\n$$\n\\sum_{t=1}^{4}X_{t}^{2}=2^{2}+8^{2}+4^{2}+10^{2}=4+64+16+100=184.\n$$\n因此，\n$$\nr_{1}=\\frac{88}{184}.\n$$\n将分子和分母同除以 $8$ 来化简分数，得到\n$$\nr_{1}=\\frac{11}{23}.\n$$", "answer": "$$\\boxed{\\frac{11}{23}}$$", "id": "1897249"}, {"introduction": "在掌握了如何从样本数据中估计自相关性之后，我们转向理论模型。在实践中，我们通常会假设数据由某个随机过程生成，并研究该过程的理论性质。这个练习 [@problem_id:1897209] 将向你介绍移动平均（MA）模型——一种基本的时间序列模型，并要求你计算其理论自相关函数。通过这个过程，你将理解MA模型的“短期记忆”特性是如何体現在其自相关函数（ACF）上的。", "problem": "一位金融分析师正在使用一个简单的时间序列模型来模拟某种商品价格的每日变化。第 $t$ 天的价格变化模型，记为 $X_t$，由一个1阶移动平均过程 MA(1) 给出：\n$$X_t = \\epsilon_t + 0.8 \\epsilon_{t-1}$$\n这里，$\\epsilon_t$ 代表在第 $t$ 天到达的“冲击”或新信息。冲击序列 $\\{\\epsilon_t\\}$ 被假定为一个具有以下性质的白噪声过程：\n1. 任何冲击的期望值为零，即对所有 $t$ 都有 $E[\\epsilon_t] = 0$。\n2. 任何冲击的方差是一个恒定的有限值 $\\sigma^2$，即对所有 $t$ 都有 $Var(\\epsilon_t) = \\sigma^2$。\n3. 不同时间的冲击是不相关的，即对所有 $t \\neq s$ 都有 $Cov(\\epsilon_t, \\epsilon_s) = 0$。\n\n滞后 $k$ 阶的理论自相关函数 (ACF)，记为 $\\rho(k)$，衡量时间序列与其 $k$ 个周期前的值之间的相关性。其定义为：\n$$\\rho(k) = \\frac{\\gamma(k)}{\\gamma(0)}$$\n其中 $\\gamma(k) = Cov(X_t, X_{t-k})$ 是滞后 $k$ 阶的自协方差函数，而 $\\gamma(0) = Var(X_t)$ 是该过程的方差。\n\n计算该模型的滞后1阶理论自相关 $\\rho(1)$。将您的答案表示为最简形式的精确分数。", "solution": "给定 MA(1) 过程 $X_{t}=\\epsilon_{t}+\\theta\\,\\epsilon_{t-1}$，其中 $\\theta=\\frac{4}{5}$，且 $\\{\\epsilon_{t}\\}$ 是白噪声，满足 $E[\\epsilon_{t}]=0$，$Var(\\epsilon_{t})=\\sigma^{2}$，以及对于 $t\\neq s$ 有 $Cov(\\epsilon_{t},\\epsilon_{s})=0$。滞后 $k$ 阶的自相关为 $\\rho(k)=\\frac{\\gamma(k)}{\\gamma(0)}$，其中 $\\gamma(k)=Cov(X_{t},X_{t-k})$。\n\n首先计算方差 $\\gamma(0)=Var(X_{t})$。使用 $Var(aY+bZ)=a^{2}Var(Y)+b^{2}Var(Z)+2ab\\,Cov(Y,Z)$ 和白噪声的性质，\n$$\n\\gamma(0)=Var(\\epsilon_{t}+\\theta\\,\\epsilon_{t-1})=Var(\\epsilon_{t})+\\theta^{2}Var(\\epsilon_{t-1})+2\\theta\\,Cov(\\epsilon_{t},\\epsilon_{t-1}).\n$$\n由于 $Cov(\\epsilon_{t},\\epsilon_{t-1})=0$，这可以简化为\n$$\n\\gamma(0)=(1+\\theta^{2})\\sigma^{2}=\\left(1+\\left(\\frac{4}{5}\\right)^{2}\\right)\\sigma^{2}=\\left(1+\\frac{16}{25}\\right)\\sigma^{2}=\\frac{41}{25}\\sigma^{2}.\n$$\n\n接下来计算滞后-1自协方差 $\\gamma(1)=Cov(X_{t},X_{t-1})$。使用 $X_{t-1}=\\epsilon_{t-1}+\\theta\\,\\epsilon_{t-2}$，\n$$\n\\gamma(1)=Cov(\\epsilon_{t}+\\theta\\,\\epsilon_{t-1},\\,\\epsilon_{t-1}+\\theta\\,\\epsilon_{t-2}).\n$$\n将协方差进行双线性展开，\n$$\n\\gamma(1)=Cov(\\epsilon_{t},\\epsilon_{t-1})+\\theta\\,Cov(\\epsilon_{t},\\epsilon_{t-2})+\\theta\\,Cov(\\epsilon_{t-1},\\epsilon_{t-1})+\\theta^{2}Cov(\\epsilon_{t-1},\\epsilon_{t-2}).\n$$\n根据白噪声的性质，$Cov(\\epsilon_{t},\\epsilon_{t-1})=0$，$Cov(\\epsilon_{t},\\epsilon_{t-2})=0$ 和 $Cov(\\epsilon_{t-1},\\epsilon_{t-2})=0$，而 $Cov(\\epsilon_{t-1},\\epsilon_{t-1})=Var(\\epsilon_{t-1})=\\sigma^{2}$。因此\n$$\n\\gamma(1)=\\theta\\,\\sigma^{2}=\\frac{4}{5}\\sigma^{2}.\n$$\n\n所以，滞后-1自相关为\n$$\n\\rho(1)=\\frac{\\gamma(1)}{\\gamma(0)}=\\frac{\\frac{4}{5}\\sigma^{2}}{\\frac{41}{25}\\sigma^{2}}=\\frac{4}{5}\\cdot\\frac{25}{41}=\\frac{20}{41}.\n$$\n此分数已为最简形式。", "answer": "$$\\boxed{\\frac{20}{41}}$$", "id": "1897209"}, {"introduction": "除了移动平均模型，自回归（AR）模型是时间序列分析的另一块基石。与MA模型不同，AR模型中一个序列的当前值直接依赖于其自身的过去值。这个练习 [@problem_id:1897219] 挑战你使用著名的Yule-Walker方程来推导AR(2)模型的自相关函数。这不仅能让你掌握分析更复杂依赖关系的系统方法，还能揭示模型参数 $\\phi_1$ 和 $\\phi_2$ 是如何共同决定序列的动态行为的。", "problem": "考虑一个由二阶自回归模型（AR(2)）描述的平稳时间序列过程 $\\{X_t\\}$。该模型由以下方程定义：\n$$X_t = \\phi_1 X_{t-1} + \\phi_2 X_{t-2} + \\epsilon_t$$\n其中 $\\phi_1$ 和 $\\phi_2$ 是模型的常数参数，$\\{\\epsilon_t\\}$ 是一个均值为零、方差为常数 $\\sigma^2_{\\epsilon}$ 的白噪声过程。同样假设过程 $\\{X_t\\}$ 的均值为零。\n\n令 $\\rho(k)$ 表示该过程在滞后 $k$ 时的自相关函数。推导滞后为 1 时的自相关 $\\rho(1)$ 的表达式，该表达式仅用模型参数 $\\phi_1$ 和 $\\phi_2$ 表示。", "solution": "平稳 AR(2) 过程由以下方程给出：\n$$X_t = \\phi_1 X_{t-1} + \\phi_2 X_{t-2} + \\epsilon_t$$\n滞后 $k$ 时的自协方差函数，记为 $\\gamma(k)$，定义为 $\\gamma(k) = E[X_t X_{t-k}]$。由于过程均值为零，我们不需要减去它。自相关函数为 $\\rho(k) = \\frac{\\gamma(k)}{\\gamma(0)}$。\n\n尤尔-沃克方程是通过将 AR(2) 方程两边同乘以 $X_{t-k}$（对于 $k  0$）然后取期望得到的：\n$$E[X_t X_{t-k}] = E[(\\phi_1 X_{t-1} + \\phi_2 X_{t-2} + \\epsilon_t) X_{t-k}]$$\n利用期望的线性性质，我们得到：\n$$E[X_t X_{t-k}] = \\phi_1 E[X_{t-1} X_{t-k}] + \\phi_2 E[X_{t-2} X_{t-k}] + E[\\epsilon_t X_{t-k}]$$\n\n根据定义，$E[X_t X_{t-k}] = \\gamma(k)$，并且根据平稳性，$E[X_{t-1} X_{t-k}] = \\gamma(k-1)$ 且 $E[X_{t-2} X_{t-k}] = \\gamma(k-2)$。\n\n对于 $k  0$，项 $X_{t-k}$ 仅依赖于白噪声过程 $\\{\\epsilon_s\\}_{s \\le t-k}$ 的过去值。由于 $\\epsilon_t$ 是一个白噪声项，它与过程的所有过去值都不相关。因此，对于 $k  0$，$E[\\epsilon_t X_{t-k}] = 0$。\n\n将这些代入方程，我们得到 AR(2) 过程的自协方差的尤尔-沃克方程（对于 $k0$）：\n$$\\gamma(k) = \\phi_1 \\gamma(k-1) + \\phi_2 \\gamma(k-2)$$\n\n为了得到以自相关表示的方程，我们将整个方程除以过程的方差 $\\gamma(0)$：\n$$\\frac{\\gamma(k)}{\\gamma(0)} = \\phi_1 \\frac{\\gamma(k-1)}{\\gamma(0)} + \\phi_2 \\frac{\\gamma(k-2)}{\\gamma(0)}$$\n这就得到了自相关函数（ACF）的尤尔-沃克方程（对于 $k0$）：\n$$\\rho(k) = \\phi_1 \\rho(k-1) + \\phi_2 \\rho(k-2)$$\n\n题目要求我们求 $\\rho(1)$ 的表达式。我们可以在上述方程中令 $k=1$：\n$$\\rho(1) = \\phi_1 \\rho(1-1) + \\phi_2 \\rho(1-2)$$\n$$\\rho(1) = \\phi_1 \\rho(0) + \\phi_2 \\rho(-1)$$\n\n根据定义，滞后为 0 的自相关为 $\\rho(0) = \\frac{\\gamma(0)}{\\gamma(0)} = 1$。自相关函数是一个偶函数，即 $\\rho(-k) = \\rho(k)$。因此，$\\rho(-1) = \\rho(1)$。\n\n将这些性质代回关于 $\\rho(1)$ 的方程中：\n$$\\rho(1) = \\phi_1 (1) + \\phi_2 \\rho(1)$$\n现在，我们可以解出 $\\rho(1)$：\n$$\\rho(1) - \\phi_2 \\rho(1) = \\phi_1$$\n$$\\rho(1) (1 - \\phi_2) = \\phi_1$$\n$$\\rho(1) = \\frac{\\phi_1}{1 - \\phi_2}$$\n这就是用模型参数表示的滞后为 1 时的自相关表达式。", "answer": "$$\\boxed{\\frac{\\phi_1}{1 - \\phi_2}}$$", "id": "1897219"}]}