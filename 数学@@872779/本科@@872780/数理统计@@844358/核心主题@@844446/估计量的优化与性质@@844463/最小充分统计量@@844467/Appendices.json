{"hands_on_practices": [{"introduction": "让我们从一个基本例子开始，这个例子来自一个离散型分布。通过分析为获得首次成功所需的试验次数，我们将练习如何应用因子分解定理来识别关于成功概率 $p$ 的所有信息是如何被压缩到一个单一的数值中的。这个练习 [@problem_id:1935626] 是理解数据降维核心思想的绝佳起点。", "problem": "设 $X_1, X_2, \\ldots, X_n$ 是一个样本量为 $n$ 的随机样本，来自一个描述独立伯努利试验序列中首次成功所需试验次数的分布。这些随机变量是独立同分布的（i.i.d.）。任何单次试验的成功概率为 $p$，其中 $0  p  1$。每个 $X_i$ 的概率质量函数（PMF）由下式给出：\n$$f(x; p) = (1-p)^{x-1} p, \\quad \\text{对于 } x = 1, 2, 3, \\ldots$$\n求参数 $p$ 的一个最小充分统计量。将您的答案表示为样本观测值 $x_1, x_2, \\ldots, x_n$ 的函数。", "solution": "为了找到参数 $p$ 的最小充分统计量，我们首先使用费雪-奈曼分解定理找到一个充分统计量，然后证明其最小性。\n\n设 $\\mathbf{x} = (x_1, x_2, \\ldots, x_n)$ 表示随机样本 $\\mathbf{X} = (X_1, X_2, \\ldots, X_n)$ 的一个观测结果。第一步是写出样本的联合概率质量函数（PMF），也称为似然函数 $L(p; \\mathbf{x})$。由于随机变量 $X_i$ 是独立同分布的，联合 PMF 是各个 PMF 的乘积：\n$$L(p; \\mathbf{x}) = \\prod_{i=1}^{n} f(x_i; p) = \\prod_{i=1}^{n} \\left( (1-p)^{x_i-1} p \\right)$$\n我们可以通过将包含 $p$ 和 $(1-p)$ 的项组合在一起来简化此表达式：\n$$L(p; \\mathbf{x}) = \\left( \\prod_{i=1}^{n} (1-p)^{x_i-1} \\right) \\left( \\prod_{i=1}^{n} p \\right)$$\n使用指数和乘积的性质，上式变为：\n$$L(p; \\mathbf{x}) = (1-p)^{\\sum_{i=1}^{n} (x_i-1)} p^n$$\n$$L(p; \\mathbf{x}) = (1-p)^{(\\sum_{i=1}^{n} x_i) - n} p^n$$\n费雪-奈曼分解定理指出，一个统计量 $T(\\mathbf{X})$ 是参数 $\\theta$ 的充分统计量，当且仅当似然函数可以分解为两个非负函数 $g(T(\\mathbf{x}); \\theta)$ 和 $h(\\mathbf{x})$ 的乘积，使得 $L(\\theta; \\mathbf{x}) = g(T(\\mathbf{x}); \\theta) \\cdot h(\\mathbf{x})$。这里，函数 $g$ 仅通过统计量 $T(\\mathbf{x})$ 依赖于数据 $\\mathbf{x}$，而函数 $h$ 仅依赖于数据 $\\mathbf{x}$ 而不依赖于参数 $\\theta$。\n\n在本例中，我们可以确定这些函数为：\n$$g(T(\\mathbf{x}); p) = (1-p)^{(\\sum_{i=1}^{n} x_i) - n} p^n$$\n$$h(\\mathbf{x}) = 1$$\n函数 $g$ 仅通过和 $\\sum_{i=1}^{n} x_i$ 依赖于数据 $\\mathbf{x}$。因此，根据因子分解定理，统计量 $T(\\mathbf{X}) = \\sum_{i=1}^{n} X_i$ 是 $p$ 的一个充分统计量。\n\n接下来，我们必须验证这个统计量是否是最小的。一个充分统计量 $T(\\mathbf{X})$ 是最小的，如果对于任意两个样本点 $\\mathbf{x}$ 和 $\\mathbf{y}$，似然函数的比率 $L(p; \\mathbf{x}) / L(p; \\mathbf{y})$ 作为一个关于 $p$ 的函数是常数，当且仅当 $T(\\mathbf{x}) = T(\\mathbf{y})$。\n\n让我们为两个样本点 $\\mathbf{x} = (x_1, \\ldots, x_n)$ 和 $\\mathbf{y} = (y_1, \\ldots, y_n)$ 计算这个比率：\n$$\\frac{L(p; \\mathbf{x})}{L(p; \\mathbf{y})} = \\frac{(1-p)^{(\\sum_{i=1}^{n} x_i) - n} p^n}{(1-p)^{(\\sum_{i=1}^{n} y_i) - n} p^n}$$\n$p^n$ 项消去，我们可以合并以 $(1-p)$ 为底的项：\n$$\\frac{L(p; \\mathbf{x})}{L(p; \\mathbf{y})} = (1-p)^{(\\sum_{i=1}^{n} x_i) - n - ((\\sum_{i=1}^{n} y_i) - n)}$$\n$$\\frac{L(p; \\mathbf{x})}{L(p; \\mathbf{y})} = (1-p)^{(\\sum_{i=1}^{n} x_i) - (\\sum_{i=1}^{n} y_i)}$$\n为了使这个比率成为一个不依赖于参数 $p$ 的常数，$(1-p)$ 的指数必须为零。这是因为如果指数非零，表达式的值会随着 $p$ 在其定义域 $(0,1)$ 内的变化而变化。\n指数为零当且仅当：\n$$(\\sum_{i=1}^{n} x_i) - (\\sum_{i=1}^{n} y_i) = 0$$\n这等价于：\n$$\\sum_{i=1}^{n} x_i = \\sum_{i=1}^{n} y_i$$\n这正是条件 $T(\\mathbf{x}) = T(\\mathbf{y})$。由于似然比与 $p$ 无关当且仅当 $T(\\mathbf{x}) = T(\\mathbf{y})$，我们得出结论，统计量 $T(\\mathbf{X}) = \\sum_{i=1}^{n} X_i$ 是 $p$ 的一个最小充分统计量。\n\n问题要求将统计量表示为样本观测值的函数，即 $T(\\mathbf{x}) = \\sum_{i=1}^{n} x_i$。", "answer": "$$\\boxed{\\sum_{i=1}^{n} x_{i}}$$", "id": "1935626"}, {"introduction": "并非所有问题都能简化为单一的汇总统计量。这个练习 [@problem_id:1935627] 探讨了一个更微妙的情景：当分布的支撑集（即可能取值的范围）本身依赖于未知参数 $\\theta$ 时。我们将发现，为了完整地保留关于 $\\theta$ 的信息，我们需要不止一个样本值，这突显了样本的极值（最大值和最小值）在某些推断问题中的关键作用。", "problem": "一位质量控制工程师正在分析一个生产高精度金属棒的制造过程。每根金属棒的长度被建模为一个服从区间 $[\\theta, 2\\theta]$ 上均匀分布的随机变量，其中参数 $\\theta  0$ 是机器当前校准的一个未知特性。为了监测和估计 $\\theta$，工程师收集了一个由 $n$ 根金属棒长度组成的随机样本，记为 $X_1, X_2, \\dots, X_n$。\n\n为了在不丢失关于参数 $\\theta$ 的信息的情况下有效地总结数据，工程师需要计算一个最小充分统计量。令 $X_{(1)}$ 为样本中的最小值（第一顺序统计量），$X_{(n)}$ 为样本中的最大值（最后顺序统计量）。\n\n以下哪项代表参数 $\\theta$ 的最小充分统计量？\n\nA. $X_{(n)}$\n\nB. $\\frac{X_{(1)}}{X_{(n)}}$\n\nC. $(X_{(1)}, X_{(n)})$\n\nD. $X_{(1)} + X_{(n)}$\n\nE. $X_{(n)} - X_{(1)}$\n\nF. $\\frac{1}{n} \\sum_{i=1}^{n} X_i$", "solution": "设 $X_{1},\\dots,X_{n}$ 是独立同分布的，其密度函数为\n$$\nf(x\\mid \\theta)=\\frac{1}{\\theta}\\,\\mathbf{1}\\{\\theta \\leq x \\leq 2\\theta\\},\\quad \\theta0.\n$$\n对于一个样本 $\\mathbf{x}=(x_{1},\\dots,x_{n})$，其联合密度函数为\n$$\nf(\\mathbf{x}\\mid \\theta)=\\prod_{i=1}^{n}\\frac{1}{\\theta}\\,\\mathbf{1}\\{\\theta \\leq x_{i} \\leq 2\\theta\\}\n=\\theta^{-n}\\,\\mathbf{1}\\{\\theta \\leq x_{(1)}\\}\\,\\mathbf{1}\\{2\\theta \\geq x_{(n)}\\}.\n$$\n等价地，\n$$\nf(\\mathbf{x}\\mid \\theta)=\\theta^{-n}\\,\\mathbf{1}\\left\\{\\frac{x_{(n)}}{2} \\leq \\theta \\leq x_{(1)}\\right\\}.\n$$\n这表明似然函数仅通过 $(x_{(1)},x_{(n)})$ 依赖于数据。定义 $T(\\mathbf{x})=(x_{(1)},x_{(n)})$。那么我们可以写出\n$$\nf(\\mathbf{x}\\mid \\theta)=g(T(\\mathbf{x}),\\theta)\\,h(\\mathbf{x}),\n$$\n其中 $g((a,b),\\theta)=\\theta^{-n}\\,\\mathbf{1}\\{b/2 \\leq \\theta \\leq a\\}$ 且 $h(\\mathbf{x})=1$。根据费雪-奈曼分解定理，$T=(X_{(1)},X_{(n)})$ 是 $\\theta$ 的充分统计量。\n\n为了确定其最小充分性，我们使用莱曼-谢费准则：$T$ 是最小充分的，如果对于任意两个样本 $\\mathbf{x}$ 和 $\\mathbf{y}$，\n$$\n\\frac{f(\\mathbf{x}\\mid \\theta)}{f(\\mathbf{y}\\mid \\theta)} \\text{ 与 } \\theta \\text{ 无关 } \\quad \\Longleftrightarrow \\quad T(\\mathbf{x})=T(\\mathbf{y}).\n$$\n计算\n$$\n\\frac{f(\\mathbf{x}\\mid \\theta)}{f(\\mathbf{y}\\mid \\theta)}=\\frac{\\theta^{-n}\\,\\mathbf{1}\\{x_{(n)}/2 \\leq \\theta \\leq x_{(1)}\\}}{\\theta^{-n}\\,\\mathbf{1}\\{y_{(n)}/2 \\leq \\theta \\leq y_{(1)}\\}}=\\frac{\\mathbf{1}\\{x_{(n)}/2 \\leq \\theta \\leq x_{(1)}\\}}{\\mathbf{1}\\{y_{(n)}/2 \\leq \\theta \\leq y_{(1)}\\}}.\n$$\n这个比率与 $\\theta$ 无关当且仅当对于所有的 $\\theta$（在测度为零的集合上除外），指示函数都相同，这发生当且仅当区间 $[x_{(n)}/2,x_{(1)}]$ 和 $[y_{(n)}/2,y_{(1)}]$ 完全相同。这等价于 $x_{(1)}=y_{(1)}$ 且 $x_{(n)}=y_{(n)}$，即 $T(\\mathbf{x})=T(\\mathbf{y})$。因此，$T=(X_{(1)},X_{(n)})$ 是最小充分统计量。\n\n在给定的选项中，只有选项 C 同时包含了 $X_{(1)}$ 和 $X_{(n)}$，因此最小充分统计量是 $(X_{(1)},X_{(n)})$。", "answer": "$$\\boxed{C}$$", "id": "1935627"}, {"introduction": "最小充分统计量的概念在科学建模中具有强大的应用价值。在这个源于群体遗传学哈代-温伯格平衡模型的练习 [@problem_id:1935612] 中，我们将处理多项分布的数据。这个例子不仅展示了如何将理论应用于更复杂的多元情景，还揭示了最终得到的统计量 $2N_1 + N_2$ 如何拥有一个清晰且直观的生物学解释，体现了统计洞察力与科学原理的完美结合。", "problem": "在群体遗传学中，一个基本概念是哈代-温伯格平衡，它描述了一个不进化的群体的遗传构成。对于一个具有两个等位基因 A 和 a 的基因，设群体中等位基因 A 的频率为 $\\theta$，等位基因 a 的频率为 $1-\\theta$，其中参数 $\\theta$ 位于区间 $(0, 1)$ 内。根据哈代-温伯格原理，三种可能的基因型——AA、Aa 和 aa——的期望频率分别为 $\\theta^2$、$2\\theta(1-\\theta)$ 和 $(1-\\theta)^2$。\n\n一位遗传学家从这个大群体中收集了一个包含 $n$ 个个体的随机样本，以估计等位基因频率 $\\theta$。设样本中基因型为 AA 的个体数量为 $N_1$，基因型为 Aa 的个体数量为 $N_2$，基因型为 aa 的个体数量为 $N_3$。总样本量为 $n = N_1 + N_2 + N_3$。观测计数向量 $(N_1, N_2, N_3)$ 可以被建模为从多项分布中的一次抽取。\n\n根据观测到的计数 $(N_1, N_2, N_3)$，确定参数 $\\theta$ 的一个最小充分统计量。你的答案应该是一个用 $N_1$、$N_2$ 和 $N_3$ 表示的表达式。", "solution": "设在哈代-温伯格平衡下，基因型 AA 的概率为 $p_{1}=\\theta^{2}$，基因型 Aa 的概率为 $p_{2}=2\\theta(1-\\theta)$，基因型 aa 的概率为 $p_{3}=(1-\\theta)^{2}$。对于固定的总数 $n=N_{1}+N_{2}+N_{3}$ 的观测计数 $(N_{1},N_{2},N_{3})$，在多项模型下的联合概率质量函数为\n$$\nf_{\\theta}(N_{1},N_{2},N_{3})=\\frac{n!}{N_{1}!N_{2}!N_{3}!}\\left(\\theta^{2}\\right)^{N_{1}}\\left(2\\theta(1-\\theta)\\right)^{N_{2}}\\left((1-\\theta)^{2}\\right)^{N_{3}}.\n$$\n这可以简化为\n$$\nf_{\\theta}(N_{1},N_{2},N_{3})=\\frac{n!}{N_{1}!N_{2}!N_{3}!}\\,2^{N_{2}}\\,\\theta^{2N_{1}+N_{2}}(1-\\theta)^{2N_{3}+N_{2}}.\n$$\n根据费雪-奈曼分解定理，当 $n$ 固定且已知时，我们可以将似然函数写作\n$$ f_{\\theta}(N_{1},N_{2},N_{3})= g(T, \\theta) \\cdot h(N_1, N_2, N_3) $$\n其中 $T=2N_{1}+N_{2}$，$h(N_1, N_2, N_3) = \\frac{n!}{N_{1}!N_{2}!N_{3}!}\\,2^{N_{2}}$，以及 $g(T, \\theta) = \\theta^{2N_{1}+N_{2}}(1-\\theta)^{2N_{3}+N_{2}}$。由于 $2N_3+N_2 = 2n-T$，我们可以看到 $g$ 仅是 $T$ 和 $\\theta$ 的函数。因此，$T=2N_{1}+N_{2}$ 是 $\\theta$ 的一个充分统计量。\n\n为了证明最小充分性，使用莱曼-谢费准则：对于两个具有相同 $n$ 的结果 $(n_{1},n_{2},n_{3})$ 和 $(m_{1},m_{2},m_{3})$，考虑\n$$\n\\frac{f_{\\theta}(n_{1},n_{2},n_{3})}{f_{\\theta}(m_{1},m_{2},m_{3})}\n=\\frac{\\frac{n!}{n_{1}!n_{2}!n_{3}!}2^{n_{2}}\\theta^{2n_{1}+n_{2}}(1-\\theta)^{2n_{3}+n_{2}}}{\\frac{n!}{m_{1}!m_{2}!m_{3}!}2^{m_{2}}\\theta^{2m_{1}+m_{2}}(1-\\theta)^{2m_{3}+m_{2}}}\n=C(n,m)\\left(\\frac{\\theta}{1-\\theta}\\right)^{(2n_{1}+n_{2})-(2m_{1}+m_{2})},\n$$\n其中 $C(n,m)$ 不含 $\\theta$。该比率与 $\\theta$ 无关，当且仅当 $2n_{1}+n_{2}=2m_{1}+m_{2}$。因此，由该分布族导出的等价类正是那些具有相同 $T=2N_{1}+N_{2}$ 值的类，这证明了 $T$ 是最小充分的。\n\n因此，$\\theta$ 的一个最小充分统计量是样本中 A 等位基因的总数，即 $2N_{1}+N_{2}$。", "answer": "$$\\boxed{2N_{1}+N_{2}}$$", "id": "1935612"}]}