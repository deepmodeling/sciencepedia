{"hands_on_practices": [{"introduction": "我们从一个大家都很熟悉的分布——正态分布——开始。这个练习是基础性的：它要求我们将正态分布的概率密度函数（PDF）重写为指数族的标准形式。这项实践不仅仅是代数上的变形；它揭示了这种形式如何自然地分离出参数的影响，并引出充分统计量的概念，这是统计推断的基石。[@problem_id:1960374]", "problem": "如果一个随机变量 $X$ 的概率密度函数 (PDF) $f(x | \\theta)$ 可以写成如下形式，则称其属于单参数指数族：\n$$f(x | \\theta) = h(x) c(\\theta) \\exp(w(\\theta) t(x))$$\n其中 $\\theta$ 是我们感兴趣的参数。对于从此类分布中抽取的随机样本 $X_1, X_2, \\dots, X_n$，可以证明统计量 $T = \\sum_{i=1}^n t(X_i)$ 是参数 $\\theta$ 的一个充分统计量。\n\n考虑一个从均值为零、未知正方差为 $\\sigma^2$ 的正态分布中抽取的随机样本 $X_1, X_2, \\dots, X_n$。该分布中单个观测值 $X_i$ 的 PDF 由下式给出：\n$$f(x_i | \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{x_i^2}{2\\sigma^2}\\right)$$\n\n通过将 PDF 改写为指数族形式，其中参数为 $\\theta = \\sigma^2$，找出方差 $\\sigma^2$ 的充分统计量 $T = \\sum_{i=1}^n t(X_i)$。\n\n下列哪个表达式代表这个充分统计量？\n\nA. $T = \\sum_{i=1}^n x_i$\n\nB. $T = \\prod_{i=1}^n x_i$\n\nC. $T = \\sum_{i=1}^n x_i^2$\n\nD. $T = \\frac{1}{n-1}\\sum_{i=1}^n (x_i - \\bar{x})^2$，其中 $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^n x_i$\n\nE. $T = \\sqrt{\\sum_{i=1}^n x_i^2}$", "solution": "我们的目标是将均值为0、方差为 $\\sigma^2$ 的正态分布的概率密度函数 (PDF) 改写为单参数指数族的一般形式，然后找出其充分统计量。\n\n单个观测值 $X_i$ 的给定 PDF 为：\n$$f(x_i | \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{x_i^2}{2\\sigma^2}\\right)$$\n\n我们需要将其与指数族形式进行匹配：\n$$f(x | \\theta) = h(x) c(\\theta) \\exp(w(\\theta) t(x))$$\n在本问题中，参数为 $\\theta = \\sigma^2$。\n\n让我们对 $X_i$ 的 PDF 进行变形。我们可以将依赖于 $x_i$ 的项和依赖于参数 $\\sigma^2$ 的项分开。\n$$f(x_i | \\sigma^2) = \\frac{1}{\\sqrt{2\\pi}} \\cdot \\frac{1}{\\sqrt{\\sigma^2}} \\cdot \\exp\\left(-\\frac{x_i^2}{2\\sigma^2}\\right)$$\n我们可以进一步改写表达式，以更清晰地区分指数族形式的各个部分。我们希望分离出形如 $\\exp(\\text{关于 } \\sigma^2 \\text{ 的函数} \\times \\text{关于 } x_i \\text{ 的函数})$ 的项。\n$$f(x_i | \\sigma^2) = \\frac{1}{\\sqrt{2\\pi}} \\cdot \\frac{1}{(\\sigma^2)^{1/2}} \\cdot \\exp\\left( \\left(-\\frac{1}{2\\sigma^2}\\right) x_i^2 \\right)$$\n\n现在，通过与 $f(x_i | \\sigma^2) = h(x_i) c(\\sigma^2) \\exp(w(\\sigma^2) t(x_i))$ 进行比较，我们可以识别出相应的组成部分：\n-   $h(x_i)$: 这个函数应该只依赖于 $x_i$。在我们分离出的表达式中，项 $\\frac{1}{\\sqrt{2\\pi}}$ 不依赖于 $x_i$，但它也不依赖于 $\\sigma^2$。它是一个常数，可以与 $h(x_i)$ 分组。因此，我们可以设定 $h(x_i) = \\frac{1}{\\sqrt{2\\pi}}$。（注意：也可能有其他选择，例如 $h(x_i)=1$，这将把常数吸收到 $c(\\sigma^2)$ 中，但这个选择不影响对 $t(x_i)$ 的最终识别。）\n-   $c(\\sigma^2)$: 这个函数应该只依赖于参数 $\\sigma^2$。从我们的表达式来看，它是 $c(\\sigma^2) = \\frac{1}{(\\sigma^2)^{1/2}}$。\n-   $w(\\sigma^2)$: 指数内的这个函数是乘以 $x_i$ 函数的因子。它是 $w(\\sigma^2) = -\\frac{1}{2\\sigma^2}$。\n-   $t(x_i)$: 指数内的这个函数应该只依赖于 $x_i$。它是 $t(x_i) = x_i^2$。\n\n我们已经成功地将正态分布的 PDF 转换成指数族形式，并识别出 $t(x_i) = x_i^2$。\n\n问题陈述，对于一个大小为 $n$ 的随机样本，参数的一个充分统计量由 $T = \\sum_{i=1}^n t(X_i)$ 给出。\n代入我们识别出的函数 $t(x_i)$：\n$$T = \\sum_{i=1}^n x_i^2$$\n\n现在我们将这个结果与给定的选项进行比较：\nA. $T = \\sum_{i=1}^n x_i$: 不正确。当方差已知时，这是均值 $\\mu$ 的充分统计量。\nB. $T = \\prod_{i=1}^n x_i$: 不正确。\nC. $T = \\sum_{i=1}^n x_i^2$: 正确。这与我们推导出的统计量相匹配。\nD. $T = \\frac{1}{n-1}\\sum_{i=1}^n (x_i - \\bar{x})^2$: 不正确。这是无偏样本方差，是另一个不同的统计量。\nE. $T = \\sqrt{\\sum_{i=1}^n x_i^2}$: 不正确。虽然这是充分统计量 $\\sum x_i^2$ 的一个一一对应函数，因此它也是充分的，但它不是我们直接从 $\\sum_{i=1}^n t(X_i)$ 形式推导出的统计量。\n\n因此，直接从指数族表示中识别出的充分统计量是 $\\sum_{i=1}^n x_i^2$。", "answer": "$$\\boxed{C}$$", "id": "1960374"}, {"introduction": "在学会了如何将一个给定的分布拆解为其指数族分量之后，让我们来逆向操作一下。这项练习挑战你根据给定的充分统计量和对数配分函数来识别原始分布。这种“逆向工程”的方法可以加深你对这些分量如何唯一地定义一个分布结构的理解。[@problem_id:1960401]", "problem": "一个连续随机变量 $X$ 服从一个单参数指数族中的分布。该分布的概率密度函数 (PDF) 可以写成以下标准形式：\n$$f(x | \\eta) = h(x) \\exp\\left(\\eta T(x) - A(\\eta)\\right)$$\n其中 $\\eta$ 是自然参数。\n\n假设对于这个特定分布，充分统计量由 $T(x) = x$ 给出，对数配分函数由 $A(\\eta) = \\frac{\\eta^2}{2}$ 给出。\n\n$X$ 服从以下哪种分布？\n\nA. 标准正态分布，$N(0, 1)$\n\nB. 均值为 $\\eta$、方差为 1 的正态分布，$N(\\eta, 1)$\n\nC. 率参数为 $\\eta$ 的指数分布\n\nD. 均值为 $\\eta$ 的泊松分布\n\nE. 形状参数为 $\\eta$、率参数为 1 的伽马分布", "solution": "我们被给定了标准形式的指数族密度\n$$f(x | \\eta)=h(x)\\exp\\left(\\eta T(x)-A(\\eta)\\right),$$\n其充分统计量为 $T(x)=x$，对数配分函数为 $A(\\eta)=\\frac{\\eta^{2}}{2}$。因此，密度可以写成\n$$f(x | \\eta)=h(x)\\exp\\left(\\eta x-\\frac{\\eta^{2}}{2}\\right).$$\n通过与单位方差的正态密度进行比较，我们可以识别出这种结构。$X \\sim N(\\mu,1)$ 的密度是\n$$f(x | \\mu)=\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{(x-\\mu)^{2}}{2}\\right).$$\n展开二次项可得\n$$-\\frac{(x-\\mu)^{2}}{2}=-\\frac{x^{2}}{2}+\\mu x-\\frac{\\mu^{2}}{2},$$\n所以\n$$f(x | \\mu)=\\left(\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^{2}}{2}\\right)\\right)\\exp\\left(\\mu x-\\frac{\\mu^{2}}{2}\\right).$$\n这与标准形式相匹配，其中\n$$T(x)=x,\\quad \\eta=\\mu,\\quad A(\\eta)=\\frac{\\eta^{2}}{2},\\quad h(x)=\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^{2}}{2}\\right).$$\n因此，该分布是均值为 $\\eta$、方差为 1 的正态分布。\n\n为了排除其他选项：\n- A 仅对应于 $\\eta=0$ 的特殊情况，而不是具有自由参数 $\\eta$ 的一般成员。\n- C (指数分布) 具有不同的对数配分函数，该函数不是关于 $\\eta$ 的二次函数。\n- D (泊松分布) 是离散的，而 $X$ 是连续的。\n- E (形状参数为 $\\eta$ 的伽马分布) 具有不同的标准形式和对数配分函数。\n\n因此，正确选项是均值为 $\\eta$、方差为 1 的正态分布。", "answer": "$$\\boxed{B}$$", "id": "1960401"}, {"introduction": "指数族在所有常见的操作下都是“封闭”的吗？这个练习将探讨一个问题：由指数族成员（在这里是泊松分布）构成的混合分布本身是否也属于指数族。这个问题的答案出人意料地微妙，它揭示了这类分布的一个重要局限性，这在处理更复杂的模型（如混合模型）时是一个至关重要的概念。[@problem_id:1960402]", "problem": "如果一个概率分布的概率质量函数（PMF）或概率密度函数（PDF），记为 $f(x|\\theta)$，可以表示为以下形式，则称该分布属于单参数指数族：\n$$f(x|\\theta) = h(x) \\exp\\left( \\eta(\\theta) T(x) - A(\\theta) \\right)$$\n其中 $h(x)$ 和 $T(x)$ 仅为 $x$ 的函数，而 $\\eta(\\theta)$ 和 $A(\\theta)$ 仅为参数 $\\theta$ 的函数。\n\n率参数为 $\\lambda > 0$ 的泊松分布的 PMF 由 $\\text{Poi}(x|\\lambda) = \\frac{\\lambda^x \\exp(-\\lambda)}{x!}$ 给出，其中 $x \\in \\{0, 1, 2, \\dots\\}$。\n\n考虑一个服从两个泊松分布的有限混合分布的随机变量 $X$。其 PMF 由下式给出：\n$$p(x) = \\alpha \\text{Poi}(x|\\lambda_1) + (1-\\alpha)\\text{Poi}(x|\\lambda_2)$$\n其中混合比例 $\\alpha$ 是一个满足 $0  \\alpha  1$ 的常数，率参数 $\\lambda_1$ 和 $\\lambda_2$ 是正常数。\n\n在 $\\lambda_1 \\neq \\lambda_2$ 的一般情况下，关于此混合分布是否属于指数族，以下哪个陈述是正确的？\n\nA. 该混合模型总是属于指数族。\n\nB. 该混合模型仅在 $\\alpha=0.5$ 时属于指数族。\n\nC. 该混合模型不属于指数族，除非 $\\lambda_1 = \\lambda_2$。\n\nD. 该混合模型属于指数族，但仅当它被视为具有参数 $(\\lambda_1, \\lambda_2)$ 的双参数族时。\n\nE. 该混合模型在任何情况下都不属于指数族。", "solution": "使用的定义：一个 PMF 或 PDF 族 $\\{f(x|\\theta)\\}$ 是（单参数）指数族，如果存在仅与 $x$ 有关的函数 $h(x)$ 和 $T(x)$，以及仅与 $\\theta$ 有关的函数 $\\eta(\\theta)$ 和 $A(\\theta)$，使得\n$$\nf(x|\\theta)=h(x)\\exp\\big(\\eta(\\theta)T(x)-A(\\theta)\\big).\n$$\n对于率参数为 $\\lambda > 0$ 的泊松分布，其 PMF\n$$\n\\text{Poi}(x|\\lambda)=\\frac{\\lambda^{x}\\exp(-\\lambda)}{x!}\n$$\n可以写成指数族形式\n$$\n\\text{Poi}(x|\\lambda)=\\frac{1}{x!}\\exp\\big(x\\ln\\lambda-\\lambda\\big),\n$$\n因此 $h(x)=\\frac{1}{x!}$，$T(x)=x$，$\\eta(\\lambda)=\\ln\\lambda$，$A(\\lambda)=\\lambda$。\n\n考虑具有固定常数 $0  \\alpha  1$ 和 $\\lambda_1, \\lambda_2 > 0$ 的混合分布：\n$$\np(x)=\\alpha\\,\\text{Poi}(x|\\lambda_{1})+(1-\\alpha)\\,\\text{Poi}(x|\\lambda_{2})\n=\\frac{1}{x!}\\left[\\alpha\\exp\\big(x\\ln\\lambda_{1}-\\lambda_{1}\\big)+(1-\\alpha)\\exp\\big(x\\ln\\lambda_{2}-\\lambda_{2}\\big)\\right].\n$$\n定义 $q(x) := x! p(x)$，则\n$$\nq(x)=\\alpha\\exp\\big(x\\ln\\lambda_{1}-\\lambda_{1}\\big)+(1-\\alpha)\\exp\\big(x\\ln\\lambda_{2}-\\lambda_{2}\\big).\n$$\n如果 $p(x)$ 属于一个单参数指数族，其中 $T(x)=x$ 且 $h(x)=\\frac{1}{x!}$（这类计数数据的自然充分统计量），那么必然存在函数 $\\eta$ 和 $A$ 使得\n$$\nq(x)=\\exp\\big(\\eta x-A\\big)\\quad\\text{对所有 }x\\in\\{0,1,2,\\dots\\}.\n$$\n对连续的 $x$ 取比值，得到一个必要条件：\n$$\n\\frac{q(x+1)}{q(x)}=\\exp(\\eta)\\quad\\text{（关于 $x$ 是常数）}.\n$$\n计算混合分布的实际比率。令 $c_1 := \\alpha\\exp(-\\lambda_1)$ 和 $c_2 := (1-\\alpha)\\exp(-\\lambda_2)$，由于 $0  \\alpha  1$ 且 $\\lambda_i > 0$，两者都为严格正数。那么\n$$\nq(x)=c_{1}\\lambda_{1}^{x}+c_{2}\\lambda_{2}^{x},\n$$\n所以\n$$\n\\frac{q(x+1)}{q(x)}=\\frac{c_{1}\\lambda_{1}^{x+1}+c_{2}\\lambda_{2}^{x+1}}{c_{1}\\lambda_{1}^{x}+c_{2}\\lambda_{2}^{x}}\n=\\frac{c_{1}\\lambda_{1}+c_{2}\\lambda_{2}\\left(\\frac{\\lambda_{2}}{\\lambda_{1}}\\right)^{x}}{c_{1}+c_{2}\\left(\\frac{\\lambda_{2}}{\\lambda_{1}}\\right)^{x}}.\n$$\n这个表达式关于 $x$ 是常数，当且仅当 $c_1=0$ 或 $c_2=0$ 或 $\\frac{\\lambda_2}{\\lambda_1}=1$。前两种情况是不可能的，因为 $0  \\alpha  1$ 意味着 $c_1, c_2 > 0$。因此，该比率关于 $x$ 是常数，当且仅当 $\\lambda_1 = \\lambda_2$。\n因此，除非 $\\lambda_1 = \\lambda_2$，$q(x)$ 不能是 $\\exp(\\eta x-A)$ 的形式，所以该混合分布不能表示为 $h(x)\\exp(\\eta T(x)-A)$ 的形式，其中 $T(x)=x$ 且 $h(x)=\\frac{1}{x!}$。\n\n更一般地，对于任何具有与参数无关的固定充分统计量 $T_1(x),\\dots,T_k(x)$ 的有限维指数族，需要满足\n$$\n\\ln p(x)=\\ln h(x)+\\sum_{i=1}^{k}\\eta_{i}(\\theta)T_{i}(x)-A(\\theta),\n$$\n该式在 $T_i(x)$ 中是线性的。相反，对于该混合分布，我们有\n$$\n\\ln p(x)=\\ln\\left[\\frac{1}{x!}\\left(\\alpha\\exp(a_{1}x+b_{1})+(1-\\alpha)\\exp(a_{2}x+b_{2})\\right)\\right],\n$$\n其中 $a_i=\\ln\\lambda_i$ 且 $b_i=-\\lambda_i$。项 $\\ln\\big(\\alpha\\exp(a_{1}x+b_{1})+(1-\\alpha)\\exp(a_{2}x+b_{2})\\big)$ 是两个关于 $x$ 的线性函数的对数-和-指数（log-sum-exp）形式，当 $a_1 \\neq a_2$（等价于 $\\lambda_1 \\neq \\lambda_2$）时，它在 $x$ 上是严格凸的。一个具有固定 $T_i$ 的线性组合 $\\sum_{i}\\eta_{i}T_{i}(x)$ 无法重现这种严格凸性。因此，该混合分布不属于任何有限维指数族，除非 $\\lambda_1=\\lambda_2$，在这种情况下，混合分布退化为单个泊松分布，而泊松分布是指数族的成员。\n\n因此：\n- A 是错误的：混合分布通常不是指数族。\n- B 是错误的：$\\alpha = 1/2$ 的值不会改变上述论证。\n- C 是正确的：只有在退化情况 $\\lambda_1 = \\lambda_2$ 下，该混合分布才简化为单个泊松分布，从而属于指数族。\n- D 是错误的：允许两个参数 $(\\lambda_1, \\lambda_2)$ 并不能将对数-和-指数项转换为关于固定充分统计量的线性形式。\n- E 是错误的：率相等的退化情况是指数族的成员。\n\n因此，正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "1960402"}]}