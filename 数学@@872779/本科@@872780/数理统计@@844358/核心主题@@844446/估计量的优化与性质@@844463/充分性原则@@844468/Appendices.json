{"hands_on_practices": [{"introduction": "掌握充分性原理的第一步是能够在一个明确的场景中应用其核心工具——Neyman-Fisher分解定理。这个练习提供了一个经典的例子，使用负二项分布来模拟粒子衰变实验 [@problem_id:1963683]。通过分解联合概率质量函数，你将亲手实践如何将复杂的样本数据压缩成一个保留了所有关于未知参数信息的单一数值。", "problem": "在一项粒子衰变的研究中，一位物理学家观察到一种特定类型的稀有衰变事件。该实验包括逐个观察粒子，直到记录到固定数量 $r$ 的稀有衰变事件为止。任何一个被观察的粒子发生这种特定衰变的概率为 $p$，该概率是未知的。整个实验过程独立重复 $n$ 次，以创建一个具有统计显著性的数据集。\n\n对于第 $i$ 次重复（其中 $i=1, \\dots, n$），令随机变量 $Y_i$ 表示为观测到第 $r$ 次衰变事件而必须观测的粒子总数。每个 $Y_i$ 都是独立的，并服从负二项分布，其概率质量函数 (PMF) 如下：\n$$f(y_i; p) = \\binom{y_i-1}{r-1} p^r (1-p)^{y_i-r}, \\quad \\text{for } y_i \\in \\{r, r+1, r+2, \\dots\\}$$\n在此，参数 $r$ 是一个已知的固定正整数。\n\n基于观测值的随机样本 $Y_1, Y_2, \\dots, Y_n$，确定未知参数 $p$ 的一个充分统计量。你的答案应该是一个用样本随机变量 $Y_1, \\dots, Y_n$ 表示的表达式。", "solution": "每个 $Y_{i}$ 的概率质量函数 (pmf) 为 $f(y_{i};p)=\\binom{y_{i}-1}{r-1}p^{r}(1-p)^{y_{i}-r}$，其中 $y_{i}\\in\\{r,r+1,\\dots\\}$，且 $r$ 是已知的固定值。对于独立观测值 $Y_{1},\\dots,Y_{n}$，其联合似然函数为\n$$\nL(p;y_{1},\\dots,y_{n})=\\prod_{i=1}^{n}\\binom{y_{i}-1}{r-1}p^{r}(1-p)^{y_{i}-r}.\n$$\n合并包含 $p$ 和 $(1-p)$ 的项，得到\n$$\nL(p;y_{1},\\dots,y_{n})=\\left[\\prod_{i=1}^{n}\\binom{y_{i}-1}{r-1}\\right]\\,p^{nr}\\,(1-p)^{\\sum_{i=1}^{n}y_{i}-nr}.\n$$\n这可以分解为 $L(p;y)=h(y)\\,g(T(y),p)$ 的形式，其中\n$$\nh(y)=\\prod_{i=1}^{n}\\binom{y_{i}-1}{r-1},\\quad T(y)=\\sum_{i=1}^{n}y_{i},\\quad g(T,p)=p^{nr}(1-p)^{T-nr},\n$$\n其中 $h$ 不依赖于 $p$，而 $g$ 仅通过 $T(y)$ 依赖于数据。根据 Neyman–Fisher 分解定理，$T(Y)=\\sum_{i=1}^{n}Y_{i}$ 是 $p$ 的充分统计量。由于 $n$ 和 $r$ 是已知常数，因此 $T$ 的任何一一对应函数，例如 $\\sum_{i=1}^{n}(Y_{i}-r)$，也是充分的；一个常规的选择是 $T=\\sum_{i=1}^{n}Y_{i}$。", "answer": "$$\\boxed{\\sum_{i=1}^{n} Y_{i}}$$", "id": "1963683"}, {"introduction": "充分统计量不仅与概率密度函数的代数形式有关，还深刻地依赖于其定义域。本练习通过一个粒子探测器的二维情景，揭示了当参数定义数据支撑集（support）的边界时，充分统计量是如何捕捉这一边界信息的 [@problem_id:1963659]。与许多指数族分布不同，这里的关键在于找到那个定义了数据“最大范围”的统计量。", "problem": "一个半径未知（为 $R$）的圆形粒子探测器以一个二维坐标系的原点为中心。根据实验物理学，当粒子被探测到时，其撞击位置 $(X, Y)$ 在探测器区域内呈均匀分布。现进行一项实验，并记录了 $n$ 个粒子撞击位置的随机样本：$(X_1, Y_1), (X_2, Y_2), \\dots, (X_n, Y_n)$。\n\n根据统计推断中的充分性原则，一个参数的充分统计量是指一个能够捕捉到样本中包含的关于该参数所有信息的统计量。下列哪个统计量是未知半径 $R$ 的充分统计量？\n\nA. $T_A = \\max_{i=1,...,n} \\sqrt{X_i^2 + Y_i^2}$\n\nB. $T_B = \\sum_{i=1}^n (X_i^2 + Y_i^2)$\n\nC. $T_C = \\left(\\frac{1}{n}\\sum_{i=1}^n X_i, \\frac{1}{n}\\sum_{i=1}^n Y_i\\right)$\n\nD. $T_D = \\frac{1}{n} \\sum_{i=1}^n \\sqrt{X_i^2 + Y_i^2}$\n\nE. $T_E = \\max_{i=1,...,n} |X_i|$", "solution": "令 $(X_{i},Y_{i})$，$i=1,\\dots,n$，为在以原点为中心、半径为 $R$ 的圆盘上独立同分布的均匀分布随机变量。单个观测值的联合密度函数为\n$$\nf_{X,Y}(x,y;R)=\\frac{1}{\\pi R^{2}}\\mathbf{1}\\{x^{2}+y^{2}\\le R^{2}\\},\n$$\n因此，样本的联合密度（似然函数）为\n$$\nL(R;\\{(x_{i},y_{i})\\}_{i=1}^{n})=\\prod_{i=1}^{n}\\frac{1}{\\pi R^{2}}\\mathbf{1}\\{x_{i}^{2}+y_{i}^{2}\\le R^{2}\\}=(\\pi R^{2})^{-n}\\,\\mathbf{1}\\Big\\{\\max_{1\\le i\\le n}(x_{i}^{2}+y_{i}^{2})\\le R^{2}\\Big\\}.\n$$\n定义样本统计量\n$$\nT_{A}=\\max_{1\\le i\\le n}\\sqrt{X_{i}^{2}+Y_{i}^{2}}.\n$$\n那么似然函数可以写为\n$$\nL(R;\\text{data})=(\\pi R^{2})^{-n}\\,\\mathbf{1}\\{T_{A}\\le R\\},\n$$\n其形式为 $g(T_{A},R)h(\\text{data})$，其中 $g(T_{A},R)=(\\pi R^{2})^{-n}\\mathbf{1}\\{T_{A}\\le R\\}$ 且 $h(\\text{data})=1$。根据 Neyman–Fisher 分解定理，$T_{A}$ 是 $R$ 的充分统计量。\n\n为了说明其他选项不是充分的，请注意似然函数中的指示函数仅通过 $\\max_{i}(X_{i}^{2}+Y_{i}^{2})$（等价于 $T_{A}$）依赖于样本。任何不能确定这个最大半径的统计量都无法使分解式独立于样本的其余细节：\n- $T_{B}=\\sum_{i=1}^{n}(X_{i}^{2}+Y_{i}^{2})$ 无法确定最大值；不同的样本可以有相同的平方和但不同的最大值，从而导致不同的支撑集 $\\{R:T_{A}\\le R\\}$。\n- $T_{C}=(\\bar{X},\\bar{Y})$ 无法确定支撑集的边界，也无法捕捉到约束条件 $\\max_{i}(X_{i}^{2}+Y_{i}^{2})\\le R^{2}$。\n- $T_{D}=\\frac{1}{n}\\sum_{i=1}^{n}\\sqrt{X_{i}^{2}+Y_{i}^{2}}$ 同样是对半径取平均值，无法确定最大半径。\n- $T_{E}=\\max_{i}|X_{i}|$ 忽略了径向约束中的 $Y$ 坐标；两个样本可以有相同的 $T_{E}$ 但不同的 $\\max_{i}\\sqrt{X_{i}^{2}+Y_{i}^{2}}$，因此它无法确定支撑集。\n\n因此，在给定的选项中，$R$ 的充分统计量是 $T_{A}$。", "answer": "$$\\boxed{A}$$", "id": "1963659"}, {"introduction": "一个参数就一定意味着一个单值的充分统计量吗？这个练习将挑战这一直觉。在一个正态分布模型中，当均值和方差都与同一个未知参数 $\\theta$ 相关联时，我们会发现单个统计量（如样本均值或样本方差）是不足够的 [@problem_id:1963696]。通过这个例子，你将学会如何识别并证明一个二维向量可以作为单个参数的充分统计量，这加深了对信息在数据中如何分布的理解。", "problem": "在一种新型半导体器件的开发中，激活能（记为 $X$）是一个关键参数。由于纳米尺度下的量子效应，制造过程产生的器件其激活能是一个随机变量。一个由初步实验支持的理论模型假设，$X$ 服从正态分布，其均值 $\\theta$ 是可调的，但标准差与均值内在地相关。具体来说，对于给定的均值 $\\theta  0$，该分布的方差为 $\\theta^2$。我们将此分布记为 $N(\\theta, \\theta^2)$。\n\n一位质量控制工程师收集了 $n$ 个器件的随机样本，其激活能为 $X_1, X_2, \\dots, X_n$，所有器件都是在对应于参数 $\\theta$ 的相同条件下生产的。为了对 $\\theta$ 进行推断，该工程师希望将数据压缩成一个低维度的总结，而不丢失任何关于该参数的信息。这样的总结被称为充分统计量。\n\n下列哪个二维统计量是参数 $\\theta$ 的充分统计量？请注意，可能有一个以上的选项是正确的。\n\nA. $T_A = \\left(\\sum_{i=1}^{n} X_i, \\sum_{i=1}^{n} (X_i - \\bar{X})^2\\right)$，其中 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$。\n\nB. $T_B = \\left(\\bar{X}, \\sum_{i=1}^{n} X_i^2\\right)$，其中 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$。\n\nC. $T_C = \\left(\\sum_{i=1}^{n} X_i, \\frac{1}{n}\\sum_{i=1}^{n} X_i^2\\right)$。\n\nD. $T_D = \\left(\\bar{X}, \\left(\\sum_{i=1}^{n} X_i\\right)^2\\right)$，其中 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$。\n\nE. $T_E = \\left(\\sum_{i=1}^{n} X_i^2, \\left(\\sum_{i=1}^{n} X_i\\right)^2\\right)$。", "solution": "设 $X_{1},\\dots,X_{n}$ 是来自 $N(\\theta,\\theta^{2})$ 的独立同分布（i.i.d.）样本，其中 $\\theta0$。其联合密度函数为\n$$\nf(x_{1},\\dots,x_{n}\\mid\\theta)\n=(2\\pi)^{-n/2}\\theta^{-n}\\exp\\!\\left(-\\frac{1}{2\\theta^{2}}\\sum_{i=1}^{n}(x_{i}-\\theta)^{2}\\right).\n$$\n展开二次项，\n$$\n\\sum_{i=1}^{n}(x_{i}-\\theta)^{2}\n=\\sum_{i=1}^{n}x_{i}^{2}-2\\theta\\sum_{i=1}^{n}x_{i}+n\\theta^{2},\n$$\n因此似然函数可以写成\n$$\nL(\\theta;x)=C(x)\\,\\theta^{-n}\\exp\\!\\left(-\\frac{1}{2\\theta^{2}}\\sum_{i=1}^{n}x_{i}^{2}+\\frac{1}{\\theta}\\sum_{i=1}^{n}x_{i}-\\frac{n}{2}\\right),\n$$\n其中 $C(x)=(2\\pi)^{-n/2}$ 不依赖于 $\\theta$。因此，\n$$\nL(\\theta;x)=h(x)\\,g_{\\theta}\\!\\left(\\sum_{i=1}^{n}x_{i},\\sum_{i=1}^{n}x_{i}^{2}\\right),\n$$\n根据 Neyman–Fisher 分解定理，这表明 $T_{\\min}=(\\sum_{i=1}^{n}X_{i},\\sum_{i=1}^{n}X_{i}^{2})$ 是充分统计量。为了验证其最小充分性，使用似然比准则：对于两个样本 $x$ 和 $y$，\n$$\n\\frac{L(\\theta;x)}{L(\\theta;y)}=\\left(\\frac{\\theta^{-n}}{\\theta^{-n}}\\right)\\exp\\!\\left(-\\frac{1}{2\\theta^{2}}\\left[\\sum x_{i}^{2}-\\sum y_{i}^{2}\\right]+\\frac{1}{\\theta}\\left[\\sum x_{i}-\\sum y_{i}\\right]\\right),\n$$\n该比值与 $\\theta$ 无关当且仅当 $\\sum x_{i}=\\sum y_{i}$ 且 $\\sum x_{i}^{2}=\\sum y_{i}^{2}$。因此 $T_{\\min}$ 是最小充分统计量。所以，一个统计量 $S$ 是充分的，当且仅当 $T_{\\min}$ 是 $S$ 的一个可测函数，即 $S$ 能确定 $\\sum X_{i}$ 和 $\\sum X_{i}^{2}$ 两者。\n\n现在逐一检查每个提议的统计量：\n\nA. $T_{A}=\\left(\\sum X_{i},\\sum (X_{i}-\\bar{X})^{2}\\right)$。由于 $\\sum (X_{i}-\\bar{X})^{2}=\\sum X_{i}^{2}-n\\bar{X}^{2}=\\sum X_{i}^{2}-\\frac{(\\sum X_{i})^{2}}{n}$，我们可以通过 $\\sum (X_{i}-\\bar{X})^{2}+(\\sum X_{i})^{2}/n$ 来恢复 $\\sum X_{i}^{2}$。因此 $T_{\\min}$ 是 $T_{A}$ 的函数，所以 $T_{A}$ 是充分的。\n\nB. $T_{B}=(\\bar{X},\\sum X_{i}^{2})$。从 $\\bar{X}$ 我们可以得到 $\\sum X_{i}=n\\bar{X}$。因此 $T_{\\min}$ 是 $T_{B}$ 的函数，所以 $T_{B}$ 是充分的。\n\nC. $T_{C}=\\left(\\sum X_{i},\\frac{1}{n}\\sum X_{i}^{2}\\right)$。将第二个分量乘以 $n$ 即可恢复 $\\sum X_{i}^{2}$。因此 $T_{\\min}$ 是 $T_{C}$ 的函数，所以 $T_{C}$ 是充分的。\n\nD. $T_{D}=(\\bar{X},(\\sum X_{i})^{2})$。这可以确定 $\\sum X_{i}=n\\bar{X}$（包括其符号），但它不能确定 $\\sum X_{i}^{2}$。因此 $T_{\\min}$ 不是 $T_{D}$ 的函数，所以 $T_{D}$ 不是充分的。\n\nE. $T_{E}=\\left(\\sum X_{i}^{2},(\\sum X_{i})^{2}\\right)$。这可以确定 $\\sum X_{i}^{2}$ 以及 $\\sum X_{i}$ 的平方；但 $\\sum X_{i}$ 的符号无法确定，而似然函数通过 $\\exp((1/\\theta)\\sum X_{i})$ 依赖于 $\\sum X_{i}$，因此对于 $\\theta0$ 其符号很重要。因此 $T_{\\min}$ 不是 $T_{E}$ 的函数，所以 $T_{E}$ 不是充分的。\n\n因此，选项中的充分统计量是 A、B 和 C。", "answer": "$$\\boxed{ABC}$$", "id": "1963696"}]}