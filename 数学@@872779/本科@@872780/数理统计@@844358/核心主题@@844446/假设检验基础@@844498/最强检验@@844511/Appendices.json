{"hands_on_practices": [{"introduction": "要真正掌握奈曼-皮尔逊引理，我们从一个基础练习开始。这个问题提供了一个简单的离散情景，在此情景下，我们可以为每个可能的结果手动计算似然比，并一步步构建出最强检验，从而揭示引理如何有效地分配我们的I类错误预算。[@problem_id:1937968]", "problem": "一个研究团队正在开发一种新型量子传感器，用于探测单个奇异粒子。基于单次测量，该传感器输出一个离散信号水平 $X$，其取值范围为集合 $\\{1, 2, 3\\}$。传感器输出的统计行为取决于粒子是否存在。\n\n零假设 $H_0$ 对应于粒子不存在的情况。在 $H_0$ 下，信号 $X$ 的概率质量函数由下式给出：\n$P(X=1|H_0) = 0.5$\n$P(X=2|H_0) = 0.4$\n$P(X=3|H_0) = 0.1$\n\n备择假设 $H_1$ 对应于粒子存在的情况。在 $H_1$ 下，信号 $X$ 的概率质量函数为：\n$P(X=1|H_1) = 0.1$\n$P(X=2|H_1) = 0.4$\n$P(X=3|H_1) = 0.5$\n\n该团队希望基于单次传感器读数构建一个决策规则（一个统计检验）。“拒绝”零假设对应于得出粒子存在的结论。对于固定的检验水平（I 型错误概率）$\\alpha = 0.1$，该检验必须是可能的最优检验。\n\n下列哪个集合代表了这个最优检验的拒绝域？拒绝域是观测到的 $X$ 值中导致零假设 $H_0$ 被拒绝的集合。\n\nA. $\\{1\\}$\n\nB. $\\{3\\}$\n\nC. $\\{1, 2\\}$\n\nD. $\\{2, 3\\}$\n\nE. $\\{1, 3\\}$\n\nF. $\\{2\\}$", "solution": "我们寻求一个检验水平为 $\\alpha=0.1$ 的最优检验，用于基于单个观测值 $X \\in \\{1,2,3\\}$ 来检验 $H_{0}$ 与 $H_{1}$。根据 Neyman–Pearson 引理，在水平 $\\alpha$ 下的最优检验在似然比 $\\Lambda(x)=\\frac{P(X=x \\mid H_{1})}{P(X=x \\mid H_{0})}$ 很大时拒绝 $H_{0}$，其阈值的选择需要满足检验水平的约束。\n\n计算似然比：\n$$\n\\Lambda(1)=\\frac{0.1}{0.5}=0.2,\\quad \\Lambda(2)=\\frac{0.4}{0.4}=1,\\quad \\Lambda(3)=\\frac{0.5}{0.1}=5.\n$$\n按 $\\Lambda$ 的降序排列它们：$x=3$ (最大)，然后是 $x=2$，最后是 $x=1$。\n\n为了达到检验水平 $\\alpha=0.1$，我们将具有最大似然比的结果包含进来，直到拒绝域的总 $H_{0}$ 概率等于 $\\alpha$。如果需要，可以在边界处使用随机化。在 $H_{0}$ 下，\n$$\nP_{0}(X=3)=0.1,\\quad P_{0}(X=2)=0.4,\\quad P_{0}(X=1)=0.5.\n$$\n仅取最高似然比的结果 $x=3$ 可得\n$$\nP_{0}(\\{3\\})=0.1=\\alpha,\n$$\n因此不需要随机化。包含任何其他结果都会超出检验水平的约束。因此，水平为 $\\alpha$ 的最优检验当且仅当 $X=3$ 时拒绝 $H_{0}$。\n\n这对应于拒绝域 $\\{3\\}$，与选项 B 相符。", "answer": "$$\\boxed{B}$$", "id": "1937968"}, {"introduction": "在核心原理的基础上，我们现在转向统计学中最常见的情景：来自正态分布的数据。这个练习至关重要，因为它展示了如何在连续情景下为最强检验找到临界值，并推导出检验功效的解析表达式。理解样本量 $n$、显著性水平 $\\alpha$ 和功效之间的这种关系是假设检验的基础。[@problem_id:1937923]", "problem": "一个信号处理系统被设计用于区分目标信号和背景噪声。当只有噪声存在时，测量值 $X$ 可以很好地用均值为 0、方差为 1 的正态分布来建模，即 $N(0, 1)$。当目标信号存在时，测量值可以用均值为 1、方差为 1 的正态分布来建模，即 $N(1, 1)$。\n\n为了做出决策，收集了一个包含 $n$ 个独立测量值的随机样本 $X_1, X_2, \\ldots, X_n$。构建了一个假设检验，其原假设为 $H_0: \\mu=0$（信号不存在），备择假设为 $H_1: \\mu=1$（信号存在）。\n\nNeyman-Pearson 引理保证了在显著性水平 $\\alpha$ 下，最强检验（MP test）将在样本均值 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$ 大于某个临界值 $c$ 时拒绝原假设 $H_0$。\n\n您的任务是求出这个最强检验的功效。请用样本量 $n$、显著性水平 $\\alpha$ 以及标准正态分布的累积分布函数（CDF，记为 $\\Phi(\\cdot)$）来表示您的答案，形式为一个解析表达式。CDF 的反函数，即分位数函数，可以记为 $\\Phi^{-1}(\\cdot)$。", "solution": "在原假设 $H_{0}:\\mu=0$ 下，每个 $X_{i}\\sim N(0,1)$ 且相互独立，因此样本均值 $\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$ 满足\n$$\n\\bar{X}\\mid H_{0}\\sim N\\!\\left(0,\\frac{1}{n}\\right).\n$$\n最强水平-$\\alpha$ 检验在 $\\bar{X}>c$ 时拒绝 $H_{0}$，其中 $c$ 的选择需要满足检验大小的约束条件\n$$\n\\Pr_{H_{0}}(\\bar{X}>c)=\\alpha.\n$$\n在 $H_{0}$ 下进行标准化可得\n$$\n\\Pr\\!\\left(Z>c\\sqrt{n}\\right)=\\alpha,\\quad Z\\sim N(0,1),\n$$\n因此\n$$\nc\\sqrt{n}=\\Phi^{-1}(1-\\alpha)\\quad\\Rightarrow\\quad c=\\frac{1}{\\sqrt{n}}\\Phi^{-1}(1-\\alpha).\n$$\n\n在备择假设 $H_{1}:\\mu=1$ 下，我们有\n$$\n\\bar{X}\\mid H_{1}\\sim N\\!\\left(1,\\frac{1}{n}\\right).\n$$\n因此，该检验的功效为\n$$\n\\Pr_{H_{1}}(\\bar{X}>c)=\\Pr\\!\\left(Z>(c-1)\\sqrt{n}\\right)=1-\\Phi\\!\\left((c-1)\\sqrt{n}\\right),\n$$\n其中 $Z\\sim N(0,1)$。代入 $c=\\frac{1}{\\sqrt{n}}\\Phi^{-1}(1-\\alpha)$ 可得\n$$\n(c-1)\\sqrt{n}=\\Phi^{-1}(1-\\alpha)-\\sqrt{n},\n$$\n因此功效等于\n$$\n1-\\Phi\\!\\left(\\Phi^{-1}(1-\\alpha)-\\sqrt{n}\\right)=\\Phi\\!\\left(\\sqrt{n}-\\Phi^{-1}(1-\\alpha)\\right).\n$$\n这就将功效表示为了 $n$、$\\alpha$ 和 $\\Phi$ 的函数，其中 $\\Phi^{-1}$ 通过临界值出现。", "answer": "$$\\boxed{\\Phi\\!\\left(\\sqrt{n}-\\Phi^{-1}(1-\\alpha)\\right)}$$", "id": "1937923"}, {"introduction": "最强检验理论在实际的实验设计中找到了其最终价值。这最后一个练习通过提出一个关键问题——“我需要多少数据？”，将理论与应用联系起来。通过计算达到期望功效和显著性水平所需的最小样本量，你将学会如何规划既具有统计稳健性又高效的研究。[@problem_id:1937987]", "problem": "一个精密科学仪器被设计用于产生一个输出信号，该信号服从均值为 $\\mu$、已知方差为 $\\sigma^2 = 1$ 的正态分布。在完美校准的情况下，信号的均值为 $\\mu_0 = 0$。一个特定的故障会导致信号均值漂移到一个新值 $\\mu_1 = 0.5$。需要基于来自该仪器的 $n$ 次独立测量的随机样本，设计一个诊断检验。\n\n该检验必须满足以下两个严格的性能标准：\n1. 在仪器完美校准的情况下，错误地断定其发生故障的概率不得超过 $0.05$。\n2. 在故障确实发生的情况下，正确识别出故障的概率必须至少为 $0.90$。\n\n确定所需的最小整数样本量 $n$，以使该诊断检验能够同时满足这两个标准。", "solution": "设 $X_{1},\\dots,X_{n}$ 为独立样本，且 $X_{i} \\sim \\mathcal{N}(\\mu,1)$。我们检验原假设 $H_{0}:\\mu=0$ 与单侧备择假设 $H_{1}:\\mu=0.5$。对于已知方差和均值变大的备择假设，水平为 $\\alpha$ 的一致最强检验在 $\\bar{X}$ 值较大时拒绝原假设。\n\n在 $H_{0}$ 之下，$\\bar{X} \\sim \\mathcal{N}(0,1/n)$。选择一个临界值 $c$ 使得检验的显著性水平为 $0.05$：\n$$\n\\mathbb{P}_{\\mu=0}(\\bar{X} \\ge c)=0.05\n\\;\\Longleftrightarrow\\;\n\\mathbb{P}\\!\\left(Z \\ge c\\sqrt{n}\\right)=0.05\n\\;\\Longleftrightarrow\\;\nc\\sqrt{n}=z_{0.95},\n$$\n所以\n$$\nc=\\frac{z_{0.95}}{\\sqrt{n}},\n$$\n其中 $z_{p}=\\Phi^{-1}(p)$，而 $\\Phi$ 是标准正态累积分布函数。\n\n在 $\\mu=0.5$ 的情况下，检验的功效为\n$$\n\\mathbb{P}_{\\mu=0.5}(\\bar{X} \\ge c)\n=\\mathbb{P}\\!\\left(\\frac{\\bar{X}-0.5}{1/\\sqrt{n}} \\ge (c-0.5)\\sqrt{n}\\right)\n=1-\\Phi\\!\\left((c-0.5)\\sqrt{n}\\right).\n$$\n将 $c=z_{0.95}/\\sqrt{n}$ 代入，可得\n$$\n\\text{power}=1-\\Phi\\!\\left(z_{0.95}-0.5\\sqrt{n}\\right).\n$$\n要求其值至少为 $0.90$，可得\n$$\n1-\\Phi\\!\\left(z_{0.95}-0.5\\sqrt{n}\\right) \\ge 0.90\n\\;\\Longleftrightarrow\\;\n\\Phi\\!\\left(z_{0.95}-0.5\\sqrt{n}\\right) \\le 0.10\n\\;\\Longleftrightarrow\\;\nz_{0.95}-0.5\\sqrt{n} \\le z_{0.10}.\n$$\n利用对称性 $z_{0.10}=-z_{0.90}$，上式变为\n$$\n0.5\\sqrt{n} \\ge z_{0.95}-z_{0.10}=z_{0.95}+z_{0.90}\n\\;\\Longleftrightarrow\\;\n\\sqrt{n} \\ge 2\\bigl(z_{0.95}+z_{0.90}\\bigr)\n\\;\\Longleftrightarrow\\;\nn \\ge \\left[2\\bigl(z_{0.95}+z_{0.90}\\bigr)\\right]^{2}.\n$$\n使用 $z_{0.95}\\approx 1.644853626$ 和 $z_{0.90}\\approx 1.281551566$，\n$$\n2\\bigl(z_{0.95}+z_{0.90}\\bigr) \\approx 5.852810384,\n\\quad\nn \\ge 34.256\\ldots\n$$\n因此，满足这两个标准的最小整数 $n$ 是 $35$。直接检验可得，当 n=35 时功效为 $\\text{power} = \\Phi\\!\\left(0.5\\sqrt{35}-z_{0.95}\\right)\\approx \\Phi(1.313)\\approx 0.905 \\ge 0.90$，而当 $n=34$ 时，功效低于 $0.90$。", "answer": "$$\\boxed{35}$$", "id": "1937987"}]}