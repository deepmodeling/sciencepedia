{"hands_on_practices": [{"introduction": "在许多实际的工程和科学问题中，我们遇到的数据并不总是服从正态分布。例如，电子元件的寿命通常用指数分布来描述，这个练习将带你实践如何为一个服从指数分布的总体均值建立并检验假设（$H_0$ vs $H_a$）。这对于理解假设检验在不同概率模型下的普适性，以及如何根据备择假设确定拒绝域至关重要。[@problem_id:1940676]", "problem": "一个航空航天工程团队正在为一项长时间深空任务开发一种新型放射性同位素热电发生器。设计规范要求这些发生器的平均无故障时间 (MTTF) 必须大于5000小时。为了验证这一点，该团队对$n=10$个原型发生器的随机样本进行了寿命测试。假设这些发生器的寿命是相互独立的，并且服从指数分布。测试一直进行到所有10个发生器都失效为止，记录它们的寿命总和为60,000小时。\n\n该团队决定进行一次假设检验，原假设为真实MTTF恰好是5000小时，备择假设为其大于5000小时。检验在$\\alpha = 0.05$的显著性水平下进行。为了解决这个问题，给定显著性水平下，相应检验统计量的临界值为31.410。如果检验统计量的值大于此临界值，将导致拒绝原假设。\n\n根据实验数据，以下哪个结论是正确的？\n\nA. 团队应该拒绝原假设。\n\nB. 团队应该不拒绝原假设。\n\nC. 结果不确定，因为样本量太小，无法得出有意义的结论。\n\nD. 无法进行检验，因为总体均值和方差都是未知参数。\n\nE. 团队应该接受原假设并视其为已被证明为真。", "solution": "该问题要求我们对指数分布的均值进行假设检验。设随机变量$X$表示一个发生器的寿命。我们已知$X$服从指数分布。指数分布的概率密度函数(PDF)可以由其均值$\\mu$或其率参数$\\lambda = 1/\\mu$来参数化。用$\\mu$表示的PDF为 $f(x; \\mu) = \\frac{1}{\\mu} \\exp(-\\frac{x}{\\mu})$，其中$x \\ge 0$。\n\n首先，我们用平均无故障时间 (MTTF) $\\mu$ 来陈述原假设和备择假设。\n原假设 ($H_0$) 是MTTF恰好为5000小时。\n$$H_0: \\mu = 5000$$\n备择假设 ($H_a$) 是MTTF大于5000小时。\n$$H_a: \\mu  5000$$\n\n对于指数分布，一个功效强且常用的检验统计量是基于观测值的总和。设$X_1, X_2, \\dots, X_n$为样本中$n$个发生器的寿命。数理统计学中的一个关键结果表明，如果$X_i$独立同分布于$\\text{Exp}(\\lambda)$（其中$\\lambda=1/\\mu$），那么$2\\lambda \\sum_{i=1}^n X_i$这个量服从自由度为$2n$的卡方分布，即$2\\lambda \\sum_{i=1}^n X_i \\sim \\chi^2_{2n}$。\n\n我们基于此性质构建我们的检验。在原假设下，均值为$\\mu_0 = 5000$，对应的率参数为$\\lambda_0 = 1/\\mu_0 = 1/5000$。因此，在$H_0$下，检验统计量\n$$S = 2\\lambda_0 \\sum_{i=1}^n X_i = \\frac{2}{\\mu_0} \\sum_{i=1}^n X_i$$\n服从自由度为$2n$的卡方分布。在我们的例子中，样本量为$n=10$，因此自由度为$2n = 2(10) = 20$。\n\n备择假设是$H_a: \\mu > 5000$。一个更大的样本均值，$\\bar{X} = (\\sum X_i)/n$，为$H_a$提供了支持证据。大的样本均值对应于大的总和$\\sum X_i$，这又对应于检验统计量$S$的大值。因此，我们进行的是一个右尾检验。如果我们的统计量的观测值$s_{obs}$大于某个临界值，我们将拒绝$H_0$。题目中给出了在显著性水平$\\alpha = 0.05$下，这个临界值为31.410。\n\n现在，我们使用给定的数据计算检验统计量的观测值$s_{obs}$：\n样本量，$n=10$。\n寿命总和，$\\sum_{i=1}^{10} x_i = 60,000$ 小时。\n原假设均值，$\\mu_0 = 5000$ 小时。\n\n$$s_{obs} = \\frac{2}{\\mu_0} \\sum_{i=1}^{10} x_i = \\frac{2}{5000} \\times 60,000 = \\frac{120,000}{5000} = 24$$\n\n最后，我们将观测到的统计量与临界值进行比较。\n观测统计量：$s_{obs} = 24$。\n临界值 (根据题目陈述)：$c = 31.410$。\n\n由于$s_{obs} = 24$不大于临界值$31.410$，因此检验统计量没有落在拒绝域内。因此，在$\\alpha = 0.05$的显著性水平下，我们没有足够的证据来拒绝原假设。正确的结论是“不拒绝原假设”。\n\n让我们评估给出的选项：\nA. 团队应该拒绝原假设。这是不正确的。\nB. 团队应该不拒绝原假设。这是正确的结论。\nC. 结果不确定，因为样本量太小。这是一种误解。假设检验根据所选的框架提供了一个明确的结论（拒绝或不拒绝）。\nD. 无法进行检验，因为总体均值和方差都是未知的。这是不正确的。该检验正是为这种情况设计的。对于指数分布，方差是$\\mu^2$，所以知道均值就决定了方差。该检验在原假设下对均值做出假设以继续进行。\nE. 团队应该接受原假设并视其为已被证明为真。这是一个常见的逻辑谬误。不拒绝原假设仅仅意味着没有足够的证据来推翻它，而不是说它已经被证明是真的。\n\n因此，唯一正确的陈述是B。", "answer": "$$\\boxed{B}$$", "id": "1940676"}, {"introduction": "假设检验的真正挑战之一，在于如何将一个模糊的科学问题精确地转化为数学上的原假设 ($H_0$) 和备择假设 ($H_1$)。本练习介绍了一种在医学和技术领域非常重要的检验类型：非劣效性检验，其目标是证明一个新方案（如新药或新技术）不比现有标准“差得不可接受”。通过这个案例，你将学习如何根据“举证责任”和控制第一类错误的风险来正确设定假设，这是从理论走向应用的关键一步。[@problem_id:2410302]", "problem": "一个生物信息学核心设施正在评估一种新的“边合成边测序”化学方法，并将其与Illumina平台进行比较，实验使用了来自同一参考样本的匹配文库。对于每种方法，他们都计算了单碱基错误率，该错误率定义为在经过比对和变异屏蔽后，一个被判读的碱基与可信参考序列不匹配的概率。设 $e_{\\text{new}}$ 表示新化学方法的错误率， $e_{\\text{Illumina}}$ 表示Illumina平台的错误率。由于错误率越低越好，该设施预先指定了一个非劣效性界值 $\\Delta > 0$，该界值是新化学方法相对于Illumina平台错误率可接受的最大绝对增量，在此增量范围内，其性能对于下游的计算生物学流程仍被认为是“并非不可接受地差”。\n\n根据假设检验的核心定义——原假设应代表性能的不可接受边界（错误地宣称其为非劣效是不可接受的），而备择假设代表研究旨在建立的主张——请为一个基于差值 $\\delta = e_{\\text{new}} - e_{\\text{Illumina}}$ 的非劣效性检验选择正确的原假设和备择假设对。\n\nA. $H_{0}: e_{\\text{new}} - e_{\\text{Illumina}} \\ge \\Delta$ 且 $H_{1}: e_{\\text{new}} - e_{\\text{Illumina}}  \\Delta$\n\nB. $H_{0}: e_{\\text{new}} - e_{\\text{Illumina}} \\le -\\Delta$ 且 $H_{1}: e_{\\text{new}} - e_{\\text{Illumina}} > -\\Delta$\n\nC. $H_{0}: | e_{\\text{new}} - e_{\\text{Illumina}} | \\ge \\Delta$ 且 $H_{1}: | e_{\\text{new}} - e_{\\text{Illumina}} |  \\Delta$\n\nD. $H_{0}: e_{\\text{new}} - e_{\\text{Illumina}} \\ge 0$ 且 $H_{1}: e_{\\text{new}} - e_{\\text{Illumina}}  0$\n\nE. $H_{0}: e_{\\text{new}} - e_{\\text{Illumina}} \\le \\Delta$ 且 $H_{1}: e_{\\text{new}} - e_{\\text{Illumina}} > \\Delta$", "solution": "此问题要求为非劣效性检验正确构建原假设和备择假设。频率学派假设检验的基本原则是，将研究者希望证明的主张设为备择假设($H_1$)，而将需要承担“举证责任”来推翻的基准状态或“不可接受”状态设为原假设($H_0$)。\n\n1.  **定义研究目标 (备择假设 $H_1$)**: 研究的目标是证明新的化学方法是“非劣效”的。在此背景下，“非劣效”意味着新方法的错误率 $e_{\\text{new}}$ 相对于标准方法 $e_{\\text{Illumina}}$ 的增加量，没有超过预先设定的可接受界值 $\\Delta$。用数学语言表述，即错误率的差值小于 $\\Delta$。因此，备择假设是：\n    $$H_{1}: e_{\\text{new}} - e_{\\text{Illumina}}  \\Delta$$\n\n2.  **定义需要被推翻的基准状态 (原假设 $H_0$)**: 原假设是备择假设的逻辑对立面。它代表了新方法性能“劣于”或“不可接受”的状态。这种状态是指新方法的错误率相比标准方法，其增加量达到了或超过了不可接受的界值 $\\Delta$。因此，原假设是：\n    $$H_{0}: e_{\\text{new}} - e_{\\text{Illumina}} \\ge \\Delta$$\n\n这种设定是至关重要的，因为它将最重要的错误——错误地宣称一个劣效方法为非劣效——控制为第一类错误 (Type I error)，其概率由显著性水平 $\\alpha$ 限定。要得出非劣效的结论，研究者必须收集到足够强的证据来拒绝“新方法是劣效的”这一原假设。\n\n**评估选项**:\n\n-   **A. $H_{0}: e_{\\text{new}} - e_{\\text{Illumina}} \\ge \\Delta$ 且 $H_{1}: e_{\\text{new}} - e_{\\text{Illumina}}  \\Delta$**: 此选项与我们的推导完全吻合。$H_0$ 代表劣效状态，$H_1$ 代表希望证明的非劣效状态。这是非劣效性检验的标准设定。**正确**。\n\n-   **B. $H_{0}: e_{\\text{new}} - e_{\\text{Illumina}} \\le -\\Delta$ 且 $H_{1}: e_{\\text{new}} - e_{\\text{Illumina}} > -\\Delta$**: 这不是一个非劣效性检验。它似乎是在检验新方法的错误率是否“不比旧方法好太多”，这与问题的目标相反。\n\n-   **C. $H_{0}: | e_{\\text{new}} - e_{\\text{Illumina}} | \\ge \\Delta$ 且 $H_{1}: | e_{\\text{new}} - e_{\\text{Illumina}} |  \\Delta$**: 这是**等效性检验** (equivalence test) 的设定。其目标是证明两种方法的差异足够小（在 $\\pm\\Delta$ 范围内），可以被认为是等效的。而非劣效性检验是单向的，只关心新方法是否“不够好”。\n\n-   **D. $H_{0}: e_{\\text{new}} - e_{\\text{Illumina}} \\ge 0$ 且 $H_{1}: e_{\\text{new}} - e_{\\text{Illumina}}  0$**: 这是**优效性检验** (superiority test) 的设定，即检验新方法是否严格优于（错误率更低）旧方法。这对应于非劣效性界值 $\\Delta=0$ 的特殊情况，但问题中明确指出 $\\Delta > 0$。\n\n-   **E. $H_{0}: e_{\\text{new}} - e_{\\text{Illumina}} \\le \\Delta$ 且 $H_{1}: e_{\\text{new}} - e_{\\text{Illumina}} > \\Delta$**: 这个选项错误地对调了原假设和备择假设。它将非劣效状态设为原假设。在频率学派框架下，我们无法“证明”或“接受”原假设，只能“未能拒绝”它。这种设定颠倒了举证责任，是一个根本性的错误。\n\n因此，选项A是唯一正确的表述。", "answer": "$$\\boxed{A}$$", "id": "2410302"}, {"introduction": "在统计学实践中，我们常常会遇到没有现成检验公式的复杂问题。此时，我们需要回归第一性原理，自行构建检验统计量。这个练习将引导你使用强大的广义似然比检验（GLRT）框架，为一个重要且普遍的问题——变化点检测——推导出一个检验统计量。这个过程不仅能加深你对似然原理的理解，也锻炼了处理在原假设 ($H_0$) 和备择假设 ($H_A$) 下都含有未知参数的复合假设的能力。[@problem_id:1940664]", "problem": "一位系统工程师正在监测一台关键服务器的每日平均延迟。连续几天的延迟测量值被记录为一系列随机变量 $X_1, X_2, \\ldots, X_n$。假设这些测量值是独立的，并且来自一个已知方差为 $\\sigma^2$ 的正态分布，因此 $X_i \\sim N(\\mu_i, \\sigma^2)$，其中 $i=1, \\ldots, n$。\n\n工程师想要检测在观测期间服务器性能是否发生了一次突然的变化。这对应于平均延迟 $\\mu_i$ 的变化。该问题被构建为一个“稳定系统”原假设与“单突变点”备择假设之间的假设检验：\n\n- **原假设 ($H_0$)：** 系统是稳定的，意味着在此期间平均延迟是恒定的。总体均值都等于某个未知的常数 $\\mu$。\n$$H_0: \\mu_1 = \\mu_2 = \\dots = \\mu_n = \\mu$$\n\n- **备择假设 ($H_A$)：** 在某个未知时间 $\\tau \\in \\{1, \\dots, n-1\\}$ 发生了一次变化。总体均值在时间 $\\tau$ 之前为 $\\theta_1$，在时间 $\\tau$ 之后变为 $\\theta_2$，其中 $\\theta_1 \\neq \\theta_2$。参数 $\\theta_1$、$\\theta_2$ 和突变点 $\\tau$ 都是未知的。\n$$H_A: \\text{存在 } \\tau \\in \\{1, \\dots, n-1\\} \\text{ 使得 } \\mu_1 = \\dots = \\mu_\\tau = \\theta_1 \\text{ 且 } \\mu_{\\tau+1} = \\dots = \\mu_n = \\theta_2, \\text{ 其中 } \\theta_1 \\neq \\theta_2$$\n\n为了进行此检验，构建了一个广义对数似然比检验（GLRT）统计量，记为 $T_n$。它被定义为 $T_n = 2 \\left( \\sup_{H_A} \\ln L - \\sup_{H_0} \\ln L \\right)$，其中 $\\ln L$ 是观测值的对数似然函数，上确界（supremum）是在相应假设下对所有未知参数取值得到的。\n\n推导统计量 $T_n$ 的解析表达式。你的最终答案应以 $n$、$\\sigma^2$ 和观测值 $X_i$ 表示。", "solution": "在独立高斯测量且方差 $\\sigma^{2}$ 已知的情况下，联合密度为\n$$\nL(\\mu_{1},\\ldots,\\mu_{n})=(2\\pi\\sigma^{2})^{-n/2}\\exp\\!\\left(-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(X_{i}-\\mu_{i})^{2}\\right),\n$$\n因此对数似然函数为\n$$\n\\ln L(\\mu_{1},\\ldots,\\mu_{n})=-\\frac{n}{2}\\ln(2\\pi\\sigma^{2})-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(X_{i}-\\mu_{i})^{2}.\n$$\n\n在 $H_{0}$ 下，对所有 $i$ 都有 $\\mu_{i}=\\mu$。最大化值满足\n$$\n\\frac{\\partial}{\\partial \\mu}\\ln L=\\frac{1}{\\sigma^{2}}\\sum_{i=1}^{n}(X_{i}-\\mu)=0\n\\;\\;\\Longrightarrow\\;\\;\n\\hat{\\mu}=\\bar{X}_{n}:=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}.\n$$\n因此\n$$\n\\sup_{H_{0}}\\ln L=-\\frac{n}{2}\\ln(2\\pi\\sigma^{2})-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(X_{i}-\\bar{X}_{n})^{2}.\n$$\n\n在 $H_{A}$ 下，对于一个固定的突变点 $\\tau\\in\\{1,\\ldots,n-1\\}$，我们有 $\\mu_{1}=\\cdots=\\mu_{\\tau}=\\theta_{1}$ 和 $\\mu_{\\tau+1}=\\cdots=\\mu_{n}=\\theta_{2}$。最大化值求解\n$$\n\\frac{\\partial}{\\partial \\theta_{1}}\\ln L=\\frac{1}{\\sigma^{2}}\\sum_{i=1}^{\\tau}(X_{i}-\\theta_{1})=0,\\quad\n\\frac{\\partial}{\\partial \\theta_{2}}\\ln L=\\frac{1}{\\sigma^{2}}\\sum_{i=\\tau+1}^{n}(X_{i}-\\theta_{2})=0,\n$$\n所以\n$$\n\\hat{\\theta}_{1}=\\bar{X}_{1:\\tau}:=\\frac{1}{\\tau}\\sum_{i=1}^{\\tau}X_{i},\\qquad\n\\hat{\\theta}_{2}=\\bar{X}_{\\tau+1:n}:=\\frac{1}{n-\\tau}\\sum_{i=\\tau+1}^{n}X_{i}.\n$$\n对于这个 $\\tau$，相应的最大化对数似然为\n$$\n\\sup_{\\theta_{1},\\theta_{2}}\\ln L=-\\frac{n}{2}\\ln(2\\pi\\sigma^{2})-\\frac{1}{2\\sigma^{2}}\\left[\\sum_{i=1}^{\\tau}(X_{i}-\\bar{X}_{1:\\tau})^{2}+\\sum_{i=\\tau+1}^{n}(X_{i}-\\bar{X}_{\\tau+1:n})^{2}\\right].\n$$\n对 $\\tau$ 进行最大化等价于最小化方括号内的组内平方和，因此\n$$\n\\sup_{H_{A}}\\ln L=-\\frac{n}{2}\\ln(2\\pi\\sigma^{2})-\\frac{1}{2\\sigma^{2}}\\min_{1\\le \\tau\\le n-1}\\left[\\sum_{i=1}^{\\tau}(X_{i}-\\bar{X}_{1:\\tau})^{2}+\\sum_{i=\\tau+1}^{n}(X_{i}-\\bar{X}_{\\tau+1:n})^{2}\\right].\n$$\n\n因此，GLRT 统计量为\n$$\nT_{n}=2\\left(\\sup_{H_{A}}\\ln L-\\sup_{H_{0}}\\ln L\\right)\n=\\frac{1}{\\sigma^{2}}\\left\\{\\sum_{i=1}^{n}(X_{i}-\\bar{X}_{n})^{2}-\\min_{1\\le \\tau\\le n-1}\\left[\\sum_{i=1}^{\\tau}(X_{i}-\\bar{X}_{1:\\tau})^{2}+\\sum_{i=\\tau+1}^{n}(X_{i}-\\bar{X}_{\\tau+1:n})^{2}\\right]\\right\\}.\n$$\n\n使用方差分析（ANOVA）恒等式\n$$\n\\sum_{i=1}^{n}(X_{i}-\\bar{X}_{n})^{2}-\\left[\\sum_{i=1}^{\\tau}(X_{i}-\\bar{X}_{1:\\tau})^{2}+\\sum_{i=\\tau+1}^{n}(X_{i}-\\bar{X}_{\\tau+1:n})^{2}\\right]\n=\\frac{\\tau(n-\\tau)}{n}\\left(\\bar{X}_{1:\\tau}-\\bar{X}_{\\tau+1:n}\\right)^{2},\n$$\n我们得到显式的最大化形式\n$$\nT_{n}=\\frac{1}{\\sigma^{2}}\\max_{1\\le \\tau\\le n-1}\\left\\{\\frac{\\tau(n-\\tau)}{n}\\left(\\bar{X}_{1:\\tau}-\\bar{X}_{\\tau+1:n}\\right)^{2}\\right\\}\n=\\frac{1}{\\sigma^{2}}\\max_{1\\le \\tau\\le n-1}\\left\\{\\frac{\\tau(n-\\tau)}{n}\\left(\\frac{1}{\\tau}\\sum_{i=1}^{\\tau}X_{i}-\\frac{1}{n-\\tau}\\sum_{i=\\tau+1}^{n}X_{i}\\right)^{2}\\right\\}.\n$$\n该表达式以 $n$、$\\sigma^{2}$ 和观测值 $X_{i}$ 表示。", "answer": "$$\\boxed{\\frac{1}{\\sigma^{2}}\\max_{1\\le \\tau\\le n-1}\\left\\{\\frac{\\tau\\,(n-\\tau)}{n}\\left(\\frac{1}{\\tau}\\sum_{i=1}^{\\tau}X_{i}-\\frac{1}{n-\\tau}\\sum_{i=\\tau+1}^{n}X_{i}\\right)^{2}\\right\\}}$$", "id": "1940664"}]}