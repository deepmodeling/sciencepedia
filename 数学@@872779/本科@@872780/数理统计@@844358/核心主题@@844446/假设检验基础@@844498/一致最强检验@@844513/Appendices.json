{"hands_on_practices": [{"introduction": "在统计推断中，我们经常能通过巧妙的变换，将复杂的问题简化为我们熟悉的核心模型。这个练习就是一个绝佳的例子，它将一个关于对数正态分布参数的检验问题，转化为一个针对正态分布均值的标准检验，而后者正是构建一致最强（UMP）检验的基石。通过完成这个问题 [@problem_id:1966299]，你不仅能掌握如何为最常见的情形（正态均值，已知方差）计算精确的临界值，还能学会识别并利用数据变换来解决更广泛问题的能力。", "problem": "在一项环境科学研究中，一条河流中某种重金属污染物的浓度被认为服从对数正态分布。令随机变量 $X$ 表示此浓度。参数为 $\\mu$ 和 $\\sigma^2$ 的对数正态随机变量 $X$ 的概率密度函数 (PDF) 由下式给出：\n$$f(x; \\mu, \\sigma^2) = \\frac{1}{x \\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(x) - \\mu)^2}{2\\sigma^2}\\right), \\quad \\text{for } x  0$$\n其中 $\\mu$ 是该变量自然对数的均值，$\\sigma^2$ 是其方差。\n\n根据历史数据，已知方差参数稳定在 $\\sigma_0^2 = 4.0$。然而，近期流域内的工业活动被怀疑导致了污染物浓度中位数的增加，这对应于参数 $\\mu$ 的增加。为了检验这一怀疑，收集了一个大小为 $n=16$ 的水样随机样本。\n\n我们希望对参数 $\\mu$ 进行假设检验，显著性水平为 $\\alpha = 0.05$。原假设和备择假设设定如下：\n$$H_0: \\mu \\le 1.5$$\n$$H_1: \\mu  1.5$$\n\n针对此问题的一致最强 (UMP) 检验的拒绝域形式为 $\\bar{Y}  c$，其中 $\\bar{Y} = \\frac{1}{n}\\sum_{i=1}^{n} \\ln(X_i)$，$c$ 是一个临界值。确定此临界值 $c$ 的值。\n\n对于标准正态分布，你可以使用 $z=1.645$ 的值截断分布最高的 5% 这一近似值。将最终答案表示为一个四舍五入到四位有效数字的数值。", "solution": "设 $X$ 服从参数为 $(\\mu,\\sigma^{2})$ 的对数正态分布，则 $Y=\\ln(X)$ 服从正态分布 $Y \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。对于一个随机样本 $X_{1},\\dots,X_{n}$，定义 $Y_{i}=\\ln(X_{i})$，则 $Y_{i} \\stackrel{\\text{i.i.d.}}{\\sim} \\mathcal{N}(\\mu,\\sigma^{2})$。因此，样本均值 $\\bar{Y}=\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}$ 服从正态分布\n$$\n\\bar{Y} \\sim \\mathcal{N}\\left(\\mu,\\frac{\\sigma^{2}}{n}\\right).\n$$\n我们在显著性水平 $\\alpha=0.05$ 下，对 $H_{0}:\\mu \\le 1.5$ 与 $H_{1}:\\mu1.5$ 进行检验，其中已知方差 $\\sigma^{2}=\\sigma_{0}^{2}=4.0$，样本大小 $n=16$。对于正态族中已知方差的单边检验，一致最强检验在 $\\bar{Y}$ 值较大时拒绝原假设，临界值 $c$ 的选择使得在最不利情况 $\\mu=\\mu_{0}=1.5$ 下，\n$$\n\\mathbb{P}_{\\mu_{0}}\\!\\left(\\bar{Y}c\\right)=\\alpha.\n$$\n进行标准化，令\n$$\nZ=\\frac{\\bar{Y}-\\mu_{0}}{\\sigma/\\sqrt{n}} \\sim \\mathcal{N}(0,1)\\quad \\text{在 } \\mu=\\mu_{0} \\text{ 条件下},\n$$\n于是条件变为\n$$\n\\mathbb{P}\\!\\left(Z\\frac{c-\\mu_{0}}{\\sigma/\\sqrt{n}}\\right)=\\alpha.\n$$\n等价地，\n$$\n\\frac{c-\\mu_{0}}{\\sigma/\\sqrt{n}}=z_{\\alpha},\n$$\n其中 $z_{\\alpha}$ 是标准正态分布的 $(1-\\alpha)$ 分位数。因此，\n$$\nc=\\mu_{0}+z_{\\alpha}\\frac{\\sigma}{\\sqrt{n}}.\n$$\n使用 $\\mu_{0}=1.5$，$\\sigma=\\sqrt{4.0}=2$，$n=16$ 从而 $\\sqrt{n}=4$，以及对于 $\\alpha=0.05$ 给定的近似值 $z_{\\alpha}=1.645$，我们得到\n$$\nc=1.5+1.645\\cdot \\frac{2}{4}=1.5+1.645\\cdot 0.5=1.5+0.8225=2.3225.\n$$\n四舍五入到四位有效数字，得到 $c=2.323$。", "answer": "$$\\boxed{2.323}$$", "id": "1966299"}, {"introduction": "从连续分布转向离散分布时，假设检验会面临新的挑战。当检验统计量只能取离散值时，我们可能无法通过一个简单的阈值精确地达到预设的显著性水平 $\\alpha$。这个问题 [@problem_id:1966286] 引入了“随机化检验”这一关键概念，它为我们提供了一种理论上完备的方法来解决这一难题。理解如何计算所需的随机化概率 $\\gamma$，将帮助你深入领会UMP检验框架的严谨性，并掌握其在处理像二项分布这样的计数数据时的正确应用。", "problem": "一位质量控制工程师的任务是评估一个生产过程的次品率。从每一批次非常大量的元件中，随机抽取一个大小为$n$的小样本进行检验。样本中发现的次品数量，用随机变量$X$表示，被建模为二项分布，$X \\sim \\text{Binomial}(n, p)$，其中$p$是该过程生产的次品的真实比例。\n\n该工程师希望检验原假设$H_0: p \\le 0.5$（即过程处于可接受状态），相对于备择假设$H_1: p  0.5$（即过程的次品率高到不可接受）。\n\n对于此检验，使用样本量为$n=3$的样本。工程师需要构建一个在确切显著性水平$\\alpha = 0.2$下的一致最强（UMP）检验。由于检验统计量$X$服从离散分布，要达到这个确切的显著性水平需要进行随机化检验。这种检验的结构由一个临界值$c$和一个随机化概率$\\gamma \\in [0, 1]$定义。决策规则如下：\n- 如果$X  c$，拒绝原假设$H_0$。\n- 如果$X = c$，以概率$\\gamma$拒绝原假设$H_0$。\n- 如果$X  c$，不拒绝原假设$H_0$。\n\n基于此框架，确定该检验所需的随机化概率$\\gamma$的具体值。将你的答案表示为最简精确分数形式。", "solution": "我们将次品数建模为$X \\sim \\text{Binomial}(n,p)$，其中$n=3$。我们检验$H_{0}: p \\leq \\frac{1}{2}$ 相对于 $H_{1}: p  \\frac{1}{2}$。对于二项数据的单边检验，该分布族在$X$上具有单调似然比，因此根据卡林-鲁宾定理，水平为$\\alpha$的一致最强检验在$X$取较大值时拒绝原假设；在$H_0$下的最不利值为$p=\\frac{1}{2}$。因此，为达到确切的检验水平$\\alpha=\\frac{1}{5}$，我们选择临界值$c$和随机化概率$\\gamma$使得\n$$\n\\sup_{p \\leq \\frac{1}{2}} \\Pr_{p}(\\text{reject})=\\Pr_{p=\\frac{1}{2}}(\\text{reject})=\\alpha=\\frac{1}{5}.\n$$\n因为当$n=3$时，$X$是离散的，我们必须考虑上尾拒绝域。如果$c=3$，那么在$p=\\frac{1}{2}$下的拒绝概率至多为$\\Pr(X=3 \\mid p=\\frac{1}{2})=\\frac{1}{8}$，这小于$\\frac{1}{5}$；因此我们必须将$X=2$通过随机化的方式包含在拒绝域中。因此取$c=2$，使得检验在$X=3$时总是拒绝，在$X=2$时以概率$\\gamma$拒绝。检验水平的条件变为\n$$\n\\Pr_{p=\\frac{1}{2}}(\\text{reject})=\\Pr(X=3)+\\gamma\\,\\Pr(X=2)=\\alpha.\n$$\n对于$X \\sim \\text{Binomial}(3,\\frac{1}{2})$，\n$$\n\\Pr(X=3)=\\binom{3}{3}\\left(\\frac{1}{2}\\right)^{3}=\\frac{1}{8}, \\qquad \\Pr(X=2)=\\binom{3}{2}\\left(\\frac{1}{2}\\right)^{3}=\\frac{3}{8}.\n$$\n施加确切的检验水平$\\alpha=\\frac{1}{5}$可得\n$$\n\\frac{1}{8}+\\gamma \\cdot \\frac{3}{8}=\\frac{1}{5}.\n$$\n解得，\n$$\n\\gamma=\\frac{\\frac{1}{5}-\\frac{1}{8}}{\\frac{3}{8}}=\\frac{\\frac{3}{40}}{\\frac{3}{8}}=\\frac{8}{40}=\\frac{1}{5}.\n$$\n因此所需的随机化概率为$\\gamma=\\frac{1}{5}$。", "answer": "$$\\boxed{\\frac{1}{5}}$$", "id": "1966286"}, {"introduction": "许多现实世界中的统计问题，例如比较两种治疗方法的效果或两个系统的性能，都涉及到多于一个的未知参数。其中一些参数（称为讨厌参数）并非我们关心的重点，但它们的存在会使检验变得复杂。这个问题 [@problem_id:1966251] 展示了一种处理讨厌参数的强大策略：在讨厌参数的充分统计量给定的条件下进行检验。通过将比较两个泊松过程率的问题转化为一个基于条件二项分布的检验，你将学会构建一致最强条件检验，这是处理多参数指数族模型假设检验的一种高级且应用广泛的技巧。", "problem": "在网络广告的背景下，一家公司在固定的、相同的时间段内对两个不同的广告活动（广告活动A和广告活动B）进行A/B测试。每个广告活动产生的用户点击次数可以被建模为一个独立的泊松过程。设 $X_A$ 是来自广告活动A的点击次数，假定它是一个均值为 $\\lambda_A$ 的泊松分布的随机变量。类似地，设 $X_B$ 是来自广告活动B的点击次数，它服从均值为 $\\lambda_B$ 的泊松分布。两个随机变量 $X_A$ 和 $X_B$ 是独立的。\n\n公司想要确定广告活动A是否显著比广告活动B更有效。这可以被表述为关于点击率之比 $\\theta = \\lambda_A / \\lambda_B$ 的假设检验。原假设是广告活动A不比广告活动B更有效，$H_0: \\theta \\le 1$，备择假设是它更有效，$H_1: \\theta  1$。\n\n设 $x_A$ 和 $x_B$ 分别是每个广告活动观测到的点击次数，并设总点击次数为 $s = x_A + x_B$。你的任务是确定一个大小为 $\\alpha$ 的一致最强（UMP）检验。\n\n下列哪项描述了针对 $H_0: \\lambda_A/\\lambda_B \\le 1$ 与 $H_1: \\lambda_A/\\lambda_B  1$ 的大小为 $\\alpha$ 的一致最强检验的拒绝域？\n\nA. 如果 $x_A  k_s$ 则拒绝 $H_0$，其中临界值 $k_s$ 取决于总计数 $s$，并被选择以满足基于二项分布的大小约束。\n\nB. 如果 $s  k$ 则拒绝 $H_0$，其中临界值 $k$ 是一个常数，被选择以满足基于泊松分布的大小约束。\n\nC. 如果比率 $x_A / x_B  k$ 则拒绝 $H_0$，其中临界值 $k$ 是一个常数，被选择以满足基于F分布的大小约束。\n\nD. 如果 $x_A  k_s$ 则拒绝 $H_0$，其中临界值 $k_s$ 取决于总计数 $s$，并被选择以满足基于二项分布的大小约束。\n\nE. 如果 $x_A - x_B  k$ 则拒绝 $H_0$，其中临界值 $k$ 是一个常数，被选择以满足基于正态分布的大小约束。", "solution": "设 $X_A \\sim \\text{Poisson}(\\lambda_A)$ 和 $X_B \\sim \\text{Poisson}(\\lambda_B)$ 是独立的随机变量。对于观测值 $(x_A, x_B)$，$(X_A, X_B)$ 的联合概率质量函数 (PMF) 由下式给出：\n$$ P(X_A=x_A, X_B=x_B; \\lambda_A, \\lambda_B) = \\frac{e^{-\\lambda_A}\\lambda_A^{x_A}}{x_A!} \\frac{e^{-\\lambda_B}\\lambda_B^{x_B}}{x_B!} $$\n这可以写成：\n$$ f(x_A, x_B; \\lambda_A, \\lambda_B) = \\frac{1}{x_A! x_B!} \\exp\\left(x_A \\ln(\\lambda_A) + x_B \\ln(\\lambda_B) - (\\lambda_A+\\lambda_B)\\right) $$\n这是一个具有二维充分统计量 $(X_A, X_B)$ 的双参数指数族。假设是关于参数 $\\theta = \\lambda_A / \\lambda_B$ 的。这是一个带有讨厌参数（例如 $\\lambda_A + \\lambda_B$）的复合假设。为了推导一致最强检验，我们可以使用对讨厌参数的充分统计量取条件的方法。设 $S = X_A + X_B$。$S$ 的分布是均值为 $\\lambda_A + \\lambda_B$ 的泊松分布，因为独立泊松随机变量之和也是一个泊松随机变量。\n\n让我们求在给定 $S=s$ 的条件下 $X_A$ 的条件分布。对于 $x_A = 0, 1, \\dots, s$：\n$$ P(X_A=x_A | S=s) = \\frac{P(X_A=x_A, X_A+X_B=s)}{P(X_A+X_B=s)} = \\frac{P(X_A=x_A, X_B=s-x_A)}{P(S=s)} $$\n利用 $X_A$ 和 $X_B$ 的独立性：\n$$ P(X_A=x_A | S=s) = \\frac{\\frac{e^{-\\lambda_A}\\lambda_A^{x_A}}{x_A!} \\frac{e^{-\\lambda_B}\\lambda_B^{s-x_A}}{(s-x_A)!}}{\\frac{e^{-(\\lambda_A+\\lambda_B)}(\\lambda_A+\\lambda_B)^s}{s!}} $$\n$$ = \\frac{s!}{x_A!(s-x_A)!} \\frac{e^{-(\\lambda_A+\\lambda_B)}\\lambda_A^{x_A}\\lambda_B^{s-x_A}}{e^{-(\\lambda_A+\\lambda_B)}(\\lambda_A+\\lambda_B)^s} $$\n$$ = \\binom{s}{x_A} \\frac{\\lambda_A^{x_A}\\lambda_B^{s-x_A}}{(\\lambda_A+\\lambda_B)^s} = \\binom{s}{x_A} \\left(\\frac{\\lambda_A}{\\lambda_A+\\lambda_B}\\right)^{x_A} \\left(\\frac{\\lambda_B}{\\lambda_A+\\lambda_B}\\right)^{s-x_A} $$\n这是二项分布的概率质量函数，即 $X_A | (S=s) \\sim \\text{Binomial}(s, p)$，其中成功概率为 $p = \\frac{\\lambda_A}{\\lambda_A+\\lambda_B}$。\n\n现在，我们用 $p$ 来重新参数化假设。设 $\\theta = \\lambda_A / \\lambda_B$。\n$$ p = \\frac{\\lambda_A}{\\lambda_A+\\lambda_B} = \\frac{\\lambda_A/\\lambda_B}{(\\lambda_A/\\lambda_B) + 1} = \\frac{\\theta}{\\theta+1} $$\n函数 $g(\\theta) = \\frac{\\theta}{\\theta+1}$ 是关于 $\\theta$ 的严格增函数（对于 $\\theta  0$）。因此，原假设检验等价于一个关于 $p$ 的检验。\n$H_0: \\theta \\le 1 \\iff p \\le \\frac{1}{1+1} = \\frac{1}{2}$\n$H_1: \\theta  1 \\iff p  \\frac{1}{2}$\n\n问题现在简化为，为一个服从二项分布 Binomial$(s, p)$（在观测总数 $s$ 的条件下）的随机变量 $X_A$ 寻找一个关于 $H_0: p \\le 1/2$ 与 $H_1: p  1/2$ 的一致最强检验。该分布的PMF，$f(x_A; p) = \\binom{s}{x_A} p^{x_A} (1-p)^{s-x_A}$，属于一个单参数指数族，其充分统计量为 $T(X_A) = X_A$。对于任意 $p_2  p_1$，似然比是 $X_A$ 的增函数。\n\n根据卡林-鲁宾定理，对于这个单边假设，存在一个大小为 $\\alpha$ 的一致最强检验，其拒绝域形式为 $\\{x_A : x_A > k_s\\}$。对于给定的总计数 $s$，选择临界值 $k_s$ 以满足大小约束：\n$$ \\sup_{p \\le 1/2} P_p(X_A > k_s | S=s) = P_{p=1/2}(X_A > k_s | S=s) \\le \\alpha $$\n等式成立是因为功效函数在 $p$ 上是递增的。所以，对于给定的观测总数 $s=x_A+x_B$，如果观测计数 $x_A$ 大于某个临界值 $k_s$，则该检验拒绝 $H_0$。这个临界值由原假设下的分布，即 $\\text{Binomial}(s, 1/2)$，来确定。\n\n这与选项A相匹配。\n- 选项B基于总计数 $s$ 作出决策，这对应于对总率 $\\lambda_A+\\lambda_B$ 的检验，而非对率比的检验。\n- 选项C使用了不正确的检验统计量形式；F分布用于正态总体方差之比的检验，不适用于此。\n- 选项D的拒绝域 $x_A  k_s$ 适用于检验备择假设 $H_1: \\lambda_A/\\lambda_B  1$。\n- 选项E使用的统计量 $x_A - x_B$ 无法导出精确的UMPU检验，尽管在正态近似下可能使用。", "answer": "$$\\boxed{A}$$", "id": "1966251"}]}