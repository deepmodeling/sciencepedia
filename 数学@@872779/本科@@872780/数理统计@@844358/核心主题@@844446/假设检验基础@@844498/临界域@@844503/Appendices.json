{"hands_on_practices": [{"introduction": "在进行假设检验时，一个核心的实践问题是：我们需要多少数据才能有信心地得出一个结论？如果样本量太小，我们可能无法检测到真实存在的效应，导致测试的“功效”不足。本练习将引导你解决一个基本的检验设计问题，即计算为达到指定的I型错误率 ($\\alpha$) 和功效 ($1-\\beta$) 所需的最小样本量。通过这个练习[@problem_id:1912184]，你将掌握将理论概念与实验设计的实际约束联系起来的关键技能。", "problem": "一家工厂生产一种特种陶瓷部件，其抗压强度是一个关键的质量参数。根据大量的历史数据可知，该部件的抗压强度（以兆帕 (MPa) 为单位）服从正态分布，其已知标准差为 $\\sigma = 5.0$ MPa。如果平均抗压强度为 $\\mu = 250.0$ MPa，则认为生产过程处于“受控”状态。现在怀疑工艺设置发生了永久性偏移，这将使平均强度增加到 $\\mu = 252.0$ MPa。\n\n需要基于 $n$ 个部件的随机样本设计一个质量控制检验。该检验必须是用于检测这一特定偏移的最优检验。它必须满足两个条件：\n1. I类错误（当均值未发生偏移时，错误地断定其已发生偏移）的概率不得超过 $\\alpha = 0.025$。\n2. 检验的功效（当均值确实发生偏移时，正确地断定其已发生偏移）必须至少为 $0.95$。\n\n确定构建满足这些规范的检验所需的最小整数样本量 $n$。", "solution": "我们将抗压强度测量值建模为具有已知标准差 $\\sigma$ 和均值 $\\mu$ 的独立正态随机变量。我们检验 $H_{0}:\\mu=\\mu_{0}$ 对 $H_{1}:\\mu=\\mu_{1}$，其中 $\\mu_{0}=250.0$，$\\mu_{1}=252.0$，且 $\\sigma=5.0$。设 $\\bar{X}$ 为来自大小为 $n$ 的样本的样本均值。\n\n根据 Neyman–Pearson 引理，对于正态数据和已知方差的简单对简单假设检验，水平为 $\\alpha$ 的最优检验在 $\\bar{X}$ 取较大值时拒绝 $H_{0}$。在 $H_{0}$ 下，$\\bar{X}\\sim \\mathcal{N}(\\mu_{0},\\sigma^{2}/n)$，因此为使 I 类错误概率为 $\\alpha$，我们选择临界值\n$$\nc=\\mu_{0}+z_{1-\\alpha}\\frac{\\sigma}{\\sqrt{n}},\n$$\n其中 $z_{p}$ 满足 $\\Phi(z_{p})=p$，$\\Phi$ 是标准正态累积分布函数。\n\n在 $\\mu_{1}$ 处的功效为\n$$\n\\text{Power}(\\mu_1)=P_{\\mu_{1}}(\\bar{X}>c)=1-\\Phi\\!\\left(\\frac{c-\\mu_{1}}{\\sigma/\\sqrt{n}}\\right).\n$$\n我们要求功效至少为 $0.95$，即\n$$\n1-\\Phi\\!\\left(\\frac{c-\\mu_{1}}{\\sigma/\\sqrt{n}}\\right)\\geq 0.95\n\\;\\;\\Longleftrightarrow\\;\\;\n\\Phi\\!\\left(\\frac{c-\\mu_{1}}{\\sigma/\\sqrt{n}}\\right)\\leq 0.05\n\\;\\;\\Longleftrightarrow\\;\\;\n\\frac{c-\\mu_{1}}{\\sigma/\\sqrt{n}}\\leq z_{0.05}.\n$$\n使用 $z_{0.05}=-z_{0.95}$ 并代入 $c=\\mu_{0}+z_{1-\\alpha}\\sigma/\\sqrt{n}$，令 $\\delta=\\mu_{1}-\\mu_{0}>0$；则\n$$\n\\frac{\\mu_{0}-\\mu_{1}}{\\sigma/\\sqrt{n}}+z_{1-\\alpha}\\leq -z_{0.95}\n\\;\\;\\Longleftrightarrow\\;\\;\n\\frac{\\delta\\sqrt{n}}{\\sigma}\\geq z_{1-\\alpha}+z_{0.95}.\n$$\n因此，所需的样本量必须满足\n$$\nn\\geq \\left(\\frac{\\sigma\\left(z_{1-\\alpha}+z_{0.95}\\right)}{\\delta}\\right)^{2}.\n$$\n\n当 $\\alpha=0.025$，$\\sigma=5.0$，$\\delta=\\mu_{1}-\\mu_{0}=2.0$，$z_{1-\\alpha}=z_{0.975}\\approx 1.959963984540$，以及 $z_{0.95}\\approx 1.644853626951$ 时，我们得到\n$$\nn\\geq \\left(\\frac{5.0\\left(1.959963984540+1.644853626951\\right)}{2.0}\\right)^{2}\n=\\left(2.5\\times 3.604817611491\\right)^{2}\\approx 81.2169.\n$$\n因此，满足规范的最小整数 $n$ 是\n$$\nn=82.\n$$", "answer": "$$\\boxed{82}$$", "id": "1912184"}, {"introduction": "前一个练习处理的是简单假设检验，即检验一个参数的特定值。然而，在科学研究中，我们常常对复合假设更感兴趣，例如，某个参数是否“大于”某个值。对于这类问题，我们的目标是找到在所有可能的备择假设下都具有最大功效的检验，即一致最优（UMP）检验。本练习[@problem_id:1912193]将向你展示如何在属于指数族的分布（此处为零截断泊松分布）中，利用卡林-鲁宾定理来确定UMP检验的拒绝域。", "problem": "一组野生生物学家正在一个受保护的栖息地研究一种特定鸟类的繁殖成功率。他们观察到，一个筑巢的鸟对总会至少养育一只离巢幼鸟。他们使用零截断泊松 (ZTP) 分布来模拟一个成功鸟巢中离巢幼鸟的数量 $X$。对于一个率参数为 $\\lambda > 0$ 的 ZTP 随机变量，其概率质量函数 (PMF) 由以下公式给出：\n$$ P(X=k) = \\frac{\\lambda^k}{k! (e^\\lambda - 1)} \\quad \\text{其中 } k = 1, 2, 3, \\ldots $$\n生物学家们从一个包含 $n=8$ 个鸟巢的随机样本中收集数据，记录的离巢幼鸟数量为 $X_1, X_2, \\ldots, X_8$。一项标准的生态学理论预测，率参数应为 $\\lambda=2$。生物学家们希望检验近期的环境变化是否导致了该率的增加。他们设立了如下的假设检验：\n$H_0: \\lambda \\le 2$ 对立于备择假设 $H_1: \\lambda  2$。\n\n该团队决定使用 $\\alpha = 0.10$ 的显著性水平。根据统计理论的一个已知结果，该问题的一致最强 (UMP) 检验的临界区 (拒绝域) 由一个形如“如果 $\\sum_{i=1}^8 X_i \\ge k$ 则拒绝 $H_0$”的规则定义，其中 $k$ 为某个整数。\n\n为了找到 $k$ 的具体值，该团队使用统计软件计算了在原假设的边界条件 $\\lambda=2$ 下，检验统计量 $Y = \\sum_{i=1}^8 X_i$ 的累积分布函数 (CDF)。下面提供了 $Y$ 的部分 CDF 表：\n- $P(Y \\le 21) = 0.8851$\n- $P(Y \\le 22) = 0.9214$\n- $P(Y \\le 23) = 0.9498$\n- $P(Y \\le 24) = 0.9696$\n\n确定定义此 UMP 检验临界区的最小整数 $k$ 值。", "solution": "我们有来自参数为 $\\lambda$ 的零截断泊松分布的独立同分布随机变量 $X_{1},\\ldots,X_{8}$，其概率质量函数可以写为\n$$\nP(X=k)=\\frac{\\lambda^{k}}{k!\\left(\\exp(\\lambda)-1\\right)},\\quad k=1,2,\\ldots\n$$\n该模型是一个单参数指数族，其统计量 $Y=\\sum_{i=1}^{8}X_{i}$ 具有单调似然比。根据 Karlin–Rubin 定理，对于检验 $H_{0}:\\lambda\\le 2$ 对立于 $H_{1}:\\lambda>2$，水平为 $\\alpha$ 的一致最强检验在 $Y$ 值较大时拒绝 $H_{0}$，即其临界区形式为 $\\{Y\\ge k\\}$，其中 $k$ 为某个整数阈值。\n\n为了在显著性水平 $\\alpha=0.10$ 下选择 $k$，我们在 $H_{0}$ 的边界条件下，即 $\\lambda=2$ 时，施加检验大小的约束：\n$$\nP_{\\lambda=2}(Y\\ge k)\\le 0.10,\n$$\n并且我们选择满足此条件的最小整数 $k$ 以最大化功效。这等价于\n$$\n1 - P_{\\lambda=2}(Y\\le k-1) \\le 0.10 \\quad \\Longleftrightarrow \\quad P_{\\lambda=2}(Y\\le k-1) \\ge 0.90.\n$$\n使用所提供的在 $\\lambda=2$ 条件下的累积概率：\n- 对于 $k=22$，我们检验 $P(Y \\ge 22) = 1-P(Y\\le 21)=1-0.8851=0.1149$。由于 $0.1149 > 0.10$，该检验的大小超过了 $\\alpha$，因此 $k=22$ 不可接受。\n- 对于 $k=23$，我们检验 $P(Y \\ge 23)=1-P(Y\\le 22)=1-0.9214=0.0786$。由于 $0.0786 \\le 0.10$，该检验满足大小约束。\n\n由于 $k=22$ 不满足条件而 $k=23$ 满足，所以定义临界区的最小整数 $k$ 是 $23$。", "answer": "$$\\boxed{23}$$", "id": "1912193"}, {"introduction": "对于双边假设（例如，$H_0: \\mu = \\mu_0$ vs $H_1: \\mu \\neq \\mu_0$），通常不存在一个对所有备择假设值都一致最优的检验。这引出了一个重要问题：我们应该如何选择拒绝域？本练习[@problem_id:1912207]探讨了拒绝域的形状如何影响检验的功效。通过比较标准对称（等尾）检验与非对称检验的功效，你将深入理解在特定备择假设下，检验功效是如何变化的，并认识到检验设计中存在的权衡。", "problem": "一位质量控制工程师正在对一大批电阻器的平均电阻进行假设检验。已知一个电阻器的电阻（记为 $X$）服从均值为 $\\mu$、已知标准差为 $\\sigma = 4.0$ 欧姆的正态分布。目标平均电阻为 $\\mu_0 = 100.0$ 欧姆。该工程师基于一个大小为 $n=16$ 的随机样本，检验原假设 $H_0: \\mu = \\mu_0$ 与双侧备择假设 $H_1: \\mu \\neq \\mu_0$。检验的显著性水平为 $\\alpha = 0.05$。\n\n对于检验统计量 $Z = \\frac{\\bar{X} - \\mu_0}{\\sigma/\\sqrt{n}}$（其中 $\\bar{X}$ 是样本均值），该工程师考虑了两个不同的临界区。两个检验具有相同的检验水准 $\\alpha$。\n\n**检验S（对称）：** 这是标准的双尾等尾检验。其临界区定义为：如果 $|Z| > z_{\\alpha/2}$，则拒绝 $H_0$。其中 $z_p$ 是标准正态分布的上 $p$-分位数（即 $P(N(0,1) > z_p) = p$）。\n\n**检验A（非对称）：** 该检验使用一个非对称的临界区。犯第一类错误的总概率仍为 $\\alpha$，但它被分配为左尾概率 $\\alpha/4$ 和右尾概率 $3\\alpha/4$。\n\n一个检验的功效（power）是指在备择假设下，对于某个特定的 $\\mu$ 值，该检验正确拒绝原假设的概率。该工程师想要比较当真实平均电阻实际上是 $\\mu_1 = 102.0$ 欧姆时，这两个检验的功效。\n\n计算在 $\\mu_1 = 102.0$ 欧姆处，检验A的功效与检验S的功效之比。\n\n为了帮助您计算，您可以使用以下标准正态分位数及其累积分布函数 (CDF) $\\Phi(z)$ 的值：\n- 分位数：$z_{0.025} = 1.960$, $z_{0.0125} = 2.241$, $z_{0.0375} = 1.781$。\n- CDF 值：$\\Phi(-4.241) = 1.12 \\times 10^{-5}$, $\\Phi(-3.960) = 3.72 \\times 10^{-5}$, $\\Phi(0.040) = 0.5160$, $\\Phi(0.219) = 0.5867$。\n\n将您的最终答案四舍五入到四位有效数字。", "solution": "我们使用统计量 $Z=\\dfrac{\\bar{X}-\\mu_{0}}{\\sigma/\\sqrt{n}}$ 来检验已知 $\\sigma$ 的 $H_{0}:\\mu=\\mu_{0}$。当真实均值为 $\\mu$ 时，$Z$ 的分布是均值为 $\\delta=\\dfrac{\\mu-\\mu_{0}}{\\sigma/\\sqrt{n}}$ 且方差为1的正态分布。\n在此问题中，$\\sigma=4.0$, $n=16$, $\\mu_{0}=100.0$。我们在 $\\mu_{1}=102.0$ 处评估功效，因此样本均值的标准误为 $\\sigma/\\sqrt{n} = 4.0/\\sqrt{16} = 1.0$。\n在备择假设 $\\mu_1=102.0$ 下，$Z$ 的分布均值为：\n$$\n\\delta=\\frac{102.0-100.0}{1.0}=2.0.\n$$\n因此，在 $\\mu=\\mu_{1}$ 的条件下，$Z\\sim N(2,1)$。\n\n**检验S（对称）** 在 $|Z|>z_{\\alpha/2}$ 时拒绝原假设，其中 $\\alpha=0.05$，所以 $z_{\\alpha/2}=z_{0.025}=1.960$。它在 $\\mu_{1}$ 处的功效是：\n$$\n\\pi_{S}(\\mu_{1}) = P(Z  -1.960 | \\mu_1) + P(Z > 1.960 | \\mu_1).\n$$\n令 $Y \\sim N(0,1)$，则 $Z = 2+Y$。\n$$\nP(Z > 1.960 | \\mu_1) = P(Y > 1.960-2) = P(Y > -0.040) = \\Phi(0.040).\n$$\n$$\nP(Z  -1.960 | \\mu_1) = P(Y  -1.960-2) = P(Y  -3.960) = \\Phi(-3.960).\n$$\n使用所提供的值，$\\Phi(0.040)=0.5160$ 和 $\\Phi(-3.960)=3.72\\times 10^{-5}$，我们得到：\n$$\n\\pi_{S}(\\mu_{1}) = 0.5160 + 0.0000372 = 0.5160372.\n$$\n\n**检验A（非对称）** 将 $\\alpha/4$ 的概率分配给左尾，将 $3\\alpha/4$ 的概率分配给右尾。临界值是 $c_L = -z_{\\alpha/4}$ 和 $c_R = z_{3\\alpha/4}$。\n对于 $\\alpha=0.05$，我们有 $\\alpha/4=0.0125$ 和 $3\\alpha/4=0.0375$。\n使用给定的分位数，$c_L = -z_{0.0125} = -2.241$ 且 $c_R = z_{0.0375} = 1.781$。\n该检验在 $\\mu_{1}$ 处的功效是：\n$$\n\\pi_{A}(\\mu_{1}) = P(Z  -2.241 | \\mu_1) + P(Z > 1.781 | \\mu_1).\n$$\n$$\nP(Z > 1.781 | \\mu_1) = P(Y > 1.781 - 2) = P(Y > -0.219) = \\Phi(0.219).\n$$\n$$\nP(Z  -2.241 | \\mu_1) = P(Y  -2.241 - 2) = P(Y  -4.241) = \\Phi(-4.241).\n$$\n使用所提供的值，$\\Phi(0.219)=0.5867$ 和 $\\Phi(-4.241)=1.12 \\times 10^{-5}$，我们得到：\n$$\n\\pi_{A}(\\mu_{1}) = 0.5867 + 0.0000112 = 0.5867112.\n$$\n\n最后，我们计算功效之比：\n$$\n\\frac{\\pi_A(\\mu_1)}{\\pi_S(\\mu_1)} = \\frac{0.5867112}{0.5160372} \\approx 1.13695.\n$$\n四舍五入到四位有效数字，比率为 $1.137$。", "answer": "$$\\boxed{1.137}$$", "id": "1912207"}]}