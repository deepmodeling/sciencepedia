{"hands_on_practices": [{"introduction": "瓦尔德检验最直接的应用之一是检验单个比例参数。这个练习提供了一个典型的场景：评估一种新药的成功率是否与已有的基准值有显著差异。通过计算单个比例的瓦尔德检验统计量，我们可以将在样本中观察到的效应大小（估计值与假设值之差）与其抽样不确定性（标准误）进行比较，这是假设检验中的一个核心思想。[@problem_id:1967067]", "problem": "一家制药公司正在为一种特定的心脏病开发一种新药“CardiaHeal”。根据历史数据，现有治疗方法的成功率为 $p_0 = 0.40$。该公司进行了一项临床试验，以确定“CardiaHeal”是否具有不同的成功率。在试验中，随机抽取了 $n = 200$ 名患有该病的患者接受“CardiaHeal”治疗。其中 $x = 95$ 名患者的治疗被认为是成功的。\n\n为了评估与历史成功率相悖的证据，一名研究人员决定进行一项双边假设检验，其原假设为 $H_0: p = p_0$。\n\n计算此假设检验的瓦尔德检验统计量的值。报告你的答案，保留三位有效数字。", "solution": "我们使用单比例瓦尔德检验来检验 $H_{0}: p = p_{0}$，其中 $p_{0} = 0.40$。\n\n设样本量为 $n = 200$，成功次数为 $x = 95$。$p$ 的最大似然估计量是样本比例\n$$\n\\hat{p} = \\frac{x}{n} = \\frac{95}{200} = 0.475.\n$$\n\n根据大样本理论，$\\hat{p}$ 近似服从正态分布，其均值为 $p$，方差为 $p(1-p)/n$。瓦尔德检验使用在无约束最大似然估计量 $\\hat{p}$ 处评估的估计标准误：\n$$\n\\widehat{\\operatorname{SE}}(\\hat{p}) = \\sqrt{\\frac{\\hat{p}\\left(1-\\hat{p}\\right)}{n}}.\n$$\n因此，瓦尔德检验统计量为\n$$\nZ_{\\text{W}} = \\frac{\\hat{p} - p_{0}}{\\sqrt{\\frac{\\hat{p}\\left(1-\\hat{p}\\right)}{n}}}.\n$$\n\n代入数值，\n$$\nZ_{\\text{W}} = \\frac{0.475 - 0.40}{\\sqrt{\\frac{0.475 \\times 0.525}{200}}}\n= \\frac{0.075}{\\sqrt{\\frac{0.249375}{200}}}\n= \\frac{0.075}{\\sqrt{0.001246875}}\n\\approx \\frac{0.075}{0.0353253}\n\\approx 2.12.\n$$\n\n保留三位有效数字，瓦尔德检验统计量为 $2.12$。", "answer": "$$\\boxed{2.12}$$", "id": "1967067"}, {"introduction": "瓦尔德检验的原理具有广泛的适用性，并不仅限于比例数据。这个练习将该方法应用于服从泊松分布的计数数据，例如遗传学中的突变计数。您将看到，尽管数据分布和参数（泊松率 $\\lambda$）不同，但构建瓦尔德检验统计量的基本逻辑——即 “(估计量 - 假设值) / 估计量的标准误” —— 保持不变。[@problem_id:1967113]", "problem": "一个遗传学家团队正在研究一个特定基因片段的突变。根据长期的历史数据，在该片段中观察到的突变数量可以很好地用泊松分布建模，其平均率为每个片段 $\\lambda_0 = 2.5$ 次突变。该团队假设一种新的环境化学物质可能会改变这个突变率。为了检验他们的假设，他们将一个群体暴露于该化学物质中，然后分析来自该群体的 $n=150$ 个独立基因片段的样本。总共，他们在这150个片段中计数到420次突变。\n\n假设暴露群体中每个片段的突变数也遵循一个均值未知的泊松分布 $\\lambda$，该团队决定执行瓦尔德检验（Wald test）来评估原假设 $H_0: \\lambda = \\lambda_0$。\n\n计算此假设的瓦尔德统计量（平方形式）$W$。将您的最终答案四舍五入到三位有效数字。", "solution": "我们将每个片段的突变计数建模为均值为 $\\lambda$ 的独立泊松随机变量。设 $X_{1},\\dots,X_{n}$ 为 $n$ 个片段的计数，因此 $X_{i} \\sim \\text{Poisson}(\\lambda)$ 并且 $\\sum_{i=1}^{n} X_{i} \\sim \\text{Poisson}(n\\lambda)$。$\\lambda$ 的对数似然函数为\n$$\n\\ell(\\lambda)=\\sum_{i=1}^{n}\\left(-\\lambda+X_{i}\\ln\\lambda-\\ln(X_{i}!)\\right).\n$$\n求导并令其为零，得到最大似然估计（MLE）：\n$$\n\\frac{\\partial \\ell}{\\partial \\lambda}=\\sum_{i=1}^{n}\\left(-1+\\frac{X_{i}}{\\lambda}\\right)=0\n\\;\\;\\Longrightarrow\\;\\;\n\\hat{\\lambda}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}.\n$$\n基于 $n$ 个观测值的 $\\lambda$ 的费雪信息（Fisher information）为\n$$\nI_{n}(\\lambda)=\\frac{n}{\\lambda},\n$$\n因此 $\\hat{\\lambda}$ 的渐近方差为 $\\lambda/n$。对于 $H_{0}:\\lambda=\\lambda_{0}$ 的瓦尔德检验，我们通过代入 $\\hat{\\lambda}$ 来估计这个方差，得到 $\\widehat{\\mathrm{Var}}(\\hat{\\lambda})=\\hat{\\lambda}/n$。因此，瓦尔德统计量（平方形式）为\n$$\nW=\\frac{(\\hat{\\lambda}-\\lambda_{0})^{2}}{\\hat{\\lambda}/n}=n\\,\\frac{(\\hat{\\lambda}-\\lambda_{0})^{2}}{\\hat{\\lambda}}.\n$$\n在数据中，$n=150$ 且总计数为 $T=\\sum_{i=1}^{n}X_{i}=420$，所以\n$$\n\\hat{\\lambda}=\\frac{T}{n}=\\frac{420}{150}=\\frac{14}{5}.\n$$\n使用 $\\lambda_{0}=2.5$，我们计算\n$$\nW=150\\,\\frac{\\left(\\frac{14}{5}-\\frac{5}{2}\\right)^{2}}{\\frac{14}{5}}\n=150\\,\\frac{\\left(\\frac{28-25}{10}\\right)^{2}}{\\frac{14}{5}}\n=150\\,\\frac{\\left(\\frac{3}{10}\\right)^{2}}{\\frac{14}{5}}\n=150\\,\\frac{\\frac{9}{100}}{\\frac{14}{5}}\n=\\frac{150\\times 9}{100}\\cdot\\frac{5}{14}\n=\\frac{27}{2}\\cdot\\frac{5}{14}\n=\\frac{135}{28}.\n$$\n数值上，$\\frac{135}{28}\\approx 4.82142857\\ldots$，四舍五入到三位有效数字为 $4.82$。", "answer": "$$\\boxed{4.82}$$", "id": "1967113"}, {"introduction": "在更复杂的研究中，我们常常对多个参数之间的关系感兴趣，而不是单个参数的值。这个问题展示了瓦尔德检验如何处理涉及多个参数的假设，具体来说是检验两个独立的泊松过程的率参数之间是否存在特定的倍数关系（$H_0: \\lambda_1 - 2\\lambda_2 = 0$）。解决这个问题需要使用德尔塔方法来估计参数函数的方差，这是展示瓦尔德检验在大样本理论框架下灵活性和强大功能的一个绝佳例子。[@problem_id:1967060]", "problem": "两个独立的天文巡天旨在探测Ia型超新星。第一次巡天在天空的特定区域进行，持续时间为 $T_1 = 2.0$ 年，探测到 $x_1 = 125$ 颗超新星。第二次巡天观测一个不同的区域，持续时间为 $T_2 = 1.25$ 年，探测到 $x_2 = 35$ 颗超新星。\n\n假设对于每次巡天 $i \\in \\{1, 2\\}$，探测到的超新星数量 $X_i$ 服从均值为 $\\lambda_i T_i$ 的泊松分布，其中 $\\lambda_i$ 是第 $i$ 次巡天所观测区域每年超新星发生的恒定平均速率。这两个过程在统计上是独立的。\n\n一个特定的宇宙学模型预测了两个观测区域的超新星速率之间存在一个特定的关系，即第一个区域的速率恰好是第二个区域速率的两倍。你的任务是检验这个预测。原假设为 $H_0: \\lambda_1 - 2\\lambda_2 = 0$，备择假设为 $H_a: \\lambda_1 - 2\\lambda_2 \\neq 0$。\n\n为此假设构建适当的瓦尔德检验。使用所提供的观测数据，计算瓦尔德检验统计量的数值，该统计量在原假设下渐近服从卡方随机变量分布。将你的最终答案四舍五入到四位有效数字。", "solution": "我们建立模型 $X_{i} \\sim \\text{Poisson}(\\lambda_{i} T_{i})$，对于 $i \\in \\{1,2\\}$ 相互独立，且 $T_{1}$ 和 $T_{2}$ 为固定值。每个速率的最大似然估计量为 $\\hat{\\lambda}_{i} = X_{i}/T_{i}$，这是通过最大化泊松似然函数得到的。由于对于泊松随机变量有 $\\operatorname{Var}(X_{i}) = \\lambda_{i} T_{i}$，可得\n$$\n\\operatorname{Var}(\\hat{\\lambda}_{i}) = \\operatorname{Var}\\!\\left(\\frac{X_{i}}{T_{i}}\\right) = \\frac{\\lambda_{i} T_{i}}{T_{i}^{2}} = \\frac{\\lambda_{i}}{T_{i}}.\n$$\n定义感兴趣的参数 $g(\\lambda_{1},\\lambda_{2}) = \\lambda_{1} - 2\\lambda_{2}$，其梯度向量为 $Dg = \\begin{pmatrix} 1  -2 \\end{pmatrix}$。根据德尔塔方法，使用 $\\Sigma = \\operatorname{diag}\\!\\left(\\frac{\\lambda_{1}}{T_{1}}, \\frac{\\lambda_{2}}{T_{2}}\\right)$ 和独立性，\n$$\n\\operatorname{Var}\\big(g(\\hat{\\lambda}_{1},\\hat{\\lambda}_{2})\\big) \\approx Dg \\, \\Sigma \\, Dg^{\\top} = \\frac{\\lambda_{1}}{T_{1}} + 4 \\frac{\\lambda_{2}}{T_{2}}.\n$$\n用于检验 $H_{0}: \\lambda_{1} - 2\\lambda_{2} = 0$ 的瓦尔德统计量是\n$$\nW = \\frac{\\big(g(\\hat{\\lambda}_{1},\\hat{\\lambda}_{2}) - 0\\big)^{2}}{\\widehat{\\operatorname{Var}}\\big(g(\\hat{\\lambda}_{1},\\hat{\\lambda}_{2})\\big)},\n$$\n其中方差的代入估计量为\n$$\n\\widehat{\\operatorname{Var}}\\big(g(\\hat{\\lambda}_{1},\\hat{\\lambda}_{2})\\big) = \\frac{\\hat{\\lambda}_{1}}{T_{1}} + 4 \\frac{\\hat{\\lambda}_{2}}{T_{2}} = \\frac{X_{1}}{T_{1}^{2}} + 4 \\frac{X_{2}}{T_{2}^{2}}.\n$$\n因此，\n$$\nW = \\frac{\\left(\\frac{X_{1}}{T_{1}} - 2 \\frac{X_{2}}{T_{2}}\\right)^{2}}{\\frac{X_{1}}{T_{1}^{2}} + 4 \\frac{X_{2}}{T_{2}^{2}}} \\;\\;\\overset{H_{0}}{\\sim}\\;\\; \\chi^{2}_{1} \\text{ asymptotically.}\n$$\n代入数据 $T_{1} = 2.0$, $X_{1} = 125$, $T_{2} = 1.25 = \\frac{5}{4}$, $X_{2} = 35$：\n$$\n\\hat{\\lambda}_{1} = \\frac{125}{2} = 62.5,\\quad \\hat{\\lambda}_{2} = \\frac{35}{5/4} = 28,\n$$\n$$\ng(\\hat{\\lambda}_{1},\\hat{\\lambda}_{2}) = 62.5 - 2 \\cdot 28 = 6.5 = \\frac{13}{2},\n$$\n$$\n\\widehat{\\operatorname{Var}} = \\frac{X_{1}}{T_{1}^{2}} + 4 \\frac{X_{2}}{T_{2}^{2}} = \\frac{125}{4} + 4 \\cdot \\frac{35}{(5/4)^{2}} = \\frac{125}{4} + 4 \\cdot \\frac{35}{25/16} = \\frac{125}{4} + \\frac{448}{5} = \\frac{2417}{20}.\n$$\n因此，\n$$\nW = \\frac{\\left(\\frac{13}{2}\\right)^{2}}{\\frac{2417}{20}} = \\frac{\\frac{169}{4}}{\\frac{2417}{20}} = \\frac{169}{4} \\cdot \\frac{20}{2417} = \\frac{845}{2417} \\approx 0.3496,\n$$\n其中数值结果四舍五入到四位有效数字。", "answer": "$$\\boxed{0.3496}$$", "id": "1967060"}]}