{"hands_on_practices": [{"introduction": "本次练习为应用卡方检验提供了基础性实践。通过一个关于大学生偏好的真实场景，你将掌握从列联表中计算 $\\chi^2$ 统计量的核心步骤。这项基本技能是检验两个分类变量之间独立性的第一步。", "problem": "一所大学的机构研究办公室正在调查学生的学习年级与其偏好的学习方式之间是否存在关联。对1100名本科生进行了一次随机抽样调查，结果汇总在下方的列联表中。表格的行代表学生的学习年级（大一、大二、大三、大四），列代表他们偏好的学习方式（完全线下授课、混合式、完全线上授课）。\n\n观测频数如下：\n- **大一**：完全线下授课155人，混合式85人，完全线上授课30人。\n- **大二**：完全线下授课120人，混合式110人，完全线上授课50人。\n- **大三**：完全线下授课90人，混合式135人，完全线上授课65人。\n- **大四**：完全线下授课75人，混合式100人，完全线上授课85人。\n\n为确定这两个分类变量是否独立，将进行卡方（$\\chi^2$）独立性检验。基于此数据计算卡方检验统计量的值。将最终答案四舍五入到四位有效数字。", "solution": "我们使用卡方检验来检验学习年级（行）和偏好的学习方式（列）之间的独立性。对于一个观测频数为 $O_{ij}$、行合计为 $R_{i}$、列合计为 $C_{j}$、总计为 $N$ 的列联表，独立性假设下的期望频数为\n$$\nE_{ij}=\\frac{R_{i}C_{j}}{N},\n$$\n卡方统计量为\n$$\n\\chi^{2}=\\sum_{i}\\sum_{j}\\frac{(O_{ij}-E_{ij})^{2}}{E_{ij}}.\n$$\n首先计算行合计、列合计和总计：\n$$\n\\begin{aligned}\n\\text{行合计：}  R_{\\text{F}}=155+85+30=270, \\quad R_{\\text{So}}=120+110+50=280, \\\\\n R_{\\text{J}}=90+135+65=290, \\quad R_{\\text{Se}}=75+100+85=260. \\\\\n\\text{列合计：}  C_{\\text{IP}}=155+120+90+75=440, \\\\\n C_{\\text{H}}=85+110+135+100=430, \\\\\n C_{\\text{OL}}=30+50+65+85=230. \\\\\n\\text{总计：}  N=1100.\n\\end{aligned}\n$$\n计算每个单元格的期望频数 $E_{ij}=(R_{i}C_{j})/N$：\n$$\n\\begin{aligned}\nE_{\\text{F,IP}}=\\frac{270\\cdot 440}{1100}=108, \\quad  E_{\\text{F,H}}=\\frac{270\\cdot 430}{1100}=\\frac{1161}{11}, \\quad  E_{\\text{F,OL}}=\\frac{270\\cdot 230}{1100}=\\frac{621}{11}, \\\\\nE_{\\text{So,IP}}=\\frac{280\\cdot 440}{1100}=112, \\quad  E_{\\text{So,H}}=\\frac{280\\cdot 430}{1100}=\\frac{1204}{11}, \\quad  E_{\\text{So,OL}}=\\frac{280\\cdot 230}{1100}=\\frac{644}{11}, \\\\\nE_{\\text{J,IP}}=\\frac{290\\cdot 440}{1100}=116, \\quad  E_{\\text{J,H}}=\\frac{290\\cdot 430}{1100}=\\frac{1247}{11}, \\quad  E_{\\text{J,OL}}=\\frac{290\\cdot 230}{1100}=\\frac{667}{11}, \\\\\nE_{\\text{Se,IP}}=\\frac{260\\cdot 440}{1100}=104, \\quad  E_{\\text{Se,H}}=\\frac{260\\cdot 430}{1100}=\\frac{1118}{11}, \\quad  E_{\\text{Se,OL}}=\\frac{260\\cdot 230}{1100}=\\frac{598}{11}.\n\\end{aligned}\n$$\n现在计算每个单元格的贡献值 $(O_{ij}-E_{ij})^{2}/E_{ij}$：\n$$\n\\begin{aligned}\n\\text{F,IP: }  \\frac{(155-108)^{2}}{108}=\\frac{2209}{108}, \\quad\n \\text{F,H: }  \\frac{\\left(85-\\frac{1161}{11}\\right)^{2}}{\\frac{1161}{11}}=\\frac{51076}{12771}, \\quad\n \\text{F,OL: }  \\frac{\\left(30-\\frac{621}{11}\\right)^{2}}{\\frac{621}{11}}=\\frac{9409}{759},\\\\\n\\text{So,IP: }  \\frac{(120-112)^{2}}{112}=\\frac{64}{112}=\\frac{4}{7}, \\quad\n \\text{So,H: }  \\frac{\\left(110-\\frac{1204}{11}\\right)^{2}}{\\frac{1204}{11}}=\\frac{9}{3311}, \\quad\n \\text{So,OL: }  \\frac{\\left(50-\\frac{644}{11}\\right)^{2}}{\\frac{644}{11}}=\\frac{2209}{1771},\\\\\n\\text{J,IP: }  \\frac{(90-116)^{2}}{116}=\\frac{676}{116}=\\frac{169}{29}, \\quad\n \\text{J,H: }  \\frac{\\left(135-\\frac{1247}{11}\\right)^{2}}{\\frac{1247}{11}}=\\frac{56644}{13717}, \\quad\n \\text{J,OL: }  \\frac{\\left(65-\\frac{667}{11}\\right)^{2}}{\\frac{667}{11}}=\\frac{2304}{7337},\\\\\n\\text{Se,IP: }  \\frac{(75-104)^{2}}{104}=\\frac{841}{104}, \\quad\n \\text{Se,H: }  \\frac{\\left(100-\\frac{1118}{11}\\right)^{2}}{\\frac{1118}{11}}=\\frac{162}{6149}, \\quad\n \\text{Se,OL: }  \\frac{\\left(85-\\frac{598}{11}\\right)^{2}}{\\frac{598}{11}}=\\frac{113569}{6578}.\n\\end{aligned}\n$$\n将所有贡献值相加，得到卡方统计量：\n$$\n\\chi^{2}=\\frac{2209}{108}+\\frac{51076}{12771}+\\frac{9409}{759}+\\frac{4}{7}+\\frac{9}{3311}+\\frac{2209}{1771}+\\frac{169}{29}+\\frac{56644}{13717}+\\frac{2304}{7337}+\\frac{841}{104}+\\frac{162}{6149}+\\frac{113569}{6578}.\n$$\n对这个和进行数值计算可得\n$$\n\\chi^{2}\\approx 74.320079\\ldots\n$$\n四舍五入到四位有效数字，得到 $74.32$。", "answer": "$$\\boxed{74.32}$$", "id": "1904614"}, {"introduction": "现实世界的数据分析不仅仅是简单地套用公式，还需要验证检验的假设是否得到满足。[@problem_id:1904570]这个问题引入了一个常见情况：某些单元格的期望频数过低，这违反了卡方检验的一个关键假设。你将学习到合并类别这一实用且必要的技术，以确保统计结论的有效性。", "problem": "一个数据科学家团队正在分析一个包含400局远程国际象棋对局的数据集，以研究棋手水平与他们在对抗西西里防御时选择的开局体系之间是否存在潜在关系。棋手水平根据ELO等级分系统分为四个等级区间，ELO等级分系统是一种用于计算对抗性游戏中棋手相对技能水平的方法。开局选择被分为两大类：“开放式西西里”体系，通常导致尖锐、战术性的局面；以及“封闭式西西里”体系，通常导致更具战略性、局面性的对弈。\n\n这400局对局的观测频率总结在下表中：\n\n| 棋手ELO等级分区间 | 开放式西西里 | 封闭式西西里 |\n| :--- | :---: | :---: |\n| 低于 1500 | 60 | 30 |\n| 1500至1999 | 120 | 80 |\n| 2000至2399 | 75 | 25 |\n| 2400或更高 | 8 | 2 |\n\n为了评估开局体系的选择是否独立于棋手的ELO等级分区间，您的任务是计算相应的卡方（$\\chi^2$）检验统计量。在必要时，合并相邻的类别以确保检验假设的有效性，并使用合并后的表格进行计算。\n\n计算$\\chi^2$统计量的值。将您的最终答案四舍五入到四位有效数字。", "solution": "问题要求我们计算卡方（$\\chi^2$）统计量，以检验两个分类变量之间的独立性：棋手ELO等级分区间和开局体系的选择。\n\n首先，我们建立原假设和备择假设。\n$H_0$：开局体系的选择独立于棋手的ELO等级分区间。\n$H_1$：开局体系的选择不独立于棋手的ELO等级分区间。\n\n观测频率$O_{ij}$已在问题描述中给出。我们可以为表格增加行和列的总计。\n\n| ELO区间 | 开放式西西里 | 封闭式西西里 | 行总计 |\n| :--- | :---: | :---: | :---: |\n| 低于 1500 | 60 | 30 | 90 |\n| 1500-1999 | 120 | 80 | 200 |\n| 2000-2399 | 75 | 25 | 100 |\n| 2400或更高 | 8 | 2 | 10 |\n| **列总计**| **263** | **137** | **400** |\n\n观测总数为 $N = 400$。\n\n卡方检验要求我们在原假设为真的前提下，计算每个单元格的期望频率$E_{ij}$。第$i$行和第$j$列单元格的期望频率计算公式为：\n$$E_{ij} = \\frac{(\\text{Row Total}_i) \\times (\\text{Column Total}_j)}{N}$$\n\n让我们计算原始4x2表格的期望频率：\n$E_{11} = \\frac{90 \\times 263}{400} = 59.175$\n$E_{12} = \\frac{90 \\times 137}{400} = 30.825$\n$E_{21} = \\frac{200 \\times 263}{400} = 131.5$\n$E_{22} = \\frac{200 \\times 137}{400} = 68.5$\n$E_{31} = \\frac{100 \\times 263}{400} = 65.75$\n$E_{32} = \\frac{100 \\times 137}{400} = 34.25$\n$E_{41} = \\frac{10 \\times 263}{400} = 6.575$\n$E_{42} = \\frac{10 \\times 137}{400} = 3.425$\n\n卡方检验有效性的一个通用经验法则是，所有期望频率应至少为5。我们观察到$E_{42} = 3.425$，小于5。为了解决这个问题，我们必须合并类别。最合乎逻辑的方法是将最小的类别（“2400或更高”）与相邻的类别（“2000-2399”）合并，形成一个新类别：“2000或更高”。\n\n我们现在通过对合并类别的观测频率求和，构建一个新的列联表。\n\n合并后新的观测频率表：\n| ELO区间 | 开放式西西里 | 封闭式西西里 | 行总计 |\n|---|---|---|---|\n| 低于 1500 | 60 | 30 | 90 |\n| 1500-1999 | 120 | 80 | 200 |\n| 2000或更高 | 75+8 = 83 | 25+2 = 27 | 100+10 = 110 |\n| **列总计** | **263** | **137** | **400** |\n\n现在，我们为这个新的3x2表格重新计算期望频率。我们将其记为$E'_{ij}$。\n$E'_{11} = \\frac{90 \\times 263}{400} = 59.175$\n$E'_{12} = \\frac{90 \\times 137}{400} = 30.825$\n$E'_{21} = \\frac{200 \\times 263}{400} = 131.5$\n$E'_{22} = \\frac{200 \\times 137}{400} = 68.5$\n$E'_{31} = \\frac{110 \\times 263}{400} = 72.325$\n$E'_{32} = \\frac{110 \\times 137}{400} = 37.675$\n\n所有新的期望频率都大于5，因此现在进行卡方检验是合适的。卡方统计量使用以下公式计算：\n$$\\chi^2 = \\sum_{i,j} \\frac{(O_{ij} - E'_{ij})^2}{E'_{ij}}$$\n我们计算合并后的3x2表格中每个单元格的贡献值：\n- 单元格 (1,1)：$\\frac{(60 - 59.175)^2}{59.175} = \\frac{0.825^2}{59.175} = \\frac{0.680625}{59.175} \\approx 0.0115019$\n- 单元格 (1,2)：$\\frac{(30 - 30.825)^2}{30.825} = \\frac{(-0.825)^2}{30.825} = \\frac{0.680625}{30.825} \\approx 0.0220803$\n- 单元格 (2,1)：$\\frac{(120 - 131.5)^2}{131.5} = \\frac{(-11.5)^2}{131.5} = \\frac{132.25}{131.5} \\approx 1.0057034$\n- 单元格 (2,2)：$\\frac{(80 - 68.5)^2}{68.5} = \\frac{11.5^2}{68.5} = \\frac{132.25}{68.5} \\approx 1.9306569$\n- 单元格 (3,1)：$\\frac{(83 - 72.325)^2}{72.325} = \\frac{10.675^2}{72.325} = \\frac{113.955625}{72.325} \\approx 1.5756323$\n- 单元格 (3,2)：$\\frac{(27 - 37.675)^2}{37.675} = \\frac{(-10.675)^2}{37.675} = \\frac{113.955625}{37.675} \\approx 3.0247012$\n\n将这些值相加得到卡方统计量：\n$\\chi^2 \\approx 0.0115019 + 0.0220803 + 1.0057034 + 1.9306569 + 1.5756323 + 3.0247012$\n$\\chi^2 \\approx 7.570276$\n\n将结果四舍五入到四位有效数字，我们得到7.570。", "answer": "$$\\boxed{7.570}$$", "id": "1904570"}, {"introduction": "一个显著的卡方检验结果告诉我们变量之间存在关联，但它没有具体说明关联存在于何处。[@problem_id:1904581]这个高级实践展示了如何通过“分解”卡方分析来更深入地探究关联的来源。通过将一个多分类变量合并为一个有意义的二元变量，你可以进行后续检验，从而精确定位导致整体结果显著的特定关系。", "problem": "一个材料科学研究团队正在研究一种新型聚合物复合材料在不同热载荷下的失效特性。在他们的实验中，样本被置于四个离散的温度范围（低、中、高、极端）之一，直到发生失效。然后将失效类型分为三类之一：脆性断裂（Fracture）、层间分层（Delamination）或粘弹性变形（Deformation）。\n\n从大量测试中观察到的每种温度和失效模式组合的频率汇总在下面的 $3 \\times 4$ 列联表中：\n\n| 失效模式 | 低温 | 中温 | 高温 | 极端温度 |\n|:---|:---:|:---:|:---:|:---:|\n| 断裂 | 50 | 40 | 20 | 10 |\n| 分层 | 20 | 30 | 45 | 55 |\n| 变形 | 10 | 15 | 35 | 40 |\n\n对完整的 $3 \\times 4$ 表格的初步分析已经证实，温度范围和失效模式之间存在统计学上的显著关联。为了确定这种关联的来源，研究负责人提出了一项具体的后续分析。他们有兴趣检验这样一个原假设：温度与“断裂”模式和“非断裂”模式（其中“非断裂”是“分层”和“变形”的组合类别）的发生之间没有关联。\n\n计算这个特定分割分析的皮尔逊卡方统计量的值，该分析比较了四个温度范围内“断裂”类别与组合的“非断裂”类别。将您的最终答案表示为一个无量纲值，并四舍五入到四位有效数字。", "solution": "我们通过将“分层”和“变形”合并为单一的“非断裂”类别，将 $3\\times 4$ 的表格压缩为 $2\\times 4$ 的表格。按温度划分的观测频数为：\n- 断裂：$(50,\\ 40,\\ 20,\\ 10)$\n- 非断裂：$(30,\\ 45,\\ 80,\\ 95)$\n\n列总计为 $(80,\\ 85,\\ 100,\\ 105)$，行总计为 $120$（断裂）和 $250$（非断裂），总计为 $N=370$。\n\n在无关联（独立性）的原假设下，每个单元格的期望频数由下式给出\n$$\nE_{ij}=\\frac{(\\text{row total})_{i}\\,(\\text{column total})_{j}}{N}.\n$$\n因此，对于每个温度 $j$，\n$$\nE_{\\text{F},j}=\\frac{120\\,C_{j}}{370},\\qquad E_{\\text{NF},j}=\\frac{250\\,C_{j}}{370}.\n$$\n\n皮尔逊卡方统计量为\n$$\n\\chi^{2}=\\sum_{j=1}^{4}\\left[\\frac{(O_{\\text{F},j}-E_{\\text{F},j})^{2}}{E_{\\text{F},j}}+\\frac{(O_{\\text{NF},j}-E_{\\text{NF},j})^{2}}{E_{\\text{NF},j}}\\right].\n$$\n\n按列计算贡献值：\n\n1) 低温（列总计 $C=80$）：\n$$\nE_{\\text{F}}=\\frac{120\\cdot 80}{370}=\\frac{960}{37},\\quad E_{\\text{NF}}=\\frac{250\\cdot 80}{370}=\\frac{2000}{37},\n$$\n$$\nO_{\\text{F}}-E_{\\text{F}}=50-\\frac{960}{37}=\\frac{890}{37},\\quad O_{\\text{NF}}-E_{\\text{NF}}=30-\\frac{2000}{37}=-\\frac{890}{37}.\n$$\n因此\n$$\n\\text{Low total}=\\frac{(890/37)^{2}}{960/37}+\\frac{(890/37)^{2}}{2000/37}=\\frac{890^{2}}{37}\\left(\\frac{1}{960}+\\frac{1}{2000}\\right)=\\frac{792100}{37}\\cdot\\frac{2960}{1920000}=\\frac{7921}{240}.\n$$\n\n2) 中温 ($C=85$):\n$$\nE_{\\text{F}}=\\frac{1020}{37},\\quad E_{\\text{NF}}=\\frac{2125}{37},\\quad O_{\\text{F}}-E_{\\text{F}}=\\frac{460}{37},\\quad O_{\\text{NF}}-E_{\\text{NF}}=-\\frac{460}{37},\n$$\n$$\n\\text{Medium total}=\\frac{460^{2}}{37}\\left(\\frac{1}{1020}+\\frac{1}{2125}\\right)=\\frac{211600}{37}\\cdot\\frac{3145}{2167500}=\\frac{211600\\cdot 85}{2167500}=\\frac{2116}{255}.\n$$\n\n3) 高温 ($C=100$):\n$$\nE_{\\text{F}}=\\frac{1200}{37},\\quad E_{\\text{NF}}=\\frac{2500}{37},\\quad O_{\\text{F}}-E_{\\text{F}}=-\\frac{460}{37},\\quad O_{\\text{NF}}-E_{\\text{NF}}=\\frac{460}{37},\n$$\n$$\n\\text{High total}=\\frac{460^{2}}{37}\\left(\\frac{1}{1200}+\\frac{1}{2500}\\right)=\\frac{211600}{37}\\cdot\\frac{3700}{3000000}=\\frac{2116}{300}=\\frac{529}{75}.\n$$\n\n4) 极端温度 ($C=105$):\n$$\nE_{\\text{F}}=\\frac{1260}{37},\\quad E_{\\text{NF}}=\\frac{2625}{37},\\quad O_{\\text{F}}-E_{\\text{F}}=-\\frac{890}{37},\\quad O_{\\text{NF}}-E_{\\text{NF}}=\\frac{890}{37},\n$$\n$$\n\\text{Extreme total}=\\frac{890^{2}}{37}\\left(\\frac{1}{1260}+\\frac{1}{2625}\\right)=\\frac{792100}{37}\\cdot\\frac{3885}{3307500}=\\frac{792100\\cdot 105}{3307500}=\\frac{7921}{315}.\n$$\n\n将四列的贡献值相加：\n$$\n\\chi^{2}=\\frac{7921}{240}+\\frac{2116}{255}+\\frac{529}{75}+\\frac{7921}{315}.\n$$\n计算这个和，我们得到\n$$\n\\chi^{2}\\approx 73.50157096171802.\n$$\n四舍五入到四位有效数字，皮尔逊卡方统计量为 $73.50$。", "answer": "$$\\boxed{73.50}$$", "id": "1904581"}]}