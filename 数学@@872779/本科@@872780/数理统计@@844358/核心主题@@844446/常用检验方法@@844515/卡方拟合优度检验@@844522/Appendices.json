{"hands_on_practices": [{"introduction": "让我们从卡方拟合优度检验最基本的应用之一开始：检验均匀性。这个练习探讨了一个常见的情景，即我们想知道观测值是否均匀地分布在几个类别中。通过解决这个问题 [@problem_id:1903926]，你将掌握检验均匀分布的基础技能，这是许多科学和社会分析中的基准假设。", "problem": "一位犯罪学家正在分析一个小城市的犯罪模式。为了协助资源分配，他们想确定非暴力犯罪的发生是否在一周内均匀分布。在过去一年中，报告的非暴力犯罪总数为1000起。按星期几的细分如下：\n\n- 星期一: 155\n- 星期二: 130\n- 星期三: 125\n- 星期四: 140\n- 星期五: 165\n- 星期六: 160\n- 星期日: 125\n\n该犯罪学家决定使用 $\\alpha = 0.05$ 的显著性水平来检验犯罪在一周七天内呈均匀分布的假设。在给定的显著性水平下，该检验的相应临界值为12.592。\n\n根据这些数据，以下哪个结论是正确的？\n\nA. 证据足以断定犯罪分布不均匀，因为计算出的检验统计量大于临界值。\n\nB. 证据不足以断定犯罪分布不均匀，因为计算出的检验统计量小于临界值。\n\nC. 证据足以断定犯罪分布不均匀，因为计算出的检验统计量小于临界值。\n\nD. 证据不足以断定犯罪分布不均匀，因为计算出的检验统计量大于临界值。", "solution": "我们正在检验一周七天内是否服从均匀分布的拟合优度。设原假设为分布是均匀的，备择假设为分布不是均匀的。在总数为 $N=1000$ 和 $k=7$ 个类别的情况下，原假设下每天的期望计数为\n$$\nE=\\frac{N}{k}=\\frac{1000}{7}.\n$$\n卡方检验统计量为\n$$\n\\chi^{2}=\\sum_{i=1}^{7}\\frac{(O_{i}-E)^{2}}{E},\n$$\n其中 $O_{i}$ 是观测计数。\n\n计算每一项的贡献：\n- 星期一: $O_{1}=155$, $O_{1}-E=\\frac{85}{7}$, 贡献 $\\frac{(85/7)^{2}}{1000/7}=\\frac{289}{280}$.\n- 星期二: $O_{2}=130$, $O_{2}-E=-\\frac{90}{7}$, 贡献 $\\frac{(90/7)^{2}}{1000/7}=\\frac{81}{70}$.\n- 星期三: $O_{3}=125$, $O_{3}-E=-\\frac{125}{7}$, 贡献 $\\frac{(125/7)^{2}}{1000/7}=\\frac{125}{56}$.\n- 星期四: $O_{4}=140$, $O_{4}-E=-\\frac{20}{7}$, 贡献 $\\frac{(20/7)^{2}}{1000/7}=\\frac{2}{35}$.\n- 星期五: $O_{5}=165$, $O_{5}-E=\\frac{155}{7}$, 贡献 $\\frac{(155/7)^{2}}{1000/7}=\\frac{961}{280}$.\n- 星期六: $O_{6}=160$, $O_{6}-E=\\frac{120}{7}$, 贡献 $\\frac{(120/7)^{2}}{1000/7}=\\frac{72}{35}$.\n- 星期日: $O_{7}=125$, 与星期三相同，贡献 $\\frac{125}{56}$.\n\n将这些项相加，\n$$\n\\chi^{2}=\\frac{289}{280}+\\frac{81}{70}+\\frac{125}{56}+\\frac{2}{35}+\\frac{961}{280}+\\frac{72}{35}+\\frac{125}{56}=\\frac{427}{35}=12.2.\n$$\n自由度为 $k-1=6$ 且显著性水平为 $\\alpha=0.05$ 时，给定的临界值为 $12.592$。决策规则是：如果 $\\chi^{2}>\\text{临界值}$，则拒绝原假设。由于 $12.2  12.592$，我们不拒绝原假设。\n\n因此，证据不足以断定犯罪的分布不均匀，正确选项是B。", "answer": "$$\\boxed{B}$$", "id": "1903926"}, {"introduction": "在均匀性检验的基础上，我们常常需要检验数据是否符合一个特定的、预先定义的、各类别比例不等的理论模型。这个练习模拟了一个真实的质量控制问题，制造商必须验证新工艺是否维持了既定的质量标准。此练习 [@problem_id:1903931] 将巩固你根据给定的一组概率计算期望频数和卡方统计量的能力。", "problem": "一家智能手机制造商“PixelPerfect Inc.”对其旗舰手机屏幕有既定的质量标准。根据长期历史数据，90%的屏幕被归类为“完美”，8%为“可接受”（有轻微、几乎难以察觉的外观瑕疵），2%为“有缺陷”（有坏点或变色等问题）。\n\n该公司试用了一种新的、更具成本效益的制造工艺。为了评估其对质量的影响，使用这种新工艺生产了一批400部手机的样本。对这批样本的检查显示：350个屏幕为“完美”，30个为“可接受”，20个为“有缺陷”。\n\n管理层希望确定新工艺是否显著改变了质量分布。请在$\\alpha = 0.05$的显著性水平下进行卡方拟合优度检验。已知该检验的临界值为$\\chi^2_{0.05, 2} = 5.991$，其中下标分别表示显著性水平和自由度。\n\n卡方检验统计量的值是多少？对于该假设检验，正确的结论是什么？\n\nA. 检验统计量为1.62；不拒绝原假设。\n\nB. 检验统计量为1.62；拒绝原假设。\n\nC. 检验统计量为18.40；不拒绝原假设。\n\nD. 检验统计量为18.40；拒绝原假设。", "solution": "设三个质量类别为“完美”、“可接受”和“有缺陷”，在原假设$H_{0}$下，其历史概率分别为$p_{1}=0.90$、$p_{2}=0.08$和$p_{3}=0.02$。备择假设$H_{1}$是质量分布与这些值不同。样本量为$n=400$，观测频数分别为$O_{1}=350$、$O_{2}=30$和$O_{3}=20$。在$H_{0}$下的期望频数为$E_{i}=n p_{i}$，因此\n$$\nE_{1}=0.90 \\times 400=360,\\quad E_{2}=0.08 \\times 400=32,\\quad E_{3}=0.02 \\times 400=8.\n$$\n\n卡方拟合优度检验统计量为\n$$\n\\chi^{2}=\\sum_{i=1}^{3}\\frac{(O_{i}-E_{i})^{2}}{E_{i}}=\\frac{(350-360)^{2}}{360}+\\frac{(30-32)^{2}}{32}+\\frac{(20-8)^{2}}{8}.\n$$\n计算每一项：\n$$\n\\frac{(350-360)^{2}}{360}=\\frac{100}{360}=\\frac{5}{18},\\quad \\frac{(30-32)^{2}}{32}=\\frac{4}{32}=\\frac{1}{8},\\quad \\frac{(20-8)^{2}}{8}=\\frac{144}{8}=18.\n$$\n因此，\n$$\n\\chi^{2}=\\frac{5}{18}+\\frac{1}{8}+18=\\frac{1325}{72}\\approx 18.40.\n$$\n\n自由度为$k-1=3-1=2$。在显著性水平$\\alpha=0.05$下，给定的临界值为$\\chi^{2}_{0.05,2}=5.991$。由于$\\frac{1325}{72}>5.991$，我们拒绝$H_{0}$。因此，检验统计量约为$18.40$，正确的结论是拒绝原假设。", "answer": "$$\\boxed{D}$$", "id": "1903931"}, {"introduction": "为了加深我们的理解，我们不仅可以将卡方统计量用于整体检验，还可以用它来研究模型中更细致的方面。这个高级问题介绍了一种强大的技术——分解卡方统计量，用以检验数据中的子假设。通过分析一个理论模型的内部一致性 [@problem_id:1903901]，你将学到如何从数据中提取比简单的“拒绝”或“不拒绝”更精细的结论。", "problem": "在一项粒子物理实验中，科学家们正在研究一种假设的奇特介子的衰变。总共记录了 $N=1000$ 个此类衰变事件。衰变的末态被分为四种类型。一个主流理论对这四个衰变道的分支比（概率）做出了具体预测。预测的概率和实验观测到的计数如下所示：\n\n-   **道 1:** 预测 $p_1 = 0.10$，观测 $n_1 = 115$\n-   **道 2:** 预测 $p_2 = 0.20$，观测 $n_2 = 195$\n-   **道 3:** 预测 $p_3 = 0.30$，观测 $n_3 = 310$\n-   **道 4:** 预测 $p_4 = 0.40$，观测 $n_4 = 380$\n\n这个四道理论被称为“详细模型”。\n现在，考虑一个更粗略的分组，其中道1和道2被归类为“I型”衰变，道3和道4被归类为“II型”衰变。一个限制较少的“类别模型”提出，I型衰变的概率为 $p_{I} = p_1 + p_2 = 0.30$，II型衰变的概率为 $p_{II} = p_3 + p_4 = 0.70$。\n\n你的任务是计算Pearson卡方统计量，用于检验在I型和II型类别*内部*预测比例的有效性，假设每个类别的观测总数是给定的。这个统计量化了在给定I型和II型衰变的观测数量下，“详细模型”对其内部比率（例如，道1与道2之比）的预测的吻合程度。\n\n计算这个条件卡方统计量。将你的答案以单个数值形式给出，并四舍五入到四位有效数字。", "solution": "题目要求我们计算Pearson卡方统计量，用于在每个类别（I型和II型）内部检验“详细模型”的内部比率是否成立，其条件是每个类别的观测总数是固定的。在类别总数固定的条件下，Pearson统计量的计算方法是将所有类别内部的贡献值相加求和：\n$$\n\\chi^{2}=\\sum_{\\text{classes }C}\\sum_{j \\in C}\\frac{(n_{j}-e_{j})^{2}}{e_{j}},\n$$\n其中，对于观测总数为 $N_{C}=\\sum_{j \\in C}n_{j}$ 的类别 $C$，道 $j \\in C$ 的期望计数为\n$$\ne_{j}=N_{C}\\cdot \\frac{p_{j}}{\\sum_{k \\in C}p_{k}}.\n$$\n\n计算观测到的类别总数：\n$$\nN_{I}=n_{1}+n_{2}=115+195=310,\\quad N_{II}=n_{3}+n_{4}=310+380=690.\n$$\n\nI型类别：\n$$\n\\frac{p_{1}}{p_{1}+p_{2}}=\\frac{0.10}{0.30}=\\frac{1}{3},\\quad \\frac{p_{2}}{p_{1}+p_{2}}=\\frac{0.20}{0.30}=\\frac{2}{3}.\n$$\n因此\n$$\ne_{1}=N_{I}\\cdot \\frac{1}{3}=\\frac{310}{3},\\quad e_{2}=N_{I}\\cdot \\frac{2}{3}=\\frac{620}{3}.\n$$\n残差：\n$$\nd_{1}=n_{1}-e_{1}=115-\\frac{310}{3}=\\frac{35}{3},\\quad d_{2}=n_{2}-e_{2}=195-\\frac{620}{3}=-\\frac{35}{3}.\n$$\n贡献值：\n$$\n\\frac{d_{1}^{2}}{e_{1}}=\\frac{\\left(\\frac{35}{3}\\right)^{2}}{\\frac{310}{3}}=\\frac{1225/9}{310/3}=\\frac{1225}{930}=\\frac{245}{186},\n$$\n$$\n\\frac{d_{2}^{2}}{e_{2}}=\\frac{\\left(\\frac{35}{3}\\right)^{2}}{\\frac{620}{3}}=\\frac{1225/9}{620/3}=\\frac{1225}{1860}=\\frac{245}{372}.\n$$\n所以I型的和是\n$$\n\\chi^{2}_{I}=\\frac{245}{186}+\\frac{245}{372}=\\frac{245}{124}.\n$$\n\nII型类别：\n$$\n\\frac{p_{3}}{p_{3}+p_{4}}=\\frac{0.30}{0.70}=\\frac{3}{7},\\quad \\frac{p_{4}}{p_{3}+p_{4}}=\\frac{0.40}{0.70}=\\frac{4}{7}.\n$$\n因此\n$$\ne_{3}=N_{II}\\cdot \\frac{3}{7}=\\frac{2070}{7},\\quad e_{4}=N_{II}\\cdot \\frac{4}{7}=\\frac{2760}{7}.\n$$\n残差：\n$$\nd_{3}=n_{3}-e_{3}=310-\\frac{2070}{7}=\\frac{100}{7},\\quad d_{4}=n_{4}-e_{4}=380-\\frac{2760}{7}=-\\frac{100}{7}.\n$$\n贡献值：\n$$\n\\frac{d_{3}^{2}}{e_{3}}=\\frac{\\left(\\frac{100}{7}\\right)^{2}}{\\frac{2070}{7}}=\\frac{10000/49}{2070/7}=\\frac{10000}{14490}=\\frac{1000}{1449},\n$$\n$$\n\\frac{d_{4}^{2}}{e_{4}}=\\frac{\\left(\\frac{100}{7}\\right)^{2}}{\\frac{2760}{7}}=\\frac{10000/49}{2760/7}=\\frac{10000}{19320}=\\frac{250}{483}.\n$$\n所以II型的和是\n$$\n\\chi^{2}_{II}=\\frac{1000}{1449}+\\frac{250}{483}=\\frac{1000}{1449}+\\frac{750}{1449}=\\frac{1750}{1449}.\n$$\n\n总的条件Pearson卡方统计量：\n$$\n\\chi^{2}=\\chi^{2}_{I}+\\chi^{2}_{II}=\\frac{245}{124}+\\frac{1750}{1449}=\\frac{572005}{179676}\\approx 3.183534\\ldots\n$$\n四舍五入到四位有效数字，结果是 $3.184$。", "answer": "$$\\boxed{3.184}$$", "id": "1903901"}]}