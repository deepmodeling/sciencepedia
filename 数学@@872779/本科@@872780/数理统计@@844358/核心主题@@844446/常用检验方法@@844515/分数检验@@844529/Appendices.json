{"hands_on_practices": [{"introduction": "让我们从一个基础性的例子开始，这个例子源于数字通信领域。该问题要求我们为一系列伯努利试验中的错误概率构建一个分数检验。这项练习至关重要，因为它在一个清晰且熟悉的背景下，完整地展示了从对数似然到分数函数和费雪信息的整个推导过程[@problem_id:1953755]。", "problem": "考虑一个传输单个比特的数字通信信道的简化模型。每个比特的传输都可能发生比特翻转错误（0 变为 1，或 1 变为 0），其概率为常数 $p$。我们可以将每个比特发生错误的情况建模为一次独立的伯努利试验。令 $X_i$ 为第 $i$ 次比特传输的随机变量，其中如果发生错误，则 $X_i=1$，如果传输成功，则 $X_i=0$。\n\n一位工程师收集了一个包含 $n$ 次传输的随机样本，以检验错误率是否等于一个特定的设计值 $p_0$。样本中观察到的比特翻转错误总数记为 $T = \\sum_{i=1}^{n} X_i$。\n\n您的任务是为原假设 $H_0: p = p_0$ 相对于备择假设 $H_a: p \\neq p_0$ 构建 Rao 得分检验统计量。将该统计量表示为样本大小 $n$、观察到的错误总数 $T$ 和假设的错误率 $p_0$ 的函数。", "solution": "我们将 $X_{i} \\sim \\text{Bernoulli}(p)$ 建模为独立同分布，因此 $T=\\sum_{i=1}^{n}X_{i} \\sim \\text{Binomial}(n,p)$。给定 $T$ 时 $p$ 的似然函数为\n$$\nL(p;T)=\\binom{n}{T}p^{T}(1-p)^{n-T},\n$$\n对数似然函数为\n$$\n\\ell(p)=\\ln L(p;T)=\\ln\\binom{n}{T}+T\\ln p+(n-T)\\ln(1-p).\n$$\n得分函数是关于 $p$ 的一阶导数：\n$$\nU(p)=\\frac{\\partial \\ell}{\\partial p}=\\frac{T}{p}-\\frac{n-T}{1-p}.\n$$\nFisher 信息量为\n$$\nI(p)=-\\mathbb{E}\\!\\left[\\frac{\\partial^{2}\\ell}{\\partial p^{2}}\\right]\n=-\\mathbb{E}\\!\\left[-\\frac{T}{p^{2}}-\\frac{n-T}{(1-p)^{2}}\\right]\n=\\frac{n}{p(1-p)},\n$$\n这里使用了 $\\mathbb{E}[T]=np$。在原假设 $H_{0}:p=p_{0}$（其中 $0  p_{0}  1$）下，Rao 得分检验统计量为\n$$\nS=\\frac{U(p_{0})^{2}}{I(p_{0})}\n=\\frac{\\left(\\frac{T}{p_{0}}-\\frac{n-T}{1-p_{0}}\\right)^{2}}{\\frac{n}{p_{0}(1-p_{0})}}\n=\\frac{\\left(\\frac{T-np_{0}}{p_{0}(1-p_{0})}\\right)^{2}}{\\frac{n}{p_{0}(1-p_{0})}}\n=\\frac{(T-np_{0})^{2}}{n\\,p_{0}(1-p_{0})}.\n$$\n在 $H_{0}$ 下，$S$ 渐近服从自由度为 1 的 $\\chi^{2}$ 分布。", "answer": "$$\\boxed{\\frac{(T-np_{0})^{2}}{n\\,p_{0}(1-p_{0})}}$$", "id": "1953755"}, {"introduction": "在之前例子的基础上，我们现在转向一个涉及几何分布的质量控制场景。这个练习将让你把构建分数检验的核心原则应用到一个不同但同样重要的离散概率模型上。通过解决这个问题，你将看到通用方法如何适应不同的似然函数[@problem_id:1953900]。", "problem": "一位质量控制工程师正在监控一条生产特定类型电子元件的生产线。在找到第一个有缺陷的元件之前测试的元件数量，用随机变量 $X$ 表示，假设其服从几何分布。其概率质量函数 (PMF) 为 $f(x; p) = p(1-p)^{x-1}$，其中 $x = 1, 2, 3, \\dots$，$p$ 是一个元件有缺陷的概率。\n\n从历史上看，缺陷率一直稳定在一个已知值 $p_0$。为了评估最近对制造过程的一项修改，该工程师收集了一个包含 $n$ 个独立观测值的随机样本 $X_1, X_2, \\dots, X_n$，其中每个 $X_i$ 代表在一次给定的检验批次中，直到找到第一个缺陷元件所需的试验次数。\n\n为了确定缺陷率是否与其历史值发生了变化，该工程师希望检验原假设 $H_0: p = p_0$。基于此情景，推导用于此假设检验的 Rao 分数检验统计量的一般形式。请将您的答案表示为一个闭式解析表达式，该表达式应包含样本量 $n$、假设的缺陷率 $p_0$ 以及样本均值 $\\bar{X} = \\frac{1}{n} \\sum_{i=1}^n X_i$。", "solution": "我们观测到独立的 $X_{1},\\dots,X_{n}$，其服从几何概率质量函数(PMF) $f(x;p)=p(1-p)^{x-1}$，其中 $x\\in\\{1,2,\\dots\\}$。似然函数为\n$$\nL(p)=\\prod_{i=1}^{n} p(1-p)^{x_{i}-1}=p^{n}(1-p)^{\\sum_{i=1}^{n}x_{i}-n}=p^{n}(1-p)^{n\\bar{X}-n}.\n$$\n因此，对数似然函数为\n$$\n\\ell(p)=\\ln L(p)=n\\ln p+(n\\bar{X}-n)\\ln(1-p).\n$$\n分数函数为\n$$\nU(p)=\\frac{\\partial \\ell(p)}{\\partial p}=\\frac{n}{p}-\\frac{n\\bar{X}-n}{1-p}=n\\left(\\frac{1}{p}-\\frac{\\bar{X}-1}{1-p}\\right).\n$$\n二阶导数为\n$$\n\\ell''(p)=\\frac{\\partial^{2}\\ell(p)}{\\partial p^{2}}=-\\frac{n}{p^{2}}-\\frac{n\\bar{X}-n}{(1-p)^{2}}.\n$$\n(期望) Fisher 信息量为 $I(p)=-\\mathbb{E}_{p}[\\ell''(p)]$。使用几何分布的期望 $\\mathbb{E}_{p}[X]=\\frac{1}{p}$，我们得到 $\\mathbb{E}_{p}[n\\bar{X}-n]=n\\left(\\frac{1}{p}-1\\right)=n\\frac{1-p}{p}$，所以\n$$\nI(p)=\\frac{n}{p^{2}}+\\frac{n\\frac{1-p}{p}}{(1-p)^{2}}=\\frac{n}{p^{2}}+\\frac{n}{p(1-p)}=\\frac{n}{p^{2}(1-p)}.\n$$\n用于检验 $H_{0}:p=p_{0}$ 的 Rao 分数检验统计量为\n$$\nS=\\frac{U(p_{0})^{2}}{I(p_{0})}.\n$$\n将 $p_{0}$ 代入 $U$ 和 $I$ 可得\n$$\nU(p_{0})=n\\left(\\frac{1}{p_{0}}-\\frac{\\bar{X}-1}{1-p_{0}}\\right)=\\frac{n\\left(1-p_{0}\\bar{X}\\right)}{p_{0}(1-p_{0})}, \\quad I(p_{0})=\\frac{n}{p_{0}^{2}(1-p_{0})}.\n$$\n因此，\n$$\nS=\\frac{\\left[\\frac{n\\left(1-p_{0}\\bar{X}\\right)}{p_{0}(1-p_{0})}\\right]^{2}}{\\frac{n}{p_{0}^{2}(1-p_{0})}}=n\\,\\frac{\\left(1-p_{0}\\bar{X}\\right)^{2}}{1-p_{0}}.\n$$\n在 $H_{0}$ 下，$S$ 渐近服从自由度为 1 的 $\\chi^{2}$ 分布。", "answer": "$$\\boxed{n\\,\\frac{\\left(1-p_{0}\\bar{X}\\right)^{2}}{1-p_{0}}}$$", "id": "1953900"}, {"introduction": "为了完善我们的实践，现在我们来解决一个涉及连续分布的问题，即经济学中常用的帕累托分布。这个练习尤其有价值，因为它不仅考验你为连续模型推导分数检验的能力，还要求你根据汇总数据计算出一个具体的数值结果。这弥合了抽象理论与数据分析实际应用之间的差距[@problem_id:1953913]。", "problem": "经济学家正在研究某个国家财富分配的模型。他们使用帕累托I型分布来模拟个人的财富 $X$（以百万美元为单位）。其概率密度函数（PDF）为 $f(x; \\alpha, x_m) = \\frac{\\alpha x_m^\\alpha}{x^{\\alpha+1}}$，其中 $x \\ge x_m  0$。已知最小财富参数 $x_m$ 固定为 $x_m = 1$ 百万美元。决定财富不平等程度的形状参数 $\\alpha$ 是未知的。\n\n一个主流的经济学理论提出，形状参数为 $\\alpha = 1.5$。为了检验这一理论，收集了一个包含 $n=100$ 个体的随机样本。该样本的数据得出的汇总统计量为 $\\sum_{i=1}^{100} \\ln(x_i) = 75$，其中 $x_i$ 是样本中第 $i$ 个人的财富。\n\n计算用于检验原假设 $H_0: \\alpha = 1.5$ 的Rao得分检验统计量的值。将您的最终答案四舍五入到四位有效数字。", "solution": "对于已知 $x_{m}=1$ 的帕累托I型分布，其密度函数为 $f(x;\\alpha)=\\alpha x^{-(\\alpha+1)}$，其中 $x\\geq 1$。对于一个独立同分布（i.i.d.）样本 $\\{x_{i}\\}_{i=1}^{n}$，其对数似然函数为\n$$\n\\ell(\\alpha)=\\sum_{i=1}^{n}\\left[\\ln(\\alpha)-(\\alpha+1)\\ln(x_{i})\\right]\n= n\\ln(\\alpha)-(\\alpha+1)\\sum_{i=1}^{n}\\ln(x_{i}).\n$$\n得分函数为\n$$\nU(\\alpha)=\\frac{\\partial \\ell}{\\partial \\alpha}=\\frac{n}{\\alpha}-\\sum_{i=1}^{n}\\ln(x_{i}),\n$$\n费雪信息量为\n$$\nI(\\alpha)=-\\mathbb{E}\\left[\\frac{\\partial^{2}\\ell}{\\partial \\alpha^{2}}\\right]\n=-\\mathbb{E}\\left[-\\frac{n}{\\alpha^{2}}\\right]=\\frac{n}{\\alpha^{2}}.\n$$\n用于检验 $H_{0}:\\alpha=\\alpha_{0}$ 的Rao得分检验统计量为\n$$\nS=\\frac{U(\\alpha_{0})^{2}}{I(\\alpha_{0})}.\n$$\n已知 $n=100$，$\\sum_{i=1}^{100}\\ln(x_{i})=75$ 以及 $\\alpha_{0}=1.5$，计算\n$$\nU(\\alpha_{0})=\\frac{100}{1.5}-75=\\frac{200}{3}-75=\\frac{200}{3}-\\frac{225}{3}=-\\frac{25}{3},\n$$\n以及\n$$\nI(\\alpha_{0})=\\frac{100}{(1.5)^{2}}=\\frac{100}{\\frac{9}{4}}=\\frac{400}{9}.\n$$\n因此，\n$$\nS=\\frac{\\left(-\\frac{25}{3}\\right)^{2}}{\\frac{400}{9}}=\\frac{\\frac{625}{9}}{\\frac{400}{9}}=\\frac{625}{400}=1.5625.\n$$\n四舍五入到四位有效数字，检验统计量为 $1.563$。", "answer": "$$\\boxed{1.563}$$", "id": "1953913"}]}