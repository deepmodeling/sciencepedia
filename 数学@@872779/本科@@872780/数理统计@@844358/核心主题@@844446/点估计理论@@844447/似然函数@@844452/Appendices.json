{"hands_on_practices": [{"introduction": "我们将从一个经典的抛硬币情景开始，它可以用伯努利分布来建模。给定一小组观测结果，我们的目标是构建似然函数，并找到那个使我们观测到的数据“最可能”出现的概率参数 $p$。这个练习 [@problem_id:1961909] 将让你对似然函数所代表的含义有一个切实的感受。", "problem": "一个实验过程被建模为一系列独立的伯努利试验。对于每次试验，结果 $Y$ 可以是成功（用 $Y=1$ 表示）或失败（用 $Y=0$ 表示）。成功的概率由一个参数 $p$ 给出，其中 $p \\in [0, 1]$。因此，单次试验的概率质量函数为 $f(y|p) = p^y (1-p)^{1-y}$，其中 $y \\in \\{0, 1\\}$。\n\n进行了一个小规模的实验，得到一系列三个独立的结果：第一次试验是成功，第二次是失败，第三次是成功。也就是说，观测到的数据是序列 $(y_1, y_2, y_3) = (1, 0, 1)$。\n\n似然函数 $L(p)$ 表示观测到这个特定数据序列的概率，它是参数 $p$ 的函数。对于独立试验，它是各个概率的乘积：$L(p) = f(y_1|p) \\times f(y_2|p) \\times f(y_3|p)$。\n\n确定使该似然函数 $L(p)$ 最大化的参数 $p$ 的值。将您的答案表示为最简分数形式。", "solution": "对于参数为 $p$ 的伯努利试验，其概率质量函数为 $f(y \\mid p) = p^{y}(1-p)^{1-y}$，其中 $y \\in \\{0,1\\}$。对于独立试验，观测到 $(y_{1},y_{2},y_{3})=(1,0,1)$ 的似然函数是以下乘积\n$$\nL(p)=\\prod_{i=1}^{3} f(y_{i}\\mid p)\n= p^{y_{1}}(1-p)^{1-y_{1}} \\cdot p^{y_{2}}(1-p)^{1-y_{2}} \\cdot p^{y_{3}}(1-p)^{1-y_{3}}.\n$$\n代入 $y_{1}=1$，$y_{2}=0$，$y_{3}=1$ 可得\n$$\nL(p)=p^{1}(1-p)^{0}\\cdot p^{0}(1-p)^{1}\\cdot p^{1}(1-p)^{0}=p^{2}(1-p).\n$$\n为了在 $p \\in [0,1]$ 上最大化 $L(p)$，方便起见，我们最大化对数似然函数\n$$\n\\ell(p)=\\ln L(p)=2\\ln p+\\ln(1-p).\n$$\n求导并令其为零：\n$$\n\\ell'(p)=\\frac{2}{p}-\\frac{1}{1-p}=0\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{2}{p}=\\frac{1}{1-p}\n\\;\\;\\Longrightarrow\\;\\;\n2(1-p)=p\n\\;\\;\\Longrightarrow\\;\\;\n2-2p=p\n\\;\\;\\Longrightarrow\\;\\;\np=\\frac{2}{3}.\n$$\n验证它是一个最大值：二阶导数为\n$$\n\\ell''(p)=-\\frac{2}{p^{2}}-\\frac{1}{(1-p)^{2}}0 \\quad \\text{for} \\quad p\\in(0,1),\n$$\n因此该临界点是一个严格的局部最大值。检查边界值，$L(0)=0$ 和 $L(1)=0$，因此在 $[0,1]$ 上的全局最大值出现在内点 $p=\\frac{2}{3}$。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "1961909"}, {"introduction": "接下来，让我们转向一个连续模型。这个问题借鉴了金融领域的一个常用模型，将指导你为一个来自对数正态分布的样本构建似然函数。这里的重点在于正确写出观测数据集的联合概率密度 [@problem_id:1961927]，这是进行任何参数估计之前至关重要的一步。", "problem": "在量化金融中，金融资产的每日价格通常被建模为一个随机变量。由于资产价格必须为正，该模型的一个常见选择是对数正态分布。\n\n如果一个随机变量 $X$ 的自然对数 $Y = \\ln(X)$ 服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布，则称 $X$ 服从参数为 $\\mu$ 和 $\\sigma^2$ 的对数正态分布。对于 $x  0$，这样一个对数正态随机变量 $X$ 的概率密度函数 (PDF) 由下式给出：\n$$f(x; \\mu, \\sigma^2) = \\frac{1}{x \\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(\\ln(x) - \\mu)^2}{2\\sigma^2} \\right)$$\n假设一位分析师收集了一个由 $n$ 个独立同分布 (i.i.d.) 的每日资产价格观测值组成的随机样本，记为 $x_1, x_2, \\ldots, x_n$。\n\n您的任务是根据此样本确定参数 $\\mu$ 和 $\\sigma^2$ 的似然函数 $L(\\mu, \\sigma^2)$。最终的表达式应该是样本数据 ($x_i$)、样本量 ($n$) 以及参数 ($\\mu, \\sigma^2$) 的函数。", "solution": "我们已知观测值 $x_{1},\\dots,x_{n}$ 是来自参数为 $\\mu$ 和 $\\sigma^{2}$ 的对数正态分布的独立同分布样本，其对于 $x0$ 的密度函数为\n$$\nf(x;\\mu,\\sigma^{2})=\\frac{1}{x\\sqrt{2\\pi\\sigma^{2}}}\\exp\\left(-\\frac{(\\ln(x)-\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n根据独立性，似然函数是视为参数函数的联合密度：\n$$\nL(\\mu,\\sigma^{2})=\\prod_{i=1}^{n}f(x_{i};\\mu,\\sigma^{2})\n=\\prod_{i=1}^{n}\\left[\\frac{1}{x_{i}\\sqrt{2\\pi\\sigma^{2}}}\\exp\\left(-\\frac{(\\ln(x_{i})-\\mu)^{2}}{2\\sigma^{2}}\\right)\\right].\n$$\n将乘积分离为前置因子的乘积和指数项的乘积，并利用指数的乘积等于和的指数这一性质：\n$$\nL(\\mu,\\sigma^{2})=\\left(\\prod_{i=1}^{n}\\frac{1}{x_{i}\\sqrt{2\\pi\\sigma^{2}}}\\right)\\exp\\left(-\\sum_{i=1}^{n}\\frac{(\\ln(x_{i})-\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n计算相同的因子 $\\sqrt{2\\pi\\sigma^{2}}$ 的乘积并合并各项：\n$$\n\\prod_{i=1}^{n}\\frac{1}{\\sqrt{2\\pi\\sigma^{2}}}=(2\\pi\\sigma^{2})^{-n/2},\\quad \\prod_{i=1}^{n}\\frac{1}{x_{i}}=\\frac{1}{\\prod_{i=1}^{n}x_{i}},\n$$\n因此似然函数简化为\n$$\nL(\\mu,\\sigma^{2})=\\frac{1}{(2\\pi\\sigma^{2})^{n/2}\\prod_{i=1}^{n}x_{i}}\\exp\\left(-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(\\ln(x_{i})-\\mu)^{2}\\right),\n$$\n这就是所要求的表达式，它是样本 $\\{x_{i}\\}_{i=1}^{n}$、样本量 $n$ 和参数 $\\mu$ 和 $\\sigma^{2}$ 的函数，当所有 $x_{i}0$ 时有效。", "answer": "$$\\boxed{L(\\mu,\\sigma^{2})=\\frac{1}{(2\\pi\\sigma^{2})^{n/2}\\prod_{i=1}^{n}x_{i}}\\exp\\left(-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}\\bigl(\\ln(x_{i})-\\mu\\bigr)^{2}\\right)}$$", "id": "1961927"}, {"introduction": "有了似然函数后，我们如何用它来估计未知参数呢？这个练习将介绍强大的最大似然估计（MLE）方法。你将处理在可靠性研究中常用的伽马分布，并运用微积分知识来推导其尺度参数的估计量 [@problem_id:1961965]，这是任何统计学家都需掌握的一项基本技能。", "problem": "一位工程师正在研究某种电子元件的可靠性。元件的寿命（以小时为单位）被建模为一个连续随机变量 $X$，它服从伽马分布，其形状参数 $k  0$ 已知，尺度参数 $\\theta  0$ 未知。该分布的概率密度函数 (PDF) 由下式给出：\n$$f(x; k, \\theta) = \\frac{1}{\\Gamma(k)\\theta^k} x^{k-1} \\exp\\left(-\\frac{x}{\\theta}\\right), \\quad \\text{for } x  0$$\n其中 $\\Gamma(k)$ 是在 $k$ 处求值的伽马函数。\n\n为了估计未知参数 $\\theta$，工程师测试了 $n$ 个元件的随机样本，并记录了它们的寿命，记为 $x_1, x_2, \\ldots, x_n$。\n\n您的任务是求出尺度参数 $\\theta$ 的最大似然估计 (MLE)。请将估计量（记为 $\\hat{\\theta}$）的最终答案用已知的形状参数 $k$ 和样本均值 $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^n x_i$ 表示。", "solution": "我们假设观测到的寿命 $x_{1},\\ldots,x_{n}$ 是独立同分布的，服从 $\\Gamma(k,\\theta)$ 分布，其中 $k0$ 已知，$\\theta0$ 未知。联合似然函数是\n$$\nL(\\theta; x_{1},\\ldots,x_{n})=\\prod_{i=1}^{n}\\frac{1}{\\Gamma(k)\\theta^{k}}x_{i}^{k-1}\\exp\\left(-\\frac{x_{i}}{\\theta}\\right).\n$$\n对似然函数取自然对数，得到对数似然函数\n$$\n\\ell(\\theta)=\\ln L(\\theta; x_{1},\\ldots,x_{n})=\\sum_{i=1}^{n}\\left[-\\ln\\Gamma(k)-k\\ln\\theta+(k-1)\\ln x_{i}-\\frac{x_{i}}{\\theta}\\right].\n$$\n对 $\\theta$ 求导，并使用 $\\frac{\\mathrm{d}}{\\mathrm{d}\\theta}\\ln\\theta=\\frac{1}{\\theta}$ 和 $\\frac{\\mathrm{d}}{\\mathrm{d}\\theta}\\left(-\\frac{x_{i}}{\\theta}\\right)=\\frac{x_{i}}{\\theta^{2}}$，我们得到\n$$\n\\frac{\\partial \\ell}{\\partial \\theta}=\\sum_{i=1}^{n}\\left[-\\frac{k}{\\theta}+\\frac{x_{i}}{\\theta^{2}}\\right]=-\\,\\frac{nk}{\\theta}+\\frac{1}{\\theta^{2}}\\sum_{i=1}^{n}x_{i}.\n$$\n为求最大似然估计，将得分方程设为零，\n$$\n-\\,\\frac{nk}{\\theta}+\\frac{1}{\\theta^{2}}\\sum_{i=1}^{n}x_{i}=0,\n$$\n两边同乘以 $\\theta^{2}0$ 得到\n$$\n-nk\\,\\theta+\\sum_{i=1}^{n}x_{i}=0.\n$$\n解出 $\\theta$ 可得\n$$\n\\hat{\\theta}=\\frac{1}{nk}\\sum_{i=1}^{n}x_{i}=\\frac{\\bar{x}}{k},\n$$\n其中 $\\bar{x}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}$ 是样本均值。为验证其为最大值，计算二阶导数\n$$\n\\frac{\\partial^{2}\\ell}{\\partial \\theta^{2}}=\\sum_{i=1}^{n}\\left[\\frac{k}{\\theta^{2}}-\\frac{2x_{i}}{\\theta^{3}}\\right]=\\frac{nk}{\\theta^{2}}-\\frac{2}{\\theta^{3}}\\sum_{i=1}^{n}x_{i}.\n$$\n在 $\\hat{\\theta}$ 处求值，并使用 $\\sum_{i=1}^{n}x_{i}=nk\\,\\hat{\\theta}$，\n$$\n\\left.\\frac{\\partial^{2}\\ell}{\\partial \\theta^{2}}\\right|_{\\theta=\\hat{\\theta}}=\\frac{nk}{\\hat{\\theta}^{2}}-\\frac{2}{\\hat{\\theta}^{3}}(nk\\,\\hat{\\theta})=-\\frac{nk}{\\hat{\\theta}^{2}}0,\n$$\n确认 $\\hat{\\theta}$ 使对数似然函数最大化。因此，最大似然估计是 $\\bar{x}/k$。", "answer": "$$\\boxed{\\frac{\\bar{x}}{k}}$$", "id": "1961965"}]}