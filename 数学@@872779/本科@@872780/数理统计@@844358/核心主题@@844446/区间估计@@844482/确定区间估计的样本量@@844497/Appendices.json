{"hands_on_practices": [{"introduction": "我们的第一个实践练习将处理一个在质量控制和工程领域中常见的基本情景。我们将探讨当过程的变异性（即总体标准差 $\\sigma$）已知时，如何确定估计总体均值所需的样本量，以达到预设的置信水平和精度。这个练习 [@problem_id:1913244] 为更复杂的样本量计算提供了坚实的基础，是任何研究设计中的第一步。", "problem": "一家名为 RoboDynamics Inc. 的机器人公司正在开发一系列新型高精度机械臂。其中一个关键部件是采用新型3D打印工艺制造的小齿轮。虽然该工艺具有高度可重复性，但打印出的零件尺寸存在固有的变异性。根据来自类似打印技术的大量先前数据，已知齿轮直径的标准差为 $0.2$ 毫米。\n\n工程团队需要估计这种新工艺生产的齿轮的真实平均直径。为确保机械臂满足其性能规格，他们必须有 $99\\%$ 的置信度，确保其对平均直径的估计值与真实平均直径的误差在 $0.05$ 毫米以内。\n\n为满足这一要求，必须打印和测量的最小齿轮数量是多少？", "solution": "我们正在使用置信水平为 $c=0.99$ 的双侧置信区间来估计一个总体均值，已知标准差为 $\\sigma=0.2$。对于已知的 $\\sigma$，基于样本量为 $n$ 的均值 $\\mu$ 的 $(1-\\alpha)$ 置信区间的半宽度（误差范围）为\n$$\nE = z_{1-\\alpha/2}\\frac{\\sigma}{\\sqrt{n}},\n$$\n其中 $\\alpha=1-c$，$z_{1-\\alpha/2}$ 是标准正态临界值。\n\n要求是估计值在 $E=0.05$ 之内，所以我们需要\n$$\nE \\geq z_{1-\\alpha/2}\\frac{\\sigma}{\\sqrt{n}} \\quad \\Rightarrow \\quad n \\geq \\left(\\frac{z_{1-\\alpha/2}\\sigma}{E}\\right)^{2}.\n$$\n当 $c=0.99$ 时，我们有 $\\alpha=0.01$，因此 $z_{1-\\alpha/2}=z_{0.995}\\approx 2.575829$。代入 $\\sigma=0.2$ 和 $E=0.05$，\n$$\nn \\geq \\left(\\frac{2.575829\\times 0.2}{0.05}\\right)^{2}\n= \\left(2.575829\\times 4\\right)^{2}\n= \\left(10.303316\\right)^{2}\n\\approx 106.173.\n$$\n由于 $n$ 必须是整数并且必须满足不等式，我们取向上取整：\n$$\nn=\\lceil 106.173\\rceil=107.\n$$\n因此，所需的最小齿轮数量为 $107$。", "answer": "$$\\boxed{107}$$", "id": "1913244"}, {"introduction": "接下来，我们将从估计均值转向估计比例，这在生物学、市场研究和社会科学等领域中极为常见。这个练习的独特之处在于它要求我们处理两种不同的情况：一种是完全没有关于总体比例的先验信息，另一种是基于初步研究有一个大致的估计。通过解决这个问题 [@problem_id:1913260]，你将深刻理解先验知识如何显著影响研究设计的效率，特别是如何通过一个合理的初步估计来减少所需的样本量。", "problem": "一家农业生物技术公司正在开发一种新的高粱品种，该品种经过基因工程改造以具备抗旱性。在进行昂贵的田间试验之前，该公司的科学家需要估计新品种种子在受控胁迫条件下的发芽率 $p$。他们希望确定必须测试的最小种子数量，以便为真实比例 $p$ 构建一个 95% 的置信区间，且总宽度不超过 $0.08$。\n\n您需要计算两种不同情景下所需的样本量：\nA. 公司没有关于这个新品种发芽率的初步数据。\nB. 对一个密切相关的上一代品系进行的小规模初步研究表明，其发芽率约为 90%。请使用此值作为新品种的合理估计。\n\n确定情景 A 和情景 B 所需的最小整数样本量。对于您的最终答案，请将情景 A 和 B 的两个整数值以行矩阵的形式呈现。", "solution": "我们的目标是为二项比例 $p$ 构建一个置信水平为 $1-\\alpha=0.95$ 的双侧 Wald 型置信区间，其通用形式为\n$$\n\\hat{p} \\pm z_{1-\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}},\n$$\n其中 $z_{1-\\alpha/2}$ 是标准正态临界值。该区间的总宽度 $W$ 为\n$$\nW \\;=\\; 2 z_{1-\\alpha/2} \\sqrt{\\frac{p(1-p)}{n}}.\n$$\n设计要求是 $W \\leq 0.08$，因此误差范围 $E=0.04$，我们需要\n$$\n2 z_{1-\\alpha/2} \\sqrt{\\frac{p(1-p)}{n}} \\leq 0.08\n\\;\\;\\Longleftrightarrow\\;\\;\n\\sqrt{\\frac{p(1-p)}{n}} \\leq \\frac{0.04}{z_{1-\\alpha/2}}\n\\;\\;\\Longleftrightarrow\\;\\;\n\\frac{p(1-p)}{n} \\leq \\left(\\frac{0.04}{z_{1-\\alpha/2}}\\right)^{2}.\n$$\n求解 $n$ 可得样本量规划公式\n$$\nn \\;\\geq\\; \\frac{z_{1-\\alpha/2}^{2}\\,p(1-p)}{0.04^{2}}.\n$$\n对于 $95\\%$ 的置信水平，$z_{1-\\alpha/2} = 1.96$，因此\n$$\nn \\;\\geq\\; \\frac{(1.96)^{2}\\,p(1-p)}{0.04^{2}} \\;=\\; \\frac{3.8416\\,p(1-p)}{0.0016}.\n$$\n我们取满足此条件的最小整数 $n$，即向上取整。\n\n情景 A（无先验信息）：使用保守的 $p=0.5$，此时 $p(1-p)$ 达到最大值 $0.25$。那么\n$$\nn \\;\\geq\\; \\frac{3.8416 \\times 0.25}{0.0016} \\;=\\; \\frac{0.9604}{0.0016} \\;=\\; 600.25,\n$$\n所以最小整数为 $n=601$。\n\n情景 B（初步研究表明 $p \\approx 0.9$）：使用 $p=0.9$，所以 $p(1-p)=0.9\\times 0.1=0.09$。那么\n$$\nn \\;\\geq\\; \\frac{3.8416 \\times 0.09}{0.0016} \\;=\\; \\frac{0.345744}{0.0016} \\;=\\; 216.09,\n$$\n所以最小整数为 $n=217$。\n\n因此，情景 A 所需的样本量为 $601$，情景 B 所需的样本量为 $217$。", "answer": "$$\\boxed{\\begin{pmatrix} 601  & 217 \\end{pmatrix}}$$", "id": "1913260"}, {"introduction": "为了巩固我们为比例确定样本量的技能，最后一个练习将我们带到了科学的前沿，将这些统计原理应用于天体化学研究。这个问题 [@problem_id:1913292] 再次强调了在有先验估计的情况下计算样本量的方法，并将精度要求表述为边际误差，这是另一种常见的提法。它清晰地展示了统计规划的普适性，无论是在工厂车间还是在探索遥远行星的大气层，这些核心原则都是不可或缺的。", "problem": "一位天体化学家的任务是估计来自一颗新发现的系外行星 TRAPPIST-1x 的大气观测窗口中，含有可探测到的甲烷痕迹的比例。根据来自另一台望远镜的初步低分辨率数据，该团队有一个先验估计，即该比例约为 0.15。该天体化学家需要确定需要安排多少次新的高分辨率光谱测量，以便为含甲烷窗口的真实比例构建一个 95% 的置信区间。目标是使该置信区间的误差范围不大于 0.02。对于 95% 的置信水平，来自标准正态分布的临界值为 $z = 1.96$。\n\n为了达到他们期望的精度，该天体化学家必须分析的独立光谱测量的最小数量是多少？", "solution": "设 $p$ 为含甲烷窗口的真实比例，并设 $p_{0}=0.15$ 为用于规划的先验估计。对于基于正态近似的大样本比例置信区间，其误差范围为\n$$\nE=z\\sqrt{\\frac{p(1-p)}{n}}.\n$$\n为了进行规划，用 $p_{0}$ 替换 $p$ 可得\n$$\nE=z\\sqrt{\\frac{p_{0}(1-p_{0})}{n}}.\n$$\n为确保误差范围不大于目标值 $E^{\\ast}=0.02$，需要满足\n$$\nz\\sqrt{\\frac{p_{0}(1-p_{0})}{n}}\\leq 0.02.\n$$\n逐步求解 $n$：\n$$\n\\sqrt{\\frac{p_{0}(1-p_{0})}{n}}\\leq \\frac{0.02}{z}\\quad\\Longrightarrow\\quad \\frac{p_{0}(1-p_{0})}{n}\\leq\\left(\\frac{0.02}{z}\\right)^{2}\n$$\n$$\n\\Longrightarrow\\quad n\\geq \\frac{z^{2}\\,p_{0}(1-p_{0})}{(0.02)^{2}}.\n$$\n代入 $z=1.96$ 和 $p_{0}=0.15$：\n$$\nn\\geq \\frac{(1.96)^{2}\\cdot 0.15\\cdot 0.85}{(0.02)^{2}}=\\frac{3.8416\\cdot 0.1275}{0.0004}=\\frac{0.489804}{0.0004}=1224.51.\n$$\n由于 $n$ 必须是整数，且要求误差范围“不大于”目标值，因此向上取整：\n$$\nn=\\lceil 1224.51\\rceil=1225.\n$$", "answer": "$$\\boxed{1225}$$", "id": "1913292"}]}