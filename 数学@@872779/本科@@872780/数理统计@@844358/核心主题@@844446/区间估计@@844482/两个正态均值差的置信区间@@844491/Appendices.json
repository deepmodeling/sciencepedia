{"hands_on_practices": [{"introduction": "本练习将指导你处理最常见的情景：在两组的总体方差未知且不假设相等的情况下，比较它们的均值。我们将应用Welch-Satterthwaite方法来构建一个置信区间，这是许多科学领域中数据分析的一项基本技能。这个练习提供了一个兽医学领域的具体例子，使概念更加清晰。[@problem_id:1907642]", "problem": "一位兽医正在研究两个犬种（我们称之为犬种 A 和犬种 B）之间静息血糖水平均值的差异。已知犬种 A 比犬种 B 有更高的糖尿病遗传易感性。为了量化这一差异，该兽医从两个独立的健康成年犬随机样本中收集数据。\n\n对于来自犬种 A 的 $n_1 = 15$ 只狗的样本，样本静息血糖水平均值为 $\\bar{x}_1 = 105.0$ mg/dL，样本标准差为 $s_1 = 12.0$ mg/dL。\n对于来自犬种 B 的 $n_2 = 20$ 只狗的样本，样本均值为 $\\bar{x}_2 = 95.0$ mg/dL，样本标准差为 $s_2 = 8.0$ mg/dL。\n\n假设两个犬种的静息血糖水平均服从正态分布。但不假设两个犬种的总体方差相等。\n\n计算总体血糖水平均值之差 $\\mu_1 - \\mu_2$ 的 95% 置信区间的总宽度。答案以 mg/dL 为单位，四舍五入到三位有效数字。", "solution": "我们要求解方差不相等（Welch 方法）情况下均值之差的双侧 95% 置信区间的总宽度。一般形式为\n$$\n(\\bar{x}_{1}-\\bar{x}_{2}) \\pm t_{1-\\alpha/2,\\nu}\\,\\sqrt{\\frac{s_{1}^{2}}{n_{1}}+\\frac{s_{2}^{2}}{n_{2}}}\n$$\n其中 $\\alpha=0.05$，$\\nu$ 是 Welch–Satterthwaite 自由度\n$$\n\\nu=\\frac{\\left(\\frac{s_{1}^{2}}{n_{1}}+\\frac{s_{2}^{2}}{n_{2}}\\right)^{2}}{\\frac{\\left(\\frac{s_{1}^{2}}{n_{1}}\\right)^{2}}{n_{1}-1}+\\frac{\\left(\\frac{s_{2}^{2}}{n_{2}}\\right)^{2}}{n_{2}-1}}.\n$$\n总宽度是误差范围的两倍：\n$$\nW=2\\,t_{0.975,\\nu}\\,\\sqrt{\\frac{s_{1}^{2}}{n_{1}}+\\frac{s_{2}^{2}}{n_{2}}}.\n$$\n计算标准误差项：\n$$\n\\frac{s_{1}^{2}}{n_{1}}=\\frac{12.0^{2}}{15}=\\frac{144}{15}=9.6,\\qquad \\frac{s_{2}^{2}}{n_{2}}=\\frac{8.0^{2}}{20}=\\frac{64}{20}=3.2,\n$$\n所以\n$$\n\\frac{s_{1}^{2}}{n_{1}}+\\frac{s_{2}^{2}}{n_{2}}=9.6+3.2=12.8,\\qquad \\sqrt{12.8}\\approx 3.577708764.\n$$\n计算 Welch–Satterthwaite 自由度：\n$$\n\\nu=\\frac{(12.8)^{2}}{\\frac{(9.6)^{2}}{14}+\\frac{(3.2)^{2}}{19}}=\\frac{163.84}{\\frac{92.16}{14}+\\frac{10.24}{19}}.\n$$\n使用精确分数，\n$$\n\\frac{92.16}{14}=\\frac{1152}{175},\\qquad \\frac{10.24}{19}=\\frac{256}{475},\\qquad \\frac{1152}{175}+\\frac{256}{475}=\\frac{4736}{665},\n$$\n因此\n$$\n\\nu=\\frac{163.84}{4736/665}=\\frac{4096/25}{4736/665}=\\frac{4256}{185}\\approx 23.005.\n$$\n因此 $t_{0.975,\\nu}\\approx t_{0.975,23}\\approx 2.06866$。总宽度为\n$$\nW=2\\,(2.06866)\\,\\sqrt{12.8}\\approx 2\\,(2.06866)\\,(3.577708764)\\approx 14.802.\n$$\n四舍五入到三位有效数字，总宽度为 $14.8$ mg/dL。", "answer": "$$\\boxed{14.8}$$", "id": "1907642"}, {"introduction": "在收集数据之前，一个关键步骤是确定需要多大的样本量才能得出有意义的结论。本练习正解决了这个问题，向你展示如何计算所需的最小样本量，以确保你的置信区间足够精确，能够检测到具有科学意义的差异。掌握这项技能有助于设计高效且有力的实验。[@problem_id:1907649]", "problem": "一位材料工程师正在计划一项实验，以比较一种新型钢合金（合金1）与一种标准合金（合金2）的拉伸强度。假设两种合金的拉伸强度均服从正态分布，但其总体方差可能不同且未知。\n\n该工程师希望确定每种合金需要测试的最少样本数量 $n$（即样本量相等，$n_1 = n_2 = n$），以确保平均拉伸强度之差 $\\mu_1 - \\mu_2$ 的95%置信区间不包含零。\n\n根据先前的研究和一项小型预备研究，该工程师预计新合金的真实平均强度至少比标准合金高 5.0 MPa。该预备研究还提供了两种合金的方差估计值，分别为 $s_1^2 = 30.0 \\, \\text{MPa}^2$ 和 $s_2^2 = 45.0 \\, \\text{MPa}^2$。\n\n假设这些方差估计值对于规划目的而言是可靠的，那么每种合金所需的最小整数样本量 $n$ 是多少？", "solution": "设预期的最小真实差异为 $\\Delta=5.0$，规划方差估计值为 $s_{1}^{2}=30.0$ 和 $s_{2}^{2}=45.0$。对于两个方差可能不等、样本量相等的独立正态样本（$n_{1}=n_{2}=n$），$\\mu_{1}-\\mu_{2}$ 的 $100(1-\\alpha)\\%$ Welch置信区间的半宽度（误差范围）为\n$$\n\\text{ME}(n)=t_{1-\\alpha/2,\\nu(n)}\\sqrt{\\frac{s_{1}^{2}}{n}+\\frac{s_{2}^{2}}{n}},\n$$\n其中 $t_{1-\\alpha/2,\\nu}$ 是自由度为 Welch–Satterthwaite 自由度的 t-分布的上 $(1-\\alpha/2)$ 分位数\n$$\n\\nu(n)=\\frac{\\left(\\frac{s_{1}^{2}}{n}+\\frac{s_{2}^{2}}{n}\\right)^{2}}{\\frac{\\left(\\frac{s_{1}^{2}}{n}\\right)^{2}}{n-1}+\\frac{\\left(\\frac{s_{2}^{2}}{n}\\right)^{2}}{n-1}}.\n$$\n为确保当真实差异至少为 $\\Delta$ 时，$\\mu_{1}-\\mu_{2}$ 的 $95\\%$ 置信区间（因此 $\\alpha=0.05$）不包含 $0$，一个标准的规划准则是要求半宽度不超过 $\\Delta$：\n$$\n\\text{ME}(n)\\leq \\Delta.\n$$\n代入给定的 $s_{1}^{2}$ 和 $s_{2}^{2}$ 可得\n$$\n\\text{ME}(n)=t_{0.975,\\nu(n)}\\sqrt{\\frac{30}{n}+\\frac{45}{n}}=t_{0.975,\\nu(n)}\\sqrt{\\frac{75}{n}},\n$$\n并且自由度（当 $n_{1}=n_{2}=n$ 时）简化为\n$$\n\\nu(n)=\\frac{\\left(\\frac{75}{n}\\right)^{2}}{\\frac{\\left(\\frac{30}{n}\\right)^{2}}{n-1}+\\frac{\\left(\\frac{45}{n}\\right)^{2}}{n-1}}=\\frac{75^{2}(n-1)}{30^{2}+45^{2}}=\\frac{25}{13}(n-1).\n$$\n因此，设计不等式变为\n$$\nt_{0.975,\\;\\frac{25}{13}(n-1)}\\sqrt{\\frac{75}{n}}\\leq 5,\n$$\n等价于\n$$\nt_{0.975,\\;\\frac{25}{13}(n-1)}\\leq 5\\sqrt{\\frac{n}{75}}=\\sqrt{\\frac{n}{3}}.\n$$\n因为 $t_{0.975,\\nu}$ 随 $\\nu$ 的增加而减小，我们从小到大检查整数 $n$，直到不等式成立。\n\n- 当 $n=12$ 时：$\\nu=\\frac{25}{13}\\cdot 11\\approx 21.15$，所以 $t_{0.975,\\nu}\\approx 2.08$。右侧为 $\\sqrt{\\frac{12}{3}}=2$。由于 $2.08>2$，不等式不成立（等价地，$\\text{ME}\\approx 2.08\\cdot 2.5=5.20>5$）。\n\n- 当 $n=13$ 时：$\\nu=\\frac{25}{13}\\cdot 12\\approx 23.08$，所以 $t_{0.975,\\nu}\\approx 2.07$。右侧为 $\\sqrt{\\frac{13}{3}}\\approx 2.0817$。由于 $2.07\\leq 2.0817$，不等式成立（等价地，$\\text{ME}\\approx 2.07\\cdot \\sqrt{75/13}\\approx 2.07\\cdot 2.402\\approx 4.97\\leq 5$）。\n\n因此，满足要求的最小整数 $n$ 是每种合金各为 $13$。", "answer": "$$\\boxed{13}$$", "id": "1907649"}, {"introduction": "比较两个均值的原理可以被强有力地扩展到涉及多个组的更复杂问题中。这个问题挑战你为四个不同总体均值的线性组合构建一个置信区间，这种情况在比较多个处理组与对照组时很常见。本练习展示了其背后统计理论的多功能性和广泛适用性。[@problem_id:1907678]", "problem": "一家材料科学公司正在评估两种新的合金制造方法（方法1和方法2），并与两种既有的传统方法（方法3和方法4）进行比较。主要性能指标是所得合金的极限抗拉强度，单位为兆帕（MPa）。根据大量的历史数据可知，每种方法生产的合金的抗拉强度均服从正态分布，且方差已知且稳定。该公司进行了一组新的测试，从四种方法各自的产出中收集了独立的随机样本。\n\n收集的数据如下：\n- **方法1：** 样本容量 $n_1=25$，样本均值 $\\bar{x}_1 = 560$ MPa。已知总体方差为 $\\sigma_1^2 = 225$ (MPa)$^2$。\n- **方法2：** 样本容量 $n_2=30$，样本均值 $\\bar{x}_2 = 585$ MPa。已知总体方差为 $\\sigma_2^2 = 324$ (MPa)$^2$。\n- **方法3：** 样本容量 $n_3=40$，样本均值 $\\bar{x}_3 = 540$ MPa。已知总体方差为 $\\sigma_3^2 = 400$ (MPa)$^2$。\n- **方法4：** 样本容量 $n_4=35$，样本均值 $\\bar{x}_4 = 530$ MPa。已知总体方差为 $\\sigma_4^2 = 484$ (MPa)$^2$。\n\n该公司感兴趣的参数是 $\\theta = (\\mu_1 + \\mu_2) - (\\mu_3 + \\mu_4)$，它代表两种新方法的真实平均抗拉强度之和与两种传统方法的真实平均抗拉强度之和之间的差值。\n\n为参数 $\\theta$ 构建一个95%的置信区间。将您的答案表示为区间的下限和上限。以MPa为单位表示区间的下限和上限，并四舍五入到三位有效数字。在计算中，请使用标准正态累积分布函数（CDF）值 $\\Phi(1.96) \\approx 0.975$。", "solution": "我们已知四个独立的、方差已知的正态总体。对于方法 $i$，样本均值 $\\bar{X}_{i}$ 满足 $\\bar{X}_{i} \\sim \\mathcal{N}\\!\\left(\\mu_{i}, \\frac{\\sigma_{i}^{2}}{n_{i}}\\right)$，且各个 $\\bar{X}_{i}$ 是独立的。定义目标参数 $\\theta = (\\mu_{1} + \\mu_{2}) - (\\mu_{3} + \\mu_{4})$ 及其自然的无偏估计量\n$$\n\\hat{\\theta} = (\\bar{X}_{1} + \\bar{X}_{2}) - (\\bar{X}_{3} + \\bar{X}_{4}).\n$$\n根据线性和独立性，$\\hat{\\theta}$ 服从正态分布，其均值为 $\\theta$，方差为\n$$\n\\operatorname{Var}(\\hat{\\theta}) = \\frac{\\sigma_{1}^{2}}{n_{1}} + \\frac{\\sigma_{2}^{2}}{n_{2}} + \\frac{\\sigma_{3}^{2}}{n_{3}} + \\frac{\\sigma_{4}^{2}}{n_{4}}.\n$$\n在方差已知的情况下，$\\theta$ 的双侧 $0.95$ 置信区间为\n$$\n\\hat{\\theta} \\pm z_{0.975}\\,\\sqrt{\\frac{\\sigma_{1}^{2}}{n_{1}} + \\frac{\\sigma_{2}^{2}}{n_{2}} + \\frac{\\sigma_{3}^{2}}{n_{3}} + \\frac{\\sigma_{4}^{2}}{n_{4}}},\n$$\n其中 $z_{0.975}$ 满足 $\\Phi(z_{0.975})=0.975$，因此 $z_{0.975}=1.96$。\n\n计算点估计值：\n$$\n\\hat{\\theta} = (560 + 585) - (540 + 530) = 1145 - 1070 = 75.\n$$\n计算标准误：\n$$\n\\sqrt{\\frac{225}{25} + \\frac{324}{30} + \\frac{400}{40} + \\frac{484}{35}} \\;=\\; \\sqrt{9 + 10.8 + 10 + \\frac{484}{35}} \\;=\\; \\sqrt{\\frac{1527}{35}} \\approx 6.605193.\n$$\n计算误差范围：\n$$\n1.96 \\times \\sqrt{\\frac{1527}{35}} \\approx 1.96 \\times 6.605193 \\approx 12.946178.\n$$\n因此，$0.95$ 置信区间为\n$$\n75 \\pm 12.946178 \\quad \\Rightarrow \\quad [\\,62.053822,\\; 87.946178\\,].\n$$\n将下限和上限四舍五入到三位有效数字，分别得到 $62.1$ 和 $87.9$ MPa。", "answer": "$$\\boxed{[62.1, 87.9]}$$", "id": "1907678"}]}