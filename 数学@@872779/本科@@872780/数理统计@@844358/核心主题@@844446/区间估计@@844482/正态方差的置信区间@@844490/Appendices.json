{"hands_on_practices": [{"introduction": "评估一个过程的变异性是许多科学和工程领域中的一个基本任务。当我们可以假设数据来自正态分布时，卡方 ($\\chi^2$) 分布为我们提供了一个精确推断总体方差的强大工具。本练习将指导您完成构建正态方差置信区间的核心步骤，这是一个在质量控制等应用中至关重要的基础技能 [@problem_id:1908732]。", "problem": "一家制药公司的质量控制工程师负责评估一种特定药物片剂新生产工艺的一致性。每片药片中活性成分的质量是一个关键的质量特性，并假设其服从正态分布。为了评估该工艺的变异性，工程师从一个大的生产批次中随机抽取了20片药片作为样本。经过仔细测量，计算出活性成分质量的样本方差为 $s^2 = 15.0$ 平方毫克 ($\\text{mg}^2$)。\n\n使用此样本数据，为活性成分质量的真实总体方差 $\\sigma^2$ 构建一个90%的置信区间。按顺序提供该区间的下限和上限。两个值都以 $\\text{mg}^2$ 为单位表示，并四舍五入到三位有效数字。", "solution": "我们假设片剂活性成分的质量服从正态分布，其总体方差为 $\\sigma^2$。对于一个大小为 $n$、样本方差为 $s^2$ 的样本，关键量 $\\frac{(n-1)s^2}{\\sigma^2}$ 服从自由度为 $\\nu = n-1$ 的卡方分布 ($\\chi^2_{n-1}$)。\n\n一个置信水平为 $1-\\alpha$ 的双侧置信区间的公式为：\n$$\n\\left[ \\frac{(n-1)s^2}{\\chi^2_{\\nu, \\alpha/2}}, \\frac{(n-1)s^2}{\\chi^2_{\\nu, 1-\\alpha/2}} \\right]\n$$\n其中 $\\chi^2_{\\nu, p}$ 表示自由度为 $\\nu$ 的卡方分布的右上分位数（其右侧面积为 $p$）。\n\n在本题中，样本量 $n=20$，样本方差 $s^2 = 15.0 \\, \\text{mg}^2$，置信水平为 90%，因此 $\\alpha=0.10$。自由度为 $\\nu = n-1 = 19$。我们需要找到 $\\alpha/2 = 0.05$ 和 $1-\\alpha/2 = 0.95$ 对应的上分位数：\n- 上临界值：$\\chi^2_{19, 0.05} = 30.144$\n- 下临界值：$\\chi^2_{19, 0.95} = 10.117$\n\n现在计算置信区间的下限和上限：\n$$\n\\text{下限} = \\frac{(20-1) \\cdot 15.0}{\\chi^2_{19, 0.05}} = \\frac{285}{30.144} \\approx 9.4546 \\, \\text{mg}^2\n$$\n$$\n\\text{上限} = \\frac{(20-1) \\cdot 15.0}{\\chi^2_{19, 0.95}} = \\frac{285}{10.117} \\approx 28.1696 \\, \\text{mg}^2\n$$\n将结果四舍五入到三位有效数字，我们得到置信区间的下限为 $9.45 \\, \\text{mg}^2$，上限为 $28.2 \\, \\text{mg}^2$。", "answer": "$$\\boxed{\\begin{pmatrix}9.45  28.2\\end{pmatrix}}$$", "id": "1908732"}, {"introduction": "虽然标准的“等尾”置信区间易于构建，但它是否总是最有效的选择？置信区间的“效率”通常通过其长度来衡量——区间越短，估计越精确。由于卡方分布的非对称性，等概率的尾部并不意味着区间是可能的最短区间，这个问题引导我们通过一个具体的例子来探讨这个概念，挑战我们对“标准”方法的直观理解 [@problem_id:1923810]。", "problem": "一位工程师正在评估精密加工活塞的制造一致性。假设活塞的直径服从一个未知均值为 $\\mu$、未知方差为 $\\sigma^2$ 的正态分布。为了估计方差，随机抽取了 $n=11$ 个活塞样本，并测量了它们的直径。样本方差被计算并记为 $s^2$。\n\n该工程师考虑用两种不同的方法来为真实的总体方差 $\\sigma^2$ 构建 95% 置信区间。这两种区间的构建都依赖于枢轴量 $\\frac{(n-1)s^2}{\\sigma^2}$，该枢轴量服从自由度为 $\\nu = n-1 = 10$ 的卡方分布。$\\sigma^2$ 的置信区间形式为 $\\left( \\frac{(n-1)s^2}{b}, \\frac{(n-1)s^2}{a} \\right)$，其中 $a$ 和 $b$ 是 $\\chi^2_{10}$ 分布的分位数，满足 $P(a  \\chi^2_{10}  b) = 0.95$。\n\n**方法 A (等尾区间)：**\n这个标准区间是通过选择临界值 $a_A$ 和 $b_A$ 来构建的，使得 $\\chi^2_{10}$ 分布两尾的概率相等。具体来说，$P(\\chi^2_{10}  a_A) = 0.025$ 且 $P(\\chi^2_{10} > b_A) = 0.025$。所需的分位数给出为 $a_A = 3.247$ 和 $b_A = 20.483$。\n\n**方法 B (备选区间)：**\n这个备选区间是通过选择临界值 $a_B$ 和 $b_B$ 来构建的，它们同时满足以下两个条件：\n1. $P(a_B  \\chi^2_{10}  b_B) = 0.95$\n2. $a_B^2 f(a_B) = b_B^2 f(b_B)$，其中 $f(v)$ 是 $\\chi^2_{10}$ 分布的概率密度函数 (PDF)。\n对于此方法，所需的分位数已通过数值方法确定为 $a_B = 4.284$ 和 $b_B = 22.022$。\n\n你的任务是计算方法 B 得到的置信区间长度与方法 A 得到的置信区间长度之比。也就是说，计算 $\\frac{L_B}{L_A}$ 的值。将你的最终答案四舍五入到三位有效数字。", "solution": "$\\sigma^2$ 的置信区间形式为 $\\left( \\frac{(n-1)s^2}{b}, \\frac{(n-1)s^2}{a} \\right)$。区间的长度 $L$ 由下式给出：\n$$\nL = \\frac{(n-1)s^2}{a} - \\frac{(n-1)s^2}{b} = (n-1)s^2 \\left( \\frac{1}{a} - \\frac{1}{b} \\right)\n$$\n我们需要计算两种方法得到的区间长度之比 $\\frac{L_B}{L_A}$。由于 $(n-1)s^2$ 是一个公共因子，它会在比率中被消掉。因此，比率仅取决于临界值 $a$ 和 $b$：\n$$\n\\frac{L_B}{L_A} = \\frac{(n-1)s^2 \\left( \\frac{1}{a_B} - \\frac{1}{b_B} \\right)}{(n-1)s^2 \\left( \\frac{1}{a_A} - \\frac{1}{b_A} \\right)} = \\frac{\\frac{1}{a_B} - \\frac{1}{b_B}}{\\frac{1}{a_A} - \\frac{1}{b_A}}\n$$\n\n**方法 A (等尾区间) 的参数:**\n$a_A = 3.247$\n$b_A = 20.483$\n\n**方法 B (备选区间) 的参数:**\n$a_B = 4.284$\n$b_B = 22.022$\n\n现在我们计算每种方法的长度因子：\n对于方法 A：\n$$\n\\frac{1}{a_A} - \\frac{1}{b_A} = \\frac{1}{3.247} - \\frac{1}{20.483} \\approx 0.307976 - 0.048821 = 0.259155\n$$\n对于方法 B：\n$$\n\\frac{1}{a_B} - \\frac{1}{b_B} = \\frac{1}{4.284} - \\frac{1}{22.022} \\approx 0.233427 - 0.045409 = 0.188018\n$$\n\n最后，计算长度之比：\n$$\n\\frac{L_B}{L_A} = \\frac{0.188018}{0.259155} \\approx 0.72554\n$$\n将结果四舍五入到三位有效数字，我们得到 0.726。", "answer": "$$\\boxed{0.726}$$", "id": "1923810"}, {"introduction": "在处理大样本时，统计学家通常会利用基于估计量渐近正态性的简化方法。这引出了一个重要问题：基于卡方分布的精确但非对称的方差置信区间，与基于大样本理论的简单对称区间之间有何关联？本挑战性练习通过推导精确区间非对称性的收敛速度，在有限样本的精确理论和无限样本的渐近理论之间架起了一座桥梁，从而深刻揭示了它们之间的关系 [@problem_id:1906923]。", "problem": "两位统计学家 Alice 和 Bob 的任务是分析一个大数据集 $X_1, X_2, \\dots, X_n$。他们将此数据集建模为来自正态分布 $N(\\mu, \\sigma^2)$ 的随机样本，其中均值 $\\mu$ 和方差 $\\sigma^2$ 均未知。他们的目标是为过程方差 $\\sigma^2$ 构建一个 $100(1-\\alpha)\\%$ 的置信区间。\n\nAlice 坚持使用由枢轴量 $\\frac{(n-1)S^2}{\\sigma^2}$ 导出的理论上精确的有限样本区间，该枢轴量服从自由度为 $n-1$ 的卡方分布。其中，$S^2 = \\frac{1}{n-1}\\sum_{i=1}^{n}(X_i - \\bar{X})^2$ 是无偏样本方差，而 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n}X_i$ 是样本均值。\n\nBob 则认为，对于他们的大样本量 $n$，使用基于 $\\sigma^2$ 的最大似然估计量 (MLE) 的渐近正态性的大样本置信区间会更简单且足够有效。$\\sigma^2$ 的最大似然估计量为 $\\hat{\\sigma}^2_{MLE} = \\frac{1}{n}\\sum_{i=1}^{n}(X_i - \\bar{X})^2$。\n\n他们得到的两个区间的一个关键区别在于，Bob 的区间关于点估计 $\\hat{\\sigma}^2_{MLE}$ 是对称的，而 Alice 的区间则不是。为了解决他们的争论，他们决定量化随着样本量 $n$ 的增长，Alice 的精确区间的不对称性消失的速度。\n\n对于一个参数的置信区间 $[L, U]$，其基于点估计 $\\hat{\\theta}$ 的不对称性，可以通过区间上臂长度 $(U - \\hat{\\theta})$ 与下臂长度 $(\\hat{\\theta} - L)$ 之比来衡量：$R = \\frac{U - \\hat{\\theta}}{\\hat{\\theta} - L}$。一个完全对称的区间有 $R=1$。\n\n令 $R_n$ 为 Alice 为 $\\sigma^2$ 构建的精确 $100(1-\\alpha)\\%$ 置信区间的不对称性比率，其中使用 $\\hat{\\sigma}^2_{MLE}$ 作为点估计。你的任务是找出此不对称性收敛到 1 的速率。具体来说，计算以下极限：\n$$C = \\lim_{n \\to \\infty} \\sqrt{n-1} (R_n - 1)$$\n请将 $C$ 的最终答案表示为一个关于 $z_{\\alpha/2}$ 的解析表达式，其中 $z_{\\alpha/2}$ 表示标准正态分布的上$\\alpha/2$分位数（即，对于 $Z \\sim N(0,1)$，有 $P(Z > z_{\\alpha/2}) = \\alpha/2$）。你可以使用自由度为 $k$ 的卡方分布分位数的标准正态近似，该近似表明，对于较大的 $k$，其上$p$分位数 $\\chi^2_{p,k}$ 可近似为 $k + z_p\\sqrt{2k}$。", "solution": "令 $k=n-1$。Alice 基于 $S^2$ 为 $\\sigma^2$ 构建的精确区间为\n$$\n\\left[\\frac{k S^{2}}{\\chi^{2}_{\\alpha/2,k}},\\ \\frac{k S^{2}}{\\chi^{2}_{1-\\alpha/2,k}}\\right],\n$$\n其中 $\\chi^{2}_{p,k}$ 表示 $\\chi^{2}_{k}$ 分布的上$p$分位数。使用 $\\hat{\\sigma}^{2}_{MLE}=\\frac{1}{n}\\sum_{i=1}^{n}(X_{i}-\\bar{X})^{2}=\\frac{k}{n}S^{2}$ 作为点估计，不对称性比率为\n$$\nR_{n}=\\frac{U-\\hat{\\sigma}^{2}_{MLE}}{\\hat{\\sigma}^{2}_{MLE}-L}\n=\\frac{\\frac{k S^2}{\\chi^{2}_{1-\\alpha/2,k}}-\\frac{k S^2}{n}}{\\frac{k S^2}{n}-\\frac{k S^2}{\\chi^{2}_{\\alpha/2,k}}}\n=\\frac{\\frac{1}{\\chi^{2}_{1-\\alpha/2,k}}-\\frac{1}{n}}{\\frac{1}{n}-\\frac{1}{\\chi^{2}_{\\alpha/2,k}}}.\n$$\n\n设 $a=\\chi^{2}_{\\alpha/2,k}$ 和 $b=\\chi^{2}_{1-\\alpha/2,k}$。使用给定的卡方分位数近似以及标准正态分布的上侧分位数 $z_{p}$，记 $z=z_{\\alpha/2}>0$ 且\n$$\na\\approx k+z\\sqrt{2k},\\qquad b\\approx k-z\\sqrt{2k}.\n$$\n令 $\\varepsilon=z\\sqrt{\\frac{2}{k}}$。那么\n$$\n\\frac{1}{a}=\\frac{1}{k}\\frac{1}{1+\\varepsilon}=\\frac{1}{k}\\left(1-\\varepsilon+\\varepsilon^{2}\\right)+o\\!\\left(k^{-2}\\right),\\qquad\n\\frac{1}{b}=\\frac{1}{k}\\frac{1}{1-\\varepsilon}=\\frac{1}{k}\\left(1+\\varepsilon+\\varepsilon^{2}\\right)+o\\!\\left(k^{-2}\\right),\n$$\n且\n$$\n\\frac{1}{n}=\\frac{1}{k+1}=\\frac{1}{k}-\\frac{1}{k^{2}}+o\\!\\left(k^{-2}\\right).\n$$\n因此，$R_{n}$ 的分子 $N$ 和分母 $D$ 满足\n$$\nN=\\frac{1}{b}-\\frac{1}{n}=\\frac{1}{k}\\varepsilon+\\frac{1}{k}\\varepsilon^{2}+\\frac{1}{k^{2}}+o\\!\\left(k^{-2}\\right),\\qquad\nD=\\frac{1}{n}-\\frac{1}{a}=\\frac{1}{k}\\varepsilon-\\frac{1}{k}\\varepsilon^{2}-\\frac{1}{k^{2}}+o\\!\\left(k^{-2}\\right).\n$$\n由于 $\\varepsilon=z\\sqrt{\\frac{2}{k}}$，我们有\n$$\n\\frac{1}{k}\\varepsilon=z\\sqrt{2}\\,k^{-3/2},\\qquad \\frac{1}{k}\\varepsilon^{2}=2z^{2}k^{-2}.\n$$\n因此\n$$\nN=z\\sqrt{2}\\,k^{-3/2}+(2z^{2}+1)k^{-2}+o\\!\\left(k^{-2}\\right),\\qquad\nD=z\\sqrt{2}\\,k^{-3/2}-(2z^{2}+1)k^{-2}+o\\!\\left(k^{-2}\\right).\n$$\n记 $A_{0}=z\\sqrt{2}\\,k^{-3/2}$ 且 $\\Delta=(2z^{2}+1)k^{-2}$。那么\n$$\nR_{n}=\\frac{A_{0}+\\Delta}{A_{0}-\\Delta} \\approx 1+\\frac{2\\Delta}{A_{0}}\n=1+\\frac{2(2z^{2}+1)k^{-2}}{z\\sqrt{2}\\,k^{-3/2}}+o\\!\\left(k^{-1/2}\\right) = 1+\\frac{\\sqrt{2}(2z^{2}+1)}{z}\\,k^{-1/2}+o\\!\\left(k^{-1/2}\\right).\n$$\n因此\n$$\n\\lim_{n\\to\\infty}\\sqrt{n-1}\\,(R_{n}-1)=\\lim_{k\\to\\infty}\\sqrt{k}\\,(R_{n}-1)\n=\\sqrt{2}\\,\\frac{2z^{2}+1}{z},\\qquad z=z_{\\alpha/2}.\n$$\n这就给出了所求的常数\n$$\nC=\\sqrt{2}\\,\\frac{2z_{\\alpha/2}^{2}+1}{z_{\\alpha/2}}.\n$$", "answer": "$$\\boxed{\\sqrt{2}\\,\\frac{2z_{\\alpha/2}^{2}+1}{z_{\\alpha/2}}}$$", "id": "1906923"}]}