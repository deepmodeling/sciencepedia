{"hands_on_practices": [{"introduction": "理解一个概率分布的最佳方式之一是了解如何从其基本构成部分生成它。本练习将带您回到卡方分布的根本定义：独立标准正态随机变量的平方和。通过设计一个模拟算法，您将巩固对这一定义的理解，这对于蒙特卡洛方法和统计计算至关重要。[@problem_id:1903721]", "problem": "在开发一个自定义统计模拟库时，一位程序员的任务是创建一个函数，用于从自由度为 $k$ 的卡方分布（记为 $\\chi^2(k)$，其中 $k$ 为正整数）中生成随机变量。唯一可用的工具是一个已有的函数 `get_std_normal()`，它返回一个从标准正态分布 $N(0, 1)$ 中抽取的随机数。\n\n程序员必须设计一个算法，通过一次或多次调用 `get_std_normal()` 来正确生成一个服从 $\\chi^2(k)$ 分布的随机变量。以下哪个提出的算法能正确完成此任务？\n\nA. 初始化一个变量 `sum_of_squares` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并将 $z^2$ 加到 `sum_of_squares` 上。`sum_of_squares` 的最终值就是结果。\n\nB. 初始化一个变量 `sum_val` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并将 $z$ 加到 `sum_val` 上。`sum_val` 的最终值就是结果。\n\nC. 初始化一个变量 `sum_val` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并将 $z$ 加到 `sum_val` 上。最终结果是 `sum_val` 的平方。\n\nD. 精确调用一次 `get_std_normal()` 得到一个值 $z$。结果为 $k \\times z$。\n\nE. 初始化一个变量 `sum_of_squares` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并将 $z^2$ 加到 `sum_of_squares` 上。最终结果是 `sum_of_squares` 除以 $k$。", "solution": "设 $Z_{1},\\dots,Z_{k}$ 是独立的标准正态随机变量，每个都通过调用 get_std_normal() 获得，因此 $Z_{i} \\sim N(0,1)$ 且 $Z_{i}$ 是相互独立的。根据卡方分布的定义性质，平方和\n$$\nQ=\\sum_{i=1}^{k} Z_{i}^{2}\n$$\n服从 $\\chi^{2}(k)$ 分布。这可以通过矩生成函数来验证：对于 $t  \\frac{1}{2}$，$Z_{i}^{2}$ 的矩生成函数是 $(1-2t)^{-1/2}$，并且根据独立性\n$$\nM_{Q}(t)=\\prod_{i=1}^{k}(1-2t)^{-1/2}=(1-2t)^{-k/2},\n$$\n这就是 $\\chi^{2}(k)$ 的矩生成函数。因此，计算 $k$ 个独立标准正态随机变量的平方和正是正确的算法。\n\n现在评估每个提出的算法：\n\nA. 该算法计算 $Q=\\sum_{i=1}^{k} Z_{i}^{2}$，根据定义，其服从 $\\chi^{2}(k)$ 分布。因此 A 是正确的。\n\nB. 该算法计算 $S=\\sum_{i=1}^{k} Z_{i}$，其服从正态分布 $S \\sim N(0,k)$，而不是卡方分布。因此 B 是不正确的。\n\nC. 该算法计算 $S^{2}$，其中 $S=\\sum_{i=1}^{k} Z_{i} \\sim N(0,k)$。那么 $S/\\sqrt{k} \\sim N(0,1)$ 且 $S^{2}=k\\,(S/\\sqrt{k})^{2}$，因此 $S^{2}$ 服从 $k \\cdot \\chi^{2}(1)$ 分布，除非 $k=1$，否则它不是 $\\chi^{2}(k)$。因此 C 在一般情况下是不正确的。\n\nD. 该算法计算 $k Z$，其中 $Z \\sim N(0,1)$ 是单个变量，得到的是 $N(0,k^{2})$ 分布，而不是卡方分布。因此 D 是不正确的。\n\nE. 该算法计算 $\\frac{1}{k}\\sum_{i=1}^{k} Z_{i}^{2}=\\frac{1}{k}\\,\\chi^{2}(k)$，这是一个缩放后的卡方变量，而不是 $\\chi^{2}(k)$。因此 E 是不正确的。\n\n因此，唯一正确的算法是 A。", "answer": "$$\\boxed{A}$$", "id": "1903721"}, {"introduction": "在掌握了卡方分布的一般构造方法之后，让我们来探究一个重要的特例。本练习将考察自由度为 $2$ 的卡方分布，揭示其与指数分布之间出人意料的联系。通过这个在信号处理等领域常见的场景，您将练习使用概率密度函数进行直接的概率计算。[@problem_id:1903718]", "problem": "在一个分析雷达系统噪声的简化模型中，信号的正交分量由两个独立的随机变量 $X$ 和 $Y$ 表示。$X$ 和 $Y$ 都服从标准正态分布，即每个变量的均值为0，方差为1。噪声信号的瞬时功率由随机变量 $W = X^2 + Y^2$ 定义。\n\n如果瞬时噪声功率 $W$ 超过某个阈值，检测算法会标记一个事件。计算噪声功率 $W$ 大于3.5的概率。请以单个实数的形式给出答案，并四舍五入到四位有效数字。", "solution": "设 $X \\sim \\mathcal{N}(0,1)$ 和 $Y \\sim \\mathcal{N}(0,1)$ 是独立的。那么平方和 $W = X^{2} + Y^{2}$ 服从自由度为2的卡方分布：\n$$\nW \\sim \\chi^{2}(2).\n$$\n$\\chi^{2}(2)$ 的概率密度函数为\n$$\nf_{W}(w) = \\frac{1}{2^{1}\\Gamma(1)} w^{1-1} \\exp\\!\\left(-\\frac{w}{2}\\right) = \\frac{1}{2}\\exp\\!\\left(-\\frac{w}{2}\\right), \\quad w \\geq 0.\n$$\n对于 $t \\geq 0$，尾部概率为\n$$\n\\mathbb{P}(W > t) = \\int_{t}^{\\infty} \\frac{1}{2}\\exp\\!\\left(-\\frac{w}{2}\\right) \\, dw.\n$$\n进行换元 $u = \\frac{w}{2}$，则 $dw = 2\\,du$ 并且当 $w = t$ 时，$u = \\frac{t}{2}$。那么\n$$\n\\mathbb{P}(W > t) = \\int_{t/2}^{\\infty} \\exp(-u)\\,du = \\exp\\!\\left(-\\frac{t}{2}\\right).\n$$\n对于 $t = 3.5$，\n$$\n\\mathbb{P}(W > 3.5) = \\exp\\!\\left(-\\frac{3.5}{2}\\right) = \\exp(-1.75).\n$$\n数值上，当四舍五入到四位有效数字时，$\\exp(-1.75) \\approx 0.1738$。", "answer": "$$\\boxed{0.1738}$$", "id": "1903718"}, {"introduction": "现在，让我们将理论知识应用于卡方分布最常见的用途之一：假设检验。本练习将引导您完成一个经典的拟合优度检验，这是一个在遗传学、社会科学等领域广泛使用的统计工具。您将学会如何确定自由度，并使用标准的统计表格来评估实验结果的统计显著性。[@problem_id:1903706]", "problem": "一个农学家团队正在研究一种新发现的植物物种的花色遗传。根据他们的遗传模型，将特定的一对亲本植物进行杂交，应该会产生具有四种不同花色（红色、蓝色、黄色、白色）的后代，且这些花色遵循一个固定的理论比例。为了检验这个模型，他们进行了一项实验，并统计了每种颜色类别的后代数量。\n\n他们使用卡方拟合优度检验。检验统计量，记为 $X$，是根据观测计数和期望计数计算得出的。在他们的遗传模型是正确的（即原假设）的假设下，该检验统计量 $X$ 服从卡方分布。此检验的自由度（$df$）由 $k - 1$ 给出，其中 $k$ 是类别的数量（在本例中为四种花色）。\n\n完成实验后，农学家们计算出检验统计量的值为 $X_{\\text{obs}} = 6.251$。在统计检验中，p值是在原假设为真的前提下，获得一个至少与实际观测到的结果一样极端或更极端的结果的概率。对于此检验，更极端的结果对应于更大的检验统计量值。\n\n使用所提供的卡方分布累积概率表 $P(X \\le \\chi^2)$，确定一个服从相应卡方分布的随机变量大于观测到的检验统计量 $6.251$ 的概率。请将您的答案表示为小数。\n\n**卡方分布累积概率表**\n下表给出了选定自由度（$df$）和累积概率 $p$ 下的 $\\chi^2$ 值。给定行和列的条目是满足 $P(X \\le \\chi^2) = p$ 的 $\\chi^2$ 值。\n\n| | **累积概率 (p)** | | | |\n| :---: | :---: | :---: | :---: | :---: |\n| **df** | **0.05** | **0.10** | **0.90** | **0.95** |\n| **2** | 0.103 | 0.211 | 4.605 | 5.991 |\n| **3** | 0.352 | 0.584 | 6.251 | 7.815 |\n| **4** | 0.711 | 1.064 | 7.779 | 9.488 |", "solution": "我们有 $k=4$ 个颜色类别，因此卡方拟合优度检验的自由度为 $df=k-1=4-1=3$。观测到的检验统计量为 $X_{\\text{obs}}=6.251$。我们想要求解概率 $P(X6.251)$，其中 $X \\sim \\chi^2(3)$。\n\n从所提供的 $df=3$ 的表格中，累积概率 $p=0.90$ 处的条目是 $\\chi^{2}=6.251$。根据表格的定义，这意味着 $P(X\\leq 6.251)=0.90$。\n\n因此，\n$$\nP(X6.251)=1-P(X\\leq 6.251)=1-0.90=0.10.\n$$", "answer": "$$\\boxed{0.10}$$", "id": "1903706"}]}