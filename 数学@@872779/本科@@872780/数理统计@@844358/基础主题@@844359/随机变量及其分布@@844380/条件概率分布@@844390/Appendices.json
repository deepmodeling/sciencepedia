{"hands_on_practices": [{"introduction": "我们从一个经典的离散概率问题开始，这个场景涉及从一个有限总体中进行不放回抽样。本练习旨在阐明一个基本概念：当我们获得关于某个事件的信息时（例如，第一次抽到的球是红色的），我们应该如何更新对后续结果的概率评估 [@problem_id:1906185]。通过解决这个问题，你将练习使用组合学方法来推导条件概率质量函数，这是理解条件分布在离散情况下的一个重要基石。", "problem": "一个罐子里总共有 $N$ 个球，其中 $K$ 个是红球，其余 $N-K$ 个是黑球。从罐子中无放回地随机抽取 $n$ 个球，其中 $1 \\le n \\le N$ 且 $1 \\le K \\le N$。令 $X$ 为表示抽取的 $n$ 个球样本中红球总数的随机变量。给定事件 $E$，定义为抽出的第一个球是红球，求条件概率 $P(X=k | E)$。将你的答案表示为 $k, n, N,$ 和 $K$ 的函数。假设 $k$ 是此条件分布的有效支撑集内的一个整数。", "solution": "设罐子中包含 $K$ 个红球和 $N-K$ 个黑球，并且无放回地抽取 $n$ 个球。定义 $E$ 为抽出的第一个球是红球的事件。以 $E$ 为条件。\n\n给定 $E$，在第一次（红色）抽取后，还剩下 $N-1$ 个球，其中 $K-1$ 个是红球， $N-K$ 个是黑球。剩下的 $n-1$ 次抽取是从这 $N-1$ 个球中无放回地进行的。令 $Y$ 表示在剩下的这 $n-1$ 次抽取中红球的数量。那么，完整样本中红球的总数满足\n$$\nX=1+Y.\n$$\n因此，对于有效支撑集内的任何整数 $k$，\n$$\nP(X=k \\mid E)=P(Y=k-1).\n$$\n由于 $Y$ 服从超几何分布，其总体大小为 $N-1$，成功数为 $K-1$，抽取大小为 $n-1$，其概率质量函数为\n$$\nP(Y=y)=\\frac{\\binom{K-1}{y}\\binom{N-K}{(n-1)-y}}{\\binom{N-1}{n-1}}.\n$$\n代入 $y=k-1$ 得到\n$$\nP(X=k \\mid E)=\\frac{\\binom{K-1}{k-1}\\binom{N-K}{n-k}}{\\binom{N-1}{n-1}},\n$$\n其中整数 $k$ 满足 $\\max\\{1,\\,n-(N-K)\\}\\leq k \\leq \\min\\{n,\\,K\\}$。", "answer": "$$\\boxed{\\frac{\\binom{K-1}{k-1}\\binom{N-K}{n-k}}{\\binom{N-1}{n-1}}}$$", "id": "1906185"}, {"introduction": "接下来，我们将实践转向连续概率分布，通过一个几何背景下的问题来加深理解。在这个练习中，我们需要在一个非矩形的二维区域（一个平行四边形）上处理均匀分布，并计算条件期望 [@problem_id:1906194]。这个问题提供了一个绝佳的机会，让我们直观地理解如何通过“切片”联合概率密度函数来获得条件分布，并看到条件期望 $E[Y|X=x]$ 是如何依赖于条件变量 $x$ 的值的。", "problem": "一个点 $(X, Y)$ 是从 $xy$ 平面上的区域 $\\mathcal{R}$ 内的均匀分布中随机选取的。区域 $\\mathcal{R}$ 是一个平行四边形，其顶点坐标为 $(0,0)$, $(2,0)$, $(3,1)$, 和 $(1,1)$。求给定 $X=x$ 时 $Y$ 的条件期望，记为 $E[Y|X=x]$。你的答案应该是一个关于 $x$ 的表达式，并且对所有条件期望有定义的 $x$ 值都有效。", "solution": "该区域是一个平行四边形，其顶点为 $(0,0)$, $(2,0)$, $(3,1)$ 和 $(1,1)$。它的边位于直线 $y=0$, $y=1$, $y=x$ 和 $y=x-2$ 上。这个平行四边形的面积是由张成向量 $(2,0)$ 和 $(1,1)$ 构成的行列式的绝对值，即 $|2\\cdot 1-0\\cdot 1|=2$。因此，联合密度函数在 $\\mathcal{R}$ 上为常数，等于 $f_{X,Y}(x,y)=\\frac{1}{2}$，在其他地方为零。\n\n对于一个固定的 $x$，穿过 $\\mathcal{R}$ 的垂直切片给出了 $y$ 的区间：\n- 当 $0 \\leq x \\leq 1$ 时，$y$ 的范围从 $a(x)=0$ 到 $b(x)=x$。\n- 当 $1 \\leq x \\leq 2$ 时，$y$ 的范围从 $a(x)=0$ 到 $b(x)=1$。\n- 当 $2 \\leq x \\leq 3$ 时，$y$ 的范围从 $a(x)=x-2$ 到 $b(x)=1$。\n\n对于任何具有非空切片的 $x$，其边际密度函数为\n$$\nf_{X}(x)=\\int f_{X,Y}(x,y)\\,dy=\\frac{1}{2}\\bigl(b(x)-a(x)\\bigr),\n$$\n且条件期望为\n$$\nE[Y\\mid X=x]=\\frac{1}{f_{X}(x)}\\int y\\,f_{X,Y}(x,y)\\,dy\n=\\frac{1}{\\frac{1}{2}(b-a)}\\cdot\\frac{1}{2}\\int_{a}^{b}y\\,dy\n=\\frac{1}{b-a}\\cdot\\frac{1}{2}\\bigl(b^{2}-a^{2}\\bigr)\n=\\frac{a(x)+b(x)}{2},\n$$\n即切片的中点。\n\n将每个 $x$ 范围的边界代入：\n- 当 $0 \\leq x \\leq 1$ 时，$E[Y\\mid X=x]=\\frac{0+x}{2}=\\frac{x}{2}$。\n- 当 $1 \\leq x \\leq 2$ 时，$E[Y\\mid X=x]=\\frac{0+1}{2}=\\frac{1}{2}$。\n- 当 $2 \\leq x \\leq 3$ 时，$E[Y\\mid X=x]=\\frac{(x-2)+1}{2}=\\frac{x-1}{2}$。\n\n这些公式在边界点 $x=0,1,2,3$ 也成立。在 $[0,3]$ 之外，条件期望是未定义的，因为 $f_{X}(x)=0$。", "answer": "$$\\boxed{\\begin{cases}\\frac{x}{2}, & 0 \\leq x \\leq 1,\\\\[4pt]\\frac{1}{2}, & 1 \\leq x \\leq 2,\\\\[4pt]\\frac{x-1}{2}, & 2 \\leq x \\leq 3.\\end{cases}}$$", "id": "1906194"}, {"introduction": "最后，我们来探讨一个在众多科学和工程领域中都至关重要的模型，即信号与噪声模型。这个问题假设信号和噪声都服从独立的标准正态分布，并要求我们推导在观测到它们的和之后，原始信号的条件分布 [@problem_id:1906118]。这个练习揭示了联合正态分布的一个核心且优美的性质，其结果在信号处理、卡尔曼滤波和贝叶斯统计等领域有着广泛的应用。", "problem": "在一个简化的通信系统模型中，原始信号 $X$ 受到加性噪声 $Y$ 的干扰。假设信号 $X$ 和噪声 $Y$ 都可以被建模为独立同分布的随机变量，各自服从标准正态分布。标准正态分布是指均值为0、方差为1的正态分布。\n\n接收端的观察者无法分别观测到原始信号 $X$ 或噪声 $Y$。他们只能观测到接收到的总信号，即它们的和 $S = X+Y$。为了估计原始信号，理解在给定特定观测值下 $X$ 的统计特性至关重要。\n\n假设接收器测得的总信号为 $S=s$，其中 $s$ 是一个实常数。请确定在此测量条件下原始信号 $X$ 的条件概率分布。以下哪项正确描述了该条件分布？\n\nA. 均值为 $s$、方差为 $1$ 的正态分布。\n\nB. 均值为 $\\frac{s}{2}$、方差为 $\\frac{1}{2}$ 的正态分布。\n\nC. 均值为 $\\frac{s}{2}$、方差为 $2$ 的正态分布。\n\nD. 区间 $[s-\\sqrt{3}, s+\\sqrt{3}]$ 上的均匀分布。\n\nE. 均值为 $0$、方差为 $\\frac{1}{2}$ 的正态分布。\n\nF. 自由度为1的卡方分布。", "solution": "设 $X$ 和 $Y$ 相互独立，且 $X \\sim \\mathcal{N}(0,1)$，$Y \\sim \\mathcal{N}(0,1)$。定义 $S=X+Y$。由于 $(X,Y)$ 是联合正态分布，且 $S$ 是 $(X,Y)$ 的线性函数，因此 $(X,S)$ 对也是联合正态分布。\n\n计算一阶矩和二阶矩：\n- $\\mathbb{E}[X]=0$, $\\mathbb{E}[S]=\\mathbb{E}[X+Y]=0$。\n- $\\operatorname{Var}(X)=1$, $\\operatorname{Var}(S)=\\operatorname{Var}(X)+\\operatorname{Var}(Y)=2$ (由独立性可知)。\n- $\\operatorname{Cov}(X,S)=\\operatorname{Cov}(X,X+Y)=\\operatorname{Var}(X)+\\operatorname{Cov}(X,Y)=1+0=1$ (由独立性可知)。\n\n对于联合正态变量，条件分布 $X \\mid S=s$ 是正态分布，其\n$$\n\\mathbb{E}[X \\mid S=s]=\\mathbb{E}[X]+\\frac{\\operatorname{Cov}(X,S)}{\\operatorname{Var}(S)}\\left(s-\\mathbb{E}[S]\\right)=0+\\frac{1}{2}s=\\frac{s}{2},\n$$\n和\n$$\n\\operatorname{Var}(X \\mid S)=\\operatorname{Var}(X)-\\frac{\\operatorname{Cov}(X,S)^{2}}{\\operatorname{Var}(S)}=1-\\frac{1^{2}}{2}=\\frac{1}{2}.\n$$\n\n因此，$X \\mid S=s \\sim \\mathcal{N}\\!\\left(\\frac{s}{2},\\frac{1}{2}\\right)$，这对应于选项B。", "answer": "$$\\boxed{B}$$", "id": "1906118"}]}