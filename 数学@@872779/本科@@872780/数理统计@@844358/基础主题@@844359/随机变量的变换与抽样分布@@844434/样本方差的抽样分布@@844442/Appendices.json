{"hands_on_practices": [{"introduction": "本练习提供了卡方分布的一个具体应用。在制造业等许多现实场景中，我们需要设定控制限来监控过程的变异性。此问题 [@problem_id:1953229] 展示了如何精确地运用样本方差的抽样分布来建立这类统计阈值，这是质量控制中的一项基本技能。", "problem": "一家制造厂生产高精度球形滚珠轴承。该生产过程被设计成使得滚珠轴承的直径呈正态分布，总体方差为 $\\sigma^2 = 0.0250$ 平方毫米 (mm$^2$)。为确保生产过程的一致性，质量控制团队会定期抽取一个轴承的随机样本并测量其直径。\n\n现抽取一个大小为 $n=20$ 的滚珠轴承样本。样本方差使用公式 $S^2 = \\frac{1}{n-1}\\sum_{i=1}^{n}(X_i - \\bar{X})^2$ 计算，其中 $X_i$ 是第 $i$ 个轴承的直径，$\\bar{X}$ 是样本的平均直径。\n\n该团队有一个协议，如果样本方差异常高，就会标记该过程以进行审查。确定样本方差的阈值 $k$，使得 $S^2$ 小于 $k$ 的概率为 90%。答案以 mm$^2$ 为单位，并四舍五入到三位有效数字。你可能需要使用卡方分布表，其中自由度为 19、右尾概率为 0.10 的相关值为 $\\chi^2_{0.10, 19} = 27.204$。", "solution": "给定一个方差为 $\\sigma^{2}$ 的正态分布总体，以及从此总体中抽取的大小为 $n$ 的样本，统计量\n$$\n\\frac{(n-1)S^{2}}{\\sigma^{2}} \\sim \\chi^{2}_{n-1}.\n$$\n我们寻求 $k$ 使得 $\\Pr(S^{2}  k) = 0.90$。利用变换的单调性，\n$$\n\\Pr\\!\\left(S^{2}  k\\right) = \\Pr\\!\\left(\\frac{(n-1)S^{2}}{\\sigma^{2}}  \\frac{(n-1)k}{\\sigma^{2}}\\right) = 0.90.\n$$\n设 $q$ 表示 $\\chi^{2}_{n-1}$ 的 $0.90$ 分位数。根据题目的约定，$\\chi^{2}_{0.10,19} = 27.204$ 是右尾概率为 $0.10$ 的点，所以\n$$\n\\Pr\\!\\left(\\chi^{2}_{19}  27.204\\right) = 0.90,\n$$\n因此，对于 $n-1=19$，有 $q = 27.204$。所以，\n$$\n\\frac{(n-1)k}{\\sigma^{2}} = 27.204 \\quad \\Longrightarrow \\quad k = \\frac{\\sigma^{2}\\cdot 27.204}{n-1}.\n$$\n代入 $\\sigma^{2} = 0.0250$ 和 $n-1 = 19$，\n$$\nk = \\frac{0.0250 \\times 27.204}{19} = \\frac{27.204}{760} \\approx 0.035794736842\\ \\text{mm}^{2}.\n$$\n四舍五入到三位有效数字，得到\n$$\nk \\approx 0.0358\\ \\text{mm}^{2}.\n$$", "answer": "$$\\boxed{0.0358}$$", "id": "1953229"}, {"introduction": "学习了如何进行概率计算后，一个自然的问题是：“估计总体方差的最佳方法是什么？”。此问题 [@problem_id:1953254] 通过比较两种不同$\\sigma^2$估计量的均方误差($\\text{MSE}$)，探讨了统计估计中的一个核心主题。它表明，“无偏”估计量在总误差方面未必总是“最佳”的，从而引入了偏差-方差权衡的关键概念。", "problem": "在统计估计中，估计量的质量通常使用其均方误差（MSE）来评价。考虑一个大小为 $n \\ge 2$ 的随机样本 $X_1, X_2, \\ldots, X_n$，它来自一个具有未知均值 $\\mu$ 和未知正方差 $\\sigma^2$ 的正态分布。\n\n总体方差 $\\sigma^2$ 的两个常用估计量是：\n1.  最大似然估计量（MLE），由 $\\hat{\\sigma}^2 = \\frac{1}{n} \\sum_{i=1}^{n} (X_i - \\bar{X})^2$ 给出，其中 $\\bar{X}$ 是样本均值。已知该估计量是有偏的。\n2.  无偏样本方差，由 $S^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (X_i - \\bar{X})^2$ 给出。\n\n参数 $\\theta$ 的估计量 $\\hat{\\theta}$ 的均方误差（MSE）定义为 $\\text{MSE}(\\hat{\\theta}) = \\text{E}[(\\hat{\\theta} - \\theta)^2]$。\n\n对于样本大小 $n$ 的哪些整数值，有偏最大似然估计量（MLE）的均方误差 $\\text{MSE}(\\hat{\\sigma}^2)$ 严格小于无偏估计量 $S^2$ 的均方误差 $\\text{MSE}(S^2)$？\n\nA. 对于所有 $n \\ge 2$\nB. 对 $n \\ge 2$ 的任何值都不成立\nC. 仅对于 $n=2$\nD. 仅对于 $n  21$\nE. 对于 $2 \\le n \\le 20$", "solution": "设 $X_{1},\\ldots,X_{n}$ 为独立同分布的 $\\mathcal{N}(\\mu,\\sigma^{2})$ 随机变量，且 $n \\ge 2$。定义无偏样本方差 $S^{2}=\\frac{1}{n-1}\\sum_{i=1}^{n}(X_{i}-\\bar{X})^{2}$ 和最大似然估计量（MLE）$\\hat{\\sigma}^{2}=\\frac{1}{n}\\sum_{i=1}^{n}(X_{i}-\\bar{X})^{2}$。它们满足关系式\n$$\n\\hat{\\sigma}^{2}=\\frac{n-1}{n}S^{2}.\n$$\n\n对于正态样本，一个标准结论是\n$$\n\\frac{(n-1)S^{2}}{\\sigma^{2}} \\sim \\chi^{2}_{n-1}.\n$$\n因此 $\\mathbb{E}[S^{2}]=\\sigma^{2}$，并且使用 $\\operatorname{Var}(\\chi^{2}_{\\nu})=2\\nu$，我们得到\n$$\n\\operatorname{Var}(S^{2})=\\frac{\\sigma^{4}}{(n-1)^{2}}\\operatorname{Var}\\!\\left(\\chi^{2}_{n-1}\\right)=\\frac{\\sigma^{4}}{(n-1)^{2}}\\cdot 2(n-1)=\\frac{2\\sigma^{4}}{n-1}.\n$$\n因此，无偏估计量的均方误差为\n$$\n\\operatorname{MSE}(S^{2})=\\operatorname{Var}(S^{2})=\\frac{2\\sigma^{4}}{n-1}.\n$$\n\n对于最大似然估计量（MLE），使用 $\\hat{\\sigma}^{2}=\\frac{n-1}{n}S^{2}$ 和上述分布，我们同样有\n$$\n\\frac{n\\hat{\\sigma}^{2}}{\\sigma^{2}}=\\frac{(n-1)S^{2}}{\\sigma^{2}} \\sim \\chi^{2}_{n-1}.\n$$\n因此\n$$\n\\mathbb{E}[\\hat{\\sigma}^{2}]=\\sigma^{2}\\cdot \\frac{n-1}{n}, \\quad \\operatorname{Bias}(\\hat{\\sigma}^{2})=\\mathbb{E}[\\hat{\\sigma}^{2}]-\\sigma^{2}=-\\frac{\\sigma^{2}}{n},\n$$\n并且\n$$\n\\operatorname{Var}(\\hat{\\sigma}^{2})=\\frac{\\sigma^{4}}{n^{2}}\\operatorname{Var}\\!\\left(\\chi^{2}_{n-1}\\right)=\\frac{\\sigma^{4}}{n^{2}}\\cdot 2(n-1)=\\frac{2\\sigma^{4}(n-1)}{n^{2}}.\n$$\n因此\n$$\n\\operatorname{MSE}(\\hat{\\sigma}^{2})=\\operatorname{Var}(\\hat{\\sigma}^{2})+\\operatorname{Bias}(\\hat{\\sigma}^{2})^{2}=\\frac{2\\sigma^{4}(n-1)}{n^{2}}+\\left(\\frac{\\sigma^{2}}{n}\\right)^{2}=\\sigma^{4}\\cdot \\frac{2n-1}{n^{2}}.\n$$\n\n为了比较均方误差，我们要求\n$$\n\\operatorname{MSE}(\\hat{\\sigma}^{2})  \\operatorname{MSE}(S^{2}) \\quad \\Longleftrightarrow \\quad \\frac{2n-1}{n^{2}}  \\frac{2}{n-1}.\n$$\n由于 $n \\ge 2$，分母为正；交叉相乘得到\n$$\n(2n-1)(n-1)  2n^{2} \\;\\Longleftrightarrow\\; 2n^{2}-3n+1  2n^{2} \\;\\Longleftrightarrow\\; -3n+1  0 \\;\\Longleftrightarrow\\; n > \\frac{1}{3}.\n$$\n这对于所有整数 $n \\ge 2$ 都成立。因此，对于所有 $n \\ge 2$，$\\operatorname{MSE}(\\hat{\\sigma}^{2})$ 严格小于 $\\operatorname{MSE}(S^{2})$。", "answer": "$$\\boxed{A}$$", "id": "1953254"}, {"introduction": "理论分布固然强大，但现代统计学在很大程度上依赖于模拟来理解复杂过程和验证理论结果。此练习 [@problem_id:1953257] 通过要求您设计一个算法来模拟$S^2$的抽样分布，从而将理论与实践联系起来。这不仅能体现您对样本方差与卡方分布之间关键关系的深刻理解，也是计算统计学的一项基础技能。", "problem": "一位质量控制工程师正在进行统计模拟，以研究一个制造过程的变异性。该过程生产的滚珠轴承的直径已知服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布。工程师计划模拟采集一个大小为 $n$ 的滚珠轴承随机样本，并计算样本方差，其定义为 $S^2 = \\frac{1}{n-1}\\sum_{i=1}^n (X_i - \\bar{X})^2$，其中 $\\bar{X}$ 是样本均值。\n\n为了高效地进行模拟，工程师将使用一个统计软件库，该库提供了一个函数 `chi2.rand(df)`，它返回一个服从自由度为 `df` 的卡方分布的随机变量。目标是设计一个算法，通过直接使用 `chi2.rand(df)` 函数来生成样本方差的一个模拟值，记为 $s^2$。\n\n以下哪个算法正确描述了如何从 $S^2$ 的抽样分布中生成一个这样的值 $s^2$？\n\nA. 使用 `y = chi2.rand(n-1)` 生成一个随机值 $y$。计算模拟样本方差为 $s^2 = \\frac{\\sigma^2 y}{n-1}$。\nB. 使用 `y = chi2.rand(n)` 生成一个随机值 $y$。计算模拟样本方差为 $s^2 = \\frac{\\sigma^2 y}{n}$。\nC. 从标准正态分布 $N(0, 1)$ 中生成 $n$ 个随机值 $x_1, \\dots, x_n$。计算模拟值为 $s^2 = \\sum_{i=1}^n x_i^2$。\nD. 使用 `y = chi2.rand(n-1)` 生成一个随机值 $y$。计算模拟样本方差为 $s^2 = \\frac{\\sigma^2 y}{n}$。\nE. 使用 `y = chi2.rand(n)` 生成一个随机值 $y$。计算模拟样本方差为 $s^2 = \\frac{(n-1) y}{\\sigma^2}$。", "solution": "设 $X_{1},\\dots,X_{n}$ 独立同分布于 $N(\\mu,\\sigma^{2})$。样本方差为\n$$\nS^{2}=\\frac{1}{n-1}\\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}\\right)^{2},\n$$\n其中 $\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$。\n\n通过定义 $Z_{i}=\\frac{X_{i}-\\mu}{\\sigma}$（$i=1,\\dots,n$）进行标准化。那么 $Z_{i}\\sim N(0,1)$ 独立同分布，标准化变量的样本均值为 $\\bar{Z}=\\frac{\\bar{X}-\\mu}{\\sigma}$。使用恒等式\n$$\n\\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}\\right)^{2}=\\sigma^{2}\\sum_{i=1}^{n}\\left(Z_{i}-\\bar{Z}\\right)^{2},\n$$\n我们可以将样本方差重写为\n$$\nS^{2}=\\frac{\\sigma^{2}}{n-1}\\sum_{i=1}^{n}\\left(Z_{i}-\\bar{Z}\\right)^{2}.\n$$\n根据 Cochran 定理（或正态样本的标准结果），二次型\n$$\n\\sum_{i=1}^{n}\\left(Z_{i}-\\bar{Z}\\right)^{2}\n$$\n服从自由度为 $n-1$ 的卡方分布，即\n$$\n\\frac{(n-1)S^{2}}{\\sigma^{2}}\\sim \\chi^{2}_{n-1}.\n$$\n等价地，如果 $Y\\sim \\chi^{2}_{n-1}$，则\n$$\nS^{2}=\\frac{\\sigma^{2}}{n-1}Y.\n$$\n因此，要从 $S^{2}$ 的抽样分布中模拟一次抽样 $s^{2}$，我们生成 $y=\\texttt{chi2.rand}(n-1)$ 并设置\n$$\ns^{2}=\\frac{\\sigma^{2}y}{n-1}.\n$$\n这正是选项 A。其他选项要么使用了错误的自由度，要么使用了错误的缩放比例，要么没有生成以样本均值为中心的样本方差分布（这会使自由度减少一）。", "answer": "$$\\boxed{A}$$", "id": "1953257"}]}