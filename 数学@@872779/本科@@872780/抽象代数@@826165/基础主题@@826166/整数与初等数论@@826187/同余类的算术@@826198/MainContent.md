## 引言
[同余](@entry_id:143700)算术是数论和[抽象代数](@entry_id:145216)的核心，它将无限的整数世界提炼到有限的、具有周期性结构的系统中，为解决从纯数学到应用科学的众多问题提供了强大的工具。通过引入“[模n同余](@entry_id:152282)”这一等价关系，我们将[整数划分](@entry_id:139302)为不同的[同余类](@entry_id:635978)，并在此基础上构建起一个全新的[代数结构](@entry_id:137052)——[同余类](@entry_id:635978)环 $\mathbb{Z}_n$。这个看似简单的转变，实际上解决了如何在[有限集](@entry_id:145527)合上进行一致且有意义的算术运算这一根本问题，其规则既熟悉又充满新奇。

本文将系统地引导您深入[同余](@entry_id:143700)算术的世界。在“原理与机制”一章中，我们将奠定理论基石，详细剖析 $\mathbb{Z}_n$ 环的构造、运算的良定性，以及单位、[零因子](@entry_id:151051)等关键代数性质，并推导[欧拉定理](@entry_id:138104)等核心结论。接下来的“应用与跨学科联系”一章将展示这些抽象理论如何转化为解决实际问题的利器，其应用横跨数论、密码学、计算机科学等多个领域。最后，通过“动手实践”环节，您将有机会亲手解决具体问题，从而巩固所学知识，真正掌握[同余](@entry_id:143700)算术的精髓。

## 原理与机制

继前一章介绍同余的基本概念之后，本章将深入探讨同余算术的核心原理与[代数结构](@entry_id:137052)。我们将构建[同余类](@entry_id:635978)（congruence classes）的算术体系，研究其内部的独特属性，并揭示其在数论和[抽象代数](@entry_id:145216)中的深刻联系。我们将看到，整数的普通算术规则在[同余](@entry_id:143700)的世界里如何被修正和推广，从而产生既优美又强大的新工具。

### [同余类](@entry_id:635978)环 $\mathbb{Z}_n$

我们从整数集 $\mathbb{Z}$ 出发。对于一个正整数 $n$，如果两个整数 $a$ 和 $b$ 之差 $a-b$ 是 $n$ 的倍数，我们就称 $a$ 与 $b$ **模 $n$ [同余](@entry_id:143700)**（congruent modulo $n$），记作 $a \equiv b \pmod{n}$。这种[同余关系](@entry_id:272002)是一种[等价关系](@entry_id:138275)，它将整数集 $\mathbb{Z}$ 分割成 $n$ 个互不相交的[子集](@entry_id:261956)，每一个[子集](@entry_id:261956)被称为一个**[同余类](@entry_id:635978)**（congruence class）。

对于任意整数 $a$，其模 $n$ 的[同余类](@entry_id:635978)是所有与 $a$ 模 $n$ [同余](@entry_id:143700)的整数构成的集合，记作 $[a]_n$ 或简写为 $[a]$。形式上，
$$ [a]_n = \{ x \in \mathbb{Z} \mid x \equiv a \pmod{n} \} = \{ a + kn \mid k \in \mathbb{Z} \} $$
集合中任何一个元素都可以作为这个[同余类](@entry_id:635978)的**代表元**（representative）。例如，在模 $5$ 的意义下，$[2]_5 = \{..., -8, -3, 2, 7, 12, ...\}$，$2$ 和 $7$ 都是这个类的代表元，因此 $[2]_5 = [7]_5$。

所有模 $n$ 的[同余类](@entry_id:635978)构成的集合记为 $\mathbb{Z}_n$。这个集合恰好有 $n$ 个元素，通常用最小非负余数作为代表元来表示：
$$ \mathbb{Z}_n = \{[0]_n, [1]_n, [2]_n, \dots, [n-1]_n\} $$
我们可以在 $\mathbb{Z}_n$ 上定义加法和乘法运算，使其成为一个**环**（ring）。对于任意两个[同余类](@entry_id:635978) $[a]_n$ 和 $[b]_n$，我们定义：

- **加法**: $[a]_n + [b]_n = [a+b]_n$
- **乘法**: $[a]_n \cdot [b]_n = [ab]_n$

也就是说，两个[同余类](@entry_id:635978)的和（或积）是其代表元之和（或积）所在的[同余类](@entry_id:635978)。

### 良定性：模运算的基石

一个初学者可能会立即质疑：这些运算的定义依赖于代表元的选择。如果我选择 $[a]_n$ 的另一个代表元 $a'$ 和 $[b]_n$ 的另一个代表元 $b'$，运算结果会是同一个[同余类](@entry_id:635978)吗？如果结果依赖于代表元的选择，那么这样的运算就是无意义的。因此，我们必须验证这些运算是**良定的**（well-defined）。

一个运算是良定的，意味着无论我们为输入选择哪个合法的代表元，输出结果总是落在同一个[同余类](@entry_id:635978)中。让我们来证明这一点。
假设 $[a]_n = [a']_n$ 和 $[b]_n = [b']_n$。根据定义，存在整数 $k$ 和 $l$ 使得 $a' = a + kn$ 以及 $b' = b + ln$。

对于加法：
$$ a' + b' = (a+kn) + (b+ln) = (a+b) + (k+l)n $$
由于 $k+l$ 是整数，这表明 $a' + b' \equiv a+b \pmod{n}$。因此，$[a'+b']_n = [a+b]_n$，加法是良定的。

对于乘法：
$$ a'b' = (a+kn)(b+ln) = ab + aln + bkn + kln^2 = ab + (al+bk+kln)n $$
由于 $al+bk+kln$ 是整数，这表明 $a'b' \equiv ab \pmod{n}$。因此，$[a'b']_n = [ab]_n$，乘法也是良定的。

良定性是同余算术的基石，它允许我们在处理复杂的计算时，用更小的、计算上更方便的代表元（通常是余数）来替代庞大的数字。例如，要计算 $1234567 \times 7654321$ 除以 $99$ 的余数，我们不必执行这个巨大的乘法。利用乘法运算的良定性，我们可以先分别计算每个因子模 $99$ 的余数，再将余数相乘。[@problem_id:1829603]
令 $a = 1234567$，$b = 7654321$，$n=99$。我们有 $100 \equiv 1 \pmod{99}$。
$$ a = 1 \cdot 100^3 + 23 \cdot 100^2 + 45 \cdot 100 + 67 \equiv 1 \cdot 1^3 + 23 \cdot 1^2 + 45 \cdot 1 + 67 \equiv 136 \equiv 37 \pmod{99} $$
$$ b = 7 \cdot 100^3 + 65 \cdot 100^2 + 43 \cdot 100 + 21 \equiv 7 \cdot 1^3 + 65 \cdot 1^2 + 43 \cdot 1 + 21 \equiv 136 \equiv 37 \pmod{99} $$
因此，$[a]_{99} = [37]_{99}$ 且 $[b]_{99} = [37]_{99}$。根据乘法的良定性：
$$ [ab]_{99} = [a]_{99} \cdot [b]_{99} = [37]_{99} \cdot [37]_{99} = [37^2]_{99} = [1369]_{99} $$
因为 $1369 = 13 \times 99 + 82$，所以 $[1369]_{99} = [82]_{99}$。原始大数之积除以 $99$ 的余数是 $82$。

并非所有在[同余类](@entry_id:635978)上看似合理的运算都是良定的。通过研究一个反例，我们可以更深刻地理解良定性的重要性。[@problem_id:1784011] 考虑一个在 $\mathbb{Z}_n$ 上提出的新运算 $\odot$：$[a]_n \odot [b]_n = [r_k(a)]_n$，其中 $k$ 是 $[b]_n$ 中最小的正整数代表元，$r_k(a)$ 是 $a$ 除以 $k$ 的余数。这个运算是良定的吗？要成为良定运算，其结果必须独立于[同余类](@entry_id:635978)中代表元的选择。然而，这个新运算通常不满足此条件。
例如，在 $\mathbb{Z}_3$ 中，考虑 $[b]_3 = [2]_3$。最小正代表元是 $k=2$。但 $2$ 不能整除 $3$。让我们看看这如何导致问题：取 $[a]_3 = [1]_3$。我们可以选择代表元 $a=1$ 或 $a'=4$。
- 使用 $a=1$: $[1]_3 \odot [2]_3 = [r_2(1)]_3 = [1]_3$
- 使用 $a'=4$: $[4]_3 \odot [2]_3 = [r_2(4)]_3 = [0]_3$
由于 $[1]_3 \neq [0]_3$，运算结果取决于代表元的选择，因此 $\odot$ 在 $\mathbb{Z}_3$ 上不是良定的。

### $\mathbb{Z}_n$的[代数结构](@entry_id:137052)：单位、零因子和[整环](@entry_id:155321)

$\mathbb{Z}_n$ 的算术行为与我们熟悉的整数算术既有相似之处，也有显著差异。其中最显著的差异在于乘法。在整数中，$ab=0$ 意味着 $a=0$ 或 $b=0$。但在 $\mathbb{Z}_n$ 中，这并不总是成立。

一个非零的[同余类](@entry_id:635978) $[a]_n \neq [0]_n$，如果存在另一个非零[同余类](@entry_id:635978) $[b]_n \neq [0]_n$ 使得 $[a]_n \cdot [b]_n = [0]_n$，那么 $[a]_n$ 就被称为一个**[零因子](@entry_id:151051)**（zero divisor）。
例如，在 $\mathbb{Z}_6$ 中，$ [2]_6 \neq [0]_6$ 且 $[3]_6 \neq [0]_6$，但 $[2]_6 \cdot [3]_6 = [6]_6 = [0]_6$。因此，$[2]_6$ 和 $[3]_6$ 都是 $\mathbb{Z}_6$ 中的[零因子](@entry_id:151051)。

$\mathbb{Z}_n$ 是否拥有[零因子](@entry_id:151051)，完全取决于 $n$ 的性质。[@problem_id:1777442]
- 如果 $n$ 是一个合数，即 $n = rs$，$1 \lt r, s \lt n$，那么在 $\mathbb{Z}_n$ 中，$[r]_n \neq [0]_n$ 且 $[s]_n \neq [0]_n$，但它们的乘积 $[r]_n[s]_n = [rs]_n = [n]_n = [0]_n$。因此，**当 $n$ 是合数时，$\mathbb{Z}_n$ 总有[零因子](@entry_id:151051)**。
- 如果 $n$ 是一个素数 $p$，假设 $[a]_p[b]_p = [0]_p$，即 $ab \equiv 0 \pmod{p}$。根据[欧几里得引理](@entry_id:261512)，如果一个素数 $p$ 整除乘积 $ab$，那么 $p$ 必然整除 $a$ 或 $p$ 整除 $b$。这意味着 $a \equiv 0 \pmod{p}$ 或 $b \equiv 0 \pmod{p}$，即 $[a]_p = [0]_p$ 或 $[b]_p = [0]_p$。因此，**当 $n$ 是素数时，$\mathbb{Z}_n$ 没有零因子**。

一个没有零因子的[交换环](@entry_id:148261)被称为**整环**（integral domain）。所以，$\mathbb{Z}_n$ 是一个[整环](@entry_id:155321)当且仅当 $n$ 是一个素数。

[零因子](@entry_id:151051)的存在直接影响了代数运算中的**消去律**（cancellation law）。在整数中，若 $a \neq 0$ 且 $ax=ay$，则可以消去 $a$ 得到 $x=y$。在 $\mathbb{Z}_n$ 中，对于一个[同余类](@entry_id:635978) $[a]_n$，消去律成立是指若 $[a]_n[x]_n = [a]_n[y]_n$ 则必有 $[x]_n = [y]_n$。
这个定律的有效性与 $[a]_n$ 是否为零因子密切相关。如果 $[a]_n$ 是一个[零因子](@entry_id:151051)，那么存在 $[b]_n \neq [0]_n$ 使得 $[a]_n[b]_n = [0]_n$。我们可以写成 $[a]_n[b]_n = [a]_n[0]_n$。如果消去律成立，则可以得到 $[b]_n = [0]_n$，这与假设矛盾。因此，**消去律对零因子不成立**。反之，如果 $[a]_n$ 不是[零因子](@entry_id:151051)，则消去律成立。
所以，在一个环 $\mathbb{Z}_n$ 中，寻找消去律失效的元素等价于寻找所有的非零零因子。[@problem_id:1777386]

与[零因子](@entry_id:151051)相对的概念是**单位**（unit）。在 $\mathbb{Z}_n$ 中，一个[同余类](@entry_id:635978) $[a]_n$ 如果存在一个[同余类](@entry_id:635978) $[d]_n$ 使得 $[a]_n[d]_n = [1]_n$，则称 $[a]_n$ 是一个单位，$[d]_n$ 是 $[a]_n$ 的**乘法[逆元](@entry_id:140790)**（multiplicative inverse）。
一个元素 $[a]_n$ 是单位当且仅当 $\gcd(a, n)=1$。
- **(必要性)** 如果 $[a]_n$ 是单位，则存在 $d$ 使得 $ad \equiv 1 \pmod{n}$。这意味着 $ad - 1 = nk$ 对某个整数 $k$ 成立，即 $ad - nk = 1$。根据裴蜀定理，这说明 $\gcd(a, n)$ 必须整除 $1$，所以 $\gcd(a, n)=1$。
- **(充分性)** 如果 $\gcd(a, n)=1$，根据[扩展欧几里得算法](@entry_id:153449)，存在整数 $x, y$ 使得 $ax + ny = 1$。模 $n$ 处理该式，得到 $ax \equiv 1 \pmod{n}$。这意味着 $[x]_n$ 就是 $[a]_n$ 的乘法[逆元](@entry_id:140790)。

因此，在 $\mathbb{Z}_n$ 中，任何一个非零元素要么是单位，要么是[零因子](@entry_id:151051)。

寻找乘法[逆元](@entry_id:140790)是同余算术中的一项基本计算，在[密码学](@entry_id:139166)等领域有重要应用。例如，在一个简单的加密方案中，加密是 $c \equiv km \pmod n$，解密则需要找到 $k$ 的逆元 $d$，使得 $m \equiv dc \pmod n$。[@problem_id:1777432]
要找到 $18$ 在模 $47$ 下的[逆元](@entry_id:140790)，我们需要求解 $18d \equiv 1 \pmod{47}$。由于 $47$是素数，$\gcd(18, 47)=1$ 必然成立，[逆元](@entry_id:140790)存在。我们使用**[扩展欧几里得算法](@entry_id:153449)**：
$$ 47 = 2 \cdot 18 + 11 $$
$$ 18 = 1 \cdot 11 + 7 $$
$$ 11 = 1 \cdot 7 + 4 $$
$$ 7 = 1 \cdot 4 + 3 $$
$$ 4 = 1 \cdot 3 + 1 $$
现在，我们[反向代入](@entry_id:168868)，将 $1$ 表示为 $18$ 和 $47$ 的线性组合：
$$ 1 = 4 - 1 \cdot 3 $$
$$ 1 = 4 - (7-1 \cdot 4) = 2 \cdot 4 - 7 $$
$$ 1 = 2 \cdot (11-1 \cdot 7) - 7 = 2 \cdot 11 - 3 \cdot 7 $$
$$ 1 = 2 \cdot 11 - 3 \cdot (18-1 \cdot 11) = 5 \cdot 11 - 3 \cdot 18 $$
$$ 1 = 5 \cdot (47 - 2 \cdot 18) - 3 \cdot 18 = 5 \cdot 47 - 10 \cdot 18 - 3 \cdot 18 = 5 \cdot 47 - 13 \cdot 18 $$
我们得到 $ -13 \cdot 18 + 5 \cdot 47 = 1$。模 $47$ 处理，$-13 \cdot 18 \equiv 1 \pmod{47}$。
因此，逆元是 $[-13]_{47}$。在 $\{0, 1, \dots, 46\}$ 中，代表元是 $-13+47=34$。所以 $d=34$。

### 单位群与[欧拉定理](@entry_id:138104)

所有在 $\mathbb{Z}_n$ 中的单位构成一个集合，记为 $(\mathbb{Z}/n\mathbb{Z})^\times$ 或 $U_n$。这个集合在模 $n$ 乘法下构成一个**群**（group），称为**[单位群](@entry_id:184012)**（group of units）。
$$ U_n = \{[a]_n \in \mathbb{Z}_n \mid \gcd(a, n) = 1 \} $$
这个群的阶（元素的个数）由**[欧拉φ函数](@entry_id:142816)**（Euler's totient function）$\phi(n)$ 给出。$\phi(n)$ 定义为小于等于 $n$ 且与 $n$ [互素](@entry_id:143119)的正整数的个数。

根据群论中的拉格朗日定理，群中任意[元素的阶](@entry_id:145276)必然整除[群的阶](@entry_id:137115)。对于单位群 $U_n$，这意味着对于任意 $[a]_n \in U_n$，有 $[a]_n^{\phi(n)} = [1]_n$。这就引出了数论中一个极为重要的定理：

**[欧拉定理](@entry_id:138104)**: 若 $\gcd(a, n)=1$，则 $a^{\phi(n)} \equiv 1 \pmod{n}$。

当 $n$ 是素数 $p$ 时，所有小于 $p$ 的正整数都与 $p$ [互素](@entry_id:143119)，所以 $\phi(p) = p-1$。此时[欧拉定理](@entry_id:138104)变为：

**[费马小定理](@entry_id:144391)**: 若 $p$ 是素数且 $p \nmid a$，则 $a^{p-1} \equiv 1 \pmod{p}$。

[欧拉定理](@entry_id:138104)是计算模 $n$ 大幂次的强大工具。要计算 $a^k \pmod n$（其中 $\gcd(a,n)=1$），我们可以先将指数 $k$ 对 $\phi(n)$ 取模。即如果 $k \equiv r \pmod{\phi(n)}$，则 $k = q\phi(n)+r$，那么：
$$ a^k = a^{q\phi(n)+r} = (a^{\phi(n)})^q \cdot a^r \equiv 1^q \cdot a^r \equiv a^r \pmod{n} $$
例如，要计算 $17^{123} \pmod{60}$。[@problem_id:1777444] 首先，$\gcd(17, 60)=1$。我们需要计算 $\phi(60)$。
$$ \phi(60) = \phi(2^2 \cdot 3 \cdot 5) = 60 \left(1-\frac{1}{2}\right) \left(1-\frac{1}{3}\right) \left(1-\frac{1}{5}\right) = 60 \cdot \frac{1}{2} \cdot \frac{2}{3} \cdot \frac{4}{5} = 16 $$
根据[欧拉定理](@entry_id:138104)，$17^{16} \equiv 1 \pmod{60}$。现在我们简化指数 $123$：$123 = 7 \cdot 16 + 11$。
$$ 17^{123} \equiv 17^{11} \pmod{60} $$
为了计算 $17^{11}$，我们可以使用[平方求幂](@entry_id:637066)法：
$17^2 = 289 \equiv 49 \equiv -11 \pmod{60}$
$17^4 \equiv (-11)^2 = 121 \equiv 1 \pmod{60}$
$17^8 \equiv 1^2 = 1 \pmod{60}$
$17^{11} = 17^8 \cdot 17^2 \cdot 17^1 \equiv 1 \cdot 49 \cdot 17 = 833 \pmod{60}$。
由于 $833 = 13 \cdot 60 + 53$，所以 $17^{123} \equiv 53 \pmod{60}$。

单位群 $U_n$ 的结构本身也值得研究。它不总是循环群。例如，我们来考察 $U_{12}$。[@problem_id:1777417]
与 $12$ [互素](@entry_id:143119)且小于 $12$ 的数是 $1, 5, 7, 11$。所以 $U_{12} = \{[1], [5], [7], [11]\}$。这是一个 $4$ 阶群。
我们检查非单位[元素的阶](@entry_id:145276)：
$5^2 = 25 \equiv 1 \pmod{12}$
$7^2 = 49 \equiv 1 \pmod{12}$
$11^2 = (-1)^2 = 1 \pmod{12}$
所有非单位[元素的阶](@entry_id:145276)都是 $2$。一个 $4$ 阶群如果有一个 $4$ 阶元素，它就是循环群 $\mathbb{Z}_4$。但 $U_{12}$ 没有 $4$ 阶元素，它的所有非单位元[素阶](@entry_id:141580)都为 $2$。这种结构的群是**[克莱因四元群](@entry_id:138263)**（Klein four-group），同构于 $\mathbb{Z}_2 \times \mathbb{Z}_2$。

### 同态、理想与[同余方程组](@entry_id:154048)

[同余类](@entry_id:635978)的概念可以用更抽象的代数语言——[环同态](@entry_id:153804)来表述。
一个从环 $R$到环 $S$的**[环同态](@entry_id:153804)**（ring homomorphism）是一个函数 $\psi: R \to S$，它保持环的加法和乘法结构，即对于所有 $r_1, r_2 \in R$：
$$ \psi(r_1+r_2) = \psi(r_1) + \psi(r_2) \quad \text{and} \quad \psi(r_1r_2) = \psi(r_1)\psi(r_2) $$
从[整数环](@entry_id:181003) $\mathbb{Z}$ 到[同余类](@entry_id:635978)环 $\mathbb{Z}_n$ 的**自然映射**（natural map）$\psi: \mathbb{Z} \to \mathbb{Z}_n$ 定义为 $\psi(a) = [a]_n$ 是一个[环同态](@entry_id:153804)。这是一个满同态（surjective homomorphism）。

[同态的核](@entry_id:145895)心概念之一是**核**（kernel），它被定义为所有被映射到接收环的加法单位元的元素的集合。对于自然映射 $\psi: \mathbb{Z} \to \mathbb{Z}_{24}$，其核是所有满足 $\psi(n) = [0]_{24}$ 的整数 $n$。[@problem_id:1777413]
$$ \psi(n) = [0]_{24} \iff [n]_{24} = [0]_{24} \iff n \equiv 0 \pmod{24} $$
这意味着 $n$ 必须是 $24$ 的倍数。因此，核是集合 $\{ n \in \mathbb{Z} \mid n = 24k \text{ for some integer } k \}$，这正是由 $24$ 生成的理想 $24\mathbb{Z}$。这是[环论](@entry_id:143825)中的一个基本结果：任何[环同态的核](@entry_id:156318)都是定义域环的一个理想。

我们也可以考虑不同[同余类](@entry_id:635978)环之间的同态，例如 $\phi: \mathbb{Z}_{30} \to \mathbb{Z}_6$。[@problem_id:1777445] 形如 $\phi([x]_{30}) = [ax]_6$ 的映射，其性质取决于系数 $a$。
1.  **良定性**：要求如果 $[x]_{30} = [y]_{30}$，则 $[ax]_6 = [ay]_6$。$x \equiv y \pmod{30}$ 意味着 $x-y=30k$。我们需要 $a(x-y)=30ak$ 是 $6$ 的倍数。由于 $30$ 是 $6$ 的倍数，这对于任何整数 $a$ 都成立。
2.  **同态性质**：加法性质 $\phi([x+y])=\phi([x])+\phi([y])$ 对所有 $a$ 都成立。乘法性质 $\phi([xy])=\phi([x])\phi([y])$ 要求 $[axy]_6 = [a^2xy]_6$ 对所有 $x, y$ 成立。这简化为 $a \equiv a^2 \pmod 6$。满足此条件的 $a \in \{0, 1, 2, 3, 4, 5\}$ 有 $0, 1, 3, 4$。
3.  **非平凡性**：如果一个同态将所有元素都映到零，则称其为平凡同态。当 $a=0$ 时，$\phi$ 是平凡的。对于 $a \in \{1, 3, 4\}$，$\phi$ 是非平凡的。

[同余](@entry_id:143700)的概念也自然地引向求解**线性[同余[方程](@entry_id:154048)组](@entry_id:193238)**。一个著名结果是**中国剩余定理**（Chinese Remainder Theorem），它指出如果模数 $n_1, n_2, \dots, n_k$ [两两互素](@entry_id:154147)，则[方程组](@entry_id:193238) $x \equiv a_i \pmod{n_i}$ 总有解，且解在模 $N=n_1n_2\cdots n_k$ 的意义下是唯一的。

当模数不互素时情况如何？考虑[方程组](@entry_id:193238)：[@problem_id:1777426]
$$ \begin{cases} x \equiv a \pmod{10} \\ x \equiv b \pmod{14} \end{cases} $$
第一个方程说明 $x = a + 10k$。代入第二个方程：
$$ a + 10k \equiv b \pmod{14} \implies 10k \equiv b-a \pmod{14} $$
这是一个形如 $rx \equiv c \pmod m$ 的[线性同余](@entry_id:150485)方程。它有解的充要条件是 $\gcd(r, m)$ 整除 $c$。在这里，$r=10, m=14, c=b-a$。因为 $\gcd(10, 14)=2$，所以方程有解的充要条件是 $2 \mid (b-a)$，即 $a \equiv b \pmod 2$。
这个结论可以推广：[方程组](@entry_id:193238) $x \equiv a_1 \pmod{n_1}, x \equiv a_2 \pmod{n_2}$ 有解的充要条件是 $a_1 \equiv a_2 \pmod{\gcd(n_1, n_2)}$。

### 素数模的特殊性质

当模数 $n$ 是一个素数 $p$ 时，环 $\mathbb{Z}_p$ 具有特别良好的性质。我们已经知道它是一个[整环](@entry_id:155321)。更进一步，由于每个非零元素 $[a]_p$ 都满足 $\gcd(a,p)=1$，因此每个非零元素都是单位。一个所有非零元素都有乘法[逆元](@entry_id:140790)的[交换环](@entry_id:148261)被称为**域**（field）。因此，$\mathbb{Z}_p$ 是一个[有限域](@entry_id:142106)。

域的结构非常优美，许多在普通[数域](@entry_id:155558)（如 $\mathbb{Q}$ 或 $\mathbb{R}$）中成立的规则在 $\mathbb{Z}_p$ 中也成立。除了[费马小定理](@entry_id:144391)外，还有一个关于素数模的深刻结果：

**[威尔逊定理](@entry_id:269227)**: 一个整数 $p \gt 1$ 是素数当且仅当 $(p-1)! \equiv -1 \pmod{p}$。

这个定理提供了一种理论上的[素性检验](@entry_id:154017)方法，并且在模 $p$ 的计算中非常有用，尤其是处理[阶乘](@entry_id:266637)时。例如，我们可以用它来化简 $(p-3)! \pmod p$。[@problem_id:1777436]
根据[威尔逊定理](@entry_id:269227)，$(p-1)! \equiv -1 \pmod p$。我们展开[阶乘](@entry_id:266637)：
$$ (p-1)! = (p-1)(p-2)(p-3)! \equiv (-1)(-2)(p-3)! = 2(p-3)! \pmod{p} $$
于是我们有 $2(p-3)! \equiv -1 \pmod p$。为了分离出 $(p-3)!$，我们需要乘以 $2$ 在模 $p$ 下的逆元。
在一个具体的例子中，比如 $p=101$，我们需要计算 $K \equiv 3^{98} \cdot (98)! \pmod{101}$。
首先处理 $(98)! \pmod{101}$。根据上面的推导，$2 \cdot (98)! \equiv -1 \pmod{101}$。$2$ 的[逆元](@entry_id:140790)是 $51$ (因为 $2 \cdot 51 = 102 \equiv 1$)。所以 $(98)! \equiv -1 \cdot 51 \equiv -51 \equiv 50 \pmod{101}$。
接下来处理 $3^{98} \pmod{101}$。根据[费马小定理](@entry_id:144391)，$3^{100} \equiv 1 \pmod{101}$。
$$ 3^{98} = 3^{100} \cdot 3^{-2} \equiv 1 \cdot (3^2)^{-1} = 9^{-1} \pmod{101} $$
使用[扩展欧几里得算法](@entry_id:153449)可得 $9^{-1} \equiv 45 \pmod{101}$。
最后，将两部分合在一起：
$$ K \equiv 45 \cdot 50 = 2250 \pmod{101} $$
由于 $2250 = 22 \cdot 101 + 28$，我们得到 $K \equiv 28 \pmod{101}$。这个例子完美地展示了如何综合运用[同余](@entry_id:143700)算术中的多个核心定理来解决复杂问题。