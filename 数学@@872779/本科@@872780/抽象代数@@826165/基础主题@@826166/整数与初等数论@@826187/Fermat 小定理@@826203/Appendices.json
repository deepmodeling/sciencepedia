{"hands_on_practices": [{"introduction": "理论的生命力在于实践。掌握了费马小定理的理论基础后，下一步就是通过动手计算来巩固理解。这个练习旨在帮助你熟练掌握费马小定理的核心计算技巧：处理大指数的模幂运算，这是数论和现代密码学中的一项基本功。[@problem_id:1369615]", "problem": "在一个简化的公钥密码系统模型中，一个大整数消息 $M$ 被转换为一个加密值 $C$。该转换由运算 $C = M^k \\pmod{p}$ 定义，其中 $p$ 是一个大素数，$k$ 是一个称为公钥的整数指数。\n\n你的任务是为一组特定参数计算加密值 $C$。给定素数模数 $p = 41$，消息 $M = 1234$，以及公钥指数 $k = 123$，请确定 $C$ 的值。$C$ 的值必须是一个介于 0 和 40 之间（含两端）的整数。", "solution": "我们需要计算 $C \\equiv M^{k} \\pmod{p}$，其中 $p=41$，$M=1234$，$k=123$。\n\n首先，对底数取模 $p$：\n$$\n1234 = 41 \\cdot 30 + 4 \\quad \\Rightarrow \\quad 1234 \\equiv 4 \\pmod{41}.\n$$\n因此，\n$$\nC \\equiv 1234^{123} \\equiv 4^{123} \\pmod{41}.\n$$\n\n由于 $p=41$ 是素数且 $\\gcd(4,41)=1$，根据费马小定理，\n$$\n4^{40} \\equiv 1 \\pmod{41}.\n$$\n将指数写为\n$$\n123 = 3 \\cdot 40 + 3,\n$$\n所以\n$$\n4^{123} = 4^{3 \\cdot 40 + 3} = \\left(4^{40}\\right)^{3} \\cdot 4^{3} \\equiv 1^{3} \\cdot 4^{3} \\equiv 4^{3} \\pmod{41}.\n$$\n计算 $4^{3}$ 并对 41 取模：\n$$\n4^{3} = 64 \\equiv 64 - 41 = 23 \\pmod{41}.\n$$\n因此，加密值为\n$$\nC \\equiv 23 \\pmod{41},\n$$\n该值在要求的 0 到 40 的范围内。", "answer": "$$\\boxed{23}$$", "id": "1369615"}, {"introduction": "在掌握了基本计算之后，让我们将费马小定理应用于逻辑推理。费马小定理不仅能简化计算，还能提供一个强大的工具来判断一个数是否为合数。这个练习将引导你运用该定理的逆否命题来证明一个数 *不是* 素数，这是数论和计算机科学中一个重要的思想，构成了费马素性检验的基础。[@problem_id:1369643]", "problem": "在一堂离散数学课上，一位名叫Alex的学生提出了一个检验数字是否为质数的简单方法。Alex的猜想基于质数的一个已知性质：“对于任意质数$p$和任意$p$不能整除的整数$a$，计算$a^{p-1}$除以$p$将总是得到余数1。”\n\n另一位学生Ben对此很感兴趣，并决定以$a = 3$为底，对数字$n = 35$检验这个猜想。根据Alex的猜想，如果35是质数，那么$3^{35-1} \\pmod{35}$的值将为1。如果余数不为1，Ben就可以肯定地得出结论，35不是一个质数。\n\n你的任务是执行Ben的计算。求$3^{34} \\pmod{35}$的值。你的答案应该是一个整数。", "solution": "我们对模数进行因数分解，并应用中国剩余定理。由于$35=5\\cdot 7$且$\\gcd(5,7)=1$，我们只需计算$3^{34}$模$5$和模$7$的值，然后合并结果。\n\n首先，计算模$5$：\n$$3 \\equiv -2 \\pmod{5}, \\quad 3^{2} \\equiv (-2)^{2}=4 \\equiv -1 \\pmod{5}.$$\n因此\n$$3^{4} \\equiv (3^{2})^{2} \\equiv (-1)^{2}=1 \\pmod{5}.$$\n将34写作$34=4\\cdot 8+2$，则\n$$3^{34} \\equiv (3^{4})^{8}\\cdot 3^{2} \\equiv 1^{8}\\cdot 9 \\equiv 4 \\pmod{5}.$$\n\n接下来，计算模$7$：\n计算3的幂：\n$$3^{2}\\equiv 9 \\equiv 2 \\pmod{7}, \\quad 3^{3}\\equiv 3\\cdot 2=6 \\pmod{7}, \\quad 3^{4}\\equiv 3\\cdot 6=18 \\equiv 4 \\pmod{7},$$\n$$3^{5}\\equiv 3\\cdot 4=12 \\equiv 5 \\pmod{7}, \\quad 3^{6}\\equiv 3\\cdot 5=15 \\equiv 1 \\pmod{7}.$$\n因此，3模7的阶整除6，又因为$34 \\equiv 4 \\pmod{6}$，我们得到\n$$3^{34} \\equiv 3^{4} \\equiv 4 \\pmod{7}.$$\n\n因此，$x=3^{34}$满足\n$$x \\equiv 4 \\pmod{5}, \\qquad x \\equiv 4 \\pmod{7}.$$\n根据中国剩余定理，这蕴含了\n$$x \\equiv 4 \\pmod{35}.$$\n因此$3^{34} \\equiv 4 \\pmod{35}$。", "answer": "$$\\boxed{4}$$", "id": "1369643"}, {"introduction": "数学工具的真正威力往往在组合使用时才能显现。费马小定理主要适用于素数模，但当模是合数时我们该怎么办？这个更进一步的练习展示了如何通过结合费马小定理和中国剩余定理，将一个复杂的合数模问题分解为几个简单的素数模子问题来解决，这体现了数学中“分而治之”的经典策略。[@problem_id:1794635]", "problem": "在一个简化的公钥密码协议中，双方约定了两个不同的素数 $p$ 和 $q$，这两个素数是保密的。他们使用乘积 $N = pq$ 作为公共模数。一个共享密钥 $K$ 是基于一个涉及 $p$ 和 $q$ 的公开表达式计算出来的。该协议规定，对于任意两个公共整数乘数 $A$ 和 $B$，密钥 $K$ 是在范围 $0 \\le K  N$ 内满足以下同余方程的唯一整数：\n$$ K \\equiv A \\cdot p^{q-1} + B \\cdot q^{p-1} \\pmod N $$\n假设双方选择了素数 $p=7$ 和 $q=13$。他们还选择了公共整数乘数 $A=5$ 和 $B=8$。计算共享密钥 $K$。", "solution": "目标是计算共享密钥 $K$ 的值。给定素数 $p=7$ 和 $q=13$，以及乘数 $A=5$ 和 $B=8$。公共模数是 $N = pq = 7 \\cdot 13 = 91$。\n\n密钥 $K$ 的同余方程由下式给出：\n$$ K \\equiv A \\cdot p^{q-1} + B \\cdot q^{p-1} \\pmod N $$\n代入给定的值，我们得到：\n$$ K \\equiv 5 \\cdot 7^{13-1} + 8 \\cdot 13^{7-1} \\pmod{91} $$\n$$ K \\equiv 5 \\cdot 7^{12} + 8 \\cdot 13^6 \\pmod{91} $$\n为了在合数模 $N=pq$ 下求解此同余方程，我们可以将其作为在素数因子 $p$ 和 $q$ 的模下的同余方程组来求解。令 $X = 5 \\cdot 7^{12} + 8 \\cdot 13^6$。我们需要求出 $X \\pmod 7$ 和 $X \\pmod{13}$。\n\n首先，我们分析模 $p=7$ 的同余方程：\n$$ X \\equiv 5 \\cdot 7^{12} + 8 \\cdot 13^6 \\pmod 7 $$\n项 $7^{12}$ 是 7 的倍数，所以 $7^{12} \\equiv 0 \\pmod 7$。\n对于项 $13^6 \\pmod 7$，我们可以使用费马小定理。该定理指出，如果 $p$ 是一个素数，那么对于任何不能被 $p$ 整除的整数 $a$，我们有 $a^{p-1} \\equiv 1 \\pmod p$。\n这里，$p=7$ 是素数且 $a=13$ 不能被 7 整除。因此：\n$$ 13^{7-1} \\equiv 13^6 \\equiv 1 \\pmod 7 $$\n将这些结果代回 $X$ 的同余方程中：\n$$ X \\equiv 5 \\cdot 0 + 8 \\cdot 1 \\pmod 7 $$\n$$ X \\equiv 8 \\pmod 7 $$\n$$ X \\equiv 1 \\pmod 7 $$\n\n接下来，我们分析模 $q=13$ 的同余方程：\n$$ X \\equiv 5 \\cdot 7^{12} + 8 \\cdot 13^6 \\pmod{13} $$\n项 $13^6$ 是 13 的倍数，所以 $13^6 \\equiv 0 \\pmod{13}$。\n对于项 $7^{12} \\pmod{13}$，我们再次使用费马小定理。这里，素数是 $q=13$，整数是 $a=7$，它不能被 13 整除。\n$$ 7^{13-1} \\equiv 7^{12} \\equiv 1 \\pmod{13} $$\n将这些结果代回 $X$ 的同余方程中：\n$$ X \\equiv 5 \\cdot 1 + 8 \\cdot 0 \\pmod{13} $$\n$$ X \\equiv 5 \\pmod{13} $$\n\n现在我们得到一个由两个线性同余方程组成的方程组：\n1. $X \\equiv 1 \\pmod 7$\n2. $X \\equiv 5 \\pmod{13}$\n\n从第一个同余方程，我们可以将 $X$ 写成 $X = 7k + 1$ 的形式，其中 $k$ 是某个整数。\n将 $X$ 的这个表达式代入第二个同余方程：\n$$ 7k + 1 \\equiv 5 \\pmod{13} $$\n$$ 7k \\equiv 4 \\pmod{13} $$\n为了解出 $k$，我们需要找到 7 模 13 的乘法逆元。我们可以测试 7 的小数倍：$7 \\cdot 1 = 7$, $7 \\cdot 2 = 14 \\equiv 1 \\pmod{13}$。所以，7 模 13 的逆元是 2。\n将同余方程两边同乘以 2：\n$$ 2 \\cdot (7k) \\equiv 2 \\cdot 4 \\pmod{13} $$\n$$ 14k \\equiv 8 \\pmod{13} $$\n$$ k \\equiv 8 \\pmod{13} $$\n这意味着 $k$ 可以写成 $k = 13j + 8$ 的形式，其中 $j$ 是某个整数。\n\n最后，将 $k$ 的这个表达式代回 $X$ 的方程中：\n$$ X = 7k + 1 = 7(13j + 8) + 1 $$\n$$ X = 91j + 56 + 1 $$\n$$ X = 91j + 57 $$\n这意味着 $X \\equiv 57 \\pmod{91}$。\n问题要求的是在范围 $0 \\le K  91$ 内的唯一密钥 $K$。这个值是 57。", "answer": "$$\\boxed{57}$$", "id": "1794635"}]}