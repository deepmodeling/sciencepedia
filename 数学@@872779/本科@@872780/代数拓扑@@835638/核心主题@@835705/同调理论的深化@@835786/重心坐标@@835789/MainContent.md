## 引言
重心坐标是几何学、拓扑学和计算机科学等领域中的一个基石性概念。它提供了一种强大而直观的方式，来描述一个点相对于一组参考顶点的位置。与依赖于外部原点和轴线的[笛卡尔坐标](@entry_id:167698)不同，[重心](@entry_id:273519)坐标是一种“内在”[坐标系](@entry_id:156346)，它仅由顶点本身定义，因而具有优美的[仿射不变性](@entry_id:275782)。这种特性使其在处理几何变形、[数据插值](@entry_id:142568)和物理系统建模时，成为一个不可或缺的工具。

然而，对于初学者而言，[重心](@entry_id:273519)坐标的抽象定义和它与物理[质心](@entry_id:265015)的直观联系之间可能存在认知鸿沟。如何从代数公式中解读出丰富的几何信息？如何将这一理论工具应用于解决不同学科的实际问题？本文旨在填补这一鸿沟，系统性地阐释重心坐标的核心思想，并展示其在多元领域的强大生命力。

通过本文的学习，您将踏上一段从理论到应用的探索之旅。在“原理与机制”一章中，我们将从物理直觉出发，建立严格的数学定义，并探讨其计算方法与核心性质。接着，在“应用与跨学科联系”一章中，我们将见证重心坐标如何在计算机图形学、有限元分析、[材料科学](@entry_id:152226)等领域大放异彩。最后，“动手实践”部分将提供具体的编程练习，帮助您将理论知识转化为解决实际问题的能力，从而真正掌握这一优雅而实用的数学工具。

## 原理与机制

在本章中，我们将深入探讨[重心](@entry_id:273519)坐标的数学原理和核心机制。[重心](@entry_id:273519)坐标不仅是代数拓扑和几何学中的一个基本概念，更是在计算机图形学、计算几何和工程分析等领域中不可或缺的实用工具。我们将从其物理直觉出发，逐步建立严格的数学定义，并探索其计算方法、几何解释以及关键性质。

### 定义与物理直觉

重心坐标（Barycentric Coordinates）这一名称本身就暗示了它与物理学中“质心”（center of mass, or barycenter）概念的深刻联系。理解这种联系是掌握[重心](@entry_id:273519)坐标本质的最直观的途径。

想象一个由 $n+1$ 个顶点 $v_0, v_1, \ldots, v_n$ 构成的几何结构（例如，二维平面中的一个三角形，或三维空间中的一个四面体）。如果在每个顶点 $v_i$ 上放置一个质量为 $m_i$ 的[质点](@entry_id:186768)，那么这个质点系统的[质心](@entry_id:265015) $P$ 的位置向量可以由以下公式计算得出：

$P = \frac{\sum_{i=0}^{n} m_i v_i}{\sum_{i=0}^{n} m_i}$

这个公式本质上是各个顶点位置向量的加权平均，权重即为对应顶点的质量。现在，如果我们对权重进行归一化，定义一组系数 $\lambda_i$ 如下：

$\lambda_i = \frac{m_i}{\sum_{j=0}^{n} m_j}$

那么，[质心](@entry_id:265015) $P$ 的位置可以被重写为：

$P = \sum_{i=0}^{n} \lambda_i v_i$

同时，这些系数 $\lambda_i$ 满足一个关键条件：

$\sum_{i=0}^{n} \lambda_i = \sum_{i=0}^{n} \frac{m_i}{\sum_{j=0}^{n} m_j} = \frac{\sum_{i=0}^{n} m_i}{\sum_{j=0}^{n} m_j} = 1$

这组满足 $\sum \lambda_i = 1$ 并且能够将点 $P$ 表示为顶点[线性组合](@entry_id:154743)的系数 $(\lambda_0, \lambda_1, \ldots, \lambda_n)$，就是点 $P$ 关于顶点 $v_0, v_1, \ldots, v_n$ 的**重心坐标**。由于物理质量通常为非负值，因此在这种物理模型中，每个 $\lambda_i$ 都大于等于零。

举一个具体的例子，考虑一个由顶点 $v_0, v_1, v_2$ 构成的三角形。若在三个顶点上分别放置质量为 $m_0 = 2$ 个单位、$m_1 = 3$ 个单位和 $m_2 = 5$ 个单位的[质点](@entry_id:186768)，该系统的总质量为 $M = 2+3+5=10$。那么，系统质心的[重心](@entry_id:273519)坐标 $(\lambda_0, \lambda_1, \lambda_2)$ 可以直接通过质量比计算得出 [@problem_id:1633410]：

$\lambda_0 = \frac{m_0}{M} = \frac{2}{10} = \frac{1}{5}$
$\lambda_1 = \frac{m_1}{M} = \frac{3}{10}$
$\lambda_2 = \frac{m_2}{M} = \frac{5}{10} = \frac{1}{2}$

这个例子清晰地展示了[重心](@entry_id:273519)坐标作为“权重”或“影响力”的物理意义：一个点的重心坐标反映了各个顶点对该点位置的贡献程度。

### [仿射组合](@entry_id:276726)与坐标的唯一性

从物理直觉过渡到严格的数学定义，我们将[重心](@entry_id:273519)坐标置于**[仿射几何](@entry_id:178810)**（affine geometry）的框架下。

一个点 $P$ 被称为顶点集 $\{v_0, v_1, \ldots, v_n\}$ 的一个**[仿射组合](@entry_id:276726)**（affine combination），如果它可以被表示为：

$P = \sum_{i=0}^{n} \lambda_i v_i, \quad \text{其中} \quad \sum_{i=0}^{n} \lambda_i = 1$

这里的系数 $(\lambda_0, \lambda_1, \ldots, \lambda_n)$ 就是点 $P$ 的[重心](@entry_id:273519)坐标。与物理模型不同，数学定义允许系数 $\lambda_i$ 取负值。

一个至关重要的问题是：对于给定的顶点集和一个点 $P$，它的[重心](@entry_id:273519)坐标是否唯一？答案取决于顶点集的几何构型。这引出了**仿射独立性**（affine independence）的概念。

一组顶点 $\{v_0, v_1, \ldots, v_n\}$ 被称为**仿射独立的**，如果向量集合 $\{v_1 - v_0, v_2 - v_0, \ldots, v_n - v_0\}$ 是[线性独立](@entry_id:153759)的。直观地讲：
*   对于两个点 ($n=1$)，它们仿射独立意味着它们不重合。
*   对于三个点 ($n=2$)，它们仿射独立意味着它们不共线。
*   对于四个点 ($n=3$)，它们仿射独立意味着它们不共面。

**基本定理：** 当且仅当顶点集 $\{v_0, v_1, \ldots, v_n\}$ 是仿射独立的，其[仿射包](@entry_id:637696)（所有[仿射组合](@entry_id:276726)构成的空间）中的任意一点 $P$ 才具有唯一的[重心](@entry_id:273519)坐标。

如果顶点是**仿射相关**的，唯一性就会丧失。例如，考虑三个共线的点 $v_0=(1,2)$, $v_1=(3,3)$, $v_2=(5,4)$。由于它们共线，它们是仿射相关的。对于这条直线上的任意一点，例如 $p=(-3,0)$，存在无穷多组[重心](@entry_id:273519)坐标 $(t_0, t_1, t_2)$ 满足 $p = t_0 v_0 + t_1 v_1 + t_2 v_2$ 和 $t_0+t_1+t_2=1$。只有施加额外的约束，例如指定其中一个坐标的值（如 $t_2=3$），我们才能得到一个特定的解 [@problem_id:1633404]。这个例子凸显了仿射独立性作为[重心](@entry_id:273519)[坐标系统](@entry_id:156346)“良好定义”的基石的重要性。

在实际应用中，我们有时会遇到**非归一化**的重心坐标，也称为**齐次重心坐标**（homogeneous barycentric coordinates）。一组不全为零的数 $(c_0, c_1, \ldots, c_n)$ 可以通过除以它们的总和 $S = \sum c_i$ 来进行归一化，从而得到标准的重心坐标 $(\lambda_0, \ldots, \lambda_n)$，其中 $\lambda_i = c_i / S$。点 $P$ 的位置可以通过以下公式计算：

$P = \frac{\sum_{i=0}^{n} c_i v_i}{\sum_{i=0}^{n} c_i}$

例如，对于一个三角形 $ABC$，一个点 $P_1$ 若由非归一化坐标 $(2, 3, 5)$ 定义，其总和为 $10$。那么它的归一化坐标为 $(0.2, 0.3, 0.5)$，其位置为 $P_1 = 0.2A + 0.3B + 0.5C$ [@problem_id:2109642]。

### 计算重心坐标

在已知顶点和目标点笛卡尔坐标的情况下，有多种方法可以计算[重心](@entry_id:273519)坐标。我们介绍两种最基本和最常用的方法。

#### 方法一：[求解线性方程组](@entry_id:169069)

这是最直接的代数方法。根据定义，[重心](@entry_id:273519)坐标 $(\lambda_0, \lambda_1, \ldots, \lambda_n)$ 必须满足[方程组](@entry_id:193238)：

$P = \sum_{i=0}^{n} \lambda_i v_i$
$1 = \sum_{i=0}^{n} \lambda_i$

对于二维平面中的一个三角形（顶点 $v_0, v_1, v_2$）和点 $P$，这个[方程组](@entry_id:193238)可以写成包含三个未知数 $(\lambda_0, \lambda_1, \lambda_2)$ 的三个[线性方程](@entry_id:151487)：

$\begin{cases}
p_x = \lambda_0 v_{0x} + \lambda_1 v_{1x} + \lambda_2 v_{2x} \\
p_y = \lambda_0 v_{0y} + \lambda_1 v_{1y} + \lambda_2 v_{2y} \\
1 = \lambda_0 + \lambda_1 + \lambda_2
\end{cases}$

例如，给定顶点 $v_0=(1,1), v_1=(4,2), v_2=(2,5)$ 和点 $P=(3,3)$，我们可以建立并求解上述[方程组](@entry_id:193238)，得到唯一的[重心](@entry_id:273519)坐标解 [@problem_id:1633365]。

一个更高效的代数技巧是首先利用 $\lambda_0 = 1 - \lambda_1 - \lambda_2$ 来消元。将此代入位置向量方程：

$P = (1 - \lambda_1 - \lambda_2)v_0 + \lambda_1 v_1 + \lambda_2 v_2$

整理后得到：

$P - v_0 = \lambda_1(v_1 - v_0) + \lambda_2(v_2 - v_0)$

这是一个关于 $(\lambda_1, \lambda_2)$ 的 $n$ 维（在2D情况下是2维）[线性方程组](@entry_id:148943)，比原始系统少一个变量，计算上更为简便。一旦求出 $\lambda_1, \ldots, \lambda_n$，就可以通过 $\lambda_0 = 1 - \sum_{i=1}^n \lambda_i$ 计算出 $\lambda_0$。这种方法在处理点在三角形外部的情况时同样有效 [@problem_id:1633364]。

#### 方法二：面积比（或体积比）方法

对于二维三角形，[重心](@entry_id:273519)坐标有一个非常优美的几何解释，即面积之比。给定三角形 $\triangle v_0 v_1 v_2$ 和内部一点 $P$，点 $P$ 将大三角形分割成三个小三角形：$\triangle P v_1 v_2$, $\triangle P v_0 v_2$ 和 $\triangle P v_0 v_1$。点 $P$ 的重心坐标 $(\lambda_0, \lambda_1, \lambda_2)$ 由以下面积比给出：

$\lambda_0 = \frac{\text{Area}(\triangle P v_1 v_2)}{\text{Area}(\triangle v_0 v_1 v_2)}, \quad \lambda_1 = \frac{\text{Area}(\triangle P v_0 v_2)}{\text{Area}(\triangle v_0 v_1 v_2)}, \quad \lambda_2 = \frac{\text{Area}(\triangle P v_0 v_1)}{\text{Area}(\triangle v_0 v_1 v_2)}$

这个关系提供了一个强大的几何直觉：$\lambda_i$ 的大小与点 $P$ 到对边 $v_j v_k$ 的距离成正比。如果 $P$ 恰好落在顶点 $v_0$ 上，那么 $\triangle P v_1 v_2$ 的面积就等于整个三角形的面积，此时 $\lambda_0=1, \lambda_1=\lambda_2=0$。如果 $P$ 落在边 $v_1 v_2$ 上，那么 $\triangle P v_1 v_2$ 的面积为零，因此 $\lambda_0=0$。

在计算上，我们可以使用[行列式](@entry_id:142978)（或鞋带公式）来计算[有向面积](@entry_id:169588)，这使得该方法同样适用于点在三角形外部的情况。例如，给定顶点 $v_0=(1,1), v_1=(7,2), v_2=(3,6)$ 和点 $p=(4,3)$，我们可以通过计算四个相关三角形的（有向）面积来精确确定重心坐标 $(\lambda_0, \lambda_1, \lambda_2)$ [@problem_id:1633416]。

这个思想可以推广到更高维度。例如，在三维空间中，一个点在四面体内的[重心](@entry_id:273519)坐标由四个子四面体的体积与总体积之比给出。

### 几何解释与[区域划分](@entry_id:748628)

[重心](@entry_id:273519)坐标的符号蕴含了丰富的几何信息，它能精确地描述一个点相对于一个单形（simplex，如三角形或四面体）的位置。

一个点 $P$ 位于由顶点 $\{v_0, \ldots, v_n\}$ 定义的**闭单形**（即顶点的[凸包](@entry_id:262864)）内部，当且仅当它的所有重心坐标都是非负的：$\lambda_i \ge 0$ 对所有 $i$ 成立。这正是**凸组合**（convex combination）的定义。

当有点的[重心](@entry_id:273519)坐标为零或为负时，情况变得更加有趣：

*   **位于边界上**：如果某个坐标 $\lambda_i = 0$，则点 $P$ 位于由其他顶点 $\{v_j\}_{j \ne i}$ 张成的仿射[子空间](@entry_id:150286)中。对于一个3-单形（四面体），如果 $\lambda_3 = 0$，那么点 $P$ 就位于由 $v_0, v_1, v_2$ 构成的那个面（一个2-单形）上 [@problem_id:1633387]。对于一个三角形，如果 $\lambda_2=0$，点 $P$ 就在穿过 $v_0$ 和 $v_1$ 的直线上。

*   **位于单形外部**：如果某个坐标 $\lambda_i  0$，则点 $P$ 位于单形外部，并且在由超平面（例如，穿过边 $v_j v_k$ 的直线）定义的“另一侧”。一个单形的各个面（及其延伸）将整个空间划分为多个区域，每个区域都可以由其点的重心坐标的符号模式来唯一标识。

让我们以一个平面上的三角形 $ABC$ 为例。三条穿过其边的直线将平面划分为七个区域。
1.  **三角形内部**：$(\lambda_A, \lambda_B, \lambda_C)$ 均为正。
2.  **在边上**：一个坐标为零，另两个为正。
3.  **在顶点上**：一个坐标为1，另两个为零。
4.  **在外部区域**：至少有一个坐标为负。

考虑一个点 $P$ 的[重心](@entry_id:273519)坐标为 $(2, -1, 0)$ [@problem_id:2109635]。
*   $\lambda_C = 0$ 意味着 $P$ 位于穿过 $A$ 和 $B$ 的直线上。
*   $\lambda_B = -1  0$ 意味着 $P$ 在线段 $AB$ 之外，并且位于 $A$ 这一侧（因为 $P$ “远离” $B$）。
其位置向量为 $P = 2A - B$。整理这个式子得到 $A = \frac{P+B}{2}$，这表明 $A$ 是线段 $BP$ 的中点。

再比如，考虑一个点 $p$ 位于顶点 $v_0$ “背后”的区域，即由边 $v_0v_1$ 和 $v_0v_2$ 延伸线所夹的、与三角形内部相对的区域。计算出的重心坐标会呈现一个特定的模式：与顶点 $v_0$ 相关的坐标 $\lambda_0$ 将大于1，而其他两个坐标 $\lambda_1, \lambda_2$ 将是负数 [@problem_id:1633364]。这个结果为通过[重心](@entry_id:273519)坐标符号来定位点的位置提供了坚实的量化依据。

### 核心性质：[仿射不变性](@entry_id:275782)

重心坐标的一个极其重要且强大的性质是它们在**仿射变换**（affine transformation）下是**不变的**（invariant）。[仿射变换](@entry_id:144885)是一种保持[共线点](@entry_id:174222)共线、保持平行线平行的[几何变换](@entry_id:150649)，其一般形式为 $T(\vec{x}) = M\vec{x} + \vec{b}$，其中 $M$ 是一个矩阵，$ \vec{b}$ 是一个平移向量。旋转、缩放、错切、平移都是仿射变换的例子。

**[仿射不变性](@entry_id:275782)原理：** 设点 $P$ 关于顶点 $\{v_i\}$ 的重心坐标为 $(\lambda_i)$。如果对所有点施加一个[仿射变换](@entry_id:144885) $T$，那么变换后的点 $P' = T(P)$ 相对于变换后的顶点集 $\{v'_i = T(v_i)\}$ 的重心坐标仍然是 $(\lambda_i)$。

证明这个原理非常直接。设 $P = \sum \lambda_i v_i$ 且 $\sum \lambda_i = 1$。应用变换 $T$：

$P' = T(P) = T(\sum_{i=0}^{n} \lambda_i v_i)$
$P' = M \left( \sum_{i=0}^{n} \lambda_i v_i \right) + \vec{b}$

利用矩阵乘法的线性性质：

$P' = \sum_{i=0}^{n} \lambda_i (M v_i)$

由于 $\sum \lambda_i = 1$，我们可以将平移向量 $\vec{b}$ 写作 $\vec{b} = (\sum \lambda_i) \vec{b} = \sum (\lambda_i \vec{b})$：

$P' = \sum_{i=0}^{n} \lambda_i (M v_i) + \sum_{i=0}^{n} (\lambda_i \vec{b})$
$P' = \sum_{i=0}^{n} \lambda_i (M v_i + \vec{b})$

根据 $T$ 的定义，$M v_i + \vec{b} = T(v_i) = v'_i$。因此：

$P' = \sum_{i=0}^{n} \lambda_i v'_i$

这证明了变换后的点 $P'$ 仍然由相同的重心坐标 $(\lambda_i)$ 来表示，只不过是相对于新的顶点 $v'_i$。

这个性质在[计算机图形学](@entry_id:148077)等领域具有巨大的实用价值。例如，当一个由三角形网格构成的模型发生变形时（这通常是一个[仿射变换](@entry_id:144885)），我们无需重新计算模型上每一点新的[重心](@entry_id:273519)坐标。我们只需计算一次初始坐标，这些坐标在整个动画或变形过程中都保持有效。这极大地简化了纹理映射、颜色插值等计算 [@problem_id:1633386] [@problem_id:2109680]。要确定变换后点 $P'$ 相对于新顶点 $A', B', C'$ 的坐标，我们只需要计算原始点 $P$ 相对于原始顶点 $A, B, C$ 的坐标即可，结果完全相同。