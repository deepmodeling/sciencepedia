{"hands_on_practices": [{"introduction": "为了建立对时间平均的直观理解，我们从一个完全可预测的有限系统开始：循环置换。这个练习将向您展示，在一个简单的遍历系统中，任何点的长期行为最终都会反映整个系统的平均状态，这正是遍历思想的核心。通过这个计算，您将看到时间平均值如何独立于初始状态，并等于可观测量在整个空间上的算术平均值 [@problem_id:1447062]。", "problem": "考虑一个具有有限个状态的系统，状态由集合 $X = \\{1, 2, \\dots, N\\}$ 中的整数标记，其中整数 $N \\ge 2$。该系统在离散时间步上演化。如果系统在时间 $t$ 处于状态 $k$，它将根据变换规则 $T: X \\to X$ 在时间 $t+1$ 跃迁到一个新状态，该规则定义为 $T(k) = (k \\pmod N) + 1$。\n\n在每个状态下测量一个可观测量，记为 $f$。当系统处于状态 $k$ 时，该可观测量的值由函数 $f(k) = k$ 给出。\n\n对于任意初始状态 $k_0 \\in X$，我们可以定义可观测量 $f$ 沿着从 $k_0$ 开始的轨道的时间平均。如果访问的状态序列为 $k_0, k_1, k_2, \\dots$，其中 $k_{m+1} = T(k_m)$，则时间平均由以下极限给出：\n$$\n\\hat{f}(k_0) = \\lim_{M \\to \\infty} \\frac{1}{M}\\sum_{m=0}^{M-1} f(k_m)\n$$\n可以证明，该极限存在且与初始状态 $k_0$ 无关。计算这个时间平均值。您的答案应该是一个关于 $N$ 的闭式解析表达式。", "solution": "映射 $T(k)=(k \\bmod N)+1$ 生成一个遍历 $X=\\{1,2,\\dots,N\\}$ 中所有状态的循环。对于任意初始状态 $k_{0}\\in X$，定义轨道为 $k_{m+1}=T(k_{m})$。通过归纳法可得其显式形式\n$$\nk_{m}=\\bigl((k_{0}+m-1)\\bmod N\\bigr)+1,\n$$\n因此序列 $\\{k_{m}\\}_{m=0}^{N-1}$ 是 $\\{1,2,\\dots,N\\}$ 的一个排列，并且对于所有 $m$ 都有 $k_{m+N}=k_{m}$，即轨道是周期性的，周期为 $N$。\n\n令 $S_{N}=\\sum_{j=1}^{N}f(j) = \\sum_{j=1}^{N}j$。因为每连续 $N$ 步的块恰好访问每个状态一次，所以对于任意整数 $\\ell\\ge 0$，\n$$\n\\sum_{m=\\ell N}^{\\ell N+N-1} f(k_{m}) = S_{N}.\n$$\n对于任意的 $M$，可写为 $M=qN+r$，其中整数 $q \\ge 0$ 且 $0 \\le r  N$。时间平均可以写作：\n$$ \\frac{1}{M}\\sum_{m=0}^{M-1} f(k_m) = \\frac{1}{qN+r} \\left( qS_N + \\sum_{m=qN}^{qN+r-1} f(k_m) \\right) = \\frac{qN}{qN+r}\\frac{S_N}{N} + \\frac{1}{qN+r}\\sum_{m=qN}^{qN+r-1} f(k_m) $$\n当 $M \\to \\infty$ 时，$q \\to \\infty$。第一项趋向于 $\\frac{S_N}{N}$，因为 $\\frac{qN}{qN+r} \\to 1$。第二项趋向于 0，因为分子是有界和，而分母趋于无穷。因此，\n$$ \\hat{f}(k_0) = \\frac{S_N}{N} = \\frac{1}{N} \\sum_{j=1}^{N} j = \\frac{N(N+1)/2}{N} = \\frac{N+1}{2} $$", "answer": "$$\\boxed{\\frac{N+1}{2}}$$", "id": "1447062"}, {"introduction": "并非所有系统都是遍历的。这个练习探讨了一个将状态空间分解为多个独立循环的系统，以此来研究非遍历动态的后果。通过计算，您会发现长期时间平均值现在取决于系统的起始点，因为它收敛到轨迹所在特定不变子集（即循环）上的平均值，而非整个空间的平均值 [@problem_id:1447100]。这凸显了遍历性假设对于确保时间平均收敛到单一全局常数的重要性。", "problem": "设 $X = \\{1, 2, 3, 4, 5\\}$ 是一个离散空间。考虑一个变换 $T: X \\to X$，它由置换 $T(1)=2$、$T(2)=3$、$T(3)=1$、$T(4)=5$ 和 $T(5)=4$ 定义。设 $f: X \\to \\mathbb{R}$ 是一个由 $f(k) = k^2$ 定义的函数。\n\n从点 $k \\in X$ 开始的函数 $f$ 的长期时间平均由以下极限定义：\n$$ \\bar{f}(k) = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} f(T^n k) $$\n其中 $T^n k$ 表示将变换 $T$ 应用 $n$ 次，且 $T^0 k = k$。\n\n您的任务是计算函数 $\\bar{f}: X \\to \\mathbb{R}$。以下哪个选项正确地指明了函数 $\\bar{f}$？\n\nA. 对所有 $k \\in X$，$\\bar{f}(k) = 11$。\n\nB. 对 $k \\in \\{1,2,3\\}$，$\\bar{f}(k) = 2$；对 $k \\in \\{4,5\\}$，$\\bar{f}(k) = 4.5$。\n\nC. 对 $k \\in \\{1,2,3\\}$，$\\bar{f}(k) = \\frac{14}{3}$；对 $k \\in \\{4,5\\}$，$\\bar{f}(k) = \\frac{41}{2}$。\n\nD. 对 $k \\in \\{1,2,3\\}$，$\\bar{f}(k) = \\frac{41}{2}$；对 $k \\in \\{4,5\\}$，$\\bar{f}(k) = \\frac{14}{3}$。\n\nE. 对 $k \\in \\{1,2,3\\}$，$\\bar{f}(k) = \\frac{14}{5}$；对 $k \\in \\{4,5\\}$，$\\bar{f}(k) = \\frac{41}{5}$。", "solution": "因为 $X$ 是有限的且 $T$ 是一个置换，所以每个点 $k \\in X$ 都位于一个周期轨道上。如果 $k$ 的周期是 $m \\in \\mathbb{N}$，那么 $T^{m}k=k$ 并且序列 $\\{f(T^{n}k)\\}_{n \\geq 0}$ 是周期为 $m$ 的周期序列。对于 $N=qm+r$，其中 $q \\in \\mathbb{N}$ 且 $0 \\leq r  m$，我们有\n$$\n\\sum_{n=0}^{N-1} f(T^{n}k)=q \\sum_{n=0}^{m-1} f(T^{n}k)+\\sum_{n=0}^{r-1} f(T^{n}k).\n$$\n两边同除以 $N$ 可得\n$$\n\\frac{1}{N}\\sum_{n=0}^{N-1} f(T^{n}k) = \\frac{q}{N} \\sum_{n=0}^{m-1} f(T^{n}k) + \\frac{1}{N}\\sum_{n=0}^{r-1} f(T^{n}k).\n$$\n当 $N \\to \\infty$ 时，我们有 $\\frac{q}{N} \\to \\frac{1}{m}$，并且由于 $f$ 在有限集 $X$ 上有界，余项趋于 $0$。因此，\n$$\n\\bar{f}(k)=\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} f(T^{n}k)=\\frac{1}{m}\\sum_{n=0}^{m-1} f(T^{n}k),\n$$\n即 $f$ 在通过 $k$ 的轨道的一个周期上的平均值。\n\n置换 $T$ 有两个不相交的循环：长度为 $3$ 的 $(1\\,2\\,3)$ 和长度为 $2$ 的 $(4\\,5)$。因此，对 $k \\in \\{1,2,3\\}$，\n$$\n\\bar{f}(k)=\\frac{1}{3}\\big(f(1)+f(2)+f(3)\\big)=\\frac{1}{3}\\big(1^{2}+2^{2}+3^{2}\\big)=\\frac{1+4+9}{3}=\\frac{14}{3},\n$$\n且对 $k \\in \\{4,5\\}$，\n$$\n\\bar{f}(k)=\\frac{1}{2}\\big(f(4)+f(5)\\big)=\\frac{1}{2}\\big(4^{2}+5^{2}\\big)=\\frac{16+25}{2}=\\frac{41}{2}.\n$$\n与选项比较，这与选项 C 相符。", "answer": "$$\\boxed{C}$$", "id": "1447100"}, {"introduction": "现在，我们将从有限系统转向一个经典的连续遍历系统：圆上的无理旋转。直接计算这种复杂轨迹的时间平均是极其困难的，而这正是 Birkhoff 遍历定理大显身手的地方。这个练习将指导您如何应用该定理，将一个复杂的求和极限问题转化为一个简单的空间平均（积分）问题，从而展示其作为强大计算工具的价值 [@problem_id:1447084]。", "problem": "考虑一个粒子，其位置由笛卡尔平面上单位圆上的一个点描述。系统的状态由参数 $x \\in [0, 1)$ 给出，其中粒子的坐标为 $(\\cos(2\\pi x), \\sin(2\\pi x))$。粒子的状态按离散时间步演化，其变换为 $T(x) = (x + \\alpha) \\pmod{1}$，其中 $\\alpha$ 是一个固定的无理数。\n\n一个静止观察者位于同一平面内的点 $P$，其坐标为 $(a, b)$。设 $d(x)$ 为处于状态 $x$ 的粒子与观察者 $P$ 之间的欧几里得距离。\n\n可以证明，对于几乎所有初始状态 $x_0 \\in [0, 1)$，沿由 $T$ 生成的轨道，任何性质足够好的函数的长期时间平均的极限都存在，且与 $x_0$ 的具体选择无关。可假定此性质成立。轨道由状态序列 $x_n = T^n(x_0)$ 定义，其中 $n=0, 1, 2, \\dots$。\n\n确定粒子与观察者之间距离的*平方*的长期时间平均值，我们记为 $L$：\n$$ L = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} [d(x_n)]^2 $$\n将你的答案表示为参数 $a$ 和 $b$ 的函数。", "solution": "处于状态 $x$ 的粒子对应的角为 $\\theta=2\\pi x$，其位置为 $(\\cos\\theta,\\sin\\theta)$。到点 $P=(a,b)$ 的距离的平方是\n$$\nd(x)^{2}=(\\cos\\theta-a)^{2}+(\\sin\\theta-b)^{2}\n=\\cos^{2}\\theta+\\sin^{2}\\theta-2a\\cos\\theta-2b\\sin\\theta+a^{2}+b^{2}.\n$$\n使用 $\\cos^{2}\\theta+\\sin^{2}\\theta=1$，上式可化简为\n$$\nd(x)^{2}=1+a^{2}+b^{2}-2a\\cos\\theta-2b\\sin\\theta.\n$$\n根据所假定的无理旋转 $T(x)=(x+\\alpha)\\bmod 1$ 的遍历性，长期时间平均等于关于 $x\\in[0,1)$ 上均匀测度的空间平均（等价于在 $\\theta\\in[0,2\\pi)$ 上均匀分布）。因此，\n$$\nL=\\int_{0}^{1} d(x)^{2}\\,dx=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\left(1+a^{2}+b^{2}-2a\\cos\\theta-2b\\sin\\theta\\right)\\,d\\theta.\n$$\n$\\cos\\theta$ 和 $\\sin\\theta$ 在一个完整周期上的积分为零：\n$$\n\\int_{0}^{2\\pi}\\cos\\theta\\,d\\theta=0,\\qquad \\int_{0}^{2\\pi}\\sin\\theta\\,d\\theta=0,\n$$\n所以平均值化简为\n$$\nL=1+a^{2}+b^{2}.\n$$", "answer": "$$\\boxed{1+a^{2}+b^{2}}$$", "id": "1447084"}]}