{"hands_on_practices": [{"introduction": "最优运输理论的核心在于如何以最低成本将资源从供给方移动到需求方。这个练习将这一抽象概念具体化为一个离散的物流问题，你需要为一个公司在面包店和咖啡馆之间规划运输方案。通过构建成本矩阵和求解一个简单的线性规划问题，你将亲身体验到Kantorovich最优运输方案的构建过程[@problem_id:1424977]。", "problem": "一家公司经营着两家面包店 $B_1$ 和 $B_2$，以及两家咖啡馆 $C_1$ 和 $C_2$，它们都位于一条笔直的道路上。它们的位置以千米为单位，从一个参考点算起：\n- 面包店 $B_1$ 位于位置 $a_1 = 1$。\n- 面包店 $B_2$ 位于位置 $a_2 = 2$。\n- 咖啡馆 $C_1$ 位于位置 $b_1 = 5$。\n- 咖啡馆 $C_2$ 位于位置 $b_2 = 8$。\n\n每天早上，两家面包店生产等量的货物，每家面包店恰好提供总供应量的一半。同样，两家咖啡馆有相等的需求，每家都需要总供应量的一半来配送。供应和需求可以建模为离散概率测度：供应测度为 $\\mu = \\frac{1}{2}\\delta_{a_1} + \\frac{1}{2}\\delta_{a_2}$，需求测度为 $\\nu = \\frac{1}{2}\\delta_{b_1} + \\frac{1}{2}\\delta_{b_2}$，其中 $\\delta_x$ 表示位于位置 $x$ 的单位质量。\n\n将单位货物从位置 $x$ 运输到位置 $y$ 的成本由欧几里得距离的平方给出，即 $c(x, y) = (x-y)^2$。公司旨在确定一个运输方案，将所有货物从面包店运送到咖啡馆，同时最小化总运输成本。这样的方案，称为运输计划，可以由一个矩阵 $\\Pi = (\\pi_{ij})$ 表示，其中 $\\pi_{ij}$ 是从面包店 $i$ 运输到咖啡馆 $j$ 的货物占总供应量的比例（对于 $i,j \\in \\{1,2\\}$）。\n\n确定实现最低可能总成本的最优运输计划 $\\Pi$。以行矩阵的形式给出该计划的分量，顺序为 $\\begin{pmatrix} \\pi_{11}  \\pi_{12}  \\pi_{21}  \\pi_{22} \\end{pmatrix}$。", "solution": "这个问题是关于离散测度的最优运输问题的 Kantorovich 公式的一个实例。我们需要找到一个运输计划 $\\Pi = (\\pi_{ij})$，它在满足其边际约束的条件下，最小化总成本。\n\n运输计划是一个具有非负项的 $2 \\times 2$ 矩阵：\n$$\n\\Pi = \\begin{pmatrix} \\pi_{11}  \\pi_{12} \\\\ \\pi_{21}  \\pi_{22} \\end{pmatrix}\n$$\n其中 $\\pi_{ij}$ 是从位于 $a_i$ 的面包店 $B_i$ 运输到位于 $b_j$ 的咖啡馆 $C_j$ 的质量。\n\n首先，我们计算成本矩阵 $C = (c_{ij})$，其中 $c_{ij} = c(a_i, b_j) = (a_i - b_j)^2$。\n- $c_{11} = (a_1 - b_1)^2 = (1 - 5)^2 = (-4)^2 = 16$。\n- $c_{12} = (a_1 - b_2)^2 = (1 - 8)^2 = (-7)^2 = 49$。\n- $c_{21} = (a_2 - b_1)^2 = (2 - 5)^2 = (-3)^2 = 9$。\n- $c_{22} = (a_2 - b_2)^2 = (2 - 8)^2 = (-6)^2 = 36$。\n所以成本矩阵是：\n$$\nC = \\begin{pmatrix} 16  49 \\\\ 9  36 \\end{pmatrix}\n$$\n\n总运输成本是需要最小化的目标函数：\n$$\nJ(\\Pi) = \\sum_{i=1}^{2} \\sum_{j=1}^{2} c_{ij} \\pi_{ij} = 16\\pi_{11} + 49\\pi_{12} + 9\\pi_{21} + 36\\pi_{22}\n$$\n\n约束条件是运输计划 $\\Pi$ 的边际必须与给定的测度 $\\mu$ 和 $\\nu$ 相匹配。\n$\\Pi$ 的行和必须等于源位置（面包店）的质量：\n1.  $\\pi_{11} + \\pi_{12} = \\mu(\\{a_1\\}) = \\frac{1}{2}$ （来自 $B_1$ 的总质量）\n2.  $\\pi_{21} + \\pi_{22} = \\mu(\\{a_2\\}) = \\frac{1}{2}$ （来自 $B_2$ 的总质量）\n\n$\\Pi$ 的列和必须等于目标位置（咖啡馆）的质量：\n3.  $\\pi_{11} + \\pi_{21} = \\nu(\\{b_1\\}) = \\frac{1}{2}$ （到 $C_1$ 的总质量）\n4.  $\\pi_{12} + \\pi_{22} = \\nu(\\{b_2\\}) = \\frac{1}{2}$ （到 $C_2$ 的总质量）\n\n此外，运输计划的所有条目都必须是非负的：\n5.  对所有 $i,j \\in \\{1,2\\}$，$\\pi_{ij} \\ge 0$。\n\n这是一个线性规划问题。我们可以通过参数化有效运输计划的空间来解决它。让我们用一个变量来表示所有变量，设 $\\pi_{11} = x$。\n根据约束(1)：$\\pi_{12} = \\frac{1}{2} - \\pi_{11} = \\frac{1}{2} - x$。\n根据约束(3)：$\\pi_{21} = \\frac{1}{2} - \\pi_{11} = \\frac{1}{2} - x$。\n利用这些，我们从约束(2)中求出 $\\pi_{22}$：\n$\\pi_{22} = \\frac{1}{2} - \\pi_{21} = \\frac{1}{2} - (\\frac{1}{2} - x) = x$。\n我们可以检查这也满足约束(4)：$\\pi_{12} + \\pi_{22} = (\\frac{1}{2} - x) + x = \\frac{1}{2}$。这是一致的。\n\n因此，任何有效的运输计划都可以写成：\n$$\n\\Pi(x) = \\begin{pmatrix} x  \\frac{1}{2} - x \\\\ \\frac{1}{2} - x  x \\end{pmatrix}\n$$\n现在我们应用非负性约束(5)：\n- $\\pi_{11} = x \\ge 0$。\n- $\\pi_{12} = \\frac{1}{2} - x \\ge 0 \\implies x \\le \\frac{1}{2}$。\n- $\\pi_{21} = \\frac{1}{2} - x \\ge 0 \\implies x \\le \\frac{1}{2}$。\n- $\\pi_{22} = x \\ge 0$。\n综合这些，参数 $x$ 的有效范围是 $0 \\le x \\le \\frac{1}{2}$。\n\n现在我们将总成本 $J$ 表示为 $x$ 的函数：\n$$\nJ(x) = 16x + 49\\left(\\frac{1}{2} - x\\right) + 9\\left(\\frac{1}{2} - x\\right) + 36x\n$$\n$$\nJ(x) = 16x + \\frac{49}{2} - 49x + \\frac{9}{2} - 9x + 36x\n$$\n$$\nJ(x) = (16 - 49 - 9 + 36)x + \\left(\\frac{49}{2} + \\frac{9}{2}\\right)\n$$\n$$\nJ(x) = (52 - 58)x + \\frac{58}{2}\n$$\n$$\nJ(x) = -6x + 29\n$$\n我们需要在区间 $x \\in [0, \\frac{1}{2}]$ 上最小化这个线性函数 $J(x)$。由于该函数具有负斜率（-6），其在区间上的最小值将在 $x$ 的最大可能值处取得，即 $x = \\frac{1}{2}$。\n\n$x$ 的最优值是 $x_{opt} = \\frac{1}{2}$。\n将此值代回参数化的计划 $\\Pi(x)$ 中：\n- $\\pi_{11} = x_{opt} = \\frac{1}{2}$。\n- $\\pi_{12} = \\frac{1}{2} - x_{opt} = \\frac{1}{2} - \\frac{1}{2} = 0$。\n- $\\pi_{21} = \\frac{1}{2} - x_{opt} = \\frac{1}{2} - \\frac{1}{2} = 0$。\n- $\\pi_{22} = x_{opt} = \\frac{1}{2}$。\n\n所以最优运输计划是：\n$$\n\\Pi^* = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix}\n$$\n这个计划对应于将面包店 $B_1$ 的所有供应发送到咖啡馆 $C_1$，并将面包店 $B_2$ 的所有供应发送到咖啡馆 $C_2$，这是一个非交叉匹配。\n\n最终答案应以行矩阵的形式呈现：$\\begin{pmatrix} \\pi_{11}  \\pi_{12}  \\pi_{21}  \\pi_{22} \\end{pmatrix}$。\n即 $\\begin{pmatrix} \\frac{1}{2}  0  0  \\frac{1}{2} \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}  0  0  \\frac{1}{2} \\end{pmatrix}}$$", "id": "1424977"}, {"introduction": "当处理连续分布时，尤其是在一维空间中，最优运输问题可以被显著简化。对于凸成本函数，最优解不再是一个复杂的计划，而是一个简单的单调映射。这个练习将指导你使用累积分布函数（CDF）来找到这个映射，将一个均匀分布的资源重新分配为一个指数分布[@problem_id:1424962]，这是求解一维最优运输问题的基石技术。", "problem": "考虑一个资源分配问题。一个连续资源最初在区间 $I = [0, 1]$ 上均匀分布。该初始分布的概率密度函数为 $f(x)=1$（对于 $x \\in I$）且在其他情况下为零。需要移动和重新排列此资源，以匹配区间 $J = [0, \\infty)$ 上的目标分布。目标分布由概率密度函数 $g(y) = \\exp(-y)$（对于 $y \\in J$）描述。\n\n将少量资源从点 $x \\in I$ 运输到点 $y \\in J$ 的成本与它们之间距离的平方成正比。目标是找到一个传输映射 $T: I \\to J$，它是一个严格递增的函数，为每个初始点 $x$ 分配一个唯一的终点 $y = T(x)$，使得这种重新排列的总成本最小化。\n\n确定这个最优传输映射 $T(x)$ 的显式函数形式。", "solution": "我们寻求从源概率密度 $f(x)=1$（在 $I=[0,1]$ 上）到目标概率密度 $g(y)=\\exp(-y)$（在 $J=[0,\\infty)$ 上）的二次成本 $c(x,y)=(x-y)^{2}$ 的最优传输映射。在一维情况下，对于凸成本，最优Monge映射是单调重排，它由推前条件唯一确定（在测度为零的集合上除外）并且是严格递增的。对于一个严格递增的传输映射 $T$，推前条件等价地用累积分布函数表示：如果 $F$ 和 $G$ 分别是 $f$ 和 $g$ 的累积分布函数（CDF），那么\n$$\nF(x)=G(T(x)) \\quad \\text{对于所有 } x \\in [0,1]。\n$$\n这源于区间上的质量守恒：对于任何 $x \\in [0,1]$，在 $f$ 下 $[0,x]$ 的质量等于在 $g$ 下 $[0,T(x)]$ 的质量。因此，最优映射由分位数公式给出\n$$\nT(x)=G^{-1}(F(x))。\n$$\n我们计算累积分布函数。对于在 $[0,1]$ 上的 $f(x)=1$，其累积分布函数是\n$$\nF(x)=x \\quad \\text{对于 } x \\in [0,1]。\n$$\n对于在 $[0,\\infty)$ 上的 $g(y)=\\exp(-y)$，其累积分布函数是\n$$\nG(y)=\\int_{0}^{y}\\exp(-t)\\,dt=1-\\exp(-y) \\quad \\text{对于 } y \\geq 0。\n$$\n为了得到分位数函数，求解 $u=G(y)=1-\\exp(-y)$ 关于 $y$ 的方程：\n$$\n\\exp(-y)=1-u \\quad \\Longrightarrow \\quad y=-\\ln(1-u),\n$$\n所以\n$$\nG^{-1}(u)=-\\ln(1-u) \\quad \\text{对于 } u \\in [0,1)。\n$$\n因此，最优传输映射是\n$$\nT(x)=G^{-1}(F(x))=-\\ln(1-x) \\quad \\text{对于 } x \\in [0,1)。\n$$\n这个 $T$ 是严格递增的，因为在 $[0,1)$ 上 $T'(x)=\\frac{1}{1-x}0$。它满足边界条件 $T(0)=0$，并且当 $x \\uparrow 1$ 时，$T(x)\\to+\\infty$，这与指数目标分布的无界支撑集相匹配。我们也可以验证推前密度恒等式 $g(T(x))\\,T'(x)=f(x)$：\n$$\ng(T(x))\\,T'(x)=\\exp\\bigl(-T(x)\\bigr)\\cdot \\frac{1}{1-x}=\\exp\\bigl(\\ln(1-x)\\bigr)\\cdot \\frac{1}{1-x}=1=f(x)。\n$$\n根据凸成本的一维单调重排定理，这个 $T$ 是唯一的最优传输映射。", "answer": "$$\\boxed{-\\ln(1-x)}$$", "id": "1424962"}, {"introduction": "成本函数的性质对最优运输方案的结构有着决定性的影响。这个练习通过对比两种不同的成本函数——一个是凸函数（平方距离），另一个是凹函数（距离的平方根）——来揭示这一深刻联系。你将发现，成本函数的几何形状如何决定了质量是应该“顺序”移动还是“逆序”移动[@problem_id:1424951]，从而加深对最优运输理论背后经济直觉的理解。", "problem": "考虑两个一维最优传输问题。在这两个问题中，目标都是将一个源概率测度 $\\mu$ 传输到一个目标概率测度 $\\nu$。源测度 $\\mu$ 是区间 $[0, 1]$ 上的均匀概率测度，目标测度 $\\nu$ 是区间 $[1, 2]$ 上的均匀概率测度。\n\n这两个问题仅在代价函数 $c(x, y)$ 上有所不同，该函数表示将单位质量从点 $x \\in [0, 1]$ 移动到点 $y \\in [1, 2]$ 的代价。\n\n1.  **问题1：** 代价函数为 $c_1(x, y) = (x - y)^2$。令 $\\pi_1$ 为在所有有效的传输方案 $\\pi$ 中，最小化总代价 $\\int_{[0,1]\\times[1,2]} c_1(x, y) \\, d\\pi(x, y)$ 的最优传输方案。令 $S_1$ 为 $\\pi_1$ 的支撑集。\n\n2.  **问题2：** 代价函数为 $c_2(x, y) = \\sqrt{|x - y|}$。令 $\\pi_2$ 为在所有有效的传输方案 $\\pi$ 中，最小化总代价 $\\int_{[0,1]\\times[1,2]} c_2(x, y) \\, d\\pi(x, y)$ 的最优传输方案。令 $S_2$ 为 $\\pi_2$ 的支撑集。\n\n一个函数 $T:[0,1] \\to [1,2]$ 如果对于 $[0,1]$ 中的任意 $x_1  x_2$ 都满足 $T(x_1) \\leq T(x_2)$，则被称为“递增”的。如果对于 $[0,1]$ 中的任意 $x_1  x_2$ 都满足 $T(x_1) \\geq T(x_2)$，则被称为“递减”的。一个传输方案的支撑集是 $[0,1] \\times [1,2]$ 中测度所集中的最小闭集。\n\n下列哪个陈述正确描述了支撑集 $S_1$ 和 $S_2$ 的几何性质？\n\nA. $S_1$ 和 $S_2$ 都是一维集合，各自对应于一个从 $[0,1]$ 到 $[1,2]$ 的唯一递增函数的图像。\n\nB. $S_1$ 和 $S_2$ 都是一维集合，各自对应于一个从 $[0,1]$ 到 $[1,2]$ 的唯一递减函数的图像。\n\nC. $S_1$ 是一个一维集合，对应于一个唯一递增函数的图像，而 $S_2$ 是一个一维集合，对应于一个唯一递减函数的图像。\n\nD. $S_1$ 是一个一维集合，对应于一个函数的图像，而 $S_2$ 是二维集合 $[0,1] \\times [1,2]$。\n\nE. $S_1$ 是一个一维集合，对应于一个唯一递减函数的图像，而 $S_2$ 是一个一维集合，对应于一个唯一递增函数的图像。\n\nF. $S_1$ 和 $S_2$ 都是二维集合 $[0,1] \\times [1,2]$，因为这两个方案不是确定性的。", "solution": "我们考虑在 $[0,1] \\times [1,2]$ 上的两个一维最优传输问题，其中源测度 $\\mu$ 在 $[0,1]$ 上均匀分布，目标测度 $\\nu$ 在 $[1,2]$ 上均匀分布。\n\n**问题1：** 代价函数为 $c_1(x, y) = (x - y)^2$。这个代价函数是关于距离 $(y-x)$ 的严格凸函数。对于一维中的严格凸代价函数，最优传输方案由唯一的单调递增映射给出。该映射 $T_1$ 可以通过累积分布函数（CDF）找到：$T_1(x) = F_\\nu^{-1}(F_\\mu(x))$。\n源CDF为 $F_\\mu(x) = x$ (对于 $x \\in [0, 1]$)。目标CDF为 $F_\\nu(y) = y - 1$ (对于 $y \\in [1, 2]$)，其逆为 $F_\\nu^{-1}(u) = u + 1$。\n因此，最优映射为 $T_1(x) = x + 1$。这是一个递增函数。其支撑集 $S_1$ 是函数 $y=x+1$ 在 $x \\in [0,1]$ 上的图像。\n\n**问题2：** 代价函数为 $c_2(x, y) = \\sqrt{|x-y|}$。在可行域 $[0,1] \\times [1,2]$ 中，$y \\ge x$，所以代价可以写作 $c_2(x,y) = \\sqrt{y-x}$。函数 $h(r) = \\sqrt{r}$ 是一个严格凹函数。对于一维中的严格凹代价函数，最优传输方案由唯一的单调递减映射给出。\n这个“反单调”映射 $T_2$ 满足质量守恒条件 $F_\\mu(x) = 1 - F_\\nu(T_2(x))$。\n代入CDF表达式，我们得到：$x = 1 - (T_2(x) - 1) = 2 - T_2(x)$。\n解出 $T_2(x)$，我们得到 $T_2(x) = 2 - x$。这是一个递减函数。其支撑集 $S_2$ 是函数 $y=2-x$ 在 $x \\in [0,1]$ 上的图像。\n\n综上所述，$S_1$ 对应于一个递增函数的图像，而 $S_2$ 对应于一个递减函数的图像。因此，选项C是正确的。", "answer": "$$\\boxed{C}$$", "id": "1424951"}]}