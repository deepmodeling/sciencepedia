## 引言
在微积分的初步学习中，我们通过[黎曼和](@entry_id:137667)来定义函数的[定积分](@entry_id:147612)，它直观地将曲线下的面积近似为一系列矩形面[积之和](@entry_id:266697)。然而，[黎曼和](@entry_id:137667)的定义依赖于在每个子区间内任意选取的样本点，这为构建一个坚实的数学理论带来了挑战。为了克服这一不确定性，我们需要一个更严格、不依赖于样本点选择的框架。本文旨在填补这一知识空白，深入[黎曼可积性](@entry_id:183965)的核心。

我们将从“原理与机制”一章开始，引入由Gaston Darboux提出的[上和与下和](@entry_id:146229)概念，以此为基础建立起判断函数是否可积的精确判据。随后，在“应用与跨学科联系”一章中，我们将运用这些理论工具来处理各种函数，包括那些带有有限甚至无穷不连续点的函数，并探讨[黎曼积分](@entry_id:142508)与数学分析其他分支及计算科学等领域的深刻联系。最后，在“动手实践”部分，你将通过解决具体问题来巩固所学知识。通过这个学习路径，你将对黎曼积分的理论边界及其在不同情境下的实际意义获得一个完整而深刻的理解。

## 原理与机制

在上一章中，我们通过熟悉的[黎曼和](@entry_id:137667)概念初步接触了[定积分](@entry_id:147612)。然而，[黎曼和](@entry_id:137667)的定义依赖于在每个子区间中任意选择的样本点 $c_i$，这给理论的严谨性带来了一定的挑战。为了构建一个不依赖于样本点选择的更坚实的理论基础，我们引入由数学家 Gaston Darboux 提出的一个等价但更具结构性的方法。本章旨在深入探讨[黎曼可积性](@entry_id:183965)的核心原理与机制，从 Darboux 和的定义出发，建立起判断函数是否可积的有力判据，并运用这些判据来证明几类重要函数的[可积性](@entry_id:142415)。

### Darboux [上和与下和](@entry_id:146229)：将面积“框定”

考虑一个定义在闭区间 $[a, b]$ 上的[有界函数](@entry_id:176803) $f$。一个区间 $[a, b]$ 的**划分 (partition)** $P$ 是一个有限点集 $\{x_0, x_1, \dots, x_n\}$，满足 $a = x_0  x_1  \dots  x_n = b$。这个划分将 $[a, b]$ 分割成 $n$ 个子区间 $I_i = [x_{i-1}, x_i]$，其长度为 $\Delta x_i = x_i - x_{i-1}$。

由于 $f$ 在 $[a, b]$ 上是有界的，它在每个子区间 $I_i$ 上也必然是有界的。因此，我们可以定义 $f$ 在 $I_i$ 上的**[下确界](@entry_id:140118) (infimum)** 和**[上确界](@entry_id:140512) (supremum)**：
$$
m_i = \inf_{x \in I_i} f(x)
$$
$$
M_i = \sup_{x \in I_i} f(x)
$$

这些值代表了函数在子区间 $I_i$ 上的“谷底”和“峰顶”。基于此，我们定义对应于划分 $P$ 的**下和 (lower Darboux sum)** $L(P, f)$ 与**上和 (upper Darboux sum)** $U(P, f)$：
$$
L(P, f) = \sum_{i=1}^{n} m_i \Delta x_i
$$
$$
U(P, f) = \sum_{i=1}^{n} M_i \Delta x_i
$$

直观上，$L(P, f)$ 是由一系列矩形构成的面积之和，每个矩形的高度是函数在对应子区间上的最小值。因此，下和给出了函数图像下方区域面积的一个下界。同理，$U(P, f)$ 是由一系列以函数在子区间上的最大值为高的矩形构成的面[积之和](@entry_id:266697)，它给出了该面积的一个上界。对于任何[黎曼和](@entry_id:137667) $S(P, f, \{c_i\}) = \sum f(c_i) \Delta x_i$，其中 $c_i \in I_i$，显然都成立 $L(P, f) \le S(P, f, \{c_i\}) \le U(P, f)$。Darboux 和的优势在于，它们完全由函数 $f$ 和划分 $P$ 决定，消除了样本点选择的任意性。

### 上积分与下积分：对面积的终极“挤压”

当我们向一个划分 $P$ 中添加更多的点，得到一个更精细的划分 $P'$ 时，可以观察到一个重要的性质：下和不会减少，而上和不会增加。即 $L(P, f) \le L(P', f)$ 且 $U(P', f) \le U(P, f)$。这表明，随着划分越来越精细，下和构成的集合向上“[蠕变](@entry_id:150410)”，而上和构成的集合向下“收缩”。

更进一步，对于任意两个划分 $P_1$ 和 $P_2$，总有 $L(P_1, f) \le U(P_2, f)$。这意味着所有下和的集合完全位于所有上和的集合的左侧（或与之接触）。这个事实保证了以下两个定义的合理性：

**下积分 (lower Riemann integral)** 被定义为所有下和的[上确界](@entry_id:140512)：
$$
\underline{\int_a^b} f(x) \,dx = \sup_{P} L(P, f)
$$

**上积分 (upper Riemann integral)** 被定义为所有上和的[下确界](@entry_id:140118)：
$$
\overline{\int_a^b} f(x) \,dx = \inf_{P} U(P, f)
$$

由 $L(P_1, f) \le U(P_2, f)$ 可知，总有 $\underline{\int_a^b} f(x) \,dx \le \overline{\int_a^b} f(x) \,dx$。这两个值代表了通过所有可能的划分方式，从下方和上方对“真实面积”进行的最精确的估计。

现在，我们可以给出[黎曼可积性](@entry_id:183965)的正式定义：一个[有界函数](@entry_id:176803) $f$ 在 $[a, b]$ 上是**黎曼可积的 (Riemann integrable)**，当且仅当其下积分等于上积分。这个共同的值就被定义为 $f$ 在 $[a, b]$ 上的**黎曼积分 (Riemann integral)**，记为：
$$
\int_a^b f(x) \,dx = \underline{\int_a^b} f(x) \,dx = \overline{\int_a^b} f(x) \,dx
$$

这个定义的美妙之处在于它为我们提供了一个清晰的判断标准：如果从下方逼近的极限与从上方逼近的极限重合，那么函数就是可积的。反之，如果两者之间存在一个不可逾越的鸿沟，则函数不可积。

一个经典的不[可积函数](@entry_id:191199)是[狄利克雷函数](@entry_id:140770)（Dirichlet function）[@problem_id:1450121]。考虑在 $[0, \pi]$ 上定义的函数：
$$
f(x) = \begin{cases} 5  \text{若 } x \in \mathbb{Q} \\ 2  \text{若 } x \notin \mathbb{Q} \end{cases}
$$
由于[有理数和无理数](@entry_id:173349)在[实数轴](@entry_id:147286)上都是稠密的，所以在任何长度不为零的子区间 $[x_{i-1}, x_i]$ 中，总能找到[有理数和无理数](@entry_id:173349)。因此，对于任意划分 $P$，我们总有 $m_i = 2$ 和 $M_i = 5$。这意味着对于任何划分 $P$，$L(P, f) = \sum 2 \Delta x_i = 2( \pi - 0) = 2\pi$，$U(P, f) = \sum 5 \Delta x_i = 5\pi$。因此，下积分是 $2\pi$，而上积分是 $5\pi$。由于 $2\pi \neq 5\pi$，该函数在 $[0, \pi]$ 上不是黎曼可积的。

另一个富有启发性的例子是定义在 $[0, 2]$ 上的函数 [@problem_id:1338647]：
$$
f(x) = \begin{cases} x  \text{若 } x \in \mathbb{Q} \\ 0  \text{若 } x \notin \mathbb{Q} \end{cases}
$$
对于任意包含在 $[0, 2]$ 中的子区间 $I_k$，由于[无理数的稠密性](@entry_id:141762)，总有 $m_k = \inf_{x \in I_k} f(x) = 0$。因此，对于任何划分 $P$，下和 $L(P, f)$ 始终为 0，从而下积分为 $\underline{\int_0^2} f(x) \,dx = 0$。然而，由于有理数的稠密性，$M_k = \sup_{x \in I_k} f(x)$ 将接近于该子区间的右端点值。对于一个将 $[0, 2]$ 分为 $n$ 等份的划分 $P_n$，可以计算出上和为 $U(P_n, f) = 2 + \frac{2}{n}$。当 $n \to \infty$ 时，上和趋近于 2。上积分作为所有上和的下确界，其值为 2。由于 $\underline{\int_0^2} f(x) \,dx = 0 \neq 2 = \overline{\int_0^2} f(x) \,dx$，该函数同样不是黎曼可积的。

### [黎曼可积性判据](@entry_id:161334)

直接计算上下积分来判断[可积性](@entry_id:142415)通常是繁琐的。幸运的是，有一个等价且在实践中更为有用的判据，它被称为**黎曼-Darboux 判据**。

**定理 ([黎曼可积性判据](@entry_id:161334)):** 一个在 $[a, b]$ 上的[有界函数](@entry_id:176803) $f$ 是黎曼可积的，当且仅当对于任意给定的 $\epsilon  0$，都存在一个划分 $P$，使得
$$
U(P, f) - L(P, f)  \epsilon
$$

这个判据的几何意义非常直观：$U(P, f) - L(P, f) = \sum_{i=1}^{n} (M_i - m_i) \Delta x_i$ 表示的是上矩形和下矩形所围成的“不确定区域”的总面积。可积性意味着，我们可以通过选择足够精细的划分，使得这个不确定区域的总面积变得任意小。

这个判据与一个关于划分序列的结论紧密相关 [@problem_id:1450083]。如果我们有一个划分序列 $\{P_n\}$，其**网格尺寸 (mesh)** $|P_n| = \max_i \Delta x_{i,n}$ 趋向于 0，那么函数 $f$ 可积的充分必要条件是 $\lim_{n \to \infty} [U(P_n, f) - L(P_n, f)] = 0$。

### 重要的[可积函数](@entry_id:191199)类

[黎曼判据](@entry_id:142731)的强大之处在于，它使我们能够轻松地证明几类重要函数是可积的。

#### [连续函数](@entry_id:137361)

如果一个函数 $f$ 在[闭区间](@entry_id:136474) $[a, b]$ 上连续，那么它在该区间上是**一致连续的 (uniformly continuous)**。这意味着对于任意 $\epsilon'  0$，存在一个 $\delta  0$，使得只要 $|x-y|  \delta$，就有 $|f(x)-f(y)|  \epsilon'$。

为了证明[连续函数](@entry_id:137361)是可积的，我们给定任意 $\epsilon  0$。取 $\epsilon' = \frac{\epsilon}{b-a}$，由[一致连续性](@entry_id:140948)，我们找到对应的 $\delta$。现在，选取一个划分 $P$，使其网格尺寸 $|P|  \delta$。在每个子区间 $I_i$ 上，由于其长度 $\Delta x_i  \delta$，函数值在该区间上的振幅 $M_i - m_i \le \epsilon' = \frac{\epsilon}{b-a}$。因此，
$$
U(P, f) - L(P, f) = \sum_{i=1}^{n} (M_i - m_i) \Delta x_i \le \sum_{i=1}^{n} \frac{\epsilon}{b-a} \Delta x_i = \frac{\epsilon}{b-a} \sum_{i=1}^{n} \Delta x_i = \frac{\epsilon}{b-a} (b-a) = \epsilon
$$
根据[黎曼判据](@entry_id:142731)，这证明了所有在闭区间上的[连续函数](@entry_id:137361)都是黎曼可积的。

例如，考虑函数 $f(x)=x^2$ 在 $[0, 1]$ 上 [@problem_id:1338631]。这是一个[连续函数](@entry_id:137361)，因此是可积的。如果我们用一个等分 $n$ 个子[区间的划分](@entry_id:138440) $P_n$，可以精确计算出 $U(P_n, f) - L(P_n, f) = \frac{1}{n}$。若要使这个差值小于 $0.1$，我们只需令 $\frac{1}{n}  0.1$，即 $n  10$。满足此条件的最小正整数 $n$ 是 $11$。这具体地展示了我们可以通过增加划分的精细度来任意压缩不确定区域的面积。

#### [单调函数](@entry_id:145115)

在闭区间 $[a, b]$ 上的[单调函数](@entry_id:145115)也是黎曼可积的。为简单起见，我们假设 $f$ 是非减函数。我们采用一个将 $[a, b]$ 等分为 $n$ 份的均匀划分 $P_n$，每个子区间的长度为 $\Delta x = \frac{b-a}{n}$。

由于 $f$ 是非减的，在任何子区间 $I_i = [x_{i-1}, x_i]$ 上，函数的最小值在左端点取到，$m_i = f(x_{i-1})$，最大值在右端点取到，$M_i = f(x_i)$。于是，我们有 [@problem_id:1338622]：
$$
U(P_n, f) - L(P_n, f) = \sum_{i=1}^{n} (M_i - m_i) \Delta x = \Delta x \sum_{i=1}^{n} (f(x_i) - f(x_{i-1}))
$$
右侧的和是一个**伸缩和 (telescoping sum)**：
$$
\sum_{i=1}^{n} (f(x_i) - f(x_{i-1})) = (f(x_1)-f(x_0)) + (f(x_2)-f(x_1)) + \dots + (f(x_n)-f(x_{n-1})) = f(x_n) - f(x_0) = f(b) - f(a)
$$
因此，差值被简化为一个优美的表达式：
$$
U(P_n, f) - L(P_n, f) = \frac{b-a}{n} (f(b) - f(a))
$$
当 $n \to \infty$ 时，这个差值显然趋向于 0。因此，对于任意 $\epsilon  0$，我们总能找到一个足够大的 $n$ 使得该差值小于 $\epsilon$。故所有在闭区间上的单调函数都是黎曼可积的。

#### Lipschitz [连续函数](@entry_id:137361)

一个更广泛的函数类别是 **Lipschitz [连续函数](@entry_id:137361)**。如果存在一个常数 $K  0$ 使得对于区间内任意两点 $x, y$，都有 $|f(x) - f(y)| \le K|x-y|$，那么函数 $f$ 就是 Lipschitz 连续的。

这个性质对[函数的振幅](@entry_id:160674)提供了强有力的控制。在任何长度为 $\Delta x_i$ 的子区间 $I_i$ 上，[函数的振幅](@entry_id:160674) $M_i - m_i = \sup_{x, y \in I_i} |f(x)-f(y)| \le K \sup_{x,y \in I_i} |x-y| = K \Delta x_i$。对于一个均匀划分 $P_n$（$\Delta x = \frac{b-a}{n}$），我们有：
$$
U(P_n, f) - L(P_n, f) = \sum_{i=1}^{n} (M_i - m_i) \Delta x \le \sum_{i=1}^{n} (K \Delta x) \Delta x = K n (\Delta x)^2 = K n \left(\frac{b-a}{n}\right)^2 = \frac{K(b-a)^2}{n}
$$
当 $n \to \infty$ 时，这个上界也趋向于 0，因此所有 Lipschitz [连续函数](@entry_id:137361)都是黎曼可积的。例如，对于函数 $f(x) = \frac{1}{1+x^2}$ 在 $[-2, 2]$ 上 [@problem_id:1338627]，我们可以通过计算其导数的[上界](@entry_id:274738)来找到一个 Lipschitz 常数 $K$。然后，利用上述不等式，可以确定需要多少个子区间才能保证[上和与下和](@entry_id:146229)之差小于某个给定的阈值（如 $0.01$），这为[数值积分](@entry_id:136578)的[误差控制](@entry_id:169753)提供了理论依据。

### [可积函数](@entry_id:191199)的代数性质

[黎曼可积函数](@entry_id:160745)的集合具有良好的[代数结构](@entry_id:137052)，它在加法、数乘和乘法运算下是封闭的。

-   **和与[数乘](@entry_id:155971):** 如果 $f$ 和 $g$ 在 $[a, b]$ 上可积，那么它们的和 $f+g$ 以及数乘 $cf$（$c$ 为常数）也是可积的。证明 $f+g$ 的可积性依赖于[上确界](@entry_id:140512)和下确界的基本性质。在任何子区间 $I_i$ 上，有 $M_i(f+g) \le M_i(f) + M_i(g)$ 和 $m_i(f+g) \ge m_i(f) + m_i(g)$。这导致振幅之间有关系 $\omega_i(f+g) \le \omega_i(f) + \omega_i(g)$（其中 $\omega_i(h) = M_i(h)-m_i(h)$）。从而，
    $$
    U(P, f+g) - L(P, f+g) \le [U(P, f) - L(P, f)] + [U(P, g) - L(P, g)]
    $$
    [@problem_id:1338648] 中的一个数值算例清晰地展示了这一上界关系。由于 $f$ 和 $g$ 都可积，我们可以让右边的两项之和变得任意小，从而左边也必须能变得任意小。

-   **乘积:** 如果 $f$ 和 $g$ 可积，那么它们的乘积 $fg$ 也是可积的。证明这个结论的一个标准途径是先证明若 $f$ 可积，则 $f^2$ 也可积。这可以通过[控制函数](@entry_id:183140) $f^2$ 的振幅来实现。对于[有界函数](@entry_id:176803) $f$（设 $|f(x)| \le M$），可以证明在任何子区间 $I$ 上，振幅满足不等式 [@problem_id:1338638]：
    $$
    \omega(f^2, I) \le 2M \cdot \omega(f, I)
    $$
    于是 $U(P, f^2) - L(P, f^2) \le 2M [U(P, f) - L(P, f)]$。因为 $f$ 可积，方括号中的项可以任意小，所以 $f^2$ 满足[黎曼判据](@entry_id:142731)。然后，利用[极化恒等式](@entry_id:271819) $fg = \frac{1}{4}((f+g)^2 - (f-g)^2)$，结合前面已证的关于和、差、平方及[数乘](@entry_id:155971)的封闭性，即可证明 $fg$ 的[可积性](@entry_id:142415)。

-   **复合:** 关于[可积函数](@entry_id:191199)的复合，有一个重要的定理：若 $f: [a,b] \to [c,d]$ 是黎曼可积的，且 $\phi: [c,d] \to \mathbb{R}$ 是连续的，则[复合函数](@entry_id:147347) $\phi \circ f$ 在 $[a,b]$ 上也是黎曼可积的。例如，在问题 [@problem_id:2328185] 中，函数 $f(x)$ 是一个在 $(0, 1]$ 上分段常数的阶梯函数，它在 $[0, 1]$ 上是单调的，因此可积。函数 $\phi(y)=1+y$ 是连续的。根据该定理，复合函数 $g(x) = (\phi \circ f)(x) = 1+f(x)$ 必然是可积的，这为我们直接计算其积分值提供了合法性。

### 最终判据：Lebesgue 定理

我们已经看到，[连续函数](@entry_id:137361)和[单调函数](@entry_id:145115)都是可积的。这些函数的[不连续点集](@entry_id:160308)合要么是空的，要么最多是可数的。这引出了一个深刻的问题：一个[有界函数](@entry_id:176803)黎曼可积的充要条件究竟是什么？答案由 Henri Lebesgue 给出，它将[黎曼积分](@entry_id:142508)与现代[测度论](@entry_id:139744)联系起来。

为了陈述这个定理，我们需要**点态振幅 (oscillation at a point)** 的概念。函数 $f$ 在点 $x_0$ 的振幅定义为：
$$
\omega_f(x_0) = \lim_{\delta \to 0^+} \sup_{x, y \in (x_0-\delta, x_0+\delta) \cap [a,b]} |f(x) - f(y)|
$$
一个函数在 $x_0$ 点连续的充要条件是 $\omega_f(x_0) = 0$。

**定理 (Lebesgue [黎曼可积性判据](@entry_id:161334)):** 一个在 $[a, b]$ 上的[有界函数](@entry_id:176803) $f$ 是黎曼可积的，当且仅当其[不连续点集](@entry_id:160308)合的**勒贝格测度 (Lebesgue measure)** 为零。

对于本科阶段，我们可以将“[测度为零](@entry_id:137864)”直观地理解为：一个点集 $S$ 的测度为零，如果对于任意 $\epsilon  0$，我们都可以用一列可数的[开区间](@entry_id:157577)来覆盖 $S$，并且这些[开区间](@entry_id:157577)的总长度可以小于 $\epsilon$。

-   有限点集的测度为零。
-   可数点集（如区间内的有理数集 $\mathbb{Q} \cap [a, b]$，或点集 $\{1/n : n \in \mathbb{N}\}$）的测度也为零。

这个强大的判据统一并推广了我们之前所有的结果：
-   [连续函数](@entry_id:137361)：[不连续点集](@entry_id:160308)为[空集](@entry_id:261946)，测度为零，故可积。
-   单调函数：[不连续点集](@entry_id:160308)至多是可数的，测度为零，故可积。
-   [狄利克雷函数](@entry_id:140770) [@problem_id:1450121]：在区间内处处不连续，[不连续点集](@entry_id:160308)的测度等于区间的长度，不为零，故不可积。
-   考虑在 $[0, 1]$ 上的函数 [@problem_id:1338614]，它在点集 $\{1/n : n \in \mathbb{N}\}$ 处被修改，而在其他地方等于一个[连续函数](@entry_id:137361) $\cos(\pi x/2)$。该函数的[不连续点集](@entry_id:160308)至多是 $\{1/n : n \in \mathbb{N}\} \cup \{0\}$，这是一个[可数集](@entry_id:138676)，其[测度为零](@entry_id:137864)。因此，根据 Lebesgue 定理，该函数是黎曼可积的。

此外，一个重要的推论是：如果两个函数仅在一个[测度为零](@entry_id:137864)的集合上取值不同，那么它们的积分（如果存在）是相等的。这极大地简化了计算。对于 [@problem_id:1338614] 中的函数 $f$，由于它只在测度为零的可数点集上与[连续函数](@entry_id:137361) $g(x) = \cos(\pi x/2)$ 不同，它们的积分值是相同的：
$$
\int_0^1 f(x) \,dx = \int_0^1 \cos\left(\frac{\pi x}{2}\right) \,dx = \left[\frac{2}{\pi} \sin\left(\frac{\pi x}{2}\right)\right]_0^1 = \frac{2}{\pi}
$$
Lebesgue 判据为我们理解黎曼积分的边界提供了最终的视角，清晰地界定了哪些类型的“不规则”行为是积分过程可以容忍的。