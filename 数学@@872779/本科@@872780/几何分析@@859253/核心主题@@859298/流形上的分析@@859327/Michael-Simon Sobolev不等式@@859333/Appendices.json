{"hands_on_practices": [{"introduction": "这第一个练习介绍了一种强大的物理推理工具——量纲分析。我们无需深入复杂的证明，只需通过要求不等式在尺度变换下保持一致，便可以推导出不等式中各指数之间的关键关系。这个练习有助于建立关于不等式为何具有其特定形式的直觉，并展示了数学物理和几何学中一种通用的问题解决方法。", "problem": "设 $M^{m}$ 是一个浸入在 $\\mathbb{R}^{m+1}$ 中的光滑、紧致、无边的超曲面，具有诱导黎曼度量和平均曲率 $H$。设 $u \\in C^{1}(M)$ 和 $p \\in [1,m)$ 是固定的。Michael–Simon Sobolev 不等式的一个版本断言，存在一个常数 $C = C(m,p)$，使得对于一个依赖于 $m$ 和 $p$ 的合适指数 $q$，形如下式的不等式成立：\n$$\n\\|u\\|_{L^{q}(M)} \\leq C \\left( \\|\\nabla_{M} u\\|_{L^{p}(M)} + \\|H u\\|_{L^{p}(M)} \\right)\n$$\n仅使用基于 $\\mathbb{R}^{m+1}$ 中超曲面的诱导几何的尺度变换考虑，以及该不等式在欧几里得伸缩变换下需保持一致的要求，确定当 $p \\in [1,m)$ 时，能使该界在量纲上保持一致的 $q$ 值（用 $m$ 和 $p$ 表示）。然后，将您的表达式具体化到 $m = 3$ 和 $p = 2$ 的情况，并计算 $q$ 的数值。只提供 $q$ 的值作为最终答案。无需四舍五入。", "solution": "问题要求通过确保不等式在欧几里得伸缩变换下量纲一致，来确定 Michael–Simon Sobolev 不等式中的指数 $q$。给定的不等式是关于光滑、紧致、无边超曲面 $M^{m} \\subset \\mathbb{R}^{m+1}$ 上的函数 $u \\in C^{1}(M)$ 的范数关系式：\n$$\n\\|u\\|_{L^{q}(M)} \\leq C \\left( \\|\\nabla_{M} u\\|_{L^{p}(M)} + \\|H u\\|_{L^{p}(M)} \\right)\n$$\n其中 $p \\in [1,m)$，$H$ 是 $M$ 的平均曲率，$C$ 是一个仅依赖于 $m$ 和 $p$ 的常数。\n\n我们考虑对环境欧几里得空间 $\\mathbb{R}^{m+1}$ 进行一个因子为 $\\lambda > 0$ 的均匀尺度变换（伸缩）。任意点 $x \\in \\mathbb{R}^{m+1}$ 被映射到 $\\tilde{x} = \\lambda x$。这个变换将超曲面 $M$ 映射到一个新的超曲面 $\\tilde{M} = \\{ \\lambda x \\mid x \\in M \\}$。我们必须确定在该尺度变换下，不等式中的每一项是如何变换的。\n\n设 $g$ 是 $M$ 上的诱导黎曼度量。伸缩变换将切向量 $v \\in T_x M$ 映射到 $\\lambda v \\in T_{\\lambda x} \\tilde{M}$。$\\tilde{M}$ 上的诱导度量 $\\tilde{g}$ 与 $g$ 的关系为 $\\tilde{g}_{\\lambda x}(\\lambda v, \\lambda w) = \\langle \\lambda v, \\lambda w \\rangle = \\lambda^{2} \\langle v, w \\rangle = \\lambda^{2} g_x(v, w)$。因此，度量张量的尺度变换为 $\\tilde{g} = \\lambda^{2} g$。\n\n$\\tilde{M}$ 上的 $m$ 维体积元 $d\\tilde{V}$ 根据度量的行列式进行尺度变换。在局部坐标下，$d\\tilde{V} = \\sqrt{\\det(\\tilde{g})} \\, d\\text{coords} = \\sqrt{\\det(\\lambda^{2} g)} \\, d\\text{coords} = \\lambda^{m} \\sqrt{\\det(g)} \\, d\\text{coords} = \\lambda^{m} dV$。所以，我们有尺度变换关系 $d\\tilde{V} = \\lambda^{m} dV$。\n\n$M$ 上的函数 $u$ 对应于 $\\tilde{M}$ 上的函数 $\\tilde{u}$，由标量不变条件 $\\tilde{u}(\\tilde{x}) = u(x)$ 定义，其中 $\\tilde{x} = \\lambda x$。\n\n梯度算子 $\\nabla_{M}$ 按长度的倒数进行尺度变换。梯度的范数平方为 $|\\nabla_{M} u|^{2}_{g} = g^{ij} (\\partial_i u)(\\partial_j u)$。在尺度变换下，逆度量变换为 $\\tilde{g}^{ij} = \\lambda^{-2} g^{ij}$。$\\tilde{u}$ 对于同一局部坐标系的偏导数保持不变，即 $\\partial_i \\tilde{u} = \\partial_i u$。因此， $|\\nabla_{\\tilde{M}} \\tilde{u}|^{2}_{\\tilde{g}} = \\tilde{g}^{ij} (\\partial_i \\tilde{u})(\\partial_j \\tilde{u}) = \\lambda^{-2} g^{ij} (\\partial_i u)(\\partial_j u) = \\lambda^{-2} |\\nabla_{M} u|^{2}_{g}$。两边开方，我们得到 $|\\nabla_{\\tilde{M}} \\tilde{u}|_{\\tilde{g}} = \\lambda^{-1} |\\nabla_{M} u|_{g}$。\n\n平均曲率 $H$ 是主曲率之和，其量纲是长度的倒数。在一个因子为 $\\lambda$ 的伸缩变换下，一个半径为 $R$ 的球面变成一个半径为 $\\lambda R$ 的球面，其曲率从 $1/R$ 变为 $1/(\\lambda R)$。因此，曲率按长度的倒数进行尺度变换。$\\tilde{M}$ 在 $\\tilde{x}$ 点的平均曲率与 $M$ 在 $x$ 点的平均曲率的关系为 $\\tilde{H} = \\lambda^{-1} H$。\n\n现在我们分析不等式中每个 $L^{p}$ 范数的尺度变换。\n左边（LHS）是 $\\|u\\|_{L^{q}(M)}$。对于经过尺度变换的曲面 $\\tilde{M}$，这一项变为：\n$$\n\\|\\tilde{u}\\|_{L^{q}(\\tilde{M})} = \\left( \\int_{\\tilde{M}} |\\tilde{u}|^{q} \\, d\\tilde{V} \\right)^{1/q} = \\left( \\int_{M} |u|^{q} \\, (\\lambda^{m} dV) \\right)^{1/q} = \\lambda^{m/q} \\left( \\int_{M} |u|^{q} \\, dV \\right)^{1/q} = \\lambda^{m/q} \\|u\\|_{L^{q}(M)}\n$$\n\n右边（RHS）的项是 $\\|\\nabla_{M} u\\|_{L^{p}(M)}$ 和 $\\|H u\\|_{L^{p}(M)}$。对于经过尺度变换的曲面 $\\tilde{M}$，第一项变为：\n$$\n\\|\\nabla_{\\tilde{M}} \\tilde{u}\\|_{L^{p}(\\tilde{M})} = \\left( \\int_{\\tilde{M}} |\\nabla_{\\tilde{M}} \\tilde{u}|^{p} \\, d\\tilde{V} \\right)^{1/p} = \\left( \\int_{M} (\\lambda^{-1} |\\nabla_{M} u|)^{p} \\, (\\lambda^{m} dV) \\right)^{1/p} = \\left( \\lambda^{m-p} \\int_{M} |\\nabla_{M} u|^{p} \\, dV \\right)^{1/p} = \\lambda^{\\frac{m-p}{p}} \\|\\nabla_{M} u\\|_{L^{p}(M)}\n$$\nRHS 上的第二项进行类似的尺度变换：\n$$\n\\|\\tilde{H} \\tilde{u}\\|_{L^{p}(\\tilde{M})} = \\left( \\int_{\\tilde{M}} |\\tilde{H} \\tilde{u}|^{p} \\, d\\tilde{V} \\right)^{1/p} = \\left( \\int_{M} |(\\lambda^{-1} H) u|^{p} \\, (\\lambda^{m} dV) \\right)^{1/p} = \\left( \\lambda^{m-p} \\int_{M} |H u|^{p} \\, dV \\right)^{1/p} = \\lambda^{\\frac{m-p}{p}} \\|H u\\|_{L^{p}(M)}\n$$\n注意 RHS 上的两项有相同的尺度变换因子 $\\lambda^{\\frac{m}{p} - 1}$。\n\n应用于经过尺度变换的曲面 $\\tilde{M}$ 的不等式是：\n$$\n\\|\\tilde{u}\\|_{L^{q}(\\tilde{M})} \\leq C \\left( \\|\\nabla_{\\tilde{M}} \\tilde{u}\\|_{L^{p}(\\tilde{M})} + \\|\\tilde{H} \\tilde{u}\\|_{L^{p}(\\tilde{M})} \\right)\n$$\n代入尺度变换行为，我们得到：\n$$\n\\lambda^{m/q} \\|u\\|_{L^{q}(M)} \\leq C \\left( \\lambda^{\\frac{m}{p} - 1} \\|\\nabla_{M} u\\|_{L^{p}(M)} + \\lambda^{\\frac{m}{p} - 1} \\|H u\\|_{L^{p}(M)} \\right)\n$$\n$$\n\\lambda^{m/q} \\|u\\|_{L^{q}(M)} \\leq C \\lambda^{\\frac{m}{p} - 1} \\left( \\|\\nabla_{M} u\\|_{L^{p}(M)} + \\|H u\\|_{L^{p}(M)} \\right)\n$$\n为使此不等式对所有 $\\lambda > 0$ 保持一致，两边的尺度变换因子必须相同。常数 $C$ 与 $\\lambda$ 无关。因此，我们必须令 $\\lambda$ 的指数相等：\n$$\n\\frac{m}{q} = \\frac{m}{p} - 1\n$$\n这个方程关联了指数 $q$、$p$ 和维数 $m$。我们可以解出 $q$。首先，我们可以通过两边除以 $m$ 将方程重写为一个更熟悉的形式：\n$$\n\\frac{1}{q} = \\frac{1}{p} - \\frac{1}{m}\n$$\n这是 Sobolev 共轭指数的特征关系式。解出 $q$：\n$$\n\\frac{1}{q} = \\frac{m-p}{mp} \\implies q = \\frac{mp}{m-p}\n$$\n问题指定 $p \\in [1, m)$，这确保了分母 $m-p$ 是正数且非零，因此 $q$ 是良定义且为正的。\n\n最后一步是计算在超曲面维数为 $m=3$ 且指数为 $p=2$ 的特定情况下的 $q$ 的数值。我们验证条件 $p \\in [1,m)$：$2 \\in [1,3)$，该条件成立。\n将这些值代入我们推导出的 $q$ 的表达式中：\n$$\nq = \\frac{3 \\times 2}{3 - 2} = \\frac{6}{1} = 6\n$$\n因此，对于 $\\mathbb{R}^{4}$ 中的一个3维超曲面，相应的 Sobolev 指数是 $q=6$。", "answer": "$$\n\\boxed{6}\n$$", "id": "3072468"}, {"introduction": "理论上的不等式在应用于具体例子时往往会焕发新的生命。这个练习将抽象的Sobolev型不等式“拉回地面”，通过在一个简单的平坦圆盘上进行检验。通过处理一个特定的函数族，你将执行涉及面积分和边界积分的显式计算，从而凸显边界在分析中扮演的关键角色。这个练习能提升你的微积分技巧，并让你对不等式中不同项如何相互作用有一个切实的理解。", "problem": "令 $D_{R} \\subset \\mathbb{R}^{2}$ 表示以原点为中心、半径为 $R>0$ 的开圆盘。考虑由 $\\alpha \\in [0,1]$ 参数化的径向测试函数 $u_{\\alpha}:D_{R}\\to\\mathbb{R}$，其定义为\n$$\nu_{\\alpha}(x) \\;=\\; u_{\\alpha}(r) \\;=\\;\n\\begin{cases}\n1,  0 \\le r \\le \\dfrac{R}{2}, \\\\\n1 + m\\left(r-\\dfrac{R}{2}\\right),  \\dfrac{R}{2}  r \\le R,\n\\end{cases}\n\\quad\\text{其中}\\quad m \\;=\\; \\dfrac{2(\\alpha - 1)}{R},\n$$\n使得 $u_{\\alpha}(R)=\\alpha$。定义比率泛函\n$$\n\\mathcal{Q}(\\alpha) \\;=\\; \\dfrac{\\left(\\displaystyle\\int_{D_{R}} |u_{\\alpha}|^{2} \\, dx\\right)^{1/2}}{\\displaystyle\\int_{D_{R}} |\\nabla u_{\\alpha}| \\, dx \\;+\\; \\int_{\\partial D_{R}} |u_{\\alpha}| \\, d\\sigma}.\n$$\n仅从 $\\mathbb{R}^{2}$ 中极坐标的定义、径向函数的梯度表达式以及标准的面积元和弧长元出发，计算 $\\displaystyle\\sup_{\\alpha\\in[0,1]} \\mathcal{Q}(\\alpha)$ 的一个仅用 $\\pi$ 表示的显式闭式表达式。提供精确值；无需四舍五入。", "solution": "该问题是有效的，因为它是数学上适定的、自洽的，并且基于微积分和分析的标准原理。它要求计算给定单参数函数族的积分比率的上确界，这是一个标准的极值问题。\n\n该问题要求计算 $\\displaystyle\\sup_{\\alpha\\in[0,1]} \\mathcal{Q}(\\alpha)$，其中泛函 $\\mathcal{Q}(\\alpha)$ 定义为\n$$\n\\mathcal{Q}(\\alpha) = \\dfrac{\\left(\\displaystyle\\int_{D_{R}} |u_{\\alpha}|^{2} \\, dx\\right)^{1/2}}{\\displaystyle\\int_{D_{R}} |\\nabla u_{\\alpha}| \\, dx \\;+\\; \\int_{\\partial D_{R}} |u_{\\alpha}| \\, d\\sigma}.\n$$\n函数 $u_\\alpha$ 是在半径为 $R>0$ 的圆盘 $D_R \\subset \\mathbb{R}^2$ 上径向定义的。使用极坐标 $(r, \\theta)$ 更为方便，其中 $x = (r\\cos\\theta, r\\sin\\theta)$。面积元为 $dx = r\\,dr\\,d\\theta$，其中 $0 \\le r \\le R$ 且 $0 \\le \\theta  2\\pi$。在边界 $\\partial D_R$ 上（其中 $r=R$），弧长元为 $d\\sigma = R\\,d\\theta$。\n\n对于一个径向函数 $u(r)$，其梯度为 $\\nabla u = u'(r)\\hat{r}$，其中 $\\hat{r}$ 是单位径向向量。因此，其模为 $|\\nabla u(x)| = |u'(r)|$。\n\n我们来计算构成 $\\mathcal{Q}(\\alpha)$ 的三个积分。\n\n首先，我们计算分子项 $N(\\alpha) = \\left(\\displaystyle\\int_{D_R} |u_\\alpha|^2 \\, dx\\right)^{1/2}$。由于当 $\\alpha \\in [0,1]$ 时 $u_\\alpha$ 是非负的，我们有 $|u_\\alpha|=u_\\alpha$。\n$$\nN(\\alpha)^2 = \\int_{D_R} u_\\alpha^2 \\, dx = \\int_0^{2\\pi} \\int_0^R u_\\alpha(r)^2 r \\, dr \\, d\\theta = 2\\pi \\int_0^R u_\\alpha(r)^2 r \\, dr.\n$$\n我们根据 $u_\\alpha(r)$ 的定义将径向积分分开：\n$$\n\\int_0^R u_\\alpha(r)^2 r \\, dr = \\int_0^{R/2} 1^2 \\cdot r \\, dr + \\int_{R/2}^R \\left[1 + m\\left(r-\\frac{R}{2}\\right)\\right]^2 r \\, dr,\n$$\n其中 $m = \\frac{2(\\alpha-1)}{R}$。第一个积分易得 $\\int_0^{R/2} r \\, dr = \\frac{R^2}{8}$。第二个积分是对 $r$ 的多项式进行积分，虽然计算步骤较多，但可以直接算出。将两部分积分结果相加，经过整理可得总的径向积分为：\n$$\n\\int_0^R u_\\alpha(r)^2 r \\, dr = R^2 \\frac{7\\alpha^2 + 6\\alpha + 11}{48}\n$$\n因此，$N(\\alpha)^2 = 2\\pi \\left(R^2 \\frac{7\\alpha^2 + 6\\alpha + 11}{48}\\right) = \\pi R^2 \\frac{7\\alpha^2 + 6\\alpha + 11}{24}$。\n分子为 $N(\\alpha) = R \\sqrt{\\pi} \\sqrt{\\frac{7\\alpha^2 + 6\\alpha + 11}{24}}$。\n\n接下来，我们计算分母中的第一项，$D_1(\\alpha) = \\displaystyle\\int_{D_R} |\\nabla u_\\alpha| \\, dx$。\n导数 $u_\\alpha'(r)$ 在 $0  r  R/2$ 时为 $0$，在 $R/2  r  R$ 时为 $u_\\alpha'(r) = m = \\frac{2(\\alpha-1)}{R}$。\n由于 $\\alpha \\in [0,1]$，$m \\le 0$，所以 $|m| = -m = \\frac{2(1-\\alpha)}{R}$。\n该积分仅在环形区域 $A = \\{x \\in \\mathbb{R}^2 : R/2  |x|  R\\}$ 上非零。\n$$\nD_1(\\alpha) = \\int_A |m| \\, dx = |m| \\cdot \\text{Area}(A) = \\frac{2(1-\\alpha)}{R} \\cdot \\left(\\pi R^2 - \\pi\\left(\\frac{R}{2}\\right)^2\\right) = \\frac{2(1-\\alpha)}{R} \\cdot \\frac{3\\pi R^2}{4} = \\frac{3\\pi R}{2}(1-\\alpha).\n$$\n\n最后，我们计算分母中的第二项，$D_2(\\alpha) = \\displaystyle\\int_{\\partial D_R} |u_\\alpha| \\, d\\sigma$。\n在边界 $\\partial D_R$ 上，我们有 $r=R$，所以 $u_\\alpha(R)=\\alpha$。由于 $\\alpha \\in [0,1]$，$|u_\\alpha(R)| = \\alpha$。\n$$\nD_2(\\alpha) = \\int_{\\partial D_R} \\alpha \\, d\\sigma = \\alpha \\cdot \\text{Length}(\\partial D_R) = \\alpha (2\\pi R) = 2\\pi R \\alpha.\n$$\n\n现在，我们组合泛函 $\\mathcal{Q}(\\alpha)$。分母为：\n$D_1(\\alpha) + D_2(\\alpha) = \\frac{3\\pi R}{2}(1-\\alpha) + 2\\pi R \\alpha = \\pi R \\left(\\frac{3}{2} - \\frac{3}{2}\\alpha + 2\\alpha\\right) = \\pi R \\left(\\frac{3}{2} + \\frac{1}{2}\\alpha\\right) = \\frac{\\pi R}{2}(3+\\alpha)$。\n比率为：\n$$\n\\mathcal{Q}(\\alpha) = \\frac{R \\sqrt{\\pi} \\sqrt{\\frac{7\\alpha^2 + 6\\alpha + 11}{24}}}{\\frac{\\pi R}{2}(3+\\alpha)} = \\frac{2}{\\sqrt{\\pi}\\sqrt{24}} \\frac{\\sqrt{7\\alpha^2 + 6\\alpha + 11}}{3+\\alpha}.\n$$\n使用 $\\sqrt{24} = 2\\sqrt{6}$，我们简化常数因子：\n$$\n\\mathcal{Q}(\\alpha) = \\frac{2}{\\sqrt{\\pi}(2\\sqrt{6})} \\frac{\\sqrt{7\\alpha^2 + 6\\alpha + 11}}{3+\\alpha} = \\frac{1}{\\sqrt{6\\pi}} \\frac{\\sqrt{7\\alpha^2 + 6\\alpha + 11}}{3+\\alpha}.\n$$\n如预期的，$\\mathcal{Q}(\\alpha)$ 与半径 $R$ 无关。\n\n为了求出 $\\mathcal{Q}(\\alpha)$ 在 $\\alpha \\in [0,1]$ 上的上确界，由于 $\\mathcal{Q}(\\alpha) > 0$，我们可以求其平方的上确界。设 $g(\\alpha) = (\\mathcal{Q}(\\alpha)\\sqrt{6\\pi})^2$。\n$$\ng(\\alpha) = \\frac{7\\alpha^2 + 6\\alpha + 11}{(3+\\alpha)^2}.\n$$\n我们通过计算导数 $g'(\\alpha)$ 来找到临界点：\n$$\ng'(\\alpha) = \\frac{(14\\alpha+6)(3+\\alpha)^2 - (7\\alpha^2+6\\alpha+11) \\cdot 2(3+\\alpha)}{(3+\\alpha)^4} = \\frac{(14\\alpha+6)(3+\\alpha) - 2(7\\alpha^2+6\\alpha+11)}{(3+\\alpha)^3}.\n$$\n分子可简化为：\n$(14\\alpha^2 + 42\\alpha + 6\\alpha + 18) - (14\\alpha^2 + 12\\alpha + 22) = 14\\alpha^2 + 48\\alpha + 18 - 14\\alpha^2 - 12\\alpha - 22 = 36\\alpha-4$。\n所以，$g'(\\alpha) = \\frac{36\\alpha - 4}{(3+\\alpha)^3}$。\n令 $g'(\\alpha) = 0$ 可得 $36\\alpha-4=0$，解得 $\\alpha = \\frac{4}{36} = \\frac{1}{9}$。该临界点位于区间 $[0,1]$ 内。\n$g'(\\alpha)$ 的符号由 $36\\alpha-4$ 决定。当 $\\alpha  1/9$ 时，$g'(\\alpha)0$；当 $\\alpha > 1/9$ 时，$g'(\\alpha)>0$。这表明 $\\alpha=1/9$ 是一个局部最小值。\n\n根据极值定理，连续函数 $g(\\alpha)$ 在闭区间 $[0,1]$ 上的最大值必定出现在端点 $\\alpha=0$ 或 $\\alpha=1$ 处。\n我们计算 $g(\\alpha)$ 在这些端点处的值：\n对于 $\\alpha=0$：$g(0) = \\frac{11}{3^2} = \\frac{11}{9}$。\n对于 $\\alpha=1$：$g(1) = \\frac{7+6+11}{(3+1)^2} = \\frac{24}{16} = \\frac{3}{2}$。\n比较这两个值，$\\frac{3}{2} = 1.5$ 且 $\\frac{11}{9} \\approx 1.22$。$g(\\alpha)$ 在 $[0,1]$ 上的最大值是 $g(1) = \\frac{3}{2}$。\n\n因此，$\\mathcal{Q}(\\alpha)$ 的上确界是 $\\mathcal{Q}(1)$。\n$$\n\\sup_{\\alpha\\in[0,1]} \\mathcal{Q}(\\alpha) = \\mathcal{Q}(1) = \\frac{1}{\\sqrt{6\\pi}} \\sqrt{g(1)} = \\frac{1}{\\sqrt{6\\pi}} \\sqrt{\\frac{3}{2}}.\n$$\n简化该表达式：\n$$\n\\frac{1}{\\sqrt{6\\pi}} \\frac{\\sqrt{3}}{\\sqrt{2}} = \\frac{\\sqrt{3}}{\\sqrt{12\\pi}} = \\frac{\\sqrt{3}}{\\sqrt{4 \\cdot 3 \\cdot \\pi}} = \\frac{\\sqrt{3}}{2\\sqrt{3}\\sqrt{\\pi}} = \\frac{1}{2\\sqrt{\\pi}}.\n$$\n这就是所求的显式闭式表达式。", "answer": "$$\n\\boxed{\\frac{1}{2\\sqrt{\\pi}}}\n$$", "id": "3072416"}, {"introduction": "几何分析中的许多问题过于复杂，无法求得精确的解析解。本练习将介绍数值方法，将其作为探索和验证的重要工具。通过为一个非平凡的曲面实现平均曲率和其他几何量的公式，你将对这些概念获得实践性的理解，并看到Michael-Simon不等式的各项如何通过计算进行估算。这个练习弥合了理论公式与实际应用之间的鸿沟。", "problem": "您将为一个嵌入三维欧几里得空间中的二维曲面实现一个数值估计器，用于计算绝对平均曲率以及常被称为 Michael–Simon Sobolev 不等式的几何分析不等式中出现的核心积分。您将处理三维欧几里得空间中的一个简单三角函数图形，使用一个光滑的紧支撑测试函数，并构建不等式两边出现的相关积分量。所有角度必须以弧度处理。不涉及物理单位。\n\n考虑由参数化给出的图曲面，嵌入在三维欧几里得空间中\n$$\nX(x,y) = \\big(x,\\, y,\\, f(x,y)\\big), \\quad f(x,y) = A \\sin(k x)\\sin(\\ell y),\n$$\n对于参数 $A \\in \\mathbb{R}$，$k \\in \\mathbb{R}$，以及 $\\ell \\in \\mathbb{R}$。令参数域为开放正方形\n$$\nD = \\{(x,y) \\in \\mathbb{R}^2 : |x|  L,\\ |y|  L\\},\n$$\n其中 $L > 0$。定义一个光滑的紧支撑凸点函数 $\\varphi : \\mathbb{R} \\to \\mathbb{R}$\n$$\n\\varphi(t) =\n\\begin{cases}\n\\exp\\left(-\\dfrac{1}{1-(t/L)^2}\\right),  \\text{if } |t|  L, \\\\\n0,  \\text{if } |t| \\ge L,\n\\end{cases}\n$$\n并设置测试函数为\n$$\nu(x,y) = \\varphi(x)\\,\\varphi(y).\n$$\n您的任务是针对三组不同的参数集，计算以下五个与不等式相关的数值：\n1. $\\int_M u^2 d\\mu$\n2. $I_\\nabla = \\int_M \\|\\nabla_M u\\| d\\mu$\n3. $I_H = \\int_M |H| |u| d\\mu$\n4. $\\|u\\|_{L^2(M)} = (\\int_M u^2 d\\mu)^{1/2}$\n5. 比率 $R = \\|u\\|_{L^2(M)} / (I_\\nabla + I_H)$\n\n使用 $L=1.0$ 和 $N=301$ 的网格分辨率，对以下三组参数 $(A, k, \\ell)$ 进行计算：\na) $(0.2, 2\\pi, \\pi)$\nb) $(0.0, 0.0, 0.0)$\nc) $(0.5, 4\\pi, 3\\pi)$\n\n将每个计算结果四舍五入到小数点后六位。", "solution": "该问题是有效的。它提出了一个在数值几何分析中定义明确的任务，该任务基于微分几何的标准原理。所有必需的公式、参数和数值方法都已指定，并且问题是自洽且数学上一致的。\n\n目标是为嵌入三维空间中的特定二维曲面上的 Michael-Simon Sobolev 不等式相关的五个数值量进行计算，这需要针对三组不同的参数集。这些量源于三个核心积分，我们将使用均匀网格上的黎曼和来近似这些积分。\n\n首先，我们建立计算所需的数学公式。\n\n该曲面是函数 $z = f(x,y)$ 的图形，由参数化 $X(x,y) = (x, y, f(x,y))$ 给出，其中\n$$\nf(x,y) = A \\sin(k x)\\sin(\\ell y).\n$$\n$f$ 的一阶和二阶偏导数是度量和曲率计算所必需的：\n$$\n\\begin{aligned}\nf_x = \\frac{\\partial f}{\\partial x} = Ak \\cos(kx)\\sin(\\ell y), \\\\\nf_y = \\frac{\\partial f}{\\partial y} = A\\ell \\sin(kx)\\cos(\\ell y), \\\\\nf_{xx} = \\frac{\\partial^2 f}{\\partial x^2} = -Ak^2 \\sin(kx)\\sin(\\ell y), \\\\\nf_{yy} = \\frac{\\partial^2 f}{\\partial y^2} = -A\\ell^2 \\sin(kx)\\sin(\\ell y), \\\\\nf_{xy} = \\frac{\\partial^2 f}{\\partial x \\partial y} = Ak\\ell \\cos(kx)\\cos(\\ell y).\n\\end{aligned}\n$$\n对于图曲面，第一基本形式（度量张量）$G$ 由下式给出\n$$\nG(x,y) = \\begin{pmatrix} 1+f_x^2  f_x f_y \\\\ f_x f_y  1+f_y^2 \\end{pmatrix}.\n$$\n曲面面积元 $\\mathrm{d}\\mu$ 通过以下方式与标准勒贝格测度 $\\mathrm{d}x\\mathrm{d}y$ 相关联\n$$\n\\mathrm{d}\\mu = \\sqrt{\\det G}\\,\\mathrm{d}x\\mathrm{d}y = \\sqrt{(1+f_x^2)(1+f_y^2) - (f_x f_y)^2}\\,\\mathrm{d}x\\mathrm{d}y = \\sqrt{1+f_x^2+f_y^2}\\,\\mathrm{d}x\\mathrm{d}y.\n$$\n图曲面的标量平均曲率 $H$ 由以下公式给出\n$$\nH = \\frac{(1+f_y^2)f_{xx} - 2f_x f_y f_{xy} + (1+f_x^2)f_{yy}}{(1+f_x^2+f_y^2)^{3/2}}.\n$$\n测试函数是 $u(x,y) = \\varphi(x)\\varphi(y)$，其中 $\\varphi(t)$ 是一个标准的光滑凸点函数。其偏导数为\n$$\nu_x = \\varphi'(x)\\varphi(y) \\quad \\text{and} \\quad u_y = \\varphi(x)\\varphi'(y).\n$$\n导数 $\\varphi'(t)$ 可通过链式法则计算。曲面梯度 $\\nabla_M u$ 的范数使用逆度量 $G^{-1}$ 计算：\n$$\n\\lVert \\nabla_M u \\rVert^2 = \\begin{pmatrix} u_x  u_y \\end{pmatrix} G^{-1} \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix} = \\frac{1}{\\det G} \\left( (1+f_y^2)u_x^2 - 2f_x f_y u_x u_y + (1+f_x^2)u_y^2 \\right).\n$$\n这可以重写为 $\\lVert \\nabla_M u \\rVert^2 = \\frac{u_x^2+u_y^2+(f_y u_x - f_x u_y)^2}{1+f_x^2+f_y^2}$，这显然是非负的。\n\n接下来，我们定义数值近似方案。积分是在流形 $M$ 上进行的，该流形是定义在域 $D = (-L,L) \\times (-L,L)$ 上的函数 $f$ 的图形。我们使用离散网格上的黎曼和来近似这些积分。我们在 $D$ 严格内部构建一个 $N \\times N$ 个点 $(x_i, y_j)$ 的均匀张量积网格。网格间距为 $\\Delta x = \\Delta y = \\frac{2L}{N+1}$。网格点由下式给出\n$$\nx_i = -L + i \\cdot \\Delta x, \\quad y_j = -L + j \\cdot \\Delta y, \\quad \\text{for } i, j \\in \\{1, 2, \\dots, N\\}.\n$$\n函数 $I(x,y)$ 在曲面上的积分近似为：\n$$\n\\int_M I \\, \\mathrm{d}\\mu = \\int_D I(x,y) \\sqrt{1+f_x^2+f_y^2} \\, \\mathrm{d}x\\mathrm{d}y \\approx \\sum_{i=1}^N \\sum_{j=1}^N I(x_i, y_j) \\sqrt{1+f_x(x_i,y_j)^2+f_y(x_i,y_j)^2} \\, \\Delta x \\Delta y.\n$$\n\n总体算法如下：\n1.  对于每个由参数 $(L, A, k, \\ell, N)$ 指定的测试用例，将积分累加器初始化为零。\n2.  使用 `meshgrid` 建立 $N \\times N$ 的数值网格，为坐标创建二维数组 `xx` 和 `yy`。\n3.  计算偏导数 $f_x, f_y, f_{xx}, f_{yy}, f_{xy}$ 作为在网格上求值的二维数组。\n4.  计算测试函数 $u = \\varphi(x)\\varphi(y)$ 及其偏导数 $u_x, u_y$ 作为网格上的二维数组。这首先需要为 $\\varphi(t)$ 和 $\\varphi'(t)$ 定义能对 numpy 数组操作的辅助函数。\n5.  将几何量计算为网格上的二维数组：\n    -   面积元缩放因子 $\\sqrt{\\det G} = \\sqrt{1+f_x^2+f_y^2}$。\n    -   绝对平均曲率 $|H|$。\n    -   曲面梯度的范数 $\\lVert \\nabla_M u \\rVert$。\n6.  构建三个被积函数数组：\n    -   $I_1 = u^2 \\sqrt{\\det G}$\n    -   $I_2 = \\lVert \\nabla_M u \\rVert \\sqrt{\\det G}$\n    -   $I_3 = |H| u \\sqrt{\\det G}$ (注意 $u(x,y) \\ge 0$，所以 $|u|=u$)。\n7.  通过对每个被积函数数组的所有网格点求和，并乘以网格单元的面积 $\\Delta A = \\Delta x \\Delta y$ 来计算三个积分。\n    -   $\\int_M |u|^2 \\mathrm{d}\\mu \\approx (\\sum I_1) \\Delta A$\n    -   $I_\\nabla = \\int_M \\lVert \\nabla_M u \\rVert \\mathrm{d}\\mu \\approx (\\sum I_2) \\Delta A$\n    -   $I_H = \\int_M |H| |u| \\mathrm{d}\\mu \\approx (\\sum I_3) \\Delta A$\n8.  计算最终的派生量：\n    -   $\\mathrm{LHS} = \\left(\\int_M |u|^2 \\mathrm{d}\\mu\\right)^{1/2}$\n    -   $R = \\mathrm{LHS} / (I_\\nabla + I_H)$\n9.  将所需的五个值四舍五入到 $6$ 位小数，并收集它们以备最终输出。对三个测试用例中的每一个重复此过程。对于测试用例 2（$A=k=\\ell=0$），曲面是平坦的（$f=0$），因此 $H=0$ 且 $\\mathrm{d}\\mu = \\mathrm{d}x\\mathrm{d}y$，这将计算简化为标准的二维欧几里得积分，为实现提供了一个有用的检验。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical estimates for integrals related to the\n    Michael-Simon Sobolev inequality for three test cases.\n    \"\"\"\n    \n    test_cases = [\n        # (L, A, k, l, N)\n        (1.0, 0.2, 2 * np.pi, np.pi, 301),\n        (1.0, 0.0, 0.0, 0.0, 301),\n        (1.0, 0.5, 4 * np.pi, 3 * np.pi, 301),\n    ]\n\n    all_results = []\n\n    def phi(t, L_val):\n        \"\"\"Computes the bump function phi(t).\"\"\"\n        t_scaled_sq = (t / L_val)**2\n        # Use a mask to handle the domain |t|  L\n        mask = t_scaled_sq  1.0\n        result = np.zeros_like(t, dtype=np.float64)\n        valid_t_scaled_sq = t_scaled_sq[mask]\n        result[mask] = np.exp(-1.0 / (1.0 - valid_t_scaled_sq))\n        return result\n\n    def phi_prime(t, L_val, phi_t_val):\n        \"\"\"Computes the derivative of the bump function, phi'(t).\"\"\"\n        t_scaled_sq = (t / L_val)**2\n        mask = t_scaled_sq  1.0\n        result = np.zeros_like(t, dtype=np.float64)\n        if not np.any(mask):\n            return result\n        \n        valid_t = t[mask]\n        valid_phi_t = phi_t_val[mask]\n        valid_t_scaled_sq = t_scaled_sq[mask]\n        \n        denominator = L_val**2 * (1.0 - valid_t_scaled_sq)**2\n        result[mask] = -2.0 * valid_t * valid_phi_t / denominator\n        return result\n\n    for L, A, k, l, N in test_cases:\n        # 1. Grid setup\n        dx = 2 * L / (N + 1)\n        dy = 2 * L / (N + 1)\n        x_1d = np.linspace(-L + dx, L - dx, N)\n        y_1d = np.linspace(-L + dy, L - dy, N)\n        xx, yy = np.meshgrid(x_1d, y_1d, indexing='xy')\n\n        # 2. Surface function f and its derivatives\n        sin_kx = np.sin(k * xx)\n        cos_kx = np.cos(k * xx)\n        sin_ly = np.sin(l * yy)\n        cos_ly = np.cos(l * yy)\n\n        fx = A * k * cos_kx * sin_ly\n        fy = A * l * sin_kx * cos_ly\n        fxx = -A * k**2 * sin_kx * sin_ly\n        fyy = -A * l**2 * sin_kx * sin_ly\n        fxy = A * k * l * cos_kx * cos_ly\n\n        # 3. Test function u and its derivatives\n        phi_on_x = phi(xx, L)\n        phi_on_y = phi(yy, L)\n        phi_prime_on_x = phi_prime(xx, L, phi_on_x)\n        phi_prime_on_y = phi_prime(yy, L, phi_on_y)\n        \n        u = phi_on_x * phi_on_y\n        ux = phi_prime_on_x * phi_on_y\n        uy = phi_on_x * phi_prime_on_y\n        \n        # 4. Geometric quantities\n        det_G_sqrt = np.sqrt(1.0 + fx**2 + fy**2)\n\n        H_num = (1.0 + fy**2) * fxx - 2.0 * fx * fy * fxy + (1.0 + fx**2) * fyy\n        H_den = (1.0 + fx**2 + fy**2)**1.5\n        H = H_num / H_den\n\n        grad_u_norm_sq_num = ux**2 * (1.0 + fy**2) - 2.0 * ux * uy * fx * fy + uy**2 * (1.0 + fx**2)\n        grad_u_norm_sq_den = 1.0 + fx**2 + fy**2\n        # Ensure argument to sqrt is non-negative\n        safe_arg = np.maximum(0, grad_u_norm_sq_num / grad_u_norm_sq_den)\n        norm_grad_M_u = np.sqrt(safe_arg)\n\n        # 5. Integrands\n        integrand1 = u**2 * det_G_sqrt\n        integrand2 = norm_grad_M_u * det_G_sqrt\n        integrand3 = np.abs(H) * u * det_G_sqrt\n\n        # 6. Summation for Riemann integral approximation\n        delta_area = dx * dy\n        \n        int_u_sq = np.sum(integrand1) * delta_area\n        int_grad_u = np.sum(integrand2) * delta_area\n        int_H_u = np.sum(integrand3) * delta_area\n\n        # 7. Final quantities\n        lhs = np.sqrt(int_u_sq)\n        denominator_R = int_grad_u + int_H_u\n        \n        if np.isclose(denominator_R, 0):\n            r_val = np.nan # Or inf, but should not happen in these cases.\n        else:\n            r_val = lhs / denominator_R\n        \n        results_for_case = [\n            round(int_u_sq, 6),\n            round(int_grad_u, 6),\n            round(int_H_u, 6),\n            round(lhs, 6),\n            round(r_val, 6)\n        ]\n        all_results.append(results_for_case)\n    \n    # Final print statement in the exact required format.\n    # Convert to string and remove spaces to match the required dense format.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "3072467"}]}