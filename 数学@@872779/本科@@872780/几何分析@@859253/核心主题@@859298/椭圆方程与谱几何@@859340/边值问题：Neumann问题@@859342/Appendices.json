{"hands_on_practices": [{"introduction": "我们从一个基础的一维诺伊曼问题开始我们的动手实践。这个练习将引导你使用余弦级数展开，从第一性原理出发解决这个问题，让你直面诺伊曼问题定义的关键特征：可解性条件和零模态的作用。[@problem_id:3040833]", "problem": "考虑区间 $\\left(0,L\\right)$ 上的一个一维 Neumann 边界值问题，未知函数为 $u:\\left[0,L\\right]\\to\\mathbb{R}$，由常微分方程 $-u''(x)=f(x)$ 控制，其中 $f\\in L^{2}\\!\\left(0,L\\right)$ 是一个给定的源项。边界通量由 $u'(0)=h_{0}$ 和 $u'(L)=h_{L}$ 指定，其中 $h_{0},h_{L}\\in\\mathbb{R}$ 是给定的常数。您的任务是通过将 $u$ 展开为与 $\\left(0,L\\right)$ 上 $-d^{2}/dx^{2}$ 的 Neumann 特征函数相关的余弦级数来求解该问题，从第一性原理（分部积分、正交性和特征函数展开）出发。在您的推导中，构造一个提升函数以强制施加非齐次边界通量，将问题简化为残差的齐次 Neumann 问题，并符号化地确定傅里叶余弦系数。识别并解释零模（常数特征函数）在残差方程可解性中的作用，并推导数据必须满足的必要相容性条件。最后，通过施加归一化条件 $\\int_{0}^{L}u(x)\\,dx=0$ 来确定加性常数（在 Neumann 问题中是不确定的），并报告最终的 $u(x)$ 的显式级数表示，用 $L$、$h_{0}$、$h_{L}$ 和 $f$ 的余弦系数表示。将 $n\\geq 1$ 的余弦系数定义为\n$$\nf_{n}\\;=\\;\\frac{2}{L}\\int_{0}^{L}f(y)\\,\\cos\\!\\left(\\frac{n\\pi y}{L}\\right)\\,dy.\n$$\n您的最终答案必须是 $u(x)$ 的一个单一闭式解析表达式，表示为一个关于 $x$ 的显式多项式与一个具有上述系数的余弦级数之和。不要提供不等式或需要求解的方程。不需要四舍五入。", "solution": "用户希望求解以下一维 Neumann 边界值问题：\n$$\n-u''(x) = f(x), \\quad x \\in (0, L)\n$$\n其非齐次边界条件为\n$$\nu'(0) = h_{0}, \\quad u'(L) = h_{L}\n$$\n以及一个额外的归一化约束\n$$\n\\int_{0}^{L} u(x) \\, dx = 0.\n$$\n源项为 $f \\in L^2(0, L)$，$h_0, h_L$ 为实常数。解将通过使用基于余弦函数的特征函数展开来求得。\n\n首先，我们通过引入一个“提升”函数来处理非齐次边界条件。我们寻找一个简单的函数 $v(x)$，使其满足给定的边界条件，即 $v'(0) = h_0$ 和 $v'(L) = h_L$。形式为 $v(x) = Ax^2 + Bx$ 的二次多项式是一个合适的候选。其导数为 $v'(x) = 2Ax + B$。\n应用边界条件：\n$$\nv'(0) = B = h_0\n$$\n$$\nv'(L) = 2AL + B = h_L \\implies 2AL + h_0 = h_L \\implies A = \\frac{h_L - h_0}{2L}\n$$\n因此，一个提升函数由下式给出：\n$$\nv(x) = \\frac{h_L - h_0}{2L}x^2 + h_0 x\n$$\n现在，我们将解 $u(x)$ 表示为这个提升函数与一个残差函数 $w(x)$ 的和，即 $u(x) = v(x) + w(x)$。我们将其代入原始的微分方程和边界条件，以找出 $w(x)$ 必须满足的问题。\n\n$w(x)$ 的微分方程为：\n$$\n-(v(x) + w(x))'' = f(x) \\implies -v''(x) - w''(x) = f(x)\n$$\n$$\n-w''(x) = f(x) + v''(x)\n$$\n我们计算 $v(x)$ 的二阶导数：\n$$\nv'(x) = \\frac{h_L - h_0}{L}x + h_0 \\implies v''(x) = \\frac{h_L - h_0}{L}\n$$\n所以，$w(x)$ 的微分方程变为：\n$$\n-w''(x) = f(x) + \\frac{h_L - h_0}{L}\n$$\n我们定义一个新的源项 $g(x) = f(x) + \\frac{h_L - h_0}{L}$。方程为 $-w''(x) = g(x)$。\n\n$w(x)$ 的边界条件由 $u'(x) = v'(x) + w'(x)$ 得到：\n$$\nu'(0) = v'(0) + w'(0) \\implies h_0 = h_0 + w'(0) \\implies w'(0) = 0\n$$\n$$\nu'(L) = v'(L) + w'(L) \\implies h_L = h_L + w'(L) \\implies w'(L) = 0\n$$\n所以，$w(x)$ 求解一个具有齐次边界条件的 Neumann 问题：\n$$\n-w''(x) = g(x), \\quad w'(0) = 0, \\quad w'(L) = 0\n$$\n为了解决这个问题，我们使用特征函数展开法。相关的特征函数是算子 $-d^2/dx^2$ 在 $(0, L)$ 上具有齐次 Neumann 边界条件的特征函数。它们由 $\\phi_n(x) = \\cos(\\frac{n\\pi x}{L})$ 给出，其中 $n=0, 1, 2, \\dots$，对应的特征值为 $\\lambda_n = (\\frac{n\\pi}{L})^2$。\n\n当 $n=0$ 时，特征函数为 $\\phi_0(x) = \\cos(0) = 1$，特征值为 $\\lambda_0 = 0$。这就是“零模”。它的存在对问题的可解性有着深远的影响。为了看到这一点，我们可以将 $w(x)$ 的方程在定义域 $(0, L)$ 上积分：\n$$\n\\int_{0}^{L} -w''(x) \\, dx = \\int_{0}^{L} g(x) \\, dx\n$$\n$$\n[-w'(x)]_{0}^{L} = \\int_{0}^{L} g(x) \\, dx\n$$\n$$\n-w'(L) + w'(0) = \\int_{0}^{L} g(x) \\, dx\n$$\n使用齐次边界条件 $w'(0)=w'(L)=0$，左侧消失，从而得到相容性条件：\n$$\n\\int_{0}^{L} g(x) \\, dx = 0\n$$\n代入 $g(x)$ 的定义：\n$$\n\\int_{0}^{L} \\left(f(x) + \\frac{h_L - h_0}{L}\\right) \\, dx = 0\n$$\n$$\n\\int_{0}^{L} f(x) \\, dx + \\frac{h_L - h_0}{L} \\int_{0}^{L} \\, dx = 0\n$$\n$$\n\\int_{0}^{L} f(x) \\, dx + (h_L - h_0) = 0 \\implies \\int_{0}^{L} f(x) \\, dx = h_0 - h_L\n$$\n这是数据 $(f, h_0, h_L)$ 为使解存在而必须满足的必要条件。\n\n假设此条件成立，我们继续求解 $w(x)$。我们将 $w(x)$ 和 $g(x)$ 在 Neumann 特征函数基中展开：\n$$\nw(x) = \\sum_{n=0}^{\\infty} w_n \\cos\\left(\\frac{n\\pi x}{L}\\right)\n$$\n$$\ng(x) = \\sum_{n=0}^{\\infty} g_n \\cos\\left(\\frac{n\\pi x}{L}\\right)\n$$\n将这些级数代入 $-w''(x) = g(x)$：\n$$\n-\\frac{d^2}{dx^2} \\sum_{n=0}^{\\infty} w_n \\cos\\left(\\frac{n\\pi x}{L}\\right) = \\sum_{n=0}^{\\infty} g_n \\cos\\left(\\frac{n\\pi x}{L}\\right)\n$$\n$$\n\\sum_{n=0}^{\\infty} w_n \\left(\\frac{n\\pi}{L}\\right)^2 \\cos\\left(\\frac{n\\pi x}{L}\\right) = \\sum_{n=0}^{\\infty} g_n \\cos\\left(\\frac{n\\pi x}{L}\\right)\n$$\n通过令基函数的系数相等，我们得到对每个 $n$ 都有 $w_n \\lambda_n = g_n$。\n对于 $n \\ge 1$，$\\lambda_n = (\\frac{n\\pi}{L})^2 \\ne 0$，所以系数是唯一确定的：\n$$\nw_n = \\frac{g_n}{\\lambda_n} = \\frac{L^2}{n^2\\pi^2} g_n\n$$\n对于 $n = 0$，$\\lambda_0 = 0$，方程为 $w_0 \\cdot 0 = g_0$。相容性条件 $\\int_0^L g(x) dx = 0$ 等价于 $g_0 = \\frac{1}{L}\\int_0^L g(x) dx = 0$。由于 $g_0=0$，方程 $0=0$ 成立，但 $w_0$ 仍然未定。这反映了如果 $w(x)$ 是一个解，那么对于任意常数 $C$，$w(x)+C$ 也是一个解。系数 $w_0$ 代表了这个任意的加性常数。\n\n接下来，我们用给定的数据来表示系数 $g_n$。对于 $n \\ge 1$：\n$$\ng_n = \\frac{2}{L}\\int_{0}^{L} g(x)\\cos\\left(\\frac{n\\pi x}{L}\\right)dx = \\frac{2}{L}\\int_{0}^{L} \\left(f(x) + \\frac{h_L - h_0}{L}\\right)\\cos\\left(\\frac{n\\pi x}{L}\\right)dx\n$$\n$$\ng_n = \\frac{2}{L}\\int_{0}^{L} f(x)\\cos\\left(\\frac{n\\pi x}{L}\\right)dx + \\frac{2(h_L - h_0)}{L^2}\\int_{0}^{L}\\cos\\left(\\frac{n\\pi x}{L}\\right)dx\n$$\n第一项是 $f_n$ 的定义。对于 $n \\ge 1$，第二个积分为 $\\left[\\frac{L}{n\\pi}\\sin\\left(\\frac{n\\pi x}{L}\\right)\\right]_0^L = 0$。\n因此，对于 $n \\ge 1$，$g_n = f_n$。\n$w(x)$ 的系数为 $w_n = \\frac{L^2}{n^2\\pi^2}f_n$，其中 $n \\ge 1$。\n\n$w(x)$ 的解为：\n$$\nw(x) = w_0 + \\sum_{n=1}^{\\infty} \\frac{L^2}{n^2\\pi^2}f_n \\cos\\left(\\frac{n\\pi x}{L}\\right)\n$$\n与提升函数 $v(x)$ 结合， $u(x)$ 的通解为：\n$$\nu(x) = v(x) + w(x) = \\frac{h_L - h_0}{2L}x^2 + h_0 x + w_0 + \\sum_{n=1}^{\\infty} \\frac{L^2}{n^2\\pi^2}f_n \\cos\\left(\\frac{n\\pi x}{L}\\right)\n$$\n最后，我们使用归一化条件 $\\int_0^L u(x) dx = 0$ 来确定常数 $w_0$。\n$$\n\\int_{0}^{L} \\left( \\frac{h_L - h_0}{2L}x^2 + h_0 x + w_0 + \\sum_{n=1}^{\\infty} \\frac{L^2}{n^2\\pi^2}f_n \\cos\\left(\\frac{n\\pi x}{L}\\right) \\right) dx = 0\n$$\n级数中每个余弦项在 $(0, L)$ 上的积分为零。我们只需要对多项式部分和常数 $w_0$ 进行积分：\n$$\n\\int_{0}^{L} \\left( \\frac{h_L - h_0}{2L}x^2 + h_0 x + w_0 \\right) dx = 0\n$$\n$$\n\\left[ \\frac{h_L - h_0}{6L}x^3 + \\frac{h_0}{2}x^2 + w_0 x \\right]_0^L = 0\n$$\n$$\n\\frac{(h_L - h_0)L^3}{6L} + \\frac{h_0 L^2}{2} + w_0 L = 0\n$$\n$$\n\\frac{(h_L - h_0)L^2}{6} + \\frac{3h_0 L^2}{6} + w_0 L = 0\n$$\n两边除以 $L$（因为 $L>0$）：\n$$\n\\frac{(h_L - h_0 + 3h_0)L}{6} + w_0 = 0 \\implies \\frac{(h_L + 2h_0)L}{6} + w_0 = 0\n$$\n$$\nw_0 = -\\frac{L(h_L + 2h_0)}{6}\n$$\n将 $w_0$ 的这个值代入，得到满足所有条件的 $u(x)$ 的唯一解。最终表达式是一个多项式和一个余弦级数的和，符合要求。\n$$\nu(x) = \\frac{h_L - h_0}{2L}x^2 + h_0 x - \\frac{L(h_L + 2h_0)}{6} + \\sum_{n=1}^{\\infty} \\frac{L^2}{n^2\\pi^2} f_n \\cos\\left(\\frac{n\\pi x}{L}\\right)\n$$", "answer": "$$\n\\boxed{\\frac{h_{L}-h_{0}}{2L}x^{2} + h_{0}x - \\frac{L(h_{L} + 2h_{0})}{6} + \\sum_{n=1}^{\\infty} \\frac{L^{2}}{n^{2}\\pi^{2}} f_{n} \\cos\\left(\\frac{n\\pi x}{L}\\right)}\n$$", "id": "3040833"}, {"introduction": "在一维情况的基础上，我们现在处理二维矩形域上的泊松方程。这个实践将本征函数展开法推广到更高维度，并加深你对可解性条件如何确保诺伊曼问题存在解的理解。[@problem_id:3041106]", "problem": "考虑矩形区域 $\\Omega=(0,\\ell)\\times(0,h)$，其中 $\\ell=3$，$h=2$。设 $u:\\overline{\\Omega}\\to\\mathbb{R}$ 是偏微分方程(PDE) $-\\Delta u=f$ 在 $\\Omega$ 内的解，且在边界 $\\partial\\Omega$ 上满足齐次诺伊曼(Neumann)边界条件 $\\partial_{\\nu}u=0$，其中 $\\partial_{\\nu}$ 表示外法线导数。强迫项为\n$$\nf(x,y)=4\\cos\\!\\left(\\frac{2\\pi x}{3}\\right)\\cos\\!\\left(\\frac{\\pi y}{2}\\right)+6\\cos\\!\\left(\\frac{\\pi x}{3}\\right)+2\\cos(\\pi y).\n$$\n使用分离变量法和与矩形上齐次诺伊曼边界条件相关的余弦级数，从第一性原理推导空间平均值为零的唯一解，即满足 $\\int_{\\Omega}u\\,dx\\,dy=0$ 的唯一解 $u$。你的推导必须明确阐述零模态和可解性条件的作用。将你的最终答案表示为 $u(x,y)$ 的单个闭式解析表达式。不需要数值近似。", "solution": "所述问题是矩形域上泊松(Poisson)方程的经典诺伊曼(Neumann)边值问题。在求解之前，需要进行严格的验证。\n\n首先，我们为区域 $\\Omega$ 上的问题 $-\\Delta u = f$ （在边界 $\\partial\\Omega$ 上具有齐次诺伊曼边界条件 $\\partial_{\\nu}u=0$）建立必要的可解性条件。通过在区域 $\\Omega$ 上对偏微分方程进行积分并应用散度定理，我们得到：\n$$\n-\\int_{\\Omega} \\Delta u \\, d A = \\int_{\\Omega} f \\, d A\n$$\n散度定理表明 $\\int_{\\Omega} \\nabla \\cdot \\mathbf{F} \\, d A = \\int_{\\partial\\Omega} \\mathbf{F} \\cdot \\nu \\, dS$。令 $\\mathbf{F} = \\nabla u$，我们有 $\\nabla \\cdot \\mathbf{F} = \\Delta u$。因此：\n$$\n\\int_{\\Omega} \\Delta u \\, d A = \\int_{\\partial\\Omega} \\nabla u \\cdot \\nu \\, dS = \\int_{\\partial\\Omega} \\partial_{\\nu}u \\, dS\n$$\n根据边界条件 $\\partial_{\\nu}u=0$，右侧为零。因此，可解性条件是：\n$$\n\\int_{\\Omega} f \\, d A = 0\n$$\n我们必须验证给定的强迫函数 $f(x,y)$ 在区域 $\\Omega=(0,3)\\times(0,2)$ 上是否满足此条件。面积元为 $dA = dx\\,dy$。我们计算该积分：\n$$\n\\int_0^2 \\int_0^3 \\left[ 4\\cos\\left(\\frac{2\\pi x}{3}\\right)\\cos\\left(\\frac{\\pi y}{2}\\right)+6\\cos\\left(\\frac{\\pi x}{3}\\right)+2\\cos(\\pi y) \\right] dx\\,dy\n$$\n我们可以分别计算每一项的积分。\n对于第一项：\n$$\n\\int_0^2 \\int_0^3 4\\cos\\left(\\frac{2\\pi x}{3}\\right)\\cos\\left(\\frac{\\pi y}{2}\\right) dx\\,dy = 4 \\left( \\int_0^3 \\cos\\left(\\frac{2\\pi x}{3}\\right) dx \\right) \\left( \\int_0^2 \\cos\\left(\\frac{\\pi y}{2}\\right) dy \\right)\n$$\n单个积分为 $\\int_0^3 \\cos\\left(\\frac{2\\pi x}{3}\\right) dx = \\left[\\frac{3}{2\\pi}\\sin\\left(\\frac{2\\pi x}{3}\\right)\\right]_0^3 = 0$ 和 $\\int_0^2 \\cos\\left(\\frac{\\pi y}{2}\\right) dy = \\left[\\frac{2}{\\pi}\\sin\\left(\\frac{\\pi y}{2}\\right)\\right]_0^2 = 0$。因此，第一项的积分为 $0$。\n对于第二项：\n$$\n\\int_0^2 \\int_0^3 6\\cos\\left(\\frac{\\pi x}{3}\\right) dx\\,dy = 6 \\left( \\int_0^3 \\cos\\left(\\frac{\\pi x}{3}\\right) dx \\right) \\left( \\int_0^2 dy \\right) = 6 \\left( \\left[\\frac{3}{\\pi}\\sin\\left(\\frac{\\pi x}{3}\\right)\\right]_0^3 \\right) (2) = 6(0)(2) = 0\n$$\n对于第三项：\n$$\n\\int_0^2 \\int_0^3 2\\cos(\\pi y) dx\\,dy = 2 \\left( \\int_0^3 dx \\right) \\left( \\int_0^2 \\cos(\\pi y) dy \\right) = 2(3) \\left( \\left[\\frac{1}{\\pi}\\sin(\\pi y)\\right]_0^2 \\right) = 6(0) = 0\n$$\n$f$ 在 $\\Omega$ 上的总积分为 $0+0+0 = 0$。可解性条件得到满足。如果存在解，则它在相差一个加性常数的意义下是唯一的。问题给出了附加约束 $\\int_{\\Omega}u\\,dx\\,dy=0$ 来确定这个常数，从而确保解的唯一性。因此，该问题是有效的、自洽的且适定的。\n\n我们使用分离变量法和特征函数展开法继续求解。在矩形区域 $\\Omega=(0,\\ell)\\times(0,h)$ 上，带有齐次诺伊曼边界条件的负拉普拉斯算子 $-\\Delta$ 的特征函数由下式给出\n$$\n\\phi_{mn}(x,y) = \\cos\\left(\\frac{m\\pi x}{\\ell}\\right)\\cos\\left(\\frac{n\\pi y}{h}\\right)\n$$\n其中整数 $m, n \\ge 0$。这些函数构成了 $L^2(\\Omega)$ 的一个正交基。\n相应的特征值 $\\lambda_{mn}$ 可以通过应用该算子找到：\n$$\n-\\Delta\\phi_{mn} = -\\left(\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}\\right)\\cos\\left(\\frac{m\\pi x}{\\ell}\\right)\\cos\\left(\\frac{n\\pi y}{h}\\right) = \\left(\\left(\\frac{m\\pi}{\\ell}\\right)^2 + \\left(\\frac{n\\pi}{h}\\right)^2\\right)\\phi_{mn}\n$$\n所以，特征值为 $\\lambda_{mn} = \\pi^2\\left(\\frac{m^2}{\\ell^2}+\\frac{n^2}{h^2}\\right)$。\n\n我们将解 $u(x,y)$ 和强迫项 $f(x,y)$ 展开为这些特征函数的级数：\n$$\nu(x,y) = \\sum_{m=0}^\\infty \\sum_{n=0}^\\infty u_{mn} \\cos\\left(\\frac{m\\pi x}{\\ell}\\right)\\cos\\left(\\frac{n\\pi y}{h}\\right)\n$$\n$$\nf(x,y) = \\sum_{m=0}^\\infty \\sum_{n=0}^\\infty f_{mn} \\cos\\left(\\frac{m\\pi x}{\\ell}\\right)\\cos\\left(\\frac{n\\pi y}{h}\\right)\n$$\n将这些展开式代入偏微分方程 $-\\Delta u = f$：\n$$\n-\\Delta \\left( \\sum_{m,n} u_{mn} \\phi_{mn}(x,y) \\right) = \\sum_{m,n} f_{mn} \\phi_{mn}(x,y)\n$$\n$$\n\\sum_{m,n} u_{mn} (-\\Delta \\phi_{mn}(x,y)) = \\sum_{m,n} f_{mn} \\phi_{mn}(x,y)\n$$\n$$\n\\sum_{m,n} u_{mn} \\lambda_{mn} \\phi_{mn}(x,y) = \\sum_{m,n} f_{mn} \\phi_{mn}(x,y)\n$$\n根据正交性，我们可以令每个模态 $(m,n)$ 的系数相等：\n$$\nu_{mn} \\lambda_{mn} = f_{mn}\n$$\n对于零模态 $(m,n)=(0,0)$，特征函数为 $\\phi_{00}=1$，特征值为 $\\lambda_{00} = 0$。方程变为 $u_{00} \\cdot 0 = f_{00}$。这意味着必须有 $f_{00}=0$。系数 $f_{00}$ 是 $f$ 的空间平均值：$f_{00} = \\frac{1}{\\ell h}\\int_\\Omega f\\,dx\\,dy$。条件 $f_{00}=0$ 正是我们之前验证的可解性条件。对于此模态，$u_{00}$ 无法由偏微分方程确定。该系数对应于解的平均值：$\\frac{1}{\\ell h}\\int_\\Omega u\\,dx\\,dy = u_{00}$。问题指定解的空间平均值必须为零，即 $\\int_\\Omega u\\,dx\\,dy=0$，这直接意味着 $u_{00}=0$。\n\n对于所有其他模态 $(m,n) \\neq (0,0)$，特征值 $\\lambda_{mn} > 0$。我们可以求解系数 $u_{mn}$：\n$$\nu_{mn} = \\frac{f_{mn}}{\\lambda_{mn}}\n$$\n现在，我们通过观察给定的强迫函数来确定系数 $f_{mn}$，其中 $\\ell=3$，$h=2$：\n$$\nf(x,y)=4\\cos\\left(\\frac{2\\pi x}{3}\\right)\\cos\\left(\\frac{\\pi y}{2}\\right)+6\\cos\\left(\\frac{\\pi x}{3}\\right)+2\\cos(\\pi y)\n$$\n基函数是 $\\cos\\left(\\frac{m\\pi x}{3}\\right)\\cos\\left(\\frac{n\\pi y}{2}\\right)$。\n1. 项 $4\\cos\\left(\\frac{2\\pi x}{3}\\right)\\cos\\left(\\frac{\\pi y}{2}\\right)$ 对应于 $m=2$，$n=1$。所以，$f_{21}=4$。\n2. 项 $6\\cos\\left(\\frac{\\pi x}{3}\\right) = 6\\cos\\left(\\frac{1\\pi x}{3}\\right)\\cos\\left(\\frac{0\\pi y}{2}\\right)$ 对应于 $m=1$，$n=0$。所以，$f_{10}=6$。\n3. 项 $2\\cos(\\pi y) = 2\\cos\\left(\\frac{0\\pi x}{3}\\right)\\cos\\left(\\frac{2\\pi y}{2}\\right)$ 对应于 $m=0$，$n=2$。所以，$f_{02}=2$。\n所有其他系数 $f_{mn}$ 均为零。\n\n接下来，我们计算所需的特征值 $\\lambda_{mn} = \\pi^2\\left(\\frac{m^2}{3^2}+\\frac{n^2}{2^2}\\right) = \\pi^2\\left(\\frac{m^2}{9}+\\frac{n^2}{4}\\right)$：\n- 对于 $(m,n)=(2,1)$: $\\lambda_{21} = \\pi^2\\left(\\frac{2^2}{9}+\\frac{1^2}{4}\\right) = \\pi^2\\left(\\frac{4}{9}+\\frac{1}{4}\\right) = \\pi^2\\left(\\frac{16+9}{36}\\right) = \\frac{25\\pi^2}{36}$。\n- 对于 $(m,n)=(1,0)$: $\\lambda_{10} = \\pi^2\\left(\\frac{1^2}{9}+\\frac{0^2}{4}\\right) = \\frac{\\pi^2}{9}$。\n- 对于 $(m,n)=(0,2)$: $\\lambda_{02} = \\pi^2\\left(\\frac{0^2}{9}+\\frac{2^2}{4}\\right) = \\pi^2\\left(\\frac{4}{4}\\right) = \\pi^2$。\n\n最后，我们计算解 $u(x,y)$ 的系数：\n- $u_{00}=0$。\n- $u_{21} = \\frac{f_{21}}{\\lambda_{21}} = \\frac{4}{25\\pi^2/36} = \\frac{144}{25\\pi^2}$。\n- $u_{10} = \\frac{f_{10}}{\\lambda_{10}} = \\frac{6}{\\pi^2/9} = \\frac{54}{\\pi^2}$。\n- $u_{02} = \\frac{f_{02}}{\\lambda_{02}} = \\frac{2}{\\pi^2}$。\n- 所有其他 $u_{mn}=0$。\n\n通过组合这些分量，得到空间平均值为零的唯一解 $u(x,y)$：\n$$\nu(x,y) = u_{00} + u_{21}\\cos\\left(\\frac{2\\pi x}{3}\\right)\\cos\\left(\\frac{\\pi y}{2}\\right) + u_{10}\\cos\\left(\\frac{\\pi x}{3}\\right) + u_{02}\\cos\\left(\\pi y\\right)\n$$\n代入计算出的系数，得到解的最终表达式。\n$$\nu(x,y) = \\frac{144}{25\\pi^2}\\cos\\left(\\frac{2\\pi x}{3}\\right)\\cos\\left(\\frac{\\pi y}{2}\\right) + \\frac{54}{\\pi^2}\\cos\\left(\\frac{\\pi x}{3}\\right) + \\frac{2}{\\pi^2}\\cos(\\pi y)\n$$", "answer": "$$\n\\boxed{\\frac{144}{25\\pi^2}\\cos\\left(\\frac{2\\pi x}{3}\\right)\\cos\\left(\\frac{\\pi y}{2}\\right) + \\frac{54}{\\pi^2}\\cos\\left(\\frac{\\pi x}{3}\\right) + \\frac{2}{\\pi^2}\\cos(\\pi y)}\n$$", "id": "3041106"}, {"introduction": "为了弥合解析理论与现代计算实践之间的差距，最后的这个练习涉及使用有限元方法（FEM）进行数值验证。你将通过编程测试来确认可解性条件的离散形式同样成立，这是对诺伊曼问题进行任何实际数值模拟时的关键一步。[@problem_id:3041063]", "problem": "考虑拉普拉斯算子的诺伊曼边界值问题：在域 $\\Omega = [0,1]^2 \\subset \\mathbb{R}^2$ 上找到一个函数 $u$，使得\n$$\n-\\Delta u = f \\quad \\text{在 } \\Omega \\text{ 内}, \n\\qquad \n\\partial_{\\nu} u = g \\quad \\text{在 } \\partial\\Omega \\text{ 上},\n$$\n其中 $\\Delta$ 是拉普拉斯算子，$\\nu$ 是 $\\partial\\Omega$ 的外单位法向量，且 $\\partial_{\\nu} u := \\nabla u \\cdot \\nu$。该诺伊曼问题的弱形式表述为：找到 $u \\in H^1(\\Omega)$，使得对于所有 $v \\in H^1(\\Omega)$，\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx = \\int_{\\Omega} f\\, v \\, dx + \\int_{\\partial\\Omega} g\\, v \\, ds,\n$$\n并满足一个归一化条件（例如，零均值）以确保唯一性。问题可解的一个必要相容性条件是\n$$\n\\int_{\\Omega} f \\, dx + \\int_{\\partial\\Omega} g \\, ds = 0.\n$$\n您需要在一个离散有限元方法（FEM）的背景下，针对一个特定的制造解，构建并验证此相容性条件。\n\n使用制造解\n$$\nu(x,y) = \\cos(2\\pi x) + \\cos(2\\pi y),\n$$\n以及齐次诺伊曼边界数据 $g = \\partial_{\\nu} u \\big|_{\\partial\\Omega}$。从梯度和拉普拉斯算子的基本定义出发，计算\n$$\nf(x,y) := -\\Delta u(x,y),\n$$\n并解析地验证在 $\\partial\\Omega$ 上 $g \\equiv 0$。然后，在一个使用分片仿射（一阶）基函数和 $\\Omega$ 上协调三角剖分的线性有限元方法（FEM）中，通过组装右端载荷向量来验证离散相容性条件。\n\n遵循以下要求构建一个执行离散验证的单一程序：\n\n- 网格构建：\n  - 将 $\\Omega$ 剖分为一个均匀网格，每个坐标方向有 $N$ 个细分（网格尺寸 $h = 1/N$），其中 $N \\in \\mathbb{N}$。\n  - 将每个网格方块沿对角线分割成两个三角形，以获得一个协调的三角形网格。\n\n- 离散右端项组装：\n  - 对于每个三角形 $T$，将单元域对载荷向量分量 $b_i$ 的贡献组装为\n    $$\n    b_i^{(T)} \\approx \\int_T f \\, \\varphi_i \\, dx,\n    $$\n    其中 $\\{\\varphi_i\\}$ 是局部分片仿射基函数。\n  - 在每个三角形上使用一个对称三点求积法则（2阶精度），该法则具有重心求积点和等权重，来近似这些积分。\n  - 对于每个边界边 $e \\subset \\partial\\Omega$，组装边界贡献\n    $$\n    b_i^{(e)} \\approx \\int_e g \\, \\varphi_i \\, ds\n    $$\n    在边上使用中点法则。\n  - 将所有单元和边界贡献相加，得到全局载荷向量分量 $b_i$。\n\n- 待验证的离散相容性条件：\n  - 利用每个单元上的单位分解性质 $\\sum_i \\varphi_i \\equiv 1$，组装后的右端项分量之和满足\n    $$\n    \\sum_i b_i \\approx \\sum_{T} \\int_T f \\left(\\sum_i \\varphi_i\\right) dx + \\sum_{e \\subset \\partial\\Omega} \\int_e g \\left(\\sum_i \\varphi_i\\right) ds \\approx \\int_{\\Omega} f \\, dx + \\int_{\\partial\\Omega} g \\, ds.\n    $$\n  - 由于对于所选的 $u$ 有 $g \\equiv 0$，精确的相容性条件为 $\\int_{\\Omega} f \\, dx = 0$。您的数值组装应近似此恒等式。\n\n- 接受准则：\n  - 设 $h = 1/N$。定义一个容差\n    $$\n    \\mathrm{tol}(N) = C \\, h^2,\n    $$\n    其中 $C = 5$。\n  - 对于每个网格，计算组装后的总和 $S(N) := \\sum_i b_i$ 并返回是否满足\n    $$\n    |S(N)| \\le \\mathrm{tol}(N).\n    $$\n\n- 测试套件：\n  - 使用细分集合 $N \\in \\{\\, 1, 2, 4, 8 \\,\\}$ 来测试一个粗网格、多个中等网格和一个更细的网格。\n  - 对于集合中的每个 $N$，输出一个布尔值，表示离散相容性是否在指定容差内成立。\n\n- 最终输出格式：\n  - 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的布尔值列表，例如 $[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True}]$。\n\n程序不读取用户输入，不使用外部文件。所有角度均以弧度为单位。此问题中没有物理单位。唯一可接受的输出是上述单行文本，按 $N \\in [\\,1,2,4,8\\,]$ 的顺序汇总四个布尔结果。", "solution": "用户想要在有限元方法（FEM）的背景下，解决一个关于单位正方形 $\\Omega = [0,1]^2$ 上诺伊曼边界值问题的数值验证问题。\n\n### 步骤 1：问题验证\n\n问题陈述已经过仔细检查，并确定为**有效**。\n\n-   **已知条件**：所有必要信息均已提供：偏微分方程（PDE）$(-\\Delta u = f)$、域 $(\\Omega = [0,1]^2)$、诺伊曼边界条件 $(\\partial_\\nu u = g)$、制造解 $u(x,y) = \\cos(2\\pi x) + \\cos(2\\pi y)$、有限元离散方法（分片仿射 P1 单元）、网格结构（将正方形分割为两个三角形的均匀网格）、域积分和边界积分的特定求积法则、测试用例 $N \\in \\{1, 2, 4, 8\\}$，以及一个精确的接受准则 $|S(N)| \\le 5/N^2$。\n-   **科学依据**：该问题在偏微分方程数值分析理论中有坚实的基础。使用制造解来验证代码正确性和相容性条件是一种标准技术。\n-   **适定性与客观性**：问题明确、客观，其步骤可导出一个唯一的、可计算的结果。\n\n在确认其有效性后，我将着手提供完整解答。\n\n### 步骤 2：解析公式\n\n首先，我们从给定的制造解 $u(x,y) = \\cos(2\\pi x) + \\cos(2\\pi y)$ 推导源项 $f$ 并验证边界条件 $g$。\n\n$u$ 的梯度是：\n$$\n\\nabla u(x,y) = \\left( \\frac{\\partial u}{\\partial x}, \\frac{\\partial u}{\\partial y} \\right) = (-2\\pi \\sin(2\\pi x), -2\\pi \\sin(2\\pi y))\n$$\n\n$u$ 的拉普拉斯量是：\n$$\n\\Delta u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = -4\\pi^2 \\cos(2\\pi x) - 4\\pi^2 \\cos(2\\pi y) = -4\\pi^2 (\\cos(2\\pi x) + \\cos(2\\pi y))\n$$\n\n源项 $f$ 定义为 $f = -\\Delta u$，因此：\n$$\nf(x,y) = 4\\pi^2 (\\cos(2\\pi x) + \\cos(2\\pi y))\n$$\n\n边界数据 $g$ 是边界 $\\partial\\Omega$ 上的法向导数 $\\partial_\\nu u = \\nabla u \\cdot \\nu$。\n-   在边界 $x=0$ 上，$\\nu = (-1, 0)$。$\\partial_\\nu u = -(-2\\pi \\sin(0)) = 0$。\n-   在边界 $x=1$ 上，$\\nu = (1, 0)$。$\\partial_\\nu u = -2\\pi \\sin(2\\pi) = 0$。\n-   在边界 $y=0$ 上，$\\nu = (0, -1)$。$\\partial_\\nu u = -(-2\\pi \\sin(0)) = 0$。\n-   在边界 $y=1$ 上，$\\nu = (0, 1)$。$\\partial_\\nu u = -2\\pi \\sin(2\\pi) = 0$。\n因此，边界数据 $g$ 在 $\\partial\\Omega$ 上恒为零。\n\n问题可解的相容性条件是 $\\int_{\\Omega} f \\, dx + \\int_{\\partial\\Omega} g \\, ds = 0$。由于 $g \\equiv 0$，该条件简化为 $\\int_{\\Omega} f \\, dx = 0$。我们来解析地验证这一点：\n$$\n\\int_0^1 \\int_0^1 4\\pi^2 (\\cos(2\\pi x) + \\cos(2\\pi y)) \\, dx \\, dy = 4\\pi^2 \\int_0^1 \\left[ \\frac{\\sin(2\\pi x)}{2\\pi} + x\\cos(2\\pi y) \\right]_{x=0}^{x=1} dy\n$$\n$$\n= 4\\pi^2 \\int_0^1 \\cos(2\\pi y) \\, dy = 4\\pi^2 \\left[ \\frac{\\sin(2\\pi y)}{2\\pi} \\right]_0^1 = 0\n$$\n解析条件成立。\n\n### 步骤 3：离散公式与组装\n\n问题要求验证相容性条件的离散模拟。组装后的全局载荷向量各分量之和 $S(N) = \\sum_i b_i$ 近似了相容性积分：\n$$\nS(N) = \\sum_i b_i \\approx \\int_\\Omega f \\, dx + \\int_{\\partial \\Omega} g \\, ds\n$$\n由于 $g \\equiv 0$，边界贡献为零。我们只需要组装域贡献。\n\n对于一个顶点为 $V_a, V_b, V_c$ 的三角形单元 $T$，其单元载荷向量分量 $b_a^{(T)}, b_b^{(T)}, b_c^{(T)}$ 是通过近似积分 $\\int_T f \\varphi_i \\, dx$ 计算的，其中 $\\varphi_i$ 是与顶点 $V_i$ 关联的 P1 基函数。\n\n指定的求积法则是三角形上的一个对称3点法则，使用边的中点作为求积点（$Q_1, Q_2, Q_3$）并具有相等的权重。函数 $F$ 在 $T$ 上的积分近似为：\n$$\n\\int_T F \\, dx \\approx \\frac{\\text{Area}(T)}{3} (F(Q_1) + F(Q_2) + F(Q_3))\n$$\n在我们的情况下，$F = f \\varphi_i$。对于基函数 $\\varphi_a$（其在 $V_a$ 处为1，在其他顶点处为0），其在边中点的值为 $\\varphi_a(Q_1)=0$，$\\varphi_a(Q_2)=1/2$，$\\varphi_a(Q_3)=1/2$，其中 $Q_1$ 与 $V_a$ 相对，$Q_2, Q_3$ 与之相邻。来自三角形 $T$ 对顶点 $V_a$ 的载荷向量分量的贡献为：\n$$\nb_a^{(T)} = \\int_T f \\varphi_a \\,dx \\approx \\frac{\\text{Area}(T)}{3} \\left( f(Q_1)\\varphi_a(Q_1) + f(Q_2)\\varphi_a(Q_2) + f(Q_3)\\varphi_a(Q_3) \\right) = \\frac{\\text{Area}(T)}{6} (f(Q_2) + f(Q_3))\n$$\n网格由 $N \\times N$ 个正方形组成，每个正方形尺寸为 $h \\times h$（其中 $h=1/N$）。每个正方形被分割成两个三角形，每个三角形的面积为 $h^2/2$。组装的系数将是 $\\frac{h^2/2}{6} = \\frac{h^2}{12}$。\n\n### 步骤 4：算法实现\n\n程序将遍历 $N \\in \\{1, 2, 4, 8\\}$。对于每个 $N$：\n1.  初始化一个 $(N+1) \\times (N+1)$ 的零矩阵 `b` 来存储载荷向量的分量。\n2.  遍历网格中的每一个 $N \\times N$ 正方形。\n3.  对于每个正方形，定义其包含的两个三角形。\n4.  对于每个三角形，计算其三个边中点求积点的坐标。\n5.  在这些求积点上计算源函数 `f` 的值。\n6.  使用步骤3中的公式计算三个单元贡献，并将它们加到全局矩阵 `b` 的相应分量中。\n7.  遍历完所有三角形后，计算总和 $S(N) = \\sum_{i,j} b_{ij}$。\n8.  检查 $|S(N)|$ 是否小于或等于容差 $\\mathrm{tol}(N) = 5/N^2$。\n9.  存储布尔结果。\n\n最后，程序将以指定的格式 `[result1,result2,result3,result4]` 打印布尔结果列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef f(x, y):\n    \"\"\"\n    Source term f(x,y) = -Delta u(x,y) for the manufactured solution\n    u(x,y) = cos(2*pi*x) + cos(2*pi*y).\n    \"\"\"\n    pi = np.pi\n    return 4 * pi**2 * (np.cos(2 * pi * x) + np.cos(2 * pi * y))\n\ndef verify_compatibility(N):\n    \"\"\"\n    Constructs the mesh for a given N, assembles the load vector b,\n    and verifies the discrete compatibility condition sum(b) ~ 0.\n\n    Args:\n        N (int): The number of subdivisions per coordinate direction.\n\n    Returns:\n        bool: True if |sum(b)| = tol(N), False otherwise.\n    \"\"\"\n    h = 1.0 / N\n    # Initialize the global load vector b. Node (i,j) maps to b[j, i].\n    b = np.zeros((N + 1, N + 1))\n    \n    # Pre-calculate the coefficient for elemental contributions.\n    # The area of each triangle is h^2/2. The quadrature formula for an\n    # elemental load vector entry involves a factor of Area(T)/6.\n    # So, coeff = (h^2/2) / 6 = h^2 / 12.\n    coeff = h**2 / 12.0\n\n    # Loop over each square in the grid to assemble contributions from the \n    # two triangles within it.\n    for j_idx in range(N):  # Corresponds to the y-index of the square's bottom-left corner\n        for i_idx in range(N):  # Corresponds to the x-index of the square's bottom-left corner\n            \n            # Coordinates of the square's corners\n            x_i = i_idx * h\n            x_ip1 = (i_idx + 1) * h\n            y_j = j_idx * h\n            y_jp1 = (j_idx + 1) * h\n\n            # --- Triangle 1: vertices (i,j), (i+1,j), (i+1,j+1) ---\n            # Quadrature points are midpoints of the triangle's edges.\n            # v0=(i, j), v1=(i+1, j), v2=(i+1, j+1)\n            # q_opp_v0 = midpoint of edge v1-v2\n            q_opp_v0 = (x_ip1, y_j + h / 2.0)\n            # q_opp_v1 = midpoint of edge v0-v2 (on the diagonal)\n            q_opp_v1 = (x_i + h / 2.0, y_j + h / 2.0)\n            # q_opp_v2 = midpoint of edge v0-v1\n            q_opp_v2 = (x_i + h / 2.0, y_j)\n            \n            # Evaluate the source function f at the quadrature points\n            f_at_q_opp_v0 = f(q_opp_v0[0], q_opp_v0[1])\n            f_at_q_opp_v1 = f(q_opp_v1[0], q_opp_v1[1])\n            f_at_q_opp_v2 = f(q_opp_v2[0], q_opp_v2[1])\n            \n            # Assemble elemental contributions for T1.\n            # a node's load vector entry gets contributions from the f-values\n            # atmidpoints of adjacent edges.\n            b[j_idx, i_idx]           += coeff * (f_at_q_opp_v1 + f_at_q_opp_v2)\n            b[j_idx, i_idx + 1]       += coeff * (f_at_q_opp_v0 + f_at_q_opp_v2)\n            b[j_idx + 1, i_idx + 1]   += coeff * (f_at_q_opp_v0 + f_at_q_opp_v1)\n\n            # --- Triangle 2: vertices (i,j), (i+1,j+1), (i,j+1) ---\n            # v0=(i,j), v1=(i+1,j+1), v2=(i,j+1)\n            # q_opp_v0 = midpoint of edge v1-v2\n            q_opp_v0_t2 = (x_i + h / 2.0, y_jp1)\n            # q_opp_v1 = midpoint of edge v0-v2\n            q_opp_v1_t2 = (x_i, y_j + h / 2.0)\n            # q_opp_v2 = midpoint of edge v0-v1 (same as q_opp_v1 of T1)\n            \n            # Evaluate f at the new quadrature points\n            f_at_q_opp_v0_t2 = f(q_opp_v0_t2[0], q_opp_v0_t2[1])\n            f_at_q_opp_v1_t2 = f(q_opp_v1_t2[0], q_opp_v1_t2[1])\n            # Reuse f-value from the shared diagonal edge midpoint\n            f_at_q_opp_v2_t2 = f_at_q_opp_v1\n\n            # Assemble elemental contributions for T2.\n            b[j_idx, i_idx]           += coeff * (f_at_q_opp_v2_t2 + f_at_q_opp_v1_t2)\n            b[j_idx + 1, i_idx + 1]   += coeff * (f_at_q_opp_v0_t2 + f_at_q_opp_v2_t2)\n            b[j_idx + 1, i_idx]       += coeff * (f_at_q_opp_v0_t2 + f_at_q_opp_v1_t2)\n\n    # The sum of the load vector entries approximates the integral of f.\n    # The boundary integral part is zero since g=0.\n    S_N = np.sum(b)\n    \n    # Define the tolerance for the check.\n    tol_N = 5.0 / (N**2)\n    \n    # Return whether the absolute sum is within tolerance.\n    return abs(S_N) = tol_N\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [1, 2, 4, 8]\n\n    results = []\n    for N in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        result = verify_compatibility(N)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The map(str,...) ensures 'True' and 'False' are used instead of '1' and '0'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3041063"}]}