{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是亲手实践。我们从一个经典的多面骰子问题开始，将一个实验的多个可能结果归纳为几个类别。这个练习将引导我们推导出多项分布概率质量函数的基本形式，帮助你理解这个公式是如何从第一性原理构建的，而不仅仅是记忆它。", "problem": "考虑一个有 $m$ 个面的公平骰子，其面上的数字为整数 $\\{1, 2, \\dots, m\\}$。该骰子被独立投掷 $n$ 次。投掷结果根据两个整数阈值 $a$ 和 $b$（其中 $1 \\le a  b  m$）被分为三个不同的类别。\n\n对于单次投掷，类别定义如下：\n- **类别1**：结果小于或等于 $a$。\n- **类别2**：结果大于 $a$ 且小于或等于 $b$。\n- **类别3**：结果大于 $b$。\n\n推导一个通用表达式，表示在类别1中观察到恰好 $n_1$ 个结果，在类别2中观察到 $n_2$ 个结果，在类别3中观察到 $n_3$ 个结果的概率，其中 $n_1 + n_2 + n_3 = n$。用 $n$、$m$、$a$、$b$、$n_1$、$n_2$ 和 $n_3$ 来表示你的答案。", "solution": "我们将每次投掷划分为三个类别，其概率分别为\n$$p_1=\\frac{a}{m},\\quad p_2=\\frac{b-a}{m},\\quad p_3=\\frac{m-b}{m},$$\n并注意到 $p_1+p_2+p_3=1$ 且 $n_1+n_2+n_3=n$。\n\n根据多项分布，在类别1中观察到恰好 $n_1$ 个结果，在类别2中观察到 $n_2$ 个结果，在类别3中观察到 $n_3$ 个结果的概率为\n$$\n\\frac{n!}{n_1!\\,n_2!\\,n_3!}\\,p_1^{n_1}\\,p_2^{n_2}\\,p_3^{n_3}.\n$$\n代入 $p_1,p_2,p_3$ 的表达式即可得到所求的公式。", "answer": "$$\\boxed{\\frac{n!}{n_1!\\,n_2!\\,n_3!}\\Bigl(\\frac{a}{m}\\Bigr)^{n_1}\\Bigl(\\frac{b-a}{m}\\Bigr)^{n_2}\\Bigl(\\frac{m-b}{m}\\Bigr)^{n_3}}$$", "id": "12523"}, {"introduction": "在实际数据分析中，我们常常需要根据分析目的调整数据的分类粒度。这个练习模拟了这样一个场景：我们首先有多个细分的类别，然后决定将其中一些合并进行分析。通过解决这个问题，你将掌握多项分布的一个重要且优美的性质——“合并性”，即合并类别后的结果仍然遵循一个结构相似的多项分布。", "problem": "一个实验包含 $n$ 次独立试验。每次试验可能产生四种互斥结果之一，分别标记为类别1、类别2、类别3和类别4。对于任何一次给定的试验，结果为类别 $i$ 的概率是 $p_i$，其中 $i \\in \\{1, 2, 3, 4\\}$。这些概率在所有试验中保持不变，并且它们的总和为1：$p_1 + p_2 + p_3 + p_4 = 1$。\n\n这个情景可以用多项分布来描述。随机变量 $X_1, X_2, X_3, X_4$ 表示在 $n$ 次试验中每个类别被观察到的次数，其中 $\\sum_{i=1}^4 X_i = n$。\n\n现在，假设我们不再关心区分类别1和类别2。我们决定将它们合并成一个新的类别，称之为“A组”。另外两个类别保持不变。\n\n设随机变量 $X_A$ 为A组中的结果数，$X_3$ 为类别3中的结果数，$X_4$ 为类别4中的结果数。\n\n推导在A组中观察到 $x_A$ 个项目，在类别3中观察到 $x_3$ 个项目，在类别4中观察到 $x_4$ 个项目的具体结果的概率质量函数，其中 $x_A + x_3 + x_4 = n$。请用 $n$, $x_A$, $x_3$, $x_4$ 以及初始概率 $p_1, p_2, p_3, p_4$ 来表示你的答案。", "solution": "我们从四个类别的多项分布概率质量函数（pmf）开始，其计数为 $x_1,x_2,x_3,x_4$ 且满足 $\\sum_{i=1}^4x_i=n$：\n$$\nP(X_1=x_1,X_2=x_2,X_3=x_3,X_4=x_4)\n=\\frac{n!}{x_1!\\,x_2!\\,x_3!\\,x_4!}\\,p_1^{x_1}p_2^{x_2}p_3^{x_3}p_4^{x_4}.\n$$\n我们希望在 $x_1+x_2=x_A$ 的约束下，对 $X_1,X_2$ 进行边缘化。对所有可能的分割求和，\n$$\nP(X_A=x_A,X_3=x_3,X_4=x_4)\n=\\sum_{x_1+x_2=x_A}\\frac{n!}{x_1!\\,x_2!\\,x_3!\\,x_4!}\\,p_1^{x_1}p_2^{x_2}p_3^{x_3}p_4^{x_4}.\n$$\n将不依赖于 $x_1,x_2$ 的项提取出来，并注意二项式展开：\n$$\nP=\\frac{n!}{x_3!\\,x_4!}\\,p_3^{x_3}p_4^{x_4}\n\\sum_{x_1+x_2=x_A}\\frac{1}{x_1!\\,x_2!}p_1^{x_1}p_2^{x_2}\n=\\frac{n!}{x_A!\\,x_3!\\,x_4!}\\,(p_1+p_2)^{x_A}p_3^{x_3}p_4^{x_4}.\n$$\n这是分组后计数 $(X_A,X_3,X_4)$ 的概率质量函数（pmf），其中 $x_A+x_3+x_4=n$。", "answer": "$$\\boxed{\\frac{n!}{x_A!\\,x_3!\\,x_4!}(p_1+p_2)^{x_A}p_3^{x_3}p_4^{x_4}}$$", "id": "12547"}, {"introduction": "概率推理的精髓之一在于如何根据新的信息更新我们的判断。这个练习提出了一个更深入的挑战：当得知在一系列多项试验中，属于某几个类别的结果总数是固定的时候，我们如何计算这些结果内部更细致的分布概率？这个问题揭示了多项分布与二项分布之间深刻的联系，展示了条件概率在简化复杂问题中的强大威力。", "problem": "在一个半导体制造厂中，生产出的微处理器需要经过质量控制测试。每个芯片被独立地归类为四个互斥状态之一：‘合格’(Pass，满足所有规格)、‘轻微缺陷’(Minor Flaw，功能正常但有微小偏差)、‘严重缺陷’(Major Flaw，无法工作)或‘测试错误’(Test Error，测试结果不确定)。\n\n根据大量的历史数据，每种结果的概率是已知的：\n- 芯片‘合格’的概率是 $p_P$。\n- 芯片有‘轻微缺陷’的概率是 $p_m$。\n- 芯片有‘严重缺陷’的概率是 $p_M$。\n- ‘测试错误’的概率是 $p_U$。\n这些概率之和为一：$p_P + p_m + p_M + p_U = 1$。\n\n一位质量保证工程师检查一个随机抽选的包含 $n$ 个微处理器的批次。在审查测试结果时，工程师发现该批次中总共有恰好 $k$ 个处理器是有缺陷的（即，它们要么有‘轻微缺陷’，要么有‘严重缺陷’）。在已知关于该批次的这一特定信息的情况下，求这 $k$ 个有缺陷的处理器中恰好有 $j$ 个是‘轻微缺陷’的概率，其中 $0 \\le j \\le k$。\n\n请用 $j$、$k$、$p_m$ 和 $p_M$ 给出一个封闭形式的解析表达式作为你的答案。", "solution": "设 $N_{m}$ 和 $N_{M}$ 分别表示这批 $n$ 个芯片中具有‘轻微缺陷’和‘严重缺陷’的芯片数量。定义 $p_{f} = p_{m} + p_{M}$ 为芯片有缺陷的总概率，以及 $p_{o} = 1 - p_{f} = p_{P} + p_{U}$ 为无缺陷或测试错误的概率。三元组 $(N_{m}, N_{M}, N_{o})$（其中 $N_{o} = n - N_{m} - N_{M}$）服从参数为 $n$ 和类别概率为 $(p_{m}, p_{M}, p_{o})$ 的多项分布。\n\n我们已知事件 $A = \\{N_{m} + N_{M} = k\\}$。我们要求\n$$\n\\Pr(N_{m} = j \\mid A) = \\frac{\\Pr(N_{m} = j, N_{M} = k - j)}{\\Pr(N_{m} + N_{M} = k)}.\n$$\n分子是多项概率，其中 $N_{o} = n - k$：\n$$\n\\Pr(N_{m} = j, N_{M} = k - j) = \\frac{n!}{j!\\,(k - j)!\\,(n - k)!}\\,p_{m}^{j}\\,p_{M}^{k - j}\\,p_{o}^{n - k}.\n$$\n分母仅依赖于和 $N_{f} = N_{m} + N_{M}$，它服从参数为 $(n, p_{f})$ 的二项分布：\n$$\n\\Pr(N_{m} + N_{M} = k) = \\binom{n}{k} p_{f}^{k} (1 - p_{f})^{n - k} = \\binom{n}{k} p_{f}^{k} p_{o}^{n - k}.\n$$\n因此，\n$$\n\\Pr(N_{m} = j \\mid N_{m} + N_{M} = k)\n= \\frac{\\frac{n!}{j!\\,(k - j)!\\,(n - k)!}\\,p_{m}^{j}\\,p_{M}^{k - j}\\,p_{o}^{n - k}}{\\binom{n}{k} p_{f}^{k} p_{o}^{n - k}}\n= \\frac{\\frac{n!}{j!\\,(k - j)!\\,(n - k)!}}{\\frac{n!}{k!\\,(n - k)!}} \\left(\\frac{p_{m}}{p_{f}}\\right)^{j} \\left(\\frac{p_{M}}{p_{f}}\\right)^{k - j}.\n$$\n使用 $\\frac{\\frac{n!}{j!\\,(k - j)!\\,(n - k)!}}{\\frac{n!}{k!\\,(n - k)!}} = \\frac{k!}{j!\\,(k - j)!} = \\binom{k}{j}$ 和 $p_{f} = p_{m} + p_{M}$，我们得到\n$$\n\\Pr(N_{m} = j \\mid N_{m} + N_{M} = k) = \\binom{k}{j} \\left(\\frac{p_{m}}{p_{m} + p_{M}}\\right)^{j} \\left(\\frac{p_{M}}{p_{m} + p_{M}}\\right)^{k - j}.\n$$\n这正是具有 $k$ 次试验且成功概率为 $\\frac{p_{m}}{p_{m} + p_{M}}$ 的二项分布，与以芯片有缺陷为条件所预期的结果一致。", "answer": "$$\\boxed{\\binom{k}{j}\\left(\\frac{p_{m}}{p_{m}+p_{M}}\\right)^{j}\\left(\\frac{p_{M}}{p_{m}+p_{M}}\\right)^{k-j}}$$", "id": "1402359"}]}