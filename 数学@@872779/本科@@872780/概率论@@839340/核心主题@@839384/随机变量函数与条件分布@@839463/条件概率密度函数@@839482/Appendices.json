{"hands_on_practices": [{"introduction": "第一个练习将带你进行一次基本演练，帮助你掌握条件概率密度函数的定义。通过一个定义在单位立方体上的简单联合概率密度函数，你将练习求解归一化常数和边缘密度的基本步骤，这是计算条件概率密度函数的前提 [@problem_id:1351401]。这个问题旨在为你应对更复杂情况建立必要的扎实基础。", "problem": "考虑一个由三个连续随机变量 $X$、$Y$ 和 $Z$ 描述的系统。这些变量的联合概率密度函数 (PDF) 由下式给出\n$$\nf_{X,Y,Z}(x,y,z) = \\begin{cases} c(x+y+z)  \\text{若 } 0 \\le x \\le 1, 0 \\le y \\le 1, 0 \\le z \\le 1 \\\\ 0  \\text{其他情况} \\end{cases}\n$$\n其中 $c$ 是一个归一化常数。\n\n假设对系统的一次测量显示变量 $X$ 的具体值为 $X = 1/2$。你的任务是确定在此信息下 $Y$ 和 $Z$ 的条件联合概率密度函数，记为 $f_{Y,Z|X}(y,z|1/2)$。该条件 PDF 的定义域为 $0 \\le y \\le 1$ 和 $0 \\le z \\le 1$。\n\n请用一个关于 $y$ 和 $z$ 的闭式解析表达式给出你的答案。", "solution": "我们首先通过要求联合 PDF 在单位立方体上的积分为 $1$ 来确定归一化常数 $c$。使用\n$$\n\\int_{0}^{1}\\int_{0}^{1}\\int_{0}^{1} c(x+y+z)\\,dx\\,dy\\,dz = 1,\n$$\n我们计算\n$$\n\\int_{0}^{1}\\int_{0}^{1}\\int_{0}^{1} (x+y+z)\\,dx\\,dy\\,dz\n= \\int_{0}^{1}\\int_{0}^{1}\\left(\\int_{0}^{1} x\\,dx + \\int_{0}^{1} y\\,dx + \\int_{0}^{1} z\\,dx\\right)dy\\,dz\n= \\int_{0}^{1}\\int_{0}^{1}\\left(\\frac{1}{2} + y + z\\right)dy\\,dz.\n$$\n分离各项并利用对称性，\n$$\n\\int_{0}^{1}\\int_{0}^{1}\\left(\\frac{1}{2} + y + z\\right)dy\\,dz\n= \\frac{1}{2}\\cdot 1 + \\left(\\int_{0}^{1} y\\,dy\\right)\\cdot 1 + \\left(\\int_{0}^{1} z\\,dz\\right)\\cdot 1\n= \\frac{1}{2} + \\frac{1}{2} + \\frac{1}{2} = \\frac{3}{2}.\n$$\n因此 $c \\cdot \\frac{3}{2} = 1$，所以 $c = \\frac{2}{3}$。\n\n接下来，我们计算 $X$ 的边缘密度函数：\n$$\nf_{X}(x) = \\int_{0}^{1}\\int_{0}^{1} c(x+y+z)\\,dy\\,dz\n= c\\left[x\\int_{0}^{1}\\int_{0}^{1} dy\\,dz + \\int_{0}^{1}\\int_{0}^{1} y\\,dy\\,dz + \\int_{0}^{1}\\int_{0}^{1} z\\,dy\\,dz\\right]\n= c\\left(x + \\frac{1}{2} + \\frac{1}{2}\\right) = c(x+1),\n$$\n对于 $0 \\le x \\le 1$。当 $c=\\frac{2}{3}$ 时，这变为 $f_{X}(x) = \\frac{2}{3}(x+1)$，所以\n$$\nf_{X}\\!\\left(\\frac{1}{2}\\right) = \\frac{2}{3}\\left(\\frac{1}{2} + 1\\right) = 1.\n$$\n\n根据定义，$Y$ 和 $Z$ 在给定 $X=\\frac{1}{2}$ 时的条件联合 PDF 为\n$$\nf_{Y,Z|X}\\!\\left(y,z \\mid \\frac{1}{2}\\right) = \\frac{f_{X,Y,Z}\\!\\left(\\frac{1}{2},y,z\\right)}{f_{X}\\!\\left(\\frac{1}{2}\\right)}\n= \\frac{c\\left(\\frac{1}{2}+y+z\\right)}{1}\n= \\frac{2}{3}\\left(y+z+\\frac{1}{2}\\right),\n$$\n对于 $0 \\le y \\le 1$ 和 $0 \\le z \\le 1$。它在单位正方形上的积分为 $1$，这证实了它是一个有效的条件密度函数。", "answer": "$$\\boxed{\\frac{2}{3}\\left(y+z+\\frac{1}{2}\\right)}$$", "id": "1351401"}, {"introduction": "现在我们进入一个在信号处理等领域中很常见的情景：我们观测到两个随机变量的和，但对其中单个分量的性质感兴趣。这个问题要求在给定总测量噪声的情况下，求解单个噪声源的条件分布 [@problem_id:1351407]。其解法揭示了正态分布一个优美而直观的性质，展示了条件化如何精确我们对系统组件的认识。", "problem": "考虑一个系统，其中信号受到两个噪声源的影响，这两个噪声源由随机变量 $X$ 和 $Y$ 建模。假设这些噪声分量是独立同分布的（i.i.d.），每个都服从均值为 0、方差为 1 的标准正态分布。一个仪器只测量总噪声，即两个分量之和，$S = X + Y$。给定总噪声的一次特定测量值为 $S=s$，求第一个噪声分量的条件概率密度函数（PDF），$f_{X|S}(x|s)$。将您的答案表示为 $x$ 和 $s$ 的函数。", "solution": "设 $X$ 和 $Y$ 是独立的标准正态随机变量，因此 $f_{X}(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^{2}}{2}\\right)$ 且 $f_{Y}(y) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{y^{2}}{2}\\right)$。定义 $S = X + Y$。我们要求解 $f_{X|S}(x|s)$。\n\n根据条件密度的定义，\n$$\nf_{X|S}(x|s) = \\frac{f_{X,S}(x,s)}{f_{S}(s)}.\n$$\n利用关系 $S = X + Y$ 和独立性，给定 $X=x$ 时 $S$ 的条件密度是 $f_{S|X}(s|x) = f_{Y}(s - x)$。因此，\n$$\nf_{X,S}(x,s) = f_{X}(x) f_{S|X}(s|x) = f_{X}(x) f_{Y}(s-x) = \\frac{1}{2\\pi} \\exp\\left(-\\frac{x^{2}}{2}\\right) \\exp\\left(-\\frac{(s-x)^{2}}{2}\\right).\n$$\n$S$ 的边际密度是 $f_{X}$ 和 $f_{Y}$ 的卷积。由于独立正态变量之和仍为正态分布，其均值等于均值之和，方差等于方差之和，我们有 $S \\sim \\mathcal{N}(0,2)$，所以\n$$\nf_{S}(s) = \\frac{1}{\\sqrt{4\\pi}} \\exp\\left(-\\frac{s^{2}}{4}\\right).\n$$\n因此，\n$$\nf_{X|S}(x|s) = \\frac{\\frac{1}{2\\pi} \\exp\\left(-\\frac{x^{2}}{2}\\right) \\exp\\left(-\\frac{(s-x)^{2}}{2}\\right)}{\\frac{1}{\\sqrt{4\\pi}} \\exp\\left(-\\frac{s^{2}}{4}\\right)}.\n$$\n合并分子中的指数部分：\n$$\n-\\frac{x^{2}}{2} - \\frac{(s-x)^{2}}{2} = -\\frac{x^{2} + (s-x)^{2}}{2} = -\\frac{2x^{2} - 2sx + s^{2}}{2} = -x^{2} + sx - \\frac{s^{2}}{2}.\n$$\n减去分母的指数 $-\\frac{s^{2}}{4}$ 得到总的指数部分：\n$$\n-x^{2} + sx - \\frac{s^{2}}{2} + \\frac{s^{2}}{4} = -x^{2} + sx - \\frac{s^{2}}{4}.\n$$\n配方：\n$$\n-x^{2} + sx - \\frac{s^{2}}{4} = -\\left(x - \\frac{s}{2}\\right)^{2}.\n$$\n对于指数前的系数，\n$$\n\\frac{\\frac{1}{2\\pi}}{\\frac{1}{\\sqrt{4\\pi}}} = \\frac{\\sqrt{4\\pi}}{2\\pi} = \\frac{1}{\\sqrt{\\pi}}.\n$$\n因此，\n$$\nf_{X|S}(x|s) = \\frac{1}{\\sqrt{\\pi}} \\exp\\left(-\\left(x - \\frac{s}{2}\\right)^{2}\\right),\n$$\n这是一个均值为 $\\frac{s}{2}$、方差为 $\\frac{1}{2}$ 的正态分布的密度函数，对所有实数 $x$ 和 $s$ 均成立。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{\\pi}}\\exp\\left(-\\left(x-\\frac{s}{2}\\right)^{2}\\right)}$$", "id": "1351407"}, {"introduction": "我们最后的练习将探讨当只观测到系统失效时间时，如何推断其组件的寿命。这个问题通过对两个寿命的最大值（一种常见的冗余系统模型）进行条件化，引入了次序统计量的概念 [@problem_id:1351388]。通过计算条件期望，你将学习如何从系统层面的结果出发，反向推断单个组件的预期行为。", "problem": "一个深空探测器的两个关键但独立的电子元件的寿命分别表示为 $T_1$ 和 $T_2$。这些寿命被建模为独立同分布的随机变量，每个都服从时间区间 $[0, \\theta]$ 上的均匀分布，其中 $\\theta$ 是一个已知的最大可能寿命。探测器的设计使其只要至少有一个元件在工作，就能继续运行。因此，系统故障被记录在时间 $M = \\max(T_1, T_2)$。\n\n假设一个特定的探测器发生故障，故障时间记录为 $M=m$，其中 $m$ 是一个满足 $0  m \\le \\theta$ 的特定值。给定此信息，第一个元件 $T_1$ 的期望寿命是多少？您的答案应该是一个以 $m$ 表示的闭式解析表达式。", "solution": "设 $T_{1}$ 和 $T_{2}$ 是独立同分布的 $\\mathrm{Uniform}(0,\\theta)$ 随机变量，并定义顺序统计量 $T_{(1)}=\\min(T_{1},T_{2})$ 和 $T_{(2)}=\\max(T_{1},T_{2})=M$。对于独立同分布的连续变量，$(T_{(1)},T_{(2)})$ 的联合密度函数为\n$$\nf_{T_{(1)},T_{(2)}}(x,y)=\\frac{2}{\\theta^{2}}, \\quad 0\\le x\\le y\\le \\theta.\n$$\n$M=T_{(2)}$ 的边际密度函数是\n$$\nf_{M}(m)=\\int_{0}^{m}\\frac{2}{\\theta^{2}}\\,dx=\\frac{2m}{\\theta^{2}}, \\quad 0  m \\le \\theta.\n$$\n给定 $M=m$，$T_{(1)}$ 的条件密度函数为\n$$\nf_{T_{(1)}|M}(x|m) = \\frac{f_{T_{(1)},M}(x,m)}{f_M(m)} = \\frac{2/\\theta^2}{2m/\\theta^2} = \\frac{1}{m}, \\quad 0 \\le x  m.\n$$\n这表明，给定 $M=m$，$T_{(1)}$ 在 $[0,m]$ 上是均匀分布的。因此，给定 $M=m$ 时 $T_{(1)}$ 的条件期望为\n$$\nE[T_{(1)}|M=m] = \\int_0^m x \\frac{1}{m} \\,dx = \\frac{m}{2}.\n$$\n$T_1$ 和 $T_2$ 的集合与顺序统计量 $T_{(1)}$ 和 $T_{(2)}$ 的集合是相同的：$\\{T_1, T_2\\} = \\{T_{(1)}, T_{(2)}\\}$。由于 $T_1$ 和 $T_2$ 是独立同分布的，给定 $M=m$， $T_1$ 是最大值（即 $T_{(2)}$）或最小值（即 $T_{(1)}$）的概率是相等的。即 $P(T_1=T_{(1)}|M=m)=P(T_1=T_{(2)}|M=m)=1/2$。因此，我们可以通过对这两种情况的期望进行加权平均来计算 $T_1$ 的条件期望：\n$$\nE[T_1|M=m] = \\frac{1}{2} E[T_{(1)}|M=m] + \\frac{1}{2} E[T_{(2)}|M=m].\n$$\n我们已经知道 $E[T_{(1)}|M=m] = m/2$。显然，$E[T_{(2)}|M=m] = E[m|M=m] = m$。\n代入这些值，我们得到\n$$\nE[T_1|M=m] = \\frac{1}{2}\\left(\\frac{m}{2}\\right) + \\frac{1}{2}(m) = \\frac{m}{4} + \\frac{m}{2} = \\frac{3m}{4}.\n$$", "answer": "$$\\boxed{\\frac{3m}{4}}$$", "id": "1351388"}]}