{"hands_on_practices": [{"introduction": "许多现实世界中的现象可以被建模为多个独立随机过程的总和。本练习提供了一个直观的例子，即学生的考试总分是两个独立部分分数的和。通过解决这个问题[@problem_id:1347381]，你将练习计算独立正态变量之和的均值与方差，并利用这些参数来确定与总和相关的概率，这是将理论应用于实际场景的一项基本技能。", "problem": "一所大学的计算机科学系为其研究生项目设计了一项包含两个部分的综合资格考试。A部分考察理论基础，B部分考察实际应用。学生在每个部分的分数被建模为独立的随机变量。\n\nA部分的分数，记为 $S_A$，服从均值为 $76.5$、标准差为 $8.2$ 的正态分布。\nB部分的分数，记为 $S_B$，服从均值为 $81.0$、标准差为 $9.5$ 的正态分布。\n\n学生的总分是其在A部分和B部分分数之和。计算一个随机选择的学生总分大于 $165.0$ 的概率。\n\n将您的最终答案四舍五入至四位有效数字。", "solution": "设 $S_{A} \\sim \\mathcal{N}(76.5,\\,8.2^{2})$ 和 $S_{B} \\sim \\mathcal{N}(81.0,\\,9.5^{2})$ 且相互独立。总分 $T=S_{A}+S_{B}$ 服从正态分布，其均值和方差由均值之和与方差之和给出（根据独立性以及正态分布在加法下的封闭性）：\n$$\n\\mu_{T}=\\mu_{A}+\\mu_{B}=76.5+81.0=157.5,\\qquad \\sigma_{T}^{2}=\\sigma_{A}^{2}+\\sigma_{B}^{2}=8.2^{2}+9.5^{2}=67.24+90.25=157.49.\n$$\n因此 $T \\sim \\mathcal{N}(157.5,\\,157.49)$ 且 $\\sigma_{T}=\\sqrt{157.49}$。我们要求解\n$$\n\\mathbb{P}(T165)=\\mathbb{P}\\!\\left(\\frac{T-\\mu_{T}}{\\sigma_{T}}\\frac{165-157.5}{\\sqrt{157.49}}\\right)=\\mathbb{P}(Zz),\n$$\n其中 $Z \\sim \\mathcal{N}(0,1)$ 且\n$$\nz=\\frac{165-157.5}{\\sqrt{157.49}}=\\frac{7.5}{\\sqrt{157.49}}\\approx \\frac{7.5}{12.5495}\\approx 0.597633.\n$$\n因此，\n$$\n\\mathbb{P}(T165)=1-\\Phi(z)=1-\\Phi(0.597633).\n$$\n使用标准正态分布，$\\Phi(0.597633)\\approx 0.72496$，因此\n$$\n\\mathbb{P}(T165)\\approx 1-0.72496=0.27504.\n$$\n四舍五入至四位有效数字得到 $0.2750$。", "answer": "$$\\boxed{0.2750}$$", "id": "1347381"}, {"introduction": "超越简单的概率计算，我们可以利用独立正态变量和的性质来进行统计推断。在许多科学领域，我们测量的是一个复合信号，并需要推断其背后各个组成部分的属性。这个练习[@problem_id:1391612]将引导你应用最大似然估计（MLE）的原理，从一个总和的观测值中估计出未知的均值参数$ \\mu $，这在天文学等领域的数据分析中是一项至关重要的技能。", "problem": "在射电天文学中，从遥远天体接收到的信号可能很复杂。考虑一个简化模型，其中来自宇宙源的总测量电压 $Z$ 是两个独立分量之和：一个主信号分量 $X$ 和一个次信号分量 $Y$。\n\n主信号电压 $X$ 被建模为一个随机变量，服从均值未知（为 $\\mu$）且方差已知（为 $\\sigma_1^2$）的正态分布。次信号电压 $Y$ 也被建模为一个正态随机变量。已知其均值与主信号均值呈线性关系，由 $E[Y] = \\alpha \\mu$ 给出，其中 $\\alpha$ 是一个已知的实常数。$Y$ 的方差为已知值 $\\sigma_2^2$。两个信号分量 $X$ 和 $Y$ 是统计独立的。我们已知常数 $\\alpha \\neq -1$。\n\n一位天文学家进行单次测量，并记录下总电压 $Z$。你的任务是找出未知均值 $\\mu$ 的最大似然估计量 (MLE)（记为 $\\hat{\\mu}$）的公式。请用总电压测量值 $Z$ 和已知参数 $\\alpha$、$\\sigma_1$ 和 $\\sigma_2$ 来表示你的答案。", "solution": "设 $X \\sim \\mathcal{N}(\\mu,\\sigma_{1}^{2})$ 和 $Y \\sim \\mathcal{N}(\\alpha \\mu,\\sigma_{2}^{2})$ 相互独立。对于 $Z=X+Y$，根据期望的线性性和独立性，\n$$\nE[Z \\mid \\mu]=E[X]+E[Y]=\\mu+\\alpha \\mu=(1+\\alpha)\\mu,\n$$\n以及\n$$\n\\operatorname{Var}(Z \\mid \\mu)=\\operatorname{Var}(X)+\\operatorname{Var}(Y)=\\sigma_{1}^{2}+\\sigma_{2}^{2}.\n$$\n因此 $Z \\mid \\mu \\sim \\mathcal{N}\\big((1+\\alpha)\\mu,\\ \\sigma_{1}^{2}+\\sigma_{2}^{2}\\big)$。对于单次观测 $Z=z$，似然函数为\n$$\nL(\\mu;z)=\\frac{1}{\\sqrt{2\\pi(\\sigma_{1}^{2}+\\sigma_{2}^{2})}}\\exp\\!\\left(-\\frac{(z-(1+\\alpha)\\mu)^{2}}{2(\\sigma_{1}^{2}+\\sigma_{2}^{2})}\\right).\n$$\n对数似然函数为\n$$\n\\ell(\\mu;z)=-\\frac{1}{2}\\ln\\big(2\\pi(\\sigma_{1}^{2}+\\sigma_{2}^{2})\\big)-\\frac{1}{2(\\sigma_{1}^{2}+\\sigma_{2}^{2})}\\big(z-(1+\\alpha)\\mu\\big)^{2}.\n$$\n对 $\\mu$ 求导并令其为零：\n$$\n\\frac{\\partial \\ell}{\\partial \\mu}=\\frac{(1+\\alpha)}{\\sigma_{1}^{2}+\\sigma_{2}^{2}}\\big(z-(1+\\alpha)\\mu\\big)=0\n\\quad\\Longrightarrow\\quad\nz-(1+\\alpha)\\mu=0,\n$$\n这里我们利用了 $\\alpha\\neq -1$ 的条件，从而可以除以 $(1+\\alpha)$。因此，\n$$\n\\hat{\\mu}=\\frac{z}{1+\\alpha}.\n$$\n二阶导数为\n$$\n\\frac{\\partial^{2}\\ell}{\\partial \\mu^{2}}=-\\frac{(1+\\alpha)^{2}}{\\sigma_{1}^{2}+\\sigma_{2}^{2}}  0,\n$$\n因为 $\\sigma_{1}^{2}+\\sigma_{2}^{2}0$ 且 $\\alpha\\neq -1$，这确认了该点为最大值点。将 $z$ 替换为观测值 $Z$ 得到最大似然估计量\n$$\n\\hat{\\mu}=\\frac{Z}{1+\\alpha}.\n$$", "answer": "$$\\boxed{\\frac{Z}{1+\\alpha}}$$", "id": "1391612"}, {"introduction": "这个高级练习将独立正态变量和的概念与贝叶斯推断及优化决策融为一体。在一个复杂的制造场景中，你需要根据有限的观测数据来调整一个控制参数$ c $，以最大化产品合格率。通过解决这个问题[@problem_id:1391639]，你将学习如何利用贝叶斯方法更新你对系统参数的认知，并基于此进行优化，这体现了现代工程与数据科学中数据驱动决策的核心思想。", "problem": "在一个先进的纳米制造设施中，量子点是分批合成的。任何给定批次中量子点的大小都受到两个层次的统计波动影响。首先，每个批次都有一个系统性的但未知的平均尺寸，记为 $\\mu$。从一个批次到另一个批次，这个平均尺寸 $\\mu$ 会根据一个均值为 $m_0$、方差为 $s_0^2$ 的正态分布波动，即 $\\mu \\sim N(m_0, s_0^2)$。其次，在任何一个具有特定均值 $\\mu$ 的批次内，单个量子点的尺寸 $X$ 会在该均值附近呈正态分布，其方差已知为 $\\sigma_X^2$，即 $X|\\mu \\sim N(\\mu, \\sigma_X^2)$。\n\n为了提高产量，实施了一套质量控制程序。从一个新生产的批次中，随机选择一个量子点，并测量其尺寸为 $x_{obs}$。基于这次单次测量，对同一批次中的所有*其他*量子点应用一个校正性的“生长”过程。该过程会增加一个微小的尺寸分量 $Y$，$Y$ 是一个服从正态分布 $Y \\sim N(c, \\sigma_Y^2)$ 的随机变量。该生长过程的均值 $c$ 是一个可以精确设置的控制参数。因此，一个调整后量子点的最终尺寸为 $Z = X_{new} + Y$，其中 $X_{new}$ 是同一批次中另一个量子点的初始尺寸。\n\n您的任务是确定控制参数 $c$ 的最优设置，以最大化校正后量子点的尺寸落在目标规格区间 $[a, b]$（其中 $a  b$）内的概率。您的答案应基于从单次观测 $x_{obs}$ 中获得的信息。\n\n请用给定的参数（目标区间界限 $a$ 和 $b$、先验分布参数 $m_0$ 和 $s_0^2$、批内方差 $\\sigma_X^2$ 以及观测值 $x_{obs}$）将最优控制参数 $c$ 表示为一个解析表达式。", "solution": "我们按如下方式对该层级结构建模。批次均值满足 $\\mu \\sim N(m_{0}, s_{0}^{2})$。在给定 $\\mu$ 的条件下，任何量子点的尺寸 $X$ 服从 $X \\mid \\mu \\sim N(\\mu, \\sigma_{X}^{2})$。我们从该批次中观测一个量子点，其尺寸为 $x_{obs}$。对于同一批次中的另一个量子点，在校正前，其尺寸 $X_{new} \\mid \\mu \\sim N(\\mu, \\sigma_{X}^{2})$。生长校正量为 $Y \\sim N(c, \\sigma_{Y}^{2})$，且与其他所有变量独立，校正后的尺寸为 $Z = X_{new} + Y$。\n\n首先，利用正态-正态共轭性计算在给定 $x_{obs}$ 条件下 $\\mu$ 的后验分布。后验方差和均值为\n$$\ns_{post}^{2}=\\left(\\frac{1}{s_{0}^{2}}+\\frac{1}{\\sigma_{X}^{2}}\\right)^{-1}, \n\\quad \nm_{post}=s_{post}^{2}\\left(\\frac{m_{0}}{s_{0}^{2}}+\\frac{x_{obs}}{\\sigma_{X}^{2}}\\right)\n=\\frac{s_{0}^{2} x_{obs}+\\sigma_{X}^{2} m_{0}}{s_{0}^{2}+\\sigma_{X}^{2}}.\n$$\n\n通过对 $\\mu$ 积分，可以得到一个未经校正的新量子点的后验预测分布：\n$$\nX_{new} \\mid x_{obs} \\sim N\\!\\left(m_{post},\\, \\sigma_{X}^{2}+s_{post}^{2}\\right).\n$$\n由于 $Y$ 是独立的且 $Z=X_{new}+Y$，我们有\n$$\nZ \\mid x_{obs}, c \\sim N\\!\\left(m_{post}+c,\\, v\\right),\n\\quad \nv=\\sigma_{X}^{2}+s_{post}^{2}+\\sigma_{Y}^{2}.\n$$\n\n对于一个固定的方差 $v$，尺寸落在目标区间 $[a,b]$ 内的概率为\n$$\nP(a \\leq Z \\leq b \\mid x_{obs}, c)\n=\\Phi\\!\\left(\\frac{b-(m_{post}+c)}{\\sqrt{v}}\\right)\n-\\Phi\\!\\left(\\frac{a-(m_{post}+c)}{\\sqrt{v}}\\right),\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。\n\n令 $t=m_{post}+c$ 表示 $Z \\mid x_{obs}, c$ 的均值。定义\n$$\nf(t)=\\Phi\\!\\left(\\frac{b-t}{\\sqrt{v}}\\right)-\\Phi\\!\\left(\\frac{a-t}{\\sqrt{v}}\\right).\n$$\n则\n$$\nf'(t)=\\frac{1}{\\sqrt{v}}\\left[\\phi\\!\\left(\\frac{a-t}{\\sqrt{v}}\\right)-\\phi\\!\\left(\\frac{b-t}{\\sqrt{v}}\\right)\\right],\n$$\n其中 $\\phi$ 是标准正态密度函数。令 $f'(t)=0$ 可得 $\\phi\\!\\left(\\frac{a-t}{\\sqrt{v}}\\right)=\\phi\\!\\left(\\frac{b-t}{\\sqrt{v}}\\right)$，此式成立当且仅当 $t=(a+b)/2$。在 $t=(a+b)/2$ 处的二阶导数为负，证实了这是一个全局最大值。因此，最优均值为 $m_{post}+c^{*}=(a+b)/2$。\n\n求解 $c^{*}$ 可得\n$$\nc^{*}=\\frac{a+b}{2}-m_{post}=\\frac{a+b}{2}-\\frac{s_{0}^{2} x_{obs}+\\sigma_{X}^{2} m_{0}}{s_{0}^{2}+\\sigma_{X}^{2}}.\n$$\n这个选择最大化了 $P(a \\leq Z \\leq b \\mid x_{obs}, c)$，并且它依赖于 $a$、$b$、$m_{0}$、$s_{0}^{2}$、$\\sigma_{X}^{2}$ 和 $x_{obs}$，但与 $\\sigma_{Y}^{2}$ 无关。", "answer": "$$\\boxed{\\frac{a+b}{2}-\\frac{s_{0}^{2}\\,x_{obs}+\\sigma_{X}^{2}\\,m_{0}}{s_{0}^{2}+\\sigma_{X}^{2}}}$$", "id": "1391639"}]}