{"hands_on_practices": [{"introduction": "中心极限定理最常见的应用之一是在质量控制和科学测量领域。即使我们不知道单个测量的精确分布，该定理也允许我们对大量测量的平均值进行可靠的预测。这个练习将通过一个电池容量的实际场景，展示如何利用样本均值的正态近似来评估一个生产批次是否符合质量标准 [@problem_id:1959595]。", "problem": "一家科技公司正在为便携式电子设备开发一种新型固态电池。单个生产级电池单元的能量容量是一个随机变量。虽然电池单元容量的确切分布是复杂且未知的，但生产线上的大量测试已确定其平均容量为 $\\mu = 4250$ 毫安时 (mAh)，标准差为 $\\sigma = 90$ mAh。为了进行质量控制，从每个生产批次中随机抽取 $n=36$ 个电池单元的样本，并测量它们的容量。如果这36个样本电池单元的平均容量超过 $4220$ mAh 的最低阈值，则该批次将被批准发货。假设电池单元的容量是独立同分布的，那么一个随机选择的批次被批准发货的近似概率是多少？\n\n计算这个概率，并将最终答案四舍五入到四位有效数字。", "solution": "设 $X_{1},\\dots,X_{n}$ 为独立同分布的电池单元容量，其均值为 $\\mu=4250$，标准差为 $\\sigma=90$。样本均值为 $\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$，其中 $n=36$。根据中心极限定理，对于足够大的 $n$，$\\bar{X}$ 的分布近似于均值为 $\\mu$、方差为 $\\sigma^{2}/n$ 的正态分布：\n$$\n\\bar{X}\\approx \\mathcal{N}\\!\\left(\\mu,\\frac{\\sigma^{2}}{n}\\right).\n$$\n因此，\n$$\n\\mathbb{P}(\\bar{X}4220)=\\mathbb{P}\\!\\left(\\frac{\\bar{X}-\\mu}{\\sigma/\\sqrt{n}}\\frac{4220-\\mu}{\\sigma/\\sqrt{n}}\\right).\n$$\n代入 $\\mu=4250$，$\\sigma=90$ 和 $n=36$ 来计算标准化阈值：\n$$\n\\frac{4220-4250}{90/\\sqrt{36}}=\\frac{-30}{90/6}=\\frac{-30}{15}=-2.\n$$\n令 $Z\\sim \\mathcal{N}(0,1)$。则\n$$\n\\mathbb{P}(\\bar{X}4220)=\\mathbb{P}(Z-2)=1-\\Phi(-2)=\\Phi(2),\n$$\n使用标准正态累积分布函数 (CDF) $\\Phi$ 的对称性 $\\Phi(-z)=1-\\Phi(z)$。数值上，$\\Phi(2)\\approx 0.977249868\\ldots$，四舍五入到四位有效数字为 $0.9772$。", "answer": "$$\\boxed{0.9772}$$", "id": "1959595"}, {"introduction": "除了样本均值，中心极限定理同样适用于独立随机变量的总和。这个原理在金融、保险和博弈论等领域中至关重要，用于评估累积收益或风险。通过一个有趣的博彩游戏示例，你将练习如何计算重复独立事件的总结果的概率分布，并理解为什么即使单次事件的期望值为负，短期内仍有可能出现各种结果 [@problem_id:1394705]。", "problem": "一家娱乐公司设计了一款名为“巫师赌局”的新嘉年华游戏。玩一局游戏，玩家需支付3.00金币的费用。然后，玩家从一个装有大量石头的大瓮中抽取一颗魔法石。石头分为三种类型：\n\n1.  红宝石，奖励15.00金币。抽到红宝石的概率为0.05。\n2.  蓝宝石，奖励4.00金币。抽到蓝宝石的概率为0.25。\n3.  黑曜石，没有奖励（0.00金币）。抽到黑曜石的概率为0.70。\n\n一位赌徒决定连续玩这个游戏144次。将“总亏损”定义为总支付金额减去赢得的总奖金。假设每局游戏的结果是独立的，使用正态近似法计算该赌徒在144局游戏后的总亏损小于200.00金币的概率。\n\n将你的答案表示为小数，并四舍五入到四位有效数字。", "solution": "设 $L$ 表示单局游戏的亏损，定义为支付金额减去奖金。支付金额为$3$，奖金值为$15$（概率$0.05$）、$4$（概率$0.25$）和$0$（概率$0.70$），则 $L$ 的分布为\n$$\nL=\\begin{cases}\n-12  \\text{with probability } 0.05,\\\\\n-1  \\text{with probability } 0.25,\\\\\n3  \\text{with probability } 0.70.\n\\end{cases}\n$$\n计算 $L$ 的均值和方差：\n$$\n\\mu_{L}=\\mathbb{E}[L]=(-12)(0.05)+(-1)(0.25)+(3)(0.70)=1.25,\n$$\n$$\n\\mathbb{E}[L^{2}]=(-12)^{2}(0.05)+(-1)^{2}(0.25)+(3)^{2}(0.70)=13.75,\n$$\n$$\n\\sigma_{L}^{2}=\\operatorname{Var}(L)=\\mathbb{E}[L^{2}]-(\\mathbb{E}[L])^{2}=13.75-(1.25)^{2}=12.1875.\n$$\n设 $S=\\sum_{i=1}^{144}L_{i}$ 为144次独立游戏的总亏损。则\n$$\n\\mu_{S}=\\mathbb{E}[S]=144\\,\\mu_{L}=144\\cdot 1.25=180,\\qquad \\sigma_{S}^{2}=\\operatorname{Var}(S)=144\\,\\sigma_{L}^{2}=144\\cdot 12.1875=1755.\n$$\n根据中心极限定理，$S$ 近似服从均值为$180$、方差为$1755$的正态分布。所求概率为\n$$\n\\mathbb{P}(S  200)\\approx \\Phi\\!\\left(\\frac{200-\\mu_{S}}{\\sigma_{S}}\\right)=\\Phi\\!\\left(\\frac{20}{\\sqrt{1755}}\\right).\n$$\n数值上，$\\sqrt{1755}\\approx 41.8927$，所以标准化值为\n$$\nz=\\frac{20}{\\sqrt{1755}}\\approx 0.47741,\n$$\n因此\n$$\n\\mathbb{P}(S  200)\\approx \\Phi(0.47741)\\approx 0.6835,\n$$\n四舍五入到四位有效数字。", "answer": "$$\\boxed{0.6835}$$", "id": "1394705"}, {"introduction": "中心极限定理的威力远不止于近似求和或求均值，它也是更高级统计推断工具的基石。例如，Delta方法利用中心极限定理来近似更复杂统计量的分布。本练习将引导你推导对数优势比（log-odds ratio）估计量的渐近方差，这是一个在医学研究和流行病学中广泛使用的重要统计量，它展示了中心极限定理在现代数据分析中的核心作用 [@problem_id:852421]。", "problem": "考虑分别从两个不同的伯努利总体中抽取的两个独立随机样本，其样本量分别为 $n_1$ 和 $n_2$。第一个总体的成功概率为 $p_1$，第二个总体的成功概率为 $p_2$。设 $X_1$ 和 $X_2$ 分别为在第一个和第二个样本中观察到的成功次数。则样本比例由 $\\hat{p}_1 = \\frac{X_1}{n_1}$ 和 $\\hat{p}_2 = \\frac{X_2}{n_2}$ 给出。\n\n在许多统计分析中，特别是在流行病学和临床试验中，对数优势比是一个非常重要的量。真实的对数优势比定义为 $\\theta = \\log\\left(\\frac{p_1/(1-p_1)}{p_2/(1-p_2)}\\right)$。基于样本比例，该量的一个估计量是样本对数优势比：\n$$\n\\hat{\\theta} = \\log\\left(\\frac{\\hat{p}_1/(1-\\hat{p}_1)}{\\hat{p}_2/(1-\\hat{p}_2)}\\right)\n$$\n假设样本量 $n_1$ 和 $n_2$ 足够大，中心极限定理可以通过德尔塔方法（Delta Method）进行扩展，以找到 $\\hat{\\theta}$ 的近似分布。\n\n推导对数优势比估计量 $\\text{Var}(\\hat{\\theta})$ 的渐近方差。", "solution": "问题要求解对数优势比估计量 $\\hat{\\theta}$ 的渐近方差。我们可以使用多元德尔塔方法（multivariate Delta Method）来求解。\n\n首先，根据中心极限定理，对于大样本量 $n_1$ 和 $n_2$，样本比例 $\\hat{p}_1$ 和 $\\hat{p}_2$ 近似服从正态分布：\n$$\n\\hat{p}_1 \\approx N\\left(p_1, \\frac{p_1(1-p_1)}{n_1}\\right)\n$$\n$$\n\\hat{p}_2 \\approx N\\left(p_2, \\frac{p_2(1-p_2)}{n_2}\\right)\n$$\n由于两个样本是独立的，随机变量 $\\hat{p}_1$ 和 $\\hat{p}_2$ 也是独立的。因此，样本比例向量 $\\hat{\\mathbf{p}} = (\\hat{p}_1, \\hat{p}_2)^T$ 服从渐近二元正态分布，其均值向量为 $\\boldsymbol{\\mu}$，协方差矩阵为 $\\boldsymbol{\\Sigma}$：\n$$\n\\boldsymbol{\\mu} = E[\\hat{\\mathbf{p}}] = \\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{\\Sigma} = \\text{Cov}(\\hat{\\mathbf{p}}) = \\begin{pmatrix} \\text{Var}(\\hat{p}_1)  \\text{Cov}(\\hat{p}_1, \\hat{p}_2) \\\\ \\text{Cov}(\\hat{p}_1, \\hat{p}_2)  \\text{Var}(\\hat{p}_2) \\end{pmatrix} = \\begin{pmatrix} \\frac{p_1(1-p_1)}{n_1}  0 \\\\ 0  \\frac{p_2(1-p_2)}{n_2} \\end{pmatrix}\n$$\n估计量 $\\hat{\\theta}$ 是 $\\hat{p}_1$ 和 $\\hat{p}_2$ 的函数。设该函数为 $g(x, y)$：\n$$\ng(x, y) = \\log\\left(\\frac{x/(1-x)}{y/(1-y)}\\right) = \\log(x) - \\log(1-x) - \\log(y) + \\log(1-y)\n$$\n多元德尔塔方法指出，函数 $g(\\hat{\\mathbf{p}})$ 的渐近方差由下式给出：\n$$\n\\text{Var}(g(\\hat{\\mathbf{p}})) \\approx (\\nabla g(\\boldsymbol{\\mu}))^T \\boldsymbol{\\Sigma} (\\nabla g(\\boldsymbol{\\mu}))\n$$\n其中 $\\nabla g(\\boldsymbol{\\mu})$ 是函数 $g$ 在均值向量 $\\boldsymbol{\\mu} = (p_1, p_2)^T$ 处计算的梯度。\n\n首先，我们计算 $g(x, y)$ 的梯度：\n$$\n\\frac{\\partial g}{\\partial x} = \\frac{1}{x} - \\frac{1}{1-x}(-1) = \\frac{1}{x} + \\frac{1}{1-x} = \\frac{1-x+x}{x(1-x)} = \\frac{1}{x(1-x)}\n$$\n$$\n\\frac{\\partial g}{\\partial y} = -\\frac{1}{y} + \\frac{1}{1-y}(-1) = -\\frac{1}{y} - \\frac{1}{1-y} = -\\frac{1-y+y}{y(1-y)} = -\\frac{1}{y(1-y)}\n$$\n所以梯度向量为 $\\nabla g(x,y) = \\left(\\frac{1}{x(1-x)}, -\\frac{1}{y(1-y)}\\right)^T$。\n\n接下来，我们在均值 $\\boldsymbol{\\mu} = (p_1, p_2)^T$ 处计算梯度：\n$$\n\\nabla g(\\boldsymbol{\\mu}) = \\begin{pmatrix} \\frac{1}{p_1(1-p_1)} \\\\ -\\frac{1}{p_2(1-p_2)} \\end{pmatrix}\n$$\n现在，我们可以将梯度和协方差矩阵代入德尔塔方法的方差公式中：\n$$\n\\text{Var}(\\hat{\\theta}) \\approx \n\\begin{pmatrix} \\frac{1}{p_1(1-p_1)}  -\\frac{1}{p_2(1-p_2)} \\end{pmatrix}\n\\begin{pmatrix} \\frac{p_1(1-p_1)}{n_1}  0 \\\\ 0  \\frac{p_2(1-p_2)}{n_2} \\end{pmatrix}\n\\begin{pmatrix} \\frac{1}{p_1(1-p_1)} \\\\ -\\frac{1}{p_2(1-p_2)} \\end{pmatrix}\n$$\n我们从左到右进行矩阵乘法。首先，将行向量（梯度的转置）与协方差矩阵相乘：\n$$\n\\begin{pmatrix} \\frac{1}{p_1(1-p_1)} \\cdot \\frac{p_1(1-p_1)}{n_1} + (-\\frac{1}{p_2(1-p_2)}) \\cdot 0  \\frac{1}{p_1(1-p_1)} \\cdot 0 + (-\\frac{1}{p_2(1-p_2)}) \\cdot \\frac{p_2(1-p_2)}{n_2} \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} \\frac{1}{n_1}  -\\frac{1}{n_2} \\end{pmatrix}\n$$\n最后，将得到的行向量与列向量（梯度）相乘：\n$$\n\\text{Var}(\\hat{\\theta}) \\approx \\begin{pmatrix} \\frac{1}{n_1}  -\\frac{1}{n_2} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{p_1(1-p_1)} \\\\ -\\frac{1}{p_2(1-p_2)} \\end{pmatrix}\n$$\n$$\n= \\left(\\frac{1}{n_1}\\right) \\left(\\frac{1}{p_1(1-p_1)}\\right) + \\left(-\\frac{1}{n_2}\\right) \\left(-\\frac{1}{p_2(1-p_2)}\\right)\n$$\n$$\n= \\frac{1}{n_1 p_1 (1-p_1)} + \\frac{1}{n_2 p_2 (1-p_2)}\n$$\n这就是对数优势比估计量的渐近方差。", "answer": "$$\n\\boxed{\\frac{1}{n_1 p_1 (1-p_1)} + \\frac{1}{n_2 p_2 (1-p_2)}}\n$$", "id": "852421"}]}