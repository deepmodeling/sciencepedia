{"hands_on_practices": [{"introduction": "这项练习将引导你处理一个在大规模数据分析或质量控制中常见的场景。你将学习如何应用二项近似来计算在随机样本中找到特定数量目标项的概率，这是处理巨大总体时的一项基本技能。[@problem_id:1346396]", "problem": "一个大型社交媒体平台拥有总共 $N = 10,000,000$ 名活跃用户。在这个用户群体中，有 $K = 1,000$ 个账户被指定为经过验证的“影响者”。为了一项市场营销研究，一家公司从全体活跃用户中随机抽取了一个大小为 $n = 500$ 的样本。假设这个样本是无放回抽取的，计算该样本中恰好包含一个影响者账户的概率。\n\n请将您的答案以一个实数的形式给出，并四舍五入到三位有效数字。", "solution": "从一个包含 $N$ 个总用户和 $K$ 个影响者的有限总体中，通过无放回简单随机抽样得到的样本中，影响者账户的数量服从超几何分布。大小为 $n$ 的样本中恰好包含一个影响者的概率为\n$$\nP(X=1)=\\frac{\\binom{K}{1}\\binom{N-K}{n-1}}{\\binom{N}{n}}.\n$$\n代入 $N=10^{7}$，$K=10^{3}$ 和 $n=500$，我们得到\n$$\nP(X=1)=\\frac{\\binom{10^{3}}{1}\\binom{10^{7}-10^{3}}{499}}{\\binom{10^{7}}{500}}.\n$$\n因为 $n \\ll N$，超几何分布可以很好地用成功概率为 $p=K/N=10^{-4}$ 的二项分布来近似。因此，\n$$\nP(X=1)\\approx \\binom{500}{1}\\,p\\,(1-p)^{499}=500\\cdot 10^{-4}\\,(1-10^{-4})^{499}=0.05\\,(0.9999)^{499}.\n$$\n为了精确计算 $(0.9999)^{499}$，我们使用对数和泰勒展开式 $\\ln(1-x)=-x-\\frac{x^{2}}{2}-\\frac{x^{3}}{3}-\\cdots$（对于 $|x|1$），其中 $x=10^{-4}$：\n$$\n\\ln\\big((0.9999)^{499}\\big)=499\\,\\ln(1-10^{-4})\\approx -499\\left(10^{-4}+\\frac{10^{-8}}{2}+\\frac{10^{-12}}{3}\\right).\n$$\n这得到\n$$\n\\ln\\big((0.9999)^{499}\\big)\\approx -\\left(0.0499+0.000002495+1.663\\ldots\\times 10^{-10}\\right)\\approx -0.049902495,\n$$\n所以\n$$\n(0.9999)^{499}\\approx \\exp(-0.049902495)\\approx 0.951322.\n$$\n因此，\n$$\nP(X=1)\\approx 0.05\\times 0.951322\\approx 0.047566.\n$$\n考虑到当 $n/N=5\\times 10^{-5}$ 时，在三位有效数字的精度下，有限总体校正是可以忽略的，四舍五入到三位有效数字得到\n$$\nP(X=1)\\approx 0.0476.\n$$", "answer": "$$\\boxed{0.0476}$$", "id": "1346396"}, {"introduction": "在基础二项近似之上，本练习引入了一种二次近似非常有效的情形。我们将探讨一个事件发生概率极低的情况，此时泊松分布成为简化计算的绝佳工具，可以避免繁琐的运算。[@problem_id:1346441]", "problem": "一家大型出版社刚刚完成了一部备受期待的小说的印刷，共计1,000,000册。由于印刷过程中的短暂校准失误，其中恰好有450册存在某一特定页面印反的情况，这些被视为次品。一家大型连锁书店收到了一批货，包含从这批总印数中随机抽取的120册小说。\n\n使用合适的近似方法，计算该书店收到的这批货中至多包含一册印刷错误的书的概率。将最终答案四舍五入至四位有效数字。", "solution": "设总印数为 $N=10^{6}$，次品数量为 $D=450$，书店收到的样本量为 $n=120$。设 $X$ 表示样本中的次品数量。其精确分布是超几何分布：\n$$\n\\Pr(X=k)=\\frac{\\binom{D}{k}\\binom{N-D}{n-k}}{\\binom{N}{n}},\\quad k=0,1,\\dots,n.\n$$\n我们要求解 $\\Pr(X\\le 1)=\\Pr(X=0)+\\Pr(X=1)$。因为 $n\\ll N$ 且 $p=D/N$ 非常小，所以超几何分布可以很好地用二项分布 $X\\sim\\text{Binomial}(n,p)$ 来近似，其中\n$$\np=\\frac{D}{N}=\\frac{450}{10^{6}}=0.00045.\n$$\n由于 $np=120\\times 0.00045=0.054\\ll 1$，使用泊松近似是合适的，其率（或称强度）为 $\\lambda=np$：\n$$\nX\\approx \\text{Poisson}(\\lambda),\\quad \\lambda=np=0.054.\n$$\n对于一个泊松变量，\n$$\n\\Pr(X\\le 1)=\\Pr(X=0)+\\Pr(X=1)=\\exp(-\\lambda)\\left(1+\\lambda\\right).\n$$\n代入 $\\lambda=0.054$，\n$$\n\\Pr(X\\le 1)\\approx \\exp(-0.054)\\left(1+0.054\\right).\n$$\n数值计算得，\n$$\n\\exp(-0.054)\\left(1+0.054\\right)\\approx 0.998593\\ldots\n$$\n四舍五入至四位有效数字，得到 $0.9986$。", "answer": "$$\\boxed{0.9986}$$", "id": "1346441"}, {"introduction": "这个问题将我们的视角从“在固定样本中计数”转变为“确定需要等待多久才能观察到某个事件”。通过计算在特定抽取次数时首次发现不合格品的概率，你将看到近似原理如何通过几何分布扩展到等待时间问题上。[@problem_id:1346389]", "problem": "在一个工厂的质检部门，有一大批共 $1,000,000$ 个电阻需要检验。已知这批货中恰好有 $500$ 个不合格的电阻。一名检验员从这批货中随机地、不放回地逐个抽取电阻。发现的第一个不合格电阻恰好是抽取的第 $100$ 个电阻的概率是多少？\n\n将你的最终答案四舍五入到四位有效数字。", "solution": "设 $N$ 为电阻总数，$K$ 为不合格电阻的数量，$G = N - K$ 为合格电阻的数量，并设 $r$ 为第一次出现不合格电阻时的抽取次数。抽样是不放回的。\n\n前 $r-1$ 次抽取都是合格的，而第 $r$ 次抽取是不合格的概率是\n$$\nP(r) = \\left(\\prod_{i=0}^{r-2} \\frac{G - i}{N - i}\\right)\\cdot \\frac{K}{N - (r - 1)}.\n$$\n在本题中，$N = 10^{6}$，$K = 500$，$G = 999{,}500$，且 $r = 100$，所以\n$$\nP(100) = \\left(\\prod_{i=0}^{98} \\frac{999{,}500 - i}{1{,}000{,}000 - i}\\right)\\cdot \\frac{500}{1{,}000{,}000 - 99}.\n$$\n\n为了进行四位有效数字的数值计算，设 $p = \\frac{K}{N} = 5 \\times 10^{-4}$。对于大的 $N$ 和 $r \\ll N$，\n$$\n\\prod_{i=0}^{98} \\frac{N - K - i}{N - i} = \\prod_{i=0}^{98} \\left(1 - \\frac{K}{N - i}\\right) \\approx (1 - p)^{99} \\cdot \\exp\\!\\left(\\sum_{i=0}^{98} \\left[\\ln\\!\\left(1 - \\frac{K}{N - i}\\right) - \\ln(1 - p)\\right]\\right).\n$$\n指数中的修正项很小；到一阶，\n$$\n\\sum_{i=0}^{98} \\left[\\ln\\!\\left(1 - \\frac{K}{N - i}\\right) - \\ln(1 - p)\\right] \\approx -\\frac{p}{1 - p}\\sum_{i=0}^{98}\\sum_{m=1}^{\\infty} \\left(\\frac{i}{N}\\right)^{m} \\approx -\\frac{p}{1 - p}\\left(\\frac{\\sum i}{N} + \\frac{\\sum i^{2}}{N^{2}} + \\frac{\\sum i^{3}}{N^{3}}\\right),\n$$\n其中 $\\sum_{i=0}^{98} i = 4851$，$\\sum_{i=0}^{98} i^{2} = 318{,}549$，以及 $\\sum_{i=0}^{98} i^{3} = 23{,}532{,}201$。这产生一个量级为 $10^{-5}$ 的相对修正，远小于主项。\n\n通过对数计算主因子 $(1 - p)^{99}$。对 $x = 0.0005$ 使用级数 $\\ln(1 - x) = -x - \\frac{x^{2}}{2} - \\frac{x^{3}}{3} - \\frac{x^{4}}{4} - \\cdots$，\n$$\n\\ln(1 - 0.0005) \\approx -0.0005 - \\frac{(0.0005)^{2}}{2} - \\frac{(0.0005)^{3}}{3} - \\frac{(0.0005)^{4}}{4} \\approx -0.0005001250000416823.\n$$\n因此\n$$\n(1 - p)^{99} = \\exp\\!\\big(99 \\ln(1 - 0.0005)\\big) \\approx \\exp(-0.04951237500412655).\n$$\n使用级数 $\\exp(-a) = 1 - a + \\frac{a^{2}}{2} - \\frac{a^{3}}{6} + \\frac{a^{4}}{24} - \\cdots$，其中 $a = 0.049512375$，并计算\n$$\na^{2} = 0.002451475278140625,\\quad a^{3} = 0.00012137836327452793,\\quad a^{4} = 0.000006009731039334655,\n$$\n得到\n$$\n\\exp(-a) \\approx 1 - 0.049512375 + \\frac{0.002451475278140625}{2} - \\frac{0.00012137836327452793}{6} + \\frac{0.000006009731039334655}{24} \\approx 0.9516933833173.\n$$\n因此\n$$\n(1 - p)^{99} \\approx 0.9516933833173,\\quad p(1 - p)^{99} \\approx 0.00047584669165865.\n$$\n精确表达式包含因子 $\\frac{K}{N - 99}$ 而不是 $p$，即，乘以 $\\frac{N}{N - 99}$。使用几何级数，\n$$\n\\frac{N}{N - 99} = \\frac{1}{1 - \\frac{99}{10^{6}}} \\approx 1 + \\frac{99}{10^{6}} + \\left(\\frac{99}{10^{6}}\\right)^{2} + \\left(\\frac{99}{10^{6}}\\right)^{3} \\approx 1.0000990098019703.\n$$\n来自变化的分母因子的小乘积修正，相对地将结果改变了约 $-2.4 \\times 10^{-6}$，与上述调整相比，在四位有效数字的精度下可以忽略不计。综合起来，\n$$\nP(100) \\approx 0.00047584669165865 \\times 1.0000990098019703 \\approx 0.0004758927.\n$$\n四舍五入到四位有效数字得到 $0.0004759$。", "answer": "$$\\boxed{0.0004759}$$", "id": "1346389"}]}