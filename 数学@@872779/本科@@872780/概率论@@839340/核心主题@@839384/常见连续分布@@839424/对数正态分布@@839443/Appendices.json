{"hands_on_practices": [{"introduction": "理解一个概率分布的期望值是掌握其特性的第一步。这个练习将引导你从对数正态分布最基本的定义出发，即其对数服从正态分布，来推导其期望值的表达式 [@problem_id:10657]。通过这个推导，你不仅能得到一个重要的公式，更能加深对正态分布与对数正态分布之间深刻联系的理解。", "problem": "如果一个随机变量 $X$ 的自然对数 $Y = \\ln(X)$ 服从正态分布，则称该随机变量 $X$ 服从对数正态分布。服从正态分布的变量 $Y$ 的概率密度函数 (PDF) 由下式给出：\n$$f_Y(y) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y-\\mu)^2}{2\\sigma^2}\\right)$$\n其中 $\\mu$ 是 $Y$ 的均值，$\\sigma^2$ 是 $Y$ 的方差。\n\n利用 $X$ 和 $Y$ 之间的关系以及所提供的 $Y$ 的概率密度函数，推导出随机变量 $X$ 的期望值，记作 $E[X]$。请用参数 $\\mu$ 和 $\\sigma$ 表示您的答案。", "solution": "我们希望计算\n$$E[X]\\;=\\;\\int_{0}^{\\infty} x\\,f_{X}(x)\\,dx$$\n其中 $X=\\exp(Y)$ 且 $Y\\sim N(\\mu,\\sigma^2)$。使用换元法 $y=\\ln(x)$，得到 $x=e^{y}$ 和 $dx=e^{y}dy$，且 $X$ 的概率密度函数为\n$$f_{X}(x)=f_{Y}(\\ln x)\\,\\frac{1}{x} \n=\\frac{1}{\\sqrt{2\\pi\\sigma^{2}}}\\,\\exp\\!\\Bigl(-\\frac{(\\ln x-\\mu)^{2}}{2\\sigma^{2}}\\Bigr)\\,\\frac{1}{x}\\,. $$\n因此\n$$\nE[X]\n=\\int_{0}^{\\infty}x\\;\\frac{1}{\\sqrt{2\\pi\\sigma^{2}}}\n\\exp\\!\\Bigl(-\\frac{(\\ln x-\\mu)^{2}}{2\\sigma^{2}}\\Bigr)\\,\\frac{1}{x}\\;dx\n=\\frac{1}{\\sqrt{2\\pi\\sigma^{2}}}\n\\int_{0}^{\\infty}\n\\exp\\!\\Bigl(-\\frac{(\\ln x-\\mu)^{2}}{2\\sigma^{2}}\\Bigr)\\,dx.\n$$\n现在我们令\n$$t=\\frac{\\ln x-\\mu}{\\sigma},\\quad \\ln x=\\sigma t+\\mu,\\quad dx=\\sigma e^{\\sigma t+\\mu}\\,dt,$$\n这样 $x=e^{\\sigma t+\\mu}$ 且积分限从 $x=0\\to t=-\\infty$，$x\\to\\infty\\to t=+\\infty$。代入可得\n$$\nE[X]\n=\\frac{1}{\\sqrt{2\\pi\\sigma^{2}}}\n\\int_{-\\infty}^{\\infty}\n\\exp\\!\\Bigl(-\\frac{(\\sigma t)^{2}}{2\\sigma^{2}}\\Bigr)\\,\\sigma e^{\\sigma t+\\mu}\\,dt\n=\\frac{\\sigma e^{\\mu}}{\\sqrt{2\\pi\\sigma^{2}}}\n\\int_{-\\infty}^{\\infty}\n\\exp\\!\\Bigl(-\\tfrac{t^{2}}{2}+\\sigma t\\Bigr)\\,dt.\n$$\n对指数部分进行配方：\n$$\n-\\tfrac{t^{2}}{2}+\\sigma t\n=-\\tfrac{1}{2}\\bigl(t^{2}-2\\sigma t\\bigr)\n=-\\tfrac{1}{2}\\bigl((t-\\sigma)^{2}-\\sigma^{2}\\bigr)\n=-\\tfrac{(t-\\sigma)^{2}}{2}+\\tfrac{\\sigma^{2}}{2}\\,.\n$$\n于是\n$$\nE[X]\n=\\frac{e^{\\mu}}{\\sqrt{2\\pi}}\n\\int_{-\\infty}^{\\infty}\n\\exp\\!\\Bigl(-\\tfrac{(t-\\sigma)^{2}}{2}+\\tfrac{\\sigma^{2}}{2}\\Bigr)\\,dt\n=e^{\\mu+\\frac{\\sigma^{2}}{2}}\n\\frac{1}{\\sqrt{2\\pi}}\n\\int_{-\\infty}^{\\infty}\n\\exp\\!\\Bigl(-\\tfrac{u^{2}}{2}\\Bigr)\\,du\n$$\n在令 $u=t-\\sigma$ 之后。剩余的高斯积分值为 $\\sqrt{2\\pi}$，从而得到最终结果。", "answer": "$$\\boxed{e^{\\mu + \\frac{\\sigma^{2}}{2}}}$$", "id": "10657"}, {"introduction": "理论知识的最终目的是应用于实际问题。本练习将向你展示如何利用对数正态分布的核心性质来计算概率，这是一个非常实用的技能 [@problem_id:10634]。这个过程的关键在于“标准化”技巧，它将一个特定的对数正态变量的概率问题，转化为一个关于标准正态分布的问题，从而可以使用标准正态累积分布函数 $\\Phi(z)$ 来求解。", "problem": "如果一个随机变量 $X$ 的自然对数 $Y = \\ln(X)$ 服从正态分布，那么称该随机变量 $X$ 服从对数正态分布。正态变量 $Y$ 的概率密度函数 (PDF) 由下式给出：\n$$f_Y(y) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(y-\\mu)^2}{2\\sigma^2}\\right)$$\n其中 $\\mu$ 是 $Y$ 的均值，$\\sigma$ 是 $Y$ 的标准差。\n\n*标准正态*分布（均值为 $0$，标准差为 $1$ 的正态分布）的累积分布函数 (CDF) 记为 $\\Phi(z)$，定义为标准正态随机变量小于或等于 $z$ 的概率。即：\n$$\\Phi(z) = P(Z \\le z) = \\int_{-\\infty}^{z} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{t^2}{2}\\right) dt$$\n\n根据这些信息，推导对数正态变量 $X$ 超过值 $e^{\\mu+\\sigma}$ 的概率的表达式，即 $P(X  e^{\\mu+\\sigma})$。你的最终答案应使用标准正态 CDF $\\Phi$ 来表示。", "solution": "我们有 $X$ 服从对数正态分布，且 $Y=\\ln X\\sim N(\\mu,\\sigma^2)$。那么\n$$P\\bigl(Xe^{\\mu+\\sigma}\\bigr)\n  =P\\bigl(\\ln X\\mu+\\sigma\\bigr)\n  =P\\bigl(Y\\mu+\\sigma\\bigr).$$\n通过 $Z=(Y-\\mu)/\\sigma\\sim N(0,1)$ 来标准化 $Y$：\n$$P\\bigl(Y\\mu+\\sigma\\bigr)\n  =P\\Bigl(\\frac{Y-\\mu}{\\sigma}1\\Bigr)\n  =P(Z1)\n  =1-\\Phi(1).$$", "answer": "$$\\boxed{1-\\Phi(1)}$$", "id": "10634"}, {"introduction": "在金融、工程和生物科学等领域，我们常常需要根据观测数据来估计最能描述这些数据的概率分布参数。这个练习将带你进入统计推断的核心，推导对数正态分布参数 $\\mu$ 和 $\\sigma^2$ 的最大似然估计量（MLE） [@problem_id:1401201]。掌握最大似然估计方法是数据分析中的一项高级但至关重要的技能，它为你提供了一种从数据中学习并建立模型的强大通用框架。", "problem": "一组由随机变量 $X_1, X_2, \\dots, X_n$ 表示的 $n$ 次测量值，被认为是独立同分布的 (i.i.d.)。这些测量值由对数正态分布建模。\n\n如果一个随机变量 $X$ 的自然对数 $\\ln(X)$ 服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布，那么我们称 $X$ 服从参数为 $\\mu$ 和 $\\sigma^2$ 的对数正态分布。$X$ 的概率密度函数 (PDF) 为：\n$$\nf(x; \\mu, \\sigma^2) = \\frac{1}{x \\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(x) - \\mu)^2}{2\\sigma^2}\\right)\n$$\n其中 $x  0$，$\\mu \\in \\mathbb{R}$，且 $\\sigma  0$。\n\n给定一组观测样本数据 $x_1, x_2, \\dots, x_n$，求参数 $\\mu$ 和 $\\sigma^2$ 的最大似然估计量 (MLE)，分别记为 $\\hat{\\mu}$ 和 $\\hat{\\sigma}^2$。用样本观测值表示 $\\hat{\\mu}$ 和 $\\hat{\\sigma}^2$ 的最终答案。", "solution": "设 $X_{1},\\dots,X_{n}$ 是独立同分布的，其对数正态密度函数为\n$$\nf(x;\\mu,\\sigma^{2})=\\frac{1}{x\\sigma\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{(\\ln(x)-\\mu)^{2}}{2\\sigma^{2}}\\right),\\quad x0,\\ \\mu\\in\\mathbb{R},\\ \\sigma0.\n$$\n观测值 $x_{1},\\dots,x_{n}$ 的似然函数为\n$$\nL(\\mu,\\sigma^{2})=\\prod_{i=1}^{n}\\frac{1}{x_{i}\\sigma\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{(\\ln(x_{i})-\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n对数似然函数为\n$$\n\\ell(\\mu,\\sigma^{2})=\\ln L(\\mu,\\sigma^{2})=-n\\ln\\sigma-\\sum_{i=1}^{n}\\ln(x_{i})-\\frac{n}{2}\\ln(2\\pi)-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}\\left(\\ln(x_{i})-\\mu\\right)^{2}.\n$$\n等价地，使用 $\\ln\\sigma=\\frac{1}{2}\\ln(\\sigma^{2})$，\n$$\n\\ell(\\mu,\\sigma^{2})=-\\frac{n}{2}\\ln(\\sigma^{2})-\\sum_{i=1}^{n}\\ln(x_{i})-\\frac{n}{2}\\ln(2\\pi)-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}\\left(\\ln(x_{i})-\\mu\\right)^{2}.\n$$\n对 $\\mu$ 求导：\n$$\n\\frac{\\partial \\ell}{\\partial \\mu}=-\\frac{1}{2\\sigma^{2}}\\cdot 2\\sum_{i=1}^{n}\\left(\\ln(x_{i})-\\mu\\right)(-1)=\\frac{1}{\\sigma^{2}}\\sum_{i=1}^{n}\\left(\\ln(x_{i})-\\mu\\right).\n$$\n令其为零并求解：\n$$\n\\sum_{i=1}^{n}\\ln(x_{i})-n\\mu=0\\quad\\Rightarrow\\quad \\hat{\\mu}=\\frac{1}{n}\\sum_{i=1}^{n}\\ln(x_{i}).\n$$\n二阶导数 $\\partial^{2}\\ell/\\partial\\mu^{2}=-n/\\sigma^{2}0$ 证实了这是关于 $\\mu$ 的一个最大值。\n\n现在对 $\\sigma^{2}$ 求导。令 $S(\\mu)=\\sum_{i=1}^{n}(\\ln(x_{i})-\\mu)^{2}$。那么\n$$\n\\ell(\\mu,\\sigma^{2})=-\\frac{n}{2}\\ln(\\sigma^{2})-\\sum_{i=1}^{n}\\ln(x_{i})-\\frac{n}{2}\\ln(2\\pi)-\\frac{S(\\mu)}{2\\sigma^{2}},\n$$\n所以\n$$\n\\frac{\\partial \\ell}{\\partial \\sigma^{2}}=-\\frac{n}{2}\\frac{1}{\\sigma^{2}}+\\frac{S(\\mu)}{2}\\frac{1}{\\sigma^{4}}.\n$$\n令其为零：\n$$\n-\\frac{n}{2}\\frac{1}{\\sigma^{2}}+\\frac{S(\\mu)}{2}\\frac{1}{\\sigma^{4}}=0\\ \\Longrightarrow\\ -n\\sigma^{2}+S(\\mu)=0\\ \\Longrightarrow\\ \\hat{\\sigma}^{2}=\\frac{S(\\hat{\\mu})}{n}.\n$$\n代入 $\\hat{\\mu}$：\n$$\n\\hat{\\sigma}^{2}=\\frac{1}{n}\\sum_{i=1}^{n}\\left(\\ln(x_{i})-\\frac{1}{n}\\sum_{j=1}^{n}\\ln(x_{j})\\right)^{2}.\n$$\n关于 $t=\\sigma^{2}$ 的二阶导数检验给出 $\\ell''(t)=(n/2)t^{-2}-S(\\mu)t^{-3}$，在 $t=\\hat{\\sigma}^{2}$ 处，利用 $S(\\hat{\\mu})=n\\hat{\\sigma}^{2}$，可得 $\\ell''(\\hat{\\sigma}^{2})=-(n/2)\\hat{\\sigma}^{-4}0$，这证实了它是一个最大值。\n\n因此，最大似然估计量是变换后数据 $\\ln(x_{i})$ 的样本均值和（未修正的）样本方差。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{n}\\sum_{i=1}^{n}\\ln(x_{i})  \\frac{1}{n}\\sum_{i=1}^{n}\\left(\\ln(x_{i})-\\frac{1}{n}\\sum_{j=1}^{n}\\ln(x_{j})\\right)^{2}\\end{pmatrix}}$$", "id": "1401201"}]}