{"hands_on_practices": [{"introduction": "这个练习将混合分布的概念置于一个非常实际的场景中：根据天气状况（晴天或阴天）对太阳能电池板的能量输出进行建模。通过解决这个问题 [@problem_id:1375739]，你将练习使用全概率公式，这是一个计算混合总体中事件概率的基本工具。这是一个很好的起点，可以让你直观地理解混合模型是如何通过其组成部分的加权贡献来定义的。", "problem": "一个研究团队正在对某一特定地区一种新型太阳能电池板的每日能量产出进行建模。每日能量产出（我们称之为 $X$），以千瓦时（kWh）为单位，被发现可以很好地用两个正态分布的混合来近似，这两个分布分别对应于“阴天”或“晴天”。\n\n在归类为阴天的日子里，能量产出 $X_C$ 服从均值为 $\\mu_C = 12$ kWh、标准差为 $\\sigma_C = 2$ kWh 的正态分布。\n在归类为晴天的日子里，能量产出 $X_S$ 服从均值为 $\\mu_S = 28$ kWh、标准差为 $\\sigma_S = 4$ kWh 的正态分布。\n\n该地区的气象数据表明，任意一天为晴天的概率是 $p_S = 0.7$。任何不是晴天的日子都被认为是阴天。\n\n为方便计算，您可以使用标准正态分布 $Z \\sim N(0, 1)$ 的累积分布函数（CDF）的以下值，其中 $\\Phi(z) = P(Z \\le z)$：\n$\\Phi(1.00) = 0.8413$\n$\\Phi(3.50) = 0.9998$\n\n计算随机选择的一天中，太阳能电池板产生的能量大于 $14$ kWh 的概率。将您的答案表示为保留四位有效数字的小数。", "solution": "设 $S$ 表示晴天，$C$ 表示阴天。根据全概率公式，\n$$\nP(X14)=P(X14\\mid S)P(S)+P(X14\\mid C)P(C).\n$$\n给定 $p_{S}=P(S)=0.7$，可得 $P(C)=1-p_{S}=0.3$。\n\n对于一个正态随机变量 $X\\sim N(\\mu,\\sigma^{2})$，用 $Z=\\frac{X-\\mu}{\\sigma}\\sim N(0,1)$ 进行标准化。那么 $P(Xa)=P\\!\\left(Z\\frac{a-\\mu}{\\sigma}\\right)$。\n\n阴天情况：$X_{C}\\sim N(\\mu_{C},\\sigma_{C}^{2})$，其中 $\\mu_{C}=12$，$\\sigma_{C}=2$。\n$$\nP(X_{C}14)=P\\!\\left(Z\\frac{14-12}{2}\\right)=P(Z1)=1-\\Phi(1)=1-0.8413=0.1587.\n$$\n\n晴天情况：$X_{S}\\sim N(\\mu_{S},\\sigma_{S}^{2})$，其中 $\\mu_{S}=28$，$\\sigma_{S}=4$。\n$$\nP(X_{S}14)=P\\!\\left(Z\\frac{14-28}{4}\\right)=P(Z-3.5)=\\Phi(3.5)=0.9998.\n$$\n\n合并：\n$$\nP(X14)=0.3\\times 0.1587+0.7\\times 0.9998=0.04761+0.69986=0.74747.\n$$\n保留四位有效数字，结果为 $0.7475$。", "answer": "$$\\boxed{0.7475}$$", "id": "1375739"}, {"introduction": "在掌握了如何计算概率之后，我们现在转向分析混合分布的另一个关键特征：方差。这个问题 [@problem_id:1375781] 使用高速公路交通流量作为例子，该流量在高峰和非高峰时段之间切换。这个练习旨在阐明一个重要观点：混合分布的总方差不仅仅是各组分方差的加权平均；它还包含一个额外的项，该项源于各组分均值本身的变化。要准确计算总方差，你需要应用全方差公式。", "problem": "一个交通监控系统记录在为期一分钟的间隔内，通过高速公路上一个特定点的车辆数量 $N$。交通流被建模为存在于以下两种状态之一：“高峰时段”或“非高峰时段”。任意随机选取的一分钟间隔属于高峰时段的概率由一个常数 $w$ 给出，其中 $0  w  1$。\n\n在高峰时段的一分钟内，车辆数量 $N$ 服从泊松分布，平均速率为每分钟 $\\lambda_R$ 辆车。在非高峰时段的一分钟内，$N$ 服从另一个泊松分布，平均速率为每分钟 $\\lambda_{OP}$ 辆车，其中 $\\lambda_R  \\lambda_{OP}$。\n\n您的任务是确定在随机选择的一分钟间隔内观察到的车辆数量的总体方差 $\\text{Var}(N)$。请用 $w$、$\\lambda_R$ 和 $\\lambda_{OP}$ 表示您的答案，形式为单个闭式解析表达式。", "solution": "令 $S$ 表示交通状态，有 $\\Pr(S=\\text{rush})=w$ 和 $\\Pr(S=\\text{off-peak})=1-w$。在给定 $S$ 的条件下，$N$ 服从泊松分布：$N|S=\\text{rush} \\sim \\text{Poisson}(\\lambda_{R})$ 和 $N|S=\\text{off-peak} \\sim \\text{Poisson}(\\lambda_{OP})$。对于参数为 $\\lambda$ 的泊松分布，其均值和方差均为 $\\lambda$，所以\n$$\n\\mathbb{E}[N \\mid S=\\text{rush}] = \\lambda_{R}, \\quad \\mathbb{V}\\text{ar}(N \\mid S=\\text{rush}) = \\lambda_{R},\n$$\n$$\n\\mathbb{E}[N \\mid S=\\text{off-peak}] = \\lambda_{OP}, \\quad \\mathbb{V}\\text{ar}(N \\mid S=\\text{off-peak}) = \\lambda_{OP}.\n$$\n根据全方差公式，\n$$\n\\mathbb{V}\\text{ar}(N) = \\mathbb{E}\\big[\\mathbb{V}\\text{ar}(N \\mid S)\\big] + \\mathbb{V}\\text{ar}\\big(\\mathbb{E}[N \\mid S]\\big).\n$$\n我们分别计算这两项。首先，\n$$\n\\mathbb{E}\\big[\\mathbb{V}\\text{ar}(N \\mid S)\\big] = w \\lambda_{R} + (1-w) \\lambda_{OP}.\n$$\n其次，定义 $M=\\mathbb{E}[N \\mid S]$，它以概率 $w$ 等于 $\\lambda_{R}$，并以概率 $1-w$ 等于 $\\lambda_{OP}$。那么\n$$\n\\mathbb{E}[M] = w \\lambda_{R} + (1-w) \\lambda_{OP}, \\quad \\mathbb{E}[M^{2}] = w \\lambda_{R}^{2} + (1-w) \\lambda_{OP}^{2},\n$$\n所以\n$$\n\\mathbb{V}\\text{ar}(M) = \\mathbb{E}[M^{2}] - \\big(\\mathbb{E}[M]\\big)^{2} = w \\lambda_{R}^{2} + (1-w) \\lambda_{OP}^{2} - \\big(w \\lambda_{R} + (1-w) \\lambda_{OP}\\big)^{2}.\n$$\n展开并化简可得\n$$\n\\mathbb{V}\\text{ar}(M) = w(1-w)(\\lambda_{R} - \\lambda_{OP})^{2}.\n$$\n因此，\n$$\n\\mathbb{V}\\text{ar}(N) = w \\lambda_{R} + (1-w) \\lambda_{OP} + w(1-w)(\\lambda_{R} - \\lambda_{OP})^{2}.\n$$\n这就是所要求的闭式表达式。", "answer": "$$\\boxed{w \\lambda_{R} + (1-w) \\lambda_{OP} + w(1-w)\\left(\\lambda_{R} - \\lambda_{OP}\\right)^{2}}$$", "id": "1375781"}, {"introduction": "这个最后的练习提出了一个更高级的挑战，模拟了实验科学中的一个常见逆问题：我们无法直接观察到底层过程，但可以测量其结果。在这里，我们的任务是根据实验测量的矩（一种可观察的总体统计数据）来推断混合物各组分的未知参数。这个问题 [@problem_id:1375763] 让你应用矩方法来处理伽马分布的混合，展示了一种从宏观数据中提取微观模型信息的强大技术。", "problem": "在一个粒子物理实验中，观察到一个新发现的不稳定粒子通过两种不同的通道衰变。因此，单个粒子的寿命（用随机变量 $T$ 表示）被建模为一个统计混合模型。具体来说，其衰变有50%的几率遵循一个由形状参数 $\\alpha$ 和尺度参数 $\\beta_1$ 描述的伽马分布，另有50%的几率遵循另一个由相同形状参数 $\\alpha$ 和不同尺度参数 $\\beta_2$ 描述的伽马分布。参数 $\\alpha, \\beta_1, \\beta_2$ 均为正实数，且 $\\beta_1 \\neq \\beta_2$。\n\n一个形状参数为 $\\alpha  0$、尺度参数为 $\\beta  0$ 的伽马分布随机变量 $X$（记作 $X \\sim \\text{Gamma}(\\alpha, \\beta)$）的概率密度函数由下式给出：\n$$f(x; \\alpha, \\beta) = \\frac{1}{\\Gamma(\\alpha)\\beta^{\\alpha}} x^{\\alpha-1} \\exp\\left(-\\frac{x}{\\beta}\\right) \\quad \\text{for } x  0$$\n其中 $\\Gamma(\\alpha)$ 是伽马函数。\n\n通过大量的衰变观测，物理学家们确定了寿命分布 $T$ 的前三阶原点矩。记这些矩为 $M_1 = E[T]$, $M_2 = E[T^2]$ 和 $M_3 = E[T^3]$。你的任务是仅用这些实验测得的矩 $M_1$、$M_2$ 和 $M_3$ 来表示共同的形状参数 $\\alpha$。请以单一的封闭形式解析表达式给出最终答案。", "solution": "设两个尺度参数为 $\\beta_{1}$ 和 $\\beta_{2}$，共同的形状参数为 $\\alpha0$。对于 $X\\sim\\text{Gamma}(\\alpha,\\beta)$，其 $k$ 阶原点矩为\n$$\nE[X^{k}] \\;=\\; \\beta^{k}\\,\\frac{\\Gamma(\\alpha+k)}{\\Gamma(\\alpha)} \\;=\\; \\beta^{k}\\,\\alpha(\\alpha+1)\\cdots(\\alpha+k-1).\n$$\n对于50-50的混合模型，根据全期望定律，\n$$\nM_{k} \\;=\\; E[T^{k}] \\;=\\; \\frac{1}{2}\\left(\\beta_{1}^{k}+\\beta_{2}^{k}\\right)\\frac{\\Gamma(\\alpha+k)}{\\Gamma(\\alpha)}.\n$$\n定义 $S_{k}=\\frac{1}{2}(\\beta_{1}^{k}+\\beta_{2}^{k})$ 和 $c_{k}=\\frac{\\Gamma(\\alpha+k)}{\\Gamma(\\alpha)}$。那么对于 $k=1,2,3$，\n$$\nM_{k}=c_{k}S_{k},\\qquad c_{1}=\\alpha,\\; c_{2}=\\alpha(\\alpha+1),\\; c_{3}=\\alpha(\\alpha+1)(\\alpha+2).\n$$\n因此\n$$\nS_{1}=\\frac{M_{1}}{\\alpha},\\qquad S_{2}=\\frac{M_{2}}{\\alpha(\\alpha+1)},\\qquad S_{3}=\\frac{M_{3}}{\\alpha(\\alpha+1)(\\alpha+2)}.\n$$\n对于两个数 $\\beta_{1},\\beta_{2}$，其幂和满足二阶递推关系 $p_{k}=(\\beta_{1}+\\beta_{2})p_{k-1}-\\beta_{1}\\beta_{2}\\,p_{k-2}$ (对于 $k\\geq 2$)，其中 $p_{k}=\\beta_{1}^{k}+\\beta_{2}^{k}$。两边除以2，得到 $S_{k}$ 的相同递推关系：\n$$\nS_{k}=(\\beta_{1}+\\beta_{2})S_{k-1}-\\beta_{1}\\beta_{2}\\,S_{k-2}.\n$$\n利用 $S_{1}=\\frac{\\beta_{1}+\\beta_{2}}{2}$ 和 $S_{2}=\\frac{(\\beta_{1}+\\beta_{2})^{2}-2\\beta_{1}\\beta_{2}}{2}$，可以得到\n$$\nS_{3}=(\\beta_{1}+\\beta_{2})S_{2}-\\beta_{1}\\beta_{2}S_{1}\n\\,=\\,3S_{1}S_{2}-2S_{1}^{3}.\n$$\n将 $S_{1},S_{2},S_{3}$ 用 $M_{1},M_{2},M_{3}$ 和 $\\alpha$ 表示并代入，得到\n$$\n\\frac{M_{3}}{\\alpha(\\alpha+1)(\\alpha+2)} \\;=\\; 3\\frac{M_{1}}{\\alpha}\\cdot\\frac{M_{2}}{\\alpha(\\alpha+1)} \\;-\\; 2\\left(\\frac{M_{1}}{\\alpha}\\right)^{3}.\n$$\n两边同乘以 $\\alpha^{3}(\\alpha+1)(\\alpha+2)$，得到\n$$\nM_{3}\\,\\alpha^{2} \\;=\\; 3M_{1}M_{2}\\,\\alpha(\\alpha+2) \\;-\\; 2M_{1}^{3}(\\alpha+1)(\\alpha+2).\n$$\n展开并合并关于 $\\alpha$ 的同次幂项，得到一个关于 $\\alpha$ 的二次方程：\n$$\n\\bigl(3M_{1}M_{2}-2M_{1}^{3}-M_{3}\\bigr)\\alpha^{2} \\;+\\; \\bigl(6M_{1}M_{2}-6M_{1}^{3}\\bigr)\\alpha \\;-\\; 4M_{1}^{3}\\;=\\;0.\n$$\n设 $a_{2}=3M_{1}M_{2}-2M_{1}^{3}-M_{3}$，$a_{1}=6M_{1}(M_{2}-M_{1}^{2})$，以及 $a_{0}=-4M_{1}^{3}$。判别式可简化为\n$$\n\\Delta \\;=\\; a_{1}^{2}-4a_{2}a_{0}\n\\;=\\; 4M_{1}^{2}\\Bigl((3M_{2}-M_{1}^{2})^{2}-4M_{1}M_{3}\\Bigr).\n$$\n因此\n$$\n\\alpha \\;=\\; \\frac{-a_{1}+\\sqrt{\\Delta}}{2a_{2}}\n\\;=\\; \\frac{-6M_{1}(M_{2}-M_{1}^{2})+2M_{1}\\sqrt{(3M_{2}-M_{1}^{2})^{2}-4M_{1}M_{3}}}{2\\bigl(3M_{1}M_{2}-2M_{1}^{3}-M_{3}\\bigr)}.\n$$\n选择平方根前的正号是能得到正值 $\\alpha$ 的分支，并且在 $\\beta_{1}=\\beta_{2}$ 时能正确地简化为单个伽马分布的情形。约去因子2，得到封闭形式的表达式\n$$\n\\alpha \\;=\\; \\frac{M_{1}\\left(3M_{1}^{2}-3M_{2}+\\sqrt{(3M_{2}-M_{1}^{2})^{2}-4M_{1}M_{3}}\\right)}{3M_{1}M_{2}-2M_{1}^{3}-M_{3}}.\n$$", "answer": "$$\\boxed{\\frac{M_{1}\\left(3M_{1}^{2}-3M_{2}+\\sqrt{(3M_{2}-M_{1}^{2})^{2}-4M_{1}M_{3}}\\right)}{3M_{1}M_{2}-2M_{1}^{3}-M_{3}}}$$", "id": "1375763"}]}