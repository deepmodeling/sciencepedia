{"hands_on_practices": [{"introduction": "要真正理解一个概率分布，最好的方法之一就是从其最基本的定义出发，亲手“构建”它。这个练习将带你回到卡方分布的源头，即它是一组独立标准正态随机变量的平方和。通过思考如何用计算机程序模拟这个过程，你将对卡方分布的本质建立起一个具体而直观的认识。[@problem_id:1903721]", "problem": "在开发一个自定义的统计模拟库时，一个程序员的任务是创建一个函数，用以生成具有 $k$ 个自由度的卡方分布（记为 $\\chi^2(k)$）的随机变量，其中 $k$ 是一个正整数。唯一可用的工具是一个已有的函数 `get_std_normal()`，它返回一个从标准正态分布 $N(0, 1)$ 中抽取的随机数。\n\n程序员必须设计一个算法，通过一次或多次调用 `get_std_normal()` 来正确生成一个来自 $\\chi^2(k)$ 分布的随机变量。以下提出的算法中，哪一个能正确完成此任务？\n\nA. 初始化一个变量 `sum_of_squares` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并将 $z^2$ 加到 `sum_of_squares` 中。`sum_of_squares` 的最终值就是结果。\n\nB. 初始化一个变量 `sum_val` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并将 $z$ 加到 `sum_val` 中。`sum_val` 的最终值就是结果。\n\nC. 初始化一个变量 `sum_val` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并将 $z$ 加到 `sum_val` 中。最终结果是 `sum_val` 的平方。\n\nD. 调用 `get_std_normal()` 恰好一次以得到一个值 $z$。结果是 $k \\times z$。\n\nE. 初始化一个变量 `sum_of_squares` 为 0。循环 $k$ 次：在每次迭代中，调用 `get_std_normal()` 得到一个值 $z$，并将 $z^2$ 加到 `sum_of_squares` 中。最终结果是 `sum_of_squares` 除以 $k$。", "solution": "设 $Z_{1},\\dots,Z_{k}$ 是独立的标准正态随机变量，每个变量都是通过调用 get_std_normal() 获得的，因此 $Z_{i} \\sim N(0,1)$ 且这些 $Z_{i}$ 是相互独立的。根据卡方分布的定义性质，平方和\n$$\nQ=\\sum_{i=1}^{k} Z_{i}^{2}\n$$\n服从 $\\chi^2(k)$ 分布。这可以通过矩生成函数（mgf）来验证：对于 $t  1/2$，$Z_{i}^{2}$ 的矩生成函数是 $(1-2t)^{-1/2}$，并且根据独立性，\n$$\nM_{Q}(t)=\\prod_{i=1}^{k}(1-2t)^{-1/2}=(1-2t)^{-k/2},\n$$\n这是 $\\chi^2(k)$ 分布的矩生成函数。因此，计算 $k$ 个独立标准正态随机变量的平方和正是正确的算法。\n\n现在评估每个提出的算法：\n\nA. 该算法计算 $Q=\\sum_{i=1}^{k} Z_{i}^{2}$，根据定义，它服从 $\\chi^2(k)$ 分布。因此 A 是正确的。\n\nB. 该算法计算 $S=\\sum_{i=1}^{k} Z_{i}$，它服从正态分布 $S \\sim N(0,k)$，而不是卡方分布。因此 B 是不正确的。\n\nC. 该算法计算 $S^2$，其中 $S=\\sum_{i=1}^{k} Z_{i} \\sim N(0,k)$。那么 $S/\\sqrt{k} \\sim N(0,1)$ 且 $S^2=k\\,(S/\\sqrt{k})^2$，所以 $S^2$ 服从 $k \\cdot \\chi^2(1)$ 分布，除非 $k=1$，否则它不服从 $\\chi^2(k)$ 分布。因此 C 在通常情况下是不正确的。\n\nD. 该算法计算 $k Z$，其中 $Z \\sim N(0,1)$ 是单个变量，结果服从 $N(0,k^2)$ 分布，而不是卡方分布。因此 D 是不正确的。\n\nE. 该算法计算 $\\frac{1}{k}\\sum_{i=1}^{k} Z_{i}^{2}=\\frac{1}{k}\\,\\chi^2(k)$，这是一个缩放后的卡方变量，而不是 $\\chi^2(k)$ 变量。因此 E 是不正确的。\n\n因此，唯一正确的算法是 A。", "answer": "$$\\boxed{A}$$", "id": "1903721"}, {"introduction": "卡方分布的一个极其有用的特性是它的可加性，即两个独立的卡方变量之和仍然服从卡方分布。这个练习将让你运用这一关键性质，在一个复合系统中，通过已知的整体和部分信息来推断未知部分的特征。这不仅是对理论的检验，更是解决实际统计问题中分解复杂度的常用思路。[@problem_id:2278]", "problem": "设 $X$ 和 $Y$ 为相互独立的随机变量。已知变量 $X$ 服从自由度为 $k_X = 4$ 的卡方分布，记作 $X \\sim \\chi^2(4)$。它们的和 $Z = X+Y$ 也是一个卡方随机变量，服从自由度为 $k_Z = 10$ 的分布，即 $Z \\sim \\chi^2(10)$。\n\n给定卡方分布的以下基本性质：\n1.  **可加性：** 若两个独立的随机变量 $U \\sim \\chi^2(k_1)$ 和 $V \\sim \\chi^2(k_2)$，则其和 $U+V$ 也服从卡方分布，自由度为各自自由度之和：$U+V \\sim \\chi^2(k_1+k_2)$。此性质也表明，若 $U$ 与 $V$ 独立，且 $U$ 与 $U+V$ 均为卡方分布，则 $V$ 也必为卡方分布。\n2.  **方差公式：** 服从自由度为 $k$ 的卡方分布的随机变量 $W$ 的方差为 $\\text{Var}(W) = 2k$。\n\n根据此信息，推导随机变量 $Y$ 的方差。", "solution": "根据卡方分布的可加性，如果 $X\\sim\\chi^2(k_X)$ 和 $Y\\sim\\chi^2(k_Y)$ 相互独立，则 $$Z=X+Y\\sim\\chi^2(k_X+k_Y).$$ 此处 $k_X=4$ 且 $k_Z=10$，所以 $$k_Y=k_Z-k_X=10-4=6.$$ 自由度为 $k$ 的卡方随机变量的方差为 $\\text{Var}(W)=2k$。因此 $$\\text{Var}(Y)=2k_Y=2\\cdot6=12.$$", "answer": "$$\\boxed{12}$$", "id": "2278"}, {"introduction": "除了均值和方差的计算公式，理解一个分布的概率密度函数（PDF）的形状对于建立统计直觉至关重要。这个练习将探讨卡方分布的偏度特性，以及这种不对称性如何影响其均值与中位数这两个核心集中趋势度量之间的关系。这有助于我们超越纯粹的计算，从几何角度把握分布的内涵。[@problem_id:1395039]", "problem": "设随机变量 $X$ 服从自由度为 $k=10$ 的卡方分布，记作 $X \\sim \\chi^2(10)$。自由度为 $k$ 的卡方分布的均值（或期望值）由 $\\mu = k$ 给出。该分布的中位数记为 $m$，是使累积分布函数在该点的值为 0.5 的值；即 $P(X \\le m) = 0.5$。\n\n下列哪个陈述正确描述了该特定分布的均值 $\\mu$ 和中位数 $m$ 之间的关系？\n\nA) $\\mu  m$\nB) $\\mu > m$\nC) $\\mu = m$\nD) 该关系取决于从该分布中抽取的具体样本。\nE) 根据所提供的信息无法确定该关系。", "solution": "问题要求我们确定自由度为 $k=10$ 的卡方分布的均值 $\\mu$ 和中位数 $m$ 之间的关系。\n\n首先，我们计算该分布的均值。问题陈述，对于随机变量 $X \\sim \\chi^2(k)$，其均值为 $\\mu = k$。在本例中，$k=10$，因此均值为：\n$$ \\mu = 10 $$\n\n接下来，我们需要比较均值 $\\mu$ 和中位数 $m$。任何概率分布的均值和中位数之间的关系由其概率密度函数（PDF）的形状决定，特别是其对称性。\n对于一个完全对称的分布，均值和中位数相等。对于非对称或偏态分布，均值和中位数通常不相等。\n\n我们来分析卡方分布的形状。自由度为 $k$ 的卡方随机变量 $X$ 的概率密度函数（PDF）由以下公式给出：\n$$ f(x; k) = \\frac{1}{2^{k/2} \\Gamma(k/2)} x^{\\frac{k}{2} - 1} \\exp\\left(-\\frac{x}{2}\\right) \\quad \\text{for } x > 0 $$\n其中 $\\Gamma$ 是伽马函数。该分布的定义域为 $x \\in (0, \\infty)$。\n\n对于任何有限的 $k$ 值，该函数都不是对称的。具体来说，卡方分布是一个正偏态或右偏分布。右偏分布有一条向更高正值方向延伸的长尾。虽然随着 $k$ 趋近于无穷大（收敛于正态分布），该分布会变得更加对称，但对于像 $k=10$ 这样的有限值，它表现出显著的正偏性。\n\n在正偏分布中，均值会被较大的值拉向长的右尾。而中位数是将概率质量一分为二的值，它对尾部的这些极端值不太敏感。对于任何单峰、正偏的连续分布，三个主要集中趋势度量之间有一个众所知的排序：\n$$ \\text{mode}  \\text{median}  \\text{mean} $$\n\n由于自由度为 10 的卡方分布是正偏的，因此其均值必须大于其中位数。\n因此，我们可以得出结论 $\\mu > m$。\n\n鉴于我们计算出的均值 $\\mu = 10$，这意味着中位数 $m$ 是某个小于 10 的值。\n让我们根据我们的结论 $\\mu > m$ 来审查这些选项：\nA) $\\mu  m$：这是不正确的。\nB) $\\mu > m$：这与我们的结论相符。\nC) $\\mu = m$：这仅在分布对称时才成立。\nD) 该关系取决于从该分布中抽取的具体样本：这是不正确的。均值和中位数是总体分布的理论属性，而不是随机样本的属性。\nE) 根据所提供的信息无法确定该关系：这是不正确的，因为卡方分布的性质足以确定这种关系。\n\n因此，正确的陈述是 B。", "answer": "$$\\boxed{B}$$", "id": "1395039"}]}