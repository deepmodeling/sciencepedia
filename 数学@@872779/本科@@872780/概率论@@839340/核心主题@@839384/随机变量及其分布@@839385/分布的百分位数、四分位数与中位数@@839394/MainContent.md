## 引言
在概率论和统计学的世界里，我们常常使用均值来概括数据的中心趋势。然而，单一的均值可能无法描绘出一幅完整的图景，尤其是在处理具有偏斜、异常值或重尾特征的数据时。此时，理解数据点在其[分布](@entry_id:182848)中的相对位置变得至关重要。百分位数、[四分位数](@entry_id:167370)和中位数正是为此而生的强大工具，它们提供了一种更稳健、更细致的方式来描述和分析[概率分布](@entry_id:146404)。

本文旨在深入探讨这些基于分位数的统计量。我们不仅将揭示它们的数学定义，还将展示它们在面对不完美数据时的优越性，以及它们如何解决传统方法难以应对的难题。通过本文的学习，您将掌握从理论基础到实际应用的完整知识体系。在“原理与机制”一章中，我们将奠定这些概念的数学基础，详细介绍它们的定义、性质和计算方法。随后，在“应用与跨学科联系”一章中，我们将跨越理论，探索这些工具在经济学、生物学、工程学等多个领域中的实际效用。最后，“动手实践”部分将通过具体问题，巩固您所学的知识。

让我们首先从这些概念的核心——它们的原理与机制——开始探索。

## 原理与机制

在对[概率分布](@entry_id:146404)进行描述和分析时，我们不仅关心其整体形状或[期望值](@entry_id:153208)等度量，还常常需要了解数据点在[分布](@entry_id:182848)中的相对位置。分位数、[四分位数](@entry_id:167370)和[中位数](@entry_id:264877)等概念为此提供了有力的工具。它们是描述[分布](@entry_id:182848)位置和离散程度的稳健统计量，尤其在处理[偏态分布](@entry_id:175811)或含有异常值的数据时，其重要性愈发凸显。本章将深入探讨这些概念的定义、计算方法及其在理论和应用中的核心性质。

### [分位数](@entry_id:178417)、百分位数与中位数的定义

描述一个[随机变量](@entry_id:195330) $X$ 在其取值范围内的相对位置，最核心的工具是其**[累积分布函数](@entry_id:143135) (Cumulative Distribution Function, CDF)**，记为 $F_X(x) = P(X \le x)$。CDF给出了[随机变量](@entry_id:195330) $X$ 的值小于或等于某个特定值 $x$ 的概率。基于CDF，我们可以定义分位数的概念。

对于一个概率值 $p \in (0, 1)$，[随机变量](@entry_id:195330) $X$ 的 **$p$-[分位数](@entry_id:178417) (p-quantile)**，记为 $q_p$，是一个将[分布](@entry_id:182848)的概率质量“分割”为 $p$ 和 $1-p$ 两部分的值。然而，由于[离散分布](@entry_id:193344)的CDF是阶梯函数，可能不存在一个值 $x$ 使得 $F_X(x)$ 恰好等于 $p$。为了涵盖所有情况，包括连续、离散及[混合分布](@entry_id:276506)，我们采用一个更具普适性的定义：

一个值 $q_p$ 被称为 $p$-分位数，如果它同时满足以下两个条件：
1.  $P(X \le q_p) \ge p$
2.  $P(X \ge q_p) \ge 1-p$

这个双重条件确保了 $q_p$ 是一个恰当的分[割点](@entry_id:637448)。第一个条件保证了至少有比例为 $p$ 的概率质量位于 $q_p$ 或其左侧；第二个条件则保证了至少有比例为 $1-p$ 的概率质量位于 $q_p$ 或其右侧。

在实践中，我们经常使用一些特殊的[分位数](@entry_id:178417)：
- **[中位数](@entry_id:264877) (Median)**：即 $0.5$-[分位数](@entry_id:178417) ($p=0.5$)，通常记为 $m$ 或 $Q_2$。它是一个将[分布](@entry_id:182848)的概率质量平分为两部分的值。
- **[四分位数](@entry_id:167370) (Quartiles)**：
    - **第一[四分位数](@entry_id:167370) (First Quartile, $Q_1$)** 是 $0.25$-[分位数](@entry_id:178417)，即第25百[分位数](@entry_id:178417)。
    - **第三[四分位数](@entry_id:167370) (Third Quartile, $Q_3$)** 是 $0.75$-分位数，即第75百[分位数](@entry_id:178417)。
- **百[分位数](@entry_id:178417) (Percentiles)**：第 $k$ 百[分位数](@entry_id:178417)是 $p = k/100$ 对应的分位数。例如，第90百[分位数](@entry_id:178417)即 $0.9$-分位数。

对于**[连续随机变量](@entry_id:166541)**，如果其CDF $F_X(x)$ 是严格单调递增的，那么对于任意 $p \in (0, 1)$，方程 $F_X(x) = p$ 有唯一解。此时，$p$-分位数的定义可以简化为 $q_p = F_X^{-1}(p)$。这个CDF的[反函数](@entry_id:141256) $F_X^{-1}(p)$ 被称为**[分位数函数](@entry_id:271351) (Quantile Function)**，记为 $Q(p)$。[分位数函数](@entry_id:271351)直接给出了与特定累积概率 $p$ 相对应的值。

例如，在某个[通信系统](@entry_id:265921)中，信号与噪声比 $X$ 的统计行为可以通过其[分位数函数](@entry_id:271351) $Q(p) = \sqrt{-\ln(1-p)}$ 来描述。要找到该[分布](@entry_id:182848)的[中位数](@entry_id:264877) $m$，我们只需计算 $p=0.5$ 时的分位数即可 [@problem_id:1378632]：
$$ m = Q(0.5) = \sqrt{-\ln(1-0.5)} = \sqrt{-\ln(0.5)} = \sqrt{\ln(2)} $$
这个例子展示了[分位数函数](@entry_id:271351)在理论分析中的简洁与强大。

### [分位数](@entry_id:178417)的计算

计算[分位数](@entry_id:178417)的方法因[分布](@entry_id:182848)的类型而异。

#### [连续分布](@entry_id:264735)

对于[连续随机变量](@entry_id:166541)，计算 $p$-[分位数](@entry_id:178417) $q_p$ 的标准流程如下：
1.  根据概率密度函数 (PDF) $f_X(x)$，通[过积分](@entry_id:753033)计算其[累积分布函数 (CDF)](@entry_id:264700) $F_X(x) = \int_{-\infty}^{x} f_X(t) dt$。
2.  求解方程 $F_X(q_p) = p$ 来得到 $q_p$。

我们通过两个例子来说明。

**示例 1：指数分布的中位数**
在[量子计算](@entry_id:142712)领域，一个[量子比特](@entry_id:137928)的[退相干时间](@entry_id:154396) $T$ 常被建模为[指数分布](@entry_id:273894)，其PDF为 $f(t) = \lambda \exp(-\lambda t)$（对于 $t \ge 0$），其中 $\lambda$ 是退相干速率。其CDF为 $F(t) = 1 - \exp(-\lambda t)$。要找到中位[退相干时间](@entry_id:154396) $t_m$，我们求解 $F(t_m) = 0.5$ [@problem_id:1378635]：
$$ 1 - \exp(-\lambda t_m) = 0.5 $$
$$ \exp(-\lambda t_m) = 0.5 $$
$$ -\lambda t_m = \ln(0.5) = -\ln(2) $$
因此，中位数为 $t_m = \frac{\ln(2)}{\lambda}$。

**示例 2：[分段函数](@entry_id:160275)的百[分位数](@entry_id:178417)**
考虑一个更复杂的场景，例如某热带地区的日降雨量 $X$ 服从一个三角形[分布](@entry_id:182848)，其PDF在区间 $[0, 2R]$ 上是分段定义的 [@problem_id:1378627]。假设我们需要确定被定义为“极端降雨事件”的阈值，即该[分布](@entry_id:182848)的第90百分位数 $p_{90}$。首先，我们需要通过积分求得其分段形式的CDF。然后，通过比较 $F(R)$ 的值（其中 $R$ 是[分布](@entry_id:182848)的众数）与 $0.9$ 的大小，确定 $p_{90}$ 位于哪个区间。在这个例子中，$F(R) = 0.5$，因此 $p_{90}$ 必然在 $[R, 2R]$ 区间内。接着，我们将 $x=p_{90}$ 代入该区间的CDF表达式，并令其等于 $0.9$：
$$ F(p_{90}) = \frac{2p_{90}}{R} - \frac{p_{90}^2}{2R^2} - 1 = 0.9 $$
这是一个关于 $p_{90}$ 的[二次方程](@entry_id:163234)，求解并选取落在 $[R, 2R]$ 区间内的根，即可得到 $p_{90} = R(2 - \frac{1}{\sqrt{5}})$。这个过程展示了如何处理具有更复杂函数形式的[连续分布](@entry_id:264735)。

#### [离散分布](@entry_id:193344)

对于[离散随机变量](@entry_id:163471)，其CDF是一个阶梯函数，因此 $F_X(x)=p$ 可能没有解。此时，我们必须回归到分位数的原始定义。

**示例 1：唯一中位数**
假设一家工厂每日的次品数 $X$ 是一个[离散随机变量](@entry_id:163471)，其取值为 $\{10, 20, 30\}$，对应的概率为 $P(X=10)=0.45$, $P(X=20)=0.10$, $P(X=30)=0.45$。为了寻找中位数 $m$，我们检查其CD[F值](@entry_id:178445) [@problem_id:1378602]：
- $F_X(10) = P(X \le 10) = 0.45$
- $F_X(20) = P(X \le 20) = 0.45 + 0.10 = 0.55$

根据定义，中位数是满足 $F_X(m) \ge 0.5$ 的最小取值。由于 $F_X(10) = 0.45 \lt 0.5$ 而 $F_X(20) = 0.55 \ge 0.5$，因此中位数为 $20$。我们也可以验证其是否满足双重条件：
- $P(X \le 20) = 0.55 \ge 0.5$
- $P(X \ge 20) = P(X=20) + P(X=30) = 0.10 + 0.45 = 0.55 \ge 0.5$
两个条件都满足，因此 $m=20$ 是中位数。

**示例 2：非唯一[中位数](@entry_id:264877)**
中位数并不总是唯一的。考虑一个在偶数个整数 $\{1, 2, \dots, N\}$ 上的[离散均匀分布](@entry_id:199268)，其中 $N$ 为偶数。[概率质量函数](@entry_id:265484)为 $P(X=k) = 1/N$。我们来寻找满足 $P(X \le m) \ge 0.5$ 和 $P(X \ge m) \ge 0.5$ 的所有 $m$ [@problem_id:1378600]。
- 第一个条件 $P(X \le m) = \frac{\lfloor m \rfloor}{N} \ge 0.5$ 意味着 $\lfloor m \rfloor \ge N/2$。
- 第二个条件 $P(X \ge m) = \frac{N - \lceil m \rceil + 1}{N} \ge 0.5$ 意味着 $\lceil m \rceil \le N/2 + 1$。

结合这两个条件，我们发现任何满足 $N/2 \le m \le N/2 + 1$ 的实数 $m$ 都是该[分布](@entry_id:182848)的[中位数](@entry_id:264877)。例如，当 $N=10$ 时，[中位数](@entry_id:264877)可以是 $[5, 6]$ 区间内的任何数，包括 $5$, $5.5$ 或 $6$。这揭示了[离散分布](@entry_id:193344)[中位数](@entry_id:264877)可能是一个区间的重要特性。

#### [混合分布](@entry_id:276506)

[混合分布](@entry_id:276506)包含连续和离散部分。其CDF是连续部分CDF和离散部分CDF的加权和。

考虑一个传感器电压 $V$，它有 $3/4$ 的概率服从 $[-2, 2]$ 上的[均匀分布](@entry_id:194597)，有 $1/4$ 的概率取固定值 $5$。要找到该[混合分布](@entry_id:276506)的[中位数](@entry_id:264877) $m$，我们需要构建其CDF并求解 $P(V \le m) \ge 0.5$ 和 $P(V \ge m) \ge 0.5$ [@problem_id:1378616]。
其CDF为：
$$
P(V \le m)=\begin{cases}
0,  m \lt -2 \\
\frac{3}{4} \cdot \frac{m+2}{4} = \frac{3}{16}(m+2),  -2 \le m \lt 2 \\
\frac{3}{4},  2 \le m \lt 5 \\
1,  m \ge 5
\end{cases}
$$
我们寻找使 $P(V \le m) \ge 0.5$ 且 $P(V \ge m) \ge 0.5$ 同时成立的 $m$。通过对不同区间进行分析，可以发现只有当 $m = 2/3$ 时，两个条件同时满足（且都取等号）：
- $P(V \le 2/3) = \frac{3}{16}(2/3 + 2) = 0.5$
- $P(V \ge 2/3) = P(V \text{ in } [2/3, 2]) + P(V=5) = \frac{3}{4} \cdot \frac{2 - 2/3}{4} + \frac{1}{4} = 0.5$
因此，这个[混合分布](@entry_id:276506)的唯一中位数是 $2/3$。

### [中位数](@entry_id:264877)与[分位数](@entry_id:178417)的核心性质与解读

除了作为位置的描述符，分位数，特别是[中位数](@entry_id:264877)，还具有一些深刻的数学性质，这使得它们在统计推断和决策理论中扮演着关键角色。

#### 作为[绝对偏差](@entry_id:265592)的最小化者

中位数具有一个重要的优化性质：它能最小化期望[绝对偏差](@entry_id:265592)。假设我们需要在一个一维空间中设置一个设施（如数据中心），以服务一系列随机位置 $X$ 上的需求点（如传感器）。如果服务成本与距离成正比，我们的目标就是选择设施的位置 $c$ 来最小化平均成本，即最小化 $D(c) = E[|X-c|]$。

可以证明，使 $E[|X-c|]$ 最小化的 $c$ 正是[随机变量](@entry_id:195330) $X$ 的中位数。
我们可以通过对 $D(c)$求导来证明这一点 [@problem_id:1378626]。将期望写成积分形式：
$$ D(c) = \int_{-\infty}^{\infty} |x-c| f(x) dx = \int_{-\infty}^{c} (c-x) f(x) dx + \int_{c}^{\infty} (x-c) f(x) dx $$
使用[莱布尼茨积分法则](@entry_id:145735)对 $c$ 求导，我们得到：
$$ \frac{dD}{dc} = \int_{-\infty}^{c} f(x) dx - \int_{c}^{\infty} f(x) dx = F(c) - (1 - F(c)) = 2F(c) - 1 $$
令导数为零，我们得到 $F(c) = 0.5$，这正是[中位数](@entry_id:264877)的定义。[二阶导数](@entry_id:144508) $D''(c) = 2f(c) \ge 0$，保证了这是一个最小值点。

这个性质赋予了[中位数](@entry_id:264877)一个清晰的物理和经济含义：它是使得到所有可能结果的“平均距离”最小的点。因此，在许多优化和选址问题中，中位数是比均值更自然的选择。

#### 对异常值和[重尾分布](@entry_id:142737)的稳健性

与均值相比，中位数的一个显著优势是其**稳健性 (robustness)**。均值对样本中的极端值（异常值）非常敏感，一个极大的值就可以将均值拉得很高。而[中位数](@entry_id:264877)的位置只取决于数据的排序，不受极端值大小的影响。

这种稳健性在处理**[重尾分布](@entry_id:142737) (heavy-tailed distributions)** 时尤为重要。[重尾分布](@entry_id:142737)的特点是其尾部概率衰减得比指数分布慢，这意味着极端事件发生的可能性相对较高。一个典型的例子是**柯西分布 (Cauchy distribution)**，其PDF为 $f(x; x_0, \gamma) = \frac{1}{\pi\gamma [1 + ((x-x_0)/\gamma)^2]}$。[柯西分布](@entry_id:266469)的尾部非常“重”，以至于其均值和[方差](@entry_id:200758)都是未定义的（积分不收敛）。然而，它的中位数和[四分位数](@entry_id:167370)却是良定义的 [@problem_id:1378607]。

对于[柯西分布](@entry_id:266469)，可以计算出其CDF为 $F(x) = \frac{1}{2} + \frac{1}{\pi} \arctan(\frac{x-x_0}{\gamma})$。
- [中位数](@entry_id:264877) ($p=0.5$): $m = x_0 + \gamma \tan(0) = x_0$。
- 第一[四分位数](@entry_id:167370) ($p=0.25$): $Q_1 = x_0 + \gamma \tan(-\pi/4) = x_0 - \gamma$。
- 第三[四分位数](@entry_id:167370) ($p=0.75$): $Q_3 = x_0 + \gamma \tan(\pi/4) = x_0 + \gamma$。
这些量都是围绕[位置参数](@entry_id:176482) $x_0$ 对称的，且完全由参数 $x_0$ 和 $\gamma$ 决定。这表明，即使在均值失效的情况下，[中位数](@entry_id:264877)和[四分位数](@entry_id:167370)依然能提供关于[分布](@entry_id:182848)中心和展布的有效信息。

#### 与[分布](@entry_id:182848)[偏度](@entry_id:178163)的关系

均值和[中位数](@entry_id:264877)的相对位置可以作为[分布](@entry_id:182848)**[偏度](@entry_id:178163) (skewness)** 的一个直观指示器。
- 对于**对称[分布](@entry_id:182848)**，均值和中位数相等。例如，在一个对称的三角噪声电压模型中，其PDF关于[直流偏置](@entry_id:271748) $V_{dc}$ 对称，那么其中位数必然等于 $V_{dc}$ [@problem_id:1378598]。
- 对于**[右偏](@entry_id:180351)（正偏）[分布](@entry_id:182848)**，[分布](@entry_id:182848)的右侧有一个[长尾](@entry_id:274276)。这个[长尾](@entry_id:274276)中的大值会将均值向右拉，导致 **均值 > 中位数**。例如，指数分布的均值为 $1/\lambda$，[中位数](@entry_id:264877)为 $(\ln 2)/\lambda \approx 0.693/\lambda$，显然均值大于中位数 [@problem_id:1378635]。另一个例子是[卡方分布](@entry_id:165213)，它也是[右偏](@entry_id:180351)的。对于自由度为 $k=11$ 的[卡方分布](@entry_id:165213)，其均值为 $11$，而中位数近似为 $11(1 - 2/(9 \cdot 11))^3 \approx 10.35$。均值与[中位数](@entry_id:264877)的比值约为 $1.063$，清晰地表明了其[右偏](@entry_id:180351)特性 [@problem_id:1378590]。
- 对于**左偏（负偏）[分布](@entry_id:182848)**，情况则相反，长尾在左侧，导致 **均值  中位数**。

### [四分位距](@entry_id:169909)：一种稳健的[离散度](@entry_id:168823)度量

正如中位数是位置的稳健度量一样，基于[分位数](@entry_id:178417)的**[四分位距](@entry_id:169909) (Interquartile Range, IQR)** 是衡量[分布](@entry_id:182848)离散程度的稳健度量。其定义为：
$$ \text{IQR} = Q_3 - Q_1 $$
IQR衡量了[分布](@entry_id:182848)中间50%数据的展布范围。因为它忽略了数据两端各25%的值，所以它对异常值不敏感。

例如，对于前面提到的柯西分布，尽管其[方差](@entry_id:200758)无限大，我们仍可以计算出其IQR为 $(x_0 + \gamma) - (x_0 - \gamma) = 2\gamma$ [@problem_id:1378607]。这提供了一个关于[分布](@entry_id:182848)“宽度”的有限且有意义的度量。类似地，对于对称的三角噪声[分布](@entry_id:182848)，其IQR可以计算为 $V_0(2-\sqrt{2})$ [@problem_id:1378598]，它只依赖于决定[分布](@entry_id:182848)宽度的参数 $V_0$，而与中心位置 $V_{dc}$ 无关。

综上所述，[分位数](@entry_id:178417)、中位数和[四分位数](@entry_id:167370)不仅是描述性统计中的基本工具，它们的数学性质也揭示了其作为[稳健估计](@entry_id:261282)量和优化目标的深刻内涵，使其在现代统计学和数据科学中不可或缺。