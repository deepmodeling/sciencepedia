{"hands_on_practices": [{"introduction": "我们从一个基础练习开始，探索可交换序列的核心思想。这个练习将演示如何运用全概率定律，通过对未知参数所有可能取值进行“平均”，来计算单个事件的无条件概率。通过这个计算，你可以直观地理解我们对参数的先验不确定性（通过一个概率分布来建模）是如何直接影响我们对单个观测结果的预测的。[@problem_id:1355478]", "problem": "考虑一个实验序列，其中每次实验的结果可以是成功（用1表示）或失败（用0表示）。令 $X_1, X_2, X_3, \\dots$ 是表示这些实验结果的随机变量序列。已知这个序列是*可交换的*，这意味着这些变量的任何有限子集的联合概率分布在重新排序后保持不变。例如，观测到序列 (1, 0, 1) 的概率与观测到 (1, 1, 0) 或 (0, 1, 1) 的概率相同。\n\n概率论中的一个关键结果，de Finetti 定理，指出对于这样一个无限可交换的二元结果序列，存在一个取值于 $[0, 1]$ 的随机变量 $\\Theta$，使得在给定 $\\Theta = \\theta$ 的条件下，随机变量 $X_1, X_2, \\dots$ 是独立同分布的伯努利试验，其成功概率为 $P(X_i = 1 | \\Theta = \\theta) = \\theta$。\n\n假设我们对该过程潜在成功率的初始不确定性通过将参数 $\\Theta$ 视为从区间 $[0, 1]$ 上的连续均匀分布中抽取的随机变量来建模。\n\n基于此模型，计算第一次实验结果为成功的无条件概率 $P(X_1 = 1)$。", "solution": "问题要求计算无条件概率 $P(X_1 = 1)$。我们已知在给定参数 $\\Theta$ 的条件下 $X_1=1$ 的条件概率，并且也已知 $\\Theta$ 的概率分布。这种情况需要使用适用于连续随机变量的全概率公式。\n\n令 $f_{\\Theta}(\\theta)$ 为随机变量 $\\Theta$ 的概率密度函数 (PDF)。全概率公式指出，我们可以通过将事件的条件概率对条件变量的所有可能取值进行积分来求得该事件的无条件概率，积分时以该变量的概率密度函数进行加权。在数学上，这表示为：\n$$P(X_1 = 1) = \\int_{-\\infty}^{\\infty} P(X_1 = 1 | \\Theta = \\theta) f_{\\Theta}(\\theta) \\, d\\theta$$\n\n我们有两个关键信息：\n1. 成功的条件概率：$P(X_1 = 1 | \\Theta = \\theta) = \\theta$。\n2. 参数 $\\Theta$ 的分布：$\\Theta$ 服从区间 $[0, 1]$ 上的连续均匀分布。\n\n对于 $[a, b]$ 上的均匀分布，其概率密度函数为当 $x \\in [a, b]$ 时，$f(x) = \\frac{1}{b-a}$，否则 $f(x)=0$。在我们的例子中，区间是 $[0, 1]$，因此 $\\Theta$ 的概率密度函数是：\n$$f_{\\Theta}(\\theta) = 1 \\quad \\text{对于 } \\theta \\in [0, 1]$$\n并且当 $\\theta$ 在此区间之外时，$f_{\\Theta}(\\theta) = 0$。\n\n现在我们可以将这些代入全概率公式的积分中。由于当 $\\theta$ 在区间 $[0, 1]$ 之外时 $f_{\\Theta}(\\theta)$ 为零，积分的上下限可以从 $(-\\infty, \\infty)$ 改为 $(0, 1)$：\n$$P(X_1 = 1) = \\int_{0}^{1} P(X_1 = 1 | \\Theta = \\theta) f_{\\Theta}(\\theta) \\, d\\theta$$\n\n代入条件概率和概率密度函数的给定表达式：\n$$P(X_1 = 1) = \\int_{0}^{1} (\\theta) \\cdot (1) \\, d\\theta$$\n$$P(X_1 = 1) = \\int_{0}^{1} \\theta \\, d\\theta$$\n\n现在，我们来计算这个简单的积分。$\\theta$ 关于 $\\theta$ 的反导数是 $\\frac{\\theta^2}{2}$。我们计算其在 0 到 1 上的定积分：\n$$P(X_1 = 1) = \\left[ \\frac{\\theta^2}{2} \\right]_{0}^{1}$$\n$$P(X_1 = 1) = \\frac{1^2}{2} - \\frac{0^2}{2}$$\n$$P(X_1 = 1) = \\frac{1}{2} - 0$$\n$$P(X_1 = 1) = \\frac{1}{2}$$\n\n因此，第一次实验成功的无条件概率是 $\\frac{1}{2}$。这个结果意味着，在没有先验观测的情况下，并且对成功概率 $\\theta$ 使用一个完全无信息（均匀）的先验分布时，成功和失败是等可能的。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1355478"}, {"introduction": "在理解了单个事件的概率之后，我们现在来探讨可交换序列中两个不同事件之间的关系。这个练习要求我们计算两个不同观测值之间的相关系数，这需要我们运用全期望定律和全方差定律来处理模型中的层级结构。这项实践揭示了一个至关重要但又反直觉的特性：虽然在参数给定的条件下观测是独立的，但它们在无条件下却是相关的，这正是贝叶斯框架中“从数据中学习”的基石。[@problem_id:1355469]", "problem": "一位政治学家正在研究一项新提案法律的民意。支持该法律的人口真实比例 $\\theta$ 是未知的。为了对这种不确定性进行建模，该科学家将 $\\theta$ 视为一个随机变量 $\\Theta$ 的结果，该随机变量在区间 $[0, 1]$ 上均匀分布。\n\n该科学家通过从人口中随机抽样进行民意调查。设 $X_i$ 是一个随机变量，代表第 $i$ 个个体的回应，如果该个体支持该法律，则 $X_i = 1$，否则 $X_i = 0$。假设对于一个给定的真实比例 $\\theta$，个体回应 $X_1, X_2, \\ldots$ 是独立的、同分布的伯努利试验，其成功（支持）的概率等于 $\\theta$。\n\n考虑这个模型，任意两个不同个体 $i$ 和 $j$（其中 $i \\neq j$）的回应之间的相关系数 $\\text{Corr}(X_i, X_j)$ 是多少？", "solution": "我们通过一个分层混合模型来对回应进行建模：设 $\\Theta \\sim \\text{Uniform}(0,1)$，并且在 $\\Theta=\\theta$ 的条件下，变量 $X_{1},X_{2},\\ldots$ 是独立的，且 $X_{i} \\sim \\text{Bernoulli}(\\theta)$。对于 $i \\neq j$，相关系数为\n$$\n\\text{Corr}(X_{i},X_{j})=\\frac{\\text{Cov}(X_{i},X_{j})}{\\sqrt{\\text{Var}(X_{i})\\text{Var}(X_{j})}}=\\frac{\\text{Cov}(X_{1},X_{2})}{\\text{Var}(X_{1})},\n$$\n根据可交换性。\n\n首先使用全期望定律计算 $E[X_{1}]$：\n$$\nE[X_{1}]=E\\!\\left[E[X_{1}\\mid \\Theta]\\right]=E[\\Theta]=\\int_{0}^{1}\\theta\\,d\\theta=\\frac{1}{2}.\n$$\n接下来，使用给定 $\\Theta$ 的条件独立性计算 $E[X_{1}X_{2}]$：\n$$\nE[X_{1}X_{2}]=E\\!\\left[E[X_{1}X_{2}\\mid \\Theta]\\right]=E\\!\\left[E[X_{1}\\mid \\Theta]\\,E[X_{2}\\mid \\Theta]\\right]=E[\\Theta^{2}]=\\int_{0}^{1}\\theta^{2}\\,d\\theta=\\frac{1}{3}.\n$$\n因此，\n$$\n\\text{Cov}(X_{1},X_{2})=E[X_{1}X_{2}]-E[X_{1}]E[X_{2}]=\\frac{1}{3}-\\left(\\frac{1}{2}\\right)^{2}=\\frac{1}{12}.\n$$\n\n现在使用全方差定律计算 $\\text{Var}(X_{1})$：\n$$\n\\text{Var}(X_{1})=E\\!\\left[\\text{Var}(X_{1}\\mid \\Theta)\\right]+\\text{Var}\\!\\left(E[X_{1}\\mid \\Theta]\\right)=E[\\Theta(1-\\Theta)]+\\text{Var}(\\Theta).\n$$\n我们有\n$$\nE[\\Theta(1-\\Theta)]=E[\\Theta]-E[\\Theta^{2}]=\\frac{1}{2}-\\frac{1}{3}=\\frac{1}{6},\n$$\n以及\n$$\n\\text{Var}(\\Theta)=E[\\Theta^{2}]-(E[\\Theta])^{2}=\\frac{1}{3}-\\left(\\frac{1}{2}\\right)^{2}=\\frac{1}{12}.\n$$\n因此，\n$$\n\\text{Var}(X_{1})=\\frac{1}{6}+\\frac{1}{12}=\\frac{1}{4}.\n$$\n\n最后，相关系数为\n$$\n\\text{Corr}(X_{i},X_{j})=\\frac{\\frac{1}{12}}{\\frac{1}{4}}=\\frac{1}{3}.\n$$", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1355469"}, {"introduction": "在最后一个练习中，我们将亲身体验如何根据数据进行学习并做出预测。我们将运用贝叶斯定理，在一个离散参数的场景下，根据已有的观测数据更新我们对背后参数的信念，并利用更新后的信念来预测未来的结果。通过这个具体的案例，你可以清晰地看到初始信念如何与证据相结合形成后验信念，并最终影响我们的预测，这完美地诠释了基于德菲内蒂定理构建的模型的预测能力。[@problem_id:1355482]", "problem": "在一家半导体制造厂中，一批微处理器由两条不同的生产线（Line A 或 Line B）之一生产。目前尚不清楚当前批次是哪条生产线生产的。根据历史生产数据，该批次来自 Line A 的先验概率为 $\\frac{1}{4}$，来自 Line B 的概率为 $\\frac{3}{4}$。\n\n每条生产线的微处理器质量由通过特定压力测试的恒定但不同的概率来表征。来自 Line A 的微处理器通过测试的概率为 $\\frac{1}{3}$，而来自 Line B 的微处理器通过测试的概率为 $\\frac{2}{3}$。在来自单一生产线的任何给定批次内，不同微处理器的测试结果是相互独立的。\n\n一位工程师从该批次中随机抽取三个微处理器进行测试。第一个微处理器通过了测试，第二个未通过。设随机变量 $X_i$ 在第 $i$ 个微处理器通过测试时为 1，未通过时为 0。因此，观察到的结果是 $X_1 = 1$ 和 $X_2 = 0$。\n\n计算在给定前两个测试结果的情况下，第三个微处理器通过测试的概率。将你的答案表示为最简分数形式。", "solution": "设未知的生产线为一个潜变量 $L \\in \\{A,B\\}$。先验概率为 $P(L=A)=\\frac{1}{4}$ 和 $P(L=B)=\\frac{3}{4}$。通过概率分别为 $p_{A}=\\frac{1}{3}$ 和 $p_{B}=\\frac{2}{3}$，并且在给定 $L$ 的条件下，测试结果是带有相应参数的独立伯努利试验。\n\n将观察到的数据表示为 $D=\\{X_{1}=1, X_{2}=0\\}$。根据给定 $L$ 的条件独立性，似然函数为\n$$\nP(D \\mid L=A)=p_{A}\\left(1-p_{A}\\right)=\\frac{1}{3}\\cdot\\frac{2}{3}=\\frac{2}{9}, \\quad\nP(D \\mid L=B)=p_{B}\\left(1-p_{B}\\right)=\\frac{2}{3}\\cdot\\frac{1}{3}=\\frac{2}{9}.\n$$\n根据贝叶斯法则，\n$$\nP(L=A \\mid D)=\\frac{P(D \\mid A)P(A)}{P(D \\mid A)P(A)+P(D \\mid B)P(B)}.\n$$\n由于 $P(D \\mid A)=P(D \\mid B)$，后验概率等于先验概率：\n$$\nP(L=A \\mid D)=\\frac{1}{4}, \\quad P(L=B \\mid D)=\\frac{3}{4}.\n$$\n第三次测试的预测概率可以通过全概率定律获得：\n$$\nP(X_{3}=1 \\mid D)=P(L=A \\mid D)\\,p_{A}+P(L=B \\mid D)\\,p_{B}\n=\\frac{1}{4}\\cdot\\frac{1}{3}+\\frac{3}{4}\\cdot\\frac{2}{3}\n=\\frac{1}{12}+\\frac{1}{2}=\\frac{7}{12}.\n$$\n因此，在给定前两个测试结果的情况下，第三个微处理器通过测试的概率为 $\\frac{7}{12}$。", "answer": "$$\\boxed{\\frac{7}{12}}$$", "id": "1355482"}]}