{"hands_on_practices": [{"introduction": "让我们从一个基本练习开始，以巩固KL散度的核心计算方法。这个练习将要求我们计算两个离散概率分布之间的KL散度：一个是公平六面骰子的均匀分布，另一个是代表一个有偏重骰子的非均匀分布。通过解决这个问题，你不仅能练习KL散度的定义公式，还能体会到如何将实际场景转化为可计算的概率模型，这是应用信息论概念解决现实问题的关键第一步[@problem_id:1370292]。", "problem": "在信息论中，库尔贝克-莱布勒（KL）散度是衡量一个概率分布 $P$ 与另一个参考概率分布 $Q$ 之间差异的度量。对于在相同结果集 $\\mathcal{X}$ 上定义的离散概率分布 $P$ 和 $Q$，从 $Q$ 到 $P$ 的KL散度，记为 $D_{KL}(P || Q)$，由以下公式给出：\n$$\nD_{KL}(P || Q) = \\sum_{x \\in \\mathcal{X}} P(x) \\ln\\left(\\frac{P(x)}{Q(x)}\\right)\n$$\n其中 $\\ln$ 表示自然对数。\n\n考虑两个六面骰子。第一个是标准的均匀骰子，其结果的概率分布记为 $P$。第二个是有偏的骰子，其结果的概率分布记为 $Q$。对于这个有偏的骰子，掷出任何特定偶数的概率恰好是掷出任何特定奇数概率的两倍。两个骰子的可能结果集均为 $\\mathcal{X} = \\{1, 2, 3, 4, 5, 6\\}$。\n\n计算KL散度 $D_{KL}(P || Q)$ 的值。请以单一的闭式解析表达式给出你的答案。", "solution": "我们将在结果集 $\\mathcal{X}=\\{1,2,3,4,5,6\\}$ 上的均匀骰子分布记为 $P$，有偏骰子分布记为 $Q$。根据定义，对于所有 $x\\in\\mathcal{X}$，有 $P(x)=\\frac{1}{6}$。对于 $Q$，设 $p_{o}$ 为掷出任何特定奇数结果的概率，$p_{e}$ 为掷出任何特定偶数结果的概率。题目陈述 $p_{e}=2p_{o}$。由于有三个奇数结果和三个偶数结果，根据归一化条件有 $3p_{o}+3p_{e}=1$，因此 $3p_{o}+3(2p_{o})=9p_{o}=1$，这意味着 $p_{o}=\\frac{1}{9}$ 且 $p_{e}=\\frac{2}{9}$。\n\n从 $Q$ 到 $P$ 的库尔贝克-莱布勒散度为\n$$\nD_{KL}(P\\|Q)=\\sum_{x\\in\\mathcal{X}}P(x)\\ln\\left(\\frac{P(x)}{Q(x)}\\right).\n$$\n我们将和式分为奇数结果和偶数结果两部分。对于每个奇数 $x$，$P(x)=\\frac{1}{6}$ 且 $Q(x)=\\frac{1}{9}$，因此每个奇数项等于\n$$\n\\frac{1}{6}\\ln\\left(\\frac{\\frac{1}{6}}{\\frac{1}{9}}\\right)=\\frac{1}{6}\\ln\\left(\\frac{9}{6}\\right)=\\frac{1}{6}\\ln\\left(\\frac{3}{2}\\right).\n$$\n有三个奇数结果，总共贡献了\n$$\n3\\cdot\\frac{1}{6}\\ln\\left(\\frac{3}{2}\\right)=\\frac{1}{2}\\ln\\left(\\frac{3}{2}\\right).\n$$\n对于每个偶数 $x$，$P(x)=\\frac{1}{6}$ 且 $Q(x)=\\frac{2}{9}$，因此每个偶数项等于\n$$\n\\frac{1}{6}\\ln\\left(\\frac{\\frac{1}{6}}{\\frac{2}{9}}\\right)=\\frac{1}{6}\\ln\\left(\\frac{9}{12}\\right)=\\frac{1}{6}\\ln\\left(\\frac{3}{4}\\right).\n$$\n有三个偶数结果，总共贡献了\n$$\n3\\cdot\\frac{1}{6}\\ln\\left(\\frac{3}{4}\\right)=\\frac{1}{2}\\ln\\left(\\frac{3}{4}\\right).\n$$\n将两部分的贡献相加得到\n$$\nD_{KL}(P\\|Q)=\\frac{1}{2}\\ln\\left(\\frac{3}{2}\\right)+\\frac{1}{2}\\ln\\left(\\frac{3}{4}\\right)=\\frac{1}{2}\\ln\\left(\\frac{3}{2}\\cdot\\frac{3}{4}\\right)=\\frac{1}{2}\\ln\\left(\\frac{9}{8}\\right).\n$$\n这是一个闭式解析表达式。", "answer": "$$\\boxed{\\frac{1}{2}\\ln\\left(\\frac{9}{8}\\right)}$$", "id": "1370292"}, {"introduction": "在掌握了基本的计算之后，理解KL散度的关键性质至关重要。一个核心性质是它的不对称性，即$D_{KL}(P || Q)$通常不等于$D_{KL}(Q || P)$，这意味着KL散度并不是一个真正的“距离”度量。这个练习通过一个关于抛硬币的简单伯努利分布模型，让你亲手计算两个方向的KL散度，从而直观地验证并深刻理解这一不对称性[@problem_id:1370270]。", "problem": "两名统计学家，Alice 和 Bob，的任务是为一个可能带有偏差的硬币单次投掷的结果创建一个概率模型。投掷结果可以是正面 (H) 或反面 (T)。Alice 提出了一个模型，我们称之为分布 $P$，其中正面的概率为 $p_A = 0.2$。Bob 提出了另一个不同的模型，分布 $Q$，其中正面的概率为 $p_B = 0.7$。\n\n为了量化这两个模型之间的差异，他们决定使用库尔贝克-莱布勒（KL）散度，也称为相对熵。对于定义在同一概率空间 $\\mathcal{X}$ 上的两个离散概率分布 $P$ 和 $Q$，从 $Q$ 到 $P$ 的 KL 散度由以下公式给出：\n$$\nD_{KL}(P || Q) = \\sum_{x \\in \\mathcal{X}} P(x) \\ln\\left(\\frac{P(x)}{Q(x)}\\right)\n$$\n这个值衡量了当使用 $Q$ 来近似 $P$ 时所损失的信息。\n\n你的任务是计算两个值：\n1. 从 Bob 的模型（$Q$）到 Alice 的模型（$P$）的 KL 散度，即 $D_{KL}(P || Q)$。\n2. 从 Alice 的模型（$P$）到 Bob 的模型（$Q$）的 KL 散度，即 $D_{KL}(Q || P)$。\n\n请按顺序计算 $D_{KL}(P || Q)$ 和 $D_{KL}(Q || P)$，并以一对数值的形式提供结果。将你的最终答案保留四位有效数字。", "solution": "我们用两个结果 $\\mathcal{X}=\\{H,T\\}$ 来为一个单次硬币投掷建模。Alice 的模型 $P$ 中，$P(H)=p_{A}=0.2$ 且 $P(T)=1-p_{A}=0.8$。Bob 的模型 $Q$ 中，$Q(H)=p_{B}=0.7$ 且 $Q(T)=1-p_{B}=0.3$。\n\n根据定义，对于同一空间上的离散分布，\n$$\nD_{KL}(P \\,\\|\\, Q)=\\sum_{x\\in\\mathcal{X}} P(x)\\,\\ln\\!\\left(\\frac{P(x)}{Q(x)}\\right).\n$$\n\n首先，计算 $D_{KL}(P \\,\\|\\, Q)$：\n$$\nD_{KL}(P \\,\\|\\, Q)=P(H)\\ln\\!\\left(\\frac{P(H)}{Q(H)}\\right)+P(T)\\ln\\!\\left(\\frac{P(T)}{Q(T)}\\right).\n$$\n代入 $P(H)=\\frac{1}{5}$，$Q(H)=\\frac{7}{10}$，$P(T)=\\frac{4}{5}$，$Q(T)=\\frac{3}{10}$：\n$$\nD_{KL}(P \\,\\|\\, Q)=\\frac{1}{5}\\ln\\!\\left(\\frac{\\frac{1}{5}}{\\frac{7}{10}}\\right)+\\frac{4}{5}\\ln\\!\\left(\\frac{\\frac{4}{5}}{\\frac{3}{10}}\\right)\n=\\frac{1}{5}\\ln\\!\\left(\\frac{2}{7}\\right)+\\frac{4}{5}\\ln\\!\\left(\\frac{8}{3}\\right).\n$$\n数值计算如下：\n$$\n\\frac{1}{5}\\ln\\!\\left(\\frac{2}{7}\\right)\\approx 0.2\\times(-1.2527629685)\\approx -0.2505525937,\\quad\n\\frac{4}{5}\\ln\\!\\left(\\frac{8}{3}\\right)\\approx 0.8\\times 0.9808292530\\approx 0.7846634024,\n$$\n所以\n$$\nD_{KL}(P \\,\\|\\, Q)\\approx -0.2505525937+0.7846634024\\approx 0.5341108087.\n$$\n\n接下来，计算 $D_{KL}(Q \\,\\|\\, P)$：\n$$\nD_{KL}(Q \\,\\|\\, P)=Q(H)\\ln\\!\\left(\\frac{Q(H)}{P(H)}\\right)+Q(T)\\ln\\!\\left(\\frac{Q(T)}{P(T)}\\right).\n$$\n代入 $Q(H)=\\frac{7}{10}$，$P(H)=\\frac{1}{5}$，$Q(T)=\\frac{3}{10}$，$P(T)=\\frac{4}{5}$：\n$$\nD_{KL}(Q \\,\\|\\, P)=\\frac{7}{10}\\ln\\!\\left(\\frac{\\frac{7}{10}}{\\frac{1}{5}}\\right)+\\frac{3}{10}\\ln\\!\\left(\\frac{\\frac{3}{10}}{\\frac{4}{5}}\\right)\n=\\frac{7}{10}\\ln\\!\\left(\\frac{7}{2}\\right)+\\frac{3}{10}\\ln\\!\\left(\\frac{3}{8}\\right).\n$$\n数值计算如下：\n$$\n\\frac{7}{10}\\ln\\!\\left(\\frac{7}{2}\\right)\\approx 0.7\\times 1.2527629685\\approx 0.8769340779,\\quad\n\\frac{3}{10}\\ln\\!\\left(\\frac{3}{8}\\right)\\approx 0.3\\times(-0.9808292530)\\approx -0.2942487759,\n$$\n所以\n$$\nD_{KL}(Q \\,\\|\\, P)\\approx 0.8769340779-0.2942487759\\approx 0.5826853020.\n$$\n\n将两个结果都保留四位有效数字，得到 $D_{KL}(P \\,\\|\\, Q)\\approx 0.5341$ 和 $D_{KL}(Q \\,\\|\\, P)\\approx 0.5827$。", "answer": "$$\\boxed{\\begin{pmatrix}0.5341 & 0.5827\\end{pmatrix}}$$", "id": "1370270"}, {"introduction": "KL散度的应用远不止于离散的骰子或硬币。在许多科学和工程领域，我们处理的是连续变量，例如设备寿命或测量误差，这些通常用连续概率分布来建模。这个练习将我们的实践从离散世界扩展到连续世界，要求你推导两个指数分布之间的KL散度[@problem_id:1370289]。这不仅能帮助你掌握连续KL散度的积分形式，还能让你得出一个在统计建模中非常有用的通用解析表达式。", "problem": "在统计建模中，通常需要量化候选模型与真实的潜在概率分布之间的差异。Kullback-Leibler (KL) 散度提供了衡量这种差异的一种方法。\n\n对于一个服从率参数为 $\\lambda > 0$ 的指数分布的随机变量 $X$，其概率密度函数 (PDF) $f(x; \\lambda)$ 由下式给出：\n$$\nf(x; \\lambda) = \\begin{cases} \\lambda \\exp(-\\lambda x) & \\text{if } x \\ge 0 \\\\ 0 & \\text{if } x < 0 \\end{cases}\n$$\n对于两个分别具有概率密度函数 $p(x)$ 和 $q(x)$ 的连续概率分布 $P$ 和 $Q$，从 $Q$ 到 $P$ 的 KL 散度，记作 $D_{KL}(P || Q)$，定义为：\n$$\nD_{KL}(P || Q) = \\int_{-\\infty}^{\\infty} p(x) \\ln\\left(\\frac{p(x)}{q(x)}\\right) dx\n$$\n该积分在 $p(x) > 0$ 的区域上进行计算。\n\n考虑两个关于设备寿命的模型。模型 $P$ 假设寿命服从率参数为 $\\lambda_p$ 的指数分布。模型 $Q$ 假设寿命服从一个具有不同率参数 $\\lambda_q$ 的指数分布。\n\n你的任务是计算 KL 散度 $D_{KL}(P || Q)$。请用 $\\lambda_p$ 和 $\\lambda_q$ 表示你的答案，并给出其闭式解析表达式。", "solution": "给定两个指数分布：模型 $P$ 的率参数为 $\\lambda_{p} > 0$，模型 $Q$ 的率参数为 $\\lambda_{q} > 0$。它们的概率密度函数为\n$$\np(x) = \\begin{cases} \\lambda_{p} \\exp(-\\lambda_{p} x) & \\text{if } x \\ge 0 \\\\ 0 & \\text{if } x < 0 \\end{cases}, \\quad\nq(x) = \\begin{cases} \\lambda_{q} \\exp(-\\lambda_{q} x) & \\text{if } x \\ge 0 \\\\ 0 & \\text{if } x < 0 \\end{cases}.\n$$\n从 $Q$ 到 $P$ 的 Kullback-Leibler 散度定义为\n$$\nD_{KL}(P \\,||\\, Q) = \\int_{-\\infty}^{\\infty} p(x) \\ln\\!\\left(\\frac{p(x)}{q(x)}\\right) \\, dx,\n$$\n并且积分是在 $p(x) > 0$ 的区域上进行的。在这里，仅当 $x \\ge 0$ 时有 $p(x) > 0$，并且因为 $\\lambda_{q} > 0$，在这个区域上也有 $q(x) > 0$。\n\n对于 $x \\ge 0$，计算对数密度比：\n$$\n\\frac{p(x)}{q(x)} = \\frac{\\lambda_{p} \\exp(-\\lambda_{p} x)}{\\lambda_{q} \\exp(-\\lambda_{q} x)} = \\frac{\\lambda_{p}}{\\lambda_{q}} \\exp\\!\\big(-( \\lambda_{p} - \\lambda_{q}) x\\big),\n$$\n所以\n$$\n\\ln\\!\\left(\\frac{p(x)}{q(x)}\\right) = \\ln\\!\\left(\\frac{\\lambda_{p}}{\\lambda_{q}}\\right) - (\\lambda_{p} - \\lambda_{q}) x = \\ln\\!\\left(\\frac{\\lambda_{p}}{\\lambda_{q}}\\right) + (\\lambda_{q} - \\lambda_{p}) x.\n$$\n因此，\n$$\nD_{KL}(P \\,||\\, Q) = \\int_{0}^{\\infty} \\lambda_{p} \\exp(-\\lambda_{p} x) \\left[ \\ln\\!\\left(\\frac{\\lambda_{p}}{\\lambda_{q}}\\right) + (\\lambda_{q} - \\lambda_{p}) x \\right] dx.\n$$\n将积分分成两部分：\n$$\nD_{KL}(P \\,||\\, Q) = \\ln\\!\\left(\\frac{\\lambda_{p}}{\\lambda_{q}}\\right) \\int_{0}^{\\infty} \\lambda_{p} \\exp(-\\lambda_{p} x) \\, dx + (\\lambda_{q} - \\lambda_{p}) \\int_{0}^{\\infty} \\lambda_{p} x \\exp(-\\lambda_{p} x) \\, dx.\n$$\n第一个积分等于 $1$，因为 $p(x)$ 是一个概率密度函数：\n$$\n\\int_{0}^{\\infty} \\lambda_{p} \\exp(-\\lambda_{p} x) \\, dx = 1.\n$$\n对于第二个积分，进行换元 $u = \\lambda_{p} x$，则 $dx = du/\\lambda_{p}$：\n$$\n\\int_{0}^{\\infty} \\lambda_{p} x \\exp(-\\lambda_{p} x) \\, dx = \\int_{0}^{\\infty} \\lambda_{p} \\left(\\frac{u}{\\lambda_{p}}\\right) \\exp(-u) \\frac{du}{\\lambda_{p}} = \\frac{1}{\\lambda_{p}} \\int_{0}^{\\infty} u \\exp(-u) \\, du = \\frac{1}{\\lambda_{p}},\n$$\n因为 $\\int_{0}^{\\infty} u \\exp(-u) \\, du = 1$。\n\n综合这些结果，\n$$\nD_{KL}(P \\,||\\, Q) = \\ln\\!\\left(\\frac{\\lambda_{p}}{\\lambda_{q}}\\right) + (\\lambda_{q} - \\lambda_{p}) \\cdot \\frac{1}{\\lambda_{p}} = \\ln\\!\\left(\\frac{\\lambda_{p}}{\\lambda_{q}}\\right) + \\frac{\\lambda_{q}}{\\lambda_{p}} - 1.\n$$\n这是一个用 $\\lambda_{p}$ 和 $\\lambda_{q}$ 表示的闭式表达式，并且它是非负的，当且仅当 $\\lambda_{p} = \\lambda_{q}$ 时取等号。", "answer": "$$\\boxed{\\ln\\!\\left(\\frac{\\lambda_{p}}{\\lambda_{q}}\\right) + \\frac{\\lambda_{q}}{\\lambda_{p}} - 1}$$", "id": "1370289"}]}