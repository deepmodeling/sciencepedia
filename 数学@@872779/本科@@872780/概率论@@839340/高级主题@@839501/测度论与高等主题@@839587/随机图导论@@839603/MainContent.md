## 引言
从社交媒体的好友网络到大脑中神经元的连接，再到全球互联网的底层结构，我们的世界由各种[复杂网络](@entry_id:261695)交织而成。这些网络规模庞大，结构看似随机，但其行为却往往遵循着深刻的统计规律。然而，我们如何才能用数学的语言精确地描述、分析并预测这些系统的行为呢？这正是[随机图论](@entry_id:261982)（Random Graph Theory）所要回答的核心问题。

[随机图论](@entry_id:261982)由数学家 [Paul Erdős](@entry_id:273809) 和 Alfréd Rényi 在20世纪中期开创，它将概率论的强大工具引入[图论](@entry_id:140799)，为研究[复杂网络](@entry_id:261695)提供了一个优雅而有力的理论框架。通过将网络中的连接视为随机事件，我们可以推导出许多关于网络整体结构的令人惊讶的结论。

本文将带你走进[随机图](@entry_id:270323)的世界。在第一部分 **“原理与机制”** 中，我们将深入学习经典的 Erdős-Rényi [随机图](@entry_id:270323)模型 $G(n, p)$ 和 $G(n, M)$，掌握其核心定义、基本性质以及分析它们的关键数学工具，如[期望的线性](@entry_id:273513)性。接下来，在 **“应用与跨学科联系”** 部分，我们将探索这些理论模型如何在社会学、生物学、流行病学和计算机科学等多个领域中发挥作用，揭示从[小世界现象](@entry_id:261723)到[群体免疫](@entry_id:139442)等真实世界问题的底层逻辑。最后，通过 **“动手实践”** 部分，你将有机会运用所学知识解决具体问题，从而巩固理解并提升分析能力。让我们开始这段探索从随机性中涌现出秩序的奇妙旅程。

## 原理与机制

在上一章中，我们介绍了随机图作为研究[复杂网络](@entry_id:261695)的数学模型的概念。本章将深入探讨[随机图论](@entry_id:261982)的基石：经典的[随机图](@entry_id:270323)模型、其基本数学性质以及分析这些性质所依赖的核心原理。我们将重点关注由 [Paul Erdős](@entry_id:273809) 和 Alfréd Rényi 在20世纪中期开创的两个密切相关的模型，它们至今仍是该领域的出发点。

### G(n, p) 模型：二项随机图

最著名且应用最广泛的随机图模型是 **$G(n, p)$ 模型**，也称为 **Erdős-Rényi (ER) 模型** 或 **二项随机图**。这个模型的构建过程非常直观且优美。

**定义：**
$G(n, p)$ 模型描述了一个在 $n$ 个已标记顶点（例如，一个集合 $V = \{v_1, v_2, \dots, v_n\}$）上的图的[概率分布](@entry_id:146404)。对于每对不同的顶点 $\{v_i, v_j\}$，我们以概率 $p$ 在它们之间画一条边，且每条边的存在与否都是一个独立的随机事件。

想象一下，我们有 $n$ 个个体，对于这 $\binom{n}{2}$ 个可能的配对中的每一个，我们都抛掷一枚不均匀的硬币。这枚硬币正面朝上的概率为 $p$。如果正面朝上，我们就在这对个体之间建立一条连接（例如，友谊或通信链路）；如果反面朝上，则不建立连接。所有这些抛硬币的事件都是[相互独立](@entry_id:273670)的。最终形成的图谱就是 $G(n, p)$ 的一个样本。

#### 核心性质：边的独立性

$G(n, p)$ 模型最根本、最强大的特性就是**边的独立性**。任何两条不共享顶点的边的存在与否是完全独立的。这个性质极大地简化了许多概率计算。

例如，考虑一个网络中有四个不同的节点 $v_1, v_2, v_3, v_4$ [@problem_id:1367287]。假设我们已知边 $(v_1, v_2)$ 存在。那么，边 $(v_3, v_4)$ 存在的[条件概率](@entry_id:151013)是多少？根据模型的定义，这两条边是完全不同的连接，它们的形成是两个独立的随机事件。因此，知道一条边的状态并不会提供任何关于另一条边的信息。其条件概率仍然是 $p$：
$$ P(\text{边 } (v_3, v_4) \text{ 存在} | \text{边 } (v_1, v_2) \text{ 存在}) = P(\text{边 } (v_3, v_4) \text{ 存在}) = p $$

这种独立性使得我们可以轻松计算出现任何特定图结构的概率。一个包含 $n$ 个顶点和 $k$ 条特定边的图，其在 $G(n, p)$ 模型中出现的概率是 $p^k (1-p)^{\binom{n}{2}-k}$，因为这需要 $k$ 条边存在且其余 $\binom{n}{2}-k$ 条边不存在。一个有趣的应用是计算网络“完全连通”的概率，即图中每对顶点之间都存在直接连接 [@problem_id:1367284]。一个完全连通的图（也称为**完全图** $K_n$）拥有所有 $\binom{n}{2}$ 条可能的边。由于每条边都必须独立地存在，这个事件的概率就是所有单个边存在概率的乘积：
$$ P_{\text{full}} = p^{\binom{n}{2}} = p^{\frac{n(n-1)}{2}} $$

#### 顶点的度[分布](@entry_id:182848)

在分析网络时，一个基本问题是：“一个典型的节点有多少个连接？” 这就是**度[分布](@entry_id:182848)**问题。在 $G(n, p)$ 模型中，我们可以精确地回答这个问题。

考虑网络中的一个特定服务器，称之为“服务器A” [@problem_id:1367299]。它可以与其余的 $n-1$ 个服务器中的任何一个建立连接。与每个服务器的连接都是一个独立的**[伯努利试验](@entry_id:268355)**（Bernoulli trial），成功的概率为 $p$。因此，服务器A的总连接数（即它的**度**，degree）是 $n-1$ 次独立[伯努利试验](@entry_id:268355)中“成功”的次数。

这是一个经典的概率场景，其结果遵循**[二项分布](@entry_id:141181)**（Binomial distribution）。一个顶点 $v$ 的度，记为 $\text{deg}(v)$，其等于 $k$ 的概率由[二项分布](@entry_id:141181)的[概率质量函数](@entry_id:265484)给出：
$$ P(\text{deg}(v) = k) = \binom{n-1}{k} p^k (1-p)^{n-1-k} $$
其中 $k$ 是一个整数，范围从 $0$（该顶点是孤立的）到 $n-1$（该顶点与所有其他顶点相连）。这个公式告诉我们，在大型[随机网络](@entry_id:263277)中，大多数节点的度会集中在平均值 $(n-1)p$ 附近。

#### 子图结构：期望的计算

随机图中经常出现哪些局部结构？例如，在一个社交网络中，我们可能关心“三人友谊小组”的数量。计算这些**[子图](@entry_id:273342)**（subgraph）的数量是[随机图论](@entry_id:261982)的一个核心任务。一个极其强大的工具是**[期望的线性](@entry_id:273513)性**（linearity of expectation）。该性质表明，[随机变量](@entry_id:195330)之和的期望等于它们各自期望之和，**无论这些变量是否独立**。

$$ E[X_1 + X_2 + \dots + X_m] = E[X_1] + E[X_2] + \dots + E[X_m] $$

我们可以利用这个性质来计算各种子图的期望数量。

**1. 边的期望数量：** 这是最简单的例子。总共有 $N = \binom{n}{2}$ 对可能的边。对于每对可能的边 $e_i$，我们定义一个[指示变量](@entry_id:266428) $I_i$，如果边存在则为1，否则为0。$E[I_i] = P(I_i=1) = p$。总边数 $X = \sum_{i=1}^N I_i$，因此其期望为：
$$ E[X] = \sum_{i=1}^N E[I_i] = \binom{n}{2}p $$

**2. “介导友谊”（2-星形[子图](@entry_id:273342)）的期望数量：**
考虑一个由三位学生（Alice、Bob、Charles）组成的结构，其中Alice同时是Bob和Charles的朋友，但Bob和Charles彼此不是朋友 [@problem_id:1367273]。这种结构在图论中被称为一个**2-星形[子图](@entry_id:273342)**（2-star）或“樱桃”。Alice是这个结构的中心。

要计算网络中这类“介导友谊”的期望总数，我们可以对所有可能的中心（mediator）进行求和。
首先，选择一个学生作为潜在的中心，比如Alice（有 $n$ 种选择）。
然后，从剩下的 $n-1$ 个学生中选择两个学生，比如Bob和Charles（有 $\binom{n-1}{2}$ 种选择）。
对于这三位特定的学生，形成以Alice为中心的介导友谊需要三个独立的事件：(A) Alice和Bob是朋友（概率 $p$），(B) Alice和Charles是朋友（概率 $p$），以及(C) Bob和Charles不是朋友（概率 $1-p$）。这组特定结构出现的概率是 $p^2(1-p)$。
因此，Alice成为一个介导者的期望次数是她可能形成的介导对的数量乘以每个形成的概率：$\binom{n-1}{2} p^2(1-p)$。
由于任何一个学生都可以成为中心，且每个学生的计算方式都相同，根据[期望的线性](@entry_id:273513)性，我们将这个[期望值](@entry_id:153208)乘以学生总数 $n$，得到网络中介导友谊的期望总数：
$$ E[\text{介导友谊总数}] = n \binom{n-1}{2} p^2(1-p) = \frac{n(n-1)(n-2)}{2} p^2(1-p) $$

这个计算与另一个相关问题紧密联系：对于三个**特定的**顶点 $\{v_1, v_2, v_3\}$，它们构成的**[诱导子图](@entry_id:270312)**（induced subgraph）恰好是一条长度为2的路径的概率是多少？[@problem_id:1367294]。一个[诱导子图](@entry_id:270312)包含这三个顶点以及连接它们的所有边。要形成一条路径，这三个顶点之间必须恰好有两条边。这等价于这三个顶点形成一个2-星形子图。有三种可能的情况，取决于哪个顶点是中心。例如，如果 $v_2$ 是中心，则边 $(v_1, v_2)$ 和 $(v_2, v_3)$ 必须存在，而边 $(v_1, v_3)$ 必须不存在。这个特定构型的概率是 $p^2(1-p)$。由于 $v_1, v_2, v_3$ 都可以作为中心，且这些情况是互斥的，所以总概率为 $3p^2(1-p)$。

**3. “闭合三元组”（三角形）的期望数量：**
在社交网络中，一个“闭合三元组”是指三个互相都是朋友的人 [@problem_id:1367272]。这在图论中对应一个**三角形**（$K_3$ 子图）。
要计算期望的三角形数量，我们再次使用[指示变量](@entry_id:266428)。
首先，网络中可能形成三角形的三人组总数是 $\binom{n}{3}$。
对于任何一个特定的三人组 $\{i, j, k\}$，他们形成一个闭合三元组需要三条边都存在：$(i, j), (j, k), (k, i)$。由于边的独立性，这个事件发生的概率是 $p \times p \times p = p^3$。
让 $X$ 表示图中三角形的总数。我们可以将 $X$ 写成所有可能三人组的[指示变量](@entry_id:266428)之和， $X = \sum_{\{i,j,k\}} I_{\{i,j,k\}}$。
根据[期望的线性](@entry_id:273513)性：
$$ E[X] = \sum_{\{i,j,k\}} E[I_{\{i,j,k\}}] = \sum_{\{i,j,k\}} P(\{i,j,k\} \text{ 是三角形}) = \binom{n}{3} p^3 $$
这个结果的简洁性再次展示了期望线性性的威力。

#### [子图](@entry_id:273342)结构：[方差](@entry_id:200758)的计算

期望告诉我们一个量的平均值，而**[方差](@entry_id:200758)**（variance）则度量了这个量在其[期望值](@entry_id:153208)附近波动的程度。计算[方差](@entry_id:200758)通常比计算期望更复杂，因为它涉及到变量之间的**协[方差](@entry_id:200758)**（covariance）。对于一族[指示变量](@entry_id:266428) $\{X_i\}$ 的和 $X = \sum X_i$，其[方差](@entry_id:200758)为：
$$ \text{Var}(X) = \sum_i \text{Var}(X_i) + \sum_{i \neq j} \text{Cov}(X_i, X_j) $$
其中 $\text{Cov}(X_i, X_j) = E[X_i X_j] - E[X_i]E[X_j]$。如果[指示变量](@entry_id:266428)是独立的，所有协[方差](@entry_id:200758)项都为零，计算就会很简单。

**1. 独立[指示变量](@entry_id:266428)的情况：共同邻居的[方差](@entry_id:200758)**
考虑两个特定的顶点 $v_1$ 和 $v_2$。它们的**共同邻居**是指同时与 $v_1$ 和 $v_2$ 相连的另一个顶点 [@problem_id:1367282]。让 $X$ 表示 $v_1$ 和 $v_2$ 的共同邻居数量。
我们可以从剩下的 $n-2$ 个顶点中寻找共同邻居。对于任何一个顶点 $u_i \in V \setminus \{v_1, v_2\}$，我们定义一个[指示变量](@entry_id:266428) $I_i$，当 $u_i$ 是共同邻居时为1。$u_i$ 是共同邻居意味着边 $(u_i, v_1)$ 和 $(u_i, v_2)$ 都存在。由于这两条边是独立的，所以 $P(I_i=1) = p \times p = p^2$。
现在，关键在于，对于两个不同的顶点 $u_i$ 和 $u_j$，[指示变量](@entry_id:266428) $I_i$ 和 $I_j$ 是否独立？$I_i$ 的值取决于[边集](@entry_id:267160) $\{(u_i, v_1), (u_i, v_2)\}$，$I_j$ 的值取决于[边集](@entry_id:267160) $\{(u_j, v_1), (u_j, v_2)\}$。这四个边是完全不同的。因此，在 $G(n, p)$ 模型中，$I_i$ 和 $I_j$ 是独立的。
这意味着 $X = \sum_{i=1}^{n-2} I_i$ 是 $n-2$ 个独立同分布的伯努利[随机变量](@entry_id:195330)之和，其成功概率为 $p^2$。因此，$X$ 服从[二项分布](@entry_id:141181) $B(n-2, p^2)$。其[方差](@entry_id:200758)可以直接从二项分布的公式得到：
$$ \text{Var}(X) = (n-2) p^2(1-p^2) $$

**2. 相关[指示变量](@entry_id:266428)的情况：三角形数量的[方差](@entry_id:200758)**
计算网络中三角形总数 $T$ 的[方差](@entry_id:200758)是一个更具挑战性的问题，因为它揭示了处理相关依赖性的复杂性 [@problem_id:1367293]。
设 $T = \sum_t X_t$，其中 $t$ 遍历所有 $\binom{n}{3}$ 个顶点三元组，$X_t$ 是三元组 $t$ 形成三角形的[指示变量](@entry_id:266428)。
当两个三元组 $s$ 和 $t$ 共享顶点时，它们也可能共享边，导致[指示变量](@entry_id:266428) $X_s$ 和 $X_t$ 不再独立。
$\text{Var}(T) = \sum_t \text{Var}(X_t) + \sum_{s \neq t} \text{Cov}(X_s, X_t)$。
第一部分很简单：$\sum_t \text{Var}(X_t) = \binom{n}{3} \text{Var}(X_t) = \binom{n}{3}p^3(1-p^3)$。
第二部分协[方差](@entry_id:200758)项需要仔细分析。$\text{Cov}(X_s, X_t) = E[X_sX_t] - E[X_s]E[X_t] = P(s \text{ 和 } t \text{ 都是三角形}) - (p^3)^2$。
- 如果三元组 $s$ 和 $t$ 不共享任何顶点，或只共享一个顶点，它们就不会共享任何边。形成这两个三角形需要6条不同的边。因此 $P(s, t \text{ 都是三角形}) = p^6$，协[方差](@entry_id:200758)为 $p^6 - (p^3)^2 = 0$。
- 如果 $s$ 和 $t$ 共享两个顶点，这意味着它们共享一条公共边。例如，$s=\{i,j,k\}$ 和 $t=\{i,j,l\}$。形成这两个三角形需要5条边（公共边 $(i,j)$，以及 $(i,k), (j,k), (i,l), (j,l)$）。因此，$P(s, t \text{ 都是三角形}) = p^5$。协[方差](@entry_id:200758)为 $p^5 - p^6 = p^5(1-p)$。

因此，只有共享一条边的三角形对才会对总[方差](@entry_id:200758)的协[方差](@entry_id:200758)项有贡献。我们需要计算这种配对的数量。共享一条边的**无序**三角形对有 $6\binom{n}{4}$ 对。在对所有[有序对](@entry_id:269702) $s \neq t$ 求和时，每对这样的无序对贡献两次协[方差](@entry_id:200758)（一次是 $\text{Cov}(X_s, X_t)$，一次是 $\text{Cov}(X_t, X_s)$）。
将所有这些组合起来，三角形总数的[方差](@entry_id:200758)为：
$$ \text{Var}(T) = \binom{n}{3}p^3(1-p^3) + 2 \times \left(6\binom{n}{4}\right) \times p^5(1-p) = \binom{n}{3}p^3(1-p^3) + 12\binom{n}{4}p^5(1-p) $$
这个结果虽然复杂，但它精确地刻画了网络中高度聚集（成团）结构的波动性。

### G(n, M) 模型：均匀[随机图](@entry_id:270323)

除了 $G(n, p)$ 模型，Erdős 和 Rényi 还提出了另一个密切相关的模型，称为 **$G(n, M)$ 模型**或**均匀[随机图](@entry_id:270323)**。

**定义：**
$G(n, M)$ 模型描述了一个在 $n$ 个顶点上恰好有 $M$ 条边的图的[概率分布](@entry_id:146404)。它的构造方式是：从所有 $\binom{n}{2}$ 条可能的边中，等概率地、不放回地随机选择 $M$ 条边。

因此，$G(n, M)$ 的样本空间是所有包含 $n$ 个顶点和 $M$ 条边的图，每个这样的图被选中的概率都是相同的，即 $1 / \binom{\binom{n}{2}}{M}$。

#### 核心性质：边的依赖性

与 $G(n, p)$ 模型形成鲜明对比的是，在 $G(n, M)$ 模型中，**边的存在与否是相互依赖的**。这是一个固定的“边预算”所带来的后果。知道一条边存在，意味着可用于形成其他边的“名额”少了一个，这会轻微地降低任何另一条边存在的概率。这种依赖性是一种**负相关**。

我们可以通过一个具体的计算来量化这种差异 [@problem_id:1367266]。考虑两条特定的边 $e_1$ 和 $e_2$。
在 $G(n, M)$ 模型中，包含这两条边的概率 $P_M$ 是：
$$ P_M(e_1, e_2) = \frac{\text{包含 } e_1, e_2 \text{ 的图的数量}}{\text{总图数}} = \frac{\binom{\binom{n}{2}-2}{M-2}}{\binom{\binom{n}{2}}{M}} = \frac{M(M-1)}{\binom{n}{2}(\binom{n}{2}-1)} $$
为了与 $G(n, p)$ 模型进行比较，我们设定 $p$ 使得边的期望数量为 $M$，即 $p = M / \binom{n}{2}$。在 $G(n, p)$ 中，由于独立性，同时包含 $e_1$ 和 $e_2$ 的概率 $P_p$ 是：
$$ P_p(e_1, e_2) = p^2 = \left(\frac{M}{\binom{n}{2}}\right)^2 $$
这两个概率的比值 $R = P_M/P_p$ 为：
$$ R = \frac{\frac{M(M-1)}{\binom{n}{2}(\binom{n}{2}-1)}}{\left(\frac{M}{\binom{n}{2}}\right)^2} = \frac{M-1}{M} \cdot \frac{\binom{n}{2}}{\binom{n}{2}-1} $$
由于 $M > 1$ 且 $\binom{n}{2} > 1$，这个比值 $R$ 略小于1。这精确地表明，在 $G(n, M)$ 中，两条边同时出现的概率要比在期望边数相同的 $G(n, p)$ 模型中略低，证实了它们之间的负相关性。

#### 在 G(n, M) 中进行计算

在 $G(n, M)$ 模型中的计算通常是[组合计数](@entry_id:141086)问题。例如，考虑在一个由 $n$ 个服务器和 $M$ 条连接构成的网络中，一个特定服务器“Alpha”完全孤立的概率 [@problem_id:1367277]。
- 总的可能网络数量为 $\binom{\binom{n}{2}}{M}$。
- 为了使Alpha服务器孤立，它的 $n-1$ 条潜在连接都不能被选中。这意味着所有 $M$ 条边都必须从不涉及Alpha的其余 $\binom{n-1}{2}$ 条边中选择。
- 满足这个条件的“有利”网络数量为 $\binom{\binom{n-1}{2}}{M}$。
- 因此，Alpha服务器被隔离的概率是“有利”情况数与总情况数的比值：
$$ P(\text{Alpha 孤立}) = \frac{\binom{\binom{n-1}{2}}{M}}{\binom{\binom{n}{2}}{M}} $$
这个例子突出了 $G(n, M)$ 模型分析中典型的组合推理风格。

### 总结

本章我们详细探讨了两种经典的[随机图](@entry_id:270323)模型：$G(n, p)$ 和 $G(n, M)$。$G(n, p)$ 模型因其边的独立性而具有强大的分析便利性，使得计算度[分布](@entry_id:182848)、子图期望等属性变得直接。我们通过[期望的线性](@entry_id:273513)性和[方差](@entry_id:200758)的计算，展示了如何从微观的边概率推导出宏观的网络结构特性。相比之下，$G(n, M)$ 模型固定了边的总数，引入了边之间的负相关性，其分析更多地依赖于[组合计数](@entry_id:141086)。

尽管这两个模型在定义和数学处理上有所不同，但在许多情况下，特别是当 $n$ 很大时，如果设置 $p \approx M/\binom{n}{2}$，它们的行为会非常相似。理解这两个模型的基本原理和机制，是深入学习[随机图论](@entry_id:261982)中更有趣的现象（如[相变](@entry_id:147324)和巨[连通分量](@entry_id:141881)的出现）所必需的基础。