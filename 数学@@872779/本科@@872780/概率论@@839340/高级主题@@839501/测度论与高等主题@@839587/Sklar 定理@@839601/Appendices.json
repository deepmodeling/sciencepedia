{"hands_on_practices": [{"introduction": "在深入研究Copula的应用之前，首先必须能够识别一个函数是否为有效的Copula。这个练习将带你检验一个给定函数是否满足作为Copula所必需的基本公理，这对于理解Copula理论的数学基础至关重要[@problem_id:1387889]。通过这个实践，你将学会如何应用边界条件和2-增性质来验证一个函数的有效性。", "problem": "在概率论中，一个二元 copula 是一个函数 $C: [0, 1]^2 \\to [0, 1]$，它将一元边际分布与其完整的联合分布连接起来。一个函数要成为一个有效的二元 copula，必须满足以下三个公理：\n\n1.  **边界条件（归零性）：** 对任意 $u, v \\in [0, 1]$，有\n    $C(u, 0) = 0$ 且 $C(0, v) = 0$。\n\n2.  **边界条件（边际性）：** 对任意 $u, v \\in [0, 1]$，有\n    $C(u, 1) = u$ 且 $C(1, v) = v$。\n\n3.  **2-递增性质：** 对于任意满足 $0 \\le u_1 \\le u_2 \\le 1$ 和 $0 \\le v_1 \\le v_2 \\le 1$ 的矩形 $[u_1, u_2] \\times [v_1, v_2]$，copula 赋予该矩形的体积（称为 $C$-体积）必须为非负。即，\n    $C(u_2, v_2) - C(u_2, v_1) - C(u_1, v_2) + C(u_1, v_1) \\ge 0$。\n\n考虑定义在域 $[0, 1]^2$ 上的函数 $F(u, v) = u \\sqrt{v}$。请判断该函数违反了有效 copula 的哪一条公理。\n\nA. 条件 $C(u, 0) = 0$。\n\nB. 条件 $C(u, 1) = u$。\n\nC. 条件 $C(1, v) = v$。\n\nD. 2-递增性质。\n\nE. 该函数是一个有效的 copula；没有违反任何性质。", "solution": "给定函数 $F(u,v)=u\\sqrt{v}$，其定义域为 $[0,1]^{2}$，我们必须检查所列出的三个 copula 公理。\n\n首先是边界条件（归零性）：对任意 $u,v\\in[0,1]$，\n$$\nF(u,0)=u\\sqrt{0}=0,\\quad F(0,v)=0\\cdot\\sqrt{v}=0,\n$$\n所以归零性条件成立。\n\n其次是边界条件（边际性）：对任意 $u,v\\in[0,1]$，\n$$\nF(u,1)=u\\sqrt{1}=u,\n$$\n这满足 $C(u,1)=u$。然而，\n$$\nF(1,v)=1\\cdot\\sqrt{v}=\\sqrt{v},\n$$\n并且对于 $v\\in(0,1)$，有 $\\sqrt{v}\\neq v$，所以条件 $C(1,v)=v$ 被违反。\n\n2-递增性质：对于任意满足 $0\\leq u_{1}\\leq u_{2}\\leq 1$ 和 $0\\leq v_{1}\\leq v_{2}\\leq 1$ 的矩形 $[u_{1},u_{2}]\\times[v_{1},v_{2}]$，其 $F$-体积为\n$$\nF(u_{2},v_{2})-F(u_{2},v_{1})-F(u_{1},v_{2})+F(u_{1},v_{1})\n= u_{2}\\sqrt{v_{2}}-u_{2}\\sqrt{v_{1}}-u_{1}\\sqrt{v_{2}}+u_{1}\\sqrt{v_{1}}\n= (u_{2}-u_{1})\\bigl(\\sqrt{v_{2}}-\\sqrt{v_{1}}\\bigr)\\geq 0,\n$$\n因为 $u_{2}\\geq u_{1}$ 且 $\\sqrt{v_{2}}\\geq\\sqrt{v_{1}}$。因此 2-递增性质成立。\n\n因此，唯一被违反的公理是边际条件 $C(1,v)=v$。", "answer": "$$\\boxed{C}$$", "id": "1387889"}, {"introduction": "Copula函数本身是一个累积分布函数（CDF），而它的密度函数在统计推断和模拟中扮演着核心角色。这个练习将教你如何从一个给定的Copula函数（Farlie-Gumbel-Morgenstern Copula）出发，通过求导来得到其对应的Copula密度函数[@problem_id:1387859]。掌握这项技能是进行更高级分析（如最大似然估计）的前提。", "problem": "在概率论中，Copula 是一种多元累积分布函数，其每个变量的边缘概率分布都在区间 $[0, 1]$ 上服从均匀分布。Copula密度函数，记为 $c(u_1, u_2, \\dots, u_d)$，与其对应的Copula函数 $C(u_1, u_2, \\dots, u_d)$ 通过以下方程相关联：\n$$c(u_1, u_2, \\dots, u_d) = \\frac{\\partial^d C(u_1, u_2, \\dots, u_d)}{\\partial u_1 \\partial u_2 \\dots \\partial u_d}$$\n考虑 Farlie-Gumbel-Morgenstern (FGM) 二元Copula族的一个成员，它由以下函数定义：\n$$C(u, v) = uv[1 + \\alpha(1-u)(1-v)]$$\n其中，$u$ 和 $v$ 是区间 $[0, 1]$ 内的变量，$\\alpha$ 是一个控制相关性的常数参数，且 $\\alpha \\in [-1, 1]$。\n\n求给定 FGM Copula 的密度函数 $c(u,v)$。您的答案应为一个以 $u$、$v$ 和 $\\alpha$ 表示的表达式。", "solution": "我们已知Copula函数为 $C(u,v) = uv[1 + \\alpha(1-u)(1-v)]$，其中 $u,v \\in [0,1]$ 且 $\\alpha \\in [-1,1]$。Copula密度定义为其混合二阶偏导数：\n$$\nc(u,v) = \\frac{\\partial^{2} C(u,v)}{\\partial u \\partial v}.\n$$\n首先计算关于 $u$ 的偏导数。将 $v$ 视为常数，并写作\n$$\nC(u,v) = v \\cdot \\left(u[1 + \\alpha(1-u)(1-v)]\\right).\n$$\n定义 $f(u) = u[1 + \\alpha(1-u)(1-v)]$。那么\n$$\n\\frac{d f(u)}{d u} = 1 \\cdot [1 + \\alpha(1-u)(1-v)] + u \\cdot \\alpha \\cdot \\frac{d}{d u}\\left[(1-u)(1-v)\\right].\n$$\n因为 $\\frac{d}{d u}[(1-u)(1-v)] = -(1-v)$，我们得到\n$$\n\\frac{d f(u)}{d u} = 1 + \\alpha(1-u)(1-v) - \\alpha u(1-v) = 1 + \\alpha(1-v)\\left[(1-u) - u\\right] = 1 + \\alpha(1-v)(1 - 2u).\n$$\n因此，\n$$\n\\frac{\\partial C(u,v)}{\\partial u} = v \\cdot \\frac{d f(u)}{d u} = v + \\alpha v(1-v)(1 - 2u).\n$$\n现在对该式关于 $v$ 求导，以得到Copula密度：\n$$\nc(u,v) = \\frac{\\partial}{\\partial v}\\left[v + \\alpha v(1-v)(1 - 2u)\\right].\n$$\n逐项求导。$v$ 的导数是 $1$。对于第二项，将 $(1 - 2u)$ 视为常数，并对 $v(1 - v) = v - v^{2}$ 使用乘积法则：\n$$\n\\frac{\\partial}{\\partial v}\\left[\\alpha v(1-v)(1 - 2u)\\right] = \\alpha(1 - 2u)\\frac{\\partial}{\\partial v}[v - v^{2}] = \\alpha(1 - 2u)(1 - 2v).\n$$\n因此，\n$$\nc(u,v) = 1 + \\alpha(1 - 2u)(1 - 2v).\n$$\n该表达式关于 $u$ 和 $v$ 是对称的，这与 FGM Copula 密度的预期相符。", "answer": "$$\\boxed{1+\\alpha(1-2u)(1-2v)}$$", "id": "1387859"}, {"introduction": "Sklar定理最强大的启示之一是，即使我们不了解随机变量之间确切的依赖关系，我们仍然可以为其联合概率设定一个理论上的范围。这个练习将应用Fréchet-Hoeffding界限来解决一个实际问题：确定两个事件联合发生概率的最小值和最大值[@problem_id:1387882]。这展示了Copula理论在风险管理和不确定性量化中的直接应用价值。", "problem": "设 $X$ 和 $Y$ 是两个随机变量，分别表示一个电子元件的归一化寿命。归一化确保了它们的寿命被缩放到区间 $[0, 1]$ 内。已知这些寿命的个体概率分布在 $[0,1]$ 上是均匀的，即 $X \\sim \\text{Uniform}(0,1)$ 和 $Y \\sim \\text{Uniform}(0,1)$。\n\n然而，关于这两个元件寿命之间的依赖关系没有任何信息。您的任务是确定第一个元件寿命不超过 $0.2$ 且第二个元件寿命不超过 $0.3$ 的联合概率的最紧理论范围。\n\n计算这个联合概率 $P(X \\le 0.2 \\text{ and } Y \\le 0.3)$ 的下界和上界。", "solution": "设 $A=\\{X \\le a\\}$ 且 $B=\\{Y \\le b\\}$，其中 $a=0.2$ 且 $b=0.3$。因为 $X \\sim \\text{Uniform}(0,1)$ 且 $Y \\sim \\text{Uniform}(0,1)$，它们在 $[0,1]$ 上的边际分布函数为 $F_{X}(x)=x$ 和 $F_{Y}(y)=y$，因此 $P(A)=F_{X}(a)=a=0.2$ 且 $P(B)=F_{Y}(b)=b=0.3$。\n\n在没有关于依赖关系的信息的情况下，Fréchet–Hoeffding 界给出，对于任意 $a,b \\in [0,1]$，\n$$\n\\max\\!\\big(F_{X}(a)+F_{Y}(b)-1,\\,0\\big) \\le P(X \\le a, Y \\le b) \\le \\min\\!\\big(F_{X}(a),F_{Y}(b)\\big).\n$$\n代入 $a=0.2$ 和 $b=0.3$，下界为\n$$\n\\max\\!\\left(0.2+0.3-1,\\,0\\right)\n=\\max\\!\\left(0.5-1,\\,0\\right)\n=\\max\\!\\left(-0.5,\\,0\\right)\n=0,\n$$\n且上界为\n$$\n\\min\\!\\left(0.2, 0.3\\right)=0.2.\n$$\n\n这些界是紧的。例如，它们可以通过同调耦合 $Y=X$（得到 $P(X \\le 0.2, Y \\le 0.3)=P(X \\le 0.2)=0.2$）和反同调耦合 $Y=1-X$（得到 $P(X \\le 0.2, Y \\le 0.3)=P(X \\le 0.2, X \\ge 0.7)=0$）来达到，这两种耦合都保持了给定的均匀边际分布。", "answer": "$$\\boxed{[0, \\frac{1}{5}]}$$", "id": "1387882"}]}