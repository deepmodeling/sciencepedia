{"hands_on_practices": [{"introduction": "许多现实世界中的随机过程，例如种群的繁衍、疾病的传播或中子链式反应，都可以用分支过程来建模。杜布鞅收敛定理为分析这些系统的长期行为提供了坚实的理论基础。通过这个关于细菌菌落存续的练习[@problem_id:1359221]，您将亲手计算一个种群无限存续的概率，从而将抽象的收敛定理与一个具体且直观的结果联系起来。", "problem": "将一个经过基因改造的细菌放入营养丰富的培养皿中。在每一秒结束时，这个细菌及其任何后代，将以概率 $q$ 死亡，或以概率 $p$ 分裂成两个相同的细菌。在此过程中，一个细菌不能保持为单个实体；它必须要么死亡，要么分裂，因此有 $p+q=1$。菌落中的每个细菌都独立地按照这些相同的概率行事。如果菌落的种群数量长期来看不归零，则认为该菌落存活下来了。假设分裂的概率 $p$ 严格大于死亡的概率 $q$。\n\n确定初始细菌产生一个无限存活的菌落的长期概率。你的答案应该是一个用 $p$ 和 $q$ 表示的封闭形式表达式。", "solution": "将菌落建模为一个Galton–Watson分支过程，其后代分布为：每个细菌有0个后代的概率为 $q$（死亡），或有2个后代的概率为 $p$（分裂），其中 $p+q=1$。令 $s$ 表示从单个细菌开始的灭绝概率。根据分支特性和独立性，灭绝要么立即发生（概率为 $q$），要么在初始细菌分裂（概率为 $p$）后，其两个后代谱系都独立地灭绝，其概率为 $s^2$。因此 $s$ 满足：\n$$\ns = q + ps^2\n$$\n改写后得到二次方程：\n$$\nps^2 - s + q = 0\n$$\n求解得：\n$$\ns = \\frac{1 \\pm \\sqrt{1 - 4pq}}{2p}\n$$\n使用 $p+q=1$，计算判别式：\n$$\n1 - 4pq = 1 - 4p(1 - p) = (1 - 2p)^2\n$$\n因此：\n$$\ns = \\frac{1 \\pm |1 - 2p|}{2p}\n$$\n给定 $p>q$ 和 $p+q=1$，我们有 $p>1/2$，所以 $|1 - 2p| = 2p - 1$。两个根是：\n$$\ns_1 = 1, \\qquad s_2 = \\frac{1 - p}{p} = \\frac{q}{p}\n$$\n灭绝概率是 $[0,1]$ 区间内的最小根，即 $s = q/p$。因此，存活概率是：\n$$\n1 - s = 1 - \\frac{q}{p} = \\frac{p - q}{p}\n$$\n因为 $p>q$，所以该值为正。", "answer": "$$\\boxed{\\frac{p - q}{p}}$$", "id": "1359221"}, {"introduction": "鞅收敛定理保证了某些鞅几乎必然会收敛到一个极限，但这并不意味着所有类型的收敛都会发生。理解不同收敛模式之间的差异——例如几乎必然收敛与$L^2$收敛——对于深刻掌握该定理至关重要。这个问题[@problem_id:1317116]提供了一个经典的例子，它构建了一个几乎必然收敛但在$L^2$范数下不收敛的鞅，这有助于澄清定理的条件和结论的微妙之处。", "problem": "设 $\\{X_k\\}_{k=1}^\\infty$ 是定义在概率空间 $(\\Omega, \\mathcal{F}, P)$ 上的一个独立 Rademacher 随机变量序列。一个 Rademacher 随机变量 $X_k$ 以 $1/2$ 的概率取值 $1$，以 $1/2$ 的概率取值 $-1$。设 $\\mathcal{F}_n = \\sigma(X_1, X_2, \\dots, X_n)$（对于 $n \\ge 1$）是由该序列生成的自然滤。\n\n考虑由下式定义的随机过程 $\\{M_n\\}_{n=1}^\\infty$：\n$$M_n = \\prod_{k=1}^{n} \\left(1 + \\frac{X_k}{\\sqrt{k}}\\right)$$\n可以证明 $\\{M_n, \\mathcal{F}_n\\}_{n=1}^\\infty$ 是一个鞅。\n\n关于鞅 $M_n$ 在 $n \\to \\infty$ 时的收敛性，以下哪个陈述是正确的？\n\nA. $M_n$ 在 $L^2$ 中收敛，但不是几乎必然收敛。\n\nB. $M_n$ 几乎必然收敛，但在 $L^2$ 中不收敛。\n\nC. $M_n$ 既几乎必然收敛，也在 $L^2$ 中收敛。\n\nD. $M_n$ 既不几乎必然收敛，也不在 $L^2$ 中收敛。\n\nE. 从给定信息中无法确定 $M_n$ 的收敛行为。", "solution": "我们首先验证该过程的关键性质。对每个 $k \\geq 1$，因子 $1 + \\frac{X_k}{\\sqrt{k}}$ 几乎必然是非负的：当 $k=1$ 时，它等于 $0$ 或 $2$；当 $k \\geq 2$ 时，它位于区间 $(1 - \\frac{1}{\\sqrt{k}}, 1 + \\frac{1}{\\sqrt{k}}) \\subset (0, \\infty)$ 内。因此，对所有 $n$，$M_n \\ge 0$ 几乎必然成立。此外，由于 $X_k$ 是独立的、中心化的 Rademacher 变量，并且 $\\mathcal{F}_n = \\sigma(X_1,\\dots,X_n)$，我们有：\n$$\n\\begin{aligned}\nE[M_n \\mid \\mathcal{F}_{n-1}]\n= M_{n-1}\\,E\\left[1 + \\frac{X_n}{\\sqrt{n}} \\mid \\mathcal{F}_{n-1}\\right] \\\\\n= M_{n-1}\\,\\left(1 + \\frac{E[X_n]}{\\sqrt{n}}\\right) \\\\\n= M_{n-1}.\n\\end{aligned}\n$$\n因此，$\\{M_n,\\mathcal{F}_n\\}$ 是一个非负鞅，且对所有 $n$ 都有 $E[M_n]=E[M_1]=1$。\n\n根据 Doob 关于非负上鞅的鞅收敛定理（这里应用于一个非负鞅），$M_n$ 几乎必然收敛到一个有限极限 $M_{\\infty}$。\n\n我们现在证明 $M_n$ 不在 $L^2$ 中收敛。利用 $k$ 之间的独立性：\n$$\n\\begin{aligned}\nE[M_n^2] = E\\left[\\prod_{k=1}^{n}\\left(1 + \\frac{X_k}{\\sqrt{k}}\\right)^{2}\\right] \\\\\n= \\prod_{k=1}^{n}E\\left[\\left(1 + \\frac{X_k}{\\sqrt{k}}\\right)^{2}\\right].\n\\end{aligned}\n$$\n对每个 $k$，\n$$\n\\left(1 + \\frac{X_k}{\\sqrt{k}}\\right)^{2} = 1 + \\frac{2X_k}{\\sqrt{k}} + \\frac{X_k^2}{k},\n$$\n因此，利用 $E[X_k]=0$ 和 $X_k^2=1$ 几乎必然成立，\n$$\nE\\left[\\left(1 + \\frac{X_k}{\\sqrt{k}}\\right)^{2}\\right] = 1 + \\frac{1}{k} = \\frac{k+1}{k}.\n$$\n因此，\n$$\nE[M_n^2] = \\prod_{k=1}^{n}\\frac{k+1}{k} = n+1,\n$$\n当 $n \\to \\infty$ 时，该式发散到 $+\\infty$。如果 $M_n$ 在 $L^2$ 中收敛，那么 $\\{E[M_n^2]\\}$ 将是有界的，并收敛到 $E[M_{\\infty}^2]$，这与我们的结果矛盾。因此 $M_n$ 不在 $L^2$ 中收敛。\n\n综合这些事实，$M_n$ 几乎必然收敛，但在 $L^2$ 中不收敛。正确的选项是 B。", "answer": "$$\\boxed{B}$$", "id": "1317116"}, {"introduction": "鞅的一个优美应用是模拟信息逐步揭示的过程，这类鞅被称为“杜布鞅”。给定一个随机变量$Y$和一系列不断增长的信息集$\\mathcal{F}_n$，鞅$M_n = E[Y | \\mathcal{F}_n]$代表了我们在第$n$阶段对$Y$的最佳估计。这个练习[@problem_id:1359235]将此概念应用于一个精妙的组合学背景——随机排列中的圈分解，它揭示了当关于排列的信息逐一揭晓时，我们对其圈数的期望是如何收敛到真实值的。", "problem": "设 $S_N$ 为集合 $\\{1, 2, \\dots, N\\}$ 上所有置换构成的对称群。从 $S_N$ 中均匀随机地选择一个置换 $\\sigma$。记 $C(\\sigma)$ 为 $\\sigma$ 的不相交循环分解中的循环个数。\n\n对从 $1$ 到 $N$ 的每个整数 $n$，由该置换的前 $n$ 个映射所揭示的信息，由 sigma-代数 $\\mathcal{F}_n$ 捕获，该 sigma-代数是由随机变量 $\\sigma(1), \\sigma(2), \\dots, \\sigma(n)$ 生成的。\n定义一个随机过程 $\\{M_n\\}_{n=1}^N$ 为总循环数的条件期望：\n$$M_n = E[C(\\sigma) | \\mathcal{F}_n]$$\n这个过程是一个鞅。根据 Doob 的鞅收敛定理，这个鞅几乎必然收敛。在这个有限的设定中，极限是序列的最后一项 $M_N$。\n\n求此极限随机变量的二阶矩 $E[M_N^2]$ 的精确表达式。你的答案应以 $N$ 和广义调和数表示，广义调和数定义为 $H_N^{(m)} = \\sum_{k=1}^N \\frac{1}{k^m}$。", "solution": "信息流 $\\mathcal{F}_n$ 由前 $n$ 个像 $\\sigma(1),\\dots,\\sigma(n)$ 生成，而 $\\mathcal{F}_N$ 揭示了整个置换。因此\n$$\nM_N = E[C(\\sigma)\\mid \\mathcal{F}_N] = C(\\sigma).\n$$\n因此 $E[M_N^2] = E[C(\\sigma)^2]$。我们现在计算 $E[C(\\sigma)^2]$。\n\n考虑在 $\\{1,\\dots,N\\}$ 上均匀随机置换的标准序贯构造（参数为1的 Ewens 抽样公式）：在第 $k$ 步，给定 $\\{1,\\dots,k-1\\}$ 上的部分结构，元素 $k$ 要么开始一个新循环，要么被均匀地插入到现有循环中的 $k-1$ 个可用位置之一。在第 $k$ 步，恰好有 $k$ 个等可能的选择，其中恰好有一个选择会开始一个新循环。设 $B_k$ 为第 $k$ 步开始一个新循环的指示变量。那么\n$$\nP(B_k=1) = \\frac{1}{k}, \\qquad P(B_k=0) = 1-\\frac{1}{k},\n$$\n并且根据构造，在不同步骤做出的选择是独立的，所以 $\\{B_k\\}_{k=1}^{N}$ 是参数为 $p_k=1/k$ 的独立伯努利随机变量。总循环数恰好是开始新循环的次数，因此\n$$\nC(\\sigma) = \\sum_{k=1}^{N} B_k.\n$$\n\n利用独立性，\n$$\nE[C(\\sigma)] = \\sum_{k=1}^{N} E[B_k] = \\sum_{k=1}^{N} \\frac{1}{k} = H_N,\n$$\n且\n$$\n\\operatorname{Var}(C(\\sigma)) = \\sum_{k=1}^{N} \\operatorname{Var}(B_k) = \\sum_{k=1}^{N} \\frac{1}{k}\\left(1-\\frac{1}{k}\\right) = \\sum_{k=1}^{N} \\frac{1}{k} - \\sum_{k=1}^{N} \\frac{1}{k^2} = H_N - H_N^{(2)}.\n$$\n因此，\n$$\nE[C(\\sigma)^2] = \\operatorname{Var}(C(\\sigma)) + (E[C(\\sigma)])^2\n= (H_N - H_N^{(2)}) + H_N^2\n= H_N^2 + H_N - H_N^{(2)}.\n$$\n\n由于 $M_N=C(\\sigma)$，可得\n$$\nE[M_N^2] = H_N^2 + H_N - H_N^{(2)}.\n$$\n此处 $H_N = H_N^{(1)}$ 和 $H_N^{(2)}$ 是题目中定义的广义调和数。", "answer": "$$\\boxed{H_N^2+H_N-H_N^{(2)}}$$", "id": "1359235"}]}