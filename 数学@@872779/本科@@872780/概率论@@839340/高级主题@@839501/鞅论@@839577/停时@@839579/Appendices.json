{"hands_on_practices": [{"introduction": "本练习介绍了一项核心技术：将可选停止定理应用于一个巧妙选择的鞅。我们将看到这个强大的定理如何解决一个有偏随机游走首次到达两个边界之一的经典问题，这是一个为许多现实世界过程奠定基础的模型。[@problem_id:849549]", "problem": "考虑一个一维有偏随机游走 $S_n = \\sum_{i=1}^n X_i$，从 $S_0 = 0$ 开始。步长 $X_i$ 是独立同分布的随机变量，满足 $P(X_i = 1) = p$ 和 $P(X_i = -1) = q = 1-p$，其中 $p \\neq 1/2$。\n\n对于此随机游走，过程 $M_n = (q/p)^{S_n}$ 是关于自然滤子 $\\mathcal{F}_n = \\sigma(X_1, \\dots, X_n)$ 的一个鞅。\n\n设 $a$ 和 $b$ 是代表吸收壁的正整数。定义停时 $T$ 为游走首次达到水平 $a$ 或水平 $-b$ 的时间：\n$$T = \\inf\\{ n \\ge 1 : S_n = a \\text{ or } S_n = -b \\}$$\n\n使用鞅 $M_n$ 上的可选停止定理，推导游走在到达水平 $-b$ 之前先到达水平 $a$ 的概率的闭式表达式。该概率记为 $P(S_T = a)$。请用 $p, q, a,$ 和 $b$ 表示你的答案。", "solution": "1. 回顾 $M_n = \\bigl(\\tfrac{q}{p}\\bigr)^{S_n}$ 是一个鞅，且 $T=\\inf\\{n\\ge1:S_n=a\\text{ or }S_n=-b\\}$ 几乎必然有限。  \n2. 根据可选停止定理，  \n   $$E[M_T]=E[M_0]=\\bigl(\\tfrac{q}{p}\\bigr)^0=1\\,. $$\n3. 在时间 $T$，$S_T$ 的值为 $a$ 或 $-b$。设 $\\alpha=P(S_T=a)$。那么  \n   $$E[M_T]\n     =\\alpha\\bigl(\\tfrac{q}{p}\\bigr)^a+(1-\\alpha)\\bigl(\\tfrac{q}{p}\\bigr)^{-b}\n     =1\\,. $$\n4. 记 $r=\\tfrac{q}{p}$。那么  \n   $$\\alpha\\,r^a+(1-\\alpha)\\,r^{-b}=1\n     \\quad\\Longrightarrow\\quad\n     \\alpha\\,(r^a-r^{-b})=1-r^{-b}\n     \\quad\\Longrightarrow\\quad\n     \\alpha=\\frac{1-r^{-b}}{\\,r^a-r^{-b}\\,}\\,. $$\n5. 将分子和分母同乘以 $r^b$：  \n   $$\\alpha=\\frac{r^b-1}{r^{a+b}-1}\n     =\\frac{1-(q/p)^b}{1-(q/p)^{a+b}}\\,. $$\n因此，在到达 $-b$ 之前先到达 $a$ 的概率是 $\\displaystyle\\frac{1-(q/p)^b}{1-(q/p)^{a+b}}$。", "answer": "$$\\boxed{\\frac{1 - (q/p)^b}{1 - (q/p)^{a+b}}}$$", "id": "849549"}, {"introduction": "现在，让我们将这些概念应用于金融数学中一个更实际的场景。本练习使用几何布朗运动来模拟股票价格，并利用停时概念来计算在触及止损限价之前达到盈利目标的概率，这对任何交易者或投资者来说都是一个至关重要的问题。[@problem_id:849541]", "problem": "一只不支付股息的股票在时间 $t$ 的价格 $S_t$ 由几何布朗运动（GBM）建模，遵循以下随机微分方程：\n$$\ndS_t = \\mu S_t dt + \\sigma S_t dB_t\n$$\n其中 $\\mu$ 是恒定的预期回报率，$\\sigma > 0$ 是恒定的波动率，$B_t$ 是标准的一维布朗运动。一位投资者以初始价格 $S_0 > 0$ 购买该股票。该投资者采用一种策略，即一旦股价达到上限目标价 $U = k_U S_0$ 或下限止损价 $L = k_L S_0$，就立即卖出股票，其中 $k_U > 1$ 和 $0  k_L  1$ 是固定的乘法因子。\n\n假设对数价格过程的有效漂移率 $\\mu - \\frac{1}{2}\\sigma^2$ 非零。\n\n推导投资者在上限目标价 $U$ 而非下限止损价 $L$ 卖出股票的概率的封闭式表达式。用 $\\mu$、$\\sigma$、$k_U$ 和 $k_L$ 表示您的答案。", "solution": "定义对数价格过程\n$$X_t=\\ln\\frac{S_t}{S_0}，$$\n则根据 Itô's lemma\n$$dX_t=\\Bigl(\\mu-\\tfrac12\\sigma^2\\Bigr)\\,dt+\\sigma\\,dB_t。$$\n设\n$$m=\\mu-\\tfrac12\\sigma^2,\\quad a=\\ln k_L  0,\\quad b=\\ln k_U>0,$$\n并注意 $X_0=0$。对于一个漂移率为 $m$、扩散系数为 $\\sigma$ 的布朗运动，从 $x$ 点出发，在触及 $a$ 之前先触及 $b$ 的概率为\n$$P_x\\{\\tau_b  \\tau_a\\}\n=\\frac{\\displaystyle\\int_a^x e^{-2m y/\\sigma^2}\\,dy}{\\displaystyle\\int_a^b e^{-2m y/\\sigma^2}\\,dy}。$$\n令 $x=0$ 可得\n$$P=\\frac{\\displaystyle\\int_a^0e^{-2m y/\\sigma^2}dy}{\\displaystyle\\int_a^b e^{-2m y/\\sigma^2}dy}\n=\\frac{e^{-2m a/\\sigma^2}-1}{e^{-2m a/\\sigma^2}-e^{-2m b/\\sigma^2}}。$$\n代入 $a=\\ln k_L$，$b=\\ln k_U$：\n$$e^{-2m a/\\sigma^2}=k_L^{-2m/\\sigma^2},\\quad e^{-2m b/\\sigma^2}=k_U^{-2m/\\sigma^2},$$\n所以\n$$P=\\frac{k_L^{-2m/\\sigma^2}-1}{k_L^{-2m/\\sigma^2}-k_U^{-2m/\\sigma^2}},$$\n其中 $m=\\mu-\\tfrac12\\sigma^2$。", "answer": "$$\\boxed{\\frac{k_L^{-2(\\mu-\\sigma^2/2)/\\sigma^2}-1}{k_L^{-2(\\mu-\\sigma^2/2)/\\sigma^2}-k_U^{-2(\\mu-\\sigma^2/2)/\\sigma^2}}}$$", "id": "849541"}, {"introduction": "停时不仅适用于随机游走和金融领域，它也是分析组合问题的关键工具。本练习通过将总收集时间分解为一系列更小、更易于管理的等待时间来解决著名的优惠券收集者问题，展示了一种不同但同样优美的分析方法。[@problem_id:849585]", "problem": "在赠券收集问题中，一个收集者旨在集齐一套 $N$ 种不同的赠券。在每个时间步，抽取一张赠券，$N$ 种赠券中的每一种被抽到的概率均等，为 $1/N$。每次抽取都是独立的。令 $T_N$ 为随机变量，表示集齐全部 $N$ 种不同赠券所需的总抽取次数。\n\n当 $N$ 很大时，$T_N$ 的方差，记为 $\\text{Var}(T_N)$，随 $N$ 呈二次方增长。你的任务是推导这个二次增长项系数的精确值。具体来说，计算极限：\n$$\nL = \\lim_{N\\to\\infty} \\frac{\\text{Var}(T_N)}{N^2}\n$$\n你可以使用来自 Basel 问题的已知结果：$\\sum_{k=1}^{\\infty} \\frac{1}{k^2} = \\frac{\\pi^2}{6}$。", "solution": "我们将 $T_N$ 分解为\n$$T_N=\\sum_{k=0}^{N-1}X_k,$$\n其中 $X_k$ 是在已经收集到 $k$ 种不同赠券后，为抽到一种新赠券所需的额外抽取次数。由于每次抽取得到一张新赠券的概率为\n$$p_k=\\frac{N-k}{N},$$\n我们有\n1. \n$$E[X_k]=\\frac{1}{p_k}=\\frac{N}{\\,N-k\\,},$$\n2. \n$$\\text{Var}(X_k)=\\frac{1-p_k}{p_k^2}\n=\\frac{k/N}{((N-k)/N)^2}\n=\\frac{k\\,N}{(N-k)^2}.$$\n因此\n$$\\text{Var}(T_N)\n=\\sum_{k=0}^{N-1}\\text{Var}(X_k)\n=\\sum_{k=0}^{N-1}\\frac{k\\,N}{(N-k)^2}\n=N\\sum_{j=1}^{N}\\frac{N-j}{j^2},$$\n其中我们令 $j=N-k$。由于 $j=N$ 这一项为零，我们可以写成\n$$\\text{Var}(T_N)\n=N\\Bigl(N\\sum_{j=1}^N\\frac{1}{j^2}-\\sum_{j=1}^N\\frac{1}{j}\\Bigr)\n=N^2\\sum_{j=1}^N\\frac{1}{j^2}-N\\,H_N.$$\n两边除以 $N^2$ 并令 $N\\to\\infty$，再利用\n$$\\sum_{j=1}^\\infty\\frac{1}{j^2}=\\frac{\\pi^2}{6},\\qquad\n\\frac{H_N}{N}\\to0,$$\n可得\n$$L=\\lim_{N\\to\\infty}\\frac{\\text{Var}(T_N)}{N^2}\n=\\frac{\\pi^2}{6}.$$", "answer": "$$\\boxed{\\frac{\\pi^2}{6}}$$", "id": "849585"}]}