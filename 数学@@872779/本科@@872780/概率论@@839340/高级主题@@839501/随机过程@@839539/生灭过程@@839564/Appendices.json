{"hands_on_practices": [{"introduction": "生灭过程的一个核心应用是模拟系统在长时间运行后达到的平衡状态。本练习将通过一个在线平台订阅人数的例子，向你展示如何利用细致平衡方程推导出系统的稳态分布。这个练习不仅能帮助你理解稳态的概念，还能让你掌握求解这类问题的一个基本方法 [@problem_id:1389344]。", "problem": "一个新的在线媒体平台正在为其订阅者基础建模。新订阅者以每天 $\\lambda$ 的恒定平均速率加入平台，这与当前订阅者数量无关。单个订阅者可能会取消他们的服务，并且假设取消决策是相互独立的。因此，如果平台上有 $i$ 个订阅者，订阅被取消的总速率是每天 $\\mu i$，其中 $\\mu$ 是一个正常数，表示每个订阅者的取消率。\n\n在平台运行了足够长的时间后，观察到订阅者数量在一个稳定的平均值周围波动，这表明系统已达到稳态。令 $N$ 为此稳态下订阅者数量的随机变量。\n\n对于任何非负整数 $k$，确定平台恰好有 $k$ 个订阅者的概率 $P(N=k)$。用 $\\lambda$、$\\mu$ 和 $k$ 的符号表达式来表示你的答案。", "solution": "我们将订阅者数量建模为非负整数上的一个连续时间生灭过程，其中“生”（新订阅）以与状态无关的恒定速率 $\\lambda$ 发生，“灭”（取消订阅）在状态为 $i$ 时以速率 $\\mu i$ 发生。令 $\\pi_{k}=P(N=k)$ 表示有 $k$ 个订阅者的稳态概率。\n\n在稳态下，对于一个生灭过程，细致平衡方程在相邻状态之间成立。从状态 $k$ 到 $k+1$ 的流率等于从 $k+1$ 到 $k$ 的流率：\n$$\n\\pi_{k}\\lambda=\\pi_{k+1}\\mu(k+1), \\quad k\\geq 0.\n$$\n求解 $\\pi_{k+1}$ 得到递推关系\n$$\n\\pi_{k+1}=\\frac{\\lambda}{\\mu(k+1)}\\pi_{k}.\n$$\n对这个关系进行迭代，对于 $k\\geq 0$ 可得，\n$$\n\\pi_{k}=\\pi_{0}\\prod_{j=0}^{k-1}\\frac{\\lambda}{\\mu(j+1)}=\\pi_{0}\\frac{\\lambda^{k}}{\\mu^{k}k!}=\\pi_{0}\\left(\\frac{\\lambda}{\\mu}\\right)^{k}\\frac{1}{k!}.\n$$\n\n为了确定 $\\pi_{0}$，使用归一化条件 $\\sum_{k=0}^{\\infty}\\pi_{k}=1$：\n$$\n1=\\sum_{k=0}^{\\infty}\\pi_{k}=\\pi_{0}\\sum_{k=0}^{\\infty}\\left(\\frac{\\lambda}{\\mu}\\right)^{k}\\frac{1}{k!}=\\pi_{0}\\exp\\!\\left(\\frac{\\lambda}{\\mu}\\right).\n$$\n因此\n$$\n\\pi_{0}=\\exp\\!\\left(-\\frac{\\lambda}{\\mu}\\right).\n$$\n所以，稳态分布是均值为 $\\lambda/\\mu$ 的泊松分布，对于任何非负整数 $k$，\n$$\nP(N=k)=\\exp\\!\\left(-\\frac{\\lambda}{\\mu}\\right)\\left(\\frac{\\lambda}{\\mu}\\right)^{k}\\frac{1}{k!}.\n$$", "answer": "$$\\boxed{\\exp\\!\\left(-\\frac{\\lambda}{\\mu}\\right)\\left(\\frac{\\lambda}{\\mu}\\right)^{k}\\frac{1}{k!}}$$", "id": "1389344"}, {"introduction": "当一个系统存在吸收态（例如物种灭绝或达到某个上限）时，我们常常关心“过程需要多长时间才能结束？”。这个练习将引导你为一个具有两个吸收边界的生灭过程建立并求解一个线性方程组。通过这个练习，你将学会如何计算从任意状态出发，系统被吸收的平均时间 [@problem_id:697752]。", "problem": "考虑一个定义在有限状态空间 $S = \\{0, 1, 2, \\dots, N\\}$ 上的连续时间马尔可夫链，具体来说是一个生灭过程。状态 $0$ 和 $N$ 是吸收态，意味着一旦过程进入这两个状态中的任意一个，它将永远停留在那里。对于瞬态 $i \\in \\{1, 2, \\dots, N-1\\}$，过程以速率 $\\lambda_i$ 从状态 $i$ 转移到状态 $i+1$（一次“生”），并以速率 $\\mu_i$ 从状态 $i$ 转移到状态 $i-1$（一次“灭”）。\n\n该过程的具体速率由以下公式给出：\n- 生速率：$\\lambda_i = i\\kappa$ 对于 $i \\in \\{1, 2, \\dots, N-1\\}$\n- 灭速率：$\\mu_i = (i+1)\\kappa$ 对于 $i \\in \\{1, 2, \\dots, N-1\\}$\n此处，$\\kappa$ 是一个正常数，其单位为时间的倒数。\n\n设 $T_k$ 为过程从状态 $k \\in \\{1, 2, \\dots, N-1\\}$ 开始，直至被状态 $0$ 或状态 $N$ 吸收的平均时间。平均吸收时间 $T_i$ 满足以下对于 $i \\in \\{1, 2, \\dots, N-1\\}$ 的线性方程组：\n$$\n(\\lambda_i + \\mu_i)T_i = 1 + \\lambda_i T_{i+1} + \\mu_i T_{i-1}\n$$\n边界条件为 $T_0 = 0$ 和 $T_N = 0$。\n\n推导平均吸收时间 $T_k$ 的一个闭式表达式，该表达式是初始状态 $k$ 和状态总数 $N+1$ 的函数。", "solution": "我们从 $1 \\le i \\le N-1$ 的标准生灭过程平均吸收时间方程开始：\n$$\n(\\lambda_i+\\mu_i)T_i=1+\\lambda_iT_{i+1}+\\mu_iT_{i-1},\\quad\nT_0=T_N=0.\n$$\n整理得：\n$$\n\\lambda_i\\bigl(T_{i+1}-T_i\\bigr)\n=\\mu_i\\bigl(T_i-T_{i-1}\\bigr)-1.\n$$\n令 $\\Delta_i=T_i-T_{i-1}$。则\n$$\n\\Delta_{i+1}\n=\\frac{\\mu_i}{\\lambda_i}\\,\\Delta_i-\\frac1{\\lambda_i}\n,\\qquad\n\\frac{\\mu_i}{\\lambda_i}\n=\\frac{(i+1)\\kappa}{i\\kappa}\n=\\frac{i+1}i.\n$$\n因此，当 $\\alpha_i=(i+1)/i$ 且 $\\phi_0=1,\\;\\phi_j=\\prod_{m=1}^j\\alpha_m$ 时，通解为\n$$\n\\Delta_i\n=\\phi_{i-1}\\Bigl[c-\\sum_{m=1}^{\\,i-1}\\frac1{\\phi_m\\,\\lambda_m}\\Bigr].\n$$\n此处 $\\phi_{i-1}=\\prod_{m=1}^{i-1}\\frac{m+1}m=i$ 并且\n$$\n\\sum_{m=1}^{i-1}\\frac1{\\phi_m\\lambda_m}\n=\\sum_{m=1}^{i-1}\\frac1{(m+1)(m\\kappa)}\n=\\frac1\\kappa\\sum_{m=1}^{i-1}\\Bigl(\\frac1m-\\frac1{m+1}\\Bigr)\n=\\frac{i-1}{i\\kappa}.\n$$\n因此\n$$\n\\Delta_i\n=i\\Bigl[c-\\frac{i-1}{i\\kappa}\\Bigr]\n=i\\,c-\\frac{i-1}{\\kappa}.\n$$\n应用条件 $\\sum_{i=1}^N\\Delta_i=T_N-T_0=0$：\n$$\n0=\\sum_{i=1}^N\\Bigl(i\\,c-\\frac{i-1}{\\kappa}\\Bigr)\n=c\\frac{N(N+1)}2-\\frac1\\kappa\\frac{N(N-1)}2\n\\;\\Longrightarrow\\;\nc=\\frac{N-1}{\\kappa(N+1)}.\n$$\n因此\n$$\n\\Delta_i\n=\\frac{i(N-1)}{k(N+1)} - \\frac{i-1}{\\kappa} = \\frac{i(N-1)-(i-1)(N+1)}{\\kappa(N+1)} = \\frac{N-2i+1}{\\kappa(N+1)},\n$$\n$$\nT_k=\\sum_{i=1}^k\\Delta_i\n=\\frac1{\\kappa(N+1)}\\sum_{i=1}^k (N-2i+1)\n=\\frac1{\\kappa(N+1)}\\bigl[k(N+1)-2\\frac{k(k+1)}{2}\\bigr]\n=\\frac{k(N-k)}{\\kappa(N+1)}.\n$$", "answer": "$$\\boxed{\\frac{k(N-k)}{\\kappa(N+1)}}$$", "id": "697752"}, {"introduction": "在了解了系统到达吸收态需要多长时间之后，下一个自然而然的问题是“系统最终会到达哪个吸收态？”。本练习探讨了在具有多个吸收态（如成功与失败）的情况下，如何计算最终被特定边界吸收的概率。通过求解一个具有特定状态依赖转移率的例子，你将掌握计算吸收概率的关键技巧 [@problem_id:697928]。", "problem": "考虑一个在状态集 $S = \\{0, 1, 2, \\ldots, N\\}$ 上的有限状态生灭过程。状态 $0$ 和 $N$ 是吸收壁，意味着一旦过程进入这两个状态中的任何一个，它将无限期地停留在那里。对于任何瞬时状态 $j \\in \\{1, 2, \\ldots, N-1\\}$，转移只可能发生到相邻状态 $j-1$ 和 $j+1$。\n\n转移速率是依赖于状态的。具体来说，对于一个状态 $j \\in \\{1, 2, \\ldots, N-1\\}$：\n- 生率（从 $j$ 到 $j+1$ 的转移）由 $\\lambda_j = \\alpha(2j-1)$ 给出。\n- 死率（从 $j$ 到 $j-1$ 的转移）由 $\\mu_j = \\alpha(2j+1)$ 给出。\n\n此处，$\\alpha$ 是一个代表基础转移速率的正常数。该过程从初始状态 $k \\in \\{1, 2, \\ldots, N-1\\}$ 开始。\n\n在给定过程从状态 $k$ 开始的条件下，推导该过程最终被上边界 $N$ 吸收的概率（我们称之为 $P(k, N)$）的闭式表达式。", "solution": "设 $P(k, N)$ 为从初始状态 $k$ 出发，最终在状态 $N$ 被吸收的概率。对于生灭过程，该概率的标准公式为：\n$$\nP(k, N) = \\frac{\\sum_{j=0}^{k-1} \\gamma_j}{\\sum_{j=0}^{N-1} \\gamma_j}\n$$\n其中边界条件为 $P(0,N)=0$ 和 $P(N,N)=1$，且 $\\gamma_j$ 的定义为 $\\gamma_0=1$ 和 $\\gamma_j = \\prod_{m=1}^{j} \\frac{\\mu_m}{\\lambda_m}$ 对于 $j \\ge 1$。\n\n首先，我们计算比率 $\\frac{\\mu_m}{\\lambda_m}$：\n$$\n\\frac{\\mu_m}{\\lambda_m} = \\frac{\\alpha(2m+1)}{\\alpha(2m-1)} = \\frac{2m+1}{2m-1}\n$$\n接下来，我们计算连乘积 $\\gamma_j$：\n$$\n\\gamma_j = \\prod_{m=1}^{j} \\frac{2m+1}{2m-1} = \\frac{3}{1} \\times \\frac{5}{3} \\times \\frac{7}{5} \\times \\cdots \\times \\frac{2j+1}{2j-1}\n$$\n这是一个伸缩积（telescoping product），结果为：\n$$\n\\gamma_j = 2j+1 \\quad (\\text{对于 } j \\ge 1)\n$$\n现在，我们计算公式中所需的和。分母是：\n$$\n\\sum_{j=0}^{N-1} \\gamma_j = \\gamma_0 + \\sum_{j=1}^{N-1} \\gamma_j = 1 + \\sum_{j=1}^{N-1} (2j+1)\n$$\n该和式可以计算为 $1 + (2 \\frac{(N-1)N}{2} + (N-1)) = 1 + N^2 - N + N - 1 = N^2$。\n同样地，分子是：\n$$\n\\sum_{j=0}^{k-1} \\gamma_j = \\gamma_0 + \\sum_{j=1}^{k-1} \\gamma_j = 1 + \\sum_{j=1}^{k-1} (2j+1) = k^2\n$$\n将分子和分母代入概率公式，我们得到：\n$$\nP(k, N) = \\frac{k^2}{N^2}\n$$\n因此，从状态 $k$ 开始最终被上边界 $N$ 吸收的概率是 $\\frac{k^2}{N^2}$。", "answer": "$$\\boxed{\\frac{k^2}{N^2}}$$", "id": "697928"}]}