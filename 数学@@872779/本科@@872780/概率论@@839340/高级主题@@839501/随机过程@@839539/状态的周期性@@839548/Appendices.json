{"hands_on_practices": [{"introduction": "我们从一个基础练习开始，学习如何通过分析状态转移图来确定一个状态的周期。这个练习的核心在于识别所有从一个状态出发并最终返回自身的可能路径，即“闭环”，并计算这些路径的长度。一个状态的周期正是所有这些“闭环”长度的最大公约数 [@problem_id:1378758]。", "problem": "考虑一个在离散时间步长上演化的系统，该系统可处于四个可能的状态之一，标记为 $S_1, S_2, S_3, S_4$。状态之间的转移遵循齐次马尔可夫链的规则。令 $p_{ij}$ 表示从状态 $S_i$ 到状态 $S_j$ 的一步转移概率。\n\n仅有的非零转移概率如下所示：\n- $p_{12} = \\alpha$\n- $p_{13} = 1-\\alpha$\n- $p_{21} = 1$\n- $p_{31} = 1-\\beta$\n- $p_{34} = \\beta$\n- $p_{43} = 1$\n\n其中 $\\alpha$ 和 $\\beta$ 是常数，满足 $0 < \\alpha < 1$ 和 $0 < \\beta < 1$。所有其他一步转移概率均为零。\n\n求状态 $S_1$ 的周期。", "solution": "在马尔可夫链中，状态 $i$ 的周期定义为 $d(i)=\\gcd\\{n\\ge 1: p_{ii}^{(n)}>0\\}$，其中 $p_{ii}^{(n)}$ 是返回到状态 $i$ 的 $n$ 步返回概率。我们来确定返回到 $S_{1}$ 的时间集合。\n\n首先，存在一条通过 $S_2$ 返回到 $S_1$ 的 2 步路径：$S_{1}\\to S_{2}\\to S_{1}$，其概率为 $\\alpha\\cdot 1>0$，因此 $p_{11}^{(2)}>0$。同样，也存在一条通过 $S_3$ 的 2 步返回路径：$S_{1}\\to S_{3}\\to S_{1}$，其概率为 $(1-\\alpha)(1-\\beta)>0$。\n\n更一般地，从 $S_1$ 出发，走路径 $S_{1}\\to S_{3}$（概率为 $1-\\alpha>0$），然后在 $S_{3}\\to S_{4}\\to S_{3}$ 之间循环 $m\\ge 0$ 次（每次循环长度为 2，发生概率为 $\\beta\\cdot 1$），最后走路径 $S_{3}\\to S_{1}$（概率为 $1-\\beta>0$）。这就构成了一条在 $2m+2$ 步后返回的路径，其概率为 $(1-\\alpha)\\beta^{m}(1-\\beta)>0$。因此，对于所有整数 $m\\ge 0$，都有 $p_{11}^{(2m+2)}>0$，所以每个偶数 $n\\ge 2$ 都是一个返回时间。\n\n不可能存在奇数步的返回时间。事实上，状态空间可以被二分划分为 $\\{S_{1},S_{4}\\}$ 和 $\\{S_{2},S_{3}\\}$：从 $S_1$ 出发，一步之内会转移到 $\\{S_2,S_3\\}$，并且之后的每一步转移都在这两个集合之间交替进行。因此，从 $S_1$ 开始，系统只能在偶数时刻处于 $\\{S_{1},S_{4}\\}$，这使得对于所有奇数 $n$，都有 $p_{11}^{(n)}=0$。\n\n因此，集合 $\\{n\\ge 1: p_{11}^{(n)}>0\\}$ 正是 $\\{2,4,6,\\ldots\\}$，其最大公约数为 2。所以，状态 $S_1$ 的周期是 2。", "answer": "$$\\boxed{2}$$", "id": "1378758"}, {"introduction": "在掌握了单一通信类中周期的计算后，我们来探讨一个更复杂的情形：一个马尔可夫链包含多个独立的循环结构。这个练习将向你展示，周期性是通信类的性质，一个链中的不同循环部分（常返类）可以拥有不同的周期。你需要先识别出链中的暂态和常返态，然后为每个常返类分别计算周期 [@problem_id:1378760]。", "problem": "一个简单的自动机在一组四个内部状态上运行，标记为 $S = \\{0, 1, 2, 3\\}$。该自动机的状态根据概率规则在离散时间步上演化，形成一个马尔可夫链。转移规则定义如下：\n\n- 如果自动机处于状态 0，它将确定地转移到状态 1。\n- 如果自动机处于状态 1，它将确定地转移到状态 0。\n- 如果自动机处于状态 2，它有相等的概率转移到状态 0 或状态 3。\n- 状态 3 是一个吸收态；如果自动机进入状态 3，它将无限期地保持在状态 3。\n\n识别此马尔可夫链的所有常返态。然后，对于这组常返态，确定存在的所有唯一的周期值。将你的答案表示为一个按升序排列的所有唯一周期值的列表。", "solution": "第一步是构建马尔可夫链的转移概率矩阵 $P$，其中 $P_{ij}$ 是从状态 $i$ 转移到状态 $j$ 的概率。状态空间是 $S = \\{0, 1, 2, 3\\}$。\n\n根据问题描述：\n- 对于状态 0：它确定地转移到状态 1。因此，$P_{01} = 1$，且 $P_{00} = P_{02} = P_{03} = 0$。\n- 对于状态 1：它确定地转移到状态 0。因此，$P_{10} = 1$，且 $P_{11} = P_{12} = P_{13} = 0$。\n- 对于状态 2：它以相等的概率转移到状态 0 或 3。因此，$P_{20} = 0.5$，$P_{23} = 0.5$，且 $P_{21} = P_{22} = 0$。\n- 对于状态 3：它是一个吸收态。因此，$P_{33} = 1$，且 $P_{30} = P_{31} = P_{32} = 0$。\n\n得到的转移矩阵 $P$ 是：\n$$\nP = \\begin{pmatrix}\n0  & 1  & 0  & 0 \\\\\n1  & 0  & 0  & 0 \\\\\n0.5  & 0  & 0  & 0.5 \\\\\n0  & 0  & 0  & 1\n\\end{pmatrix}\n$$\n\n接下来，我们识别互通类并将状态分类为常返态或暂留态。\n- 从状态 0，我们可以到达状态 1 ($0 \\to 1$)。\n- 从状态 1，我们可以到达状态 0 ($1 \\to 0$)。\n因此，状态 0 和 1 相互互通 ($0 \\leftrightarrow 1$)。它们形成一个互通类 $C_1 = \\{0, 1\\}$。\n- 从状态 3，我们只能到达状态 3。它自己形成一个互通类 $C_2 = \\{3\\}$。\n- 从状态 2，我们可以到达状态 0（在 $C_1$ 中）和状态 3（在 $C_2$ 中）。然而，从状态 0、1 或 3，不可能返回到状态 2。因此，状态 2 是一个暂留态。\n\n如果一个状态属于一个闭的互通类（即，一旦链进入该类，就永远不会离开），则该状态是常返的。$C_1$ 和 $C_2$ 都是闭类。\n- $C_1=\\{0, 1\\}$ 是闭的，因为从状态 0 和 1 出发的转移只会导致进入 $\\{0, 1\\}$ 内的其他状态。\n- $C_2=\\{3\\}$ 是闭的，因为从状态 3 出发的唯一可能转移是到状态 3。\n因此，常返态的集合是 $\\{0, 1, 3\\}$。\n\n下一步是求每个常返态的周期。一个状态 $i$ 的周期 $d(i)$ 是所有可能返回时间集合的最大公约数 (GCD)：$d(i) = \\gcd\\{n > 0 : P_{ii}^{(n)} > 0\\}$。一个互通类中的所有状态共享相同的周期。\n\n对于类 $C_1 = \\{0, 1\\}$：\n让我们求状态 0 的周期。我们需要找到步数 $n$，使得有可能返回到状态 0，即 $P_{00}^{(n)} > 0$。\n- $P_{00}^{(1)} = 0$。\n- 通过路径 $0 \\to 1 \\to 0$ 可以在两步内返回。让我们用矩阵 $P^2$ 来验证：\n$$ P^2 = P \\cdot P = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0.5 & 0 & 0 & 0.5 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0.5 & 0 & 0 & 0.5 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0.5 & 0 & 0.5 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} $$\n由于 $P_{00}^{(2)} = 1 > 0$，因此可以在 2 步内返回。\n- 让我们检查 $n=3$。$P^3 = P^2 \\cdot P = P$。所以 $P_{00}^{(3)} = P_{00} = 0$。\n- 一般来说，如果 $n$ 是奇数，$P^n = P$；如果 $n$ 是正偶数，$P^n=P^2$。\n因此，$P_{00}^{(n)} > 0$ 仅在 $n$ 为偶数时成立。返回到状态 0 的可能时间集合是 $\\{2, 4, 6, 8, \\dots\\}$。\n状态 0 的周期是 $d(0) = \\gcd\\{2, 4, 6, \\dots\\} = 2$。\n由于状态 1 在同一个类中，其周期也是 $d(1) = 2$。\n\n对于类 $C_2 = \\{3\\}$：\n状态 3 是一个吸收态，所以 $P_{33} = 1$。\n这意味着 $P_{33}^{(1)} = 1 > 0$。任何从 3 开始的路径仅需一步就返回到 3。\n可能的返回时间集合是 $\\{1, 2, 3, \\dots\\}$，因为对于所有 $n \\ge 1$，$P_{33}^{(n)} = 1$。\n状态 3 的周期是 $d(3) = \\gcd\\{1, 2, 3, \\dots\\} = 1$。周期为 1 的状态称为非周期的。\n\n常返态是 $\\{0, 1, 3\\}$，其周期分别为 $d(0)=2$，$d(1)=2$ 和 $d(3)=1$。\n在这些常返态中找到的唯一周期值的集合是 $\\{1, 2\\}$。\n按升序排列，这些值为 1 和 2。", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 2 \\end{pmatrix}}$$", "id": "1378760"}, {"introduction": "最后一个练习将周期性的抽象概念与系统结构的具体特征联系起来，揭示一个深刻的联系：奇数长度循环的存在性。在一个网络或系统中，一个微小的结构变化就可能彻底改变其长期行为。通过这个基于图论的例子，你将看到一个原本具有周期性行为的系统，在增加一条边后如何变为非周期的，这背后的关键就在于奇数环路的形成 [@problem_id:1378717]。", "problem": "一个分布式计算系统由两个名为`North`和`South`的服务器集群组成，每个集群恰好包含四台服务器。设`North`集群中的服务器为 $\\{N_1, N_2, N_3, N_4\\}$，`South`集群中的服务器为 $\\{S_1, S_2, S_3, S_4\\}$。\n\n最初，网络拓扑的设计使得`North`集群中的每台服务器都与`South`集群中的每台服务器有直接的双向连接。同一集群内的服务器之间没有连接。\n\n之后进行了一次网络升级，在`North`集群的服务器$N_1$和$N_2$之间引入了一个新的直接双向连接。\n\n一个诊断数据包在其中一台服务器上启动。在每个离散时间步，该数据包被转发到与其直接相连的一台服务器。下一台服务器的选择是从所有可用邻居集合中以等概率进行的。这个过程可以被建模为一个马尔可夫链，其中状态是这八台服务器。\n\n马尔可夫链中一个状态的周期定义为所有使得在恰好$n$步后有非零概率返回该状态的正整数$n$的集合的最大公约数。\n\n求对应于服务器$N_3$的状态的周期。", "solution": "将数据包转发过程建模为在一个无向图上的简单随机游走，该图的顶点是八台服务器。图的边是所有的 $\\{N_{i},S_{j}\\}$（其中 $i,j\\in\\{1,2,3,4\\}$）以及额外的边 $\\{N_{1},N_{2}\\}$。对于在邻居中等概率选择的相应马尔可夫链，在$n$步后返回状态$x$的概率严格为正，当且仅当存在一条从$x$开始并在$x$结束的长度为$n$的闭路。状态$x$的周期是\n$$\nd(x)=\\gcd\\{\\,n\\geq 1: P^{n}(x,x)>0\\,\\}.\n$$\n\n考虑$x=N_{3}$。首先，存在一条长度为$2$的闭路：选择任意一个$S_{j}$，则有 $N_{3}\\to S_{j}\\to N_{3}$。每一步都沿着一条存在的边，并且沿着每条边的转移概率都是一个正数（具体来说，是 $\\frac{1}{\\deg(N_{3})}$ 接着是 $\\frac{1}{\\deg(S_{j})}$），所以\n$$\nP^{2}(N_{3},N_{3})\\geq \\frac{1}{\\deg(N_{3})}\\cdot\\frac{1}{\\deg(S_{j})}>0.\n$$\n\n其次，添加的边 $\\{N_{1},N_{2}\\}$ 使得从$N_{3}$出发存在一条奇数长度的闭路。例如，\n$$\nN_{3}\\to S_{1}\\to N_{1}\\to N_{2}\\to S_{2}\\to N_{3},\n$$\n其长度为$5$。所有这些边都存在，所以这条$5$步路径的概率是\n$$\n\\frac{1}{\\deg(N_{3})}\\cdot\\frac{1}{\\deg(S_{1})}\\cdot\\frac{1}{\\deg(N_{1})}\\cdot\\frac{1}{\\deg(N_{2})}\\cdot\\frac{1}{\\deg(S_{2})}>0,\n$$\n这意味着\n$$\nP^{5}(N_{3},N_{3})>0.\n$$\n\n因此，集合 $\\{n\\geq 1: P^{n}(N_{3},N_{3})>0\\}$ 同时包含$2$和$5$，因而\n$$\nd(N_{3})=\\gcd\\{n\\geq 1: P^{n}(N_{3},N_{3})>0\\}=\\gcd(2,5)=1.\n$$\n由于链是不可约的（所有服务器都在同一个连通图中），所有状态都具有相同的周期。因此状态$N_{3}$的周期是$1$。", "answer": "$$\\boxed{1}$$", "id": "1378717"}]}