{"hands_on_practices": [{"introduction": "理解遍历定理的第一步是掌握其在简单、有限系统中的应用。这个练习通过一个直观的棋盘游戏模型，向我们展示了如何计算马尔可夫链的稳态分布。通过求解这个分布，我们可以预测系统在长时间运行后，处于每个特定状态的平均时间比例，这是分析随机系统长期行为的核心技能。[@problem_id:1360494]", "problem": "一个小自动机在一个轨道上的三个方格（从左到右标记为1、2、3）之间移动一个棋子。棋子的位置在离散的时间步长上根据一组固定的概率规则进行更新。这个过程可以建模为一个马尔可夫链，其中状态是棋子所占据方格的标签。\n\n棋子移动的规则如下：\n- 如果棋子在方格1上，它在下一步总是移动到方格2。\n- 如果棋子在方格2上，它在下一步将以 $1/2$ 的概率移动到方格1，或以 $1/2$ 的概率移动到方格3。\n- 如果棋子在方格3上，它在下一步将以 $1/3$ 的概率移动到方格2，或以 $2/3$ 的概率停留在方格3上。\n\n假设自动机运行很长时间，棋子停留在方格2上的长期时间比例是多少？请用最简分数表示你的答案。", "solution": "将棋子的位置建模为一个状态标记为 $1,2,3$ 的有限马尔可夫链。转移矩阵 $P$（行索引为当前状态，列索引为下一状态）为\n$$\nP=\\begin{pmatrix}\n0 & 1 & 0 \\\\\n\\frac{1}{2} & 0 & \\frac{1}{2} \\\\\n0 & \\frac{1}{3} & \\frac{2}{3}\n\\end{pmatrix}.\n$$\n该链是不可约的（每个状态都可以到达其他状态）和非周期的（状态 $3$ 有一个自环），因此它有一个唯一的平稳分布 $\\pi=(\\pi_{1},\\pi_{2},\\pi_{3})$，满足 $\\pi=\\pi P$ 和 $\\pi_{1}+\\pi_{2}+\\pi_{3}=1$。将 $\\pi=\\pi P$ 按分量写出，得到\n$$\n\\pi_{1}=\\frac{1}{2}\\pi_{2},\\qquad\n\\pi_{2}=\\pi_{1}+\\frac{1}{3}\\pi_{3},\\qquad\n\\pi_{3}=\\frac{1}{2}\\pi_{2}+\\frac{2}{3}\\pi_{3}.\n$$\n从第一个方程可知，$\\pi_{1}=\\frac{1}{2}\\pi_{2}$。从第三个方程可知，\n$$\n\\pi_{3}-\\frac{2}{3}\\pi_{3}=\\frac{1}{2}\\pi_{2}\\;\\;\\Longrightarrow\\;\\;\\frac{1}{3}\\pi_{3}=\\frac{1}{2}\\pi_{2}\\;\\;\\Longrightarrow\\;\\;\\pi_{3}=\\frac{3}{2}\\pi_{2}.\n$$\n施加归一化条件：\n$$\n\\pi_{1}+\\pi_{2}+\\pi_{3}=\\frac{1}{2}\\pi_{2}+\\pi_{2}+\\frac{3}{2}\\pi_{2}=3\\pi_{2}=1,\n$$\n所以 $\\pi_{2}=\\frac{1}{3}$。这就是棋子停留在方格 $2$ 上的长期时间比例。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1360494"}, {"introduction": "稳态分布不仅能告诉我们系统长期的状态比例，还能揭示其回归特性。这个洗牌模型练习将我们的理解推向更深层次，它引入了期望返回时间的概念。我们将发现一个优美而强大的结论：系统首次返回初始状态的平均时间，恰好是该状态稳态概率的倒数，这巧妙地将长期平均占用率与两次访问之间的平均时间间隔联系起来。[@problem_id:1360475]", "problem": "我们研究一个简化的洗牌过程模型，使用一副包含四张不同卡牌的小牌堆，这些卡牌初始时处于有序状态。单次“洗牌”操作包括将牌堆顶部的牌取出，并将其重新插入到四个可能的位置之一（即，放回顶部、插入到第一张和第二张牌之间、插入到第二张和第三张牌之间，或放在牌堆底部）。这四个位置中的每一个都以相等的概率被选择。\n\n此过程重复进行，每次洗牌都与之前的洗牌相互独立。我们关心的是牌堆需要多长时间才能返回其初始的有序状态。\n\n计算使牌堆首次返回其初始有序状态所需的期望洗牌次数。初始状态被视为第0步，因此第一次可能的返回是在第1步。请以精确整数形式给出答案。", "solution": "令状态空间为四张不同卡牌的所有排列的集合；因此共有 $4!=24$ 个状态。\n\n一次洗牌定义如下：从状态 $s=(x_{1},x_{2},x_{3},x_{4})$ 出发，均匀地选择一个 $j\\in\\{1,2,3,4\\}$，然后将 $x_{1}$ 移动到四个位置中的第 $j$ 个位置。将得到的状态记为 $T_{j}(s)$。转移概率为\n$$\nP(s,t)=\\begin{cases}\n\\frac{1}{4},  \\text{if } t=T_{j}(s) \\text{ for some } j\\in\\{1,2,3,4\\},\\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n\n我们证明转移矩阵是双随机的。固定任意一个目标状态 $t=(t_{1},t_{2},t_{3},t_{4})$。对于每个 $j\\in\\{1,2,3,4\\}$，定义一个唯一的前驱状态\n$$\ns_{j}(t)=(t_{j},\\,t_{1},\\,\\ldots,\\,t_{j-1},\\,t_{j+1},\\,\\ldots,\\,t_{4}).\n$$\n那么有 $T_{j}(s_{j}(t))=t$。由于顶部的牌不同，因此对于不同的 $j$，这些 $s_{j}(t)$ 是互不相同的。因此，到达状态 $t$ 的总入概率为\n$$\n\\sum_{s}P(s,t)=\\sum_{j=1}^{4}\\frac{1}{4}=1,\n$$\n所以每一列的和都等于 $1$。由于根据构造，每一行的和都为 $1$，因此该转移矩阵是双随机的。\n\n由此可知，这 $24$ 个状态上的均匀分布 $\\mu$（即对所有状态 $s$ 都有 $\\mu(s)=\\frac{1}{24}$）是平稳的。\n\n该链是非周期的，因为 $P(s,s)=\\frac{1}{4}>0$（选择 $j=1$ 会使状态保持不变）。它也是不可约的（从任何一个排列出发，通过重复的顶部插入操作可以实现任何其他排列）。因此，该链是正常返的且遍历的。\n\n根据标准的返回时间恒等式（马尔可夫链的Kac引理），从状态 $s$ 出发，首次返回到状态 $s$ 的期望时间（即在时刻 $0$ 之后的首次返回期望时间），等于其平稳概率的倒数：\n$$\n\\mathbb{E}_{s}[T_{s}^{+}]=\\frac{1}{\\mu(s)}.\n$$\n由于对每个状态都有 $\\mu(s)=\\frac{1}{24}$，我们得到\n$$\n\\mathbb{E}_{s}[T_{s}^{+}]=24.\n$$\n\n因此，使牌堆首次返回其初始有序状态所需的期望洗牌次数为 $24$。", "answer": "$$\\boxed{24}$$", "id": "1360475"}, {"introduction": "许多现实世界系统拥有无限个可能的状态，将遍历性的概念从有限空间推广到无限空间至关重要。这个随机游走问题就是一个绝佳的例子，它展示了遍历定理在无限状态马尔可夫链中的应用。通过这个练习，我们将学会如何计算一个物理量（如粒子位置的平方）的长期时间平均值，这表明遍历定理不仅限于计算概率，还能用于分析系统关键性能指标的平均行为。[@problem_id:1360530]", "problem": "一个粒子在整数集 $\\mathbb{Z}$ 上进行随机游走。系统在时间 $n$ 的状态由粒子的位置 $X_n \\in \\mathbb{Z}$ 给出。粒子的运动受一个依赖于状态的偏置控制，该偏置总是将其拉向原点。\n\n转移概率定义如下：\n- 如果粒子在原点（$i=0$），它将以概率 $1/2$ 跳到 $i+1$ 或以概率 $1/2$ 跳到 $i-1$。\n- 如果粒子在任何非零整数状态 $i \\neq 0$，它向原点移动一步的概率是 $\\frac{1+c}{2}$，而远离原点移动一步的概率是 $\\frac{1-c}{2}$。常数 $c$ 是一个满足 $0 < c < 1$ 的参数。\n\n该马尔可夫链是遍历的，拥有唯一的平稳分布 $\\pi_i = \\lim_{n \\to \\infty} P(X_n = i)$。根据遍历定理，粒子位置的任何函数的长期时间平均值收敛于该函数相对于平稳分布的期望值。\n\n确定粒子位置平方的长期平均值，$\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=1}^{N} X_n^2$。请用参数 $c$ 的闭式解析表达式表示你的答案。", "solution": "根据遍历定理，长期时间平均值等于平稳期望，因此\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=1}^{N} X_{n}^{2}=\\sum_{i \\in \\mathbb{Z}} i^{2} \\pi_{i}.\n$$\n我们通过最近邻边上的细致平衡来找到平稳分布 $\\pi_{i}$。该链是对称的，所以 $\\pi_{-i}=\\pi_{i}$。对于 $i \\geq 0$，状态 $i$ 和 $i+1$ 之间的边满足\n- $P_{0,1}=\\frac{1}{2}$ 且 $P_{1,0}=\\frac{1+c}{2}$，\n- 对于 $i \\geq 1$，$P_{i,i+1}=\\frac{1-c}{2}$ 且 $P_{i+1,i}=\\frac{1+c}{2}$。\n\n施加 $\\pi_{i} P_{i,i+1}=\\pi_{i+1} P_{i+1,i}$ 得到比率\n$$\n\\frac{\\pi_{1}}{\\pi_{0}}=\\frac{P_{0,1}}{P_{1,0}}=\\frac{1}{1+c}, \\qquad \\frac{\\pi_{i+1}}{\\pi_{i}}=\\frac{P_{i,i+1}}{P_{i+1,i}}=\\frac{1-c}{1+c} \\quad (i \\geq 1).\n$$\n定义 $q=\\frac{1-c}{1+c}$。那么对于 $i \\geq 1$，\n$$\n\\pi_{i}=\\pi_{0}\\,\\frac{1}{1+c}\\,q^{\\,i-1}, \\qquad \\pi_{-i}=\\pi_{i}.\n$$\n进行归一化以求得 $\\pi_{0}$。使用 $\\sum_{i \\in \\mathbb{Z}} \\pi_{i}=1$，\n$$\n1=\\pi_{0}+2 \\sum_{i=1}^{\\infty} \\pi_{i}=\\pi_{0}+2\\,\\pi_{0}\\,\\frac{1}{1+c}\\sum_{n=0}^{\\infty} q^{\\,n}.\n$$\n由于 $|q|<1$，$\\sum_{n=0}^{\\infty} q^{\\,n}=\\frac{1}{1-q}$，并且\n$$\n1=\\pi_{0}+2\\,\\pi_{0}\\,\\frac{1}{1+c}\\,\\frac{1}{1-q}.\n$$\n现在 $1-q=1-\\frac{1-c}{1+c}=\\frac{2c}{1+c}$，因此\n$$\n1=\\pi_{0}+2\\,\\pi_{0}\\,\\frac{1}{1+c}\\,\\frac{1+c}{2c}=\\pi_{0}+\\frac{\\pi_{0}}{c} \\quad \\Rightarrow \\quad \\pi_{0}=\\frac{c}{1+c}.\n$$\n因此，对于 $i \\geq 1$，\n$$\n\\pi_{i}=\\frac{c}{(1+c)^{2}}\\,q^{\\,i-1}, \\qquad \\pi_{-i}=\\pi_{i}, \\qquad q=\\frac{1-c}{1+c}.\n$$\n计算平稳二阶矩：\n$$\n\\sum_{i \\in \\mathbb{Z}} i^{2} \\pi_{i}=2 \\sum_{i=1}^{\\infty} i^{2} \\pi_{i}=2 \\frac{c}{(1+c)^{2}} \\sum_{i=1}^{\\infty} i^{2} q^{\\,i-1}.\n$$\n为了计算 $\\sum_{i=1}^{\\infty} i^{2} q^{\\,i-1}$，我们从 $|r|<1$ 时的 $S_{0}(r)=\\sum_{i=0}^{\\infty} r^{i}=\\frac{1}{1-r}$ 开始。求导得到\n$$\n\\sum_{i=1}^{\\infty} i r^{\\,i-1}=\\frac{1}{(1-r)^{2}}, \\quad \\sum_{i=1}^{\\infty} i r^{\\,i}=\\frac{r}{(1-r)^{2}}.\n$$\n对 $\\sum_{i=1}^{\\infty} i r^{\\,i}=\\frac{r}{(1-r)^{2}}$ 求导以获得\n$$\n\\sum_{i=1}^{\\infty} i^{2} r^{\\,i-1}=\\frac{1+r}{(1-r)^{3}}.\n$$\n因此\n$$\n\\sum_{i=1}^{\\infty} i^{2} q^{\\,i-1}=\\frac{1+q}{(1-q)^{3}}.\n$$\n代入 $q=\\frac{1-c}{1+c}$：\n$$\n1+q=\\frac{2}{1+c}, \\qquad 1-q=\\frac{2c}{1+c}, \\qquad \\frac{1+q}{(1-q)^{3}}=\\frac{\\frac{2}{1+c}}{\\left(\\frac{2c}{1+c}\\right)^{3}}=\\frac{(1+c)^{2}}{4 c^{3}}.\n$$\n所以，\n$$\n\\sum_{i \\in \\mathbb{Z}} i^{2} \\pi_{i}=2 \\frac{c}{(1+c)^{2}} \\cdot \\frac{(1+c)^{2}}{4 c^{3}}=\\frac{1}{2 c^{2}}.\n$$\n根据遍历性，长期时间平均值等于此期望，所以\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=1}^{N} X_{n}^{2}=\\frac{1}{2 c^{2}}.\n$$", "answer": "$$\\boxed{\\frac{1}{2 c^{2}}}$$", "id": "1360530"}]}