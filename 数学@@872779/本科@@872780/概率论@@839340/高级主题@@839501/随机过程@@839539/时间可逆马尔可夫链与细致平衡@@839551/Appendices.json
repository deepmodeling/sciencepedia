{"hands_on_practices": [{"introduction": "细致平衡条件不仅仅是一个理论上的概念，它更是分析平衡态系统的实用工具。在我们的第一个练习中，我们将直接应用时间可逆性的核心方程。你将利用给定的平稳分布和已知的转移速率，来计算一个蛋白质折叠模型中的未知转移概率，从而体会细致平衡是如何约束一个可逆马尔可夫链的动态过程的。", "problem": "一个蛋白质的简化模型使用三个不同状态来描述其构象：状态1、状态2和状态3。该蛋白质在离散时间步长下在这些状态之间转换，遵循离散时间马尔可夫链的动力学。\n\n经过很长一段时间后，系统达到统计平衡，此时发现蛋白质处于每种状态的概率是恒定的。这个平稳分布由向量 $\\pi = (\\pi_1, \\pi_2, \\pi_3)$ 给出，其中 $\\pi_1 = 1/2$，$\\pi_2 = 1/4$，且 $\\pi_3 = 1/4$。\n\n已知其潜在的物理过程是时间可逆的，这意味着马尔可夫链相对于其平稳分布 $\\pi$ 满足细致平衡条件。\n\n此链的转移矩阵 $P$ 中，从状态1转换到状态2的概率为 $P_{12} = 1/3$。从状态3转换到状态2的概率为 $P_{32} = 1/5$。\n\n基于这些信息，蛋白质在状态2保持一个时间步长的概率是多少，即 $P_{22}$ 的值是多少？\n\nA. $1/15$\n\nB. $2/15$\n\nC. $1/5$\n\nD. $4/15$\n\nE. $7/15$\n\nF. $8/15$", "solution": "该链是时间可逆的，其平稳分布为 $\\pi=(\\pi_{1},\\pi_{2},\\pi_{3})$，其中 $\\pi_{1}=\\frac{1}{2}$，$\\pi_{2}=\\frac{1}{4}$，且 $\\pi_{3}=\\frac{1}{4}$。时间可逆性意味着细致平衡条件\n$$\n\\pi_{i}P_{ij}=\\pi_{j}P_{ji}\\quad \\text{对所有 }i,j.\n$$\n使用给定的 $P_{12}=\\frac{1}{3}$，对状态1和状态2应用细致平衡：\n$$\n\\pi_{1}P_{12}=\\pi_{2}P_{21}\\;\\Rightarrow\\;\\frac{1}{2}\\cdot \\frac{1}{3}=\\frac{1}{4}P_{21}\\;\\Rightarrow\\;P_{21}=\\frac{\\frac{1}{6}}{\\frac{1}{4}}=\\frac{2}{3}.\n$$\n使用给定的 $P_{32}=\\frac{1}{5}$，对状态3和状态2应用细致平衡：\n$$\n\\pi_{3}P_{32}=\\pi_{2}P_{23}\\;\\Rightarrow\\;\\frac{1}{4}\\cdot \\frac{1}{5}=\\frac{1}{4}P_{23}\\;\\Rightarrow\\;P_{23}=\\frac{\\frac{1}{20}}{\\frac{1}{4}}=\\frac{1}{5}.\n$$\n由于 $P$ 的每一行之和为 $1$，对于第2行我们有\n$$\nP_{21}+P_{22}+P_{23}=1.\n$$\n代入 $P_{21}=\\frac{2}{3}$ 和 $P_{23}=\\frac{1}{5}$ 可得\n$$\nP_{22}=1-\\frac{2}{3}-\\frac{1}{5}=\\frac{15}{15}-\\frac{10}{15}-\\frac{3}{15}=\\frac{2}{15}.\n$$\n这对应于选项B。", "answer": "$$\\boxed{B}$$", "id": "1407749"}, {"introduction": "在学会如何使用细致平衡方程后，我们现在来探讨一个系统满足这些条件意味着什么。这个问题提出了一个可能带有方向偏好的随机游走模型。你的任务是找出使这种偏好消失、从而使过程变为时间可逆的精确条件，这将为我们将可逆性理解为系统中没有“净概率流”的平衡状态提供清晰的直觉。", "problem": "一个粒子被限制在三个不同的位置之间移动，这三个位置标记为1、2和3，排列成一个环。粒子的位置在离散的时间步长上被观察。在每一步，如果粒子位于位置 $i \\in \\{1, 2, 3\\}$，它将以概率 $\\alpha$ 跳转到位置 $(i \\pmod 3) + 1$，或以概率 $1-\\alpha$ 跳转到位置 $((i-2) \\pmod 3) + 1$。参数 $\\alpha$ 是一个常数，满足 $0 < \\alpha < 1$。\n\n经过很长一段时间后，假设系统达到一个稳态，其特征是稳态概率分布 $(\\pi_1, \\pi_2, \\pi_3)$，其中 $\\pi_i$ 是在位置 $i$ 找到粒子的概率。如果对于这个稳态分布，从任何位置 $i$ 到任何位置 $j$ 的转移速率等于从位置 $j$ 回到位置 $i$ 的转移速率，则该过程被定义为时间可逆的。\n\n确定使这个随机游走过程时间可逆的 $\\alpha$ 的具体数值。", "solution": "设马尔可夫链的状态空间为 $S = \\{1, 2, 3\\}$。问题描述了转移概率。我们用 $P_{ij}$ 表示从状态 $i$ 到状态 $j$ 的转移概率。问题陈述给出：\n- 从位置 $i$ 到位置 $(i \\pmod 3) + 1$：这对应于移动 $1 \\to 2$、$2 \\to 3$ 和 $3 \\to 1$。概率为 $\\alpha$。\n- 从位置 $i$ 到位置 $((i-2) \\pmod 3) + 1$：这对应于移动 $1 \\to 3$、$2 \\to 1$ 和 $3 \\to 2$。概率为 $1-\\alpha$。\n\n状态 $(1, 2, 3)$ 的转移矩阵 $P$ 为：\n$$\nP = \\begin{pmatrix}\n0 & \\alpha & 1-\\alpha \\\\\n1-\\alpha & 0 & \\alpha \\\\\n\\alpha & 1-\\alpha & 0\n\\end{pmatrix}\n$$\n\n首先，我们必须找到稳态分布 $\\pi = (\\pi_1, \\pi_2, \\pi_3)$，它满足方程 $\\pi P = \\pi$ 和归一化条件 $\\sum_{i=1}^{3} \\pi_i = 1$。方程 $\\pi P = \\pi$ 导出了以下线性方程组：\n1. $\\pi_1 = (1-\\alpha)\\pi_2 + \\alpha\\pi_3$\n2. $\\pi_2 = \\alpha\\pi_1 + (1-\\alpha)\\pi_3$\n3. $\\pi_3 = (1-\\alpha)\\pi_1 + \\alpha\\pi_2$\n\n由于问题的循环对称性（从任何位置跳转的规则在结构上是相同的），我们可以假设稳态分布是均匀的，即 $\\pi_1 = \\pi_2 = \\pi_3$。\n使用归一化条件 $\\pi_1 + \\pi_2 + \\pi_3 = 1$，我们得到 $3\\pi_1 = 1$，这意味着 $\\pi_1 = \\pi_2 = \\pi_3 = 1/3$。\n\n让我们验证对于任何 $\\alpha \\in (0,1)$，$\\pi = (1/3, 1/3, 1/3)$ 是否满足该方程组：\n对于方程1：\n$$ (1-\\alpha)\\frac{1}{3} + \\alpha\\frac{1}{3} = \\frac{1-\\alpha+\\alpha}{3} = \\frac{1}{3} = \\pi_1 $$\n这成立。根据对称性，其他两个方程也成立。因此，此马尔可夫链的稳态分布是 $\\pi = (1/3, 1/3, 1/3)$，与 $\\alpha$ 的值无关。\n\n现在，我们应用时间可逆性的条件。问题将其陈述为“从任何位置 $i$ 到任何位置 $j$ 的转移速率等于从位置 $j$ 回到位置 $i$ 的转移速率”。从 $i$ 到 $j$ 的转移速率是在状态 $i$ 的概率（$\\pi_i$）乘以从 $i$ 转移到 $j$ 的概率（$P_{ij}$）。所以，时间可逆性的条件是细致平衡条件：\n$$ \\pi_i P_{ij} = \\pi_j P_{ji} \\quad \\text{对于所有 } i, j \\in S $$\n\n我们只需要对具有非零转移概率的状态对检查此条件。\n让我们检查状态对 (1, 2)：\n$$ \\pi_1 P_{12} = \\pi_2 P_{21} $$\n代入已知值：\n$$ \\frac{1}{3} \\cdot \\alpha = \\frac{1}{3} \\cdot (1-\\alpha) $$\n$$ \\alpha = 1 - \\alpha $$\n$$ 2\\alpha = 1 $$\n$$ \\alpha = \\frac{1}{2} $$\n\n让我们检查状态对 (2, 3)：\n$$ \\pi_2 P_{23} = \\pi_3 P_{32} $$\n代入已知值：\n$$ \\frac{1}{3} \\cdot \\alpha = \\frac{1}{3} \\cdot (1-\\alpha) $$\n$$ \\alpha = 1 - \\alpha $$\n$$ \\alpha = \\frac{1}{2} $$\n\n最后，让我们检查状态对 (3, 1)：\n$$ \\pi_3 P_{31} = \\pi_1 P_{13} $$\n代入已知值：\n$$ \\frac{1}{3} \\cdot \\alpha = \\frac{1}{3} \\cdot (1-\\alpha) $$\n$$ \\alpha = 1 - \\alpha $$\n$$ \\alpha = \\frac{1}{2} $$\n\n当且仅当 $\\alpha = 1/2$ 时，所有状态对都满足细致平衡条件。对于任何其他 $\\alpha$ 值，该链不是时间可逆的。例如，如果 $\\alpha > 1/2$，则在 $1 \\to 2 \\to 3 \\to 1$ 方向上存在净概率流。\n\n因此，使过程时间可逆的 $\\alpha$ 的具体值为 $1/2$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1407763"}, {"introduction": "我们最后的练习将探讨一个系统的底层结构如何能够保证其可逆性。我们将基于一个简单循环图上的对称随机游走，构建一个马尔可夫链。通过检验其性质，你将发现一个关键的洞见：系统中的物理对称性常常导致转移矩阵的对称性，而这又确保了相对于均匀平稳分布的时间可逆性。", "problem": "考虑一个系统，其状态可由三个可能值 $\\{0, 1, 2\\}$ 中的一个来描述。该系统以离散时间步进行演化。这种演化被建模为一个马尔可夫链，该链源于在整数集 $\\mathbb{Z}$ 上的一个简单对称随机游走。\n\n设在时间步 $n$ 时，粒子在整数线上的位置为 $Y_n \\in \\mathbb{Z}$。在每个时间步，粒子从其当前位置 $i$ 移动到 $i+1$ 或 $i-1$，每次移动的概率均为 $1/2$。因此，$P(Y_{n+1} = i+1 | Y_n = i) = 1/2$ 且 $P(Y_{n+1} = i-1 | Y_n = i) = 1/2$。\n\n我们所关心的系统状态 $X_n$ 定义为粒子的位置模3。也就是说，$X_n = Y_n \\pmod 3$。马尔可夫链 $\\{X_n\\}$ 的状态空间是 $S = \\{0, 1, 2\\}$。\n\n基于此定义，以下哪个陈述正确地描述了该马尔可夫链？\n\nA. 该链是可逆的。\n\nB. 该链是不可逆的。\n\nC. 该链是周期的。\n\nD. 该链不是不可约的。", "solution": "我们在状态空间 $S=\\{0,1,2\\}$ 上通过 $X_{n}=Y_{n} \\bmod 3$ 来定义马尔可夫链 $\\{X_{n}\\}$，其中 $\\{Y_{n}\\}$ 是在 $\\mathbb{Z}$ 上的简单对称随机游走，其增量为 $\\pm 1$，概率各为 $\\frac{1}{2}$。因此，从任何状态 $i \\in \\{0,1,2\\}$ 出发，该链以概率 $\\frac{1}{2}$ 移动到 $i+1 \\pmod 3$，并以概率 $\\frac{1}{2}$ 移动到 $i-1 \\pmod 3$。\n\n将状态排序为 $(0,1,2)$，转移矩阵为\n$$\nP=\\begin{pmatrix}\n0 & \\frac{1}{2} & \\frac{1}{2} \\\\\n\\frac{1}{2} & 0 & \\frac{1}{2} \\\\\n\\frac{1}{2} & \\frac{1}{2} & 0\n\\end{pmatrix}.\n$$\n\n不可约性：如果对于任意 $i,j \\in S$，存在 $n \\in \\mathbb{N}$ 使得 $(P^{n})_{ij}>0$，则马尔可夫链是不可约的。在此，对于所有不同的 $i,j$，我们有 $P_{ij}=\\frac{1}{2}>0$，因此每个状态都可以在一步之内到达其他任何状态。因此，该链是不可约的，所以陈述D是错误的。\n\n周期性：状态 $i$ 的周期定义为 $\\gcd\\{n \\geq 1 : (P^{n})_{ii}>0\\}$。我们计算返回概率：\n- 在两步中，从状态 $i$ 出发，可以移动到一个相邻状态再返回，所以\n$$\n(P^{2})_{ii}=\\sum_{k \\in S} P_{ik}P_{ki}=P_{i,i+1}P_{i+1,i}+P_{i,i-1}P_{i-1,i}=\\frac{1}{2}\\cdot\\frac{1}{2}+\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{2}>0.\n$$\n- 在三步中，从状态 $i$ 出发，可以移动 $+1,+1,+1$ 或 $-1,-1,-1$ 模 $3$ 并返回到 $i$，所以 $(P^{3})_{ii}>0$。\n因此，$2$ 和 $3$ 都属于集合 $\\{n:(P^{n})_{ii}>0\\}$，周期为 $\\gcd(2,3)=1$。该链是非周期的，所以陈述C是错误的。\n\n可逆性：如果对于所有 $i,j$，都有 $\\pi_{i}P_{ij}=\\pi_{j}P_{ji}$，则一个链关于分布 $\\pi$ 是可逆的。考虑均匀分布 $\\pi=(\\frac{1}{3},\\frac{1}{3},\\frac{1}{3})$。对于 $P_{ij}>0$ 且 $i \\neq j$ 的情况，我们有\n$$\n\\pi_{i}P_{ij}=\\frac{1}{3}\\cdot\\frac{1}{2}=\\frac{1}{6}=\\frac{1}{3}\\cdot\\frac{1}{2}=\\pi_{j}P_{ji},\n$$\n而对于 $i=j$ 的情况，由于 $P_{ii}=0$，等式两边都为零。因此细致平衡条件成立，所以该链是可逆的。因此陈述A是正确的，而陈述B是错误的。\n\n综合以上分析，正确选项是A。", "answer": "$$\\boxed{A}$$", "id": "1407782"}]}