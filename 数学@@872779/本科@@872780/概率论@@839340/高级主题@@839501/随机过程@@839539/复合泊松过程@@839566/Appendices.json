{"hands_on_practices": [{"introduction": "复合泊松过程的理论学习，最终要落实到具体的计算和分析上。第一个练习将引导我们完成一项基本功：计算复合泊松过程的均值和方差。通过一个亚原子粒子随机运动的直观模型 [@problem_id:1317627]，我们将学会运用全期望定律和全方差定律，来量化过程的长期趋势和波动性，这是分析所有复合泊松模型的基石。", "problem": "一个亚原子粒子在一维空间中运动。其运动的特点是由碰撞引起的一系列瞬时位移。在长度为 $t$ 的时间间隔内，碰撞次数（记为 $N(t)$）服从一个速率为 $\\lambda$ 的泊松过程。每次碰撞引起一次位移 $Y_i$，其中 $i=1, 2, \\dots$。位移 $\\{Y_i\\}$ 是独立同分布的随机变量，并且它们也独立于过程 $N(t)$。\n\n每次位移 $Y_i$ 的分布如下：\n- 位移为 $+\\delta$ 的概率为 $p$。\n- 位移为 $-2\\delta$ 的概率为 $q$。\n- 位移为 $0$ 的概率为 $1-p-q$。\n\n此处，$\\delta$ 是一个代表基本长度尺度的正常数，$p$ 和 $q$ 是概率。令 $X(t) = \\sum_{i=1}^{N(t)} Y_i$ 为时间 $t$ 后粒子的净位移。如果没有碰撞发生，位移为零。\n\n求时间 $t$ 后粒子净位移的均值 $E[X(t)]$ 和方差 $\\text{Var}(X(t))$。最终答案应为一对表达式，一个表示均值，一个表示方差，用 $\\lambda, t, \\delta, p,$ 和 $q$ 表示。", "solution": "设 $N(t)$ 服从参数为 $\\lambda t$ 的泊松分布，且独立于独立同分布的位移 $\\{Y_{i}\\}$。定义 $X(t)=\\sum_{i=1}^{N(t)} Y_{i}$，并约定当 $N(t)=0$ 时 $X(t)=0$。\n\n首先计算单次位移 $Y$ 的一阶矩和二阶矩。根据给定的分布，\n$$\nE[Y]=\\delta \\cdot p+(-2\\delta)\\cdot q+0\\cdot(1-p-q)=\\delta(p-2q),\n$$\n以及\n$$\nE[Y^{2}]=\\delta^{2}\\cdot p+(-2\\delta)^{2}\\cdot q+0^2\\cdot(1-p-q)=\\delta^{2}(p+4q).\n$$\n\n以 $N(t)=n$ 为条件，我们得到 $n$ 个独立同分布项的和，因此\n$$\nE[X(t) \\mid N(t)=n]=n\\,E[Y]=n\\,\\delta(p-2q),\n$$\n以及\n$$\n\\text{Var}(X(t) \\mid N(t)=n)=n\\,\\text{Var}(Y)=n\\,(E[Y^{2}]-(E[Y])^{2}).\n$$\n\n使用全期望定律，并且对于 $N(t)\\sim\\text{Poisson}(\\lambda t)$ 有 $E[N(t)]=\\lambda t$，我们得到\n$$\nE[X(t)]=E\\big[E[X(t) \\mid N(t)]\\big]=E[N(t)]\\,E[Y]=\\lambda t\\,\\delta(p-2q).\n$$\n\n使用全方差定律，\n$$\n\\text{Var}(X(t))=E\\big[\\text{Var}(X(t) \\mid N(t))\\big]+\\text{Var}\\big(E[X(t) \\mid N(t)]\\big).\n$$\n代入条件矩，并注意到 $\\text{Var}(N(t))=\\lambda t$，可得\n$$\n\\text{Var}(X(t))=E[N(t)]\\,\\text{Var}(Y)+\\text{Var}(N(t))\\,(E[Y])^{2}\n=\\lambda t\\big(\\text{Var}(Y)+(E[Y])^{2}\\big)=\\lambda t\\,E[Y^{2}].\n$$\n根据上面得到的 $E[Y^{2}]=\\delta^{2}(p+4q)$，我们得出结论\n$$\n\\text{Var}(X(t))=\\lambda t\\,\\delta^{2}(p+4q).\n$$\n\n因此，均值和方差为\n$$\nE[X(t)]=\\lambda t\\,\\delta(p-2q),\\qquad \\text{Var}(X(t))=\\lambda t\\,\\delta^{2}(p+4q).\n$$", "answer": "$$\\boxed{\\lambda t \\delta(p-2q), \\quad \\lambda t \\delta^2(p+4q)}$$", "id": "1317627"}, {"introduction": "掌握了正向计算均值和方差的技能后，我们来挑战一个“逆向工程”问题。在许多实际应用中，我们往往只能观测到系统的宏观整体行为（如总体的均值 $E[X(t)]$ 和方差 $\\text{Var}(X(t))$），而无法直接测量每一次独立事件的细节。这个练习 [@problem_id:715429] 将展示如何利用复合泊松过程的均值和方差公式，从已知的宏观数据反推出底层单个“跳跃”的统计特性，这在统计建模和参数推断中是一项非常实用的技能。", "problem": "一个随机过程 $X(t)$ 表示一系列事件随时间累积的效应，被建模为一个复合泊松过程：\n$$\nX(t) = \\sum_{i=1}^{N(t)} Y_i\n$$\n在此模型中，$N(t)$ 是一个具有恒定速率 $\\lambda > 0$ 的齐次泊松过程，它计算截至时间 $t$ 发生的事件数量。项 $\\{Y_i\\}_{i=1,2,...}$ 是独立同分布 (i.i.d.) 的随机变量，表示每个事件的大小，或称“跳跃幅度”。跳跃幅度也与计数过程 $N(t)$ 相互独立。假设期望跳跃幅度为非负，即 $E[Y] \\ge 0$。\n\n聚合过程 $X(t)$ 的均值和方差已被确定，并且是时间的线性函数：\n1.  $E[X(t)] = At$\n2.  $\\text{Var}(X(t)) = Bt$\n\n这里，$A$ 和 $B$ 是已知的正常数。\n\n此外，所建模系统的一个特定特征对事件速率及其期望幅度施加了一个关系。该关系由下式给出：\n3.  $\\lambda = k E[Y]$\n\n其中 $k$ 是一个已知的正常数比例常数。\n\n利用这些信息，推导跳跃幅度分布的方差 $\\text{Var}(Y)$ 关于常数 $A$、$B$ 和 $k$ 的闭式表达式。", "solution": "1. 对于速率为 $\\lambda$、跳跃分布为 $Y$（均值为 $\\mu=E[Y]$，方差为 $\\sigma^2=\\text{Var}(Y)$）的复合泊松过程，\n   $$E[N(t)]=\\lambda t,\\quad \\text{Var}(N(t))=\\lambda t.$$\n2. $X(t)=\\sum_{i=1}^{N(t)}Y_i$ 的均值为\n   $$E[X(t)]=E[N(t)]\\,\\mu=\\lambda t\\,\\mu=At\\quad\\Longrightarrow\\quad A=\\lambda\\mu.$$\n3. $X(t)$ 的方差为\n   $$\\text{Var}(X(t))=E[N(t)]\\,\\sigma^2+\\text{Var}(N(t))\\,\\mu^2=\\lambda t\\,\\sigma^2+\\lambda t\\,\\mu^2\n      =\\lambda(\\sigma^2+\\mu^2)\\,t=Bt\\quad\\Longrightarrow\\quad B=\\lambda(\\sigma^2+\\mu^2).$$\n4. 给定约束条件\n   $$\\lambda=k\\,E[Y]=k\\,\\mu,$$\n   由 $A=\\lambda\\mu$ 我们得到\n   $$A=k\\,\\mu^2\\quad\\Longrightarrow\\quad \\mu^2=\\frac{A}{k}.$$\n5. 由 $B=\\lambda(\\sigma^2+\\mu^2)=k\\,\\mu\\;(\\sigma^2+\\mu^2)$ 我们有\n   $$\\frac{B}{k\\,\\mu}=\\sigma^2+\\mu^2\n      \\quad\\Longrightarrow\\quad\n      \\sigma^2=\\frac{B}{k\\,\\mu}-\\mu^2.$$\n6. 代入 $\\mu=\\sqrt{A/k}$：\n   $$\\text{Var}(Y)=\\sigma^2\n      =\\frac{B}{k\\sqrt{A/k}}-\\frac{A}{k}\n      =\\frac{B}{\\sqrt{kA}}-\\frac{A}{k}.$$", "answer": "$$\\boxed{\\frac{B}{\\sqrt{kA}}-\\frac{A}{k}}$$", "id": "715429"}, {"introduction": "均值和方差为我们提供了过程的宏观概览，但并未揭示其全貌。最后的这个练习将带领我们进行一次更深层次的探索：推导在给定时刻过程所处状态的完整概率分布。通过分析一个被建模为复合泊松过程的对称随机游走，我们将学习如何通过对事件次数进行条件化，从而精确地推导出其概率质量函数 [@problem_id:715395]。这个过程将揭示出随机过程与特殊数学函数之间令人惊叹的联系，充分展现了这类模型背后丰富的数学结构。", "problem": "一维对称随机游走可以被建模为一个复合泊松过程。考虑一个随机过程 $X(t)$，定义如下：\n$$\nX(t) = \\sum_{i=1}^{N(t)} Y_i\n$$\n其中：\n1.  $N(t)$ 是一个速率为 $\\lambda > 0$ 的泊松过程，表示在时间区间 $[0, t]$ 内发生的“跳跃”次数。在该区间内发生 $n$ 次跳跃的概率由 $P(N(t)=n) = \\frac{(\\lambda t)^n e^{-\\lambda t}}{n!}$ 给出，其中 $n=0, 1, 2, \\dots$。\n2.  $\\{Y_i\\}_{i \\ge 1}$ 是一个独立同分布的随机变量序列，表示每次跳跃的大小。每次跳跃是一个对称的 Rademacher 随机变量，意味着它以相等的概率取值 $+1$ 或 $-1$：$P(Y_i = 1) = P(Y_i = -1) = 1/2$。\n3.  跳跃大小过程 $\\{Y_i\\}$ 与跳跃计数过程 $N(t)$ 相互独立。\n\n过程 $X(t)$ 表示一个粒子在时间 $t$ 的位置，从 $X(0)=0$ 开始。对于一个固定的时间 $t > 0$，推导对任意整数 $k \\in \\mathbb{Z}$ 的概率质量函数（PMF）$p_k(t) = P(X(t)=k)$。\n\n你的最终表达式应为一个封闭形式，其中可能包含第一类修正贝塞尔函数 $I_\\nu(z)$，其由级数展开定义：\n$$\nI_\\nu(z) = \\sum_{m=0}^\\infty \\frac{1}{m! \\Gamma(m+\\nu+1)} \\left(\\frac{z}{2}\\right)^{2m+\\nu}\n$$\n对于整数 $\\nu$，这可以简化为 $I_\\nu(z) = \\sum_{m=0}^\\infty \\frac{1}{m! (m+\\nu)!} \\left(\\frac{z}{2}\\right)^{2m+\\nu}$。", "solution": "我们要求解 $p_k(t)=P(X(t)=k)$。由于 $X(t)=\\sum_{i=1}^{N(t)}Y_i$，以 $N(t)=n$ 为条件，\n$$\np_k(t)=\\sum_{n=0}^\\infty P(N(t)=n)\\,P\\Bigl(\\sum_{i=1}^nY_i=k\\Bigr).\n$$\n1.  泊松定律给出\n$$\nP(N(t)=n)=e^{-\\lambda t}\\frac{(\\lambda t)^n}{n!}.\n$$\n2.  $n$ 个对称 Rademacher 变量的和有\n$$\nP\\Bigl(\\sum_{i=1}^nY_i=k\\Bigr)=\n\\begin{cases}\n\\displaystyle \\binom{n}{\\frac{n+k}2}\\,2^{-n},  n \\equiv k \\pmod 2,\\;|k|\\le n,\\\\\n0,  \\text{其他情况}.\n\\end{cases}\n$$\n3.  因此\n$$\np_k(t)\n=e^{-\\lambda t}\n\\sum_{\\substack{n\\ge|k| \\\\ n \\equiv k \\pmod 2}}\n\\frac{(\\lambda t)^n}{n!}\\,\n\\binom{n}{\\frac{n+k}2}2^{-n}.\n$$\n4.  设 $n=2m+|k|$，$m\\ge0$。那么\n$$\n\\binom{2m+|k|}{m+\\frac{k+|k|}2}\n=\\binom{2m+|k|}{m+|k|}\n=\\frac{(2m+|k|)!}{m!\\,(m+|k|)!},\n$$\n并且\n$$\np_k(t)\n=e^{-\\lambda t}\n\\sum_{m=0}^\\infty\n\\frac{(\\lambda t)^{2m+|k|}}{(2m+|k|)!}\n\\frac{(2m+|k|)!}{m!\\,(m+|k|)!}\\,\n2^{-(2m+|k|)}.\n$$\n5.  简化以识别出修正贝塞尔函数：\n$$\np_k(t)\n=e^{-\\lambda t}\n\\sum_{m=0}^\\infty\n\\frac{1}{m!\\,(m+|k|)!}\n\\Bigl(\\frac{\\lambda t}{2}\\Bigr)^{2m+|k|}\n=e^{-\\lambda t}I_{|k|}(\\lambda t).\n$$", "answer": "$$\\boxed{e^{-\\lambda t}I_{|k|}(\\lambda t)}$$", "id": "715395"}]}