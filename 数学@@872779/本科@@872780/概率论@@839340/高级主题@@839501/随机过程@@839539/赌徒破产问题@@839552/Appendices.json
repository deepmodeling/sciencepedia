{"hands_on_practices": [{"introduction": "我们从赌徒破产问题的最核心问题开始：在财富达到目标之前，输光所有钱的概率是多少？这个练习将引导你建立并求解一个基本的线性递推关系，这是分析这类随机过程的基础。通过解决这个问题[@problem_id:7867]，你将掌握利用单步分析法来确定破产概率的核心技能。", "problem": "一位名叫 Alice 的赌徒正在玩一个序贯机会游戏。她以 $i$ 美元的初始财富开始，其中 $i$ 是一个整数。她的目标是达到 $N$ 美元的总财富，其中 $N  i$。如果她的财富降至 $0$ 美元，她就输光了，必须停止游戏。\n\n在每一轮游戏中，她下注一美元。她以恒定的概率 $p$ 赢得该轮（财富增加 1 美元），并以概率 $q = 1-p$ 输掉该轮（财富减少 1 美元）。游戏使用的是一枚不公平的硬币，这意味着 $p \\neq q$。\n\n设 $P_k$ 为在当前拥有 $k$ 美元的情况下，Alice 最终输光（即她的财富达到 $0$）的概率。你的任务是找出给定初始财富时输光的概率 $P_i$。\n\n推导输光概率 $P_i$ 的封闭形式表达式，用她的初始财富 $i$、目标财富 $N$ 以及概率 $p$ 和 $q$ 来表示。", "solution": "设 $P_k$ 为在起始财富为 $k$ 的情况下，赌徒的财富在达到 $N$ 之前达到 $0$ 的概率。我们要求的是 $P_i$。可能的财富范围是整数集合 $\\{0, 1, 2, ..., N\\}$。\n\n首先，我们建立问题的边界条件。\n如果起始财富为 $k=0$，赌徒已经输光了。因此，输光的概率为 $1$。\n$$\nP_0 = 1\n$$\n如果起始财富为 $k=N$，赌徒已达到其目标，游戏结束。从这个状态输光的概率为 $0$。\n$$\nP_N = 0\n$$\n\n对于任何满足 $0  k  N$ 的中间财富 $k$，我们可以通过对下一轮结果进行条件分析来建立 $P_k$ 的递推关系。\n- 以概率 $p$，赌徒赢得下一轮，她的财富变为 $k+1$。从这个新状态输光的概率是 $P_{k+1}$。\n- 以概率 $q$，她输掉下一轮，她的财富变为 $k-1$。从这个新状态输光的概率是 $P_{k-1}$。\n\n根据全概率定律，$P_k$ 是这两个结果的加权平均值：\n$$\nP_k = p P_{k+1} + q P_{k-1}\n$$\n由于 $p+q=1$，我们可以将 $P_k$ 重写为 $(p+q)P_k = pP_k + qP_k$。将此代入关系式中：\n$$\np P_k + q P_k = p P_{k+1} + q P_{k-1}\n$$\n重新整理各项，我们将 $p$ 和 $q$ 分组：\n$$\nq (P_k - P_{k-1}) = p (P_{k+1} - P_k)\n$$\n我们定义连续状态之间的概率差为 $\\Delta_k = P_k - P_{k-1}$。方程变为：\n$$\nq \\Delta_k = p \\Delta_{k+1}\n$$\n这得出了关于差分的一个简单关系：\n$$\n\\Delta_{k+1} = \\frac{q}{p} \\Delta_k\n$$\n这表明差分 $\\Delta_k$ 构成一个公比为 $r = q/p$ 的等比数列。我们可以用第一个差分 $\\Delta_1 = P_1 - P_0$ 来表示任何差分 $\\Delta_k$：\n$$\n\\Delta_k = \\left(\\frac{q}{p}\\right)^{k-1} \\Delta_1\n$$\n现在，我们可以通过从 $P_0$ 开始对这些差分求和来表示 $P_k$：\n$$\nP_k = P_0 + \\sum_{j=1}^{k} (P_j - P_{j-1}) = P_0 + \\sum_{j=1}^{k} \\Delta_j\n$$\n代入 $\\Delta_j$ 的表达式：\n$$\nP_k = P_0 + \\sum_{j=1}^{k} \\left(\\frac{q}{p}\\right)^{j-1} \\Delta_1 = P_0 + \\Delta_1 \\sum_{j=0}^{k-1} \\left(\\frac{q}{p}\\right)^j\n$$\n这个和是一个有限等比级数。由于题目说明 $p \\neq q$，公比 $r=q/p \\neq 1$。等比级数的和为 $\\sum_{j=0}^{n} r^j = \\frac{1-r^{n+1}}{1-r}$。应用此公式：\n$$\nP_k = P_0 + \\Delta_1 \\left( \\frac{1 - (q/p)^k}{1 - q/p} \\right)\n$$\n我们有两个未知数，$P_0$ 和 $\\Delta_1$。我们使用边界条件来求解它们。我们已经知道 $P_0=1$。我们也可以将 $\\Delta_1$ 表示为 $P_1-P_0 = P_1 - 1$。\n所以，$\\Delta_1$ 是一个我们需要确定的未知常数。让我们使用另一个边界条件，$P_N=0$：\n$$\n0 = P_N = P_0 + \\Delta_1 \\left( \\frac{1 - (q/p)^N}{1 - q/p} \\right)\n$$\n代入 $P_0=1$：\n$$\n0 = 1 + \\Delta_1 \\left( \\frac{1 - (q/p)^N}{1 - q/p} \\right)\n$$\n求解 $\\Delta_1$：\n$$\n\\Delta_1 = - \\frac{1 - q/p}{1 - (q/p)^N}\n$$\n现在我们将 $\\Delta_1$ 的这个表达式代回我们关于 $P_k$ 的方程中：\n$$\nP_k = P_0 + \\left( - \\frac{1 - q/p}{1 - (q/p)^N} \\right) \\left( \\frac{1 - (q/p)^k}{1 - q/p} \\right)\n$$\n再次使用 $P_0=1$ 并通过消去 $(1-q/p)$ 项来简化：\n$$\nP_k = 1 - \\frac{1 - (q/p)^k}{1 - (q/p)^N}\n$$\n为了得到一个单一的分数项，我们通分：\n$$\nP_k = \\frac{(1 - (q/p)^N) - (1 - (q/p)^k)}{1 - (q/p)^N} = \\frac{1 - (q/p)^N - 1 + (q/p)^k}{1 - (q/p)^N}\n$$\n这简化为从财富 $k$ 开始的输光概率的通解：\n$$\nP_k = \\frac{(q/p)^k - (q/p)^N}{1 - (q/p)^N}\n$$\n问题要求的是从初始财富 $i$ 开始的输光概率。我们只需在通解中令 $k=i$。\n$$\nP_i = \\frac{(q/p)^i - (q/p)^N}{1 - (q/p)^N}\n$$\n这就是输光概率的最终表达式。", "answer": "$$\n\\boxed{\\frac{\\left(\\frac{q}{p}\\right)^i - \\left(\\frac{q}{p}\\right)^N}{1 - \\left(\\frac{q}{p}\\right)^N}}\n$$", "id": "7867"}, {"introduction": "在经典的赌徒破产模型上，我们增加一个更贴近现实的元素：平局。如果每一轮游戏都有可能不分胜负，这对赌徒最终破产的概率有何影响？这个练习[@problem_id:7893]促使你调整递推关系，并探索平局概率如何影响最终结果，从而更深刻地理解决定赌局走向的关键因素。", "problem": "考虑一个经典赌徒破产问题的变体。一个赌徒以 $i$ 单位的初始资本开始，其中 $i$ 是一个满足 $0  i  N$ 的整数。赌徒与一个拥有 $N-i$ 初始资本的对手进行一系列回合的博弈。游戏中的总资本固定为 $N$ 单位。\n\n在每一回合中，赌徒下注一个单位。一个回合的可能结果如下：\n- 赌徒以概率 $p$ 赢得该回合。其资本增加一个单位。\n- 赌徒以概率 $q$ 输掉该回合。其资本减少一个单位。\n- 该回合以概率 $r$ 为平局。赌徒的资本保持不变。\n\n每一回合的概率都是恒定的，且有 $p, q, r  0$ 和 $p+q+r=1$。当赌徒的资本达到 0（称为“破产”事件）或 $N$（称为“胜利”事件）时，游戏结束。\n\n设 $P_i$ 为在初始资本为 $i$ 的条件下，赌徒最终破产的概率。假设赢得一回合的概率不等于输掉一回合的概率，即 $p \\neq q$。\n\n请用初始资本 $i$、总资本 $N$ 以及概率 $p$ 和 $q$ 来推导破产概率 $P_i$ 的通用表达式。", "solution": "我们用 $P_i$ 表示从资本 $i$ 开始最终破产的概率。由于每一回合赢的概率为 $p$，输的概率为 $q$，平局的概率为 $r$，且 $p+q+r=1$，因此对于 $1 \\le i \\le N-1$，一步递推关系为\n$$P_i = p P_{i+1} + q P_{i-1} + r P_i$$\n整理并使用 $1-r=p+q$，得到齐次差分方程\n$$(1-r)P_i = p P_{i+1} + q P_{i-1} \\implies (p+q) P_i = p P_{i+1} + q P_{i-1}$$\n将其写为标准形式：\n$$p P_{i+1} - (p+q)P_i + q P_{i-1} = 0$$\n其特征方程为\n$$p\\lambda^2-(p+q)\\lambda+q=0$$\n其解为\n$$\\lambda_1=1,\\qquad \\lambda_2=\\frac{q}{p}\\quad(p \\neq q)$$\n因此，通解为\n$$P_i=A+B\\left(\\frac{q}{p}\\right)^i$$\n应用边界条件 $P_0=1$ 和 $P_N=0$ 可得\n$$A+B=1,\\qquad A+B\\left(\\frac{q}{p}\\right)^N=0$$\n解出 $A, B$ 可得\n$$B=\\frac{1}{1-(q/p)^N},\\quad A=-\\frac{(q/p)^N}{1-(q/p)^N}$$\n因此，破产概率为\n$$\nP_i\n=\\frac{(q/p)^i - (q/p)^N}{1 - (q/p)^N}\n$$", "answer": "$$\\boxed{\\frac{\\bigl(\\frac{q}{p}\\bigr)^i - \\bigl(\\frac{q}{p}\\bigr)^N}{1 - \\bigl(\\frac{q}{p}\\bigr)^N}}$$", "id": "7893"}, {"introduction": "现在，让我们考虑一个更复杂且动态的场景：如果获胜的概率不是固定的，而是随着赌徒财富的变化而改变，情况会怎样？这种位置依赖的概率模型在金融、物理学和生物学中更为常见。通过解决这个具有挑战性的问题[@problem_id:1398174]，你将学习如何处理变系数的递推关系，并接触到解决更广泛随机游走问题的强大技巧。", "problem": "一个粒子在整数集合 $\\{0, 1, 2, \\dots, N\\}$ 上进行一维随机游走，其中 $N$ 是一个大于1的正整数。位置 $0$ 和 $N$ 是吸收壁。当粒子位于任何满足 $0  i  N$ 的整数位置 $i$ 时，在下一个离散时间步，它将以概率 $p_i$ 移动到位置 $i+1$，或以概率 $q_i = 1-p_i$ 移动到位置 $i-1$。移动的概率与位置相关。具体来说，从任何状态 $i$ 出发，向左移动（位置减小）的概率与向右移动（位置增加）的概率之比由下式给出：\n$$\n\\frac{q_i}{p_i} = \\frac{i}{i+1}\n$$\n假设粒子从初始位置 $k$ 开始，其中 $k$ 是一个满足 $0  k  N$ 的整数。求粒子在被吸收壁 $0$ 吸收之前，先在吸收壁 $N$ 被吸收的概率。\n\n你的最终答案应该是一个用 $k$、$N$ 和调和数函数 $H_n$ 表示的解析表达式，调和数函数定义为前 $n$ 个正整数的倒数之和：$H_n = \\sum_{j=1}^{n} \\frac{1}{j}$。", "solution": "设 $h_{i}$ 表示粒子从位置 $i$ 开始，在被 $0$ 吸收之前先在 $N$ 被吸收的概率。\n\n根据定义，我们有边界条件：\n- $h_0 = 0$ (从位置0开始，已经不可能在0之前到达N)\n- $h_N = 1$ (从位置N开始，已经到达N)\n\n对于任何中间位置 $i$ ($0  i  N$)，我们可以通过考虑下一步的移动来建立一个递推关系：\n$$ h_i = p_i h_{i+1} + q_i h_{i-1} $$\n将 $h_i$ 写为 $(p_i + q_i)h_i$，我们得到：\n$$ p_i h_i + q_i h_i = p_i h_{i+1} + q_i h_{i-1} $$\n重新整理，得到：\n$$ p_i(h_{i+1} - h_i) = q_i(h_i - h_{i-1}) $$\n这给出了相邻概率差之间的关系：\n$$ h_{i+1} - h_i = \\frac{q_i}{p_i} (h_i - h_{i-1}) $$\n根据题设，我们有 $\\frac{q_i}{p_i} = \\frac{i}{i+1}$。代入上式：\n$$ h_{i+1} - h_i = \\frac{i}{i+1} (h_i - h_{i-1}) $$\n让我们定义差分 $\\Delta_i = h_i - h_{i-1}$。那么递推关系变为 $\\Delta_{i+1} = \\frac{i}{i+1} \\Delta_i$。\n我们可以展开这个关系来寻找一个模式：\n- $\\Delta_2 = \\frac{1}{2}\\Delta_1$\n- $\\Delta_3 = \\frac{2}{3}\\Delta_2 = \\frac{2}{3} \\cdot \\frac{1}{2}\\Delta_1 = \\frac{1}{3}\\Delta_1$\n- $\\Delta_4 = \\frac{3}{4}\\Delta_3 = \\frac{3}{4} \\cdot \\frac{1}{3}\\Delta_1 = \\frac{1}{4}\\Delta_1$\n\n通过归纳法，我们可以得出 $\\Delta_i = \\frac{1}{i}\\Delta_1$ 对于所有 $i \\ge 1$ 成立。\n\n现在，我们可以通过对这些差分求和来表示 $h_k$：\n$$ h_k = h_0 + \\sum_{i=1}^k (h_i - h_{i-1}) = h_0 + \\sum_{i=1}^k \\Delta_i $$\n使用边界条件 $h_0=0$ 和 $\\Delta_i = \\frac{1}{i}\\Delta_1$：\n$$ h_k = 0 + \\sum_{i=1}^k \\frac{1}{i}\\Delta_1 = \\Delta_1 \\sum_{j=1}^k \\frac{1}{j} $$\n根据调和数的定义 $H_k = \\sum_{j=1}^{k} \\frac{1}{j}$，我们得到：\n$$ h_k = \\Delta_1 H_k $$\n这个表达式中还有一个未知常数 $\\Delta_1 = h_1 - h_0 = h_1$。为了求解它，我们使用另一个边界条件 $h_N=1$：\n$$ 1 = h_N = \\Delta_1 H_N $$\n解出 $\\Delta_1$：\n$$ \\Delta_1 = \\frac{1}{H_N} $$\n最后，将 $\\Delta_1$ 的值代回 $h_k$ 的表达式中，我们得到最终的概率：\n$$ h_k = \\frac{H_k}{H_N} $$\n这就是从初始位置 $k$ 开始，在被 $0$ 吸收之前先在 $N$ 被吸收的概率。", "answer": "$$\\boxed{\\frac{H_{k}}{H_{N}}}$$", "id": "1398174"}]}