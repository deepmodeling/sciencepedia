## 引言
简单[随机游走](@entry_id:142620)是概率论中最基础也最核心的模型之一，它通过模拟一个[质点](@entry_id:186768)在直线上的随机跳跃，为理解自然界和人类社会中广泛存在的累积随机效应提供了强有力的理论框架。尽管其规则看似简单，但其背后蕴含的数学结构却异常丰富，并引申出深刻的理论问题。本文旨在系统性地梳理整数上一维简单[随机游走](@entry_id:142620)的核心知识体系，填补从基本概念到高等应用的认知鸿沟。

在接下来的内容中，读者将踏上一段从基础到前沿的探索之旅。我们将首先在“原理与机制”一章中，深入剖析[随机游走](@entry_id:142620)的数学定义、关键统计性质（如[期望与方差](@entry_id:199481)）、长期行为（如常返性）以及分析它的高等工具（如鞅论）。随后，在“应用与跨学科联系”一章中，我们将展示这一模型如何作为一把钥匙，解锁物理学、金融学和计算机科学等多个领域的复杂问题。最后，“动手实践”部分将提供一系列精心设计的问题，帮助读者巩固所学，将理论知识转化为解决实际问题的能力。让我们从构建这一迷人[随机过程](@entry_id:159502)的基础开始。

## 原理与机制

本章旨在系统性地阐述整数上一维简单[随机游走](@entry_id:142620)的核心原理与机制。在前一章介绍其基本背景之后，我们将深入探讨该过程的数学构造、关键统计性质、[时间演化](@entry_id:153943)特征以及其[长期行为](@entry_id:192358)。此外，我们还将介绍一些分析[随机游走](@entry_id:142620)的高等工具，如鞅论和[生成函数](@entry_id:146702)，它们为理解这一基础[随机过程](@entry_id:159502)提供了强有力的视角。

### 定义简单[随机游走](@entry_id:142620)

在数学上，一维简单[随机游走](@entry_id:142620)是一个离散时间的[随机过程](@entry_id:159502)，通常用来模拟一个质点在一条直线上进行的随机跳跃。设[质点](@entry_id:186768)在时间 $n$ 的位置为 $S_n$，其中 $n=0, 1, 2, \dots$。游走从一个初始位置 $S_0$ 开始，通常我们设 $S_0=0$ 即原点。

在每个时间步，[质点](@entry_id:186768)移动一个单位长度。具体来说，其位置的更新遵循以下规则：
$S_n = S_{n-1} + X_n, \quad \text{对于 } n \ge 1$
其中，$X_n$ 是一个[随机变量](@entry_id:195330)，代表第 $n$ 步的位移。在简单[随机游走模型](@entry_id:180803)中，所有步长 $X_1, X_2, \dots$ 都是**独立同分布 (i.i.d.)** 的[随机变量](@entry_id:195330)。每一跳只有两种可能：向右移动一个单位 (+1) 或向左移动一个单位 (-1)。我们用参数 $p$ 表示向右移动的概率：
$P(X_n = +1) = p$
$P(X_n = -1) = 1-p = q$
其中 $0 \lt p \lt 1$。因此，[质点](@entry_id:186768)在 $n$ 时刻的位置可以表示为从初始位置开始的所有独立位移的总和：
$S_n = S_0 + \sum_{i=1}^{n} X_i$

根据概率 $p$ 的取值，[随机游走](@entry_id:142620)可以分为两类：
- **[对称随机游走](@entry_id:273558) (Symmetric Random Walk)**：当 $p = 1/2$ 时，向左和向右移动的概率相等。这种游走没有固有的方向偏好。
- **非[对称随机游走](@entry_id:273558) (Asymmetric Random Walk)**：当 $p \neq 1/2$ 时，游走具有一个倾向于向某个方向移动的“漂移”。

[随机游走](@entry_id:142620)的一个核心特性是其**马尔可夫性 (Markov Property)**，即未来的状态只依赖于当前状态，而与如何到达当前状态的路径无关。这是由每一步的独立性直接决定的。

### 游走位置的基本性质

#### 奇偶性

[随机游走](@entry_id:142620)的位置与其所走的步数之间存在一个简单的确定性关系，即**奇偶性**。设游走从 $S_0 = 0$ 开始。在 $n$ 步之后，假设有 $R$ 步向右，则必然有 $n-R$ 步向左。此时的位置为：
$S_n = (+1) \cdot R + (-1) \cdot (n-R) = 2R - n$

从这个表达式中我们可以观察到，$2R$ 永远是一个偶数。因此，$S_n$ 的奇偶性完全由步数 $n$ 的奇偶性决定。
- 如果 $n$ 是偶数，则 $S_n$ 必然是偶数。
- 如果 $n$ 是奇数，则 $S_n$ 必然是奇数。

这意味着，一个从原点出发的[随机游走](@entry_id:142620)，经过奇数步后，其位置不可能是偶数。例如，我们可以确定，在奇数 $n$ 步之后，[质点](@entry_id:186768)位于一个偶数位置的概率绝对为零（[@problem_id:1406136]）。这个看似简单的性质在分析游走路径时至关重要，因为它将可能的[状态空间](@entry_id:177074)在每一步都限制了一半。

#### [概率质量函数](@entry_id:265484)

为了进行更定量的分析，我们需要计算质点在 $n$ 步后到达特定位置 $k$ 的概率，即 $P(S_n=k)$。同样，我们设游走从 $S_0=0$ 开始，向右的步数为 $r$，向左的步数为 $l$。为了在 $n$ 步后到达位置 $k$，必须满足以下两个条件：
$r + l = n \quad （\text{总步数}）$
$r - l = k \quad （\text{最终位置}）$

解这个[方程组](@entry_id:193238)，我们得到：
$r = \frac{n+k}{2}, \quad l = \frac{n-k}{2}$

由于 $r$ 和 $l$ 必须是非负整数，这再次证实了 $n$ 和 $k$ 必须具有相同的奇偶性（这样 $n+k$ 和 $n-k$ 才能是偶数）。如果这个条件满足，那么任何一个包含 $r$ 次向右和 $l$ 次向左的特定路径序列发生的概率都是 $p^r q^l$。总共有 $\binom{n}{r}$ 种这样的路径序列。因此，[概率质量函数](@entry_id:265484)为：
$P(S_n = k) = \binom{n}{\frac{n+k}{2}} p^{\frac{n+k}{2}} (1-p)^{\frac{n-k}{2}}$

这个公式本质上是一个[二项分布](@entry_id:141181)。利用这个公式，我们可以探索非对称性（即 $p \neq 1/2$）如何影响游走的对称性。例如，我们可以计算到达位置 $k$ 与到达位置 $-k$ 的概率之比（[@problem_id:1331736]）：
$\frac{P(S_n=k)}{P(S_n=-k)} = \frac{\binom{n}{(n+k)/2} p^{(n+k)/2} q^{(n-k)/2}}{\binom{n}{(n-k)/2} p^{(n-k)/2} q^{(n+k)/2}}$

由于 $\binom{n}{r} = \binom{n}{n-r}$，我们有 $\binom{n}{(n+k)/2} = \binom{n}{(n-k)/2}$。因此，组合系数项可以消掉，比率简化为：
$\frac{P(S_n=k)}{P(S_n=-k)} = \frac{p^{(n+k)/2} q^{(n-k)/2}}{p^{(n-k)/2} q^{(n+k)/2}} = p^k q^{-k} = \left(\frac{p}{q}\right)^k = \left(\frac{p}{1-p}\right)^k$

这个结果清晰地表明：
- 对于对称游走 ($p=1/2$)，比值为 $1^k=1$，意味着到达 $k$ 和 $-k$ 的概率相同，[分布](@entry_id:182848)是对称的。
- 对于非对称游走 ($p > 1/2$)，比值大于 1，意味着游走更倾向于到达正位置。反之亦然。

### [统计矩](@entry_id:268545)：[期望与方差](@entry_id:199481)

期望和[方差](@entry_id:200758)是描述一个[随机变量分布](@entry_id:196350)的两个最重要的统计量，它们分别刻画了[分布](@entry_id:182848)的中心趋势和离散程度。

#### 期望位置

利用**[期望的线性](@entry_id:273513)性**，计算 $S_n$ 的期望变得异常简单。由于 $S_n = \sum_{i=1}^n X_i$，我们有：
$E[S_n] = E\left[\sum_{i=1}^n X_i\right] = \sum_{i=1}^n E[X_i]$

因为所有步长 $X_i$ 是同[分布](@entry_id:182848)的，所以 $E[X_i] = E[X_1]$。单步位移的期望为：
$E[X_1] = (+1) \cdot p + (-1) \cdot (1-p) = 2p - 1$

这个值 $E[X_1]$ 被称为**漂移（drift）**。因此，经过 $n$ 步后的期望位置是：
$E[S_n] = n \cdot E[X_1] = n(2p-1)$

这个结论非常普适。即使每一步的位移不是 $\pm 1$，只要它们是[独立同分布](@entry_id:169067)的，这个原理依然成立。例如，假设一个质点每步以 $p=0.55$ 的概率向右移动 2 个单位，以 $1-p=0.45$ 的概率向左移动 1 个单位。那么单步的期望位移是 $E[X_1] = 2 \cdot (0.55) + (-1) \cdot (0.45) = 1.1 - 0.45 = 0.65$。经过 20 步后，期望位置就是 $E[S_{20}] = 20 \times 0.65 = 13$（[@problem_id:1331766]）。

对于[对称随机游走](@entry_id:273558)（$p=1/2$），漂移为 $2(1/2)-1=0$，因此 $E[S_n]=0$。这意味着尽管[质点](@entry_id:186768)在游走，但它的平均位置始终保持在原点。

#### 位置的[方差](@entry_id:200758)

[方差](@entry_id:200758)衡量了质点位置的不确定性或波动范围。由于各步 $X_i$ 是相互独立的，一个和的[方差](@entry_id:200758)等于各项[方差](@entry_id:200758)的和：
$\text{Var}(S_n) = \text{Var}\left(\sum_{i=1}^n X_i\right) = \sum_{i=1}^n \text{Var}(X_i) = n \cdot \text{Var}(X_1)$

为了计算单步位移的[方差](@entry_id:200758) $\text{Var}(X_1)$，我们使用公式 $\text{Var}(X_1) = E[X_1^2] - (E[X_1])^2$。首先计算 $E[X_1^2]$：
$E[X_1^2] = (+1)^2 \cdot p + (-1)^2 \cdot (1-p) = p + (1-p) = 1$

因此，[方差](@entry_id:200758)为：
$\text{Var}(X_1) = 1 - (2p-1)^2 = 1 - (4p^2 - 4p + 1) = 4p - 4p^2 = 4p(1-p)$

最终，我们得到 $n$ 步后位置的[方差](@entry_id:200758)（[@problem_id:1406170]）：
$\text{Var}(S_n) = 4np(1-p)$

这个结果表明，位置的[方差](@entry_id:200758)随步数 $n$ [线性增长](@entry_id:157553)。这意味着随着时间的推移，质点可能出现的位置范围会越来越广。值得注意的是，[方差](@entry_id:200758)在 $p=1/2$ 时达到最大值 $n$，这符合直觉：当左右移动概率相等时，路径的不确定性最大。

### 过程的时间演化：马尔可夫性与协[方差](@entry_id:200758)

#### 马尔可夫性与[条件期望](@entry_id:159140)

[随机游走](@entry_id:142620)的马尔可夫性意味着，要预测质点在第 $n+1$ 步的位置，我们只需要知道它在第 $n$ 步的位置 $S_n$，而不需要关心它之前的历史路径 $(S_0, S_1, \dots, S_{n-1})$。这一点在[条件期望](@entry_id:159140)中体现得尤为清晰。

假设我们观察到在 $n$ 步后质点位于 $S_n=k$。那么，在下一步的期望位置是什么？我们计算[条件期望](@entry_id:159140) $E[S_{n+1} | S_n=k]$（[@problem_id:1331721]）：
$E[S_{n+1} | S_n=k] = E[S_n + X_{n+1} | S_n=k]$

利用条件[期望的线性](@entry_id:273513)性：
$E[S_{n+1} | S_n=k] = E[S_n | S_n=k] + E[X_{n+1} | S_n=k]$

第一项 $E[S_n | S_n=k]$ 就是 $k$，因为 $S_n$ 的值已经被确定为 $k$。对于第二项，由于步长 $X_{n+1}$ 与之前的历史 $S_n$ 是独立的，其[条件期望](@entry_id:159140)等于其无[条件期望](@entry_id:159140)：
$E[X_{n+1} | S_n=k] = E[X_{n+1}] = 2p-1$

因此，我们得到：
$E[S_{n+1} | S_n=k] = k + 2p - 1$

这个结果告诉我们，从任何位置 $k$ 开始，下一步的期望位置是当前位置加上一个固定的漂移量。特别地，对于[对称随机游走](@entry_id:273558) ($p=1/2$)，我们有 $E[S_{n+1} | S_n=k] = k$。这个性质——未来[期望值](@entry_id:153208)等于当前值——是**[鞅](@entry_id:267779)（martingale）**的定义，我们稍后会深入探讨。

#### 协[方差](@entry_id:200758)结构

协[方差](@entry_id:200758)衡量了两个[随机变量](@entry_id:195330)一同变化的趋势。计算[随机游走](@entry_id:142620)在不同时刻 $m$ 和 $n$（假设 $m  n$）位置的协[方差](@entry_id:200758) $\text{Cov}(S_m, S_n)$，可以揭示过程的内在相关性。

根据定义，$\text{Cov}(S_m, S_n) = E[S_m S_n] - E[S_m]E[S_n]$。为了计算 $E[S_m S_n]$，我们利用[随机游走](@entry_id:142620)的**[独立增量](@entry_id:262163)**特性，将 $S_n$ 分解为 $S_n = S_m + (S_n - S_m) = S_m + \sum_{i=m+1}^n X_i$。
$E[S_m S_n] = E\left[S_m \left(S_m + \sum_{i=m+1}^n X_i\right)\right] = E[S_m^2] + E\left[S_m \sum_{i=m+1}^n X_i\right]$

由于 $S_m$ 只依赖于前 $m$ 步 $(X_1, \dots, X_m)$，而增量 $\sum_{i=m+1}^n X_i$ 只依赖于其后的步长 $(X_{m+1}, \dots, X_n)$，这两部分是独立的。因此，乘[积的期望](@entry_id:190023)等于期望的乘积：
$E\left[S_m \sum_{i=m+1}^n X_i\right] = E[S_m] E\left[\sum_{i=m+1}^n X_i\right]$
我们知道 $E[S_m]=m(2p-1)$ 以及 $E\left[\sum_{i=m+1}^n X_i\right] = (n-m)(2p-1)$。
将所有部分组合起来：
$\text{Cov}(S_m, S_n) = \left(E[S_m^2] + E[S_m]E[S_n-S_m]\right) - E[S_m]E[S_n]$
$= E[S_m^2] - (E[S_m])^2 = \text{Var}(S_m)$

这是一个非常优雅的结果：两个不同时刻位置的协[方差](@entry_id:200758)等于较早时刻位置的[方差](@entry_id:200758)。代入[方差](@entry_id:200758)公式，我们得到：
$\text{Cov}(S_m, S_n) = 4mp(1-p) \quad (\text{对于 } m  n)$

对于一个[对称随机游走](@entry_id:273558)（$p=1/2$），[方差](@entry_id:200758)为 $\text{Var}(S_m) = m$。因此，$\text{Cov}(S_m, S_n) = m$（[@problem_id:1331754]）。这意味着位置 $S_m$ 和 $S_n$ 是正相关的，但它们的相关系数 $\text{Corr}(S_m, S_n) = \frac{\text{Cov}(S_m, S_n)}{\sqrt{\text{Var}(S_m)\text{Var}(S_n)}} = \frac{m}{\sqrt{m \cdot n}} = \sqrt{\frac{m}{n}}$ 会随着 $n$ 的增大而减小。

### 长期行为：常返性与命中时间

#### 常返性与暂留性

[随机游走](@entry_id:142620)的一个基本问题是：一个从原点出发的质点，最终会返回原点吗？如果返回原点的概率为 1，我们称这个游走是**常返的（recurrent）**。如果返回原点的概率小于 1（即存在一个非零概率永远不再返回），我们称之为**暂留的（transient）**。

一维简单[随机游走](@entry_id:142620)的一个经典结论是：
- [对称随机游走](@entry_id:273558) ($p=1/2$) 是常返的。
- 非[对称随机游走](@entry_id:273558) ($p \neq 1/2$) 是暂留的。

直观上，非对称游走具有一个非零的净漂移，这会“推动”质点朝一个方向远去，从而降低了它返回原点的机会。我们可以精确地量化这个“逃逸”的概率。

考虑一个非对称游走，例如一个分子马达在生物纤维上移动，向前一步的概率 $p=5/7$（[@problem_id:1331751]）。我们想计算它在迈出第一步后，永不返回起点 0 的概率。这等价于，如果第一步到 +1，它永不回到 0；或者第一步到 -1，它永不回到 0。
设 $h_i$ 为从位置 $i$ 出发最终能到达 0 的概率。我们要求的概率是 $p(1-h_1) + q(1-h_{-1})$。
通过建立关于 $h_i$ 的[差分方程](@entry_id:262177)可以求解：
$h_i = p \cdot h_{i+1} + q \cdot h_{i-1} \quad （\text{对于 } i \neq 0）$
边界条件为 $h_0=1$。对于一个有向右漂移 ($pq$) 的游走，当 $i \to \infty$ 时，回到 0 的概率趋于 0，即 $\lim_{i \to \infty} h_i = 0$。而当 $i \to -\infty$ 时，质点[几乎必然](@entry_id:262518)会向右漂移并经过 0，所以 $\lim_{i \to -\infty} h_i = 1$。
该[差分方程的通解](@entry_id:197218)为 $h_i = A + B(q/p)^i$。利用边界条件，可以解出从位置 1 出发能回到 0 的概率为 $h_1 = q/p$。类似地，从 -1 出发回到 0 的概率为 $h_{-1}=1$（因为有向右的漂移）。
因此，永不返回的概率为：
$P(\text{永不返回}) = p(1 - q/p) + q(1-1) = p - q = 2p-1$
对于 $p=5/7$，$q=2/7$，这个概率是 $5/7 - 2/7 = 3/7$。这个结果 $|p-q|$ 也被称为**[逃逸概率](@entry_id:266710)（escape probability）**。

#### 期望命中时间

另一个重要问题是“需要多长时间才能到达某个特定的位置？”。这被称为**命中时间（hitting time）**。考虑一个从原点出发的[对称随机游走](@entry_id:273558)。我们在整数轴上设置两个吸收壁：一个在 $-a$，一个在 $b$（其中 $a,b$ 为正整数）。一旦[质点](@entry_id:186768)到达这两个位置中的任意一个，游走就停止。我们想要求解这个过程的期望持续时间（[@problem_id:1406135]）。

设 $E_i$ 为从位置 $i$ 出发到被吸收的期望步数。我们的目标是求 $E_0$。
在吸收壁上，时间为 0，所以我们有边界条件：$E_{-a} = 0$ 和 $E_b = 0$。
对于任何内部位置 $i \in \{-a+1, \dots, b-1\}$，我们可以通过对第一步进行条件分析来建立一个递推关系。走完一步（耗时 1）后，[质点](@entry_id:186768)以 $1/2$ 的概率移动到 $i+1$，以 $1/2$ 的概率移动到 $i-1$。因此：
$E_i = 1 + \frac{1}{2} E_{i+1} + \frac{1}{2} E_{i-1}$

这是一个二阶[线性差分方程](@entry_id:178777)。其通解形式为 $E_i = -i^2 + C_1 i + C_2$。利用两个边界条件 $E_{-a}=0$ 和 $E_b=0$，我们可以解出常数 $C_1$ 和 $C_2$：
$C_1 = b-a$
$C_2 = ab$
所以，期望时间为 $E_i = -i^2 + (b-a)i + ab$。
当[质点](@entry_id:186768)从原点 $i=0$ 出发时，[期望吸收时间](@entry_id:637112)是一个非常简洁优美的结果：
$E_0 = ab$

这个结果出人意料地简单，例如，要到达 $\{-10, 10\}$ 之一的期望时间是 $10 \times 10 = 100$ 步。我们将在下一节看到，这个结果也可以用更高等的鞅论工具得到。

### 高等工具：鞅与生成函数

#### [鞅](@entry_id:267779)论方法

**[鞅](@entry_id:267779) (Martingale)** 是一种特殊的[随机过程](@entry_id:159502)，其核心性质是“在已知目前所有信息的条件下，未来的[期望值](@entry_id:153208)等于当前值”。对于[随机游走](@entry_id:142620)的自然信息流 $\mathcal{F}_n = \sigma(X_1, \dots, X_n)$，一个过程 $M_n$ 是[鞅](@entry_id:267779)，如果 $E[|M_n|]  \infty$ 且 $E[M_{n+1}|\mathcal{F}_n] = M_n$。[鞅](@entry_id:267779)在[金融数学](@entry_id:143286)、[随机分析](@entry_id:188809)等领域有广泛应用，它也是分析[随机游走](@entry_id:142620)的强大工具。

我们已经看到，对于[对称随机游走](@entry_id:273558)，$S_n$ 本身就是一个[鞅](@entry_id:267779)，因为 $E[S_{n+1}|S_n=k] = k$。对于非对称游走， $S_n$ 不是[鞅](@entry_id:267779)，但 $M_n = S_n - n(2p-1)$ 是一个[鞅](@entry_id:267779)，因为它移除了确定性的漂移。

另一个重要的鞅是**棣莫弗鞅 (de Moivre's martingale)**。我们可以构建一个形式为 $M_n = \lambda^{S_n}$ 的过程，并寻找使其成为鞅的参数 $\lambda$（[@problem_id:1406144]）。鞅条件要求：
$E[\lambda^{S_{n+1}} | \mathcal{F}_n] = \lambda^{S_n}$
$E[\lambda^{S_n + X_{n+1}} | \mathcal{F}_n] = \lambda^{S_n}$
$\lambda^{S_n} E[\lambda^{X_{n+1}}] = \lambda^{S_n}$
这要求 $E[\lambda^{X_{n+1}}] = 1$。计算这个期望：
$p\lambda^1 + (1-p)\lambda^{-1} = 1$
整理后得到一个关于 $\lambda$ 的二次方程：$p\lambda^2 - \lambda + (1-p) = 0$。
这个方程有两个解：$\lambda=1$（平凡解）和 $\lambda = \frac{1-p}{p} = q/p$。这个非[平凡解](@entry_id:155162) $\lambda=q/p$ 构成的鞅 $M_n = (q/p)^{S_n}$ 在计算[破产概率](@entry_id:268258)等问题中非常有用。

对于[对称随机游走](@entry_id:273558)，另一个关键的鞅是 $M_n = S_n^2 - n$。
$E[M_{n+1} | \mathcal{F}_n] = E[(S_n+X_{n+1})^2 - (n+1) | \mathcal{F}_n]$
$= E[S_n^2 + 2S_n X_{n+1} + X_{n+1}^2 - n - 1 | \mathcal{F}_n]$
$= S_n^2 + 2S_n E[X_{n+1}] + E[X_{n+1}^2] - n - 1$
由于 $p=1/2$, $E[X_{n+1}]=0$ 且 $E[X_{n+1}^2]=1$。
$= S_n^2 + 0 + 1 - n - 1 = S_n^2 - n = M_n$
因此 $S_n^2-n$ 是一个鞅。

鞅理论的威力体现在**[可选停止定理](@entry_id:267890) (Optional Stopping Theorem)** 中。该定理指出，在一定条件下，对于一个[鞅](@entry_id:267779) $M_n$ 和一个停止时间 $T$，$E[M_T] = E[M_0]$。这允许我们将过程在初始时刻的性质和在某个随机的未来时刻的性质联系起来。

让我们重新审视前面计算的期望命中[时间问题](@entry_id:202825)（[@problem_id:1406135]）。设 $T$ 是对称游走首次到达 $-a$ 或 $b$ 的时间。这是一个停止时间。应用[可选停止定理](@entry_id:267890)于[鞅](@entry_id:267779) $M_n=S_n^2-n$：
$E[M_T] = E[M_0]$
$E[S_T^2 - T] = E[S_0^2 - 0] = 0$
$E[S_T^2] - E[T] = 0 \implies E[T] = E[S_T^2]$
在停止时刻 $T$，位置 $S_T$ 只可能是 $-a$ 或 $b$。设质点到达 $b$ 的概率为 $P_b$，到达 $-a$ 的概率为 $P_{-a}$。对于对称游走，可以利用 $S_n$ 本身是鞅来证明 $P_b = \frac{a}{a+b}$ 且 $P_{-a} = \frac{b}{a+b}$。
因此，$E[S_T^2] = b^2 \cdot P_b + (-a)^2 \cdot P_{-a} = b^2 \frac{a}{a+b} + a^2 \frac{b}{a+b} = \frac{ab(b+a)}{a+b} = ab$。
于是，我们再次得到了 $E[T] = ab$。这个推导过程展示了[鞅](@entry_id:267779)论的抽象性和力量。

#### 生成函数

**[生成函数](@entry_id:146702) (Generating function)** 是组合数学和概率论中的一个强大工具，它将一个无穷序列的信息编码成一个单一的函数。对于[随机游走](@entry_id:142620)，我们可以研究各种概率序列的[生成函数](@entry_id:146702)。

一个典型的例子是研究[对称随机游走](@entry_id:273558)返回原点的概率。我们知道，只有在偶数步 $2n$ 后才可能返回原点。这个概率为：
$u_{2n} = P(S_{2n}=0) = \binom{2n}{n} \left(\frac{1}{2}\right)^{2n} = \frac{1}{4^n} \binom{2n}{n}$
我们可以为序列 $\{u_{2n}\}_{n=0}^\infty$ 定义一个[普通生成函数](@entry_id:262271) $U(s) = \sum_{n=0}^\infty u_{2n} s^n$（[@problem_id:1406181]）。
$U(s) = \sum_{n=0}^{\infty} \frac{1}{4^n} \binom{2n}{n} s^n = \sum_{n=0}^{\infty} \binom{2n}{n} \left(\frac{s}{4}\right)^n$
利用[广义二项式定理](@entry_id:262225)，我们知道[中心二项式系数](@entry_id:635096)的生成函数为：
$\sum_{n=0}^{\infty} \binom{2n}{n} x^n = \frac{1}{\sqrt{1-4x}}$
令 $x = s/4$，我们得到：
$U(s) = \frac{1}{\sqrt{1-4(s/4)}} = \frac{1}{\sqrt{1-s}}$

这个紧凑的函数 $U(s)$ 包含了所有关于返回原点概率的信息。通过对这个函数进行代数运算和分析，可以推导出许多其他重要性质，例如首次返回原点的[概率分布](@entry_id:146404)，这再次证明了分析工具在研究[随机过程](@entry_id:159502)中的重要作用。