## 引言
[马尔可夫链](@entry_id:150828)是描述[随机系统](@entry_id:187663)随时间演化的强大数学工具。从股价的波动到分子的运动，其应用无处不在。然而，要真正理解这些系统的未来，一个核心问题必须被回答：当系统从某个特定状态出发后，它会以多大的频率重返此地？或者，它是否有可能一去不复返，迷失在广阔的[状态空间](@entry_id:177074)中？对这个问题的解答，正是将[马尔可夫链](@entry_id:150828)中的状态划分为**常返 (recurrent)**与**暂留 (transient)**两大基本类型的关键，这也是预测系统长期行为的基石。

本文旨在系统性地剖析[常返与暂留](@entry_id:265162)这两个核心概念。我们将首先在**第一章“原理与机制”**中，深入探讨它们的数学定义、核心判别准则，以及这些性质在有限和无限状态空间中如何体现。接着，在**第二章“应用与[交叉](@entry_id:147634)学科联系”**中，我们将跨越学科界限，展示这些理论如何在工程可靠性、[排队论](@entry_id:274141)、网络科学乃至经济学中，为分析现实世界系统的稳定性与最终命运提供深刻洞察。最后，通过**第三章“动手实践”**中的精选问题，您将有机会亲手应用所学知识，解决具体的分析挑战。

现在，让我们从最基本的问题开始：究竟什么是一个[常返态](@entry_id:276969)？什么又是一个暂留态？我们将从它们的定义和内在机制开始我们的探索之旅。

## 原理与机制

在研究离散时间[马尔可夫链的长期行为](@entry_id:272323)时，一个核心问题是：当一个过程从某个状态出发后，它是否会、以及会以多大的频率回到这个初始状态？对这个问题的回答，将状态空间中的所有状态划分为两大基本类别：**[常返态](@entry_id:276969) (recurrent states)** 和 **暂留态 (transient states)**。这种分类对于理解[马尔可夫链](@entry_id:150828)的稳定性、[极限分布](@entry_id:174797)以及各种应用模型中的长期表现至关重要。本章将系统地阐述[常返与暂留](@entry_id:265162)的定义、核心性质，并探讨它们在有限和无限状态空间中的表现和判别准则。

### [常返与暂留](@entry_id:265162)的定义

从直观上看，一个状态的分类取决于“遗忘”与“记忆”之间的平衡。如果一个过程离开某个状态后，几乎必然会“记得”在未来的某个时刻回来，那么这个状态就是常返的。相反，如果过程离开后，存在一个不可忽略的概率“永远忘记”回来，那么这个状态就是暂留的。我们可以通过两种等价的方式来精确地定义这个概念。

#### 基于返回概率的定义

考虑一个马尔可夫链 $\{X_n, n \ge 0\}$，其[状态空间](@entry_id:177074)为 $S$。对于任意状态 $i \in S$，我们定义 **首次返回时间 (first return time)** 为 $T_i^+ = \inf\{n \ge 1 : X_n = i\}$。这是一个[随机变量](@entry_id:195330)，表示从状态 $i$ 出发后，第一次回到状态 $i$ 所需的步数。如果过程从未返回，则 $T_i^+ = \infty$。

基于此，我们可以定义：

-   一个状态 $i$ 被称为 **常返的 (recurrent)**，如果从状态 $i$ 出发，最终必然会返回到状态 $i$。用数学语言表述，即返回概率为 1：
    $P(T_i^+  \infty | X_0 = i) = 1$

-   一个状态 $i$ 被称为 **暂留的 (transient)**，如果从状态 $i$ 出发，存在一个正的概率永远不再返回到状态 $i$。用数学语言表述，即返回概率严格小于 1：
    $P(T_i^+  \infty | X_0 = i)  1$

#### 基于访问次数的定义

另一种同样深刻的视角是考察过程在无限长时间内访问一个状态的总次数。令 $p_{ii}^{(n)} = P(X_n = i | X_0 = i)$ 表示从状态 $i$ 出发，经过 $n$ 步后恰好回到状态 $i$ 的概率。我们可以计算从状态 $i$ 出发后，返回到状态 $i$ 的期望总次数。

令 $I_n = \mathbf{1}\{X_n = i\}$ 是一个[指示函数](@entry_id:186820)，当第 $n$ 步在状态 $i$ 时取值为 1，否则为 0。从时间 1 开始的总访问次数为 $N = \sum_{n=1}^{\infty} I_n$。根据[期望的线性](@entry_id:273513)性质，其[期望值](@entry_id:153208)为：
$$
\mathbb{E}[N | X_0 = i] = \sum_{n=1}^{\infty} \mathbb{E}[I_n | X_0 = i] = \sum_{n=1}^{\infty} P(X_n = i | X_0 = i) = \sum_{n=1}^{\infty} p_{ii}^{(n)}
$$
这个[期望值](@entry_id:153208)恰好是所有 $n$ 步返回概率的总和。这个和的行为与状态的分类直接相关：

-   状态 $i$ 是 **常返的** 当且仅当 $\sum_{n=1}^{\infty} p_{ii}^{(n)} = \infty$。这意味着从状态 $i$ 出发，期望返回的次数是无限的。
-   状态 $i$ 是 **暂留的** 当且仅当 $\sum_{n=1}^{\infty} p_{ii}^{(n)}  \infty$。这意味着从状态 $i$ 出发，期望返回的次数是一个有限值。

这个判据在理论分析中非常强大。例如，在一个描述“量子漫步者”在离散位置上运动的模型中，如果分析发现，漫步者从某个“原点”位置 $i_0$ 出发后，在未来所有时刻返回到该位置的概率之和 $\sum_{n=1}^{\infty} p_{i_0 i_0}^{(n)}$ 收敛到一个有限的数值，那么我们就可以断定，该“原点”状态 $i_0$ 是暂留的 [@problem_id:1288930]。这意味着漫步者在离开原点后，很有可能会“迷失”在广阔的[状态空间](@entry_id:177074)中，平均只会返回有限次。

### [状态分类](@entry_id:276397)的性质

状态的分类不是孤立的，它与马尔可夫链的整体结构密切相关。其中最重要的性质是，常返性（以及暂留性）是同一个“圈子”里所有状态的共同属性。

#### 互通性与类性质

为了描述这种“圈子”，我们首先引入 **互通 (communication)** 的概念。我们称状态 $i$ [可达状态](@entry_id:265999) $j$（记作 $i \to j$），如果从 $i$ 出发，经过有限步后有大于零的概率到达 $j$。如果 $i \to j$ 且 $j \to i$，则我们称状态 $i$ 和 $j$ **互通**（记作 $i \leftrightarrow j$）。

互通是一种[等价关系](@entry_id:138275)，它将[状态空间](@entry_id:177074) $S$ 划分为若干个 **[互通类](@entry_id:267280) (communicating classes)**。如果整个状态空间构成一个单一的[互通类](@entry_id:267280)，我们称这个[马尔可夫链](@entry_id:150828)是 **不可约的 (irreducible)**。

一个关键的定理是：**常返性是一个类性质**。也就是说，如果一个[互通类](@entry_id:267280)中的任何一个状态是常返的，那么该类中的所有状态都是常返的。同理，如果一个状态是暂留的，那么它的所有互通伙伴也都是暂留的。

这个性质的直观理解是，如果 $i$ 和 $j$ 互通，那么从 $i$ 总能以一个不小的概率走到 $j$，从 $j$ 也能走回 $i$。如果 $i$ 是常返的（会无限次返回），那么每次从 $i$ 出发，都有机会访问 $j$；而每次访问 $j$，也都有机会返回 $i$，从而开启下一次返回之旅。这种紧密的联系使得 $j$ 也必须被无限次访问，因此 $j$ 也是常返的 [@problem_id:1288914]。

### 有限[状态空间](@entry_id:177074)中的分类

对于状态数量有限的马尔可夫链，其[状态分类](@entry_id:276397)展现出非常规整和确定的特性。

#### 基本定理：有限链必有[常返态](@entry_id:276969)

一个最基本的结论是：**任何一个有限状态马尔可夫链，必然至少存在一个[常返态](@entry_id:276969)**。换言之，不可能所有状态都是暂留的 [@problem_id:1378031]。

这个结论的背后是一个简单的逻辑：过程在无限的时间里，必须在有限个状态中不断跳转。这就像有无限只鸽子要住进有限个鸽笼，必然有至少一个鸽笼被访问无限次。在[马尔可夫链](@entry_id:150828)的轨迹上，被无限次访问的那个状态，根据定义，必然是常返的。

更严谨地，如果所有状态都是暂留的，那么从任何状态出发，对每个状态的访问次数的期望都是有限的。因此，对所有状态的总访问次数的期望也应该是有限的。但这与事实相矛盾，因为在每一步，过程都必然处于某个状态，所以总访问次数必然是无限的。

#### 不可约有限链

结合“有限链必有[常返态](@entry_id:276969)”和“常返性是类性质”这两个结论，我们可以得到一个非常强的推论：**对于一个不可约的有限状态马尔可夫链，所有状态都必须是常返的** [@problem_id:1288914]。

这个定理的应用非常广泛。例如，在一个合成生物学实验中，一个[基因回路](@entry_id:201900)可以在三个状态 $\{S_1, S_2, S_3\}$ 之间切换。如果设计保证了从任何一个状态都有非零概率在一步之内跳转到任何其他两个状态，那么这个三状态系统就构成了一个不可约的[马尔可夫链](@entry_id:150828)。由于[状态空间](@entry_id:177074)是有限的，我们可以立即断定，所有三个状态都是常返的，无论具体的转移概率是多少 [@problem_id:1329909]。

#### 可约有限链与闭类

当一个有限链不是不可约时，它的状态空间会分解成多个[互通类](@entry_id:267280)。这时，状态的分类取决于这些类之间的联系。一个[互通类](@entry_id:267280)被称为 **闭的 (closed)**，如果一旦进入这个类，就再也无法离开它去往任何类外的状态。

-   在一个有限状态[马尔可夫链](@entry_id:150828)中，**任何一个闭的[互通类](@entry_id:267280)中的所有状态都是常返的**。因为一旦进入这个类，[马尔可夫链](@entry_id:150828)的行为就被限制在这个[子空间](@entry_id:150286)内，这相当于一个规模更小的不可约有限链。

-   反之，**任何不构成闭类的[互通类](@entry_id:267280)中的所有状态都是暂留的**。因为从这个类中的任何一个状态出发，总存在一个正的概率会“逃逸”到一个别的类中。一旦逃逸，如果无法返回，那么最初的状态就只能是暂留的。

一个典型的例子是服务器状态模型 [@problem_id:1288907]。假设服务器有四个状态：空闲(I)、处理(P)、更新(U)、验证(V)。状态转移规则形成了两个[互通类](@entry_id:267280)：$\{I, P\}$ 和 $\{U, V\}$。从状态 P 有可能转移到 U，但从 U 或 V 永远无法回到 I 或 P。这意味着 $\{U, V\}$ 是一个闭类，而 $\{I, P\}$ 不是。因此，$\{U, V\}$ 中的状态是常返的，而 $\{I, P\}$ 中的状态是暂留的。一旦服务器进入更新/验证循环，它就永远不会再回到空闲或处理状态。

同样地，如果一个[马尔可夫链](@entry_id:150828)中存在 **[吸收态](@entry_id:161036) (absorbing state)**（即进入后就永远无法离开的状态，如状态 4 满足 $p_{44}=1$），那么这个吸收态自身构成一个[常返类](@entry_id:273689)。任何能够以正概率到达这个[吸收态](@entry_id:161036)但不能从[吸收态](@entry_id:161036)返回的状态，都必然是暂留的 [@problem_id:1384256]。

### 无限[状态空间](@entry_id:177074)中的分类

与有限[状态空间](@entry_id:177074)截然不同，无限状态空间为过程提供了“逃逸到无穷远”的可能性。这导致即使是不可约的[马尔可夫链](@entry_id:150828)，其所有状态也可能都是暂留的。

#### 案例一：一维[随机游走](@entry_id:142620)与漂移

考虑一个最经典的无限状态模型：在整数集 $\mathbb{Z}$ 上的[随机游走](@entry_id:142620)。粒子在每个时刻向右移动一步（概率为 $p$）或向左移动一步（概率为 $1-p$）。

-   **对称情况 ($p = 1/2$)**: 这是著名的“醉汉走路”模型。可以证明，在一维[对称随机游走](@entry_id:273558)中，任何状态都是常返的。尽管粒子可能会走得很远，但它最终总会以概率 1 返回原点。

-   **非对称情况 ($p \neq 1/2$)**: 假设存在一个“市场趋势”，使得价格上涨的概率 $p > 1/2$。这种情况下，[随机游走](@entry_id:142620)具有一个正的 **漂移 (drift)**，即 $X_n$ 的[期望值](@entry_id:153208)会随时间线性增长。直观上，这个持续的推动力会把粒子不断地推向正无穷方向，使得返回原点变得越来越困难。通过求解[首次返回概率](@entry_id:275671)，可以精确地计算出，从任意状态 $i$ 出发，返回到 $i$ 的概率为 $2(1-p)$。因为 $p > 1/2$，所以这个概率严格小于 1。因此，在有漂移的一维[随机游走](@entry_id:142620)中，所有状态都是暂留的 [@problem_id:1314739]。

#### 案例二：[图上的随机游走](@entry_id:273686)与维度

[状态空间](@entry_id:177074)的“维度”或“分支度”也深刻影响着状态的分类。考虑一个粒子在无限 $d$-正则树（每个顶点都有 $d$ 个邻居）上进行[对称随机游走](@entry_id:273558) [@problem_id:1384272]。

-   当 $d=2$ 时，这棵树退化为整数直线 $\mathbb{Z}$。正如我们所知，[对称随机游走](@entry_id:273558)在这种结构上是常返的。

-   当 $d \ge 3$ 时，情况发生了根本性变化。从任何一个顶点出发，向外探索时，路径的数量呈指数级增长。这为粒子提供了巨大的“逃逸空间”。尽管每一步都是对称的，但远离原点的“诱惑”远大于返回的单一路径。分析表明，对于任何 $d \ge 3$，返回出发点的概率为 $1/(d-1)$，严格小于 1。因此，状态是暂留的。这个结果与著名的[波利亚定理](@entry_id:264026)（Pólya's Theorem）相呼应，该定理指出[对称随机游走](@entry_id:273558)在 $\mathbb{Z}^1$ 和 $\mathbb{Z}^2$ 上是常返的，但在 $\mathbb{Z}^3$ 及更高维度上是暂留的。

#### 案例三：计算[逃逸概率](@entry_id:266710)

在某些模型中，我们可以直接计算“逃逸到无穷远”的概率，从而判断状态的分类。考虑一个在非负整数上运动的算法状态模型 [@problem_id:1384266]。算法从状态 0（重启）开始，必然进入状态 1。在任何状态 $k \ge 1$，它以概率 $p_k$ 进入下一阶段 $k+1$，或以概率 $1-p_k$ 发生故障并返回状态 0。

要判断状态 0 是常返还是暂留，我们只需考察从状态 0 出发后，是否必然返回。过程从 0 到 1 是确定的，因此问题等价于从状态 1 出发，是否必然返回 0。唯一不返回 0 的情况，是算法永不发生故障，即成功地经历了 $1 \to 2 \to 3 \to \dots$ 的无限序列。这个“逃逸”事件的概率是所有成功概率的无穷乘积：
$$
P(\text{永不返回 0}) = \prod_{k=1}^{\infty} p_k
$$
对于给定的成功概率 $p_k = \frac{k(k+2)}{(k+1)^2}$，这个无穷乘积可以通过计算部分乘积的极限来求得。其部分乘积为：
$$
\prod_{k=1}^{n} \frac{k(k+2)}{(k+1)^2} = \left(\prod_{k=1}^{n} \frac{k}{k+1}\right) \left(\prod_{k=1}^{n} \frac{k+2}{k+1}\right) = \left(\frac{1}{n+1}\right) \left(\frac{n+2}{2}\right) = \frac{n+2}{2(n+1)}
$$
当 $n \to \infty$ 时，这个极限值为 $1/2$。这意味着存在 $1/2$ 的正概率，算法会永远不返回重启状态 0。因此，返回状态 0 的概率也是 $1/2$，严格小于 1，故状态 0 是暂留的。

综上所述，状态的[常返与暂留](@entry_id:265162)分类是理解[马尔可夫链](@entry_id:150828)长期行为的基石。在有限状态空间中，该分类由[状态空间](@entry_id:177074)的互通结构和[闭包性质](@entry_id:136899)完全决定；而在无限[状态空间](@entry_id:177074)中，它还深刻地依赖于过程的内在漂移和状态空间的几何维度或分支结构。