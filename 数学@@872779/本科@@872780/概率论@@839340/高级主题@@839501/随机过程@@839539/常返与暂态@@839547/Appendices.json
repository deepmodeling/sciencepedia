{"hands_on_practices": [{"introduction": "首先，我们来探讨一个支配有限马尔可夫链行为的核心原则。这个练习将帮助你理解，在有限状态空间中，“不可约性”这一属性本身就足以保证所有状态都是常返的 [@problem_id:1329949]。通过分析一个看似特殊的系统——一个无法在相邻时间步停留于同一状态的系统——你将学会区分决定状态分类的关键属性与次要细节。", "problem": "一个随机过程由一个定义在有限状态空间 $S = \\{s_1, s_2, \\ldots, s_N\\}$ 上的离散时间马尔可夫链描述，其中状态数 $N$ 是一个大于等于3的整数。已知该链是不可约的，这意味着可以从任意状态到达任意其他状态（不一定是一步之内）。\n\n该系统动力学的一个奇特之处在于，该过程不可能连续两个时间步停留在同一状态。在数学上，这转化为一个性质，即转移概率矩阵 $P$ 的所有对角线元素都为零，即对于所有状态 $i \\in S$，都有 $P_{ii} = 0$。\n\n仅根据所提供的信息，关于此马尔可夫链中状态的分类，可以明确地得出什么结论？\n\nA. 所有状态都是暂留的。\n\nB. 所有状态都是常返的。\n\nC. 部分状态是常返的，部分状态是暂留的。\n\nD. 在不知道转移矩阵 $P$ 的非对角线元素的具体值的情况下，无法确定状态是常返的还是暂留的。", "solution": "设 $(X_{n})_{n \\geq 0}$ 是一个离散时间马尔可夫链，其状态空间为有限集 $S=\\{s_{1},\\ldots,s_{N}\\}$（$N \\geq 3$），转移矩阵为 $P=(P_{ij})_{i,j \\in S}$，且满足：\n- 不可约性：对于所有 $i,j \\in S$，存在 $n \\geq 1$ 使得 $(P^{n})_{ij} > 0$。\n- 无自环：对于所有 $i \\in S$，$P_{ii} = 0$。\n\n我们需要仅根据这些信息，确定状态的常返性与暂留性。\n\n首先，利用有限性和不可约性。由于 $P$ 是一个有限、不可约的非负矩阵，且其每行之和为 $1$，根据 Perron–Frobenius 定理，存在一个严格正向量 $\\pi \\in \\mathbb{R}^{N}$ 使得\n$$\nP^{\\top}\\pi = \\pi, \\qquad \\pi_{i} > 0 \\text{ for all } i \\in S.\n$$\n通过设定\n$$\n\\sum_{i \\in S} \\pi_{i} = 1,\n$$\n将其归一化以获得一个概率向量。\n那么 $\\pi$ 是一个平稳分布：\n$$\n\\pi^{\\top} P = \\pi^{\\top}, \\qquad \\sum_{i \\in S} \\pi_{i} = 1, \\qquad \\pi_{i} > 0 \\ \\forall i.\n$$\n\n在一个不可约的马尔可夫链中，平稳分布的存在意味着正常返性。更准确地说，对于每个状态 $i$，令其返回时间为\n$$\nT_{i}^{+} = \\inf\\{n \\geq 1 : X_{n} = i \\mid X_{0} = i\\}.\n$$\nKac 公式给出了以下恒等式\n$$\n\\mathbb{E}_{i}[T_{i}^{+}] = \\frac{1}{\\pi_{i}} \\quad \\text{for each } i \\in S,\n$$\n因此，由于 $\\pi_{i} > 0$，可以得出\n$$\n\\mathbb{E}_{i}[T_{i}^{+}]  \\infty.\n$$\n如果 $\\mathbb{P}_{i}(T_{i}^{+} = \\infty) > 0$，那么 $\\mathbb{E}_{i}[T_{i}^{+}]$ 将是无穷大。因此必然有\n$$\n\\mathbb{P}_{i}(T_{i}^{+}  \\infty) = 1,\n$$\n所以每个状态 $i$ 都是常返的（实际上是正常返的）。\n\n因此，在任何有限不可约马尔可夫链中，所有状态都是常返的，无论其周期性如何。附加的约束条件 $P_{ii}=0$ 仅约束了周期（例如，它排除了单步返回的可能性，但如果奇数和偶数长度的返回路径都存在，则不排除非周期性）；它不影响常返性的分类。\n\n因此，正确的选项是所有状态都是常返的。", "answer": "$$\\boxed{B}$$", "id": "1329949"}, {"introduction": "现实世界中的许多复杂系统是由多个独立的子系统构成的。这个练习将引导你探索一个重要问题：我们能否根据子系统的性质来推断整个复合系统的行为？通过构建和分析一个由两个独立的马尔可夫链组合而成的“乘积链”(product chain) [@problem_id:1288901]，你将掌握一种从局部特性推断全局性质的强大建模思想。", "problem": "一个工程团队正在为一架新飞机设计一个复杂的航空电子系统。该系统的整体运行状态由两个关键的、独立的子系统的组合状态决定：飞行控制计算机（FCC）和惯性导航系统（INS）。\n\nFCC的状态根据一个具有有限状态集 $S_{FCC}$ 的离散时间马尔可夫链随时间演变。同样，INS的状态作为其自身有限状态集 $S_{INS}$ 上的一个独立的离散时间马尔可夫链演变。通过广泛的测试，工程师们已经确定这两个独立的马尔可夫链都是不可约的。一个链是不可约的，如果从任何状态最终转移到任何其他状态都是可能的。\n\n航空电子系统的整体状态由一个有序对 $(f, i)$ 表示，其中 $f \\in S_{FCC}$ 且 $i \\in S_{INS}$。这些有序对的演变在状态空间 $S_{FCC} \\times S_{INS}$ 上形成一个新的“积”马尔可夫链。\n\n为了安全认证，航空电子系统的每一个可能状态都必须被分类为*常返的*。一个状态被定义为常返的，如果系统离开该状态后，保证最终以概率1返回到该状态。一个非常返的状态被称为*暂留的*，这意味着系统离开该状态后，有非零的概率永远不会返回。系统中任何一个暂留状态都将是一个关键的故障点。\n\n根据单个FCC和INS链是有限状态且不可约的信息，可以对整个航空电子系统的状态得出什么结论？\n\nA. 整个系统的所有状态都是暂留的。\n\nB. 整个系统的所有状态都是常返的。\n\nC. 整个系统的某些状态是常返的，某些是暂留的。\n\nD. 如果不知道FCC和INS子系统的具体转移概率矩阵，就无法确定状态的性质。", "solution": "令 FCC 和 INS 链分别具有有限状态空间 $S_{FCC}$ 和 $S_{INS}$ 以及转移矩阵 $P_{FCC}$ 和 $P_{INS}$。每个链都是不可约且有限的，因此每个链都有一个唯一的、各项都严格为正的平稳分布。将它们表示为 $\\pi_{FCC}$ 和 $\\pi_{INS}$，因此\n$$\n\\sum_{f' \\in S_{FCC}} \\pi_{FCC}(f') P_{FCC}(f',f) = \\pi_{FCC}(f), \\quad \\forall f \\in S_{FCC},\n$$\n$$\n\\sum_{i' \\in S_{INS}} \\pi_{INS}(i') P_{INS}(i',i) = \\pi_{INS}(i), \\quad \\forall i \\in S_{INS},\n$$\n并且对于所有的 $f,i$，有 $\\pi_{FCC}(f) > 0$ 和 $\\pi_{INS}(i) > 0$。\n\n在 $S_{FCC} \\times S_{INS}$ 上的整体积链具有转移矩阵 $P$，由下式给出\n$$\nP\\big((f,i),(f',i')\\big) = P_{FCC}(f,f') \\, P_{INS}(i,i').\n$$\n在 $S_{FCC} \\times S_{INS}$ 上定义 $\\pi$ 为\n$$\n\\pi(f,i) \\equiv \\pi_{FCC}(f)\\, \\pi_{INS}(i).\n$$\n我们验证积链的平稳分布 $\\pi$：\n$$\n\\sum_{(f',i') \\in S_{FCC} \\times S_{INS}} \\pi(f',i') \\, P\\big((f',i'),(f,i)\\big)\n= \\sum_{f' \\in S_{FCC}} \\sum_{i' \\in S_{INS}} \\pi_{FCC}(f') \\pi_{INS}(i') \\, P_{FCC}(f',f) P_{INS}(i',i)\n$$\n$$\n= \\left(\\sum_{f' \\in S_{FCC}} \\pi_{FCC}(f') P_{FCC}(f',f)\\right) \\left(\\sum_{i' \\in S_{INS}} \\pi_{INS}(i') P_{INS}(i',i)\\right)\n= \\pi_{FCC}(f)\\, \\pi_{INS}(i) = \\pi(f,i).\n$$\n因此 $\\pi$ 是积链的一个平稳分布，并且因为 $\\pi_{FCC}$ 和 $\\pi_{INS}$ 在其有限状态空间上是严格为正的，所以对于每一个 $(f,i) \\in S_{FCC} \\times S_{INS}$，我们有 $\\pi(f,i) > 0$。\n\n马尔可夫链的一个标准分类结果指出，任何平稳分布对暂留状态赋予的概率为零；等价地，具有严格为正的平稳概率的状态是常返的（在有限状态情况下，实际上是正常返的）。由于 $\\pi$ 对每个状态 $(f,i)$ 都赋予了严格为正的概率，因此没有状态可以是暂留的。因此，整个系统的每个状态都是常返的。\n\n这个结论除了需要知道各分量链是有限和不可约的外，并不需要知道具体的转移概率。\n\n因此，正确选项是 B。", "answer": "$$\\boxed{B}$$", "id": "1288901"}, {"introduction": "在熟悉了有限状态空间后，我们将视野转向无限状态空间，在这里，常返与暂留的判断标准会发生根本性变化。这个练习通过一个带有轻微“偏向”的一维随机游走模型 [@problem_id:1288903]，向你介绍“漂移”(drift) 这一关键概念。你将亲身计算并理解，为何一个微小且持续的移动倾向，就会导致粒子“一去不复返”，从而使所有状态都变为暂留的。", "problem": "一个描述点缺陷沿一维聚合物链移动的简化模型，将缺陷的位置描述为整数集 $\\mathbb{Z}$ 上的随机游走。系统在任意时刻的状态是缺陷的整数坐标 $n$。在每个离散时间步长，缺陷的位置根据以下概率规则发生变化，这些规则受到聚合物不对称化学结构的影响：\n- 缺陷以概率 $p_R$向右移动一步（从 $n$ 到 $n+1$）。\n- 缺陷以概率 $p_L$向左移动一步（从 $n$ 到 $n-1$）。\n- 缺陷以概率 $p_S$停留在当前位置 $n$。\n\n这些概率由一个与聚合物材料特性相关的正常数 $k$ 给出：\n$p_R = \\frac{k+1}{2k+4}$，$p_L = \\frac{k}{2k+4}$，以及 $p_S = \\frac{3}{2k+4}$。\n\n由此随机游走形成的马尔可夫链是不可约的，这意味着所有状态都属于同一个互通类，因此具有相同的性质。分析此链中状态的性质，并从以下选项中选择正确的分类。\n\nA. 常返且非周期\n\nB. 常返且周期\n\nC. 暂留且非周期\n\nD. 暂留且周期\n\nE. 分类取决于正常数 $k$ 的具体值。", "solution": "我们验证转移概率。给定 $p_{R}=\\frac{k+1}{2k+4}$，$p_{L}=\\frac{k}{2k+4}$，和 $p_{S}=\\frac{3}{2k+4}$，其中 $k0$，我们有\n$$\np_{R}+p_{L}+p_{S}=\\frac{k+1}{2k+4}+\\frac{k}{2k+4}+\\frac{3}{2k+4}=\\frac{2k+4}{2k+4}=1,\n$$\n且对于 $k0$，每一项都严格为正，因此该链在 $\\mathbb{Z}$ 上是良定义的和不可约的，因为从任何状态 $n$ 都可以通过一系列左右移动到达任何状态 $m$，每次移动的概率都为正。\n\n为了确定周期性，回想状态 $i$ 的周期 $d(i)$ 是\n$$\nd(i)=\\gcd\\{n\\geq 1: P^{n}(i,i)0\\}。\n$$\n因为 $P(i,i)=p_{S}0$，我们有 $1\\in\\{n\\geq 1: P^{n}(i,i)0\\}$，因此 $d(i)=1$。所以所有状态都是非周期的。\n\n为了确定常返性与暂留性，考虑增量 $\\Delta X_{t}=X_{t+1}-X_{t}$，它满足\n$$\n\\Delta X_{t}=\\begin{cases}\n+1  \\text{概率为 } p_{R},\\\\\n-1  \\text{概率为 } p_{L},\\\\\n0  \\text{概率为 } p_{S}。\n\\end{cases}\n$$\n这些增量在时间上是独立同分布的，因为对于增量来说，转移概率是时间齐次的且与状态无关。漂移（平均增量）是\n$$\n\\mu=\\mathbb{E}[\\Delta X_{t}]=p_{R}-p_{L}=\\frac{k+1}{2k+4}-\\frac{k}{2k+4}=\\frac{1}{2k+4}0。\n$$\n根据强大数定律，对于 $S_{n}=X_{n}-X_{0}=\\sum_{t=0}^{n-1}\\Delta X_{t}$，\n$$\n\\frac{S_{n}}{n}\\to \\mu \\quad \\text{几乎必然地,}\n$$\n所以 $S_{n}\\to +\\infty$ 几乎必然成立。因此，该游走会漂移到 $+\\infty$，并且几乎必然地只会有限次访问任何固定状态，这意味着所有状态都是暂留的。\n\n综合以上两点，对于每个 $k0$，该链都是暂留且非周期的。因此，正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "1288903"}]}