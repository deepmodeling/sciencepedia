{"hands_on_practices": [{"introduction": "在分析连续时间马尔可夫链时，第一步是将系统的现实世界描述（状态和转移率）转化为一个数学对象：生成元矩阵$Q$。这个练习将带你实践这项关键技能，为所有后续分析奠定基础。通过将一个内容流媒体平台的用户行为模型化，你将学会如何系统地填充生成元矩阵的每一个元素 [@problem_id:1363205]。", "problem": "考虑一个内容流媒体平台上用户行为的简化模型，该模型可以描述为一个连续时间马尔可夫链。用户可以处于以下三种状态之一：\n- 状态 1：“探索”，此时用户正在积极浏览新内容。\n- 状态 2：“消费”，此时用户正在观看某个特定内容（例如，观看视频）。\n- 状态 3：“不活跃”，此时用户已离开平台。\n\n这些状态之间的转移以恒定的速率发生。从“探索”到“消费”的转移速率为 $\\alpha$。从“探索”到“不活跃”的转移速率为 $\\beta$。从“消费”状态，用户可以以速率 $\\gamma$ 返回“探索”状态，或以速率 $\\delta$ 变为“不活跃”状态。一个“不活跃”的用户可以以速率 $\\epsilon$ 返回“探索”状态，例如，由于收到通知。所有其他不同状态之间的转移速率假定为零。\n\n构建这个三状态连续时间马尔可夫链的生成元矩阵 $Q$。状态应按 (1, 2, 3) 的顺序排列。", "solution": "连续时间马尔可夫链由其生成元矩阵 $Q$ 来表征。其非对角线元素 $q_{ij}$（其中 $i \\neq j$）是从状态 $i$ 到状态 $j$ 的转移速率，其对角线元素满足 $q_{ii}=-\\sum_{j\\neq i}q_{ij}$，使得每行之和为零。\n\n根据问题描述，状态顺序为 $(1,2,3)$ 时，不同状态之间的非零转移速率为：\n- 从状态 $1$ 到状态 $2$：$q_{12}=\\alpha$。\n- 从状态 $1$ 到状态 $3$：$q_{13}=\\beta$。\n- 从状态 $2$ 到状态 $1$：$q_{21}=\\gamma$。\n- 从状态 $2$ 到状态 $3$：$q_{23}=\\delta$。\n- 从状态 $3$ 到状态 $1$：$q_{31}=\\epsilon$。\n所有其他非对角线元素均为零，因此 $q_{32}=0$。\n\n使用 $q_{ii}=-\\sum_{j\\neq i}q_{ij}$，对角线元素为：\n- 对于状态 $1$：$q_{11}=-(\\alpha+\\beta)$。\n- 对于状态 $2$：$q_{22}=-(\\gamma+\\delta)$。\n- 对于状态 $3$：$q_{33}=-\\epsilon$。\n\n因此，按 $(1,2,3)$ 顺序排列的生成元矩阵 $Q$ 为\n$$\nQ=\\begin{pmatrix}\n-(\\alpha+\\beta) & \\alpha & \\beta \\\\\n\\gamma & -(\\gamma+\\delta) & \\delta \\\\\n\\epsilon & 0 & -\\epsilon\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} -(\\alpha+\\beta) & \\alpha & \\beta \\\\ \\gamma & -(\\gamma+\\delta) & \\delta \\\\ \\epsilon & 0 & -\\epsilon \\end{pmatrix}}$$", "id": "1363205"}, {"introduction": "生成元矩阵$Q$包含了关于马尔可夫链动态的两个核心信息：系统在某个状态停留多长时间，以及它接下来会跳转到哪里。这个练习将向你展示如何从矩阵中提取这些细节——从对角线元素计算期望驻留时间，以及从非对角线元素计算下一状态的跳转概率。这能让你更深入地理解系统每时每刻的行为 [@problem_id:1363266]。", "problem": "考虑一个系统，它可能处于三种状态之一：状态1（运行中），状态2（降级），和状态3（离线）。这些状态之间的转换被建模为状态空间 $S = \\{1, 2, 3\\}$ 上的一个连续时间马尔可夫链。该系统的动态由以下生成元矩阵 $Q$ 决定，其中速率以每小时的转换次数给出：\n\n$$\nQ = \\begin{pmatrix} -4.0 & 3.0 & 1.0 \\\\ 2.0 & -2.5 & 0.5 \\\\ 4.0 & 0.0 & -4.0 \\end{pmatrix}\n$$\n\n基于此模型，您需要计算两个不同的量。首先，确定系统从“降级”状态（状态2）开始，其下一次转换将进入“运行中”状态（状态1）的概率。其次，确定系统在转换到任何其他状态之前，将在“运行中”状态（状态1）中停留的期望时间。\n\n按指定顺序提供这两个值。第一个值是无量纲的概率，第二个值是期望时间。期望时间以小时为单位表示。", "solution": "对于一个具有生成元矩阵 $Q=(q_{ij})$ 的连续时间马尔可夫链，在状态 $i$ 的逗留（停留）时间服从速率为 $-q_{ii}$ 的指数分布，且从状态 $i$ 下一次跳跃到状态 $j \\neq i$ 的条件概率由下式给出：\n$$\n\\mathbb{P}(\\text{next state }=j \\mid \\text{current state }=i)=\\frac{q_{ij}}{-q_{ii}}.\n$$\n\n第一个量（从状态2到状态1的下一次转换概率）：\n从给定的 $Q$ 中，我们有 $q_{21}=2.0$ 和 $q_{22}=-2.5$，因此 $-q_{22}=2.5$。所以，\n$$\n\\mathbb{P}(2 \\to 1 \\text{ next})=\\frac{q_{21}}{-q_{22}}=\\frac{2.0}{2.5}=\\frac{2}{\\frac{5}{2}}=\\frac{4}{5}.\n$$\n\n第二个量（离开状态1之前在其停留的期望时间）：\n在状态1的停留时间服从 $\\operatorname{Exp}(-q_{11})$ 分布。从 $Q$ 中，我们有 $q_{11}=-4.0$，因此 $-q_{11}=4.0$。期望为\n$$\n\\mathbb{E}[T_{1}]=\\frac{1}{-q_{11}}=\\frac{1}{4}.\n$$\n这个值的单位是小时，因为速率是以每小时为单位的。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{4}{5} & \\frac{1}{4}\\end{pmatrix}}$$", "id": "1363266"}, {"introduction": "除了短期转移，生成元矩阵还能让我们预测系统的长期或平衡行为。这个练习将演示如何使用生成元矩阵来计算平稳分布，它描述了系统运行很长一段时间后处于各个状态的概率。这是该理论最有力的应用之一，让我们能够洞察系统的最终稳态 [@problem_id:1363233]。", "problem": "某个化学反应的简化模型涉及一个单一的催化剂粒子，该粒子可以存在于三种能量状态之一，标记为 1、2 和 3。粒子以连续时间的循环方式在这些状态之间转换。具体来说，它只能从状态 1 转换到状态 2，从状态 2 转换到状态 3，以及从状态 3 返回到状态 1。从状态 1 到状态 2 的转换以恒定速率 $\\lambda_1$ 发生。从状态 2 到状态 3 的转换速率为 $\\lambda_2$，从状态 3 到状态 1 的转换速率为 $\\lambda_3$。所有速率 $\\lambda_1, \\lambda_2, \\lambda_3$ 均为正常数。所有其他可能的转换速率均为零。\n\n系统运行很长时间后，观察到它达到了一个平稳（或平衡）状态，在该状态下，发现粒子处于任何给定状态的概率随时间保持恒定。\n\n确定发现粒子处于状态 2 的平稳概率。将您的答案表示为关于速率 $\\lambda_1, \\lambda_2$ 和 $\\lambda_3$ 的符号表达式。", "solution": "我们将该系统建模为一个连续时间马尔可夫链，其生成元矩阵 $Q$ 由给定的转换速率确定。唯一的非零非对角线元素是 $q_{12}=\\lambda_{1}$、$q_{23}=\\lambda_{2}$ 和 $q_{31}=\\lambda_{3}$，对角线元素是 $q_{11}=-\\lambda_{1}$、$q_{22}=-\\lambda_{2}$、$q_{33}=-\\lambda_{3}$。\n\n设平稳分布为 $\\boldsymbol{\\pi}=(\\pi_{1},\\pi_{2},\\pi_{3})$。在平稳状态下，概率满足全局平衡方程 $\\boldsymbol{\\pi}Q=\\boldsymbol{0}$ 以及归一化条件 $\\pi_{1}+\\pi_{2}+\\pi_{3}=1$。将 $\\boldsymbol{\\pi}Q=\\boldsymbol{0}$ 按分量写出可得：\n$$\n-\\lambda_{1}\\pi_{1}+\\lambda_{3}\\pi_{3}=0,\\quad \\lambda_{1}\\pi_{1}-\\lambda_{2}\\pi_{2}=0,\\quad \\lambda_{2}\\pi_{2}-\\lambda_{3}\\pi_{3}=0.\n$$\n这表明\n$$\n\\lambda_{1}\\pi_{1}=\\lambda_{2}\\pi_{2}=\\lambda_{3}\\pi_{3}=c,\n$$\n其中 $c>0$ 是某个常数。因此\n$$\n\\pi_{1}=\\frac{c}{\\lambda_{1}},\\quad \\pi_{2}=\\frac{c}{\\lambda_{2}},\\quad \\pi_{3}=\\frac{c}{\\lambda_{3}}.\n$$\n应用归一化条件可得\n$$\n\\frac{c}{\\lambda_{1}}+\\frac{c}{\\lambda_{2}}+\\frac{c}{\\lambda_{3}}=1 \\;\\;\\Longrightarrow\\;\\; c=\\frac{1}{\\frac{1}{\\lambda_{1}}+\\frac{1}{\\lambda_{2}}+\\frac{1}{\\lambda_{3}}}=\\frac{\\lambda_{1}\\lambda_{2}\\lambda_{3}}{\\lambda_{1}\\lambda_{2}+\\lambda_{1}\\lambda_{3}+\\lambda_{2}\\lambda_{3}}.\n$$\n因此，状态 2 的平稳概率为\n$$\n\\pi_{2}=\\frac{c}{\\lambda_{2}}=\\frac{\\lambda_{1}\\lambda_{3}}{\\lambda_{1}\\lambda_{2}+\\lambda_{1}\\lambda_{3}+\\lambda_{2}\\lambda_{3}}.\n$$", "answer": "$$\\boxed{\\frac{\\lambda_{1}\\lambda_{3}}{\\lambda_{1}\\lambda_{2}+\\lambda_{1}\\lambda_{3}+\\lambda_{2}\\lambda_{3}}}$$", "id": "1363233"}]}