{"hands_on_practices": [{"introduction": "虽然任何特定代的种群大小是随机的，但我们可以预测其平均规模。这个练习 [@problem_id:1285799] 将演示如何使用后代的平均数量来预测未来种群的期望大小，这是理解种群增长或衰退趋势的基本工具。", "problem": "一位生物学家正在研究一种新发现的无害基因突变。研究始于单个生物体，该生物体构成第0代。该生物体及其后代根据一个特定的概率规则传递该突变。从任何单个亲本继承该突变的直接后代数量 $K$ 是一个服从几何分布的随机变量。该分布的概率质量函数由下式给出：\n$$P(K = k) = (1-p)^k p$$\n对于 $k = 0, 1, 2, \\dots$。\n\n对于这个特定的突变，参数 $p$ 已被确定为 $p = 1/3$。假设所有个体的繁殖过程都是独立的，并且都遵循这同一个分布。\n\n在第四代中，携带该突变的生物体的期望数量是多少？", "solution": "设 $K$ 表示单个个体的突变后代数量。根据假设，$K$ 服从在 $\\{0,1,2,\\dots\\}$ 上的几何分布，其概率为\n$$\n\\Pr(K=k) = (1-p)^{k} p, \\quad k=0,1,2,\\dots\n$$\n其均值为\n$$\n\\mathbb{E}[K] = \\sum_{k=0}^{\\infty} k \\, p (1-p)^{k}.\n$$\n令 $r = 1-p$ 且 $|r|<1$。几何级数满足\n$$\n\\sum_{k=0}^{\\infty} r^{k} = \\frac{1}{1-r}.\n$$\n对 $r$ 求导得到\n$$\n\\sum_{k=1}^{\\infty} k r^{k-1} = \\frac{1}{(1-r)^{2}},\n$$\n两边同乘以 $r$ 可得\n$$\n\\sum_{k=1}^{\\infty} k r^{k} = \\frac{r}{(1-r)^{2}}.\n$$\n因此，\n$$\n\\mathbb{E}[K] = p \\sum_{k=0}^{\\infty} k r^{k} = p \\cdot \\frac{r}{(1-r)^{2}} = p \\cdot \\frac{1-p}{p^{2}} = \\frac{1-p}{p}.\n$$\n对于一个 Galton–Watson 分支过程，其中后代数量是独立同分布的，均值为 $m=\\mathbb{E}[K]$，如果 $Z_{n}$ 表示第 $n$ 代的个体数量且 $Z_{0}=1$，那么\n$$\n\\mathbb{E}[Z_{n+1} \\mid Z_{n}] = Z_{n} \\, m \\quad \\Longrightarrow \\quad \\mathbb{E}[Z_{n+1}] = m \\, \\mathbb{E}[Z_{n}],\n$$\n因此通过归纳法，\n$$\n\\mathbb{E}[Z_{n}] = m^{n}.\n$$\n这里 $p=\\frac{1}{3}$，因此\n$$\nm = \\frac{1-p}{p} = \\frac{1-\\frac{1}{3}}{\\frac{1}{3}} = \\frac{\\frac{2}{3}}{\\frac{1}{3}} = 2.\n$$\n对于第四代（$n=4$），\n$$\n\\mathbb{E}[Z_{4}] = 2^{4} = 16.\n$$", "answer": "$$\\boxed{16}$$", "id": "1285799"}, {"introduction": "关于分支过程最关键的问题之一是种群是否会最终灭绝。这个练习 [@problem_id:1285810] 介绍了一种强大的方法，即使用概率母函数来精确计算最终灭绝的概率，这为了解模型的长期行为提供了深刻的见解。", "problem": "一种自我复制的数字实体“digi-clone”的增殖简化模型，可以用一个分支过程来描述。在每一代中，每个现有的 digi-clone 会尝试在不同的网络节点上创建两个自己的新副本。每次创建尝试都是独立的，成功的概率为 $p=0.6$。在复制尝试之后，原始的 digi-clone 会被停用。该过程从第 0 代的一个 digi-clone 开始。灭绝是指 digi-clone 的种群最终变为零的事件。计算最终灭绝的概率。将你的最终答案表示为一个最简精确分数。", "solution": "将每个 digi-clone 的后代数量建模为一个 Galton–Watson 分支过程。每个 digi-clone 进行两次独立的复制尝试，每次成功的概率为 $p=0.6$，所以后代分布为 $X \\sim \\mathrm{Binomial}(2,p)$。$X$ 的概率生成函数为\n$$\nf(s)=\\sum_{k=0}^{2} \\binom{2}{k} p^{k} (1-p)^{2-k} s^{k}=(1-p+ps)^{2}.\n$$\n灭绝概率 $q$ 是不动点方程在 $[0,1]$ 上的最小解\n$$\nq=f(q).\n$$\n因此，\n$$\nq=(1-p+pq)^{2}.\n$$\n代入 $p=\\frac{3}{5}$ (因为 $0.6=\\frac{3}{5}$) 可得\n$$\nq=\\left(\\frac{2}{5}+\\frac{3}{5}q\\right)^{2}=\\frac{4}{25}+\\frac{12}{25}q+\\frac{9}{25}q^{2}.\n$$\n整理可得\n$$\n0=\\frac{4}{25}+\\frac{12}{25}q+\\frac{9}{25}q^{2}-q,\n$$\n两边乘以 $25$ 可得\n$$\n0=4+12q+9q^{2}-25q=4-13q+9q^{2}.\n$$\n解二次方程 $9q^{2}-13q+4=0$：\n$$\nq=\\frac{13\\pm\\sqrt{13^{2}-4\\cdot 9\\cdot 4}}{2\\cdot 9}=\\frac{13\\pm\\sqrt{169-144}}{18}=\\frac{13\\pm 5}{18}.\n$$\n因此，两个不动点是 $q=\\frac{18}{18}=1$ 和 $q=\\frac{8}{18}=\\frac{4}{9}$。由于平均后代数为 $2p=\\frac{6}{5}>1$，灭绝概率是较小的不动点，即 $q=\\frac{4}{9}$。", "answer": "$$\\boxed{\\frac{4}{9}}$$", "id": "1285810"}, {"introduction": "除了研究特定代的大小或其最终命运，我们还可以分析过程的整个历史。“总后代”指的是曾经存在过的所有个体的总数。这个练习 [@problem_id:700695] 要求我们枚举所有可能的“家谱”，以计算特定总后代数量的概率，从而为我们提供对过程随机性的更深层次的直观理解。", "problem": "考虑一个高尔顿-沃森分支过程 $\\{Z_n\\}_{n \\ge 0}$，它从单个始祖开始，因此 $Z_0=1$。任何个体的后代数量是从参数为 $p \\in (0,1)$ 的几何分布中独立随机抽取的。后代数量 $\\xi$ 的概率质量函数由下式给出：\n$$P(\\xi = k) = p(1-p)^k, \\quad \\text{for } k = 0, 1, 2, \\dots$$\n该过程的总后代数，记为 $T$，是曾经存活过的所有个体的总数，包括初始始祖。形式上，$T = \\sum_{n=0}^{\\infty} Z_n$。如果该过程灭绝，$T$ 是一个有限的整数值随机变量。对于某个整数 $k$，事件 $\\{T=k\\}$ 意味着该过程已经灭绝。\n\n推导总后代数恰好为三的概率 $P(T=3)$ 的闭式表达式。最终答案应以参数 $p$ 表示。", "solution": "我们有一个高尔顿-沃森过程，其中 $Z_0=1$ 且后代分布为 $\\xi\\sim \\mathrm{Geom}(p)$：\n$$P(\\xi=k)=p(1-p)^k,\\quad k=0,1,2,\\dots$$\n总后代数为 $T=\\sum_{n\\ge0}Z_n$。对于 $T=3$，有两种不相交的方式可以得到恰好三个个体：\n\n情况1：始祖有2个孩子，且这两个孩子都没有后代。\n$$P(\\xi_0=2)=p(1-p)^2,\\quad P(\\xi_{1,1}=0)=p,\\quad P(\\xi_{1,2}=0)=p$$\n$$P_{\\text{情况1}}=p(1-p)^2\\cdot p\\cdot p=p^3(1-p)^2.$$\n\n情况2：始祖有1个孩子，这个孩子有1个孩子，而最后一个个体没有后代。\n$$P(\\xi_0=1)=p(1-p),\\quad P(\\xi_1=1)=p(1-p),\\quad P(\\xi_2=0)=p$$\n$$P_{\\text{情况2}}=p(1-p)\\cdot p(1-p)\\cdot p=p^3(1-p)^2.$$\n\n将两种情况相加得到\n$$P(T=3)=2\\,p^3(1-p)^2.$$", "answer": "$$\\boxed{2p^3(1-p)^2}$$", "id": "700695"}]}