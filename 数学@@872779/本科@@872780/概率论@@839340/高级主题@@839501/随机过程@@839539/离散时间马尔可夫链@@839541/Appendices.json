{"hands_on_practices": [{"introduction": "第一个练习将带你实践离散时间马尔可夫链的基本运算。通过计算经过特定步数后的状态分布，你将学会如何将初始概率分布与转移矩阵相结合，来预测系统的未来状态。这项技能对于理解马尔可夫链如何随时间演化至关重要。[@problem_id:1297401]", "problem": "一个数据科学团队正在开发一个简化模型，用于预测一个新社交媒体平台上的用户参与度。该模型假设在任何给定的时间步长，用户可以处于两种状态之一：状态1（“活跃浏览”）或状态2（“考虑离开”）。在向用户展示每一条新内容后，都会重新评估用户的状态。\n\n状态之间的转换被建模为一个离散时间马尔可夫链，遵循以下规则：\n- 如果用户处于“活跃浏览”状态（状态1），下一条内容将以 $\\alpha$ 的概率使他们保持在该状态。\n- 如果用户处于“考虑离开”状态（状态2），会使用一种特殊的“再参与”算法。所展示的内容将以 $\\beta$ 的概率成功地将他们转换回“活跃浏览”状态（状态1）。\n\n假设 $0  \\alpha  1$ 和 $0  \\beta  1$。\n\n一个新用户在该平台上开始一个会话。他们处于“活跃浏览”状态的初始概率为 $p_0$，因此他们处于“考虑离开”状态的概率为 $1-p_0$。\n\n确定在向用户展示了恰好两条内容后，其状态的概率分布。你的答案应该是一个包含两个分量的行向量，其中第一个分量是处于状态1的概率，第二个分量是处于状态2的概率。用 $\\alpha$、$\\beta$ 和 $p_0$ 表示你的答案。", "solution": "令马尔可夫链的状态空间为 $S = \\{1, 2\\}$，其中状态1表示“活跃浏览”，状态2表示“考虑离开”。\n\n首先，我们定义初始概率分布向量 $\\pi^{(0)}$。根据题意，处于状态1的初始概率为 $p_0$，处于状态2的初始概率为 $1-p_0$。\n$$\n\\pi^{(0)} = \\begin{pmatrix} p_0  1-p_0 \\end{pmatrix}\n$$\n\n接下来，我们构造一步转移概率矩阵 $P$。元素 $P_{ij}$ 表示从状态 $i$ 转移到状态 $j$ 的概率。\n根据问题描述：\n- 从状态1转移到状态1的概率是 $P_{11} = \\alpha$。\n- 由于任何一行的概率之和必须为1，从状态1转移到状态2的概率是 $P_{12} = 1 - \\alpha$。\n- 从状态2转移到状态1的概率是 $P_{21} = \\beta$。\n- 同样地，保持在状态2的概率是 $P_{22} = 1 - \\beta$。\n\n因此，转移矩阵 $P$ 为：\n$$\nP = \\begin{pmatrix}\nP_{11}  P_{12} \\\\\nP_{21}  P_{22}\n\\end{pmatrix} = \\begin{pmatrix}\n\\alpha  1-\\alpha \\\\\n\\beta  1-\\beta\n\\end{pmatrix}\n$$\n\n经过 $n$ 步后的概率分布 $\\pi^{(n)}$ 由方程 $\\pi^{(n)} = \\pi^{(0)} P^n$ 给出。我们需要找到两步后的分布 $\\pi^{(2)}$，其计算公式为 $\\pi^{(2)} = \\pi^{(0)} P^2$。\n\n首先，让我们计算两步转移矩阵 $P^2 = P \\times P$。\n$$\nP^2 = \\begin{pmatrix}\n\\alpha  1-\\alpha \\\\\n\\beta  1-\\beta\n\\end{pmatrix}\n\\begin{pmatrix}\n\\alpha  1-\\alpha \\\\\n\\beta  1-\\beta\n\\end{pmatrix}\n$$\n$P^2$ 的分量是：\n$$\n(P^2)_{11} = (\\alpha)(\\alpha) + (1-\\alpha)(\\beta) = \\alpha^2 + \\beta - \\alpha\\beta\n$$\n$$\n(P^2)_{12} = (\\alpha)(1-\\alpha) + (1-\\alpha)(1-\\beta) = \\alpha - \\alpha^2 + 1 - \\beta - \\alpha + \\alpha\\beta = 1 - \\alpha^2 - \\beta + \\alpha\\beta\n$$\n$$\n(P^2)_{21} = (\\beta)(\\alpha) + (1-\\beta)(\\beta) = \\alpha\\beta + \\beta - \\beta^2\n$$\n$$\n(P^2)_{22} = (\\beta)(1-\\alpha) + (1-\\beta)(1-\\beta) = \\beta - \\alpha\\beta + 1 - 2\\beta + \\beta^2 = 1 - \\beta - \\alpha\\beta + \\beta^2\n$$\n所以，两步转移矩阵是：\n$$\nP^2 = \\begin{pmatrix}\n\\alpha^2 + \\beta - \\alpha\\beta  1 - \\alpha^2 - \\beta + \\alpha\\beta \\\\\n\\alpha\\beta + \\beta - \\beta^2  1 - \\alpha\\beta - \\beta + \\beta^2\n\\end{pmatrix}\n$$\n\n现在我们可以计算 $\\pi^{(2)} = \\pi^{(0)} P^2$。\n$$\n\\pi^{(2)} = \\begin{pmatrix} \\pi_1^{(2)}  \\pi_2^{(2)} \\end{pmatrix} = \\begin{pmatrix} p_0  1-p_0 \\end{pmatrix} \\begin{pmatrix}\n(P^2)_{11}  (P^2)_{12} \\\\\n(P^2)_{21}  (P^2)_{22}\n\\end{pmatrix}\n$$\n第一个分量 $\\pi_1^{(2)}$，即两步后处于状态1的概率，是：\n$$\n\\pi_1^{(2)} = p_0 (P^2)_{11} + (1-p_0) (P^2)_{21}\n$$\n$$\n\\pi_1^{(2)} = p_0 (\\alpha^2 + \\beta - \\alpha\\beta) + (1-p_0) (\\alpha\\beta + \\beta - \\beta^2)\n$$\n展开这个表达式：\n$$\n\\pi_1^{(2)} = p_0 \\alpha^2 + p_0 \\beta - p_0 \\alpha\\beta + \\alpha\\beta + \\beta - \\beta^2 - p_0 \\alpha\\beta - p_0 \\beta + p_0 \\beta^2\n$$\n$p_0 \\beta$ 和 $-p_0 \\beta$ 项相互抵消。将剩余项分组：\n$$\n\\pi_1^{(2)} = p_0 \\alpha^2 - 2 p_0 \\alpha\\beta + p_0 \\beta^2 + \\alpha\\beta + \\beta - \\beta^2\n$$\n我们可以从前三项中提取因子 $p_0$，从后三项中提取因子 $\\beta$：\n$$\n\\pi_1^{(2)} = p_0 (\\alpha^2 - 2\\alpha\\beta + \\beta^2) + \\beta(\\alpha + 1 - \\beta)\n$$\n识别出完全平方，我们得到第一个分量的简化表达式：\n$$\n\\pi_1^{(2)} = p_0 (\\alpha-\\beta)^2 + \\beta(1+\\alpha-\\beta)\n$$\n第二个分量 $\\pi_2^{(2)}$ 是处于状态2的概率。因为只有两个状态，概率之和必须为1，所以 $\\pi_2^{(2)} = 1 - \\pi_1^{(2)}$。\n$$\n\\pi_2^{(2)} = 1 - \\left[ p_0 (\\alpha-\\beta)^2 + \\beta(1+\\alpha-\\beta) \\right]\n$$\n$$\n\\pi_2^{(2)} = 1 - p_0 (\\alpha-\\beta)^2 - \\beta(1+\\alpha-\\beta)\n$$\n因此，两步后的概率分布为 $\\pi^{(2)} = \\begin{pmatrix} \\pi_1^{(2)}  \\pi_2^{(2)} \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\np_0 (\\alpha-\\beta)^2 + \\beta(1+\\alpha-\\beta)  1 - p_0 (\\alpha-\\beta)^2 - \\beta(1+\\alpha-\\beta)\n\\end{pmatrix}\n}\n$$", "id": "1297401"}, {"introduction": "这个练习将引导你超越简单的概率计算，探索马尔可夫链的一个关键结构特性：状态的周期性。理解周期——即一个状态可以被重复访问的规律性时间间隔——对于状态分类和分析链的长期行为至关重要。本练习通过一个机器人在正方形上移动的直观场景，将这个抽象概念具体化。[@problem_id:1297460]", "problem": "一个小型自动清洁机器人在一个大型方形太阳能电池板装置上运行。在这个正方形的四个角上，各有一个充电站。我们可以按顺时针方向将这些站点标记为 $S_1, S_2, S_3,$ 和 $S_4$。\n\n机器人的移动可以被建模为一个离散时间马尔可夫链。在每个时间步，机器人从一个站点移动到相邻的站点。由于轻微的机械偏差，机器人的移动不是均匀随机的。从任何给定的站点出发，机器人以 $p = 3/5$ 的概率移动到顺时针方向的下一个站点，并以 $1-p = 2/5$ 的概率移动到逆时针方向的下一个站点。例如，从站点 $S_1$ 出发，它将以 $3/5$ 的概率移动到 $S_2$，或以 $2/5$ 的概率移动到 $S_4$。机器人在单一步骤内不能停留在同一站点或移动到对角线相对的站点。\n\n在马尔可夫链中，一个状态的周期定义为从该状态出发，返回到该状态所有可能步数的最大公约数。\n\n确定对应于机器人在站点 $S_1$ 的状态的周期。", "solution": "我们将机器人建模为状态空间 $\\{S_{1},S_{2},S_{3},S_{4}\\}$ 上的一个离散时间马尔可夫链，其中从任何状态出发，机器人以正概率移动到其两个相邻状态之一：顺时针方向的概率为 $p=\\frac{3}{5}$，逆时针方向的概率为 $1-p=\\frac{2}{5}$。因此，从每个站点出发恰好有两个出向转移，且两者概率都为正。\n\n状态 $i$ 的周期 $d(i)$ 定义为\n$$\nd(i)=\\gcd\\{n\\geq 1: P_{ii}^{(n)}0\\},\n$$\n其中 $P_{ii}^{(n)}$ 是返回状态 $i$ 的 $n$ 步返回概率。\n\n首先，观察到其基础图是一个4-圈，它是一个二分图，其二分划分为 $\\{S_{1},S_{3}\\}$ 和 $\\{S_{2},S_{4}\\}$。每一次移动都会切换划分中的部分，因为机器人总是移动到相邻的站点且不能停留在原地。因此，从 $S_{1}\\in\\{S_{1},S_{3}\\}$ 出发，经过奇数步后，机器人必定位于 $\\{S_{2},S_{4}\\}$ 中，而不可能在 $S_{1}$。因此，对所有奇数 $n$，都有\n$$\nP_{11}^{(n)}=0.\n$$\n\n接下来，我们证明在偶数步时返回是以正概率发生的。在 $2$ 步内，可以走路径 $S_{1}\\to S_{2}\\to S_{1}$，其概率为 $p(1-p)0$；或者走路径 $S_{1}\\to S_{4}\\to S_{1}$，其概率为 $(1-p)p0$。所以\n$$\nP_{11}^{(2)}\\geq p(1-p)+(1-p)p=2p(1-p)0.\n$$\n对于任何偶数 $n=2k$，可以将一个2步的往返路径重复 $k$ 次（例如，$(S_{1}\\to S_{2}\\to S_{1})^{k}$），其概率为 $\\left(p(1-p)\\right)^{k}0$。因此，对于每个偶数 $n$，有\n$$\nP_{11}^{(2k)}\\geq \\left(p(1-p)\\right)^{k}0.\n$$\n\n结合这两个事实，集合 $\\{n\\geq 1: P_{11}^{(n)}0\\}$ 正是所有正偶数的集合。其最大公约数为\n$$\n\\gcd\\{2,4,6,\\dots\\}=2.\n$$\n因此，状态 $S_{1}$ 的周期是 $2$。", "answer": "$$\\boxed{2}$$", "id": "1297460"}, {"introduction": "本练习介绍了一种强大的技术，称为“首步分析法”，用于解答更细致的问题，例如在到达某个状态之前先到达另一个状态的概率。你将基于第一步转移的各种可能结果，建立并求解一个线性方程组。这种方法是计算击中概率的基础，并广泛应用于涉及吸收态的问题中。[@problem_id:1297439]", "problem": "一个工业机械设备运行状态的简化模型由一个状态空间为 $S = \\{1, 2, 3, 4\\}$ 的离散时间马尔可夫链描述。状态定义如下：\n- 状态 1：维修中\n- 状态 2：空闲\n- 状态 3：运行\n- 状态 4：严重故障\n\n每小时结束时观察一次机械设备的状态。一旦机器进入状态 1 或状态 4，它将保持在该状态。对于其他状态，一步转移概率如下：\n\n从状态 2 (空闲) 出发，机器转移到：\n- 状态 1，概率为 $p_{21} = 0.1$\n- 状态 2，概率为 $p_{22} = 0.5$\n- 状态 3，概率为 $p_{23} = 0.3$\n- 状态 4，概率为 $p_{24} = 0.1$\n\n从状态 3 (运行) 出发，机器转移到：\n- 状态 1，概率为 $p_{31} = 0.2$\n- 状态 2，概率为 $p_{32} = 0.4$\n- 状态 3，概率为 $p_{33} = 0.1$\n- 状态 4，概率为 $p_{34} = 0.3$\n\n假设机器当前处于空闲状态 (状态 2)。计算它在进入维修中状态 (状态 1) 之前进入严重故障状态 (状态 4) 的概率。请用精确分数表示你的答案。", "solution": "我们使用吸收马尔可夫链中的击中概率来为在到达状态 1 (维修中) 之前到达状态 4 (严重故障) 的事件建模。设 $h_{i}$ 表示从状态 $i$ 出发，链在到达状态 $1$ 之前到达状态 $4$ 的概率。由于状态 $1$ 和状态 $4$ 是吸收态，边界条件为 $h_{1}=0$ 和 $h_{4}=1$。对暂态 $2$ 和 $3$ 进行首步分析，我们有\n$$\nh_{2} = p_{22} h_{2} + p_{23} h_{3} + p_{24}\\cdot 1 + p_{21}\\cdot 0,\n\\quad\nh_{3} = p_{32} h_{2} + p_{33} h_{3} + p_{34}\\cdot 1 + p_{31}\\cdot 0.\n$$\n代入给定的转移概率，写成精确分数形式，\n$$\nh_{2} = \\frac{1}{2} h_{2} + \\frac{3}{10} h_{3} + \\frac{1}{10}, \n\\quad\nh_{3} = \\frac{2}{5} h_{2} + \\frac{1}{10} h_{3} + \\frac{3}{10}.\n$$\n整理得，\n$$\n\\left(1 - \\frac{1}{2}\\right) h_{2} - \\frac{3}{10} h_{3} = \\frac{1}{10},\n\\quad\n-\\frac{2}{5} h_{2} + \\left(1 - \\frac{1}{10}\\right) h_{3} = \\frac{3}{10},\n$$\n化简为\n$$\n\\frac{1}{2} h_{2} - \\frac{3}{10} h_{3} = \\frac{1}{10},\n\\quad\n-\\frac{2}{5} h_{2} + \\frac{9}{10} h_{3} = \\frac{3}{10}.\n$$\n将两个方程都乘以 $10$ 得\n$$\n5 h_{2} - 3 h_{3} = 1,\n\\quad\n-4 h_{2} + 9 h_{3} = 3.\n$$\n由第一个方程可得 $h_{2} = \\frac{1 + 3 h_{3}}{5}$。代入第二个方程，\n$$\n-4 \\cdot \\frac{1 + 3 h_{3}}{5} + 9 h_{3} = 3\n\\;\\Rightarrow\\;\n-\\frac{4}{5} - \\frac{12}{5} h_{3} + 9 h_{3} = 3\n\\;\\Rightarrow\\;\n\\frac{33}{5} h_{3} - \\frac{4}{5} = 3.\n$$\n乘以 $5$ 得，\n$$\n33 h_{3} - 4 = 15 \\;\\Rightarrow\\; 33 h_{3} = 19 \\;\\Rightarrow\\; h_{3} = \\frac{19}{33}.\n$$\n则\n$$\nh_{2} = \\frac{1 + 3 \\cdot \\frac{19}{33}}{5} = \\frac{\\frac{33}{33} + \\frac{57}{33}}{5} = \\frac{\\frac{90}{33}}{5} = \\frac{90}{165} = \\frac{6}{11}.\n$$\n因此，从状态 2 (空闲) 出发，在进入状态 1 (维修中) 之前进入状态 4 (严重故障) 的概率是 $\\frac{6}{11}$。", "answer": "$$\\boxed{\\frac{6}{11}}$$", "id": "1297439"}]}