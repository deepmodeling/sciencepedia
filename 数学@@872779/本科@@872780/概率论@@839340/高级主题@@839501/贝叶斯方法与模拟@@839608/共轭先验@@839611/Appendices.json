{"hands_on_practices": [{"introduction": "贝叶斯推断的核心在于利用新数据更新我们已有的信念。本练习将通过一个经典的A/B测试场景，带你实践最常见的共轭先验组合之一：Beta-二项分布模型。你将学习如何将关于点击率的先验信念（用Beta分布表示）与观测到的点击数据（服从二项分布）相结合，从而得到一个更新后的后验分布，这是掌握贝叶斯分析的基础一步。[@problem_id:1909036]", "problem": "一家电子商务公司正在进行一项 A/B 测试，以评估其“添加到购物车”按钮的新设计。关键指标是点击率，即看到该按钮的用户点击它的概率 $p$。\n\n在进行实验之前，产品管理团队使用参数为 $\\alpha = 2$ 和 $\\beta = 18$ 的贝塔分布来量化他们关于 $p$ 的先验信念。\n\n然后，公司进行了一项实验，将新的按钮设计展示给 $n=100$ 名随机选择的用户。在这些用户中，观察到有 $k=15$ 人点击了该按钮。\n\n假设点击次数服从二项分布，并使用团队的贝塔先验，关于 $p$ 的更新后的信念由一个后验分布来描述。这个后验分布也是一个贝塔分布，其新参数我们称之为 $\\alpha_{post}$ 和 $\\beta_{post}$。\n\n以下哪项代表了正确的后验超参数对 $(\\alpha_{post}, \\beta_{post})$？\n\nA. $(17, 103)$\n\nB. $(87, 33)$\n\nC. $(16, 86)$\n\nD. $(17, 85)$\n\nE. $(2, 18)", "solution": "这个问题要求我们通过将贝塔先验与二项似然相结合，来求出概率 $p$ 的后验分布的参数。这是一个使用共轭先验进行贝叶斯推断的经典例子。\n\n其核心原理是贝叶斯定理，该定理指出后验分布与数据的似然和参数的先验分布的乘积成正比。\n$$\n\\text{Posterior} \\propto \\text{Likelihood} \\times \\text{Prior}\n$$\n\n让我们为我们的具体问题定义各个组成部分。\n\n首先，概率 $p$ 的**先验分布**是一个贝塔分布，即 $p \\sim \\text{Beta}(\\alpha, \\beta)$。贝塔分布的概率密度函数（PDF）是：\n$$\nf(p; \\alpha, \\beta) = \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)} p^{\\alpha-1} (1-p)^{\\beta-1}\n$$\n对于我们的分析，我们只需要分布的核，它包含函数中依赖于参数 $p$ 的部分。贝塔先验的核是：\n$$\nf(p; \\alpha, \\beta) \\propto p^{\\alpha-1} (1-p)^{\\beta-1}\n$$\n我们已知的先验超参数是 $\\alpha = 2$ 和 $\\beta = 18$。\n\n其次，**似然函数**是从实验数据中导出的。数据包括在 $n$ 次独立试验（用户）中观察到 $k$ 次成功（点击）。这可以用二项分布来建模，即 $k \\sim \\text{Binomial}(n, p)$。二项分布的概率质量函数给出了在给定 $p$ 的情况下观察到 $k$ 次成功的似然：\n$$\nL(p | k, n) = \\binom{n}{k} p^k (1-p)^{n-k}\n$$\n同样，我们只关心依赖于 $p$ 的部分，所以似然的核是：\n$$\nL(p | k, n) \\propto p^k (1-p)^{n-k}\n$$\n我们已知的实验数据是 $n = 100$ 和 $k = 15$。\n\n现在，我们应用贝叶斯定理来求后验分布 $p(p | k, n, \\alpha, \\beta)$：\n$$\np(p | \\text{data}) \\propto L(p | \\text{data}) \\times f(p)\n$$\n代入似然和先验的核：\n$$\np(p | k, n, \\alpha, \\beta) \\propto \\left( p^k (1-p)^{n-k} \\right) \\times \\left( p^{\\alpha-1} (1-p)^{\\beta-1} \\right)\n$$\n我们可以通过将指数相加来合并这些项：\n$$\np(p | k, n, \\alpha, \\beta) \\propto p^{k + \\alpha - 1} (1-p)^{n - k + \\beta - 1}\n$$\n这个结果的函数形式是另一个贝塔分布的核。一个参数为 $\\alpha_{post}$ 和 $\\beta_{post}$ 的通用贝塔分布，其核正比于 $p^{\\alpha_{post}-1} (1-p)^{\\beta_{post}-1}$。\n\n通过将我们推导出的后验核与通用的贝塔核进行比较，我们可以确定后验超参数：\n$$\n\\alpha_{post} - 1 = k + \\alpha - 1 \\implies \\alpha_{post} = k + \\alpha\n$$\n$$\n\\beta_{post} - 1 = n - k + \\beta - 1 \\implies \\beta_{post} = n - k + \\beta\n$$\n这些是贝塔-二项共轭对的一般更新规则。\n\n最后，我们代入问题中给出的数值：\n- 先验超参数：$\\alpha = 2$, $\\beta = 18$\n- 数据：$n = 100$, $k = 15$\n\n后验超参数 $\\alpha_{post}$ 是：\n$$\n\\alpha_{post} = 15 + 2 = 17\n$$\n后验超参数 $\\beta_{post}$ 是：\n$$\n\\beta_{post} = (100 - 15) + 18 = 85 + 18 = 103\n$$\n因此，后验分布是一个参数为 $\\alpha_{post} = 17$ 和 $\\beta_{post} = 103$ 的贝塔分布。后验超参数对是 $(17, 103)$。\n\n这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1909036"}, {"introduction": "共轭先验的应用不仅限于分析比例或概率。当我们处理的数据是关于事件发生的速率时，例如单位时间内的邮件到达数，可以使用另一对强大的共轭组合：Gamma-泊松分布模型。这个练习将向你展示如何为一个服从泊松分布的事件发生率（$\\lambda$）设定一个Gamma先验，并根据观测数据来更新我们对这个速率的估计。[@problem_id:1909064]", "problem": "一位数据科学家正在为一名公司员工接收电子邮件的速率建模。电子邮件的到达被假定遵循泊松过程。未知的平均电子邮件到达率 $\\lambda$ 以每小时的邮件数来衡量。\n\n该数据科学家对 $\\lambda$ 的先验信念由一个伽马分布建模，其形状参数 $\\alpha = 10$，率参数 $\\beta = 2$。这个伽马($\\alpha, \\beta$)分布的概率密度函数由下式给出：\n$$p(\\lambda) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda) \\quad \\text{for } \\lambda > 0$$\n\n为了更新这一信念，该数据科学家在 $T = 8$ 小时的时间段内观察该员工。在此观察期间，该员工总共收到了 $n = 52$ 封电子邮件。\n\n假设在 $T$ 小时内收到的电子邮件数量遵循参数为 $\\lambda T$ 的泊松分布，计算平均每小时电子邮件速率的更新估计值，即 $\\lambda$ 的后验分布的均值。答案以每小时邮件数表示，并四舍五入到三位有效数字。", "solution": "问题要求计算电子邮件到达率 $\\lambda$ 的后验分布的均值。我们可以使用贝叶斯定理来找到后验分布，该定理指出后验分布正比于似然函数与先验分布的乘积。\n\n设观测数据为 $D$，即在 $T=8$ 小时内观测到 $n=52$ 封电子邮件。根据贝叶斯定理：\n$$p(\\lambda | D) \\propto P(D | \\lambda) \\times p(\\lambda)$$\n此处，$p(\\lambda | D)$ 是后验分布，$P(D | \\lambda)$ 是似然函数，而 $p(\\lambda)$ 是先验分布。\n\n首先，我们定义似然函数。假设在时间间隔 $T$ 内的电子邮件数量 $n$ 遵循参数为 $\\lambda T$ 的泊松分布。泊松分布的概率质量函数为 $P(k; \\mu) = \\frac{\\mu^k e^{-\\mu}}{k!}$。因此，在 $T=8$ 小时内观测到 $n=52$ 封电子邮件的似然性是：\n$$L(\\lambda; n, T) = P(n | \\lambda, T) = \\frac{(T\\lambda)^n}{n!} \\exp(-T\\lambda)$$\n\n接下来，我们定义先验分布。$\\lambda$ 的先验分布是形状参数 $\\alpha=10$ 和率参数 $\\beta=2$ 的伽马分布：\n$$p(\\lambda) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda)$$\n\n现在，我们通过将似然函数与先验分布相乘来计算后验分布。我们可以忽略任何不依赖于 $\\lambda$ 的常数因子，因为它们将被吸收到后验分布的归一化常数中。\n$$p(\\lambda | n, T) \\propto \\left( \\frac{(T\\lambda)^n}{n!} \\exp(-T\\lambda) \\right) \\times \\left( \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda) \\right)$$\n去掉常数 $\\frac{T^n}{n!}$ 和 $\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}$：\n$$p(\\lambda | n, T) \\propto (\\lambda^n \\exp(-T\\lambda)) \\times (\\lambda^{\\alpha-1} \\exp(-\\beta \\lambda))$$\n合并包含 $\\lambda$ 的项：\n$$p(\\lambda | n, T) \\propto \\lambda^n \\lambda^{\\alpha-1} \\exp(-T\\lambda) \\exp(-\\beta \\lambda)$$\n$$p(\\lambda | n, T) \\propto \\lambda^{n+\\alpha-1} \\exp(-(T+\\beta)\\lambda)$$\n\n这个结果的函数形式是伽马分布的核。这意味着后验分布也是一个伽马分布。一个分布 $f(x) \\propto x^{a-1} \\exp(-bx)$ 是一个形状参数为 $a$、率参数为 $b$ 的伽马分布。通过比较指数，我们可以确定后验分布的参数，我们称之为 $\\alpha'$ 和 $\\beta'$：\n形状参数：$\\alpha' = n + \\alpha$\n率参数：$\\beta' = T + \\beta$\n\n现在，我们代入给定的数值：\n$\\alpha = 10$\n$\\beta = 2$\n$n = 52$\n$T = 8$\n\n后验伽马分布的参数是：\n$\\alpha' = 52 + 10 = 62$\n$\\beta' = 8 + 2 = 10$\n\n因此，$\\lambda$ 的后验分布是形状为 $\\alpha' = 62$、率为 $\\beta' = 10$ 的伽马分布。\n$$\\lambda | n, T \\sim \\text{Gamma}(62, 10)$$\n\n问题要求计算这个后验分布的均值。形状参数为 $a$、率参数为 $b$ 的伽马分布的均值由公式 $E[\\lambda] = \\frac{a}{b}$ 给出。\n因此，$\\lambda$ 的后验均值是：\n$$E[\\lambda | n, T] = \\frac{\\alpha'}{\\beta'} = \\frac{62}{10} = 6.2$$\n\n问题要求答案四舍五入到三位有效数字。计算值为 6.2，表示为三位有效数字是 6.20。单位是指定的每小时邮件数。", "answer": "$$\\boxed{6.20}$$", "id": "1909064"}, {"introduction": "在贝叶斯分析中，选择先验分布是表达初始信念的关键步骤，而不同的先验选择会影响最终的推断结果。本练习通过对比两种不同的先验信念——“无差别”的均匀先验和“持怀疑态度”的U形先验——来探索这一思想。通过分析在观察到相同数据后，这两种先验如何演变成不同的后验分布，你将更深刻地理解先验知识在塑造最终结论中的重要作用。[@problem_id:1352199]", "problem": "一位数据科学家正在为一个新的网站横幅广告建立点击率模型，该点击率记为 $\\theta$。用户点击该横幅广告的事件可以被建模为一个伯努利试验 (Bernoulli trial)，其成功概率 $\\theta$ 未知。在收集任何数据之前，该数据科学家考虑了关于 $\\theta$ 的两种不同的先验信念。\n\n信念A，一种“无差异”先验，假设 $\\theta$ 在0和1之间的所有值都是等可能的。该信念由一个参数为 $\\alpha_A = 1$ 和 $\\beta_A = 1$ 的贝塔分布 (Beta distribution) 表示。\n\n信念B，一种“怀疑”先验，假设点击率可能非常低或非常高，但不太可能在中间。该信念由一个参数为 $\\alpha_B = 0.5$ 和 $\\beta_B = 0.5$ 的贝塔分布表示。\n\n然后，该科学家进行了一个实验，将该横幅广告展示给 $N=10$ 位用户。在这 $10$ 次试验中，有 $k=3$ 次点击（成功）和 $7$ 次失败。\n\n利用这些数据，科学家更新了两种先验信念，从而获得了关于 $\\theta$ 的两个独立的后验分布。令 $M_A$ 为从信念A推导出的后验分布的众数（最可能的值），令 $M_B$ 为从信念B推导出的后验分布的众数。\n\n计算比率 $\\frac{M_B}{M_A}$。将你的答案表示为一个单一的、简化的分数。", "solution": "我们将点击建模为成功概率未知的伯努利试验，并因其与二项式似然的共轭性而使用贝塔先验。对于一个贝塔先验 $\\operatorname{Beta}(\\alpha,\\beta)$，在观察到 $k$ 次成功和 $N-k$ 次失败后进行更新，其后验分布为 $\\operatorname{Beta}(\\alpha+k,\\beta+N-k)$。当 $a>1$ 且 $b>1$ 时，$\\operatorname{Beta}(a,b)$ 分布的众数由下式给出：\n$$\n\\frac{a-1}{a+b-2}.\n$$\n\n信念A的先验分布为 $\\operatorname{Beta}(\\alpha_{A},\\beta_{A})=\\operatorname{Beta}(1,1)$。根据 $k=3$ 和 $N=10$ 的数据，后验分布为\n$$\n\\operatorname{Beta}(1+3,\\,1+10-3)=\\operatorname{Beta}(4,8).\n$$\n由于两个参数都大于 $1$，其众数为\n$$\nM_{A}=\\frac{4-1}{4+8-2}=\\frac{3}{10}.\n$$\n\n信念B的先验分布为 $\\operatorname{Beta}(\\alpha_{B},\\beta_{B})=\\operatorname{Beta}(0.5,0.5)$。根据相同的数据，后验分布为\n$$\n\\operatorname{Beta}(0.5+3,\\,0.5+10-3)=\\operatorname{Beta}(3.5,7.5).\n$$\n同样，两个参数都大于 $1$，所以其众数为\n$$\nM_{B}=\\frac{3.5-1}{3.5+7.5-2}=\\frac{2.5}{9}=\\frac{5}{18}.\n$$\n\n所要求的比率为\n$$\n\\frac{M_{B}}{M_{A}}=\\frac{\\frac{5}{18}}{\\frac{3}{10}}=\\frac{5}{18}\\cdot\\frac{10}{3}=\\frac{50}{54}=\\frac{25}{27}.\n$$", "answer": "$$\\boxed{\\frac{25}{27}}$$", "id": "1352199"}]}