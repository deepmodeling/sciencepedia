{"hands_on_practices": [{"introduction": "Metropolis-Hastings算法的核心是接受概率，它决定了是否接受一个提议的移动。第一个练习提供了一个具体的情境，让你计算这个概率，帮助你直观地理解算法如何通过偏爱向更高概率区域移动来探索目标分布。掌握这个计算是理解MCMC采样的第一步。[@problem_id:1371728]", "problem": "一位数据科学家正在实现一个马尔可夫链蒙特卡洛 (MCMC) 模拟，以便从参数 $x$ 的后验概率分布中抽取样本。目标分布 $\\pi(x)$ 与参数负绝对值的指数成正比，即 $\\pi(x) \\propto \\exp(-|x|)$。\n\n该科学家使用梅特罗波利斯算法和一个对称的提议分布 $q(x'|x)$，其中在给定当前状态 $x$ 的情况下提议一个新状态 $x'$ 的概率，等于在给定 $x'$ 的情况下提议 $x$ 的概率（即 $q(x'|x) = q(x|x')$）。\n\n假设在模拟的某一步中，链的当前状态为 $x = 1.5$。算法接着提议转移到一个新的候选状态 $x' = 2.0$。\n\n计算这次特定转移的接受概率。你的答案应该是一个无量纲的实数。将你的最终答案四舍五入到四位有效数字。", "solution": "对于从 $x$ 到 $x'$ 的一次转移，当提议分布为对称分布 $q(x'|x)=q(x|x')$ 时，其梅特罗波利斯接受概率为\n$$\n\\alpha(x \\to x')=\\min\\left(1,\\frac{\\pi(x')q(x|x')}{\\pi(x)q(x'|x)}\\right)=\\min\\left(1,\\frac{\\pi(x')}{\\pi(x)}\\right).\n$$\n给定目标分布 $\\pi(x)\\propto \\exp(-|x|)$，该比率可简化为\n$$\n\\frac{\\pi(x')}{\\pi(x)}=\\frac{\\exp(-|x'|)}{\\exp(-|x|)}=\\exp\\!\\left(-\\left(|x'|-|x|\\right)\\right).\n$$\n当 $x=1.5$ 且 $x'=2.0$ 时，我们有 $|x|=1.5$ 和 $|x'|=2.0$，所以\n$$\n\\frac{\\pi(x')}{\\pi(x)}=\\exp\\!\\left(-\\left(2.0-1.5\\right)\\right)=\\exp(-0.5).\n$$\n因此，\n$$\n\\alpha(x \\to x')=\\min\\left(1,\\exp(-0.5)\\right)=\\exp(-0.5).\n$$\n数值上，$\\exp(-0.5)\\approx 0.6065$（四舍五入到四位有效数字）。", "answer": "$$\\boxed{0.6065}$$", "id": "1371728"}, {"introduction": "在计算接受概率的基础上，我们可以构建马尔可夫链的完整转移矩阵。这个练习将从单一的数值计算转向在离散状态空间上的通用推导，展示了提议机制和目标分布如何共同定义链的动态。理解如何推导这些转移概率是分析MCMC算法行为的关键。[@problem_id:791812]", "problem": "考虑一个定义在离散状态空间 $S = \\{1, 2, 3\\}$ 上的马尔可夫链。该链是使用Metropolis-Hastings算法从目标概率质量函数（PMF）$\\pi = (\\pi_1, \\pi_2, \\pi_3)$ 中抽样而构建的。已知目标概率与一组未归一化的权重 $(w_1, w_2, w_3) = (1, \\alpha, \\alpha^2)$ 成正比，其中 $\\alpha$ 是一个满足 $\\alpha  1$ 的实值参数。也就是说，对于 $i \\in S$，有 $\\pi_i \\propto w_i$。\n\nMetropolis-Hastings算法的提议机制由一个提议分布 $q(j|i)$ 定义，该分布给出了在当前状态为 $i$ 的情况下，提议转移到状态 $j$ 的概率。对于该系统，提议分布是对称的，定义如下：从任意当前状态 $i$，以相等的概率向另外两个状态 $j \\neq i$ 中的一个进行提议。从不提议停留在同一状态 $i$，即 $q(i|i)=0$。\n\n设 $P$ 为所得到的Metropolis-Hastings马尔可夫链的转移矩阵，其中 $P_{ij}$ 是在一步内从状态 $i$ 转移到状态 $j$ 的概率。\n\n推导转移概率 $P_{32}$ 关于参数 $\\alpha$ 的表达式。", "solution": "问题要求解Metropolis-Hastings马尔可夫链的转移概率 $P_{32}$。从状态 $i$ 到一个不同状态 $j$ ($i \\neq j$) 的转移概率由提议概率和接受概率的乘积给出：\n$$\nP_{ij} = q(j|i) \\alpha(j|i)\n$$\n在我们的例子中，需要求解 $P_{32}$，因此有：\n$$\nP_{32} = q(2|3) \\alpha(2|3)\n$$\n\n首先，我们确定提议概率 $q(2|3)$。题目说明，从任意状态（例如状态3），会以相等的概率向另外两个状态（1或2）中的一个进行提议。因此，从状态3提议转移到状态2的概率为：\n$$\nq(2|3) = \\frac{1}{2}\n$$\n\n接下来，我们确定接受概率 $\\alpha(2|3)$。Metropolis-Hastings接受概率的一般公式为：\n$$\n\\alpha(j|i) = \\min\\left(1, \\frac{\\pi_j q(i|j)}{\\pi_i q(j|i)}\\right)\n$$\n我们需要为从 $i=3$ 到 $j=2$ 的转移计算这个值：\n$$\n\\alpha(2|3) = \\min\\left(1, \\frac{\\pi_2 q(3|2)}{\\pi_3 q(2|3)}\\right)\n$$\n提议分布是对称的。从状态2提议转移到状态3的概率是 $q(3|2) = 1/2$，与 $q(2|3)=1/2$ 相同。因为 $q(3|2) = q(2|3)$，提议概率相互抵消，接受概率简化为Metropolis形式：\n$$\n\\alpha(2|3) = \\min\\left(1, \\frac{\\pi_2}{\\pi_3}\\right)\n$$\n目标概率之比 $\\frac{\\pi_2}{\\pi_3}$ 可以通过未归一化权重之比来计算，因为归一化常数会相互抵消：\n$$\n\\frac{\\pi_2}{\\pi_3} = \\frac{w_2}{w_3}\n$$\n题目给出的权重为 $(w_1, w_2, w_3) = (1, \\alpha, \\alpha^2)$。代入这些值：\n$$\n\\frac{w_2}{w_3} = \\frac{\\alpha}{\\alpha^2} = \\frac{1}{\\alpha}\n$$\n所以，接受概率是：\n$$\n\\alpha(2|3) = \\min\\left(1, \\frac{1}{\\alpha}\\right)\n$$\n题目规定参数 $\\alpha  1$。这意味着 $0  \\frac{1}{\\alpha}  1$。因此，$1$ 和 $\\frac{1}{\\alpha}$ 的最小值是 $\\frac{1}{\\alpha}$：\n$$\n\\alpha(2|3) = \\frac{1}{\\alpha}\n$$\n\n最后，我们可以通过结合提议概率和接受概率来计算转移概率 $P_{32}$：\n$$\nP_{32} = q(2|3) \\alpha(2|3) = \\frac{1}{2} \\cdot \\frac{1}{\\alpha} = \\frac{1}{2\\alpha}\n$$", "answer": "$$\n\\boxed{\\frac{1}{2\\alpha}}\n$$", "id": "791812"}, {"introduction": "除了Metropolis-Hastings算法，吉布斯采样是MCMC方法的另一个基石，对于多变量分布尤其强大。实现吉布斯采样的关键是推导每个变量的“全条件分布”。这个练习将引导你为一个简单直观的二元分布推导这些条件分布，这是将吉布斯采样应用于更复杂模型的一项基本技能。[@problem_id:1932854]", "problem": "吉布斯采样（Gibbs sampler）是一种马尔可夫链蒙特卡洛（MCMC）算法，用于生成一个观测序列来近似一个目标多元概率分布，当直接采样困难时，该算法尤其有用。实现吉布斯采样器的一个关键步骤是推导出模型中每个变量的全条件分布。\n\n考虑一个二元随机向量 $(X, Y)$，其联合概率密度函数（PDF）$p(x, y)$在$xy$-平面内的一个三角形区域 $\\mathcal{R}$ 上是均匀的。区域 $\\mathcal{R}$ 由不等式 $x0$，$y0$ 和 $x+y  1$ 定义。因此，联合PDF为：\n$$\np(x, y) =\n\\begin{cases}\n2  \\text{ if } (x,y) \\in \\mathcal{R} \\\\\n0  \\text{ otherwise}\n\\end{cases}\n$$\n为了构造此分布的吉布斯采样器，我们需要全条件分布 $p(x|y)$ 和 $p(y|x)$。\n\n下列哪个选项正确地指出了这两个条件分布？注意，$\\text{Uniform}(a,b)$ 表示在区间 $(a,b)$ 上的均匀分布。\n\nA: 对于 $y \\in (0,1)$，$p(x|y)$ 是 Uniform$(0, 1-y)$ 分布；对于 $x \\in (0,1)$，$p(y|x)$ 是 Uniform$(0, 1-x)$ 分布。\n\nB: 对于 $y \\in (0,1)$，$p(x|y)$ 是 Uniform$(0, 1)$ 分布；对于 $x \\in (0,1)$，$p(y|x)$ 是 Uniform$(0, 1)$ 分布。\n\nC: 对于 $y \\in (0,1)$，$p(x|y)$ 是 Uniform$(0, y)$ 分布；对于 $x \\in (0,1)$，$p(y|x)$ 是 Uniform$(0, x)$ 分布。\n\nD: 条件分布不是均匀分布。\n\nE: 对于 $y \\in (0,1)$，$p(x|y)$ 是 Uniform$(y, 1)$ 分布；对于 $x \\in (0,1)$，$p(y|x)$ 是 Uniform$(x, 1)$ 分布。", "solution": "给定联合概率密度函数（PDF）$p(x, y)$ 在由 $x0$, $y0$ 和 $x+y  1$ 定义的三角形区域 $\\mathcal{R}$ 上是常数。该区域的面积是 $\\frac{1}{2} \\times 1 \\times 1 = \\frac{1}{2}$。由于总概率必须为1，所以联合PDF在 $\\mathcal{R}$ 上的值为 $1 / (\\frac{1}{2}) = 2$。因此，$p(x,y)=2$ 对于 $(x,y) \\in \\mathcal{R}$ 成立，其他地方为0。\n\n要找到全条件分布 $p(x|y)$，我们使用公式 $p(x|y) = \\frac{p(x,y)}{p(y)}$。\n首先，我们需要计算 $Y$ 的边缘PDF，$p(y)$。对于一个固定的 $y \\in (0,1)$，为了使点 $(x,y)$ 位于区域 $\\mathcal{R}$ 内，变量 $x$ 的范围必须是 $0  x  1-y$。\n$$p(y) = \\int_{-\\infty}^{\\infty} p(x,y) \\,dx = \\int_0^{1-y} 2 \\,dx = 2(1-y), \\quad \\text{对于 } y \\in (0,1)$$\n现在，对于一个给定的 $y \\in (0,1)$，条件PDF为：\n$$p(x|y) = \\frac{p(x,y)}{p(y)} = \\frac{2}{2(1-y)} = \\frac{1}{1-y}, \\quad \\text{对于 } x \\in (0, 1-y)$$\n这是在区间 $(0, 1-y)$ 上的均匀分布的PDF。因此，对于 $y \\in (0,1)$，给定 $Y=y$ 时 $X$ 的条件分布是 $\\text{Uniform}(0, 1-y)$。\n\n由于问题定义中 $x$ 和 $y$ 是对称的，我们可以立即推断出，对于一个给定的 $x \\in (0,1)$，给定 $X=x$ 时 $Y$ 的条件分布是 $\\text{Uniform}(0, 1-x)$。\n\n因此，选项A正确地描述了这两个条件分布。", "answer": "$$\\boxed{A}$$", "id": "1932854"}]}