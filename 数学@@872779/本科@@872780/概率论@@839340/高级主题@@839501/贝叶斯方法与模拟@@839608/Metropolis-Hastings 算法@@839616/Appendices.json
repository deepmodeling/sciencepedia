{"hands_on_practices": [{"introduction": "让我们从一个基础练习开始，以巩固我们对Metropolis-Hastings算法核心机制的理解。在这个问题中 [@problem_id:1962612]，我们将为一个对称提议分布计算接受概率，这使我们能专注于目标分布本身的比率。这个计算是Metropolis算法（Metropolis-Hastings算法的一个特例）的基石。", "problem": "一位统计学家正在实施一个马尔可夫链蒙特卡洛 (MCMC) 模拟，以从一个目标概率分布中生成样本。选定的目标分布是泊松分布，该分布用于建模在固定的时间或空间间隔内发生的事件次数 $k$。泊松分布的概率质量函数由下式给出：\n$$ P(k; \\lambda) = \\frac{\\lambda^k e^{-\\lambda}}{k!} $$\n其中 $\\lambda$ 是事件的平均发生率。对于本次特定的模拟，参数被设置为 $\\lambda = 5$。\n\n该模拟使用 Metropolis-Hastings 算法和一个对称提议分布，这意味着从状态 $k_1$ 提议移动到状态 $k_2$ 的概率与从状态 $k_2$ 提议移动到 $k_1$ 的概率相同。\n\n假设链的当前状态是 $k=5$。算法接着提议移动到一个新状态 $k'=6$。\n\n计算这个从 $k=5$ 到 $k'=6$ 的提议移动的接受概率。将您的答案表示为保留三位有效数字的小数。", "solution": "在具有对称提议分布的 Metropolis-Hastings 算法中，从状态 $k$ 提议移动到状态 $k'$ 的接受概率为\n$$\n\\alpha = \\min\\left(1, \\frac{\\pi(k')}{\\pi(k)}\\right),\n$$\n其中 $\\pi(\\cdot)$ 是目标概率质量函数。对于参数为 $\\lambda$ 的泊松分布，其概率质量函数 (PMF) 为\n$$\n\\pi(k) = \\frac{\\lambda^{k} \\exp(-\\lambda)}{k!}.\n$$\n因此，该比率可简化为\n$$\n\\frac{\\pi(k')}{\\pi(k)} = \\frac{\\lambda^{k'} \\exp(-\\lambda) / k'!}{\\lambda^{k} \\exp(-\\lambda) / k!} = \\lambda^{k'-k} \\frac{k!}{k'!}.\n$$\n当 $k=5$，$k'=6$，且 $\\lambda=5$ 时，我们有 $k'-k=1$ 和 $6! = 6 \\cdot 5!$，所以\n$$\n\\frac{\\pi(6)}{\\pi(5)} = \\lambda \\cdot \\frac{5!}{6!} = \\lambda \\cdot \\frac{1}{6} = \\frac{5}{6}.\n$$\n因此，接受概率为\n$$\n\\alpha = \\min\\left(1, \\frac{5}{6}\\right) = \\frac{5}{6}.\n$$\n表示为保留三位有效数字的小数，结果是 $0.833$。", "answer": "$$\\boxed{0.833}$$", "id": "1962612"}, {"introduction": "在许多实际应用中，我们使用的提议分布可能不是对称的。这个练习 [@problem_id:1343415] 将我们带入完整的Metropolis-Hastings框架，其接受概率中包含一个用于处理提议不对称性的“校正因子”。通过这个练习，我们将理解这个校正项如何确保即使提议是不对称的，算法依然能从正确的目标分布中抽样。", "problem": "一位计算物理学家正在开发一个马尔可夫链蒙特卡洛 (MCMC) 模拟，用于从正整数集 $\\mathbb{Z}^+ = \\{1, 2, 3, \\dots\\}$ 上的特定目标概率分布中生成样本。目标分布 $\\pi(k)$ 与 $a^{k-1}$ 成正比，其中 $a$ 为某个常数且 $0  a  1$。也就是说，$\\pi(k) \\propto a^{k-1}$。\n\n该模拟使用 Metropolis-Hastings 算法和随机游走提议机制。从当前状态 $k$ 出发，根据以下规则提议一个候选状态 $j$：\n- 以概率 $p$，提议的候选状态为 $j = k+1$。\n- 以概率 $1-p$，提议的候选状态为 $j = k-1$。\n\n为确保过程保持在正整数上，施加了一个边界条件：如果当前状态为 $k=1$ 且选择了向 $k-1$ 的移动，则提议的候选状态改为 $j=1$。在所有其他情况下，提议过程如上所述。\n\n提议向上移动的概率设置为 $p = \\frac{1}{3}$。\n\n确定目标分布的参数 $a$ 的值，使得从任意状态 $k$ 到状态 $k+1$ 的任何提议移动的 Metropolis-Hastings 接受概率恰好为 $\\frac{1}{2}$。请将您的答案表示为单个数值。", "solution": "我们使用 Metropolis-Hastings 接受概率，对于从状态 $k$ 到状态 $j$ 的提议移动，其公式为\n$$\n\\alpha(k \\to j) = \\min\\left(1, \\frac{\\pi(j)\\, q(k \\mid j)}{\\pi(k)\\, q(j \\mid k)}\\right).\n$$\n目标分布是 $\\mathbb{Z}^{+}$ 上的几何分布，满足 $\\pi(k) \\propto a^{k-1}$ 且 $0  a  1$。\n提议分布为：从状态 $k$ 出发，提议 $j=k+1$ 的概率为 $q(k+1 \\mid k) = p = 1/3$，提议 $j=k-1$ 的概率为 $q(k-1 \\mid k) = 1-p = 2/3$（对于 $k>1$）。\n\n我们要计算从 $k$ 到 $j=k+1$ 的移动的接受概率。我们需要比率 $\\frac{\\pi(k+1)}{\\pi(k)}$ 和 $\\frac{q(k \\mid k+1)}{q(k+1 \\mid k)}$。\n目标分布的比率为：\n$$ \\frac{\\pi(k+1)}{\\pi(k)} = \\frac{a^{(k+1)-1}}{a^{k-1}} = \\frac{a^k}{a^{k-1}} = a. $$\n提议概率的比率为：\n- 从 $k$ 提议 $k+1$ 的概率是 $q(k+1 \\mid k) = p = 1/3$。\n- 从 $k+1$ 提议 $k$ 的概率（即向下移动一步）是 $q(k \\mid k+1) = 1-p = 2/3$。\n\n因此，接受概率为：\n$$\n\\alpha(k \\to k+1) = \\min\\left(1, \\frac{\\pi(k+1)}{\\pi(k)} \\frac{q(k \\mid k+1)}{q(k+1 \\mid k)}\\right) = \\min\\left(1, a \\cdot \\frac{2/3}{1/3}\\right) = \\min(1, 2a).\n$$\n我们被告知这个接受概率恰好等于 $1/2$。\n$$ \\min(1, 2a) = \\frac{1}{2}. $$\n由于 $a>0$，因此 $2a>0$。要使 $\\min(1, 2a)$ 的值等于 $1/2$（小于1），必须有 $2a = 1/2$。\n求解 $a$，我们得到 $a = 1/4$。这个值满足初始条件 $0  a  1$。\n因此，参数 $a$ 的值必须是 $1/4$。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "1343415"}, {"introduction": "Metropolis-Hastings算法的效率在很大程度上取决于提议分布的设计。这个练习 [@problem_id:1962663] 探讨了一个常见且重要的挑战：从变量间存在相关性的多维分布中进行抽样。通过比较两种不同的提议策略，我们将直观地理解为什么一个精心设计的提议对于有效探索整个状态空间至关重要。", "problem": "一位统计学家正在使用 Metropolis-Hastings 算法从 $\\mathbb{R}^2$ 上的一个二元目标分布中抽样，该分布的概率密度函数 (PDF) $\\pi(x, y)$ 正比于\n$$\n\\pi(x, y) \\propto \\exp\\left(-\\frac{x^2 - 2\\rho xy + y^2}{2(1-\\rho^2)}\\right)\n$$\n其中 $\\rho$ 是一个常数相关性参数，满足 $0  \\rho  1$。\n\n马尔可夫链的当前状态是 $(X_t, Y_t) = (c, c)$，其中 $c$ 是一个正常数。考虑了两种不同的对称随机游走提议方案来生成候选状态 $(X', Y')$。\n\n**方案 1：** 生成一个提议状态 $(X'_1, Y'_1)$，使得所走的步长为 $(X'_1 - X_t, Y'_1 - Y_t) = (\\epsilon, -\\epsilon)$，其中 $\\epsilon$ 是一个小的正常数。因此，提议状态为 $(X'_1, Y'_1) = (c+\\epsilon, c-\\epsilon)$。\n\n**方案 2：** 生成一个提议状态 $(X'_2, Y'_2)$，使得所走的步长为 $(X'_2 - X_t, Y'_2 - Y_t) = (\\epsilon, \\epsilon)$，使用相同的常数 $\\epsilon$。因此，提议状态为 $(X'_2, Y'_2) = (c+\\epsilon, c+\\epsilon)$。\n\n设 $\\alpha_1$ 为方案 1 下提议的 Metropolis-Hastings 接受概率，$\\alpha_2$ 为方案 2 下提议的接受概率。确定比率 $R = \\frac{\\alpha_2}{\\alpha_1}$。将您的答案表示为关于 $c$、$\\epsilon$ 和 $\\rho$ 的单个闭式解析表达式。", "solution": "对于对称随机游走的 Metropolis-Hastings 提议，接受概率为 $\\alpha=\\min\\{1, \\pi(x',y')/\\pi(x,y)\\}$。由于两种方案中的提议都是对称的，Hastings 比率被消去，于是\n$$\n\\frac{\\pi(x',y')}{\\pi(c,c)}=\\exp\\left(E(x',y')-E(c,c)\\right),\n$$\n其中对数密度为\n$$\nE(x,y)=-\\frac{x^2-2\\rho xy+y^2}{2(1-\\rho^2)},\n$$\n并且我们定义\n$$\nQ(x,y)=x^2-2\\rho xy+y^2,\\quad E(x,y)=-\\frac{Q(x,y)}{2(1-\\rho^2)}.\n$$\n因此\n$$\n\\ln\\left(\\frac{\\pi(x',y')}{\\pi(c,c)}\\right)=-\\frac{Q(x',y')-Q(c,c)}{2(1-\\rho^2)}.\n$$\n\n在当前状态 $(c,c)$ 下，\n$$\nQ(c,c)=c^2-2\\rho c^2+c^2=2c^2(1-\\rho).\n$$\n\n方案 1：$(x',y')=(c+\\epsilon,c-\\epsilon)$。计算\n$$\nx'^2=c^2+2c\\epsilon+\\epsilon^2,\\quad y'^2=c^2-2c\\epsilon+\\epsilon^2,\\quad x'y'=c^2-\\epsilon^2.\n$$\n因此\n$$\nQ_1=x'^2-2\\rho x'y'+y'^2=(2c^2+2\\epsilon^2)-2\\rho(c^2-\\epsilon^2)=2c^2(1-\\rho)+2\\epsilon^2(1+\\rho).\n$$\n所以\n$$\nQ_1-Q(c,c)=2\\epsilon^2(1+\\rho),\n$$\n并且\n$$\n\\ln\\left(\\frac{\\pi(x'_1,y'_1)}{\\pi(c,c)}\\right)=-\\frac{2\\epsilon^2(1+\\rho)}{2(1-\\rho^2)}=-\\frac{\\epsilon^2}{1-\\rho}.\n$$\n因为当 $0  \\rho  1$ 时，该值为负，所以接受概率为\n$$\n\\alpha_1=\\exp\\left(-\\frac{\\epsilon^2}{1-\\rho}\\right).\n$$\n\n方案 2：$(x',y')=(c+\\epsilon,c+\\epsilon)$。计算\n$$\nx'^2=c^2+2c\\epsilon+\\epsilon^2,\\quad y'^2=c^2+2c\\epsilon+\\epsilon^2,\\quad x'y'=c^2+2c\\epsilon+\\epsilon^2.\n$$\n因此\n$$\nQ_2=x'^2-2\\rho x'y'+y'^2=2(1-\\rho)(c^2+2c\\epsilon+\\epsilon^2),\n$$\n所以\n$$\nQ_2-Q(c,c)=2(1-\\rho)(2c\\epsilon+\\epsilon^2),\n$$\n并且\n$$\n\\ln\\left(\\frac{\\pi(x'_2,y'_2)}{\\pi(c,c)}\\right)=-\\frac{2(1-\\rho)(2c\\epsilon+\\epsilon^2)}{2(1-\\rho^2)}=-\\frac{2c\\epsilon+\\epsilon^2}{1+\\rho}.\n$$\n对于 $c>0, \\epsilon>0, 0  \\rho  1$，该值也为负，所以\n$$\n\\alpha_2=\\exp\\left(-\\frac{2c\\epsilon+\\epsilon^2}{1+\\rho}\\right).\n$$\n\n因此，比率 $R=\\alpha_2/\\alpha_1$ 是\n$$\nR=\\exp\\left(-\\frac{2c\\epsilon+\\epsilon^2}{1+\\rho}+\\frac{\\epsilon^2}{1-\\rho}\\right)\n=\\exp\\left(-\\frac{2c\\epsilon}{1+\\rho}+\\epsilon^2\\left[\\frac{1}{1-\\rho}-\\frac{1}{1+\\rho}\\right]\\right)\n=\\exp\\left(-\\frac{2c\\epsilon}{1+\\rho}+\\frac{2\\rho\\,\\epsilon^2}{1-\\rho^2}\\right).\n$$", "answer": "$$\\boxed{\\exp\\left(\\frac{2\\rho\\,\\epsilon^{2}}{1-\\rho^{2}}-\\frac{2c\\,\\epsilon}{1+\\rho}\\right)}$$", "id": "1962663"}]}