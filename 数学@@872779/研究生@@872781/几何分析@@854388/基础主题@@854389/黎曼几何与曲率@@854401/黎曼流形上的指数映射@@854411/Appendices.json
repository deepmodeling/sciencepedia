{"hands_on_practices": [{"introduction": "要真正掌握指数映射，最好的方法莫过于亲自动手在一个熟悉的空间上进行计算。本练习将以单位球面为舞台，通过指数映射建立所谓的法坐标系 ([@problem_id:1044026])。我们将看到，将球面的度量“拉回”到平坦的切空间上时，其形式会发生改变，这让我们能够直观地看到曲率是如何体现为对欧几里得度量的“扭曲”的。", "problem": "考虑嵌入在欧几里得空间 $\\mathbb{R}^3$ 中的单位2-球面 $S^2$，其由方程 $x^2+y^2+z^2=1$ 定义。该球面赋有其标准圆形度量 $g$，这是由 $\\mathbb{R}^3$ 中的欧几里得点积诱导的度量。\n\n令 $p=(0,0,1)$ 为 $S^2$ 的北极点。该点的切空间 $T_p S^2$ 可与 $\\mathbb{R}^3$ 中的 $xy$-平面等同。令 $\\{e_1, e_2\\}$ 为 $T_p S^2$ 的一个标准正交基，其中 $e_1=(1,0,0)$ 且 $e_2=(0,1,0)$。\n\n在 $p$ 点的指数映射，记为 $\\exp_p: T_p S^2 \\to S^2$，将一个切向量 $V \\in T_p S^2$ 映射到球面上的一点，该点是从 $p$点出发，以初始速度 $V$ 沿测地线移动单位时间后到达的点。\n\n对于 $S^2$ 上的一个点 $q$，其在 $p$ 的邻域上的法坐标 $(u,v)$ 定义为向量 $V \\in T_p S^2$ 的分量，使得 $q = \\exp_p(V)$。具体来说，如果 $V = u e_1 + v e_2$，那么点 $q=\\exp_p(V)$ 的法坐标就是 $(u,v)$。\n\n一个常截面曲率为 $K$ 的空间上的度量，可以用极法坐标 $(r, \\theta)$ 表示为 $ds^2 = dr^2 + S_K(r)^2 d\\theta^2$。对于单位球面 $S^2$，截面曲率为 $K=1$，函数 $S_1(r)$ 由 $S_1(r) = \\sin(r)$ 给出。笛卡尔法坐标 $(u,v)$ 与极法坐标 $(r, \\theta)$ 通过标准关系 $u=r\\cos\\theta$ 和 $v=r\\sin\\theta$ 相关联。\n\n令 $G = \\exp_p^*g$ 为度量 $g$ 通过指数映射到切空间 $T_p S^2$ 上的拉回。在 $T_p S^2$ 上的法坐标系 $(u,v)$ 中，该拉回度量的分量为 $G_{ij}$。\n\n推导拉回度量张量 $G$ 的非对角分量 $G_{uv}(u,v)$，用笛卡尔法坐标 $u$ 和 $v$ 表示。", "solution": "我们从曲率为 $K=1$ 的 $S^2$ 上的圆形度量的极法坐标形式 $(r,\\theta)$ 出发：\n$$ds^2 = dr^2 + \\sin^2r\\,d\\theta^2$$\n引入笛卡尔法坐标：\n$$u = r\\cos\\theta,\\quad v = r\\sin\\theta,\\qquad r=\\sqrt{u^2+v^2}\\,,\\;\\theta=\\arctan(\\frac{v}{u})$$\n计算微分：\n$$dr = \\frac{u\\,du + v\\,dv}{r},\\quad d\\theta = \\frac{u\\,dv - v\\,du}{r^2}$$\n代入 $ds^2$：\n$$\ndr^2 = \\frac{(u\\,du + v\\,dv)^2}{r^2}\n= \\frac{u^2\\,du^2 + 2uv\\,du\\,dv + v^2\\,dv^2}{r^2}\n$$\n$$\n\\sin^2r\\,d\\theta^2\n= \\frac{\\sin^2r}{r^4}(u\\,dv - v\\,du)^2\n= \\frac{\\sin^2r}{r^4}\\bigl(v^2\\,du^2 - 2uv\\,du\\,dv + u^2\\,dv^2\\bigr)\n$$\n将各项相加得到 $du\\,dv$ 的系数：\n$$\nds^2 = \\dots + 2\\Bigl(\\frac{uv}{r^2} - \\frac{uv\\sin^2r}{r^4}\\Bigr)du\\,dv + \\dots\n$$\n因此，拉回度量 $G=\\exp_p^*g$ 的非对角分量为\n$$\nG_{uv}(u,v)\n= uv\\Bigl(\\frac{1}{r^2} - \\frac{\\sin^2r}{r^4}\\Bigr)\n= \\frac{uv(r^2 - \\sin^2r)}{r^4},\n\\quad r=\\sqrt{u^2+v^2}\n$$", "answer": "$$\\boxed{\\frac{uv\\bigl((u^2+v^2)-\\sin^2(\\sqrt{u^2+v^2})\\bigr)}{(u^2+v^2)^2}}$$", "id": "1044026"}, {"introduction": "我们已经看到指数映射会扭曲度量，但这种扭曲的程度究竟如何量化？下一个练习通过审视几何学中最古老的结果之一——勾股定理，为我们提供了一个深刻的答案。通过计算一个微小测地线直角三角形斜边长度的修正项 ([@problem_id:1043997])，我们将揭示一个基本联系：截面曲率精确地度量了局部几何偏离欧几里得几何的程度。", "problem": "在一个 $n$ 维 Riemann 流形 $(M, g)$ 中，欧几里得勾股定理 $c^2 = a^2+b^2$ 对于测地三角形一般不成立。然而，对于一个小的测地三角形，可以找到依赖于流形几何性质（特别是其曲率）的修正项。\n\n考虑一个点 $p \\in M$。令 $\\{e_1, e_2\\}$ 为切空间 $T_p M$ 中的一组标准正交向量。这些向量定义了一个二维平面 $\\sigma = \\text{span}\\{e_1, e_2\\} \\subset T_pM$。\n考虑一个顶点为 $p$、$q = \\exp_p(a e_1)$ 和 $r = \\exp_p(b e_2)$ 的测地三角形，其中 $\\exp_p$ 是在 $p$ 点的指数映射，$a, b$ 是表示在 $p$ 点交汇的两条边边长的小正实数。由于 $\\langle e_1, e_2 \\rangle_p = 0$，这两条测地边在 $p$ 点的夹角为 $\\pi/2$。\n\n设该三角形的边长为 $d(p,q) = a$，$d(p,r) = b$ 和 $d(q,r) = c$。斜边长度的平方 $c^2$ 可以表示为关于 $a$ 和 $b$ 的幂级数展开。其主项由下式给出：\n$$c^2 = a^2 + b^2 + \\mathcal{C} \\cdot K_{\\sigma}(p) \\cdot a^2 b^2 + O((a^2+b^2)^{5/2})$$\n其中 $K_\\sigma(p)$ 是平面 $\\sigma$ 在点 $p$ 的截面曲率，而 $\\mathcal{C}$ 是一个普适无量纲常数。\n\n你的任务是推导出常数 $\\mathcal{C}$ 的值。\n\n在推导过程中，你可以使用在以 $p$ 为中心的 Riemann 正规坐标 $x^i$ 中度量张量的展开式。在坐标为 $(x^1, \\dots, x^n)$ 的点 $x$ 处，度量张量的分量 $g_{ij}(x)$ 由下式给出：\n$$g_{ij}(x) = \\delta_{ij} - \\frac{1}{3} \\sum_{k,l=1}^n R_{ikjl}(p) x^k x^l + O(|x|^3)$$\n其中 $R_{ikjl}(p)$ 是在 $p$ 点的 Riemann 曲率张量关于与正规坐标相对应的标准正交基的分量。你也可以使用这样一个事实：在正规坐标中，两点之间的直线段长度是测地距离的一阶近似。测地距离 $d(q,r)$ 是连接 $q$ 和 $r$ 的所有曲线长度的下确界。", "solution": "1. 在以 $p$ 为中心的黎曼法坐标系中，点 $q$ 和 $r$ 的坐标分别为 $q=(a,0,\\dots,0)$ 和 $r=(0,b,0,\\dots,0)$。\n\n2. 我们用连接 $q$ 和 $r$ 的直线路径 $\\gamma(s)=(a(1-s),\\,b s, 0, \\dots, 0)$（其中 $0\\le s\\le1$）的长度 $L$ 来近似测地距离 $c$。路径的速度向量为 $\\dot\\gamma(s)=(-a,b,0,\\dots,0)$。\n\n3. 路径长度的平方由 $L^2 = \\left( \\int_0^1 \\sqrt{g_{\\gamma(s)}(\\dot\\gamma, \\dot\\gamma)} ds \\right)^2$ 给出。我们首先计算被积函数中的 $g_{\\gamma(s)}(\\dot\\gamma, \\dot\\gamma)$：\n$$ g_{\\gamma(s)}(\\dot\\gamma, \\dot\\gamma) = g_{ij}(\\gamma(s)) \\dot\\gamma^i \\dot\\gamma^j = \\left(\\delta_{ij}-\\frac{1}{3}R_{ikjl}(p)\\,\\gamma^k(s) \\gamma^l(s) + \\dots \\right)\\dot\\gamma^i \\dot\\gamma^j $$\n$$ = (a^2+b^2) - \\frac{1}{3}R_{ikjl}(p)\\,\\dot\\gamma^i \\dot\\gamma^j \\gamma^k(s) \\gamma^l(s) + O((a^2+b^2)^3) $$\n\n4. 设 $S = \\int_0^1 R_{ikjl}(p)\\,\\dot\\gamma^i \\dot\\gamma^j \\gamma^k(s) \\gamma^l(s) ds$。利用黎曼曲率张量的对称性（特别是第一比安基恒等式），可以证明 $R_{ikjl}(p)\\,\\dot\\gamma^i \\dot\\gamma^j \\gamma^k(s) \\gamma^l(s) = K_\\sigma(p) (a\\gamma^2(s) + b\\gamma^1(s))^2$。\n$$ S = \\int_0^1 K_\\sigma(p) (a(bs) + b(a(1-s)))^2 ds = K_\\sigma(p) \\int_0^1 (abs + ab - abs)^2 ds $$\n$$ S = K_\\sigma(p) \\int_0^1 (ab)^2 ds = K_\\sigma(p)\\,a^2b^2 $$\n\n5. 现在我们计算直线路径的长度 $L$。令 $D=a^2+b^2$。\n$$ L = \\int_0^1 \\sqrt{D - \\frac{1}{3}R_{ikjl}\\dots} ds \\approx \\int_0^1 \\left(\\sqrt{D} - \\frac{R_{ikjl}\\dots}{6\\sqrt{D}}\\right) ds $$\n$$ L \\approx \\sqrt{D} - \\frac{1}{6\\sqrt{D}} \\int_0^1 R_{ikjl}\\dots ds = \\sqrt{D} - \\frac{S}{6\\sqrt{D}} $$\n\n6. 因此，路径长度的平方为：\n$$ L^2 \\approx \\left(\\sqrt{D} - \\frac{S}{6\\sqrt{D}}\\right)^2 \\approx D - 2\\frac{\\sqrt{D}S}{6\\sqrt{D}} = D - \\frac{S}{3} $$\n将 $D=a^2+b^2$ 和 $S=K_\\sigma(p)a^2b^2$ 代入，得到：\n$$ L^2 \\approx a^2+b^2 - \\frac{1}{3}K_\\sigma(p)\\,a^2b^2 $$\n对于微小三角形，测地距离 $c$ 的平方可以用直线路径长度的平方 $L^2$ 来近似到四阶项。因此，$c^2 \\approx L^2$。\n$$ c^2 = a^2+b^2-\\frac{1}{3}K_\\sigma(p)\\,a^2b^2+O((a^2+b^2)^{5/2}) $$\n所以普适常数为 $\\mathcal C=-\\frac{1}{3}$。", "answer": "$$\\boxed{-\\frac{1}{3}}$$", "id": "1043997"}, {"introduction": "指数映射在切空间的线性结构与流形的复杂几何之间架起了一座强大的桥梁。本练习将探讨这座桥梁的适用范围，并推导出一个几何分析中的基本工具。我们将研究黎曼距离函数 $r(x) = d(p,x)$ 的性质，并计算其梯度 ([@problem_id:3035018])，从而揭示它与测地线速度场的内在联系。", "problem": "设 $(M,g)$ 是一个完备黎曼流形，并固定一点 $p \\in M$。定义距离函数 $r:M \\to \\mathbb{R}$ 为 $r(x) = d(p,x)$，其中 $d$ 是由 $g$ 导出的黎曼距离。设 $\\exp_{p}:T_{p}M \\to M$ 表示在点 $p$ 处的指数映射。点 $p$ 的割迹，记作 $\\mathrm{Cut}(p)$，是满足以下条件之一的点 $x \\in M$ 的集合：存在至少两条连接 $p$ 和 $x$ 的不同极小测地线，或者 $x$ 是沿某条极小测地线从 $p$ 出发的第一个共轭点。考虑开集 $M \\setminus (\\mathrm{Cut}(p) \\cup \\{p\\})$，其中每个点 $x$ 都存在一条从 $p$ 到 $x$ 的唯一单位速率极小测地线 $\\gamma_{u}:[0,r(x)] \\to M$，其形式为 $\\gamma_{u}(t) = \\exp_{p}(t\\,u)$，其中 $u \\in T_{p}M$ 满足 $|u|_{g_{p}}=1$。仅从测地线、指数映射和高斯引理（高斯引理断言，在法坐标系中，径向测地线与测地球面正交，并且 $\\exp_{p}$ 保持径向方向与固定半径处的任意切向量之间的内积）的核心定义出发，完成以下任务：\n\n- 证明距离函数 $r$ 在 $M \\setminus \\mathrm{Cut}(p)$ 上是光滑的。\n- 对于 $x \\in M \\setminus (\\mathrm{Cut}(p) \\cup \\{p\\})$，用由 $x=\\exp_{p}(r(x)\\,u)$ 确定的单位速率径向测地线 $\\gamma_{u}$ 显式计算黎曼梯度 $\\nabla r(x)$。\n\n你的最终答案必须是 $\\nabla r(x)$ 关于 $\\gamma_{u}$ 的单个闭式解析表达式，无舍入、无单位。若涉及角度，请用弧度表示。", "solution": "该问题要求证明距离函数的光滑性并计算其梯度。\n\n**1. $r(x)$ 的光滑性证明**\n函数 $r(x)=d(p,x)$ 在点 $x=p$ 处不可微。我们考虑 $x \\in M \\setminus (\\mathrm{Cut}(p) \\cup \\{p\\})$。\n根据割迹的定义，对于任何这样的点 $x$，指数映射 $\\exp_p$ 是从 $T_pM$ 中 $v=\\log_p(x)$ 的一个邻域到 $M$ 中 $x$ 的一个邻域的局部微分同胚。因此，其逆映射——对数映射 $\\log_p$——在 $x$ 的一个邻域上是光滑的。\n\n对于该邻域中的点 $y$，距离函数可以表示为：\n$$ r(y) = d(p,y) = \\|\\log_p(y)\\|_{g_p} = \\sqrt{g_p(\\log_p(y), \\log_p(y))} $$\n由于 $x \\neq p$，我们有 $\\log_p(x) \\neq 0$。函数 $w \\mapsto \\|w\\|_{g_p}$ 在 $T_pM \\setminus \\{0\\}$ 上是光滑的。因此，$r(y)$ 作为光滑映射 $y \\mapsto \\log_p(y)$ 和光滑函数 $w \\mapsto \\|w\\|_{g_p}$ 的复合，在 $x$ 处是光滑的。\n\n**2. $\\nabla r(x)$ 的计算**\n梯度 $\\nabla r(x)$ 是由关系 $g_x(\\nabla r(x), Y) = dr_x(Y)$ 对所有向量 $Y \\in T_xM$ 唯一确定的向量。设 $\\gamma_u(t) = \\exp_p(tu)$ 是从 $p$ 到 $x$ 的唯一单位速率极小测地线，长度为 $L=r(x)$。我们证明 $\\nabla r(x) = \\dot{\\gamma}_u(L)$。\n\n(a) **计算方向导数 $dr_x(Y)$:**\n设 $c(s)$ 是 $M$ 中的一条光滑曲线，满足 $c(0)=x$ 和 $\\dot{c}(0)=Y$。\n$$ dr_x(Y) = \\frac{d}{ds}\\rvert_{s=0} r(c(s)) $$\n将曲线提升到切空间，令 $V(s) = \\log_p(c(s))$。则 $r(c(s)) = \\|V(s)\\|_{g_p}$。设 $L(s)=\\|V(s)\\|_{g_p}$ 和 $u(s)=V(s)/L(s)$。在 $s=0$ 时，我们有 $V(0)=Lu, L(0)=L, u(0)=u$。\n$$ dr_x(Y) = \\frac{d}{ds}\\rvert_{s=0} L(s) = \\dot{L}(0) $$\n\n(b) **计算内积 $g_x(\\dot{\\gamma}_u(L), Y)$:**\n我们有 $\\dot{\\gamma}_u(L) = d(\\exp_p)_{Lu}(u)$ 和 $Y=\\dot{c}(0)=d(\\exp_p)_{Lu}(\\dot{V}(0))$，其中 $\\dot{V}(0) = \\dot{L}(0)u + L\\dot{u}(0)$。\n$$ g_x(\\dot{\\gamma}_u(L), Y) = g_x(d(\\exp_p)_{Lu}(u), d(\\exp_p)_{Lu}(\\dot{L}(0)u + L\\dot{u}(0))) $$\n利用线性和双线性，上式等于：\n$$ \\dot{L}(0)g_x(d(\\exp_p)_{Lu}(u), d(\\exp_p)_{Lu}(u)) + Lg_x(d(\\exp_p)_{Lu}(u), d(\\exp_p)_{Lu}(\\dot{u}(0))) $$\n- 因为 $\\gamma_u$ 是单位速率测地线，所以 $g_x(\\dot{\\gamma}_u(L), \\dot{\\gamma}_u(L)) = g_x(d(\\exp_p)_{Lu}(u), d(\\exp_p)_{Lu}(u)) = 1$。\n- 因为 $u(s)$ 是单位向量曲线，$\\dot{u}(0)$ 与 $u$ 正交。根据高斯引理，指数映射的微分将径向向量 $u$ 和与之正交的向量 $\\dot{u}(0)$ 映为正交向量。因此 $g_x(d(\\exp_p)_{Lu}(u), d(\\exp_p)_{Lu}(\\dot{u}(0))) = 0$。\n\n代入这些结果，我们得到：\n$$ g_x(\\dot{\\gamma}_u(L), Y) = \\dot{L}(0) \\cdot 1 + L \\cdot 0 = \\dot{L}(0) $$\n\n(c) **结论:**\n我们证明了 $g_x(\\dot{\\gamma}_u(L), Y) = dr_x(Y)$。由于这对任意 $Y$ 成立，根据梯度的定义，我们有 $\\nabla r(x) = \\dot{\\gamma}_u(L) = \\dot{\\gamma}_u(r(x))$。即，距离函数的梯度是从 $p$ 点出发的唯一极小测地线在 $x$ 点的单位速度向量。", "answer": "$$\\boxed{\\dot{\\gamma}_{u}(r(x))}$$", "id": "3035018"}]}