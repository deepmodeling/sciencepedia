## 引言
在几何分析领域，[流形](@entry_id:153038)上的[调和函数](@entry_id:746864)构成了连接分析学与几何学的核心基石。作为欧几里得空间中[拉普拉斯方程](@entry_id:143689)解的自然推广，调和函数在弯曲空间上的行为揭示了底层几何结构的深刻信息。本文旨在系统性地探索这一迷人领域，核心问题在于：一个[黎曼流形](@entry_id:261160)的几何性质（如曲率、拓扑和完备性）如何控制其上调和函数的存在性、唯一性与形态？

为了解答这一问题，我们将循序渐进地展开讨论。在“原理与机制”一章中，我们将从基本定义出发，介绍[Laplace-Beltrami算子](@entry_id:267002)，并探讨由其椭圆性决定的局部性质，如正则性和极大值原理。随后，我们将引入关键的[Bochner恒等式](@entry_id:193184)，展示它如何量化里奇曲率对函数梯度的影响，并最终聚焦于丘成桐（Shing-Tung Yau）建立的里程碑式的[梯度估计](@entry_id:164549)和[Liouville型定理](@entry_id:635837)，这些定理完美体现了[全局几何](@entry_id:197506)对分析的控制。

接下来，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将展示这些理论的强大威力。我们将探讨[调和函数](@entry_id:746864)如何揭示[流形](@entry_id:153038)的[几何刚性](@entry_id:189736)，例如在证明Cheeger-Gromoll[分裂定理](@entry_id:197795)中的作用，以及它如何与[谱理论](@entry_id:275351)、[霍奇理论](@entry_id:161814)和概率论中的布朗运动等概念紧密相连，成为连接不同数学分支的纽带。

最后，通过“动手实践”部分提供的一系列精心设计的练习，您将有机会亲手计算和证明关键结论，从而将理论知识内化为解决实际问题的能力。通过这一完整的学习路径，读者将[对流](@entry_id:141806)形上的调和函数建立一个坚实而深刻的理解。

## 原理与机制

本章旨在系统地阐述黎曼流形上调和函数理论的核心原理与关键机制。我们将从[Laplace-Beltrami算子](@entry_id:267002)的定义出发，探讨调和函数的局部性质，如[椭圆正则性](@entry_id:177548)和极大值原理。随后，我们将引入连接几何与分析的关键工具——[Bochner恒等式](@entry_id:193184)，并展示它如何揭示里奇曲率对[调和函数](@entry_id:746864)行为的深刻影响。最后，我们将聚焦于丘成桐（Shing-Tung Yau）及其合作者建立的[梯度估计](@entry_id:164549)与[Liouville型定理](@entry_id:635837)，这些定理构成了现代几何分析的基石。

### 基本定义：[Laplace-Beltrami算子](@entry_id:267002)与调和函数

在黎曼流形 $(M, g)$ 上，分析学的基本算子都具有内在的几何定义。对于一个光滑函数 $f \in C^{\infty}(M)$，其**梯度（gradient）** $\nabla f$ 是一个向量场，其定义方式为对任意向量场 $X$，都满足 $g(\nabla f, X) = df(X)$，其中 $df$ 是 $f$ 的[外微分](@entry_id:161900)。对于一个光滑向量场 $X$，其**散度（divergence）** 定义为 $\operatorname{div}X = \operatorname{tr}_{g}(\nabla X)$，其中 $\nabla$ 是[Levi-Civita联络](@entry_id:161107)，$\operatorname{tr}_g$ 表示关于度量 $g$ 的迹。

将这两个概念相结合，我们便得到了[黎曼几何](@entry_id:160508)中最重要的二阶微分算子——**[Laplace-Beltrami算子](@entry_id:267002)（Laplace–Beltrami operator）**，记作 $\Delta$ 或 $\Delta_g$。它作用于函数 $f$ 上，定义为 $f$ 的[梯度的散度](@entry_id:270716)：
$$ \Delta f = \operatorname{div}(\nabla f) $$
在任意局部坐标系 $\{x^i\}$ 下，该算子可以表示为：
$$ \Delta_g u = \frac{1}{\sqrt{\det g}} \partial_i \left( \sqrt{\det g} g^{ij} \partial_j u \right) $$
其中 $g_{ij}$ 是度量张量的分量，$g^{ij}$ 是其逆矩阵的分量，$\det g$ 是 $g_{ij}$ [矩阵的行列式](@entry_id:148198)。

一个关键的等价定义将拉普拉斯算子与函数的[二阶协变导数](@entry_id:193368)——**Hessian张量（Hessian tensor）** $\nabla^2 f$ 联系起来。Hessian张量是一个(0,2)-张量，定义为 $\nabla^2 f(Y,Z) = g(\nabla_Y \nabla f, Z)$。拉普拉斯算子正是Hessian张量关于度量的迹：
$$ \Delta f = \operatorname{tr}_g(\nabla^2 f) = \sum_{i=1}^{n} (\nabla^2 f)(e_i, e_i) $$
其中 $\{e_i\}$ 是任意一点的局部[标准正交标架](@entry_id:189702)。需要注意的是，一些文献（特别是在分析领域）中定义的拉普拉斯算子可能带有负号，即 $\Delta_f = -\operatorname{tr}_g(\nabla^2 f)$，以便使其成为一个[正算子](@entry_id:263696)。在本章中，我们遵循几何学家的惯例，即 $\Delta = \operatorname{tr}_g(\nabla^2 f)$。

有了[Laplace-Beltrami算子](@entry_id:267002)，我们便可以定义核心研究对象：

*   一个 $C^2$ 函数 $u$ 被称为**调和的（harmonic）**，如果 $\Delta u = 0$。
*   一个函数 $u$ 被称为**次调和的（subharmonic）**，如果 $\Delta u \ge 0$。
*   一个函数 $u$ 被称为**超调和的（superharmonic）**，如果 $\Delta u \le 0$。

这些定义也可以在弱意义下（即[分布](@entry_id:182848)意义下）对更一般的函数（如索博列夫空间中的函数）成立。

### 局部性质：椭圆性及其推论

调和函数理论的许多基本性质源于[Laplace-Beltrami算子](@entry_id:267002)作为一个偏微分算子（PDE）的局部特性。

#### [椭圆正则性](@entry_id:177548)

在任何光滑[坐标卡](@entry_id:262338)中，$\Delta_g$ 是一个二阶线性偏[微分算子](@entry_id:140145)。其[主符号](@entry_id:190703)由度量张量的逆 $g^{ij}$ 给出。由于黎曼度量 $g$ 在每一点都是正定的，其[逆矩阵](@entry_id:140380) $g^{ij}$ 也是正定的。这正是**[椭圆算子](@entry_id:181616)（elliptic operator）** 的定义。更进一步，由于[流形](@entry_id:153038) $(M,g)$ 是光滑的（$C^\infty$），算子的系数 $g^{ij}$ 及其导数在任何坐标卡中都是光滑函数。

[椭圆算子](@entry_id:181616)理论的一个基本结果是**[椭圆正则性](@entry_id:177548)（elliptic regularity）**。该理论指出，[椭圆方程](@entry_id:169190)解的光滑性取决于算子系数和方程右端项的[光滑性](@entry_id:634843)。对于调和方程 $\Delta u = 0$，由于算子系数是光滑的且右端项为零（也是光滑的），我们可以得出以下重要结论：

*   **Weyl引理的推广**：任何弱意义下的调和函数（例如，在一个局部索博列夫空间 $H^1_{\mathrm{loc}}$ 中满足积分形式定义的函数）实际上都是一个光滑（$C^\infty$）函数。
*   **[Schauder估计](@entry_id:196811)**：如果度量 $g$ 仅具有有限的正则性，例如 $C^{k,\alpha}$ 类，那么弱调和函数也将具有更高的正则性，即 $C^{k+1,\alpha}$ 类。
*   **[解析性](@entry_id:140716)**：如果[流形](@entry_id:153038)和度量是实解析的（$C^\omega$），那么任何调和函数也都是实解析的。

[椭圆正则性](@entry_id:177548)是一个纯粹的**局部**性质，它不依赖于[流形](@entry_id:153038)的全局属性，如完备性。这个强大的工具允许我们在证明中几乎总是假设[调和函数](@entry_id:746864)是光滑的，因为它为我们提供了一座从[弱解](@entry_id:161732)（通常更容易获得）到[强解](@entry_id:198344)（性质更优良）的桥梁。

#### 极大值原理

椭圆性的另一个深刻推论是**极大值原理（Maximum Principle）**。

*   **弱极大值原理**：在一个有界开集 $\Omega \subset M$ 上，如果一个[次调和函数](@entry_id:191036) $u$ 在 $\overline{\Omega}$ 上连续，那么 $u$ 的最大值必在边界 $\partial\Omega$ 上达到。
*   **强极大值原理**：如果一个[次调和函数](@entry_id:191036) $u$ 在一个连通开集 $\Omega$ 的某个[内点](@entry_id:270386)达到其最大值，那么 $u$ 必在整个 $\Omega$ 上为常数。由于调和函数既是次调和的也是超调和的，强极大值原理同样适用于调和函数。

强极大值原理是椭圆性的直接结果，它在任何[黎曼流形](@entry_id:261160)上都成立，无论其曲率如何。这一原理有一个直接的全局推论：在一个没有边界的紧致连通[流形](@entry_id:153038)上，任何[调和函数](@entry_id:746864)都必须是常数。这是因为紧致性保证了函数必在某点达到最大值，而没有边界意味着该点必为[内点](@entry_id:270386)，从而触发强极大值原理。这是最简单的一类[Liouville型定理](@entry_id:635837)。

#### [平均值性质](@entry_id:178047)

在欧氏空间 $\mathbb{R}^n$ 中，调和函数以其精确的**[平均值性质](@entry_id:178047)**而著称：函数在某点的取值等于它在该点周围任意球面或球体上的积分平均值。然而，在一般的[黎曼流形](@entry_id:261160)上，由于空间弯曲，这个精确的性质通常不再成立。取而代之的是平[均值不等式](@entry_id:636902)或关于**[调和测度](@entry_id:202752)**的积分表示。对于一个相对紧的区域 $\Omega \subset M$，在边界 $\partial\Omega$ 上存在一个唯一的[概率测度](@entry_id:190821)——[调和测度](@entry_id:202752) $d\omega_p^\Omega$，使得对于在 $\Omega$ 内的任意[调和函数](@entry_id:746864) $u$，都有：
$$ u(p) = \int_{\partial\Omega} u \, d\omega_p^\Omega $$
对于[次调和函数](@entry_id:191036)和超调和函数，则分别有 $u(p) \le \int_{\partial\Omega} u \, d\omega_p^\Omega$ 和 $u(p) \ge \int_{\partial\Omega} u \, d\omega_p^\Omega$。这些性质是极大值原理的等价表述。

### 几何与分析的桥梁：[Bochner恒等式](@entry_id:193184)

为了从局部性质过渡到涉及[流形](@entry_id:153038)[全局几何](@entry_id:197506)的深刻结果，我们需要一个能够[连接函数](@entry_id:636388)导数行为与[流形曲率](@entry_id:187680)的工具。这个工具就是**Bochner-Weitzenböck公式**，通常简称为**[Bochner恒等式](@entry_id:193184)**。

对于任意光滑函数 $f \in C^\infty(M)$，[Bochner恒等式](@entry_id:193184)给出了其梯度范数的平方 $|\nabla f|^2 = g(\nabla f, \nabla f)$ 的拉普拉斯：
$$ \frac{1}{2}\Delta |\nabla f|^2 = |\nabla^2 f|^2 + g(\nabla f, \nabla(\Delta f)) + \operatorname{Ric}(\nabla f, \nabla f) $$
其中 $|\nabla^2 f|^2$ 是Hessian张量的范数平方，$\operatorname{Ric}$ 是[里奇曲率张量](@entry_id:271424)。

这个恒等式的几何意义是深刻的。$\operatorname{Ric}(\nabla f, \nabla f)$ 这一项直接源于黎曼曲率张量对[二阶协变导数](@entry_id:193368)交换次序的修正（即Ricci恒等式）。因此，[Bochner恒等式](@entry_id:193184)量化了[流形](@entry_id:153038)的弯曲如何[影响函数](@entry_id:168646)梯度的变化率。

当函数 $u$ 是**调和函数**时，$\Delta u = 0$，因此 $\nabla(\Delta u) = 0$。[Bochner恒等式](@entry_id:193184)得到极大简化：
$$ \frac{1}{2}\Delta |\nabla u|^2 = |\nabla^2 u|^2 + \operatorname{Ric}(\nabla u, \nabla u) $$
这个简化的公式是几何分析中的一个核心出发点。现在，[流形](@entry_id:153038)的曲率——具体来说是[里奇曲率](@entry_id:162038)——直接与 $|\nabla u|^2$ 的拉普拉斯联系起来。

考虑一个具有**[非负里奇曲率](@entry_id:633979)**（$\operatorname{Ric} \ge 0$）的[流形](@entry_id:153038)，即对任意向量 $X$，$\operatorname{Ric}(X,X) \ge 0$。由于Hessian范数的平方 $|\nabla^2 u|^2$ 总是非负的，我们立即从简化的[Bochner恒等式](@entry_id:193184)中得到：
$$ \Delta |\nabla u|^2 = 2(|\nabla^2 u|^2 + \operatorname{Ric}(\nabla u, \nabla u)) \ge 0 $$
这意味着，在一个具有[非负里奇曲率](@entry_id:633979)的[流形](@entry_id:153038)上，任何调和函数 $u$ 的梯度范数平方 $|\nabla u|^2$ 都是一个**[次调和函数](@entry_id:191036)**。这个结论至关重要，但它本身并不足以在[非紧流形](@entry_id:185981)上保证调和函数的常值性。例如，在平坦的[欧氏空间](@entry_id:138052) $\mathbb{R}^n$（其$\operatorname{Ric}=0$）上，非平凡的线性函数 $u(x_1, \dots, x_n) = x_1$ 是调和的，其梯度范数平方 $|\nabla u|^2 = 1$ 也是一个（平凡的）[次调和函数](@entry_id:191036)，但 $u$ 显然不是常数。为了获得更强的全局结果，我们需要更精妙的论证。

### 全局刚性：丘成桐的[Liouville定理](@entry_id:751348)与[梯度估计](@entry_id:164549)

20世纪70年代，丘成桐（Shing-Tung Yau）的工作革命性地将[Bochner技巧](@entry_id:196927)与[非紧流形](@entry_id:185981)上的极大值原理相结合，建立了一系列深刻的全局性定理。

#### 关键思想与[梯度估计](@entry_id:164549)

丘成桐的核心思想不是直接分析[调和函数](@entry_id:746864) $u$ 本身，而是分析一个**[正调和函数](@entry_id:175225)** $u > 0$ 的对数 $f = \log u$。一个简单的计算表明：
$$ \Delta f = \Delta(\log u) = \operatorname{div}\left(\frac{\nabla u}{u}\right) = \frac{\Delta u}{u} - \frac{|\nabla u|^2}{u^2} $$
因为 $\Delta u = 0$，我们得到一个关键关系式：
$$ \Delta f = -|\nabla f|^2 $$
现在，我们将[Bochner恒等式](@entry_id:193184)应用于 $f=\log u$。通过一系列巧妙的计算，并结合极大值原理（在一个经过精心构造的截断函数辅助下），可以得到关于 $|\nabla f| = |\nabla \log u|$ 的[梯度估计](@entry_id:164549)。这个论证过程依赖于[流形](@entry_id:153038)的**完备性**，因为它保证了[测地线](@entry_id:269969)可以无限延伸，从而可以在任意大的测地 球上进行分析。

这一系列工作的高潮是著名的**[丘成桐梯度估计](@entry_id:189266)（Yau's Gradient Estimate）**。其一般形式为：

> 设 $(M^n, g)$ 是一个 $n$ 维[完备黎曼流形](@entry_id:182954)，其[里奇曲率](@entry_id:162038)有下界 $\operatorname{Ric} \ge -(n-1)K$（其中 $K \ge 0$ 是一个常数）。那么，对于 $M$ 上的任意[正调和函数](@entry_id:175225) $u>0$，其对数的梯度范数满足以下全局估计：
> $$ |\nabla \log u| \le (n-1)\sqrt{K} $$

这个估计惊人地只依赖于维数 $n$ 和里奇曲率的下界 $K$，而不依赖于函数 $u$ 本身的其他信息。

#### 丘成桐的[Liouville型定理](@entry_id:635837)

当[流形](@entry_id:153038)的里奇曲率**非负**时，即 $\operatorname{Ric} \ge 0$，我们可以取 $K=0$。此时，[丘成桐梯度估计](@entry_id:189266)给出了一个惊人的结论：
$$ |\nabla \log u| \le 0 $$
这意味着 $\nabla \log u = 0$。在一个连通[流形](@entry_id:153038)上，梯度为零的函数必为常数。因此，$\log u$ 是常数，从而 $u$ 本身也是常数。这就证明了著名的**丘成桐[Liouville定理](@entry_id:751348)**：

> 在一个完备的、具有[非负里奇曲率](@entry_id:633979)的[黎曼流形](@entry_id:261160)上，任何正的调和函数都必须是常数。

这个定理是欧氏空间中经典[Liouville定理](@entry_id:751348)（即有界[调和函数](@entry_id:746864)必为常数）在黎曼几何中的深刻推广。经典定理的证明不显式地使用曲率，但它所处的环境 $\mathbb{R}^n$ 恰好是一个完备且[里奇曲率](@entry_id:162038)为零的[流形](@entry_id:153038)。丘成桐的定理揭示了这一经典结果背后的几何本质：**完备性**确保了分析可以在全局尺度上进行，而**[非负里奇曲率](@entry_id:633979)**则通过[Bochner恒等式](@entry_id:193184)提供了关键的控制，阻止了函数梯度的过度增长。

使用类似的[梯度估计](@entry_id:164549)技术，这个结论可以被推广到增长速度较慢的[调和函数](@entry_id:746864)。例如，在一个完备且 $\operatorname{Ric} \ge 0$ 的[流形](@entry_id:153038)上，任何满足次[线性增长条件](@entry_id:201501)（即 $|u(x)|$ 的增长速度低于距离函数 $d(p,x)$ 的线性增长）的调和函数也必须是常数。

#### 必要性条件

[丘成桐定理](@entry_id:190158)的假设是至关重要的，缺一不可。

*   **[非负里奇曲率](@entry_id:633979)的必要性**：如果允许里奇曲率为负，定理便不再成立。一个典型的反例是 $n$ 维**双曲空间** $\mathbb{H}^n$。它是一个[完备流形](@entry_id:190409)，具有常负截面曲率 $-1$，因此其里奇曲率 $\operatorname{Ric} = -(n-1)g$ 是负定的。在[双曲空间](@entry_id:268092)上，存在着无穷多个非平凡的[正调和函数](@entry_id:175225)，例如对应其无穷远边界点的泊松核（Poisson kernel）函数。同样，像 $\mathbb{H}^n \times \mathbb{S}^1$ 这样的乘[积流形](@entry_id:270208)也具有负的[里奇曲率](@entry_id:162038)下界，并且可以构造出非平凡的[正调和函数](@entry_id:175225)。
*   **完备性的必要性**：如果[流形](@entry_id:153038)不完备，即使里奇曲率为零，定理也可能失效。例如，考虑欧氏空间 $\mathbb{R}^2$ 中去掉一个点的区域 $M = \mathbb{R}^2 \setminus \{0\}$。这是一个不完备的[流形](@entry_id:153038)，其[里奇曲率](@entry_id:162038)为零。然而，函数 $u(x,y) = \ln(x^2+y^2)$ 在 $M$ 上是调和的，但不是常数。

总之，[调和函数](@entry_id:746864)的研究完美地体现了现代[几何分析](@entry_id:157700)的精髓：从算子的局部椭圆性质出发，借助[Bochner恒等式](@entry_id:193184)这座桥梁，将[流形](@entry_id:153038)的[全局几何](@entry_id:197506)（由完备性和曲率体现）与分析性质（函数的存在性与刚性）紧密地联系在一起。