{"hands_on_practices": [{"introduction": "我们从一个基础练习开始，为高斯复合的实践打下基础。通过研究判别式为 $D = -4$ 这一最简单的情形，我们将应用二次型约化的定义来寻找所有的约化型，并确定相应的类数。这个练习旨在帮助你熟悉基本计算，并首次接触复合运算在群单位元上的平凡作用。[@problem_id:3015035]", "problem": "设 $Q(x,y) = a x^{2} + b x y + c y^{2}$ 是一个整系数二元二次型，其判别式为 $D = b^{2} - 4 a c$。并假设 $Q$ 是本原的，即 $\\gcd(a,b,c) = 1$，且是正定的，即 $D  0$ 且 $a > 0$。如果存在一个矩阵 $\\gamma \\in \\mathrm{SL}_{2}(\\mathbb{Z})$ 使得 $Q' = Q \\circ \\gamma$，则两个二次型 $Q$ 和 $Q'$ 是真等价的，其中 $Q \\circ \\gamma$ 表示由 $\\gamma$ 诱导的变量代换。对于固定的判别式 $D$，本原正定二次型的所有真等价类在高斯复合下构成一个有限阿贝尔群。一个既约型是其等价类中的一个代表 $Q$，满足既约不等式 $|b| \\leq a \\leq c$，以及附加条件：若 $|b| = a$ 或 $a = c$，则 $b \\geq 0$。\n\n对于判别式 $D = -4$ 的情况，仅根据上述定义和事实，完成以下任务：\n\n1. 确定判别式为 $D = -4$ 的所有既约本原正定二元二次型的完整列表，并推导出类数 $h(-4)$。\n\n2. 使用高斯复合（根据二元二次型复合律的基本定义构建），计算判别式为 $-4$ 的主既约型与自身的显式复合，得到判别式为 $-4$ 的复合型，其系数三元组为 $(a'', b'', c'')$。通过求解必要的同余方程和整性约束来执行复合运算，以确保所得系数定义了一个判别式为 $-4$ 的本原二次型。\n\n将您的最终答案表示为一个单行矩阵，其中首先包含类数 $h(-4)$，然后按顺序是复合型的系数 $(a'', b'', c'')$。无需四舍五入。", "solution": "此问题分为两个部分。首先，我们必须确定判别式为 $D = -4$ 的所有既约本原正定二元二次型的完整列表，并由此求出类数 $h(-4)$。其次，我们必须计算主既约型与自身的高斯复合。\n\n第1部分：确定既约型和类数 $h(-4)$\n\n一个二元二次型 $Q(x,y) = ax^2 + bxy + cy^2$ 由其整系数 $(a, b, c)$ 确定。其判别式为 $D = b^2 - 4ac$。给定 $D = -4$。该二次型必须是本原的，即 $\\gcd(a, b, c) = 1$，并且是正定的，即 $D  0$ 且 $a > 0$。\n\n如果一个二次型满足不等式 $|b| \\leq a \\leq c$，并且附加条件：若 $|b| = a$ 或 $a = c$，则 $b \\geq 0$，那么它就是既约的。\n\n我们来找出所有在 $D=-4$ 条件下满足这些条件的整数三元组 $(a, b, c)$。\n判别式方程为 $b^2 - 4ac = -4$，可以改写为 $4ac = b^2 + 4$。\n由于 $a$ 和 $c$ 是整数，$b^2+4$ 必须能被 $4$ 整除。这意味着 $b^2$ 必须能被 4 整除，这又意味着 $b$ 必须是一个偶数。设 $b = 2k$，其中 $k \\in \\mathbb{Z}$ 为某个整数。\n\n我们使用既约不等式来约束 $a$、$b$ 和 $c$ 的可能取值。\n根据正定条件，我们有 $a > 0$。\n既约条件是 $|b| \\leq a$ 和 $a \\leq c$。\n由于 $a \\leq c$，我们有 $4a^2 \\leq 4ac$。代入 $4ac = b^2 + 4$，我们得到 $4a^2 \\leq b^2 + 4$。\n从 $|b| \\leq a$，我们有 $b^2 \\leq a^2$。\n结合这些不等式，我们得到：\n$4a^2 \\leq b^2 + 4 \\leq a^2 + 4$\n这导致 $3a^2 \\leq 4$。\n\n因为 $a$ 必须是正整数，$a^2$ 也必须是正整数。不等式 $a^2 \\leq \\frac{4}{3}$ 只有一个正整数解 $a^2$，即 $a^2 = 1$。这意味着 $a = 1$。\n\n现在我们已经确定 $a=1$，我们使用条件 $|b| \\leq a$ 来求 $b$。\n$|b| \\leq 1$。\n如前所述，$b$ 必须是偶数。满足 $|b| \\leq 1$ 的唯一偶数是 $b = 0$。\n\n最后，我们使用判别式方程来求 $c$ 的值：\n$b^2 - 4ac = -4$\n$0^2 - 4(1)c = -4$\n$-4c = -4$\n$c = 1$。\n\n这为我们提供了一个唯一的既约型候选：系数三元组 $(a,b,c) = (1, 0, 1)$。我们必须验证这个二次型满足所有要求的条件。\n1. 二次型: $Q(x,y) = 1x^2 + 0xy + 1y^2 = x^2 + y^2$。\n2. 判别式: $D = 0^2 - 4(1)(1) = -4$。正确。\n3. 正定性: $D  0$ 且 $a = 1 > 0$。正确。\n4. 本原性: $\\gcd(a, b, c) = \\gcd(1, 0, 1) = 1$。正确。\n5. 既约性:\n   - $|b| \\leq a \\implies |0| \\leq 1$，成立。\n   - $a \\leq c \\implies 1 \\leq 1$，成立。\n   - 附加条件：由于 $a=c=1$，必须有 $b \\geq 0$。我们的值 $b=0$ 满足此条件。\n二次型 $(1, 0, 1)$ 确实是判别式为 $D=-4$ 的一个既约本原正定二次型。由于这是我们找到的唯一形式，因此这类二次型的完整列表仅包含这一个。\n\n类数，记为 $h(D)$，是判别式为 $D$ 的本原正定二次型的不同真等价类的数量。这个数量等于既约型的数量。\n由于只有一个既约型，类数为 $h(-4) = 1$。\n\n第2部分：高斯复合\n\n题目要求我们将判别式为 $D=-4$ 的主既约型与自身进行复合。主型是代表类群单位元的二次型。对于正定二次型，这是 $a=1$ 的二次型。在我们的例子中，唯一的既约型是 $(1, 0, 1)$，所以它必然是主型。\n\n设 $Q_1(x_1, y_1) = x_1^2 + y_1^2$ 和 $Q_2(x_2, y_2) = x_2^2 + y_2^2$。系数分别为 $(a_1, b_1, c_1) = (1, 0, 1)$ 和 $(a_2, b_2, c_2) = (1, 0, 1)$。我们想要求出复合型 $Q'' = Q_1 \\circ Q_2$ 的系数 $(a'', b'', c'')$。\n\n高斯复合理论提供了一种构造复合型的方法。首先，我们计算 $g = \\gcd(a_1, a_2, \\frac{b_1+b_2}{2})$。\n使用我们的值，$g = \\gcd(1, 1, \\frac{0+0}{2}) = \\gcd(1, 1, 0) = 1$。\n\n复合型的第一个系数 $a''$ 由 $a'' = \\frac{a_1 a_2}{g^2}$ 给出。\n$a'' = \\frac{1 \\cdot 1}{1^2} = 1$。\n\n第二个系数 $b''$ 是一个整数 $B$，它是以下同余方程组的一个联立解：\n1. $B \\equiv b_1 \\pmod{2a_1/g}$\n2. $B \\equiv b_2 \\pmod{2a_2/g}$\n3. $B^2 \\equiv D \\pmod{4a_1 a_2 / g^2}$\n\n代入给定值（$a_1=1, b_1=0, a_2=1, b_2=0, D=-4, g=1$）：\n1. $B \\equiv 0 \\pmod{2(1)/1} \\implies B \\equiv 0 \\pmod 2$。\n2. $B \\equiv 0 \\pmod{2(1)/1} \\implies B \\equiv 0 \\pmod 2$。\n3. $B^2 \\equiv -4 \\pmod{4(1)(1)/1^2} \\implies B^2 \\equiv 0 \\pmod 4$。\n\n从第一个同余式可知，$B$ 必须是偶数。设 $B = 2k$，其中 $k \\in \\mathbb{Z}$。\n将此代入第三个同余式：$(2k)^2 = 4k^2$。这个数总能被 4 整除，所以对于任何整数 $k$，$4k^2 \\equiv 0 \\pmod 4$ 都成立。\n因此，任何偶数 $B$ 都是该同余方程组的有效解。$B$ 的具体选择会影响在所得等价类中产生哪一个具体形式。我们可以选择最简单的解，即 $B = 0$。\n所以，我们取 $b'' = 0$。\n\n第三个系数 $c''$ 由复合型也必须具有判别式 $D = -4$ 的要求确定：\n$b''^2 - 4a''c'' = D$\n$0^2 - 4(1)c'' = -4$\n$-4c'' = -4$\n$c'' = 1$。\n\n得到的复合型的系数为 $(a'', b'', c'') = (1, 0, 1)$。\n我们必须检查这个二次型是本原的：$\\gcd(a'', b'', c'') = \\gcd(1, 0, 1) = 1$。它是本原的。\n\n因此，主型 $(1, 0, 1)$ 与自身的复合产生了型 $(1, 0, 1)$。这个结果是符合预期的，因为类群 $Cl(-4)$ 的阶为 $h(-4)=1$。唯一的元素是单位元类，它必然是自身的逆元，因此它与自身的复合必然再次得到单位元。\n\n最终答案要求给出类数 $h(-4)$ 和复合型的系数 $(a'', b'', c'')$。\n$h(-4) = 1$\n$(a'', b'', c'') = (1, 0, 1)$", "answer": "$$\\boxed{\\begin{pmatrix} 1  1  0  1 \\end{pmatrix}}$$", "id": "3015035"}, {"introduction": "在掌握了基础知识之后，这个练习将引导你处理一个更具代表性的例子，其判别式为 $D = -23$，对应一个非平凡的类群。你将完整地实践确定类群结构的全过程：从找出所有约化型，到动手计算两个非主类的复合。这个综合性练习是理解类群如何作为一个有限阿贝尔群运作的核心。[@problem_id:3015037]", "problem": "设 $\\Delta=-23$ 是一个基本判别式。考虑判别式为 $\\Delta$ 的本原正定二元二次型 $f(x,y)=a x^{2}+b x y+c y^{2}$，即 $b^{2}-4 a c=\\Delta$ 且 $\\gcd(a,b,c)=1$，以及在特殊线性群 $\\mathrm{SL}_{2}(\\mathbb{Z})$ 下的真等价，即通过替换 $(x,y)\\mapsto (p x+q y, r x+s y)$，其中 $p,q,r,s\\in\\mathbb{Z}$ 且 $p s-q r=1$。如果一个二次型满足正定二次型的标准简化不等式：$|b|\\leq a\\leq c$，并附带一个决胜约定，即如果 $|b|=a$ 或 $a=c$ 则 $b\\geq 0$，那么它被称为简化的。\n\n从这些定义和 Gauss 复合的二元二次型简化理论出发，完成以下任务：\n\n1. 仅使用简化不等式和关系式 $b^{2}-4 a c=\\Delta$，推导判别式为 $\\Delta=-23$ 的任意简化本原正定二次型的首项系数 $a$ 的严格界限。\n\n2. 枚举所有满足 $b^{2}-4 a c=-23$, $\\gcd(a,b,c)=1$ 和简化条件的整数三元组 $(a,b,c)$，并论证所得到的列表给出了真等价类的一组完整的简化代表元。\n\n3. 解释为什么这些简化二次型中的每一个都代表 $\\mathrm{SL}_{2}(\\mathbb{Z})$ 下一个不同的真等价类。\n\n4. 通过将一个非主简化类与自身复合来至少演示一次 Gauss 复合，使用 Dirichlet 复合框架得到一个复合形式，然后通过行列式为1的幺模变换将其简化，从而确认类群内的封闭性并确定其逆元。\n\n给出你的最终答案，即类数 $h(\\Delta)$，其定义为判别式为 $\\Delta$ 的本原正定二元二次型的真等价类数量。你的最终答案应表示为单个整数。", "solution": "该问题要求分析判别式为 $\\Delta = -23$ 的本原正定二元二次型。这包括找到该判别式的所有简化形式，证明它们构成了真等价类的一个完整代表元集合，并通过 Gauss 复合说明这些类上的群结构。最终目标是确定类数 $h(-23)$。\n\n一个二元二次型是形如 $f(x,y) = ax^2 + bxy + cy^2$ 的表达式，其中系数 $a, b, c$ 为整数。其判别式为 $\\Delta = b^2 - 4ac$。如果 $\\Delta  0$ 且 $a > 0$，则该二次型为正定的。如果 $\\gcd(a,b,c)=1$，则其为本原的。如果存在一个矩阵 $\\begin{pmatrix} p  q \\\\ r  s \\end{pmatrix} \\in \\mathrm{SL}_2(\\mathbb{Z})$（即 $p,q,r,s \\in \\mathbb{Z}$ 且 $ps-qr=1$），通过变量替换 $(x,y) \\mapsto (px+qy, rx+sy)$ 将二次型 $f$ 变换为 $g$，则称 $f$ 和 $g$ 是真等价的，记为 $f \\sim g$。一个正定二次型被称为简化的，如果其系数满足不等式 $|b| \\leq a \\leq c$，并附加条件：如果 $|b|=a$ 或 $a=c$，则 $b \\geq 0$。一个基本定理是，每个本原正定二次型的真等价类都恰好包含一个简化形式。\n\n我们将按问题陈述中指定的四个任务进行处理。\n\n1. 推导首项系数 $a$ 的界限。\n对于一个简化形式 $(a,b,c)$，我们有条件 $|b| \\leq a \\leq c$。从判别式关系中，我们得到 $4ac = b^2 - \\Delta$。由于我们的判别式是 $\\Delta = -23$，这变成 $4ac = b^2 + 23$。\n条件 $a \\leq c$ 意味着 $4a^2 \\leq 4ac$。\n代入 $4ac$ 的表达式，我们得到 $4a^2 \\leq b^2 + 23$。\n条件 $|b| \\leq a$ 意味着 $b^2 \\leq a^2$。\n结合这些不等式，我们有：\n$$4a^2 \\leq a^2 + 23$$\n$$3a^2 \\leq 23$$\n$$a^2 \\leq \\frac{23}{3} \\approx 7.667$$\n由于该二次型是正定的，$a$ 必须是一个正整数。因此，$a$ 可能的整数值为 $a=1$ 和 $a=2$。这为首项系数提供了所需的严格界限。\n\n2. 枚举所有简化形式。\n我们现在寻找所有满足本原性条件 $\\gcd(a,b,c)=1$、简化条件 $|b|\\leq a \\leq c$（带决胜条件）以及判别式方程 $b^2 - 4ac = -23$ 的整数三元组 $(a,b,c)$。我们使用上面推导出的 $a$ 的界限。注意，从 $b^2 - 4ac = -23$ 可得 $b^2 \\equiv -23 \\pmod 4$，可简化为 $b^2 \\equiv 1 \\pmod 4$。这意味着 $b$ 必须是一个奇数。\n\n情况1：$a=1$。\n条件 $|b| \\leq a=1$ 且 $b$ 为奇数，意味着 $b \\in \\{-1, 1\\}$。\n对于 $|b|=a$ 的决胜条件规定我们必须有 $b \\geq 0$。因此，我们必须选择 $b=1$。\n我们从判别式方程中找到 $c$：\n$b^2 - 4ac = -23 \\implies 1^2 - 4(1)c = -23 \\implies 1 - 4c = -23 \\implies 4c = 24 \\implies c=6$。\n这给出了三元组 $(a,b,c)=(1,1,6)$。\n我们检查条件：\n- 简化：$|b|=1 \\leq a=1 \\leq c=6$。对于 $|b|=a$ 的决胜条件 $b=1 \\geq 0$ 得到满足。该形式是简化的。\n- 本原：$\\gcd(1,1,6)=1$。该形式是本原的。\n所以，$f_1(x,y) = x^2+xy+6y^2$ 是一个简化的本原形式。这是主形式，因为它在 $(x,y)=(1,0)$ 处表示1。\n\n情况2：$a=2$。\n条件 $|b| \\leq a=2$ 且 $b$ 为奇数，意味着 $b \\in \\{-1, 1\\}$。\n如果 $b=1$：\n$b^2 - 4ac = -23 \\implies 1^2 - 4(2)c = -23 \\implies 1 - 8c = -23 \\implies 8c = 24 \\implies c=3$。\n这给出了三元组 $(a,b,c)=(2,1,3)$。\n- 简化：$|b|=1 \\leq a=2 \\leq c=3$。不等式是严格的，所以没有决胜条件适用。该形式是简化的。\n- 本原：$\\gcd(2,1,3)=1$。该形式是本原的。\n所以，$f_2(x,y) = 2x^2+xy+3y^2$ 是一个简化的本原形式。\n\n如果 $b=-1$：\n$b^2 - 4ac = -23 \\implies (-1)^2 - 4(2)c = -23 \\implies 1 - 8c = -23 \\implies 8c = 24 \\implies c=3$。\n这给出了三元组 $(a,b,c)=(2,-1,3)$。\n- 简化：$|b|=1 \\leq a=2 \\leq c=3$。不等式是严格的。该形式是简化的。\n- 本原：$\\gcd(2,-1,3)=1$。该形式是本原的。\n所以，$f_3(x,y) = 2x^2-xy+3y^2$ 是一个简化的本原形式。\n\n我们基于推导出的 $a$ 的界限进行的穷举搜索，得到了判别式为 $\\Delta=-23$ 的恰好三个简化本原正定二次型：\n- $f_1(x,y) = x^2+xy+6y^2$，对应三元组 $(1,1,6)$。\n- $f_2(x,y) = 2x^2+xy+3y^2$，对应三元组 $(2,1,3)$。\n- $f_3(x,y) = 2x^2-xy+3y^2$，对应三元组 $(2,-1,3)$。\n由于我们的搜索穷尽了简化条件所允许的所有可能性，所以这个列表是完整的。\n\n3. 关于不同等价类的论证。\n关于二元二次型简化的基本定理指出，对于负判别式，每个真等价类恰好包含一个简化形式。由于我们找到了三个不同的简化形式 $f_1, f_2, f_3$，它们必须代表三个不同的真等价类。\n值得注意的是，二次型 $f_2 = (2,1,3)$ 和 $f_3 = (2,-1,3)$ 不是真等价的。两个形式 $(a,b,c)$ 和 $(a,-b,c)$（其中 $b \\neq 0$）是真等价的，当且仅当满足条件 $|b|=a$ 或 $a=c$ 之一。对于 $f_2$ 和 $f_3$，我们有 $a=2, b=1, c=3$。我们看到 $|b|=1 \\neq a=2$ 并且 $a=2 \\neq c=3$。因此，$f_2$ 和 $f_3$ 不是真等价的。然而，它们是非真等价的（通过行列式为-1的变换等价）。\n\n4. Gauss 复合的演示。\n在 Gauss 复合下，真等价类的集合构成一个有限阿贝尔群，称为类群 $\\mathrm{Cl}(\\Delta)$。单位元是主形式的类，即 $[f_1]$。我们将一个非主形式的类 $[f_2]$ 与自身复合。这对应于计算 $[f_2]^2$。\n\n设要复合的两个二次型为 $F_1(x_1, y_1) = 2x_1^2 + x_1y_1 + 3y_1^2$ 和 $F_2(x_2, y_2) = 2x_2^2 + x_2y_2 + 3y_2^2$。我们使用 Dirichlet 的复合方法。\n由于首项系数不互质 ($\\gcd(2,2)=2$)，我们必须首先找到其中一个二次型的一个真等价形式。二次型 $F_2$ 表示 $F_2(0,1)=3$。由于 $\\gcd(a_1, 3)=\\gcd(2,3)=1$，我们可以找到一个与 $F_2$ 真等价且首项系数为 3 的二次型。\n变换 $(x,y) \\mapsto (-y,x)$（其矩阵为 $\\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} \\in \\mathrm{SL}_2(\\mathbb{Z})$）将一个二次型 $(a,b,c)$ 变换为 $(c,-b,a)$。将其应用于 $F_2=(2,1,3)$ 得到真等价形式 $(3, -1, 2)$。我们称之为 $F_2'=(3,-1,2)$。\n\n现在我们复合 $F_1=(2,1,3)$ 和 $F_2'=(3,-1,2)$。数据为 $a_1=2, b_1=1, c_1=3$ 和 $a_2=3, b_2=-1, c_2=2$。\n我们求解满足以下同余式的整数 $B$：\n- $B \\equiv b_1 \\pmod{2a_1} \\implies B \\equiv 1 \\pmod 4$\n- $B \\equiv b_2 \\pmod{2a_2} \\implies B \\equiv -1 \\pmod 6$\n- $B^2 \\equiv \\Delta \\pmod{4a_1a_2} \\implies B^2 \\equiv -23 \\pmod{24} \\implies B^2 \\equiv 1 \\pmod{24}$\n\n从 $B \\equiv -1 \\pmod 6$，我们可以写出 $B = 6k - 1$。\n将其代入第一个同余式：$6k - 1 \\equiv 1 \\pmod 4 \\implies 2k-1 \\equiv 1 \\pmod 4 \\implies 2k \\equiv 2 \\pmod 4$。这对任何奇数 $k$ 都成立。我们尝试 $k=1$，得到 $B=5$。\n我们检查所有条件下的 $B=5$：\n- $5 \\equiv 1 \\pmod 4$ (成立)\n- $5 \\equiv -1 \\pmod 6$ (成立)\n- $5^2 = 25 \\equiv 1 \\pmod {24}$ (成立)\n所以，我们可以取 $B=5$。\n\n复合形式 $H(x,y)=A X^2 + B XY + C Y^2$ 的系数为：\n- $A = a_1a_2 = (2)(3) = 6$。\n- $B = 5$。\n- $C = \\frac{B^2-\\Delta}{4A} = \\frac{5^2 - (-23)}{4(6)} = \\frac{25+23}{24} = \\frac{48}{24} = 2$。\n所以复合形式为 $H(x,y)=6x^2+5xy+2y^2$。\n\n这个形式不是简化的，因为 $a=6 > c=2$。我们必须将其简化。\n该形式为 $(a,b,c)=(6,5,2)$。\n1. 由于 $a>c$，我们应用变换 $(x,y) \\mapsto (-y, x)$，对应于矩阵 $\\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}$。这将 $(a,b,c)$ 映射到 $(c,-b,a)$。新的形式是 $(2,-5,6)$。\n2. 新的形式 $(a',b',c')=(2,-5,6)$ 不是简化的，因为 $|b'|=5 > a'=2$。我们应用变换 $(x,y) \\mapsto (x-ky, y)$，其矩阵为 $\\begin{pmatrix} 1  -k \\\\ 0  1 \\end{pmatrix}$，其中选择 $k$ 使得新的中间系数 $b'' = b' - 2a'k$ 满足 $|b''| \\leq a'$。我们有 $b'=-5$ 和 $a'=2$。我们需要 $|-5-4k| \\leq 2$。选择 $k=-1$ 得到 $|-5+4|=|-1|=1 \\leq 2$。\n新形式的系数为 $(a', b'-2a'k, a'k^2-b'k+c')$。当 $k=-1$ 时，变换变为 $(x,y)\\mapsto(x+y, y)$，新形式为：\n$a'''=a'=2$。\n$b'''=b'-2a'(-1) = -5+4(1)=-1$。\n$c'''=a'(-1)^2-b'(-1)+c' = 2(1)-(-5)(-1)+6 = 2-5+6=3$。\n完全简化的形式是 $(2,-1,3)$，这正是我们的形式 $f_3(x,y)$。\n\n这个计算 $[f_2] \\circ [f_2] = [f_3]$ 证明了在我们的类集合内的封闭性。它还有助于确定逆元。在一个3阶群中，如果 $[f_2]$ 不是单位元，它的逆元必须是 $[f_2]^2$。因此，$[f_3]$ 是 $[f_2]$ 的逆元，我们记为 $[f_2]^{-1} = [f_3]$。这与 $[f_2]\\circ[f_3] = [f_2]\\circ[f_2]^2 = [f_2]^3$ 一致。由于该群的阶为3，根据 Lagrange 定理，$[f_2]^3 = [f_1]$，即单位元。该群是一个由 $[f_2]$（以及 $[f_3]$）生成的3阶循环群。\n\n类数 $h(\\Delta)$ 是真等价类的数量，它等于简化形式的数量。我们找到了3个这样的形式。", "answer": "$$\\boxed{3}$$", "id": "3015037"}, {"introduction": "在完成了具体的数值计算后，最后的这个练习将我们带向一个更抽象的层面，以巩固对群结构的理解。通过分析一个特殊但至关重要的情形，即任何二次型与主型复合，你将严格证明主类确实扮演着单位元的角色。这项练习揭示了类群的代数性质是如何内嵌于复合运算的具体构造之中的。[@problem_id:3015044]", "problem": "设 $f(x,y)=a x^{2}+b x y+c y^{2}$ 和 $f'(x,y)=a' x^{2}+b' x y+c' y^{2}$ 是两个具有相同判别式 $D=b^{2}-4 a c=b'^{2}-4 a' c'$ 的本原二次型。考虑它们的 Dirichlet–Gauss 复合，其定义遵循以下标准构造方法：令 $g=\\gcd\\!\\left(a, a', \\frac{b+b'}{2}\\right)$ 且 $A=\\frac{a a'}{g^{2}}$。选择一个整数 $B$ 满足联立同余方程组 $B \\equiv b \\pmod{\\frac{2 a}{g}}$，$B \\equiv b' \\pmod{\\frac{2 a'}{g}}$，以及 $B^{2} \\equiv D \\pmod{4 A}$。然后定义 $C=\\frac{B^{2}-D}{4 A}$。这就产生了一个本原二次型 $F(x,y)=A x^{2}+B x y+C y^{2}$，它真等价于 $f$ 和 $f'$ 的类的高斯复合。\n\n分析 $a=1$ 或 $a'=1$ 的边缘情况。在这两种情况下，推导复合二次型的中间和末尾系数 $B$ 和 $C$ 的显式简化闭式表达式，这些表达式应仅用 $a, b, c, a', b', c'$ 和共享的判别式恒等式表示。你的推导必须从上述复合构造出发，通过在这些特殊情况下逻辑地简化同余和整除条件来进行，不得借助于所提供框架之外任何未经证明的“捷径”恒等式。\n\n将你的最终结果以单行矩阵的形式给出，按顺序包含四个条目：$a=1$ 时的 $B$，$a=1$ 时的 $C$，$a'=1$ 时的 $B$，$a'=1$ 时的 $C$。无需进行数值计算或四舍五入；给出精确的符号表达式。", "solution": "问题要求在 $a=1$ 或 $a'=1$ 的特殊情况下，推导两个本原二次型 $f(x,y)=a x^{2}+b x y+c y^{2}$ 和 $f'(x,y)=a' x^{2}+b' x y+c' y^{2}$ 的 Dirichlet-Gauss 复合 $F(x,y) = A x^{2} + B x y + C y^{2}$ 的系数 $B$ 和 $C$ 的简化闭式表达式。这两个二次型共享相同的判别式 $D = b^{2}-4ac = b'^{2}-4a'c'$。\n\n复合二次型的构造由以下步骤给出：\n1.  定义 $g=\\gcd\\!\\left(a, a', \\frac{b+b'}{2}\\right)$。注意到由于 $D \\equiv b^2 \\pmod{4}$ 和 $D \\equiv b'^2 \\pmod{4}$，可得 $b^2 \\equiv b'^2 \\pmod{4}$，这意味着 $b$ 和 $b'$ 具有相同的奇偶性。因此，$b+b'$ 总是偶数，$\\frac{b+b'}{2}$ 是一个整数。\n2.  定义 $A=\\frac{a a'}{g^{2}}$。\n3.  选择一个整数 $B$ 满足联立同余方程组：\n    $$ B \\equiv b \\pmod{\\frac{2 a}{g}} $$\n    $$ B \\equiv b' \\pmod{\\frac{2 a'}{g}} $$\n    $$ B^{2} \\equiv D \\pmod{4 A} $$\n4.  通过关系式 $D = B^2 - 4AC$ 定义 $C$，即 $C=\\frac{B^{2}-D}{4 A}$。\n\n现在我们基于此构造分析两种指定的边缘情况。\n\n**情况1：$a=1$**\n\n我们考虑二次型 $f(x,y) = x^2 + bxy + c y^2$。给定的二次型是本原的，当 $a=1$ 时这总是成立的，因为 $\\gcd(1, b, c) = 1$。\n\n首先，我们简化 $g$ 的表达式：\n$$ g = \\gcd\\!\\left(a, a', \\frac{b+b'}{2}\\right) = \\gcd\\!\\left(1, a', \\frac{b+b'}{2}\\right) = 1 $$\n任何包含 $1$ 的整数集合的最大公约数总是 $1$。\n\n接着，我们确定复合二次型的系数 $A$：\n$$ A = \\frac{a a'}{g^{2}} = \\frac{1 \\cdot a'}{1^{2}} = a' $$\n\n现在，我们分析中间系数 $B$ 的同余方程组。代入 $a=1$ 和 $g=1$：\n1.  $B \\equiv b \\pmod{\\frac{2 \\cdot 1}{1}} \\implies B \\equiv b \\pmod{2}$\n2.  $B \\equiv b' \\pmod{\\frac{2 a'}{1}} \\implies B \\equiv b' \\pmod{2a'}$\n3.  $B^{2} \\equiv D \\pmod{4 A} \\implies B^{2} \\equiv D \\pmod{4a'}$\n\n第二个同余式 $B \\equiv b' \\pmod{2a'}$ 是约束性最强的。任何满足它的整数 $B$ 都必须具有 $B = b' + 2a'k$ 的形式，其中 $k$ 是某个整数。\n我们来验证这样的 $B$ 是否满足另外两个同余式。\n对于第一个同余式：$b' + 2a'k \\equiv b \\pmod{2}$。由于 $2a'k \\equiv 0 \\pmod{2}$，这简化为 $b' \\equiv b \\pmod{2}$。如前所述，$b$ 和 $b'$ 必须具有相同的奇偶性，因此这个条件总是满足的。\n对于第三个同余式：我们有 $B \\equiv b' \\pmod{2a'}$，这意味着 $B^2 \\equiv b'^2 \\pmod{4a'}$。根据判别式恒等式 $D = b'^{2} - 4a'c'$，我们可以写出 $b'^2 = D + 4a'c'$。这意味着 $b'^2 \\equiv D \\pmod{4a'}$。因此，如果 $B^2 \\equiv b'^2 \\pmod{4a'}$，则可推断 $B^2 \\equiv D \\pmod{4a'}$。因此，对于任何满足第二个同余式的 $B$，第三个同余式也得到满足。\n\n该同余方程组实际上简化为 $B \\equiv b' \\pmod{2a'}$。问题要求 $B$ 的一个显式简化表达式。满足此条件的整数 $B$ 的最简单选择是取 $k=0$，这得到：\n$$ B = b' $$\n\n选定此 $B$ 后，我们现在确定最终的系数 $C$：\n$$ C = \\frac{B^{2}-D}{4 A} = \\frac{(b')^{2}-D}{4 a'} $$\n代入判别式恒等式 $D = b'^{2}-4a'c'$：\n$$ C = \\frac{b'^{2} - (b'^{2}-4a'c')}{4 a'} = \\frac{4a'c'}{4 a'} $$\n由于 $f'(x,y)$ 是一个二次型，其首项系数 $a'$ 是一个非零整数。因此，我们可以化简该分数：\n$$ C = c' $$\n所以，对于 $a=1$ 的情况，系数为 $B=b'$ 和 $C=c'$。得到的复合二次型是 $F(x,y)=a'x^2+b'xy+c'y^2$，它与 $f'(x,y)$ 相同。这与以下事实相符：任何 $a=1$ 的二次型都属于主类，而与主类进行复合相当于一个恒等运算。\n\n**情况2：$a'=1$**\n\n这个情况与第一个情况完全对称。我们考虑二次型 $f'(x,y) = x^2 + b'xy + c'y^2$。\n\n首先，我们简化 $g$ 的表达式：\n$$ g = \\gcd\\!\\left(a, a', \\frac{b+b'}{2}\\right) = \\gcd\\!\\left(a, 1, \\frac{b+b'}{2}\\right) = 1 $$\n\n接着，我们确定系数 $A$：\n$$ A = \\frac{a a'}{g^{2}} = \\frac{a \\cdot 1}{1^{2}} = a $$\n\n现在，我们分析 $B$ 的同余方程组。代入 $a'=1$ 和 $g=1$：\n1.  $B \\equiv b \\pmod{\\frac{2 a}{1}} \\implies B \\equiv b \\pmod{2a}$\n2.  $B \\equiv b' \\pmod{\\frac{2 \\cdot 1}{1}} \\implies B \\equiv b' \\pmod{2}$\n3.  $B^{2} \\equiv D \\pmod{4 A} \\implies B^{2} \\equiv D \\pmod{4a}$\n\n第一个同余式 $B \\equiv b \\pmod{2a}$ 是约束性最强的。任何满足它的整数 $B$ 都必须具有 $B = b + 2ak$ 的形式，其中 $k$ 是某个整数。\n我们来验证这样的 $B$ 是否满足另外两个同余式。\n对于第二个同余式：$b + 2ak \\equiv b' \\pmod{2}$。这简化为 $b \\equiv b' \\pmod{2}$，这总是成立的。\n对于第三个同余式：我们有 $B \\equiv b \\pmod{2a}$，这意味着 $B^2 \\equiv b^2 \\pmod{4a}$。根据判别式恒等式 $D = b^{2} - 4ac$，我们有 $b^2 = D + 4ac$。这意味着 $b^2 \\equiv D \\pmod{4a}$。因此，如果 $B^2 \\equiv b^2 \\pmod{4a}$，则可推断 $B^2 \\equiv D \\pmod{4a}$。因此第三个同余式得到满足。\n\n该同余方程组简化为 $B \\equiv b \\pmod{2a}$。我们通过取 $k=0$ 来选择 $B$ 的最简单的整数代表：\n$$ B = b $$\n\n选定此 $B$ 后，我们确定 $C$：\n$$ C = \\frac{B^{2}-D}{4 A} = \\frac{b^{2}-D}{4 a} $$\n代入判别式恒等式 $D = b^{2}-4ac$：\n$$ C = \\frac{b^{2} - (b^{2}-4ac)}{4 a} = \\frac{4ac}{4 a} $$\n由于 $f(x,y)$ 是一个二次型，$a \\neq 0$。我们可以化简：\n$$ C = c $$\n所以，对于 $a'=1$ 的情况，系数为 $B=b$ 和 $C=c$。得到的复合二次型是 $F(x,y)=ax^2+bxy+cy^2$，它与 $f(x,y)$ 相同。\n\n综上所述，推导出的显式表达式为：\n- 当 $a=1$ 时：$B=b'$ 和 $C=c'$。\n- 当 $a'=1$ 时：$B=b$ 和 $C=c$。\n我们将这四个结果以所要求的单行矩阵格式呈现。", "answer": "$$ \\boxed{ \\begin{pmatrix} b'  c'  b  c \\end{pmatrix} } $$", "id": "3015044"}]}