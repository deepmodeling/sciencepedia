## 引言
[二元二次型](@entry_id:200380)，形如 $ax^2+bxy+cy^2$ 的简单多项式，是数论研究中一个历史悠久且极为深刻的核心课题，其理论由拉格朗日开创，并由高斯发展至顶峰。尽管形式简洁，但它们蕴含着丰富的算术信息，并与数论的多个分支有着千丝万缕的联系。然而，理解这些形式所代表的整数、对它们进行[系统分类](@entry_id:162603)，并揭示其背后隐藏的[代数结构](@entry_id:137052)，构成了一个重要的知识体系。本文旨在系统地阐述这一理论，带领读者从基本原理走向前沿应用。

在接下来的内容中，我们将分三个章节展开探讨。首先，在“**原理与机制**”一章中，我们将奠定坚实的理论基础，从判别式、等价关系到精巧的约化理论，并最终引入[高斯复合](@entry_id:196619)，揭示使[等价类](@entry_id:156032)集合成为一个[有限阿贝尔群](@entry_id:136632)的[代数结构](@entry_id:137052)。我们还将建立二次型与二次数域理想论之间的桥梁，并介绍连接代数与分析的[解析类数公式](@entry_id:184272)。随后，“**应用与跨学科联系**”一章将展示该理论的强大威力，探讨[类数](@entry_id:156164)如何判定唯一因子分解性、解决整数表示问题，并与[类域论](@entry_id:155687)等现代数学分支产生共鸣。最后，“**动手实践**”部分将通过精心设计的问题，引导读者亲手计算约化型、执行复合运算，将抽象的理论转化为具体的计算技能。通过这一结构化的学习路径，读者将全面掌握[二元二次型](@entry_id:200380)类数理论的精髓。

## 原理与机制

在介绍性章节之后，我们现在深入研究[二元二次型](@entry_id:200380)的核心理论。本章将系统地阐述定义、等价关系、类群结构以及与[代数数论](@entry_id:148067)和分析的深刻联系。我们的目标是建立一个坚实的理论框架，为后续章节的应用和计算奠定基础。

### 基本定义与分类

我们从基本概念开始。一个整系数**[二元二次型](@entry_id:200380)** (integral binary quadratic form) 是一个关于变量 $x$ 和 $y$ 的二次[齐次多项式](@entry_id:178156)，其形式为：
$$ f(x,y) = ax^2 + bxy + cy^2 $$
其中系数 $a, b, c$ 均为整数。二次型的许多算术性质都由其**[判别式](@entry_id:174614)** (discriminant) 决定，定义为：
$$ D = b^2 - 4ac $$
[判别式](@entry_id:174614)的一个重要性质是，它在模 $4$ 的意义下只能是 $0$ 或 $1$。这是因为 $b^2$ 模 $4$ 为 $0$ 或 $1$，而 $4ac$ 模 $4$ 为 $0$，所以 $D \equiv b^2 \pmod{4}$。

根据判别式 $D$ 的符号，我们可以对二次型进行基本分类。为了理解这一点，我们可以对二次型进行配方。假设 $a \neq 0$，我们有：
$$ f(x,y) = a\left(x^2 + \frac{b}{a}xy\right) + cy^2 = a\left(x + \frac{b}{2a}y\right)^2 + \left(c - \frac{b^2}{4a}\right)y^2 = a\left(x + \frac{b}{2a}y\right)^2 - \frac{D}{4a}y^2 $$
这个表达式的符号行为，对于所有非零实数对 $(x,y)$，完全取决于 $a$ 的符号和 $D$ 的符号 [@problem_id:3009984]。

1.  **定型 (Definite Forms)**: 当 $D  0$ 时，$-D > 0$。表达式变为两个平方项的加权和，权重 $a$ 和 $-\frac{D}{4a}$ 的符号相同。
    -   如果 $a > 0$，则二次型 $f(x,y)$ 对所有非零 $(x,y) \in \mathbb{R}^2$ 均取正值。这种形式称为**正定二次型** (positive definite)。
    -   如果 $a  0$，则 $f(x,y)$ 对所有非零 $(x,y) \in \mathbb{R}^2$ 均取负值。这种形式称为**负定二次型** (negative definite)。
    请注意，当 $D  0$ 时，$b^2 - 4ac  0$ 意味着 $4ac > b^2 \ge 0$，因此 $a$ 和 $c$ 必须同号。

2.  **[不定型](@entry_id:150990) (Indefinite Forms)**: 当 $D > 0$ 时，权重 $a$ 和 $-\frac{D}{4a}$ 的符号相反。这意味着二次型可以取正值也可以取负值。例如，$f(1,0) = a$，而 $f(-b, 2a) = -Da$。由于 $D>0$，这两个值的符号相反。因此，这种形式称为**[不定二次型](@entry_id:191588)** (indefinite)。

3.  **退化型 (Degenerate Forms)**: 当 $D = 0$ 时，二次型可以写成 $f(x,y) = a\left(x + \frac{b}{2a}y\right)^2$（若 $a \neq 0$）或 $cy^2$（若 $a=0, b=0$）。这种形式是半定的，即它可以取零值，即使 $(x,y)$ 非零。

在数论中，我们主要关注非退化二次型 ($D \neq 0$)。此外，如果系数 $a, b, c$ 的[最大公约数](@entry_id:142947) $\gcd(a,b,c)=1$，则称该二次型为**本原二次型** (primitive form)。如果 $\gcd(a,b,c)=d > 1$，则该二次型可以写作 $d \cdot f'(x,y)$，其中 $f'$ 是一个本原二次型。因此，对本原二次型的研究是核心。

一个二次型 $f$ **表示** (represents) 一个整数 $n$，是指存在整数 $x,y$ 使得 $f(x,y)=n$。如果此时 $\gcd(x,y)=1$，则称这是一个**本原表示** (primitive representation)。

### 等价关系与类

二次型理论的核心思想是对其进行分类，将具有相似算术性质的二次型归为一类。关键的工具是**等价** (equivalence) 的概念。

如果两个二次型 $f$ 和 $f'$ 可以通过一个整系数的线性可[逆变](@entry_id:192290)量代换相互转化，我们就称它们是等价的。这个代换由一个 $2 \times 2$ 的整数矩阵 $M = \begin{pmatrix} p  q \\ r  s \end{pmatrix}$ 表示，其[行列式](@entry_id:142978)为 $\det(M) = \pm 1$。这样的矩阵构成了**[一般线性群](@entry_id:141275)** $\mathrm{GL}_2(\mathbb{Z})$。

更精确地，我们区分两种等价 [@problem_id:3010010]：
-   **固有等价** (Proper equivalence)：如果[变换矩阵](@entry_id:151616) $M$ 的[行列式](@entry_id:142978) $\det(M) = 1$，即 $M \in \mathrm{SL}_2(\mathbb{Z})$（**[特殊线性群](@entry_id:139538)**），则称 $f$ 和 $f'$ 是固有等价的。从几何上看，这对应于一个保向的基变换。
-   **非固有等价** (Improper equivalence)：如果变换矩阵 $M$ 的[行列式](@entry_id:142978) $\det(M) = -1$，则称 $f$ 和 $f'$ 是非固有等价的。这对应于一个反向的[基变换](@entry_id:189626)。

一般所说的“等价”通常指广义的等价，即允许 $\det(M) = \pm 1$。然而，固有等价在构建[代数结构](@entry_id:137052)时扮演着更核心的角色。

[等价关系](@entry_id:138275)至关重要，因为它保持了二次型的两个基本[不变量](@entry_id:148850)：
1.  **[判别式](@entry_id:174614)**：如果 $f$ 和 $f'$ 等价，它们的[判别式](@entry_id:174614)相同。
2.  **表示的整数集**：如果两个二次型 $f$ 和 $f'$ 是固有等价的，那么它们表示完全相同的整数集合。这是因为任何 $M \in \mathrm{SL}_2(\mathbb{Z})$ 都是 $\mathbb{Z}^2$ 上的一个双射变换。如果 $f'(x',y') = f(px'+qy', rx'+sy')$，并且 $n = f(x,y)$，我们可以通过逆变换找到 $(x',y')$ 使得 $n=f'(x',y')$。同样，本原表示的集合也是相同的 [@problem_id:3009996]。

此外，[本原性](@entry_id:145479)在固有等价下也是一个[不变量](@entry_id:148850)。也就是说，如果 $f$ 是本原的，且 $f'$ 与 $f$ 固有等价，那么 $f'$ 也必须是本原的。证明这个结论的一种方法是假设 $f'$ 非本原，即其所有系数都可被某个素数 $\ell$ 整除。这意味着 $f'$ 表示的所有整数都是 $\ell$ 的倍数。由于 $f$ 和 $f'$ 表示相同的整数集，所以 $f$ 表示的所有整数也都是 $\ell$ 的倍数。特别地，$f(1,0)=a$, $f(0,1)=c$ 和 $f(1,1)=a+b+c$ 都被 $\ell$ 整除，这直接导致 $b$ 也被 $\ell$ 整除。于是 $\ell$ 是 $a, b, c$ 的公因子，与 $f$ 的[本原性](@entry_id:145479)矛盾 [@problem_id:3010009]。

因此，对于一个给定的非零[判别式](@entry_id:174614) $D$，所有具有该判别式的本原二次型可以根据固有等价关系划分为若干个**固有[等价类](@entry_id:156032)** (proper equivalence classes)。这些[等价类](@entry_id:156032)的数目，称为**类数** (class number)，记为 $h(D)$，是一个核心的数论[不变量](@entry_id:148850)。

### 约化理论与[类数](@entry_id:156164)的计算

为了计算[类数](@entry_id:156164) $h(D)$，我们需要一种方法来为每个等价类找到一个唯一的、规范的代表元。这个过程称为**约化** (reduction)。

对于**正定二次型** ($D  0$)，约化理论尤其优美和完整。这套理论将代数问题几何化，通过将二次型与复平面上的点联系起来。一个正定二次型 $f(x,y) = ax^2+bxy+cy^2$ ($a>0$) 唯一对应于其方程 $az^2+bz+c=0$ 在复[上半平面](@entry_id:199119) $\mathfrak{H} = \{ z \in \mathbb{C} : \mathrm{Im}(z)>0 \}$ 中的根：
$$ \tau_f = \frac{-b + \sqrt{D}}{2a} = \frac{-b + i\sqrt{|D|}}{2a} $$
可以证明，两个正定二次型 $f$ 和 $g$ 是固有等价的，当且仅当它们对应的复数 $\tau_f$ 和 $\tau_g$ 通过 $\mathrm{SL}_2(\mathbb{Z})$ 的[分式线性变换](@entry_id:174812)相关联。因此，寻找每个[等价类](@entry_id:156032)的代表元问题，就转化为在 $\mathfrak{H}$ 中为每个 $\mathrm{SL}_2(\mathbb{Z})$ [轨道](@entry_id:137151)寻找一个唯一的代表点。

这可以通过**基本区域** (fundamental domain) $\mathcal{F}$ 来实现，其标准定义为：
$$ \mathcal{F} = \left\{ z \in \mathfrak{H} : |\mathrm{Re}(z)| \le \frac{1}{2} \text{ and } |z| \ge 1 \right\} $$
将 $\tau_f = \frac{-b + i\sqrt{|D|}}{2a}$ 位于 $\mathcal{F}$ 内的几何条件转换回系数 $a,b,c$ 的代数条件，我们得到 [@problem_id:3009999]：
-   $|\mathrm{Re}(\tau_f)| = \left|-\frac{b}{2a}\right| \le \frac{1}{2} \implies |b| \le a$
-   $|\tau_f|^2 = \frac{b^2+|D|}{4a^2} = \frac{b^2 + 4ac - b^2}{4a^2} = \frac{c}{a} \ge 1 \implies c \ge a$

一个满足 $|b| \le a \le c$ 的正定二次型被称为**约化二次型** (reduced form)。为了确保唯一性，我们需要处理边界情况：
-   如果 $|b|=a$ 或 $a=c$，我们约定 $b \ge 0$。

高斯证明了每个本原正定二次型都与**唯一一个**满足这些条件的约化二次型固有等价。因此，负[判别式](@entry_id:174614) $D$ 的[类数](@entry_id:156164) $h(D)$ 就是具有该[判别式](@entry_id:174614)的本原约化正定二次型的数目。由于 $b^2 \le a^2$ 和 $a \le c$ 意味着 $b^2 \le ac$，我们有 $4b^2 \le 4ac = b^2 - D$，所以 $3b^2 \le -D = |D|$。这表明 $|b| \le \sqrt{|D|/3}$。由于 $a$ 也受到 $4a^2 \le 4ac = b^2-D \le a^2-D$ 的限制，即 $3a^2 \le -D$，所以 $a \le \sqrt{|D|/3}$。这些不等式限制了 $a, b, c$ 的可能取值，使得约化型的数量是有限的，从而为计算 $h(D)$ 提供了一个有效的算法。

对于**[不定二次型](@entry_id:191588)** ($D > 0$)，约化理论更为复杂，涉及连分式和“约化型环”，在此不详述。

### 类群结构：[高斯复合](@entry_id:196619)

类数不仅是一个数目，它是一个[有限阿贝尔群](@entry_id:136632)的阶。高斯发现，对于一个固定的[判别式](@entry_id:174614) $D$，其所有本原二次型的固有[等价类](@entry_id:156032)集合上可以定义一个[二元运算](@entry_id:152272)，称为**[高斯复合](@entry_id:196619)** (Gauss composition)。

给定两个同[判别式](@entry_id:174614) $D$ 的本原二次型类，我们可以通过一种明确的（尽管有些复杂）方式构造出第三个同判别式的本原二次型类。这个构造的关键性质是，结果类不依赖于起始两个类中代表元的选择，因此这是一个在等价类集合上良定义的运算 [@problem_id:3009975]。

这个运算赋予了[等价类](@entry_id:156032)集合 $C(D)$ 一个[代数结构](@entry_id:137052)，其性质如下：
-   **闭合性**：两个类的复合仍在该集合内。
-   **结合律**：$(C_1 \circ C_2) \circ C_3 = C_1 \circ (C_2 \circ C_3)$。
-   **[交换律](@entry_id:141214)**：$C_1 \circ C_2 = C_2 \circ C_1$。
-   **单位元**：存在一个单位元，称为**主类** (principal class)。主类是包含能表示 $1$ 的二次型的类。对于判别式 $D$，主二次型是 $x^2 - \frac{D}{4}y^2$（如果 $D \equiv 0 \pmod 4$）或 $x^2+xy+\frac{1-D}{4}y^2$（如果 $D \equiv 1 \pmod 4$）。
-   **逆元**：每个类 $[a,b,c]$都有一个[逆元](@entry_id:140790)，即它的**共轭类** (conjugate class) $[a,-b,c]$。一个类与其共轭类的复合结果是主类。

综上所述，集合 $C(D)$ 在[高斯复合](@entry_id:196619)运算下构成一个**[有限阿贝尔群](@entry_id:136632)**，称为**[类群](@entry_id:182524)** (class group)。类数 $h(D)$ 正是这个群的阶。[类群](@entry_id:182524)的结构（例如，它是[循环群](@entry_id:138668)还是多个循环[群的直积](@entry_id:143585)）包含了关于[判别式](@entry_id:174614) $D$ 的深刻算术信息。

### 与代数数论的联系

二次型的理论与二次数域的[理想理论](@entry_id:184127)之间存在着深刻的对应关系。这个联系将具体的二次型计算提升到了更抽象的代数框架中。

首先，我们需要区分不同类型的[判别式](@entry_id:174614)。一个整数 $D$ 如果是某个二次[数域](@entry_id:155558) $K=\mathbb{Q}(\sqrt{d})$（其中 $d$ 是无平方因子的整数）的[域判别式](@entry_id:198568)，则称 $D$ 为**基本判别式** (fundamental discriminant)。一个整数 $D$ 是基本[判别式](@entry_id:174614)的充要条件是 [@problem_id:3009998]：
-   $D \equiv 1 \pmod 4$ 且 $D$ 是无平方因子的整数。
-   或者 $D=4d'$，其中 $d'$ 是无平方因子的整数且 $d' \equiv 2, 3 \pmod 4$。

任何非平方的[判别式](@entry_id:174614) $D$ 都可以唯一地写成 $D = f^2 D_0$ 的形式，其中 $D_0$ 是一个基本[判别式](@entry_id:174614)，整数 $f \ge 1$ 称为该判别式的**导子** (conductor)。这个 $D$ 对应于二次域 $K = \mathbb{Q}(\sqrt{D_0})$ 中的一个**序** (order)，记为 $\mathcal{O}_D$。序是 $K$ 的[整数环](@entry_id:181003) $\mathcal{O}_K$ 的一个子环，并且是一个自由 $\mathbb{Z}$-模。具体来说，$\mathcal{O}_D = \mathbb{Z} + f\mathcal{O}_K$ [@problem_id:3009977]。

高斯建立的惊人联系是：
[判别式](@entry_id:174614)为 $D$ 的本原[二元二次型](@entry_id:200380)的类群 $C(D)$，与二次域 $K=\mathbb{Q}(\sqrt{D_0})$ 中序 $\mathcal{O}_D$ 的**理想类群** $\mathrm{Cl}(\mathcal{O}_D)$ 是同构的。

[理想类群](@entry_id:153974)衡量了序 $\mathcal{O}_D$ 中理想偏离主理想（由单个元素生成的理想）的程度。这个同构意味着，关于二次型表示整数的问题，可以转化为在二次域中分解理想的问题。

对于[不定二次型](@entry_id:191588) ($D>0$)，情况更为精细。此时，固有[等价类](@entry_id:156032)群 $C(D)$（其阶为**窄类数** $h^+(D)$）同构于序 $\mathcal{O}_D$ 的**窄[理想类群](@entry_id:153974)** $\mathrm{Cl}^+(\mathcal{O}_D)$，后者考虑的是由**全正元**（即在所有实嵌入下均为正的元素）生成的理想。而广义[等价类](@entry_id:156032)[群同构](@entry_id:147371)于普通的[理想类群](@entry_id:153974) $\mathrm{Cl}(\mathcal{O}_D)$（其阶为**宽[类数](@entry_id:156164)** $h(D)$）。这两个类数之间的关系取决于序 $\mathcal{O}_D$ 中单位元的性质 [@problem_id:3010001]：
-   如果 $\mathcal{O}_D$ 中存在范数为 $-1$ 的单位元，则 $h^+(D) = h(D)$。
-   否则（所有单位元的范数均为 $+1$），则 $h^+(D) = 2h(D)$。

### [解析类数公式](@entry_id:184272)

二次型理论的顶峰之一是**[解析类数公式](@entry_id:184272)** (analytic class number formula)，它将类数这个代数[不变量](@entry_id:148850)与一个分析对象——**[狄利克雷L函数](@entry_id:199760)** (Dirichlet L-function) 的特殊值联系起来。

对于一个基本判别式 $D$，我们可以定义一个与之关联的实原特征，即**克罗内克符号** (Kronecker symbol) $\chi_D(n) = \left(\frac{D}{n}\right)$，它是一个模 $|D|$ 的[狄利克雷特征](@entry_id:151586)。相应的[狄利克雷L函数](@entry_id:199760)定义为：
$$ L(s, \chi_D) = \sum_{n=1}^{\infty} \frac{\chi_D(n)}{n^s}, \quad \text{for } \mathrm{Re}(s) > 1 $$
这个函数可以[解析延拓](@entry_id:147225)到整个复平面。

狄利克雷的[解析类数公式](@entry_id:184272)给出了 $L(1, \chi_D)$ 的精确值。对于负的基本[判别式](@entry_id:174614) $D  0$，公式为 [@problem_id:3009978]：
$$ L(1, \chi_D) = \frac{2\pi h(D)}{w(D)\sqrt{|D|}} $$
其中 $h(D)$ 是类数，而 $w(D)$ 是二次域 $\mathbb{Q}(\sqrt{D})$ 中单位根的个数。$w(D)$ 几乎总是 $2$（对应于 $\pm 1$），除了两个特殊情况：$D=-4$ 时 $w(-4)=4$（对应于 $\pm 1, \pm i$），以及 $D=-3$ 时 $w(-3)=6$（对应于六次[单位根](@entry_id:143302)）。$w(D)$ 也恰好是判别式为 $D$ 的二次型的[自同构群](@entry_id:139672)的阶。

对于正的基本[判别式](@entry_id:174614) $D>0$，公式变为：
$$ L(1, \chi_D) = \frac{2 h(D) R_D}{\sqrt{D}} $$
其中 $R_D$ 是二次域 $\mathbb{Q}(\sqrt{D})$ 的**[调节子](@entry_id:270859)** (regulator)，它与基本单位元的大小有关。

这些公式是非凡的，它们将代数（[类数](@entry_id:156164) $h(D)$）、几何（$\pi$）和分析（$L(1, \chi_D)$）联系在一起，展示了数论不同分支之间深刻而美丽的统一。