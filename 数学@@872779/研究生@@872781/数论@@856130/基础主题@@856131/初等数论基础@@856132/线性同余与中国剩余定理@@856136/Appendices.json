{"hands_on_practices": [{"introduction": "中国剩余定理通常在介绍时会假设模数是两两互质的。然而，在实际应用中，我们经常会遇到不满足此条件的系统。这个练习 [@problem_id:3017102] 将引导你处理这类情况下的必要第一步：检查一致性条件，并将原系统简化为一个等价的可解形式。掌握这一过程对于完整地应用该定理至关重要。", "problem": "设 $x \\in \\mathbb{Z}$ 满足如下三个线性同余方程组\n$$\nx \\equiv 5 \\pmod{12}, \\quad x \\equiv 11 \\pmod{18}, \\quad x \\equiv 7 \\pmod{25}.\n$$\n三个模中只有两对是两两互质的：$12$ 和 $18$ 有一个非平凡的最大公约数，而 $12$ 和 $18$ 都与 $25$ 互质。从整数模同余的定义和最大公约数的基本性质出发，论证模 $12$ 和模 $18$ 的这对同余方程有解的充要条件（相容性条件）。然后，使用中国剩余定理（CRT）和基本原理，确定完整解集的显式描述，其形式为 $x \\equiv x_{0} \\pmod{M}$，其中合适的模 $M$ 也必须由你推导得出。最后，给出最小非负解 $x_0$。无需四舍五入；请提供一个精确的整数。", "solution": "问题已经过验证。\n\n### 步骤 1：提取已知条件\n- 设 $x \\in \\mathbb{Z}$ 是一个整数。\n- 线性同余方程组为：\n  - $x \\equiv 5 \\pmod{12}$\n  - $x \\equiv 11 \\pmod{18}$\n  - $x \\equiv 7 \\pmod{25}$\n- 问题陈述了 $\\gcd(12, 18) \\neq 1$，而 $\\gcd(12, 25) = 1$ 且 $\\gcd(18, 25) = 1$。\n- 任务是：\n  1. 论证模 $12$ 和模 $18$ 的同余方程的相容性条件。\n  2. 确定完整解集 $x \\equiv x_{0} \\pmod{M}$。\n  3. 推导模 $M$。\n  4. 报告最小非负解 $x_{0}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学性：** 该问题是初等数论中的一个标准练习，基于线性同余和中国剩余定理的成熟理论。它在数学上是合理的。关于模的最大公约数的陈述是事实正确的：$\\gcd(12, 18) = \\gcd(2^2 \\cdot 3, 2 \\cdot 3^2) = 6 \\neq 1$；$\\gcd(12, 25) = \\gcd(2^2 \\cdot 3, 5^2) = 1$；$\\gcd(18, 25) = \\gcd(2 \\cdot 3^2, 5^2) = 1$。\n- **良构性：** 问题陈述清晰，并包含所有必要信息以确定解是否存在以及在存在时找到解。对于此类方程组，在某个整数取模下存在唯一解是一个标准结果。\n- **客观性：** 问题使用精确、客观的数学语言进行表述。\n- 所有验证标准均已满足。该问题没有指定的缺陷。\n\n### 步骤 3：结论与行动\n- 问题有效。开始求解。\n\n该问题要求解一个由三个线性同余方程组成的方程组。我们将首先处理模不互质的那对同余方程，建立它们的相容性条件，并将它们合并成一个单一的同余方程。然后，我们将使用中国剩余定理（CRT）的原理来求解所得的方程组。\n\n给定的方程组是：\n1. $x \\equiv 5 \\pmod{12}$\n2. $x \\equiv 11 \\pmod{18}$\n3. $x \\equiv 7 \\pmod{25}$\n\n首先，考虑前两个同余方程。模分别为 $m_1 = 12$ 和 $m_2 = 18$。它们的最大公约数是 $\\gcd(12, 18) = 6$。由于模不互质，只有当同余方程相容时，解才存在。\n\n让我们从基本原理推导相容性条件。同余方程 $x \\equiv a_1 \\pmod{m_1}$ 和 $x \\equiv a_2 \\pmod{m_2}$ 等价于存在整数 $k_1$ 和 $k_2$ 使得：\n$x = k_1 m_1 + a_1$\n$x = k_2 m_2 + a_2$\n为了使解 $x$ 存在，我们必须有 $k_1 m_1 + a_1 = k_2 m_2 + a_2$，这可以重新整理成一个关于变量 $k_1$ 和 $k_2$ 的线性丢番图方程：\n$m_1 k_1 - m_2 k_2 = a_2 - a_1$\n数论中一个著名的结果表明，该方程有整数解 $(k_1, k_2)$ 的充要条件是 $\\gcd(m_1, m_2)$ 整除等式右边，即 $a_2 - a_1$。这就是必要的和充分的相容性条件。这个条件可以表示为一个同余式：$a_1 \\equiv a_2 \\pmod{\\gcd(m_1, m_2)}$。\n\n对于给定的同余方程 $x \\equiv 5 \\pmod{12}$ 和 $x \\equiv 11 \\pmod{18}$，我们有 $a_1 = 5$，$m_1 = 12$，$a_2 = 11$，$m_2 = 18$。相容性条件是：\n$5 \\equiv 11 \\pmod{\\gcd(12, 18)}$\n$\\gcd(12, 18) = 6$。该条件变为 $5 \\equiv 11 \\pmod{6}$。\n这是成立的，因为 $11 - 5 = 6$，而 $6$ 能被 $6$ 整除。因此，前两个同余方程是相容的，存在公共解。\n\n现在，我们来求这个公共解。由 $x \\equiv 5 \\pmod{12}$，我们可以写出 $x = 12k + 5$，其中 $k$ 是某个整数。将此代入第二个同余方程：\n$12k + 5 \\equiv 11 \\pmod{18}$\n$12k \\equiv 6 \\pmod{18}$\n这是一个形如 $au \\equiv b \\pmod n$ 的线性同余方程。它对 $u$ 有解的充要条件是 $\\gcd(a, n)$ 整除 $b$。此处，$\\gcd(12, 18) = 6$，它能整除 $6$。因此该同余方程有解。我们可以用这个最大公约数去除整个关系式（包括模）：\n$\\frac{12}{6}k \\equiv \\frac{6}{6} \\pmod{\\frac{18}{6}}$\n$2k \\equiv 1 \\pmod{3}$\n为了解出 $k$，我们乘以 $2$ 在模 $3$ 下的乘法逆元。由于 $2 \\cdot 2 = 4 \\equiv 1 \\pmod{3}$，所以 $2$ 的逆元是 $2$。\n$2 \\cdot (2k) \\equiv 2 \\cdot 1 \\pmod{3}$\n$k \\equiv 2 \\pmod{3}$\n这意味着 $k$ 必须是 $k = 3j + 2$ 的形式，其中 $j$ 是某个整数。将此代回 $x$ 的表达式中：\n$x = 12(3j + 2) + 5 = 36j + 24 + 5 = 36j + 29$\n这等价于单个同余方程 $x \\equiv 29 \\pmod{36}$。新的模 $36$ 是原始模的最小公倍数：$\\text{lcm}(12, 18) = 36$。\n\n原来的三个同余方程组现在简化为两个同余方程组：\n1. $x \\equiv 29 \\pmod{36}$\n2. $x \\equiv 7 \\pmod{25}$\n模为 $36$ 和 $25$。我们检查它们是否互质：$\\gcd(36, 25) = \\gcd(2^2 \\cdot 3^2, 5^2) = 1$。由于它们互质，中国剩余定理保证在模它们的乘积 $M = 36 \\cdot 25 = 900$ 下存在唯一解。这个模 $M=900$ 是最初三个模的最小公倍数，$\\text{lcm}(12, 18, 25) = \\text{lcm}(36, 25) = 900$。这就是所要求的推导出的模 $M$。\n\n我们继续求解。由 $x \\equiv 29 \\pmod{36}$，我们写出 $x = 36k' + 29$，其中 $k'$ 是某个整数。代入第三个同余方程：\n$36k' + 29 \\equiv 7 \\pmod{25}$\n注意到 $36 \\equiv 11 \\pmod{25}$ 和 $29 \\equiv 4 \\pmod{25}$，我们有：\n$11k' + 4 \\equiv 7 \\pmod{25}$\n$11k' \\equiv 3 \\pmod{25}$\n为了解出 $k'$，我们需要求 $11$ 在模 $25$ 下的乘法逆元。我们使用扩展欧几里得算法：\n$25 = 2 \\cdot 11 + 3$\n$11 = 3 \\cdot 3 + 2$\n$3 = 1 \\cdot 2 + 1$\n向后回代：\n$1 = 3 - 1 \\cdot 2$\n$1 = 3 - 1 \\cdot (11 - 3 \\cdot 3) = 4 \\cdot 3 - 1 \\cdot 11$\n$1 = 4 \\cdot (25 - 2 \\cdot 11) - 1 \\cdot 11 = 4 \\cdot 25 - 8 \\cdot 11 - 1 \\cdot 11 = 4 \\cdot 25 - 9 \\cdot 11$\n从方程 $4 \\cdot 25 - 9 \\cdot 11 = 1$ 中，我们看到 $-9 \\cdot 11 \\equiv 1 \\pmod{25}$。由于 $-9 \\equiv 16 \\pmod{25}$，所以 $11$ 在模 $25$ 下的逆元是 $16$。\n\n将同余方程 $11k' \\equiv 3 \\pmod{25}$ 两边乘以 $16$：\n$16 \\cdot (11k') \\equiv 16 \\cdot 3 \\pmod{25}$\n$k' \\equiv 48 \\pmod{25}$\n$k' \\equiv 23 \\pmod{25}$\n所以，$k'$ 必须是 $k' = 25m + 23$ 的形式，其中 $m$ 是某个整数。将此代回 $x$ 的表达式中：\n$x = 36k' + 29 = 36(25m + 23) + 29$\n$x = 36 \\cdot 25m + 36 \\cdot 23 + 29$\n$x = 900m + 828 + 29$\n$x = 900m + 857$\n这给出了完整的解集为 $x \\equiv 857 \\pmod{900}$。\n\n最小非负解 $x_0$ 是解除以模 $M=900$ 后的余数。在这种情况下，$x_0 = 857$。\n\n为了验证，我们将 $x_0=857$ 代入原始的同余方程进行检查：\n- $857 = 71 \\cdot 12 + 5 \\implies 857 \\equiv 5 \\pmod{12}$。\n- $857 = 47 \\cdot 18 + 11 \\implies 857 \\equiv 11 \\pmod{18}$。\n- $857 = 34 \\cdot 25 + 7 \\implies 857 \\equiv 7 \\pmod{25}$。\n解是正确的。完整解集的显式描述是 $x \\equiv 857 \\pmod{900}$，推导出的模是 $M=900$，最小非负解是 $x_0 = 857$。", "answer": "$$\n\\boxed{857}\n$$", "id": "3017102"}, {"introduction": "当一个同余方程组被确认为可解，并简化为模数两两互质的标准形式后，有多种构造性方法可以找到其唯一解。这个练习 [@problem_id:3017080] 探讨了两种强大的技巧：直观的逐次代入法和更为抽象但结构优美的正交幂等元法。通过解决这同一个问题，你将对中国剩余定理核心的同构思想有更深刻的理解。", "problem": "设 $m_1=65, m_2=27, m_3=32$ 是两两互质的正整数。考虑如下线性同余方程组\n$x \\equiv 47 \\pmod{65}$，$x \\equiv 8 \\pmod{27}$，以及 $x \\equiv 19 \\pmod{32}$。\n仅使用关于最大公约数、Bézout 恒等式以及中国剩余定理（CRT）所保证的环同构的基本性质，通过两种独立的方法，重建满足该方程组的模 $M=m_1 m_2 m_3$ 的唯一剩余类：\n\n- 方法A：利用分解 $\\mathbb{Z}/M\\mathbb{Z} \\cong \\mathbb{Z}/m_1\\mathbb{Z} \\times \\mathbb{Z}/m_2\\mathbb{Z} \\times \\mathbb{Z}/m_3\\mathbb{Z}$，从 Bézout 恒等式构造出显式的正交幂等元，然后利用这些幂等元和给定的余数合成解。从第一性原理出发，证明该构造方法为何有效。\n\n- 方法B：通过逐步消元的方式逐次求解同余方程。首先，仅利用互质性所蕴含的模逆元的存在性和扩展欧几里得算法，将前两个同余方程合并为模 $m_1 m_2$ 的单个同余方程；然后，再结合第三个同余方程，得到模 $M$ 的单个同余方程。\n\n验证两种方法得到在区间 $[0, M-1]$ 内相同的最小非负代表元。将该最小非负整数作为你的最终答案。无需四舍五入，不涉及单位。", "solution": "问题要求使用两种指定的方法求解一个线性同余方程组。给定的方程组是：\n$$x \\equiv 47 \\pmod{65}$$\n$$x \\equiv 8 \\pmod{27}$$\n$$x \\equiv 19 \\pmod{32}$$\n模数分别为 $m_1=65, m_2=27, m_3=32$。我们首先验证它们是两两互质的。每个模数的素数分解为 $m_1=5 \\times 13$, $m_2=3^3$, $m_3=2^5$。由于它们没有共同的素因子，因此它们确实是两两互质的。根据中国剩余定理，该方程组在模 $M = m_1 m_2 m_3$ 的意义下有唯一解。\n我们来计算 $M$：\n$$M = 65 \\times 27 \\times 32 = 1755 \\times 32 = 56160$$\n我们寻求在区间 $[0, 56159]$ 内的最小非负整数解 $x$。\n\n### 方法A：通过正交幂等元构造\n\n此方法依赖于环同构 $\\phi: \\mathbb{Z}/M\\mathbb{Z} \\to \\mathbb{Z}/m_1\\mathbb{Z} \\times \\mathbb{Z}/m_2\\mathbb{Z} \\times \\mathbb{Z}/m_3\\mathbb{Z}$，其中 $\\phi(x \\pmod{M}) = (x \\pmod{m_1}, x \\pmod{m_2}, x \\pmod{m_3})$。我们给定了目标元组 $(47, 8, 19)$，需要找到其原像 $x$。我们通过找到特殊的元素 $e_1, e_2, e_3 \\in \\mathbb{Z}/M\\mathbb{Z}$ 来构造这个原像，这些元素对应于积环中的标准基向量 $(1, 0, 0)$、$(0, 1, 0)$ 和 $(0, 0, 1)$。这些元素就是正交幂等元。\n\n元素 $e_i$ 必须满足：\n$$e_{i} \\equiv 1 \\pmod{m_{i}}$$\n$$e_{i} \\equiv 0 \\pmod{m_{j}} \\quad \\text{for } j \\neq i$$\n第二个条件意味着 $e_i$ 必须是 $M_i = M/m_i = \\prod_{j \\neq i} m_j$ 的倍数。因此，我们可以将 $e_i$ 写成 $e_i = c_i M_i$ 的形式，其中 $c_i$ 是某个整数。\n第一个条件变为 $c_i M_i \\equiv 1 \\pmod{m_i}$。这意味着 $c_i$ 是 $M_i$ 模 $m_i$ 的乘法逆元。由于 $m_j$ 是两两互质的，$\\gcd(M_i, m_i) = 1$ 成立，因此这个逆元的存在性得到了保证。\n一旦我们找到了 $e_1, e_2, e_3$，解 $x$ 就由以下线性组合给出：\n$$x \\equiv a_{1}e_{1} + a_{2}e_{2} + a_{3}e_{3} \\pmod{M}$$\n其中 $a_1=47, a_2=8, a_3=19$。这个构造是有效的，因为当我们将 $x$ 模 $m_i$ 时，所有 $j \\neq i$ 的项 $a_j e_j$ 都变为 $0$（因为 $e_j \\equiv 0 \\pmod{m_i}$）。项 $a_i e_i$ 变为 $a_i \\cdot 1 = a_i$。因此，对于每个 $i$，$x \\equiv a_i \\pmod{m_i}$ 都成立，从而满足整个方程组。\n\n**1. 计算 $e_{1}$：**\n$M_1 = m_2 m_3 = 27 \\times 32 = 864$。我们需要求解 $c_1 \\cdot 864 \\equiv 1 \\pmod{65}$。\n首先，将 $864$ 模 $65$ 进行约化：$864 = 13 \\times 65 + 19$。该同余方程为 $19c_1 \\equiv 1 \\pmod{65}$。\n我们使用扩展欧几里得算法来求 $19$ 模 $65$ 的逆元。\n$65 = 3 \\cdot 19 + 8$\n$19 = 2 \\cdot 8 + 3$\n$8 = 2 \\cdot 3 + 2$\n$3 = 1 \\cdot 2 + 1$\n逆向回代（Bézout 恒等式）：\n$1 = 3 - 1 \\cdot 2 = 3 - (8 - 2 \\cdot 3) = 3 \\cdot 3 - 8$\n$1 = 3 \\cdot (19 - 2 \\cdot 8) - 8 = 3 \\cdot 19 - 7 \\cdot 8$\n$1 = 3 \\cdot 19 - 7 \\cdot (65 - 3 \\cdot 19) = 3 \\cdot 19 - 7 \\cdot 65 + 21 \\cdot 19 = 24 \\cdot 19 - 7 \\cdot 65$。\n所以，$24 \\cdot 19 \\equiv 1 \\pmod{65}$。逆元是 $c_1=24$。\n$e_1 = c_1 M_1 = 24 \\times 864 = 20736$。\n\n**2. 计算 $e_{2}$：**\n$M_2 = m_1 m_3 = 65 \\times 32 = 2080$。我们需要求解 $c_2 \\cdot 2080 \\equiv 1 \\pmod{27}$。\n将 $2080$ 模 $27$ 进行约化：$2080 = 77 \\times 27 + 1$。该同余方程为 $1c_2 \\equiv 1 \\pmod{27}$。\n所以，$c_2=1$。\n$e_2 = c_2 M_2 = 1 \\times 2080 = 2080$。\n\n**3. 计算 $e_{3}$：**\n$M_3 = m_1 m_2 = 65 \\times 27 = 1755$。我们需要求解 $c_3 \\cdot 1755 \\equiv 1 \\pmod{32}$。\n将 $1755$ 模 $32$ 进行约化：$1755 = 54 \\times 32 + 27$。该同余方程为 $27c_3 \\equiv 1 \\pmod{32}$，等价于 $-5c_3 \\equiv 1 \\pmod{32}$。\n我们对 $\\gcd(32, 27)$ 使用扩展欧几里得算法。\n$32 = 1 \\cdot 27 + 5$\n$27 = 5 \\cdot 5 + 2$\n$5 = 2 \\cdot 2 + 1$\n逆向回代：\n$1 = 5 - 2 \\cdot 2 = 5 - 2 \\cdot (27 - 5 \\cdot 5) = 11 \\cdot 5 - 2 \\cdot 27$\n$1 = 11 \\cdot (32 - 1 \\cdot 27) - 2 \\cdot 27 = 11 \\cdot 32 - 13 \\cdot 27$。\n所以，$-13 \\cdot 27 \\equiv 1 \\pmod{32}$。逆元是 $c_3 = -13 \\equiv 19 \\pmod{32}$。\n$e_3 = c_3 M_3 = 19 \\times 1755 = 33345$。\n\n**4. 合成解：**\n$x \\equiv 47 \\cdot e_1 + 8 \\cdot e_2 + 19 \\cdot e_3 \\pmod{56160}$\n$x \\equiv 47 \\cdot 20736 + 8 \\cdot 2080 + 19 \\cdot 33345 \\pmod{56160}$\n$x \\equiv 974592 + 16640 + 633555 \\pmod{56160}$\n$x \\equiv 1624787 \\pmod{56160}$\n为了找到最小非负代表元，我们计算余数：\n$1624787 = 28 \\times 56160 + 52307$。\n所以，$x \\equiv 52307 \\pmod{56160}$。\n\n### 方法B：逐次代入\n\n此方法涉及依次求解同余方程。\n\n**1. 合并前两个同余方程：**\n$x \\equiv 47 \\pmod{65}$\n$x \\equiv 8 \\pmod{27}$\n由第一个同余方程，可将 $x$ 写成 $x = 65k + 47$ 的形式，其中 $k$ 为某个整数。将此代入第二个同余方程：\n$65k + 47 \\equiv 8 \\pmod{27}$\n$65k \\equiv 8 - 47 \\pmod{27}$\n$65k \\equiv -39 \\pmod{27}$\n将系数模 $27$ 进行约化：$65 \\equiv 11 \\pmod{27}$ 且 $-39 \\equiv 15 \\pmod{27}$。\n同余方程变为 $11k \\equiv 15 \\pmod{27}$。\n为了解出 $k$，我们需要求 $11$ 模 $27$ 的逆元。根据欧几里得算法：\n$27 = 2 \\cdot 11 + 5$\n$11 = 2 \\cdot 5 + 1$\n$1 = 11 - 2 \\cdot 5 = 11 - 2(27 - 2 \\cdot 11) = 5 \\cdot 11 - 2 \\cdot 27$。\n因此，$5 \\cdot 11 \\equiv 1 \\pmod{27}$。逆元是 $5$。\n将同余方程两边乘以 $5$：\n$k \\equiv 15 \\cdot 5 \\pmod{27} \\implies k \\equiv 75 \\pmod{27}$。\n因为 $75 = 2 \\times 27 + 21$，我们有 $k \\equiv 21 \\pmod{27}$。\n所以，$k = 27j + 21$，其中 $j$ 为某个整数。\n将此代回 $x$ 的表达式中：\n$x = 65(27j + 21) + 47 = (65 \\cdot 27)j + (65 \\cdot 21) + 47 = 1755j + 1365 + 47 = 1755j + 1412$。\n这将前两个同余方程合并为一个：$x \\equiv 1412 \\pmod{1755}$。\n\n**2. 与第三个同余方程合并：**\n我们现在求解方程组：\n$x \\equiv 1412 \\pmod{1755}$\n$x \\equiv 19 \\pmod{32}$\n由新的同余方程，$x = 1755j + 1412$。代入第三个原始同余方程：\n$1755j + 1412 \\equiv 19 \\pmod{32}$\n$1755j \\equiv 19 - 1412 \\pmod{32}$\n$1755j \\equiv -1393 \\pmod{32}$\n将系数模 $32$ 进行约化：\n$1755 = 54 \\times 32 + 27 \\implies 1755 \\equiv 27 \\pmod{32}$。\n$-1393 = -44 \\times 32 + 15 \\implies -1393 \\equiv 15 \\pmod{32}$。\n同余方程变为 $27j \\equiv 15 \\pmod{32}$。\n我们需要求 $27$ 模 $32$ 的逆元。如方法A中所计算，由 $11 \\cdot 32 - 13 \\cdot 27 = 1$ 可知 $-13 \\cdot 27 \\equiv 1 \\pmod{32}$。逆元是 $-13 \\equiv 19 \\pmod{32}$。\n将同余方程两边乘以 $19$：\n$j \\equiv 15 \\cdot 19 \\pmod{32} \\implies j \\equiv 285 \\pmod{32}$。\n因为 $285 = 8 \\times 32 + 29$，我们有 $j \\equiv 29 \\pmod{32}$。\n所以，$j = 32l + 29$，其中 $l$ 为某个整数。\n将此代回 $x$ 的表达式中：\n$x = 1755(32l + 29) + 1412 = (1755 \\cdot 32)l + (1755 \\cdot 29) + 1412$\n$x = 56160l + 50895 + 1412 = 56160l + 52307$。\n最终解为 $x \\equiv 52307 \\pmod{56160}$。\n\n### 验证\n两种方法都得到了相同的同余式 $x \\equiv 52307 \\pmod{56160}$。在区间 $[0, 56159]$ 内的最小非负代表元是 $52307$。我们可以验证这个解：\n$52307 = 804 \\times 65 + 47 \\implies 52307 \\equiv 47 \\pmod{65}$。\n$52307 = 1937 \\times 27 + 8 \\implies 52307 \\equiv 8 \\pmod{27}$。\n$52307 = 1634 \\times 32 + 19 \\implies 52307 \\equiv 19 \\pmod{32}$。\n该解是正确的。", "answer": "$$\\boxed{52307}$$", "id": "3017080"}, {"introduction": "许多数论算法的核心，包括求解线性同余方程，都依赖于计算乘法逆元的能力。扩展欧几里得算法为此提供了一种直接而高效的方法。这个问题 [@problem_id:3017099] 旨在让你练习使用大数来掌握这项基本技能，并巧妙地要求你使用中国剩余定理来验证结果，从而加深对这两个基石概念之间内在联系的理解。", "problem": "设 $n$ 和 $a$ 为整数，且 $\\gcd(a,n)=1$，因此 $a$ 存在模 $n$ 的乘法逆元。模 $n$ 的乘法逆元是满足 $a x \\equiv 1 \\pmod{n}$ 的唯一剩余类 $x \\in \\{0,1,\\dots,n-1\\}$。仅从模 $n$ 同余、模 $n$ 整数环中的可逆性，以及对于任何最大公约数为1的整数对，由贝祖恒等式保证的整数 $u,v$ 的存在性这些基础出发。在这些基础上，给出一个通过扩展欧几里得算法（EEA）计算 $a^{-1} \\pmod n$ 的分步方法，然后使用中国剩余定理（CRT）验证结果。\n\n具体地，取 $n = 101 \\cdot 103 \\cdot 107$ 和 $a = 567890$。你的任务是：\n- 推导并执行基于EEA的计算，以找到满足 $a x \\equiv 1 \\pmod{n}$ 的 $x$。\n- 通过对 $n$ 的素因子取模进行计算并确认一致性，使用中国剩余定理独立地验证结果的正确性。\n- 将最终答案表示为满足 $a x \\equiv 1 \\pmod{n}$ 的唯一整数 $x \\in \\{0,1,\\dots,n-1\\}$。\n\n无需四舍五入。将你的最终答案作为一个精确的整数提供。", "solution": "题目要求我们找到一个整数 $a$ 模一个合数 $n$ 的乘法逆元。给定 $n = 101 \\cdot 103 \\cdot 107$ 和 $a = 567890$。任务是首先使用扩展欧几里得算法（EEA）计算逆元，然后使用中国剩余定理（CRT）验证这个结果。\n\n首先，我们计算 $n$ 的值：\n$n = 101 \\cdot 103 \\cdot 107 = 10403 \\cdot 107 = 1113121$。\n问题是找到唯一的整数 $x \\in \\{0, 1, \\dots, 1113120\\}$，使得 $567890x \\equiv 1 \\pmod{1113121}$。\n\n$a$ 模 $n$ 的乘法逆元存在的充要条件是 $\\gcd(a, n) = 1$。$n$ 的素因子是 $101$、$103$ 和 $107$。我们必须验证 $a$ 不能被这些素数中的任何一个整除。\n- $567890 \\pmod{101}$：$567890 = 5622 \\cdot 101 + 68$，所以 $567890 \\equiv 68 \\pmod{101}$。\n- $567890 \\pmod{103}$：$567890 = 5513 \\cdot 103 + 51$，所以 $567890 \\equiv 51 \\pmod{103}$。\n- $567890 \\pmod{107}$：$567890 = 5307 \\cdot 107 + 41$，所以 $567890 \\equiv 41 \\pmod{107}$。\n由于 $a$ 模 $n$ 的任何素因子都不同余于 $0$，所以它不能被它们整除。因此，$\\gcd(a, n) = 1$，且乘法逆元存在且唯一。\n\n**第一部分：使用扩展欧几里得算法（EEA）计算逆元**\n\n该问题基于贝祖恒等式，该恒等式表明，对于满足 $\\gcd(a, n) = 1$ 的整数 $a$ 和 $n$，存在整数 $u$ 和 $v$ 使得 $au + nv = 1$。将此方程模 $n$ 可得：\n$$au + nv \\equiv 1 \\pmod{n}$$\n$$au + 0 \\equiv 1 \\pmod{n}$$\n$$au \\equiv 1 \\pmod{n}$$\n这表明通过贝祖恒等式找到的整数 $u$ 是 $a$ 模 $n$ 的一个乘法逆元。扩展欧几里得算法是找到这些整数 $u$ 和 $v$ 的一种构造性方法。我们将EEA应用于 $a = 567890$ 和 $n = 1113121$。\n\n我们使用表格形式的EEA。令 $r_0=n$ 和 $r_1=a$。我们生成序列 $r_i, q_i, s_i, t_i$ 使得 $r_i = s_i n + t_i a$。初始值为 $(r_0, s_0, t_0) = (n, 1, 0)$ 和 $(r_1, s_1, t_1) = (a, 0, 1)$。递推关系为 $r_{i+1} = r_{i-1} - q_i r_i$，$s_{i+1} = s_{i-1} - q_i s_i$ 和 $t_{i+1} = t_{i-1} - q_i t_i$，其中 $q_i = \\lfloor r_{i-1} / r_i \\rfloor$。\n\n算法的步骤如下：\n$r_0 = 1113121$, $r_1 = 567890$。\n1. $1113121 = 1 \\cdot 567890 + 545231$，所以 $q_2=1$。\n2. $567890 = 1 \\cdot 545231 + 22659$，所以 $q_3=1$。\n3. $545231 = 24 \\cdot 22659 + 1415$，所以 $q_4=24$。\n4. $22659 = 16 \\cdot 1415 + 19$，所以 $q_5=16$。\n5. $1415 = 74 \\cdot 19 + 9$，所以 $q_6=74$。\n6. $19 = 2 \\cdot 9 + 1$，所以 $q_7=2$。\n7. $9 = 9 \\cdot 1 + 0$，所以 $\\gcd(a, n)=1$。\n\n现在我们为 $s_i$ 和 $t_i$ 构建表格：\n$i$ | $r_i$     | $q_i$ | $s_i$     | $t_i$\n--|-----------|-------|-----------|-----------\n$0$ | $1113121$   | -     | $1$         | $0$\n$1$ | $567890$    | -     | $0$         | $1$\n$2$ | $545231$    | $1$     | $1 - 1 \\cdot 0 = 1$ | $0 - 1 \\cdot 1 = -1$\n$3$ | $22659$     | $1$     | $0 - 1 \\cdot 1 = -1$ | $1 - 1 \\cdot (-1) = 2$\n$4$ | $1415$      | $24$    | $1 - 24 \\cdot (-1) = 25$ | $-1 - 24 \\cdot 2 = -49$\n$5$ | $19$        | $16$    | $-1 - 16 \\cdot 25 = -401$ | $2 - 16 \\cdot (-49) = 786$\n$6$ | $9$         | $74$    | $25 - 74 \\cdot (-401) = 29699$ | $-49 - 74 \\cdot 786 = -58213$\n$7$ | $1$         | $2$     | $-401 - 2 \\cdot 29699 = -59799$ | $786 - 2 \\cdot (-58213) = 117212$\n\n从最后一行，我们得到 $r_7 = 1$，其中 $s_7 = -59799$ 且 $t_7 = 117212$。这给出了贝祖恒等式：\n$$1 = (-59799) \\cdot n + (117212) \\cdot a$$\n$$-59799 \\cdot 1113121 + 117212 \\cdot 567890 = 1$$\n将此方程模 $n = 1113121$ 可得：\n$$117212 \\cdot 567890 \\equiv 1 \\pmod{1113121}$$\n乘法逆元 $x$ 是 $a$ 的系数，即 $117212$。该值在所要求的范围 $\\{0, 1, \\dots, 1113120\\}$ 内。\n所以，$x = 117212$。\n\n**第二部分：使用中国剩余定理（CRT）进行验证**\n\nCRT 表明，单个同余式 $ax \\equiv 1 \\pmod{n}$ 等价于一个模 $n$ 的素数幂因子的同余方程组。由于 $n = 101 \\cdot 103 \\cdot 107$，原始同余式等价于以下方程组：\n1. $567890x \\equiv 1 \\pmod{101}$\n2. $567890x \\equiv 1 \\pmod{103}$\n3. $567890x \\equiv 1 \\pmod{107}$\n\n我们首先将 $a = 567890$ 对每个素因子取模：\n- $a \\equiv 68 \\pmod{101}$\n- $a \\equiv 51 \\pmod{103}$\n- $a \\equiv 41 \\pmod{107}$\n\n将这些代入方程组，我们得到：\n1. $68x \\equiv 1 \\pmod{101}$\n2. $51x \\equiv 1 \\pmod{103}$\n3. $41x \\equiv 1 \\pmod{107}$\n\n为了验证我们的解 $x=117212$，我们必须证明它满足这个同余方程组。为此，我们需要知道 $x$ 应该模每个素数同余于什么。我们为每个同余式找到逆元：\n- 对于 $68x \\equiv 1 \\pmod{101}$：对 $68$ 和 $101$ 使用EEA，我们找到 $1 = 33 \\cdot 101 - 49 \\cdot 68$。因此，$68^{-1} \\equiv -49 \\equiv 52 \\pmod{101}$。所以，$x$ 必须同余于 $52 \\pmod{101}$。\n- 对于 $51x \\equiv 1 \\pmod{103}$：从 $103 = 2 \\cdot 51 + 1$，我们有 $1 = 103 - 2 \\cdot 51$。因此，$51^{-1} \\equiv -2 \\equiv 101 \\pmod{103}$。所以，$x$ 必须同余于 $101 \\pmod{103}$。\n- 对于 $41x \\equiv 1 \\pmod{107}$：对 $41$ 和 $107$ 使用EEA，我们找到 $1 = 47 \\cdot 41 - 18 \\cdot 107$。因此，$41^{-1} \\equiv 47 \\pmod{107}$。所以，$x$ 必须同余于 $47 \\pmod{107}$。\n\n解 $x$ 必须满足的同余方程组是：\n1. $x \\equiv 52 \\pmod{101}$\n2. $x \\equiv 101 \\pmod{103}$\n3. $x \\equiv 47 \\pmod{107}$\n\n现在，我们验证我们的候选解 $x = 117212$ 是否满足这个方程组。\n1. 检查模 $101$：$117212 = 1160 \\cdot 101 + 52$。因此，$117212 \\equiv 52 \\pmod{101}$。该同余式成立。\n2. 检查模 $103$：$117212 = 1137 \\cdot 103 + 101$。因此，$117212 \\equiv 101 \\pmod{103}$。该同余式成立。\n3. 检查模 $107$：$117212 = 1095 \\cdot 107 + 47$。因此，$117212 \\equiv 47 \\pmod{107}$。该同余式成立。\n\n通过EEA得到的解 $x=117212$ 与从 $n$ 的素因子导出的同余方程组一致。根据中国剩余定理，这个方程组在模 $n = 1113121$ 意义下有唯一解。由于我们的解满足该方程组并且在正确的范围内，因此它就是正确的唯一逆元。验证完成。", "answer": "$$\\boxed{117212}$$", "id": "3017099"}]}