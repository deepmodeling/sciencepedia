{"hands_on_practices": [{"introduction": "本次练习是一次全面的基础训练，旨在引导您完整地实践分析二次无理数的全过程。您将需要计算 $\\sqrt{7}$ 的连分数展开，推导其渐近分数，并从第一性原理出发，验证一些控制它们的基本定理，例如行列式恒等式和误差界。这项练习将巩固您在连分数领域的计算技巧和理论基础。[@problem_id:3020976]", "problem": "设 $x=\\sqrt{7}$。一个简单连分数是形如 $[a_{0};a_{1},a_{2},\\dots]$ 的表达式，其中 $a_{0}\\in\\mathbb{Z}$ 且当 $k\\geq 1$ 时 $a_{k}\\in\\mathbb{N}$。其第 $n$ 个渐近分数是在 $a_{n}$ 后截断并求值得到的有理数。从这些定义出发（不借助任何预先给出的关于渐近分数的递推关系），完成以下任务：\n\n1. 应用二次无理数的标准提取过程，确定 $x$ 的最终周期连分数展开式。然后显式计算前六个部分商 $a_{0},a_{1},\\dots,a_{5}$ 以及对应的渐近分数 $p_{n}/q_{n}$（$n=0,1,2,3,4,5$）。\n2. 仅使用 $p_{n}/q_{n}$ 是截断式 $[a_{0};a_{1},\\dots,a_{n}]$ 这一定义性质，从基本定义出发推导恒等式 $p_{n}q_{n-1}-p_{n-1}q_{n}=(-1)^{n-1}$，并用你计算出的数据对 $n=1,2,3,4,5$ 的情况进行数值验证。\n3. 设 $x_{n+1}=[a_{n+1};a_{n+2},\\dots]$ 表示 $a_{n}$ 之后的尾部。从将 $x$ 表示为截断式 $p_{n}/q_{n}$ 和尾部 $x_{n+1}$ 的代数关系式出发，推导双边不等式\n   $$\\frac{1}{(a_{n+1}+2)q_{n}^{2}}  \\left|x-\\frac{p_{n}}{q_{n}}\\right|  \\frac{1}{a_{n+1}q_{n}^{2}}.$$\n   对你的六个渐近分数分别进行数值验证。对于所有数值验证，计算小数近似值时至少保留六位有效数字。\n4. 最后，计算第六个渐近分数的缩放误差的精确值：\n   $$E:=q_{5}^{2}\\left|\\,x-\\frac{p_{5}}{q_{5}}\\,\\right|,$$\n   并将其表示为最简根式形式的单个闭式表达式。\n\n你最终报告的答案必须是你为 $E$ 求得的单个精确表达式（无小数近似，无单位）。", "solution": "该问题提法清晰，其基础是数论中关于连分数的原理。我们将给出一个完整的解法。\n\n第一个任务是确定 $x=\\sqrt{7}$ 的连分数展开式，并计算前六个部分商和渐近分数。我们使用标准算法：设 $x_0 = x$，对于 $n \\ge 0$，定义 $a_n = \\lfloor x_n \\rfloor$ 和 $x_{n+1} = \\frac{1}{x_n - a_n}$。\n\n对于 $x = \\sqrt{7}$：\n-   $x_0 = \\sqrt{7}$。由于 $2^2=4$ 和 $3^2=9$，我们有 $2  \\sqrt{7}  3$，所以 $a_0 = \\lfloor \\sqrt{7} \\rfloor = 2$。\n-   $x_1 = \\frac{1}{x_0 - a_0} = \\frac{1}{\\sqrt{7}-2} = \\frac{\\sqrt{7}+2}{7-4} = \\frac{\\sqrt{7}+2}{3}$。由于 $4  \\sqrt{7}+2  5$，我们有 $\\frac{4}{3}  x_1  \\frac{5}{3}$，所以 $a_1 = \\lfloor x_1 \\rfloor = 1$。\n-   $x_2 = \\frac{1}{x_1 - a_1} = \\frac{1}{\\frac{\\sqrt{7}+2}{3}-1} = \\frac{3}{\\sqrt{7}-1} = \\frac{3(\\sqrt{7}+1)}{7-1} = \\frac{\\sqrt{7}+1}{2}$。由于 $3  \\sqrt{7}+1  4$，我们有 $\\frac{3}{2}  x_2  2$，所以 $a_2 = \\lfloor x_2 \\rfloor = 1$。\n-   $x_3 = \\frac{1}{x_2 - a_2} = \\frac{1}{\\frac{\\sqrt{7}+1}{2}-1} = \\frac{2}{\\sqrt{7}-1} = \\frac{2(\\sqrt{7}+1)}{7-1} = \\frac{\\sqrt{7}+1}{3}$。由于 $3  \\sqrt{7}+1  4$，我们有 $1  x_3  \\frac{4}{3}$，所以 $a_3 = \\lfloor x_3 \\rfloor = 1$。\n-   $x_4 = \\frac{1}{x_3 - a_3} = \\frac{1}{\\frac{\\sqrt{7}+1}{3}-1} = \\frac{3}{\\sqrt{7}-2} = \\frac{3(\\sqrt{7}+2)}{7-4} = \\sqrt{7}+2$。所以 $a_4 = \\lfloor \\sqrt{7}+2 \\rfloor = 2+2=4$。\n-   $x_5 = \\frac{1}{x_4 - a_4} = \\frac{1}{(\\sqrt{7}+2)-4} = \\frac{1}{\\sqrt{7}-2} = x_1$。\n由于 $x_5 = x_1$，部分商序列从 $a_1$ 开始是周期的。$\\sqrt{7}$ 的连分数展开式是 $[2;\\overline{1,1,1,4}]$。\n\n前六个部分商是 $a_0=2$, $a_1=1$, $a_2=1$, $a_3=1$, $a_4=4$, $a_5=1$。\n相应的渐近分数 $p_n/q_n = [a_0; a_1, \\dots, a_n]$ 计算如下：\n-   $n=0$: $\\frac{p_0}{q_0} = [2] = \\frac{2}{1}$。\n-   $n=1$: $\\frac{p_1}{q_1} = [2;1] = 2+\\frac{1}{1} = \\frac{3}{1}$。\n-   $n=2$: $\\frac{p_2}{q_2} = [2;1,1] = 2+\\frac{1}{1+\\frac{1}{1}} = 2+\\frac{1}{2} = \\frac{5}{2}$。\n-   $n=3$: $\\frac{p_3}{q_3} = [2;1,1,1] = 2+\\frac{1}{1+\\frac{1}{1+\\frac{1}{1}}} = 2+\\frac{1}{1+\\frac{1}{2}} = 2+\\frac{2}{3} = \\frac{8}{3}$。\n-   $n=4$: $\\frac{p_4}{q_4} = [2;1,1,1,4] = 2+\\frac{1}{[1;1,1,4]} = 2+\\frac{1}{1+\\frac{1}{1+\\frac{1}{1+\\frac{1}{4}}}} = 2+\\frac{1}{1+\\frac{1}{1+\\frac{4}{5}}} = 2+\\frac{1}{1+\\frac{5}{9}} = 2+\\frac{9}{14} = \\frac{37}{14}$。\n-   $n=5$: $\\frac{p_5}{q_5} = [2;1,1,1,4,1] = 2+\\frac{1}{[1;1,1,4,1]} = 2+\\frac{1}{1+\\frac{1}{1+\\frac{1}{1+\\frac{1}{4+\\frac{1}{1}}}}} = 2+\\frac{1}{1+\\frac{1}{1+\\frac{5}{6}}} = 2+\\frac{1}{1+\\frac{6}{11}} = 2+\\frac{11}{17} = \\frac{45}{17}$。\n\n部分商和渐近分数总结：\n$a_0=2, p_0=2, q_0=1$\n$a_1=1, p_1=3, q_1=1$\n$a_2=1, p_2=5, q_2=2$\n$a_3=1, p_3=8, q_3=3$\n$a_4=4, p_4=37, q_4=14$\n$a_5=1, p_5=45, q_5=17$\n\n对于第二个任务，我们必须推导恒等式 $p_n q_{n-1} - p_{n-1} q_n = (-1)^{n-1}$。这可以从基本定义出发，通过将连分数结构看作线性分式变换的复合来实现。$[x_0; x_1, \\dots, x_n]$ 的值可以通过相继应用变换 $z \\mapsto x_0 + 1/z$ 得到。这对应于矩阵乘法。我们定义矩阵 $M_k = \\begin{pmatrix} a_k  1 \\\\ 1  0 \\end{pmatrix}$。渐近分数由递推关系 $p_n = a_n p_{n-1} + p_{n-2}$ 和 $q_n = a_n q_{n-1} + q_{n-2}$ 给出，初始条件为 $p_{-1}=1, q_{-1}=0, p_{-2}=0, q_{-2}=1$。这些关系可以写成矩阵形式：\n$$ \\begin{pmatrix} p_n  p_{n-1} \\\\ q_n  q_{n-1} \\end{pmatrix} = \\begin{pmatrix} p_{n-1}  p_{n-2} \\\\ q_{n-1}  q_{n-2} \\end{pmatrix} \\begin{pmatrix} a_n  1 \\\\ 1  0 \\end{pmatrix} $$\n通过归纳法，从 $\\begin{pmatrix} p_{-1}  p_{-2} \\\\ q_{-1}  q_{-2} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I$ 开始，我们有：\n$$ \\begin{pmatrix} p_n  p_{n-1} \\\\ q_n  q_{n-1} \\end{pmatrix} = \\begin{pmatrix} a_0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} a_1  1 \\\\ 1  0 \\end{pmatrix} \\cdots \\begin{pmatrix} a_n  1 \\\\ 1  0 \\end{pmatrix} $$\n对两边取行列式，我们得到 $p_n q_{n-1} - p_{n-1} q_n$。矩阵乘积的行列式是它们各自的行列式的乘积。每个矩阵 $\\begin{pmatrix} a_k  1 \\\\ 1  0 \\end{pmatrix}$ 的行列式是 $a_k(0) - 1(1) = -1$。由于乘积中有 $n+1$ 个这样的矩阵（$k=0, 1, \\dots, n$），总行列式为 $(-1)^{n+1}$。\n因此，$p_n q_{n-1} - p_{n-1} q_n = (-1)^{n+1}$。由于 $(-1)^{n+1} = (-1)^{n-1}(-1)^2 = (-1)^{n-1}$，我们已经推导出了所需的恒等式：\n$$ p_n q_{n-1} - p_{n-1} q_n = (-1)^{n-1} $$\n对 $n=1, \\dots, 5$ 的数值验证：\n-   $n=1$: $p_1q_0-p_0q_1 = (3)(1)-(2)(1)=1$。公式：$(-1)^{1-1}=1$。已验证。\n-   $n=2$: $p_2q_1-p_1q_2 = (5)(1)-(3)(2)=-1$。公式：$(-1)^{2-1}=-1$。已验证。\n-   $n=3$: $p_3q_2-p_2q_3 = (8)(2)-(5)(3)=1$。公式：$(-1)^{3-1}=1$。已验证。\n-   $n=4$: $p_4q_3-p_3q_4 = (37)(3)-(8)(14)=111-112=-1$。公式：$(-1)^{4-1}=-1$。已验证。\n-   $n=5$: $p_5q_4-p_4q_5 = (45)(14)-(37)(17)=630-629=1$。公式：$(-1)^{5-1}=1$。已验证。\n\n对于第三个任务，我们推导双边误差界。我们从代数关系式 $x = [a_0; a_1, \\dots, a_n, x_{n+1}]$ 开始，根据与上述相同的逻辑，可以表示为：\n$$ x = \\frac{x_{n+1}p_n + p_{n-1}}{x_{n+1}q_n + q_{n-1}} $$\n于是误差为：\n$$ x - \\frac{p_n}{q_n} = \\frac{x_{n+1}p_n + p_{n-1}}{x_{n+1}q_n + q_{n-1}} - \\frac{p_n}{q_n} = \\frac{p_{n-1}q_n - p_n q_{n-1}}{q_n(x_{n+1}q_n + q_{n-1})} = \\frac{-(-1)^{n-1}}{q_n(x_{n+1}q_n + q_{n-1})} = \\frac{(-1)^n}{q_n(x_{n+1}q_n + q_{n-1})} $$\n取绝对值，我们得到：\n$$ \\left|x - \\frac{p_n}{q_n}\\right| = \\frac{1}{q_n(x_{n+1}q_n + q_{n-1})} = \\frac{1}{q_n^2(x_{n+1} + q_{n-1}/q_n)} $$\n我们有 $x_{n+1} = [a_{n+1}; a_{n+2}, \\dots] = a_{n+1} + 1/x_{n+2}$。由于 $x$ 是无理数，所以对所有 $n$，$x_{n+1}$ 也是无理数。因此 $a_{n+1}  x_{n+1}$。另外，$x_{n+2} > 1$，所以 $0  1/x_{n+2}  1$，这意味着 $a_{n+1}  x_{n+1}  a_{n+1}+1$。\n对于误差的上界：分母 $q_n^2(x_{n+1} + q_{n-1}/q_n) > q_n^2(a_{n+1} + 0) = a_{n+1}q_n^2$，因为 $q_{n-1}/q_n \\ge 0$。这给出 $\\left|x - \\frac{p_n}{q_n}\\right|  \\frac{1}{a_{n+1}q_n^2}$。\n对于误差的下界：分母 $q_n^2(x_{n+1} + q_{n-1}/q_n)  q_n^2((a_{n+1}+1) + q_{n-1}/q_n)$。分母序列 $q_n$ 当 $n \\ge 1$ 时是严格递增的，所以当 $n \\ge 2$ 时 $q_{n-1}/q_n  1$。对于 $n=1$, $q_0/q_1 = 1/a_1 \\le 1$。对于 $n=0$, $q_{-1}/q_0 = 0 \\le 1$。所以我们总是有 $q_{n-1}/q_n \\le 1$。\n因此分母小于 $q_n^2((a_{n+1}+1)+1) = (a_{n+1}+2)q_n^2$。这得出 $\\left|x - \\frac{p_n}{q_n}\\right| > \\frac{1}{(a_{n+1}+2)q_n^2}$。\n将这些结合起来得到所需的不等式：$\\frac{1}{(a_{n+1}+2)q_{n}^{2}}  \\left|x-\\frac{p_{n}}{q_{n}}\\right|  \\frac{1}{a_{n+1}q_{n}^{2}}$。\n\n对 $n=0, \\dots, 5$ 的数值验证，使用 $\\sqrt{7} \\approx 2.645751$：\n-   $n=0$: $a_1=1, q_0=1$。下界：$\\frac{1}{(1+2)1^2} = \\frac{1}{3} \\approx 0.333333$。误差：$|\\sqrt{7}-2| \\approx 0.645751$。上界：$\\frac{1}{1 \\cdot 1^2}=1$。不等式：$0.333333  0.645751  1.0$。已验证。\n-   $n=1$: $a_2=1, q_1=1$。下界：$\\frac{1}{(1+2)1^2} = \\frac{1}{3} \\approx 0.333333$。误差：$|\\sqrt{7}-3| \\approx 0.354249$。上界：$\\frac{1}{1 \\cdot 1^2}=1$。不等式：$0.333333  0.354249  1.0$。已验证。\n-   $n=2$: $a_3=1, q_2=2$。下界：$\\frac{1}{(1+2)2^2} = \\frac{1}{12} \\approx 0.083333$。误差：$|\\sqrt{7}-5/2| \\approx 0.145751$。上界：$\\frac{1}{1 \\cdot 2^2}=\\frac{1}{4}=0.25$。不等式：$0.083333  0.145751  0.25$。已验证。\n-   $n=3$: $a_4=4, q_3=3$。下界：$\\frac{1}{(4+2)3^2} = \\frac{1}{54} \\approx 0.018519$。误差：$|\\sqrt{7}-8/3| \\approx 0.020915$。上界：$\\frac{1}{4 \\cdot 3^2}=\\frac{1}{36} \\approx 0.027778$。不等式：$0.018519  0.020915  0.027778$。已验证。\n-   $n=4$: $a_5=1, q_4=14$。下界：$\\frac{1}{(1+2)14^2} = \\frac{1}{588} \\approx 0.001701$。误差：$|\\sqrt{7}-37/14| \\approx 0.002894$。上界：$\\frac{1}{1 \\cdot 14^2}=\\frac{1}{196} \\approx 0.005102$。不等式：$0.001701  0.002894  0.005102$。已验证。\n-   $n=5$: $a_6=a_2=1, q_5=17$。下界：$\\frac{1}{(1+2)17^2} = \\frac{1}{867} \\approx 0.001153$。误差：$|\\sqrt{7}-45/17| \\approx 0.001308$。上界：$\\frac{1}{1 \\cdot 17^2}=\\frac{1}{289} \\approx 0.003460$。不等式：$0.001153  0.001308  0.003460$。已验证。\n\n对于最后一个任务，我们计算 $E = q_{5}^{2}\\left|\\,x-\\frac{p_{5}}{q_{5}}\\,\\right|$ 的精确值。\n使用上面为 $n=5$ 推导出的精确误差公式：\n$$ E = q_5^2 \\left|x - \\frac{p_5}{q_5}\\right| = q_5^2 \\cdot \\frac{1}{q_5(x_6 q_5 + q_4)} = \\frac{q_5}{x_6 q_5 + q_4} $$\n根据我们最初的计算，我们有 $q_4=14$, $q_5=17$，以及 $x_6=x_2=\\frac{\\sqrt{7}+1}{2}$。\n代入这些值：\n$$ E = \\frac{17}{\\left(\\frac{\\sqrt{7}+1}{2}\\right)(17) + 14} = \\frac{17}{\\frac{17\\sqrt{7}+17}{2} + \\frac{28}{2}} = \\frac{17 \\cdot 2}{17\\sqrt{7}+17+28} = \\frac{34}{45+17\\sqrt{7}} $$\n为使分母有理化，我们乘以其共轭表达式：\n$$ E = \\frac{34(45-17\\sqrt{7})}{(45+17\\sqrt{7})(45-17\\sqrt{7})} = \\frac{34(45-17\\sqrt{7})}{45^2 - (17\\sqrt{7})^2} $$\n分母是 $45^2 - 17^2 \\cdot 7 = 2025 - 289 \\cdot 7 = 2025 - 2023 = 2$。\n所以，\n$$ E = \\frac{34(45-17\\sqrt{7})}{2} = 17(45-17\\sqrt{7}) = 17 \\cdot 45 - 17 \\cdot 17\\sqrt{7} = 765 - 289\\sqrt{7} $$\n这就是缩放误差以最简根式形式表示的精确值。\n或者，我们直接计算 $E = q_5 |x q_5 - p_5| = 17|17\\sqrt{7} - 45|$。由于 $45/17 \\approx 2.64705$ 而 $\\sqrt{7} \\approx 2.64575$，我们有 $45 > 17\\sqrt{7}$，所以绝对值内的表达式是负的。\n$E = 17(45 - 17\\sqrt{7}) = 765 - 289\\sqrt{7}$。", "answer": "$$\n\\boxed{765 - 289\\sqrt{7}}\n$$", "id": "3020976"}, {"introduction": "掌握了基本计算方法之后，我们现在转向周期连分数最著名的应用：求解佩尔方程 (Pell's equation)。这个问题要求您利用 $\\sqrt{94}$ 的连分数展开，计算佩尔方程 $x^2 - 94y^2 = 1$ 的基本解。这项练习展示了连分数理论在解决看似棘手的丢番图方程时所具有的非凡威力。[@problem_id:3020964]", "problem": "设 $D$ 是一个非平方数的正整数，并考虑二次无理数 $\\sqrt{D}$。$\\sqrt{D}$ 的简单连分数展开是最终周期的，其渐近分数由简单连分数的标准递推关系定义。令 $N(x + y\\sqrt{D}) = x^{2} - D y^{2}$ 表示从实二次域 $\\mathbb{Q}(\\sqrt{D})$ 到 $\\mathbb{Q}$ 的域范数，并回想一下，佩尔方程 $x^{2} - D y^{2} = 1$ 的一个基本解对应于 $\\mathbb{Q}(\\sqrt{D})$ 整数环中的基本单位。\n\n从简单连分数的定义、渐近分数的递推关系以及范数的定义出发，对 $D = 94$ 进行如下操作：\n\n1. 计算 $\\sqrt{94}$ 的简单连分数展开，直到周期闭合，并确定周期长度 $\\ell$。\n2. 通过标准递推关系 $(p_{-1},q_{-1}) = (1,0)$，$(p_{0},q_{0}) = (a_{0},1)$，以及对所有 $n \\geq 1$ 的 $p_{n} = a_{n} p_{n-1} + p_{n-2}$，$q_{n} = a_{n} q_{n-1} + q_{n-2}$，从部分商生成渐近分数序列 $\\frac{p_{n}}{q_{n}}$，其中 $a_{0} = \\lfloor \\sqrt{94} \\rfloor$ 且 $a_{n}$ 是展开式中后续的部分商。\n3. 仅使用这些定义以及关于二次无理数连分数周期性及其回文结构的已知事实，判断哪个渐近分数指数 $n$ 产生方程 $x^{2} - 94 y^{2} = 1$ 的解。然后计算相应的整数 $x = p_{n}$ 和 $y = q_{n}$ 并数值验证 $x^{2} - 94 y^{2} = 1$。\n4. 此外，数值检验长度为 $2\\ell$ 的渐近分数是否产生方程 $x^{2} - 94 y^{2} = 1$ 的基本解，并根据 $\\ell$ 的奇偶性解释你的发现。\n\n以精确形式给出你的最终答案，即基本单位 $\\varepsilon = x + y\\sqrt{94}$。不需要四舍五入。你的最终答案必须是单一的封闭形式表达式。", "solution": "该问题要求找到实二次域 $\\mathbb{Q}(\\sqrt{94})$ 的基本单位，这等同于找到佩尔方程 $x^2 - 94y^2 = 1$ 的基本解 $(x, y)$。指定的方法是使用 $\\sqrt{94}$ 的简单连分数展开。\n\n该问题是有效的，因为它在数论的既定数学框架内是适定的，特别是关于二次无理数、它们的连分数展开以及佩尔型丢番图方程之间的关系。所有给出的定义和常数都是标准的且自洽的。\n\n**1. $\\sqrt{94}$ 的简单连分数展开**\n\n我们使用标准算法计算 $\\sqrt{94}$ 的简单连分数的部分商序列 $a_n$。令 $\\xi_0 = \\sqrt{94}$。对于 $n \\ge 0$，我们定义 $a_n = \\lfloor \\xi_n \\rfloor$ 和 $\\xi_{n+1} = \\frac{1}{\\xi_n - a_n}$。\n\n$a_0 = \\lfloor \\sqrt{94} \\rfloor = 9$，因为 $9^2 = 81$ 且 $10^2 = 100$。\n$\\xi_1 = \\frac{1}{\\sqrt{94} - 9} = \\frac{\\sqrt{94} + 9}{94 - 81} = \\frac{\\sqrt{94} + 9}{13}$。所以，$a_1 = \\lfloor \\frac{9.695... + 9}{13} \\rfloor = \\lfloor \\frac{18.695...}{13} \\rfloor = 1$。\n$\\xi_2 = \\frac{1}{\\frac{\\sqrt{94} + 9}{13} - 1} = \\frac{13}{\\sqrt{94} - 4} = \\frac{13(\\sqrt{94} + 4)}{94 - 16} = \\frac{\\sqrt{94} + 4}{6}$。所以，$a_2 = \\lfloor \\frac{9.695... + 4}{6} \\rfloor = \\lfloor \\frac{13.695...}{6} \\rfloor = 2$。\n$\\xi_3 = \\frac{1}{\\frac{\\sqrt{94} + 4}{6} - 2} = \\frac{6}{\\sqrt{94} - 8} = \\frac{6(\\sqrt{94} + 8)}{94 - 64} = \\frac{\\sqrt{94} + 8}{5}$。所以，$a_3 = \\lfloor \\frac{9.695... + 8}{5} \\rfloor = \\lfloor \\frac{17.695...}{5} \\rfloor = 3$。\n$\\xi_4 = \\frac{1}{\\frac{\\sqrt{94} + 8}{5} - 3} = \\frac{5}{\\sqrt{94} - 7} = \\frac{5(\\sqrt{94} + 7)}{94 - 49} = \\frac{\\sqrt{94} + 7}{9}$。所以，$a_4 = \\lfloor \\frac{16.695...}{9} \\rfloor = 1$。\n$\\xi_5 = \\frac{1}{\\frac{\\sqrt{94} + 7}{9} - 1} = \\frac{9}{\\sqrt{94} - 2} = \\frac{9(\\sqrt{94} + 2)}{94 - 4} = \\frac{\\sqrt{94} + 2}{10}$。所以，$a_5 = \\lfloor \\frac{11.695...}{10} \\rfloor = 1$。\n$\\xi_6 = \\frac{1}{\\frac{\\sqrt{94} + 2}{10} - 1} = \\frac{10}{\\sqrt{94} - 8} = \\frac{10(\\sqrt{94} + 8)}{94 - 64} = \\frac{\\sqrt{94} + 8}{3}$。所以，$a_6 = \\lfloor \\frac{17.695...}{3} \\rfloor = 5$。\n$\\xi_7 = \\frac{1}{\\frac{\\sqrt{94} + 8}{3} - 5} = \\frac{3}{\\sqrt{94} - 7} = \\frac{3(\\sqrt{94} + 7)}{94 - 49} = \\frac{\\sqrt{94} + 7}{15}$。所以，$a_7 = \\lfloor \\frac{16.695...}{15} \\rfloor = 1$。\n$\\xi_8 = \\frac{1}{\\frac{\\sqrt{94} + 7}{15} - 1} = \\frac{15}{\\sqrt{94} - 8} = \\frac{15(\\sqrt{94} + 8)}{94 - 64} = \\frac{\\sqrt{94} + 8}{2}$。所以，$a_8 = \\lfloor \\frac{17.695...}{2} \\rfloor = 8$。\n$\\xi_9 = \\frac{1}{\\frac{\\sqrt{94} + 8}{2} - 8} = \\frac{2}{\\sqrt{94} - 8} = \\frac{2(\\sqrt{94} + 8)}{94 - 64} = \\frac{\\sqrt{94} + 8}{15}$。所以，$a_9 = \\lfloor \\frac{17.695...}{15} \\rfloor = 1$。\n$\\xi_{10} = \\frac{1}{\\frac{\\sqrt{94} + 8}{15} - 1} = \\frac{15}{\\sqrt{94} - 7} = \\frac{15(\\sqrt{94} + 7)}{94 - 49} = \\frac{\\sqrt{94} + 7}{3}$。所以，$a_{10} = \\lfloor \\frac{16.695...}{3} \\rfloor = 5$。\n$\\xi_{11} = \\frac{1}{\\frac{\\sqrt{94} + 7}{3} - 5} = \\frac{3}{\\sqrt{94} - 8} = \\frac{3(\\sqrt{94} + 8)}{94 - 64} = \\frac{\\sqrt{94} + 8}{10}$。所以，$a_{11} = \\lfloor \\frac{17.695...}{10} \\rfloor = 1$。\n$\\xi_{12} = \\frac{1}{\\frac{\\sqrt{94} + 8}{10} - 1} = \\frac{10}{\\sqrt{94} - 2} = \\frac{10(\\sqrt{94} + 2)}{94 - 4} = \\frac{\\sqrt{94} + 2}{9}$。所以，$a_{12} = \\lfloor \\frac{11.695...}{9} \\rfloor = 1$。\n$\\xi_{13} = \\frac{1}{\\frac{\\sqrt{94} + 2}{9} - 1} = \\frac{9}{\\sqrt{94} - 7} = \\frac{9(\\sqrt{94} + 7)}{94 - 49} = \\frac{\\sqrt{94} + 7}{5}$。所以，$a_{13} = \\lfloor \\frac{16.695...}{5} \\rfloor = 3$。\n$\\xi_{14} = \\frac{1}{\\frac{\\sqrt{94} + 7}{5} - 3} = \\frac{5}{\\sqrt{94} - 8} = \\frac{5(\\sqrt{94} + 8)}{94 - 64} = \\frac{\\sqrt{94} + 8}{6}$。所以，$a_{14} = \\lfloor \\frac{17.695...}{6} \\rfloor = 2$。\n$\\xi_{15} = \\frac{1}{\\frac{\\sqrt{94} + 8}{6} - 2} = \\frac{6}{\\sqrt{94} - 4} = \\frac{6(\\sqrt{94} + 4)}{94 - 16} = \\frac{\\sqrt{94} + 4}{13}$。所以，$a_{15} = \\lfloor \\frac{13.695...}{13} \\rfloor = 1$。\n$\\xi_{16} = \\frac{1}{\\frac{\\sqrt{94} + 4}{13} - 1} = \\frac{13}{\\sqrt{94} - 9} = \\frac{13(\\sqrt{94} + 9)}{94 - 81} = \\sqrt{94} + 9$。所以，$a_{16} = \\lfloor 9.695... + 9 \\rfloor = 18$。\n由于 $a_{16} = 2 a_0$，周期已经闭合。下一项是 $\\xi_{17} = \\frac{1}{(\\sqrt{94} + 9) - 18} = \\frac{1}{\\sqrt{94} - 9} = \\xi_1$。\n\n$\\sqrt{94}$ 的简单连分数展开式为 $[9; \\overline{1, 2, 3, 1, 1, 5, 1, 8, 1, 5, 1, 1, 3, 2, 1, 18}]$。\n周期长度为 $\\ell = 16$。周期部分 $(1, 2, ..., 2, 1)$ 的回文结构证实了计算的正确性。\n\n**2. 渐近分数与佩尔方程**\n\n对于一个非平方数的正整数 $D$，设 $\\sqrt{D}$ 的连分数周期为 $\\ell$。如果 $\\ell$ 是偶数，佩尔方程 $x^2 - Dy^2 = 1$ 的基本解由 $(x, y) = (p_{\\ell-1}, q_{\\ell-1})$ 给出；如果 $\\ell$ 是奇数，则由 $(x, y) = (p_{2\\ell-1}, q_{2\\ell-1})$ 给出。渐近分数 $(p_{k\\ell-1}, q_{k\\ell-1})$ 给出方程 $x^2 - Dy^2 = (-1)^{k\\ell}$ 的一个解。\n\n对于 $D=94$，周期长度为 $\\ell = 16$，是一个偶数。因此，$x^2 - 94y^2 = 1$ 的基本解由渐近分数 $(p_{15}, q_{15})$ 给出。我们使用递推关系计算渐近分数序列 $\\frac{p_n}{q_n}$：\n$p_{-1}=1, q_{-1}=0$\n$p_0=a_0=9, q_0=1$\n$p_n = a_n p_{n-1} + p_{n-2}$ 以及 $q_n = a_n q_{n-1} + q_{n-2}$ 对于 $n \\ge 1$。\n\n部分商为 $a_0=9, a_1=1, a_2=2, a_3=3, a_4=1, a_5=1, a_6=5, a_7=1, a_8=8, a_9=1, a_{10}=5, a_{11}=1, a_{12}=1, a_{13}=3, a_{14}=2, a_{15}=1$。\n\n$n=0: (p_0, q_0) = (9, 1)$\n$n=1: (p_1, q_1) = (1 \\cdot 9 + 1, 1 \\cdot 1 + 0) = (10, 1)$\n$n=2: (p_2, q_2) = (2 \\cdot 10 + 9, 2 \\cdot 1 + 1) = (29, 3)$\n$n=3: (p_3, q_3) = (3 \\cdot 29 + 10, 3 \\cdot 3 + 1) = (97, 10)$\n$n=4: (p_4, q_4) = (1 \\cdot 97 + 29, 1 \\cdot 10 + 3) = (126, 13)$\n$n=5: (p_5, q_5) = (1 \\cdot 126 + 97, 1 \\cdot 13 + 10) = (223, 23)$\n$n=6: (p_6, q_6) = (5 \\cdot 223 + 126, 5 \\cdot 23 + 13) = (1241, 128)$\n$n=7: (p_7, q_7) = (1 \\cdot 1241 + 223, 1 \\cdot 128 + 23) = (1464, 151)$\n$n=8: (p_8, q_8) = (8 \\cdot 1464 + 1241, 8 \\cdot 151 + 128) = (12953, 1336)$\n$n=9: (p_9, q_9) = (1 \\cdot 12953 + 1464, 1 \\cdot 1336 + 151) = (14417, 1487)$\n$n=10: (p_{10}, q_{10}) = (5 \\cdot 14417 + 12953, 5 \\cdot 1487 + 1336) = (85038, 8771)$\n$n=11: (p_{11}, q_{11}) = (1 \\cdot 85038 + 14417, 1 \\cdot 8771 + 1487) = (99455, 10258)$\n$n=12: (p_{12}, q_{12}) = (1 \\cdot 99455 + 85038, 1 \\cdot 10258 + 8771) = (184493, 19029)$\n$n=13: (p_{13}, q_{13}) = (3 \\cdot 184493 + 99455, 3 \\cdot 19029 + 10258) = (652934, 67345)$\n$n=14: (p_{14}, q_{14}) = (2 \\cdot 652934 + 184493, 2 \\cdot 67345 + 19029) = (1490361, 153719)$\n$n=15: (p_{15}, q_{15}) = (1 \\cdot 1490361 + 652934, 1 \\cdot 153719 + 67345) = (2143295, 221064)$\n\n基本解为 $(x, y) = (p_{15}, q_{15}) = (2143295, 221064)$。\n\n**3. 数值验证**\n\n我们验证这些值满足佩尔方程 $x^2 - 94y^2 = 1$：\n$x^2 = 2143295^2 = 4593703304025$\n$y^2 = 221064^2 = 48869280896$\n$94y^2 = 94 \\cdot 48869280896 = 4593703304024$\n$x^2 - 94y^2 = 4593703304025 - 4593703304024 = 1$。\n验证成功。整数为 $x=2143295$ 和 $y=221064$。\n\n**4. 对长度为 $2\\ell$ 的渐近分数的分析**\n\n问题要求考虑“长度为 $2\\ell$”的渐近分数。在从连分数求解佩尔方程的背景下，这指的是从第二个周期导出的解，对应于指数为 $n = 2\\ell - 1 = 2(16) - 1 = 31$ 的渐近分数。\n\n由于周期长度 $\\ell = 16$ 是偶数，理论指出，产生 $x^2 - 94y^2 = 1$ 解的第一个渐近分数的指数是 $\\ell - 1 = 15$。这个解 $(p_{15}, q_{15})$ 是*基本*解，对应于最小的正整数 $x$ 和 $y$。\n\n指数为 $2\\ell - 1 = 31$ 的渐近分数，即 $(p_{31}, q_{31})$，也会产生 $x^2 - 94y^2 = 1$ 的一个解，因为 $p_{31}^2 - 94q_{31}^2 = (-1)^{2\\ell} = (-1)^{32} = 1$。然而，这个解不是基本解。它对应于基本单位的平方：\n$(p_{15} + q_{15}\\sqrt{94})^2 = (p_{31} + q_{31}\\sqrt{94})$。\n如果周期长度 $\\ell$ 是奇数，那么指数为 $\\ell-1$ 的渐近分数会解出 $x^2 - Dy^2 = -1$。在那样的（反事实）情况下，指数为 $2\\ell-1$ 的渐近分数将是第一个解出 $x^2 - Dy^2 = 1$ 的，并因此提供基本解。因为 $\\ell=16$ 是偶数，所以对于 $D=94$ 来说情况并非如此。\n\n因此，基本单位 $\\varepsilon$ 由基本解 $(x, y) = (p_{15}, q_{15})$ 构成：\n$\\varepsilon = x + y\\sqrt{D} = 2143295 + 221064\\sqrt{94}$。", "answer": "$$\n\\boxed{2143295 + 221064\\sqrt{94}}\n$$", "id": "3020964"}, {"introduction": "最后的这项练习揭示了连分数算法与欧几里得算法 (Euclidean algorithm) 之间一个优美而深刻的联系。通过考察 $\\sqrt{61}$ 的渐近分数，您将能够仅从连分数的数据中重构出欧几里得算法应用于其分子和分母时的余数序列。这项实践揭示了数论这两大基石背后深层的结构统一性。[@problem_id:3020983]", "problem": "设 $\\alpha$ 为二次无理数 $\\sqrt{61}$。考虑其简单连分数展开以及相关的收敛子 $\\frac{p_n}{q_n}$，由 $p_{-1}=1$, $p_0=a_0$, $q_{-1}=0$, $q_0=1$ 定义，且对于 $n \\geq 1$ 满足递推关系 $p_n=a_n p_{n-1}+p_{n-2}$ 和 $q_n=a_n q_{n-1}+q_{n-2}$，其中 $[a_0; a_1, a_2, \\dots]$ 是 $\\alpha$ 的简单连分数。设 $N$ 和 $D$ 是由 $\\sqrt{61}$ 的前十个部分商得到的收敛子 $\\frac{N}{D}=\\frac{p_9}{q_9}$ 给出的互质整数。\n\n仅使用来自 $\\frac{N}{D}$ 的收敛子的数据，重建应用于 $(N,D)$ 的欧几里得算法中的余数序列 $\\{r_k\\}_{k \\geq 0}$，从 $r_{-1}=N$, $r_0=D$ 开始，并满足 $r_{k-1}=a_k r_k + r_{k+1}$，其中 $r_{10}=0$。然后确定第五个非平凡余数 $r_5$ 的精确整数值。请以不带四舍五入的整数形式提供您的答案。", "solution": "问题要求找到应用于整数 $(N,D)$ 的欧几里得算法中的第五个非平凡余数 $r_5$，其中 $(N,D)$ 由 $\\alpha = \\sqrt{61}$ 的简单连分数的收敛子 $\\frac{N}{D} = \\frac{p_9}{q_9}$ 定义。\n\n首先，我们建立 $\\frac{N}{D}$ 的连分数的部分商与应用于 $(N,D)$ 的欧几里得算法的余数之间的关系。$\\frac{N}{D} = \\frac{p_9}{q_9}$ 的连分数是有限的，由 $[a_0; a_1, a_2, \\dots, a_9]$ 给出，其中 $a_k$ 是 $\\sqrt{61}$ 的连分数的前十个部分商。\n\n对 $N$ 和 $D$ 应用欧几里得算法，由以下除法序列定义：\n\\begin{align*} N = a_0 D + r_1 \\\\ D = a_1 r_1 + r_2 \\\\ r_1 = a_2 r_2 + r_3 \\\\ \\vdots \\\\ r_{k-2} = a_{k-1} r_{k-1} + r_k \\\\ \\vdots \\\\ r_7 = a_8 r_8 + r_9 \\\\ r_8 = a_9 r_9 + r_{10} \\end{align*}\n问题用递推关系 $r_{k-1} = a_k r_k + r_{k+1}$ 来定义余数，从 $r_{-1}=N$ 和 $r_0=D$ 开始。这与上面的序列相同。当余数为零时，该过程终止。由于连分数有10个部分商（从$a_0$到$a_9$），最后一步涉及$a_9$，且问题说明 $r_{10}=0$。最后一个非零余数是 $r_9$。根据欧几里得算法的性质，$r_9 = \\gcd(N, D)$。由于 $\\frac{N}{D}=\\frac{p_9}{q_9}$ 是一个简单连分数的收敛子，其分子和分母是互质的，因此 $\\gcd(p_9, q_9) = 1$。所以，$r_9 = 1$。\n\n问题要求的是 $r_5$。我们可以从 $r_9=1$ 和 $r_{10}=0$ 开始反向计算余数序列。\n由 $r_8 = a_9 r_9 + r_{10}$，我们得到 $r_8 = a_9(1) + 0 = a_9$。\n由 $r_7 = a_8 r_8 + r_9$，我们得到 $r_7 = a_8(a_9) + 1$。\n由 $r_6 = a_7 r_7 + r_8$，我们得到 $r_6 = a_7(a_8 a_9 + 1) + a_9$。\n由 $r_5 = a_6 r_6 + r_7$，我们得到 $r_5 = a_6(a_7(a_8 a_9 + 1) + a_9) + (a_8 a_9 + 1)$。\n\n这个过程揭示了余数 $r_{9-k}$ 与反向的部分商序列 $[a_9; a_8, a_7, \\dots]$ 的收敛子有关。我们定义一个新的连分数，其商为 $c_i = a_{9-i}$，对于 $i=0, 1, 2, \\dots$。所以，$[c_0; c_1, c_2, \\dots] = [a_9; a_8, a_7, \\dots]$。\n设这个新连分数的收敛子的分子为 $P'_k$。\n$P'_0 = c_0 = a_9$。\n$P'_1 = c_1 P'_0 + 1 = a_8 a_9 + 1$。\n$P'_2 = c_2 P'_1 + P'_0 = a_7(a_8 a_9 + 1) + a_9$。\n$P'_3 = c_3 P'_2 + P'_1 = a_6(a_7(a_8 a_9 + 1) + a_9) + (a_8 a_9 + 1)$。\n\n与我们反向计算的余数（因为 $r_9=1$）进行比较：\n$r_8 = a_9 = P'_0$。\n$r_7 = a_8 a_9 + 1 = P'_1$。\n$r_6 = a_7(a_8 a_9 + 1) + a_9 = P'_2$。\n$r_5 = a_6(a_7(a_8 a_9 + 1) + a_9) + (a_8 a_9 + 1) = P'_3$。\n通常，$r_{9-k} = P'_{k-1}$。我们需要找到 $r_5$，这对应于 $9-k=5$，所以 $k=4$。因此，$r_5 = P'_3$，即 $[a_9; a_8, a_7, a_6]$ 的第3个收敛子（从0开始计数）的分子。\n\n我们的第一步是计算 $\\alpha = \\sqrt{61}$ 的部分商 $a_0, \\dots, a_9$。\n设 $\\alpha_0 = \\sqrt{61}$。我们使用标准算法 $\\alpha_{k+1} = \\frac{1}{\\alpha_k - a_k}$，其中 $a_k = \\lfloor \\alpha_k \\rfloor$。\n$a_0 = \\lfloor \\sqrt{61} \\rfloor = 7$。\n$\\alpha_1 = \\frac{1}{\\sqrt{61}-7} = \\frac{\\sqrt{61}+7}{12} \\implies a_1 = \\lfloor \\frac{7+7}{12} \\rfloor = 1$。\n$\\alpha_2 = \\frac{1}{\\frac{\\sqrt{61}+7}{12}-1} = \\frac{12}{\\sqrt{61}-5} = \\frac{\\sqrt{61}+5}{3} \\implies a_2 = \\lfloor \\frac{7+5}{3} \\rfloor = 4$。\n$\\alpha_3 = \\frac{1}{\\frac{\\sqrt{61}+5}{3}-4} = \\frac{3}{\\sqrt{61}-7} = \\frac{\\sqrt{61}+7}{4} \\implies a_3 = \\lfloor \\frac{7+7}{4} \\rfloor = 3$。\n$\\alpha_4 = \\frac{1}{\\frac{\\sqrt{61}+7}{4}-3} = \\frac{4}{\\sqrt{61}-5} = \\frac{\\sqrt{61}+5}{9} \\implies a_4 = \\lfloor \\frac{7+5}{9} \\rfloor = 1$。\n$\\alpha_5 = \\frac{1}{\\frac{\\sqrt{61}+5}{9}-1} = \\frac{9}{\\sqrt{61}-4} = \\frac{\\sqrt{61}+4}{5} \\implies a_5 = \\lfloor \\frac{7+4}{5} \\rfloor = 2$。\n$\\alpha_6 = \\frac{1}{\\frac{\\sqrt{61}+4}{5}-2} = \\frac{5}{\\sqrt{61}-6} = \\frac{\\sqrt{61}+6}{5} \\implies a_6 = \\lfloor \\frac{7+6}{5} \\rfloor = 2$。\n$\\alpha_7 = \\frac{1}{\\frac{\\sqrt{61}+6}{5}-2} = \\frac{5}{\\sqrt{61}-4} = \\frac{\\sqrt{61}+4}{9} \\implies a_7 = \\lfloor \\frac{7+4}{9} \\rfloor = 1$。\n$\\alpha_8 = \\frac{1}{\\frac{\\sqrt{61}+4}{9}-1} = \\frac{9}{\\sqrt{61}-5} = \\frac{\\sqrt{61}+5}{4} \\implies a_8 = \\lfloor \\frac{7+5}{4} \\rfloor = 3$。\n$\\alpha_9 = \\frac{1}{\\frac{\\sqrt{61}+5}{4}-3} = \\frac{4}{\\sqrt{61}-7} = \\frac{\\sqrt{61}+7}{3} \\implies a_9 = \\lfloor \\frac{7+7}{3} \\rfloor = 4$。\n\n所需的部分商序列是 $[a_9; a_8, a_7, a_6]$。它们是 $[4; 3, 1, 2]$。\n设这个序列为 $[c_0; c_1, c_2, c_3] = [4; 3, 1, 2]$。我们需要计算 $P'_3$。\n我们使用分子的递推关系：$P'_k = c_k P'_{k-1} + P'_{k-2}$，其中 $P'_{-1}=1$ 和 $P'_0=c_0$。\n$P'_0 = c_0 = 4$。\n$P'_1 = c_1 P'_0 + P'_{-1} = 3(4) + 1 = 13$。\n$P'_2 = c_2 P'_1 + P'_0 = 1(13) + 4 = 17$。\n$P'_3 = c_3 P'_2 + P'_1 = 2(17) + 13 = 34 + 13 = 47$。\n\n第五个非平凡余数 $r_5$ 等于 $P'_3$。\n因此，$r_5 = 47$。", "answer": "$$\\boxed{47}$$", "id": "3020983"}]}