{"hands_on_practices": [{"introduction": "我们从一个解析数论中的经典问题——狄利克雷除数问题开始。这个练习旨在通过双曲线法，推导除数函数 $\\tau(n)$ 的和函数 $\\sum_{n \\le x} \\tau(n)$ 的一个精确渐近展开式。这个过程不仅能加深你对渐近分析的理解，还能让你亲眼见证欧拉-马歇罗尼常数 $\\gamma$ 是如何从调和级数的渐近行为中自然产生的。[@problem_id:3008370]", "problem": "设 $\\tau(n)$ 表示除数函数，对每个正整数 $n$ 定义为 $\\tau(n) = \\sum_{d \\mid n} 1$。对于实参数 $x \\geq 2$，考虑求和函数 $T(x) = \\sum_{n \\leq x} \\tau(n)$。仅从 Dirichlet 卷积恒等式 $\\tau = 1 * 1$ 和将 $T(x)$ 表示为双曲线下整数格点计数的表述出发，使用带有对称分割参数的双曲线法，推导 $T(x)$ 的一个渐近展开式。该展开式包含一个与 $x \\ln x$ 成正比的主项，一个与 $x$ 成正比的附加项（您必须明确确定其常数），以及一个阶为 $O(\\sqrt{x})$ 的误差项。在您的推导中，请精确指出由极限 $\\gamma = \\lim_{N \\to \\infty} \\left(\\sum_{n=1}^{N} \\frac{1}{n} - \\ln N\\right)$ 定义的 Euler–Mascheroni 常数 $\\gamma$ 是如何通过调和级数的渐近性质引入的。您的最终答案必须是 $T(x)$ 关于 $x$、$\\ln x$ 和 $\\gamma$ 的单个闭式解析表达式，其误差项阶为 $O(\\sqrt{x})$。", "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 除数函数定义为 $\\tau(n) = \\sum_{d \\mid n} 1$，其中 $n$ 为正整数。\n- 求和函数为 $T(x) = \\sum_{n \\leq x} \\tau(n)$，其中 $x \\geq 2$ 为实参数。\n- 推导必须从 Dirichlet 卷积恒等式 $\\tau = 1 * 1$ 开始。\n- 使用的方法是带有对称分割参数的双曲线法。\n- 期望的结果是 $T(x)$ 的一个渐近展开式，包含一个与 $x \\ln x$ 成正比的主项，一个与 $x$ 成正比的附加项，以及一个阶为 $O(\\sqrt{x})$ 的误差项。\n- 必须明确指出由极限 $\\gamma = \\lim_{N \\to \\infty} \\left(\\sum_{n=1}^{N} \\frac{1}{n} - \\ln N\\right)$ 定义的 Euler–Mascheroni 常数 $\\gamma$ 在推导过程中的作用。\n\n### 步骤2：使用提取的已知条件进行验证\n这个问题是解析数论中的一个经典练习，称为 Dirichlet 除数问题（Dirichlet Divisor Problem）。", "answer": "$$\\boxed{x \\ln x + (2\\gamma - 1)x + O(\\sqrt{x})}$$", "id": "3008370"}, {"introduction": "在掌握了双曲线法的基本应用后，我们将该方法推广到另一个重要的算术函数——除数和函数 $\\sigma(n)$。这个练习要求你计算和函数 $\\sum_{n \\le x} \\sigma(n)$ 的主项，它将引出黎曼zeta函数的一个著名取值 $\\zeta(2) = \\frac{\\pi^2}{6}$。通过这个实践，你将学会如何将一种方法应用于不同的问题，并理解算术函数均值与数学中其他深刻常数之间的联系。[@problem_id:3008374]", "problem": "设 $\\sigma(n)$ 表示除数和函数，定义为 $\\sigma(n)=\\sum_{d\\mid n} d$。对于实数 $x\\geq 2$，考虑其求和函数 $S(x)=\\sum_{n\\leq x} \\sigma(n)$。请从第一性原理出发，通过使用Dirichlet卷积恒等式 $\\sigma=\\operatorname{id}*1$（其中 $\\operatorname{id}(n)=n$）以及Dirichlet双曲线法（DHM），推导出一个形式为 $S(x)=C\\,x^{2}+O\\!\\left(x\\ln x\\right)$ 的渐近式。在推导过程中，请从精确恒等式\n$$\n\\sum_{n\\leq x} \\sigma(n)=\\sum_{d\\leq x} d\\,\\left\\lfloor \\frac{x}{d}\\right\\rfloor,\n$$\n开始，然后使用求和函数 $G(t)=\\sum_{n\\leq t} n$ 和 $H(t)=\\sum_{n\\leq t} 1$ 来应用DHM。请通过仔细比较由 $\\sum_{d\\leq x} d$ 和 $x\\sum_{d\\leq x} \\frac{1}{d}$ 的增长所产生的贡献，并确定平方倒数和的作用，来论证主项常数 $C$。请将 $C$ 先用 Riemann zeta函数（RZF）表示为闭式形式，然后表示为一个包含 $\\pi$ 的简化表达式。你的最终答案必须仅为常数 $C$，并以单一闭式解析表达式的形式给出。", "solution": "用户希望找到除数和函数的求和函数 $S(x) = \\sum_{n \\leq x} \\sigma(n)$ 的渐近行为。\n\n### 步骤 1：问题验证\n\n**提取的已知条件：**\n- **函数：** $\\sigma(n) = \\sum_{d|n} d$\n- **求和函数：** $S(x) = \\sum_{n \\leq x} \\sigma(n)$，对于 $x \\geq 2$。\n- **目标形式：** $S(x) = C\\,x^2 + O(x \\ln x)$。\n- **关键恒等式：** $\\sigma = \\operatorname{id} * 1$，其中 $\\operatorname{id}(n) = n$ 且 $1(n) = 1$。\n- **方法：** Dirichlet双曲线法 (DHM)。\n- **起点：** 恒等式 $\\sum_{n \\leq x} \\sigma(n) = \\sum_{d \\leq x} d \\lfloor \\frac{x}{d} \\rfloor$。\n- **用于DHM的求和函数：** $G(t) = \\sum_{n \\leq t} n$ 和 $H(t) = \\sum_{n \\leq t} 1$。\n- **论证要求：** 解释 $C$ 如何从 $\\sum_{d \\leq x} d$ 和 $x \\sum_{d \\leq x} \\frac{1}{d}$ 的增长中产生，以及平方倒数和的作用。\n- **最终答案：** 以包含 $\\pi$ 的闭式形式表示的常数 $C$。\n\n**验证结论：**\n该问题具有科学依据、良定且客观。它是解析数论中的一个标准问题，没有任何科学或逻辑上的缺陷。所有必需的定义和方法都已明确陈述，构成了一个自洽且可解的问题。因此，该问题被判定为**有效的**。\n\n### 步骤 2：渐近公式的推导\n\n题目要求我们找到 $S(x) = \\sum_{n \\leq x} \\sigma(n)$ 的渐近公式。问题引导我们使用Dirichlet卷积恒等式 $\\sigma(n) = (\\operatorname{id} * 1)(n)$，由于卷积是可交换的，它也可以写成 $\\sigma(n) = (1 * \\operatorname{id})(n)$。我们定义 $g_1(n) = 1$ 和 $g_2(n) = n$，从而有 $\\sigma = g_1 * g_2$。\n\n$g_1$ 和 $g_2$ 的求和函数为：\n$$ S_1(t) = \\sum_{n \\leq t} g_1(n) = \\sum_{n \\leq t} 1 = \\lfloor t \\rfloor $$\n$$ S_2(t) = \\sum_{n \\leq t} g_2(n) = \\sum_{n \\leq t} n = \\frac{\\lfloor t \\rfloor (\\lfloor t \\rfloor + 1)}{2} $$\n为了进行渐近分析，对于 $t \\geq 1$，我们可以使用以下估计：\n$$ S_1(t) = t + O(1) $$\n$$ S_2(t) = \\frac{(t+O(1))(t+O(1))}{2} = \\frac{t^2}{2} + O(t) $$\n\n我们对和式 $S(x) = \\sum_{n \\leq x} (g_1 * g_2)(n)$ 应用Dirichlet双曲线法（DHM）。对于满足 $1 \\leq y \\leq x$ 的任意参数 $y$，DHM公式为：\n$$ S(x) = \\sum_{a \\leq y} g_1(a) S_2(x/a) + \\sum_{b \\leq x/y} g_2(b) S_1(x/b) - S_1(y) S_2(y) $$\n我们选择标准参数 $y = \\sqrt{x}$。代入这些函数和 $y$ 的选择：\n$$ S(x) = \\sum_{a \\leq \\sqrt{x}} 1 \\cdot S_2(x/a) + \\sum_{b \\leq \\sqrt{x}} b \\cdot S_1(x/b) - S_1(\\sqrt{x}) S_2(\\sqrt{x}) $$\n\n我们分别分析这三项。\n\n**第1项：** $\\sum_{a \\leq \\sqrt{x}} S_2(x/a)$\n使用渐近式 $S_2(t) = \\frac{t^2}{2} + O(t)$：\n$$ \\sum_{a \\leq \\sqrt{x}} S_2(x/a) = \\sum_{a \\leq \\sqrt{x}} \\left( \\frac{1}{2}\\left(\\frac{x}{a}\\right)^2 + O\\left(\\frac{x}{a}\\right) \\right) = \\frac{x^2}{2} \\sum_{a \\leq \\sqrt{x}} \\frac{1}{a^2} + O\\left(x \\sum_{a \\leq \\sqrt{x}} \\frac{1}{a}\\right) $$\n我们使用调和级数和平方倒数和的已知渐近式：\n- $\\sum_{k=1}^N \\frac{1}{k} = \\ln N + \\gamma + O(1/N)$，所以 $\\sum_{a \\leq \\sqrt{x}} \\frac{1}{a} = \\ln(\\sqrt{x}) + O(1) = \\frac{1}{2}\\ln x + O(1)$。\n- $\\sum_{k=1}^N \\frac{1}{k^2} = \\zeta(2) - \\sum_{k=N+1}^\\infty \\frac{1}{k^2}$。尾部和可以用积分来界定： $\\sum_{k=N+1}^\\infty \\frac{1}{k^2} \\le \\int_{N}^\\infty \\frac{du}{u^2} = \\frac{1}{N}$。\n因此，对于 $N = \\lfloor\\sqrt{x}\\rfloor$，我们有 $\\sum_{a \\leq \\sqrt{x}} \\frac{1}{a^2} = \\zeta(2) - O(\\frac{1}{\\sqrt{x}})$。\n\n将这些代入第1项的表达式中：\n$$ \\text{第1项} = \\frac{x^2}{2} \\left(\\zeta(2) - O\\left(\\frac{1}{\\sqrt{x}}\\right)\\right) + O\\left(x \\left(\\frac{1}{2}\\ln x + O(1)\\right)\\right) $$\n$$ \\text{第1项} = \\frac{\\zeta(2)}{2}x^2 - O(x^{3/2}) + O(x \\ln x) = \\frac{\\zeta(2)}{2}x^2 + O(x \\ln x) $$\n\n**第2项：** $\\sum_{b \\leq \\sqrt{x}} b \\cdot S_1(x/b)$\n此处 $S_1(x/b) = \\lfloor x/b \\rfloor = x/b - \\{x/b\\}$，其中 $0 \\leq \\{u\\}  1$ 是 $u$ 的小数部分。\n$$ \\text{第2项} = \\sum_{b \\leq \\sqrt{x}} b \\left(\\frac{x}{b} - \\left\\{\\frac{x}{b}\\right\\}\\right) = \\sum_{b \\leq \\sqrt{x}} x - \\sum_{b \\leq \\sqrt{x}} b \\left\\{\\frac{x}{b}\\right\\} $$\n$$ = x \\lfloor \\sqrt{x} \\rfloor - \\sum_{b \\leq \\sqrt{x}} b \\left\\{\\frac{x}{b}\\right\\} $$\n第二部分是误差项：$0 \\leq \\sum_{b \\leq \\sqrt{x}} b \\{x/b\\}  \\sum_{b \\leq \\sqrt{x}} b = S_2(\\sqrt{x}) = \\frac{x}{2} + O(\\sqrt{x}) = O(x)$。\n所以，第2项为：\n$$ \\text{第2项} = x (\\sqrt{x} + O(1)) - O(x) = x^{3/2} + O(x) $$\n\n**第3项：** $- S_1(\\sqrt{x}) S_2(\\sqrt{x})$\n这是修正项。\n$$ \\text{第3项} = - \\lfloor \\sqrt{x} \\rfloor \\cdot \\frac{\\lfloor \\sqrt{x} \\rfloor (\\lfloor \\sqrt{x} \\rfloor+1)}{2} = - \\frac{(\\sqrt{x}+O(1)) (\\sqrt{x}+O(1)) (\\sqrt{x}+O(1)+1)}{2} $$\n$$ = - \\frac{(x+O(\\sqrt{x}))(\\sqrt{x}+O(1))}{2} = - \\frac{x^{3/2}+O(x)}{2} = -\\frac{1}{2}x^{3/2} + O(x) $$\n\n**合并各项：**\n我们现在将这三个部分相加来求 $S(x)$：\n$$ S(x) = \\left(\\frac{\\zeta(2)}{2}x^2 + O(x \\ln x)\\right) + \\left(x^{3/2} + O(x)\\right) + \\left(-\\frac{1}{2}x^{3/2} + O(x) - \\frac{1}{2}x^{3/2}\\right) $$\n更精确地，\n$S(x) = \\sum_{a \\le \\sqrt{x}} \\left(\\frac{x^2}{2a^2} + O(\\frac{x}{a})\\right) + \\sum_{b \\le \\sqrt{x}} \\left(x - b\\{x/b\\}\\right) - \\left(\\frac{x}{2} + O(\\sqrt{x})\\right)\\left(\\sqrt{x}+O(1)\\right)$\n$S(x) = \\frac{x^2}{2}\\left(\\zeta(2) - \\frac{1}{\\sqrt{x}} + O(\\frac{1}{x})\\right) + O(x\\ln x) + x\\sqrt{x} + O(x) - O(x) - \\left(\\frac{x^{3/2}}{2} + O(x)\\right)$\n$S(x) = \\frac{\\zeta(2)}{2}x^2 - \\frac{x^{3/2}}{2} + O(x\\ln x) + x^{3/2} - \\frac{x^{3/2}}{2} + O(x) = \\frac{\\zeta(2)}{2}x^2 + O(x \\ln x)$\n\n这就建立了渐近公式 $S(x) = C\\,x^2 + O(x \\ln x)$，其中常数 $C = \\frac{\\zeta(2)}{2}$。\n\n### 步骤 3：C的论证与最终表达式\n\n问题要求对常数 $C$ 进行论证。主项 $\\frac{\\zeta(2)}{2}x^2$ 完全来自于DHM计算的第1项，即 $\\sum_{a \\leq \\sqrt{x}}S_2(x/a)$。此和式的主导行为来自于 $\\sum_{a \\leq \\sqrt{x}} \\frac{1}{2}(x/a)^2 = \\frac{x^2}{2} \\sum_{a \\leq \\sqrt{x}} \\frac{1}{a^2}$。这个和式直接涉及“平方倒数和”，它收敛于 $s=2$ 处的Riemann zeta函数，即 $\\zeta(2)$。这解释了常数 $C$ 中 $\\zeta(2)$ 的来源。\n\n误差项 $O(x \\ln x)$ 来自多个来源，包括用 $\\zeta(2)$ 近似 $\\sum_{a \\leq \\sqrt{x}} 1/a^2$ 时产生的误差，以及和式 $O(x \\sum_{a \\leq \\sqrt{x}} 1/a)$，后者与题目提示中的项 $x\\sum_{d\\leq x} 1/d$ 相关。函数 $S_2(t) \\approx t^2/2$ 是 $g_2(n)=n$ 的求和函数，它与题目中提到的 $\\sum_{d \\leq x}d$ 的增长相关。因此，DHM计算的各个组成部分与问题陈述中提到的启发性要素是一致的。\n\n常数 $C$ 由下式给出：\n$$ C = \\frac{\\zeta(2)}{2} $$\nRiemann zeta函数在 $s=2$ 处的值是来自Basel问题的一个著名结果：\n$$ \\zeta(2) = \\sum_{n=1}^\\infty \\frac{1}{n^2} = \\frac{\\pi^2}{6} $$\n代入这个值，我们得到 $C$ 的最终表达式：\n$$ C = \\frac{1}{2} \\cdot \\frac{\\pi^2}{6} = \\frac{\\pi^2}{12} $$", "answer": "$$\\boxed{\\frac{\\pi^2}{12}}$$", "id": "3008374"}, {"introduction": "除了基于几何直观的双曲线法，解析数论还依赖于强大的分析工具，其中最核心的就是阿贝尔求和公式（或分部求和法）。这个练习将指导你运用阿贝尔求和，从一个给定的和函数 $A(x) = \\sum_{n \\le x} a_n$ 的渐近行为，推导出其加权和 $\\sum_{n \\le x} \\frac{a_n}{n}$ 的渐近公式。这项技能对于在不同形式的算术和之间进行转换至关重要，是处理更复杂求和问题的基础。[@problem_id:3008371]", "problem": "设 $\\{a_{n}\\}_{n\\geq 1}$ 为一个算术函数，其和函数定义为 $A(x)=\\sum_{n\\leq x}a_{n}$，其中实数 $x\\geq 1$。假设存在实常数 $B$ 和实指数 $\\theta$（满足 $0\\theta1$），使得当 $x\\to\\infty$ 时，渐近关系\n$$\nA(x)=x\\,\\ln x + B\\,x + O\\!\\left(x^{\\theta}\\right)\n$$\n成立，其中朗道符号 (Landau symbol) $O(\\cdot)$ 满足其通常的含义：$F(x)=O(G(x))$ 表示存在常数 $C0$ 和 $x_{0}\\geq 1$ 使得对所有 $x\\geq x_{0}$ 都有 $|F(x)|\\leq C\\,|G(x)|$。使用 Abel 求和法，确定加权和\n$$\nS(x)=\\sum_{n\\leq x}\\frac{a_{n}}{n}\n$$\n的渐近行为，精确到当 $x\\to\\infty$ 时消失的项，并将有限常数项完全用 $A(x)$ 表示。你的最终表达式必须是一个只依赖于 $x$、$B$ 和 $A$ 的单一闭式解析表达式，且不得包含大O符号。无需进行数值四舍五入。", "solution": "用户希望找到加权和 $S(x)=\\sum_{n\\leq x}\\frac{a_{n}}{n}$ 的渐近行为。\n\n### 第 1 步：问题验证\n\n该问题是解析数论中的一个标准练习，具体涉及应用 Abel 求和公式来推导渐近估计。\n\n**已知条件：**\n1.  一个算术函数 $\\{a_{n}\\}_{n\\geq 1}$。\n2.  其和函数 $A(x)=\\sum_{n\\leq x}a_{n}$，其中 $x\\geq 1$。\n3.  当 $x\\to\\infty$ 时，渐近关系 $A(x)=x\\,\\ln x + B\\,x + O(x^{\\theta})$ 成立，其中 $B$ 是一个实常数且 $0\\theta1$。\n4.  待分析的加权和为 $S(x)=\\sum_{n\\leq x}\\frac{a_{n}}{n}$。\n5.  要求使用的方法是 Abel 求和法。\n6.  结果必须是 $S(x)$ 的一个渐近表达式，精确到当 $x\\to\\infty$ 时消失的项。\n7.  渐近表达式中的有限常数项必须用函数 $A$ 来表示。\n8.  最终表达式必须是一个只依赖于 $x$、$B$ 和 $A$ 的单一闭式表达式，不含大O符号。\n\n**验证：**\n1.  **科学依据：** 该问题牢固地植根于解析数论的原理。Abel 求和公式是一个基本工具，$A(x)$ 的渐近形式代表了许多常见的算术函数（例如，与除数函数 $d(n)$ 或 von Mangoldt 函数 $\\Lambda(n)$ 相关的函数）。问题的设定在科学上是合理的。\n2.  **适定性：** 问题陈述提供了推导 $S(x)$ 唯一渐近公式所需的所有信息。目标明确，对答案形式的约束也很具体。\n3.  **客观性：** 该问题使用精确的数学语言陈述，没有任何主观或模棱两可的术语。“将有限常数项完全用 $A(x)$ 表示”这一短语被解释为要求通过一个涉及函数 $A$ 的表达式来定义该常数，这是该领域的标准做法。\n\n**结论：**\n该问题是有效的。它是一个解析数论中定义明确的问题，可以进行严格求解。\n\n### 第 2 步：推导渐近公式\n\n我们需要找到 $S(x) = \\sum_{n \\leq x} \\frac{a_n}{n}$ 的渐近行为。我们将使用 Abel 求和公式（也称为分部求和法）。对于一个算术函数 $a_n$，其和函数为 $A(x) = \\sum_{n \\leq x} a_n$，以及一个连续可微的函数 $f(t)$，该公式为：\n$$\n\\sum_{1  n \\leq x} a_n f(n) = A(x)f(x) - A(1)f(1) - \\int_1^x A(t)f'(t)dt\n$$\n(注意: 完整的求和 $\\sum_{n \\le x}$ 可以通过在右侧加上 $a_1f(1)$ 得到。)\n在我们的问题中，函数是 $f(t) = \\frac{1}{t}$。其导数为 $f'(t) = -\\frac{1}{t^2}$。函数 $f(t)$ 在 $t \\geq 1$ 上是连续可微的。将该公式应用于 $S(x)$：\n$$\nS(x) = \\sum_{n \\leq x} a_n \\frac{1}{n} = A(x) \\cdot \\frac{1}{x} - \\int_1^x A(t) \\left(-\\frac{1}{t^2}\\right) dt\n$$\n$$\nS(x) = \\frac{A(x)}{x} + \\int_1^x \\frac{A(t)}{t^2} dt \\quad (*).\n$$\n这是一个精确的恒等式。现在，我们使用给定的 $A(x)$ 的渐近公式：\n$$\nA(x) = x \\ln x + Bx + R(x),\n$$\n其中余项 $R(x)$ 的阶为 $O(x^{\\theta})$，对于某个常数 $\\theta$ 满足 $0  \\theta  1$。\n\n我们来分别分析方程 $(*)$ 中的两项。\n\n**第一项：** $\\frac{A(x)}{x}$\n$$\n\\frac{A(x)}{x} = \\frac{x \\ln x + Bx + R(x)}{x} = \\ln x + B + \\frac{R(x)}{x}.\n$$\n由于 $R(x) = O(x^{\\theta})$，我们有 $\\frac{R(x)}{x} = O(x^{\\theta-1})$。因为 $0  \\theta  1$，指数 $\\theta-1$ 是负数，所以当 $x \\to \\infty$ 时，这一项趋于零。\n$$\n\\frac{A(x)}{x} = \\ln x + B + O(x^{\\theta-1}).\n$$\n\n**第二项：** $\\int_1^x \\frac{A(t)}{t^2} dt$\n我们将 $A(t)$ 的渐近形式代入积分中：\n$$\n\\int_1^x \\frac{A(t)}{t^2} dt = \\int_1^x \\frac{t \\ln t + Bt + R(t)}{t^2} dt = \\int_1^x \\left(\\frac{\\ln t}{t} + \\frac{B}{t}\\right) dt + \\int_1^x \\frac{R(t)}{t^2} dt.\n$$\n该积分的第一部分是初等的：\n$$\n\\int_1^x \\left(\\frac{\\ln t}{t} + \\frac{B}{t}\\right) dt = \\left[\\frac{1}{2}(\\ln t)^2\\right]_1^x + [B \\ln t]_1^x = \\frac{1}{2}(\\ln x)^2 + B \\ln x.\n$$\n现在，考虑余项的积分 $\\int_1^x \\frac{R(t)}{t^2} dt$。我们分析相应的反常积分 $\\int_1^\\infty \\frac{R(t)}{t^2} dt$ 的收敛性。由于 $R(t) = O(t^{\\theta})$，存在常数 $C > 0$ 和 $t_0 \\geq 1$ 使得对所有 $t \\geq t_0$ 都有 $|R(t)| \\leq C t^{\\theta}$。那么，对于 $T > t_0$：\n$$\n\\int_{t_0}^T \\left|\\frac{R(t)}{t^2}\\right| dt \\leq \\int_{t_0}^T \\frac{C t^{\\theta}}{t^2} dt = C \\int_{t_0}^T t^{\\theta-2} dt.\n$$\n指数为 $\\theta-2$。由于 $0  \\theta  1$，我们有 $-2  \\theta-2  -1$。因为该指数小于 $-1$，所以反常积分收敛：\n$$\n\\int_{t_0}^\\infty t^{\\theta-2} dt = \\left[\\frac{t^{\\theta-1}}{\\theta-1}\\right]_{t_0}^\\infty = 0 - \\frac{t_0^{\\theta-1}}{\\theta-1}  \\infty.\n$$\n因此，积分 $\\int_1^\\infty \\frac{R(t)}{t^2} dt$ 收敛到一个有限常数。我们将此常数定义为：\n$$\n\\mathcal{C}_R = \\int_1^\\infty \\frac{R(t)}{t^2} dt = \\int_1^\\infty \\frac{A(t) - t \\ln t - Bt}{t^2} dt.\n$$\n我们现在可以将积分到 $x$ 的表达式写为：\n$$\n\\int_1^x \\frac{R(t)}{t^2} dt = \\int_1^\\infty \\frac{R(t)}{t^2} dt - \\int_x^\\infty \\frac{R(t)}{t^2} dt = \\mathcal{C}_R - \\int_x^\\infty \\frac{R(t)}{t^2} dt.\n$$\n尾部积分 $\\int_x^\\infty \\frac{R(t)}{t^2} dt$ 是一个消失项。对于 $x \\geq t_0$：\n$$\n\\left|\\int_x^\\infty \\frac{R(t)}{t^2} dt\\right| \\leq \\int_x^\\infty \\frac{|R(t)|}{t^2} dt \\leq C \\int_x^\\infty t^{\\theta-2} dt = C \\left[\\frac{t^{\\theta-1}}{\\theta-1}\\right]_x^\\infty = \\frac{-C}{\\theta-1}x^{\\theta-1} = O(x^{\\theta-1}).\n$$\n所以，$\\int_1^x \\frac{R(t)}{t^2} dt = \\mathcal{C}_R + O(x^{\\theta-1})$。\n\n**合并结果：**\n我们将两项的渐近展开式代回到 $S(x)$ 的表达式中：\n$$\nS(x) = \\left(\\ln x + B + O(x^{\\theta-1})\\right) + \\left(\\frac{1}{2}(\\ln x)^2 + B \\ln x + \\mathcal{C}_R + O(x^{\\theta-1})\\right).\n$$\n按增长阶数降序收集各项：\n$$\nS(x) = \\frac{1}{2}(\\ln x)^2 + (B+1)\\ln x + (B + \\mathcal{C}_R) + O(x^{\\theta-1}).\n$$\n问题要求渐近行为精确到当 $x\\to\\infty$ 时消失的项。由于 $\\theta-1  0$，项 $O(x^{\\theta-1})$ 会消失。因此，所求的表达式为：\n$$\nS(x) \\approx \\frac{1}{2}(\\ln x)^2 + (B+1)\\ln x + B + \\mathcal{C}_R.\n$$\n常数项是 $B + \\mathcal{C}_R$。代入 $\\mathcal{C}_R$ 的定义：\n$$\n\\text{常数项} = B + \\int_1^\\infty \\frac{A(t) - t \\ln t - Bt}{t^2} dt.\n$$\n该常数用 $B$ 和一个涉及函数 $A$ 的积分表示，符合要求。渐近行为的完整表达式是：\n$$\n\\frac{1}{2}(\\ln x)^2 + (B+1)\\ln x + B + \\int_1^\\infty \\frac{A(t) - t \\ln t - Bt}{t^2} dt.\n$$\n这是一个只依赖于 $x$、$B$ 和函数 $A$ 的单一闭式解析表达式，不含大O符号，满足问题的所有条件。", "answer": "$$\n\\boxed{\\frac{1}{2}(\\ln x)^2 + (B+1)\\ln x + B + \\int_1^\\infty \\frac{A(t) - t \\ln t - Bt}{t^2} dt}\n$$", "id": "3008371"}]}