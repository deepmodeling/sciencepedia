{"hands_on_practices": [{"introduction": "冯·曼戈尔特函数与切比雪夫函数是研究素数分布的核心工具。本练习旨在通过精确计算切比雪夫的两个函数 $\\psi(x)$ 和 $\\vartheta(x)$ 之间的差值，来加深对它们定义的理解。这项实践将揭示，这两个函数之间的差异完全来自于高于一次的素数幂次的贡献，从而为更深刻的渐近分析打下坚实的基础。[@problem_id:3029744]", "problem": "设 $x$ 为一个正实数，定义冯·曼戈尔特函数 $\\Lambda(n)$ 为：若 $n$ 是素数 $p$ 的整数次幂 $p^{k}$（其中 $k \\geq 1$），则 $\\Lambda(n) = \\log p$；否则 $\\Lambda(n) = 0$。定义切比雪夫函数 $\\vartheta(x)$ 和 $\\psi(x)$ 如下：\n$$\\vartheta(x) = \\sum_{p \\leq x} \\log p \\quad \\text{以及} \\quad \\psi(x) = \\sum_{n \\leq x} \\Lambda(n),$$\n其中第一个和式是对素数 $p$ 求和，第二个和式是对正整数 $n$ 求和。\n\n仅从这些定义出发，不借助任何渐近定理或已证明的恒等式，通过找出被 $\\psi(10000)$ 计数但未被 $\\vartheta(10000)$ 计数的整数，来确定 $\\psi(10000) - \\vartheta(10000)$ 的精确值。请将最终答案表示为一个带有整数指数的素数乘积的单个自然对数，并简化为一个封闭形式的解析表达式。无需进行数值近似。", "solution": "本题要求仅根据所提供的冯·曼戈尔特函数 $\\Lambda(n)$ 和切比雪夫函数 $\\vartheta(x)$、$\\psi(x)$ 的定义，精确计算表达式 $\\psi(10000) - \\vartheta(10000)$ 的值。\n\n首先，我们来分析所提供的定义。\n冯·曼戈尔特函数 $\\Lambda(n)$ 对正整数 $n$ 的定义如下：\n$$ \\Lambda(n) = \\begin{cases} \\log p  &\\text{若 } n = p^k \\text{ 对于某个素数 } p \\text{ 和整数 } k \\ge 1 \\\\ 0  &\\text{其他情况} \\end{cases} $$\n切比雪夫函数对正实数 $x$ 的定义如下：\n$$ \\vartheta(x) = \\sum_{p \\le x, p \\in \\mathbb{P}} \\log p $$\n$$ \\psi(x) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\Lambda(n) $$\n其中 $\\mathbb{P}$ 表示素数集合。\n\n本题要求通过找出其贡献被 $\\psi(10000)$ 计数但未被 $\\vartheta(10000)$ 计数的整数，来确定 $\\psi(10000) - \\vartheta(10000)$ 的值。\n\n我们通过代入 $\\Lambda(n)$ 的定义来表示 $\\psi(x)$。该和式是对正整数 $n \\le x$ 求和，但项 $\\Lambda(n)$ 仅在 $n$ 是素数的幂时才非零。因此，我们可以将 $\\psi(x)$ 的和式写成对素数幂的求和：\n$$ \\psi(x) = \\sum_{p^k \\le x, p \\in \\mathbb{P}, k \\ge 1} \\log p $$\n我们可以根据指数 $k$ 的值将此和式拆分：\n$$ \\psi(x) = \\sum_{k=1}^{\\infty} \\sum_{p^k \\le x, p \\in \\mathbb{P}} \\log p $$\n该和式是有限的，因为对于任何给定的 $x > 1$，如果 $2^k > x$（即 $k > \\log_2 x$），内层和式就变为空和。\n\n让我们考察 $k=1$ 的项：\n$$ \\sum_{p^1 \\le x, p \\in \\mathbb{P}} \\log p = \\sum_{p \\le x, p \\in \\mathbb{P}} \\log p $$\n这正是 $\\vartheta(x)$ 的定义。\n\n因此，我们可以将 $\\psi(x)$ 写为：\n$$ \\psi(x) = \\left( \\sum_{p \\le x, p \\in \\mathbb{P}} \\log p \\right) + \\left( \\sum_{p^2 \\le x, p \\in \\mathbb{P}} \\log p \\right) + \\left( \\sum_{p^3 \\le x, p \\in \\mathbb{P}} \\log p \\right) + \\dots $$\n$$ \\psi(x) = \\vartheta(x) + \\sum_{k=2}^{\\infty} \\sum_{p^k \\le x, p \\in \\mathbb{P}} \\log p $$\n\n差值 $\\psi(x) - \\vartheta(x)$ 则为：\n$$ \\psi(x) - \\vartheta(x) = \\sum_{k=2}^{\\infty} \\sum_{p^k \\le x, p \\in \\mathbb{P}} \\log p $$\n被 $\\psi(x)$ 计数但未被 $\\vartheta(x)$ 计数的整数是更高次的素数幂，即 $n = p^k$ 其中 $k \\ge 2$。每个满足 $n \\le x$ 的此类整数对 $\\psi(x)$ 的和式贡献一项 $\\Lambda(n) = \\log p$。\n\n对于本题，我们设 $x=10000$：\n$$ \\psi(10000) - \\vartheta(10000) = \\sum_{k=2}^{\\infty} \\sum_{p^k \\le 10000, p \\in \\mathbb{P}} \\log p $$\n该和式可以按素数 $p$ 重新分组。对于每个素数 $p$，每当有一个整数 $k \\ge 2$ 满足 $p^k \\le 10000$ 时，$\\log p$ 这一项就会被加上。对于给定的素数 $p$，这样的 $k$ 值的数量就是总和中 $\\log p$ 的系数。\n条件 $p^k \\le 10000$ 等价于 $k \\log p \\le \\log 10000$，即 $k \\le \\log_p(10000)$。\n由于我们是对 $k \\ge 2$ 求和，对于给定的素数 $p$，项数为 $\\lfloor \\log_p(10000) \\rfloor - 1$。只有当 $\\lfloor \\log_p(10000) \\rfloor \\ge 2$ 时，和才非零，这意味着 $p^2 \\le 10000$，所以 $p \\le \\sqrt{10000} = 100$。\n\n因此，总和为：\n$$ \\psi(10000) - \\vartheta(10000) = \\sum_{p \\le 100, p \\in \\mathbb{P}} (\\lfloor \\log_p(10000) \\rfloor - 1) \\log p $$\n利用对数性质 $a \\log b = \\log(b^a)$，这可以写成一个单一的自然对数：\n$$ \\log \\left( \\prod_{p \\le 100, p \\in \\mathbb{P}} p^{(\\lfloor \\log_p(10000) \\rfloor - 1)} \\right) $$\n现在我们为每个 $p \\le 100$ 的素数计算指数：\n\\begin{itemize}\n    \\item 对于 $p=2$：$\\log_2(10000) = \\frac{\\log(10000)}{\\log(2)} \\approx 13.287$。指数为 $\\lfloor 13.287 \\rfloor - 1 = 13 - 1 = 12$。\n    \\item 对于 $p=3$：$\\log_3(10000) = \\frac{\\log(10000)}{\\log(3)} \\approx 8.383$。指数为 $\\lfloor 8.383 \\rfloor - 1 = 8 - 1 = 7$。\n    \\item 对于 $p=5$：$\\log_5(10000) = \\frac{\\log(10000)}{\\log(5)} \\approx 5.722$。指数为 $\\lfloor 5.722 \\rfloor - 1 = 5 - 1 = 4$。\n    \\item 对于 $p=7$：$\\log_7(10000) = \\frac{\\log(10000)}{\\log(7)} \\approx 4.732$。指数为 $\\lfloor 4.732 \\rfloor - 1 = 4 - 1 = 3$。\n    \\item 对于指数为 $2$ 的素数 $p$：这要求 $2 = \\lfloor \\log_p(10000) \\rfloor - 1$，所以 $3 \\le \\log_p(10000) < 4$。这意味着 $p^3 \\le 10000 < p^4$。开方可得，$p \\le (10000)^{1/3} \\approx 21.54$ 且 $p > (10000)^{1/4} = 10$。此范围内的素数是 $11, 13, 17, 19$。\n    \\item 对于指数为 $1$ 的素数 $p$：这要求 $1 = \\lfloor \\log_p(10000) \\rfloor - 1$，所以 $2 \\le \\log_p(10000) < 3$。这意味着 $p^2 \\le 10000 < p^3$。开方可得，$p \\le (10000)^{1/2} = 100$ 且 $p > (10000)^{1/3} \\approx 21.54$。此范围内的素数是 $23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97$。\n\\end{itemize}\n综合这些结果，对数内的最终乘积是：\n$$ 2^{12} \\cdot 3^{7} \\cdot 5^{4} \\cdot 7^{3} \\cdot (11 \\cdot 13 \\cdot 17 \\cdot 19)^{2} \\cdot \\left( \\prod_{\\substack{p \\in \\mathbb{P} \\\\ 23 \\le p \\le 97}} p \\right) $$\n这个乘积代表了所要求的精确值。表达式即为这个乘积的单个自然对数。令 $\\prod_{\\substack{p \\in \\mathbb{P} \\\\ 23 \\le p \\le 97}} p$ 表示所有满足 $23 \\le p \\le 97$ 的素数 $p$ 的乘积。\n\n最终表达式为：\n$$ \\log \\left( 2^{12} \\cdot 3^7 \\cdot 5^4 \\cdot 7^3 \\cdot 11^2 \\cdot 13^2 \\cdot 17^2 \\cdot 19^2 \\cdot \\prod_{\\substack{p \\in \\mathbb{P} \\\\ 23 \\le p \\le 97}} p \\right) $$", "answer": "$$\\boxed{\\log \\left( 2^{12} \\cdot 3^7 \\cdot 5^4 \\cdot 7^3 \\cdot 11^2 \\cdot 13^2 \\cdot 17^2 \\cdot 19^2 \\cdot \\prod_{\\substack{p \\in \\mathbb{P} \\\\ 23 \\le p \\le 97}} p \\right)}$$", "id": "3029744"}, {"introduction": "超越素数的整体分布，数论学家更关心素数在不同算术级数中的分布。本练习引入了狄利克雷特征及其正交性，这是一个强大的工具，用于分离和研究特定余数类中的素数计数。通过计算一个具体的例子，你将亲身体会到不同算术级数间的“素数竞赛”现象，并从概念上理解它与狄利克雷L函数零点的深刻联系。[@problem_id:3029741]", "problem": "设 $q$ 为一个正整数，$a$ 为一个模 $q$ 的剩余类且满足 $\\gcd(a,q)=1$。定义 von Mangoldt 函数 $\\Lambda(n)$ 如下：如果 $n=p^{k}$（其中 $p$ 为素数，$k \\geq 1$ 为整数），则 $\\Lambda(n)=\\log(p)$；否则 $\\Lambda(n)=0$。定义算术级数中的 Chebyshev 函数为\n$$\\psi(x;q,a) = \\sum_{\\substack{n \\leq x \\\\ n \\equiv a \\, (\\mathrm{mod}\\, q)}} \\Lambda(n).$$\n仅使用关于模4的Dirichlet特征及其正交性的基础理论，推导一个恒等式，将差值 $\\psi(x;4,1)-\\psi(x;4,3)$ 化简为单个由特征加权的 von Mangoldt 和。然后，当 $x=20$ 时，精确计算这个差值。最后，从概念上解释你推导的恒等式如何将计算出的差值的符号与模4的本原二次特征关联的Dirichlet $L$-函数的非平凡零点联系起来。你的最终答案应为一个单一的精确表达式，而非小数近似值。", "solution": "该问题是有效的，因为它是解析数论中一个提法恰当、有科学依据的问题。它内容完备，没有矛盾或含糊之处。\n\n该问题要求完成三项任务：首先，推导差值 $\\psi(x;4,1)-\\psi(x;4,3)$ 的一个恒等式；其次，当 $x=20$ 时精确计算这个差值；第三，从概念上解释该差值的符号与一个特定的Dirichlet $L$-函数的零点之间的联系。\n\n首先，我们推导该恒等式。模4的既约剩余类群是 $(\\mathbb{Z}/4\\mathbb{Z})^\\times = \\{1, 3\\}$，其阶为 $\\varphi(4)=2$。存在两个模4的Dirichlet特征。第一个是主特征 $\\chi_0$，定义为：如果 $\\gcd(n,4)=1$，则 $\\chi_0(n)=1$；如果 $\\gcd(n,4)>1$，则 $\\chi_0(n)=0$。第二个是非主特征 $\\chi_1$，定义为：$\\chi_1(1)=1$，$\\chi_1(3)=-1$；如果 $\\gcd(n,4)>1$，则 $\\chi_1(n)=0$。注意，对于任何奇数 $n$，有 $\\chi_1(n) = (-1)^{(n-1)/2}$。这两个特征都是实值的。\n\n模 $q$ 的Dirichlet特征的正交关系可用于从带有同余条件的和式中分离出特定项。对于整数 $n$ 和满足 $\\gcd(a,q)=1$ 的剩余类 $a$，我们有：\n$$ \\frac{1}{\\varphi(q)} \\sum_{\\chi \\, (\\mathrm{mod}\\, q)} \\overline{\\chi(a)} \\chi(n) = \\begin{cases} 1  &\\text{if } n \\equiv a \\, (\\mathrm{mod}\\, q) \\\\ 0  &\\text{otherwise} \\end{cases} $$\n利用这个关系，我们可以重写 Chebyshev 函数 $\\psi(x;q,a)$：\n$$ \\psi(x;q,a) = \\sum_{\\substack{n \\leq x \\\\ n \\equiv a \\, (\\mathrm{mod}\\, q)}} \\Lambda(n) = \\sum_{n \\leq x} \\Lambda(n) \\left( \\frac{1}{\\varphi(q)} \\sum_{\\chi \\, (\\mathrm{mod}\\, q)} \\overline{\\chi(a)} \\chi(n) \\right) $$\n交换求和顺序，我们得到：\n$$ \\psi(x;q,a) = \\frac{1}{\\varphi(q)} \\sum_{\\chi \\, (\\mathrm{mod}\\, q)} \\overline{\\chi(a)} \\sum_{n \\leq x} \\Lambda(n) \\chi(n) $$\n我们定义特征加权和 $\\psi(x,\\chi) = \\sum_{n \\leq x} \\Lambda(n) \\chi(n)$。于是表达式变为：\n$$ \\psi(x;q,a) = \\frac{1}{\\varphi(q)} \\sum_{\\chi \\, (\\mathrm{mod}\\, q)} \\overline{\\chi(a)} \\psi(x,\\chi) $$\n现在，我们特化到 $q=4$ 的情况。由于特征是实值的，所以 $\\overline{\\chi} = \\chi$。\n对于 $a=1$：\n$$ \\psi(x;4,1) = \\frac{1}{\\varphi(4)} \\left( \\chi_0(1) \\psi(x,\\chi_0) + \\chi_1(1) \\psi(x,\\chi_1) \\right) = \\frac{1}{2} \\left( \\psi(x,\\chi_0) + \\psi(x,\\chi_1) \\right) $$\n对于 $a=3$：\n$$ \\psi(x;4,3) = \\frac{1}{\\varphi(4)} \\left( \\chi_0(3) \\psi(x,\\chi_0) + \\chi_1(3) \\psi(x,\\chi_1) \\right) = \\frac{1}{2} \\left( \\psi(x,\\chi_0) - \\psi(x,\\chi_1) \\right) $$\n将第二个表达式从第一个表达式中减去，得到所求的恒等式：\n$$ \\psi(x;4,1) - \\psi(x;4,3) = \\frac{1}{2} \\left( \\psi(x,\\chi_0) + \\psi(x,\\chi_1) \\right) - \\frac{1}{2} \\left( \\psi(x,\\chi_0) - \\psi(x,\\chi_1) \\right) = \\psi(x,\\chi_1) $$\n因此，该恒等式为 $\\psi(x;4,1) - \\psi(x;4,3) = \\sum_{n \\leq x} \\Lambda(n) \\chi_1(n)$。\n\n第二，我们计算当 $x=20$ 时这个差值。我们需要计算 $\\psi(20,\\chi_1) = \\sum_{n \\leq 20} \\Lambda(n) \\chi_1(n)$。von Mangoldt 函数 $\\Lambda(n)$ 仅当 $n=p^k$（其中 $p$ 为素数）时非零。特征 $\\chi_1(n)$ 仅当 $n$ 为奇数时非零。我们列出 $n \\leq 20$ 的素数幂并计算各项 $\\Lambda(n)\\chi_1(n)$：\n\\begin{itemize}\n    \\item $n=2$ (素数): $\\chi_1(2)=0$。该项为 $0$。\n    \\item $n=3$ (素数): $\\Lambda(3)=\\log(3)$，$3 \\equiv 3 \\, (\\mathrm{mod}\\, 4)$，所以 $\\chi_1(3)=-1$。该项为 $-\\log(3)$。\n    \\item $n=4=2^2$: $\\chi_1(4)=0$。该项为 $0$。\n    \\item $n=5$ (素数): $\\Lambda(5)=\\log(5)$，$5 \\equiv 1 \\, (\\mathrm{mod}\\, 4)$，所以 $\\chi_1(5)=1$。该项为 $\\log(5)$。\n    \\item $n=7$ (素数): $\\Lambda(7)=\\log(7)$，$7 \\equiv 3 \\, (\\mathrm{mod}\\, 4)$，所以 $\\chi_1(7)=-1$。该项为 $-\\log(7)$。\n    \\item $n=8=2^3$: $\\chi_1(8)=0$。该项为 $0$。\n    \\item $n=9=3^2$: $\\Lambda(9)=\\log(3)$，$9 \\equiv 1 \\, (\\mathrm{mod}\\, 4)$，所以 $\\chi_1(9)=1$。该项为 $\\log(3)$。\n    \\item $n=11$ (素数): $\\Lambda(11)=\\log(11)$，$11 \\equiv 3 \\, (\\mathrm{mod}\\, 4)$，所以 $\\chi_1(11)=-1$。该项为 $-\\log(11)$。\n    \\item $n=13$ (素数): $\\Lambda(13)=\\log(13)$，$13 \\equiv 1 \\, (\\mathrm{mod}\\, 4)$，所以 $\\chi_1(13)=1$。该项为 $\\log(13)$。\n    \\item $n=16=2^4$: $\\chi_1(16)=0$。该项为 $0$。\n    \\item $n=17$ (素数): $\\Lambda(17)=\\log(17)$，$17 \\equiv 1 \\, (\\mathrm{mod}\\, 4)$，所以 $\\chi_1(17)=1$。该项为 $\\log(17)$。\n    \\item $n=19$ (素数): $\\Lambda(19)=\\log(19)$，$19 \\equiv 3 \\, (\\mathrm{mod}\\, 4)$，所以 $\\chi_1(19)=-1$。该项为 $-\\log(19)$。\n\\end{itemize}\n所有其他 $n \\leq 20$ 的整数或者不是素数幂（因此 $\\Lambda(n)=0$），或者是偶数（因此 $\\chi_1(n)=0$）。将非零项相加：\n$$ \\psi(20;4,1) - \\psi(20;4,3) = -\\log(3) + \\log(5) - \\log(7) + \\log(3) - \\log(11) + \\log(13) + \\log(17) - \\log(19) $$\n$$ = (\\log(5) + \\log(13) + \\log(17)) - (\\log(7) + \\log(11) + \\log(19)) $$\n$$ = \\log(5 \\times 13 \\times 17) - \\log(7 \\times 11 \\times 19) $$\n$$ = \\log(1105) - \\log(1463) = \\log\\left(\\frac{1105}{1463}\\right) $$\n由于 $1105 < 1463$，该值为负数。\n\n第三，我们解释其概念上的联系。恒等式 $\\psi(x;4,1) - \\psi(x;4,3) = \\psi(x,\\chi_1)$ 是关键的纽带。它将两个算术级数中素数幂数量的差异（“素数竞赛”的一种度量）与单个特征和等同起来。$\\psi(x,\\chi_1)$ 的行为与 Dirichlet $L$-函数 $L(s, \\chi_1) = \\sum_{n=1}^\\infty \\chi_1(n)n^{-s}$ 的解析性质密切相关。特征 $\\chi_1$ 是模4的本原二次特征。\n\n当 $\\chi$ 是一个本原非主特征时，$\\psi(x,\\chi)$ 的显式公式为：\n$$ \\psi(x,\\chi) = -\\sum_{\\rho} \\frac{x^\\rho}{\\rho} + O(\\log(x)) $$\n其中求和遍历 $L$-函数 $L(s,\\chi_1)$ 在临界带 $0 < \\Re(s) < 1$ 内的所有非平凡零点 $\\rho=\\beta+i\\gamma$。\n\n因此，差值 $\\psi(x;4,1) - \\psi(x;4,3)$ 的符号由和式 $-\\sum_{\\rho} x^\\rho / \\rho$ 的符号决定。我们对 $x=20$ 的计算得出了一个负值结果，这意味着对于 $x$ 这个较小的值，模4同余于3的素数幂在“竞赛中获胜”。这种现象是所谓的“Chebyshev偏差”的一个例子。\n\n显式公式表明，这种偏差并非巧合，而是由 $L(s,\\chi_1)$ 的零点 $\\rho$ 的具体位置所支配。这些零点在一个关于素数分布的振荡公式中扮演着“频率”的角色。每个零点的贡献以及和的符号都取决于 $x$。然而，$L(s,\\chi_1)$ 的零点分布使得和式 $-\\sum_\\rho x^\\rho / \\rho$ 对于大多数“较小”的 $x$ 值倾向于为负。这主要是因为最低处的零点（即虚部 $|\\gamma|$ 最小的那些）倾向于在和式中占主导地位，并且它们对和式的初始贡献是负的。我们计算出的负值 $\\log(1105/1463)$，是这一深刻解析原理在 $x=20$ 处的一个直接数值体现。所观察到的符号是 $L(s,\\chi_1)$ 的非平凡零点集体影响的结果。", "answer": "$$\\boxed{\\log\\left(\\frac{1105}{1463}\\right)}$$", "id": "3029741"}, {"introduction": "黎曼的显式公式是解析数论的巅峰成就之一，它精确地描述了素数计数函数 $\\psi(x)$ 与黎曼zeta函数 $\\zeta(s)$ 的非平凡零点之间的关系。这个计算实践要求你实现显式公式的一个截断版本，并将其结果与 $\\psi(x)$ 的精确值进行比较。通过这个过程，你将直观地感受到zeta函数的零点是如何“指挥”素数分布的微小波动的，从而将抽象的理论转化为可触摸的数值现实。[@problem_id:3029734]", "problem": "您需要实现一个完整、可运行的程序，该程序使用一个从基本定义推导出的显式公式来估算第二 Chebyshev 函数 $\\psi(x)$，并将此显式公式的估算值与精确的算术和定义以及 $x$ 进行比较。该显式公式应从第一性原理推导，并使用 Riemann zeta 函数 $\\zeta(s)$ 的一组有限的已知非平凡零点，以截断的、数值稳定的形式实现。\n\n基本原理：\n- 定义 von Mangoldt 函数 $\\Lambda(n)$：若 $n = p^k$（其中 $p$ 为素数，$k \\geq 1$ 为整数），则 $\\Lambda(n) = \\log p$；否则 $\\Lambda(n) = 0$。\n- 定义第二 Chebyshev 函数 $\\psi(x)$：对于实数 $x \\geq 1$，$\\psi(x) = \\sum_{n \\leq x} \\Lambda(n)$。\n- 对于 $\\operatorname{Re}(s) > 1$，使用其欧拉乘积和狄利克雷级数定义 Riemann zeta 函数 $\\zeta(s)$，并回顾在 $\\operatorname{Re}(s) > 1$ 上成立的、将对数导数与 von Mangoldt 函数联系起来的著名恒等式：\n$$\n-\\frac{\\zeta'(s)}{\\zeta(s)} = \\sum_{n=1}^{\\infty} \\frac{\\Lambda(n)}{n^s}.\n$$\n- 回顾 $\\zeta(s)$ 的解析结构：在 $s=1$ 处有一个留数为 $1$ 的一阶极点，在负偶数 $s=-2,-4,\\dots$ 处有平凡零点，在临界带 $0 < \\operatorname{Re}(s) < 1$ 中有非平凡零点 $\\rho$。您可以假设前几个非平凡零点位于临界线 $\\operatorname{Re}(\\rho)=\\tfrac{1}{2}$ 上，并且其值是高精度已知的。\n\n任务：\n1. 从 $-\\zeta'(s)/\\zeta(s)$ 的恒等式出发，通过 Perron 公式和围道移动，推导出一个关于 $x$ 和 $-\\zeta'(s)/\\zeta(s)$ 奇点贡献的 $\\psi(x)$ 平滑版本的显式公式表达式。您的推导必须分别确定来自以下各项的贡献：\n   - $s=1$ 处的极点，\n   - $\\zeta(s)$ 的非平凡零点 $\\rho$，\n   - 负偶数处的平凡零点，\n   - 以及由函数方程和 $\\zeta(s)$ 的解析性决定的来自 $s=0$ 的项。\n   将此公式重构为一个可以使用有限个非平凡零点进行数值实现的截断形式。\n\n2. 为整数输入 $x \\geq 2$ 实现两个函数：\n   - 通过求和 $\\sum_{n \\leq x} \\Lambda(n)$ 对 $\\psi(x)$ 进行精确计算。为便于实践，请将其构造为对素数幂的求和：对于每个素数 $p \\leq x$，当 $p^k \\leq x$ 时，对每个指数 $k \\geq 1$ 计入一次 $\\log p$。\n   - 使用前 $K$ 个按虚部 $\\gamma$ 列出的非平凡零点 $\\rho=\\tfrac{1}{2} \\pm i\\gamma$，结合您的推导中确定的平凡零点和常数项的贡献，对平滑的 $\\psi(x)$ 进行截断的显式公式估算。通过将共轭零点配对，以数值稳定的方式实现对零点的求和。\n\n3. 在您的截断求和中，使用以下 $\\zeta(s)$ 前几个非平凡零点的有限虚部集合（这些值是复零点的参数，因此是无量纲的）：\n   $[14.134725141734693, 21.022039638771556, 25.010857580145688, 30.424876125859513, 32.935061587739190, 37.586178158825671, 40.918719012147495, 43.327073281693326, 48.005150881167159, 49.773832477672302, 52.970321477714460, 56.446247697063394, 59.347044002602353, 60.831778524609810, 65.112544048082656, 67.079810529494173, 69.546401711173, 72.06715767448191]$.\n\n4. 设计输出，以比较 $\\psi(x)$ 与 $x$ 的值，并评估显式公式近似的性能。对于每个测试用例 $x$，计算并返回列表 $[x, \\psi(x) - x, \\widehat{\\psi}(x) - x, |\\widehat{\\psi}(x) - \\psi(x)|]$，其中 $\\widehat{\\psi}(x)$ 表示您对平滑 $\\psi(x)$ 的截断显式公式估算值。\n\n测试套件：\n- 使用以下整数值 $x$ 来评估您的实现：\n  - $x = 1000$ (基准中等值)，\n  - $x = 10000$ (较大值)，\n  - $x = 100000$ (理想路径，更大规模)，\n  - $x = 131072$ (边界情况：一个素数幂，$2^{17}$)，\n  - $x = 999983$ (接近一百万，一个大素数)，\n  - $x = 1000000$ (中等范围的边缘)。\n\n答案格式：\n- 您的程序应生成单行输出，其中包含测试套件的结果，形式为一个用方括号括起来的逗号分隔列表。该顶层列表的每个元素本身都是一个形式为 $[x, \\psi(x) - x, \\widehat{\\psi}(x) - x, |\\widehat{\\psi}(x) - \\psi(x)|]$ 的列表。例如，输出必须如下所示：\n  \"[[x1,exact_minus_x1,approx_minus_x1,error1],[x2,exact_minus_x2,approx_minus_x2,error2],...]\"。", "solution": "我们从在 $\\operatorname{Re}(s) > 1$ 上成立的基本恒等式开始：\n$$\n-\\frac{\\zeta'(s)}{\\zeta(s)} = \\sum_{n=1}^{\\infty} \\frac{\\Lambda(n)}{n^s}.\n$$\n根据 Perron 公式，对于 $x \\geq 2$，$\\Lambda(n)$ 的求和函数的一个平滑版本可以写成 $-\\zeta'(s)/\\zeta(s)$ 乘以 $x^s/s$ 的复积分。一个标准的方法是考虑\n$$\nI(x; c,T) = \\frac{1}{2\\pi i}\\int_{c-iT}^{c+iT} -\\frac{\\zeta'(s)}{\\zeta(s)} \\frac{x^s}{s}\\, ds,\n$$\n其中 $c>1$，然后将积分围道向左移动到一个 $\\operatorname{Re}(s) < 0$ 的竖直线上，并收集 $-\\zeta'(s)/\\zeta(s) \\cdot x^s/s$ 的奇点处的留数。函数 $-\\zeta'(s)/\\zeta(s)$ 具有以下奇点结构：\n- 在 $s=1$ 处有一个留数为 $1$ 的一阶极点（来自 $\\zeta(s)$ 的一阶极点），\n- 在 $\\zeta(s)$ 的每个非平凡零点 $s=\\rho$ 处有简单极点，每个极点在 $-\\zeta'/\\zeta$ 中贡献一个留数 $-1$，\n- 在平凡零点 $s=-2,-4,-6,\\dots$ 处有简单极点，\n- 在 $s=0$ 处是一个正则点，但在考虑用函数方程计算常数时，会产生一个非平凡的贡献。\n\n移动围道并对留数求和，可以得到平滑的第二 Chebyshev 函数的 Riemann 显式公式：\n$$\n\\psi_0(x) = x - \\sum_{\\rho} \\frac{x^{\\rho}}{\\rho} - \\log(2\\pi) - \\frac{1}{2}\\log\\!\\left(1 - \\frac{1}{x^2}\\right),\n$$\n其中 $\\psi_0(x)$ 表示在不连续点处的对称平均值：\n$$\n\\psi_0(x) = \\frac{1}{2}\\left(\\lim_{\\varepsilon\\to 0^+} \\psi(x+\\varepsilon) + \\lim_{\\varepsilon\\to 0^+} \\psi(x-\\varepsilon)\\right).\n$$\n项 $x$ 是来自 $s=1$ 处极点的留数贡献。和式 $\\sum_{\\rho} x^{\\rho}/\\rho$ 是对 $\\zeta(s)$ 的所有非平凡零点 $\\rho$ 求和，来自于 $s=\\rho$ 处的留数。常数 $-\\log(2\\pi)$ 可以通过使用 $\\zeta(s)$ 的函数方程并仔细计算 $s=0$ 附近的贡献来推导。项 $-\\tfrac{1}{2}\\log(1-1/x^2)$ 来自于负偶整数处的平凡零点，通过围道积分计算中的一个等比级数恒等式得出。\n\n一种可数值实现的截断只使用有限个非平凡零点。将复共轭零点配对（在 Riemann 假设下，它们以 $\\rho=\\tfrac{1}{2} \\pm i\\gamma$ 形式出现，其中 $\\gamma>0$，不过一般情况下通过共轭性配对也成立）可得\n$$\n\\sum_{\\rho} \\frac{x^\\rho}{\\rho} = 2\\sum_{\\gamma>0} \\operatorname{Re}\\left( \\frac{x^{\\frac{1}{2}+i\\gamma}}{\\frac{1}{2}+i\\gamma} \\right),\n$$\n其中 $x^{\\frac{1}{2}+i\\gamma} = x^{1/2} e^{i\\gamma \\log x}$。截断为前 $K$ 个 $\\gamma$ 值可得\n$$\n\\widehat{\\psi}_0(x) = x - 2\\sum_{k=1}^{K} \\operatorname{Re}\\left( \\frac{x^{\\frac{1}{2}+i\\gamma_k}}{\\frac{1}{2}+i\\gamma_k} \\right) - \\log(2\\pi) - \\frac{1}{2}\\log\\!\\left(1 - \\frac{1}{x^2}\\right).\n$$\n当 $x$ 适度大时，这提供了一个实用的估算量。每个被忽略的零点所产生的截断误差量级大致为 $O\\!\\left(\\frac{\\sqrt{x}}{\\gamma_{K}}\\right)$，因此随着 $x$ 的增长，包含更多的零点可以提高精度。请注意，$\\psi(x)$ 是一个阶梯函数，在素数幂 $p^k$ 处有大小为 $\\Lambda(p^k)$ 的跳跃，而 $\\psi_0(x)$ 是在跳跃点处的对称平均值。因此，即使使用了很多零点，当 $x$ 恰好等于一个素数幂时，预计也会有大约 $\\tfrac{1}{2}\\Lambda(p^k)$ 的差异。\n\n精确的 $\\psi(x)$ 算术计算可以组织成对素数幂的求和：\n$$\n\\psi(x) = \\sum_{p \\le x} \\left\\lfloor \\frac{\\log x}{\\log p} \\right\\rfloor \\log p,\n$$\n该式对每个使得 $p^k \\le x$ 的指数 $k$ 计入一次 $\\log p$。从算法角度看，迭代幂次更清晰：对每个素数 $p\\le x$，计算 $p, p^2, p^3, \\dots$ 中有多少个是 $\\le x$ 的。\n\n算法设计：\n- 精确的 $\\psi(x)$：\n  1. 使用 Sieve of Eratosthenes（埃拉托斯特尼筛法）生成所有 $\\le x$ 的素数。\n  2. 对每个素数 $p$，迭代 $m=p, p^2, \\dots$ 直到 $m > x$，并对每个 $m$ 累加一次 $\\log p$（这计算了 $\\Lambda(m)$ 的贡献）。\n- 截断的显式公式估算：\n  1. 预加载一个包含前 $K$ 个非平凡零点虚部 $\\gamma_k$ 的列表。\n  2. 使用复数算术计算和式 $2\\sum_{k=1}^{K} \\operatorname{Re}\\left( x^{\\frac{1}{2}+i\\gamma_k}/(\\frac{1}{2}+i\\gamma_k) \\right)$。这种方法是数值稳定的，因为 $|x^{\\frac{1}{2}+i\\gamma}|=x^{1/2}$ 并且除以 $\\frac{1}{2}+i\\gamma$ 会通过 $|\\frac{1}{2}+i\\gamma|$ 进行衰减。\n  3. 通过加上极点项 $x$，并减去零点和、常数 $-\\log(2\\pi)$ 以及推导出的平凡零点项 $-\\tfrac{1}{2}\\log(1-1/x^2)$ 来构造 $\\widehat{\\psi}_0(x)$。\n- 比较指标：\n  1. 计算 $\\psi(x)-x$ 和 $\\widehat{\\psi}_0(x)-x$。\n  2. 报告绝对误差 $|\\widehat{\\psi}_0(x)-\\psi(x)|$。\n\n提供的测试套件涵盖：\n- 一个基准中等值 $x=1000$，\n- 较大值 $x=10000$ 和 $x=100000$，\n- 一个素数幂边界情况 $x=131072=2^{17}$，此时 $\\psi(x)$ 有一个跳跃，\n- 一个接近 $10^6$ 的大素数 $x=999983$，\n- 一个中等范围的边缘值 $x=1000000$。\n\n最终的程序应为每个测试用例打印单行输出，该行是一个由列表 $[x, \\psi(x) - x, \\widehat{\\psi}_0(x) - x, |\\widehat{\\psi}_0(x) - \\psi(x)|]$ 组成的、用方括号括起来的逗号分隔列表，不含任何额外文本。此行为程序产生的唯一输出。此处不涉及物理单位；所有量均为无量纲的实数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\nimport cmath\n\ndef primes_upto(n: int):\n    \"\"\"Return list of primes up to n using a memory-efficient sieve.\"\"\"\n    if n < 2:\n        return []\n    sieve = bytearray(b'\\x01') * (n + 1)\n    sieve[0:2] = b'\\x00\\x00'\n    limit = int(n**0.5)\n    for i in range(2, limit + 1):\n        if sieve[i]:\n            step = i\n            start = i * i\n            sieve[start:n+1:step] = b'\\x00' * (((n - start) // step) + 1)\n    return [i for i in range(2, n + 1) if sieve[i]]\n\ndef psi_exact(x: int) -> float:\n    \"\"\"Compute psi(x) = sum_{n <= x} Lambda(n) exactly via prime powers.\"\"\"\n    primes = primes_upto(x)\n    total = 0.0\n    for p in primes:\n        # Count contributions for prime powers p^k <= x\n        m = p\n        logp = math.log(p)\n        while m <= x:\n            total += logp\n            # Prevent overflow in multiplication for very large p (not relevant here)\n            m *= p\n    return total\n\ndef psi_explicit_approx(x: int, gammas: list[float]) -> float:\n    \"\"\"\n    Truncated explicit formula approximation for the smoothed psi(x):\n    psi0(x) ≈ x - 2 * sum_{gamma>0} Re( x^{1/2 + i gamma} / (1/2 + i gamma) )\n             - log(2*pi) - (1/2) * log(1 - x^{-2}).\n    \"\"\"\n    # Sum over paired zeros (use only positive gamma and double the real part)\n    sum_zeros = 0.0\n    ln_x = math.log(x)\n    for g in gammas:\n        denom = complex(0.5, g)\n        # x^{1/2 + i g} = x**0.5 * exp(i g log x)\n        x_rho = complex(x**0.5, 0.0) * cmath.exp(1j * g * ln_x)\n        term = x_rho / denom\n        sum_zeros += 2.0 * term.real\n    # Constant and trivial zeros contributions\n    const_term = math.log(2.0 * math.pi)\n    trivial_term = 0.5 * math.log(1.0 - (1.0 / (x * x)))\n    # Assemble approximation\n    psi0_hat = x - sum_zeros - const_term - trivial_term\n    return psi0_hat\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        1000,\n        10000,\n        100000,\n        131072,  # 2^17, prime-power boundary case\n        999983,  # a large prime near 1e6\n        1000000\n    ]\n\n    # Imaginary parts of the first several nontrivial zeros of zeta(s).\n    gammas = [\n        14.134725141734693,\n        21.022039638771556,\n        25.010857580145688,\n        30.424876125859513,\n        32.935061587739190,\n        37.586178158825671,\n        40.918719012147495,\n        43.327073281693326,\n        48.005150881167159,\n        49.773832477672302,\n        52.970321477714460,\n        56.446247697063394,\n        59.347044002602353,\n        60.831778524609810,\n        65.112544048082656,\n        67.079810529494173,\n        69.546401711173,\n        72.06715767448191,\n    ]\n\n    results = []\n    for x in test_cases:\n        psi_x = psi_exact(x)\n        psi_hat = psi_explicit_approx(x, gammas)\n        exact_minus_x = psi_x - x\n        approx_minus_x = psi_hat - x\n        abs_err = abs(psi_hat - psi_x)\n        results.append([x, exact_minus_x, approx_minus_x, abs_err])\n\n    # Final print statement in the exact required format.\n    # Single line with list of lists.\n    print(f\"[{','.join(str(item) for item in results)}]\")\n\nsolve()\n```", "id": "3029734"}]}