{"hands_on_practices": [{"introduction": "在解析数论中，黎曼素数幂计数函数 $\\Pi(x)$ 被认为是一个比素数计数函数 $\\pi(x)$ 更“自然”的研究对象。此练习将通过具体计算，帮助你理解这两个函数之间的关系。你将计算 $\\Pi(x)$ 中所有高于一次的素数幂（即素数的平方、立方等）的贡献，这揭示了 $\\Pi(x)$ 的内在结构，并为后续理解素数定理的近似估计提供了直观基础。[@problem_id:758183]", "problem": "在数论中，素数计数函数记作 $\\pi(x)$，表示小于或等于实数 $x$ 的素数个数。素数定理给出了该函数的一个著名渐近估计：$\\pi(x) \\sim x/\\log x$。\n\nBernhard Riemann 在其1859年的开创性论文《On the Number of Primes Less Than a Given Magnitude》中，引入了一个相关函数，现称作黎曼素数幂计数函数 $\\Pi(x)$。该函数定义为对所有小于或等于 $x$ 的素数幂 $p^k$ 求和：\n$$\n\\Pi(x) = \\sum_{p^k \\le x} \\frac{1}{k}\n$$\n其中和式是对素数 $p$ 和正整数 $k$ 求和。一个等价定义将 $\\Pi(x)$ 与 $\\pi(x)$ 联系起来：\n$$\n\\Pi(x) = \\sum_{n=1}^{\\infty} \\frac{1}{n} \\pi(x^{1/n})\n$$\nRiemann 的工作表明，对数积分 $\\text{li}(x)$ 是 $\\Pi(x)$ 的一个极佳近似，此结果与黎曼zeta函数的非平凡零点密切相关。这意味着，在某种意义上，与 $\\pi(x)$ 本身相比，$\\Pi(x)$ 在此背景下是一个更自然的研究对象。\n\n这两个函数之间的关系可写作 $\\Pi(x) = \\pi(x) + T(x)$，其中 $T(x)$ 代表指数大于一（$k \\ge 2$）的素数幂的总贡献。该项 $T(x)$ 可被视为一个“修正项”，它将初等的素数计数函数 $\\pi(x)$ 与解析上更基本的黎曼函数 $\\Pi(x)$ 连接起来。\n\n你的任务是计算当 $x=120$ 时，此修正项 $T(x)$ 的精确值。也就是说，求出素数的平方、立方及更高次幂对 $\\Pi(120)$ 值的总贡献。", "solution": "我们要求解 $x=120$ 时的修正项\n$$\nT(x)=\\sum_{k=2}^\\infty\\frac{1}{k}\\,\\pi\\bigl(x^{1/k}\\bigr)\n$$\n我们对 $k\\ge2$ 计算 $120^{1/k}$ 的值及相应的 $\\pi$ 值，直到 $\\pi\\bigl(120^{1/k}\\bigr)=0$ 为止：\n\n1. $k=2$: \n$$120^{1/2}\\approx10.954\\implies\\pi(10.954)=4\\quad(2,3,5,7)$$\n贡献为：$\\frac{1}{2}\\cdot4=2$。\n\n2. $k=3$: \n$$120^{1/3}\\approx4.932\\implies\\pi(4.932)=2\\quad(2,3)$$\n贡献为：$\\frac{1}{3}\\cdot2=\\tfrac{2}{3}$。\n\n3. $k=4$: \n$$120^{1/4}\\approx3.309\\implies\\pi(3.309)=2\\quad(2,3)$$\n贡献为：$\\frac{1}{4}\\cdot2=\\tfrac{1}{2}$。\n\n4. $k=5$: \n$$120^{1/5}\\approx2.603\\implies\\pi(2.603)=1\\quad(2)$$\n贡献为：$\\frac{1}{5}\\cdot1=\\tfrac{1}{5}$。\n\n5. $k=6$: \n$$120^{1/6}\\approx2.221\\implies\\pi(2.221)=1\\quad(2)$$\n贡献为：$\\frac{1}{6}\\cdot1=\\tfrac{1}{6}$。\n\n对于 $k\\ge7$，$120^{1/k}  2 \\implies \\pi(120^{1/k})=0$。求和可得\n$$\nT(120)\n=2+\\frac{2}{3}+\\frac{1}{2}+\\frac{1}{5}+\\frac{1}{6}\n=\\frac{60+20+15+6+5}{30}\n=\\frac{106}{30}\n=\\frac{53}{15}\\,.\n$$", "answer": "$$\\boxed{\\frac{53}{15}}$$", "id": "758183"}, {"introduction": "在前面的练习中，我们使用了一个给定的不等式来推导 $\\psi(x)$ 的界。现在，我们将深入探究这个不等式的来源并精确化其结果。本练习将素数计数函数与组合数学通过中心二项式系数 $\\binom{2n}{n}$ 联系起来，通过分析其素数分解并利用斯特林公式进行渐近估计，从而推导出素数增长的精确界限。这个高级练习揭示了离散结构（素数分解）与连续分析（斯特林公式）之间深刻的相互作用，使你能够从第一性原理出发，推导出切比雪夫估计中的关键渐近常数 $C = 2\\ln 2$。[@problem_id:3012715]", "problem": "令 $\\psi(x)$ 表示切比雪夫函数 $\\psi(x) = \\sum_{p^{k} \\leq x} \\ln p$，其中求和项为所有不超过 $x$ 的素数幂 $p^{k}$，并令 $\\pi(x)$ 表示素数计数函数。对每个正整数 $n$，考虑中心二项式系数 $\\binom{2n}{n}$ 和区间 $(n,2n]$。\n\n从基本定义 $v_{p}(m!) = \\sum_{k \\geq 1} \\left\\lfloor \\frac{m}{p^{k}} \\right\\rfloor$、恒等式 $\\ln(m!) = \\sum_{p} v_{p}(m!) \\ln p$ 以及阶乘的经典斯特林公式出发，推导连接 $\\psi(2n)-\\psi(n)$ 与 $\\ln \\binom{2n}{n}$ 的双边界。然后，通过对 $\\ln \\binom{2n}{n}$ 应用斯特林公式，确定精确的线性系数 $C$，使得\n$$\n\\psi(2n)-\\psi(n) \\leq C\\, n + o(n) \\quad \\text{当 } n \\to \\infty,\n$$\n并利用此结果推导出不等式\n$$\n\\pi(2n)-\\pi(n) \\leq \\left(C + o(1)\\right)\\frac{n}{\\ln n}.\n$$\n中相应的渐近上界常数。请给出 $C$ 的精确封闭形式值作为最终答案。", "solution": "问题要求推导与素数计数函数增长的上界相关的精确线性系数 $C$。解题过程分为四个主要步骤：\n1.  建立切比雪夫函数 $\\psi(x)$ 与中心二项式系数 $\\binom{2n}{n}$ 之间的关系。\n2.  应用斯特林公式求出 $\\ln\\binom{2n}{n}$ 的渐近行为。\n3.  结合这些结果来确定函数 $\\psi(2n)-\\psi(n)$ 的常数 $C$。\n4.  推导素数计数函数差 $\\pi(2n)-\\pi(n)$ 的相应常数。\n\n**步骤 1：关联 $\\psi(x)$ 与 $\\ln\\binom{2n}{n}$**\n\n我们从中心二项式系数的定义 $\\binom{2n}{n} = \\frac{(2n)!}{(n!)^2}$ 开始。取自然对数，我们得到：\n$$\n\\ln\\binom{2n}{n} = \\ln((2n)!) - 2\\ln(n!)\n$$\n题目给出了恒等式 $\\ln(m!) = \\sum_{p} v_p(m!) \\ln p$，其中 $v_p(m!)$ 是 $m!$ 素数分解中素数 $p$ 的指数。使用这个恒等式，我们有：\n$$\n\\ln\\binom{2n}{n} = \\sum_{p} v_p((2n)!) \\ln p - 2 \\sum_{p} v_p(n!) \\ln p = \\sum_{p} \\left( v_p((2n)!) - 2v_p(n!) \\right) \\ln p\n$$\n在 $\\binom{2n}{n}$ 的素数分解中，$p$ 的指数是 $v_p\\left(\\binom{2n}{n}\\right) = v_p((2n)!) - 2v_p(n!)$。使用勒让德公式 $v_p(m!) = \\sum_{k \\ge 1} \\left\\lfloor \\frac{m}{p^k} \\right\\rfloor$，我们可以写出：\n$$\nv_p\\left(\\binom{2n}{n}\\right) = \\sum_{k=1}^{\\infty} \\left( \\left\\lfloor \\frac{2n}{p^k} \\right\\rfloor - 2\\left\\lfloor \\frac{n}{p^k} \\right\\rfloor \\right)\n$$\n当 $p^k > 2n$ 时，求和终止。我们把括号中的项记为 $c_k(p,n)$。对于任意实数 $x$，$\\lfloor 2x \\rfloor - 2\\lfloor x \\rfloor$ 的值是 $0$ 或 $1$。因此，$c_k(p,n) \\in \\{0, 1\\}$。\n\n将此代入 $\\ln\\binom{2n}{n}$ 的表达式中：\n$$\n\\ln\\binom{2n}{n} = \\sum_{p} \\left( \\sum_{k=1}^{\\infty} c_k(p,n) \\right) \\ln p\n$$\n我们可以交换求和顺序。令 $\\Lambda(m)$ 为冯·曼戈尔特函数，当 $m=p^k$（$p$ 是素数，$k \\ge 1$ 是整数）时，其值为 $\\ln p$，否则为 $0$。表达式变为：\n$$\n\\ln\\binom{2n}{n} = \\sum_{m=1}^{2n} \\Lambda(m) \\left( \\left\\lfloor \\frac{2n}{m} \\right\\rfloor - 2\\left\\lfloor \\frac{n}{m} \\right\\rfloor \\right)\n$$\n切比雪夫函数的定义为 $\\psi(x) = \\sum_{m \\le x} \\Lambda(m)$。我们可以将关于 $m$ 的和分为两部分：$m \\in [1, n]$ 和 $m \\in (n, 2n]$。\n\n对于 $m \\in (n, 2n]$，我们有 $\\lfloor \\frac{2n}{m} \\rfloor = 1$ 和 $\\lfloor \\frac{n}{m} \\rfloor = 0$。所以系数 $\\lfloor \\frac{2n}{m} \\rfloor - 2\\lfloor \\frac{n}{m} \\rfloor = 1$。此范围的贡献是：\n$$\n\\sum_{n  m \\le 2n} \\Lambda(m) = \\psi(2n) - \\psi(n)\n$$\n对于 $m \\in [1, n]$，系数是非负的。我们定义余项为：\n$$\nR_n = \\sum_{m=1}^{n} \\Lambda(m) \\left( \\left\\lfloor \\frac{2n}{m} \\right\\rfloor - 2\\left\\lfloor \\frac{n}{m} \\right\\rfloor \\right) \\ge 0\n$$\n因此，我们有精确的恒等式：\n$$\n\\ln\\binom{2n}{n} = \\psi(2n) - \\psi(n) + R_n\n$$\n由于 $R_n \\ge 0$，我们得到了我们的第一个界：\n$$\n\\psi(2n) - \\psi(n) \\le \\ln\\binom{2n}{n}\n$$\n尽管最终答案并不严格要求，我们还是可以推导出一个下界。对系数 $\\lfloor 2x \\rfloor - 2\\lfloor x \\rfloor$ 进行更详细的分析，可以得到恒等式 $\\ln\\binom{2n}{n} = \\sum_{k=1}^{n} (\\psi(\\frac{2n}{2k-1}) - \\psi(\\frac{n}{k}))$。这个表达式可以被 $\\psi(2n)-\\psi(n) + \\psi(n)$ 从上方界定，从而得到 $\\ln\\binom{2n}{n} - \\psi(n) \\le \\psi(2n)-\\psi(n)$。所以，双边界是：\n$$\n\\ln\\binom{2n}{n} - \\psi(n) \\le \\psi(2n) - \\psi(n) \\le \\ln\\binom{2n}{n}\n$$\n\n**步骤 2：$\\ln\\binom{2n}{n}$ 的渐近行为**\n\n我们使用阶乘对数的斯特林公式：$\\ln(m!) = m\\ln m - m + \\frac{1}{2}\\ln(2\\pi m) + o(1)$。\n$$\n\\ln\\binom{2n}{n} = \\ln((2n)!) - 2\\ln(n!)\n$$\n$$\n\\ln((2n)!) = (2n)\\ln(2n) - 2n + \\frac{1}{2}\\ln(4\\pi n) + o(1)\n$$\n$$\n2\\ln(n!) = 2\\left(n\\ln n - n + \\frac{1}{2}\\ln(2\\pi n) + o(1)\\right) = 2n\\ln n - 2n + \\ln(2\\pi n) + o(1)\n$$\n将两个表达式相减：\n$$\n\\ln\\binom{2n}{n} = \\left((2n)\\ln(2n) - 2n + \\frac{1}{2}\\ln(4\\pi n)\\right) - \\left(2n\\ln n - 2n + \\ln(2\\pi n)\\right) + o(1)\n$$\n$$\n= 2n(\\ln 2 + \\ln n) - 2n\\ln n + \\frac{1}{2}\\ln(4\\pi n) - \\ln(2\\pi n) + o(1)\n$$\n$$\n= 2n\\ln 2 + 2n\\ln n - 2n\\ln n + \\frac{1}{2}(\\ln 4 + \\ln(\\pi n)) - (\\ln 2 + \\ln(\\pi n)) + o(1)\n$$\n$$\n= 2n\\ln 2 + \\ln 2 - \\frac{1}{2}\\ln(\\pi n) - \\ln 2 + o(1)\n$$\n$$\n= (2\\ln 2)n - \\frac{1}{2}\\ln n - \\frac{1}{2}\\ln \\pi + o(1)\n$$\n对于大的 $n$，主项是 $(2\\ln 2)n$。因此，我们可以写出：\n$$\n\\ln\\binom{2n}{n} = (2\\ln 2)n + O(\\ln n)\n$$\n\n**步骤 3：确定常数 $C$**\n\n从步骤 1，我们有不等式 $\\psi(2n) - \\psi(n) \\le \\ln\\binom{2n}{n}$。将其与步骤 2 的渐近结果结合：\n$$\n\\psi(2n) - \\psi(n) \\le (2\\ln 2)n + O(\\ln n)\n$$\n这可以写成问题所要求的形式：\n$$\n\\psi(2n) - \\psi(n) \\le (2\\ln 2)n + o(n)\n$$\n问题要求的是精确的线性系数 $C$。在指定的初等方法中，不等式 $\\psi(2n)-\\psi(n) \\le \\ln\\binom{2n}{n}$ 是可用的最佳上界。$\\frac{1}{n}\\ln\\binom{2n}{n}$ 的渐近极限是 $2\\ln 2$。因此，从这种方法推导出的精确常数是 $C = 2\\ln 2$。\n\n**步骤 4：推导 $\\pi(x)$ 的界**\n\n我们需要将 $\\psi(x)$ 与 $\\pi(x)$ 联系起来。第一切比雪夫函数是 $\\theta(x) = \\sum_{p \\le x} \\ln p$。我们有以下关系：\n$$\n\\psi(x) = \\sum_{k=1}^\\infty \\theta(x^{1/k}) = \\theta(x) + \\theta(x^{1/2}) + \\theta(x^{1/3}) + \\dots\n$$\n由于 $\\theta(y) = O(y)$，对于 $k \\ge 2$ 的项之和是有界的：$\\theta(x^{1/2}) + \\theta(x^{1/3}) + \\dots = O(x^{1/2}) + O(x^{1/3}) + \\dots = O(\\sqrt{x})$。所以，$\\psi(x) = \\theta(x) + O(\\sqrt{x})$。\n这意味着 $\\psi(2n)-\\psi(n) = \\theta(2n)-\\theta(n) + O(\\sqrt{n})$。\n我们关于 $\\psi$ 的不等式给出：\n$$\n\\theta(2n)-\\theta(n) + O(\\sqrt{n}) \\le (2\\ln 2)n + o(n)\n$$\n这可以简化为：\n$$\n\\theta(2n)-\\theta(n) \\le (2\\ln 2)n + o(n)\n$$\n现在我们将 $\\theta(x)$ 与 $\\pi(x)$ 联系起来。对于区间 $(n, 2n]$ 中的素数 $p$，我们有 $\\ln n  \\ln p \\le \\ln(2n)$。\n令 $\\pi(2n) - \\pi(n)$ 为 $(n, 2n]$ 中的素数个数。那么：\n$$\n(\\pi(2n) - \\pi(n)) \\ln n \\le \\sum_{n  p \\le 2n} \\ln p \\le (\\pi(2n) - \\pi(n)) \\ln(2n)\n$$\n这个和正好是 $\\theta(2n) - \\theta(n)$。使用这个不等式的左边部分：\n$$\n(\\pi(2n) - \\pi(n)) \\ln n \\le \\theta(2n) - \\theta(n) \\le (2\\ln 2)n + o(n)\n$$\n两边除以 $\\ln n$：\n$$\n\\pi(2n) - \\pi(n) \\le \\frac{(2\\ln 2)n + o(n)}{\\ln n} = (2\\ln 2)\\frac{n}{\\ln n} + o\\left(\\frac{n}{\\ln n}\\right)\n$$\n这对应于所需的形式 $\\pi(2n)-\\pi(n) \\le (C + o(1))\\frac{n}{\\ln n}$，其中常数 $C = 2\\ln 2$。\n\n因此，$C$ 的精确封闭形式值为 $2\\ln 2$。", "answer": "$$\\boxed{2\\ln 2}$$", "id": "3012715"}]}