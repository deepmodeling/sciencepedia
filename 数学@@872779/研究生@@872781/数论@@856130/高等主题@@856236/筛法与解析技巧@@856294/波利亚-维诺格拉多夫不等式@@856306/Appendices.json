{"hands_on_practices": [{"introduction": "要真正理解像波利亚-维诺格拉多夫不等式这样的抽象界限，最好的方法是从一个具体的例子开始。这个练习将指导你为一个简单的二次特征（勒让德符号）计算其特征和。通过直接计算部分和并找出其最大值 [@problem_id:3028891]，你将对这些和的行为有一个直观的感受，并能将实际观察到的最大值与理论上的 $\\sqrt{q}\\log q$ 界限进行比较。", "problem": "设 $q=13$，并设 $\\chi:\\mathbb{Z}\\to\\{-1,0,1\\}$ 为由勒让德符号 $\\chi(n)=\\left(\\frac{n}{13}\\right)$ 定义的模 $13$ 的二次 Dirichlet 特征。对每个整数 $x\\ge 0$，定义特征和 $S(x)=\\sum_{1\\le n\\le x}\\chi(n)$，其中空和取为 $0$。从勒让德符号的定义和 Dirichlet 特征的周期性性质出发，明确地确定对所有整数 $x\\ge 0$ 的 $S(x)$，并找出全局最大值 $M=\\max_{x\\ge 0}|S(x)|$。为了量化与 Pólya-Vinogradov 不等式的比较，构造归一化大小 $R=\\dfrac{M}{\\sqrt{13}\\,\\log 13}$。\n\n请提供 $R$ 的精确值，形式为单个封闭表达式。不要对您的答案进行四舍五入。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 模为 $q=13$。\n- 特征 $\\chi: \\mathbb{Z} \\to \\{-1, 0, 1\\}$ 是模 $13$ 的二次 Dirichlet 特征，由勒让德符号 $\\chi(n) = \\left(\\frac{n}{13}\\right)$ 定义。\n- 特征和定义为 $S(x) = \\sum_{1 \\le n \\le x} \\chi(n)$，对任意整数 $x \\ge 0$，其中空和 ($x=0$) 为 $0$。\n- 特征和的最大绝对值为 $M = \\max_{x \\ge 0} |S(x)|$。\n- 需要计算的归一化大小为 $R = \\frac{M}{\\sqrt{13} \\log 13}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据所需标准对问题进行评估。\n- **科学依据**：该问题植根于解析数论，涉及标准对象：Dirichlet 特征、勒让德符号和特征和。上下文中提到的 Pólya-Vinogradov 不等式是该领域的一个基本定理。所需的计算是该学科的标准练习。该问题在事实上和科学上都是合理的。\n- **适定性**：$\\chi$ 和 $S(x)$ 的定义是精确的。量 $M$ 是良定义的，因为如下所示，$S(x)$ 是一个周期函数，因此其最大值存在，并且可以通过检查有限个值来找到。最终的量 $R$ 是良定义项的简单代数组合。存在一个唯一且有意义的解。\n- **客观性**：该问题以清晰、明确的数学语言陈述，不含任何主观或基于意见的内容。\n- **完备性与一致性**：该问题提供了解决它所需的所有必要信息。给定的定义和约束是自洽的。\n\n### 步骤 3：结论与行动\n该问题被认为是**有效的**，因为其具有科学依据、适定、客观且自洽。可以进行求解过程。\n\n### 解答\n目标是求出 $R = \\frac{M}{\\sqrt{13} \\log 13}$ 的精确值。这需要确定 $M = \\max_{x \\ge 0} |S(x)|$，而这又需要明确计算特征和 $S(x)$。\n\n首先，我们必须对一个完整周期计算特征 $\\chi(n) = \\left(\\frac{n}{13}\\right)$。模 $q=13$ 是一个素数。勒让德符号 $\\left(\\frac{n}{13}\\right)$ 的值，当 $n$ 是模 $13$ 的二次剩余时为 $1$，当 $n$ 是模 $13$ 的二次非剩余时为 $-1$，当 $n$ 是 $13$ 的倍数时为 $0$。\n\n模 $13$ 的二次剩余是那些与不能被 $13$ 整除的完全平方数同余的整数。我们计算模 $13$ 的非零平方数：\n$1^2 \\equiv 1 \\pmod{13}$\n$2^2 \\equiv 4 \\pmod{13}$\n$3^2 \\equiv 9 \\pmod{13}$\n$4^2 = 16 \\equiv 3 \\pmod{13}$\n$5^2 = 25 \\equiv 12 \\pmod{13}$\n$6^2 = 36 \\equiv 10 \\pmod{13}$\n$7, \\dots, 12$ 的平方产生相同的集合，因为 $(13-k)^2 \\equiv (-k)^2 \\equiv k^2 \\pmod{13}$。\n二次剩余（QR）的集合是 $\\{1, 3, 4, 9, 10, 12\\}$。\n对于这些 $n$ 值，$\\chi(n)=1$。\n\n二次非剩余（QNR）的集合由 $[1, 12]$ 范围内的其余整数组成：$\\{2, 5, 6, 7, 8, 11\\}$。\n对于这些 $n$ 值，$\\chi(n)=-1$。\n\n对于任何是 $13$ 的倍数的整数 $n$，$\\chi(n)=0$。\n\n对于 $n=1, 2, \\dots, 13$，$\\chi(n)$ 的值序列是：\n$\\chi(1) = 1$\n$\\chi(2) = -1$\n$\\chi(3) = 1$\n$\\chi(4) = 1$\n$\\chi(5) = -1$\n$\\chi(6) = -1$\n$\\chi(7) = -1$\n$\\chi(8) = -1$\n$\\chi(9) = 1$\n$\\chi(10) = 1$\n$\\chi(11) = -1$\n$\\chi(12) = 1$\n$\\chi(13) = 0$\n\n接下来，我们计算特征和 $S(x) = \\sum_{1 \\le n \\le x} \\chi(n)$。由于 $\\chi$ 是一个非主 Dirichlet 特征，其在一个完整周期上的和为零：$\\sum_{n=1}^{13} \\chi(n) = 0$。这意味着函数 $S(x)$ 是周期为 $13$ 的周期函数，即 $S(x+13) = S(x)$。这是因为 $S(x+13) = \\sum_{n=1}^{x+13} \\chi(n) = S(x) + \\sum_{n=x+1}^{x+13} \\chi(n)$。和 $\\sum_{n=x+1}^{x+13} \\chi(n)$ 是对模 $13$ 的一个完全剩余系的求和，其值为零。因此，为了找到 $M = \\max_{x \\ge 0} |S(x)|$，我们只需计算 $x \\in \\{0, 1, \\dots, 12\\}$ 的 $S(x)$。\n\n我们计算 $x=0, 1, \\dots, 13$ 的部分和 $S(x)$：\n$S(0) = 0$\n$S(1) = \\chi(1) = 1$\n$S(2) = S(1) + \\chi(2) = 1 + (-1) = 0$\n$S(3) = S(2) + \\chi(3) = 0 + 1 = 1$\n$S(4) = S(3) + \\chi(4) = 1 + 1 = 2$\n$S(5) = S(4) + \\chi(5) = 2 + (-1) = 1$\n$S(6) = S(5) + \\chi(6) = 1 + (-1) = 0$\n$S(7) = S(6) + \\chi(7) = 0 + (-1) = -1$\n$S(8) = S(7) + \\chi(8) = -1 + (-1) = -2$\n$S(9) = S(8) + \\chi(9) = -2 + 1 = -1$\n$S(10) = S(9) + \\chi(10) = -1 + 1 = 0$\n$S(11) = S(10) + \\chi(11) = 0 + (-1) = -1$\n$S(12) = S(11) + \\chi(12) = -1 + 1 = 0$\n$S(13) = S(12) + \\chi(13) = 0 + 0 = 0$\n\n$S(x)$ 在 $x \\in \\{0, 1, \\dots, 12\\}$ 上取值的集合是 $\\{0, 1, 0, 1, 2, 1, 0, -1, -2, -1, 0, -1, 0\\}$。\n为了找到 $M$，我们取这些和的绝对值：$\\{|0|, |1|, |0|, |1|, |2|, |1|, |0|, |-1|, |-2|, |-1|, |0|, |-1|, |0|\\}$，即集合 $\\{0, 1, 2\\}$。\n这个集合中的最大值是 $2$。\n因此，全局最大值为 $M = \\max_{x \\ge 0} |S(x)| = 2$。\n\n最后，我们计算归一化大小 $R$：\n$R = \\frac{M}{\\sqrt{13} \\log 13}$\n代入值 $M=2$，我们得到：\n$R = \\frac{2}{\\sqrt{13} \\log 13}$\n\n这是 $R$ 的精确封闭形式表达式。", "answer": "$$\n\\boxed{\\frac{2}{\\sqrt{13} \\log 13}}\n$$", "id": "3028891"}, {"introduction": "在通过具体计算建立了直观认识之后，我们来探讨波利亚-维诺格拉多夫不等式背后的理论基础。该不等式的一个关键特性是其界限对于任意长度的区间都统一成立，而与区间的起点无关。这个练习将引导你使用傅里叶分析从第一性原理出发，推导出一个对短区间上的特征和的界限 [@problem_id:3028925]，从而揭示为何该界限不依赖于求和区间的起点 $M$。这个过程展示了傅里叶展开和高斯和在解析数论中的强大作用。", "problem": "设 $q$ 是一个奇素数，$\\chi$ 是一个模 $q$ 的本原非主狄利克雷特征（例如，模 $q$ 的勒让德符号）。对于整数 $M$ 和 $N$，$1 \\leq N \\leq q$，定义部分特征和\n$$\nS(M,N) \\;=\\; \\sum_{n=M+1}^{M+N} \\chi(n).\n$$\n仅使用以下基础知识：\n- 模 $q$ 的加性特征的正交性，即对于 $a \\in \\mathbb{Z}$，\n$$\n\\frac{1}{q}\\sum_{k=0}^{q-1} \\exp\\!\\left(\\frac{2\\pi i k a}{q}\\right) \\;=\\; \\begin{cases} 1,  a \\equiv 0 \\pmod{q}, \\\\ 0,  a \\not\\equiv 0 \\pmod{q}, \\end{cases}\n$$\n- $\\mathbb{Z}/q\\mathbb{Z}$ 上的离散傅里叶展开，\n- 以及本原特征的高斯和恒等式，\n$$\n\\tau(\\chi) \\;=\\; \\sum_{n \\bmod q} \\chi(n) \\exp\\!\\left(\\frac{2\\pi i n}{q}\\right), \\qquad \\big|\\tau(\\chi)\\big| \\;=\\; \\sqrt{q},\n$$\n从第一性原理出发，推导一个满足\n$$\n|S(M,N)| \\;\\leq\\; B(N,q),\n$$\n的显式界 $B(N,q)$，它只依赖于 $N$ 和 $q$（以及通过 $q$ 依赖于 $\\chi$），而不依赖于 $M$。你的推导过程应清楚地说明为什么对 $M$ 的依赖性会消失。\n\n然后，特化到 $q=5$，$N=2$ 的情况，其中 $\\chi$ 是模 $5$ 的二次狄利克雷特征。计算你的显式界 $B(2,5)$ 的精确值。\n\n给出 $B(2,5)$ 的精确值作为你的最终答案。", "solution": "问题要求为部分特征和 $S(M,N) = \\sum_{n=M+1}^{M+N} \\chi(n)$ 推导一个显式界，其中 $\\chi$ 是一个模奇素数 $q$ 的本原非主狄利克雷特征。这个界记为 $B(N,q)$，必须与和的起点 $M$ 无关。推导必须基于一组指定的基础知识。\n\n核心策略是使用其在 $\\mathbb{Z}/q\\mathbb{Z}$ 上的离散傅里叶展开来表示特征 $\\chi(n)$。离散傅里叶分析的工具集建立在所提供的加性特征正交关系之上。对于任何函数 $f: \\mathbb{Z}/q\\mathbb{Z} \\to \\mathbb{C}$，其傅里叶展开为 $f(n) = \\sum_{k=0}^{q-1} \\hat{f}(k) \\exp\\left(\\frac{2\\pi i nk}{q}\\right)$，其中傅里叶系数由 $\\hat{f}(k) = \\frac{1}{q} \\sum_{m=0}^{q-1} f(m) \\exp\\left(\\frac{-2\\pi i mk}{q}\\right)$ 给出。这种表示的有效性是正交关系的直接推论。\n\n让我们来确定特征 $\\chi$ 的傅里叶系数 $\\hat{\\chi}(k)$。根据定义，\n$$\n\\hat{\\chi}(k) \\;=\\; \\frac{1}{q} \\sum_{n=0}^{q-1} \\chi(n) \\exp\\left(\\frac{-2\\pi i nk}{q}\\right).\n$$\n右边的和是一个广义高斯和。让我们将其与给定的高斯和 $\\tau(\\chi) = \\sum_{n \\bmod q} \\chi(n) \\exp\\left(\\frac{2\\pi i n}{q}\\right)$ 联系起来。令 $\\tau(\\chi, a) = \\sum_{n \\bmod q} \\chi(n) \\exp\\left(\\frac{2\\pi i na}{q}\\right)$。\n对于 $k \\not\\equiv 0 \\pmod q$，由于 $q$ 是素数，$k$ 存在模 $q$ 的乘法逆 $k^{-1}$。我们可以在 $\\tau(\\chi,k)$ 的和式中代入 $n=mk^{-1}$：\n$$\n\\tau(\\chi, k) \\;=\\; \\sum_{m \\bmod q} \\chi(mk^{-1}) \\exp\\left(\\frac{2\\pi i mk^{-1}k}{q}\\right) \\;=\\; \\chi(k^{-1}) \\sum_{m \\bmod q} \\chi(m) \\exp\\left(\\frac{2\\pi i m}{q}\\right) \\;=\\; \\bar{\\chi}(k) \\tau(\\chi).\n$$\n对于 $k \\equiv 0 \\pmod q$，我们有 $\\tau(\\chi, 0) = \\sum_{n \\bmod q} \\chi(n) = 0$，因为 $\\chi$ 是一个非主特征。此外，$\\bar{\\chi}(0)=0$，所以恒等式 $\\tau(\\chi, k) = \\bar{\\chi}(k) \\tau(\\chi)$ 对所有 $k \\in \\mathbb{Z}/q\\mathbb{Z}$ 都成立。\n傅里叶系数 $\\hat{\\chi}(k)$ 于是为\n$$\n\\hat{\\chi}(k) \\;=\\; \\frac{1}{q} \\tau(\\chi, -k) \\;=\\; \\frac{\\bar{\\chi}(-k)\\tau(\\chi)}{q}.\n$$\n现在，我们可以写出 $\\chi(n)$ 的傅里叶展开：\n$$\n\\chi(n) \\;=\\; \\sum_{k=0}^{q-1} \\hat{\\chi}(k) \\exp\\left(\\frac{2\\pi i nk}{q}\\right) \\;=\\; \\sum_{k=0}^{q-1} \\frac{\\bar{\\chi}(-k)\\tau(\\chi)}{q} \\exp\\left(\\frac{2\\pi i nk}{q}\\right).\n$$\n因为 $\\chi(0)=0$，$k=0$ 的项为零。因此，我们从 $k=1$ 到 $q-1$ 求和：\n$$\n\\chi(n) \\;=\\; \\frac{\\tau(\\chi)}{q} \\sum_{k=1}^{q-1} \\bar{\\chi}(-k) \\exp\\left(\\frac{2\\pi i nk}{q}\\right).\n$$\n将此展开式代入 $S(M,N)$ 的定义中：\n$$\nS(M,N) \\;=\\; \\sum_{n=M+1}^{M+N} \\left( \\frac{\\tau(\\chi)}{q} \\sum_{k=1}^{q-1} \\bar{\\chi}(-k) \\exp\\left(\\frac{2\\pi i nk}{q}\\right) \\right).\n$$\n我们可以交换求和顺序，因为两个和都是有限的：\n$$\nS(M,N) \\;=\\; \\frac{\\tau(\\chi)}{q} \\sum_{k=1}^{q-1} \\bar{\\chi}(-k) \\left( \\sum_{n=M+1}^{M+N} \\exp\\left(\\frac{2\\pi i nk}{q}\\right) \\right).\n$$\n为了找到一个界，我们取绝对值并应用三角不等式：\n$$\n|S(M,N)| \\;\\leq\\; \\left| \\frac{\\tau(\\chi)}{q} \\right| \\sum_{k=1}^{q-1} \\left| \\bar{\\chi}(-k) \\right| \\left| \\sum_{n=M+1}^{M+N} \\exp\\left(\\frac{2\\pi i nk}{q}\\right) \\right|.\n$$\n使用给定的恒等式 $|\\tau(\\chi)| = \\sqrt{q}$ 以及对于 $k \\in \\{1, \\dots, q-1\\}$ 有 $|\\bar{\\chi}(-k)|=1$ 这个事实：\n$$\n|S(M,N)| \\;\\leq\\; \\frac{\\sqrt{q}}{q} \\sum_{k=1}^{q-1} \\left| \\sum_{n=M+1}^{M+N} \\exp\\left(\\frac{2\\pi i nk}{q}\\right) \\right|.\n$$\n内层的和是一个几何级数。让我们分析它的大小。\n$$\n\\sum_{n=M+1}^{M+N} \\exp\\left(\\frac{2\\pi i nk}{q}\\right) \\;=\\; \\sum_{j=0}^{N-1} \\exp\\left(\\frac{2\\pi i (M+1+j)k}{q}\\right) \\;=\\; \\exp\\left(\\frac{2\\pi i (M+1)k}{q}\\right) \\sum_{j=0}^{N-1} \\left(\\exp\\left(\\frac{2\\pi i k}{q}\\right)\\right)^j.\n$$\n因为 $1 \\leq k \\leq q-1$，公比 $\\exp(2\\pi i k/q) \\neq 1$。该和的计算结果为：\n$$\n\\exp\\left(\\frac{2\\pi i (M+1)k}{q}\\right) \\frac{\\exp\\left(\\frac{2\\pi i Nk}{q}\\right) - 1}{\\exp\\left(\\frac{2\\pi i k}{q}\\right) - 1}.\n$$\n对 $M$ 的依赖性完全包含在首项因子 $\\exp\\left(\\frac{2\\pi i (M+1)k}{q}\\right)$ 中。当我们取绝对值时，这个因子的贡献是 $|\\exp\\left(\\frac{2\\pi i (M+1)k}{q}\\right)| = 1$。这就是为什么最终的界与 $M$ 无关。\n和的大小为：\n$$\n\\left| \\frac{\\exp\\left(\\frac{2\\pi i Nk}{q}\\right) - 1}{\\exp\\left(\\frac{2\\pi i k}{q}\\right) - 1} \\right| \\;=\\; \\frac{|\\exp(2\\pi i Nk/q) - 1|}{|\\exp(2\\pi i k/q) - 1|}.\n$$\n使用恒等式 $|\\exp(i\\theta) - 1| = |(\\cos\\theta-1) + i\\sin\\theta| = \\sqrt{(\\cos\\theta-1)^2+\\sin^2\\theta} = \\sqrt{2-2\\cos\\theta} = \\sqrt{4\\sin^2(\\theta/2)} = 2|\\sin(\\theta/2)|$，我们得到：\n$$\n\\frac{2|\\sin(\\pi Nk/q)|}{2|\\sin(\\pi k/q)|} \\;=\\; \\frac{|\\sin(\\pi Nk/q)|}{|\\sin(\\pi k/q)|}.\n$$\n将此代回我们关于 $|S(M,N)|$ 的不等式中：\n$$\n|S(M,N)| \\;\\leq\\; \\frac{1}{\\sqrt{q}} \\sum_{k=1}^{q-1} \\frac{|\\sin(\\pi N k / q)|}{|\\sin(\\pi k / q)|}.\n$$\n这就给出了显式界 $B(N,q)$，它只依赖于 $N$ 和 $q$：\n$$\nB(N,q) \\;=\\; \\frac{1}{\\sqrt{q}} \\sum_{k=1}^{q-1} \\frac{|\\sin(\\pi N k / q)|}{|\\sin(\\pi k / q)|}.\n$$\n现在，我们特化到 $q=5$ 和 $N=2$ 的情况。特征 $\\chi$ 是模 $5$ 的二次特征。界为：\n$$\nB(2,5) \\;=\\; \\frac{1}{\\sqrt{5}} \\sum_{k=1}^{4} \\frac{|\\sin(2\\pi k/5)|}{|\\sin(\\pi k/5)|}.\n$$\n使用倍角恒等式 $\\sin(2\\theta)=2\\sin\\theta\\cos\\theta$，和中的项得以简化。对于 $k \\in \\{1,2,3,4\\}$，有 $\\sin(\\pi k/5) > 0$。\n$$\n\\frac{|\\sin(2\\pi k/5)|}{|\\sin(\\pi k/5)|} \\;=\\; \\frac{|2\\sin(\\pi k/5)\\cos(\\pi k/5)|}{\\sin(\\pi k/5)} \\;=\\; 2|\\cos(\\pi k/5)|.\n$$\n所以界变为：\n$$\nB(2,5) \\;=\\; \\frac{1}{\\sqrt{5}} \\sum_{k=1}^{4} 2|\\cos(\\pi k/5)| \\;=\\; \\frac{2}{\\sqrt{5}} \\Big( |\\cos(\\pi/5)| + |\\cos(2\\pi/5)| + |\\cos(3\\pi/5)| + |\\cos(4\\pi/5)| \\Big).\n$$\n角 $\\pi/5$ 和 $2\\pi/5$ 在第一象限，所以它们的余弦值为正。角 $3\\pi/5$ 和 $4\\pi/5$ 在第二象限，它们的余弦值为负。因此：\n$|\\cos(3\\pi/5)| = -\\cos(3\\pi/5) = \\cos(\\pi-3\\pi/5) = \\cos(2\\pi/5)$。\n$|\\cos(4\\pi/5)| = -\\cos(4\\pi/5) = \\cos(\\pi-4\\pi/5) = \\cos(\\pi/5)$。\n和为：\n$$\n\\sum_{k=1}^{4} |\\cos(\\pi k/5)| \\;=\\; \\cos(\\pi/5) + \\cos(2\\pi/5) + \\cos(2\\pi/5) + \\cos(\\pi/5) \\;=\\; 2\\big(\\cos(\\pi/5) + \\cos(2\\pi/5)\\big).\n$$\n这些余弦的精确值可从正五边形的几何性质中得知：\n$$\n\\cos(\\pi/5) \\;=\\; \\cos(36^\\circ) \\;=\\; \\frac{1+\\sqrt{5}}{4}\n$$\n$$\n\\cos(2\\pi/5) \\;=\\; \\cos(72^\\circ) \\;=\\; \\frac{\\sqrt{5}-1}{4}\n$$\n它们的和是：\n$$\n\\cos(\\pi/5) + \\cos(2\\pi/5) \\;=\\; \\frac{1+\\sqrt{5}}{4} + \\frac{\\sqrt{5}-1}{4} \\;=\\; \\frac{2\\sqrt{5}}{4} \\;=\\; \\frac{\\sqrt{5}}{2}.\n$$\n将这个值代回 $B(2,5)$ 的表达式中。我们已经计算出和为 $\\sum_{k=1}^{4} |\\cos(\\pi k/5)| = 2(\\cos(\\pi/5) + \\cos(2\\pi/5)) = 2(\\frac{\\sqrt{5}}{2}) = \\sqrt{5}$。因此：\n$$ B(2,5) = \\frac{2}{\\sqrt{5}} \\sum_{k=1}^{4} |\\cos(\\pi k/5)| = \\frac{2}{\\sqrt{5}} \\cdot \\sqrt{5} = 2. $$\n因此，对于 $q=5$ 和 $N=2$ 的情况，显式界的值为 $2$。", "answer": "$$\\boxed{2}$$", "id": "3028925"}, {"introduction": "标准的波利亚-维诺格拉多夫不等式在其界限中使用了模 $q$。然而，一个更精确的结论表明，特征的*导子* $q_{\\chi}$ 才是控制其和的大小的真正参数。本练习通过一个数值实验 [@problem_id:3028932]，让你构建一个非本原特征，其模 $q$ 远大于其导子 $q_{\\chi}$。通过将特征和的最大值分别与基于模和基于导子的界限进行比较，你将亲眼见证导子为何是更本质的参数，这对于理解该不等式的现代应用至关重要。", "problem": "您将使用显式的 Dirichlet 特征，通过数值方法证明，在 Pólya–Vinogradov 不等式中，控制特征和大小的关键参数是导子 $q_{\\chi}$ 而非模 $q$。目标是提供一个 $q$ 很大但 $q_{\\chi}$ 很小的例子，并量化说明用 $\\sqrt{q_{\\chi}}\\log q_{\\chi}$ 或 $\\sqrt{q}\\log q$ 进行归一化会导致截然不同的尺度。\n\n将使用的基础知识：\n- 模 $q$ 的 Dirichlet 特征的定义：一个函数 $\\chi : \\mathbb{Z} \\to \\mathbb{C}$，以 $q$ 为周期，是完全积性的，并且在 $\\gcd(n,q) \\neq 1$ 时满足 $\\chi(n) = 0$。\n- 模 $q_{\\chi}$ 的本原特征：一个不能由 $q_{\\chi}$ 的任何真因子诱导而来的 Dirichlet 特征。\n- 模 $q$ 的非本原特征 $\\chi$ 的导子 $q_{\\chi}$：使得 $\\chi$ 是由一个模 $q_{\\chi}$ 的本原特征诱导而来的最小正整数 $q_{\\chi}$。\n- 特征的诱导：给定一个模 $q_{\\chi}$ 的本原特征 $\\chi^{\\ast}$ 和一个满足 $q_{\\chi} \\mid q$ 的模 $q$，定义模 $q$ 的非本原特征 $\\chi$ 为：若 $\\gcd(n,q) = 1$，则 $\\chi(n) = \\chi^{\\ast}(n)$；否则 $\\chi(n) = 0$。\n- 模奇素数 $p$ 的二次特征：对于 $n \\in \\mathbb{Z}$，Legendre 符号 $\\left(\\frac{n}{p}\\right)$ 的值如下：若 $p \\mid n$，则为 $0$；若 $n$ 是模 $p$ 的二次剩余，则为 $1$；否则为 $-1$；它是一个模 $p$ 的本原 Dirichlet 特征。\n\n任务说明：\n1. 对每个给定的测试用例 $(q_{\\chi}, q, N_{\\max})$，通过从模 $q_{\\chi}$（一个奇素数）的本原二次特征诱导，构造模 $q$ 的非本原 Dirichlet 特征 $\\chi$。具体来说，取 $\\chi^{\\ast}(n) = \\left(\\frac{n}{q_{\\chi}}\\right)$ 并按如下方式定义模 $q$ 的 $\\chi(n)$：\n   - 若 $\\gcd(n,q) = 1$，则 $\\chi(n) = \\chi^{\\ast}(n)$，\n   - 若 $\\gcd(n,q) \\neq 1$，则 $\\chi(n) = 0$。\n2. 对每个测试用例，计算累积和\n   $$S(N) = \\sum_{n=1}^{N} \\chi(n) \\quad \\text{for} \\quad 1 \\leq N \\leq N_{\\max},$$\n   以及初始段和的最大幅值\n   $$S_{\\max} = \\max_{1 \\leq N \\leq N_{\\max}} \\left|S(N)\\right|.$$\n3. 对每个测试用例，使用自然对数计算两个归一化量：\n   - 导子缩放值\n     $$R_{\\mathrm{cond}} = \\frac{S_{\\max}}{\\sqrt{q_{\\chi}} \\,\\log(q_{\\chi})}.$$\n   - 模缩放值\n     $$R_{\\mathrm{mod}} = \\frac{S_{\\max}}{\\sqrt{q} \\,\\log(q)}.$$\n   这两个数旨在说明，当 $q$ 很大但 $q_{\\chi}$ 很小时，与 $q_{\\chi}$ 的缩放如何捕捉了本质行为，而与 $q$ 的缩放可能产生误导。\n\n实现细节：\n- 使用 Euler 判别法计算模 $q_{\\chi}$ 的二次特征：对于不能被 $q_{\\chi}$ 整除的 $n$，\n  $$\\left(\\frac{n}{q_{\\chi}}\\right) \\equiv n^{\\frac{q_{\\chi}-1}{2}} \\pmod{q_{\\chi}},$$\n  将余数 $1$ 映射为 $1$，余数 $q_{\\chi}-1$ 映射为 $-1$，并在 $q_{\\chi} \\mid n$ 时将值设为 $0$。\n- 对 $\\log(\\cdot)$ 使用自然对数。\n- 在计算模 $q$ 的 $\\chi(n)$ 时，如果 $\\gcd(n,q) \\neq 1$，则强制 $\\chi(n) = 0$；否则取模 $q_{\\chi}$ 的 Legendre 符号值。\n\n测试套件：\n- 用例 1：$(q_{\\chi}, q, N_{\\max}) = (\\,13,\\, 13 \\cdot 99991,\\, 200000\\,)$\n- 用例 2：$(q_{\\chi}, q, N_{\\max}) = (\\,13,\\, 13,\\, 200000\\,)$\n- 用例 3：$(q_{\\chi}, q, N_{\\max}) = (\\,101,\\, 101 \\cdot 99991,\\, 200000\\,)$\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含三个测试用例的结果，格式为一个由方括号括起来的逗号分隔列表，其中每一项本身都是一个双元素列表 $[R_{\\mathrm{cond}}, R_{\\mathrm{mod}}]$，两个条目都打印为十进制浮点数。例如：\n  $$\\texttt{[[r1\\_cond,r1\\_mod],[r2\\_cond,r2\\_mod],[r3\\_cond,r3\\_mod]]}$$\n不涉及角度或物理单位，所有对数必须是自然对数。", "solution": "问题陈述是有效的。它在科学上基于 Dirichlet 特征理论和 Pólya–Vinogradov 不等式，问题定义良好、客观且计算上可行。\n\n需要证明的核心原理是：对于一个由模 $q_{\\chi}$ 的本原特征 $\\chi^{\\ast}$ 诱导的模 $q$ 的 Dirichlet 特征 $\\chi$，其特征和 $\\sum \\chi(n)$ 的大小由其导子 $q_{\\chi}$ 控制，而不是由模 $q$ 控制。Pólya-Vinogradov 不等式为特征和提供了一个经典界。对于一个模 $q$ 的非主特征 $\\chi$，该不等式表明存在一个常数 $C$ 使得\n$$\n\\max_{N \\geq 1} \\left| \\sum_{n=1}^{N} \\chi(n) \\right| \\leq C \\sqrt{q} \\log q.\n$$\n然而，如果 $\\chi$ 是一个由其导子 $q_{\\chi}  q$ 上的本原特征 $\\chi^{\\ast}$ 诱导的非本原特征，一个更紧的界成立，其中的依赖关系在于 $q_{\\chi}$ 而非 $q$：\n$$\n\\max_{N \\geq 1} \\left| \\sum_{n=1}^{N} \\chi(n) \\right| = \\mathcal{O}(\\sqrt{q_{\\chi}} \\log q_{\\chi}).\n$$\n这个数值任务旨在明确地说明这一原理。我们得到的测试用例中，模 $q$ 远大于导子 $q_{\\chi}$。通过比较最大特征和幅值 $S_{\\max}$ 分别用 $\\sqrt{q_{\\chi}}\\log q_{\\chi}$ 和 $\\sqrt{q}\\log q$ 进行缩放后的结果，我们可以量化这种效应。\n\n步骤如下：\n$1$. 构造特征 $\\chi$。对每个测试用例，我们给定一个作为奇素数的导子 $q_{\\chi}$，一个作为 $q_{\\chi}$ 倍数的模 $q$，以及求和上限 $N_{\\max}$。模 $q_{\\chi}$ 的本原特征 $\\chi^{\\ast}$ 是 Legendre 符号，即 $\\chi^{\\ast}(n) = \\left(\\frac{n}{q_{\\chi}}\\right)$。然后从 $\\chi^{\\ast}$ 诱导模 $q$ 的特征 $\\chi$：\n$$\n\\chi(n) = \\begin{cases} \\chi^{\\ast}(n)  \\text{if } \\gcd(n,q) = 1 \\\\ 0  \\text{if } \\gcd(n,q) \\neq 1 \\end{cases}\n$$\n\n$2$. 计算最大和幅值 $S_{\\max}$。我们遍历从 $1$ 到 $N_{\\max}$ 的整数 $n$。在每一步中，我们首先计算 $\\chi(n)$。其中的一个关键部分是检验条件 $\\gcd(n,q)=1$。如果该条件成立，我们使用 Euler 判别法计算 Legendre 符号 $\\left(\\frac{n}{q_{\\chi}}\\right)$：\n$$\n\\left(\\frac{n}{q_{\\chi}}\\right) \\equiv n^{(q_{\\chi}-1)/2} \\pmod{q_{\\chi}}.\n$$\n模幂运算的结果是 $1$ 或 $q_{\\chi}-1$（因为 $\\gcd(n,q_{\\chi})=1$）。我们将这些余数分别映射到值 $1$ 和 $-1$。如果 $\\gcd(n,q) \\neq 1$，则 $\\chi(n)$ 就是 $0$。然后我们更新累积和 $S(N) = \\sum_{n=1}^{N} \\chi(n)$ 并跟踪观察到的最大幅值 $S_{\\max} = \\max_{1 \\leq N \\leq N_{\\max}} |S(N)|$。\n\n$3$. 归一化 $S_{\\max}$。计算出 $S_{\\max}$ 后，我们计算两个归一化量：\n   - 导子缩放值，$R_{\\mathrm{cond}} = \\frac{S_{\\max}}{\\sqrt{q_{\\chi}} \\log(q_{\\chi})}$。\n   - 模缩放值，$R_{\\mathrm{mod}} = \\frac{S_{\\max}}{\\sqrt{q} \\log(q)}$。\n\n预期的结果是，对于一个固定的导子 $q_{\\chi}$，无论 $q$ 有多大，$R_{\\mathrm{cond}}$ 的值都将处于相当的量级。相比之下，当 $q$ 远大于 $q_{\\chi}$ 时，$R_{\\mathrm{mod}}$ 会变得非常小，因为分母 $\\sqrt{q}\\log q$ 错误地暗示了特征和的尺度比实际情况大得多。选择这些测试用例是为了清晰地展示这种区别：一个用例中 $q = q_{\\chi}$，用于建立基线，而其他用例中 $q \\gg q_{\\chi}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef calculate_metrics(q_chi: int, q: int, N_max: int):\n    \"\"\"\n    Calculates the maximal character sum and normalized quantities for a given character.\n\n    Args:\n        q_chi: The conductor of the primitive character (an odd prime).\n        q: The modulus of the induced character.\n        N_max: The maximum length of the initial-segment sum.\n\n    Returns:\n        A list containing [R_cond, R_mod].\n    \"\"\"\n    current_sum = 0.0\n    max_sum_magnitude = 0.0\n\n    # Pre-calculate the exponent for Euler's criterion to find the Legendre symbol.\n    exponent = (q_chi - 1) // 2\n\n    # Iterate from n = 1 to N_max to compute cumulative sums.\n    for n in range(1, N_max + 1):\n        chi_n = 0.0\n        \n        # The character chi(n) is non-zero only if gcd(n, q) = 1.\n        if math.gcd(n, q) == 1:\n            # If gcd(n, q) == 1, then gcd(n, q_chi) == 1 since q_chi divides q.\n            # We can use Euler's criterion to compute the Legendre symbol (n/q_chi).\n            legendre = pow(n, exponent, q_chi)\n            \n            if legendre == 1:\n                chi_n = 1.0\n            else:\n                # For a prime modulus, if the result is not 1, it must be -1 (mod q_chi),\n                # which corresponds to the residue q_chi - 1.\n                chi_n = -1.0\n        \n        current_sum += chi_n\n        \n        # Update the maximum magnitude of the sum found so far.\n        current_sum_abs = abs(current_sum)\n        if current_sum_abs > max_sum_magnitude:\n            max_sum_magnitude = current_sum_abs\n\n    S_max = max_sum_magnitude\n\n    # Compute the conductor-scaled value using natural logarithm.\n    R_cond = S_max / (np.sqrt(q_chi) * np.log(q_chi))\n    \n    # Compute the modulus-scaled value using natural logarithm.\n    R_mod = S_max / (np.sqrt(q) * np.log(q))\n    \n    return [R_cond, R_mod]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (q_chi, q, N_max)\n        (13, 13 * 99991, 200000),\n        (13, 13, 200000),\n        (101, 101 * 99991, 200000)\n    ]\n\n    results = []\n    for q_chi, q, N_max in test_cases:\n        result = calculate_metrics(q_chi, q, N_max)\n        results.append(result)\n\n    # Format the final output string as per the requirement:\n    # [[r1_cond,r1_mod],[r2_cond,r2_mod],[r3_cond,r3_mod]]\n    result_str_parts = []\n    for res_pair in results:\n        result_str_parts.append(f\"[{res_pair[0]},{res_pair[1]}]\")\n    \n    final_str = f\"[{','.join(result_str_parts)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_str)\n\nsolve()\n```", "id": "3028932"}]}