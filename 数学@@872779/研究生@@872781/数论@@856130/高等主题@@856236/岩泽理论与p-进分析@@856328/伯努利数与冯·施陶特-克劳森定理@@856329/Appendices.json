{"hands_on_practices": [{"introduction": "伯努利数的一个最重要和最古典的应用是为整数次幂的和（即 $1^k + 2^k + \\dots + N^k$）提供一个封闭形式的表达式，这被称为福尔哈伯公式（Faulhaber's formula）。本练习将引导你从伯努利多项式的生成函数出发，亲手推导这个公式，从而加深对伯努利数、伯努利多项式以及幂和之间深刻联系的理解。通过完成这个练习 [@problem_id:3009007]，你将掌握一个强大的分析工具。", "problem": "设 $\\{B_{n}\\}_{n\\geq 0}$ 表示由指数生成函数 $ \\frac{t}{\\exp(t)-1}=\\sum_{n=0}^{\\infty} B_{n}\\,\\frac{t^{n}}{n!}$ 定义的伯努利数，并约定 $B_{1}=-\\frac{1}{2}$。设 $B_{n}(x)$ 表示由指数生成函数 $\\frac{t\\,\\exp(x t)}{\\exp(t)-1}=\\sum_{n=0}^{\\infty} B_{n}(x)\\,\\frac{t^{n}}{n!}$ 定义的伯努利多项式。从这些定义出发，且不使用任何其他现成的求和公式，推导有限和 $\\sum_{k=1}^{N} k^{5}$ 关于 $N$ 的有理多项式形式的封闭表达式。你的推导应遵循第一性原理：利用伯努利多项式生成函数所蕴含的基本性质，将 $\\sum_{k=1}^{N} k^{5}$ 与在 $N+1$ 和 $0$ 处求值的伯努利多项式之差联系起来，然后仅使用实际出现的伯努利数 $B_{n}$ 进行化简。作为对 $B_{2}$、$B_{4}$ 和 $B_{6}$ 中间值的结构性检验，请使用 von Staudt–Clausen 定理来证明其分母的合理性。最后，通过对 $N$ 进行完整归纳来验证你的封闭形式的正确性，证明连续值之间的差可重现 $(N+1)^{5}$。\n\n以 $N$ 的单个简化精确代数表达式形式提供最终结果。不要四舍五入。不要提供单位。", "solution": "问题要求从伯努利多项式的性质推导和 $\\sum_{k=1}^{N} k^{5}$ 的封闭表达式，并包含中间和最终的验证步骤。\n\n首先，我们验证问题陈述。\n**步骤1：提取已知条件**\n- 伯努利数 $\\{B_{n}\\}_{n\\geq 0}$ 由指数生成函数 $ \\frac{t}{\\exp(t)-1}=\\sum_{n=0}^{\\infty} B_{n}\\,\\frac{t^{n}}{n!}$ 定义。\n- 约定：$B_{1}=-\\frac{1}{2}$。\n- 伯努利多项式 $B_{n}(x)$ 由指数生成函数 $\\frac{t\\,\\exp(x t)}{\\exp(t)-1}=\\sum_{n=0}^{\\infty} B_{n}(x)\\,\\frac{t^{n}}{n!}$ 定义。\n- 任务：推导 $\\sum_{k=1}^{N} k^{5}$ 关于 $N$ 的有理多项式形式的封闭表达式。\n- 方法：利用伯努利多项式生成函数所蕴含的性质，将该和与伯努利多项式的差值联系起来。\n- 中间检验：使用 von Staudt-Clausen 定理证明 $B_2$、$B_4$ 和 $B_6$ 的分母的合理性。\n- 最终验证：通过对 $N$ 进行归纳证明所得公式的正确性。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法明确且客观。这是数论中一个关于 Faulhaber 公式的标准问题。所提供的定义是标准的，包括对 $B_1$ 的明确约定。要求的步骤构成了一条完整且逻辑清晰的路径，通往一个唯一、可验证的解。该问题不违反任何无效性标准。\n\n**步骤3：结论与行动**\n问题有效。我们继续进行求解。\n\n**求和公式的推导**\n\n该方法的核心在于伯努利多项式的一个差分公式。我们从其生成函数推导该公式：\n$$ \\sum_{n=0}^{\\infty} [B_{n}(x+1) - B_{n}(x)]\\,\\frac{t^{n}}{n!} = \\frac{t\\,\\exp((x+1)t)}{\\exp(t)-1} - \\frac{t\\,\\exp(xt)}{\\exp(t)-1} $$\n$$ = \\frac{t\\,\\exp(xt)(\\exp(t)-1)}{\\exp(t)-1} = t\\,\\exp(xt) $$\n$t\\,\\exp(xt)$ 的泰勒级数为：\n$$ t\\,\\exp(xt) = t \\sum_{j=0}^{\\infty} \\frac{(xt)^{j}}{j!} = \\sum_{j=0}^{\\infty} \\frac{x^{j}t^{j+1}}{j!} $$\n令 $n=j+1$，则 $j=n-1$。和变为：\n$$ \\sum_{n=1}^{\\infty} \\frac{x^{n-1}t^{n}}{(n-1)!} = \\sum_{n=1}^{\\infty} n x^{n-1} \\frac{t^{n}}{n!} $$\n通过比较两个级数中 $\\frac{t^n}{n!}$ 的系数，我们得到恒等式：\n$$ B_{n}(x+1) - B_{n}(x) = n x^{n-1} \\quad \\text{对于 } n \\geq 1 $$\n对于五次幂求和的特定情况，我们关心的是 $p=5$。我们设 $n=p+1=6$：\n$$ B_{6}(x+1) - B_{6}(x) = 6x^{5} $$\n我们将此恒等式对 $x$ 从 $k=0$ 到 $N$ 的整数值求和：\n$$ \\sum_{k=0}^{N} [B_{6}(k+1) - B_{6}(k)] = \\sum_{k=0}^{N} 6k^{5} = 6 \\sum_{k=0}^{N} k^{5} $$\n左边是一个裂项求和：\n$$ (B_6(1) - B_6(0)) + (B_6(2) - B_6(1)) + \\dots + (B_6(N+1) - B_6(N)) = B_6(N+1) - B_6(0) $$\n因此，我们有：\n$$ 6 \\sum_{k=0}^{N} k^{5} = B_{6}(N+1) - B_{6}(0) $$\n由于 $0^5=0$，从 $k=1$ 到 $N$ 的和与从 $k=0$ 到 $N$ 的和相同。因此，所求的和为：\n$$ \\sum_{k=1}^{N} k^{5} = \\frac{1}{6} [B_{6}(N+1) - B_{6}(0)] $$\n\n**伯努利数的计算**\n\n为了计算该表达式，我们需要 $k \\le 6$ 的伯努利数 $B_k$。我们可以从定义 $\\frac{t}{\\exp(t)-1} = \\sum_{n=0}^{\\infty} B_n \\frac{t^n}{n!}$ 推导出递推关系。两边乘以 $\\exp(t)-1$ 得到 $t = (\\sum_{j=1}^{\\infty} \\frac{t^j}{j!})(\\sum_{k=0}^{\\infty} B_k \\frac{t^k}{k!})$。对于 $n \\ge 2$，左边 $t^n$ 的系数为 $0$。右边为 $\\sum_{k=0}^{n-1} \\frac{1}{(n-k)!} \\frac{B_k}{k!}$。令两边相等并乘以 $n!$ 得到递推关系 $\\sum_{k=0}^{n-1} \\binom{n}{k}B_k = 0$（对于 $n \\ge 2$）。\n从定义可知 $B_0=1$。问题陈述了约定 $B_1 = -1/2$。\n- 对于 $n=3$：$\\binom{3}{0}B_0 + \\binom{3}{1}B_1 + \\binom{3}{2}B_2 = 0 \\implies 1(1) + 3(-1/2) + 3B_2 = 0 \\implies -1/2 + 3B_2 = 0 \\implies B_2 = 1/6$。\n- 函数 $\\frac{t}{\\exp(t)-1} - B_1 t = \\frac{t}{\\exp(t)-1} + \\frac{t}{2}$ 是一个偶函数，这意味着对于所有奇数 $n \\ge 3$，$B_n=0$。因此 $B_3=0$ 且 $B_5=0$。\n- 对于 $n=5$：$\\binom{5}{0}B_0 + \\binom{5}{1}B_1 + \\binom{5}{2}B_2 + \\binom{5}{3}B_3 + \\binom{5}{4}B_4 = 0 \\implies 1(1) + 5(-1/2) + 10(1/6) + 10(0) + 5B_4 = 0 \\implies 1 - 5/2 + 5/3 + 5B_4 = 0 \\implies 1/6 + 5B_4 = 0 \\implies B_4 = -1/30$。\n- 对于 $n=7$：$\\sum_{k=0}^6 \\binom{7}{k}B_k=0$。使用 $B_3=B_5=0$，我们有 $\\binom{7}{0}B_0 + \\binom{7}{1}B_1 + \\binom{7}{2}B_2 + \\binom{7}{4}B_4 + \\binom{7}{6}B_6 = 0$。\n$1(1) + 7(-1/2) + 21(1/6) + 35(-1/30) + 7B_6 = 0 \\implies 1 - 7/2 + 7/2 - 7/6 + 7B_6 = 0 \\implies -1/6 + 7B_6 = 0 \\implies B_6 = 1/42$。\n\n所需的伯努利数为：$B_0=1$, $B_1=-1/2$, $B_2=1/6$, $B_3=0$, $B_4=-1/30$, $B_5=0$, $B_6=1/42$。\n\n**使用 von Staudt-Clausen 定理进行分母检验**\n\nvon Staudt-Clausen 定理指出，对于 $m \\ge 1$，伯努利数 $B_{2m}$ 的分母是所有满足 $p-1$ 整除 $2m$ 的素数 $p$ 的乘积。\n- 对于 $B_2$ ($2m=2$)：素数 $p$ 满足 $(p-1)|2$。$p-1 \\in \\{1,2\\} \\implies p \\in \\{2,3\\}$。分母为 $2 \\times 3=6$。$B_2=1/6$。这是正确的。\n- 对于 $B_4$ ($2m=4$)：素数 $p$ 满足 $(p-1)|4$。$p-1 \\in \\{1,2,4\\} \\implies p \\in \\{2,3,5\\}$。分母为 $2 \\times 3 \\times 5=30$。$B_4=-1/30$。这是正确的。\n- 对于 $B_6$ ($2m=6$)：素数 $p$ 满足 $(p-1)|6$。$p-1 \\in \\{1,2,3,6\\} \\implies p \\in \\{2,3,7\\}$。分母为 $2 \\times 3 \\times 7=42$。$B_6=1/42$。这是正确的。\n\n**求和的最终表达式**\n\n伯努利多项式 $B_n(x)$ 由 $B_n(x) = \\sum_{k=0}^n \\binom{n}{k} B_k x^{n-k}$ 给出。对于 $n=6$：\n$$ B_6(x) = \\binom{6}{0}B_0 x^6 + \\binom{6}{1}B_1 x^5 + \\binom{6}{2}B_2 x^4 + \\binom{6}{3}B_3 x^3 + \\binom{6}{4}B_4 x^2 + \\binom{6}{5}B_5 x + \\binom{6}{6}B_6 $$\n$$ B_6(x) = 1(1)x^6 + 6(-1/2)x^5 + 15(1/6)x^4 + 20(0)x^3 + 15(-1/30)x^2 + 6(0)x + 1(1/42) $$\n$$ B_6(x) = x^6 - 3x^5 + \\frac{5}{2}x^4 - \\frac{1}{2}x^2 + \\frac{1}{42} $$\n我们需要计算 $\\frac{1}{6}[B_6(N+1) - B_6(0)]$。\n$B_6(0) = B_6 = 1/42$。\n$$ B_6(N+1) - B_6(0) = \\left((N+1)^6 - 3(N+1)^5 + \\frac{5}{2}(N+1)^4 - \\frac{1}{2}(N+1)^2 + \\frac{1}{42}\\right) - \\frac{1}{42} $$\n$$ = (N+1)^6 - 3(N+1)^5 + \\frac{5}{2}(N+1)^4 - \\frac{1}{2}(N+1)^2 $$\n展开这些项：\n$$ (N+1)^6 = N^6 + 6N^5 + 15N^4 + 20N^3 + 15N^2 + 6N + 1 $$\n$$ -3(N+1)^5 = -3(N^5 + 5N^4 + 10N^3 + 10N^2 + 5N + 1) = -3N^5 - 15N^4 - 30N^3 - 30N^2 - 15N - 3 $$\n$$ \\frac{5}{2}(N+1)^4 = \\frac{5}{2}(N^4 + 4N^3 + 6N^2 + 4N + 1) = \\frac{5}{2}N^4 + 10N^3 + 15N^2 + 10N + \\frac{5}{2} $$\n$$ -\\frac{1}{2}(N+1)^2 = -\\frac{1}{2}(N^2 + 2N + 1) = -\\frac{1}{2}N^2 - N - \\frac{1}{2} $$\n将这些多项式相加：\n$$ N^6 + (6-3)N^5 + (15-15+5/2)N^4 + (20-30+10)N^3 + (15-30+15-1/2)N^2 + (6-15+10-1)N + (1-3+5/2-1/2) $$\n$$ = N^6 + 3N^5 + \\frac{5}{2}N^4 + 0 \\cdot N^3 - \\frac{1}{2}N^2 + 0 \\cdot N + 0 = N^6 + 3N^5 + \\frac{5}{2}N^4 - \\frac{1}{2}N^2 $$\n因此，和为：\n$$ \\sum_{k=1}^{N} k^{5} = \\frac{1}{6}\\left(N^6 + 3N^5 + \\frac{5}{2}N^4 - \\frac{1}{2}N^2\\right) $$\n$$ = \\frac{1}{6}N^6 + \\frac{1}{2}N^5 + \\frac{5}{12}N^4 - \\frac{1}{12}N^2 = \\frac{2N^6 + 6N^5 + 5N^4 - N^2}{12} $$\n\n**通过归纳法验证**\n\n设 $S_5(N) = \\frac{2N^6 + 6N^5 + 5N^4 - N^2}{12}$。\n**基础情形 ($N=1$):**\n$\\sum_{k=1}^1 k^5 = 1^5 = 1$。\n$S_5(1) = \\frac{2(1)^6 + 6(1)^5 + 5(1)^4 - (1)^2}{12} = \\frac{2+6+5-1}{12} = \\frac{12}{12} = 1$。基础情形成立。\n\n**归纳步骤：**\n假设对于某个整数 $N \\ge 1$，$S_5(N) = \\sum_{k=1}^N k^5$ 成立。我们必须证明 $S_5(N+1) = \\sum_{k=1}^{N+1} k^5$。\n这等价于证明 $S_5(N+1) - S_5(N) = (N+1)^5$。\n我们来计算差值 $S_5(N+1) - S_5(N)$：\n$$ \\frac{2}{12}((N+1)^6 - N^6) + \\frac{6}{12}((N+1)^5 - N^5) + \\frac{5}{12}((N+1)^4 - N^4) - \\frac{1}{12}((N+1)^2 - N^2) $$\n使用二项式展开的差值：\n$$ (N+1)^6 - N^6 = 6N^5 + 15N^4 + 20N^3 + 15N^2 + 6N + 1 $$\n$$ (N+1)^5 - N^5 = 5N^4 + 10N^3 + 10N^2 + 5N + 1 $$\n$$ (N+1)^4 - N^4 = 4N^3 + 6N^2 + 4N + 1 $$\n$$ (N+1)^2 - N^2 = 2N + 1 $$\n将这些代入差值表达式，并按 $N$ 的幂次对各项进行分组：\n$$ N^5 \\text{ 项：} \\frac{2}{12}(6N^5) = N^5 $$\n$$ N^4 \\text{ 项：} \\frac{2}{12}(15N^4) + \\frac{6}{12}(5N^4) = \\frac{30+30}{12}N^4 = 5N^4 $$\n$$ N^3 \\text{ 项：} \\frac{2}{12}(20N^3) + \\frac{6}{12}(10N^3) + \\frac{5}{12}(4N^3) = \\frac{40+60+20}{12}N^3 = 10N^3 $$\n$$ N^2 \\text{ 项：} \\frac{2}{12}(15N^2) + \\frac{6}{12}(10N^2) + \\frac{5}{12}(6N^2) = \\frac{30+60+30}{12}N^2 = 10N^2 $$\n$$ N^1 \\text{ 项：} \\frac{2}{12}(6N) + \\frac{6}{12}(5N) + \\frac{5}{12}(4N) - \\frac{1}{12}(2N) = \\frac{12+30+20-2}{12}N = 5N $$\n$$ \\text{常数项：} \\frac{2}{12}(1) + \\frac{6}{12}(1) + \\frac{5}{12}(1) - \\frac{1}{12}(1) = \\frac{2+6+5-1}{12} = 1 $$\n将这些项相加，我们得到 $S_5(N+1) - S_5(N) = N^5 + 5N^4 + 10N^3 + 10N^2 + 5N + 1$，这正是 $(N+1)^5$ 的二项式展开。\n归纳步骤得证。因此，所推导的公式对所有整数 $N \\geq 1$ 均正确。\n最终表达式就是我们推导出的关于 $N$ 的有理多项式。", "answer": "$$ \\boxed{ \\frac{2N^6 + 6N^5 + 5N^4 - N^2}{12} } $$", "id": "3009007"}, {"introduction": "在看到伯努利数的一个重要应用之后，我们现在转向探究伯努利数本身的内在结构。本练习将引导你完成冯·施陶特-克劳森定理的一个证明梗概，揭示伯努利数的分母与素数之间惊人的联系。通过在一个素数的模下，用两种不同的方法计算一个幂和，你将亲手揭示该定理背后的核心机制 [@problem_id:3009011]。", "problem": "设 $\\{B_{n}\\}_{n\\geq 0}$ 是由指数生成函数定义的伯努利数\n$$\\frac{x}{\\exp(x)-1}=\\sum_{n=0}^{\\infty} B_{n}\\,\\frac{x^{n}}{n!}.$$\n仅使用此定义以及一个基础事实，即模素数 $p$ 的整数乘法群（记为 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$）是阶为 $p-1$ 的循环群，通过比较和 $\\sum_{a=1}^{p-1} a^{n}$ 的两种求值方法，来分析对于偶数 $n\\geq 2$，$B_{n}$ 中可能出现的有理数部分的行为：一种来自群结构，另一种来自通过有限幂和关系由伯努利数给出的多项式表达式。解释为什么任何满足 $p-1\\mid n$ 的素数 $p$ 都会对 $B_{n}$ 的分数部分贡献一个形如 $\\frac{1}{p}$ 的项，以及为什么 $p$ 的更高次幂不会出现在分母中。然后，通过列出所有满足 $p-1\\mid 30$ 的素数 $p$ 并验证每个素数的幂次为1，来计算 $B_{30}$ 的分母。以最简形式的单个整数形式给出 $B_{30}$ 的分母。无需四舍五入。", "solution": "用户希望我先验证问题，然后提供一个完整的解答。\n\n### 第一步：提取已知条件\n-   伯努利数 $\\{B_{n}\\}_{n\\geq 0}$ 由指数生成函数定义：$\\frac{x}{\\exp(x)-1}=\\sum_{n=0}^{\\infty} B_{n}\\,\\frac{x^{n}}{n!}$。\n-   对于一个素数 $p$，模 $p$ 的整数乘法群，记为 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$，是阶为 $p-1$ 的循环群。\n-   任务是通过比较对和 $\\sum_{a=1}^{p-1} a^{n}$ 的两种求值方法，来分析偶数 $n \\ge 2$ 时 $B_n$ 的有理数部分。\n-   第一种求值方法基于群结构。\n-   第二种求值方法基于涉及伯努利数的有限幂和的多项式表达式。\n-   目标是解释为什么任何满足 $p-1\\mid n$ 的素数 $p$ 都会对 $B_{n}$ 的分数部分贡献一个形如 $\\frac{1}{p}$ 的项，以及为什么 $p$ 的更高次幂不会出现在分母中。\n-   最后的任务是通过列出所有满足 $p-1\\mid 30$ 的素数 $p$ 并以单个整数形式给出结果，来计算 $B_{30}$ 的分母。\n\n### 第二步：使用提取的已知条件进行验证\n-   **科学基础：** 该问题牢固地植根于经典数论。伯努利数的定义、$(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 的结构以及伯努利数与幂和（Faulhaber 公式）之间的联系都是标准且完善的数学概念。问题的核心是推导 von Staudt-Clausen 定理，这是关于伯努利数分母的一个基本结果。该问题在数学上是合理的。\n-   **适定性：** 该问题为推导提供了清晰而具体的路径。它要求一个明确的结果：对伯努利数性质的解释以及一个特定分母的计算。存在唯一且有意义的解。\n-   **客观性：** 该问题以精确、形式化的数学语言陈述，没有任何主观性或歧义。\n-   **完整性：** 该问题提供了进行所需分析的所有必要定义和前提。\n-   **结论：** 该问题是有效的。它是一个定义明确、有科学依据的数论问题。\n\n### 第三步：结论与行动\n该问题是有效的。我将继续进行解答。\n\n###\n该问题要求我们通过比较对幂和 $S_n(p-1) = \\sum_{a=1}^{p-1} a^n$ 在模素数 $p$ 下的两种不同求值方法，来推导 von Staudt-Clausen 定理的核心内容，然后应用此结果求出 $B_{30}$ 的分母。该论证通过对 $n$ 进行归纳来进行。\n\n设 $n \\ge 2$ 为一个偶数。归纳假设是，对于任何满足 $2 \\le m  n$ 的偶数 $m$，$B_m$ 的分母是无平方因子的，并且素数 $q$ 整除 $B_m$ 的分母当且仅当 $q-1$ 整除 $m$。这等价于陈述对于任何素数 $q$，$q$-进赋值 $v_q(B_m)$ 满足：\n如果 $q-1 \\mid m$，则 $v_q(B_m) = -1$。\n如果 $q-1 \\nmid m$，则 $v_q(B_m) \\ge 0$。\n可以验证基本情况，如 $B_2 = \\frac{1}{6}$，$B_4 = -\\frac{1}{30}$，$B_6 = \\frac{1}{42}$，满足此假设。\n\n我们现在对给定的素数 $p$ 分析 $B_n$。\n\n**第一部分：使用群论对 $\\sum_{a=1}^{p-1} a^n$ 求值**\n\n设 $S_n(p-1) = \\sum_{a=1}^{p-1} a^n$。我们考虑这个和模 $p$ 的值。集合 $\\{1, 2, \\dots, p-1\\}$ 构成了乘法群 $(\\mathbb{Z}/p\\mathbb{Z})^\\times$，这是一个阶为 $p-1$ 的循环群。\n\n情况1：$p-1 \\mid n$。\n由于 $n$ 是群阶的倍数，对于 $(\\mathbb{Z}/p\\mathbb{Z})^\\times$ 中的任何元素 $a$，Lagrange 定理意味着 $a^{p-1} \\equiv 1 \\pmod{p}$。因为 $n = k(p-1)$ 对于某个整数 $k \\ge 1$，我们有 $a^n = (a^{p-1})^k \\equiv 1^k \\equiv 1 \\pmod{p}$。\n和变为：\n$$S_n(p-1) = \\sum_{a=1}^{p-1} a^n \\equiv \\sum_{a=1}^{p-1} 1 \\equiv p-1 \\equiv -1 \\pmod{p}$$\n\n情况2：$p-1 \\nmid n$。\n设 $g$ 是循环群 $(\\mathbb{Z}/p\\mathbb{Z})^\\times$ 的一个生成元。集合 $\\{1, 2, \\dots, p-1\\}$ 中的元素与模 $p$ 下的 $\\{g^0, g^1, \\dots, g^{p-2}\\}$ 同余。\n该和是一个几何级数：\n$$S_n(p-1) = \\sum_{a=1}^{p-1} a^n \\equiv \\sum_{j=0}^{p-2} (g^j)^n = \\sum_{j=0}^{p-2} (g^n)^j \\pmod{p}$$\n由于 $g$ 是生成元且 $p-1 \\nmid n$，我们有 $g^n \\not\\equiv 1 \\pmod{p}$。因此，我们可以使用几何级数求和公式：\n$$S_n(p-1) \\equiv \\frac{(g^n)^{p-1} - 1}{g^n - 1} = \\frac{(g^{p-1})^n - 1}{g^n - 1} \\equiv \\frac{1^n - 1}{g^n - 1} \\equiv 0 \\pmod{p}$$\n\n总之，对于任何素数 $p$ 和偶数 $n \\ge 2$：\n$$S_n(p-1) = \\sum_{a=1}^{p-1} a^n \\equiv \\begin{cases} -1 \\pmod{p}  \\text{若 } p-1 \\mid n \\\\ 0 \\pmod{p}  \\text{若 } p-1 \\nmid n \\end{cases}$$\n\n**第二部分：使用 Faulhaber 公式对 $\\sum_{a=1}^{p-1} a^n$ 求值**\n\nFaulhaber 公式将幂和与伯努利数联系起来：\n$$\\sum_{a=0}^{N-1} a^n = \\frac{1}{n+1} \\sum_{k=0}^{n} \\binom{n+1}{k} B_k N^{n+1-k}$$\n设 $N=p$ 并注意对于 $n \\ge 2$ 有 $0^n=0$，我们得到：\n$$S_n(p-1) = \\sum_{a=1}^{p-1} a^n = \\frac{1}{n+1} \\sum_{k=0}^{n} \\binom{n+1}{k} B_k p^{n+1-k}$$\n两边乘以 $n+1$ 并分离出含 $B_n$ 的项（$k=n$）：\n$$(n+1) S_n(p-1) = \\binom{n+1}{n} B_n p + \\sum_{k=0}^{n-1} \\binom{n+1}{k} B_k p^{n+1-k}$$\n$$(n+1) S_n(p-1) = (n+1) p B_n + \\sum_{k=0}^{n-1} \\binom{n+1}{k} B_k p^{n+1-k}$$\n这是一个在有理数域 $\\mathbb{Q}$ 中的恒等式。让我们在 $p$-进整数环 $\\mathbb{Z}_p$ 中分析这个恒等式，它由分母不能被 $p$ 整除的有理数组成。同余式 $x \\equiv y \\pmod{p^k}$ 意味着 $p$-进赋值 $v_p(x-y) \\ge k$。\n\n设 $\\Sigma = \\sum_{k=0}^{n-1} \\binom{n+1}{k} B_k p^{n+1-k}$。我们检查 $\\Sigma$ 中每一项的 $p$-进赋值。对于 $k \\le n-1$，$p$ 的指数是 $n+1-k \\ge 2$。\n$k=1$ 的项是 $\\binom{n+1}{1} B_1 p^n = (n+1)(-\\frac{1}{2})p^n$ （因为从给定的生成函数可知 $B_1=-1/2$）。对于 $p \\neq 2$ 和 $n \\ge 2$，此项是 $p^2$ 的整数倍。如果 $p=2$，情况稍后处理。\n对于奇数 $k > 1$，$B_k=0$，所以这些项为零。\n对于偶数 $k$ 且 $0 \\le k  n$，我们对 $B_k$ 使用归纳假设。\n如果 $p-1 \\nmid k$，则 $v_p(B_k) \\ge 0$。$p$ 的指数是 $n+1-k \\ge 2$。因此，项 $\\binom{n+1}{k} B_k p^{n+1-k}$ 的 $p$-进赋值至少为 $2$。\n如果 $p-1 \\mid k$，则 $v_p(B_k) = -1$。该项的赋值为 $v_p(\\binom{n+1}{k}) - 1 + (n+1-k) = v_p(\\binom{n+1}{k}) + n-k$。由于对于下一个最小的偶数 $k \\le n-2$，$n-k \\ge 2$。所以赋值至少为 $2$。\n因此，$\\Sigma$ 中的每一项的 $p$-进赋值都至少为 $2$（对于 $p=2$ 需要特别注意，但结论仍然成立）。这意味着在 $p$-进意义下 $\\Sigma \\equiv 0 \\pmod{p^2}$。\n\n我们的恒等式变为：\n$$(n+1) S_n(p-1) \\equiv (n+1) p B_n \\pmod{p^2}$$\n\n**第三部分：结合结果**\n\n我们现在比较 $S_n(p-1)$ 的两个表达式。\n\n情况 A：$p-1 \\mid n$。\n从第一部分可知，$S_n(p-1) = -1 + c p$，其中 $c$ 是某个整数。\n将此代入我们的同余式：\n$$(n+1)(-1+cp) \\equiv (n+1)pB_n \\pmod{p^2}$$\n$$-(n+1) + (n+1)cp \\equiv (n+1)pB_n \\pmod{p^2}$$\n如果 $p \\nmid n+1$，我们可以除以 $n+1$：\n$$-1 + cp \\equiv pB_n \\pmod{p^2}$$\n这意味着 $-1 \\equiv pB_n \\pmod p$。用 $p$-进赋值的术语来说，这意味着 $v_p(pB_n + 1) \\ge 1$。由于 $v_p(1)=0$，这只在 $v_p(pB_n) = 0$ 时才成立。所以 $v_p(p) + v_p(B_n) = 0$，这给出 $1+v_p(B_n)=0$，即 $v_p(B_n)=-1$。\n如果 $p \\mid n+1$，则 $p-1 \\le n  n+1$。由于 $p-1|n$，我们必须有 $p-1 \\le n$。$n+1 \\equiv 0 \\pmod p$ 意味着 $n \\equiv -1 \\equiv p-1 \\pmod p$。所以 $p-1$ 必须是 $p$ 的倍数，这是不可能的。或者 $n = k(p-1)$，所以 $k(p-1) \\equiv -1 \\pmod p \\implies -k \\equiv -1 \\pmod p \\implies k \\equiv 1 \\pmod p$。条件 $p | n+1$ 意味着 $k(p-1)+1 \\equiv 0 \\pmod p \\implies -k+1 \\equiv 0 \\pmod p \\implies k \\equiv 1 \\pmod p$。逻辑仍然成立；同余式 $-(n+1) \\equiv (n+1)pB_n \\pmod{p^2}$ 意味着 $v_p(-(n+1)) = v_p((n+1)pB_n)$，所以 $v_p(n+1) = v_p(n+1)+1+v_p(B_n)$，这给出 $v_p(B_n)=-1$。\n\n在 $p-1 \\mid n$ 的所有子情况下，我们都有 $v_p(B_n)=-1$。这意味着 $p$ 在 $B_n$ 的分母中出现，且指数恰好为 1。\n\n情况 B：$p-1 \\nmid n$。\n从第一部分可知，$S_n(p-1) \\equiv 0 \\pmod p$，所以 $S_n(p-1) = dp$，其中 $d$ 是某个整数。\n$$(n+1)dp \\equiv (n+1)pB_n \\pmod{p^2}$$\n如果 $p \\nmid n+1$，我们可以除以 $p(n+1)$：\n$$d \\equiv B_n \\pmod p$$\n由于 $d$ 是一个整数，$B_n$ 与一个整数模 $p$ 同余，这意味着 $B_n$ 是一个 $p$-进整数，即 $v_p(B_n) \\ge 0$。\n如果 $p \\mid n+1$，同余式为 $(n+1)p d \\equiv (n+1)p B_n \\pmod{p^2}$，这对任何 $p$-进整数 $B_n$ 都成立。然而，回到 $(n+1)S_n = (n+1)pB_n + \\Sigma$，我们有 $v_p((n+1)S_n) \\ge v_p(n+1)+1$ 且 $v_p(\\Sigma) \\ge 2$。这意味着 $v_p((n+1)pB_n) \\ge \\min(v_p(n+1)+1, 2)$。因此 $v_p(n+1)+1+v_p(B_n) \\ge v_p(n+1)+1$，这意味着 $v_p(B_n) \\ge 0$。\n\n在 $p-1 \\nmid n$ 的所有子情况下，我们都有 $v_p(B_n) \\ge 0$。这意味着 $p$ 不会出现在 $B_n$ 的分母中。\n这完成了 von Staudt-Clausen 定理的归纳证明。\n\n**第四部分：$B_{30}$ 的分母**\n\n根据所推导的定理，对于偶数 $n \\ge 2$，$B_n$ 的分母是所有满足 $p-1$ 整除 $n$ 的素数 $p$ 的乘积。我们被要求求出 $B_{30}$ 的分母。这里，$n=30$。\n我们需要找到所有使得 $p-1$ 是 $30$ 的因子的素数 $p$。\n$30$ 的因子是 $1, 2, 3, 5, 6, 10, 15, 30$。\n我们对每个因子 $d$ 检查对应的 $p=d+1$ 的值：\n-   $d=1: p = 1+1 = 2$。$2$ 是素数。\n-   $d=2: p = 2+1 = 3$。$3$ 是素数。\n-   $d=3: p = 3+1 = 4$。$4$ 不是素数。\n-   $d=5: p = 5+1 = 6$。$6$ 不是素数。\n-   $d=6: p = 6+1 = 7$。$7$ 是素数。\n-   $d=10: p = 10+1 = 11$。$11$ 是素数。\n-   $d=15: p = 15+1 = 16$。$16$ 不是素数。\n-   $d=30: p = 30+1 = 31$。$31$ 是素数。\n\n素数集合为 $\\{2, 3, 7, 11, 31\\}$。\n$B_{30}$ 的分母是这些素数的乘积：\n$$\\text{分母} = 2 \\times 3 \\times 7 \\times 11 \\times 31$$\n$$= 6 \\times 7 \\times 11 \\times 31$$\n$$= 42 \\times 11 \\times 31$$\n$$= 462 \\times 31$$\n$$= 14322$$\n$B_{30}$ 的分母是 $14322$。", "answer": "$$\n\\boxed{14322}\n$$", "id": "3009011"}, {"introduction": "冯·施陶特-克劳森定理对于伯努利数在模算术中的行为有着深远的影响。本练习通过要求你在有限域中计算伯努利数，并分析为何对于特定下标的伯努利数无法进行模 $p$ 运算，来探讨 $p$-整性的概念。这个过程将阐明该定理如何精确地确定一个伯努利数何时能在模素数 $p$ 的意义下有良好定义 [@problem_id:3009016]。", "problem": "令 $B_n$ 表示伯努利数，其指数生成函数为 $x/(\\exp(x)-1)=\\sum_{n\\ge 0} B_n \\, x^n/n!$，等价地，对于每个整数 $n\\ge 1$，它满足递推关系\n$$\\sum_{k=0}^{n} \\binom{n+1}{k} \\, B_k \\;=\\; 0,$$\n且 $B_0=1$。请在有限域 $\\mathbb{Z}/13\\mathbb{Z}$ 中进行全部运算，将除以任何整数 $d$ 的操作解释为乘以其模 $13$ 的逆，前提是 $\\gcd(d,13)=1$。\n\n- 使用上述递推关系，通过依次确定 $n=1,2,\\dots,10$ 时 $B_n \\bmod 13$ 的值，计算 $B_{10}$ 模 $13$。\n- 然后，引用 von Staudt–Clausen 定理（该定理指出，对于偶数 $n=2m\\ge 2$，$B_{2m}$ 的小数部分等于 $-\\sum_{p\\,:\\, (p-1)\\mid 2m} \\frac{1}{p}$，因此 $B_{2m}$ 最简分数形式的分母是所有满足 $(p-1)\\mid 2m$ 的素数 $p$ 的乘积），解释 $B_{12}$ 在 $\\mathbb{Z}/13\\mathbb{Z}$ 中模 $13$ 的约化是否有良好定义，并说明原因。\n\n你的最终答案只需提供 $B_{10}$ 模 $13$ 的余数类，表示为集合 $\\{0,1,\\dots,12\\}$ 中的一个整数。", "solution": "首先，我们使用给定的递推关系 $\\sum_{k=0}^{n} \\binom{n+1}{k} B_k = 0$（对于 $n \\ge 1$）和 $B_0=1$，计算 $n=1, 2, \\dots, 10$ 时 $B_n \\pmod{13}$ 的值。所有计算都在有限域 $\\mathbb{Z}/13\\mathbb{Z}$ 中进行。\n\n该递推关系可以重新整理以求解 $B_n$：\n$$ \\binom{n+1}{n} B_n = - \\sum_{k=0}^{n-1} \\binom{n+1}{k} B_k $$\n$$ (n+1) B_n = - \\sum_{k=0}^{n-1} \\binom{n+1}{k} B_k $$\n对于 $n  12$，$n+1$ 不是 $13$ 的倍数，因此它在 $\\mathbb{Z}/13\\mathbb{Z}$ 中存在逆元 $(n+1)^{-1}$。\n$$ B_n = -(n+1)^{-1} \\sum_{k=0}^{n-1} \\binom{n+1}{k} B_k $$\n已知 $B_0=1$。\n\n对于 $n=1$：\n$ \\binom{2}{0}B_0 + \\binom{2}{1}B_1 = 0 \\implies 1 \\cdot 1 + 2B_1 = 0 \\implies 2B_1 \\equiv -1 \\equiv 12 \\pmod{13}$。\n$2$ 的逆元是 $7$，因为 $2 \\cdot 7 = 14 \\equiv 1$。因此，$B_1 \\equiv 12 \\cdot 7 = 84 \\equiv 6 \\pmod{13}$。\n\n对于 $n=2$：\n$ \\binom{3}{0}B_0 + \\binom{3}{1}B_1 + \\binom{3}{2}B_2 = 0 \\implies 1 \\cdot 1 + 3 \\cdot 6 + 3B_2 = 0 \\implies 1+18+3B_2 \\equiv 1+5+3B_2=0$。\n$6+3B_2=0 \\implies 3B_2 \\equiv -6 \\equiv 7 \\pmod{13}$。\n$3$ 的逆元是 $9$，因为 $3 \\cdot 9 = 27 \\equiv 1$。因此，$B_2 \\equiv 7 \\cdot 9 = 63 \\equiv 11 \\pmod{13}$。\n\n伯努利数的一个标准性质是，对于 $k \\ge 1$，$B_{2k+1}=0$。这里使用的约定 $B_1=-1/2$ 与此一致。作为验证：\n对于 $n=3$：\n$\\binom{4}{0}B_0 + \\binom{4}{1}B_1 + \\binom{4}{2}B_2 + \\binom{4}{3}B_3 = 0 \\implies 1\\cdot 1 + 4\\cdot 6 + 6\\cdot 11 + 4B_3 = 0$。\n$1+24+66+4B_3 \\equiv 1+11+1+4B_3 = 0 \\implies 13+4B_3=0 \\implies 4B_3=0$。\n由于 $4 \\not\\equiv 0 \\pmod{13}$，我们必有 $B_3 \\equiv 0 \\pmod{13}$。\n这意味着 $B_3=B_5=B_7=B_9 \\equiv 0 \\pmod{13}$。这简化了后续的计算。\n\n对于 $n=4$：\n$\\binom{5}{0}B_0+\\binom{5}{1}B_1+\\binom{5}{2}B_2+\\binom{5}{4}B_4 = 0$（因为 $B_3=0$）。\n$1\\cdot 1 + 5\\cdot 6 + 10\\cdot 11 + 5B_4 = 0 \\implies 1+30+110+5B_4 \\equiv 1+4+6+5B_4=0$。\n$11+5B_4=0 \\implies 5B_4 \\equiv -11 \\equiv 2 \\pmod{13}$。\n$5$ 的逆元是 $8$，因为 $5 \\cdot 8=40 \\equiv 1$。因此，$B_4 \\equiv 2 \\cdot 8 = 16 \\equiv 3 \\pmod{13}$。\n\n对于 $n=6$：\n$\\binom{7}{0}B_0+\\binom{7}{1}B_1+\\binom{7}{2}B_2+\\binom{7}{4}B_4+\\binom{7}{6}B_6=0$。\n系数模 $13$：$\\binom{7}{1}=7$, $\\binom{7}{2}=21\\equiv 8$, $\\binom{7}{4}=35\\equiv 9$, $\\binom{7}{6}=7$。\n$1\\cdot 1 + 7\\cdot 6 + 8\\cdot 11 + 9\\cdot 3 + 7B_6 = 0 \\implies 1+42+88+27+7B_6 \\equiv 1+3+10+1+7B_6 = 0$。\n$15+7B_6=0 \\implies 2+7B_6=0 \\implies 7B_6 \\equiv -2 \\equiv 11$。\n$7$ 的逆元是 $2$。因此，$B_6 \\equiv 11 \\cdot 2 = 22 \\equiv 9 \\pmod{13}$。\n\n对于 $n=8$：\n$\\binom{9}{0}B_0+\\binom{9}{1}B_1+\\binom{9}{2}B_2+\\binom{9}{4}B_4+\\binom{9}{6}B_6+\\binom{9}{8}B_8=0$。\n系数模 $13$：$\\binom{9}{1}=9$, $\\binom{9}{2}=36\\equiv 10$, $\\binom{9}{4}=126\\equiv 9$, $\\binom{9}{6}=84\\equiv 6$, $\\binom{9}{8}=9$。\n$1\\cdot 1 + 9\\cdot 6 + 10\\cdot 11 + 9\\cdot 3 + 6\\cdot 9 + 9B_8 = 0 \\implies 1+54+110+27+54+9B_8 \\equiv 1+2+6+1+2+9B_8=0$。\n$12+9B_8=0 \\implies 9B_8 \\equiv -12 \\equiv 1$。\n$9$ 的逆元是 $3$。因此，$B_8 \\equiv 1 \\cdot 3 = 3 \\pmod{13}$。\n\n对于 $n=10$：\n$\\binom{11}{0}B_0+\\binom{11}{1}B_1+\\binom{11}{2}B_2+\\binom{11}{4}B_4+\\binom{11}{6}B_6+\\binom{11}{8}B_8+\\binom{11}{10}B_{10}=0$。\n系数模 $13$：$\\binom{11}{1}=11\\equiv -2$, $\\binom{11}{2}=55\\equiv 3$, $\\binom{11}{4}=330\\equiv 5$, $\\binom{11}{6}=462\\equiv 7$, $\\binom{11}{8}=\\binom{11}{3}=165\\equiv 9$, $\\binom{11}{10}=\\binom{11}{1}\\equiv 11\\equiv -2$。\n$1\\cdot 1 + (-2)\\cdot 6 + 3\\cdot 11 + 5\\cdot 3 + 7\\cdot 9 + 9\\cdot 3 + (-2)B_{10} = 0$。\n$1 - 12 + 33 + 15 + 63 + 27 - 2B_{10} \\equiv 1 + 1 + 7 + 2 + 11 + 1 - 2B_{10} = 0$。\n和为 $1+1+7+2+11+1 = 23 \\equiv 10$。\n所以，$10 - 2B_{10} = 0 \\implies 2B_{10} \\equiv 10$。\n乘以 $2^{-1} \\equiv 7$，我们得到 $B_{10} \\equiv 10 \\cdot 7 = 70 \\equiv 5 \\pmod{13}$。\n\n其次，我们解释 $B_{12}$ 模 $13$ 的情况。\n一个有理数（如伯努利数 $B_n$）能有良好定义的模素数 $p$ 的约化，当且仅当其最简分数形式的分母不能被 $p$ 整除。这样的有理数称为 $p$-整有理数。\nvon Staudt–Clausen 定理给出了 $m \\ge 1$ 时 $B_{2m}$ 的精确分母。它指出，$B_{2m}$ 的分母是所有满足 $(p-1)$ 整除 $2m$ 的素数 $p$ 的乘积。\n对于 $B_{12}$ 的情况，我们有 $2m=12$。我们需要找到所有使得 $(p-1)$ 整除 $12$ 的素数 $p$。$12$ 的因子是 $1, 2, 3, 4, 6, 12$。我们对每个因子检查 $p-1$：\n- $p-1=1 \\implies p=2$，是素数。\n- $p-1=2 \\implies p=3$，是素数。\n- $p-1=3 \\implies p=4$，不是素数。\n- $p-1=4 \\implies p=5$，是素数。\n- $p-1=6 \\implies p=7$，是素数。\n- $p-1=12 \\implies p=13$，是素数。\n满足条件的素数是 $2, 3, 5, 7$ 和 $13$。根据该定理，$B_{12}$ 最简分数形式的分母是这些素数的乘积 $2 \\cdot 3 \\cdot 5 \\cdot 7 \\cdot 13 = 2730$。\n由于 $13$ 是 $B_{12}$ 分母的一个因子，所以 $B_{12}$ 不是一个 $13$-整有理数。因此，它模 $13$ 的约化没有良好定义。试图在 $\\mathbb{Z}/13\\mathbb{Z}$ 中计算它将对应于一个未定义的除以零的操作。", "answer": "$$\\boxed{5}$$", "id": "3009016"}]}