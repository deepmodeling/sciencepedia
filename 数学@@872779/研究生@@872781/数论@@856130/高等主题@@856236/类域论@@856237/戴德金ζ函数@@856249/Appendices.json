{"hands_on_practices": [{"introduction": "戴德金zeta函数由其在每个素数处的局部信息（即欧拉因子）构建而成。这个练习提供了一个从数域的定义多项式直接计算这些基本组成部分的具体实践。通过分析多项式在有限域上的分解，你不仅将确定欧拉因子，还将计算判别式和符号等关键不变量，从而将抽象理论与具体计算联系起来 ([@problem_id:3010964])。", "problem": "设 $K = \\mathbb{Q}(\\alpha)$ 是一个三次代数数域，通过添加不可约多项式 $f(x) = x^{3} - x^{2} - 2 x + 1 \\in \\mathbb{Z}[x]$ 的一个根 $\\alpha$ 来定义。利用关于判别式、嵌入以及通过模素数约化进行素理想分解的基本事实，从第一性原理出发，确定 $K$ 的以下不变量：\n\n1. $K$ 的绝对判别式 $d_{K}$。\n2. $K$ 的符号差 $(r_{1}, r_{2})$，其中 $r_{1}$ 是实嵌入的个数，$r_{2}$ 是复嵌入的对数。\n3. 对于每个有理素数 $p \\in \\{2,3,5,7,11,13\\}$，通过将 $f(x)$ 模 $p$ 分解并推导出分裂类型和剩余次数，确定戴德金 zeta 函数 $\\zeta_{K}(s)$ 在 $p$ 处的欧拉因子 $E_{p}(s)$，其定义为 $E_{p}(s) = \\prod_{\\mathfrak{p} \\mid p} \\left(1 - N\\mathfrak{p}^{-s}\\right)^{-1}$。\n\n将您的最终答案以单行矩阵的形式报告，按顺序包含 $d_{K}$、$r_{1}$、$r_{2}$ 的值，以及对于 $p \\in \\{2,3,5,7,11,13\\}$ 的六个欧拉因子 $E_{p}(s)$，表示为关于 $p^{-s}$ 的显式有理函数。不需要数值近似，也不涉及单位。", "solution": "该问题要求确定由不可约多项式 $f(x) = x^{3} - x^{2} - 2 x + 1$ 定义的三次代数数域 $K = \\mathbb{Q}(\\alpha)$ 的几个不变量。\n\n首先，我们验证问题的陈述。多项式 $f(x)$ 声称在 $\\mathbb{Q}$ 上是不可约的。根据有理根定理，任何可能的有理根都必须是常数项 $1$ 的因数，因此候选根为 $\\pm 1$。我们计算 $f(1) = 1^{3} - 1^{2} - 2(1) + 1 = -1 \\neq 0$ 和 $f(-1) = (-1)^{3} - (-1)^{2} - 2(-1) + 1 = -1 - 1 + 2 + 1 = 1 \\neq 0$。由于 $f(x)$ 没有有理根且次数为 $3$，因此它在 $\\mathbb{Q}$ 上是不可约的。该问题提法恰当，并基于标准的代数数论。\n\n我们接下来确定所要求的不变量。\n\n**1. $K$ 的符号差 $(r_1, r_2)$**\n\n符号差 $(r_1, r_2)$ 由实嵌入的个数 $r_1$ 和共轭复嵌入的对数 $r_2$ 组成。$r_1$ 的数量等于最小多项式 $f(x)$ 的实根个数。我们在实数线上分析函数 $f(x)$。我们计算它在几个整数点的值：\n$f(-2) = (-2)^3 - (-2)^2 - 2(-2) + 1 = -8 - 4 + 4 + 1 = -7$.\n$f(-1) = (-1)^3 - (-1)^2 - 2(-1) + 1 = -1 - 1 + 2 + 1 = 1$.\n$f(0) = 0^3 - 0^2 - 2(0) + 1 = 1$.\n$f(1) = 1^3 - 1^2 - 2(1) + 1 = -1$.\n$f(2) = 2^3 - 2^2 - 2(2) + 1 = 8 - 4 - 4 + 1 = 1$.\n\n根据介值定理，因为 $f(-2)  0$ 且 $f(-1) > 0$，在区间 $(-2, -1)$ 内有一个根。\n因为 $f(0) > 0$ 且 $f(1)  0$，在区间 $(0, 1)$ 内有一个根。\n因为 $f(1)  0$ 且 $f(2) > 0$，在区间 $(1, 2)$ 内有一个根。\n\n由于一个三次多项式最多有 $3$ 个实根，我们已经找到了所有实根。因此，有 $r_1 = 3$ 个实嵌入。\n扩张的次数为 $n = [K:\\mathbb{Q}] = 3$。符号差必须满足 $n = r_1 + 2r_2$。\n代入数值，我们有 $3 = 3 + 2r_2$，这意味着 $2r_2 = 0$，所以 $r_2 = 0$。\n$K$ 的符号差是 $(r_1, r_2) = (3, 0)$。这表明 $K$ 是一个全实域。\n\n**2. $K$ 的绝对判别式 $d_K$**\n\n首先，我们计算多项式 $f(x) = x^3 - x^2 - 2x + 1$ 的判别式。对于一个一般的三次多项式 $x^3 + ax^2 + bx + c$，判别式由公式 $\\Delta = a^2b^2 - 4b^3 - 4a^3c - 27c^2 + 18abc$ 给出。\n对于 $f(x)$，我们有 $a=-1$，$b=-2$ 和 $c=1$。\n$\\text{disc}(f) = (-1)^2(-2)^2 - 4(-2)^3 - 4(-1)^3(1) - 27(1)^2 + 18(-1)(-2)(1)$\n$= (1)(4) - 4(-8) - 4(-1)(1) - 27 + 36$\n$= 4 + 32 + 4 - 27 + 36 = 76 - 27 = 49 = 7^2$。\n\n多项式的判别式 $\\text{disc}(f)$ 与域的绝对判别式 $d_K$ 通过公式 $\\text{disc}(f) = [\\mathcal{O}_K : \\mathbb{Z}[\\alpha]]^2 d_K$ 相关联，其中 $\\mathcal{O}_K$ 是 $K$ 的整数环。\n$49 = [\\mathcal{O}_K : \\mathbb{Z}[\\alpha]]^2 d_K$。\n这意味着 $d_K$ 必须是 $49$ 的一个因数。由于 $K \\neq \\mathbb{Q}$，我们必须有 $|d_K| > 1$。判别式的符号由 $(-1)^{r_2}$ 给出。因为 $r_2=0$，所以 $d_K > 0$。$49$ 的正因数是 $1, 7, 49$。因此，$d_K$ 可能是 $7$ 或 $49$。\n根据 Stickelberger 定理，数域的判别式必须模 $4$ 同余于 $0$ 或 $1$。\n$7 \\equiv 3 \\pmod 4$，所以 $d_K \\neq 7$。\n$49 \\equiv 1 \\pmod 4$，这是一个有效的可能性。\n因此，唯一的可能性是 $d_K=49$。\n这意味着 $[\\mathcal{O}_K : \\mathbb{Z}[\\alpha]]^2 = 1$，所以指数为 $1$。这意味着序 $\\mathbb{Z}[\\alpha]$ 是极大序，所以 $\\mathcal{O}_K = \\mathbb{Z}[\\alpha]$。\n\n**3. 对于 $p \\in \\{2,3,5,7,11,13\\}$ 的欧拉因子 $E_p(s)$**\n\n由于 $\\mathcal{O}_K = \\mathbb{Z}[\\alpha]$，我们可以使用 Dedekind-Kummer 定理，通过将多项式 $f(x)$ 模 $p$ 分解来确定素理想 $(p)$ 的分解。如果 $f(x) \\equiv \\prod_{i=1}^{k} g_i(x)^{e_i} \\pmod p$ 是在 $\\mathbb{F}_p$ 上分解为不同的不可约多项式 $g_i(x)$，其次数为 $f_i = \\deg(g_i)$，那么 $(p) = \\prod_{i=1}^{k} \\mathfrak{p}_i^{e_i}$，其中 $\\mathfrak{p}_i$ 是素理想，其范数为 $N(\\mathfrak{p}_i) = p^{f_i}$。那么欧拉因子为 $E_p(s) = \\prod_{i=1}^{k} (1 - N(\\mathfrak{p}_i)^{-s})^{-1} = \\prod_{i=1}^{k} (1 - p^{-f_i s})^{-1}$。\n\n- **情况 $p=2$**: $f(x) \\equiv x^3 - x^2 - 2x + 1 \\equiv x^3 + x^2 + 1 \\pmod 2$。\n在 $\\mathbb{F}_2$ 中测试根：$f(0) \\equiv 1$，$f(1) \\equiv 1+1+1=1$。没有根，所以 $f(x)$ 模 $2$ 不可约。\n这对应于一个次数为 $f_1=3$ 的不可约因子。理想 $(2)$ 是惰性的。\n$E_2(s) = (1 - 2^{-3s})^{-1}$。\n\n- **情况 $p=3$**: $f(x) \\equiv x^3 - x^2 - 2x + 1 \\equiv x^3 - x^2 + x + 1 \\pmod 3$。\n在 $\\mathbb{F}_3$ 中测试根：$f(0) \\equiv 1$，$f(1) \\equiv 1-1+1+1=2$，$f(2) \\equiv 8-4+2+1=7 \\equiv 1$。没有根，所以 $f(x)$ 模 $3$ 不可约。\n这对应于一个次数为 $f_1=3$ 的不可约因子。理想 $(3)$ 是惰性的。\n$E_3(s) = (1 - 3^{-3s})^{-1}$。\n\n- **情况 $p=5$**: $f(x) \\equiv x^3 - x^2 - 2x + 1 \\pmod 5$。\n在 $\\mathbb{F}_5$ 中测试根：$f(0) \\equiv 1, f(1) \\equiv -1, f(2) \\equiv 1, f(3) \\equiv 3, f(4) \\equiv 1$。没有根，所以 $f(x)$ 模 $5$ 不可约。\n这对应于一个次数为 $f_1=3$ 的不可约因子。理想 $(5)$ 是惰性的。\n$E_5(s) = (1 - 5^{-3s})^{-1}$。\n\n- **情况 $p=7$**: $f(x) \\equiv x^3 - x^2 - 2x + 1 \\pmod 7$。由于 $d_K=49$，我们预期 $p=7$ 会分歧。\n我们来找根：$f(5) = 125 - 25 - 10 + 1 = 91 = 13 \\times 7 \\equiv 0 \\pmod 7$。所以 $(x-5)$ 是一个因子。\n$f(x) = x^3-x^2-2x+1 \\equiv x^3+6x^2+5x+1 \\pmod 7$。\n除以 $(x-5) \\equiv x+2$：$(x^3+6x^2+5x+1) = (x+2)(x^2+4x+4)=(x+2)(x+2)^2=(x+2)^3$。\n所以 $f(x) \\equiv (x-5)^3 \\pmod 7$。\n这对应于一个次数为 $f_1=1$、指数为 $e_1=3$ 的因子。理想 $(7)$ 是完全分歧的：$(7)=\\mathfrak{p}^3$。$\\mathfrak{p}$ 的范数是 $7^1=7$。\n$E_7(s) = (1 - 7^{-s})^{-1}$。\n\n- **情况 $p=11$**: $f(x) \\equiv x^3 - x^2 - 2x + 1 \\pmod{11}$。\n对 $\\mathbb{F}_{11}$ 中的根进行系统检查表明没有根：$f(0)=1, f(1)=10, f(2)=1, f(3)=2, f(4)=8, f(5)=3, f(6)=4, f(7)=4, f(8)=6, f(9)=4, f(10)=1$。\n所以 $f(x)$ 模 $11$ 不可约。这对应于一个次数为 $f_1=3$ 的不可约因子。理想 $(11)$ 是惰性的。\n$E_{11}(s) = (1 - 11^{-3s})^{-1}$。\n\n- **情况 $p=13$**: $f(x) \\equiv x^3 - x^2 - 2x + 1 \\pmod{13}$。\n在 $\\mathbb{F}_{13}$ 中测试根：$f(3) = 27 - 9 - 6 + 1 = 13 \\equiv 0 \\pmod{13}$。所以 $(x-3)$ 是一个因子。\n多项式除法：$(x^3 - x^2 - 2x + 1) = (x-3)(x^2 + 2x + 4) \\pmod{13}$。\n二次因子 $q(x) = x^2+2x+4$ 的判别式为 $\\Delta = 2^2 - 4(1)(4) = -12 \\equiv 1 \\pmod{13}$。\n由于判别式是一个平方数 ($1=1^2$)，$q(x)$ 分解为两个不同的一次项。\n根是 $x = \\frac{-2 \\pm \\sqrt{1}}{2} = \\frac{-2 \\pm 1}{2}$。在 $\\mathbb{F}_{13}$ 中 $2$ 的乘法逆元是 $7$。\n$x_1 = (-1)(7) = -7 \\equiv 6 \\pmod{13}$。\n$x_2 = (-3)(7) = -21 \\equiv 5 \\pmod{13}$。\n所以 $f(x) \\equiv (x-3)(x-5)(x-6) \\pmod{13}$。\n$f(x)$ 完全分裂为三个不同的一次因子。这意味着理想 $(13)$ 分裂为 $(13) = \\mathfrak{p}_1 \\mathfrak{p}_2 \\mathfrak{p}_3$，其中每个 $\\mathfrak{p}_i$ 的范数为 $13^1=13$。\n$E_{13}(s) = (1 - 13^{-s})^{-1}(1 - 13^{-s})^{-1}(1 - 13^{-s})^{-1} = (1 - 13^{-s})^{-3}$。\n\n最终结果汇总在一个单行矩阵中。\n$d_K = 49$\n$(r_1, r_2) = (3, 0)$\n$E_2(s) = (1 - 2^{-3s})^{-1}$\n$E_3(s) = (1 - 3^{-3s})^{-1}$\n$E_5(s) = (1 - 5^{-3s})^{-1}$\n$E_7(s) = (1 - 7^{-s})^{-1}$\n$E_{11}(s) = (1 - 11^{-3s})^{-1}$\n$E_{13}(s) = (1 - 13^{-s})^{-3}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n49  3  0  \\left(1-2^{-3s}\\right)^{-1}  \\left(1-3^{-3s}\\right)^{-1}  \\left(1-5^{-3s}\\right)^{-1}  \\left(1-7^{-s}\\right)^{-1}  \\left(1-11^{-3s}\\right)^{-1}  \\left(1-13^{-s}\\right)^{-3}\n\\end{pmatrix}\n}\n$$", "id": "3010964"}, {"introduction": "解析类数公式是代数数论的基石，它将zeta函数的解析行为与数域的深层算术不变量联系起来。本练习将引导你为经典的二次域 $\\mathbb{Q}(i)$ 和 $\\mathbb{Q}(\\sqrt{-3})$ 验证此公式 ([@problem_id:3010984])。你将使用L函数从第一性原理计算 $\\zeta_K(s)$ 在 $s=1$ 处的留数，并确认它与公式预测的值相符，从而加深你对这一深刻联系的理解。", "problem": "设 $K_{1}=\\mathbb{Q}(i)$ 且 $K_{2}=\\mathbb{Q}(\\sqrt{-3})$。记 $w_{K}$ 为数域 $K$ 中单位根的个数，$\\zeta_{K}(s)$ 为 $K$ 的戴德金 zeta 函数，$D_{K}$ 为 $K$ 的判别式的绝对值。\n\n(a) 从第一性原理出发，仅使用单位根的定义和二次虚域的结构，确定 $w_{K_{1}}$ 和 $w_{K_{2}}$。\n\n(b) 仅使用关于二次域和狄利克雷特征的基本事实，将留数 \n$$\\lim_{s\\to 1}(s-1)\\,\\zeta_{K}(s)$$ \n对于 $K\\in\\{K_{1},K_{2}\\}$ 表示为一个狄利克雷 L-级数 $L(s,\\chi_{D})$，该级数附属于一个二次特征 $\\chi_{D}$，其导子等于 $K$ 的（基本）判别式 $D$。然后通过直接级数计算，求出 $L(1,\\chi_{D})$ 的闭式解。\n\n(c) 计算 $D_{K_{1}}$ 和 $D_{K_{2}}$，并回顾 $K_{1}$ 和 $K_{2}$ 的类数均为 $h_{K}=1$ 且单位秩为 $0$（因此按惯例调节子 $R_{K}=1$），并在这两种情况下验证解析类数公式对于 $s=1$ 处留数的一致性。\n\n将你的最终答案表示为行矩阵 \n$$\\big[w_{K_{1}},\\,w_{K_{2}},\\,\\lim_{s\\to 1}(s-1)\\zeta_{K_{1}}(s),\\,\\lim_{s\\to 1}(s-1)\\zeta_{K_{2}}(s)\\big].$$\n不需要进行数值取整；给出精确的闭式解。", "solution": "该问题陈述清晰，科学严谨，客观且内部一致，包含了唯一解所需的所有信息。这是代数数论中的一个标准问题。我将开始解答。\n\n按要求，该问题分三部分解答。\n\n(a) 确定 $w_{K_{1}}$ 和 $w_{K_{2}}$\n\n数域 $K$ 中的单位根是一个代数整数 $\\zeta \\in \\mathcal{O}_K$，使得对于某个正整数 $n$，有 $\\zeta^n=1$。这等价于要求 $\\zeta$ 的复数范数（模）为 1，即 $|\\zeta|=1$。由于代数整数 $\\alpha \\in \\mathcal{O}_K$ 的域范数 $N_K(\\alpha)$ 是一个有理整数，且对于虚二次域 $K = \\mathbb{Q}(\\sqrt{-d})$（其中 $d>0$），元素 $z \\in K$ 的范数是 $N(z) = |z|^2$，因此单位根的域范数必须为 $N(\\zeta)=|\\zeta|^2=1$。\n\n对于 $K_{1} = \\mathbb{Q}(i)$，其整数环是高斯整数环 $\\mathcal{O}_{K_{1}} = \\mathbb{Z}[i]$。一个元素的形式为 $z = a+bi$，其中 $a,b \\in \\mathbb{Z}$。其范数为 $N(z) = a^2+b^2$。我们寻找 $a^2+b^2=1$ 的整数解。\n如果 $|a| \\ge 2$ 或 $|b| \\ge 2$，那么 $a^2+b^2 \\ge 4$，所以没有解。我们只需要检查 $a,b \\in \\{-1, 0, 1\\}$ 的情况。\n整数解 $(a,b)$ 是 $(1,0)$, $(-1,0)$, $(0,1)$ 和 $(0,-1)$。它们对应于元素 $1$, $-1$, $i$ 和 $-i$。这些是 $K_{1}$ 中的四个单位根。\n因此，$w_{K_{1}} = 4$。\n\n对于 $K_{2} = \\mathbb{Q}(\\sqrt{-3})$，其整数环是艾森斯坦整数环 $\\mathcal{O}_{K_{2}} = \\mathbb{Z}[\\omega]$，其中 $\\omega = \\frac{1+\\sqrt{-3}}{2}$。一个元素的形式为 $z = a+b\\omega$，其中 $a,b \\in \\mathbb{Z}$。其范数为 $N(z) = N(a+b\\frac{1+\\sqrt{-3}}{2}) = N((a+\\frac{b}{2}) + i\\frac{b\\sqrt{3}}{2}) = (a+\\frac{b}{2})^2 + (\\frac{b\\sqrt{3}}{2})^2 = a^2+ab+\\frac{b^2}{4}+\\frac{3b^2}{4} = a^2+ab+b^2$。\n我们寻找 $a^2+ab+b^2=1$ 的整数解。\n如果 $a=0$，则 $b^2=1 \\Rightarrow b = \\pm 1$。这给出两个解 $(0,1)$ 和 $(0,-1)$，对应于 $z=\\omega$ 和 $z=-\\omega$。\n如果 $b=0$，则 $a^2=1 \\Rightarrow a = \\pm 1$。这给出两个解 $(1,0)$ 和 $(-1,0)$，对应于 $z=1$ 和 $z=-1$。\n如果 $a,b \\neq 0$：\n如果 $a$ 和 $b$ 同号，比如说 $a,b > 0$，那么 $a^2+ab+b^2 \\ge 1+1+1=3$。没有解。\n如果 $a$ 和 $b$ 异号，比如说 $a>0, b0$。令 $b'=-b>0$。方程为 $a^2-ab'+(b')^2=1$。我们可以将其看作关于 $a$ 的二次方程：$a^2 - ab' + ((b')^2-1) = 0$。为了存在整数解 $a$，判别式必须是一个完全平方数：$\\Delta = (b')^2 - 4((b')^2-1) = 4-3(b')^2 = k^2$，对于某个整数 $k \\ge 0$。由于 $b'$ 是正整数，$(b')^2 \\ge 1$，所以 $4-3(b')^2 \\le 1$。唯一可能性是 $(b')^2=1$，这意味着 $b'=1$。于是 $\\Delta = 4-3=1=1^2$。\n对于 $b'=1$（即 $b=-1$），$a$ 的解为 $a = \\frac{b' \\pm \\sqrt{\\Delta}}{2} = \\frac{1 \\pm 1}{2}$，得到 $a=1$ 或 $a=0$。$a=0$ 的情况已经处理过。$a=1$ 的情况给出解 $(a,b)=(1, -1)$。\n根据对称性，如果 $b>0, a0$，我们得到解 $(a,b)=(-1,1)$。\n整数解 $(a,b)$ 是 $(1,0)$, $(-1,0)$, $(0,1)$, $(0,-1)$, $(1,-1)$ 和 $(-1,1)$。\n它们对应于元素：\n$1$, $-1$, $\\omega = \\frac{1+\\sqrt{-3}}{2}$, $-\\omega = \\frac{-1-\\sqrt{-3}}{2}$, $1-\\omega = \\frac{1-\\sqrt{-3}}{2}$ 和 $-1+\\omega = \\frac{-1+\\sqrt{-3}}{2}$。\n这些是六个六次单位根。因此，$w_{K_{2}} = 6$。\n\n(b) 使用狄利克雷 L-级数计算留数\n\n对于判别式为 $D_K$ 的二次数域 $K$，其戴德金 zeta 函数可以分解为 $\\zeta_K(s) = \\zeta_{\\mathbb{Q}}(s)L(s, \\chi_{D_K})$，其中 $\\zeta_{\\mathbb{Q}}(s)$ 是黎曼 zeta 函数，$\\chi_{D_K}$ 是与 $K$ 相关联的二次狄利克雷特征。该特征由克罗内克符号 $\\chi_{D_K}(n) = (\\frac{D_K}{n})$ 给出。\n黎曼 zeta 函数在 $s=1$ 处有一个留数为 1 的单极点，即 $\\lim_{s\\to 1} (s-1)\\zeta_{\\mathbb{Q}}(s)=1$。当 $\\chi_{D_K}$ 是非主特征时，L-级数 $L(s, \\chi_{D_K})$ 在 $\\Re(s)>0$ 上是解析的，这对于二次域来说是成立的。\n因此，$\\zeta_K(s)$ 在 $s=1$ 处的留数是：\n$$ \\lim_{s\\to 1} (s-1)\\zeta_K(s) = \\left(\\lim_{s\\to 1}(s-1)\\zeta_{\\mathbb{Q}}(s)\\right) \\left(\\lim_{s\\to 1} L(s, \\chi_{D_K})\\right) = 1 \\cdot L(1, \\chi_{D_K}) $$\n对于 $K_1 = \\mathbb{Q}(i) = \\mathbb{Q}(\\sqrt{-1})$，我们有 $-1 \\equiv 3 \\pmod{4}$，所以判别式为 $D_{K_1} = 4(-1) = -4$。相关联的特征 $\\chi_{-4}$ 是一个模 4 的特征。它非平凡，由 $\\chi_{-4}(n)=1$（如果 $n \\equiv 1 \\pmod{4}$），$\\chi_{-4}(n)=-1$（如果 $n \\equiv 3 \\pmod{4}$），以及 $\\chi_{-4}(n)=0$（如果 $\\gcd(n,4) \\ne 1$）给出。\nL-级数为：\n$$ L(1, \\chi_{-4}) = \\sum_{n=1}^\\infty \\frac{\\chi_{-4}(n)}{n} = \\frac{1}{1} - \\frac{1}{3} + \\frac{1}{5} - \\frac{1}{7} + \\dots $$\n这是著名的 Gregory-Leibniz 级数。它是 $\\arctan(x) = \\sum_{k=0}^\\infty \\frac{(-1)^k x^{2k+1}}{2k+1}$ 在 $x=1$ 处的泰勒级数展开。\n$$ L(1, \\chi_{-4}) = \\arctan(1) = \\frac{\\pi}{4} $$\n因此，$\\lim_{s\\to 1}(s-1)\\zeta_{K_1}(s) = \\frac{\\pi}{4}$。\n\n对于 $K_2 = \\mathbb{Q}(\\sqrt{-3})$，我们有 $-3 \\equiv 1 \\pmod{4}$，所以判别式为 $D_{K_2} = -3$。相关联的特征 $\\chi_{-3}$ 是一个模 3 的特征。它由勒让德符号 $(\\frac{n}{3})$ 给出，所以 $\\chi_{-3}(1)=1$, $\\chi_{-3}(2)=-1$, 且 $\\chi_{-3}(3)=0$。\nL-级数为：\n$$ L(1, \\chi_{-3}) = \\sum_{n=1}^\\infty \\frac{\\chi_{-3}(n)}{n} = \\frac{1}{1} - \\frac{1}{2} + \\frac{1}{4} - \\frac{1}{5} + \\dots $$\n为了计算这个级数，我们可以考虑幂级数 $f(x) = \\sum_{n=1}^\\infty \\frac{\\chi_{-3}(n)}{n} x^n$（对于 $|x|1$），并计算 $x \\to 1^-$ 时的极限。\n其导数为 $f'(x) = \\sum_{n=1}^\\infty \\chi_{-3}(n) x^{n-1} = 1 - x + x^3 - x^4 + \\dots = (1-x) + x^3(1-x) + x^6(1-x) + \\dots = (1-x)(1+x^3+x^6+\\dots) = (1-x)\\frac{1}{1-x^3} = \\frac{1-x}{(1-x)(1+x+x^2)} = \\frac{1}{1+x+x^2}$。\n则 $L(1, \\chi_{-3}) = f(1) = \\int_0^1 \\frac{1}{1+t+t^2} dt$。我们对分母配方：$1+t+t^2 = (t+\\frac{1}{2})^2 + \\frac{3}{4}$。\n$$ \\int_0^1 \\frac{dt}{(t+\\frac{1}{2})^2 + (\\frac{\\sqrt{3}}{2})^2} = \\left[\\frac{1}{\\sqrt{3}/2} \\arctan\\left(\\frac{t+1/2}{\\sqrt{3}/2}\\right)\\right]_0^1 = \\frac{2}{\\sqrt{3}}\\left[\\arctan\\left(\\frac{2t+1}{\\sqrt{3}}\\right)\\right]_0^1 $$\n$$ = \\frac{2}{\\sqrt{3}} \\left(\\arctan\\left(\\frac{3}{\\sqrt{3}}\\right) - \\arctan\\left(\\frac{1}{\\sqrt{3}}\\right)\\right) = \\frac{2}{\\sqrt{3}}(\\arctan(\\sqrt{3}) - \\arctan(1/\\sqrt{3})) $$\n$$ = \\frac{2}{\\sqrt{3}}\\left(\\frac{\\pi}{3} - \\frac{\\pi}{6}\\right) = \\frac{2}{\\sqrt{3}}\\left(\\frac{\\pi}{6}\\right) = \\frac{\\pi}{3\\sqrt{3}} $$\n因此，$\\lim_{s\\to 1}(s-1)\\zeta_{K_2}(s) = \\frac{\\pi}{3\\sqrt{3}}$。\n\n(c) 使用解析类数公式进行验证\n\n数域 $K$ 的解析类数公式表述为：\n$$ \\lim_{s\\to 1}(s-1)\\zeta_K(s) = \\frac{2^{r_1}(2\\pi)^{r_2}h_K R_K}{w_K \\sqrt{D_K}} $$\n其中 $r_1$ 是实嵌入的个数，$r_2$ 是共轭复嵌入的对数，$h_K$ 是类数，$R_K$ 是调节子，$w_K$ 是单位根的个数，而 $D_K = |d_K|$ 是判别式的绝对值。\n\n对于 $K_1 = \\mathbb{Q}(i)$，它是一个虚二次域，所以 $r_1=0$ 且 $r_2=1$。\n判别式为 $D_{K_1}=|-4|=4$。\n根据 (a) 部分，$w_{K_1}=4$。\n我们已知 $h_{K_1}=1$ 且单位秩为 $r_1+r_2-1=0$，因此按惯例 $R_{K_1}=1$。\n将这些值代入公式：\n$$ \\lim_{s\\to 1}(s-1)\\zeta_{K_1}(s) = \\frac{2^0(2\\pi)^1 \\cdot 1 \\cdot 1}{4 \\cdot \\sqrt{4}} = \\frac{2\\pi}{4 \\cdot 2} = \\frac{2\\pi}{8} = \\frac{\\pi}{4} $$\n这个结果与 (b) 部分推导出的值一致。\n\n对于 $K_2 = \\mathbb{Q}(\\sqrt{-3})$，它也是一个虚二次域，所以 $r_1=0$ 且 $r_2=1$。\n判别式为 $D_{K_2}=|-3|=3$。\n根据 (a) 部分，$w_{K_2}=6$。\n我们已知 $h_{K_2}=1$ 且单位秩为 $0$，所以 $R_{K_2}=1$。\n将这些值代入公式：\n$$ \\lim_{s\\to 1}(s-1)\\zeta_{K_2}(s) = \\frac{2^0(2\\pi)^1 \\cdot 1 \\cdot 1}{6 \\cdot \\sqrt{3}} = \\frac{2\\pi}{6\\sqrt{3}} = \\frac{\\pi}{3\\sqrt{3}} $$\n这个结果也与 (b) 部分推导出的值一致。\n\n判别式 $D_{K_1}=4$ 和 $D_{K_2}=3$ 的计算得到了确认，并且解析类数公式在这两种情况下的一致性也得到了验证。\n\n最终答案要求行矩阵 $[w_{K_{1}}, w_{K_{2}}, \\lim_{s\\to 1}(s-1)\\zeta_{K_{1}}(s), \\lim_{s\\to 1}(s-1)\\zeta_{K_{2}}(s)]$。\n这些值是 $w_{K_1}=4$, $w_{K_2}=6$, $\\lim_{s\\to 1}(s-1)\\zeta_{K_1}(s) = \\frac{\\pi}{4}$ 和 $\\lim_{s\\to 1}(s-1)\\zeta_{K_2}(s) = \\frac{\\pi}{3\\sqrt{3}}$。\n所求的矩阵是 $[4, 6, \\frac{\\pi}{4}, \\frac{\\pi}{3\\sqrt{3}}]$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 4  6  \\frac{\\pi}{4}  \\frac{\\pi}{3\\sqrt{3}} \\end{pmatrix} } $$", "id": "3010984"}, {"introduction": "解析数论为计算算术对象的数量提供了强大的渐近公式。本练习通过要求你验证 $\\mathbb{Q}(i)$ 中理想数量的渐近公式主项，从而在理论与计算之间架起一座桥梁 ([@problem_id:3010986])。你将推导给定范数的理想数量的公式，实现一个算法来计数它们，并将你的数值结果与从戴德金zeta函数留数推导出的理论预测进行比较，从而亲眼“看到”解析类数公式的实际效果。", "problem": "考虑一个数域 $K$ 及其戴德金zeta函数 $\\zeta_K(s)$，它对满足 $\\operatorname{Re}(s)  1$ 的复变量 $s$ 由以下狄利克雷级数定义\n$$\n\\zeta_K(s) \\;=\\; \\sum_{\\mathfrak{a} \\subset \\mathcal{O}_K \\setminus \\{0\\}} \\frac{1}{N\\mathfrak{a}^{\\,s}} \\;=\\; \\sum_{n=1}^{\\infty} \\frac{a_K(n)}{n^{s}},\n$$\n其中 $\\mathcal{O}_K$ 表示 $K$ 的整数环， $N\\mathfrak{a}$ 是理想 $\\mathfrak{a}$ 的绝对范数，而 $a_K(n)$ 是范数为 $n$ 的非零整理想的个数。定义求和计数函数\n$$\nA_K(x) \\;=\\; \\sum_{n \\le x} a_K(n),\n$$\n该函数计算 $\\mathcal{O}_K$ 中范数至多为 $x$ 的非零整理想的数量。解析类数公式给出了在 $s=1$ 处的留数，\n$$\n\\operatorname{Res}_{s=1}\\zeta_K(s) \\;=\\; \\frac{2^{r_1}(2\\pi)^{r_2} h_K R_K}{w_K \\sqrt{|d_K|}},\n$$\n其中 $r_1$ 是实嵌入的数量，$r_2$ 是共轭复嵌入的对数，$h_K$ 是类数，$R_K$ 是调节子，$w_K$ 是 $K$ 中单位根的数量，$d_K$ 是 $K$ 的判别式的绝对值。经典的陶伯理论表明 $A_K(x)$ 的主项由留数乘以 $x$ 给出。\n\n你的任务是设计并实现一个程序，从这些核心定义出发，推导出一个用算术函数表示的 $A_K(x)$ 的可计算表达式，然后对小的虚二次域 $K=\\mathbb{Q}(i)$（其整数环为 $\\mathbb{Z}[i]$）进行数值计算。对于这个域，通过解析类数公式确定留数常数 $c_K = \\operatorname{Res}_{s=1}\\zeta_K(s)$，并将 $A_K(x)$ 与主项 $c_K x$ 进行比较。\n\n程序必须：\n- 使用域 $K=\\mathbb{Q}(i)$，其判别式满足 $d_K = -4$，其不变量 $(r_1,r_2,h_K,R_K,w_K)$ 应在解题设计中从基本原理推导得出，并在代码中进行数值使用。\n- 仅使用 $\\zeta_K(s)$ 的基本性质、欧拉乘积和标准算术函数，基于来自 $\\zeta_K(s)$ 的狄利克雷级数系数 $a_K(n)$，推导出一个显式的、有限的、$A_K(x)$ 的可计算公式。推导必须从上述定义开始，而不是从预先给定的简化恒等式开始。\n- 对下面给出的测试套件中的 $x$ 值进行数值计算 $A_K(x)$。\n- 计算比较比率\n$$\nR(x) \\;=\\; \\frac{A_K(x)}{c_K x},\n$$\n该比率表明 $A_K(x)$ 与主项 $c_K x$ 的接近程度。\n\n测试套件：\n- $x=1$ (边界情况),\n- $x=2$ (区分奇偶行为的小情况),\n- $x=25$ (平方数阈值),\n- $x=100$ (中等情况),\n- $x=1000$ (较大情况),\n- $x=10000$ (在计算上仍可行的压力测试情况)。\n\n最终输出格式：\n- 你的程序应生成一行输出，其中包含测试套件中 $x$ 值对应的 $R(x)$ 值，按上述顺序排列，形式为用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4,r_5,r_6]$）。\n- 这些值必须是标准十进制表示法的浮点数形式。不涉及物理单位，因此不需要。", "solution": "该问题要求对高斯数域 $K=\\mathbb{Q}(i)$ 的理想计数函数 $A_K(x)$ 进行分析，并从基本原理出发。这涉及三个主要阶段：首先，使用解析类数公式确定戴德金zeta函数 $\\zeta_K(s)$ 在 $s=1$ 处的留数；其次，推导 $\\zeta_K(s)$ 的狄利克雷级数系数 $a_K(n)$ 的可计算表达式；第三，实现一个数值算法来计算 $A_K(x)$ 并将其与其渐近近似进行比较。\n\n所讨论的域是 $K = \\mathbb{Q}(i)$，即高斯有理数域。其整数环是 $\\mathcal{O}_K = \\mathbb{Z}[i]$，即高斯整数环。给定的问题陈述是自洽的、科学上合理且良定的。所有定义和任务在代数数论中都是标准的。我们着手解决此问题。\n\n**第一部分：确定留数常数 $c_K$**\n\n$A_K(x)$ 的渐近展开式中的主项由 $c_K x$ 给出，其中 $c_K = \\operatorname{Res}_{s=1}\\zeta_K(s)$。解析类数公式用域不变量给出了此留数的表达式：\n$$\nc_K = \\frac{2^{r_1}(2\\pi)^{r_2} h_K R_K}{w_K \\sqrt{|d_K|}}\n$$\n我们必须从基本定义出发，确定 $K=\\mathbb{Q}(i)$ 的不变量 $(r_1, r_2, h_K, R_K, w_K, d_K)$。\n\n1.  **次数与嵌入 ($r_1, r_2$)**：域扩张 $K/\\mathbb{Q}$ 由最小多项式 $t^2+1=0$ 的根 $i$ 生成。扩张次数为 $[K:\\mathbb{Q}]=2$。最小多项式的根为 $\\pm i$，两者都是复数。因此，没有实嵌入 ($r_1=0$)，有一对共轭复嵌入 ($r_2=1$)。次数检验 $n = r_1+2r_2$ 满足，因为 $2 = 0+2(1)$。\n\n2.  **判别式 ($d_K$)**：整数环 $\\mathcal{O}_K = \\mathbb{Z}[i]$ 有一个整基 $\\{1, i\\}$。判别式定义为矩阵的行列式的平方，该矩阵的元素是基元素乘积的迹。元素 $a+bi \\in K$ 的迹为 $\\operatorname{Tr}(a+bi) = (a+bi) + (a-bi) = 2a$。\n    - $\\operatorname{Tr}(1 \\cdot 1) = \\operatorname{Tr}(1) = 2$。\n    - $\\operatorname{Tr}(1 \\cdot i) = \\operatorname{Tr}(i) = 0$。\n    - $\\operatorname{Tr}(i \\cdot i) = \\operatorname{Tr}(-1) = -2$。\n    因此，判别式为 $d_K = \\det \\begin{pmatrix} 2  0 \\\\ 0  -2 \\end{pmatrix} = -4$。其绝对值为 $|d_K|=4$。\n\n3.  **单位根 ($w_K$)**：$K$ 中的单位根是 $\\mathcal{O}_K = \\mathbb{Z}[i]$ 中同时也是单位的元素。$\\mathbb{Z}[i]$ 的单位是那些范数 $N(a+bi) = a^2+b^2$ 等于 $1$ 的元素 $a+bi$。方程 $a^2+b^2=1$ 的整数解为 $(a,b) \\in \\{(\\pm 1, 0), (0, \\pm 1)\\}$。这对应于四个元素 $\\{1, -1, i, -i\\}$。因此，单位根的数量为 $w_K=4$。\n\n4.  **类数 ($h_K$)**：类数 $h_K$ 是 $K$ 的理想类群的阶。环 $\\mathbb{Z}[i]$ 是关于范数函数 $N(a+bi) = a^2+b^2$ 的欧几里得整环。每个欧几里得整环都是主理想整环 (PID)。在 PID 中，每个理想都是主理想，这意味着理想类群是平凡的。因此，类数 $h_K=1$。\n\n5.  **调节子 ($R_K$)**：调节子是衡量单位群“大小”的量。根据狄利克雷单位定理，单位群的秩为 $r = r_1+r_2-1$。对于 $K=\\mathbb{Q}(i)$，秩为 $0+1-1=0$。这意味着唯一的单位是单位根。在单位群秩为零的情况下（这发生在 $\\mathbb{Q}$ 和虚二次域中），按照惯例，调节子定义为 $R_K=1$。\n\n将这些不变量代入留数公式：\n$$\nc_K = \\frac{2^{0}(2\\pi)^{1} \\cdot 1 \\cdot 1}{4 \\cdot \\sqrt{4}} = \\frac{2\\pi}{4 \\cdot 2} = \\frac{2\\pi}{8} = \\frac{\\pi}{4}\n$$\n因此，理想数量的渐近近似为 $A_K(x) \\sim \\frac{\\pi}{4}x$。\n\n**第二部分：推导理想计数函数 $a_K(n)$**\n\n为了计算 $A_K(x) = \\sum_{n \\le x} a_K(n)$，我们需要系数 $a_K(n)$ 的一个显式公式，它由 $\\zeta_K(s) = \\sum_{n=1}^\\infty a_K(n)n^{-s}$ 定义。我们从 $\\zeta_K(s)$ 的欧拉乘积表示开始：\n$$\n\\zeta_K(s) = \\prod_{\\mathfrak{p} \\subset \\mathcal{O}_K} \\left(1 - \\frac{1}{N\\mathfrak{p}^s}\\right)^{-1}\n$$\n其中乘积遍及 $\\mathcal{O}_K = \\mathbb{Z}[i]$ 的所有非零素理想 $\\mathfrak{p}$。这些素理想的结构由有理素数 $p \\in \\mathbb{Z}$ 扩张到 $\\mathbb{Z}[i]$ 时的行为决定。此行为取决于勒让德符号 $(\\frac{d_K}{p}) = (\\frac{-4}{p}) = (\\frac{-1}{p})$。\n\n1.  **分歧素数 ($p=2$)**：如果一个素数 $p$ 整除判别式 $d_K=-4$，则它会分歧。这只对 $p=2$ 发生。在 $\\mathbb{Z}[i]$ 中，我们有分解 $2 = -i(1+i)^2$。理想分解为 $(2) = (1+i)^2$。在 $2$ 之上只有一个素理想 $\\mathfrak{p}_2 = (1+i)$。其范数为 $N(\\mathfrak{p}_2) = N_{\\mathbb{Q}(i)/\\mathbb{Q}}(1+i) = 1^2+1^2=2$。对应的欧拉因子是 $(1 - 2^{-s})^{-1}$。\n\n2.  **分裂素数 ($p \\equiv 1 \\pmod 4$)**：如果 $(\\frac{-1}{p})=1$，即 $p \\equiv 1 \\pmod 4$ 时，素数 $p$ 分裂。这样的素数分裂为两个不同素理想的乘积，$(p) = \\mathfrak{p}\\overline{\\mathfrak{p}}$。两个理想的范数都是 $p$。例如，$(5)=(2+i)(2-i)$。对于这样的素数，欧拉因子贡献 $(1-p^{-s})^{-1}(1-p^{-s})^{-1} = (1-p^{-s})^{-2}$。\n\n3.  **惰性素数 ($p \\equiv 3 \\pmod 4$)**：如果 $(\\frac{-1}{p})=-1$，即 $p \\equiv 3 \\pmod 4$ 时，素数 $p$ 保持为惰性。理想 $(p)$ 本身在 $\\mathbb{Z}[i]$ 中是一个素理想。其范数为 $N((p)) = |N_{\\mathbb{Q}(i)/\\mathbb{Q}}(p)| = p^2$。对应的欧拉因子是 $(1 - (p^2)^{-s})^{-1} = (1 - p^{-2s})^{-1}$。\n\n结合这些情况，我们可以将 $\\zeta_K(s)$ 的欧拉乘积写为：\n$$\n\\zeta_K(s) = (1 - 2^{-s})^{-1} \\prod_{p \\equiv 1 \\pmod 4} (1-p^{-s})^{-2} \\prod_{p \\equiv 3 \\pmod 4} (1-p^{-2s})^{-1}\n$$\n我们现在将其与已知的L-函数联系起来。黎曼zeta函数是 $\\zeta(s) = \\prod_p (1-p^{-s})^{-1}$。设 $\\chi_1$ 是模4的唯一非主狄利克雷特征，定义为：若 $n \\equiv 1 \\pmod 4$，则 $\\chi_1(n) = 1$；若 $n \\equiv 3 \\pmod 4$，则 $\\chi_1(n) = -1$；若 $n$ 为偶数，则 $\\chi_1(n) = 0$。相关的狄利克雷L-函数是 $L(s, \\chi_1) = \\prod_p (1 - \\chi_1(p)p^{-s})^{-1}$。\n考虑乘积 $\\zeta(s) L(s, \\chi_1)$：\n$$\n\\zeta(s)L(s,\\chi_1) = \\prod_{p} \\left( (1-p^{-s})^{-1} (1-\\chi_1(p)p^{-s})^{-1} \\right)\n$$\n-   对于 $p=2$，$\\chi_1(2)=0$，因子为 $(1-2^{-s})^{-1}$。\n-   对于 $p \\equiv 1 \\pmod 4$，$\\chi_1(p)=1$，因子为 $(1-p^{-s})^{-1}(1-p^{-s})^{-1}=(1-p^{-s})^{-2}$。\n-   对于 $p \\equiv 3 \\pmod 4$，$\\chi_1(p)=-1$，因子为 $(1-p^{-s})^{-1}(1+p^{-s})^{-1}=(1-p^{-2s})^{-1}$。\n\n这个乘积与 $\\zeta_K(s)$ 的欧拉乘积逐项匹配。因此，我们建立了基本恒等式 $\\zeta_K(s) = \\zeta(s) L(s, \\chi_1)$。\n\n两个狄利克雷级数乘积的系数由它们各自系数的狄利克雷卷积给出。设 $u(n)=1$ 是 $\\zeta(s)$ 的系数函数，$\\chi_1(n)$ 是 $L(s, \\chi_1)$ 的系数函数。那么，$\\zeta_K(s)$ 的系数 $a_K(n)$ 由以下卷积给出：\n$$\na_K(n) = (u * \\chi_1)(n) = \\sum_{d|n} u(n/d)\\chi_1(d) = \\sum_{d|n} \\chi_1(d)\n$$\n这为 $a_K(n)$ 提供了一个显式的、可计算的公式：它是 $n$ 的所有正因数 $d$ 的 $\\chi_1(d)$ 之和。\n\n**第三部分：算法设计与数值评估**\n\n任务是计算 $A_K(x) = \\sum_{n=1}^{\\lfloor x \\rfloor} a_K(n)$ 以及比率 $R(x) = A_K(x) / (c_K x)$，对几个 $x$ 值进行计算。通过遍历 $n$ 直到 $x$ 并找到每个 $n$ 的所有因数来直接计算 $A_K(x)$ 的效率会很低。一个更好的方法是使用类似筛法的方法，计算出直到所需最大 $x$ 值（记为 $x_{max}$）的所有 $a_K(n)$ 值。\n\n1.  **用于 $a_K(n)$ 的筛法**：我们初始化一个大小为 $x_{max}+1$ 的数组 `a_K_vals`，用于存放 $a_K(n)$ 的值，并全部置零。然后，我们从 $1$ 到 $x_{max}$ 遍历每个整数 $d$。对于每个 $d$，我们计算 $\\chi_1(d)$。如果 $\\chi_1(d)$ 非零，我们将其值（$\\pm 1$）加到 `a_K_vals[n]` 上，其中 $n$ 是 $d$ 的所有不大于 $x_{max}$ 的倍数。这样可以为每个 $n$ 正确地累加和 $\\sum_{d|n} \\chi_1(d)$。\n\n2.  **用于 $A_K(x)$ 的累积和**：一旦填充了 `a_K_vals` 数组，就可以通过对 `a_K_vals` 进行累积求和来高效地计算求和函数 $A_K(x)$ 的值。我们创建一个数组 `A_K_vals`，其中 `A_K_vals[x]` 存储 $\\sum_{n=1}^x a_K(n)$。\n\n3.  **比率计算**：对于所有整数直到 $x_{max}$，预先计算好 $A_K(x)$ 的值后，我们可以为测试套件 $\\{1, 2, 25, 100, 1000, 10000\\}$ 中的每个 $x$ 值直接查找 $A_K(x)$。常数 $c_K = \\pi/4$ 被计算出来。然后为每个测试用例计算比率 $R(x) = A_K(x) / (c_K x)$。\n\n该算法基于推导出的 $a_K(n)$ 公式，高效且准确地计算了所需的量。实现将遵循此设计。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of computing the ideal counting function for the Gaussian\n    integers and comparing it to its asymptotic main term.\n    \"\"\"\n    test_cases = [1, 2, 25, 100, 1000, 10000]\n    x_max = max(test_cases)\n\n    # Part 1: Determine the residue constant c_K for K = Q(i).\n    # As derived in the solution, the invariants for K = Q(i) are:\n    # r1=0, r2=1, h_K=1, R_K=1, w_K=4, d_K=-4.\n    # The residue is c_K = (2^r1 * (2*pi)^r2 * h_K * R_K) / (w_K * sqrt(|d_K|))\n    # c_K = (2^0 * (2*pi)^1 * 1 * 1) / (4 * sqrt(4)) = (2*pi) / 8 = pi / 4.\n    c_K = np.pi / 4\n\n    # Part 2: Derive and implement the formula for a_K(n).\n    # As derived, a_K(n) = sum_{d|n} chi_1(d), where chi_1 is the\n    # non-principal Dirichlet character modulo 4.\n\n    def chi_1(d):\n        \"\"\"Computes the Dirichlet character chi_1(d) modulo 4.\"\"\"\n        if d % 2 == 0:\n            return 0\n        if d % 4 == 1:\n            return 1\n        # This covers the d % 4 == 3 case\n        return -1\n\n    # Part 3: Algorithmic implementation.\n    # Use a sieve method to compute a_K(n) for n from 1 to x_max.\n    # a_K_vals[n] will store the value of a_K(n). Index 0 is unused.\n    a_K_vals = np.zeros(x_max + 1, dtype=np.int32)\n\n    for d in range(1, x_max + 1):\n        chi_d = chi_1(d)\n        if chi_d == 0:\n            continue\n        # Add chi_d to a_K(n) for all multiples n of d.\n        for n in range(d, x_max + 1, d):\n            a_K_vals[n] += chi_d\n\n    # Compute the cumulative sum A_K(x) = sum_{n=x} a_K(n).\n    # A_K_vals[x] will store the value of A_K(x).\n    # np.cumsum computes the cumulative sum. If a_K_vals[0]=0,\n    # then A_K_vals[x] = sum(a_K_vals[0...x]) = sum(a_K_vals[1...x]).\n    A_K_vals = np.cumsum(a_K_vals)\n\n    # Compute the comparison ratios R(x) = A_K(x) / (c_K * x).\n    results = []\n    for x in test_cases:\n        # A_K(x) is stored at index x of our cumulative sum array.\n        A_K_x = A_K_vals[x]\n        \n        # Asymptotic main term approximation\n        main_term = c_K * x\n        \n        # Ratio\n        ratio = A_K_x / main_term\n        results.append(ratio)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3010986"}]}