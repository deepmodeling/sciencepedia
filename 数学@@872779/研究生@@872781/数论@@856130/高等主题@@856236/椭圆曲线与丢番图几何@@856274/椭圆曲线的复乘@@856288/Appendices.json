{"hands_on_practices": [{"introduction": "椭圆曲线论中最著名的一些例子是具有复乘（Complex Multiplication, CM）的曲线。本练习将引导你计算两个标志性的 $j$-不变量：$j(i)$ 和 $j(\\zeta_3)$。我们将利用相应格（高斯整数环和艾森斯坦整数环）的特殊旋转对称性，这一对称性迫使某些格不变量为零，从而直接导出这些著名的 $j$ 值，并找到它们的Weierstrass模型。", "problem": "设 $\\tau$ 是复上半平面的一个元素，并令 $E_{\\tau} = \\mathbb{C}/(\\mathbb{Z} + \\tau \\mathbb{Z})$ 为对应的复椭圆曲线。利用 Weierstrass $\\wp$-函数和相关的格不变量，从 $E_{\\tau}$ 的格不变量定义了绝对不变量 $j(\\tau)$，并且它在 $\\mathrm{SL}_{2}(\\mathbb{Z})$ 的作用下是不变的。从格不变量和绝对不变量的定义出发（不假设任何特殊值），利用 $\\tau = i$ 和 $\\tau = \\zeta_{3}$（一个本原三次单位根）时格的旋转对称性，计算 $j(i)$ 和 $j(\\zeta_{3})$。然后，找出在 $\\mathbb{C}$ 上具有这些 $j$-不变量的椭圆曲线的显式短 Weierstrass 模型，并通过将你的模型与相应的格及对称性联系起来，来证明你的模型实现了所需的不变量。\n\n你的最终数值答案应为有序对 $\\big(j(i), j(\\zeta_{3})\\big)$，以行向量的形式呈现。无需四舍五入。", "solution": "该问题要求计算 $j$-不变量 $j(i)$ 和 $j(\\zeta_3)$，并找出相应的椭圆曲线模型。我们首先回顾基本定义。\n\n对于复上半平面 $\\mathbb{H}$ 中的 $\\tau$，对应的格为 $\\Lambda_{\\tau} = \\mathbb{Z} + \\tau\\mathbb{Z}$。与格 $\\Lambda$ 相关联的 Weierstrass 不变量，或称 Eisenstein 级数，由以下公式给出：\n$$g_2(\\Lambda) = 60 \\sum_{\\omega \\in \\Lambda \\setminus \\{0\\}} \\frac{1}{\\omega^4}$$\n$$g_3(\\Lambda) = 140 \\sum_{\\omega \\in \\Lambda \\setminus \\{0\\}} \\frac{1}{\\omega^6}$$\n这些不变量取决于格的选择。绝对不变量，或称 $j$-不变量，是根据 $g_2$ 和 $g_3$ 定义的：\n$$j(\\Lambda) = 1728 \\frac{g_2(\\Lambda)^3}{g_2(\\Lambda)^3 - 27 g_3(\\Lambda)^2}$$\n分母是格的判别式 $\\Delta(\\Lambda) = g_2(\\Lambda)^3 - 27 g_3(\\Lambda)^2$，对于任何格 $\\Lambda$ 它都是非零的。我们将 $g_2(\\Lambda_\\tau)$ 记作 $g_2(\\tau)$，对 $g_3$ 和 $j$ 也作类似标记。\n\n这些不变量的一个关键性质是它们的齐次性。对于任意非零复数 $c \\in \\mathbb{C}^*$，缩放后的格 $c\\Lambda$ 的不变量与 $\\Lambda$ 的不变量有如下关系：\n$$g_2(c\\Lambda) = c^{-4} g_2(\\Lambda)$$\n$$g_3(c\\Lambda) = c^{-6} g_3(\\Lambda)$$\n\n如果椭圆曲线 $E_{\\Lambda} = \\mathbb{C}/\\Lambda$ 的自同态环严格大于 $\\mathbb{Z}$，则称其具有复乘（CM）。这种情况发生当且仅当格 $\\Lambda$ 具有旋转对称性，即存在一个非整数 $\\alpha \\in \\mathbb{C}$ 使得 $\\alpha\\Lambda \\subseteq \\Lambda$。$\\tau=i$ 和 $\\tau=\\zeta_3$ 的情况是典型的例子。\n\n**$j(i)$ 的计算**\n\n设 $\\tau = i$。对应的格是 $\\Lambda_i = \\mathbb{Z} + i\\mathbb{Z} = \\mathbb{Z}[i]$，即高斯整数环。该格在乘以 $i$ 的运算下是不变的，因为 $i\\Lambda_i = i(\\mathbb{Z} + i\\mathbb{Z}) = i\\mathbb{Z} + i^2\\mathbb{Z} = i\\mathbb{Z} - \\mathbb{Z} = \\mathbb{Z} + i\\mathbb{Z} = \\Lambda_i$。该格表现出4阶旋转对称性。\n\n我们对格 $\\Lambda_i$ 和缩放因子 $c=i$ 应用齐次性：\n$$g_2(i) = g_2(\\Lambda_i) = g_2(i\\Lambda_i) = i^{-4} g_2(\\Lambda_i) = 1 \\cdot g_2(\\Lambda_i) = g_2(i)$$\n这个关系式是一个恒真式，没有提供关于 $g_2(i)$ 的任何信息。\n$$g_3(i) = g_3(\\Lambda_i) = g_3(i\\Lambda_i) = i^{-6} g_3(\\Lambda_i) = (i^2)^3 g_3(\\Lambda_i) = (-1)^3 g_3(\\Lambda_i) = -g_3(i)$$\n关系式 $g_3(i) = -g_3(i)$ 意味着 $2g_3(i)=0$，因此 $g_3(i)=0$。\n\n现在我们可以计算 $j$-不变量 $j(i)$：\n$$j(i) = 1728 \\frac{g_2(i)^3}{g_2(i)^3 - 27 g_3(i)^2} = 1728 \\frac{g_2(i)^3}{g_2(i)^3 - 27 (0)^2} = 1728 \\frac{g_2(i)^3}{g_2(i)^3}$$\n由于 $\\tau = i$ 在复上半平面，判别式 $\\Delta(i) = g_2(i)^3 - 27g_3(i)^2 = g_2(i)^3$ 是非零的。这意味着 $g_2(i) \\neq 0$。因此，我们可以消去 $g_2(i)^3$ 项，得到：\n$$j(i) = 1728$$\n\n**$j(\\zeta_3)$ 的计算**\n\n设 $\\tau = \\zeta_3 = e^{2\\pi i/3} = -\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}$，这是一个满足 $\\zeta_3^2+\\zeta_3+1=0$ 和 $\\zeta_3^3=1$ 的本原三次单位根。对应的格是 $\\Lambda_{\\zeta_3} = \\mathbb{Z} + \\zeta_3\\mathbb{Z} = \\mathbb{Z}[\\zeta_3]$，即 Eisenstein 整数环。该格在乘以 $\\zeta_3$ 的运算下是不变的：\n$\\zeta_3 \\Lambda_{\\zeta_3} = \\zeta_3(\\mathbb{Z} + \\zeta_3\\mathbb{Z}) = \\zeta_3\\mathbb{Z} + \\zeta_3^2\\mathbb{Z} = \\zeta_3\\mathbb{Z} + (-1-\\zeta_3)\\mathbb{Z} = \\mathbb{Z} + \\zeta_3\\mathbb{Z} = \\Lambda_{\\zeta_3}$。该格具有3阶旋转对称性（如果包含取负运算，则为6阶）。\n\n我们对格 $\\Lambda_{\\zeta_3}$ 和缩放因子 $c=\\zeta_3$ 应用齐次性：\n$$g_2(\\zeta_3) = g_2(\\Lambda_{\\zeta_3}) = g_2(\\zeta_3\\Lambda_{\\zeta_3}) = (\\zeta_3)^{-4} g_2(\\Lambda_{\\zeta_3}) = \\zeta_3^2 g_2(\\Lambda_{\\zeta_3})$$\n关系式 $g_2(\\zeta_3) = \\zeta_3^2 g_2(\\zeta_3)$ 可以重写为 $(1-\\zeta_3^2)g_2(\\zeta_3) = 0$。由于 $\\zeta_3^2 \\neq 1$，我们必有 $g_2(\\zeta_3) = 0$。\n$$g_3(\\zeta_3) = g_3(\\Lambda_{\\zeta_3}) = g_3(\\zeta_3\\Lambda_{\\zeta_3}) = (\\zeta_3)^{-6} g_3(\\Lambda_{\\zeta_3}) = (\\zeta_3^3)^{-2} g_3(\\Lambda_{\\zeta_3}) = 1^{-2}g_3(\\Lambda_{\\zeta_3}) = g_3(\\zeta_3)$$\n这个关系式是一个恒真式。\n\n现在我们计算 $j$-不变量 $j(\\zeta_3)$：\n$$j(\\zeta_3) = 1728 \\frac{g_2(\\zeta_3)^3}{g_2(\\zeta_3)^3 - 27 g_3(\\zeta_3)^2} = 1728 \\frac{0^3}{0^3 - 27 g_3(\\zeta_3)^2} = 1728 \\frac{0}{-27 g_3(\\zeta_3)^2}$$\n由于 $\\tau = \\zeta_3$ 在复上半平面，判别式 $\\Delta(\\zeta_3) = g_2(\\zeta_3)^3 - 27g_3(\\zeta_3)^2 = -27g_3(\\zeta_3)^2$ 是非零的。这意味着 $g_3(\\zeta_3) \\neq 0$。因此，该表达式的值为：\n$$j(\\zeta_3) = 0$$\n\n**Weierstrass 模型**\n\n$\\mathbb{C}$ 上的短 Weierstrass 方程形式为 $y^2 = x^3 + Ax + B$。其 $j$-不变量由公式 $j = 1728 \\frac{4A^3}{4A^3 + 27B^2}$ 给出。\n\n对于 $j(i) = 1728$：\n我们寻找系数 $A, B$ 使得 $1728 = 1728 \\frac{4A^3}{4A^3 + 27B^2}$。这可以化简为 $1 = \\frac{4A^3}{4A^3 + 27B^2}$，这意味着 $4A^3 = 4A^3 + 27B^2$，所以 $27B^2 = 0$，即 $B=0$。为使曲线非奇异（即 $j$-不变量是良定的），需要 $4A^3+27B^2 \\neq 0$，这要求 $A \\neq 0$。最简单的选择是 $A=-1$。我们可以选择 $A=1$ 或者 $A=-1$。习惯上，与格不变量直接相关的模型是 $y^2=4x^3-g_2x-g_3$。通过变量替换可以得到短Weierstrass形式 $y^2=x^3+Ax+B$。对于 $j=1728$，一个常见的模型是 $y^2=x^3-x$ 或 $y^2=x^3+x$。我们选择 $y^2 = x^3 + x$。\n因此，一个显式模型是椭圆曲线 $E_i: y^2 = x^3 + x$。\n这个模型的合理性在于它与格对称性的联系。与格 $\\Lambda_i$ 对应的曲线有 $g_3(i)=0$。我们选择的 $B=0$ 模型与任何由 $g_3=0$ 的格定义的曲线同构。这条曲线的自同态环是 $\\mathbb{Z}[i]$，与格的对称性相对应。非平凡自同构是乘以 $i$，它作为4阶自同构作用于曲线坐标：$[i]: (x,y) \\mapsto (-x, iy)$。我们可以验证这一点：$(iy)^2 = (-x)^3 + (-x) \\implies -y^2 = -x^3 - x \\implies y^2 = x^3+x$。\n\n对于 $j(\\zeta_3) = 0$：\n我们寻找系数 $A, B$ 使得 $0 = 1728 \\frac{4A^3}{4A^3 + 27B^2}$。这意味着 $4A^3 = 0$，所以 $A=0$。为保证非奇异性，需要 $4A^3+27B^2 \\neq 0$，这要求 $B \\neq 0$。最简单的选择是 $B=1$。\n因此，一个显式模型是椭圆曲线 $E_{\\zeta_3}: y^2 = x^3 + 1$。\n这个模型的合理性在于它与格对称性的联系。与格 $\\Lambda_{\\zeta_3}$ 对应的曲线有 $g_2(\\zeta_3)=0$。我们选择的 $A=0$ 模型与任何由 $g_2=0$ 的格定义的曲线同构。自同态环是 $\\mathbb{Z}[\\zeta_3]$。非平凡自同构是乘以 $\\zeta_3$，它作为3阶自同构作用于曲线坐标：$[\\zeta_3]: (x,y) \\mapsto (\\zeta_3 x, y)$。我们验证这一点：$y^2 = (\\zeta_3 x)^3 + 1 \\implies y^2 = \\zeta_3^3 x^3 + 1 \\implies y^2 = x^3 + 1$。\n\n最终答案是有序对 $(j(i), j(\\zeta_3))$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1728  0\n\\end{pmatrix}\n}\n$$", "id": "3010320"}, {"introduction": "在上一个练习[@problem_id:3010320]中，我们看到判别式为-4和-3的CM椭圆曲线分别对应唯一的 $j$-不变量。这个练习将探讨其背后的深刻原因。我们将通过计算既约二次型的数量来确定几个虚二次域的类数，并揭示这个纯粹的数论量如何精确地对应于具有相应复乘的椭圆曲线的同构类数量。", "problem": "设 $D0$ 为一个负基本判别式，并令 $\\mathcal{O}_{D}$ 表示虚二次域 $\\mathbb{Q}(\\sqrt{D})$ 中判别式为 $D$ 的虚二次序。理想类群 $\\mathrm{Cl}(\\mathcal{O}_{D})$ 可被等同于判别式为 $D=b^{2}-4ac$ 的本原正定二元二次型 $f(x,y)=ax^{2}+bxy+cy^{2}$ 在 $\\mathrm{SL}_{2}(\\mathbb{Z})$ 作用下的等价类构成的群，其复合运算由高斯复合给出。如果一个二次型满足正定型的标准简约不等式，即 $|b|\\leq a\\leq c$，并且在 $|b|=a$ 或 $a=c$ 的情况下有 $b\\geq 0$，则称该二次型是简约的。\n\n从这些基本定义出发，通过明确列出相应判别式的所有简约本原正定二元二次型，并利用高斯的对应关系推断其群结构，来确定 $D=-3$, $D=-4$, $D=-7$ 和 $D=-8$ 的类群 $\\mathrm{Cl}(\\mathcal{O}_{D})$。然后，利用 $\\mathrm{Cl}(\\mathcal{O}_{D})$ 与具有 $\\mathcal{O}_{D}$ 复乘（CM）的复环面同构类集合（等价地，其自同态环为 $\\mathcal{O}_{D}$ 的 $\\mathbb{C}$ 上椭圆曲线的同构类集合）之间的等同关系，解释为什么你得到的大小等于由 $\\mathcal{O}_{D}$ 复乘产生的不同 $j$-不变量的数量。\n\n你的最终答案必须是行向量 $\\big(h(-3),\\,h(-4),\\,h(-7),\\,h(-8)\\big)$，其中 $h(D)=|\\mathrm{Cl}(\\mathcal{O}_{D})|$ 表示类数。无需进行舍入。", "solution": "该问题要求两部分：首先，通过找出所有简约本原正定二元二次型，来计算基本判别式 $D = -3, -4, -7, -8$ 的类数 $h(D) = |\\mathrm{Cl}(\\mathcal{O}_{D})|$；其次，解释这个数与具有 $\\mathcal{O}_{D}$ 序复乘（CM）的椭圆曲线的不同 $j$-不变量数量之间的联系。\n\n一个二元二次型 $f(x,y) = ax^2 + bxy + cy^2$ 的判别式为 $D = b^2 - 4ac$。对于 $D  0$，如果 $a > 0$，则该二次型是正定的。如果 $\\gcd(a, b, c) = 1$，则称该二次型是本原的。这类二次型在 $\\mathrm{SL}_{2}(\\mathbb{Z})$ 作用下的等价类集合构成一个有限阿贝尔群，是理想类群 $\\mathrm{Cl}(\\mathcal{O}_D)$ 的一个具体实现。每个等价类中恰好包含一个简约型，它满足以下条件：\n1. $|b| \\leq a \\leq c$\n2. 如果 $|b| = a$ 或 $a = c$，则 $b \\geq 0$。\n\n从判别式方程 $D = b^2 - 4ac$ 和简约条件，我们可以推导出系数的界。由于 $a \\leq c$，我们有 $4a^2 \\leq 4ac = b^2 - D$。由于 $|b| \\leq a$，我们有 $b^2 \\leq a^2$。将这些结合起来得到 $4a^2 \\leq a^2 - D$，化简为 $3a^2 \\leq -D = |D|$。这就得出了系数 $a$ 的一个上界：\n$$a \\leq \\sqrt{\\frac{|D|}{3}}$$\n由于 $a$ 必须是正整数，这个不等式使得寻找简约型的过程是有限的。此外，对于一个基本判别式 $D$，系数 $b$ 必须与 $D$ 有相同的奇偶性，即 $b \\equiv D \\pmod{2}$。\n\n我们现在为每个给定的判别式枚举其简约型。\n\n**情况1：$D = -3$**\n这是一个基本判别式。我们寻找满足条件的整数三元组 $(a, b, c)$。\n- $a$ 的界是 $a \\leq \\sqrt{\\frac{|-3|}{3}} = \\sqrt{1} = 1$。由于 $a0$，我们必有 $a=1$。\n- 条件 $|b| \\leq a$ 意味着 $|b| \\leq 1$。\n- 判别式 $D=-3$ 是奇数，所以 $b$ 必须是奇数。这剩下 $b=1$ 和 $b=-1$。\n- 对于 $b=1$：我们计算 $c = \\frac{b^2 - D}{4a} = \\frac{1^2 - (-3)}{4(1)} = \\frac{4}{4} = 1$。该二次型为 $(1, 1, 1)$。\n  - 我们检查简约条件：$|1| \\leq 1 \\leq 1$ 为真。由于 $a=c=1$，我们必须有 $b \\geq 0$。$b=1$ 满足此条件。\n  - 该二次型是本原的，因为 $\\gcd(1,1,1)=1$。\n  - 因此，$x^2 + xy + y^2$ 是一个简约本原二次型。\n- 对于 $b=-1$：该二次型将是 $(1,-1,1)$。这里，$a=c=1$，要求 $b \\geq 0$。这不被满足，所以这个二次型不是简约的。\n我们恰好找到了一个简约型。因此，类数为 $h(-3) = 1$。\n\n**情况2：$D = -4$**\n这是一个基本判别式。\n- $a$ 的界是 $a \\leq \\sqrt{\\frac{|-4|}{3}} \\approx 1.15$。我们必有 $a=1$。\n- 条件 $|b| \\leq a$ 意味着 $|b| \\leq 1$。\n- 判别式 $D=-4$ 是偶数，所以 $b$ 必须是偶数。这只剩下 $b=0$。\n- 对于 $b=0$：我们计算 $c = \\frac{b^2 - D}{4a} = \\frac{0^2 - (-4)}{4(1)} = \\frac{4}{4} = 1$。该二次型为 $(1, 0, 1)$。\n  - 我们检查简约条件：$|0| \\leq 1 \\leq 1$ 为真。由于 $a=c=1$，我们必须有 $b \\geq 0$。$b=0$ 满足此条件。\n  - 该二次型是本原的，因为 $\\gcd(1,0,1)=1$。\n  - 因此，$x^2 + y^2$ 是一个简约本原二次型。\n我们恰好找到了一个简约型。因此，类数为 $h(-4) = 1$。\n\n**情况3：$D = -7$**\n这是一个基本判别式。\n- $a$ 的界是 $a \\leq \\sqrt{\\frac{|-7|}{3}} \\approx 1.52$。我们必有 $a=1$。\n- 条件 $|b| \\leq a$ 意味着 $|b| \\leq 1$。\n- 判别式 $D=-7$ 是奇数，所以 $b$ 必须是奇数。这剩下 $b=1$ 和 $b=-1$。\n- 对于 $b=1$：我们计算 $c = \\frac{b^2 - D}{4a} = \\frac{1^2 - (-7)}{4(1)} = \\frac{8}{4} = 2$。该二次型为 $(1, 1, 2)$。\n  - 我们检查简约条件：$|1| \\leq 1 \\leq 2$ 为真。由于 $|b|=a=1$，我们必须有 $b \\geq 0$。$b=1$ 满足此条件。\n  - 该二次型是本原的，因为 $\\gcd(1,1,2)=1$。\n  - 因此，$x^2 + xy + 2y^2$ 是一个简约本原二次型。\n- 对于 $b=-1$：该二次型是 $(1,-1,2)$。这里 $|b|=a=1$，要求 $b \\geq 0$。这不被满足。\n我们恰好找到了一个简约型。因此，类数为 $h(-7) = 1$。\n\n**情况4：$D = -8$**\n这是一个基本判别式。\n- $a$ 的界是 $a \\leq \\sqrt{\\frac{|-8|}{3}} \\approx 1.63$。我们必有 $a=1$。\n- 条件 $|b| \\leq a$ 意味着 $|b| \\leq 1$。\n- 判别式 $D=-8$ 是偶数，所以 $b$ 必须是偶数。这只剩下 $b=0$。\n- 对于 $b=0$：我们计算 $c = \\frac{b^2 - D}{4a} = \\frac{0^2 - (-8)}{4(1)} = \\frac{8}{4} = 2$。该二次型为 $(1, 0, 2)$。\n  - 我们检查简约条件：$|0| \\leq 1 \\leq 2$ 为真。边界情况 $|b|=a$ 和 $a=c$ 不适用。\n  - 该二次型是本原的，因为 $\\gcd(1,0,2)=1$。\n  - 因此，$x^2 + 2y^2$ 是一个简约本原二次型。\n我们恰好找到了一个简约型。因此，类数为 $h(-8) = 1$。\n\n在所有四种情况下，类数都是 1。\n\n**与复乘和 $j$-不变量的联系**\n\n复乘理论在虚二次序的类群与椭圆曲线的算术之间建立了深刻的联系。\n\n1. 复数域 $\\mathbb{C}$ 上的一个椭圆曲线 $E$ 同构于一个复环面 $\\mathbb{C}/\\Lambda$，其中 $\\Lambda$ 是某个格。任何这样的格都位似于 $\\Lambda_{\\tau} = \\mathbb{Z} + \\mathbb{Z}\\tau$ 形式的格，其中 $\\tau$ 唯一地位于 $\\mathrm{SL}_2(\\mathbb{Z})$ 作用于上半平面 $\\mathbb{H}$ 的基本域中。$E$ 的同构类由其 $j$-不变量 $j(E) = j(\\tau)$ 唯一确定。\n\n2. 如果一个椭圆曲线 $E$ 的自同态环 $\\operatorname{End}(E)$ 同构于虚二次域中的一个序 $\\mathcal{O}$，则称 $E$ 具有 $\\mathcal{O}$ 的复乘（CM）。对于一般的曲线，$\\operatorname{End}(E) \\cong \\mathbb{Z}$。\n\n3. CM 理论的一个关键结果是，一个椭圆曲线 $E \\cong \\mathbb{C}/(\\mathbb{Z} + \\mathbb{Z}\\tau)$ 具有 $\\mathcal{O}_D$ 序的 CM，当且仅当 $\\tau$ 是虚二次域 $K = \\mathbb{Q}(\\sqrt{D})$ 中的一个元素。\n\n4. 具有特定序 $\\mathcal{O}_D$ 复乘的椭圆曲线的同构类集合不是任意的。在理想类群 $\\mathrm{Cl}(\\mathcal{O}_D)$ 和具有 $\\mathcal{O}_D$ 复乘的椭圆曲线同构类集合之间存在一个典范双射。一个理想类 $[\\mathfrak{a}] \\in \\mathrm{Cl}(\\mathcal{O}_D)$ 对应于椭圆曲线 $\\mathbb{C}/\\mathfrak{a}$ 的同构类。两个这样的曲线 $\\mathbb{C}/\\mathfrak{a}$ 和 $\\mathbb{C}/\\mathfrak{b}$ 同构，当且仅当理想 $\\mathfrak{a}$ 和 $\\mathfrak{b}$ 属于同一个理想类。\n\n5. 综合这些事实，具有 $\\mathcal{O}_D$ 复乘的椭圆曲线的不同同构类的数量等于类群的阶，即 $h(D) = |\\mathrm{Cl}(\\mathcal{O}_D)|$。由于 $\\mathbb{C}$ 上的同构类与其 $j$-不变量一一对应，因此，具有 $\\mathcal{O}_D$ 复乘的椭圆曲线的不同 $j$-不变量的数量恰好是 $h(D)$。\n\n在我们的例子中，我们发现 $h(-3) = 1$, $h(-4) = 1$, $h(-7) = 1$ 和 $h(-8) = 1$。这意味着对于相应的序 $\\mathcal{O}_{-3}$, $\\mathcal{O}_{-4}$, $\\mathcal{O}_{-7}$ 和 $\\mathcal{O}_{-8}$，都恰好只有一个具有该序复乘的椭圆曲线同构类，因此也只有一个唯一的 $j$-不变量。例如：\n- 对于 $D=-3$，序为 $\\mathcal{O}_{-3}=\\mathbb{Z}[\\frac{1+\\sqrt{-3}}{2}]$。相应的 $j$-不变量是 $j(\\frac{1+\\sqrt{-3}}{2}) = 0$。\n- 对于 $D=-4$，序为 $\\mathcal{O}_{-4}=\\mathbb{Z}[\\sqrt{-1}]$。相应的 $j$-不变量是 $j(i) = 1728$。\n由 $\\mathcal{O}_D$ 复乘产生的不同 $j$-不变量的数量是 $h(D)$，这是我们通过计算简约二次型的数量得到的。这在这两种计数之间提供了一座直接的桥梁。\n\n最终答案是计算出的类数的行向量。\n$h(-3)=1$\n$h(-4)=1$\n$h(-7)=1$\n$h(-8)=1$\n所以向量是 $(1, 1, 1, 1)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1  1  1\n\\end{pmatrix}\n}\n$$", "id": "3010294"}, {"introduction": "复乘理论的威力远不止于复数域，它对有限域上的椭圆曲线算术有着深远影响。本练习将这一联系具体化：我们将一个CM椭圆曲线模一个素数进行约化，并显式构造一个同源。通过检验该同源与CM自同态的相互作用，你将能够将其分类为“水平”同源，从而亲手体验CM同源火山的结构。", "problem": "设 $K = \\mathbb{Q}(i)$，并令 $\\mathcal{O}_{K} = \\mathbb{Z}[i]$ 表示其整数环，其判别式为 $D_{K} = -4$。考虑 $j$-不变量为 $j(E_{0})=1728$ 的复乘（CM）椭圆曲线 $E_{0}/\\mathbb{Q}$，其由短 Weierstrass 模型 $E_{0}: y^{2} = x^{3} + x$ 给出。设 $p=5$，它是 $E_{0}$ 的一个善约化素数，并考虑 $E_{0}$ 模 $p$ 的约化 $E/\\mathbb{F}_{5}$，即有限域 $\\mathbb{F}_{5}$ 上的椭圆曲线 $E: y^{2} = x^{3} + x$。设 $\\ell = 2$。\n\n从椭圆曲线、同源和复乘的基本定义出发，并仅使用经过充分检验的通用公式（例如用于从核构造同源的 Vélu 公式）作为工具，完成以下任务：\n\n1. 显式构造一个阶为 $\\ell=2$ 的循环子群 $G \\subset E(\\overline{\\mathbb{F}}_{5})$，作为 $\\ell$ 次同源 $\\varphi: E \\to E'$ 的核，并验证 $G$ 在 $\\mathbb{F}_{5}$ 上是有理的。\n\n2. 使用 Vélu 公式，计算在 $\\mathbb{F}_{5}$ 上的 $2$ 次同源 $\\varphi: E \\to E' = E/G$ 的显式有理映射，并确定上域曲线 $E'$ 的一个短 Weierstrass 模型。\n\n3. 使用针对平常约化的 CM 同源火山理论，将与 $\\varphi$ 对应的 $\\ell$-边分类为上升、水平或下降。您的分类必须从复乘背景的第一性原理出发进行论证：讨论 $\\ell$ 在 $K$ 中的分裂或分歧行为，自同态环 $\\operatorname{End}(E)$ 的导子，以及这些如何决定火山图中 $\\ell$-同源边的性质。\n\n4. 最后，报告上域曲线的 $j$-不变量 $j(E')$ 的值作为您的最终答案。以精确形式给出最终答案（无需四舍五入）。", "solution": "解答过程按顺序处理这四个任务。\n\n### 第 1 部分：核子群 $G$ 的构造与验证\n\n问题要求构造一个阶为 $\\ell=2$ 的循环子群 $G \\subset E(\\overline{\\mathbb{F}}_{5})$。曲线为 $\\mathbb{F}_{5}$ 上的 $E: y^{2} = x^{3} + x$。\n$E$ 上的 2 阶点是满足 $2P=\\mathcal{O}$ 且 $P \\neq \\mathcal{O}$ 的点 $P=(x,y)$。这些点的 $y$ 坐标为 $y=0$。其 $x$ 坐标是多项式 $x^{3}+x=0$ 在 $\\mathbb{F}_{5}$ 中的根。\n$$x^{3}+x = x(x^{2}+1) = 0$$\n通过将每个因子设为零来求根：\n1.  $x=0$。\n2.  $x^{2}+1=0 \\implies x^{2}=-1 \\equiv 4 \\pmod 5$。解为 $x = \\pm \\sqrt{4}$，即 $x=2$ 和 $x=-2 \\equiv 3 \\pmod 5$。\n\n三个 2 阶点是 $P_{1}=(0,0)$、$P_{2}=(2,0)$ 和 $P_{3}=(3,0)$。一个 2 阶循环子群的形式为 $G = \\{\\mathcal{O}, P\\}$，其中 $P$ 是一个 2 阶点。我们选择 $P=P_{1}=(0,0)$，因此我们的核是 $G = \\{\\mathcal{O}, (0,0)\\}$。\n\n为了验证 $G$ 在 $\\mathbb{F}_{5}$ 上是有理的，我们必须证明 $G$ 在 Galois 群 $\\operatorname{Gal}(\\overline{\\mathbb{F}}_{5}/\\mathbb{F}_{5})$ 的作用下是不变的。这个群由绝对 Frobenius 自同构 $\\pi_{5}: (x, y) \\mapsto (x^{5}, y^{5})$ 生成。如果一个子群的所有点都定义在 $\\mathbb{F}_{5}$ 上，则该子群是有理的。点 $(0,0)$ 的坐标在素域 $\\mathbb{F}_{5}$ 中，因此它是一个 $\\mathbb{F}_{5}$-有理点。无穷远点 $\\mathcal{O}$ 也在 $\\mathbb{F}_{5}$ 上有理。因此，子群 $G = \\{\\mathcal{O}, (0,0)\\}$ 是一个有理子群，因为它是 $E(\\mathbb{F}_{5})$ 的一个子集。\n\n### 第 2 部分：同源与上域曲线的计算\n\n我们使用 Vélu 公式计算核为 $G = \\{\\mathcal{O}, Q_{0}\\}$（其中 $Q_{0}=(x_{0},y_{0}) = (0,0)$）的 2 次同源 $\\varphi: E \\to E' = E/G$。初始曲线为 $\\mathbb{F}_{5}$ 上的 $E: y^{2}=x^{3}+Ax+B$，其中 $A=1$，$B=0$。\n\n对于由一个 2 阶点 $Q_{0}=(x_{0},0)$ 生成的核，同源映射 $\\varphi: (x,y) \\mapsto (X,Y)$ 由以下公式给出：\n$$X = x + \\frac{3x_{0}^{2}+A}{x-x_{0}}$$\n$$Y = y\\left(1 - \\frac{3x_{0}^{2}+A}{(x-x_{0})^{2}}\\right)$$\n代入 $x_{0}=0$ 和 $A=1$（所有计算都在 $\\mathbb{F}_{5}$ 中进行）：\n$$X = x + \\frac{3(0)^{2}+1}{x-0} = x + \\frac{1}{x}$$\n$$Y = y\\left(1 - \\frac{3(0)^{2}+1}{(x-0)^{2}}\\right) = y\\left(1 - \\frac{1}{x^{2}}\\right)$$\n$\\varphi$ 的显式有理映射为 $\\varphi(x,y) = \\left(x+\\frac{1}{x}, y\\left(1-\\frac{1}{x^{2}}\\right)\\right)$。\n\n为了找到上域曲线 $E'$ 的方程，我们将 $Y^{2}$ 用 $X$ 表示。\n对于从 $y^2 = x^3+Ax+B$ 出发、核由 $(x_0, 0)$ 生成的同源，其上域的一个已知公式是 $Y^2 = X^3 + A'X + B'$，其中 $A' = A - 5(3x_0^2+A)$ 和 $B' = B - 7(x_0(3x_0^2+A))$。\n在 $\\mathbb{F}_{5}$ 中，这些系数简化为 $A' = A$ 和 $B' = B - 2(x_0(3x_0^2+A))$。\n代入 $A=1, B=0, x_0=0$：\n$$A' = 1$$\n$$B' = 0 - 2(0 \\cdot (3(0)^2+1)) = 0$$\n因此，上域曲线为 $E': y^{2} = x^{3}+x$。这与原始曲线 $E$ 同构。\n\n### 第 3 部分：同源边的分类\n\nCM 同源火山中一条 $\\ell$-同源边（上升、水平或下降）的分类取决于定义域曲线和上域曲线的自同态环。\n\n首先，我们确定 $E/\\mathbb{F}_{5}$ 的自同态环。曲线 $E_{0}/\\mathbb{Q}$ 具有被 $K=\\mathbb{Q}(i)$ 中的极大整环 $\\mathcal{O}_{K} = \\mathbb{Z}[i]$ 的复乘。$K$ 的判别式是 $D_{K}=-4$。约化素数是 $p=5$。为了确定约化是平常的还是超奇异的，我们检查 $p$ 在 $K$ 中是分裂、惰性还是分歧。这由勒让德符号 $(\\frac{D_{K}}{p})$ 决定：\n$$\\left(\\frac{-4}{5}\\right) = \\left(\\frac{-1}{5}\\right)\\left(\\frac{4}{5}\\right) = (-1)^{\\frac{5-1}{2}} \\cdot \\left(\\frac{2^2}{5}\\right) = (-1)^{2} \\cdot 1 = 1$$\n由于该符号为 1，素数 $p=5$ 在 $K$ 中分裂。根据复乘理论，这意味着约化 $E/\\mathbb{F}_{5}$ 是平常的，且其自同态环是极大整环 $\\mathcal{O}_{K}$。因此，$\\operatorname{End}(E) \\cong \\mathbb{Z}[i]$。自同态环为极大整环的曲线位于同源火山的“火山口”（0 层）。\n\n接下来，我们分析同源素数 $\\ell=2$。在环 $\\mathbb{Z}[i]$ 中，素数 $2$ 是分歧的，因为 $2 = -i(1+i)^{2}$，其中 $1+i$ 是一个范数为 2 的素元。理想分解为 $(2) = (1+i)^{2}$。同源火山理论指出，对于一个分歧素数 $\\ell$，从火山口上的任何一条曲线出发，都有一条水平 $\\ell$-同源。\n\n如果一个同源的核是 $\\mathcal{O}_{K}$-子模，则该同源是水平的。如果其核不是 $\\mathcal{O}_{K}$-子模，则它是下降的。我们必须检验我们的核 $G=\\{\\mathcal{O}, (0,0)\\}$ 是否是一个 $\\mathcal{O}_{K}$-子模。\n环 $\\mathcal{O}_{K}=\\mathbb{Z}[i]$ 是由 $i$ 作为 $\\mathbb{Z}$-代数生成的。所以我们只需要检查 $G$ 在自同态 $[i]$ 的作用下是否是稳定的。\n在 $\\mathbb{C}$ 上，$E_{0}: y^{2}=x^{3}+x$ 的 CM 自同态 $[i]$ 由 $[i](x,y)=(-x,iy)$ 给出。在 $\\mathbb{F}_{5}$ 上，我们需要一个值 $\\gamma$ 使得 $\\gamma^{2}=-1 \\pmod 5$。我们可以选择 $\\gamma=2$，因为 $2^{2}=4 \\equiv -1$。因此，$[i]$ 在 $E/\\mathbb{F}_{5}$ 上的作用是 $[i](x,y) = (-x, 2y)$。\n让我们将此应用于 $G$ 中的非单位元 $(0,0)$：\n$$[i](0,0) = (-0, 2 \\cdot 0) = (0,0)$$\n由于 $[i](0,0) \\in G$，并且平凡地有 $[1](0,0)=(0,0) \\in G$，所以 $G$ 在 $\\operatorname{End}(E) = \\mathbb{Z}[i]$ 的任何元素的作用下都是封闭的。因此，$G$ 是一个 $\\mathcal{O}_{K}$-子模。\n\n因为它的核是一个 $\\mathcal{O}_{K}$-子模，所以同源 $\\varphi:E \\to E/G$ 是一个**水平**同源。这个理论结论与我们在第 2 部分中的计算结果一致，即上域曲线 $E'$ 与定义域曲线 $E$同构（因此具有相同的 $j$-不变量），这对于水平同源总是成立的。\n\n### 第 4 部分：上域曲线的 $j$-不变量\n\n在第 2 部分中，我们确定了 $\\mathbb{F}_{5}$ 上的上域曲线 $E'$ 具有 Weierstrass 模型 $y^{2}=x^{3}+x$。曲线 $y^{2}=x^{3}+Ax+B$ 的 $j$-不变量由公式 $j = 1728 \\frac{4A^{3}}{4A^{3}+27B^{2}}$ 给出。\n对于 $E'$，我们有 $A=1$ 和 $B=0$。其 $j$-不变量是：\n$$j(E') = 1728 \\frac{4(1)^{3}}{4(1)^{3}+27(0)^{2}} = 1728$$\n这是该椭圆曲线同构类的 $j$-不变量在特征零下的值。同源 $\\varphi$ 是水平的，这意味着 $j(E') = j(E)$。曲线 $E$ 是 $E_0/\\mathbb{Q}$ 模 5 的约化，而已知 $j(E_0)=1728$。在 $\\mathbb{F}_5$ 中，$j$-不变量的值是 $1728 \\equiv 3 \\pmod 5$。由于问题要求以精确形式给出 $j$-不变量的值，并且问题关联了 $\\mathbb{Q}$ 和 $\\mathbb{F}_p$ 上的对象，因此导出有限域值的那个整数值是最完整的答案。", "answer": "$$\\boxed{1728}$$", "id": "3010318"}]}