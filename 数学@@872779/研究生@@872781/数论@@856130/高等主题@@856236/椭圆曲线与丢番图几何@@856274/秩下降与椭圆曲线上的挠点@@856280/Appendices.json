{"hands_on_practices": [{"introduction": "理解椭圆曲线的算术性质始于其局部性质。本练习将指导你通过计算判别式来确定坏素数（即坏约化素数），这是L函数理论和下降方法中的关键第一步。通过完成这个基础计算 [@problem_id:3022305]，你将亲身体验判别椭圆曲线结构在何处表现出特殊行为的准则。", "problem": "设 $E$ 为有理数域 $\\mathbb{Q}$ 上的椭圆曲线，由短魏尔斯特拉斯方程 $y^{2} = x^{3} + Ax + B$ 给出，其中 $A = -91$ 且 $B = 140$。如果一条 $\\mathbb{Q}$ 上的椭圆曲线模 $p$ 的约化是非奇异的，则称其在有理素数 $p$ 处具有好约化，否则称为坏约化。对于一个整魏尔斯特拉斯模型，约化的非奇异性由判别式 $\\Delta$ 决定，对于短魏尔斯特拉斯形式，该判别式由公式\n$$\n\\Delta = -16\\left(4A^{3} + 27B^{2}\\right)\n$$\n定义。请仅使用基本事实和定义——特别是，坏约化的有理素数集合恰好是整除 $E$ 的最小判别式的素数集合——完成以下任务：\n\n1. 解释为什么对于给定的系数 $A = -91$ 和 $B = 140$，该短整魏尔斯特拉斯模型在所有有理素数处都是极小的。你的解释必须从模 $p$ 约化、非奇异性以及容许的整变量代换对判别式赋值的影响的定义出发，并且必须在不引用任何未经证明的捷径准则的情况下，证明其在所有素数处的极小性。\n\n2. 计算判别式 $\\Delta$ 并将其分解为素数幂的乘积。\n\n3. 通过识别整除 $\\Delta$ 的素数，得出 $E$ 的坏约化有理素数集合。\n\n你的最终答案必须将坏素数集合以单行矩阵的形式列出，素数按升序排列，并使用 LaTeX 的 $\\mathrm{pmatrix}$ 环境书写。无需四舍五入。", "solution": "椭圆曲线 $E$ 在 $\\mathbb{Q}$ 上由整魏尔斯特拉斯模型 $y^{2} = x^{3} + Ax + B$ 给出，系数为 $A = -91$ 和 $B = 140$。问题要求三件事：证明该模型在所有素数处的极小性，计算并分解其判别式 $\\Delta$，以及求出坏约化素数集合。\n\n一条在 $\\mathbb{Q}$ 上的椭圆曲线可以由许多不同的整魏尔斯特拉斯模型表示，所有这些模型在 $\\mathbb{Q}$ 上都是同构的。如果一个模型的判别式的 $p$-adic 赋值（记为 $v_p(\\Delta)$）在所有与 $E$ 在 $\\mathbb{Q}$ 上同构的整模型中是最小的，则称该模型在素数 $p$ 处是极小的。$E$ 的坏约化素数集合是其最小判别式的素因子集合。\n\n我们首先根据要求，从第一性原理出发建立一个极小性判据。$E$ 的任意两个魏尔斯特拉斯模型都通过一个容许的变量代换相关联：\n$$\nx = u^{2}x' + r, \\quad y = u^{3}y' + su^{2}x' + t\n$$\n其中 $u, r, s, t \\in \\mathbb{Q}$ 且 $u \\neq 0$。新模型 $\\Delta'$ 的判别式与原模型 $\\Delta$ 的判别式通过公式 $\\Delta' = u^{-12}\\Delta$ 相关。\n对于一个给定的判别式为 $\\Delta$ 的模型，若其在素数 $p$ 处非极小，则必须存在另一个同构的整模型，其判别式为 $\\Delta'$，使得 $v_p(\\Delta')  v_p(\\Delta)$。根据判别式的变换公式，这等价于：\n$$\nv_p(u^{-12}\\Delta)  v_p(\\Delta) \\implies -12v_p(u) + v_p(\\Delta)  v_p(\\Delta) \\implies -12v_p(u)  0 \\implies v_p(u) > 0\n$$\n因此，一个在 $p$ 处非极小的模型可以通过一个变量代换转换为一个“更极小”的模型，其中 $u \\in \\mathbb{Q}$ 的 $p$-adic 赋值为正。由于 $v_p(u)$ 必须是一个整数（因为 $u$ 是有理数），这意味着 $v_p(u) \\ge 1$。\n此外，为使新模型成为一个整模型，其判别式 $\\Delta'$ 必须是整数。这意味着 $v_p(\\Delta') \\ge 0$。\n现在考虑条件 $v_p(\\Delta') = v_p(\\Delta) - 12v_p(u)$。如果一个模型在 $p$ 处不是极小的，则存在一个变量代换，其中 $v_p(u) \\ge 1$，从而得到一个新的整模型。对于这个新模型，我们必须有 $v_p(\\Delta') \\ge 0$，这意味着：\n$$\nv_p(\\Delta) - 12v_p(u) \\ge 0 \\implies v_p(\\Delta) \\ge 12v_p(u)\n$$\n由于 $v_p(u) \\ge 1$，一个模型在 $p$ 处非极小的必要条件是 $v_p(\\Delta) \\ge 12$。该命题的逆否命题为极小性提供了一个充分条件：如果对于素数 $p$ 有 $v_p(\\Delta)  12$，则该模型在 $p$ 处必定是极小的。我们将使用这个准则来证明给定模型在所有素数处的极小性。\n\n为了应用这个准则，我们必须首先计算给定模型的判别式 $\\Delta$。对于短魏尔斯特拉斯方程 $y^2 = x^3 + Ax + B$，其判别式公式为 $\\Delta = -16(4A^3 + 27B^2)$。\n给定的系数是 $A = -91$ 和 $B = 140$。我们将它们分解为素数：\n$A = -91 = -7 \\times 13$\n$B = 140 = 14 \\times 10 = (2 \\times 7) \\times (2 \\times 5) = 2^2 \\times 5 \\times 7$\n\n现在我们计算 $4A^3 + 27B^2$ 这一项：\n$$\n4A^3 + 27B^2 = 4(-7 \\times 13)^3 + 27(2^2 \\times 5 \\times 7)^2\n$$\n$$\n= 4(-1)(7^3 \\times 13^3) + (3^3)(2^4 \\times 5^2 \\times 7^2)\n$$\n$$\n= -2^2 \\times 7^3 \\times 13^3 + 3^3 \\times 2^4 \\times 5^2 \\times 7^2\n$$\n我们提取公因式 $2^2 \\times 7^2$：\n$$\n= (2^2 \\times 7^2) \\left[ -7 \\times 13^3 + 3^3 \\times 2^2 \\times 5^2 \\right]\n$$\n我们计算括号内的值：\n$13^3 = 2197$\n$-7 \\times 13^3 = -7 \\times 2197 = -15379$\n$3^3 \\times 2^2 \\times 5^2 = 27 \\times 4 \\times 25 = 27 \\times 100 = 2700$\n所以括号中的表达式为 $-15379 + 2700 = -12679$。\n因此，\n$$\n4A^3 + 27B^2 = 2^2 \\times 7^2 \\times (-12679)\n$$\n现在我们可以计算判别式 $\\Delta$：\n$$\n\\Delta = -16(4A^3 + 27B^2) = -16 \\left[ 2^2 \\times 7^2 \\times (-12679) \\right]\n$$\n$$\n= -2^4 \\left[ - C \\right] = 2^4 \\times 2^2 \\times 7^2 \\times 12679 = 2^6 \\times 7^2 \\times 12679\n$$\n为了完成因式分解，我们必须分解 $12679$。通过尝试小的素因数，我们发现 $12679 = 31 \\times 409$。数字 $409$ 是一个素数，这可以通过检查直到 $\\sqrt{409} \\approx 20.2$ 的素因数来验证。\n判别式的最终素因数分解是：\n$$\n\\Delta = 2^6 \\times 7^2 \\times 31^1 \\times 409^1\n$$\n\n计算并分解了 $\\Delta$ 后，我们回到极小性的证明。我们检查 $\\Delta$ 的每个素因子的 $p$-adic 赋值：\n\\begin{itemize}\n    \\item 对于 $p=2$，$v_2(\\Delta) = 6$。因为 $6  12$，模型在 $p=2$ 处是极小的。\n    \\item 对于 $p=7$，$v_7(\\Delta) = 2$。因为 $2  12$，模型在 $p=7$ 处是极小的。\n    \\item 对于 $p=31$，$v_{31}(\\Delta) = 1$。因为 $1  12$，模型在 $p=31$ 处是极小的。\n    \\item 对于 $p=409$，$v_{409}(\\Delta) = 1$。因为 $1  12$，模型在 $p=409$ 处是极小的。\n\\end{itemize}\n对于任何其他素数 $p$，$p$ 不整除 $\\Delta$，所以 $v_p(\\Delta) = 0$，这也小于 $12$。\n由于对所有素数 $p$ 都有 $v_p(\\Delta)  12$，我们得出结论，给定的整魏尔斯特拉斯模型 $y^2 = x^3 - 91x + 140$ 在所有有理素数处都是极小的。\n\n最后，我们确定坏约化的有理素数集合。问题指出，这是整除 $E$ 的最小判别式的素数集合。既然我们已经确定了我们模型的判别式 $\\Delta$ 是一个最小判别式，那么坏约化的素数就恰好是 $\\Delta$ 的素因子。\n从因式分解 $\\Delta = 2^6 \\times 7^2 \\times 31 \\times 409$ 可知，不同的素因子是 $2$、$7$、$31$ 和 $409$。\n$E$ 的坏约化素数集合是 $\\{2, 7, 31, 409\\}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  7  31  409\n\\end{pmatrix}\n}\n$$", "id": "3022305"}, {"introduction": "下降法将确定椭圆曲线秩的问题转化为检验局部可解性条件。本练习 [@problem_id:3022295] 通过让你计算希尔伯特符号，将这一抽象概念具体化。希尔伯特符号是确定相关方程在$p$-进数 $\\mathbb{Q}_{p}$ 中是否有解的强大工具。掌握这种计算对于理解塞尔默群 (Selmer group) 的构造方式及其为何能为秩提供一个上界至关重要。", "problem": "设 $E$ 是定义在 $\\mathbb{Q}$ 上的椭圆曲线 $E \\colon y^{2} = x(x+1)(x+2)$。在对 $E$ 进行 2-下降 (2-descent) 的过程中，会遇到一个亏格为1的覆盖，它由以下二次型给出（不计非零有理数平方的缩放）：\n$$\n- X^{2} - 2 Y^{2} \\;=\\; Z^{2}.\n$$\n对于一个素数 $p$，附于 $a,b \\in \\mathbb{Q}_{p}^{\\times}$ 的希尔伯特符号 (Hilbert symbol) $(a,b)_{p} \\in \\{\\pm 1\\}$ 定义为：当且仅当二次曲线 $a X^{2} + b Y^{2} = Z^{2}$ 在 $p$-进数 $\\mathbb{Q}_{p}$ 上有非平凡点时，$(a,b)_{p} = 1$。这为 2-下降 (2-descent) 背景下的二次曲线提供了标准的局部可解性检验。\n\n请仅使用 2-进赋值和模 8 的剩余类，计算当 $u = -1$ 和 $v = -2$ 时希尔伯特符号 $(u,v)_{2}$ 的值，并用它来判断二次曲线 $-X^{2} - 2 Y^{2} = Z^{2}$ 是否在 $\\mathbb{Q}_{2}$ 上有非平凡点，从而判断相应的 2-覆盖 (2-covering) 在 $p=2$ 处是否局部可解。\n\n你的最终答案必须是 $(u,v)_{2}$ 的单一数值，为 $\\{\\pm 1\\}$ 中的一个数。不需要四舍五入。", "solution": "问题要求计算当 $u = -1$ 和 $v = -2$ 时的希尔伯特符号 $(u,v)_{2}$。该符号的值决定了二次曲线 $-X^{2} - 2Y^{2} = Z^{2}$ 是否在 2-进数域 $\\mathbb{Q}_{2}$ 中有非平凡解。非平凡解是指 $(X,Y,Z) \\neq (0,0,0)$ 的解。问题指明计算应基于 2-进赋值和模 8 的剩余类。这直接指向了素数 $p=2$ 处希尔伯特符号的标准显式公式。\n\n设 $a, b \\in \\mathbb{Q}_{2}^{\\times}$。我们可以将它们唯一地写成 $a = 2^{\\alpha} a'$ 和 $b = 2^{\\beta} b'$ 的形式，其中 $\\alpha = v_{2}(a)$ 和 $\\beta = v_{2}(b)$ 是 $a$ 和 $b$ 的 2-进赋值，而 $a'$ 和 $b'$ 是 2-进单位 (即 $v_{2}(a') = v_{2}(b')=0$）。希尔伯特符号 $(a,b)_{2}$ 的公式由下式给出：\n$$\n(a,b)_{2} = (-1)^{ \\frac{a'-1}{2} \\frac{b'-1}{2} + \\alpha \\frac{b'^{2}-1}{8} + \\beta \\frac{a'^{2}-1}{8} }\n$$\n其中指数是在模 2 的意义下考虑的。对于任何 2-进单位 $a'$，项 $\\frac{a'-1}{2}$ 和 $\\frac{a'^{2}-1}{8}$ 都是良定义的，因为作为一个整数，如果 $a'$ 是奇数，那么 $a'-1$ 是偶数，且 $a'^{2}-1 = (a'-1)(a'+1)$ 可以被 8 整除（因为一个因子可以被 2 整除，另一个可以被 4 整除）。\n\n题目要求我们计算当 $u = -1$ 和 $v = -2$ 时的 $(u,v)_{2}$。让我们确定公式所需的各个部分。\n\n对于 $a = u = -1$：\n其 2-进赋值为 $\\alpha = v_{2}(-1) = 0$，因为 $-1$ 是一个 2-进单位。\n其单位部分是 $a' = \\frac{-1}{2^{0}} = -1$。\n\n对于 $b = v = -2$：\n其 2-进赋值为 $\\beta = v_{2}(-2) = v_2(2 \\cdot (-1)) = v_2(2) + v_2(-1) = 1 + 0 = 1$。\n其单位部分是 $b' = \\frac{-2}{2^{1}} = -1$。\n\n现在，我们计算公式中指数的各个部分。这些部分取决于 $a'$ 和 $b'$ 模 2 的适当次幂的剩余类。这里，$a'$ 和 $b'$ 均为 $-1$。\n我们计算必要的表达式：\n\\begin{itemize}\n    \\item 对于 $a'=-1$：\n    $$ \\frac{a'-1}{2} = \\frac{-1-1}{2} = \\frac{-2}{2} = -1 $$\n    $$ \\frac{a'^{2}-1}{8} = \\frac{(-1)^{2}-1}{8} = \\frac{1-1}{8} = 0 $$\n    \\item 对于 $b'=-1$：\n    $$ \\frac{b'-1}{2} = \\frac{-1-1}{2} = \\frac{-2}{2} = -1 $$\n    $$ \\frac{b'^{2}-1}{8} = \\frac{(-1)^{2}-1}{8} = \\frac{1-1}{8} = 0 $$\n\\end{itemize}\n\n现在我们可以将这些值以及 $\\alpha=0$ 和 $\\beta=1$ 代入希尔伯特符号的公式中：\n$$\n(-1, -2)_{2} = (-1)^{ \\left(\\frac{-1-1}{2}\\right) \\left(\\frac{-1-1}{2}\\right) + (0) \\left(\\frac{(-1)^{2}-1}{8}\\right) + (1) \\left(\\frac{(-1)^{2}-1}{8}\\right) }\n$$\n$$\n(-1, -2)_{2} = (-1)^{ (-1)(-1) + 0 \\cdot 0 + 1 \\cdot 0 }\n$$\n$$\n(-1, -2)_{2} = (-1)^{1 + 0 + 0} = (-1)^{1} = -1\n$$\n希尔伯特符号的值是 $(-1, -2)_{2} = -1$。\n\n根据问题中提供的定义，当且仅当二次曲线 $a X^{2} + b Y^{2} = Z^{2}$ 在 $\\mathbb{Q}_{p}$ 上有非平凡点时，$(a,b)_{p} = 1$。在我们的例子中，$a=-1$，$b=-2$，$p=2$，我们得到 $(-1, -2)_{2} = -1$。\n这意味着二次曲线 $-X^{2} - 2Y^{2} = Z^{2}$ 在 2-进数域 $\\mathbb{Q}_{2}$ 上没有非平凡点。该方程可以改写为 $X^{2} + 2Y^{2} + Z^{2} = 0$。我们的结果表明，这个方程在 $\\mathbb{Q}_{2}$ 中只有平凡解 $(X,Y,Z)=(0,0,0)$。\n\n在椭圆曲线 $E$ 的 2-下降 (2-descent) 的背景下，这个结果表明给定的 2-覆盖 (2-covering) 在素数 $p=2$ 处不是局部可解的。在覆盖上存在全局有理点（对应于 $E$ 上的一个无限阶有理点）的一个必要条件是，它必须在每个 $\\mathbb{Q}_{p}$（以及 $\\mathbb{R}$）中都有局部点。由于这个条件在 $p=2$ 时不成立，塞尔默群 (Selmer group) 中的这个特定元素并非来自 $E$ 上的有理点。\n然而，问题只要求计算希尔伯特符号的值以及关于局部可解性的直接结论。计算出的值为 $-1$。", "answer": "$$\\boxed{-1}$$", "id": "3022295"}, {"introduction": "现代数论在很大程度上依赖于计算来检验猜想和探索算术结构。本章的总结性练习 [@problem_id:3022323] 将本章的核心思想——秩、下降法和L函数——融合到一个综合性的计算项目中。通过编写程序来推测秩，你将看到理论界限和解析启发法如何协同工作，从而一窥当代数论中理论与计算的相互作用。", "problem": "考虑定义在有理数域上的椭圆曲线，其短 Weierstrass 方程为 $$E_A:\\ y^2 = x^3 - A x$$ 其中 $A$ 是一个正整数。Mordell–Weil 定理断言 $E_A(\\mathbb{Q})$ 是一个有限生成阿贝尔群，同构于 $$E_A(\\mathbb{Q}) \\cong E_A(\\mathbb{Q})_{\\mathrm{tors}} \\oplus \\mathbb{Z}^r$$ 其中 $E_A(\\mathbb{Q})_{\\mathrm{tors}}$ 是挠子群，$r$ 是秩。Birch 和 Swinnerton–Dyer 猜想将秩 $r$ 与 $L$-函数 $L(E_A,s)$ 在 $s=1$ 处的消失阶联系起来。\n\n您的任务是编写一个完整的、可运行的程序，针对特定曲线 $$E:\\ y^2 = x^3 - 36 x$$ 结合一个 $2$-descent 秩上界和一个在 $s=1$ 附近的 $L$-函数数值近似，来推测其确切的秩。为评估稳健性，您的程序还必须处理 $E_{n^2}:\\ y^2 = x^3 - n^2 x$ 族中一系列相关曲线的小型测试套件。\n\n请从以下基本原则开始您的推导：\n- $\\mathbb{Q}$ 上椭圆曲线的定义和 Mordell–Weil 群结构。\n- 存在一个 $2$-Selmer 群以及不等式 $$r \\le \\dim_{\\mathbb{F}_2} \\mathrm{Sel}_2(E_A) - \\dim_{\\mathbb{F}_2} E_A[2](\\mathbb{Q})$$\n- 对于具有完全有理 $2$-挠点的曲线，特别是 $E_{n^2}:\\ y^2 = x(x - n)(x + n)$ 族，其 $2$-Selmer 群受限于整除 $2n$ 的素数处的局部条件，因此可以通过分析平方类和在整除 $2n$ 的有限位集上的局部可解性，获得一个形如 $$\\dim_{\\mathbb{F}_2} \\mathrm{Sel}_2(E_{n^2}) \\le \\omega(n) + 2$$ 的实用界，其中 $\\omega(n)$ 表示 $n$ 的不同素因子个数。由此得出 $2$-descent 秩上界 $$r \\le \\omega(n)$$\n- $L$-函数 $L(E,s)$ 由一个 Dirichlet 级数定义，其系数 $a_n$ 是积性的，并由局部点计数确定。对于好素数 $p$，其欧拉乘积为 $$L_p(E,s) = \\left(1 - a_p p^{-s} + p^{1-2s}\\right)^{-1}$$ 其中对于好约化素数，$a_p = p + 1 - \\#E(\\mathbb{F}_p)$。在 $s=1$ 附近，可以通过对好素数的截断 Dirichlet 级数或截断欧拉乘积来数值近似 $L(E,s)$，从而启发式地评估 $L(E,1)$ 是否接近于零，以及是否存在一阶消失。\n\n请按如下方式设计您的算法：\n- 对于每个测试曲线 $E_{n^2}$，通过对 $n$ 进行素因子分解，计算 $2$-descent 上界 $r_{\\mathrm{upper}} = \\omega(n)$。\n- 在 $s=1$ 附近数值近似 $L(E_{n^2},s)$，方法如下：\n  1. 通过对 $y^2 \\equiv x^3 - n^2 x \\pmod{p}$ 的解进行计数，计算好约化素数（不整除 $2n$ 的素数）$p$ 的系数 $a_p$，并使用 $a_p = p + 1 - \\#E(\\mathbb{F}_p)$。\n  2. 构造一个截断 Dirichlet 级数 $$S_N(s) = \\sum_{\\substack{1 \\le m \\le N \\\\ \\gcd(m,2n)=1}} \\frac{a_m}{m^s} e^{-m/N}$$ 其中 $N$ 为一个合适的截断值，$a_m$ 由 $a_p$ 以积性方式构建，使用好素数处素数幂的 Hecke 递推关系，$$a_{p^k} = a_p a_{p^{k-1}} - p\\, a_{p^{k-2}},\\quad k \\ge 2$$ 且 $a_1=1$，同时省略具有坏约化素因子的项以保持近似的一致性。\n  3. 在 $s \\in \\{1-\\varepsilon, 1, 1+\\varepsilon\\}$ 处（$\\varepsilon$ 很小）评估 $S_N(s)$，以启发式地检测中心值是否像一个一阶零点，即 $|S_N(1)|$ 远小于邻近值，且有限差分斜率非平凡，从而预测解析秩在 $\\{0,1\\}$ 中。\n- 可选地，搜索 $y$ 非零的小整数有理点，以提供一个下界 $r_{\\mathrm{lower}} \\in \\{0,1\\}$；通过设置 $$r_{\\mathrm{conj}} = \\min\\left(r_{\\mathrm{upper}}, \\max\\left(r_{\\mathrm{lower}}, r_{\\mathrm{analytic}}\\right)\\right)$$ 来组合这些界。\n\n您的测试套件必须包含以下参数值 $n$：\n- $n=6$（目标曲线 $E:y^2=x^3-36x$），\n- $n=1$,\n- $n=2$,\n- $n=3$.\n\n对于测试套件中的每个 $n$，您的程序必须生成推测的秩 $r_{\\mathrm{conj}}$ 作为一个整数。最终输出必须是单行文本，包含一个推测秩的列表，格式为用方括号括起来的逗号分隔列表，例如，“[r1,r2,r3,r4]”。不涉及物理单位或角度；所有输出都是纯整数。您的程序必须无需输入，并在指定环境下按原样运行。", "solution": "该任务是为给定参数集 $n \\in \\{6, 1, 2, 3\\}$，推测椭圆曲线族 $E_{n^2}: y^2 = x^3 - n^2 x$ 的秩。秩的推测值表示为 $r_{\\mathrm{conj}}$，将通过组合三种不同方法形成：来自 $2$-descent 的理论上界、来自点搜索的数值下界，以及来自曲线 $L$-函数的解析秩的数值估计。最终的秩推测值由公式 $r_{\\mathrm{conj}} = \\min(r_{\\mathrm{upper}}, \\max(r_{\\mathrm{lower}}, r_{\\mathrm{analytic}}))$ 确定。\n\n在此，我们详细说明了为给定整数 $n$ 计算每个分量的分步推导和方法。\n\n### 1. 秩上界 ($r_{\\mathrm{upper}}$)\n\n题目提供了一个推导 Mordell-Weil 群 $E_{n^2}(\\mathbb{Q})$ 秩 $r$ 上界的框架。\n将秩与 $2$-Selmer 群 $\\mathrm{Sel}_2(E_{n^2})$ 联系起来的基本不等式是：\n$$r \\le \\dim_{\\mathbb{F}_2} \\mathrm{Sel}_2(E_{n^2}) - \\dim_{\\mathbb{F}_2} E_{n^2}[2](\\mathbb{Q})$$\n其中 $E_{n^2}[2](\\mathbb{Q})$ 是阶整除 $2$ 的有理点构成的群。\n我们曲线的方程是 $y^2 = x^3 - n^2 x = x(x-n)(x+n)$。阶为 $2$ 的点是那些 $y$-坐标为 $y=0$ 的点，它们出现在 $x \\in \\{0, n, -n\\}$ 处。这三个点与无穷远点 $\\mathcal{O}$ 一起，构成了有理 $2$-挠子群 $E_{n^2}[2](\\mathbb{Q})$。这个群同构于 Klein 四元群 $\\mathbb{Z}/2\\mathbb{Z} \\times \\mathbb{Z}/2\\mathbb{Z}$，其作为含两个元素的有限域 $\\mathbb{F}_2$ 上的向量空间的维数是 $2$。\n$$\\dim_{\\mathbb{F}_2} E_{n^2}[2](\\mathbb{Q}) = 2$$\n题目指出，对于这个族， $2$-Selmer 群维数的一个实用上界是：\n$$\\dim_{\\mathbb{F}_2} \\mathrm{Sel}_2(E_{n^2}) \\le \\omega(n) + 2$$\n其中 $\\omega(n)$ 是 $n$ 的不同素因子个数。\n将这两个结果代入秩不等式，我们得出结论：\n$$r \\le (\\omega(n) + 2) - 2 = \\omega(n)$$\n这给了我们可计算的上界，$r_{\\mathrm{upper}} = \\omega(n)$。我们为测试套件中的每个 $n$ 计算这个值：\n- 对于 $n=6=2 \\cdot 3$，$\\omega(6)=2$，所以 $r_{\\mathrm{upper}} = 2$。\n- 对于 $n=1$，它没有素因子，$\\omega(1)=0$，所以 $r_{\\mathrm{upper}} = 0$。\n- 对于 $n=2$，它是一个素数，$\\omega(2)=1$，所以 $r_{\\mathrm{upper}} = 1$。\n- 对于 $n=3$，它是一个素数，$\\omega(3)=1$，所以 $r_{\\mathrm{upper}} = 1$。\n\n### 2. 秩下界 ($r_{\\mathrm{lower}}$)\n\n通过寻找无限阶的有理点可以建立秩的下界。对于 $E_{n^2}$ 族，挠子群仅包含 $y$-坐标为 $y=0$ 的点（对于 $n>2$）。任何 $y$ 坐标非零的有理点都必须是无限阶的。只要找到一个这样的点，就证明了 $r \\ge 1$。\n我们搜索 $y \\ne 0$ 的整点 $(x,y)$。这涉及到检查一定范围内的整数 $x$，看 $x^3 - n^2 x$ 是否为完全平方数。我们只需检查使得 $x^3 - n^2 x > 0$ 的整数 $x$。这发生在 $x \\in (-n, 0) \\cup (n, \\infty)$ 时。我们将在 $[-n+1, -1]$ 和 $[n+1, 200]$ 的整数范围内搜索 $x$。\n- 如果找到一个点，我们设置 $r_{\\mathrm{lower}}=1$。\n- 如果在此范围内搜索未成功，我们设置 $r_{\\mathrm{lower}}=0$。\n\n### 3. 解析秩 ($r_{\\mathrm{analytic}}$)\n\nBirch 和 Swinnerton-Dyer (BSD) 猜想指出，椭圆曲线的秩 $r$ 等于其 Hasse-Weil $L$-函数 $L(E, s)$ 在中心点 $s=1$ 处的消失阶。我们将数值近似 $L(E_{n^2}, s)$ 来启发式地判断其在 $s=1$ 处的值是否为零，如果是，该零点是否为一阶。这给出了一个推测的解析秩 $r_{\\mathrm{analytic}} \\in \\{0, 1\\}$。\n\n过程如下：\n1.  **识别坏素数**：对于 $E_{n^2}: y^2 = x^3 - n^2 x$，坏约化素数是整除判别式 $\\Delta = 2^8 n^6$ 的素数。这些恰好是 $2n$ 的素因子。\n2.  **计算 $a_p$ 系数**：对于每个好约化素数 $p$，我们计算 $L$-函数的系数 $a_p$，定义为 $a_p = p + 1 - \\#E_{n^2}(\\mathbb{F}_p)$。有限域 $\\mathbb{F}_p$ 上的点群大小 $\\#E_{n^2}(\\mathbb{F}_p)$ 由 $1 + \\sum_{x=0}^{p-1} (1 + (\\frac{x^3 - n^2 x}{p}))$ 给出，其中 $(\\frac{\\cdot}{p})$ 是 Legendre 符号。这导出了公式：\n    $$a_p = -\\sum_{x=0}^{p-1} \\left(\\frac{x^3 - n^2 x}{p}\\right)$$\n3.  **计算 $a_m$ 系数**：对于互质的自变量，$a_m$ 系数是积性的。对于素数幂，它们遵循 Hecke 递推关系：\n    $$a_{p^k} = a_p a_{p^{k-1}} - p\\, a_{p^{k-2}} \\quad (k \\ge 2)$$\n    初始条件为 $a_{p^0} = a_1 = 1$ 和 $a_{p^1} = a_p$。对于一个普通整数 $m = p_1^{k_1} \\cdots p_r^{k_r}$，我们有 $a_m = a_{p_1^{k_1}} \\cdots a_{p_r^{k_r}}$。我们实现一个类筛法来计算所有满足 $\\gcd(m, 2n) = 1$ 的 $m \\le N$ 的 $a_m$。\n4.  **评估截断的 $L$-级数**：我们使用平滑的、截断的 Dirichlet 级数来近似 $L(E_{n^2}, s)$：\n    $$S_N(s) = \\sum_{\\substack{1 \\le m \\le N \\\\ \\gcd(m,2n)=1}} \\frac{a_m}{m^s} e^{-m/N}$$\n    我们选择一个截断值 $N=10000$ 和一个小参数 $\\varepsilon=10^{-5}$。我们在中心点附近的三个点 $s=1-\\varepsilon$，$s=1$ 和 $s=1+\\varepsilon$ 处评估这个和。\n5.  **确定解析秩**：\n    -   如果 $|S_N(1)|$ 接近于零（例如，$ 10^{-3}$），并且 $S_N(1-\\varepsilon)$ 和 $S_N(1+\\varepsilon)$ 的值符号相反且显著不为零，我们就有数值证据表明存在一个单零点。在这种情况下，我们推测 $r_{\\mathrm{analytic}}=1$。\n    -   否则，我们假设 $L$-函数在 $s=1$ 处不消失，并推测 $r_{\\mathrm{analytic}}=0$。\n\n### 4. 最终秩推测 ($r_{\\mathrm{conj}}$)\n\n最后，我们使用指定的公式综合这三种方法的信息：\n$$r_{\\mathrm{conj}} = \\min(r_{\\mathrm{upper}}, \\max(r_{\\mathrm{lower}}, r_{\\mathrm{analytic}}))$$\n这提供了一个稳健的推测，因为它确保秩不超过严格的上界，同时允许数值证据（无论是来自找到一个点还是来自 $L$-函数）来建议一个正的秩。对测试套件中的每个 $n$ 值重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to conjecture the rank of elliptic curves y^2 = x^3 - n^2*x.\n    \"\"\"\n\n    def get_distinct_prime_factors(num):\n        \"\"\"Computes the set of distinct prime factors of a positive integer.\"\"\"\n        if num == 1:\n            return set()\n        factors = set()\n        d = 2\n        temp_num = num\n        while d * d = temp_num:\n            if temp_num % d == 0:\n                factors.add(d)\n                while temp_num % d == 0:\n                    temp_num //= d\n            d += 1\n        if temp_num > 1:\n            factors.add(temp_num)\n        return factors\n\n    def legendre_symbol(a, p):\n        \"\"\"Computes the Legendre symbol (a/p).\"\"\"\n        if p  3 or p % 2 == 0:\n            return 0 # Not a valid prime for this simple implementation\n        ls = pow(a, (p - 1) // 2, p)\n        if ls == p - 1:\n            return -1\n        return ls\n\n    def compute_ap(p, n_sq):\n        \"\"\"Computes the coefficient a_p for the L-series.\"\"\"\n        # a_p = -sum_{x=0}^{p-1} (x^3 - n^2*x / p)\n        return -sum(legendre_symbol(x**3 - n_sq * x, p) for x in range(p))\n\n    def get_lower_bound(n):\n        \"\"\"\n        Searches for an integral point with y != 0 to find a lower bound for the rank.\n        if found, r_lower = 1, else 0.\n        \"\"\"\n        n_sq = n * n\n        # Search space x in (-n, 0) U (n, some_bound)\n        # Check negative x: x in [-n+1, -1]\n        for x in range(-n + 1, 0):\n            val = x**3 - n_sq * x\n            if val > 0:\n                y = math.isqrt(val)\n                if y * y == val:\n                    return 1\n        # Check positive x: x in [n+1, 201]\n        for x in range(n + 1, 201):\n            val = x**3 - n_sq * x\n            if val > 0:\n                y = math.isqrt(val)\n                if y * y == val:\n                    return 1\n        return 0\n\n    def conjecture_rank_analytic(n):\n        \"\"\"Numerically estimates the analytic rank (0 or 1).\"\"\"\n        N_CUTOFF = 10000\n        EPSILON = 1e-5\n        \n        n_sq = n * n\n        bad_primes = get_distinct_prime_factors(2 * n)\n        \n        # Sieve to find primes up to N_CUTOFF and their smallest prime factor\n        min_prime_factor = np.zeros(N_CUTOFF + 1, dtype=int)\n        primes = []\n        for i in range(2, N_CUTOFF + 1):\n            if min_prime_factor[i] == 0:\n                min_prime_factor[i] = i\n                primes.append(i)\n            for p in primes:\n                if p > min_prime_factor[i] or i * p > N_CUTOFF:\n                    break\n                min_prime_factor[i * p] = p\n        \n        # Compute a_p for good primes\n        ap_vals = {p: compute_ap(p, n_sq) for p in primes if p not in bad_primes}\n\n        # Compute a_m for m up to N_CUTOFF using a sieve-like method\n        am_vals = np.zeros(N_CUTOFF + 1, dtype=float)\n        am_vals[1] = 1.0\n\n        for p in primes:\n            if p in bad_primes:\n                continue\n            ap = ap_vals[p]\n            # Set a_{p^k}\n            pp = p\n            apk_prev = 1\n            apk_curr = ap\n            while pp = N_CUTOFF:\n                am_vals[pp] = apk_curr\n                apk_next = ap * apk_curr - p * apk_prev\n                apk_prev = apk_curr\n                apk_curr = apk_next\n                if pp > N_CUTOFF // p: break\n                pp *= p\n        \n        for m in range(2, N_CUTOFF + 1):\n            if am_vals[m] != 0: # a_m is nonzero only if m is a prime power (for now)\n                continue\n            \n            p = min_prime_factor[m]\n            if p in bad_primes:\n                am_vals[m] = 0.0\n                continue\n            \n            pp = p\n            while (m // pp) % p == 0:\n                pp *= p\n            \n            m_rem = m // pp\n            am_vals[m] = am_vals[pp] * am_vals[m_rem]\n            \n        # Compute the truncated L-series sum S_N(s) at s=1-eps, 1, 1+eps\n        s_vals = [1.0 - EPSILON, 1.0, 1.0 + EPSILON]\n        L_approx = [0.0, 0.0, 0.0]\n        \n        m_vals = np.arange(1, N_CUTOFF + 1)\n        exp_term = np.exp(-m_vals / N_CUTOFF)\n\n        for i, s in enumerate(s_vals):\n            terms = am_vals[1:] / (m_vals**s) * exp_term\n            L_approx[i] = np.sum(terms)\n\n        s_left, s_center, s_right = L_approx\n        \n        # Heuristic for analytic rank 1: central value is small, and there's a sign change\n        is_zero = abs(s_center)  1e-3\n        has_slope = abs(s_left - s_right) > 1e-2\n        sign_change = s_left * s_right  0\n\n        if is_zero and has_slope and sign_change:\n            return 1\n        return 0\n\n    def get_rank_conjecture(n):\n        \"\"\"Computes the final rank conjecture for a given n.\"\"\"\n\n        # 1. Upper bound\n        if n == 1:\n            r_upper = 0\n        else:\n            r_upper = len(get_distinct_prime_factors(n))\n\n        # Short-circuit if upper bound is 0\n        if r_upper == 0:\n            return 0\n            \n        # 2. Lower bound from point search\n        r_lower = get_lower_bound(n)\n        \n        # 3. Analytic rank\n        r_analytic = conjecture_rank_analytic(n)\n        \n        # 4. Combine results\n        r_conj = min(r_upper, max(r_lower, r_analytic))\n        return r_conj\n\n    # Test cases from the problem statement\n    test_cases = [6, 1, 2, 3]\n    results = []\n\n    for n in test_cases:\n        rank = get_rank_conjecture(n)\n        results.append(rank)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3022323"}]}