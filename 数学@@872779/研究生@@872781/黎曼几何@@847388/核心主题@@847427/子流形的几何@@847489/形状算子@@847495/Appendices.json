{"hands_on_practices": [{"introduction": "要真正掌握形算子，必须通过计算来巩固理论。这个练习提供了从基本定义出发，为一个显式参数化的曲面（函数图）计算形算子的机会。通过亲手计算第一和第二基本形式，并由此构建形算子，你将加深对其代数结构与外蕴曲率几何直觉之间联系的理解 [@problem_id:3003619]。", "problem": "考虑一个光滑曲面（$\\mathbb{R}^{3}$中的一个超曲面），其通过参数化 $X(u,v) = \\big(u, v, g(u,v)\\big)$ 作为一个函数的图像给出，其中\n$$\ng(u,v) = \\frac{1}{2}\\big(\\lambda u^{2} + 2 \\mu u v + \\nu v^{2}\\big) + \\frac{1}{6}\\big(\\alpha u^{3} + \\beta v^{3}\\big),\n$$\n且 $\\lambda$、$\\mu$、$\\nu$、$\\alpha$、$\\beta$ 是实常数。假设环境空间具有标准的欧几里得度量及其列维-奇维塔联络。在点 $(u,v) = (0,0)$ 处进行计算。\n\n从诱导度量（第一基本形式）、单位法向量、第二基本形式和形状算子（魏恩加滕映射）的基本定义出发，完成以下任务：\n\n- 计算在 $(0,0)$ 处的第一基本形式 $I$。\n- 构建在 $(0,0)$ 处的单位法向量 $N$。\n- 使用 $\\mathbb{R}^{3}$ 中的欧几里得联络计算在 $(0,0)$ 处的第二基本形式 $\\mathrm{II}$。\n- 计算在 $(0,0)$ 处的形状算子 $S$，并对于在 $(0,0)$ 处的切向量 $X, Y$ 建立关系 $\\mathrm{II}(X,Y) = I(SX, Y)$。\n\n最后，对于在 $(0,0)$ 处由 $T(\\theta) = \\cos(\\theta)\\,\\partial_{u} + \\sin(\\theta)\\,\\partial_{v}$ 给出的单位切向量（角度以弧度为单位，相对于 $\\partial_{u}$ 方向测量），计算在 $(0,0)$ 处的法曲率 $\\kappa_{n}(\\theta)$，并将其表示为关于 $\\lambda$、$\\mu$、$\\nu$ 和 $\\theta$ 的单个闭式解析表达式。\n\n只需报告您最终得到的 $\\kappa_{n}(\\theta)$ 表达式。无需四舍五入。", "solution": "该问题陈述是曲面微分几何中的一个有效练习。它问题适定，具有科学依据，并包含推导唯一解所需的所有必要信息。\n\n曲面 $M$ 由参数化 $X(u,v) = \\big(u, v, g(u,v)\\big)$ 给出，其中\n$$g(u,v) = \\frac{1}{2}\\big(\\lambda u^{2} + 2 \\mu u v + \\nu v^{2}\\big) + \\frac{1}{6}\\big(\\alpha u^{3} + \\beta v^{3}\\big)$$\n我们需要计算在点 $p = X(0,0)$ 处的几个几何量。\n\n首先，我们计算函数 $g(u,v)$ 的偏导数。\n一阶偏导数为：\n$$g_u(u,v) = \\frac{\\partial g}{\\partial u} = \\lambda u + \\mu v + \\frac{1}{2}\\alpha u^2$$\n$$g_v(u,v) = \\frac{\\partial g}{\\partial v} = \\mu u + \\nu v + \\frac{1}{2}\\beta v^2$$\n在点 $(u,v)=(0,0)$ 处，它们是：\n$$g_u(0,0) = 0$$\n$$g_v(0,0) = 0$$\n二阶偏导数为：\n$$g_{uu}(u,v) = \\frac{\\partial^2 g}{\\partial u^2} = \\lambda + \\alpha u$$\n$$g_{uv}(u,v) = \\frac{\\partial^2 g}{\\partial u \\partial v} = \\mu$$\n$$g_{vv}(u,v) = \\frac{\\partial^2 g}{\\partial v^2} = \\nu + \\beta v$$\n在点 $(u,v)=(0,0)$ 处，它们是：\n$$g_{uu}(0,0) = \\lambda$$\n$$g_{uv}(0,0) = \\mu$$\n$$g_{vv}(0,0) = \\nu$$\n请注意，$g(u,v)$ 中的三次项对 $(0,0)$ 处的二阶导数没有贡献。此外，$g(0,0)=0$，所以我们关注的点是原点 $p=(0,0,0) \\in \\mathbb{R}^3$。\n\n切空间 $T_p M$ 由向量 $X_u = \\frac{\\partial X}{\\partial u}$ 和 $X_v = \\frac{\\partial X}{\\partial v}$ 张成。\n$$X_u(u,v) = \\big(1, 0, g_u(u,v)\\big)$$\n$$X_v(u,v) = \\big(0, 1, g_v(u,v)\\big)$$\n在 $(u,v)=(0,0)$ 处计算，切空间 $T_p M$ 的基向量是：\n$$X_u(0,0) = \\big(1, 0, 0\\big)$$\n$$X_v(0,0) = \\big(0, 1, 0\\big)$$\n\n第一基本形式 $I$ 由系数 $E$、$F$ 和 $G$ 确定，它们是这些基向量在环境空间 $\\mathbb{R}^3$ 中的内积。在 $p=(0,0,0)$ 处：\n$$E(0,0) = \\langle X_u(0,0), X_u(0,0) \\rangle = \\langle (1,0,0), (1,0,0) \\rangle = 1$$\n$$F(0,0) = \\langle X_u(0,0), X_v(0,0) \\rangle = \\langle (1,0,0), (0,1,0) \\rangle = 0$$\n$$G(0,0) = \\langle X_v(0,0), X_v(0,0) \\rangle = \\langle (0,1,0), (0,1,0) \\rangle = 1$$\n第一基本形式 $I$ 在点 $p$ 处关于基 $\\{X_u, X_v\\}$ 的矩阵表示为：\n$$[I]_p = \\begin{pmatrix} E  F \\\\ F  G \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$$\n\n单位法向量 $N$ 由 $N = \\frac{X_u \\times X_v}{\\|X_u \\times X_v\\|}$ 给出。首先，我们计算叉积：\n$$X_u \\times X_v = \\det \\begin{pmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ 1  0  g_u \\\\ 0  1  g_v \\end{pmatrix} = (-g_u, -g_v, 1)$$\n在 $(u,v)=(0,0)$ 处，这变为：\n$$(X_u \\times X_v)(0,0) = (-g_u(0,0), -g_v(0,0), 1) = (0,0,1)$$\n其范数为 $\\|(0,0,1)\\| = 1$。因此，在点 $p$ 处的单位法向量是：\n$$N(0,0) = (0,0,1)$$\n\n第二基本形式 $\\mathrm{II}$ 由系数 $L$、$M$、$N_{\\mathrm{II}}$ 确定，这些系数涉及参数化的二阶导数在法向量上的投影。\n首先，我们求 $X(u,v)$ 的二阶偏导数：\n$$X_{uu}(u,v) = (0,0,g_{uu}(u,v))$$\n$$X_{uv}(u,v) = (0,0,g_{uv}(u,v))$$\n$$X_{vv}(u,v) = (0,0,g_{vv}(u,v))$$\n在 $(u,v)=(0,0)$ 处，它们是：\n$$X_{uu}(0,0) = (0,0,\\lambda)$$\n$$X_{uv}(0,0) = (0,0,\\mu)$$\n$$X_{vv}(0,0) = (0,0,\\nu)$$\n在点 $p$ 处的 $\\mathrm{II}$ 的系数是：\n$$L(0,0) = \\langle X_{uu}(0,0), N(0,0) \\rangle = \\langle (0,0,\\lambda), (0,0,1) \\rangle = \\lambda$$\n$$M(0,0) = \\langle X_{uv}(0,0), N(0,0) \\rangle = \\langle (0,0,\\mu), (0,0,1) \\rangle = \\mu$$\n$$N_{\\mathrm{II}}(0,0) = \\langle X_{vv}(0,0), N(0,0) \\rangle = \\langle (0,0,\\nu), (0,0,1) \\rangle = \\nu$$\n第二基本形式 $\\mathrm{II}$ 在点 $p$ 处的矩阵表示为：\n$$[\\mathrm{II}]_p = \\begin{pmatrix} L  M \\\\ M  N_{\\mathrm{II}} \\end{pmatrix} = \\begin{pmatrix} \\lambda  \\mu \\\\ \\mu  \\nu \\end{pmatrix}$$\n\n形状算子（或魏恩加滕映射） $S_p: T_p M \\to T_p M$ 在基 $\\{X_u, X_v\\}$ 中的矩阵表示 $[S]_p$ 由 $[S]_p = [I]_p^{-1} [\\mathrm{II}]_p$ 给出。\n由于 $[I]_p$ 是单位矩阵，其逆也是单位矩阵。因此：\n$$[S]_p = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}^{-1} \\begin{pmatrix} \\lambda  \\mu \\\\ \\mu  \\nu \\end{pmatrix} = \\begin{pmatrix} \\lambda  \\mu \\\\ \\mu  \\nu \\end{pmatrix}$$\n为了建立关系 $\\mathrm{II}(X,Y) = I(SX, Y)$，令 $X = c_1 X_u + c_2 X_v$ 和 $Y = d_1 X_u + d_2 X_v$ 为点 $p$ 处的切向量。以矩阵形式，坐标向量为 $\\mathbf{x}=(c_1, c_2)^T$ 和 $\\mathbf{y}=(d_1, d_2)^T$：\n$$\\mathrm{II}(X,Y) = \\mathbf{x}^T [\\mathrm{II}]_p \\mathbf{y}$$\n$$I(SX, Y) = ([S]_p \\mathbf{x})^T [I]_p \\mathbf{y} = \\mathbf{x}^T [S]_p^T [I]_p \\mathbf{y}$$\n鉴于 $[I]_p$ 是单位矩阵且 $[S]_p$ 是对称的，有 $I(SX,Y) = \\mathbf{x}^T [S]_p \\mathbf{y}$。由于 $[S]_p = [\\mathrm{II}]_p$，恒等式 $\\mathrm{II}(X,Y) = I(SX, Y)$ 得以验证。\n\n最后，我们计算单位切向量 $T(\\theta) = \\cos(\\theta)\\,\\partial_u + \\sin(\\theta)\\,\\partial_v$ 的法曲率 $\\kappa_n(\\theta)$。在点 $p$ 处，该向量是 $T(\\theta) = \\cos(\\theta)X_u(0,0) + \\sin(\\theta)X_v(0,0)$。\n这是一个关于诱导度量 $I$ 的单位向量，因为：\n$$I(T(\\theta), T(\\theta)) = \\cos^2(\\theta)E + 2\\cos(\\theta)\\sin(\\theta)F + \\sin^2(\\theta)G = \\cos^2(\\theta)(1) + 2\\cos(\\theta)\\sin(\\theta)(0) + \\sin^2(\\theta)(1) = 1$$\n单位切向量 $T$ 方向上的法曲率 $\\kappa_n$ 由 $\\kappa_n(T) = \\mathrm{II}(T,T)$ 给出。\n对于 $T(\\theta)$，这是：\n$$\\kappa_n(\\theta) = \\mathrm{II}(T(\\theta), T(\\theta)) = \\mathrm{II}(\\cos(\\theta)X_u + \\sin(\\theta)X_v, \\cos(\\theta)X_u + \\sin(\\theta)X_v)$$\n根据 $\\mathrm{II}$ 的双线性性质：\n$$\\kappa_n(\\theta) = \\cos^2(\\theta)\\,\\mathrm{II}(X_u, X_u) + 2\\cos(\\theta)\\sin(\\theta)\\,\\mathrm{II}(X_u, X_v) + \\sin^2(\\theta)\\,\\mathrm{II}(X_v, X_v)$$\n代入系数 $L, M, N_{\\mathrm{II}}$：\n$$\\kappa_n(\\theta) = L\\cos^2(\\theta) + 2M\\cos(\\theta)\\sin(\\theta) + N_{\\mathrm{II}}\\sin^2(\\theta)$$\n$$\\kappa_n(\\theta) = \\lambda\\cos^2(\\theta) + 2\\mu\\cos(\\theta)\\sin(\\theta) + \\nu\\sin^2(\\theta)$$\n这就是法曲率的最终表达式，称为欧拉公式。", "answer": "$$\n\\boxed{\\lambda\\cos^{2}(\\theta) + 2\\mu\\cos(\\theta)\\sin(\\theta) + \\nu\\sin^{2}(\\theta)}\n$$", "id": "3003619"}, {"introduction": "虽然直接坐标计算是基础，但对于具有对称性的曲面（如旋转曲面），活动标架法提供了一种更深刻且高效的工具。这个练习将引导你使用活动标架法来推导旋转曲面的形算子，并识别出其主曲率和主方向恰好与经线和纬线对齐。通过将一般理论应用于经典的环面，你将看到抽象概念如何转化为具体的几何洞察 [@problem_id:3003640]。", "problem": "考虑三维欧几里得空间 $\\mathbb{R}^{3}$ 中的一个光滑旋转曲面，该曲面由 $rz$-平面中的单位速率平面曲线 $\\gamma(\\sigma) = \\big(r(\\sigma), z(\\sigma)\\big)$ 绕 $z$-轴旋转而成，其中对所有 $\\sigma$ 都有 $r(\\sigma)  0$。该曲面参数化为\n$$\nX(\\sigma,\\theta) = \\big(r(\\sigma)\\cos\\theta,\\ r(\\sigma)\\sin\\theta,\\ z(\\sigma)\\big),\n$$\n其中角度以弧度为单位。令 $\\nabla$ 表示 $\\mathbb{R}^{3}$ 上的 Levi-Civita 联络，并令 $S$ 为形状算子（Weingarten 映射），其定义为 $S(V) = -\\big(\\nabla_{V} n\\big)^{\\top}$，其中 $V$ 为任意切向量，$n$ 为单位法向量场，$(\\cdot)^{\\top}$ 表示切向投影。\n\n使用活动标架法，完成以下任务：\n\n1. 构造一个适应于该曲面的标准正交标架 $(e_{\\sigma}, e_{\\theta}, n)$，其中 $e_{\\sigma}$ 沿经线（$\\sigma$-曲线）方向相切，$e_{\\theta}$ 沿纬线（$\\theta$-曲线）方向相切，$n$ 是朝外的单位法向量。\n\n2. 仅从上述定义出发，计算作为切平面上线性映射的形状算子 $S$，并将其表示为关于标准正交基 $(e_{\\sigma}, e_{\\theta})$ 在一般点 $(\\sigma,\\theta)$ 的 $2\\times 2$ 矩阵。确定沿经线和纬线的主方向和主曲率。\n\n现在特化到以下显式旋转曲面（一个环面）：固定常数 $Rr_{0}0$ 并设\n$$\nr(\\sigma) = R + r_{0}\\cos\\!\\left(\\frac{\\sigma}{r_{0}}\\right), \\qquad z(\\sigma) = r_{0}\\sin\\!\\left(\\frac{\\sigma}{r_{0}}\\right).\n$$\n注意 $\\sigma$ 是沿轮廓曲线的弧长。使用你得到关于 $S$ 及其主曲率的一般公式，确定高斯曲率 $K(\\sigma)$ 并在点 $(\\sigma,\\theta)=(0,0)$ 处求值。你的最终答案必须是单一的闭式解析表达式。", "solution": "首先对问题进行验证，以确保其是良定的、有科学依据且客观的。\n\n**步骤1：提取给定信息**\n- 旋转曲面参数化：$\\mathbb{R}^{3}$ 中的 $X(\\sigma,\\theta) = \\big(r(\\sigma)\\cos\\theta,\\ r(\\sigma)\\sin\\theta,\\ z(\\sigma)\\big)$。\n- 轮廓曲线：$\\gamma(\\sigma) = \\big(r(\\sigma), z(\\sigma)\\big)$ 是一条单位速率平面曲线，意味着 $(r'(\\sigma))^2 + (z'(\\sigma))^2 = 1$。\n- 条件：$r(\\sigma)  0$。\n- 形状算子定义：$S(V) = -\\big(\\nabla_{V} n\\big)^{\\top}$，其中 $V$ 是切向量，$n$ 是单位法向量。\n- 任务1：构造一个标准正交标架 $(e_{\\sigma}, e_{\\theta}, n)$。\n- 任务2：在基 $(e_{\\sigma}, e_{\\theta})$ 下计算 $S$ 的矩阵，并确定主方向和主曲率。\n- 环面的特定参数化：对于常数 $Rr_{0}0$，$r(\\sigma) = R + r_{0}\\cos\\!\\left(\\frac{\\sigma}{r_{0}}\\right)$ 和 $z(\\sigma) = r_{0}\\sin\\!\\left(\\frac{\\sigma}{r_{0}}\\right)$。\n- 最终任务：确定环面的高斯曲率 $K(\\sigma)$ 并在点 $(\\sigma,\\theta)=(0,0)$ 处求值。\n\n**步骤2：使用提取的给定信息进行验证**\n此问题是曲面微分几何中的一个标准练习。所给定义在数学上是严谨且标准的。旋转曲面及环面特例的参数化都是良定义的。对于环面，$R  r_{0}  0$ 的条件确保了 $r(\\sigma) = R + r_{0}\\cos(\\frac{\\sigma}{r_{0}}) \\ge R - r_{0}  0$，因此该曲面是光滑且不自交的。所提供的环面轮廓曲线确实是单位速率的：$r'(\\sigma) = -\\sin(\\frac{\\sigma}{r_{0}})$ 和 $z'(\\sigma) = \\cos(\\frac{\\sigma}{r_{0}})$，因此 $(r')^2+(z')^2 = \\sin^2(\\frac{\\sigma}{r_{0}}) + \\cos^2(\\frac{\\sigma}{r_{0}}) = 1$。此问题是自洽的、一致的、科学上合理的且良定的。\n\n**结论：** 此问题有效。\n\n**解**\n\n我们从由 $X(\\sigma,\\theta) = \\big(r(\\sigma)\\cos\\theta,\\ r(\\sigma)\\sin\\theta,\\ z(\\sigma)\\big)$ 参数化的一般旋转曲面开始。\n\n**1. 标准正交标架的构造**\n\n首先，我们计算沿坐标曲线的切向量。$X$ 关于 $\\sigma$ 和 $\\theta$ 的偏导数是：\n$$\nX_{\\sigma} = \\frac{\\partial X}{\\partial \\sigma} = \\big(r'(\\sigma)\\cos\\theta,\\ r'(\\sigma)\\sin\\theta,\\ z'(\\sigma)\\big)\n$$\n$$\nX_{\\theta} = \\frac{\\partial X}{\\partial \\theta} = \\big(-r(\\sigma)\\sin\\theta,\\ r(\\sigma)\\cos\\theta,\\ 0\\big)\n$$\n其中撇号表示关于 $\\sigma$ 的微分。\n\n接下来，我们计算这些切向量的范数。利用轮廓曲线 $\\gamma(\\sigma)$ 是单位速率的，即 $(r'(\\sigma))^2 + (z'(\\sigma))^2 = 1$，我们求出第一基本形式的系数：\n$$\ng_{\\sigma\\sigma} = \\langle X_{\\sigma}, X_{\\sigma} \\rangle = (r')^2\\cos^2\\theta + (r')^2\\sin^2\\theta + (z')^2 = (r')^2 + (z')^2 = 1\n$$\n$$\ng_{\\theta\\theta} = \\langle X_{\\theta}, X_{\\theta} \\rangle = (-r\\sin\\theta)^2 + (r\\cos\\theta)^2 + 0^2 = r^2\\sin^2\\theta + r^2\\cos^2\\theta = r^2\n$$\n$$\ng_{\\sigma\\theta} = \\langle X_{\\sigma}, X_{\\theta} \\rangle = -r'r\\cos\\theta\\sin\\theta + r'r\\sin\\theta\\cos\\theta + 0 = 0\n$$\n由于 $g_{\\sigma\\theta}=0$，坐标向量 $X_{\\sigma}$ 和 $X_{\\theta}$ 是正交的。\n与曲面相切的标准正交标架向量通过将 $X_{\\sigma}$ 和 $X_{\\theta}$ 单位化得到：\n$$\ne_{\\sigma} = \\frac{X_{\\sigma}}{\\|X_{\\sigma}\\|} = \\frac{X_{\\sigma}}{\\sqrt{g_{\\sigma\\sigma}}} = X_{\\sigma} = \\big(r'\\cos\\theta,\\ r'\\sin\\theta,\\ z'\\big)\n$$\n$$\ne_{\\theta} = \\frac{X_{\\theta}}{\\|X_{\\theta}\\|} = \\frac{X_{\\theta}}{\\sqrt{g_{\\theta\\theta}}} = \\frac{1}{r}X_{\\theta} = \\big(-\\sin\\theta,\\ \\cos\\theta,\\ 0\\big)\n$$\n单位法向量 $n$ 通过将叉积 $X_{\\sigma} \\times X_{\\theta}$ 单位化得到：\n$$\nX_{\\sigma} \\times X_{\\theta} = \\det\\begin{pmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ r'\\cos\\theta  r'\\sin\\theta  z' \\\\ -r\\sin\\theta  r\\cos\\theta  0 \\end{pmatrix} = \\big(-z'r\\cos\\theta,\\ -z'r\\sin\\theta,\\ r'r\\big)\n$$\n其大小为 $\\|X_{\\sigma} \\times X_{\\theta}\\| = \\sqrt{g_{\\sigma\\sigma}g_{\\theta\\theta} - g_{\\sigma\\theta}^2} = \\sqrt{1 \\cdot r^2 - 0^2} = r$。由于 $r0$，我们有：\n$$\nn = \\frac{X_{\\sigma} \\times X_{\\theta}}{r} = \\big(-z'\\cos\\theta,\\ -z'\\sin\\theta,\\ r'\\big)\n$$\n这个向量表示朝外的法向量。三元组 $(e_{\\sigma}, e_{\\theta}, n)$ 构成一个适应于该曲面的右手标准正交标架。\n\n**2. 形状算子的计算**\n\n形状算子 $S$ 将切平面映射到自身。它在标准正交基 $(e_{\\sigma}, e_{\\theta})$ 下的矩阵表示的元素为 $S_{ij} = \\langle S(e_i), e_j \\rangle$。\n$S$ 的作用由 $S(V) = -\\nabla_V n$ 给出。在环境空间 $\\mathbb{R}^3$ 中，联络 $\\nabla$ 是标准的方向导数。由于 $n$ 是曲面上的单位向量场，其导数 $\\nabla_V n$ 与曲面相切，因此切向投影 $(\\cdot)^\\top$ 在这些向量上是恒等映射。\n我们有 $\\nabla_{e_{\\sigma}} n = \\frac{1}{\\|X_\\sigma\\|}\\frac{\\partial n}{\\partial \\sigma} = \\frac{\\partial n}{\\partial \\sigma}$ 以及 $\\nabla_{e_{\\theta}} n = \\frac{1}{\\|X_\\theta\\|}\\frac{\\partial n}{\\partial \\theta} = \\frac{1}{r}\\frac{\\partial n}{\\partial \\theta}$。\n我们计算 $n$ 的偏导数：\n$$\n\\frac{\\partial n}{\\partial \\sigma} = \\big(-z''\\cos\\theta,\\ -z''\\sin\\theta,\\ r''\\big)\n$$\n$$\n\\frac{\\partial n}{\\partial \\theta} = \\big(z'\\sin\\theta,\\ -z'\\cos\\theta,\\ 0\\big)\n$$\n因此，$S$ 在基向量上的作用是：\n$$\nS(e_{\\sigma}) = -\\frac{\\partial n}{\\partial \\sigma} = \\big(z''\\cos\\theta,\\ z''\\sin\\theta,\\ -r''\\big)\n$$\n$$\nS(e_{\\theta}) = -\\frac{1}{r}\\frac{\\partial n}{\\partial \\theta} = -\\frac{1}{r}\\big(z'\\sin\\theta,\\ -z'\\cos\\theta,\\ 0\\big) = \\big(-\\frac{z'}{r}\\sin\\theta,\\ \\frac{z'}{r}\\cos\\theta,\\ 0\\big)\n$$\n矩阵元素是与基向量的内积：\n$$\nS_{11} = \\langle S(e_{\\sigma}), e_{\\sigma} \\rangle = \\langle \\big(z''\\cos\\theta, z''\\sin\\theta, -r''\\big), \\big(r'\\cos\\theta, r'\\sin\\theta, z'\\big) \\rangle = z''r'\\cos^2\\theta + z''r'\\sin^2\\theta - r''z' = r'z'' - r''z'\n$$\n这是轮廓曲线 $\\gamma(\\sigma)$ 的曲率，我们记为 $\\kappa_1$。\n$$\nS_{12} = \\langle S(e_{\\sigma}), e_{\\theta} \\rangle = \\langle \\big(z''\\cos\\theta, z''\\sin\\theta, -r''\\big), \\big(-\\sin\\theta, \\cos\\theta, 0\\big) \\rangle = -z''\\cos\\theta\\sin\\theta + z''\\sin\\theta\\cos\\theta + 0 = 0\n$$\n由于形状算子是自伴的，$S_{21} = S_{12} = 0$。\n$$\nS_{22} = \\langle S(e_{\\theta}), e_{\\theta} \\rangle = \\langle \\big(-\\frac{z'}{r}\\sin\\theta, \\frac{z'}{r}\\cos\\theta, 0\\big), \\big(-\\sin\\theta, \\cos\\theta, 0\\big) \\rangle = \\frac{z'}{r}\\sin^2\\theta + \\frac{z'}{r}\\cos^2\\theta = \\frac{z'}{r}\n$$\n这是纬线圈的法曲率，记为 $\\kappa_2$。\n形状算子在基 $(e_{\\sigma}, e_{\\theta})$ 下的矩阵是对角矩阵：\n$$\nS = \\begin{pmatrix} r'z'' - r''z'  0 \\\\ 0  \\frac{z'}{r} \\end{pmatrix}\n$$\n主方向是沿着经线 ($e_{\\sigma}$) 和纬线 ($e_{\\theta}$)。主曲率为 $\\kappa_1 = r'z'' - r''z'$ 和 $\\kappa_2 = \\frac{z'}{r}$。\n\n**对环面的特例分析**\n\n现在我们使用环面的特定参数化：\n$$\nr(\\sigma) = R + r_{0}\\cos\\left(\\frac{\\sigma}{r_{0}}\\right), \\qquad z(\\sigma) = r_{0}\\sin\\left(\\frac{\\sigma}{r_{0}}\\right)\n$$\n我们计算关于 $\\sigma$ 的必要导数：\n$r'(\\sigma) = -\\sin\\left(\\frac{\\sigma}{r_{0}}\\right)$\n$r''(\\sigma) = -\\frac{1}{r_{0}}\\cos\\left(\\frac{\\sigma}{r_{0}}\\right)$\n$z'(\\sigma) = \\cos\\left(\\frac{\\sigma}{r_{0}}\\right)$\n$z''(\\sigma) = -\\frac{1}{r_{0}}\\sin\\left(\\frac{\\sigma}{r_{0}}\\right)$\n\n我们将这些代入主曲率的公式中：\n$\\kappa_1 = r'z'' - r''z' = \\left(-\\sin\\left(\\frac{\\sigma}{r_{0}}\\right)\\right)\\left(-\\frac{1}{r_{0}}\\sin\\left(\\frac{\\sigma}{r_{0}}\\right)\\right) - \\left(-\\frac{1}{r_{0}}\\cos\\left(\\frac{\\sigma}{r_{0}}\\right)\\right)\\left(\\cos\\left(\\frac{\\sigma}{r_{0}}\\right)\\right)$\n$\\kappa_1 = \\frac{1}{r_{0}}\\sin^2\\left(\\frac{\\sigma}{r_{0}}\\right) + \\frac{1}{r_{0}}\\cos^2\\left(\\frac{\\sigma}{r_{0}}\\right) = \\frac{1}{r_{0}}$\n这是常数，正如预期的那样，因为轮廓曲线是一个半径为 $r_0$ 的圆。\n\n$\\kappa_2 = \\frac{z'}{r} = \\frac{\\cos\\left(\\frac{\\sigma}{r_{0}}\\right)}{R + r_{0}\\cos\\left(\\frac{\\sigma}{r_{0}}\\right)}$\n\n**高斯曲率及求值**\n\n高斯曲率 $K$ 是主曲率的乘积，$K = \\kappa_1 \\kappa_2$。\n$$\nK(\\sigma) = \\left(\\frac{1}{r_{0}}\\right) \\left( \\frac{\\cos\\left(\\frac{\\sigma}{r_{0}}\\right)}{R + r_{0}\\cos\\left(\\frac{\\sigma}{r_{0}}\\right)} \\right) = \\frac{\\cos\\left(\\frac{\\sigma}{r_{0}}\\right)}{r_{0}\\left(R + r_{0}\\cos\\left(\\frac{\\sigma}{r_{0}}\\right)\\right)}\n$$\n问题要求在对应于 $(\\sigma, \\theta) = (0,0)$ 的点处 $K(\\sigma)$ 的值。高斯曲率 $K$ 仅依赖于 $\\sigma$。我们在 $\\sigma=0$ 处求值：\n$$\nK(0) = \\frac{\\cos\\left(\\frac{0}{r_{0}}\\right)}{r_{0}\\left(R + r_{0}\\cos\\left(\\frac{0}{r_{0}}\\right)\\right)} = \\frac{\\cos(0)}{r_{0}(R + r_{0}\\cos(0))} = \\frac{1}{r_{0}(R + r_{0}(1))}\n$$\n因此，在指定点的高斯曲率是：\n$$\nK(0) = \\frac{1}{r_{0}(R + r_{0})}\n$$\n这个点 $X(0,0) = (R+r_0, 0, 0)$ 位于环面的外赤道上，这是一个具有正高斯曲率的椭圆区域，与我们的结果一致。", "answer": "$$\\boxed{\\frac{1}{r_{0}(R + r_{0})}}$$", "id": "3003640"}, {"introduction": "形算子不仅是描述静态几何的工具，它还在几何分析和物理模拟中扮演着核心的动态角色。本练习将理论推向了计算实践的前沿，要求你设计一个数值方案来模拟平均曲率流——一个由形算子的迹（即平均曲率）驱动的曲面演化过程。通过这个练习，你将体验到微分几何概念如何转化为算法，并用于解决计算几何中的实际问题 [@problem_id:3003632]。", "problem": "您将设计并实现一个显式数值格式，以使用形状算子（Weingarten 映射）在平均曲率流下演化一个由图 $z = h(x,y,t)$ 给出的曲面。请在沉浸于欧几里得三维空间中，并参数化为 $X(u,v,t) = (u, v, h(u,v,t))$ 的曲面背景下进行纯粹的计算。您必须从核心定义出发推导该格式，并在具有周期性边界条件的均匀矩形网格上使用有限差分法实现它。\n\n使用的基本原理和定义：\n- 第一基本形式 $g$ 是一个 $2 \\times 2$ 矩阵 $g = \\begin{pmatrix} E  F \\\\ F  G \\end{pmatrix}$，其中 $E = \\langle X_u, X_u \\rangle$，$F = \\langle X_u, X_v \\rangle$，$G = \\langle X_v, X_v \\rangle$。\n- 单位法向量为 $n = \\dfrac{X_u \\times X_v}{\\|X_u \\times X_v\\|}$。\n- 第二基本形式 $II$ 是一个 $2 \\times 2$ 矩阵 $II = \\begin{pmatrix} e  f \\\\ f  g_2 \\end{pmatrix}$，其中 $e = \\langle X_{uu}, n \\rangle$，$f = \\langle X_{uv}, n \\rangle$，$g_2 = \\langle X_{vv}, n \\rangle$。\n- 形状算子（Weingarten 映射）是切空间上的 $S = g^{-1} II$，其特征值是主曲率。主曲率之和等于 $\\operatorname{tr} S$。\n\n图几何的特化：\n- 对于 $X(u,v) = (u, v, h(u,v))$，记 $h_x = \\partial_x h$，$h_y = \\partial_y h$，$h_{xx} = \\partial_{xx} h$，$h_{xy} = \\partial_{xy} h$，$h_{yy} = \\partial_{yy} h$ 以及 $W = \\sqrt{1 + h_x^2 + h_y^2}$。\n- 那么 $E = 1 + h_x^2$，$F = h_x h_y$，$G = 1 + h_y^2$，以及 $e = \\dfrac{h_{xx}}{W}$，$f = \\dfrac{h_{xy}}{W}$，$g_2 = \\dfrac{h_{yy}}{W}$。\n- 由此，$\\operatorname{tr} S$ 可以完全用 $h$ 及其一阶和二阶导数表示：\n$$\n\\operatorname{tr} S \\;=\\; \\frac{(1 + h_y^2)\\,h_{xx} - 2 h_x h_y\\, h_{xy} + (1 + h_x^2)\\,h_{yy}}{W^3}.\n$$\n\n图的平均曲率流：\n- 考虑以下关于高度函数 $h$ 的标量演化方程，该方程与平均曲率流密切相关：\n$$\n\\partial_t h \\;=\\; W \\, \\operatorname{tr} S \\;=\\; W \\, \\frac{(1 + h_y^2)\\,h_{xx} - 2 h_x h_y\\, h_{xy} + (1 + h_x^2)\\,h_{yy}}{W^3}\n\\;=\\; \\operatorname{div}\\!\\left(\\frac{\\nabla h}{W}\\right) \\, W.\n$$\n- 注意，对于小坡度，该方程线性化为热方程 $\\partial_t h \\approx \\Delta h$。\n\n离散化要求：\n- 在具有 $N \\times N$ 个点的方形域上使用均匀网格，并在两个方向上采用周期性边界条件。\n- 对一阶和二阶导数使用中心有限差分：\n  - $h_x \\approx \\dfrac{h(x+\\Delta x, y) - h(x-\\Delta x, y)}{2\\Delta x}$，\n  - $h_y \\approx \\dfrac{h(x, y+\\Delta y) - h(x, y-\\Delta y)}{2\\Delta y}$，\n  - $h_{xx} \\approx \\dfrac{h(x+\\Delta x, y) - 2 h(x,y) + h(x-\\Delta x, y)}{\\Delta x^2}$，\n  - $h_{yy} \\approx \\dfrac{h(x, y+\\Delta y) - 2 h(x,y) + h(x, y-\\Delta y)}{\\Delta y^2}$，\n  - $h_{xy} \\approx \\dfrac{h(x+\\Delta x,y+\\Delta y) - h(x+\\Delta x,y-\\Delta y) - h(x-\\Delta x,y+\\Delta y) + h(x-\\Delta x,y-\\Delta y)}{4 \\Delta x \\Delta y}$。\n- 通过上述公式，由离散导数组建 $\\operatorname{tr} S$。\n- 演化一个显式欧拉步：\n$$\nh^{n+1} \\;=\\; h^n \\;+\\; \\Delta t \\, W(h^n) \\, \\operatorname{tr} S(h^n).\n$$\n\n您需要在解决方案中讨论稳定性问题：\n- 解释对于小坡度，该格式线性化为离散热方程的前向欧拉法，其经典条件为 $\\Delta t \\leq \\dfrac{\\Delta x^2 \\, \\Delta y^2}{2(\\Delta x^2 + \\Delta y^2)}$。当 $\\Delta x = \\Delta y$ 时，这简化为 $\\Delta t \\leq \\dfrac{\\Delta x^2}{4}$。\n- 为了在具有周期性边界的非线性情况下保证鲁棒性，请声明并使用一个保守选择，例如 $\\Delta t_{\\max} = 0.24 \\, \\min(\\Delta x, \\Delta y)^2$。\n\n测试套件和要求输出：\n- 使用一个 $N=65$ 的方形网格，域为 $[-1,1] \\times [-1,1]$，因此 $\\Delta x = \\Delta y = \\dfrac{2}{N-1}$。\n- 定义在时间 $t=0$ 时的以下曲面 $h(x,y)$：\n  1. 平面：$h(x,y) = 0$。\n  2. 抛物面：$h(x,y) = \\dfrac{x^2 + y^2}{2R}$，其中 $R = 2$。在原点处，$W = 1$ 且 $\\operatorname{tr} S = \\dfrac{2}{R}$。\n  3. 球冠：$h(x,y) = \\sqrt{R^2 - x^2 - y^2} - R$，其中 $R = 5$（定义域安全地位于球冠内部）。在原点处，$W = 1$ 且 $\\operatorname{tr} S = -\\dfrac{2}{R}$。\n- 对于每个曲面，计算离散的 $\\operatorname{tr} S$ 和 $W$ 场，并记录与 $(x,y)=(0,0)$ 对应的网格索引处的中心点值。\n- 计算保守稳定性界限 $\\Delta t_{\\max} = 0.24 \\, \\Delta x^2$。\n- 使用 $R=2$ 的抛物面，以 $\\Delta t = \\dfrac{1}{2} \\Delta t_{\\max}$ 执行恰好一次显式欧拉更新，并报告观测到的中心高度增量与预测增量 $\\Delta t \\cdot \\dfrac{2}{R}$ 之间的绝对差。\n\n您的程序必须生成一行输出，其中包含以下五个浮点数，顺序完全一致，用方括号括起来并用逗号分隔：\n- 平面中心点 $\\operatorname{tr} S$ 的绝对值。\n- 抛物面中心点 $\\operatorname{tr} S$ 与理论值 $\\dfrac{2}{R}$ 之间的绝对差。\n- 球冠中心点 $\\operatorname{tr} S$ 与理论值 $-\\dfrac{2}{R}$ 之间的绝对差。\n- 保守稳定性界限 $\\Delta t_{\\max}$。\n- 在抛物面上使用 $\\Delta t = \\dfrac{1}{2} \\Delta t_{\\max}$ 进行一步演化后，观测到的中心增量与预测值 $\\Delta t \\cdot \\dfrac{2}{R}$ 之间的绝对差。\n\n角度单位不适用。不涉及任何物理单位。您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3,result4,result5]”）。", "solution": "该问题的目标是为作为函数图 $z = h(x,y,t)$ 给出的曲面，实现一个求解其平均曲率流的显式数值解法。高度函数 $h$ 的演化由以下偏微分方程描述：\n$$ \\partial_t h = W \\operatorname{tr} S $$\n其中 $W = \\sqrt{1 + (\\partial_x h)^2 + (\\partial_y h)^2}$，而 $\\operatorname{tr} S$ 是形状算子的迹，对于函数图，其表达式为：\n$$ \\operatorname{tr} S = \\frac{(1 + (\\partial_y h)^2)\\,\\partial_{xx} h - 2 (\\partial_x h) (\\partial_y h)\\, \\partial_{xy} h + (1 + (\\partial_x h)^2)\\,\\partial_{yy} h}{W^3} $$\n将此代入演化方程，得到更新规则的右侧项(RHS)：\n$$ \\partial_t h = \\frac{(1 + (\\partial_y h)^2)\\,\\partial_{xx} h - 2 (\\partial_x h) (\\partial_y h)\\, \\partial_{xy} h + (1 + (\\partial_x h)^2)\\,\\partial_{yy} h}{W^2} $$\n求解该问题的核心步骤如下：\n\n**1. 空间导数的离散化**\n问题在 $[-1, 1] \\times [-1, 1]$ 区域的均匀 $N \\times N$ 网格上离散化。对于 $N=65$，网格间距为 $\\Delta x = \\Delta y = \\frac{2}{64} = \\frac{1}{32}$。我们使用中心有限差分格式来近似每个网格点 $(i,j)$ 上的偏导数。周期性边界条件通过数组的滚动操作（例如 `numpy.roll`）高效实现。\n\n**2. 时间积分与稳定性**\n时间演化采用显式前向欧拉法。给定时间步 $n$ 的高度场 $h^n$，下一个时间步 $n+1$ 的高度场计算如下：\n$$ h^{n+1} = h^n + \\Delta t \\, (\\partial_t h)^n = h^n + \\Delta t \\, (W \\operatorname{tr} S)^n $$\n其中 $(W \\operatorname{tr} S)^n$ 是使用 $h^n$ 的离散导数计算得到的演化方程右侧项。\n显式欧拉法是条件稳定的。对于该非线性方程，问题指定了一个保守的时间步长上限 $\\Delta t_{\\max} = 0.24 \\, \\min(\\Delta x, \\Delta y)^2$ 以确保数值稳定性。\n\n**3. 执行测试案例**\n按照上述数值方案，我们可以编写一个程序来执行问题中定义的测试。\n- **网格设置**：建立一个 $N=65$ 的网格，坐标范围为 $[-1,1]$。\n- **测试案例 1 (平面)**：对于 $h(x,y)=0$，所有偏导数均为零，因此数值计算得到的 $\\operatorname{tr} S$ 也应为零。\n- **测试案例 2 (抛物面)**：对于 $h(x,y) = \\frac{x^2+y^2}{2R}$，其理论上的 $\\operatorname{tr} S = \\frac{2}{R}$ 是一个常数。由于中心差分对于二次多项式是精确的，在原点处的数值结果应与理论值高度吻合。\n- **测试案例 3 (球冠)**：对于 $h(x,y) = \\sqrt{R^2 - x^2 - y^2} - R$，其理论上的 $\\operatorname{tr} S = -\\frac{2}{R}$。由于函数并非多项式，有限差分会引入截断误差，因此数值结果与理论值之间会存在微小差异。\n- **测试案例 4 (稳定性)**：根据公式 $\\Delta t_{\\max} = 0.24 \\, \\Delta x^2$ 计算时间步长上限。\n- **测试案例 5 (欧拉步)**：在抛物面上，使用 $\\Delta t = \\frac{1}{2}\\Delta t_{\\max}$ 执行单步演化。将中心点高度的数值增量与理论预测增量 $\\Delta t \\cdot \\frac{2}{R}$进行比较。\n\n最终的 Python 代码实现了这些步骤，并计算出题目要求的五个输出值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a numerical scheme for mean curvature flow and computes\n    the required outputs for the test suite.\n    \"\"\"\n    \n    # 1. Grid and Test Parameters Setup\n    N = 65\n    domain_L = 2.0  # Domain is [-1, 1], so length is 2\n    dx = domain_L / (N - 1)\n    dy = dx  # Square grid\n\n    center_idx = (N - 1) // 2\n\n    x = np.linspace(-1.0, 1.0, N)\n    y = np.linspace(-1.0, 1.0, N)\n    X, Y = np.meshgrid(x, y)\n\n    def compute_tr_S(h, dx, dy):\n        \"\"\"\n        Computes the trace of the shape operator using finite differences.\n        \n        Args:\n            h (np.ndarray): The N x N height field.\n            dx (float): Grid spacing in x.\n            dy (float): Grid spacing in y.\n            \n        Returns:\n            tuple[np.ndarray, np.ndarray]: A tuple containing the W field\n                                           and the tr(S) field.\n        \"\"\"\n        # Periodic boundary conditions via np.roll\n        # First derivatives\n        h_x = (np.roll(h, -1, axis=1) - np.roll(h, 1, axis=1)) / (2 * dx)\n        h_y = (np.roll(h, -1, axis=0) - np.roll(h, 1, axis=0)) / (2 * dy)\n\n        # Second derivatives\n        h_xx = (np.roll(h, -1, axis=1) - 2 * h + np.roll(h, 1, axis=1)) / (dx**2)\n        h_yy = (np.roll(h, -1, axis=0) - 2 * h + np.roll(h, 1, axis=0)) / (dy**2)\n        \n        # Mixed derivative\n        h_xp_yp = np.roll(np.roll(h, -1, axis=1), -1, axis=0)\n        h_xp_ym = np.roll(np.roll(h, -1, axis=1), 1, axis=0)\n        h_xm_yp = np.roll(np.roll(h, 1, axis=1), -1, axis=0)\n        h_xm_ym = np.roll(np.roll(h, 1, axis=1), 1, axis=0)\n        h_xy = (h_xp_yp - h_xp_ym - h_xm_yp + h_xm_ym) / (4 * dx * dy)\n\n        # Compute W\n        W_sq = 1 + h_x**2 + h_y**2\n        W = np.sqrt(W_sq)\n        \n        # Compute tr(S)\n        numerator = (1 + h_y**2) * h_xx - 2 * h_x * h_y * h_xy + (1 + h_x**2) * h_yy\n        tr_S = numerator / (W**3)\n        \n        return W, tr_S\n\n    results = []\n\n    # 2. Test Cases\n    # Test Case 1: Plane\n    h_plane = np.zeros((N, N))\n    _W_plane, tr_S_plane = compute_tr_S(h_plane, dx, dy)\n    result1 = np.abs(tr_S_plane[center_idx, center_idx])\n    results.append(result1)\n\n    # Test Case 2: Paraboloid\n    R_para = 2.0\n    h_para = (X**2 + Y**2) / (2 * R_para)\n    W_para, tr_S_para = compute_tr_S(h_para, dx, dy)\n    tr_S_center_para_num = tr_S_para[center_idx, center_idx]\n    tr_S_center_para_theory = 2.0 / R_para\n    result2 = np.abs(tr_S_center_para_num - tr_S_center_para_theory)\n    results.append(result2)\n\n    # Test Case 3: Spherical Cap\n    R_sphere = 5.0\n    # Ensure domain is valid\n    radius_sq = X**2 + Y**2\n    h_sphere = np.sqrt(R_sphere**2 - radius_sq) - R_sphere\n    _W_sphere, tr_S_sphere = compute_tr_S(h_sphere, dx, dy)\n    tr_S_center_sphere_num = tr_S_sphere[center_idx, center_idx]\n    tr_S_center_sphere_theory = -2.0 / R_sphere\n    result3 = np.abs(tr_S_center_sphere_num - tr_S_center_sphere_theory)\n    results.append(result3)\n\n    # Test Case 4: Stability Bound\n    dt_max = 0.24 * dx**2\n    result4 = dt_max\n    results.append(result4)\n\n    # Test Case 5: Euler Step\n    dt = 0.5 * dt_max\n    # Evolution term is W * tr(S)\n    rhs = W_para * tr_S_para\n    h_new = h_para + dt * rhs\n    \n    # Observed increment at center\n    obs_increment = h_new[center_idx, center_idx] - h_para[center_idx, center_idx]\n    \n    # Predicted increment at center. At the center (0,0), W=1, tr(S)=2/R.\n    # The evolution equation dh/dt = W * tr(S) becomes dh/dt = 2/R.\n    pred_increment = dt * (2.0 / R_para)\n    \n    result5 = np.abs(obs_increment - pred_increment)\n    results.append(result5)\n\n    # Final print statement\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3003632"}]}