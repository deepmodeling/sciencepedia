## 应用与跨学科联系

在遍历了扩散图的原理之后，我们现在站在了一个制高点。我们已经看到如何从一[团数](@entry_id:272714)据点中构建一种新的地图，一种距离不是以米或英里衡量，而是以从一个点“扩散”到另一个点的可能性来衡量的地图。这是一个深刻的视角转变。但是，一幅地图，无论其构造多么优雅，其用处仅在于它能让我们探索的新世界。我们能用这些地图*做*什么呢？

事实证明，这种几何学的思维方式是一种通用语言，能够描述各种各样复杂系统中隐藏的结构。从发育中胚胎的复杂芭蕾，到[神经回路](@entry_id:169301)中编码的短暂思绪，从化学反应的微妙舞蹈，到人工智能的创造火花，扩散图提供了一个发现底层简单性的透镜。现在，让我们开始一次对这些应用的巡礼，看看这个美妙的想法如何统一科学世界中看似迥然不同的角落。

### 绘制生命过程图谱：生物学与医学

也许扩散图最直观、最强大的应用在于发育生物学。想象一下成千上万个单细胞的集合，每个细胞都是一个基因表达谱的快照。我们知道这些细胞是发育过程的一部分——例如，干细胞转变为肌肉细胞——但这些快照都是混杂在一起的。我们如何将它们按顺序排列？这就是推断“[伪时间](@entry_id:262363)”的问题。

扩散图提供了一个惊人优雅的解决方案。通过将每个细胞视为一个点并构建扩散图，我们发现最主要的、“最慢”的扩散路径恰好遵循了发育轨迹本身。第一个非平凡扩散坐标，即与小于1的[最大特征值](@entry_id:1127078)相关联的[特征向量](@entry_id:151813)，有效地为每个细胞赋予一个值，使其沿着这条路径排序。一个简单的思想实验可以清楚地说明这一点：如果我们的细胞排列成一个完美的环，第一个扩散坐标会像角度的余弦一样在环周围平滑变化，提供一个完美的圆形坐标 。在真实的[生物过程](@entry_id:164026)中，这更像是一个分叉的路径，这个坐标追踪了从一个状态到另一个状态的进展。这不仅仅是一个理论上的好奇心；它是一个实用的计算流程，用于研究干[细胞重编程](@entry_id:156155)等过程，我们可以拿一个复杂的数据集，利用到指定“根”细胞的扩散距离，来绘制从一种细胞类型到另一种细胞类型的整个旅程，并通过观察已知的早期和晚期基因是否在正确的时间开启和关闭来验证结果 。

同样的逻辑从单个细胞类型的发育延伸到整个患者的疾病进展。来自[电子健康记录](@entry_id:899704)的临床数据极其复杂，是实验室测试、生命体征和诊断结果的高维混乱组合。“[流形假设](@entry_id:275135)”提出，尽[管存](@entry_id:1127299)在这种复杂性，慢性病的进展遵循着一条简单得多的低维路径。扩散图允许我们通过将患者嵌入到一个低维空间中来检验这个假设，在这个空间里，距离反映了他们疾病状态的相似性。关键是，我们必须考虑数据中的偏差；一家医院可能在疾病早期阶段的患者比晚期阶段多得多。通过使用密度归一化方案（特别是将图与内在[Laplace-Beltrami算子](@entry_id:267002)联系起来的$\alpha=1$设置），我们可以滤除这种[采样偏差](@entry_id:193615)，并揭示疾病流形本身的真实几何形状。这使得患者表型分型更有意义，能够发现标准方法可能看不到的、处于相似轨迹上的患者集群 。

这个框架的力量在于其灵活性。在新兴的[空间分辨转录组学](@entry_id:922511)领域，我们不仅拥有细胞的基因表达谱，还拥有其在组织内的物理位置。我们如何创建一个既尊重基因表达又尊重物理位置的地图？扩散图基于核的特性提供了答案。我们可以设计一个新的“亲和”核，它结合了两个项：一项用于基因表达的相似性，另一项用于物理空间的邻近性。通过引入一个平衡这两种模态贡献的[比例因子](@entry_id:266678)——这个因子可以通过要求典型的基因距离和空间距离贡献相等而从数据本身推导出来——我们可以构建一个统一的图，揭示由分子状态和空间组织共同定义的[组织结构](@entry_id:146183) 。

也许最深刻的联系来自于我们将这种绘图类比推向极致。一幅地图不仅有路径和距离，还有地形，有山有谷。令人惊讶的是，扩散图可以揭示一个类似的“[准势能](@entry_id:196547)景观”。[扩散过程](@entry_id:268015)的[稳态概率](@entry_id:276958)——即长时间后在某个特定状态下发现一个细胞的可能性——通过与支配气体分子的相同[玻尔兹曼关系](@entry_id:1121743) $\rho \propto \exp(-U/D)$ 与有效势能相关联。例如，在免疫学中，这些谷代表稳定的[细胞命运](@entry_id:268128)，而它们之间的小山代表细胞改变其身份必须克服的“能量壁垒”。通过从数据中估计[稳态概率](@entry_id:276958)，我们可以直接计算这些壁垒的高度，从而得到一个完全从数据几何中推导出的、定量的、物理的[细胞决策](@entry_id:270557)模型 。

### 揭示分子的编排：物理学与化学

势能景观的语言自然而然地将我们带到了物理学和化学领域，这个概念在这些领域是土生土长的。考虑一个在计算机上模拟的化学反应。一个由许多原子组成的分子，在成千上万维的空间中扭动和旋转。反应本身——一个键的断裂，一个分子的折叠——是一个罕见事件，是从一个复杂的[势能面](@entry_id:143655)上稳定的“反应物”盆地到稳定的“产物”盆地的短暂过渡。识别“反应坐标”，即最能描述此转变的一维路径，是一个核心挑战。

在这里，扩散图再次提供了一个有原则的答案。系统中最慢的过程是从反应物到产物的罕见跨越。第一个非平凡扩散坐标，通过捕捉[数据流形](@entry_id:636422)上最慢的扩散模式，提供了该[反应坐标](@entry_id:156248)的数据驱动近似。然而，要正确做到这一点，需要物理洞察力。模拟数据并[非均匀采样](@entry_id:752610)；由于[玻尔兹曼统计](@entry_id:746908)的结果，系统大部分时间都停留在低能量盆地中。一个朴素的扩散图会被这种采样所偏倚。解决方案是使用密度校正来剔除这种已知的偏差，从而让图揭示底层的动力学。然后，可以将得到的坐标与“committor”（一种物理上严谨的反应进程定义）进行验证，以确认其质量 。

这个工具甚至可以成为更大诊断工作流的一部分。在诸如[温度加速动力学](@entry_id:755832)等方法中，我们假设跃迁是简单的[无记忆过程](@entry_id:267313)，这意味着等待一个事件发生的时间应该遵循[指数分布](@entry_id:273894)。如果模拟显示情况并非如此，这就是一个警示信号：肯定有一个未被考虑的“隐藏”慢变量。这种统计观察随后可以触发对系统构象的扩散[图分析](@entry_id:750011)，以找到那个缺失的坐标，从而揭示破坏简单模型的隐藏复杂性 。

协同作用可以更进一步，形成一个分析主动引导模拟的闭环。在诸如元动力学等增强[采样方法](@entry_id:141232)中，我们试图通过用排斥性偏置势“填充”已访问过的盆地来加速对能量景观的探索，从而推动系统越过壁垒。但我们应该如何塑造这个偏置呢？一个糟糕的选择可[能效](@entry_id:272127)率低下，甚至会扭曲物理过程。扩散图提供了一个绝妙的解决方案。通过将系统嵌入到扩散坐标中，我们进入了一个欧几里得距离具有动力学意义的空间——它就是[扩散距离](@entry_id:915259)。一个有原则的策略是沉积在此扩散空间中呈球形的高斯山。当转换回原始[坐标时](@entry_id:263720)，这对应于一个*各向异性*的偏置，它根据[慢流形](@entry_id:1131769)的几何形状及其动力学的时间尺度被精心塑造。其结果是对分子世界进行更智能、更高效的探索，这种探索由系统自身揭示的几何所引导 。

### 描绘思想与创造的景观：神经科学与人工智能

这些几何思想的影响力延伸到了最复杂和抽象的领域：大脑和人工智能。大脑是一个动力学系统。一群神经元的放电模式随时间演变，在一个高维[状态空间](@entry_id:160914)中描绘出一条轨迹。据推测，思想、记忆和行动对应于该动力学系统中的[吸引子](@entry_id:270989)——稳定的不动点或[极限环](@entry_id:274544)。

如果一个[神经回路](@entry_id:169301)的活动由一个[极限环吸引子](@entry_id:274193)控制，其[状态空间](@entry_id:160914)轨迹将描绘出一个具有圆拓扑（$S^1$）的流形。我们如何从神经[活动记录](@entry_id:636889)中发现这一点？扩散图提供了一个直接而惊人的答案。圆上的[Laplace-Beltrami算子](@entry_id:267002)的特征函数就是简单的正弦和余弦。通过从神经数据构建一个经过密度校正的扩散图，我们可以恢复这些[特征函数](@entry_id:186820)的近似值。将前两个非平凡扩散坐标相互绘制，将真正地把圆形动力学“展开”成一个清晰的圆，揭示正在执行的计算的隐藏周期性结构。通过调整[扩散时间](@entry_id:274894)参数$t$，我们可以滤除快速、嘈杂的波动，并分离出代表[神经计算](@entry_id:154058)核心的这个缓慢的、循环的流形 。

最后，我们转向机器创造力的挑战。[生成对抗网络](@entry_id:141938)（GANs）通过生成器和判别器之间的博弈来学习创建逼真的数据，如图像或文本。一个臭名昭著的问题是“[模式崩溃](@entry_id:636761)”，即生成器只学会产生少数几个令人信服的样本，未能捕捉到真实数据的全部多样性。这通常是因为当其创作落入远离真实[数据流形](@entry_id:636422)的广阔“空白”空间时，[判别器](@entry_id:636279)会给生成器提供无意义的梯度。

解决方案是使[判别器](@entry_id:636279)“流形感知”。我们不是在原始高维空间中评估生成的样本，而是首先使用基于真实数据构建的扩散图将其嵌入。然后，[判别器](@entry_id:636279)在这个更简单、结构更清晰的空间中操作。它提供给生成器的梯度现在具有几何意义。对于一个远离真实[数据流形](@entry_id:636422)的生成样本，梯度会提供一个强大的纠正性推动，使其回到流形上，从而[稳定训练](@entry_id:635987)。对于一个位于流形上但处于生成器已经过度生成的区域的样本，判别器会提供一个平滑的梯度，鼓励它探索其他采样较少的区域。这种扩散几何的应用有助于解决[生成模型](@entry_id:177561)中最深层的问题之一，通过教会机器它试图模仿的世界的内在形状，来指导机器的创造过程 。

从生物学到物理学再到人工智能，一个统一的主题浮现出来。世界的令人困惑的复杂性背后往往隐藏着一个优雅的低维结构。扩散图为我们提供了一种强大的几何语言来发现和解释这种结构。它们所做的不仅仅是创造图像；它们揭示了支配我们周围系统的基本坐标、势能景观和运动规则。它们向我们展示，通过理解可能性的几何，我们可以更好地理解现实的动力学。