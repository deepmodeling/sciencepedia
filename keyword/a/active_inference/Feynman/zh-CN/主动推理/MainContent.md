## 引言
一个生命体如何在趋向于无序的世界中持续存在？从单细胞到复杂的人类，生物体必须维持其结构并驾驭环境以求生存。主动推理为这个基本问题提供了一个强大而全面的答案，它提出生命所有复杂的行为都源于一个单一的指令：最小化惊奇。该理论认为，大脑就像一个预测机器，构建一个关于世界的内部模型，然后努力使感官现实与其预期相匹配。本导论将为探索这一革命性思想奠定基础。首先，我们将探讨主动推理的核心**原理与机制**，详细说明最小化[预测误差](@entry_id:753692)这一简单行为如何同时产生感知和行动，以及如何在内在层面上平衡目标与好奇心的前瞻性规划。随后，我们将在**应用与跨学科联系**部分探讨该理论的非凡影响力，展示它如何为从身体调节和情绪到精神疾病的起源乃至人工智能的未来等一切事物提供新颖的见解。

## 原理与机制

活着就是抵抗向无序状态的不断演变。一阵风不会密谋维持其为一阵风；一滩水不会努力保持其为一滩水。然而，一个生命有机体——无论是细菌、向日葵，还是一位物理学家——其整个存在都在一场精巧而艰辛的舞蹈中度过，对抗着宇宙将万物拆解的无情趋势，以维系自身。它必须在非常狭窄的可能性范围内维持自身的结构，维持自身这种不可思议的存在状态。鱼必须待在水中，人必须将体温维持在 $37^{\circ}\text{C}$ 左右，而我们所有人都必须寻找食物并避免自己成为食物。这是生命的基本法则。

**主动推理**（Active Inference）框架为我们如何实现这一点提出了一个异常简单却又强有力的答案。它表明，大脑，乃至任何自组织系统，都遵循一个单一、统一的原则运作：它努力**最小化自由能**。但这并非蒸汽机的自由能，而是一个信息论量，衡量世界在多大程度上让我们感到惊奇。最小化惊奇就是为了把握现实，为了保持在那些可预测的、维持生命的状态中。大脑是如何做到这一点的呢？通过不断尝试预测自身的感官输入。它建立并维护一个内部的**生成模型**——一个关于世界如何运作（包括其自身）的私有模拟——然后将其全部存在都致力于让世界的乐章与其内心的乐谱相匹配。它通过两种方式实现这一点：改变其乐谱以更好地匹配乐章（感知），或者改变乐章以更好地匹配其乐谱（行动）。这两个过程，即感知和行动，并非独立的模块，而是同一枚硬币的两面，都源自于将惊奇降至最低这一单一指令。

### 作为推理的感知：理解世界

想象你身处一个光线昏暗的房间，你看到了一个形状。它是一把椅子？一个影子？还是一只潜伏的捕食者？你的感官提供了模棱两可的数据。感知问题是一个**推理问题**：你必须推断出你感官信号背后隐藏的*原因*。这就是你的大脑日复一日所做的事情。它就像一位高明的侦探，接收线索（感觉）并推断出产生这些线索的最可能的世界状态。

这项侦探工作的语言是[贝叶斯推理](@entry_id:165613)。大脑将传入的感官证据（**[似然](@entry_id:167119)**）与其预先存在的知识和期望（**先验**）相结合，形成关于世界的更新信念（**后验**）。然而，计算真实的后验信念通常复杂到不可能实现。因此，大脑用一种非常聪明的方式“作弊”。它使用**变分推理**，这是一种寻找对真实的、复杂的后验进行简化的、可处理的近似的方法。

用于此的数学工具是**[变分自由能](@entry_id:1133721)（$F$）**。最小化这个量，会驱动你的大脑信念成为对你感觉的最佳解释。自由能具有一个奇妙的双重特性 。一方面，它可以被看作是：

$F \approx \text{复杂度} - \text{准确度}$

这告诉我们，大脑寻求尽可能简单（低复杂度）同时又能尽可能准确地解释感官数据的信念。这是对**[奥卡姆剃刀](@entry_id:142853)**原理的数学形式化。另一方面，自由能可以表示为：

$F = D_{\mathrm{KL}}(Q || P) - \ln p(\text{data})$

在这里，$D_{\mathrm{KL}}(Q || P)$ 是 Kullback-Leibler 散度，用于衡量你的近似信念（$Q$）与真实后验（$P$）之间的“距离”。第二项，$-\ln p(\text{data})$，就是我们所说的**惊奇**——即在你的世界模型下，感官数据是多么不可能。由于我们无法改变已经接收到的数据，最小化自由能意味着让我们的近似信念尽可能接近我们试图推断的“真相”。如此一来，自由能就成为了惊奇的替代品或代理。

这在大脑的“湿件”（wetware）中是如何实现的呢？一个引人注目的理论是**[预测编码](@entry_id:150716)**。想象一下大脑皮层是按层级组织的 。这个层级的较高级别持有关于世界更抽象的信念（例如，“房间里有一只猫”），而较低级别则处理更具体的感官细节（例如，“有垂直的线条和毛茸茸的纹理”）。较高级别不断向其下级发送**自上而下的预测**。而较低级别则将这些预测与它们接收到的实际感官输入进行比较，并将任何不匹配——任何**自下而上的预测误差**——反馈回层级上方。

整个系统通过在每一层更新信念（后验均值，$\mu_i$）来“解释掉”这些[预测误差](@entry_id:753692)。任何给定级别的更新都是其上级和下级之间的一场优美的舞蹈：它被来自下方的预测误差所推动，又被来自上方的预测所牵引。在数学上，信念的变化 $\dot{\mu}_i$ 由两项驱动：

$\dot{\mu}_i \propto \underbrace{(\text{雅可比矩阵})^\top \Pi_{i-1} \epsilon_{i-1}}_{\text{自下而上的误差}} - \underbrace{\Pi_i \epsilon_i}_{\text{自上而下的预测}}$

这就是运行中的感知：一个连续、动态的过程，通过调整内部[生成模型](@entry_id:177561)来最小化预测误差，这等同于最小化[变分自由能](@entry_id:1133721)。你不仅仅是“看到”一只猫；你的大脑稳定在一个最佳假设——“猫”——上，这个假设能最好地抑制你眼睛正在产生的预测误差洪流。

### 作为推理的行动：塑造世界以适应预测

现在，我们来到主动推理中真正“主动”的部分。当出现一个你无法仅通过改变想法来解释掉的预测误差时，会发生什么？假设你的内部模型预测了温暖舒适的感觉，但你的皮肤却在大喊“冷！”你产生了一个预测误差。你可以改变你的信念（“我想现在是冷的”），但还有另一种更主动的解决方案：你可以行动。你可以穿上一件毛衣。

这是最小化惊奇的第二种方式。**行动是改变世界以使其符合你的模型预测的过程。**它是在物理世界中上演的推理。考虑拿起一个咖啡杯这个简单的动作 。你的大脑有一个目标，这个目标被框定为一个预测：它预测你的手握住杯子时的[本体感觉](@entry_id:153430)。开始时，你的手在桌子上，你所感觉到的和你所预测的之间存在巨大的[预测误差](@entry_id:753692)。这个误差沿着运动层级向下传递，但它不是用来更新信念，而是用来生成运动指令。这些指令精确地移动你的手臂，以抵消[本体感觉](@entry_id:153430)的预测误差。你的手臂移动，你手的感觉越来越接近预测，误差缩小，当误差为零时，你的手正握着杯子。你的预测得以实现。

这产生了一个简单、优雅的控制律，看起来像一个[反射弧](@entry_id:156796)。行动 $a$ 与[精度加权](@entry_id:914249)的感官[预测误差](@entry_id:753692) $\epsilon_y$ 成正比：

$a \propto \left(\frac{\partial y}{\partial a}\right)^\top \Pi_y \epsilon_y$

行动简直就是感知的孪生兄弟。感知通过改变内部信念来最小化[预测误差](@entry_id:753692)；行动通过改变外部现实来最小化[预测误差](@entry_id:753692)。两者都服务于同一个主人：最小化自由能。

### 为未来规划：最小化*预期*自由能

到目前为止，我们有了一个能够感知现在并为实现其即时预测而行动的生物。但它如何决定*预测什么*呢？它如何为未来做计划？它通过最小化它*预期*在未来会遇到的自由能来实现这一点。在评估不同的计划或**策略**时，智能体会选择那个最小化**预期自由能（$G$）**的策略 。

这正是该理论真正美妙之处的闪光点，因为预期自由能可以分解为两个非常直观的组成部分：

1.  **工具价值（或实用价值）：** 这是驱动[目标导向行为](@entry_id:913224)的部分。智能体有偏好——对食物、温暖、安全——这些偏好被编码在其生成模型中，作为它*将要*观察到这些偏好结果的[先验信念](@entry_id:264565)。如果一个策略很可能导向这些偏好的、不令人惊奇的状态，那么它就具有很高的工具价值。这关乎将未来引向你想要的方向。

2.  **认知价值（或[信息增益](@entry_id:262008)）：** 这是驱动好奇心和探索的部分。如果一个策略有望解决关于世界的不确定性，那么它就具有很高的认知价值。想象一下，你听到隔壁房间有声音。你对其原因感到不确定。“过去看看”这个行动可能不会满足像寻找食物这样的即时偏好，但它很有价值，因为它有望减少你的不确定性——提供[信息增益](@entry_id:262008) 。主动推理智能体天生就具有好奇心。它们主动寻求信息以改善其世界模型，这反过来又有助于它们在长期内更有效地实现目标。

因此，通过最小化预期自由能来选择策略，是在**利用**（追求你已知想要的东西）和**探索**（减少不确定性以便稍后做出更好的选择）之间进行无缝的权衡。与标准的强化学习不同（在[强化学习](@entry_id:141144)中，探索通常需要作为一种独立的机制加入），在主动推理中，寻求信息的驱动力是[目标函数](@entry_id:267263)本身一个基本的、不可分割的部分 。

### 大脑、身体与世界的统一

从这个框架中浮现的是一种深刻的统一性。感知与行动之间，或规划与执行之间，没有硬性界限。一切都只是推理。智能体只是在其信念空间和物理世界中确定了一条与其自身存在最一致的轨迹。这个思想在**作为推理的规划**这一概念中被形式化 ，即选择一个策略无非是推断出最可能的策略，这取决于你的偏好和你理解世界的需要。

这种紧密的耦合产生了具体的、可检验的预测，将主动推理与像[最优控制](@entry_id:138479)这样的经典工程方法区分开来。在许多控制理论中，存在一个**分离原则**：你可以将估计系统状态的问题与决定如何控制它的问题分离开。主动推理没有这样的分离 。你的感官数据精度（一个估计参数）将直接影响你运动的力度和反馈增益（控制参数）。如果你的[视力](@entry_id:204428)变得模糊，你不仅会不太确定你的手在哪里，你还会更谨慎地移动它。估计和控制是一回事。

为了处理现实世界中时间的平滑、连续流动，该理论甚至扩展到所谓的**广义运动坐标** 。为了准确预测一个移动物体（或你自己的身体）的轨迹，你不仅需要对其位置建模，还需要对其速度、加速度等建模。通过扩展其世界模型以包含这些[高阶导数](@entry_id:140882)，智能体可以对展开的未来做出丰富、深刻的预测，将一个复杂、非局域的[时间问题](@entry_id:202825)转化为一个在扩展[状态空间](@entry_id:160914)中可处理的、局域的推理问题。

从生存的基本需要出发，我们一路走来，抵达了一个单一、优雅的原则，它统一了感知、行动、好奇心和目标导向的规划。主动推理智能体不仅仅是世界的被动观察者，也不是简单的寻求奖励的自动机。它是一个积极的参与者，一个成长中的科学家，不断完善其世界模型，并采取行动使世界与其预测保持一致，所有这些都是为了避免惊奇，并以此维持自身存在。这是关于作为世界中的一个能动者意味着什么的一个美丽、统一的愿景。

