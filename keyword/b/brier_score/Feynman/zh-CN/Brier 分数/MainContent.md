## 引言
我们如何客观地判断一个不是简单“是”或“否”的预测，而是一个概率，比如 70% 的降雨概率？单一的结果——下雨与否——无法证实或证伪该概率本身。这在从气象学到医学等领域带来了一个根本性挑战：我们需要一种方法，不仅衡量预测是否正确，还要衡量其陈述的概率随时间推移的校准度和诚实度。Brier 分数正为此问题提供了一个优雅而强大的解决方案。

本文将 Brier 分数探讨为概率真实性的主要仲裁者。在第一部分 **原理与机制** 中，我们将剖析该分数本身，理解其计算方式、“技能”的含义，以及它如何分解为可靠性、分辨率和不确定性，从而为任何预测提供丰富的诊断报告。接下来，**应用与跨学科联系** 部分将带领我们走进现实世界，揭示这一单一指标如何在不同领域中强制诚实并推动发现，从预测飓风和保护关键基础设施，到改善[肿瘤学](@entry_id:272564)中的患者预后，以及在司法体系中维护道德标准。

## 原理与机制

我们如何判断一个[概率预测](@entry_id:1130184)的好坏？如果气象学家说有 70% 的降雨概率，而最终下雨了，他们是正确的吗？如果没下雨呢？单一事件无法证实或[证伪](@entry_id:260896)一个概率。预测并非“下雨”，而是“70% 的降雨概率”。要真正评判这类预测的质量，我们需要一种方法来审视其在众多事件上的表现，一个不仅奖励结果正确，更奖励*概率*正确的工具。这就是 **Brier 分数** 的简约优雅之处。

### 什么是好的猜测？概率评分的艺术

设想一位医生正在开发一个模型，用于预测患者是否会对某种药物产生不良反应 。对于一位患者，模型预测风险较低，$p=0.1$；对于另一位，风险较高，$p=0.8$。当然，实际结果是二元的：事件要么发生（我们编码为 $y=1$），要么不发生（$y=0$）。

一种衡量预测误差的自然方法是考察预测概率 $p$ 与实际结果 $y$ 之间的差异。在物理学和统计学中，一种常用的误差衡量方法是*平方误差*，即 $(p - y)^2$。它在数学上很方便，并且有一个很好的特性，即对大误差的惩罚远大于小误差。一个大错特错的预测会受到严厉的惩罚。

**Brier 分数** 不过是一系列预测中这些平方误差的平均值 。如果我们有 $N$ 个预测 $\{p_1, p_2, \dots, p_N\}$ 及其对应的结果 $\{y_1, y_2, \dots, y_N\}$，则 Brier 分数 ($BS$) 为：

$$
BS = \frac{1}{N} \sum_{i=1}^{N} (p_i - y_i)^2
$$

由于我们计算的是差的平方，分数永远不会是负数。一个完美的预测，即对每个发生的事件预测 $p=1$，对每个未发生的事件预测 $p=0$，其 Brier 分数将恰好为 $0$。因此，**Brier 分数越低越好**。

让我们通过一个临床风险模型的小例子来看看它的实际应用 。对于四位患者，预测的不良事件风险分别为 $\{0.1, 0.3, 0.8, 0.2\}$，实际结果为 $\{0, 1, 1, 0\}$。Brier 分数的计算非常直接：

$$
BS = \frac{1}{4} \left[ (0.1 - 0)^2 + (0.3 - 1)^2 + (0.8 - 1)^2 + (0.2 - 0)^2 \right]
$$
$$
BS = \frac{1}{4} [0.01 + 0.49 + 0.04 + 0.04] = \frac{0.58}{4} = 0.145
$$

该模型得分为 0.145。但这算好吗？要回答这个问题，我们需要一些背景信息。

### 技能：你比随机猜测更好吗？

0.145 这个分数在孤立的情况下毫无意义。我们需要一个基线，一个可供比较的参考点。我们能做出的最简单的预测是什么？我们可以忽略每一天或每一位患者的具体细节，仅预测事件的长期平均频率，这被称为**气候态**或**基准率**。如果某种类型的强风暴在历史记录中 25% 的日子里会发生，那么我们的“笨”预测将是每天都预测有 25% 的风暴概率 。

这个气候态预测的 Brier 分数 $BS_{ref}$ 是一个绝佳的基准。它告诉我们仅凭历史知识而无其他信息所能得到的分数。现在我们可以定义 **Brier 技能分数 (BSS)** ：

$$
BSS = 1 - \frac{BS_{\text{forecast}}}{BS_{\text{ref}}}
$$

这个分数非常直观：
-   **完美预测** ($BS_{\text{forecast}} = 0$) 的 BSS 为 $1$。
-   **不优于气候态**的预测 ($BS_{\text{forecast}} = BS_{\text{ref}}$) 的 BSS 为 $0$。
-   **劣于气候态**的预测 ($BS_{\text{forecast}} > BS_{\text{ref}}$) 的 BSS 为负！这是一个令人惭愧的结果，告诉我们本该直接使用历史平均值，结果会更好。

这个简单的比较可以揭示出惊人的事实。例如，在预测像日冕物质抛射 (CMEs) 这样的罕见事件时，一个仅发布恒定、[固定概率](@entry_id:178551)（而非真实气候态率）的模型将获得负技能分数，表明与简单的历史平均值相比，它实际上是有害的 。

### 预测的剖析：可靠性、分辨率和不确定性

这正是 Brier 分数真正美妙之处。就像棱镜将光分解成光谱一样，这个单一的数字可以分解为三个不同的组成部分，它们共同讲述了一个关于预测、预测者和世界本身的丰富故事  。完整的分解如下：

$$
BS = \text{可靠性} - \text{分辨率} + \text{不确定性}
$$

让我们来认识一下这些角色：

1.  **不确定性**：这是自然界的贡献。它代表了被预测事件的内在变异性。如果一个事件的总体基准率是 $\bar{y}$，那么不确定性就是 $\bar{y}(1-\bar{y})$。当事件是 50/50 的情况时（如公平的抛硬币），这个值最大化；而对于非常罕见或非常普遍的事件，这个值最小。预测者无法控制这个项；它设定了预测问题的根本难度 。

2.  **可靠性**：这个部分衡量预测者的诚实度，或者更正式地说，其**校准度**。如果你将模型预测事件发生概率为 20% 的所有情况归为一组，那么在这些情况中，事件实际发生的比例是否约为 20%？可靠性项是每个分组中预测概率与观测频率之间平方差的[加权平均值](@entry_id:894528)。一个完美校准或可靠的模型，其可靠性项为零。这是对校准不良的惩罚。

3.  **分辨率**：这是预测者的“锐度”或洞察力。它衡量模型将案例成功分类到具有不同结果的组中的能力。一个高分辨率的预测会在事件可能发生的日子里给出非常高的概率，而在事件不太可能发生的日子里给出非常低的概率。一个每天只预测气候态平均值的预测者，其分辨率为零。高分辨率是好的，你会注意到它在 Brier 分数公式中是*被减去*的，这意味着它会降低你的（更好的）分数。

当与 Brier 技能分数相结合时，这种分解会带来深刻的洞见。一个预测的技能可以表示为 ：

$$
BSS = \frac{\text{分辨率} - \text{可靠性}}{\text{不确定性}}
$$

要想具备技能，预测的**分辨率必须大于其可靠性的缺失**。你辨别不同情况的能力必须超过你校准失当的倾向。所有这一切都受到问题内在难度的制约。对于非常罕见的事件，不确定性很低，这为可实现的最大分辨率设定了硬性上限，使得展示技能变得极其困难 。

### 情境中的分数：为正确的任务选择正确的工具

Brier 分数是一个强大的工具，但像任何工具一样，必须明智地使用。当我们将其与其他衡量性能的方式进行比较时，其真正价值才会显现。

#### 区分度与校准度

许多流行的评估指标，如 C-统计量（也称为 [AUROC](@entry_id:636693)），衡量的是**区分度**。这是指模型为发生事件的案例赋予比未发生事件的案例更高分数的能力。一个模型可以是完美的区分器（C-统计量 = 1），但校准度却可能极差。例如，一个为所有死亡患者预测 90% 风险、为所有存活患者预测 80% 风险的模型，具有完美的区分度（它对它们进行了正确排序），但校准度很差（其概率不可信） 。

Brier 分数，由于其分解特性，同时捕捉了**区分度（通过分辨率）和校准度（通过可靠性）**。这使其成为衡量[概率预测](@entry_id:1130184)质量更全面的指标。事实上，可以使用[保序回归](@entry_id:912334)等技术来改善模型的校准度，这在降低 Brier 分数的同时，完全不改变区分度（[AUROC](@entry_id:636693)） 。这表明这两个概念是截然不同的，并且 Brier 分数对纯粹的排序指标所忽略的性能方面很敏感。

#### 固有评分规则：对诚实的激励

我们为什么应该信任 Brier 分数？在一个深层次的理论水平上，这是因为它是一个**严格固有评分规则** 。这是一个正式的保证，即从长远来看，获得最佳（最低）期望分数的唯一方法就是报告你对概率的真实、诚实的信念。你无法“操纵”一个固有评分规则。[数学证明](@entry_id:137161)了这一点。这个特性确保了当我们使用 Brier 分数来训练模型时，我们是在激励它产生经过校准的、真实的概率。Brier 分数对错误的惩罚是有界的，这使其比其他固有规则（如对数分数，可能施加无限惩罚）更具鲁棒性，对偶尔的错误标记数据点不那么敏感 。

#### 从二元事件到连续世界

Brier 分数是为二元的“是/否”事件设计的。如果我们预测的是一个连续量，比如降雨量（以毫米为单位），该怎么办？一种常见的方法是设定一个阈值，将问题转化为二元问题：“降雨量会超过 10 毫米吗？” 。

然而，这是一把双刃剑。它丢弃了有价值的信息——11 毫米的预测被视为与 100 毫米相同。更令人担忧的是，阈值的选择可以完全改变哪个预测看起来更好。在一个阈值下看起来有技能的预测，在另一个阈值下可能看起来很糟糕。

这揭示了 Brier 分数在一个更大的指标家族中的位置。用于连续预测的首要工具是**连续分级概率分数 (CRPS)**。而它们之间美妙的联系在于：CRPS 在数学上等同于在所有可能阈值上计算的 Brier 分数的积分。它将 Brier 分数的核心思想无缝地推广到连续域，提供了一个不依赖于任意阈值选择的全面评估 。

从一个简单的平方误差公式出发，Brier 分数展开为一个用于理解预测、技能和不确定性的丰富框架。它告诉我们，一个好的预测不仅仅是经常“正确”的预测，而是一个可靠、有洞察力且最终是诚实的预测。

