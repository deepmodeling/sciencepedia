## 引言
我们的身体是由数万亿个独立细胞构成的复杂生态系统，每个细胞都执行着特定的功能。从形成我们思想的神经元到抵御病原体的免疫细胞，这种[细胞多样性](@entry_id:186095)是生命的基础。然而，几十年来，我们研究这种复杂性的能力一直受到限制。传统方法以“批量”方式分析组织，将数百万个细胞研磨在一起，测量它们的平均活动。这种方法虽然能提供信息，但掩盖了每种细胞类型的独特贡献，就像只听到人群的喧嚣而听不到其中的交谈一样。这一根本性的差距限制了我们对组织在健康状态下如何运作以及在疾病中如何功能失常的理解。

单细胞 RNA 测序 ([scRNA-seq](@entry_id:155798)) 的出现彻底改变了生物学，它使我们能够倾听每个细胞的独立声音，创建被称为参考图谱的详细细胞身份图。本文探讨了利用这些 [scRNA-seq](@entry_id:155798) 参考来解码[生物复杂性](@entry_id:261084)的力量和原理。在第一章 **原理与机制** 中，我们将探讨利用这些图谱来解析复杂数据集的核心计算策略——解[卷积和](@entry_id:263238)整合。我们将揭示这些方法如何分解细胞信号并对齐不同的数据模态。随后，在 **应用与跨学科联系** 这一章中，我们将展示这些技术如何被应用于解答从绘制[肿瘤微环境](@entry_id:152167)图谱到追踪发育谱系等不同科学领域的关键问题。通过理解参考图谱，我们解锁了一个全新的视角来观察生命的复杂结构。

## 原理与机制

想象一座巨大而繁华的城市。每个居民都是一个专家——面包师、医生、工程师、艺术家——各自扮演着对城市运转至关重要的独特角色。在生物学的世界里，我们的身体就是这些城市，而居民就是我们的细胞。每一种细胞类型，无论是在大脑中放电的神经元，还是抵御入侵者的[巨噬细胞](@entry_id:181184)，都通过遵循一套独特的指令来执行其专门的工作。这些[指令编码](@entry_id:750679)于它选择“开启”或表达的基因中。所有表达基因的完整集合及其活性水平，构成了细胞的 **转录组**——即其分子层面的工作描述和身份标识。

几十年来，生物学家只能通过倾听城市的整体喧嚣来研究它。我们可以将一块组织——一个社区——研磨开来，测量其平均基因表达。这种“批量”测量就像同时听到成千上万不同专业人士交谈的嘈杂声。你或许能判断这个社区是繁忙还是安静，但你永远无法从工程师工作室的嗡嗡声中分辨出医生的精确对话。你失去了生命中最重要、最基本的单位：细胞。

**单细胞 RNA 测序 ([scRNA-seq](@entry_id:155798))** 带来了革命。我们第一次能够分离出单个居民，并倾听每个居民独特的声音。通过将 **聚类** 等计算方法应用于这个庞大的个体对话集合，我们可以将具有相似基因表达模式的细胞分组。这类似于为整个城市创建一份全面的专业名录，或称 **图谱**，识别出每一种不同的职业，并对它们的特定技能和词汇进行分类。这个图谱，这个纯细胞类型特征的目录，就是我们所说的 **[scRNA-seq](@entry_id:155798) 参考**。

但这个过程也并非没有挑战。创建名录需要召集居民，这个过程称为组织解离。一些专业人士，比如拥有巨大、相互连接的[髓鞘](@entry_id:153229)网络的孤僻的[少突胶质细胞](@entry_id:155497)，是出了名的难以从其周围环境中分离出来，可能在被“采访”到之前就丢失了。因此，我们得到的参考图谱可能并非城市真实人口构成的完美忠实再现；它可能存在偏差，缺失某些细胞类型或低估了它们的数量。认识到这种不完美是迈向真正理解的第一步。

### 分解喧嚣：解卷积的艺术

现在，有了我们新的、尽管不完美的参考名录，我们就可以尝试一项非凡的壮举。我们可以回到那些古老的、嘈杂的整个社区的录音，并以计算方式剖析声音。如果我们有一段来[自组织](@entry_id:186805)中某个位置的录音，而我们的名录告诉我们纯粹的“面包师”信号和纯粹的“医生”信号听起来究竟是怎样的，我们能否推断出那个位置有多少面包师和医生？这就是 **解卷积** 的核心目标。

其原理非常简单，可以用一点代数来表达。想象一个生物信号的批量测量值 $S$——比如说，发育中的小鼠肢体中凋亡（[程序性细胞死亡](@entry_id:145516)）标记物的总量。这个组织包含间充质细胞（肢体的结构细胞）和入侵的[巨噬细胞](@entry_id:181184)（清除碎片的免疫细胞）。我们测量的总信号只是来自每个细胞群体的信号之和，并按其丰度加权：

$$ S_{\text{total}} = (p_{\text{mesenchyme}} \cdot s_{\text{mesenchyme}}) + (p_{\text{macrophage}} \cdot s_{\text{macrophage}}) $$

这里，$p$ 是每种细胞类型的比例，$s$ 是该类型细胞固有的、单个细胞的信号。现在，考虑一个真实的生物学难题。随着肢体的发育，我们观察到总凋亡信号 $S_{\text{total}}$ 上升。这是否意味着间充质细胞正在更多地死亡（$s_{\text{mesenchyme}}$ 增加），还是意味着更多的[巨噬细胞](@entry_id:181184)进入该区域进行清理（$p_{\text{macrophage}}$ 增加）？如果没有办法分离这些变量，我们就会陷入困境。

解卷积提供了解决方法。对于一个[空间转录组学](@entry_id:270096)斑点，其“批量信号”是在该斑点中测得的基因表达计数向量 $y$。而“单细胞信号”则是我们 [scRNA-seq](@entry_id:155798) 图谱中每种细胞类型 $k$ 的参考表达谱 $r^{(k)}$。该模型变成了一个[线性方程组](@entry_id:140416)，我们希望找到能最好地解释我们观察到的斑点表达的比例 $w_k$：

$$ y \approx w_1 r^{(1)} + w_2 r^{(2)} + \dots + w_K r^{(K)} $$

我们求解权重 $w_k$，这些权重代表了该特定斑点中每种细胞类型的估计比例。当然，这些比例必须具有物理意义——它们不能是负数，如果它们代表整体的一部分，它们加起来必须等于 1。这些约束条件被直接内置于算法中。

然而，现实世界需要更复杂的处理。基因表达不是连续的流体，而是以离散的、随机的计数来衡量的。因此，现代解卷积方法不使用简单的[最小二乘回归](@entry_id:262382)，而是采用适合计数数据的概率模型，例如 **负二项分布**。这种方法恰当地解释了基因表达是“爆发式”的，以及计数方差通常超过均值这一现象——称为过离散。此外，可以调整不同的算法来回答不同的问题。一些算法，如 Stereoscope，估算细胞类型的相对*比例*，这些比例加起来必须为 1。另一些算法，如 cell2location，更进一步，估算每种细胞类型的*绝对丰度*，让我们了解局部细胞密度——这是一个细微但至关重要的区别。

### 寻找共同点：整合的力量

解卷积功能强大，但它基于一个关键假设：一个斑点的表达是其组成部分的简单线性混合。如果关系更复杂呢？这就引出了第二种同样优美的哲学：**整合**，或称 **映射**。

与其想象一个简单的搅拌碗，不如将我们的 [scRNA-seq](@entry_id:155798) 参考和空间数据想象成同一片潜在景观的两张不同地图。这片景观就是 **生物流形**——可能存在的细胞状态的连续空间。例如，一个干细胞不会在一夜之间变成神经元；它沿着一条平滑的分化路径行进。我们的一张地图（scRNA-seq）极其详细，显示了每一条小径和地标。另一张地图（空间数据）在地理上准确，但细节较少。问题在于，这些地图是由不同的制图师使用不同的工具绘制的，并且受到不同的扭曲和“[批次效应](@entry_id:265859)”的影响。它们无法完美对齐。

整合的目标是找到一块“罗塞塔石碑”，以对齐这两张地图。我们不假设线性混合；相反，我们寻找可靠的对应点，以学习一种灵活的、非线性的“扭曲”变换，从而使两张地图对齐。我们如何找到这些对应点？关键在于找到 **锚点**。

一个锚点是一对——一个来自参考图的细胞和一个来自空间图的斑点——我们高度确信它们代表相同的生物状态。一种朴素的方法是为每个斑点在 scRNA-seq 数据中找到其最近邻。但这很容易被地图的扭曲所迷惑。一个更聪明的解决方案是要求一种对称关系。一对 $(s_i, c_j)$ 只有在斑点 $s_i$ 是细胞 $c_j$ 的最近邻，*并且* 细胞 $c_j$ 是斑点 $s_i$ 的最近邻时，才被认为是稳健的锚点。这些 **[相互最近邻](@entry_id:752351) (MNNs)** 是在对应关系上达成一致的配对，使它们对技术噪音和扭曲的抵抗力强得多。

一旦我们在地图之间识别出足够数量的这些高置信度锚点，我们就可以计算局部扭曲，并学习一个复杂的变换，将整个参考图谱对齐到空间框架上。这使我们能够将丰富的信息，如精细的细胞类型标签甚至整个基因表达谱，从单细胞数据中转移过来，以惊人的分辨率推断每个空间位置正在发生什么。这种方法对于可视化连续过程（如发育梯度）在真实组织空间中的展开尤为强大。

### 穿行于现实迷雾：域偏移与其他难题

无论我们使用解卷积还是整合，我们都必须面对一个不可避免的事实：我们的参考数据和目标空间数据来自不同的实验“域”。忽视这种 **域偏移** 是导致失败的根源。这种偏移体现在几个方面：

*   **[协变量偏移](@entry_id:636196) (Covariate Shift)：** 这是“方言”问题。两种技术——[scRNA-seq](@entry_id:155798) 和空间转录组学——测量基因的方式不完全相同。某个特定基因在一个平台上的检测效率可能系统性地是另一个平台的两倍。一个稳健的算法必须对这种基因特异性的平台偏好进行建模和校正，否则它会把技术假象误认为是生物学变化。

*   **标签偏移 (Label Shift)：** 这是“[人口统计学](@entry_id:143605)”问题。制作参考的组织的细胞组成可能与正在研究的空间组织截然不同。例如，健康的参考组织中免疫细胞很少，而发炎的空间组织中则充满了免疫细胞。模型必须足够灵活，以便在新的上下文中更新其关于哪些细胞类型常见或罕见的先验期望。

*   **“未知的未知”：** 也许最危险的挑战是，空间数据中存在一种我们的参考图谱中根本不存在的细胞类型。一个朴素的算法，被迫从其已知列表中选择，会自信地将这个新细胞类型错误分类。一个真正有原则的方法必须包含一个“未知”或“背景”类别，使其能够说“我不知道”，而不是犯一个确定的错误。这需要构建能够处理参考之外状态的方法，这是一个活跃的研究前沿。

最终，所有这些复杂计算方法的力量完全取决于它们所依据的参考的质量。“垃圾进，垃圾出”的原则从未如此贴切。一个高质量的 scRNA-seq 参考必须经过精心构建。它应与空间实验在生物学上匹配——相同的组织、相同的物种、相同的疾病状态。它必须在统计上稳健，有足够多的来自足够多供体的细胞来创建稳定的表达谱。而且，它必须用能够校正技术噪音同时警惕地保留真实生物信号的方法进行策展，无论是 T 细胞活化状态之间的细微差异，还是稀有基质细胞的沉静身份。构建参考不仅仅是一个初步步骤；它是所有后续发现赖以建立的基础。

