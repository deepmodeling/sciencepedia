## 引言
单细胞 RNA 测序 ([scRNA-seq](@entry_id:155798)) 为洞察[细胞生物学](@entry_id:143618)提供了一个革命性的视角，但其产生的原始数据充满了技术噪音和人为误差。要搭建从原始测序输出到有意义的生物学洞见之间的桥梁，需要一个被称为“预处理”的关键性多步骤过程。这不仅是一个技术障碍，更是一门确保单细胞研究完整性和[可重复性](@entry_id:194541)的基础学科。本文对这一必要的工作流程进行了全面概述。首先，在“原理与机制”部分，我们将解构预处理的核心步骤，从解码分子条形码、校正技术偏差到过滤低[质量数](@entry_id:142580)据。随后，在“应用与跨学科联系”部分，我们将探讨审慎的[预处理](@entry_id:141204)选择如何开启高级分析，并讨论避免常见陷阱所需的分析严谨性。让我们从剖析那些将原始测序光信号转化为高保真细胞身份图谱的基本原理开始。

## 原理与机制

要窥探单个细胞繁忙的生命活动，我们必须首先学会它的语言。单细胞 RNA 测序 (scRNA-seq) 给了我们前所未有的词汇量，但它是通过一个充满噪音的信道传递的。从测序仪原始的闪烁信号，到一幅清晰的细胞身份图景，这一过程堪称科学侦探工作的杰作。这是一个清洁、校正和校准我们工具的过程，旨在将生物信号与技术噪音分离开来。这个被称为**预处理**的旅程并非一项乏味的杂务；它是一门植根于物理学、统计学和生物学第一性原理的学科，确保我们最终看到的是细胞本身，而不是我们测量设备的扭曲反映。

### 细胞地址簿：从光信号到计数值

故事始于测序仪，数以百万计的遗传物质片段在这里被“读取”。对于每个片段，机器检测到一系列荧光信号，一个称为**碱基识别 (basecalling)** 的过程将其翻译成我们熟悉的 DNA 字母：A、C、G 和 T。这是我们的原始文本，一个由大量短读段组成的集合。但是这些话是谁说的呢？在基于液滴的 [scRNA-seq](@entry_id:155798) 实验中，成千上万的细胞被捕获在微小的油滴中，每个油滴都变成了一个微型试管。为了追踪它们，研究人员采用了一个巧妙的技巧。

在测序之前，每个细胞的 RNA 分子都被标记上一个独特的分子名牌。这个名牌有两部分：一个**[细胞条形码](@entry_id:171163)**，对于来自特定细胞的每个分子都是相同的；以及一个**[唯一分子标识符 (UMI)](@entry_id:265196)**，这是一个随机序列，对于每个被捕获的 RNA 分子都是独一无二的。你可以把[细胞条形码](@entry_id:171163)看作是每个细胞独有的回邮地址，而 UMI 则是从该地址寄出的每封原始信件的唯一序列号。

测序过程产生[双端读段](@entry_id:176330)。对于一个标准的 10x Genomics 实验，**Read 1** 包含了这个名牌——[细胞条形码](@entry_id:171163)和 UMI。**Read 2** 则包含了实际的信息——细胞遗传密码的一个片段 (cDNA)。第一个主要步骤是**解复用**，就像一个邮政分拣中心：它读取 Read 1 上的[细胞条形码](@entry_id:171163)，并将每个读段对分配给其来源的细胞。

那么，为什么需要 UMI 呢？为测序准备样本的关键步骤之一是通过[聚合酶链式反应](@entry_id:142924) (PCR) 进行扩增，这就像一台分子复印机。如果没有 UMI，我们就会把每一份复印件都当作一封原始信件来计数。一个被高度扩增的基因会显得表达量更高，但这并非因为细胞制造了更多的该基因，而是因为我们的复印机对那封特定的信件更高效。UMI 巧妙地解决了这个问题。通过只计算每个细胞中与每个基因相关的*唯一* UMI，我们实际上是在计算原始分子，从而有效地校正了 PCR 扩增偏好。如果我们看到基因 X 有 100 个读段，但它们都追溯到仅两个不同的 UMI，我们就知道该细胞最初只有两个基因 X 的 RNA 分子。这是计数读段和计数分子之间的区别——是准确性上的一次根本性飞跃。

### 解码信息：比对与错误校正

在将每个读段对分配给一个细胞后，我们现在需要弄清楚 Read 2 中的信息来自哪个基因。这通过**比对**或**伪比对**来完成，即将 Read 2 的序列与一个包含所有已知基因序列的参考文库进行匹配。为了让任何科学家在任何地方都能重复这个过程，参考基因组和[基因注释](@entry_id:164186)文件的确切版本必须被一丝不苟地记录下来，通常使用加密校验和来保证它们在比特级别上是完全相同的。

但即使是我们的分[子序列](@entry_id:147702)号——UMI，也无法避免录入错误。测序错误可能会改变 UMI 中的一个字母，使其看起来像一个新的、不同的分子。如果我们天真地计算我们看到的每一个独特的 UMI 字符串，我们仍然会高估。解决方案是另一个优美的逻辑：**可感知错误的 UMI 折叠**。我们假设，一个读段数极少且与一个读段数很多的 UMI 只有一个字母之差的 UMI，很可能是那个丰度更高的 UMI 的测序错误。例如，如果对于某个基因，我们发现 7 个读段带有 UMI 'A'，而只有 1 个读段带有 UMI 'B'，并且 'A' 和 'B' 仅相差一个[核苷酸](@entry_id:275639)（[汉明距离](@entry_id:157657)为 1），我们就会将 'B' 合并到 'A' 中。其逻辑在于，分子 'A' 的众多拷贝中发生单个错误的可能性，远大于一个真正的新分子 'B' 被捕获且仅被测序一次的可能性。这一步将我们的计数从简单地统计唯一字符串，提炼为对真实分子数量的、基于统计的估计。

整个过程的结果是**原始计数矩阵**：一个巨大的表格，其中行是基因，列是细胞，每个条目是我们对特定细胞中存在的特定基因的 RNA 分子数量的最佳估计。

### 清洁画布：质量控制的艺术

我们的原始计数矩阵是一项了不起的成就，但它还不是一幅杰作。它包含了一些人为误差——我们必须识别并移除的机器中的幽灵。这就是**[质量控制 (QC)](@entry_id:175233)** 的艺术。

首先，我们必须找到那些实际上不是细胞的“细胞”。基于液滴的方法并非完美；一些液滴最终是空的，只捕获了周围裂解细胞汤中的一些游离“环境”RNA 分子。这些**空液滴**很容易被发现：它们检测到的总基因数 (`nFeatures`) 非常低。每个液滴检测到的基因数的直方图通常显示出清晰的[双峰分布](@entry_id:166376)：一个在非常低的数值处有巨大的峰，第二个更宽的峰在较高的数值处。第一个峰就是空液滴的特征，我们将其过滤掉。

接下来，我们寻找**双细胞**或**多细胞**。当两个或多个细胞意外地被封装在同一个液滴中时，就会发生这种情况。由此产生的数据点是一个令人困惑的混合体，一个人工[嵌合体](@entry_id:264354)。双细胞的一个典型特征是同时高表达那些本应[互斥](@entry_id:752349)的基因——例如，在同一个“细胞”中同时出现肌肉细胞和成纤维细胞的标记物。双细胞也往往具有异常高的总 UMI 检测数，因为它们包含了两个细胞的 RNA。

我们还会寻找患病或垂死细胞的迹象。细胞应激的一个常见指标是[细胞膜](@entry_id:146704)受损。这使得细胞质中更大、更脆弱的信使 RNA 降解并泄漏出去，而线粒体内部转录的更小、更稳定的 RNA 则被保留下来。结果就是一个细胞具有异常高的**线粒体比例**——其所有读段中来自线粒体基因的比例。这是低质量细胞的一个强力标记，应予以移除。

同样在 QC 期间，我们面临着 [scRNA-seq](@entry_id:155798) 数据的一个基本特性，即**基因脱落 (dropout)**。由于捕获 RNA分子的过程效率低下且具有随机性，一个真正在细胞中存在的基因可能根本没有被捕获、反转录或测序。结果就是我们的计数矩阵中出现一个“假零”。因此，两个并排的相同细胞可能会产生不同的结果：一个显示某个基因的计数，而另一个显示为零，这仅仅是由于测量过程中的随机性。这种现象是 scRNA-seq 数据的一个决定性特征，使其非常“稀疏”（充满零）并需要专门的分析方法。

### 创造公平的竞争环境：标准化的必要性

在过滤掉碎片之后，我们得到一个包含高质量细胞的计数矩阵。但还需要最后一次关键的调整。一些细胞纯粹由于偶然，可能被测序得更深，或者其 RNA 被更有效地捕获。这种**文库大小**（每个细胞的总 UMI 数）的技术差异可能非常巨大，并且与生物学无关。一个文库大小是两倍的细胞，平均而言，每个基因的计数也会是两倍，这会使它看起来与邻居们截然不同。

如果我们在此阶段对数据进行可视化，结果将是灾难性的。我们看到的主要结构将仅仅是文库大小的梯度，细胞会根据检测到的分子数量聚类，而不是根据它们的生物学细胞类型。这个问题的一个常见诊断方法是进行主成分分析 (PCA)。如果第一个主成分——数据中变异最大的轴——与文库大小几乎完全相关，这是一个巨大的警示信号。它告诉我们，数据中的主导“模式”是技术性偏差，而非生物学。

**标准化**是纠正这一问题的程序。最简单的方法是将每个细胞中的绝对计数转换为相对比例（例如，“每百万计数”），然后应用对数转换。对数转换是关键：它能稳定[方差](@entry_id:200758)，并防止少数几个极高表达的基因主导所有下游计算。[标准化](@entry_id:637219)之后，我们终于可以在一个公平的竞争环境中开始比较细胞。

### 剥离层次：高级校正与实验设计

除了文库大小之外，其他技术和生物因素也可能掩盖我们正在寻找的信号。在不同日期或使用不同批次试剂处理的样本可能会表现出**[批次效应](@entry_id:265859)**——影响一批中所有细胞的系统性表达偏移。此外，像[细胞周期](@entry_id:140664)这样的生物过程可能会产生巨大的变异，虽然有趣，但可能与手头的问题无关。

处理这些效应的一个强大而优雅的方法是使用[线性回归](@entry_id:142318)。我们可以构建一个**[设计矩阵](@entry_id:165826)** $X$，它本质上是对每个细胞所有已知的非期望变异来源的数学描述——它的文库大小、线粒体百分比、细胞周期评分、批次身份等等。然后，对于每个基因，我们拟合一个线性模型来提问：这个基因的表达有多少可以被这些干扰因素预测？那部分*无法*被它们解释的表达——即回归的**残差**——就是我们保留下来的。

从几何学上看，这是一个优美的操作。我们[设计矩阵](@entry_id:165826)的列张成了一个技术变异的“[子空间](@entry_id:150286)”。残差化操作就是将我们的数据从这个[子空间](@entry_id:150286)中正交投影出去，只留下与这些已知技术效应垂直的、或说独立的变异。根据定义，经过校正得到的数据将与我们回归掉的因素[零相关](@entry_id:270141)。

这引出了一个深刻的终点：分析与实验设计之间的深层联系。想象一个实验，所有对照细胞都在第 1 天处理，所有处理过的细胞都在第 2 天处理。在这里，[处理效应](@entry_id:636010)与处理日期的批次效应完全**混淆**了。从数学上讲，区分这两者变得不可能。回归掉批次效应也会移除[处理效应](@entry_id:636010)！相比之下，一个设计良好的实验将是*平衡的*——在两天内都处理等量混合的对照和处理细胞。这使得生物学因素和技术因素正交，从而让我们的数学工具能够干净地将它们分离开来。

至此，[预处理](@entry_id:141204)的旅程便完成了。它是一个系统的解码、清洁和校正过程，每一步都以对底层测量过程的理解为指导。它将一个充满噪音、带有偏见的数据集，转变为一个高保真的[细胞生物学](@entry_id:143618)表征，使我们最终能够提出那些最初激励我们的关于生命本质的问题。这个过程的严谨性，正是科学得以可重复、稳健并最终具有启发性的原因。

