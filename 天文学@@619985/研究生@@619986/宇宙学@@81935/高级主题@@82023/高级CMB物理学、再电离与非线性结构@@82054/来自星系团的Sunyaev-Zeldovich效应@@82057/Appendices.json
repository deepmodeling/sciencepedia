{"hands_on_practices": [{"introduction": "理论是强大的，但将其应用于实际天体物理场景才是真正令人兴奋的部分。本练习将引导你从理论走向实践，通过数值计算来模拟热苏尼亚耶夫-泽尔多维奇（tSZ）效应。你将为一个由三轴 beta 模型描述的星系团计算沿特定视线的温度变化，并计算望远镜孔径内的平均信号，这正是天文学家在真实观测中测量的方式 [@problem_id:2414991]。这个实践将加深你对 tSZ 效应物理根源的理解，并为你提供宝贵的计算天体物理学技能。", "problem": "一个用于模拟星系团的三维热电子等离子体由一个等温三轴贝塔分布描述。设电子数密度为\n$$\nn_{\\mathrm{e}}(x,y,z) = n_0 \\left[ 1 + \\left(\\frac{x^2}{a_x^2} + \\frac{y^2}{a_y^2} + \\frac{z^2}{a_z^2}\\right) \\right]^{-3\\beta/2},\n$$\n电子温度为常数\n$$\nT_{\\mathrm{e}}(x,y,z) = T_0.\n$$\n假设电子热运动速度处于单次汤姆孙散射极限和非相对论性体系。宇宙微波背景（CMB）的热力学温度为\n$$\nT_{\\mathrm{CMB}} = 2.725~\\mathrm{K}.\n$$\n对于给定的观测频率\n$$\n\\nu,\n$$\n你需要计算非相对论性热太阳耶夫-泽尔多维奇（tSZ）效应沿穿过星系团的视线所引起的热力学温移，以及在天空上一个圆形孔径内的孔径平均温移。你的任务是：\n- 从汤姆孙散射、理想电子气体的动理学理论以及扩散（Kompaneets）近似下的辐射转移的基本定义出发，推导一个表达式，该表达式将频率 $\\nu$ 处的热力学温移与沿视线的电子压强积分联系起来，并乘以一个仅依赖于 $\\nu$ 和 $T_{\\mathrm{CMB}}$ 的谱因子。\n- 实现一个多维数值积分来计算：\n  1. 在天空平面坐标 $(b_x,b_y)$ 处的视线温移：\n     $$\n     \\Delta T_{\\nu}^{\\mathrm{LOS}}(b_x,b_y),\n     $$\n     通过沿 $z$ 轴在一个对称有限区间 $z \\in [-L_z, L_z]$ 上积分，其中 $L_z$ 被选为每个测试中提供的 $a_z$ 的倍数，以及\n  2. 在天空平面上以原点为中心、半径为 $R$ 的圆形孔径内的孔径平均温移：\n     $$\n     \\langle \\Delta T_{\\nu} \\rangle_R = \\frac{1}{\\pi R^2} \\iint_{x^2+y^2 \\le R^2} \\Delta T_{\\nu}^{\\mathrm{LOS}}(x,y)\\, \\mathrm{d}A,\n     $$\n     其中 $\\mathrm{d}A$ 是天空平面中的面积元。这需要一个多维数值积分，通过三维压力分布将天空平面积分与视线积分耦合起来。\n\n始终使用国际单位制（SI）。所有报告的热力学温移均以开尔文为单位。如果需要，角度应以弧度为单位。你可以选择任何稳定的数值积分方法，但你的实现必须明确执行所需的多维数值积分，不得使用预先制表的特殊情况解析结果。\n\n使用的物理常数：\n- 汤姆孙散射截面 $\\,\\sigma_{\\mathrm{T}} = 6.6524587321\\times 10^{-29}\\,\\mathrm{m}^2$。\n- 电子静止能量 $\\,m_{\\mathrm{e}} c^2 = 8.1871057769\\times 10^{-14}\\,\\mathrm{J}$。\n- 玻尔兹曼常数 $\\,k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。\n- 普朗克常数 $\\,h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}$。\n- 光速 $\\,c = 2.99792458\\times 10^8\\,\\mathrm{m/s}$。\n\n测试套件。对于下面的每个参数集 $(n_0, T_0, \\beta, a_x, a_y, a_z, b_x, b_y, R, \\nu, L_z)$，计算并返回两个浮点数：\n- 视线方向的热力学温移 $\\,\\Delta T_{\\nu}^{\\mathrm{LOS}}(b_x,b_y)\\,$，单位为开尔文。\n- 孔径平均的热力学温移 $\\,\\langle \\Delta T_{\\nu} \\rangle_R\\,$，单位为开尔文。\n\n使用以下四个测试用例，它们共同探测了一般情况、偏轴视线、三轴几何形状和零密度边界情况：\n1. $\\,n_0 = 1.0\\times 10^3\\,\\mathrm{m}^{-3}$，$\\,T_0 = 8.0\\times 10^7\\,\\mathrm{K}$，$\\,\\beta = 2/3$，$\\,a_x = 4.0\\times 10^{21}\\,\\mathrm{m}$，$\\,a_y = 4.0\\times 10^{21}\\,\\mathrm{m}$，$\\,a_z = 4.0\\times 10^{21}\\,\\mathrm{m}$，$\\,b_x = 0.0\\,\\mathrm{m}$，$\\,b_y = 0.0\\,\\mathrm{m}$，$\\,R = 1.0\\times 10^{22}\\,\\mathrm{m}$，$\\,\\nu = 1.50\\times 10^{11}\\,\\mathrm{Hz}$，$\\,L_z = 12\\,a_z$。\n2. $\\,n_0 = 1.0\\times 10^3\\,\\mathrm{m}^{-3}$，$\\,T_0 = 8.0\\times 10^7\\,\\mathrm{K}$，$\\,\\beta = 2/3$，$\\,a_x = 4.0\\times 10^{21}\\,\\mathrm{m}$，$\\,a_y = 4.0\\times 10^{21}\\,\\mathrm{m}$，$\\,a_z = 4.0\\times 10^{21}\\,\\mathrm{m}$，$\\,b_x = 5.0\\times 10^{21}\\,\\mathrm{m}$，$\\,b_y = 0.0\\,\\mathrm{m}$，$\\,R = 1.0\\times 10^{22}\\,\\mathrm{m}$，$\\,\\nu = 1.50\\times 10^{11}\\,\\mathrm{Hz}$，$\\,L_z = 12\\,a_z$。\n3. $\\,n_0 = 5.0\\times 10^2\\,\\mathrm{m}^{-3}$，$\\,T_0 = 1.2\\times 10^8\\,\\mathrm{K}$，$\\,\\beta = 0.8$，$\\,a_x = 3.0\\times 10^{21}\\,\\mathrm{m}$，$\\,a_y = 6.0\\times 10^{21}\\,\\mathrm{m}$，$\\,a_z = 9.0\\times 10^{21}\\,\\mathrm{m}$，$\\,b_x = 0.0\\,\\mathrm{m}$，$\\,b_y = 0.0\\,\\mathrm{m}$，$\\,R = 8.0\\times 10^{21}\\,\\mathrm{m}$，$\\,\\nu = 1.50\\times 10^{11}\\,\\mathrm{Hz}$，$\\,L_z = 12\\,a_z$。\n4. $\\,n_0 = 0.0\\,\\mathrm{m}^{-3}$，$\\,T_0 = 8.0\\times 10^7\\,\\mathrm{K}$，$\\,\\beta = 2/3$，$\\,a_x = 4.0\\times 10^{21}\\,\\mathrm{m}$，$\\,a_y = 4.0\\times 10^{21}\\,\\mathrm{m}$，$\\,a_z = 4.0\\times 10^{21}\\,\\mathrm{m}$，$\\,b_x = 0.0\\,\\mathrm{m}$，$\\,b_y = 0.0\\,\\mathrm{m}$，$\\,R = 1.0\\times 10^{22}\\,\\mathrm{m}$，$\\,\\nu = 1.50\\times 10^{11}\\,\\mathrm{Hz}$，$\\,L_z = 12\\,a_z$。\n\n最终输出规范：\n- 你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列\n$$\n[\\Delta T_{\\nu,1}^{\\mathrm{LOS}}, \\langle \\Delta T_{\\nu} \\rangle_{R,1}, \\Delta T_{\\nu,2}^{\\mathrm{LOS}}, \\langle \\Delta T_{\\nu} \\rangle_{R,2}, \\Delta T_{\\nu,3}^{\\mathrm{LOS}}, \\langle \\Delta T_{\\nu} \\rangle_{R,3}, \\Delta T_{\\nu,4}^{\\mathrm{LOS}}, \\langle \\Delta T_{\\nu} \\rangle_{R,4}],\n$$\n其中下标索引测试用例 $\\,1,2,3,4\\,$。每个条目必须是单位为开尔文的浮点数。", "solution": "所提出的问题是计算天体物理学中的一个标准、适定的练习，具体涉及热太阳耶夫-泽尔多维奇（tSZ）效应的计算。所有物理参数、模型定义和常数均已提供，并且在科学上是合理和一致的。问题陈述没有歧义、矛盾和事实错误。因此，该问题被认为是有效的。我们着手解决该问题，解决方案包括两部分：首先，从基本原理严格推导控制方程；其次，通过数值实现来计算所需量。\n\n**第一部分：热太阳耶夫-泽尔多维奇效应的理论表述**\n\n热太阳耶夫-泽尔多维奇效应是宇宙微波背景（CMB）辐射因星系团的簇内介质（ICM）中的热电子发生逆康普顿散射而产生的光谱畸变。我们将在指定的非相对论、单次散射近似下，推导引起的热力学温移 $\\Delta T_\\nu$ 的表达式。\n\n在非相对论性电子组成的热浴中，光子占据数 $n(\\nu)$ 的演化由 Kompaneets 方程描述。在光学薄极限（$\\tau \\ll 1$，这对于簇内介质是有效的）下，我们考虑入射的宇宙微波背景黑体辐射 $n_{BB}(\\nu)$ 在单次穿过星系团后受到的扰动。沿路径元为 $dl$ 的视线方向，占据数的变化由 Kompaneets 方程沿路径积分给出：\n$$\n\\Delta n(\\nu) = \\int \\frac{\\partial n}{\\partial t} \\frac{dl}{c}\n$$\nKompaneets 方程为\n$$\n\\frac{\\partial n}{\\partial t} = \\frac{\\sigma_T n_e c}{m_e c^2} \\frac{1}{x^2} \\frac{\\partial}{\\partial x} \\left[ x^4 \\left( k_B T_e \\frac{\\partial n}{\\partial x} + n(1+n) \\right) \\right]\n$$\n其中 $x = h\\nu/(k_B T_{CMB})$ 是无量纲频率，$n_e$ 和 $T_e$ 分别是电子数密度和温度，$\\sigma_T$ 是汤姆孙散射截面，$m_e c^2$ 是电子静止能量，其他符号具有其通常的含义。\n\n入射辐射是宇宙微波背景，对于它，$n = n_{BB}(T_{CMB}) = (e^x - 1)^{-1}$。由于在星系团中 $T_e \\gg T_{CMB}$，电子气体与宇宙微波背景不处于热平衡状态。一个对小变化有效的标准简化方法是使用未受扰动的宇宙微波背景谱来计算导数项。这导出了占据数变化的著名结果：\n$$\n\\Delta n(x) = y \\cdot g(x)\n$$\n其中 $y$ 是康普顿-y 参数，$g(x)$ 是一个谱函数。康普顿-y 参数表示沿视线积分的电子压强，并由物理常数进行了归一化：\n$$\ny = \\int \\frac{\\sigma_T n_e k_B T_e}{m_e c^2} dl\n$$\n谱函数 $g(x)$ 是由 Kompaneets 算符作用于黑体谱得出的：\n$$\ng(x) = \\frac{x e^x}{(e^x-1)^2} \\left( x \\frac{e^x+1}{e^x-1} - 4 \\right)\n$$\n\n可观测量本身不是占据数，而是谱强度的变化 $\\Delta I_\\nu$。热力学温度的变化 $\\Delta T_\\nu$ 通过关系式 $\\Delta I_\\nu = (\\partial B_\\nu / \\partial T)_{T=T_{CMB}} \\Delta T_\\nu$ 定义，其中 $B_\\nu(T)$ 是黑体辐射的普朗克函数。\n\n强度通过 $I_\\nu = \\frac{2h\\nu^3}{c^2} n(\\nu)$ 与占据数相关。因此，强度的变化为 $\\Delta I_\\nu = \\frac{2h\\nu^3}{c^2} \\Delta n(x)$。\n普朗克函数对温度的导数是：\n$$\n\\left.\\frac{\\partial B_\\nu}{\\partial T}\\right|_{T=T_{CMB}} = \\frac{2h\\nu^3}{c^2} \\frac{x e^x}{T_{CMB}(e^x-1)}\n$$\n结合这些关系式，我们求解相对温度变化：\n$$\n\\frac{\\Delta T_\\nu}{T_{CMB}} = \\frac{\\Delta I_\\nu / T_{CMB}}{(\\partial B_\\nu / \\partial T)_{T_{CMB}}} = \\frac{ (2h\\nu^3/c^2) \\Delta n(x) / T_{CMB} }{ (2h\\nu^3/c^2) [x e^x / (T_{CMB}(e^x-1))] } = \\frac{\\Delta n(x)}{x e^x / (e^x-1)}\n$$\n代入 $\\Delta n(x)$ 和 $g(x)$ 的表达式：\n$$\n\\frac{\\Delta T_\\nu}{T_{CMB}} = \\frac{y \\cdot \\frac{x e^x}{(e^x-1)^2} \\left( x \\frac{e^x+1}{e^x-1} - 4 \\right)}{x e^x / (e^x-1)} = y \\left( x \\frac{e^x+1}{e^x-1} - 4 \\right)\n$$\n令谱因子为 $f(x) = x \\coth(x/2) - 4 = x \\frac{e^x+1}{e^x-1} - 4$。热力学温移的最终表达式为：\n$$\n\\Delta T_\\nu = T_{CMB} \\cdot f(x) \\cdot y\n$$\n\n**第二部分：数值实现策略**\n\n给定电子密度分布 $n_e(x,y,z)$ 和恒定温度 $T_0$，我们可以表示待计算的量。视线沿 $z$ 轴方向。\n\n1.  **视线温移**：对于穿过天空平面坐标 $(b_x, b_y)$ 的视线，康普顿-y 参数为：\n    $$\n    y(b_x, b_y) = \\frac{\\sigma_T k_B T_0}{m_e c^2} \\int_{-L_z}^{L_z} n_e(b_x, b_y, z) dz\n    $$\n    那么温移为：\n    $$\n    \\Delta T_{\\nu}^{\\mathrm{LOS}}(b_x,b_y) = T_{CMB} \\cdot f\\left(\\frac{h\\nu}{k_B T_{CMB}}\\right) \\cdot \\frac{\\sigma_T k_B T_0 n_0}{m_e c^2} \\int_{-L_z}^{L_z} \\left[ 1 + \\frac{b_x^2}{a_x^2} + \\frac{b_y^2}{a_y^2} + \\frac{z^2}{a_z^2} \\right]^{-3\\beta/2} dz\n    $$\n    这是一个关于 $z$ 的一维积分，将使用 `scipy.integrate.quad` 进行数值计算。\n\n2.  **孔径平均温移**：这是 $\\Delta T_{\\nu}^{\\mathrm{LOS}}(x,y)$ 在半径为 $R$ 的圆形孔径上的平均值：\n    $$\n    \\langle \\Delta T_{\\nu} \\rangle_R = \\frac{1}{\\pi R^2} \\iint_{x^2+y^2 \\le R^2} \\Delta T_{\\nu}^{\\mathrm{LOS}}(x,y)\\, d A\n    $$\n    代入 $\\Delta T_{\\nu}^{\\mathrm{LOS}}$ 的表达式，得到一个在 $(x, y, z)$ 坐标系下柱状区域上的三维积分。为了进行数值评估，我们将天空平面积分转换为极坐标 $(r, \\theta)$，其中 $x=r\\cos\\theta$，$y=r\\sin\\theta$。该积分变为：\n    $$\n    \\langle \\Delta T_{\\nu} \\rangle_R = K \\cdot \\frac{1}{\\pi R^2} \\int_0^{2\\pi} d\\theta \\int_0^R dr \\int_{-L_z}^{L_z} dz \\cdot r \\cdot \\left[ 1 + \\frac{(r\\cos\\theta)^2}{a_x^2} + \\frac{(r\\sin\\theta)^2}{a_y^2} + \\frac{z^2}{a_z^2} \\right]^{-3\\beta/2}\n    $$\n    其中 $K = T_{CMB} \\cdot f(x) \\cdot \\frac{\\sigma_T k_B T_0 n_0}{m_e c^2}$ 是每个测试用例的常数预因子，而 $r$ 项源于坐标变换的雅可比行列式（$dA = r dr d\\theta$）。这个三维积分将使用 `scipy.integrate.nquad` 进行计算。\n\n该实现将包含一个主函数，该函数遍历所提供的测试用例。对于每个用例，它将首先计算常数预因子，然后计算视线温移的一维积分和孔径平均的三维积分，最后按指定格式化结果。对 $n_0=0$ 的特殊检查将对两个量都返回零，因为没有散射介质。", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the thermal Sunyaev-Zeldovich effect problem for a set of test cases.\n    \"\"\"\n    # Physical constants in SI units\n    SIGMA_T = 6.6524587321e-29  # Thomson cross section (m^2)\n    M_E_C2 = 8.1871057769e-14     # Electron rest energy (J)\n    K_B = 1.380649e-23           # Boltzmann constant (J/K)\n    H_PLANCK = 6.62607015e-34    # Planck constant (J*s)\n    C_LIGHT = 2.99792458e8       # Speed of light (m/s)\n    T_CMB = 2.725                # CMB temperature (K)\n\n    test_cases = [\n        # (n0, T0, beta, ax, ay, az, bx, by, R, nu, Lz_factor)\n        (1.0e3, 8.0e7, 2/3, 4.0e21, 4.0e21, 4.0e21, 0.0, 0.0, 1.0e22, 1.50e11, 12),\n        (1.0e3, 8.0e7, 2/3, 4.0e21, 4.0e21, 4.0e21, 5.0e21, 0.0, 1.0e22, 1.50e11, 12),\n        (5.0e2, 1.2e8, 0.8, 3.0e21, 6.0e21, 9.0e21, 0.0, 0.0, 8.0e21, 1.50e11, 12),\n        (0.0, 8.0e7, 2/3, 4.0e21, 4.0e21, 4.0e21, 0.0, 0.0, 1.0e22, 1.50e11, 12),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        n0, T0, beta, ax, ay, az, bx, by, R, nu, Lz_factor = case\n        \n        # Trivial case: zero electron density\n        if n0 == 0.0:\n            results.extend([0.0, 0.0])\n            continue\n        \n        Lz = Lz_factor * az\n\n        # 1. Calculate the constant prefactors\n        # Dimensionless frequency x\n        x = (H_PLANCK * nu) / (K_B * T_CMB)\n        \n        # Spectral factor f(x)\n        # f(x) = x * coth(x/2) - 4 = x * (e^x + 1) / (e^x - 1) - 4\n        f_x = x * (np.exp(x) + 1) / (np.exp(x) - 1) - 4\n        \n        # Overall constant K combining T_CMB, f(x), and physical constants\n        K = T_CMB * f_x * (SIGMA_T * K_B * T0 * n0) / M_E_C2\n\n        # 2. Compute the line-of-sight temperature shift\n        \n        # Define the integrand for the LOS integral\n        def los_integrand(z):\n            term = 1 + (bx/ax)**2 + (by/ay)**2 + (z/az)**2\n            return term**(-1.5 * beta)\n        \n        los_integral_val, _ = integrate.quad(los_integrand, -Lz, Lz)\n        delta_T_los = K * los_integral_val\n        \n        # 3. Compute the aperture-averaged temperature shift\n\n        # Define the integrand for the 3D aperture integral in (z, r, theta) coords\n        def aperture_integrand(z, r, theta):\n            x_coord = r * np.cos(theta)\n            y_coord = r * np.sin(theta)\n            term = 1 + (x_coord/ax)**2 + (y_coord/ay)**2 + (z/az)**2\n            return r * term**(-1.5 * beta) # Include Jacobian 'r'\n\n        # Set integration ranges for (z, r, theta)\n        ranges = [[-Lz, Lz], [0, R], [0, 2 * np.pi]]\n\n        aperture_integral_val, _ = integrate.nquad(aperture_integrand, ranges)\n        \n        # The aperture-averaged temperature shift\n        # <ΔT> = (1/πR^2) * K * Integral\n        avg_delta_T = K * aperture_integral_val / (np.pi * R**2)\n\n        results.extend([delta_T_los, avg_delta_T])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2414991"}, {"introduction": "除了电子的热运动，星系团内部气体的整体运动也会在宇宙微波背景辐射上留下印记，这就是运动学苏尼亚耶夫-泽尔多维奇（kSZ）效应。这个效应是探测星系团内部动力学（如旋转或大尺度流动）的独特工具。在本练习中，你将分析一个理想化的旋转星系团模型，并推导其在天空平面上产生的 kSZ 温度图样 [@problem_id:891882]。通过这个解析练习，你将亲身体会如何将星系团的宏观运动特征与其在CMB中产生的可观测信号联系起来。", "problem": "一个遥远的星系团被建模为一个呈刚体转动的球对称分布的电离气体（团内介质）。该星系团的电子数密度 $n_e$ 作为距其中心的径向距离 $r$ 的函数，由以下高斯分布描述：\n$$\nn_e(r) = n_{e0} \\exp\\left(-\\frac{r^2}{2\\sigma_r^2}\\right)\n$$\n其中 $n_{e0}$ 是中心电子数密度，$\\sigma_r$ 是星系团的特征半径。\n\n该星系团以恒定的角速度矢量 $\\vec{\\omega}$ 进行刚体转动。一位观测者位于距离星系团非常远的地方，处在一个以星系团为中心的笛卡尔坐标系的 $z$ 轴上。天球平面是 $(x, y)$ 平面。星系团的转轴位于 $y-z$ 平面内，并与视线（$z$ 轴）成 $i$ 角倾斜，因此角速度矢量由下式给出：\n$$\n\\vec{\\omega} = \\omega (\\sin i \\, \\hat{y} + \\cos i \\, \\hat{z})\n$$\n其中 $\\omega = |\\vec{\\omega}|$ 是角速度的大小。\n\n星系团内电子的整体运动会引发运动学 Sunyaev-Zeldovich (kSZ) 效应，导致观测到的宇宙微波背景 (CMB) 辐射出现温度涨落 $\\Delta T_{kSZ}$。天球平面上一点 $(x, y)$ 处的温度涨落由以下视线方向积分给出：\n$$\n\\frac{\\Delta T_{kSZ}(x,y)}{T_{CMB}} = -\\frac{\\sigma_T}{c} \\int_{-\\infty}^{\\infty} n_e(\\vec{r}) \\, v_{los} \\, dz\n$$\n此处，$T_{CMB}$ 是 CMB 的平均温度，$\\sigma_T$ 是汤姆孙散射截面，$c$ 是光速，$\\vec{r} = x\\hat{x} + y\\hat{y} + z\\hat{z}$ 是位置矢量，$v_{los}$ 是电子整体速度在指向观测者的视线方向上的分量。\n\n确定在 kSZ 温度图中观测到的最大温度增量 $\\Delta T_{max}$。将答案表示为关于 $T_{CMB}$、$\\sigma_T$、$c$、$n_{e0}$、$\\sigma_r$、$\\omega$ 和 $i$ 的解析表达式。", "solution": "1. 相关方程  \n电子数密度  \n$$n_e(r)=n_{e0}\\exp\\Bigl(-\\frac{r^2}{2\\sigma_r^2}\\Bigr)\\,. $$  \n整体速度  \n$$\\vec v=\\vec\\omega\\times\\vec r\\,,\\quad \\vec\\omega=\\omega(\\sin i\\,\\hat y+\\cos i\\,\\hat z)\\,. $$  \nkSZ 温度涨落  \n$$\\frac{\\Delta T_{kSZ}(x,y)}{T_{CMB}}\n=-\\frac{\\sigma_T}{c}\\int_{-\\infty}^{\\infty}n_e(\\vec r)\\,v_{los}\\,dz\\,. $$\n\n2. 计算 $v_{los}=\\vec v\\cdot\\hat z$  \n$$\\vec v\n=\\bigl(\\omega\\sin i\\,z-\\omega\\cos i\\,y,\\;\\omega\\cos i\\,x,\\;-\\omega\\sin i\\,x\\bigr)\\,, $$\n所以  \n$$v_{los}=v_z=-\\omega\\sin i\\,x\\,. $$\n\n3. 代入 kSZ 积分  \n$$\\frac{\\Delta T}{T_{CMB}}\n=-\\frac{\\sigma_T}{c}\\int n_{e0}e^{-(x^2+y^2+z^2)/(2\\sigma_r^2)}(-\\omega\\sin i\\,x)\\,dz$$  \n$$=\\frac{\\sigma_T\\omega\\sin i\\,x\\,n_{e0}}{c}\n\\int_{-\\infty}^\\infty e^{-(x^2+y^2+z^2)/(2\\sigma_r^2)}dz$$  \n$$=\\frac{\\sigma_T\\omega\\sin i\\,x\\,n_{e0}}{c}\ne^{-(x^2+y^2)/(2\\sigma_r^2)}\\sqrt{2\\pi}\\,\\sigma_r\\,. $$\n\n4. 对 $(x,y)$ 求最大值  \n我们令 $y=0$ 并对 $f(x)=x\\exp(-x^2/(2\\sigma_r^2))$ 求最大值。  \n$$\\frac{df}{dx}=0\\ \\Rightarrow\\ x=\\sigma_r,\\quad f(\\sigma_r)=\\sigma_r e^{-1/2}\\,. $$\n\n5. 最终表达式  \n$$\\frac{\\Delta T_{\\max}}{T_{CMB}}\n=\\frac{\\sigma_T\\omega\\sin i\\,n_{e0}}{c}\\,\\sqrt{2\\pi}\\,\\sigma_r\\,(\\sigma_r e^{-1/2})\n=\\frac{\\sigma_T n_{e0}\\omega\\sigma_r^2\\sin i}{c}\\sqrt{\\frac{2\\pi}{e}}\\,. $$\n因此  \n$$\\Delta T_{\\max}\n=T_{CMB}\\,\\frac{\\sigma_T n_{e0}\\omega\\sigma_r^2\\sin i}{c}\\sqrt{\\frac{2\\pi}{e}}\\,. $$", "answer": "$$\\boxed{T_{CMB}\\,\\frac{\\sigma_T\\,n_{e0}\\,\\omega\\,\\sigma_r^2\\,\\sin i}{c}\\,\\sqrt{\\frac{2\\pi}{e}}}$$", "id": "891882"}, {"introduction": "苏尼亚耶夫-泽尔多维奇效应不仅仅是温度的变化；它还能产生偏振信号，为我们揭示星系团的几何形状。当宇宙微波背景辐射穿过一个非球对称的星系团时，引力势的各向异性会在电子的参考系中产生一个四极矩，汤姆孙散射将这个四极各向异性转化为我们能够观测到的线性偏振。这个高级实践将引导你推导由星系团的椭球形状引起的偏振 SZ 信号 [@problem_id:891871]，展示了如何利用偏振信息来探索我们视线方向上无法直接看到的三维结构。", "problem": "Sunyaev-Zeldovich（SZ）效应是宇宙微波背景（CMB）谱的一种畸变，它是由CMB光子与星系团的簇内介质（ICM）中的高能电子发生散射引起的。热SZ效应（一种谱变化）源于光子获得的能量增益，而如果散射电子所见的CMB辐射场具有四极各向异性，则可以产生极化的SZ信号。\n\n在一个非球形（例如，扁球状或长球状）的星系团中，其引力势不是球对称的。这种非球形性，与从不同方向穿过星系团的CMB光子所经历的差分引力红移（与积分Sachs-Wolfe效应有关）相结合，在散射电子所在的位置处，于CMB辐射场中诱导出了局域的四极各向异性。对这种四极辐射场的Thomson散射随后会在散射光中产生净线性极化。\n\n沿方向 $\\mathbf{n}$ 传播的辐射的极化状态可以用一个强度张量 $\\mathcal{P}_{ij}$ 来描述，它是一个 $3 \\times 3$ 的实对称横向（$\\mathcal{P}_{ij}n_j=0$）张量。在一个与 $\\mathbf{n}$ 正交的二维基 $(\\mathbf{e}_1, \\mathbf{e}_2)$ 中，该张量的分量与Stokes参量的关系为 $I = \\mathcal{P}_{11}+\\mathcal{P}_{22}$，$Q = \\mathcal{P}_{11}-\\mathcal{P}_{22}$ 和 $U = 2\\mathcal{P}_{12}$。\n\n通过单次Thomson散射产生极化辐射的过程可以用辐射转移方程中的一个源项来描述。设电子位置处的入射辐射场由来自方向 $\\mathbf{n'}$ 的强度 $I(\\mathbf{n'})$ 描述。该辐射场的四极矩是一个无迹张量，定义为：\n$$\n\\mathcal{I}_{ij} = \\int \\frac{d\\Omega'}{4\\pi} \\left(I(\\mathbf{n'}) - I_0\\right) \\left(n'_i n'_j - \\frac{1}{3}\\delta_{ij}\\right)\n$$\n其中 $I_0$ 是单极（平均）强度。\n\n极化散射辐射的源项 $\\mathcal{S}_{ij}$ 给出了单位光学深度下产生的强度张量，它正比于该入射四极矩的横向无迹投影。其表达式为：\n$$\n\\mathcal{S}_{ij}(\\mathbf{n}) = K \\left[ (\\mathbf{P}\\mathcal{I}\\mathbf{P})_{ij} - \\frac{1}{2}P_{ij}(\\mathbf{n})\\,\\mathrm{Tr}(\\mathbf{P}\\mathcal{I}\\mathbf{P}) \\right]\n$$\n其中 $K$ 是一个无量纲的比例常数，$P_{ij}(\\mathbf{n}) = \\delta_{ij} - n_i n_j$ 是到与观测者视线 $\\mathbf{n}$ 垂直的平面上的投影张量，且 $(\\mathbf{P}\\mathcal{I}\\mathbf{P})_{ij} = P_{ik}(\\mathbf{n})\\mathcal{I}_{kl}P_{lj}(\\mathbf{n})$。\n\n考虑一个位于轴对称星系团中心的电子。感生CMB四极矩的对称轴与笛卡尔坐标系的 $\\hat{z}$ 轴对齐。四极张量由下式给出：\n$$\n\\mathcal{I}_{ij} = A_Q (3\\hat{z}_i\\hat{z}_j - \\delta_{ij})\n$$\n其中 $A_Q$ 是一个反映星系团椭率和势阱深度的常数振幅。\n\n一位观测者沿着与星系团对称轴 $\\hat{z}$ 成 $\\theta$ 角的视线 $\\mathbf{n}$ 测量散射辐射。不失一般性，令 $\\mathbf{n} = (\\sin\\theta, 0, \\cos\\theta)$。Stokes参量在固定于天空的基中测量：$\\mathbf{e}_1 = (0, 1, 0)$ 和 $\\mathbf{e}_2 = (\\cos\\theta, 0, -\\sin\\theta)$。\n\n计算散射辐射的Stokes参量 $Q_S$，其定义为 $Q_S = \\mathcal{S}_{11} - \\mathcal{S}_{22}$。用 $K$，$A_Q$ 和 $\\theta$ 表示你的答案。", "solution": "1. 极化源张量为\n$$\n\\mathcal{S}_{ij}=K\\Bigl[(P\\,\\mathcal{I}\\,P)_{ij}-\\tfrac12P_{ij}\\Tr(P\\,\\mathcal{I}\\,P)\\Bigr],\n\\quad\nP_{ij}=\\delta_{ij}-n_i n_j.\n$$  \n2. 在垂直于 $\\mathbf n$ 的天空基 $(\\mathbf e_1,\\mathbf e_2)$ 中，可以得到\n$$\nQ_S=\\mathcal{S}_{11}-\\mathcal{S}_{22}\n=K\\Bigl[(PIP)_{11}-(PIP)_{22}\\Bigr],\n$$  \n因为 $P_{11}=P_{22}=1$，所以迹项抵消了。\n3. 对于任何与 $\\mathbf n$ 垂直的向量 $\\mathbf e_r$，有 $P\\mathbf e_r=\\mathbf e_r$，因此\n$$\n(PIP)_{rr}=\\mathbf e_r^T\\,\\mathcal I\\,\\mathbf e_r,\n\\quad r=1,2.\n$$  \n4. 四极张量为\n$$\n\\mathcal I_{ij}=A_Q\\,(3\\hat z_i\\hat z_j-\\delta_{ij}).\n$$  \n5. 计算\n$$\n\\mathbf e_1=(0,1,0)\\implies \\mathbf e_1^T\\mathcal I\\,\\mathbf e_1\n=A_Q(3\\cdot0^2-1)=-A_Q,\n$$  \n$$\n\\mathbf e_2=(\\cos\\theta,0,-\\sin\\theta)\\implies \n\\mathbf e_2^T\\mathcal I\\,\\mathbf e_2\n=A_Q\\bigl(3(\\hat z\\cdot\\mathbf e_2)^2-1\\bigr)\n=A_Q(3\\sin^2\\theta-1).\n$$  \n6. 因此\n$$\nQ_S\n=K\\bigl[-A_Q -A_Q(3\\sin^2\\theta-1)\\bigr]\n=-3K\\,A_Q\\,\\sin^2\\theta.\n$$", "answer": "$$\\boxed{-3\\,K\\,A_Q\\,\\sin^2\\theta}$$", "id": "891871"}]}