{"hands_on_practices": [{"introduction": "第一个练习旨在直接应用天体测量的核心概念。通过计算一颗恒星穿过其自身角直径所需的时间，你将把三个关键的可观测量联系起来：三角视差（距离的代表）、自行（角速度）和角大小。这个练习有助于在一个简单的物理情境中，巩固你对这些几何量如何相互关联的理解。[@problem_id:894694]", "problem": "从太阳系观测一颗遥远的恒星。其位置和性质由几个天体测量参数来表征。\n\n三角视差 $p$ 是由于地球轨道运动引起的恒星最大视位移角的一半。对于小角度，恒星的距离 $d$ 与其视差的关系为 $d = A/p$，其中 $A$ 是一个天文单位（地球轨道的半径）。按照惯例，如果 $p$ 以角秒为单位测量，则以秒差距 (pc) 为单位的距离 $d$ 由 $d = 1/p$ 给出。一秒差距是一个天文单位对向的张角为一角秒时的距离。\n\n该恒星的物理半径为 $R$。从地球上看，这个物理尺寸对应于一个角半径 $\\alpha$。对于距离为 $d$ 的恒星，小角度近似给出 $\\alpha \\approx R/d$。因此，角直径为 $\\Theta_D = 2\\alpha$。\n\n该恒星也表现出自行，这是从太阳系质心看它在天球上移动的角速度。自行由两个分量描述：赤经 ($\\alpha$) 增加方向上的 $\\mu_\\alpha$ 和赤纬 ($\\delta$) 增加方向上的 $\\mu_\\delta$。在球面天体坐标网格上，赤经的变化量 $\\Delta\\alpha$ 对应于 $(\\Delta\\alpha)\\cos\\delta$ 的角弧长。因此，总自行 $\\mu$ 是两个正交速度分量矢量和的大小：一个沿着赤纬圈，一个沿着子午圈。\n\n**问题：**\n\n一颗恒星位于赤纬 $\\delta$ 处。它具有三角视差 $p$、赤经方向的自行 $\\mu_\\alpha$ 和赤纬方向的自行 $\\mu_\\delta$。该恒星的物理半径 $R$ 与天文单位 $A$ 的比值由无量纲量 $\\rho = R/A$ 给出。\n\n假设所有相关角度都很小，确定该恒星在天球上移动一个等于其自身视角直径的角距离所需的时间 $\\Delta t$。视差 $p$ 和自行分量 $\\mu_\\alpha$、$\\mu_\\delta$ 的单位分别为角秒和角秒/单位时间。请用 $p, \\rho, \\mu_\\alpha, \\mu_\\delta$ 和 $\\delta$ 将您的最终答案表示为一个符号表达式。", "solution": "问题要求的是恒星移动一段等于其自身角直径 $\\Theta_D$ 的角距离所需的时间 $\\Delta t$。这个时间可以通过将角距离除以总角速度（即自行的大小 $\\mu$）来求得。\n\n$$\n\\Delta t = \\frac{\\Theta_D}{\\mu}\n$$\n\n我们需要用给定的参数推导出角直径 $\\Theta_D$ 和总自行 $\\mu$ 的表达式。\n\n**步骤1：计算角直径 $\\Theta_D$**\n\n恒星的角半径 $\\alpha$ 由小角度近似 $\\alpha \\approx R/d$ 给出，其中 $R$ 是恒星的物理半径，$d$ 是它与地球的距离。角直径是角半径的两倍，所以 $\\Theta_D = 2\\alpha \\approx 2R/d$。\n\n问题给出了比值 $\\rho = R/A$，其中 $A$ 是天文单位。所以，我们可以写成 $R = \\rho A$。\n\n距离 $d$ 与视差 $p$ 相关。根据定义，距离为1秒差距 (pc) 的恒星，其视差为1角秒（''）。因此，对于以角秒为单位的视差 $p$，以秒差距为单位的距离 $d$ 为 $d~[\\text{pc}] = 1/p~['']$。\n\n为了保持 $R$ 和 $d$ 的单位一致，我们必须用天文单位 $A$ 来表示 $d$。秒差距的定义是一个天文单位对向的张角为一角秒时的距离。\n$$\n1~\\text{pc} = \\frac{1~A}{\\tan(1'')} \\approx \\frac{1~A}{1''~\\text{in radians}}\n$$\n让我们用天文单位表示距离 d：\n$$\nd~[A] = d~[\\text{pc}] \\times \\frac{1~\\text{pc}}{1~A} = \\left(\\frac{1}{p~['']}\\right) \\times \\frac{1~A/\\tan(1'')}{1~A} = \\frac{1}{p~[''] \\tan(1'')}\n$$\n现在我们可以计算以弧度为单位的角直径：\n$$\n\\Theta_D~[\\text{rad}] = \\frac{2R}{d} = \\frac{2\\rho A}{ \\frac{A}{p~[''] \\tan(1'')} } = 2\\rho p~[''] \\tan(1'')\n$$\n为了以角秒表示角直径，我们注意到对于小角度 $\\theta$，有 $\\theta~[\\text{rad}] \\approx \\theta~[''] \\times \\frac{\\pi}{180 \\times 3600}$，而 $\\tan(1'') \\approx 1''~\\text{in radians} = \\frac{\\pi}{180 \\times 3600}$。因此，以角秒为单位的角直径为：\n$$\n\\Theta_D~[''] = 2\\rho p~['']\n$$\n恒星的角直径（以角秒为单位）是 $2\\rho p$。\n\n**步骤2：计算总自行 $\\mu$**\n\n自行由两个分量给出：$\\mu_\\alpha = d\\alpha/dt$ 和 $\\mu_\\delta = d\\delta/dt$。\n分量 $\\mu_\\delta$ 代表沿天球子午圈的角速度。\n分量 $\\mu_\\alpha$ 是赤经坐标的变化率。在赤纬 $\\delta$ 处，赤经的微分变化 $d\\alpha$ 对应于天球上的一段微分弧长 $ds_\\alpha = d\\alpha \\cos\\delta$。因此，沿赤纬圈的角速度分量为 $v_\\alpha = (d\\alpha/dt)\\cos\\delta = \\mu_\\alpha \\cos\\delta$。\n\n沿子午圈和沿赤纬圈的两个运动分量是正交的。总自行矢量的大小 $\\mu$ 可用勾股定理求得：\n$$\n\\mu = \\sqrt{v_\\alpha^2 + \\mu_\\delta^2} = \\sqrt{(\\mu_\\alpha \\cos\\delta)^2 + \\mu_\\delta^2}\n$$\n如果 $\\mu_\\alpha$ 和 $\\mu_\\delta$ 的单位是角秒/单位时间，那么 $\\mu$ 的单位也是角秒/单位时间。\n\n**步骤3：计算时间尺度 $\\Delta t$**\n\n现在我们结合前面步骤的结果。恒星移动其角直径所需的时间是：\n$$\n\\Delta t = \\frac{\\Theta_D~['']}{\\mu~[''/\\text{time unit}]}\n$$\n代入推导出的 $\\Theta_D$ 和 $\\mu$ 的表达式：\n$$\n\\Delta t = \\frac{2\\rho p}{\\sqrt{(\\mu_\\alpha \\cos\\delta)^2 + \\mu_\\delta^2}}\n$$\n如果自行分量的单位是角秒/年，则所得的时间尺度 $\\Delta t$ 的单位将是年。", "answer": "$$ \\boxed{\\frac{2 \\rho p}{\\sqrt{(\\mu_\\alpha \\cos\\delta)^2 + \\mu_\\delta^2}}} $$", "id": "894694"}, {"introduction": "在理想化测量的基础上，这个练习深入探讨了观测天文学的实际问题：不确定性。恒星的切向速度 $v_t$ 是从视差 $p$ 和自行 $\\mu$ 推导出来的，而这两者都受到测量误差的影响。这个问题要求你找到一个“临界距离”，在此距离上，这两个来源的不确定性对速度误差的贡献相等。这为理解天体测量巡天的局限性和权衡提供了关键的洞察。[@problem_id:894652]", "problem": "一项天文巡天测量太阳邻域内恒星的性质。恒星的切向速度 $v_t$ 是根据其三角视差 $p$ 和自行大小 $\\mu$ 确定的。该关系可以写成 $v_t = K (\\mu/p)$，其中 $K$ 是一个常数，其值取决于单位制。视差 $p$（单位为角秒）与距离 $d$（单位为秒差距）通过常规公式 $d = 1/p$ 相关联。\n\n对于一颗特定的恒星，巡天提供了其视差的测量值，其不确定度为 $\\sigma_p$。该恒星的自行 $\\mu$ 是通过比较在持续时间为 $T$ 的时间间隔的开始和结束时进行的两次角位置测量来确定的。在单个角方向（例如，赤经或赤纬）上的一次位置测量的不确定度为 $\\sigma_{pos}$。\n\n假设视差和两次位置测量的测量误差都是统计独立的，确定临界距离 $d_c$。这是切向速度的不确定度 $\\sigma_{v_t}$ 从视差测量的的不确定度和自行测量的的不确定度获得相等贡献时的距离。\n\n用 $\\mu$、$\\sigma_p$、$\\sigma_{pos}$ 和 $T$ 表示你的答案 $d_c$，单位为秒差距。输入量的单位是一致的：$\\mu$ 的单位是角秒/年，$\\sigma_p$ 的单位是角秒，$\\sigma_{pos}$ 的单位是角秒，$T$ 的单位是年。", "solution": "恒星的切向速度 $v_t$ 由 $v_t = K (\\mu/p)$ 给出。我们将使用误差传播公式来计算 $v_t$ 的不确定度 $\\sigma_{v_t}$。\n\n**步骤 1：误差传播**\n$v_t$ 的不确定度 $\\sigma_{v_t}$ 由视差不确定度 $\\sigma_p$ 和自行不确定度 $\\sigma_\\mu$ 引起。假设 $\\mu$ 和 $p$ 的测量误差不相关，总不确定度的平方为：\n$$\n\\sigma_{v_t}^2 = \\left(\\frac{\\partial v_t}{\\partial p}\\right)^2 \\sigma_p^2 + \\left(\\frac{\\partial v_t}{\\partial \\mu}\\right)^2 \\sigma_\\mu^2\n$$\n计算偏导数：\n$$\n\\frac{\\partial v_t}{\\partial p} = -K \\frac{\\mu}{p^2}\n$$\n$$\n\\frac{\\partial v_t}{\\partial \\mu} = \\frac{K}{p}\n$$\n因此，由 $\\sigma_p$ 和 $\\sigma_\\mu$ 引起的 $v_t$ 不确定度的两个分量分别是：\n- 来自视差的不确定度贡献： $\\sigma_{v_t, p} = \\left|\\frac{\\partial v_t}{\\partial p}\\right| \\sigma_p = K \\frac{\\mu}{p^2} \\sigma_p$\n- 来自自行的不确定度贡献： $\\sigma_{v_t, \\mu} = \\left|\\frac{\\partial v_t}{\\partial \\mu}\\right| \\sigma_\\mu = \\frac{K}{p} \\sigma_\\mu$\n\n**步骤 2：确定临界条件**\n问题要求找到这两个贡献相等的条件，即 $\\sigma_{v_t, p} = \\sigma_{v_t, \\mu}$。\n$$\nK \\frac{\\mu}{p^2} \\sigma_p = \\frac{K}{p} \\sigma_\\mu\n$$\n消去公因式 $K/p$ 后，我们得到：\n$$\n\\frac{\\mu}{p} \\sigma_p = \\sigma_\\mu \\quad \\implies \\quad p = \\frac{\\mu \\sigma_p}{\\sigma_\\mu}\n$$\n临界距离 $d_c$ 是该临界视差的倒数，$d_c = 1/p$。\n$$\nd_c = \\frac{\\sigma_\\mu}{\\mu \\sigma_p}\n$$\n\n**步骤 3：推导自行的不确定度 $\\sigma_\\mu$**\n自行 $\\mu$ 是通过比较在时间间隔 $T$ 内的两次位置测量来确定的。我们考虑一个坐标方向（例如赤经）。位置变化量为 $\\Delta\\theta = \\theta_{end} - \\theta_{start}$。每次位置测量的误差为 $\\sigma_{pos}$，且两次测量是独立的，因此位置变化量的不确定度为：\n$$\n\\sigma_{\\Delta\\theta} = \\sqrt{\\sigma_{pos}^2 + \\sigma_{pos}^2} = \\sqrt{2} \\sigma_{pos}\n$$\n该方向上的自行分量为 $\\mu_{comp} = \\Delta\\theta / T$，其不确定度为：\n$$\n\\sigma_{\\mu_{comp}} = \\frac{\\sigma_{\\Delta\\theta}}{T} = \\frac{\\sqrt{2} \\sigma_{pos}}{T}\n$$\n为了简化问题，我们假设总自行的大小 $\\mu$ 的不确定度 $\\sigma_\\mu$ 主要由其主要运动分量的不确定度决定，因此我们近似地使用 $\\sigma_\\mu \\approx \\sigma_{\\mu_{comp}}$。这是一个常见的简化，在实际分析中，完整的误差传播会更复杂，但对于估算临界距离而言，这个近似是足够的。\n$$\n\\sigma_\\mu \\approx \\frac{\\sqrt{2} \\sigma_{pos}}{T}\n$$\n\n**步骤 4：计算临界距离 $d_c$**\n将 $\\sigma_\\mu$ 的表达式代入 $d_c$ 的公式中：\n$$\nd_c = \\frac{(\\sqrt{2} \\sigma_{pos} / T)}{\\mu \\sigma_p} = \\frac{\\sqrt{2} \\sigma_{pos}}{\\mu \\sigma_p T}\n$$\n由于距离以秒差距为单位给出，这意味着 $p$ 的单位是角秒。给定的所有单位（$\\mu$ in角秒/年, $\\sigma_p$ in 角秒, $\\sigma_{pos}$ in 角秒, $T$ in 年）是一致的，所以最终表达式不需要额外的转换因子。", "answer": "$$\\boxed{\\frac{\\sqrt{2}\\,\\sigma_{pos}}{\\mu\\,\\sigma_{p}\\,T}}$$", "id": "894652"}, {"introduction": "我们最后的练习旨在连接理论与现代数据分析。天文学家不是通过单次测量来确定视差和自行，而是将一个综合模型拟合到一系列带有各自不确定性的时序位置数据中。这个计算练习将指导你使用加权最小二乘法，从模拟的观测数据中提取天体测量参数 $\\pi$ 和 $\\mu$，这是诸如盖亚（Gaia）等任务核心的基本技术。[@problem_id:2412407]", "problem": "一个单一、紧凑的线性天体测量模型将恒星在历元 $t_i$ 处测得的角坐标与三个未知参数关联起来：一个参考角偏移量 $\\theta_0$（在指定的参考历元 $t_0$ 处）、一个线性自行 $\\mu$ 和一个标量视差 $\\pi$。其中，视差 $\\pi$ 与一个已知的无量纲视差因子 $P_i$ 相乘。该模型为\n$$\ny_i \\;=\\; \\theta_0 \\;+\\; \\mu \\,\\bigl(t_i - t_0\\bigr) \\;+\\; \\pi\\, P_i \\;+\\; \\varepsilon_i,\n$$\n其中每个 $\\varepsilon_i$ 是一个独立的零均值高斯误差，其标准差 $\\sigma_i$ 为已知。所有角度 $y_i$、$\\theta_0$ 和 $\\pi$ 的单位均为毫角秒 $\\mathrm{(mas)}$，自行 $\\mu$ 的单位为 $\\mathrm{mas/yr}$，时间 $t_i$ 和 $t_0$ 的单位为年 $\\mathrm{yr}$，视差因子 $P_i$ 为无量纲。\n\n你的任务是，对于下面提供的每个测试用例，确定能在上述模型下使高斯似然最大化的参数三元组 $\\bigl(\\pi,\\mu,\\theta_0\\bigr)$，以及它们的一倍标准差不确定度。这些不确定度由解处的对数似然的局部曲率（逆Hessian矩阵）得到。请将三个标准不确定度表示为 $\\bigl(\\sigma_\\pi,\\sigma_\\mu,\\sigma_{\\theta_0}\\bigr)$。所有报告的角度单位必须为 $\\mathrm{mas}$，自行单位必须为 $\\mathrm{mas/yr}$。将报告的每个实数四舍五入到恰好 $6$ 位小数。\n\n给定一个所有用例共用的参考历元 $t_0$：\n- $t_0 = 2022.0 \\ \\mathrm{yr}$。\n\n测试套件。对于每个用例，数组 $t$、$P$、$y$ 和 $\\sigma$ 都被明确给出。请使用上述模型和指定的单位。\n\n- 用例 $1$：\n  - $t \\ \\mathrm{(yr)} = [2020.0, \\ 2020.5, \\ 2021.0, \\ 2021.5, \\ 2022.0, \\ 2022.5, \\ 2023.0, \\ 2023.5]$.\n  - $P \\ \\text{(无量纲)} = [0.1, \\ -0.5, \\ -0.9, \\ -0.2, \\ 0.3, \\ 0.8, \\ 0.2, \\ -0.6]$.\n  - $y \\ \\mathrm{(mas)} = [4.72, \\ 1.9, \\ 0.52, \\ 7.06, \\ 12.16, \\ 17.26, \\ 14.44, \\ 10.18]$.\n  - $\\sigma \\ \\mathrm{(mas)} = [0.8, \\ 1.2, \\ 0.7, \\ 1.5, \\ 0.5, \\ 0.9, \\ 0.6, \\ 1.0]$.\n\n- 用例 $2$：\n  - $t \\ \\mathrm{(yr)} = [2021.0, \\ 2021.4, \\ 2021.8, \\ 2022.2, \\ 2022.6, \\ 2023.0]$.\n  - $P \\ \\text{(无量纲)} = [0.01, \\ -0.02, \\ 0.03, \\ -0.01, \\ 0.02, \\ -0.03]$.\n  - $y \\ \\mathrm{(mas)} = [4.52, \\ 4.66, \\ 4.96, \\ 5.08, \\ 5.34, \\ 5.44]$.\n  - $\\sigma \\ \\mathrm{(mas)} = [2.0, \\ 2.5, \\ 1.8, \\ 2.2, \\ 2.0, \\ 2.8]$.\n\n- 用例 $3$：\n  - $t \\ \\mathrm{(yr)} = [2021.0, \\ 2022.0, \\ 2023.0]$.\n  - $P \\ \\text{(无量纲)} = [0.5, \\ -0.3, \\ 0.7]$.\n  - $y \\ \\mathrm{(mas)} = [4.5, \\ -0.2, \\ 2.3]$.\n  - $\\sigma \\ \\mathrm{(mas)} = [1.0, \\ 10.0, \\ 0.2]$.\n\n要求的最终输出格式。你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。每个测试用例对应一个子列表，按上述用例的顺序排列。每个子列表必须是\n$$\n[\\ \\pi,\\ \\mu,\\ \\theta_0,\\ \\sigma_\\pi,\\ \\sigma_\\mu,\\ \\sigma_{\\theta_0}\\ ],\n$$\n格式，其中每个实数都需四舍五入到恰好 $6$ 位小数，并使用上文指定的单位。因此，总输出必须在一行上，格式如下\n$$\n\\bigl[ [\\cdots], [\\cdots], [\\cdots] \\bigr]\n$$", "solution": "所提出的问题是一个标准的参数估计任务，它针对的是一个带有非均匀方差高斯噪声的线性模型。这是一个经典的加权线性最小二乘问题，具有科学依据、是适定的且信息完备。所有必要的数据和定义都已提供。因此，我们可以直接进行求解。\n\n对于每次测量 $i$，天体测量模型给出如下\n$$\ny_i \\;=\\; \\theta_0 \\;+\\; \\mu \\,\\bigl(t_i - t_0\\bigr) \\;+\\; \\pi\\, P_i \\;+\\; \\varepsilon_i\n$$\n其中 $y_i$ 是测量值，$(\\pi, \\mu, \\theta_0)$ 是待定参数，$(t_i, t_0, P_i)$ 是已知系数，而 $\\varepsilon_i$ 是从均值为 $0$、标准差 $\\sigma_i$ 已知的高斯分布中抽取的随机误差。\n\n为了求解这些参数，我们将问题重写为矩阵形式。设观测次数为 $N$。这个由 $N$ 个线性方程组成的方程组可以写作 $\\boldsymbol{y} = \\boldsymbol{A}\\boldsymbol{x} + \\boldsymbol{\\varepsilon}$，其中：\n- $\\boldsymbol{y}$ 是 $N \\times 1$ 的观测值列向量 $[y_1, y_2, \\dots, y_N]^T$。\n- $\\boldsymbol{x}$ 是 $3 \\times 1$ 的未知参数列向量。为了与要求的输出格式匹配，我们将其定义为 $\\boldsymbol{x} = [\\pi, \\mu, \\theta_0]^T$。\n- $\\boldsymbol{A}$ 是 $N \\times 3$ 的设计矩阵，其中每一行对应一次观测，每一列对应一个参数。元素 $A_{ij}$ 是第 $i$ 次观测方程中第 $j$ 个参数的系数。根据我们对 $\\boldsymbol{x}$ 的定义，设计矩阵为\n$$\n\\boldsymbol{A} = \\begin{pmatrix}\nP_1 & t_1 - t_0 & 1 \\\\\nP_2 & t_2 - t_0 & 1 \\\\\n\\vdots & \\vdots & \\vdots \\\\\nP_N & t_N - t_0 & 1\n\\end{pmatrix}\n$$\n- $\\boldsymbol{\\varepsilon}$ 是 $N \\times 1$ 的随机误差列向量 $[\\varepsilon_1, \\varepsilon_2, \\dots, \\varepsilon_N]^T$。\n\n问题要求在给定参数的情况下，最大化数据的高斯似然。对数似然函数 $\\ln \\mathcal{L}(\\boldsymbol{x})$ 为：\n$$\n\\ln \\mathcal{L}(\\boldsymbol{x}) = -\\frac{1}{2} \\sum_{i=1}^N \\left[ \\left( \\frac{y_i - (\\boldsymbol{A}\\boldsymbol{x})_i}{\\sigma_i} \\right)^2 + \\ln(2\\pi\\sigma_i^2) \\right]\n$$\n最大化 $\\ln \\mathcal{L}(\\boldsymbol{x})$ 等价于最小化卡方统计量 $\\chi^2(\\boldsymbol{x})$，其定义为：\n$$\n\\chi^2(\\boldsymbol{x}) = \\sum_{i=1}^N \\left( \\frac{y_i - (\\boldsymbol{A}\\boldsymbol{x})_i}{\\sigma_i} \\right)^2\n$$\n这可以写成矩阵形式 $\\chi^2(\\boldsymbol{x}) = (\\boldsymbol{y} - \\boldsymbol{A}\\boldsymbol{x})^T \\boldsymbol{W} (\\boldsymbol{y} - \\boldsymbol{A}\\boldsymbol{x})$，其中 $\\boldsymbol{W}$ 是权重矩阵，这是一个对角矩阵，其元素为 $W_{ii} = 1/\\sigma_i^2$。\n\n为了找到使 $\\chi^2$ 最小化的参数向量 $\\boldsymbol{\\hat{x}}$，我们将 $\\chi^2$ 对 $\\boldsymbol{x}$ 的梯度设为零：\n$$\n\\frac{\\partial\\chi^2}{\\partial\\boldsymbol{x}} = -2 \\boldsymbol{A}^T \\boldsymbol{W} (\\boldsymbol{y} - \\boldsymbol{A}\\boldsymbol{x}) = \\boldsymbol{0}\n$$\n这就得出了加权最小二乘问题的正规方程组：\n$$\n(\\boldsymbol{A}^T \\boldsymbol{W} \\boldsymbol{A}) \\boldsymbol{x} = \\boldsymbol{A}^T \\boldsymbol{W} \\boldsymbol{y}\n$$\n最佳拟合参数 $\\boldsymbol{\\hat{x}}$ 的解通过求解此线性系统得到：\n$$\n\\boldsymbol{\\hat{x}} = (\\boldsymbol{A}^T \\boldsymbol{W} \\boldsymbol{A})^{-1} (\\boldsymbol{A}^T \\boldsymbol{W} \\boldsymbol{y})\n$$\n矩阵 $\\boldsymbol{C}_{\\boldsymbol{x}} = (\\boldsymbol{A}^T \\boldsymbol{W} \\boldsymbol{A})^{-1}$ 是估计参数 $\\boldsymbol{\\hat{x}}$ 的协方差矩阵。正如问题陈述所要求的，该矩阵恰好是于解 $\\boldsymbol{\\hat{x}}$ 处求值的对数似然函数的Hessian矩阵的逆的负值。$\\ln\\mathcal{L}$ 的Hessian矩阵是 $\\boldsymbol{H} = \\frac{\\partial^2(\\ln\\mathcal{L})}{\\partial\\boldsymbol{x}\\partial\\boldsymbol{x}^T} = -\\boldsymbol{A}^T\\boldsymbol{W}\\boldsymbol{A}$，对于此线性模型而言，它是一个常数矩阵。因此，协方差矩阵为 $\\boldsymbol{C}_{\\boldsymbol{x}} = (-\\boldsymbol{H})^{-1} = (\\boldsymbol{A}^T \\boldsymbol{W} \\boldsymbol{A})^{-1}$。\n\n参数的一倍标准差不确定度是协方差矩阵 $\\boldsymbol{C}_{\\boldsymbol{x}}$ 对角元素的平方根。具体来说，如果 $\\boldsymbol{C}_{\\boldsymbol{x}}$ 的对角元素为 $C_{11}, C_{22}, C_{33}$，那么：\n$$\n\\sigma_{\\pi} = \\sqrt{C_{11}}, \\quad \\sigma_{\\mu} = \\sqrt{C_{22}}, \\quad \\sigma_{\\theta_0} = \\sqrt{C_{33}}\n$$\n以下算法为每个测试用例实现了此解法。\n$1$. 根据给定数据构建设计矩阵 $\\boldsymbol{A}$ 和观测向量 $\\boldsymbol{y}$。\n$2$. 构建权重向量 $w_i = 1/\\sigma_i^2$。\n$3$. 计算矩阵 $\\boldsymbol{M} = \\boldsymbol{A}^T \\boldsymbol{W} \\boldsymbol{A}$ 和向量 $\\boldsymbol{b} = \\boldsymbol{A}^T \\boldsymbol{W} \\boldsymbol{y}$。在计算上，这一步无需显式构造对角矩阵 $\\boldsymbol{W}$。例如，$\\boldsymbol{M}$ 可通过 $\\boldsymbol{A}^T (\\boldsymbol{A} \\odot \\boldsymbol{w})$ 计算，其中 $\\odot$ 表示按行乘以权重向量 $\\boldsymbol{w}$。\n$4$. 求解线性系统 $\\boldsymbol{M}\\boldsymbol{x} = \\boldsymbol{b}$，得到参数向量 $\\boldsymbol{\\hat{x}}$。\n$5$. 通过 $\\boldsymbol{C}_{\\boldsymbol{x}} = \\boldsymbol{M}^{-1}$ 计算协方差矩阵。\n$6$. 通过取 $\\boldsymbol{C}_{\\boldsymbol{x}}$ 对角元素的平方根来提取不确定度。\n$7$. 组装最终结果并按要求格式化。", "answer": "[[5.021021, 4.015250, 11.002878, 0.407223, 0.316886, 0.264426], [12.822036, 0.499092, 5.011681, 38.254355, 0.941655, 0.840049], [5.035811, -1.026419, 1.082721, 0.932412, 0.208151, 0.210408]]", "id": "2412407"}]}