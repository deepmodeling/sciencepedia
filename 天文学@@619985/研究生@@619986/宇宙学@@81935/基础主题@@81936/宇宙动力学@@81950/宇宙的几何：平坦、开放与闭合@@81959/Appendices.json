{"hands_on_practices": [{"introduction": "我们的第一个实践将探讨一种仅由物质主导的宇宙的基本动力学。在这个练习中，我们将分析一个封闭宇宙（$k=+1$）的演化，这种宇宙的命运是在引力作用下最终坍缩，即所谓的“大挤压”。通过求解弗里德曼方程，你将推导出这种宇宙在其膨胀达到最大尺寸时的年龄[@problem_id:874998]，这将帮助你掌握用于描述其生命周期的经典摆线解。", "problem": "考虑一个由 Friedmann-Lemaître-Robertson-Walker (FLRW) 度规描述的均匀且各向同性的宇宙。其无量纲尺度因子 $a(t)$ 的动力学由第一弗里德曼方程决定：\n$$ H(t)^2 \\equiv \\left(\\frac{\\dot{a}(t)}{a(t)}\\right)^2 = \\frac{8\\pi G}{3}\\rho(t) - \\frac{k c^2}{\\mathcal{R}_0^2 a(t)^2} $$\n此处，$H(t)$ 是哈勃参数，$\\rho(t)$ 是总能量密度，$G$ 是引力常数，$c$ 是光速，$k \\in \\{-1, 0, +1\\}$ 是曲率参数，分别决定了空间几何是开放的、平坦的还是闭合的。$\\mathcal{R}_0$ 是当前时刻 $t_0$ 的曲率半径，尺度因子被归一化为 $a(t_0) = 1$。\n\n临界密度定义为 $\\rho_c(t) = 3H(t)^2 / (8\\pi G)$，给定组分 $i$ 的密度参数为 $\\Omega_i(t) = \\rho_i(t) / \\rho_c(t)$。总密度参数为 $\\Omega(t) = \\sum_i \\Omega_i(t)$。曲率参数 $k$ 的值与当前时刻的总密度参数 $\\Omega_0 \\equiv \\Omega(t_0)$ 通过关系式 $k = \\mathrm{sgn}(\\Omega_0 - 1)$ 相关联。\n\n假设一个只包含非相对论性物质（尘埃）的宇宙，因此 $\\rho(t) = \\rho_m(t)$。该物质组分的能量密度随宇宙膨胀的标度关系为 $\\rho_m(t) = \\rho_{m,0} a(t)^{-3}$，其中 $\\rho_{m,0}$ 是当前时刻 $t_0$ 的物质密度。对于这样一个闭合宇宙（$k=+1$），当今的总密度参数必须大于一，即 $\\Omega_{m,0} > 1$。这种类型的宇宙从一次大爆炸开始，膨胀到最大尺寸，然后在大挤压中重新坍缩。\n\n确定该宇宙在达到最大膨胀瞬间的年龄 $t_{max}$。用当今的哈勃参数 $H_0 \\equiv H(t_0)$ 和当今的物质密度参数 $\\Omega_{m,0}$，将您的答案表示为一个闭合形式的解析表达式。", "solution": "1. 对于一个只含物质的闭合宇宙（$k=+1$, $\\Omega_{m,0}>1$），弗里德曼方程可写作\n$$\\left(\\frac{\\dot a}{a}\\right)^2 \\;=\\; H_0^2\\Bigl[\\Omega_{m,0}\\,a^{-3}+(1-\\Omega_{m,0})\\,a^{-2}\\Bigr]\\,. $$\n两边乘以 $a^2$ 得到\n$$\\dot a^2 \\;=\\; H_0^2\\Bigl[\\Omega_{m,0}\\,a^{-1}+(1-\\Omega_{m,0})\\Bigr]\\,. $$\n\n2. 因为 $1-\\Omega_{m,0}=-(\\Omega_{m,0}-1)<0$，设\n$$a(\\eta)=\\frac{\\Omega_{m,0}}{2(\\Omega_{m,0}-1)}\\bigl(1-\\cos\\eta\\bigr),$$\n这意味着 $a(0)=0$ 并且在 $\\eta=\\pi$ 时达到其最大值 $a_{\\max}=\\Omega_{m,0}/(\\Omega_{m,0}-1)$。\n\n3. 一个一致的参数化时间解是\n$$t(\\eta)=\\frac{\\Omega_{m,0}}{2H_0\\,(\\Omega_{m,0}-1)^{3/2}}\\bigl(\\eta-\\sin\\eta\\bigr)\\,, $$\n对其求导，确实满足 $\\dot a\\,d\\eta=dt$。\n\n4. 在最大膨胀时 $\\eta=\\pi$，所以\n$$t_{\\max}=t(\\pi)\n=\\frac{\\Omega_{m,0}}{2H_0\\,(\\Omega_{m,0}-1)^{3/2}}\\bigl(\\pi-0\\bigr)\n=\\frac{\\pi\\,\\Omega_{m,0}}{2\\,H_0\\,(\\Omega_{m,0}-1)^{3/2}}\\,. $$", "answer": "$$\\boxed{\\frac{\\pi\\,\\Omega_{m,0}}{2\\,H_0\\,(\\Omega_{m,0}-1)^{3/2}}}$$", "id": "874998"}, {"introduction": "在了解了纯物质宇宙之后，我们现在引入一个更复杂的成分：宇宙学常数 $\\Lambda$。这个练习探讨了在一个封闭宇宙中，物质的引力吸引与暗能量的宇宙排斥之间的对决[@problem_id:875035]。通过确定一个临界暗能量密度 $\\Omega_{\\Lambda,c}$，它恰好能阻止宇宙的再坍缩，你将亲身体会到宇宙的最终命运是如何悬于其能量组分之间微妙的平衡之上的。", "problem": "在一个仅包含非相对论性物质（尘埃）和宇宙学常数 $\\Lambda$ 的空间闭合宇宙中，其最终命运（是永久膨胀还是最终再坍缩）取决于物质和宇宙学常数的当今密度参数 $\\Omega_{m,0}$ 与 $\\Omega_{\\Lambda,0}$ 的值。\n\n这样一个宇宙的动力学由弗里德曼方程所支配。在一个闭合宇宙（$k=+1$）中，当 $\\Omega_{m,0} > 1$ 时，一个足够小的 $\\Omega_{\\Lambda,0}$ 值会导致最终的再坍缩（一个“大挤压”），这与仅含物质的情况类似。然而，一个足够大的宇宙学常数可以提供足够的宇宙斥力，以克服物质的引力并驱动永久膨胀。\n\n对于给定的 $\\Omega_{m,0}$，存在一个宇宙学常数密度的临界值 $\\Omega_{\\Lambda,c}$，它区分了这两种命运。这种临界情况对应于一个“徘徊”宇宙，即一个从大爆炸开始膨胀，并在无限宇宙时间时渐近地趋近于一个静态状态（爱因斯坦静态宇宙）的宇宙。这种情况发生在未来的某个尺度因子 $a_c$ 处，膨胀率和宇宙加速度同时变为零。\n\n从弗里德曼方程出发，对于一个满足 $\\Omega_{m,0} > 1$ 的空间闭合宇宙，求出宇宙学常数密度的临界值 $\\Omega_{\\Lambda,c}$ 作为物质密度参数 $\\Omega_{m,0}$ 的函数。", "solution": "我们从一个闭合（$k=+1$）、包含尘埃和 $\\Lambda$ 的宇宙中的弗里德曼方程开始（尺度因子归一化为 $a_0=1$）：\n$$\\Bigl(\\frac{\\dot a}{a}\\Bigr)^2\n=H_0^2\\Bigl[\\Omega_{m,0}\\,a^{-3}+\\Omega_{\\Lambda,0}+(1-\\Omega_{m,0}-\\Omega_{\\Lambda,0})\\,a^{-2}\\Bigr]\\,.$$\n在 $a=a_c$ 处的静态徘徊（临界）解同时满足\n1) $H(a_c)=0$:\n$$\\Omega_{m,0}\\,a_c^{-3}+\\Omega_{\\Lambda,0}+(1-\\Omega_{m,0}-\\Omega_{\\Lambda,0})\\,a_c^{-2}=0,$$\n2) $\\ddot a(a_c)=0$ 由 \n$$\\frac{\\ddot a}{a}\n=H_0^2\\Bigl[-\\tfrac12\\,\\Omega_{m,0}\\,a^{-3}+\\Omega_{\\Lambda,0}\\Bigr]=0\n\\;\\Longrightarrow\\;\n\\Omega_{\\Lambda,0}=\\tfrac12\\,\\Omega_{m,0}\\,a_c^{-3}\\,. $$\n\n由(2)可得\n$$a_c^3=\\frac{\\Omega_{m,0}}{2\\Omega_{\\Lambda,0}}\\,,\\quad\na_c^{-2}=\\Bigl(\\tfrac{2\\Omega_{\\Lambda,0}}{\\Omega_{m,0}}\\Bigr)^{2/3},\\quad\na_c^{-3}=\\frac{2\\Omega_{\\Lambda,0}}{\\Omega_{m,0}}\\,. $$\n\n代入(1)中：\n$$\\Omega_{m,0}\\frac{2\\Omega_{\\Lambda,0}}{\\Omega_{m,0}}\n+\\Omega_{\\Lambda,0}\n+\\bigl(1-\\Omega_{m,0}-\\Omega_{\\Lambda,0}\\bigr)\n\\Bigl(\\tfrac{2\\Omega_{\\Lambda,0}}{\\Omega_{m,0}}\\Bigr)^{2/3}=0$$\n$$\\Longrightarrow\\;3\\,\\Omega_{\\Lambda,0}\n=(\\Omega_{m,0}+\\Omega_{\\Lambda,0}-1)\\Bigl(\\tfrac{2\\Omega_{\\Lambda,0}}{\\Omega_{m,0}}\\Bigr)^{2/3}\\,.$$\n将两边三次方，得到三次方程\n$$4\\bigl(\\Omega_{m,0}+\\Omega_{\\Lambda,0}-1\\bigr)^3\n-27\\,\\Omega_{m,0}^2\\,\\Omega_{\\Lambda,0}=0\\,.$$\n定义 $X=\\Omega_{m,0}$，$Y=\\Omega_{\\Lambda,0}$ 并设\n$S=X+Y-1$, $27X^2Y=4S^3$。\n通过 $Y=u-(X-1)$ 将三次方程写为降次形式，得到\n$$u^3-\\frac{27}{4}X^2\\,u+\\frac{27}{4}X^2(X-1)=0\\,,$$\n其卡尔达诺解为\n$$u=2\\sqrt{-\\frac{\\alpha}{3}}\\,\n\\cos\\!\\Bigl[\\tfrac13\\arccos\\!\\Bigl(\\frac{3\\beta}{2\\alpha}\\sqrt{-\\tfrac{3}{\\alpha}}\\Bigr)\\Bigr],$$\n其中 $\\alpha=-\\tfrac{27}{4}X^2$，$\\beta=\\tfrac{27}{4}X^2(X-1)$。可以得到\n$$u=3X\\cos\\!\\Bigl[\\tfrac13\\arccos\\!\\bigl(\\tfrac{1-X}{X}\\bigr)\\Bigr],$$\n因此\n$$Y=u-(X-1)\n=3X\\cos\\!\\Bigl[\\tfrac13\\arccos\\!\\bigl(\\tfrac{1-X}{X}\\bigr)\\Bigr]-X+1.$$\n重新代入 $X=\\Omega_{m,0}$ 和 $Y=\\Omega_{\\Lambda,c}$ 即可得到临界值。", "answer": "$$\\boxed{\\Omega_{\\Lambda,c}\n=3\\,\\Omega_{m,0}\\,\\cos\\!\\Bigl[\\tfrac{1}{3}\\,\\arccos\\!\\bigl(\\tfrac{1-\\Omega_{m,0}}{\\Omega_{m,0}}\\bigr)\\Bigr]\n-\\Omega_{m,0}+1}$$", "id": "875035"}, {"introduction": "最后的练习将理论与实际计算相结合，这是现代宇宙学研究的核心。这个任务要求你综合运用物质、暗能量和曲率等所有概念，来计算一个关键的天文可观测量：光度距离 $d_L$ [@problem_id:2397758]。通过编写程序并实现数值积分，你将把弗里德曼-勒梅特-罗伯逊-沃尔克（FLRW）度规的理论框架，直接与宇宙学家测量宇宙几何和膨胀历史的实际方法联系起来。", "problem": "您的任务是在一个一般的非平坦 Friedmann–Lemaître–Robertson–Walker (FLRW) 宇宙中，通过使用高斯求积法计算视线方向上的共动距离积分来计算光度距离 $d_L$。您必须编写一个完整的、可运行的程序来执行以下操作。\n\n从以下在现代宇宙学中经过充分检验的基本要素开始。作为红移 $z$ 函数的膨胀率由哈勃参数 $H(z)$ 给出，它以当今的哈勃常数 $H_0$ 和当今的密度参数 $\\Omega_r$、$\\Omega_m$ 和 $\\Omega_\\Lambda$ 表示。通过闭合关系定义曲率参数，即 $\\Omega_k = 1 - \\Omega_r - \\Omega_m - \\Omega_\\Lambda$。无量纲膨胀率为\n$$\nE(z) \\equiv \\frac{H(z)}{H_0} = \\sqrt{\\Omega_r (1+z)^4 + \\Omega_m (1+z)^3 + \\Omega_k (1+z)^2 + \\Omega_\\Lambda}.\n$$\n视线方向上的共动距离为\n$$\nD_C(z) = \\frac{c}{H_0} \\int_{0}^{z} \\frac{dz'}{E(z')},\n$$\n其中 $c$ 是光速。横向共动距离 $D_M(z)$ 通过函数 $S_k(\\chi)$ 依赖于空间曲率，其中 $\\chi \\equiv \\int_{0}^{z} \\frac{dz'}{E(z')}$：\n$$\nD_M(z) = \\frac{c}{H_0}\n\\begin{cases}\n\\frac{1}{\\sqrt{\\Omega_k}} \\sinh\\!\\big(\\sqrt{\\Omega_k}\\,\\chi\\big), & \\Omega_k > 0,\\\\\n\\chi, & \\Omega_k = 0,\\\\\n\\frac{1}{\\sqrt{|\\Omega_k|}} \\sin\\!\\big(\\sqrt{|\\Omega_k|}\\,\\chi\\big), & \\Omega_k < 0.\n\\end{cases}\n$$\n光度距离与横向共动距离的关系为\n$$\nd_L(z) = (1+z)\\,D_M(z).\n$$\n\n您的程序必须：\n- 使用高斯求积（特别是高斯-勒让德求积）在有限区间 $[0,z]$ 上计算积分 $\\int_{0}^{z} \\frac{dz'}{E(z')}$。不要使用任何黑箱数值积分程序；相反，应使用高斯-勒让德求积的节点和权重来构建求积，并将其适当地映射到区间 $[0,z]$。\n- 使用光速 $c = 299792.458\\,\\mathrm{km\\,s^{-1}}$，并接受单位为 $\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$ 的 $H_0$，这样，无需进一步的单位转换，距离的单位即为百万秒差距（Mpc）。\n- 对于每个测试用例，使用 $\\Omega_k = 1 - \\Omega_r - \\Omega_m - \\Omega_\\Lambda$ 从 $\\Omega_r$、$\\Omega_m$ 和 $\\Omega_\\Lambda$ 计算 $\\Omega_k$。\n- 以数值稳定的方式处理所有三种曲率情况：$\\Omega_k > 0$、$\\Omega_k = 0$ 和 $\\Omega_k < 0$。\n\n本问题不涉及角度单位。所有物理距离输出必须以百万秒差距（Mpc）为单位表示，并四舍五入到六位小数。\n\n测试套件。您的程序必须为以下5个测试用例计算 $d_L$，每个用例由 $(H_0, \\Omega_m, \\Omega_r, \\Omega_\\Lambda, z)$ 指定：\n- 用例 1：$(70.0,\\;0.3,\\;0.0,\\;0.7,\\;1.0)$。\n- 用例 2：$(70.0,\\;0.3,\\;0.0,\\;0.6,\\;2.0)$。\n- 用例 3：$(70.0,\\;0.4,\\;0.0,\\;0.7,\\;1.0)$。\n- 用例 4：$(67.74,\\;0.3089,\\;0.0,\\;0.6911,\\;0.0)$。\n- 用例 5：$(73.0,\\;0.27,\\;9.0\\times 10^{-5},\\;0.73,\\;3.0)$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的结果按上述测试用例的顺序排列，每个条目是以 $\\mathrm{Mpc}$ 为单位、四舍五入到六位小数的光度距离 $d_L$，例如：\n$[d_{L,1},d_{L,2},d_{L,3},d_{L,4},d_{L,5}]$。", "solution": "该问题要求在 Friedmann–Lemaître–Robertson–Walker (FLRW) 宇宙中，针对几组宇宙学参数，计算光度距离 $d_L$。解决方案必须通过使用高斯-勒让德求积对共动距离积分进行数值计算来得出。\n\n光度距离和共动距离之间的基本关系植根于由 FLRW 度规描述的膨胀、均匀且各向同性的宇宙的几何学。光度距离 $d_L$ 既考虑了空间的膨胀，也考虑了来自遥远源的光信号的时间膨胀。\n\n计算过程遵循以下逻辑步骤。\n\n首先，我们定义无量纲哈勃参数 $E(z)$，它描述了宇宙膨胀率作为红移 $z$ 的函数：\n$$\nE(z) = \\sqrt{\\Omega_r (1+z)^4 + \\Omega_m (1+z)^3 + \\Omega_k (1+z)^2 + \\Omega_\\Lambda}\n$$\n这里，$\\Omega_m$、$\\Omega_r$ 和 $\\Omega_\\Lambda$ 分别是物质、辐射和暗能量的当今密度参数。曲率密度参数 $\\Omega_k$ 由闭合关系确定：\n$$\n\\Omega_k = 1 - \\Omega_m - \\Omega_r - \\Omega_\\Lambda\n$$\n$\\Omega_k=0$ 对应于空间平坦的宇宙，$\\Omega_k > 0$ 对应于开放（双曲）宇宙，$\\Omega_k < 0$ 对应于闭合（球形）宇宙。\n\n其次，我们通过对哈勃参数的倒数进行积分来计算视线方向上的共动距离 $D_C(z)$。此距离表示在某一固定宇宙时刻两个物体之间的固有距离。它由以下公式给出：\n$$\nD_C(z) = D_H \\int_{0}^{z} \\frac{dz'}{E(z')}\n$$\n其中 $D_H = c/H_0$ 是哈勃距离，c 是光速，H₀ 是今天的哈勃常数。我们将无量纲共动距离积分定义为：\n$$\n\\chi(z) = \\int_{0}^{z} \\frac{dz'}{E(z')}\n$$\n\n为了对该积分进行数值计算，我们采用高斯-勒让德求积，这是一种用于对行为良好的函数进行定积分近似的高效方法。标准的 $N$ 点高斯-勒让德求积可近似计算区间 $[-1, 1]$ 上的积分：\n$$\n\\int_{-1}^{1} f(x) dx \\approx \\sum_{i=1}^{N} w_i f(x_i)\n$$\n其中 $x_i$ 是节点（第 $N$ 阶勒让德多项式的根），$w_i$ 是相应的权重。为了将此方法应用于我们在 $[0, z]$ 上的积分，我们必须进行变量替换。令 $z' = \\frac{z}{2}(1+x)$。当 $x$ 从 $-1$ 变化到 $1$ 时，$z'$ 从 $0$ 变化到 $z$。微分量为 $dz' = \\frac{z}{2}dx$。$\\chi(z)$ 的积分变为：\n$$\n\\chi(z) = \\int_{-1}^{1} \\frac{1}{E\\left(\\frac{z}{2}(1+x)\\right)} \\frac{z}{2} dx\n$$\n应用求积法则，$\\chi(z)$ 的数值近似为：\n$$\n\\chi(z) \\approx \\frac{z}{2} \\sum_{i=1}^{N} \\frac{w_i}{E\\left(\\frac{z}{2}(1+x_i)\\right)}\n$$\n对于红移 $z=0$，积分为平凡的 $0$，因此 $\\chi(0)=0$。对于所有非零红移，我们使用此求和。足够多的点数，例如 $N=100$，可以确保对宇宙学中遇到的平滑被积函数具有高精度。\n\n第三，我们计算横向共动距离 $D_M(z)$。此距离根据空间曲率的影响对视线方向上的共动距离进行校正。它定义为：\n$$\nD_M(z) = D_H \\cdot S_k(\\chi)\n$$\n其中 $S_k(\\chi)$ 是一个依赖于 $\\Omega_k$ 符号的函数：\n$$\nS_k(\\chi) =\n\\begin{cases}\n\\frac{1}{\\sqrt{\\Omega_k}} \\sinh(\\sqrt{\\Omega_k}\\,\\chi) & \\text{若 } \\Omega_k > 0 \\quad \\text{(开放)} \\\\\n\\chi & \\text{若 } \\Omega_k = 0 \\quad \\text{(平坦)} \\\\\n\\frac{1}{\\sqrt{|\\Omega_k|}} \\sin(\\sqrt{|\\Omega_k|}\\,\\chi) & \\text{若 } \\Omega_k < 0 \\quad \\text{(闭合)}\n\\end{cases}\n$$\n为保证当 $\\Omega_k$ 非常接近零时的数值稳定性，至关重要的是要谨慎处理这些表达式。当 $\\Omega_k \\to 0$ 时，开放和闭合形式的极限都收敛于 $\\chi$。在实现时，我们设定一个小的阈值，例如 $10^{-8}$，如果 $|\\Omega_k|$ 低于此阈值，我们则使用平坦空间表达式 $D_M(z) = D_H \\chi$。\n\n最后，通过将横向共动距离乘以因子 $(1+z)$ 来获得光度距离 $d_L(z)$。该因子解释了光子能量的宇宙学红移以及光子发射和接收之间的时间膨胀。\n$$\nd_L(z) = (1+z) D_M(z)\n$$\n对于 $z=0$ 的平凡情况，光度距离为 $d_L(0) = 0$ Mpc，因为任何在零红移处的物体都处于零距离。\n\n所提供的程序实现了这整个过程。它定义了一个函数，该函数接收每个测试用例的宇宙学参数，计算 $\\Omega_k$，对 $\\chi(z)$ 执行高斯-勒让德求积，稳定地处理曲率情况以计算 $D_M(z)$，最后返回 $d_L(z)$。程序遍历指定的测试套件，收集结果，并以要求的格式打印它们。光速取为 $c = 299792.458\\,\\mathrm{km\\,s^{-1}}$，且 $H_0$ 的单位为 $\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$，所有距离结果的单位自然就是百万秒差距（Mpc）。", "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Computes the luminosity distance for a set of cosmological models\n    using Gauss-Legendre quadrature for the comoving distance integral.\n    \"\"\"\n\n    # Physical constant\n    C_LIGHT_KM_S = 299792.458  # Speed of light in km/s\n\n    # Gaussian quadrature parameters\n    N_QUADRATURE = 100  # Number of points for Gauss-Legendre quadrature\n    nodes, weights = roots_legendre(N_QUADRATURE)\n\n    # Test cases: (H0, Omega_m, Omega_r, Omega_Lambda, z)\n    test_cases = [\n        (70.0, 0.3, 0.0, 0.7, 1.0),\n        (70.0, 0.3, 0.0, 0.6, 2.0),\n        (70.0, 0.4, 0.0, 0.7, 1.0),\n        (67.74, 0.3089, 0.0, 0.6911, 0.0),\n        (73.0, 0.27, 9.0e-5, 0.73, 3.0),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        h0, omega_m, omega_r, omega_l, z = case\n\n        # Trivial case: at z=0, the distance is 0.\n        if z == 0.0:\n            results.append(0.0)\n            continue\n\n        # Calculate curvature density parameter by closure\n        omega_k = 1.0 - omega_m - omega_r - omega_l\n\n        def e_z(z_prime):\n            \"\"\"\n            Dimensionless Hubble parameter E(z').\n            \"\"\"\n            term_r = omega_r * (1 + z_prime)**4\n            term_m = omega_m * (1 + z_prime)**3\n            term_k = omega_k * (1 + z_prime)**2\n            term_l = omega_l\n            return np.sqrt(term_r + term_m + term_k + term_l)\n\n        # Gauss-Legendre quadrature for the comoving distance integral chi(z)\n        # We map the integration interval [0, z] to [-1, 1] for quadrature.\n        # Let z' = z/2 * (1 + x), so dz' = z/2 * dx.\n        # Integral becomes (z/2) * integral from -1 to 1 of 1/E(z'(x)) dx\n        \n        # Evaluate function at mapped nodes\n        z_prime_values = 0.5 * z * (1 + nodes)\n        integrand_values = 1.0 / e_z(z_prime_values)\n        \n        # Calculate the dimensionless comoving distance integral chi\n        chi = 0.5 * z * np.sum(weights * integrand_values)\n        \n        # Hubble distance in Mpc\n        hubble_distance = C_LIGHT_KM_S / h0\n\n        # Calculate transverse comoving distance D_M, handling curvature cases stably\n        # A small threshold for Omega_k to use the flat case approximation\n        k_threshold = 1e-8\n        \n        if abs(omega_k) < k_threshold:\n            # Flat universe (Omega_k is zero or numerically close to it)\n            dm = hubble_distance * chi\n        elif omega_k > 0:\n            # Open universe\n            sqrt_k = np.sqrt(omega_k)\n            dm = hubble_distance * (1.0 / sqrt_k) * np.sinh(sqrt_k * chi)\n        else: # omega_k < 0\n            # Closed universe\n            sqrt_abs_k = np.sqrt(abs(omega_k))\n            dm = hubble_distance * (1.0 / sqrt_abs_k) * np.sin(sqrt_abs_k * chi)\n\n        # Luminosity distance d_L\n        d_l = (1 + z) * dm\n        results.append(d_l)\n\n    # Format the final output string as per requirements\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2397758"}]}