{"hands_on_practices": [{"introduction": "在天文学中，许多双星系统因为距离我们太远或两颗恒星相距太近而无法被望远镜直接分辨。然而，我们依然可以精确测量其“光心”（亮度中心）围绕系统质心的微小摆动。本练习将向你展示如何巧妙地结合这种天体测量数据与从光谱观测中获得的周期信息，来推导该双星系统的总质量——这是理解恒星演化的一个基本参数。[@problem_id:236867]", "problem": "一个无法分辨的双星系统被观测为一个单谱线光谱双星（SB1），同时也是一个天体测量双星。由于该系统无法分辨，天体测量法追踪的是系统光心（光的中心）围绕质心的轨道，而不是主星本身的轨道。\n\n假设两颗恒星的质量分别为 $M_1$ 和 $M_2$，光度分别为 $L_1$ 和 $L_2$，它们在一个周期为 $P$ 的圆形轨道上运动。该系统所在距离对应的视差为 $\\varpi$。已测得光心轨道的角半长轴为 $\\alpha_{ph}$。\n\n定义质量比为 $q = M_2/M_1$，光度比为 $\\beta = L_2/L_1$。为了本次推导，假设 $q > \\beta$。普适引力常量为 $G$。\n\n推导系统总质量 $M_T = M_1 + M_2$ 的闭合表达式，用给定的参数 $P, \\varpi, \\alpha_{ph}, q, \\beta$ 和常量 $G$ 来表示。", "solution": "目标是推导双星系统的总质量 $M_T = M_1 + M_2$ 的表达式。我们从开普勒第三定律开始，它将总质量与轨道周期 $P$以及相对轨道的半长轴 $a$ 联系起来。\n\n开普勒第三定律的表达式为：\n$$\nM_T = M_1 + M_2 = \\frac{4\\pi^2 a^3}{G P^2}\n$$\n在这里，$a$ 是两颗恒星相对轨道（$\\vec{r} = \\vec{r}_1 - \\vec{r}_2$）的半长轴。我们的任务是用给定的可观测参数和系统参数来表示 $a$。\n\n半长轴 $a$ 可以表示为两颗恒星各自围绕质心轨道的半长轴 $a_1$ 和 $a_2$ 的和：\n$$\na = a_1 + a_2\n$$\n质心的位置定义为 $M_1 \\vec{r}_1 + M_2 \\vec{r}_2 = 0$。对于轨道的半长轴，这意味着：\n$$\nM_1 a_1 = M_2 a_2\n$$\n使用质量比 $q = M_2/M_1$，我们可以用 $a_1$ 表示 $a_2$：\n$$\na_2 = \\frac{M_1}{M_2} a_1 = \\frac{1}{q} a_1\n$$\n将此代入总半长轴 $a$ 的表达式中：\n$$\na = a_1 + \\frac{1}{q} a_1 = a_1 \\left(1 + \\frac{1}{q}\\right) = a_1 \\frac{q+1}{q}\n$$\n现在，我们需要将 $a_1$ 与观测到的量 $\\alpha_{ph}$ 联系起来。天体测量给出了光心轨道的半长轴 $a_{ph}$。这个物理尺寸通过以下公式与角尺寸 $\\alpha_{ph}$ 和视差 $\\varpi$ 相关：\n$$\na_{ph} = \\frac{\\alpha_{ph}}{\\varpi}\n$$\n相对于质心，光心 $\\vec{r}_{ph}$ 的位置是两颗恒星位置的光度加权平均值：\n$$\n\\vec{r}_{ph} = \\frac{L_1 \\vec{r}_1 + L_2 \\vec{r}_2}{L_1 + L_2}\n$$\n我们可以使用质心的定义将 $\\vec{r}_2$ 表示为 $\\vec{r}_1$ 的函数：$\\vec{r}_2 = -(M_1/M_2)\\vec{r}_1 = -(1/q)\\vec{r}_1$。将其代入光心方程：\n$$\n\\vec{r}_{ph} = \\frac{L_1 \\vec{r}_1 + L_2 (-\\frac{1}{q}\\vec{r}_1)}{L_1 + L_2} = \\vec{r}_1 \\left( \\frac{L_1 - L_2/q}{L_1 + L_2} \\right)\n$$\n我们可以从括号中的项里提出 $L_1$，并使用光度比 $\\beta = L_2/L_1$：\n$$\n\\vec{r}_{ph} = \\vec{r}_1 \\left( \\frac{L_1(1 - (L_2/L_1)/q)}{L_1(1 + L_2/L_1)} \\right) = \\vec{r}_1 \\left( \\frac{1 - \\beta/q}{1 + \\beta} \\right)\n$$\n这个关系同样适用于半长轴。因为我们假设 $q > \\beta$，所以项 $(1 - \\beta/q)$ 是正数。\n$$\na_{ph} = a_1 \\frac{1 - \\beta/q}{1 + \\beta} = a_1 \\frac{q - \\beta}{q(1 + \\beta)}\n$$\n我们现在可以解出 $a_1$（用 $a_{ph}$ 表示）：\n$$\na_1 = a_{ph} \\frac{q(1 + \\beta)}{q - \\beta}\n$$\n代入 $a_{ph} = \\alpha_{ph}/\\varpi$：\n$$\na_1 = \\frac{\\alpha_{ph}}{\\varpi} \\frac{q(1 + \\beta)}{q - \\beta}\n$$\n现在，我们将这个 $a_1$ 的表达式代入总半长轴的方程 $a = a_1 \\frac{q+1}{q}$ 中：\n$$\na = \\left( \\frac{\\alpha_{ph}}{\\varpi} \\frac{q(1 + \\beta)}{q - \\beta} \\right) \\left( \\frac{q+1}{q} \\right) = \\frac{\\alpha_{ph}}{\\varpi} \\frac{(1 + \\beta)(1 + q)}{q - \\beta}\n$$\n最后，我们将这个完整的 $a$ 的表达式代入开普勒第三定律，以求得总质量 $M_T$：\n$$\nM_T = \\frac{4\\pi^2}{G P^2} a^3 = \\frac{4\\pi^2}{G P^2} \\left( \\frac{\\alpha_{ph}}{\\varpi} \\frac{(1 + \\beta)(1 + q)}{q - \\beta} \\right)^3\n$$\n化简后得到总质量的最终表达式：\n$$\nM_T = \\frac{4\\pi^2 \\alpha_{ph}^3}{G P^2 \\varpi^3} \\left( \\frac{(1 + \\beta)(1 + q)}{q - \\beta} \\right)^3\n$$", "answer": "$$\n\\boxed{\\frac{4\\pi^2 \\alpha_{ph}^3}{G P^2 \\varpi^3} \\left( \\frac{(1 + \\beta)(1 + q)}{q - \\beta} \\right)^3}\n$$", "id": "236867"}, {"introduction": "真实的天体系统往往比孤立的双星模型更为复杂。本练习将引导你探索一个常见且重要的情况：一个双星系统本身是一个更庞大的三体系统的一部分。你将学习到，来自遥远第三天体的引力如何系统性地扭曲标准分析方法得出的结果，并亲自推导出修正公式，从而从被“污染”的数据中恢复出真实的质量比。[@problem_id:237039]", "problem": "在双谱分光双星（SB2）的研究中，两颗子星的质量比 $q = m_2/m_1$ 通常由它们视向速度曲线的半振幅 $K_1$ 和 $K_2$ 来确定。对于圆轨道，两颗恒星相对于系统质心的视向速度由 $v_{r,1}(t) = K_1 \\sin(\\omega t + \\phi)$ 和 $v_{r,2}(t) = -K_2 \\sin(\\omega t + \\phi)$ 给出。由于质心由 $m_1 v_1 + m_2 v_2 = 0$ 定义，因此可以推导出 $m_1 K_1 = m_2 K_2$，从而得到真实质量比的标准公式：$q_{true} = m_2/m_1 = K_1/K_2$。\n\n考虑一种情况，即该双星系统本身是一个更宽的三体系统的一部分。一个遥远的第三天体的引力影响导致内部双星的质心发生加速运动。在观测的时间跨度内，这种加速度可以近似为常数，从而导致观测到的视向速度出现线性漂移。\n\n因此，观测到的两颗恒星的视向速度不是纯粹的正弦形式，而是包含了这种漂移：\n$$ v_{obs,1}(t) = K_1 \\sin(\\omega t) + \\gamma_0 + \\dot{\\gamma} t $$\n$$ v_{obs,2}(t) = -K_2 \\sin(\\omega t) + \\gamma_0 + \\dot{\\gamma} t $$\n此处，$K_1$ 和 $K_2$ 是真实的半振幅，$\\omega$ 是内部双星的轨道频率，$\\gamma_0$ 是 $t=0$ 时的平均系统速度，而 $\\dot{\\gamma}$ 是系统速度的恒定变化率（即加速度）。为简单起见，通过选择合适的时间起点，将相位 $\\phi$ 设置为零。\n\n一位天文学家，在不知道第三天体存在的情况下，通过将标准正弦模型 $v_{fit}(t) = K_{obs} \\sin(\\omega t + \\phi_{obs}) + \\gamma_{obs}$ 拟合到跨越多个轨道周期的观测时间间隔 $T$ 内的视向速度曲线来分析数据。这个过程得出了观测到的（也是不正确的）半振幅 $K_{obs,1}$ 和 $K_{obs,2}$。根据这些值，计算出观测质量比为 $q_{obs} = K_{obs,1} / K_{obs,2}$。\n\n你的任务是推导真实质量比 $q_{true}$ 的表达式，该表达式用观测质量比 $q_{obs}$ 和一个无量纲参数 $\\alpha = \\frac{2\\dot{\\gamma}}{\\omega K_{obs,2}}$ 来表示。这个参数 $\\alpha$ 由可以从观测数据中确定的量构成：漂移 $\\dot{\\gamma}$（可以通过更复杂的拟合或简单正弦拟合的残差找到）、轨道频率 $\\omega$ 以及次星的观测半振幅 $K_{obs,2}$。", "solution": "当一位天文学家在时间间隔 $T$（假定为 $N$ 个轨道周期，即 $T = N \\frac{2\\pi}{\\omega}$）内对含有线性漂移的速度数据拟合一个纯正弦模型时，线性漂移项 $\\dot{\\gamma} t$ 会“泄漏”到正弦分量的系数中。\n\n1.  **计算拟合的正弦振幅**\n    标准的傅里叶分析告诉我们，从信号 $f(t)$ 中提取 $\\sin(\\omega t)$ 分量的振幅 $A$ 的方法是计算 $A = \\frac{2}{T} \\int_0^T f(t) \\sin(\\omega t) dt$。我们将此应用于 $v_{obs,1}(t)$ 和 $v_{obs,2}(t)$。\n    对于恒星1，观测到的振幅 $K_{obs,1}$ 为：\n    $$\n    K_{obs,1} = \\frac{2}{T} \\int_0^T (K_1 \\sin(\\omega t) + \\gamma_0 + \\dot{\\gamma} t) \\sin(\\omega t) dt\n    $$\n    由于 $\\int_0^T \\sin^2(\\omega t) dt = \\frac{T}{2}$，$\\int_0^T \\sin(\\omega t) dt = 0$，以及 $\\int_0^T t \\sin(\\omega t) dt = -\\frac{T}{\\omega} \\cos(\\omega T) = -\\frac{T}{\\omega}$，我们得到：\n    $$\n    K_{obs,1} = K_1 - \\frac{2\\dot{\\gamma}}{\\omega}\n    $$\n    类似地，对于恒星2，观测到的振幅 $K_{obs,2}$ 来自拟合 $-K_2 \\sin(\\omega t)$ 分量，所以：\n    $$\n    -K_{obs,2} = \\frac{2}{T} \\int_0^T (-K_2 \\sin(\\omega t) + \\gamma_0 + \\dot{\\gamma} t) \\sin(\\omega t) dt = -K_2 - \\frac{2\\dot{\\gamma}}{\\omega}\n    $$\n    因此，$K_{obs,2} = K_2 + \\frac{2\\dot{\\gamma}}{\\omega}$。\n\n2.  **建立关系**\n    我们定义一个漂移项 $d = \\frac{2\\dot{\\gamma}}{\\omega}$。观测到的振幅与真实振幅的关系为：\n    $$\n    K_{obs,1} = K_1 - d \\\\\n    K_{obs,2} = K_2 + d\n    $$\n    观测到的质量比 $q_{obs}$ 是：\n    $$\n    q_{obs} = \\frac{K_{obs,1}}{K_{obs,2}} = \\frac{K_1 - d}{K_2 + d}\n    $$\n\n3.  **用真实量表示**\n    真实质量比为 $q_{true} = K_1/K_2$，即 $K_1 = q_{true} K_2$。代入上式：\n    $$\n    q_{obs} = \\frac{q_{true} K_2 - d}{K_2 + d}\n    $$\n    整理该式以求解 $K_2$：\n    $$\n    q_{obs}(K_2 + d) = q_{true} K_2 - d \\\\\n    q_{obs}K_2 + q_{obs}d = q_{true}K_2 - d \\\\\n    d(q_{obs} + 1) = K_2(q_{true} - q_{obs}) \\\\\n    K_2 = d \\frac{q_{obs} + 1}{q_{true} - q_{obs}}\n    $$\n\n4.  **引入无量纲参数 $\\alpha$**\n    我们将 $K_2$ 的表达式代入 $K_{obs,2} = K_2 + d$ 中：\n    $$\n    K_{obs,2} = d \\frac{q_{obs} + 1}{q_{true} - q_{obs}} + d = d \\left( \\frac{q_{obs} + 1 + q_{true} - q_{obs}}{q_{true} - q_{obs}} \\right) = d \\frac{q_{true} + 1}{q_{true} - q_{obs}}\n    $$\n    问题中定义的无量纲参数是 $\\alpha = \\frac{2\\dot{\\gamma}}{\\omega K_{obs,2}} = \\frac{d}{K_{obs,2}}$。因此：\n    $$\n    \\alpha = \\frac{d}{K_{obs,2}} = \\frac{q_{true} - q_{obs}}{q_{true} + 1}\n    $$\n\n5.  **求解 $q_{true}$**\n    最后，我们整理上式以求解 $q_{true}$：\n    $$\n    \\alpha (q_{true} + 1) = q_{true} - q_{obs} \\\\\n    \\alpha q_{true} + \\alpha = q_{true} - q_{obs} \\\\\n    q_{obs} + \\alpha = q_{true} (1 - \\alpha) \\\\\n    q_{true} = \\frac{q_{obs} + \\alpha}{1 - \\alpha}\n    $$\n    这是真实质量比与观测质量比和漂移参数 $\\alpha$ 之间的最终关系。", "answer": "$$\\boxed{\\frac{q_{obs}+\\alpha}{1-\\alpha}}$$", "id": "237039"}, {"introduction": "任何科学测量，如果没有对其不确定性的评估，都是不完整的。本节的最后一个练习将带你进入天体测量学的统计层面，重点关注测量过程中的随机误差如何传递到我们最终推导出的轨道参数中。你将运用经典的最小二乘法，为描述目视双星轨道的Thiele-Innes常数推导其协方差矩阵，从而为轨道解的可靠性提供一个定量的、严谨的度量。[@problem_id:236830]", "problem": "目视双星系统的视轨道可以通过将其真轨道投影到天球切面上来描述。伴星相对于主星的直角坐标 $(x(t), y(t))$ 是时间 $t$ 的函数。对于一个轨道，如果其非线性参数（周期 $P$、近星点时刻 $T$ 和偏心率 $e$）已知，那么位置坐标可以线性地表示为四个被称为 Thiele-Innes 常数（记为 $A, B, F, G$）的参数。该模型为：\n$$\nx(t) = A X(t) + F Y(t) \\\\\ny(t) = B X(t) + G Y(t)\n$$\n其中，$X(t) = \\cos E(t) - e$ 和 $Y(t) = \\sqrt{1-e^2} \\sin E(t)$ 是轨道基函数，而 $E(t)$ 是偏近点角。对于在时刻 $t_k$ 进行的一组 $N$ 次观测，这些基函数取已知值 $X_k = X(t_k)$ 和 $Y_k = Y(t_k)$。\n\n考虑在时刻 $t_k$（$k=1, \\dots, N$）进行的一组 $N$ 次天体测量观测 $(x_k, y_k)$。与每个坐标 $x_k$ 和 $y_k$ 相关的测量误差是独立同分布的，服从均值为零、方差为常数 $\\sigma^2$ 的高斯分布。不同观测时刻的误差也是相互独立的。\n\nThiele-Innes 常数通过最小化残差平方和（线性最小二乘法）来估计。这些估计参数的不确定性由其协方差矩阵来描述。\n\n你的任务是推导估计参数矢量 $\\mathbf{c} = (A, B, F, G)^T$ 的 $4 \\times 4$ 协方差矩阵 $C_{\\mathbf{c}}$。请用测量方差 $\\sigma^2$ 和以下关于已知基函数的求和式来表示你的答案：\n$$\nS_{XX} \\equiv \\sum_{k=1}^{N} X_k^2, \\quad S_{YY} \\equiv \\sum_{k=1}^{N} Y_k^2, \\quad S_{XY} \\equiv \\sum_{k=1}^{N} X_k Y_k\n$$", "solution": "该线性模型可以为每次观测 $k$ 写成矩阵形式。令参数向量为 $\\mathbf{c} = (A, B, F, G)^T$，观测向量为 $\\mathbf{d}_k = (x_k, y_k)^T$。\n$$\n\\begin{pmatrix} x_k \\\\ y_k \\end{pmatrix} = \\begin{pmatrix} X_k & 0 & Y_k & 0 \\\\ 0 & X_k & 0 & Y_k \\end{pmatrix} \\begin{pmatrix} A \\\\ B \\\\ F \\\\ G \\end{pmatrix} + \\begin{pmatrix} \\varepsilon_{x,k} \\\\ \\varepsilon_{y,k} \\end{pmatrix}\n$$\n我们将设计矩阵表示为 $\\mathbf{H}_k$。对于所有 $N$ 次观测，我们可以构建一个大的线性系统 $\\mathbf{d} = \\mathbf{H}\\mathbf{c} + \\mathbf{\\varepsilon}$。\n\n根据线性最小二乘理论，估计参数 $\\hat{\\mathbf{c}}$ 的协方差矩阵 $C_{\\mathbf{c}}$ 由下式给出：\n$$\nC_{\\mathbf{c}} = (\\mathbf{H}^T \\mathbf{W} \\mathbf{H})^{-1}\n$$\n其中 $\\mathbf{W}$ 是权矩阵。由于误差是独立同分布的，且方差为 $\\sigma^2$，权矩阵是 $\\mathbf{W} = \\mathbf{I} / \\sigma^2$，其中 $\\mathbf{I}$ 是 $2N \\times 2N$ 的单位矩阵。因此，协方差矩阵简化为：\n$$\nC_{\\mathbf{c}} = \\sigma^2 (\\mathbf{H}^T \\mathbf{H})^{-1}\n$$\n我们需要计算矩阵 $\\mathbf{H}^T \\mathbf{H}$。\n$$\n\\mathbf{H}^T \\mathbf{H} = \\sum_{k=1}^{N} \\mathbf{H}_k^T \\mathbf{H}_k = \\sum_{k=1}^{N} \\begin{pmatrix} X_k & 0 \\\\ 0 & X_k \\\\ Y_k & 0 \\\\ 0 & Y_k \\end{pmatrix} \\begin{pmatrix} X_k & 0 & Y_k & 0 \\\\ 0 & X_k & 0 & Y_k \\end{pmatrix}\n$$\n$$\n\\mathbf{H}^T \\mathbf{H} = \\sum_{k=1}^{N} \\begin{pmatrix} X_k^2 & 0 & X_k Y_k & 0 \\\\ 0 & X_k^2 & 0 & X_k Y_k \\\\ X_k Y_k & 0 & Y_k^2 & 0 \\\\ 0 & X_k Y_k & 0 & Y_k^2 \\end{pmatrix} = \\begin{pmatrix} S_{XX} & 0 & S_{XY} & 0 \\\\ 0 & S_{XX} & 0 & S_{XY} \\\\ S_{XY} & 0 & S_{YY} & 0 \\\\ 0 & S_{XY} & 0 & S_{YY} \\end{pmatrix}\n$$\n这个矩阵是一个块对角矩阵，如果我们重新排列参数的顺序为 $(A, F, B, G)$。它由两个相同的 $2 \\times 2$ 块组成，对应于对 $(A, F)$ 和 $(B, G)$ 的独立拟合。\n令 $M = \\begin{pmatrix} S_{XX} & S_{XY} \\\\ S_{XY} & S_{YY} \\end{pmatrix}$，则 $\\mathbf{H}^T \\mathbf{H} = \\begin{pmatrix} M & 0 \\\\ 0 & M \\end{pmatrix}$（在适当的参数排序下）。\n更一般地，我们可以直接求这个 $4 \\times 4$ 矩阵的逆。由于其块结构，其逆也将是块形式的。\n$$\n(\\mathbf{H}^T \\mathbf{H})^{-1} = \\begin{pmatrix} M^{-1} & 0 \\\\ 0 & M^{-1} \\end{pmatrix} \\quad (\\text{对于参数顺序 } (A,F,B,G))\n$$\n对于原始顺序 $(A,B,F,G)$，逆矩阵是：\n$$\n(\\mathbf{H}^T \\mathbf{H})^{-1} = \\begin{pmatrix} S_{XX} & S_{XY} \\\\ S_{XY} & S_{YY} \\end{pmatrix}^{-1} \\otimes \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n我们计算 $2 \\times 2$ 矩阵 $M$ 的逆：\n$$\nM^{-1} = \\frac{1}{S_{XX}S_{YY} - S_{XY}^2} \\begin{pmatrix} S_{YY} & -S_{XY} \\\\ -S_{XY} & S_{XX} \\end{pmatrix}\n$$\n将这个结果代回，得到完整的 $4 \\times 4$ 协方差矩阵 $C_{\\mathbf{c}} = \\sigma^2 (\\mathbf{H}^T \\mathbf{H})^{-1}$：\n$$\nC_{\\mathbf{c}} = \\frac{\\sigma^2}{S_{XX}S_{YY}-S_{XY}^2} \\begin{pmatrix} S_{YY} & 0 & -S_{XY} & 0 \\\\ 0 & S_{YY} & 0 & -S_{XY} \\\\ -S_{XY} & 0 & S_{XX} & 0 \\\\ 0 & -S_{XY} & 0 & S_{XX} \\end{pmatrix}\n$$\n这就是最终的协方差矩阵。", "answer": "$$\\boxed{\n\\sigma^2\n\\begin{pmatrix}\n\\frac{S_{YY}}{S_{XX}S_{YY}-S_{XY}^2}&0&-\\frac{S_{XY}}{S_{XX}S_{YY}-S_{XY}^2}&0\\\\\n0&\\frac{S_{YY}}{S_{XX}S_{YY}-S_{XY}^2}&0&-\\frac{S_{XY}}{S_{XX}S_{YY}-S_{XY}^2}\\\\\n-\\frac{S_{XY}}{S_{XX}S_{YY}-S_{XY}^2}&0&\\frac{S_{XX}}{S_{XX}S_{YY}-S_{XY}^2}&0\\\\\n0&-\\frac{S_{XY}}{S_{XX}S_{YY}-S_{XY}^2}&0&\\frac{S_{XX}}{S_{XX}S_{YY}-S_{XY}^2}\n\\end{pmatrix}\n}$$", "id": "236830"}]}