{"hands_on_practices": [{"introduction": "不透明度是决定恒星大气中辐射如何传输的关键参数。本练习将指导你为一个简化的氢原子气体计算普朗克平均不透明度 $\\kappa_P$，这个过程清晰地展示了如何从频率相关的微观吸收系数 $\\kappa_\\nu$ 出发，通过对黑体辐射谱的加权平均，得到在恒星模型中使用的宏观物理量。[@problem_id:257286]", "problem": "在恒星内部与大气的研究中，一个关键的物理量是不透明度，它衡量恒星物质对辐射流的阻碍程度。为简化恒星结构模型，通常使用按频率平均的不透明度。普朗克平均不透明度 $\\kappa_P$ 是频率相关的质量吸收系数 $\\kappa_\\nu$ 由普朗克黑体谱 $B_\\nu(T)$ 加权平均得到的结果。其定义为：\n$$\n\\kappa_P = \\frac{\\int_0^\\infty \\kappa_\\nu B_\\nu(T) d\\nu}{\\int_0^\\infty B_\\nu(T) d\\nu}\n$$\n其中 $B_\\nu(T)$ 是温度为 $T$ 的黑体的普朗克函数：\n$$\nB_\\nu(T) = \\frac{2 h \\nu^3}{c^2} \\frac{1}{e^{h\\nu/(k_B T)} - 1}\n$$\n这里，$h$ 是普朗克常数，$k_B$ 是玻尔兹曼常数，$c$ 是光速。\n\n考虑一个恒星大气中气体的简化模型。假设不透明度完全由类氢粒子的某一特定能级的束缚-自由吸收（光致电离）主导。该过程有一个电离阈能，对应于频率 $\\nu_n$。对于低于此阈值的光子频率 $\\nu$，没有吸收发生。对于等于或高于该阈值的频率，质量吸收系数可以由Kramers定律很好地近似，其函数形式如下：\n$$\n\\kappa_\\nu = \\begin{cases} 0 & \\text{for } \\nu < \\nu_n \\\\ \\kappa_n \\left(\\frac{\\nu_n}{\\nu}\\right)^3 & \\text{for } \\nu \\geq \\nu_n \\end{cases}\n$$\n其中 $\\kappa_n$ 是一个常数，表示在电离边频 $\\nu_n$ 处的不透明度。\n\n基于此模型，推导普朗克平均不透明度 $\\kappa_P$ 的闭合形式表达式。你的最终答案需要用常数 $\\kappa_n$ 和无量纲参数 $x_n = \\frac{h \\nu_n}{k_B T}$ 来表示，该参数比较了电离能与气体的特征热能。你的最终表达式中也可能包含基本数学常数。", "solution": "我们从普朗克平均不透明度 $\\kappa_P$ 的定义出发：\n$$\n\\kappa_P = \\frac{\\int_0^\\infty \\kappa_\\nu B_\\nu(T) d\\nu}{\\int_0^\\infty B_\\nu(T) d\\nu}\n$$\n其中普朗克函数为：\n$$\nB_\\nu(T) = \\frac{2h\\nu^3}{c^2} \\frac{1}{e^{h\\nu/(k_BT)} - 1}\n$$\n在本模型中，频率相关的质量吸收系数 $\\kappa_\\nu$ 为：\n$$\n\\kappa_\\nu = \\begin{cases} 0 & \\nu < \\nu_n \\\\ \\kappa_n \\left(\\frac{\\nu_n}{\\nu}\\right)^3 & \\nu \\ge \\nu_n \\end{cases}\n$$\n首先计算积分的分子 $N$：\n$$\nN = \\int_0^\\infty \\kappa_\\nu B_\\nu(T) d\\nu = \\int_{\\nu_n}^\\infty \\kappa_n \\left(\\frac{\\nu_n}{\\nu}\\right)^3 \\frac{2h\\nu^3}{c^2} \\frac{1}{e^{h\\nu/(k_BT)} - 1} d\\nu\n$$\n$$\nN = \\kappa_n \\frac{2h\\nu_n^3}{c^2} \\int_{\\nu_n}^\\infty \\frac{d\\nu}{e^{h\\nu/(k_BT)} - 1}\n$$\n令 $x = h\\nu/(k_BT)$，则 $d\\nu = (k_BT/h) dx$。积分下限变为 $x_n = h\\nu_n/(k_BT)$。\n$$\nN = \\kappa_n \\frac{2h\\nu_n^3}{c^2} \\frac{k_BT}{h} \\int_{x_n}^\\infty \\frac{dx}{e^x - 1} = \\kappa_n \\frac{2(k_BT)^4 x_n^3}{h^3c^2} \\int_{x_n}^\\infty \\frac{dx}{e^x - 1}\n$$\n该积分的结果是：\n$$\n\\int_{x_n}^\\infty \\frac{dx}{e^x - 1} = \\int_{x_n}^\\infty \\frac{e^{-x}dx}{1 - e^{-x}} = \\left[ \\ln(1 - e^{-x}) \\right]_{x_n}^\\infty = 0 - \\ln(1 - e^{-x_n}) = -\\ln(1 - e^{-x_n})\n$$\n因此，分子为：\n$$\nN = \\kappa_n \\frac{2k^4T^4 x_n^3}{h^3c^2} \\left[ -\\ln(1 - e^{-x_n}) \\right]\n$$\n接下来计算分母 $D$，即对整个普朗克谱的积分：\n$$\nD = \\int_0^\\infty B_\\nu(T) d\\nu = \\frac{2h}{c^2} \\int_0^\\infty \\frac{\\nu^3 d\\nu}{e^{h\\nu/(k_BT)} - 1}\n$$\n使用同样的变量代换：\n$$\nD = \\frac{2h}{c^2} \\left(\\frac{k_BT}{h}\\right)^4 \\int_0^\\infty \\frac{x^3 dx}{e^x - 1} = \\frac{2k^4T^4}{h^3c^2} \\int_0^\\infty \\frac{x^3 dx}{e^x - 1}\n$$\n后面的积分是一个标准积分，值为 $\\pi^4/15$。\n$$\nD = \\frac{2k^4T^4}{h^3c^2} \\frac{\\pi^4}{15}\n$$\n最后，将分子除以分母得到 $\\kappa_P$：\n$$\n\\kappa_P = \\frac{N}{D} = \\frac{\\kappa_n \\frac{2k^4T^4 x_n^3}{h^3c^2} \\left[ -\\ln(1 - e^{-x_n}) \\right]}{\\frac{2k^4T^4}{h^3c^2} \\frac{\\pi^4}{15}} = \\kappa_n \\frac{15 x_n^3}{\\pi^4} \\left[ -\\ln(1 - e^{-x_n}) \\right]\n$$", "answer": "$$\\boxed{\\frac{15\\kappa_n x_n^3}{\\pi^4}\\left[-\\ln\\left(1-e^{-x_n}\\right)\\right]}$$", "id": "257286"}, {"introduction": "我们观测到的恒星光谱直接反映了其大气的温度结构。本练习将让你应用辐射转移方程的正式解，来计算一个具有温度极小值的大气所发出的辐射强度 $I(0, \\mu)$。[@problem_id:257500] 通过这个计算，你将直观地理解代表温度结构的源函数 $S(\\tau)$ 如何塑造出射光谱，并能解释如临边昏暗和谱线中心发射等重要观测特征。", "problem": "在恒星大气的研究中，出射辐射场由气体的温度结构决定。一个恒星的简化模型——其光球层上覆盖着色球层——可以通过为源函数 $S(\\tau)$ 假设一个特定形式来构建，其中 $\\tau$ 是垂直光学深度。\n\n考虑一个处于局地热动平衡 (LTE) 状态的平行平面灰体大气，其中源函数 $S(\\tau)$ 等同于普朗克函数 $B(T(\\tau))$。与法线成 $\\theta$ 角（其中 $\\mu = \\cos\\theta$）的出射比强度 $I(0, \\mu)$ 由辐射转移方程的形式解给出：\n$$\nI(0, \\mu) = \\int_0^\\infty S(\\tau) e^{-\\tau/\\mu} \\frac{d\\tau}{\\mu}\n$$\n\n假设源函数由一个不连续的分段线性函数建模，该函数代表在光学深度 $\\tau_0$ 处存在一个温度极小值。\n对于较深的光球层 ($\\tau > \\tau_0$)，源函数随光学深度线性增加：\n$$\nS(\\tau) = S_0 (1 + \\beta \\tau) \\quad \\text{for} \\quad \\tau > \\tau_0\n$$\n对于上层色球层 ($0 \\le \\tau \\le \\tau_0$)，源函数随光学深度线性减小，反映了朝向表面方向的温度升高：\n$$\nS(\\tau) = S_c - \\alpha \\tau \\quad \\text{for} \\quad 0 \\le \\tau \\le \\tau_0\n$$\n在此，$S_0$、$S_c$、$\\beta$ 和 $\\alpha$ 是正常数。注意 $S(\\tau)$ 在 $\\tau = \\tau_0$ 处是不连续的。\n\n推导作为 $\\mu$、$\\tau_0$ 以及定义源函数的常数的函数，出射比强度 $I(0, \\mu)$ 的闭合形式解析表达式。", "solution": "该问题要求解在给定分段源函数 $S(\\tau)$ 的情况下，从平行平面灰体大气中出射的比强度 $I(0, \\mu)$。出发点是辐射转移方程的形式解：\n$$\nI(0, \\mu) = \\frac{1}{\\mu} \\int_0^\\infty S(\\tau) e^{-\\tau/\\mu} d\\tau\n$$\n根据 $S(\\tau)$ 的分段定义，我们必须在不连续点 $\\tau = \\tau_0$ 处将积分拆分。\n$$\nI(0, \\mu) = \\frac{1}{\\mu} \\left[ \\int_0^{\\tau_0} S(\\tau) e^{-\\tau/\\mu} d\\tau + \\int_{\\tau_0}^\\infty S(\\tau) e^{-\\tau/\\mu} d\\tau \\right]\n$$\n现在，我们将 $S(\\tau)$ 的相应表达式代入每个积分中。\n\n我们先计算第一个积分 $I_1$，它对应于色球层 ($0 \\le \\tau \\le \\tau_0$)：\n$$\nI_1 = \\frac{1}{\\mu} \\int_0^{\\tau_0} (S_c - \\alpha \\tau) e^{-\\tau/\\mu} d\\tau\n$$\n这个积分可以使用分部积分法求解，即 $\\int u \\, dv = uv - \\int v \\, du$。令 $u = S_c - \\alpha \\tau$ 且 $dv = e^{-\\tau/\\mu} d\\tau$。则 $du = -\\alpha \\, d\\tau$ 且 $v = -\\mu e^{-\\tau/\\mu}$。\n$$\n\\int (S_c - \\alpha \\tau) e^{-\\tau/\\mu} d\\tau = (S_c - \\alpha \\tau)(-\\mu e^{-\\tau/\\mu}) - \\int (-\\mu e^{-\\tau/\\mu})(-\\alpha \\, d\\tau)\n$$\n$$\n= -\\mu(S_c - \\alpha \\tau)e^{-\\tau/\\mu} - \\alpha\\mu \\int e^{-\\tau/\\mu} d\\tau\n$$\n$$\n= -\\mu(S_c - \\alpha \\tau)e^{-\\tau/\\mu} - \\alpha\\mu (-\\mu e^{-\\tau/\\mu})\n$$\n$$\n= -\\mu(S_c - \\alpha \\tau)e^{-\\tau/\\mu} + \\alpha\\mu^2 e^{-\\tau/\\mu}\n$$\n现在我们计算这个从 $0$ 到 $\\tau_0$ 的定积分：\n$$\n\\int_0^{\\tau_0} (S_c - \\alpha \\tau) e^{-\\tau/\\mu} d\\tau = \\left[-\\mu(S_c - \\alpha \\tau)e^{-\\tau/\\mu} + \\alpha\\mu^2 e^{-\\tau/\\mu}\\right]_0^{\\tau_0}\n$$\n$$\n= \\left(-\\mu(S_c - \\alpha \\tau_0)e^{-\\tau_0/\\mu} + \\alpha\\mu^2 e^{-\\tau_0/\\mu}\\right) - \\left(-\\mu(S_c - 0)e^{0} + \\alpha\\mu^2 e^{0}\\right)\n$$\n$$\n= -\\mu S_c e^{-\\tau_0/\\mu} + \\alpha\\mu\\tau_0 e^{-\\tau_0/\\mu} + \\alpha\\mu^2 e^{-\\tau_0/\\mu} + \\mu S_c - \\alpha\\mu^2\n$$\n除以前置因子 $1/\\mu$，我们得到第一个积分的贡献：\n$$\nI_1 = -S_c e^{-\\tau_0/\\mu} + \\alpha\\tau_0 e^{-\\tau_0/\\mu} + \\alpha\\mu e^{-\\tau_0/\\mu} + S_c - \\alpha\\mu\n$$\n$$\nI_1 = S_c(1 - e^{-\\tau_0/\\mu}) - \\alpha\\mu(1 - e^{-\\tau_0/\\mu}) + \\alpha\\tau_0 e^{-\\tau_0/\\mu}\n$$\n\n接下来，我们计算第二个积分 $I_2$，它对应于光球层 ($\\tau > \\tau_0$)：\n$$\nI_2 = \\frac{1}{\\mu} \\int_{\\tau_0}^\\infty S_0(1+\\beta\\tau) e^{-\\tau/\\mu} d\\tau\n$$\n我们再次使用分部积分法。令 $u = S_0(1+\\beta\\tau)$ 且 $dv = e^{-\\tau/\\mu} d\\tau$。则 $du = S_0\\beta \\, d\\tau$ 且 $v = -\\mu e^{-\\tau/\\mu}$。\n$$\n\\int S_0(1+\\beta\\tau) e^{-\\tau/\\mu} d\\tau = S_0(1+\\beta\\tau)(-\\mu e^{-\\tau/\\mu}) - \\int (-\\mu e^{-\\tau/\\mu})(S_0\\beta \\, d\\tau)\n$$\n$$\n= -\\mu S_0(1+\\beta\\tau)e^{-\\tau/\\mu} + S_0\\beta\\mu \\int e^{-\\tau/\\mu} d\\tau\n$$\n$$\n= -\\mu S_0(1+\\beta\\tau)e^{-\\tau/\\mu} + S_0\\beta\\mu (-\\mu e^{-\\tau/\\mu})\n$$\n$$\n= -\\mu S_0(1+\\beta\\tau)e^{-\\tau/\\mu} - S_0\\beta\\mu^2 e^{-\\tau/\\mu}\n$$\n现在我们计算这个从 $\\tau_0$ 到 $\\infty$ 的定积分：\n$$\n\\int_{\\tau_0}^\\infty S_0(1+\\beta\\tau) e^{-\\tau/\\mu} d\\tau = \\left[-\\mu S_0(1+\\beta\\tau)e^{-\\tau/\\mu} - S_0\\beta\\mu^2 e^{-\\tau/\\mu}\\right]_{\\tau_0}^\\infty\n$$\n当 $\\tau \\to \\infty$ 时，项 $e^{-\\tau/\\mu} \\to 0$。因此在积分上限处的值为零。\n$$\n= 0 - \\left(-\\mu S_0(1+\\beta\\tau_0)e^{-\\tau_0/\\mu} - S_0\\beta\\mu^2 e^{-\\tau_0/\\mu}\\right)\n$$\n$$\n= \\mu S_0(1+\\beta\\tau_0)e^{-\\tau_0/\\mu} + S_0\\beta\\mu^2 e^{-\\tau_0/\\mu}\n$$\n除以前置因子 $1/\\mu$，我们得到第二个积分的贡献：\n$$\nI_2 = S_0(1+\\beta\\tau_0)e^{-\\tau_0/\\mu} + S_0\\beta\\mu e^{-\\tau_0/\\mu} = S_0(1+\\beta\\tau_0+\\beta\\mu)e^{-\\tau_0/\\mu}\n$$\n\n总的出射强度是两个贡献之和，$I(0, \\mu) = I_1 + I_2$：\n$$\nI(0, \\mu) = \\left( S_c(1 - e^{-\\tau_0/\\mu}) - \\alpha\\mu(1 - e^{-\\tau_0/\\mu}) + \\alpha\\tau_0 e^{-\\tau_0/\\mu} \\right) + \\left( S_0(1+\\beta\\tau_0+\\beta\\mu)e^{-\\tau_0/\\mu} \\right)\n$$\n我们可以将含有和不含 $e^{-\\tau_0/\\mu}$ 的项合并：\n$$\nI(0, \\mu) = (S_c - \\alpha\\mu) + \\left( -S_c + \\alpha\\mu + \\alpha\\tau_0 + S_0(1+\\beta\\tau_0) + S_0\\beta\\mu \\right) e^{-\\tau_0/\\mu}\n$$\n最后，我们可以将括号内的项按 $\\mu$ 的幂次分组：\n$$\nI(0, \\mu) = S_c - \\alpha\\mu + \\left[ S_0(1+\\beta\\tau_0) - S_c + \\alpha\\tau_0 + (S_0\\beta + \\alpha)\\mu \\right] e^{-\\tau_0/\\mu}\n$$\n这就是出射比强度的最终闭合形式表达式。", "answer": "$$\n\\boxed{S_c - \\alpha\\mu + \\left[ S_0(1+\\beta\\tau_0) - S_c + \\alpha\\tau_0 + (S_0\\beta + \\alpha)\\mu \\right] e^{-\\tau_0/\\mu}}\n$$", "id": "257500"}, {"introduction": "谱线的形状蕴含着关于恒星自转、温度分布等丰富信息。本练习将引导你分析一个旋转恒星的吸收线轮廓是如何形成的，它综合了恒星的固體自转、临边昏暗效应以及谱线自身的加宽机制。[@problem_id:257426] 这是一个典型的正向建模问题，通过计算观测谱线的总方差，你将掌握从基本物理原理出发，合成可观测量的关键方法。", "problem": "观测到一颗球形、自转的恒星。其自转使其积分通量光谱中的谱线变宽。目标是描述自转致宽的吸收谱线的形状。\n\n假设如下：\n1.  恒星作刚体自转。在恒星边缘观测到的、由自转引起的最大视线速度为 $v_{eq}$。\n2.  从恒星表面出射的连续谱辐射的比强度 $I(\\mu)$ 遵循线性临边昏暗定律：\n    $$I(\\mu) = I_c(1 - u + u\\mu)$$\n    其中 $I_c$ 是星盘中心的强度，$u$ 是线性临边昏暗系数（$0 \\le u \\le 1$），$\\mu$ 是视线与表面法线之间夹角的余弦。对于投影星盘上距离中心 $r$ 处的一点，$\\mu = \\sqrt{1 - (r/R)^2}$，其中 $R$ 是恒星半径。\n3.  恒星光谱中存在一条弱吸收线。在恒星表面的任何一点，这条谱线具有一个本征吸收轮廓，该轮廓是相对于谱线中心的速度偏移 $v'$ 的三角形函数：\n    $$D(v') = \\begin{cases} d_0 \\left(1 - \\frac{|v'|}{w}\\right), & \\text{if } |v'| \\le w \\\\ 0, & \\text{if } |v'| > w \\end{cases}$$\n    这里，$d_0$ 是中心深度，$w$ 是三角形底边的一半宽度。在给定点的剩余强度为 $I_\\nu = I(\\mu)(1 - D(v'))$。\n4.  观测到的、星盘积分的谱线轮廓是本征轮廓与自转致宽函数 $G(v)$ 的卷积。两个函数卷积的方差是它们各自方差的总和。\n\n推导星盘积分吸收谱线轮廓的总方差 $\\sigma^2$ 的表达式。用参数 $w$、$v_{eq}$ 和 $u$ 表示你的答案。轮廓 $P(v)$ 的方差定义为 $\\sigma^2 = \\frac{\\int_{-\\infty}^{\\infty} (v - \\bar{v})^2 P(v) dv}{\\int_{-\\infty}^{\\infty} P(v) dv}$，其中 $\\bar{v}$ 是平均速度。", "solution": "1. **卷积的方差**：\n观测到的谱线轮廓是本征轮廓和自转致宽函数的卷积，因此总方差是两个方差之和：\n   $$\\sigma^2 = \\sigma_{\\text{int}}^2 + \\sigma_{\\text{rot}}^2$$\n2. **本征轮廓的方差** ($\\sigma_{\\text{int}}^2$)：\n   本征轮廓是一个在 $[-w, w]$ 上的三角形函数。归一化到单位面积后，其形式为：\n   $$f(v) = \\frac{1}{w} \\left(1 - \\frac{|v|}{w}\\right), \\quad |v| \\le w$$\n   由于该函数是偶函数，其平均值为零。方差计算如下：\n   $$\\sigma_{\\text{int}}^2 = \\int_{-w}^w v^2 f(v) dv = 2 \\int_0^w v^2 \\frac{1}{w} \\left(1 - \\frac{v}{w}\\right) dv = \\frac{2}{w} \\left[ \\frac{v^3}{3} - \\frac{v^4}{4w} \\right]_0^w = \\frac{2}{w} \\left( \\frac{w^3}{3} - \\frac{w^4}{4w} \\right) = \\frac{w^2}{6}$$\n3. **自转致宽的方差** ($\\sigma_{\\text{rot}}^2$)：\n   具有线性临边昏暗 $u$ 的自转致宽核 $G(v)$ 的支撑集为 $[-v_{eq}, v_{eq}]$。在无量纲速度 $x = v/v_{eq}$ 下，致宽核 $g(x)$ 正比于：\n   $$g(x) \\propto 2(1-u)\\sqrt{1-x^2} + \\frac{\\pi u}{2}(1-x^2), \\quad |x| \\le 1$$\n   该函数也是偶函数，平均值为零。其方差为 $\\sigma_{\\text{rot}}^2 = v_{eq}^2 \\int_{-1}^1 x^2 g(x) dx / \\int_{-1}^1 g(x) dx$。\n   根据标准积分结果，我们有：\n   $$ \\sigma_{\\text{rot}}^2 = v_{eq}^2 \\frac{2(1-u)\\int_{-1}^1 x^2\\sqrt{1-x^2}dx + \\frac{\\pi u}{2}\\int_{-1}^1 x^2(1-x^2)dx}{2(1-u)\\int_{-1}^1 \\sqrt{1-x^2}dx + \\frac{\\pi u}{2}\\int_{-1}^1 (1-x^2)dx} = v_{eq}^2 \\frac{2(1-u)\\frac{\\pi}{8} + \\frac{\\pi u}{2}\\frac{4}{15}}{2(1-u)\\frac{\\pi}{2} + \\frac{\\pi u}{2}\\frac{4}{3}} $$\n   $$ \\sigma_{\\text{rot}}^2 = v_{eq}^2 \\frac{\\frac{\\pi(1-u)}{4} + \\frac{2\\pi u}{15}}{\\pi(1-u) + \\frac{2\\pi u}{3}} = v_{eq}^2 \\frac{\\frac{15\\pi(1-u) + 8\\pi u}{60}}{\\frac{3\\pi(1-u) + 2\\pi u}{3}} = v_{eq}^2 \\frac{\\pi(15-7u)/60}{\\pi(3-u)/3} = v_{eq}^2 \\frac{15-7u}{20(3-u)} $$\n4. **总方差**：\n   将两部分方差相加：\n   $$\\sigma^2 = \\frac{w^2}{6} + v_{eq}^2 \\frac{15-7u}{20(3-u)}$$", "answer": "$$\\boxed{\\frac{w^2}{6}+\\frac{v_{eq}^2(15-7u)}{20(3-u)}}$$", "id": "257426"}]}