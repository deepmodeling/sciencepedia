{"hands_on_practices": [{"introduction": "恒星光谱中的谱线轮廓不仅包含了原子本身的信息，还揭示了恒星大尺度运动的秘密。通过一个简化的双半球模型，这项练习将引导你推导谱线因多普勒效应而分裂的临界条件。这个实践将帮助你理解如何从观测到的谱线形状中解读恒星自转或对流等宏观动力学现象 [@problem_id:210086]。", "problem": "考虑一个简化的恒星模型，其表面速度场由两个稳定的大型对流单体主导，这两个对流单体可以被建模为两个半球。一个半球以大小为 $v_0$ 的视向速度朝向一个遥远的观测者运动，而另一个半球以同样的速度 $v_0$ 远离观测者。恒星的质心保持静止。假设恒星表面亮度均匀，且两个半球对总观测通量的贡献相等。\n\n在恒星气体的静止参考系中，一次原子跃迁产生了一条吸收线。这条谱线的深度作为频率 $\\nu$ 的函数，由一个高斯轮廓描述：\n$$\nD_{int}(\\nu) = D_0 \\exp\\left(-\\frac{(\\nu - \\nu_0)^2}{2\\sigma_\\nu^2}\\right)\n$$\n在这里，$\\nu_0$ 是静止参考系中跃迁的中心频率，$\\sigma_\\nu$ 是量化谱线内禀宽度（由热运动和微湍流运动引起）的标准差，而 $D_0$ 是谱线中心的深度。\n\n观测到的来自恒星的复合谱线轮廓是来自两个半球的多普勒频移轮廓之和。对于一个以视向速度 $v_{los}$ 运动的源，观测频率 $\\nu_{obs}$ 和发射频率 $\\nu_{em}$ 之间的关系由非相对论性多普勒公式给出：$\\nu_{obs} = \\nu_{em}(1 - v_{los}/c)$，其中 $c$ 是光速，当源远离观测者时 $v_{los}$ 为正。\n\n复合谱线轮廓的形状取决于多普勒引起的频移与内禀谱线宽度之比。当 $v_0$ 较小时，轮廓是单峰的（在吸收深度上有一个单一的中心极大值）。当 $v_0$ 较大时，轮廓变成双峰的（在吸收深度上有两个极大值，并在 $\\nu = \\nu_0$ 处有一个局部极小值）。\n\n推导无量纲比率 $\\mathcal{R} = \\frac{\\nu_0 v_0 / c}{\\sigma_\\nu}$ 的临界值，该值标志着这两种状态之间的转变。这个转变点由一个条件定义：总谱线深度轮廓对频率的二阶导数在中心频率 $\\nu_0$ 处的值为零。", "solution": "问题要求解复合谱线轮廓从单峰转变为双峰时的比率 $\\mathcal{R} = (\\nu_0 v_0 / c) / \\sigma_\\nu$ 的临界值。这个转变发生在轮廓中心的二阶导数为零时。\n\n首先，让我们确定来自两个半球的多普勒频移轮廓的中心频率。由多普勒效应引起的频移大小为 $\\Delta\\nu_D = \\nu_0 (v_0/c)$。\n\n1.  对于远离观测者的半球，视向速度为 $v_{los} = +v_0$。以 $\\nu_0$ 为中心的内禀谱线轮廓被移动到一个新的中心频率 $\\nu_{-}$：\n    $$\n    \\nu_{-} = \\nu_0 (1 - v_0/c) = \\nu_0 - \\Delta\\nu_D\n    $$\n\n2.  对于接近观测者的半球，视向速度为 $v_{los} = -v_0$。谱线被移动到一个新的中心频率 $\\nu_{+}$：\n    $$\n    \\nu_{+} = \\nu_0 (1 - (-v_0)/c) = \\nu_0 + \\Delta\\nu_D\n    $$\n\n复合谱线深度轮廓 $D_{comp}(\\nu)$ 是来自两个半球的轮廓之和，因为它们的贡献相等：\n$$\nD_{comp}(\\nu) = D_{int}(\\nu; \\text{shifted to } \\nu_{+}) + D_{int}(\\nu; \\text{shifted to } \\nu_{-})\n$$\n代入高斯形式和频移后的中心：\n$$\nD_{comp}(\\nu) = D_0 \\left[ \\exp\\left(-\\frac{(\\nu - \\nu_{+})^2}{2\\sigma_\\nu^2}\\right) + \\exp\\left(-\\frac{(\\nu - \\nu_{-})^2}{2\\sigma_\\nu^2}\\right) \\right]\n$$\n$$\nD_{comp}(\\nu) = D_0 \\left[ \\exp\\left(-\\frac{(\\nu - (\\nu_0 + \\Delta\\nu_D))^2}{2\\sigma_\\nu^2}\\right) + \\exp\\left(-\\frac{(\\nu - (\\nu_0 - \\Delta\\nu_D))^2}{2\\sigma_\\nu^2}\\right) \\right]\n$$\n复合轮廓的中心在 $\\nu = \\nu_0$ 处。我们需要通过计算二阶导数 $\\frac{d^2D_{comp}}{d\\nu^2}$ 并在 $\\nu=\\nu_0$ 处求值来分析该点的曲率。\n\n让我们求 $D_{comp}(\\nu)$ 对 $\\nu$ 的一阶导数：\n$$\n\\frac{dD_{comp}}{d\\nu} = D_0 \\left[ -\\frac{\\nu - (\\nu_0 + \\Delta\\nu_D)}{\\sigma_\\nu^2} \\exp\\left(-\\dots\\right) - \\frac{\\nu - (\\nu_0 - \\Delta\\nu_D)}{\\sigma_\\nu^2} \\exp\\left(-\\dots\\right) \\right]\n$$\n现在，我们使用乘法法则 $\\frac{d}{dx}(f(x)e^{g(x)}) = (f'e^g + f g'e^g)$ 来求二阶导数：\n$$\n\\frac{d^2D_{comp}}{d\\nu^2} = D_0 \\left[ \\left( -\\frac{1}{\\sigma_\\nu^2} + \\frac{(\\nu - (\\nu_0 + \\Delta\\nu_D))^2}{\\sigma_\\nu^4} \\right) \\exp\\left(-\\frac{(\\nu - (\\nu_0 + \\Delta\\nu_D))^2}{2\\sigma_\\nu^2}\\right) \\right.\n$$\n$$\n\\left. + \\left( -\\frac{1}{\\sigma_\\nu^2} + \\frac{(\\nu - (\\nu_0 - \\Delta\\nu_D))^2}{\\sigma_\\nu^4} \\right) \\exp\\left(-\\frac{(\\nu - (\\nu_0 - \\Delta\\nu_D))^2}{2\\sigma_\\nu^2}\\right) \\right]\n$$\n现在，我们在谱线中心 $\\nu = \\nu_0$ 处对此表达式求值：\n$$\n\\left. \\frac{d^2D_{comp}}{d\\nu^2} \\right|_{\\nu=\\nu_0} = D_0 \\left[ \\left( -\\frac{1}{\\sigma_\\nu^2} + \\frac{(-\\Delta\\nu_D)^2}{\\sigma_\\nu^4} \\right) \\exp\\left(-\\frac{(-\\Delta\\nu_D)^2}{2\\sigma_\\nu^2}\\right) \\right.\n$$\n$$\n\\left. + \\left( -\\frac{1}{\\sigma_\\nu^2} + \\frac{(\\Delta\\nu_D)^2}{\\sigma_\\nu^4} \\right) \\exp\\left(-\\frac{(\\Delta\\nu_D)^2}{2\\sigma_\\nu^2}\\right) \\right]\n$$\n方括号中的两项是相同的。\n$$\n\\left. \\frac{d^2D_{comp}}{d\\nu^2} \\right|_{\\nu=\\nu_0} = 2 D_0 \\left( -\\frac{1}{\\sigma_\\nu^2} + \\frac{\\Delta\\nu_D^2}{\\sigma_\\nu^4} \\right) \\exp\\left(-\\frac{\\Delta\\nu_D^2}{2\\sigma_\\nu^2}\\right)\n$$\n将括号内的项合并，可得：\n$$\n\\left. \\frac{d^2D_{comp}}{d\\nu^2} \\right|_{\\nu=\\nu_0} = \\frac{2 D_0}{\\sigma_\\nu^4} (\\Delta\\nu_D^2 - \\sigma_\\nu^2) \\exp\\left(-\\frac{\\Delta\\nu_D^2}{2\\sigma_\\nu^2}\\right)\n$$\n从单峰（下凹，二阶导数为负）到双峰（上凹，二阶导数为正）的转变发生在二阶导数为零时。\n$$\n\\frac{2 D_0}{\\sigma_\\nu^4} (\\Delta\\nu_D^2 - \\sigma_\\nu^2) \\exp\\left(-\\frac{\\Delta\\nu_D^2}{2\\sigma_\\nu^2}\\right) = 0\n$$\n由于 $D_0 > 0$，$\\sigma_\\nu > 0$，且指数项恒为正，因此转变的条件是：\n$$\n\\Delta\\nu_D^2 - \\sigma_\\nu^2 = 0 \\quad \\implies \\quad \\Delta\\nu_D^2 = \\sigma_\\nu^2\n$$\n由于频移大小 $\\Delta\\nu_D$ 和谱线宽度 $\\sigma_\\nu$ 都是正值，我们取正根：\n$$\n\\Delta\\nu_D = \\sigma_\\nu\n$$\n问题要求解比率 $\\mathcal{R} = \\frac{\\Delta\\nu_D}{\\sigma_\\nu}$ 的临界值。代入我们的结果：\n$$\n\\mathcal{R}_{crit} = \\frac{\\sigma_\\nu}{\\sigma_\\nu} = 1\n$$\n因此，当多普勒频移的大小恰好等于内禀高斯谱线轮廓的标准差时，发生转变。", "answer": "$$\n\\boxed{1}\n$$", "id": "210086"}, {"introduction": "在真实的恒星光谱中，谱线常常会发生重叠或“混合”，这使得测量单个谱线的强度变得复杂。本练习将使用经典的 Milne-Eddington 模型，让你亲自计算当一条弱谱线形成于一条强谱线翼部时，其等值宽度会受到何种程度的抑制 [@problem_id:210202]。掌握这种谱线混合效应的定量分析，对于从复杂光谱中精确提取化学丰度等信息至关重要。", "problem": "在恒星大气的研究中，谱线的形成通常使用 Milne-Eddington (M-E) 模型来建模。在此模型中，谱线不透明度 $\\alpha_{L,\\nu}$ 与连续谱不透明度 $\\alpha_c$ 的比值被假定为随深度不变的常数，记为 $\\eta_\\nu = \\alpha_{L,\\nu} / \\alpha_c$。源函数被假定为连续谱光学深度 $\\tau_c$ 的线性函数，由 $S(\\tau_c) = S_0 (1 + \\beta \\tau_c)$ 给出。\n\n使用 Eddington-Barbier 近似，出射剩余流量 $r_\\nu = F_\\nu / F_c$（其中 $F_\\nu$ 是频率为 $\\nu$ 处的流量，$F_c$ 是连续谱流量）可以表示为：\n$$\nr_\\nu = \\frac{1 + \\frac{\\beta_0}{1+\\eta_\\nu}}{1+\\beta_0}\n$$\n其中 $\\beta_0$ 是一个与源函数梯度相关的常数。\n\n考虑一个恒星大气，其总谱线不透明度是由一条强的光学厚谱线（谱线1）和一条非常弱的谱线（谱线2）叠加而成。总不透明度比为 $\\eta_\\nu = \\eta_{1,\\nu} + \\eta_{2,\\nu}$。弱谱线（谱线2）位于频率 $\\nu_2$ 处，该频率处于强谱线的遥远谱翼中。由于强谱线（谱线1）谱翼中不透明度的快速下降，我们可以假设其不透明度比 $\\eta_{1,\\nu}$ 在弱谱线（谱线2）的窄轮廓内近似为常数，其值为 $\\eta_{1,2} \\equiv \\eta_{1,\\nu_2}$。此外，由于谱线2非常弱，其自身的不透明度比在整个谱线轮廓的所有频率 $\\nu$ 上都满足 $\\eta_{2,\\nu} \\ll 1+\\eta_{1,2}$。\n\n弱谱线的等值宽度 $W_2$ 是相对于由强谱线谱翼形成的局部连续谱来定义的。它由下式给出：\n$$\nW_2 = \\int_{-\\infty}^{\\infty} \\left( 1 - \\frac{r_{\\text{total},\\nu}}{r_{\\text{strong},\\nu_2}} \\right) d\\nu\n$$\n其中 $r_{\\text{total},\\nu}$ 是两条谱线都存在时的剩余流量 ($\\eta_\\nu = \\eta_{1,2} + \\eta_{2,\\nu}$)，而 $r_{\\text{strong},\\nu_2}$ 是在弱谱线位置上仅由强谱线产生的剩余流量 ($\\eta_\\nu = \\eta_{1,2}$)。\n\n推导抑制因子 $\\mathcal{F} = W_2 / W_2^{\\text{unp}}$ 的表达式。此处，$W_2^{\\text{unp}}$ 是假设强谱线1不存在（即 $\\eta_{1,2} = 0$）时，弱谱线2所具有的等值宽度。您得到的 $\\mathcal{F}$ 的最终表达式应仅包含 $\\eta_{1,2}$ 和 $\\beta_0$。", "solution": "我们从频率为 $\\nu$ 时的剩余流量的 Milne–Eddington 表达式开始，\n$$\nr_\\nu \\;=\\;\\frac{1 + \\dfrac{\\beta_0}{1+\\eta_\\nu}}{1+\\beta_0}\\,,\n$$\n其中 $\\eta_\\nu=\\eta_{1,\\nu}+\\eta_{2,\\nu}$。在弱谱线的频率处，定义\n$$\nA\\equiv 1+\\eta_{1,2}\\,,\\qquad B\\equiv\\beta_0\\,,\\qquad \\eta_{2,\\nu}\\ll A\\,.\n$$\n那么总剩余流量为\n$$\nr_{\\rm tot}(\\nu)\n=\\frac{1}{1+B}\\Bigl(1+\\frac{B}{A+\\eta_{2,\\nu}}\\Bigr),\n$$\n并且在 $\\nu_2$ 处仅有强谱线时的剩余流量为\n$$\nr_{\\rm str}\n=\\frac{1}{1+B}\\Bigl(1+\\frac{B}{A}\\Bigr).\n$$\n因此\n$$\n\\frac{r_{\\rm tot}(\\nu)}{r_{\\rm str}}\n=\\frac{1+\\dfrac{B}{A+\\eta_{2,\\nu}}}{1+\\dfrac{B}{A}}\n=\\frac{A\\,(A+B+\\eta_{2,\\nu})}{(A+\\eta_{2,\\nu})(A+B)}.\n$$\n对于 $\\eta_{2,\\nu}\\ll A$，对 $\\eta_{2,\\nu}$ 进行一阶展开：\n$$\n\\frac{r_{\\rm tot}}{r_{\\rm str}}\n\\approx 1 \\;-\\;\\frac{B\\,\\eta_{2,\\nu}}{A\\,(A+B)}.\n$$\n因此谱线深度为\n$$\n1-\\frac{r_{\\rm tot}}{r_{\\rm str}}\n\\approx \\frac{B\\,\\eta_{2,\\nu}}{A\\,(A+B)}.\n$$\n弱谱线的等值宽度为\n$$\nW_2\n=\\int\\Bigl(1-\\frac{r_{\\rm tot}}{r_{\\rm str}}\\Bigr)\\,d\\nu\n=\\frac{B}{A\\,(A+B)}\\int\\eta_{2,\\nu}\\,d\\nu.\n$$\n如果强谱线不存在（$\\eta_{1,2}=0$，因此 $A=1$），可以得到\n$$\nW_2^{\\rm unp}\n=\\frac{B}{1(1+B)}\\int\\eta_{2,\\nu}\\,d\\nu.\n$$\n因此抑制因子为\n$$\n\\mathcal F\n=\\frac{W_2}{W_2^{\\rm unp}}\n=\\frac{\\dfrac{B}{A\\,(A+B)}}{\\dfrac{B}{1+B}}\n=\\frac{1+B}{A\\,(A+B)}\n=\\frac{1+\\beta_0}{(1+\\eta_{1,2})(1+\\beta_0+\\eta_{1,2})}.\n$$", "answer": "$$\\boxed{\\frac{1+\\beta_0}{(1+\\eta_{1,2})(1+\\beta_0+\\eta_{1,2})}}$$", "id": "210202"}, {"introduction": "谱线形成的物理核心在于源函数，它描述了在特定谱线频率处辐射的产生过程。在恒星大气的上层，由于物质稀薄，局部热动平衡（LTE）的假设不再成立，此时必须考虑辐射场与物质的非平衡相互作用。这项练习将带你深入非局部热动平衡（non-LTE）理论的核心，通过执行第一步“Lambda 迭代”，计算源函数对 LTE 解的修正，从而揭示光子如何在上层大气中“逃逸”并最终塑造我们观测到的谱线轮廓 [@problem_id:209983]。", "problem": "恒星大气中谱线的形成可以通过辐射转移方程来建模。对于一个平行平面、半无限大气，一个二能级原子的谱线源函数 $S$ 由以下积分方程描述：\n$$\nS(\\tau) = (1-\\epsilon)J(\\tau) + \\epsilon B(\\tau)\n$$\n此处，$\\tau$ 是谱线中特定频率处的垂直光学深度，$\\epsilon$ 是每次散射中光子被毁灭（热化）的恒定概率，而 $B(\\tau)$ 是代表光子热源的普朗克函数。项 $J(\\tau)$ 是平均强度，由 Lambda 算子 $\\Lambda_\\tau$ 作用于源函数给出：\n$$\nJ(\\tau) = \\Lambda_\\tau[S(t)] = \\frac{1}{2} \\int_0^\\infty S(t) E_1(|\\tau - t|) dt\n$$\n其中 $E_1(x)$ 是第一指数积分函数。\n\n这个关于 $S(\\tau)$ 的积分方程可以使用 Lambda 迭代法进行迭代求解。零阶近似 $S^{(0)}(\\tau)$ 取为局域热动平衡 (LTE) 解，此时源函数等于普朗克函数。后续的迭代由下式生成：\n$$\nS^{(n+1)}(\\tau) = (1-\\epsilon)\\Lambda_\\tau[S^{(n)}(t)] + \\epsilon B(\\tau)\n$$\n\n假设在整个谱线形成区域，普朗克函数随光学深度线性变化：\n$$\nB(\\tau) = B_0 + B_1 \\tau\n$$\n其中 $B_0$ 和 $B_1$ 是正常数。因此，零阶 LTE 近似为 $S^{(0)}(\\tau) = B_0 + B_1 \\tau$。\n\n推导源函数的一阶修正 $\\Delta S^{(1)}(\\tau) = S^{(1)}(\\tau) - S^{(0)}(\\tau)$ 在大气表面 ($\\tau = 0$) 处的表达式。\n\n你可以使用以下涉及指数积分函数 $E_n(x)$ 的定积分恒等式：\n$$\n\\int_0^\\infty E_n(x) dx = \\frac{1}{n} \\quad \\text{for } n \\ge 1\n$$\n$$\n\\int_0^\\infty x^m E_n(x) dx = \\frac{m!}{m+n} \\quad \\text{for } m \\ge 0, n \\ge 1\n$$", "solution": "1. 表面处的一阶源函数为\n$$S^{(1)}(0)=(1-\\epsilon)J^{(0)}(0)+\\epsilon B(0)\\,, $$  \n其中  \n$$J^{(0)}(0)=\\tfrac12\\int_0^\\infty S^{(0)}(t)E_1(t)\\,dt\\,,\\quad S^{(0)}(t)=B_0+B_1t\\,,\\;B(0)=B_0.$$\n\n2. 使用以下公式计算积分：\n$$\\int_0^\\infty E_1(x)\\,dx=1,\\quad \\int_0^\\infty xE_1(x)\\,dx=\\tfrac12.$$  \n因此  \n$$\\int_0^\\infty S^{(0)}(t)E_1(t)\\,dt\n=B_0\\!\\int_0^\\infty E_1(t)\\,dt+B_1\\!\\int_0^\\infty tE_1(t)\\,dt\n=B_0+\\tfrac{B_1}{2}$$  \n且  \n$$J^{(0)}(0)=\\tfrac12\\Bigl(B_0+\\tfrac{B_1}{2}\\Bigr)\n=\\tfrac{B_0}{2}+\\tfrac{B_1}{4}.$$\n\n3. 因此\n$$S^{(1)}(0)\n=(1-\\epsilon)\\Bigl(\\tfrac{B_0}{2}+\\tfrac{B_1}{4}\\Bigr)+\\epsilon B_0\n=\\tfrac{1+\\epsilon}{2}B_0+\\tfrac{1-\\epsilon}{4}B_1.$$\n\n4. 零阶表面值为 $S^{(0)}(0)=B_0$，所以一阶修正为  \n$$\\Delta S^{(1)}(0)=S^{(1)}(0)-S^{(0)}(0)\n=\\Bigl(\\tfrac{1+\\epsilon}{2}-1\\Bigr)B_0+\\tfrac{1-\\epsilon}{4}B_1\n=\\tfrac{\\epsilon-1}{2}B_0+\\tfrac{1-\\epsilon}{4}B_1\n=(1-\\epsilon)\\Bigl(\\tfrac{B_1}{4}-\\tfrac{B_0}{2}\\Bigr).$$\n  \n5. 化简为  \n$$\\Delta S^{(1)}(0)=\\frac{(1-\\epsilon)(B_1-2B_0)}{4}\\,.$$", "answer": "$$\\boxed{\\frac{(1-\\epsilon)(B_1-2B_0)}{4}}$$", "id": "209983"}]}