{"hands_on_practices": [{"introduction": "在分析任何天文数据之前，必须先收集数据。观测规划的一个关键方面是设计能够最大化科学回报的策略，这通常意味着最小化最终的测量不确定性。本练习深入探讨了观测误差分析的核心，重点关注如何在有限的总望远镜时间内，在不同滤光片之间优化分配曝光时间，以实现最精确的颜色测量。通过解决这个问题，你将具体理解来自恒星和天光背景的光子噪声如何决定观测的极限，以及如何运用数学优化方法来设计高效的观测方案。[@problem_id:227062]", "problem": "一位天文学家正计划进行观测，以测量一颗暗星的颜色。颜色由 $B-V$ 色指数来量化，该指数是恒星在B（蓝）和V（视）滤光片中的视星等之差：$B-V = m_B - m_V$。在任何滤光片中，视星等 $m$ 都与测得的恒星流量 $F$ 通过关系式 $m = -2.5 \\log_{10}(F) + \\text{constant}$ 相关。\n\n对于暗弱天体，星等测量的精度受光子统计（散粒噪声）的限制。星等测量的误差 $\\sigma_m$ 与光度测量的信噪比 (SNR) 的关系如下：\n$$\n\\sigma_m \\approx \\frac{2.5}{\\ln 10} \\frac{1}{\\text{SNR}}\n$$\n此关系在 $\\text{SNR} \\gg 1$ 时有效。假设在 B 和 V 滤光片中的测量是独立的，则 $B-V$ 色的总不确定度由 $\\sigma_{B-V}^2 = \\sigma_{m_B}^2 + \\sigma_{m_V}^2$ 给出。\n\n信号是从恒星收集到的光子数 $N_{star}$。噪声主要由来自恒星和恒定天空背景的泊松噪声主导。在测量孔径内从天空背景探测到的光子数是 $N_{sky}$。总噪声是测得的总光子数的标准差，$\\sigma_{total} = \\sqrt{N_{star} + N_{sky}}$。因此，信噪比为：\n$$\n\\text{SNR} = \\frac{N_{star}}{\\sqrt{N_{star} + N_{sky}}}\n$$\n收集到的光子数是光子探测率与曝光时间的乘积，例如 $N_{star} = R_S t$。\n\n一位天文学家有总观测时间 $T_{tot}$ 用于测量该恒星的 $B-V$ 色。该时间必须在B滤光片曝光（时长 $t_B$）和V滤光片曝光（时长 $t_V$）之间分配，使得 $t_B + t_V = T_{tot}$。来自恒星的恒定平均光子探测率在B和V滤光片中分别为 $R_{S,B}$ 和 $R_{S,V}$。来自天空背景的相应恒定探测率为 $R_{sky,B}$ 和 $R_{sky,V}$。\n\n通过在两个滤光片之间优化分配总曝光时间 $T_{tot}$，推导可实现的最小可能光度误差 $\\sigma_{B-V}$ 的表达式。用给定的光子速率 $R_{S,B}$、$R_{S,V}$、$R_{sky,B}$、$R_{sky,V}$ 和总时间 $T_{tot}$ 来表示您的最终答案。", "solution": "1. 相关关系式：\n$$\\sigma_m\\approx\\frac{2.5}{\\ln10}\\frac1{\\rm SNR},\\quad \n\\mathrm{SNR}=\\frac{N_\\star}{\\sqrt{N_\\star+N_{\\rm sky}}},\\quad \nN_\\star=R_S\\,t,\\;N_{\\rm sky}=R_{\\rm sky}\\,t.$$  \n总 $B\\!-\\!V$ 误差为\n$$\\sigma_{B-V}^2=\\sigma_{m_B}^2+\\sigma_{m_V}^2\n=\\Bigl(\\frac{2.5}{\\ln10}\\Bigr)^2\\Bigl(\\frac1{\\mathrm{SNR}_B^2}+\\frac1{\\mathrm{SNR}_V^2}\\Bigr).$$  \n2. 表示每个信噪比：\n$$\\mathrm{SNR}_B=\\frac{R_{S,B}\\,t_B}{\\sqrt{(R_{S,B}+R_{sky,B})\\,t_B}}\n=\\frac{R_{S,B}\\sqrt{t_B}}{\\sqrt{R_{S,B}+R_{sky,B}}},\n\\quad\\frac1{\\mathrm{SNR}_B^2}\n=\\frac{R_{S,B}+R_{sky,B}}{R_{S,B}^2\\,t_B},$$  \n对于V滤光片和 $t_V$ 也类似。因此\n$$\\sigma_{B-V}^2\n=\\Bigl(\\frac{2.5}{\\ln10}\\Bigr)^2\\Bigl(\\frac{R_{S,B}+R_{sky,B}}{R_{S,B}^2\\,t_B}\n+\\frac{R_{S,V}+R_{sky,V}}{R_{S,V}^2\\,t_V}\\Bigr).$$  \n3. 在 $t_B+t_V=T_{tot}$ 的约束下，用拉格朗日乘子法求最小值：\n$$\\frac{R_{S,B}+R_{sky,B}}{R_{S,B}^2\\,t_B^2}\n=\\frac{R_{S,V}+R_{sky,V}}{R_{S,V}^2\\,t_V^2}\n\\;\\Rightarrow\\;\\frac{t_B}{t_V}\n=\\sqrt{\\frac{(R_{S,B}+R_{sky,B})/R_{S,B}^2}{(R_{S,V}+R_{sky,V})/R_{S,V}^2}}\n=\\frac{\\sqrt{R_{S,B}+R_{sky,B}}/R_{S,B}}{\\sqrt{R_{S,V}+R_{sky,V}}/R_{S,V}}.$$  \n于是\n$$t_B=\\frac{T_{tot}\\,\\sqrt{R_{S,B}+R_{sky,B}}/R_{S,B}}\n{\\sqrt{R_{S,B}+R_{sky,B}}/R_{S,B}+\\sqrt{R_{S,V}+R_{sky,V}}/R_{S,V}},$$  \n$$t_V=T_{tot}-t_B.$$  \n4. 代回可得最小误差\n$$\\sigma_{B-V,\\min}\n=\\frac{2.5}{\\ln10}\\,\\frac{\\displaystyle\\frac{\\sqrt{R_{S,B}+R_{sky,B}}}{R_{S,B}}\n+\\displaystyle\\frac{\\sqrt{R_{S,V}+R_{sky,V}}}{R_{S,V}}}\n{\\sqrt{T_{tot}}}.$$", "answer": "$$\\boxed{\\frac{2.5}{\\ln10}\\,\\frac{\\frac{\\sqrt{R_{S,B}+R_{sky,B}}}{R_{S,B}}\n+\\frac{\\sqrt{R_{S,V}+R_{sky,V}}}{R_{S,V}}}{\\sqrt{T_{tot}}}}$$", "id": "227062"}, {"introduction": "天体发出的光在穿过地球大气层时会被部分吸收和散射，这种效应被称为大气消光。为了确定恒星的真实亮度，天文学家必须精确地校正这种变暗效应。本练习展示了一种测量大气消光的基本技术，即通过整夜在不同大气质量下跟踪一颗恒星的亮度变化来实现。这个实践计算将指导您如何使用最小二乘法拟合来推导天体的“大气外”颜色，这是地面测光中获得已校准科学测量值的基石方法。[@problem_id:226923]", "problem": "在观测天文学中，从地球表面测得的恒星视亮度比其在大气层外的亮度要暗。这种被称为大气消光的变暗效应是与波长相关的。对于一个中心波长为 $\\lambda$ 的给定测光滤光片，观测仪器星等 $m_\\lambda$ 和大气外星等 $(m_\\lambda)_0$ 之间的关系，可由布格定律 (Bouguer's Law) 作一阶建模：\n\n$$m_\\lambda = (m_\\lambda)_0 + k_\\lambda X$$\n\n此处，$X$ 为大气质量，是沿恒星视线方向上大气柱总密度的量度，而 $k_\\lambda$ 是该滤光片的一阶消光系数。\n\n一位天文学家在整夜观测一颗非变星，并使用 B（蓝色）和 V（可见光）两种不同的测光滤光片进行测量。这会产生一个包含 $N$ 次观测的序列。对于每次观测 $i$（其中 $i=1, \\dots, N$），都会记录下一对测量值：大气质量 $X_i$ 和观测仪器色指数 $C_i$，其定义为 $C_i = m_{B,i} - m_{V,i}$。\n\n观测色指数 $C_i$ 和大气质量 $X_i$ 之间的关系亦可表示为如下线性模型：\n$$C_i \\approx C_0 + k_C X_i$$\n其中 $C_0$ 是恒星的真实大气外色指数，$k_C$ 是色指数消光系数。为确定 $C_0$ 和 $k_C$ 的最佳拟合值，通常需要最小化观测色指数与模型预测值之间的残差平方和。\n\n假定有一组 $N$ 个观测数据点 $(X_i, C_i)$，请推导使总残差平方和最小的大气外色指数 $C_0$ 的解析表达式。请用关于给定数据的求和项（例如 $\\sum_{i=1}^N X_i, \\sum_{i=1}^N C_i, \\sum_{i=1}^N X_i C_i$ 等）和总观测次数 $N$ 来表示你的答案。", "solution": "我们寻求使下式最小化的 $C_0$ 和 $k_C$ 值：\n$$S=\\sum_{i=1}^N\\bigl[C_i-(C_0+k_CX_i)\\bigr]^2.$$ \n定义 \n$$S_x=\\sum_{i=1}^N X_i,\\quad S_y=\\sum_{i=1}^N C_i,\\quad \nS_{xx}=\\sum_{i=1}^N X_i^2,\\quad S_{xy}=\\sum_{i=1}^N X_iC_i.$$ \n令 $\\partial S/\\partial C_0=0$ 和 $\\partial S/\\partial k_C=0$ 可得出正规方程组：\n$$S_y = NC_0 + k_CS_x,$$\n$$S_{xy}=C_0S_x + k_CS_{xx}.$$ \n为求解 $C_0$：将第一个方程乘以 $S_{xx}$，第二个方程乘以 $S_x$，然后两式相减可得：\n$$S_{xx}S_y - S_xS_{xy}\n  = C_0\\bigl(NS_{xx}-S_x^2\\bigr).$$ \n因此\n$$\nC_0=\\frac{S_{xx}S_y - S_xS_{xy}}{\\,N S_{xx}-S_x^2\\,}.\n$$\n将各项和的定义代回，即可得到所求的表达式。", "answer": "$$\\boxed{\\frac{\\bigl(\\sum_{i=1}^N X_i^2\\bigr)\\bigl(\\sum_{i=1}^N C_i\\bigr)-\\bigl(\\sum_{i=1}^N X_i\\bigr)\\bigl(\\sum_{i=1}^N X_iC_i\\bigr)}{N\\sum_{i=1}^N X_i^2-\\bigl(\\sum_{i=1}^N X_i\\bigr)^2}}$$", "id": "226923"}, {"introduction": "一旦我们获得了校准后的测光颜色，就可以通过与理论模型比较来推断恒星的物理属性，如温度。这种推断的可靠性取决于统计上是否严谨的比较。这个问题强调了数据分析中的一个关键细节：当两个测量量（如 $U-B$ 和 $B-V$ 颜色）源自一个共同的测量值（$B$ 星等）时，它们的误差是相关的。一个恰当的拟合优度检验，如卡方 ($\\chi^2$) 统计量，必须考虑这种协方差。通过推导完整的 $\\chi^2$ 表达式，您将学会如何在模型拟合中正确处理相关误差，这是一项高级但至关重要的技能，可确保您科学结论的准确性和可靠性。[@problem_id:226746]", "problem": "在恒星天体物理学中，估算恒星有效温度的一个常用方法是将其观测到的测光色指数与理论恒星大气模型预测的色指数进行比较。这通常通过最小化一个卡方($\\chi^2$)统计量来完成，该统计量用以量化观测数据与模型预测之间的拟合优度。\n\n考虑一颗恒星，我们有其在三个标准滤光片下的测光数据：$U$（紫外）、$B$（蓝色）和 $V$（可见光）。测得的视星等为 $m_U, m_B, m_V$，其对应的独立测光测量误差（标准差）为 $\\sigma_U, \\sigma_B, \\sigma_V$。由这些星等可以构成两个色指数：$(U-B)_{obs} = m_U - m_B$ 和 $(B-V)_{obs} = m_B - m_V$。\n\n对于给定的有效温度，恒星大气模型会预测理论内禀色指数，我们将其表示为 $(U-B)_{mod}$ 和 $(B-V)_{mod}$。我们可以将观测色指数与模型色指数之间的残差定义为：\n$\\Delta_{UB} = (U-B)_{obs} - (U-B)_{mod}$\n$\\Delta_{BV} = (B-V)_{obs} - (B-V)_{mod}$\n\n由于 $B$ 波段的星等 $m_B$ 被用于计算两个色指数，因此 $(U-B)_{obs}$ 和 $(B-V)_{obs}$ 的误差不是独立的。在构建 $\\chi^2$ 统计量时，必须考虑这种相关性。\n\n对于一组相关的测量值，$\\chi^2$ 统计量的一般公式为：\n$$\n\\chi^2 = \\mathbf{r}^T \\mathbf{C}^{-1} \\mathbf{r}\n$$\n其中 $\\mathbf{r}$ 是残差的列向量，$\\mathbf{C}$ 是测量的协方差矩阵。\n\n推导用于将观测色指数拟合到模型色指数的 $\\chi^2$ 统计量的完整解析表达式。最终表达式应以残差 $\\Delta_{UB}$ 和 $\\Delta_{BV}$ 以及测光误差 $\\sigma_U, \\sigma_B, \\sigma_V$ 来表示。", "solution": "1. 定义残差向量\n$$\\mathbf{r}=\\begin{pmatrix}\\Delta_{UB}\\\\\\Delta_{BV}\\end{pmatrix}\n=\\begin{pmatrix}(m_U-m_B)-(U\\!-\\!B)_{mod}\\\\(m_B-m_V)-(B\\!-\\!V)_{mod}\\end{pmatrix}.$$\n\n2. 计算方差与协方差\n由于 $m_U,m_B,m_V$ 是独立的，其方差分别为 $\\sigma_U^2,\\sigma_B^2,\\sigma_V^2$，\n$$\\mathrm{Var}(U-B)=\\sigma_U^2+\\sigma_B^2,\\quad \\mathrm{Var}(B-V)=\\sigma_B^2+\\sigma_V^2,$$\n$$\\mathrm{Cov}(U-B,B-V)=\\mathrm{Cov}(m_U-m_B,\\;m_B-m_V)=-\\sigma_B^2.$$\n\n3. 构成协方差矩阵\n$$\\mathbf{C}=\\begin{pmatrix}\n\\sigma_U^2+\\sigma_B^2 & -\\sigma_B^2\\\\\n-\\sigma_B^2 & \\sigma_B^2+\\sigma_V^2\n\\end{pmatrix}.$$\n\n4. 求 $\\mathbf{C}$ 的逆矩阵\n行列式\n$$\\Delta=(\\sigma_U^2+\\sigma_B^2)(\\sigma_B^2+\\sigma_V^2)-(\\!-\\sigma_B^2\\!)^2\n=(\\sigma_U^2+\\sigma_B^2)(\\sigma_B^2+\\sigma_V^2)-\\sigma_B^4.$$\n逆矩阵\n$$\\mathbf{C}^{-1}=\\frac{1}{\\Delta}\n\\begin{pmatrix}\n\\sigma_B^2+\\sigma_V^2 & \\sigma_B^2\\\\\n\\sigma_B^2 & \\sigma_U^2+\\sigma_B^2\n\\end{pmatrix}.$$\n\n5. 计算 $\\chi^2$\n$$\\chi^2=\\mathbf{r}^T\\mathbf{C}^{-1}\\mathbf{r}\n=\\frac{1}{\\Delta}\\Bigl[(\\sigma_B^2+\\sigma_V^2)\\Delta_{UB}^2\n+2\\sigma_B^2\\,\\Delta_{UB}\\Delta_{BV}+(\\sigma_U^2+\\sigma_B^2)\\Delta_{BV}^2\\Bigr].$$", "answer": "$$\\boxed{\\frac{(\\sigma_B^2+\\sigma_V^2)\\,\\Delta_{UB}^2+2\\,\\sigma_B^2\\,\\Delta_{UB}\\,\\Delta_{BV}+(\\sigma_U^2+\\sigma_B^2)\\,\\Delta_{BV}^2}{(\\sigma_U^2+\\sigma_B^2)(\\sigma_B^2+\\sigma_V^2)-\\sigma_B^4}}$$", "id": "226746"}]}