{"hands_on_practices": [{"introduction": "恒星光谱的分析不仅限于恒星本身，也延伸到构成星际介质的冷分子云。通过分析一氧化碳等分子的转动光谱，天文学家可以推断出这些区域的物理条件，例如温度。这个实践练习将带你探究一个基本问题：在给定的温度下，哪个转动能级拥有最多的分子，从而产生最强的谱线。通过将量子化的能级布居问题简化为一个连续优化问题 [@problem_id:189134]，你将掌握一种连接微观量子态与宏观可观测量（如温度）的强大分析方法。", "problem": "在研究星际介质中的冷分子云时，像一氧化碳（CO）这样的双原子分子的转动光谱对于确定气体温度至关重要。一个被建模为刚性转子的双原子分子，其转动能级的能量是量子化的，由 $E_J = B J(J+1)$ 给出，其中 $J$ 是转动量子数（$J=0, 1, 2, ...$），$B$ 是分子的转动常数。每个能级的简并度为 $g_J = 2J+1$。\n\n对于处于温度 $T$ 的热平衡状态下的这些分子气体，每个转动能级上的布居数 $N_J$ 遵循玻尔兹曼分布。处于给定能级 $J$ 上的分子数与该能级的简并度乘以玻尔兹曼因子成正比：\n$$N_J \\propto g_J \\exp\\left(-\\frac{E_J}{k_B T}\\right)$$\n其中 $k_B$ 是玻尔兹曼常数。观测到的对应于从能级 $J$ 跃迁而来的谱线强度，与该能级的布居数 $N_J$ 成正比。\n\n为预测哪条转动谱线最强，我们必须找到使布居数 $N_J$ 最大化的量子数 $J$。\n\n推导与布居数最多的转动能级相对应的转动量子数 $J_{max}$ 的表达式。为获得解析形式的闭合解，您应将 $J$ 视为一个连续的非负实变量，并找到使布居函数 $N_J(J)$ 最大化的值。请用转动常数 $B$、玻尔兹曼常数 $k_B$ 和温度 $T$ 来表示您的结果。", "solution": "我们定义连续的能级布居数为\n$$N(J)=(2J+1)\\exp\\!\\bigl(-\\tfrac{B\\,J(J+1)}{k_B T}\\bigr)\\,. $$\n通过求解 $\\tfrac{d}{dJ}\\ln N(J)=0$ 来求其最大值。我们计算\n$$\\frac{d}{dJ}\\ln N(J)\n=\\frac{2}{2J+1}-\\frac{B(2J+1)}{k_B T}=0\\,. $$\n因此\n$$\\frac{2}{2J+1}=\\frac{B(2J+1)}{k_B T}\\quad\\Longrightarrow\\quad(2J+1)^2=\\frac{2k_B T}{B}\\,. $$\n取正根可得\n$$2J+1=\\sqrt{\\frac{2k_B T}{B}}\\quad\\Longrightarrow\\quad\nJ_{\\max}=\\frac{\\sqrt{\\frac{2k_B T}{B}}-1}{2}\\,. $$", "answer": "$$\\boxed{\\frac{\\sqrt{\\frac{2k_B T}{B}}-1}{2}}$$", "id": "189134"}, {"introduction": "我们观测到的恒星谱线轮廓是多种物理效应共同作用的结果。谱线不仅因恒星自转等内在物理过程而增宽，还会受到分光仪有限分辨率的“模糊”处理。这个实践练习模拟了一个核心的观测挑战：如何区分内在的自转增宽和外在的仪器增宽 [@problem_id:189256]。通过分析这两种轮廓的卷积，你将推导出一个关键的修正因子，这在从观测数据中精确提取恒星自转速度等信息时至关重要。", "problem": "恒星光谱线的分析是天体物理学的一块基石。光谱线的内禀轮廓常常因各种致宽机制而改变，包括恒星的自转和观测仪器的有限分辨率。\n\n考虑来自一颗自转恒星的一条光谱线。其主要由自转致宽决定的内禀谱线轮廓由以下半椭圆函数给出：\n$$\nR(\\Delta\\lambda) = C_R \\sqrt{1 - \\left(\\frac{\\Delta\\lambda}{\\Delta\\lambda_L}\\right)^2}, \\quad |\\Delta\\lambda| \\le \\Delta\\lambda_L\n$$\n并且当 $|\\Delta\\lambda| > \\Delta\\lambda_L$ 时，$R(\\Delta\\lambda) = 0$。此处，$\\Delta\\lambda$ 是与谱线中心的波长位移，$\\Delta\\lambda_L$ 是由自转引起的最大多普勒位移，而 $C_R$ 是一个归一化常数。\n\n这条谱线是用一台摄谱仪观测的，其仪器轮廓 $G(\\Delta\\lambda)$ 可以很好地用一个高斯函数来近似，其半高全宽（FWHM）为 $W_G$。观测到的谱线轮廓 $O(\\Delta\\lambda)$ 是内禀轮廓和仪器轮廓的卷积：$O(\\Delta\\lambda) = (R * G)(\\Delta\\lambda)$。\n\n对任意两个轮廓，其卷积的方差等于它们各自方差之和。设 $\\sigma_R^2$、$\\sigma_G^2$ 和 $\\sigma_O^2$ 分别是自转轮廓、高斯轮廓和观测轮廓的方差。那么 $\\sigma_O^2 = \\sigma_R^2 + \\sigma_G^2$。一个归一化轮廓 $f(x)$ 的方差定义为 $\\sigma_f^2 = \\int_{-\\infty}^{\\infty} x^2 f(x) \\, dx$。对于高斯函数，其半高全宽与方差之间的关系是 $W_G^2 = (8\\ln 2) \\sigma_G^2$。\n\n在一种常见的天体物理学情景中，当仪器致宽远小于自转致宽时（$W_G \\ll W_R$，其中 $W_R$ 是自转轮廓的半高全宽），观测轮廓 $O(\\Delta\\lambda)$ 的形状可以很好地近似内禀轮廓 $R(\\Delta\\lambda)$。这意味着对于这两个轮廓，半高全宽的平方与方差之间的比值近似相同，即 $W_O^2 / \\sigma_O^2 \\approx W_R^2 / \\sigma_R^2$。\n\n在这个假设下，观测轮廓的半高全宽的平方 $W_O^2$ 可以近似地表示为组成轮廓的半高全宽平方的线性组合：\n$$\nW_O^2 \\approx W_R^2 + K \\cdot W_G^2\n$$\n你的任务是推导出常数系数 $K$ 的值。", "solution": "我们从以下近似出发\n$$\n\\frac{W_O^2}{\\sigma_O^2}\\approx\\frac{W_R^2}{\\sigma_R^2},\\qquad \n\\sigma_O^2=\\sigma_R^2+\\sigma_G^2.\n$$\n因此\n$$\n\\frac{W_R^2+K\\,W_G^2}{\\sigma_R^2+\\sigma_G^2}\n=\\frac{W_R^2}{\\sigma_R^2}\n\\;\\Longrightarrow\\;\nK\\,W_G^2\\,\\sigma_R^2\n=W_R^2\\,\\sigma_G^2\n\\;\\Longrightarrow\\;\nK=\\frac{W_R^2\\,\\sigma_G^2}{W_G^2\\,\\sigma_R^2}.\n$$\n\n对于高斯函数，$W_G^2=(8\\ln2)\\,\\sigma_G^2$，所以\n$$\n\\frac{\\sigma_G^2}{W_G^2}=\\frac1{8\\ln2}.\n$$\n\n接下来，对于在 $[-\\Delta\\lambda_L,\\Delta\\lambda_L]$ 上的自转轮廓 $R(x)=C_R\\sqrt{1-(x/\\Delta\\lambda_L)^2}$，通过以下方式进行归一化\n$$\n\\int_{-\\Delta\\lambda_L}^{\\Delta\\lambda_L}C_R\\sqrt{1-(x/\\Delta\\lambda_L)^2}\\,dx=1\n\\;\\Longrightarrow\\;\nC_R=\\frac{2}{\\pi\\Delta\\lambda_L}.\n$$\n其方差为\n$$\n\\sigma_R^2\n=C_R\\int_{-\\Delta\\lambda_L}^{\\Delta\\lambda_L}x^2\\sqrt{1-(x/\\Delta\\lambda_L)^2}\\,dx\n=\\frac{\\Delta\\lambda_L^2}{4}.\n$$\n其半高全宽满足\n$$\n\\sqrt{1-(x/\\Delta\\lambda_L)^2}=\\tfrac12\n\\;\\Longrightarrow\\;\nx=\\frac{\\sqrt3}{2}\\,\\Delta\\lambda_L\n\\;\\Longrightarrow\\;\nW_R=2x=\\sqrt3\\,\\Delta\\lambda_L,\n\\quad\nW_R^2=3\\,\\Delta\\lambda_L^2.\n$$\n因此\n$$\n\\frac{W_R^2}{\\sigma_R^2}\n=\\frac{3\\,\\Delta\\lambda_L^2}{\\Delta\\lambda_L^2/4}\n=12,\n$$\n最后\n$$\nK\n=\\frac{W_R^2}{\\sigma_R^2}\\,\\frac{\\sigma_G^2}{W_G^2}\n=12\\cdot\\frac1{8\\ln2}\n=\\frac{3}{2\\ln2}.\n$$", "answer": "$$\\boxed{\\frac{3}{2\\ln 2}}$$", "id": "189256"}, {"introduction": "谱线的等值宽度是衡量其强度的关键指标，天文学家利用“生长曲线”理论将其与吸收物质的丰度联系起来。然而，当谱线非常强并进入所谓的“饱和区”时，这种关系变得非常微妙，并且容易受到被忽略的物理效应的影响。这个实践练习探讨了一个常见但棘手的系统误差来源：原子能级的超精细结构（HFS）[@problem_id:189396]。你将定量计算，如果分析时忽略了这种未被分辨的结构，将会导致多大的丰度测量误差，从而体会到精确丰度分析工作中的严谨性。", "problem": "在恒星光谱分析中，元素的丰度通常是通过测量其谱线的等值宽度 $W_\\lambda$ 并将其与理论的“生长曲线”进行比较来确定的。对于主要由热多普勒效应致宽的谱线，线心会迅速变得光学厚（饱和）。在生长曲线的这个“饱和”或“平坦”部分，等值宽度随线心光深 $\\tau_0$ 增长得非常缓慢。在该区域，一个标准的近似由以下公式给出：\n\n$$\nW_\\lambda \\propto \\sqrt{\\ln(\\tau_0)}\n$$\n\n其中光深 $\\tau_0$ 与吸收原子的柱密度 $N$ 成正比（即 $\\tau_0 \\propto N$）。\n\n一些谱线会因原子的超精细结构（HFS）而分裂成多个间距很近的组分。如果摄谱仪的分辨率不足以分辨这些组分，它们将被观测为一条混合的谱线。一个不了解超精细结构的天文学家可能会误解总等值宽度，从而导致错误的丰度测定。\n\n考虑一条因HFS分裂成 $k$ 个相同组分的谱线。该元素的总柱密度为 $N_\\text{true}$。这个布居数在 $k$ 个组分中均匀分布。如果谱线没有分裂，其总的真实光深为 $\\tau_\\text{true}$。因此，每个独立HFS组分中心的光深为 $\\tau_\\text{comp} = \\tau_\\text{true} / k$。假设HFS组分分离得足够远，以至于它们对总等值宽度 $W_\\text{tot}$ 的贡献可以线性相加：$W_\\text{tot} = \\sum_{i=1}^k W_i$。\n\n一位天文学家测量了 $W_\\text{tot}$，并在忽略HFS的情况下，将其建模为一条单一谱线。从这个模型中，他们推导出一个推断的柱密度 $N_\\text{inferred}$，对应一个推断的光深 $\\tau_\\text{inferred}$。\n\n请推导丰度误差因子，定义为比率 $\\frac{N_\\text{inferred}}{N_\\text{true}}$，并在单个超精细结构组分的中心光深 $\\tau_\\text{comp}$ 等于自然对数的底 $e$ 这一点上进行计算。", "solution": "1. 生长曲线平坦部分的相关方程：\n$$W_\\lambda = A\\sqrt{\\ln(\\tau_0)}$$\n其中 $A$ 是一个比例常数，且 $\\tau_0\\propto N$。\n\n2. 对于 $k$ 个相同的HFS组分，每个组分的光深为 $\\tau_{\\rm comp}=\\tau_{\\rm true}/k$。它们的等值宽度相加：\n$$W_{\\rm tot}=\\sum_{i=1}^kW_i\n=k\\,A\\sqrt{\\ln\\!\\bigl(\\tau_{\\rm true}/k\\bigr)}.$$\n\n3. 忽略HFS的观测者将 $W_{\\rm tot}$ 拟合为一条单一谱线：\n$$W_{\\rm tot}=A\\sqrt{\\ln(\\tau_{\\rm inferred})}\n\\quad\\Longrightarrow\\quad\n\\sqrt{\\ln(\\tau_{\\rm inferred})}\n= k\\sqrt{\\ln\\!\\bigl(\\tau_{\\rm true}/k\\bigr)}.$$\n两边平方可得\n$$\\ln(\\tau_{\\rm inferred})\n=k^2\\ln\\!\\bigl(\\tau_{\\rm true}/k\\bigr).$$\n\n4. 由于 $\\tau\\propto N$，丰度误差因子为\n$$\\frac{N_{\\rm inferred}}{N_{\\rm true}}\n=\\frac{\\tau_{\\rm inferred}}{\\tau_{\\rm true}}\n=\\exp\\bigl[\\ln(\\tau_{\\rm inferred})-\\ln(\\tau_{\\rm true})\\bigr]\n=\\exp\\Bigl[k^2\\ln\\!\\bigl(\\tfrac{\\tau_{\\rm true}}{k}\\bigr)-\\ln(\\tau_{\\rm true})\\Bigr].$$\n\n5. 在 $\\tau_{\\rm comp}=\\tau_{\\rm true}/k=e$ 处求值：\n$$\\ln\\!\\bigl(\\tfrac{\\tau_{\\rm true}}{k}\\bigr)=1,\\quad\n\\ln(\\tau_{\\rm inferred})=k^2,\\quad\n\\tau_{\\rm true}=k\\,e.$$\n因此\n$$\\frac{N_{\\rm inferred}}{N_{\\rm true}}\n=\\frac{e^{\\,k^2}}{k\\,e}\n=\\frac{e^{\\,k^2-1}}{k}.$$", "answer": "$$\\boxed{\\frac{e^{k^2-1}}{k}}$$", "id": "189396"}]}