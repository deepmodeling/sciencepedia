{"hands_on_practices": [{"introduction": "为了在恒星大气中近似求解辐射转移方程，我们需要描述辐射场的各向异性程度。这个练习 [@problem_id:255859] 让你通过一个简化的思想实验来计算爱丁顿因子 $f = K/J$，从而直观地理解辐射场角度分布与其矩（例如平均强度 $J$ 和与辐射压相关的 $K$ 积分）之间的关系。这是掌握更高级辐射转移方法（如矩方法）的基础。", "problem": "在恒星大气的辐射转移理论中，辐射场的各向异性由爱丁顿因子来表征。该因子关联了比辐射强度 $I$ 的不同阶矩。比辐射强度 $I(\\vec{n})$ 描述了在某一点，单位时间内流经单位面积、沿单位矢量 $\\vec{n}$ 方向单位立体角内的辐射能量。\n\n辐射场的零阶矩、一阶矩和二阶矩是基本物理量。对于轴对称辐射场，这些矩是相对于一个对称轴（例如，温度梯度的方向，我们将其设为z轴）定义的。设 $\\theta$ 为方向矢量 $\\vec{n}$ 与z轴之间的夹角。相关的矩为：\n\n- 平均强度, $J$：\n  $$J = \\frac{1}{4\\pi} \\int_{4\\pi} I(\\theta) d\\Omega$$\n- K积分，它与辐射压强张量的zz分量成正比：\n  $$K = \\frac{1}{4\\pi} \\int_{4\\pi} I(\\theta) \\cos^2\\theta d\\Omega$$\n其中积分遍及所有立体角 $d\\Omega = \\sin\\theta d\\theta d\\phi$。\n\n爱丁顿因子定义为比值 $f = K/J$。\n\n考虑空间中某一点的一个特定的、简化的辐射场。在以z轴为中心、半角为 $\\alpha$ 的圆锥内的所有方向上，比辐射强度 $I$ 为常数 $I_0$；在该圆锥外的所有方向上，比辐射强度为零。用数学形式可以表示为：\n$$\nI(\\theta) = \n\\begin{cases} \nI_0 & \\text{if } 0 \\le \\theta \\le \\alpha \\\\\n0 & \\text{if } \\theta > \\alpha \n\\end{cases}\n$$\n\n请推导该辐射场的爱丁顿因子 $f$，使其成为半角 $\\alpha$ 的一个解析函数。", "solution": "各阶矩定义如下\n$$\nJ=\\frac{1}{4\\pi}\\int_{4\\pi}I(\\theta)\\,d\\Omega,\n\\quad\nK=\\frac{1}{4\\pi}\\int_{4\\pi}I(\\theta)\\cos^2\\theta\\,d\\Omega,\n\\quad\nf=\\frac{K}{J}.\n$$\n根据题设，当 $0\\le\\theta\\le\\alpha$ 时 $I(\\theta)=I_0$ 而在其他情况下为零，并且 $d\\Omega=\\sin\\theta\\,d\\theta\\,d\\phi$。我们有\n$$\n\\int_{0}^{2\\pi}\\!\\!\\int_{0}^{\\alpha}\\sin\\theta\\,d\\theta\\,d\\phi\n=2\\pi\\bigl(1-\\cos\\alpha\\bigr),\n$$\n所以\n$$\nJ=\\frac{I_0}{4\\pi}\\,2\\pi\\,(1-\\cos\\alpha)\n=\\frac{I_0}{2}(1-\\cos\\alpha).\n$$\n接下来，\n$$\nK=\\frac{I_0}{4\\pi}\\int_{0}^{2\\pi}\\!\\!\\int_{0}^{\\alpha}\\cos^2\\theta\\sin\\theta\\,d\\theta\\,d\\phi\n=\\frac{I_0}{2}\\int_{0}^{\\alpha}\\cos^2\\theta\\sin\\theta\\,d\\theta.\n$$\n令 $u=\\cos\\theta$，$du=-\\sin\\theta\\,d\\theta$，得到\n$$\n\\int_{0}^{\\alpha}\\cos^2\\theta\\sin\\theta\\,d\\theta\n=\\int_{1}^{\\cos\\alpha}u^2(-du)\n=\\int_{\\cos\\alpha}^{1}u^2\\,du\n=\\frac{1-\\cos^3\\alpha}{3}.\n$$\n因此\n$$\nK=\\frac{I_0}{2}\\,\\frac{1-\\cos^3\\alpha}{3}\n=\\frac{I_0}{6}(1-\\cos^3\\alpha).\n$$\n爱丁顿因子为\n$$\nf=\\frac{K}{J}\n=\\frac{\\displaystyle\\frac{I_0}{6}(1-\\cos^3\\alpha)}\n{\\displaystyle\\frac{I_0}{2}(1-\\cos\\alpha)}\n=\\frac{1-\\cos^3\\alpha}{3(1-\\cos\\alpha)}\n=\\frac{1+\\cos\\alpha+\\cos^2\\alpha}{3}.\n$$", "answer": "$$\\boxed{\\frac{1+\\cos\\alpha+\\cos^2\\alpha}{3}}$$", "id": "255859"}, {"introduction": "恒星的谱线形状和能量分布由大气内部的源函数 $S_{\\nu}$ 分布决定。这个练习 [@problem_id:189458] 将让你应用辐射转移方程的形式解，为一个随光学深度变化的特定源函数模型，推导出离开恒星表面的总辐射流量 $F_{\\nu}$。这是一个将大气内部物理与可观测能量输出联系起来的关键计算。", "problem": "在恒星大气的辐射转移理论中，对于给定的频率 $\\nu$ 和方向 $\\mu = \\cos\\theta$，表面（$\\tau_\\nu=0$）的出射比强度 $I_\\nu(0, \\mu)$ 由源函数 $S_\\nu(\\tau_\\nu)$ 在整个大气中的分布所决定。对于一个上方没有入射辐射的半无限平面平行大气，辐射转移方程关于出射强度的形式解由下式给出：\n$$\nI_\\nu(0, \\mu) = \\int_0^{\\infty} S_\\nu(t_\\nu) e^{-t_\\nu/\\mu} \\frac{dt_\\nu}{\\mu}\n$$\n其中 $t_\\nu$ 是垂直光学深度 $\\tau_\\nu$ 的积分哑变量。\n\n出射天体物理流量 $F_\\nu(0)$ 代表了表面单位面积的净能量流率，它是通过对所有出射方向的出射强度进行积分得到的：\n$$\nF_\\nu(0) = 2\\pi \\int_0^1 I_\\nu(0, \\mu) \\mu \\, d\\mu\n$$\n\n考虑一个恒星大气的特定模型，其中非局域热动平衡 (NLTE) 效应导致源函数 $S_\\nu$ 随光学深度 $\\tau_\\nu$ 的变化遵循以下关系：\n$$\nS_\\nu(\\tau_\\nu) = S_0 \\tau_\\nu e^{-a \\tau_\\nu}\n$$\n此处，$S_0$ 是一个具有比强度单位的常数，而 $a$ 是一个无量纲正常数，它表征了源函数达到峰值的深度。这种函数形式可以表示由外部源激发的某个层的发射，或物理条件快速变化的色球层的发射。\n\n您的任务是为该大气表面的出射天体物理流量 $F_\\nu(0)$ 推导一个闭合形式的解析表达式。请用常数 $S_0$ 和 $a$ 表示您的最终答案。", "solution": "1. 相关方程：\n   $$\n   I_\\nu(0,\\mu)=\\int_0^\\infty S_\\nu(t)\\,e^{-t/\\mu}\\frac{dt}{\\mu}, \n   \\quad\n   F_\\nu(0)=2\\pi\\int_0^1I_\\nu(0,\\mu)\\,\\mu\\,d\\mu,\n   \\quad\n   S_\\nu(t)=S_0\\,t\\,e^{-a\\,t}.\n   $$\n2. 代入 $F_\\nu(0)$ 并交换积分次序：\n   $$\n   F_\\nu(0)\n   =2\\pi S_0\\int_0^1\\!\\int_0^\\infty t\\,e^{-a t}\\,e^{-t/\\mu}\\,\\frac{dt}{\\mu}\\,\\mu\\,d\\mu\n   =2\\pi S_0\\int_0^1\\int_0^\\infty t\\,e^{-t(a+1/\\mu)}\\,dt\\,d\\mu.\n   $$\n3. 计算关于 $t$ 的积分：对于 $c>0$，有 $\\int_0^\\infty t\\,e^{-c t}dt=1/c^2$。此处 $c=a+1/\\mu$，所以\n   $$\n   F_\\nu(0)\n   =2\\pi S_0\\int_0^1\\frac{d\\mu}{\\bigl(a+\\tfrac1\\mu\\bigr)^2}\n   =2\\pi S_0\\int_0^1\\frac{\\mu^2}{(1+a\\mu)^2}\\,d\\mu.\n   $$\n4. 令 $u=1+a\\mu\\implies d\\mu=du/a$，$\\mu=(u-1)/a$，积分上下限 $u:1\\to1+a$。于是\n   $$\n   \\int_0^1\\frac{\\mu^2}{(1+a\\mu)^2}d\\mu\n   =\\frac1{a^3}\\int_1^{1+a}\\frac{(u-1)^2}{u^2}\\,du\n   =\\frac1{a^3}\\Bigl[u-2\\ln u-\\tfrac1u\\Bigr]_1^{1+a}\n   =\\frac{(1+a)-2\\ln(1+a)-\\tfrac1{1+a}}{a^3}.\n   $$\n5. 因此，出射流量为\n   $$\n   F_\\nu(0)\n   =2\\pi S_0\\,\\frac{(1+a)-2\\ln(1+a)-\\tfrac1{1+a}}{a^3}.\n   $$", "answer": "$$\\boxed{\\frac{2\\pi S_0}{a^3}\\Bigl((1+a)-2\\ln(1+a)-\\frac{1}{1+a}\\Bigr)}$$", "id": "189458"}, {"introduction": "观测恒星时，从星盘中心到边缘，我们看到的光来自大气中不同的深度，这一现象称为“临边昏暗”。这个练习 [@problem_id:309631] 将指导你使用经典的米尔恩-爱丁顿大气模型，来分析一条强吸收谱线的中心深度如何随观测角度变化。通过这个实践，你将亲身体会理论模型是如何预测恒星光谱的可观测特征的。", "problem": "这个问题涉及在一个简化的恒星大气模型中谱线的形成。考虑一个处于局域热动平衡（LTE）状态的平行平面恒星大气，它可以用 Milne-Eddington 模型来描述。为解决此问题，该模型的关键假设如下：\n1. 谱线不透明度系数与连续谱不透明度系数之比 $\\eta_\\nu = \\kappa_\\nu^l / \\kappa_\\nu^c$ 不随深度变化。\n2. 该过程是纯吸收过程。这意味着在任何频率 $\\nu$ 处的源函数 $S_\\nu$ 都等于普朗克函数 $B_\\nu(T)$。\n3. 源函数是连续谱光学厚度 $\\tau_c$ 的线性函数，即 $S_\\nu(\\tau_c) = a + b \\tau_c$。系数 $a$ 和 $b$ 是正常数，并假定在谱线范围内与频率无关。\n\n出射比辐射强度 $I_\\nu(\\mu)$ 通过 $\\mu = \\cos\\theta$ 取决于观测角 $\\theta$，其中 $\\theta$ 是观测方向与恒星表面法线方向的夹角。\n吸收线的中心深度 $R_0(\\mu)$ 是谱线强度的一个量度，定义为：\n$$\nR_0(\\mu) = \\frac{I_c(\\mu) - I_0(\\mu)}{I_c(\\mu)}\n$$\n其中 $I_c(\\mu)$ 是在邻近连续谱中（$\\eta_\\nu = 0$ 处）的出射比辐射强度，$I_0(\\mu)$ 是在谱线中心（$\\eta_\\nu = \\eta_0$ 处）的强度。\n\n考虑一条非常强的吸收线，其谱线中心的不透明度比 $\\eta_0 \\gg 1$。此外，假设大气结构可以很好地用灰色大气的 Eddington 近似来描述，对于该近似，源函数系数之比已知为 $a/b = 2/3$。\n\n推导在恒星盘中心（$\\theta=0$）观测到的该谱线中心深度与在观测角为 $\\theta = \\pi/3$ 处观测到的中心深度之比的值。", "solution": "我们为纯吸收 Milne–Eddington 大气中的出射强度建立模型。总光学厚度为 $\\tau=(1+\\eta)\\tau_c$。当源函数为 $S(\\tau_c)=a+b\\tau_c$ 时，在方向 $\\mu$ 处的出射强度为\n$$\nI(\\mu)\\;=\\;\\frac{1+\\eta}{\\mu}\\int_0^\\infty\\bigl(a+b\\tau_c\\bigr)e^{-\\frac{1+\\eta}{\\mu}\\tau_c}\\,d\\tau_c.\n$$\n计算这两个积分：\n$$\n\\int_0^\\infty a\\,e^{-A\\tau_c}d\\tau_c=\\frac{a}{A},\\qquad\n\\int_0^\\infty b\\tau_c\\,e^{-A\\tau_c}d\\tau_c=\\frac{b}{A^2},\n$$\n其中 $A=(1+\\eta)/\\mu$。因此\n$$\nI(\\mu)=\\frac{1+\\eta}{\\mu}\\Bigl[\\frac{a}{A}+\\frac{b}{A^2}\\Bigr]\n=a+\\frac{b\\mu}{1+\\eta}.\n$$\n在连续谱中 $\\eta=0$，所以\n$$\nI_c(\\mu)=a+b\\mu,\n$$\n而在谱线中心 $\\eta=\\eta_0\\gg1$ 时，得到\n$$\nI_0(\\mu)=a+\\frac{b\\mu}{1+\\eta_0}\\approx a.\n$$\n因此中心深度为\n$$\nR_0(\\mu)=\\frac{I_c(\\mu)-I_0(\\mu)}{I_c(\\mu)}\n=\\frac{(a+b\\mu)-a}{a+b\\mu}\n=\\frac{b\\mu}{a+b\\mu}.\n$$\n根据 Eddington 灰色关系 $a/b=2/3\\implies a=\\tfrac{2}{3}b$，我们得到\n$$\nR_0(\\mu)=\\frac{b\\mu}{\\frac{2}{3}b+b\\mu}\n=\\frac{\\mu}{\\frac{2}{3}+\\mu}\n=\\frac{3\\mu}{3\\mu+2}.\n$$\n最后，在 $\\mu=1$ 和 $\\mu=\\tfrac12$ 处的中心深度之比为\n$$\n\\frac{R_0(1)}{R_0(1/2)}\n=\\frac{\\frac{3\\cdot1}{3\\cdot1+2}}{\\frac{3\\cdot\\frac12}{3\\cdot\\frac12+2}}\n=\\frac{\\frac{3}{5}}{\\frac{3/2}{7/2}}\n=\\frac{\\frac{3}{5}}{\\frac{3}{7}}\n=\\frac{7}{5}.\n$$", "answer": "$$\\boxed{\\frac{7}{5}}$$", "id": "309631"}]}