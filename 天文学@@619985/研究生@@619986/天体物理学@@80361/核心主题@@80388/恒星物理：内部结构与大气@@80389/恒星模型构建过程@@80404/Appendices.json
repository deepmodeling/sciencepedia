{"hands_on_practices": [{"introduction": "多方球模型是恒星结构理论的基石，它通过一个简单的压强-密度关系，将复杂的恒星结构方程转化为可解的形式。这个练习将指导你推导一个多方球模型的质量、半径和中心压强之间的基本关系[@problem_id:349199]。通过这个过程，你将亲身体会到恒星的宏观性质（如总质量）是如何由其内部的物理状态和基本定律所决定的，这是理解恒星如何工作的关键一步。", "problem": "一个处于静力学平衡下的自引力球对称恒星通常可以被建模为一个多方球。在这样的模型中，压力 $P$ 和密度 $\\rho$ 通过多方物态方程联系起来：\n$$\nP = K \\rho^{\\gamma} = K \\rho^{1 + 1/n}\n$$\n其中 $K$ 是多方常数，$\\gamma$ 是多方律指数，而 $n$ 是多方指数。\n\n这种恒星的结构由莱恩-埃姆登方程决定，这是静力学平衡方程的一种无量纲形式：\n$$\n\\frac{1}{\\xi^2} \\frac{d}{d\\xi} \\left( \\xi^2 \\frac{d\\theta}{d\\xi} \\right) = - \\theta^n\n$$\n无量纲函数 $\\theta(\\xi)$ 通过 $\\rho(r) = \\rho_c \\theta^n(\\xi)$ 与密度分布 $\\rho(r)$ 相关，其中 $\\rho_c$ 是中心密度。无量纲半径 $\\xi$ 通过 $r = \\alpha \\xi$ 与物理半径 $r$ 相关，其中标度因子 $\\alpha$ 由下式给出：\n$$\n\\alpha = \\left( \\frac{(n+1)K}{4\\pi G} \\rho_c^{(1/n)-1} \\right)^{1/2}\n$$\n此处，$G$ 是引力常数。莱恩-埃姆登方程在边界条件 $\\theta(0) = 1$ 和 $(d\\theta/d\\xi)|_{\\xi=0} = 0$ 下求解。\n\n对于一个“完全多方球”，恒星具有一个有限半径 $R$，该半径由函数 $\\theta(\\xi)$ 的第一个零点（记为 $\\xi_1$）定义。因此，$R = \\alpha \\xi_1$ 且 $\\theta(\\xi_1) = 0$。\n\n在恒星的总质量 $M$、总半径 $R$ 和中心压力 $P_c$ 之间存在一个基本关系。该关系可以表示为以下形式：\n$$\nM = C_n \\frac{R^2 \\sqrt{P_c}}{\\sqrt{G}}\n$$\n其中 $C_n$ 是一个无量纲系数，它仅取决于多方指数 $n$ 和相应莱恩-埃姆登解的性质。\n\n推导系数 $C_n$ 的表达式，用多方指数 $n$ 和莱恩-埃姆登函数在表面处的导数值 $\\theta'(\\xi_1) \\equiv (d\\theta/d\\xi)|_{\\xi=\\xi_1}$ 来表示。", "solution": "推导过程是通过找出总质量 $M$ 和中心压力 $P_c$ 用莱恩-埃姆登变量表示的表达式，然后将它们组合起来以找到所需的关系。\n\n**步骤 1：推导总质量 $M$ 的表达式。**\n总质量 $M$ 是通过将密度 $\\rho(r)$ 从恒星中心 ($r=0$) 到其表面 ($r=R$) 在整个体积上积分得到的。\n$$\nM = \\int_0^R 4\\pi r^2 \\rho(r) dr\n$$\n我们使用给定的关系式进行变量替换，从 $(r, \\rho)$ 替换为 $(\\xi, \\theta)$：\n$r = \\alpha \\xi \\implies dr = \\alpha d\\xi$\n$\\rho(r) = \\rho_c \\theta^n(\\xi)$\n积分限从 $r \\in [0, R]$ 变为 $\\xi \\in [0, \\xi_1]$。\n将这些代入质量积分中：\n$$\nM = \\int_0^{\\xi_1} 4\\pi (\\alpha \\xi)^2 (\\rho_c \\theta^n) (\\alpha d\\xi)\n$$\n$$\nM = 4\\pi \\alpha^3 \\rho_c \\int_0^{\\xi_1} \\xi^2 \\theta^n d\\xi\n$$\n现在，我们使用莱恩-埃姆登方程来替换项 $\\theta^n$：\n$\\theta^n = -\\frac{1}{\\xi^2} \\frac{d}{d\\xi} \\left( \\xi^2 \\frac{d\\theta}{d\\xi} \\right)$。\n将此代入质量积分中：\n$$\nM = 4\\pi \\alpha^3 \\rho_c \\int_0^{\\xi_1} \\xi^2 \\left( -\\frac{1}{\\xi^2} \\frac{d}{d\\xi} \\left( \\xi^2 \\frac{d\\theta}{d\\xi} \\right) \\right) d\\xi\n$$\n$$\nM = -4\\pi \\alpha^3 \\rho_c \\int_0^{\\xi_1} \\frac{d}{d\\xi} \\left( \\xi^2 \\frac{d\\theta}{d\\xi} \\right) d\\xi\n$$\n一个全导数的积分就是该函数在边界处的值之差：\n$$\nM = -4\\pi \\alpha^3 \\rho_c \\left[ \\xi^2 \\frac{d\\theta}{d\\xi} \\right]_0^{\\xi_1}\n$$\n在积分限处求值：\n在 $\\xi = \\xi_1$ 处，该项为 $\\xi_1^2 (d\\theta/d\\xi)|_{\\xi=\\xi_1} = \\xi_1^2 \\theta'(\\xi_1)$。\n在 $\\xi = 0$ 处，该项为 $0$，因为 $\\xi^2 \\to 0$ 且 $d\\theta/d\\xi \\to 0$。\n因此，总质量的表达式变为：\n$$\nM = -4\\pi \\alpha^3 \\rho_c \\xi_1^2 \\theta'(\\xi_1)\n$$\n\n**步骤 2：将中心压力 $P_c$ 与中心密度 $\\rho_c$ 和标度因子 $\\alpha$ 联系起来。**\n中心压力由在中心处求值的多方物态方程给出：\n$$\nP_c = K \\rho_c^{1+1/n}\n$$\n我们需要消去多方常数 $K$。我们使用标度因子 $\\alpha$ 的定义：\n$$\n\\alpha^2 = \\frac{(n+1)K}{4\\pi G} \\rho_c^{(1/n)-1}\n$$\n解出 $K$：\n$$\nK = \\frac{4\\pi G \\alpha^2}{n+1} \\rho_c^{1-1/n}\n$$\n将这个 $K$ 的表达式代入 $P_c$ 的方程中：\n$$\nP_c = \\left( \\frac{4\\pi G \\alpha^2}{n+1} \\rho_c^{1-1/n} \\right) \\rho_c^{1+1/n} = \\frac{4\\pi G \\alpha^2}{n+1} \\rho_c^{(1 - 1/n) + (1 + 1/n)}\n$$\n$$\nP_c = \\frac{4\\pi G \\alpha^2 \\rho_c^2}{n+1}\n$$\n\n**步骤 3：组合 $M$ 和 $P_c$ 的表达式以消去 $\\alpha$ 和 $\\rho_c$。**\n从 $P_c$ 的关系式中，我们可以用 $P_c$ 和 $\\alpha$ 表示 $\\rho_c$：\n$$\n\\rho_c^2 = \\frac{(n+1)P_c}{4\\pi G \\alpha^2} \\implies \\rho_c = \\sqrt{\\frac{(n+1)P_c}{4\\pi G \\alpha^2}} = \\frac{1}{2\\alpha} \\sqrt{\\frac{(n+1)P_c}{\\pi G}}\n$$\n现在，将这个 $\\rho_c$ 的表达式代入质量 $M$ 的方程中：\n$$\nM = -4\\pi \\alpha^3 \\left( \\frac{1}{2\\alpha} \\sqrt{\\frac{(n+1)P_c}{\\pi G}} \\right) \\xi_1^2 \\theta'(\\xi_1)\n$$\n$$\nM = -2\\pi \\alpha^2 \\sqrt{\\frac{(n+1)P_c}{\\pi G}} \\xi_1^2 \\theta'(\\xi_1)\n$$\n我们还需要消去 $\\alpha$。我们使用恒星半径的关系式 $R = \\alpha \\xi_1$，这意味着 $\\alpha = R/\\xi_1$。\n$$\nM = -2\\pi \\left(\\frac{R}{\\xi_1}\\right)^2 \\sqrt{\\frac{(n+1)P_c}{\\pi G}} \\xi_1^2 \\theta'(\\xi_1)\n$$\n$\\xi_1^2$ 项相互抵消：\n$$\nM = -2\\pi R^2 \\sqrt{\\frac{(n+1)P_c}{\\pi G}} \\theta'(\\xi_1)\n$$\n让我们简化常数：\n$$\nM = -2\\pi R^2 \\frac{\\sqrt{n+1} \\sqrt{P_c}}{\\sqrt{\\pi} \\sqrt{G}} \\theta'(\\xi_1)\n$$\n$$\nM = -2\\sqrt{\\pi} \\sqrt{n+1} \\frac{R^2 \\sqrt{P_c}}{\\sqrt{G}} \\theta'(\\xi_1)\n$$\n\n**步骤 4：确定系数 $C_n$。**\n我们重新整理推导出的表达式，以匹配问题描述中给出的形式 $M = C_n \\frac{R^2 \\sqrt{P_c}}{\\sqrt{G}}$：\n$$\nM = \\left( -2\\sqrt{\\pi(n+1)} \\theta'(\\xi_1) \\right) \\frac{R^2 \\sqrt{P_c}}{\\sqrt{G}}\n$$\n通过与目标形式进行比较，我们确定系数 $C_n$ 为：\n$$\nC_n = -2\\sqrt{\\pi(n+1)} \\theta'(\\xi_1)\n$$\n注意，对于一个物理上束缚的恒星，密度向外减小，这意味着 $\\theta'(\\xi_1)$ 是负值，从而使得系数 $C_n$ 为正值。", "answer": "$$ \\boxed{-2\\sqrt{\\pi(n+1)} \\theta'(\\xi_1)} $$", "id": "349199"}, {"introduction": "建立在简单模型之上，同调关系为我们提供了一套强大的标度律，用以描述不同质量但结构相似的恒星之间的联系。然而，任何简化的模型都有其适用边界，这个练习将带你探索这个边界[@problem_id:349048]。通过分析电子简并压力的影响，你将学会如何定量地判断简单气体压力模型的失效时机，并理解为何对于某些恒星，我们必须引入更复杂的量子物理效应。", "problem": "在简单的恒星模型中，一个关键假设是同调性，即恒星的结构被假定以一种简单的方式随其总质量 $M$ 和半径 $R$ 缩放。这导致了中心压力 $P_c$ 和中心密度 $\\rho_c$ 的缩放关系：\n$$P_c = C_P \\frac{G M^2}{R^4} \\quad \\text{以及} \\quad \\rho_c = C_\\rho \\frac{M}{R^3}$$\n其中 $G$ 是引力常数，$C_P$ 和 $C_\\rho$ 是量级为1的无量纲常数，其值取决于恒星的具体密度分布。\n\n恒星内部的状态方程是理想气体压力和（在特定条件下）电子简并压力的组合。在恒星中心，它们由以下公式给出：\n$$P_{ideal,c} = \\frac{\\rho_c k_B T_c}{\\mu m_p}$$\n$$P_{deg,c} = K_{nr} \\left(\\frac{\\rho_c}{\\mu_e}\\right)^{5/3}$$\n这里，$k_B$ 是玻尔兹曼常数，$T_c$ 是中心温度，$m_p$ 是质子质量，$K_{nr}$ 是非相对论性简并压力的常数，而 $\\mu$ 和 $\\mu_e$ 分别是平均分子量和每自由电子的平均分子量。\n\n当电子简并性变得显著时，基于纯理想气体定律的同调性不再成立。这个转变可以用比率 $\\chi_c = P_{deg,c} / P_{ideal,c}$ 来表征。\n\n考虑一个半径 $R$ 固定、由纯粹的完全电离氢组成的恒星族。对于这些恒星，假设理想气体压力仍然是主要成分，因此来自同调关系的总中心压力 $P_c$ 可以近似为理想气体压力，$P_c \\approx P_{ideal,c}$，这反过来决定了中心温度 $T_c$。\n\n推导比率 $\\chi_c$ 作为恒星质量 $M$ 的函数表达式。你的答案应该用 $M, R, G, K_{nr}, C_P$ 和 $C_\\rho$ 来表示。", "solution": "我们从同调缩放关系开始\n$$\nP_c = C_P\\,\\frac{G M^2}{R^4}, \n\\qquad\n\\rho_c = C_\\rho\\,\\frac{M}{R^3}\\,.\n$$\n理想气体中心压力为 \n$$\nP_{ideal,c} = \\frac{\\rho_c\\,k_B\\,T_c}{\\mu m_p}\n\\approx P_c,\n$$\n所以\n$$\nT_c = \\frac{\\mu m_p\\,P_c}{\\rho_c\\,k_B}\n= \\frac{\\mu m_p}{k_B}\\,\n\\frac{C_P\\,G M^2/R^4}{C_\\rho\\,M/R^3}\n= \\frac{\\mu m_p\\,C_P\\,G\\,M}{C_\\rho\\,k_B\\,R}\\,.\n$$\n中心的非相对论性简并压力为\n$$\nP_{deg,c} = K_{nr}\\Bigl(\\frac{\\rho_c}{\\mu_e}\\Bigr)^{5/3}\n= K_{nr}\\,\\frac{C_\\rho^{5/3}\\,M^{5/3}}{\\mu_e^{5/3}\\,R^5}\\,.\n$$\n因此，比率 \n$\\displaystyle \\chi_c = \\frac{P_{deg,c}}{P_{ideal,c}}$ \n为\n$$\n\\chi_c\n= \\frac{K_{nr}\\,C_\\rho^{5/3}\\,M^{5/3}/(\\mu_e^{5/3}\\,R^5)}\n     {C_P\\,G\\,M^2/R^4}\n= \\frac{K_{nr}\\,C_\\rho^{5/3}}{C_P\\,G\\,\\mu_e^{5/3}\\,R}\n\\,M^{-1/3}\\,.\n$$\n对于纯粹的完全电离氢（$\\mu_e=1$），这简化为\n$$\n\\chi_c = \\frac{K_{nr}\\,C_\\rho^{5/3}}{C_P\\,G\\,R}\\,M^{-1/3}\\,. \n$$", "answer": "$$\\boxed{\\frac{K_{nr}\\,C_\\rho^{5/3}}{C_P\\,G\\,R}\\,M^{-1/3}}$$", "id": "349048"}, {"introduction": "现代恒星模型是通过计算机进行数值求解的，这需要我们将连续的物理方程离散化到网格上。这个练习聚焦于数值计算中的一个关键细节：如何在一个离散的质量壳层中精确地平均像核反应产能率这样对温度和密度极度敏感的物理量[@problem_id:349277]。推导出的对数平均值公式不仅展示了数值方法中的严谨性，也让你得以一窥构建精确且物理真实的恒星演化代码时所面临的实际挑战。", "problem": "在使用拉格朗日质量坐标 $m$ 进行恒星模型的数值构建中，能量生成方程由 $\\frac{dL}{dm} = \\epsilon$ 给出，其中 $L$ 是光度，$\\epsilon$ 是单位质量的能量生成率。这个微分方程通常在离散质量网格 $\\{m_j\\}$ 上使用有限差分格式求解。\n\n对于一个由界面 $m_j$ 和 $m_{j+1}$ 界定的质量壳层，其对应的差分方程写作：\n$$\n\\frac{L_{j+1} - L_j}{m_{j+1} - m_j} = \\bar{\\epsilon}_{j+1/2}\n$$\n此处，$L_j$ 和 $L_{j+1}$ 是壳层边界处的光度，而 $\\bar{\\epsilon}_{j+1/2}$ 代表在该壳层上适当平均的能量生成率。\n\n能量生成率 $\\epsilon$ 是局域密度和温度 $\\epsilon(\\rho, T)$ 的一个非常强的函数。简单的算术平均 $\\bar{\\epsilon}_{j+1/2} = \\frac{1}{2}(\\epsilon_j + \\epsilon_{j+1})$ 可能不准确。一个更稳健的平均值可以通过在壳层上积分得到，$\\bar{\\epsilon}_{j+1/2} = \\frac{1}{m_{j+1}-m_j} \\int_{m_j}^{m_{j+1}} \\epsilon(m) dm$。\n\n假设在小的质量区间 $[m_j, m_{j+1}]$ 内，能量生成率的自然对数 $\\ln \\epsilon$ 随质量坐标 $m$ 线性变化。基于此假设，推导壳层平均能量生成率 $\\bar{\\epsilon}_{j+1/2}$ 的表达式，该表达式用其在壳层边界处的值 $\\epsilon_j \\equiv \\epsilon(m_j)$ 和 $\\epsilon_{j+1} \\equiv \\epsilon(m_{j+1})$ 来表示。", "solution": "我们假设 $\\ln\\epsilon(m)$ 在 $[m_j,m_{j+1}]$ 上线性变化：\n$$\n\\ln\\epsilon(m)\n=\\ln\\epsilon_j\n+\\frac{\\ln\\epsilon_{j+1}-\\ln\\epsilon_j}{m_{j+1}-m_j}\\,(m-m_j).\n$$\n定义斜率\n$$\n\\alpha\n=\\frac{\\ln\\epsilon_{j+1}-\\ln\\epsilon_j}{m_{j+1}-m_j},\n$$\n使得\n$$\n\\epsilon(m)=\\epsilon_j\\,e^{\\alpha\\,(m-m_j)}.\n$$\n壳层平均率为\n$$\n\\bar\\epsilon_{j+1/2}\n=\\frac{1}{m_{j+1}-m_j}\\int_{m_j}^{m_{j+1}}\\epsilon(m)\\,dm\n=\\frac{\\epsilon_j}{\\alpha\\,(m_{j+1}-m_j)}\n\\bigl[e^{\\alpha\\,(m_{j+1}-m_j)}-1\\bigr].\n$$\n注意到 $\\alpha\\,(m_{j+1}-m_j)=\\ln\\epsilon_{j+1}-\\ln\\epsilon_j$ 且 $e^{\\ln\\epsilon_{j+1}-\\ln\\epsilon_j}=\\frac{\\epsilon_{j+1}}{\\epsilon_j}$，可得\n$$\n\\bar\\epsilon_{j+1/2}\n=\\frac{\\epsilon_j}{\\ln\\epsilon_{j+1}-\\ln\\epsilon_j}\n\\Bigl(\\frac{\\epsilon_{j+1}}{\\epsilon_j}-1\\Bigr)\n=\\frac{\\epsilon_{j+1}-\\epsilon_j}{\\ln\\epsilon_{j+1}-\\ln\\epsilon_j}.\n$$", "answer": "$$\\boxed{\\frac{\\epsilon_{j+1}-\\epsilon_j}{\\ln(\\epsilon_{j+1})-\\ln(\\epsilon_j)}}$$", "id": "349277"}]}