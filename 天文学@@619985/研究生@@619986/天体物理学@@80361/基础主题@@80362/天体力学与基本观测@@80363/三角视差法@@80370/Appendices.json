{"hands_on_practices": [{"introduction": "三角视差法的核心在于一个简单的几何原理：观测基线越长，视差角越大，从而可以测量更远的距离。这个练习通过一个思想实验，比较在地球和火星上观测同一颗恒星所产生的视差椭圆，来巩固你对这一基本关系的理解 [@problem_id:318657]。通过推导这两个视差椭圆半长轴的比率，你将亲身体会到扩展观测基线对于提高测量精度的根本性好处。", "problem": "三角视差法是天文距离测量的基石。当一颗行星绕其主星运行时，一颗邻近的恒星在天球上相对于更遥远的、看似固定的恒星背景，会描绘出一个小椭圆轨迹。这个视路径被称为视差椭圆。对于一颗在半径为 $a$ 的圆形轨道上绕其主星运行的行星，一颗距离为 $d$ (其中 $d \\gg a$) 的恒星所形成的视差椭圆的半长轴 $\\alpha$，由视差角 $p$ 本身（以弧度表示）给出。视差角由小角度近似 $p \\approx a/d$ 定义。\n\n考虑一颗距离太阳为固定距离 $d$ 的恒星。从太阳系内的两个不同位置——地球和火星——观测其位置。假设这两颗行星都围绕太阳在共面的圆形轨道上运行，其轨道半径分别为 $a_E$ 和 $a_M$。从每颗行星上的观测者角度来看，该恒星会描绘出各自不同的视差椭圆。设从地球测量的视差椭圆半长轴为 $\\alpha_E$，从火星测量的视差椭圆半长轴为 $\\alpha_M$。\n\n推导比值 $\\alpha_E / \\alpha_M$ 的表达式。", "solution": "1. 视差角的小角度近似为\n$$p\\approx\\frac{a}{d}。$$\n\n2. 对于地球上的观测者（轨道半径为 $a_E$），视差椭圆的半长轴为\n$$\\alpha_E=\\frac{a_E}{d}。$$\n\n3. 对于火星上的观测者（轨道半径为 $a_M$），半长轴为\n$$\\alpha_M=\\frac{a_M}{d}。$$\n\n4. 求两者之比可得\n$$\\frac{\\alpha_E}{\\alpha_M}\n=\\frac{\\displaystyle\\frac{a_E}{d}}{\\displaystyle\\frac{a_M}{d}}\n=\\frac{a_E}{a_M}\\,. $$", "answer": "$$\\boxed{\\frac{a_E}{a_M}}$$", "id": "318657"}, {"introduction": "从测量的视差值 $p$ 转换到距离 $d$ 似乎只是一个简单的求倒数运算 ($d = 1/p$)，但当测量存在不确定性时，这个非线性转换会引入一个微妙而重要的系统性偏差。这个练习将引导你推导这个被称为“Lutz-Kelker 偏差”的主导项，让你理解为什么在天体测量学中，直接平均视差值通常比平均距离值更可取 [@problem_id:318514]。这是统计天文学中的一个关键概念，强调了在处理带有误差的数据时必须小心谨慎。", "problem": "在天体物理测量中，到邻近恒星的距离 $d$ 通常使用三角视差法来确定。以角秒为单位测量的视差角 $p$ 与以秒差距为单位测量的距离 $d$ 通过简单的反比关系 $d=1/p$ 相关。\n\n对恒星视差的单次测量并非完全精确，会受到随机误差的影响。设恒星的真实视差为 $p_0$，其对应于真实距离 $d_0 = 1/p_0$。一次观测测量得到一个值 $p$，它可以被描述为一个随机变量。测量过程是无偏的，意味着测量的期望值是真实值，$E[p] = p_0$。测量的不确定度由其标准差 $\\sigma_p = \\sqrt{E[(p-p_0)^2]}$ 来表征。我们假设误差分布关于均值对称，这意味着所有奇数阶中心矩均为零 (即，对于整数 $k \\ge 0$ 有 $E[(p-p_0)^{2k+1}] = 0$)。\n\n一位天文学家使用朴素公式 $d_\\text{est} = 1/p$ 来计算一个估计距离。由于该公式涉及对测量量 $p$ 的非线性变换，估计距离的期望值 $E[d_\\text{est}]$ 将不等于真实距离 $d_0$。这导致了一个系统性偏差。\n\n假设测量不确定度与视差本身相比很小 (即 $\\sigma_p \\ll p_0$)，推导距离估计中期望分数误差的主阶近似。分数误差定义为 $\\delta_d = (d_\\text{est} - d_0) / d_0$。你的最终表达式应该用真实视差 $p_0$ 及其标准差 $\\sigma_p$ 来表示。", "solution": "1. 定义估计距离和分数误差：\n$$d_\\text{est}=\\frac1p,\\quad \\delta_d=\\frac{E[d_\\text{est}]-d_0}{d_0},\\quad d_0=\\frac1{p_0}.$$  \n2. 将 $1/p$ 在 $p_0$ 处进行泰勒级数展开：\n$$\\frac1p=\\frac1{p_0}+\\Bigl(-\\frac1{p_0^2}\\Bigr)(p-p_0)+\\frac12\\Bigl(\\frac{2}{p_0^3}\\Bigr)(p-p_0)^2+\\cdots.$$  \n3. 取期望值，使用 $E[p-p_0]=0$ 和 $E[(p-p_0)^2]=\\sigma_p^2$：\n$$E\\Bigl[\\frac1p\\Bigr]=\\frac1{p_0}+\\frac{1}{p_0^3}\\,\\sigma_p^2+O(\\sigma_p^4).$$  \n4. 计算分数偏差：\n$$\\delta_d=\\frac{E[d_\\text{est}]-d_0}{d_0}\n=\\frac{\\bigl(\\frac1{p_0}+\\frac{\\sigma_p^2}{p_0^3}\\bigr)-\\frac1{p_0}}{\\frac1{p_0}}\n=\\frac{\\sigma_p^2}{p_0^2}+O(\\sigma_p^4).$$", "answer": "$$\\boxed{\\frac{\\sigma_p^2}{p_0^2}}$$", "id": "318514"}, {"introduction": "在实际的天体测量中，目标恒星的视差是相对于一组并非无限远的参考星来测量的，这些参考星本身也具有微小的、未知的视差。这个问题将你置于现代天体测量学的前沿，任务是构建一个最优估计量，从这些相对测量中提取出目标恒星的绝对视差 [@problem_id:318553]。你将学习如何通过加权平均来同时考虑仪器测量噪声和参考星群的“宇宙学方差” (cosmic variance)，从而推导出最小方差的无偏估计。", "problem": "在天体物理天体测量学中，目标恒星的绝对视差 $\\pi_T$ 是通过测量其相对于一组更遥远的背景参考星的视运动来确定的。实践中，这些参考星并非位于无限远处，它们自身也具有微小且未知的视差。一位观测者进行了一系列 $N$ 次独立的测量，其中每次测量值 $y_i$（$i = 1, \\dots, N$）是目标恒星相对于一颗*不同*的参考星 $i$ 的视差。\n\n测量模型由下式给出：\n$$y_i = (\\pi_T - \\pi_i) + \\epsilon_i$$\n其中 $\\pi_i$ 是第 $i$ 颗参考星的真实绝对视差，$\\epsilon_i$ 是随机测量误差，该误差从一个均值为 $E[\\epsilon_i] = 0$、方差为 $Var(\\epsilon_i) = \\sigma_i^2$ 的分布中抽取。\n\n这些参考星选自一个我们拥有其统计模型的恒星总体。它们的真实绝对视差 $\\pi_i$ 被视为随机变量，从一个总体中抽取，该总体的均值取决于一个可测量的属性，例如视星等 $m_i$。该关系由一个已知函数 $E[\\pi_i] = g(m_i)$ 给出。参考星视差围绕该均值的内在弥散被称为“宇宙方差”(cosmic variance)，并假定其对所有参考星都是一个常数，即 $Var(\\pi_i - g(m_i)) = \\sigma_\\pi^2$。\n\n所有的测量误差 $\\epsilon_i$ 和宇宙弥散项 $\\delta_i = \\pi_i - g(m_i)$ 都是相互不相关的。\n\n我们希望使用一个作为测量值 $y_i$ 的线性函数的估计量，来找到目标恒星绝对视差 $\\pi_T$ 的最佳估计：\n$$\\hat{\\pi}_T = \\sum_{i=1}^N w_i y_i + C$$\n其中 $w_i$ 是恒定权重，$C$ 是一个常数偏移量。\n\n首先，通过施加其必须是无偏的条件，即 $E[\\hat{\\pi}_T] = \\pi_T$，来确定该估计量的形式。这将建立起 $C$ 和权重 $w_i$ 之间的关系，以及对权重本身的约束。\n\n然后，找到使该无偏估计量方差 $Var(\\hat{\\pi}_T)$ 最小化的最佳权重集 $w_i$。\n\n推导出该最小方差 $Var(\\hat{\\pi}_T)_{min}$ 的表达式。", "solution": "我们有测量值\n$$y_i = (\\pi_T - \\pi_i) + \\epsilon_i,\\quad E[\\epsilon_i]=0,\\;Var(\\epsilon_i)=\\sigma_i^2$$\n和先验\n$$E[\\pi_i]=g(m_i),\\quad\\pi_i = g(m_i)+\\delta_i,\\;Var(\\delta_i)=\\sigma_\\pi^2.$$\n\n1. 无偏性\n$$E[y_i]=\\pi_T - g(m_i)$$\n$$E[\\hat\\pi_T]=\\sum_i w_iE[y_i]+C\n=\\pi_T\\sum_i w_i-\\sum_i w_i g(m_i)+C\\stackrel{!}{=}\\pi_T$$\n得到\n$$\\sum_{i=1}^N w_i=1,\\quad C=\\sum_{i=1}^N w_i g(m_i).$$\n\n2. 方差\n使用 $y_i=\\pi_T-g(m_i)-\\delta_i+\\epsilon_i$ 我们发现\n$$\\hat\\pi_T=\\pi_T-\\sum_i w_i\\delta_i+\\sum_i w_i\\epsilon_i$$\n所以\n$$Var(\\hat\\pi_T)=\\sum_{i=1}^N w_i^2\\bigl(\\sigma_\\pi^2+\\sigma_i^2\\bigr).$$\n\n3. 最佳权重\n在约束 $\\sum_i w_i=1$ 下，通过拉格朗日乘子法最小化 $\\sum_i w_i^2V_i$（其中 $V_i=\\sigma_\\pi^2+\\sigma_i^2$）：\n$$\\frac{\\partial}{\\partial w_i}:\\;2w_iV_i-2\\lambda=0\\;\\Rightarrow\\;w_i=\\frac{\\lambda}{V_i},$$\n$$\\sum_i w_i=1\\;\\Rightarrow\\;\\lambda=\\Bigl(\\sum_{j=1}^N\\frac1{V_j}\\Bigr)^{-1}.$$\n因此\n$$w_i=\\frac{1/V_i}{\\sum_j1/V_j},\\quad Var_{\\min}=\\sum_i w_i^2V_i\n=\\frac{1}{\\sum_{i=1}^N\\frac1{V_i}}.$$", "answer": "$$\\boxed{\\frac{1}{\\sum_{i=1}^N \\frac{1}{\\sigma_i^2 + \\sigma_\\pi^2}}}$$", "id": "318553"}]}