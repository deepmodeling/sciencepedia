{"hands_on_practices": [{"introduction": "主序拟合是确定星团距离的基石技术之一。通过将观测到的恒星视星等 $m$ 与其绝对星等 $M$ 的理论模型（即零龄主序）进行比较，我们可以为整个星团确定一个统一的距离模数 $\\mu$ 。本练习 [@problem_id:278897] 将指导您使用最小二乘法，推导出最佳拟合的距离模数，这是天文数据分析中的一项基本技能。", "problem": "距离模数 $\\mu$ 是衡量到某个天体距离的一种度量。它被定义为天体的视星等 $m$ 与绝对星等 $M$ 之差：$\\mu = m - M$。对于一个星团，可以假定其所有成员星都处于相同的距离，因此共享相同的距离模数。\n\n主序星的绝对星等是其色指数 $C$ 的一个明确定义的函数。一个标准的零龄主序 (ZAMS) 理论模型将此关系表示为关于色指数 $C$ 的二次多项式：\n$$M(C) = \\alpha + \\beta C + \\gamma C^2$$\n其中 $\\alpha$、$\\beta$ 和 $\\gamma$ 是经验校准的系数。\n\n一位天文学家观测一个遥远的星团，并测量了其 $N$ 颗主序星的视星等 $m_i$ 和色指数 $C_i$，其中 $i = 1, 2, \\ldots, N$。为了确定该星团的距离模数，这位天文学家使用了最小二乘法。这需要找到一个 $\\mu$ 值，使得观测到的视星等与模型预测的视星等之间的残差平方和 $\\mathcal{S}$ 最小。第 $i$ 颗恒星的模型预测视星等为 $m_{i, \\text{model}} = M(C_i) + \\mu$。\n\n推导使残差平方和最小的距离模数 $\\mu$ 的闭式表达式。该表达式应使用恒星数量 $N$、ZAMS 系数 ($\\alpha, \\beta, \\gamma$) 以及对观测数据点的求和项（即 $\\sum_{i=1}^N m_i$、$\\sum_{i=1}^N C_i$ 和 $\\sum_{i=1}^N C_i^2$）来表示。", "solution": "我们寻求最小化 $\\mathcal S$ 的 $\\mu$：\n$$\\mathcal S=\\sum_{i=1}^N\\bigl[m_i-\\bigl(M(C_i)+\\mu\\bigr)\\bigr]^2\n=\\sum_{i=1}^N\\bigl[m_i-\\alpha-\\beta C_i-\\gamma C_i^2-\\mu\\bigr]^2.$$\n对 $\\mu$ 求导并令其为零：\n$$\\frac{d\\mathcal S}{d\\mu}\n=-2\\sum_{i=1}^N\\bigl[m_i-\\alpha-\\beta C_i-\\gamma C_i^2-\\mu\\bigr]=0.$$\n因此\n$$\\sum_{i=1}^N\\bigl[m_i-\\alpha-\\beta C_i-\\gamma C_i^2-\\mu\\bigr]=0$$\n$$\\Longrightarrow\\sum_{i=1}^N m_i-\\sum_{i=1}^N(\\alpha+\\beta C_i+\\gamma C_i^2)\n-N\\mu=0.$$\n注意到\n$$\\sum_{i=1}^N(\\alpha+\\beta C_i+\\gamma C_i^2)\n=N\\alpha+\\beta\\sum_{i=1}^N C_i+\\gamma\\sum_{i=1}^N C_i^2,$$\n我们解出 $\\mu$：\n$$\\mu=\\frac{\\sum_{i=1}^N m_i-\\bigl(N\\alpha+\\beta\\sum_{i=1}^N C_i\n+\\gamma\\sum_{i=1}^N C_i^2\\bigr)}{N}.$$", "answer": "$$\\boxed{\\frac{\\sum_{i=1}^N m_i - N\\alpha - \\beta \\sum_{i=1}^N C_i - \\gamma \\sum_{i=1}^N C_i^2}{N}}$$", "id": "278897"}, {"introduction": "在建立了距离测量方法之后，我们必须考虑系统误差。本练习探讨了其中一个最重要的物理系统误差：星际尘埃消光。我们将对一个前景尘埃云进行建模，并计算它如何系统性地使背景标准烛光的光线变暗，如果不加以校正，将导致对其距离的过高估计。这项实践 [@problem_id:278930] 演示了如何通过对一个物理密度模型进行积分来量化距离模数中的消光项 $A$ 。", "problem": "一位观测者正在测量一颗标准烛光星的距离，该恒星位于一团非均匀球状尘埃云的遥远后方。该云的尘埃密度分布 $\\rho(r)$ 由一个 Plummer 模型描述：\n$$\n\\rho(r) = \\frac{\\rho_0}{\\left(1 + \\frac{r^2}{a^2}\\right)^{5/2}}\n$$\n其中 $r$ 是距离云中心的径向距离，$\\rho_0$ 是中心密度，$a$ 是云的特征尺度半径。该云可以被认为延伸至无穷远。\n\n来自恒星的光沿着一条直线视线传播，该视线以碰撞参数 $b$ 经过云的中心。尘埃的存在会引起消光，使星光变暗。以星等为单位的消光值 $A$，与沿视线方向的尘埃柱密度 $N_d$ 成正比。这种关系由 $A = \\kappa N_d$ 给出，其中 $\\kappa$ 是一个取决于尘埃颗粒光学性质的常数。\n\n距离模数 $\\mu = m - M$ 将恒星的视星等 $m$ 与其绝对星等 $M$ 联系起来，它会因消光而修正为 $\\mu = 5 \\log_{10}(d) - 5 + A$，其中 $d$ 是以秒差距为单位的距离。如果不考虑消光项 $A$，它将成为距离测定中的一个系统误差。\n\n请推导这个距离模数中的系统误差 $\\Delta\\mu = A$ 的一个闭合形式解析表达式，使其作为碰撞参数 $b$ 的函数。请用给定的参数 $\\rho_0$、$a$、$b$ 和 $\\kappa$ 来表示你的答案。", "solution": "消光由下式给出\n$$\\Delta\\mu = A = \\kappa\\,N_d(b),$$\n其中，在碰撞参数为 $b$ 时穿过 Plummer 球体的尘埃柱密度为\n$$N_d(b) = \\int_{-\\infty}^\\infty \\rho\\bigl(\\sqrt{b^2+z^2}\\bigr)\\,dz.$$\n代入 $\\rho(r)=\\rho_0\\bigl(1+(r^2/a^2)\\bigr)^{-5/2}$ 并利用对称性：\n$$N_d(b)=2\\rho_0\\int_0^\\infty\\bigl(1+\\tfrac{b^2+z^2}{a^2}\\bigr)^{-5/2}dz.$$\n令 $u=z/a$，$dz=a\\,du$，并定义 $A=1+\\tfrac{b^2}{a^2}$：\n$$N_d(b)=2\\rho_0a\\int_0^\\infty\\bigl(A+u^2\\bigr)^{-5/2}du.$$\n使用标准积分\n$$\\int_0^\\infty(u^2+A)^{-n}du=\\frac{\\sqrt\\pi}{2}\\frac{\\Gamma(n-\\tfrac12)}{\\Gamma(n)}A^{-n+\\tfrac12},$$\n取 $n=\\tfrac52$，因此 $\\Gamma(n-\\tfrac12)=\\Gamma(2)=1$ 且 $\\Gamma(\\tfrac52)=\\tfrac{3\\sqrt\\pi}{4}$。于是\n$$\\int_0^\\infty(A+u^2)^{-5/2}du=\\frac{\\sqrt\\pi}{2}\\frac{1}{\\tfrac{3\\sqrt\\pi}{4}}A^{-2}=\\frac{2}{3}A^{-2}.$$\n因此\n$$N_d(b)=2\\rho_0a\\cdot\\frac{2}{3}\\Bigl(1+\\tfrac{b^2}{a^2}\\Bigr)^{-2}=\\frac{4}{3}\\rho_0a\\Bigl(1+\\frac{b^2}{a^2}\\Bigr)^{-2}.$$\n最后，\n$$\\Delta\\mu=\\kappa\\,N_d(b)=\\frac{4}{3}\\kappa\\,\\rho_0\\,a\\Bigl(1+\\frac{b^2}{a^2}\\Bigr)^{-2}.$$", "answer": "$$\\boxed{\\frac{4}{3}\\kappa \\rho_0 a \\left(1 + \\frac{b^2}{a^2}\\right)^{-2}}$$", "id": "278930"}, {"introduction": "精确宇宙学不仅需要解释物理系统误差，还需要考虑我们测量过程中固有的微妙统计偏差。这个问题 [@problem_id:278776] 深入探讨了光子计数统计的世界，揭示了星等标度的对数非线性特性（$m = -k \\ln(S) + C$）会如何引入系统性偏差。通过理解这种效应，我们可以洞察在嘈杂背景下进行低信噪比光度测量的根本挑战，以及仔细进行误差分析的重要性。", "problem": "距离模数 $\\mu = m - M$ 是河外天文学的基石，它允许通过天体的视星等 $m$ 和其绝对星等 $M$ 之间的差异来确定距离。对于用作“标准烛光”的Ia型超新星，精确测量其峰值视星等至关重要。然而，由于光子计数的统计特性，这种测量可能会受到微小的系统性偏差的影响。\n\n考虑对一颗处于峰值亮度的暗淡超新星进行光度测量。一次观测包括测量以超新星为中心的孔径内的光子数 $N_{total}$，以及放置在邻近空白天区上以测量背景的相同孔径内的光子数 $N_{bkg}$。这两个光子计数过程都遵循泊松统计。来自超新星的光子的真实平均数是 $\\lambda_{sig}$，而来自天空背景（孔径内）的光子的真实平均数是 $\\lambda_{bkg}$。因此，观测到的计数是从泊松分布中抽取的随机变量：\n- $N_{total} \\sim \\text{Pois}(\\lambda_{sig} + \\lambda_{bkg})$\n- $N_{bkg} \\sim \\text{Pois}(\\lambda_{bkg})$\n\n以计数为单位的、来自超新星的估计信号由 $S = N_{total} - N_{bkg}$ 给出。视星等 $m$ 通过关系式 $m = -k \\ln(\\text{signal}) + C$ 与信号计数相关联，其中 $k$ 是一个与所用对数底数相关的正常数，而 $C$ 是星等零点。“真实”视星等使用真实平均信号来定义：$m_{true} = -k \\ln(\\lambda_{sig}) + C$。然而，天文学家必须根据单次测量值 $S$ 计算估计星等 $m_{est}$：$m_{est} = -k \\ln(S) + C$。\n\n由于对数的非线性性质，估计星等的期望值 $\\langle m_{est} \\rangle$ 不等于真实星等 $m_{true}$。这种差异会给测量的星等带来系统性偏差，并因此影响到推断的距离模数。\n\n请用真实平均计数 $\\lambda_{sig}$、$\\lambda_{bkg}$ 和常数 $k$ 来推导该系统性星等偏差 $\\Delta m = \\langle m_{est} \\rangle - m_{true}$ 的领头阶表达式。为此，请使用 $\\ln(S)$ 在 $S$ 的平均值附近的二阶泰勒级数展开。假设信号足够强，以至于观测到 $S \\le 0$ 的概率可以忽略不计。", "solution": "1. 定义估计信号 $S=N_{total}-N_{bkg}$，其平均值为\n$$\\mu_S=\\langle S\\rangle=\\lambda_{sig}$$ \n方差为（泊松分布是独立的）\n$$\\sigma_S^2=\\mathrm{Var}(N_{total})+\\mathrm{Var}(N_{bkg})\n=(\\lambda_{sig}+\\lambda_{bkg})+\\lambda_{bkg}\n=\\lambda_{sig}+2\\lambda_{bkg}\\,. $$\n\n2. 估计星等为\n$$m_{est}=-k\\ln S + C\\,. $$\n我们要求解\n$$\\langle m_{est}\\rangle\n=-k\\,\\langle\\ln S\\rangle + C\\,,$$\n并与下式比较\n$$m_{true}=-k\\ln\\lambda_{sig}+C\\,.$$\n\n3. 使用 $\\ln S$ 在 $S=\\lambda_{sig}$ 处的二阶泰勒展开：\n$$\\ln S\\approx\\ln\\lambda_{sig}\n+\\frac{1}{\\lambda_{sig}}(S-\\lambda_{sig})\n-\\frac{1}{2\\lambda_{sig}^2}(S-\\lambda_{sig})^2.$$\n取期望值，并注意到 $\\langle S-\\lambda_{sig}\\rangle=0$，$\\langle(S-\\lambda_{sig})^2\\rangle=\\sigma_S^2$，可得\n$$\\langle\\ln S\\rangle\n=\\ln\\lambda_{sig}\n-\\frac{\\sigma_S^2}{2\\lambda_{sig}^2}\n=\\ln\\lambda_{sig}\n-\\frac{\\lambda_{sig}+2\\lambda_{bkg}}{2\\lambda_{sig}^2}\\,. $$\n\n4. 因此\n$$\\langle m_{est}\\rangle\n=-k\\Bigl[\\ln\\lambda_{sig}\n-\\frac{\\lambda_{sig}+2\\lambda_{bkg}}{2\\lambda_{sig}^2}\\Bigr]+C\n=-k\\ln\\lambda_{sig}+C\n+\\frac{k(\\lambda_{sig}+2\\lambda_{bkg})}{2\\lambda_{sig}^2}\\,. $$\n\n5. 系统性偏差为\n$$\\Delta m=\\langle m_{est}\\rangle - m_{true}\n=\\frac{k\\bigl(\\lambda_{sig}+2\\lambda_{bkg}\\bigr)}{2\\lambda_{sig}^2}\\,. $$", "answer": "$$\\boxed{\\frac{k(\\lambda_{sig}+2\\lambda_{bkg})}{2\\lambda_{sig}^2}}$$", "id": "278776"}]}