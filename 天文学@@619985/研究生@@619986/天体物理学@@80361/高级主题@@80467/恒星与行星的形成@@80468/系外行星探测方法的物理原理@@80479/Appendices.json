{"hands_on_practices": [{"introduction": "凌星法是发现系外行星最有效的方法之一，但它本质上偏向于轨道排列恰到好处的行星。本练习探讨了观测到凌星的基本几何概率，这对于解释巡天结果和理解行星族群的统计数据至关重要。通过推导凌星行星的期望冲击参数 $\\langle b \\rangle$，我们可以更好地理解观测选择效应如何塑造我们所看到的系外行星世界 [@problem_id:250046]。", "problem": "**问题陈述**\n\n对一个大型行星系综进行凌星巡天。每个系统包含一颗行星，该行星以半长轴为 $a$ 的圆形轨道绕着一颗半径为 $R_s$ 的恒星运行。一个关键的假设是，这些系统的轨道朝向是随机且各向同性的，这意味着任何给定行星轨道平面的法向量在空间中指向任何方向的概率都相等。\n\n撞击参数 $b$ 是一个无量纲量，用于衡量在合相时，恒星中心与行星中心在天球平面上的投影距离。对于圆形轨道，它由关系式 $b = \\frac{a}{R_s} |\\cos i|$ 给出，其中 $i$ 是轨道倾角。轨道倾角 $i$ 是轨道平面法向量与观测者视线之间的夹角。\n\n如果行星中心从恒星盘面前方经过，就会观测到凌星现象。这发生在撞击参数 $b$ 满足条件 $b \\le 1$ 时。我们感兴趣的是被观测到发生凌星的行星子群体的统计特性。\n\n推导该凌星行星群体的撞击参数的期望值 $\\langle b \\rangle$。", "solution": "1. 对于各向同性的朝向，$x=\\cos i$ 的分布在 $[-1,1]$ 上是均匀的，因此\n$$f_x(x)=\\frac12,\\quad x\\in[-1,1].$$\n\n2. 定义 $u=|\\cos i|$。那么它在 $[0,1]$ 上的概率密度函数（PDF）是\n$$f_u(u)=f_x(u)+f_x(-u)=\\frac12+\\frac12=1,\\quad u\\in[0,1].$$\n\n3. 撞击参数为\n$$b=\\frac{a}{R_s}\\,u\\equiv A\\,u,\\quad A\\equiv\\frac{a}{R_s}.$$\n\n4. 凌星条件 $b\\le1$ 意味着\n$$u\\le\\frac1A.$$\n凌星的概率是\n$$P(\\text{transit})=\\int_0^{1/A}f_u(u)\\,du=\\int_0^{1/A}1\\,du=\\frac1A.$$\n\n5. 在发生凌星的条件下，$u$ 的条件概率密度函数是\n$$f_{u|\\text{tran}}(u)=\\frac{f_u(u)}{P(\\text{transit})}=\\frac{1}{1/A}=A,\n\\quad u\\in\\left[0,\\frac1A\\right].$$\n\n6. 对于凌星行星，$b$ 的期望值是\n\n$$\n\\langle b\\rangle\n=\\int_0^{1/A}(A\\,u)\\,f_{u|\\text{tran}}(u)\\,du\n=A\\int_0^{1/A}u\\,(A)\\,du\n=A^2\\int_0^{1/A}u\\,du\n=A^2\\left[\\frac{u^2}{2}\\right]_0^{1/A}\n=A^2\\frac{1}{2A^2}\n=\\frac12.\n$$", "answer": "$$\\boxed{\\frac12}$$", "id": "250046"}, {"introduction": "探测到行星信号后，下一步便是精确描绘其轨道。本练习将深入探讨天体物理数据分析的核心：如何将模型与观测数据进行拟合。我们将学习如何利用一系列带有已知不确定度的天体测量数据，通过最小化 $\\chi^2$ 来确定最佳轨道参数，并进一步计算协方差矩阵以量化这些参数的可信度 [@problem_id:250025]。", "problem": "在 $N$ 个不同的时间 $t_j$（其中 $j=1, \\dots, N$）测量了一颗绕邻近恒星运行的系外行星的天体测量位置。每次测量都提供了行星与恒星在赤经 ($\\Delta \\alpha_j$) 和赤纬 ($\\Delta \\delta_j$) 上的角距离。我们可以将这些数据组织成一组 $N$ 个二维数据向量 $\\mathbf{d}_j = (\\Delta \\alpha_j, \\Delta \\delta_j)^T$。假设测量不确定度服从高斯分布，各次测量之间不相关，并且对于所有观测都相同，在 $\\Delta \\alpha$ 和 $\\Delta \\delta$ 两个方向上的标准差均为 $\\sigma$。\n\n该行星的轨道由一个包含 $M$ 个参数的模型描述，这些参数构成一个参数向量 $\\mathbf{p} = (p_1, \\dots, p_M)^T$。对于每个时间 $t_j$，该模型预测一个天体测量位置向量 $\\mathbf{m}_j(\\mathbf{p}) = (\\Delta \\alpha_{\\text{model}}(t_j, \\mathbf{p}), \\Delta \\delta_{\\text{model}}(t_j, \\mathbf{p}))^T$。\n\n最佳拟合参数 $\\mathbf{p}_0$ 是通过最小化卡方 ($\\chi^2$) 统计量得到的，其定义为：\n$$\n\\chi^2(\\mathbf{p}) = \\sum_{j=1}^{N} \\frac{(\\mathbf{d}_j - \\mathbf{m}_j(\\mathbf{p}))^T (\\mathbf{d}_j - \\mathbf{m}_j(\\mathbf{p}))}{\\sigma^2}\n$$\n\n最佳拟合参数的不确定度由参数协方差矩阵 $\\mathbf{C}$ 表征，该矩阵与 $\\chi^2$ 似然面在其最小值处的曲率有关。对于多元高斯不确定度，协方差矩阵是费雪信息矩阵 $\\mathbf{F}$ 的逆矩阵，其分量由 $F_{kl} = \\frac{1}{2}\\frac{\\partial^2 \\chi^2}{\\partial p_k \\partial p_l}$ 给出，并在最佳拟合参数 $\\mathbf{p}_0$ 处求值。\n\n令 $\\mathbf{J}_j$ 为第 $j$ 次观测的雅可比矩阵，在最佳拟合参数 $\\mathbf{p}_0$ 处求值。这是一个 $2 \\times M$ 的矩阵，其元素为 $(\\mathbf{J}_j)_{k,l} = \\frac{\\partial m_{j,k}}{\\partial p_l}|_{\\mathbf{p}_0}$，其中 $m_{j,k}$ 是模型向量 $\\mathbf{m}_j$ 的第 $k$ 个分量。\n\n假设模型在参数不确定度的尺度上是足够线性的（或者等价地说，拟合良好且残差 $\\mathbf{d}_j - \\mathbf{m}_j(\\mathbf{p}_0)$ 很小并呈噪声状），你可以忽略涉及模型二阶导数 $\\frac{\\partial^2 \\mathbf{m}_j}{\\partial p_k \\partial p_l}$ 的项。在此近似下，推导最佳拟合参数 $\\mathbf{p}_0$ 的协方差矩阵 $\\mathbf{C}$ 的表达式。用测量不确定度 $\\sigma$ 和雅可比矩阵 $\\mathbf{J}_j$ 来表示你的答案。", "solution": "我们从卡方和费雪矩阵的定义开始：\n$$\n\\chi^2(\\mathbf p)=\\sum_{j=1}^N\\frac{(\\mathbf d_j-\\mathbf m_j(\\mathbf p))^T(\\mathbf d_j-\\mathbf m_j(\\mathbf p))}{\\sigma^2},\n\\qquad\nF_{kl}=\\tfrac12\\frac{\\partial^2\\chi^2}{\\partial p_k\\partial p_l}\\Big|_{\\mathbf p_0}.\n$$\n1. 一阶导数：\n$$\n\\frac{\\partial\\chi^2}{\\partial p_l}\n=-\\frac{2}{\\sigma^2}\\sum_{j=1}^N(\\mathbf d_j-\\mathbf m_j)^T\\frac{\\partial\\mathbf m_j}{\\partial p_l}\n=-\\frac{2}{\\sigma^2}\\sum_{j=1}^N(\\mathbf d_j-\\mathbf m_j)^T\\mathbf J_{j\\!,l}.\n$$\n2. 二阶导数，忽略 $\\partial^2\\mathbf m_j/\\partial p_k\\partial p_l$：\n$$\n\\frac{\\partial^2\\chi^2}{\\partial p_k\\partial p_l}\n=\\frac{2}{\\sigma^2}\\sum_{j=1}^N\\Bigl(\\frac{\\partial\\mathbf m_j}{\\partial p_k}\\Bigr)^T\n\\frac{\\partial\\mathbf m_j}{\\partial p_l}\n=\\frac{2}{\\sigma^2}\\sum_{j=1}^N(\\mathbf J_j)_{:,k}^T(\\mathbf J_j)_{:,l}.\n$$\n因此\n$$\nF_{kl}=\\frac1{2}\\frac{\\partial^2\\chi^2}{\\partial p_k\\partial p_l}\n=\\frac{1}{\\sigma^2}\\sum_{j=1}^N(\\mathbf J_j^T\\mathbf J_j)_{kl},\n$$\n或者写成矩阵形式\n$$\n\\mathbf F=\\frac{1}{\\sigma^2}\\sum_{j=1}^N\\mathbf J_j^T\\mathbf J_j.\n$$\n由于协方差为 $\\mathbf C=\\mathbf F^{-1}$，我们得到\n$$\n\\mathbf C=\\sigma^2\\Bigl(\\sum_{j=1}^N\\mathbf J_j^T\\mathbf J_j\\Bigr)^{-1}.\n$$", "answer": "$$\\boxed{\\sigma^2\\bigl(\\sum_{j=1}^N\\mathbf J_j^T\\mathbf J_j\\bigr)^{-1}}$$", "id": "250025"}, {"introduction": "探测系外行星的微弱信号通常是一场与噪声的斗争，而有时恒星本身就是主要的干扰源。本练习模拟了一种真实的恒星“抖动”来源，它会模仿甚至掩盖行星的视向速度信号。通过计算由恒星表面环流引起的伪视向速度信号 $\\Delta V_{RV}$，我们将学会领会确认行星探测背后所需的复杂天体物理学知识 [@problem_id:249838]。", "problem": "一位天体物理学家正试图为恒星“抖动”的来源建立模型，这种抖动会模拟或掩盖系外行星的径向速度（RV）信号。其中一个来源是恒星表面的等离子体大尺度环流。考虑一个简化的恒星模型，其半径为 $R_*$，具有与恒星极轴对齐的均匀角速度 $\\vec{\\Omega}$。\n\n该恒星表现出一种稳态的、轴对称的子午环流，这是一种在恒星表面从赤道流向两极的大尺度物质流动。在一个球坐标系 $(r, \\theta, \\phi)$ 中，原点位于恒星中心，z轴与 $\\vec{\\Omega}$ 对齐，该流动由速度矢量 $\\vec{v}_m = -v_0 \\sin(2\\theta) \\hat{\\theta}$ 描述，其中 $v_0$ 是一个恒定的正速度振幅，$\\theta$ 是余纬。\n\n恒星的自转通过科里奥利力使该子午流发生偏转。科里奥利加速度由 $\\vec{a}_C = -2(\\vec{\\Omega} \\times \\vec{v}_m)$ 给出。此加速度引起一个纯方位角（纬向）的速度分量 $\\vec{v}_\\phi$。假设此诱导流达到稳态，此时科里奥利加速度被一个形式为 $\\vec{a}_d = -k \\vec{v}_\\phi$ 的线性阻力加速度完美平衡，其中 $k$ 是一个正常数阻力系数。\n\n一位观测者正在从该恒星赤道平面内的一个远点进行观测（即倾角 $i=90^\\circ$）。恒星表面对视向速度有贡献的总速度场为 $\\vec{v} = \\vec{v}_m + \\vec{v}_\\phi$。对此问题，你可以忽略恒星的整体转动速度，因为其对全盘积分的径向速度的贡献平均为零。另外，假设恒星的表面亮度是均匀的（即忽略临边昏暗）。\n\n推导由这种组合环流模式产生的净伪径向速度信号 $\\Delta V_{RV}$。净径向速度定义为视向速度在可见恒星盘面上的强度加权平均。你的最终答案需要用子午流振幅 $v_0$ 来表示。", "solution": "我们在球坐标系 $(r,\\theta,\\phi)$ 中进行计算，观测者位于赤道平面内，沿+x轴方向。表面（$r=R_*$）上的子午流为\n$$\\vec v_m=-v_0\\sin(2\\theta)\\,\\hat\\theta\\,,\\quad\nv_\\theta=-2v_0\\sin\\theta\\cos\\theta\\,. $$\n科里奥利加速度为\n$$\\vec a_C=-2\\,\\vec\\Omega\\times\\vec v_m\n=-2\\,\\Omega(\\cos\\theta\\,\\hat r-\\sin\\theta\\,\\hat\\theta)\\times(v_\\theta\\hat\\theta)\n=-2\\Omega v_\\theta\\cos\\theta\\,\\hat\\phi\\,. $$\n稳态阻力平衡 $\\,\\vec a_C-k\\vec v_\\phi=0\\,$ 给出\n$$v_\\phi=-\\frac{2\\Omega v_\\theta\\cos\\theta}{k}\n=\\frac{-2\\Omega(-2v_0\\sin\\theta\\cos\\theta)\\cos\\theta}{k}\n=\\frac{4\\Omega v_0}{k}\\,\\sin\\theta\\cos^2\\theta\\,. $$\n\n视向单位矢量为\n$$\\hat n=\\hat x\n=\\sin\\theta\\cos\\phi\\,\\hat r+\\cos\\theta\\cos\\phi\\,\\hat\\theta-\\sin\\phi\\,\\hat\\phi\\,. $$\n由于 $v_r=0$，视向速度为\n$$v_{\\rm LOS}\n=v_\\theta\\,(\\hat\\theta\\cdot\\hat n)+v_\\phi\\,(\\hat\\phi\\cdot\\hat n)\n=-2v_0\\sin\\theta\\cos\\theta\\cos\\theta\\cos\\phi\n-\\frac{4\\Omega v_0}{k}\\sin\\theta\\cos^2\\theta\\sin\\phi\\,. $$\n\n在可见盘面上的强度加权平均使用投影面积元\n$$dA_{\\rm proj}\\propto(\\hat r\\cdot\\hat n)\\,dA\n\\propto\\sin^2\\theta\\cos\\phi\\,d\\theta\\,d\\phi\n$$\n其中 $\\phi\\in[-\\pi/2,\\pi/2]$，$\\theta\\in[0,\\pi]$。因此\n$$\\Delta V_{RV}\n=\\frac{\\iint v_{\\rm LOS}\\,\\sin^2\\theta\\cos\\phi\\,d\\theta\\,d\\phi}\n{\\iint\\sin^2\\theta\\cos\\phi\\,d\\theta\\,d\\phi}\\,. $$\n与 $v_\\phi$ 成正比的项因为在 $\\phi$ 上是奇函数，所以积分为零。因此只有第一项有贡献：\n\n$$\n\\begin{aligned}\n\\text{分子}\n&=-2v_0\\int_0^\\pi\\sin^3\\theta\\cos^2\\theta\\,d\\theta\n\\int_{-\\pi/2}^{\\pi/2}\\cos^2\\phi\\,d\\phi\n=-2v_0\\cdot\\frac{4}{15}\\cdot\\frac{\\pi}{2}\n=-\\frac{4\\pi}{15}\\,v_0,\\\\\n\\text{分母}\n&=\\int_0^\\pi\\sin^2\\theta\\,d\\theta\\int_{-\\pi/2}^{\\pi/2}\\cos\\phi\\,d\\phi\n=\\frac{\\pi}{2}\\cdot2=\\pi.\n\\end{aligned}\n$$\n\n因此\n$$\n\\Delta V_{RV}\n=\\frac{-\\frac{4\\pi}{15}v_0}{\\pi}\n=-\\frac{4}{15}v_0\\,. \n$$", "answer": "$$\\boxed{-\\frac{4}{15}v_0}$$", "id": "249838"}]}