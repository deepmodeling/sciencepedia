{"hands_on_practices": [{"introduction": "相空间分布函数 $f$ 是描述无碰撞恒星系统动力学状态的基石，它包含了系统的全部信息。本练习旨在通过对一个依赖于能量的分布函数进行积分，来推导出一个宏观、可观测的量——速度弥散。这是一个核心技能，它展示了如何从微观的相空间描述过渡到宏观的动力学性质，正如金斯定理所指出的那样 [@problem_id:285446]。", "problem": "考虑一个一维无碰撞粒子系统（例如，在一个致密的、球对称的星团核心中，主要沿径向轨道运动的恒星）。该系统处于稳恒态，粒子在一个静态、对称的势 $\\Phi(x)$ 中运动。根据 Jeans's theorem，这样一个系统的相空间分布函数 $f(x, v_x)$ 可以表示为运动积分的函数。对于这个不依赖于时间的势，单位质量的能量 $H = \\frac{1}{2}v_x^2 + \\Phi(x)$ 是每个粒子的运动守恒量。\n\n我们使用截断的幂律分布函数来对此系统建模，在其他情况下，这通常被称为多方分布函数：\n$$\nf(H) = \n\\begin{cases}\n    C(H_0 - H)^n & \\text{for } H \\le H_0 \\\\\n    0 & \\text{for } H > H_0\n\\end{cases}\n$$\n这里，$C$ 和 $H_0$ 是正常数，指数 $n$ 是一个大于 $-1$ 的实常数。常数 $H_0$ 代表一个截断能量，意味着没有粒子的能量大于 $H_0$。\n\n系统的宏观性质，例如质量密度 $\\rho(x)$ 和速度弥散 $\\sigma_x(x)$，可以作为分布函数的矩导出。它们的定义如下：\n$$\n\\rho(x) = \\int_{-\\infty}^{\\infty} f(x, v_x) \\, dv_x\n$$\n$$\n\\sigma_x^2(x) = \\frac{1}{\\rho(x)} \\int_{-\\infty}^{\\infty} v_x^2 f(x, v_x) \\, dv_x\n$$\n由于势 $\\Phi(x)$ 的对称性和 $f(H)$ 的形式，平均速度处处为零。\n\n推导速度弥散平方 $\\sigma_x^2(x)$ 的一个通式，它应是当地势 $\\Phi(x)$ 以及模型参数 $H_0$ 和 $n$ 的函数。最终的表达式不应包含归一化常数 $C$ 或任何未计算的积分。", "solution": "相关方程：\n1. 密度：\n$$\n\\rho(x)=\\int_{-\\infty}^{\\infty}f(H)\\,dv_x\n,\\quad H=\\tfrac12v_x^2+\\Phi(x).\n$$\n2. 二阶矩：\n$$\nS(x)=\\int_{-\\infty}^\\infty v_x^2f(H)\\,dv_x.\n$$\n3. 速度弥散：\n$$\n\\sigma_x^2(x)=\\frac{S(x)}{\\rho(x)}.\n$$\n令 $A=H_0-\\Phi(x)$ 且 $v_{\\max}=\\sqrt{2A}$。那么\n$$\n\\rho=2C\\int_0^{\\sqrt{2A}}(A-\\tfrac12v^2)^n\\,dv\n=2C A^n\\int_0^{\\sqrt{2A}}\\Bigl(1-\\frac{v^2}{2A}\\Bigr)^n\\,dv.\n$$\n代入 $v=\\sqrt{2A}\\,u$, $dv=\\sqrt{2A}\\,du$：\n$$\n\\rho=2C A^{n+\\frac12}\\sqrt2\\frac{\\sqrt\\pi\\,\\Gamma(n+1)}{2\\,\\Gamma(n+\\tfrac32)}\n=C\\sqrt{2\\pi}\\,A^{n+\\frac12}\\frac{\\Gamma(n+1)}{\\Gamma(n+\\tfrac32)}.\n$$\n接下来，\n$$\nS=2C\\int_0^{\\sqrt{2A}}v^2(A-\\tfrac12v^2)^n\\,dv\n=4C A^{n+1}\\sqrt{2A}\\int_0^1u^2(1-u^2)^n\\,du.\n$$\n使用 $\\int_0^1u^2(1-u^2)^n\\,du=\\frac{\\sqrt\\pi\\,\\Gamma(n+1)}{4\\,\\Gamma(n+\\tfrac52)}$ 可得\n$$\nS\n=4C A^{n+1}\\sqrt{2A}\\frac{\\sqrt\\pi\\,\\Gamma(n+1)}{4\\,\\Gamma(n+\\tfrac52)}\n=C\\sqrt{2\\pi}\\,A^{n+\\frac32}\\frac{\\Gamma(n+1)}{\\Gamma(n+\\tfrac52)}.\n$$\n因此\n$$\n\\sigma_x^2=\\frac{S}{\\rho}\n=\\frac{A^{n+\\frac32}\\,\\Gamma(n+1)/\\Gamma(n+\\tfrac52)}\n{A^{n+\\frac12}\\,\\Gamma(n+1)/\\Gamma(n+\\tfrac32)}\n=A\\frac{\\Gamma(n+\\tfrac32)}{\\Gamma(n+\\tfrac52)}\n=\\frac{A}{n+\\tfrac32}.\n$$\n将 $A=H_0-\\Phi(x)$ 代回。", "answer": "$$\\boxed{\\frac{H_0-\\Phi(x)}{n+\\frac{3}{2}}}$$", "id": "285446"}, {"introduction": "直接求解无碰撞玻尔兹曼方程通常很困难，但我们可以通过对其取矩来得到更易于处理的金斯方程。金斯方程建立了星系质量密度 $\\rho$、引力势 $\\Phi$ 和恒星运动（速度弥散 $\\sigma$）之间的重要联系。在本练习中，我们将应用球形金斯方程，为一个经典的普卢默（Plummer）模型，在给定速度各向异性的情况下，求解其径向速度弥散，从而展示金斯方程在分析自洽恒星系统中的强大作用 [@problem_id:285445]。", "problem": "一个自引力的球状恒星系统可以用 Plummer 模型来描述。其质量密度分布 $\\rho(r)$ 和引力势 $\\Phi(r)$ 由下式给出：\n$$\n\\rho(r) = \\frac{3M}{4\\pi a^3} \\left(1 + \\frac{r^2}{a^2}\\right)^{-5/2}\n$$\n$$\n\\Phi(r) = -\\frac{GM}{\\sqrt{r^2+a^2}}\n$$\n其中 $M$ 是系统的总质量，$a$ 是 Plummer 半径（一个特征尺度长度），$G$ 是引力常数，$r$ 是距中心的径向距离。\n\n该恒星系统处于稳态，其动力学由无碰撞玻尔兹曼方程控制。速度分布是各向异性的，由各向异性参数 $\\beta(r)$ 来表征，其定义为 $\\beta(r) = 1 - \\frac{\\sigma_t^2(r)}{\\sigma_r^2(r)}$，其中 $\\sigma_r(r)$ 和 $\\sigma_t(r)$ 分别是径向和切向的速度弥散。对于这个特定的 Plummer 模型，各向异性参数由下式给出：\n$$\n\\beta(r) = \\frac{r^2}{r^2+a^2}\n$$\n密度、势和速度弥散之间的关系由球状 Jeans 方程描述。\n\n使用所提供的信息和球状 Jeans 方程，推导径向速度弥散的平方 $\\sigma_r^2(r)$ 的闭合形式表达式。", "solution": "1. 稳态下的球状 Jeans 方程：\n$$\n\\frac{d\\bigl(\\rho\\,\\sigma_r^2\\bigr)}{dr}+\\frac{2\\beta(r)}{r}\\,\\rho\\,\\sigma_r^2=-\\rho\\,\\frac{d\\Phi}{dr}.\n$$\n2. 给定 $\\beta(r)=r^2/(r^2+a^2)$，积分因子为\n$$\n\\exp\\!\\Bigl[\\int\\frac{2\\beta(r)}{r}dr\\Bigr]\n=\\exp\\!\\Bigl[2\\int\\frac{r}{r^2+a^2}dr\\Bigr]\n=\\exp[\\ln(r^2+a^2)]=r^2+a^2.\n$$\n将 Jeans 方程乘以 $r^2+a^2$：\n$$\n\\frac{d\\bigl[(r^2+a^2)\\rho\\,\\sigma_r^2\\bigr]}{dr}\n=-(r^2+a^2)\\,\\rho\\,\\frac{d\\Phi}{dr}.\n$$\n3. 从 $r$ 到 $\\infty$ 积分，并设 $\\sigma_r^2(\\infty)=0$：\n$$\n(r^2+a^2)\\rho\\,\\sigma_r^2\n=-\\int_r^{\\infty}(r'^2+a^2)\\,\\rho(r')\\,\\frac{d\\Phi}{dr'}\\,dr'.\n$$\n4. 代入 \n$\\rho(r)=\\frac{3M}{4\\pi a^3}(1+r^2/a^2)^{-5/2}\n=\\frac{3M\\,a^2}{4\\pi(r^2+a^2)^{5/2}}$，\n$\\frac{d\\Phi}{dr}=GM\\,\\frac{r}{(r^2+a^2)^{3/2}}$。那么\n$$\n(r^2+a^2)\\rho\\,\\sigma_r^2\n=GM\\int_r^{\\infty}\\frac{3M\\,a^2}{4\\pi}\\,\\frac{r'}{(r'^2+a^2)^3}dr'\n\\;=\\;\\frac{3M^2Ga^2}{4\\pi}\\,\\frac{1}{4(r^2+a^2)^2}.\n$$\n5. 因此\n$$\n\\sigma_r^2\n=\\frac{GM}{(r^2+a^2)\\,\\rho}\\;\\frac{3M\\,a^2}{16\\pi(r^2+a^2)^2}\n=\\frac{GM}{4\\sqrt{r^2+a^2}}.\n$$", "answer": "$$\\boxed{\\frac{GM}{4\\sqrt{r^2+a^2}}}$$", "id": "285445"}, {"introduction": "星系动力学的一个中心任务是找到能够自洽地产生观测到的密度分布的相空间分布函数 $f$。本次实践与第一个练习的过程恰好相反：我们将根据给定的面密度和引力势，来“逆向工程”出分布函数。我们将为一个“冷盘”模型构建分布函数，其中所有恒星都遵循纯圆形轨道，这是一个对真实星系盘非常有用的理想化模型 [@problem_id:285471]。", "problem": "一个星系模型由一个冷的、无限薄的恒星盘组成。该盘处于稳恒态且轴对称，因此其相空间分布函数 (DF) $f$ 可以描述为运动积分的函数：比能 $E$ 和比角动量的z分量 $L_z$。\n\n“冷盘”近似意味着所有恒星都在赤道面 $z=0$ 上沿纯圆形轨道运动。这将其分布函数的形式限制为：\n$$\nf(E, L_z) = F(L_z) \\delta(E - E_c(L_z))\n$$\n其中 $E_c(L_z)$ 是角动量为 $L_z$ 的圆轨道的比能，$\\delta(\\cdot)$ 是狄拉克δ函数，而 $F(L_z)$ 是一个决定质量如何在不同圆轨道间分布的函数。\n\n该恒星盘处在Kuzmin引力势中，在柱坐标 $(R, \\phi, z)$ 下由以下公式给出：\n$$\n\\Phi(R, z) = - \\frac{GM}{\\sqrt{R^2 + (|z|+a)^2}}\n$$\n在 $z=0$ 平面上与该引力势相一致的盘的面质量密度是Kuzmin面密度：\n$$\n\\Sigma(R) = \\frac{Ma}{2\\pi (R^2+a^2)^{3/2}}\n$$\n在这些表达式中，$G$ 是引力常数，$M$ 和 $a$ 是分别代表系统质量和标长参数的正常数。\n\n对于给定的角动量值 $L_z$，存在一个唯一的圆轨道半径 $R_c(L_z)$。因此，函数 $F(L_z)$ 可以表示为该半径的函数，即 $F(L_z) = \\mathcal{F}(R_c(L_z))$。推导函数 $\\mathcal{F}(R)$ 的表达式。", "solution": "问题要求我们求出函数 $\\mathcal{F}(R)$，该函数用圆轨道半径 $R$ 来参数化冷盘分布函数 $f(E, L_z) = F(L_z) \\delta(E - E_c(L_z))$ 中δ函数前的因子 $F(L_z)$。\n\n函数 $\\mathcal{F}(R) = F(L_{z,c}(R))$ 通过冷盘的标准公式与面密度 $\\Sigma(R)$ 相关联：\n$$\n\\mathcal{F}(R) = \\frac{2\\pi R \\, \\Sigma(R)}{\\left|\\frac{dL_{z,c}}{dR}\\right|}\n$$\n这里，$L_{z,c}(R)$ 是半径为 $R$ 的圆轨道上恒星的比角动量。我们需要计算 $L_{z,c}(R)$ 及其对 $R$ 的导数。\n\n**第一步：计算圆周速度和角动量**\n\n对于 $z=0$ 平面内的圆轨道，引力提供所需的向心加速度。单位质量所受的径向力由 $F_R = -\\frac{\\partial \\Phi}{\\partial R}$ 给出。\n$z=0$ 平面内的引力势为：\n$$\n\\Phi(R, 0) = - \\frac{GM}{\\sqrt{R^2 + a^2}}\n$$\n径向力为：\n$$\nF_R = -\\frac{\\partial}{\\partial R} \\left( - \\frac{GM}{(R^2+a^2)^{1/2}} \\right) = GM \\left( -\\frac{1}{2} \\right) (R^2+a^2)^{-3/2} (2R) = -\\frac{GMR}{(R^2+a^2)^{3/2}}\n$$\n圆轨道的向心加速度为 $a_c = v_c^2/R$，其中 $v_c$ 是圆周速度。令 $-F_R = a_c$：\n$$\n\\frac{v_c^2}{R} = \\frac{GMR}{(R^2+a^2)^{3/2}}\n$$\n$$\nv_c(R)^2 = \\frac{GMR^2}{(R^2+a^2)^{3/2}}\n$$\n圆轨道的比角动量为 $L_{z,c}(R) = R v_c(R)$。\n$$\nL_{z,c}(R) = R \\sqrt{\\frac{GMR^2}{(R^2+a^2)^{3/2}}} = \\frac{\\sqrt{GM} R^2}{(R^2+a^2)^{3/4}}\n$$\n\n**第二步：计算圆轨道角动量的导数**\n\n我们需要计算 $\\frac{dL_{z,c}}{dR}$。可以使用商法则，但我们将对 $L_{z,c}(R) = \\sqrt{GM} R^2 (R^2+a^2)^{-3/4}$ 使用积法则。\n$$\n\\frac{dL_{z,c}}{dR} = \\sqrt{GM} \\frac{d}{dR} \\left[ R^2 (R^2+a^2)^{-3/4} \\right]\n$$\n$$\n\\frac{dL_{z,c}}{dR} = \\sqrt{GM} \\left[ 2R(R^2+a^2)^{-3/4} + R^2 \\left(-\\frac{3}{4}\\right)(R^2+a^2)^{-7/4}(2R) \\right]\n$$\n提取公因式：\n$$\n\\frac{dL_{z,c}}{dR} = \\sqrt{GM} \\cdot R(R^2+a^2)^{-7/4} \\left[ 2(R^2+a^2) - \\frac{3}{2}R^2 \\right]\n$$\n简化方括号中的项：\n$$\n2(R^2+a^2) - \\frac{3}{2}R^2 = 2R^2 + 2a^2 - \\frac{3}{2}R^2 = \\frac{1}{2}R^2 + 2a^2 = \\frac{R^2+4a^2}{2}\n$$\n将此结果代回导数表达式：\n$$\n\\frac{dL_{z,c}}{dR} = \\sqrt{GM} \\cdot R(R^2+a^2)^{-7/4} \\left( \\frac{R^2+4a^2}{2} \\right) = \\frac{\\sqrt{GM} R(R^2+4a^2)}{2(R^2+a^2)^{7/4}}\n$$\n由于 $R, a, G, M$ 均为正数，所以 $dL_{z,c}/dR > 0$，因此我们可以去掉绝对值符号。\n\n**第三步：组合得到 $\\mathcal{F}(R)$ 的最终表达式**\n\n现在将 $\\Sigma(R)$ 和 $dL_{z,c}/dR$ 的表达式代入 $\\mathcal{F}(R)$ 的公式中。\n分子是 $2\\pi R \\Sigma(R)$：\n$$\n2\\pi R \\Sigma(R) = 2\\pi R \\left( \\frac{Ma}{2\\pi (R^2+a^2)^{3/2}} \\right) = \\frac{MaR}{(R^2+a^2)^{3/2}}\n$$\n现在除以 $dL_{z,c}/dR$：\n$$\n\\mathcal{F}(R) = \\frac{\\frac{MaR}{(R^2+a^2)^{3/2}}}{\\frac{\\sqrt{GM} R(R^2+4a^2)}{2(R^2+a^2)^{7/4}}}\n$$\n$$\n\\mathcal{F}(R) = \\frac{MaR}{(R^2+a^2)^{3/2}} \\cdot \\frac{2(R^2+a^2)^{7/4}}{\\sqrt{GM} R(R^2+4a^2)}\n$$\n消去 $R$ 项，并合并涉及 $M$ 和 $a$ 的项：\n$$\n\\mathcal{F}(R) = \\frac{2Ma}{\\sqrt{GM}(R^2+4a^2)} \\cdot \\frac{(R^2+a^2)^{7/4}}{(R^2+a^2)^{3/2}}\n$$\n简化指数 ($3/2 = 6/4$)：\n$$\n\\mathcal{F}(R) = \\frac{2\\sqrt{M}a}{\\sqrt{G}(R^2+4a^2)} \\cdot (R^2+a^2)^{7/4 - 6/4} = \\frac{2\\sqrt{M}a}{\\sqrt{G}(R^2+4a^2)} (R^2+a^2)^{1/4}\n$$\n所以最终表达式为：\n$$\n\\mathcal{F}(R) = \\frac{2 M a (R^2+a^2)^{1/4}}{\\sqrt{G M} (R^2+4a^2)}\n$$", "answer": "$$\n\\boxed{\\frac{2 M a (R^2+a^2)^{1/4}}{\\sqrt{G M} (R^2+4a^2)}}\n$$", "id": "285471"}]}