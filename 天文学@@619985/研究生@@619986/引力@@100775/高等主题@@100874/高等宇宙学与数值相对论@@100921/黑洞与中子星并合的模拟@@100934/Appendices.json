{"hands_on_practices": [{"introduction": "在数值相对论中，模拟含有黑洞的时空是核心挑战之一，其主要障碍在于如何处理黑洞中心的物理奇点。一个强大的技术是“穿刺法”（puncture method），它结合“3+1分解”将时空切片。通过巧妙选择共形因子 $\\psi(r)$，例如构建所谓的“小号”（trumpet）切片，可以将奇点在空间上“推”到无穷远的固有距离处，从而使其位于计算区域之外。这项练习 [@problem_id:906998] 将带你通过一个具体的计算，深入理解这一过程：你将通过对空间度规进行积分来计算固有距离，从而亲身体验共形几何如何帮助我们在模拟中“驯服”黑洞奇点。", "problem": "在时空的3+1分解中，一种用于黑洞数值模拟的常用技术是在每个时间切片上使用共形平坦的空间度规。对于一个质量为 $M$ 的不旋转黑洞，其空间几何可以用一个在类球坐标 $(r, \\theta, \\phi)$ 中的线元来描述：\n$$ dl^2 = \\psi^4(r) (dr^2 + r^2 d\\Omega^2) $$\n其中 $d\\Omega^2 = d\\theta^2 + \\sin^2\\theta d\\phi^2$，且 $\\psi(r)$ 是共形因子。$\\psi(r)$ 的选择对应于 Schwarzschild 时空的一种特定切片。通过将中心奇点推至无限固有时距处来避开它的切片被称为“小号”切片。\n\n位于坐标半径 $r_1$ 和 $r_2$ 的两个球面之间的固有径向距离 $L$ 由沿径向路径对固有时距元积分得到：\n$$ L = \\int_{r_1}^{r_2} \\psi^2(r) dr $$\n\n考虑一个包含中心质量 $M$ 的时空的一个假设的类小号切片，其共形因子的平方由下式给出：\n$$ \\psi^2(r) = 1 + \\frac{M}{r} + \\frac{\\alpha M^2}{(r+\\beta M)^2} $$\n其中 $\\alpha$ 和 $\\beta$ 是给定的正无量纲常数。\n\n计算坐标半径 $r_1 = M$ 的球面和 $r_2 = 2M$ 的球面之间的固有径向距离 $L$。将你的答案表示为一个以质量 $M$ 以及常数 $\\alpha$ 和 $\\beta$ 表示的闭式表达式。", "solution": "1. 将积分写成和的形式：\n$$L=\\int_{M}^{2M}\\Bigl(1+\\frac{M}{r}+\\frac{\\alpha M^2}{(r+\\beta M)^2}\\Bigr)dr\n=\\int_{M}^{2M}dr+\\int_{M}^{2M}\\frac{M}{r}dr+\\int_{M}^{2M}\\frac{\\alpha M^2}{(r+\\beta M)^2}dr.$$\n\n2. 逐项积分：\n$$\\int dr=r,\\quad\n\\int\\frac{M}{r}dr=M\\ln r,\\quad\n\\int\\frac{\\alpha M^2}{(r+\\beta M)^2}dr\n=-\\frac{\\alpha M^2}{r+\\beta M}.$$\n\n3. 合并并计算从 $r=M$ 到 $r=2M$ 的定积分：\n$$L=\\Bigl[r+M\\ln r-\\frac{\\alpha M^2}{r+\\beta M}\\Bigr]_{M}^{2M}.$$\n当 $r=2M$ 时：\n$$2M+M\\ln(2M)-\\frac{\\alpha M^2}{2M+\\beta M}\n=2M+M(\\ln2+\\ln M)-\\frac{\\alpha M}{2+\\beta}.$$\n当 $r=M$ 时：\n$$M+M\\ln M-\\frac{\\alpha M^2}{M+\\beta M}\n=M+M\\ln M-\\frac{\\alpha M}{1+\\beta}.$$\n用上限值减去下限值：\n$$L=\\bigl(2M+M\\ln2+M\\ln M-\\frac{\\alpha M}{2+\\beta}\\bigr)\n-\\bigl(M+M\\ln M-\\frac{\\alpha M}{1+\\beta}\\bigr)$$\n$$=M+M\\ln2\n+\\alpha M\\Bigl(\\frac{1}{1+\\beta}-\\frac{1}{2+\\beta}\\Bigr)\n=M\\Bigl(1+\\ln2+\\frac{\\alpha}{(1+\\beta)(2+\\beta)}\\Bigr).$$", "answer": "$$\\boxed{M\\Bigl(1+\\ln2+\\frac{\\alpha}{(1+\\beta)(2+\\beta)}\\Bigr)}$$", "id": "906998"}, {"introduction": "致密天体并合过程会产生强烈的激波，精确地捕捉这些激波而不引入数值噪音是模拟成功的关键。这项练习 [@problem_id:906993] 让你直接接触现代激波捕捉方案的核心机制——加权基本无振荡（WENO）重构。通过为一个理想化的激波剖面计算WENO的非线性权值，你将揭示该方法如何“智能”地识别间断，并自动调整其模板以保持解的稳定性和准确性，这是理解和开发高保真度流体动力学代码的一项基本功。", "problem": "在相对论天体物理现象（例如黑洞或中子星并合）的数值模拟中，高阶、激波捕捉的数值方法对于精确演化广义相对论流体动力学方程至关重要。加权本质无振荡 (WENO) 重构是一种广泛使用的技术，它可以在解的光滑区域实现高阶精度，同时避免在激波阵面等间断附近产生伪振荡。\n\n本问题涉及5阶精度的WENO格式 (WENO5)。考虑一个网格间距为 $\\Delta x$ 的均匀一维网格。标量流体变量 $q$ 在网格单元 $i$ 上的网格平均值记为 $q_i$。WENO5 格式通过组合三个3阶多项式重构来重构在网格单元 $i$ 和 $i+1$ 之间的界面 $x_{i+1/2}$ 处 $q$ 的值，每个多项式重构基于一个不同的3单元子模板：$S_0 = \\{q_{i-2}, q_{i-1}, q_i\\}$，$S_1 = \\{q_{i-1}, q_i, q_{i+1}\\}$ 和 $S_2 = \\{q_i, q_{i+1}, q_{i+2}\\}$。\n\n重构值由一个加权平均给出：\n$$\nq_{i+1/2} = w_0 \\hat{q}_0 + w_1 \\hat{q}_1 + w_2 \\hat{q}_2\n$$\n其中 $\\hat{q}_k$ 是从第 $k$ 个子模板的重构多项式获得的值。\n非线性权重 $w_k$ 是 WENO 方法的核心。它们的计算方式如下：\n$$\nw_k = \\frac{\\alpha_k}{\\sum_{j=0}^{2} \\alpha_j} \\quad , \\quad \\alpha_k = \\frac{d_k}{(\\epsilon + \\beta_k)^p}\n$$\n此处，$d_k$ 是对于光滑解能得到5阶精度的最优权重。对于界面 $x_{i+1/2}$，这些权重为 $d_0 = 1/10$，$d_1 = 6/10$ 和 $d_2 = 3/10$。参数 $p$ 通常设为 $p=2$。小常数 $\\epsilon > 0$ 用于防止除以零。量 $\\beta_k$ 是每个子模板的光滑度指示因子，定义如下：\n$$\n\\begin{aligned}\n\\beta_0 &= \\frac{13}{12}(q_{i-2} - 2q_{i-1} + q_i)^2 + \\frac{1}{4}(q_{i-2} - 4q_{i-1} + 3q_i)^2 \\\\\n\\beta_1 &= \\frac{13}{12}(q_{i-1} - 2q_i + q_{i+1})^2 + \\frac{1}{4}(q_{i-1} - q_{i+1})^2 \\\\\n\\beta_2 &= \\frac{13}{12}(q_i - 2q_{i+1} + q_{i+2})^2 + \\frac{1}{4}(3q_i - 4q_{i+1} + q_{i+2})^2\n\\end{aligned}\n$$\n这些指示因子衡量解在每个模板上的振荡程度。在光滑区域，$\\beta_k$ 很小，且 $w_k \\approx d_k$。在间断附近，跨越间断的模板的 $\\beta_k$ 会变得很大，其对应的权重 $w_k$ 会变得非常小。\n\n**问题：**\n考虑一个5单元模板 $\\{i-2, i-1, i, i+1, i+2\\}$，它描述了相对论流体的静质量密度 $\\rho$ 跨越位于界面 $x_{i+1/2}$ 的定常激波阵面的分布。网格平均值由下式给出：\n$$\n\\rho_{i-2} = \\rho_L, \\quad \\rho_{i-1} = \\rho_L, \\quad \\rho_i = \\rho_L, \\quad \\rho_{i+1} = \\rho_R, \\quad \\rho_{i+2} = \\rho_R\n$$\n其中 $\\rho_L$ 和 $\\rho_R$ 分别是激波左右两侧的恒定密度状态。\n\n使用 $p=2$ 的 WENO5 公式，确定在界面 $x_{i+1/2}$ 处重构的非线性权重 $w_1$。你的最终答案应该是一个用 $\\rho_L$、$\\rho_R$ 和参数 $\\epsilon$ 表示的符号表达式。", "solution": "1. 定义 $\\Delta\\rho=\\rho_R-\\rho_L$。\n2. 计算光滑度指示因子：\n   $$\n   \\beta_0=0,\\quad\n   \\beta_1=\\frac{4}{3}\\,\\Delta\\rho^2,\\quad\n   \\beta_2=\\frac{10}{3}\\,\\Delta\\rho^2.\n   $$\n3. 计算 $\\alpha_k$：\n   $$\n   \\alpha_0=\\frac{1/10}{(\\epsilon+0)^2}\n             =\\frac{1}{10\\,\\epsilon^2},\\quad\n   \\alpha_1=\\frac{6/10}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2}\n             =\\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2},\n   $$\n   $$\n   \\alpha_2=\\frac{3/10}{\\bigl(\\epsilon+\\tfrac{10}{3}\\Delta\\rho^2\\bigr)^2}.\n   $$\n4. 构造非线性权重 $w_1$：\n   $$\n   w_1\n   =\\frac{\\alpha_1}{\\alpha_0+\\alpha_1+\\alpha_2}\n   =\\frac{\\displaystyle \\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2}}\n         {\\displaystyle \\frac{1}{10\\,\\epsilon^2}\n          +\\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2}\n          +\\frac{3/10}{\\bigl(\\epsilon+\\tfrac{10}{3}\\Delta\\rho^2\\bigr)^2}}.\n   $$\n5. 将 $\\Delta\\rho=\\rho_R-\\rho_L$ 代回。", "answer": "$$\\boxed{\\frac{\\displaystyle \\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}(\\rho_R-\\rho_L)^2\\bigr)^2}}\n{\\displaystyle \\frac{1}{10\\,\\epsilon^2}\n+\\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}(\\rho_R-\\rho_L)^2\\bigr)^2}\n+\\frac{3/10}{\\bigl(\\epsilon+\\tfrac{10}{3}(\\rho_R-\\rho_L)^2\\bigr)^2}}}$$", "id": "906993"}, {"introduction": "模拟的鲁棒性是数值相对论中的一个关键问题。代码演化的是“守恒”变量（如能量密度 $\\tau$），但物理定律则由“原始”变量（如压力 $p$ 和速度 $v$）描述。即使数值方案本身是稳定的，演化过程中产生的微小误差也可能导致守恒变量进入“非物理”区域，此时我们无法恢复出对应的物理状态。这个问题 [@problem_id:906980] 让你直面这一“从守恒量到原始量”的恢复挑战，通过推导一个特定条件下恢复失败的判据，你将理解为何以及何时数值模拟会“崩溃”。这有助于培养对数值模拟局限性的深刻认识，并揭示了确保代码稳定运行所需的“物理性”约束的重要性。", "problem": "在相对论流体的数值模拟中，一个关键步骤是“原始变量恢复”，即从代码演化的守恒变量中确定压强($p$)和洛伦兹因子($W$)等物理量。对于某些物理状态，此恢复过程可能会失败，这表明模型失效或由于数值误差出现了非物理条件。\n\n考虑一个一维、非磁化的相对论辐射流体。这种流体由伽马定律状态方程描述，该方程通过 $p = (\\Gamma-1)\\mathcal{E}$ 将其压强 $p$ 与其共动参考系能量密度 $\\mathcal{E}$ 关联，其中绝热指数 $\\Gamma \\in (1, 2]$ 为常数。广义相对论定义了以下实验室参考系守恒量（在单位制 $c=1$ 下）：\n- 守恒能量密度，$\\tau = W^2 (\\mathcal{E} + p) - p$。\n- 守恒动量密度，$S = W^2 (\\mathcal{E} + p) v$。\n\n此处，$W = (1-v^2)^{-1/2}$ 是流体的洛伦兹因子，$v$ 是其速度。\n\n原始变量恢复过程涉及从已知的守恒变量（$\\tau$, $S$）求解原始变量（$p$, $v$, $\\mathcal{E}$）。组合以上方程可导出一个关于洛伦兹因子 $W$ 的代数方程。可以证明，这是一个关于 $x = W^2$ 的二次方程。\n\n您的任务是找到一个判据，该判据表示为一个包含比值 $S^2/\\tau^2$ 和绝热指数 $\\Gamma$ 的不等式，当此判据成立时，该关于 $x=W^2$ 的二次方程没有实数解。这种情况代表了一种无法恢复出自洽物理原始量的状态。", "solution": "相关方程：\n$$p=(\\Gamma-1)\\mathcal{E},\\quad\n\\tau=W^2(\\mathcal{E}+p)-p,\\quad\nS=W^2(\\mathcal{E}+p)\\,v,\\quad\nW^2=x,\\quad v=\\sqrt{1-\\frac1x}.$$\n\n1. 写出 $\\mathcal{E}+p=\\Gamma\\mathcal{E}$ 和 $p=\\mathcal{E}(\\Gamma-1)$，于是：\n$$\\tau=x\\,\\Gamma\\mathcal{E}-p,\\quad S=x\\,\\Gamma\\mathcal{E}\\,\\sqrt{1-\\frac1x}.$$\n\n2. 从 $\\tau$ 解出 $p$：\n$$\\tau=x\\,\\frac{\\Gamma p}{\\Gamma-1}-p\n\\;\\Longrightarrow\\;p\n=\\frac{\\tau(\\Gamma-1)}{\\Gamma x-(\\Gamma-1)}.$$\n\n3. 对 $S$ 求平方：\n$$S^2\n=\\Bigl(x\\,\\frac{\\Gamma p}{\\Gamma-1}\\Bigr)^{2}\\Bigl(1-\\frac1x\\Bigr)\n=\\frac{\\Gamma^2\\,p^2}{(\\Gamma-1)^2}\\,x(x-1).$$\n\n4. 定义 $\\sigma=\\frac{S^2}{\\tau^2}$ 并代入 $p$：\n$$\\sigma\n=\\frac{\\Gamma^2\\,x(x-1)}{\\bigl(\\Gamma x-(\\Gamma-1)\\bigr)^2}.$$\n\n5. 展开以得到关于 $x$ 的二次方程：\n$$\\sigma\\bigl(\\Gamma x-(\\Gamma-1)\\bigr)^2=\\Gamma^2x(x-1)\n\\;\\Longrightarrow\\;\nA\\,x^2+B\\,x+C=0,$$\n其中：\n$$A=\\Gamma^2(\\sigma-1),\\quad\nB=\\Gamma^2-2\\Gamma(\\Gamma-1)\\sigma,\\quad\nC=(\\Gamma-1)^2\\sigma.$$\n\n6. 计算判别式 $\\Delta=B^2-4AC$：\n\n$$\n\\Delta\n=\\Gamma^2\\Bigl[\\Gamma-2(\\Gamma-1)\\sigma\\Bigr]^2\n-4\\,\\Gamma^2(\\sigma-1)(\\Gamma-1)^2\\sigma\n=\\Gamma^2\\bigl[\\Gamma^2-4(\\Gamma-1)\\sigma\\bigr].\n$$\n\n\n7. 当 $\\Delta<0$ 时无实数解：\n$$\\Gamma^2-4(\\Gamma-1)\\sigma<0\n\\;\\Longrightarrow\\;\n\\sigma>\\frac{\\Gamma^2}{4(\\Gamma-1)}.$$\n因此失效判据为：\n$$\\frac{S^2}{\\tau^2}>\\frac{\\Gamma^2}{4(\\Gamma-1)}.$$", "answer": "$$\\boxed{\\frac{S^2}{\\tau^2}>\\frac{\\Gamma^2}{4(\\Gamma-1)}}$$", "id": "906980"}]}