{"hands_on_practices": [{"introduction": "在深入研究复杂的计算之前，物理学家的第一步往往是理解一个问题的基本尺度。黑洞并合后的“铃振”过程由最极端的引力所主导。本练习将运用量纲分析这一强大工具，推导该过程的特征时间尺度。仅使用基本常数 $G$ 和 $c$ 以及黑洞质量 $M$，你将揭示出铃振黑洞的内在“时钟”，为后续所有分析提供基础性的物理直觉。[@problem_id:1890737]", "problem": "在经历了一次灾变事件（例如与另一个致密天体并合）之后，一个质量为 $M$ 的不旋转黑洞会发生畸变。随后，它以引力波的形式辐射能量，最终稳定到其最终的、宁静态的球形状态。这个过程被称为黑洞“铃振 (ringdown)”，类似于被敲击的钟在振动衰减时辐射声音。\n\n基于基本原理，推导这个铃振过程的特征时标 $\\tau$ 的符号表达式。你的表达式应仅用黑洞的质量 $M$、引力常数 $G$ 和真空中的光速 $c$ 来构建。", "solution": "在真空中，一个不旋转的（史瓦西）黑洞完全由其质量 $M$ 所刻画。在广义相对论中，对于这样的系统，除了可以由 $M$、引力常数 $G$ 和光速 $c$ 构成的长度或时间标度之外，不存在其他额外的长度或时间标度。铃振过程由准简正模所主导，其频率和阻尼时间由近视界曲率标度决定，因此特征时标 $\\tau$ 必须通过量纲分析由 $G$、$M$ 和 $c$ 构建。\n\n寻求一个具有时间量纲的 $G^{a} M^{b} c^{d}$ 形式的组合。使用质量 $\\mathcal{M}$、长度 $L$ 和时间 $T$ 的基本量纲，\n$$\n[G] = L^{3}\\mathcal{M}^{-1} T^{-2}, \\quad [M] = \\mathcal{M}, \\quad [c] = L T^{-1}.\n$$\n因此，\n$$\n[G^{a} M^{b} c^{d}] = L^{3a + d} \\mathcal{M}^{-a + b} T^{-2a - d}.\n$$\n要求其具有时间的量纲，即 $L^{0}\\mathcal{M}^{0}T^{1}$，可以得到以下方程组：\n$$\n3a + d = 0, \\quad -a + b = 0, \\quad -2a - d = 1.\n$$\n求解可得\n$$\na = 1, \\quad b = 1, \\quad d = -3,\n$$\n因此，唯一的时标（不计一个无量纲因子）是\n$$\n\\tau \\propto \\frac{G M}{c^{3}}.\n$$\n这与物理直觉相符，即铃振时标是由引力半径的光跨越时间决定的。引力半径 $r_{s} = \\frac{2GM}{c^{2}}$ 意味着光跨越时间为 $t_{\\text{lc}} = \\frac{r_{s}}{c} = \\frac{2GM}{c^{3}}$，即与 $\\frac{GM}{c^{3}}$ 具有相同的数量级。详细的微扰理论为给定的准简正模确定了一个具体的无量纲系数，但从基本原理和量纲推断来看，特征时标由下式决定：\n$$\n\\tau = \\frac{G M}{c^{3}}，\n$$\n此处不计一个取决于具体模式的、数量级为 1 的无量纲因子。", "answer": "$$\\boxed{\\frac{G M}{c^{3}}}$$", "id": "1890737"}, {"introduction": "广义相对论预言，受扰动的黑洞其铃振信号会像钟声的纯音一样指数衰减。但如果我们观测到不同的现象，我们该如何分辨？这项实践通过一个思想实验来探讨宇宙监督猜想的可观测后果。你将定量比较克尔黑洞准正规模的标准指数衰减与一个来自裸奇点的假设性幂律衰减。这个练习能够锻炼你将理论假设与独特、可测量的信号特征联系起来的能力，这是利用引力波检验基本物理学的一项关键技能。[@problem_id:1858156]", "problem": "根据广义相对论中的弱宇宙监督猜想，由引力坍缩形成的奇点必须被隐藏在事件视界之内，从而形成一个黑洞。这种黑洞的最终状态是一个克尔黑洞，其特征仅由其质量和自旋决定。从克尔黑洞形成过程中发出的引力波（GW）信号，预计会以一个“铃振”阶段结束，此阶段的信号是被称为准简正模的阻尼正弦波的叠加。\n\n让我们考虑双致密天体并合事件并合后阶段的两种假设情景。\n情景 A（黑洞）：形成一个稳定的克尔黑洞。在并合之后，主导引力波模式的应变振幅 $A_{BH}(t)$ 随时间 $t$ 按以下模型指数衰减：\n$$A_{BH}(t) = A_0 \\exp(-t/\\tau)$$\n其中 $A_0$ 是 $t=0$ 时的初始振幅，$\\tau$ 是基准简正模的特征阻尼时间尺度。\n\n情景 B（裸奇点）：坍缩过程违反了宇宙监督猜想，形成了一个裸奇点。据推测，这种缺乏视界的天体会以复杂的方式与周围场相互作用，导致其引力波信号的衰减慢得多。其主导引力波信号振幅 $A_{NS}(t)$ 的简化模型为幂律衰减：\n$$A_{NS}(t) = A_0 \\left(1 + \\frac{t}{t_0}\\right)^{-\\gamma}$$\n其中 $t_0$ 是奇点的特征时间尺度，$\\gamma$ 是一个控制衰减率的正无量纲指数。假设初始振幅 $A_0$ 与情景 A 中的相同。\n\n为了提供一个区分这两种情景的观测判据，一个有用的量是信号的振幅半衰期 $t_{1/2}$，其定义为信号振幅衰减到其初始值一半 $A_0/2$ 所需的时间。\n\n计算无量纲比率 $R = \\frac{t_{1/2, NS}}{t_{1/2, BH}}$，其中 $t_{1/2, NS}$ 是裸奇点情景的半衰期，$t_{1/2, BH}$ 是黑洞情景的半衰期。请用 $\\tau$、$t_0$ 和 $\\gamma$ 的符号表达式来表示你的答案。", "solution": "振幅半衰期 $t_{1/2}$ 由振幅等于 $A_{0}/2$ 的条件定义。\n\n对于情景 A（黑洞），振幅为 $A_{BH}(t)=A_{0}\\exp(-t/\\tau)$。设 $A_{BH}(t_{1/2,BH})=A_{0}/2$ 可得\n$$\nA_{0}\\exp\\!\\left(-\\frac{t_{1/2,BH}}{\\tau}\\right)=\\frac{A_{0}}{2}.\n$$\n两边同除以 $A_{0}$ 得\n$$\n\\exp\\!\\left(-\\frac{t_{1/2,BH}}{\\tau}\\right)=\\frac{1}{2}.\n$$\n取自然对数并求解 $t_{1/2,BH}$，\n$$\n-\\frac{t_{1/2,BH}}{\\tau}=\\ln\\!\\left(\\frac{1}{2}\\right)=-\\ln 2\n\\quad\\Rightarrow\\quad\nt_{1/2,BH}=\\tau\\ln 2.\n$$\n\n对于情景 B（裸奇点），振幅为 $A_{NS}(t)=A_{0}\\left(1+\\frac{t}{t_{0}}\\right)^{-\\gamma}$。设 $A_{NS}(t_{1/2,NS})=A_{0}/2$ 可得\n$$\nA_{0}\\left(1+\\frac{t_{1/2,NS}}{t_{0}}\\right)^{-\\gamma}=\\frac{A_{0}}{2}.\n$$\n两边同除以 $A_{0}$ 并取倒数，\n$$\n\\left(1+\\frac{t_{1/2,NS}}{t_{0}}\\right)^{\\gamma}=2.\n$$\n两边取 $1/\\gamma$ 次方并求解 $t_{1/2,NS}$，\n$$\n1+\\frac{t_{1/2,NS}}{t_{0}}=2^{1/\\gamma}\n\\quad\\Rightarrow\\quad\nt_{1/2,NS}=t_{0}\\left(2^{1/\\gamma}-1\\right).\n$$\n\n所求的比率为\n$$\nR=\\frac{t_{1/2,NS}}{t_{1/2,BH}}=\\frac{t_{0}\\left(2^{1/\\gamma}-1\\right)}{\\tau\\ln 2}.\n$$", "answer": "$$\\boxed{\\frac{t_{0}}{\\tau}\\,\\frac{2^{1/\\gamma}-1}{\\ln 2}}$$", "id": "1858156"}, {"introduction": "“无毛定理”是黑洞理论的核心支柱之一，它指出一个最终形成的黑洞仅由其质量和自旋决定。对铃振阶段的引力波观测为我们直接检验该定理提供了可能。这项高级计算实践要求你建立一个迷你的引力波数据分析流程。你将模拟铃振信号，在噪声存在的情况下对其进行拟合，并推断出最终黑洞的属性。通过比较由不同并合事件（理论上应产生相同的最终黑洞）推断出的属性，你将模拟一次对无毛定理的真实检验，从而在抽象理论与实际的数据驱动科学之间架起一座桥梁。[@problem_id:2399211]", "problem": "您将设计并实现一个计算实验，用以检验来自致密双星并合的引力波铃振（ringdown）阶段中的黑洞“无毛”定理。“无毛”定理断言，一个天体物理黑洞的外部时空完全由一小组宏观参数来表征。对于电荷可忽略不计的天体物理现实情景，这些参数是最终黑洞的质量和无量纲自旋。在并合后的铃振阶段，引力微扰可以很好地用一组阻尼正弦波的叠加来描述，这组正弦波被称为准简正模（quasi-normal mode），其频率和阻尼时间仅取决于最终黑洞的质量和自旋。\n\n从以下基本依据出发：\n- 在克尔（Kerr）黑洞的线性微扰理论中，微扰遵循一个可分离的波动方程，且晚期信号是一系列阻尼正弦波（准简正模）的叠加。量纲分析表明，对于固定的无量纲自旋，准简正模的频率与黑洞质量成反比。品质因子的定义关联了实频率和阻尼时间。\n- 使用球谐指数 $(\\ell, m, n) = (2, 2, 0)$ 的主导准简正模作为每个事件的信号模型，其在时域中建模为 $h(t) = A \\exp(-t/\\tau) \\cos(2 \\pi f t + \\phi)$（对于 $t \\ge 0$），其中 $A$ 是总振幅，$f$ 是以赫兹为单位的实频率，$\\tau$ 是以秒为单位的阻尼时间，$\\phi$ 是以弧度为单位的恒定相位。\n- 使用针对 $(2, 2, 0)$ 模式的无量纲角频率和品质因子的成熟拟合函数，它们表示为无量纲自旋 $\\chi \\in [0, 1)$ 的函数：\n  $$M \\omega_{22}(\\chi) = 1.5251 - 1.1568 \\left(1 - \\chi\\right)^{0.1292},$$\n  $$Q_{22}(\\chi) = 0.7000 + 1.4187 \\left(1 - \\chi\\right)^{-0.4990}.$$\n  此处 $M \\omega_{22}$ 是无量纲角频率（在 $G = c = 1$ 的几何单位制下）。使用以下公式从无量纲量转换为物理单位：\n  $$f = \\frac{c^3}{2 \\pi G M} \\left(M \\omega_{22}(\\chi)\\right), \\quad \\tau = \\frac{Q_{22}(\\chi)}{\\pi f},$$\n  其中 $G$ 是引力常数，$c$ 是光速，$M$ 是最终黑洞的质量。使用 $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m}^3\\ \\mathrm{kg}^{-1}\\ \\mathrm{s}^{-2}$，$c = 2.99792458 \\times 10^{8}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$，以及太阳质量 $M_{\\odot} = 1.98847 \\times 10^{30}\\ \\mathrm{kg}$。质量以 $M_{\\odot}$ 为单位表示，时间以秒为单位；角度以弧度为单位。\n\n您的任务：\n- 针对下方的每个测试案例，模拟两个独立的铃振信号（两个不同的并合事件），它们的振幅和相位可能不同，但每对事件中的每个事件都具有指定的最终质量和自旋参数。每个信号都是一个从 $t=0$ 开始的单一 $(2, 2, 0)$ 阻尼正弦波，并叠加了零均值高斯白噪声。使用采样频率 $f_{\\mathrm{s}} = 4096\\ \\mathrm{Hz}$ 和总时长 $T = 0.1\\ \\mathrm{s}$。噪声标准差是给定的参数，单位为应变振幅。角度必须以弧度处理。\n- 对于每个事件，通过将含噪时间序列与单一阻尼正弦波模型进行拟合，來估计模式参数 $(f, \\tau)$。然后，使用测得的 $(f, \\tau)$ 推断最终的无量纲自旋 $\\chi$ 和质量 $M$，具体步骤如下：计算测得的品质因子 $Q_{\\mathrm{meas}} = \\pi f \\tau$，并反演 $Q_{22}(\\chi)$ 以确定 $\\chi$；然后，使用测得的 $f$ 和推断出的 $\\chi$，根据频率标度关系计算 $M$。以 $M_{\\odot}$ 为单位报告 $M$。\n- 为每个测试案例设计一个无毛定理一致性判定，定义如下：给定来自两个事件的两个推断结果 $(M_1, \\chi_1)$ 和 $(M_2, \\chi_2)$，如果相对质量差异满足 $\\lvert M_1 - M_2 \\rvert / \\left( \\frac{M_1 + M_2}{2} \\right) \\le 0.02$ 且绝对自旋差异满足 $\\lvert \\chi_1 - \\chi_2 \\rvert \\le 0.02$，则返回真（true），否则返回假（false）。\n\n物理单位和角度单位要求：\n- 在所有阶段，频率必须以赫兹为单位，时间以秒为单位，报告的质量以 $M_{\\odot}$ 为单位，角度以弧度解释。\n\n测试套件：\n- 使用以下三个案例，每个案例由一对事件定义，其参数为 $(M/M_{\\odot}, \\chi, A, \\phi, \\sigma)$，其中 $M$ 是以 $M_{\\odot}$ 为单位的最终质量，$\\chi$ 是无量纲自旋，$A$ 是振幅，$\\phi$ 是以弧度为单位的相位，$\\sigma$ 是高斯白噪声的标准差：\n  - 案例1：\n    - 事件 $\\mathrm{A1}$: $(60, 0.70, 1.0, 0.3, 1.0 \\times 10^{-3})$，\n    - 事件 $\\mathrm{A2}$: $(60, 0.70, 0.7, 2.1, 1.0 \\times 10^{-3})$。\n  - 案例2：\n    - 事件 $\\mathrm{B1}$: $(60, 0.70, 1.0, 1.0, 1.0 \\times 10^{-3})$，\n    - 事件 $\\mathrm{B2}$: $(60, 0.65, 0.8, 2.3, 1.0 \\times 10^{-3})$。\n  - 案例3：\n    - 事件 $\\mathrm{C1}$: $(60, 0.70, 1.0, 0.1, 1.0 \\times 10^{-3})$，\n    - 事件 $\\mathrm{C2}$: $(58, 0.70, 0.9, 1.7, 1.0 \\times 10^{-3})$。\n\n程序要求：\n- 实现一个完整、可运行的程序，该程序执行模拟、参数估计、从 $(f, \\tau)$ 到 $(\\chi, M)$ 的反演，并为上述三个案例中的每一个做出最终的无毛定理一致性判定。\n- 为确保可复现性，要求使用确定性噪声；选择一个固定的随机数生成器种子并在代码中注明。\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果，例如 `[true,false,true]`，但要使用实际的 Python 布尔值大小写格式且无空格。输出必须是一个包含三个布尔值的列表，按顺序对应于三个案例。\n\n交付物：\n- 一个独立的程序，无需用户输入即可模拟信号、执行估计和反演，并按规定格式输出单行结果。", "solution": "该问题陈述已经过严格审查，并被确定为有效。它构成了一个在引力波物理学领域内适定（well-posed）且具有科学依据的计算实验。其内容没有矛盾、歧义或事实错误。任务是使用一个标准的、简化的双星并合铃振阶段模型，来模拟对黑洞无毛定理（广义相对论的基石之一）的检验。所有必需的物理常数、数学模型和数值参数均已提供。因此，我们可以着手进行求解。\n\n该解决方案的结构是一个计算流程，包括信号模拟、参数估计，以及基于黑洞微扰理论原理的最终一致性检验。\n\n首先，我们建立理论基础。无毛定理假定，一个稳态、孤立、不带电的黑洞完全由其质量 $M$ 和自旋角动量 $J$ 描述。无量纲自旋参数定义为 $\\chi = cJ/(GM^2)$，其中 $\\chi \\in [0, 1)$。克尔（Kerr）时空几何的微扰，例如在双星并合后产生的微扰，会以引力波的形式辐射出去。在晚期的铃振阶段，信号是准简正模（QNM）的叠加，每个准简正模都是一个阻尼正弦波。根据线性微扰理论的预测，这些模式的频率和阻尼时间仅取决于最终黑洞的质量 $M$ 和自旋 $\\chi$。\n\n对于本问题，我们对主导的 $(\\ell, m, n) = (2, 2, 0)$ 准简正模进行建模。其时域表示由下式给出：\n$$h(t) = A e^{-t/\\tau} \\cos(2 \\pi f t + \\phi)$$\n其中 $A$ 是振幅，$f$ 是频率，$\\tau$ 是阻尼时间，$\\phi$ 是相位。参数 $f$ 和 $\\tau$ 并非独立，而是由 $(M, \\chi)$ 决定。问题提供了关于无量纲角频率 $M\\omega_{22}(\\chi)$ 和品质因子 $Q_{22}(\\chi)$ 的唯象拟合公式：\n$$M \\omega_{22}(\\chi) = 1.5251 - 1.1568 (1 - \\chi)^{0.1292}$$\n$$Q_{22}(\\chi) = 0.7000 + 1.4187 (1 - \\chi)^{-0.4990}$$\n这些无量纲量使用基本常数 $G$ 和 $c$ 转换为物理可观测量：\n$$f = \\frac{c^3}{2 \\pi G M} \\left(M \\omega_{22}(\\chi)\\right)$$\n$$\\tau = \\frac{Q_{22}(\\chi)}{\\pi f}$$\n此处，$M$ 是以千克为单位的质量。当以太阳质量 $M_{\\odot}$ 为单位提供质量时，必须进行适当的转换。设 $M_{sol} = M/M_{\\odot}$。频率方程可写为 $f = C_f \\frac{M\\omega_{22}(\\chi)}{M_{sol}}$，其中 $C_f = \\frac{c^3}{2 \\pi G M_{\\odot}}$ 是一个常数。\n\n该计算实验包括以下步骤：\n\n1.  **信号生成（正向问题）**：对于测试案例中指定的每个事件，我们首先根据给定的“真实”参数 $(M, \\chi)$ 计算 $f$ 和 $\\tau$ 的理论值。在此计算中，给定的以太阳质量为单位的质量 $M$ 必须转换为千克。然后，以采样率 $f_s = 4096 \\text{ Hz}$ 生成一个时长为 $T = 0.1 \\text{ s}$ 的离散时间序列。这涉及创建一个时间向量 $t_k = k/f_s$，其中 $k = 0, 1, ..., N-1$ 且 $N = T f_s$。在这些时间点上计算纯净信号 $h(t_k)$。最后，添加零均值高斯白噪声。为保证可复现性，噪声使用固定的随机种子生成，其标准差 $\\sigma$ 在测试案例参数中给出。\n\n2.  **参数估计（反问题，第1部分）**：分析的核心是从含噪数据中估计信号参数。我们将生成的时间序列数据拟合到四参数模型 $h(t; A, f, \\tau, \\phi)$。这是一个非线性最小二乘拟合问题，为此我们采用 Levenberg-Marquardt 算法，具体实现为 `scipy.optimize.curve_fit`。此类拟合的成功与否关键取决于为参数 $(A, f, \\tau, \\phi)$ 提供合理的初始猜测值。振幅 $A$ 的初始猜测可以是数据的最大绝对值。根据问题的物理参数，初始频率 $f \\approx 280\\ \\mathrm{Hz}$ 和阻尼时间 $\\tau \\approx 4\\ \\mathrm{ms}$是合适的。相位可以初始化为 $0$。拟合得到估计参数 $(f_{meas}, \\tau_{meas})$。\n\n3.  **黑洞参数推断（反问题，第2部分）**：利用测得的 $(f_{meas}, \\tau_{meas})$，我们通过反演关系式来推断黑洞参数 $(M_{inf}, \\chi_{inf})$，从而检验无毛定理假设。\n    *   首先，计算测得的品质因子：$Q_{meas} = \\pi f_{meas} \\tau_{meas}$。\n    *   接下来，我们通过求解方程 $Q_{meas} = Q_{22}(\\chi)$ 来得到自旋 $\\chi$。该方程可以解析地反演：\n        $$\\chi_{inf} = 1 - \\left( \\frac{Q_{meas} - 0.7000}{1.4187} \\right)^{-1/0.4990}$$\n        必须遵守物理域 $\\chi \\in [0, 1)$。函数 $Q_{22}(\\chi)$ 在 $\\chi=0$ 时有最小值，约为 $Q_{22}(0) \\approx 2.1187$。如果测量噪声导致 $Q_{meas}  Q_{22}(0)$，该公式将得出非物理的负自旋。在这种情况下，推断出的自旋必须被裁剪到最近的物理值 $\\chi_{inf} = 0$。\n    *   利用推断出的自旋 $\\chi_{inf}$，我们接着计算理论无量纲频率 $M\\omega_{22}(\\chi_{inf})$。\n    *   最后，我们反演频率关系式来求解质量 $M_{inf}$。以太阳质量为单位的质量由下式给出：\n        $$M_{inf}/M_{\\odot} = \\left(\\frac{c^3}{2 \\pi G M_{\\odot}}\\right) \\frac{M\\omega_{22}(\\chi_{inf})}{f_{meas}}$$\n\n4.  **无毛定理一致性判定**：对给定测试案例中的两个事件都执行此过程，得到两组推断参数：$(M_1, \\chi_1)$ 和 $(M_2, \\chi_2)$。根据无毛定理，如果两个信号都源于具有相同质量和自旋的黑洞，那么在统计不确定性范围内，推断出的参数应该是一致的。问题为此一致性定义了一个具体的定量检验：当且仅当相对质量差异和绝对自旋差异都低于指定阈值时，结果为 `true`：\n    $$\\frac{|M_1 - M_2|}{\\frac{1}{2}(M_1 + M_2)} \\le 0.02 \\quad \\text{and} \\quad |\\chi_1 - \\chi_2| \\le 0.02$$\n    否则，结果为 `false`。\n\n对三个测试案例中的每一个都执行这整个序列。最终输出是一个包含三个布尔值的列表，对应于每个案例的一致性检查结果。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Simulates a test of the black hole no-hair theorem for binary merger ringdowns.\n    \"\"\"\n    # Physical constants\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n    C = 2.99792458e8  # m s^-1\n    M_SUN = 1.98847e30  # kg\n\n    # Simulation parameters\n    FS = 4096.0  # Hz\n    T = 0.1  # s\n    MAIN_SEED = 42 # For reproducibility of noise\n\n    # Test cases: (M/M_solar, chi, Amplitude, phase_rad, noise_std)\n    test_cases = [\n        # Case 1\n        [\n            (60.0, 0.70, 1.0, 0.3, 1.0e-3),\n            (60.0, 0.70, 0.7, 2.1, 1.0e-3)\n        ],\n        # Case 2\n        [\n            (60.0, 0.70, 1.0, 1.0, 1.0e-3),\n            (60.0, 0.65, 0.8, 2.3, 1.0e-3)\n        ],\n        # Case 3\n        [\n            (60.0, 0.70, 1.0, 0.1, 1.0e-3),\n            (58.0, 0.70, 0.9, 1.7, 1.0e-3)\n        ]\n    ]\n\n    # Pre-calculated constant for frequency conversion\n    # CF = c^3 / (2 * pi * G * M_sun)\n    CF = C**3 / (2 * np.pi * G * M_SUN)\n\n    def M_omega_22(chi):\n        \"\"\"Dimensionless angular frequency of the (2,2,0) mode.\"\"\"\n        return 1.5251 - 1.1568 * (1 - chi)**0.1292\n\n    def Q_22(chi):\n        \"\"\"Quality factor of the (2,2,0) mode.\"\"\"\n        return 0.7000 + 1.4187 * (1 - chi)**-0.4990\n\n    def model_func(t, A, f, tau, phi):\n        \"\"\"Damped sinusoid model for fitting.\"\"\"\n        return A * np.exp(-t / tau) * np.cos(2 * np.pi * f * t + phi)\n\n    def analyze_event(event_params, event_seed):\n        \"\"\"\n        Generates a noisy signal, fits it, and infers (M, chi).\n        \"\"\"\n        M_sol, chi, A, phi, sigma = event_params\n        \n        # 1. Forward model: Calculate true f and tau\n        f_true = CF * M_omega_22(chi) / M_sol\n        q_true = Q_22(chi)\n        tau_true = q_true / (np.pi * f_true)\n\n        # 2. Generate signal\n        t = np.arange(0, T, 1.0 / FS)\n        h_clean = model_func(t, A, f_true, tau_true, phi)\n        \n        rng = np.random.default_rng(event_seed)\n        noise = rng.normal(0, sigma, len(t))\n        h_noisy = h_clean + noise\n\n        # 3. Parameter estimation\n        # Initial guesses for the fit\n        p0 = [np.max(np.abs(h_noisy)), f_true, tau_true, phi]\n        bounds = ([0, 0, 0, -np.pi], [np.inf, FS / 2, np.inf, np.pi])\n        \n        try:\n            popt, _ = curve_fit(model_func, t, h_noisy, p0=p0, bounds=bounds, maxfev=5000)\n            f_meas, tau_meas = popt[1], popt[2]\n        except RuntimeError:\n            return np.nan, np.nan # Fit failed\n\n        # 4. Inversion to (M, chi)\n        Q_meas = np.pi * f_meas * tau_meas\n        \n        # Invert Q_22(chi) to find chi\n        # chi = 1 - ((Q_meas - 0.7) / 1.4187)^(-1/0.4990)\n        q_arg = (Q_meas - 0.7000) / 1.4187\n        \n        # The minimum physical Q corresponds to chi=0, where q_arg = 1.\n        # If noise causes Q_meas to be too low, q_arg  1, which implies chi  0.\n        # We clip to the physical boundary chi=0.\n        if q_arg = 1.0:\n            chi_inf = 0.0\n        else:\n            chi_inf = 1.0 - q_arg**(-1.0 / 0.4990)\n        \n        # Invert frequency relation for M\n        m_omega_val = M_omega_22(chi_inf)\n        M_inf_sol = CF * m_omega_val / f_meas\n        \n        return M_inf_sol, chi_inf\n\n    results = []\n    event_seed_counter = 0\n    for case in test_cases:\n        event1_params, event2_params = case\n        \n        seed1 = MAIN_SEED + event_seed_counter\n        M1, chi1 = analyze_event(event1_params, seed1)\n        event_seed_counter += 1\n        \n        seed2 = MAIN_SEED + event_seed_counter\n        M2, chi2 = analyze_event(event2_params, seed2)\n        event_seed_counter += 1\n\n        if np.isnan(M1) or np.isnan(M2):\n            is_consistent = False\n        else:\n            # 5. No-hair consistency check\n            mass_diff = np.abs(M1 - M2) / (0.5 * (M1 + M2))\n            spin_diff = np.abs(chi1 - chi2)\n            \n            is_consistent = (mass_diff = 0.02) and (spin_diff = 0.02)\n\n        results.append(is_consistent)\n\n    # Format output as required\n    print(f\"[{','.join(map(str, results))}]\".replace(\"True\", \"true\").replace(\"False\", \"false\"))\n\nsolve()\n```", "id": "2399211"}]}