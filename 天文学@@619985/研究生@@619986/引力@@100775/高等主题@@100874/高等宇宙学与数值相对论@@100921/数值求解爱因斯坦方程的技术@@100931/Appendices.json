{"hands_on_practices": [{"introduction": "在将爱因斯坦方程组转化为可计算的离散形式时，首要的挑战是确保数值方案的稳定性。一个不稳定的方案会产生随时间指数增长的误差，最终导致计算结果毫无意义。本练习将引导你运用冯·诺依曼稳定性分析这一核心工具，推导一个用于演化双曲型方程的常用数值格式的稳定性判据，即著名的Courant-Friedrichs-Lewy (CFL) 条件 [@problem_id:910011]。通过这个简化但极具代表性的“玩具模型”，你将亲手揭示时间步长 $\\Delta t$、空间步长 $\\Delta x$ 以及物理波速之间的深刻制约关系。", "problem": "在数值相对论领域，BSSN (Baumgarte-Shapiro-Shibata-Nakamura) 表述是演化爱因斯坦方程的一种稳健方法。实现此类表述的一个关键方面是确保所选离散化格式的数值稳定性。稳定性分析通常在简化的“玩具模型”上进行，这些模型能捕捉完整系统的基本数学结构。\n\n考虑以下一维线性化玩具模型，它模仿了 BSSN 系统的某些特征，例如引入了辅助变量和平流项。该系统描述了三个场 $u(t,x)$、$v(t,x)$ 和 $q(t,x)$ 的演化：\n$$\n\\begin{aligned}\n\\partial_t u &= -b \\, \\partial_x u + v \\\\\n\\partial_t v &= -b \\, \\partial_x v + c^2 \\, \\partial_x q \\\\\n\\partial_t q &= -b \\, \\partial_x q + \\partial_x v\n\\end{aligned}\n$$\n在此，$c$ 是一个常数正特征速度（$c>0$），$b$ 是一个常数平流速度，类似于广义相对论中移动矢量的一个分量。\n\n该系统将在空间上具有均匀间距 $\\Delta x$、时间上具有均匀间距 $\\Delta t$ 的网格上进行数值求解。所采用的数值格式是一种二阶精度方法，它结合了用于时间演化的蛙跳格式和用于空间导数的中心有限差分近似。具体来说，对于一个通用场矢量 $\\mathbf{U} = (u,v,q)^T$，该格式为：\n$$\n\\frac{\\mathbf{U}^{n+1}_j - \\mathbf{U}^{n-1}_j}{2\\Delta t} = (\\text{RHS})^n_j\n$$\n其中下标 $j$ 和上标 $n$ 分别表示空间和时间网格点，$x_j=j\\Delta x$ 和 $t_n=n\\Delta t$。该偏微分方程系统的右端项 (RHS) 在时间步 $n$ 进行计算，并且所有空间导数 $\\partial_x$ 都由二阶中心差分算子近似：\n$$\n\\partial_x f(t_n, x_j) \\approx \\frac{f^n_{j+1} - f^n_{j-1}}{2\\Delta x}\n$$\n\n你的任务是对此数值格式进行 von Neumann 稳定性分析。确定 Courant-Friedrichs-Lewy (CFL) 稳定性条件。基于此，为使格式对所有可能的波模都保持稳定，库朗数 $\\lambda_C = \\Delta t / \\Delta x$ 的最大允许值是多少？", "solution": "1. 傅里叶符号 $\\xi=\\sin(k\\Delta x)/\\Delta x$，因此右端项矩阵 $L$ 的特征值为 $\\lambda_1=-b i \\xi, \\lambda_{2,3}=-b i \\xi \\pm i c \\xi = -i(b\\mp c) \\xi$。\n2. 蛙跳格式推进 $U^{n+1}=U^{n-1}+2\\Delta t L U^n \\Rightarrow$ 特征方程 $\\zeta^2-2\\Delta t \\lambda \\zeta-1=0 \\Rightarrow \\zeta=\\Delta t\\lambda\\pm\\sqrt{1+(\\Delta t\\lambda)^2}$。\n3. 对于 $\\lambda=i\\omega$，$\\sqrt{1+(\\Delta t\\lambda)^2}=\\sqrt{1-(\\Delta t\\omega)^2}$ 必须为实数 $\\Rightarrow |\\Delta t \\omega|\\le 1$。\n4. 此处 $|\\omega|=|b||\\xi|, |b\\pm c||\\xi| \\le (|b|+c)/\\Delta x$。因此稳定性条件为 $\\Leftrightarrow \\Delta t(|b|+c)/\\Delta x \\le 1 \\Rightarrow \\lambda_C=\\Delta t/\\Delta x \\le 1/(c+|b|)$。", "answer": "$$\\boxed{\\frac{1}{c+|b|}}$$", "id": "910011"}, {"introduction": "确保了基本的稳定性之后，数值相对论学家还必须处理另一个棘手的问题：高阶差分格式在带来更高精度的同时，也常常会引入非物理的高频数值振荡。为了抑制这些振荡，我们通常会人为地在方程中加入“人工耗散”项。这个练习 [@problem_id:910026] 让你深入探究一个精妙的平衡：一方面是数值格式自身导致的数值色散，另一方面是为抑制误差而引入的人工阻尼。通过计算一个特定的耗散系数 $\\epsilon_d$，你将学会如何在不牺牲过多物理精度的情况下，有效地“净化”数值解。", "problem": "在数值相对论领域，通常采用高阶有限差分格式来求解描述引力场演化的双曲型偏微分方程组。为了抑制高频数值不稳定性，通常会在离散化的方程中加入人工耗散项。本问题关注物理波传播的数值色散与此类人工耗散的阻尼效应之间的相互作用。\n\n考虑标量场 $u(t, x)$ 的一维平流方程：\n$$\n\\partial_t u + c \\, \\partial_x u = 0\n$$\n其中 $c > 0$ 为恒定的平流速度。我们使用直线法，即空间被离散化而时间保持连续。设空间网格点为 $x_j = j \\Delta x$，其中 $j$ 为整数。在网格点 $j$ 处，方程的半离散形式由下式给出：\n$$\n\\frac{d u_j}{dt} = -c (D_x u)_j + (Q u)_j\n$$\n空间导数 $\\partial_x$ 由一个具有五点模板的四阶精度中心有限差分算子 $D_x$ 来近似：\n$$\n(D_x u)_j = \\frac{1}{12\\Delta x}(-u_{j+2} + 8u_{j+1} - 8u_{j-1} + u_{j-2})\n$$\n项 $(Q u)_j$ 表示一个六阶 Kreiss-Oliger 人工耗散，定义为：\n$$\n(Q u)_j = \\frac{\\epsilon_d c}{\\Delta x} (D_+ D_-)^3 u_j\n$$\n其中 $\\epsilon_d$ 是一个无量纲耗散参数，$D_+$ 和 $D_-$ 是标准的一阶前向和后向差分算子，$D_+ u_j = u_{j+1} - u_j$ 且 $D_- u_j = u_j - u_{j-1}$。因此，算子 $(D_+ D_-)^3$ 是作为一个十三点模板来应用的。\n\n四阶平流算子会引入数值色散，导致不同的傅里叶模以不同的群速度传播。另一方面，耗散算子以不同的速率对傅里叶模进行阻尼。\n\n你的任务是求出耗散参数 $\\epsilon_d$ 的特定值，在该值下，网格波数为 $\\theta = k \\Delta x = \\pi/2$ 的傅里叶模的 e-折阻尼时间，等于一个波包以数值平流格式所允许的最大群速度大小，行进一个网格间距 $\\Delta x$ 所需的时间。", "solution": "1. 四阶中心差分的修正波数：\n$$\na(\\theta)=\\frac{-e^{2i\\theta}+8e^{i\\theta}-8e^{-i\\theta}+e^{-2i\\theta}}{12\\Delta x}\n=\\frac{i\\bigl(8\\sin\\theta-\\sin2\\theta\\bigr)}{6\\Delta x}.\n$$\n\n2. 色散关系 $\\partial_t u=-c D_x u \\implies \\omega=-\\frac{c}{\\Delta x}A(\\theta)$，其中\n$$\nA(\\theta)=\\frac{8\\sin\\theta-\\sin2\\theta}{6},\\quad\n\\omega=-\\frac{c}{\\Delta x}A(\\theta).\n$$\n\n3. 群速度\n$$\nv_g=\\frac{d\\omega}{dk}\n=-c\\,\\frac{dA}{d\\theta}\n=-c\\,\\frac{4\\cos\\theta-\\cos2\\theta}{3}.\n$$\n令 $x=\\cos\\theta\\in[-1,1]$；则 $4\\cos\\theta-\\cos2\\theta=-2x^2+4x+1$，其在 $[-1,1]$ 上的极值为 $x=1$ 处的 $3$ 和 $x=-1$ 处的 $-5$。因此\n$$\nv_{\\max}=\\frac{5c}{3}.\n$$\n\n4. 穿过一个网格间距的平流时间：\n$$\nt_{\\rm adv}=\\frac{\\Delta x}{v_{\\max}}=\\frac{3\\Delta x}{5c}.\n$$\n\n5. 耗散符号：$D_+D_-=-2(1-\\cos\\theta)\\implies(D_+D_-)^3=-8(1-\\cos\\theta)^3$。于是\n$$\n(Q u)_j=\\frac{\\epsilon_d\\,c}{\\Delta x}(D_+D_-)^3u_j\n=-\\frac{8\\epsilon_d\\,c}{\\Delta x}(1-\\cos\\theta)^3u_j,\n$$\n所以阻尼率为\n$$\n\\gamma(\\theta)=\\frac{8\\epsilon_d\\,c}{\\Delta x}(1-\\cos\\theta)^3,\\quad\n\\tau(\\theta)=\\frac{1}{\\gamma}=\\frac{\\Delta x}{8\\epsilon_d\\,c(1-\\cos\\theta)^3}.\n$$\n在 $\\theta=\\pi/2$ 时，$1-\\cos\\theta=1$，所以 $\\tau=\\Delta x/(8\\epsilon_d\\,c)$。\n\n6. 令阻尼时间等于平流时间：\n$$\n\\frac{\\Delta x}{8\\epsilon_d\\,c}=\\frac{3\\Delta x}{5c}\n\\;\\Longrightarrow\\;\n\\epsilon_d=\\frac{5}{24}.\n$$", "answer": "$$\\boxed{\\frac{5}{24}}$$", "id": "910026"}, {"introduction": "任何数值时空演化的起点都是一个自洽的“初始数据”快照，它必须满足爱因斯坦约束方程。求解这些复杂的椭圆型偏微分方程是数值相对论中的一个核心任务。本练习 [@problem_id:910030] 将带你进入这一领域，为一个运动的黑洞构建初始数据。你将使用强大的谱方法，通过线性化Lichnerowicz-York方程并将其在切比雪夫配置点上离散化，构建求解关键物理量——共形因子 $\\psi$——的矩阵算符。这个过程完美地展示了如何将抽象的数学技巧（如坐标紧致化和谱配置法）应用于广义相对论中的一个具体物理问题。", "problem": "在构建双黑洞并合的初始数据时，必须在三维空间切片上求解爱因斯坦约束方程。Lichnerowicz-York (LY) 方法为求解这些方程提供了一种强大的途径。对于一个共形平坦、极大切片 ($K=0$) 的真空时空初始切片，哈密顿约束简化为一个关于共形因子 $\\psi$ 的非线性椭圆方程，该因子通过 $g_{ij} = \\psi^4 \\delta_{ij}$ 将物理度规 $g_{ij}$ 和平坦共形度规 $\\delta_{ij}$ 联系起来。\n\n对于具有线性动量 $P^i$ 的单个黑洞（一个 Bowen-York 黑洞），LY 方程由下式给出：\n$$ \\nabla^2 \\psi + \\frac{1}{8} \\left(\\hat{A}_{ij}\\hat{A}^{ij}\\right) \\psi^{-7} = 0 $$\n其中 $\\nabla^2$ 是平坦空间拉普拉斯算子，而 $\\hat{A}_{ij}$ 是共形相关的外曲率。对于沿 z 轴大小为 $P$ 的助推，源项为 $\\hat{A}_{ij}\\hat{A}^{ij} = \\frac{9P^2}{2r^4}(1+\\cos^2\\theta)$，其中 $r$ 是迷向径向坐标，$\\theta$ 是极角。\n\n为了数值求解该方程，我们通常通过设置 $\\psi = \\psi_0 + \\delta\\psi$ 将其在近似解 $\\psi_0$ 周围线性化。这产生了一个关于修正项 $\\delta\\psi$ 的线性椭圆方程：\n$$ L[\\delta\\psi] \\equiv \\nabla^2(\\delta\\psi) - \\frac{7}{8}\\left(\\hat{A}_{ij}\\hat{A}^{ij}\\right)\\psi_0^{-8}\\delta\\psi = -\\left( \\nabla^2 \\psi_0 + \\frac{1}{8} \\hat{A}_{ij}\\hat{A}^{ij} \\psi_0^{-7}\\right) $$\n为简单起见，我们用 $\\psi_0=1$ 来近似大半径处的背景解。该问题通常通过将 $\\delta\\psi$ 展开为球谐函数来求解，$\\delta\\psi(r, \\theta) = \\sum_l \\phi_l(r) Y_{l0}(\\theta)$（假设轴对称性）。算子 $L$ 于是成为球谐函数基下的一个矩阵算子。\n\n考虑该算子的对角部分 $L_0$，它作用于球对称 ($l=0$) 的径向函数 $\\phi_0(r)$。该算子通过对势项进行球面平均得到：\n$$ L_0[\\phi_0(r)] = \\left(\\frac{d^2}{dr^2} + \\frac{2}{r}\\frac{d}{dr}\\right)\\phi_0(r) - V_0(r)\\phi_0(r) $$\n其中 $V_0(r)$ 是 $\\frac{7}{8}(\\hat{A}_{ij}\\hat{A}^{ij})\\psi_0^{-8}|_{\\psi_0=1}$ 的球面平均。\n\n该问题定义在半径为 $A$ 的球体外部区域，即 $r \\in [A, \\infty)$。我们使用坐标变换 $r(x) = \\frac{2A}{1+x}$ 来紧致化该区域，它将 $r \\in [A, \\infty)$ 映射到计算域 $x \\in [1, -1]$。然后，径向函数 $\\phi_0(x)$ 由截断的切比雪夫多项式和来近似，$\\phi_0(x) \\approx \\sum_{k=0}^N c_k T_k(x)$。该方程在一组配置点上被强制满足，对于一个 $N$ 阶的基，这些点是切比雪夫-高斯-洛巴托点 $x_j = \\cos(j\\pi/N)$，其中 $j=0, \\dots, N$。\n\n此过程将微分方程转换为一个矩阵方程 $M \\cdot \\vec{c} = \\vec{s}$，其中算子的矩阵元由 $M_{jk} = L_0[T_k(x)]|_{x=x_j}$ 给出。\n\n**您的任务是：对于一个 $N=3$ 阶的基，计算矩阵元 $M_{23}$。**", "solution": "1. 定义 $T_3(x)=4x^3-3x$，所以 $T_3'(x)=12x^2-3$, $T_3''(x)=24x$。\n\n2. 坐标映射：$r(x)=2A/(1+x) \\Rightarrow x=(2A/r)-1$, $dx/dr=-2A/r^2$。\n\n3. 对于 $\\phi(r)=T_3(x(r))$:\n   $d\\phi/dr=T_3'(x)\\cdot dx/dr = -(2A/r^2)T_3'(x)$,\n   $d^2\\phi/dr^2 = d/dr[-2A/r^2 T_3'] = T_3''(x)(dx/dr)(-2A/r^2)+T_3'(x)(4A/r^3) = (4A^2/r^4)T_3''(x)+(4A/r^3)T_3'(x)$。\n\n4. $L_0[\\phi]=d^2\\phi/dr^2+(2/r)d\\phi/dr-V_0\\phi = (4A^2/r^4)T_3'' + (4A/r^3-4A/r^3)T_3' - V_0T_3 = (4A^2/r^4)T_3''(x) - V_0(r)T_3(x)$。\n\n5. 势： $V_0(r)=\\frac{21P^2}{4r^4}$。\n\n6. 在 $x_2=-1/2$ 处 $\\Rightarrow T_3''(x_2)=-12, T_3(x_2)=1, r(-1/2)=4A$。\n\n7. 代入：\n   $M_{23}=(4A^2/(4A)^4)(-12) - (21P^2/(4(4A)^4))(1) = -48A^2/(256A^4) - 21P^2/(1024A^4) = -3/(16A^2) - 21P^2/(1024A^4)$。", "answer": "$$\\boxed{-\\frac{3}{16A^2} - \\frac{21P^2}{1024A^4}}$$", "id": "910030"}]}