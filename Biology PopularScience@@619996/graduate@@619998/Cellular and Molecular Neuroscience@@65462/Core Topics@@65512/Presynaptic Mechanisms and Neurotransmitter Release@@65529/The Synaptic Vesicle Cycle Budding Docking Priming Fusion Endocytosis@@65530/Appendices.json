{"hands_on_practices": [{"introduction": "The finite number of vesicles available for immediate release, known as the readily releasable pool (RRP), is a key factor limiting synaptic output during high-frequency activity. This exercise guides you through a foundational model of vesicle pool dynamics, using first principles of probability to derive the expected depletion of the RRP. Mastering this calculation [@problem_id:2767720] is crucial for building a quantitative understanding of use-dependent synaptic depression.", "problem": "A central synapse contains a readily releasable pool (RRP) of primed synaptic vesicles of size $R_0$ at time $t=0$. A presynaptic train of action potentials is delivered at frequency $f$, comprising $N$ spikes over duration $T = N/f$. Assume the following biologically grounded conditions derived from the synaptic vesicle cycle: (i) vesicles in the RRP are in a primed state and can undergo fusion upon arrival of an action potential; (ii) each action potential elicits fusion of any given primed vesicle with probability $p$ that is constant across spikes and vesicles (no short-term facilitation or depression of $p$); (iii) after fusion, a vesicle is removed from the RRP and cannot fuse again within the train; (iv) there is no replenishment from the reserve pool via docking and priming during the train (endocytosis and re-priming are negligible on the timescale $T$). Using only first principles from probability theory and these mechanistic assumptions about the synaptic vesicle cycle, derive the expected depletion of the RRP after $N$ spikes. Express your final answer as a single closed-form analytic expression in terms of $R_0$, $p$, and $N$, and report it in units of vesicles. No numerical evaluation is required.", "solution": "The problem statement is subjected to validation and is found to be valid. It is scientifically grounded, well-posed, objective, and internally consistent. It represents a standard, simplified model of synaptic vesicle pool dynamics, which is a core topic in cellular and molecular neuroscience. We may thus proceed with the formal derivation.\n\nThe objective is to derive the expected depletion of the readily releasable pool (RRP) of synaptic vesicles after a train of $N$ action potentials. Let the initial size of the RRP be $R_0$. The total depletion, which we denote by the random variable $D$, is the total number of vesicles that undergo fusion during the train of $N$ spikes. We seek to compute the expectation of $D$, denoted as $E[D]$.\n\nLet us consider the set of $R_0$ vesicles initially present in the RRP. We can label these vesicles from $i=1$ to $i=R_0$. For each vesicle $i$, let us define an indicator random variable $F_i$ such that:\n$$\nF_i =\n\\begin{cases}\n1 & \\text{if vesicle } i \\text{ fuses during the } N \\text{ spikes} \\\\\n0 & \\text{if vesicle } i \\text{ does not fuse during the } N \\text{ spikes}\n\\end{cases}\n$$\nThe total number of fused vesicles, $D$, is the sum of these indicator variables over all vesicles in the initial pool:\n$$ D = \\sum_{i=1}^{R_0} F_i $$\nBy the linearity of expectation, the expected total depletion is the sum of the expectations of the individual indicator variables:\n$$ E[D] = E\\left[\\sum_{i=1}^{R_0} F_i\\right] = \\sum_{i=1}^{R_0} E[F_i] $$\nThe expectation of an indicator random variable is equal to the probability of the event it indicates. Therefore, $E[F_i] = P(F_i=1)$, where $P(F_i=1)$ is the probability that vesicle $i$ fuses at some point during the train of $N$ spikes.\n\nAccording to the problem's assumption (ii), the probability of fusion, $p$, is constant for any given primed vesicle and for each action potential. All vesicles in the RRP are functionally identical in this model. Consequently, the probability of fusion for any single vesicle $i$ during the train, $P(F_i=1)$, is the same for all $i \\in \\{1, 2, \\dots, R_0\\}$. Let us denote this common probability as $P_{\\text{fuse}}$. The expression for the expected depletion simplifies to:\n$$ E[D] = \\sum_{i=1}^{R_0} P_{\\text{fuse}} = R_0 \\cdot P_{\\text{fuse}} $$\nOur task is now reduced to calculating $P_{\\text{fuse}}$. It is more direct to first calculate the complementary probability, $P_{\\text{survive}}$, which is the probability that a single vesicle does *not* fuse during the entire train of $N$ spikes. A vesicle fuses if it has not survived. Thus, $P_{\\text{fuse}} = 1 - P_{\\text{survive}}$.\n\nLet us consider a single vesicle from the initial RRP. At the first spike, the probability that this vesicle fuses is $p$. The probability that it does not fuse is $1-p$.\nIf the vesicle does not fuse at the first spike, it remains in the primed RRP. At the second spike, the probability that it fuses is again $p$, and the probability that it survives this second spike is again $1-p$. This process repeats for all $N$ spikes.\n\nA vesicle survives the entire train of $N$ spikes if and only if it survives the first spike, AND the second spike, ..., AND the $N$-th spike. The outcome for a vesicle at each spike is an independent event, conditional on its survival up to that point. The probability of a vesicle surviving the entire train is the product of the probabilities of it surviving each individual spike:\n$$ P_{\\text{survive}} = \\underbrace{(1-p) \\times (1-p) \\times \\dots \\times (1-p)}_{N \\text{ times}} = (1-p)^N $$\nNow, we can find the probability $P_{\\text{fuse}}$ that a vesicle fuses at some point during the train. This event is the complement of the vesicle surviving the entire train.\n$$ P_{\\text{fuse}} = 1 - P_{\\text{survive}} = 1 - (1-p)^N $$\nFinally, we substitute this expression for $P_{\\text{fuse}}$ back into our equation for the expected depletion $E[D]$:\n$$ E[D] = R_0 \\cdot \\left(1 - (1-p)^N\\right) $$\nThis is the closed-form analytic expression for the expected depletion of the RRP in units of vesicles. It is derived directly from first principles of probability and the explicit assumptions of the synaptic vesicle cycle model provided.", "answer": "$$\n\\boxed{R_0 \\left(1 - (1-p)^N\\right)}\n$$", "id": "2767720"}, {"introduction": "While conceptual models of pool depletion are instructive, experimental neurophysiology requires methods to estimate presynaptic parameters from measurable outputs, like postsynaptic currents. This practice explores the widely used cumulative EPSC analysis, a technique that allows us to infer the size of the initial RRP and vesicle release probability from electrophysiological recordings. By working through the logic of this analysis [@problem_id:2767708], you will learn to bridge the gap between theoretical models and experimental data.", "problem": "A central approach to estimating the size of the readily releasable pool (RRP) of synaptic vesicles and the initial release probability in excitatory synapses is cumulative excitatory postsynaptic current (EPSC) analysis during high-frequency stimulation. Consider a synapse stimulated with a train of $50$ stimuli at $100\\,\\mathrm{Hz}$, while postsynaptic receptor saturation and desensitization have been pharmacologically minimized and the driving force held constant. The EPSC for each stimulus is integrated to obtain the charge per EPSC, denoted $Q_i$ for the $i$-th EPSC. The cumulative charge is defined as $C(N) = \\sum_{i=1}^{N} Q_i$. A linear regression of $C(N)$ versus stimulus number $N$ restricted to the late steady-depressing phase (stimuli $26$ through $50$) yields a line with slope $m = 0.210\\,\\mathrm{pC/stimulus}$ and back-extrapolated $y$-intercept $b = 5.40\\,\\mathrm{pC}$. The first EPSC charge is measured as $Q_1 = 1.52\\,\\mathrm{pC}$. The average quantal charge per vesicle is independently calibrated as $q = 0.270\\,\\mathrm{pC/vesicle}$.\n\nStarting from the quantal hypothesis and a mass balance for a single homogeneous readily releasable pool, justify the validity of the back-extrapolation method under high-frequency stimulation by deriving the relationship between the cumulative plot’s late linear regime and the RRP at train onset. Use the following modeling assumptions explicitly in your reasoning:\n\n- The synapse contains a homogeneous readily releasable pool of $N$ vesicles at train onset, each releasing independently with per-stimulus release probability $p$ and quantal charge $q$, so that $Q_i \\approx p q R_i$, where $R_i$ is the number of vesicles available immediately before stimulus $i$.\n- Vesicle replenishment into the readily releasable pool occurs between stimuli at an average rate that becomes constant in the late phase under high-frequency stimulation.\n- In the late phase, release per stimulus equals replenishment per stimulus (steady state), and the cumulative plot becomes linear with slope equal to the replenishment contribution per stimulus.\n- Any residual steady-state occupancy of the readily releasable pool just before stimuli in the late phase is small compared to the pool at train onset under the chosen frequency, allowing the standard back-extrapolation approximation.\n\nUsing these premises:\n\n1) Derive why the back-extrapolated $y$-intercept of the late linear fit approximates the total charge initially contained in the readily releasable pool at train onset.\n\n2) Compute the readily releasable pool size in vesicles from the given regression parameters and $q$.\n\n3) Compute the initial per-stimulus release probability $p$ from $Q_1$ and the estimated RRP charge.\n\n4) Compute the steady-state replenishment rate in vesicles per second from the slope and $q$.\n\nExpress the readily releasable pool size in vesicles. Round your final reported answer to three significant figures. Do not include any units inside the final answer box; however, for all intermediate results, use appropriate physical units (e.g., $\\mathrm{pC}$, $\\mathrm{vesicles}$, $\\mathrm{vesicles/s}$). For $p$, express it as a decimal (not a percentage).", "solution": "The problem is valid as it is scientifically grounded in the principles of synaptic physiology, well-posed with sufficient data and clear assumptions, and stated objectively. We can proceed with a formal solution.\n\nThe problem asks for a derivation to justify the back-extrapolation method for estimating the size of the readily releasable pool (RRP) of synaptic vesicles, and then to compute several key synaptic parameters.\n\n1) Derivation of the back-extrapolation method's validity.\n\nLet $N_0$ be the initial number of vesicles in the readily releasable pool (RRP) at the start of the stimulation train ($t=0$). Let $p$ be the probability of release for each vesicle in the RRP upon the arrival of a single action potential (stimulus). Let $q$ be the quantal charge, i.e., the charge corresponding to the fusion of a single vesicle. Let $r$ be the number of vesicles replenished into the RRP during one inter-stimulus interval. We assume $p$ and $r$ are constant during the high-frequency train, as per the standard model simplified for this analysis.\n\nLet $R_i$ be the number of vesicles in the RRP immediately before the $i$-th stimulus. The initial condition is $R_1 = N_0$.\nThe charge released by the $i$-th stimulus, $Q_i$, is given by the quantal hypothesis:\n$$ Q_i = q p R_i $$\nBetween stimulus $i$ and $i+1$, the RRP is depleted by release and refilled by replenishment. The number of vesicles in the pool before the next stimulus, $R_{i+1}$, is described by the mass-balance difference equation:\n$$ R_{i+1} = R_i - pR_i + r = (1-p)R_i + r $$\nThis is a linear first-order non-homogeneous difference equation. Its solution, with the initial condition $R_1 = N_0$, is:\n$$ R_i = (N_0 - \\frac{r}{p})(1-p)^{i-1} + \\frac{r}{p} $$\nSubstituting this into the equation for $Q_i$:\n$$ Q_i = qp \\left[ (N_0 - \\frac{r}{p})(1-p)^{i-1} + \\frac{r}{p} \\right] = qp(N_0 - \\frac{r}{p})(1-p)^{i-1} + qr $$\nThe cumulative charge after $N$ stimuli, $C(N)$, is the sum of the individual EPSC charges:\n$$ C(N) = \\sum_{i=1}^{N} Q_i = \\sum_{i=1}^{N} \\left[ qp(N_0 - \\frac{r}{p})(1-p)^{i-1} + qr \\right] $$\nThis sum can be split into two parts:\n$$ C(N) = qp(N_0 - \\frac{r}{p}) \\sum_{i=1}^{N} (1-p)^{i-1} + \\sum_{i=1}^{N} qr $$\nThe first sum is a geometric series. Evaluating the sums gives:\n$$ C(N) = qp(N_0 - \\frac{r}{p}) \\frac{1-(1-p)^N}{1-(1-p)} + Nqr $$\n$$ C(N) = q(N_0 - \\frac{r}{p})[1-(1-p)^N] + Nqr $$\nThe problem states that a linear regression is performed on the late, steady-depressing phase of the $C(N)$ versus $N$ plot. In this phase, for large $N$, the term $(1-p)^N$ approaches zero, as $0  p  1$. The equation for $C(N)$ thus approaches a linear asymptote:\n$$ C_{asym}(N) = \\lim_{N\\to\\infty, (1-p)^N\\to 0} C(N) \\approx q(N_0 - \\frac{r}{p})(1) + Nqr $$\n$$ C_{asym}(N) = (qr)N + q(N_0 - \\frac{r}{p}) $$\nThis is the equation of a straight line, $y = mx+b$, where the stimulus number $N$ is the independent variable. By comparing terms, we can identify the slope and y-intercept of this asymptotic line:\n- The slope is $m = qr$. This is the charge replenished and then released per stimulus interval in the steady state.\n- The y-intercept is $b = q(N_0 - \\frac{r}{p})$.\n\nThe term $R_{ss} = r/p$ represents the steady-state number of vesicles in the RRP (where release $pR_{ss}$ balances replenishment $r$). So, the intercept can be written as $b = qN_0 - qR_{ss}$. This means the back-extrapolated intercept is an estimate of the initial RRP charge ($qN_0$) minus the charge of the residual steady-state pool ($qR_{ss}$).\n\nThe problem provides a critical modeling assumption: \"Any residual steady-state occupancy of the readily releasable pool... is small compared to the pool at train onset\". This translates to $R_{ss} \\ll N_0$. Consequently, the charge of the steady-state pool is negligible compared to the charge of the initial pool: $qR_{ss} \\ll qN_0$.\nUnder this specific approximation, the intercept $b$ becomes a direct estimate of the total charge of the initial RRP:\n$$ b = qN_0 - qR_{ss} \\approx qN_0 $$\nThis completes the justification. The back-extrapolated y-intercept provides an estimate of the total charge of the initial RRP, provided the steady-state pool size is negligible.\n\n2) Compute the readily releasable pool size ($N_0$) in vesicles.\n\nFrom the derived approximation $b \\approx qN_0$, we can calculate the RRP size $N_0$.\nGiven: $b = 5.40\\,\\mathrm{pC}$ and $q = 0.270\\,\\mathrm{pC/vesicle}$.\n$$ N_0 \\approx \\frac{b}{q} = \\frac{5.40\\,\\mathrm{pC}}{0.270\\,\\mathrm{pC/vesicle}} = 20\\,\\mathrm{vesicles} $$\nThe problem requests the final answer rounded to three significant figures.\n\n3) Compute the initial per-stimulus release probability ($p$).\n\nThe charge of the first EPSC is given by $Q_1 = q p R_1$. Since $R_1=N_0$, we have $Q_1 = q p N_0 = p(qN_0)$.\nUsing the approximation $qN_0 \\approx b$, we get $Q_1 \\approx p b$.\nWe can solve for $p$:\n$$ p \\approx \\frac{Q_1}{b} $$\nGiven: $Q_1 = 1.52\\,\\mathrm{pC}$ and $b = 5.40\\,\\mathrm{pC}$.\n$$ p \\approx \\frac{1.52\\,\\mathrm{pC}}{5.40\\,\\mathrm{pC}} \\approx 0.28148... $$\nSo, the initial release probability is approximately $0.281$.\n\n4) Compute the steady-state replenishment rate in vesicles per second.\n\nFrom the derivation in part (1), the slope of the late linear fit is $m = qr$, where $r$ is the replenishment rate in vesicles per inter-stimulus interval.\nGiven: $m = 0.210\\,\\mathrm{pC/stimulus}$ and $q = 0.270\\,\\mathrm{pC/vesicle}$.\n$$ r = \\frac{m}{q} = \\frac{0.210\\,\\mathrm{pC/stimulus}}{0.270\\,\\mathrm{pC/vesicle}} = \\frac{7}{9} \\approx 0.778\\,\\mathrm{vesicles/stimulus} $$\nThe stimulation frequency is $f = 100\\,\\mathrm{Hz}$. The replenishment rate per second, $r_{rate}$, is the rate per interval multiplied by the number of intervals per second ($f$).\n$$ r_{rate} = r \\times f = (\\frac{7}{9}\\,\\mathrm{vesicles/interval}) \\times (100\\,\\mathrm{intervals/s}) = \\frac{700}{9}\\,\\mathrm{vesicles/s} \\approx 77.8\\,\\mathrm{vesicles/s} $$\n\nThe question asks for the readily releasable pool size in vesicles, rounded to three significant figures, as the final answer.\n$N_0 = 20$. Expressed to three significant figures, this is $20.0$.", "answer": "$$\n\\boxed{20.0}\n$$", "id": "2767708"}, {"introduction": "Synaptic strength dynamically changes over milliseconds, a property called short-term plasticity, which arises from competing mechanisms. This advanced practice invites you to construct an integrative computational model that combines use-dependent depression (vesicle depletion) with use-dependent facilitation (residual calcium buildup). By simulating the paired-pulse ratio (PPR), a classic experimental paradigm [@problem_id:2767733], you will gain a deeper appreciation for how the interplay of molecular and cellular processes shapes synaptic information processing.", "problem": "Consider a synaptic terminal where neurotransmitter release on each action potential (AP) is governed by the size of the primed (readily releasable) vesicle pool and the instantaneous release probability, which depends on residual calcium. You will construct an ordinary differential equation (ODE) model based on the following fundamental and widely accepted principles in cellular and molecular neuroscience: (i) first-order relaxation dynamics for both the primed pool and residual calcium, (ii) probabilistic release proportional to pool occupancy, and (iii) a Hill-type dependence of release probability on residual calcium, reflecting cooperative calcium binding.\n\nLet the following state variables and parameters be defined:\n\n- The primed pool occupancy is denoted by $R(t)$, where $0 \\le R(t) \\le R_{\\max}$ and $R_{\\max}$ is a dimensionless capacity.\n- The residual calcium concentration is denoted by $[Ca]_r(t)$ in micromolar ($\\mu\\text{M}$).\n- Baseline residual calcium is $[Ca]_0$ in $\\mu\\text{M}$.\n- At each AP, residual calcium instantaneously increases by $\\Delta [Ca]$ in $\\mu\\text{M}$, immediately after release. Between APs, residual calcium relaxes to $[Ca]_0$ with a time constant $\\tau_{Ca}$ in milliseconds (ms).\n- Between APs, the primed pool relaxes to $R_{\\max}$ with time constant $\\tau_R$ in ms.\n- The instantaneous release probability is $p([Ca]_r)$, which is the sum of a baseline component $p_0$ and a facilitation component with a Hill dependence on $[Ca]_r$, clipped to a maximum $p_{\\max}$ to keep $0 \\le p([Ca]_r) \\le p_{\\max}$. The Hill exponent is $n$ (dimensionless), and the half-activation constant is $K_d$ in $\\mu\\text{M}$.\n\nModel the interstimulus period by the ODEs\n- $ \\frac{dR}{dt} = \\frac{R_{\\max} - R}{\\tau_R} $\n- $ \\frac{d[Ca]_r}{dt} = - \\frac{[Ca]_r - [Ca]_0}{\\tau_{Ca}} $\nfor $t$ strictly between APs. At an AP occurring at time $t^*$, define the events in the following order: (1) release occurs with amplitude equal to $A = p([Ca]_r(t^{*-})) R(t^{*-})$, and the pool decrements instantaneously as $R(t^{*+}) = R(t^{*-}) - A$; (2) immediately after release, residual calcium steps as $[Ca]_r(t^{*+}) = [Ca]_r(t^{*-}) + \\Delta [Ca]$. For an interstimulus interval $T$ in ms, two pulses occur at $t=0$ and $t=T$. By convention, for the boundary case $T = 0$, the second pulse senses the baseline residual calcium immediately prior to any step, that is, $[Ca]_r(0^{-}) = [Ca]_0$.\n\nThe Hill-type facilitation component is defined as\n- $ H([Ca]_r) = \\frac{[Ca]_r^{n}}{[Ca]_r^{n} + K_d^{n}} $\nand the full release probability is\n- $ p([Ca]_r) = \\min\\left(p_0 + (p_{\\max} - p_0)\\, H([Ca]_r), \\, p_{\\max}\\right). $\n\nUsing only these principles and definitions, derive and implement an algorithm to compute the paired-pulse ratio (PPR), defined as the ratio of the second release amplitude to the first release amplitude, as a function of the interstimulus interval $T$. Specifically, for the first pulse at $t=0$, the release amplitude is $A_1 = p([Ca]_r(0^{-})) R(0^{-})$, and for the second pulse at $t=T$, the release amplitude is $A_2 = p([Ca]_r(T^{-})) R(T^{-})$. The paired-pulse ratio is $ \\text{PPR}(T) = \\frac{A_2}{A_1}$. The initial conditions at rest (long before the first AP) are $R(0^{-}) = R_{\\max}$ and $[Ca]_r(0^{-}) = [Ca]_0$.\n\nUse the following parameter values, which are scientifically plausible for central synapses:\n\n- $R_{\\max} = 1.0$ (dimensionless).\n- $\\tau_R = 100~\\text{ms}$.\n- $[Ca]_0 = 0.05~\\mu\\text{M}$.\n- $\\Delta[Ca] = 0.30~\\mu\\text{M}$.\n- $\\tau_{Ca} = 50~\\text{ms}$.\n- $p_0 = 0.20$ (dimensionless).\n- $p_{\\max} = 0.90$ (dimensionless).\n- $n = 3$ (dimensionless).\n- $K_d = 0.20~\\mu\\text{M}$.\n\nTest suite (interstimulus intervals in milliseconds): $T \\in \\{0, 5, 20, 200, 1000\\}$.\n\nRequirements for your program:\n\n- Implement the ODE-consistent event-driven computation using the principles above, without numerical integration of the ODEs; exploit closed-form relaxation between events.\n- For $T = 0$, apply the stated boundary convention for $[Ca]_r$ at the second pulse.\n- Output the paired-pulse ratios as floating-point decimals rounded to six digits after the decimal point.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite (for example, $[x_1,x_2,x_3,x_4,x_5]$). The ratios are unitless; no unit should be printed.\n\nYour task: Derive from first principles why the chosen ODEs and event rules produce a well-defined paired-pulse ratio, specify the intermediate symbolic steps needed to compute $R(T^{-})$ and $[Ca]_r(T^{-})$ from the initial conditions and events, and implement the computation to produce the required output for the given test suite.", "solution": "The problem statement is scientifically grounded, well-posed, and internally consistent. It presents a standard, albeit simplified, model of short-term synaptic plasticity based on established principles of cellular neuroscience. All necessary parameters and initial conditions are provided to compute a unique solution. Therefore, I will proceed with a full analytical derivation and implementation.\n\nThe objective is to compute the paired-pulse ratio, $\\text{PPR}(T) = A_2/A_1$, where $A_1$ and $A_2$ are the neurotransmitter release amplitudes for two action potentials (APs) separated by an interstimulus interval $T$. The calculation requires tracking the state variables—primed vesicle pool occupancy $R(t)$ and residual calcium concentration $[Ca]_r(t)$—through a sequence of discrete events and continuous relaxation periods.\n\nThe analytical solution proceeds in stages, following the timeline of events.\n\n**1. State at Rest and First Pulse (Time $t=0$)**\n\nBefore the first AP, the synapse is at rest. The initial conditions are provided as:\n$$ R(0^{-}) = R_{\\max} $$\n$$ [Ca]_r(0^{-}) = [Ca]_0 $$\nwhere $t=0^{-}$ denotes the instant just before the first AP.\n\nThe release probability $p$ is a function of the calcium concentration. For the first pulse, this probability, $p_1$, is determined by the baseline calcium $[Ca]_0$. First, we compute the Hill function term:\n$$ H([Ca]_0) = \\frac{[Ca]_0^n}{[Ca]_0^n + K_d^n} $$\nThe release probability is then:\n$$ p_1 = p([Ca]_r(0^{-})) = p([Ca]_0) = \\min\\left(p_0 + (p_{\\max} - p_0) H([Ca]_0), p_{\\max}\\right) $$\nThe amplitude of the first release, $A_1$, is the product of the release probability and the number of available vesicles:\n$$ A_1 = p_1 R(0^{-}) = p_1 R_{\\max} $$\nImmediately following the first release, at time $t=0^{+}$, the state variables are updated according to the event rules. The vesicle pool is depleted by the amount released, and the calcium concentration increases due to influx associated with the AP.\n$$ R(0^{+}) = R(0^{-}) - A_1 = R_{\\max} - A_1 $$\n$$ [Ca]_r(0^{+}) = [Ca]_r(0^{-}) + \\Delta[Ca] = [Ca]_0 + \\Delta[Ca] $$\nThese values serve as the initial conditions for the subsequent interstimulus interval.\n\n**2. State Evolution During the Interstimulus Interval ($0  t  T$)**\n\nBetween APs, the state variables relax towards their steady-state values according to first-order linear ordinary differential equations:\n$$ \\frac{dR}{dt} = \\frac{R_{\\max} - R}{\\tau_R} $$\n$$ \\frac{d[Ca]_r}{dt} = - \\frac{[Ca]_r - [Ca]_0}{\\tau_{Ca}} = \\frac{[Ca]_0 - [Ca]_r}{\\tau_{Ca}} $$\nThe general solution to an ODE of the form $dy/dt = (y_{\\infty} - y)/\\tau$ with initial condition $y(t_0) = y_0$ is:\n$$ y(t) = y_{\\infty} + (y_0 - y_{\\infty}) e^{-(t-t_0)/\\tau} $$\nApplying this general solution to our state variables over the interval $[0, T]$, with $t_0=0$:\n\nFor residual calcium, the steady-state value is $[Ca]_0$ and the initial condition is $[Ca]_r(0^{+})$. The evolution is:\n$$ [Ca]_r(t) = [Ca]_0 + ([Ca]_r(0^{+}) - [Ca]_0) e^{-t/\\tau_{Ca}} $$\nSubstituting $[Ca]_r(0^{+}) = [Ca]_0 + \\Delta[Ca]$, we get:\n$$ [Ca]_r(t) = [Ca]_0 + ([Ca]_0 + \\Delta[Ca] - [Ca]_0) e^{-t/\\tau_{Ca}} = [Ca]_0 + \\Delta[Ca] e^{-t/\\tau_{Ca}} $$\nThus, the calcium concentration immediately before the second pulse at time $T$ is:\n$$ [Ca]_r(T^{-}) = [Ca]_0 + \\Delta[Ca] e^{-T/\\tau_{Ca}} $$\n\nFor the primed vesicle pool, the steady-state value is $R_{\\max}$ and the initial condition is $R(0^{+})$. The evolution is:\n$$ R(t) = R_{\\max} + (R(0^{+}) - R_{\\max}) e^{-t/\\tau_R} $$\nSubstituting $R(0^{+}) = R_{\\max} - A_1$, we get:\n$$ R(t) = R_{\\max} + (R_{\\max} - A_1 - R_{\\max}) e^{-t/\\tau_R} = R_{\\max} - A_1 e^{-t/\\tau_R} $$\nThus, the pool occupancy immediately before the second pulse is:\n$$ R(T^{-}) = R_{\\max} - A_1 e^{-T/\\tau_R} $$\n\n**3. Second Pulse (Time $t=T$) and Paired-Pulse Ratio**\n\nAt time $t=T^{-}$, we use the evolved state variables $R(T^{-})$ and $[Ca]_r(T^{-})$ to calculate the amplitude of the second release, $A_2$.\nThe release probability for the second pulse, $p_2$, depends on $[Ca]_r(T^{-})$:\n$$ p_2 = p([Ca]_r(T^{-})) = \\min\\left(p_0 + (p_{\\max} - p_0) H([Ca]_r(T^{-})), p_{\\max}\\right) $$\nwhere $H([Ca]_r(T^{-})) = \\frac{([Ca]_r(T^{-}))^n}{([Ca]_r(T^{-}))^n + K_d^n}$.\n\nThe amplitude of the second release is:\n$$ A_2 = p_2 R(T^{-}) $$\nFinally, the paired-pulse ratio, $\\text{PPR}(T)$, is the ratio of the two amplitudes:\n$$ \\text{PPR}(T) = \\frac{A_2}{A_1} = \\frac{p([Ca]_r(T^{-})) R(T^{-})}{p([Ca]_r(0^{-})) R(0^{-})} $$\nSubstituting the derived expressions for the state variables:\n$$ \\text{PPR}(T) = \\frac{p([Ca]_0 + \\Delta[Ca] e^{-T/\\tau_{Ca}}) (R_{\\max} - A_1 e^{-T/\\tau_R})}{A_1} $$\nwhere $A_1 = p([Ca]_0) R_{\\max}$.\n\n**4. Special Case: $T=0$**\n\nFor the boundary case $T=0$, the problem provides a specific convention: \"the second pulse senses the baseline residual calcium immediately prior to any step, that is, $[Ca]_r(0^{-}) = [Ca]_0$.\" This is an instruction to compute the release probability for the second pulse, $p_2$, using $[Ca]_0$ instead of the calcium level after the first AP. Therefore:\n$$ p_2(T=0) = p([Ca]_0) = p_1 $$\nHowever, the vesicle pool is depleted by the first pulse before the second release occurs. The problem states the events at an AP occur sequentially: (1) release and pool decrement, (2) calcium step. This implies the state of the pool for the second, simultaneous pulse is the post-depletion state, $R(0^{+})$.\n$$ R(T=0^{-}) \\rightarrow R(0^{+}) = R_{\\max} - A_1 $$\nThe amplitude of the second release is thus:\n$$ A_2(T=0) = p_2(T=0) \\cdot R(0^{+}) = p([Ca]_0) (R_{\\max} - A_1) $$\nThe paired-pulse ratio for $T=0$ is:\n$$ \\text{PPR}(0) = \\frac{A_2(T=0)}{A_1} = \\frac{p([Ca]_0) (R_{\\max} - A_1)}{p([Ca]_0) R_{\\max}} = \\frac{R_{\\max} - A_1}{R_{\\max}} = 1 - \\frac{A_1}{R_{\\max}} $$\nSince $A_1 = p([Ca]_0) R_{\\max}$, this simplifies to:\n$$ \\text{PPR}(0) = 1 - p([Ca]_0) $$\nThis result correctly isolates the effect of pure vesicle pool depletion, as facilitation due to calcium is explicitly excluded by the problem's convention for $T=0$.\n\nThe derived analytical expressions allow for direct computation of the PPR for any given interstimulus interval $T$ without numerical integration, as requested. The implementation will follow these steps precisely.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the paired-pulse ratio problem based on the provided\n    ODE model of synaptic transmission.\n    \"\"\"\n\n    # --- Parameters from the problem statement ---\n    # These parameters are considered scientifically plausible for central synapses.\n    R_max = 1.0        # Dimensionless capacity of the primed pool\n    tau_R = 100.0      # ms, time constant for pool replenishment\n    Ca0 = 0.05         # uM, baseline residual calcium\n    delta_Ca = 0.30    # uM, calcium increase per AP\n    tau_Ca = 50.0      # ms, time constant for calcium extrusion\n    p0 = 0.20          # Dimensionless baseline release probability\n    p_max = 0.90       # Dimensionless maximum release probability\n    n = 3.0            # Dimensionless Hill exponent for calcium cooperativity\n    Kd = 0.20          # uM, half-activation constant for calcium\n\n    # Test suite of interstimulus intervals (ISIs) in milliseconds\n    test_cases_T = [0, 5, 20, 200, 1000]\n\n    def calculate_p(Ca):\n        \"\"\"\n        Calculates the instantaneous release probability p as a function of\n        residual calcium concentration [Ca]_r.\n\n        Args:\n            Ca (float): Residual calcium concentration in uM.\n\n        Returns:\n            float: The release probability (dimensionless).\n        \"\"\"\n        # The Hill function describes the cooperative binding of calcium.\n        H_Ca = (Ca**n) / (Ca**n + Kd**n)\n        \n        # The full release probability is the sum of a baseline and a\n        # calcium-dependent facilitation component, clipped at p_max.\n        p = p0 + (p_max - p0) * H_Ca\n        return min(p, p_max)\n\n    results = []\n    for T in test_cases_T:\n        # --- STAGE 1: First Pulse (at t=0) ---\n\n        # The system starts at rest, so R(0-) = R_max and [Ca]_r(0-) = Ca0.\n        R_before_1 = R_max\n        Ca_before_1 = Ca0\n        \n        # Calculate release probability and amplitude for the first pulse.\n        p1 = calculate_p(Ca_before_1)\n        A1 = p1 * R_before_1\n\n        # Check for division by zero, although not expected with given parameters.\n        if A1 == 0:\n            # If the first pulse has zero amplitude, the PPR is undefined.\n            # We can represent this as NaN or handle as an error.\n            # Here we append NaN, but this case should not be reached.\n            results.append(float('nan'))\n            continue\n\n        # --- STAGE 2: Handle T=0 and T0 cases separately ---\n\n        if T == 0:\n            # For T=0, use the specific boundary convention from the problem statement.\n            # The second pulse senses the baseline calcium level for its probability.\n            p2 = calculate_p(Ca0)\n            \n            # The vesicle pool, however, is depleted by the first pulse.\n            # R(0+) = R(0-) - A1\n            R_after_1 = R_before_1 - A1\n            \n            # The second release amplitude is calculated with this depleted pool.\n            A2 = p2 * R_after_1\n\n        else: # T  0\n            # --- STAGE 2a: Inter-pulse Interval Evolution (for T  0) ---\n            # Analytically solve the ODEs for the state at time T-.\n            \n            # Calcium decays exponentially back to its baseline Ca0.\n            Ca_before_2 = Ca0 + delta_Ca * np.exp(-T / tau_Ca)\n            \n            # The primed pool recovers exponentially towards its maximum R_max.\n            # The initial depletion was A1.\n            R_before_2 = R_max - A1 * np.exp(-T / tau_R)\n            \n            # --- STAGE 2b: Second Pulse (at t=T) ---\n            \n            # Calculate release probability and amplitude for the second pulse.\n            p2 = calculate_p(Ca_before_2)\n            A2 = p2 * R_before_2\n            \n        # --- STAGE 3: Calculate Paired-Pulse Ratio ---\n        ppr = A2 / A1\n        results.append(ppr)\n\n    # Format the results for the final output.\n    # The output must be a list of floating-point decimals rounded to six digits.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2767733"}]}