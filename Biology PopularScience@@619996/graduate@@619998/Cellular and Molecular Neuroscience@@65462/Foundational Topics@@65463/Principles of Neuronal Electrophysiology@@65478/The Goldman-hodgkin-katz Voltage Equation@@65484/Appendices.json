{"hands_on_practices": [{"introduction": "To truly master the Goldman-Hodgkin-Katz (GHK) equation, we begin by building it from the ground up. This first exercise [@problem_id:2763541] challenges you to derive the GHK voltage equation from the Nernst-Planck electrodiffusion framework and the constant-field assumption, the theoretical bedrock of the model. By subsequently calculating the membrane's sensitivity to changes in ionic permeabilities, you will gain a quantitative understanding of why the resting potential of a typical neuron is primarily determined by potassium ions, yet dynamically sensitive to others like sodium.", "problem": "A single isopotential neuronal membrane at temperature $T=310\\,\\mathrm{K}$ is permeable to three monovalent ions: potassium $\\text{K}^+$, sodium $\\text{Na}^+$, and chloride $\\text{Cl}^-$. Bulk solutions are well-stirred, electroneutral, and have constant activities equal to concentrations. The intracellular and extracellular concentrations are:\n- $[\\text{K}^+]_i = 140\\,\\mathrm{mM}$, $[\\text{K}^+]_o = 5\\,\\mathrm{mM}$,\n- $[\\text{Na}^+]_i = 12\\,\\mathrm{mM}$, $[\\text{Na}^+]_o = 145\\,\\mathrm{mM}$,\n- $[\\text{Cl}^-]_i = 7\\,\\mathrm{mM}$, $[\\text{Cl}^-]_o = 110\\,\\mathrm{mM}$.\nThe baseline relative permeabilities (in arbitrary but consistent units) are $P_{\\text{K}}=1$, $P_{\\text{Na}}=0.04$, and $P_{\\text{Cl}}=0.45$. Assume the constant-field (Goldman) electrodiffusion regime holds and that the steady-state membrane potential $V_m$ is the unique voltage at which the net transmembrane current carried by these ions is zero.\n\nStarting from the Nernst–Planck description and the constant-field assumption (without invoking any pre-packaged voltage formula), derive the expression for the steady-state membrane potential $V_m$ in terms of the permeabilities, concentrations, the universal gas constant $R$, and the Faraday constant $F$. Using that expression, compute:\n1) the change in membrane potential $\\Delta V_m^{(\\text{Na})}$ produced by increasing $P_{\\text{Na}}$ by $25\\%$ while holding $P_{\\text{K}}$ and $P_{\\text{Cl}}$ fixed at their baseline values, and\n2) the change $\\Delta V_m^{(\\text{Cl})}$ produced by increasing $P_{\\text{Cl}}$ by $25\\%$ while holding $P_{\\text{K}}$ and $P_{\\text{Na}}$ fixed at their baseline values.\n\nDefine the sensitivity ratio\n$$\nS \\equiv \\frac{\\left|\\Delta V_m^{(\\text{Na})}\\right|}{\\left|\\Delta V_m^{(\\text{Cl})}\\right|}.\n$$\n\nReport only the value of $S$ as your final answer, rounded to four significant figures. Express $S$ as a pure number (no units).", "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- Temperature: $T = 310\\,\\mathrm{K}$\n- Ions: Monovalent -- potassium ($\\text{K}^+$), sodium ($\\text{Na}^+$), chloride ($\\text{Cl}^-$)\n- Valences: $z_{\\text{K}}=+1$, $z_{\\text{Na}}=+1$, $z_{\\text{Cl}}=-1$\n- Intracellular concentrations: $[\\text{K}^+]_i = 140\\,\\mathrm{mM}$, $[\\text{Na}^+]_i = 12\\,\\mathrm{mM}$, $[\\text{Cl}^-]_i = 7\\,\\mathrm{mM}$\n- Extracellular concentrations: $[\\text{K}^+]_o = 5\\,\\mathrm{mM}$, $[\\text{Na}^+]_o = 145\\,\\mathrm{mM}$, $[\\text{Cl}^-]_o = 110\\,\\mathrm{mM}$\n- Baseline relative permeabilities: $P_{\\text{K}}=1$, $P_{\\text{Na}}=0.04$, $P_{\\text{Cl}}=0.45$\n- Assumptions: Constant-field electrodiffusion, steady state is zero-current condition.\n- Task: Derive the GHK voltage equation, then calculate the sensitivity ratio $S \\equiv \\frac{\\left|\\Delta V_m^{(\\text{Na})}\\right|}{\\left|\\Delta V_m^{(\\text{Cl})}\\right|}$ where $\\Delta V_m^{(\\text{Na})}$ is the change in $V_m$ from a $25\\%$ increase in $P_{\\text{Na}}$ and $\\Delta V_m^{(\\text{Cl})}$ is the change from a $25\\%$ increase in $P_{\\text{Cl}}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the established principles of electrodiffusion and membrane biophysics. It is well-posed, providing all necessary parameters and a clear objective. The language is precise and quantitative. The given values are physiologically realistic. The problem is valid.\n\n**Derivation of the Goldman-Hodgkin-Katz (GHK) Voltage Equation**\nThe steady-state flux density $j_s$ of an ionic species $s$ across a membrane is described by the Nernst-Planck equation:\n$$\nj_s = -D_s \\left( \\frac{dC_s}{dx} + \\frac{z_s F}{RT} C_s \\frac{d\\phi}{dx} \\right)\n$$\nwhere $D_s$ is the diffusion coefficient of the ion in the membrane, $C_s(x)$ is its concentration at position $x$ within the membrane, $z_s$ is its valence, $F$ is the Faraday constant, $R$ is the universal gas constant, $T$ is the absolute temperature, and $\\phi(x)$ is the electric potential.\n\nThe constant-field assumption states that the electric field $E = -\\frac{d\\phi}{dx}$ is constant across the membrane of thickness $L$. Thus, $\\frac{d\\phi}{dx} = \\frac{\\phi_i - \\phi_o}{L} = \\frac{V_m}{L}$, where $V_m$ is the membrane potential.\n\nSubstituting the constant field into the Nernst-Planck equation, we obtain a first-order linear ordinary differential equation for $C_s(x)$:\n$$\n\\frac{dC_s}{dx} + \\frac{z_s F V_m}{RT L} C_s = -\\frac{j_s}{D_s}\n$$\nUnder steady-state conditions, $j_s$ must be constant across the membrane. This equation can be solved by integrating across the membrane from $x=0$ (outside, concentration $[s]_o$) to $x=L$ (inside, concentration $[s]_i$). The solution for the flux density $j_s$ is:\n$$\nj_s = -P_s \\frac{z_s F V_m}{RT} \\left( \\frac{[s]_i \\exp\\left(\\frac{z_s F V_m}{RT}\\right) - [s]_o}{\\exp\\left(\\frac{z_s F V_m}{RT}\\right) - 1} \\right)\n$$\nwhere the permeability $P_s$ is related to the diffusion coefficient by $P_s = D_s/L$ (assuming partition coefficients are unity, which is implicit in this model).\n\nThe electric current density carried by ion $s$ is $J_s = z_s F j_s$. Let $u = \\frac{F V_m}{RT}$.\n$$\nJ_s = -z_s^2 F^2 P_s \\frac{V_m}{RT} \\left( \\frac{[s]_i \\exp(z_s u) - [s]_o}{\\exp(z_s u) - 1} \\right)\n$$\nThe steady-state condition is that the total ionic current across the membrane is zero: $\\sum_s J_s = 0$. For the ions $\\text{K}^+$, $\\text{Na}^+$, and $\\text{Cl}^-$, this is $J_{\\text{K}} + J_{\\text{Na}} + J_{\\text{Cl}} = 0$.\nThe valences are $z_{\\text{K}}=+1$, $z_{\\text{Na}}=+1$, and $z_{\\text{Cl}}=-1$.\n\nFor cations ($z_s = +1$):\n$$\nJ_{\\text{cation}} = -F^2 P_{\\text{cation}} \\frac{V_m}{RT} \\left( \\frac{[\\text{cation}]_i \\exp(u) - [\\text{cation}]_o}{\\exp(u) - 1} \\right)\n$$\nFor anions ($z_s = -1$):\n$$\nJ_{\\text{anion}} = -F^2 P_{\\text{anion}} \\frac{V_m}{RT} \\left( \\frac{[\\text{anion}]_i \\exp(-u) - [\\text{anion}]_o}{\\exp(-u) - 1} \\right)\n$$\nManipulating the anion current expression:\n$$\nJ_{\\text{anion}} = -F^2 P_{\\text{anion}} \\frac{V_m}{RT} \\frac{\\exp(u)}{\\exp(u)} \\left( \\frac{[\\text{anion}]_i \\exp(-u) - [\\text{anion}]_o}{\\exp(-u) - 1} \\right) = -F^2 P_{\\text{anion}} \\frac{V_m}{RT} \\left( \\frac{[\\text{anion}]_i - [\\text{anion}]_o \\exp(u)}{1 - \\exp(u)} \\right)\n$$\nSumming the currents to zero and canceling the common factor $-F^2 \\frac{V_m}{RT} \\frac{1}{\\exp(u)-1}$ (for $V_m \\neq 0$):\n$$\nP_{\\text{K}}([\\text{K}^+]_i \\exp(u) - [\\text{K}^+]_o) + P_{\\text{Na}}([\\text{Na}^+]_i \\exp(u) - [\\text{Na}^+]_o) + P_{\\text{Cl}}([\\text{Cl}^-]_i - [\\text{Cl}^-]_o \\exp(u)) = 0\n$$\nGrouping terms with $\\exp(u)$:\n$$\n\\exp(u) \\left( P_{\\text{K}}[\\text{K}^+]_i + P_{\\text{Na}}[\\text{Na}^+]_i + P_{\\text{Cl}}[\\text{Cl}^-]_o \\right) = P_{\\text{K}}[\\text{K}^+]_o + P_{\\text{Na}}[\\text{Na}^+]_o + P_{\\text{Cl}}[\\text{Cl}^-]_i\n$$\nSolving for $\\exp(u)$:\n$$\n\\exp\\left(\\frac{F V_m}{RT}\\right) = \\frac{P_{\\text{K}}[\\text{K}^+]_o + P_{\\text{Na}}[\\text{Na}^+]_o + P_{\\text{Cl}}[\\text{Cl}^-]_i}{P_{\\text{K}}[\\text{K}^+]_i + P_{\\text{Na}}[\\text{Na}^+]_i + P_{\\text{Cl}}[\\text{Cl}^-]_o}\n$$\nTaking the natural logarithm and solving for $V_m$ yields the GHK voltage equation:\n$$\nV_m = \\frac{RT}{F} \\ln \\left( \\frac{P_{\\text{K}}[\\text{K}^+]_o + P_{\\text{Na}}[\\text{Na}^+]_o + P_{\\text{Cl}}[\\text{Cl}^-]_i}{P_{\\text{K}}[\\text{K}^+]_i + P_{\\text{Na}}[\\text{Na}^+]_i + P_{\\text{Cl}}[\\text{Cl}^-]_o} \\right)\n$$\nThis is the required derived expression.\n\n**Calculation of the Sensitivity Ratio $S$**\nLet the argument of the logarithm be denoted by $\\mathcal{A}$.\n$$\n\\mathcal{A} = \\frac{N}{D} = \\frac{P_{\\text{K}}[\\text{K}^+]_o + P_{\\text{Na}}[\\text{Na}^+]_o + P_{\\text{Cl}}[\\text{Cl}^-]_i}{P_{\\text{K}}[\\text{K}^+]_i + P_{\\text{Na}}[\\text{Na}^+]_i + P_{\\text{Cl}}[\\text{Cl}^-]_o}\n$$\nThe membrane potential is $V_m = \\fracRT}{F} \\ln(\\mathcal{A})$. The ratio $S$ is defined as:\n$$\nS = \\frac{|\\Delta V_m^{(\\text{Na})}|}{|\\Delta V_m^{(\\text{Cl})}|} = \\frac{|V_{m, \\text{Na}} - V_{m, 0}|}{|V_{m, \\text{Cl}} - V_{m, 0}|}\n$$\nwhere $V_{m,0}$ is the baseline potential, $V_{m, \\text{Na}}$ is the potential with increased $P_{\\text{Na}}$, and $V_{m, \\text{Cl}}$ is the potential with increased $P_{\\text{Cl}}$.\nSubstituting the expression for $V_m$, the term $\\frac{RT}{F}$ cancels out:\n$$\nS = \\frac{|\\ln(\\mathcal{A}_{\\text{Na}}) - \\ln(\\mathcal{A}_0)|}{|\\ln(\\mathcal{A}_{\\text{Cl}}) - \\ln(\\mathcal{A}_0)|} = \\frac{|\\ln(\\mathcal{A}_{\\text{Na}}/\\mathcal{A}_0)|}{|\\ln(\\mathcal{A}_{\\text{Cl}}/\\mathcal{A}_0)|}\n$$\nWe now compute the numerators ($N$) and denominators ($D$) of $\\mathcal{A}$ for each case. The concentrations are in $\\mathrm{mM}$.\n\n1.  **Baseline case (0):**\n    $P_{\\text{K}}=1$, $P_{\\text{Na}}=0.04$, $P_{\\text{Cl}}=0.45$.\n    $N_0 = (1)(5) + (0.04)(145) + (0.45)(7) = 5 + 5.8 + 3.15 = 13.95$.\n    $D_0 = (1)(140) + (0.04)(12) + (0.45)(110) = 140 + 0.48 + 49.5 = 189.98$.\n    $\\mathcal{A}_0 = \\frac{13.95}{189.98}$.\n\n2.  **Increased $P_{\\text{Na}}$ case (Na):**\n    $P_{\\text{Na}}' = 1.25 \\times P_{\\text{Na}} = 1.25 \\times 0.04 = 0.05$. Other permeabilities are unchanged.\n    $N_{\\text{Na}} = (1)(5) + (0.05)(145) + (0.45)(7) = 5 + 7.25 + 3.15 = 15.40$.\n    $D_{\\text{Na}} = (1)(140) + (0.05)(12) + (0.45)(110) = 140 + 0.60 + 49.5 = 190.10$.\n    $\\mathcal{A}_{\\text{Na}} = \\frac{15.40}{190.10}$.\n\n3.  **Increased $P_{\\text{Cl}}$ case (Cl):**\n    $P_{\\text{Cl}}' = 1.25 \\times P_{\\text{Cl}} = 1.25 \\times 0.45 = 0.5625$. Other permeabilities are unchanged.\n    $N_{\\text{Cl}} = (1)(5) + (0.04)(145) + (0.5625)(7) = 5 + 5.8 + 3.9375 = 14.7375$.\n    $D_{\\text{Cl}} = (1)(140) + (0.04)(12) + (0.5625)(110) = 140 + 0.48 + 61.875 = 202.355$.\n    $\\mathcal{A}_{\\text{Cl}} = \\frac{14.7375}{202.355}$.\n\nNow, we compute the ratios of the arguments:\n$$\n\\frac{\\mathcal{A}_{\\text{Na}}}{\\mathcal{A}_0} = \\frac{15.40/190.10}{13.95/189.98} = \\frac{15.40 \\times 189.98}{190.10 \\times 13.95} \\approx 1.103241\n$$\n$$\n\\frac{\\mathcal{A}_{\\text{Cl}}}{\\mathcal{A}_0} = \\frac{14.7375/202.355}{13.95/189.98} = \\frac{14.7375 \\times 189.98}{202.355 \\times 13.95} \\approx 0.991845\n$$\n\nFinally, we calculate $S$:\n$$\nS = \\frac{|\\ln(1.103241)|}{|\\ln(0.991845)|} = \\frac{|0.098253|}{ |-0.0081883|} = \\frac{0.098253}{0.0081883} \\approx 11.99933\n$$\nRounding to four significant figures, the sensitivity ratio is $12.00$.", "answer": "$$\n\\boxed{12.00}\n$$", "id": "2763541"}, {"introduction": "The power of the GHK framework lies in its flexibility to model diverse physiological scenarios beyond the classic resting state. This practice [@problem_id:2763536] applies the GHK equation to a physiologically crucial example: the GABA$_\\text{A}$ receptor, which is permeable to both chloride ($\\text{Cl}^{-}$) and bicarbonate ($\\text{HCO}_3^{-}$) ions. By calculating the reversal potential for this channel, you will develop a deeper appreciation for the principles of synaptic inhibition and understand the biophysical basis for why GABAergic signaling is not always hyperpolarizing.", "problem": "A single-compartment neuron receives synaptic input through a Gamma-aminobutyric acid type A (GABA$_\\text{A}$) receptor channel that is permeable only to chloride and bicarbonate. The channel has a relative bicarbonate-to-chloride permeability ratio of $P_{\\text{HCO}_3}/P_{\\text{Cl}} = 0.2$. The intracellular and extracellular concentrations are:\n- $[\\text{Cl}^-]_i = 10~\\mathrm{mM}$, $[\\text{Cl}^-]_o = 130~\\mathrm{mM}$,\n- $[\\text{HCO}_3^-]_i = 15~\\mathrm{mM}$, $[\\text{HCO}_3^-]_o = 24~\\mathrm{mM}$.\nAssume both anions have valence $z=-1$, activities equal concentrations, the temperature is $T=310~\\mathrm{K}$, and the membrane electric field across the pore is spatially uniform (constant-field approximation). Also assume the independence principle for ion permeation through this channel.\n\nStarting from the Nernst–Planck electrodiffusion framework and the condition that the reversal potential $E_{\\text{rev}}$ is the membrane potential at which the net current through this channel is zero, derive an expression for $E_{\\text{rev}}$ appropriate for a channel permeable to two monovalent anions and evaluate it numerically for the parameters above. You may express permeabilities relative to $P_{\\text{Cl}}$ without loss of generality.\n\nRound your final numerical result to three significant figures and express it in millivolts (mV). The final answer must be a single real number.", "solution": "The task is to find the reversal potential $E_{\\text{rev}}$ for a channel permeable to two monovalent anions, chloride and bicarbonate, given their concentrations and the relative permeability $P_{\\text{HCO}_3}/P_{\\text{Cl}}=0.2$. We proceed from first principles.\n\nThe starting point is the Nernst–Planck equation for ionic flux of species $j$ with valence $z_j$ under an electric potential $V(x)$ and concentration $C_j(x)$:\n$$\nJ_j(x) \\;=\\; -D_j \\left( \\frac{dC_j}{dx} + \\frac{z_j F}{R T} C_j \\frac{dV}{dx} \\right),\n$$\nwhere $D_j$ is the diffusion coefficient, $F$ is the Faraday constant, $R$ is the gas constant, and $T$ is the absolute temperature. Under the constant-field approximation (uniform $dV/dx$ across the pore) and steady state, integrating the Nernst–Planck equation across the membrane yields the Goldman flux form. For ion $j$ with valence $z_j = -1$ (an anion), the steady-state flux across a membrane of permeability $P_j$ is\n$$\nJ_j \\;=\\; P_j \\,\\frac{C_{j,i} - C_{j,o} \\exp\\!\\left(-\\frac{F V_m}{R T}\\right)}{1 - \\exp\\!\\left(-\\frac{F V_m}{R T}\\right)},\n$$\nwhere $V_m$ is the transmembrane potential (inside minus outside), and $C_{j,i}$ and $C_{j,o}$ are the intracellular and extracellular concentrations, respectively. The corresponding ionic current is $I_j = z_j F J_j$. For $z_j=-1$,\n$$\nI_j \\;=\\; -F\\,P_j \\,\\frac{C_{j,i} - C_{j,o} \\exp\\!\\left(-\\frac{F V_m}{R T}\\right)}{1 - \\exp\\!\\left(-\\frac{F V_m}{R T}\\right)}.\n$$\n\nThe reversal potential $E_{\\text{rev}}$ is defined by the condition of zero net current through the channel:\n$$\n\\sum_j I_j \\;=\\; 0.\n$$\nSumming over the two permeant anions $j \\in \\{\\text{Cl}^-, \\text{HCO}_3^-\\}$ and factoring out common terms,\n$$\n\\sum_j I_j \\;=\\; -\\frac{F}{1 - \\exp\\!\\left(-\\frac{F V_m}{R T}\\right)} \\left[ \\sum_j P_j C_{j,i} \\;-\\; \\exp\\!\\left(-\\frac{F V_m}{R T}\\right) \\sum_j P_j C_{j,o} \\right] \\;=\\; 0.\n$$\nThe prefactor is nonzero for finite $V_m$, so the bracket must vanish at $V_m = E_{\\text{rev}}$:\n$$\n\\sum_j P_j C_{j,i} \\;=\\; \\exp\\!\\left(-\\frac{F E_{\\text{rev}}}{R T}\\right) \\sum_j P_j C_{j,o}.\n$$\nSolving for $E_{\\text{rev}}$ gives the Goldman–Hodgkin–Katz (GHK) voltage expression specialized to monovalent anions:\n$$\nE_{\\text{rev}} \\;=\\; \\frac{R T}{F} \\,\\ln\\!\\left( \\frac{\\sum\\limits_{j} P_j C_{j,i}}{\\sum\\limits_{j} P_j C_{j,o}} \\right),\n$$\nwith $j \\in \\{\\text{Cl}^-, \\text{HCO}_3^-\\}$.\n\nIntroduce the given permeability ratio $P_{\\text{HCO}_3}/P_{\\text{Cl}} = 0.2$. Without loss of generality, set $P_{\\text{Cl}} = 1$ and $P_{\\text{HCO}_3} = 0.2$ (any common multiplicative factor cancels in the ratio). Insert the given concentrations:\n- $C_{\\text{Cl},i} = [\\text{Cl}^-]_i = 10~\\mathrm{mM}$,\n- $C_{\\text{Cl},o} = [\\text{Cl}^-]_o = 130~\\mathrm{mM}$,\n- $C_{\\text{HCO}_3,i} = [\\text{HCO}_3^-]_i = 15~\\mathrm{mM}$,\n- $C_{\\text{HCO}_3,o} = [\\text{HCO}_3^-]_o = 24~\\mathrm{mM}$.\n\nCompute the weighted sums:\n$$\n\\sum_j P_j C_{j,i} \\;=\\; P_\\text{Cl}[\\text{Cl}^-]_i + P_{\\text{HCO}_3}[\\text{HCO}_3^-]_i \\;=\\; 1 \\cdot 10 + 0.2 \\cdot 15 \\;=\\; 13,\n$$\n$$\n\\sum_j P_j C_{j,o} \\;=\\; P_\\text{Cl}[\\text{Cl}^-]_o + P_{\\text{HCO}_3}[\\text{HCO}_3^-]_o \\;=\\; 1 \\cdot 130 + 0.2 \\cdot 24 \\;=\\; 134.8.\n$$\nThus,\n$$\nE_{\\text{rev}} \\;=\\; \\frac{R T}{F} \\,\\ln\\!\\left(\\frac{13}{134.8}\\right).\n$$\n\nAt $T=310~\\mathrm{K}$, $\\frac{R T}{F}$ has the numerical value\n$$\n\\frac{R T}{F} \\;=\\; \\frac{8.314462618~\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}\\times 310~\\text{K}}{96485.33212~\\text{C}\\,\\text{mol}^{-1}} \\;\\approx\\; 0.02672~\\text{V} \\;=\\; 26.72~\\text{mV}.\n$$\nEvaluate the logarithm:\n$$\n\\ln\\!\\left(\\frac{13}{134.8}\\right) \\;=\\; \\ln(0.09645\\ldots) \\;\\approx\\; -2.33884.\n$$\nTherefore,\n$$\nE_{\\text{rev}} \\;\\approx\\; (26.72~\\text{mV}) \\times (-2.33884) \\;\\approx\\; -62.5~\\text{mV}.\n$$\nRounded to three significant figures and expressed in millivolts, the result is $-62.5~\\mathrm{mV}$.", "answer": "$$\\boxed{-62.5}$$", "id": "2763536"}, {"introduction": "Our exploration culminates in a scenario that breaks the simple logarithmic form of the GHK equation, mirroring the complexity of biologically vital channels permeable to mixed-valence ions like $\\text{Na}^{+}$ and $\\text{Ca}^{2+}$. This advanced exercise [@problem_id:2763525] demonstrates that when ions of differing valences are involved, the zero-current condition yields a transcendental equation that requires a numerical solution. Engaging with this computational problem will equip you with the skills to model complex channels like NMDA receptors and appreciate the boundaries of analytical solutions in modern biophysics.", "problem": "You are asked to compute the reversal potential for a membrane channel permeable to calcium ions and sodium ions using a first-principles electrodiffusion model. Start from the steady-state Nernst–Planck description under the constant-field assumption, and enforce the zero net current condition across the membrane. Consider two ionic species: calcium with valence $z_{\\text{Ca}}=+2$ and sodium with valence $z_{\\text{Na}}=+1$. The absolute temperature is $T=310\\,\\mathrm{K}$, the gas constant is $R=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, and the Faraday constant is $F=96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$. The extracellular and intracellular activities (approximated here by concentrations) are as follows: $[\\text{Ca}]_o=2\\,\\mathrm{mM}$, $[\\text{Ca}]_i=100\\,\\mathrm{nM}$, $[\\text{Na}]_o=140\\,\\mathrm{mM}$, and $[\\text{Na}]_i=12\\,\\mathrm{mM}$. Ensure that all concentrations are used in consistent units; convert nanomolar to millimolar as necessary. Let the permeability ratio be $r=P_{\\text{Ca}}/P_{\\text{Na}}$, where $P_{\\text{Na}}>0$ is arbitrary because only the ratio matters at zero net current. The reversal potential $E_{\\text{rev}}$ is defined as the membrane potential $V_m$ (inside relative to outside) at which the total ionic current equals zero.\n\nYour task is to:\n- Derive, from the steady-state Nernst–Planck equation under the constant-field assumption, the expression for the ionic current of species $i$ with valence $z_i$ and permeability $P_i$ across a membrane at potential $V_m$ as a function of $[\\mathrm{ion}]_i$, $[\\mathrm{ion}]_o$, $z_i$, $P_i$, $R$, $T$, and $F$.\n- Impose the zero net current condition for the two-ion system $\\{\\text{Ca}^{2+},\\text{Na}^+\\}$ and show that $E_{\\text{rev}}$ is uniquely determined for given $r$ and concentrations, without using any pre-memorized shortcut formulas.\n- Implement a numerical root-finding algorithm to solve for $E_{\\text{rev}}$ in volts by finding $V_m$ that makes the total current zero for the given $r$.\n- Express the final answers in millivolts, rounded to three decimal places.\n\nUse the following test suite of permeability ratios to evaluate your program:\n- $r=0$\n- $r=0.01$\n- $r=0.1$\n- $r=1$\n- $r=10$\n- $r=1000$\n\nAll other parameters are fixed as specified above. Your program should output the six reversal potentials corresponding to these six test cases in a single line as a comma-separated list of floating-point numbers (in $\\mathrm{mV}$, rounded to three decimal places) enclosed in square brackets, for example: $[\\dots]$.\n\nPhysical units requirement: Express the final membrane potentials in $\\mathrm{mV}$, rounded to three decimal places.\n\nAngle units are not applicable. Percentages are not applicable.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,x_3,x_4,x_5,x_6]$), where each $x_k$ is a float in $\\mathrm{mV}$ rounded to three decimal places.", "solution": "The problem statement submitted for analysis is deemed valid. It is scientifically grounded, well-posed, and provides a complete and consistent set of parameters for a non-trivial problem in electrophysiology. It requires the derivation and application of fundamental principles, specifically the Nernst-Planck electrodiffusion model under the constant-field assumption.\n\nWe begin by deriving the current-voltage relationship for a single ionic species, which is the Goldman-Hodgkin-Katz (GHK) current equation. The starting point is the Nernst-Planck equation, which describes the flux $J_i(x)$ of an ionic species $i$ at position $x$ across the membrane:\n$$J_i(x) = -D_i \\left( \\frac{dC_i(x)}{dx} + \\frac{z_i F}{RT} C_i(x) \\frac{d\\phi(x)}{dx} \\right)$$\nHere, $D_i$ is the diffusion coefficient, $C_i(x)$ is the concentration, $z_i$ is the valence, $F$ is the Faraday constant, $R$ is the gas constant, $T$ is the absolute temperature, and $\\phi(x)$ is the electric potential.\n\nWe impose two key assumptions:\n1.  **Steady State**: The system is in a steady state, meaning the flux $J_i$ is constant for all $x$ within the membrane, i.e., $dJ_i/dx = 0$.\n2.  **Constant Field**: The electric field $E = -d\\phi/dx$ is constant across the membrane thickness $L$. If the potential difference across the membrane is $V_m = \\phi_{in} - \\phi_{out}$, then $E = -V_m/L$. Consequently, $d\\phi/dx = V_m/L$.\n\nSubstituting the constant field assumption into the Nernst-Planck equation yields a first-order linear ordinary differential equation for $C_i(x)$:\n$$\\frac{dC_i}{dx} + \\frac{z_i F V_m}{RT L} C_i(x) = -\\frac{J_i}{D_i}$$\nThis equation is solved subject to the boundary conditions at the outer ($x=0$) and inner ($x=L$) surfaces of the membrane: $C_i(0) = [i]_o$ and $C_i(L) = [i]_i$. The solution for the constant flux $J_i$ is:\n$$J_i = P_i \\frac{z_i F V_m}{RT} \\frac{[i]_i - [i]_o e^{-z_i F V_m / (RT)}}{1 - e^{-z_i F V_m / (RT)}}$$\nwhere the permeability $P_i$ is defined as $D_i/L$. The ionic current density $j_i$ is then $z_i F J_i$. The total current for a membrane area $A$ is $I_i = j_i A$. Customarily, permeability $P_i$ is defined to absorb geometric factors such that the current $I_i$ is written as:\n$$I_i(V_m) = P_i \\frac{z_i^2 F^2 V_m}{RT} \\frac{[i]_i - [i]_o e^{-z_i F V_m / (RT)}}{1 - e^{-z_i F V_m / (RT)}}$$\nThis is the GHK current equation. A positive current corresponds to a net outward flow of positive charge.\n\nThe reversal potential $E_{\\text{rev}}$ is the membrane potential $V_m$ at which the total current across the membrane is zero. For the given system permeable to sodium ($\\text{Na}^+$) and calcium ($\\text{Ca}^{2+}$), this condition is:\n$$I_{\\text{total}}(E_{\\text{rev}}) = I_{\\text{Na}}(E_{\\text{rev}}) + I_{\\text{Ca}}(E_{\\text{rev}}) = 0$$\nFor a non-zero reversal potential ($E_{\\text{rev}} \\ne 0$), the common factor $F^2 E_{\\text{rev}} / RT$ can be divided out, yielding:\n$$P_{\\text{Na}} z_{\\text{Na}}^2 \\frac{[\\text{Na}]_i - [\\text{Na}]_o e^{-z_{\\text{Na}} u}}{1 - e^{-z_{\\text{Na}} u}} + P_{\\text{Ca}} z_{\\text{Ca}}^2 \\frac{[\\text{Ca}]_i - [\\text{Ca}]_o e^{-z_{\\text{Ca}} u}}{1 - e^{-z_{\\text{Ca}} u}} = 0$$\nwhere $u = F E_{\\text{rev}} / (RT)$. Substituting the given valences $z_{\\text{Na}}=+1$ and $z_{\\text{Ca}}=+2$, and dividing by $P_{\\text{Na}}$ (which is non-zero), we obtain an equation in terms of the permeability ratio $r = P_{\\text{Ca}}/P_{\\text{Na}}$:\n$$(1)^2 \\frac{[\\text{Na}]_i - [\\text{Na}]_o e^{-u}}{1 - e^{-u}} + r (2)^2 \\frac{[\\text{Ca}]_i - [\\text{Ca}]_o e^{-2u}}{1 - e^{-2u}} = 0$$\nThis is a transcendental equation for the unknown $u$, and thus for $E_{\\text{rev}}$. Although the problem requires a numerical root-finding algorithm, it must be noted that this specific equation, due to the valences being $1$ and $2$, can be algebraically simplified. By letting $y = e^{-u}$ and using the identity $1-e^{-2u} = 1-y^2 = (1-y)(1+y)$, the equation transforms into a quadratic equation for $y$:\n$$([\\text{Na}]_o + 4r[\\text{Ca}]_o) y^2 + ([\\text{Na}]_o - [\\text{Na}]_i) y - ([\\text{Na}]_i + 4r[\\text{Ca}]_i) = 0$$\nSolving this provides an analytical solution for $E_{\\text{rev}} = -\\frac{RT}{F}\\ln(y)$. This is the more elegant and direct method. However, to adhere to the problem's explicit instruction, we will proceed with a numerical root-finding approach. The analytical solution serves as an excellent means of verification.\n\nTo implement the numerical solution, we define a function $f(V_m, r)$ representing the sum of the GHK flux terms, whose root we seek:\n$$f(V_m, r) = \\frac{[\\text{Na}]_i - [\\text{Na}]_o e^{-z_{\\text{Na}} V_m F / RT}}{1 - e^{-z_{\\text{Na}} V_m F / RT}} + 4r \\frac{[\\text{Ca}]_i - [\\text{Ca}]_o e^{-z_{\\text{Ca}} V_m F / RT}}{1 - e^{-z_{\\text{Ca}} V_m F / RT}}$$\nThe parameters are given as:\n$T = 310\\,\\mathrm{K}$\n$R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n$F = 96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$\n$z_{\\text{Na}} = +1$, $z_{\\text{Ca}} = +2$\n$[\\text{Na}]_o = 140\\,\\mathrm{mM}$, $[\\text{Na}]_i = 12\\,\\mathrm{mM}$\n$[\\text{Ca}]_o = 2\\,\\mathrm{mM}$, $[\\text{Ca}]_i = 100\\,\\mathrm{nM} = 0.0001\\,\\mathrm{mM}$\n\nA robust numerical search requires bracketing the root. The reversal potential $E_{\\text{rev}}$ is bounded by the Nernst potentials of the permeant ions. We calculate these boundaries:\n$$E_{\\text{Na}} = \\frac{RT}{z_{\\text{Na}}F} \\ln\\frac{[\\text{Na}]_o}{[\\text{Na}]_i} = \\frac{(8.314...)(310)}{(1)(96485...)} \\ln\\frac{140}{12} \\approx +65.623\\,\\mathrm{mV}$$\n$$E_{\\text{Ca}} = \\frac{RT}{z_{\\text{Ca}}F} \\ln\\frac{[\\text{Ca}]_o}{[\\text{Ca}]_i} = \\frac{(8.314...)(310)}{(2)(96485...)} \\ln\\frac{2}{0.0001} \\approx +132.255\\,\\mathrm{mV}$$\nFor any permeability ratio $r \\geq 0$, the reversal potential $E_{\\text{rev}}$ must lie in the interval $[E_{\\text{Na}}, E_{\\text{Ca}}]$. This provides a secure bracket for a root-finding algorithm such as the Brent-Dekker method (`brentq` in SciPy).\n\nThe algorithm proceeds as follows:\n1. Define the function $f(V_m, r)$ to be solved.\n2. For each given value of $r$ in the test suite $\\{0, 0.01, 0.1, 1, 10, 1000\\}$:\n   a. Handle the special case $r=0$, where $E_{\\text{rev}} = E_{\\text{Na}}$.\n   b. For $r > 0$, use a numerical root-finder with the interval $[E_{\\text{Na}}, E_{\\text{Ca}}]$ (in Volts) to find the root $V_m = E_{\\text{rev}}$.\n3. Convert the resulting potentials from Volts to Millivolts, round to three decimal places, and collect the results.\n\nThis procedure will yield the correct reversal potentials as requested.", "answer": "[65.623,65.642,65.811,67.433,80.957,129.626]", "id": "2763525"}]}