{"hands_on_practices": [{"introduction": "The number of CAR molecules on a T-cell surface is not a static value but a dynamic quantity governed by stochastic production and degradation. This exercise introduces the birth-death process, a fundamental tool in systems biology, to model this intrinsic \"expression noise.\" By deriving the steady-state mean and variance of the receptor count from first principles, you will develop a foundational understanding of the cell's molecular state, which is crucial for predicting its signaling behavior [@problem_id:2720770].", "problem": "A single T lymphocyte engineered to express a Chimeric Antigen Receptor (CAR) under a constitutive promoter is modeled at the receptor-protein level as follows. The number of CAR molecules on the plasma membrane, denoted by $N(t)$, evolves as a continuous-time Markov process on the nonnegative integers due to two opposing processes: (i) an effective zero-order production at constant rate $\\alpha$ (molecules per unit time) representing transcription, translation, and trafficking to the membrane as a single coarse-grained step, and (ii) a first-order loss at rate $\\delta N(t)$ (per unit time) representing endocytosis and degradation, where $\\delta$ is a constant. Assume a well-mixed cellular context, constant environmental conditions, and that the process satisfies the assumptions underlying the Chemical Master Equation (CME), namely that events occur as memoryless Poisson processes with the given propensities.\n\nStarting from the fundamental stochastic kinetics encoded by the CME and the definition of a birth–death process with zero-order birth and first-order death, derive the stationary probability distribution of $N$ and then compute the steady-state mean and variance of the CAR number. Provide your reasoning from first principles and do not assume any particular form for the stationary distribution a priori.\n\nExpress your final answer as a row matrix $\\begin{pmatrix}\\mu_{\\mathrm{ss}} & \\sigma_{\\mathrm{ss}}^{2}\\end{pmatrix}$ in terms of $\\alpha$ and $\\delta$. No numerical approximation is required, and no units should be included in the final answer. If you obtain a closed-form expression, leave it in exact form without rounding.", "solution": "The problem statement has been analyzed and is determined to be valid. It is scientifically grounded, well-posed, objective, and internally consistent, representing a canonical problem in stochastic systems biology. We may proceed to the solution.\n\nThe system describes the number of CAR molecules, $N$, on a cell membrane as a continuous-time birth-death process. The state of the system is the integer $n$, representing the number of molecules. The two stochastic processes are:\n1. Production (birth): A species, which we can denote as $\\emptyset$, is converted into a CAR molecule, $N$. The reaction is $\\emptyset \\xrightarrow{\\alpha} N$. This is a zero-order process, meaning its propensity (rate) is constant and independent of the number of existing molecules. The birth rate for a state with $n$ molecules is $b_n = \\alpha$.\n2. Degradation (death): A CAR molecule $N$ is removed from the system. The reaction is $N \\xrightarrow{\\delta} \\emptyset$. This is a first-order process, meaning its propensity is proportional to the number of molecules present. The death rate for a state with $n$ molecules is $d_n = \\delta n$.\n\nLet $P(n, t)$ be the probability of having $n$ molecules at time $t$. The time evolution of this probability distribution is governed by the Chemical Master Equation (CME). The change in probability for state $n$, $\\frac{dP(n, t)}{dt}$, is the sum of probability fluxes into state $n$ minus the sum of fluxes out of state $n$.\n\nFlux into state $n$:\n- From state $n-1$ via production: propensitity is $\\alpha$, so the flux is $\\alpha P(n-1, t)$.\n- From state $n+1$ via degradation: propensitity is $\\delta(n+1)$, so the flux is $\\delta(n+1) P(n+1, t)$.\n\nFlux out of state $n$:\n- To state $n+1$ via production: propensitity is $\\alpha$, so the flux is $\\alpha P(n, t)$.\n- To state $n-1$ via degradation: propensitity is $\\delta n$, so the flux is $\\delta n P(n, t)$.\n\nThe CME is therefore:\n$$ \\frac{dP(n, t)}{dt} = \\alpha P(n-1, t) + \\delta(n+1)P(n+1, t) - (\\alpha + \\delta n)P(n, t) \\quad \\text{for } n \\ge 1 $$\nA special case must be considered for $n=0$, as there can be no transitions from state $n=-1$ and no degradation from state $n=0$:\n$$ \\frac{dP(0, t)}{dt} = \\delta P(1, t) - \\alpha P(0, t) $$\n\nWe seek the stationary or steady-state probability distribution, $P_{\\mathrm{ss}}(n)$, where $\\frac{dP_{\\mathrm{ss}}(n)}{dt} = 0$ for all $n$. Let us denote this distribution by $P(n)$ for simplicity. The steady-state equations are:\n$$ 0 = \\alpha P(n-1) + \\delta(n+1)P(n+1) - (\\alpha + \\delta n)P(n) \\quad \\text{for } n \\ge 1 $$\n$$ 0 = \\delta P(1) - \\alpha P(0) \\quad \\text{for } n = 0 $$\nFor a one-dimensional birth-death process at steady state, the net probability flux between any two adjacent states must be zero. This principle is known as detailed balance. The flux from state $n$ to $n+1$ is due to production and equals $\\alpha P(n)$. The flux from $n+1$ to $n$ is due to degradation and equals $\\delta(n+1)P(n+1)$. Equating these gives the detailed balance condition:\n$$ \\alpha P(n) = \\delta(n+1) P(n+1) \\quad \\text{for } n \\ge 0 $$\nThis single recurrence relation is equivalent to the full set of steady-state master equations. We can solve it iteratively to find $P(n)$ in terms of $P(0)$:\n$$ P(n+1) = \\frac{\\alpha}{\\delta(n+1)} P(n) $$\nFor $n=0$: $P(1) = \\frac{\\alpha}{\\delta(1)}P(0) = \\frac{\\alpha}{\\delta}P(0)$\nFor $n=1$: $P(2) = \\frac{\\alpha}{\\delta(2)}P(1) = \\frac{\\alpha}{2\\delta} \\left(\\frac{\\alpha}{\\delta}P(0)\\right) = \\frac{1}{2}\\left(\\frac{\\alpha}{\\delta}\\right)^2 P(0)$\nContinuing this, we can see a pattern emerging:\n$P(n) = \\frac{\\alpha}{n\\delta} P(n-1) = \\frac{\\alpha}{n\\delta} \\frac{\\alpha}{(n-1)\\delta} \\cdots \\frac{\\alpha}{1\\delta} P(0) = \\frac{1}{n!} \\left(\\frac{\\alpha}{\\delta}\\right)^n P(0)$.\n\nTo determine $P(0)$, we use the normalization condition that the sum of all probabilities must equal $1$:\n$$ \\sum_{n=0}^{\\infty} P(n) = 1 $$\n$$ \\sum_{n=0}^{\\infty} \\frac{1}{n!} \\left(\\frac{\\alpha}{\\delta}\\right)^n P(0) = 1 $$\n$$ P(0) \\sum_{n=0}^{\\infty} \\frac{1}{n!} \\left(\\frac{\\alpha}{\\delta}\\right)^n = 1 $$\nThe sum is the Taylor series expansion for the exponential function, $\\sum_{k=0}^{\\infty} \\frac{x^k}{k!} = \\exp(x)$. With $x = \\alpha/\\delta$, we have:\n$$ P(0) \\exp\\left(\\frac{\\alpha}{\\delta}\\right) = 1 \\implies P(0) = \\exp\\left(-\\frac{\\alpha}{\\delta}\\right) $$\nSubstituting this back into our expression for $P(n)$, we obtain the stationary distribution:\n$$ P(n) = \\frac{(\\alpha/\\delta)^n}{n!} \\exp\\left(-\\frac{\\alpha}{\\delta}\\right) $$\nThis is a Poisson distribution with parameter $\\lambda = \\frac{\\alpha}{\\delta}$.\n\nNow, we compute the steady-state mean, $\\mu_{\\mathrm{ss}}$, and variance, $\\sigma_{\\mathrm{ss}}^2$.\nThe mean is the expectation value of $N$:\n$$ \\mu_{\\mathrm{ss}} = \\langle N \\rangle = \\sum_{n=0}^{\\infty} n P(n) $$\nFor a Poisson distribution with parameter $\\lambda$, the mean is $\\lambda$. We demonstrate this from first principles:\n$$ \\mu_{\\mathrm{ss}} = \\sum_{n=0}^{\\infty} n \\frac{\\lambda^n}{n!} \\exp(-\\lambda) = \\exp(-\\lambda) \\sum_{n=1}^{\\infty} n \\frac{\\lambda^n}{n!} $$\nSince $n/n! = 1/(n-1)!$ for $n \\ge 1$:\n$$ \\mu_{\\mathrm{ss}} = \\exp(-\\lambda) \\sum_{n=1}^{\\infty} \\frac{\\lambda^n}{(n-1)!} $$\nLet $k=n-1$. The sum becomes:\n$$ \\mu_{\\mathrm{ss}} = \\exp(-\\lambda) \\sum_{k=0}^{\\infty} \\frac{\\lambda^{k+1}}{k!} = \\lambda \\exp(-\\lambda) \\sum_{k=0}^{\\infty} \\frac{\\lambda^k}{k!} = \\lambda \\exp(-\\lambda) \\exp(\\lambda) = \\lambda $$\nThus, the steady-state mean is $\\mu_{\\mathrm{ss}} = \\frac{\\alpha}{\\delta}$.\n\nNext, we compute the variance, $\\sigma_{\\mathrm{ss}}^2 = \\langle N^2 \\rangle - \\mu_{\\mathrm{ss}}^2$.\nFor a Poisson distribution, the variance is also equal to its parameter $\\lambda$. We derive this by first computing the second factorial moment, $\\langle N(N-1) \\rangle$:\n$$ \\langle N(N-1) \\rangle = \\sum_{n=0}^{\\infty} n(n-1) P(n) = \\exp(-\\lambda) \\sum_{n=2}^{\\infty} n(n-1) \\frac{\\lambda^n}{n!} $$\nThe summation starts at $n=2$ as a factor of $n(n-1)$ is zero for $n=0,1$.\n$$ \\langle N(N-1) \\rangle = \\exp(-\\lambda) \\sum_{n=2}^{\\infty} \\frac{\\lambda^n}{(n-2)!} $$\nLet $k=n-2$. The sum becomes:\n$$ \\langle N(N-1) \\rangle = \\exp(-\\lambda) \\sum_{k=0}^{\\infty} \\frac{\\lambda^{k+2}}{k!} = \\lambda^2 \\exp(-\\lambda) \\sum_{k=0}^{\\infty} \\frac{\\lambda^k}{k!} = \\lambda^2 \\exp(-\\lambda) \\exp(\\lambda) = \\lambda^2 $$\nThe second moment $\\langle N^2 \\rangle$ is related to the factorial moment by $\\langle N^2 \\rangle = \\langle N(N-1) \\rangle + \\langle N \\rangle$.\n$$ \\langle N^2 \\rangle = \\lambda^2 + \\lambda $$\nThe variance is then:\n$$ \\sigma_{\\mathrm{ss}}^2 = \\langle N^2 \\rangle - \\mu_{\\mathrm{ss}}^2 = (\\lambda^2 + \\lambda) - (\\lambda)^2 = \\lambda $$\nThus, the steady-state variance is $\\sigma_{\\mathrm{ss}}^2 = \\frac{\\alpha}{\\delta}$.\n\nIn summary, for the given birth-death process, the steady-state number of CAR molecules follows a Poisson distribution with parameter $\\lambda = \\alpha/\\delta$. The mean and variance are both equal to this parameter.\n$\\mu_{\\mathrm{ss}} = \\frac{\\alpha}{\\delta}$\n$\\sigma_{\\mathrm{ss}}^2 = \\frac{\\alpha}{\\delta}$\nThe required result is the row matrix $\\begin{pmatrix}\\mu_{\\mathrm{ss}} & \\sigma_{\\mathrm{ss}}^{2}\\end{pmatrix}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\alpha}{\\delta} & \\frac{\\alpha}{\\delta}\n\\end{pmatrix}\n}\n$$", "id": "2720770"}, {"introduction": "A paramount challenge in CAR-T therapy is distinguishing tumor cells from healthy tissues that might express the same target antigen at lower densities. This exercise places you in the role of a designer optimizing a CAR-T cell's sensitivity by applying principles from Bayesian decision theory to find an optimal activation threshold, $\\theta$. This practice illuminates the critical trade-off between on-tumor efficacy (sensitivity) and off-tumor safety (specificity), a central consideration in engineering safer immunotherapies [@problem_id:2720703].", "problem": "A Chimeric Antigen Receptor T cell (CAR-T cell) is engineered to activate when it encounters a target cell whose surface antigen density exceeds a tunable signaling threshold, denoted by $\\theta$ molecules per cell. Consider an antigen whose per-cell copy number on tumor cells is modeled by a log-normal random variable $A_{T} \\sim \\mathrm{LogNormal}(\\mu_{T}, \\sigma^{2})$ and on healthy bystander cells by $A_{H} \\sim \\mathrm{LogNormal}(\\mu_{H}, \\sigma^{2})$, where $\\ln(A_{T}) \\sim \\mathcal{N}(\\mu_{T}, \\sigma^{2})$ and $\\ln(A_{H}) \\sim \\mathcal{N}(\\mu_{H}, \\sigma^{2})$. Suppose the medians are $10^{5}$ molecules per cell for tumor and $10^{3}$ molecules per cell for healthy, so that $\\mu_{T} = \\ln(10^{5})$ and $\\mu_{H} = \\ln(10^{3})$, and the shared log-space standard deviation is $\\sigma = 0.7$. Assume that, over the encounters relevant to safety and efficacy, the probability that a randomly encountered cell is tumor is $p_{T} = 0.4$ and healthy is $p_{H} = 0.6$, and that false activation on healthy and missed activation on tumor incur equal classification cost.\n\nUsing first principles from Bayesian decision theory and the definition of the log-normal probability density, derive from these premises the analytic expression for the threshold $\\theta$ that minimizes the expected total classification error (sum of false-positive and false-negative probabilities under the given encounter probabilities), and then evaluate it numerically for the parameters above. Express the final threshold $\\theta$ in molecules per cell and round your numerical answer to three significant figures.\n\nFinally, explain qualitatively, in terms of sensitivity and specificity, how increasing or decreasing $\\theta$ from the error-minimizing value trades off between on-tumor activation and off-tumor safety. Do not compute any additional numerical values in this discussion.", "solution": "Before attempting a solution, the problem statement is subjected to validation.\n\nThe givens are extracted verbatim as follows:\n- The CAR-T cell activation threshold is $\\theta$.\n- The antigen copy number on tumor cells, $A_{T}$, follows a log-normal distribution: $A_{T} \\sim \\mathrm{LogNormal}(\\mu_{T}, \\sigma^{2})$.\n- The antigen copy number on healthy cells, $A_{H}$, follows a log-normal distribution: $A_{H} \\sim \\mathrm{LogNormal}(\\mu_{H}, \\sigma^{2})$.\n- The relationship with the normal distribution is $\\ln(A_{T}) \\sim \\mathcal{N}(\\mu_{T}, \\sigma^{2})$ and $\\ln(A_{H}) \\sim \\mathcal{N}(\\mu_{H}, \\sigma^{2})$.\n- The median antigen count for tumor cells is $10^{5}$, implying $\\mu_{T} = \\ln(10^{5})$.\n- The median antigen count for healthy cells is $10^{3}$, implying $\\mu_{H} = \\ln(10^{3})$.\n- The shared log-space standard deviation is $\\sigma = 0.7$.\n- The probability of encountering a tumor cell is $p_{T} = 0.4$.\n- The probability of encountering a healthy cell is $p_{H} = 0.6$.\n- The classification costs for false activation on healthy cells (false positive) and missed activation on tumor cells (false negative) are equal.\n\nThe problem is scientifically grounded, using standard statistical models for biological quantities and applying Bayesian decision theory. It is well-posed, providing all necessary parameters ($\\mu_T, \\mu_H, \\sigma, p_T, p_H$) and a clear objective function to minimize. The premises are mathematically consistent and do not violate any physical or logical principles. The problem is therefore deemed valid, and a solution may be derived.\n\nThe objective is to find the threshold $\\theta$ that minimizes the total expected classification error. The classification errors are of two types:\n$1$. A false negative (missed tumor), which occurs with probability $P(A_{T} \\le \\theta)$.\n$2$. A false positive (attack on healthy cell), which occurs with probability $P(A_{H} > \\theta)$.\n\nGiven that the costs associated with these errors are equal, minimizing the expected cost is equivalent to minimizing the total probability of error, $E(\\theta)$, which is the weighted sum of the probabilities of each error type. The weights are the a priori probabilities of encountering each cell type, $p_T$ and $p_H$.\n$$E(\\theta) = p_{T} P(A_{T} \\le \\theta) + p_{H} P(A_{H} > \\theta)$$\nLet $f_{T}(a)$ and $f_{H}(a)$ be the probability density functions (PDFs) for the random variables $A_{T}$ and $A_{H}$, respectively. The error function can be written in integral form:\n$$E(\\theta) = p_{T} \\int_{0}^{\\theta} f_{T}(a) da + p_{H} \\int_{\\theta}^{\\infty} f_{H}(a) da$$\nTo find the value of $\\theta$ that minimizes $E(\\theta)$, we compute the derivative of $E(\\theta)$ with respect to $\\theta$ and set it to zero. Using the Fundamental Theorem of Calculus (specifically, the Leibniz integral rule):\n$$\\frac{d}{d\\theta} \\left( \\int_{0}^{\\theta} f_{T}(a) da \\right) = f_{T}(\\theta)$$\n$$\\frac{d}{d\\theta} \\left( \\int_{\\theta}^{\\infty} f_{H}(a) da \\right) = -f_{H}(\\theta)$$\nThus, the derivative of the error function is:\n$$\\frac{dE(\\theta)}{d\\theta} = p_{T} f_{T}(\\theta) - p_{H} f_{H}(\\theta)$$\nSetting the derivative to zero gives the condition for the optimal threshold, which we denote $\\theta_{\\text{opt}}$:\n$$p_{T} f_{T}(\\theta_{\\text{opt}}) = p_{H} f_{H}(\\theta_{\\text{opt}})$$\nThis is a standard result from Bayesian decision theory: the optimal decision boundary is where the posterior probabilities of the two classes are equal, which, for equal costs, simplifies to the likelihoods weighted by the priors being equal.\n\nThe PDF for a log-normal distribution with parameters $\\mu$ and $\\sigma^2$ is given by:\n$$f(a) = \\frac{1}{a\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(a)-\\mu)^2}{2\\sigma^2}\\right)$$\nSubstituting the PDFs for $A_T$ and $A_H$ into the optimality condition:\n$$p_{T} \\frac{1}{\\theta_{\\text{opt}}\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(\\theta_{\\text{opt}})-\\mu_{T})^2}{2\\sigma^2}\\right) = p_{H} \\frac{1}{\\theta_{\\text{opt}}\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(\\theta_{\\text{opt}})-\\mu_{H})^2}{2\\sigma^2}\\right)$$\nThe common factor $\\frac{1}{\\theta_{\\text{opt}}\\sigma\\sqrt{2\\pi}}$ cancels from both sides, provided $\\theta_{\\text{opt}} > 0$, which is guaranteed.\n$$p_{T} \\exp\\left(-\\frac{(\\ln(\\theta_{\\text{opt}})-\\mu_{T})^2}{2\\sigma^2}\\right) = p_{H} \\exp\\left(-\\frac{(\\ln(\\theta_{\\text{opt}})-\\mu_{H})^2}{2\\sigma^2}\\right)$$\nTaking the natural logarithm of both sides:\n$$\\ln(p_{T}) - \\frac{(\\ln(\\theta_{\\text{opt}})-\\mu_{T})^2}{2\\sigma^2} = \\ln(p_{H}) - \\frac{(\\ln(\\theta_{\\text{opt}})-\\mu_{H})^2}{2\\sigma^2}$$\nTo solve for $\\theta_{\\text{opt}}$, we first solve for $x = \\ln(\\theta_{\\text{opt}})$. Rearranging the equation:\n$$(\\ln(\\theta_{\\text{opt}})-\\mu_{H})^2 - (\\ln(\\theta_{\\text{opt}})-\\mu_{T})^2 = 2\\sigma^2 (\\ln(p_{H}) - \\ln(p_{T}))$$\nExpanding the squared terms:\n$$((\\ln\\theta_{\\text{opt}})^2 - 2\\ln(\\theta_{\\text{opt}})\\mu_{H} + \\mu_{H}^2) - ((\\ln\\theta_{\\text{opt}})^2 - 2\\ln(\\theta_{\\text{opt}})\\mu_{T} + \\mu_{T}^2) = 2\\sigma^2 \\ln\\left(\\frac{p_{H}}{p_{T}}\\right)$$\n$$-2\\ln(\\theta_{\\text{opt}})\\mu_{H} + \\mu_{H}^2 + 2\\ln(\\theta_{\\text{opt}})\\mu_{T} - \\mu_{T}^2 = 2\\sigma^2 \\ln\\left(\\frac{p_{H}}{p_{T}}\\right)$$\n$$2\\ln(\\theta_{\\text{opt}})(\\mu_{T} - \\mu_{H}) - (\\mu_{T}^2 - \\mu_{H}^2) = 2\\sigma^2 \\ln\\left(\\frac{p_{H}}{p_{T}}\\right)$$\nFactoring $\\mu_{T}^2 - \\mu_{H}^2 = (\\mu_{T} - \\mu_{H})(\\mu_{T} + \\mu_{H})$:\n$$2\\ln(\\theta_{\\text{opt}})(\\mu_{T} - \\mu_{H}) - (\\mu_{T} - \\mu_{H})(\\mu_{T} + \\mu_{H}) = 2\\sigma^2 \\ln\\left(\\frac{p_{H}}{p_{T}}\\right)$$\n$$2\\ln(\\theta_{\\text{opt}})(\\mu_{T} - \\mu_{H}) = (\\mu_{T} - \\mu_{H})(\\mu_{T} + \\mu_{H}) + 2\\sigma^2 \\ln\\left(\\frac{p_{H}}{p_{T}}\\right)$$\nDividing by $2(\\mu_{T} - \\mu_{H})$ (which is non-zero as $\\mu_T \\neq \\mu_H$):\n$$\\ln(\\theta_{\\text{opt}}) = \\frac{\\mu_{T} + \\mu_{H}}{2} + \\frac{\\sigma^2}{\\mu_{T} - \\mu_{H}} \\ln\\left(\\frac{p_{H}}{p_{T}}\\right)$$\nExponentiating both sides yields the final analytic expression for the optimal threshold $\\theta$:\n$$\\theta_{\\text{opt}} = \\exp\\left( \\frac{\\mu_{T} + \\mu_{H}}{2} + \\frac{\\sigma^2}{\\mu_{T} - \\mu_{H}} \\ln\\left(\\frac{p_{H}}{p_{T}}\\right) \\right)$$\nNow, we evaluate this expression numerically with the provided parameters:\n$\\mu_T = \\ln(10^5)$\n$\\mu_H = \\ln(10^3)$\n$\\sigma = 0.7 \\implies \\sigma^2 = 0.49$\n$p_T = 0.4$\n$p_H = 0.6$\nFirst, calculate the terms in the exponent:\n$\\frac{\\mu_{T} + \\mu_{H}}{2} = \\frac{\\ln(10^5) + \\ln(10^3)}{2} = \\frac{\\ln(10^5 \\cdot 10^3)}{2} = \\frac{\\ln(10^8)}{2} = 4\\ln(10) = \\ln(10^4)$.\n$\\mu_{T} - \\mu_{H} = \\ln(10^5) - \\ln(10^3) = \\ln\\left(\\frac{10^5}{10^3}\\right) = \\ln(100) = 2\\ln(10)$.\n$\\frac{p_{H}}{p_{T}} = \\frac{0.6}{0.4} = 1.5$.\nSubstitute these into the expression for $\\ln(\\theta_{\\text{opt}})$:\n$$\\ln(\\theta_{\\text{opt}}) = \\ln(10^4) + \\frac{0.49}{2\\ln(10)} \\ln(1.5)$$\n$$\\theta_{\\text{opt}} = \\exp\\left( \\ln(10^4) + \\frac{0.49 \\ln(1.5)}{2\\ln(10)} \\right) = \\exp(\\ln(10^4)) \\cdot \\exp\\left(\\frac{0.49 \\ln(1.5)}{2\\ln(10)}\\right)$$\n$$\\theta_{\\text{opt}} = 10^4 \\cdot \\exp\\left(\\frac{0.49 \\times 0.405465...}{2 \\times 2.302585...}\\right) = 10^4 \\cdot \\exp\\left(\\frac{0.198677...}{4.605170...}\\right)$$\n$$\\theta_{\\text{opt}} = 10^4 \\cdot \\exp(0.043141...) = 10^4 \\cdot (1.04408...) \\approx 10440.8$$\nRounding to three significant figures, the optimal threshold is $10400$ molecules per cell, or $1.04 \\times 10^4$.\n\nFinally, a qualitative explanation of the trade-off. The performance of the CAR-T cell as a classifier is described by its sensitivity and specificity.\n- **Sensitivity**, or the true positive rate, is the probability of activation given a tumor cell: $P(A_T > \\theta)$. This corresponds to on-tumor efficacy.\n- **Specificity**, or the true negative rate, is the probability of non-activation given a healthy cell: $P(A_H \\le \\theta)$. This corresponds to off-tumor safety.\nThe optimal threshold $\\theta_{\\text{opt}}$ is the value that minimizes a specific weighted sum of errors. Deviating from this value changes the balance between sensitivity and specificity.\n\n- **Increasing $\\theta$** from $\\theta_{\\text{opt}}$ makes activation more difficult. This increases the stringency of the CAR-T cell. Consequently, the probability of activating on a healthy cell decreases, leading to an increase in specificity ($P(A_H \\le \\theta)$ increases). This improves off-tumor safety. However, the probability of activating on a tumor cell also decreases, leading to a decrease in sensitivity ($P(A_T > \\theta)$ decreases). This reduces on-tumor efficacy. Thus, increasing $\\theta$ trades sensitivity for specificity.\n\n- **Decreasing $\\theta$** from $\\theta_{\\text{opt}}$ makes activation easier. This lowers the stringency of the CAR-T cell. Consequently, the probability of activating on a tumor cell increases, leading to an increase in sensitivity ($P(A_T > \\theta)$ increases). This enhances on-tumor efficacy. However, the probability of activating on a healthy cell also increases, meaning the probability of non-activation on a healthy cell decreases. This is a decrease in specificity ($P(A_H \\le \\theta)$ decreases), compromising off-tumor safety. Thus, decreasing $\\theta$ trades specificity for sensitivity.\nThe calculated $\\theta_{\\text{opt}}$ represents the rationally derived balance point for the given priors and equal error costs.", "answer": "$$\n\\boxed{1.04 \\times 10^{4}}\n$$", "id": "2720703"}, {"introduction": "The long-term effectiveness of CAR-T therapy hinges on the persistence and expansion of the engineered cell population after infusion. Different intracellular costimulatory domains, such as CD28 or 4-1BB, profoundly affect these dynamics by altering cell proliferation, survival, and differentiation. This computational practice challenges you to implement a population dynamics model to simulate and quantitatively compare how these molecular design choices translate into macroscopic clonal expansion trajectories, linking receptor architecture directly to therapeutic potential [@problem_id:2720765].", "problem": "A minimal two-compartment birth–death–differentiation model is used to compare clonal expansion trajectories of chimeric antigen receptor T cells (CAR-T) engineered with distinct costimulatory domains, specifically Cluster of Differentiation 28 (CD28) and 4-1BB (also known as TNFRSF9). The model tracks an effector-like population $E(t)$ and a memory-like population $M(t)$, with time $t$ in days. The fundamental base for the model is the well-tested population-dynamics principle that, under mass-action assumptions, cell numbers in homogeneous compartments follow linear ordinary differential equations whose coefficients are net per-capita rates.\n\nModel definition and assumptions:\n- Effector-like cells proliferate at per-capita rate $r$, die at per-capita rate $d$, and differentiate to memory-like cells at per-capita rate $k$. Thus the net per-capita rate for $E(t)$ is $r - d - k$.\n- Memory-like cells proliferate at per-capita rate $r_m$ and die at per-capita rate $d_m$. Thus the net per-capita rate for $M(t)$ is $r_m - d_m$.\n- Differentiation from effector-like to memory-like cells occurs at per-capita rate $k$ and contributes a source term for $M(t)$ proportional to $E(t)$.\n- Initial conditions are $E(0) = E_0$ and $M(0) = 0$.\n- For a given costimulatory design $X \\in \\{\\text{CD28}, \\text{4-1BB}\\}$, the parameters $(r_X, d_X)$ may differ, while $(k, r_m, d_m)$ are held fixed within a test case.\n\nThe governing equations are\n$$\n\\frac{dE}{dt} = \\left(r - d - k\\right) E, \\qquad \\frac{dM}{dt} = k E + \\left(r_m - d_m\\right) M,\n$$\nwith $E(0) = E_0$ and $M(0) = 0$. Define the total cell count $T(t) = E(t) + M(t)$.\n\nTask:\n- For each test case below, compute, over the time window $t \\in [0, t_{\\max}]$ (with $t$ in days), the following three quantitative comparisons between the 4-1BB and CD28 designs:\n  1. The final-time fold-change\n     $$\n     F = \\frac{T_{\\text{4-1BB}}(t_{\\max})}{T_{\\text{CD28}}(t_{\\max})},\n     $$\n     reported as a decimal (no percentage sign).\n  2. The difference in peak times\n     $$\n     \\Delta t_{\\text{peak}} = t_{\\text{peak, 4-1BB}} - t_{\\text{peak, CD28}},\n     $$\n     where $t_{\\text{peak},X}$ is the time in days at which $T_X(t)$ achieves its maximum on $[0, t_{\\max}]$; report $\\Delta t_{\\text{peak}}$ in days.\n  3. The ratio of areas under the curve\n     $$\n     R_{\\text{AUC}} = \\frac{\\int_{0}^{t_{\\max}} T_{\\text{4-1BB}}(t)\\, dt}{\\int_{0}^{t_{\\max}} T_{\\text{CD28}}(t)\\, dt},\n     $$\n     reported as a decimal (no percentage sign). The integral has units of cell-days, but report only the dimensionless ratio.\n\nImplementation constraints:\n- Use the exact analytical solution implied by the linear system above for $E(t)$ and $M(t)$. When the parameter combination satisfies $\\alpha = r - d - k$ and $\\beta = r_m - d_m$ with $\\alpha = \\beta$, use the correct limiting solution for $M(t)$.\n- For peak time detection and area computation on $[0, t_{\\max}]$, a uniform grid with sufficient resolution is acceptable, but the model evaluation at each grid point must use the analytical solution. Time is in days and any reported time difference must be in days.\n- All reported numerical outputs must be rounded to $6$ decimal places.\n\nTest suite:\nProvide results for the following four test cases. Within a given test case, $(k, r_m, d_m, E_0, t_{\\max})$ are common to both designs, while $(r, d)$ differ between CD28 and 4-1BB as specified.\n\n- Test case $1$ (typical trade-off: higher proliferation and higher death for CD28, lower proliferation and lower death for 4-1BB):\n  - Common: $k = 0.15\\, \\text{day}^{-1}$, $r_m = 0.05\\, \\text{day}^{-1}$, $d_m = 0.01\\, \\text{day}^{-1}$, $E_0 = 10{,}000$, $t_{\\max} = 30\\, \\text{days}$.\n  - CD28: $r_{\\text{CD28}} = 0.8\\, \\text{day}^{-1}$, $d_{\\text{CD28}} = 0.3\\, \\text{day}^{-1}$.\n  - 4-1BB: $r_{\\text{4-1BB}} = 0.6\\, \\text{day}^{-1}$, $d_{\\text{4-1BB}} = 0.1\\, \\text{day}^{-1}$.\n\n- Test case $2$ (boundary condition for CD28 with $\\alpha = \\beta$):\n  - Common: $k = 0.12\\, \\text{day}^{-1}$, $r_m = 0.10\\, \\text{day}^{-1}$, $d_m = 0.02\\, \\text{day}^{-1}$, $E_0 = 20{,}000$, $t_{\\max} = 20\\, \\text{days}$.\n  - CD28: $r_{\\text{CD28}} = 0.5\\, \\text{day}^{-1}$, $d_{\\text{CD28}} = 0.3\\, \\text{day}^{-1}$, which gives $\\alpha_{\\text{CD28}} = r - d - k = 0.5 - 0.3 - 0.12 = 0.08$ and $\\beta = r_m - d_m = 0.10 - 0.02 = 0.08$, so $\\alpha_{\\text{CD28}} = \\beta$.\n  - 4-1BB: $r_{\\text{4-1BB}} = 0.4\\, \\text{day}^{-1}$, $d_{\\text{4-1BB}} = 0.15\\, \\text{day}^{-1}$.\n\n- Test case $3$ (identical kinetics across designs as a control):\n  - Common: $k = 0.10\\, \\text{day}^{-1}$, $r_m = 0.05\\, \\text{day}^{-1}$, $d_m = 0.01\\, \\text{day}^{-1}$, $E_0 = 1{,}000$, $t_{\\max} = 10\\, \\text{days}$.\n  - CD28: $r_{\\text{CD28}} = 0.5\\, \\text{day}^{-1}$, $d_{\\text{CD28}} = 0.2\\, \\text{day}^{-1}$.\n  - 4-1BB: $r_{\\text{4-1BB}} = 0.5\\, \\text{day}^{-1}$, $d_{\\text{4-1BB}} = 0.2\\, \\text{day}^{-1}$.\n\n- Test case $4$ (net negative effector growth for both designs; survival advantage from lower death):\n  - Common: $k = 0.20\\, \\text{day}^{-1}$, $r_m = 0.02\\, \\text{day}^{-1}$, $d_m = 0.03\\, \\text{day}^{-1}$, $E_0 = 50{,}000$, $t_{\\max} = 60\\, \\text{days}$.\n  - CD28: $r_{\\text{CD28}} = 0.25\\, \\text{day}^{-1}$, $d_{\\text{CD28}} = 0.50\\, \\text{day}^{-1}$.\n  - 4-1BB: $r_{\\text{4-1BB}} = 0.30\\, \\text{day}^{-1}$, $d_{\\text{4-1BB}} = 0.40\\, \\text{day}^{-1}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets.\n- The output must be a flattened list of length $12$, ordered as $[F_1, \\Delta t_{\\text{peak},1}, R_{\\text{AUC},1}, F_2, \\Delta t_{\\text{peak},2}, R_{\\text{AUC},2}, F_3, \\Delta t_{\\text{peak},3}, R_{\\text{AUC},3}, F_4, \\Delta t_{\\text{peak},4}, R_{\\text{AUC},4}]$.\n- All numbers must be rounded to $6$ decimal places and reported without units, except that $\\Delta t_{\\text{peak}}$ is implicitly in days by construction.", "solution": "The problem statement has been validated and is deemed valid. It presents a well-posed initial value problem based on a standard linear ordinary differential equation model from population dynamics, applied to the relevant field of CAR-T cell engineering. All necessary parameters and conditions are provided, and the tasks are objective and mathematically precise.\n\nThe model is a system of two linear first-order ordinary differential equations:\n$$\n\\frac{dE}{dt} = \\left(r - d - k\\right) E\n$$\n$$\n\\frac{dM}{dt} = k E + \\left(r_m - d_m\\right) M\n$$\nwith initial conditions $E(0) = E_0$ and $M(0) = 0$.\n\nTo proceed, we define the net per-capita growth rates for the effector and memory populations, respectively, as:\n$$\n\\alpha = r - d - k\n$$\n$$\n\\beta = r_m - d_m\n$$\nThe system of equations becomes:\n$$\n\\frac{dE}{dt} = \\alpha E\n$$\n$$\n\\frac{dM}{dt} = k E + \\beta M\n$$\n\nFirst, we solve for the effector population $E(t)$. The equation for $E(t)$ is a standard exponential growth/decay model. With the initial condition $E(0) = E_0$, the solution is:\n$$\nE(t) = E_0 e^{\\alpha t}\n$$\nNext, we substitute this solution into the equation for $M(t)$:\n$$\n\\frac{dM}{dt} - \\beta M = k E_0 e^{\\alpha t}\n$$\nThis is a first-order linear non-homogeneous differential equation, which is solved using an integrating factor $I(t) = e^{-\\beta t}$. The solution depends on whether $\\alpha$ and $\\beta$ are equal.\n\nCase 1: $\\alpha \\neq \\beta$\nMultiplying by the integrating factor and integrating yields:\n$$\n\\frac{d}{dt}(M(t)e^{-\\beta t}) = k E_0 e^{(\\alpha - \\beta)t}\n$$\n$$\nM(t)e^{-\\beta t} = \\frac{k E_0}{\\alpha - \\beta} e^{(\\alpha - \\beta)t} + C\n$$\nUsing the initial condition $M(0) = 0$, we find the constant of integration $C = -\\frac{k E_0}{\\alpha - \\beta}$.\nThus, the solution for the memory-like population is:\n$$\nM(t) = \\frac{k E_0}{\\alpha - \\beta} \\left( e^{\\alpha t} - e^{\\beta t} \\right)\n$$\n\nCase 2: $\\alpha = \\beta$\nIn this special case, the differential equation for $M(t)$ becomes:\n$$\n\\frac{d}{dt}(M(t)e^{-\\alpha t}) = k E_0 e^{(\\alpha - \\alpha)t} = k E_0\n$$\nIntegrating with respect to $t$:\n$$\nM(t)e^{-\\alpha t} = k E_0 t + C\n$$\nThe initial condition $M(0)=0$ implies $C=0$. The solution is therefore:\n$$\nM(t) = k E_0 t e^{\\alpha t}\n$$\n\nThe total cell count is $T(t) = E(t) + M(t)$.\nFor $\\alpha \\neq \\beta$:\n$$\nT(t) = E_0 e^{\\alpha t} + \\frac{k E_0}{\\alpha - \\beta} \\left( e^{\\alpha t} - e^{\\beta t} \\right) = E_0 \\left( \\left(1 + \\frac{k}{\\alpha - \\beta} \\right) e^{\\alpha t} - \\frac{k}{\\alpha - \\beta} e^{\\beta t} \\right)\n$$\nFor $\\alpha = \\beta$:\n$$\nT(t) = E_0 e^{\\alpha t} + k E_0 t e^{\\alpha t} = E_0 (1 + kt) e^{\\alpha t}\n$$\n\nThe three required metrics are calculated as follows:\n1.  **Final-time fold-change, $F$**: This is computed by direct evaluation of the analytical solutions $T_{\\text{4-1BB}}(t)$ and $T_{\\text{CD28}}(t)$ at $t = t_{\\max}$.\n    $$\n    F = \\frac{T_{\\text{4-1BB}}(t_{\\max})}{T_{\\text{CD28}}(t_{\\max})}\n    $$\n2.  **Difference in peak times, $\\Delta t_{\\text{peak}}$**: For each design, the peak time $t_{\\text{peak}}$ is the time $t \\in [0, t_{\\max}]$ that maximizes $T(t)$. As permitted, this is found by evaluating the analytical solution $T(t)$ on a fine uniform time grid over the interval $[0, t_{\\max}]$ and identifying the time corresponding to the maximum value.\n3.  **Ratio of areas under the curve, $R_{\\text{AUC}}$**: This requires integrating $T(t)$ from $0$ to $t_{\\max}$. We compute this analytically by integrating the expressions for $E(t)$ and $M(t)$ separately.\n    The total area under the curve is $\\text{AUC} = \\int_{0}^{t_{\\max}} E(t) dt + \\int_{0}^{t_{\\max}} M(t) dt$.\n\n    Integral of $E(t)$:\n    $$ \\int_{0}^{t_{\\max}} E_0 e^{\\alpha t} dt = \\begin{cases} \\frac{E_0}{\\alpha}(e^{\\alpha t_{\\max}} - 1) & \\text{if } \\alpha \\neq 0 \\\\ E_0 t_{\\max} & \\text{if } \\alpha = 0 \\end{cases} $$\n\n    Integral of $M(t)$ for $\\alpha \\neq \\beta$:\n    $$ \\int_{0}^{t_{\\max}} M(t) dt = \\frac{k E_0}{\\alpha - \\beta} \\left( \\int_{0}^{t_{\\max}} e^{\\alpha t} dt - \\int_{0}^{t_{\\max}} e^{\\beta t} dt \\right) $$\n    The result depends on whether $\\alpha$ or $\\beta$ are zero, handled by the case-wise integral of the exponential function above.\n\n    Integral of $M(t)$ for $\\alpha = \\beta$:\n    $$ \\int_{0}^{t_{\\max}} k E_0 t e^{\\alpha t} dt = \\begin{cases} \\frac{k E_0}{\\alpha^2} \\left[ e^{\\alpha t_{\\max}}(\\alpha t_{\\max} - 1) + 1 \\right] & \\text{if } \\alpha \\neq 0 \\\\ \\frac{1}{2} k E_0 t_{\\max}^2 & \\text{if } \\alpha = 0 \\end{cases} $$\n    The ratio $R_{\\text{AUC}}$ is then the ratio of the total AUC for the 4-1BB design to that of the CD28 design.\n\nA Python script implements these analytical solutions and calculation procedures to determine the required metrics for each test case.", "answer": "```\n[1.000000,0.000000,1.000000,0.222724,1.800000,0.473523,1.000000,0.000000,1.000000,1.487042,0.000000,1.439363]\n```", "id": "2720765"}]}