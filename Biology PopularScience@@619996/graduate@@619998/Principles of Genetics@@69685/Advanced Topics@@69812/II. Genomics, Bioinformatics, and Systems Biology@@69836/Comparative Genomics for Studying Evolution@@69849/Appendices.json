{"hands_on_practices": [{"introduction": "Distinguishing between orthologs and paralogs is a cornerstone of comparative genomics, as it allows us to correctly infer gene function and trace evolutionary history. This exercise [@problem_id:2800806] challenges you to apply the formal definitions by reconciling a gene's history of duplication and loss with a known species tree. Mastering this skill is essential for interpreting the complex relationships within gene families across a diverse range of species.", "problem": "In comparative genomics, orthology and paralogy are inferred by reconciling a gene family’s history with a species phylogeny and classifying each divergence as arising from either a speciation or a duplication event. Use the following standard definitions as the fundamental base: two genes are orthologs if their most recent common ancestor (MRCA) is a speciation, and paralogs if their MRCA is a duplication. Co-orthologs arise when, due to post-speciation duplications, multiple genes in one lineage are each orthologous to a single gene in another lineage. Consider a gene family sampled from $3$ species with species tree in which species $A$ and $B$ are sister taxa and $C$ is the outgroup (that is, $A$ and $B$ share a more recent common ancestor with each other than either does with $C$). The reconciled history of this gene family is as follows (all events are explicitly labeled):\n\n- In the last common ancestor of $A$, $B$, and $C$, a duplication event $D_0$ produced two copies, denoted $X$ and $Y$.\n- Along the lineage leading to the ancestor of $A$ and $B$ (after the split from $C$), a duplication event $D_1$ occurred on copy $Y$, generating $Y_1$ and $Y_2$.\n- Gene losses then occurred as follows: on the $C$ lineage, $X$ was lost; on the $A$ lineage, $Y_2$ was lost; on the $B$ lineage, $X$ and $Y_1$ were lost. No other duplications, losses, or horizontal transfers took place.\n\nConsequently, the extant gene repertoire is: species $A$ carries genes $A\\_X$ and $A\\_{Y1}$; species $B$ carries gene $B\\_{Y2}$; species $C$ carries gene $C\\_Y$.\n\nUsing only the definitions above and the stated event history, classify each of the following pairs as orthologs or paralogs by tracing their MRCA to either a speciation or duplication event:\n\n1. $A\\_X$ versus $A\\_{Y1}$\n2. $A\\_{Y1}$ versus $B\\_{Y2}$\n3. $A\\_{Y1}$ versus $C\\_Y$\n4. $B\\_{Y2}$ versus $C\\_Y$\n5. $A\\_X$ versus $C\\_Y$\n\nChoose the option whose classifications are all correct.\n\nA. 1: paralogs; 2: paralogs; 3: orthologs; 4: orthologs; 5: paralogs\n\nB. 1: paralogs; 2: orthologs; 3: orthologs; 4: orthologs; 5: orthologs\n\nC. 1: orthologs; 2: orthologs; 3: paralogs; 4: orthologs; 5: orthologs\n\nD. 1: paralogs; 2: orthologs; 3: paralogs; 4: paralogs; 5: orthologs", "solution": "The problem statement presents a well-defined scenario in comparative genomics. The axioms, including the definitions of orthology and paralogy, the species phylogeny, and the gene family history, are scientifically sound, internally consistent, and sufficient for a unique solution. The problem is declared valid.\n\nWe proceed with a rigorous derivation by first reconstructing the evolutionary history of the gene family within the specified species tree.\n\nThe species phylogeny is given as a tree where species $A$ and $B$ are sister taxa, and species $C$ is an outgroup. This can be represented as $((A, B), C)$. Let $S_{ABC}$ be the speciation event that separated the lineage leading to species $C$ from the lineage leading to the common ancestor of $A$ and $B$. Let $S_{AB}$ be the speciation event that separated the lineage leading to species $A$ from the lineage leading to species $B$.\n\nThe sequence of events for the gene family is as follows:\n$1$. In the last common ancestor of all three species $(A, B, C)$, a gene duplication event, $D_0$, occurred, creating two gene lineages, $X$ and $Y$. These lineages are paralogous to each other by definition, with their most recent common ancestor (MRCA) being the duplication event $D_0$.\n\n$2$. The speciation event $S_{ABC}$ occurred. Both gene lineages, $X$ and $Y$, were passed down to the two resulting species lineages: the lineage leading to $C$ and the lineage leading to the common ancestor of $(A, B)$.\n\n$3$. On the lineage leading to species $C$, the gene copy from lineage $X$ was lost. The gene copy from lineage $Y$ persisted, and its descendant in the extant species $C$ is denoted as $C\\_Y$.\n\n$4$. On the lineage leading to the common ancestor of $(A, B)$, after the split from $C$ (i.e., after $S_{ABC}$), a second duplication event, $D_1$, occurred. This duplication acted on the gene copy from lineage $Y$, creating two new sub-lineages, $Y_1$ and $Y_2$. At this point, just before the next speciation, this ancestral species possessed three gene lineages: $X$, $Y_1$, and $Y_2$.\n\n$5$. The speciation event $S_{AB}$ occurred. All three gene lineages ($X$, $Y_1$, $Y_2$) were passed down to the two resulting species lineages: the lineage leading to $A$ and the lineage leading to $B$.\n\n$6$. On the lineage leading to species $A$, the gene copy from lineage $Y_2$ was lost. The surviving descendants in the extant species $A$ are $A\\_X$ (from lineage $X$) and $A\\_{Y1}$ (from lineage $Y_1$).\n\n$7$. On the lineage leading to species $B$, the gene copies from lineages $X$ and $Y_1$ were lost. The surviving descendant in the extant species $B$ is $B\\_{Y2}$ (from lineage $Y_2$).\n\nWe now classify each specified gene pair by tracing their lineages back to their MRCA and determining if that ancestral node corresponds to a speciation or a duplication event.\n\n$1$. **$A\\_X$ versus $A\\_{Y1}$**:\nThese genes are within the same species, $A$. $A\\_X$ descends from the ancestral lineage $X$. $A\\_{Y1}$ descends from the ancestral lineage $Y_1$, which itself descends from lineage $Y$. The lineages $X$ and $Y$ diverged at the duplication event $D_0$ in the common ancestor of $A$, $B$, and $C$. Therefore, the MRCA of $A\\_X$ and $A\\_{Y1}$ is the duplication event $D_0$. By definition, they are **paralogs**.\n\n$2$. **$A\\_{Y1}$ versus $B\\_{Y2}$**:\n$A\\_{Y1}$ descends from lineage $Y_1$. $B\\_{Y2}$ descends from lineage $Y_2$. These two lineages, $Y_1$ and $Y_2$, were created by the duplication event $D_1$. This duplication $D_1$ occurred in the common ancestor of $A$ and $B$, *before* the speciation event $S_{AB}$ that separated them. The MRCA of $A\\_{Y1}$ and $B\\_{Y2}$ is the duplication event $D_1$. By definition, they are **paralogs**.\n\n$3$. **$A\\_{Y1}$ versus $C\\_Y$**:\n$A\\_{Y1}$ descends from lineage $Y_1$, which descends from lineage $Y$. $C\\_Y$ also descends from lineage $Y$. To find their MRCA, we trace them back. The lineage of $A\\_{Y1}$ goes back to the gene copy $Y$ in the common ancestor of $(A, B)$. The lineage of $C\\_Y$ goes back to the gene copy $Y$ in the common ancestor of $C$. These two ancestral gene copies themselves trace back to a single gene copy (lineage $Y$) that existed just before the speciation $S_{ABC}$. The event that caused the divergence of the lineages leading to $A\\_{Y1}$ and $C\\_Y$ was the speciation event $S_{ABC}$. The duplication $D_1$ is a post-speciation event relative to $S_{ABC}$. Therefore, the MRCA of $A\\_{Y1}$ and $C\\_Y$ is the speciation $S_{ABC}$. By definition, they are **orthologs**.\n\n$4$. **$B\\_{Y2}$ versus $C\\_Y$**:\nThe logic is identical to the previous case. $B\\_{Y2}$ descends from lineage $Y_2$, which descends from lineage $Y$. $C\\_Y$ descends from lineage $Y$. The event that caused the divergence of the lineages leading to $B\\_{Y2}$ and $C\\_Y$ was the speciation event $S_{ABC}$. Therefore, their MRCA is the speciation $S_{ABC}$. By definition, they are **orthologs**.\n\n$5$. **$A\\_X$ versus $C\\_Y$**:\n$A\\_X$ descends from the ancestral lineage $X$. $C\\_Y$ descends from the ancestral lineage $Y$. These two lineages, $X$ and $Y$, diverged at the duplication event $D_0$. This event $D_0$ occurred in the root ancestor, before the speciation event $S_{ABC}$. The MRCA of $A\\_X$ and $C\\_Y$ is the duplication event $D_0$. By definition, they are **paralogs**.\n\nSummary of classifications:\n$1$. $A\\_X$ vs $A\\_{Y1}$: paralogs\n$2$. $A\\_{Y1}$ vs $B\\_{Y2}$: paralogs\n$3$. $A\\_{Y1}$ vs $C\\_Y$: orthologs\n$4$. $B\\_{Y2}$ vs $C\\_Y$: orthologs\n$5$. $A\\_X$ vs $C\\_Y$: paralogs\n\nNow we evaluate the given options based on this derived result.\n\n**A. 1: paralogs; 2: paralogs; 3: orthologs; 4: orthologs; 5: paralogs**\nThis option matches our derived classifications for all five pairs.\nVerdict: **Correct**.\n\n**B. 1: paralogs; 2: orthologs; 3: orthologs; 4: orthologs; 5: orthologs**\nThis option incorrectly classifies pair $2$ ($A\\_{Y1}$ vs $B\\_{Y2}$) as orthologs. Their MRCA is the duplication $D_1$. It also incorrectly classifies pair $5$ ($A\\_X$ vs $C\\_Y$) as orthologs. Their MRCA is the duplication $D_0$.\nVerdict: **Incorrect**.\n\n**C. 1: orthologs; 2: orthologs; 3: paralogs; 4: orthologs; 5: orthologs**\nThis option incorrectly classifies pair $1$ ($A\\_X$ vs $A\\_{Y1}$) as orthologs. Their MRCA is the duplication $D_0$. It also incorrectly classifies pairs $2$, $3$, and $5$.\nVerdict: **Incorrect**.\n\n**D. 1: paralogs; 2: orthologs; 3: paralogs; 4: paralogs; 5: orthologs**\nThis option incorrectly classifies pair $2$ ($A\\_{Y1}$ vs $B\\_{Y2}$) as orthologs. It also incorrectly classifies pair $3$ ($A\\_{Y1}$ vs $C\\_Y$) as paralogs, pair $4$ ($B\\_{Y2}$ vs $C\\_Y$) as paralogs, and pair $5$ ($A\\_X$ vs $C\\_Y$) as orthologs.\nVerdict: **Incorrect**.\n\nThe only option that is fully consistent with the rigorous application of the provided definitions and event history is A.", "answer": "$$\\boxed{A}$$", "id": "2800806"}, {"introduction": "A powerful method for detecting natural selection is to compare the rate of protein-altering (nonsynonymous) substitutions to the rate of silent (synonymous) substitutions. In this practice [@problem_id:2800746], you will calculate the key metric $\\omega = d_N/d_S$ and grapple with the real-world complication of substitution saturation, which can distort evolutionary signals if not properly corrected. This exercise builds crucial quantitative skills for analyzing molecular evolution, including the application of substitution models like the Jukes-Cantor model.", "problem": "A protein-coding gene has been analyzed on a known phylogeny using ancestral state reconstruction to assign substitutions to branches. For a focal lineage, a codon-based counting procedure provided the following branch-specific totals and site opportunities (effective target sizes), where opportunities incorporate codon frequencies and transition/transversion bias as usual. Let $L_{N}$ denote the effective number of nonsynonymous sites and $L_{S}$ the effective number of synonymous sites; decompose $L_{S}$ into fourfold degenerate (4-fold) and twofold degenerate (2-fold) synonymous opportunities $L_{S,4}$ and $L_{S,2}$, respectively. The inferred counts on the focal branch are:\n- Effective nonsynonymous sites $L_{N} = 6000$; inferred nonsynonymous substitutions $D_{N} = 50$.\n- Fourfold degenerate synonymous opportunities $L_{S,4} = 900$; inferred 4-fold synonymous substitutions $D_{S,4} = 300$.\n- Twofold degenerate synonymous opportunities $L_{S,2} = 300$; inferred 2-fold synonymous substitutions $D_{S,2} = 50$.\n\nAssume that at twofold degenerate synonymous sites and at nonsynonymous sites the branch length is small enough to be in the linear regime where the observed fraction of differences approximates the expected number of substitutions per site. However, at fourfold degenerate synonymous sites, multiple hits are non-negligible; assume the Jukes–Cantor 1969 (JC69) model applies to these 4-fold sites. Throughout, define the ratio of nonsynonymous to synonymous substitution rates as $\\omega = d_{N}/d_{S}$, where $d_{N}$ is the nonsynonymous substitutions per nonsynonymous site and $d_{S}$ is the synonymous substitutions per synonymous site.\n\nUsing only the information above and standard model-based corrections consistent with the stated assumptions, compute the Jukes–Cantor–corrected estimate of $\\omega$ for the focal lineage. Round your answer to four significant figures and report it as a pure number with no units. In your reasoning, start from first principles (definitions of $d_{N}$, $d_{S}$, and $\\omega$, and the JC69 correction as a well-tested model) and briefly justify how saturation at 4-fold degenerate sites affects bias in $\\omega$ relative to an uncorrected calculation.", "solution": "The problem is valid as it is scientifically grounded in the principles of molecular evolution, well-posed with sufficient data, and uses objective, formal language. We will proceed with the solution.\n\nThe fundamental quantity of interest is the ratio $\\omega = d_{N}/d_{S}$, where $d_{N}$ represents the rate of nonsynonymous substitutions (substitutions per nonsynonymous site) and $d_{S}$ represents the rate of synonymous substitutions (substitutions per synonymous site). Our task is to calculate this ratio using the provided data and specified model assumptions.\n\nFirst, we calculate the nonsynonymous substitution rate, $d_{N}$. The problem states that for nonsynonymous sites, we are in the linear regime where the expected number of substitutions per site ($d_{N}$) can be approximated by the observed proportion of differences ($p_{N}$). The observed proportion is the ratio of inferred nonsynonymous substitutions, $D_{N}$, to the number of effective nonsynonymous sites, $L_{N}$.\n$$p_{N} = \\frac{D_{N}}{L_{N}} = \\frac{50}{6000} = \\frac{1}{120}$$\nGiven the linear regime assumption for these sites, we have:\n$$d_{N} \\approx p_{N} = \\frac{1}{120}$$\n\nNext, we must determine the overall synonymous substitution rate, $d_{S}$. This rate is a composite of the rates at twofold ($2$-fold) and fourfold ($4$-fold) degenerate sites. The overall rate $d_{S}$ is the weighted average of the rates at these site classes, $d_{S,2}$ and $d_{S,4}$, with weights given by their respective proportions of the total synonymous sites.\nThe total number of effective synonymous sites is $L_{S} = L_{S,4} + L_{S,2} = 900 + 300 = 1200$.\nThe formula for the weighted average is:\n$$d_{S} = \\frac{d_{S,4} L_{S,4} + d_{S,2} L_{S,2}}{L_{S,4} + L_{S,2}}$$\n\nWe calculate the rate for each synonymous site class. For the $2$-fold degenerate sites, the problem specifies that the linear approximation is valid. Thus, similar to the $d_{N}$ calculation:\n$$d_{S,2} \\approx p_{S,2} = \\frac{D_{S,2}}{L_{S,2}} = \\frac{50}{300} = \\frac{1}{6}$$\n\nFor the $4$-fold degenerate sites, multiple substitutions (saturation) are non-negligible, and we must apply the Jukes-Cantor 1969 (JC69) correction. First, we compute the observed proportion of differences, $p_{S,4}$:\n$$p_{S,4} = \\frac{D_{S,4}}{L_{S,4}} = \\frac{300}{900} = \\frac{1}{3}$$\nThe JC69 model relates the true distance (substitutions per site, $d$) to the observed proportion of differences ($p$) for $4$-state characters by the formula:\n$$d = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}p\\right)$$\nApplying this to the $4$-fold sites, the corrected rate $d_{S,4}$ is:\n$$d_{S,4} = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}p_{S,4}\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\cdot \\frac{1}{3}\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{9}\\right) = -\\frac{3}{4} \\ln\\left(\\frac{5}{9}\\right)$$\n\nNow we can compute the overall synonymous rate $d_{S}$ by substituting the values for $d_{S,2}$, $d_{S,4}$, $L_{S,2}$, and $L_{S,4}$:\n$$d_{S} = \\frac{\\left(-\\frac{3}{4} \\ln\\left(\\frac{5}{9}\\right)\\right) \\cdot 900 + \\left(\\frac{1}{6}\\right) \\cdot 300}{900 + 300} = \\frac{-675 \\ln\\left(\\frac{5}{9}\\right) + 50}{1200}$$\n\nFinally, we compute the ratio $\\omega = d_{N}/d_{S}$:\n$$\\omega = \\frac{d_{N}}{d_{S}} = \\frac{\\frac{1}{120}}{\\frac{-675 \\ln\\left(\\frac{5}{9}\\right) + 50}{1200}} = \\frac{1}{120} \\cdot \\frac{1200}{-675 \\ln\\left(\\frac{5}{9}\\right) + 50} = \\frac{10}{-675 \\ln\\left(\\frac{5}{9}\\right) + 50}$$\nTo obtain a numerical value, we evaluate the expression:\n$$\\ln\\left(\\frac{5}{9}\\right) \\approx -0.58778666$$\n$$\\omega \\approx \\frac{10}{-675(-0.58778666) + 50} = \\frac{10}{396.75599 + 50} = \\frac{10}{446.75599} \\approx 0.02238338$$\nRounding to four significant figures, the estimate for $\\omega$ is $0.02238$.\n\nRegarding the effect of saturation, failing to correct for multiple hits at the highly mutable $4$-fold degenerate sites would lead to a significant underestimation of the true synonymous substitution rate $d_{S}$. An uncorrected calculation would use the raw proportion of differences $p_{S,4} = 1/3 \\approx 0.333$ instead of the corrected value $d_{S,4} \\approx 0.441$. This underestimation of the synonymous rate propagates to the overall $d_{S}$. Since $d_{S}$ is the denominator in the ratio $\\omega = d_{N}/d_{S}$, using a smaller, uncorrected value for $d_S$ would result in a larger, artificially inflated estimate of $\\omega$. The JC69 correction accounts for unobserved substitutions, providing a higher and more accurate estimate of $d_{S}$, and consequently, a lower and more accurate estimate of $\\omega$. This demonstrates that saturation at synonymous sites can mask the true extent of neutral evolution, and if uncorrected, can lead to spurious signals of positive selection (if $\\omega > 1$) or weaken the evidence for purifying selection (if $\\omega  1$).", "answer": "$$\\boxed{0.02238}$$", "id": "2800746"}, {"introduction": "Evolution reshuffles not only the sequence of genes but also their order on chromosomes. This practice [@problem_id:2800727] introduces a powerful framework for studying these large-scale events: the Double-Cut-and-Join (DCJ) model. By constructing and analyzing a breakpoint graph, you will learn to compute the minimal number of rearrangement steps needed to transform one genome into another, a fundamental task in synteny analysis.", "problem": "In comparative genomics, model genomes as signed permutations on a shared set of orthologous genes, where each gene $i$ has an orientation indicated by a sign. Consider two single-chromosome circular genomes on the same set of $n$ orthologous genes, represented as signed circular permutations. The Double-Cut-and-Join (DCJ) operation is permitted, and the DCJ distance is defined as the minimal number of such operations required to transform one genome into the other.\n\nLet genome $\\mathcal{X}$ and genome $\\mathcal{Y}$ be:\n- $\\mathcal{X}$: a single circular chromosome with gene order $(+1\\ +2\\ +3\\ +4\\ +5\\ +6\\ +7\\ +8)$.\n- $\\mathcal{Y}$: a single circular chromosome with gene order $(+1\\ -3\\ -2\\ +4\\ +5\\ -7\\ -6\\ +8)$.\n\nProceed as follows:\n- Using only foundational definitions (gene extremities, adjacencies, and the alternating two-color breakpoint graph), construct the breakpoint graph comparing $\\mathcal{X}$ and $\\mathcal{Y}$ by representing each gene $i$ with extremities $(t_i, h_i)$ and adding edges for adjacencies in each genome. For a pair of consecutive genes $x$ then $y$ in a circular chromosome, the adjacency is between $(h_{|x|}, t_{|y|})$ if both are positive, $(h_{|x|}, h_{|y|})$ if the second is negative, $(t_{|x|}, t_{|y|})$ if the first is negative and the second positive, and $(t_{|x|}, h_{|y|})$ if both are negative. Include the circular wrap-around adjacency.\n- From this graph, determine the number of alternating cycles and use this to compute the DCJ distance between $\\mathcal{X}$ and $\\mathcal{Y}$, justified from first principles of the model.\n- Additionally, exhibit an explicit parsimonious sequence of DCJ operations that transforms $\\mathcal{Y}$ into $\\mathcal{X}$, and argue why it is parsimonious.\n\nReport as your final numerical answer only the DCJ distance as a single integer (no units). No rounding is required. All reasoning, intermediate constructions, and the explicit sequence of rearrangements must be included before the final answer.", "solution": "The problem requires the computation of the Double-Cut-and-Join (DCJ) distance between two single-chromosome circular genomes, $\\mathcal{X}$ and $\\mathcal{Y}$, and the presentation of a parsimonious sorting scenario. The problem is validated to be well-posed, scientifically grounded, and contains all necessary information.\n\nThe genomes are defined on a set of $n=8$ orthologous genes as:\n$$ \\mathcal{X}: (+1\\ +2\\ +3\\ +4\\ +5\\ +6\\ +7\\ +8) $$\n$$ \\mathcal{Y}: (+1\\ -3\\ -2\\ +4\\ +5\\ -7\\ -6\\ +8) $$\n\nThe solution proceeds in three stages:\n1. Construction of the breakpoint graph.\n2. Calculation of the DCJ distance from the graph's cycle decomposition.\n3. Exhibition of a parsimonious sequence of DCJ operations.\n\n**1. Breakpoint Graph Construction**\n\nEach gene $i$ is represented by two extremities, a tail $t_i$ and a head $h_i$. The vertices of the breakpoint graph are the set of all $2n=16$ extremities: $\\{t_1, h_1, t_2, h_2, \\dots, t_8, h_8\\}$. The edges of the graph are determined by the adjacencies in each genome.\n\nAn adjacency is a pair of extremities that are consecutive in the genomic arrangement. Based on the provided rules, a signed gene $+i$ is traversed from $t_i$ to $h_i$, and a gene $-i$ is traversed from $h_i$ to $t_i$.\n\nThe adjacencies for genome $\\mathcal{X}$ are determined by its gene order $(+1, +2, \\dots, +8)$. Since all genes are positive, the adjacency between consecutive genes $+i$ and $+j$ connects $h_i$ and $t_j$.\nThe set of adjacencies in $\\mathcal{X}$ is therefore:\n$$ \\mathcal{A}_{\\mathcal{X}} = \\{ (h_1, t_2), (h_2, t_3), (h_3, t_4), (h_4, t_5), (h_5, t_6), (h_6, t_7), (h_7, t_8), (h_8, t_1) \\} $$\nThese edges are designated as 'black' edges in the breakpoint graph.\n\nThe adjacencies for genome $\\mathcal{Y}$ are determined by its gene order $(+1, -3, -2, +4, +5, -7, -6, +8)$. Applying the given rules for sign combinations yields:\n- Adjacency $(+1, -3)$: $(h_1, h_3)$\n- Adjacency $(-3, -2)$: $(t_3, h_2)$\n- Adjacency $(-2, +4)$: $(t_2, t_4)$\n- Adjacency $(+4, +5)$: $(h_4, t_5)$\n- Adjacency $(+5, -7)$: $(h_5, h_7)$\n- Adjacency $(-7, -6)$: $(t_7, h_6)$\n- Adjacency $(-6, +8)$: $(t_6, t_8)$\n- Adjacency $(+8, +1)$: $(h_8, t_1)$\nThe set of adjacencies in $\\mathcal{Y}$ is:\n$$ \\mathcal{A}_{\\mathcal{Y}} = \\{ (h_1, h_3), (t_3, h_2), (t_2, t_4), (h_4, t_5), (h_5, h_7), (t_7, h_6), (t_6, t_8), (h_8, t_1) \\} $$\nThese edges are designated as 'gray' edges in the breakpoint graph.\n\nThe breakpoint graph consists of $16$ vertices and $16$ edges (8 black, 8 gray), where each vertex has a degree of $2$. This structure guarantees a unique decomposition into disjoint cycles that alternate between black and gray edges.\n\n**2. Cycle Decomposition and DCJ Distance Calculation**\n\nBy tracing the alternating paths in the breakpoint graph, we identify the cycles:\n- Start at $h_1$: $h_1 \\xrightarrow{\\text{gray}} h_3 \\xrightarrow{\\text{black}} t_4 \\xrightarrow{\\text{gray}} t_2 \\xrightarrow{\\text{black}} h_1$. This is **Cycle 1**, a 4-cycle involving vertices $\\{h_1, t_2, h_3, t_4\\}$.\n- Start at $h_2$: $h_2 \\xrightarrow{\\text{black}} t_3 \\xrightarrow{\\text{gray}} h_2$. This is **Cycle 2**, a 2-cycle on $\\{h_2, t_3\\}$.\n- The adjacency $(h_4, t_5)$ is present in both $\\mathcal{A}_{\\mathcal{X}}$ and $\\mathcal{A}_{\\mathcal{Y}}$. This forms a trivial 2-cycle, $h_4 \\xrightarrow{\\text{black}} t_5 \\xrightarrow{\\text{gray}} h_4$. This is **Cycle 3**.\n- The adjacency $(h_8, t_1)$ is also common to both genomes, forming another trivial 2-cycle, $h_8 \\xrightarrow{\\text{black}} t_1 \\xrightarrow{\\text{gray}} h_8$. This is **Cycle 4**.\n- Start at a remaining vertex, e.g., $h_5$: $h_5 \\xrightarrow{\\text{black}} t_6 \\xrightarrow{\\text{gray}} t_8 \\xrightarrow{\\text{black}} h_7 \\xrightarrow{\\text{gray}} h_5$. This is **Cycle 5**, a 4-cycle on $\\{h_5, t_6, h_7, t_8\\}$.\n- Finally, start at $h_6$: $h_6 \\xrightarrow{\\text{black}} t_7 \\xrightarrow{\\text{gray}} h_6$. This gives **Cycle 6**, a 2-cycle on $\\{h_6, t_7\\}$.\n\nAll $16$ vertices are covered. The total number of cycles is $c = 6$.\n\nThe DCJ distance for circular genomes is given by the formula $d_{DCJ}(\\mathcal{X}, \\mathcal{Y}) = n - c$.\nWith $n=8$ genes and $c=6$ cycles, the distance is:\n$$ d_{DCJ}(\\mathcal{X}, \\mathcal{Y}) = 8 - 6 = 2 $$\n\n**3. Parsimonious Sorting Scenario**\n\nA parsimonious sorting scenario is a sequence of DCJ operations of minimal length, which is equal to the DCJ distance. Each DCJ operation in a parsimonious path must increase the number of cycles $c$ by one. This is achieved by applying a DCJ to two gray edges that belong to the same cycle. We must perform $2$ such operations to transform $\\mathcal{Y}$ into $\\mathcal{X}$.\n\n**Operation 1:**\n- Initial Genome: $\\mathcal{Y}_0 = (+1\\ -3\\ -2\\ +4\\ +5\\ -7\\ -6\\ +8)$.\n- Cycles $c=6$. We target a non-trivial cycle, for example, Cycle 1: $(h_1, h_3, t_4, t_2)$.\n- The gray edges in this cycle are $(h_1, h_3)$ and $(t_2, t_4)$, corresponding to adjacencies $(+1, -3)$ and $(-2, +4)$ in $\\mathcal{Y}_0$.\n- We perform a DCJ operation that cuts these two adjacencies and creates new ones corresponding to the black edges of the same cycle, namely $(h_1, t_2)$ and $(h_3, t_4)$.\n- This operation transforms the genome configuration. The path through the gene extremities in the affected region changes from $(\\dots, h_1)(h_3, t_3, h_2, t_2)(t_4, \\dots)$ to $(\\dots, h_1, t_2, h_2, t_3, h_3, t_4, \\dots)$.\n- Decoding the new gene order from this transformed path yields the intermediate genome $\\mathcal{Y}_1$:\n$$ \\mathcal{Y}_1 = (+1\\ +2\\ +3\\ +4\\ +5\\ -7\\ -6\\ +8) $$\n- This operation is equivalent to a reversal of the segment $(-3, -2)$. This single DCJ resolves the adjacencies related to Cycle 1 and Cycle 2. The number of cycles increases from $c=6$ to $c_1=7$. The DCJ distance to $\\mathcal{X}$ is now $n-c_1=8-7=1$.\n\n**Operation 2:**\n- Current Genome: $\\mathcal{Y}_1 = (+1\\ +2\\ +3\\ +4\\ +5\\ -7\\ -6\\ +8)$.\n- The new breakpoint graph has one remaining non-trivial 4-cycle, Cycle 5 from the original analysis: $(h_5, t_6, t_8, h_7)$, and a 2-cycle, Cycle 6: $(h_6,t_7)$.\n- The gray edges in the 4-cycle are $(h_5, h_7)$ and $(t_6, t_8)$, corresponding to adjacencies $(+5, -7)$ and $(-6, +8)$ in $\\mathcal{Y}_1$.\n- We perform a DCJ to cut these gray edges and form new adjacencies corresponding to the black edges of the cycle: $(h_5, t_6)$ and $(h_7, t_8)$.\n- This operation is equivalent to the reversal of the segment $(-7, -6)$. The resulting genome $\\mathcal{Y}_2$ is:\n$$ \\mathcal{Y}_2 = (+1\\ +2\\ +3\\ +4\\ +5\\ +6\\ +7\\ +8) $$\n- This is identical to the target genome $\\mathcal{X}$. This DCJ increases the cycle count from $c_1=7$ to $c_2=8$. The distance is now $n-c_2 = 8-8=0$.\n\nThe sequence of two DCJ operations (realized as reversals) transforms $\\mathcal{Y}$ into $\\mathcal{X}$. Since the DCJ distance is $2$, this sequence is parsimonious.\n\nThe final requested answer is the DCJ distance. Based on the formula $d_{DCJ} = n - c$, the distance is calculated to be $2$.", "answer": "$$ \\boxed{2} $$", "id": "2800727"}]}