{"hands_on_practices": [{"introduction": "The concept of a 'molecular clock' relies on the surprisingly regular accumulation of genetic substitutions over time. This exercise grounds this observation in fundamental population genetics, tasking you with deriving the cornerstone result of the neutral theory from first principles. By combining the rate at which new neutral mutations arise in a population with their probability of fixation, you will uncover why the long-term substitution rate, $K$, equals the neutral mutation rate, $\\mu$, a result whose independence from population size forms the theoretical basis of the molecular clock [@problem_id:2818739].", "problem": "A randomly mating diploid population has constant effective population size $N = 10^5$. The per-site, per-generation neutral mutation rate is $\\mu = 1 \\times 10^{-8}$. Consider a time interval of $T = 10^7$ generations. Starting only from the following foundational facts: (i) in a diploid population there are $2N$ gene copies per site that can mutate each generation, (ii) the expected number of new neutral mutations entering the population per site per generation is determined by the product of the number of gene copies and the per-copy neutral mutation rate, and (iii) under neutrality the fixation probability of a newly arisen allele equals its initial frequency, derive from first principles an expression for the expected number of neutral fixations per site accumulated over $T$ generations in terms of $N$, $\\mu$, and $T$. Then evaluate this expression for the given values of $N$, $\\mu$, and $T$. Finally, briefly interpret your numerical result in terms of whether the accumulation of neutral substitutions is clock-like. Express the expected number per site as a unitless decimal number. No rounding is required beyond exact arithmetic.", "solution": "Let $N$ be the effective population size of a diploid population. Let $\\mu$ be the per-site, per-generation neutral mutation rate. The time interval under consideration is $T$ generations.\n\nThe objective is to derive an expression for the expected number of neutral substitutions, or fixations, per site over the time interval $T$. We will denote the rate of neutral substitution per site per generation as $K$. The total expected number of fixations will therefore be $K \\times T$.\n\nWe follow the foundational facts provided:\n\n1.  **Rate of new neutral mutations:**\n    Fact (i) states that in a diploid population of size $N$, there are $2N$ gene copies at any given autosomal locus.\n    Fact (ii) states that the expected number of new neutral mutations entering the population per site per generation is the product of the number of gene copies and the per-copy neutral mutation rate.\n    Let this rate of introduction of new mutations be $\\lambda$.\n    $$ \\lambda = (2N) \\times \\mu = 2N\\mu $$\n    This expression represents the total number of new neutral alleles that arise at a specific site within the entire population in one generation.\n\n2.  **Probability of fixation of a new neutral mutation:**\n    A new mutation initially exists as a single copy in the population. The total number of gene copies at that site is $2N$. Therefore, the initial frequency of this new allele, let us call it $p_0$, is:\n    $$ p_0 = \\frac{1}{2N} $$\n    Fact (iii) states that under neutrality (i.e., the allele has no selective advantage or disadvantage), its probability of eventually reaching fixation (a frequency of $1$) is equal to its initial frequency. Let this probability be $P_{fix}$.\n    $$ P_{fix} = p_0 = \\frac{1}{2N} $$\n\n3.  **Rate of neutral substitution:**\n    The rate of neutral substitution, $K$, is the rate at which new neutral mutations arise *and* subsequently proceed to fixation. This is the product of the rate of introduction of new neutral mutations ($\\lambda$) and the probability that any one of them becomes fixed ($P_{fix}$).\n    $$ K = \\lambda \\times P_{fix} $$\n    Substituting the expressions we derived:\n    $$ K = (2N\\mu) \\times \\left(\\frac{1}{2N}\\right) $$\n    The term $2N$ cancels out, leading to a remarkably simple result:\n    $$ K = \\mu $$\n    This is a cornerstone result of the neutral theory: the rate of substitution of neutral alleles is equal to the neutral mutation rate and is independent of the effective population size.\n\n4.  **Total expected number of fixations over time $T$:**\n    The total expected number of neutral fixations per site over a period of $T$ generations is the rate of substitution per generation, $K$, multiplied by the number of generations, $T$.\n    $$ \\text{Total Fixations} = K \\times T = \\mu T $$\n\nNow, we evaluate this expression using the numerical values provided in the problem:\n$N = 10^{5}$\n$\\mu = 1 \\times 10^{-8}$\n$T = 10^{7}$\n\nThe total expected number of neutral fixations per site is:\n$$ \\text{Total Fixations} = (1 \\times 10^{-8}) \\times (10^{7}) = 10^{-8+7} = 10^{-1} = 0.1 $$\n\nFinally, we must interpret this result in the context of the molecular clock. The derivation shows that the rate of accumulation of neutral substitutions, $K$, is equal to the neutral mutation rate, $\\mu$. Crucially, this rate is independent of the effective population size $N$. If the mutation rate $\\mu$ is assumed to be approximately constant over evolutionary time for a given gene or genomic region, then the rate of substitution $K$ will also be constant. The accumulation of substitutions will therefore occur at a steady, clock-like pace. The calculation shows that over $T = 10^{7}$ generations, we expect $0.1$ substitutions to have occurred and become fixed at any given neutral site. This regularity, stemming from the independence of the substitution rate from demographic parameters like population size, is the theoretical foundation of the molecular clock.", "answer": "$$\\boxed{0.1}$$", "id": "2818739"}, {"introduction": "With the theoretical relationship between substitution rate and mutation rate established, we can now apply it to estimate evolutionary divergence times from sequence data. However, observed sequence differences are not a direct measure of substitutions, as multiple changes at the same site can obscure the true evolutionary history. This practice guides you through the application of the Jukes-Cantor (JC69) model to correct for these 'multiple hits' and translate a raw sequence dissimilarity into a robust estimate of divergence time using the molecular clock hypothesis [@problem_id:2818705].", "problem": "Two orthologous protein-coding sequences, each sufficiently long that sampling variance can be neglected, are compared and the observed proportion of nucleotide differences is $p=0.15$. Assume that sites evolve independently under the Jukes–Cantor 1969 (JC69) model and that the neutral theory holds so that the long-term substitution rate per site equals the neutral mutation rate per site per unit time. Further assume equal base frequencies and equal instantaneous rates among all nucleotide changes, stationarity, and time reversibility, with no among-site rate heterogeneity and no ancestral polymorphism effects.\n\nLet $D$ denote the expected number of substitutions per site accumulated along the two lineages separating the sequences (the evolutionary path length in substitutions per site). Use the JC69 model to obtain the corrected distance $D$ from the observed proportion $p$. Then, using the neutral-theory molecular clock, estimate the divergence time $T$ between the lineages via $T = D/(2\\mu)$, where the neutral mutation rate is $\\mu = 2 \\times 10^{-9}$ per site per year.\n\n- Report $D$ in substitutions per site, rounded to four significant figures.\n- Report $T$ in millions of years (Myr), rounded to three significant figures.\n\nBriefly explain, in words, how the JC69 correction affects the divergence-time estimate relative to using the uncorrected proportion $p$ as a distance.", "solution": "The task is to compute the evolutionary distance $D$ corrected for multiple substitutions using the Jukes-Cantor model, and then to estimate the divergence time $T$ using the molecular clock hypothesis.\n\nThe Jukes-Cantor (1969) model is a one-parameter model of nucleotide substitution. It assumes that all substitutions occur with equal probability. The relationship between the observed proportion of different sites, $p$, and the expected number of substitutions per site, $D$, is given by the formula:\n$$D = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}p\\right)$$\nThis correction accounts for multiple substitutions at a single site over evolutionary time, which are not captured by a simple pairwise comparison.\n\nWe are given $p = 0.15$. We substitute this value into the equation for $D$:\n$$D = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}(0.15)\\right)$$\nFirst, we evaluate the term inside the parenthesis:\n$$\\frac{4}{3}(0.15) = \\frac{4}{3} \\left(\\frac{15}{100}\\right) = \\frac{60}{300} = \\frac{1}{5} = 0.2$$\nSubstituting this result back into the expression for $D$:\n$$D = -\\frac{3}{4} \\ln(1 - 0.2) = -\\frac{3}{4} \\ln(0.8)$$\nThe natural logarithm of $0.8$ is approximately $-0.22314355$. Therefore:\n$$D \\approx -0.75 \\times (-0.22314355) \\approx 0.16735766$$\nThe problem requires this value to be rounded to four significant figures.\n$$D \\approx 0.1674 \\text{ substitutions per site}$$\n\nNext, we estimate the divergence time $T$ using the provided molecular clock equation, $T = D / (2\\mu)$. The quantity $D$ represents the total number of substitutions per site along the two lineages that diverged from a common ancestor. The time since divergence, $T$, is related to the rate of substitution per lineage, which is given as the neutral mutation rate $\\mu$. The total rate of divergence between the two sequences is therefore $2\\mu$.\nWe are given the neutral mutation rate $\\mu = 2 \\times 10^{-9}$ per site per year. We use the unrounded value of $D$ for this calculation to maintain precision.\n$$T = \\frac{D}{2\\mu} = \\frac{0.16735766 \\text{ substitutions/site}}{2 \\times (2 \\times 10^{-9} \\text{ substitutions/site/year})} = \\frac{0.16735766}{4 \\times 10^{-9}} \\text{ years}$$\n$$T \\approx 41,839,415 \\text{ years}$$\nThe problem requires the answer in millions of years (Myr), where $1 \\text{ Myr} = 10^6 \\text{ years}$.\n$$T \\approx \\frac{41,839,415}{10^6} \\text{ Myr} \\approx 41.839415 \\text{ Myr}$$\nRounding to three significant figures, we obtain:\n$$T \\approx 41.8 \\text{ Myr}$$\n\nFinally, a brief explanation of how the JC69 correction affects the divergence-time estimate is required.\nThe observed proportion of differences, $p$, is a direct count of dissimilar sites and represents a raw, uncorrected distance. This raw distance systematically underestimates the actual number of evolutionary events because it fails to account for multiple substitutions occurring at the same nucleotide site over time. For example, a change from A to G followed by a change from G back to A results in zero observable difference, yet two substitutions have occurred. Similarly, a change from A to G followed by a change to T is counted as one difference (A vs T), but two substitutions have happened. The JC69 formula corrects for these \"multiple hits,\" providing an estimate $D$ that is always greater than $p$ for $p > 0$. Since the divergence time $T$ is directly proportional to the distance ($T = D/(2\\mu)$), using the corrected distance $D$ leads to a longer, and therefore more accurate, estimate of the divergence time than would be obtained by naively using the uncorrected proportion $p$. Using $p$ in place of $D$ would necessarily result in an underestimation of the true evolutionary time.", "answer": "$$\\boxed{\\begin{pmatrix} 0.1674  41.8 \\end{pmatrix}}$$", "id": "2818705"}, {"introduction": "Real-world sequence analysis often involves protein-coding genes where evolutionary pressure varies across sites, leading to different substitution dynamics. This advanced practice introduces the crucial distinction between synonymous ($d_S$) and nonsynonymous ($d_N$) substitutions, allowing us to estimate the strength of selection via their ratio, $\\omega$. You will not only calculate these important evolutionary parameters but also confront a critical limitation in deep-time phylogenetics: the saturation of substitutions at highly variable sites, a phenomenon that can significantly bias divergence time estimates [@problem_id:2818709].", "problem": "Two orthologous coding sequences were aligned codon-by-codon. Using codon-usage–weighted Nei–Gojobori site counting, the number of synonymous sites is $S=540$ and the number of nonsynonymous sites is $N=1{,}260$. In the pairwise comparison, the observed numbers of synonymous and nonsynonymous differences are $D_S=378$ and $D_N=189$, respectively. Assume that within each class of sites (synonymous and nonsynonymous), substitutions follow a time-homogeneous continuous-time Markov chain with equal base frequencies and equal exchangeabilities, that is, the Jukes–Cantor (JC) model applies separately to the synonymous and nonsynonymous classes. Also assume the Neutral Theory premise that the synonymous substitution rate reflects the neutral mutation rate at synonymous sites, and that divergence accrues along $2$ independent lineages at a constant rate.\n\nTasks:\n1. From the site-counting data, derive the observed proportions of synonymous and nonsynonymous differences, $p_S$ and $p_N$, and then infer the JC-corrected synonymous and nonsynonymous evolutionary distances, $d_S$ and $d_N$, measured as expected substitutions per synonymous site and per nonsynonymous site, respectively.\n2. Compute the ratio $\\omega=d_N/d_S$.\n3. Using a neutral synonymous substitution rate $\\mu_S=4.0 \\times 10^{-9}$ per site per year, estimate the divergence time $T$ in years under a strict molecular clock at synonymous sites, based on $d_S$ and the Neutral Theory relationship between expected divergence and time. Convert your estimate to millions of years (Myr). Round your final time estimate to four significant figures and express it in Myr.\n4. Briefly explain, in terms of the mapping from observed proportion difference $p_S$ to corrected distance $d_S$ under the JC model, how saturation at synonymous sites at deep divergence times biases $d_S$ and therefore $\\omega$.\n\nFor grading, report only the final numerical value of $T$ in Myr as your answer, rounded as instructed. Do not include units in your final boxed answer.", "solution": "The appropriate foundations are: (i) the Neutral Theory premise that neutral substitutions accumulate at a rate equal to the neutral mutation rate, so that for two lineages the expected divergence at neutral sites after time $T$ is $2 \\mu T$; (ii) the definition of Nei–Gojobori counting that partitions sites into synonymous and nonsynonymous categories with counts of opportunities $S$ and $N$ and observed differences $D_{S}$ and $D_{N}$; and (iii) the Jukes–Cantor (JC) correction that maps an observed proportion difference $p$ to an expected number of substitutions per site $d$ through the continuous-time Markov chain with equal rates.\n\nStep 1: Compute observed proportions of differences and JC-corrected distances.\nBy definition,\n$$\np_{S}=\\frac{D_{S}}{S}=\\frac{378}{540}=\\frac{7}{10}=0.7,\n\\qquad\np_{N}=\\frac{D_{N}}{N}=\\frac{189}{1{,}260}=\\frac{15}{100}=0.15.\n$$\nUnder the Jukes–Cantor model for a four-state alphabet with equal base frequencies and equal exchangeabilities, the mapping from the observed proportion difference $p$ to the corrected distance $d$ is\n$$\nd \\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(1-\\frac{4}{3}p\\right).\n$$\nApply this to the synonymous class:\n$$\nd_{S} \\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(1-\\frac{4}{3}\\cdot 0.7\\right)\n\\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(1-\\frac{28}{30}\\right)\n\\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(\\frac{2}{30}\\right)\n\\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(\\frac{1}{15}\\right)\n\\;=\\; \\frac{3}{4}\\,\\ln(15).\n$$\nFor the nonsynonymous class:\n$$\nd_{N} \\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(1-\\frac{4}{3}\\cdot 0.15\\right)\n\\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(1-0.2\\right)\n\\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(\\frac{4}{5}\\right)\n\\;=\\; \\frac{3}{4}\\,\\ln\\!\\left(\\frac{5}{4}\\right).\n$$\nFor numerical reference,\n$$\nd_{S} \\;=\\; \\frac{3}{4}\\,\\ln(15) \\;\\approx\\; 2.031037651,\n\\qquad\nd_{N} \\;=\\; \\frac{3}{4}\\,\\ln\\!\\left(\\frac{5}{4}\\right) \\;\\approx\\; 0.167357663.\n$$\n\nStep 2: Compute $\\omega$.\nBy definition,\n$$\n\\omega \\;=\\; \\frac{d_{N}}{d_{S}} \\;=\\; \\frac{\\frac{3}{4}\\ln(5/4)}{\\frac{3}{4}\\ln(15)} \\;=\\; \\frac{\\ln(5/4)}{\\ln(15)} \\;\\approx\\; 0.082429311.\n$$\n\nStep 3: Estimate divergence time $T$ from $d_{S}$ and $\\mu_{S}$.\nUnder the Neutral Theory at synonymous sites, the expected divergence (corrected distance) between two lineages after time $T$ is\n$$\nd_{S} \\;=\\; 2\\,\\mu_{S}\\,T,\n$$\nso\n$$\nT \\;=\\; \\frac{d_{S}}{2\\,\\mu_{S}}.\n$$\nWith $\\mu_{S}=4.0\\times 10^{-9}$ per site per year and $d_{S}=\\frac{3}{4}\\ln(15)$,\n$$\nT \\;=\\; \\frac{\\frac{3}{4}\\ln(15)}{2 \\times 4.0\\times 10^{-9}}\n\\;=\\; \\frac{\\frac{3}{4}\\ln(15)}{8.0\\times 10^{-9}}\n\\;\\approx\\; \\frac{2.031037651}{8.0\\times 10^{-9}}\n\\;\\approx\\; 2.538796\\!\\times\\! 10^{8}\\ \\text{years}.\n$$\nConvert to millions of years (Myr) by dividing by $10^{6}$:\n$$\nT_{\\mathrm{Myr}} \\;=\\; \\frac{2.538796\\!\\times\\! 10^{8}}{10^{6}} \\;=\\; 253.8796\\ \\text{Myr}.\n$$\nRounded to four significant figures as required:\n$$\nT_{\\mathrm{Myr}} \\;\\approx\\; 253.9\\ \\text{Myr}.\n$$\n\nStep 4: Discuss saturation bias at synonymous sites and its impact on $d_{S}$ and $\\omega$.\nUnder the JC mapping $d = -\\frac{3}{4}\\ln(1-\\frac{4}{3}p)$, the observed proportion difference $p$ is bounded above by $3/4$ because, at long times, the probability of identity by state approaches $1/4$. As true divergence grows large, $p$ approaches $3/4$ and becomes increasingly insensitive to further substitutions (saturation). If one were to ignore multiple hits and use the naive estimate $d\\approx p$, then $d_{S}$ would be strongly biased downward at deep times because $p_{S}$ cannot exceed $3/4$; for the present data, the naive $d_{S}^{\\mathrm{naive}}=p_{S}=0.7$ would yield\n$$\nT^{\\mathrm{naive}} \\;=\\; \\frac{0.7}{2\\cdot 4.0\\times 10^{-9}} \\;=\\; 8.75\\times 10^{7}\\ \\text{years} \\;=\\; 87.5\\ \\text{Myr},\n$$\na severe underestimate relative to the JC-corrected $253.9\\ \\text{Myr}$. Even when applying a parametric correction like JC, when $p_{S}$ is close to $3/4$ the estimator becomes highly variable and sensitive to model misspecification (base-composition bias, transition–transversion bias, among-site rate variation). Residual underestimation of $d_{S}$ at deep times can inflate $\\omega=d_{N}/d_{S}$, potentially mimicking signals of positive selection. More realistic codon models with among-site rate heterogeneity and appropriate base-composition and transition–transversion parameters, fit by maximum likelihood or Bayesian methods, can mitigate—but not entirely eliminate—the saturation-induced bias and uncertainty in deep divergences.", "answer": "$$\\boxed{253.9}$$", "id": "2818709"}]}