{"hands_on_practices": [{"introduction": "本练习将引导你完成一个典型的均质化计算，这对于掌握该领域的核心数学工具至关重要。我们将考虑一个在微观尺度上具有周期性变化的介质中的输运现象，具体来说，是一个一维平流-扩散方程。通过应用双尺度渐近展开法，你将推导出宏观等效扩散系数 $D_{\\text{eff}}$，从而亲身体验微观结构的细节如何决定宏观行为。[@problem_id:2417046]", "problem": "考虑一维平流-扩散方程\n$$\nc_t(x,t) + v\\!\\left(\\frac{x}{\\epsilon}\\right)\\,c_x(x,t) - \\frac{\\partial}{\\partial x}\\!\\left(D\\!\\left(\\frac{x}{\\epsilon}\\right)\\,c_x(x,t)\\right) = 0 \\quad \\text{for } x \\in \\mathbb{R},\\ t>0,\n$$\n其中 $\\epsilon>0$ 是一个表征慢变量与快变量之间尺度分离的小参数。假设 $v\\!\\left(y\\right) = v_0$ 是一个常数（与 $y$ 无关），并且 $D\\!\\left(y\\right)$ 是在单位胞元上的 1-周期分段常数函数：\n$$\nD(y) = \\begin{cases}\nD_a, & 0 \\le y < \\theta,\\\\\nD_b, & \\theta \\le y < 1,\n\\end{cases}\n$$\n其中 $0<\\theta<1$ 且常数 $D_a>0$，$D_b>0$。假设 $c(x,t)$ 及其导数有界且足够光滑，其初始条件 $c(x,0) = c_0(x)$ 在宏观尺度上变化。在均匀化极限 $\\epsilon \\to 0$ 下，宏观浓度 $\\overline{c}(x,t)$ 满足一个具有常系数的均匀化平流-扩散方程。请确定该均匀化方程的有效扩散系数 $D_{\\text{eff}}$，并用 $D_a$、$D_b$ 和 $\\theta$ 表示为一个闭式解析表达式。最终答案的单位应与 $D_a$ 和 $D_b$ 的单位相同（例如，$\\text{m}^2\\text{/s}$）。最终答案仅提供 $D_{\\text{eff}}$ 的表达式。", "solution": "在尝试求解之前，我们先对问题进行验证。\n\n首先，从问题陈述中逐字提取已知条件：\n- 微分方程为 $c_t(x,t) + v(x/\\epsilon)\\,c_x(x,t) - \\frac{\\partial}{\\partial x}(D(x/\\epsilon)\\,c_x(x,t)) = 0$，其中 $x \\in \\mathbb{R}$，$t>0$。\n- 参数 $\\epsilon$ 是一个小的正常数，$\\epsilon > 0$。\n- 平流速度为常数，$v(y) = v_0$。\n- 扩散系数 $D(y)$ 是 $y=x/\\epsilon$ 的 1-周期函数，在单位胞元 $[0, 1)$ 上定义为 $D(y) = D_a$（当 $0 \\le y < \\theta$）和 $D(y) = D_b$（当 $\\theta \\le y < 1$）。\n- 参数 $D_a$、$D_b$ 和 $\\theta$ 是正常数，满足 $D_a>0$、$D_b>0$ 和 $0 < \\theta < 1$。\n- 初始条件 $c(x,0) = c_0(x)$ 在宏观尺度上变化。\n- 目标是求出均匀化方程的有效扩散系数 $D_{\\text{eff}}$。\n\n现在根据指定标准对问题进行验证。\n- **科学依据**：该问题是均匀化理论的一个标准应用。均匀化理论是计算工程和物理学中用于分析多尺度系统的成熟数学技术。其基础的平流-扩散方程是输运现象的基本模型。该问题在科学上是成立的。\n- **适定性**：该问题是适定的。考虑到系数的周期性以及对光滑性和有界性的假设，唯一均匀化极限的存在性是该领域的标准结论。\n- **客观性**：该问题以精确的数学语言陈述，没有歧义或主观论断。\n\n该问题没有表现出科学上不成立、不完整、矛盾或不可行等任何缺陷。它是一个可形式化的问题，与多尺度建模的主题直接相关。因此，该问题被判定为**有效**。下面将提供解答。\n\n解决该问题的方法是双尺度渐近展开法。我们假设解 $c(x,t)$ 可以按小参数 $\\epsilon$ 的幂次进行展开：\n$$\nc(x,t) = c_0(x,y,t) + \\epsilon c_1(x,y,t) + \\epsilon^2 c_2(x,y,t) + \\dots\n$$\n其中 $y = x/\\epsilon$ 是快尺度微观变量，而 $x$ 是慢尺度宏观变量。假设函数 $c_k(x,y,t)$ 关于 $y$ 是 1-周期的。\n\n根据链式法则，空间导数变换如下：\n$$\n\\frac{\\partial}{\\partial x} \\to \\frac{\\partial}{\\partial x} + \\frac{1}{\\epsilon} \\frac{\\partial}{\\partial y}\n$$\n时间导数 $\\frac{\\partial}{\\partial t}$ 不受影响。将展开式和变换后的导数代入控制方程 $c_t + v_0 c_x - \\frac{\\partial}{\\partial x}(D(y) c_x) = 0$，得到一系列关于 $\\epsilon$ 不同阶数的方程。\n\n各项算子变为：\n- 平流项：$v_0 c_x = v_0 \\left(\\frac{\\partial}{\\partial x} + \\frac{1}{\\epsilon}\\frac{\\partial}{\\partial y}\\right) \\left(c_0 + \\epsilon c_1 + \\dots\\right) = \\frac{v_0}{\\epsilon}\\frac{\\partial c_0}{\\partial y} + v_0\\left(\\frac{\\partial c_0}{\\partial x} + \\frac{\\partial c_1}{\\partial y}\\right) + \\mathcal{O}(\\epsilon)$。\n- 扩散项：$-\\frac{\\partial}{\\partial x}\\left(D(y)\\frac{\\partial c}{\\partial x}\\right) = -\\left(\\frac{\\partial}{\\partial x} + \\frac{1}{\\epsilon}\\frac{\\partial}{\\partial y}\\right)\\left[D(y)\\left(\\frac{\\partial}{\\partial x} + \\frac{1}{\\epsilon}\\frac{\\partial}{\\partial y}\\right)\\left(c_0 + \\epsilon c_1 + \\dots\\right)\\right]$。\n展开扩散项得到：\n$$\n-\\frac{1}{\\epsilon^2}\\frac{\\partial}{\\partial y}\\left(D(y)\\frac{\\partial c_0}{\\partial y}\\right) -\\frac{1}{\\epsilon}\\left[\\frac{\\partial}{\\partial y}\\left(D(y)\\left(\\frac{\\partial c_0}{\\partial x} + \\frac{\\partial c_1}{\\partial y}\\right)\\right) + \\frac{\\partial}{\\partial x}\\left(D(y)\\frac{\\partial c_0}{\\partial y}\\right)\\right] + \\mathcal{O}(1)\n$$\n将这些展开式代入完整的偏微分方程，并收集 $\\epsilon$ 的同次幂项，我们得到一个方程序列。\n\n$\\mathcal{O}(\\epsilon^{-2})$ 阶方程为：\n$$\n-\\frac{\\partial}{\\partial y}\\left(D(y)\\frac{\\partial c_0}{\\partial y}\\right) = 0\n$$\n对 $y$ 积分得到 $D(y)\\frac{\\partial c_0}{\\partial y} = K_1(x,t)$，其中 $K_1$ 是关于 $y$ 的积分常数。因此，$\\frac{\\partial c_0}{\\partial y} = \\frac{K_1(x,t)}{D(y)}$。为了使 $c_0$ 成为 $y$ 的有界函数（特别是周期函数），其导数在一个周期内的平均值必须为零。由于 $D(y)>0$，这意味着 $K_1(x,t)$ 必须为零。因此，$\\frac{\\partial c_0}{\\partial y} = 0$，这表示 $c_0$ 仅是宏观变量的函数：$c_0(x,y,t) = c_0(x,t)$。这个领头项就是宏观浓度，我们记为 $\\overline{c}(x,t)$。所以，$c_0(x,t) = \\overline{c}(x,t)$。\n\n$\\mathcal{O}(\\epsilon^{-1})$ 阶方程为：\n$$\n\\frac{v_0}{\\epsilon}\\frac{\\partial c_0}{\\partial y} - \\frac{1}{\\epsilon}\\left[\\frac{\\partial}{\\partial y}\\left(D(y)\\left(\\frac{\\partial c_0}{\\partial x} + \\frac{\\partial c_1}{\\partial y}\\right)\\right) + \\frac{\\partial}{\\partial x}\\left(D(y)\\frac{\\partial c_0}{\\partial y}\\right)\\right] = 0\n$$\n由于 $\\frac{\\partial c_0}{\\partial y} = 0$，该方程急剧简化为：\n$$\n-\\frac{\\partial}{\\partial y}\\left(D(y)\\left(\\frac{\\partial \\overline{c}}{\\partial x} + \\frac{\\partial c_1}{\\partial y}\\right)\\right) = 0\n$$\n这就是所谓的胞元问题。对 $y$ 积分：\n$$\nD(y)\\left(\\frac{\\partial \\overline{c}}{\\partial x} + \\frac{\\partial c_1}{\\partial y}\\right) = K_2(x,t)\n$$\n其中 $K_2$ 是另一个积分常数。左边的项代表局部扩散通量，它在整个微观胞元内必须是常数。为了确定 $K_2$，我们对 $c_1$ 施加周期性条件。我们将方程重排为 $\\frac{\\partial c_1}{\\partial y} = \\frac{K_2}{D(y)} - \\frac{\\partial \\overline{c}}{\\partial x}$ 并对单位胞元 $Y = [0,1)$ 进行积分：\n$$\n\\int_0^1 \\frac{\\partial c_1}{\\partial y} dy = c_1(x,1,t) - c_1(x,0,t) = 0\n$$\n因此，\n$$\n\\int_0^1 \\left(\\frac{K_2(x,t)}{D(y)} - \\frac{\\partial \\overline{c}}{\\partial x}\\right) dy = 0\n$$\n由于 $\\frac{\\partial \\overline{c}}{\\partial x}$ 和 $K_2$ 与 $y$ 无关，我们有：\n$$\nK_2(x,t) \\int_0^1 \\frac{1}{D(y)} dy - \\frac{\\partial \\overline{c}}{\\partial x} \\int_0^1 dy = 0 \\implies K_2 \\left\\langle D^{-1} \\right\\rangle - \\frac{\\partial \\overline{c}}{\\partial x} = 0\n$$\n其中 $\\langle \\cdot \\rangle$ 表示在单位胞元上的平均值，$\\langle f \\rangle = \\int_0^1 f(y) dy$。解出 $K_2$ 得到：\n$$\nK_2(x,t) = \\frac{1}{\\left\\langle D^{-1} \\right\\rangle} \\frac{\\partial \\overline{c}}{\\partial x}\n$$\n现在我们进行到 $\\mathcal{O}(\\epsilon^0)$ 阶方程。在单位胞元 $Y$ 上进行平均后，该方程将得出宏观控制方程。各项为：\n$$\n\\frac{\\partial c_0}{\\partial t} + v_0\\left(\\frac{\\partial c_0}{\\partial x} + \\frac{\\partial c_1}{\\partial y}\\right) - \\frac{\\partial}{\\partial x}\\left(D(y)\\left(\\frac{\\partial c_0}{\\partial x} + \\frac{\\partial c_1}{\\partial y}\\right)\\right) - \\frac{\\partial}{\\partial y}\\left(D(y)\\left(\\frac{\\partial c_1}{\\partial x} + \\frac{\\partial c_2}{\\partial y}\\right)\\right) = 0\n$$\n我们将平均算子 $\\langle \\cdot \\rangle$ 应用于每一项。\n- $\\left\\langle \\frac{\\partial c_0}{\\partial t} \\right\\rangle = \\frac{\\partial \\overline{c}}{\\partial t}$ (因为 $c_0=\\overline{c}$ 与 $y$ 无关)。\n- $\\left\\langle v_0\\left(\\frac{\\partial \\overline{c}}{\\partial x} + \\frac{\\partial c_1}{\\partial y}\\right) \\right\\rangle = v_0 \\frac{\\partial \\overline{c}}{\\partial x} + v_0 \\langle \\frac{\\partial c_1}{\\partial y} \\rangle = v_0 \\frac{\\partial \\overline{c}}{\\partial x}$ (由于 $c_1$ 的周期性)。\n- $\\left\\langle \\frac{\\partial}{\\partial y}\\left(\\dots\\right) \\right\\rangle = 0$ (对于任何周期性参数)。\n- $\\left\\langle -\\frac{\\partial}{\\partial x}\\left(D(y)\\left(\\frac{\\partial \\overline{c}}{\\partial x} + \\frac{\\partial c_1}{\\partial y}\\right)\\right) \\right\\rangle = -\\frac{\\partial}{\\partial x} \\left\\langle D(y)\\left(\\frac{\\partial \\overline{c}}{\\partial x} + \\frac{\\partial c_1}{\\partial y}\\right) \\right\\rangle$。\n\n平均值内的项正好是 $K_2(x,t)$，它与 $y$ 无关。因此，它的平均值就是它本身：$\\langle K_2(x,t) \\rangle = K_2(x,t)$。\n将此代入平均后的方程，我们得到均匀化方程：\n$$\n\\frac{\\partial \\overline{c}}{\\partial t} + v_0 \\frac{\\partial \\overline{c}}{\\partial x} - \\frac{\\partial}{\\partial x} (K_2(x,t)) = 0\n$$\n代入 $K_2$ 的表达式：\n$$\n\\frac{\\partial \\overline{c}}{\\partial t} + v_0 \\frac{\\partial \\overline{c}}{\\partial x} - \\frac{\\partial}{\\partial x} \\left( \\frac{1}{\\left\\langle D^{-1} \\right\\rangle} \\frac{\\partial \\overline{c}}{\\partial x} \\right) = 0\n$$\n由于 $\\langle D^{-1} \\rangle$ 是一个常数，这变为：\n$$\n\\frac{\\partial \\overline{c}}{\\partial t} + v_0 \\frac{\\partial \\overline{c}}{\\partial x} - \\frac{1}{\\left\\langle D^{-1} \\right\\rangle} \\frac{\\partial^2 \\overline{c}}{\\partial x^2} = 0\n$$\n通过将其与均匀化平流-扩散方程的一般形式 $\\frac{\\partial \\overline{c}}{\\partial t} + v_{\\text{eff}} \\frac{\\partial \\overline{c}}{\\partial x} - D_{\\text{eff}} \\frac{\\partial^2 \\overline{c}}{\\partial x^2} = 0$ 进行比较，我们确定有效扩散系数为：\n$$\nD_{\\text{eff}} = \\frac{1}{\\left\\langle D^{-1} \\right\\rangle}\n$$\n这是微观扩散系数的调和平均值。现在我们为给定的分段常数函数 $D(y)$ 计算平均值 $\\langle D^{-1} \\rangle$：\n$$\n\\left\\langle D^{-1} \\right\\rangle = \\int_0^1 \\frac{1}{D(y)} dy = \\int_0^\\theta \\frac{1}{D_a} dy + \\int_\\theta^1 \\frac{1}{D_b} dy\n$$\n$$\n\\left\\langle D^{-1} \\right\\rangle = \\frac{1}{D_a} [y]_0^\\theta + \\frac{1}{D_b} [y]_\\theta^1 = \\frac{\\theta}{D_a} + \\frac{1-\\theta}{D_b}\n$$\n最后，有效扩散系数为：\n$$\nD_{\\text{eff}} = \\frac{1}{\\frac{\\theta}{D_a} + \\frac{1-\\theta}{D_b}}\n$$\n可以通过在分式中找到公分母来简化此表达式：\n$$\nD_{\\text{eff}} = \\frac{1}{\\frac{\\theta D_b + (1-\\theta)D_a}{D_a D_b}} = \\frac{D_a D_b}{\\theta D_b + (1-\\theta)D_a}\n$$\n这就是有效扩散系数的闭式解析表达式。", "answer": "$$\n\\boxed{\\frac{D_a D_b}{\\theta D_b + (1-\\theta)D_a}}\n$$", "id": "2417046"}, {"introduction": "从精确计算转向物理直觉，本练习探讨了一个更接近现实世界复合材料的复杂情况：相间的非理想界面。真实材料中的界面往往不是完美的，它们的力学行为会显著影响整体性能。本题旨在检验你对均质化背后基本物理原理的理解，例如能量原理和量纲分析，以定性地预测界面效应对材料有效刚度 $\\mathbb{C}_{\\text{eff}}$ 的影响。[@problem_id:2417053]", "problem": "考虑一个两相线弹性复合材料，其由一个各向同性的基体相（杨氏模量为 $E_m$，泊松比为 $\\nu_m$）和一个由半径为 $a$、体积分数为 $f$、具有各向同性性质 $(E_i,\\nu_i)$ 的相同球形夹杂物组成的群体构成。这些相以统计学上各向同性的方式排列。基体和夹杂物之间的界面通过一个线性弹簧层来建模，该层允许位移跳跃但传递牵引力，其特征是恒定的法向刚度 $k_n$ 和切向刚度 $k_t$。记位移场为 $\\boldsymbol{u}$，界面牵引力矢量为 $\\boldsymbol{t}$，界面单位法向量为 $\\boldsymbol{n}$，任意单位切向量为 $\\boldsymbol{s}$，则在界面 $\\Gamma_I$ 上每一点的界面本构关系为：\n$$\n\\boldsymbol{t}\\cdot \\boldsymbol{n} \\;=\\; k_n\\,\\big[\\!\\big[\\,\\boldsymbol{u}\\cdot \\boldsymbol{n}\\,\\big]\\!\\big],\\qquad \n\\boldsymbol{t}\\cdot \\boldsymbol{s} \\;=\\; k_t\\,\\big[\\!\\big[\\,\\boldsymbol{u}\\cdot \\boldsymbol{s}\\,\\big]\\!\\big],\n$$\n其中 $\\big[\\!\\big[\\,\\cdot\\,\\big]\\!\\big]$ 表示跨越界面 $\\Gamma_I$ 的位移跳跃。在极限情况 $k_n,k_t\\to\\infty$ 下，界面是具有位移连续性的完美结合；在极限情况 $k_n,k_t\\to 0$ 下，界面变为无牵引力。\n\n该复合材料的一个代表性体积单元 (RVE) 承受一个均匀给定的宏观（体平均）应变 $\\bar{\\boldsymbol{E}}$，有效刚度张量 $\\mathbb{C}_\\text{eff}$ 通过关系式 $\\langle \\boldsymbol{\\sigma} \\rangle = \\mathbb{C}_\\text{eff} : \\bar{\\boldsymbol{E}}$ 定义，其中 $\\langle \\cdot \\rangle$ 表示体平均，$\\boldsymbol{\\sigma}$ 是 Cauchy 应力。请考虑相对于完美结合的情况，有限的界面刚度 $k_n,k_t$ 如何影响有效刚度。\n\n下列哪个陈述是正确的？\n\nA. 对于任何夹杂物刚度对比度（包括 $E_i > E_m$ 和 $E_i < E_m$ 的情况），用一个具有 $k_n<\\infty$ 和 $k_t<\\infty$ 的有限界面弹簧代替完美结合不会增加有效刚度；它会导致 $\\mathbb{C}_\\text{eff}$ 在正半定张量的意义上减小，仅当 $k_n,k_t\\to\\infty$ 时才恢复相等。\n\nB. 在夹杂物体积分数 $f$ 固定的情况下，随着夹杂物半径 $a$ 的减小，由不完美界面引入的软化效应变得更加显著，因为相关的无量纲参数与 $E_m/(k_n a)$ 和 $G_m/(k_t a)$（其中 $G_m = E_m/\\big(2\\,(1+\\nu_m)\\big)$）成比例，这些参数随着 $a$ 的减小而增大。\n\nC. 在极限情况 $k_n,k_t\\to 0$ 下，复合材料的有效刚度趋近于具有相同形状和体积分数 $f$ 的孔洞夹杂物的多孔基体的刚度。\n\nD. 如果夹杂物比基体软（即 $E_i < E_m$），引入一个足够柔顺的界面（小的 $k_n,k_t$）可以相对于完美结合的情况增加有效刚度，因为传递到软夹杂物中的载荷更少。\n\nE. 如果 $k_n = k_t$（一个各向同性的界面）并且夹杂物是各向同性分布的，那么即使 $k_n$ 和 $k_t$ 是有限的，均匀化后的刚度张量 $\\mathbb{C}_\\text{eff}$ 也是各向同性的。", "solution": "对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- **复合材料组分**：两相线弹性材料。\n- **基体相**：各向同性，杨氏模量为 $E_m$，泊松比为 $\\nu_m$。\n- **夹杂相**：相同的球形夹杂物，半径为 $a$，体积分数为 $f$，具有各向同性性质 $(E_i, \\nu_i)$。\n- **微观结构**：夹杂物的统计学各向同性排列。\n- **界面模型**：界面 $\\Gamma_I$ 上的线性弹簧层。它允许位移跳跃 $\\big[\\!\\big[\\,\\boldsymbol{u}\\,\\big]\\!\\big]$，并由恒定的法向刚度 $k_n$ 和切向刚度 $k_t$ 表征。\n- **界面本构关系**：\n  $$\n  \\boldsymbol{t}\\cdot \\boldsymbol{n} \\;=\\; k_n\\,\\big[\\!\\big[\\,\\boldsymbol{u}\\cdot \\boldsymbol{n}\\,\\big]\\!\\big]\n  $$\n  $$\n  \\boldsymbol{t}\\cdot \\boldsymbol{s} \\;=\\; k_t\\,\\big[\\!\\big[\\,\\boldsymbol{u}\\cdot \\boldsymbol{s}\\,\\big]\\!\\big]\n  $$\n  其中 $\\boldsymbol{t}$ 是牵引力矢量，$\\boldsymbol{n}$ 是界面单位法向量，$\\boldsymbol{s}$ 是任意单位切向量。\n- **极限情况**：\n  - 完美结合（位移连续）：$k_n, k_t \\to \\infty$。\n  - 无牵引力界面：$k_n, k_t \\to 0$。\n- **均匀化**：一个代表性体积单元 (RVE) 承受一个给定的宏观应变 $\\bar{\\boldsymbol{E}}$。\n- **有效刚度定义**：$\\langle \\boldsymbol{\\sigma} \\rangle = \\mathbb{C}_\\text{eff} : \\bar{\\boldsymbol{E}}$，其中 $\\langle \\cdot \\rangle$ 是体平均算子。\n- **问题**：评估与完美结合情况相比，有限界面刚度的影响。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据**：该问题是在线弹性力学和连续介质微观力学的成熟框架内提出的。弹簧层界面模型是一种标准且广泛使用的方法，用于近似薄的、柔顺的界面相或部分脱粘的行为。它在科学上是合理的。\n- **适定性**：带有这些界面条件的 RVE 边值问题是适定的。确定有效性质的均匀化过程是计算材料科学中的一项标准任务。该问题是适定的。\n- **客观性**：语言技术性强、精确，且无主观内容。\n- **完整性与一致性**：为进行定性分析所需的所有必要定义和物理参数均已提供。没有内部矛盾。\n- **真实性**：该模型是对具有不完美界面的真实复合材料的一种物理上合理的理想化。\n\n**第三步：结论与行动**\n问题陈述是有效的。这是含界面材料均匀化中的一个标准问题。可以继续进行求解过程。\n\n**选项的推导与分析**\n\n有效刚度张量 $\\mathbb{C}_\\text{eff}$ 由复合材料的应变能密度确定。对于给定的宏观应变 $\\bar{\\boldsymbol{E}}$，平均应变能密度 $W$ 由下式给出：\n$$\nW = \\frac{1}{2} \\langle \\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon} \\rangle = \\frac{1}{2} \\langle \\boldsymbol{\\sigma} \\rangle : \\langle \\boldsymbol{\\varepsilon} \\rangle = \\frac{1}{2} \\bar{\\boldsymbol{E}} : \\mathbb{C}_\\text{eff} : \\bar{\\boldsymbol{E}}\n$$\n根据最小势能原理，对于给定的 $\\bar{\\boldsymbol{E}}$，RVE 内的实际位移场使总势能最小化。对于具有不完美界面（有限刚度 $k_n, k_t$）的复合材料，其势能泛函为：\n$$\n\\Pi_k[\\boldsymbol{u}] = \\frac{1}{2} \\int_V \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) : \\mathbb{C}(\\boldsymbol{x}) : \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) \\, dV + \\frac{1}{2} \\int_{\\Gamma_I} \\left( k_n \\left(\\big[\\!\\big[\\,\\boldsymbol{u}\\cdot \\boldsymbol{n}\\,\\big]\\!\\big]\\right)^2 + k_t \\left|\\big[\\!\\big[\\,\\boldsymbol{u}_s\\,\\big]\\!\\big]\\right|^2 \\right) \\, dA\n$$\n其中 $\\mathbb{C}(\\boldsymbol{x})$ 是局部刚度张量，在基体中为 $\\mathbb{C}_m$，在夹杂物中为 $\\mathbb{C}_i$，$\\boldsymbol{u}_s$ 是位移的切向分量。\n设 $\\mathcal{K}_k$ 为有限刚度 $k_n, k_t$ 情况下的运动学容许位移场集合。设 $\\mathcal{K}_\\infty$ 为完美结合情况（$k_n, k_t \\to \\infty$）下的容许位移场集合。在完美结合的情况下，位移场必须跨界面连续，因此 $\\big[\\!\\big[\\,\\boldsymbol{u}\\,\\big]\\!\\big] = \\boldsymbol{0}$。于是，$\\mathcal{K}_\\infty \\subset \\mathcal{K}_k$。\n完美结合情况下的应变能 $W_\\infty$ 是在受限场集合 $\\mathcal{K}_\\infty$ 上体应变能的最小值。不完美情况下的应变能 $W_k$ 是在更大的集合 $\\mathcal{K}_k$ 上 $\\Pi_k$ 的最小值。由于 $\\mathcal{K}_\\infty \\subset \\mathcal{K}_k$ 且界面能项是非负的，不完美情况下的最小能量必须小于或等于完美情况下的能量。\n$$\nW_k = \\frac{1}{2}\\bar{\\boldsymbol{E}} : \\mathbb{C}_\\text{eff}^k : \\bar{\\boldsymbol{E}} \\le W_\\infty = \\frac{1}{2}\\bar{\\boldsymbol{E}} : \\mathbb{C}_\\text{eff}^\\infty : \\bar{\\boldsymbol{E}}\n$$\n对于任何给定的宏观应变 $\\bar{\\boldsymbol{E}}$，该不等式都成立。\n\n**A. 对于任何夹杂物刚度对比度（包括 $E_i > E_m$ 和 $E_i < E_m$ 的情况），用一个具有 $k_n<\\infty$ 和 $k_t<\\infty$ 的有限界面弹簧代替完美结合不会增加有效刚度；它会导致 $\\mathbb{C}_\\text{eff}$ 在正半定张量的意义上减小，仅当 $k_n,k_t\\to\\infty$ 时才恢复相等。**\n\n这个陈述直接源于上述变分论证。引入柔顺界面提供了一种额外的变形机制（位移跳跃），这使得整个复合材料更加柔顺。在给定宏观应变下储存的总能量降低（或保持相等）。关系式 $\\bar{\\boldsymbol{E}} : \\mathbb{C}_\\text{eff}^k : \\bar{\\boldsymbol{E}} \\le \\bar{\\boldsymbol{E}} : \\mathbb{C}_\\text{eff}^\\infty : \\bar{\\boldsymbol{E}}$ 对于任意 $\\bar{\\boldsymbol{E}}$ 成立，这正是 $\\mathbb{C}_\\text{eff}^\\infty - \\mathbb{C}_\\text{eff}^k$ 为正半定张量的定义。这是一个基本原理，并且无论 $E_i$ 和 $E_m$ 之间的对比度如何都成立。仅当额外的变形机制被抑制时才能达到相等，这发生在 $k_n, k_t \\to \\infty$ 时，迫使 $\\big[\\!\\big[\\,\\boldsymbol{u}\\,\\big]\\!\\big] \\to \\boldsymbol{0}$。\n**结论：正确。**\n\n**B. 在夹杂物体积分数 $f$ 固定的情况下，随着夹杂物半径 $a$ 的减小，由不完美界面引入的软化效应变得更加显著，因为相关的无量纲参数与 $E_m/(k_n a)$ 和 $G_m/(k_t a)$（其中 $G_m = E_m/\\big(2\\,(1+\\nu_m)\\big)$）成比例，这些参数随着 $a$ 的减小而增大。**\n\n为了评估界面柔度的相对重要性，必须构建无量纲参数。界面刚度，例如 $k_n$，其单位为 [应力]/[长度]。一个特征材料刚度是模量，例如 $E_m$，其单位为 [应力]。问题的特征长度尺度是夹杂物半径 $a$。比较界面柔度与周围材料柔度的无量纲参数确实具有 $E_m/(k_n a)$ 的形式。对于固定的体积分数 $f$，球形夹杂物的数密度为 $N = f / (\\frac{4}{3}\\pi a^3)$，单位体积的总界面面积为 $S_v = N \\cdot (4\\pi a^2) = 3f/a$。随着夹杂物半径 $a$ 的减小，总界面面积 $S_v$ 按 $1/a$ 增加。同时，无量纲参数 $E_m/(k_n a)$ 和 $G_m/(k_t a)$（其中 $G_m$ 是基体剪切模量）也增加。这些参数值越大，意味着界面相对于体材料变形更加柔顺。总界面面积的增加和单位面积相对柔度的增加都导致复合材料整体软化程度更大。因此，对于更小的夹杂物，这种效应更加显著。\n**结论：正确。**\n\n**C. 在极限情况 $k_n,k_t\\to 0$ 下，复合材料的有效刚度趋近于具有相同形状和体积分数 $f$ 的孔洞夹杂物的多孔基体的刚度。**\n\n界面本构关系为 $\\boldsymbol{t} = \\boldsymbol{K} \\cdot \\big[\\!\\big[\\,\\boldsymbol{u}\\,\\big]\\!\\big]$，其中 $\\boldsymbol{K}$ 是具有分量 $k_n$ 和 $k_t$ 的界面刚度张量。在极限情况 $k_n \\to 0$ 和 $k_t \\to 0$ 下，对于任何非零（有限）的位移跳跃 $\\big[\\!\\big[\\,\\boldsymbol{u}\\,\\big]\\!\\big]$，牵引力矢量 $\\boldsymbol{t}$ 必须趋近于零。在夹杂物表面上 $\\boldsymbol{t} = \\boldsymbol{0}$ 的条件是孔洞或孔隙的定义，因为它意味着表面是无牵引力的。因此，具有完全脱粘夹杂物的复合材料的力学行为与具有相同形状和体积分数的孔隙的多孔材料的力学行为相同。\n**结论：正确。**\n\n**D. 如果夹杂物比基体软（即 $E_i < E_m$），引入一个足够柔顺的界面（小的 $k_n,k_t$）可以相对于完美结合的情况增加有效刚度，因为传递到软夹杂物中的载荷更少。**\n\n这个陈述是错误的，并直接与为陈述 A 阐述的变分原理相矛盾。引入界面柔度相当于在体材料上“串联”一个弹簧。这只能增加系统的总柔度（即降低刚度）。关于载荷传递的直观论证是具有误导性的。虽然柔顺界面的确可以使软夹杂物免受应力，但界面本身的柔度对整体变形有贡献，总是导致净软化效应。总刚度是所有变形机制的结果，增加一个新的柔顺机制绝不会增加刚度。\n**结论：不正确。**\n\n**E. 如果 $k_n = k_t$（一个各向同性的界面）并且夹杂物是各向同性分布的，那么即使 $k_n$ 和 $k_t$ 是有限的，均匀化后的刚度张量 $\\mathbb{C}_\\text{eff}$ 也是各向同性的。**\n\n复合材料的整体宏观对称性由其组分和排列的对称性决定。给定的复合材料具有：\n1. 一个各向同性的基体相。\n2. 各向同性的夹杂物（球形形状，各向同性材料性质）。\n3. 这些夹杂物的统计学各向同性分布。\n此外，$k_n = k_t$ 的条件意味着界面响应本身是各向同性的；它不区分法向和切向。由于微观结构的所有方面都是各向同性的，在宏观尺度上，材料中没有优选方向。因此，有效刚度张量 $\\mathbb{C}_\\text{eff}$ 必须是各向同性的。界面刚度的有限值影响有效弹性常数（例如，有效体积模量和剪切模量）的大小，但不会引入任何各向异性。\n**结论：正确。**", "answer": "$$\\boxed{ABCE}$$", "id": "2417053"}, {"introduction": "本章的压轴实践将理论与计算应用相结合，让你扮演一名材料设计师的角色。你的任务是利用均质化模型，通过编程来优化微观结构（具体为椭圆夹杂物的形状），以实现特定的各向异性导热性能。这个练习不仅巩固了你对有效介质理论的理解，更展示了多尺度建模在解决实际工程设计问题中的强大能力。[@problem_id:2417052]", "problem": "您需要开发一个完整的、可运行的程序，为一种二维复合材料的稳态热传导问题求解一个基于优化的均质化问题。该复合材料由嵌入在均匀基体中、周期性排列且对齐的相同椭圆形夹杂物构成。目标是设计微观结构形状（特别是对齐椭圆的纵横比），以最大化一个主方向上的导热系数，同时惩罚横向上的导热系数。\n\n请按照以下步骤从第一性原理出发构建问题。\n\n1) 基本原理和建模假设。\n- 从非均匀介质的稳态热传导方程开始，在电导率恒定的区域，该方程简化为拉普拉斯方程：$\\nabla \\cdot \\left( k \\nabla T \\right) = 0$。在基体相中，电导率为 $k_m$，在夹杂相中，电导率为 $k_i$。假设电导率为标量，且没有内部热源。\n- 假设夹杂物为稀疏浓度，因此在主导阶上可以忽略夹杂物之间的相互作用。设夹杂物的面积分数为 $f$，其中 $0 \\le f \\ll 1$ 以保证稀疏极限的合理性。\n- 考虑一个代表性体积元，其中包含一个对齐的椭圆形夹杂物，其沿 $x$ 方向的半轴为 $a$，沿 $y$ 方向的半轴为 $b$。定义纵横比 $r = a/b > 0$。有效导热系数张量的主轴与椭圆的轴对齐。\n- 在稀疏极限和均匀远场温度梯度下，对齐椭圆的内部场是均匀的，并通过与几何相关的极化因子与外部场相关联。将沿主方向的形状（退极化）因子表示为 $L_x(r)$ 和 $L_y(r)$，它们仅依赖于几何形状（特别是 $r$），并满足适用于对齐椭圆的对称性。\n\n2) 实现前需完成的推导任务。\n- 从 $\\nabla \\cdot \\left( k \\nabla T \\right) = 0$ 出发，并施加温度和法向热通量的界面连续性条件，推导有效导热系数张量分量 $k_{xx}^{\\text{eff}}(r)$ 和 $k_{yy}^{\\text{eff}}(r)$ 在稀疏极限下的表达式，使其作为 $k_m$、$k_i$、$f$ 以及形状因子 $L_x(r)$ 和 $L_y(r)$ 的函数。\n- 对于一个与坐标轴对齐的二维椭圆，推导 $L_x(r)$ 和 $L_y(r)$ 关于半轴 $a$ 和 $b$ 的表达式，然后用纵横比 $r = a/b$ 表示它们。\n\n3) 设计目标和优化。\n- 将“最大化 $x$ 方向而惩罚 $y$ 方向”的设计目标定义为标量泛函\n$$\nJ(r) = k_{xx}^{\\text{eff}}(r) - c \\, k_{yy}^{\\text{eff}}(r),\n$$\n其中 $c > 0$ 是给定的惩罚权重。对于指定的参数集 $\\{k_m, k_i, f, c, r_{\\min}, r_{\\max}\\}$，找到\n$$\nr^\\star \\in [r_{\\min}, r_{\\max}]\n$$\n以最大化 $J(r)$。如果在数值容差内存在多个最大化点，选择其中最小的 $r$。所有导热系数均为无量纲（无物理单位），纵横比 $r$ 也是无量纲的。\n\n4) 计算实现要求。\n- 在 $r \\in [r_{\\min}, r_{\\max}]$ 上使用一个包含 $N = 20001$ 个点的对数间隔网格，实现一个确定性的一维搜索。使用此网格来近似 $r^\\star$、$k_{xx}^{\\text{eff}}(r^\\star)$、$k_{yy}^{\\text{eff}}(r^\\star)$ 和 $J(r^\\star)$。\n- 对于数值上的平局决胜，如果 $J(r)$ 的值在绝对容差 $\\varepsilon_{\\text{abs}} = 10^{-12}$ 和相对容差 $\\varepsilon_{\\text{rel}} = 10^{-12}$ 范围内，则认为它们相等。在平局中，选择最小的 $r$。\n- 对于每个测试用例，将结果报告为一个列表 $[r^\\star, k_{xx}^{\\text{eff}}(r^\\star), k_{yy}^{\\text{eff}}(r^\\star), J(r^\\star)]$，其中每个条目都四舍五入到六位小数。\n\n5) 测试套件。\n使用以下参数集，这些参数集涵盖了不同的对比度和极限情况。对于每种情况，参数以 $(k_m, k_i, f, c, r_{\\min}, r_{\\max})$ 的形式给出：\n- 情况 A (高导热性夹杂物): $(1.0, 50.0, 0.2, 0.5, 0.2, 20.0)$，即 $k_m = 1.0$, $k_i = 50.0$, $f = 0.2$, $c = 0.5$, $r_{\\min} = 0.2$, $r_{\\max} = 20.0$。\n- 情况 B (中等导热性夹杂物): $(1.0, 2.0, 0.3, 1.0, 0.1, 50.0)$，即 $k_m = 1.0$, $k_i = 2.0$, $f = 0.3$, $c = 1.0$, $r_{\\min} = 0.1$, $r_{\\max} = 50.0$。\n- 情况 C (绝缘夹杂物, 稀疏浓度): $(1.0, 0.1, 0.05, 0.9, 0.2, 20.0)$，即 $k_m = 1.0$, $k_i = 0.1$, $f = 0.05$, $c = 0.9$, $r_{\\min} = 0.2$, $r_{\\max} = 20.0$。\n- 情况 D (边界体积分数边缘情况): $(1.0, 5.0, 0.0, 0.7, 0.5, 10.0)$，即 $k_m = 1.0$, $k_i = 5.0$, $f = 0.0$, $c = 0.7$, $r_{\\min} = 0.5$, $r_{\\max} = 10.0$。\n\n6) 要求的最终输出格式。\n- 您的程序应生成单行输出，其中包含四个案例的结果，按顺序排列，格式为一个由列表组成的逗号分隔列表，并用方括号括起来。每个内部列表必须是 $[r^\\star, k_{xx}^{\\text{eff}}(r^\\star), k_{yy}^{\\text{eff}}(r^\\star), J(r^\\star)]$ 的形式，其中每个条目都四舍五入到六位小数。例如：\n\"[[result_case_A],[result_case_B],[result_case_C],[result_case_D]]\"", "solution": "我们从非均匀介质中的稳态热传导开始，该过程由无源能量守恒定律支配，在每个均匀相内部得到拉普拉斯方程：\n$$\n\\nabla \\cdot \\left( k \\nabla T \\right) = 0,\n$$\n其中 $k$ 是所考虑相中的标量导热系数， $T$ 是温度场。在两相之间的完美粘合界面上，温度和热通量的法向分量是连续的：\n$$\nT^{(m)} = T^{(i)} \\quad \\text{and} \\quad \\mathbf{n} \\cdot \\left( k_m \\nabla T^{(m)} \\right) = \\mathbf{n} \\cdot \\left( k_i \\nabla T^{(i)} \\right).\n$$\n\n我们考虑一个二维复合材料，由嵌入基体中的周期性排列的相同、对齐的椭圆形夹杂物组成。设基体导热系数为 $k_m$，夹杂物导热系数为 $k_i$。夹杂物的面积分数为 $f$，其中 $0 \\le f \\ll 1$ 以证明稀疏近似的合理性，在这种近似中，夹杂物间的相互作用在主导阶上被忽略。椭圆的半轴分别为 $a$ （沿 $x$ 方向）和 $b$ （沿 $y$ 方向），我们定义纵横比 $r = a/b > 0$。\n\n在均匀远场温度梯度下，二维中的对齐椭圆表现出均匀的内部场，这类似于经典的 Eshelby 夹杂物问题在稀疏极限下对导热（或静电）问题的处理。这导致一种由几何相关的形状（退极化）因子 $L_x$ 和 $L_y$（与椭圆轴对齐）表征的极化响应。对于二维椭圆（平面传导下的椭圆柱体），标准的势理论和共形映射结果（在均质化和复合材料文献中经过充分检验的事实）给出：\n$$\nL_x = \\frac{b}{a + b}, \\qquad L_y = \\frac{a}{a + b}.\n$$\n它们满足 $L_x + L_y = 1$，并且在交换 $a$ 和 $b$ 时互换，这捕捉了内在的几何各向异性。用纵横比 $r = a/b$ 表示，它们变为\n$$\nL_x(r) = \\frac{1}{1 + r}, \\qquad L_y(r) = \\frac{r}{1 + r}.\n$$\n\n我们现在推导稀疏极限下的有效导热系数分量。施加一个均匀的宏观温度梯度 $\\mathbf{G}$，并考虑在一个代表性区域上的平均热通量 $\\langle \\mathbf{q} \\rangle$。在稀疏极限下，夹杂物对平均通量的扰动与 $f$ 成线性关系，并由夹杂物沿主轴的极化率决定。对于与主轴 $i \\in \\{x,y\\}$ 对齐的均匀远场梯度，夹杂物内的内部梯度通过一个常数浓度因子与远场梯度相关：\n$$\nG_i^{(i)} = \\frac{k_m}{k_m + L_i (k_i - k_m)} \\, G_i^{(\\infty)}.\n$$\n沿方向 $i$ 的平均通量则为\n$$\n\\langle q_i \\rangle = (1 - f) \\, k_m \\, G_i^{(\\infty)} + f \\, k_i \\, G_i^{(i)}\n= \\left[ k_m + f \\, \\frac{k_i - k_m}{1 + \\frac{L_i (k_i - k_m)}{k_m}} \\right] G_i^{(\\infty)}.\n$$\n通过辨识 $\\langle q_i \\rangle = k_{ii}^{\\text{eff}} G_i^{(\\infty)}$，可得稀疏极限下的有效导热系数分量\n$$\nk_{ii}^{\\text{eff}} = k_m \\left[ 1 + f \\, \\frac{k_i - k_m}{k_m + L_i (k_i - k_m)} \\right], \\qquad i \\in \\{x,y\\}.\n$$\n使用 $L_x(r)$ 和 $L_y(r)$ 将其特化于对齐椭圆，得到\n$$\nk_{xx}^{\\text{eff}}(r) = k_m \\left[ 1 + f \\, \\frac{k_i - k_m}{k_m + \\dfrac{1}{1 + r} (k_i - k_m)} \\right],\n$$\n$$\nk_{yy}^{\\text{eff}}(r) = k_m \\left[ 1 + f \\, \\frac{k_i - k_m}{k_m + \\dfrac{r}{1 + r} (k_i - k_m)} \\right].\n$$\n\n定义设计目标\n$$\nJ(r) = k_{xx}^{\\text{eff}}(r) - c \\, k_{yy}^{\\text{eff}}(r),\n$$\n其中给定惩罚权重 $c > 0$。优化问题是\n$$\n\\text{最大化 } J(r) \\quad \\text{约束条件为} \\quad r \\in [r_{\\min}, r_{\\max}].\n$$\n在稀疏、高反差导电夹杂物情况 $k_i > k_m$ 且 $c$ 为中等值时，函数 $J(r)$ 通常随 $r$ 递增，因为 $L_x(r)$ 随 $r$ 减小，从而增强 $k_{xx}^{\\text{eff}}$，而 $L_y(r)$ 随 $r$ 增大，从而调节 $k_{yy}^{\\text{eff}}$。相反，对于 $k_i < k_m$，在某些范围内行为可能反转：减小的 $L_x(r)$ 会加剧 $k_{xx}^{\\text{eff}}$ 的降低，而增大的 $L_y(r)$ 会加剧 $k_{yy}^{\\text{eff}}$ 的降低，与惩罚 $c$ 的权衡决定了最优点。在此处指定的所有情况下，稀疏极限和参数大小的选择都旨在保持物理合理性（例如，避免负的 $k_{ii}^{\\text{eff}}$）。\n\n程序的算法设计：\n- 对于每个测试用例 $(k_m, k_i, f, c, r_{\\min}, r_{\\max})$，在 $[r_{\\min}, r_{\\max}]$ 上构建一个包含 $N = 20001$ 个点的对数间隔网格。\n- 对于每个网格点 $r$，计算 $L_x(r) = 1/(1 + r)$ 和 $L_y(r) = r/(1 + r)$。\n- 使用上述稀疏极限公式计算 $k_{xx}^{\\text{eff}}(r)$ 和 $k_{yy}^{\\text{eff}}(r)$，然后计算 $J(r) = k_{xx}^{\\text{eff}}(r) - c \\, k_{yy}^{\\text{eff}}(r)$。\n- 识别 $J_{\\max}$，并选择在容差 $\\varepsilon_{\\text{abs}} = 10^{-12}$ 和 $\\varepsilon_{\\text{rel}} = 10^{-12}$ 内达到最大值的最小 $r$。\n- 记录元组 $\\left[r^\\star, k_{xx}^{\\text{eff}}(r^\\star), k_{yy}^{\\text{eff}}(r^\\star), J(r^\\star)\\right]$，将每个条目四舍五入到六位小数。\n\n将此方法应用于指定的测试套件：\n- 情况 A $(k_m, k_i, f, c, r_{\\min}, r_{\\max}) = (1.0, 50.0, 0.2, 0.5, 0.2, 20.0)$。\n- 情况 B $(1.0, 2.0, 0.3, 1.0, 0.1, 50.0)$。\n- 情况 C $(1.0, 0.1, 0.05, 0.9, 0.2, 20.0)$。\n- 情况 D $(1.0, 5.0, 0.0, 0.7, 0.5, 10.0)$。\n\n程序实现了这些步骤，执行了平局决胜规则，并按规定的顺序和格式输出包含四个列表的单行列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef shape_factors(r: float):\n    \"\"\"\n    Depolarization (shape) factors for a 2D aligned ellipse with aspect ratio r = a/b.\n    Lx + Ly = 1, with Lx = 1/(1+r), Ly = r/(1+r).\n    \"\"\"\n    Lx = 1.0 / (1.0 + r)\n    Ly = r / (1.0 + r)\n    return Lx, Ly\n\ndef effective_conductivities(km: float, ki: float, f: float, r: float):\n    \"\"\"\n    Dilute-limit effective conductivities for aligned elliptical inclusions.\n    kxx_eff = km * (1 + f * (ki - km) / (km + Lx * (ki - km)))\n    kyy_eff = km * (1 + f * (ki - km) / (km + Ly * (ki - km)))\n    \"\"\"\n    Lx, Ly = shape_factors(r)\n    delta = ki - km\n    denom_x = km + Lx * delta\n    denom_y = km + Ly * delta\n    # Guard against division by zero in pathological parameter choices.\n    # For this assignment's test suite, parameters avoid singular denominators.\n    kxx_eff = km * (1.0 + f * (delta / denom_x))\n    kyy_eff = km * (1.0 + f * (delta / denom_y))\n    return kxx_eff, kyy_eff\n\ndef objective(km: float, ki: float, f: float, c: float, r: float):\n    \"\"\"\n    Objective J(r) = kxx_eff(r) - c * kyy_eff(r).\n    \"\"\"\n    kxx_eff, kyy_eff = effective_conductivities(km, ki, f, r)\n    return kxx_eff - c * kyy_eff, kxx_eff, kyy_eff\n\ndef optimize_case(km: float, ki: float, f: float, c: float, rmin: float, rmax: float,\n                  N: int = 20001, atol: float = 1e-12, rtol: float = 1e-12):\n    \"\"\"\n    Perform logarithmic grid search over r in [rmin, rmax] with N points.\n    Apply tie-breaking: among maximizers within tolerances, pick the smallest r.\n    \"\"\"\n    # Construct logarithmically spaced grid (geomspace) inclusive of endpoints.\n    r_grid = np.geomspace(rmin, rmax, num=N)\n    # Evaluate objective and effective conductivities\n    J_vals = np.empty_like(r_grid)\n    kx_vals = np.empty_like(r_grid)\n    ky_vals = np.empty_like(r_grid)\n    for idx, r in enumerate(r_grid):\n        J, kx, ky = objective(km, ki, f, c, float(r))\n        J_vals[idx] = J\n        kx_vals[idx] = kx\n        ky_vals[idx] = ky\n\n    # Find maximal J and apply tie-breaking with tolerances\n    J_max = float(np.max(J_vals))\n    # isclose with both atol and rtol\n    close_mask = np.isclose(J_vals, J_max, rtol=rtol, atol=atol)\n    # Select the smallest r among ties (first occurrence in increasing r_grid)\n    tie_indices = np.nonzero(close_mask)[0]\n    best_idx = int(tie_indices[0])\n\n    r_star = float(r_grid[best_idx])\n    kx_star = float(kx_vals[best_idx])\n    ky_star = float(ky_vals[best_idx])\n    J_star = float(J_vals[best_idx])\n\n    # Round to six decimals as specified\n    r_star = round(r_star, 6)\n    kx_star = round(kx_star, 6)\n    ky_star = round(ky_star, 6)\n    J_star = round(J_star, 6)\n\n    return [r_star, kx_star, ky_star, J_star]\n\ndef solve():\n    # Define the test cases from the problem statement: (km, ki, f, c, rmin, rmax)\n    test_cases = [\n        (1.0, 50.0, 0.2, 0.5, 0.2, 20.0),   # Case A\n        (1.0, 2.0, 0.3, 1.0, 0.1, 50.0),    # Case B\n        (1.0, 0.1, 0.05, 0.9, 0.2, 20.0),   # Case C\n        (1.0, 5.0, 0.0, 0.7, 0.5, 10.0),    # Case D\n    ]\n\n    results = []\n    for km, ki, f, c, rmin, rmax in test_cases:\n        result = optimize_case(km, ki, f, c, rmin, rmax)\n        results.append(result)\n\n    # Final print statement in the exact required format: single line list of lists\n    # Example: [[r1,kx1,ky1,J1],[r2,kx2,ky2,J2],...]\n    print(f\"[{','.join(str(res) for res in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2417052"}]}