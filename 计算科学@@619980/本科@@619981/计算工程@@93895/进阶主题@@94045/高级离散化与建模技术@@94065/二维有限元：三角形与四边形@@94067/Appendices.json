{"hands_on_practices": [{"introduction": "在进行复杂的工程分析之前，我们必须首先能够描述和操作模型的基本几何构建块——有限元。第一个练习是一个编程实践，专注于网格处理中的一项基本任务：计算由四边形单元组成的区域的面积。通过实现一个给定的公式，你将获得处理单元连接数据和几何计算的实践经验，这些是任何有限元程序的基础。[@problem_id:2448118]", "problem": "给定一个平面域，该域被分解为二维四边形有限元，这在有限元方法（FEM）中很常用。每个四边形单元由笛卡尔平面内的四个不同顶点按边界顺序（顺时针或逆时针）指定。设一个顶点为 $\\mathbf{p}_0=(x_0,y_0)$, $\\mathbf{p}_1=(x_1,y_1)$, $\\mathbf{p}_2=(x_2,y_2)$, $\\mathbf{p}_3=(x_3,y_3)$ 的四边形单元，其单元面积由标量定义为\n$$\nA_e \\;=\\; \\frac{1}{2}\\,\\det\\!\\begin{bmatrix}x_1-x_0 & y_1-y_0\\\\ x_2-x_0 & y_2-y_0\\end{bmatrix} \\;+\\; \\frac{1}{2}\\,\\det\\!\\begin{bmatrix}x_2-x_0 & y_2-y_0\\\\ x_3-x_0 & y_3-y_0\\end{bmatrix},\n$$\n该面积是对角线 $(\\mathbf{p}_0,\\mathbf{p}_2)$ 所形成的两个不重叠三角形的有符号面积之和。该单元的物理（无符号）面积为 $|A_e|$。总域面积是网格中所有单元的物理面积之和。\n\n编写一个完整、可运行的程序，为下面列出的每个网格计算总域面积。坐标以有序元组 $(x,y)$ 的形式给出，值为实数，无物理单位。每个四边形的顶点均按边界顺序列出。您的程序必须独立处理每个网格，并为每个网格返回一个浮点数作为其总面积。\n\n测试套件：\n- 网格 $1$（单个凸四边形）：一个单元，顶点为 $(0,0)$, $(2,0)$, $(2,1)$, $(0,1)$。\n- 网格 $2$（两个相邻的凸四边形）：两个单元，\n  单元 $1$：$(0,0)$, $(1,0)$, $(1,1)$, $(0,1)$；单元 $2$：$(1,0)$, $(2,0)$, $(2,1)$, $(1,1)$。\n- 网格 $3$（单个凹四边形）：一个单元，顶点为 $(0,0)$, $(2,0)$, $(1,0.5)$, $(0,1)$。\n- 网格 $4$（单个零面积的退化四边形）：一个单元，顶点为 $(0,0)$, $(1,0)$, $(2,0)$, $(3,0)$。\n- 网格 $5$（单个斜凸四边形）：一个单元，顶点为 $(0,0)$, $(3,0)$, $(4,1)$, $(1,1)$。\n\n答案规格：\n- 对于每个网格，使用标准十进制表示法输出总域面积，形式为浮点数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[a,b,c]$，其中 $a$、$b$、$c$ 分别是对应于每个网格的浮点数）。", "solution": "问题陈述已提交以供验证。\n\n首先，提取已知条件。\n- 一个四边形单元有按边界顺序排列的顶点 $\\mathbf{p}_0=(x_0,y_0)$, $\\mathbf{p}_1=(x_1,y_1)$, $\\mathbf{p}_2=(x_2,y_2)$, $\\mathbf{p}_3=(x_3,y_3)$。\n- 有符号单元面积 $A_e$ 由以下公式定义：\n$$\nA_e \\;=\\; \\frac{1}{2}\\,\\det\\!\\begin{bmatrix}x_1-x_0 & y_1-y_0\\\\ x_2-x_0 & y_2-y_0\\end{bmatrix} \\;+\\; \\frac{1}{2}\\,\\det\\!\\begin{bmatrix}x_2-x_0 & y_2-y_0\\\\ x_3-x_0 & y_3-y_0\\end{bmatrix}\n$$\n- 一个单元的物理面积是 $|A_e|$。\n- 总域面积是所有单元的物理面积之和。\n- 提供了五个具有特定顶点坐标的测试网格。\n\n接下来，根据既定标准对问题进行验证。\n该问题具有科学依据，植根于计算几何和有限元方法。$A_e$ 的单元面积公式是鞋带算法的一种特定实现，其中多边形的面积是通过对由一个顶点（此处为 $\\mathbf{p}_0$）和其他顶点的连续配对所形成的三角形的有符号面积求和来计算的。该公式在数学上是可靠的，并且是计算多边形面积的标准方法。\n\n然而，必须指出一个不精确之处。问题文本将该公式描述为计算“由对角线 $(\\mathbf{p}_0,\\mathbf{p}_2)$ 形成的两个不重叠三角形的有符号面积之和”。对于顶点按边界顺序为 $\\mathbf{p}_0, \\mathbf{p}_1, \\mathbf{p}_2, \\mathbf{p}_3$ 的四边形，这条对角线正确地将单元划分为三角形 $\\triangle \\mathbf{p}_0\\mathbf{p}_1\\mathbf{p}_2$ 和 $\\triangle \\mathbf{p}_0\\mathbf{p}_3\\mathbf{p}_2$。而所提供的公式，计算的却是 $\\triangle \\mathbf{p}_0\\mathbf{p}_1\\mathbf{p}_2$ 和 $\\triangle \\mathbf{p}_0\\mathbf{p}_2\\mathbf{p}_3$ 的有符号面积之和。这对应于从顶点 $\\mathbf{p}_0$ 扇形展开的三角剖分，这是计算多边形面积的一种有效方法，但通常不被描述为由对角线 $(\\mathbf{p}_0,\\mathbf{p}_2)$ 进行的划分。\n\n这种差异是文字解释上的缺陷，而非数学定义本身的缺陷。由于 $A_e$ 的公式是明确给出且在数学上是可靠的（它等同于标准的鞋带公式），因此它构成了一个无歧义的定义。任务是应用此定义。因此，该问题是适定且可解的。\n\n结论：该问题是**有效的**。使用所提供定义计算面积的指令是清晰的。有缺陷的几何描述是一个非关键性错误。我们继续进行求解。\n\n总域面积 $\\mathcal{A}$ 是网格中所有 $N$ 个单元的物理面积的总和。\n$$ \\mathcal{A} = \\sum_{i=1}^{N} |A_{e,i}| $$\n具有顶点 $\\mathbf{p}_0, \\mathbf{p}_1, \\mathbf{p}_2, \\mathbf{p}_3$ 的单个四边形的有符号面积 $A_e$ 使用给定公式计算。我们用 $D_1$ 和 $D_2$ 表示两个行列式项。\n$$ D_1 = (x_1-x_0)(y_2-y_0) - (y_1-y_0)(x_2-x_0) $$\n$$ D_2 = (x_2-x_0)(y_3-y_0) - (y_2-y_0)(x_3-x_0) $$\n$$ A_e = \\frac{1}{2} (D_1 + D_2) $$\n我们现在为每个指定的网格计算总面积。\n\n网格 $1$：一个凸四边形，顶点为 $\\mathbf{p}_0(0,0)$, $\\mathbf{p}_1(2,0)$, $\\mathbf{p}_2(2,1)$, $\\mathbf{p}_3(0,1)$。\n该网格由单个单元组成。\n$x_0=0, y_0=0, x_1=2, y_1=0, x_2=2, y_2=1, x_3=0, y_3=1$.\n$D_1 = (2-0)(1-0) - (0-0)(2-0) = 2$。\n$D_2 = (2-0)(1-0) - (1-0)(0-0) = 2$。\n$A_e = \\frac{1}{2} (2 + 2) = 2.0$。\n总面积 $\\mathcal{A}_1 = |2.0| = 2.0$。\n\n网格 $2$：两个相邻的凸四边形。\n单元 $1$：$\\mathbf{p}_0(0,0)$, $\\mathbf{p}_1(1,0)$, $\\mathbf{p}_2(1,1)$, $\\mathbf{p}_3(0,1)$。\n$x_0=0, y_0=0, x_1=1, y_1=0, x_2=1, y_2=1, x_3=0, y_3=1$.\n$D_1 = (1-0)(1-0) - (0-0)(1-0) = 1$。\n$D_2 = (1-0)(1-0) - (1-0)(0-0) = 1$。\n$A_{e,1} = \\frac{1}{2} (1 + 1) = 1.0$。\n\n单元 $2$：$\\mathbf{p}_0(1,0)$, $\\mathbf{p}_1(2,0)$, $\\mathbf{p}_2(2,1)$, $\\mathbf{p}_3(1,1)$。\n$x_0=1, y_0=0, x_1=2, y_1=0, x_2=2, y_2=1, x_3=1, y_3=1$.\n$D_1 = (2-1)(1-0) - (0-0)(2-1) = 1$。\n$D_2 = (2-1)(1-0) - (1-0)(1-1) = 1$。\n$A_{e,2} = \\frac{1}{2} (1 + 1) = 1.0$。\n总面积 $\\mathcal{A}_2 = |A_{e,1}| + |A_{e,2}| = 1.0 + 1.0 = 2.0$。\n\n网格 $3$：一个凹四边形，顶点为 $\\mathbf{p}_0(0,0)$, $\\mathbf{p}_1(2,0)$, $\\mathbf{p}_2(1,0.5)$, $\\mathbf{p}_3(0,1)$。\n$x_0=0, y_0=0, x_1=2, y_1=0, x_2=1, y_2=0.5, x_3=0, y_3=1$.\n$D_1 = (2-0)(0.5-0) - (0-0)(1-0) = 1$。\n$D_2 = (1-0)(1-0) - (0.5-0)(0-0) = 1$。\n$A_e = \\frac{1}{2} (1 + 1) = 1.0$。\n总面积 $\\mathcal{A}_3 = |1.0| = 1.0$。\n\n网格 $4$：一个退化四边形，顶点为 $\\mathbf{p}_0(0,0)$, $\\mathbf{p}_1(1,0)$, $\\mathbf{p}_2(2,0)$, $\\mathbf{p}_3(3,0)$。\n$x_0=0, y_0=0, x_1=1, y_1=0, x_2=2, y_2=0, x_3=3, y_3=0$.\n$D_1 = (1-0)(0-0) - (0-0)(2-0) = 0$。\n$D_2 = (2-0)(0-0) - (0-0)(3-0) = 0$。\n$A_e = \\frac{1}{2} (0 + 0) = 0.0$。\n总面积 $\\mathcal{A}_4 = |0.0| = 0.0$。\n\n网格 $5$：一个斜凸四边形，顶点为 $\\mathbf{p}_0(0,0)$, $\\mathbf{p}_1(3,0)$, $\\mathbf{p}_2(4,1)$, $\\mathbf{p}_3(1,1)$。\n$x_0=0, y_0=0, x_1=3, y_1=0, x_2=4, y_2=1, x_3=1, y_3=1$.\n$D_1 = (3-0)(1-0) - (0-0)(4-0) = 3$。\n$D_2 = (4-0)(1-0) - (1-0)(1-0) = 4 - 1 = 3$。\n$A_e = \\frac{1}{2} (3 + 3) = 3.0$。\n总面积 $\\mathcal{A}_5 = |3.0| = 3.0$。\n\n最终结果是 $[2.0, 2.0, 1.0, 0.0, 3.0]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_physical_area(vertices):\n    \"\"\"\n    Computes the physical (unsigned) area of a single quadrilateral element.\n\n    The element area is defined by the scalar expression from the problem statement:\n    A_e = 0.5 * det([[x1-x0, y1-y0], [x2-x0, y2-y0]]) + \n          0.5 * det([[x2-x0, y2-y0], [x3-x0, y3-y0]])\n\n    Args:\n        vertices: A list of four vertex coordinate tuples (x, y) in boundary order.\n                  Example: [(x0, y0), (x1, y1), (x2, y2), (x3, y3)]\n\n    Returns:\n        The physical area |A_e| as a float.\n    \"\"\"\n    # Assign vertices for clarity. np.array allows for vector operations.\n    p0 = np.array(vertices[0], dtype=float)\n    p1 = np.array(vertices[1], dtype=float)\n    p2 = np.array(vertices[2], dtype=float)\n    p3 = np.array(vertices[3], dtype=float)\n\n    # Define the vectors for the two determinants, originating from p0.\n    # These vectors form the rows of the matrices in the determinant calculation.\n    v10 = p1 - p0\n    v20 = p2 - p0\n    v30 = p3 - p0\n\n    # The formula is the sum of two 2x2 determinants.\n    # The first determinant is for the triangle formed by (p0, p1, p2).\n    # The matrix for the first determinant is formed by vectors v10 and v20.\n    matrix1 = np.array([v10, v20])\n    det1 = np.linalg.det(matrix1)\n\n    # The second determinant is for the triangle formed by (p0, p2, p3).\n    # The matrix for the second determinant is formed by vectors v20 and v30.\n    matrix2 = np.array([v20, v30])\n    det2 = np.linalg.det(matrix2)\n\n    # The signed area A_e is half the sum of the determinants.\n    signed_area = 0.5 * (det1 + det2)\n\n    # The physical area is the absolute value of the signed area.\n    return abs(signed_area)\n\ndef solve():\n    \"\"\"\n    Main function to process the test suite and compute total domain areas.\n    \"\"\"\n    # Define the test suite. Each item is a mesh, which is a list of elements.\n    # Each element is a list of its four vertex coordinates.\n    test_suite = [\n        # Mesh 1: single convex quadrilateral\n        [\n            [(0, 0), (2, 0), (2, 1), (0, 1)]\n        ],\n        # Mesh 2: two adjacent convex quadrilaterals\n        [\n            [(0, 0), (1, 0), (1, 1), (0, 1)],\n            [(1, 0), (2, 0), (2, 1), (1, 1)]\n        ],\n        # Mesh 3: single concave quadrilateral\n        [\n            [(0, 0), (2, 0), (1, 0.5), (0, 1)]\n        ],\n        # Mesh 4: single degenerate quadrilateral of zero area\n        [\n            [(0, 0), (1, 0), (2, 0), (3, 0)]\n        ],\n        # Mesh 5: single skew convex quadrilateral (a parallelogram)\n        [\n            [(0, 0), (3, 0), (4, 1), (1, 1)]\n        ]\n    ]\n\n    results = []\n    # Iterate through each mesh in the test suite.\n    for mesh in test_suite:\n        total_domain_area = 0.0\n        # A mesh can have one or more elements. Sum their physical areas.\n        for element_vertices in mesh:\n            total_domain_area += calculate_physical_area(element_vertices)\n        results.append(total_domain_area)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2448118"}, {"introduction": "有限元公式通常涉及在单元区域上对函数进行积分，这个任务通常是数值完成的。本练习将带你“深入幕后”，为一个标准三角形单元推导一个自定义的数值积分法则。通过对一组多项式强制执行精确性，你将确定精确积分所需的特定位置（积分点）和权重，从而揭开有限元方法中一个关键部分的神秘面纱。[@problem_id:2448141]", "problem": "考虑一个参考二维线性三角形有限元，其顶点位于笛卡尔坐标 $(0,0)$、$(1,0)$ 和 $(0,1)$。令 $T$ 表示该参考三角形。您的任务是为 $T$ 建立一个对称的 $3$ 点数值求积法则，该法则对于总次数至多为 $2$ 的任意多项式场 $p(x,y)$ 都是精确的。根据对称性，假设三个求积点是重心坐标三元组 $(\\alpha,\\alpha,1-2\\alpha)$ 相对于三个顶点的排列，并且所有三个求积点共享一个共同的权重 $w$。使用数值求积作为近似积分的加权和的基本定义，并对单项式 $1$、$x$、$y$、$x^{2}$、$xy$ 和 $y^{2}$ 强制其精确性，以推导出关于 $\\alpha$ 和 $w$ 的条件。直接在参考三角形 $T$ 上进行计算（即，不要从其他域进行映射）。只需报告此参考三角形得到的共同节点权重 $w$，并以最简分数形式表示。答案没有单位。不要进行四舍五入。", "solution": "问题要求为顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$ 的参考三角形 $T$ 推导一个对称的 $3$ 点数值求积法则。该法则必须对总次数最高为 $2$ 的任意多项式都是精确的。\n\n数值求积法则的一般形式由下式给出：\n$$\n\\int_T f(x,y) dA \\approx \\sum_{i=1}^{N} w_i f(x_i, y_i)\n$$\n在此特定问题中，给定 $N=3$ 个求积点，并且所有权重都相等，$w_1 = w_2 = w_3 = w$。该公式简化为：\n$$\n\\int_T f(x,y) dA \\approx w \\left( f(x_1, y_1) + f(x_2, y_2) + f(x_3, y_3) \\right)\n$$\n积分域是参考三角形 $T$，由不等式 $x \\ge 0$、$y \\ge 0$ 和 $x+y \\le 1$ 定义。该三角形的面积为 $A = \\frac{1}{2}$。\n\n为使求积法则对所有次数至多为 $2$ 的多项式都精确，它必须对此类多项式空间的一组基是精确的。一组标准的单项式基是 $\\{1, x, y, x^2, xy, y^2\\}$。我们必须对这些单项式中的每一个强制等式成立。\n\n首先，我们确定求积点的笛卡尔坐标。这些点由重心坐标三元组 $(\\alpha, \\alpha, 1-2\\alpha)$ 的排列给出。对于顶点为 $V_1=(0,0)$、$V_2=(1,0)$ 和 $V_3=(0,1)$ 的参考三角形，一个重心坐标为 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 的点，其笛卡尔坐标为 $(x,y) = (\\lambda_2, \\lambda_3)$。这 $3$ 个不同的排列定义了 $3$ 个求积点：\n\\begin{itemize}\n    \\item $P_1$：重心坐标 $(1-2\\alpha, \\alpha, \\alpha) \\implies$ 笛卡尔坐标 $(x_1, y_1) = (\\alpha, \\alpha)$\n    \\item $P_2$：重心坐标 $(\\alpha, 1-2\\alpha, \\alpha) \\implies$ 笛卡尔坐标 $(x_2, y_2) = (1-2\\alpha, \\alpha)$\n    \\item $P_3$：重心坐标 $(\\alpha, \\alpha, 1-2\\alpha) \\implies$ 笛卡尔坐标 $(x_3, y_3) = (\\alpha, 1-2\\alpha)$\n\\end{itemize}\n为使这些点位于三角形内，其重心坐标必须为非负，这要求 $0 \\le \\alpha \\le \\frac{1}{2}$。\n\n现在，我们将每个单项式的精确积分与其通过求积法则得到的近似值相等，从而建立方程组。\n\n精确积分计算如下：\n\\begin{itemize}\n    \\item $p(x,y) = 1$：$I_1 = \\int_T 1 \\, dA = \\text{Area}(T) = \\frac{1}{2}$\n    \\item $p(x,y) = x$：$I_x = \\int_0^1 \\int_0^{1-x} x \\, dy \\, dx = \\int_0^1 x(1-x) \\, dx = \\left[\\frac{x^2}{2} - \\frac{x^3}{3}\\right]_0^1 = \\frac{1}{6}$\n    \\item $p(x,y) = y$：$I_y = \\int_0^1 \\int_0^{1-y} y \\, dx \\, dy = \\frac{1}{6}$ (根据与 $I_x$ 的对称性)\n    \\item $p(x,y) = x^2$：$I_{x^2} = \\int_0^1 x^2(1-x) \\, dx = \\left[\\frac{x^3}{3} - \\frac{x^4}{4}\\right]_0^1 = \\frac{1}{12}$\n    \\item $p(x,y) = y^2$：$I_{y^2} = \\frac{1}{12}$ (根据与 $I_{x^2}$ 的对称性)\n    \\item $p(x,y) = xy$：$I_{xy} = \\int_0^1 x\\left[\\frac{y^2}{2}\\right]_0^{1-x} \\, dx = \\frac{1}{2}\\int_0^1 x(1-x)^2 \\, dx = \\frac{1}{2}\\int_0^1 (x - 2x^2 + x^3) \\, dx = \\frac{1}{2}\\left[\\frac{x^2}{2} - \\frac{2x^3}{3} + \\frac{x^4}{4}\\right]_0^1 = \\frac{1}{2}\\left(\\frac{1}{2} - \\frac{2}{3} + \\frac{1}{4}\\right) = \\frac{1}{24}$\n\\end{itemize}\n\n接下来，我们计算相应的求积和：\n\\begin{itemize}\n    \\item $p(x,y) = 1$：$S_1 = w(1+1+1) = 3w$\n    \\item $p(x,y) = x$：$S_x = w(x_1+x_2+x_3) = w(\\alpha + (1-2\\alpha) + \\alpha) = w(1) = w$\n    \\item $p(x,y) = y$：$S_y = w(y_1+y_2+y_3) = w(\\alpha + \\alpha + (1-2\\alpha)) = w(1) = w$\n    \\item $p(x,y) = x^2$：$S_{x^2} = w(x_1^2+x_2^2+x_3^2) = w(\\alpha^2 + (1-2\\alpha)^2 + \\alpha^2) = w(2\\alpha^2 + 1 - 4\\alpha + 4\\alpha^2) = w(6\\alpha^2 - 4\\alpha + 1)$\n    \\item $p(x,y) = y^2$：$S_{y^2} = w(y_1^2+y_2^2+y_3^2) = w(\\alpha^2 + \\alpha^2 + (1-2\\alpha)^2) = w(6\\alpha^2 - 4\\alpha + 1)$\n    \\item $p(x,y) = xy$：$S_{xy} = w(x_1y_1+x_2y_2+x_3y_3) = w(\\alpha^2 + (1-2\\alpha)\\alpha + \\alpha(1-2\\alpha)) = w(\\alpha^2 + 2\\alpha - 4\\alpha^2) = w(2\\alpha - 3\\alpha^2)$\n\\end{itemize}\n\n现在，我们令积分和求积和相等，$I_k = S_k$，以形成关于 $w$ 和 $\\alpha$ 的方程组。\n\\begin{enumerate}\n    \\item 对于 $p=1$：$\\frac{1}{2} = 3w \\implies w = \\frac{1}{6}$。\n    这个关于常数单项式的第一个方程唯一地确定了权重 $w$。\n    \\item 对于 $p=x$：$\\frac{1}{6} = w$。这与之前的结果一致。\n    \\item 对于 $p=y$：$\\frac{1}{6} = w$。这也与之前的结果一致。\n    \\item 对于 $p=x^2$：$\\frac{1}{12} = w(6\\alpha^2 - 4\\alpha + 1)$。代入 $w=\\frac{1}{6}$：\n        $$ \\frac{1}{12} = \\frac{1}{6}(6\\alpha^2 - 4\\alpha + 1) $$\n        $$ \\frac{1}{2} = 6\\alpha^2 - 4\\alpha + 1 \\implies 12\\alpha^2 - 8\\alpha + 2 = 1 \\implies 12\\alpha^2 - 8\\alpha + 1 = 0 $$\n    \\item 对于 $p=y^2$：由于对称性，这得出了与 $p=x^2$ 相同的方程。\n    \\item 对于 $p=xy$：$\\frac{1}{24} = w(2\\alpha - 3\\alpha^2)$。代入 $w=\\frac{1}{6}$：\n        $$ \\frac{1}{24} = \\frac{1}{6}(2\\alpha - 3\\alpha^2) $$\n        $$ \\frac{1}{4} = 2\\alpha - 3\\alpha^2 \\implies 1 = 8\\alpha - 12\\alpha^2 \\implies 12\\alpha^2 - 8\\alpha + 1 = 0 $$\n\\end{enumerate}\n两个二次单项式都得出了关于 $\\alpha$ 的相同二次方程。这表明所假设的求积法则的对称形式是一致的。我们求解这个关于 $\\alpha$ 的方程：\n$$\n12\\alpha^2 - 8\\alpha + 1 = 0\n$$\n对该二次式进行因式分解，得到 $(6\\alpha - 1)(2\\alpha - 1) = 0$。解为 $\\alpha = \\frac{1}{6}$ 和 $\\alpha = \\frac{1}{2}$。\n两个值都在有效范围 $0 \\le \\alpha \\le \\frac{1}{2}$ 内。因此，在给定的对称性假设下，存在两种这样的求积法则。然而，这两种法则都共享相同的公共权重 $w$。\n\n问题只要求公共节点权重 $w$。正如从多项式 $p(x,y) = 1$ 的精确性条件推导出的那样，该权重是唯一确定的。\n$$\n3w = \\frac{1}{2} \\implies w = \\frac{1}{6}\n$$\n$\\alpha$ 存在有效解证实了具有此权重和指定对称结构的求积法则确实存在。公共节点权重为 $w = \\frac{1}{6}$。", "answer": "$$\n\\boxed{\\frac{1}{6}}\n$$", "id": "2448141"}, {"introduction": "现在，我们将我们对单元公式的理解应用到一个实际的分析场景中。这个问题挑战你计算一个由正交各向异性材料制成的四边形单元的应变能，其中材料的自然轴相对于全局坐标系发生了旋转。这个综合性计算将要求你进行应变变换，应用各向异性本构关系，并计算能量，将固体力学和有限元法的许多核心概念联系在一起。[@problem_id:2448113]", "problem": "在全局坐标系中，一个四节点双线性四边形（Q4）有限元（FE）占据一个矩形区域，其角节点逆时针编号如下：节点$1$位于$(0,0)$，节点$2$位于$(2,0)$，节点$3$位于$(2,1)$，节点$4$位于$(0,1)$，所有坐标单位均为米。该单元厚度均匀，为 $t = 0.01$ 米，且处于平面应力状态。材料为线性弹性正交各向异性材料。主材料轴（$1$–$2$）由全局 $x$ 轴逆时针旋转 $\\theta = 30$ 度得到。在材料坐标系下，正交各向异性弹性常数为：杨氏模量 $E_1 = 1.50 \\times 10^{11}$ Pa 和 $E_2 = 5.00 \\times 10^{10}$ Pa，主泊松比 $\\nu_{12} = 0.25$，以及面内剪切模量 $G_{12} = 2.00 \\times 10^{10}$ Pa。副泊松比满足关系 $\\nu_{21} = \\nu_{12} E_2 / E_1$。\n\n节点位移向量，按 $[u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4]^{\\mathrm{T}}$ 顺序排列，由每个节点 $i$ 上的 $u_i = \\varepsilon_0 x_i$ 和 $v_i = 0$ 给定，其中 $\\varepsilon_0 = 1.00 \\times 10^{-3}$ 是无量纲的，而 $x_i$ 是节点 $i$ 的全局 $x$ 坐标。具体数值上，这得到的位移向量为 $[0, 0, 2.00 \\times 10^{-3}, 0, 2.00 \\times 10^{-3}, 0, 0, 0]^{\\mathrm{T}}$，单位为米。\n\n计算此单元中存储的总内部应变能。最终能量以焦耳 (J) 为单位表示，并将您的答案四舍五入到四位有效数字。如上所述，角度单位为度。", "solution": "该有限元（FE）是一个位于矩形（也是一种平行四边形）上的四节点双线性四边形（Q4）。根据给定的节点值 $u_i = \\varepsilon_0 x_i$ 和 $v_i = 0$，单元内部的插值位移场精确再现了以下线性场：\n$$\nu(x,y) = \\varepsilon_0 x, \\qquad v(x,y) = 0,\n$$\n因此，在全局坐标轴（$x,y$）下的面内小应变分量是恒定的：\n$$\n\\varepsilon_{xx} = \\frac{\\partial u}{\\partial x} = \\varepsilon_0, \\qquad \\varepsilon_{yy} = \\frac{\\partial v}{\\partial y} = 0, \\qquad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = 0.\n$$\n\n由于材料是正交各向异性的，其坐标轴（$1$–$2$）由（$x$–$y$）坐标轴旋转 $\\theta$ 角得到，我们使用标准平面应力应变变换，将全局应变 $\\{\\varepsilon\\}_g = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathrm{T}}$ 变换到材料坐标轴下的应变 $\\{\\varepsilon\\}_m = [\\varepsilon_{1}, \\varepsilon_{2}, \\gamma_{12}]^{\\mathrm{T}}$。变换中令 $m = \\cos\\theta$ 且 $n = \\sin\\theta$：\n$$\n\\varepsilon_{1} = m^{2}\\varepsilon_{xx} + n^{2}\\varepsilon_{yy} + mn\\,\\gamma_{xy}, \\\\\n\\varepsilon_{2} = n^{2}\\varepsilon_{xx} + m^{2}\\varepsilon_{yy} - mn\\,\\gamma_{xy}, \\\\\n\\gamma_{12} = -2mn\\,\\varepsilon_{xx} + 2mn\\,\\varepsilon_{yy} + (m^{2}-n^{2})\\gamma_{xy}.\n$$\n当 $\\theta = 30$ 度时，我们有 $m = \\cos 30^\\circ = \\sqrt{3}/2$ 和 $n = \\sin 30^\\circ = 1/2$。代入 $\\varepsilon_{xx} = \\varepsilon_0$，$\\varepsilon_{yy} = 0$ 和 $\\gamma_{xy} = 0$，可得：\n$$\n\\varepsilon_{1} = m^{2}\\varepsilon_0 = \\frac{3}{4}\\,\\varepsilon_0, \\qquad\n\\varepsilon_{2} = n^{2}\\varepsilon_0 = \\frac{1}{4}\\,\\varepsilon_0, \\qquad\n\\gamma_{12} = -2mn\\,\\varepsilon_0 = -\\sin(60^\\circ)\\,\\varepsilon_0 = -\\frac{\\sqrt{3}}{2}\\,\\varepsilon_0.\n$$\n\n在材料坐标系下的平面应力状态中，正交各向异性应力-应变关系为：\n$$\n\\begin{bmatrix}\n\\sigma_{1} \\\\ \\sigma_{2} \\\\ \\tau_{12}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nQ_{11} & Q_{12} & 0 \\\\\nQ_{12} & Q_{22} & 0 \\\\\n0 & 0 & Q_{66}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\varepsilon_{1} \\\\ \\varepsilon_{2} \\\\ \\gamma_{12}\n\\end{bmatrix},\n$$\n其中\n$$\n\\nu_{21} = \\nu_{12}\\frac{E_2}{E_1}, \\qquad \\Delta = 1 - \\nu_{12}\\nu_{21}, \\\\\nQ_{11} = \\frac{E_1}{\\Delta}, \\quad Q_{22} = \\frac{E_2}{\\Delta}, \\quad Q_{12} = \\frac{\\nu_{12}E_2}{\\Delta}, \\quad Q_{66} = G_{12}.\n$$\n应变能密度（单位体积的应变能）为：\n$$\nw = \\frac{1}{2}\\left(Q_{11}\\varepsilon_{1}^{2} + 2Q_{12}\\varepsilon_{1}\\varepsilon_{2} + Q_{22}\\varepsilon_{2}^{2} + Q_{66}\\gamma_{12}^{2}\\right).\n$$\n\n代入给定的材料常数。首先计算副泊松比和 $\\Delta$：\n$$\nE_1 = 1.50\\times 10^{11} \\text{ Pa}, \\quad E_2 = 5.00\\times 10^{10} \\text{ Pa}, \\quad \\nu_{12} = 0.25, \\quad G_{12} = 2.00\\times 10^{10} \\text{ Pa}, \\\\\n\\nu_{21} = \\nu_{12}\\frac{E_2}{E_1} = 0.25 \\times \\frac{5.00\\times 10^{10}}{1.50\\times 10^{11}} = \\frac{1}{12}, \\qquad\n\\Delta = 1 - \\nu_{12}\\nu_{21} = 1 - \\frac{1}{48} = \\frac{47}{48}.\n$$\n因此\n$$\nQ_{11} = \\frac{E_1}{\\Delta} = \\left(1.50\\times 10^{11}\\right)\\frac{48}{47} = \\frac{7200}{47}\\times 10^{9} \\text{ Pa}, \\\\\nQ_{22} = \\frac{E_2}{\\Delta} = \\left(5.00\\times 10^{10}\\right)\\frac{48}{47} = \\frac{2400}{47}\\times 10^{9} \\text{ Pa}, \\\\\nQ_{12} = \\frac{\\nu_{12}E_2}{\\Delta} = \\left(0.25\\times 5.00\\times 10^{10}\\right)\\frac{48}{47} = \\frac{600}{47}\\times 10^{9} \\text{ Pa}, \\\\\nQ_{66} = 2.00\\times 10^{10} \\text{ Pa}.\n$$\n\n当 $\\varepsilon_0 = 1.00\\times 10^{-3}$ 时，材料坐标系下的应变为：\n$$\n\\varepsilon_{1} = \\frac{3}{4}\\times 10^{-3} = 7.50\\times 10^{-4}, \\quad\n\\varepsilon_{2} = \\frac{1}{4}\\times 10^{-3} = 2.50\\times 10^{-4}, \\quad\n\\gamma_{12} = -\\frac{\\sqrt{3}}{2}\\times 10^{-3} \\approx -8.6602540378\\times 10^{-4}.\n$$\n接着\n$$\n\\varepsilon_{1}^{2} = 5.625\\times 10^{-7}, \\quad\n\\varepsilon_{2}^{2} = 6.25\\times 10^{-8}, \\quad\n\\varepsilon_{1}\\varepsilon_{2} = 1.875\\times 10^{-7}, \\quad\n\\gamma_{12}^{2} = \\frac{3}{4}\\times 10^{-6} = 7.5\\times 10^{-7}.\n$$\n计算 $w$ 表达式中的各项之和：\n$$\nQ_{11}\\varepsilon_{1}^{2} = \\left(\\frac{7200}{47}\\times 10^{9}\\right)\\left(5.625\\times 10^{-7}\\right) = 8.6170212766\\times 10^{4} \\text{ Pa}, \\\\\n2Q_{12}\\varepsilon_{1}\\varepsilon_{2} = 2\\left(\\frac{600}{47}\\times 10^{9}\\right)\\left(1.875\\times 10^{-7}\\right) = 4.7872340426\\times 10^{3} \\text{ Pa}, \\\\\nQ_{22}\\varepsilon_{2}^{2} = \\left(\\frac{2400}{47}\\times 10^{9}\\right)\\left(6.25\\times 10^{-8}\\right) = 3.1914893617\\times 10^{3} \\text{ Pa}, \\\\\nQ_{66}\\gamma_{12}^{2} = \\left(2.00\\times 10^{10}\\right)\\left(7.5\\times 10^{-7}\\right) = 1.5000\\times 10^{4} \\text{ Pa}.\n$$\n因此\n$$\nw = \\frac{1}{2}\\left(8.6170212766\\times 10^{4} + 4.7872340426\\times 10^{3} + 3.1914893617\\times 10^{3} + 1.5000\\times 10^{4}\\right) \\text{ Pa} \\\\\n= \\frac{1}{2}\\left(1.0914893617\\times 10^{5}\\right) \\text{ Pa} = 5.4574468085\\times 10^{4} \\text{ J/m}^3.\n$$\n\n单元面积为 $A = 2 \\times 1 = 2$ m$^2$，厚度为 $t = 0.01$ m，因此体积为 $V = A t = 0.02$ m$^3$。总内部应变能为：\n$$\nU = w V = \\left(5.4574468085\\times 10^{4}\\right)\\times 0.02 \\text{ J} = 1.0914893617\\times 10^{3} \\text{ J}.\n$$\n四舍五入到四位有效数字，总内部应变能为 $1091$ J。", "answer": "$$\\boxed{1091}$$", "id": "2448113"}]}