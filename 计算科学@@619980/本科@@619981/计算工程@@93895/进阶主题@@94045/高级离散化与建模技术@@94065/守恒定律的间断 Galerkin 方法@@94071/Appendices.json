{"hands_on_practices": [{"introduction": "守恒律是计算方法的核心，此练习旨在探讨局部守恒这一基本性质，它是间断伽辽金（DG）方法设计的基石。通过这个练习，你将深入思考数学公式如何保证在单个单元层面上的守恒性，并理解为何 DG 方法天生就具备这种重要的物理特性。[@problem_id:2385273]", "problem": "考虑有界域 $\\Omega \\subset \\mathbb{R}^d$ 上的标量守恒律 $u_t + \\nabla \\cdot \\boldsymbol{f}(u) = 0$，并在 $\\partial \\Omega$ 上给定适当的边界数据。设 $\\Omega$ 被剖分为无重叠单元 $\\{K\\}$，这些单元构成一个协调网格。通过在每个单元 $K$ 上的分片多项式空间中求解 $u_h$，将守恒律乘以支集在 $K$ 上的检验函数 $v_h$，在 $K$ 上积分，并在 $K$ 上应用分部积分，来构造间断 Galerkin (DG) 半离散格式。每个面上的边界通量积分被一个单值数值通量所取代。在由两个单元共享的内部面上，使用一个数值通量函数 $\\widehat{\\boldsymbol{f}}_i(u_h^-, u_h^+, \\boldsymbol{n}^-)$，该函数依赖于来自两个相邻单元的迹以及当前单元的单位外法向量 $\\boldsymbol{n}^-$。在边界面上，假设使用一个可能不同的通量函数 $\\widehat{\\boldsymbol{f}}_b(u_h, \\boldsymbol{n}, \\text{BC})$，它依赖于内部迹 $u_h$、单位外法向量 $\\boldsymbol{n}$ 和边界条件数据，且不要求 $\\widehat{\\boldsymbol{f}}_b$ 与应用于边界状态的 $\\widehat{\\boldsymbol{f}}_i$ 相一致。\n\n从第一性原理出发，单元 $K$ 上的局部守恒指的是这样一个陈述：$u_h$ 在 $K$ 上的单元平均值的时间变化率等于通过 $\\partial K$ 的净数值通量（符号由 $K$ 的外法向量决定）。具体来说，它问的是该半离散格式是否意味着存在以下形式的精确平衡：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_K u_h \\,\\mathrm{d}\\boldsymbol{x} + \\int_{\\partial K} \\widehat{\\boldsymbol{f}}(u_h) \\cdot \\boldsymbol{n} \\,\\mathrm{d}s = 0,\n$$\n其中 $\\widehat{\\boldsymbol{f}}$ 是在 $\\partial K$ 的每个面上的某个单值数值通量。\n\n假设在每个内部面上，相邻的两个单元都一致地使用一个单一的数值通量值 $\\widehat{\\boldsymbol{f}}_i(u_h^-, u_h^+, \\boldsymbol{n}^-)$（法向量相反），而在边界面上则使用一个可能不同的函数 $\\widehat{\\boldsymbol{f}}_b$。没有源项。\n\n当边界通量积分用 $\\widehat{\\boldsymbol{f}}_b \\neq \\widehat{\\boldsymbol{f}}_i$ 计算时，以下哪个陈述最能描述局部守恒的情况？\n\nA. 每个单元 $K$ 上的局部守恒都被精确保持；单元平均值的演化与 $\\partial K$ 上的单值数值通量之和相平衡，其中内部面使用 $\\widehat{\\boldsymbol{f}}_i$ 而边界面使用 $\\widehat{\\boldsymbol{f}}_b$。内部面的抵消是全局守恒的基础，而全局守恒不受使用不同 $\\widehat{\\boldsymbol{f}}_b$ 的影响。\n\nB. 在与 $\\partial \\Omega$ 相邻的单元上，局部守恒被破坏，因为使用 $\\widehat{\\boldsymbol{f}}_b \\neq \\widehat{\\boldsymbol{f}}_i$ 会在同一个边界面上产生两个不同的通量值，从而妨碍了守恒平衡。\n\nC. 除非 $\\widehat{\\boldsymbol{f}}_b$ 与 $\\widehat{\\boldsymbol{f}}_i$ 一致，否则局部守恒和全局守恒都会失效；否则，即使在单元平均的意义上，该格式也不可能是守恒的。\n\nD. 局部守恒在内部单元上成立，但在邻近边界的单元上失效，因为当 $\\widehat{\\boldsymbol{f}}_b \\neq \\widehat{\\boldsymbol{f}}_i$ 时，单元平均值更新包含一个无法写成边界通量的额外残差。", "solution": "问题陈述经过验证。\n\n### 步骤 1：提取已知条件\n-   **控制方程**: 标量守恒律 $u_t + \\nabla \\cdot \\boldsymbol{f}(u) = 0$ 在有界域 $\\Omega \\subset \\mathbb{R}^d$ 上。\n-   **离散化**: 域 $\\Omega$ 被剖分为协调网格的无重叠单元 $\\{K\\}$。\n-   **近似空间**: 解 $u_h$ 在每个单元 $K$ 上的分片多项式空间中求解。\n-   **弱形式**: DG 半离散化通过将偏微分方程乘以一个来自相同多项式空间的检验函数 $v_h$，在一个单元 $K$ 上积分，并应用分部积分得到。\n-   **内部数值通量**: 在两个单元共享的内部面上，使用一个单值数值通量函数 $\\widehat{\\boldsymbol{f}}_i(u_h^-, u_h^+, \\boldsymbol{n}^-)$。相邻的两个单元一致地使用此通量。\n-   **边界数值通量**: 在边界面上，使用一个可能不同的数值通量函数 $\\widehat{\\boldsymbol{f}}_b(u_h, \\boldsymbol{n}, \\text{BC})$。\n-   **研究的条件**: 边界通量函数与内部通量函数不相同的情况，即 $\\widehat{\\boldsymbol{f}}_b \\neq \\widehat{\\boldsymbol{f}}_i$。\n-   **局部守恒的定义**: 如果以下精确平衡成立，则称一个格式在单元 $K$ 上满足局部守恒：\n    $$\n    \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_K u_h \\,\\mathrm{d}\\boldsymbol{x} + \\int_{\\partial K} \\widehat{\\boldsymbol{f}}(u_h) \\cdot \\boldsymbol{n} \\,\\mathrm{d}s = 0,\n    $$\n    其中 $\\widehat{\\boldsymbol{f}}$ 是在单元边界 $\\partial K$ 的每个面上的一个单值数值通量。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**: 该问题在双曲守恒律的间断 Galerkin 方法的已建立理论框架内被正确地提出，这是数值分析和计算工程中的一个标准课题。所有概念在科学上都是合理的。\n-   **适定性**: 该问题具体且可通过 DG 方法的原理直接推导来回答。它询问了数值格式中一个明确定义的特定选择所带来的后果。\n-   **客观性**: 该问题使用精确、客观和标准的数学术语进行陈述。\n-   **缺陷评估**: 问题设定是自洽、一致的，并且没有科学谬误或歧义。条件 $\\widehat{\\boldsymbol{f}}_b \\neq \\widehat{\\boldsymbol{f}}_i$ 是 DG 格式实现中的一个有效场景，不构成矛盾。\n\n### 步骤 3：结论与行动\n问题陈述是 **有效的**。将推导解答。\n\n### 推导\n对于守恒律 $u_t + \\nabla \\cdot \\boldsymbol{f}(u) = 0$，其在单元 $K$ 上的间断 Galerkin (DG) 半离散格式为：寻找 $u_h$ 在近似空间 $V_h(K)$ 中，使得对于所有检验函数 $v_h \\in V_h(K)$，\n$$\n\\int_K \\frac{\\partial u_h}{\\partial t} v_h \\, \\mathrm{d}\\boldsymbol{x} + \\int_K (\\nabla \\cdot \\boldsymbol{f}(u_h)) v_h \\, \\mathrm{d}\\boldsymbol{x} = 0.\n$$\n对第二项应用分部积分（散度定理），得到：\n$$\n\\int_K \\frac{\\partial u_h}{\\partial t} v_h \\, \\mathrm{d}\\boldsymbol{x} - \\int_K \\boldsymbol{f}(u_h) \\cdot \\nabla v_h \\, \\mathrm{d}\\boldsymbol{x} + \\int_{\\partial K} \\boldsymbol{f}(u_h) \\cdot \\boldsymbol{n} \\, v_h \\, \\mathrm{d}s = 0.\n$$\n在 DG 方法中，边界通量 $\\boldsymbol{f}(u_h) \\cdot \\boldsymbol{n}$ 被替换为数值通量 $\\widehat{\\boldsymbol{f}} \\cdot \\boldsymbol{n}$，它在每个面上是单值的。该格式变为：\n$$\n\\int_K \\frac{\\partial u_h}{\\partial t} v_h \\, \\mathrm{d}\\boldsymbol{x} - \\int_K \\boldsymbol{f}(u_h) \\cdot \\nabla v_h \\, \\mathrm{d}\\boldsymbol{x} + \\int_{\\partial K} (\\widehat{\\boldsymbol{f}} \\cdot \\boldsymbol{n}) v_h \\, \\mathrm{d}s = 0.\n$$\n此处，在任意面 $e \\subset \\partial K$ 上，通量 $\\widehat{\\boldsymbol{f}}$ 对于内部面指定为 $\\widehat{\\boldsymbol{f}}_i$，对于边界面指定为 $\\widehat{\\boldsymbol{f}}_b$。\n\n局部守恒，如问题中所定义，关系到 $u_h$ 单元平均值的演化。单元平均值为 $\\bar{u}_K(t) = \\frac{1}{|K|} \\int_K u_h(\\boldsymbol{x},t) \\, \\mathrm{d}\\boldsymbol{x}$，其中 $|K|$ 是单元 $K$ 的测度（面积或体积）。为了获得 $\\int_K u_h \\, \\mathrm{d}\\boldsymbol{x}$ 的演化方程，我们选择一个特定的检验函数，$v_h(\\boldsymbol{x}) = 1$ 对于所有 $\\boldsymbol{x} \\in K$。这是一个有效的选择，因为假定多项式近似空间包含常数（即次数 $k \\geq 0$ 的多项式）。\n\n将 $v_h = 1$ 代入 DG 弱形式：\n1.  第一项变为 $\\int_K \\frac{\\partial u_h}{\\partial t} \\cdot 1 \\, \\mathrm{d}\\boldsymbol{x} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_K u_h \\, \\mathrm{d}\\boldsymbol{x}$。\n2.  第二项涉及 $\\nabla v_h = \\nabla(1) = \\boldsymbol{0}$，因此 $\\int_K \\boldsymbol{f}(u_h) \\cdot \\boldsymbol{0} \\, \\mathrm{d}\\boldsymbol{x} = 0$。\n3.  第三项变为 $\\int_{\\partial K} (\\widehat{\\boldsymbol{f}} \\cdot \\boldsymbol{n}) \\cdot 1 \\, \\mathrm{d}s$。\n\n弱形式因此简化为：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_K u_h \\, \\mathrm{d}\\boldsymbol{x} - 0 + \\int_{\\partial K} \\widehat{\\boldsymbol{f}} \\cdot \\boldsymbol{n} \\, \\mathrm{d}s = 0,\n$$\n这正是问题中给出的局部守恒的陈述：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_K u_h \\, \\mathrm{d}\\boldsymbol{x} + \\int_{\\partial K} \\widehat{\\boldsymbol{f}} \\cdot \\boldsymbol{n} \\, \\mathrm{d}s = 0.\n$$\n这个推导对 **任何** 单元 $K$ 都有效，无论它是在域 $\\Omega$ 的内部还是与边界 $\\partial\\Omega$ 相邻。它是用常数函数检验 DG 格式的直接结果。结果表明，单元 $K$ 中物理量 $u_h$ 总量的时间变化率与通过其边界 $\\partial K$ 的总数值通量精确平衡。这个性质是 DG 格式构造中所固有的。数值通量 $\\widehat{\\boldsymbol{f}}_i$ 和 $\\widehat{\\boldsymbol{f}}_b$ 的具体函数形式以及条件 $\\widehat{\\boldsymbol{f}}_b \\neq \\widehat{\\boldsymbol{f}}_i$ 不会改变这个基本平衡。\n\n### 逐项分析\n\n**A. 每个单元 K 上的局部守恒都被精确保持；单元平均值的演化与 $\\partial K$ 上的单值数值通量之和相平衡，其中内部面使用 $\\widehat{\\boldsymbol{f}}_i$ 而边界面使用 $\\widehat{\\boldsymbol{f}}_b$。内部面的抵消是全局守恒的基础，而全局守恒不受使用不同 $\\widehat{\\boldsymbol{f}}_b$ 的影响。**\n该陈述是正确的。我们的推导表明，局部守恒在每个单元 $K$ 上都精确成立。单元平均值的演化与净数值通量相平衡，其中通量在各自的面上使用 $\\widehat{\\boldsymbol{f}}_i$ 和 $\\widehat{\\boldsymbol{f}}_b$ 计算。全局守恒是通过对所有单元 $K$ 上的局部守恒律求和得到的。内部通量 $\\widehat{\\boldsymbol{f}}_i$ 的一致性确保了所有内部面上的通量贡献相互抵消，只留下在域边界 $\\partial\\Omega$ 上的通量之和。这种结构与 $\\widehat{\\boldsymbol{f}}_b$ 的选择无关，后者仅仅定义了通过 $\\partial\\Omega$ 的通量。\n**结论：正确。**\n\n**B. 在与 $\\partial \\Omega$ 相邻的单元上，局部守恒被破坏，因为使用 $\\widehat{\\boldsymbol{f}}_b \\neq \\widehat{\\boldsymbol{f}}_i$ 会在同一个边界面上产生两个不同的通量值，从而妨碍了守恒平衡。**\n该陈述不正确。如推导所示，局部守恒对*所有*单元都成立，包括与边界相邻的单元。所提供的理由是错误的。一个边界面只与域内的一个单元相邻。在那个面上没有第二个相互竞争的通量值。该通量由 $\\widehat{\\boldsymbol{f}}_b$ 唯一确定。条件 $\\widehat{\\boldsymbol{f}}_b \\neq \\widehat{\\boldsymbol{f}}_i$ 只意味着对不同类型的面使用不同的函数，而不是在一个面上有两个值。\n**结论：不正确。**\n\n**C. 除非 $\\widehat{\\boldsymbol{f}}_b$ 与 $\\widehat{\\boldsymbol{f}}_i$ 一致，否则局部守恒和全局守恒都会失效；否则，即使在单元平均的意义上，该格式也不可能是守恒的。**\n该陈述不正确。局部守恒的成立与 $\\widehat{\\boldsymbol{f}}_b$ 和 $\\widehat{\\boldsymbol{f}}_i$ 之间的关系无关。全局守恒也成立，因为它依赖于内部通量的抵消，这仅仅是 $\\widehat{\\boldsymbol{f}}_i$ 的一个性质。条件 $\\widehat{\\boldsymbol{f}}_b = \\widehat{\\boldsymbol{f}}_i$（应用于边界的某个虚拟状态）是一种一致性形式，但它不是单元平均意义下守恒性的先决条件。\n**结论：不正确。**\n\n**D. 局部守恒在内部单元上成立，但在邻近边界的单元上失效，因为当 $\\widehat{\\boldsymbol{f}}_b \\neq \\widehat{\\boldsymbol{f}}_i$ 时，单元平均值更新包含一个无法写成边界通量的额外残差。**\n该陈述不正确。它正确地陈述了局部守恒在内部单元上成立，但错误地声称它在邻近边界的单元上失效。我们的推导表明它在所有单元上都成立。其理由也是有缺陷的；从 $v_h=1$ 的弱形式推导出的单元平均值更新不包含“额外的残差”。如推导所示，整个平衡是在单元平均值的时间导数和边界上数值通量的积分之间。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2385273"}, {"introduction": "在理解了守恒的概念之后，本次实践将采用一种“通过破坏来学习”的方法。你将实现一个特意设计的非守恒格式，亲眼见证在单元交界面上破坏通量一致性所带来的后果。这个编程练习将抽象的守恒原理与数值模拟的具体行为联系起来，直观地展示了“质量”是如何在计算中被凭空创造或销毁的。[@problem_id:2385236]", "problem": "考虑一维空间中的标量守恒律，\n$$\n\\partial_t u(x,t) + \\partial_x f\\big(u(x,t)\\big) = 0,\n$$\n该方程定义在周期为$L$的周期性区域$[0,L]$上。设物理通量为$f(u)=a\\,u$，其中平流速度$a>0$为常数。将区域离散为$N$个宽度为$h=L/N$的均匀单元，并通过分段常数的单元平均值来近似$u$。使用以下初始条件\n$$\nu(x,0) = 1 + 0.2 \\sin\\!\\big(2\\pi x/L\\big),\n$$\n其中角度以弧度为单位。使用显式前向欧拉时间积分器，将单元平均值从$t=0$演化到$t=T$，在每个左右迹分别为$u_L$和$u_R$的单元间界面上，使用以下有意设计的非守恒界面通量对：\n$$\n\\widehat{F}^{-}(u_L,u_R) = a\\,u_L - \\varepsilon,\\qquad\n\\widehat{F}^{+}(u_L,u_R) = a\\,u_L + \\varepsilon,\n$$\n其中 $\\varepsilon$ 是一个实参数。仅在单元的右侧界面（即当前单元为左状态的界面）上使用$\\widehat{F}^{-}$，仅在单元的左侧界面（即当前单元为右状态的界面）上使用$\\widehat{F}^{+}$。根据这些定义，对于采用周期性索引的单元$i$，其半离散更新公式为\n$$\n\\frac{d}{dt}\\,\\bar{u}_i(t) \\;=\\; -\\frac{1}{h}\\left[\\,\\widehat{F}^{-}\\big(\\bar{u}_i,\\bar{u}_{i+1}\\big)\\;-\\;\\widehat{F}^{+}\\big(\\bar{u}_{i-1},\\bar{u}_i\\big)\\,\\right],\n$$\n且前向欧拉步进为\n$$\n\\bar{u}_i^{n+1} \\;=\\; \\bar{u}_i^{n} \\;-\\; \\frac{\\Delta t}{h}\\left[\\,\\widehat{F}^{-}\\big(\\bar{u}_i^{n},\\bar{u}_{i+1}^{n}\\big)\\;-\\;\\widehat{F}^{+}\\big(\\bar{u}_{i-1}^{n},\\bar{u}_i^{n}\\big)\\,\\right].\n$$\n根据Courant–Friedrichs–Lewy (CFL)条件选择时间步长，其中$\\mathrm{CFL}\\in(0,1]$是用户指定的常数：\n$$\n\\Delta t \\le \\mathrm{CFL}\\,\\frac{h}{a}.\n$$\n将$t^n$时刻的离散总质量定义为\n$$\nM^n = \\sum_{i=0}^{N-1} \\bar{u}_i^{n}\\,h,\n$$\n并将$[0,T]$区间上测得的质量生成率定义为以下时间平均量\n$$\nR = \\frac{M^N - M^0}{T}.\n$$\n实现上述过程，并针对每个测试用例，将测得的速率$R$以浮点数形式输出。\n\n使用以下固定参数：$L=1$，$a=1$，$T=0.2$以及$\\mathrm{CFL}=0.9$。待运行的测试套件包含以下四个$(N,\\varepsilon)$对：\n- $(20,\\,0.05)$，\n- $(20,\\,-0.05)$，\n- $(50,\\,0.01)$，\n- $(37,\\,0.0)$。\n\n你的程序应生成单行输出，其中包含与这些测试用例相对应的四个测量速率，格式为一个由方括号括起来的逗号分隔列表（例如，“[r1,r2,r3,r4]”），每个条目都是一个浮点数。", "solution": "我们已对问题陈述进行了严格审查，并确定其是有效的。它提出了一个在计算工程学中适定的数值实验，旨在研究一个用于标量守恒律的有意非守恒有限体积格式的性质。该问题具有科学依据，是客观的，并包含所有必要信息以得出唯一且有意义的解。关于达到最终时间$T$的确切时间步进程序的微小模糊之处，是数值实现中常见的细节，我们将采用一种标准的、严谨的方法。符号$M^N$被解释为最终时刻质量$M(T)$的笔误。\n\n问题的核心是量化由非守恒数值通量引起的质量生成或湮灭。在进行数值实现之前，必须先进行理论分析。\n\n让我们分析为单元平均值$\\bar{u}_i$提供的半离散格式：\n$$\n\\frac{d}{dt}\\,\\bar{u}_i(t) \\;=\\; -\\frac{1}{h}\\left[\\,\\widehat{F}^{-}\\big(\\bar{u}_i,\\bar{u}_{i+1}\\big)\\;-\\;\\widehat{F}^{+}\\big(\\bar{u}_{i-1},\\bar{u}_i\\big)\\,\\right]\n$$\n数值通量定义为$\\widehat{F}^{-}(u_L,u_R) = a\\,u_L - \\varepsilon$和$\\widehat{F}^{+}(u_L,u_R) = a\\,u_L + \\varepsilon$。单元$i$右侧界面（界面$i+1/2$）的通量使用左状态$\\bar{u}_i$和右状态$\\bar{u}_{i+1}$。单元$i$左侧界面（界面$i-1/2$）的通量使用左状态$\\bar{u}_{i-1}$和右状态$\\bar{u}_i$。\n代入具体的通量定义：\n- 右侧界面$i+1/2$的通量为$\\widehat{F}^{-}\\big(\\bar{u}_i,\\bar{u}_{i+1}\\big) = a\\,\\bar{u}_i - \\varepsilon$。\n- 左侧界面$i-1/2$的通量为$\\widehat{F}^{+}\\big(\\bar{u}_{i-1},\\bar{u}_i\\big) = a\\,\\bar{u}_{i-1} + \\varepsilon$。\n\n单元 $i$ 的半离散方程变为：\n$$\n\\frac{d}{dt}\\,\\bar{u}_i(t) \\;=\\; -\\frac{1}{h}\\left[ (a\\,\\bar{u}_i - \\varepsilon) - (a\\,\\bar{u}_{i-1} + \\varepsilon) \\right] \\;=\\; -\\frac{a}{h}(\\bar{u}_i - \\bar{u}_{i-1}) + \\frac{2\\varepsilon}{h}\n$$\n这表明该格式等效于对平流项$\\partial_x f(u) = a \\partial_x u$的标准一阶迎风离散（因为$a>0$，迎风信息来自单元$i-1$），并附加了一个大小为$\\frac{2\\varepsilon}{h}$的恒定源项。\n\n主要任务是求出总质量$M(t) = \\sum_{i=0}^{N-1} \\bar{u}_i(t)\\,h$的变化率。让我们计算其时间导数：\n$$\n\\frac{dM}{dt} = \\frac{d}{dt} \\sum_{i=0}^{N-1} \\bar{u}_i(t)\\,h = h \\sum_{i=0}^{N-1} \\frac{d\\bar{u}_i}{dt}\n$$\n代入$\\frac{d\\bar{u}_i}{dt}$的表达式：\n$$\n\\frac{dM}{dt} = h \\sum_{i=0}^{N-1} \\left( -\\frac{a}{h}(\\bar{u}_i - \\bar{u}_{i-1}) + \\frac{2\\varepsilon}{h} \\right) = -a \\sum_{i=0}^{N-1} (\\bar{u}_i - \\bar{u}_{i-1}) + \\sum_{i=0}^{N-1} 2\\varepsilon\n$$\n第一个求和项$\\sum_{i=0}^{N-1} (\\bar{u}_i - \\bar{u}_{i-1})$是一个伸缩级数。由于周期性边界条件（即$\\bar{u}_{-1} = \\bar{u}_{N-1}$），该和恒为零。\n第二个求和项是对$N$个相同项的求和：$\\sum_{i=0}^{N-1} 2\\varepsilon = 2N\\varepsilon$。\n因此，总质量的变化率是恒定的，由下式给出：\n$$\n\\frac{dM}{dt} = 2N\\varepsilon\n$$\n这是一个有力的解析结果。它表明系统的质量随时间线性变化。从$t=0$到$t=T$积分得到：\n$$\nM(T) - M(0) = \\int_0^T (2N\\varepsilon) \\, dt = 2N\\varepsilon T\n$$\n问题将测得的质量生成率$R$定义为$R = \\frac{M(T) - M(0)}{T}$。根据我们的推导，这给出了一个简单、精确的表达式：\n$$\nR = \\frac{2N\\varepsilon T}{T} = 2N\\varepsilon\n$$\n该结果与初始数据、平流速度$a$、单元宽度$h$（只要$N$固定）、CFL数以及时间积分格式的细节无关，前提是该格式能正确地对恒定源项进行积分。因此，数值模拟是对这一理论结果的验证。\n\n实现的算法如下：\n1.  对每个具有参数$(N, \\varepsilon)$的测试用例，设置全局参数$L=1$，$a=1$，$T=0.2$和$\\mathrm{CFL}=0.9$。\n2.  定义空间网格。区域$[0,L]$被划分为$N$个单元。单元$i$覆盖区间$[i h, (i+1)h]$，其中$h=L/N$。\n3.  计算初始单元平均值$\\bar{u}_i(0)$。这需要对初始条件$u(x,0) = 1 + 0.2 \\sin(2\\pi x/L)$在每个单元上积分：\n    $$\n    \\bar{u}_i(0) = \\frac{1}{h} \\int_{ih}^{(i+1)h} \\left(1 + 0.2 \\sin\\left(\\frac{2\\pi x}{L}\\right)\\right) dx = 1 - \\frac{0.2 L}{2\\pi h} \\left[ \\cos\\left(\\frac{2\\pi(i+1)h}{L}\\right) - \\cos\\left(\\frac{2\\pi ih}{L}\\right) \\right]\n    $$\n4.  计算初始总质量$M^0 = h \\sum_{i=0}^{N-1} \\bar{u}_i(0)$。\n5.  设置时间步长$\\Delta t = \\mathrm{CFL} \\frac{h}{a}$。\n6.  将解从$t=0$演化到$t=T$。尽可能多地使用固定的时间步长$\\Delta t$。采用一个最终的、较小的步长以精确到达$t=T$。`Forward Euler`更新为：\n    $$\n    \\bar{u}_i^{n+1} = \\bar{u}_i^{n} + \\Delta t \\left( -\\frac{a}{h}(\\bar{u}_i^n - \\bar{u}_{i-1}^n) + \\frac{2\\varepsilon}{h} \\right)\n    $$\n    这在每个时间步中应用，并遵守周期性边界条件$\\bar{u}_{-1}^n = \\bar{u}_{N-1}^n$。该更新可以被高效地向量化。\n7.  演化到$t=T$后，计算最终总质量$M^T = h \\sum_{i=0}^{N-1} \\bar{u}_i(T)$。\n8.  计算测得的质量生成率$R = \\frac{M^T - M^0}{T}$。\n9.  收集所有测试用例的结果并按指定格式打印。预期数值结果将在浮点精度范围内与解析预测$R=2N\\varepsilon$相匹配。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the given problem for a set of test cases.\n    It simulates a 1D linear advection equation with a non-conservative\n    numerical scheme and calculates the rate of mass creation.\n    \"\"\"\n\n    # Define fixed parameters from the problem statement.\n    L = 1.0\n    a = 1.0\n    T = 0.2\n    CFL = 0.9\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (20, 0.05),\n        (20, -0.05),\n        (50, 0.01),\n        (37, 0.0),\n    ]\n\n    results = []\n    for N, epsilon in test_cases:\n        # 1. Discretization parameters\n        h = L / N\n        dt = CFL * h / a\n\n        # 2. Initial condition: cell averages\n        # u(x,0) = 1 + 0.2 * sin(2*pi*x/L)\n        # We need the integral of u(x,0) over each cell.\n        # The antiderivative of u(x,0) is x - 0.2 * (L/(2*pi)) * cos(2*pi*x/L)\n        x_boundaries = np.linspace(0.0, L, N + 1)\n        \n        # Vectorized calculation of initial cell averages\n        # integral_u(x) = x - (0.2*L/(2*pi)) * cos(2*pi*x/L)\n        antiderivative_vals = x_boundaries - 0.2 * (L / (2.0 * np.pi)) * np.cos(2.0 * np.pi * x_boundaries / L)\n        # The integral over cell i is integral_u(x_{i+1}) - integral_u(x_i)\n        u0 = np.diff(antiderivative_vals) / h\n        \n        # 3. Initial mass calculation\n        M0 = np.sum(u0) * h\n\n        # 4. Time evolution using Forward Euler\n        u = u0.copy()\n        current_time = 0.0\n\n        num_steps = int(T / dt)\n        \n        # Vectorized update terms\n        advection_coeff = -a / h\n        source_term = 2.0 * epsilon / h\n\n        # Main time loop for full steps\n        for _ in range(num_steps):\n            u_prev = np.roll(u, 1)\n            dudt = advection_coeff * (u - u_prev) + source_term\n            u += dt * dudt\n            current_time += dt\n\n        # Take one final partial step to reach T exactly\n        last_dt = T - current_time\n        if last_dt > 1e-12: # Tolerance for floating point inaccuracy\n            u_prev = np.roll(u, 1)\n            dudt = advection_coeff * (u - u_prev) + source_term\n            u += last_dt * dudt\n\n        # 5. Final mass calculation\n        M_final = np.sum(u) * h\n\n        # 6. Measured mass-creation rate\n        R = (M_final - M0) / T\n        results.append(R)\n\n    # Final print statement in the exact required format.\n    # The format specifier ensures standard float representation.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "2385236"}, {"introduction": "虽然守恒性至关重要，但高阶方法在处理带有尖锐梯度或间断的复杂问题时，会面临另一个挑战：伪振荡。本练习通过一个关于斜率限制器的思想实验来应对这一挑战。通过对比标准的 $\\mathrm{minmod}$ 限制器和一个假设的 $\\mathrm{maxmod}$ 函数，你将探索非线性稳定性的核心原则，并理解为何限制器的设计必须旨在控制而非放大解的梯度。[@problem_id:2385285]", "problem": "考虑一维标量守恒律 $u_t + f(u)_x = 0$，其定义在周期性区域 $x \\in [0,1]$ 上，使用包含 $N$ 个单元的均匀网格，单元大小为 $h = 1/N$，平流速度为常数 $a > 0$，并采用与 $f(u) = a u$ 一致的迎风数值通量。该问题采用分片线性间断伽辽金(DG)方法进行离散，并在每个单元内进行线性重构。为控制伪振荡，对每个单元 $i$ 应用斜率限制器，将原始DG斜率 $\\sigma_i^{\\mathrm{raw}}$ 替换为受限斜率 $\\sigma_i = \\phi(v_1,v_2,v_3)$。该斜率由三个参数 $v_1 = \\theta \\,(u_i - u_{i-1})/h$、$v_2 = \\frac{1}{2}\\,(u_{i+1} - u_{i-1})/h$ 和 $v_3 = \\theta \\,(u_{i+1} - u_i)/h$ 构造而成，其中 $\\theta \\in [1,2]$，$u_i$ 表示单元 $i$ 上的单元平均值。该限制器函数是经典的 $\\mathrm{minmod}$ 函数\n$$\n\\mathrm{minmod}(v_1,v_2,v_3) = \n\\begin{cases}\n\\mathrm{sign}(v_1)\\,\\min\\{|v_1|,|v_2|,|v_3|\\}, & \\text{若 } \\mathrm{sign}(v_1) = \\mathrm{sign}(v_2) = \\mathrm{sign}(v_3),\\\\\n0, & \\text{其他情况},\n\\end{cases}\n$$\n已知在 Courant–Friedrichs–Lewy (CFL) 条件下，配合强稳定性保持(SSP)时间步进方法，该函数能保证单调性并使全变分有界。\n\n现假设将限制器修改，用 $\\mathrm{maxmod}$ 函数替换 $\\mathrm{minmod}$ 函数\n$$\n\\mathrm{maxmod}(v_1,v_2,v_3) = \n\\begin{cases}\n\\mathrm{sign}(v_1)\\,\\max\\{|v_1|,|v_2|,|v_3|\\}, & \\text{若 } \\mathrm{sign}(v_1) = \\mathrm{sign}(v_2) = \\mathrm{sign}(v_3),\\\\\n0, & \\text{其他情况}.\n\\end{cases}\n$$\n假设采用二阶强稳定性保持龙格-库塔方法进行显式时间积分，时间步长 $\\Delta t$ 满足标准CFL条件 $a\\,\\Delta t/h \\le 1$。\n\n在保持所有其他组件不变的情况下，对于间断数据（例如方波初始条件），使用 $\\mathrm{maxmod}$ 代替 $\\mathrm{minmod}$ 对DG方法的非线性稳定性有何影响？以下哪个陈述最能描述这种影响？\n\nA. 限制器变得具有反耗散性：即使在满足CFL条件的时间步长下，全变分仍随时间增加，导致间断附近的吉布斯型振荡不断增长、出现违反极值原理的上冲/下冲，并可能在 $L^\\infty$ 范数下发生爆破。\n\nB. 该方法保持全变分递减(TVD)性质，但与 $\\mathrm{minmod}$ 相比，能产生更陡峭、无振荡的激波，并显著减少数值耗散。\n\nC. 该方法变得更具耗散性但无条件稳定，实际上处处退化为一阶精度并抑制了振荡。\n\nD. 对于所有满足 $a\\,\\Delta t/h \\le 1$ 的CFL数，该方法在 $L^2$ 范数下保持线性稳定，仅表现出良性的相位误差，在间断附近没有伪振荡的增长。", "solution": "问题描述了一种用于标量线性平流方程 $u_t + (au)_x = 0$ 的分片线性间断伽辽金(DG)方法。问题的核心在于将一个标准的保单调性斜率限制器，即 $\\mathrm{minmod}$ 函数，替换为一个非标准的 $\\mathrm{maxmod}$ 函数。我们必须分析此修改对数值格式非线性稳定性的影响。\n\n让我们首先对问题陈述进行形式化验证。\n\n**步骤1：提取已知条件**\n- 守恒律: $u_t + f(u)_x = 0$\n- 区域: 周期性, $x \\in [0,1]$\n- 网格: 均匀，含 $N$ 个单元，大小为 $h = 1/N$\n- 通量函数: $f(u) = a u$，平流速度为常数 $a > 0$\n- 空间离散: 分片线性间断伽辽金(DG)方法\n- 数值通量: 迎风\n- 斜率限制器修改: 每个单元 $i$ 中的原始DG斜率 $\\sigma_i^{\\mathrm{raw}}$ 被替换为受限斜率 $\\sigma_i = \\phi(v_1, v_2, v_3)$。\n- 限制器输入: $v_1 = \\theta \\,(u_i - u_{i-1})/h$, $v_2 = \\frac{1}{2}\\,(u_{i+1} - u_{i-1})/h$, 以及 $v_3 = \\theta \\,(u_{i+1} - u_i)/h$，其中 $u_i$ 是单元 $i$ 中的单元平均值，$\\theta \\in [1,2]$。\n- 标准限制器: $\\phi = \\mathrm{minmod}$，定义为\n$$\n\\mathrm{minmod}(v_1,v_2,v_3) = \n\\begin{cases}\n\\mathrm{sign}(v_1)\\,\\min\\{|v_1|,|v_2|,|v_3|\\}, & \\text{若 } \\mathrm{sign}(v_1) = \\mathrm{sign}(v_2) = \\mathrm{sign}(v_3),\\\\\n0, & \\text{其他情况}.\n\\end{cases}\n$$\n- 修改后的限制器: $\\phi = \\mathrm{maxmod}$，定义为\n$$\n\\mathrm{maxmod}(v_1,v_2,v_3) = \n\\begin{cases}\n\\mathrm{sign}(v_1)\\,\\max\\{|v_1|,|v_2|,|v_3|\\}, & \\text{若 } \\mathrm{sign}(v_1) = \\mathrm{sign}(v_2) = \\mathrm{sign}(v_3),\\\\\n0, & \\text{其他情况}.\n\\end{cases}\n$$\n- 时间积分: 二阶强稳定性保持龙格-库塔方法(SSP-RK2)，时间步长 $\\Delta t$ 满足CFL条件 $a\\,\\Delta t/h \\le 1$。\n- 问题: 描述使用 $\\mathrm{maxmod}$ 代替 $\\mathrm{minmod}$ 对间断初始数据的非线性稳定性的影响。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在偏微分方程数值方法领域，特别是在双曲守恒律方面，是良定义的。DG方法、斜率限制、全变分递减(TVD)性质、SSP时间积分器和CFL条件等概念都是标准概念。限制器的输入 $v_1$、$v_2$ 和 $v_3$ 分别代表解的空间导数的后向、中心和前向差分近似，这些是有限体积和DG方法中限制器的常用组成部分。函数 $\\mathrm{minmod}$ 和 $\\mathrm{maxmod}$ 在数学上是精确的。问题要求分析对算法进行特定、良定义的修改后所产生的稳定性。该问题具有科学依据，是适定的、客观的。它不包含进行定性分析所需的任何矛盾或缺失信息。\n\n**步骤3：结论与行动**\n问题陈述有效。我将继续推导解答。\n\n**解答推导**\n\n在用于守恒律的高阶格式（如二阶DG）中，斜率限制器的目的是通过防止在间断附近形成伪振荡来强制实现非线性稳定性。这通常通过使格式保持单调性来实现。如果一个格式在时间 $t^n$ 的离散解是单调的，而在时间 $t^{n+1}$ 的解也保持单调，则该格式是保单调的。对于标量问题，该性质意味着解的全变分(TV)不增加，即该格式是TVD的。\n$TV(u) = \\sum_i |u_{i+1} - u_i|$。\n\n在单元 $i$ 内的重构是一个线性多项式：$u_h(x) = u_i + \\sigma_i \\frac{x-x_i}{h}$。为了保持单调性，该多项式在单元边界 $x_{i \\pm 1/2}$ 处的值不能产生新的局部极值。这意味着边界值必须被相邻单元的单元平均值所限制。例如，在右侧单元边界 $x_{i+1/2}$，从单元 $i$ 内部重构的值 $u_h(x_{i+1/2}^-) = u_i + \\sigma_i h/2$ 必须位于 $u_i$ 和 $u_{i+1}$ 之间。\n\n让我们假设一个局部单调的剖面，例如 $u_{i-1} < u_i < u_{i+1}$。保单调性的约束要求：\n$u_{i-1} \\le u_i - \\sigma_i h/2$ 和 $u_i + \\sigma_i h/2 \\le u_{i+1}$。\n这些不等式给出了斜率 $\\sigma_i$ 的界限：\n$\\sigma_i \\le \\frac{u_i - u_{i-1}}{h/2}$ 和 $\\sigma_i \\le \\frac{u_{i+1} - u_i}{h/2}$。\n因此，斜率必须受限于 $2(u_i - u_{i-1})/h$ 和 $2(u_{i+1} - u_i)/h$。注意，当 $\\theta=2$ 时，限制器输入 $v_1$ 和 $v_3$ 正好对应这些界限。\n\n$\\mathrm{minmod}$ 限制器就是为了满足这些约束而设计的。当候选斜率（$v_1$、$v_2$、$v_3$）符号全部相同时（表示这是一个局部单调区域），$\\mathrm{minmod}$ 会选择其中绝对值最小的一个。这是一个保守的选择，它限制了重构的“陡峭度”，从而确保最终的格式是TVD的。这种限制作用会引入数值耗散，这是为防止振荡所付出的代价。\n\n现在，考虑修改后的限制器 $\\mathrm{maxmod}$。在解是单调的区域，且候选斜率 $v_1, v_2, v_3$ 非零且符号相同的情况下，$\\mathrm{maxmod}$ 会选择绝对值最大的斜率。这是一种“反限制”或“压缩性”行为。它不是通过限制斜率来防止上冲，而是在候选者中主动选择最陡峭的可能重构。\n\n这种选择几乎必然会违反保单调性的界限。通过选择最大斜率，单元边界处的重构值，例如 $u_i + \\sigma_i h/2$，极有可能超过相邻单元的平均值 $u_{i+1}$（或低于它）。这会在解中产生新的、虚假的局部极值。\n\n新极值的产生意味着该格式不保单调。因此，该格式不是TVD的；其全变分将随时间增加，$TV(u^{n+1}) > TV(u^n)$。全变分的增加表现为不断增长的振荡，尤其是在单元平均值差异较大的间断附近。这些振荡类似于吉布斯现象，但其振幅随时间增长，而不是被抑制。这种不受控制的增长是非线性不稳定的迹象。数值可能增长到超出初始数据的最大值和最小值（违反极值原理），并最终可能导致数值爆破，即解的幅度趋于无穷大。这种行为是反耗散格式的典型特征。\n\n使用SSP时间积分器和满足CFL条件的时间步长并不能弥补空间离散中的这一根本缺陷。SSP方法仅能保证保持那些对于相同空间算子、使用简单前向欧拉更新时已经成立的稳定性（如TVD性质）。如果空间算子本身是全变分增加的，SSP方法将忠实地再现这种不稳定性。\n\n**选项评估**\n\nA. **限制器变得具有反耗散性：即使在满足CFL条件的时间步长下，全变分仍随时间增加，导致间断附近的吉布斯型振荡不断增长、出现违反极值原理的上冲/下冲，并可能在 $L^\\infty$ 范数下发生爆破。**\n这个陈述准确地描述了使用 $\\mathrm{maxmod}$ 限制器的后果。选择最大绝对值斜率是一种反耗散行为，会导致违反单调性、全变分增加以及伪振荡的增长，最终可能导致解的爆破。**正确。**\n\nB. **该方法保持全变分递减(TVD)性质但能产生更陡峭、无振荡的激波，并显著减少数值耗散相比 `minmod`。**\n这是不正确的。该方法保持TVD性质的核心前提是错误的。`maxmod` 函数天生就违反了限制器成为TVD所需满足的条件。虽然它试图产生更陡峭的特征（通过反耗散或压缩性），但这会以引入严重的、不断增长的振荡为代价。**不正确。**\n\nC. **该方法变得更具耗散性但无条件稳定，实际上处处退化为一阶精度并抑制了振荡。**\n这个陈述描述了相反的行为。`maxmod` 限制器是反耗散的，而不是更具耗散性。一个更具耗散性的限制器会选择比`minmod`更小的斜率，或者干脆选择零（退化为一阶格式）。该方法是不稳定的，而非无条件稳定。**不正确。**\n\nD. **对于所有满足 $a\\,\\Delta t/h \\le 1$ 的CFL数，该方法在 $L^2$ 范数下保持线性稳定，仅表现出良性的相位误差，在间断附近没有伪振荡的增长。**\n这是不正确的。这里的主要问题是非线性稳定性，而这无法通过线性稳定性分析来捕捉。问题特别询问了间断数据的情况，此时非线性效应占主导地位。产生的振荡并非良性，也不仅仅是相位误差；它们是振幅增长和严重的非线性不稳定性的体现。**不正确。**", "answer": "$$\\boxed{A}$$", "id": "2385285"}]}