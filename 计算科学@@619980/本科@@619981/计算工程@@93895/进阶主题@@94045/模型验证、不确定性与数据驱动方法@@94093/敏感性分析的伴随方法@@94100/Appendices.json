{"hands_on_practices": [{"introduction": "在深入探讨数学细节之前，理解伴随方法为何如此强大至关重要。本练习从高层次比较了伴随方法与更直观的有限差分方法在计算成本上的差异。通过分析每种方法的工作量如何随设计参数数量的增加而扩展，你将揭示伴随方法的卓越效率，这也是其在​​大规模优化和设计问题中被广泛应用的首要原因 [@problem_id:2371119]。", "problem": "考虑常微分方程 (ODE) $\\dot{y}(t) = -p\\,y(t)$ 的初值问题，其中 $y(0)=1$，并在给定的终止时间 $T>0$ 定义标量目标 $J = y(T)$。您希望计算在给定参数值 $p$ 下的灵敏度 $\\dfrac{dJ}{dp}$。\n\n现在考虑一个更广的场景，其中模型状态是高维的，但目标函数仍然是 $J = \\psi(y(T))$ 形式的标量，并且参数推广为进入动力学系统的向量 $\\boldsymbol{p} \\in \\mathbb{R}^m$，其中 $m \\gg 1$。假设：\n- 在 $[0,T]$ 上对状态方程进行一次正向求解的计算成本与 $C_f$ 相当。\n- 在 $[0,T]$ 上对伴随方程进行一次反向求解的计算成本与 $C_f$ 相当。\n- 有限差分梯度是通过使用步长为 $h>0$ 的前向差分，一次扰动一个参数分量来形成的，且各分量之间不重用导数信息。\n- 忽略数值步长选择的问题，并假设所有求解的成本相当。\n\n在这种情况下，对于有限差分法与伴随方法，哪种陈述最能描述获得完整梯度 $\\dfrac{dJ}{d\\boldsymbol{p}} \\in \\mathbb{R}^m$ 的计算成本随 $m$ 变化的规律？\n\nA. 有限差分法需要 $m$ 量级的正向求解（对于中心差分则为 $2m$ 量级），而伴随方法需要大约一次正向求解和一次反向伴随求解，因此获得 $\\dfrac{dJ}{d\\boldsymbol{p}}$ 的总成本基本上与 $m$ 无关。\n\nB. 对于标量目标，有限差分法和伴随方法都需要 $m$ 量级的模型求解来获得 $\\dfrac{dJ}{d\\boldsymbol{p}}$。\n\nC. 由于基准求解的重用，有限差分法的成本基本上与 $m$ 无关，而伴随方法需要对每个参数进行单独的伴随求解，导致成本为 $m$ 量级。\n\nD. 两种方法的成本都与 $m$ 无关，因为当 $m \\gg 1$ 时，是状态维度而非参数数量主导了成本。", "solution": "问题陈述要求比较两种灵敏度分析方法的计算规模——有限差分法和伴随方法——应用于一个由常微分方程 (ODE) 控制且包含大量参数的系统。首先，我们必须验证问题陈述的有效性。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n-   **系统动力学**：给出了一个简单的激励示例，即一个 ODE 的初值问题 $\\dot{y}(t) = -p\\,y(t)$，其中 $y(0)=1$。一般情况是高维状态 $y(t)$，其动力学受参数向量 $\\boldsymbol{p} \\in \\mathbb{R}^m$ 影响，其中 $m \\gg 1$。我们可以将其一般地写为 $\\dot{y}(t) = f(y(t), t, \\boldsymbol{p})$。\n-   **目标函数**：在终止时间 $T > 0$ 定义的标量目标 $J = \\psi(y(T))$。\n-   **目标**：计算完整梯度 $\\dfrac{dJ}{d\\boldsymbol{p}} \\in \\mathbb{R}^m$。\n-   **计算成本假设**：\n    -   在 $[0,T]$ 上对状态方程进行一次正向求解的成本为 $C_f$。\n    -   在 $[0,T]$ 上对伴随方程进行一次反向求解的成本与 $C_f$ 相当。\n    -   有限差分 (FD) 梯度是使用前向差分计算的，一次扰动一个参数分量。\n    -   假设 FD 不在各分量间重用导数信息。\n    -   诸如步长选择之类的数值问题将被忽略，并假设所有求解的成本相当。\n\n**第2步：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题在计算工程和应用数学领域内得到了正确的阐述。有限差分法和伴随方法是计算灵敏度（梯度）的标准、成熟的技术。在不确定性下的优化和设计中，比较它们的计算复杂性是一个经典且至关重要的话题。关于计算成本的假设是用于分析这些算法规模缩放特性的标准简化。\n-   **适定性**：这个问题是适定的。它要求比较计算规模随参数数量 $m$ 变化的规律。所提供的假设足以得出一个明确、唯一的结论。\n-   **客观性**：语言技术性强、精确，且不含主观内容。\n\n**第3步：结论与行动**\n\n该问题在科学上是合理的、适定的和客观的。它不包含任何矛盾或歧义。因此，该问题是**有效的**。我们继续进行求解。\n\n### 推导与分析\n\n目标是计算具有 $m$ 个分量的梯度向量 $\\dfrac{dJ}{d\\boldsymbol{p}}$：\n$$\n\\dfrac{dJ}{d\\boldsymbol{p}} = \\begin{pmatrix} \\dfrac{\\partial J}{\\partial p_1} & \\dfrac{\\partial J}{\\partial p_2} & \\cdots & \\dfrac{\\partial J}{\\partial p_m} \\end{pmatrix}^T\n$$\n\n**1. 有限差分 (FD) 法的成本**\n\n问题指明使用前向差分格式。关于第 $i$ 个参数 $p_i$ 的偏导数近似为：\n$$\n\\dfrac{\\partial J}{\\partial p_i} \\approx \\dfrac{J(\\boldsymbol{p} + h\\boldsymbol{e}_i) - J(\\boldsymbol{p})}{h}\n$$\n其中 $\\boldsymbol{e}_i$ 是标准基向量，其第 $i$ 个位置为1，其余位置为0，而 $h$ 是一个小的扰动步长。\n\n为了计算完整的梯度向量，我们必须计算所有 $m$ 个分量。一个高效的实现将按以下步骤进行：\n-   **第1步（基准求解）**：计算 $J(\\boldsymbol{p})$。这需要用未受扰动的参数向量 $\\boldsymbol{p}$ 对状态方程进行一次从 $t=0$ 到 $t=T$ 的正向求解。成本为 $C_f$。\n-   **第2步（扰动求解）**：对于从 $i=1$ 到 $m$ 的每个参数分量 $p_i$：\n    -   计算 $J(\\boldsymbol{p} + h\\boldsymbol{e}_i)$。这需要使用受扰动的参数向量 $\\boldsymbol{p} + h\\boldsymbol{e}_i$ 对状态方程进行一次正向求解。成本为 $C_f$。\n-   总成本：该计算涉及一次基准求解和 $m$ 次扰动求解。因此，总计算成本为 $C_f + m \\times C_f = (m+1)C_f$。\n\n对于大量参数（$m \\gg 1$），成本由 $m$ 次扰动求解主导，因此总成本随 $m$ 线性扩展。成本是 $m$ 次正向求解的量级。\n\n**2. 伴随方法的成本**\n\n伴随方法是专门为以低计算成本计算标量泛函相对于大量参数的梯度而设计的。该过程包括两个主要步骤：\n-   **第1步（正向求解）**：从 $t=0$ 到 $t=T$ 正向求解状态方程 $\\dot{y}(t) = f(y(t), t, \\boldsymbol{p})$。这提供了后续步骤所需的状态轨迹 $y(t)$。成本为 $C_f$。\n-   **第2步（反向伴随求解）**：从 $t=T$ 到 $t=0$ 反向求解线性伴随方程以获得伴随状态 $\\lambda(t)$。伴随方程的形式为 $-\\dot{\\lambda}(t) = \\left(\\frac{\\partial f}{\\partial y}\\right)^T \\lambda(t)$，其终端条件为 $\\lambda(T) = \\left(\\frac{\\partial \\psi}{\\partial y}\\right)^T_{y=y(T)}$。根据假设，这次反向求解的成本为 $C_f$。\n-   **第3步（梯度计算）**：在正向和反向求解完成后，通过评估一个积分来获得整个梯度向量 $\\dfrac{dJ}{d\\boldsymbol{p}}$，该积分通常采用以下形式：\n$$\n\\dfrac{dJ}{d\\boldsymbol{p}} = \\int_0^T \\lambda(t)^T \\dfrac{\\partial f}{\\partial \\boldsymbol{p}}(y(t), t, \\boldsymbol{p}) \\, dt\n$$\n与求解 ODE 相比，该积分的评估在计算上是廉价的。\n\n总成本是正向求解和反向伴随求解的成本之和。因此，总成本约为 $C_f + C_f = 2C_f$。此成本与参数数量 $m$ 无关。\n\n**比较：**\n-   **FD 成本规模**：$\\approx (m+1)C_f$，即 $O(m)$。\n-   **伴随法成本规模**：$\\approx 2C_f$，相对于 $m$ 是 $O(1)$。\n\n对于 $m \\gg 1$ 的情况，伴随方法效率要高得多。\n\n### 逐项分析\n\n**A. 有限差分法需要 $m$ 量级的正向求解（对于中心差分则为 $2m$ 量级），而伴随方法需要大约一次正向求解和一次反向伴随求解，因此获得 $\\,\\dfrac{dJ}{d\\boldsymbol{p}}\\,$ 的总成本基本上与 $\\,m\\,$ 无关。**\n-   对有限差分法的分析是正确的。它需要 $(m+1)$ 次求解，其量级为 $m$。关于中心差分需要 $2m$ 次求解的括号内说明也是正确的。\n-   对伴随方法的分析是正确的。它需要一次正向求解和一次反向求解。\n-   伴随方法的成本与 $m$ 无关的结论是正确的。\n-   **结论：正确。**\n\n**B. 对于标量目标，有限差分法和伴随方法都需要 $m$ 量级的模型求解来获得 $\\,\\dfrac{dJ}{d\\boldsymbol{p}}\\,$。**\n-   这个陈述是错误的，因为对于标量目标，伴随方法的成本与 $m$ 无关。它错误地将 $O(m)$ 的规模归于伴随方法。\n-   **结论：错误。**\n\n**C. 由于基准求解的重用，有限差分法的成本基本上与 $\\,m\\,$ 无关，而伴随方法需要对每个参数进行单独的伴随求解，导致成本为 $m$ 量级。**\n-   这个陈述完全颠倒了事实。有限差分法除了基准求解外还需要 $m$ 次扰动求解，使其成本依赖于 $m$。伴随方法只需要一次伴随求解即可同时获得所有参数的灵敏度。\n-   **结论：错误。**\n\n**D. 两种方法的成本都与 $\\,m\\,$ 无关，因为当 $\\,m \\gg 1\\,$ 时，是状态维度而非参数数量主导了成本。**\n-   这是错误的。有限差分法的成本与 $m$ 成正比。前提 $m \\gg 1$ 使得对 $m$ 的依赖成为 FD 方法总成本最关键的因素，而不是一个无关紧要的因素。虽然状态维度影响常数 $C_f$，但它并不能消除 FD 方法的 $O(m)$ 规模。\n-   **结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2371119"}, {"introduction": "明确了伴随方法的效率优势后，我们现在转向其数学基础。推导伴随系统的一个关键步骤是确定伴随方程的源项，该源项源于目标函数如何依赖于系统状态。本练习将让你亲手实践这一推导过程，要求你应用变分法来计算一个常见目标泛函的变分导数，这是该领域任何从业者都需掌握的核心技能 [@problem_id:2371076]。", "problem": "考虑一个有界开域 $\\Omega \\subset \\mathbb{R}^{d}$，其边界 $\\partial \\Omega$ 足够光滑。设状态场 $u:\\Omega \\to \\mathbb{R}$ 满足 $u \\in H_{0}^{1}(\\Omega)$，因此 $u$ 及所有容许变分在 $\\partial \\Omega$ 上为零。目标泛函为\n$$\nJ(u) \\;=\\; \\int_{\\Omega} \\left|\\nabla u(x)\\right|^{2}\\, \\mathrm{d}x.\n$$\n在推导一个在 $\\partial \\Omega$ 上具有齐次狄利克雷边界条件的偏微分方程（PDE）约束问题的伴随方程时，伴随方程右侧的源项是 $J$ 关于 $u$ 的 $L^{2}(\\Omega)$ 变分导数。请用 $u$ 及其空间导数明确地确定此源项。请以单个简化的符号表达式形式给出最终答案。不包含单位。", "solution": "问题陈述经过验证，被认为是科学上可靠、适定、客观且自洽的。这是变分法中的一个标准问题，而变分法是推导 PDE 约束优化问题伴随方程的基石。因此，我们可以着手求解。\n\n问题要求目标泛函 $J(u)$ 关于状态场 $u$ 的 $L^{2}(\\Omega)$ 变分导数。该泛函由下式给出：\n$$\nJ(u) = \\int_{\\Omega} |\\nabla u(x)|^2 \\, \\mathrm{d}x\n$$\n其中 $u \\in H_{0}^{1}(\\Omega)$。$L^{2}(\\Omega)$ 变分导数（我们记为 $\\frac{\\delta J}{\\delta u}$）由一次变分 $\\delta J$ 的关系定义：\n$$\n\\delta J = \\lim_{\\epsilon \\to 0} \\frac{J(u + \\epsilon \\delta u) - J(u)}{\\epsilon} = \\int_{\\Omega} \\frac{\\delta J}{\\delta u} \\delta u \\, \\mathrm{d}x\n$$\n对于所有容许变分 $\\delta u$。由于状态空间是 $H_{0}^{1}(\\Omega)$，容许变分 $\\delta u$ 也必须属于 $H_{0}^{1}(\\Omega)$，这意味着在边界 $\\partial \\Omega$ 上 $\\delta u = 0$。\n\n我们首先计算 $J(u)$ 沿任意变分 $\\delta u \\in H_{0}^{1}(\\Omega)$ 方向的 Gâteaux 导数。我们考虑表达式 $J(u + \\epsilon \\delta u)$：\n$$\nJ(u + \\epsilon \\delta u) = \\int_{\\Omega} |\\nabla(u + \\epsilon \\delta u)|^2 \\, \\mathrm{d}x\n$$\n积分内的项可以利用点积的性质展开：\n$$\n|\\nabla(u + \\epsilon \\delta u)|^2 = (\\nabla u + \\epsilon \\nabla \\delta u) \\cdot (\\nabla u + \\epsilon \\nabla \\delta u) = |\\nabla u|^2 + 2\\epsilon (\\nabla u \\cdot \\nabla \\delta u) + \\epsilon^2 |\\nabla \\delta u|^2\n$$\n将此代回到 $J(u + \\epsilon \\delta u)$ 的积分中：\n$$\nJ(u + \\epsilon \\delta u) = \\int_{\\Omega} \\left( |\\nabla u|^2 + 2\\epsilon (\\nabla u \\cdot \\nabla \\delta u) + \\epsilon^2 |\\nabla \\delta u|^2 \\right) \\, \\mathrm{d}x\n$$\n一次变分 $\\delta J$ 是 $J(u + \\epsilon \\delta u)$ 关于 $\\epsilon$ 在 $\\epsilon = 0$ 处的导数：\n$$\n\\delta J = \\frac{\\mathrm{d}}{\\mathrm{d}\\epsilon} \\left[ \\int_{\\Omega} \\left( |\\nabla u|^2 + 2\\epsilon (\\nabla u \\cdot \\nabla \\delta u) + \\epsilon^2 |\\nabla \\delta u|^2 \\right) \\, \\mathrm{d}x \\right]_{\\epsilon=0}\n$$\n假设有足够的正则性可以交换微分和积分，我们有：\n$$\n\\delta J = \\int_{\\Omega} \\frac{\\partial}{\\partial\\epsilon} \\left( |\\nabla u|^2 + 2\\epsilon (\\nabla u \\cdot \\nabla \\delta u) + \\epsilon^2 |\\nabla \\delta u|^2 \\right)_{\\epsilon=0} \\, \\mathrm{d}x\n$$\n$$\n\\delta J = \\int_{\\Omega} \\left( 2 (\\nabla u \\cdot \\nabla \\delta u) + 2\\epsilon |\\nabla \\delta u|^2 \\right)_{\\epsilon=0} \\, \\mathrm{d}x\n$$\n$$\n\\delta J = \\int_{\\Omega} 2 (\\nabla u \\cdot \\nabla \\delta u) \\, \\mathrm{d}x\n$$\n为了确定变分导数，我们必须将此积分重写为 $\\int_{\\Omega} (\\cdot) \\delta u \\, \\mathrm{d}x$ 的形式。这可以通过分部积分来实现，在此多维情境下，这是格林第一恒等式的一个应用。格林第一恒等式指出，对于标量场 $v$ 和 $w$：\n$$\n\\int_{\\Omega} (v \\Delta w + \\nabla v \\cdot \\nabla w) \\, \\mathrm{d}x = \\int_{\\partial \\Omega} v (\\nabla w \\cdot \\mathbf{n}) \\, \\mathrm{d}S\n$$\n其中 $\\mathbf{n}$ 是边界 $\\partial \\Omega$ 的外单位法向量，$\\Delta = \\nabla \\cdot \\nabla$ 是拉普拉斯算子。我们可以重排该恒等式，以表达我们已有的项：\n$$\n\\int_{\\Omega} \\nabla v \\cdot \\nabla w \\, \\mathrm{d}x = \\int_{\\partial \\Omega} v (\\nabla w \\cdot \\mathbf{n}) \\, \\mathrm{d}S - \\int_{\\Omega} v \\Delta w \\, \\mathrm{d}x\n$$\n令 $v = \\delta u$ 且 $w = u$。一次变分的表达式变为：\n$$\n\\delta J = 2 \\left( \\int_{\\partial \\Omega} \\delta u (\\nabla u \\cdot \\mathbf{n}) \\, \\mathrm{d}S - \\int_{\\Omega} \\delta u \\Delta u \\, \\mathrm{d}x \\right)\n$$\n问题陈述指出，状态场 $u$ 和所有容许变分 $\\delta u$ 都在索博列夫空间 $H_{0}^{1}(\\Omega)$ 中。该空间的一个定义性属性是函数在边界 $\\partial \\Omega$ 上的迹为零。因此，对于所有 $x \\in \\partial \\Omega$，$\\delta u = 0$。所以，边界积分为零：\n$$\n\\int_{\\partial \\Omega} \\delta u (\\nabla u \\cdot \\mathbf{n}) \\, \\mathrm{d}S = \\int_{\\partial \\Omega} 0 \\cdot (\\nabla u \\cdot \\mathbf{n}) \\, \\mathrm{d}S = 0\n$$\n一次变分的表达式简化为：\n$$\n\\delta J = -2 \\int_{\\Omega} \\delta u \\Delta u \\, \\mathrm{d}x = \\int_{\\Omega} (-2 \\Delta u) \\delta u \\, \\mathrm{d}x\n$$\n通过将此结果与变分导数的定义 $\\delta J = \\int_{\\Omega} \\frac{\\delta J}{\\delta u} \\delta u \\, \\mathrm{d}x$进行比较，我们可以直接确定 $\\frac{\\delta J}{\\delta u}$ 的表达式：\n$$\n\\frac{\\delta J}{\\delta u} = -2 \\Delta u\n$$\n这个表达式是 $J$ 关于 $u$ 的 $L^{2}(\\Omega)$ 变分导数。根据问题陈述，这就是伴随方程的源项。", "answer": "$$\\boxed{-2 \\Delta u}$$", "id": "2371076"}, {"introduction": "现实世界中的工程问题很少是无约束的，它们通常涉及对物理量（如应力或温度）的限制。本练习探讨了如何将这类不等式约束整合到基于伴随的优化框架中。你将评估不同的数学公式，例如罚函数和障碍函数，以理解如何创建一个可微的目标函数来正确惩罚违反约束的行为，从而使问题适用于基于梯度的求解方法 [@problem_id:2371158]。", "problem": "您正在为一个带有逐点温度限制的稳态热传导系统设计一个基于伴随的优化方法。设状态为有界域 $\\Omega \\subset \\mathbb{R}^{d}$ 上的温度场 $T(\\boldsymbol{x})$，它由稳态热传导方程 $-\\nabla \\cdot (k \\nabla T) = u$（在 $\\Omega$ 内）和狄利克雷(Dirichlet)边界条件 $T = T_{b}$（在 $\\partial \\Omega$ 上）控制，其中 $k > 0$ 是热导率，$u(\\boldsymbol{x})$ 是一个分布控制（热源）。基准目标函数为\n$$\nJ_{0}(T,u) = \\frac{1}{2}\\int_{\\Omega}\\left(T(\\boldsymbol{x}) - T_{d}(\\boldsymbol{x})\\right)^{2}\\,\\mathrm{d}\\boldsymbol{x} + \\frac{\\alpha}{2}\\int_{\\Omega} u(\\boldsymbol{x})^{2}\\,\\mathrm{d}\\boldsymbol{x},\n$$\n其中 $T_{d}$ 是追踪目标，$\\alpha > 0$ 是正则化权重。您必须在基于伴随的梯度计算中，对所有 $\\boldsymbol{x}\\in\\Omega$ 强制执行逐点不等式约束 $T(\\boldsymbol{x}) \\le T_{max}$。\n\n根据约束优化的第一性原理以及偏微分方程（PDE）伴随灵敏度分析所依赖的链式法则，增广目标函数在形成伴随方程的任何地方都应对 $T$ 可微，并且增广项应以符合不等式约束的方式，或者只惩罚违反约束的行为（外罚法），或者强制内部可行性（障碍法）。\n\n下列对 $J_{0}$ 的哪种增广项能够在正确处理不等式 $T(\\boldsymbol{x}) \\le T_{max}$ 的同时，为基于伴随的梯度计算生成一个有效的可微目标函数？请选择所有适用选项。\n\nA. $J_{A}(T,u) = J_{0}(T,u) + \\gamma \\int_{\\Omega} \\mathbf{1}_{\\{T(\\boldsymbol{x}) > T_{max}\\}}\\,\\mathrm{d}\\boldsymbol{x}$，其中 $\\gamma > 0$，$\\mathbf{1}_{\\{\\cdot\\}}$ 是指示函数。\n\nB. $J_{B}(T,u) = J_{0}(T,u) + \\frac{\\rho}{2}\\int_{\\Omega}\\left(\\max\\{0,\\,T(\\boldsymbol{x}) - T_{max}\\}\\right)^{2}\\,\\mathrm{d}\\boldsymbol{x}$，其中 $\\rho > 0$。\n\nC. $J_{C}(T,u) = J_{0}(T,u) - \\mu \\int_{\\Omega} \\log\\!\\left(T_{max} - T(\\boldsymbol{x})\\right)\\,\\mathrm{d}\\boldsymbol{x}$，其中 $\\mu > 0$，且所有迭代点都被约束为满足 $T(\\boldsymbol{x}) < T_{max}$。\n\nD. $J_{D}(T,u) = J_{0}(T,u) + \\frac{\\rho}{2}\\int_{\\Omega}\\left(T(\\boldsymbol{x}) - T_{max}\\right)^{2}\\,\\mathrm{d}\\boldsymbol{x}$，其中 $\\rho > 0$。\n\nE. $J_{E}(T,u) = J_{0}(T,u) + \\mu \\int_{\\Omega} \\log\\!\\left(T_{max} - T(\\boldsymbol{x})\\right)\\,\\mathrm{d}\\boldsymbol{x}$，其中 $\\mu > 0$，且所有迭代点都被约束为满足 $T(\\boldsymbol{x}) < T_{max}$。", "solution": "首先必须验证问题陈述的科学合理性、适定性和客观性。\n\n**第1步：提取已知条件**\n\n*   **状态变量：** 有界域 $\\Omega \\subset \\mathbb{R}^{d}$ 上的温度场 $T(\\boldsymbol{x})$。\n*   **控制方程：** 稳态热传导方程 $-\\nabla \\cdot (k \\nabla T) = u$，适用于 $\\boldsymbol{x} \\in \\Omega$。\n*   **边界条件：** 狄利克雷(Dirichlet)条件 $T = T_{b}$，适用于 $\\partial \\Omega$。\n*   **参数：** 热导率 $k > 0$，正则化权重 $\\alpha > 0$。\n*   **控制变量：** 分布热源 $u(\\boldsymbol{x})$。\n*   **基准目标函数：** $J_{0}(T,u) = \\frac{1}{2}\\int_{\\Omega}\\left(T(\\boldsymbol{x}) - T_{d}(\\boldsymbol{x})\\right)^{2}\\,\\mathrm{d}\\boldsymbol{x} + \\frac{\\alpha}{2}\\int_{\\Omega} u(\\boldsymbol{x})^{2}\\,\\mathrm{d}\\boldsymbol{x}$。\n*   **不等式约束：** 逐点温度限制 $T(\\boldsymbol{x}) \\le T_{max}$，适用于所有 $\\boldsymbol{x}\\in\\Omega$。\n*   **方法论要求：**\n    1.  增广目标函数必须对 $T$ 可微，以允许构造一个适定的伴随问题。\n    2.  增广项必须正确处理不等式约束，可以通过外罚法（惩罚违规）或内点障碍法（防止违规）实现。\n\n**第2步：使用提取的已知条件进行验证**\n\n*   **科学依据：** 该问题是偏微分方程约束优化中的一个标准练习，特别是稳态热传导方程的最优控制。所有元素——控制偏微分方程、二次型目标泛函和逐点状态约束——都是该领域的典型组成部分。该问题在计算数学和工程领域有坚实的理论基础。\n*   **适定性：** 问题要求识别用于增广目标函数的有效泛函形式。这是优化理论和数值方法中的一个明确定义的问题。它不要求解优化问题本身，而是评估所提出公式的数学属性。\n*   **客观性：** 问题以精确的数学语言陈述，没有歧义或主观内容。\n\n**第3步：结论与行动**\n\n问题陈述在科学上是合理的、适定的和客观的。它为分析所提出的增广项提供了一个完整且一致的框架。因此，该问题是**有效的**。我们继续进行求解。\n\n核心任务是根据两个标准来分析对基准目标函数 $J_0$ 的每个增广项：关于状态 $T$ 的可微性以及对不等式约束 $T(\\boldsymbol{x}) \\le T_{max}$ 的正确实现。在“先微分后离散”的灵敏度分析方法中，增广泛函关于 $T$ 的导数可作为伴随方程的源项。对于标准的连续伴随方法，这个导数必须是一个良态函数，而不是像狄拉克（Dirac）δ分布那样的分布。\n\n**选项A的分析**\n\n$J_{A}(T,u) = J_{0}(T,u) + \\gamma \\int_{\\Omega} \\mathbf{1}_{\\{T(\\boldsymbol{x}) > T_{max}\\}}\\,\\mathrm{d}\\boldsymbol{x}$，其中 $\\gamma > 0$。\n\n该增广项是指示函数 $\\mathbf{1}_{\\{T(\\boldsymbol{x}) > T_{max}\\}}$ 的积分，如果条件满足则其值为 $1$，否则为 $0$。这个泛函是不可微的。指示函数对其自变量的导数是一个狄拉克δ分布。因此，$J_A$ 关于 $T$ 的 Fréchet 导数在通常意义下（例如，在 $L^2(\\Omega)$ 中）不是一个函数，这使得标准伴随偏微分方程的构建变得有问题。基于梯度的优化算法需要一个更平滑的目标函数来提供有意义的搜索方向。\n\nA 的结论：**不正确**。\n\n**选项B的分析**\n\n$J_{B}(T,u) = J_{0}(T,u) + \\frac{\\rho}{2}\\int_{\\Omega}\\left(\\max\\{0,\\,T(\\boldsymbol{x}) - T_{max}\\}\\right)^{2}\\,\\mathrm{d}\\boldsymbol{x}$，其中 $\\rho > 0$。\n\n这是一种经典的二次罚函数法。设 $g(T) = T - T_{max}$。惩罚项基于函数 $f(y) = (\\max\\{0, y\\})^2$。这个函数是连续可微的（$C^1$）。它的导数是 $f'(y) = 2 \\max\\{0, y\\}$。因此，该增广项关于 $T$ 的导数是 $\\rho \\max\\{0, T(\\boldsymbol{x}) - T_{max}\\}$。这是 $T$ 的一个连续函数，并为伴随方程提供了一个完全有效的源项。如果约束 $T(\\boldsymbol{x}) \\le T_{max}$ 得到满足，则惩罚项为零；如果不满足，则该项随违规程度 $T(\\boldsymbol{x}) - T_{max}$ 的大小呈二次方增长。这是外罚函数的正确行为。\n\nB 的结论：**正确**。\n\n**选项C的分析**\n\n$J_{C}(T,u) = J_{0}(T,u) - \\mu \\int_{\\Omega} \\log\\!\\left(T_{max} - T(\\boldsymbol{x})\\right)\\,\\mathrm{d}\\boldsymbol{x}$，其中 $\\mu > 0$，且所有迭代点都被约束为满足 $T(\\boldsymbol{x}) < T_{max}$。\n\n这是一种对数障碍法（一种内点法）。增广项是 $-\\mu \\log(T_{max} - T)$。当 $T(\\boldsymbol{x})$ 从下方趋近 $T_{max}$ 时，对数的参数 $T_{max} - T(\\boldsymbol{x})$ 趋近于 $0^+$。对数值 $\\log(T_{max} - T(\\boldsymbol{x}))$ 趋近于 $-\\infty$。由于积分前的负号，惩罚项 $-\\mu \\log(T_{max} - T(\\boldsymbol{x}))$ 趋近于 $+\\infty$。这就形成了一个“障碍”，防止优化过程选择违反约束的状态 $T$。该增广项关于 $T$ 的导数是 $\\frac{\\mu}{T_{max} - T(\\boldsymbol{x})}$。只要迭代点保持严格可行（$T(\\boldsymbol{x}) < T_{max}$），如此选项在问题描述中所规定的，这个导数就是良定义的、平滑的，并且适合作为伴随方程的源项。\n\nC 的结论：**正确**。\n\n**选项D的分析**\n\n$J_{D}(T,u) = J_{0}(T,u) + \\frac{\\rho}{2}\\int_{\\Omega}\\left(T(\\boldsymbol{x}) - T_{max}\\right)^{2}\\,\\mathrm{d}\\boldsymbol{x}$，其中 $\\rho > 0$。\n\n这个泛函对 $T$ 是平滑且可微的。其导数为 $\\rho(T(\\boldsymbol{x}) - T_{max})$。然而，它没有正确地表示不等式约束 $T(\\boldsymbol{x}) \\le T_{max}$。惩罚项 $(T(\\boldsymbol{x}) - T_{max})^2$ 对于任何 $T(\\boldsymbol{x}) \\neq T_{max}$ 都是非零的。这意味着它不仅惩罚了违规情况（$T > T_{max}$），也惩罚了严格可行状态（$T < T_{max}$）。这种形式试图强制执行等式约束 $T(\\boldsymbol{x}) = T_{max}$，这与所提出的问题有本质上的不同。\n\nD 的结论：**不正确**。\n\n**选项E的分析**\n\n$J_{E}(T,u) = J_{0}(T,u) + \\mu \\int_{\\Omega} \\log\\!\\left(T_{max} - T(\\boldsymbol{x})\\right)\\,\\mathrm{d}\\boldsymbol{x}$，其中 $\\mu > 0$，且所有迭代点都被约束为满足 $T(\\boldsymbol{x}) < T_{max}$。\n\n这个增广项也基于一个对数项，并且对于严格可行的迭代点是可微的。但是，对于一个障碍函数来说，其符号是不正确的。当 $T(\\boldsymbol{x})$ 从下方趋近 $T_{max}$ 时，$\\log(T_{max} - T(\\boldsymbol{x}))$ 趋近于 $-\\infty$。由于该项是以正号相加的（$+\\mu$），当接近约束边界时，总目标函数 $J_E$ 将被驱使向 $-\\infty$ 变化。因此，一个最小化算法将被激励将 $T$ 推向尽可能接近 $T_{max}$ 的值，如果不是因为对迭代点的明确条件，它甚至会越过边界。这种形式不惩罚接近约束边界的行为，反而奖励这种行为。这与障碍函数的目的相反。\n\nE 的结论：**不正确**。", "answer": "$$\\boxed{BC}$$", "id": "2371158"}]}