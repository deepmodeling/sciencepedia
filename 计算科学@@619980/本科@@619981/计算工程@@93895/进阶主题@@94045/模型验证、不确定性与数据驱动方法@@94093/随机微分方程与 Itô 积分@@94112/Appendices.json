{"hands_on_practices": [{"introduction": "在计算科学中，我们经常需要对随机微分方程 (SDE) 进行数值求解。然而，直接将常微分方程 (ODE) 的数值方法（如欧拉法）应用于 SDE 可能会导致不稳定的结果。这个实践练习将引导你探索最基础的 SDE 数值方法——欧拉-丸山法 (Euler–Maruyama method) 的一个核心性质：均方稳定性 (mean-square stability)，这是确保随机模拟结果有意义的关键前提。通过亲手推导稳定性的边界条件，你将深刻理解步长 $h$、漂移项 $\\lambda$ 和扩散项 $\\mu$ 是如何共同影响数值解的可靠性的 [@problem_id:2439998]。", "problem": "考虑如下伊藤意义下的标量线性随机微分方程 (SDE)\n$$\ndX_t = \\lambda X_t \\, dt + \\mu X_t \\, dW_t,\\quad X_0 = x_0,\n$$\n其中 $W_t$ 表示一个标准维纳过程（标准布朗运动），$\\lambda \\in \\mathbb{R}$，$\\mu \\in \\mathbb{R}$ 为常数。将步长为 $h>0$ 的显式欧拉-丸山 (EM) 方法应用于此 SDE，可得到以下递推关系\n$$\nX_{n+1} = X_n + \\lambda h X_n + \\mu X_n \\Delta W_n,\n$$\n其中 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ 是服从分布 $\\mathcal{N}(0,h)$ 的独立高斯随机变量。\n\n将此离散时间方法的零解的均方稳定性定义如下：对于一个固定的步长 $h>0$，如果对于任何具有有限二阶矩的初始条件 $X_0$，当 $n \\to \\infty$ 时，都有\n$$\n\\mathbb{E}\\big[|X_n|^2\\big] \\to 0\n$$\n成立，则称零解是均方稳定的。均方稳定性边界 $h^\\star(\\lambda,\\mu)$ 是所有使得欧拉-丸山方法均方稳定的 $h>0$ 的上确界。\n\n任务：从基本原理及上述定义出发，推导 $h^\\star(\\lambda,\\mu)$ 作为 $\\lambda$ 和 $\\mu$ 的函数的闭式表达式，要求覆盖所有情况，包括不存在正步长使得方法均方稳定的情况。然后，编写一个程序，对下方指定的测试套件中的每一对参数 $(\\lambda,\\mu)$ 计算 $h^\\star(\\lambda,\\mu)$ 的值，将每个结果四舍五入到 $6$ 位小数，并输出这些值的列表。\n\n测试套件（每项为一对 $(\\lambda,\\mu)$）：\n- $(-2.0, 1.0)$\n- $(-1.0, 0.0)$\n- $(-0.5, 1.0)$\n- $(0.5, 0.1)$\n- $(-3.0, 2.0)$\n\n要求的最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_k$ 是第 $k$ 个测试用例的 $h^\\star(\\lambda,\\mu)$ 值，四舍五入到 $6$ 位小数。不涉及物理单位，所有数值结果必须以实数形式报告。", "solution": "该问题要求推导应用于标量线性随机微分方程的显式欧拉-丸山方法的均方稳定性边界，记为 $h^\\star(\\lambda, \\mu)$。推导过程必须从基本原理出发。\n\n所讨论的 SDE 为\n$$\ndX_t = \\lambda X_t \\, dt + \\mu X_t \\, dW_t, \\quad X_0 = x_0,\n$$\n其中 $\\lambda \\in \\mathbb{R}$，$\\mu \\in \\mathbb{R}$ 为常数， $W_t$ 是标准维纳过程。\n\n欧拉-丸山 (EM) 方法提供了一个离散时间近似。对于一个均匀时间步长 $h > 0$，其递推关系为\n$$\nX_{n+1} = X_n + \\lambda h X_n + \\mu X_n \\Delta W_n,\n$$\n其中 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$。这些增量是独立同分布的高斯随机变量，$\\Delta W_n \\sim \\mathcal{N}(0, h)$。我们可以将 $X_{n+1}$ 的表达式进行因式分解：\n$$\nX_{n+1} = (1 + \\lambda h + \\mu \\Delta W_n) X_n.\n$$\n零解的均方稳定性由条件 $\\mathbb{E}\\big[|X_n|^2\\big] \\to 0$（当 $n \\to \\infty$ 时）定义。我们定义 $M_n = \\mathbb{E}\\big[|X_n|^2\\big]$ 并为其推导一个递推关系。\n$$\nM_{n+1} = \\mathbb{E}\\big[|X_{n+1}|^2\\big] = \\mathbb{E}\\Big[\\big|(1 + \\lambda h + \\mu \\Delta W_n) X_n\\big|^2\\Big] = \\mathbb{E}\\Big[|1 + \\lambda h + \\mu \\Delta W_n|^2 |X_n|^2\\Big].\n$$\n$X_n$ 的值由维纳过程截至时间 $t_n$ 的历史所决定，因此它是 $\\mathcal{F}_{t_n}$-可测的。增量 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ 独立于 $\\sigma$-代数 $\\mathcal{F}_{t_n}$。因此，$X_n$ 和 $\\Delta W_n$ 是独立的。这使我们能够分离期望：\n$$\nM_{n+1} = \\mathbb{E}\\Big[|1 + \\lambda h + \\mu \\Delta W_n|^2\\Big] \\cdot \\mathbb{E}\\big[|X_n|^2\\big] = R(\\lambda, \\mu, h) M_n,\n$$\n其中 $R(\\lambda, \\mu, h) = \\mathbb{E}\\big[|1 + \\lambda h + \\mu \\Delta W_n|^2\\big]$ 是均方放大因子。\n\n为求 $R(\\lambda, \\mu, h)$，我们展开期望内的表达式：\n$$\nR(\\lambda, \\mu, h) = \\mathbb{E}\\big[(1 + \\lambda h)^2 + 2(1 + \\lambda h)\\mu \\Delta W_n + \\mu^2 (\\Delta W_n)^2\\big].\n$$\n利用期望的线性性，我们得到\n$$\nR(\\lambda, \\mu, h) = (1 + \\lambda h)^2 + 2(1 + \\lambda h)\\mu \\mathbb{E}[\\Delta W_n] + \\mu^2 \\mathbb{E}[(\\Delta W_n)^2].\n$$\n维纳增量的性质为 $\\mathbb{E}[\\Delta W_n] = 0$ 和 $\\mathbb{E}[(\\Delta W_n)^2] = \\text{Var}(\\Delta W_n) = h$。将这些值代入 $R$ 的表达式可得\n$$\nR(\\lambda, \\mu, h) = (1 + \\lambda h)^2 + 2(1 + \\lambda h)\\mu \\cdot 0 + \\mu^2 h = (1 + \\lambda h)^2 + \\mu^2 h.\n$$\n将此展开，我们有\n$$\nR(\\lambda, \\mu, h) = 1 + 2\\lambda h + \\lambda^2 h^2 + \\mu^2 h.\n$$\n递推关系 $M_{n+1} = R(\\lambda, \\mu, h) M_n$ 描述了均方值的几何级数。要使 $M_n \\to 0$（当 $n \\to \\infty$ 时），其充要条件是放大因子满足 $|R(\\lambda, \\mu, h)| < 1$。\n由于 $h > 0$ 且 $\\mu^2 \\ge 0$，我们有 $R(\\lambda, \\mu, h) = (1+\\lambda h)^2 + \\mu^2 h \\ge 0$。因此，稳定性条件简化为 $0 \\le R(\\lambda, \\mu, h) < 1$。这等价于\n$$\n1 + 2\\lambda h + \\lambda^2 h^2 + \\mu^2 h < 1.\n$$\n两边减去 $1$ 可得\n$$\n2\\lambda h + \\lambda^2 h^2 + \\mu^2 h < 0.\n$$\n由于我们寻求 $h > 0$ 的解，我们可以用 $h$ 除不等式两边：\n$$\n2\\lambda + \\mu^2 + \\lambda^2 h < 0.\n$$\n现在我们必须解这个关于 $h$ 的不等式。\n\n情况 1：$\\lambda = 0$。\n不等式变为 $2(0) + \\mu^2 + (0)^2 h < 0$，简化为 $\\mu^2 < 0$。对于任何实数 $\\mu$，这个不等式都无解。因此，如果 $\\lambda = 0$，不存在任何步长 $h>0$ 能使 EM 方法是均方稳定的。稳定步长的集合是空集，其上确界为 $h^\\star(0, \\mu) = 0$。\n\n情况 2：$\\lambda \\ne 0$。\n我们重排不等式以分离出 $h$：\n$$\n\\lambda^2 h < -(2\\lambda + \\mu^2).\n$$\n由于 $\\lambda \\ne 0$，所以 $\\lambda^2 > 0$。两边同除以 $\\lambda^2$ 不改变不等号方向：\n$$\nh < -\\frac{2\\lambda + \\mu^2}{\\lambda^2}.\n$$\n要存在满足此条件的任何正数 $h$，不等式右侧必须为正。这要求\n$$\n-\\frac{2\\lambda + \\mu^2}{\\lambda^2} > 0 \\implies -(2\\lambda + \\mu^2) > 0 \\implies 2\\lambda + \\mu^2 < 0.\n$$\n如果 $2\\lambda + \\mu^2 < 0$，那么区间 $\\left(0, -\\frac{2\\lambda + \\mu^2}{\\lambda^2}\\right)$ 内的任何步长 $h$ 都会得到一个均方稳定的格式。稳定性边界 $h^\\star(\\lambda, \\mu)$ 是这个稳定步长集合的上确界，即该区间的上界：\n$$\nh^\\star(\\lambda, \\mu) = -\\frac{2\\lambda + \\mu^2}{\\lambda^2}.\n$$\n另一方面，如果 $2\\lambda + \\mu^2 \\ge 0$，则关于 $h$ 的不等式右侧将小于或等于零。没有正数 $h$ 能满足该条件。稳定步长的集合是空集，其上确界为 $h^\\star(\\lambda, \\mu) = 0$。\n\n综合这些结果，我们推导出均方稳定性边界的最终闭式表达式：\n$$\nh^\\star(\\lambda, \\mu) =\n\\begin{cases}\n    -\\frac{2\\lambda + \\mu^2}{\\lambda^2} & \\text{若 } \\lambda \\neq 0 \\text{ 且 } 2\\lambda + \\mu^2 < 0 \\\\\n    0 & \\text{其他情况}\n\\end{cases}\n$$\n在所提供的程序中实现了此表达式，用于为指定的测试用例计算 $h^\\star(\\lambda, \\mu)$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the mean-square stability boundary h_star for the Euler-Maruyama\n    method applied to a scalar linear SDE for a given set of parameters.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each entry is a tuple (lambda, mu).\n    test_cases = [\n        (-2.0, 1.0),\n        (-1.0, 0.0),\n        (-0.5, 1.0),\n        (0.5, 0.1),\n        (-3.0, 2.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        lambda_val, mu_val = case\n        \n        # The stability boundary h_star is derived from the condition\n        # for mean-square stability of the Euler-Maruyama method:\n        # h_star = sup{h > 0 | (1 + lambda*h)^2 + mu^2*h < 1}.\n        # This simplifies to h < -(2*lambda + mu^2) / lambda^2,\n        # which requires 2*lambda + mu^2 < 0 for a positive solution h to exist.\n\n        # The closed-form expression for h_star is:\n        # h_star = - (2*lambda + mu^2) / lambda^2   if 2*lambda + mu^2 < 0 and lambda != 0\n        # h_star = 0                                otherwise\n\n        h_star = 0.0\n        \n        # Check if lambda is non-zero to avoid division by zero.\n        if lambda_val != 0.0:\n            stability_condition = 2 * lambda_val + mu_val**2\n            \n            # If the condition is met, a positive stability boundary exists.\n            if stability_condition < 0.0:\n                h_star = -stability_condition / (lambda_val**2)\n\n        # Round the result to 6 decimal places as required.\n        # Using f-string for formatting ensures the trailing zeros are kept.\n        rounded_result = f\"{h_star:.6f}\"\n        results.append(rounded_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2439998"}, {"introduction": "伊藤引理是随机分析的基石，它为我们提供了处理随机过程函数的强大工具，类似于确定性微积分中的链式法则。本练习旨在通过一个经典的物理场景——分析三维空间中两个独立布朗运动粒子的间距——来锻炼你应用伊藤引理的能力。你将从一个高维系统出发，推导出描述其一维距离过程 $R_t$ 的 SDE（即贝塞尔过程, Bessel process），并进一步计算一个关键物理量：首次穿越时间 (first-passage time) 的期望值。这个过程不仅能巩固你的理论推导技巧，还能让你领略到伊藤微积分如何将复杂的多维随机问题简化为可分析的一维问题 [@problem_id:2439934]。", "problem": "考虑两个在静止介质中运动的粒子，其位置由$\\mathbb{R}^{3}$中的独立标准布朗运动建模。设$\\{X_{t}\\}_{t \\geq 0}$和$\\{Y_{t}\\}_{t \\geq 0}$是这些独立过程，其中初始位置$X_{0}, Y_{0} \\in \\mathbb{R}^{3}$是确定性的。定义分离向量$Z_{t} = X_{t} - Y_{t}$和分离距离$R_{t} = \\|Z_{t}\\|$。假设初始分离距离为$r_{0} = \\|X_{0} - Y_{0}\\| \\in (0,a)$，其中$a>0$为一固定值。\n\n仅使用伊藤微积分的基本原理（不得引用现成的专门公式），完成以下任务：\n\n- 推导标量过程$\\{R_{t}\\}_{t \\geq 0}$在其保持严格为正情况下的随机微分方程（SDE）。\n- 设$\\tau_{a} = \\inf\\{t \\geq 0 : R_{t} = a\\}$表示分离距离首次达到半径$a$的时间。确定首达时间的期望$\\mathbb{E}[\\tau_{a}]$，将其表示为$a$和$r_{0}$的函数。\n\n答案规格：\n- 以一个关于$a$和$r_{0}$的封闭形式解析表达式提供您的最终答案。\n- 无需四舍五入，也无需单位。", "solution": "该问题要求推导两个经历独立布朗运动的粒子之间分离距离的随机微分方程（SDE），并随后计算首达时间的期望。我将依次处理这两项任务。\n\n首先，我们验证问题的陈述。该问题在随机微积分的框架内是良定义的。粒子由$\\mathbb{R}^{3}$中的标准布朗运动建模，记为$\\{X_t\\}_{t \\geq 0}$和$\\{Y_t\\}_{t \\geq 0}$。这些是伊藤过程，其SDE为$dX_t = dW_t^{(1)}$和$dY_t = dW_t^{(2)}$，其中$W_t^{(1)}$和$W_t^{(2)}$是独立的3维标准维纳过程。所有提供的信息在科学上都是合理的、自洽的、客观的。该问题是有效的。\n\n第1部分：分离距离$R_t$的SDE推导。\n\n设分离向量为$Z_t = X_t - Y_t$。初始分离向量为$Z_0 = X_0 - Y_0$。通过线性关系可得$Z_t$的SDE：\n$$dZ_t = dX_t - dY_t = dW_t^{(1)} - dW_t^{(2)}$$\n设维纳过程的分量为$W_{t,i}^{(1)}$和$W_{t,i}^{(2)}$（$i=1, 2, 3$）。$Z_t$的分量为$Z_{t,i} = X_{t,i} - Y_{t,i}$。每个分量的微分为$dZ_{t,i} = dW_{t,i}^{(1)} - dW_{t,i}^{(2)}$。\n$dZ_t$各分量之间的二次协变差由下式给出：\n$$d[Z_i, Z_j]_t = [dZ_{t,i}, dZ_{t,j}] = [dW_{t,i}^{(1)} - dW_{t,i}^{(2)}, dW_{t,j}^{(1)} - dW_{t,j}^{(2)}]$$\n利用二次协变差的双线性性、$W_t^{(1)}$和$W_t^{(2)}$的独立性，以及给定维纳过程各分量的独立性，我们有对所有$i,j$都有$[dW_{t,i}^{(1)}, dW_{t,j}^{(2)}] = 0$。此外，对于$k=1,2$，有$[dW_{t,i}^{(k)}, dW_{t,j}^{(k)}] = \\delta_{ij} dt$。\n$$d[Z_i, Z_j]_t = [dW_{t,i}^{(1)}, dW_{t,j}^{(1)}] - [dW_{t,i}^{(1)}, dW_{t,j}^{(2)}] - [dW_{t,i}^{(2)}, dW_{t,j}^{(1)}] + [dW_{t,i}^{(2)}, dW_{t,j}^{(2)}]$$\n$$d[Z_i, Z_j]_t = \\delta_{ij} dt - 0 - 0 + \\delta_{ij} dt = 2\\delta_{ij} dt$$\n这表明$Z_t$是一个方差为$2t$的3维布朗运动。我们可以写成$dZ_t = \\sqrt{2} dW_t$，其中$W_t$是一个标准的3维维纳过程。\n\n分离距离为$R_t = \\|Z_t\\| = \\sqrt{Z_{t,1}^2 + Z_{t,2}^2 + Z_{t,3}^2}$。这是$Z_t$各分量的函数。设$f(z_1, z_2, z_3) = \\sqrt{z_1^2 + z_2^2 + z_3^2}$。我们应用伊藤引理来求$R_t = f(Z_t)$的SDE。对于伊藤过程$Z_t$的函数$f$，该引理陈述如下：\n$$df(Z_t) = \\sum_{i=1}^{3} \\frac{\\partial f}{\\partial z_i} dZ_{t,i} + \\frac{1}{2}\\sum_{i,j=1}^{3} \\frac{\\partial^2 f}{\\partial z_i \\partial z_j} d[Z_i, Z_j]_t$$\n函数$f(z)$（其中$r = \\|z\\|$）的偏导数是：\n$$\\frac{\\partial f}{\\partial z_i} = \\frac{z_i}{r}$$\n$$\\frac{\\partial^2 f}{\\partial z_i \\partial z_j} = \\frac{\\delta_{ij}}{r} - \\frac{z_i z_j}{r^3}$$\n将这些偏导数代入伊藤引理，其中$r$由$R_t$替换，$z_i$由$Z_{t,i}$替换：\n$$dR_t = \\sum_{i=1}^{3} \\frac{Z_{t,i}}{R_t} dZ_{t,i} + \\frac{1}{2} \\sum_{i,j=1}^{3} \\left(\\frac{\\delta_{ij}}{R_t} - \\frac{Z_{t,i}Z_{t,j}}{R_t^3}\\right) (2\\delta_{ij} dt)$$\n让我们分析这两项。\n第一项（随机部分）是：\n$$\\sum_{i=1}^{3} \\frac{Z_{t,i}}{R_t} (\\sqrt{2} dW_{t,i}) = \\sqrt{2} \\sum_{i=1}^{3} \\frac{Z_{t,i}}{R_t} dW_{t,i}$$\n让我们定义一个新过程$B_t = \\int_0^t \\sum_{i=1}^3 \\frac{Z_{s,i}}{R_s} dW_{s,i}$。由于$\\sum_i (Z_{s,i}/R_s)^2 = 1$，被积函数是一个单位向量。此过程的二次变差为：\n$$[dB_t, dB_t] = \\sum_{i,j=1}^{3} \\frac{Z_{t,i}Z_{t,j}}{R_t^2} [dW_{t,i}, dW_{t,j}] = \\sum_{i,j=1}^{3} \\frac{Z_{t,i}Z_{t,j}}{R_t^2} \\delta_{ij} dt = \\sum_{i=1}^{3} \\frac{Z_{t,i}^2}{R_t^2} dt = dt$$\n根据Lévy特征定理，$B_t$是一个标准的一维维纳过程。因此，随机项为$\\sqrt{2} dB_t$。\n\n第二项（漂移部分）是：\n$$\\frac{1}{2} \\sum_{i,j=1}^{3} \\left(\\frac{\\delta_{ij}}{R_t} - \\frac{Z_{t,i}Z_{t,j}}{R_t^3}\\right) (2\\delta_{ij} dt) = dt \\sum_{i=1}^{3} \\left(\\frac{1}{R_t} - \\frac{Z_{t,i}^2}{R_t^3}\\right)$$\n$$= dt \\left(\\frac{3}{R_t} - \\frac{1}{R_t^3} \\sum_{i=1}^{3} Z_{t,i}^2 \\right) = dt \\left(\\frac{3}{R_t} - \\frac{R_t^2}{R_t^3}\\right) = \\frac{2}{R_t} dt$$\n结合漂移项和随机项，我们得到$R_t$的SDE：\n$$dR_t = \\frac{2}{R_t} dt + \\sqrt{2} dB_t$$\n这是维数为$D=3$、扩散系数为$\\sqrt{2}$的贝塞尔过程的SDE。\n\n第2部分：首达时间期望$\\mathbb{E}[\\tau_a]$的计算。\n\n设$u(r) = \\mathbb{E}[\\tau_a | R_0 = r]$为过程$R_t$从$r$出发首次达到$a$的期望时间。$R_t$的SDE形式为$dR_t = \\mu(R_t) dt + \\sigma(R_t) dB_t$，其中漂移项为$\\mu(r) = 2/r$，扩散项为$\\sigma(r) = \\sqrt{2}$。函数$u(r)$满足向后Kolmogorov方程$\\mathcal{L}u(r) = -1$，其中$\\mathcal{L}$是过程$R_t$的生成元：\n$$\\mathcal{L} = \\mu(r) \\frac{d}{dr} + \\frac{1}{2}\\sigma(r)^2 \\frac{d^2}{dr^2}$$\n代入$\\mu(r)$和$\\sigma(r)$的表达式：\n$$\\frac{2}{r} \\frac{du}{dr} + \\frac{1}{2}(\\sqrt{2})^2 \\frac{d^2u}{dr^2} = -1$$\n这可以化简为下面的二阶常微分方程：\n$$\\frac{d^2u}{dr^2} + \\frac{2}{r} \\frac{du}{dr} = -1$$\n为求解此常微分方程，令$v(r) = du/dr$。方程变为关于$v(r)$的一阶线性常微分方程：\n$$\\frac{dv}{dr} + \\frac{2}{r}v = -1$$\n我们使用积分因子$I(r) = \\exp\\left(\\int \\frac{2}{r} dr\\right) = \\exp(2\\ln r) = r^2$来求解。方程两边乘以$r^2$得到：\n$$r^2 \\frac{dv}{dr} + 2rv = -r^2 \\implies \\frac{d}{dr}(r^2 v) = -r^2$$\n对$r$积分：\n$$r^2 v(r) = -\\int r^2 dr = -\\frac{r^3}{3} + C_1$$\n$$v(r) = \\frac{du}{dr} = -\\frac{r}{3} + \\frac{C_1}{r^2}$$\n再次积分以求得$u(r)$：\n$$u(r) = \\int \\left(-\\frac{r}{3} + \\frac{C_1}{r^2}\\right) dr = -\\frac{r^2}{6} - \\frac{C_1}{r} + C_2$$\n现在我们利用边界条件来确定积分常数$C_1$和$C_2$。过程在达到$a$时停止，所以从$a$出发达到$a$所需的时间为0。这给出了边界条件$u(a)=0$。\n该问题定义在区间$(0, a)$上。另一个边界在$r=0$处。过程$R_t$是一个3维布朗运动（具有修正方差）的径向部分。3维布朗运动是暂留的，意味着它几乎必然不会返回原点。因此，从$r_0 > 0$开始的过程$R_t$几乎必然不会触及0。对于$r \\in (0, a]$，期望时间$u(r)$必须是有限的。考察通解$u(r) = -r^2/6 - C_1/r + C_2$，当$r \\to 0^+$时，项$-C_1/r$会使$u(r)$无界，除非$C_1=0$。一个物理上有意义的、有限的期望要求解是有界的。因此，我们必须有$C_1=0$。\n\n当$C_1=0$时，解变为$u(r) = -r^2/6 + C_2$。\n应用边界条件$u(a)=0$：\n$$-\\frac{a^2}{6} + C_2 = 0 \\implies C_2 = \\frac{a^2}{6}$$\n因此，作为起始位置$r$的函数的首达时间期望为：\n$$u(r) = \\frac{a^2 - r^2}{6}$$\n问题要求的是当初始分离距离为$r_0$时的这个值。我们代入$r=r_0$：\n$$\\mathbb{E}[\\tau_a] = u(r_0) = \\frac{a^2 - r_0^2}{6}$$\n这就是首达时间期望的最终解析表达式。", "answer": "$$\\boxed{\\frac{a^2 - r_0^2}{6}}$$", "id": "2439934"}, {"introduction": "在科学与工程的许多领域，我们使用 SDE 来构建现实世界现象的数学模型，但模型的具体参数（如漂移率和波动率）通常是未知的。这个实践练习将视角从“模拟”转向“推断”，让你扮演数据科学家的角色。你将使用金融工程中无处不在的几何布朗运动 (Geometric Brownian Motion, GBM) 模型，学习如何基于离散的观测数据，运用伊藤引理和最大似然估计 (Maximum Likelihood Estimation, MLE) 等统计学原理，来反向推断出 SDE 模型的未知参数 $\\mu$ 和 $\\sigma$。这项“校准”模型的技能是将随机理论应用于实际数据分析的核心环节 [@problem_id:2440008]。", "problem": "考虑一个标量资产价格，其模型为几何布朗运动 (GBM)，即满足随机微分方程 (SDE) $dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t$，其中 $S_t$ 是时刻 $t$ 的价格，$\\mu$ 是漂移率，$\\sigma$ 是波动率，而 $W_t$ 是一个标准布朗运动 (BM)。从该 SDE 出发，仅使用伊藤微积分的基本定义（特别是应用于对数的伊藤引理），为未知参数 $\\mu$ 和 $\\sigma$ 推导一个基于最大似然估计 (MLE) 的、符合统计学原理的估计量。该估计量源自以均匀时间步长 $\\Delta t$ 采样的离散时间序列观测值 $S_0,S_1,\\dots,S_n$。\n\n您的推导必须从 SDE 定义开始，使用伊藤引理得到 $\\log S_t$ 的动态过程，然后对独立同分布 (IID) 的增量进行基于似然的论证，从而生成以观测序列 $S_0,\\dots,S_n$ 和采样间隔 $\\Delta t$ 表示的 $\\mu$ 和 $\\sigma$ 的显式估计量。除了直接从这些原理中获得的公式外，请勿调用任何快捷公式。\n\n然后，在一个完整的、可运行的程序中实现这些估计量。该程序需对下述的每个测试用例，从给定的初始值和指定的对数回报序列中重构观测价格序列，并仅使用重构的价格序列（而非给定的回报）计算 $\\mu$ 和 $\\sigma$ 的 MLE 估计值。为了保证不同实现之间的数值再现性，请将报告的每个 $\\mu$ 和 $\\sigma$ 值四舍五入到六位小数。\n\n测试套件规范：\n- 每个测试用例提供一个初始价格 $S_0$、一个时间步长 $\\Delta t$ 和一个对数回报列表 $Y_1,\\dots,Y_n$。观测价格由 $S_k = S_{k-1} \\exp(Y_k)$（$k=1,\\dots,n$）递归定义。您的程序必须首先根据这些定义重构价格序列，然后从重构的序列计算 MLE。\n- 测试用例：\n  1. 具有中等变异性的一般情况：\n     - $S_0 = 100$, $\\Delta t = 0.1$, $[Y_1,\\dots,Y_{10}] = [0.02,-0.05,0.03,0.1,-0.08,0.04,0.0,-0.02,0.06,-0.03]$。\n  2. 具有单次增量和零变异性的边界情况：\n     - $S_0 = 50$, $\\Delta t = 0.5$, $[Y_1] = [0.0]$。\n  3. 具有负漂移率和小变异性的情况：\n     - $S_0 = 80$, $\\Delta t = 0.25$, $[Y_1,\\dots,Y_8] = [-0.1,0.02,-0.03,-0.04,0.01,-0.019,-0.05,0.03]$。\n  4. 具有混合正负号的高变异性情况：\n     - $S_0 = 10$, $\\Delta t = 0.5$, $[Y_1,\\dots,Y_5] = [0.15,0.0,-0.2,0.25,-0.1]$。\n\n输出规范：\n- 对每个测试用例，从重构的序列中计算 MLE $\\hat{\\mu}$ 和 $\\hat{\\sigma}$。\n- 将所有结果按 $[\\hat{\\mu}_1,\\hat{\\sigma}_1,\\hat{\\mu}_2,\\hat{\\sigma}_2,\\hat{\\mu}_3,\\hat{\\sigma}_3,\\hat{\\mu}_4,\\hat{\\sigma}_4]$ 的顺序汇总到一个扁平列表中，其中下标为测试用例的索引。\n- 输出前将每个数字四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来、以逗号分隔的四舍五入结果，例如 $[\\hat{\\mu}_1,\\hat{\\sigma}_1,\\dots]$，每个条目格式化为六位小数。\n\n所有答案均为不带物理单位的实数，且不涉及角度。您的最终输出必须是格式化为六位小数的浮点数。程序必须是自包含的，且不使用任何输入。", "solution": "问题陈述经评估有效。这是一个在随机微积分和统计推断领域的适定问题，其基础是成熟的金融工程原理。数据完整，目标明确。我们着手进行推导和求解。\n\n资产价格 $S_t$ 由几何布朗运动 (GBM) 的随机微分方程 (SDE) 建模：\n$$ dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t $$\n其中 $\\mu$ 是漂移参数，$\\sigma$ 是波动率参数，$W_t$ 是标准维纳过程或布朗运动。我们的目标是根据在均匀时间间隔 $\\Delta t$ 采样的离散时间序列观测值 $S_0, S_1, \\dots, S_n$ 推导出 $\\mu$ 和 $\\sigma$ 的最大似然估计量 (MLE)。\n\n推导过程首先将伊藤引理应用于函数 $f(S_t) = \\log S_t$。设 $X_t = \\log S_t$。$f(S_t)$ 关于 $t$ 和 $S_t$ 的偏导数如下：\n$$ \\frac{\\partial f}{\\partial t} = 0, \\quad \\frac{\\partial f}{\\partial S_t} = \\frac{1}{S_t}, \\quad \\frac{\\partial^2 f}{\\partial S_t^2} = -\\frac{1}{S_t^2} $$\n根据伊藤引理，微分 $dX_t$ 由下式给出：\n$$ dX_t = \\left( \\frac{\\partial f}{\\partial t} + \\mu S_t \\frac{\\partial f}{\\partial S_t} + \\frac{1}{2} \\sigma^2 S_t^2 \\frac{\\partial^2 f}{\\partial S_t^2} \\right) dt + \\left( \\sigma S_t \\frac{\\partial f}{\\partial S_t} \\right) dW_t $$\n将偏导数代入此表达式可得：\n$$ dX_t = \\left( 0 + \\mu S_t \\left(\\frac{1}{S_t}\\right) + \\frac{1}{2} \\sigma^2 S_t^2 \\left(-\\frac{1}{S_t^2}\\right) \\right) dt + \\left( \\sigma S_t \\left(\\frac{1}{S_t}\\right) \\right) dW_t $$\n化简各项，我们得到对数价格过程 $X_t$ 的 SDE：\n$$ dX_t = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) dt + \\sigma dW_t $$\n这是一个算术布朗运动，其常数漂移率为 $\\mu - \\frac{1}{2}\\sigma^2$，常数波动率为 $\\sigma$。\n\n为分析离散观测值，我们将此 SDE 在时间区间 $[t_{k-1}, t_k]$ 上进行积分，其中 $t_k = k \\Delta t$。在此区间内对数价格的变化为：\n$$ X_{t_k} - X_{t_{k-1}} = \\int_{t_{k-1}}^{t_k} \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) dt + \\int_{t_{k-1}}^{t_k} \\sigma dW_t $$\n令 $Y_k = X_{t_k} - X_{t_{k-1}} = \\log(S_{t_k}) - \\log(S_{t_{k-1}})$ 为第 $k$ 个区间的对数回报。第一个积分是确定性的，而第二个是伊藤积分。\n$$ Y_k = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) (t_k - t_{k-1}) + \\sigma (W_{t_k} - W_{t_{k-1}}) $$\n由于 $t_k - t_{k-1} = \\Delta t$，上式变为：\n$$ Y_k = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma (W_{t_k} - W_{t_{k-1}}) $$\n标准布朗运动的增量 $W_{t_k} - W_{t_{k-1}}$ 是独立的，且服从均值为 $0$、方差为 $\\Delta t$ 的正态分布。即，$W_{t_k} - W_{t_{k-1}} \\sim \\mathcal{N}(0, \\Delta t)$。\n因此，对数回报 $Y_k$（$k=1, \\dots, n$）是服从正态分布的独立同分布 (IID) 随机变量：\n$$ Y_k \\sim \\mathcal{N}\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t, \\sigma^2 \\Delta t \\right) $$\n让我们为这个正态分布定义新的参数：均值 $\\nu = (\\mu - \\frac{1}{2}\\sigma^2) \\Delta t$ 和方差 $\\tau^2 = \\sigma^2 \\Delta t$。因此，$Y_k \\sim \\mathcal{N}(\\nu, \\tau^2)$。\n\n我们现在根据 $n$ 个观测值 $Y_1, \\dots, Y_n$ 推导 $\\nu$ 和 $\\tau^2$ 的 MLE。似然函数是每个观测值的概率密度函数的乘积：\n$$ L(\\nu, \\tau^2; Y_1, \\dots, Y_n) = \\prod_{k=1}^n \\frac{1}{\\sqrt{2\\pi \\tau^2}} \\exp\\left( -\\frac{(Y_k - \\nu)^2}{2\\tau^2} \\right) $$\n使用对数似然函数 $\\mathcal{L} = \\log L$ 更为方便：\n$$ \\mathcal{L}(\\nu, \\tau^2) = \\sum_{k=1}^n \\left( -\\frac{1}{2} \\log(2\\pi) - \\frac{1}{2} \\log(\\tau^2) - \\frac{(Y_k - \\nu)^2}{2\\tau^2} \\right) $$\n$$ \\mathcal{L}(\\nu, \\tau^2) = -\\frac{n}{2} \\log(2\\pi\\tau^2) - \\frac{1}{2\\tau^2} \\sum_{k=1}^n (Y_k - \\nu)^2 $$\n为找到使该函数最大化的估计量，我们计算其关于 $\\nu$ 和 $\\tau^2$ 的偏导数，并将其设为零。\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\nu} = \\frac{1}{\\tau^2} \\sum_{k=1}^n (Y_k - \\nu) = 0 \\implies \\sum_{k=1}^n Y_k - n\\nu = 0 $$\n这就得到了 $\\nu$ 的 MLE：\n$$ \\hat{\\nu} = \\frac{1}{n} \\sum_{k=1}^n Y_k = \\bar{Y} $$\n正态分布均值的 MLE 是其样本均值。\n接下来，我们对 $\\tau^2$ 求导：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial (\\tau^2)} = -\\frac{n}{2\\tau^2} + \\frac{1}{2(\\tau^2)^2} \\sum_{k=1}^n (Y_k - \\nu)^2 = 0 $$\n将 $\\hat{\\nu}$ 代替 $\\nu$ 并求解 $\\tau^2$：\n$$ \\frac{n}{2\\hat{\\tau}^2} = \\frac{1}{2(\\hat{\\tau}^2)^2} \\sum_{k=1}^n (Y_k - \\hat{\\nu})^2 \\implies \\hat{\\tau}^2 = \\frac{1}{n} \\sum_{k=1}^n (Y_k - \\bar{Y})^2 $$\n这是对数回报的样本方差，我们记为 $s_Y^2$。\n\n最后，我们利用最大似然估计量的不变性来找到我们原始参数 $\\mu$ 和 $\\sigma$ 的估计量。关系如下：\n$$ \\tau^2 = \\sigma^2 \\Delta t \\quad \\text{和} \\quad \\nu = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t $$\n从第一个关系式，我们估计 $\\sigma^2$：\n$$ \\hat{\\sigma}^2 = \\frac{\\hat{\\tau}^2}{\\Delta t} = \\frac{s_Y^2}{\\Delta t} = \\frac{1}{n \\Delta t} \\sum_{k=1}^n (Y_k - \\bar{Y})^2 $$\n因此，波动率 $\\sigma$ 的估计量为：\n$$ \\hat{\\sigma} = \\sqrt{\\frac{1}{n \\Delta t} \\sum_{k=1}^n (Y_k - \\bar{Y})^2} $$\n从第二个关系式，我们求解 $\\mu$：\n$$ \\mu = \\frac{\\nu}{\\Delta t} + \\frac{1}{2}\\sigma^2 $$\n代入估计量 $\\hat{\\nu}$ 和 $\\hat{\\sigma}^2$，我们得到漂移率 $\\mu$ 的估计量：\n$$ \\hat{\\mu} = \\frac{\\hat{\\nu}}{\\Delta t} + \\frac{1}{2}\\hat{\\sigma}^2 $$\n这些就是按要求从第一性原理推导出的 $\\mu$ 和 $\\sigma$ 的显式估计量。程序实现将从重构的价格序列中计算这些量值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (S0, delta_t, list_of_log_returns)\n    test_cases = [\n        (100.0, 0.1, [0.02, -0.05, 0.03, 0.1, -0.08, 0.04, 0.0, -0.02, 0.06, -0.03]),\n        (50.0, 0.5, [0.0]),\n        (80.0, 0.25, [-0.1, 0.02, -0.03, -0.04, 0.01, -0.019, -0.05, 0.03]),\n        (10.0, 0.5, [0.15, 0.0, -0.2, 0.25, -0.1])\n    ]\n\n    all_results = []\n    \n    for s0, delta_t, yk_list in test_cases:\n        # Reconstruct the price series S_k from S_0 and log-returns Y_k\n        # S_k = S_{k-1} * exp(Y_k)\n        price_series = [s0]\n        current_price = s0\n        for yk in yk_list:\n            current_price *= np.exp(yk)\n            price_series.append(current_price)\n        \n        # As per problem, compute estimators using ONLY the reconstructed price series.\n        # This means we must re-calculate log-returns from the price series.\n        price_series_np = np.array(price_series)\n        \n        # n is the number of returns, which is number of prices - 1.\n        n = len(price_series_np) - 1\n        \n        if n > 0:\n            # Calculate log-returns Yk = log(S_k) - log(S_{k-1})\n            log_returns = np.log(price_series_np[1:]) - np.log(price_series_np[:-1])\n            \n            # Compute sample mean of log-returns\n            y_mean = np.mean(log_returns)\n            \n            # Compute sample variance of log-returns (MLE version, ddof=0 is default in np.var)\n            y_var_mle = np.var(log_returns)\n            \n            # Estimate sigma^2 using the derived formula\n            sigma_sq_hat = y_var_mle / delta_t\n            \n            # Estimate sigma\n            sigma_hat = np.sqrt(sigma_sq_hat)\n            \n            # Estimate mu using the derived formula\n            mu_hat = (y_mean / delta_t) + 0.5 * sigma_sq_hat\n        else:\n            # If n=0 (only S0 given), estimators are undefined from returns.\n            # Handle this as an edge case, though not expected by the problem setup.\n            # The narrowest case in test suite is n=1.\n            mu_hat = 0.0\n            sigma_hat = 0.0\n\n        all_results.append(f\"{mu_hat:.6f}\")\n        all_results.append(f\"{sigma_hat:.6f}\")\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2440008"}]}