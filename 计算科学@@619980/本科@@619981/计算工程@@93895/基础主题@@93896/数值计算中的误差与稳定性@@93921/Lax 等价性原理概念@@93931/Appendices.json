{"hands_on_practices": [{"introduction": "稳定性是数值格式成功的基石。这项练习将引导你使用冯·诺依曼分析法——一种用于线性问题稳定性分析的强大工具。你将通过分析证明，对一个经典的稳定格式（Lax-Friedrichs 格式）进行一个看似微小的修改，就可能彻底破坏其稳定性[@problem_id:2407982]。这个实践不仅能锻炼你的分析能力，还能加深你对数值稳定性内在机制的直观理解。", "problem": "考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速 $a \\in \\mathbb{R}$ 为常数。在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，定义库朗数 $\\nu = a\\,\\Delta t/\\Delta x$。经典的Lax–Friedrichs格式通过用对称邻点平均值替换 $u^{n}_{j}$ 来更新解。现在考虑以下修正的更新格式，它通过一个小的正偏置 $\\varepsilon > 0$ 来扰动平均项：\n$$\nu^{n+1}_{j} = \\left(\\frac{1}{2} + \\varepsilon\\right)\\left(u^{n}_{j+1} + u^{n}_{j-1}\\right) \\;-\\; \\frac{\\nu}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right).\n$$\n使用von Neumann傅里叶模态分析法，设试探解形式为 $u^{n}_{j} = \\hat{u}^{n}\\,\\exp(i j \\theta)$，确定放大因子 $G(\\theta)$，并用它来量化该格式的线性稳定性。具体来说，计算以下量\n$$\n\\inf_{\\nu \\in \\mathbb{R}} \\;\\sup_{\\theta \\in \\mathbb{R}} \\,|G(\\theta)|,\n$$\n并将其表示为关于 $\\varepsilon$ 的显式闭式表达式。你的最终答案必须是单一的解析表达式，无需四舍五入。", "solution": "该问题陈述科学上是合理的，形式上是连贯的，并且是适定的。我们可以开始求解。\n\n该问题要求对线性平流方程 $u_{t} + a\\,u_{x} = 0$ 的一个修正数值格式进行稳定性分析。该格式由下式给出：\n$$\nu^{n+1}_{j} = \\left(\\frac{1}{2} + \\varepsilon\\right)\\left(u^{n}_{j+1} + u^{n}_{j-1}\\right) - \\frac{\\nu}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right)\n$$\n其中 $\\nu = a\\,\\Delta t/\\Delta x$ 是库朗数，$\\varepsilon > 0$ 是一个常数偏置。我们使用von Neumann稳定性分析，该方法考察单一傅里叶模态的放大情况。\n\n我们将试探解 $u^{n}_{j} = \\hat{u}^{n}\\,\\exp(i j \\theta)$ 代入该格式。$u^{n+1}_{j}$ 项表示为 $u^{n+1}_{j} = G(\\theta) u^{n}_{j} = G(\\theta) \\hat{u}^{n}\\,\\exp(i j \\theta)$，其中 $G(\\theta)$ 是放大因子。空间邻点由下式给出：\n$$\nu^{n}_{j+1} = \\hat{u}^{n}\\,\\exp(i (j+1) \\theta) = u^{n}_{j}\\,\\exp(i\\theta)\n$$\n$$\nu^{n}_{j-1} = \\hat{u}^{n}\\,\\exp(i (j-1) \\theta) = u^{n}_{j}\\,\\exp(-i\\theta)\n$$\n将这些形式代入该数值格式，我们得到：\n$$\nG(\\theta) u^{n}_{j} = \\left(\\frac{1}{2} + \\varepsilon\\right)\\left(u^{n}_{j}\\,\\exp(i\\theta) + u^{n}_{j}\\,\\exp(-i\\theta)\\right) - \\frac{\\nu}{2}\\left(u^{n}_{j}\\,\\exp(i\\theta) - u^{n}_{j}\\,\\exp(-i\\theta)\\right)\n$$\n我们从两边消去公因子（非零项）$u^{n}_{j}$。使用欧拉恒等式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$ 和 $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$，我们简化 $G(\\theta)$ 的表达式：\n$$\nG(\\theta) = \\left(\\frac{1}{2} + \\varepsilon\\right)(2\\cos(\\theta)) - \\frac{\\nu}{2}(2i\\sin(\\theta))\n$$\n$$\nG(\\theta) = (1 + 2\\varepsilon)\\cos(\\theta) - i\\nu\\sin(\\theta)\n$$\n这就是给定格式的放大因子。它是模态角 $\\theta$ 和库朗数 $\\nu$ 的一个复值函数。\n\n线性稳定性的条件是对于所有 $\\theta \\in [-\\pi, \\pi]$，都有 $|G(\\theta)| \\le 1$。问题要求计算 $\\inf_{\\nu \\in \\mathbb{R}} \\sup_{\\theta \\in \\mathbb{R}} |G(\\theta)|$。我们首先对于一个固定的 $\\nu$，求 $|G(\\theta)|$ 关于 $\\theta$ 的上确界。为简化分析，我们计算其模的平方 $|G(\\theta)|^2$：\n$$\n|G(\\theta)|^2 = \\left( (1 + 2\\varepsilon)\\cos(\\theta) \\right)^2 + \\left( -\\nu\\sin(\\theta) \\right)^2\n$$\n$$\n|G(\\theta)|^2 = (1 + 2\\varepsilon)^2\\cos^2(\\theta) + \\nu^2\\sin^2(\\theta)\n$$\n使用恒等式 $\\sin^2(\\theta) = 1 - \\cos^2(\\theta)$，我们将 $|G(\\theta)|^2$ 表示为 $\\cos^2(\\theta)$ 的函数：\n$$\n|G(\\theta)|^2 = (1 + 2\\varepsilon)^2\\cos^2(\\theta) + \\nu^2(1 - \\cos^2(\\theta))\n$$\n$$\n|G(\\theta)|^2 = \\nu^2 + \\left[ (1 + 2\\varepsilon)^2 - \\nu^2 \\right]\\cos^2(\\theta)\n$$\n设变量 $C = \\cos^2(\\theta)$。当 $\\theta$ 遍历 $\\mathbb{R}$ 时，$C$ 遍历区间 $[0, 1]$。我们希望找到函数 $f(C) = \\nu^2 + \\left[ (1 + 2\\varepsilon)^2 - \\nu^2 \\right]C$ 在 $C \\in [0, 1]$ 上的最大值。\n函数 $f(C)$ 是关于 $C$ 的线性函数。它在区间 $[0, 1]$ 上的最大值将出现在端点之一，$C=0$ 或 $C=1$，这取决于 $C$ 的系数的符号。\n\n情况1：系数 $(1 + 2\\varepsilon)^2 - \\nu^2 \\ge 0$。\n这等价于 $\\nu^2 \\le (1 + 2\\varepsilon)^2$，即 $|\\nu| \\le 1 + 2\\varepsilon$。在这种情况下，$f(C)$ 的最大值在 $C=1$ 时取得（对应于 $\\theta = k\\pi$，$k \\in \\mathbb{Z}$）。\n$$\n\\sup_{\\theta} |G(\\theta)|^2 = \\nu^2 + \\left[ (1 + 2\\varepsilon)^2 - \\nu^2 \\right](1) = (1 + 2\\varepsilon)^2\n$$\n\n情况2：系数 $(1 + 2\\varepsilon)^2 - \\nu^2 < 0$。\n这等价于 $\\nu^2 > (1 + 2\\varepsilon)^2$，即 $|\\nu| > 1 + 2\\varepsilon$。在这种情况下，$f(C)$ 的最大值在 $C=0$ 时取得（对应于 $\\theta = \\frac{\\pi}{2} + k\\pi$，$k \\in \\mathbb{Z}$）。\n$$\n\\sup_{\\theta} |G(\\theta)|^2 = \\nu^2 + \\left[ (1 + 2\\varepsilon)^2 - \\nu^2 \\right](0) = \\nu^2\n$$\n\n结合这两种情况，我们可以将模的平方的上确界写为：\n$$\n\\sup_{\\theta \\in \\mathbb{R}} |G(\\theta)|^2 = \\max\\left( (1 + 2\\varepsilon)^2, \\nu^2 \\right)\n$$\n两边开方，我们找到模的上确界：\n$$\n\\sup_{\\theta \\in \\mathbb{R}} |G(\\theta)| = \\sqrt{\\max\\left( (1 + 2\\varepsilon)^2, \\nu^2 \\right)} = \\max\\left( \\sqrt{(1 + 2\\varepsilon)^2}, \\sqrt{\\nu^2} \\right)\n$$\n因为 $\\varepsilon > 0$，所以 $1 + 2\\varepsilon$ 是正的。因此，$\\sqrt{(1 + 2\\varepsilon)^2} = 1 + 2\\varepsilon$。\n$$\n\\sup_{\\theta \\in \\mathbb{R}} |G(\\theta)| = \\max(1 + 2\\varepsilon, |\\nu|)\n$$\n最后，我们必须计算该量在 $\\nu$ 的所有可能实数值上的下确界。设 $M(\\nu) = \\max(1 + 2\\varepsilon, |\\nu|)$。我们寻求 $\\inf_{\\nu \\in \\mathbb{R}} M(\\nu)$。\n\n函数 $M(\\nu)$ 定义为：\n$$\nM(\\nu) =\n\\begin{cases}\n1 + 2\\varepsilon & \\text{当 } |\\nu| \\le 1 + 2\\varepsilon \\\\\n|\\nu| & \\text{当 } |\\nu| > 1 + 2\\varepsilon\n\\end{cases}\n$$\n从这个定义可以清楚地看出，对于任何 $\\nu \\in \\mathbb{R}$，$M(\\nu)$ 的值总是大于或等于 $1 + 2\\varepsilon$。$M(\\nu)$ 的最小值是 $1 + 2\\varepsilon$，并且当 $\\nu$ 在闭区间 $[-(1 + 2\\varepsilon), 1 + 2\\varepsilon]$ 内取任何值时，都可以达到这个最小值。\n因此，下确界是：\n$$\n\\inf_{\\nu \\in \\mathbb{R}} \\sup_{\\theta \\in \\mathbb{R}} |G(\\theta)| = 1 + 2\\varepsilon\n$$\n正偏置 $\\varepsilon$ 引入了无条件不稳定性，因为最大放大因子的最小值是 $1 + 2\\varepsilon$，它严格大于 $1$。", "answer": "$$\n\\boxed{1 + 2\\varepsilon}\n$$", "id": "2407982"}, {"introduction": "在拉克斯等价定理中，一致性是与稳定性并列的另一大支柱，它确保了当网格无限细化时，离散格式确实逼近了我们想要解决的偏微分方程。这项练习超越了简单地检验一致性，它要求你反向工程一个数值格式，使其精确地对应一个含有附加项的“修正”偏微分方程[@problem_id:2408003]。通过这个过程，你将深刻体会到截断误差如何表现为一种“数值粘性”，并最终决定了你的格式实际上在求解哪个方程。", "problem": "考虑一维热偏微分方程 (PDE) $u_{t}=\\alpha\\,u_{xx}$，其中扩散系数 $\\alpha>0$ 为严格正常数，该方程定义在周期性空间域上。设空间网格是均匀的，节点为 $x_{j}=j\\,\\Delta x$；时间网格为 $t^{n}=n\\,\\Delta t$。令 $u_{j}^{n}$ 表示 $u(x_{j},t^{n})$ 的一个近似值。定义每个时间步的两步线性更新如下：\n\n- 步骤 A (扩散步)：由下式计算中间场 $y_{j}$\n$$\ny_{j}=u_{j}^{n}+\\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}\\Big(u_{j+1}^{n}-2\\,u_{j}^{n}+u_{j-1}^{n}\\Big).\n$$\n\n- 步骤 B (人工粘性平滑)：更新\n$$\nu_{j}^{n+1}=(1-2\\gamma)\\,y_{j}+\\gamma\\,(y_{j-1}+y_{j+1}),\n$$\n其中 $\\gamma>0$ 是一个用户选择的参数，它可以依赖于 $\\Delta t$ 和 $\\Delta x$，但与 $j$ 或 $n$ 无关。\n\n假设在抛物尺度关系 $\\Delta t/\\Delta x^{2}$ 保持固定的情况下，$\\Delta t\\to 0$ 且 $\\Delta x\\to 0$。在此细化机制下，求出 $\\gamma$ 关于 $\\epsilon$、$\\Delta t$ 和 $\\Delta x$ 的唯一闭式表达式，使得组合后的两步法在时间上是一阶精确的，并且与给定常数 $\\epsilon>0$ 的偏微分方程 $u_{t}=(\\alpha+\\epsilon)\\,u_{xx}$ 相容。请以一个关于 $\\epsilon$、$\\Delta t$ 和 $\\Delta x$ 的单一解析表达式的形式给出你的答案。无需四舍五入，也无需报告单位。", "solution": "该问题要求确定应用于一维热方程的两步数值方法的参数 $\\gamma$。条件是该方法必须与修正后的偏微分方程 $u_{t}=(\\alpha+\\epsilon)\\,u_{xx}$ 相容，其中 $\\epsilon>0$ 为给定值。这个任务可以通过推导数值格式所隐式求解的修正偏微分方程来完成。这需要通过对有限差分算子进行严格的泰勒级数展开来实现。通过比较所得修正偏微分方程与目标偏微分方程的系数，我们可以建立一个关于 $\\gamma$ 的方程并求解。\n\n首先，我们用算子表示法来表达给定的两步数值格式。设二阶空间导数的标准二阶中心差分算子定义为：\n$$\nD_{xx} u_{j}^{n} = \\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{\\Delta x^{2}}\n$$\n根据此定义，格式的步骤 A，即扩散步，可以写为：\n$$\ny_{j} = u_{j}^{n} + \\alpha \\Delta t \\left( \\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{\\Delta x^{2}} \\right) = (I + \\alpha \\Delta t D_{xx}) u_{j}^{n}\n$$\n其中 $I$ 表示单位算子。\n\n步骤 B，即人工粘性平滑步，作用于中间场 $y_{j}$：\n$$\nu_{j}^{n+1} = (1-2\\gamma)y_{j}+\\gamma(y_{j-1}+y_{j+1}) = y_{j} + \\gamma(y_{j+1}-2y_{j}+y_{j-1})\n$$\n这可以利用作用于场 $y$ 的 $D_{xx}$ 算子紧凑地表示为：\n$$\nu_{j}^{n+1} = y_{j} + \\gamma \\Delta x^{2} \\left(\\frac{y_{j+1}-2y_{j}+y_{j-1}}{\\Delta x^{2}}\\right) = (I + \\gamma \\Delta x^{2} D_{xx}) y_{j}\n$$\n为了分析完整的方法，我们将步骤 A 中 $y_j$ 的表达式代入 $u_{j}^{n+1}$ 的方程中，从而合并这两个步骤：\n$$\nu_{j}^{n+1} = (I + \\gamma \\Delta x^{2} D_{xx}) \\big( (I + \\alpha \\Delta t D_{xx}) u_{j}^{n} \\big)\n$$\n展开算子乘积，得到完整的单步更新规则：\n$$\nu_{j}^{n+1} = (I + \\alpha \\Delta t D_{xx} + \\gamma \\Delta x^{2} D_{xx} + \\alpha \\gamma \\Delta t \\Delta x^{2} D_{xx}^{2}) u_{j}^{n}\n$$\n为了推导修正偏微分方程，我们重排此方程以分离出时间导数的近似，然后将所有算子进行泰勒级数展开。\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = \\left( (\\alpha + \\frac{\\gamma \\Delta x^{2}}{\\Delta t}) D_{xx} + \\alpha \\gamma \\Delta x^{2} D_{xx}^{2} \\right) u_{j}^{n}\n$$\n假设精确解 $u(x,t)$ 足够光滑，我们在点 $(x_j, t^n)$ 附近展开这些算子。代表时间导数的左侧展开为：\n$$\n\\frac{u(x_{j}, t^{n}+\\Delta t) - u(x_{j}, t^{n})}{\\Delta t} = u_{t} + \\frac{\\Delta t}{2} u_{tt} + O(\\Delta t^{2})\n$$\n右侧的空间算子有如下泰勒级数展开：\n$$\nD_{xx} u = u_{xx} + \\frac{\\Delta x^{2}}{12} u_{xxxx} + O(\\Delta x^{4})\n$$\n$$\nD_{xx}^{2} u = \\left(\\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\Delta x^{2}}{12}\\frac{\\partial^{4}}{\\partial x^{4}} + \\dots\\right)^{2} u = u_{xxxx} + O(\\Delta x^{2})\n$$\n将这些展开式代入格式的方程中，得到：\n$$\nu_{t} + \\frac{\\Delta t}{2} u_{tt} + \\dots = \\left(\\alpha + \\frac{\\gamma \\Delta x^{2}}{\\Delta t}\\right) \\left(u_{xx} + \\frac{\\Delta x^{2}}{12} u_{xxxx} + \\dots \\right) + \\alpha \\gamma \\Delta x^{2} (u_{xxxx} + \\dots)\n$$\n分离出 $u_t$ 项，得到数值格式所满足的修正偏微分方程：\n$$\nu_{t} = \\left(\\alpha + \\frac{\\gamma \\Delta x^{2}}{\\Delta t}\\right) u_{xx} - \\frac{\\Delta t}{2} u_{tt} + \\left[ \\left(\\alpha + \\frac{\\gamma \\Delta x^{2}}{\\Delta t}\\right)\\frac{\\Delta x^{2}}{12} + \\alpha \\gamma \\Delta x^{2} \\right] u_{xxxx} + \\dots\n$$\n问题要求该格式与偏微分方程 $u_{t} = (\\alpha+\\epsilon)u_{xx}$ 相容。如果两个微分算子的主阶项相匹配，则它们是相容的。因此，我们修正方程中 $u_{xx}$ 项的系数必须等于目标偏微分方程中的扩散系数 $(\\alpha+\\epsilon)$。这决定了以下等式必须成立：\n$$\n\\alpha + \\frac{\\gamma \\Delta x^{2}}{\\Delta t} = \\alpha + \\epsilon\n$$\n两边减去 $\\alpha$ 得到关于 $\\gamma$ 的条件：\n$$\n\\frac{\\gamma \\Delta x^{2}}{\\Delta t} = \\epsilon\n$$\n解出 $\\gamma$ 得到唯一的闭式表达式：\n$$\n\\gamma = \\epsilon \\frac{\\Delta t}{\\Delta x^{2}}\n$$\n这个结果是用指定的参数 $\\epsilon$、$\\Delta t$ 和 $\\Delta x$ 表示的。鉴于 $\\epsilon>0$、$\\Delta t>0$ 和 $\\Delta x^2>0$，条件 $\\gamma>0$ 得到满足。\n\n最后，我们必须验证，如问题所述，这个 $\\gamma$ 的选择能够导出一个在时间上是一阶精确的格式。相对于目标偏微分方程的局部截断误差由修正方程中的高阶项给出。代入我们关于 $\\gamma$ 的表达式：\n$$\nu_{t} - (\\alpha + \\epsilon)u_{xx} = - \\frac{\\Delta t}{2} u_{tt} + \\left[ \\frac{(\\alpha + \\epsilon)\\Delta x^{2}}{12} + \\alpha \\left(\\epsilon \\frac{\\Delta t}{\\Delta x^{2}}\\right) \\Delta x^{2} \\right] u_{xxxx} + \\dots\n$$\n$$\nu_{t} - (\\alpha + \\epsilon)u_{xx} = - \\frac{\\Delta t}{2} u_{tt} + \\left( \\frac{(\\alpha + \\epsilon)\\Delta x^{2}}{12} + \\alpha \\epsilon \\Delta t \\right) u_{xxxx} + \\dots\n$$\n右侧的项代表主阶截断误差。误差项的阶为 $O(\\Delta t)$ 和 $O(\\Delta x^{2})$。在指定的抛物细化机制下，比率 $\\Delta t/\\Delta x^{2}$ 保持固定，这意味着 $\\Delta t$ 和 $\\Delta x^{2}$ 以相同的速率趋近于零。因此，总的截断误差为 $O(\\Delta t, \\Delta x^{2})$。这对应于一个时间上一阶精确、空间上二阶精确的方法。因此，时间上一阶精确的条件得到了满足。推导出的 $\\gamma$ 表达式是正确且唯一的。", "answer": "$$\n\\boxed{\\epsilon \\frac{\\Delta t}{\\Delta x^{2}}}\n$$", "id": "2408003"}]}