{"hands_on_practices": [{"introduction": "在有限元方法中，单元刚度矩阵 $K^{(i)}$ 是将连续的微分方程转化为离散代数系统的核心。这个练习将引导你从第一原理出发，为一个非均匀的对数网格推导出单元刚度矩阵 [@problem_id:2420728]。通过这个过程，你将深刻理解单元刚度矩阵不仅依赖于控制方程，还与网格的几何形状密切相关，从而超越对均匀网格公式的简单记忆。", "problem": "考虑一维空间中的边值问题：在区间 $\\left[x_{a}, x_{b}\\right]$（其中 $x_{a} > 0$）上，寻找一个足够光滑的函数 $u$，使得对于 $x \\in (x_{a}, x_{b})$，满足 $-\\dfrac{d}{dx}\\left(\\kappa \\dfrac{du}{dx}\\right) = f(x)$，其中 $\\kappa > 0$ 是一个常数。设该区域被一个严格递增的节点序列 $\\{x_{j}\\}_{j=0}^{N}$ 划分为 $N$ 个单元，该序列由一个对数间距的几何级数定义，\n$$\nx_{j} = x_{a}\\, r^{\\,j}, \\quad r = \\left(\\dfrac{x_{b}}{x_{a}}\\right)^{\\!1/N}, \\quad j = 0, 1, \\dots, N,\n$$\n使得 $x_{0} = x_{a}$ 且 $x_{N} = x_{b}$。在此网格上，考虑在有限元法 (FEM) 中使用的标准连续分段线性帽子函数 $\\{\\varphi_{j}\\}_{j=0}^{N}$。对于具有局部线性基 $\\{\\varphi_{i}, \\varphi_{i+1}\\}$ 的单元 $e_{i} = [x_{i}, x_{i+1}]$，推导与该微分算子导出的双线性形式相关联的二乘二单元刚度矩阵 $K^{(i)}$。将您的最终结果完全用 $x_{a}$、$x_{b}$、$N$、$i$ 和 $\\kappa$ 表示，并使用上面定义的比率 $r$。\n\n您的最终答案必须是关于 $2 \\times 2$ 矩阵 $K^{(i)}$ 的单个闭式解析表达式。不需要进行数值舍入。", "solution": "对问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n- **微分方程：** $-\\dfrac{d}{dx}\\left(\\kappa \\dfrac{du}{dx}\\right) = f(x)$，对于 $x \\in (x_{a}, x_{b})$。\n- **区域：** 区间 $[x_{a}, x_{b}]$，其中 $x_{a} > 0$。\n- **参数：** $\\kappa > 0$ 是一个常数。\n- **网格：** 通过严格递增的节点序列 $\\{x_{j}\\}_{j=0}^{N}$ 将区域划分为 $N$ 个单元。\n- **节点定义：** $x_{j} = x_{a}\\, r^{\\,j}$，其中 $r = \\left(\\dfrac{x_{b}}{x_{a}}\\right)^{1/N}$，对于 $j = 0, 1, \\dots, N$。这意味着 $x_0 = x_a$ 并且 $x_N = x_b$。\n- **单元定义：** $e_{i} = [x_{i}, x_{i+1}]$，对于 $i=0, 1, \\dots, N-1$。\n- **基函数：** 标准连续分段线性帽子函数 $\\{\\varphi_{j}\\}_{j=0}^{N}$。在单元 $e_i$ 上，局部基为 $\\{\\varphi_i, \\varphi_{i+1}\\}$。\n- **任务：** 为单元 $e_i$ 推导 $2 \\times 2$ 的单元刚度矩阵 $K^{(i)}$。\n- **输出要求：** 最终结果必须用 $x_{a}$、$x_{b}$、$N$、$i$ 和 $\\kappa$ 表示，并使用比率 $r$。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学性验证：** 该问题描述了一个标准的一维二阶椭圆边值问题，这是物理学和工程学中用于热传导或扩散等现象的基本模型。所提出的方法——使用线性帽子函数的有限元法 (FEM)——是求解此类方程的标准而严谨的数值技术。该问题在计算工程和应用数学领域具有坚实的基础。\n- **适定性验证：** 推导单元刚度矩阵是 FEM 框架内一个定义明确的子问题。给定微分算子和基函数，其过程是确定性的，并能得出唯一的结果。\n- **客观性验证：** 问题使用精确的数学语言陈述，没有模糊性、主观性或个人观点。\n- **完整性验证：** 所有必要信息——微分算子、区域划分、基函数以及所需的输出变量——均已提供。该问题是自洽的。\n\n**第 3 步：结论与行动**\n该问题被认定为有效。这是一个计算工程领域的标准适定问题，没有科学或逻辑上的缺陷。下面将进行求解推导。\n\n微分方程的弱形式通过乘以一个测试函数 $v(x)$ 并在区域 $[x_a, x_b]$ 上积分得到。我们对左侧项应用分部积分：\n$$\n\\int_{x_a}^{x_b} -\\dfrac{d}{dx}\\left(\\kappa \\dfrac{du}{dx}\\right) v(x) \\,dx = \\int_{x_a}^{x_b} \\kappa \\dfrac{du}{dx}\\dfrac{dv}{dx} \\,dx - \\left[\\kappa \\dfrac{du}{dx} v(x)\\right]_{x_a}^{x_b}\n$$\n因此，与微分算子相关的双线性形式 $a(u,v)$ 为：\n$$\na(u,v) = \\int_{x_a}^{x_b} \\kappa \\dfrac{du}{dx}\\dfrac{dv}{dx} \\,dx\n$$\n全局刚度矩阵 $K$ 的元素由 $K_{jk} = a(\\varphi_k, \\varphi_j)$ 给出。对于单元 $e_i = [x_i, x_{i+1}]$，其单元刚度矩阵是一个与局部基函数 $\\varphi_i$ 和 $\\varphi_{i+1}$ 相关联的 $2 \\times 2$ 矩阵 $K^{(i)}$。其元素通过将积分限制在单元域 $[x_i, x_{i+1}]$ 上来计算。设局部索引为 1 和 2，对应于全局索引 $i$ 和 $i+1$。$K^{(i)}$ 的元素为：\n$$\nK^{(i)}_{mn} = \\int_{x_i}^{x_{i+1}} \\kappa \\dfrac{d\\varphi_{i+m-1}}{dx}\\dfrac{d\\varphi_{i+n-1}}{dx} \\,dx, \\quad \\text{其中 } m, n \\in \\{1, 2\\}\n$$\n在单元 $e_i = [x_i, x_{i+1}]$ 上，线性基函数的定义如下：\n$$\n\\varphi_i(x) = \\dfrac{x_{i+1} - x}{x_{i+1} - x_i}\n$$\n$$\n\\varphi_{i+1}(x) = \\dfrac{x - x_i}{x_{i+1} - x_i}\n$$\n该单元的长度为 $h_i = x_{i+1} - x_i$。这些基函数的导数在区间 $(x_i, x_{i+1})$ 上是常数：\n$$\n\\dfrac{d\\varphi_i}{dx} = -\\dfrac{1}{x_{i+1} - x_i} = -\\dfrac{1}{h_i}\n$$\n$$\n\\dfrac{d\\varphi_{i+1}}{dx} = \\dfrac{1}{x_{i+1} - x_i} = \\dfrac{1}{h_i}\n$$\n现在，我们计算单元刚度矩阵 $K^{(i)}$ 的四个元素。由于 $\\kappa$ 是一个常数，它可以被移到积分号外面。\n\n元素 $K^{(i)}_{11}$：\n$$\nK^{(i)}_{11} = \\int_{x_i}^{x_{i+1}} \\kappa \\left(\\dfrac{d\\varphi_i}{dx}\\right)^2 \\,dx = \\kappa \\int_{x_i}^{x_{i+1}} \\left(-\\dfrac{1}{h_i}\\right)^2 \\,dx = \\dfrac{\\kappa}{h_i^2} \\int_{x_i}^{x_{i+1}} \\,dx = \\dfrac{\\kappa}{h_i^2} (x_{i+1} - x_i) = \\dfrac{\\kappa}{h_i}\n$$\n元素 $K^{(i)}_{22}$：\n$$\nK^{(i)}_{22} = \\int_{x_i}^{x_{i+1}} \\kappa \\left(\\dfrac{d\\varphi_{i+1}}{dx}\\right)^2 \\,dx = \\kappa \\int_{x_i}^{x_{i+1}} \\left(\\dfrac{1}{h_i}\\right)^2 \\,dx = \\dfrac{\\kappa}{h_i^2} \\int_{x_i}^{x_{i+1}} \\,dx = \\dfrac{\\kappa}{h_i^2} (x_{i+1} - x_i) = \\dfrac{\\kappa}{h_i}\n$$\n元素 $K^{(i)}_{12}$ 和 $K^{(i)}_{21}$：\n$$\nK^{(i)}_{12} = K^{(i)}_{21} = \\int_{x_i}^{x_{i+1}} \\kappa \\left(\\dfrac{d\\varphi_i}{dx}\\right)\\left(\\dfrac{d\\varphi_{i+1}}{dx}\\right) \\,dx = \\kappa \\int_{x_i}^{x_{i+1}} \\left(-\\dfrac{1}{h_i}\\right)\\left(\\dfrac{1}{h_i}\\right) \\,dx = -\\dfrac{\\kappa}{h_i^2} \\int_{x_i}^{x_{i+1}} \\,dx = -\\dfrac{\\kappa}{h_i^2} (x_{i+1} - x_i) = -\\dfrac{\\kappa}{h_i}\n$$\n综合这些结果，单元刚度矩阵为：\n$$\nK^{(i)} = \\begin{pmatrix} \\dfrac{\\kappa}{h_i} & -\\dfrac{\\kappa}{h_i} \\\\ -\\dfrac{\\kappa}{h_i} & \\dfrac{\\kappa}{h_i} \\end{pmatrix} = \\dfrac{\\kappa}{h_i} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n最后一步是用给定的参数表示单元长度 $h_i$。节点坐标由几何级数 $x_j = x_a r^j$ 定义。因此，单元 $e_i$ 的长度是：\n$$\nh_i = x_{i+1} - x_i = x_a r^{i+1} - x_a r^i = x_a r^i (r - 1)\n$$\n将 $h_i$ 的这个表达式代入矩阵公式，得到单元刚度矩阵的最终形式：\n$$\nK^{(i)} = \\dfrac{\\kappa}{x_a r^i (r - 1)} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n该表达式仅取决于指定的参数 $\\kappa$、$x_a$、$i$ 和比率 $r$，而 $r$ 本身由 $x_a$、$x_b$ 和 $N$ 定义。推导至此完成。", "answer": "$$\n\\boxed{\\frac{\\kappa}{x_{a} r^{i} (r - 1)} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}}\n$$", "id": "2420728"}, {"introduction": "理论知识只有在解决具体问题时才能真正焕发生命力。本练习将带你走过一个完整的有限元分析流程：从建立弱形式，到组装并求解线性系统，最终得到一个带有集中点源的边界值问题的数值解 [@problem_id:2420776]。这个例子突显了伽辽金方法的强大之处，特别是它如何通过弱形式优雅地处理像狄拉克 $\\delta$ 函数这样的非标准源项。", "problem": "考虑区间 $[0,1]$ 上的边值问题：\n$$-u''(x) = \\delta(x - x_0), \\quad u(0)=0,\\quad u(1)=0,$$\n其中 $\\delta$ 是 Dirac delta 分布，且 $x_0=\\frac{3}{5}$ 不是一个网格节点。\n\n设定义域 $[0,1]$ 被划分为 $N=4$ 个相等的子区间，节点为 $x_i=\\frac{i}{4}$，其中 $i=0,1,2,3,4$。设 $V_h$ 是该网格上连续分段线性函数的空间，这些函数在边界处为零，由与内部节点 $x_1=\\frac{1}{4}$，$x_2=\\frac{1}{2}$ 和 $x_3=\\frac{3}{4}$ 相关联的标准帽子函数张成。设 $u_h \\in V_h$ 表示标准的伽辽金有限元近似解。\n\n计算在 $x_0=\\frac{3}{5}$ 处的 $u_h(x_0)$ 值。将您的答案表示为一个不带单位的纯数。将您的答案四舍五入到三位有效数字。", "solution": "给定问题是一个带点源的一维泊松方程边值问题。该问题将使用标准的伽辽金有限元方法和分段线性基函数来求解。\n\n问题陈述为：找到一个函数 $u(x)$ 使得\n$$ -u''(x) = \\delta(x - x_0), \\quad x \\in (0,1) $$\n边界条件为 $u(0)=0$ 和 $u(1)=0$。点源位于 $x_0 = \\frac{3}{5}$。\n\n首先，我们推导弱形式。设 $V = H_0^1(0,1)$ 是 Sobolev 空间，其中的函数具有平方可积的一阶导数，并在边界 $x=0$ 和 $x=1$ 处为零。我们将微分方程乘以一个任意的检验函数 $v \\in V$，并在定义域 $[0,1]$ 上积分：\n$$ -\\int_0^1 u''(x) v(x) \\,dx = \\int_0^1 \\delta(x - x_0) v(x) \\,dx $$\n对左侧应用分部积分，我们得到：\n$$ \\int_0^1 u'(x) v'(x) \\,dx - [u'(x)v(x)]_0^1 = \\int_0^1 \\delta(x - x_0) v(x) \\,dx $$\n由于 $v \\in H_0^1(0,1)$，我们有 $v(0)=0$ 和 $v(1)=0$，所以边界项 $[u'(x)v(x)]_0^1$ 为零。Dirac delta 分布的筛选性质简化了右侧：\n$$ \\int_0^1 \\delta(x - x_0) v(x) \\,dx = v(x_0) $$\n因此弱形式为：找到 $u \\in V$，使得对于所有的 $v \\in V$，\n$$ a(u, v) = L(v) $$\n其中双线性形式为 $a(u,v) = \\int_0^1 u'(x) v'(x) \\,dx$，线性泛函为 $L(v) = v(x_0)$。\n\n接下来，我们建立伽辽金问题。定义域 $[0,1]$ 被划分为 $N=4$ 个相等的子区间，节点位于 $x_i = \\frac{i}{4}$，其中 $i=0, 1, 2, 3, 4$。网格尺寸为 $h = x_{i+1} - x_i = \\frac{1}{4}$。有限元空间 $V_h \\subset V$ 由该网格上在 $x=0$ 和 $x=1$ 处为零的连续分段线性函数组成。$V_h$ 的基是与内部节点 $x_1=\\frac{1}{4}$，$x_2=\\frac{1}{2}$ 和 $x_3=\\frac{3}{4}$ 相关联的标准“帽子”函数集合 $\\{\\phi_j(x)\\}_{j=1}^3$。\n\n有限元近似解 $u_h \\in V_h$ 表示为这些基函数的线性组合：\n$$ u_h(x) = \\sum_{j=1}^3 U_j \\phi_j(x) $$\n其中 $U_j = u_h(x_j)$ 是未知的节点值。伽辽金方法旨在找到 $u_h \\in V_h$，使得对于所有 $v_h \\in V_h$ 都有 $a(u_h, v_h) = L(v_h)$。只需对每个基函数 $v_h = \\phi_i(x)$（$i=1, 2, 3$）强制满足此条件即可：\n$$ \\int_0^1 \\left( \\sum_{j=1}^3 U_j \\phi_j'(x) \\right) \\phi_i'(x) \\,dx = \\phi_i(x_0) $$\n这产生一个线性方程组 $A \\vec{U} = \\vec{f}$，其中 $\\vec{U} = (U_1, U_2, U_3)^T$，刚度矩阵 $A$ 的元素为 $A_{ij} = \\int_0^1 \\phi_i'(x) \\phi_j'(x) \\,dx$，载荷向量 $\\vec{f}$ 的元素为 $f_i = \\phi_i(x_0)$。\n\n我们计算刚度矩阵 $A$。帽子函数 $\\phi_i(x)$ 的导数是分段常数：\n$$ \\phi_i'(x) = \\begin{cases} \\frac{1}{h} & \\text{对于 } x \\in (x_{i-1}, x_i) \\\\ -\\frac{1}{h} & \\text{对于 } x \\in (x_i, x_{i+1}) \\\\ 0 & \\text{其他情况} \\end{cases} $$\n对于均匀网格，刚度矩阵的元素是标准的：\n$A_{ii} = \\int_{x_{i-1}}^{x_{i+1}} (\\phi_i'(x))^2 \\,dx = \\int_{x_{i-1}}^{x_i} (\\frac{1}{h})^2 \\,dx + \\int_{x_i}^{x_{i+1}} (-\\frac{1}{h})^2 \\,dx = \\frac{1}{h^2} (h) + \\frac{1}{h^2} (h) = \\frac{2}{h}$。\n$A_{i, i+1} = \\int_0^1 \\phi_i'(x) \\phi_{i+1}'(x) \\,dx = \\int_{x_i}^{x_{i+1}} (-\\frac{1}{h})(\\frac{1}{h}) \\,dx = -\\frac{1}{h^2} (h) = -\\frac{1}{h}$。\n根据对称性，$A_{i+1, i} = -\\frac{1}{h}$。所有其他非对角元素均为零。\n当 $h=\\frac{1}{4}$ 时，我们有 $\\frac{1}{h}=4$。刚度矩阵为：\n$$ A = \\frac{1}{h} \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix} = 4 \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix} = \\begin{pmatrix} 8 & -4 & 0 \\\\ -4 & 8 & -4 \\\\ 0 & -4 & 8 \\end{pmatrix} $$\n\n我们计算载荷向量 $\\vec{f}$。其元素为 $f_i = \\phi_i(x_0)$，其中 $x_0=\\frac{3}{5}=0.6$。节点为 $x_1=0.25$，$x_2=0.5$，$x_3=0.75$。点 $x_0=0.6$ 位于子区间 $[x_2, x_3] = [0.5, 0.75]$ 内。在此区间内，只有 $\\phi_2(x)$ 和 $\\phi_3(x)$ 非零。\n因此，$f_1 = \\phi_1(x_0)=0$。\n$f_2 = \\phi_2(x_0) = \\frac{x_3 - x_0}{h} = \\frac{\\frac{3}{4} - \\frac{3}{5}}{\\frac{1}{4}} = \\frac{\\frac{15-12}{20}}{\\frac{1}{4}} = \\frac{3}{20} \\cdot 4 = \\frac{3}{5}$。\n$f_3 = \\phi_3(x_0) = \\frac{x_0 - x_2}{h} = \\frac{\\frac{3}{5} - \\frac{1}{2}}{\\frac{1}{4}} = \\frac{\\frac{6-5}{10}}{\\frac{1}{4}} = \\frac{1}{10} \\cdot 4 = \\frac{2}{5}$。\n载荷向量为 $\\vec{f} = (0, \\frac{3}{5}, \\frac{2}{5})^T$。\n\n现在，我们求解线性系统 $A \\vec{U} = \\vec{f}$：\n$$ \\begin{pmatrix} 8 & -4 & 0 \\\\ -4 & 8 & -4 \\\\ 0 & -4 & 8 \\end{pmatrix} \\begin{pmatrix} U_1 \\\\ U_2 \\\\ U_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{3}{5} \\\\ \\frac{2}{5} \\end{pmatrix} $$\n由第一个方程，$8U_1 - 4U_2 = 0 \\implies U_1 = \\frac{1}{2}U_2$。\n第二个和第三个方程构成一个关于 $U_2$ 和 $U_3$ 的方程组：\n$$ -4U_2 + 8U_3 = \\frac{2}{5} \\implies -2U_2 + 4U_3 = \\frac{1}{5} \\quad (1) $$\n$$ -4 (\\frac{1}{2}U_2) + 8U_2 - 4U_3 = \\frac{3}{5} \\implies -2U_2 + 8U_2 - 4U_3 = \\frac{3}{5} \\implies 6U_2 - 4U_3 = \\frac{3}{5} \\quad (2) $$\n将方程 (1) 和方程 (2) 相加：\n$$ (-2U_2 + 4U_3) + (6U_2 - 4U_3) = \\frac{1}{5} + \\frac{3}{5} $$\n$$ 4U_2 = \\frac{4}{5} \\implies U_2 = \\frac{1}{5} $$\n将 $U_2=\\frac{1}{5}$ 代入 (1)：\n$$ -2(\\frac{1}{5}) + 4U_3 = \\frac{1}{5} \\implies 4U_3 = \\frac{3}{5} \\implies U_3 = \\frac{3}{20} $$\n最后，$U_1 = \\frac{1}{2}U_2 = \\frac{1}{2}(\\frac{1}{5}) = \\frac{1}{10}$。\n节点值为 $\\vec{U} = (\\frac{1}{10}, \\frac{1}{5}, \\frac{3}{20})^T$。\n\n任务是计算 $u_h(x_0)$。由于 $x_0 \\in [x_2, x_3]$，解 $u_h(x_0)$ 由节点值 $U_2$ 和 $U_3$ 之间的线性插值确定。在此区间上，$u_h(x)$ 的公式为：\n$$ u_h(x) = U_2 \\phi_2(x) + U_3 \\phi_3(x), \\quad x \\in [x_2, x_3] $$\n我们在 $x=x_0=\\frac{3}{5}$ 处计算该值：\n$$ u_h(x_0) = U_2 \\phi_2(x_0) + U_3 \\phi_3(x_0) $$\n我们已经计算出 $U_2 = \\frac{1}{5}$，$U_3 = \\frac{3}{20}$，$\\phi_2(x_0) = \\frac{3}{5}$ 和 $\\phi_3(x_0) = \\frac{2}{5}$。\n代入这些值：\n$$ u_h(\\frac{3}{5}) = (\\frac{1}{5}) (\\frac{3}{5}) + (\\frac{3}{20}) (\\frac{2}{5}) = \\frac{3}{25} + \\frac{6}{100} = \\frac{12}{100} + \\frac{6}{100} = \\frac{18}{100} = \\frac{9}{50} $$\n作为小数，这等于 $0.18$。问题要求答案四舍五入到三位有效数字。因此，该值为 $0.180$。", "answer": "$$\\boxed{0.180}$$", "id": "2420776"}, {"introduction": "有限元方法的强大威力在于其处理复杂几何形状的能力。这个概念性练习促使你思考，当我们将一维线段推广到更复杂的网络结构（如一个 Y 形交点）时，标准的组装过程应如何适应 [@problem_id:2420714]。通过分析这个问题，你将巩固对“散布相加”（scatter-add）组装核心思想的理解，即通过共享自由度来保证连续性，并通过叠加所有邻近单元的贡献来自然地满足物理守恒律。", "problem": "考虑一个由三条长度分别为 $\\ell_1$, $\\ell_2$ 和 $\\ell_3$ 的直边 $\\Gamma_1$, $\\Gamma_2$ 和 $\\Gamma_3$ 构成的一维网络（一个度量图）。这些边在单个内部连接节点 $J$ 处相交，并且每条边都有一个施加了 Dirichlet 边界条件的外部端点。在每条边 $\\Gamma_i$ 上，使用局部坐标 $s \\in [0,\\ell_i]$，场 $u_i(s)$ 满足稳态扩散方程\n$$\n- \\frac{d}{ds}\\!\\left(k_i(s)\\,\\frac{d u_i}{ds}\\right) = f_i(s)，\n$$\n其中 $k_i(s) > 0$ 是给定的传导系数，$f_i(s)$ 是给定的源项。你使用标准的伽辽金有限元法 (FEM)，其基函数是在包含连接节点 $J$ 的网络协调网格上定义的连续分段线性帽函数。有限元试探和检验空间由在 $J$ 处连续且在每条边上分段线性的标量函数组成。\n\n在组装全局刚度矩阵和载荷向量时，与单条线上的常规组装（其中内部节点的度为 $2$）相比，共享的连接节点 $J$ 应如何处理？\n\n选择最准确的陈述。\n\nA) 使用与 $J$ 相关联的单个全局自由度。在组装过程中，将来自每条相邻边的所有单元贡献散布相加到 $J$ 对应的同一全局行和列，以及同一载荷项中。对应 $J$ 的帽状基函数在 $J$ 点处等于 $1$，并沿每条相邻边线性递减，因此其支集覆盖所有相邻单元；由此产生的代数方程自动反映了连接点处的通量平衡。\n\nB) 用 $3$ 个独立的全局自由度（每条相邻边一个）替换 $J$，以避免组装过程中的重复计算，然后在组装无约束系统后使用 Lagrange 乘子来强制施加 $J$ 处的连续性。\n\nC) 在 $J$ 处保留单个全局自由度，但通过将与 $J$ 相关的对角线项和右端项除以 $3$ 来对组装的贡献进行平均，以补偿 $3$ 个相邻单元。\n\nD) 在 $J$ 处保留单个全局自由度，像在一条线上一样进行组装，然后附加一个额外的代数约束方程来施加 $J$ 处流出通量之和为零的条件；没有这个额外的方程，标准的有限元组装无法强制执行连接点处的通量平衡。\n\nE) 仅将与 $J$ 相关的刚度对角项乘以节点度 $3$ 进行缩放，并保持非对角项不变，以捕捉由额外相邻边引入的附加刚度。", "solution": "首先对问题陈述进行严格验证。\n\n### 步骤 1：提取已知条件\n- **区域**：一个由 $3$ 条直边 $\\Gamma_1$, $\\Gamma_2$, $\\Gamma_3$ 组成的一维网络（度量图）。\n- **边长**：$\\ell_1$, $\\ell_2$, $\\ell_3$。\n- **拓扑结构**：各边在单个内部连接节点 $J$ 处相交。每条边有一个外部端点。\n- **边界条件**：在外部端点上施加 Dirichlet 边界条件。\n- **控制方程**：在每条边 $\\Gamma_i$ 上，使用局部坐标 $s \\in [0,\\ell_i]$，场 $u_i(s)$ 满足稳态扩散方程：\n$$ - \\frac{d}{ds}\\!\\left(k_i(s)\\,\\frac{d u_i}{ds}\\right) = f_i(s) $$\n- **参数**：传导系数 $k_i(s) > 0$ 和源项 $f_i(s)$ 是在每条边上给定的函数。\n- **数值方法**：标准伽辽金有限元法 (FEM)。\n- **函数空间**：试探和检验空间由在连接节点 $J$ 处连续且在每条边上分段线性的标量函数组成。\n- **网格**：网格是协调的，并包含节点 $J$。\n- **问题**：与单条线上的内部节点（度为 $2$）相比，连接节点 $J$ 的组装是如何处理的？\n\n### 步骤 2：使用提取的已知条件进行验证\n根据所需标准对问题进行验证。\n\n- **科学依据**：该问题描述了在度量图上将有限元法应用于二阶椭圆偏微分方程（扩散方程）。这是计算工程和应用数学中一个标准的、成熟的课题。扩散的物理原理和伽辽金方法的数学基础都是基本且可靠的。该问题具有科学依据。\n- **适定性**：该问题要求在一个协调有限元框架中针对特定节点类型给出正确的组装程序。这个问题定义明确，并且基于伽辽金方法的原理有一个唯一的正确答案。其下的边界值问题，具有连接点处的连续性和端点处的 Dirichlet 条件，是适定的。\n- **客观性**：该问题以精确的技术语言陈述。它没有歧义、主观性或个人观点。\n- **完整性和一致性**：该问题提供了确定正确组装程序所需的所有信息。它定义了区域、控制方程、边界条件以及用于有限元逼近的函数空间。不存在矛盾。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。这是计算科学中一个标准的、适定的问题。现在将从第一性原理推导出解决方案。\n\n### 解的推导\n\n伽辽金有限元法的基础是边界值问题的弱形式。设总区域为 $\\Gamma = \\Gamma_1 \\cup \\Gamma_2 \\cup \\Gamma_3$。控制方程为\n$$ - \\frac{d}{ds}\\!\\left(k_i(s)\\,\\frac{d u_i}{ds}\\right) = f_i(s) \\quad \\text{在每条 } \\Gamma_i \\text{ 上} $$\n我们将其乘以一个来自适当空间的检验函数 $v$，并在整个区域 $\\Gamma$ 上积分。检验函数空间 $V$ 由在 $\\Gamma$ 上连续并且在指定了 Dirichlet 条件的边界部分上为零的函数组成。\n$$ \\sum_{i=1}^3 \\int_{\\Gamma_i} - \\frac{d}{ds}\\!\\left(k_i(s)\\,\\frac{d u_i}{ds}\\right) v_i(s) \\, ds = \\sum_{i=1}^3 \\int_{\\Gamma_i} f_i(s) v_i(s) \\, ds $$\n对每条边上的积分，在左手边应用分部积分（Green 第一恒等式）：\n$$ \\sum_{i=1}^3 \\left[ \\int_{\\Gamma_i} k_i(s)\\,\\frac{d u_i}{ds}\\,\\frac{d v_i}{ds} \\, ds - \\left[ k_i(s)\\,\\frac{d u_i}{ds}\\,v_i(s) \\right]_{\\partial\\Gamma_i} \\right] = \\sum_{i=1}^3 \\int_{\\Gamma_i} f_i(s) v_i(s) \\, ds $$\n每条边的边界 $\\partial\\Gamma_i$ 由连接节点 $J$ 和一个外部端点组成。根据 Dirichlet 问题的检验空间的定义，检验函数 $v$ 在所有外部端点处为零。因此，唯一不为零的边界项在连接节点 $J$ 处。让我们在每条边上定向局部坐标 $s$，使得 $s=0$ 对应于连接节点 $J$。边界项之和变为：\n$$ \\sum_{i=1}^3 \\left( -k_i(\\ell_i)\\frac{du_i}{ds}(\\ell_i)v_i(\\ell_i) + k_i(0)\\frac{du_i}{ds}(0)v_i(0) \\right) $$\n由于 $v_i(\\ell_i) = 0$（外部端点），我们剩下：\n$$ \\sum_{i=1}^3 k_i(0)\\frac{du_i}{ds}(0)v_i(0) $$\n问题陈述指出，试探函数和检验函数的函数空间在 $J$ 处是连续的。这意味着 $v_1(0) = v_2(0) = v_3(0) = v(J)$，这是一个公共值。我们可以将其提取出来：\n$$ v(J) \\sum_{i=1}^3 k_i(0)\\frac{d u_i}{ds}(0) $$\n守恒的物理原理要求连接点处的通量之和为零。在连接点处离开边 $\\Gamma_i$ 的通量是 $F_i = -k_i(0)\\frac{du_i}{ds}(0)$。守恒定律（基尔霍夫电流定律）是 $\\sum_i F_i = 0$，这意味着 $\\sum_i k_i(0)\\frac{du_i}{ds}(0) = 0$。\n这个条件，被称为自然边界条件，导致弱形式中的边界项消失。得到的弱形式是：找到 $u$（满足连续性和 Dirichlet 条件），使得对于所有检验函数 $v$:\n$$ a(u, v) \\equiv \\sum_{i=1}^3 \\int_{\\Gamma_i} k_i\\,\\frac{du}{ds}\\,\\frac{dv}{ds} \\, ds = \\sum_{i=1}^3 \\int_{\\Gamma_i} f_i\\,v \\, ds \\equiv L(v) $$\n这个弱形式是离散有限元系统的基础。其关键前提是积分的可加性以及试探和检验函数在连接节点 $J$ 处的连续性。\n\n在离散情况下，通过为节点 $J$ 分配一个**单一的**全局自由度（比如 $U_J$）来强制实现 $J$ 处的连续性。相应的基函数 $\\phi_J(s)$ 定义为在节点 $J$ 处为 $1$，在所有其他节点处为 $0$。由于函数是分段线性的，$\\phi_J$ 仅在直接连接到 $J$ 的单元上非零——即来自三个相邻边 $\\Gamma_1, \\Gamma_2, \\Gamma_3$ 的各一个单元。\n\n全局刚度矩阵 $K$ 和载荷向量 $F$ 的组装直接源于弱形式。矩阵项 $K_{IJ}$ 是 $a(\\phi_J, \\phi_I)$，向量项 $F_I$ 是 $L(\\phi_I)$。对于对应于连接节点 $J$ 的对角项，我们有：\n$$ K_{JJ} = a(\\phi_J, \\phi_J) = \\sum_{i=1}^3 \\int_{\\Gamma_i} k_i \\left( \\frac{d\\phi_J}{ds} \\right)^2 ds $$\n由于 $\\phi_J$ 的支集仅限于与 $J$ 相邻的三个单元，该积分就变成了在这三个单元上积分的总和。在实践中，这是通过计算这三个单元中每一个的局部单元刚度矩阵，然后将对应节点 $J$ 的局部项加到单一的全局项 $K_{JJ}$ 中来实现的。同样的“散布相加”过程也适用于涉及 $J$ 的非对角项以及全局载荷向量项 $F_J$。这个过程在原则上与度为 $2$ 的标准内部节点的组装相同；唯一的区别是，这里是三个单元的贡献相加，而不是两个。由此产生的节点 $J$ 的离散方程是通量平衡条件的离散表示。\n\n### 逐项分析\n\n**A) 使用与 $J$ 相关联的单个全局自由度。在组装过程中，将来自每条相邻边的所有单元贡献散布相加到 $J$ 对应的同一全局行和列，以及同一载荷项中。对应 $J$ 的帽状基函数在 $J$ 点处等于 $1$，并沿每条相邻边线性递减，因此其支集覆盖所有相邻单元；由此产生的代数方程自动反映了连接点处的通量平衡。**\n这个陈述是对标准协调伽辽金有限元程序的精确和完整描述。单个自由度强制实现了连续性。“散布相加”操作正确地实现了弱形式中积分的求和。对帽函数的描述是准确的。关键是，它正确地指出通量平衡是这种公式的自动结果。\n**结论：正确**\n\n**B) 用 $3$ 个独立的全局自由度（每条相邻边一个）替换 $J$，以避免组装过程中的重复计算，然后在组装无约束系统后使用 Lagrange 乘子来强制施加 $J$ 处的连续性。**\n这描述了一种有效但不同的数值方法，类似于混合或不连续伽辽金方法。它违反了问题的前提，即使用一个在 $J$ 处*先验*连续的函数空间。如题目所述，标准的协调伽辽金方法不使用 Lagrange 乘子来强制连续性；连续性是通过共享一个自由度直接构建在函数空间中的。\n**结论：不正确**\n\n**C) 在 $J$ 处保留单个全局自由度，但通过将与 $J$ 相关的对角线项和右端项除以 $3$ 来对组装的贡献进行平均，以补偿 $3$ 个相邻单元。**\n这是根本错误的。弱形式涉及在组成域上的积分求和，而不是平均。对贡献进行平均在伽辽金方法中没有数学基础，并且会违反系统的能量表示，导致不正确的解。\n**结论：不正确**\n\n**D) 在 $J$ 处保留单个全局自由度，像在一条线上一样进行组装，然后附加一个额外的代数约束方程来施加 $J$ 处流出通量之和为零的条件；没有这个额外的方程，标准的有限元组装无法强制执行连接点处的通量平衡。**\n这在两点上是不正确的。首先，“像在一条线上一样组装”是模棱两可的，并且很可能是错误的，因为它忽略了第三条相邻边。其次，更重要的是，对于这个问题，标准伽辽金公式的一个关键特征是，连接点处的通量平衡是一个*自然边界条件*。它由弱形式隐式满足，不需要一个单独的、显式的约束方程。关于标准有限元*无法*强制实现这种平衡的说法是错误的。\n**结论：不正确**\n\n**E) 仅将与 $J$ 相关的刚度对角项乘以节点度 $3$ 进行缩放，并保持非对角项不变，以捕捉由额外相邻边引入的附加刚度。**\n这提出了一种与有限元推导不一致的临时修改。对角项 $K_{JJ}$ 是来自三个相邻单元的三个不同贡献的总和，除非这三个单元完全相同，否则这通常不等同于将单个贡献乘以 $3$。此外，非对角项 $K_{Jm}$（对于与 $J$ 相邻的节点 $m$）也是通过求和组装的，而不是“不变的”。这个程序是随意的，也是不正确的。\n**结论：不正确**", "answer": "$$\\boxed{A}$$", "id": "2420714"}]}