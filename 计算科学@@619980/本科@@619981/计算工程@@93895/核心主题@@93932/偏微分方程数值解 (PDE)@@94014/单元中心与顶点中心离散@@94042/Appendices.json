{"hands_on_practices": [{"introduction": "数值稳定性是任何时间演化模拟的基石。本实践将通过分析一维热传导方程来探讨稳定性，这是一个典型的抛物型偏微分方程。通过这个练习，你将运用冯·诺依曼稳定性分析来推导显式和隐式时间积分格式的稳定性条件，并发现一个重要结论：在简单的均匀网格上，以单元为中心和以顶点为中心的离散选择可能不会改变稳定性约束 [@problem_id:2376145]。", "problem": "考虑一维热传导方程 $u_{t}=\\alpha\\,u_{xx}$，定义在周期性空间域 $[0,L]$ 上，其中 $\\alpha>0$ 为恒定的热扩散系数。设空间网格是均匀的，间距为 $h>0$。考虑两种空间离散化方法：\n\n- 以顶点为中心：未知量存储在顶点 $x_{j}=j\\,h$ 处，其中 $j\\in\\{0,1,\\dots,N-1\\}$ 且 $N=L/h$ 是一个整数，采用周期性索引。每个顶点的二阶导数通过中心差分 $(u_{j-1}-2u_{j}+u_{j+1})/h^{2}$ 来近似。\n\n- 以单元为中心：未知量存储在单元中心 $x_{j+\\frac{1}{2}}=(j+\\tfrac{1}{2})\\,h$ 处，其中 $j\\in\\{0,1,\\dots,N-1\\}$ 且 $N=L/h$ 是一个整数，采用周期性索引。空间算子通过在均匀单元上的保守有限体积公式得到，从而在单元中心产生二阶中心差分格式 $(u_{j-1}-2u_{j}+u_{j+1})/h^{2}$。\n\n对于时间推进，考虑显式前向欧拉法和隐式后向欧拉法。定义无量纲时间步长参数 $\\nu=\\alpha\\,\\Delta t/h^{2}$。\n\n对于这四种组合（以顶点为中心的显式时间步进、以顶点为中心的隐式时间步进、以单元为中心的显式时间步进、以单元为中心的隐式时间步进），比较以 $\\nu$ 表示的数值绝对稳定区域，然后确定这四种组合中 $\\nu$ 的最小有限上界，并将任何无条件稳定性解释为没有有限上界。请以精确值的形式给出最终答案。", "solution": "所述问题具有科学依据、是适定的且客观的。不存在会妨碍进行严格分析的矛盾或缺失数据。所提供的信息足以对所有指定的数值格式进行完整的稳定性分析。\n\n控制偏微分方程为一维热传导方程：\n$$\nu_{t} = \\alpha u_{xx}\n$$\n其中 $u=u(x,t)$ 是温度，$t$ 是时间，$x$ 是周期性域 $[0,L]$ 上的空间坐标，$\\alpha > 0$ 是恒定的热扩散系数。\n\n问题指定了一个间距为 $h$ 的均匀空间网格。对于以顶点为中心和以单元为中心的方法，在索引为 $j$ 的网格点上，二阶导数 $u_{xx}$ 的空间离散化均由相同的中心差分公式给出：\n$$\n(u_{xx})_j \\approx \\frac{u_{j-1} - 2u_j + u_{j+1}}{h^2}\n$$\n这对于两种空间离散化策略都导出了相同的常微分方程组 (ODE)，即该偏微分方程的一种半离散化形式：\n$$\n\\frac{du_j}{dt} = \\frac{\\alpha}{h^2} (u_{j-1} - 2u_j + u_{j+1})\n$$\n以顶点为中心和以单元为中心的格式之间的唯一区别在于节点 $x_j$ 的物理位置，但这并不改变耦合 ODE 系统的数学结构或其稳定性。因此，对于给定的时间步进方法，以顶点为中心和以单元为中心的格式的稳定性分析将产生相同的结果。我们只需要分析两种指定的时间积分格式。\n\n我们进行冯·诺依曼稳定性分析。我们将单个傅里叶模态视为半离散系统的解：\n$$\nu_j(t) = \\hat{u}(t, k) e^{i k x_j}\n$$\n其中 $k$ 是波数，$i = \\sqrt{-1}$。对于两种格式，节点的相对位置是 $x_{j\\pm 1} = x_j \\pm h$。将该模态代入半离散方程，得到：\n$$\n\\frac{d\\hat{u}}{dt} e^{i k x_j} = \\frac{\\alpha}{h^2} \\left( \\hat{u} e^{i k (x_j-h)} - 2\\hat{u} e^{i k x_j} + \\hat{u} e^{i k (x_j+h)} \\right)\n$$\n两边同除以 $e^{i k x_j}$ 并提出公因子 $\\hat{u}$，得到关于傅里叶振幅 $\\hat{u}$ 的一个 ODE：\n$$\n\\frac{d\\hat{u}}{dt} = \\frac{\\alpha}{h^2} \\hat{u} (e^{-ik h} - 2 + e^{ik h})\n$$\n使用恒等式 $e^{i\\phi} + e^{-i\\phi} = 2\\cos(\\phi)$，上式变为：\n$$\n\\frac{d\\hat{u}}{dt} = \\frac{2\\alpha}{h^2} (\\cos(kh) - 1) \\hat{u}\n$$\n使用半角恒等式 $1 - \\cos(\\phi) = 2\\sin^2(\\phi/2)$，我们得到：\n$$\n\\frac{d\\hat{u}}{dt} = -\\frac{4\\alpha}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\hat{u}\n$$\n这是一个形如 $\\frac{d\\hat{u}}{dt} = \\lambda_k \\hat{u}$ 的方程，其中空间离散化算子的特征值为 $\\lambda_k = -\\frac{4\\alpha}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right)$。\n\n现在，我们通过应用时间步进格式来分析完全离散化的稳定性。傅里叶振幅的时间演化由 $\\hat{u}^{n+1} = G(k) \\hat{u}^n$ 给出，其中 $G(k)$ 是放大因子。为保证稳定性，我们要求对于网格所支持的所有波数 $k$，都有 $|G(k)| \\le 1$。\n\n情况1：显式前向欧拉时间步进\n该格式为 $u_j^{n+1} = u_j^n + \\Delta t \\left( \\frac{\\alpha}{h^2} (u_{j-1}^n - 2u_j^n + u_{j+1}^n) \\right)$。在傅里叶空间中，这变为 $\\hat{u}^{n+1} = \\hat{u}^n + \\Delta t \\lambda_k \\hat{u}^n$。放大因子为：\n$$\nG_{FE}(k) = 1 + \\lambda_k \\Delta t = 1 - \\frac{4\\alpha \\Delta t}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right)\n$$\n定义无量纲时间步长 $\\nu = \\frac{\\alpha \\Delta t}{h^2}$，我们有：\n$$\nG_{FE}(k) = 1 - 4\\nu \\sin^2\\left(\\frac{kh}{2}\\right)\n$$\n稳定性条件 $|G_{FE}(k)| \\le 1$ 意味着：\n$$\n-1 \\le 1 - 4\\nu \\sin^2\\left(\\frac{kh}{2}\\right) \\le 1\n$$\n右侧的不等式 $1 - 4\\nu \\sin^2(kh/2) \\le 1$ 可简化为 $-4\\nu \\sin^2(kh/2) \\le 0$，由于 $\\nu > 0$，该不等式恒成立。左侧的不等式 $-1 \\le 1 - 4\\nu \\sin^2(kh/2)$ 给出：\n$$\n4\\nu \\sin^2\\left(\\frac{kh}{2}\\right) \\le 2 \\implies \\nu \\le \\frac{1}{2\\sin^2(kh/2)}\n$$\n此条件必须对所有 $k$ 成立。最严格的情况出现在使得 $\\sin^2(kh/2)$ 最大的波数。其最大可能值为 $1$，对应于网格上最高频率的模态，此时 $kh=\\pi$。因此，稳定性要求为：\n$$\n\\nu \\le \\frac{1}{2}\n$$\n这个稳定性限制同时适用于以顶点为中心和以单元为中心的显式格式。稳定区域是 $\\nu \\in [0, 1/2]$，因此有限上界是 $1/2$。\n\n情况2：隐式后向欧拉时间步进\n该格式为 $u_j^{n+1} = u_j^n + \\Delta t \\left( \\frac{\\alpha}{h^2} (u_{j-1}^{n+1} - 2u_j^{n+1} + u_{j+1}^{n+1}) \\right)$。在傅里叶空间中，这表示为 $\\hat{u}^{n+1} = \\hat{u}^n + \\Delta t \\lambda_k \\hat{u}^{n+1}$，可得 $\\hat{u}^{n+1}(1 - \\lambda_k \\Delta t) = \\hat{u}^n$。放大因子为：\n$$\nG_{BE}(k) = \\frac{1}{1 - \\lambda_k \\Delta t} = \\frac{1}{1 + \\frac{4\\alpha \\Delta t}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right)}\n$$\n以 $\\nu$ 表示：\n$$\nG_{BE}(k) = \\frac{1}{1 + 4\\nu \\sin^2\\left(\\frac{kh}{2}\\right)}\n$$\n为保证稳定性，我们要求 $|G_{BE}(k)| \\le 1$。由于 $\\nu > 0$ 且 $\\sin^2(kh/2) \\ge 0$，分母总是大于或等于 $1$。因此，对于所有波数 $k$ 和任何 $\\nu > 0$，都有 $0 < G_{BE}(k) \\le 1$。该格式是无条件稳定的。此结果适用于以顶点为中心和以单元为中心的隐式格式。对 $\\nu$ 没有有限上界。\n\n稳定性区域和上界总结：\n- 以顶点为中心，显式欧拉法：条件稳定，$\\nu$ 的上界是 $1/2$。\n- 以顶点为中心，隐式欧拉法：无条件稳定，对 $\\nu$ 没有有限上界。\n- 以单元为中心，显式欧拉法：条件稳定，$\\nu$ 的上界是 $1/2$。\n- 以单元为中心，隐式欧拉法：无条件稳定，对 $\\nu$ 没有有限上界。\n\n题目要求这四种组合中 $\\nu$ 的最小有限上界。有限上界的集合是 $\\{1/2, 1/2\\}$。该集合中的最小值是 $1/2$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2376145"}, {"introduction": "真实世界的模拟常常涉及复杂的几何形状和各向异性材料，这要求我们的数值方法必须在非理想网格上保持准确。本实践将探讨在非正交（倾斜）网格上的各向异性扩散问题，这种情况会凸显出当通量方向与网格线不一致时产生的“交叉扩散”误差。通过这个练习，你将量化一个简单的以单元为中心的通量近似方案的局限性，并将其与能够精确重构完整梯度、从而更准确的顶点中心方案进行对比 [@problem_id:2376138]，这对在复杂工程问题中选择合适的离散化方案至关重要。", "problem": "考虑二维稳态各向异性扩散通量，该通量由菲克定律（Fick’s law）给出。其中，扩散通量矢量由基本本构关系 $\\,\\mathbf{q} = -\\mathbf{K}\\,\\nabla u\\,$ 定义，$\\,\\mathbf{K}\\,$ 是一个对称正定张量。对于一个具有单位外法向量 $\\,\\mathbf{n}\\,$ 和长度为 $\\,L\\,$ 的控制体表面，穿过该表面的精确积分扩散通量是面积分 $\\,\\Phi = \\int_{\\text{face}} \\mathbf{q}\\cdot\\mathbf{n}\\, \\mathrm{d}S\\,$。对于线性场 $\\,u(\\mathbf{x})\\,$ 和平直表面，该积分简化为 $\\,\\Phi = -L\\,\\mathbf{n}\\cdot \\mathbf{K}\\,\\nabla u\\,$。我们将比较在非正交网格上的两种有限体积离散化方法，并量化它们对交叉扩散项的处理。这两种方案是：单元中心的的两点通量近似和节点中心的线性重构近似。\n\n我们关注一个通过映射 $\\,\\mathcal{M}:\\ (\\xi,\\eta)\\mapsto (x,y)\\,$（定义为 $\\,x=\\xi + s\\,\\eta\\,$ 和 $\\,y=\\eta\\,$）得到的倾斜平行四边形网格中的单个内部面，其中 $\\,s\\,$ 是倾斜参数。考虑计算空间中直线 $\\,\\xi=0\\,$ 在 $\\,\\eta\\in[-\\tfrac{1}{2},\\tfrac{1}{2}]\\,$ 上的像所对应的面。两个相邻的单元中心是 $\\,(\\xi,\\eta)=(-\\tfrac{1}{2},0)\\,$ 和 $\\,(\\tfrac{1}{2},0)\\,$ 的像。对于此配置，精确的面长度矢量等于 $\\,\\mathbf{A}_f = L\\,\\mathbf{n} = (1,-s)\\,$，因此对于具有恒定梯度 $\\,\\nabla u=\\mathbf{g}\\,$ 的线性场，精确的积分通量为\n$$\n\\Phi_{\\text{exact}} \\;=\\; -\\,\\mathbf{A}_f \\cdot \\big(\\mathbf{K}\\,\\mathbf{g}\\big) \\;=\\; -\\,(1,-s)\\cdot\\big(\\mathbf{K}\\,\\mathbf{g}\\big).\n$$\n我们将比较针对同一表面的以下两种离散化方法：\n\n- 单元中心两点通量近似 (CC-TPFA)：通过梯度在连接两个单元中心的直线上的投影来近似梯度。令 $\\,\\mathbf{d}\\,$ 为从左单元中心指向右单元中心的矢量。对于我们的配置，$\\,\\mathbf{d}=(1,0)\\,$，其单位方向为 $\\,\\hat{\\mathbf{d}}=(1,0)\\,$。两点梯度近似为 $\\,\\nabla u \\approx (\\mathbf{g}\\cdot \\hat{\\mathbf{d}})\\,\\hat{\\mathbf{d}}\\,$，相应的积分通量近似为\n$$\n\\Phi_{\\text{CC}} \\;=\\; -\\,\\mathbf{A}_f \\cdot \\Big(\\mathbf{K}\\,\\big[(\\mathbf{g}\\cdot \\hat{\\mathbf{d}})\\,\\hat{\\mathbf{d}}\\big]\\Big).\n$$\n当 $\\,\\mathbf{K}\\,$ 是各向异性或 $\\,\\mathbf{g}\\,$ 有一个不与 $\\,\\hat{\\mathbf{d}}\\,$ 对齐的重要分量时，该近似忽略了 $\\,\\nabla u\\,$ 相对于 $\\,\\hat{\\mathbf{d}}\\,$ 的切向分量，因此忽略了由非正交性引起的交叉扩散。\n\n- 节点中心线性重构 (VC-LR)：通过对表面附近的三个不共线的网格节点上的值拟合一个平面 $\\,u(x,y)=c + a\\,x + b\\,y\\,$，来重构完整梯度，从而得到一个估计值 $\\,\\widehat{\\nabla u}=(a,b)^\\top\\,$。对于线性场，这种重构是精确的。相应的积分通量近似为\n$$\n\\Phi_{\\text{VC}} \\;=\\; -\\,\\mathbf{A}_f \\cdot \\big(\\mathbf{K}\\,\\widehat{\\nabla u}\\big).\n$$\n\n假设一个线性人造解 $\\,u(x,y) = a\\,x + b\\,y + c\\,$，其梯度为常数 $\\,\\mathbf{g}=(a,b)^\\top\\,$。假设一个对称各向异性张量\n$$\n\\mathbf{K} \\;=\\; \\begin{bmatrix} k_{xx} & k_{xy} \\\\ k_{xy} & k_{yy}\\end{bmatrix},\n$$\n其中 $\\,k_{xx}>0\\,$, $\\,k_{yy}>0\\,$ 且 $\\,k_{xx}\\,k_{yy} - k_{xy}^2 > 0\\,$。对于节点中心的重构，使用通过映射 $\\,\\mathcal{M}\\,$ 从计算坐标 $\\,(\\xi,\\eta)\\in\\{(0,-\\tfrac{1}{2}),(0,\\tfrac{1}{2}),(\\,1,0)\\}\\,$ 获得的三个物理空间顶点，即面两端的两个顶点和右侧的一个顶点，以形成一个非退化三角形。\n\n您的任务是实现一个程序，对下面的每个测试用例，计算以下两个绝对通量误差：\n$$\nE_{\\text{CC}} \\;=\\; \\big|\\Phi_{\\text{CC}} - \\Phi_{\\text{exact}}\\big|\\,,\\qquad\nE_{\\text{VC}} \\;=\\; \\big|\\Phi_{\\text{VC}} - \\Phi_{\\text{exact}}\\big|.\n$$\n将所有测试用例的结果以逗号分隔的扁平列表形式在单行中报告，并用方括号括起来，顺序为 $[E_{\\text{CC}}^{(1)},E_{\\text{VC}}^{(1)},E_{\\text{CC}}^{(2)},E_{\\text{VC}}^{(2)},\\dots]$。\n\n本问题中没有物理单位；所有量都是无量纲的。不使用角度。\n\n测试套件参数如下，每个案例指定倾斜度 $\\,s\\,$、张量分量 $\\,k_{xx},k_{yy},k_{xy}\\,$ 和梯度分量 $\\,a,b\\,$：\n\n- 案例 $\\,1\\,$ (正常路径，中等倾斜，对角各向异性，混合梯度)：$\\,s=0.3\\,$, $\\,k_{xx}=2.0\\,$, $\\,k_{yy}=1.0\\,$, $\\,k_{xy}=0.0\\,$, $\\,a=1.0\\,$, $\\,b=-0.5\\,$.\n- 案例 $\\,2\\,$ (边缘情况，强倾斜，对角各向异性，相等分量)：$\\,s=0.9\\,$, $\\,k_{xx}=2.0\\,$, $\\,k_{yy}=1.0\\,$, $\\,k_{xy}=0.0\\,$, $\\,a=1.0\\,$, $\\,b=1.0\\,$.\n- 案例 $\\,3\\,$ (边缘情况，强各向异性，对角，梯度由切向分量主导)：$\\,s=0.5\\,$, $\\,k_{xx}=10.0\\,$, $\\,k_{yy}=1.0\\,$, $\\,k_{xy}=0.0\\,$, $\\,a=0.2\\,$, $\\,b=2.0\\,$.\n- 案例 $\\,4\\,$ (边界条件替代，正交网格)：$\\,s=0.0\\,$, $\\,k_{xx}=2.0\\,$, $\\,k_{yy}=1.0\\,$, $\\,k_{xy}=0.0\\,$, $\\,a=1.0\\,$, $\\,b=0.5\\,$.\n- 案例 $\\,5\\,$ (边缘情况，存在非对角各向异性)：$\\,s=0.4\\,$, $\\,k_{xx}=1.0\\,$, $\\,k_{yy}=2.0\\,$, $\\,k_{xy}=0.5\\,$, $\\,a=1.0\\,$, $\\,b=1.0\\,$.\n\n需要遵守的实现细节：\n\n- 使用精确的面长度矢量 $\\,\\mathbf{A}_f=(1,-s)\\,$、单元中心矢量 $\\,\\mathbf{d}=(1,0)\\,$ 及其单位矢量 $\\,\\hat{\\mathbf{d}}=(1,0)\\,$，以及上面给出的顶点集。在 $\\,u(x,y)\\,$ 中使用 $\\,c=0\\,$。\n- 直接从 $\\,\\mathbf{A}_f\\,$、$\\,\\mathbf{K}\\,$ 和 $\\,\\mathbf{g}\\,$ 计算 $\\,\\Phi_{\\text{exact}}\\,$。\n- 对于 CC-TPFA，使用 $\\,\\nabla u \\approx (\\mathbf{g}\\cdot \\hat{\\mathbf{d}})\\,\\hat{\\mathbf{d}}\\,$。\n- 对于 VC-LR，通过对顶点数据进行平面的最小二乘拟合来重构 $\\,\\widehat{\\nabla u}\\,$；对于三个不共线的点和线性场，这种方法是精确的。\n- 您的程序应生成单行输出，其中包含按上述顺序排列、用逗号分隔并包含在方括号内的结果列表，例如 $\\,\\big[ E_{\\text{CC}}^{(1)},E_{\\text{VC}}^{(1)},E_{\\text{CC}}^{(2)},E_{\\text{VC}}^{(2)},\\dots\\big]\\,$。\n\n所有测试用例的最终要求输出均为浮点数。确保数值稳定性并使用标准双精度算术。不允许外部输入，也不需要用户交互。程序必须是自包含的和确定性的。", "solution": "问题陈述已经过评估并被确定为有效。它在科学上基于连续介质力学和偏微分方程数值方法的原理。问题是适定的、客观的，并为获得唯一解提供了完整且一致的定义和数据。因此，我们可以进行推导和计算。\n\n该问题要求将两种有限体积通量近似与稳态各向异性扩散问题的精确通量进行比较。分析是在线性标量场假设下，针对倾斜网格的单个面进行的。\n\n首先，我们确定所提供的数学实体。\n扩散张量是一个对称正定矩阵 $\\mathbf{K}$：\n$$\n\\mathbf{K} = \\begin{bmatrix} k_{xx} & k_{xy} \\\\ k_{xy} & k_{yy}\\end{bmatrix}\n$$\n标量场 $u(x,y)$ 是线性的，由 $u(x,y) = a\\,x + b\\,y + c$ 给出，其梯度矢量 $\\mathbf{g}$ 为常数：\n$$\n\\mathbf{g} = \\nabla u = \\begin{bmatrix} a \\\\ b \\end{bmatrix}\n$$\n所考虑的控制体表面由其面长度矢量 $\\mathbf{A}_f$ 来表征，该矢量结合了面长度 $L$ 和单位外法向量 $\\mathbf{n}$，即 $\\mathbf{A}_f = L\\mathbf{n}$。对于指定的几何形状，该矢量由下式给出：\n$$\n\\mathbf{A}_f = \\begin{bmatrix} 1 \\\\ -s \\end{bmatrix}\n$$\n其中 $s$ 是网格倾斜参数。\n\n分析的关键在于计算三个积分通量值：$\\Phi_{\\text{exact}}$、$\\Phi_{\\text{CC}}$ 和 $\\Phi_{\\text{VC}}$。\n\n1.  **精确积分通量 ($\\Phi_{\\text{exact}}$)**\n\n    对于线性场，穿过平直表面的精确积分通量由公式 $\\Phi = -L\\,\\mathbf{n}\\cdot \\mathbf{K}\\,\\nabla u$ 给出，使用面长度矢量 $\\mathbf{A}_f$ 和恒定梯度 $\\mathbf{g}$ 可将其重写为：\n    $$\n    \\Phi_{\\text{exact}} = -\\mathbf{A}_f \\cdot (\\mathbf{K}\\,\\mathbf{g})\n    $$\n    代入各分量，我们得到：\n    $$\n    \\mathbf{K}\\,\\mathbf{g} = \\begin{bmatrix} k_{xx} & k_{xy} \\\\ k_{xy} & k_{yy}\\end{bmatrix} \\begin{bmatrix} a \\\\ b \\end{bmatrix} = \\begin{bmatrix} k_{xx}a + k_{xy}b \\\\ k_{xy}a + k_{yy}b \\end{bmatrix}\n    $$\n    于是，点积为：\n    $$\n    \\mathbf{A}_f \\cdot (\\mathbf{K}\\,\\mathbf{g}) = \\begin{bmatrix} 1 \\\\ -s \\end{bmatrix} \\cdot \\begin{bmatrix} k_{xx}a + k_{xy}b \\\\ k_{xy}a + k_{yy}b \\end{bmatrix} = (k_{xx}a + k_{xy}b) - s(k_{xy}a + k_{yy}b)\n    $$\n    因此，精确通量为：\n    $$\n    \\Phi_{\\text{exact}} = - \\big( k_{xx}a + k_{xy}b - s\\,k_{xy}a - s\\,k_{yy}b \\big)\n    $$\n\n2.  **单元中心两点通量近似 ($\\Phi_{\\text{CC}}$)**\n\n    这种近似 (CC-TPFA) 通过只考虑梯度在连接两个相邻单元中心的直线上的投影来简化梯度。连接这些中心的矢量是 $\\mathbf{d}=(1,0)$，单位矢量为 $\\hat{\\mathbf{d}}=(1,0)$。近似梯度 $\\mathbf{g}_{\\text{CC}}$ 为：\n    $$\n    \\mathbf{g}_{\\text{CC}} = (\\mathbf{g} \\cdot \\hat{\\mathbf{d}})\\,\\hat{\\mathbf{d}}\n    $$\n    计算分量：\n    $$\n    \\mathbf{g} \\cdot \\hat{\\mathbf{d}} = \\begin{bmatrix} a \\\\ b \\end{bmatrix} \\cdot \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = a\n    $$\n    所以，近似梯度为：\n    $$\n    \\mathbf{g}_{\\text{CC}} = a \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} a \\\\ 0 \\end{bmatrix}\n    $$\n    那么，通量近似为：\n    $$\n    \\Phi_{\\text{CC}} = -\\mathbf{A}_f \\cdot (\\mathbf{K}\\,\\mathbf{g}_{\\text{CC}})\n    $$\n    我们计算 $\\mathbf{K}\\,\\mathbf{g}_{\\text{CC}}$ 项：\n    $$\n    \\mathbf{K}\\,\\mathbf{g}_{\\text{CC}} = \\begin{bmatrix} k_{xx} & k_{xy} \\\\ k_{xy} & k_{yy}\\end{bmatrix} \\begin{bmatrix} a \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} k_{xx}a \\\\ k_{xy}a \\end{bmatrix}\n    $$\n    最终的通量表达式为：\n    $$\n    \\Phi_{\\text{CC}} = -\\begin{bmatrix} 1 \\\\ -s \\end{bmatrix} \\cdot \\begin{bmatrix} k_{xx}a \\\\ k_{xy}a \\end{bmatrix} = -(k_{xx}a - s\\,k_{xy}a)\n    $$\n\n3.  **节点中心线性重构通量 ($\\Phi_{\\text{VC}}$)**\n\n    该方法通过对三个不共线节点上的标量值拟合一个线性函数来重构梯度 $\\widehat{\\nabla u}$。问题陈述断言，对于线性场 $u(x,y)$，这种重构是精确的。这是有限元和有限体积方法中的一个标准结果。因此，重构的梯度 $\\widehat{\\nabla u}$ 与真实梯度 $\\mathbf{g}$ 相同：\n    $$\n    \\widehat{\\nabla u} = \\mathbf{g}\n    $$\n    因此，通量近似为：\n    $$\n    \\Phi_{\\text{VC}} = -\\mathbf{A}_f \\cdot (\\mathbf{K}\\,\\widehat{\\nabla u}) = -\\mathbf{A}_f \\cdot (\\mathbf{K}\\,\\mathbf{g}) = \\Phi_{\\text{exact}}\n    $$\n\n4.  **绝对通量误差 ($E_{\\text{CC}}$ 和 $E_{\\text{VC}}$)**\n\n    误差定义为近似通量与精确通量之间的绝对差。\n\n    对于节点中心的方案，在题目条件下，误差恒等于零：\n    $$\n    E_{\\text{VC}} = |\\Phi_{\\text{VC}} - \\Phi_{\\text{exact}}| = |\\Phi_{\\text{exact}} - \\Phi_{\\text{exact}}| = 0\n    $$\n\n    对于单元中心的方案，误差为：\n    $$\n    E_{\\text{CC}} = |\\Phi_{\\text{CC}} - \\Phi_{\\text{exact}}| = \\left| -\\left(k_{xx}a - s\\,k_{xy}a\\right) - \\left[- \\left( k_{xx}a + k_{xy}b - s\\,k_{xy}a - s\\,k_{yy}b \\right)\\right] \\right|\n    $$\n    $$\n    E_{\\text{CC}} = \\left| -k_{xx}a + s\\,k_{xy}a + k_{xx}a + k_{xy}b - s\\,k_{xy}a - s\\,k_{yy}b \\right|\n    $$\n    通过消项简化表达式可得：\n    $$\n    E_{\\text{CC}} = |k_{xy}b - s\\,k_{yy}b| = |b(k_{xy} - s\\,k_{yy})|\n    $$\n    这个误差项被称为交叉扩散误差，它源于该方法未能考虑由梯度中与单元中心矢量正交部分驱动的通量分量，特别是在网格非正交（$s \\neq 0$）或张量非对角（$k_{xy} \\neq 0$）时。\n\n现在，我们将这些公式应用于给定的测试用例。\n\n**案例 1:** $s=0.3$, $k_{xx}=2.0$, $k_{yy}=1.0$, $k_{xy}=0.0$, $a=1.0$, $b=-0.5$.\n$$\nE_{\\text{CC}} = |-0.5 \\times (0.0 - 0.3 \\times 1.0)| = |-0.5 \\times -0.3| = |0.15| = 0.15\n$$\n$$\nE_{\\text{VC}} = 0.0\n$$\n\n**案例 2:** $s=0.9$, $k_{xx}=2.0$, $k_{yy}=1.0$, $k_{xy}=0.0$, $a=1.0$, $b=1.0$.\n$$\nE_{\\text{CC}} = |1.0 \\times (0.0 - 0.9 \\times 1.0)| = |1.0 \\times -0.9| = |-0.9| = 0.9\n$$\n$$\nE_{\\text{VC}} = 0.0\n$$\n\n**案例 3:** $s=0.5$, $k_{xx}=10.0$, $k_{yy}=1.0$, $k_{xy}=0.0$, $a=0.2$, $b=2.0$.\n$$\nE_{\\text{CC}} = |2.0 \\times (0.0 - 0.5 \\times 1.0)| = |2.0 \\times -0.5| = |-1.0| = 1.0\n$$\n$$\nE_{\\text{VC}} = 0.0\n$$\n\n**案例 4:** $s=0.0$, $k_{xx}=2.0$, $k_{yy}=1.0$, $k_{xy}=0.0$, $a=1.0$, $b=0.5$.\n$$\nE_{\\text{CC}} = |0.5 \\times (0.0 - 0.0 \\times 1.0)| = |0.5 \\times 0.0| = 0.0\n$$\n$$\nE_{\\text{VC}} = 0.0\n$$\nCC-TPFA 的误差为零，因为网格是正交的 ($s=0$) 并且张量是对角的 ($k_{xy}=0$)。\n\n**案例 5:** $s=0.4$, $k_{xx}=1.0$, $k_{yy}=2.0$, $k_{xy}=0.5$, $a=1.0$, $b=1.0$.\n$$\nE_{\\text{CC}} = |1.0 \\times (0.5 - 0.4 \\times 2.0)| = |1.0 \\times (0.5 - 0.8)| = |-0.3| = 0.3\n$$\n$$\nE_{\\text{VC}} = 0.0\n$$\n\n最终结果已收集并按要求格式化。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes absolute flux errors for CC-TPFA and VC-LR discretization schemes\n    for a steady anisotropic diffusion problem on a skewed mesh.\n    \"\"\"\n    test_cases = [\n        # Case 1: (s, k_xx, k_yy, k_xy, a, b)\n        (0.3, 2.0, 1.0, 0.0, 1.0, -0.5),\n        # Case 2:\n        (0.9, 2.0, 1.0, 0.0, 1.0, 1.0),\n        # Case 3:\n        (0.5, 10.0, 1.0, 0.0, 0.2, 2.0),\n        # Case 4:\n        (0.0, 2.0, 1.0, 0.0, 1.0, 0.5),\n        # Case 5:\n        (0.4, 1.0, 2.0, 0.5, 1.0, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        s, k_xx, k_yy, k_xy, a, b = case\n\n        # Define the mathematical entities as numpy arrays\n        # Diffusion tensor K\n        K = np.array([[k_xx, k_xy], [k_xy, k_yy]])\n        \n        # Exact gradient vector g\n        g = np.array([a, b])\n        \n        # Face-length vector A_f\n        A_f = np.array([1.0, -s])\n        \n        # Unit vector along the line connecting cell centers\n        d_hat = np.array([1.0, 0.0])\n\n        # 1. Exact Integrated Flux (Phi_exact)\n        # Phi_exact = - A_f . (K * g)\n        Kg = K @ g\n        phi_exact = -np.dot(A_f, Kg)\n\n        # 2. Cell-Centered Two-Point Flux Approximation (Phi_CC)\n        # Gradient approximation: g_cc = (g . d_hat) * d_hat\n        g_cc = np.dot(g, d_hat) * d_hat\n        # Phi_CC = - A_f . (K * g_cc)\n        Kg_cc = K @ g_cc\n        phi_cc = -np.dot(A_f, Kg_cc)\n\n        # 3. Vertex-Centered Linear Reconstruction Flux (Phi_VC)\n        # For a linear field, the reconstruction is exact, so the reconstructed\n        # gradient is identical to the true gradient g.\n        g_vc = g\n        # As a result, Phi_VC is identical to Phi_exact.\n        Kg_vc = K @ g_vc\n        phi_vc = -np.dot(A_f, Kg_vc)\n\n        # 4. Compute Absolute Flux Errors\n        E_cc = np.abs(phi_cc - phi_exact)\n        E_vc = np.abs(phi_vc - phi_exact)\n        \n        # As a sanity check, E_vc should be very close to zero.\n        # Use a small tolerance for floating point arithmetic.\n        if E_vc  1e-15:\n            E_vc = 0.0\n\n        results.extend([E_cc, E_vc])\n\n    # Format the final output string\n    # Using 'g' format specifier for clean output of floats.\n    print(f\"[{','.join(f'{r:.15g}' for r in results)}]\")\n\nsolve()\n```", "id": "2376138"}, {"introduction": "自适应网格加密是提高计算效率的强大工具，但它会产生带有“悬挂节点”的非整合网格，这对数值格式的守恒性提出了挑战。本实践将研究在这样一个界面上，以单元为中心和以顶点为中心的方案如何保证通量守恒这一关键物理原则。你会发现，基于有限体积法的单元中心方案能够自然地维持局部通量平衡，而顶点中心方案则需要额外施加约束，这揭示了两种方法在处理网格不规则性时的根本设计差异 [@problem_id:2376143]。", "problem": "考虑由二阶椭圆方程 $-\\nabla \\cdot \\left( k \\nabla u \\right) = 0$ 描述的稳态扩散，其中 $k0$ 为常数各向同性扩散系数。关注二维中的一个局部非协调界面，其中左侧一个宽度为 $h_c$ 的粗矩形单元与右侧两个宽度均为 $h_f$ 且垂直堆叠的细矩形单元相接。假设 $h_c = 2 h_f$。该界面是位于 $x=0$ 处的垂直线段，其范围为 $y \\in [-h_f, h_f]$。粗单元中心位于 $(-h_c/2, 0)$，两个细单元中心分别位于 $(h_f/2, h_f/2)$ 和 $(h_f/2, -h_f/2)$。考虑一个构造的线性场 $u(x,y) = a x + b y + c$ 和常数 $k$。\n\n任务 A（基于通量平衡的单元中心格式，有限体积法 FVM）：在每个子面上使用两点通量近似，为从粗单元到两个细单元的通量建模。对于一个长度为 $A = h_f$、分隔两个单元中心且法向距离为 $d = (h_c/2) + (h_f/2)$ 的子面，其传输系数为 $T = k A / d$。从粗单元中心到细单元中心的通量为 $F = -T \\left( u_{\\text{fine}} - u_{\\text{coarse}} \\right)$。为上方的细单元定义 $F_{0 \\to 1}$，为下方的细单元定义 $F_{0 \\to 2}$，并计算总数值通量 $F_{\\text{cc}} = F_{0 \\to 1} + F_{0 \\to 2}$。通过整个非协调界面段的精确积分通量为\n$$\nF_{\\text{exact}} = \\int_{-h_f}^{h_f} \\left(-k \\frac{\\partial u}{\\partial x} \\right) \\, dy = -2 k a h_f.\n$$\n定义单元中心绝对误差 $E_{\\mathrm{cc}} = \\left| F_{\\text{cc}} - F_{\\text{exact}} \\right|$。\n\n任务 B（朴素节点中心格式）：在使用围绕顶点的控制体的节点中心离散化中，非协调界面在 $(0,0)$ 处引入了一个悬挂节点，该点不是粗单元的顶点。如果忽略此悬挂节点且不添加任何约束，则归属于粗单元顶点的通量仅覆盖两端部分，而遗漏了长度为 $h_f$ 的中心部分。在线性场 $u(x,y) = a x + b y + c$ 和常数 $k$ 的条件下，沿界面的法向通量密度是均匀的，等于 $-k a$，因此缺失的通量贡献为 $-k a \\cdot h_f$。定义朴素节点中心绝对不平衡量为 $E_{\\mathrm{vn}} = \\left| -k a \\cdot h_f \\right|$。\n\n任务 C（带有悬挂节点约束的修正节点中心格式）：节点中心方法中的一个标准修正是，在悬挂节点处施加一个线性约束，例如 $u_{\\text{hang}} = \\frac{1}{2} \\left( u_{\\text{top}} + u_{\\text{bottom}} \\right)$，并将中心段的通量一致地重新分配给相邻的顶点。在给定的线性场下，此修正恢复了跨界面的正确积分通量归属。对于此线性场和配置，定义修正的节点中心残差 $E_{\\mathrm{vm}} = 0$。\n\n对测试套件使用以下参数化。在所有情况下，取 $b = 0.7$ 和 $c = -0.2$。对于每个测试用例，计算并返回如上所述的三元组 $\\left(E_{\\mathrm{cc}}, E_{\\mathrm{vn}}, E_{\\mathrm{vm}}\\right)$。\n\n测试套件（每个用例是一个元组 $(h_f, k, a)$）：\n- 用例 1：$(1.0, 1.0, 1.5)$。\n- 用例 2：$(0.5, 3.0, -2.0)$。\n- 用例 3：$(2.0, 0.7, 0.0)$。\n- 用例 4：$(10^{-3}, 5.0, 4.0)$。\n\n要实现的计算细节：\n- 使用 $h_c = 2 h_f$，面长度 $A = h_f$，中心到中心的法向距离 $d = \\frac{h_c}{2} + \\frac{h_f}{2} = \\frac{3}{2} h_f$，传输系数 $T = \\frac{k A}{d}$。\n- 使用单元中心坐标 $x_0 = -\\frac{h_c}{2}$，$y_0 = 0$，$x_1 = \\frac{h_f}{2}$，$y_1 = \\frac{h_f}{2}$，以及 $x_2 = \\frac{h_f}{2}$，$y_2 = -\\frac{h_f}{2}$。在这些中心点处计算 $u$ 的值，并如上所述构成 $F_{0 \\to 1}$ 和 $F_{0 \\to 2}$。\n- 计算 $F_{\\text{exact}} = -2 k a h_f$，然后计算 $E_{\\mathrm{cc}} = \\left| F_{0 \\to 1} + F_{0 \\to 2} - F_{\\text{exact}} \\right|$。\n- 计算 $E_{\\mathrm{vn}} = \\left| -k a \\cdot h_f \\right|$。\n- 设置 $E_{\\mathrm{vm}} = 0$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表应按给定顺序将所有测试用例的结果展平，即 $[E_{\\mathrm{cc}}^{(1)}, E_{\\mathrm{vn}}^{(1)}, E_{\\mathrm{vm}}^{(1)}, E_{\\mathrm{cc}}^{(2)}, E_{\\mathrm{vn}}^{(2)}, E_{\\mathrm{vm}}^{(2)}, \\dots]$。每个条目必须是一个浮点数。", "solution": "在尝试任何解决方案之前，需对问题陈述进行验证。\n\n步骤1：提取已知条件\n- 控制方程：$-\\nabla \\cdot \\left( k \\nabla u \\right) = 0$，用于稳态扩散。\n- 扩散系数：$k$ 是一个正的、常数的、各向同性的标量。\n- 构造解：$u(x,y) = a x + b y + c$。\n- 几何结构：左侧一个粗矩形单元，宽度 $h_c$。右侧两个细矩形单元，每个宽度 $h_f$。\n- 几何约束：$h_c = 2 h_f$。\n- 界面：位于 $x=0$ 的垂直线，从 $y = -h_f$ 到 $y = h_f$。\n- 单元中心：\n    - 粗单元 $C_0$：$(-h_c/2, 0) = (-h_f, 0)$。\n    - 上方细单元 $C_1$：$(h_f/2, h_f/2)$。\n    - 下方细单元 $C_2$：$(h_f/2, -h_f/2)$。\n- 任务A（单元中心法）：\n    - 两点通量近似：$F = -T \\left( u_{\\text{fine}} - u_{\\text{coarse}} \\right)$。\n    - 子面长度：$A = h_f$。\n    - 中心到中心的法向距离：$d = (h_c/2) + (h_f/2) = (3/2)h_f$。\n    - 传输系数：$T = k A / d$。\n    - 数值通量：$F_{0 \\to 1}$ 和 $F_{0 \\to 2}$。\n    - 总数值通量：$F_{\\text{cc}} = F_{0 \\to 1} + F_{0 \\to 2}$。\n    - 精确积分通量：$F_{\\text{exact}} = \\int_{-h_f}^{h_f} \\left(-k \\frac{\\partial u}{\\partial x} \\right) \\, dy = -2 k a h_f$。\n    - 单元中心绝对误差：$E_{\\mathrm{cc}} = \\left| F_{\\text{cc}} - F_{\\text{exact}} \\right|$。\n- 任务B（朴素节点中心法）：\n    - 朴素节点中心绝对不平衡量：$E_{\\mathrm{vn}} = \\left| -k a \\cdot h_f \\right|$。\n- 任务C（修正节点中心法）：\n    - 修正的节点中心残差：$E_{\\mathrm{vm}} = 0$。\n- 所有测试用例的参数：$b = 0.7$，$c = -0.2$。\n- 测试用例 $(h_f, k, a)$：\n    1. $(1.0, 1.0, 1.5)$\n    2. $(0.5, 3.0, -2.0)$\n    3. $(2.0, 0.7, 0.0)$\n    4. $(10^{-3}, 5.0, 4.0)$\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，涉及基本椭圆偏微分方程的标准离散化方法（有限体积法）。问题是适定的，提供了一组清晰的待执行计算。语言客观而精确，使用了计算工程领域的既定术语。所有必要的参数和公式均已提供，且无内部矛盾。该设置代表了数值网格生成中的常见场景（非协调网格加密），并且使用构造解进行代码验证是一种标准技术。该问题是有效的。\n\n步骤3：结论与行动\n该问题是有效的。将提供一个完整的解决方案。\n\n目标是为几组参数计算误差三元组 $\\left(E_{\\mathrm{cc}}, E_{\\mathrm{vn}}, E_{\\mathrm{vm}}\\right)$。\n\n首先，我们推导单元中心误差 $E_{\\mathrm{cc}}$ 的通用表达式。\n给定的构造解为 $u(x,y) = a x + b y + c$。我们在三个单元中心处计算该函数值：\n- 粗单元中心 $C_0$ 位于 $(x_0, y_0) = (-h_f, 0)$：\n$$u_0 = u(-h_f, 0) = a(-h_f) + b(0) + c = -a h_f + c$$\n- 上方细单元中心 $C_1$ 位于 $(x_1, y_1) = (h_f/2, h_f/2)$：\n$$u_1 = u(h_f/2, h_f/2) = a(h_f/2) + b(h_f/2) + c = \\frac{a h_f}{2} + \\frac{b h_f}{2} + c$$\n- 下方细单元中心 $C_2$ 位于 $(x_2, y_2) = (h_f/2, -h_f/2)$：\n$$u_2 = u(h_f/2, -h_f/2) = a(h_f/2) + b(-h_f/2) + c = \\frac{a h_f}{2} - \\frac{b h_f}{2} + c$$\n\n传输系数 $T$ 定义为 $T = \\frac{k A}{d}$。子面面积（二维中为长度）$A=h_f$，中心到中心的距离 $d = \\frac{h_c}{2} + \\frac{h_f}{2} = \\frac{2 h_f}{2} + \\frac{h_f}{2} = \\frac{3}{2} h_f$，我们得到：\n$$T = \\frac{k h_f}{\\frac{3}{2} h_f} = \\frac{2k}{3}$$\n\n现在，我们计算从粗单元 $C_0$ 到细单元 $C_1$ 和 $C_2$ 的数值通量。\n到上方细单元的通量为 $F_{0 \\to 1} = -T(u_1 - u_0)$：\n$$F_{0 \\to 1} = -\\frac{2k}{3} \\left[ \\left(\\frac{a h_f}{2} + \\frac{b h_f}{2} + c\\right) - (-a h_f + c) \\right]$$\n$$F_{0 \\to 1} = -\\frac{2k}{3} \\left[ \\frac{3a h_f}{2} + \\frac{b h_f}{2} \\right] = -k \\left( a h_f + \\frac{b h_f}{3} \\right)$$\n到下方细单元的通量为 $F_{0 \\to 2} = -T(u_2 - u_0)$：\n$$F_{0 \\to 2} = -\\frac{2k}{3} \\left[ \\left(\\frac{a h_f}{2} - \\frac{b h_f}{2} + c\\right) - (-a h_f + c) \\right]$$\n$$F_{0 \\to 2} = -\\frac{2k}{3} \\left[ \\frac{3a h_f}{2} - \\frac{b h_f}{2} \\right] = -k \\left( a h_f - \\frac{b h_f}{3} \\right)$$\n\n跨界面的总单元中心数值通量 $F_{\\text{cc}}$ 是它们的和：\n$$F_{\\text{cc}} = F_{0 \\to 1} + F_{0 \\to 2} = -k \\left( a h_f + \\frac{b h_f}{3} \\right) - k \\left( a h_f - \\frac{b h_f}{3} \\right)$$\n$$F_{\\text{cc}} = -k a h_f - \\frac{k b h_f}{3} - k a h_f + \\frac{k b h_f}{3} = -2 k a h_f$$\n\n精确积分通量由 $F_{\\text{exact}} = -2 k a h_f$ 给出。\n单元中心绝对误差 $E_{\\mathrm{cc}}$ 为：\n$$E_{\\mathrm{cc}} = |F_{\\text{cc}} - F_{\\text{exact}}| = |(-2 k a h_f) - (-2 k a h_f)| = 0$$\n这证明了一个关键性质：对于线性场，在这种对称的非协调界面上的两点通量近似是精确的。由于场在上下子界面上的y分量（$b$ 项）而产生的离散化误差完全抵消。因此，对于所有测试用例，$E_{\\mathrm{cc}} = 0$。\n\n接下来，我们处理节点中心的量。\n对于朴素节点中心格式，不平衡量可直接由下式给出：\n$$E_{\\mathrm{vn}} = \\left| -k a h_f \\right| = \\left|k a h_f\\right|$$\n此项代表通过界面中心部分的通量，当通量仅归属于主粗网格顶点时，这部分通量未被计算，因此忽略了悬挂节点。\n\n对于修正的节点中心格式，问题陈述指出，该修正对于线性场能恢复正确的通量。因此，根据定义，本次测试的残差/误差为零：\n$$E_{\\mathrm{vm}} = 0$$\n\n现在我们将这些通用公式应用于每个测试用例。注意，参数 $b=0.7$ 和 $c=-0.2$ 未出现在最终的误差表达式中。\n\n用例 1：$(h_f, k, a) = (1.0, 1.0, 1.5)$\n- $E_{\\mathrm{cc}} = 0$\n- $E_{\\mathrm{vn}} = |1.0 \\times 1.5 \\times 1.0| = 1.5$\n- $E_{\\mathrm{vm}} = 0$\n三元组：$(0.0, 1.5, 0.0)$\n\n用例 2：$(h_f, k, a) = (0.5, 3.0, -2.0)$\n- $E_{\\mathrm{cc}} = 0$\n- $E_{\\mathrm{vn}} = |3.0 \\times (-2.0) \\times 0.5| = |-3.0| = 3.0$\n- $E_{\\mathrm{vm}} = 0$\n三元组：$(0.0, 3.0, 0.0)$\n\n用例 3：$(h_f, k, a) = (2.0, 0.7, 0.0)$\n- $E_{\\mathrm{cc}} = 0$\n- $E_{\\mathrm{vn}} = |0.7 \\times 0.0 \\times 2.0| = 0.0$\n- $E_{\\mathrm{vm}} = 0$\n三元组：$(0.0, 0.0, 0.0)$\n\n用例 4：$(h_f, k, a) = (10^{-3}, 5.0, 4.0)$\n- $E_{\\mathrm{cc}} = 0$\n- $E_{\\mathrm{vn}} = |5.0 \\times 4.0 \\times 10^{-3}| = |20.0 \\times 10^{-3}| = 0.02$\n- $E_{\\mathrm{vm}} = 0$\n三元组：$(0.0, 0.02, 0.0)$\n\n这些结果将被编译成一个单一列表作为最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes error metrics for cell-centered and vertex-centered schemes\n    on a nonconforming grid interface for a steady diffusion problem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (hf, k, a).\n    # Parameters b=0.7 and c=-0.2 are constant across tests but do not\n    # affect the final error calculations as shown in the derivation.\n    test_cases = [\n        (1.0, 1.0, 1.5),      # Case 1\n        (0.5, 3.0, -2.0),     # Case 2\n        (2.0, 0.7, 0.0),      # Case 3\n        (1.0e-3, 5.0, 4.0),   # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        hf, k, a = case\n\n        # Task A: Cell-centered scheme (FVM)\n        # As derived in the solution, for a linear field u(x,y) = ax + by + c,\n        # the two-point flux approximation on this symmetric nonconforming interface\n        # is exact. The total numerical flux F_cc equals the exact flux F_exact.\n        # F_cc = -2*k*a*hf\n        # F_exact = -2*k*a*hf\n        # Therefore, E_cc = |F_cc - F_exact| = 0\n        E_cc = 0.0\n\n        # Task B: Naive vertex-centered scheme\n        # The imbalance is due to the flux through the unhandled central segment\n        # of the interface of length hf. The flux density is -k * du/dx = -k * a.\n        # The missing flux is (-k * a) * hf.\n        # The absolute imbalance is E_vn = |-k * a * hf|.\n        E_vn = abs(-k * a * hf)\n\n        # Task C: Modified vertex-centered scheme\n        # The problem states that with a hanging node constraint for a linear field,\n        # the method correctly accounts for the flux. The resulting residual or\n        # error is defined to be zero.\n        E_vm = 0.0\n\n        results.extend([E_cc, E_vn, E_vm])\n\n    # Final print statement in the exact required format.\n    # The list is flattened across test cases.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2376143"}]}