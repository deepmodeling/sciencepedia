{"hands_on_practices": [{"introduction": "本练习将引导你分析一种广泛使用的数值格式——θ格式（theta-scheme），它被应用于求解热传导方程。θ格式通过一个权重参数 $θ$ 巧妙地结合了显式和隐式方法，涵盖了从简单的欧拉前向法到稳健的克兰克-尼科尔森法等多种情况。通过推导其放大因子，你将亲自探索参数 $θ$ 如何决定格式的稳定性，并最终确定实现“无条件稳定”的关键条件，这对于在不牺牲计算效率的前提下确保数值解的可靠性至关重要。[@problem_id:2450103]", "problem": "考虑周期性区域上的热方程 $u_{t}=\\kappa u_{xx}$，其空间网格间距为 $\\Delta x$，时间步长为 $\\Delta t$，其中 $\\kappa0$ 是热扩散系数。定义中心二阶差分算子 $\\delta_{xx}u_{j}^{n}=\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right)/\\Delta x^{2}$，并考虑由下式给出的$\\theta$格式（向前欧拉法和向后欧拉法的加权平均）：\n$$(u_{j}^{n+1}-u_{j}^{n})/\\Delta t=\\kappa\\left[\\theta\\,\\delta_{xx}u_{j}^{n+1}+(1-\\theta)\\,\\delta_{xx}u_{j}^{n}\\right],$$\n其中权重参数为 $\\theta\\in\\mathbb{R}$。使用 von Neumann 稳定性分析（傅里叶模态分析），设模态为 $u_{j}^{n}=\\hat{u}\\,G^{n}\\exp(i j \\xi)$，其中 $\\xi\\in[-\\pi,\\pi]$ 是以弧度计量的无量纲波数，且 $i^{2}=-1$。推导放大因子 $G(\\xi,\\theta,\\kappa,\\Delta t,\\Delta x)$，并确定对于哪些 $\\theta$ 值，该格式是无条件稳定的，即对于所有 $\\xi\\in[-\\pi,\\pi]$ 和所有比率 $r=\\kappa\\,\\Delta t/\\Delta x^{2}\\ge 0$ 均满足 $|G|\\leq 1$。\n\n将保证无条件稳定的 $\\theta$ 的最小值作为您的最终答案。答案需表示为一个最简有理数。无需四舍五入，最终答案也无需单位。", "solution": "问题陈述连贯、科学严谨且提法恰当。我们着手进行推导。\n\n给定的热方程的$\\theta$格式为：\n$$ \\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\kappa\\left[\\theta\\,\\delta_{xx}u_{j}^{n+1}+(1-\\theta)\\,\\delta_{xx}u_{j}^{n}\\right] $$\n其中 $\\delta_{xx}$ 是中心二阶差分算子。代入 $\\delta_{xx}$ 的定义可得：\n$$ \\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left[ \\theta \\left( u_{j+1}^{n+1} - 2u_{j}^{n+1} + u_{j-1}^{n+1} \\right) + (1-\\theta) \\left( u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n} \\right) \\right] $$\n为进行 von Neumann 稳定性分析，我们引入傅里叶模态代换式 $u_{j}^{n} = G^{n} \\exp(i j \\xi)$，其中 $G$ 是放大因子，$n$ 是时间索引，$j$ 是空间索引，$\\xi$ 是无量纲波数，且 $i^{2}=-1$。我们省略了常数振幅 $\\hat{u}$，因为它会被消去。\n\n将此代换式代入格式中涉及以下关系：\n$u_{j}^{n+1} = G u_{j}^{n}$\n$u_{j\\pm 1}^{n} = \\exp(\\pm i \\xi) u_{j}^{n}$\n$u_{j\\pm 1}^{n+1} = G \\exp(\\pm i \\xi) u_{j}^{n}$\n\n将这些代入离散化方程：\n$$ \\frac{G u_{j}^{n} - u_{j}^{n}}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left[ \\theta G \\left( e^{i\\xi} - 2 + e^{-i\\xi} \\right)u_{j}^{n} + (1-\\theta) \\left( e^{i\\xi} - 2 + e^{-i\\xi} \\right)u_{j}^{n} \\right] $$\n假设存在非平凡解，我们可以两边同除以 $u_{j}^{n}$：\n$$ \\frac{G - 1}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left[ \\theta G ( e^{i\\xi} + e^{-i\\xi} - 2 ) + (1-\\theta) ( e^{i\\xi} + e^{-i\\xi} - 2 ) \\right] $$\n使用恒等式 $e^{i\\xi} + e^{-i\\xi} = 2\\cos(\\xi)$，括号中的项变为 $2\\cos(\\xi) - 2 = -2(1-\\cos(\\xi))$。再使用半角恒等式 $1-\\cos(\\xi) = 2\\sin^{2}(\\xi/2)$，该项等于 $-4\\sin^{2}(\\xi/2)$。\n关于 $G$ 的方程变为：\n$$ \\frac{G-1}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left( -4\\sin^{2}(\\xi/2) \\right) \\left[ \\theta G + (1-\\theta) \\right] $$\n令 $r = \\kappa \\Delta t / \\Delta x^{2}$ 为 Courant-Friedrichs-Lewy (CFL) 数，或更具体地说是扩散数。\n$$ G - 1 = -4r \\sin^{2}(\\xi/2) \\left[ \\theta G + 1 - \\theta \\right] $$\n现在我们必须求解放大因子 $G$：\n$$ G - 1 = -4r\\theta G \\sin^{2}(\\xi/2) - 4r(1-\\theta)\\sin^{2}(\\xi/2) $$\n$$ G \\left( 1 + 4r\\theta \\sin^{2}(\\xi/2) \\right) = 1 - 4r(1-\\theta)\\sin^{2}(\\xi/2) $$\n$$ G = \\frac{1 - 4r(1-\\theta)\\sin^{2}(\\xi/2)}{1 + 4r\\theta\\sin^{2}(\\xi/2)} $$\n为了保证无条件稳定，放大因子的模必须对所有 $r \\ge 0$ 和所有波数 $\\xi \\in [-\\pi, \\pi]$ 满足 $|G| \\le 1$。令 $S = 4r\\sin^{2}(\\xi/2)$。由于 $r \\ge 0$ 且 $\\sin^{2}(\\xi/2) \\ge 0$，所以 $S$ 的取值范围是 $[0, \\infty)$。$G$ 的表达式变为：\n$$ G = \\frac{1 - (1-\\theta)S}{1 + \\theta S} $$\n稳定性条件是 $|G| \\leq 1$，这等价于：\n$$ |1 - (1-\\theta)S| \\leq |1 + \\theta S| $$\n我们必须对所有 $S \\ge 0$ 分析这个不等式。注意，如果对于某个 $S  0$，分母 $1 + \\theta S$ 变为零，则该格式是病态的且不稳定的。这在 $\\theta  0$ 时发生。如果 $\\theta  0$，令 $\\theta = -\\beta$ 其中 $\\beta  0$。分母为 $1 - \\beta S$。当 $S = 1/\\beta$ 时，分母为零。因此，为了实现无条件稳定，必须有 $\\theta \\ge 0$。\n\n假设 $\\theta \\ge 0$，则分母 $1 + \\theta S$ 总是正的（当 $S=0$ 时为 $1$，当 $S0$ 时大于 $1$）。因此我们可以将其乘到不等式两边：\n$$ - (1 + \\theta S) \\leq 1 - (1-\\theta)S \\leq 1 + \\theta S $$\n这个复合不等式包含两部分。\n\n首先，右侧的不等式：\n$$ 1 - (1-\\theta)S \\leq 1 + \\theta S $$\n$$ -(1-\\theta)S \\leq \\theta S $$\n$$ -S + \\theta S \\leq \\theta S $$\n$$ -S \\leq 0 $$\n由于我们定义了 $S = 4r\\sin^{2}(\\xi/2) \\ge 0$，这个不等式对任何 $\\theta$ 都始终成立。\n\n其次，左侧的不等式：\n$$ -(1 + \\theta S) \\leq 1 - (1-\\theta)S $$\n$$ -1 - \\theta S \\leq 1 - S + \\theta S $$\n$$ 0 \\leq 2 - S + 2\\theta S $$\n$$ 0 \\leq 2 + (2\\theta - 1)S $$\n这个不等式必须对所有 $S \\in [0, \\infty)$ 成立。\n如果 $S$ 的系数非负，即 $2\\theta - 1 \\ge 0$，那么对于所有 $S \\ge 0$，项 $(2\\theta - 1)S$ 也是非负的。不等式 $2 + (\\text{非负量}) \\ge 0$ 总是成立的。因此，如果 $2\\theta - 1 \\ge 0$ (即 $\\theta \\ge 1/2$)，该格式是无条件稳定的。\n\n如果 $S$ 的系数为负，即 $2\\theta - 1  0$ (或 $\\theta  1/2$)，则不等式变为 $ (1-2\\theta)S \\le 2 $，或 $S \\le \\frac{2}{1-2\\theta}$。这对 $S = 4r\\sin^{2}(\\xi/2)$ 施加了一个条件，意味着稳定性是有条件的，取决于 $r$。这违反了无条件稳定性的要求。\n\n因此，无条件稳定的条件是 $\\theta \\ge 1/2$。问题要求保证无条件稳定的 $\\theta$ 的最小值。这个最小值恰好是当 $S$ 的系数变为非负时的值。\n\n$\\theta$ 的最小值为 $1/2$。", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "2450103"}, {"introduction": "接下来，我们将注意力转向双曲型方程，并研究求解线性对流方程的经典方法——MacCormack格式。作为一个两步“预估-校正”方法，它的稳定性分析比单步格式稍微复杂，能更好地锻炼你的代数推导能力。这个实践将帮助你掌握如何分析多步格式的稳定性，并理解著名的库朗-弗里德里希斯-列维（CFL）条件是如何从放大因子分析中自然产生的。[@problem_id:2450092]", "problem": "考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速 $a  0$ 为常数，定义在一个周期性的、均匀的一维空间网格 $x_{j} = j\\,\\Delta x$ 和时间层级 $t^{n} = n\\,\\Delta t$ 上。令 $u_{j}^{n}$ 表示 $u(x_{j}, t^{n})$ 的数值近似值。MacCormack 预报-校正格式通过以下方式将 $u_{j}^{n}$ 推进到 $u_{j}^{n+1}$：\n$$\n\\text{预报步：}\\quad u_{j}^{\\ast} = u_{j}^{n} - a\\,\\frac{\\Delta t}{\\Delta x}\\left(u_{j+1}^{n} - u_{j}^{n}\\right),\n$$\n$$\n\\text{校正步：}\\quad u_{j}^{n+1} = \\frac{1}{2}\\left[u_{j}^{n} + u_{j}^{\\ast} - a\\,\\frac{\\Delta t}{\\Delta x}\\left(u_{j}^{\\ast} - u_{j-1}^{\\ast}\\right)\\right].\n$$\n定义 Courant–Friedrichs–Lewy (CFL) 数 $C = a\\,\\Delta t/\\Delta x$。假设采用周期性边界条件，从而离散傅里叶模式是可容许的。\n\n确定 $C$ 的最大值，使得对于每一个离散波数 $\\theta \\in [-\\pi,\\pi]$，单步放大因子的模不超过 $1$。请以一个实数的形式给出你的答案。无需四舍五入。", "solution": "该问题要求确定应用于线性平流方程 $u_{t} + a\\,u_{x} = 0$ 的 MacCormack 格式的稳定性极限，其中 $a  0$ 是一个常数波速。稳定性将使用 von Neumann 稳定性分析方法进行评估。\n\nMacCormack 格式由一个两步的预报-校正过程给出。首先，预报步为：\n$$\nu_{j}^{\\ast} = u_{j}^{n} - C\\left(u_{j+1}^{n} - u_{j}^{n}\\right)\n$$\n其中 $C = a\\,\\frac{\\Delta t}{\\Delta x}$ 是 Courant–Friedrichs–Lewy (CFL) 数。校正步为：\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left[u_{j}^{n} + u_{j}^{\\ast} - C\\left(u_{j}^{\\ast} - u_{j-1}^{\\ast}\\right)\\right]\n$$\n为了进行 von Neumann 分析，我们考虑数值解的单个傅里叶模式的行为。我们假设一个形式为 $u_{j}^{n} = \\hat{u}^{n} \\exp(i k x_{j})$ 的解，其中 $k$ 是波数。在离散网格上，这变为 $u_{j}^{n} = \\hat{u}^{n} \\exp(i \\theta j)$，其中 $\\theta = k \\Delta x$ 是无量纲波数或相位角，其变化范围为 $[-\\pi, \\pi]$。放大因子 $G(\\theta)$ 由关系式 $\\hat{u}^{n+1} = G(\\theta) \\hat{u}^{n}$ 定义。\n\n我们首先将傅里叶模式代入预报步。项 $u_{j+1}^{n}$ 和 $u_{j-1}^{n}$ 表示为：\n$$\nu_{j+1}^{n} = \\hat{u}^{n} \\exp(i \\theta (j+1)) = u_{j}^{n} \\exp(i \\theta)\n$$\n$$\nu_{j-1}^{n} = \\hat{u}^{n} \\exp(i \\theta (j-1)) = u_{j}^{n} \\exp(-i \\theta)\n$$\n中间解 $u_{j}^{\\ast}$ 也会有一个傅里叶表示 $u_{j}^{\\ast} = \\hat{u}^{\\ast} \\exp(i \\theta j)$。将这些形式代入预报方程可得：\n$$\n\\hat{u}^{\\ast} \\exp(i \\theta j) = \\hat{u}^{n} \\exp(i \\theta j) - C \\left(\\hat{u}^{n} \\exp(i \\theta (j+1)) - \\hat{u}^{n} \\exp(i \\theta j)\\right)\n$$\n除以 $\\exp(i \\theta j)$ 得到预报解的振幅：\n$$\n\\hat{u}^{\\ast} = \\hat{u}^{n} - C \\left(\\hat{u}^{n} \\exp(i \\theta) - \\hat{u}^{n}\\right) = \\hat{u}^{n} \\left(1 - C(\\exp(i \\theta) - 1)\\right)\n$$\n接下来，我们将傅里叶模式代入校正步：\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left[u_{j}^{n} + u_{j}^{\\ast} - C\\left(u_{j}^{\\ast} - u_{j-1}^{\\ast}\\right)\\right]\n$$\n这在振幅上可以表示为：\n$$\n\\hat{u}^{n+1} = \\frac{1}{2}\\left[\\hat{u}^{n} + \\hat{u}^{\\ast} - C\\left(\\hat{u}^{\\ast} - \\hat{u}^{\\ast} \\exp(-i \\theta)\\right)\\right]\n$$\n$$\n\\hat{u}^{n+1} = \\frac{1}{2}\\left[\\hat{u}^{n} + \\hat{u}^{\\ast}\\left(1 - C(1 - \\exp(-i \\theta))\\right)\\right]\n$$\n现在，我们将 $\\hat{u}^{\\ast}$ 关于 $\\hat{u}^{n}$ 的表达式代入：\n$$\n\\hat{u}^{n+1} = \\frac{1}{2}\\left[\\hat{u}^{n} + \\hat{u}^{n}\\left(1 - C(\\exp(i \\theta) - 1)\\right) \\left(1 - C(1 - \\exp(-i \\theta))\\right)\\right]\n$$\n因此，放大因子 $G(\\theta) = \\hat{u}^{n+1} / \\hat{u}^{n}$ 为：\n$$\nG(\\theta) = \\frac{1}{2}\\left[1 + \\left(1 - C(\\exp(i \\theta) - 1)\\right) \\left(1 - C(1 - \\exp(-i \\theta))\\right)\\right]\n$$\n让我们展开括号内的乘积项：\n$$\n\\left(1 - C(\\exp(i \\theta) - 1)\\right) \\left(1 - C(1 - \\exp(-i \\theta))\\right) = 1 - C(1 - \\exp(-i \\theta)) - C(\\exp(i \\theta) - 1) + C^{2}(\\exp(i \\theta) - 1)(1 - \\exp(-i \\theta))\n$$\n$$\n= 1 - C + C\\exp(-i \\theta) - C\\exp(i \\theta) + C + C^{2}(\\exp(i \\theta) - 1-1 + \\exp(-i\\theta))\n$$\n$$\n= 1 - C(\\exp(i \\theta) - \\exp(-i \\theta)) + C^{2}(\\exp(i \\theta) + \\exp(-i \\theta) - 2)\n$$\n使用欧拉恒等式 $\\exp(i \\theta) - \\exp(-i \\theta) = 2i\\sin(\\theta)$ 和 $\\exp(i \\theta) + \\exp(-i \\theta) = 2\\cos(\\theta)$，该表达式变为：\n$$\n1 - C(2i\\sin(\\theta)) + C^{2}(2\\cos(\\theta) - 2) = 1 - 2iC\\sin(\\theta) + 2C^{2}(\\cos(\\theta) - 1)\n$$\n将此代回 $G(\\theta)$ 的表达式中：\n$$\nG(\\theta) = \\frac{1}{2}\\left[1 + 1 - 2iC\\sin(\\theta) + 2C^{2}(\\cos(\\theta) - 1)\\right] = 1 - iC\\sin(\\theta) + C^{2}(\\cos(\\theta) - 1)\n$$\n放大因子是一个复数，$G(\\theta) = \\left(1 + C^{2}(\\cos(\\theta) - 1)\\right) - i\\left(C\\sin(\\theta)\\right)$。为了使格式稳定，对于任何波数 $\\theta$，放大因子的模都不能超过 $1$，即 $|G(\\theta)| \\le 1$。这等价于 $|G(\\theta)|^{2} \\le 1$。\n$$\n|G(\\theta)|^{2} = \\left(1 + C^{2}(\\cos(\\theta) - 1)\\right)^{2} + \\left(-C\\sin(\\theta)\\right)^{2} \\le 1\n$$\n$$\n1 + 2C^{2}(\\cos(\\theta) - 1) + C^{4}(\\cos(\\theta) - 1)^{2} + C^{2}\\sin^{2}(\\theta) \\le 1\n$$\n两边同时减去 $1$ 并除以 $C^{2}$（因为 $C0$）：\n$$\n2(\\cos(\\theta) - 1) + C^{2}(\\cos(\\theta) - 1)^{2} + \\sin^{2}(\\theta) \\le 0\n$$\n使用恒等式 $\\sin^{2}(\\theta) = 1 - \\cos^{2}(\\theta) = (1 - \\cos(\\theta))(1 + \\cos(\\theta))$，我们可以重写该不等式：\n$$\n-2(1 - \\cos(\\theta)) + C^{2}(1 - \\cos(\\theta))^{2} + (1 - \\cos(\\theta))(1 + \\cos(\\theta)) \\le 0\n$$\n提出非负项 $(1 - \\cos(\\theta))$：\n$$\n(1 - \\cos(\\theta)) \\left[-2 + C^{2}(1 - \\cos(\\theta)) + (1 + \\cos(\\theta))\\right] \\le 0\n$$\n$$\n(1 - \\cos(\\theta)) \\left[-1 + \\cos(\\theta) + C^{2}(1 - \\cos(\\theta))\\right] \\le 0\n$$\n$$\n(1 - \\cos(\\theta)) \\left[-(1 - \\cos(\\theta)) + C^{2}(1 - \\cos(\\theta))\\right] \\le 0\n$$\n$$\n(1 - \\cos(\\theta))^{2} (C^{2} - 1) \\le 0\n$$\n对于任何实数 $\\theta$，项 $(1 - \\cos(\\theta))^{2}$ 总是非负的。为了使乘积对所有 $\\theta \\in [-\\pi, \\pi]$ 都小于或等于零，另一个因子 $(C^{2} - 1)$ 必须是非正的。\n$$\nC^{2} - 1 \\le 0 \\implies C^{2} \\le 1\n$$\n鉴于 $C = a \\frac{\\Delta t}{\\Delta x}$，其中 $a, \\Delta t, \\Delta x$ 都是正量，$C$ 必须为正。因此，稳定性条件是 $0  C \\le 1$。\n问题要求满足稳定性条件的最大 $C$ 值。该值为 $1$。", "answer": "$$\\boxed{1}$$", "id": "2450092"}, {"introduction": "最后一个练习旨在深化你对数值稳定性背后物理意义的理解。一个数值格式的稳定性并不仅仅是数学上的巧合，它往往深刻地反映了所模拟物理问题的“适定性”（well-posedness）。通过对比标准的热传导方程（一个物理上适定的扩散过程）和反向热传导方程（一个物理上不适定的过程），你将看到同一个FTCS差分格式会表现出截然不同的稳定性特征，从而领悟到为何一个“好”的数值格式必须尊重其所模拟的物理现实。[@problem_id:2450098]", "problem": "考虑一维偏微分方程 (PDE) $u_t=\\pm u_{xx}$，其定义在周期性域上，并在均匀网格 $x_j=j\\,\\Delta x$ 和 $t^n=n\\,\\Delta t$（其中 $j$ 和 $n$ 为整数）上进行离散化。定义无量纲参数 $r=\\Delta t/\\Delta x^2$。将前向时间中心空间 (FTCS) 格式应用于每种符号选择，得到以下两层显式更新：\n- 对于 $u_t=+u_{xx}$：$u_j^{n+1}=u_j^n+r\\left(u_{j+1}^n-2u_j^n+u_{j-1}^n\\right)$。\n- 对于 $u_t=-u_{xx}$：$u_j^{n+1}=u_j^n-r\\left(u_{j+1}^n-2u_j^n+u_{j-1}^n\\right)$。\n\n使用周期性边界条件下该线性格式的傅里叶模态放大因子概念，哪个选项正确地解释了为什么相同的离散模板对于 $u_t=+u_{xx}$（在 $r$ 的某个范围内）是稳定的，而对于 $u_t=-u_{xx}$（对于任何正数 $r$）却是不稳定的？\n\nA. 对于 $u_t=+u_{xx}$，放大因子为 $G(\\theta)=1-4r\\sin^2(\\theta/2)$，因此对所有 $\\theta$，当且仅当 $0\\le r\\le 1/2$ 时 $|G(\\theta)|\\le 1$。对于 $u_t=-u_{xx}$，放大因子为 $G(\\theta)=1+4r\\sin^2(\\theta/2)$，当 $r0$ 时，对于任何非零模态，该因子都满足 $G(\\theta)1$，因此该格式是不稳定的。\n\nB. 对于 $u_t=+u_{xx}$，放大因子为 $G(\\theta)=1+4r\\sin^2(\\theta/2)$，因此对于非零模态，它超过1，格式是不稳定的；对于 $u_t=-u_{xx}$，放大因子为 $G(\\theta)=1-4r\\sin^2(\\theta/2)$，因此当 $0\\le r\\le 1/2$ 时是稳定的。\n\nC. 对于两种符号选择，放大因子是相同的，但 $u_t=+u_{xx}$ 的局部截断误差小于 $u_t=-u_{xx}$ 的局部截断误差，这解释了前者的稳定性与后者的不稳定性。\n\nD. 该格式对两种符号选择都是无条件稳定的，因为中心空间差分产生纯虚数的傅里叶符号，所以对所有 $r0$ 和所有 $\\theta$ 都有 $|G(\\theta)|\\le 1$。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 偏微分方程 (PDE)：$u_t = +u_{xx}$ 和 $u_t = -u_{xx}$。\n- 区域：一维、周期性。\n- 离散化：均匀网格 $x_j=j\\,\\Delta x$ 和 $t^n=n\\,\\Delta t$，其中 $j$ 和 $n$ 为整数。\n- 无量纲参数：$r=\\Delta t/\\Delta x^2$。\n- 针对 $u_t = +u_{xx}$ 的 FTCS 格式：$u_j^{n+1}=u_j^n+r\\left(u_{j+1}^n-2u_j^n+u_{j-1}^n\\right)$。\n- 针对 $u_t = -u_{xx}$ 的 FTCS 格式：$u_j^{n+1}=u_j^n-r\\left(u_{j+1}^n-2u_j^n+u_{j-1}^n\\right)$。\n- 问题：使用傅里叶模态放大因子解释为什么该格式对于 $u_t = +u_{xx}$ 可以是稳定的，但对于 $u_t = -u_{xx}$ 却是不稳定的。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题涉及前向时间中心空间 (FTCS) 有限差分格式的稳定性分析，这是偏微分方程数值分析中的一个基本课题。所给的偏微分方程分别是热传导方程 ($u_t = u_{xx}$)，它将信息在时间上向前传播；以及反向热传导方程 ($u_t = -u_{xx}$)，众所周知它对于初值问题是不适定的。分析数值格式如何反映底层偏微分方程的适定性是一项关键且标准的科学探究。\n- **问题适定性**：该问题提供了执行 von Neumann 稳定性分析所需的所有必要信息。问题具体，要求基于放大因子进行解释，并且可以推导出一个唯一且技术上正确的答案。\n- **客观性**：语言是客观和技术性的，没有主观或模糊的术语。\n\n**步骤3：结论与行动**\n问题陈述是有效的。它在科学上是合理的、适定的、客观的且自洽的。我将继续进行解答。\n\n周期性域上常系数线性有限差分格式的稳定性由 von Neumann 稳定性分析确定。我们考虑数值解的单个傅里叶模态，形式为 $u_j^n = \\hat{u}^n(k) e^{ikx_j}$，其中 $k$ 是波数。代入 $x_j = j \\Delta x$，这变为 $u_j^n = \\hat{u}^n e^{ij\\theta}$，其中 $\\theta = k\\Delta x$ 是无量纲波数或每个网格单元的相角。模态振幅的演化由 $\\hat{u}^{n+1} = G(\\theta)\\hat{u}^n$ 给出，其中 $G(\\theta)$ 是放大因子。对于一个稳定的格式，其必要条件是对于所有 $\\theta \\in [-\\pi, \\pi]$ 的值，都有 $|G(\\theta)| \\le 1$。\n\n**情况1：热传导方程, $u_t = +u_{xx}$**\n离散格式为 $u_j^{n+1} = u_j^n + r(u_{j+1}^n - 2u_j^n + u_{j-1}^n)$。\n将傅里叶模态 $u_j^n = G(\\theta)^n e^{ij\\theta}$ 代入格式中（我们可以用 $A^n$ 代替 $G^n$ 表示振幅，然后求出 $G=A^{n+1}/A^n$）：\n$G(\\theta) \\hat{u}^n e^{ij\\theta} = \\hat{u}^n e^{ij\\theta} + r \\left( \\hat{u}^n e^{i(j+1)\\theta} - 2\\hat{u}^n e^{ij\\theta} + \\hat{u}^n e^{i(j-1)\\theta} \\right)$。\n除以公共的非零因子 $\\hat{u}^n e^{ij\\theta}$ 得到放大因子：\n$G(\\theta) = 1 + r \\left( e^{i\\theta} - 2 + e^{-i\\theta} \\right)$。\n使用恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$，这简化为：\n$G(\\theta) = 1 + 2r(\\cos\\theta - 1)$。\n使用半角恒等式 $\\cos\\theta - 1 = -2\\sin^2(\\theta/2)$：\n$G(\\theta) = 1 - 4r\\sin^2(\\theta/2)$。\n\n为了保证稳定性，我们要求 $|G(\\theta)| \\le 1$。\n由于 $r  0$ 且 $\\sin^2(\\theta/2) \\ge 0$，项 $4r\\sin^2(\\theta/2)$ 是非负的。\n因此，$G(\\theta) = 1 - (\\text{一个非负量}) \\le 1$。这个条件总是满足的。\n稳定性要求的第二部分是 $G(\\theta) \\ge -1$：\n$1 - 4r\\sin^2(\\theta/2) \\ge -1$\n$2 \\ge 4r\\sin^2(\\theta/2)$\n$r\\sin^2(\\theta/2) \\le 1/2$。\n这个不等式必须对所有 $\\theta$ 成立。$\\sin^2(\\theta/2)$ 的最大值是 $1$，它在最振荡的模态 $\\theta = \\pm \\pi$ 时出现。因此，条件变为：\n$r \\le 1/2$。\n该格式对于 $0  r \\le 1/2$ 是条件稳定的。\n\n**情况2：反向热传导方程, $u_t = -u_{xx}$**\n离散格式为 $u_j^{n+1} = u_j^n - r(u_{j+1}^n - 2u_j^n + u_{j-1}^n)$。\n按照相同的步骤，我们代入傅里叶模态：\n$G(\\theta) \\hat{u}^n e^{ij\\theta} = \\hat{u}^n e^{ij\\theta} - r \\left( \\hat{u}^n e^{i(j+1)\\theta} - 2\\hat{u}^n e^{ij\\theta} + \\hat{u}^n e^{i(j-1)\\theta} \\right)$。\n除以 $\\hat{u}^n e^{ij\\theta}$：\n$G(\\theta) = 1 - r \\left( e^{i\\theta} - 2 + e^{-i\\theta} \\right)$\n$G(\\theta) = 1 - 2r(\\cos\\theta - 1)$\n$G(\\theta) = 1 + 4r\\sin^2(\\theta/2)$。\n\n为了保证稳定性，我们要求 $|G(\\theta)| \\le 1$。\n给定 $r  0$。对于任何非零模态，即 $\\theta \\ne 0$，我们有 $\\sin^2(\\theta/2)  0$。\n这意味着 $4r\\sin^2(\\theta/2)  0$。\n因此，$G(\\theta) = 1 + (\\text{一个正量})  1$。\n由于对于任何空间变化的模态，都有 $|G(\\theta)|  1$，任何小的扰动都将在时间上被指数级放大。对于任何 $r  0$，该格式都是无条件不稳定的。\n这正确地反映了连续反向热传导方程的不适定性。\n\n现在，我们评估所提供的选项。\n\n**A.** 对于 $u_t=+u_{xx}$，放大因子为 $G(\\theta)=1-4r\\sin^2(\\theta/2)$，因此对所有 $\\theta$，当且仅当 $0\\le r\\le 1/2$ 时 $|G(\\theta)|\\le 1$。对于 $u_t=-u_{xx}$，放大因子为 $G(\\theta)=1+4r\\sin^2(\\theta/2)$，当 $r0$ 时，对于任何非零模态，该因子都满足 $G(\\theta)1$，因此该格式是不稳定的。\n这个陈述与上面的推导完全吻合。两个放大因子的表达式都是正确的，得出的稳定性条件也是正确的。\n**结论：正确。**\n\n**B.** 对于 $u_t=+u_{xx}$，放大因子为 $G(\\theta)=1+4r\\sin^2(\\theta/2)$，因此对于非零模态，它超过1，格式是不稳定的；对于 $u_t=-u_{xx}$，放大因子为 $G(\\theta)=1-4r\\sin^2(\\theta/2)$，因此当 $0\\le r\\le 1/2$ 时是稳定的。\n这个选项错误地交换了两个偏微分方程的放大因子和稳定性结论。热传导方程 ($u_t=+u_{xx}$) 被赋予了反向热传导方程的放大因子，反之亦然。\n**结论：不正确。**\n\n**C.** 对于两种符号选择，放大因子是相同的，但 $u_t=+u_{xx}$ 的局部截断误差小于 $u_t=-u_{xx}$ 的局部截断误差，这解释了前者的稳定性与后者的不稳定性。\n正如所推导的，$u_t=+u_{xx}$ 的放大因子是 $1-4r\\sin^2(\\theta/2)$，而 $u_t=-u_{xx}$ 的放大因子是 $1+4r\\sin^2(\\theta/2)$。它们不相同。该选项的前提在事实上是错误的。稳定性是由放大因子决定的，而不是通过比较截断误差来决定。\n**结论：不正确。**\n\n**D.** 该格式对两种符号选择都是无条件稳定的，因为中心空间差分产生纯虚数的傅里叶符号，所以对所有 $r0$ 和所有 $\\theta$ 都有 $|G(\\theta)|\\le 1$。\n这个选项提出了几个错误的论断。首先，该格式并非对两种情况都无条件稳定；一种是条件稳定的，另一种是无条件不稳定的。其次，二阶中心差分算子 $\\frac{1}{\\Delta x^2}(u_{j+1}-2u_j+u_{j-1})$ 的傅里叶符号是 $\\frac{-4}{\\Delta x^2}\\sin^2(\\theta/2)$，它是一个纯实数且非正，而不是纯虚数。纯虚数符号产生于对一阶导数的中心差分近似。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2450098"}]}