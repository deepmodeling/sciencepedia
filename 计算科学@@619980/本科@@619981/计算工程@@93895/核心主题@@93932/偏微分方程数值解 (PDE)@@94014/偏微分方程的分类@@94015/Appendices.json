{"hands_on_practices": [{"introduction": "我们首先从一个基础练习开始，这个练习将巩固通过计算判别式来对偏微分方程进行分类的核心技术。这是一个基础实践，你将看到一个偏微分方程的类型如何在定义域的不同区域发生变化，理解这一点对于许多物理应用至关重要 [@problem_id:2380287]。", "problem": "考虑二阶线性偏微分方程(PDE)\n$$(x^{2}-1)\\,u_{xx} + 2\\,x y\\,u_{xy} + (y^{2}-1)\\,u_{yy} = 0,$$\n该方程在整个$\\mathbb{R}^{2}$平面上给定，其中$u=u(x,y)$是二次连续可微的。请通过从第一性原理分析其主部，将此偏微分方程在$xy$平面的不同区域内分类为椭圆型、抛物型或双曲型。请识别出分隔不同类型区域的精确边界曲线，并指明该边界的哪一侧对应于哪种类型。\n\n您最终报告的答案必须是关于变量$x$和$y$的单一简化解析表达式，其零水平集恰好是您所识别的分类边界。不涉及单位。在最终报告的答案中，请勿提供不等式或分段描述。", "solution": "对问题陈述进行验证。\n\n**第一步：提取已知条件**\n-   给定的偏微分方程为 $(x^{2}-1)\\,u_{xx} + 2\\,x y\\,u_{xy} + (y^{2}-1)\\,u_{yy} = 0$。\n-   定义域指定为整个平面 $\\mathbb{R}^{2}$。\n-   函数 $u(x,y)$ 被说明为二次连续可微。\n-   任务是在$xy$平面的不同区域内将该方程分类为椭圆型、抛物型或双曲型。\n-   任务要求识别分隔这些区域的边界曲线，并指明边界的哪一侧对应于每种类型。\n-   最终答案必须是一个单一的解析表达式，其零水平集是分类边界。\n\n**第二步：使用提取的已知条件进行验证**\n-   **科学依据**：该问题是偏微分方程数学理论中的一个标准练习。基于主部判别式的二阶线性偏微分方程分类是一个基本且成熟的概念。该问题在科学上是合理的。\n-   **适定性**：问题已完全指定。方程已给出，分类过程是唯一且确定性的。分类问题存在唯一解。\n-   **客观性**：问题使用精确的数学语言陈述，没有歧义或主观解释。\n\n**第三步：结论与行动**\n问题是有效的。这是一个在偏微分方程领域内适定的、有科学依据的问题。我将继续进行解答。\n\n根据文章中的定义，一个一般的二元二阶线性偏微分方程的形式为\n$$A(x,y) u_{xx} + 2B(x,y) u_{xy} + C(x,y) u_{yy} + \\dots = 0,$$\n其分类取决于判别式 $D(x,y) = B(x,y)^{2} - A(x,y)C(x,y)$ 的符号。方程在点 $(x,y)$ 处的类型确定如下：\n-   如果 $D  0$，方程为双曲型。\n-   如果 $D = 0$，方程为抛物型。\n-   如果 $D  0$，方程为椭圆型。\n\n给定的方程为\n$$(x^{2}-1)\\,u_{xx} + 2\\,x y\\,u_{xy} + (y^{2}-1)\\,u_{yy} = 0.$$\n通过与一般形式进行比较，我们确定主部的系数：\n-   $A(x,y) = x^{2}-1$\n-   $B(x,y) = xy$\n-   $C(x,y) = y^{2}-1$\n\n现在，我们计算判别式 $D(x,y)$：\n$$\nD = B^{2} - AC = (xy)^{2} - (x^{2}-1)(y^{2}-1)\n$$\n展开各项，我们得到：\n$$\nD = x^{2}y^{2} - (x^{2}y^{2} - x^{2} - y^{2} + 1)\n$$\n$$\nD = x^{2}y^{2} - x^{2}y^{2} + x^{2} + y^{2} - 1\n$$\n$$\nD = x^{2} + y^{2} - 1\n$$\n$D$ 的符号由表达式 $x^{2} + y^{2} - 1$ 的符号决定。我们分析三种情况。\n\n情况1：双曲区域（$D > 0$）\n在该区域 $x^{2} + y^{2} - 1 > 0$ 时，方程为双曲型。这可以简化为：\n$$x^{2} + y^{2}  1$$\n这个不等式描述了平面上所有在以原点为中心的单位圆外的点 $(x,y)$ 的集合。\n\n情况2：抛物边界（$D = 0$）\n在该边界 $x^{2} + y^{2} - 1 = 0$ 时，方程为抛物型。这可以简化为：\n$$x^{2} + y^{2} = 1$$\n这是以原点为中心的单位圆的方程。这条曲线是分隔不同类型区域的边界。\n\n情况3：椭圆区域（$D  0$）\n在该区域 $x^{2} + y^{2} - 1  0$ 时，方程为椭圆型。这可以简化为：\n$$x^{2} + y^{2}  1$$\n这个不等式描述了以原点为中心的半径为1的开圆盘内所有点 $(x,y)$ 的集合，也就是单位圆内部的区域。\n\n总结如下：\n-   对于单位圆外部区域中的所有点 $(x,y)$，即 $x^{2} + y^{2}  1$，该偏微分方程是**双曲型**的。\n-   在单位圆本身上，即 $x^{2} + y^{2} = 1$，该偏微分方程是**抛物型**的。\n-   对于单位圆内部区域中的所有点 $(x,y)$，即 $x^{2} + y^{2}  1$，该偏微分方程是**椭圆型**的。\n\n问题要求一个单一的解析表达式，其零水平集是分类边界。该边界由条件 $D = 0$ 定义，这等价于 $x^{2} + y^{2} - 1 = 0$。因此，所求的表达式是 $x^{2} + y^{2} - 1$。", "answer": "$$\n\\boxed{x^{2} + y^{2} - 1}\n$$", "id": "2380287"}, {"introduction": "接下来的挑战将常规问题反转，要求你从已知的特征曲线出发构建一个偏微分方程。这种练习能加深你对偏微分方程代数形式与其解的几何特性之间深层联系的理解，掌握这种联系对于选择合适的数值方法至关重要 [@problem_id:2377078]。", "problem": "在计算工程中，对两个自变量的二阶偏微分方程（PDE）的分类是基于与其特征曲线相关的二次型的判别式。考虑一个形式如下的二阶线性齐次偏微分方程\n$$\na(x,y)\\,u_{xx} \\;+\\; 2\\,b(x,y)\\,u_{xy} \\;+\\; c(x,y)\\,u_{yy} \\;=\\; 0,\n$$\n其中 $u=u(x,y)$，且 $a(x,y)$、$b(x,y)$ 和 $c(x,y)$ 是足够光滑的函数。已知一族特征曲线由下式给出\n$$\nx^{2} - y^{2} \\;=\\; C,\n$$\n且另一族特征曲线是该族曲线的正交轨线。在所有特征族与这两族曲线重合的偏微分方程中，选择满足 $a(x,y)=1$ 归一化条件的那个。设分类判别式为\n$$\n\\Delta(x,y) \\;=\\; b(x,y)^{2} - a(x,y)\\,c(x,y).\n$$\n计算 $\\Delta(2,1)$。请以精确值形式给出答案（不进行四舍五入）。", "solution": "首先对问题陈述进行严格验证。\n\n已知条件如下：\n1.  一个形式为 $a(x,y)\\,u_{xx} + 2\\,b(x,y)\\,u_{xy} + c(x,y)\\,u_{yy} = 0$ 的二阶线性齐次偏微分方程（PDE）。\n2.  一族特征曲线由方程 $x^{2} - y^{2} = C$ 定义。\n3.  第二族特征曲线由第一族曲线的正交轨线构成。\n4.  系数 $a(x,y)$ 归一化为 $1$。\n5.  判别式定义为 $\\Delta(x,y) = b(x,y)^{2} - a(x,y)\\,c(x,y)$。\n6.  目标是计算 $\\Delta(2,1)$ 的值。\n\n该问题具有科学依据，是适定且客观的。它涉及基于特征曲线的二阶偏微分方程的标准分类，这是数学物理和工程学中的一个基本课题。所提供的信息是自洽的，足以确定所求量的一个唯一解。没有矛盾、歧义或事实错误。因此，该问题被认为是有效的，并将构建一个形式化的解法。\n\n分析步骤如下。首先，我们必须确定第二族特征曲线的方程。其次，我们将使用特征曲线的定义性质来建立系数 $a$、$b$ 和 $c$ 之间的关系。第三，我们应用给定的归一化来找到这些系数的具体表达式。最后，我们计算判别式并在指定点对其求值。\n\n**步骤1：确定第二族特征曲线。**\n第一族曲线由 $\\phi(x,y) = x^{2} - y^{2} = C$ 给出，其中 $C$ 是一个常数。$\\phi(x,y)$ 的梯度是 $\\nabla\\phi = \\langle\\frac{\\partial\\phi}{\\partial x}, \\frac{\\partial\\phi}{\\partial y}\\rangle = \\langle 2x, -2y \\rangle$。矢量场 $\\nabla\\phi$ 处处垂直于 $\\phi$ 的等值线。等值线的切线斜率 $m_{1} = \\frac{dy}{dx}$ 满足 $\\frac{\\partial\\phi}{\\partial x} + \\frac{\\partial\\phi}{\\partial y}\\frac{dy}{dx} = 0$，这给出 $m_{1} = -\\frac{\\phi_{x}}{\\phi_{y}} = -\\frac{2x}{-2y} = \\frac{x}{y}$。\n\n正交轨线的斜率 $m_{2}$ 是 $m_{1}$ 的负倒数，所以 $m_{2} = -\\frac{1}{m_{1}} = -\\frac{y}{x}$。这给出了正交族的常微分方程（ODE）：\n$$\n\\frac{dy}{dx} = -\\frac{y}{x}\n$$\n这是一个可分离的常微分方程。我们整理并积分：\n$$\n\\int \\frac{dy}{y} = -\\int \\frac{dx}{x}\n$$\n$$\n\\ln|y| = -\\ln|x| + k\n$$\n其中 $k$ 是积分常数。整理项，我们得到：\n$$\n\\ln|y| + \\ln|x| = k \\implies \\ln|xy| = k \\implies xy = C'\n$$\n其中 $C' = \\pm\\exp(k)$ 是一个新的常数。因此，第二族特征曲线由 $\\psi(x,y) = xy = C'$ 给出。\n\n**步骤2：系数与特征曲线的关系。**\n一个函数 $\\zeta(x,y)$ 定义了偏微分方程 $a\\,u_{xx} + 2b\\,u_{xy} + c\\,u_{yy} = 0$ 的一族特征曲线，当且仅当它满足以下非线性一阶偏微分方程：\n$$\na\\left(\\frac{\\partial\\zeta}{\\partial x}\\right)^{2} + 2b\\left(\\frac{\\partial\\zeta}{\\partial x}\\right)\\left(\\frac{\\partial\\zeta}{\\partial y}\\right) + c\\left(\\frac{\\partial\\zeta}{\\partial y}\\right)^{2} = 0\n$$\n我们将此条件应用于 $\\phi(x,y) = x^2 - y^2$ 和 $\\psi(x,y) = xy$。\n\n对于 $\\phi(x,y) = x^{2} - y^{2}$，其偏导数为 $\\phi_x = 2x$ 和 $\\phi_y = -2y$。将它们代入特征条件得出：\n$$\na(2x)^{2} + 2b(2x)(-2y) + c(-2y)^{2} = 0\n$$\n$$\n4x^{2}a - 8xyb + 4y^{2}c = 0\n$$\n除以 $4$，我们得到第一个关系式：\n$$\nx^{2}a - 2xyb + y^{2}c = 0 \\quad (1)\n$$\n对于 $\\psi(x,y) = xy$，其偏导数为 $\\psi_x = y$ 和 $\\psi_y = x$。代入得到：\n$$\na(y)^{2} + 2b(y)(x) + c(x)^{2} = 0\n$$\n这得出我们的第二个关系式：\n$$\ny^{2}a + 2xyb + x^{2}c = 0 \\quad (2)\n$$\n我们现在求解关于系数的线性方程组。将方程(1)与方程(2)相加：\n$$\n(x^{2}a - 2xyb + y^{2}c) + (y^{2}a + 2xyb + x^{2}c) = 0\n$$\n$$\n(x^{2}+y^{2})a + (x^{2}+y^{2})c = 0\n$$\n$$\n(x^{2}+y^{2})(a+c) = 0\n$$\n为了使此式在 $(x,y) \\neq (0,0)$ 的定义域上成立，我们必须有 $a+c = 0$，这意味着 $c(x,y) = -a(x,y)$。\n\n将 $c = -a$ 代入方程 (2)：\n$$\ny^{2}a + 2xyb + x^{2}(-a) = 0\n$$\n$$\n(y^{2}-x^{2})a + 2xyb = 0\n$$\n$$\n2xyb = (x^{2}-y^{2})a\n$$\n$$\nb(x,y) = \\frac{x^{2}-y^{2}}{2xy} a(x,y)\n$$\n\n**步骤3：应用归一化并计算判别式。**\n问题指定了归一化条件 $a(x,y) = 1$。使用上面推导出的关系，我们找到其他系数：\n$$\nc(x,y) = -a(x,y) = -1\n$$\n$$\nb(x,y) = \\frac{x^{2}-y^{2}}{2xy} a(x,y) = \\frac{x^{2}-y^{2}}{2xy}\n$$\n现在，我们计算判别式 $\\Delta(x,y) = b(x,y)^{2} - a(x,y)c(x,y)$：\n$$\n\\Delta(x,y) = \\left(\\frac{x^{2}-y^{2}}{2xy}\\right)^{2} - (1)(-1)\n$$\n$$\n\\Delta(x,y) = \\frac{(x^{2}-y^{2})^{2}}{4x^{2}y^{2}} + 1\n$$\n为了简化，我们进行通分：\n$$\n\\Delta(x,y) = \\frac{x^{4} - 2x^{2}y^{2} + y^{4}}{4x^{2}y^{2}} + \\frac{4x^{2}y^{2}}{4x^{2}y^{2}}\n$$\n$$\n\\Delta(x,y) = \\frac{x^{4} - 2x^{2}y^{2} + y^{4} + 4x^{2}y^{2}}{4x^{2}y^{2}} = \\frac{x^{4} + 2x^{2}y^{2} + y^{4}}{4x^{2}y^{2}}\n$$\n识别出分子和分母都是完全平方：\n$$\n\\Delta(x,y) = \\frac{(x^{2}+y^{2})^{2}}{(2xy)^{2}} = \\left(\\frac{x^{2}+y^{2}}{2xy}\\right)^{2}\n$$\n由于对于 $x, y \\neq 0$ 有 $\\Delta(x,y)  0$，该偏微分方程是双曲型的，这与存在两个不同的实特征族是一致的。\n\n**步骤4：在点 $(2,1)$ 处求值。**\n最后，我们将坐标 $x=2$ 和 $y=1$ 代入判别式的表达式中：\n$$\n\\Delta(2,1) = \\left(\\frac{2^{2}+1^{2}}{2(2)(1)}\\right)^{2} = \\left(\\frac{4+1}{4}\\right)^{2} = \\left(\\frac{5}{4}\\right)^{2}\n$$\n$$\n\\Delta(2,1) = \\frac{25}{16}\n$$\n这就是所求的精确值。", "answer": "$$\\boxed{\\frac{25}{16}}$$", "id": "2377078"}, {"introduction": "最后的这个实践将你带入计算分析的领域，在这里，控制方程是未知的。你将需要开发一种方法，仅通过分析其数值解数据来推断偏微分方程的类型，这项技能在现代数据驱动的工程和科学发现中非常实用 [@problem_id:2380244]。", "problem": "给定一个标量场 $u(x,y)$ 在均匀笛卡尔网格上的采样值，但无法直接获知其所满足的偏微分方程 (PDE)。任务是仅利用采样数据的局域相关性，通过计算来估计 $u$ 在该区域内可能满足的未知线性二阶 PDE 是椭圆型还是双曲型。该分类依据主部 $A u_{xx} + 2 B u_{xy} + C u_{yy}$ 的判别式 $D = B^2 - AC$ 的符号：若 $D  0$，PDE 为椭圆型；若 $D  0$，PDE 为双曲型。所有计算都是无量纲的，任何三角函数都必须使用弧度制角。\n\n请构建一个程序，针对下方的每个测试用例，接收所提供的网格上的 $u(x,y)$ 数据，并输出一个整数标签：若估计其潜在的 PDE 为椭圆型，则输出 $+1$；若估计为双曲型，则输出 $-1$。你的方法必须仅依赖于采样场值的局域数据相关性。不允许外部输入；所有数据均在下方完全指定。\n\n所有测试用例通用的网格规范：\n- 区域：$x \\in [-1,1]$，$y \\in [-1,1]$。\n- 网格尺寸：$N \\times N$，其中 $N = 61$，每个方向上均有 $61$ 个均匀间隔的节点。\n- 网格间距：$h = \\dfrac{2}{N-1}$。\n- 坐标：$(x_i,y_j)$，其中 $x_i = -1 + (i-1)h$，$y_j = -1 + (j-1)h$，整数索引 $i,j \\in \\{1,2,\\dots,N\\}$。\n\n四个标量场的测试套件：\n- 用例 #1（椭圆型原型）：$u_1(x,y) = x^2 - y^2$。\n- 用例 #2（双曲型原型）：$u_2(x,y) = \\cos\\!\\big(3 \\pi (x - y)\\big)$。\n- 用例 #3（椭圆型，高阶谐波）：$u_3(x,y) = x^3 - 3 x y^2$。\n- 用例 #4（带平滑扰动的双曲型）：$u_4(x,y) = \\cos\\!\\big(2 \\pi (x - y)\\big) + 0.05 \\cos(4 \\pi x)\\cos(4 \\pi y)$。\n\n要求输出：\n- 按测试用例（#1、#2、#3、#4）的顺序，生成包含四个整数标签的单行输出，格式为逗号分隔的列表，并用方括号括起来，例如 [1,-1,1,-1]。\n\n你的程序必须是自包含的，无需用户输入或外部文件即可运行。最终答案没有物理单位，角度必须是弧度。最终输出必须是严格符合指定列表格式的单行文本。每个测试用例的答案必须是集合 $\\{+1,-1\\}$ 中的一个整数。", "solution": "所述问题是有效的。这是一个计算物理学领域中定义明确的问题，具体属于偏微分方程（PDE）的系统辨识范畴。该问题具有科学依据、客观，并为构建计算解决方案提供了所有必要信息。问题中没有矛盾之处，指定的测试用例是目标 PDE 类型的标准示例。\n\n问题的核心是，在仅有解 $u(x,y)$ 在均匀笛卡尔网格上的离散采样数据的情况下，估计一个形为\n$$\nA u_{xx} + 2B u_{xy} + C u_{yy} + \\dots = 0\n$$\n的未知线性二阶 PDE 的类型（椭圆型或双曲型）。分类取决于判别式 $D = B^2 - AC$ 的符号。该方法必须基于“局域数据相关性”。\n\n我们将通过使用有限差分格式来近似偏导数，然后辨识这些近似值之间存在的线性代数关系，从而将此要求形式化。这是一个针对未知常系数 $A$、$B$ 和 $C$ 的回归问题。\n\n设网格数据为 $u_{i,j} = u(x_j, y_i)$，其中 $i,j \\in \\{0, 1, \\dots, N-1\\}$ 是从零开始的索引，$N=61$，网格间距为 $h = 2/(N-1)$。我们使用二阶精度的中心差分来近似内部网格点上的二阶导数。潜在的 PDE 表明，这些导数的线性组合等于零（在发现方程主部时，通常会忽略低阶项和源项）。\n\n与导数相对应的离散算子是通过将模板应用于网格数据得到的。对于一个内部点 $(i,j)$，其中 $i,j \\in \\{1, \\dots, N-2\\}$，我们定义：\n\\begin{align*}\ns_{xx}[u]_{i,j} = u_{i,j+1} - 2u_{i,j} + u_{i,j-1} \\\\\ns_{yy}[u]_{i,j} = u_{i+1,j} - 2u_{i,j} + u_{i,j-1} \\\\\ns_{xy}[u]_{i,j} = u_{i+1,j+1} - u_{i+1,j-1} - u_{i-1,j+1} + u_{i-1,j-1}\n\\end{align*}\n注意，这些模板与导数的有限差分近似成比例：\n$$\nu_{xx} \\approx \\frac{s_{xx}[u]}{h^2}, \\quad u_{yy} \\approx \\frac{s_{yy}[u]}{h^2}, \\quad u_{xy} \\approx \\frac{s_{xy}[u]}{4h^2}\n$$\n将这些代入 PDE 的主部，得到：\n$$\nA \\frac{s_{xx}[u]}{h^2} + 2B \\frac{s_{xy}[u]}{4h^2} + C \\frac{s_{yy}[u]}{h^2} \\approx 0\n$$\n乘以 $h^2$ 可得到模板响应自身之间的一种关系：\n$$\nA s_{xx}[u] + \\frac{B}{2} s_{xy}[u] + C s_{yy}[u] \\approx 0\n$$\n我们寻求系数 $(k_1, k_2, k_3)$，使得 $k_1 s_{xx}[u] + k_2 s_{xy}[u] + k_3 s_{yy}[u] \\approx 0$ 在整个网格上成立。通过与上式比较，我们可以辨识出 $A=k_1$、$B/2=k_2$ 和 $C=k_3$。这意味着 $B=2k_2$。判别式可以估计为：\n$$\nD_{est} = B^2 - AC = (2k_2)^2 - k_1 k_3\n$$\n为求得系数 $(k_1, k_2, k_3)$，我们将所有 $(N-2)^2$ 个内部点的模板响应视为向量。令 $\\mathbf{v}_{xx}$、$\\mathbf{v}_{xy}$ 和 $\\mathbf{v}_{yy}$ 分别为模板网格 $s_{xx}[u]$、$s_{xy}[u]$ 和 $s_{yy}[u]$ 的扁平化向量。问题在于找到一个系数向量 $\\mathbf{k} = [k_1, k_2, k_3]^T$，使得 $\\|\\mathbf{v}_{xx} k_1 + \\mathbf{v}_{xy} k_2 + \\mathbf{v}_{yy} k_3 \\|_2^2$ 最小化，同时满足约束条件 $\\|\\mathbf{k}\\|_2=1$ 以避免平凡解 $\\mathbf{k}=0$。\n\n这是一个标准的总体最小二乘问题。如果我们构建数据矩阵 $M = [\\mathbf{v}_{xx} | \\mathbf{v}_{xy} | \\mathbf{v}_{yy}]$，问题等价于最小化 $\\|M \\mathbf{k}\\|_2^2 = \\mathbf{k}^T (M^T M) \\mathbf{k}$。解 $\\mathbf{k}$ 是 $3 \\times 3$ 对称矩阵 $M^T M$ 最小特征值对应的特征向量。矩阵 $M^T M$ 正是导数场的协方差矩阵，因此该方法直接实现了寻找“局域数据相关性”的思想。\n\n如果某个导数场恒为零（或在数值上可以忽略不计），例如，对于给定的函数 $u(x,y)$ 有 $u_{xy}=0$，则会出现一种特殊情况。在这种情况下，$M$ 中对应的列向量将为零向量。根据简约原则（奥卡姆剃刀），我们应寻求最简单的 PDE。这意味着将零导数对应的系数设为零，并解决简化的回归问题。例如，若 $\\mathbf{v}_{xy} \\approx \\mathbf{0}$，我们设 $k_2=0$，并为余下的两个向量寻找最佳拟合的 $[k_1, k_3]$。\n\n完整的算法如下：\n1. 对于每个测试用例，通过对给定的函数 $u(x,y)$ 进行采样来生成 $N \\times N$ 的数据网格 $U$。\n2. 计算 $(N-2) \\times (N-2)$ 的模板响应网格 $S_{xx}$、$S_{xy}$ 和 $S_{yy}$。\n3. 将这些网格扁平化为向量 $\\mathbf{v}_{xx}$、$\\mathbf{v}_{xy}$ 和 $\\mathbf{v}_{yy}$。\n4. 先验地处理平凡导数。计算这些向量的范数。如果某个范数与最大范数相比可以忽略不计（例如，小于最大范数的 $10^{-9}$ 倍），则其对应的系数设为零，并将该向量从回归分析中排除。\n5. 从非平凡向量构建数据矩阵 $M$。\n6. 计算协方差矩阵 $C_M = M^T M$。\n7. 求解 $C_M$ 的特征值和特征向量。与最小特征值对应的特征向量提供了非平凡导数的系数。\n8. 重构完整的系数向量 $\\mathbf{k}=[k_1, k_2, k_3]^T$。\n9. 计算判别式估计值 $D_{est} = 4k_2^2 - k_1 k_3$。\n10. 对 PDE 进行分类：如果 $D_{est}  0$，标签为 $+1$（椭圆型）；否则，标签为 $-1$（双曲型）。\n\n此过程为从采样数据估计 PDE 类型提供了一种稳健且客观的方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the PDE classification problem for the given test cases.\n    \"\"\"\n    N = 61\n    h = 2.0 / (N - 1)\n    \n    # Create the grid coordinates\n    x_coords = np.linspace(-1, 1, N)\n    y_coords = np.linspace(-1, 1, N)\n    x, y = np.meshgrid(x_coords, y_coords, indexing='xy')\n\n    # Define the four test case functions\n    test_functions = [\n        lambda x, y: x**2 - y**2,\n        lambda x, y: np.cos(3 * np.pi * (x - y)),\n        lambda x, y: x**3 - 3 * x * y**2,\n        lambda x, y: np.cos(2 * np.pi * (x - y)) + 0.05 * np.cos(4 * np.pi * x) * np.cos(4 * np.pi * y),\n    ]\n\n    results = []\n    \n    for u_func in test_functions:\n        # 1. Sample the scalar field on the grid\n        U = u_func(x, y)\n\n        # 2. Compute stencil responses on the interior grid\n        # Stencil for u_xx, proportional to s_xx\n        s_xx_grid = U[1:-1, 2:] - 2 * U[1:-1, 1:-1] + U[1:-1, :-2]\n        # Stencil for u_yy, proportional to s_yy\n        s_yy_grid = U[2:, 1:-1] - 2 * U[1:-1, 1:-1] + U[:-2, 1:-1]\n        # Stencil for u_xy, proportional to s_xy\n        s_xy_grid = U[2:, 2:] - U[2:, :-2] - U[:-2, 2:] + U[:-2, :-2]\n\n        # 3. Flatten the stencil grids into vectors\n        v_xx = s_xx_grid.flatten()\n        v_yy = s_yy_grid.flatten()\n        v_xy = s_xy_grid.flatten()\n\n        # 4. Handle trivial derivatives (Principle of Parsimony)\n        norms = np.array([np.linalg.norm(v) for v in [v_xx, v_xy, v_yy]])\n        max_norm = np.max(norms)\n        \n        # Use a relative tolerance to detect null vectors\n        trivial_tol = 1e-9\n        is_trivial = norms  trivial_tol * max_norm if max_norm > 0 else np.ones(3, dtype=bool)\n\n        active_indices = np.where(~is_trivial)[0]\n        active_vectors = [v for i, v in enumerate([v_xx, v_xy, v_yy]) if i in active_indices]\n\n        # 5. Form the data matrix M\n        if not active_vectors:\n            # All derivatives are zero, cannot classify. This should not happen for the given cases.\n            # For this problem, we can skip to a default.\n            k_full = np.zeros(3)\n        elif len(active_vectors) == 1:\n            # Equation is of the form k*u_deriv = 0, implies k=0. Again, non-physical.\n            k_full = np.zeros(3)\n        else:\n            M = np.stack(active_vectors, axis=1)\n\n            # 6. Compute the covariance-like matrix C_M = M^T * M\n            C_M = M.T @ M\n\n            # 7. Find the eigenvector corresponding to the smallest eigenvalue\n            eigenvalues, eigenvectors = np.linalg.eigh(C_M)\n            k_active = eigenvectors[:, 0]\n\n            # 8. Reconstruct the full coefficient vector\n            k_full = np.zeros(3)\n            k_full[active_indices] = k_active\n        \n        k1, k2, k3 = k_full\n        \n        # 9. Calculate the discriminant\n        # We found k1, k2, k3 for k1*s_xx + k2*s_xy + k3*s_yy = 0\n        # which corresponds to PDE coefficients A, B, C as A=k1, B=2*k2, C=k3\n        # for a PDE of the form A*u_xx + (B/2)*s_xy/h^2... -> A*u_xx + 2*B_std*u_xy ...\n        # My apologies, the mapping from stencil coefficients to PDE coefficients is:\n        # A*s_xx + (B_std/2)*s_xy + C*s_yy = 0.\n        # We are solving for [k1,k2,k3] such that k1*s_xx + k2*s_xy + k3*s_yy = 0.\n        # Comparing gives A=k1, B_std/2=k2 -> B_std=2k2, C=k3.\n        # The discriminant is D = (B_std)^2 - A*C = (2*k2)^2 - k1*k3.\n        discriminant = 4 * k2**2 - k1 * k3\n        \n        # 10. Classify and store the result\n        if discriminant  0:\n            results.append(1)  # Elliptic\n        else:\n            results.append(-1) # Hyperbolic (includes Parabolic case D=0)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2380244"}]}