{"hands_on_practices": [{"introduction": "这个首个练习旨在帮助你建立对休恩方法（Heun's method）的“肌肉记忆”。我们将通过一个具体的单步计算，确保你理解其两阶段过程：首先使用欧拉法进行“预测”，然后使用梯形平均进行“校正”。在探索更复杂的行为之前，掌握这项基本技能至关重要。[@problem_id:2202828]", "problem": "考虑一阶常微分方程 (ODE) $y'(t) = \\sin(t) - \\frac{y(t)}{t+1}$，它描述了一个具有时变输入和随时间变化的衰减率的系统。给定初始条件 $y(0) = 2$。我们希望使用单步休恩法来近似计算 $y(0.1)$ 的值。正弦函数的参数以弧度为单位。\n\n休恩法是一种求解形式为 $y' = f(t,y)$ 且初始条件为 $y(t_0) = y_0$ 的初值问题的预测-校正算法。对于给定的步长 $h$，下一个时间步的近似值 $y_1 \\approx y(t_0+h)$ 通过两个阶段计算：\n\n1.  **预测步**：使用欧拉法估计一个中间值 $\\tilde{y}_1$：\n    $$ \\tilde{y}_1 = y_0 + h f(t_0, y_0) $$\n2.  **校正步**：通过对初始点 $(t_0, y_0)$ 的斜率和估计点 $(t_1, \\tilde{y}_1)$（其中 $t_1 = t_0 + h$）的斜率取平均，计算最终的近似值 $y_1$：\n    $$ y_1 = y_0 + \\frac{h}{2} \\left[ f(t_0, y_0) + f(t_1, \\tilde{y}_1) \\right] $$\n\n使用单步计算 $y(0.1)$ 的数值近似值。将最终答案四舍五入到四位有效数字。", "solution": "我们已知常微分方程 $y'(t)=\\sin(t)-\\dfrac{y(t)}{t+1}$，初始条件为 $y(0)=2$，并要求使用步长 $h=0.1$ 的单步休恩法求 $y(0.1)$。定义 $f(t,y)=\\sin(t)-\\dfrac{y}{t+1}$。\n\n在初始点 $(t_{0},y_{0})=(0,2)$，计算斜率：\n$$\nf(t_{0},y_{0})=f(0,2)=\\sin(0)-\\frac{2}{0+1}=0-2=-2.\n$$\n\n预测步（欧拉法）：\n$$\n\\tilde{y}_{1}=y_{0}+h\\,f(t_{0},y_{0})=2+0.1\\cdot(-2)=1.8.\n$$\n\n在点 $(t_{1},\\tilde{y}_{1})$ 处计算斜率，其中 $t_{1}=t_{0}+h=0.1$：\n$$\nf(t_{1},\\tilde{y}_{1})=f(0.1,1.8)=\\sin(0.1)-\\frac{1.8}{1.1}.\n$$\n使用弧度，$\\sin(0.1)\\approx 0.0998334166468$ 且 $\\dfrac{1.8}{1.1}\\approx 1.63636363636$，因此\n$$\nf(t_{1},\\tilde{y}_{1})\\approx 0.0998334166468-1.63636363636\\approx -1.5365302197168.\n$$\n\n校正步：\n$$\ny_{1}=y_{0}+\\frac{h}{2}\\Big(f(t_{0},y_{0})+f(t_{1},\\tilde{y}_{1})\\Big)\n=2+0.05\\left(-2-1.5365302197168\\right)\\approx 2-0.1768265109858\\approx 1.8231734890142.\n$$\n\n四舍五入到四位有效数字，得到 $y(0.1)\\approx 1.823$。", "answer": "$$\\boxed{1.823}$$", "id": "2202828"}, {"introduction": "“校正”步骤旨在提高精度，但这总是成立的吗？本练习将探讨一个与直觉相悖的“刚性”（stiff）方程场景，其中一个过大的步长会导致校正器实际上*增加*了误差。这个练习是关于数值稳定性的关键一课，对于任何计算工程师来说都是一个核心概念。[@problem_id:2428207]", "problem": "考虑常微分方程 (ODE) 的初值问题\n$$\\frac{dy}{dt}=-10\\,y,\\qquad y(0)=1.$$\n使用步长 $h=0.5$ 的单步两阶段显式梯形预估-校正法（Heun 法），将解从 $t=0$ 推进到 $t=0.5$。令 $y_{E}$ 表示在 $t=0.5$ 处获得的前向欧拉预估值，令 $y_{H}$ 表示在应用梯形校正后在 $t=0.5$ 处的校正值。令 $y^{\\ast}$ 表示在 $t=0.5$ 处的精确解。计算比率\n$$r=\\frac{|y_{H}-y^{\\ast}|}{|y_{E}-y^{\\ast}|}.$$\n将您的最终答案四舍五入到四位有效数字。不包括单位。", "solution": "该问题被验证为自洽、有科学依据且格式正确。我们开始求解。\n\n初值问题由常微分方程 (ODE) 给出\n$$ \\frac{dy}{dt} = f(t, y) = -10y $$\n初始条件为 $y(0) = 1$。\n我们的任务是使用大小为 $h = 0.5$ 的单步，从 $t_0 = 0$ 和 $y_0 = 1$ 开始，求出在 $t_1 = 0.5$ 处的数值解。最终目标是计算误差之比。\n\n首先，我们必须确定精确解，记为 $y^{\\ast}(t)$。该常微分方程是一个线性的、一阶的、可分离的方程。\n$$ \\frac{dy}{y} = -10 dt $$\n对两边积分得到：\n$$ \\int \\frac{dy}{y} = \\int (-10) dt $$\n$$ \\ln|y| = -10t + C $$\n其中 $C$ 是积分常数。对两边取指数得到：\n$$ y(t) = A \\exp(-10t) $$\n其中 $A = \\exp(C)$。我们使用初始条件 $y(0) = 1$ 来求 $A$：\n$$ 1 = A \\exp(-10 \\cdot 0) \\implies A = 1 $$\n因此，精确解为：\n$$ y^{\\ast}(t) = \\exp(-10t) $$\n在 $t=0.5$ 时，精确值为：\n$$ y^{\\ast} = y^{\\ast}(0.5) = \\exp(-10 \\cdot 0.5) = \\exp(-5) $$\n\n接下来，我们计算在 $t_1 = 0.5$ 处的前向欧拉预估值 $y_{E}$。前向欧拉法由以下公式给出：\n$$ y_{n+1} = y_n + h f(t_n, y_n) $$\n对于我们的问题，$n=0$，$y_0=1$，$t_0=0$，且 $h=0.5$。函数为 $f(t_0, y_0) = -10y_0 = -10(1) = -10$。\n因此，预估值为：\n$$ y_{E} = y_0 + h f(t_0, y_0) = 1 + (0.5)(-10) = 1 - 5 = -4 $$\n\n现在，我们使用 Heun 法（一种两阶段显式梯形预估-校正法）计算校正值 $y_{H}$。该方法定义如下：\n1. 预估步：$\\tilde{y}_{n+1} = y_n + h f(t_n, y_n)$\n2. 校正步：$y_{n+1} = y_n + \\frac{h}{2} \\left[ f(t_n, y_n) + f(t_{n+1}, \\tilde{y}_{n+1}) \\right]$\n\n预估步与前向欧拉步相同，所以我们有 $\\tilde{y}_1 = y_E = -4$。\n对于校正步，我们需要使用预估值 $\\tilde{y}_1 = -4$ 在新时间 $t_1 = 0.5$ 处计算函数 $f$ 的值。\n- 区间开始处的斜率为 $k_1 = f(t_0, y_0) = f(0, 1) = -10(1) = -10$。\n- 使用预估值估计的区间末端处的斜率为 $k_2 = f(t_1, \\tilde{y}_1) = f(0.5, -4) = -10(-4) = 40$。\n那么校正值 $y_H$ 为：\n$$ y_{H} = y_0 + \\frac{h}{2} (k_1 + k_2) = 1 + \\frac{0.5}{2} (-10 + 40) = 1 + (0.25)(30) = 1 + 7.5 = 8.5 $$\n\n最后，我们计算绝对误差之比 $r$。\n校正值的误差为 $|y_{H} - y^{\\ast}|$。\n$$ |y_{H} - y^{\\ast}| = |8.5 - \\exp(-5)| $$\n预估（欧拉）值的误差为 $|y_{E} - y^{\\ast}|$。\n$$ |y_{E} - y^{\\ast}| = |-4 - \\exp(-5)| = |- (4 + \\exp(-5))| = 4 + \\exp(-5) $$\n比率 $r$ 为：\n$$ r = \\frac{|y_{H} - y^{\\ast}|}{|y_{E} - y^{\\ast}|} = \\frac{|8.5 - \\exp(-5)|}{4 + \\exp(-5)} $$\n为了获得数值，我们使用 $\\exp(-5) \\approx 0.006737947$。\n$$ r = \\frac{8.5 - 0.006737947}{4 + 0.006737947} = \\frac{8.493262053}{4.006737947} \\approx 2.1197368 $$\n将结果四舍五入到四位有效数字，我们得到：\n$$ r \\approx 2.120 $$\n这个大于 1 的大比率表明，对于这个大的步长，校正步相对于预估步并没有提高精度，反而增加了误差。这是对一个刚性问题使用一个步长在绝对稳定区域之外的显式方法所带来的一个已知后果。", "answer": "$$\\boxed{2.120}$$", "id": "2428207"}, {"introduction": "在看到了该方法的局限性之后，我们现在将视角从分析转向设计。这个高级练习将挑战你通过引入可调权重来修改休恩方法。你的目标是找到特定的权重，使得该方法对于基本的线性测试方程 $y' = \\lambda y$ 变得*完全精确*，从而为这类重要问题创建一个完美的积分器。[@problem_id:2428224]", "problem": "在计算工程中，一个线性自治初值问题由常微分方程 (ODE) $y^{\\prime}(t) = f(t,y(t))$ 和初始条件 $y(t_0) = y_0$ 给出。考虑一个 Heun 型的两阶段预测-校正格式，该格式使用一个前向欧拉预测子，后跟一个使用斜率加权平均的校正子。具体来说，对于步长 $h > 0$，定义\n- 预测子为 $y^{(p)}_{i+1} = y_i + h f(t_i, y_i)$，\n- 校正子为 $y_{i+1} = y_i + h\\left(\\alpha f(t_i,y_i) + \\beta f(t_{i+1}, y^{(p)}_{i+1})\\right)$，\n其中 $\\alpha$ 和 $\\beta$ 是权重，它们可能依赖于无量纲步长参数 $z = h \\lambda$，这里 $\\lambda \\in \\mathbb{C}$ 是一个常数。施加相容性条件，即校正子使用两个斜率的加权平均，即 $\\alpha + \\beta = 1$。\n\n确定权重 $\\beta(z)$，使得当该格式应用于常数 $\\lambda$ 的线性测试方程 $y^{\\prime} = \\lambda y$ 时，其单步更新能重现精确解的放大关系，即对于任意 $z \\in \\mathbb{C}$ 都有 $y_{i+1} = \\exp(z) y_i$。将你的最终答案表示为 $\\beta(z)$ 的闭式解析表达式。无需进行数值舍入。", "solution": "经严格分析，该问题陈述有效。这是一个常微分方程数值分析领域的适定问题，其基础是已确立的科学原理。所有必要信息均已提供，不存在不一致或含糊之处。因此，我们可以着手推导解答。\n\n目标是确定两阶段预测-校正格式的权重 $\\beta(z)$，使其能精确地再现线性测试方程 $y^{\\prime} = \\lambda y$ 的解。无量纲步长参数为 $z = h\\lambda$，其中 $h$ 是步长，$\\lambda \\in \\mathbb{C}$ 是一个常数。\n\n给定的数值格式包含一个预测步和一个校正步：\n1.  预测子： $y^{(p)}_{i+1} = y_i + h f(t_i, y_i)$\n2.  校正子： $y_{i+1} = y_i + h\\left(\\alpha f(t_i,y_i) + \\beta f(t_{i+1}, y^{(p)}_{i+1})\\right)$\n\n我们将此格式应用于线性测试方程 $y^{\\prime}(t) = \\lambda y(t)$。对于该方程，函数 $f(t,y)$ 由 $f(t,y) = \\lambda y$ 给出。\n在所需点上的函数求值为：\n$f(t_i, y_i) = \\lambda y_i$\n$f(t_{i+1}, y^{(p)}_{i+1}) = \\lambda y^{(p)}_{i+1}$\n\n首先，我们将 $f(t_i, y_i) = \\lambda y_i$ 代入预测子方程：\n$$y^{(p)}_{i+1} = y_i + h (\\lambda y_i) = (1 + h\\lambda) y_i$$\n\n接着，我们将函数求值结果代入校正子方程：\n$$y_{i+1} = y_i + h\\left(\\alpha (\\lambda y_i) + \\beta (\\lambda y^{(p)}_{i+1})\\right)$$\n我们可以从括号内的项中提出因子 $\\lambda$：\n$$y_{i+1} = y_i + h\\lambda\\left(\\alpha y_i + \\beta y^{(p)}_{i+1}\\right)$$\n现在，我们将预测值 $y^{(p)}_{i+1}$ 替换为我们从预测步得到的表达式：\n$$y_{i+1} = y_i + h\\lambda\\left(\\alpha y_i + \\beta (1 + h\\lambda) y_i\\right)$$\n从右侧提出因子 $y_i$，得到以放大因子表示的单步更新法则：\n$$y_{i+1} = \\left[1 + h\\lambda\\left(\\alpha + \\beta(1 + h\\lambda)\\right)\\right] y_i$$\n\n问题陈述了相容性条件 $\\alpha + \\beta = 1$，这意味着 $\\alpha = 1 - \\beta$。我们将此代入放大因子的表达式中：\n$$y_{i+1} = \\left[1 + h\\lambda\\left((1 - \\beta) + \\beta(1 + h\\lambda)\\right)\\right] y_i$$\n我们来化简方括号内的项：\n$$1 + h\\lambda\\left(1 - \\beta + \\beta + \\beta h\\lambda\\right) = 1 + h\\lambda\\left(1 + \\beta h\\lambda\\right) = 1 + h\\lambda + \\beta (h\\lambda)^2$$\n因此，数值更新可以写为：\n$$y_{i+1} = \\left(1 + h\\lambda + \\beta (h\\lambda)^2\\right) y_i$$\n\n我们引入无量纲参数 $z = h\\lambda$。方程变为：\n$$y_{i+1} = \\left(1 + z + \\beta z^2\\right) y_i$$\n表达式 $R(z, \\beta) = 1 + z + \\beta z^2$ 是该数值方法的放大因子。\n\n问题要求数值格式能再现精确解的放大。对于初值问题 $y^{\\prime} = \\lambda y$ 及其初始条件 $y(t_i) = y_i$，其精确解为 $y(t) = y_i \\exp(\\lambda(t - t_i))$。在 $t_{i+1} = t_i + h$ 时刻，精确解为：\n$$y(t_{i+1}) = y_i \\exp(\\lambda h) = y_i \\exp(z)$$\n条件是数值更新必须与此精确结果相匹配，因此 $y_{i+1}$ 必须等于 $y_i \\exp(z)$。\n令数值放大因子与精确放大因子相等，我们得到：\n$$1 + z + \\beta z^2 = \\exp(z)$$\n\n现在我们必须求解此方程以得到 $\\beta$，它被指定为 $z$ 的函数，记作 $\\beta(z)$。\n$$\\beta(z) z^2 = \\exp(z) - 1 - z$$\n对于 $z \\neq 0$，我们可以除以 $z^2$ 来获得 $\\beta(z)$ 的表达式：\n$$\\beta(z) = \\frac{\\exp(z) - 1 - z}{z^2}$$\n该表达式是关于 $z$ 的一个闭式解析函数。对于 $z=0$ 的情况，该表达式是一个 $0/0$ 的不定型。我们可以通过求 $z \\to 0$ 时的极限来找到 $\\beta(0)$ 的值。使用指数函数在 $z=0$ 附近的泰勒级数展开：\n$$\\exp(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\dots$$\n将此展开式代入 $\\beta(z)$ 的表达式中：\n$$\\beta(z) = \\frac{\\left(1 + z + \\frac{z^2}{2} + O(z^3)\\right) - 1 - z}{z^2} = \\frac{\\frac{z^2}{2} + O(z^3)}{z^2} = \\frac{1}{2} + O(z)$$\n当 $z \\to 0$ 时，极限为 $\\frac{1}{2}$。因此，函数 $\\beta(z)$ 对所有 $z \\in \\mathbb{C}$ 都有良好定义，且 $\\beta(0) = \\frac{1}{2}$。所推导出的表达式即为所求的闭式解。", "answer": "$$\n\\boxed{\\frac{\\exp(z) - 1 - z}{z^2}}\n$$", "id": "2428224"}]}