{"hands_on_practices": [{"introduction": "掌握任何一种数值方法都需要动手实践。本练习旨在帮助你熟练掌握不带主元选择的LU分解的基本步骤。通过按部就班地将一个矩阵分解为其三角分量 $L$ 和 $U$，你将为高效求解线性方程组奠定坚实的基础。[@problem_id:1029988]", "problem": "考虑 3×3 矩阵 $A$ 如下：\n\n$$\nA = \\begin{bmatrix}\n1 & 3 & 2 \\\\\n4 & 2 & 1 \\\\\n3 & 1 & 2\n\\end{bmatrix}.\n$$\n\n在不进行主元选择（pivoting）的情况下，计算 $A$ 的 LU 分解，其中 $L$ 是一个单位下三角矩阵，$U$ 是一个上三角矩阵。求出矩阵 $U$ 的元素 $u_{33}$（即第三行第三列的元素）。", "solution": "我们寻求 $A=LU$，其中 \n$$L=\\begin{bmatrix}1&0&0\\\\l_{21}&1&0\\\\l_{31}&l_{32}&1\\end{bmatrix},\\quad\nU=\\begin{bmatrix}u_{11}&u_{12}&u_{13}\\\\0&u_{22}&u_{23}\\\\0&0&u_{33}\\end{bmatrix}。$$\n\n步骤 1：从 $A$ 得到 $U$ 的第一行：\n$$u_{11}=a_{11}=1,\\quad u_{12}=a_{12}=3,\\quad u_{13}=a_{13}=2.$$\n\n步骤 2：计算 $L$ 第一列中对角线下方的元素：\n$$l_{21}=\\frac{a_{21}}{u_{11}}=\\frac{4}{1}=4,\\quad\nl_{31}=\\frac{a_{31}}{u_{11}}=\\frac{3}{1}=3.$$\n\n步骤 3：计算 $U$ 的第二行：\n$$u_{22}=a_{22}-l_{21}u_{12}=2-4\\cdot3=2-12=-10,$$\n$$u_{23}=a_{23}-l_{21}u_{13}=1-4\\cdot2=1-8=-7.$$\n\n步骤 4：计算对角线下方的元素 $l_{32}$：\n$$l_{32}=\\frac{a_{32}-l_{31}u_{12}}{u_{22}}\n=\\frac{1-3\\cdot3}{-10}=\\frac{1-9}{-10}=\\frac{-8}{-10}=\\frac{4}{5}.$$\n\n步骤 5：最后，计算 $u_{33}$：\n$$u_{33}=a_{33}-l_{31}u_{13}-l_{32}u_{23}\n=2-3\\cdot2-\\frac{4}{5}\\,(-7)\n=2-6+\\frac{28}{5}\n=-4+\\frac{28}{5}\n=\\frac{-20+28}{5}\n=\\frac{8}{5}。$$", "answer": "$$\\boxed{\\frac{8}{5}}$$", "id": "1029988"}, {"introduction": "这个练习将引导你从“如何做”转向“为什么这么做”。它提出了一个标准LU分解算法会失败的场景，即使面对的是一个完全可解的非奇异矩阵。这个思想实验对于理解数值稳定性的概念至关重要，并让你领会为何主元选择（pivoting）不仅仅是一个可选项，而是构建一个稳健算法的必要组成部分。[@problem_id:2407904]", "problem": "一位经济学家正在为一个包含 $3$ 个金融部门的程式化交叉风险暴露网络建模，其中每个部门的内生融资成本仅依赖于其他部门的短期利率，而不依赖于其自身的利率。这种刻意的建模选择对应于一种零自身效应的极端交叉依赖情况，这可能在记账单位归一化或具有约束力的无自我借贷规则下出现。由此产生的线性系统表示为 $A x = b$，其中\n$$\nA \\;=\\; \\begin{pmatrix}\n0 & 1 & 1 \\\\\n1 & 0 & 1 \\\\\n1 & 1 & 0\n\\end{pmatrix},\n$$\n其中对角线上的零元素代表没有直接的自我依赖，而非对角线上的“一”则代表对称的交叉依赖。\n\n从高斯消元法和 LU (Lower-Upper) 分解的核心定义出发，解释为什么在没有主元选择的情况下，朴素的 LU 分解对矩阵 $A$ 会失败，尽管其底层系统是适定的。然后，仅使用行列式和消元法的基本性质，确定 $\\det(A)$ 的确切值。以精确形式给出最终答案，不要四舍五入。", "solution": "问题要求做两件事：首先，解释为什么对给定矩阵 $A$ 进行朴素的 LU (Lower-Upper) 分解会失败；其次，使用基本原理计算 $A$ 的行列式。\n\n所讨论的矩阵是：\n$$\nA = \\begin{pmatrix}\n0 & 1 & 1 \\\\\n1 & 0 & 1 \\\\\n1 & 1 & 0\n\\end{pmatrix}\n$$\n\n第 1 部分：无主元选择的朴素 LU 分解的失败\n\n矩阵 $A$ 的 $LU$ 分解是寻找一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 使得 $A = LU$ 的过程。通常，$L$ 被约束为单位下三角矩阵，意味着其对角线元素都为 $1$。矩阵 $U$ 是通过高斯消元过程得到的，而矩阵 $L$ 存储了用于在 $A$ 的下半部分制造零的乘数。\n\n高斯消元算法通过使用称为主元的对角线元素来消除每列中其下方的非零项。让我们对矩阵 $A$ 尝试这个过程。\n\n第一步是使用主元元素 $a_{11}$ 来消除元素 $a_{21}$ 和 $a_{31}$。标准的行操作是：\n$R_2 \\rightarrow R_2 - l_{21} R_1$\n$R_3 \\rightarrow R_3 - l_{31} R_1$\n其中乘数为 $l_{21} = \\frac{a_{21}}{a_{11}}$ 和 $l_{31} = \\frac{a_{31}}{a_{11}}$。\n\n在我们的矩阵 $A$ 中，第一个主元元素是 $a_{11} = 0$。第一个乘数 $l_{21}$ 的计算需要以下操作：\n$$\nl_{21} = \\frac{a_{21}}{a_{11}} = \\frac{1}{0}\n$$\n这个操作构成了除以零，这是一个未定义的数学运算。因此，标准高斯消元算法无法通过第一步。由于朴素的 $LU$ 分解算法是这个消元过程的直接实现，它在一开始就失败了。这种失败的发生，正是因为主元元素为零。在实践中，这个问题的补救方法是主元选择，它涉及行交换以将非零元素置于主元位置。问题指定了“朴素”分解，根据定义，这排除了此类主元选择策略。\n\n因此，尽管系统 $Ax=b$ 是适定的（我们将通过证明 $\\det(A) \\neq 0$ 来证实这一点），但用于 $LU$ 分解的朴素计算算法由于在主元位置的对角线上存在零而失败。\n\n第 2 部分：使用基本性质计算 $\\det(A)$\n\n问题要求使用初等行操作下行列式的性质来确定 $\\det(A)$。关键性质是：\n1.  交换矩阵的两行，其行列式乘以 $-1$。\n2.  将一行的倍数加到另一行，行列式不变。\n3.  上三角矩阵的行列式是其对角线元素的乘积。\n\n我们将把 $A$ 转换为上三角形式，并跟踪行列式如何变化。\n$$\nA = \\begin{pmatrix}\n0 & 1 & 1 \\\\\n1 & 0 & 1 \\\\\n1 & 1 & 0\n\\end{pmatrix}\n$$\n如前所述，主元 $a_{11} = 0$ 是有问题的。我们执行一次行交换，例如 $R_1 \\leftrightarrow R_2$。根据性质 1，这会引入一个因子 $-1$。\n$$\n\\det(A) = - \\det \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n1 & 1 & 0\n\\end{pmatrix}\n$$\n新的主元是 $1$，非零。元素 $a_{21}$ 已经是 $0$ 了。我们通过执行行操作 $R_3 \\rightarrow R_3 - R_1$ 来消除 $a_{31} = 1$。根据性质 2，这个操作不改变行列式。\n$$\n\\det(A) = - \\det \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n1-1 & 1-0 & 0-1\n\\end{pmatrix}\n= - \\det \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n0 & 1 & -1\n\\end{pmatrix}\n$$\n现在，我们使用第二个主元 $a_{22} = 1$ 来消除元素 $a_{32} = 1$。我们执行行操作 $R_3 \\rightarrow R_3 - R_2$。同样，这不改变行列式。\n$$\n\\det(A) = - \\det \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n0-0 & 1-1 & -1-1\n\\end{pmatrix}\n= - \\det \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n0 & 0 & -2\n\\end{pmatrix}\n$$\n得到的矩阵是一个上三角矩阵，我们称之为 $U$。根据性质 3，其行列式是对角线元素的乘积：\n$$\n\\det(U) = (1)(1)(-2) = -2\n$$\n因此，原始矩阵 $A$ 的行列式是：\n$$\n\\det(A) = - \\det(U) = -(-2) = 2\n$$\n由于 $\\det(A) = 2 \\neq 0$，矩阵 $A$ 是可逆的，并且线性系统 $Ax=b$ 对于任何向量 $b$ 都有唯一解。这证实了问题本身的断言，即尽管朴素分解算法失败，但底层系统是适定的。", "answer": "$$\\boxed{2}$$", "id": "2407904"}, {"introduction": "这个高级练习展示了LU分解的真正威力与灵活性。它要求你利用预先计算好的因子（$P$、$L$ 和 $U$）来解决一个不同但相关的方程组 $A^T x = b$，而无需从头重新计算矩阵 $A$ 或其转置。这项技能在许多工程和科学应用中都至关重要，例如在优化问题中求解伴随方程，它体现了将矩阵分解作为一种预处理工具的计算优势。[@problem_id:2410733]", "problem": "在计算工程中，带行主元选择的下上三角（LU）分解将一个矩阵表示为一个置换矩阵和多个三角因子，从而能够高效地求解线性系统。假设给定一个置换矩阵 $P \\in \\mathbb{R}^{n \\times n}$、一个单位下三角矩阵 $L \\in \\mathbb{R}^{n \\times n}$ 和一个上三角矩阵 $U \\in \\mathbb{R}^{n \\times n}$，对于一个未知的非奇异矩阵 $A \\in \\mathbb{R}^{n \\times n}$，它们满足 $P A = L U$。请仅使用置换矩阵、三角矩阵和转置的基本性质，推导一个算法来求解转置系统 $A^{\\top} x = b$，而不显式地构造 $A$ 或 $A^{\\top}$。你的推导必须从定义关系式 $P A = L U$ 和恒等式 $P^{\\top} = P^{-1}$ 及 $\\left(X Y\\right)^{\\top} = Y^{\\top} X^{\\top}$ 开始，并且必须论证所使用的三角求解的顺序和类型。\n\n然后，将你推导的算法应用于下面的具体数据，并计算出精确解向量 $x$：\n$$\nP = \\begin{pmatrix}\n0 & 0 & 1 \\\\\n0 & 1 & 0 \\\\\n1 & 0 & 0\n\\end{pmatrix}, \\quad\nL = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n2 & 1 & 0 \\\\\n-1 & 3 & 1\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\n2 & -1 & 1 \\\\\n0 & 3 & 4 \\\\\n0 & 0 & 5\n\\end{pmatrix}, \\quad\nb = \\begin{pmatrix}\n1 \\\\ 2 \\\\ 3\n\\end{pmatrix}.\n$$\n在计算中不要显式地构造 $A$ 或 $A^{\\top}$；仅使用 $P$、$L$、$U$ 和 $b$。将你的最终答案表示为一个单行向量，其元素为精确有理数。无需四舍五入。", "solution": "**算法推导**\n目标是解线性系统 $A^{\\top} x = b$ 以求出未知向量 $x$。推导的起点是给定的分解式 $P A = L U$。\n\n首先，我们必须用给定的因子 $P$、$L$ 和 $U$ 来表示 $A^{\\top}$。从初始方程中，我们分离出 $A$：\n$$ P A = L U $$\n由于 $P$ 是一个置换矩阵，其逆矩阵等于其转置矩阵，即 $P^{-1} = P^{\\top}$。左乘 $P^{\\top}$ 得到：\n$$ P^{\\top} P A = P^{\\top} L U $$\n$$ I A = P^{\\top} L U $$\n$$ A = P^{\\top} L U $$\n现在，我们对这个 $A$ 的表达式进行转置。使用性质 $(XYZ)^{\\top} = Z^{\\top}Y^{\\top}X^{\\top}$，我们得到：\n$$ A^{\\top} = (P^{\\top} L U)^{\\top} = U^{\\top} L^{\\top} (P^{\\top})^{\\top} $$\n由于 $(P^{\\top})^{\\top} = P$，$A^{\\top}$ 的表达式简化为：\n$$ A^{\\top} = U^{\\top} L^{\\top} P $$\n将此代入系统 $A^{\\top} x = b$：\n$$ (U^{\\top} L^{\\top} P) x = b $$\n为了求解该系统的 $x$，我们引入中间向量来逐步求解。这避免了矩阵-矩阵乘法，并使我们能够求解一系列更简单的系统。让我们定义一个向量 $y$ 为：\n$$ y = P x $$\n将此代入方程得到：\n$$ U^{\\top} L^{\\top} y = b $$\n接下来，让我们定义一个向量 $z$ 为：\n$$ z = L^{\\top} y $$\n代入得到：\n$$ U^{\\top} z = b $$\n这一系列的代换定义了一个求解 $x$ 的三步算法：\n\n1.  **求解 $z$**：解系统 $U^{\\top} z = b$。由于 $U$ 是一个上三角矩阵，其转置 $U^{\\top}$ 是一个下三角矩阵。因此，该系统可通过**前向代入法**高效求解。\n2.  **求解 $y$**：解系统 $L^{\\top} y = z$。由于 $L$ 是一个单位下三角矩阵，其转置 $L^{\\top}$ 是一个单位上三角矩阵。该系统可通过**回代法**高效求解。\n3.  **求解 $x$**：从定义式 $y = P x$ 中，我们通过应用 $P$ 的逆来求 $x$：$x = P^{-1} y$。使用性质 $P^{-1} = P^{\\top}$，我们得到 $x = P^{\\top} y$。这最后一步是对向量 $y$ 的元素进行简单的置换。\n\n该算法在求解 $x$ 的过程中，从未显式计算矩阵 $A$ 或其转置 $A^{\\top}$。\n\n**应用于给定数据**\n我们现在将此算法应用于给定的矩阵和向量。\n给定的数据是：\n$$ P = \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & 1 & 0 \\\\ 1 & 0 & 0 \\end{pmatrix}, \\quad L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 2 & -1 & 1 \\\\ 0 & 3 & 4 \\\\ 0 & 0 & 5 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} $$\n我们需要 $U$、$L$ 和 $P$ 的转置矩阵：\n$$ U^{\\top} = \\begin{pmatrix} 2 & 0 & 0 \\\\ -1 & 3 & 0 \\\\ 1 & 4 & 5 \\end{pmatrix}, \\quad L^{\\top} = \\begin{pmatrix} 1 & 2 & -1 \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\quad P^{\\top} = \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & 1 & 0 \\\\ 1 & 0 & 0 \\end{pmatrix} $$\n**步骤1：用前向代入法求解 $U^{\\top} z = b$。**\n$$ \\begin{pmatrix} 2 & 0 & 0 \\\\ -1 & 3 & 0 \\\\ 1 & 4 & 5 \\end{pmatrix} \\begin{pmatrix} z_1 \\\\ z_2 \\\\ z_3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} $$\n从第一行：$2z_1 = 1 \\implies z_1 = \\frac{1}{2}$。\n从第二行：$-z_1 + 3z_2 = 2 \\implies -(\\frac{1}{2}) + 3z_2 = 2 \\implies 3z_2 = \\frac{5}{2} \\implies z_2 = \\frac{5}{6}$。\n从第三行：$z_1 + 4z_2 + 5z_3 = 3 \\implies \\frac{1}{2} + 4(\\frac{5}{6}) + 5z_3 = 3 \\implies \\frac{1}{2} + \\frac{10}{3} + 5z_3 = 3 \\implies \\frac{23}{6} + 5z_3 = 3 \\implies 5z_3 = 3 - \\frac{23}{6} = -\\frac{5}{6} \\implies z_3 = -\\frac{1}{6}$。\n所以，中间向量 $z$ 是 $z = \\begin{pmatrix} 1/2 \\\\ 5/6 \\\\ -1/6 \\end{pmatrix}$。\n\n**步骤2：用回代法求解 $L^{\\top} y = z$。**\n$$ \\begin{pmatrix} 1 & 2 & -1 \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 5/6 \\\\ -1/6 \\end{pmatrix} $$\n从第三行：$y_3 = -\\frac{1}{6}$。\n从第二行：$y_2 + 3y_3 = \\frac{5}{6} \\implies y_2 + 3(-\\frac{1}{6}) = \\frac{5}{6} \\implies y_2 - \\frac{1}{2} = \\frac{5}{6} \\implies y_2 = \\frac{5}{6} + \\frac{3}{6} = \\frac{8}{6} = \\frac{4}{3}$。\n从第一行：$y_1 + 2y_2 - y_3 = \\frac{1}{2} \\implies y_1 + 2(\\frac{4}{3}) - (-\\frac{1}{6}) = \\frac{1}{2} \\implies y_1 + \\frac{8}{3} + \\frac{1}{6} = \\frac{1}{2} \\implies y_1 + \\frac{16}{6} + \\frac{1}{6} = \\frac{3}{6} \\implies y_1 + \\frac{17}{6} = \\frac{3}{6} \\implies y_1 = \\frac{3-17}{6} = -\\frac{14}{6} = -\\frac{7}{3}$。\n所以，中间向量 $y$ 是 $y = \\begin{pmatrix} -7/3 \\\\ 4/3 \\\\ -1/6 \\end{pmatrix}$。\n\n**步骤3：计算 $x = P^{\\top} y$。**\n$$ x = \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & 1 & 0 \\\\ 1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} -7/3 \\\\ 4/3 \\\\ -1/6 \\end{pmatrix} = \\begin{pmatrix} -1/6 \\\\ 4/3 \\\\ -7/3 \\end{pmatrix} $$\n最终解向量 $x$ 包含所要求的精确有理数项。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{6} & \\frac{4}{3} & -\\frac{7}{3}\n\\end{pmatrix}\n}\n$$", "id": "2410733"}]}