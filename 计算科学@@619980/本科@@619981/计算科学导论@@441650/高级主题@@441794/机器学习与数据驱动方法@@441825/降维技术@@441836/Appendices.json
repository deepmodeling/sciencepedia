{"hands_on_practices": [{"introduction": "降维不仅仅是为了数据可视化；它还可以将复杂信息提炼成有意义的指标。本练习将向您展示如何利用主成分分析（PCA）的载荷（loadings）来构建一个“元基因”分数，这是基因组学研究中一项常见的实用技术，它将抽象的主成分转化为一个可量化的生物学特征。[@problem_id:1428922]", "problem": "在系统生物学中，主成分分析 (PCA) 是一种强大的技术，用于降低大型数据集（例如癌症患者的基因表达谱）的维度。一个常见的应用是推导出一个“元基因分数”，用以概括某一生物通路的活性。\n\n一位研究人员正在研究癌细胞中一个特定的代谢通路，该通路涉及四个关键基因：Gene A、Gene B、Gene C 和 Gene D。他们对一个大型基因表达数据集进行 PCA 分析，发现第一主成分 (PC1) 与该通路的整体活性密切相关。他们决定使用 PC1 的载荷作为权重，为新样本创建一个通路活性分数。\n\n这四个基因的 PC1 载荷如下：\n- Gene A: 0.65\n- Gene B: 0.55\n- Gene C: -0.40\n- Gene D: 0.30\n\n现分析一个新的肿瘤样本，并测量了这四个基因的标准化表达值（z-分数）：\n- Gene A: 2.20\n- Gene B: 1.80\n- Gene C: 1.50\n- Gene D: -1.10\n\n这个新样本的通路活性分数计算方法为：每个基因的表达值与其对应的 PC1 载荷的乘积之和。计算这个新肿瘤样本的通路活性分数。将最终答案四舍五入到三位有效数字。", "solution": "题目要求我们为一个新的肿瘤样本计算“通路活性分数”。该分数的定义是：每个基因的标准化表达值与其对应的主成分1 (PC1) 载荷的乘积之和。这等同于计算表达向量和载荷向量的点积。\n\n设 PC1 载荷向量为 $\\mathbf{w}$，基因表达值向量为 $\\mathbf{g}$。\n基因 A、B、C 和 D 的载荷向量 $\\mathbf{w}$ 如下所示：\n$$ \\mathbf{w} = \\begin{pmatrix} 0.65 \\\\ 0.55 \\\\ -0.40 \\\\ 0.30 \\end{pmatrix} $$\n\n新样本的基因表达向量 $\\mathbf{g}$ 如下所示：\n$$ \\mathbf{g} = \\begin{pmatrix} 2.20 \\\\ 1.80 \\\\ 1.50 \\\\ -1.10 \\end{pmatrix} $$\n\n通路活性分数 $S$ 计算为点积 $\\mathbf{w} \\cdot \\mathbf{g}$：\n$$ S = \\sum_{i=1}^{4} w_i g_i = w_A g_A + w_B g_B + w_C g_C + w_D g_D $$\n\n现在，我们将给定的数值代入此公式：\n$$ S = (0.65)(2.20) + (0.55)(1.80) + (-0.40)(1.50) + (0.30)(-1.10) $$\n\n我们逐项计算每个乘积：\n- 对于 Gene A：$0.65 \\times 2.20 = 1.43$\n- 对于 Gene B：$0.55 \\times 1.80 = 0.99$\n- 对于 Gene C：$-0.40 \\times 1.50 = -0.60$\n- 对于 Gene D：$0.30 \\times -1.10 = -0.33$\n\n现在，我们将这些乘积相加得到最终分数：\n$$ S = 1.43 + 0.99 - 0.60 - 0.33 $$\n$$ S = 2.42 - 0.60 - 0.33 $$\n$$ S = 1.82 - 0.33 $$\n$$ S = 1.49 $$\n\n题目要求将答案四舍五入到三位有效数字。计算出的值 $1.49$ 已经有三位有效数字。\n\n因此，通路活性分数为 1.49。", "answer": "$$\\boxed{1.49}$$", "id": "1428922"}, {"introduction": "主成分分析是探索性数据分析的强大工具，但其揭示的最显著模式有时并非我们所期望的生物学信号，而是实验过程中的技术性偏差。这个思想实验旨在培养一种至关重要的技能：如何审慎地解读PCA图，并识别那些可能扭曲我们结论的“批次效应”（batch effects）。[@problem_id:1428916]", "problem": "一位系统生物学研究人员正在研究一种新药“DrugX”对特定类型癌细胞系的基因表达谱的影响。实验设计如下：准备了8份相同的癌细胞培养物。其中4份用DrugX处理（“处理组”），另外4份用安慰剂处理（“对照组”）。\n\n由于实验室的时间限制，研究人员在周一处理了所有4个对照组样本进行RNA测序。第二天，即周二，研究人员处理了所有4个处理组样本。在获得8个样本中每个样本的20,000个基因的表达水平后，研究人员进行了主成分分析（PCA），这是一种降维技术，用于识别数据集中的最大方差方向。\n\n在绘制第一主成分（PC1）与第二主成分（PC2）的散点图时，研究人员观察到8个样本形成了两个非常清晰、不重叠的聚类。对样本进行标记后，可以清楚地看到，一个聚类包含了周一处理的所有4个样本（对照组），而另一个聚类包含了周二处理的所有4个样本（处理组）。这两个聚类之间的分离是该图最显著的特征。\n\n根据这个PCA结果，该基因表达数据集中最显著的变异来源是什么？\n\nA. DrugX对癌细胞基因表达的生物学效应。\n\nB. 与样本处理日期相关的系统性、非生物学差异。\n\nC. RNA测序测量过程中固有的随机统计噪声。\n\nD. 8个不同细胞培养物之间的自然遗传变异。\n\nE. 第二主成分（PC2）所捕获的变异。", "solution": "本题的目标是在生物学实验的背景下正确解释主成分分析（PCA）的结果。\n\n步骤1：理解PCA的目的。\n主成分分析是一种统计程序，用于降低数据集的维度，同时尽可能多地保留原始变异。它通过将数据转换为一组新的变量——主成分（PCs）来实现这一点，这些主成分是原始变量的无相关线性组合序列。第一主成分（PC1）被构建为解释数据中最大可能的方差。第二主成分（PC2）解释第二大的方差，依此类推。\n\n步骤2：分析所述的PCA结果。\n问题陈述，当数据被绘制成图时，样本形成了两个不同的聚类。这意味着一个聚类中的样本与另一个聚类中的样本之间存在巨大的系统性差异。此外，问题明确指出，这种聚类完美地将周一处理的样本与周二处理的样本分开了。由于PC1和PC2被用于绘图并显示出这种清晰的分离，这意味着数据集中最大的变异来源（主要由PC1捕获）与处理日期密切相关。\n\n步骤3：评估实验设计和潜在的变异来源。\n该实验旨在测量“对照组”和“处理组”之间的差异。然而，实验过程引入了一个混杂变量：所有对照组样本都在一天（周一）处理，而所有处理组样本都在另一天（周二）处理。这产生了一种“批次效应”（batch effect），即处理批次之间的技术差异（例如，不同的试剂制备、环境温度的微小差异或不同日期的机器校准）可能会在数据中引入系统性的、非生物学的变化。\n\n步骤4：根据分析评估给定的选项。\n\nA. DrugX对癌细胞基因表达的生物学效应。\n如果这是最显著的变异来源，PCA图将显示“对照组”和“处理组”之间的清晰分离。虽然观察到的聚类确实对应于对照组与处理组，但它们*也*完美地对应于周一与周二。由于实验设计混淆了这两个因素，我们无法确定这种分离是由药物引起的。处理在不同日期进行这一事实，为系统性差异提供了一个强有力的替代解释。这种现象，即批次效应，在高通量生物学中是一个非常常见且强大的变异来源，其影响通常大于所关注的生物学效应。“系统性、非生物学差异”这一措辞是对批次效应更精确的描述。\n\nB. 与样本处理日期相关的系统性、非生物学差异。\n这是最可能的解释。PCA发现数据中最大的方差与处理日期完全一致。这表明存在强烈的批次效应。周一和周二完成的实验室工作之间的差异（试剂、机器状态、环境因素）引入了一个比其他变异来源更大的系统性信号。PCA正确地将此识别为主要模式。\n\nC. RNA测序测量过程中固有的随机统计噪声。\n随机噪声会导致数据点分散，但不会形成两个清晰、紧密的聚类。聚类是系统性效应的标志，而非随机效应。\n\nD. 8个不同细胞培养物之间的自然遗传变异。\n问题陈述准备了8份*相同*的癌细胞培养物。这意味着它们来自同一细胞系，并且在生物学上尽可能相同，因此不期望显著的遗传变异成为差异的主要驱动因素。即使存在微小变异，也不应期望它们与处理日期完全相关。\n\nE. 第二主成分（PC2）所捕获的变异。\n这种说法根本上是对PCA的误解。根据定义，PC1捕获数据中最大的方差量。PC2捕获第二大的方差量。因此，PC2捕获的变异不可能是整体上*最显著*的变异来源。\n\n结论：PCA图最显著的特征（按日期聚类）反映了数据中最大的变异来源。这种变异可归因于两批样本处理方式的系统性差异，即批次效应。", "answer": "$$\\boxed{B}$$", "id": "1428916"}, {"introduction": "从线性的PCA转向t-SNE等非线性方法，我们获得了可视化复杂数据流形的强大能力，但同时也需要理解其关键参数。本练习将深入探讨t-SNE中最重要的超参数——“困惑度”（perplexity），并揭示其在保留数据的局部结构与全局结构之间所做的基本权衡。[@problem_id:1428872]", "problem": "一位系统生物学家正在分析一个高维单细胞RNA测序（scRNA-seq）数据集，该数据集包含15,000个细胞，每个细胞由20,000个不同基因的表达水平来表征。根据先前的生物学研究，已知该数据集应包含几个大的、表型相似的细胞群体，以及几个对于特定生物功能至关重要但稀有的独特亚群。\n\n为了可视化细胞异质性，该生物学家使用了t-分布随机邻域嵌入（t-SNE）算法。t-SNE中的困惑度（perplexity）参数可以概念化为在学习数据结构时为每个细胞所考虑的有效最近邻数量的一种软度量。该生物学家使用不同的困惑度设置进行了两次独立的分析：\n\n1.  **运行1（困惑度 = 5）：** 生成的二维图显示了已知的稀有亚群的极佳分离，每个亚群都形成了一个小而紧凑的孤立簇。然而，大的、占主导地位的细胞群体似乎分裂成了多个看似不相连的较小簇，使得难以辨别它们的整体关系。\n2.  **运行2（困惑度 = 100）：** 生成的二维图将大的细胞群体显示为内聚且轮廓分明的“大陆”，为主要细胞类型的全局结构提供了清晰的视图。然而，在这种可视化中，稀有的亚群不再能被识别为独立的簇；它们似乎被吸收到了较大群体的边缘。\n\n根据这些观察结果和t-SNE算法的原理，以下哪个陈述对结果提供了最准确的解释？\n\nA. 低困惑度值使t-SNE算法优先保留数据的局部结构，这对于解析稀有、密集的簇是有效的。高困惑度值使算法优先考虑更全局的结构，这更适合于可视化大群体之间的关系，但可能会掩盖小群体。\n\nB. 低困惑度值使t-SNE算法关注全局结构，这就是为什么主要群体被分裂的原因。高困惑度值使算法关注局部结构，这就是为什么稀有群体被合并到较大群体中的原因。\n\nC. 高困惑度的运行很可能对数据集中的噪声产生了过拟合，从而创造了人为的细胞大陆。低困惑度的运行更稳健，并揭示了所有细胞群体的真实、碎片化的性质。\n\nD. 高困惑度图中的大“大陆”之间的距离可以被确信地解释为其转录差异性的度量。低困惑度图扭曲了这些大尺度距离，这就是为什么它对全局分析没有用处。\n\nE. 结果的差异是因为困惑度参数隐含地设定了t-SNE期望找到的簇的数量。低困惑度对应于高数量的预期簇，而高困惑度对应于低数量的预期簇。", "solution": "t-SNE使用高斯核 $p_{j|i} \\propto \\exp\\!\\left(-\\frac{\\|x_{i}-x_{j}\\|^{2}}{2\\sigma_{i}^{2}}\\right)$ 构建高维条件相似性 $p_{j|i}$，通过选择 $\\sigma_{i}$ 使得 $P_{i}=\\{p_{j|i}\\}_{j}$ 的香农熵 $H(P_{i})$ 通过 $Perp(P_{i})=2^{H(P_{i})}$ 产生用户选择的困惑度。较小的困惑度强制使用较小的 $\\sigma_{i}$，将概率质量集中在极少数最近邻上（强调非常局部的结构）。较大的困惑度强制使用较大的 $\\sigma_{i}$，将概率质量分散到许多邻居上（强调更广泛、更介观的结构）。低维相似性 $q_{ij}$ 是用重尾的t-分布核（Student kernel）定义的，t-SNE最小化Kullback–Leibler散度 $\\mathrm{KL}(P\\|Q)$，该散度优先保留局部邻域（它对丢失邻居的惩罚远大于引入虚假的远距离邻居），这使得t-SNE本质上是局部的。\n\n解释运行结果：\n- 困惑度 $=5$：由于有效邻居非常少，该方法擅长解析小的、紧凑的、稀有的簇（它们的强局部密度被保留），但可能会将大的、异质的群体分裂成多个部分，因为只强调了非常局部的关系，从而妨碍了更广泛结构的内聚性。\n- 困惑度 $=100$：由于有效邻居很多，更广泛的结构被强调，使得大群体能够以内聚的大陆形式出现。然而，非常小的稀有簇可能会被吸收到更大的邻域中，失去其独特的分离。\n\n评估选项：\n- A 正确地指出，低困惑度强调局部结构（有利于稀有、密集的簇），而高困惑度强调更全局或介观的结构（有利于大群体关系的可视化，但可能掩盖小簇）。\n- B 颠倒了局部/全局的重点，与t-SNE的已知行为和观察结果不一致。\n- C 错误地将高困惑度的结果归因于过拟合，并声称低困惑度揭示了真实的碎片化；这种行为是由邻域尺度驱动的，而不是对噪声的过拟合。\n- D 声称t-SNE中大陆间的距离可以被确信地解释为转录差异性；t-SNE不能可靠地保留全局距离，所以这是不正确的。\n- E 错误地声称困惑度设定了预期的簇数量；困惑度控制的是有效邻域的大小，而不是簇的数量。\n\n因此，正确的解释是A。", "answer": "$$\\boxed{A}$$", "id": "1428872"}]}