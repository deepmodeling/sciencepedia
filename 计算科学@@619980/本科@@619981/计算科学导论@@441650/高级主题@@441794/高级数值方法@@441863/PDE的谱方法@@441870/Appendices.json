{"hands_on_practices": [{"introduction": "在应用谱方法求解偏微分方程时，一个常见且关键的初始步骤是将问题从其物理域转换到一个标准的计算域上。这个过程，称为坐标变换，简化了数值算法的应用，因为许多谱方法（如切比雪夫或勒让德谱方法）的基函数是在规范区间（如 $[-1, 1]$）上定义的。通过这个练习，你将实践如何通过一个简单的线性映射来变换一维波动方程，并理解这种变换如何影响方程本身的系数 [@problem_id:2204881]。", "problem": "在数值分析领域，通常的做法是先将偏微分方程（PDE）从其物理域变换到标准化的计算域，然后再进行求解。考虑一维波动方程，它描述了诸如弦振动等现象：\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\n其中，$u(x, t)$ 表示在位置 $x$ 和时间 $t$ 上的位移，$c$ 是一个表示波速的正实数常数。该方程定义在一个物理域上，由空间区间 $x \\in [a, b]$ 给出，其中 $a$ 和 $b$ 是满足 $a  b$ 的实值常数。\n\n为了应用许多数值方法（如谱方法），在标准域 $\\xi \\in [-1, 1]$ 上进行计算会很方便。我们引入一个线性变量代换，将物理域 $[a, b]$ 映射到计算域 $[-1, 1]$。记此变换为 $x = x(\\xi)$。原始坐标系中的解 $u(x, t)$ 在变换后的坐标系中成为一个新函数 $v(\\xi, t)$。\n\n应用此变量代换后，波动方程将变换为一个关于 $v(\\xi, t)$ 的新方程，其形式如下：\n$$\n\\frac{\\partial^2 v}{\\partial t^2} = K \\frac{\\partial^2 v}{\\partial \\xi^2}\n$$\n请用原始参数 $a, b$ 和 $c$ 表示系数 $K$ 的表达式。", "solution": "我们通过一个线性函数将物理区间 $x \\in [a,b]$ 映射到计算区间 $\\xi \\in [-1,1]$\n$$\nx(\\xi) = \\frac{b-a}{2}\\,\\xi + \\frac{a+b}{2},\n$$\n因此 $x_{\\,\\xi} = \\frac{b-a}{2}$，这是一个常数。定义 $v(\\xi,t)$ 为 $v(\\xi,t) = u(x(\\xi),t)$。由于 $t$ 没有改变，时间导数满足\n$$\nv_{t} = u_{t}, \\qquad v_{tt} = u_{tt}.\n$$\n对于空间导数，应用链式法则：\n$$\nv_{\\,\\xi} = u_{x}\\,x_{\\,\\xi} \\quad \\Longrightarrow \\quad u_{x} = \\frac{v_{\\,\\xi}}{x_{\\,\\xi}}.\n$$\n对 $u_{x}$ 关于 $x$ 求导以得到 $u_{xx}$。利用 $x_{\\,\\xi}$ 是常数以及 $\\xi_{\\,x} = \\frac{1}{x_{\\,\\xi}}$，我们得到\n$$\nu_{xx} = \\frac{\\partial}{\\partial x}\\left(u_{x}\\right) = \\frac{\\partial}{\\partial \\xi}\\left(\\frac{v_{\\,\\xi}}{x_{\\,\\xi}}\\right)\\,\\xi_{\\,x} = \\left(\\frac{v_{\\,\\xi\\xi}}{x_{\\,\\xi}}\\right)\\left(\\frac{1}{x_{\\,\\xi}}\\right) = \\frac{v_{\\,\\xi\\xi}}{x_{\\,\\xi}^{2}}.\n$$\n代入原始波动方程 $u_{tt} = c^{2} u_{xx}$ 得到\n$$\nv_{tt} = c^{2}\\,\\frac{v_{\\,\\xi\\xi}}{x_{\\,\\xi}^{2}}.\n$$\n与目标形式 $v_{tt} = K\\,v_{\\,\\xi\\xi}$ 进行比较，可得\n$$\nK = \\frac{c^{2}}{x_{\\,\\xi}^{2}} = \\frac{c^{2}}{\\left(\\frac{b-a}{2}\\right)^{2}} = \\frac{4c^{2}}{(b-a)^{2}}.\n$$", "answer": "$$\\boxed{\\frac{4c^{2}}{(b-a)^{2}}}$$", "id": "2204881"}, {"introduction": "谱方法的核心思想是将解表示为一组基函数的级数和，这些基函数通常具有优良的正交性。为了构建这样的表示，我们必须能够计算出函数在这些基函数上的投影，即傅里叶系数。本练习将通过一个具体的分段线性函数（“帐篷”函数），引导你计算其傅里叶正弦级数的前几个系数，这是表示初始条件或解的关键一步 [@problem_id:2204923]。", "problem": "在分析诸如弦的振动或杆中的热传导等物理系统时，将初始状态表示为正弦函数级数通常很有用。这种方法是使用谱方法求解偏微分方程的基础。\n\n考虑一个定义在区间 $x \\in [0, 1]$ 上的函数 $f(x)$。这个函数描述了一个初始形态，并由以下分段定义给出：\n$$\nf(x) = \\begin{cases} \n2x   \\text{for } 0 \\le x \\le 1/2 \\\\\n2(1-x)   \\text{for } 1/2  x \\le 1 \n\\end{cases}\n$$\n这个函数可以由其在区间 $[0, 1]$ 上的傅里叶正弦级数表示，其形式为：\n$$\nf(x) = \\sum_{n=1}^{\\infty} b_n \\sin(n\\pi x)\n$$\n求出此级数展开式中前三个非零系数 $b_n$ 的精确值。将答案表示为一个包含这三个系数的行矩阵，并按其索引 $n$ 的递增顺序排列。", "solution": "对于 $[0,1]$ 上的傅里叶正弦级数，其系数由 $\\{\\sin(n\\pi x)\\}_{n\\ge 1}$ 的正交性给出：\n$$\nb_{n} = 2 \\int_{0}^{1} f(x)\\,\\sin(n\\pi x)\\,dx.\n$$\n根据给定的分段函数 $f(x)$，将积分拆分为：\n$$\nb_{n} = 2\\left[\\int_{0}^{1/2} 2x\\,\\sin(n\\pi x)\\,dx + \\int_{1/2}^{1} 2(1-x)\\,\\sin(n\\pi x)\\,dx\\right] = 4\\left[I_{1}+I_{2}\\right],\n$$\n其中\n$$\nI_{1} = \\int_{0}^{1/2} x\\,\\sin(n\\pi x)\\,dx,\\qquad I_{2} = \\int_{1/2}^{1} (1-x)\\,\\sin(n\\pi x)\\,dx.\n$$\n在 $I_{2}$ 中使用换元法 $u=1-x$ 并利用恒等式 $\\sin(n\\pi(1-u)) = \\sin(n\\pi)\\cos(n\\pi u) - \\cos(n\\pi)\\sin(n\\pi u) = (-1)^{n+1}\\sin(n\\pi u)$，可得\n$$\nI_{2} = (-1)^{n+1}\\int_{0}^{1/2} u\\,\\sin(n\\pi u)\\,du = (-1)^{n+1} I_{1}.\n$$\n因此\n$$\nb_{n} = 4\\left[1 + (-1)^{n+1}\\right] I_{1}.\n$$\n因此当 $n$ 为偶数时 $b_{n}=0$，当 $n$ 为奇数时我们有 $b_{n} = 8 I_{1}$。接下来计算 $I_{1}$：\n$$\nI_{1} = \\int_{0}^{1/2} x\\,\\sin(n\\pi x)\\,dx.\n$$\n使用分部积分法，令 $u=x$，$dv=\\sin(n\\pi x)\\,dx$，可得 $du=dx$ 且 $v=-\\cos(n\\pi x)/(n\\pi)$。则\n$$\nI_{1} = \\left[-\\frac{x\\cos(n\\pi x)}{n\\pi} + \\frac{\\sin(n\\pi x)}{(n\\pi)^{2}}\\right]_{0}^{1/2}\n= -\\frac{1}{2n\\pi}\\cos\\!\\left(\\frac{n\\pi}{2}\\right) + \\frac{1}{(n\\pi)^{2}}\\sin\\!\\left(\\frac{n\\pi}{2}\\right).\n$$\n对于奇数 $n$，$\\cos(n\\pi/2)=0$ 且 $\\sin(n\\pi/2)=(-1)^{(n-1)/2}$，所以\n$$\nb_{n} = 8 I_{1} = \\frac{8}{(n\\pi)^{2}} \\sin\\!\\left(\\frac{n\\pi}{2}\\right), \\quad \\text{for odd } n.\n$$\n因此，前三个非零系数对应于 $n=1,3,5$：\n$$\nb_{1} = \\frac{8}{\\pi^{2}},\\qquad b_{3} = -\\frac{8}{9\\pi^{2}},\\qquad b_{5} = \\frac{8}{25\\pi^{2}}.\n$$\n按 $n$ 递增的顺序排列成一个行矩阵，结果是\n$$\n\\begin{pmatrix}\n\\frac{8}{\\pi^{2}}  -\\frac{8}{9\\pi^{2}}  \\frac{8}{25\\pi^{2}}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{8}{\\pi^{2}}  -\\frac{8}{9\\pi^{2}}  \\frac{8}{25\\pi^{2}}\\end{pmatrix}}$$", "id": "2204923"}, {"introduction": "理解谱方法的工作原理不仅在于知道如何应用它，还在于明白它在何种情况下会失效。本练习通过一个精心设计的思想实验，揭示了谱伽辽金方法的一个基本要求：所选的函数基必须能够“看到”或表示出问题中的所有组成部分，包括强迫项。通过分析为何一个看似合理的基函数集合会导致错误的零解，你将对正交性和函数空间投影在数值求解中的作用有更深刻的认识 [@problem_id:2204920]。", "problem": "一位数值分析师的任务是求解定义在域 $x \\in [0, 1]$ 上的一维泊松方程 $u_{xx}(x) = f(x)$，该方程服从齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。此问题的特定强迫函数由 $f(x) = \\sin(8\\pi x)$ 给出。\n\n该分析师选择使用谱伽辽金方法。他们提出了一个近似解 $u_N(x)$，作为基函数的有限线性组合：\n$$u_N(x) = \\sum_{k=1}^{N} c_k \\phi_k(x)$$\n所选的基函数是该域上拉普拉斯算子的正弦本征函数，$\\phi_k(x) = \\sin(k\\pi x)$，它们自动满足边界条件。在这次特定的尝试中，该分析师将基函数的数量设置为 $N=7$。\n\n伽辽金方法的核心原理是要求方程的残差 $R(x) = u_{N,xx}(x) - f(x)$ 与所选集合中的每个基函数都正交。也就是说，对于所有的 $j=1, 2, \\dots, N$，都有 $\\int_0^1 R(x) \\phi_j(x) dx = 0$。这个过程产生了一个关于未知系数 $c_k$ 的线性方程组。\n\n当该分析师使用 $N=7$ 实现此方法时，计算返回的解是对于所有 $x$ 都有 $u_7(x) = 0$。这显然是错误的，因为将 $u(x)=0$ 代入原始微分方程得到 $0 = \\sin(8\\pi x)$，这并不成立。\n\n下列哪个陈述为这次特定数值实现的失败提供了正确的根本原因？\n\nA. 强迫函数 $f(x)$ 与集合 $\\{\\sin(k\\pi x)\\}_{k=1}^{7}$ 中的每个基函数都正交。因此，$f(x)$ 在这些基函数张成的空间上的投影为零，导致计算出的平凡解为 $u_7(x)=0$。\n\nB. 关于系数 $c_k$ 的线性方程组是奇异的，因为系数矩阵的行列式为零，这表明基函数不是线性无关的。\n\nC. 正弦基只适用于具有偶数索引强迫函数（如 $\\sin(2n\\pi x)$）的问题。奇数索引的强迫函数 $\\sin(8\\pi x)$（因为 $k=8$ 不是2的幂）需要一个余弦基。\n\nD. 所选的基函数数量 $N=7$ 太小，无法分辨强迫项的振荡。根据奈奎斯特-香农（Nyquist-Shannon）采样定理，至少需要 $2 \\times 8 = 16$ 个基函数才能获得稳定的解。\n\nE. 该方法失败是因为边界条件 $u(0)=u(1)=0$ 与在边界处也为零的强迫函数不相容。这造成了一个不适定问题。", "solution": "我们考虑使用基函数 $\\phi_{k}(x)=\\sin(k\\pi x)$（其中 $k=1,\\dots,N$，此处 $N=7$）的谱伽辽金近似。近似解为 $u_{N}(x)=\\sum_{k=1}^{N}c_{k}\\sin(k\\pi x)$，因此其二阶导数为\n$$\nu_{N,xx}(x)=\\sum_{k=1}^{N}c_{k}\\phi_{k}''(x)=\\sum_{k=1}^{N}c_{k}\\left(-k^{2}\\pi^{2}\\sin(k\\pi x)\\right).\n$$\n当 $f(x)=\\sin(8\\pi x)$ 且残差为 $R(x)=u_{N,xx}(x)-f(x)$ 时，伽辽金条件为\n$$\n\\int_{0}^{1}R(x)\\,\\sin(j\\pi x)\\,dx=0,\\quad j=1,\\dots,N.\n$$\n代入 $R$ 得到\n$$\n\\int_{0}^{1}\\left(\\sum_{k=1}^{N}c_{k}\\left(-k^{2}\\pi^{2}\\sin(k\\pi x)\\right)-\\sin(8\\pi x)\\right)\\sin(j\\pi x)\\,dx=0.\n$$\n使用正交关系\n$$\n\\int_{0}^{1}\\sin(k\\pi x)\\sin(j\\pi x)\\,dx=\\begin{cases}\n0,  j\\neq k,\\\\\n\\frac{1}{2},  j=k,\n\\end{cases}\n$$\n每个伽辽金方程解耦为\n$$\n-\\,j^{2}\\pi^{2}c_{j}\\int_{0}^{1}\\sin^{2}(j\\pi x)\\,dx=\\int_{0}^{1}\\sin(8\\pi x)\\sin(j\\pi x)\\,dx,\\quad j=1,\\dots,7,\n$$\n也就是说，\n$$\n-\\,j^{2}\\pi^{2}c_{j}\\left(\\frac{1}{2}\\right)=\\int_{0}^{1}\\sin(8\\pi x)\\sin(j\\pi x)\\,dx,\\quad j=1,\\dots,7.\n$$\n根据正交性，对于每个 $j=1,\\dots,7$，方程右侧都为零，因为 $\\sin(8\\pi x)$ 与 $\\sin(j\\pi x)$ 正交，除非 $j=8$。因此，\n$$\n-\\,j^{2}\\pi^{2}c_{j}\\left(\\frac{1}{2}\\right)=0\\quad\\Rightarrow\\quad c_{j}=0,\\quad j=1,\\dots,7,\n$$\n这就得到 $u_{7}(x)=0$。\n\n这揭示了根本原因：强迫函数完全位于模态 $k=8$ 中，而该模态不包含在 $\\{\\sin(k\\pi x)\\}_{k=1}^{7}$ 所张成的空间内。因此，它在这个子空间上的投影为零，并且伽辽金系统的右端项为零，而刚度矩阵是对角的且可逆：\n$$\na_{jk}=\\int_{0}^{1}\\phi_{k}''(x)\\phi_{j}(x)\\,dx=\\int_{0}^{1}\\left(-k^{2}\\pi^{2}\\sin(k\\pi x)\\right)\\sin(j\\pi x)\\,dx=-\\,\\frac{1}{2}k^{2}\\pi^{2}\\,\\delta_{jk},\n$$\n因此不存在奇异性。如果 $N$ 包含8，我们就会得到 $c_{8}=-1/(64\\pi^{2})$ 并恢复精确解。对于此边值问题，援引余弦基、奈奎斯特-香农（Nyquist-Shannon）采样或与边界条件不相容的解释都是不正确的。正确的选择是强迫函数与所选子空间正交。\n\n因此，正确选项是A。", "answer": "$$\\boxed{A}$$", "id": "2204920"}]}