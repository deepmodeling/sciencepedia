{"hands_on_practices": [{"introduction": "多重网格方法的出发点是认识到简单迭代法（如Jacobi或Gauss-Seidel松弛法）的特性。这些方法被称为“平滑器”，因为它们能高效地衰减误差中的高频（振荡）分量，但对低频（平滑）分量却效果不佳。这个练习让你亲身体验平滑属性：通过对一个典型的高频误差向量应用一步简单的松弛格式，你将直接计算并观察到高频误差是如何被有效抑制的。[@problem_id:2188704]", "problem": "在分析求解离散化偏微分方程的迭代法时，理解误差的行为至关重要。考虑一个在一维网格上离散化的问题。设内部网格点的索引为 $i=1$ 到 $i=7$。在迭代过程的某一特定阶段，对应这些内部点的误差向量为 $e^{(0)} = [e_1^{(0)}, e_2^{(0)}, \\dots, e_7^{(0)}] = [1, -1, 1, -1, 1, -1, 1]$。\n\n该物理问题受边界条件约束，这些条件固定了边界上的值，确保边界点上的误差始终为零。对于我们的网格，这意味着 $e_0 = 0$ 且 $e_8 = 0$。\n\n应用一个简单松弛格式的单步来更新误差向量。每个内部网格点 $i$ 处误差的更新规则定义为对其上一步紧邻点误差值的平均。新误差向量 $e^{(1)}$ 的公式为：\n$$e_i^{(1)} = \\frac{1}{2} \\left( e_{i-1}^{(0)} + e_{i+1}^{(0)} \\right)$$\n其中 $i$ 的范围是从 1 到 7。\n\n计算应用一次该松弛格式后的新误差向量 $e^{(1)}$。将最终答案表示为一个包含7个元素、使用分数或整数值的行向量。", "solution": "我们已知内部索引 $i=1,\\dots,7$，边界误差 $e_{0}^{(0)}=0$ 和 $e_{8}^{(0)}=0$，以及雅可比型松弛更新公式\n$$\ne_{i}^{(1)}=\\frac{1}{2}\\left(e_{i-1}^{(0)}+e_{i+1}^{(0)}\\right), \\quad i=1,\\dots,7.\n$$\n使用初始误差向量 $e^{(0)}=[1,-1,1,-1,1,-1,1]$ 和边界值，我们计算每个分量：\n$$\ne_{1}^{(1)}=\\frac{1}{2}\\left(e_{0}^{(0)}+e_{2}^{(0)}\\right)=\\frac{1}{2}\\left(0+(-1)\\right)=-\\frac{1}{2},\n$$\n$$\ne_{2}^{(1)}=\\frac{1}{2}\\left(e_{1}^{(0)}+e_{3}^{(0)}\\right)=\\frac{1}{2}\\left(1+1\\right)=1,\n$$\n$$\ne_{3}^{(1)}=\\frac{1}{2}\\left(e_{2}^{(0)}+e_{4}^{(0)}\\right)=\\frac{1}{2}\\left(-1+(-1)\\right)=-1,\n$$\n$$\ne_{4}^{(1)}=\\frac{1}{2}\\left(e_{3}^{(0)}+e_{5}^{(0)}\\right)=\\frac{1}{2}\\left(1+1\\right)=1,\n$$\n$$\ne_{5}^{(1)}=\\frac{1}{2}\\left(e_{4}^{(0)}+e_{6}^{(0)}\\right)=\\frac{1}{2}\\left(-1+(-1)\\right)=-1,\n$$\n$$\ne_{6}^{(1)}=\\frac{1}{2}\\left(e_{5}^{(0)}+e_{7}^{(0)}\\right)=\\frac{1}{2}\\left(1+1\\right)=1,\n$$\n$$\ne_{7}^{(1)}=\\frac{1}{2}\\left(e_{6}^{(0)}+e_{8}^{(0)}\\right)=\\frac{1}{2}\\left(-1+0\\right)=-\\frac{1}{2}.\n$$\n因此，更新后的误差向量为\n$$\ne^{(1)}=\\begin{pmatrix}-\\frac{1}{2} & 1 & -1 & 1 & -1 & 1 & -\\frac{1}{2}\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{2} & 1 & -1 & 1 & -1 & 1 & -\\frac{1}{2}\\end{pmatrix}}$$", "id": "2188704"}, {"introduction": "在平滑操作之后，残余的误差主要是平滑的低频分量，这些分量在细网格上难以消除，但在粗网格上却可以被高效地求解。为了在粗网格上解决这个问题，我们首先需要将细网格上的信息（即残差）传递到粗网格上，这个过程称为限制（Restriction）。本练习将重点介绍一种常用且稳健的“全加权”限制算子，你将计算一个九点模板的权重，从而理解信息是如何从细网格聚合到粗网格的。[@problem_id:2188681]", "problem": "在实现用于解决二维物理问题的多重网格求解器时，必须将定义在“细”网格上的值转移到“粗”网格上。设细网格上节点 $(i,j)$ 处的值表示为 $u_{i,j}^h$。粗网格是通过从细网格中每隔一个节点选取一个节点来形成的，因此粗网格节点 $(I,J)$ 在空间上与细网格节点 $(2I, 2J)$ 重合。\n\n计算粗网格节点上值 $u_{I,J}^{2h}$ 的一种常用方法是使用以 $(2I, 2J)$ 为中心的九个细网格节点上值的加权平均。这个过程称为全加权限制 (full-weighting restriction)，由以下公式描述：\n\n$$u_{I,J}^{2h} = \\sum_{k=-1}^{1} \\sum_{l=-1}^{1} w_{k,l} \\, u_{2I+k, 2J+l}^h$$\n\n权重 $w_{k,l}$ 是从传递面积加权平均值的原理推导出的常系数，并且它们被归一化，使得所有九个点的权重之和为1。\n\n你的任务是确定权重 $w_{k,l}$ 的九个数值。请将你的答案表示为一个单行矩阵，其中包含按以下特定顺序排列的九个权重：\n$w_{-1,-1}, w_{-1,0}, w_{-1,1}, w_{0,-1}, w_{0,0}, w_{0,1}, w_{1,-1}, w_{1,0}, w_{1,1}$。", "solution": "我们考虑一个间距为 $h$ 的均匀细网格和一个间距为 $2h$ 的粗网格。粗网格节点 $(I,J)$ 与细网格节点 $(2I,2J)$ 重合，全加权限制通过对以 $(2I,2J)$ 为中心的 $3 \\times 3$ 细网格模板进行加权求和来计算 $u_{I,J}^{2h}$：\n$$\nu_{I,J}^{2h}=\\sum_{k=-1}^{1}\\sum_{l=-1}^{1} w_{k,l}\\,u_{2I+k,\\,2J+l}^{h}.\n$$\n根据应用于节点中心数据的面积加权平均原理，我们通过对以 $(2I,2J)$ 为中心的 $2h \\times 2h$ 正方形上的细网格分段双线性插值进行平均来确定权重。由于双线性形函数是一维帽函数的张量积，因此二维权重可以分解为一维权重的张量积。因此，我们只需要确定一维全加权系数 $a_{-1},a_{0},a_{1}$，然后设置\n$$\nw_{k,l}=a_{k}\\,a_{l}, \\quad k,l\\in\\{-1,0,1\\}.\n$$\n\n在一维情况下，设索引为 $I$ 的粗网格值为细网格分段线性插值在以粗网格节点 $x_{2I}$ 为中心、长度为 $2h$ 的区间上的平均值。将一维权重表示为 $a_{-1},a_{0},a_{1}$，使得\n$$\nu_{I}^{2h}=a_{-1}u^{h}_{2I-1}+a_{0}u^{h}_{2I}+a_{1}u^{h}_{2I+1}.\n$$\n我们施加以下条件：\n\n1) 对常数精确（平均值守恒）：$a_{-1}+a_{0}+a_{1}=1$。\n\n2) 关于中心对称（以及在对称区间上对线性函数精确）：$a_{-1}=a_{1}$。\n\n3) 对于二次原型函数 $u(x)=x^{2}$，其结果应与分段线性插值在区间上的平均值一致：在 $x=-h,0,h$ 处的细网格节点值为 $u^{h}_{2I-1}=h^{2}$，$u^{h}_{2I}=0$，$u^{h}_{2I+1}=h^{2}$。在 $[-h,0]$ 和 $[0,h]$ 上的分段线性插值在 $[-h,h]$ 上的平均值为 $h^{2}/2$。因此，加权和必须满足\n$$\na_{-1}h^{2}+a_{0}\\cdot 0+a_{1}h^{2}=\\frac{h^{2}}{2}.\n$$\n使用 $a_{-1}=a_{1}$，可得 $2a_{-1}h^{2}=\\frac{h^{2}}{2}$，因此 $a_{-1}=a_{1}=\\frac{1}{4}$，进而 $a_{0}=1-2\\cdot\\frac{1}{4}=\\frac{1}{2}$。\n\n因此，一维全加权系数为 $a_{-1}=\\frac{1}{4}$，$a_{0}=\\frac{1}{2}$，$a_{1}=\\frac{1}{4}$。\n\n根据张量积结构，二维权重为\n$$\nw_{k,l}=a_{k}a_{l}, \\quad k,l\\in\\{-1,0,1\\}.\n$$\n这得到：\n- 角点权重：$w_{\\pm 1,\\pm 1}=\\frac{1}{4}\\cdot\\frac{1}{4}=\\frac{1}{16}$。\n- 边点权重：$w_{\\pm 1,0}=w_{0,\\pm 1}=\\frac{1}{4}\\cdot\\frac{1}{2}=\\frac{1}{8}$。\n- 中心点权重：$w_{0,0}=\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{4}$。\n\n这些权重满足归一化条件 $\\sum_{k=-1}^{1}\\sum_{l=-1}^{1}w_{k,l}=4\\cdot\\frac{1}{16}+4\\cdot\\frac{1}{8}+1\\cdot\\frac{1}{4}=1$，并且能保持常数和线性函数不变。\n\n按指定顺序 $w_{-1,-1}, w_{-1,0}, w_{-1,1}, w_{0,-1}, w_{0,0}, w_{0,1}, w_{1,-1}, w_{1,0}, w_{1,1}$ 排列，\n权重为\n$$\n\\left(\\frac{1}{16},\\ \\frac{1}{8},\\ \\frac{1}{16},\\ \\frac{1}{8},\\ \\frac{1}{4},\\ \\frac{1}{8},\\ \\frac{1}{16},\\ \\frac{1}{8},\\ \\frac{1}{16}\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{16} & \\frac{1}{8} & \\frac{1}{16} & \\frac{1}{8} & \\frac{1}{4} & \\frac{1}{8} & \\frac{1}{16} & \\frac{1}{8} & \\frac{1}{16}\\end{pmatrix}}$$", "id": "2188681"}, {"introduction": "在粗网格上求得误差的近似解（即校正量）之后，我们需要将其传回细网格，以更新细网格上的解。这个从粗网格到细网格的转换过程称为延长（Prolongation）或插值（Interpolation）。本练习将让你实践线性延长操作，这是与全加权限制相对应的常用方法，你将把一个定义在粗网格上的校正向量插值到细网格上，从而具体地了解粗网格的校正量是如何分布并改进细网格上的近似解的。[@problem_id:2188706]", "problem": "在求解一维边界值问题于域 $[0, 1]$ 上的多重网格法背景下，使用了一个细网格 $\\Omega_h$ 和一个粗网格 $\\Omega_{2h}$。细网格 $\\Omega_h$ 由节点 $x_i = i \\cdot h$ 定义，其中 $i = 0, 1, \\dots, 8$，网格间距为 $h = 1/8$。粗网格 $\\Omega_{2h}$ 是细网格的子集，仅包含节点 $x_j = j \\cdot (2h)$，其中 $j = 0, 1, \\dots, 4$。因此，细网格的内部点是 $\\{x_1, x_2, x_3, x_4, x_5, x_6, x_7\\}$，而粗网格的内部点对应于细网格索引下的 $\\{x_2, x_4, x_6\\}$。\n\n在算法的一个步骤中，在粗网格上求解误差校正方程，得到一个校正向量 $e_{2h}$。该向量在 $\\Omega_{2h}$ 的内部节点上定义，其值为 $e_{2h}(x_2) = c_1$，$e_{2h}(x_4) = c_2$ 和 $e_{2h}(x_6) = c_3$，其中 $c_1, c_2, c_3$ 是符号常数。已知校正量在域的边界处为零，因此 $e_{2h}(x_0) = 0$ 和 $e_{2h}(x_8) = 0$。\n\n这个粗网格校正量必须使用一个记为 $I_{2h}^h$ 的延长（插值）算子转移回细网格，以产生一个细网格校正向量 $e_h = I_{2h}^h e_{2h}$。插值是线性的，定义如下：\n1. 对于任何同时也是粗网格节点的细网格节点 $x_i$（即 $i$ 是偶数），其值被直接注入：$e_h(x_i) = e_{2h}(x_i)$。\n2. 对于任何不是粗网格节点的细网格节点 $x_i$（即 $i$ 是奇数），其值是其两个最近的粗网格邻居节点值的算术平均值。\n\n确定在细网格的所有七个内部点 $\\{x_1, x_2, \\dots, x_7\\}$ 上的完整校正向量 $e_h$。将你的答案表示为一个包含7个分量的单行向量，按从 $x_1$ 到 $x_7$ 的顺序排列，并用常数 $c_1$、$c_2$ 和 $c_3$ 表示。", "solution": "给定在 $[0,1]$ 上的两个嵌套均匀网格：细网格 $\\Omega_{h}$，其节点为 $x_{i}=i h$，$i=0,\\dots,8$ 且 $h=1/8$；以及粗网格 $\\Omega_{2h}$，由偶数索引的细网格节点子集构成，$x_{j}=j(2h)$，$j=0,\\dots,4$，即索引为 $i=0,2,4,6,8$ 的节点。内部细网格节点是 $x_{1},\\dots,x_{7}$，内部粗网格节点对应于 $x_{2},x_{4},x_{6}$。粗网格校正量 $e_{2h}$ 由下式指定\n$$\ne_{2h}(x_{2})=c_{1},\\quad e_{2h}(x_{4})=c_{2},\\quad e_{2h}(x_{6})=c_{3},\\quad e_{2h}(x_{0})=0,\\quad e_{2h}(x_{8})=0.\n$$\n我们使用线性延长来构造细网格校正量 $e_{h}=I_{2h}^{h} e_{2h}$。插值规则是：\n- 对于偶数 $i$（细网格节点与粗网格节点重合）：注入，\n$$\ne_{h}(x_{i})=e_{2h}(x_{i}).\n$$\n- 对于奇数 $i$（细网格节点位于两个相邻粗网格节点的中点）：算术平均，\n$$\ne_{h}(x_{i})=\\frac{e_{2h}(x_{i-1})+e_{2h}(x_{i+1})}{2}.\n$$\n\n我们现在计算在七个内部细网格节点上的 $e_{h}$：\n\n1) $i=1$ (奇数)，邻居节点为 $x_{0}$ 和 $x_{2}$：\n$$\ne_{h}(x_{1})=\\frac{e_{2h}(x_{0})+e_{2h}(x_{2})}{2}=\\frac{0+c_{1}}{2}=\\frac{c_{1}}{2}.\n$$\n\n2) $i=2$ (偶数)，注入：\n$$\ne_{h}(x_{2})=e_{2h}(x_{2})=c_{1}.\n$$\n\n3) $i=3$ (奇数)，邻居节点为 $x_{2}$ 和 $x_{4}$：\n$$\ne_{h}(x_{3})=\\frac{e_{2h}(x_{2})+e_{2h}(x_{4})}{2}=\\frac{c_{1}+c_{2}}{2}.\n$$\n\n4) $i=4$ (偶数)，注入：\n$$\ne_{h}(x_{4})=e_{2h}(x_{4})=c_{2}.\n$$\n\n5) $i=5$ (奇数)，邻居节点为 $x_{4}$ 和 $x_{6}$：\n$$\ne_{h}(x_{5})=\\frac{e_{2h}(x_{4})+e_{2h}(x_{6})}{2}=\\frac{c_{2}+c_{3}}{2}.\n$$\n\n6) $i=6$ (偶数)，注入：\n$$\ne_{h}(x_{6})=e_{2h}(x_{6})=c_{3}.\n$$\n\n7) $i=7$ (奇数)，邻居节点为 $x_{6}$ 和 $x_{8}$：\n$$\ne_{h}(x_{7})=\\frac{e_{2h}(x_{6})+e_{2h}(x_{8})}{2}=\\frac{c_{3}+0}{2}=\\frac{c_{3}}{2}.\n$$\n\n将分量按从 $x_{1}$ 到 $x_{7}$ 的顺序收集，得到行向量\n$$\n\\begin{pmatrix}\n\\frac{c_{1}}{2} & c_{1} & \\frac{c_{1}+c_{2}}{2} & c_{2} & \\frac{c_{2}+c_{3}}{2} & c_{3} & \\frac{c_{3}}{2}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{c_{1}}{2} & c_{1} & \\frac{c_{1}+c_{2}}{2} & c_{2} & \\frac{c_{2}+c_{3}}{2} & c_{3} & \\frac{c_{3}}{2}\\end{pmatrix}}$$", "id": "2188706"}]}