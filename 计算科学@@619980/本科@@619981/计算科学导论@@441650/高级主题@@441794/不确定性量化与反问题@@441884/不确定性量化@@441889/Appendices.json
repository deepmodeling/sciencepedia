{"hands_on_practices": [{"introduction": "在进入具体的计算方法之前，理解不确定性的不同表示方式至关重要。本练习旨在对比两种主要的不确定性量化范式：基于集合的确定性方法（如区间算术）和概率方法。通过分析一个简单的函数 $f(x)=x(1-x)$，你将亲身体验区间算术中因变量重复出现而导致的“依赖问题”，并了解仿射算术等更先进的技术如何解决这一挑战，从而为后续学习打下坚实的概念基础。[@problem_id:3201124]", "problem": "您正在分析一个具有单一不确定输入 $x$ 的标量计算模型中的不确定性。假设您确定性地知道的全部信息是 $x \\in [0,1]$。考虑函数 $f(x) = x(1 - x)$。您被要求比较确定性区间界限与概率性摘要，并诊断区间算术中的过高估计问题，然后应用仿射算术 (AA) 来收紧界限。\n\n仅使用以下基本原理：\n- 区间算术 (Interval arithmetic): 对于区间 $X = [a,b]$ 和 $Y = [c,d]$，基于集合的定义为 $X + Y = \\{ x+y \\mid x \\in X, y \\in Y\\}$，$X - Y = \\{ x-y \\mid x \\in X, y \\in Y\\}$，$X \\cdot Y = \\{ xy \\mid x \\in X, y \\in Y\\}$。特别地，$1 - X = \\{ 1 - x \\mid x \\in X\\}$ 且 $X \\cdot Y$ 是一个区间，其端点是乘积 $ac, ad, bc, bd$ 中的最小值和最大值。\n- 仿射算术 (Affine Arithmetic, AA): 用仿射形式 $x = x_{0} + r \\,\\varepsilon_{1}$ 表示一个不确定量，其中 $\\varepsilon_{1} \\in [-1,1]$。线性运算在系数上精确传播。非线性项通过引入一个新的噪声符号 $\\varepsilon_{k}$ 来界定，以包含余项的范围。\n- 基础微积分和概率论: 对于具有概率密度的随机变量 $X$，期望值 $\\mathbb{E}[g(X)]$ 和方差 $\\operatorname{Var}(g(X))$ 由其支撑集上的积分定义，且对于 $X \\sim \\operatorname{Uniform}(0,1)$，整数 $n \\ge 0$ 时有 $\\mathbb{E}[X^{n}] = \\frac{1}{n+1}$。\n\n回答以下多项选择题。选择所有正确的选项。\n\nA. 对 $f([0,1]) = [0,1] \\cdot (1 - [0,1])$ 使用经典区间算术返回 $[0,1]$，并且由于忽略了 $x$ 重复出现之间的依赖关系，因此过高估计了真实范围。\n\nB. 使用仿射算术，设 $x = \\frac{1}{2} + \\frac{1}{2}\\varepsilon_{1}$ 且 $1 - x = \\frac{1}{2} - \\frac{1}{2}\\varepsilon_{1}$，则乘积 $x(1 - x)$ 产生更紧的界限 $[0, \\frac{1}{4}]$。\n\nC. 如果 $X \\sim \\operatorname{Uniform}(0,1)$，则 $\\mathbb{E}[f(X)] = \\frac{1}{6}$ 且 $\\operatorname{Var}(f(X)) = \\frac{1}{180}$，这些是对概率不确定性的总结，而不是对所有可能值的保证包含区间。\n\nD. 对于 $X \\sim \\operatorname{Uniform}(0,1)$，区间 $\\left[\\mathbb{E}[f(X)] - 2\\sqrt{\\operatorname{Var}(f(X))},\\ \\mathbb{E}[f(X)] + 2\\sqrt{\\operatorname{Var}(f(X))}\\right]$ 是 $f(X)$ 的一个保证包含区间，概率为 $1$。\n\nE. 经典区间算术返回精确像集 $f([0,1]) = [0, \\frac{1}{4}]$，因为 $x(1-x)$ 在 $[0,1]$ 上的最小值和最大值在 $[0,1]$ 的端点处取得。", "solution": "该问题陈述是入门不确定性量化中的一个有效练习。它具有科学依据，问题提法恰当，并包含了进行分析所需的所有必要定义。我们将根据提供的基本原理来评估每个选项。\n\n所考虑的函数是 $f(x) = x(1-x) = x - x^2$。已知不确定输入在区间 $x \\in [0,1]$ 内。\n首先，让我们确定当 $x \\in [0,1]$ 时 $f(x)$ 的真实范围。函数 $f(x)$ 描述了一个开口向下的抛物线。其最大值可以通过将其导数设为零来找到：\n$f'(x) = \\frac{d}{dx}(x - x^2) = 1 - 2x$。\n令 $f'(x) = 0$ 得到 $1 - 2x = 0$，解得 $x = 1/2$。\n最大值为 $f(1/2) = \\frac{1}{2}(1 - \\frac{1}{2}) = \\frac{1}{4}$。\n在区间 $[0,1]$ 端点处的值为 $f(0)=0$ 和 $f(1) = 1(1-1) = 0$。\n因此，函数的真实范围，即像集 $f([0,1])$，是区间 $[0, 1/4]$。\n\n现在，我们来分析每个选项。\n\n**A. 对 $f([0,1]) = [0,1] \\cdot (1 - [0,1])$ 使用经典区间算术返回 $[0,1]$，并且由于忽略了 $x$ 重复出现之间的依赖关系，因此过高估计了真实范围。**\n\n设 $X = [0,1]$ 为输入区间。我们想计算 $f(X) = X \\cdot (1 - X)$。\n1.  首先，我们计算 $(1 - X)$ 的区间：\n    $1 - X = 1 - [0,1] = \\{1 - x \\mid x \\in [0,1]\\}$。最小值为 $1-1=0$，最大值为 $1-0=1$。所以，$1 - X = [0,1]$。\n2.  接下来，我们计算乘积 $X \\cdot (1 - X)$：\n    $X \\cdot (1 - X) = [0,1] \\cdot [0,1]$。\n    使用区间乘法规则，对于 $[a,b] \\cdot [c,d]$，结果是 $[\\min(ac, ad, bc, bd), \\max(ac, ad, bc, bd)]$。\n    这里，$a=0, b=1, c=0, d=1$。四个乘积是：\n    $0 \\cdot 0 = 0$\n    $0 \\cdot 1 = 0$\n    $1 \\cdot 0 = 0$\n    $1 \\cdot 1 = 1$\n    这些乘积的最小值是 $0$，最大值是 $1$。\n    因此，经典区间算术返回区间 $[0,1]$。\n3.  函数的真实范围是 $[0, 1/4]$。区间算术的结果 $[0,1]$ 严格包含真实范围，$[0, 1/4] \\subset [0,1]$，所以它是一个有效但悲观的界限。这种过高估计在区间算术中被称为“依赖问题”。在计算 $X \\cdot (1-X)$ 时，该方法将第一个 $X$ 和第二个 $X$ 视为独立的变量，每个变量都在 $[0,1]$ 内取值。它寻求 $y \\cdot z$ 的范围，其中 $y \\in [0,1]$ 且 $z \\in [0,1]$。最大值 $1$ 是在 $y=1, z=1$ 时取得的。然而，在原始函数 $f(x)=x(1-x)$ 中，如果第一项 $x$ 是 $1$，那么第二项 $(1-x)$ 必须是 $0$，而不是 $1$。$x$ 两次出现之间的依赖关系丢失了。\n选项 A 中的陈述完全正确。\n**A 的判定：正确。**\n\n**B. 使用仿射算术，设 $x = \\frac{1}{2} + \\frac{1}{2}\\varepsilon_{1}$ 且 $1 - x = \\frac{1}{2} - \\frac{1}{2}\\varepsilon_{1}$，则乘积 $x(1 - x)$ 产生更紧的界限 $[0, \\frac{1}{4}]$。**\n\n1.  对于一个不确定变量 $x \\in [a,b]$，其仿射形式为 $x = x_0 + r \\varepsilon_1$，其中 $x_0 = (a+b)/2$ 是中点，$r = (b-a)/2$ 是半径，且 $\\varepsilon_1 \\in [-1,1]$。对于 $x \\in [0,1]$，我们有 $x_0 = (0+1)/2 = 1/2$ 且 $r = (1-0)/2 = 1/2$。因此，仿射形式为 $x = \\frac{1}{2} + \\frac{1}{2}\\varepsilon_1$，如陈述所述。\n2.  $1-x$ 的仿射形式计算如下：\n    $1 - x = 1 - (\\frac{1}{2} + \\frac{1}{2}\\varepsilon_1) = \\frac{1}{2} - \\frac{1}{2}\\varepsilon_1$。这也是正确的。\n3.  我们计算乘积 $x(1-x)$:\n    $f(x) = x(1-x) = (\\frac{1}{2} + \\frac{1}{2}\\varepsilon_1)(\\frac{1}{2} - \\frac{1}{2}\\varepsilon_1)$\n    这是 $(A+B)(A-B) = A^2 - B^2$ 的形式。\n    $f(x) = (\\frac{1}{2})^2 - (\\frac{1}{2}\\varepsilon_1)^2 = \\frac{1}{4} - \\frac{1}{4}\\varepsilon_1^2$。\n4.  为了找到 $f(x)$ 的区间界限，我们考虑 $\\varepsilon_1^2$ 的范围。因为 $\\varepsilon_1 \\in [-1,1]$，所以有 $\\varepsilon_1^2 \\in [0,1]$。\n    因此，项 $-\\frac{1}{4}\\varepsilon_1^2$ 的范围是 $[-\\frac{1}{4}(1), -\\frac{1}{4}(0)] = [-\\frac{1}{4}, 0]$。\n    加上常数 $\\frac{1}{4}$， $f(x)$ 的范围是 $[\\frac{1}{4} - \\frac{1}{4}, \\frac{1}{4} + 0] = [0, \\frac{1}{4}]$。\n    这个结果 $[0, 1/4]$ 是函数的精确范围。它比区间算术得到的结果 $[0,1]$ 要紧得多。该陈述是正确的。\n**B 的判定：正确。**\n\n**C. 如果 $X \\sim \\operatorname{Uniform}(0,1)$，则 $\\mathbb{E}[f(X)] = \\frac{1}{6}$ 且 $\\operatorname{Var}(f(X)) = \\frac{1}{180}$，这些是对概率不确定性的总结，而不是对所有可能值的保证包含区间。**\n\n1.  我们计算期望 $\\mathbb{E}[f(X)]$。题目给出对于 $X \\sim \\operatorname{Uniform}(0,1)$，有 $\\mathbb{E}[X^n] = \\frac{1}{n+1}$。\n    $\\mathbb{E}[f(X)] = \\mathbb{E}[X - X^2] = \\mathbb{E}[X] - \\mathbb{E}[X^2]$。\n    使用该公式，$\\mathbb{E}[X] = \\frac{1}{1+1} = \\frac{1}{2}$ 且 $\\mathbb{E}[X^2] = \\frac{1}{2+1} = \\frac{1}{3}$。\n    $\\mathbb{E}[f(X)] = \\frac{1}{2} - \\frac{1}{3} = \\frac{3-2}{6} = \\frac{1}{6}$。期望值是正确的。\n2.  我们计算方差 $\\operatorname{Var}(f(X)) = \\mathbb{E}[f(X)^2] - (\\mathbb{E}[f(X)])^2$。\n    首先，我们需要 $\\mathbb{E}[f(X)^2]$:\n    $f(X)^2 = (X-X^2)^2 = X^2 - 2X^3 + X^4$。\n    $\\mathbb{E}[f(X)^2] = \\mathbb{E}[X^2 - 2X^3 + X^4] = \\mathbb{E}[X^2] - 2\\mathbb{E}[X^3] + \\mathbb{E}[X^4]$。\n    再次使用该公式：$\\mathbb{E}[X^3] = \\frac{1}{3+1} = \\frac{1}{4}$ 且 $\\mathbb{E}[X^4] = \\frac{1}{4+1} = \\frac{1}{5}$。\n    $\\mathbb{E}[f(X)^2] = \\frac{1}{3} - 2(\\frac{1}{4}) + \\frac{1}{5} = \\frac{1}{3} - \\frac{1}{2} + \\frac{1}{5} = \\frac{10-15+6}{30} = \\frac{1}{30}$。\n    现在，我们计算方差：\n    $\\operatorname{Var}(f(X)) = \\frac{1}{30} - (\\frac{1}{6})^2 = \\frac{1}{30} - \\frac{1}{36} = \\frac{6-5}{180} = \\frac{1}{180}$。方差也是正确的。\n3.  陈述的最后一部分声称这些统计数据总结了概率不确定性，但不是保证性的包含区间。这是一个正确且根本的区别。均值（$\\mathbb{E}[f(X)]$）表示输出的平均值，而方差（$\\operatorname{Var}(f(X))$）衡量输出概率分布围绕均值的离散程度。它们不定义所有可能结果的集合。可能结果的范围是 $[0, 1/4]$，这是一个确定性的包含区间，而 $\\mathbb{E}[f(X)] \\pm \\sqrt{\\operatorname{Var}(f(X))}$ 是一个关于数值可能集中位置的概率性陈述。\n该陈述完全正确。\n**C 的判定：正确。**\n\n**D. 对于 $X \\sim \\operatorname{Uniform}(0,1)$，区间 $\\left[\\mathbb{E}[f(X)] - 2\\sqrt{\\operatorname{Var}(f(X))},\\ \\mathbb{E}[f(X)] + 2\\sqrt{\\operatorname{Var}(f(X))}\\right]$ 是 $f(X)$ 的一个保证包含区间，概率为 $1$。**\n\n1.  这个陈述断言随机变量 $f(X)$ 的支撑集被包含在由均值加减两倍标准差定义的区间内。\n2.  让我们计算这个区间。根据选项 C，$\\mu = \\mathbb{E}[f(X)] = 1/6$ 且 $\\sigma^2 = \\operatorname{Var}(f(X)) = 1/180$。\n    标准差是 $\\sigma = \\sqrt{1/180} = 1/\\sqrt{36 \\cdot 5} = 1/(6\\sqrt{5})$。\n    该区间为 $[\\mu - 2\\sigma, \\mu + 2\\sigma] = [\\frac{1}{6} - \\frac{2}{6\\sqrt{5}}, \\frac{1}{6} + \\frac{2}{6\\sqrt{5}}] = [\\frac{1}{6} - \\frac{1}{3\\sqrt{5}}, \\frac{1}{6} + \\frac{1}{3\\sqrt{5}}]$。\n3.  为了检查这是否是一个保证性的包含区间，我们可以将其界限与 $f(X)$ 的真实范围 $[0, 1/4]$ 进行比较。\n    我们来近似计算界限：$\\sqrt{5} \\approx 2.236$。\n    $1/(3\\sqrt{5}) \\approx 1/(3 \\cdot 2.236) \\approx 1/6.708 \\approx 0.1491$。\n    $1/6 \\approx 0.1667$。\n    下界：$0.1667 - 0.1491 \\approx 0.0176$。\n    上界：$0.1667 + 0.1491 \\approx 0.3158$。\n    该区间大约为 $[0.0176, 0.3158]$。\n4.  $f(X)$ 的真实范围是 $[0, 0.25]$。所提出的区间不包含 $0$，而 $0$ 是 $f(X)$ 的一个可能值（当 $X=0$ 或 $X=1$ 时）。例如，$f(0.01) = 0.0099$，它小于下界 $0.0176$。因此，该区间不是一个保证性的包含区间。切比雪夫不等式保证随机变量落在均值 $k$ 个标准差范围内的概率至少是 $1 - 1/k^2$。对于 $k=2$，这个概率至少是 $75\\%$，而不是 $100\\%$（概率为 $1$）。\n该陈述不正确。\n**D 的判定：不正确。**\n\n**E. 经典区间算术返回精确像集 $f([0,1]) = [0, \\frac{1}{4}]$，因为 $x(1-x)$ 在 $[0,1]$ 上的最小值和最大值在 $[0,1]$ 的端点处取得。**\n\n这个陈述提出了两个主张。\n1.  主张1：“经典区间算术返回精确像集 $f([0,1]) = [0, \\frac{1}{4}]$”。如选项A的分析所示，经典区间算术返回 $[0,1]$，这是对精确像集 $[0, 1/4]$ 的过高估计。这个主张是错误的。\n2.  主张2：“...因为 $x(1-x)$ 在 $[0,1]$ 上的最小值和最大值在 $[0,1]$ 的端点处取得”。如初始分析所示，$f(x)$ 的最小值是 $0$，它在端点 $x=0$ 和 $x=1$ 处取得。然而，最大值是 $1/4$，它在内部点 $x=1/2$ 处取得。因此，关于最小值和最大值都在端点处取得的主张是错误的。\n由于主要断言和理由都是错误的，所以整个陈述是不正确的。\n**E 的判定：不正确。**\n\n最终总结：选项 A, B, C 是正确的。选项 D, E 是不正确的。", "answer": "$$\\boxed{ABC}$$", "id": "3201124"}, {"introduction": "掌握了不确定性的基本概念后，我们将通过一个具体的物理问题来实践前向不确定性传播。本练习将探讨在一个基本的物理定律——斯特藩-玻尔兹曼定律中，输入变量（温度）的微小不确定性如何传播并影响输出量（辐射热率）。你将学习使用级数展开来近似计算输出量的前两阶矩（均值和方差），这是不确定性量化中的一项基本功。[@problem_id:2536849]", "problem": "一个发射率为 $\\epsilon$、面积为 $A$、绝对温度为 $T$ 的漫灰等温表面片向深空辐射。净辐射热率遵循 Stefan–Boltzmann 定律 $q=\\epsilon \\,\\sigma_{\\mathrm{SB}}\\, A \\, T^{4}$，其中 $\\sigma_{\\mathrm{SB}}$ 是 Stefan–Boltzmann 常数。假设 $\\epsilon$、$A$ 和 $\\sigma_{\\mathrm{SB}}$ 是已知的确定性参数，但温度 $T$ 由于微小的传感器噪声和过程变异性而不确定。将 $T$ 建模为一个均值为 $\\mu_{T}>0$、方差为 $\\sigma_{T}^{2}$ 的高斯随机变量，并假设变异系数 $c=\\sigma_{T}/\\mu_{T}$ 很小，即 $c \\ll 1$。\n\n从 Stefan–Boltzmann 定律以及期望和方差的定义出发，并仅使用基于 $c$ 的微小性而成立的基本级数展开，推导无量纲辐射热率\n$$\nr \\equiv \\frac{q}{\\epsilon \\,\\sigma_{\\mathrm{SB}}\\, A \\,\\mu_{T}^{4}}\n$$\n的前两阶矩。在计算中，对 $c$ 保留到主导非平凡阶，且均值和方差的计算结果需包含所有直到并包括 $c^{2}$ 阶的项。将你的最终答案表示为仅含 $c$ 的闭式解析表达式。将两个结果以单行矩阵 $\\big(\\,\\mathbb{E}[r]\\;\\;\\mathrm{Var}(r)\\,\\big)$ 的形式报告。由于 $r$ 是无量纲的，最终答案中不要包含单位。", "solution": "问题陈述在科学上是合理的、适定的、客观的，并包含足够的信息来推导出唯一解。因此，该问题被认为是有效的。我们开始进行推导。\n\n目标是确定无量纲辐射热率 $r$ 的前两阶矩，即期望 $\\mathbb{E}[r]$ 和方差 $\\mathrm{Var}(r)$。问题指出，净辐射热率由 Stefan–Boltzmann 定律给出，$q=\\epsilon \\,\\sigma_{\\mathrm{SB}}\\, A \\, T^{4}$。无量纲热率 $r$ 定义为\n$$\nr \\equiv \\frac{q}{\\epsilon \\,\\sigma_{\\mathrm{SB}}\\, A \\,\\mu_{T}^{4}}\n$$\n将 $q$ 的表达式代入 $r$ 的定义中，确定性参数 $\\epsilon$、$\\sigma_{\\mathrm{SB}}$ 和 $A$ 会被消去：\n$$\nr = \\frac{\\epsilon \\,\\sigma_{\\mathrm{SB}}\\, A \\, T^{4}}{\\epsilon \\,\\sigma_{\\mathrm{SB}}\\, A \\,\\mu_{T}^{4}} = \\left(\\frac{T}{\\mu_{T}}\\right)^{4}\n$$\n绝对温度 $T$ 被建模为均值为 $\\mathbb{E}[T] = \\mu_{T}$、方差为 $\\mathrm{Var}(T) = \\sigma_{T}^{2}$ 的高斯随机变量。为方便起见，我们定义一个标准正态随机变量 $X$ 为\n$$\nX = \\frac{T - \\mu_{T}}{\\sigma_{T}}\n$$\n使得 $X \\sim \\mathcal{N}(0,1)$。根据这个定义，我们可以用 $X$ 来表示 $T$：\n$$\nT = \\mu_{T} + \\sigma_{T} X\n$$\n将此代入 $r$ 的表达式，得到：\n$$\nr = \\left(\\frac{\\mu_{T} + \\sigma_{T} X}{\\mu_{T}}\\right)^{4} = \\left(1 + \\frac{\\sigma_{T}}{\\mu_{T}} X\\right)^{4}\n$$\n使用变异系数的定义 $c = \\sigma_{T}/\\mu_{T}$， $r$ 的表达式变成一个关于 $X$ 的多项式，其系数是 $c$ 的幂：\n$$\nr = (1 + cX)^{4}\n$$\n由于指数是正整数，我们可以使用二项式定理来获得一个精确的有限展开式：\n$$\nr = \\binom{4}{0}(cX)^{0} + \\binom{4}{1}(cX)^{1} + \\binom{4}{2}(cX)^{2} + \\binom{4}{3}(cX)^{3} + \\binom{4}{4}(cX)^{4}\n$$\n$$\nr = 1 + 4cX + 6c^{2}X^{2} + 4c^{3}X^{3} + c^{4}X^{4}\n$$\n为了求期望 $\\mathbb{E}[r]$，我们利用期望算子的线性性质，对其逐项求期望：\n$$\n\\mathbb{E}[r] = \\mathbb{E}[1 + 4cX + 6c^{2}X^{2} + 4c^{3}X^{3} + c^{4}X^{4}] = 1 + 4c\\mathbb{E}[X] + 6c^{2}\\mathbb{E}[X^{2}] + 4c^{3}\\mathbb{E}[X^{3}] + c^{4}\\mathbb{E}[X^{4}]\n$$\n标准正态随机变量 $X \\sim \\mathcal{N}(0,1)$ 的各阶矩是众所周知的：$\\mathbb{E}[X] = 0$，$\\mathbb{E}[X^{2}] = 1$，$\\mathbb{E}[X^{3}] = 0$，以及 $\\mathbb{E}[X^{4}] = 3$。代入这些值，可以得到 $r$ 的均值的精确表达式：\n$$\n\\mathbb{E}[r] = 1 + 4c(0) + 6c^{2}(1) + 4c^{3}(0) + c^{4}(3) = 1 + 6c^{2} + 3c^{4}\n$$\n问题要求结果包含所有直到并包括 $c^{2}$ 阶的项。截断该精确表达式，我们得到：\n$$\n\\mathbb{E}[r] \\approx 1 + 6c^{2}\n$$\n接下来，我们计算方差 $\\mathrm{Var}(r)$。我们使用基本关系式 $\\mathrm{Var}(r) = \\mathbb{E}[r^{2}] - (\\mathbb{E}[r])^{2}$。我们必须以所需精度阶数一致地计算右侧的每一项。方差的主导项将是 $c^{2}$ 阶的，因此我们必须计算 $\\mathbb{E}[r^{2}]$ 和 $(\\mathbb{E}[r])^{2}$ 并包含所有直到 $O(c^{2})$ 的项。\n\n首先，我们求 $r^{2}$ 的表达式：\n$$\nr^{2} = ((1 + cX)^{4})^{2} = (1 + cX)^{8}\n$$\n使用二项式定理展开此式：\n$$\nr^{2} = 1 + 8cX + \\binom{8}{2}(cX)^{2} + O(c^{3}) = 1 + 8cX + 28c^{2}X^{2} + O(c^{3})\n$$\n求期望并保留到 $c^{2}$ 阶的项：\n$$\n\\mathbb{E}[r^{2}] \\approx \\mathbb{E}[1 + 8cX + 28c^{2}X^{2}] = 1 + 8c\\mathbb{E}[X] + 28c^{2}\\mathbb{E}[X^{2}] = 1 + 8c(0) + 28c^{2}(1) = 1 + 28c^{2}\n$$\n接下来，我们计算 $(\\mathbb{E}[r])^{2}$ 到 $c^{2}$ 阶。使用我们推导出的 $\\mathbb{E}[r]$ 的表达式：\n$$\n(\\mathbb{E}[r])^{2} = (1 + 6c^{2} + 3c^{4})^{2}\n$$\n展开并保留到 $c^{2}$ 阶的项：\n$$\n(\\mathbb{E}[r])^{2} \\approx (1 + 6c^{2})^{2} = 1^{2} + 2(1)(6c^{2}) + (6c^{2})^{2} = 1 + 12c^{2} + 36c^{4}\n$$\n截断到 $c^{2}$ 阶，得到：\n$$\n(\\mathbb{E}[r])^{2} \\approx 1 + 12c^{2}\n$$\n最后，我们计算方差：\n$$\n\\mathrm{Var}(r) = \\mathbb{E}[r^{2}] - (\\mathbb{E}[r])^{2} \\approx (1 + 28c^{2}) - (1 + 12c^{2}) = 16c^{2}\n$$\n这个结果是方差展开式中的主导非平凡项，并且精确到 $c^{2}$ 阶。\n\n无量纲热率 $r$ 的前两阶矩，精确到 $c^{2}$ 阶，为：\n$$\n\\mathbb{E}[r] = 1 + 6c^{2}\n$$\n$$\n\\mathrm{Var}(r) = 16c^{2}\n$$\n这些就是所要求的闭式解析表达式。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1+6c^{2} & 16c^{2} \\end{pmatrix}}\n$$", "id": "2536849"}, {"introduction": "前面的练习关注于传播已知的输入不确定性，但在实际工程中，我们往往需要从实验数据中反向推断这些不确定性的大小，这便是所谓的“逆问题”。本练习将指导你完成一个完整的贝叶斯校准流程，从带噪声的应力-应变测量数据中推断材料的杨氏模量。你将学习如何运用贝叶斯定理，将先验知识与数据相结合，从而获得不确定参数的后验概率分布。[@problem_id:2707423]", "problem": "一根细长、均匀的线性弹性杆承受小的单轴应变。在小应变情况下，其本构关系为线性胡克定律，可写为如下测量模型\n$$\n\\sigma_i \\;=\\; E\\,\\varepsilon_i \\;+\\; \\eta_i,\\quad i=1,\\dots,n,\n$$\n其中 $E$ 是（未知的）杨氏模量，$\\varepsilon_i$ 是给定的应变水平，$\\sigma_i$ 是测量的应力，$\\eta_i$ 是独立同分布（i.i.d.）的高斯测量误差，其均值为零，方差为已知的 $\\sigma^2$。假设使用共轭先验 $E \\sim \\mathcal{N}(m_0, s_0^2)$ 进行贝叶斯标定，且该先验与误差无关。\n\n给定 $n=4$ 组测量数据，其应变和应力（单位为吉帕斯卡，$\\mathrm{GPa}$）如下：\n$$\n\\big(\\varepsilon_1,\\sigma_1\\big)=(0.0010,\\,0.212),\\quad\n\\big(\\varepsilon_2,\\sigma_2\\big)=(0.0015,\\,0.310),\\\\\n\\big(\\varepsilon_3,\\sigma_3\\big)=(0.0020,\\,0.425),\\quad\n\\big(\\varepsilon_4,\\sigma_4\\big)=(0.0025,\\,0.520).\n$$\n已知测量噪声方差为 $\\sigma^2 = (0.01)^2$ $\\mathrm{GPa}^2$，先验分布的参数为 $m_0 = 200$ $\\mathrm{GPa}$ 和 $s_0^2 = 30^2$ $\\mathrm{GPa}^2$。\n\n任务：\n- 从贝叶斯定理以及高斯似然和先验的定义出发，推导给定数据 $\\{(\\varepsilon_i,\\sigma_i)\\}_{i=1}^4$ 时 $E$ 的后验分布。你的推导不得引用任何未经证明的简化公式。\n- 使用全概率定律并以 $E$ 为条件，推导在新的应变水平 $\\varepsilon_\\star = 0.0030$ 下，未来应力测量值 $\\sigma_\\star$ 的后验预测分布。\n- 最后，利用给定的数据和超参数，数值计算在 $\\varepsilon_\\star=0.0030$ 时的后验预测平均应力。将你的答案四舍五入到四位有效数字，并以 $\\mathrm{GPa}$ 为单位表示。你的最终答案必须是一个实数。", "solution": "该问题经检验在科学上是成立的、适定的和客观的。这是一个固体力学中线性模型的标准贝叶斯标定问题。所有必要信息都已提供且内部一致。我们开始求解。\n\n令 $n$ 次测量的集合表示为 $\\mathcal{D} = \\{(\\varepsilon_i, \\sigma_i)\\}_{i=1}^n$。我们的任务是求出杨氏模量 $E$ 的后验分布，以及新的应力测量值 $\\sigma_\\star$ 的后验预测分布。\n\n第一个任务是推导给定数据时 $E$ 的后验分布 $p(E|\\mathcal{D})$。根据贝叶斯定理，后验概率密度函数正比于似然函数与先验概率的乘积：\n$$\np(E|\\mathcal{D}) \\propto p(\\mathcal{D}|E) p(E)\n$$\n测量模型由 $\\sigma_i = E\\varepsilon_i + \\eta_i$ 给出，其中误差 $\\eta_i$ 独立同分布（i.i.d.），服从 $\\eta_i \\sim \\mathcal{N}(0, \\sigma^2)$。这意味着在给定 $E$ 和 $\\varepsilon_i$ 的条件下，单次应力测量值 $\\sigma_i$ 的条件分布是高斯分布：\n$$\n\\sigma_i | E \\sim \\mathcal{N}(E\\varepsilon_i, \\sigma^2)\n$$\n因此，$\\sigma_i$ 的概率密度函数为：\n$$\np(\\sigma_i|E) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(\\sigma_i - E\\varepsilon_i)^2}{2\\sigma^2} \\right)\n$$\n由于各次测量是独立的，整个数据集 $\\mathcal{D}$（或者简写为应力向量 $\\pmb{\\sigma} = (\\sigma_1, \\dots, \\sigma_n)^T$）的似然函数是各次测量的概率密度函数的乘积：\n$$\np(\\mathcal{D}|E) = \\prod_{i=1}^n p(\\sigma_i|E) = (2\\pi\\sigma^2)^{-n/2} \\exp\\left( -\\frac{1}{2\\sigma^2} \\sum_{i=1}^n (\\sigma_i - E\\varepsilon_i)^2 \\right)\n$$\n$E$ 的先验分布是高斯分布：$E \\sim \\mathcal{N}(m_0, s_0^2)$。其概率密度函数为：\n$$\np(E) = \\frac{1}{\\sqrt{2\\pi s_0^2}} \\exp\\left( -\\frac{(E - m_0)^2}{2s_0^2} \\right)\n$$\n现在，我们构建后验分布。我们可以忽略任何不依赖于 $E$ 的常数因子。\n$$\np(E|\\mathcal{D}) \\propto \\exp\\left( -\\frac{1}{2\\sigma^2} \\sum_{i=1}^n (\\sigma_i - E\\varepsilon_i)^2 \\right) \\exp\\left( -\\frac{(E - m_0)^2}{2s_0^2} \\right)\n$$\n后验分布正比于指数函数，其指数是两个指数项的和：\n$$\np(E|\\mathcal{D}) \\propto \\exp\\left( -\\frac{1}{2} \\left[ \\frac{1}{\\sigma^2} \\sum_{i=1}^n (\\sigma_i - E\\varepsilon_i)^2 + \\frac{1}{s_0^2} (E - m_0)^2 \\right] \\right)\n$$\n为了确定该分布的形式，我们将指数中的项展开为 $E$ 的二次函数：\n$$\n\\frac{1}{\\sigma^2} \\sum_{i=1}^n (\\sigma_i^2 - 2E\\varepsilon_i\\sigma_i + E^2\\varepsilon_i^2) + \\frac{1}{s_0^2} (E^2 - 2Em_0 + m_0^2)\n$$\n我们收集包含 $E^2$ 和 $E$ 的项：\n$$\nE^2 \\left( \\frac{\\sum_{i=1}^n \\varepsilon_i^2}{\\sigma^2} + \\frac{1}{s_0^2} \\right) - 2E \\left( \\frac{\\sum_{i=1}^n \\varepsilon_i\\sigma_i}{\\sigma^2} + \\frac{m_0}{s_0^2} \\right) + \\text{const.}\n$$\n这个关于 $E$ 的二次型表明后验分布也是高斯分布，我们可以将其写作 $E|\\mathcal{D} \\sim \\mathcal{N}(m_n, s_n^2)$。这样一个分布的密度函数正比于 $\\exp\\left(-\\frac{(E-m_n)^2}{2s_n^2}\\right)$，其指数的参数为：\n$$\n\\frac{(E-m_n)^2}{2s_n^2} = \\frac{1}{2s_n^2} (E^2 - 2Em_n + m_n^2) = E^2\\left(\\frac{1}{2s_n^2}\\right) - E\\left(\\frac{m_n}{s_n^2}\\right) + \\text{const.}\n$$\n通过将 $E^2$ 和 $E$ 的系数与从后验分布推导出的表达式进行比较，我们可以确定后验精度 $1/s_n^2$ 和项 $m_n/s_n^2$：\n$$\n\\frac{1}{s_n^2} = \\frac{1}{s_0^2} + \\frac{\\sum_{i=1}^n \\varepsilon_i^2}{\\sigma^2}\n$$\n$$\n\\frac{m_n}{s_n^2} = \\frac{m_0}{s_0^2} + \\frac{\\sum_{i=1}^n \\varepsilon_i\\sigma_i}{\\sigma^2}\n$$\n由此，后验方差 $s_n^2$ 和后验均值 $m_n$ 为：\n$$\ns_n^2 = \\left( \\frac{1}{s_0^2} + \\frac{1}{\\sigma^2} \\sum_{i=1}^n \\varepsilon_i^2 \\right)^{-1}\n$$\n$$\nm_n = s_n^2 \\left( \\frac{m_0}{s_0^2} + \\frac{1}{\\sigma^2} \\sum_{i=1}^n \\varepsilon_i\\sigma_i \\right)\n$$\n因此，后验分布为 $p(E|\\mathcal{D}) = \\mathcal{N}(m_n, s_n^2)$。第一个任务完成。\n\n第二个任务是推导在新应变 $\\varepsilon_\\star$ 下的新测量值 $\\sigma_\\star$ 的后验预测分布。我们使用全概率定律，对未知参数 $E$ 进行边缘化：\n$$\np(\\sigma_\\star|\\mathcal{D}) = \\int p(\\sigma_\\star, E | \\mathcal{D}) dE = \\int p(\\sigma_\\star | E, \\mathcal{D}) p(E|\\mathcal{D}) dE\n$$\n给定 $E$，新的测量值 $\\sigma_\\star$ 与过去的数据 $\\mathcal{D}$ 无关，因此 $p(\\sigma_\\star | E, \\mathcal{D}) = p(\\sigma_\\star | E)$。新测量值的模型是 $\\sigma_\\star = E \\varepsilon_\\star + \\eta_\\star$，其中 $\\eta_\\star \\sim \\mathcal{N}(0, \\sigma^2)$。因此，相应的分布是：\n$$\np(\\sigma_\\star | E) = \\mathcal{N}(\\sigma_\\star; E\\varepsilon_\\star, \\sigma^2)\n$$\n后验预测分布是两个高斯分布的卷积：\n$$\np(\\sigma_\\star|\\mathcal{D}) = \\int \\mathcal{N}(\\sigma_\\star; E\\varepsilon_\\star, \\sigma^2) \\mathcal{N}(E; m_n, s_n^2) dE\n$$\n这个积分描述了随机变量 $\\sigma_\\star$ 的分布，它可以表示为两个独立的高斯随机变量（以数据 $\\mathcal{D}$ 为条件）的和：测量中的不确定性 $\\eta_\\star \\sim \\mathcal{N}(0, \\sigma^2)$，以及平均应力中的不确定性 $E\\varepsilon_\\star$。变量 $E\\varepsilon_\\star$ 是一个尺度变换后的高斯变量，因为 $E \\sim \\mathcal{N}(m_n, s_n^2)$，所以 $E\\varepsilon_\\star \\sim \\mathcal{N}(m_n\\varepsilon_\\star, s_n^2\\varepsilon_\\star^2)$。\n两个独立高斯随机变量的和也是一个高斯随机变量。其均值是两个均值之和，其方差是两个方差之和。\n后验预测分布的均值为：\n$$\n\\mathbb{E}[\\sigma_\\star|\\mathcal{D}] = \\mathbb{E}[E\\varepsilon_\\star + \\eta_\\star|\\mathcal{D}] = \\mathbb{E}[E\\varepsilon_\\star|\\mathcal{D}] + \\mathbb{E}[\\eta_\\star|\\mathcal{D}] = m_n \\varepsilon_\\star + 0 = m_n \\varepsilon_\\star\n$$\n后验预测分布的方差为：\n$$\n\\text{Var}(\\sigma_\\star|\\mathcal{D}) = \\text{Var}(E\\varepsilon_\\star + \\eta_\\star|\\mathcal{D}) = \\text{Var}(E\\varepsilon_\\star|\\mathcal{D}) + \\text{Var}(\\eta_\\star|\\mathcal{D}) = s_n^2 \\varepsilon_\\star^2 + \\sigma^2\n$$\n所以，后验预测分布为 $\\sigma_\\star|\\mathcal{D} \\sim \\mathcal{N}(m_n \\varepsilon_\\star, s_n^2 \\varepsilon_\\star^2 + \\sigma^2)$。第二个任务完成。\n\n第三个任务是使用提供的数据计算后验预测平均应力 $\\mathbb{E}[\\sigma_\\star|\\mathcal{D}] = m_n \\varepsilon_\\star$。\n给定数据：$n=4$，$(\\varepsilon_1,\\sigma_1)=(0.0010, 0.212)$，$(\\varepsilon_2,\\sigma_2)=(0.0015, 0.310)$，$(\\varepsilon_3,\\sigma_3)=(0.0020, 0.425)$，$(\\varepsilon_4,\\sigma_4)=(0.0025, 0.520)$。\n超参数：$m_0=200$，$s_0^2=30^2=900$，$\\sigma^2=(0.01)^2=0.0001$。\n新应变：$\\varepsilon_\\star = 0.0030$。\n\n首先，我们根据数据计算所需的总和：\n$$\n\\sum_{i=1}^4 \\varepsilon_i^2 = (0.0010)^2 + (0.0015)^2 + (0.0020)^2 + (0.0025)^2 = 1.35 \\times 10^{-5}\n$$\n$$\n\\sum_{i=1}^4 \\varepsilon_i\\sigma_i = (0.0010)(0.212) + (0.0015)(0.310) + (0.0020)(0.425) + (0.0025)(0.520) = 0.002827\n$$\n现在，我们计算后验参数。首先是后验方差 $s_n^2$：\n$$\n\\frac{1}{s_n^2} = \\frac{1}{s_0^2} + \\frac{\\sum \\varepsilon_i^2}{\\sigma^2} = \\frac{1}{900} + \\frac{1.35 \\times 10^{-5}}{0.0001} = \\frac{1}{900} + 0.135\n$$\n$$\ns_n^2 = \\left( \\frac{1}{900} + 0.135 \\right)^{-1} = \\left(\\frac{1}{900} + \\frac{135}{1000}\\right)^{-1} = \\left(\\frac{2 + 243}{1800}\\right)^{-1} = \\left(\\frac{245}{1800}\\right)^{-1} = \\left(\\frac{49}{360}\\right)^{-1} = \\frac{360}{49}\n$$\n接下来，我们计算后验均值 $m_n$：\n$$\n\\frac{m_n}{s_n^2} = \\frac{m_0}{s_0^2} + \\frac{\\sum \\varepsilon_i\\sigma_i}{\\sigma^2} = \\frac{200}{900} + \\frac{0.002827}{0.0001} = \\frac{2}{9} + 28.27 = \\frac{2}{9} + \\frac{2827}{100} = \\frac{200 + 25443}{900} = \\frac{25643}{900}\n$$\n$$\nm_n = s_n^2 \\left( \\frac{25643}{900} \\right) = \\frac{360}{49} \\cdot \\frac{25643}{900} = \\frac{360}{900} \\cdot \\frac{25643}{49} = \\frac{2}{5} \\cdot \\frac{25643}{49} = \\frac{51286}{245}\n$$\n数值上，$m_n \\approx 209.3306 \\text{ GPa}$。最后，我们计算在 $\\varepsilon_\\star = 0.0030$ 时的后验预测平均应力：\n$$\n\\mathbb{E}[\\sigma_\\star|\\mathcal{D}] = m_n \\varepsilon_\\star = \\frac{51286}{245} \\times 0.0030 \\approx 209.330612 \\times 0.0030 \\approx 0.6279918\n$$\n四舍五入到四位有效数字，结果是 $0.6280$。单位是 GPa。", "answer": "$$ \\boxed{0.6280} $$", "id": "2707423"}]}