{"hands_on_practices": [{"introduction": "任何吉布斯采样器的核心引擎都是其全条件分布。第一个练习 [@problem_id:1338680] 将带你从一个给定的联合概率函数出发，推导这些关键的条件分布。掌握这一基础步骤至关重要，因为它构成了实现和理解采样器算法的数学基石。", "problem": "考虑两个相互作用的二元随机变量 $X$ 和 $Y$，它们各自可以取值为 0 或 1。它们的联合概率质量函数由一个未归一化的关系式 $P(X=x, Y=y) \\propto f(x, y)$ 给出，其中函数 $f(x, y)$ 定义在 $x, y \\in \\{0, 1\\}$ 上。这种类型的分布在统计力学和机器学习等领域中，对于建模相互作用的系统至关重要。\n\n对于一个特定的系统，其相互作用由以下函数描述：\n$$f(x, y) = \\exp(5xy - 2x - y)$$\n因此，联合概率由下式给出：\n$$P(X=x, Y=y) \\propto \\exp(5xy - 2x - y)$$\n\n你的任务是确定在给定变量 $Y$ 的状态下，变量 $X$ 取值为 1 的条件概率。推导 $P(X=1 | Y=y)$ 作为 $y$ 的函数的符号表达式。", "solution": "我们给定的联合分布由一个未归一化的关系式 $P(X=x, Y=y) \\propto f(x,y)$ 指定，其中 $f(x,y) = \\exp(5xy - 2x - y)$。对于离散随机变量，条件概率由下式给出\n$$\nP(X=1 \\mid Y=y) = \\frac{P(X=1, Y=y)}{\\sum_{x \\in \\{0,1\\}} P(X=x, Y=y)}.\n$$\n因为 $P$ 与 $f$ 成正比，共同的比例常数在比率中被消去，所以我们可以直接使用 $f$ 进行计算：\n$$\nP(X=1 \\mid Y=y) = \\frac{f(1,y)}{f(0,y) + f(1,y)}.\n$$\n计算所需的各项：\n$$\nf(1,y) = \\exp(5 \\cdot 1 \\cdot y - 2 \\cdot 1 - y) = \\exp(4y - 2),\n$$\n$$\nf(0,y) = \\exp(5 \\cdot 0 \\cdot y - 2 \\cdot 0 - y) = \\exp(-y).\n$$\n因此，\n$$\nP(X=1 \\mid Y=y) = \\frac{\\exp(4y - 2)}{\\exp(-y) + \\exp(4y - 2)}.\n$$\n将分子和分母同除以 $\\exp(4y - 2)$ 以进行化简：\n$$\nP(X=1 \\mid Y=y) = \\frac{1}{1 + \\exp\\big((-y) - (4y - 2)\\big)} = \\frac{1}{1 + \\exp(2 - 5y)}.\n$$\n这就得到了作为 $y$ 的函数的所求符号表达式。", "answer": "$$\\boxed{\\frac{1}{1 + \\exp(2 - 5y)}}$$", "id": "1338680"}, {"introduction": "在推导出条件分布之后，下一步就是利用它们来生成样本。这个实践问题 [@problem_id:1338677] 模拟了一个混合系统（包含连续和离散变量）中吉布斯采样器的第一步。通过精确计算初次抽样的结果，你将对采样器迭代更新的机制有一个具体而清晰的认识。", "problem": "一个二维随机变量 $(X, Y)$ 由其条件分布来刻画。给定 $Y=y$ 时 $X$ 的条件分布是区间 $[0, y]$ 上的连续均匀分布。给定 $X=x$ 时 $Y$ 的条件分布是均值为 $x$ 的泊松分布。\n\n一个基于吉布斯采样器的马尔可夫链蒙特卡洛（MCMC）模拟被用来从 $(X, Y)$ 的联合分布中生成样本。生成样本序列 $(X^{(t)}, Y^{(t)})$（其中 $t = 0, 1, 2, \\dots$）的迭代过程定义如下：\n1.  从给定 $Y=Y^{(t)}$ 时 $X$ 的条件分布中抽取 $X^{(t+1)}$。\n2.  从给定 $X=X^{(t+1)}$ 时 $Y$ 的条件分布中抽取 $Y^{(t+1)}$。\n\n该过程从初始状态 $(X^{(0)}, Y^{(0)}) = (4, 4)$ 开始。\n\n计算概率 $P(1  X^{(1)}  5/2)$。请用精确分数表示你的答案。", "solution": "我们已知条件分布：\n- 对于任意 $y0$，$X \\mid Y=y \\sim \\text{Uniform}(0,y)$，因此条件密度为\n$$\nf_{X\\mid Y}(x \\mid y) = \\begin{cases}\n\\frac{1}{y},  0 \\leq x \\leq y, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n- 对于任意 $x \\geq 0$，$Y \\mid X=x \\sim \\text{Poisson}(x)$。\n\n在吉布斯采样器中，步骤 1 从给定 $Y=Y^{(0)}$ 时 $X$ 的条件分布中更新 $X^{(1)}$。由于过程从 $(X^{(0)}, Y^{(0)})=(4,4)$ 开始，我们有\n$$\nX^{(1)} \\mid Y^{(0)}=4 \\sim \\text{Uniform}(0,4),\n$$\n因此其条件密度在 $0 \\leq x \\leq 4$ 时为 $f_{X^{(1)} \\mid Y^{(0)}}(x \\mid 4) = \\frac{1}{4}$，其他情况下为 0。\n\n因此，\n$$\nP(1  X^{(1)}  5/2) = \\int_{1}^{5/2} \\frac{1}{4} \\, dx = \\frac{1}{4}\\left(\\frac{5}{2} - 1\\right) = \\frac{1}{4} \\cdot \\frac{3}{2} = \\frac{3}{8}.\n$$\n因为在这个设置中 $Y^{(0)}=4$ 是确定性的，所以这个条件概率等于无条件概率 $P(1  X^{(1)}  5/2)$。", "answer": "$$\\boxed{\\frac{3}{8}}$$", "id": "1338677"}, {"introduction": "尽管吉布斯采样功能强大，但它并非万能钥匙，在特定条件下可能会失效。这个思想实验 [@problem_id:1338719] 探讨了一个关键的局限性：采样器可能会被“卡住”，无法遍历整个目标分布。理解这种“可约性”（reducibility）问题对于诊断采样故障和正确应用MCMC方法至关重要。", "problem": "一个用于特殊化学反应堆的监测系统追踪两个相关的温度读数，$X$ 和 $Y$。由于反应堆设计所施加的严格物理约束，这两个读数的联合概率密度函数 $p(x, y)$ 仅在由方程 $x + y = 10$ 定义的线段上非零，其中 $x$ 和 $y$ 均为非负值（即，$x \\ge 0$ 且 $y \\ge 0$）。在这个可及的线段上，概率分布是均匀的。\n\n一位数据科学家决定使用吉布斯采样器（Gibbs sampler）来生成遵循此分布的合成数据点 $(X, Y)$。采样器在点 $(X_0, Y_0) = (4.5, 5.5)$ 处初始化。从当前状态 $(X_{t-1}, Y_{t-1})$ 生成下一个状态 $(X_{t}, Y_{t})$ 的采样过程（对于 $t = 1, 2, 3, \\dots$）如下：\n1. 从条件分布 $p(x | Y=Y_{t-1})$ 中为第一个变量 $X_{t}$ 抽取一个新值。\n2. 从条件分布 $p(y | X=X_{t})$ 中为第二个变量 $Y_{t}$ 抽取一个新值。\n\n确定采样器在100次完整迭代后的状态 $(X_{100}, Y_{100})$。请用一对数表示您的答案。", "solution": "联合支撑集是线段 $S=\\{(x,y): x\\ge 0,\\ y\\ge 0,\\ x+y=10\\}$。由于 $p(x,y)$ 在这个一维集合上是均匀的，对于任何 $y\\in[0,10]$，条件概率 $p(x\\mid Y=y)$ 将其所有质量集中在满足 $x+y=10$ 的唯一 $x$ 上，即，\n$$\np(x\\mid Y=y)=\\delta\\!\\left(x-(10-y)\\right),\n$$\n同样地，对于任何 $x\\in[0,10]$，\n$$\np(y\\mid X=x)=\\delta\\!\\left(y-(10-x)\\right).\n$$\n因此，吉布斯更新是确定性的：\n$$\nX_{t}=10-Y_{t-1},\\qquad Y_{t}=10-X_{t}.\n$$\n从 $(X_{0},Y_{0})=(4.5,5.5)$ 开始，第一次迭代得出\n$$\nX_{1}=10-5.5=4.5,\\qquad Y_{1}=10-4.5=5.5,\n$$\n因此状态保持不变。通过归纳法，如果 $(X_{t},Y_{t})=(4.5,5.5)$，那么\n$$\nX_{t+1}=10-5.5=4.5,\\qquad Y_{t+1}=10-4.5=5.5,\n$$\n因此，对于所有的 $t$，该链都固定在 $(4.5,5.5)$。特别地，\n$$\n(X_{100},Y_{100})=(4.5,5.5).\n$$", "answer": "$$\\boxed{(4.5, 5.5)}$$", "id": "1338719"}]}