{"hands_on_practices": [{"introduction": "在计算科学中，我们常常只知道一个概率分布的形状，而不知道其完整的、归一化的概率密度函数。例如，在贝叶斯统计中，后验分布通常就只能确定到一个常数因子。这个练习 [@problem_id:1387094] 将引导你完成拒绝采样的关键初始步骤：首先对目标密度进行归一化，然后为均匀提议分布找到最优的常数 $M$。掌握这一过程是正确应用拒绝采样方法的基础。", "problem": "在统计计算中，我们常常需要从一个难以直接采样的概率分布中生成随机样本。一种常用的技术是拒绝采样法。\n\n考虑一个场景，我们希望从一个目标概率分布中生成样本，该分布的密度函数为 $f(x)$，定义在区间 $[0, 1]$ 上。已知该密度函数在此区间上的形状与正弦函数成正比，即对于 $x \\in [0, 1]$ 有 $f(x) \\propto \\sin(\\pi x)$，而在其他情况下 $f(x) = 0$。\n\n对于拒绝采样过程，我们使用一个更简单的提议分布。在本例中，所选的提议分布是 $[0, 1]$ 上的标准均匀分布，记为 $U(0,1)$，其概率密度函数为 $g(x) = 1$ (对于 $x \\in [0, 1]$)。\n\n拒绝采样算法需要一个常数 $M$，该常数满足条件 $f(x) \\le M g(x)$ 对所有 $x$ 值都成立。为了最大化采样过程的效率，必须使用该常数 $M$ 的最小可能值。\n\n确定这个最优常数 $M$ 的精确值。您的最终答案应以闭式解析表达式的形式给出。", "solution": "我们将 $[0,1]$ 上的目标密度函数记为 $f(x)$，其形状由 $f(x) \\propto \\sin(\\pi x)$ 给出。写作\n$$\nf(x) = c\\,\\sin(\\pi x)\\ \\text{for}\\ x \\in [0,1], \\quad f(x)=0\\ \\text{otherwise},\n$$\n其中 $c$ 是归一化常数，由 $f$ 在 $[0,1]$ 上的积分为 $1$ 这一条件确定。因此，\n$$\n1=\\int_{0}^{1} f(x)\\,dx = c \\int_{0}^{1} \\sin(\\pi x)\\,dx.\n$$\n计算该积分：\n$$\n\\int_{0}^{1} \\sin(\\pi x)\\,dx = \\left[-\\frac{\\cos(\\pi x)}{\\pi}\\right]_{0}^{1} = \\frac{2}{\\pi}.\n$$\n所以，\n$$\nc \\cdot \\frac{2}{\\pi} = 1 \\quad \\Longrightarrow \\quad c = \\frac{\\pi}{2}.\n$$\n因此，\n$$\nf(x) = \\frac{\\pi}{2}\\,\\sin(\\pi x)\\ \\text{for}\\ x\\in[0,1].\n$$\n提议分布的密度函数为 $g(x)=1$ (对于 $x\\in[0,1]$)，而在其他情况下 $g(x)=0$。对于拒绝采样法，最优常数 $M$ 满足 $f(x) \\le M g(x)$ 对所有 $x$ 成立，而满足此条件的最小 $M$ 为\n$$\nM^{\\ast} = \\sup_{x} \\frac{f(x)}{g(x)} = \\sup_{x\\in[0,1]} f(x),\n$$\n因为在 $[0,1]$ 上 $g(x)=1$，且两个密度函数在此区间外均为零。函数 $\\sin(\\pi x)$ 在 $[0,1]$ 区间上当 $x=\\tfrac{1}{2}$ 时取得其最大值 $1$，因此\n$$\nM^{\\ast} = \\frac{\\pi}{2} \\cdot \\max_{x\\in[0,1]} \\sin(\\pi x) = \\frac{\\pi}{2}.\n$$\n所以，精确的最优常数值是 $\\frac{\\pi}{2}$。", "answer": "$$\\boxed{\\frac{\\pi}{2}}$$", "id": "1387094"}, {"introduction": "建立采样器后，理解其输出的性质至关重要。拒绝采样的最终目的是生成与从真实目标分布中抽取无异的样本。这个练习 [@problem_id:832348] 要求你计算一个被接受样本的期望值，这是一个有力的概念性检验，它将巩固拒绝采样的核心理论保证：被接受的样本能够准确地复现目标分布的统计特性。", "problem": "拒绝采样是一种蒙特卡罗方法，它使用一个更简单的提议分布 $q(x)$ 从目标概率分布 $p(x)$ 中生成样本。该方法需要找到一个常数 $M$，使得对于所有的 $x$ 都有 $p(x) \\leq M q(x)$。该算法的步骤如下：\n1. 从提议分布 $q(x)$ 中抽取一个样本 $x_i$。\n2. 从 $U[0, 1]$ 中抽取一个均匀随机数 $u_i$。\n3. 如果 $u_i \\leq \\frac{p(x_i)}{M q(x_i)}$，则接受样本 $x_i$。否则，拒绝该样本。\n\n考虑一个目标概率密度函数 $p(x)$，它在区间 $[0, a]$ (其中 $a > 0$) 上与 $x$ 成正比，在其他地方为零。提议分布 $q(x)$ 是在同一区间 $[0, a]$ 上的均匀分布。\n\n推导代表一个样本的随机变量 $X$ 的期望值，条件是该样本已被此拒绝采样过程接受。请用参数 $a$ 表示你的答案。", "solution": "我们有目标密度\n$$p(x)=k\\,x\\quad(0\\le x\\le a),\\qquad q(x)=\\frac1a\\quad(0\\le x\\le a).$$ \n对 $p(x)$ 进行归一化可得\n$$1=\\int_0^a k\\,x\\,dx=k\\frac{a^2}{2}\\quad\\Longrightarrow\\quad k=\\frac{2}{a^2}.$$\n因此\n$$p(x)=\\frac{2x}{a^2},\\quad q(x)=\\frac1a.$$\n计算包络常数\n$$\\frac{p(x)}{q(x)}=\\frac{2x/a^2}{1/a}=\\frac{2x}{a},\\qquad M=\\max_{0\\le x\\le a}\\frac{2x}{a}=2.$$\n对于一次抽取 $x$，其接受概率为\n$$\\frac{p(x)}{M\\,q(x)}=\\frac{2x/a^2}{2\\,(1/a)}=\\frac{x}{a}.$$\n总接受率为\n$$P_{\\rm acc}=\\int_0^a q(x)\\,\\frac{p(x)}{M\\,q(x)}\\,dx\n=\\frac{1}{M}\\int_0^a p(x)\\,dx=\\frac{1}{2}.$$\n已接受样本的概率密度函数为\n$$f_{\\rm acc}(x)\n=\\frac{q(x)\\,\\frac{p(x)}{M\\,q(x)}}{P_{\\rm acc}}\n=\\frac{p(x)}{M\\,P_{\\rm acc}}\n=p(x).$$\n因此\n$$\\mathbb{E}[X\\mid\\text{accepted}]\n=\\int_0^a x\\,p(x)\\,dx\n=\\frac{2}{a^2}\\int_0^a x^2\\,dx\n=\\frac{2}{a^2}\\frac{a^3}{3}\n=\\frac{2a}{3}.$$", "answer": "$$\\boxed{\\frac{2a}{3}}$$", "id": "832348"}, {"introduction": "拒绝采样的效率不是确定性的，而是一个随机过程。生成一个样本的“成本”是我们在获得第一个接受样本之前必须提出的提议次数。这个练习 [@problem_id:832183] 探讨了算法性能的随机性。通过计算所需试验次数的方差，你将把采样器的接受概率与几何分布联系起来，从而更深入地理解蒙特卡洛方法中涉及的实际成本和可变性。", "problem": "拒绝采样是一种蒙特卡罗方法，用于在难以直接采样时从目标概率分布 $p(x)$ 中生成样本。该方法依赖于一个更简单的提议分布 $q(x)$，我们可以很容易地从中抽取样本。该算法的流程是从 $q(x)$ 中抽取一个样本 $x$，并以一定的概率接受它。重复此过程，直到一个样本被接受。\n\n考虑一个目标分布，其概率密度在区间 $[0, 1]$ 上与 $f(x) = x$ 成正比，在其他地方为零。我们将使用一个均匀提议分布，即对于 $x \\in [0, 1]$，$q(x) = 1$，在其他地方为零。\n\n对一个提议样本 $x$ 的接受准则基于一个常数 $M$，该常数必须对所有 $x$ 满足 $p(x) \\le M q(x)$，其中 $p(x)$ 是归一化的目标概率密度函数。为了达到最佳效率，我们选择 $M$ 的最小可能值。如果从均匀分布 $U(0, 1)$ 中抽取的一个随机数 $u$ 满足条件 $u \\le \\frac{p(x)}{M q(x)}$，则提议的样本 $x \\sim q(x)$ 被接受。\n\n设 $N$ 是为获得第一个被接受的样本所需的提议总次数的随机变量。推导 $N$ 的方差，记作 $\\text{Var}(N)$。", "solution": "1. 归一化目标密度：\n$$Z=\\int_0^1 x\\,dx=\\tfrac12,\\quad p(x)=\\frac{f(x)}{Z}=\\frac{x}{\\tfrac12}=2x\\quad (0\\le x\\le1).$$\n\n2. 最佳拒绝常数：\n$$M=\\sup_{x\\in[0,1]}\\frac{p(x)}{q(x)}=\\sup_{x\\in[0,1]}2x=2.$$\n\n3. 每次试验的接受概率：\n$$\\alpha=\\int_0^1 q(x)\\,\\frac{p(x)}{M\\,q(x)}\\,dx=\\frac1M\\int_0^1p(x)\\,dx=\\frac1M.$$\n\n4. 直到首次成功所需的试验次数 $N$ 服从几何分布，其方差为\n$$\\mathrm{Var}(N)=\\frac{1-\\alpha}{\\alpha^2}=\\frac{1-\\tfrac1M}{(\\tfrac1M)^2}=(M-1)M.$$\n\n5. 代入 $M=2$ 得出\n$$\\mathrm{Var}(N)=(2-1)\\cdot2=2.$$", "answer": "$$\\boxed{2}$$", "id": "832183"}]}