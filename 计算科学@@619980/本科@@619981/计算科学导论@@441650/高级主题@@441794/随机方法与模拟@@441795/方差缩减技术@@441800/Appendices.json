{"hands_on_practices": [{"introduction": "控制变量法是一种经典且强大的方差缩减技术。它利用一个与我们想要求解的随机变量相关，并且期望值已知的“控制变量”来提高估计精度。本练习将指导你动手计算最优的控制系数，并量化方差缩减的效果，从而让你深入理解该技术如何通过抵消部分随机性来提升蒙特卡洛模拟的效率。[@problem_id:1348989]", "problem": "一位分析师正在尝试估计 $\\theta = E[(U+1)^2]$ 的值，其中 $U$ 是一个在区间 $[0, 1]$ 上均匀分布的随机变量。标准方法是使用一个简单的蒙特卡洛估计量，即生成 $X = (U+1)^2$ 的样本并计算它们的平均值。该估计量的精度由单个样本的方差 $\\text{Var}(X)$ 决定。\n\n为了提高估计的效率，有人提出了一种控制变量技术。使用一个期望值已知的相关随机变量 $C = U$ 来构造一个新的估计量。单个样本的新估计量由 $X(b) = X - b(C - E[C])$ 给出，其中 $b$ 是一个待优化的实值常数系数。\n\n您的任务是确定该技术所能带来的理论上的改进。首先，求出使新估计量方差 $\\text{Var}(X(b))$ 最小化的最优系数 $b^*$。然后，计算方差缩减因子，即单个优化后的控制变量样本的方差与单个简单样本的方差之比。\n\n将此方差缩减因子 $\\frac{\\text{Var}(X(b^*))}{\\text{Var}(X)}$ 表示为一个精确分数。", "solution": "令 $U \\sim \\text{Unif}[0,1]$，$X=(U+1)^{2}$，以及 $C=U$。对于 $k \\geq 0$，有 $E[U^{k}]=\\frac{1}{k+1}$。因此 $E[U]=\\frac{1}{2}$，$E[U^{2}]=\\frac{1}{3}$，$E[U^{3}]=\\frac{1}{4}$，$E[U^{4}]=\\frac{1}{5}$，并且 $\\text{Var}(U)=\\frac{1}{12}$。\n\n将 $X$ 展开为 $X=U^{2}+2U+1$。则\n$$\nE[X]=E[U^{2}]+2E[U]+1=\\frac{1}{3}+1+1=\\frac{7}{3}.\n$$\n同样地\n$$\nX^{2}=(U^{2}+2U+1)^{2}=U^{4}+4U^{3}+6U^{2}+4U+1,\n$$\n所以\n$$\nE[X^{2}]=\\frac{1}{5}+4\\cdot\\frac{1}{4}+6\\cdot\\frac{1}{3}+4\\cdot\\frac{1}{2}+1=\\frac{31}{5}.\n$$\n因此\n$$\n\\text{Var}(X)=E[X^{2}]-(E[X])^{2}=\\frac{31}{5}-\\left(\\frac{7}{3}\\right)^{2}=\\frac{34}{45}.\n$$\n\n计算与 $C=U$ 的协方差：\n$$\n\\text{Cov}(U^{2},U)=E[U^{3}]-E[U^{2}]E[U]=\\frac{1}{4}-\\frac{1}{3}\\cdot\\frac{1}{2}=\\frac{1}{12},\n$$\n所以\n$$\n\\text{Cov}(X,C)=\\text{Cov}(U^{2}+2U+1,U)=\\frac{1}{12}+2\\cdot\\text{Var}(U)=\\frac{1}{12}+2\\cdot\\frac{1}{12}=\\frac{1}{4},\n$$\n且 $\\text{Var}(C)=\\text{Var}(U)=\\frac{1}{12}$。\n\n对于控制变量估计量 $X(b)=X-b(C-E[C])$，其方差为\n$$\n\\text{Var}(X(b))=\\text{Var}(X)-2b\\,\\text{Cov}(X,C)+b^{2}\\text{Var}(C).\n$$\n将该关于 $b$ 的二次式最小化，可得\n$$\nb^{*}=\\frac{\\text{Cov}(X,C)}{\\text{Var}(C)}=\\frac{\\frac{1}{4}}{\\frac{1}{12}}=3,\n$$\n且最小化的方差为\n$$\n\\text{Var}(X(b^{*}))=\\text{Var}(X)-\\frac{\\text{Cov}(X,C)^{2}}{\\text{Var}(C)}=\\frac{34}{45}-\\frac{\\left(\\frac{1}{4}\\right)^{2}}{\\frac{1}{12}}=\\frac{34}{45}-\\frac{3}{4}=\\frac{1}{180}.\n$$\n\n因此，方差缩减因子为\n$$\n\\frac{\\text{Var}(X(b^{*}))}{\\text{Var}(X)}=\\frac{\\frac{1}{180}}{\\frac{34}{45}}=\\frac{1}{136}.\n$$", "answer": "$$\\boxed{\\frac{1}{136}}$$", "id": "1348989"}, {"introduction": "对偶变量法的核心思想是利用对称性生成负相关的样本对，从而实现方差缩减。当一个样本导致高估时，其对偶样本则倾向于导致低估，二者平均后便能更接近真实值。本练习通过对比两种不同的蒙特卡洛设置，旨在让你辨析该技术生效的关键条件——单调性，从而深刻理解为何对偶变量法在某些情况下能显著提升效率，而在另一些情况下却毫无作用。[@problem_id:3201688]", "problem": "一个用于计算 $\\pi$ 的蒙特卡洛（MC）估计量在一个正方形内抽取均匀分布的点，并使用点是否在对应圆内的指示函数。考虑两种抽样设置和对偶变量（AV）策略，该策略将一个均匀变量 $U$ 映射到其对偶伙伴 $1-U$。\n\n设置 $S1$：通过令 $X = 2U_1 - 1$ 和 $Y = 2U_2 - 1$ 从 $[-1,1]^2$ 中均匀抽样 $(X,Y)$，其中 $U_1, U_2 \\sim \\text{Uniform}(0,1)$ 且相互独立。该估计量使用指示函数 $Z = \\mathbb{1}\\{X^2 + Y^2 \\le 1\\}$ 并乘以 $4$ 来估计 $\\pi$。\n\n设置 $S2$：通过令 $X = U_1$ 和 $Y = U_2$ 从 $[0,1]^2$ 中均匀抽样 $(X,Y)$，其中 $U_1, U_2 \\sim \\text{Uniform}(0,1)$ 且相互独立。该估计量再次使用 $Z = \\mathbb{1}\\{X^2 + Y^2 \\le 1\\}$ 并乘以 $4$。\n\n在两种设置中，通过 $(U_1,U_2) \\mapsto (1-U_1,1-U_2)$ 对每个坐标进行反映来形成一个 AV 对，从而产生第二个点。将两个对应的指示函数值取平均，得到一个配对平均贡献。仅使用基本事实：方差的定义 $\\operatorname{Var}(W) = \\mathbb{E}[W^2] - \\mathbb{E}[W]^2$、协方差的定义 $\\operatorname{Cov}(W_1,W_2) = \\mathbb{E}[W_1 W_2] - \\mathbb{E}[W_1]\\mathbb{E}[W_2]$，以及 $\\mathbb{E}[Z]$ 作为圆内面积比例的几何意义。\n\n哪个陈述正确地描述了指示函数相对于均匀输入的单调性何时能带来方差缩减，以及何时没有增益？\n\nA. 在 $S1$ 中，AV 配对平均的方差与平均两个独立指示函数的方差相同，因为 $\\operatorname{Cov}(Z, Z^{\\text{anti}}) = 0$。在 $S2$ 中，AV 配对平均也没有方差缩减，因为指示函数是对称的。\n\nB. 在 $S1$ 中，AV 配对平均不产生方差缩减，因为几乎必然有 $Z^{\\text{anti}} = Z$，所以 $\\operatorname{Cov}(Z, Z^{\\text{anti}}) = \\operatorname{Var}(Z)  0$。在 $S2$ 中，指示函数在 $[0,1]^2$ 上是坐标非增的，这意味着 $\\operatorname{Cov}(Z, Z^{\\text{anti}})  0$，因此 AV 配对平均的方差严格小于使用两个独立点的方差。\n\nC. 在 $S2$ 中，AV 配对平均增加了方差，因为 $\\operatorname{Cov}(Z, Z^{\\text{anti}})  0$；点 $(X,Y)$ 和 $(1-X,1-Y)$ 都倾向于位于原点附近，相互增强。在 $S1$ 中，AV 减少了方差，因为翻转符号使得指示函数在 $|X|$ 和 $|Y|$ 上是单调的。\n\nD. 只要指示函数是对称的，AV 就能在 $S1$ 和 $S2$ 中都减少方差，因为对称性保证了 $Z$ 和 $Z^{\\text{anti}}$ 之间的负相关性。", "solution": "特此确认问题陈述的有效性。该问题具有科学依据，提法恰当，客观且完整。所有术语均为计算科学和统计学领域的标准术语。\n\n对偶变量（AV）技术的核心原理是通过在估计量之间引入负相关性来减少方差。对于一个基于随机变量 $Z$ 的蒙特卡洛估计量，其中 $Z$ 是一组均匀随机变量 $U = (U_1, \\dots, U_d)$ 的函数，AV 方法生成一个对 $(Z, Z^{\\text{anti}})$。这里，$Z$ 是从一次随机抽取 $U$ 计算得出的，而 $Z^{\\text{anti}}$ 是从对偶抽取 $1-U = (1-U_1, \\dots, 1-U_d)$ 计算得出的。一个对的估计量是 $\\hat{\\theta}_{AV} = \\frac{Z + Z^{\\text{anti}}}{2}$。\n\n这个配对平均估计量的方差是：\n$$ \\operatorname{Var}(\\hat{\\theta}_{AV}) = \\operatorname{Var}\\left(\\frac{Z + Z^{\\text{anti}}}{2}\\right) = \\frac{1}{4}\\operatorname{Var}(Z + Z^{\\text{anti}}) $$\n使用和的方差公式：\n$$ \\operatorname{Var}(Z + Z^{\\text{anti}}) = \\operatorname{Var}(Z) + \\operatorname{Var}(Z^{\\text{anti}}) + 2\\operatorname{Cov}(Z, Z^{\\text{anti}}) $$\n由于 $U_i$ 和 $1-U_i$ 具有相同的分布（$\\text{Uniform}(0,1)$），$Z$ 和 $Z^{\\text{anti}}$ 是同分布的，这意味着 $\\operatorname{Var}(Z) = \\operatorname{Var}(Z^{\\text{anti}})$。因此，\n$$ \\operatorname{Var}(\\hat{\\theta}_{AV}) = \\frac{1}{4}(2\\operatorname{Var}(Z) + 2\\operatorname{Cov}(Z, Z^{\\text{anti}})) = \\frac{1}{2}(\\operatorname{Var}(Z) + \\operatorname{Cov}(Z, Z^{\\text{anti}})) $$\n作为比较，使用两个独立样本 $Z_1$ 和 $Z_2$ 的平均值的标准蒙特卡洛估计量是 $\\hat{\\theta}_{MC} = \\frac{Z_1 + Z_2}{2}$。其方差为：\n$$ \\operatorname{Var}(\\hat{\\theta}_{MC}) = \\operatorname{Var}\\left(\\frac{Z_1 + Z_2}{2}\\right) = \\frac{1}{4}(\\operatorname{Var}(Z_1) + \\operatorname{Var}(Z_2)) = \\frac{1}{2}\\operatorname{Var}(Z) $$\n如果 $\\operatorname{Var}(\\hat{\\theta}_{AV})  \\operatorname{Var}(\\hat{\\theta}_{MC})$，则实现了方差缩减，这可以简化为条件 $\\operatorname{Cov}(Z, Z^{\\text{anti}})  0$。如果 $\\operatorname{Cov}(Z, Z^{\\text{anti}}) = 0$，与独立抽样相比，方差没有增益或损失。如果 $\\operatorname{Cov}(Z, Z^{\\text{anti}})  0$，方差会增加。\n\n我们现在根据这个原理分析每种设置。\n\n**设置 S1 的分析**\n\n在此设置中，通过变换 $X = 2U_1 - 1$ 和 $Y = 2U_2 - 1$ 从 $[-1,1]^2$ 中均匀抽样点 $(X,Y)$，其中 $U_1, U_2 \\sim \\text{Uniform}(0,1)$ 相互独立。估计量为 $Z = \\mathbb{1}\\{X^2 + Y^2 \\le 1\\}$。\n\n对偶对是使用 $(1-U_1, 1-U_2)$ 形成的。相应的对偶点 $(X^{\\text{anti}}, Y^{\\text{anti}})$ 是：\n$$ X^{\\text{anti}} = 2(1 - U_1) - 1 = 2 - 2U_1 - 1 = 1 - 2U_1 = -(2U_1 - 1) = -X $$\n$$ Y^{\\text{anti}} = 2(1 - U_2) - 1 = 2 - 2U_2 - 1 = 1 - 2U_2 = -(2U_2 - 1) = -Y $$\n对偶点是 $(-X, -Y)$。在该点计算的指示函数是：\n$$ Z^{\\text{anti}} = \\mathbb{1}\\{(X^{\\text{anti}})^2 + (Y^{\\text{anti}})^2 \\le 1\\} = \\mathbb{1}\\{(-X)^2 + (-Y)^2 \\le 1\\} = \\mathbb{1}\\{X^2 + Y^2 \\le 1\\} $$\n因此，对于任何实现 $(U_1, U_2)$，我们都有 $Z^{\\text{anti}} = Z$。这几乎必然成立。\n\n$Z$ 和 $Z^{\\text{anti}}$ 之间的协方差是：\n$$ \\operatorname{Cov}(Z, Z^{\\text{anti}}) = \\operatorname{Cov}(Z, Z) = \\operatorname{Var}(Z) $$\n指示变量 $Z$ 是一个伯努利随机变量。其期望 $\\mathbb{E}[Z]$ 是一个点落入单位圆内的概率，即圆的面积（$\\pi r^2 = \\pi$）与正方形的面积（$2 \\times 2 = 4$）之比。所以，$p = \\mathbb{E}[Z] = \\pi/4$。\n伯努利变量的方差是 $\\operatorname{Var}(Z) = p(1-p) = \\frac{\\pi}{4}(1 - \\frac{\\pi}{4})$。由于 $0  \\pi  4$，我们有 $\\operatorname{Var}(Z) > 0$。\n因此，$\\operatorname{Cov}(Z, Z^{\\text{anti}}) = \\operatorname{Var}(Z) > 0$。根据我们的判据，这意味着对偶变量技术不仅未能减少方差，实际上与独立抽样相比还增加了方差。肯定没有方差缩减。\n\n**设置 S2 的分析**\n\n在此设置中，通过令 $X = U_1$ 和 $Y = U_2$ 从 $[0,1]^2$ 中均匀抽样点 $(X,Y)$，其中 $U_1, U_2 \\sim \\text{Uniform}(0,1)$ 相互独立。估计量为 $Z = \\mathbb{1}\\{X^2 + Y^2 \\le 1\\} = \\mathbb{1}\\{U_1^2 + U_2^2 \\le 1\\}$。\n\n让我们分析在定义域 $[0,1]^2$ 上的函数 $f(U_1, U_2) = Z = \\mathbb{1}\\{U_1^2 + U_2^2 \\le 1\\}$。表达式 $U_1^2 + U_2^2$ 在 $[0,1]^2$ 上是关于 $U_1$ 和 $U_2$ 的严格递增函数。指示函数 $\\mathbb{1}\\{g \\le c\\}$ 在其参数 $g$ 上是非增的。因此，复合函数 $f(U_1, U_2)$ 是关于 $U_1$ 和 $U_2$ 的坐标非增函数。\n\n对偶指示变量为 $Z^{\\text{anti}} = f(1-U_1, 1-U_2) = \\mathbb{1}\\{(1-U_1)^2 + (1-U_2)^2 \\le 1\\}$。\n方差缩减中的一个基本结果指出，如果一个函数 $f(u_1, \\dots, u_d)$ 是坐标单调的（即在所有变量上要么完全非增，要么完全非减），那么 $\\operatorname{Cov}(f(U), f(1-U)) \\le 0$。\n更具体地说，如果 $f$ 在其参数上是非增的，并且我们定义一个新函数 $g(U) = f(1-U)$，那么 $g$ 在 $U$ 的参数上是非减的。一个非增函数和一个非减函数之间的协方差是非正的。\n在我们的例子中，$Z$ 是一个关于 $(U_1, U_2)$ 的非平凡的、坐标非增的函数。因此，协方差是非正的：$\\operatorname{Cov}(Z, Z^{\\text{anti}}) \\le 0$。这个不等式是严格的，除非一个变量是另一个变量的确定性函数以至于抵消了相关性，而这里情况并非如此。\n例如，一个靠近 $(0,0)$ 的小值 $(U_1, U_2)$ 会使得 $Z=1$ 的可能性很大，而 $(1-U_1, 1-U_2)$ 则靠近 $(1,1)$，使得 $Z^{\\text{anti}}=0$ 的可能性很大。这种反向关系导致了严格为负的协方差，即 $\\operatorname{Cov}(Z, Z^{\\text{anti}})  0$。\n因此，在设置 S2 中，对偶变量技术产生了严格的方差缩减。\n\n**选项评估**\n\n*   **A. 在 $S1$ 中，AV 配对平均的方差与平均两个独立指示函数的方差相同，因为 $\\operatorname{Cov}(Z, Z^{\\text{anti}}) = 0$。在 $S2$ 中，AV 配对平均也没有方差缩减，因为指示函数是对称的。**\n    *   对 S1 的说法不正确。我们发现 $\\operatorname{Cov}(Z, Z^{\\text{anti}}) = \\operatorname{Var}(Z) > 0$，而不是 $0$。这导致方差增加，而不是方差相同。\n    *   对 S2 的说法不正确。我们发现了严格的方差缩减，即 $\\operatorname{Cov}(Z, Z^{\\text{anti}})  0$。\n    *   因此，选项 A 是**不正确**的。\n\n*   **B. 在 $S1$ 中，AV 配对平均不产生方差缩减，因为几乎必然有 $Z^{\\text{anti}} = Z$，所以 $\\operatorname{Cov}(Z, Z^{\\text{anti}}) = \\operatorname{Var}(Z)  0$。在 $S2$ 中，指示函数在 $[0,1]^2$ 上是坐标非增的，这意味着 $\\operatorname{Cov}(Z, Z^{\\text{anti}})  0$，因此 AV 配对平均的方差严格小于使用两个独立点的方差。**\n    *   对 S1 的分析完全正确。它正确地指出 $Z^{\\text{anti}} = Z$ 并得出协方差为正的结论，从而导致没有方差缩减。\n    *   对 S2 的分析也完全正确。它正确地指出了指示函数相对于输入均匀变量的坐标非增性质，这意味着负协方差，从而保证了方差缩减。\n    *   因此，选项 B 是**正确**的。\n\n*   **C. 在 $S2$ 中，AV 配对平均增加了方差，因为 $\\operatorname{Cov}(Z, Z^{\\text{anti}})  0$；点 $(X,Y)$ 和 $(1-X,1-Y)$ 都倾向于位于原点附近，相互增强。在 $S1$ 中，AV 减少了方差，因为翻转符号使得指示函数在 $|X|$ 和 $|Y|$ 上是单调的。**\n    *   对 S2 的说法不正确。协方差是负的，不是正的。其推理也有缺陷；如果 $(X,Y)$ 靠近原点 $(0,0)$，那么 $(1-X, 1-Y)$ 靠近 $(1,1)$，而不是原点。\n    *   对 S1 的说法不正确。AV 增加了方差，而不是减少它。所提供的推理含糊不清，并且在此上下文中数学上不成立。\n    *   因此，选项 C 是**不正确**的。\n\n*   **D. 只要指示函数是对称的，AV 就能在 $S1$ 和 $S2$ 中都减少方差，因为对称性保证了 $Z$ 和 $Z^{\\text{anti}}$ 之间的负相关性。**\n    *   关于 AV 在 S1 中减少方差的说法是错误的。我们证明了相反的情况。\n    *   “对称性保证负相关”的推理是一种错误的泛化。在 S1 中，问题的对称性导致 $Z = Z^{\\text{anti}}$，从而产生正相关。AV 的有效性取决于被估计的函数与由 $U \\to 1-U$ 引起的特定变换之间的相互作用，而不是一个模糊的对称性概念。\n    *   因此，选项 D 是**不正确**的。", "answer": "$$\\boxed{B}$$", "id": "3201688"}, {"introduction": "重要性采样是一种更为灵活和强大的方差缩减方法，它通过改变原始的抽样分布，将计算资源集中在对结果影响最大的“重要”区域。本练习将引导你为一项具体的估计任务推导出一个“最优”的提议分布，这个分布能最大程度地降低估计量的方差。通过这个过程，你将亲身体验如何通过巧妙的数学设计，将一个普通的蒙特卡洛估计器优化为一个理论上的零方差估计器，从而领会到高级模拟策略的威力。[@problem_id:2446710]", "problem": "考虑在与计算经济学和金融学相关的蒙特卡洛框架中，计算一个正态分布随机变量的指数的期望。设 $X \\sim \\mathcal{N}(0, 100)$，并定义 $h(x) = \\exp(x)$。你需要使用重要性采样来估计量 $\\mathbb{E}[\\exp(X)]$，其提议分布 $Q$ 由 $Y \\sim \\mathcal{N}(\\mu, 100)$ 给出，其中 $\\mu \\in \\mathbb{R}$ 是一个未知的平移参数。令 $p(x)$ 和 $q_{\\mu}(x)$ 分别表示 $\\mathcal{N}(0, 100)$ 和 $\\mathcal{N}(\\mu, 100)$ 的概率密度函数。基于从 $q_{\\mu}$ 中抽取的 $n$ 个独立同分布样本 $\\{Y_i\\}_{i=1}^{n}$，重要性采样估计量为\n$$\nI_n(\\mu) \\;=\\; \\frac{1}{n}\\sum_{i=1}^{n} h(Y_i)\\, w_{\\mu}(Y_i), \\quad \\text{其中 } w_{\\mu}(y) \\;=\\; \\frac{p(y)}{q_{\\mu}(y)}.\n$$\n从第一性原理出发，不借助任何特定的方差缩减公式，完成以下任务：\n1. 推导 $\\mathbb{E}[\\exp(X)]$ 的闭式表达式。\n2. 推导 $\\operatorname{Var}_{q_{\\mu}}(h(Y)\\,w_{\\mu}(Y))$ 作为 $\\mu$ 的函数，并找出在 $\\mu \\in \\mathbb{R}$ 上最小化该方差的值 $\\mu^{\\star}$。\n\n请以一个有序对的形式给出你的最终答案，该有序对包含 $\\mathbb{E}[\\exp(X)]$ 的精确值和最优平移 $\\mu^{\\star}$。不需要数值取整，你的答案应为精确值且不带单位。", "solution": "我们首先回顾一下定义。目标分布是 $X \\sim \\mathcal{N}(0, 100)$，其密度为\n$$\np(x) \\;=\\; \\frac{1}{\\sqrt{2\\pi}\\, \\sigma}\\,\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right), \\quad \\sigma^{2} = 100,\n$$\n提议分布是 $Y \\sim \\mathcal{N}(\\mu, 100)$，其密度为\n$$\nq_{\\mu}(x) \\;=\\; \\frac{1}{\\sqrt{2\\pi}\\, \\sigma}\\,\\exp\\!\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right), \\quad \\sigma^{2} = 100.\n$$\n重要性权重为 $w_{\\mu}(x) = p(x)/q_{\\mu}(x)$。\n\n步骤 1：计算 $\\mathbb{E}[\\exp(X)]$ 的闭式解。根据定义，\n$$\n\\mathbb{E}[\\exp(X)] \\;=\\; \\int_{-\\infty}^{\\infty} \\exp(x)\\, p(x)\\, dx \\;=\\; \\frac{1}{\\sqrt{2\\pi}\\, \\sigma} \\int_{-\\infty}^{\\infty} \\exp\\!\\left(x - \\frac{x^{2}}{2\\sigma^{2}}\\right) dx.\n$$\n对指数部分进行配方。写出\n$$\nx - \\frac{x^{2}}{2\\sigma^{2}} \\;=\\; -\\frac{1}{2\\sigma^{2}}\\left(x^{2} - 2\\sigma^{2} x \\right) \\;=\\; -\\frac{1}{2\\sigma^{2}}\\left[(x - \\sigma^{2})^{2} - \\sigma^{4}\\right] \\;=\\; -\\frac{(x - \\sigma^{2})^{2}}{2\\sigma^{2}} + \\frac{\\sigma^{2}}{2}.\n$$\n因此，\n$$\n\\mathbb{E}[\\exp(X)] \\;=\\; \\frac{1}{\\sqrt{2\\pi}\\, \\sigma} \\exp\\!\\left(\\frac{\\sigma^{2}}{2}\\right) \\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{(x - \\sigma^{2})^{2}}{2\\sigma^{2}}\\right) dx \\;=\\; \\exp\\!\\left(\\frac{\\sigma^{2}}{2}\\right),\n$$\n因为该积分等于 $\\sqrt{2\\pi}\\, \\sigma$。当 $\\sigma^{2} = 100$ 时，我们得到\n$$\n\\mathbb{E}[\\exp(X)] \\;=\\; \\exp(50).\n$$\n\n步骤 2：推导 $\\operatorname{Var}_{q_{\\mu}}(h(Y)\\, w_{\\mu}(Y))$ 并对其关于 $\\mu$ 进行最小化。注意到\n$$\n\\operatorname{Var}_{q_{\\mu}}(h(Y)\\, w_{\\mu}(Y)) \\;=\\; \\mathbb{E}_{q_{\\mu}}\\!\\left[h(Y)^{2}\\, w_{\\mu}(Y)^{2}\\right] \\;-\\; \\left(\\mathbb{E}[\\exp(X)]\\right)^{2}.\n$$\n第二项不依赖于 $\\mu$，因此最小化关于 $\\mu$ 的方差等价于最小化二阶矩\n$$\nM(\\mu) \\;=\\; \\mathbb{E}_{q_{\\mu}}\\!\\left[h(Y)^{2}\\, w_{\\mu}(Y)^{2}\\right] \\;=\\; \\int_{-\\infty}^{\\infty} \\exp(2x)\\, \\frac{p(x)^{2}}{q_{\\mu}(x)}\\, dx.\n$$\n使用具有共同方差 $\\sigma^{2}$ 的 $p$ 和 $q_{\\mu}$ 的显式形式，\n$$\n\\frac{p(x)^{2}}{q_{\\mu}(x)} \\;=\\; \\frac{\\left(\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right)\\right)^{2}}{\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right)} \\;=\\; \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{x^{2}}{\\sigma^{2}} + \\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n因此，\n$$\nM(\\mu) \\;=\\; \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\int_{-\\infty}^{\\infty} \\exp\\!\\left(2x - \\frac{x^{2}}{\\sigma^{2}} + \\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right) dx.\n$$\n合并指数项：\n$$\n2x - \\frac{x^{2}}{\\sigma^{2}} + \\frac{(x-\\mu)^{2}}{2\\sigma^{2}} \\;=\\; -\\frac{x^{2}}{2\\sigma^{2}} + \\left(2 - \\frac{\\mu}{\\sigma^{2}}\\right) x + \\frac{\\mu^{2}}{2\\sigma^{2}}.\n$$\n通过定义以下项来配方\n$$\nm \\;=\\; 2\\sigma^{2} - \\mu,\n$$\n这样\n$$\n-\\frac{x^{2}}{2\\sigma^{2}} + \\left(2 - \\frac{\\mu}{\\sigma^{2}}\\right) x \\;=\\; -\\frac{(x - m)^{2}}{2\\sigma^{2}} + \\frac{m^{2}}{2\\sigma^{2}}.\n$$\n因此，\n$$\nM(\\mu) \\;=\\; \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\!\\left(\\frac{m^{2}}{2\\sigma^{2}} + \\frac{\\mu^{2}}{2\\sigma^{2}}\\right) \\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{(x - m)^{2}}{2\\sigma^{2}}\\right) dx \\;=\\; \\exp\\!\\left(\\frac{m^{2} + \\mu^{2}}{2\\sigma^{2}}\\right).\n$$\n代入 $m = 2\\sigma^{2} - \\mu$，\n$$\nm^{2} + \\mu^{2} \\;=\\; (2\\sigma^{2} - \\mu)^{2} + \\mu^{2} \\;=\\; 4\\sigma^{4} - 4\\mu \\sigma^{2} + 2\\mu^{2},\n$$\n因此\n$$\nM(\\mu) \\;=\\; \\exp\\!\\left(\\frac{4\\sigma^{4} - 4\\mu \\sigma^{2} + 2\\mu^{2}}{2\\sigma^{2}}\\right) \\;=\\; \\exp\\!\\left(2\\sigma^{2} - 2\\mu + \\frac{\\mu^{2}}{\\sigma^{2}}\\right).\n$$\n作为 $\\mu$ 的函数，最小化 $M(\\mu)$ 等价于最小化指数\n$$\ng(\\mu) \\;=\\; \\frac{\\mu^{2}}{\\sigma^{2}} - 2\\mu + 2\\sigma^{2}.\n$$\n这是一个关于 $\\mu$ 的凸二次函数，其导数为\n$$\ng'(\\mu) \\;=\\; \\frac{2\\mu}{\\sigma^{2}} - 2,\n$$\n该导数在以下点为零\n$$\n\\mu^{\\star} \\;=\\; \\sigma^{2}.\n$$\n因为 $g''(\\mu) = 2/\\sigma^{2}  0$，所以这个临界点是唯一的最小值点。当 $\\sigma^{2} = 100$ 时，最优平移是\n$$\n\\mu^{\\star} \\;=\\; 100.\n$$\n在 $\\mu^{\\star} = \\sigma^{2}$ 时，提议密度 $q_{\\mu^{\\star}}$ 与 $h(x)\\, p(x)$ 成正比，这会产生一个零方差的重要性采样估计量，与以下结果一致\n$$\n\\operatorname{Var}_{q_{\\mu^{\\star}}}(h(Y)\\,w_{\\mu^{\\star}}(Y)) \\;=\\; M(\\mu^{\\star}) - \\left(\\mathbb{E}[\\exp(X)]\\right)^{2} \\;=\\; \\exp(\\sigma^{2}) - \\exp(\\sigma^{2}) \\;=\\; 0.\n$$\n综合以上结果，精确期望为 $\\exp(50)$，最优平移为 $\\mu^{\\star} = 100$。", "answer": "$$\\boxed{\\begin{pmatrix}\\exp(50)  100\\end{pmatrix}}$$", "id": "2446710"}]}