{"hands_on_practices": [{"introduction": "蒙特卡洛积分的核心思想是通过在积分域内随机抽样，并计算函数值的平均来近似积分值。本练习 [@problem_id:1376816] 提供了一个直接应用此基本原理的场景，即估算一个三维空间中非均匀分布物质的总质量。通过这个具体案例，你将实践如何为多重积分建立蒙特卡洛估算，并处理具有复杂边界的积分区域。", "problem": "一位材料科学家正在研究一种在边长为1米的立方体模具中制造的新合金。坐标系与模具对齐，因此它占据了由 $0 \\le x \\le 1$、$0 \\le y \\le 1$ 和 $0 \\le z \\le 1$ 定义的区域。一种特殊硬化剂的浓度 $C$ 被发现在模具中仅在一个由不等式 $0 \\le z \\le y \\le x \\le 1$ 定义的特定子区域内非零。在这个子区域内，点 $(x,y,z)$ 处的浓度由函数 $C(x,y,z) = k x y z$ 描述，其中 $k$ 是一个常数。在该区域之外，浓度为零。模具中该硬化剂的总质量由浓度函数在整个1立方米模具体积上的积分给出。\n\n为了估计这个总质量，一个自动化测量系统在一组 $N=5$ 个样本点上探测浓度，这些点被假定为单位立方体内均匀随机抽样的代表。这五个点的坐标是：\n$P_1 = (0.8, 0.7, 0.2)$\n$P_2 = (0.9, 0.5, 0.6)$\n$P_3 = (0.6, 0.8, 0.3)$\n$P_4 = (0.5, 0.4, 0.3)$\n$P_5 = (0.7, 0.9, 0.8)$\n\n给定浓度常数 $k = 4.8 \\text{ kg/m}^6$，根据这五个样本点的数据，计算模具中硬化剂总质量的数值估计。答案以千克（kg）为单位表示，并四舍五入到三位有效数字。", "solution": "总质量是浓度在单位立方体上的体积积分：\n$$\nM=\\iiint_{[0,1]^{3}} C(x,y,z)\\,dV.\n$$\n在体积为 $V=1$ 的区域上进行均匀随机抽样，具有 $N$ 个样本 $\\{P_{i}\\}_{i=1}^{N}$ 的蒙特卡洛估计量为\n$$\n\\widehat{M}=\\frac{V}{N}\\sum_{i=1}^{N} C(P_{i})=\\frac{1}{N}\\sum_{i=1}^{N} C(P_{i}).\n$$\n这里，如果 $0 \\le z \\le y \\le x \\le 1$，则 $C(x,y,z)=k\\,x y z$，否则 $C=0$。对每个样本评估指示条件 $0 \\le z \\le y \\le x \\le 1$：\n- $P_{1}=(0.8,0.7,0.2)$: $0.2 \\le 0.7 \\le 0.8 \\le 1$ 为真，因此贡献 $k\\cdot 0.8\\cdot 0.7\\cdot 0.2=0.112\\,k$。\n- $P_{2}=(0.9,0.5,0.6)$: $0.6 \\le 0.5$ 为假，贡献为 $0$。\n- $P_{3}=(0.6,0.8,0.3)$: $0.8 \\le 0.6$ 为假，贡献为 $0$。\n- $P_{4}=(0.5,0.4,0.3)$: $0.3 \\le 0.4 \\le 0.5 \\le 1$ 为真，贡献 $k\\cdot 0.5\\cdot 0.4\\cdot 0.3=0.06\\,k$。\n- $P_{5}=(0.7,0.9,0.8)$: $0.9 \\le 0.7$ 为假，贡献为 $0$。\n因此\n$$\n\\sum_{i=1}^{5} C(P_{i})=(0.112+0.06)\\,k=0.172\\,k,\n$$\n且\n$$\n\\widehat{M}=\\frac{1}{5}\\cdot 0.172\\,k=0.0344\\,k.\n$$\n代入 $k=4.8$ 得\n$$\n\\widehat{M}=0.0344\\times 4.8=0.16512,\n$$\n四舍五入到三位有效数字，结果为 $0.165$ 千克。", "answer": "$$\\boxed{0.165}$$", "id": "1376816"}, {"introduction": "原始的蒙特卡洛积分虽然强大，但其收敛速度可能较慢，尤其是在样本量有限时。为了提高估计的效率，我们引入方差缩减技术，它们能在不增加计算成本的情况下显著提升精度。本练习 [@problem_id:3253427] 要求你从理论上比较两种核心的方差缩减方法——对偶变量法和控制变量法——在估算同一个积分时的表现。通过推导和比较它们的方差，你将深刻理解这些技术的工作原理，并学会如何在实践中做出更优的选择。", "problem": "考虑积分 $I=\\int_{0}^{1} e^{x}\\,dx$。你将使用蒙特卡罗（MC）积分来近似 $I$，样本 $U\\sim \\mathrm{Uniform}(0,1)$，使得 $f(U)=e^{U}$ 且 $\\mathbb{E}[f(U)]=I$。为了在 $f(x)$ 的 $2n$ 次求值的固定计算预算下进行公平比较，请考虑以下三种蒙特卡罗估计量：\n\n- 原始蒙特卡罗（Crude MC）：使用 $2n$ 个独立样本 $U_{1},\\dots,U_{2n}$ 以及 $f(U_{i})$ 的样本均值。\n- 对偶变量（Antithetic variates）：使用 $n$ 次独立抽样 $U_{1},\\dots,U_{n}$，构造 $A_{i}=\\tfrac{1}{2}\\big(f(U_{i})+f(1-U_{i})\\big)$，并对 $A_{i}$ 求平均值。\n- 控制变量（Control variates）：取 $g(x)=x$，其已知均值为 $\\int_{0}^{1} x\\,dx=\\tfrac{1}{2}$。使用 $2n$ 个独立样本 $U_{1},\\dots,U_{2n}$，构造具有最优选择系数 $\\beta$ 的控制变量估计量（不要假设 $\\beta$ 的公式；从第一性原理推导它）。\n\n仅使用期望、方差、协方差和独立性的定义（以及必要积分的基本微积分），推导这三个估计量关于 $n$ 的精确方差，然后在 $f$ 的 $2n$ 次求值的相等成本预算下，比较对偶变量与最优控制变量。下面哪个选项正确描述了在相同成本下，它们相对于原始蒙特卡罗的方差减少情况？\n\nA. 在相同成本下，对偶变量相对于原始蒙特卡罗实现的方差比为 $R_{\\mathrm{AV}}\\approx 0.0323$，而使用 $g(x)=x$ 的最优控制变量实现的方差比为 $R_{\\mathrm{CV}}\\approx 0.0163$；因此控制变量能更多地减少方差。\n\nB. 在相同成本下，对偶变量实现的方差比为 $R_{\\mathrm{AV}}\\approx 0.0163$，而使用 $g(x)=x$ 的最优控制变量实现的方差比为 $R_{\\mathrm{CV}}\\approx 0.0323$；因此对偶变量能更多地减少方差。\n\nC. 在相同成本下，对偶变量和控制变量产生的方差减少完全相同，为 $R_{\\mathrm{AV}}=R_{\\mathrm{CV}}\\approx 0.0240$。\n\nD. 在相同成本下，两种方法相对于原始蒙特卡罗都不能减少方差，即 $R_{\\mathrm{AV}}\\geq 1$ 且 $R_{\\mathrm{CV}}\\geq 1$。", "solution": "问题是比较对偶变量和控制变量在蒙特卡罗近似积分 $I=\\int_{0}^{1} e^{x}\\,dx$ 时的方差减少效果。比较必须在函数 $f(x)=e^x$ 的 $2n$ 次求值的相等计算预算下进行。设 $U$ 是一个服从 $\\mathrm{Uniform}(0,1)$ 分布的随机变量。\n\n首先，我们计算必要的矩和协方差。\n积分的真实值为 $I = \\mathbb{E}[f(U)] = \\int_{0}^{1} e^x \\,dx = [e^x]_0^1 = e^1 - e^0 = e - 1$。\n\n$f(U) = e^U$ 的方差需要二阶矩：\n$\\mathbb{E}[f(U)^2] = \\mathbb{E}[e^{2U}] = \\int_{0}^{1} e^{2x} \\,dx = \\left[\\frac{1}{2} e^{2x}\\right]_0^1 = \\frac{1}{2}(e^2 - 1)$。\n$f(U)$ 的方差记为 $\\sigma_f^2$：\n$\\sigma_f^2 = \\mathrm{Var}(f(U)) = \\mathbb{E}[f(U)^2] - (\\mathbb{E}[f(U)])^2 = \\frac{1}{2}(e^2 - 1) - (e - 1)^2$\n$\\sigma_f^2 = \\frac{1}{2}e^2 - \\frac{1}{2} - (e^2 - 2e + 1) = -\\frac{1}{2}e^2 + 2e - \\frac{3}{2}$。\n\n对于控制变量估计量，我们使用 $g(x)=x$。\n$g(U)=U$ 的均值为 $\\mu_g = \\mathbb{E}[U] = \\int_{0}^{1} x \\,dx = \\frac{1}{2}$。\n$g(U)$ 的方差（记为 $\\sigma_g^2$）需要 $\\mathbb{E}[U^2] = \\int_{0}^{1} x^2 \\,dx = \\frac{1}{3}$。\n$\\sigma_g^2 = \\mathrm{Var}(U) = \\mathbb{E}[U^2] - (\\mathbb{E}[U])^2 = \\frac{1}{3} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{3} - \\frac{1}{4} = \\frac{1}{12}$。\n\n$f(U)$ 和 $g(U)$ 之间的协方差为 $\\sigma_{fg} = \\mathrm{Cov}(f(U), g(U)) = \\mathbb{E}[f(U)g(U)] - \\mathbb{E}[f(U)]\\mathbb{E}[g(U)]$。\n$\\mathbb{E}[f(U)g(U)] = \\mathbb{E}[Ue^U] = \\int_{0}^{1} xe^x \\,dx$。\n使用分部积分法（$\\int u dv = uv - \\int v du$，其中 $u=x, dv=e^x dx$）：\n$\\int_{0}^{1} xe^x \\,dx = [xe^x]_0^1 - \\int_{0}^{1} e^x \\,dx = (1 \\cdot e^1 - 0) - [e^x]_0^1 = e - (e-1) = 1$。\n所以，$\\sigma_{fg} = 1 - (e-1)\\left(\\frac{1}{2}\\right) = 1 - \\frac{e}{2} + \\frac{1}{2} = \\frac{3-e}{2}$。\n\n现在我们分析这三种估计量。\n\n1.  **原始蒙特卡罗估计量**\n    该估计量使用 $2n$ 个样本：$\\hat{I}_{\\mathrm{Crude}} = \\frac{1}{2n} \\sum_{i=1}^{2n} e^{U_i}$。\n    由于样本 $U_i$ 是独立同分布的（i.i.d.），其方差为：\n    $\\mathrm{Var}(\\hat{I}_{\\mathrm{Crude}}) = \\frac{1}{(2n)^2} \\sum_{i=1}^{2n} \\mathrm{Var}(e^{U_i}) = \\frac{2n}{(2n)^2} \\sigma_f^2 = \\frac{1}{2n} \\sigma_f^2$。\n    $\\mathrm{Var}(\\hat{I}_{\\mathrm{Crude}}) = \\frac{1}{2n} \\left(-\\frac{1}{2}e^2 + 2e - \\frac{3}{2}\\right)$。这是我们的基准方差。\n\n2.  **对偶变量（AV）估计量**\n    该估计量使用 $n$ 对样本 $(U_i, 1-U_i)$。总成本是 $f(x)$ 的 $2n$ 次求值。\n    $\\hat{I}_{\\mathrm{AV}} = \\frac{1}{n} \\sum_{i=1}^{n} A_i$，其中 $A_i = \\frac{1}{2}(e^{U_i} + e^{1-U_i})$。\n    由于 $U_i$ 是独立同分布的，项 $A_i$ 也是独立同分布的。其方差为：\n    $\\mathrm{Var}(\\hat{I}_{\\mathrm{AV}}) = \\frac{1}{n} \\mathrm{Var}(A_1) = \\frac{1}{n} \\mathrm{Var}\\left(\\frac{1}{2}(e^U + e^{1-U})\\right) = \\frac{1}{4n} \\mathrm{Var}(e^U + e^{1-U})$。\n    $\\mathrm{Var}(e^U + e^{1-U}) = \\mathrm{Var}(e^U) + \\mathrm{Var}(e^{1-U}) + 2\\mathrm{Cov}(e^U, e^{1-U})$。\n    由于 $1-U \\sim \\mathrm{Uniform}(0,1)$，$\\mathrm{Var}(e^{1-U}) = \\mathrm{Var}(e^U) = \\sigma_f^2$。\n    协方差为 $\\mathrm{Cov}(e^U, e^{1-U}) = \\mathbb{E}[e^U e^{1-U}] - \\mathbb{E}[e^U]\\mathbb{E}[e^{1-U}]$。\n    $\\mathbb{E}[e^U e^{1-U}] = \\mathbb{E}[e^{U+1-U}] = \\mathbb{E}[e] = e$。\n    $\\mathbb{E}[e^{1-U}] = \\mathbb{E}[e^U] = e-1$。\n    $\\mathrm{Cov}(e^U, e^{1-U}) = e - (e-1)^2 = e - (e^2-2e+1) = -e^2+3e-1$。\n    $\\mathrm{Var}(\\hat{I}_{\\mathrm{AV}}) = \\frac{1}{4n} (2\\sigma_f^2 + 2\\mathrm{Cov}(e^U, e^{1-U})) = \\frac{1}{2n}(\\sigma_f^2 + \\mathrm{Cov}(e^U, e^{1-U}))$。\n    代入 $\\sigma_f^2$ 和协方差的表达式：\n    $\\mathrm{Var}(\\hat{I}_{\\mathrm{AV}}) = \\frac{1}{2n} \\left( \\left(-\\frac{1}{2}e^2 + 2e - \\frac{3}{2}\\right) + (-e^2+3e-1) \\right) = \\frac{1}{2n} \\left(-\\frac{3}{2}e^2 + 5e - \\frac{5}{2}\\right)$。\n\n    方差比 $R_{\\mathrm{AV}}$ 为：\n    $R_{\\mathrm{AV}} = \\frac{\\mathrm{Var}(\\hat{I}_{\\mathrm{AV}})}{\\mathrm{Var}(\\hat{I}_{\\mathrm{Crude}})} = \\frac{\\frac{1}{2n} (-\\frac{3}{2}e^2 + 5e - \\frac{5}{2})}{\\frac{1}{2n} (-\\frac{1}{2}e^2 + 2e - \\frac{3}{2})} = \\frac{-3e^2+10e-5}{-e^2+4e-3}$。\n    使用 $e \\approx 2.71828$：\n    $R_{\\mathrm{AV}} \\approx \\frac{-3(7.389056) + 10(2.71828) - 5}{-7.389056 + 4(2.71828) - 3} = \\frac{0.015632}{0.484064} \\approx 0.03229$。因此，$R_{\\mathrm{AV}} \\approx 0.0323$。\n\n3.  **控制变量（CV）估计量**\n    该估计量使用 $2n$ 个样本：$\\hat{I}_{\\mathrm{CV}}(\\beta) = \\frac{1}{2n}\\sum_{i=1}^{2n} (f(U_i) - \\beta(g(U_i) - \\mu_g))$。\n    通过最小化单项的方差来找到最优的 $\\beta$。\n    $\\mathrm{Var}(f(U) - \\beta(g(U)-\\mu_g)) = \\mathrm{Var}(f(U) - \\beta g(U)) = \\mathrm{Var}(f(U)) - 2\\beta\\mathrm{Cov}(f(U), g(U)) + \\beta^2\\mathrm{Var}(g(U))$。\n    即 $\\sigma_f^2 - 2\\beta\\sigma_{fg} + \\beta^2\\sigma_g^2$。为了找到最小值，我们对 $\\beta$ 求导并令其为 0：\n    $-2\\sigma_{fg} + 2\\beta\\sigma_g^2 = 0 \\implies \\beta^* = \\frac{\\sigma_{fg}}{\\sigma_g^2}$。\n    最小方差为 $\\sigma_f^2 - 2\\frac{\\sigma_{fg}}{\\sigma_g^2}\\sigma_{fg} + (\\frac{\\sigma_{fg}}{\\sigma_g^2})^2\\sigma_g^2 = \\sigma_f^2 - \\frac{\\sigma_{fg}^2}{\\sigma_g^2}$。\n    估计量的方差为 $\\mathrm{Var}(\\hat{I}_{\\mathrm{CV}}) = \\frac{1}{2n} \\left( \\sigma_f^2 - \\frac{\\sigma_{fg}^2}{\\sigma_g^2} \\right)$。\n    代入表达式：\n    $\\frac{\\sigma_{fg}^2}{\\sigma_g^2} = \\frac{((3-e)/2)^2}{1/12} = 12 \\frac{(3-e)^2}{4} = 3(9-6e+e^2) = 27-18e+3e^2$。\n    $\\mathrm{Var}(\\hat{I}_{\\mathrm{CV}}) = \\frac{1}{2n} \\left( (-\\frac{1}{2}e^2 + 2e - \\frac{3}{2}) - (27-18e+3e^2) \\right)$\n    $\\mathrm{Var}(\\hat{I}_{\\mathrm{CV}}) = \\frac{1}{2n} \\left(-\\frac{7}{2}e^2 + 20e - \\frac{57}{2}\\right)$。\n\n    方差比 $R_{\\mathrm{CV}}$ 为：\n    $R_{\\mathrm{CV}} = \\frac{\\mathrm{Var}(\\hat{I}_{\\mathrm{CV}})}{\\mathrm{Var}(\\hat{I}_{\\mathrm{Crude}})} = \\frac{\\sigma_f^2 - \\sigma_{fg}^2/\\sigma_g^2}{\\sigma_f^2} = \\frac{-\\frac{7}{2}e^2+20e-\\frac{57}{2}}{-\\frac{1}{2}e^2+2e-\\frac{3}{2}} = \\frac{-7e^2+40e-57}{-e^2+4e-3}$。\n    使用 $e \\approx 2.71828$：\n    $R_{\\mathrm{CV}} \\approx \\frac{-7(7.389056) + 40(2.71828) - 57}{0.484064} = \\frac{0.007888}{0.484064} \\approx 0.016295$。因此，$R_{\\mathrm{CV}} \\approx 0.0163$。\n\n比较与选项评估：\n我们已经推导出 $R_{\\mathrm{AV}} \\approx 0.0323$ 和 $R_{\\mathrm{CV}} \\approx 0.0163$。\n更小的方差比表示更大的方差减少。由于 $0.0163  0.0323$，控制变量法对于此问题更有效。\n\nA. 在相同成本下，对偶变量相对于原始蒙特卡罗实现的方差比为 $R_{\\mathrm{AV}}\\approx 0.0323$，而使用 $g(x)=x$ 的最优控制变量实现的方差比为 $R_{\\mathrm{CV}}\\approx 0.0163$；因此控制变量能更多地减少方差。\n该选项与我们推导出的值和结论相符。**正确**。\n\nB. 在相同成本下，对偶变量实现的方差比为 $R_{\\mathrm{AV}}\\approx 0.0163$，而使用 $g(x)=x$ 的最优控制变量实现的方差比为 $R_{\\mathrm{CV}}\\approx 0.0323$；因此对偶变量能更多地减少方差。\n该选项颠倒了两种方法的数值。**不正确**。\n\nC. 在相同成本下，对偶变量和控制变量产生的方差减少完全相同，为 $R_{\\mathrm{AV}}=R_{\\mathrm{CV}}\\approx 0.0240$。\n我们的计算表明方差比不相等。**不正确**。\n\nD. 在相同成本下，两种方法相对于原始蒙特卡罗都不能减少方差，即 $R_{\\mathrm{AV}}\\geq 1$ 且 $R_{\\mathrm{CV}}\\geq 1$。\n计算出的两个比率都显著小于 1，表明方差有显著减少。对于对偶变量，由于 $f(x)=e^x$ 是单调的，导致负相关，因此方差减少。对于控制变量，由于 $f(x)=e^x$ 和 $g(x)=x$ 是正相关的，因此方差减少。**不正确**。", "answer": "$$\\boxed{A}$$", "id": "3253427"}, {"introduction": "对于某些极端问题，例如估计罕见事件的发生概率，标准的蒙特卡洛方法几乎束手无策。重要性抽样是一种强大的高级技术，它通过从一个经过精心设计的“提议分布”中抽样，然后对样本进行加权，从而巧妙地解决了这个问题。本练习 [@problem_id:1376872] 将带你进入计算科学的前沿，解决一个真实的罕见事件估计问题。你将学习如何设计有效的提议分布，并利用重要性权重来估算一个极小的概率，从而体会到高级蒙特卡洛方法在处理棘手问题上的巨大威力。", "problem": "在许多领域，例如通信系统建模或风险分析中，有必要估计稀有事件的概率。考虑一个系统，其状态由一个包含10个独立同分布随机变量的向量 $Z = (Z_1, Z_2, \\dots, Z_{10})$ 描述，每个随机变量 $Z_i$ 都服从标准正态分布，$Z_i \\sim \\mathcal{N}(0,1)$。如果该状态向量的L2范数平方 $\\|Z\\|^2 = \\sum_{i=1}^{10} Z_i^2$ 超过临界阈值 $c=60$，则定义为发生故障事件。该事件的概率 $P = P(\\|Z\\|^2  60)$ 极小，难以使用标准的蒙特卡洛方法进行估计。\n\n为了获得更有效的估计，我们将采用重要性采样。我们将从一个提议分布 $q(x)$ 中抽取样本 $X = (X_1, X_2, \\dots, X_{10})$，而不是从原始分布 $p(z)$ 中抽取。所选的提议分布是一个多元正态分布，其分量是独立同分布的，$X_i \\sim \\mathcal{N}(0, \\sigma^2)$，其方差 $\\sigma^2$ 待定。\n\n你的任务是计算概率 $P$ 的重要性采样估计值。首先，确定提议分布的方差 $\\sigma^2$ 的合适值。对此选择，一个常用且有效的启发式方法是，将感兴趣的量（在此例中为 $\\|X\\|^2$）在提议分布下的期望值设置为等于阈值 $c$。\n\n在确定 $\\sigma^2$ 后，使用一个预先计算好的模拟结果。在一个数值实验中，使用你确定的 $\\sigma^2$ 值，从提议分布 $q(x)$ 中总共抽取了 $N = 5.0 \\times 10^5$ 个样本。对于这组样本，计算了重要性权重的总和，但仅限于那些满足稀有事件条件 $\\|X\\|^2  60$ 的样本，结果为 0.617。\n\n根据这些信息，计算概率 $P$ 的数值估计。用科学记数法表示你的最终答案，并四舍五入到三位有效数字。", "solution": "问题要求对概率 $P = P(\\sum_{i=1}^{10} Z_i^2  60)$ 进行基于重要性采样的估计，其中 $Z_i \\sim \\mathcal{N}(0,1)$ 是独立随机变量。\n\n这个概率可以写成一个期望：\n$$P = E_p\\left[\\mathbb{I}\\left(\\sum_{i=1}^{10} Z_i^2  60\\right)\\right]$$\n其中 $\\mathbb{I}(\\cdot)$ 是指示函数，$E_p[\\cdot]$ 表示关于原始概率分布 $p(z) = \\prod_{i=1}^{10} \\frac{1}{\\sqrt{2\\pi}} \\exp(-z_i^2/2)$ 的期望。\n\n在重要性采样中，我们将这个期望改写为关于一个提议分布 $q(x)$ 的期望：\n$$P = E_q\\left[\\mathbb{I}\\left(\\sum_{i=1}^{10} X_i^2  60\\right) \\frac{p(X)}{q(X)}\\right]$$\n其中 $X \\sim q(x)$。项 $w(X) = p(X)/q(X)$ 是重要性权重。使用从 $q(x)$ 中抽取的 $N$ 个样本 $\\{X^{(j)}\\}_{j=1}^N$ 对 $P$ 进行的蒙特卡洛估计由下式给出：\n$$\\hat{P}_N = \\frac{1}{N} \\sum_{j=1}^N \\mathbb{I}\\left(\\|X^{(j)}\\|^2  60\\right) w(X^{(j)})$$\n\n第一步是确定提议分布 $q(x) = \\prod_{i=1}^{10} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp(-x_i^2/(2\\sigma^2))$ 的方差 $\\sigma^2$。问题陈述的启发式方法是设置 $E_q[\\|X\\|^2] = 60$。\n\n对于单个分量 $X_i \\sim \\mathcal{N}(0, \\sigma^2)$，其期望是 $E_q[X_i] = 0$，其方差是 $\\text{Var}_q(X_i) = \\sigma^2$。其平方的期望是 $E_q[X_i^2] = \\text{Var}_q(X_i) + (E_q[X_i])^2 = \\sigma^2 + 0^2 = \\sigma^2$。\n\n根据期望的线性性质，平方和的期望是：\n$$E_q[\\|X\\|^2] = E_q\\left[\\sum_{i=1}^{10} X_i^2\\right] = \\sum_{i=1}^{10} E_q[X_i^2] = 10 \\sigma^2$$\n应用这个启发式方法，我们将其设置为等于阈值 $c=60$：\n$$10 \\sigma^2 = 60 \\implies \\sigma^2 = 6$$\n\n第二步是找到重要性权重函数 $w(x) = p(x)/q(x)$ 的表达式。\n$$p(x) = \\prod_{i=1}^{10} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x_i^2}{2}\\right) = (2\\pi)^{-5} \\exp\\left(-\\frac{1}{2}\\sum_{i=1}^{10} x_i^2\\right) = (2\\pi)^{-5} \\exp\\left(-\\frac{\\|x\\|^2}{2}\\right)$$\n$$q(x) = \\prod_{i=1}^{10} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{x_i^2}{2\\sigma^2}\\right) = (2\\pi\\sigma^2)^{-5} \\exp\\left(-\\frac{1}{2\\sigma^2}\\sum_{i=1}^{10} x_i^2\\right) = (2\\pi\\sigma^2)^{-5} \\exp\\left(-\\frac{\\|x\\|^2}{2\\sigma^2}\\right)$$\n\n比值为：\n$$w(x) = \\frac{p(x)}{q(x)} = \\frac{(2\\pi)^{-5}}{(2\\pi\\sigma^2)^{-5}} \\frac{\\exp(-\\|x\\|^2/2)}{\\exp(-\\|x\\|^2/(2\\sigma^2))} = (\\sigma^2)^5 \\exp\\left(-\\frac{\\|x\\|^2}{2} + \\frac{\\|x\\|^2}{2\\sigma^2}\\right)$$\n$$w(x) = (\\sigma^2)^5 \\exp\\left(-\\frac{\\|x\\|^2}{2} \\left(1 - \\frac{1}{\\sigma^2}\\right)\\right)$$\n代入 $\\sigma^2 = 6$：\n$$w(x) = 6^5 \\exp\\left(-\\frac{\\|x\\|^2}{2} \\left(1 - \\frac{1}{6}\\right)\\right) = 7776 \\exp\\left(-\\frac{5}{12}\\|x\\|^2\\right)$$\n\n第三步是使用提供的模拟数据来计算估计值。估计量为：\n$$\\hat{P}_N = \\frac{1}{N} \\sum_{j=1}^N \\mathbb{I}(\\|X^{(j)}\\|^2  60) w(X^{(j)})$$\n这个求和是针对所有 $N$ 个样本的，但对于任何不满足条件 $\\|X^{(j)}\\|^2  60$ 的样本，指示函数 $\\mathbb{I}(\\cdot)$ 的值为零。因此，该求和等价于仅对那些落入稀有事件区域的样本的权重进行求和。\n问题陈述这个和是给定的：\n$$\\sum_{j \\text{ s.t. } \\|X^{(j)}\\|^2  60} w(X^{(j)}) = 0.617$$\n这就是估计量中分子的值，即对所有样本求和的结果：\n$$\\sum_{j=1}^N \\mathbb{I}(\\|X^{(j)}\\|^2  60) w(X^{(j)}) = 0.617$$\n\n样本总数为 $N = 5.0 \\times 10^5$。将这些值代入估计量公式：\n$$\\hat{P}_N = \\frac{0.617}{5.0 \\times 10^5}$$\n\n最后，我们计算数值：\n$$\\hat{P}_N = \\frac{0.617}{500000} = 0.000001234 = 1.234 \\times 10^{-6}$$\n四舍五入到三位有效数字，我们得到 $1.23 \\times 10^{-6}$。", "answer": "$$\\boxed{1.23 \\times 10^{-6}}$$", "id": "1376872"}]}