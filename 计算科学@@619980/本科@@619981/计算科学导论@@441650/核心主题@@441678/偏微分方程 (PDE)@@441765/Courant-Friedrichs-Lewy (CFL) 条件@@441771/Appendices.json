{"hands_on_practices": [{"introduction": "Courant-Friedrichs-Lewy (CFL) 条件是计算流体动力学和许多其他科学计算领域中稳定性的基石。它将物理波速、空间步长和时间步长联系起来。第一个练习将通过一个基本的一维平流方程模拟场景，帮助你熟练掌握 CFL 条件的核心定义，并应用它来计算一个关键的仿真参数——时间步长。[@problem_id:2139558]", "problem": "一个计算科学家团队正在模拟信号沿一维传输线的传播。信号电压 $u(x, t)$ 的行为由以下线性平流方程描述：\n$$ \\frac{\\partial u}{\\partial t} + v \\frac{\\partial u}{\\partial x} = 0 $$\n其中 $v$ 是信号的恒定传播速度。\n\n该模拟在具有均匀空间步长 $\\Delta x$ 的网格上使用有限差分格式。已知所选的数值方法仅在满足 Courant-Friedrichs-Lewy (CFL) 条件时才稳定。Courant 数 $C$ 定义为 $C = |v| \\frac{\\Delta t}{\\Delta x}$，其中 $\\Delta t$ 是时间步长。\n\n对于本次特定模拟，传播速度为 $v = 2.5 \\times 10^8$ m/s，空间步长为 $\\Delta x = 1.25$ cm。为确保高精度并避免数值振荡，该团队决定在 Courant 数恰好为 $C = 0.75$ 的条件下运行。\n\n本次模拟所需的时间步长 $\\Delta t$ 是多少？请以纳秒 (ns) 为单位表示答案，并四舍五入到两位有效数字。", "solution": "我们使用用于线性平流方程离散化的 Courant 数定义：\n$$\nC=\\frac{|v|\\,\\Delta t}{\\Delta x}.\n$$\n求解时间步长可得\n$$\n\\Delta t=\\frac{C\\,\\Delta x}{|v|}.\n$$\n代入给定值，并将空间步长转换为米：$\\Delta x=1.25\\times 10^{-2}\\ \\text{m}$， $|v|=2.5\\times 10^{8}\\ \\text{m s}^{-1}$，以及 $C=0.75$：\n$$\n\\Delta t=\\frac{0.75\\,(1.25\\times 10^{-2})}{2.5\\times 10^{8}}\\ \\text{s}.\n$$\n计算数值因子：\n$$\n\\Delta t=\\frac{0.9375\\times 10^{-2}}{2.5\\times 10^{8}}\\ \\text{s}\n=\\left(\\frac{0.9375}{2.5}\\right)\\times 10^{-10}\\ \\text{s}\n=0.375\\times 10^{-10}\\ \\text{s}\n=3.75\\times 10^{-11}\\ \\text{s}.\n$$\n使用 $1\\ \\text{ns}=10^{-9}\\ \\text{s}$ 将结果转换为纳秒：\n$$\n\\Delta t=3.75\\times 10^{-11}\\ \\text{s}=3.75\\times 10^{-2}\\ \\text{ns}=0.0375\\ \\text{ns}.\n$$\n四舍五入到两位有效数字，得到 $0.038\\ \\text{ns}$。", "answer": "$$\\boxed{0.038}$$", "id": "2139558"}, {"introduction": "CFL 条件的原理不仅适用于一阶平流方程，也同样适用于描述振动和波传播的二阶波动方程。在实践中，我们通常关心的是在保证数值稳定性的前提下，能够使用的最大时间步长是多少，以提高计算效率。这个练习将带你探讨波动方程的稳定性，并计算出满足 CFL 条件的最大时间步长。[@problem_id:2139541]", "problem": "一位工程师正在为一种特殊同轴电缆上的电压脉冲传播开发一个数值模拟。在一个简化的一维模型中，位置 $x$ 和时间 $t$ 处的电压 $u(x, t)$ 由波动方程决定：\n$$ \\frac{\\partial^2 u}{\\partial t^2} = 16 \\frac{\\partial^2 u}{\\partial x^2} $$\n其中 $x$ 的单位是米，$t$ 的单位是秒。\n\n该工程师决定使用一个标准的显式有限差分格式来数值求解这个方程。模拟的空间网格设置为均匀间距 $\\Delta x = 0.05$ 米。为确保数值解的稳定性，时间步长 $\\Delta t$ 必须仔细选择。\n\n在满足该格式的 Courant-Friedrichs-Lewy (CFL) 稳定性条件的情况下，可以使用的最大可能时间步长 $\\Delta t$ 是多少？请用秒作答，并四舍五入到三位有效数字。", "solution": "我们从以标准形式写出的一维波动方程开始\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}}=c^{2}\\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\n通过与给定方程 $\\frac{\\partial^{2} u}{\\partial t^{2}}=16\\,\\frac{\\partial^{2} u}{\\partial x^{2}}$ 进行比较，我们得到波速为 $c=4$ m/s。\n\n在间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，一个标准的二阶显式有限差分（时间空间中心差分）离散格式为\n$$\n\\frac{u_{j}^{n+1}-2u_{j}^{n}+u_{j}^{n-1}}{(\\Delta t)^{2}}=c^{2}\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{(\\Delta x)^{2}}.\n$$\n重新整理得到更新公式\n$$\nu_{j}^{n+1}=2u_{j}^{n}-u_{j}^{n-1}+r^{2}\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right),\n$$\n其中 Courant 数定义为\n$$\nr=\\frac{c\\,\\Delta t}{\\Delta x}.\n$$\n\n为了确定稳定性约束，我们进行 von Neumann 分析，寻找形如 $u_{j}^{n}=G^{n}\\exp(\\mathrm{i}\\kappa j\\Delta x)$ 的傅里叶模态解，其中 $G$ 是放大因子，$\\kappa$ 是波数。代入更新公式得到\n$$\nG-2+G^{-1}=r^{2}\\left(e^{\\mathrm{i}\\kappa\\Delta x}-2+e^{-\\mathrm{i}\\kappa\\Delta x}\\right)=-4r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right).\n$$\n等价地，\n$$\nG+G^{-1}=2\\left[1-2r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right)\\right].\n$$\n这导出了色散关系\n$$\n\\cos(\\omega\\Delta t)=1-2r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right),\n$$\n因此，稳定性要求对所有模态都有 $|G|=1$，这成立的条件是对于所有的 $\\kappa$，等式右侧都位于区间 $[-1,1]$ 内。由于 $\\sin^{2}(\\cdot)\\in[0,1]$，右侧对于所有 $\\kappa$ 的最小值为 $1-2r^{2}$。要求 $1-2r^{2}\\geq -1$ 可得\n$$\nr^{2}\\leq 1 \\quad\\Longleftrightarrow\\quad r\\leq 1.\n$$\n因此，该显式格式的 Courant-Friedrichs-Lewy 稳定性条件为\n$$\n\\frac{c\\,\\Delta t}{\\Delta x}\\leq 1 \\quad\\Longrightarrow\\quad \\Delta t\\leq \\frac{\\Delta x}{c}.\n$$\n\n对于给定的数据，$\\Delta x=0.05$ m 且 $c=4$ m/s，因此最大稳定时间步长为\n$$\n\\Delta t_{\\max}=\\frac{0.05}{4}=0.0125 \\text{ s}.\n$$\n四舍五入到三位有效数字，该值为 $0.0125$ 秒。", "answer": "$$\\boxed{0.0125}$$", "id": "2139541"}, {"introduction": "理解 CFL 条件不仅仅是记住一个不等式，更重要的是领会其物理意义。这个练习提供了一个理想化的思想实验：当库朗数正好等于 1 时，数值解会发生什么？通过分析这个特殊情况，你将深刻理解数值格式如何模拟物理现象，并洞察数值扩散等误差的来源。[@problem_id:2139538]", "problem": "考虑一维线性平流方程，它模拟了某个量 $u$ 以恒定速度的输运过程。该方程由下式给出：\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\n其中 $u(x, t)$ 是在位置 $x$ 和时间 $t$ 的输运量，而 $c$ 是一个恒定的正平流速度 ($c > 0$)。该方程在空间域 $x \\in (-\\infty, \\infty)$ 和时间 $t \\ge 0$ 上求解。\n\n在 $t=0$ 时的初始条件是一个定义良好的局部脉冲 $u(x, 0) = f(x)$，它仅在一个有限区间上非零。\n\n为了数值求解该方程，我们建立一个具有均匀空间步长 $\\Delta x$ 和均匀时间步长 $\\Delta t$ 的计算网格。网格点表示为 $x_j = j \\Delta x$ 和 $t_n = n \\Delta t$，其中 $j$ 是整数， $n$ 是非负整数。令 $U_j^n$ 表示 $u(x_j, t_n)$ 的数值近似。\n\n数值解采用一阶迎风有限差分格式。给定正平流速度 $c>0$，该格式通过对时间导数使用向前差分、对空间导数使用向后差分来定义：\n$$\n\\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_j^n - U_{j-1}^n}{\\Delta x} = 0\n$$\n空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 被特意选择，使得定义为 $\\sigma = \\frac{c \\Delta t}{\\Delta x}$ 的库朗数（Courant number）恰好等于1。\n\n在系统演化 $N$ 个时间步长后（其中 $N$ 是一个正整数），下列哪个陈述最能描述数值解的分布 $\\{U_j^N\\}_{j \\in \\mathbb{Z}}$ 与初始离散分布 $\\{U_j^0\\}_{j \\in \\mathbb{Z}}$ 之间的关系？\n\nA. 数值解在网格点上与精确解析解完全相同，表现为初始分布的完美、保形的平移。\n\nB. 脉冲的峰值减小，基底变宽，表明存在数值耗散。\n\nC. 数值解中出现了伪振荡，尤其是在初始脉冲梯度较大的区域附近。\n\nD. 数值解的量值无界增长，表明存在数值不稳定性。\n\nE. 脉冲发生了平移，但变得不对称，一侧比另一侧更陡峭。\n\nF. 脉冲保持在初始位置中心，但其振幅随时间衰减。", "solution": "连续问题是具有恒定正速度 $c>0$ 的线性平流方程，\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0,\n$$\n其初始条件 $u(x,0)=f(x)$ 是紧支撑的。根据特征线法，沿着满足 $\\frac{\\mathrm{d}x}{\\mathrm{d}t}=c$ 的曲线，解是恒定的。因此，精确解为\n$$\nu(x,t) = f(x - c t).\n$$\n\n在均匀网格 $x_j=j \\Delta x$，$t_n=n \\Delta t$上，针对 $c>0$ 的一阶迎风格式为\n$$\n\\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_j^n - U_{j-1}^n}{\\Delta x} = 0.\n$$\n引入库朗数 $\\sigma = \\frac{c \\Delta t}{\\Delta x}$ 并整理可得\n$$\nU_j^{n+1} = U_j^n - \\sigma \\left(U_j^n - U_{j-1}^n\\right) = (1-\\sigma) U_j^n + \\sigma U_{j-1}^n.\n$$\n当特意选择 $\\sigma=1$ 时，该更新方程简化为纯粹的平移算子\n$$\nU_j^{n+1} = U_{j-1}^n.\n$$\n将此恒等式迭代 $N$ 个时间步长，得到\n$$\nU_j^{N} = U_{j-1}^{N-1} = \\cdots = U_{j-N}^{0}.\n$$\n因此，离散分布精确地向右平移了 $N$ 个网格单元，其形状和振幅没有任何改变。\n\n为了与时间 $t_N = N \\Delta t$ 时网格点上的精确解进行比较，我们计算\n$$\nu(x_j, t_N) = f(x_j - c t_N) = f\\big(j \\Delta x - c N \\Delta t\\big).\n$$\n由于 $\\sigma= \\frac{c \\Delta t}{\\Delta x} = 1$，我们有 $c N \\Delta t = N \\Delta x$，因此\n$$\nu(x_j, t_N) = f\\big((j-N)\\Delta x\\big) = f(x_{j-N}).\n$$\n根据初始离散数据的定义，$U_{j-N}^{0} = f(x_{j-N})$，所以\n$$\nU_j^{N} = U_{j-N}^{0} = u(x_j, t_N).\n$$\n因此，在网格点上，数值解与解析解完全吻合，表现为初始分布向右平移 $N$ 个单元的完美、保形的平移。在这种情况下，数值耗散、伪振荡、不稳定性、不对称性或静止衰减等效应均未发生。\n\n正确选项是 A。", "answer": "$$\\boxed{A}$$", "id": "2139538"}]}