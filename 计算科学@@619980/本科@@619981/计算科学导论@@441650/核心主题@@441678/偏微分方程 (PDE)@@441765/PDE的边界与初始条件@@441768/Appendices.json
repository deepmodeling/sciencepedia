{"hands_on_practices": [{"introduction": "边界条件如何决定物理问题解的具体形式？本练习将探讨一维热方程，这是一个描述扩散现象的基本模型。通过在杆的两端施加固定的零温（Dirichlet）边界条件，我们将可能存在的温度分布限制在一组离散的模态（即本征函数）上。你的任务是确定这些模态中衰减最慢的基模所对应的衰减常数，从而将系统的物理参数与其长期行为直接联系起来。[@problem_id:945]", "problem": "考虑一维热方程，它描述了热量 $u(x, t)$ 在一根细长、均匀的杆中随时间的分布：\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}\n$$\n其中，$u(x, t)$ 是在位置 $x$ 和时间 $t$ 的温度，$\\alpha$ 是杆的常数热扩散系数。杆的长度有限，为 $L$，从 $x=0$ 延伸到 $x=L$。\n\n对于所有时间 $t \\ge 0$，杆的两端保持恒定的零温度。这被称为齐次狄利克雷边界条件：\n1.  $u(0, t) = 0$\n2.  $u(L, t) = 0$\n\n一个提出的用于温度分布的非平凡解具有以下形式：\n$$\nu(x, t) = A \\exp(-\\lambda t) \\sin(kx)\n$$\n其中 $A$、$\\lambda$ 和 $k$ 是正常数，$A \\neq 0$。\n\n你的任务是找出该解的基模所对应的衰减常数 $\\lambda$ 的具体值。基模是满足给定边界条件的波数 $k$ 的最小可能正值所对应的模式。\n\n推导出 $\\lambda$ 关于热扩散系数 $\\alpha$ 和杆长 $L$ 的表达式。", "solution": "该问题要求解在一维热方程的特定狄利克雷边界条件下，一个提出的解的基模所对应的衰减常数 $\\lambda$ 的值。推导过程主要分为三个部分：首先，确保该函数满足偏微分方程（PDE），以找到常数之间的关系；其次，应用边界条件来确定 $k$ 的允许值；最后，结合这些结果来找到 $\\lambda$ 的具体值。\n\n**第一部分：满足热方程**\n\n我们从提出的解开始：\n$$\nu(x, t) = A \\exp(-\\lambda t) \\sin(kx)\n$$\n我们需要计算它关于 $t$ 和 $x$ 的偏导数，并将它们代入热方程 $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$。\n\n首先，是关于时间 $t$ 的偏导数：\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ A e^{-\\lambda t} \\sin(kx) \\right] = -A\\lambda e^{-\\lambda t} \\sin(kx)\n$$\n\n接下来，我们计算关于位置 $x$ 的偏导数。一阶偏导数是：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ A e^{-\\lambda t} \\sin(kx) \\right] = Ak e^{-\\lambda t} \\cos(kx)\n$$\n\n关于 $x$ 的二阶偏导数是：\n$$\n\\frac{\\partial^2 u}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left[ Ak e^{-\\lambda t} \\cos(kx) \\right] = -Ak^2 e^{-\\lambda t} \\sin(kx)\n$$\n\n现在，我们将这些导数代入热方程：\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}\n$$\n$$\n-A\\lambda e^{-\\lambda t} \\sin(kx) = \\alpha \\left( -Ak^2 e^{-\\lambda t} \\sin(kx) \\right)\n$$\n\n对于一个非平凡解，$A \\neq 0$。项 $e^{-\\lambda t} \\sin(kx)$ 并非对所有 $x$ 和 $t$ 都为零。因此，我们可以将方程两边同时除以 $-A e^{-\\lambda t} \\sin(kx)$：\n$$\n\\lambda = \\alpha k^2\n$$\n这就是给定函数成为热方程解所必需的 $\\lambda$ 和 $k$ 之间的关系。\n\n**第二部分：应用边界条件**\n\n现在我们应用狄利克雷边界条件来找到 $k$ 的允许值。\n\n第一个边界条件是 $u(0, t) = 0$：\n$$\nu(0, t) = A e^{-\\lambda t} \\sin(k \\cdot 0) = A e^{-\\lambda t} \\sin(0) = A e^{-\\lambda t} \\cdot 0 = 0\n$$\n这个条件对任何 $A$、$\\lambda$ 和 $k$ 的值都满足。\n\n第二个边界条件是 $u(L, t) = 0$：\n$$\nu(L, t) = A e^{-\\lambda t} \\sin(kL) = 0\n$$\n因为我们寻找的是非平凡解，所以必须有 $A \\neq 0$。指数项 $e^{-\\lambda t}$ 对于所有有限的 $t$ 也非零。因此，要使该方程成立，唯一的可能是正弦项为零：\n$$\n\\sin(kL) = 0\n$$\n\n正弦函数在其参数是 $\\pi$ 的整数倍时为零。因此：\n$$\nkL = n\\pi, \\quad \\text{for } n \\in \\mathbb{Z}\n$$\n解出 $k$，我们得到：\n$$\nk = \\frac{n\\pi}{L}\n$$\n由于 $k$ 被给定为正常数，我们必须要求 $n$ 是一个正整数，即 $n = 1, 2, 3, \\ldots$。$n=0$ 的情况会导出 $k=0$，这将使得 $u(x,t)=0$，是一个平凡解。\n\n**第三部分：求解基模的 $\\lambda$**\n\n问题要求的是对应于基模的 $\\lambda$ 值，基模是具有最小可能正值 $k$ 的模式。根据表达式 $k = \\frac{n\\pi}{L}$，当 $n$ 取最小正整数值，即 $n=1$ 时，$k$ 取得最小正值。\n\n我们将这个基准波数称为 $k_1$：\n$$\nk_1 = \\frac{(1)\\pi}{L} = \\frac{\\pi}{L}\n$$\n\n最后，我们使用在第一部分中推导出的关系 $\\lambda = \\alpha k^2$ 来找到相应的 $\\lambda$ 值。代入 $k = k_1 = \\frac{\\pi}{L}$：\n$$\n\\lambda = \\alpha \\left(\\frac{\\pi}{L}\\right)^2\n$$\n$$\n\\lambda = \\frac{\\alpha \\pi^2}{L^2}\n$$\n这就是该解的基模所对应的衰减常数的值。", "answer": "$$\\boxed{\\frac{\\alpha \\pi^2}{L^2}}$$", "id": "945"}, {"introduction": "与受边界约束的系统不同，一个无限域中的初始状态是如何演化的？本练习使用优美的达朗贝尔公式来求解无限长弦上的波动方程，这是一个经典的双曲型偏微分方程示例。在给定一个特定的初始速度分布但没有初始位移的情况下，你将计算出弦在未来某一时刻的形状，这清晰地展示了初始条件如何传播和相互作用，最终决定系统的未来状态。[@problem_id:934]", "problem": "考虑一个关于函数 $u(x,t)$ 的一维波动方程：\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\n该方程描述了一根无限长振动弦的位移。在无限定义域（$-\\infty  x  \\infty$）上，初始值问题的通解由 d'Alembert 公式给出：\n$$\nu(x,t) = \\frac{1}{2}[f(x+ct) + f(x-ct)] + \\frac{1}{2c} \\int_{x-ct}^{x+ct} g(s) \\, ds\n$$\n其中 $f(x) = u(x,0)$ 是初始位移，$g(x) = u_t(x,0)$ 是初始速度。\n\n假设波速为 $c=1$。弦最初处于其平衡位置，即对所有 $x$ 都有 $f(x)=0$。弦被赋予一个由 $g(x) = 2\\cos(x)$ 描述的初始速度分布。\n\n推导弦在任意位置 $x$ 和特定时间 $t=\\pi$ 时的位移。即，求出 $u(x, \\pi)$ 的表达式。", "solution": "我们从 d'Alembert 公式开始，其中 $c=1$，$f(x)=0$，$g(x)=2\\cos x$：\n$$\nu(x,t)\n= \\frac{1}{2}\\bigl[f(x+t)+f(x-t)\\bigr]\n  + \\frac{1}{2}\\int_{x-t}^{x+t}g(s)\\,ds\n= \\frac{1}{2}\\int_{x-t}^{x+t}2\\cos s\\,ds.\n$$\n计算该积分，\n$$\nu(x,t)\n= \\int_{x-t}^{x+t}\\cos s\\,ds\n= \\sin s\\Big|_{s=x-t}^{s=x+t}\n= \\sin(x+t)-\\sin(x-t).\n$$\n使用正弦和差公式，\n$$\n\\sin(x+t)-\\sin(x-t)\n= 2\\cos\\bigl(\\tfrac{(x+t)+(x-t)}{2}\\bigr)\\,\n  \\sin\\bigl(\\tfrac{(x+t)-(x-t)}{2}\\bigr)\n= 2\\cos x\\,\\sin t.\n$$\n因此，当 $t=\\pi$ 时，\n$$\nu(x,\\pi)=2\\cos x\\,\\sin\\pi=2\\cos x\\cdot 0=0.\n$$", "answer": "$$\\boxed{0}$$", "id": "934"}, {"introduction": "在为计算机模拟离散化偏微分方程时，我们选择的数值方法是否会影响像质量守恒这样的基本物理定律？这个高级练习深入探讨了平流-扩散问题中诺伊曼（Neumann）边界条件（通量边界条件）的数值处理。通过比较内在守恒的有限体积法和一种常见的有限差分实现，你将分析推导出两者在处理边界质量守恒方面的差异，从而揭示计算科学中一个关键且往往微妙的方面。[@problem_id:3103155]", "problem": "考虑在空间区间 $[0,L]$ 上的一维对流-扩散偏微分方程 (PDE)，其中对流速度 $a>0$ 和扩散系数 $D>0$ 为常数，\n$$\nu_t + a\\,u_x = D\\,u_{xx},\n$$\n该方程满足光滑的初始条件 $u(x,0) = u_0(x)$ 以及随时间变化的诺伊曼边界条件 $u_x(0,t) = g_0(t)$ 和 $u_x(L,t) = g_L(t)$。此处，$u(x,t)$ 表示守恒标量场，$g_0(t)$ 和 $g_L(t)$ 分别是 $x=0$ 和 $x=L$ 处给定的边界法向梯度。该方程的守恒律形式为 $u_t + F_x = 0$，其中物理通量为 $F(x,t) = a\\,u(x,t) - D\\,u_x(x,t)$。\n\n用包含 $N$ 个单元的均匀网格离散化该区域，网格间距为 $\\Delta x = L/N$，并定义离散总质量为 $M(t) = \\Delta x \\sum_{i=1}^{N} u_i(t)$。\n\n考虑两种半离散方法：\n\n- 有限体积法 (FV)：有限体积法 (FV) 使用单元平均值 $u_i(t)$ 和界面通量 $F_{i+1/2}$。对于内部界面，使用 $F_{i+1/2} = a\\,u^{\\mathrm{up}}_{i+1/2} - D\\,\\frac{u_{i+1} - u_i}{\\Delta x}$，其中迎风状态 $u^{\\mathrm{up}}_{i+1/2}$ 与 $a>0$ 一致。在左边界界面，设置 $F_{1/2}(t) = a\\,u_{\\mathrm{in}}(t) - D\\,g_0(t)$，其中 $u_{\\mathrm{in}}(t)$ 是在 $x=0$ 处给定的入流值。在右边界界面，设置 $F_{N+1/2}(t) = a\\,u_N(t) - D\\,g_L(t)$。半离散 FV 更新方程为 $\\Delta x\\,\\frac{d}{dt}u_i + \\left(F_{i+1/2} - F_{i-1/2}\\right) = 0$。\n\n- 有限差分法 (FD)：有限差分法 (FD) 使用内部网格点上的点值 $u_i(t)$，并对对流项和扩散项使用中心差分，\n$$\n\\frac{d}{dt}u_i = -a\\,\\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x} + D\\,\\frac{u_{i+1} - 2\\,u_i + u_{i-1}}{\\Delta x^2}, \\quad i=1,\\dots,N.\n$$\n使用一阶虚拟单元闭合 $u_0(t) = u_1(t) - \\Delta x\\,g_0(t)$ 和 $u_{N+1}(t) = u_N(t) + \\Delta x\\,g_L(t)$ 来实施诺伊曼边界条件。\n\n假设 FV 的入流状态被选择为与第一个内部值相匹配，即 $u_{\\mathrm{in}}(t) = u_1(t)$。从守恒律基础 $u_t + F_x = 0$ 和给定的离散定义出发，推导 FV 和 FD 两种方法的边界通量和半离散总质量变化率 $\\frac{d}{dt}M(t)$。然后，利用所述假设，计算差异\n$$\n\\Delta \\equiv \\left(\\frac{d}{dt}M\\right)_{\\mathrm{FD}} - \\left(\\frac{d}{dt}M\\right)_{\\mathrm{FV}}\n$$\n的闭式表达式，用 $a$、$\\Delta x$、$g_0(t)$ 和 $g_L(t)$ 表示。将 $\\Delta$ 的最终表达式作为您的答案。", "solution": "首先根据所需准则对问题陈述进行验证。\n\n### 第 1 步：提取已知条件\n- **PDE**：$u_t + a\\,u_x = D\\,u_{xx}$，对于 $x \\in [0,L]$，其中 $a>0, D>0$ 为常数。\n- **初始条件**：$u(x,0) = u_0(x)$。\n- **边界条件**：$u_x(0,t) = g_0(t)$ 和 $u_x(L,t) = g_L(t)$。\n- **通量**：$F(x,t) = a\\,u(x,t) - D\\,u_x(x,t)$，使得 $u_t + F_x = 0$。\n- **离散化**：包含 $N$ 个单元的均匀网格，间距 $\\Delta x = L/N$。\n- **离散总质量**：$M(t) = \\Delta x \\sum_{i=1}^{N} u_i(t)$。\n- **有限体积法 (FV)**：\n    - 半离散更新：$\\Delta x\\,\\frac{d}{dt}u_i + (F_{i+1/2} - F_{i-1/2}) = 0$。\n    - 内部界面通量：$F_{i+1/2} = a\\,u^{\\mathrm{up}}_{i+1/2} - D\\,\\frac{u_{i+1} - u_i}{\\Delta x}$，其中 $u^{\\mathrm{up}}_{i+1/2}$ 是 $a>0$ 时的迎风状态。\n    - 左边界通量：$F_{1/2}(t) = a\\,u_{\\mathrm{in}}(t) - D\\,g_0(t)$。\n    - 右边界通量：$F_{N+1/2}(t) = a\\,u_N(t) - D\\,g_L(t)$。\n    - 入流假设：$u_{\\mathrm{in}}(t) = u_1(t)$。\n- **有限差分法 (FD)**：\n    - 对于 $i=1,\\dots,N$ 的半离散更新：$\\frac{d}{dt}u_i = -a\\,\\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x} + D\\,\\frac{u_{i+1} - 2\\,u_i + u_{i-1}}{\\Delta x^2}$。\n    - 用于边界条件的虚拟单元闭合：$u_0(t) = u_1(t) - \\Delta x\\,g_0(t)$ 和 $u_{N+1}(t) = u_N(t) + \\Delta x\\,g_L(t)$。\n- **目标**：计算差异 $\\Delta \\equiv \\left(\\frac{d}{dt}M\\right)_{\\mathrm{FD}} - \\left(\\frac{d}{dt}M\\right)_{\\mathrm{FV}}$。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据，是适定且客观的。它描述了计算科学中的一个标准问题：比较两种常用数值格式（有限体积法和有限差分法）在求解对流-扩散方程时的守恒性质。所有参数、方程和数值实现细节都已明确指定。所提供的定义是自洽且数学上一致的，可以直接且唯一地推导出所要求的量。不存在违反科学原理、逻辑不一致或主观论断的情况。\n\n### 第 3 步：结论与行动\n问题有效。将推导一个完整的解。\n\n任务是推导 $\\Delta \\equiv \\left(\\frac{d}{dt}M\\right)_{\\mathrm{FD}} - \\left(\\frac{d}{dt}M\\right)_{\\mathrm{FV}}$ 的表达式。这需要分别为每种方法计算离散总质量的变化率 $\\frac{dM}{dt}$。\n\n离散总质量的定义为 $M(t) = \\Delta x \\sum_{i=1}^{N} u_i(t)$。其时间导数为：\n$$\n\\frac{dM}{dt} = \\frac{d}{dt} \\left( \\Delta x \\sum_{i=1}^{N} u_i(t) \\right) = \\Delta x \\sum_{i=1}^{N} \\frac{du_i}{dt}\n$$\n\n**1. 有限体积法 (FV) 的推导**\n\n半离散 FV 方程为 $\\Delta x\\,\\frac{d}{dt}u_i = -(F_{i+1/2} - F_{i-1/2})$。我们将其代入 $\\frac{dM}{dt}$ 的表达式中：\n$$\n\\left(\\frac{dM}{dt}\\right)_{\\mathrm{FV}} = \\sum_{i=1}^{N} \\left( \\Delta x \\frac{du_i}{dt} \\right) = \\sum_{i=1}^{N} -(F_{i+1/2} - F_{i-1/2})\n$$\n这个和是一个伸缩级数：\n$$\n\\sum_{i=1}^{N} -(F_{i+1/2} - F_{i-1/2}) = -[(F_{3/2} - F_{1/2}) + (F_{5/2} - F_{3/2}) + \\dots + (F_{N+1/2} - F_{N-1/2})]\n$$\n所有 $i=1, \\dots, N-1$ 的内部通量 $F_{i+1/2}$ 都相互抵消，只剩下边界通量：\n$$\n\\left(\\frac{dM}{dt}\\right)_{\\mathrm{FV}} = -(F_{N+1/2} - F_{1/2}) = F_{1/2}(t) - F_{N+1/2}(t)\n$$\n这证明了 FV 格式的精确守恒性质，即总质量的变化仅由通过区域边界的通量引起。现在，我们代入给定的边界通量表达式 $F_{1/2}(t) = a\\,u_{\\mathrm{in}}(t) - D\\,g_0(t)$ 和 $F_{N+1/2}(t) = a\\,u_N(t) - D\\,g_L(t)$。我们还应用给定的假设，即入流值为 $u_{\\mathrm{in}}(t) = u_1(t)$：\n$$\nF_{1/2}(t) = a\\,u_1(t) - D\\,g_0(t)\n$$\n因此，FV 方法的总质量变化率为：\n$$\n\\left(\\frac{dM}{dt}\\right)_{\\mathrm{FV}} = [a\\,u_1(t) - D\\,g_0(t)] - [a\\,u_N(t) - D\\,g_L(t)]\n$$\n$$\n\\left(\\frac{dM}{dt}\\right)_{\\mathrm{FV}} = a\\,(u_1(t) - u_N(t)) - D\\,(g_0(t) - g_L(t))\n$$\n\n**2. 有限差分法 (FD) 的推导**\n\n我们再次从 $\\frac{dM}{dt}$ 的定义开始，并代入半离散 FD 更新规则：\n$$\n\\left(\\frac{dM}{dt}\\right)_{\\mathrm{FD}} = \\Delta x \\sum_{i=1}^{N} \\frac{du_i}{dt} = \\Delta x \\sum_{i=1}^{N} \\left( -a\\,\\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x} + D\\,\\frac{u_{i+1} - 2\\,u_i + u_{i-1}}{\\Delta x^2} \\right)\n$$\n分配求和与 $\\Delta x$：\n$$\n\\left(\\frac{dM}{dt}\\right)_{\\mathrm{FD}} = - \\frac{a}{2} \\sum_{i=1}^{N} (u_{i+1} - u_{i-1}) + \\frac{D}{\\Delta x} \\sum_{i=1}^{N} (u_{i+1} - 2 u_i + u_{i-1})\n$$\n我们分别计算这两个和。\n对于对流项的和：\n$$\n\\sum_{i=1}^{N} (u_{i+1} - u_{i-1}) = (u_2 - u_0) + (u_3 - u_1) + \\dots + (u_N - u_{N-2}) + (u_{N+1} - u_{N-1})\n$$\n通过重排各项，我们可以看到大多数内部点值相互抵消。剩余的项来自求和序列的边界：\n$$\n\\sum_{i=1}^{N} (u_{i+1} - u_{i-1}) = (u_N + u_{N+1}) - (u_0 + u_1)\n$$\n对于扩散项的和，我们认识到它是一个二阶差分的和，该和是伸缩的：\n$$\n\\sum_{i=1}^{N} (u_{i+1} - 2 u_i + u_{i-1}) = \\sum_{i=1}^{N} [(u_{i+1} - u_i) - (u_i - u_{i-1})]\n$$\n这个和伸缩为 $(u_{N+1} - u_N) - (u_1 - u_0)$。\n现在，代入虚拟单元闭合关系：$u_0(t) = u_1(t) - \\Delta x\\,g_0(t)$ 和 $u_{N+1}(t) = u_N(t) + \\Delta x\\,g_L(t)$。\n\n对流项对 $\\frac{dM}{dt}$ 的贡献是：\n$$\n- \\frac{a}{2} [ (u_N + u_{N+1}) - (u_0 + u_1) ] = - \\frac{a}{2} [ u_N + (u_N + \\Delta x\\,g_L(t)) - (u_1 - \\Delta x\\,g_0(t)) - u_1 ]\n$$\n$$\n= - \\frac{a}{2} [ 2\\,u_N - 2\\,u_1 + \\Delta x\\,(g_0(t) + g_L(t)) ] = a\\,(u_1(t) - u_N(t)) - \\frac{a\\,\\Delta x}{2} (g_0(t) + g_L(t))\n$$\n扩散项对 $\\frac{dM}{dt}$ 的贡献是：\n$$\n\\frac{D}{\\Delta x} [ (u_{N+1} - u_N) - (u_1 - u_0) ] = \\frac{D}{\\Delta x} [ (u_N(t) + \\Delta x\\,g_L(t) - u_N(t)) - (u_1(t) - (u_1(t) - \\Delta x\\,g_0(t))) ]\n$$\n$$\n= \\frac{D}{\\Delta x} [ \\Delta x\\,g_L(t) - \\Delta x\\,g_0(t) ] = D\\,(g_L(t) - g_0(t)) = -D\\,(g_0(t) - g_L(t))\n$$\n结合这两部分贡献，我们得到 FD 方法的总变化率：\n$$\n\\left(\\frac{dM}{dt}\\right)_{\\mathrm{FD}} = a\\,(u_1(t) - u_N(t)) - \\frac{a\\,\\Delta x}{2} (g_0(t) + g_L(t)) - D\\,(g_0(t) - g_L(t))\n$$\n\n**3. 计算差异 $\\Delta$**\n\n最后，我们计算差值 $\\Delta = (\\frac{dM}{dt})_{\\mathrm{FD}} - (\\frac{dM}{dt})_{\\mathrm{FV}}$：\n$$\n\\Delta = \\left[ a\\,(u_1(t) - u_N(t)) - \\frac{a\\,\\Delta x}{2} (g_0(t) + g_L(t)) - D\\,(g_0(t) - g_L(t)) \\right] - \\left[ a\\,(u_1(t) - u_N(t)) - D\\,(g_0(t) - g_L(t)) \\right]\n$$\n项 $a\\,(u_1(t) - u_N(t))$ 和 $- D\\,(g_0(t) - g_L(t))$ 在两个表达式中都存在，并在相减时抵消。唯一剩下的项是：\n$$\n\\Delta = - \\frac{a\\,\\Delta x}{2} (g_0(t) + g_L(t))\n$$\n这个结果表明，两种格式之间总质量变化率的差异通常是非零的。它源于对流项的中心差分近似与边界条件的一阶虚拟单元实现相结合时的非守恒性质。而 FV 方法，根据其构造，是完全守恒的。", "answer": "$$\n\\boxed{- \\frac{a\\,\\Delta x}{2} (g_0(t) + g_L(t))}\n$$", "id": "3103155"}]}