{"hands_on_practices": [{"introduction": "我们为什么需要主元选择策略？一个线性系统的“病态”与否（由条件数衡量）是否直接决定了求解过程的稳定性？这个练习旨在澄清一个常见的误解：即使一个矩阵是良态的，使用不当的数值方法（如不进行主元选择的高斯消元法）仍可能导致灾难性的数值不稳定性。通过这个练习 [@problem_id:2424543]，你将学会区分矩阵的内禀属性（条件数）和求解算法的稳定性（通过增长因子衡量），从而理解主元选择策略的根本重要性。", "problem": "考虑线性系统 $A_{\\delta} x = b$，其中\n$$\nA_{\\delta}=\\begin{pmatrix}\n\\delta  1 \\\\\n1  1\n\\end{pmatrix},\\quad\nb=\\begin{pmatrix}\n1 \\\\\n2\n\\end{pmatrix},\n$$\n$\\delta=10^{-8}$。矩阵 $A_{\\delta}$ 是实对称矩阵。矩阵 2-范数下的条件数定义为 $\\kappa_{2}(A_{\\delta})=\\dfrac{\\sigma_{\\max}(A_{\\delta})}{\\sigma_{\\min}(A_{\\delta})}$，其中 $\\sigma_{\\max}(A_{\\delta})$ 和 $\\sigma_{\\min}(A_{\\delta})$ 分别是 $A_{\\delta}$ 的最大和最小奇异值。$A_{\\delta}$ 的无主元 LU (Lower–Upper) 分解对应于应用一步不进行行交换的高斯消去法来产生一个上三角因子 $U$。\n\n使用第一性原理（奇异值和高斯消去法的定义），证明对于给定的 $\\delta$，$\\kappa_{2}(A_{\\delta})$ 很小，并计算由下式定义的无主元高斯消去法增长因子 $\\rho$：\n$$\n\\rho=\\frac{\\max_{i,j}\\left|U_{ij}\\right|}{\\max_{i,j}\\left|A_{\\delta,ij}\\right|},\n$$\n其中 $U$ 是对 $A_{\\delta}$ 应用不带主元选取的高斯消去法所产生的上三角因子。\n\n答案规格：\n- 提供 $\\delta=10^{-8}$ 时 $\\rho$ 的精确值。\n- 无需单位。", "solution": "首先必须严格验证所陈述的问题。\n\n第 1 步：提取已知条件\n提供了以下数据：\n- 线性系统为 $A_{\\delta} x = b$。\n- 矩阵为 $A_{\\delta} = \\begin{pmatrix} \\delta  1 \\\\ 1  1 \\end{pmatrix}$。\n- 向量为 $b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n- 参数为 $\\delta = 10^{-8}$。\n- 矩阵 $A_{\\delta}$ 是实对称矩阵。\n- 条件数定义为 $\\kappa_{2}(A_{\\delta})=\\dfrac{\\sigma_{\\max}(A_{\\delta})}{\\sigma_{\\min}(A_{\\delta})}$，其中 $\\sigma_{\\max}(A_{\\delta})$ 和 $\\sigma_{\\min}(A_{\\delta})$ 是 $A_{\\delta}$ 的最大和最小奇异值。\n- 上三角因子 $U$ 是通过对 $A_{\\delta}$ 进行无主元高斯消去得到的。\n- 增长因子定义为 $\\rho=\\dfrac{\\max_{i,j}\\left|U_{ij}\\right|}{\\max_{i,j}\\left|A_{\\delta,ij}\\right|}$。\n- 任务是证明对于给定的 $\\delta$，$\\kappa_{2}(A_{\\delta})$ 很小，并计算 $\\rho$ 的精确值。\n\n第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据，提法恰当且客观。它涉及计算工程和数值分析中的基本概念，特别是矩阵条件、主元选取策略以及求解线性系统时的数值稳定性之间的关系。所有术语都是标准的且定义精确。为得到唯一解提供了所有必要的数据。对于 $\\delta = 10^{-8}$，矩阵 $A_{\\delta}$ 是可逆的，因为其行列式为 $\\det(A_{\\delta}) = \\delta \\cdot 1 - 1 \\cdot 1 = \\delta - 1 = 10^{-8} - 1 \\neq 0$。前提没有违反任何科学原理或数学逻辑。\n\n第 3 步：结论与行动\n问题有效。将提供完整解答。\n\n解答按要求分为两部分进行。\n\n第 1 部分：条件数 $\\kappa_{2}(A_{\\delta})$ 的证明\n2-范数下的条件数定义为 $\\kappa_{2}(A_{\\delta}) = \\sigma_{\\max}(A_{\\delta}) / \\sigma_{\\min}(A_{\\delta})$。对于像 $A_{\\delta}$ 这样的实对称矩阵，奇异值是其特征值的绝对值。我们必须首先通过求解特征方程 $\\det(A_{\\delta} - \\lambda I) = 0$ 来找到 $A_{\\delta}$ 的特征值 $\\lambda$。\n$$\n\\det\\left(\\begin{pmatrix} \\delta  1 \\\\ 1  1 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\\right) = 0\n$$\n$$\n\\det\\begin{pmatrix} \\delta - \\lambda  1 \\\\ 1  1 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(\\delta - \\lambda)(1 - \\lambda) - 1 = 0\n$$\n$$\n\\lambda^2 - (1+\\delta)\\lambda + (\\delta - 1) = 0\n$$\n使用二次公式，特征值为：\n$$\n\\lambda_{1,2} = \\frac{(1+\\delta) \\pm \\sqrt{(1+\\delta)^2 - 4(\\delta - 1)}}{2} = \\frac{1+\\delta \\pm \\sqrt{1 + 2\\delta + \\delta^2 - 4\\delta + 4}}{2}\n$$\n$$\n\\lambda_{1,2} = \\frac{1+\\delta \\pm \\sqrt{\\delta^2 - 2\\delta + 5}}{2}\n$$\n$\\delta$ 的值为 $10^{-8}$。这是一个非常小的正数。我们来分析平方根下的项：$\\delta^2 - 2\\delta + 5$。对于 $\\delta = 10^{-8}$，该项为 $10^{-16} - 2 \\times 10^{-8} + 5$，这是一个非常接近 $5$ 的正数。\n两个特征值为：\n$$\n\\lambda_1 = \\frac{1+\\delta + \\sqrt{\\delta^2 - 2\\delta + 5}}{2}\n$$\n$$\n\\lambda_2 = \\frac{1+\\delta - \\sqrt{\\delta^2 - 2\\delta + 5}}{2}\n$$\n因为 $\\delta$ 很小，所以 $\\sqrt{\\delta^2 - 2\\delta + 5} \\approx \\sqrt{5} > 1+\\delta$。因此，$\\lambda_1 > 0$ 且 $\\lambda_2  0$。\n奇异值为 $\\sigma_1 = |\\lambda_1| = \\lambda_1$ 和 $\\sigma_2 = |\\lambda_2| = -\\lambda_2$。\n最大奇异值为 $\\sigma_{\\max} = \\lambda_1$，最小奇异值为 $\\sigma_{\\min} = -\\lambda_2$。\n条件数为：\n$$\n\\kappa_{2}(A_{\\delta}) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} = \\frac{\\lambda_1}{-\\lambda_2} = \\frac{1+\\delta + \\sqrt{\\delta^2 - 2\\delta + 5}}{-(1+\\delta - \\sqrt{\\delta^2 - 2\\delta + 5})} = \\frac{1+\\delta + \\sqrt{\\delta^2 - 2\\delta + 5}}{\\sqrt{\\delta^2 - 2\\delta + 5} - (1+\\delta)}\n$$\n在 $\\delta \\to 0$ 的极限情况下，我们有：\n$$\n\\lim_{\\delta \\to 0} \\kappa_{2}(A_{\\delta}) = \\frac{1 + \\sqrt{5}}{\\sqrt{5} - 1} = \\frac{(1 + \\sqrt{5})(\\sqrt{5} + 1)}{(\\sqrt{5} - 1)(\\sqrt{5} + 1)} = \\frac{1 + 2\\sqrt{5} + 5}{5 - 1} = \\frac{6 + 2\\sqrt{5}}{4} = \\frac{3 + \\sqrt{5}}{2}\n$$\n该值约等于 $\\frac{3 + 2.236}{2} \\approx 2.618$。对于 $\\delta = 10^{-8}$，条件数将非常接近这个值。数量级为 $1$ 的条件数被认为是小的，这表明矩阵 $A_{\\delta}$ 是良态的。这证明了问题中的陈述。\n\n第 2 部分：增长因子 $\\rho$ 的计算\n增长因子定义为 $\\rho = \\frac{\\max_{i,j}|U_{ij}|}{\\max_{i,j}|A_{\\delta,ij}|}$。\n首先，我们找到 $A_{\\delta}$ 的最大绝对值元素：\n$$\nA_{\\delta} = \\begin{pmatrix} 10^{-8}  1 \\\\ 1  1 \\end{pmatrix}\n$$\n元素为 $\\delta = 10^{-8}$、$1$ 和 $1$。它们绝对值的最大值为 $\\max_{i,j}|A_{\\delta,ij}| = 1$。\n\n接下来，我们对 $A_{\\delta}$ 进行不带主元选取的高斯消去，以求得上三角矩阵 $U$。第一步是消去元素 $A_{\\delta,21}$。主元是 $A_{\\delta,11} = \\delta$。乘数是 $l_{21} = \\frac{A_{\\delta,21}}{A_{\\delta,11}} = \\frac{1}{\\delta}$。\n我们将第二行 $R_2$ 更新为 $R_2' = R_2 - l_{21} R_1$：\n$$\nR_2' = \\begin{pmatrix} 1  1 \\end{pmatrix} - \\frac{1}{\\delta} \\begin{pmatrix} \\delta  1 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\end{pmatrix} - \\begin{pmatrix} 1  \\frac{1}{\\delta} \\end{pmatrix} = \\begin{pmatrix} 0  1 - \\frac{1}{\\delta} \\end{pmatrix}\n$$\n得到的上三角矩阵 $U$ 是：\n$$\nU = \\begin{pmatrix} \\delta  1 \\\\ 0  1 - \\frac{1}{\\delta} \\end{pmatrix}\n$$\n现在，我们求 $\\delta = 10^{-8}$ 时 $U$ 的最大绝对值元素。$U$ 的元素是：\n$U_{11} = \\delta = 10^{-8}$\n$U_{12} = 1$\n$U_{21} = 0$\n$U_{22} = 1 - \\frac{1}{\\delta} = 1 - \\frac{1}{10^{-8}} = 1 - 10^8 = -99999999$\n\n非零元素的绝对值为 $|U_{11}| = 10^{-8}$、 $|U_{12}| = 1$ 和 $|U_{22}| = |1 - 10^8| = 10^8 - 1 = 99999999$。\n这些值的最大值为 $\\max_{i,j}|U_{ij}| = 10^8 - 1$。\n\n最后，我们计算增长因子 $\\rho$：\n$$\n\\rho = \\frac{\\max_{i,j}|U_{ij}|}{\\max_{i,j}|A_{\\delta,ij}|} = \\frac{10^8 - 1}{1} = 10^8 - 1\n$$\n这个巨大的增长因子表明，尽管矩阵是良态的，但由于小主元 $\\delta$ 的存在，不带主元选取的高斯消去过程是数值不稳定的，导致矩阵元素的量级急剧增加。这体现了主元选取策略的至关重要性。\n精确值为 $99999999$。", "answer": "$$\n\\boxed{10^{8} - 1}\n$$", "id": "2424543"}, {"introduction": "既然我们认识到了主元选择的必要性，那么应该如何选择主元呢？本练习将介绍两种常用的策略：部分主元法和缩放部分主元选择。部分主元法简单地选取当前列中绝对值最大的元素作为主元，而缩放部分主元选择通过考虑每行元素的相对大小，做出了更为精妙的选择。通过这个精心设计的例子 [@problem_id:1383197]，你将亲手计算并看到这两种策略会做出不同的主元决策，从而直观地理解为什么在某些情况下，缩放部分主元选择是更可靠的选择。", "problem": "在数值线性代数中，主元选取策略在执行矩阵分解（如下三角-上三角（LU）分解）时对于保持稳定性至关重要。考虑以下 $3 \\times 3$ 矩阵 $A$：\n\n$$\nA = \\begin{pmatrix}\n2  -20  50 \\\\\n-10  1  1000 \\\\\n5  1  -2\n\\end{pmatrix}\n$$\n\n我们将比较两种常见的主元选取策略，来为矩阵 $A$ 的LU分解选择第一个主元。“第一个主元”是在执行第一次行交换后，位于矩阵左上角位置的元素。\n\n1.  **部分主元法**：在第一步（针对第一列），找出第一列中绝对值最大的元素。将包含该元素的行与第一行交换。此时位于 $(1,1)$ 位置的元素即为主元。\n\n2.  **缩放部分主元选择**：首先，对于每一行 $i$，确定一个比例因子 $s_i$，该因子是该行中所有元素绝对值的最大值。然后，在第一步中，选择行索引 $p$（其中 $p \\in \\{1, 2, 3\\}$），使得比值 $\\frac{|a_{p1}|}{s_p}$ 最大化。将第 $p$ 行与第一行交换。此时位于 $(1,1)$ 位置的元素即为主元。\n\n令 $p_1$ 是使用部分主元法选出的第一个主元的值，令 $p_2$ 是使用缩放部分主元选择选出的第一个主元的值。\n\n以下哪个选项表示有序对 $(p_1, p_2)$？\n\nA. $(-10, 5)$\n\nB. $(5, -10)$\n\nC. $(2, 5)$\n\nD. $(-10, -10)$\n\nE. $(5, 5)$", "solution": "对于部分主元法，考察第一列的元素 $a_{11}=2$, $a_{21}=-10$, $a_{31}=5$。它们的绝对值分别为 $|2|=2$, $|-10|=10$, $|5|=5$。最大值为 $10$，在第二行，因此将第二行与第一行交换。新的 $(1,1)$ 元素（第一个主元）为 $p_{1}=-10$。\n\n对于缩放部分主元选择，计算每一行的比例因子 $s_{i}=\\max_{j}|a_{ij}|$：\n$$\ns_{1}=\\max\\{2,20,50\\}=50,\\quad s_{2}=\\max\\{10,1,1000\\}=1000,\\quad s_{3}=\\max\\{5,1,2\\}=5.\n$$\n计算比值 $\\frac{|a_{i1}|}{s_{i}}$：\n$$\n\\frac{|a_{11}|}{s_{1}}=\\frac{2}{50},\\quad \\frac{|a_{21}|}{s_{2}}=\\frac{10}{1000},\\quad \\frac{|a_{31}|}{s_{3}}=\\frac{5}{5}=1.\n$$\n最大比值为 $1$，在第三行，因此将第三行与第一行交换。新的 $(1,1)$ 元素（第一个主元）为 $p_{2}=5$。\n\n因此 $(p_{1},p_{2})=(-10,5)$，对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1383197"}, {"introduction": "为了更深入地理解不同主元策略对数值稳定性的影响，我们需要进行更全面的定量分析。这个练习要求你对同一个矩阵，分别使用部分主元法和缩放部分主元选择完整地执行高斯消元全过程。你不仅需要追踪行交换的差异，还需要计算出最终的上三角矩阵。通过计算和比较两种方法产生的增长因子 [@problem_id:2424512]，你将从量化的角度揭示主元选择如何直接影响整个分解过程的稳定性，从而巩固前两个练习建立的直观认识。", "problem": "在求解线性系统 $A\\boldsymbol{x}=\\boldsymbol{b}$ 的高斯消元法（GE）中，每一步主元行的选择对数值稳定性至关重要。两种标准策略是部分主元法（PP）和缩放部分主元选择（SPP）。在PP中，在第 $k$ 步，选择使 $|a_{ik}|$ 最大的行 $i\\geq k$ 作为主元，并将该行交换到位置 $k$。在SPP中，首先计算比例因子向量 $\\boldsymbol{s}$，其元素为 $s_i=\\max_{1\\leq j\\leq n}|a_{ij}|$，然后在第 $k$ 步，使用与原始行相关联的固定比例因子 $s_i$，选择使 $|a_{ik}|/s_i$ 最大的行 $i\\geq k$ 作为主元。\n\n考虑一个特地构造的矩阵\n$$\nA=\\begin{pmatrix}\n\\frac{1}{2}  1  1\\\\\n9  1  1\\\\\n10  1  1000\n\\end{pmatrix},\n$$\n其设计使得PP和SPP会做出不同的主元选择。仅从PP和SPP的定义以及高斯消元法的基本消元步骤出发，完成以下任务：\n\n1. 对于PP，执行高斯消元法，每一步根据列元素的最大绝对值选择主元。记录每一步主元选择时进行的行交换，并计算上三角因子 $U_{\\mathrm{PP}}$。\n2. 对于SPP，从原始矩阵 $A$ 计算一次比例因子向量 $\\boldsymbol{s}$，然后执行高斯消元法，每一步根据最大比率 $|a_{ik}|/s_i$ 选择主元。记录所进行的行交换，并计算上三角因子 $U_{\\mathrm{SPP}}$。\n3. 使用高斯消元法增长因子的定义，即比率 $\\rho=\\max_{i,j}|u_{ij}|\\,/\\,\\max_{i,j}|a_{ij}|$，计算与这两种策略相关的两个增长因子 $\\rho_{\\mathrm{PP}}$ 和 $\\rho_{\\mathrm{SPP}}$。\n4. 最后，计算单个实数\n$$\nr=\\frac{\\rho_{\\mathrm{PP}}}{\\rho_{\\mathrm{SPP}}}.\n$$\n\n将您对 $r$ 的最终答案表示为精确分数。不要四舍五入。不需要物理单位。", "solution": "首先将对问题陈述进行严格验证。\n\n步骤1：提取已知条件。\n已知条件如下：\n矩阵 $A$：\n$$\nA=\\begin{pmatrix}\n\\frac{1}{2}  1  1\\\\\n9  1  1\\\\\n10  1  1000\n\\end{pmatrix}\n$$\n部分主元法（PP）的定义：在第 $k$ 步，选择使 $|a_{ik}|$ 最大的行 $i \\geq k$ 作为主元行。\n缩放部分主元选择（SPP）的定义：在第 $k$ 步，选择使 $|a_{ik}|/s_i$ 最大的行 $i \\geq k$ 作为主元行，其中 $s_i = \\max_{1\\leq j\\leq n}|a_{ij}|$ 是从原始矩阵 $A$ 计算得出的。\n增长因子 $\\rho$ 的定义：\n$$\n\\rho = \\frac{\\max_{i,j}|u_{ij}|}{\\max_{i,j}|a_{ij}|}\n$$\n其中 $U$ 是最终的上三角矩阵。\n待计算的目标量是 $r = \\rho_{\\mathrm{PP}} / \\rho_{\\mathrm{SPP}}$。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，因为高斯消元法和主元选择策略是计算工程和数值分析中的基本概念。该问题是适定的；它提供了计算唯一解所需的所有数据和定义。其语言客观而精确。该问题是自洽的、一致的，并且需要直接应用所定义的算法。其表述没有缺陷。\n\n步骤3：结论与行动。\n问题有效。我们将继续进行完整解答。\n\n解答过程遵循指定的四个任务构建。\n\n1. 使用部分主元法（PP）的高斯消元\n\n我们从矩阵 $A$ 开始：\n$$\nA^{(0)} = \\begin{pmatrix}\n\\frac{1}{2}  1  1 \\\\\n9  1  1 \\\\\n10  1  1000\n\\end{pmatrix}\n$$\n步骤 $k=1$：我们检查第一列向量 $[ \\frac{1}{2}, 9, 10 ]^T$。绝对值最大的元素是 $a_{31} = 10$。因此，我们必须交换第1行和第3行。\n行交换为 $(R_1 \\leftrightarrow R_3)$。矩阵变为：\n$$\nA' = \\begin{pmatrix}\n10  1  1000 \\\\\n9  1  1 \\\\\n\\frac{1}{2}  1  1\n\\end{pmatrix}\n$$\n现在，我们进行消元。乘子是 $l_{21} = \\frac{9}{10}$ 和 $l_{31} = \\frac{1/2}{10} = \\frac{1}{20}$。\n第2行变为 $R_2 - l_{21} R_1$: $[9, 1, 1] - \\frac{9}{10} [10, 1, 1000] = [0, 1-\\frac{9}{10}, 1-900] = [0, \\frac{1}{10}, -899]$。\n第3行变为 $R_3 - l_{31} R_1$: $[\\frac{1}{2}, 1, 1] - \\frac{1}{20} [10, 1, 1000] = [0, 1-\\frac{1}{20}, 1-50] = [0, \\frac{19}{20}, -49]$。\n第一步之后的矩阵是：\n$$\nA^{(1)} = \\begin{pmatrix}\n10  1  1000 \\\\\n0  \\frac{1}{10}  -899 \\\\\n0  \\frac{19}{20}  -49\n\\end{pmatrix}\n$$\n步骤 $k=2$：我们检查从第2行开始的第二列。我们比较 $|a_{22}^{(1)}|=|\\frac{1}{10}|=0.1$ 和 $|a_{32}^{(1)}|=|\\frac{19}{20}|=0.95$。元素 $\\frac{19}{20}$ 的绝对值更大。因此，我们必须交换第2行和第3行。\n行交换为 $(R_2 \\leftrightarrow R_3)$。矩阵变为：\n$$\nA'' = \\begin{pmatrix}\n10  1  1000 \\\\\n0  \\frac{19}{20}  -49 \\\\\n0  \\frac{1}{10}  -899\n\\end{pmatrix}\n$$\n我们进行消元。乘子是 $l_{32} = \\frac{a_{32}''}{a_{22}''} = \\frac{1/10}{19/20} = \\frac{1}{10} \\cdot \\frac{20}{19} = \\frac{2}{19}$。\n第3行变为 $R_3 - l_{32} R_2$: $[0, \\frac{1}{10}, -899] - \\frac{2}{19} [0, \\frac{19}{20}, -49] = [0, \\frac{1}{10}-\\frac{1}{10}, -899 - \\frac{2}{19}(-49)] = [0, 0, -899 + \\frac{98}{19}]$。\n最终的元素是 $u_{33} = -899 + \\frac{98}{19} = \\frac{-899 \\cdot 19 + 98}{19} = \\frac{-17081 + 98}{19} = -\\frac{16983}{19}$。\nPP的上三角矩阵是：\n$$\nU_{\\mathrm{PP}} = \\begin{pmatrix}\n10  1  1000 \\\\\n0  \\frac{19}{20}  -49 \\\\\n0  0  -\\frac{16983}{19}\n\\end{pmatrix}\n$$\n在 $k=1$ 时行交换为 $(R_1 \\leftrightarrow R_3)$，在 $k=2$ 时行交换为 $(R_2 \\leftrightarrow R_3)$。\n\n2. 使用缩放部分主元选择（SPP）的高斯消元\n\n首先，我们从原始矩阵 $A$ 计算比例因子向量 $\\boldsymbol{s}$：\n$s_1 = \\max(|\\frac{1}{2}|, |1|, |1|) = 1$\n$s_2 = \\max(|9|, |1|, |1|) = 9$\n$s_3 = \\max(|10|, |1|, |1000|) = 1000$\n所以，$\\boldsymbol{s} = [1, 9, 1000]^T$。\n\n步骤 $k=1$：我们计算 $i=1, 2, 3$ 时的比率 $\\frac{|a_{i1}|}{s_i}$：\n对于第1行： $\\frac{|1/2|}{s_1} = \\frac{1/2}{1} = \\frac{1}{2} = 0.5$\n对于第2行： $\\frac{|9|}{s_2} = \\frac{9}{9} = 1$\n对于第3行： $\\frac{|10|}{s_3} = \\frac{10}{1000} = \\frac{1}{100} = 0.01$\n最大比率为 $1$，对应第2行。我们必须交换第1行和第2行。\n行交换为 $(R_1 \\leftrightarrow R_2)$。矩阵变为：\n$$\nA' = \\begin{pmatrix}\n9  1  1 \\\\\n\\frac{1}{2}  1  1 \\\\\n10  1  1000\n\\end{pmatrix}\n$$\n我们进行消元。乘子是 $l_{21} = \\frac{1/2}{9} = \\frac{1}{18}$ 和 $l_{31} = \\frac{10}{9}$。\n第2行变为 $R_2 - l_{21} R_1$: $[\\frac{1}{2}, 1, 1] - \\frac{1}{18} [9, 1, 1] = [0, 1-\\frac{1}{18}, 1-\\frac{1}{18}] = [0, \\frac{17}{18}, \\frac{17}{18}]$。\n第3行变为 $R_3 - l_{31} R_1$: $[10, 1, 1000] - \\frac{10}{9} [9, 1, 1] = [0, 1-\\frac{10}{9}, 1000-\\frac{10}{9}] = [0, -\\frac{1}{9}, \\frac{8990}{9}]$。\n第一步之后的矩阵是：\n$$\nA^{(1)} = \\begin{pmatrix}\n9  1  1 \\\\\n0  \\frac{17}{18}  \\frac{17}{18} \\\\\n0  -\\frac{1}{9}  \\frac{8990}{9}\n\\end{pmatrix}\n$$\n步骤 $k=2$：我们计算 $i=2, 3$ 时的比率 $\\frac{|a_{i2}^{(1)}|}{s_i'}$，其中 $s_i'$ 是现在位于位置2和3的原始行的比例因子。当前第2行是原始第1行（$s_1=1$），当前第3行是原始第3行（$s_3=1000$）。\n对于第2行： $\\frac{|17/18|}{s_1} = \\frac{17/18}{1} = \\frac{17}{18} \\approx 0.944$\n对于第3行： $\\frac{|-1/9|}{s_3} = \\frac{1/9}{1000} = \\frac{1}{9000} \\approx 0.00011$\n最大比率为 $\\frac{17}{18}$，对应当前第2行。不需要行交换。\n我们进行消元。乘子是 $l_{32} = \\frac{a_{32}^{(1)}}{a_{22}^{(1)}} = \\frac{-1/9}{17/18} = -\\frac{1}{9} \\cdot \\frac{18}{17} = -\\frac{2}{17}$。\n第3行变为 $R_3 - l_{32} R_2$: $[0, -\\frac{1}{9}, \\frac{8990}{9}] - (-\\frac{2}{17}) [0, \\frac{17}{18}, \\frac{17}{18}] = [0, -\\frac{1}{9}+\\frac{1}{9}, \\frac{8990}{9}+\\frac{1}{9}] = [0, 0, \\frac{8991}{9}]$。\n最终元素是 $u_{33} = \\frac{8991}{9} = 999$。\nSPP的上三角矩阵是：\n$$\nU_{\\mathrm{SPP}} = \\begin{pmatrix}\n9  1  1 \\\\\n0  \\frac{17}{18}  \\frac{17}{18} \\\\\n0  0  999\n\\end{pmatrix}\n$$\n唯一的行交换是在 $k=1$ 时的 $(R_1 \\leftrightarrow R_2)$。\n\n3. 增长因子的计算\n\n原始矩阵 $A$ 中的最大绝对值为 $\\max_{i,j}|a_{ij}| = |1000| = 1000$。\n\n对于PP：我们找到 $U_{\\mathrm{PP}}$ 中的最大绝对值。\n$$\nU_{\\mathrm{PP}} = \\begin{pmatrix}\n10  1  1000 \\\\\n0  \\frac{19}{20}  -49 \\\\\n0  0  -\\frac{16983}{19}\n\\end{pmatrix}\n$$\n元素为 $10$、$1$、$1000$、$\\frac{19}{20}=0.95$、$-49$ 和 $-\\frac{16983}{19}$。\n我们必须比较 $|1000|$ 和 $|-\\frac{16983}{19}|$。因为 $16983  19000$，我们有 $\\frac{16983}{19}  1000$。\n因此，$\\max_{i,j}|u_{ij}| = 1000$。\nPP的增长因子是：\n$$\n\\rho_{\\mathrm{PP}} = \\frac{\\max_{i,j}|u_{ij}|}{\\max_{i,j}|a_{ij}|} = \\frac{1000}{1000} = 1\n$$\n\n对于SPP：我们找到 $U_{\\mathrm{SPP}}$ 中的最大绝对值。\n$$\nU_{\\mathrm{SPP}} = \\begin{pmatrix}\n9  1  1 \\\\\n0  \\frac{17}{18}  \\frac{17}{18} \\\\\n0  0  999\n\\end{pmatrix}\n$$\n元素为 $9$、$1$、$1$、$\\frac{17}{18} \\approx 0.944$ 和 $999$。\n最大绝对值显然是 $\\max_{i,j}|u_{ij}| = 999$。\nSPP的增长因子是：\n$$\n\\rho_{\\mathrm{SPP}} = \\frac{\\max_{i,j}|u_{ij}|}{\\max_{i,j}|a_{ij}|} = \\frac{999}{1000}\n$$\n\n4. 最终比率计算\n\n最后，我们计算比率 $r$：\n$$\nr = \\frac{\\rho_{\\mathrm{PP}}}{\\rho_{\\mathrm{SPP}}} = \\frac{1}{\\frac{999}{1000}} = \\frac{1000}{999}\n$$\n这个结果展示了一个场景，其中更简单的部分主元法策略导致的增长因子略大于更复杂的比例部分主元法，后者正确地识别了具有不良比例的行并避免将其用作主元。", "answer": "$$\\boxed{\\frac{1000}{999}}$$", "id": "2424512"}]}