{"hands_on_practices": [{"introduction": "要真正掌握龙贝格积分，最好的方法就是亲手构建其核心的理查森外推表格。这个练习将指导你完成最开始的几步：首先使用复合梯形法则计算最初的几个近似值 $R_{k,1}$，然后执行第一次外推计算，得到更精确的估计值 $R_{2,2}$。通过这个基础计算 [@problem_id:2198730]，你将直观地体验到龙贝格算法如何系统性地消除误差，提高积分精度。", "problem": "龙贝格积分是一种数值方法，通过对梯形法则的结果应用理查森外推来估计函数的定积分。这些估计值被组织在一个称为龙贝格表的三角形阵列中，记为 $R_{k,j}$。第一列 $R_{k,1}$（对于 $k \\geq 1$）是使用具有 $n = 2^{k-1}$ 个子区间的复合梯形法则生成的。后续的项使用递推公式计算：\n$$R_{k,j} = R_{k,j-1} + \\frac{1}{4^{j-1} - 1}(R_{k,j-1} - R_{k-1,j-1}) \\quad \\text{for } k \\geq j \\geq 2.$$\n\n考虑多项式函数 $f(x) = 4x^3 - 3x^2 + 5$ 在区间 $[0, 2]$ 上的定积分。你的任务是手动计算该积分的龙贝格表的前三个条目。\n\n计算 $R_{1,1}$、$R_{2,1}$ 和 $R_{2,2}$ 的值。将你的答案表示为一个由三个数值 $(R_{1,1}, R_{2,1}, R_{2,2})$ 组成的行向量，并以精确整数形式表示。", "solution": "我们在区间 $[a,b]=[0,2]$ 上对 $f(x)=4x^{3}-3x^{2}+5$ 进行积分。具有 $n$ 个子区间，步长为 $h=\\frac{b-a}{n}$ 的复合梯形法则是\n$$\nT_{n}=\\frac{h}{2}\\left(f(a)+2\\sum_{i=1}^{n-1}f(a+ih)+f(b)\\right).\n$$\n根据定义，$R_{k,1}=T_{2^{\\,k-1}}$。\n\n对于 $R_{1,1}$，取 $n=1$，因此 $h=2$。计算 $f(0)=5$ 和 $f(2)=4\\cdot 2^{3}-3\\cdot 2^{2}+5=32-12+5=25$。那么\n$$\nR_{1,1}=T_{1}=\\frac{2}{2}\\left(f(0)+f(2)\\right)=1\\cdot(5+25)=30.\n$$\n\n对于 $R_{2,1}$，取 $n=2$，因此 $h=1$，节点为 $0,1,2$。计算 $f(1)=4-3+5=6$。那么\n$$\nR_{2,1}=T_{2}=\\frac{1}{2}\\left(f(0)+2f(1)+f(2)\\right)=\\frac{1}{2}\\left(5+2\\cdot 6+25\\right)=\\frac{42}{2}=21.\n$$\n\n龙贝格外推使用\n$$\nR_{k,j}=R_{k,j-1}+\\frac{1}{4^{\\,j-1}-1}\\left(R_{k,j-1}-R_{k-1,j-1}\\right), \\quad k\\geq j\\geq 2.\n$$\n因此，\n$$\nR_{2,2}=R_{2,1}+\\frac{1}{4^{1}-1}\\left(R_{2,1}-R_{1,1}\\right)=21+\\frac{1}{3}(21-30)=21-\\frac{9}{3}=18.\n$$\n\n作为一致性检验，精确积分为\n$$\n\\int_{0}^{2}\\left(4x^{3}-3x^{2}+5\\right)\\,dx=\\left(x^{4}-x^{3}+5x\\right)\\bigg|_{0}^{2}=16-8+10=18,\n$$\n与 $R_{2,2}$ 的值一致，这对于三次多项式是符合预期的。", "answer": "$$\\boxed{\\begin{pmatrix}30  21  18\\end{pmatrix}}$$", "id": "2198730"}, {"introduction": "龙贝格积分不仅是一个迭代改进的过程，其表格中的特定项也与其他经典的数值积分方法有着深刻的联系。在本练习中，你将发现 $R_{2,2}$ 估计值实际上等同于辛普森法则的结果。通过对一个三次多项式进行积分 [@problem_id:2198741]，你将亲自验证该方法对于这类函数能够得出精确解，从而揭示龙贝格积分高效率背后的一个重要理论依据。", "problem": "龙贝格积分是一种用于估算定积分 $I = \\int_{a}^{b} f(x) \\, dx$ 的算法。该方法生成一个估算值的三角阵列，记作 $R_{k,j}$，其中 $k$ 是行索引，$j$ 是列索引，且 $k \\ge 1$ 和 $j \\ge 1$。该过程始于使用复合梯形法则的初始估算。龙贝格表的第一列 $R_{k,1}$ 对应于具有 $n=2^{k-1}$ 个子区间的复合梯形法则。对于 $k \\ge 2$，使用理查森外推公式生成后续更精确的估算值：\n\n$$R_{k,j} = R_{k, j-1} + \\frac{R_{k,j-1} - R_{k-1, j-1}}{4^{j-1} - 1} \\quad \\text{for } j \\ge 2$$\n\n考虑函数 $f(x) = x^3$ 在区间 $[1, 3]$ 上的定积分。您的任务是计算该积分的龙贝格积分估算值 $R_{2,2}$。将您的最终答案报告为一个实数。", "solution": "我们应用龙贝格积分，其中第一列 $R_{k,1}$ 由函数 $f(x)=x^{3}$ 在 $[a,b]=[1,3]$ 上，使用具有 $n=2^{k-1}$ 个子区间的复合梯形法则估算值组成。具有 $n$ 个子区间和步长 $h=\\frac{b-a}{n}$ 的复合梯形法则是\n$$\nT_{n}=h\\left(\\frac{1}{2}f(a)+\\sum_{i=1}^{n-1}f(a+ih)+\\frac{1}{2}f(b)\\right).\n$$\n对于 $k=1$，我们有 $n=2^{0}=1$，因此步长 $h=\\frac{3-1}{1}=2$，并且\n$$\nR_{1,1}=T_{1}=2\\left(\\frac{f(1)+f(3)}{2}\\right)=2\\left(\\frac{1^{3}+3^{3}}{2}\\right)=2\\left(\\frac{1+27}{2}\\right)=28.\n$$\n对于 $k=2$，我们有 $n=2^{1}=2$，因此步长 $h=\\frac{3-1}{2}=1$，并且\n$$\nR_{2,1}=T_{2}=1\\left(\\frac{1}{2}f(1)+f(2)+\\frac{1}{2}f(3)\\right)=\\frac{1}{2}\\cdot 1^{3}+2^{3}+\\frac{1}{2}\\cdot 3^{3}=\\frac{1}{2}+8+\\frac{27}{2}=22.\n$$\n龙贝格外推法使用\n$$\nR_{k,j}=R_{k,j-1}+\\frac{R_{k,j-1}-R_{k-1,j-1}}{4^{j-1}-1}, \\quad j\\ge 2.\n$$\n对于 $k=2, j=2$，\n$$\nR_{2,2}=R_{2,1}+\\frac{R_{2,1}-R_{1,1}}{4^{1}-1}=22+\\frac{22-28}{3}=22-\\frac{6}{3}=20.\n$$\n因此，龙贝格估算值 $R_{2,2}$ 等于 $20$，这与精确积分 $\\int_{1}^{3}x^{3}\\,dx=\\left.\\frac{x^{4}}{4}\\right|_{1}^{3}=\\frac{81-1}{4}=20$ 的值相符。", "answer": "$$\\boxed{20}$$", "id": "2198741"}, {"introduction": "一个强大的工具同样有其适用边界，理解这些边界是成为一名优秀科学计算实践者的关键。这个练习将挑战你从计算转向概念分析，探讨当被积函数不具备足够的光滑性时，龙贝格积分为何会失效。通过分析函数 $|x|$ 在原点的“尖点”如何破坏理查森外推的理论基础 [@problem_id:2435348]，你将深刻理解为何被积函数的性质是决定数值方法成败的先决条件。", "problem": "考虑应用龙贝格积分（在步长为 $h, h/2, h/4, \\ldots$ 的复合梯形法则基础上构建的逐次 Richardson 外推）来计算定积分 $\\int_{-1}^{1} |x| \\, dx$。在 $N$ 个子区间的均匀网格上，复合梯形法则的步长为 $h = \\frac{2}{N}$。你的任务是，从被积函数的可微性以及复合梯形法则的结构出发，论证龙贝格积分对此积分是否以及为何能或不能加速收敛。\n\n哪个陈述最好地解释了这种行为？\n\nA. 被积函数 $|x|$ 在 $x=0$ 处不可微，因此龙贝格积分所假设的偶次幂误差展开不成立。对于复合梯形法则，全局误差与奇偶性相关：当 $N$ 为奇数时（尖点严格位于某个小区间内部），误差为 $E_N = \\frac{h^2}{4}$；当 $N$ 为偶数时（尖点与一个节点重合，每个小区间内看到的都是线性函数），误差为 $E_N = 0$。由于首项误差系数在步长细化过程中不是一个固定的常数，从 $h$ 到 $h/2$ 的第一次 Richardson 外推可能会产生一个远离精确积分值的结果。\n\nB. 龙贝格积分失败，因为该积分是反常积分且在 $x=0$ 处发散，所以任何求积法则都无法有意义地应用。\n\nC. 龙贝格积分失败，因为 $|x|$ 在对称区间上是一个奇函数，在 $x=0$ 附近的抵消使得外推过程无效。\n\nD. 如果初始步长 $h$ 足够小，龙贝格积分将会成功；对于足够小的 $h$，$x=0$ 处的尖点实际上会消失，从而恢复龙贝格积分所需要的光滑偶次幂误差展开。\n\nE. 龙贝格积分失败，因为复合梯形法则全局仅具有一阶精度，因此无论光滑性如何，偶次幂的 Richardson 外推都不适用。", "solution": "该问题要求分析龙贝格积分对定积分 $I = \\int_{-1}^{1} |x| \\, dx$ 的性能。分析的核心在于龙贝格积分的理论基础以及被积函数 $f(x) = |x|$ 的性质。\n\n首先，我们确定该积分的精确值。被积函数 $f(x) = |x|$ 是一个偶函数，因此在对称区间 $[-1, 1]$ 上的积分可以计算为：\n$$ I = \\int_{-1}^{1} |x| \\, dx = 2 \\int_{0}^{1} x \\, dx = 2 \\left[ \\frac{x^2}{2} \\right]_{0}^{1} = 2 \\left( \\frac{1^2}{2} - \\frac{0^2}{2} \\right) = 1 $$\n积分的精确值为 $1$。\n\n接下来，我们分析龙贝格积分的基础。龙贝格积分是一种使用理查森外推来加速复合梯形法则收敛的方法。对于积分 $I$，步长为 $h$ 的复合梯形法则近似值 $T(h)$ 具有由欧拉-麦克劳林公式给出的渐近误差展开：\n$$ T(h) = I + C_1 h^2 + C_2 h^4 + C_3 h^6 + \\dots $$\n这个展开式成立的前提是被积函数 $f(x)$ 在积分区间 $[a, b]$ 上足够光滑（即具有足够多的连续导数）。具体来说，为了使展开式只包含 $h$ 的偶次幂，被积函数及其所有奇数阶导数必须在端点 $a$ 和 $b$ 处为零，或者函数是周期为 $b-a$ 的周期函数。对于一般的非周期函数，展开式为 $T(h) = I + C_1 h^2 + C_2 h^4 + \\dots + K_p h^{2p} + O(h^{2p+2})$，这要求被积函数至少属于 $C^{2p+2}[a, b]$ 类。\n\n本题中的被积函数是 $f(x) = |x|$。这个函数处处连续。然而，它的一阶导数是符号函数 $f'(x) = \\text{sgn}(x)$，在 $x=0$ 处有一个跳跃间断点。\n$$ f'(x) = \\begin{cases} -1  x  0 \\\\ 1  x > 0 \\end{cases} $$\n由于 $f'(x)$ 在 $x=0$ 处不连续，函数 $f(x)=|x|$ 不属于 $C^1[-1, 1]$ 类。因此，它也不属于 $C^2[-1, 1]$ 类。标准的欧拉-麦克劳林误差展开所需的基本光滑性要求被违反了。复合梯形法则的误差将不具有仅含 $h$ 的偶次幂的形式，因此，龙贝格积分的前提不成立。\n\n我们现在必须分析复合梯形法则对于这个特定被积函数的具体行为。该法则应用于 $[-1, 1]$ 上的 $N$ 个子区间的均匀网格，步长为 $h = \\frac{2}{N}$，节点为 $x_k = -1 + k h$（$k=0, 1, \\dots, N$）。其行为关键取决于不可微点 $x=0$ 是否是一个网格节点。\n\n情况1：$N$ 为偶数。\n设 $N=2m$，其中 $m \\ge 1$ 为整数。步长为 $h = \\frac{2}{2m} = \\frac{1}{m}$。网格节点为 $x_k = -1 + \\frac{k}{m}$。对应于 $k=m$ 的节点是 $x_m = -1 + \\frac{m}{m} = 0$。因此，当 $N$ 为偶数时，不可微点 $x=0$ 总是一个网格节点。复合梯形法则将每个子区间上的结果相加。在 $[-1, 0]$ 内的子区间中，被积函数是 $f(x)=-x$，是一个线性函数。在 $[0, 1]$ 内的子区间中，被积函数是 $f(x)=x$，也是一个线性函数。梯形法则对于线性函数是精确的（其误差项涉及被积函数的二阶导数，而线性函数的二阶导数为零）。因此，对于每个子区间，近似都是精确的，计算出的总积分也是精确的。当 $N$ 为偶数时，误差 $E_N = T_N - I = 0$。\n\n情况2：$N$ 为奇数。\n设 $N=2m+1$，其中 $m \\ge 0$ 为整数。步长为 $h = \\frac{2}{2m+1}$。网格节点为 $x_k = -1 + k \\frac{2}{2m+1}$。若 $x_k=0$，则需要 $-1 + k \\frac{2}{2m+1} = 0$，这意味着 $k = \\frac{2m+1}{2}$。这永远不是整数。因此，当 $N$ 为奇数时，$x=0$ 点总是严格落在一个子区间内部。这个子区间是 $[x_m, x_{m+1}]$，其中 $x_m = -1 + m h = \\frac{-(2m+1)+2m}{2m+1} = \\frac{-1}{2m+1}$ 且 $x_{m+1} = -1 + (m+1)h = \\frac{-(2m+1)+2m+2}{2m+1} = \\frac{1}{2m+1}$。注意，这个区间关于 $0$ 对称，长度为 $h$。复合梯形法则的误差完全来自这一个子区间，因为在所有其他子区间上被积函数都是线性的。\n这个子区间的梯形近似值为：\n$$ T_{[x_m, x_{m+1}]} = \\frac{h}{2} (f(x_m) + f(x_{m+1})) = \\frac{h}{2} \\left(\\left|\\frac{-1}{2m+1}\\right| + \\left|\\frac{1}{2m+1}\\right|\\right) = \\frac{h}{2} \\left(\\frac{1}{2m+1} + \\frac{1}{2m+1}\\right) = \\frac{h}{2} \\left(\\frac{2}{2m+1}\\right) = \\frac{h^2}{2} $$\n在这个子区间上的精确积分为：\n$$ I_{[x_m, x_{m+1}]} = \\int_{-1/(2m+1)}^{1/(2m+1)} |x|\\, dx = 2 \\int_0^{1/(2m+1)} x\\, dx = \\left[x^2\\right]_0^{1/(2m+1)} = \\left(\\frac{1}{2m+1}\\right)^2 = \\left(\\frac{h}{2}\\right)^2 = \\frac{h^2}{4} $$\n这个子区间的误差，也就是总误差 $E_N$，是 $E_N = T_{[x_m, x_{m+1}]} - I_{[x_m, x_{m+1}]} = \\frac{h^2}{2} - \\frac{h^2}{4} = \\frac{h^2}{4}$。当 $N$ 为奇数时，$E_N = \\frac{h^2}{4} \\ne 0$。\n\n理查森外推法假设误差为 $E(h) = C h^2 + O(h^4)$，其中 $C$ 是一个常数。我们的分析表明，误差序列是：当 $N$ 为奇数时 $E_N=h^2/4$，当 $N$ 为偶数时 $E_N=0$。当步长减半（$h \\to h/2$）时，区间数量加倍（$N \\to 2N$），如果 $N$ 是奇数，这会改变 $N$ 的奇偶性。这意味着误差项中的“常数”$C$ 并不是常数，而是交替变化的。这使得外推法失效。例如，如果我们从一个奇数 $N_0$（误差 $\\sim h_0^2/4$）开始，然后到 $N_1=2N_0$（误差为 $0$），外推会产生一个很差的结果。\n\n现在，我们评估每个选项。\n\nA. 被积函数 $|x|$ 在 $x=0$ 处不可微，因此龙贝格积分所假设的偶次幂误差展开不成立。对于复合梯形法则，全局误差与奇偶性相关：当 $N$ 为奇数时（尖点严格位于某个小区间内部），误差为 $E_N = \\frac{h^2}{4}$；当 $N$ 为偶数时（尖点与一个节点重合，每个小区间内看到的都是线性函数），误差为 $E_N = 0$。由于首项误差系数在步长细化过程中不是一个固定的常数，从 $h$ 到 $h/2$ 的第一次 Richardson 外推可能会产生一个远离精确积分值的结果。\n这个陈述是我们推导的完美总结。其中提出的每一个论点都是正确的：不可微性、误差展开的失效、梯形法则误差的奇偶性依赖（奇数 $N$ 时 $E_N=h^2/4$，偶数 $N$ 时 $E_N=0$）、非常数的误差系数，以及由此导致的外推失败。\n结论：**正确**。\n\nB. 龙贝格积分失败，因为该积分是反常积分且在 $x=0$ 处发散，所以任何求积法则都无法有意义地应用。\n积分 $\\int_{-1}^{1} |x| \\, dx$ 是一个正常的定积分。被积函数 $|x|$ 在有限区间 $[-1, 1]$ 上是连续且有界的。该积分收敛到 $1$。该陈述在事实上是错误的。\n结论：**不正确**。\n\nC. 龙贝格积分失败，因为 $|x|$ 在对称区间上是一个奇函数，在 $x=0$ 附近的抵消使得外推过程无效。\n函数 $f(x)=|x|$ 是一个偶函数，因为 $f(-x) = |-x| = |x| = f(x)$。该陈述的前提是错误的。\n结论：**不正确**。\n\nD. 如果初始步长 $h$ 足够小，龙贝格积分将会成功；对于足够小的 $h$，$x=0$ 处的尖点实际上会消失，从而恢复龙贝格积分所需要的光滑偶次幂误差展开。\n$x=0$ 处的不可微性是函数 $|x|$ 的内在属性。它在任何尺度下都不会消失。减小步长 $h$ 不会使函数更光滑，也不会恢复所需的误差展开。依赖于奇偶性的误差行为与 $h$ 的尺度无关，始终存在。\n结论：**不正确**。\n\nE. 龙贝格积分失败，因为复合梯形法则全局仅具有一阶精度，因此无论光滑性如何，偶次幂的 Richardson 外推都不适用。\n对于足够光滑（$C^2$）的函数，复合梯形法则是二阶精度（$O(h^2)$）的，而不是一阶。在这种情况下，龙贝格积分的失败恰恰是由于光滑性问题，而该陈述却忽略了这一点。该陈述的前提是错误的。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2435348"}]}