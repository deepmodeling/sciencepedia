{"hands_on_practices": [{"introduction": "构建三次样条插值的核心在于确定节点上的二阶导数值。这个练习将引导你完成这一关键步骤，通过为一个简单的三点数据集建立并求解一个线性方程，从而计算出内部节点的二阶导数。掌握这个基础计算是理解样条如何实现其标志性平滑度的第一步。 [@problem_id:2164958]", "problem": "函数 $S(x)$ 是一个插值一组数据点的自然三次样条。根据定义，三次样条是由三次多项式组成的分段函数，它本身及其一阶和二阶导数都是连续的。“自然”三次样条具有一个附加属性，即其二阶导数在插值区间的两个端点处为零。\n\n考虑一个通过以下三个数据点的自然三次样条 $S(x)$：$(x_0, y_0) = (0, 0)$，$(x_1, y_1) = (1, 1)$ 和 $(x_2, y_2) = (2, 0)$。\n\n计算该样条在 $x=1$ 处的二阶导数值，记为 $S''(1)$。", "solution": "令 $x_{0}=0$，$x_{1}=1$，$x_{2}=2$ 且 $y_{0}=0$，$y_{1}=1$，$y_{2}=0$。对于自然三次样条，其在节点处的二阶导数 $M_{i}=S''(x_{i})$ 满足 $M_{0}=0$ 和 $M_{2}=0$，内部方程为\n$$\nh_{i-1}M_{i-1}+2(h_{i-1}+h_{i})M_{i}+h_{i}M_{i+1}\n=6\\left(\\frac{y_{i+1}-y_{i}}{h_{i}}-\\frac{y_{i}-y_{i-1}}{h_{i-1}}\\right),\n$$\n对于 $i=1,\\ldots,n-1$，其中 $h_{i}=x_{i+1}-x_{i}$。这里 $h_{0}=x_{1}-x_{0}=1$ 且 $h_{1}=x_{2}-x_{1}=1$，并且在 $i=1$ 处有一个唯一的内部方程：\n$$\n1\\cdot M_{0}+2(1+1)M_{1}+1\\cdot M_{2}\n=6\\left(\\frac{y_{2}-y_{1}}{1}-\\frac{y_{1}-y_{0}}{1}\\right).\n$$\n代入 $M_{0}=0$，$M_{2}=0$，$y_{2}-y_{1}=0-1=-1$ 和 $y_{1}-y_{0}=1-0=1$ 可得\n$$\n4M_{1}=6(-1-1)=6(-2)=-12,\n$$\n因此\n$$\nM_{1}=-3.\n$$\n所以 $S''(1)=M_{1}=-3$。", "answer": "$$\\boxed{-3}$$", "id": "2164958"}, {"introduction": "样条插值不仅仅是连接数据点，更是以一种平滑的方式进行连接。本练习通过对比分段线性插值和自然三次样条插值，直观地展示了二者的区别。通过计算同一个点在两种模型下的预测值，你将亲身体会到样条在模拟物理系统（如柔性杆的弯曲）等场景中的优势。 [@problem_id:2164998]", "problem": "一位工程师正在为一个细柔性杆的形状建模，该杆被约束在二维笛卡尔平面上，必须穿过三个点：$P_0=(-1, 1)$、$P_1=(0, 0)$ 和 $P_2=(1, 1)$。提出了两种简单的模型来估计杆在其他水平位置 $x$ 处的垂直位置 $y$。\n\n模型A是分段线性插值，它用直线段连接指定的点。\n模型B是自然三次样条，它通过在内部点匹配一阶和二阶导数来确保曲线平滑，并在端点处具有零二阶导数。\n\n计算模型A和模型B预测的杆在 $x=0.5$ 处的垂直位置。令这些值分别为 $y_A$ 和 $y_B$。将你的答案以一对精确分数 $(y_A, y_B)$ 的形式表示。", "solution": "我们将节点标记为 $x_{0}=-1$、$x_{1}=0$、$x_{2}=1$，对应的值为 $y_{0}=1$、$y_{1}=0$、$y_{2}=1$。\n\n模型A（分段线性插值）：对于 $x \\in [x_{1},x_{2}]$，通过 $(0,0)$ 和 $(1,1)$ 的直线的斜率为\n$$\nm=\\frac{y_{2}-y_{1}}{x_{2}-x_{1}}=\\frac{1-0}{1-0}=1,\n$$\n所以插值函数为\n$$\ny(x)=y_{1}+m(x-x_{1})=0+1\\cdot(x-0)=x.\n$$\n在 $x=\\frac{1}{2}$ 处求值得\n$$\ny_{A}=y\\!\\left(\\frac{1}{2}\\right)=\\frac{1}{2}.\n$$\n\n模型B（自然三次样条）：令 $M_{i}=S''(x_{i})$。自然边界条件给出 $M_{0}=0$ 和 $M_{2}=0$。当 $h_{0}=x_{1}-x_{0}=1$ 且 $h_{1}=x_{2}-x_{1}=1$ 时，在内部节点 $i=1$ 处的三次样条方程组为\n$$\nh_{0}M_{0}+2(h_{0}+h_{1})M_{1}+h_{1}M_{2}=6\\left(\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}\\right).\n$$\n代入数值，\n$$\n1\\cdot 0+2(1+1)M_{1}+1\\cdot 0=6\\left(\\frac{1-0}{1}-\\frac{0-1}{1}\\right)=6(1-(-1))=12,\n$$\n所以\n$$\n4M_{1}=12 \\quad \\Rightarrow \\quad M_{1}=3.\n$$\n在区间 $[x_{1},x_{2}]=[0,1]$ 上，样条函数为\n$$\nS(x)=\\frac{M_{1}}{6h_{1}}(x_{2}-x)^{3}+\\frac{M_{2}}{6h_{1}}(x-x_{1})^{3}+\\left(y_{1}-\\frac{M_{1}h_{1}^{2}}{6}\\right)\\frac{x_{2}-x}{h_{1}}+\\left(y_{2}-\\frac{M_{2}h_{1}^{2}}{6}\\right)\\frac{x-x_{1}}{h_{1}}.\n$$\n当 $h_{1}=1$、$M_{1}=3$、$M_{2}=0$、$y_{1}=0$ 且 $y_{2}=1$ 时，上式简化为\n$$\nS(x)=\\frac{3}{6}(1-x)^{3}+0+\\left(0-\\frac{3}{6}\\right)(1-x)+\\left(1-0\\right)x\n=\\frac{1}{2}(1-x)^{3}-\\frac{1}{2}(1-x)+x.\n$$\n展开并合并同类项，\n$$\nS(x)=\\frac{1}{2}-\\frac{3}{2}x+\\frac{3}{2}x^{2}-\\frac{1}{2}x^{3}-\\frac{1}{2}+\\frac{1}{2}x+x\n=\\frac{3}{2}x^{2}-\\frac{1}{2}x^{3}.\n$$\n在 $x=\\frac{1}{2}$ 处求值得\n$$\ny_{B}=S\\!\\left(\\frac{1}{2}\\right)=\\frac{3}{2}\\left(\\frac{1}{2}\\right)^{2}-\\frac{1}{2}\\left(\\frac{1}{2}\\right)^{3}\n=\\frac{3}{2}\\cdot\\frac{1}{4}-\\frac{1}{2}\\cdot\\frac{1}{8}\n=\\frac{3}{8}-\\frac{1}{16}\n=\\frac{5}{16}.\n$$\n\n因此，所求的数对为 $\\left(\\frac{1}{2},\\frac{5}{16}\\right)$。", "answer": "$$\\boxed{\\left(\\frac{1}{2}, \\frac{5}{16}\\right)}$$", "id": "2164998"}, {"introduction": "一个优秀的数学模型应该在简单情况下能够退化为我们熟悉的结果。这个练习旨在验证自然三次样条插值是否具备这一特性。当所有数据点都精确地位于一条直线上时，最合理的插值结果显然就是这条直线本身。通过求解这个问题，你将证明自然三次样条确实能够重现线性关系，从而增强你对该方法可靠性的信心。 [@problem_id:2164972]", "problem": "构建一个自然三次样条 $S(x)$，用于插值三个数据点 $P_0=(x_0, y_0)$、$P_1=(x_1, y_1)$ 和 $P_2=(x_2, y_2)$。这些点的x坐标给定为 $x_0 = 1$、$x_1 = 3$ 和 $x_2 = 5$。这三个点都位于方程 $y = 5x + 3$ 定义的直线上。\n\n该样条由两个三次多项式段组成，$S_0(x)$ 用于区间 $[1, 3]$，$S_1(x)$ 用于区间 $[3, 5]$，定义如下：\n$$S(x) = \\begin{cases} S_0(x) = a_0 + b_0(x-1) + c_0(x-1)^2 + d_0(x-1)^3  \\text{for } x \\in [1, 3] \\\\ S_1(x) = a_1 + b_1(x-3) + c_1(x-3)^2 + d_1(x-3)^3  \\text{for } x \\in [3, 5] \\end{cases}$$\n“自然”样条一词指的是边界条件，即样条的二阶导数在端点处为零，即 $S''(x_0) = 0$ 且 $S''(x_2) = 0$。\n\n确定系数 $b_1$ 的数值。", "solution": "由于这些点位于直线 $y=5x+3$ 上，因此数据点为 $(x_{0},y_{0})=(1,8)$、$(x_{1},y_{1})=(3,18)$ 和 $(x_{2},y_{2})=(5,28)$。\n\n写出样条段及其导数：\n$$S_{0}(x)=a_{0}+b_{0}(x-1)+c_{0}(x-1)^{2}+d_{0}(x-1)^{3}, \\quad S_{1}(x)=a_{1}+b_{1}(x-3)+c_{1}(x-3)^{2}+d_{1}(x-3)^{3}.$$\n于是\n$$S_{0}'(x)=b_{0}+2c_{0}(x-1)+3d_{0}(x-1)^{2}, \\quad S_{0}''(x)=2c_{0}+6d_{0}(x-1),$$\n$$S_{1}'(x)=b_{1}+2c_{1}(x-3)+3d_{1}(x-3)^{2}, \\quad S_{1}''(x)=2c_{1}+6d_{1}(x-3).$$\n\n自然边界条件给出\n$$S_{0}''(1)=0 \\implies 2c_{0}=0 \\implies c_{0}=0,$$\n$$S_{1}''(5)=0 \\implies 2c_{1}+6d_{1}\\cdot 2=0 \\implies c_{1}=-6d_{1}.$$\n\n插值条件得出\n$$S_{0}(1)=y_{0} \\implies a_{0}=8,$$\n$$S_{0}(3)=y_{1} \\implies a_{0}+2b_{0}+4c_{0}+8d_{0}=18 \\implies 8+2b_{0}+0+8d_{0}=18 \\implies b_{0}+4d_{0}=5,$$\n$$S_{1}(3)=y_{1} \\implies a_{1}=18,$$\n$$S_{1}(5)=y_{2} \\implies a_{1}+2b_{1}+4c_{1}+8d_{1}=28.$$\n将 $a_{1}=18$ 和 $c_{1}=-6d_{1}$ 代入最后一个方程，得到\n$$18+2b_{1}+4(-6d_{1})+8d_{1}=28 \\implies 2b_{1}-16d_{1}=10 \\implies b_{1}-8d_{1}=5.$$\n\n在 $x=3$ 处的 $C^{1}$ 和 $C^{2}$ 连续性条件给出\n$$S_{0}'(3)=S_{1}'(3) \\implies b_{0}+2c_{0}\\cdot 2+3d_{0}\\cdot 4=b_{1} \\implies b_{0}+12d_{0}=b_{1},$$\n$$S_{0}''(3)=S_{1}''(3) \\implies 2c_{0}+6d_{0}\\cdot 2=2c_{1} \\implies 12d_{0}=2(-6d_{1}) \\implies d_{0}=-d_{1}.$$\n\n将 $d_{1}=-d_{0}$ 代入 $b_{1}-8d_{1}=5$ 得到\n$$b_{1}+8d_{0}=5.$$\n使用 $b_{1}=b_{0}+12d_{0}$，我们得到\n$$b_{0}+12d_{0}+8d_{0}=5 \\implies b_{0}+20d_{0}=5.$$\n结合 $b_{0}+4d_{0}=5$，两式相减得出\n$$(b_{0}+20d_{0})-(b_{0}+4d_{0})=5-5 \\implies 16d_{0}=0 \\implies d_{0}=0.$$\n因此 $d_{1}=-d_{0}=0$，然后从 $b_{0}+4d_{0}=5$ 可得 $b_{0}=5$，最后\n$$b_{1}=b_{0}+12d_{0}=5.$$", "answer": "$$\\boxed{5}$$", "id": "2164972"}]}