{"hands_on_practices": [{"introduction": "我们将从一个线性常微分方程（ODE）的基础案例开始。这个练习将向你展示隐式方法中最核心的代数步骤：如何重新整理方程，以求解未知的未来状态 $y_{n+1}$。掌握这一步对于理解和实现这些方法至关重要。[@problem_id:2178584]", "problem": "在计算物理中，许多问题需要对常微分方程（ODE）进行数值求解。考虑一个电子元件温度 $y(t)$ 随时间变化的简化模型。其温度的变化率由以下线性一阶常微分方程描述：\n$$ \\frac{dy}{dt} = ay + b $$\n其中 $y_n$ 表示在时间 $t_n$ 时的已知温度，$a$ 和 $b$ 是由该元件的物理特性及其环境决定的实数常数。\n\n为了对解进行数值近似，我们可以使用一种隐式方法。隐式中点法则是这样一种方法，它使用以下公式计算下一个时间步 $y_{n+1} = y(t_n + h)$ 的状态：\n$$ y_{n+1} = y_n + h f\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right) $$\n此处，$h$ 是恒定的时间步长，$f(t,y)$ 是定义该常微分方程的函数，即 $f(t,y) = \\frac{dy}{dt}$。\n\n将隐式中点法则应用于给定的常微分方程，进行单步计算，推导出用 $y_n$、$h$、$a$ 和 $b$ 表示 $y_{n+1}$ 的显式解析表达式。", "solution": "我们从常微分方程 $ \\frac{dy}{dt} = a y + b $ 开始，并应用隐式中点法则\n$$\ny_{n+1} = y_n + h f\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right).\n$$\n此处 $f(t,y) = a y + b$ 是自治的（不依赖于 $t$），因此\n$$\nf\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right) = a \\left(\\frac{y_n + y_{n+1}}{2}\\right) + b.\n$$\n将其代入更新公式可得\n$$\ny_{n+1} = y_n + h \\left[ a \\left(\\frac{y_n + y_{n+1}}{2}\\right) + b \\right].\n$$\n展开并合并含 $y_{n+1}$ 的项，\n$$\ny_{n+1} = y_n + \\frac{a h}{2} y_n + \\frac{a h}{2} y_{n+1} + h b,\n$$\n这意味着\n$$\n\\left(1 - \\frac{a h}{2}\\right) y_{n+1} = \\left(1 + \\frac{a h}{2}\\right) y_n + h b.\n$$\n解出 $y_{n+1}$ 可得到显式解析表达式\n$$\ny_{n+1} = \\frac{\\left(1 + \\frac{a h}{2}\\right) y_n + h b}{1 - \\frac{a h}{2}}.\n$$", "answer": "$$\\boxed{\\frac{\\left(1 + \\frac{a h}{2}\\right) y_n + h b}{1 - \\frac{a h}{2}}}$$", "id": "2178584"}, {"introduction": "现实世界中的问题往往是非线性的。这个练习将概念延伸到经典的非线性模型——逻辑斯谛增长方程。你会发现，在这种情况下应用隐式方法，需要在每个时间步求解一个非线性代数方程，这正是它与显式方法的一个关键区别。[@problem_id:2178610]", "problem": "在计算科学中，逻辑斯蒂增长模型是研究种群动态的一个常见例子。该模型由一阶常微分方程(ODE) $P'(t) = r P(t) \\left(1 - \\frac{P(t)}{K}\\right)$ 描述，其中 $P(t)$ 是时间 $t$ 时的种群数量，$r > 0$ 是内禀增长率，$K > 0$ 是环境承载能力。\n\n为了对解进行数值近似，我们可以使用一种隐式方法，如后向欧拉法。我们用恒定的步长 $h > 0$ 将时间离散化，令 $t_n = n h$。在时间 $t_n$ 的种群数量的数值近似值记为 $P_n$。对于一般形式为 $y' = f(t, y)$ 的常微分方程，后向欧拉法由公式 $y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})$ 给出。\n\n当该方法应用于逻辑斯蒂方程时，会在每个时间步得到一个关于 $P_{n+1}$ 的非线性代数方程。你的任务是解这个方程，以找到用已知的先前状态 $P_n$ 和参数 $h, r, K$ 表示 $P_{n+1}$ 的显式公式。对于一个物理上有意义的种群模型，我们要求种群数量 $P_{n+1}$ 保持非负，并且在时间步非常小($h \\rightarrow 0$)的极限情况下，下一个状态应收敛到当前状态($P_{n+1} \\rightarrow P_n$)。如果存在多个数学解，请利用这一物理上的考虑来选择正确的解。", "solution": "我们从逻辑斯蒂微分方程 $P'(t) = r P(t)\\left(1 - \\frac{P(t)}{K}\\right)$ 开始，并应用后向欧拉法。对于一般形式的常微分方程 $y' = f(t,y)$，该方法由 $y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})$ 给出。对于逻辑斯蒂方程，$f(t,y) = r y \\left(1 - \\frac{y}{K}\\right)$，因此 $P_{n+1}$ 的后向欧拉更新式为\n$$\nP_{n+1} = P_n + h r P_{n+1} \\left(1 - \\frac{P_{n+1}}{K}\\right).\n$$\n令 $X := P_{n+1}$。整理可得\n$$\nX = P_n + h r X - \\frac{h r}{K} X^{2}.\n$$\n将所有项移到一边，得到一个关于 $X$ 的二次方程：\n$$\n\\frac{h r}{K} X^{2} + (1 - h r) X - P_n = 0.\n$$\n这是一个二次方程 $a X^{2} + b X + c = 0$，其中 $a = \\frac{h r}{K}$，$b = 1 - h r$，$c = - P_n$。根据二次公式，\n$$\nX = \\frac{ - b \\pm \\sqrt{ b^{2} - 4 a c } }{ 2 a } = \\frac{ - (1 - h r) \\pm \\sqrt{ (1 - h r)^{2} + \\frac{4 h r}{K} P_n } }{ 2 \\frac{h r}{K} }.\n$$\n为了选择物理上有意义的根，我们施加条件 $P_{n+1} \\geq 0$ 且当 $h \\to 0$ 时有 $P_{n+1} \\to P_n$。考虑两个分支：\n\n1) 取正号：\n$$\nX_{+} = \\frac{ - (1 - h r) + \\sqrt{ (1 - h r)^{2} + \\frac{4 h r}{K} P_n } }{ 2 \\frac{h r}{K} }.\n$$\n对于小的 $h$，使用 $\\sqrt{A^{2} + \\epsilon} \\approx A + \\frac{\\epsilon}{2 A}$ 展开平方根，其中 $A = 1 - h r$ 且 $\\epsilon = \\frac{4 h r}{K} P_n$，得到\n$$\nX_{+} \\approx \\frac{ - A + \\left( A + \\frac{ \\epsilon }{ 2 A } \\right) }{ 2 \\frac{h r}{K} } = \\frac{ \\epsilon }{ 4 \\frac{h r}{K} A } = \\frac{ \\frac{4 h r}{K} P_n }{ 4 \\frac{h r}{K} (1 - h r) } = \\frac{ P_n }{ 1 - h r } \\to P_n \\quad \\text{as } h \\to 0,\n$$\n这满足所要求的极限。此外，对于 $P_n \\geq 0$，被开方数至少为 $(1 - h r)^{2}$，所以分子是非负的，因此 $X_{+} \\geq 0$。\n\n2) 取负号：\n$$\nX_{-} = \\frac{ - (1 - h r) - \\sqrt{ (1 - h r)^{2} + \\frac{4 h r}{K} P_n } }{ 2 \\frac{h r}{K} }.\n$$\n当 $h \\to 0$ 时，$X_{-} \\sim - \\frac{ 2(1-hr) }{ 2hr/K } \\sim - \\frac{ K }{ h r } \\to - \\infty$，这既违反了非负性要求，也违反了连续性要求 $P_{n+1} \\to P_n$。\n\n因此，正确的、有物理意义的解是取正号的分支。将其写成一个稍微分解的形式可得\n$$\nP_{n+1} = \\frac{K}{2 h r} \\left( - (1 - h r) + \\sqrt{ (1 - h r)^{2} + \\frac{ 4 h r }{ K } P_n } \\right).\n$$\n该表达式在 $P_n \\geq 0$ 时得出 $P_{n+1} \\geq 0$，并且满足当 $h \\to 0$ 时 $P_{n+1} \\to P_n$，正如所要求的那样。", "answer": "$$\\boxed{\\frac{K}{2 h r}\\left(-\\left(1-h r\\right)+\\sqrt{\\left(1-h r\\right)^{2}+\\frac{4 h r}{K}P_{n}}\\right)}$$", "id": "2178610"}, {"introduction": "我们为什么要费心去处理隐式方法的复杂性呢？最后的这个练习将给出一个具体的答案。通过在一个典型的刚性问题上比较高阶显式方法（RK4）和简单的隐式方法（隐式欧拉法），你将亲手量化两者在稳定步长上的巨大差异，并看到这种差异如何转化为计算效率的惊人提升，从而凸显隐式方法在计算科学中不可或缺的地位。[@problem_id:3142647]", "problem": "考虑标量常微分方程 (ODE) $y'(t)=\\lambda\\,y(t)$，其中常数 $\\lambda=-10^{6}$，该方程模拟了一个强阻尼线性动力学系统。在初值问题的数值分析中，绝对稳定性是通过线性测试方程 $y'=\\lambda y$ 和相应的单步放大因子 $R(z)$ 来评估的，其中 $z=\\lambda\\,\\Delta t$，$\\Delta t>0$ 是时间步长。当对于给定的 $z$ 有 $|R(z)|\\leq 1$ 时，该方法对于该步长是绝对稳定的。\n\n你的任务是：\n- 仅使用经典的四阶龙格-库塔方法 (RK4) 的定义，将其应用于测试方程 $y'=\\lambda y$，以获得其放大因子 $R_{\\mathrm{RK4}}(z)$，表示为 $z$ 的多项式。然后，将 $z$ 限制在负实数范围内，并通过找到绝对稳定边界与负实轴的交点，确定当 $\\lambda=-10^{6}$ 时的最大稳定时间步长 $\\Delta t_{\\max}$。你可以数值求解所得到的实系数多项式方程。将 $\\Delta t_{\\max}$ 四舍五入到三位有效数字，并以秒为单位表示。\n- 将隐式欧拉方法应用于 $y'=\\lambda y$ 并推导其放大因子 $R_{\\mathrm{IE}}(z)$。用它来证明为什么对于 $\\lambda<0$ 选择 $\\Delta t=10^{-2}$ 秒是绝对稳定的。\n- 假设一个计算科学代码的测量结果显示，显式 RK4 的每步挂钟时间成本为 $c_{\\mathrm{RK4}}=2.0\\times 10^{-6}$ 秒，而隐式欧拉的成本为 $c_{\\mathrm{IE}}=5.0\\times 10^{-5}$ 秒（由于该标量问题上的非线性求解开销）。为了使用各自的稳定步长（RK4 使用 $\\Delta t_{\\max}$；隐式欧拉使用 $\\Delta t=10^{-2}$）从 $t=0$ 积分到 $t=1$ 秒，计算总挂钟时间之比 $T_{\\mathrm{RK4}}/T_{\\mathrm{IE}}$。将最终比率四舍五入到三位有效数字。将加速因子表示为无量纲数。\n\n只提供最终的比率作为你的答案。", "solution": "该问题定义明确，并在刚性常微分方程的数值分析方面具有科学依据。所有必要信息均已提供。\n\n分析按要求分三部分进行。\n\n第一部分：经典四阶龙格-库塔 (RK4) 方法的分析。\n对于初值问题 $y'(t) = f(t, y(t))$，RK4 方法由以下公式给出：\n$$ y_{n+1} = y_n + \\frac{\\Delta t}{6}(k_1 + 2k_2 + 2k_3 + k_4) $$\n其中\n$$ k_1 = f(t_n, y_n) $$\n$$ k_2 = f(t_n + \\frac{\\Delta t}{2}, y_n + \\frac{\\Delta t}{2} k_1) $$\n$$ k_3 = f(t_n + \\frac{\\Delta t}{2}, y_n + \\frac{\\Delta t}{2} k_2) $$\n$$ k_4 = f(t_n + \\Delta t, y_n + \\Delta t k_3) $$\n为了找到放大因子，我们将此方法应用于线性测试方程 $y' = \\lambda y$，因此 $f(t,y) = \\lambda y$。令 $z = \\lambda \\Delta t$。\n各个阶段变为：\n$$ k_1 = \\lambda y_n $$\n$$ k_2 = \\lambda(y_n + \\frac{\\Delta t}{2}k_1) = \\lambda(y_n + \\frac{\\Delta t}{2}\\lambda y_n) = \\lambda y_n (1 + \\frac{z}{2}) $$\n$$ k_3 = \\lambda(y_n + \\frac{\\Delta t}{2}k_2) = \\lambda(y_n + \\frac{\\Delta t}{2}\\lambda y_n (1 + \\frac{z}{2})) = \\lambda y_n (1 + \\frac{z}{2} + \\frac{z^2}{4}) $$\n$$ k_4 = \\lambda(y_n + \\Delta t k_3) = \\lambda(y_n + \\Delta t \\lambda y_n (1 + \\frac{z}{2} + \\frac{z^2}{4})) = \\lambda y_n (1 + z + \\frac{z^2}{2} + \\frac{z^3}{4}) $$\n将这些代入更新公式，并提出因子 $y_n$ 可得：\n$$ \\frac{y_{n+1}}{y_n} = 1 + \\frac{z}{6}\\left(1\\right) + \\frac{2z}{6}\\left(1 + \\frac{z}{2}\\right) + \\frac{2z}{6}\\left(1 + \\frac{z}{2} + \\frac{z^2}{4}\\right) + \\frac{z}{6}\\left(1 + z + \\frac{z^2}{2} + \\frac{z^3}{4}\\right) $$\n合并各项系数：\n$$ R_{\\mathrm{RK4}}(z) = 1 + z\\left(\\frac{1}{6}+\\frac{2}{6}+\\frac{2}{6}+\\frac{1}{6}\\right) + z^2\\left(\\frac{2}{12}+\\frac{2}{12}+\\frac{1}{6}\\right) + z^3\\left(\\frac{2}{24}+\\frac{1}{12}\\right) + z^4\\left(\\frac{1}{24}\\right) $$\n$$ R_{\\mathrm{RK4}}(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24} $$\n这个多项式是 $\\exp(z)$ 的泰勒级数在 $z^4$ 项之后的截断。\n\n绝对稳定性要求 $|R(z)| \\le 1$。对于这个问题，$\\lambda = -10^6  0$，所以 $z = \\lambda \\Delta t$ 是负实数。令 $z = -x$，其中 $x > 0$。对于 $x>0$，$R_{\\mathrm{RK4}}(-x)$ 是一个实值函数。稳定性条件是 $-1 \\le R_{\\mathrm{RK4}}(-x) \\le 1$。函数 $R_{\\mathrm{RK4}}(-x)$ 从 $R(0)=1$ 开始单调递减。稳定性区间的边界出现在函数值首次达到 $-1$ 时。因此，稳定性极限由方程 $R_{\\mathrm{RK4}}(-x) = -1$ 的最小正根 $x_0$ 决定。\n这等价于求解方程：\n$$ 1 - x + \\frac{x^2}{2} - \\frac{x^3}{6} + \\frac{x^4}{24} = -1 \\implies 2 - x + \\frac{x^2}{2} - \\frac{x^3}{6} + \\frac{x^4}{24} = 0 $$\n数值求解该四次多项式方程的最小正根，得到 $x_0 \\approx 2.78528$。\n负实轴上的稳定区间大约是 $[-2.785, 0]$。\n最大稳定步长 $\\Delta t_{\\max}$ 由 $|\\lambda \\Delta t_{\\max}| = x_0$ 给出。\n$$ |(-10^6) \\Delta t_{\\max}| \\approx 2.78528 \\implies \\Delta t_{\\max} \\approx \\frac{2.78528}{10^6} \\text{ s} \\approx 2.78528 \\times 10^{-6} \\text{ s} $$\n四舍五入到三位有效数字，$\\Delta t_{\\max} \\approx 2.79 \\times 10^{-6}$ 秒。\n\n第二部分：隐式欧拉方法的分析。\n对于 $y' = \\lambda y$ 的隐式欧拉方法是：\n$$ y_{n+1} = y_n + \\Delta t (\\lambda y_{n+1}) $$\n求解 $y_{n+1}$：\n$$ y_{n+1}(1 - \\lambda \\Delta t) = y_n \\implies \\frac{y_{n+1}}{y_n} = \\frac{1}{1 - \\lambda \\Delta t} $$\n放大因子是 $R_{\\mathrm{IE}}(z) = \\frac{1}{1-z}$。\n对于绝对稳定性，我们要求 $|R_{\\mathrm{IE}}(z)| \\le 1$。对于 $\\lambda  0$，$z = \\lambda \\Delta t$ 是负实数。\n$$ |\\frac{1}{1-z}| \\le 1 $$\n因为 $z  0$，所以 $1-z > 1$。表达式 $\\frac{1}{1-z}$ 是正数且小于 $1$。因此，对于任何 $z  0$，该不等式总是成立。\n这意味着隐式欧拉方法对于任何负实数 $\\lambda$ 和任何步长 $\\Delta t > 0$ 都是绝对稳定的。此性质被称为 A-稳定性。因此，选择步长 $\\Delta t = 10^{-2}$ 秒对于 $\\lambda = -10^6$ 是绝对稳定的，实际上对于任何 $\\lambda  0$ 都如此。\n\n第三部分：挂钟时间的比较。\n从 $t=0$ 积分到 $t=1$ 秒的总时间由步数乘以每步成本给出，即 $T = N \\times c = (\\frac{T_{\\text{end}} - T_{\\text{start}}}{\\Delta t}) \\times c$。\n\n对于 RK4：\n该方法是条件稳定的，要求 $\\Delta t_{\\mathrm{RK4}} = \\Delta t_{\\max} \\approx 2.78528 \\times 10^{-6}$ 秒。\n每步成本为 $c_{\\mathrm{RK4}} = 2.0 \\times 10^{-6}$ 秒。\n总挂钟时间为：\n$$ T_{\\mathrm{RK4}} = \\frac{1 \\text{ s}}{\\Delta t_{\\mathrm{RK4}}} \\times c_{\\mathrm{RK4}} = \\frac{1}{2.78528 \\times 10^{-6}} \\times (2.0 \\times 10^{-6}) \\text{ s} = \\frac{2.0}{2.78528} \\text{ s} $$\n\n对于隐式欧拉：\n该方法是无条件稳定的，因此允许使用更大的步长 $\\Delta t_{\\mathrm{IE}} = 10^{-2}$ 秒。\n每步成本为 $c_{\\mathrm{IE}} = 5.0 \\times 10^{-5}$ 秒。\n总挂钟时间为：\n$$ T_{\\mathrm{IE}} = \\frac{1 \\text{ s}}{\\Delta t_{\\mathrm{IE}}} \\times c_{\\mathrm{IE}} = \\frac{1}{10^{-2}} \\times (5.0 \\times 10^{-5}) \\text{ s} = 100 \\times 5.0 \\times 10^{-5} \\text{ s} = 5.0 \\times 10^{-3} \\text{ s} $$\n\n总挂钟时间之比为：\n$$ \\frac{T_{\\mathrm{RK4}}}{T_{\\mathrm{IE}}} = \\frac{2.0 / 2.78528}{5.0 \\times 10^{-3}} = \\frac{0.718085}{0.005} \\approx 143.617 $$\n将最终比率四舍五入到三位有效数字，我们得到 $144$。这表明对于这个刚性问题，隐式方法大约比显式方法快 $144$ 倍，尽管每步的成本要高得多，但这归功于它所允许的稳定步长大得多。", "answer": "$$\\boxed{144}$$", "id": "3142647"}]}