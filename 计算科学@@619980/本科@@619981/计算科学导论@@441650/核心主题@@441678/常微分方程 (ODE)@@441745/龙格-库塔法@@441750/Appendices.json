{"hands_on_practices": [{"introduction": "掌握任何数值方法都始于亲手计算。这个练习将引导你完成经典四阶龙格-库塔 (RK4) 方法的单步计算。通过手动计算四个阶段的斜率（$k_1, k_2, k_3, k_4$），你将具体理解 RK4 方法如何利用这些斜率的加权平均来实现其高精度。这个实践 [@problem_id:2197363] 将揭开公式的神秘面纱，为更复杂的应用打下坚实的基础。", "problem": "考虑由微分方程 $y' = \\frac{x}{y}$ 和初始条件 $y(1) = 2$ 定义的初值问题。\n\n您的任务是应用单步四阶龙格－库塔 (RK4) 方法来近似计算 $y(1.1)$ 的值。对于微分方程 $y' = f(x, y)$ 和步长 $h$，RK4 方法使用以下公式从当前值 $y_n$ 计算下一个值 $y_{n+1}$：\n\n$y_{n+1} = y_n + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$\n\n其中\n\n$k_1 = f(x_n, y_n)$\n$k_2 = f(x_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_1)$\n$k_3 = f(x_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_2)$\n$k_4 = f(x_n + h, y_n + h k_3)$\n\n计算 $y(1.1)$ 的数值近似值，并将最终答案四舍五入到五位有效数字。", "solution": "本题要求使用四阶龙格－库塔 (RK4) 方法，对常微分方程 $y' = \\frac{x}{y}$（初始条件为 $y(1) = 2$）进行单步近似，以求得 $y(1.1)$ 的值。\n\n首先，我们确定 RK4 公式所需的各组成部分。\n函数为 $f(x, y) = \\frac{x}{y}$。\n初始点为 $(x_0, y_0) = (1, 2)$。\n我们要求解 $y$ 在 $x_1 = 1.1$ 处的值。这意味着我们取单步步长 $h = x_1 - x_0 = 1.1 - 1.0 = 0.1$。\n\n现在，我们计算四个中间斜率 $k_1, k_2, k_3, k_4$。\n\n步骤 1：计算 $k_1$。\n$k_1 = f(x_0, y_0) = f(1, 2) = \\frac{1}{2} = 0.5$。\n\n步骤 2：计算 $k_2$。\n$k_2$ 的计算点为 $(x_0 + \\frac{h}{2}, y_0 + \\frac{h}{2}k_1)$。\n$x_0 + \\frac{h}{2} = 1 + \\frac{0.1}{2} = 1.05$。\n$y_0 + \\frac{h}{2}k_1 = 2 + \\frac{0.1}{2}(0.5) = 2 + 0.05(0.5) = 2 + 0.025 = 2.025$。\n所以，$k_2 = f(1.05, 2.025) = \\frac{1.05}{2.025}$。\n该分数为 $\\frac{1050}{2025} = \\frac{42 \\times 25}{81 \\times 25} = \\frac{42}{81} = \\frac{14}{27}$。\n写成小数形式，$k_2 \\approx 0.5185185185...$。\n\n步骤 3：计算 $k_3$。\n$k_3$ 的计算点为 $(x_0 + \\frac{h}{2}, y_0 + \\frac{h}{2}k_2)$。\nx 坐标与 $k_2$ 的相同：$1.05$。\n$y_0 + \\frac{h}{2}k_2 = 2 + \\frac{0.1}{2} \\left(\\frac{14}{27}\\right) = 2 + 0.05 \\left(\\frac{14}{27}\\right) = 2 + \\frac{1}{20}\\frac{14}{27} = 2 + \\frac{7}{270} = \\frac{540+7}{270} = \\frac{547}{270}$。\n所以，$k_3 = f\\left(1.05, \\frac{547}{270}\\right) = \\frac{1.05}{547/270} = \\frac{21/20}{547/270} = \\frac{21}{20} \\cdot \\frac{270}{547} = \\frac{21 \\cdot 27}{2 \\cdot 547} = \\frac{567}{1094}$。\n写成小数形式，$k_3 \\approx 0.5182815356...$。\n\n步骤 4：计算 $k_4$。\n$k_4$ 的计算点为 $(x_0 + h, y_0 + h k_3)$。\n$x_0 + h = 1 + 0.1 = 1.1$。\n$y_0 + h k_3 = 2 + 0.1 \\left(\\frac{567}{1094}\\right) = 2 + \\frac{567}{10940} = \\frac{21880+567}{10940} = \\frac{22447}{10940}$。\n所以，$k_4 = f\\left(1.1, \\frac{22447}{10940}\\right) = \\frac{1.1}{22447/10940} = \\frac{11/10}{22447/10940} = \\frac{11}{10} \\cdot \\frac{10940}{22447} = \\frac{11 \\cdot 1094}{22447} = \\frac{12034}{22447}$。\n写成小数形式，$k_4 \\approx 0.536107275...$。\n\n步骤 5：计算最终的近似值 $y_1$。\n$y_1 = y_0 + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$。\n为清晰起见，使用小数近似值（同时在计算中保留高精度）：\n$y_1 \\approx 2 + \\frac{0.1}{6}(0.5 + 2(0.5185185185) + 2(0.5182815356) + 0.536107275)$。\n$y_1 \\approx 2 + \\frac{0.1}{6}(0.5 + 1.037037037 + 1.0365630712 + 0.536107275)$。\n$y_1 \\approx 2 + \\frac{0.1}{6}(3.1097073832)$。\n$y_1 \\approx 2 + 0.05182845638...$。\n$y_1 \\approx 2.05182845638...$。\n\n最后，我们将结果四舍五入到五位有效数字。前五位有效数字是 2, 0, 5, 1, 8。后一位数字是 2，小于 5，所以我们向下舍入（即，不改变最后一位数字）。\n$y(1.1) \\approx 2.0518$。", "answer": "$$\\boxed{2.0518}$$", "id": "2197363"}, {"introduction": "熟悉了 RK4 的计算过程后，我们便需要评估其性能。检验数值方法的一个标准途径是将其应用于一个有已知精确解的问题，并测量其产生的误差。本练习 [@problem_id:2197360] 使用了模拟许多物理过程的基本测试方程 $y' = \\lambda y$。通过计算 RK4 近似解与真实指数解之间的绝对误差，你将对该方法的卓越精度建立起直观认识，并理解它为何被称为“四阶”方法。", "problem": "在许多物理和生物系统中，某个量的变化率与该量本身成正比。这导出了形如 $y'(t) = \\lambda y(t)$ 的一阶常微分方程（ODE），该方程可用于模拟放射性衰变或简单的人口增长等现象。虽然这个特定的常微分方程有直接的解析解，但它经常被用作检验数值方法准确性的基准。\n\n考虑如下给出的初值问题：\n$$\ny'(t) = \\lambda y(t), \\quad y(0) = y_0\n$$\n\n我们希望使用经典的四阶 Runge-Kutta (RK4) 方法的单步来近似解在时间 $t=h$ 处的值。RK4 方法使用以下步骤从当前值 $y_0 = y(0)$ 计算下一个值 $y_1 \\approx y(h)$：\n- $k_1 = f(t_0, y_0)$\n- $k_2 = f(t_0 + \\frac{h}{2}, y_0 + \\frac{h}{2} k_1)$\n- $k_3 = f(t_0 + \\frac{h}{2}, y_0 + \\frac{h}{2} k_2)$\n- $k_4 = f(t_0 + h, y_0 + h k_3)$\n- $y_1 = y_0 + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$\n\n其中 $f(t,y) = y'(t) = \\lambda y(t)$，$t_0=0$，且 $h$ 是步长。\n\n给定具体参数 $\\lambda = 2$，$y_0 = 1$，以及步长 $h = 0.1$，计算一步 RK4 近似后的绝对误差。绝对误差定义为 $|y(h) - y_1|$。\n\n将您的最终答案四舍五入到四位有效数字。", "solution": "我们求解初值问题 $y'(t)=\\lambda y(t)$，其中 $y(0)=y_{0}$。通过分离变量法得到精确解：\n$$\n\\frac{y'(t)}{y(t)}=\\lambda \\quad \\Rightarrow \\quad \\ln|y(t)|=\\lambda t + C \\quad \\Rightarrow \\quad y(t)=C_{1}\\exp(\\lambda t).\n$$\n使用 $y(0)=y_{0}$ 可得 $C_{1}=y_{0}$，所以\n$$\ny(h)=y_{0}\\exp(\\lambda h).\n$$\n对于 RK4 步骤，其中 $f(t,y)=\\lambda y$，$t_{0}=0$，我们计算\n$$\nk_{1}=f(t_{0},y_{0})=\\lambda y_{0}, \\quad\nk_{2}=f\\!\\left(t_{0}+\\frac{h}{2},\\,y_{0}+\\frac{h}{2}k_{1}\\right)=\\lambda\\left(y_{0}+\\frac{h}{2}k_{1}\\right),\n$$\n$$\nk_{3}=f\\!\\left(t_{0}+\\frac{h}{2},\\,y_{0}+\\frac{h}{2}k_{2}\\right)=\\lambda\\left(y_{0}+\\frac{h}{2}k_{2}\\right), \\quad\nk_{4}=f(t_{0}+h,\\,y_{0}+hk_{3})=\\lambda\\left(y_{0}+hk_{3}\\right).\n$$\n然后\n$$\ny_{1}=y_{0}+\\frac{h}{6}\\left(k_{1}+2k_{2}+2k_{3}+k_{4}\\right).\n$$\n使用给定值 $\\lambda=2$，$y_{0}=1$，$h=0.1$，我们计算\n$$\nk_{1}=2\\cdot 1=2,\\quad\nk_{2}=2\\left(1+\\frac{0.1}{2}\\cdot 2\\right)=2.2,\\quad\nk_{3}=2\\left(1+\\frac{0.1}{2}\\cdot 2.2\\right)=2.22,\\quad\nk_{4}=2\\left(1+0.1\\cdot 2.22\\right)=2.444.\n$$\n因此\n$$\ny_{1}=1+\\frac{0.1}{6}\\left(2+2\\cdot 2.2+2\\cdot 2.22+2.444\\right)\n=1+\\frac{0.1}{6}\\cdot 13.284=1+0.2214=1.2214.\n$$\n$t=h$ 处的精确值为\n$$\ny(h)=\\exp(\\lambda h)=\\exp(0.2).\n$$\n因此，一步 RK4 后的绝对误差是\n$$\n|y(h)-y_{1}|=\\left|\\exp(0.2)-1.2214\\right|.\n$$\n使用高精度值 $\\exp(0.2)=1.221402758160169\\ldots$，我们得到\n$$\n|y(h)-y_{1}|=1.221402758160169-1.2214=2.7581601698339\\times 10^{-6}.\n$$\n四舍五入到四位有效数字，得到 $2.758\\times 10^{-6}$。", "answer": "$$\\boxed{2.758 \\times 10^{-6}}$$", "id": "2197360"}, {"introduction": "在数值模拟中，精度并非唯一的考量，稳定性同等重要。一个不稳定的方法可能会产生无意义的、剧烈振荡的结果，即便其真实解是平滑且衰减的。最后的这个练习 [@problem_id:2197380] 将带你探索绝对稳定性这一关键概念。通过一个牛顿冷却定律的模型，你将确定为保证 RK4 方法稳定所需的最大允许步长 $h_{max}$。这个练习突显了计算科学中的一个核心权衡：计算速度（更大的步长）与数值稳定性之间的平衡。", "problem": "一个金属小球的初始温度为 $T_0$。它被浸入一个保持在恒定温度 $T_{env}$ 的大冷却浴中。温差 $\\Delta T(t) = T(t) - T_{env}$ 遵循牛顿冷却定律，对于该系统，这由以下常微分方程 (ODE) 描述：\n$$ \\frac{d(\\Delta T)}{dt} = -k \\Delta T $$\n其中冷却常数 $k = 50.0 \\text{ s}^{-1}$。你的任务是使用经典四阶龙格-库塔 (RK4) 方法对冷却过程进行数值模拟。为确保数值解不出现虚假的增长性振荡（即，确保绝对稳定性），必须谨慎选择时间步长 $h$。确定在此模拟中为保持绝对稳定性可以使用的最大时间步长 $h_{max}$。以秒为单位，将你的 $h_{max}$ 答案表示为保留三位有效数字的数值。", "solution": "我们将温差的常微分方程重写为线性测试方程。令 $y(t) = \\Delta T(t)$。则\n$$\n\\frac{dy}{dt} = -k\\,y,\n$$\n因此，对于 RK4 的稳定性分析，我们在标准测试方程 $y'=\\lambda y$ 中取 $\\lambda = -k$。\n\n对于应用于 $y'=\\lambda y$ 且步长为 $h$ 的龙格-库塔方法，其更新形式为 $y_{n+1} = R(z)\\,y_{n}$，其中 $z = h\\lambda$。对于经典四阶龙格-库塔方法，其稳定函数是 $\\exp(z)$ 的四次泰勒多项式：\n$$\nR(z) = 1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6} + \\frac{z^{4}}{24}.\n$$\n绝对稳定性要求 $|R(z)| \\leq 1$。此处 $\\lambda=-k$ 是实数，所以 $z=-kh$ 也是实数，条件简化为在负实轴上 $|R(z)| \\leq 1$。当 $z$ 从 $0$ 减小进入负实数域时，$R(z)$ 从 $1$ 减小到一个正的最小值，然后在负实轴上稳定区间的左端点处回升到 $1$。因此，左端点 $z_{\\ast}$ 满足\n$$\nR(z_{\\ast}) = 1.\n$$\n求解 $R(z)=1$ 对于实数 $z \\neq 0$ 可得\n$$\n1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6} + \\frac{z^{4}}{24} - 1 = 0\n\\;\\;\\Longleftrightarrow\\;\\;\nz\\left(1 + \\frac{z}{2} + \\frac{z^{2}}{6} + \\frac{z^{3}}{24}\\right)=0,\n$$\n所以非平凡实根满足\n$$\n1 + \\frac{z}{2} + \\frac{z^{2}}{6} + \\frac{z^{3}}{24} = 0\n\\;\\;\\Longleftrightarrow\\;\\;\nz^{3} + 4 z^{2} + 12 z + 24 = 0.\n$$\n在负实轴上对此三次方程进行数值求解（例如，通过 Newton 方法）可得\n$$\nz_{\\ast} \\approx -2.785.\n$$\n由于 $z = -k h$，保持绝对稳定性的最大时间步长是\n$$\nh_{\\max} = \\frac{|z_{\\ast}|}{k}.\n$$\n当 $k = 50.0\\,\\text{s}^{-1}$ 时，这给出\n$$\nh_{\\max} \\approx \\frac{2.785}{50.0} = 0.0557\\ \\text{s},\n$$\n根据要求保留三位有效数字，结果为 $0.0557$ 秒。", "answer": "$$\\boxed{0.0557}$$", "id": "2197380"}]}