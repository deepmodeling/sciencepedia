{"hands_on_practices": [{"introduction": "为了将理论付诸实践，我们从一个具体的物理模型开始。这个练习将指导你应用隐式欧拉法来预测一个简化CPU模型在特定负载下的温度变化。通过求解这个线性常微分方程 ([@problem_id:2178316])，你将掌握建立和求解隐式方法所产生的代数方程的基本步骤。", "problem": "一个用于描述可变负载下中央处理器 (CPU) 的简化热模型由以下一阶常微分方程给出：\n$$ \\frac{dT}{dt} = -k(T - T_a) + P(t) $$\n其中 $T(t)$ 是 CPU 在时间 $t$（单位为分钟）时的温度（单位为摄氏度 $^\\circ\\text{C}$），$k$ 是散热常数，$T_a$ 是恒定的环境温度，$P(t)$ 代表 CPU 活动产生的热量。\n\n假设参数如下：\n- 散热常数，$k = 0.5 \\text{ min}^{-1}$\n- 环境温度，$T_a = 25^\\circ\\text{C}$\n- 生热函数，$P(t) = P_0 \\cos(\\omega t)$，其中 $P_0 = 10^\\circ\\text{C}/\\text{min}$ 且 $\\omega = \\frac{\\pi}{6} \\text{ rad/min}$。\n- CPU 的初始温度为 $T(0) = 85^\\circ\\text{C}$。\n\n为了预测温度的演变，采用了一种数值方法。下一个时间步 $t_{n+1}$ 的温度 $T_{n+1}$ 是根据当前时间步 $t_n$ 的温度 $T_n$ 使用以下更新规则估算得出的：\n$$ T_{n+1} = T_n + h \\left( \\frac{dT}{dt} \\right)_{t=t_{n+1}, T=T_{n+1}} $$\n其中 $h = t_{n+1} - t_n$ 是时间步长。\n\n使用该数值方法进行单步计算，步长为 $h = 0.5$ 分钟，计算 CPU 在 $t = 0.5$ 分钟时的近似温度。\n\n请用摄氏度表示你的答案，并四舍五入到四位有效数字。", "solution": "我们已知一阶常微分方程\n$$\n\\frac{dT}{dt}=-k\\left(T-T_{a}\\right)+P(t), \\quad P(t)=P_{0}\\cos(\\omega t),\n$$\n我们需要应用步长为 $h$ 的隐式（后向）欧拉法进行一步计算，从 $t_{0}=0$ 到 $t_{1}=h$。后向欧拉法的更新公式为\n$$\nT_{1}=T_{0}+h\\left.\\frac{dT}{dt}\\right|_{t=t_{1},\\,T=T_{1}}=T_{0}+h\\big(-k(T_{1}-T_{a})+P_{0}\\cos(\\omega t_{1})\\big).\n$$\n求解此方程以得到 $T_{1}$。展开右侧并合并 $T_{1}$ 项：\n$$\nT_{1}=T_{0}-hkT_{1}+hkT_{a}+hP_{0}\\cos(\\omega t_{1}).\n$$\n将 $T_{1}$ 项移到左侧：\n$$\nT_{1}+hkT_{1}=T_{0}+hkT_{a}+hP_{0}\\cos(\\omega t_{1}).\n$$\n对左侧进行因式分解并求解 $T_{1}$：\n$$\nT_{1}=\\frac{T_{0}+hkT_{a}+hP_{0}\\cos(\\omega t_{1})}{1+hk}.\n$$\n现在代入给定数据 $T_{0}=85$，$k=0.5$，$T_{a}=25$，$P_{0}=10$，$\\omega=\\frac{\\pi}{6}$，$h=0.5$ 和 $t_{1}=0.5$：\n$$\n1+hk=1+0.5\\times 0.5=1.25,\n$$\n$$\nhkT_{a}=0.5\\times 0.5\\times 25=6.25,\n$$\n$$\nhP_{0}\\cos(\\omega t_{1})=0.5\\times 10\\times \\cos\\!\\left(\\frac{\\pi}{6}\\times 0.5\\right)=5\\cos\\!\\left(\\frac{\\pi}{12}\\right).\n$$\n因此\n$$\nT_{1}=\\frac{85+6.25+5\\cos\\!\\left(\\frac{\\pi}{12}\\right)}{1.25}.\n$$\n使用 $\\cos\\!\\left(\\frac{\\pi}{12}\\right)\\approx 0.9659258263$，我们得到\n$$\nT_{1}\\approx \\frac{85+6.25+4.829629131}{1.25}=\\frac{96.079629131}{1.25}\\approx 76.86370331.\n$$\n四舍五入到四位有效数字，在 $t=0.5$ 分钟时的近似温度为 $76.86$ 摄氏度。", "answer": "$$\\boxed{76.86}$$", "id": "2178316"}, {"introduction": "虽然隐式欧拉法因其稳定性而备受青睐，但这并不意味着它没有挑战，尤其是在处理非线性问题时。本练习探讨了一个关键的复杂性：隐式方法产生的代数方程可能没有实数解，从而导致数值方法失败。通过分析这个问题 ([@problem_id:2178313])，你将发现一个基于“可解性”而非稳定性的临界步长概念。", "problem": "一位分析师正在研究求解一阶常微分方程（ODE）近似解的数值稳定性。所考虑的具体初值问题由微分方程 $y' = 1 + y^2$ 和初始条件 $y(0) = 0$ 给出。\n\n为了找到一个近似解，采用了隐式欧拉方法。对于一个均匀的步长 $h$，该方法生成一个数值序列 $y_0, y_1, y_2, \\ldots$，其中 $y_n$ 是解在时间 $t_n = nh$ 处的近似值。其更新规则定义为：\n$$y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})$$\n其中 $f(t, y)$ 是常微分方程的右侧项，即 $y' = f(t,y)$。\n\n对于给定的常微分方程，应用隐式欧拉方法会得到一个代数方程，在每一步都必须求解该方程以得到 $y_{n+1}$。事实证明，对于任何给定的状态 $y_n$，存在一个正的临界步长 $h_{crit}$，使得对于任何步长 $h  h_{crit}$，关于 $y_{n+1}$ 的代数方程没有实数解，从而导致该方法失效。\n\n你的任务是确定这个临界步长 $h_{crit}$ 作为当前状态 $y_n$ 的函数的表达式。假设步长 $h$ 必须是一个正实数。", "solution": "我们将隐式欧拉方法应用于步长为 $h0$ 的常微分方程 $y' = 1 + y^{2}$。更新公式为\n$$\ny_{n+1} = y_{n} + h\\left(1 + y_{n+1}^{2}\\right).\n$$\n重新整理以汇集关于 $y_{n+1}$ 的项，得到\n$$\ny_{n+1} - h y_{n+1}^{2} - y_{n} - h = 0,\n$$\n这等价于关于 $y_{n+1}$ 的二次方程，\n$$\nh y_{n+1}^{2} - y_{n+1} + \\left(y_{n} + h\\right) = 0.\n$$\n一个二次方程 $a z^{2} + b z + c = 0$ 有实数解，当且仅当其判别式 $\\Delta = b^{2} - 4ac$ 满足 $\\Delta \\ge 0$。这里 $a = h$，$b = -1$，$c = y_{n} + h$，所以\n$$\n\\Delta(h) = 1 - 4 h (y_{n} + h) = 1 - 4 h y_{n} - 4 h^{2}.\n$$\n对于固定的 $y_{n}$，当且仅当 $\\Delta(h) \\ge 0$ 时存在实数解。临界步长 $h_{crit}$ 是使 $\\Delta(h) = 0$ 的正数 $h$：\n$$\n1 - 4 h y_{n} - 4 h^{2} = 0 \\;\\;\\Longleftrightarrow\\;\\; 4 h^{2} + 4 y_{n} h - 1 = 0.\n$$\n求解这个关于 $h$ 的二次方程，\n$$\nh = \\frac{-4 y_{n} \\pm \\sqrt{16 y_{n}^{2} + 16}}{8} = \\frac{-y_{n} \\pm \\sqrt{y_{n}^{2} + 1}}{2}.\n$$\n在这些解中，正根是\n$$\nh_{crit}(y_{n}) = \\frac{-y_{n} + \\sqrt{1 + y_{n}^{2}}}{2},\n$$\n而另一个根是负数，因此对于正步长是不可接受的。对于 $h  h_{crit}(y_{n})$，判别式为负，不存在实数 $y_{n+1}$，这导致该方法失效。一个等价的形式是 $h_{crit}(y_{n}) = \\frac{1}{2\\left(\\sqrt{1 + y_{n}^{2}} + y_{n}\\right)}$。", "answer": "$$\\boxed{\\frac{\\sqrt{1+y_{n}^{2}}-y_{n}}{2}}$$", "id": "2178313"}, {"introduction": "在处理非线性方程时，我们通常需要一个迭代求解器，例如牛顿法。然而，求解器本身也可能遇到问题。这个练习 ([@problem_id:2178312]) 深入探讨了将牛顿法应用于隐式欧拉步时的一个实际障碍：雅可比矩阵的奇异性。理解这种情况对于开发稳健的数值代码至关重要，因为它连接了常微分方程数值解和非线性方程求根这两个重要的计算领域。", "problem": "考虑单个标量函数 $y(t)$ 的初值问题 (IVP) 的数值解：\n$$\ny'(t) = \\sqrt{y(t)}, \\quad y(0) = 0\n$$\n我们希望使用隐式欧拉法的单步来近似时间 $t=h$ 处的解。隐式欧拉法的一般公式为 $y_{n+1} = y_n + h f(y_{n+1})$，其中 $h$ 是步长。对于第一步，这会产生一个关于未知值 $y_1 \\approx y(h)$ 的非线性代数方程。\n\n求解此类非线性方程的标准程序是 Newton 法。为求解 $g(x)=0$ 形式的方程，Newton 法使用一种迭代方案，该方案需要计算函数 $g(x)$ 及其导数 $g'(x)$，即系统的雅可比矩阵（在此一维情况下）。如果在任何迭代中雅可比矩阵变为奇异（即等于零），Newton 法就会失败。\n\n确定使与隐式欧拉步的 Newton 法求解器相关的雅可比矩阵变为奇异的 $y_1$ 的特定正值。将您的答案表示为步长 $h$ 的符号表达式。", "solution": "我们对初值问题 $y'(t)=\\sqrt{y(t)}$, $y(0)=0$ 应用一步隐式欧拉法。隐式欧拉更新为\n$$\ny_{1}=y_{0}+h f(y_{1})=0+h\\sqrt{y_{1}},\n$$\n这产生非线性方程\n$$\ng(y_{1})=y_{1}-h\\sqrt{y_{1}}=0.\n$$\n求解 $g(y)=0$ 的 Newton 法使用雅可比（导数）$g'(y)$。我们计算\n$$\ng'(y)=\\frac{d}{dy}\\left(y-h\\sqrt{y}\\right)=1-\\frac{h}{2\\sqrt{y}},\n$$\n它在 $y0$ 时有定义。当 $g'(y)=0$ 时，雅可比矩阵变为奇异。因此我们求解\n$$\n1-\\frac{h}{2\\sqrt{y}}=0 \\quad \\Longrightarrow \\quad \\frac{h}{2\\sqrt{y}}=1 \\quad \\Longrightarrow \\quad 2\\sqrt{y}=h \\quad \\Longrightarrow \\quad \\sqrt{y}=\\frac{h}{2} \\quad \\Longrightarrow \\quad y=\\frac{h^{2}}{4}.\n$$\n因此，使 Newton 法的雅可比矩阵变为奇异的 $y_1$ 的特定正值为 $y_{1}=h^{2}/4$。", "answer": "$$\\boxed{\\frac{h^{2}}{4}}$$", "id": "2178312"}]}