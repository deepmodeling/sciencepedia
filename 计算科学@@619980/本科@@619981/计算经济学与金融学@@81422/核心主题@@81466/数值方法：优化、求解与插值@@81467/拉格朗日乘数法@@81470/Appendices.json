{"hands_on_practices": [{"introduction": "本练习将拉格朗日乘子法应用于一个经典的农业经济学问题：资源分配。通过解决一个农民如何在玉米和大豆之间分配土地以实现收益最大化的问题，同时遵守作物轮作的限制，你将亲身体会到拉格朗日乘子的实际经济意义。这个练习旨在阐明乘子如何量化约束的“影子价格”，即当约束稍微放宽时，最优目标函数值能增加多少。[@problem_id:2442060]", "problem": "爱荷华州的一位农民计划在连续两年内分配玉米和大豆的种植。设 $x_1 \\in [0,1]$ 和 $x_2 \\in [0,1]$ 分别表示第1年和第2年种植玉米的面积占总种植面积的比例。在第 $t$ 年（$t \\in \\{1,2\\}$），剩余的 $1 - x_t$ 比例的面积用于种植大豆。\n\n对于每一年 $t$，整个农场的每英亩预期收入是玉米种植比例 $x_t$ 的函数，表示为\n$$\nR_t(x_t) \\;=\\; x_t\\big(\\alpha_c - \\beta_c x_t\\big) \\;+\\; \\big(1 - x_t\\big)\\big(\\alpha_s - \\beta_s\\big(1 - x_t\\big)\\big),\n$$\n其中参数以美元/英亩为单位给出，分别为 $\\alpha_c = 800$、$\\beta_c = 200$、$\\alpha_s = 600$ 和 $\\beta_s = 100$。农民的两年目标是最大化总预期每英亩收入 $R_1(x_1) + R_2(x_2)$，并受到作物轮作约束的限制，该约束要求两年内玉米的平均种植面积不超过总面积的 $60\\%$：\n$$\n\\frac{x_1 + x_2}{2} \\;\\le\\; 0.6,\n$$\n以及可行性条件 $0 \\le x_1 \\le 1$，$0 \\le x_2 \\le 1$。\n\n在最优分配下，确定与作物轮作约束相关的拉格朗日乘子（影子价值）。以美元/英亩为单位，用一个实数表示您的答案。最终答案中不要包含单位。", "solution": "所提问题是农业经济学领域中的一个约束优化问题。该问题在科学上是成立的、适定的且客观的。所有必要的数据和条件都已给出，且不存在矛盾。因此，我们可以进行形式化的求解。\n\n目标是最大化两年的总预期收入 $Z(x_1, x_2) = R_1(x_1) + R_2(x_2)$，其中 $x_1$ 和 $x_2$ 分别是第1年和第2年分配给玉米的种植面积比例。第 $t$ 年的每英亩收入函数给出如下：\n$$\nR_t(x_t) = x_t(\\alpha_c - \\beta_c x_t) + (1 - x_t)(\\alpha_s - \\beta_s(1 - x_t))\n$$\n由于参数在两年间是恒定的，所以两年收入函数的形式是相同的。我们用 $R(x)$ 表示该函数。我们可以展开并简化 $R(x)$：\n$$\nR(x) = \\alpha_c x - \\beta_c x^2 + \\alpha_s - \\alpha_s x - \\beta_s(1 - 2x + x^2)\n$$\n$$\nR(x) = -(\\beta_c + \\beta_s)x^2 + (\\alpha_c - \\alpha_s + 2\\beta_s)x + (\\alpha_s - \\beta_s)\n$$\n问题给出了参数值：$\\alpha_c = 800$、$\\beta_c = 200$、$\\alpha_s = 600$ 和 $\\beta_s = 100$。所有值的单位都是美元/英亩。将这些值代入 $R(x)$ 的表达式中：\n$$\n\\beta_c + \\beta_s = 200 + 100 = 300\n$$\n$$\n\\alpha_c - \\alpha_s + 2\\beta_s = 800 - 600 + 2(100) = 400\n$$\n$$\n\\alpha_s - \\beta_s = 600 - 100 = 500\n$$\n因此，收入函数简化为一个凹二次函数：\n$$\nR(x) = -300x^2 + 400x + 500\n$$\n其二阶导数 $\\frac{d^2R}{dx^2} = -600$ 为负，证实了 $R(x)$ 的严格凹性。因此，总目标函数 $Z(x_1, x_2) = R(x_1) + R(x_2)$ 也是严格凹的。\n\n该优化问题为：\n$$\n\\max_{x_1, x_2} Z(x_1, x_2) = (-300x_1^2 + 400x_1 + 500) + (-300x_2^2 + 400x_2 + 500)\n$$\n受以下约束：\n1. 作物轮作：$g(x_1, x_2) = \\frac{x_1 + x_2}{2} - 0.6 \\le 0$\n2. 可行性：$0 \\le x_1 \\le 1$ 且 $0 \\le x_2 \\le 1$\n\n首先，我们通过求 $R(x)$ 的最大值来确定无约束最优解。一阶条件为 $\\frac{dR}{dx} = 0$：\n$$\n\\frac{dR}{dx} = -600x + 400 = 0 \\implies x = \\frac{400}{600} = \\frac{2}{3}\n$$\n$Z(x_1, x_2)$ 的无约束最大值会在 $x_1 = x_2 = \\frac{2}{3}$ 处取得。我们来检查该点是否满足作物轮作约束：\n$$\n\\frac{x_1 + x_2}{2} = \\frac{\\frac{2}{3} + \\frac{2}{3}}{2} = \\frac{2}{3} \\approx 0.667\n$$\n由于 $\\frac{2}{3} > 0.6$，无约束解违反了作物轮作约束。由于目标函数是凹的且约束集是凸的，最优解必须位于紧约束所定义的边界上。也就是说，在最优解处，我们必须有 $\\frac{x_1 + x_2}{2} = 0.6$。\n\n为了求出与此约束相关的拉格朗日乘子（影子价值），我们构造拉格朗日函数 $\\mathcal{L}$。设 $\\lambda$ 为作物轮作约束的乘子。我们暂时忽略边界约束，因为无约束最优解 $x_i = 2/3$ 位于 $[0,1]$ 区间内，而有约束最优解将更接近可行集的中心。\n$$\n\\mathcal{L}(x_1, x_2, \\lambda) = Z(x_1, x_2) - \\lambda \\left(\\frac{x_1 + x_2}{2} - 0.6\\right)\n$$\n最优解 $(x_1^*, x_2^*)$ 的 Karush-Kuhn-Tucker (KKT) 条件如下：\n1. 平稳性：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial x_1} = \\frac{dR(x_1^*)}{dx_1} - \\frac{\\lambda}{2} = -600x_1^* + 400 - \\frac{\\lambda}{2} = 0\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial x_2} = \\frac{dR(x_2^*)}{dx_2} - \\frac{\\lambda}{2} = -600x_2^* + 400 - \\frac{\\lambda}{2} = 0\n$$\n2. 原始可行性：$\\frac{x_1^* + x_2^*}{2} - 0.6 \\le 0$\n3. 对偶可行性：$\\lambda \\ge 0$\n4. 互补松弛性：$\\lambda \\left(\\frac{x_1^* + x_2^*}{2} - 0.6\\right) = 0$\n\n根据平稳性条件，我们得到 $-600x_1^* + 400 = -600x_2^* + 400$，这意味着 $x_1^* = x_2^*$。由于目标函数和约束的对称性，这个结果是符合预期的。\n\n如前所述，该约束必定是紧约束，因此 $\\frac{x_1^* + x_2^*}{2} = 0.6$。将 $x_1^* = x_2^*$ 代入此方程，得到：\n$$\n\\frac{x_1^* + x_1^*}{2} = x_1^* = 0.6\n$$\n因此，最优分配为 $x_1^* = x_2^* = 0.6$。该解满足可行性条件 $0 \\le 0.6 \\le 1$。\n\n现在我们使用其中一个平稳性条件来求解拉格朗日乘子 $\\lambda$：\n$$\n-600x_1^* + 400 - \\frac{\\lambda}{2} = 0\n$$\n代入 $x_1^* = 0.6$：\n$$\n-600(0.6) + 400 - \\frac{\\lambda}{2} = 0\n$$\n$$\n-360 + 400 - \\frac{\\lambda}{2} = 0\n$$\n$$\n40 - \\frac{\\lambda}{2} = 0\n$$\n$$\n\\frac{\\lambda}{2} = 40 \\implies \\lambda = 80\n$$\n拉格朗日乘子的值为 $\\lambda = 80$。该值为非负，满足对偶可行性条件。该乘子表示，当平均种植面积约束边际放宽时，最大总收入的增加率，单位为美元/英亩。", "answer": "$$\\boxed{80}$$", "id": "2442060"}, {"introduction": "这个练习探讨了一种特殊但重要的情景：当一个约束存在，但最优决策恰好落在约束的边界上，使得该约束并未真正“束缚”决策时，会发生什么。我们通过分析一个企业的利润最大化问题来探索这种情况，在该问题中，其无约束的最优产量恰好等于其产能上限。这个思想实验将帮助你深入理解互补松弛性（complementary slackness）条件，并揭示为何非绑定约束（non-binding constraint）的拉格朗日乘子（即影子价格）为零。[@problem_id:2442053]", "problem": "一家竞争性企业生产单一产品。设产出为 $q \\ge 0$，市场价格为 $p0$，总成本函数为 $C(q)=\\frac{1}{2} c q^{2}$，其中 $c0$。企业选择 $q$ 以最大化利润 $\\pi(q)=p q - C(q)$，并受限于资源（产能）约束 $q \\le \\bar{Q}$。假设可用资源水平恰好等于无约束下的利润最大化产出：$\\bar{Q}=\\frac{p}{c}$。在有约束的利润最大化点，与不等式约束 $q \\le \\bar{Q}$ 相关联的拉格朗日乘子 $\\lambda$ 的值是多少？请用一个精确的数字作答，无需四舍五入。", "solution": "该企业的问题是最大化标量目标函数 $\\pi(q)=p q - \\frac{1}{2} c q^{2}$，并受限于标量不等式约束 $q \\le \\bar{Q}$，其中 $p0$，$c0$，且 $\\bar{Q}=\\frac{p}{c}$。首先，从基本原理出发确定无约束最优解。函数 $\\pi(q)$ 是可微的且是严格凹的，因为其关于 $q$ 的二阶导数为 $\\frac{\\partial^{2} \\pi}{\\partial q^{2}}=-c0$。无约束最大化的一阶条件是\n$$\n\\frac{\\partial \\pi}{\\partial q}=p - c q = 0,\n$$\n这表明唯一的无约束最大化解为\n$$\nq^{u}=\\frac{p}{c}.\n$$\n根据假设，资源限制为 $\\bar{Q}=\\frac{p}{c}$，因此无约束最大化解恰好满足约束条件：$q^{u}=\\bar{Q}$。\n\n为了确定与不等式约束相关联的拉格朗日乘子，我们使用不等式约束的标准符号约定来构建有约束问题的拉格朗日函数。设约束函数为 $g(q)=q-\\bar{Q} \\le 0$，其对应的拉格朗日乘子为 $\\lambda \\ge 0$。拉格朗日函数为\n$$\n\\mathcal{L}(q,\\lambda) = p q - \\frac{1}{2} c q^{2} - \\lambda \\big( q - \\bar{Q} \\big).\n$$\nKarush–Kuhn–Tucker 条件（在此由于凹性，这些是一阶充要条件）是：\n- 平稳性：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial q}= p - c q - \\lambda = 0.\n$$\n- 互补松弛性：\n$$\n\\lambda \\big(q - \\bar{Q}\\big)=0.\n$$\n- 原始可行性：$q \\le \\bar{Q}$。\n- 对偶可行性：$\\lambda \\ge 0$。\n\n我们已经确定最优解 $q^{\\star}$ 等于无约束最大化解，且满足 $q^{\\star}=\\bar{Q}=\\frac{p}{c}$。将 $q^{\\star}=\\frac{p}{c}$ 代入平稳性条件可得\n$$\np - c\\left(\\frac{p}{c}\\right) - \\lambda = 0 \\quad \\Longrightarrow \\quad 0 - \\lambda = 0 \\quad \\Longrightarrow \\quad \\lambda = 0.\n$$\n互补松弛性也得到满足，因为 $q^{\\star}-\\bar{Q}=0$ 意味着 $\\lambda \\big(q^{\\star}-\\bar{Q}\\big)=\\lambda \\cdot 0 = 0$。目标函数的严格凹性保证了这些条件刻画了唯一的全局最大化解。因此，在有约束最优解处，拉格朗日乘子的值为 $0$。", "answer": "$$\\boxed{0}$$", "id": "2442053"}, {"introduction": "拉格朗日乘子法是寻找最优解的强大工具，但它并非万无一失。一阶条件仅能识别稳定点（stationary points），而不能保证这些点就是最大值点。本练习旨在揭示这一关键点，通过构建一个看似标准的消费者选择问题，其拉格朗日一阶条件识别出的实际上是效用函数的局部最小值点。通过解决这个问题，你将学会批判性地评估优化问题的结构，特别是目标函数的凹凸性，从而避免在应用优化技术时陷入常见陷阱。[@problem_id:2442017]", "problem": "一位消费者选择两种非负数量的商品，记为 $x_{1}$ 和 $x_{2}$，以最大化其效用函数\n$$\nu(x_{1},x_{2}) = (x_{1} - 1)^{2} + (x_{2} - 1)^{2}\n$$\n并服从预算约束\n$$\n1 \\cdot x_{1} + 2 \\cdot x_{2} = 6,\n$$\n且 $x_{1} \\geq 0$ 和 $x_{2} \\geq 0$。设 $\\lambda$ 表示此问题拉格朗日形式中与预算约束相关的拉格朗日乘子。\n\n使用拉格朗日乘子法，确定在此效用最大化问题中，满足一阶条件的内部驻点处的 $\\lambda$ 的数值。请给出精确形式的答案，无需四舍五入。", "solution": "在尝试任何解答之前，我们先对问题陈述进行验证。\n\n给定的条件逐条摘录如下：\n1.  待最大化的目标函数：$u(x_{1},x_{2}) = (x_{1} - 1)^{2} + (x_{2} - 1)^{2}$。\n2.  决策变量：$x_{1}$ 和 $x_{2}$。\n3.  约束条件：$1 \\cdot x_{1} + 2 \\cdot x_{2} = 6$，$x_{1} \\geq 0$，以及 $x_{2} \\geq 0$。\n4.  目标变量：内部驻点处的拉格朗日乘子 $\\lambda$。\n\n该问题被认为是有效的。这是一个适定的约束优化数学问题。尽管效用函数 $u(x_{1},x_{2})$ 是凸函数，这意味着通过一阶条件找到的驻点将是局部最小值而非最大值，但问题明确要求的是“满足一阶条件的内部驻点”处的 $\\lambda$ 值。这是一个精确且可回答的数学问题，无论极值的分类如何。“效用最大化”这个经济学标签并不会使这个数学任务无效。\n\n我们采用拉格朗日乘子法。拉格朗日函数 $\\mathcal{L}$ 是通过将目标函数与预算约束（乘以拉格朗日乘子 $\\lambda$）进行组合而构造的。预算约束为 $g(x_{1}, x_{2}) = x_{1} + 2x_{2} - 6 = 0$。\n\n拉格朗日函数定义为：\n$$\n\\mathcal{L}(x_{1}, x_{2}, \\lambda) = u(x_{1}, x_{2}) - \\lambda g(x_{1}, x_{2})\n$$\n代入给定的函数，我们得到：\n$$\n\\mathcal{L}(x_{1}, x_{2}, \\lambda) = (x_{1} - 1)^{2} + (x_{2} - 1)^{2} - \\lambda(x_{1} + 2x_{2} - 6)\n$$\n为求驻点，我们计算 $\\mathcal{L}$ 关于 $x_{1}$、$x_{2}$ 和 $\\lambda$ 的一阶偏导数，并令它们等于零。由此可得一阶条件 (FOCs)。\n\n1.  $\\frac{\\partial \\mathcal{L}}{\\partial x_{1}} = 2(x_{1} - 1) - \\lambda = 0$\n2.  $\\frac{\\partial \\mathcal{L}}{\\partial x_{2}} = 2(x_{2} - 1) - 2\\lambda = 0$\n3.  $\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -(x_{1} + 2x_{2} - 6) = 0 \\implies x_{1} + 2x_{2} = 6$\n\n从前两个一阶条件中，我们将 $x_{1}$ 和 $x_{2}$ 表示为 $\\lambda$ 的函数。\n由方程(1)得：\n$$\n2(x_{1} - 1) = \\lambda \\implies x_{1} - 1 = \\frac{\\lambda}{2} \\implies x_{1} = 1 + \\frac{\\lambda}{2}\n$$\n由方程(2)得：\n$$\n2(x_{2} - 1) = 2\\lambda \\implies x_{2} - 1 = \\lambda \\implies x_{2} = 1 + \\lambda\n$$\n问题指定了一个内部驻点，这意味着 $x_{1} > 0$ 且 $x_{2} > 0$。我们将在求得 $\\lambda$ 后验证此条件。\n\n现在，将 $x_{1}$ 和 $x_{2}$ 的表达式代入预算约束（方程(3)）：\n$$\n\\left(1 + \\frac{\\lambda}{2}\\right) + 2(1 + \\lambda) = 6\n$$\n我们求解此方程以得到 $\\lambda$。\n$$\n1 + \\frac{\\lambda}{2} + 2 + 2\\lambda = 6\n$$\n合并含 $\\lambda$ 的项和常数项：\n$$\n\\frac{\\lambda}{2} + \\frac{4\\lambda}{2} + 3 = 6\n$$\n$$\n\\frac{5\\lambda}{2} = 6 - 3\n$$\n$$\n\\frac{5\\lambda}{2} = 3\n$$\n两边同乘以 $\\frac{2}{5}$，得到 $\\lambda$ 的值：\n$$\n\\lambda = 3 \\cdot \\frac{2}{5} = \\frac{6}{5}\n$$\n我们检验 $\\lambda$ 的这个值是否对应一个内部解。\n对于 $x_{1}$：\n$$\nx_{1} = 1 + \\frac{1}{2}\\left(\\frac{6}{5}\\right) = 1 + \\frac{3}{5} = \\frac{8}{5}\n$$\n对于 $x_{2}$：\n$$\nx_{2} = 1 + \\frac{6}{5} = \\frac{11}{5}\n$$\n由于 $x_{1} = \\frac{8}{5} > 0$ 且 $x_{2} = \\frac{11}{5} > 0$，所求得的驻点确实是一个内部点。此驻点处的拉格朗日乘子的值为 $\\frac{6}{5}$。", "answer": "$$\\boxed{\\frac{6}{5}}$$", "id": "2442017"}]}