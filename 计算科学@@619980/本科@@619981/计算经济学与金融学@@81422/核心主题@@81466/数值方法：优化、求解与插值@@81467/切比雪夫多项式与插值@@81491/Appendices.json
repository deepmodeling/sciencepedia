{"hands_on_practices": [{"introduction": "我们已经从理论上探讨了切比雪夫多项式在函数逼近中的优势。现在，让我们通过动手实践来具体感受其威力。这个基础练习将引导你手动计算一个简单的插值问题，让你亲眼见证，即便对于像 $f(x)=x^3$ 这样一个基础函数，使用切比雪夫节点进行插值也能得到一个既精确又优雅的逼近多项式。[@problem_id:2187288] 这个过程将帮助你直观地理解为什么切比雪夫节点在最小化插值误差方面表现卓越。", "problem": "在数值分析中，使用切比雪夫节点进行插值是优于使用等距点的一种方法，尤其是在避免龙格现象方面。该方法选择的插值点是切比雪夫多项式的根，这些根聚集在区间的端点附近。\n\n考虑区间 $[-1, 1]$ 上的函数 $f(x) = x^3$。你的任务是找到一个次数至多为2的唯一多项式，我们称之为 $P_2(x)$，它在该区间上的三个切比雪夫节点处对 $f(x)$ 进行插值。这些节点被定义为第一类3次切比雪夫多项式 $T_3(x)$ 的根。\n\n请将你的答案 $P_2(x)$ 表示为一个关于 $x$ 的简化多项式。", "solution": "我们已知在 $[-1,1]$ 上的函数 $f(x)=x^{3}$，并且必须找到一个次数至多为 $2$ 的唯一多项式 $P_{2}(x)$，它在 $[-1,1]$ 上的三个切比雪夫节点处对 $f$ 进行插值，这些节点定义为第一类3次切比雪夫多项式 $T_{3}(x)$ 的根。\n\n使用恒等式 $T_{3}(x)=\\cos\\!\\big(3\\arccos x\\big)=4x^{3}-3x$。$T_{3}$ 的根即为三个切比雪夫节点：\n$$\nT_{3}(x)=4x^{3}-3x=x\\big(4x^{2}-3\\big)=0\n\\quad\\Longrightarrow\\quad\nx\\in\\left\\{0,\\;\\pm\\frac{\\sqrt{3}}{2}\\right\\}.\n$$\n设 $P_{2}(x)=A x^{2}+B x+C$。插值条件为在每个节点 $\\xi\\in\\left\\{0,\\pm\\frac{\\sqrt{3}}{2}\\right\\}$ 处，$P_{2}(\\xi)=\\xi^{3}$。\n\n1) 在 $x=0$ 处：\n$$\nP_{2}(0)=C=0 \\quad\\Longrightarrow\\quad C=0.\n$$\n\n2) 设 $a=\\frac{\\sqrt{3}}{2}$。在 $x=a$ 和 $x=-a$ 处：\n$$\nP_{2}(a)=A a^{2}+B a=a^{3},\\qquad P_{2}(-a)=A a^{2}-B a=-a^{3}.\n$$\n将这两个方程相加可以消去 $B$：\n$$\n\\big(A a^{2}+B a\\big)+\\big(A a^{2}-B a\\big)=a^{3}+(-a^{3})\n\\;\\Longrightarrow\\;\n2A a^{2}=0\n\\;\\Longrightarrow\\;\nA=0\n\\quad(\\text{since }a\\neq 0).\n$$\n将 $A=0$ 代入 $A a^{2}+B a=a^{3}$ 以求解 $B$：\n$$\nB a=a^{3}\\;\\Longrightarrow\\;B=a^{2}.\n$$\n由于 $a=\\frac{\\sqrt{3}}{2}$，我们有\n$$\na^{2}=\\left(\\frac{\\sqrt{3}}{2}\\right)^{2}=\\frac{3}{4}.\n$$\n因此，\n$$\nP_{2}(x)=B x=\\frac{3}{4}\\,x.\n$$\n快速验证：$P_{2}(0)=0=f(0)$，且 $P_{2}(\\pm a)=\\frac{3}{4}(\\pm a)=\\pm a\\cdot\\frac{3}{4}=\\pm a^{3}=f(\\pm a)$，因此在所有三个切比雪夫节点上插值条件都满足。\n\n因此，次数至多为 $2$ 的唯一插值多项式是 $P_{2}(x)=\\frac{3}{4}x$。", "answer": "$$\\boxed{\\frac{3}{4}x}$$", "id": "2187288"}, {"introduction": "获得一个有效的多项式逼近只是第一步，更重要的是如何利用它进行深入分析。这个练习将我们从函数逼近本身，带入其在金融领域的实际应用。你将基于一个期权定价函数的切比雪夫逼近，通过解析微分来计算其“希腊字母”——金融风险管理中的核心指标。[@problem_id:2379334] 这个实践突显了多项式逼近的一个关键优势：它们提供了一个易于操作的光滑、可微模型，极大地便利了后续的分析与计算。", "problem": "一个欧式看涨期权的价格是现货价格 $S$ 和波动率 $\\sigma$ 的函数，在定义域 $S \\in [80, 120]$ 和 $\\sigma \\in [0.1, 0.4]$ 上，该价格可以通过一个关于 $S$ 为 2 次、关于 $\\sigma$ 为 1 次的第一类切比雪夫多项式的张量积来近似。设到切比雪夫域的仿射映射为\n$$\nx(S) \\equiv \\frac{2 S - (S_{\\max} + S_{\\min})}{S_{\\max} - S_{\\min}}, \\quad y(\\sigma) \\equiv \\frac{2 \\sigma - (\\sigma_{\\max} + \\sigma_{\\min})}{\\sigma_{\\max} - \\sigma_{\\min}},\n$$\n其中 $S_{\\min} = 80$，$S_{\\max} = 120$，$\\sigma_{\\min} = 0.1$，以及 $\\sigma_{\\max} = 0.4$。该近似式为\n$$\n\\widehat{P}(S,\\sigma) = \\sum_{i=0}^{2}\\sum_{j=0}^{1} a_{ij}\\, T_{i}(x(S))\\, T_{j}(y(\\sigma)),\n$$\n其中 $T_{n}$ 表示第一类切比雪夫多项式，有 $T_{0}(u) = 1$，$T_{1}(u) = u$，以及 $T_{2}(u) = 2u^{2} - 1$。系数为\n$$\na_{00} = 10, \\quad a_{10} = 5, \\quad a_{20} = 2, \\quad a_{01} = 8, \\quad a_{11} = -3, \\quad a_{21} = 1.\n$$\n\n计算该近似式在 $S = 105$ 和 $\\sigma = 0.2$ 处的期权德尔塔（Delta）、伽马（Gamma）和维加（Vega），其中德尔塔为 $\\frac{\\partial \\widehat{P}}{\\partial S}$，伽马为 $\\frac{\\partial^{2} \\widehat{P}}{\\partial S^{2}}$，维加为 $\\frac{\\partial \\widehat{P}}{\\partial \\sigma}$。将最终答案以 $\\big(\\Delta, \\Gamma, \\text{Vega}\\big)$ 的顺序表示为单行矩阵。不要对答案进行四舍五入。", "solution": "该问题要求计算近似期权价格函数 $\\widehat{P}(S,\\sigma)$ 关于现货价格 $S$ 和波动率 $\\sigma$ 的三个偏导数。在金融学中，这些导数被称为德尔塔（Delta, $\\Delta$）、伽马（Gamma, $\\Gamma$）和维加（Vega）。分析过程如下。\n\n首先，对问题陈述进行验证。\n步骤1：提取已知条件。\n- 期权价格的近似式为 $\\widehat{P}(S,\\sigma) = \\sum_{i=0}^{2}\\sum_{j=0}^{1} a_{ij}\\, T_{i}(x(S))\\, T_{j}(y(\\sigma))$。\n- 定义域为 $S \\in [S_{\\min}, S_{\\max}]$，其中 $S_{\\min} = 80$，$S_{\\max} = 120$；以及 $\\sigma \\in [\\sigma_{\\min}, \\sigma_{\\max}]$，其中 $\\sigma_{\\min} = 0.1$，$\\sigma_{\\max} = 0.4$。\n- 到标准切比雪夫域 $[-1, 1]$ 的仿射映射为：\n$$\nx(S) = \\frac{2 S - (S_{\\max} + S_{\\min})}{S_{\\max} - S_{\\min}} \\quad \\text{和} \\quad y(\\sigma) = \\frac{2 \\sigma - (\\sigma_{\\max} + \\sigma_{\\min})}{\\sigma_{\\max} - \\sigma_{\\min}}\n$$\n- 给出的第一类切比雪夫多项式为：$T_{0}(u) = 1$，$T_{1}(u) = u$ 和 $T_{2}(u) = 2u^{2} - 1$。\n- 给出的系数为：$a_{00} = 10$，$a_{10} = 5$，$a_{20} = 2$，$a_{01} = 8$，$a_{11} = -3$ 和 $a_{21} = 1$。\n- 需要计算的量为德尔塔 $\\Delta = \\frac{\\partial \\widehat{P}}{\\partial S}$，伽马 $\\Gamma = \\frac{\\partial^{2} \\widehat{P}}{\\partial S^{2}}$ 和维加 Vega = $\\frac{\\partial \\widehat{P}}{\\partial \\sigma}$。\n- 求值点为 $(S, \\sigma) = (105, 0.2)$。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据、是适定的、客观且完整的。它展示了计算金融领域中多元多项式近似和微分的一个标准应用。没有违背任何科学原理，所有必要的数据均已提供，且术语定义明确。\n\n步骤3：结论与行动。\n问题有效。下面将推导求解过程。\n\n首先计算仿射映射的导数。\n对于 $x(S)$：\n$$\nx(S) = \\frac{2S - (120 + 80)}{120 - 80} = \\frac{2S - 200}{40} = \\frac{S - 100}{20}\n$$\n关于 $S$ 的一阶和二阶导数分别为：\n$$\n\\frac{dx}{dS} = \\frac{1}{20} \\quad \\text{和} \\quad \\frac{d^{2}x}{dS^{2}} = 0\n$$\n对于 $y(\\sigma)$：\n$$\ny(\\sigma) = \\frac{2\\sigma - (0.4 + 0.1)}{0.4 - 0.1} = \\frac{2\\sigma - 0.5}{0.3}\n$$\n关于 $\\sigma$ 的一阶导数为：\n$$\n\\frac{dy}{d\\sigma} = \\frac{2}{0.3} = \\frac{20}{3}\n$$\n$\\widehat{P}$ 的完整表达式为：\n$$\n\\widehat{P}(S,\\sigma) = \\sum_{j=0}^{1} T_{j}(y) \\left( \\sum_{i=0}^{2} a_{ij} T_{i}(x) \\right) = T_{0}(y) \\sum_{i=0}^{2} a_{i0} T_{i}(x) + T_{1}(y) \\sum_{i=0}^{2} a_{i1} T_{i}(x)\n$$\n代入 $T_0(y)=1$ 和 $T_1(y)=y$：\n$$\n\\widehat{P}(S,\\sigma) = (a_{00} T_{0}(x) + a_{10} T_{1}(x) + a_{20} T_{2}(x)) + y (a_{01} T_{0}(x) + a_{11} T_{1}(x) + a_{21} T_{2}(x))\n$$\n\n为了计算关于 $S$ 和 $\\sigma$ 的导数，我们需要切比雪夫多项式的导数：\n$T'_{0}(u) = 0$，$T'_{1}(u) = 1$，$T'_{2}(u) = 4u$。\n$T''_{0}(u) = 0$，$T''_{1}(u) = 0$，$T''_{2}(u) = 4$。\n\n现在，我们使用链式法则计算德尔塔、伽马和维加。\n\n1.  德尔塔 ($\\Delta = \\frac{\\partial \\widehat{P}}{\\partial S}$)：\n$$\n\\Delta = \\frac{\\partial \\widehat{P}}{\\partial S} = \\frac{\\partial \\widehat{P}}{\\partial x} \\frac{dx}{dS}\n$$\n关于 $x$ 的偏导数为：\n$$\n\\frac{\\partial \\widehat{P}}{\\partial x} = (a_{10} T'_{1}(x) + a_{20} T'_{2}(x)) + y (a_{11} T'_{1}(x) + a_{21} T'_{2}(x)) = (a_{10} + 4a_{20}x) + y (a_{11} + 4a_{21}x)\n$$\n所以，德尔塔为：\n$$\n\\Delta = \\left[ (a_{10} + 4a_{20}x) + y (a_{11} + 4a_{21}x) \\right] \\frac{dx}{dS}\n$$\n\n2.  伽马 ($\\Gamma = \\frac{\\partial^{2} \\widehat{P}}{\\partial S^{2}}$)：\n$$\n\\Gamma = \\frac{\\partial}{\\partial S} \\left( \\frac{\\partial \\widehat{P}}{\\partial S} \\right) = \\frac{\\partial}{\\partial S} \\left( \\frac{\\partial \\widehat{P}}{\\partial x} \\frac{dx}{dS} \\right) = \\frac{\\partial}{\\partial S} \\left( \\frac{\\partial \\widehat{P}}{\\partial x} \\right) \\frac{dx}{dS} + \\frac{\\partial \\widehat{P}}{\\partial x} \\frac{d^{2}x}{dS^{2}}\n$$\n由于 $\\frac{d^{2}x}{dS^{2}} = 0$，表达式简化为：\n$$\n\\Gamma = \\left( \\frac{\\partial}{\\partial x} \\left( \\frac{\\partial \\widehat{P}}{\\partial x} \\right) \\frac{dx}{dS} \\right) \\frac{dx}{dS} = \\frac{\\partial^{2} \\widehat{P}}{\\partial x^{2}} \\left( \\frac{dx}{dS} \\right)^{2}\n$$\n关于 $x$ 的二阶偏导数为：\n$$\n\\frac{\\partial^{2} \\widehat{P}}{\\partial x^{2}} = \\frac{\\partial}{\\partial x} \\left[ (a_{10} + 4a_{20}x) + y (a_{11} + 4a_{21}x) \\right] = 4a_{20} + 4a_{21}y\n$$\n所以，伽马为：\n$$\n\\Gamma = (4a_{20} + 4a_{21}y) \\left( \\frac{dx}{dS} \\right)^{2}\n$$\n\n3.  维加 ($\\text{Vega} = \\frac{\\partial \\widehat{P}}{\\partial \\sigma}$)：\n$$\n\\text{Vega} = \\frac{\\partial \\widehat{P}}{\\partial \\sigma} = \\frac{\\partial \\widehat{P}}{\\partial y} \\frac{dy}{d\\sigma}\n$$\n关于 $y$ 的偏导数为：\n$$\n\\frac{\\partial \\widehat{P}}{\\partial y} = a_{01} T_{0}(x) + a_{11} T_{1}(x) + a_{21} T_{2}(x) = a_{01} + a_{11} x + a_{21}(2x^{2} - 1)\n$$\n所以，维加为：\n$$\n\\text{Vega} = \\left[ (a_{01} - a_{21}) + a_{11}x + 2a_{21}x^{2} \\right] \\frac{dy}{d\\sigma}\n$$\n最后，我们在点 $(S, \\sigma) = (105, 0.2)$ 处对这些表达式求值。\n首先，计算 $x$ 和 $y$：\n$$\nx(105) = \\frac{105 - 100}{20} = \\frac{5}{20} = \\frac{1}{4}\n$$\n$$\ny(0.2) = \\frac{2(0.2) - 0.5}{0.3} = \\frac{0.4 - 0.5}{0.3} = \\frac{-0.1}{0.3} = -\\frac{1}{3}\n$$\n代入系数、$x$、$y$ 以及映射的导数值。\n\n对于德尔塔：\n$$\n\\Delta = \\left[ (5 + 4(2)\\frac{1}{4}) + (-\\frac{1}{3}) ((-3) + 4(1)\\frac{1}{4}) \\right] \\left(\\frac{1}{20}\\right)\n$$\n$$\n\\Delta = \\left[ (5 + 2) + (-\\frac{1}{3}) (-3 + 1) \\right] \\left(\\frac{1}{20}\\right) = \\left[ 7 + (-\\frac{1}{3})(-2) \\right] \\left(\\frac{1}{20}\\right)\n$$\n$$\n\\Delta = \\left[ 7 + \\frac{2}{3} \\right] \\left(\\frac{1}{20}\\right) = \\left( \\frac{21+2}{3} \\right) \\left(\\frac{1}{20}\\right) = \\frac{23}{3} \\cdot \\frac{1}{20} = \\frac{23}{60}\n$$\n\n对于伽马：\n$$\n\\Gamma = (4(2) + 4(1)(-\\frac{1}{3})) \\left( \\frac{1}{20} \\right)^{2} = (8 - \\frac{4}{3}) \\left( \\frac{1}{400} \\right)\n$$\n$$\n\\Gamma = \\left( \\frac{24-4}{3} \\right) \\left( \\frac{1}{400} \\right) = \\frac{20}{3} \\cdot \\frac{1}{400} = \\frac{1}{3 \\cdot 20} = \\frac{1}{60}\n$$\n\n对于维加：\n$$\n\\text{Vega} = \\left[ (8 - 1) + (-3)(\\frac{1}{4}) + 2(1)(\\frac{1}{4})^{2} \\right] \\left( \\frac{20}{3} \\right)\n$$\n$$\n\\text{Vega} = \\left[ 7 - \\frac{3}{4} + 2(\\frac{1}{16}) \\right] \\left( \\frac{20}{3} \\right) = \\left[ 7 - \\frac{3}{4} + \\frac{1}{8} \\right] \\left( \\frac{20}{3} \\right)\n$$\n$$\n\\text{Vega} = \\left[ \\frac{56 - 6 + 1}{8} \\right] \\left( \\frac{20}{3} \\right) = \\left( \\frac{51}{8} \\right) \\left( \\frac{20}{3} \\right) = \\frac{17 \\cdot 5}{2} = \\frac{85}{2}\n$$\n最终结果为 $\\Delta = \\frac{23}{60}$，$\\Gamma = \\frac{1}{60}$ 和维加 $= \\frac{85}{2}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{23}{60} & \\frac{1}{60} & \\frac{85}{2} \\end{pmatrix}}$$", "id": "2379334"}]}