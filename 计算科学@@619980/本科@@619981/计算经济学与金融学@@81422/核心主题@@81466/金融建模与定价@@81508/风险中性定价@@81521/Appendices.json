{"hands_on_practices": [{"introduction": "风险中性定价的原则不仅适用于传统的金融市场，它也可以用来分析我们日常生活中遇到的新颖场景。这个练习将风险中性估值的核心思想应用到一个现代众筹平台的“成功代币”上。通过将这个代币看作一个简单的数字期权，我们可以利用其市场价格来反向推断市场对项目成功的风险中性概率，从而将抽象的理论与直观的现实世界联系起来 [@problem_id:2427390]。", "problem": "一个众筹平台采用“全有或全无”的募资规则：如果一个项目在截止日期前达到或超过其募资目标，则收缴认捐资金；否则，认捐资金将作废。考虑该平台上的一个可交易证券，一种“成功代币”，当且仅当项目成功时，它在项目截止日期支付 $1$，否则支付 $0$。假设市场无摩擦、无套利，并且存在一个恒定的连续复利无风险利率。\n\n在当前时间 $t=0$，观测到某个特定项目的单个成功代币价格为 $0.41$。距离项目截止日期还剩 $45$ 天，年化连续复利无风险利率为 $0.03$。假设一年为 $365$ 天。\n\n仅使用这些输入信息和风险中性定价的基本原理，确定从观测到的代币价格中推断出的项目成功的风险中性概率（以无单位小数表示）。将您的答案四舍五入到四位有效数字。", "solution": "所陈述的问题必须首先经过严格验证。\n\n**第 1 步：提取已知条件**\n- 证券类型：一种“成功代币”，在项目截止日期时，若项目成功则支付 $1$，否则支付 $0$。\n- 市场假设：无摩擦市场、无套利、恒定的连续复利无风险利率。\n- 时间 $t=0$ 时代币价格：$P_0 = 0.41$。\n- 距离截止日期的时间：$T = 45$ 天。\n- 年化连续复利无风险利率：$r = 0.03$。\n- 年份约定：$365$ 天。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据**：该问题正确地构建在完善的无套利定价理论框架内，特别是风险中性定价。这是数理金融学中的一个基本概念。\n- **适定性**：该问题提供了确定唯一解所需的所有信息。输入数据（$P_0$、$r$、$T$ 和回报结构）足以计算未知的风险中性概率。\n- **客观性**：该问题使用精确、量化且无歧义的语言陈述。不存在主观或推测性元素。\n\n**第 3 步：结论与行动**\n该问题具有科学依据、提法恰当且客观。因此判定为**有效**。现在将从基本原理推导出解答。\n\n无套利定价的基本原理指出，衍生证券的价格是其未来预期回报的现值，其中期望值是在风险中性概率测度（记为 $Q$）下计算的。\n\n设 $P_t$ 为成功代币在时间 $t$ 的价格。已知 $P_0 = 0.41$。\n设 $T$ 为距离项目截止日期的时间，以年为单位。鉴于距离截止日期的时间为 $45$ 天，且一年有 $365$ 天，我们有：\n$$T = \\frac{45}{365}$$\n给定的年化连续复利无风险利率为 $r = 0.03$。\n\n代币在截止日期的回报 $V_T$ 是一个取决于项目结果的随机变量。设 $S$ 表示项目成功的事件，$F$ 表示项目失败的事件。回报结构如下：\n$$\nV_T = \n\\begin{cases} \n1 & \\text{if event } S \\text{ occurs} \\\\\n0 & \\text{if event } F \\text{ occurs}\n\\end{cases}\n$$\n我们的任务是求出成功的风险中性概率。设此概率为 $q$。因此，在风险中性测度 $Q$ 下：\n$$q = Q(S)$$\n$$1-q = Q(F)$$\n在风险中性测度下，时间 $T$ 的预期回报 $E_Q[V_T]$ 计算如下：\n$$E_Q[V_T] = (1 \\times q) + (0 \\times (1-q)) = q$$\n在时间 $t=0$ 时，该代币的无套利价格是其贴现后的预期回报：\n$$P_0 = \\exp(-rT) E_Q[V_T]$$\n代入预期回报的表达式，我们得到：\n$$P_0 = q \\cdot \\exp(-rT)$$\n我们现在必须解这个方程求出 $q$：\n$$q = P_0 \\cdot \\exp(rT)$$\n现在，我们将给定的数值代入此表达式：\n$$P_0 = 0.41$$\n$$r = 0.03$$\n$$T = \\frac{45}{365}$$\n这得出：\n$$q = 0.41 \\cdot \\exp\\left(0.03 \\cdot \\frac{45}{365}\\right)$$\n首先计算指数部分：\n$$rT = 0.03 \\times \\frac{45}{365} = \\frac{1.35}{365} \\approx 0.00369863$$\n然后我们计算 $q$ 的值：\n$$q = 0.41 \\cdot \\exp(0.00369863...) \\approx 0.41 \\cdot 1.0037054... \\approx 0.4115192...$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $4$、$1$、$1$ 和 $5$。第五位有效数字是 $1$，小于 $5$，因此我们向下舍入。\n$$q \\approx 0.4115$$\n这个值代表了与观测到的市场价格和无套利条件相一致的唯一的项目成功风险中性概率。它不一定是真实的、现实世界中的概率，而是在风险中性框架下用于定价的概率。", "answer": "$$\\boxed{0.4115}$$", "id": "2427390"}, {"introduction": "在理解了如何应用风险中性概率之后，一个自然而然的问题是：究竟什么样的一组概率才算是“风险中性”的？这个练习将我们带回到一个简化的、只有三种可能结果的离散世界中，去检验一个基本定义。你的任务是验证一组给定的概率是否满足核心的鞅性质（martingale condition），即折现后的资产价格过程的期望值保持不变，这是任何有效的风险中性测度的基石 [@problem_id:2427434]。", "problem": "考虑一个单期、三状态经济，其状态为 $\\omega_1$、$\\omega_2$ 和 $\\omega_3$。市场中存在一个无风险债券，其在时刻 $0$ 的价格为 $B_0 = 1$，在时刻 $1$ 的确定性收益为 $B_1 = 1.05$。市场中还存在一个单一风险资产，其在时刻 $0$ 的价格为 $S_0 = 100$，在时刻 $1$ 的状态依存收益由下式给出：\n$$\nS_1(\\omega_1) = 120,\\quad S_1(\\omega_2) = 100,\\quad S_1(\\omega_3) = 80.\n$$\n一位分析师声称该市场是无套利的，并提出了关于 $\\{\\omega_1,\\omega_2,\\omega_3\\}$ 的以下风险中性概率向量 $Q$：\n$$\nq_1 = 0.3,\\quad q_2 = 0.4,\\quad q_3 = 0.3.\n$$\n定义偏差\n$$\n\\delta \\equiv \\sum_{i=1}^{3} q_i \\frac{S_1(\\omega_i)}{B_1} - \\frac{S_0}{B_0}.\n$$\n请精确计算 $\\delta$ 的值，结果表示为一个数字。不要对答案进行四舍五入。最终结果不带单位。", "solution": "在进行任何解答尝试之前，首先对问题陈述进行验证。\n\n逐字提取已知条件如下：\n- 一个单期、三状态经济，其状态为 $\\omega_1$、$\\omega_2$ 和 $\\omega_3$。\n- 一个无风险债券，其在时刻 $0$ 的价格为 $B_0 = 1$，在时刻 $1$ 的收益为 $B_1 = 1.05$。\n- 一个单一风险资产，其在时刻 $0$ 的价格为 $S_0 = 100$。\n- 该风险资产在时刻 $1$ 的状态依存收益为：$S_1(\\omega_1) = 120$，$S_1(\\omega_2) = 100$，$S_1(\\omega_3) = 80$。\n- 一个提议的风险中性概率向量 $Q$：$q_1 = 0.3$，$q_2 = 0.4$，$q_3 = 0.3$。\n- 偏差 $\\delta$ 的定义为：$\\delta \\equiv \\sum_{i=1}^{3} q_i \\frac{S_1(\\omega_i)}{B_1} - \\frac{S_0}{B_0}$。\n- 目标是精确计算 $\\delta$。\n\n验证结论：该问题是有效的。它在科学上基于风险中性定价理论，这是金融数学的基石。所有术语都得到了明确定义，所有必要的数值也都已提供。该问题是自洽的、适定的和客观的。它可以归结为基于给定公式的直接计算，并且不包含任何科学或逻辑上的谬误。\n\n我们的任务是计算量 $\\delta$。其定义如下：\n$$\n\\delta = \\sum_{i=1}^{3} q_i \\frac{S_1(\\omega_i)}{B_1} - \\frac{S_0}{B_0}\n$$\n该表达式可以被分析为，在提议的测度 $Q$ 下风险资产的预期未来收益的现值，与其观测到的现值之间的差值，其中两个值都通过相应时间点的无风险债券价格进行了归一化。在无套利市场中，对于一个有效的风险中性测度，这个偏差必须为零。我们继续进行计算。\n\n首先，展开求和项：\n$$\n\\delta = \\left( q_1 \\frac{S_1(\\omega_1)}{B_1} + q_2 \\frac{S_1(\\omega_2)}{B_1} + q_3 \\frac{S_1(\\omega_3)}{B_1} \\right) - \\frac{S_0}{B_0}\n$$\n分母中的项 $B_1$ 是求和中所有项的公因式，可以提取出来：\n$$\n\\delta = \\frac{1}{B_1} \\left( q_1 S_1(\\omega_1) + q_2 S_1(\\omega_2) + q_3 S_1(\\omega_3) \\right) - \\frac{S_0}{B_0}\n$$\n括号中的表达式是在概率测度 $Q$ 下，该资产在时刻 $1$ 的预期收益，记作 $E_Q[S_1]$。\n$$\nE_Q[S_1] = q_1 S_1(\\omega_1) + q_2 S_1(\\omega_2) + q_3 S_1(\\omega_3)\n$$\n代入给定的数值：$q_1=0.3$，$q_2=0.4$，$q_3=0.3$ 以及 $S_1(\\omega_1)=120$，$S_1(\\omega_2)=100$，$S_1(\\omega_3)=80$。\n$$\nE_Q[S_1] = (0.3)(120) + (0.4)(100) + (0.3)(80)\n$$\n$$\nE_Q[S_1] = 36 + 40 + 24 = 100\n$$\n现在，将此结果以及剩下的给定值 $B_1 = 1.05$，$S_0 = 100$ 和 $B_0 = 1$ 代回到 $\\delta$ 的公式中。\n$$\n\\delta = \\frac{1}{1.05} (100) - \\frac{100}{1}\n$$\n为了计算精确值，最好使用分数运算。数字 $1.05$ 等价于 $\\frac{105}{100}$，化简后为 $\\frac{21}{20}$。\n$$\n\\delta = \\frac{100}{\\frac{21}{20}} - 100\n$$\n$$\n\\delta = 100 \\times \\frac{20}{21} - 100\n$$\n$$\n\\delta = \\frac{2000}{21} - 100\n$$\n为了进行减法，我们找到公分母 $21$。\n$$\n\\delta = \\frac{2000}{21} - \\frac{100 \\times 21}{21} = \\frac{2000}{21} - \\frac{2100}{21}\n$$\n$$\n\\delta = \\frac{2000 - 2100}{21} = -\\frac{100}{21}\n$$\n计算出的 $\\delta$ 值非零。这表明，在市场无套利的假设下，该分析师提出的概率向量 $Q$ 对于给定的资产价格而言，并非一个有效的风险中性测度。因此，分析师的声明与数据不一致。然而，基于所提供的公式，此计算过程是完整且正确的。", "answer": "$$\n\\boxed{-\\frac{100}{21}}\n$$", "id": "2427434"}, {"introduction": "掌握了离散时间模型中的基本概念后，我们可以开始处理更具挑战性但更贴近现实的连续时间模型。这个问题超越了简单的期权定价，要求计算在一个随机过程中，资产价格先触及上边界而不是下边界的概率，这对于为障碍期权定价或评估违约风险至关重要。通过将风险中性框架应用于标准的几何布朗运动模型，这个练习展示了该理论在解决金融动态问题中的强大功能 [@problem_id:2427433]。", "problem": "考虑一个无摩擦市场，其中有一个以连续复利无风险利率 $r$ 增长的无股息银行账户，以及一支支付连续股息收益率 $q$ 的股票。在风险中性测度下，股价 $\\{S_t\\}_{t \\geq 0}$ 服从几何布朗运动，其动态为\n$$\n\\mathrm{d}S_t = (r - q)\\,S_t\\,\\mathrm{d}t + \\sigma\\,S_t\\,\\mathrm{d}W_t,\n$$\n其中 $W_t$ 是标准布朗运动，$r$、$q$ 和 $\\sigma$ 是常数。在时间 $t=0$ 时，股价为 $S_0$。\n\n设下边界和上边界分别为 $L$ 和 $U$，且 $0 < L < S_0 < U$。定义首次触及时间\n$$\n\\tau_L = \\inf\\{ t \\geq 0 : S_t = L \\}, \\quad \\tau_U = \\inf\\{ t \\geq 0 : S_t = U \\}.\n$$\n假设该过程在无限期界内（即直到触及其中一个边界）被观测。使用上述风险中性动态，计算股价在触及下边界 $L$ 之前先触及上边界 $U$ 的风险中性概率，即计算\n$$\n\\mathbb{Q}\\big(\\tau_U < \\tau_L \\,\\big|\\, S_0\\big).\n$$\n\n使用以下参数值：\n- $S_0 = 100$，\n- $L = 80$，\n- $U = 130$，\n- $r = 0.03$ 每年，\n- $q = 0.01$ 每年，\n- $\\sigma = 0.20$ 每平方根年。\n\n将最终答案表示为小数，并四舍五入到四位有效数字。", "solution": "该问题要求计算一个关于股价过程 $S_t$ 首次触及两个边界 $L$ 或 $U$ 之一的风险中性概率。该过程被建模为几何布朗运动 (GBM)。\n\n首先，我们对问题陈述进行验证。\n给定条件如下：\n- 股价 $S_t$ 的风险中性动态： $\\mathrm{d}S_t = (r - q)S_t\\mathrm{d}t + \\sigma S_t\\mathrm{d}W_t$。\n- 初始股价：$S_0 = 100$。\n- 下边界：$L = 80$。\n- 上边界：$U = 130$。\n- 无风险利率：$r = 0.03$。\n- 连续股息收益率：$q = 0.01$。\n- 波动率：$\\sigma = 0.20$。\n- 条件 $0 < L < S_0 < U$ 得到满足，因为 $0 < 80 < 100 < 130$。\n\n该问题在量化金融的标准 Black-Scholes-Merton 框架中有科学依据。这是一个良态问题，所有必要的参数都已提供，并且不包含任何矛盾或含糊的陈述。因此，该问题是有效的，我们可以继续求解。\n\n问题在于求概率 $\\mathbb{Q}(\\tau_U < \\tau_L)$，其中 $\\tau_U = \\inf\\{ t \\geq 0 : S_t = U \\}$ 且 $\\tau_L = \\inf\\{ t \\geq 0 : S_t = L \\}$。这是一个经典的随机过程首次穿越时间问题。对于 GBM，解决此类问题的一个标准方法是通过取自然对数将该过程转换为算术布朗运动。\n\n令 $X_t = \\ln(S_t)$。我们应用 Itô's lemma 来找出 $X_t$ 的动态。对于函数 $f(S_t) = \\ln(S_t)$，我们有 $\\frac{\\partial f}{\\partial S_t} = \\frac{1}{S_t}$ 和 $\\frac{\\partial^2 f}{\\partial S_t^2} = -\\frac{1}{S_t^2}$。$X_t$ 的动态由下式给出：\n$$ \\mathrm{d}X_t = \\left( (r-q)S_t \\frac{\\partial f}{\\partial S_t} + \\frac{1}{2}(\\sigma S_t)^2 \\frac{\\partial^2 f}{\\partial S_t^2} \\right) \\mathrm{d}t + \\sigma S_t \\frac{\\partial f}{\\partial S_t} \\mathrm{d}W_t $$\n代入导数：\n$$ \\mathrm{dX_t} = \\left( (r-q)S_t \\left(\\frac{1}{S_t}\\right) + \\frac{1}{2}\\sigma^2 S_t^2 \\left(-\\frac{1}{S_t^2}\\right) \\right) \\mathrm{d}t + \\sigma S_t \\left(\\frac{1}{S_t}\\right) \\mathrm{d}W_t $$\n$$ \\mathrm{d}X_t = \\left( r - q - \\frac{1}{2}\\sigma^2 \\right) \\mathrm{d}t + \\sigma \\mathrm{d}W_t $$\n因此，$X_t$ 是一个具有恒定漂移 $\\nu = r - q - \\frac{1}{2}\\sigma^2$ 和恒定波动率 $\\sigma$ 的算术布朗运动。\n\n$S_t$ 触及 $L$ 或 $U$ 的问题现在转化为 $X_t$ 从 $x_0 = \\ln(S_0)$ 出发，触及 $l = \\ln(L)$ 或 $u = \\ln(U)$。令 $p(x)$ 为从 $x$ 开始的过程 $X_t$ 在触及 $l$ 之前先触及 $u$ 的概率。该概率是以下常微分方程的解：\n$$ \\frac{1}{2}\\sigma^2 p''(x) + \\nu p'(x) = 0 $$\n边界条件为 $p(l) = 0$ 和 $p(u) = 1$。该常微分方程的通解是 $p(x) = C_1 + C_2 \\exp\\left(-\\frac{2\\nu}{\\sigma^2}x\\right)$。\n应用边界条件可得到特解：\n$$ p(x) = \\frac{\\exp\\left(-\\frac{2\\nu}{\\sigma^2}x\\right) - \\exp\\left(-\\frac{2\\nu}{\\sigma^2}l\\right)}{\\exp\\left(-\\frac{2\\nu}{\\sigma^2}u\\right) - \\exp\\left(-\\frac{2\\nu}{\\sigma^2}l\\right)} $$\n通过代入 $x = \\ln(S)$、$l = \\ln(L)$ 和 $u = \\ln(U)$，可以将其用原始资产价格 $S$、$L$ 和 $U$ 重写，利用性质 $\\exp(a \\ln b) = b^a$ 可得：\n$$ p(S) = \\frac{S^{-\\frac{2\\nu}{\\sigma^2}} - L^{-\\frac{2\\nu}{\\sigma^2}}}{U^{-\\frac{2\\nu}{\\sigma^2}} - L^{-\\frac{2\\nu}{\\sigma^2}}} $$\n\n现在，我们使用给定的参数计算漂移 $\\nu$：\n$r = 0.03$\n$q = 0.01$\n$\\sigma = 0.20$\n$$ \\nu = r - q - \\frac{1}{2}\\sigma^2 = 0.03 - 0.01 - \\frac{1}{2}(0.20)^2 = 0.02 - \\frac{1}{2}(0.04) = 0.02 - 0.02 = 0 $$\n漂移 $\\nu$ 正好为零。这是一个特殊情况，其中 $X_t = \\ln(S_t)$ 是一个无漂移布朗運動。在这种情况下，概率的通用公式是不确定的 ($0/0$)。我们必须取 $\\nu \\to 0$ 的极限。常微分方程简化为 $p''(x) = 0$，其通解为 $p(x) = C_1 x + C_2$。\n应用边界条件 $p(l) = 0$ 和 $p(u) = 1$：\n$p(l) = C_1 l + C_2 = 0 \\implies C_2 = -C_1 l$\n$p(u) = C_1 u + C_2 = 1 \\implies C_1 u - C_1 l = 1 \\implies C_1 = \\frac{1}{u-l}$\n由此可得 $C_2 = -\\frac{l}{u-l}$。\n因此，概率为：\n$$ p(x) = \\frac{1}{u-l}x - \\frac{l}{u-l} = \\frac{x-l}{u-l} $$\n我们想计算 $x_0 = \\ln(S_0)$ 时的这个概率：\n$$ \\mathbb{Q}(\\tau_U < \\tau_L) = p(x_0) = \\frac{x_0 - l}{u - l} = \\frac{\\ln(S_0) - \\ln(L)}{\\ln(U) - \\ln(L)} $$\n利用对数的性质，这可以写成：\n$$ \\mathbb{Q}(\\tau_U < \\tau_L) = \\frac{\\ln(S_0/L)}{\\ln(U/L)} $$\n现在我们代入给定的数值：\n$S_0 = 100$\n$L = 80$\n$U = 130$\n$$ \\mathbb{Q}(\\tau_U < \\tau_L) = \\frac{\\ln(100/80)}{\\ln(130/80)} = \\frac{\\ln(1.25)}{\\ln(1.625)} $$\n我们计算数值：\n$$ \\ln(1.25) \\approx 0.22314355 $$\n$$ \\ln(1.625) \\approx 0.48550782 $$\n$$ \\mathbb{Q}(\\tau_U < \\tau_L) \\approx \\frac{0.22314355}{0.48550782} \\approx 0.45960706 $$\n问题要求答案四舍五入到四位有效数字。\n因此，概率为 $0.4596$。", "answer": "$$\n\\boxed{0.4596}\n$$", "id": "2427433"}]}