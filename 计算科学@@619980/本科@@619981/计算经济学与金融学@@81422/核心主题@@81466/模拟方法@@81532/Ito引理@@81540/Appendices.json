{"hands_on_practices": [{"introduction": "一个看上去复杂的随机微分方程（SDE）可能会因其非线性项而令人望而却步。然而，通过一个巧妙的变量替换，我们有时可以将其转化为一个更简单、可解的形式。本练习将向您展示如何运用伊藤引理作为一种强大的解题工具，通过寻找合适的变换，将一个棘手的非线性SDE简化为仅需基本积分即可求解的线性SDE。[@problem_id:2404213]", "problem": "考虑连续时间金融中的随机微分方程 (SDE)\n$$\ndX_t = X_t^{3}\\,dt + X_t^{2}\\,dZ_t,\\quad X_0 = x_0 \\neq 0,\n$$\n其中 $\\{Z_t\\}_{t \\ge 0}$ 是一个标准布朗运动（维纳过程），且 $Z_0 = 0$。在一个满足通常条件的带滤概率空间中进行研究，并以伊藤意义解释该 SDE。求出以 $x_0$ 和 $Z_t$ 表示的显式强解 $X_t$ 的闭式解析表达式。您的最终答案必须是单一的解析表达式。如果您的答案涉及任何停时考虑，请在推理中说明，但不要包含在最终表达式中。", "solution": "问题陈述经过验证，确认有效。这是一个随机分析中的适定问题。给定的随机微分方程 (SDE) 是：\n$$\ndX_t = X_t^{3}\\,dt + X_t^{2}\\,dZ_t\n$$\n初始条件为 $X_0 = x_0$，其中 $x_0 \\neq 0$。过程 $\\{Z_t\\}_{t \\ge 0}$ 是一个标准布朗运动。\n\n漂移系数 $\\mu(x) = x^3$ 和扩散系数 $\\sigma(x) = x^2$ 不满足全局线性增长条件。即，不存在常数 $K$ 使得对所有 $x \\in \\mathbb{R}$ 都有 $|\\mu(x)| \\le K(1 + |x|)$ 和 $|\\sigma(x)| \\le K(1 + |x|)$。这表明解可能在有限时间内爆炸。问题在于找到强解的显式公式，该解可能仅在某个随机停时之前存在。\n\n为了求解此 SDE，我们寻求对过程 $X_t$ 进行变换。令 $Y_t = f(X_t)$，其中 $f$ 为某个二次可微函数。根据 Itō 引理，$Y_t$ 的微分为：\n$$\ndY_t = f'(X_t) dX_t + \\frac{1}{2} f''(X_t) (dX_t)^2\n$$\n将给定的 SDE 代入 $dX_t$ 并使用 Itō 乘法法则 $(dZ_t)^2 = dt$, $(dt)^2 = 0$ 和 $dt\\,dZ_t = 0$，我们得到：\n$$\n(dX_t)^2 = (X_t^{3}\\,dt + X_t^{2}\\,dZ_t)^2 = (X_t^2)^2 (dZ_t)^2 + (\\text{含 } dt \\text{ 的项}) = X_t^4 dt\n$$\n因此，$Y_t$ 的 SDE 变为：\n$$\ndY_t = f'(X_t) (X_t^{3}\\,dt + X_t^{2}\\,dZ_t) + \\frac{1}{2} f''(X_t) X_t^4 dt\n$$\n合并 $dt$ 和 $dZ_t$ 项：\n$$\ndY_t = \\left[ X_t^3 f'(X_t) + \\frac{1}{2} X_t^4 f''(X_t) \\right] dt + X_t^2 f'(X_t) dZ_t\n$$\n我们的目标是选择一个函数 $f$ 来简化此方程。一个标准技巧是消除扩散系数中对 $X_t$ 的依赖。我们将 $dZ_t$ 的系数设为一个常数。我们选择该常数为 $-1$：\n$$\nX_t^2 f'(X_t) = -1\n$$\n这意味着 $f'(x) = -x^{-2}$。这个关于 $f(x)$ 的常微分方程可以通过积分求解：\n$$\nf(x) = \\int -x^{-2} \\,dx = \\frac{1}{x} + C\n$$\n为简便起见，我们可以选择积分常数 $C=0$，从而得到变换 $f(x) = 1/x$。此变换是适定的，因为初始条件 $X_0 = x_0 \\neq 0$，并且可以证明如果过程 $X_t$ 从一个非零值开始，它几乎必然不会达到 $0$。$f(x)$ 的一阶和二阶导数是：\n$$\nf'(x) = -x^{-2} \\quad \\text{和} \\quad f''(x) = 2x^{-3}\n$$\n现在我们将这些导数代入 $Y_t$ 的 SDE 的漂移项中：\n$$\n\\text{漂移项} = X_t^3 f'(X_t) + \\frac{1}{2} X_t^4 f''(X_t) = X_t^3 (-X_t^{-2}) + \\frac{1}{2} X_t^4 (2X_t^{-3}) = -X_t + X_t = 0\n$$\n漂移项消失了。$Y_t$ 的 SDE 极大地简化为：\n$$\ndY_t = 0 \\cdot dt - 1 \\cdot dZ_t = -dZ_t\n$$\n这是一个简单的 SDE，可以通过从 $t=0$ 到 $t$ 的直接积分来求解：\n$$\n\\int_0^t dY_s = - \\int_0^t dZ_s\n$$\n这得到：\n$$\nY_t - Y_0 = -(Z_t - Z_0)\n$$\n已知 $Z_0=0$ 且 $Y_0 = f(X_0) = 1/X_0 = 1/x_0$，我们有：\n$$\nY_t - \\frac{1}{x_0} = -Z_t\n$$\n解出 $Y_t$：\n$$\nY_t = \\frac{1}{x_0} - Z_t\n$$\n最后，我们使用关系式 $X_t = 1/Y_t$ 变换回原始过程 $X_t$：\n$$\nX_t = \\frac{1}{Y_t} = \\frac{1}{\\frac{1}{x_0} - Z_t}\n$$\n该表达式可以通过分子分母同乘以 $x_0$ 来简化：\n$$\nX_t = \\frac{x_0}{1 - x_0 Z_t}\n$$\n这就是过程 $X_t$ 的显式强解。只要分母不为零，该解就存在。令 $\\tau$ 为停时，定义为 $\\tau = \\inf\\{t>0 \\mid 1 - x_0 Z_t = 0\\}$。这是过程 $Z_t$ 首次达到水平 $1/x_0$ 的时刻。对于标准的一维布朗运动，这个时间几乎必然是有限的。因此，解 $X_t$ 以概率 $1$ 在有限时间内爆炸至无穷大。我们找到的表达式是 $t \\in [0, \\tau)$ 时的解。\n\n为了验证解，我们可以对函数 $g(z) = \\frac{x_0}{1-x_0 z}$ 应用 Itō 引理，其中 $X_t = g(Z_t)$。其导数为 $g'(z) = \\frac{x_0^2}{(1-x_0 z)^2}$ 和 $g''(z) = \\frac{2x_0^3}{(1-x_0 z)^3}$。用 $X_t$ 表示，它们变为 $g'(Z_t) = X_t^2$ 和 $g''(Z_t) = 2X_t^3$。\n对 $X_t = g(Z_t)$ 应用 Itō 引理：\n$$\ndX_t = g'(Z_t)dZ_t + \\frac{1}{2}g''(Z_t)(dZ_t)^2 = X_t^2 dZ_t + \\frac{1}{2}(2X_t^3)dt = X_t^3 dt + X_t^2 dZ_t\n$$\n这与原始 SDE 相匹配，从而验证了解的正确性。", "answer": "$$\n\\boxed{\\frac{x_0}{1 - x_0 Z_t}}\n$$", "id": "2404213"}, {"introduction": "在金融和物理学中，许多系统的演化都受到多个随机因素的共同驱动。为了对这类系统进行建模，我们需要理解由多个随机过程构成的函数的动态行为。本练习将伊藤引理的应用从一维推广到多维场景，让您能够推导出一个依赖于两个独立布朗运动的过程的动态学。您将亲自推导出二维贝塞尔过程的SDE，这是一个描述二维平面上随机游走质点到原点距离的基本随机过程。[@problem_id:2404268]", "problem": "在计算金融中，多因子模型通常使用独立的布朗驱动因子来代表风险因子。设 $\\{X_t\\}_{t \\ge 0}$ 和 $\\{Y_t\\}_{t \\ge 0}$ 是在满足通常条件的带滤概率空间上的独立标准维纳过程（标准布朗运动），其确定性初始值为 $X_0 = x_0$ 和 $Y_0 = y_0$。定义径向过程 $R_t = \\sqrt{X_t^2 + Y_t^2}$，并假设 $r_0 = \\sqrt{x_0^2 + y_0^2} > 0$，从而在所考虑的时间范围内 $R_t > 0$ 几乎必然成立。\n\n将 $R_t$ 视为状态 $(X_t,Y_t)$ 的一个光滑函数，并仅从标准维纳过程的定义和连续半鞅的微分法则（特别是独立维纳过程的二次变差性质）出发，推导 $R_t$ 满足的随机微分方程。根据你的推导，在表达式\n$$\n\\mathrm{d}R_t \\;=\\; b(R_t)\\,\\mathrm{d}t \\;+\\; \\sigma(R_t)\\,\\mathrm{d}W_t,\n$$\n中确定漂移系数 $b(r)$ 和扩散系数 $\\sigma(r)$，其中 $\\{W_t\\}_{t \\ge 0}$ 是一个适应于同一滤的一维标准维纳过程。\n\n答案规格：\n- 将你的最终答案表示为函数有序对 $(b(r), \\sigma(r))$，并按此顺序以行矩阵的形式给出，使用变量 $r$ 作为参数。\n- 最终答案必须是无单位的单个解析表达式。无需进行数值取整。", "solution": "给定独立的标准维纳过程 $\\{X_t\\}_{t \\ge 0}$ 和 $\\{Y_t\\}_{t \\ge 0}$，其二次变差和协变差为\n$$\n\\mathrm{d}\\langle X \\rangle_t = \\mathrm{d}t, \n\\quad \n\\mathrm{d}\\langle Y \\rangle_t = \\mathrm{d}t, \n\\quad \n\\mathrm{d}\\langle X, Y \\rangle_t = 0,\n$$\n我们定义 $R_t = f(X_t, Y_t)$，其中 $f(x,y) = \\sqrt{x^2 + y^2}$。我们假设在所关注的时间范围内 $R_t > 0$，因此函数 $f$ 在相关状态区域上是光滑的，且下文的导数是良定义的。\n\n我们计算 $f$ 的一阶和二阶偏导数。设 $r = \\sqrt{x^2 + y^2}$。那么\n$$\nf_x(x,y) = \\frac{\\partial f}{\\partial x}(x,y) = \\frac{x}{r}, \n\\qquad\nf_y(x,y) = \\frac{\\partial f}{\\partial y}(x,y) = \\frac{y}{r}.\n$$\n对于二阶导数，\n$$\nf_{xx}(x,y) = \\frac{\\partial}{\\partial x}\\!\\left(\\frac{x}{r}\\right) \n= \\frac{1}{r} - \\frac{x^2}{r^3} \n= \\frac{r^2 - x^2}{r^3} \n= \\frac{y^2}{r^3},\n$$\n$$\nf_{yy}(x,y) = \\frac{\\partial}{\\partial y}\\!\\left(\\frac{y}{r}\\right) \n= \\frac{1}{r} - \\frac{y^2}{r^3} \n= \\frac{r^2 - y^2}{r^3} \n= \\frac{x^2}{r^3},\n$$\n混合偏导数为\n$$\nf_{xy}(x,y) = \\frac{\\partial}{\\partial y}\\!\\left(\\frac{x}{r}\\right) \n= - \\frac{x y}{r^3}.\n$$\n\n对 $R_t = f(X_t, Y_t)$ 应用多维形式的伊藤引理，可以得出\n$$\n\\mathrm{d}R_t \n= f_x(X_t, Y_t)\\,\\mathrm{d}X_t + f_y(X_t, Y_t)\\,\\mathrm{d}Y_t \n+ \\frac{1}{2}\\Big( f_{xx}(X_t, Y_t)\\,\\mathrm{d}\\langle X \\rangle_t \n+ 2 f_{xy}(X_t, Y_t)\\,\\mathrm{d}\\langle X, Y \\rangle_t \n+ f_{yy}(X_t, Y_t)\\,\\mathrm{d}\\langle Y \\rangle_t \\Big).\n$$\n利用二次变差关系和独立性，我们代入 $\\mathrm{d}\\langle X \\rangle_t = \\mathrm{d}t$、$\\mathrm{d}\\langle Y \\rangle_t = \\mathrm{d}t$ 和 $\\mathrm{d}\\langle X, Y \\rangle_t = 0$ 得到\n$$\n\\mathrm{d}R_t \n= \\frac{X_t}{R_t}\\,\\mathrm{d}X_t + \\frac{Y_t}{R_t}\\,\\mathrm{d}Y_t \n+ \\frac{1}{2}\\left( \\frac{Y_t^2}{R_t^3} + \\frac{X_t^2}{R_t^3} \\right)\\mathrm{d}t \n= \\frac{X_t}{R_t}\\,\\mathrm{d}X_t + \\frac{Y_t}{R_t}\\,\\mathrm{d}Y_t \n+ \\frac{1}{2}\\left( \\frac{X_t^2 + Y_t^2}{R_t^3} \\right)\\mathrm{d}t.\n$$\n由于 $R_t^2 = X_t^2 + Y_t^2$，漂移项简化为\n$$\n\\frac{1}{2}\\left( \\frac{R_t^2}{R_t^3} \\right)\\mathrm{d}t = \\frac{1}{2 R_t}\\,\\mathrm{d}t.\n$$\n因此，\n$$\n\\mathrm{d}R_t \n= \\frac{1}{2 R_t}\\,\\mathrm{d}t + \\frac{X_t}{R_t}\\,\\mathrm{d}X_t + \\frac{Y_t}{R_t}\\,\\mathrm{d}Y_t.\n$$\n\n我们现在分析扩散项\n$$\nM_t := \\int_0^t \\frac{X_s}{R_s}\\,\\mathrm{d}X_s + \\int_0^t \\frac{Y_s}{R_s}\\,\\mathrm{d}Y_s.\n$$\n其二次变差为\n$$\n\\mathrm{d}\\langle M \\rangle_t \n= \\left(\\frac{X_t}{R_t}\\right)^2 \\mathrm{d}\\langle X \\rangle_t \n+ \\left(\\frac{Y_t}{R_t}\\right)^2 \\mathrm{d}\\langle Y \\rangle_t \n+ 2 \\frac{X_t}{R_t}\\frac{Y_t}{R_t} \\mathrm{d}\\langle X, Y \\rangle_t\n= \\left( \\frac{X_t^2 + Y_t^2}{R_t^2} \\right)\\mathrm{d}t \n= \\mathrm{d}t.\n$$\n因此，$M_t$ 是一个二次变差为单位的连续局部鞅，所以存在一个适应于同一滤的一维标准维纳过程 $\\{W_t\\}_{t \\ge 0}$，使得\n$$\n\\frac{X_t}{R_t}\\,\\mathrm{d}X_t + \\frac{Y_t}{R_t}\\,\\mathrm{d}Y_t = \\mathrm{d}W_t.\n$$\n于是，\n$$\n\\mathrm{d}R_t = \\frac{1}{2 R_t}\\,\\mathrm{d}t + \\mathrm{d}W_t.\n$$\n\n与表达式 $\\mathrm{d}R_t = b(R_t)\\,\\mathrm{d}t + \\sigma(R_t)\\,\\mathrm{d}W_t$ 进行比较，我们确定\n$$\nb(r) = \\frac{1}{2 r}, \n\\qquad \n\\sigma(r) = 1,\n$$\n对于 $r > 0$。这些是二维贝塞尔过程的漂移系数和扩散系数，而二维贝塞尔过程是二维布朗运动的径向部分。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2r} & 1\\end{pmatrix}}$$", "id": "2404268"}, {"introduction": "像伊藤引理这样抽象的数学公式，有时会让人感觉与现实脱节。建立直觉并验证理解的一个有效方法，就是通过数值模拟来检验理论的正确性。这个动手编程练习将搭建起连续时间理论与离散时间计算之间的桥梁。您将模拟一条几何布朗运动的路径，并用数值方法验证其对数过程的演化与伊藤引理的预测完全吻合，从而为该公式的正确性提供具体而直观的证据。[@problem_id:2404258]", "problem": "考虑一个单一资产价格过程，其被建模为几何布朗运动 (GBM)，由以下随机微分方程 (SDE) 定义\n$$\n\\mathrm{d}S_t=\\mu S_t\\,\\mathrm{d}t+\\sigma S_t\\,\\mathrm{d}W_t,\n$$\n其中 $S_t$ 是在时间 $t$ 的资产价格，$\\mu$ 是常数漂移率，$\\sigma$ 是常数波动率，而 $W_t$ 是一个标准维纳过程（布朗运动）。设 $f(s)=\\ln(s)$，并用 $\\Delta \\ln(S)$ 表示在微小时间步长 $\\Delta t$ 内已实现的离散变化 $\\ln(S_{t_{k+1}})-\\ln(S_{t_k})$。\n\n对上述GBM应用Itō引理于$f(s)=\\ln(s)$，确定$\\ln(S_t)$瞬时变化的公式，并用该公式以$\\mu$、$\\sigma$、$\\Delta t$和布朗增量$\\Delta W_k:=W_{t_{k+1}}-W_{t_k}$的形式，指明$\\ln(S)$在单个步骤上的预测离散增量。然后，对于下方的每个测试用例，使用均匀网格 $0=t_0<t_1<\\dots<t_N=T$（其中 $t_{k+1}-t_k=\\Delta t=T/N$）以及独立的、每个都服从均值为0、方差为$\\Delta t$的正态分布的高斯增量 $\\Delta W_k$，构建一条在时间区间 $[0,T]$ 上与该SDE一致的模拟路径。为保证可复现性，每个测试用例的布朗增量必须由测试套件中指定的固定伪随机数种子生成。\n\n对于每个测试用例，计算：\n- 模拟路径上已实现的对数增量序列 $\\Delta \\ln(S)_k:=\\ln(S_{t_{k+1}})-\\ln(S_{t_k})$，\n- 使用相同的 $\\Delta W_k$，根据您的 Itō 引理公式得到的预测对数增量序列，\n- 路径上的最大绝对差异，\n$$\n\\max_{0\\le k\\le N-1}\\left|\\Delta \\ln(S)_k-\\left(\\text{prediction from Itō's lemma at step }k\\right)\\right|.\n$$\n\n当且仅当此最大绝对差异小于或等于容差 $10^{-10}$ 时，该测试用例才被视为通过。\n\n测试套件（每个元组为 $(S_0,\\mu,\\sigma,T,N,\\text{seed})$）：\n1. $(100.0,\\,0.08,\\,0.2,\\,1.0,\\,5000,\\,11)$\n2. $(100.0,\\,0.05,\\,0.0,\\,1.0,\\,100,\\,13)$\n3. $(250.0,\\,0.0,\\,0.3,\\,2.0,\\,2000,\\,17)$\n4. $(50.0,\\,-0.1,\\,0.15,\\,1.5,\\,1500,\\,19)$\n5. $(1.0,\\,0.2,\\,0.4,\\,0.0,\\,1,\\,23)$\n\n要求：\n- 完全按照所列参数使用。\n- 对于每个测试用例，使用指定的该用例的种子，根据所述时间网格和方差为 $\\Delta t$ 的独立高斯增量生成单条路径。\n- 为每个用例输出一个布尔值，以表明是否满足通过标准。\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，\"[true_case1,true_case2,...]\"）。对布尔值请使用文本表示 \"True\" 和 \"False\"。", "solution": "在尝试解答之前，需对问题陈述进行验证。\n\n步骤1：提取已知信息\n- 资产价格过程：几何布朗运动 (GBM)，由随机微分方程 (SDE) $\\mathrm{d}S_t=\\mu S_t\\,\\mathrm{d}t+\\sigma S_t\\,\\mathrm{d}W_t$ 定义。\n- 参数：$\\mu$ 是常数漂移率，$\\sigma$ 是常数波动率。\n- 随机过程：$W_t$ 是一个标准维纳过程。\n- 目标函数：$f(s)=\\ln(s)$。\n- 离散变化定义：$\\Delta \\ln(S)$ 是已实现的离散变化 $\\ln(S_{t_{k+1}})-\\ln(S_{t_k})$。\n- 布朗增量定义：$\\Delta W_k := W_{t_{k+1}}-W_{t_k}$。\n- 时间网格：均匀网格 $0=t_0<t_1<\\dots<t_N=T$，时间步长为 $\\Delta t=t_{k+1}-t_k=T/N$。\n- 增量分布：$\\Delta W_k$ 是独立的，服从均值为0、方差为$\\Delta t$的正态分布。\n- 任务：\n    1. 对 $f(s)=\\ln(s)$ 使用 Itō 引理，推导 $\\ln(S_t)$ 瞬时变化的公式。\n    2. 用此公式指明 $\\ln(S)$ 在单个步骤上的预测离散增量。\n    3. 为每个测试用例模拟一条 $S_t$ 的路径。\n    4. 计算已实现的对数增量序列 $\\Delta \\ln(S)_k = \\ln(S_{t_{k+1}}) - \\ln(S_{t_k})$。\n    5. 根据推导出的公式计算预测的对数增量序列。\n    6. 计算最大绝对差异：$\\max_{0\\le k\\le N-1}\\left|\\Delta \\ln(S)_k-\\left(\\text{prediction from Itō's lemma at step }k\\right)\\right|$。\n- 通过标准：最大绝对差异必须小于或等于容差 $10^{-10}$。\n- 测试套件：\n    1. $(S_0=100.0, \\mu=0.08, \\sigma=0.2, T=1.0, N=5000, \\text{seed}=11)$\n    2. $(S_0=100.0, \\mu=0.05, \\sigma=0.0, T=1.0, N=100, \\text{seed}=13)$\n    3. $(S_0=250.0, \\mu=0.0, \\sigma=0.3, T=2.0, N=2000, \\text{seed}=17)$\n    4. $(S_0=50.0, \\mu=-0.1, \\sigma=0.15, T=1.5, N=1500, \\text{seed}=19)$\n    5. $(S_0=1.0, \\mu=0.2, \\sigma=0.4, T=0.0, N=1, \\text{seed}=23)$\n\n步骤2：使用提取的已知信息进行验证\n- **科学依据**：该问题基于几何布朗运动和 Itō 引理，这些是数学金融和随机微积分中经典的、普适接受的模型。其前提在事实上是合理的。\n- **适定性**：问题定义清晰。它要求进行推导、基于指定程序的模拟以及定量比较。为每个测试用例提供了所有必要的参数和条件，包括初始值、模型参数、时间范围、离散化步数和随机数生成器种子。目标（通过/失败标准）明确无误。\n- **客观性**：问题以精确的数学和计算术语陈述，没有主观性或模糊性。\n- **完整性与一致性**：问题是自洽的。测试用例（包括 $T=0$ 的退化情况）都已指定，且没有引入矛盾。连续SDE与其离散模拟之间的关系是一个标准课题。\n- **未检测到其他缺陷。**\n\n步骤3：结论与行动\n该问题是有效的。它构成了一个将随机微积分应用于计算金融的标准且有启发性的练习，特别是检验对 $\\ln(S_t)$ 过程具有精确离散时间解这一点的理解。我们着手进行解答。\n\n**理论推导**\n\n分析始于 Itō 引理。对于一个遵循SDE $\\mathrm{d}S_t = a(S_t, t)\\,\\mathrm{d}t + b(S_t, t)\\,\\mathrm{d}W_t$ 的随机过程 $S_t$ 的二次可微函数 $f(S_t)$，其变化 $\\mathrm{d}f$ 由下式给出：\n$$\n\\mathrm{d}f(S_t) = \\left( \\frac{\\partial f}{\\partial S_t} a(S_t, t) + \\frac{1}{2} \\frac{\\partial^2 f}{\\partial S_t^2} b(S_t, t)^2 \\right) \\mathrm{d}t + \\frac{\\partial f}{\\partial S_t} b(S_t, t) \\,\\mathrm{d}W_t\n$$\n在本问题中，该过程是GBM，因此 $S_t$ 遵循 $\\mathrm{d}S_t = \\mu S_t\\,\\mathrm{d}t + \\sigma S_t\\,\\mathrm{d}W_t$。因此，我们确定 $a(S_t, t) = \\mu S_t$ 和 $b(S_t, t) = \\sigma S_t$。函数为 $f(s) = \\ln(s)$。我们计算它关于 $s$ 的偏导数：\n$$\n\\frac{\\partial f}{\\partial s} = \\frac{1}{s}\n$$\n$$\n\\frac{\\partial^2 f}{\\partial s^2} = -\\frac{1}{s^2}\n$$\n将这些表达式代入 Itō 引理：\n$$\n\\mathrm{d}(\\ln S_t) = \\left( \\left(\\frac{1}{S_t}\\right) (\\mu S_t) + \\frac{1}{2} \\left(-\\frac{1}{S_t^2}\\right) (\\sigma S_t)^2 \\right) \\mathrm{d}t + \\left(\\frac{1}{S_t}\\right) (\\sigma S_t) \\,\\mathrm{d}W_t\n$$\n化简各项可得 $\\ln(S_t)$ 的SDE：\n$$\n\\mathrm{d}(\\ln S_t) = \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) \\mathrm{d}t + \\sigma \\,\\mathrm{d}W_t\n$$\n这就是瞬时变化所要求的公式。$\\ln(S_t)$ 的过程是一个具有恒定漂移率 $(\\mu - \\frac{1}{2}\\sigma^2)$ 和恒定波动率 $\\sigma$ 的算术布朗运动。\n\n为了找到在一个时间步长 $\\Delta t = t_{k+1} - t_k$ 上的离散增量，我们将SDE从 $t_k$ 积分到 $t_{k+1}$：\n$$\n\\int_{t_k}^{t_{k+1}} \\mathrm{d}(\\ln S_t) = \\int_{t_k}^{t_{k+1}} \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) \\mathrm{d}t + \\int_{t_k}^{t_{k+1}} \\sigma \\,\\mathrm{d}W_t\n$$\n这得到：\n$$\n\\ln(S_{t_{k+1}}) - \\ln(S_{t_k}) = \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) \\Delta t + \\sigma (W_{t_{k+1}} - W_{t_k})\n$$\n使用记号 $\\Delta W_k = W_{t_{k+1}} - W_{t_k}$，我们得到预测的离散对数增量公式：\n$$\n\\text{Predicted Increment}_k = \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) \\Delta t + \\sigma \\Delta W_k\n$$\n\n**模拟与验证**\n\n$\\ln(S_t)$ 的SDE具有常系数，这允许我们采用一个精确的模拟方案。$\\ln(S_t)$ 的离散时间演化由上面推导的公式给出。对两边取指数，可以得到 $S_{t_{k+1}}$ 关于 $S_{t_k}$ 的精确解：\n$$\nS_{t_{k+1}} = S_{t_k} \\exp\\left( \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) \\Delta t + \\sigma \\Delta W_k \\right)\n$$\n这就是按要求模拟GBM路径的正确方法。\n\n问题要求比较“已实现”和“预测”的对数增量。\n- **预测**增量是 $\\ln(S_t)$ 积分后SDE的右侧：$\\left(\\mu - \\frac{1}{2}\\sigma^2 \\right)\\Delta t + \\sigma \\Delta W_k$。\n- **已实现**增量定义为 $\\Delta \\ln(S)_k = \\ln(S_{t_{k+1}}) - \\ln(S_{t_k})$。\n\n将 $S_{t_{k+1}}$ 的模拟公式代入已实现增量的定义中，我们发现：\n$$\n\\Delta \\ln(S)_k = \\ln\\left(S_{t_k} \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2 \\right)\\Delta t + \\sigma \\Delta W_k \\right)\\right) - \\ln(S_{t_k})\n$$\n使用对数性质 $\\ln(ab) = \\ln(a) + \\ln(b)$：\n$$\n\\Delta \\ln(S)_k = \\left(\\ln(S_{t_k}) + \\ln\\left(\\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2 \\right)\\Delta t + \\sigma \\Delta W_k \\right)\\right)\\right) - \\ln(S_{t_k})\n$$\n$$\n\\Delta \\ln(S)_k = \\ln\\left(\\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2 \\right)\\Delta t + \\sigma \\Delta W_k \\right)\\right)\n$$\n从解析上讲，已实现增量与预测增量完全相同。那么，差异为：\n$$\n\\text{Discrepancy}_k = \\left| \\ln(\\exp(\\text{Predicted}_k)) - \\text{Predicted}_k \\right|\n$$\n这衡量了浮点数运算的一个基本属性。对于任何浮点数 $x$，只要 $\\exp(x)$ 不发生上溢或下溢，$\\ln(\\exp(x))$ 的计算结果就非常接近 $x$。因此，该问题实际上是验证这个计算误差是否在指定的容差 $10^{-10}$ 之内。\n\n**算法**\n对于每个测试用例 $(S_0, \\mu, \\sigma, T, N, \\text{seed})$：\n1.  为保证可复现性，将随机数生成器种子设置为 `seed`。\n2.  如果 $N>0$，计算时间步长 $\\Delta t = T / N$。如果 $N=0$，则不进行任何步骤，差异自然为0。但是，所有测试用例的 $N \\ge 1$。\n3.  生成一个包含 $N$ 个独立布朗增量 $\\Delta W_k$ 的数组，其中每个增量都从均值为0、方差为 $\\Delta t$ 的正态分布中抽取。这可以通过从标准正态分布 $\\mathcal{N}(0, 1)$ 中抽样 $N$ 个值 $Z_k$，然后令 $\\Delta W_k = Z_k \\sqrt{\\Delta t}$ 来实现。\n4.  使用推导的公式计算预测的对数增量数组：$\\text{Predicted}_k = (\\mu - 0.5\\sigma^2)\\Delta t + \\sigma \\Delta W_k$。\n5.  模拟资产价格路径 $S_t$。初始化一个大小为 $N+1$ 的数组 $S$，并令 $S_0$ 为其初值。然后，对于 $k = 0, \\dots, N-1$，计算 $S_{t_{k+1}} = S_{t_k} \\exp(\\text{Predicted}_k)$。这可以使用累积乘积进行矢量化。\n6.  计算已实现的对数增量数组：$\\Delta \\ln(S)_k = \\ln(S_{t_{k+1}}) - \\ln(S_{t_k})$。这可以通过对路径 $S$ 取自然对数，然后计算一阶差分来完成。\n7.  计算在所有 $N$ 个步骤中，预测增量和已实现增量之间的最大绝对差异。\n8.  将此最大差异与容差 $10^{-10}$ 进行比较，以确定测试用例是否通过。\n9.  收集所有测试用例的布尔结果。\n\n这个过程将在最终的程序中实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by deriving the discrete log-increment formula from Ito's lemma,\n    simulating GBM paths, and comparing realized vs. predicted increments.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (S0, mu, sigma, T, N, seed)\n        (100.0, 0.08, 0.2, 1.0, 5000, 11),\n        (100.0, 0.05, 0.0, 1.0, 100, 13),\n        (250.0, 0.0, 0.3, 2.0, 2000, 17),\n        (50.0, -0.1, 0.15, 1.5, 1500, 19),\n        (1.0, 0.2, 0.4, 0.0, 1, 23),\n    ]\n\n    results = []\n    tolerance = 1e-10\n\n    for case in test_cases:\n        s0, mu, sigma, T, N, seed = case\n        \n        # N must be an integer\n        N = int(N)\n\n        # Handle the case where N=0, though not in the test suite.\n        # The max over an empty set of steps is 0.\n        if N == 0:\n            results.append(True)\n            continue\n            \n        # Set seed for reproducibility\n        np.random.seed(seed)\n\n        # Calculate time step\n        dt = T / N\n\n        # 1. Generate Brownian increments dW ~ N(0, dt)\n        # We generate N standard normal variables Z and scale them.\n        Z = np.random.standard_normal(N)\n        dW = Z * np.sqrt(dt)\n\n        # 2. Calculate the sequence of predicted log-increments from Ito's lemma\n        # d(lnS) = (mu - 0.5*sigma^2)dt + sigma*dW\n        predicted_log_increments = (mu - 0.5 * sigma**2) * dt + sigma * dW\n\n        # 3. Construct the simulated path for S_t.\n        # S_{t+dt} = S_t * exp((mu - 0.5*sigma^2)dt + sigma*dW)\n        # This can be done vectorially for efficiency.\n        # First, compute the cumulative product of the exponential terms.\n        # S[k] = S0 * product(exp(predicted_increments[i])) for i=0 to k-1\n        s_path = np.zeros(N + 1)\n        s_path[0] = s0\n        # The cumulative product builds the path S_1, S_2, ...\n        s_path[1:] = s0 * np.cumprod(np.exp(predicted_log_increments))\n\n        # 4. Compute the sequence of realized log-increments\n        # delta_ln_S = ln(S_{k+1}) - ln(S_k)\n        # Suppress \"divide by zero\" or \"invalid value\" warnings for log if S becomes 0,\n        # although this is extremely unlikely with standard parameters.\n        with np.errstate(divide='ignore', invalid='ignore'):\n            log_s_path = np.log(s_path)\n        \n        # Check for -inf or nan in log_s_path, which would indicate S hit 0 or below.\n        if np.any(np.isneginf(log_s_path)) or np.any(np.isnan(log_s_path)):\n             # This path is numerically unstable, discrepancy is likely large.\n             # This case should not happen with the given parameters but is a robust check.\n             max_discrepancy = np.inf\n        else:\n            realized_log_increments = np.diff(log_s_path)\n    \n            # 5. Compute the maximum absolute discrepancy\n            # The discrepancy at each step is due to floating point error in log(exp(x)) != x\n            discrepancies = np.abs(realized_log_increments - predicted_log_increments)\n            max_discrepancy = np.max(discrepancies)\n\n        # 6. Check if the pass criterion is met\n        pass_criterion_met = max_discrepancy = tolerance\n        results.append(str(pass_criterion_met))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2404258"}]}