{"hands_on_practices": [{"introduction": "要真正掌握LU分解，最好的方法就是亲自动手计算。这个练习将引导你对一个简单的 $3 \\times 3$ 矩阵进行Doolittle分解，其中 $L$ 是一个单位下三角矩阵。通过逐步计算出 $L$ 和 $U$ 矩阵的元素，你将熟悉LU分解的核心算法，为解决更复杂的问题打下坚实的基础。[@problem_id:2186375]", "problem": "在数值线性代数中，将一个矩阵分解为一个下三角矩阵和一个上三角矩阵的乘积是一项基本运算。这种分解被称为LU分解，并用于各种算法中，例如求解线性方程组。\n\n考虑矩阵 $A$ 如下：\n$$\nA = \\begin{pmatrix} 3 & -1 & 2 \\\\ 6 & 1 & 9 \\\\ -9 & 5 & -5 \\end{pmatrix}\n$$\n该矩阵可以唯一地分解为乘积 $A = LU$，其中 $L$ 是一个单位下三角矩阵（即对角线上元素为1），而 $U$ 是一个上三角矩阵。这两个 $3 \\times 3$ 矩阵的一般形式为：\n$$\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ l_{21} & 1 & 0 \\\\ l_{31} & l_{32} & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} u_{11} & u_{12} & u_{13} \\\\ 0 & u_{22} & u_{23} \\\\ 0 & 0 & u_{33} \\end{pmatrix}\n$$\n对于给定的矩阵 $A$，确定矩阵 $L$ 的非对角线元素和矩阵 $U$ 的所有元素的数值。将你的最终答案表示为一个单行矩阵，其中包含按特定顺序 $(l_{21}, l_{31}, l_{32}, u_{11}, u_{12}, u_{13}, u_{22}, u_{23}, u_{33})$排列的这九个值。将所有分数值表示为其最简形式。", "solution": "我们使用 Doolittle LU 分解法，其中 $L$ 是单位下三角矩阵，$U$ 是上三角矩阵，满足 $A=LU$。其中\n$$\nL=\\begin{pmatrix}1&0&0\\\\ l_{21}&1&0\\\\ l_{31}&l_{32}&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}&u_{12}&u_{13}\\\\ 0&u_{22}&u_{23}\\\\ 0&0&u_{33}\\end{pmatrix},\n$$\n乘积 $LU$ 按行计算如下：\n- 第1行：$[u_{11},u_{12},u_{13}]=[3,-1,2]$，因此 $u_{11}=3$，$u_{12}=-1$，$u_{13}=2$。\n- 第2行，第1列：$l_{21}u_{11}=a_{21}=6$，所以 $l_{21}=\\frac{a_{21}}{u_{11}}=\\frac{6}{3}=2$。\n- 第3行，第1列：$l_{31}u_{11}=a_{31}=-9$，所以 $l_{31}=\\frac{a_{31}}{u_{11}}=\\frac{-9}{3}=-3$。\n- 第2行，第2列：$l_{21}u_{12}+u_{22}=a_{22}=1$，所以 $u_{22}=a_{22}-l_{21}u_{12}=1-2(-1)=3$。\n- 第2行，第3列：$l_{21}u_{13}+u_{23}=a_{23}=9$，所以 $u_{23}=a_{23}-l_{21}u_{13}=9-2\\cdot 2=5$。\n- 第3行，第2列：$l_{31}u_{12}+l_{32}u_{22}=a_{32}=5$，所以 $l_{32}=\\frac{a_{32}-l_{31}u_{12}}{u_{22}}=\\frac{5-(-3)(-1)}{3}=\\frac{5-3}{3}=\\frac{2}{3}$。\n- 第3行，第3列：$l_{31}u_{13}+l_{32}u_{23}+u_{33}=a_{33}=-5$，所以\n$$\nu_{33}=a_{33}-l_{31}u_{13}-l_{32}u_{23}=-5-(-3\\cdot 2)-\\left(\\frac{2}{3}\\cdot 5\\right)=-5+6-\\frac{10}{3}=1-\\frac{10}{3}=-\\frac{7}{3}.\n$$\n\n因此，按照要求的顺序 $(l_{21}, l_{31}, l_{32}, u_{11}, u_{12}, u_{13}, u_{22}, u_{23}, u_{33})$，这些值为\n$$\n\\begin{pmatrix}\n2 & -3 & \\frac{2}{3} & 3 & -1 & 2 & 3 & 5 & -\\frac{7}{3}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}2 & -3 & \\frac{2}{3} & 3 & -1 & 2 & 3 & 5 & -\\frac{7}{3}\\end{pmatrix}}$$", "id": "2186375"}, {"introduction": "理论算法在实际应用中常会遇到边界情况。这个练习是一个思想实验，它揭示了基础LU分解算法的一个关键限制：当主元（pivot）为零时，算法会失败。通过分析为何“朴素”分解法在此处失效，并证明该矩阵本身是可逆的，你将更深刻地理解为何在稳健的数值计算中，主元选择（pivoting）策略是必不可少的。[@problem_id:2407904]", "problem": "一位经济学家正在为一个包含$3$个金融部门的程式化交叉风险暴露网络建模，其中每个部门的内生融资成本仅依赖于其他部门的短期利率，而不依赖于其自身。这种刻意的模型选择对应于一种自身效应为零的极端交叉依赖情况，这可能在计价物归一化或有约束力的无自我借贷规则下出现。由此产生的线性系统表示为 $A x = b$，其中\n$$\nA \\;=\\; \\begin{pmatrix}\n0 & 1 & 1 \\\\\n1 & 0 & 1 \\\\\n1 & 1 & 0\n\\end{pmatrix},\n$$\n其中对角线上的零元素表示没有直接的自我依赖，而非对角线上的1表示对称的交叉依赖。\n\n从高斯消元法和LU（下三角-上三角）分解的核心定义出发，解释为何即使底层系统是适定的，对矩阵$A$进行不选主元的朴素LU分解也会失败。然后，仅使用行列式和消元法的基本性质，确定$\\det(A)$的精确值。以精确形式给出最终答案，不要四舍五入。", "solution": "该问题陈述是连贯的、在数学上无歧义的，并且基于线性代数的标准原理。它针对一个程式化经济模型中的特定矩阵的性质提出了一组有效的问题。我们将着手进行分析。\n\n问题要求两件事：首先，解释对给定矩阵$A$进行朴素LU（下三角-上三角）分解失败的原因；其次，使用基本原理计算$A$的行列式。\n\n所讨论的矩阵是：\n$$\nA = \\begin{pmatrix}\n0 & 1 & 1 \\\\\n1 & 0 & 1 \\\\\n1 & 1 & 0\n\\end{pmatrix}\n$$\n\n第一部分：不选主元的朴素LU分解的失败\n\n矩阵$A$的LU分解是寻找一个下三角矩阵$L$和一个上三角矩阵$U$使得$A = LU$的过程。通常，$L$被约束为单位下三角矩阵，即其对角元素全为$1$。矩阵$U$通过高斯消元过程得到，而矩阵$L$存储了用于在$A$的下半部分制造零的乘数。\n\n高斯消元算法通过使用称为主元的对角元素来消除每列中其下方的非零项。让我们对矩阵$A$尝试这个过程。\n\n第一步是使用主元$a_{11}$来消除元素$a_{21}$和$a_{31}$。标准的行变换是：\n$R_2 \\rightarrow R_2 - l_{21} R_1$\n$R_3 \\rightarrow R_3 - l_{31} R_1$\n其中乘数为$l_{21} = \\frac{a_{21}}{a_{11}}$和$l_{31} = \\frac{a_{31}}{a_{11}}$。\n\n在我们的矩阵$A$中，第一个主元是$a_{11} = 0$。第一个乘数$l_{21}$的计算需要以下运算：\n$$\nl_{21} = \\frac{a_{21}}{a_{11}} = \\frac{1}{0}\n$$\n这个运算构成了除以零，这是一个未定义的数学运算。因此，标准的高斯消元算法无法通过第一步。由于朴素LU分解算法是这一消元过程的直接实现，它从一开始就失败了。失败的根本原因正是主元为零。在实践中，这个问题的补救方法是主元选择（pivoting），它通过行交换将一个非零元素放到主元位置。问题指定了“朴素”分解，根据定义，这排除了此类主元选择策略。\n\n因此，尽管系统$Ax=b$是适定的（我们将通过证明$\\det(A) \\neq 0$来证实这一点），但用于LU分解的朴素计算算法由于主元位置上出现零而失败。\n\n第二部分：使用基本性质计算$\\det(A)$\n\n问题要求使用行列式在初等行变换下的性质来确定$\\det(A)$。关键性质如下：\n1.  交换矩阵的两行，其行列式乘以$-1$。\n2.  将一行的倍数加到另一行上，行列式的值不变。\n3.  上三角矩阵的行列式是其对角元素的乘积。\n\n我们将把$A$变换成一个上三角形式，并跟踪行列式如何变化。\n$$\nA = \\begin{pmatrix}\n0 & 1 & 1 \\\\\n1 & 0 & 1 \\\\\n1 & 1 & 0\n\\end{pmatrix}\n$$\n如前所述，主元$a_{11} = 0$是有问题的。我们执行一次行交换，例如$R_1 \\leftrightarrow R_2$。根据性质1，这会引入一个因子$-1$。\n$$\n\\det(A) = - \\det \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n1 & 1 & 0\n\\end{pmatrix}\n$$\n新的主元是$1$，非零。元素$a_{21}$已经是$0$。我们继续通过行变换$R_3 \\rightarrow R_3 - R_1$来消除$a_{31} = 1$。根据性质2，这个操作不改变行列式的值。\n$$\n\\det(A) = - \\det \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n1-1 & 1-0 & 0-1\n\\end{pmatrix}\n= - \\det \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n0 & 1 & -1\n\\end{pmatrix}\n$$\n现在，我们使用第二个主元$a_{22} = 1$来消除元素$a_{32} = 1$。我们执行行变换$R_3 \\rightarrow R_3 - R_2$。同样，这不会改变行列式的值。\n$$\n\\det(A) = - \\det \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n0-0 & 1-1 & -1-1\n\\end{pmatrix}\n= - \\det \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n0 & 0 & -2\n\\end{pmatrix}\n$$\n得到的矩阵是一个上三角矩阵，我们称之为$U$。根据性质3，其行列式是其对角线元素的乘积：\n$$\n\\det(U) = (1)(1)(-2) = -2\n$$\n因此，原始矩阵$A$的行列式为：\n$$\n\\det(A) = - \\det(U) = -(-2) = 2\n$$\n由于$\\det(A) = 2 \\neq 0$，矩阵$A$是可逆的，且对于任何向量$b$，线性系统$Ax=b$都有唯一解。这证实了问题本身的断言，即尽管朴素分解算法失败，但其底层系统是适定的。", "answer": "$$\\boxed{2}$$", "id": "2407904"}, {"introduction": "LU分解的主要应用是高效地求解线性方程组，这在经济建模中是一项常见任务。这个练习将分解过程与其最终应用联系起来，要求你使用前向替换和后向替换的两步法来求解一个 $A\\mathbf{x} = \\mathbf{b}$ 系统。完成这个练习后，你将完全理解为何LU分解是求解多个具有相同系数矩阵的线性系统的宝贵工具。[@problem_id:12944]", "problem": "一个线性方程组可以用矩阵形式表示为 $A\\mathbf{x} = \\mathbf{b}$。求解此类方程组的一个强大方法是 LU 分解，其中矩阵 $A$ 被分解为一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 的乘积，使得 $A = LU$。\n\n原始方程组 $A\\mathbf{x} = \\mathbf{b}$ 可以重写为 $LU\\mathbf{x} = \\mathbf{b}$。这个方程可以通过两个步骤求解：\n1.  定义一个中间向量 $\\mathbf{y} = U\\mathbf{x}$。\n2.  首先，使用前向代入法求解方程组 $L\\mathbf{y} = \\mathbf{b}$ 以得到 $\\mathbf{y}$。\n3.  然后，使用回代法求解方程组 $U\\mathbf{x} = \\mathbf{y}$ 以得到 $\\mathbf{x}$。\n\n考虑以下线性方程组：\n$$\n\\begin{align*}\n2x_1 + x_2 + x_3 &= 5 \\\\\n4x_1 - 6x_2 &= -2 \\\\\n-2x_1 + 7x_2 + 2x_3 &= 9\n\\end{align*}\n$$\n该方程组可以写作 $A\\mathbf{x} = \\mathbf{b}$，其中：\n$$\nA = \\begin{pmatrix} 2 & 1 & 1 \\\\ 4 & -6 & 0 \\\\ -2 & 7 & 2 \\end{pmatrix}, \\quad \\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 5 \\\\ -2 \\\\ 9 \\end{pmatrix}\n$$\n首先，求矩阵 $A$ 的 LU 分解，其中 $L$ 是一个对角线元素为1的下三角矩阵（杜利特分解），$U$ 是一个上三角矩阵。然后，使用此分解来求解向量 $\\mathbf{x}$。\n\n你的任务是求出表达式 $x_1 + 2x_2 + 3x_3$ 的值。", "solution": "我们寻求满足 $A=LU$ 的 $L,U$，其中\n$$L=\\begin{pmatrix}1&0&0\\\\l_{21}&1&0\\\\l_{31}&l_{32}&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}&u_{12}&u_{13}\\\\0&u_{22}&u_{23}\\\\0&0&u_{33}\\end{pmatrix}。$$\n\n匹配 $A=\\begin{pmatrix}2&1&1\\\\4&-6&0\\\\-2&7&2\\end{pmatrix}$：\n\n1. $U$ 的第一行：\n$$u_{11}=2,\\quad u_{12}=1,\\quad u_{13}=1.$$\n\n2. $L$ 的第一列：\n$$l_{21}=\\frac{a_{21}}{u_{11}}=\\frac{4}{2}=2,\\quad\nl_{31}=\\frac{a_{31}}{u_{11}}=\\frac{-2}{2}=-1.$$\n\n3. 第二行/列：\n$$u_{22}=a_{22}-l_{21}u_{12}=-6-2\\cdot1=-8,\\quad\nu_{23}=a_{23}-l_{21}u_{13}=0-2\\cdot1=-2.$$\n$$l_{32}=\\frac{a_{32}-l_{31}u_{12}}{u_{22}}=\\frac{7-(-1)\\cdot1}{-8}=\\frac{8}{-8}=-1.$$\n\n4. 最后一个对角线元素：\n$$u_{33}=a_{33}-l_{31}u_{13}-l_{32}u_{23}\n=2-(-1)\\cdot1-(-1)\\cdot(-2)=2+1-2=1.$$\n\n因此\n$$L=\\begin{pmatrix}1&0&0\\\\2&1&0\\\\-1&-1&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}2&1&1\\\\0&-8&-2\\\\0&0&1\\end{pmatrix}。$$\n\n接下来，使用前向代入法求解 $L\\mathbf y=\\mathbf b$，其中 $\\mathbf b=(5,-2,9)^T$：\n$$y_1=5,\\quad\ny_2=-2-2\\,y_1=-2-10=-12,\\quad\ny_3=9-(-1)\\,y_1-(-1)\\,y_2=9+5-12=2.$$\n\n然后，使用回代法求解 $U\\mathbf x=\\mathbf y$：\n$$x_3=2,\\quad\n-8x_2-2x_3=-12\\implies-8x_2-4=-12\\implies x_2=1,$$\n$$2x_1+x_2+x_3=5\\implies2x_1+1+2=5\\implies x_1=1.$$\n\n最后，\n$$x_1+2x_2+3x_3=1+2\\cdot1+3\\cdot2=9.$$", "answer": "$$\\boxed{9}$$", "id": "12944"}]}