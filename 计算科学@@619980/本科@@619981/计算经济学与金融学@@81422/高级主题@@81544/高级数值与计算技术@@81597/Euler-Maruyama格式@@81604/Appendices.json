{"hands_on_practices": [{"introduction": "理论只有通过实践才能真正掌握。本章节将带领你完成三个动手练习，旨在巩固你对欧拉-丸山格式的理解。我们将从该方法的基本构成单元开始，然后探讨数值稳定性等实际问题，最后研究如何优化模拟以兼顾效率与准确性。通过这些练习，你将把抽象的数学概念转化为强大的问题解决工具。\n\n在模拟一条完整的随机过程路径之前，理解单个时间步内发生的事情至关重要。本练习 [@problem_id:1311634] 将欧拉-丸山格式分解为其核心组成部分——确定性的漂移项和随机的扩散项，并要求你分析其统计特性。掌握这一步是为你理解整个模拟过程的行为奠定坚实基础的关键。", "problem": "考虑 Ornstein-Uhlenbeck 过程，这是一个在金融和物理学中常用来描述均值回归系统的模型。该过程的演化由以下随机微分方程 (SDE) 决定：\n$$dX_t = -\\lambda X_t dt + \\sigma dW_t$$\n其中 $X_t$ 是过程在时间 $t$ 的值，$\\lambda > 0$ 是均值回归速率，$\\sigma$ 是波动率参数，$W_t$ 是一个标准的 Wiener 过程 (布朗运动)。\n\n为了对解进行数值近似，一种常用的方法是 Euler-Maruyama 格式。对于形如 $dX_t = a(X_t, t)dt + b(X_t, t)dW_t$ 的一般随机微分方程，从时间 $t_i$ 到 $t_{i+1} = t_i + \\Delta t$ 的一步 Euler-Maruyama 近似由下式给出：\n$$\\hat{X}_{t_{i+1}} = \\hat{X}_{t_i} + a(\\hat{X}_{t_i}, t_i)\\Delta t + b(\\hat{X}_{t_i}, t_i)\\Delta W_i$$\n其中 $\\Delta W_i = W_{t_{i+1}} - W_{t_i}$ 是 Wiener 过程的一个增量。这些增量是独立的随机变量，每个都服从均值为零、方差等于时间步长的正态分布，即 $\\Delta W_i \\sim N(0, \\Delta t)$。\n\n假设我们有一个特定的 Ornstein-Uhlenbeck 过程，其参数为 $\\lambda = 1$ 和 $\\sigma = 1$，从一个已知的初始值 $X_0 = 3$ 开始。我们希望分析第一个数值步骤的统计特性。\n\n计算在持续时间为 $\\Delta t$ 的单个时间步长之后，近似值 $\\hat{X}_{\\Delta t}$ 的理论期望值和方差。请按期望值和方差的顺序，将您的答案表示为一对关于时间步长 $\\Delta t$ 的符号表达式。", "solution": "问题要求计算给定随机微分方程 (SDE) 的一步 Euler-Maruyama 近似的期望值 $E[\\hat{X}_{\\Delta t}]$ 和方差 $Var(\\hat{X}_{\\Delta t})$。\n\n该SDE是 Ornstein-Uhlenbeck 过程的一个特例：\n$$dX_t = -\\lambda X_t dt + \\sigma dW_t$$\n其参数为 $\\lambda = 1$ 和 $\\sigma = 1$。因此，该SDE为：\n$$dX_t = -X_t dt + dW_t$$\n将其与一般形式 $dX_t = a(X_t, t)dt + b(X_t, t)dW_t$ 进行比较，我们可以确定漂移系数为 $a(X_t, t) = -X_t$，扩散系数为 $b(X_t, t) = 1$。给定的初始条件为 $X_0 = 3$。\n\n从 $t_0=0$ 到 $t_1=\\Delta t$ 的单步 Euler-Maruyama 格式为：\n$$\\hat{X}_{\\Delta t} = X_0 + a(X_0, 0)\\Delta t + b(X_0, 0)\\Delta W_0$$\n其中 $\\Delta W_0 = W_{\\Delta t} - W_0$ 是 Wiener 过程的第一个增量。\n\n代入 $a$ 和 $b$ 的具体形式以及初始条件 $X_0 = 3$：\n$$a(X_0, 0) = -X_0 = -3$$\n$$b(X_0, 0) = 1$$\n将这些值代入 Euler-Maruyama 公式，得到近似值 $\\hat{X}_{\\Delta t}$ 的表达式：\n$$\\hat{X}_{\\Delta t} = 3 + (-3)\\Delta t + (1)\\Delta W_0$$\n$$\\hat{X}_{\\Delta t} = 3 - 3\\Delta t + \\Delta W_0$$\n\n现在，我们需要求 $\\hat{X}_{\\Delta t}$ 的期望值。我们利用期望算子 $E[\\cdot]$ 的线性性质。\n$$E[\\hat{X}_{\\Delta t}] = E[3 - 3\\Delta t + \\Delta W_0]$$\n由于 $3$ 和 $3\\Delta t$ 是常数（非随机的），期望算子将它们视为常数：\n$$E[\\hat{X}_{\\Delta t}] = E[3] - E[3\\Delta t] + E[\\Delta W_0]$$\n$$E[\\hat{X}_{\\Delta t}] = 3 - 3\\Delta t + E[\\Delta W_0]$$\n问题指出，Wiener 过程增量 $\\Delta W_0$ 服从均值为 0、方差为 $\\Delta t$ 的正态分布。因此，$E[\\Delta W_0] = 0$。\n将此结果代入期望值的方程中：\n$$E[\\hat{X}_{\\Delta t}] = 3 - 3\\Delta t + 0 = 3 - 3\\Delta t$$\n\n接下来，我们计算 $\\hat{X}_{\\Delta t}$ 的方差。方差算子 $Var(\\cdot)$ 具有这样的性质：对于任意随机变量 $Z$ 和常数 $c$，$Var(Z+c) = Var(Z)$。\n$$Var(\\hat{X}_{\\Delta t}) = Var(3 - 3\\Delta t + \\Delta W_0)$$\n在此表达式中，项 $3 - 3\\Delta t$ 是一个常数。因此，它对总方差没有贡献。\n$$Var(\\hat{X}_{\\Delta t}) = Var(\\Delta W_0)$$\n如问题所述，Wiener 过程增量的方差等于时间步长，$Var(\\Delta W_0) = \\Delta t$。\n所以，单步近似的方差为：\n$$Var(\\hat{X}_{\\Delta t}) = \\Delta t$$\n\n问题要求将期望值和方差表示为一对符号表达式。期望值为 $3 - 3\\Delta t$，方差为 $\\Delta t$。", "answer": "$$\\boxed{\\begin{pmatrix} 3 - 3\\Delta t & \\Delta t \\end{pmatrix}}$$", "id": "1311634"}, {"introduction": "并非所有数值格式都生而平等，尤其是在处理变量可能剧烈变化的“刚性”方程时。本练习 [@problem_id:2440441] 探讨了均方稳定性这一至关重要的概念。你将看到标准的显式欧拉-丸山格式为何可能失效，以及一个简单的修正（漂移项隐式格式）如何能显著提高其稳定性，这是所有SDE求解器实现者必须掌握的关键实践技能。", "problem": "考虑由 $dX_t = a X_t \\, dt + b X_t \\, dW_t$ 定义的线性标量随机微分方程 (SDE)，其初始值为 $X_0 = x_0$，漂移系数为 $a \\in \\mathbb{R}$，波动率系数为 $b \\ge 0$，其中 $W_t$ 是一个标准维纳过程。令 $\\Delta t > 0$ 表示一个均匀的时间步长，并令 $\\Delta W_n := W_{t_{n+1}} - W_{t_n}$ 为维纳增量，它满足 $\\Delta W_n \\sim \\mathcal{N}(0,\\Delta t)$ 并且在 $n$ 上是独立的。在网格 $t_n = n \\Delta t$上定义了如下两种时间离散格式：\n- 显式欧拉-丸山 (EM) 格式：$X_{n+1}^{\\mathrm{exp}} = X_n^{\\mathrm{exp}} + a X_n^{\\mathrm{exp}} \\, \\Delta t + b X_n^{\\mathrm{exp}} \\, \\Delta W_n$。\n- 漂移隐式欧拉-丸山 (EM) 格式：$X_{n+1}^{\\mathrm{imp}} = X_n^{\\mathrm{imp}} + a X_{n+1}^{\\mathrm{imp}} \\, \\Delta t + b X_n^{\\mathrm{imp}} \\, \\Delta W_n$。\n\n对于这个线性SDE，单步格式的均方稳定性是由其每步均方放大因子来定义的。将单步更新写成 $X_{n+1} = G X_n$ 的形式，其中 $G$ 是一个依赖于 $a$、$b$、$\\Delta t$ 和 $\\Delta W_n$ 的随机标量，当且仅当 $\\mathbb{E}[|G|^2] < 1$ 时，称该格式是均方稳定的。期望是针对维纳增量 $\\Delta W_n$ 的分布计算的。\n\n您的任务是，对于下面测试套件中的每一组参数，判断这两种格式是否均方稳定。对于每一组参数，输出两个布尔值：第一个是漂移隐式欧拉-丸山格式的稳定性，第二个是显式欧拉-丸山格式的稳定性。\n\n测试套件（每种情况是一个三元组 $(a,b,\\Delta t)$）：\n- 情况 1: $(a,b,\\Delta t) = (-50.0, 1.0, 0.05)$。\n- 情况 2: $(a,b,\\Delta t) = (-50.0, 1.0, 0.005)$。\n- 情况 3: $(a,b,\\Delta t) = (0.0, 1.0, 0.1)$。\n\n最终输出格式：您的程序应生成一行输出，其中包含一个含六个布尔值的列表，顺序为 $[\\text{imp}_{1}, \\text{exp}_{1}, \\text{imp}_{2}, \\text{exp}_{2}, \\text{imp}_{3}, \\text{exp}_{3}]$，其中 $\\text{imp}_{k}$ 和 $\\text{exp}_{k}$ 分别是情况 $k$ 中漂移隐式和显式格式的均方稳定性布尔值。该列表必须以方括号括起来的逗号分隔列表形式打印，例如 $[\\text{True},\\text{False},\\ldots]$。", "solution": "所述问题是有效的。这是随机微分方程数值方法标准理论中一个明确定义的问题。所有必要的定义、参数和条件都已提供，问题没有科学上的不准确或含糊之处。我们将进行稳定性条件的形式推导。\n\n线性标量随机微分方程 (SDE) 为：\n$$dX_t = a X_t \\, dt + b X_t \\, dW_t, \\quad X_0 = x_0$$\n其中 $a \\in \\mathbb{R}$，$b \\ge 0$，$W_t$ 是一个标准维纳过程。单步数值格式 $X_{n+1} = G X_n$ 的均方稳定性由条件 $\\mathbb{E}[|G|^2] < 1$ 决定，其中期望是针对维纳增量 $\\Delta W_n \\sim \\mathcal{N}(0, \\Delta t)$ 的分布计算的。我们将使用的维纳增量的关键性质是其一阶矩和二阶矩：$\\mathbb{E}[\\Delta W_n] = 0$ 和 $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$。\n\n首先，我们分析显式欧拉-丸山 (EM) 格式：\n$$X_{n+1}^{\\mathrm{exp}} = X_n^{\\mathrm{exp}} + a X_n^{\\mathrm{exp}} \\, \\Delta t + b X_n^{\\mathrm{exp}} \\, \\Delta W_n$$\n我们可以通过提出 $X_n^{\\mathrm{exp}}$ 因子，将其表示为 $X_{n+1}^{\\mathrm{exp}} = G_{\\mathrm{exp}} X_n^{\\mathrm{exp}}$ 的形式：\n$$X_{n+1}^{\\mathrm{exp}} = (1 + a \\Delta t + b \\Delta W_n) X_n^{\\mathrm{exp}}$$\n放大因子是 $G_{\\mathrm{exp}} = 1 + a \\Delta t + b \\Delta W_n$。为检验稳定性，我们计算其平方的期望：\n$$\\mathbb{E}[|G_{\\mathrm{exp}}|^2] = \\mathbb{E}[(1 + a \\Delta t + b \\Delta W_n)^2]$$\n展开期望内的项得到：\n$$\\mathbb{E}[|G_{\\mathrm{exp}}|^2] = \\mathbb{E}[(1 + a \\Delta t)^2 + 2(1 + a \\Delta t) b \\Delta W_n + b^2 (\\Delta W_n)^2]$$\n利用期望的线性性质，我们有：\n$$\\mathbb{E}[|G_{\\mathrm{exp}}|^2] = (1 + a \\Delta t)^2 + 2(1 + a \\Delta t) b \\, \\mathbb{E}[\\Delta W_n] + b^2 \\, \\mathbb{E}[(\\Delta W_n)^2]$$\n代入矩 $\\mathbb{E}[\\Delta W_n] = 0$ 和 $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$：\n$$\\mathbb{E}[|G_{\\mathrm{exp}}|^2] = (1 + a \\Delta t)^2 + b^2 \\Delta t$$\n因此，显式格式的均方稳定性条件是：\n$$(1 + a \\Delta t)^2 + b^2 \\Delta t < 1$$\n\n接下来，我们分析漂移隐式欧拉-丸山格式：\n$$X_{n+1}^{\\mathrm{imp}} = X_n^{\\mathrm{imp}} + a X_{n+1}^{\\mathrm{imp}} \\, \\Delta t + b X_n^{\\mathrm{imp}} \\, \\Delta W_n$$\n为了找到放大因子，我们必须首先分离出 $X_{n+1}^{\\mathrm{imp}}$：\n$$X_{n+1}^{\\mathrm{imp}} (1 - a \\Delta t) = X_n^{\\mathrm{imp}} (1 + b \\Delta W_n)$$\n假设 $1 - a \\Delta t \\neq 0$，我们解出 $X_{n+1}^{\\mathrm{imp}}$：\n$$X_{n+1}^{\\mathrm{imp}} = \\left(\\frac{1 + b \\Delta W_n}{1 - a \\Delta t}\\right) X_n^{\\mathrm{imp}}$$\n放大因子是 $G_{\\mathrm{imp}} = \\frac{1 + b \\Delta W_n}{1 - a \\Delta t}$。分母是一个确定性常数。我们计算其平方的期望：\n$$\\mathbb{E}[|G_{\\mathrm{imp}}|^2] = \\mathbb{E}\\left[\\left|\\frac{1 + b \\Delta W_n}{1 - a \\Delta t}\\right|^2\\right] = \\frac{1}{(1 - a \\Delta t)^2} \\mathbb{E}[(1 + b \\Delta W_n)^2]$$\n分子中的期望是 $\\mathbb{E}[1 + 2b \\Delta W_n + b^2 (\\Delta W_n)^2] = 1 + 2b\\mathbb{E}[\\Delta W_n] + b^2\\mathbb{E}[(\\Delta W_n)^2] = 1 + b^2 \\Delta t$。\n因此，我们得到：\n$$\\mathbb{E}[|G_{\\mathrm{imp}}|^2] = \\frac{1 + b^2 \\Delta t}{(1 - a \\Delta t)^2}$$\n漂移隐式格式的均方稳定性条件是：\n$$\\frac{1 + b^2 \\Delta t}{(1 - a \\Delta t)^2} < 1$$\n\n我们现在将这两个条件应用于测试用例。\n\n情况 1：$(a,b,\\Delta t) = (-50.0, 1.0, 0.05)$\n- **漂移隐式格式：** 稳定值为 $\\frac{1 + (1.0)^2(0.05)}{(1 - (-50.0)(0.05))^2} = \\frac{1.05}{(1+2.5)^2} = \\frac{1.05}{12.25} \\approx 0.0857$。由于 $0.0857 < 1$，该格式是稳定的 (True)。\n- **显式格式：** 稳定值为 $(1 + (-50.0)(0.05))^2 + (1.0)^2(0.05) = (1 - 2.5)^2 + 0.05 = (-1.5)^2 + 0.05 = 2.25 + 0.05 = 2.3$。由于 $2.3 \\ge 1$，该格式是不稳定的 (False)。\n\n情况 2：$(a,b,\\Delta t) = (-50.0, 1.0, 0.005)$\n- **漂移隐式格式：** 稳定值为 $\\frac{1 + (1.0)^2(0.005)}{(1 - (-50.0)(0.005))^2} = \\frac{1.005}{(1+0.25)^2} = \\frac{1.005}{1.5625} = 0.6432$。由于 $0.6432 < 1$，该格式是稳定的 (True)。\n- **显式格式：** 稳定值为 $(1 + (-50.0)(0.005))^2 + (1.0)^2(0.005) = (1 - 0.25)^2 + 0.005 = (0.75)^2 + 0.005 = 0.5625 + 0.005 = 0.5675$。由于 $0.5675 < 1$，该格式是稳定的 (True)。\n\n情况 3：$(a,b,\\Delta t) = (0.0, 1.0, 0.1)$\n对于 $a=0.0$，两种格式是相同的，我们期望得到相同的稳定性结果。\n- **漂移隐式格式：** 稳定值为 $\\frac{1 + (1.0)^2(0.1)}{(1 - (0.0)(0.1))^2} = \\frac{1.1}{1^2} = 1.1$。由于 $1.1 \\ge 1$，该格式是不稳定的 (False)。\n- **显式格式：** 稳定值为 $(1 + (0.0)(0.1))^2 + (1.0)^2(0.1) = 1^2 + 0.1 = 1.1$。由于 $1.1 \\ge 1$，该格式是不稳定的 (False)。\n\n按指定顺序组合这些结果，得到最终的布尔值列表：$[\\text{True}, \\text{False}, \\text{True}, \\text{True}, \\text{False}, \\text{False}]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Determines the mean-square stability of two Euler-Maruyama schemes for a\n    linear scalar SDE for a given set of test cases.\n    \"\"\"\n    # Test suite: each case is a tuple (a, b, dt)\n    test_cases = [\n        (-50.0, 1.0, 0.05),\n        (-50.0, 1.0, 0.005),\n        (0.0, 1.0, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        a, b, dt = case\n\n        # --- Drift-implicit Euler-Maruyama stability analysis ---\n        # The stability condition is derived from E[|G_imp|^2] < 1, where\n        # G_imp = (1 + b*dW_n) / (1 - a*dt).\n        # This leads to the condition: (1 + b**2 * dt) / (1 - a * dt)**2 < 1.\n        \n        # Note: The denominator (1 - a*dt) is non-zero for all test cases.\n        imp_stability_value = (1 + b**2 * dt) / (1 - a * dt)**2\n        is_stable_imp = imp_stability_value < 1.0\n        results.append(is_stable_imp)\n\n        # --- Explicit Euler-Maruyama stability analysis ---\n        # The stability condition is derived from E[|G_exp|^2] < 1, where\n        # G_exp = 1 + a*dt + b*dW_n.\n        # This leads to the condition: (1 + a * dt)**2 + b**2 * dt < 1.\n        \n        exp_stability_value = (1 + a * dt)**2 + b**2 * dt\n        is_stable_exp = exp_stability_value < 1.0\n        results.append(is_stable_exp)\n\n    # The final output must be a single line containing a list of boolean values\n    # ordered as [imp_1, exp_1, imp_2, exp_2, imp_3, exp_3].\n    # map(str, results) converts [True, False, ...] to ['True', 'False', ...].\n    # ','.join(...) creates the comma-separated string 'True,False,...'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2440441"}, {"introduction": "在现实世界中，计算资源是有限的。进行蒙特卡洛模拟时，你总会面临一个关键的权衡：是使用更小的时间步长（$\\Delta t$）来提高单次路径的精度，还是模拟更多的路径（$N$）来减少统计噪声？本练习 [@problem_id:2440399] 将引导你进行一次形式化分析，以找到最佳平衡点，这是计算金融领域中一个直接影响工作效率的基础性问题。", "problem": "在计算经济学和金融学中，考虑使用蒙特卡罗 (MC) 模拟和 Euler–Maruyama (EM) 时间离散化方法，来估计一个随机微分方程 (SDE) 终端状态 $X_T$ 的光滑收益函数 $f$ 的期望。具体而言，设 $X_t$ 是以下方程的解：\n$$\n\\mathrm{d}X_t = a(X_t)\\,\\mathrm{d}t + b(X_t)\\,\\mathrm{d}W_t,\\quad t\\in[0,T],\\quad X_0=x_0,\n$$\n其中 $a(\\cdot)$ 和 $b(\\cdot)$ 是全局 Lipschitz 的，$T>0$。并假设 $f$ 足够光滑，使得 EM 格式对于 $\\mathbb{E}[f(X_T)]$ 具有弱收敛阶 $p=1$。您使用均匀时间步长 $\\Delta t$ 模拟 $N$ 条独立路径，因此每条路径的时间步数为 $M=T\\,\\Delta t^{-1}$。\n\n假设存在以下成本和误差模型：\n- 总计算成本与计算的总时间步数成正比，因此固定预算约束可以写为 $N\\,M=K$，其中 $K>0$ 是一个给定的、必须被完全使用的常数。\n- 对于 $\\mu=\\mathbb{E}[f(X_T)]$，MC 估计量 $\\hat{\\mu}_{N,\\Delta t}=\\frac{1}{N}\\sum_{i=1}^{N} f(\\hat{X}_T^{(i)})$ 的均方误差 (MSE) 可进行标准的方差加偏差平方分解。在所述的光滑性条件下，方差的尺度为 $C_1 N^{-1}$（对于某个 $C_1>0$，且独立于 $N$ 和 $\\Delta t$），偏差平方的尺度为 $C_2 \\Delta t^{2p}=C_2 \\Delta t^{2}$（对于某个 $C_2>0$，且独立于 $N$ 和 $\\Delta t$）。高阶项可以忽略。\n\n在这些假设和预算约束 $N\\,T\\,\\Delta t^{-1}=K$ 下，关于使用更多路径 $N$ 与使用更小时间步长 $\\Delta t$ 之间的权衡，以下哪个/哪些陈述是正确的？\n\nA. 存在一个使 MSE 最小化的内部最优分配，其特征为（除去与 $K$ 无关的正常数乘子）：$\\Delta t^\\star \\propto K^{-1/3}$ 和 $N^\\star \\propto K^{2/3}$。\n\nB. 对于任何固定的预算 $K$，最大化 $N$（并因此使用满足预算所需的尽可能大的 $\\Delta t$）总是能最小化 MSE。\n\nC. 当 EM 格式的弱收敛阶为 $p=1$ 时，固定预算下的最优分配使得 MSE 中的方差贡献和偏差平方贡献相等。\n\nD. 如果方差的尺度为 $\\mathcal{O}(N^{-1})$，弱离散误差的尺度为 $\\mathcal{O}(\\Delta t)$，则在固定预算 $K$ 下，可达到的最小 MSE 的尺度为 $\\mathcal{O}(K^{-2/3})$。\n\nE. 在估计光滑函数 $f$ 的 $\\mathbb{E}[f(X_T)]$ 时，EM 的强收敛阶决定了 MSE 中的离散化偏差；弱收敛阶对此目的无关紧要。\n\n选择所有适用项。", "solution": "该问题要求分析一个随机微分方程的蒙特卡罗模拟中的权衡问题，具体是如何分配固定的计算预算以最小化均方误差。我将首先验证问题陈述的有效性，然后在确认其有效性后，进行完整的数学推导并评估每个选项。\n\n该问题是有效的。它提出了计算金融领域一个标准的、适定的优化问题。关于 SDE、Euler-Maruyama 格式、误差分量和计算成本的假设都是标准的且科学上合理的。该问题是自洽的，并且陈述得足够精确，可以得到唯一的可验证解。\n\n我们来进行推导。目标是估计 $\\mu = \\mathbb{E}[f(X_T)]$。估计量 $\\hat{\\mu}_{N,\\Delta t}$ 的均方误差 (MSE) 由方差与偏差平方之和给出。根据问题陈述，我们有：\n$$\n\\text{MSE} \\approx C_1 N^{-1} + C_2 \\Delta t^{2p}\n$$\n其中 $p=1$ 是弱收敛阶。因此，需要最小化的函数是：\n$$\nE(N, \\Delta t) = C_1 N^{-1} + C_2 \\Delta t^2\n$$\n最小化受制于一个固定的计算预算约束：\n$$\nN \\cdot M = K\n$$\n其中 $M = T \\Delta t^{-1}$ 是时间步数。将 $M$ 代入约束条件，得到：\n$$\nN T \\Delta t^{-1} = K\n$$\n其中 $K > 0$ 是一个代表总预算的常数。这个约束将路径数 $N$ 和时间步长 $\\Delta t$ 联系起来。我们可以用一个变量表示另一个。让我们将 $N$ 表示为 $\\Delta t$ 的函数：\n$$\nN = K T^{-1} \\Delta t\n$$\n现在，我们将这个 $N$ 的表达式代入 MSE 方程，以获得 MSE 作为单个变量 $\\Delta t$ 的函数：\n$$\nE(\\Delta t) = C_1 (K T^{-1} \\Delta t)^{-1} + C_2 \\Delta t^2 = C_1 T K^{-1} \\Delta t^{-1} + C_2 \\Delta t^2\n$$\n为了找到最小化此误差的最优时间步长 $\\Delta t^\\star$，我们必须计算 $E(\\Delta t)$ 关于 $\\Delta t$ 的一阶导数并令其为零。\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}\\Delta t} = -C_1 T K^{-1} \\Delta t^{-2} + 2 C_2 \\Delta t\n$$\n令导数为零可得极值的一阶条件：\n$$\n2 C_2 \\Delta t = C_1 T K^{-1} \\Delta t^{-2}\n$$\n解出 $\\Delta t$:\n$$\n\\Delta t^3 = \\frac{C_1 T}{2 C_2 K}\n$$\n$$\n\\Delta t^\\star = \\left(\\frac{C_1 T}{2 C_2}\\right)^{1/3} K^{-1/3}\n$$\n二阶导数为 $\\frac{\\mathrm{d}^2E}{\\mathrm{d}(\\Delta t)^2} = 2 C_1 T K^{-1} \\Delta t^{-3} + 2 C_2$，对于 $\\Delta t > 0$ 恒为正，这确认了该点确实是一个最小值点。\n\n使用关系式 $N = K T^{-1} \\Delta t$，我们找到最优路径数 $N^\\star$：\n$$\nN^\\star = K T^{-1} \\Delta t^\\star = K T^{-1} \\left(\\frac{C_1 T}{2 C_2}\\right)^{1/3} K^{-1/3} = \\left(\\frac{C_1 K^3 T^{-3} T}{2 C_2}\\right)^{1/3} = \\left(\\frac{C_1 K^2}{2 C_2 T^2}\\right)^{1/3}\n$$\n从这些表达式中，我们可以确定关于预算 $K$ 的尺度关系：\n$$\n\\Delta t^\\star \\propto K^{-1/3} \\quad \\text{和} \\quad N^\\star \\propto K^{2/3}\n$$\n现在我们来评估每个陈述。\n\nA. 存在一个使 MSE 最小化的内部最优分配，其特征为（除去与 $K$ 无关的正常数乘子）：$\\Delta t^\\star \\propto K^{-1/3}$ 和 $N^\\star \\propto K^{2/3}$。\n我们的推导表明，存在一个唯一的正值 $\\Delta t^\\star$ 可以最小化 MSE。这代表了一个内部最优解，而不是 $\\Delta t \\to 0$ 或 $\\Delta t$ 取最大值的边界解。推导出的尺度关系为 $\\Delta t^\\star \\propto K^{-1/3}$ 和 $N^\\star \\propto (K^2)^{1/3} = K^{2/3}$。这与该陈述的说法完全一致。\n结论：**正确**。\n\nB. 对于任何固定的预算 $K$，最大化 $N$（并因此使用满足预算所需的尽可能大的 $\\Delta t$）总是能最小化 MSE。\n从预算约束 $N = K T^{-1} \\Delta t$ 可知，最大化路径数 $N$ 需要最大化时间步长 $\\Delta t$。这将最小化方差项 $C_1 N^{-1}$，但会最大化偏差平方项 $C_2 \\Delta t^2$。由于我们已经找到了一个内部最优解，这种处于权衡一端的角点解不可能是普遍的最小值。最优的平衡取决于常数 $C_1$ 和 $C_2$ 的相对大小。\n结论：**不正确**。\n\nC. 当 EM 格式的弱收敛阶为 $p=1$ 时，固定预算下的最优分配使得 MSE 中的方差贡献和偏差平方贡献相等。\n让我们检查最优分配下的两个误差分量。\n方差项为 $V^\\star = C_1 (N^\\star)^{-1} = C_1 (K T^{-1} \\Delta t^\\star)^{-1} = C_1 T K^{-1} (\\Delta t^\\star)^{-1}$。\n偏差平方项为 $(B^\\star)^2 = C_2 (\\Delta t^\\star)^2$。\n从我们的一阶最优性条件 $2 C_2 \\Delta t^\\star = C_1 T K^{-1} (\\Delta t^\\star)^{-2}$，两边同乘以 $\\Delta t^\\star$，我们得到：\n$$\n2 C_2 (\\Delta t^\\star)^2 = C_1 T K^{-1} (\\Delta t^\\star)^{-1}\n$$\n这等价于：\n$$\n2 (B^\\star)^2 = V^\\star\n$$\n在最优点，方差贡献是偏差平方贡献的两倍。它们不相等。\n结论：**不正确**。\n\nD. 如果方差的尺度为 $\\mathcal{O}(N^{-1})$，弱离散误差的尺度为 $\\mathcal{O}(\\Delta t)$，则在固定预算 $K$ 下，可达到的最小 MSE 的尺度为 $\\mathcal{O}(K^{-2/3})$。\n该陈述的前提与问题设置一致，其中“弱离散误差”的尺度为 $\\mathcal{O}(\\Delta t)$ 对应于弱收敛阶 $p=1$，因此偏差平方的尺度为 $\\mathcal{O}(\\Delta t^2)$。让我们计算最小 MSE，$E^\\star = E(\\Delta t^\\star)$：\n$$\nE^\\star = V^\\star + (B^\\star)^2\n$$\n使用关系式 $V^\\star = 2(B^\\star)^2$，我们有 $E^\\star = 3(B^\\star)^2 = 3 C_2 (\\Delta t^\\star)^2$。\n因为我们发现 $\\Delta t^\\star \\propto K^{-1/3}$，所以最小 MSE 的尺度为：\n$$\nE^\\star \\propto (\\Delta t^\\star)^2 \\propto (K^{-1/3})^2 = K^{-2/3}\n$$\n可达到的最小 MSE 的尺度为 $\\mathcal{O}(K^{-2/3})$。\n结论：**正确**。\n\nE. 在估计光滑函数 $f$ 的 $\\mathbb{E}[f(X_T)]$ 时，EM 的强收敛阶决定了 MSE 中的离散化偏差；弱收敛阶对此目的无关紧要。\n对于量 $\\mathbb{E}[f(X_T)]$，MSE 中的离散化偏差正是差值 $\\mathbb{E}[f(\\hat{X}_T)] - \\mathbb{E}[f(X_T)]$，其中 $\\hat{X}_T$ 是时间 $T$ 处的数值近似。当 $\\Delta t \\to 0$ 时，该差值收敛到零的速率即为弱收敛阶的定义。另一方面，强收敛阶关注的是路径误差，其特征由 $\\mathbb{E}[|X_T - \\hat{X}_T|]$ 这类量来刻画。虽然强收敛可以为弱误差提供一个上界，但弱收敛阶为我们所关注的偏差给出了精确的速率。对于 Euler-Maruyama 格式，弱收敛阶 ($p=1$) 通常高于强收敛阶 ($\\gamma=0.5$)，这使得它在这种情况下成为衡量偏差的更相关和更准确的指标。该陈述从根本上与这些定义相悖。\n结论：**不正确**。", "answer": "$$\\boxed{AD}$$", "id": "2440399"}]}