{"hands_on_practices": [{"introduction": "在应用Blanchard-Kahn条件之前，一个关键的步骤是将经济模型表示为标准的一阶状态空间形式。然而，许多现实模型，如包含“投资时滞”（time-to-build）的模型，其动态方程涉及多期之后的变量，无法直接分析。这项练习将指导你通过引入辅助变量，将一个包含两期投资时滞的复杂模型转化为标准的一阶系统，这是进行动态系统稳定性分析的基本功。[@problem_id:2376631]", "problem": "考虑以下具有投资建造时滞的线性理性预期（RE）模型，其中在时间 $t$ 决定的投资仅在时间 $t+2$ 增加资本：\n$$\nq_{t} = \\phi \\, \\mathbb{E}_{t} q_{t+1} + \\psi \\, k_{t},\n$$\n$$\nk_{t+2} = \\alpha \\, k_{t+1} + \\gamma \\, q_{t}.\n$$\n这里，$q_{t}$ 是一个前瞻性变量，$k_{t}$ 是一个先决变量，且不存在外生冲击。参数为\n$$\n\\alpha = \\frac{1}{2}, \\quad \\phi = \\frac{1}{2}, \\quad \\gamma = 1, \\quad \\psi = 0.\n$$\n构建一个适用于应用 Blanchard-Kahn 条件（BK）的一阶状态空间表示，其形式为\n$$\n\\mathbb{E}_{t} s_{t+1} = F s_{t},\n$$\n通过引入您认为必要的任何辅助状态变量来解决投资建造时滞项。仅基于该表示，计算 $F$ 的特征值中模严格大于 $1$ 的个数。将此数字作为一个实数值提供。无需四舍五入。", "solution": "该问题要求为一个在资本积累中具有两期投资建造时滞的模型构建一阶状态空间表示。根本问题是 $k_{t+2}$ 的出现，它使得系统在时间上不是一阶的。一种标准方法是定义一个辅助变量，将时间提前一期，从而使系统在一阶上闭合。\n\n从给定的方程开始：\n$$\nq_{t} = \\phi \\, \\mathbb{E}_{t} q_{t+1} + \\psi \\, k_{t},\n$$\n$$\nk_{t+2} = \\alpha \\, k_{t+1} + \\gamma \\, q_{t}.\n$$\n引入辅助先决变量 $m_{t} \\equiv k_{t+1}$。那么根据定义，$m_{t+1} = k_{t+2}$，运动方程变为\n$$\nm_{t+1} = \\alpha \\, m_{t} + \\gamma \\, q_{t}.\n$$\n我们还有一个将 $k_{t}$ 和 $m_{t}$ 向前关联一期的恒等式：\n$$\nk_{t+1} = m_{t}.\n$$\n将内生变量收集到向量 $s_{t} \\equiv \\begin{pmatrix} m_{t} \\\\ k_{t} \\\\ q_{t} \\end{pmatrix}$ 中。通过将每个方程写成关于 $\\mathbb{E}_{t} s_{t+1}$ 和 $s_{t}$ 的线性形式，将系统表示为预期一阶形式 $\\mathbb{E}_{t} s_{t+1} = F s_{t}$。\n\n这三个方程可以写成：\n1. 恒等式 $k_{t+1} - m_{t} = 0$ 变为\n$$\n\\mathbb{E}_{t} k_{t+1} - m_{t} = 0.\n$$\n2. 投资建造时滞法则 $m_{t+1} - \\alpha m_{t} - \\gamma q_{t} = 0$ 变为\n$$\n\\mathbb{E}_{t} m_{t+1} - \\alpha m_{t} - \\gamma q_{t} = 0.\n$$\n3. 前向方程 $q_{t} - \\phi \\mathbb{E}_{t} q_{t+1} - \\psi k_{t} = 0$ 变为\n$$\n-\\phi \\, \\mathbb{E}_{t} q_{t+1} + q_{t} - \\psi \\, k_{t} = 0.\n$$\n这些可以堆叠成矩阵形式 $A \\, \\mathbb{E}_{t} s_{t+1} = B \\, s_{t}$，其中\n$$\nA =\n\\begin{pmatrix}\n0 & 1 & 0 \\\\\n1 & 0 & 0 \\\\\n0 & 0 & -\\phi\n\\end{pmatrix}, \\quad\nB =\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n\\alpha & 0 & \\gamma \\\\\n0 & -\\psi & 1\n\\end{pmatrix}.\n$$\n由于当 $\\phi \\neq 0$ 时，$\\det(A) = \\phi \\neq 0$，因此 $A$ 是可逆的，状态空间转移矩阵为\n$$\nF = A^{-1} B.\n$$\n计算 $A^{-1}$。注意到 $A$ 的左上 $2 \\times 2$ 子块是置换矩阵，右下角元素是 $-\\phi$，可得\n$$\nA^{-1} =\n\\begin{pmatrix}\n0 & 1 & 0 \\\\\n1 & 0 & 0 \\\\\n0 & 0 & -\\frac{1}{\\phi}\n\\end{pmatrix}.\n$$\n因此\n$$\nF = A^{-1} B =\n\\begin{pmatrix}\n\\alpha & 0 & \\gamma \\\\\n1 & 0 & 0 \\\\\n0 & \\frac{\\psi}{\\phi} & -\\frac{1}{\\phi}\n\\end{pmatrix}.\n$$\n代入参数值 $\\alpha = \\frac{1}{2}$，$\\phi = \\frac{1}{2}$，$\\gamma = 1$ 和 $\\psi = 0$：\n$$\nF =\n\\begin{pmatrix}\n\\frac{1}{2} & 0 & 1 \\\\\n1 & 0 & 0 \\\\\n0 & 0 & -2\n\\end{pmatrix}.\n$$\n这个矩阵是块上三角矩阵，有一个左上 $2 \\times 2$ 子块和一个右下 $1 \\times 1$ 子块。因此，特征值是对角子块的特征值。对于 $2 \\times 2$ 子块\n$$\n\\begin{pmatrix}\n\\frac{1}{2} & 1 \\\\\n1 & 0\n\\end{pmatrix},\n$$\n特征多项式为\n$$\n\\lambda^{2} - \\frac{1}{2} \\lambda - 1 = 0.\n$$\n修正：F矩阵的(1,2)元素是0，(1,3)是gamma=1。2x2子块应该是对m,k变量的。F矩阵为\n$$\nF =\n\\begin{pmatrix}\n\\frac{1}{2} & 0 & 1 \\\\\n1 & 0 & 0 \\\\\n0 & 0 & -2\n\\end{pmatrix}.\n$$\n它的特征多项式是\n$$\n\\det(F - \\lambda I) = \\det \\begin{pmatrix} \\frac{1}{2}-\\lambda & 0 & 1 \\\\ 1 & -\\lambda & 0 \\\\ 0 & 0 & -2-\\lambda \\end{pmatrix} = (-2-\\lambda) \\det \\begin{pmatrix} \\frac{1}{2}-\\lambda & 0 \\\\ 1 & -\\lambda \\end{pmatrix} = (-2-\\lambda) \\left( (\\frac{1}{2}-\\lambda)(-\\lambda) \\right) = (-2-\\lambda) (\\lambda^2 - \\frac{1}{2}\\lambda) = -(\\lambda+2)\\lambda(\\lambda-\\frac{1}{2})=0.\n$$\n其特征值为 $\\lambda_{1} = -2$, $\\lambda_{2} = 0$, $\\lambda_3 = \\frac{1}{2}$。\n\n这些特征值的模分别为 $|-2| = 2$， $|0| = 0$ 和 $|\\frac{1}{2}| = \\frac{1}{2}$。恰好有一个特征值的模严格大于 $1$。因此，所求的数字是 $1$。", "answer": "$$\\boxed{1}$$", "id": "2376631"}, {"introduction": "仅仅检验Blanchard-Kahn条件的特征值个数是不够的，深刻理解其背后的经济学直觉更为重要。这项练习要求你不再依赖现成的公式，而是通过手动推导来找到唯一的鞍点路径解。通过利用稳定特征向量来约束前瞻性变量的路径，你将亲身体验系统如何为避免发散动态而必须“跳”到稳定流形上，从而真正掌握鞍点稳定性的核心机制。[@problem_id:2376637]", "problem": "考虑一个线性的、确定性的理性预期 (RE) 系统，该系统包含一个预定状态变量和一个前瞻性控制变量，它们被整合在向量 $y_t \\equiv \\begin{pmatrix} x_t \\\\ p_t \\end{pmatrix}$ 中。其运动法则是\n$$\nE_t \\, y_{t+1} \\;=\\; A \\, y_t, \\quad \\text{其中 } A \\;=\\; \\begin{pmatrix} 1.2 & 0.5 \\\\ 0.3 & 0.4 \\end{pmatrix}.\n$$\n假设 $x_t$ 在时间 $t$ 是预定变量，而 $p_t$ 是一个跳跃 (前瞻性) 变量。使用 Blanchard-Kahn (BK) 条件的定义以及线性算子的特征值和特征向量的性质，在不援引任何简便公式的情况下，完成以下任务：\n- 验证该系统满足 BK 条件。\n- 手动推导由 $A$ 的非爆炸性根所关联的稳定流形所隐含的唯一鞍点路径关系 $p_t = F \\, x_t$。你的推导过程必须明确使用 $A$ 的特征值和特征向量，以及对 $p_t$ 的非爆炸性动态的要求。\n- 报告 $F$ 的值。\n\n将最终数值答案四舍五入至四位有效数字。", "solution": "所给出的问题具有科学依据，提法恰当且信息完整。它描述了线性理性预期模型分析中的一个标准练习，这是现代宏观经济学的一个核心课题。所有必要的组成部分——系统的运动法则、变量的分类以及具体的问题——都已给出，且没有歧义或矛盾。因此，我们可以开始求解。\n\n该系统由线性理性预期方程 $E_t \\, y_{t+1} = A \\, y_t$ 描述，其中 $y_t \\equiv \\begin{pmatrix} x_t \\\\ p_t \\end{pmatrix}$，矩阵 $A$ 给定为 $A = \\begin{pmatrix} 1.2 & 0.5 \\\\ 0.3 & 0.4 \\end{pmatrix}$。变量 $x_t$ 是预定的，意味着它在时间 $t$ 的值在时间 $t-1$ 就已知道。变量 $p_t$ 是一个非预定或“跳跃”变量，意味着它在时间 $t$ 的值可以对时间 $t$ 到达的新信息作出反应。\n\n首先，我们必须验证 Blanchard-Kahn (BK) 条件，以确定是否存在唯一的、稳定的解路径。BK 条件指出，矩阵 $A$ 的模大于1的特征值的数量必须等于系统中跳跃变量的数量。在本例中，我们有1个跳跃变量 $p_t$。因此，要存在唯一的鞍点路径，矩阵 $A$ 必须恰好有1个模大于1的特征值。\n\n我们通过求解特征方程 $\\det(A - \\lambda I) = 0$ 来找到特征值，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$\n\\det\\left(\\begin{pmatrix} 1.2 & 0.5 \\\\ 0.3 & 0.4 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\\right) = 0\n$$\n$$\n\\det\\begin{pmatrix} 1.2 - \\lambda & 0.5 \\\\ 0.3 & 0.4 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(1.2 - \\lambda)(0.4 - \\lambda) - (0.5)(0.3) = 0\n$$\n$$\n0.48 - 1.6\\lambda + \\lambda^2 - 0.15 = 0\n$$\n$$\n\\lambda^2 - 1.6\\lambda + 0.33 = 0\n$$\n使用二次方程求根公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，我们求得特征值：\n$$\n\\lambda = \\frac{1.6 \\pm \\sqrt{(-1.6)^2 - 4(1)(0.33)}}{2} = \\frac{1.6 \\pm \\sqrt{2.56 - 1.32}}{2} = \\frac{1.6 \\pm \\sqrt{1.24}}{2}\n$$\n两个特征值为：\n不稳定 (爆炸性) 特征值 $\\lambda_u$：\n$$\n\\lambda_u = \\frac{1.6 + \\sqrt{1.24}}{2} \\approx \\frac{1.6 + 1.11355}{2} \\approx 1.35678\n$$\n以及稳定 (非爆炸性) 特征值 $\\lambda_s$：\n$$\n\\lambda_s = \\frac{1.6 - \\sqrt{1.24}}{2} \\approx \\frac{1.6 - 1.11355}{2} \\approx 0.24323\n$$\n由于 $|\\lambda_u| > 1$ 且 $|\\lambda_s| < 1$，恰好有一个不稳定特征值。这个数量与跳跃变量的数量 ($1$) 相匹配。因此，Blanchard-Kahn 条件得到满足，存在一个唯一的、稳定的鞍点路径。\n\n接下来，我们推导这个鞍点路径关系。该系统的通解可以表示为矩阵 $A$ 的特征向量的线性组合。设 $v_u$ 和 $v_s$ 分别是对应于 $\\lambda_u$ 和 $\\lambda_s$ 的特征向量。在任意时间 $t$ 的解具有 $y_t = c_1 (\\lambda_u)^t v_u + c_2 (\\lambda_s)^t v_s$ 的形式，其中 $c_1$ 和 $c_2$ 是常数。为了使系统在 $t \\to \\infty$ 时避免出现爆炸性行为，与不稳定特征值 $\\lambda_u$ 相关联的项必须被消除。这要求将其系数 $c_1$ 设为 $0$。\n\n这个约束迫使解向量 $y_t = \\begin{pmatrix} x_t \\\\ p_t \\end{pmatrix}$ 位于稳定流形上，该流形是由稳定特征向量 $v_s$ 所张成的子空间。因此，对于任何时间 $t$，向量 $y_t$ 必须与 $v_s$ 共线。这意味着其分量 $x_t$ 和 $p_t$ 之间存在一个固定的比例关系。\n\n我们通过求解方程 $(A - \\lambda_s I)v_s = 0$ 来找到稳定特征向量 $v_s = \\begin{pmatrix} v_{sx} \\\\ v_{sp} \\end{pmatrix}$：\n$$\n\\begin{pmatrix} 1.2 - \\lambda_s & 0.5 \\\\ 0.3 & 0.4 - \\lambda_s \\end{pmatrix} \\begin{pmatrix} v_{sx} \\\\ v_{sp} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n从该矩阵方程的第二行，我们得到以下关系：\n$$\n0.3 v_{sx} + (0.4 - \\lambda_s) v_{sp} = 0\n$$\n这给出了稳定特征向量各分量的比率：\n$$\n\\frac{v_{sp}}{v_{sx}} = -\\frac{0.3}{0.4 - \\lambda_s}\n$$\n由于解向量 $y_t = \\begin{pmatrix} x_t \\\\ p_t \\end{pmatrix}$ 必须与 $v_s$ 平行，其分量的比率也必须相同：\n$$\n\\frac{p_t}{x_t} = \\frac{v_{sp}}{v_{sx}}\n$$\n这就导出了鞍点路径关系 $p_t = F x_t$，其中系数 $F$ 由下式给出：\n$$\nF = -\\frac{0.3}{0.4 - \\lambda_s}\n$$\n我们现在代入稳定特征值 $\\lambda_s = \\frac{1.6 - \\sqrt{1.24}}{2}$ 的表达式：\n$$\nF = -\\frac{0.3}{0.4 - \\left(\\frac{1.6 - \\sqrt{1.24}}{2}\\right)} = -\\frac{0.3}{\\frac{2(0.4) - (1.6 - \\sqrt{1.24})}{2}} = -\\frac{0.6}{0.8 - 1.6 + \\sqrt{1.24}}\n$$\n$$\nF = -\\frac{0.6}{-0.8 + \\sqrt{1.24}}\n$$\n现在，我们计算其数值。使用 $\\sqrt{1.24} \\approx 1.11355287$：\n$$\nF \\approx -\\frac{0.6}{-0.8 + 1.11355287} = -\\frac{0.6}{0.31355287} \\approx -1.9135607...\n$$\n将此结果四舍五入至四位有效数字，得到 $F \\approx -1.914$。", "answer": "$$\\boxed{-1.914}$$", "id": "2376637"}, {"introduction": "在掌握了理论基础后，下一步是将其应用于计算实践，以系统化的方式分析和分类不同的动态模型。这项练习要求你编写一个程序，该程序能根据Blanchard-Kahn条件自动判断一个线性理性预期模型的解是唯一稳定、不存在还是存在无穷多解（不确定性）。通过这个练习，你不仅能巩固对不同情况的理解，还能学会处理数值计算中常见的临界情况，例如当特征值的模恰好为$1$时。[@problem_id:2376651]", "problem": "您需要为一个线性理性预期 (RE) 系统实现一个分类器，该分类器评估 Blanchard-Kahn 条件以确定系统的确定性，并明确处理至少一个特征值的模恰好等于一的边界情况。考虑以下矩阵形式的线性 RE 系统\n$$\nF \\, \\mathbb{E}_t\\left[y_{t+1}\\right] = H \\, y_t,\n$$\n其中 $F \\in \\mathbb{R}^{n \\times n}$ 可逆，$H \\in \\mathbb{R}^{n \\times n}$，且 $y_t \\in \\mathbb{R}^n$ 被划分为包含 $n_p$ 个预定变量 $s_t \\in \\mathbb{R}^{n_p}$ 和 $n_j$ 个前瞻性（跳跃）变量 $q_t \\in \\mathbb{R}^{n_j}$ 的形式，其中 $n = n_p + n_j$。设转移矩阵定义为\n$$\nT \\equiv F^{-1} H.\n$$\n$T$ 的谱决定了局部动态。设特征值 $\\lambda$ 的模记为 $\\lvert \\lambda \\rvert$。使用数值容差 $\\tau = 10^{-8}$ 并将特征值分为以下三类：\n- 稳定：$\\lvert \\lambda \\rvert < 1 - \\tau$。\n- 单位模：$\\lvert \\lambda \\rvert \\in [1 - \\tau, 1 + \\tau]$。\n- 不稳定：$\\lvert \\lambda \\rvert > 1 + \\tau$。\n\n使用 Blanchard-Kahn 条件，为每个系统定义分类代码如下：\n- 代码 $0$ (唯一稳定解)：如果没有单位模特征值，且不稳定特征值的数量等于 $n_j$。\n- 代码 $1$ (不确定性)：如果没有单位模特征值，且不稳定特征值的数量严格小于 $n_j$。\n- 代码 $2$ (无解)：如果没有单位模特征值，且不稳定特征值的数量严格大于 $n_j$。\n- 代码 $3$ (单位根边界)：如果至少存在一个单位模特征值。\n\n您的任务是：\n1. 计算下面每个测试案例中 $T$ 的特征值。\n2. 使用容差 $\\tau$ 统计稳定、单位模和不稳定特征值的数量。\n3. 为每个测试案例生成一个包含四个整数的列表 $[\\text{count\\_stable}, \\text{count\\_unit}, \\text{count\\_unstable}, \\text{code}]$。\n4. 将所有测试案例的结果汇总到单行打印输出，格式为不含空格的列表之列表，例如：$[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],\\dots]$。\n\n设计要求：至少包含一个系统中恰好有一个特征值的模等于 $1$，以便分析其产生的系统动态。\n\n使用以下测试套件。在所有情况下，$n = 2$, $n_p = 1$, $n_j = 1$，其中 $y_t = \\left(s_t, q_t\\right)^\\prime$ 且\n$$\nF = \\begin{bmatrix} 1 & 0 \\\\ 0 & \\beta \\end{bmatrix}.\n$$\n- 测试 $1$ (通过构造得到精确的单位模特征值)：设 $\\beta = 0.95$，且\n$$\nH = \\begin{bmatrix} 1 & 0 \\\\ \\kappa & 1 \\end{bmatrix}, \\quad \\kappa = 0.5.\n$$\n这意味着系统为\n$\ns_{t+1} = s_t, \\quad \\beta \\, \\mathbb{E}_t\\left[q_{t+1}\\right] = q_t + \\kappa s_t.\n$\n- 测试 $2$ (目标：唯一稳定解)：设 $\\beta = 0.95$，且\n$\nH = \\begin{bmatrix} 0.9 & 0 \\\\ 0.3 & 1.0 \\end{bmatrix}.\n$\n- 测试 $3$ (目标：不确定性)：设 $\\beta = 0.95$，且\n$\nH = \\begin{bmatrix} 0.9 & 0 \\\\ 0.3 & 0.8 \\end{bmatrix}.\n$\n- 测试 $4$ (目标：无解)：设 $\\beta = 0.95$，且\n$\nH = \\begin{bmatrix} 1.1 & 0 \\\\ 0.3 & 1.0 \\end{bmatrix}.\n$\n\n最终输出格式要求：您的程序应生成单行输出，其中包含结果，格式为一个由四个整数组成的结果列表的逗号分隔列表，不含任何空格，并用方括号括起来。例如，输出必须如下所示：\n$\n[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],[a_3,b_3,c_3,d_3],[a_4,b_4,c_4,d_4]].\n$", "solution": "所提出的问题是计算经济学中一个明确定义的练习，具体涉及线性理性预期模型的分析。它要求应用 Blanchard-Kahn 条件来对几个系统的稳定性和确定性进行分类。该问题具有科学依据、客观，并为获得唯一解提供了所有必要信息。因此，该问题被认为是有效的，并将按如下方式求解。\n\n问题的核心是分析由以下矩阵方程描述的系统动态：\n$$\nF \\, \\mathbb{E}_t\\left[y_{t+1}\\right] = H \\, y_t\n$$\n其中 $y_t$ 是一个包含 $n$ 个变量的向量，被划分为 $n_p$ 个预定变量和 $n_j$ 个非预定（或“跳跃”）变量。该系统可以通过左乘 $F$ 的逆矩阵（假设为非奇异矩阵）改写为状态空间形式：\n$$\n\\mathbb{E}_t\\left[y_{t+1}\\right] = F^{-1} H \\, y_t = T \\, y_t\n$$\n矩阵 $T \\equiv F^{-1} H$ 是转移矩阵。$T$ 的特征值决定了系统的动态属性。Blanchard-Kahn 条件在不稳定特征值（模大于 1 的特征值）的数量与获得唯一、稳定的理性预期均衡所需的跳跃变量数量 $n_j$ 之间建立了精确的关系。\n\n条件如下：\n1.  **唯一稳定解**：当且仅当 $T$ 的模严格大于 1 的特征值数量恰好等于跳跃变量的数量 $n_j$ 时，存在唯一的、非爆炸性的解路径。\n2.  **不确定性（多重解）**：如果不稳定特征值的数量严格小于 $n_j$，则存在无限多个稳定解路径。\n3.  **无稳定解**：如果不稳定特征值的数量严格大于 $n_j$，则不存在稳定解，因为任何与模型结构一致的路径都将是爆炸性的。\n\n该问题要求一个特定的数值实现，包括使用容差 $\\tau = 10^{-8}$ 对特征值进行数值分类，以及对模等于 1 的特征值（单位根）进行特殊处理。特征值 $\\lambda$ 根据其模 $|\\lambda|$ 进行分类：\n- 稳定：$|\\lambda| < 1 - \\tau$\n- 单位模：$1 - \\tau \\le |\\lambda| \\le 1 + \\tau$\n- 不稳定：$|\\lambda| > 1 + \\tau$\n\n然后用一个代码对系统进行分类。如果至少存在一个单位模特征值，系统被赋予代码 $3$。否则，应用标准的 Blanchard-Kahn 条件，根据不稳定特征值的数量分别等于、小于或大于 $n_j$，得到代码 $0$（唯一解）、$1$（不确定性）或 $2$（无解）。\n\n对于所有测试案例，参数为 $n=2$，$n_p=1$，$n_j=1$ 和 $\\beta = 0.95$。矩阵 $F$ 由下式给出：\n$$\nF = \\begin{bmatrix} 1 & 0 \\\\ 0 & \\beta \\end{bmatrix} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 0.95 \\end{bmatrix}\n$$\n因此，其逆矩阵 $F^{-1}$ 为：\n$$\nF^{-1} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1/\\beta \\end{bmatrix} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1/0.95 \\end{bmatrix}\n$$\n\n我们现在将系统地分析每个测试案例。\n\n**测试案例 1**\n矩阵 $H$ 由下式给出：\n$$\nH = \\begin{bmatrix} 1 & 0 \\\\ 0.5 & 1 \\end{bmatrix}\n$$\n转移矩阵 $T$ 为：\n$$\nT = F^{-1} H = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1/0.95 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\\\ 0.5 & 1 \\end{bmatrix} = \\begin{bmatrix} 1 & 0 \\\\ 0.5/0.95 & 1/0.95 \\end{bmatrix}\n$$\n由于 $T$ 是一个下三角矩阵，其特征值是其对角线元素：$\\lambda_1 = 1$ 和 $\\lambda_2 = 1/0.95 \\approx 1.05263158$。\n模为 $|\\lambda_1| = 1$ 和 $|\\lambda_2| \\approx 1.05263158$。\n使用容差 $\\tau = 10^{-8}$：\n- $|\\lambda_1| = 1$ 落在区间 $[1 - \\tau, 1 + \\tau]$ 内，因此它是一个单位模特征值。\n- $|\\lambda_2| \\approx 1.05263158 > 1 + \\tau$，因此它是一个不稳定特征值。\n计数为：稳定数 = $0$，单位模数 = $1$，不稳定数 = $1$。\n由于存在一个单位模特征值，分类代码为 $3$。\n此案例的结果是 $[0, 1, 1, 3]$。\n\n**测试案例 2**\n矩阵 $H$ 由下式给出：\n$$\nH = \\begin{bmatrix} 0.9 & 0 \\\\ 0.3 & 1.0 \\end{bmatrix}\n$$\n转移矩阵 $T$ 为：\n$$\nT = F^{-1} H = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1/0.95 \\end{bmatrix} \\begin{bmatrix} 0.9 & 0 \\\\ 0.3 & 1.0 \\end{bmatrix} = \\begin{bmatrix} 0.9 & 0 \\\\ 0.3/0.95 & 1.0/0.95 \\end{bmatrix}\n$$\n特征值为对角线元素：$\\lambda_1 = 0.9$ 和 $\\lambda_2 = 1.0/0.95 \\approx 1.05263158$。\n模为 $|\\lambda_1| = 0.9$ 和 $|\\lambda_2| \\approx 1.05263158$。\n使用容差 $\\tau = 10^{-8}$：\n- $|\\lambda_1| = 0.9 < 1 - \\tau$，因此它是一个稳定特征值。\n- $|\\lambda_2| \\approx 1.05263158 > 1 + \\tau$，因此它是一个不稳定特征值。\n计数为：稳定数 = $1$，单位模数 = $0$，不稳定数 = $1$。\n没有单位模特征值。不稳定特征值的数量为 $1$，等于跳跃变量的数量 $n_j=1$。这对应于唯一稳定解。分类代码为 $0$。\n此案例的结果是 $[1, 0, 1, 0]$。\n\n**测试案例 3**\n矩阵 $H$ 由下式给出：\n$$\nH = \\begin{bmatrix} 0.9 & 0 \\\\ 0.3 & 0.8 \\end{bmatrix}\n$$\n转移矩阵 $T$ 为：\n$$\nT = F^{-1} H = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1/0.95 \\end{bmatrix} \\begin{bmatrix} 0.9 & 0 \\\\ 0.3 & 0.8 \\end{bmatrix} = \\begin{bmatrix} 0.9 & 0 \\\\ 0.3/0.95 & 0.8/0.95 \\end{bmatrix}\n$$\n特征值为对角线元素：$\\lambda_1 = 0.9$ 和 $\\lambda_2 = 0.8/0.95 \\approx 0.84210526$。\n模为 $|\\lambda_1| = 0.9$ 和 $|\\lambda_2| \\approx 0.84210526$。\n使用容差 $\\tau = 10^{-8}$：\n- $|\\lambda_1| = 0.9 < 1 - \\tau$，因此它是一个稳定特征值。\n- $|\\lambda_2| \\approx 0.84210526 < 1 - \\tau$，因此它也是一个稳定特征值。\n计数为：稳定数 = $2$，单位模数 = $0$，不稳定数 = $0$。\n没有单位模特征值。不稳定特征值的数量为 $0$，小于 $n_j=1$。这对应于不确定性。分类代码为 $1$。\n此案例的结果是 $[2, 0, 0, 1]$。\n\n**测试案例 4**\n矩阵 $H$ 由下式给出：\n$$\nH = \\begin{bmatrix} 1.1 & 0 \\\\ 0.3 & 1.0 \\end{bmatrix}\n$$\n转移矩阵 $T$ 为：\n$$\nT = F^{-1} H = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1/0.95 \\end{bmatrix} \\begin{bmatrix} 1.1 & 0 \\\\ 0.3 & 1.0 \\end{bmatrix} = \\begin{bmatrix} 1.1 & 0 \\\\ 0.3/0.95 & 1.0/0.95 \\end{bmatrix}\n$$\n特征值为对角线元素：$\\lambda_1 = 1.1$ 和 $\\lambda_2 = 1.0/0.95 \\approx 1.05263158$。\n模为 $|\\lambda_1| = 1.1$ 和 $|\\lambda_2| \\approx 1.05263158$。\n使用容差 $\\tau = 10^{-8}$：\n- $|\\lambda_1| = 1.1 > 1 + \\tau$，因此它是一个不稳定特征值。\n- $|\\lambda_2| \\approx 1.05263158 > 1 + \\tau$，因此它也是一个不稳定特征值。\n计数为：稳定数 = $0$，单位模数 = $0$，不稳定数 = $2$。\n没有单位模特征值。不稳定特征值的数量为 $2$，大于 $n_j=1$。这对应于无稳定解。分类代码为 $2$。\n此案例的结果是 $[0, 0, 2, 2]$。\n\n因此，四个测试案例的汇总结果是：\n1.  $[0, 1, 1, 3]$\n2.  $[1, 0, 1, 0]$\n3.  $[2, 0, 0, 1]$\n4.  $[0, 0, 2, 2]$\n\n以下程序实现了这一逻辑，以生成所需格式的最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Applies Blanchard-Kahn conditions to classify linear rational expectations models.\n    \"\"\"\n    # Define common parameters from the problem statement.\n    beta = 0.95\n    n_p = 1\n    n_j = 1\n    tau = 1e-8\n\n    # Define the common matrix F.\n    F = np.array([\n        [1.0, 0.0],\n        [0.0, beta]\n    ])\n\n    # Define the test cases with their respective H matrices.\n    test_cases = [\n        # Test 1: Unit-modulus\n        np.array([\n            [1.0, 0.0],\n            [0.5, 1.0]\n        ]),\n        # Test 2: Unique stable solution\n        np.array([\n            [0.9, 0.0],\n            [0.3, 1.0]\n        ]),\n        # Test 3: Indeterminacy\n        np.array([\n            [0.9, 0.0],\n            [0.3, 0.8]\n        ]),\n        # Test 4: No solution\n        np.array([\n            [1.1, 0.0],\n            [0.3, 1.0]\n        ]),\n    ]\n\n    all_results = []\n    \n    # Pre-calculate the inverse of F as it is common to all tests.\n    F_inv = np.linalg.inv(F)\n\n    for H in test_cases:\n        # 1. Compute the transition matrix T = F^{-1} * H.\n        T = F_inv @ H\n\n        # 2. Compute the eigenvalues of T.\n        eigenvalues = np.linalg.eigvals(T)\n        \n        # Calculate the modulus (absolute value) of each eigenvalue.\n        moduli = np.abs(eigenvalues)\n\n        # 3. Count the numbers of stable, unit-modulus, and unstable eigenvalues.\n        count_stable = 0\n        count_unit = 0\n        count_unstable = 0\n\n        for mod in moduli:\n            if mod  1.0 - tau:\n                count_stable += 1\n            elif mod > 1.0 + tau:\n                count_unstable += 1\n            else: # mod is in [1 - tau, 1 + tau]\n                count_unit += 1\n        \n        # 4. Determine the classification code.\n        code = -1 # Default/error value\n        if count_unit > 0:\n            code = 3 # Unit-root borderline\n        else:\n            if count_unstable == n_j:\n                code = 0 # Unique stable solution\n            elif count_unstable  n_j:\n                code = 1 # Indeterminacy\n            else: # count_unstable > n_j\n                code = 2 # No solution\n        \n        # 5. Assemble the result list for the current test case.\n        result = [count_stable, count_unit, count_unstable, code]\n        all_results.append(result)\n\n    # 6. Format the final output string as specified.\n    # The output must be a string representation of a list of lists,\n    # with no spaces. e.g., [[0,1,1,3],[1,0,1,0],...]\n    \n    # Create a list of string representations of each inner list.\n    sub_results_str = [f\"[{','.join(map(str, r))}]\" for r in all_results]\n    \n    # Join the sub-result strings with commas and enclose in brackets.\n    final_output_str = f\"[{','.join(sub_results_str)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```", "id": "2376651"}]}