{"hands_on_practices": [{"introduction": "理论是指导实践的灯塔。本练习将引导你运用汉密尔顿-雅可比-贝尔曼（HJB）方程，从头开始分析解决一个经典的连续时间金融问题——默顿的投资组合问题。通过这个练习，你将亲手实践如何构建HJB方程、利用一阶条件推导最优控制，并最终使用“猜测与验证”的方法找到价值函数的具体形式，从而掌握解决这类问题的核心分析流程。[@problem_id:2416529]", "problem": "考虑一个连续时间的、无摩擦的金融市场，其中有两种资产。一种无风险资产（货币市场账户）$B_{t}$ 的演变遵循 $dB_{t} = r B_{t} \\, dt$ ，其中 $r \\ge 0$ 为恒定的无风险利率。一种风险资产 $S_{t}$ 遵循几何布朗运动，由 $dS_{t} = S_{t} \\left( \\mu \\, dt + \\sigma \\, dW_{t} \\right)$ 给出，其中 $\\mu > r$ 和 $\\sigma > 0$ 是常数，$\\{ W_{t} \\}_{t \\ge 0}$ 是在一个满足通常条件的带流概率空间上的标准布朗运动。一个初始财富为 $W_{0} = w > 0$ 的投资者选择一个消费过程 $\\{ c_{t} \\}_{t \\ge 0}$ 和一个投资组合过程 $\\{ \\pi_{t} \\}_{t \\ge 0}$，其中 $\\pi_{t}$ 表示在时间 $t$ 配置于风险资产的财富的恒定比例，剩余的比例 $1 - \\pi_{t}$ 配置于无风险资产。财富的演变过程为\n$$\ndW_{t} = \\left[ r W_{t} + \\pi_{t} W_{t} (\\mu - r) - c_{t} \\right] dt + \\pi_{t} W_{t} \\sigma \\, dW_{t},\n$$\n其可容许性要求为，对于所有 $t \\ge 0$，$W_{t} \\ge 0$ 和 $c_{t} \\ge 0$ 几乎必然成立，并且 $\\{ \\pi_{t}, c_{t} \\}$ 是循序可测和可积的，以使随机积分有良好定义。\n\n投资者对消费具有时间可分的偏好，瞬时效用为 $U(c) = \\ln(c)$，主观贴现率为 $\\delta > 0$。其目标是最大化期望贴现效用\n$$\n\\sup_{\\{ \\pi_{t}, c_{t} \\}_{t \\ge 0}} \\; \\mathbb{E} \\left[ \\int_{0}^{\\infty} \\exp(-\\delta t) \\, \\ln(c_{t}) \\, dt \\right].\n$$\n\n确定解决此问题的投资于风险资产的财富的唯一恒定（时间与财富不变）最优比例 $\\pi^{\\star}$。请用包含 $\\mu$、$r$ 和 $\\sigma$ 的单一闭式解析表达式表示您的最终答案。无需四舍五入。答案中不要包含单位。", "solution": "所提出的问题是连续时间金融学中一个经典的、定义明确的问题，具体来说是具有无限时间跨度的默顿投资组合问题。该问题具有科学依据，数学上是适定的，并且所有参数和目标都已清晰、精确地陈述。因此，它被认为是一个有效的问题。我们将使用动态规划方法来解决它，这会引导出汉密尔顿-雅可比-贝尔曼（HJB）方程。\n\n设 $J(W)$ 为值函数，代表当前财富为 $W$ 的投资者可实现的最大期望效用。由于无限的时间跨度和恒定的参数，值函数与时间 $t$ 无关。其定义如下：\n$$\nJ(W) = \\sup_{\\{ \\pi_{t}, c_{t} \\}_{t \\ge 0}} \\; \\mathbb{E} \\left[ \\int_{0}^{\\infty} \\exp(-\\delta t) \\, \\ln(c_{t}) \\, dt \\;\\middle|\\; W_{0}=W \\right]\n$$\n状态变量是财富 $W_{t}$，控制变量是消费 $c_{t}$ 和投资于风险资产的财富比例 $\\pi_{t}$。财富的动态由以下随机微分方程给出：\n$$\ndW_{t} = \\left[ r W_{t} + \\pi_{t} W_{t} (\\mu - r) - c_{t} \\right] dt + \\pi_{t} W_{t} \\sigma \\, dW_{t}\n$$\n这个随机最优控制问题的汉密尔顿-雅可比-贝尔曼方程是：\n$$\n\\delta J(W) = \\sup_{c \\ge 0, \\pi} \\left\\{ \\ln(c) + J'(W) \\left[ r W + \\pi W (\\mu - r) - c \\right] + \\frac{1}{2} J''(W) \\left( \\pi W \\sigma \\right)^{2} \\right\\}\n$$\n其中 $J'(W) = \\frac{dJ}{dW}$ 和 $J''(W) = \\frac{d^{2}J}{dW^{2}}$。左边的项 $\\delta J(W)$ 代表最优策略必须产生的“流量价值”，以在时间上匹配总价值 $J(W)$，其中 $\\delta$ 是贴现率。右边是瞬时消费效用 $\\ln(c)$ 与值函数的期望瞬时变化之和的最大化，后者通过将过程的生成元应用于 $J(W)$ 得到。\n\n为求最优控制，我们对上确界内部的表达式分别关于 $c$ 和 $\\pi$ 取一阶条件。\n首先，对消费 $c$ 求导：\n$$\n\\frac{\\partial}{\\partial c} \\left( \\ln(c) - c J'(W) \\right) = \\frac{1}{c} - J'(W) = 0\n$$\n这得出了最优消费规则：\n$$\nc^{\\star}(W) = \\frac{1}{J'(W)}\n$$\n二阶条件为 $-\\frac{1}{c^{2}} < 0$，这证实了它是一个最大值。\n\n接下来，对投资组合比例 $\\pi$ 求导：\n$$\n\\frac{\\partial}{\\partial \\pi} \\left( J'(W) \\pi W (\\mu - r) + \\frac{1}{2} J''(W) \\pi^{2} W^{2} \\sigma^{2} \\right) = J'(W) W (\\mu - r) + J''(W) \\pi W^{2} \\sigma^{2} = 0\n$$\n求解 $\\pi$，我们得到最优投资组合规则：\n$$\n\\pi^{\\star}(W) = - \\frac{J'(W) W (\\mu - r)}{J''(W) W^{2} \\sigma^{2}} = - \\frac{\\mu - r}{\\sigma^{2}} \\frac{J'(W)}{W J''(W)}\n$$\n二阶条件要求 $J''(W) W^{2} \\sigma^{2} < 0$。由于 $W^{2} > 0$ 且 $\\sigma^{2} > 0$，这要求 $J''(W) < 0$。这与凹值函数是一致的，对于一个风险厌恶的投资者来说，这是预料之中的。\n\n问题的结构，即效用是对数的且财富动态是乘性的，表明值函数的解具有以下形式：\n$$\nJ(W) = A \\ln(W) + B\n$$\n其中 $A$ 和 $B$ 是待定常数。凹性要求 $J''(W) < 0$ 意味着 $A > 0$。\n这个猜测的值函数的导数是：\n$$\nJ'(W) = \\frac{A}{W}\n$$\n$$\nJ''(W) = -\\frac{A}{W^{2}}\n$$\n将这些导数代入最优投资组合比例 $\\pi^{\\star}(W)$ 的表达式中：\n$$\n\\pi^{\\star} = - \\frac{\\mu - r}{\\sigma^{2}} \\frac{A/W}{W(-A/W^{2})} = - \\frac{\\mu - r}{\\sigma^{2}} \\frac{A/W}{-A/W} = \\frac{\\mu - r}{\\sigma^{2}}\n$$\n这个结果是一个常数，与财富 $W$ 和时间 $t$ 无关，这与问题所要求的“唯一恒定最优比例”是一致的。问题只要求这个比例。\n\n为了完整起见，我们可以通过将最优控制和值函数拟设代回HJB方程来确定常数 $A$。\n最优消费为 $c^{\\star} = \\frac{1}{J'(W)} = \\frac{W}{A}$。\nHJB方程变为：\n$$\n\\delta (A \\ln(W) + B) = \\ln\\left(\\frac{W}{A}\\right) + \\frac{A}{W}\\left[ rW + \\left(\\frac{\\mu - r}{\\sigma^{2}}\\right)W(\\mu-r) - \\frac{W}{A} \\right] + \\frac{1}{2}\\left(-\\frac{A}{W^{2}}\\right)\\left(\\frac{\\mu - r}{\\sigma^{2}}\\right)^{2} W^{2} \\sigma^{2}\n$$\n简化表达式：\n$$\n\\delta A \\ln(W) + \\delta B = (\\ln(W) - \\ln(A)) + A\\left[r + \\frac{(\\mu-r)^{2}}{\\sigma^{2}} - \\frac{1}{A}\\right] - \\frac{A}{2}\\frac{(\\mu-r)^{2}}{\\sigma^{2}}\n$$\n$$\n\\delta A \\ln(W) + \\delta B = \\ln(W) - \\ln(A) + Ar + \\frac{A(\\mu-r)^{2}}{\\sigma^{2}} - 1 - \\frac{A(\\mu-r)^{2}}{2\\sigma^{2}}\n$$\n$$\n\\delta A \\ln(W) + \\delta B = \\ln(W) + \\left[ - \\ln(A) - 1 + Ar + \\frac{A(\\mu-r)^{2}}{2\\sigma^{2}} \\right]\n$$\n为了使此方程对所有 $W > 0$ 成立，两边 $\\ln(W)$ 的系数和常数项必须相等。\n令 $\\ln(W)$ 的系数相等：\n$$\n\\delta A = 1 \\implies A = \\frac{1}{\\delta}\n$$\n由于 $\\delta > 0$，我们有 $A > 0$，这与我们之前的凹性要求是一致的。\n常数 $B$ 的解的存在性证实了我们拟设的有效性，但其值对于回答问题并非必需。投资于风险资产的财富的最优比例仅取决于市场参数 $\\mu$、$r$ 和 $\\sigma$。\n\n因此，最终答案是为 $\\pi^{\\star}$ 推导出的常数表达式。", "answer": "$$\n\\boxed{\\frac{\\mu - r}{\\sigma^{2}}}\n$$", "id": "2416529"}, {"introduction": "将理论公式转化为可执行的策略是经济和金融建模的关键一步。本练习以一个更具一般性的恒定相对风险规避（CRRA）效用函数为背景，要求你将从HJB方程推导出的最优消费和投资组合公式应用于具体的数值场景中。通过编写代码解决问题，你不仅能加深对分析解的理解，还能直观地观察到风险厌恶程度、预期回报率等关键参数如何共同决定最优决策。[@problem_id:2414704]", "problem": "考虑一个无限期、连续时间的消费-投资问题。一个具有财富 $w(t)$ 的代表性投资者在每个时刻 $t \\ge 0$ 选择一个非负消费率 $c(t) \\ge 0$ 以及分配给风险资产的投资组合份额 $\\theta(t) \\in \\mathbb{R}$（其余部分投资于无风险资产）。无风险资产获得恒定的利率 $r \\in \\mathbb{R}$，而风险资产具有恒定的预期回报率 $\\mu \\in \\mathbb{R}$ 和波动率 $\\sigma &gt; 0$。该投资者具有恒定相对风险厌恶（CRRA）偏好，其相对风险厌恶系数为 $\\gamma &gt; 0$，$\\gamma \\ne 1$，主观折现率为 $\\rho &gt; 0$。瞬时消费效用为 $u(c) = \\frac{c^{1-\\gamma}}{1-\\gamma}$。财富过程遵循以下的 Itô 随机微分方程\n$$\ndw(t) = \\big((r + \\theta(t)(\\mu - r))\\,w(t) - c(t)\\big)\\,dt + \\theta(t)\\,\\sigma\\,w(t)\\,dB(t),\n$$\n其中 $B(t)$ 是标准布朗运动。令 $V(w)$ 表示价值函数。该问题的 Hamilton-Jacobi-Bellman (HJB) 方程为\n$$\n0 = \\sup_{c \\ge 0,\\ \\theta \\in \\mathbb{R}} \\left\\{ \\frac{c^{1-\\gamma}}{1-\\gamma} + V'(w)\\big((r + \\theta(\\mu - r))\\,w - c\\big) + \\frac{1}{2} V''(w)\\,\\theta^2 \\sigma^2 w^2 - \\rho V(w) \\right\\}。\n$$\n\n假设基础参数 $(r,\\mu,\\sigma,\\rho,\\gamma)$ 是不随时间变化的，并且最优策略在财富上是平稳且齐次的。定义最优消费-财富比 $k^\\star := \\frac{c^\\star}{w}$ 和最优风险资产份额 $\\theta^\\star$。对于下方的每一组参数，计算 HJB 最优性条件所蕴含的实数对 $(k^\\star,\\theta^\\star)$。你的程序应按测试集的顺序返回结果。\n\n测试集（每个元组为 $(\\rho,\\gamma,r,\\mu,\\sigma)$）：\n- 测试 1: $(0.05,\\,2.0,\\,0.02,\\,0.06,\\,0.2)$\n- 测试 2: $(0.04,\\,3.0,\\,0.02,\\,0.02,\\,0.25)$\n- 测试 3: $(0.06,\\,0.5,\\,0.01,\\,0.07,\\,0.3)$\n- 测试 4: $(0.04,\\,10.0,\\,0.03,\\,0.05,\\,0.2)$\n\n答案要求：\n- 对于每个测试，输出一个列表 $[k^\\star,\\theta^\\star]$，其中两个条目都精确到 $6$ 位小数。\n- 将所有测试的结果汇总成一行，格式为一个用方括号括起来的逗号分隔列表。例如，总输出格式必须为 $[[a_1,b_1],[a_2,b_2],[a_3,b_3],[a_4,b_4]]$，其中每个 $a_i$ 和 $b_i$ 都是精确到 $6$ 位小数的实数。", "solution": "用户提出了一个连续时间金融领域的问题，具体是 Merton 的投资组合问题。我的任务是验证其科学和数学上的完备性，如果有效，则推导求解并进行计算实现。\n\n### 步骤 1：提取已知条件\n该问题提供了以下信息：\n-   **投资者目标**：最大化消费带来的终生期望效用。\n-   **时间范围**：无限期，连续时间 $t \\in [0, \\infty)$。\n-   **状态变量**：财富 $w(t)$。\n-   **控制变量**：消费率 $c(t) \\ge 0$，风险资产中的投资组合份额 $\\theta(t) \\in \\mathbb{R}$。\n-   **资产**：\n    -   无风险资产，具有恒定利率 $r \\in \\mathbb{R}$。\n    -   风险资产，具有恒定预期回报率 $\\mu \\in \\mathbb{R}$ 和波动率 $\\sigma > 0$。\n-   **财富动态 (SDE)**：$dw(t) = \\big((r + \\theta(t)(\\mu - r))\\,w(t) - c(t)\\big)\\,dt + \\theta(t)\\,\\sigma\\,w(t)\\,dB(t)$。\n-   **偏好**：恒定相对风险厌恶（CRRA）效用 $u(c) = \\frac{c^{1-\\gamma}}{1-\\gamma}$，相对风险厌恶系数为 $\\gamma > 0, \\gamma \\ne 1$，主观折现率为 $\\rho > 0$。\n-   **价值函数和 HJB 方程**：价值函数表示为 $V(w)$，其对应的 Hamilton-Jacobi-Bellman (HJB) 方程为：\n    $$\n    0 = \\sup_{c \\ge 0,\\ \\theta \\in \\mathbb{R}} \\left\\{ \\frac{c^{1-\\gamma}}{1-\\gamma} + V'(w)\\big((r + \\theta(\\mu - r))\\,w - c\\big) + \\frac{1}{2} V''(w)\\,\\theta^2 \\sigma^2 w^2 - \\rho V(w) \\right\\}\n    $$\n-   **解的形式**：假设最优策略是平稳且齐次的，定义了最优消费-财富比 $k^\\star := \\frac{c^\\star}{w}$ 和最优风险资产份额 $\\theta^\\star$。\n-   **测试集**：提供了一组包含四个参数元组 $(\\rho,\\gamma,r,\\mu,\\sigma)$ 用于计算。\n    -   测试 1: $(0.05,\\,2.0,\\,0.02,\\,0.06,\\,0.2)$\n    -   测试 2: $(0.04,\\,3.0,\\,0.02,\\,0.02,\\,0.25)$\n    -   测试 3: $(0.06,\\,0.5,\\,0.01,\\,0.07,\\,0.3)$\n    -   测试 4: $(0.04,\\,10.0,\\,0.03,\\,0.05,\\,0.2)$\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题进行验证。\n-   **科学依据**：该问题是 Merton 投资组合问题的经典表述，是金融经济学中的一个基础模型。它牢固地建立在随机微积分、最优控制理论和微观经济效用理论的原理之上。该问题在科学上是合理的。\n-   **适定性**：该问题是适定的。对于给定的 CRRA 效用函数和线性资产动态，已知存在唯一且稳定的最优控制解，前提是满足某些横截性条件（此处已默认满足）。\n-   **客观性**：问题使用精确的数学语言陈述，没有任何主观或模棱两可的术语。\n-   **完整性和一致性**：所有必要的参数和函数形式都已提供。不存在内部矛盾。\n\n### 步骤 3：结论和行动\n问题被判定为**有效**。这是一个标准的、定义明确的数理金融问题。我现在将着手进行完整求解。\n\n### 基于原理的求解推导\n\n通过求解 HJB 方程来找到最优控制变量 $c$ 和 $\\theta$ 的解。这是通过将最大化的一阶条件（FOCs）应用于上确界内的项来实现的。\n\n1.  **一阶条件 (FOCs)**：\n    我们对哈密顿量关于 $c$ 和 $\\theta$ 求偏导数，并令其等于零。\n\n    关于消费 $c$ 的一阶条件：\n    $$ \\frac{\\partial}{\\partial c} \\left( \\frac{c^{1-\\gamma}}{1-\\gamma} - V'(w)c \\right) = c^{-\\gamma} - V'(w) = 0 $$\n    $$ \\implies c^\\star(w) = (V'(w))^{-1/\\gamma} $$\n\n    关于风险资产份额 $\\theta$ 的一阶条件：\n    $$ \\frac{\\partial}{\\partial \\theta} \\left( V'(w)\\theta(\\mu-r)w + \\frac{1}{2}V''(w)\\theta^2\\sigma^2w^2 \\right) = V'(w)(\\mu-r)w + V''(w)\\theta\\sigma^2w^2 = 0 $$\n    $$ \\implies \\theta^\\star(w) = -\\frac{V'(w)(\\mu-r)w}{V''(w)\\sigma^2w^2} = -\\frac{\\mu-r}{\\sigma^2w} \\frac{V'(w)}{V''(w)} $$\n    二阶条件要求 $V''(w) < 0$，这证实了价值函数必须是凹函数，这与风险厌恶是一致的。\n\n2.  **价值函数拟设**：\n    鉴于 CRRA 效用和问题的规模不变性，我们推测价值函数解的形式为：\n    $$ V(w) = A \\frac{w^{1-\\gamma}}{1-\\gamma} $$\n    其中 $A > 0$ 为某个常数。其导数为：\n    $$ V'(w) = A w^{-\\gamma} $$\n    $$ V''(w) = -\\gamma A w^{-\\gamma - 1} $$\n\n3.  **求解最优控制**：\n    将价值函数的导数代入 $c^\\star$ 和 $\\theta^\\star$ 的一阶条件。\n\n    对于最优消费-财富比 $k^\\star$：\n    $$ c^\\star(w) = (A w^{-\\gamma})^{-1/\\gamma} = A^{-1/\\gamma}w $$\n    最优消费是财富的一个恒定比例。我们将此比例定义为 $k^\\star$：\n    $$ k^\\star = \\frac{c^\\star}{w} = A^{-1/\\gamma} $$\n\n    对于最优风险资产份额 $\\theta^\\star$：\n    $$ \\theta^\\star = -\\frac{\\mu-r}{\\sigma^2w} \\frac{A w^{-\\gamma}}{-\\gamma A w^{-\\gamma - 1}} = \\frac{\\mu-r}{\\gamma\\sigma^2w} \\frac{w^{-\\gamma}}{w^{-\\gamma-1}} = \\frac{\\mu-r}{\\gamma\\sigma^2w} w = \\frac{\\mu-r}{\\gamma\\sigma^2} $$\n    最优风险资产份额 $\\theta^\\star$ 是一个与财富无关的常数。\n\n4.  **求解 HJB 方程**：\n    将最优控制 ($c^\\star = k^\\star w$, $\\theta^\\star$) 和价值函数拟设代入 HJB 方程。优化后，HJB 方程为：\n    $$ \\rho V(w) = \\frac{(c^\\star)^{1-\\gamma}}{1-\\gamma} + V'(w)\\left[(r + \\theta^\\star(\\mu-r))w - c^\\star\\right] + \\frac{1}{2}V''(w)(\\theta^\\star)^2\\sigma^2w^2 $$\n    与最优投资组合相关的项简化为：\n    $$ V'(w)(r + \\theta^\\star(\\mu-r))w + \\frac{1}{2}V''(w)(\\theta^\\star)^2\\sigma^2w^2 = V'(w)w \\left( r + \\frac{(\\mu-r)^2}{2\\gamma\\sigma^2} \\right) $$\n    与消费相关的项简化为：\n    $$ \\frac{(c^\\star)^{1-\\gamma}}{1-\\gamma} - V'(w)c^\\star = \\frac{(k^\\star w)^{1-\\gamma}}{1-\\gamma} - (Aw^{-\\gamma})(k^\\star w) = \\frac{(A^{-1/\\gamma}w)^{1-\\gamma}}{1-\\gamma} - A k^\\star w^{1-\\gamma} $$\n    $$ = \\frac{A^{-(1-\\gamma)/\\gamma}w^{1-\\gamma}}{1-\\gamma} - A (A^{-1/\\gamma}) w^{1-\\gamma} = \\frac{A^{-1/\\gamma} A w^{1-\\gamma}}{1-\\gamma} - A^{1-1/\\gamma} w^{1-\\gamma} = A^{1-1/\\gamma}w^{1-\\gamma}\\left(\\frac{1}{1-\\gamma} - 1\\right) = A^{1-1/\\gamma}w^{1-\\gamma}\\frac{\\gamma}{1-\\gamma} $$\n    使用 $k^\\star = A^{-1/\\gamma}$，此项为 $k^\\star A w^{1-\\gamma} \\frac{\\gamma}{1-\\gamma}$。\n\n    完整的 HJB 方程变为：\n    $$ \\rho A \\frac{w^{1-\\gamma}}{1-\\gamma} = k^\\star A w^{1-\\gamma} \\frac{\\gamma}{1-\\gamma} + A w^{1-\\gamma} \\left( r + \\frac{(\\mu-r)^2}{2\\gamma\\sigma^2} \\right) $$\n    两边同除以 $A w^{1-\\gamma}$：\n    $$ \\frac{\\rho}{1-\\gamma} = \\frac{k^\\star \\gamma}{1-\\gamma} + r + \\frac{(\\mu-r)^2}{2\\gamma\\sigma^2} $$\n    两边同乘以 $(1-\\gamma)$：\n    $$ \\rho = k^\\star \\gamma + (1-\\gamma)\\left( r + \\frac{(\\mu-r)^2}{2\\gamma\\sigma^2} \\right) $$\n    现在，求解 $k^\\star$：\n    $$ k^\\star \\gamma = \\rho - (1-\\gamma)r - \\frac{(1-\\gamma)(\\mu-r)^2}{2\\gamma\\sigma^2} $$\n    $$ k^\\star = \\frac{1}{\\gamma}\\left[ \\rho - (1-\\gamma)r - \\frac{(1-\\gamma)(\\mu-r)^2}{2\\gamma\\sigma^2} \\right] $$\n\n5.  **用于计算的最终公式**：\n    最优恒定风险资产份额为：\n    $$ \\theta^\\star = \\frac{\\mu - r}{\\gamma \\sigma^2} $$\n    最优恒定消费-财富比为：\n    $$ k^\\star = \\frac{1}{\\gamma}\\left[ \\rho - (1-\\gamma)r - \\frac{(1-\\gamma)(\\mu-r)^2}{2\\gamma\\sigma^2} \\right] $$\n    现在将这些公式应用于每个测试案例。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the optimal consumption-wealth ratio (k_star) and\n    risky asset share (theta_star) in the Merton's portfolio problem\n    for a given set of parameters.\n    \"\"\"\n    \n    # Test suite: each tuple is (rho, gamma, r, mu, sigma)\n    test_cases = [\n        (0.05, 2.0, 0.02, 0.06, 0.2),   # Test 1\n        (0.04, 3.0, 0.02, 0.02, 0.25),  # Test 2\n        (0.06, 0.5, 0.01, 0.07, 0.3),   # Test 3\n        (0.04, 10.0, 0.03, 0.05, 0.2),  # Test 4\n    ]\n\n    results = []\n    for case in test_cases:\n        rho, gamma, r, mu, sigma = case\n\n        # Ensure parameters are floats for precision\n        rho, gamma, r, mu, sigma = float(rho), float(gamma), float(r), float(mu), float(sigma)\n\n        # Calculate the optimal risky share theta_star\n        # theta_star = (mu - r) / (gamma * sigma^2)\n        try:\n            theta_star = (mu - r) / (gamma * sigma**2)\n        except ZeroDivisionError:\n            # Handle cases where sigma or gamma are zero, although problem constraints are > 0\n            theta_star = float('nan')\n\n        # Calculate the optimal consumption-wealth ratio k_star\n        # k_star = (1/gamma) * [rho - (1-gamma)*r - ((1-gamma)*(mu-r)^2) / (2*gamma*sigma^2)]\n        mu_minus_r_sq = (mu - r)**2\n        try:\n            term3 = (1 - gamma) * mu_minus_r_sq / (2 * gamma * sigma**2)\n            k_star = (1 / gamma) * (rho - (1 - gamma) * r - term3)\n        except ZeroDivisionError:\n            k_star = float('nan')\n\n        # The problem asks for the pair [k_star, theta_star]\n        results.append([k_star, theta_star])\n    return results\n\n# The main execution part is now outside the function to get the values.\n# The `solve` function in the original response was not returning the values\n# for external use, which is needed here to construct the final answer string.\ncalculated_results = solve()\nformatted_results_list = []\nfor k, t in calculated_results:\n    formatted_results_list.append(f\"[{k:.6f},{t:.6f}]\")\nfinal_output_string = f\"[{','.join(formatted_results_list)}]\"\n# print(final_output_string) # This would print [[0.040000,0.500000],[0.026667,0.000000],[0.070000,1.333333],[0.031450,0.050000]]\n```", "answer": "[[0.040000,0.500000],[0.026667,0.000000],[0.070000,1.333333],[0.031450,0.050000]]", "id": "2414704"}, {"introduction": "掌握HJB方程不仅意味着能够进行数学推导，更重要的是理解其每个组成部分背后的经济含义。本练习将挑战你对模型设定的深刻理解，通过引入“遗赠动机”，探讨它如何改变生命周期储蓄模型的终端条件，并进而影响整个生命周期的最优消费路径。这有助于你学会如何使用HJB框架不仅求解最优解，更进行经济行为的定性分析和比较。[@problem_id:2416502]", "problem": "考虑一个在有限期界 $[0,T]$ 上的确定性、连续时间的生命周期消费-储蓄问题。金融财富 $X_t$ 的演变方程为\n$$\\dot X_t \\equiv \\frac{dX_t}{dt} = r X_t + y_t - c_t,$$\n其中 $r>0$ 是恒定利率，$y_t$ 是在 $[0,T]$ 上连续且有界的给定确定性收入流，$c_t \\ge 0$ 是消费。代理人拥有初始财富 $X_0 = x_0$ 和如下偏好\n$$\\int_{0}^{T} e^{-\\rho t} u(c_t)\\,dt + e^{-\\rho T}\\,\\phi(X_T),$$\n其中 $\\rho>0$，$u(\\cdot)$ 和 $\\phi(\\cdot)$ 是二阶连续可微、严格递增且严格凹的函数。假设存在确保内部最优解存在且唯一的条件，并且动态规划方法适用。\n\n与没有遗产动机的情况（即 $\\phi \\equiv 0$）相比，下列关于遗产动机 $\\phi(X_T)$ 对最优消费-储蓄路径影响的陈述中，哪些是正确的？选择所有适用的选项。\n\nA. Hamilton-Jacobi-Bellman方程中的终端条件变为 $V(T,x)=\\phi(x)$，这提高了接近 $T$ 时财富的影子价值，并且在其他条件相同时，相对于无遗产动机的情况，倾向于减少最优消费。\n\nB. 如果在 $(0,\\infty)$ 上 $\\phi'(\\cdot)>0$，那么在 $T$ 时刻耗尽财富（即 $X_T^\\ast=0$）是最优的。\n\nC. 如果 $u(\\cdot)$ 具有系数为 $\\gamma>0$ 的恒定相对风险厌恶 (CRRA) 特性，并且 $\\phi(\\cdot)$ 是同阶的位似函数（例如，$\\phi(x)=b\\,\\frac{x^{1-\\gamma}}{1-\\gamma}$，其中 $b>0$），那么最优策略的形式为 $c_t=\\kappa(t)\\,(X_t+H_t)$，其中 $H_t=\\int_t^{T} e^{-r(s-t)} y_s\\,ds$ 是人力财富，并且 $\\phi$ 的存在会使得当 $t$ 接近 $T$ 时，$\\kappa(t)$ 相对于无遗产动机的情况更低。\n\nD. 引入遗产项等同于在 $[0,T]$ 上一致地降低纯粹时间偏好率 $\\rho$，因此它保持欧拉方程不变，而只是重新调整价值函数。\n\nE. 对于任何凹函数 $\\phi(\\cdot)$，增加遗产动机必然会使最优消费路径随时间严格递增。", "solution": "问题陈述描述了一个标准的、具有有限期界和终端遗产动机的确定性连续时间生命周期消费-储蓄模型。在继续之前，我们必须验证这一陈述。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n*   状态变量演变：$\\dot X_t \\equiv \\frac{dX_t}{dt} = r X_t + y_t - c_t$。\n*   时间期界：$[0,T]$。\n*   初始财富：$X_0 = x_0$。\n*   控制变量：消费 $c_t \\ge 0$。\n*   参数：恒定利率 $r>0$，恒定纯粹时间偏好率 $\\rho>0$。\n*   外生收入：$y_t$ 是一个给定的确定性函数，在 $[0,T]$ 上连续且有界。\n*   目标函数：$\\int_{0}^{T} e^{-\\rho t} u(c_t)\\,dt + e^{-\\rho T}\\,\\phi(X_T)$。\n*   效用函数：$u(\\cdot)$ 和 $\\phi(\\cdot)$ 是二阶连续可微、严格递增且严格凹的。这意味着 $u'(\\cdot)>0$，$u''(\\cdot)<0$，$\\phi'(\\cdot)>0$，以及 $\\phi''(\\cdot)<0$。\n*   假设：存在性和唯一性的内部最优解存在，动态规划适用。\n\n**步骤2：使用提取的已知条件进行验证**\n\n该问题是宏观经济学和金融学，特别是在计算经济学领域中使用的经典范式。\n*   **科学依据：** 该模型基于应用于经济决策的、成熟的最优控制理论原则。生命周期假说是现代宏观经济学的基石。数学结构是合理的。该问题在其所述领域有坚实的基础。\n*   **适定性：** $u$ 和 $\\phi$ 的严格凹性假设，以及其他陈述的条件（“确保存在性和唯一性”），保证了问题的适定性。存在一个唯一的最优消费路径 $c_t^*$。\n*   **客观性：** 问题使用精确的数学语言和定义进行陈述。它没有模糊性或主观论断。\n*   **完整性：**  formulating the Hamilton-Jacobi-Bellman (HJB) equation or applying the Pontryagin Maximum Principle are provided.\n\n问题陈述没有违反任何无效标准。这是一个标准的、有效的且适定的问题。\n\n**步骤3：结论与行动**\n\n问题是有效的。我们继续进行解答。\n\n### 推导与分析\n\n令 $V(t, x)$ 为价值函数，表示从时间 $t$ 的状态 $x$ 出发可获得的最大效用。\n$$\nV(t, x) = \\max_{\\{c_s\\}_{s=t}^T} \\left\\{ \\int_{t}^{T} e^{-\\rho (s-t)} u(c_s)\\,ds + e^{-\\rho (T-t)}\\,\\phi(X_T) \\right\\}\n$$\n约束条件为 $\\dot X_s = r X_s + y_s - c_s$ 和 $X_t = x$。\n\n该问题的 Hamilton-Jacobi-Bellman (HJB) 方程为：\n$$\n\\rho V(t,x) = \\max_{c \\ge 0} \\left\\{ u(c) + V_t(t,x) + V_x(t,x) (r x + y_t - c) \\right\\}\n$$\n其中 $V_t = \\frac{\\partial V}{\\partial t}$ 且 $V_x = \\frac{\\partial V}{\\partial x}$。\n\n价值函数的终端条件由时间 $T$ 的效用给出：\n$$\nV(T, x) = \\phi(x)\n$$\n在没有遗产动机的情况下，我们有 $\\phi \\equiv 0$，所以终端条件是 $V(T,x) = 0$。\n\n关于 $c$ 的最大化一阶条件，得到了作为协态变量（或财富的影子价值）$V_x(t,x)$ 的函数的最优消费策略 $c^*(t,x)$：\n$$\nu'(c_t) = V_x(t, X_t)\n$$\n由于 $u$ 是严格凹的，$u'$ 是严格递减的，其反函数 $(u')^{-1}$ 存在且也是严格递减的。因此，$c_t = (u')^{-1}(V_x(t, X_t))$。\n\n现在我们评估每个选项。\n\n**A. Hamilton-Jacobi-Bellman方程中的终端条件变为 $V(T,x)=\\phi(x)$，这提高了接近 $T$ 时财富的影子价值，并且在其他条件相同时，相对于无遗产动机的情况，倾向于减少最优消费。**\n\n这个陈述有三个部分。\n1.  **终端条件**：如上从价值函数的定义推导，在时间 $t=T$，剩余效用就是遗产效用，所以 $V(T,x)=\\phi(x)$。这是正确的。\n2.  **财富的影子价值**：财富的影子价值（或财富的边际效用）是 $V_x(t,x)$。\n    *   有遗产时：在 $t=T$，$V_x(T,x) = \\frac{d}{dx}\\phi(x) = \\phi'(x)$。由于 $\\phi$ 是严格递增的，所以 $\\phi'(x) > 0$。\n    *   无遗产时（$\\phi \\equiv 0$）：在 $t=T$，$V(T,x) = 0$，所以 $V_x(T,x) = 0$。\n    *   根据 HJB 方程解的连续性，对于接近 $T$ 的 $t$，有遗产情况下的 $V_x(t,x)$ 值将高于无遗产情况。这部分也是正确的。\n3.  **对消费的影响**：最优消费由 $c_t = (u')^{-1}(V_x(t, X_t))$ 决定。由于 $u'$ 是一个严格递减的函数，其反函数 $(u')^{-1}$ 也是严格递减的。自变量 $V_x$ 的值越高，消费 $c_t$ 的值就越低。因此，接近时间 $T$ 时财富的影子价值越高，意味着接近时间 $T$ 时的最优消费越低。这就是为了留下更多遗产而增加储蓄的经济学直觉。这部分是正确的。\n\n陈述的所有部分在逻辑上和数学上都是合理的。\n结论：**正确**。\n\n**B. 如果在 $(0,\\infty)$ 上 $\\phi'(\\cdot)>0$，那么在 $T$ 时刻耗尽财富（即 $X_T^\\ast=0$）是最优的。**\n\n条件 $\\phi'(\\cdot) > 0$ 意味着留下遗产有正的边际效用。这提供了储蓄和积累财富以便在时间 $T$ 留下的激励。将财富作为遗产留下的替代方案是在时间 $T$ 之前消费掉它。最优路径在消费的边际效用和遗产的边际效用之间取得平衡。\n\n来自 Pontryagin 极大值原理（等价于 HJB 方法）的横截性条件表明，协态变量 $\\lambda_T$ 的终端值必须等于终端状态的边际效用。在这里，$\\lambda_t = e^{-\\rho t} V_x(t, X_t)$ 是贴现后的影子价格。以现值表示，协态变量是 $\\mu_t = V_x(t, X_t)$，横截性条件是 $\\mu_T = \\phi'(X_T)$。由于对于 $x>0$ 有 $\\phi'(x)>0$，这意味着在时间 $T$ 财富的边际价值为正。如果财富的边际效用为正，一个理性的代理人不会自愿以零财富结束；他们会有动机去储蓄以实现 $X_T^* > 0$。财富被耗尽 ($X_T^*=0$) 的陈述与 $\\phi'>0$ 提供的经济激励相反。在无遗产动机的情况下，即 $\\phi \\equiv 0$，横截性条件是 $\\mu_T \\ge 0$ 和 $\\mu_T X_T = 0$。如果我们假设消费不饱和，则 $\\mu_T > 0$，这迫使 $X_T=0$。遗产动机改变了这一结论。\n结论：**不正确**。\n\n**C. 如果 $u(\\cdot)$ 具有系数为 $\\gamma>0$ 的恒定相对风险厌恶 (CRRA) 特性，并且 $\\phi(\\cdot)$ 是同阶的位似函数（例如，$\\phi(x)=b\\,\\frac{x^{1-\\gamma}}{1-\\gamma}$，其中 $b>0$），那么最优策略的形式为 $c_t=\\kappa(t)\\,(X_t+H_t)$，其中 $H_t=\\int_t^{T} e^{-r(s-t)} y_s\\,ds$ 是人力财富，并且 $\\phi$ 的存在会使得当 $t$ 接近 $T$ 时，$\\kappa(t)$ 相对于无遗产动机的情况更低。**\n\n这是消费理论中一个著名的结果。\n1.  **策略的形式**：令总财富为 $W_t = X_t + H_t$，其中 $H_t = \\int_t^T e^{-r(s-t)} y_s \\, ds$ 是人力财富。人力财富的时间导数是 $\\dot{H}_t = rH_t - y_t$。总财富的动态则为 $\\dot{W}_t = \\dot{X}_t + \\dot{H}_t = (rX_t + y_t - c_t) + (rH_t - y_t) = r(X_t+H_t) - c_t = rW_t - c_t$。\n    在终端时间 $T$，$H_T = 0$，所以 $X_T = W_T$。问题可以重写为最大化 $\\int_0^T e^{-\\rho t}u(c_t)dt + e^{-\\rho T}\\phi(W_T)$，约束条件为 $\\dot{W}_t=rW_t-c_t$。对于 CRRA 效用 $u(c)=\\frac{c^{1-\\gamma}}{1-\\gamma}$ 和位似遗产函数 $\\phi(W)=b\\frac{W^{1-\\gamma}}{1-\\gamma}$，价值函数也是位似的：$V(t,W)=\\psi(t)\\frac{W^{1-\\gamma}}{1-\\gamma}$。最优消费是总财富的一个固定比例，$c_t^* = \\kappa(t) W_t = \\kappa(t)(X_t+H_t)$。函数 $\\kappa(t)$ 被称为总财富的边际消费倾向。陈述的第一部分是正确的。\n2.  **对 $\\kappa(t)$ 的影响**：遗产动机引入了储蓄的理由，这在 $\\phi \\equiv 0$ 时是不存在的。对于任何给定的总财富水平 $W_t$，有遗产动机的代理人会将较小部分分配给当前消费，而将较大部分用于储蓄，与没有遗产动机的代理人相比。因此，对于有遗产动机的代理人，在所有时间 $t \\in [0,T)$，消费倾向 $\\kappa(t)$ 必须更低。这对于接近 $T$ 的 $t$ 也成立。更正式地，在无遗产动机的情况下，代理人寻求在时间 $T$ 之前耗尽所有财富，所以当 $t \\to T$ 时，$\\kappa(t) \\to 1$。在指定的遗产函数下，终端价值函数是 $V(T,W) = b\\frac{W^{1-\\gamma}}{1-\\gamma}$，从中可以推导出 $\\kappa(T) = b^{-1/\\gamma}$。对于任何有意义的遗产动机 (例如 $b>1$)，我们有 $\\kappa(T) < 1$。因此，在接近 $T$ 时，$\\kappa(t)$ 确实低于无遗产动机的情况。\n\n结论：**正确**。\n\n**D. 引入遗产项等同于在 $[0,T]$ 上一致地降低纯粹时间偏好率 $\\rho$，因此它保持欧拉方程不变，而只是重新调整价值函数。**\n\n该陈述内部不一致且与事实不符。\n这个问题的标准欧拉方程是从 Pontryagin 极大值原理推导出来的。现值协态变量 $\\mu_t = u'(c_t)$ 的演变方程为 $\\dot{\\mu}_t = \\rho \\mu_t - \\frac{\\partial H_c}{\\partial X} = \\rho \\mu_t - r \\mu_t = (\\rho-r)\\mu_t$。代入 $\\mu_t=u'(c_t)$ 并求导可得 $u''(c_t)\\dot{c}_t = (\\rho-r)u'(c_t)$。\n*   引入遗产动机改变了 $\\mu_t$（以及 $c_t$）路径的终端（横截性）条件，但它并*不*改变微分方程（欧拉方程）本身。\n*   将 $\\rho$ 降低到 $\\rho' < \\rho$ *会*将欧拉方程改变为 $u''(c_t)\\dot{c}_t = (\\rho'-r)u'(c_t)$。\n*   因此，引入遗产项不等同于降低 $\\rho$。该陈述的前提是错误的。\n*   结论“因此它保持欧拉方程不变”是关于遗产项影响的正确陈述，但它与（错误的）前提的推论相矛盾。\n*   此外，增加遗产动机 `\\phi(x)` 将 HJB 方程的终端条件从 $V(T,x)=0$ 改变为 $V(T,x)=\\phi(x)$。这是一个抛物线偏微分方程边界条件的改变，它会以一种复杂的方式改变整个解 $V(t,x)$，而不是通过简单的重新调整。\n结论：**不正确**。\n\n**E. 对于任何凹函数 $\\phi(\\cdot)$，增加遗产动机必然会使最优消费路径随时间严格递增。**\n\n最优消费路径的增长或下降由欧拉方程 $u''(c_t)\\dot{c}_t = (\\rho-r)u'(c_t)$ 决定。由于 $u' > 0$ 和 $u'' < 0$，消费变化率 $\\dot{c}_t$ 的符号由 $r-\\rho$ 的符号决定。\n*   如果 $r > \\rho$，代理人相对有耐心，储蓄回报高，因此延迟消费是最优的。因此，$\\dot{c}_t > 0$，消费路径是递增的。\n*   如果 $r < \\rho$，代理人相对没有耐心，储蓄回报低，因此提前消费是最优的。因此，$\\dot{c}_t < 0$，消费路径是递减的。\n*   如果 $r = \\rho$，消费路径是平坦的，$\\dot{c}_t = 0$。\n\n这种动态与遗产动机 $\\phi(\\cdot)$ 无关。遗产动机影响消费路径的*水平*（通过为财富设定终端目标），但不影响其斜率的符号。如果 $r < \\rho$，即使存在强烈的遗产动机，消费路径也将是递减的。代理人只会从一个较低的初始消费水平 $c_0$ 开始，以便能够实现遗产目标，但路径仍将呈下降趋势。\n结论：**不正确**。", "answer": "$$\\boxed{AC}$$", "id": "2416502"}]}