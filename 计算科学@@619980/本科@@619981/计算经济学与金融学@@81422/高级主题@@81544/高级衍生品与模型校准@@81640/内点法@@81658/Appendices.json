{"hands_on_practices": [{"introduction": "内点法的核心在于其迭代过程，每一步都通过求解一个线性化的 KKT 系统来逼近最优解。本练习将引导您完成一个核心计算：为一个以熵为目标的投资组合优化问题计算牛顿步。通过亲手计算梯度、Hessian 矩阵和牛顿减量，您将深入理解内点法在一次迭代中是如何确定搜索方向和评估进展的 [@problem_id:2402656]。", "problem": "考虑一个包含 $n=3$ 种资产的投资组合，其分配向量为 $w \\in \\mathbb{R}^3_{++}$，预期收益向量为 $r \\in \\mathbb{R}^3$。目标是最大化投资组合的香non熵 $-\\sum_{i=1}^3 w_i \\ln(w_i)$，同时满足预算约束和目标预期收益约束。这等价于求解最小化问题\n$\\min_{w \\in \\mathbb{R}^3_{++}} \\sum_{i=1}^3 w_i \\ln(w_i)$\n其线性等式约束条件为 $1^{\\top}w = 1$ 和 $r^{\\top}w = \\mu$，其中 $\\ln(\\cdot)$ 表示自然对数。考虑将带有障碍尺度参数 $t>0$ 的内点法 (IPM) 应用于 $t \\sum_{i=1}^3 w_i \\ln(w_i)$ 的等式约束最小化问题。\n\n在当前迭代点，给定以下信息：\n- $r = \\begin{pmatrix}0.02 \\\\ 0.01 \\\\ 0.03\\end{pmatrix}$，\n- $\\mu = 0.02$，\n- $w^{(0)} = \\begin{pmatrix}0.4 \\\\ 0.4 \\\\ 0.2\\end{pmatrix}$，\n- $t = 10$，\n- 约束的当前对偶乘子为 $\\nu^{(0)} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。\n\n基于约束优化的第一性原理，以及针对 $t$-尺度问题的等式约束牛顿步的定义（即，通过构造带有线性约束的拉格朗日函数，写出一阶最优性条件，并在给定迭代点进行线性化），计算在给定迭代点 $(w^{(0)}, \\nu^{(0)})$ 处的牛顿减量平方\n$\\lambda^2 = \\Delta w^{\\top} \\nabla^2\\!\\big(t \\sum_{i=1}^3 w_i \\ln(w_i)\\big)\\, \\Delta w$\n。其中 $\\Delta w$ 是在 $(w^{(0)}, \\nu^{(0)})$ 处针对 $t$-尺度问题的等式约束牛顿步方向。将你的答案四舍五入到四位有效数字。", "solution": "所述问题是在凸优化问题中应用内点法的一个标准练习，具体而言是投资组合理论中常见的线性约束下的熵最大化问题。该问题提法明确，有科学依据，并包含了所有必要信息，因此是有效的。\n\n我们的任务是为一个等式约束优化问题计算牛顿减量平方 $\\lambda^2$。目标函数为 $f_t(w) = t \\sum_{i=1}^3 w_i \\ln(w_i)$，其中 $t=10$。约束是线性的，可以写成矩阵形式 $Aw = b$。\n\n首先，我们将问题的各个组成部分形式化。\n目标函数为：\n$$ f_t(w) = 10 \\sum_{i=1}^3 w_i \\ln(w_i) $$\n约束条件为 $\\boldsymbol{1}^{\\top}w = 1$ 和 $r^{\\top}w = \\mu$。我们定义约束矩阵 $A$ 和向量 $b$ 如下：\n$$ A = \\begin{pmatrix} 1 & 1 & 1 \\\\ r_1 & r_2 & r_3 \\end{pmatrix} = \\begin{pmatrix} 1 & 1 & 1 \\\\ 0.02 & 0.01 & 0.03 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ \\mu \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0.02 \\end{pmatrix} $$\n在给定的原始-对偶点 $(w, \\nu)$ 处的牛顿步 $(\\Delta w, \\nu^{+})$ 可通过求解线性化的一阶最优性 (KKT) 条件得到。KKT 系统为：\n$$ \\begin{pmatrix} \\nabla^2 f_t(w) & A^\\top \\\\ A & 0 \\end{pmatrix} \\begin{pmatrix} \\Delta w \\\\ \\nu^{+} \\end{pmatrix} = \\begin{pmatrix} -\\nabla f_t(w) \\\\ b \\end{pmatrix} $$\n该系统适用于可行起始点。由于我们给定的点 $w^{(0)}$ 是不可行的（即 $A w^{(0)} \\neq b$），我们同时求解朝向可行性和最优性的步长：\n$$ \\begin{pmatrix} \\nabla^2 f_t(w^{(0)}) & A^\\top \\\\ A & 0 \\end{pmatrix} \\begin{pmatrix} \\Delta w \\\\ \\nu^{+} \\end{pmatrix} = \\begin{pmatrix} -\\nabla f_t(w^{(0)}) \\\\ b - A w^{(0)} \\end{pmatrix} $$\n此处，$\\nu^{+}$ 是对偶变量的下一个迭代值，我们直接计算它。问题陈述了 $\\nu^{(0)}=\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，但除非也要计算 $\\nu$ 的步长，否则在标准牛顿步公式中并不直接需要这个值。\n\n我们继续计算在迭代点 $w^{(0)} = \\begin{pmatrix} 0.4 \\\\ 0.4 \\\\ 0.2 \\end{pmatrix}$ 处所需的分量。\n\n$f_t(w)$ 的梯度为 $\\nabla f_t(w) = t (\\boldsymbol{1} + \\ln(w))$，其中 $\\ln(w)$ 是逐元素应用的。\n$$ g = \\nabla f_t(w^{(0)}) = 10 \\begin{pmatrix} 1 + \\ln(0.4) \\\\ 1 + \\ln(0.4) \\\\ 1 + \\ln(0.2) \\end{pmatrix} \\approx \\begin{pmatrix} 10 \\times (1 - 0.91629) \\\\ 10 \\times (1 - 0.91629) \\\\ 10 \\times (1 - 1.60944) \\end{pmatrix} = \\begin{pmatrix} 0.8371 \\\\ 0.8371 \\\\ -6.0944 \\end{pmatrix} $$\n$f_t(w)$ 的海森矩阵是一个对角矩阵 $\\nabla^2 f_t(w) = t \\cdot \\text{diag}(1/w_1, \\dots, 1/w_n)$。\n$$ H = \\nabla^2 f_t(w^{(0)}) = 10 \\cdot \\text{diag}\\left(\\frac{1}{0.4}, \\frac{1}{0.4}, \\frac{1}{0.2}\\right) = \\text{diag}(25, 25, 50) $$\n海森矩阵的逆为 $H^{-1} = \\text{diag}(1/25, 1/25, 1/50) = \\text{diag}(0.04, 0.04, 0.02)$。\n\n约束残差为：\n$$ r_{\\text{prim}} = b - A w^{(0)} = \\begin{pmatrix} 1 \\\\ 0.02 \\end{pmatrix} - \\begin{pmatrix} 1 & 1 & 1 \\\\ 0.02 & 0.01 & 0.03 \\end{pmatrix} \\begin{pmatrix} 0.4 \\\\ 0.4 \\\\ 0.2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0.02 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0.018 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0.002 \\end{pmatrix} $$\n从 KKT 系统中，我们首先可以求解 $\\nu^{+}$。\n$$ A \\Delta w = r_{\\text{prim}} $$\n$$ H \\Delta w + A^\\top \\nu^{+} = -g \\implies \\Delta w = -H^{-1}(g + A^\\top \\nu^{+}) $$\n将 $\\Delta w$ 代入第一个方程得到：\n$$ A(-H^{-1}(g + A^\\top \\nu^{+})) = r_{\\text{prim}} \\implies (A H^{-1} A^\\top) \\nu^{+} = -A H^{-1} g - r_{\\text{prim}} $$\n我们计算矩阵 $A H^{-1} A^\\top$：\n$$ A H^{-1} A^\\top = \\begin{pmatrix} 1 & 1 & 1 \\\\ 0.02 & 0.01 & 0.03 \\end{pmatrix} \\begin{pmatrix} 0.04 & 0 & 0 \\\\ 0 & 0.04 & 0 \\\\ 0 & 0 & 0.02 \\end{pmatrix} \\begin{pmatrix} 1 & 0.02 \\\\ 1 & 0.01 \\\\ 1 & 0.03 \\end{pmatrix} = \\begin{pmatrix} 0.1 & 0.0018 \\\\ 0.0018 & 0.000038 \\end{pmatrix} $$\n以及向量 $A H^{-1} g$：\n$$ A H^{-1} g = \\begin{pmatrix} 0.04 & 0.04 & 0.02 \\\\ 0.0008 & 0.0004 & 0.0006 \\end{pmatrix} \\begin{pmatrix} 0.8371 \\\\ 0.8371 \\\\ -6.0944 \\end{pmatrix} \\approx \\begin{pmatrix} -0.05492 \\\\ -0.002652 \\end{pmatrix} $$\n用于求解 $\\nu^{+}$ 的系统是：\n$$ \\begin{pmatrix} 0.1 & 0.0018 \\\\ 0.0018 & 0.000038 \\end{pmatrix} \\nu^{+} = -\\begin{pmatrix} -0.05492 \\\\ -0.002652 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0.002 \\end{pmatrix} = \\begin{pmatrix} 0.05492 \\\\ 0.000652 \\end{pmatrix} $$\n解这个 $2 \\times 2$ 方程组得到 $\\nu^{+} \\approx \\begin{pmatrix} 1.6304 \\\\ -60.066 \\end{pmatrix}$。\n\n现在，我们计算牛顿步 $\\Delta w$：\n$$ \\Delta w = -H^{-1}(g + A^\\top \\nu^{+}) $$\n$$ A^\\top \\nu^{+} \\approx \\begin{pmatrix} 1 & 0.02 \\\\ 1 & 0.01 \\\\ 1 & 0.03 \\end{pmatrix} \\begin{pmatrix} 1.6304 \\\\ -60.066 \\end{pmatrix} = \\begin{pmatrix} 1.6304 - 1.20132 \\\\ 1.6304 - 0.60066 \\\\ 1.6304 - 1.80198 \\end{pmatrix} = \\begin{pmatrix} 0.42908 \\\\ 1.02974 \\\\ -0.17158 \\end{pmatrix} $$\n$$ g + A^\\top \\nu^{+} \\approx \\begin{pmatrix} 0.8371 \\\\ 0.8371 \\\\ -6.0944 \\end{pmatrix} + \\begin{pmatrix} 0.42908 \\\\ 1.02974 \\\\ -0.17158 \\end{pmatrix} = \\begin{pmatrix} 1.26618 \\\\ 1.86684 \\\\ -6.26598 \\end{pmatrix} $$\n$$ \\Delta w = -\\begin{pmatrix} 0.04 \\\\ 0.04 \\\\ 0.02 \\end{pmatrix} \\odot \\begin{pmatrix} 1.26618 \\\\ 1.86684 \\\\ -6.26598 \\end{pmatrix} = \\begin{pmatrix} -0.0506472 \\\\ -0.0746736 \\\\ 0.1253196 \\end{pmatrix} $$\n最后，我们使用其定义计算牛顿减量平方 $\\lambda^2$：\n$$ \\lambda^2 = \\Delta w^{\\top} H \\Delta w $$\n$$ \\lambda^2 \\approx \\begin{pmatrix} -0.0506472 & -0.0746736 & 0.1253196 \\end{pmatrix} \\begin{pmatrix} 25 & 0 & 0 \\\\ 0 & 25 & 0 \\\\ 0 & 0 & 50 \\end{pmatrix} \\begin{pmatrix} -0.0506472 \\\\ -0.0746736 \\\\ 0.1253196 \\end{pmatrix} $$\n$$ \\lambda^2 \\approx 25(-0.0506472)^2 + 25(-0.0746736)^2 + 50(0.1253196)^2 $$\n$$ \\lambda^2 \\approx 25(0.00256514) + 25(0.00557615) + 50(0.0157050) $$\n$$ \\lambda^2 \\approx 0.0641285 + 0.13940375 + 0.78525 $$\n$$ \\lambda^2 \\approx 0.98878225 $$\n将结果四舍五入到四位有效数字，得到 $0.9888$。", "answer": "$$\\boxed{0.9888}$$", "id": "2402656"}, {"introduction": "在确定了牛顿搜索方向后，下一个关键问题是“我们应该沿该方向走多远？”。此练习精确地解决了这个问题，它突出了内点法（IPM）的“内点”本质：即必须始终保持在可行域的严格内部。通过计算最大允许步长 $\\alpha$，您将掌握如何确保下一次迭代不会违反任何非负性约束，这是确保算法稳定性的基础 [@problem_id:2402737]。", "problem": "考虑一个包含两种资产的凸投资组合选择问题，其约束条件包括非负性、预算和最小期望收益：\n对 $x \\in \\mathbb{R}^2$ 最小化目标函数 $ \\tfrac{1}{2} x^{\\top} Q x $，约束条件为 $ \\mathbf{1}^{\\top} x = 1 $，$ r^{\\top} x \\ge r_{\\min} $ 和 $ x \\ge 0 $，其中 $Q \\in \\mathbb{R}^{2 \\times 2}$ 是正定矩阵，$r \\in \\mathbb{R}^2$，$r_{\\min} \\in \\mathbb{R}$，并且 $x \\ge 0$ 是分量形式的不等式。考虑一种采用对数障碍表示不等式的原始-对偶内点法，其中收益约束通过松弛变量 $ y = r^{\\top} x - r_{\\min} > 0 $ 来强制执行，非负性约束通过 $ x > 0 $ 来强制执行，与这些不等式相关联的对偶变量满足 $ s > 0 $（与 $ x \\ge 0 $ 相关）和 $ z > 0 $（与 $ y \\ge 0 $ 相关）。在某次迭代中，该方法具有以下严格可行值：\n$ x = \\begin{bmatrix} 0.05 \\\\ 0.95 \\end{bmatrix},\\quad y = 0.04,\\quad s = \\begin{bmatrix} 5.0 \\\\ 0.2 \\end{bmatrix},\\quad z = 0.5, $\n以及计算出的原始-对偶Newton方向：\n$ \\Delta x = \\begin{bmatrix} -0.12 \\\\ 0.06 \\end{bmatrix},\\quad \\Delta y = -0.03,\\quad \\Delta s = \\begin{bmatrix} -1.0 \\\\ 0.5 \\end{bmatrix},\\quad \\Delta z = 0.2. $\n假设一个长步长路径跟踪策略提出了一个试验步长 $ \\alpha_{\\text{pred}} = 0.9 $。为了在下一次迭代中保持严格的内部可行性，所有更新后的量必须保持为正：\n$ x + \\alpha \\Delta x > 0,\\quad y + \\alpha \\Delta y > 0,\\quad s + \\alpha \\Delta s > 0,\\quad z + \\alpha \\Delta z > 0. $\n关于保持正性的最大允许步长 $ \\alpha $ 以及这对所提出的长步长 $ \\alpha_{\\text{pred}} $ 的影响，以下哪个陈述是正确的？\n\nA. 最大允许步长 $ \\alpha $ 等于 $ 1 $，因此 $ \\alpha_{\\text{pred}} = 0.9 $ 是可行的。\n\nB. 最大允许步长 $ \\alpha $ 约为 $ 0.42 $，因此 $ \\alpha_{\\text{pred}} = 0.9 $ 会违反可行性。\n\nC. 最大允许步长 $ \\alpha $ 约为 $ 0.67 $，因此 $ \\alpha_{\\text{pred}} = 0.9 $ 会违反可行性。\n\nD. 任何 $ \\alpha \\in (0,1] $ 都能保持正性，因为方向的所有分量都会增加相应的变量。", "solution": "首先对问题陈述进行验证。\n\n步骤1：提取已知条件\n该问题描述了用于解决一个凸投资组合选择问题的原始-对偶内点法。\n优化问题为：\n$$ \\text{minimize} \\quad \\frac{1}{2} x^{\\top} Q x $$\n$$ \\text{subject to} \\quad \\mathbf{1}^{\\top} x = 1, \\quad r^{\\top} x \\ge r_{\\min}, \\quad x \\ge 0 $$\n其中 $x \\in \\mathbb{R}^2$，$Q \\in \\mathbb{R}^{2 \\times 2}$ 是正定矩阵，$r \\in \\mathbb{R}^2$，$r_{\\min} \\in \\mathbb{R}$。\n不等式约束通过引入松弛变量的对数障碍法来处理。\n非负性约束 $x \\ge 0$ 被强制为 $x > 0$。\n最小收益约束 $r^{\\top} x \\ge r_{\\min}$ 通过松弛变量 $y$ 被强制为 $y = r^{\\top} x - r_{\\min} > 0$。\n与这些不等式相关联的对偶变量为 $s > 0$（对应于 $x > 0$）和 $z > 0$（对应于 $y > 0$）。\n\n在某次特定迭代中，严格可行值为：\n$$ x = \\begin{bmatrix} 0.05 \\\\ 0.95 \\end{bmatrix}, \\quad y = 0.04, \\quad s = \\begin{bmatrix} 5.0 \\\\ 0.2 \\end{bmatrix}, \\quad z = 0.5 $$\n计算出的原始-对偶Newton方向为：\n$$ \\Delta x = \\begin{bmatrix} -0.12 \\\\ 0.06 \\end{bmatrix}, \\quad \\Delta y = -0.03, \\quad \\Delta s = \\begin{bmatrix} -1.0 \\\\ 0.5 \\end{bmatrix}, \\quad \\Delta z = 0.2 $$\n提出的试验步长为：$\\alpha_{\\text{pred}} = 0.9$。\n对于步长 $\\alpha > 0$，保持严格内部可行性的条件是：\n$$ x + \\alpha \\Delta x > 0 $$\n$$ y + \\alpha \\Delta y > 0 $$\n$$ s + \\alpha \\Delta s > 0 $$\n$$ z + \\alpha \\Delta z > 0 $$\n问题是确定最大允许步长 $\\alpha$ 并评估 $\\alpha_{\\text{pred}}$ 的可行性。\n\n步骤2：使用提取的已知条件进行验证\n问题具有科学依据。它展示了内点法应用于二次规划的一个标准场景，二次规划是计算金融和优化理论的基石。\n问题是适定的。它要求计算最大步长，这是一个在给定迭代点和搜索方向下的明确定义的程序。所有必要的数据都已提供。\n问题是客观的。语言精确且数学化，没有歧义或主观陈述。\n问题设定是自洽且一致的。未检测到任何缺陷。\n\n步骤3：结论与行动\n问题是有效的。将推导解答。\n\n目标是找到最大步长 $\\alpha > 0$，使得所有变量在步进后仍保持严格为正。对于一个通用的变量-方向对 $(v, \\Delta v)$，条件是 $v + \\alpha \\Delta v > 0$。这个不等式必须对 $x$, $y$, $s$, 和 $z$ 的所有分量都成立。\n\n如果搜索方向的某个分量（例如 $\\Delta v_i$）是非负的（$\\Delta v_i \\ge 0$），并且对应的变量 $v_i$ 是严格为正的（$v_i > 0$），那么对于任何 $\\alpha > 0$，更新后的变量 $v_i + \\alpha \\Delta v_i$ 将保持为正。这样的分量对 $\\alpha$ 不施加上限。\n\n如果搜索方向的某个分量是负的（$\\Delta v_i < 0$），不等式 $v_i + \\alpha \\Delta v_i > 0$ 意味着 $v_i > -\\alpha \\Delta v_i$，可以整理为 $\\alpha < v_i / (-\\Delta v_i)$。这对 $\\alpha$ 施加了一个上限。\n\n我们记为 $\\alpha_{\\max}$ 的最大允许步长，是从具有负方向的分量计算出的所有这些上限中的最小值。\n\n让我们分析每个约束条件：\n\n1.  对 $x$ 的约束：$x + \\alpha \\Delta x > 0$。\n    分量为 $x_1 = 0.05$ 对应 $\\Delta x_1 = -0.12$，以及 $x_2 = 0.95$ 对应 $\\Delta x_2 = 0.06$。\n    对于第一个分量，因为 $\\Delta x_1 < 0$：\n    $$ 0.05 + \\alpha(-0.12) > 0 \\implies 0.05 > 0.12\\alpha \\implies \\alpha < \\frac{0.05}{0.12} = \\frac{5}{12} $$\n    数值上，$\\alpha < 0.4166...$。\n    对于第二个分量，因为 $\\Delta x_2 > 0$，条件 $0.95 + \\alpha(0.06) > 0$ 对所有 $\\alpha > 0$ 都满足。\n\n2.  对 $y$ 的约束：$y + \\alpha \\Delta y > 0$。\n    值为 $y = 0.04$，方向为 $\\Delta y = -0.03$。因为 $\\Delta y < 0$：\n    $$ 0.04 + \\alpha(-0.03) > 0 \\implies 0.04 > 0.03\\alpha \\implies \\alpha < \\frac{0.04}{0.03} = \\frac{4}{3} $$\n    数值上，$\\alpha < 1.333...$。\n\n3.  对 $s$ 的约束：$s + \\alpha \\Delta s > 0$。\n    分量为 $s_1 = 5.0$ 对应 $\\Delta s_1 = -1.0$，以及 $s_2 = 0.2$ 对应 $\\Delta s_2 = 0.5$。\n    对于第一个分量，因为 $\\Delta s_1 < 0$：\n    $$ 5.0 + \\alpha(-1.0) > 0 \\implies 5.0 > \\alpha \\implies \\alpha < 5.0 $$\n    对于第二个分量，因为 $\\Delta s_2 > 0$，条件 $0.2 + \\alpha(0.5) > 0$ 对所有 $\\alpha > 0$ 都满足。\n\n4.  对 $z$ 的约束：$z + \\alpha \\Delta z > 0$。\n    值为 $z = 0.5$，方向为 $\\Delta z = 0.2$。因为 $\\Delta z > 0$，条件 $0.5 + \\alpha(0.2) > 0$ 对所有 $\\alpha > 0$ 都满足。\n\n为确保所有正性约束都得到满足，$\\alpha$ 必须小于所有推导出的上限中的最小值：\n$$ \\alpha_{\\max} = \\min\\left(\\frac{5}{12}, \\frac{4}{3}, 5.0\\right) $$\n$$ \\alpha_{\\max} = \\min(0.4166..., 1.333..., 5.0) $$\n$$ \\alpha_{\\max} = \\frac{5}{12} \\approx 0.4167 $$\n保持严格正性的最大允许步长是任何 $\\alpha \\in (0, \\alpha_{\\max})$。$\\alpha_{\\max}$ 本身会导致一个变量（$x_1$）变为零，这违反了内点法所要求的*严格*正性。问题要求的是“最大允许步长”，这被解释为上确界 $\\alpha_{\\max}$。四舍五入到两位小数得到 $0.42$。\n\n所提出的步长是 $\\alpha_{\\text{pred}} = 0.9$。我们将其与计算出的最大值进行比较：\n$$ 0.9 > \\frac{5}{12} \\approx 0.4167 $$\n由于 $\\alpha_{\\text{pred}}$ 大于最大允许步长 $\\alpha_{\\max}$，采用这样的步长会违反下一次迭代的可行性。具体来说，$x$ 的第一个分量将变为负数：\n$$ x_1 + \\alpha_{\\text{pred}} \\Delta x_1 = 0.05 + (0.9)(-0.12) = 0.05 - 0.108 = -0.058 < 0 $$\n\n现在，我们评估给出的选项。\n\nA. 最大允许步长 $ \\alpha $ 等于 $ 1 $，因此 $ \\alpha_{\\text{pred}} = 0.9 $ 是可行的。\n这是不正确的。最大允许步长 $\\alpha$ 约为 $0.42$，而不是 $1$。因此，$\\alpha_{\\text{pred}} = 0.9$ 是不可行的。\n\nB. 最大允许步长 $ \\alpha $ 约为 $ 0.42 $，因此 $ \\alpha_{\\text{pred}} = 0.9 $ 会违反可行性。\n这是正确的。我们的计算表明 $\\alpha_{\\max} = 5/12 \\approx 0.4167$，约等于 $0.42$。并且由于 $0.9 > 0.42$，所提出的步长违反了正性条件。\n\nC. 最大允许步长 $ \\alpha $ 约为 $ 0.67 $，因此 $ \\alpha_{\\text{pred}} = 0.9 $ 会违反可行性。\n这是不正确的。最大允许步长 $\\alpha$ 的值约为 $0.42$，而不是 $0.67$。数字 $0.67$ 约等于 $2/3$，它没有出现在我们的计算中。\n\nD. 任何 $ \\alpha \\in (0,1] $ 都能保持正性，因为方向的所有分量都会增加相应的变量。\n这是不正确的。简单检查方向向量可以发现，有几个分量是负的（$\\Delta x_1 = -0.12$, $\\Delta y = -0.03$, $\\Delta s_1 = -1.0$），这意味着它们会减小相应的变量。这个陈述在事实上是错误的。\n\n因此，唯一正确的陈述是 B。", "answer": "$$\\boxed{B}$$", "id": "2402737"}, {"introduction": "并非所有优化问题都有可行解。当一个问题不可行时，一个优秀的算法应该能提供证明。本练习探讨了当内点法判定问题不可行时的强大功能：利用算法的最终对偶迭代值来构建法尔卡斯引理（Farkas's Lemma）的不可行性证书。这不仅验证了算法的结论，更将计算结果与优化理论中的基本对偶概念联系起来 [@problem_id:2402685]。", "problem": "考虑以线性规划形式表示的只做多投资组合可行性问题：求 $x \\in \\mathbb{R}^{3}$，使得 $x \\geq \\mathbf{0}$ 且 $A x = b$，其中\n$$\nA \\;=\\; \\begin{pmatrix}\n1 & 1 & 1 \\\\\n0.10 & 0.20 & 0.15\n\\end{pmatrix},\n\\qquad\nb \\;=\\; \\begin{pmatrix}\n1 \\\\\n0.22\n\\end{pmatrix}.\n$$\n第一行 $1 \\cdot x_{1} + 1 \\cdot x_{2} + 1 \\cdot x_{3} = 1$ 是预算约束，第二行 $0.10 x_{1} + 0.20 x_{2} + 0.15 x_{3} = 0.22$ 是目标期望收益要求。应用于此可行性问题的齐次自对偶嵌入的内点法终止，宣告问题不可行，并返回一个近似的最终对偶迭代值\n$$\n\\tilde{y} \\;=\\; \\begin{pmatrix} 0.1997 \\\\ -1.0030 \\end{pmatrix}.\n$$\n使用 $\\tilde{y}$ 中的符号信息来确定一个归一化，构造一个满足 $A^{\\top} y \\geq \\mathbf{0}$ 和 $b^{\\top} y < 0$ 的 Farkas 不可行性证书 $y \\in \\mathbb{R}^{2}$。该归一化为 $y_{2} = -1$，并且在满足这些不等式的条件下，选择尽可能小的 $y_{1}$。计算标量 $b^{\\top} y$。无需四舍五入；请提供精确值。", "solution": "该问题要求为给定的线性系统构造一个 Farkas 不可行性证书。可行性问题是找到一个向量 $x \\in \\mathbb{R}^{3}$，使得 $A x = b$ 且 $x \\geq \\mathbf{0}$。给定的矩阵为\n$$\nA \\;=\\; \\begin{pmatrix}\n1 & 1 & 1 \\\\\n0.10 & 0.20 & 0.15\n\\end{pmatrix},\n\\qquad\nb \\;=\\; \\begin{pmatrix}\n1 \\\\\n0.22\n\\end{pmatrix}.\n$$\n根据 Farkas 引理（一个择一定理），系统 $A x = b, x \\geq \\mathbf{0}$ 不可行，当且仅当存在一个向量 $y \\in \\mathbb{R}^{2}$ 满足以下两个条件：\n1. $A^{\\top} y \\geq \\mathbf{0}$\n2. $b^{\\top} y < 0$\n这样的向量 $y$ 被称为 Farkas 不可行性证书。题目要求我们找到这样一个证书。\n\n首先，我们写出矩阵 $A$ 的转置：\n$$\nA^{\\top} \\;=\\; \\begin{pmatrix}\n1 & 0.10 \\\\\n1 & 0.20 \\\\\n1 & 0.15\n\\end{pmatrix}\n$$\n设证书向量为 $y = \\begin{pmatrix} y_{1} \\\\ y_{2} \\end{pmatrix}$。条件 $A^{\\top} y \\geq \\mathbf{0}$ 展开为一个包含三个线性不等式的系统：\n$$\n\\begin{pmatrix}\n1 & 0.10 \\\\\n1 & 0.20 \\\\\n1 & 0.15\n\\end{pmatrix}\n\\begin{pmatrix} y_{1} \\\\ y_{2} \\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\ny_{1} + 0.10 y_{2} \\\\\ny_{1} + 0.20 y_{2} \\\\\ny_{1} + 0.15 y_{2}\n\\end{pmatrix}\n\\;\\geq\\;\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这得到：\n(i) $y_{1} + 0.10 y_{2} \\geq 0$\n(ii) $y_{1} + 0.20 y_{2} \\geq 0$\n(iii) $y_{1} + 0.15 y_{2} \\geq 0$\n\n第二个条件 $b^{\\top} y < 0$ 变为：\n$$\nb^{\\top} y \\;=\\; \\begin{pmatrix} 1 & 0.22 \\end{pmatrix} \\begin{pmatrix} y_{1} \\\\ y_{2} \\end{pmatrix} \\;=\\; y_{1} + 0.22 y_{2} < 0\n$$\n\n题目为证书指定了一个归一化条件，$y_{2} = -1$。这个归一化与所提供的近似对偶迭代值 $\\tilde{y}$ 的符号结构是一致的。将 $y_{2} = -1$ 代入我们的不等式系统：\n(i) $y_{1} + 0.10(-1) \\geq 0 \\implies y_{1} \\geq 0.10$\n(ii) $y_{1} + 0.20(-1) \\geq 0 \\implies y_{1} \\geq 0.20$\n(iii) $y_{1} + 0.15(-1) \\geq 0 \\implies y_{1} \\geq 0.15$\n(iv) $y_{1} + 0.22(-1) < 0 \\implies y_{1} < 0.22$\n\n为了同时满足不等式 (i)、(ii) 和 (iii)，$y_{1}$ 必须大于或等于这些下界中的最大值：\n$$\ny_{1} \\geq \\max(0.10, 0.20, 0.15) = 0.20\n$$\n将此与不等式 (iv) 结合，我们得到关于 $y_{1}$ 的完整条件：\n$$\n0.20 \\leq y_{1} < 0.22\n$$\n题目要求我们选择尽可能小的 $y_{1}$。$y_{1}$ 的有效值集合是区间 $[0.20, 0.22)$。该集合中的最小值是其下界，$y_{1} = 0.20$。\n\n根据这个选择，我们的 Farkas 证书是：\n$$\ny = \\begin{pmatrix} y_{1} \\\\ y_{2} \\end{pmatrix} = \\begin{pmatrix} 0.20 \\\\ -1 \\end{pmatrix}\n$$\n我们必须验证这个向量满足所有条件。\n$A^{\\top}y = \\begin{pmatrix} 0.20 + 0.10(-1) \\\\ 0.20 + 0.20(-1) \\\\ 0.20 + 0.15(-1) \\end{pmatrix} = \\begin{pmatrix} 0.10 \\\\ 0 \\\\ 0.05 \\end{pmatrix}$，其分量均大于或等于 $\\mathbf{0}$。\n$b^{\\top}y = 0.20 + 0.22(-1) = 0.20 - 0.22 = -0.02$，其结果严格小于 $0$。\n两个条件都满足。\n\n最后的任务是计算标量 $b^{\\top} y$。我们已经计算过这个值。\n$$\nb^{\\top} y = 0.20 - 0.22 = -0.02\n$$\n或者，使用分数计算：\n$y_{1} \\geq \\max(\\frac{1}{10}, \\frac{1}{5}, \\frac{3}{20}) = \\frac{1}{5}$。\n$y_{1} < \\frac{22}{100} = \\frac{11}{50}$。\n最小值为 $y_{1} = \\frac{1}{5}$。\n$b^{\\top} y = y_{1} + \\frac{11}{50}y_{2} = \\frac{1}{5} + \\frac{11}{50}(-1) = \\frac{10}{50} - \\frac{11}{50} = -\\frac{1}{50}$。\n值 $-0.02$ 和 $-\\frac{1}{50}$ 是相同的。", "answer": "$$\\boxed{-0.02}$$", "id": "2402685"}]}