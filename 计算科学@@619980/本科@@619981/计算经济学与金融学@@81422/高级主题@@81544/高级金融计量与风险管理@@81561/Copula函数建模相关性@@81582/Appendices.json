{"hands_on_practices": [{"introduction": "在数据分析中，我们习惯于使用皮尔逊相关系数（Pearson correlation coefficient）来衡量变量间的线性关系。然而，当依赖关系并非线性时，这个指标可能会产生误导，甚至完全失效。这个练习将通过一个经典案例，揭示线性相关的局限性，并阐明为何我们需要像copula这样更强大的工具来捕捉和描述变量之间复杂的非单调依赖结构 [@problem_id:1353856]。", "problem": "一个随机变量 $X$ 服从区间 $[-1, 1]$ 上的连续均匀分布。第二个随机变量 $Y$ 由关系式 $Y = X^2$ 定义。你的任务是分析 $X$ 和 $Y$ 之间的依赖关系。\n\n1. 计算皮尔逊相关系数 $\\rho(X, Y)$。\n2. 变量 $X$ 和 $Y$ 是完全相关的，但它们的皮尔逊相关系数可能无法完全捕捉这种关系。完整的依赖结构由它们的 copula 描述。确定下列哪种描述最好地刻画了连接 $X$ 和 $Y$ 的 copula。\n\nA. 该 copula 表示完全正单调依赖，其支撑集在单位正方形的主对角线上。\nB. 该 copula 表示完全负单调依赖，其支撑集在单位正方形的反对角线上。\nC. 该 copula 是独立 copula，其概率质量均匀分布在整个单位正方形上。\nD. 该 copula 表示非单调依赖，其支撑集集中在单位正方形内的一条V形曲线上。\n\n以数对形式提供你的答案，该数对由相关系数的数值和正确选项对应的字母组成。", "solution": "设 $X$ 在 $[-1,1]$ 上均匀分布，因此其密度函数为 $f_{X}(x)=\\frac{1}{2}$，其中 $x\\in[-1,1]$。定义 $Y=X^{2}$。皮尔逊相关系数为 $\\rho(X,Y)=\\frac{\\operatorname{Cov}(X,Y)}{\\sqrt{\\operatorname{Var}(X)\\operatorname{Var}(Y)}}$。\n\n首先计算必要的矩。由于 $X$ 关于 0 对称，\n$$\n\\mathbb{E}[X]=\\int_{-1}^{1}x\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{2}}{2}\\right]_{-1}^{1}=0.\n$$\n此外，\n$$\n\\mathbb{E}[X^{2}]=\\int_{-1}^{1}x^{2}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{3}}{3}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{3}-\\left(-\\frac{1}{3}\\right)\\right)=\\frac{1}{3},\n$$\n因此 $\\mathbb{E}[Y]=\\mathbb{E}[X^{2}]=\\frac{1}{3}$。接着，\n$$\n\\mathbb{E}[X^{3}]=\\int_{-1}^{1}x^{3}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{4}}{4}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{4}-\\frac{1}{4}\\right)=0,\n$$\n所以 $\\mathbb{E}[XY]=\\mathbb{E}[X^{3}]=0$。因此，\n$$\n\\operatorname{Cov}(X,Y)=\\mathbb{E}[XY]-\\mathbb{E}[X]\\mathbb{E}[Y]=0-0\\cdot\\frac{1}{3}=0.\n$$\n为完整起见，计算方差以确认分母为正。我们有\n$$\n\\operatorname{Var}(X)=\\mathbb{E}[X^{2}]-(\\mathbb{E}[X])^{2}=\\frac{1}{3},\n$$\n并且\n$$\n\\mathbb{E}[Y^{2}]=\\mathbb{E}[X^{4}]=\\int_{-1}^{1}x^{4}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{5}}{5}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{5}-\\left(-\\frac{1}{5}\\right)\\right)=\\frac{1}{5},\n$$\n所以\n$$\n\\operatorname{Var}(Y)=\\mathbb{E}[Y^{2}]-(\\mathbb{E}[Y])^{2}=\\frac{1}{5}-\\left(\\frac{1}{3}\\right)^{2}=\\frac{1}{5}-\\frac{1}{9}=\\frac{4}{45}>0.\n$$\n于是，\n$$\n\\rho(X,Y)=\\frac{0}{\\sqrt{\\frac{1}{3}\\cdot\\frac{4}{45}}}=0.\n$$\n\n尽管 $Y$ 是 $X$ 的一个确定性函数并且它们是完全相关的，但这种依赖关系在 $[-1,1]$ 上是非单调的，因此皮尔逊相关系数为零。为确定该 copula，我们考虑概率积分变换 $U=F_{X}(X)$ 和 $V=F_{Y}(Y)$。对于 $x\\in[-1,1]$，\n$$\nF_{X}(x)=\\frac{x+1}{2},\\quad\\text{所以}\\quad U=\\frac{X+1}{2}.\n$$\n对于 $y\\in[0,1]$，\n$$\nF_{Y}(y)=\\mathbb{P}(X^{2}\\le y)=\\mathbb{P}(-\\sqrt{y}\\le X\\le \\sqrt{y})=\\int_{-\\sqrt{y}}^{\\sqrt{y}}\\frac{1}{2}\\,dx=\\sqrt{y},\n$$\n因此\n$$\nV=F_{Y}(Y)=\\sqrt{Y}=\\sqrt{X^{2}}=|X|.\n$$\n通过 $U$ 表示 $X$ 得到 $X=2U-1$，所以这两个均匀分布变量之间的关系是\n$$\nV=|X|=|2U-1|.\n$$\n因此，该 copula 是奇异的，其支撑集集中在单位正方形内的 V 形曲线 $v=|2u-1|$ 上。这是一种非单调依赖，对应于选项 D。", "answer": "$$\\boxed{\\begin{pmatrix} 0  D \\end{pmatrix}}$$", "id": "1353856"}, {"introduction": "理解了copula在捕捉复杂依赖关系中的重要性之后，下一步是深入其数学构造。Copula密度函数 $c(u,v)$ 是其核心组成部分，它描述了联合分布的局部依赖强度，在参数估计和模型模拟中至关重要。本练习将以结构简单的Farlie-Gumbel-Morgenstern (FGM) copula为例，带你实践如何从copula累积分布函数 $C(u,v)$ 推导出其对应的密度函数 [@problem_id:1353902]。", "problem": "在统计建模中，copula（联结函数）是一种多元累积分布函数，其每个变量的边际概率分布在区间 $[0, 1]$ 上是均匀分布。用于建模两个随机变量之间相依性的最简单的 copula 族之一是 Farlie-Gumbel-Morgenstern (FGM) 族。\n\n二元 FGM copula 的累积分布函数由下式给出：\n$$C(u,v) = uv[1+\\alpha(1-u)(1-v)]$$\n其中 $u, v \\in [0, 1]$ 并且相依参数 $\\alpha$ 是满足 $|\\alpha| \\le 1$ 的实常数。\n\ncopula 密度函数记为 $c(u,v)$，它描述了一对特定值 $(u,v)$ 的相对似然性。求对应于 FGM copula 的 copula 密度函数 $c(u,v)$ 的解析表达式。", "solution": "copula 密度函数是 copula 分布函数的混合二阶偏导数：\n$$c(u,v)=\\frac{\\partial^{2}}{\\partial u \\partial v}C(u,v).$$\n给定 $C(u,v)=uv\\left[1+\\alpha(1-u)(1-v)\\right]$，首先使用乘法法则计算关于 $u$ 的偏导数：\n$$\\frac{\\partial C}{\\partial u}=v\\left[1+\\alpha(1-u)(1-v)\\right]+uv\\frac{\\partial}{\\partial u}\\left[1+\\alpha(1-u)(1-v)\\right].$$\n内部的导数为\n$$\\frac{\\partial}{\\partial u}\\left[1+\\alpha(1-u)(1-v)\\right]=\\alpha\\frac{\\partial}{\\partial u}\\left[(1-u)(1-v)\\right]=-\\alpha(1-v).$$\n因此，\n$$\\frac{\\partial C}{\\partial u}=v\\left[1+\\alpha(1-u)(1-v)\\right]-\\alpha uv(1-v).$$\n因式分解并化简：\n$$\\frac{\\partial C}{\\partial u}=v+\\alpha v(1-v)(1-2u).$$\n现在对 $v$ 求导：\n$$c(u,v)=\\frac{\\partial}{\\partial v}\\left[v+\\alpha v(1-v)(1-2u)\\right]=1+\\alpha(1-2u)\\frac{\\partial}{\\partial v}\\left[v-v^{2}\\right].$$\n因为 $\\frac{\\partial}{\\partial v}(v-v^{2})=1-2v$，我们得到\n$$c(u,v)=1+\\alpha(1-2u)(1-2v).$$", "answer": "$$\\boxed{1+\\alpha(1-2u)(1-2v)}$$", "id": "1353902"}, {"introduction": "掌握了copula的基本数学原理后，我们迎来了实际应用中的关键挑战：如何为特定的数据集选择最合适的copula模型。不同的copula簇捕捉不同类型的依赖结构，尤其是在分布的“尾部”。本练习将模拟一个常见于水文学或金融学的场景，要求你根据数据表现出的非对称依赖特征——即对极端高值或低值的不同敏感性——来辨别并选择正确的copula模型，从而深入理解尾部依赖（tail dependence）这一核心概念 [@problem_id:1353897]。", "problem": "一位水文学家正在分析两条邻近河流（A河和B河）日流量之间的相关性。他们收集了一个包含成对测量数据的大型数据集。作为copula建模的标准流程，他们将每条河流流量的经验边际分布转换为标准均匀随机变量，记为 $U_A$ 和 $U_B$。\n\n在检查转换后数据对 $(U_A, U_B)$ 的散点图时，该水文学家观察到其依赖结构中存在明显的不对称性。具体而言，数据点在单位正方形的右上角（即当 $U_A$ 和 $U_B$ 都接近1时）显示出显著的聚集现象，这表明同时发生的重大洪水事件是紧密相关的。相比之下，在左下角（即当 $U_A$ 和 $U_B$ 都接近0时）几乎没有聚集现象，这表明两条河流的极端低流量时期（干旱）的相关性不那么强。\n\n该水文学家决定使用单参数阿基米德copula来对这种依赖关系进行建模，并将选择范围缩小到两种常见的模型：Clayton copula和Gumbel copula。\n\n根据所描述的数据特征，以下哪个陈述正确地指出了更合适的copula模型及其适用的原因？\n\nA. Clayton copula，因为它专门用于模拟联合分布的上尾强相关性。\nB. Clayton copula，因为它专门用于模拟联合分布的下尾强相关性。\nC. Gumbel copula，因为它专门用于模拟联合分布的上尾强相关性。\nD. Gumbel copula，因为它专门用于模拟联合分布的下尾强相关性。\nE. Clayton copula或Gumbel copula都同样适用，因为在相同的总体相关水平下，它们的尾部相关特性是相同的。", "solution": "水文学家已将流量转换为标准均匀变量 $U_{A}$ 和 $U_{B}$，并观察到当两个变量都接近1时（右上角）存在强聚集，而当两个变量都接近0时（左下角）聚集非常弱。用copula的术语来说，这表明存在强的上尾相关性和弱的（近似为零的）下尾相关性。\n\n尾部相关性由以下系数来量化：\n$$\n\\lambda_{U}=\\lim_{u\\to 1^{-}} \\mathbb{P}\\left(U_{B}>u \\mid U_{A}>u\\right)=\\lim_{u\\to 1^{-}} \\frac{1-2u+C(u,u)}{1-u},\n$$\n$$\n\\lambda_{L}=\\lim_{u\\to 0^{+}} \\mathbb{P}\\left(U_{B}\\leq u \\mid U_{A}\\leq u\\right)=\\lim_{u\\to 0^{+}} \\frac{C(u,u)}{u},\n$$\n其中 $C$ 是copula。\n\n对于候选的单参数阿基米德copula：\n- Clayton copula (参数 $\\theta>0$) 具有下尾相关性，但没有上尾相关性：\n$$\n\\lambda_{L}=2^{-1/\\theta}>0,\\quad \\lambda_{U}=0.\n$$\n- Gumbel copula (参数 $\\theta\\geq 1$) 具有上尾相关性，但没有下尾相关性：\n$$\n\\lambda_{U}=2-2^{1/\\theta}>0 \\text{ for } \\theta>1,\\quad \\lambda_{L}=0.\n$$\n\n因为数据显示出强的上尾相关性和弱的下尾相关性，所以合适的选择是Gumbel copula，其定义特征与观察到的不对称性相匹配。因此，正确的陈述是Gumbel copula是合适的，因为它旨在模拟上尾的强相关性。", "answer": "$$\\boxed{C}$$", "id": "1353897"}]}