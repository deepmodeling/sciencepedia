{"hands_on_practices": [{"introduction": "我们的实践之旅始于一个最熟悉的场景：一个由线性供给和需求曲线构成的单一商品市场。这个练习 [@problem_id:2382188] 是理解瓦尔拉斯均衡的基石。通过计算均衡价格与数量，并分析价格下限（price floor）等政府干预措施带来的影响，我们可以直观地看到市场偏离其均衡点时的效率损失，即无谓损失（deadweight loss）。这个练习旨在将抽象的均衡概念与具体的政策分析联系起来，为你后续更复杂的模型学习打下坚实基础。", "problem": "考虑一个单一商品竞争市场，该市场嵌入到一个双商品经济体中，其中存在一种计价物商品，其价格被标准化为$1$。该市场商品具有反需求函数 $P_{d}(Q) = a - b\\,Q$（其中 $a > 0$ 且 $b > 0$）和反供给函数 $P_{s}(Q) = c + d\\,Q$（其中 $c \\ge 0$ 且 $d > 0$）。数量必须为非负值，即 $Q \\ge 0$。该市场中的一个瓦尔拉斯均衡（WE）是一个价格 $p^{\\ast}$ 和一个数量 $Q^{\\ast} \\ge 0$，使得市场出清：$P_{d}(Q^{\\ast}) = P_{s}(Q^{\\ast}) = p^{\\ast}$。如果需求和供给的唯一交点出现在负数量处，则有效瓦尔拉斯均衡是无交易配置 $Q^{\\ast} = 0$。\n\n现在，为该市场商品引入一个价格下限 $\\bar{p} \\ge 0$，以计价物商品的单位表示。价格下限下的实际交易数量由以下规则确定：如果该下限相对于有效瓦尔拉斯均衡价格不具约束力，则市场在有效瓦尔拉斯均衡 $(p^{\\ast},Q^{\\ast})$ 处进行交易；如果该下限具有约束力，则交易数量等于价格 $\\bar{p}$ 下的市场短边，即 $Q^{\\text{tr}} = \\min\\{Q_{d}(\\bar{p}), Q_{s}(\\bar{p})\\}$，其中 $Q_{d}(p) = \\max\\{0, (a - p)/b\\}$ 和 $Q_{s}(p) = \\max\\{0, (p - c)/d\\}$ 是由价格 $p$ 引致的非负需求量和供给量。将价格下限造成的无谓损失（DWL）定义为相对于有效瓦尔拉斯均衡的总剩余损失，即净边际收益 $P_{d}(Q) - P_{s}(Q)$ 在从价格下限下的交易数量到有效瓦尔拉斯均衡数量的区间上的积分：\n$$\n\\text{DWL} = \\int_{Q^{\\text{tr}}}^{Q^{\\ast}} \\big(P_{d}(Q) - P_{s}(Q)\\big)\\,dQ,\n$$\n按照惯例，如果 $Q^{\\text{tr}} \\ge Q^{\\ast}$，则无谓损失为 $0$。\n\n你的任务是编写一个程序，对下面列出的每个测试用例，计算上文定义的有效瓦尔拉斯均衡数量 $Q^{\\ast}$、价格下限下的交易数量 $Q^{\\text{tr}}$ 以及无谓损失 $\\text{DWL}$。所有计算都必须按规定假设数量为非负。无需报告物理单位。\n\n测试套件：\n- 测试用例 1： $(a,b,c,d,\\bar{p}) = (10,1,2,1,7)$。\n- 测试用例 2： $(a,b,c,d,\\bar{p}) = (10,1,2,1,5)$。\n- 测试用例 3： $(a,b,c,d,\\bar{p}) = (10,1,2,1,6)$。\n- 测试用例 4： $(a,b,c,d,\\bar{p}) = (12,1,0,1,15)$。\n- 测试用例 5： $(a,b,c,d,\\bar{p}) = (3,1,5,1,4)$。\n\n最终输出格式：\n你的程序应该生成一行输出，其中包含一个方括号内的逗号分隔列表形式的结果。对于上述给出的每个测试用例，按顺序输出三元组 $(Q^{\\ast},Q^{\\text{tr}},\\text{DWL})$。将所有测试用例的这些三元组连接成一个扁平列表。例如，输出应具有以下形式：\n$[Q^{\\ast}_{1},Q^{\\text{tr}}_{1},\\text{DWL}_{1},Q^{\\ast}_{2},Q^{\\text{tr}}_{2},\\text{DWL}_{2},\\dots]$。", "solution": "所述问题是有效的。这是一个在微观经济学理论中提法明确、有科学依据的练习，具体涉及市场均衡和价格管制的福利效应分析。问题的定义、参数和目标都以足够高的数学精确度进行了陈述，并且没有矛盾或逻辑缺陷。我们可以开始进行形式化求解。\n\n任务是为几组参数集计算有效瓦尔拉斯均衡数量（$Q^{\\ast}$）、价格下限下的交易数量（$Q^{\\text{tr}}$）以及由此产生的无谓损失（DWL）。推导过程分为三个阶段。\n\n**阶段 1：确定有效瓦尔拉斯均衡数量（$Q^{\\ast}$）**\n\n瓦尔拉斯均衡数量在市场出清点找到，即需求量等于供给量的点。这对应于反需求曲线和反供给曲线的交点，前提是数量为非负。\n反需求由 $P_{d}(Q) = a - b\\,Q$ 给出，反供给由 $P_{s}(Q) = c + d\\,Q$ 给出。我们令 $P_{d}(Q) = P_{s}(Q)$：\n$$ a - b\\,Q = c + d\\,Q $$\n解出 Q 可得到交点数量，我们将其记为 $Q_{\\text{int}}$：\n$$ a - c = (b + d)Q $$\n$$ Q_{\\text{int}} = \\frac{a - c}{b + d} $$\n问题规定数量必须为非负（$Q \\ge 0$）。如果 $a \\le c$，则当 $Q > 0$ 时，需求曲线完全位于供给曲线下方（或者如果 $c > a$，则从较低的价格截距开始；如果 $c = a$，则从相同的截距开始）。在这种情况下，$Q_{\\text{int}} \\le 0$，在有效市场中不会发生交易。问题陈述正确地将这种“无交易配置”识别为有效结果。因此，有效均衡数量 $Q^{\\ast}$ 是交点数量的非负部分：\n$$ Q^{\\ast} = \\max\\left\\{0, \\frac{a - c}{b + d}\\right\\} $$\n如果 $Q^{\\ast} > 0$，则相应的均衡价格 $p^{\\ast}$ 可以通过将 $Q^{\\ast}$ 代入反需求或反供给函数中求得：\n$$ p^{\\ast} = P_{d}(Q^{\\ast}) = a - b\\left(\\frac{a - c}{b + d}\\right) = \\frac{a(b+d) - b(a-c)}{b+d} = \\frac{ad + bc}{b + d} $$\n\n**阶段 2：确定价格下限下的交易数量（$Q^{\\text{tr}}$）**\n\n价格下限 $\\bar{p}$ 是监管者设定的最低价格。其效果取决于它是否“具有约束力”。\n\n情况 1：有效均衡中无交易（$Q^{\\ast} = 0$）。\n这种情况发生在 $a \\le c$ 时。此时不会发生自愿交易，因为任何消费者愿意支付的最高价格（$a$）都小于或等于任何供应商愿意接受的最低价格（$c$）。价格下限 $\\bar{p}$ 无法促成非互利的交易。在任何价格 $\\bar{p}$ 下，需求量或供给量（或两者）都将为零。因此，如果 $Q^{\\ast} = 0$，则交易数量 $Q^{\\text{tr}}$ 也必须为零。\n\n情况 2：有效均衡中存在正向交易（$Q^{\\ast} > 0$）。\n在这种情况下，存在一个均衡价格 $p^{\\ast} = (ad+bc)/(b+d)$。\n- 如果 $\\bar{p} \\le p^{\\ast}$，则价格下限不具约束力。它被设定在市场自然达到的价格或其下方。市场在有效均衡点进行交易，因此 $Q^{\\text{tr}} = Q^{\\ast}$。\n- 如果 $\\bar{p} > p^{\\ast}$，则价格下限具有约束力。市场价格被强制推高至 $\\bar{p}$。在这个更高的价格下，会出现供给过剩：供应商希望出售的数量 $Q_{s}(\\bar{p})$ 超过了消费者希望购买的数量 $Q_{d}(\\bar{p})$。交易由市场的“短边”决定，即需求方。交易的数量为：\n$$ Q^{\\text{tr}} = Q_{d}(\\bar{p}) = \\max\\left\\{0, \\frac{a - \\bar{p}}{b}\\right\\} $$\n由于 $\\bar{p} > p^{\\ast}$ 且 $p^{\\ast} = a - bQ^{\\ast}$，可推出 $\\bar{p} > a - bQ^{\\ast}$，这意味着 $bQ^{\\ast} > a - \\bar{p}$，因此 $Q^{\\ast} > (a-\\bar{p})/b$。所以，一个有约束力的价格下限总是导致交易数量 $Q^{\\text{tr}}$ 严格小于有效数量 $Q^{\\ast}$。\n\n**阶段 3：计算无谓损失（DWL）**\n\n无谓损失是由于市场在非有效数量水平上运行时造成的总剩余损失。它由以下积分定义：\n$$ \\text{DWL} = \\int_{Q^{\\text{tr}}}^{Q^{\\ast}} \\big(P_{d}(Q) - P_{s}(Q)\\big)\\,dQ $$\n被积函数是消费者的边际收益与生产者的边际成本之差：\n$$ P_{d}(Q) - P_{s}(Q) = (a - bQ) - (c + dQ) = (a - c) - (b + d)Q $$\n当 $Q^{\\ast} > 0$ 时，我们有 $a - c = (b+d)Q^{\\ast}$。将其代入被积函数可得：\n$$ P_{d}(Q) - P_{s}(Q) = (b+d)Q^{\\ast} - (b+d)Q = (b+d)(Q^{\\ast} - Q) $$\n现在我们可以计算该积分：\n$$ \\text{DWL} = \\int_{Q^{\\text{tr}}}^{Q^{\\ast}} (b+d)(Q^{\\ast} - Q)\\,dQ = (b+d)\\left[ Q^{\\ast}Q - \\frac{1}{2}Q^2 \\right]_{Q^{\\text{tr}}}^{Q^{\\ast}} $$\n$$ \\text{DWL} = (b+d)\\left( \\left( (Q^{\\ast})^2 - \\frac{1}{2}(Q^{\\ast})^2 \\right) - \\left( Q^{\\ast}Q^{\\text{tr}} - \\frac{1}{2}(Q^{\\text{tr}})^2 \\right) \\right) $$\n$$ \\text{DWL} = (b+d)\\left( \\frac{1}{2}(Q^{\\ast})^2 - Q^{\\ast}Q^{\\text{tr}} + \\frac{1}{2}(Q^{\\text{tr}})^2 \\right) = \\frac{1}{2}(b+d)(Q^{\\ast} - Q^{\\text{tr}})^2 $$\n这个公式代表了一个三角形的面积。三角形的高是数量的减少量 $Q^{\\ast} - Q^{\\text{tr}}$，底是在受限制数量下的价格差距 $P_{d}(Q^{\\text{tr}}) - P_{s}(Q^{\\text{tr}})$。该公式在 $Q^{\\ast} > 0$ 时成立。如果 $Q^{\\ast}=0$，那么 $Q^{\\text{tr}}=0$，DWL 也被正确计算为 $0$。如果价格下限不具约束力，$Q^{\\text{tr}}=Q^{\\ast}$，DWL 也被正确计算为 $0$。该公式自然满足了问题中“如果 $Q^{\\text{tr}} \\ge Q^{\\ast}$ 则 DWL 为 $0$”的惯例，因为我们的逻辑确保了 $Q^{\\text{tr}} \\le Q^{\\ast}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the efficient Walrasian equilibrium quantity (Q*),\n    the traded quantity under a price floor (Q_tr), and the\n    deadweight loss (DWL) for a series of market parameter sets.\n    \"\"\"\n    # Test cases are provided as tuples of (a, b, c, d, p_bar)\n    # P_d(Q) = a - b*Q\n    # P_s(Q) = c + d*Q\n    # p_bar is the price floor\n    test_cases = [\n        (10, 1, 2, 1, 7),\n        (10, 1, 2, 1, 5),\n        (10, 1, 2, 1, 6),\n        (12, 1, 0, 1, 15),\n        (3, 1, 5, 1, 4),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        a, b, c, d, p_bar = case\n\n        # Stage 1: Determination of the Efficient Walrasian Equilibrium Quantity (Q*)\n        # The efficient quantity Q* is the non-negative part of the intersection\n        # of the supply and demand curves.\n        q_star = np.maximum(0.0, (a - c) / (b + d))\n\n        # Stage 2: Determination of the Traded Quantity Under the Price Floor (Q_tr)\n        if q_star > 0:\n            # An efficient equilibrium with positive trade exists.\n            # Calculate the equilibrium price p* to check if the floor is binding.\n            p_star = (a * d + b * c) / (b + d)\n            \n            if p_bar = p_star:\n                # The price floor is not binding. The market trades at the efficient equilibrium.\n                q_tr = q_star\n            else:\n                # The price floor is binding. Trade is determined by the short side of\n                # the market, which is demand at price p_bar.\n                q_tr = np.maximum(0.0, (a - p_bar) / b)\n        else:\n            # The efficient equilibrium is no-trade (Q* = 0). A price floor\n            # cannot induce trade, so the traded quantity remains zero.\n            q_tr = 0.0\n\n        # Stage 3: Calculation of Deadweight Loss (DWL)\n        # DWL arises from the reduction in quantity traded below the efficient level.\n        # The formula is 0.5 * (b+d) * (Q* - Q_tr)^2.\n        # It is non-zero only if q_tr  q_star.\n        if q_tr  q_star:\n            dwl = 0.5 * (b + d) * (q_star - q_tr)**2\n        else:\n            dwl = 0.0\n\n        # Append the calculated triplet to the master list of results.\n        results.extend([q_star, q_tr, dwl])\n\n    # Final print statement in the exact required format.\n    # The list is flattened, and elements are converted to strings.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2382188"}, {"introduction": "在掌握了单一市场的分析后，我们将进入一个更完整、更贴近现实的经济系统——一般均衡模型。与上一个练习中直接使用总供给和总需求曲线不同，我们在这里将从最基本的要素——厂商的生产技术和消费者的偏好——开始，一步步构建出整个经济的均衡。这个练习 [@problem_id:2382212] 将引导你计算一个由分段线性生产可能性边界（PPF）构成的经济体的均衡价格与配置，这正是计算一般均衡（CGE）建模的核心任务。", "problem": "考虑一个 Arrow–Debreu 竞争经济模型，其中有一个消费者拥有一家企业。该企业可以使用一组有限的线性技术和单一的产能约束来生产两种消费品，从而形成一个分段线性的生产可能性边界 (PPF)。所有市场仅涉及这两种消费品；不存在要素市场。消费者的偏好为严格正的柯布-道格拉斯偏好。您需要计算一个瓦尔拉斯均衡 (WE)，它被定义为一个价格向量和一个配置，在该均衡下，企业在可行生产集内根据给定价格实现利润最大化，消费者在收入等于企业利润（全部分配给消费者）的预算集约束下实现效用最大化，并且两种商品的市场都出清。\n\n基本原理：\n- 消费者的需求是通过在预算约束下最大化柯布-道格拉斯效用得到的。\n- 企业的供给是通过在单个资源产能约束下，混合可用线性技术所产生的凸可行生产集上最大化利润得到的。\n- 瓦尔拉斯均衡 (WE) 是一组价格和配置，它同时满足个体最优性和市场出清条件。\n\n经济设定：\n- 有两种商品。企业拥有一组有限的可用技术，以 $k \\in \\{1,\\dots,K\\}$ 为索引。每种技术 $k$ 将一单位通用的、固定的、不可交易的产能转化为一个净产出向量 $a_k = (a_{k1}, a_{k2}) \\in \\mathbb{R}_{+}^2$。设总产能为 $\\bar{L} > 0$。企业选择非负的活动水平 $x_k \\ge 0$，满足 $\\sum_{k=1}^K x_k \\le \\bar{L}$，以生产 $y = \\sum_{k=1}^K x_k a_k$。\n- 单个消费者的效用函数为 $u(c_1,c_2) = c_1^{\\alpha} c_2^{1-\\alpha}$，其中 $\\alpha \\in (0,1)$，消费向量为 $c = (c_1,c_2)$。该消费者拥有企业 $100\\%$ 的股权，没有其他禀赋，因此其收入等于企业利润。\n\n价格：\n- 设价格向量为 $p = (p_1,p_2) \\in \\mathbb{R}_{++}^2$。不失一般性，将 $p_1 = 1$ 标准化，并记 $p_2 = q$，其中 $q > 0$。\n\n编程挑战：\n- 对于下面的每组参数，计算一个瓦尔拉斯均衡。您的程序必须确定一个价格比率 $q$ 和一个位于分段线性 PPF 上的生产计划 $y = (y_1,y_2)$，使得当消费者在收入等于该价格下的企业利润时进行优化，市场能够出清。您的计算必须基于上述基本原理。该经济体是单一消费者和单一企业的；因此，对于下方的测试实例，存在一个 WE，其中价格通过 $p_1 = 1$ 和 $p_2 = q$ 进行标准化。\n\n测试套件（三个独立案例）：\n- 案例 A：\n  - 技术：$a_1 = (2.0, 0.5)$，$a_2 = (1.0, 1.2)$，$a_3 = (0.3, 2.0)$。\n  - 产能：$\\bar{L} = 10$。\n  - 偏好权重：$\\alpha = 0.5$。\n- 案例 B：\n  - 技术：$a_1 = (1.2, 0.3)$，$a_2 = (0.9, 0.9)$。\n  - 产能：$\\bar{L} = 5$。\n  - 偏好权重：$\\alpha = 0.9$。\n- 案例 C：\n  - 技术：$a_1 = (1.0, 0.4)$，$a_2 = (0.2, 1.3)$。\n  - 产能：$\\bar{L} = 12$。\n  - 偏好权重：$\\alpha = 0.1$。\n\n计算要求与验收检查：\n- 利用企业在给定价格 $q$ 下，在产能约束下对可用技术的凸包进行利润最大化，以产生利润最大化的产出 $y$（允许技术混合）。\n- 利用消费者在价格为 $(1,q)$ 且收入等于企业利润时的柯布-道格拉斯需求，以获得消费 $c$。\n- 通过要求两个坐标上都满足 $c = y$ 来强制市场出清；如果在价格 $(1,q)$ 下，利润最大化集合包含多种最优技术，您必须选择一个能够使市场出清的凸组合（如果可行）。\n- 您的算法必须具有通用性，适用于任何满足上述结构的具有两种商品的有限技术集。\n\n最终输出：\n- 对于每个案例，输出三元组 $[q,y_1,y_2]$，其中 $q$ 是 $p_1 = 1$ 时的均衡价格比率，$(y_1,y_2)$ 是均衡生产/消费向量。所有三个数字必须是浮点值，并四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含结果，形式为这些三元组的逗号分隔列表，并用方括号括起来，按案例 A、案例 B、案例 C 的顺序排列。例如：$[[q_A,y_{A1},y_{A2}],[q_B,y_{B1},y_{B2}],[q_C,y_{C1},y_{C2}]]$。\n- 不涉及物理单位。\n\n您的程序必须是自包含的，不需要任何输入。它必须实现上述逻辑，并为给定的测试套件生成指定的单行输出。每个案例的答案必须是如上定义包含三个浮点数的列表。", "solution": "所提出的问题是在单一消费者、单一企业的 Arrow-Debreu 经济中计算瓦尔拉斯均衡的一个适定实例。它在科学上植根于成熟的微观经济理论，并提供了一套完整、一致的参数。因此，可以从基本原理推导出严谨的解。\n\n该经济体包含两种商品，索引为 $1$ 和 $2$。将商品 $1$ 的价格标准化为 $p_1=1$，则价格向量为 $p = (1, q)$，其中 $q = p_2 > 0$ 是商品 $2$ 的相对价格。\n\n分析的核心建立在三大支柱之上：企业行为、消费者行为和市场出清。\n\n**1. 企业利润最大化**\n\n企业拥有一组 $K$ 种线性生产技术。每种技术 $k$ 由一个向量 $a_k = (a_{k1}, a_{k2})$ 表示，该向量将一单位单一的、不可交易的资源（产能）转化为一篮子商品。在总产能为 $\\bar{L}$ 的情况下，企业选择每种技术的活动水平 $x_k \\ge 0$，并受产能约束 $\\sum_{k=1}^K x_k \\le \\bar{L}$ 的限制。由此产生的生产向量为 $y = (y_1, y_2) = \\sum_{k=1}^K x_k a_k$。所有可行生产向量的集合构成了生产可能性集（PPS），它是一个凸多胞体。其右上边界是生产可能性边界（PPF）。\n\n企业的目标是最大化利润，$\\pi = p \\cdot y = y_1 + q y_2$。代入 $y$ 的表达式：\n$$\n\\pi(q) = \\max_{\\{x_k\\}} \\sum_{k=1}^K x_k (a_{k1} + q a_{k2}) \\quad \\text{subject to} \\quad \\sum_{k=1}^K x_k \\le \\bar{L}, \\quad x_k \\ge 0.\n$$\n为了最大化这个线性目标，企业会将其全部产能 $\\bar{L}$ 分配给能产生最高单位产能收益 $r_k(q) = a_{k1} + q a_{k2}$ 的技术 $k^*$。\n- 如果存在唯一的技术 $k^*$ 使得 $r_k(q)$ 最大化，企业将进行专业化生产，在 PPF 的一个顶点上生产：$y^S(q) = \\bar{L} a_{k^*}$。\n- 如果两种技术，例如 $k_i$ 和 $k_j$，产生相同的最大收益，即 $a_{i1} + q a_{i2} = a_{j1} + q a_{j2}$，那么这两种技术的任何凸组合都是最优的。这对应于在连接点 $\\bar{L} a_i$ 和 $\\bar{L} a_j$ 的 PPF 的一个面（线段）上生产。发生这种情况的价格比率 $q$ 由技术本身决定：\n$$\nq = - \\frac{a_{j1} - a_{i1}}{a_{j2} - a_{i2}}\n$$\n这个 $q$ 值是连接 $\\bar{L} a_i$ 和 $\\bar{L} a_j$ 的 PPF 线段斜率的负倒数。\n\n**2. 消费者效用最大化**\n\n单个消费者具有柯布-道格拉斯偏好，由效用函数 $u(c_1, c_2) = c_1^{\\alpha} c_2^{1-\\alpha}$ 描述，其中 $\\alpha \\in (0,1)$。消费者拥有该企业，并且没有其他收入来源。因此，消费者的收入 $I$ 等于企业的利润 $\\pi$。预算约束为 $c_1 + q c_2 = \\pi$。\n\n在预算约束下最大化柯布-道格拉斯效用，可以得到著名的需求函数：\n$$\nc_1 = \\frac{\\alpha I}{p_1} = \\alpha \\pi\n$$\n$$\nc_2 = \\frac{(1-\\alpha) I}{p_2} = \\frac{(1-\\alpha) \\pi}{q}\n$$\n这些需求的一个关键特性是，两种商品的支出比率是恒定的：\n$$\n\\frac{p_2 c_2}{p_1 c_1} = \\frac{q c_2}{c_1} = \\frac{1-\\alpha}{\\alpha}\n$$\n这等同于边际替代率 (MRS) 等于价格比率：$\\text{MRS} = \\frac{\\partial u / \\partial c_1}{\\partial u / \\partial c_2} = \\frac{\\alpha}{1-\\alpha}\\frac{c_2}{c_1} = \\frac{p_1}{p_2} = \\frac{1}{q}$。\n\n**3. 市场出清与瓦尔拉斯均衡**\n\n在均衡状态下，市场必须出清，在这个单一消费者的经济中，这意味着消费等于生产：$c = y$。设均衡配置为 $y^* = (y_1^*, y_2^*)$。这个配置必须位于 PPF 上，并满足消费者的最优性条件。将 $y^*$ 代入消费者的最优性条件，提供了均衡配置和均衡价格比率 $q^*$ 之间的直接联系：\n$$\n\\frac{q^* y_2^*}{y_1^*} = \\frac{1-\\alpha}{\\alpha} \\quad \\implies \\quad q^* = \\frac{1-\\alpha}{\\alpha} \\frac{y_1^*}{y_2^*}\n$$\n均衡是同时满足企业利润最大化和此市场出清条件的一对 $(q^*, y^*)$。这意味着，在均衡配置 $y^*$ 处，消费者无差异曲线的斜率必须等于 PPF 的斜率，并且两者都必须等于价格比率的负值，即 $-1/q^*$。\n\n**算法方法**\n\n该算法通过系统地检查均衡配置在 PPF 上的两种可能性来确定均衡：位于顶点或位于线段上。\n\n**案例 1：均衡位于 PPF 的顶点**\n如果在一个价格比率 $q^*$（该比率由消费者在该点的最优性决定）下，企业发现专业化生产技术 $k$ 是最优的，那么均衡就出现在顶点 $y^* = \\bar{L} a_k$。\n1. 对于给定的技术 $k$，定义潜在的均衡点 $y^* = \\bar{L} a_k$。\n2. 计算能使消费者选择这一点的价格比率：$q^* = \\frac{1-\\alpha}{\\alpha} \\frac{y_1^*}{y_2^*}$。\n3. 验证在该价格 $q^*$ 下，技术 $k$ 是否确实是利润最高的。如果对于所有其他技术 $j=1,\\ldots,K$，都有 $r_k(q^*) \\ge r_j(q^*)$，则此条件成立，找到了一个均衡。\n\n**案例 2：均衡位于 PPF 的线段上**\n如果企业对技术 $i$ 和 $j$ 无差异，并且由此产生的消费点位于连接 $\\bar{L} a_i$ 和 $\\bar{L} a_j$ 的线段上，则均衡出现在该线段上。\n1. 对于一对技术 $(i, j)$，计算使企业无差异的唯一价格比率 $q^*$：$q^* = -(a_{j1}-a_{i1})/(a_{j2}-a_{i2})$。我们只考虑 $q^* > 0$ 的情况。\n2. 通过检查在该价格 $q^*$ 下没有其他技术 $k$ 的利润严格更高，来验证这对技术是否构成了 PPF 的一条边。\n3. 如果这对技术构成了一条边，则通过找到消费者的需求射线 $y_2 = \\left(\\frac{1-\\alpha}{\\alpha}\\frac{1}{q^*}\\right) y_1$ 与由 $\\bar{L}a_i$ 和 $\\bar{L}a_j$ 定义的线段的交点，来确定市场出清的配置 $(y_1^*, y_2^*)$。\n4. 如果这个交点落在线段的界限内，则找到了一个均衡。\n\n对于指定的经济结构，这种系统性搜索保证能找到唯一的均衡。该实现将遍历所有技术和技术对，以确定每个测试套件符合这两种情况中的哪一种。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_equilibrium(technologies: list[tuple[float, float]], L_bar: float, alpha: float) - list[float]:\n    \"\"\"\n    Computes the Walrasian equilibrium for a single-consumer, single-firm economy.\n\n    Args:\n        technologies: A list of (good1, good2) output tuples per unit of capacity.\n        L_bar: Total capacity.\n        alpha: The consumer's preference parameter for good 1 in the Cobb-Douglas utility.\n\n    Returns:\n        A list containing the equilibrium price ratio [q] and allocation [y1, y2].\n    \"\"\"\n    techs = np.array(technologies, dtype=np.float64)\n    num_techs = len(techs)\n    \n    # Consumer's expenditure ratio from utility maximization\n    if alpha == 0 or alpha == 1:\n        raise ValueError(\"alpha must be in (0,1)\")\n    expenditure_ratio = (1 - alpha) / alpha\n    \n    # Epsilon for robust floating-point comparisons\n    epsilon = 1e-9\n\n    # Case 1: Check for equilibrium at a vertex (specialization in one technology)\n    for i in range(num_techs):\n        y = L_bar * techs[i]\n        y1, y2 = y[0], y[1]\n\n        # Cobb-Douglas implies interior solution, so y1 and y2 must be positive.\n        if y1  epsilon or y2  epsilon:\n            continue\n\n        # Price ratio q implied by consumer choosing point y\n        q_consumer = expenditure_ratio * (y1 / y2)\n\n        # Check if firm would choose technology i at this price q\n        revenue_i = techs[i, 0] + q_consumer * techs[i, 1]\n        is_optimal_for_firm = True\n        for j in range(num_techs):\n            if i == j:\n                continue\n            revenue_j = techs[j, 0] + q_consumer * techs[j, 1]\n            if revenue_j > revenue_i + epsilon:\n                is_optimal_for_firm = False\n                break\n        \n        if is_optimal_for_firm:\n            return [q_consumer, y1, y2]\n\n    # Case 2: Check for equilibrium on a segment (diversification between two technologies)\n    for i in range(num_techs):\n        for j in range(i + 1, num_techs):\n            tech_i = techs[i]\n            tech_j = techs[j]\n\n            # Price ratio q implied by firm's indifference between tech i and j\n            # a_i1 + q*a_i2 = a_j1 + q*a_j2  = q*(a_i2 - a_j2) = a_j1 - a_i1\n            delta_a2 = tech_i[1] - tech_j[1]\n            if abs(delta_a2)  epsilon:\n                continue  # Technologies have same good 2 output, can't solve for q this way\n\n            delta_a1 = tech_j[0] - tech_i[0]\n            q_firm = delta_a1 / delta_a2\n\n            if q_firm  epsilon:\n                continue  # Price must be positive\n\n            # Check if this pair (i,j) constitutes an edge of the PPF at this price\n            revenue_ij = tech_i[0] + q_firm * tech_i[1]\n            is_ppf_edge = True\n            for k in range(num_techs):\n                if k == i or k == j:\n                    continue\n                revenue_k = techs[k, 0] + q_firm * techs[k, 1]\n                if revenue_k > revenue_ij + epsilon:\n                    is_ppf_edge = False\n                    break\n            \n            if not is_ppf_edge:\n                continue\n\n            # If it is an edge, find the market-clearing allocation on this segment\n            y_i = L_bar * tech_i\n            y_j = L_bar * tech_j\n            \n            # Slope of the PPF segment\n            if abs(y_j[0] - y_i[0])  epsilon:\n                continue # Vertical segment\n            m_seg = (y_j[1] - y_i[1]) / (y_j[0] - y_i[0])\n\n            # Slope of the consumer's demand ray\n            m_ray = expenditure_ratio / q_firm\n\n            if abs(m_ray - m_seg)  epsilon:\n                continue # Parallel lines, no unique intersection\n\n            # Find intersection of the two lines\n            # y = m_ray * x\n            # y - y_i[1] = m_seg * (x - y_i[0])\n            # m_ray*x - y_i[1] = m_seg*x - m_seg*y_i[0]\n            # (m_ray - m_seg)*x = y_i[1] - m_seg*y_i[0]\n            y1_eq = (y_i[1] - m_seg * y_i[0]) / (m_ray - m_seg)\n            y2_eq = m_ray * y1_eq\n\n            # Check if the intersection point lies on the segment\n            y1_min = min(y_i[0], y_j[0])\n            y1_max = max(y_i[0], y_j[0])\n            \n            if y1_min - epsilon = y1_eq = y1_max + epsilon:\n                return [q_firm, y1_eq, y2_eq]\n                \n    # This part should not be reached given the problem guarantees a solution exists.\n    return []\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        # Case A\n        {'id': 'A', 'techs': [(2.0, 0.5), (1.0, 1.2), (0.3, 2.0)], 'L_bar': 10.0, 'alpha': 0.5},\n        # Case B\n        {'id': 'B', 'techs': [(1.2, 0.3), (0.9, 0.9)], 'L_bar': 5.0, 'alpha': 0.9},\n        # Case C\n        {'id': 'C', 'techs': [(1.0, 0.4), (0.2, 1.3)], 'L_bar': 12.0, 'alpha': 0.1},\n    ]\n\n    results = []\n    for case in test_cases:\n        eq = compute_equilibrium(case['techs'], case['L_bar'], case['alpha'])\n        if eq:\n            results.append(eq)\n\n    # Format the final output string as per requirements\n    formatted_results = [f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2382212"}, {"introduction": "计算出均衡点仅仅是故事的开始，一个更深刻的问题是：即使均衡存在，市场真的能够自发地达到这个状态吗？本练习将我们引向均衡的动态性质。我们引入了瓦尔拉斯“试探”（tâtonnement）过程作为价格调整的模型。通过分析一个存在吉芬商品（Giffen good）的特殊经济体 [@problem_id:2382145]，你将发现一个惊人的现象：价格不仅不会收敛到均衡点，反而会不断远离它。这个练习揭示了理解均衡的稳定性与计算均衡本身同样重要。", "problem": "考虑一个拥有两种商品（记为 $1$ 和 $2$）的纯交换经济。将商品 $2$ 的价格标准化为 $p_2 = 1$，并将商品 $1$ 的价格记为 $p \\equiv p_1 > 0$。经济中有两位消费者 $A$ 和 $B$，每人的初始禀赋为 $(\\omega_{1i}, \\omega_{2i})$，并拥有 Stone–Geary 偏好\n$$\nu_i(x_{1i}, x_{2i}) \\;=\\; \\beta_i \\ln\\!\\big(x_{1i} - \\gamma_{1i}\\big) \\;+\\; (1-\\beta_i)\\ln\\!\\big(x_{2i} - \\gamma_{2i}\\big),\n$$\n其定义域为 $\\{(x_{1i}, x_{2i}) : x_{1i} > \\gamma_{1i},\\, x_{2i} > \\gamma_{2i}\\}$，其中 $0  \\beta_i  1$ 且 $\\gamma_{1i}, \\gamma_{2i} \\ge 0$。禀赋和参数如下：\n- 消费者 A：$(\\omega_{1A}, \\omega_{2A}) = (10, 1)$，$\\beta_A = \\tfrac{1}{2}$，$(\\gamma_{1A}, \\gamma_{2A}) = (6, 3)$。\n- 消费者 B：$(\\omega_{1B}, \\omega_{2B}) = (0, 20)$，$\\beta_B = \\tfrac{1}{20}$，$(\\gamma_{1B}, \\gamma_{2B}) = (3, 10)$。\n\n令 $m_i(p) = p \\,\\omega_{1i} + \\omega_{2i}$ 表示在价格为 $(p, 1)$ 时的收入。瓦尔拉斯均衡相对价格 $p^*$ 满足商品 $1$ 的市场出清条件，即商品 $1$ 的总超额需求 $z_1(p)$ 在 $p^*$ 处等于 $0$，且 $p^* > 0$。\n\n假设价格调整遵循（离散时间）马歇尔试探过程：\n$$\np_{t+1} \\;=\\; p_t \\;+\\; \\alpha\\, z_1(p_t), \\qquad \\alpha > 0.\n$$\n\n任务：\n- 计算瓦尔拉斯均衡相对价格 $p^*$。\n- 判断在价格 $p^*$ 下，商品 $1$ 对消费者 $A$ 是否为吉芬商品。\n- 根据试探映射在 $p^*$ 附近的局部行为，选择关于其稳定性的正确陈述。\n\n选项：\nA. 对于任意 $\\alpha > 0$，试探过程单调收敛于 $p^*$。\nB. 对于某个足够小的 $\\alpha > 0$，试探过程以阻尼振荡的方式收敛于 $p^*$。\nC. 对于任意 $\\alpha > 0$，试探过程单调地偏离 $p^*$ 发散。\nD. 对于任意 $\\alpha > 0$，试探过程通过爆炸性循环（双周期类型的振荡）发散。", "solution": "用户要求对问题陈述进行严格验证，然后完整推导解答过程并评估给定选项。\n\n### 步骤 1：提取已知条件\n- **经济体：** 纯交换经济，包含 2 种商品和 2 位消费者 ($i \\in \\{A, B\\}$)。\n- **价格：** $p_1 = p > 0$ 且 $p_2 = 1$。\n- **偏好：** Stone–Geary 效用函数 $u_i(x_{1i}, x_{2i}) = \\beta_i \\ln(x_{1i} - \\gamma_{1i}) + (1-\\beta_i)\\ln(x_{2i} - \\gamma_{2i})$，定义于 $x_{1i} > \\gamma_{1i}$ 且 $x_{2i} > \\gamma_{2i}$。参数 $0  \\beta_i  1$ 且 $\\gamma_{1i}, \\gamma_{2i} \\ge 0$。\n- **消费者 A：** 禀赋 $(\\omega_{1A}, \\omega_{2A}) = (10, 1)$，参数 $\\beta_A = \\frac{1}{2}$，$(\\gamma_{1A}, \\gamma_{2A}) = (6, 3)$。\n- **消费者 B：** 禀赋 $(\\omega_{1B}, \\omega_{2B}) = (0, 20)$，参数 $\\beta_B = \\frac{1}{20}$，$(\\gamma_{1B}, \\gamma_{2B}) = (3, 10)$。\n- **收入：** $m_i(p) = p \\omega_{1i} + \\omega_{2i}$。\n- **均衡：** 瓦尔拉斯均衡价格 $p^*$ 满足 $z_1(p^*) = 0$，其中 $z_1(p)$ 是商品 1 的总超额需求。\n- **动态过程：** 马歇尔试探过程 $p_{t+1} = p_t + \\alpha z_1(p_t)$，其中调整速度 $\\alpha > 0$ 为常数。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是标准的一般均衡理论问题。Stone-Geary 效用函数是一种性质良好、拟凹的函数，它会导出线性支出系统。瓦尔拉斯均衡和马歇尔试探过程是微观经济学中的基本概念。\n\n为了使效用函数有良好定义，并确保消费量超过生存水平的内点解存在，每位消费者的收入必须足以购买其生存必需品组合。这就是超额收入（supernumerary income）条件。\n- 对于消费者 A，其收入为 $m_A(p) = p \\omega_{1A} + \\omega_{2A} = 10p + 1$。生存必需品组合 $(\\gamma_{1A}, \\gamma_{2A}) = (6, 3)$ 的成本为 $p \\gamma_{1A} + \\gamma_{2A} = 6p + 3$。条件是 $m_A(p) > 6p + 3$，简化为 $10p + 1 > 6p + 3 \\implies 4p > 2 \\implies p > \\frac{1}{2}$。\n- 对于消费者 B，其收入为 $m_B(p) = p \\omega_{1B} + \\omega_{2B} = 20$。生存必需品组合 $(\\gamma_{1B}, \\gamma_{2B}) = (3, 10)$ 的成本为 $p \\gamma_{1B} + \\gamma_{2B} = 3p + 10$。条件是 $m_B(p) > 3p + 10$，简化为 $20 > 3p + 10 \\implies 10 > 3p \\implies p  \\frac{10}{3}$。\n\n因此，一个具有经济意义的均衡价格 $p^*$ 必须位于区间 $(\\frac{1}{2}, \\frac{10}{3})$ 内。该问题是自洽的，在经济理论上有科学依据，并且看起来是适定问题。\n\n### 步骤 3：结论与行动\n问题有效。我们开始求解。\n\n### 求解推导\n\n**1. 马歇尔需求函数**\n\n拥有 Stone-Geary 偏好的消费者最大化其效用时，会先分配收入购买生存必需品组合 $(\\gamma_{1i}, \\gamma_{2i})$，然后将剩余的“超额收入”在两种商品之间进行分配，如同他们拥有柯布-道格拉斯偏好一样。\n消费者 i 的超额收入为 $m_i^s(p) = m_i(p) - (p\\gamma_{1i} + \\gamma_{2i})$。\n商品 1 的需求由下式给出：\n$$x_{1i}(p, m_i) = \\gamma_{1i} + \\frac{\\beta_i}{p} [m_i(p) - (p\\gamma_{1i} + \\gamma_{2i})]$$\n代入 $m_i(p) = p\\omega_{1i} + \\omega_{2i}$ 可重写为：\n$$x_{1i}(p) = \\gamma_{1i} + \\beta_i(\\omega_{1i} - \\gamma_{1i}) + \\frac{\\beta_i}{p}(\\omega_{2i} - \\gamma_{2i})$$\n\n- **对于消费者 A：**\n$m_A(p) = 10p+1$，$\\beta_A = \\frac{1}{2}$，$\\gamma_{1A} = 6$，$\\gamma_{2A} = 3$。\n$$x_{1A}(p) = 6 + \\frac{1}{2}(10 - 6) + \\frac{1/2}{p}(1 - 3) = 6 + 2 - \\frac{1}{p} = 8 - \\frac{1}{p}$$\n该需求函数在 $p > \\frac{1}{2}$ 时有效。\n\n- **对于消费者 B：**\n$m_B(p) = 20$，$\\beta_B = \\frac{1}{20}$，$\\gamma_{1B} = 3$，$\\gamma_{2B} = 10$。\n$$x_{1B}(p) = 3 + \\frac{1}{20}(0 - 3) + \\frac{1/20}{p}(20 - 10) = 3 - \\frac{3}{20} + \\frac{10}{20p} = \\frac{57}{20} + \\frac{1}{2p}$$\n该需求函数在 $p  \\frac{10}{3}$ 时有效。\n\n**2. 瓦尔拉斯均衡价格 $p^*$。**\n\n均衡价格 $p^*$ 使商品 1 的市场出清。商品 1 的总禀赋为 $\\Omega_1 = \\omega_{1A} + \\omega_{1B} = 10 + 0 = 10$。\n商品 1 的总需求为 $X_1(p) = x_{1A}(p) + x_{1B}(p)$。\n$$X_1(p) = \\left(8 - \\frac{1}{p}\\right) + \\left(\\frac{57}{20} + \\frac{1}{2p}\\right) = 8 + \\frac{57}{20} - \\frac{1}{2p} = \\frac{160+57}{20} - \\frac{1}{2p} = \\frac{217}{20} - \\frac{1}{2p}$$\n令总需求等于总供给：$X_1(p^*) = \\Omega_1$。\n$$\\frac{217}{20} - \\frac{1}{2p^*} = 10$$\n$$\\frac{217}{20} - \\frac{200}{20} = \\frac{1}{2p^*}$$\n$$\\frac{17}{20} = \\frac{1}{2p^*}$$\n$$34p^* = 20 \\implies p^* = \\frac{20}{34} = \\frac{10}{17}$$\n我们检查此价格是否在有效区间 $(\\frac{1}{2}, \\frac{10}{3})$ 内。$\\frac{1}{2} = \\frac{8.5}{17}$ 且 $\\frac{10}{3} \\approx 3.33$。由于 $\\frac{1}{2}  \\frac{10}{17}  \\frac{10}{3}$，均衡价格 $p^* = \\frac{10}{17}$ 是有效的。\n\n**3. 消费者 A 的吉芬商品分析**\n\n如果一种商品的需求随着其自身价格的上涨而增加，那么它就是吉芬商品。我们必须检查全导数 $\\frac{dx_{1A}}{dp}$ 的符号。\n根据我们的推导，$x_{1A}(p) = 8 - \\frac{1}{p}$。\n$$\\frac{dx_{1A}}{dp} = \\frac{d}{dp}\\left(8 - p^{-1}\\right) = -(-1)p^{-2} = \\frac{1}{p^2}$$\n由于 $p>0$，显然对于所有有效价格，$\\frac{dx_{1A}}{dp} > 0$。因此，商品 1 对消费者 A 来说是吉芬商品。出现这种情况的原因是，消费者 A 是商品 1 的净卖方（禀赋 $\\omega_{1A}=10$，均衡时的需求 $x_{1A}(p^*) = 8 - \\frac{17}{10} = 6.3  10$），所售商品价格上涨带来的正收入效应超过了负替代效应。\n\n**4. 试探过程的稳定性**\n\n试探过程由映射 $p_{t+1} = F(p_t)$ 定义，其中 $F(p) = p + \\alpha z_1(p)$。均衡点 $p^*$ 的局部稳定性由导数 $F'(p^*)$ 决定。如果 $|F'(p^*)|  1$，则均衡是局部稳定的。\n$$F'(p) = \\frac{d}{dp}[p + \\alpha z_1(p)] = 1 + \\alpha z_1'(p)$$\n商品 1 的总超额需求为 $z_1(p) = X_1(p) - \\Omega_1$。\n$$z_1(p) = \\left(\\frac{217}{20} - \\frac{1}{2p}\\right) - 10 = \\frac{17}{20} - \\frac{1}{2p}$$\n我们计算超额需求函数的导数：\n$$z_1'(p) = \\frac{d}{dp}\\left(\\frac{17}{20} - \\frac{1}{2}p^{-1}\\right) = -\\frac{1}{2}(-1)p^{-2} = \\frac{1}{2p^2}$$\n商品 1 的总超额需求是其自身价格的增函数，$z_1'(p) > 0$。这是瓦尔拉斯试探过程中典型的不稳定根源。\n在均衡价格 $p^* = \\frac{10}{17}$ 处：\n$$z_1'(p^*) = \\frac{1}{2(10/17)^2} = \\frac{1}{2(100/289)} = \\frac{289}{200}$$\n现在，我们计算乘数 $F'(p^*)$：\n$$F'(p^*) = 1 + \\alpha z_1'(p^*) = 1 + \\alpha \\frac{289}{200}$$\n由于题目说明 $\\alpha > 0$，我们有 $F'(p^*) > 1$。\n\n局部稳定的条件是 $|F'(p^*)|  1$。在这里，对于任意 $\\alpha > 0$，都有 $F'(p^*) > 1$。这意味着均衡不动点 $p^*$ 是不稳定的。\n为了描述这种不稳定性，我们考虑 $p^*$ 附近的线性化动态。令 $p_t = p^* + \\epsilon_t$。则 $\\epsilon_{t+1} \\approx F'(p^*) \\epsilon_t$。\n由于乘数 $F'(p^*) = 1 + \\alpha \\frac{289}{200}$ 是一个大于 1 的实数，任何扰动 $\\epsilon_t$ 都将在下一期被放大，并且其符号将保持不变。\n- 如果 $p_0 > p^*$，则 $\\epsilon_0 > 0$，导致 $\\epsilon_1 > \\epsilon_0$，$\\epsilon_2 > \\epsilon_1$，依此类推。价格将沿正方向单调地偏离 $p^*$。\n- 如果 $p_0  p^*$，则 $\\epsilon_0  0$，导致 $\\epsilon_1  \\epsilon_0$，$\\epsilon_2  \\epsilon_1$，依此类推。价格将沿负方向单调地偏离 $p^*$。\n这种行为被称为单调发散。\n\n### 逐项分析选项\n\n**A. 对于任意 $\\alpha > 0$，试探过程单调收敛于 $p^*$。**\n这要求 $0  F'(p^*)  1$。我们的计算表明 $F'(p^*) > 1$。\n结论：**错误**。\n\n**B. 对于某个足够小的 $\\alpha > 0$，试探过程以阻尼振荡的方式收敛于 $p^*$。**\n这要求 $-1  F'(p^*)  0$。我们的计算表明 $F'(p^*) > 1$。\n结论：**错误**。\n\n**C. 对于任意 $\\alpha > 0$，试探过程单调地偏离 $p^*$ 发散。**\n这要求 $F'(p^*) > 1$。我们的计算表明，对于所有 $\\alpha>0$，都有 $F'(p^*) = 1 + \\alpha \\frac{289}{200} > 1$。这对应于单调发散。\n结论：**正确**。\n\n**D. 对于任意 $\\alpha > 0$，试探过程通过爆炸性循环（双周期类型的振荡）发散。**\n这要求 $F'(p^*)  -1$。我们的计算表明 $F'(p^*) > 1$。\n结论：**错误**。", "answer": "$$\\boxed{C}$$", "id": "2382145"}]}