{"hands_on_practices": [{"introduction": "我们通常直觉地认为无偏估计量是最好的，但事实并非总是如此。这个基础练习旨在挑战这一观念，它通过一个简单的伯努利试验场景，引导我们计算并比较一个无偏估计量和一个有偏估计量的均方误差（MSE）。通过这个练习 [@problem_id:1934147]，你将亲手验证，在特定情况下，引入一点偏差可以大幅降低方差，从而获得更低的总误差，这是理解偏差-方差权衡的第一步。", "problem": "在统计估计理论中，我们经常根据不同估计量对参数的性能表现来进行比较。考虑一个服从参数为 $p$ 的伯努利分布的随机变量 $X$，记作 $X \\sim \\text{Bernoulli}(p)$，其中 $p$ 是成功（$X=1$）的概率，$1-p$ 是失败（$X=0$）的概率。\n\n假设我们仅有 $X$ 的一次观测值来估计未知参数 $p$。现有两种不同的估计量被提出：\n\n1.  第一个估计量 $\\hat{p}_1$ 就是观测结果：$\\hat{p}_1 = X$。\n2.  第二个估计量 $\\hat{p}_2$ 是一个固定的常数值：$\\hat{p}_2 = 0.8$。\n\n一个参数 $\\theta$ 的估计量 $\\hat{\\theta}$ 的优劣通常用其均方误差（MSE）来衡量，其定义为 $\\text{MSE}(\\hat{\\theta}) = E[(\\hat{\\theta} - \\theta)^2]$，其中 $E[\\cdot]$ 表示期望。\n\n假设参数的真实值为 $p=0.9$，这两个估计量中哪一个的均方误差更低？\n\nA. $\\hat{p}_1$ 的均方误差更低。\n\nB. $\\hat{p}_2$ 的均方误差更低。\n\nC. 均方误差相等。\n\nD. 根据给定信息无法比较。", "solution": "我们给定了一个观测值 $X \\sim \\text{Bernoulli}(p)$ 和两个估计量：$\\hat{p}_{1}=X$ 和 $\\hat{p}_{2}=0.8$。均方误差定义为 $\\text{MSE}(\\hat{\\theta})=E[(\\hat{\\theta}-\\theta)^{2}]$。我们先用 $p$ 的符号形式计算均方误差，然后代入 $p=0.9$ 求值。\n\n对于 $\\hat{p}_{1}=X$，使用偏差-方差分解，\n$$\n\\text{MSE}(\\hat{p}_{1})= \\operatorname{Var}(X) + \\left(E[X]-p\\right)^{2}.\n$$\n对于 $X \\sim \\text{Bernoulli}(p)$，$E[X]=p$ 且 $\\operatorname{Var}(X)=p(1-p)$。因此，\n$$\n\\text{MSE}(\\hat{p}_{1})=p(1-p).\n$$\n或者，直接计算：\n$$\n\\text{MSE}(\\hat{p}_{1})=E[(X-p)^{2}]=E[X^{2}] - 2pE[X] + p^{2} = E[X] - 2p^{2} + p^{2} = p - p^{2} = p(1-p).\n$$\n\n对于 $\\hat{p}_{2}=0.8$，因为它是一个常数，\n$$\n\\text{MSE}(\\hat{p}_{2})=E[(0.8-p)^{2}]=(0.8-p)^{2}.\n$$\n\n现在代入真实值 $p=0.9$ 进行计算：\n$$\n\\text{MSE}(\\hat{p}_{1})=0.9(1-0.9)=0.09,\\qquad \\text{MSE}(\\hat{p}_{2})=(0.8-0.9)^{2}=0.01.\n$$\n因为 $0.01  0.09$，所以第二个估计量的均方误差更低。因此，正确选项是 B。", "answer": "$$\\boxed{B}$$", "id": "1934147"}, {"introduction": "在理解了单个估计量的偏差与方差之后，我们进一步探讨如何将多个模型组合起来以提升性能，这便是集成学习的核心思想。此练习 [@problem_id:3180603] 将带你深入到一个具体的集成场景，你需要基于基学习器的偏差和它们之间的协方差，来精确计算集成模型的总误差。这个计算过程将清晰地揭示，集成方法降低预测误差的关键不仅在于基模型的性能，更在于它们预测误差的多样性（即较低的相关性）。", "problem": "考虑一个带有标量响应的监督学习场景，其中在固定输入 $x$ 处的数据生成过程为 $y = f(x) + \\varepsilon$。这里，$\\varepsilon$ 是一个零均值随机噪声项，独立于训练数据和学习到的预测器，其方差为 $\\operatorname{Var}(\\varepsilon) = \\sigma^{2}$。三个基学习器产生预测 $\\hat{f}_{1}(x)$、$\\hat{f}_{2}(x)$ 和 $\\hat{f}_{3}(x)$。将学习器 $i$ 在 $x$ 处的预测误差定义为 $e_{i}(x) = \\hat{f}_{i}(x) - f(x)$，其在 $x$ 处的偏差定义为 $b_{i}(x) = \\mathbb{E}[\\hat{f}_{i}(x)] - f(x) = \\mathbb{E}[e_{i}(x)]$。一个堆叠集成使用和为一的非负权重，具体为 $w = (w_{1}, w_{2}, w_{3}) = (0.5, 0.3, 0.2)$，从而产生集成预测器 $\\hat{f}_{w}(x) = \\sum_{i=1}^{3} w_{i}\\,\\hat{f}_{i}(x)$。\n\n在所考虑的点 $x$ 处，假设基学习器的偏差向量为\n$$\nb(x) = \\begin{pmatrix} 0.20 \\\\ -0.10 \\\\ 0.05 \\end{pmatrix},\n$$\n以及基学习器误差的协方差矩阵为\n$$\n\\Sigma(x) = \\begin{pmatrix}\n0.25  0.10  0.05 \\\\\n0.10  0.36  0.12 \\\\\n0.05  0.12  0.49\n\\end{pmatrix}.\n$$\n假设不可约噪声方差为 $\\sigma^{2} = 0.04$。\n\n从偏差的基本定义 $\\mathbb{E}[\\hat{f}(x)] - f(x)$、方差的基本定义 $\\operatorname{Var}(\\hat{f}(x))$ 以及期望平方预测误差的基本定义 $\\mathbb{E}\\big[(\\hat{f}(x) - y)^{2}\\big]$ 出发，首先推导出堆叠集成在 $x$ 处的偏差和方差关于 $w$、$b(x)$ 和 $\\Sigma(x)$ 的符号表达式。然后，使用所提供的数值，计算该集成在 $x$ 处的期望平方预测误差。\n\n将你的最终答案表示为一个实数。将答案四舍五入到四位有效数字。不需要单位。", "solution": "问题要求计算一个堆叠集成预测器在特定点 $x$ 处的期望平方预测误差。数据生成过程由 $y = f(x) + \\varepsilon$ 给出，其中 $\\varepsilon$ 是一个方差为 $\\sigma^2$ 的零均值噪声项。期望平方预测误差 $\\text{Error}(x)$ 定义为 $\\mathbb{E}\\big[(\\hat{f}(x) - y)^{2}\\big]$。\n\n我们首先分解这个误差表达式。令 $\\hat{f}_{w}(x)$ 为集成预测器。\n$$\n\\text{Error}(x) = \\mathbb{E}\\big[(\\hat{f}_{w}(x) - y)^{2}\\big]\n$$\n代入 $y = f(x) + \\varepsilon$：\n$$\n\\text{Error}(x) = \\mathbb{E}\\big[(\\hat{f}_{w}(x) - (f(x) + \\varepsilon))^{2}\\big] = \\mathbb{E}\\big[((\\hat{f}_{w}(x) - f(x)) - \\varepsilon)^{2}\\big]\n$$\n展开平方项：\n$$\n\\text{Error}(x) = \\mathbb{E}\\big[(\\hat{f}_{w}(x) - f(x))^{2} - 2\\varepsilon(\\hat{f}_{w}(x) - f(x)) + \\varepsilon^{2}\\big]\n$$\n根据期望的线性性质：\n$$\n\\text{Error}(x) = \\mathbb{E}\\big[(\\hat{f}_{w}(x) - f(x))^{2}\\big] - 2\\mathbb{E}\\big[\\varepsilon(\\hat{f}_{w}(x) - f(x))\\big] + \\mathbb{E}[\\varepsilon^{2}]\n$$\n预测器 $\\hat{f}_{w}(x)$ 是训练数据的函数，对于一个新的观测值，它独立于噪声项 $\\varepsilon$。因此，$\\mathbb{E}\\big[\\varepsilon(\\hat{f}_{w}(x) - f(x))\\big] = \\mathbb{E}[\\varepsilon]\\mathbb{E}[\\hat{f}_{w}(x) - f(x)]$。由于 $\\mathbb{E}[\\varepsilon]=0$，该项为零。\n最后一项是 $\\mathbb{E}[\\varepsilon^{2}] = \\operatorname{Var}(\\varepsilon) + (\\mathbb{E}[\\varepsilon])^2 = \\sigma^2 + 0^2 = \\sigma^2$。\n\n第一项 $\\mathbb{E}\\big[(\\hat{f}_{w}(x) - f(x))^{2}\\big]$ 是预测器的均方误差 (MSE)。它可以被进一步分解。对于任意随机变量 $Z$，有 $\\mathbb{E}[Z^2] = \\operatorname{Var}(Z) + (\\mathbb{E}[Z])^2$。令 $Z = \\hat{f}_{w}(x) - f(x)$。\n$$\n\\mathbb{E}\\big[(\\hat{f}_{w}(x) - f(x))^{2}\\big] = \\operatorname{Var}(\\hat{f}_{w}(x) - f(x)) + (\\mathbb{E}[\\hat{f}_{w}(x) - f(x)])^2\n$$\n由于 $f(x)$ 是一个固定的、非随机的量，因此 $\\operatorname{Var}(\\hat{f}_{w}(x) - f(x)) = \\operatorname{Var}(\\hat{f}_{w}(x))$。根据定义，项 $\\mathbb{E}[\\hat{f}_{w}(x) - f(x)]$ 是集成预测器的偏差。\n令 $\\text{Bias}(\\hat{f}_{w}(x)) = \\mathbb{E}[\\hat{f}_{w}(x)] - f(x)$。\n因此，完整的分解是：\n$$\n\\text{Error}(x) = (\\text{Bias}(\\hat{f}_{w}(x)))^2 + \\operatorname{Var}(\\hat{f}_{w}(x)) + \\sigma^2\n$$\n这就是偏差-方差-噪声分解。我们的任务是为给定的集成计算这三项中的每一项。\n\n首先，我们推导集成偏差的符号表达式。集成预测器是 $\\hat{f}_{w}(x) = \\sum_{i=1}^{3} w_{i}\\,\\hat{f}_{i}(x)$。\n$$\n\\text{Bias}(\\hat{f}_{w}(x)) = \\mathbb{E}\\left[\\sum_{i=1}^{3} w_{i}\\,\\hat{f}_{i}(x)\\right] - f(x)\n$$\n利用期望的线性性质以及 $\\sum_{i=1}^{3} w_i = 1$：\n$$\n\\text{Bias}(\\hat{f}_{w}(x)) = \\sum_{i=1}^{3} w_{i}\\,\\mathbb{E}[\\hat{f}_{i}(x)] - \\left(\\sum_{i=1}^{3} w_i\\right)f(x) = \\sum_{i=1}^{3} w_{i} (\\mathbb{E}[\\hat{f}_{i}(x)] - f(x))\n$$\n这可以简化为各个偏差的加权和，$b_i(x) = \\mathbb{E}[\\hat{f}_{i}(x)] - f(x)$：\n$$\n\\text{Bias}(\\hat{f}_{w}(x)) = \\sum_{i=1}^{3} w_{i}\\,b_{i}(x) = w^T b(x)\n$$\n\n接下来，我们推导集成方差的符号表达式。\n$$\n\\operatorname{Var}(\\hat{f}_{w}(x)) = \\operatorname{Var}\\left(\\sum_{i=1}^{3} w_{i}\\,\\hat{f}_{i}(x)\\right)\n$$\n使用随机变量加权和的方差通用公式：\n$$\n\\operatorname{Var}(\\hat{f}_{w}(x)) = \\sum_{i=1}^{3} \\sum_{j=1}^{3} w_{i} w_{j} \\operatorname{Cov}(\\hat{f}_{i}(x), \\hat{f}_{j}(x))\n$$\n问题提供了基学习器误差的协方差矩阵 $\\Sigma(x)$，其元素为 $\\Sigma_{ij}(x) = \\operatorname{Cov}(e_i(x), e_j(x))$。由于 $e_i(x) = \\hat{f}_i(x) - f(x)$ 且 $f(x)$ 是一个常数，所以 $\\operatorname{Cov}(e_i(x), e_j(x)) = \\operatorname{Cov}(\\hat{f}_i(x), \\hat{f}_j(x))$。因此，$\\Sigma(x)$ 是预测器 $\\hat{f}_i(x)$ 的协方差矩阵。集成的方差可以写成矩阵形式：\n$$\n\\operatorname{Var}(\\hat{f}_{w}(x)) = w^T \\Sigma(x) w\n$$\n\n现在，我们代入给定的数值来计算总误差。\n权重为 $w = \\begin{pmatrix} 0.5 \\\\ 0.3 \\\\ 0.2 \\end{pmatrix}$。\n偏差向量为 $b(x) = \\begin{pmatrix} 0.20 \\\\ -0.10 \\\\ 0.05 \\end{pmatrix}$。\n协方差矩阵为 $\\Sigma(x) = \\begin{pmatrix} 0.25  0.10  0.05 \\\\ 0.10  0.36  0.12 \\\\ 0.05  0.12  0.49 \\end{pmatrix}$。\n不可约噪声方差为 $\\sigma^2 = 0.04$。\n\n1.  计算集成的偏差平方：\n    $$\n    \\text{Bias}(\\hat{f}_{w}(x)) = w^T b(x) = \\begin{pmatrix} 0.5  0.3  0.2 \\end{pmatrix} \\begin{pmatrix} 0.20 \\\\ -0.10 \\\\ 0.05 \\end{pmatrix}\n    $$\n    $$\n    \\text{Bias}(\\hat{f}_{w}(x)) = (0.5)(0.20) + (0.3)(-0.10) + (0.2)(0.05) = 0.10 - 0.03 + 0.01 = 0.08\n    $$\n    $$\n    (\\text{Bias}(\\hat{f}_{w}(x)))^2 = (0.08)^2 = 0.0064\n    $$\n\n2.  计算集成的方差：\n    $$\n    \\operatorname{Var}(\\hat{f}_{w}(x)) = w^T \\Sigma(x) w\n    $$\n    我们首先计算向量 $\\Sigma(x)w$：\n    $$\n    \\Sigma(x)w = \\begin{pmatrix} 0.25  0.10  0.05 \\\\ 0.10  0.36  0.12 \\\\ 0.05  0.12  0.49 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 0.3 \\\\ 0.2 \\end{pmatrix} = \\begin{pmatrix} (0.25)(0.5) + (0.10)(0.3) + (0.05)(0.2) \\\\ (0.10)(0.5) + (0.36)(0.3) + (0.12)(0.2) \\\\ (0.05)(0.5) + (0.12)(0.3) + (0.49)(0.2) \\end{pmatrix}\n    $$\n    $$\n    \\Sigma(x)w = \\begin{pmatrix} 0.125 + 0.030 + 0.010 \\\\ 0.050 + 0.108 + 0.024 \\\\ 0.025 + 0.036 + 0.098 \\end{pmatrix} = \\begin{pmatrix} 0.165 \\\\ 0.182 \\\\ 0.159 \\end{pmatrix}\n    $$\n    现在，我们计算二次型 $w^T(\\Sigma(x)w)$：\n    $$\n    \\operatorname{Var}(\\hat{f}_{w}(x)) = \\begin{pmatrix} 0.5  0.3  0.2 \\end{pmatrix} \\begin{pmatrix} 0.165 \\\\ 0.182 \\\\ 0.159 \\end{pmatrix}\n    $$\n    $$\n    \\operatorname{Var}(\\hat{f}_{w}(x)) = (0.5)(0.165) + (0.3)(0.182) + (0.2)(0.159) = 0.0825 + 0.0546 + 0.0318 = 0.1689\n    $$\n\n3.  将各分量相加得到总期望误差：\n    $$\n    \\text{Error}(x) = (\\text{Bias}(\\hat{f}_{w}(x)))^2 + \\operatorname{Var}(\\hat{f}_{w}(x)) + \\sigma^2\n    $$\n    $$\n    \\text{Error}(x) = 0.0064 + 0.1689 + 0.04\n    $$\n    $$\n    \\text{Error}(x) = 0.2153\n    $$\n结果 $0.2153$ 已经表示为四位有效数字。", "answer": "$$\n\\boxed{0.2153}\n$$", "id": "3180603"}]}