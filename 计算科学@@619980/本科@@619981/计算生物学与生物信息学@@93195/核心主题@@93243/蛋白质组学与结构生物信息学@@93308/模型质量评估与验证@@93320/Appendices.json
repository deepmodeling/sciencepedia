{"hands_on_practices": [{"introduction": "在评估分类器时，受试者工作特征（ROC）曲线和其曲线下面积（AUC）是金标准。然而，单独的 $AUC$ 值有时可能会产生误导。本练习 [@problem_id:2406412] 旨在揭示一个重要观点：即使两个模型的 $AUC$ 完全相同，在特定的实际约束条件下（例如，临床应用中对假阳性率 $FPR$ 的严格限制），其中一个模型可能明显优于另一个。通过这个案例，你将学会超越单一指标，深入分析 $ROC$ 曲线的局部性能，以做出更明智的模型选择。", "problem": "一家临床实验室正在验证两个二元分类器 $C_1$ 和 $C_2$，用于从高通量测序数据中筛查一种罕见的致病性变异。性能由受试者工作特征（ROC）曲线概括，该曲线绘制了真阳性率（$\\mathrm{TPR}$）相对于假阳性率（$\\mathrm{FPR}$）的关系。对于每个分类器，ROC 曲线由以下各点之间的线性插值定义：\n\n- 对于 $C_1$：$(0, 0)$, $(0.05, 0.55)$, $(1, 1)$。\n- 对于 $C_2$：$(0, 0)$, $(0.20, 0.70)$, $(1, 1)$。\n\n假设评估队列足够大，以至于这些分段线性曲线可以被视为精确的。监管机构规定，任何部署的筛查阈值都必须满足 $\\mathrm{FPR} \\le 0.05$。\n\n哪个选项是正确的？\n\nA. ROC 曲线下面积相等，且在 $\\mathrm{FPR} \\le 0.05$ 的约束下，$C_1$ 更优。\n\nB. ROC 曲线下面积相等，且在 $\\mathrm{FPR} \\le 0.05$ 的约束下，$C_2$ 更优。\n\nC. $C_1$ 的 ROC 曲线下面积超过 $C_2$，因此在任何约束下 $C_1$ 都更优。\n\nD. ROC 曲线下面积相等，因此在任何约束下，$C_1$ 和 $C_2$ 在临床上没有区别。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 两个二元分类器，记为 $C_1$ 和 $C_2$。\n- 性能由受试者工作特征（ROC）曲线衡量，该曲线绘制了真阳性率（$\\mathrm{TPR}$）相对于假阳性率（$\\mathrm{FPR}$）的关系。\n- ROC 曲线是分段线性的。\n- 对于分类器 $C_1$，ROC 曲线经过点 $(0, 0)$、$(0.05, 0.55)$ 和 $(1, 1)$。\n- 对于分类器 $C_2$，ROC 曲线经过点 $(0, 0)$、$(0.20, 0.70)$ 和 $(1, 1)$。\n- 这些曲线被认为是性能的精确表示。\n- 施加了一个监管约束：任何部署的筛查阈值都必须满足 $\\mathrm{FPR} \\le 0.05$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学基础：** 该问题使用了统计分类和医学诊断中的标准、基石性概念，即 ROC 分析、$\\mathrm{TPR}$ 和 $\\mathrm{FPR}$。筛查致病性变异的背景是生物信息学中的一个主要应用。该问题在科学上是合理的。\n- **适定性：** 该问题是适定的。两个分类器的 ROC 曲线都由一组点和线性插值规则明确给出。目标是基于这些曲线和一个给定的精确约束来比较分类器。唯一解所需的所有信息都已提供。\n- **客观性：** 该问题使用了领域内标准的、精确且无歧义的术语进行陈述。它不包含主观或基于意见的陈述。\n\n**步骤 3：结论与行动**\n该问题具有科学基础、适定性、客观性且内部一致。因此，该问题是**有效的**。我将继续推导解决方案。\n\n解决方案需要两个主要步骤：首先，计算每个分类器的总体性能指标，即 ROC 曲线下面积（AUC），该指标有时会被不严谨地称为“曲线下面积”；其次，在给定的假阳性率约束下专门评估其性能。\n\n**第 1 部分：计算 ROC 曲线下面积（AUC）**\n分段线性 ROC 曲线下的面积是通过对由线段形成的梯形面积求和来计算的。由点 $(x_{i-1}, y_{i-1})$ 和 $(x_i, y_i)$ 定义的梯形面积由公式 $(x_i - x_{i-1}) \\times \\frac{y_{i-1} + y_i}{2}$ 给出。\n\n对于分类器 $C_1$，点为 $(0, 0)$、$(0.05, 0.55)$ 和 $(1, 1)$。\n总面积 $\\mathrm{AUC}_1$ 是两个梯形面积之和。\n- 第一个梯形的面积（从 $\\mathrm{FPR}=0$ 到 $\\mathrm{FPR}=0.05$）：\n$$ A_1 = (0.05 - 0) \\times \\frac{0 + 0.55}{2} = 0.05 \\times 0.275 = 0.01375 $$\n- 第二个梯形的面积（从 $\\mathrm{FPR}=0.05$ 到 $\\mathrm{FPR}=1$）：\n$$ A_2 = (1 - 0.05) \\times \\frac{0.55 + 1}{2} = 0.95 \\times \\frac{1.55}{2} = 0.95 \\times 0.775 = 0.73625 $$\n- $C_1$ 的总 AUC：\n$$ \\mathrm{AUC}_1 = A_1 + A_2 = 0.01375 + 0.73625 = 0.75 $$\n\n对于分类器 $C_2$，点为 $(0, 0)$、$(0.20, 0.70)$ 和 $(1, 1)$。\n总面积 $\\mathrm{AUC}_2$ 也是两个梯形面积之和。\n- 第一个梯形的面积（从 $\\mathrm{FPR}=0$ 到 $\\mathrm{FPR}=0.20$）：\n$$ A_1' = (0.20 - 0) \\times \\frac{0 + 0.70}{2} = 0.20 \\times 0.35 = 0.07 $$\n- 第二个梯形的面积（从 $\\mathrm{FPR}=0.20$ 到 $\\mathrm{FPR}=1$）：\n$$ A_2' = (1 - 0.20) \\times \\frac{0.70 + 1}{2} = 0.80 \\times \\frac{1.70}{2} = 0.80 \\times 0.85 = 0.68 $$\n- $C_2$ 的总 AUC：\n$$ \\mathrm{AUC}_2 = A_1' + A_2' = 0.07 + 0.68 = 0.75 $$\n\n计算证实 $\\mathrm{AUC}_1 = \\mathrm{AUC}_2 = 0.75$。ROC 曲线下面积相等。\n\n**第 2 部分：在约束 $\\mathrm{FPR} \\le 0.05$ 下的评估**\n监管机构规定只有 $\\mathrm{FPR} \\le 0.05$ 的工作点是允许的。为了在此约束下比较分类器，我们必须确定在区间 $[0, 0.05]$ 内，对于任何给定的 $\\mathrm{FPR}$，哪个分类器提供更高的 $\\mathrm{TPR}$。\n\n对于分类器 $C_1$，该区域内的 ROC 曲线是连接 $(0, 0)$ 和 $(0.05, 0.55)$ 的线段。$C_1$ 的 $\\mathrm{TPR}$ 作为 $\\mathrm{FPR}$ 的函数方程为：\n$$ \\mathrm{TPR}_1(\\mathrm{FPR}) = \\frac{0.55 - 0}{0.05 - 0} \\times \\mathrm{FPR} = 11 \\times \\mathrm{FPR} \\quad \\text{for } 0 \\le \\mathrm{FPR} \\le 0.05 $$\n\n对于分类器 $C_2$，其 ROC 曲线的相关部分位于连接 $(0, 0)$ 和 $(0.20, 0.70)$ 的线段上。$C_2$ 在该区域的 $\\mathrm{TPR}$ 方程为：\n$$ \\mathrm{TPR}_2(\\mathrm{FPR}) = \\frac{0.70 - 0}{0.20 - 0} \\times \\mathrm{FPR} = 3.5 \\times \\mathrm{FPR} \\quad \\text{for } 0 \\le \\mathrm{FPR} \\le 0.20 $$\n\n现在，我们在约束区间 $(0, 0.05]$ 内比较这两个函数对于任何 $\\mathrm{FPR}$ 值的表现。\n$$ \\mathrm{TPR}_1(\\mathrm{FPR}) = 11 \\times \\mathrm{FPR} $$\n$$ \\mathrm{TPR}_2(\\mathrm{FPR}) = 3.5 \\times \\mathrm{FPR} $$\n由于 $11 > 3.5$，因此对于允许范围内的任何正 $\\mathrm{FPR}$ 值，都有 $\\mathrm{TPR}_1(\\mathrm{FPR}) > \\mathrm{TPR}_2(\\mathrm{FPR})$。这意味着在感兴趣的工作区域内，分类器 $C_1$ 严格优于分类器 $C_2$。例如，在允许的最大 $\\mathrm{FPR}$ 为 $0.05$ 时，$C_1$ 达到的 $\\mathrm{TPR}$ 为 $0.55$，而 $C_2$ 达到的 $\\mathrm{TPR}$ 仅为 $3.5 \\times 0.05 = 0.175$。\n\n因此，在监管约束下，分类器 $C_1$ 无疑是更优的选择。\n\n**逐项分析选项**\n\nA. ROC 曲线下面积相等，且在 $\\mathrm{FPR} \\le 0.05$ 的约束下，$C_1$ 更优。\n- 如计算所示，$\\mathrm{AUC}_1 = \\mathrm{AUC}_2 = 0.75$。陈述的第一部分是正确的。\n- 如证明所示，对于任何给定的 $\\mathrm{FPR} \\in (0, 0.05]$，$C_1$ 提供的 $\\mathrm{TPR}$ 高于 $C_2$。因此，在该约束下，$C_1$ 更优。陈述的第二部分也是正确的。\n- 结论：**正确**。\n\nB. ROC 曲线下面积相等，且在 $\\mathrm{FPR} \\le 0.05$ 的约束下，$C_2$ 更优。\n- 第一部分正确。\n- 第二部分不正确。分类器 $C_1$ 更优，而不是 $C_2$。\n- 结论：**不正确**。\n\nC. $C_1$ 的 ROC 曲线下面积超过 $C_2$，因此在任何约束下 $C_1$ 都更优。\n- 前提“$C_1$ 的 ROC 曲线下面积超过 $C_2$”是错误的。两个面积相等。\n- 结论“因此在任何约束下 $C_1$ 都更优”在逻辑上也是不成立的。即使一个 AUC 更高，也不能保证在所有可能的约束下都具有优越性。\n- 结论：**不正确**。\n\nD. ROC 曲线下面积相等，因此在任何约束下，$C_1$ 和 $C_2$ 在临床上没有区别。\n- 前提“ROC 曲线下面积相等”是正确的。\n- 结论“因此在任何约束下，$C_1$ 和 $C_2$ 在临床上没有区别”是一个常见但深刻的推理错误。相等的总体 AUC 并不意味着在 ROC 空间的特定子区域内性能相同。我们的分析表明，在给定约束下，$C_1$ 存在明显的临床优势和偏好。对于不同的约束，例如 $\\mathrm{FPR} \\ge 0.1$，$C_2$ 可能更优。因此，它们并非没有区别。\n- 结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2406412"}, {"introduction": "在生物信息学中，我们常常需要从多个候选模型中选出最优的一个。一个更复杂的模型或许能在训练数据上获得更好的拟合度（即更高的似然值），但这可能是过拟合的迹象。赤池信息准则（Akaike Information Criterion, AIC）提供了一个优雅的解决方案，它通过惩罚模型的参数数量 $k$ 来权衡模型的拟合优度（通过最大化对数似然 $\\ell$ 衡量）与复杂度。这个练习 [@problem_id:2406458] 将指导你应用 $AIC$ 来比较两个用于基因发现的隐马尔可夫模型（HMM），亲手计算并判断哪个模型在拟合与复杂度之间取得了更好的平衡。", "problem": "您正在比较两个用于基因识别的隐马尔可夫模型 (HMM)，这两个模型都是在同一个注释过的基因组训练集上通过最大似然法训练得到的。将这两个模型表示为 $\\mathrm{M}_{1}$ 和 $\\mathrm{M}_{2}$。对于 $\\mathrm{M}_{1}$，独立估计参数（自由参数）的数量为 $k_{1} = 62$；对于 $\\mathrm{M}_{2}$，其数量为 $k_{2} = 95$。在拟合模型下，训练数据的最大化对数似然（自然对数）对于 $\\mathrm{M}_{1}$ 为 $\\ell_{1} = -40215.37$，对于 $\\mathrm{M}_{2}$ 为 $\\ell_{2} = -40180.00$。\n\n使用赤池信息准则 (AIC) 来评估相对模型质量。对于一个拟合模型，AIC 定义为 $\\mathrm{AIC} = 2k - 2\\ell$，其中 $k$ 是自由参数的数量，$\\ell$ 是最大化对数似然。定义赤池差值 $\\Delta_{i} = \\mathrm{AIC}_{i} - \\min_{j} \\mathrm{AIC}_{j}$，以及模型 $\\mathrm{M}_{2}$ 在两个模型中的赤池权重为\n$$\nw_{2} = \\frac{\\exp\\!\\left(-\\tfrac{1}{2}\\Delta_{2}\\right)}{\\exp\\!\\left(-\\tfrac{1}{2}\\Delta_{1}\\right) + \\exp\\!\\left(-\\tfrac{1}{2}\\Delta_{2}\\right)}.\n$$\n\n计算给定 $\\mathrm{M}_{1}$ 和 $\\mathrm{M}_{2}$ 的 $w_{2}$。将您的最终答案表示为小数，并四舍五入到 $4$ 位有效数字。", "solution": "该问题提出了一个在两个隐马尔可夫模型 $\\mathrm{M}_{1}$ 和 $\\mathrm{M}_{2}$ 之间进行模型选择的任务，使用的方法是赤池信息准则 (AIC)。该问题具有科学依据，提法明确，并提供了所有必要的信息。它是在计算生物学中直接应用一种标准统计方法的实例。因此，我们开始进行计算。\n\n所提供的参数如下：\n- 对于模型 $\\mathrm{M}_{1}$：自由参数数量 $k_{1} = 62$，最大化对数似然 $\\ell_{1} = -40215.37$。\n- 对于模型 $\\mathrm{M}_{2}$：自由参数数量 $k_{2} = 95$，最大化对数似然 $\\ell_{2} = -40180.00$。\n\n赤池信息准则定义为 $\\mathrm{AIC} = 2k - 2\\ell$。首先，我们计算每个模型的 AIC。\n\n对于模型 $\\mathrm{M}_{1}$：\n$$\n\\mathrm{AIC}_{1} = 2k_{1} - 2\\ell_{1} = 2(62) - 2(-40215.37) = 124 + 80430.74 = 80554.74\n$$\n\n对于模型 $\\mathrm{M}_{2}$：\n$$\n\\mathrm{AIC}_{2} = 2k_{2} - 2\\ell_{2} = 2(95) - 2(-40180.00) = 190 + 80360.00 = 80550.00\n$$\n\nAIC 衡量了模型拟合度（似然）和模型复杂度（参数数量）之间的权衡。较低的 AIC 值表示更好的模型。比较这两个值，我们发现：\n$$\n\\mathrm{AIC}_{2} = 80550.00  \\mathrm{AIC}_{1} = 80554.74\n$$\n因此，根据 AIC，模型 $\\mathrm{M}_{2}$ 优于模型 $\\mathrm{M}_{1}$。最小的 AIC 值为 $\\min_{j} \\mathrm{AIC}_{j} = \\mathrm{AIC}_{2} = 80550.00$。\n\n接下来，我们计算赤池差值，$\\Delta_{i} = \\mathrm{AIC}_{i} - \\min_{j} \\mathrm{AIC}_{j}$。\n\n对于模型 $\\mathrm{M}_{1}$：\n$$\n\\Delta_{1} = \\mathrm{AIC}_{1} - \\min_{j} \\mathrm{AIC}_{j} = 80554.74 - 80550.00 = 4.74\n$$\n\n对于模型 $\\mathrm{M}_{2}$：\n$$\n\\Delta_{2} = \\mathrm{AIC}_{2} - \\min_{j} \\mathrm{AIC}_{j} = 80550.00 - 80550.00 = 0\n$$\n\n最后，我们使用给定的公式计算模型 $\\mathrm{M}_{2}$ 的赤池权重 $w_{2}$：\n$$\nw_{2} = \\frac{\\exp(-\\frac{1}{2}\\Delta_{2})}{\\exp(-\\frac{1}{2}\\Delta_{1}) + \\exp(-\\frac{1}{2}\\Delta_{2})}\n$$\n代入已计算出的 $\\Delta_{1}$ 和 $\\Delta_{2}$ 的值：\n$$\nw_{2} = \\frac{\\exp(-\\frac{1}{2} \\cdot 0)}{\\exp(-\\frac{1}{2} \\cdot 4.74) + \\exp(-\\frac{1}{2} \\cdot 0)} = \\frac{\\exp(0)}{\\exp(-2.37) + \\exp(0)}\n$$\n由于 $\\exp(0) = 1$，表达式可简化为：\n$$\nw_{2} = \\frac{1}{\\exp(-2.37) + 1}\n$$\n现在，我们计算其数值：\n$$\nw_{2} \\approx \\frac{1}{0.0934789... + 1} = \\frac{1}{1.0934789...} \\approx 0.914515...\n$$\n题目要求答案四舍五入到 $4$ 位有效数字。第五位有效数字是 $1$，因此我们不对第四位进行进位。\n$w_{2} \\approx 0.9145$\n这个权重可以解释为在给定数据和这两个模型的情况下，$\\mathrm{M}_{2}$ 是更优模型的概率。", "answer": "$$\n\\boxed{0.9145}\n$$", "id": "2406458"}]}