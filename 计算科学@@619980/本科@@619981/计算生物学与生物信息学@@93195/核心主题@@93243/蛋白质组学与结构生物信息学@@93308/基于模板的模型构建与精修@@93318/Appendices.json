{"hands_on_practices": [{"introduction": "建立蛋白质模型后，一个基本任务是量化其与模板结构的相似度。均方根偏差 (Root-Mean-Square Deviation, RMSD) 是评估结构相似性的核心指标。本练习将指导你计算模型与模板在功能关键区域（如活性位点）的局部RMSD，这是评估模型功能相关部分准确性的重要实践 [@problem_id:2434226]。", "problem": "已使用单个模板为一种酶构建了基于模板的同源模型。为评估与功能推断相关的局部准确性，请计算模型与模板之间仅限于已注释的活性位点残基的C-α原子的均方根偏差（RMSD）。模型和模板已经通过其完整骨架的最佳刚体叠合，置于一个共同的坐标系中。请仅使用下面给出的C-α坐标。\n\n活性位点残基（按模板编号），其三维笛卡尔坐标以埃（Å）为单位：\n\n- 残基 $102$：模板 $\\left(12.432,\\, 5.781,\\, 3.227\\right)$ Å；模型 $\\left(12.646,\\, 5.476,\\, 3.347\\right)$ Å\n- 残基 $105$：模板 $\\left(10.115,\\, 7.946,\\, 2.018\\right)$ Å；模型 $\\left(9.664,\\, 8.308,\\, 1.797\\right)$ Å\n- 残基 $136$：模板 $\\left(8.883,\\, 6.102,\\, 5.337\\right)$ Å；模型 $\\left(9.216,\\, 5.924,\\, 5.746\\right)$ Å\n- 残基 $164$：模板 $\\left(6.552,\\, 4.218,\\, 4.771\\right)$ Å；模型 $\\left(6.425,\\, 4.313,\\, 4.259\\right)$ Å\n- 残基 $189$：模板 $\\left(9.764,\\, 2.937,\\, 6.503\\right)$ Å；模型 $\\left(10.053,\\, 2.596,\\, 6.676\\right)$ Å\n\n请仅使用这五对C-α原子计算RMSD。将您的答案四舍五入至四位有效数字，并以埃（Å）为单位表示结果。最终答案必须是一个实数值。", "solution": "所呈现的问题陈述具有科学依据、问题明确且客观。它提出了计算结构生物学中的一个标准计算——计算两种蛋白质结构之间特定原子子集的均方根偏差（RMSD）。所有必要的数据，即指定原子对的笛卡尔坐标，均已提供。结构已经叠合的条件是一个关键且正确的简化，因为未经事先叠合的RMSD计算是一个不同且更复杂的问题。因此，该问题是有效的，可以推导出解。\n\n两组 $N$ 个对应原子之间的均方根偏差（$RMSD$）定义为每对原子之间欧几里得距离平方的平均值的平方根。其公式为：\n$$\nRMSD = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} d_i^2}\n$$\n其中 $N$ 是原子对的数量，$d_i$ 是模型中第 $i$ 个原子与模板中第 $i$ 个原子之间的距离。\n\n在本问题中，我们给出了 $N=5$ 对C-α原子的坐标。设第 $i$ 个模板原子的坐标为 $\\vec{t}_i = (x_{t,i}, y_{t,i}, z_{t,i})$，对应模型原子的坐标为 $\\vec{m}_i = (x_{m,i}, y_{m,i}, z_{m,i})$。每对原子的距离平方 $d_i^2$ 由下式给出：\n$$\nd_i^2 = |\\vec{m}_i - \\vec{t}_i|^2 = (x_{m,i} - x_{t,i})^2 + (y_{m,i} - y_{t,i})^2 + (z_{m,i} - z_{t,i})^2\n$$\n由于问题陈述指出结构已经进行了最佳叠合，我们可以直接进行这些距离的计算。我们将计算五对原子中每一对的距离平方。坐标以埃（Å）为单位给出。\n\n对于残基 $102$：\n$\\vec{t}_1 = (12.432, 5.781, 3.227)$\n$\\vec{m}_1 = (12.646, 5.476, 3.347)$\n$$\nd_1^2 = (12.646 - 12.432)^2 + (5.476 - 5.781)^2 + (3.347 - 3.227)^2\n$$\n$$\nd_1^2 = (0.214)^2 + (-0.305)^2 + (0.120)^2 = 0.045796 + 0.093025 + 0.014400 = 0.153221\n$$\n\n对于残基 $105$：\n$\\vec{t}_2 = (10.115, 7.946, 2.018)$\n$\\vec{m}_2 = (9.664, 8.308, 1.797)$\n$$\nd_2^2 = (9.664 - 10.115)^2 + (8.308 - 7.946)^2 + (1.797 - 2.018)^2\n$$\n$$\nd_2^2 = (-0.451)^2 + (0.362)^2 + (-0.221)^2 = 0.203401 + 0.131044 + 0.048841 = 0.383286\n$$\n\n对于残基 $136$：\n$\\vec{t}_3 = (8.883, 6.102, 5.337)$\n$\\vec{m}_3 = (9.216, 5.924, 5.746)$\n$$\nd_3^2 = (9.216 - 8.883)^2 + (5.924 - 6.102)^2 + (5.746 - 5.337)^2\n$$\n$$\nd_3^2 = (0.333)^2 + (-0.178)^2 + (0.409)^2 = 0.110889 + 0.031684 + 0.167281 = 0.309854\n$$\n\n对于残基 $164$：\n$\\vec{t}_4 = (6.552, 4.218, 4.771)$\n$\\vec{m}_4 = (6.425, 4.313, 4.259)$\n$$\nd_4^2 = (6.425 - 6.552)^2 + (4.313 - 4.218)^2 + (4.259 - 4.771)^2\n$$\n$$\nd_4^2 = (-0.127)^2 + (0.095)^2 + (-0.512)^2 = 0.016129 + 0.009025 + 0.262144 = 0.287298\n$$\n\n对于残基 $189$：\n$\\vec{t}_5 = (9.764, 2.937, 6.503)$\n$\\vec{m}_5 = (10.053, 2.596, 6.676)$\n$$\nd_5^2 = (10.053 - 9.764)^2 + (2.596 - 2.937)^2 + (6.676 - 6.503)^2\n$$\n$$\nd_5^2 = (0.289)^2 + (-0.341)^2 + (0.173)^2 = 0.083521 + 0.116281 + 0.029929 = 0.229731\n$$\n\n现在，我们将这些距离的平方相加：\n$$\n\\sum_{i=1}^{5} d_i^2 = 0.153221 + 0.383286 + 0.309854 + 0.287298 + 0.229731 = 1.36339\n$$\n接下来，我们通过将总和除以 $N=5$ 来计算均方偏差（MSD）：\n$$\nMSD = \\frac{1}{5} \\sum_{i=1}^{5} d_i^2 = \\frac{1.36339}{5} = 0.272678\n$$\n最后，RMSD是MSD的平方根：\n$$\nRMSD = \\sqrt{0.272678} \\approx 0.52218579...\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\nRMSD \\approx 0.5222 \\text{ Å}\n$$\n该值代表模型中活性位点C-α原子与其在模板结构中相应位置的平均偏差，为局部模型的准确性提供了一个定量的度量。", "answer": "$$\n\\boxed{0.5222}\n$$", "id": "2434226"}, {"introduction": "优秀的计算生物学家不仅要会构建模型，更要能预见序列差异导致的结构变化。此练习模拟了一个常见场景：模板中的二硫键在目标蛋白中被替换。通过这个思想实验，你将学会如何基于生物物理学原理，预测移除关键共价约束对模型局部结构、灵活性和稳定性的影响 [@problem_id:2434235]。", "problem": "您正在对一个单链蛋白质进行基于模板的建模（同源建模）。所选模板在残基 CYS50 和 CYS95 之间有一个分子内二硫键，而序列比对将您的目标残基 ALA50 和 ALA95 放在了相同的位置。假设比对是正确的，其余比对区域的序列相同，并且初始模型是通过转移比对区域的骨架坐标并重建侧链以匹配目标序列而构建的。在优化过程中，您使用一个标准的基于物理的能量函数，而没有施加任何共价二硫键约束。哪些陈述最能描述最终优化模型中预期的结构性后果？选择所有适用项。\n\nA. 模型将在位置 $50$ 和 $95$ 之间保持一个共价键，因为骨架的连通性要求如此，所以这些位置的局部几何构型应与模板基本保持不变。\n\nB. 由于在位置 $50$ 和 $95$ 处不可能形成二硫键，最终模型在这些位点之间应缺乏任何共价约束；与模板相比，这两个链段可能会表现出更大的柔性，并可能出现更大的分离距离或替代的堆积方式，而如果其他非共价接触能提供支持，整体折叠方式可以保持相似。\n\nC. 模型将通过在 ALA50 和 ALA95 之间创建一个盐桥来进行补偿，从而保留模板二硫键的几何构型，以维持相同的链段间约束。\n\nD. 用丙氨酸替换半胱氨酸消除了形成二硫键的可能性，并减小了这两个位置的侧链体积；局部堆积可能会变得松散（可能产生一个小空腔），并通过优化过程中的适度重排得到解决，并且与含二硫键的模板相比，该折叠态在此长程接触附近的熱稳定性预计会降低。\n\nE. 移除二硫键需要在位置 $50$ 和 $95$ 附近打断多肽骨架；因此，在最终模型中，肽链在这些位置周围的残基之间会变得不连续。", "solution": "### 解决方案推导\n该问题描述了一个标准的同源建模工作流程，其中目标蛋白质基于模板结构进行建模。模板和目标之间的关键区别在于，形成共价二硫键的两个半胱氨酸（CYS）残基 CYS50 和 CYS95 被两个丙氨酸（ALA）残基 ALA50 和 ALA95 替换。\n\n二硫键是两个半胱氨酸侧链的硫原子之间的共价键。这个键起到一个强力“订书针”的作用，将序列上可能相距很远的多肽链的两部分固定在空间上紧密的位置。在模板中，这个键严格地约束了残基 $50$ 和 $95$ 周围的骨架链段。\n\n目标蛋白质在这些位置上是丙氨酸。丙氨酸的侧链是一个甲基（$-CH_3$），它在化学上是惰性的、非极性的，并且无法与其他侧链形成共价键。\n\n初始模型是通过复制模板的骨架来构建的。因此，最初，目标模型中位置 $50$ 和 $95$ 处的骨架被放置在与模板中相同的构象，意味着它们彼此靠近。\n\n优化步骤使用一个“标准的基于物理的能量函数”。这类函数（例如，来自像 AMBER 或 CHARMM 这样的力场）根据系统的原子坐标计算其势能。该能量包括键长、键角、二面角和非键相互作用（范德华力和静电力）的项。关键是，问题陈述中说明了**不施加任何共价二硫键约束**。这是合乎逻辑的，因为模型在这些位置上包含的是丙氨酸，而不是半胱氨酸。\n\n在优化（能量最小化或分子动力学）过程中，结构会演化以寻找一个能量更低的构象。没有了模板中存在的强共价 `S-S` 键能量项，就没有力将 ALA50 和 ALA95 的侧链固定在一起。这两个残基及其周围链段之间唯一的相互作用将是弱的非键范德华力和静电力。\n\n其后果如下：\n$1$. **失去共价约束**：主要后果是去除了强共价交联。残基 $50$ 和 $95$ 附近的两个链段不再被化学方式束缚在一起。\n$2$. **柔性增加**：这种约束的丧失给予了局部多肽链段显著更多的构象自由度。它们可以在热运动和寻求最佳非共价堆积的驱动下相互自由移动。与模板相比，这可能导致这些区域之间的平均分离距离更大。\n$3$. **局部堆积的变化**：半胱氨酸的侧链（$-CH_2SH$）比丙氨酸的侧链（$-CH_3$）大。用两个ALA残基替换参与二硫键的两个CYS残基会导致局部侧链体积显著减小。这会在蛋白质核心中产生一个小空隙或空腔。优化过程可能会导致周围结构发生适度重排以填补这个空隙并优化范德华堆积。\n$4$. **稳定性降低**：二硫键是蛋白质折叠态热力学稳定性的主要贡献者。它们降低了去折叠态的构象熵，从而稳定了折叠构象。众所周知，去除一个二硫键会显著降低蛋白质的热稳定性（即降低其熔解温度）。\n$5$. **整体折叠的保持（有条件的）**：尽管前二硫键周围的区域会发生变化，但只要有足够的其他非共价相互作用网络（例如，大的疏水核心、广泛的氢键）来稳定，蛋白质的整体折叠方式很可能与模板保持相似。这是同源建模的一个基本假设。\n\n现在，我将基于这些原则评估每个选项。\n\n### 逐项分析\n\n**A. 模型将在位置 $50$ 和 $95$ 之间保持一个共价键，因为骨架的连通性要求如此，所以这些位置的局部几何构型应与模板基本保持不变。**\n这个陈述根本上是错误的。残基 $50$ 和 $95$ 之间的共价键是侧链相互作用（二硫键），而不是多肽骨架的特征。骨架是按顺序从残基 $49$ 连接到 $50$ 再到 $51$ 等，并独立地从 $94$ 连接到 $95$ 再到 $96$ 等。丙氨酸残基之间不能形成共价键。这个前提是错误的。\n结论：**不正确**。\n\n**B. 由于在位置 $50$ 和 $95$ 处不可能形成二硫键，最终模型在这些位点之间应缺乏任何共价约束；与模板相比，这两个链段可能会表现出更大的柔性，并可能出现更大的分离距离或替代的堆积方式，而如果其他非共价接触能提供支持，整体折叠方式可以保持相似。**\n这个陈述是对主要后果的精确总结。它正确地指出没有共价约束。它正确地预测了柔性增加和链段可能的分离。它还正确地指出，如果其他相互作用足以维持整体折叠，那么折叠方式可以被保留。这与推导过程完全一致。\n结论：**正确**。\n\n**C. 模型将通过在 ALA50 和 ALA95 之间创建一个盐桥来进行补偿，从而保留模板二硫键的几何构型，以维持相同的链段间约束。**\n这个陈述是不正确的。盐桥是酸性（带负电）和碱性（带正电）氨基酸侧链之间的静电相互作用，例如天冬氨酸和赖氨酸。丙氨酸是一种小分子、非极性的氨基酸，其侧链不带电。它不能参与形成盐桥。\n结论：**不正确**。\n\n**D. 用丙氨酸替换半胱氨酸消除了形成二硫键的可能性，并减小了这两个位置的侧链体积；局部堆积可能会变得松散（可能产生一个小空腔），并通过优化过程中的适度重排得到解决，并且与含二硫键的模板相比，该折叠态在此长程接触附近的熱稳定性预计会降低。**\n这个陈述从堆积和稳定性的角度准确地描述了其后果。它正确地指出二硫键被消除。它正确地识别了侧链体积的减小、由此导致的局部堆积松散，以及在优化过程中需要解决的潜在空腔。最后，它正确地得出结论，即去除一个起稳定作用的二硫键将导致折叠蛋白的热稳定性下降。所有观点都是有效的，并且与选项 B 互补。\n结论：**正确**。\n\n**E. 移除二硫键需要在位置 $50$ 和 $95$ 附近打断多肽骨架；因此，在最终模型中，肽链在这些位置周围的残基之间会变得不连续。**\n这个陈述基于对蛋白质结构的严重误解。二硫键连接的是侧链，而不是多肽骨架。骨架是一条连续的共价链。建模和优化过程旨在保持骨架的完整性。骨架断裂不是一个预期的结果；这将是模拟的严重失败。\n结论：**不正确**。\n\n总之，选项 B 和 D 都为同源模型中 CYS 到 ALA 替换的预期后果提供了准确且互补的描述。", "answer": "$$\\boxed{BD}$$", "id": "2434235"}, {"introduction": "在模板选择中，仅依赖整体序列一致性往往不够。为了构建更精确的模型，我们需要更智能的策略，例如优先考虑活性位点等功能区域的保守性。这个实践将引导你从第一性原理出发，编写一个定制化的模板排序评分函数，将生物学洞察力转化为实用的计算工具 [@problem_id:2434250]。", "problem": "您需要从基本原理出发，仅使用形式化定义，为基于模板的蛋白质模型构建实现一个排名分数。该分数应明确优先考虑活性位点残基的保守性，而非整体序列一致性。您的程序必须为一个小的、固定的测试套件计算排名，并在单行上为每个测试用例输出得分最高的模板的索引。每个测试用例的输入包括一个目标氨基酸序列、一组长度相等的已比对候选模板序列、一组活性位点位置、一个邻域半径，以及用于控制活性位点保守性与整体一致性相对重要性的可调权重。程序没有外部输入，应直接在代码中编码并使用所提供的测试套件。\n\n基本依据与必需的建模假设：\n\n- 蛋白质是氨基酸的聚合物序列。分子生物学的中心法则指出，序列决定结构和功能。对于基于模板的建模，保留功能关键残基（例如活性位点中的残基）比仅仅最大化全局一致性对构建可用模型更具预测性，这一点是已知的。\n- 替换矩阵（如 BLOSUM $62$）为氨基酸替换提供对数几率分数。如果 $M(x,y)$ 表示氨基酸 $x$ 被氨基酸 $y$ 替换的对数几率分数，那么根据经验观察，$M(x,y)$ 的值越大，反映了替换越有利或越频繁发生；值越小，反映了替换越不利。\n- 为了组合异构项，必须将分数置于一个共同的标度上。您必须通过一个保序仿射变换将替换分数置于单位区间上，该变换将所选替换矩阵的最小值映到 $0$，最大值映到 $1$。此要求意味着对矩阵条目集合存在一个唯一的线性重缩放。\n- 一个残基对功能保守性的贡献可以延伸到其局部邻域。对于每个活性位点索引 $a$，来自比对位置索引 $j$ 的贡献必须通过一个因子进行权重下调，该因子随序列距离 $d=\\lvert j-a\\rvert$ 呈几何级数衰减，每步比率为 $1/2$。这些位置权重必须在窗口内进行归一化，以使每个活性残基窗口的权重总和为 $1$。\n- 全局序列一致性定义为目标和模板具有相同氨基酸的比对位置的比例，该比例仅在两者均非空位的位置上计算。包含空位字符的位置对一致性的分母或分子均无贡献。\n- 模板比对中落在半径为 $r$ 的活性位点邻域内的空位，应产生一个明确的罚分，该罚分与该空位本应贡献的归一化位置权重成比例，从而抑制在活性残基处或其附近的缺失。\n\n您的任务是按如下方式为每个模板推导出一个单一的标量分数。\n\n1) 定义缩放后的替换分数。设 $S_{\\min}$ 和 $S_{\\max}$ 分别表示所选替换矩阵中所有氨基酸对 $(x,y)$ 的最小值和最大值。对于任何一对已比对的非空位残基 $(x,y)$，通过应用将 $S_{\\min}$ 映射到 $0$ 并将 $S_{\\max}$ 映射到 $1$ 的唯一保序仿射映射，计算一个在 $[0,1]$ 上的缩放分数。如果在某个位置上，目标或模板具有空位，则为下述活性位点保守性聚合的目的，该位置的缩放分数取为 $0$。\n\n2) 定义活性位点邻域聚合。对于每个活性位点索引 $a$ 和邻域半径 $r$，考虑满足 $\\lvert j-a\\rvert \\le r$ 和 $0 \\le j < L$ 的索引 $j$，其中 $L$ 是公共比对长度。为每个这样的位置赋予一个等于 $(1/2)^{\\lvert j-a\\rvert}$ 的原始权重，然后对这些原始权重进行归一化，使其在窗口内的总和为 $1$。活性位点 $a$ 的贡献是该窗口内缩放替换分数的加权平均值，减去罚分系数 $\\gamma$ 乘以该窗口内模板存在空位的位置的归一化权重总和。通过对所有活性位点索引进行平均，来聚合这些每个活性位点的贡献。\n\n3) 将全局一致性项定义为目标和模板均为非空位且相等的索引 $j$ 的位置数，除以两者均为非空位的位置数所得的比例。\n\n4) 将这两个项组合成一个单一分数，形式为凸组合，其中活性位点权重为 $\\alpha$，一致性权重为 $\\beta$，且 $\\alpha \\in (0,1)$，$\\beta = 1-\\alpha$，$ \\alpha > \\beta$。总分是活性位点保守性项和全局一致性项的加权和。\n\n5) 定义决胜规则。如果两个模板的组合分数在 $10^{-12}$ 的容差内相等，则优先选择在两个字符均为非空位的位置上具有更高平均缩放替换分数的模板来打破平局。如果仍然平局，选择索引最小的模板。\n\n所有角度（如有）均应以弧度为单位进行解释。本问题中没有物理单位。所有输出必须是数字索引，且不得包含单位或文本解释。\n\n在您的程序中要硬编码的测试套件：\n\n- 所有以下序列的公共比对长度为 $L=12$。空位字符为空格连字符 $-$。\n\n测试用例 1：\n- 目标：\"MKTAYIAKQRQL\"\n- 模板 (索引 $0,1,2$)：\n  - $0$: \"MKTGYIAEQRQL\"\n  - $1$: \"QKTAYLVKQHQL\"\n  - $2$: \"MRTAYIAKQREL\"\n- 活性位点索引 (从零开始)：$\\{3,7\\}$\n- 邻域半径：$r=1$\n- 活性位点权重：$\\alpha=0.7$ (因此 $\\beta=0.3$)\n- 空位罚分：$\\gamma=0.25$\n\n测试用例 2：\n- 目标：\"MKTAYIAKQRQL\"\n- 模板 (索引 $0,1,2$)：\n  - $0$: \"MKTA-IAKQRQL\"\n  - $1$: \"MKTSYIAKQRQL\"\n  - $2$: \"MKTAYIAKQ-QL\"\n- 活性位点索引 (从零开始)：$\\{3,7\\}$\n- 邻域半径：$r=1$\n- 活性位点权重：$\\alpha=0.8$ (因此 $\\beta=0.2$)\n- 空位罚分：$\\gamma=0.5$\n\n测试用例 3：\n- 目标：\"MKTAYIAKQRQL\"\n- 模板 (索引 $0,1,2$)：\n  - $0$: \"LKTAYIAKQRQI\"\n  - $1$: \"AKTAYIAKQRQG\"\n  - $2$: \"GATGYVAEGRAA\"\n- 活性位点索引 (从零开始)：$\\{3,7\\}$\n- 邻域半径：$r=0$\n- 活性位点权重：$\\alpha=0.6$ (因此 $\\beta=0.4$)\n- 空位罚分：$\\gamma=0.0$\n\n测试用例 4：\n- 目标：\"MKTAYIAKQRQL\"\n- 模板 (索引 $0,1,2$)：\n  - $0$: \"MKTGYIAEQRQL\"\n  - $1$: \"QKTAYLVKQHQL\"\n  - $2$: \"WSTAYIVKLRAV\"\n- 活性位点索引 (从零开始)：$\\{3,7\\}$\n- 邻域半径：$r=0$\n- 活性位点权重：$\\alpha=0.95$ (因此 $\\beta=0.05$)\n- 空位罚分：$\\gamma=0.0$\n\n最终输出要求：\n\n- 您的程序应生成单行输出，其中包含每个测试用例所选模板的索引，格式为逗号分隔的列表，置于方括号内，且无空格。例如，包含四个整数的输出应如 \"[0,2,1,0]\"。实际结果必须与上述测试套件和此处指定的评分规则相对应。", "solution": "该问题陈述已经过严格评估，并被确定为有效。它在科学上基于计算蛋白质结构预测的原理，定义明确，具有清晰且确定性的规则集，并使用客观、无歧义的语言进行表述。任务是实现一个评分函数，用于根据活性位点残基保守性和整体序列一致性的加权组合对蛋白质模板进行排名。所有必需的参数和测试数据均已提供。对 BLOSUM$62$ 矩阵的引用是该领域的标准做法，并将使用其规范形式。\n\n将按照规定对评分函数的各个组成部分进行形式化，以构建解决方案。\n\n设 $T$ 为目标序列， $P$ 为模板序列，两者在一个长度为 $L$ 的位置上进行比对。设 $A_S \\subset \\{0, 1, \\dots, L-1\\}$ 为活性位点残基的从零开始的索引集合。\n\n**1. 缩放后的替换分数**\n\n该分数的基础是 BLOSUM$62$ 替换矩阵，我们用 $M(x, y)$ 表示将氨基酸 $x$ 替换为 $y$ 的分数。为了组合来自不同来源的分数，我们必须对它们进行归一化。问题要求使用仿射变换将原始替换分数映射到单位区间 $[0, 1]$ 上。\n设 $S_{\\min}$ 和 $S_{\\max}$ 分别为标准 $20 \\times 20$ 氨基酸 BLOSUM$62$ 矩阵中的最小值和最大值。对于标准实现，$S_{\\min}=-4$ 且 $S_{\\max}=11$。对于一对非空位残基 $(x, y)$，其缩放分数 $S_{\\text{scaled}}(x, y)$ 由下式给出：\n$$S_{\\text{scaled}}(x, y) = \\frac{M(x, y) - S_{\\min}}{S_{\\max} - S_{\\min}} = \\frac{M(x, y) + 4}{15}$$\n如果在给定位置上目标或模板任一序列有空位字符，其对活性位点分数聚合的贡献定义为 $0$，因此在这种情况下我们设 $S_{\\text{scaled}} = 0$。\n\n**2. 活性位点保守性分数 ($A$)**\n\n该部分衡量功能关键的活性位点内部及其周围残基的保守性。其计算涉及三个步骤：\n\n首先，对于 $A_S$ 中的每个活性位点索引 $a$，定义一个半径为 $r$ 的邻域，即满足 $|j-a| \\le r$ 和 $0 \\le j < L$ 的索引 $j$ 的集合。该邻域中每个位置 $j$ 的影响通过一个几何衰减函数进行加权。位置 $j$ 相对于活性位点 $a$ 的未归一化权重 $w_{\\text{raw}}$ 为：\n$$w_{\\text{raw}}(j, a) = \\left(\\frac{1}{2}\\right)^{|j-a|}$$\n然后将这些权重归一化，使其在 $a$ 的邻域内总和为 $1$：\n$$w_{\\text{norm}}(j, a) = \\frac{w_{\\text{raw}}(j, a)}{\\sum_{k : |k-a| \\le r} w_{\\text{raw}}(k, a)}$$\n\n其次，计算单个活性位点 $a$ 的保守性分数，记为 $C_a$。它是其邻域内缩放替换分数的加权平均值，并通过对模板引入的任何空位进行罚分调整。设 $T_j$ 和 $P_j$ 分别为目标序列和模板序列在位置 $j$ 的残基。空位罚分由参数 $\\gamma$ 控制。\n$$C_a = \\left( \\sum_{j : |j-a| \\le r} w_{\\text{norm}}(j, a) \\cdot S_{\\text{scaled}}(T_j, P_j) \\right) - \\gamma \\cdot \\left( \\sum_{j : |j-a| \\le r \\text{ and } P_j = \\text{'--'}} w_{\\text{norm}}(j, a) \\right)$$\n\n最后，总的活性位点保守性分数 $A$ 是所有活性位点各自得分的算术平均值：\n$$A = \\frac{1}{|A_S|} \\sum_{a \\in A_S} C_a$$\n\n**3. 全局序列一致性 ($I$)**\n\n该项捕捉目标和模板之间的整体相似性，是衡量同源性的经典指标。它被定义为目标和模板残基相同的位置所占的比例，计算范围仅限于两个序列在该位置均非空位的情况。设 $\\mathcal{J}_{\\text{non-gap}} = \\{j \\mid T_j \\neq \\text{'-'} \\land P_j \\neq \\text{'-'}\\}$。\n$$I = \\frac{|\\{j \\in \\mathcal{J}_{\\text{non-gap}} \\mid T_j = P_j\\}|}{|\\mathcal{J}_{\\text{non-gap}}|}$$\n\n**4. 总分与排名**\n\n模板的最终分数 $S$ 是活性位点保守性分数 $A$ 和全局一致性分数 $I$ 的凸组合。权重 $\\alpha$ 和 $\\beta=1-\\alpha$ 控制它们的相对贡献。\n$$S = \\alpha A + \\beta I$$\n\n模板按其分数 $S$ 的降序排名。为解决平局情况（分数在 $10^{-12}$ 容差范围内相等），按顺序应用以下规则：\n1.  优先选择具有更高平均缩放替换分数的模板。该分数是在所有非空位位置 $j \\in \\mathcal{J}_{\\text{non-gap}}$ 上 $S_{\\text{scaled}}(T_j, P_j)$ 的平均值。\n2.  如果分数仍然相同，则选择具有较小原始索引（即其在输入列表中的位置）的模板。\n\n这完成了算法的形式化定义。实现将通过系统地将这些方程应用于提供的测试套件来进行。", "answer": "[0,1,0,0]", "id": "2434250"}]}