{"hands_on_practices": [{"introduction": "本练习将带你进行一次基础计算，将数据库搜索中的两个核心统计量——p值（p-value）和有效搜索空间大小——联系起来。通过直接计算期望值（E-value），你将巩固对E值基本定义的理解，即在给定大小的数据库中随机匹配预计出现的次数。这项实践是掌握序列比对统计显著性评估的第一步 [@problem_id:2387483]。", "problem": "在一次蛋白质数据库搜索中发现的一个局部比对，据报告其单次比较的尾部概率（p值）为 $10^{-6}$；也就是说，在序列不相关的零假设下，一次随机比较产生一个至少与观测分数一样高的分数的概率为 $10^{-6}$。对于此查询和数据库，有效搜索空间参数（记作 $K m' n'$）等于 $10^{8}$，代表搜索过程中有效独立评分机会的数量。在局部比对分数的标准零模型下，期望值（E值）被定义为在整个搜索中，随机比对分数至少与观测分数一样高的预期数量。\n\n计算此比对的E值。请以精确数值报告您的答案（不要四舍五入）。", "solution": "首先对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 单次比较的尾部概率（p值）：$p = 10^{-6}$。\n- 有效搜索空间参数：$K m' n' = 10^{8}$。\n- 期望值（E值）的定义：在整个搜索中，随机比对分数至少与观测分数一样高的预期数量。\n\n步骤2：使用提取的已知条件进行验证。\n- 该问题具有科学依据。p值、E值和有效搜索空间大小（$K m' n'$）等概念是序列数据库搜索算法（如BLAST和FASTA）统计框架的核心，特别是由Karlin-Altschul统计学推导出来的。\n- 该问题是适定的。它提供了计算所需量所需的所有数值和一个清晰的定义。存在一个唯一且有意义的解。\n- 该问题是客观的。其语言精确，没有主观或推测性内容。\n\n步骤3：结论与行动。\n问题被认为是有效的，将提供解答。\n\nE值，记为 $E$，表示在数据库搜索中，因偶然机会预期出现的、分数大于或等于特定分数 $S$ 的不同比对的数量。该问题提供了计算所需的基本量。\n\n单次比较的尾部概率，或称p值，记为 $p$，是两条随机序列进行单次比较时，产生至少与观测分数一样高的分数的概率。其给定值为：\n$$p = 10^{-6}$$\n\n有效搜索空间大小代表搜索过程中执行的有效独立比较的次数。它由参数 $K m' n'$ 给出，其中 $m'$ 和 $n'$ 是查询序列和数据库序列的有效长度，而 $K$ 是一个依赖于评分矩阵和序列组成的统计参数。其给定值为：\n$$K m' n' = 10^{8}$$\n让我们将这个有效独立比较的次数记为 $N_{eff}$。\n$$N_{eff} = K m' n' = 10^{8}$$\n\nE值被定义为偶然得到的、分数至少与观测分数一样高的比对的预期数量。这可以概念化为一系列 $N_{eff}$ 次的伯努利试验，其中每次试验对应一次随机比对比较，其成功概率为 $p$。在这样的系列试验中，预期的成功次数是试验次数与每次试验成功概率的乘积。\n\n因此，E值 $E$ 的计算方法是有效搜索空间大小与p值的乘积：\n$$E = N_{eff} \\times p$$\n\n将给定值代入此方程：\n$$E = (10^{8}) \\times (10^{-6})$$\n\n使用指数的性质，我们合并这些项：\n$$E = 10^{8 - 6}$$\n$$E = 10^{2}$$\n$$E = 100$$\n\n这个结果表明，在使用给定查询搜索如此大小的数据库时，纯粹由于偶然，人们预期会找到 $100$ 个分数与观测分数一样高或更高的比对。", "answer": "$$\\boxed{100}$$", "id": "2387483"}, {"introduction": "在掌握了 $E$ 值的基本计算之后，让我们通过一个思想实验来深入探讨影响其数值的关键因素。这个练习提出了一种情景：两次搜索产生了具有相同比特分数（bit-score）的比对，但 $E$ 值却不同。通过分析可能的原因，你将学会批判性地思考搜索空间大小（如数据库大小或查询序列有效长度）如何独立于比对质量本身，从而直接影响最终的统计显著性 [@problem_id:2387487]。", "problem": "两次使用基础局部比对搜索工具 (Basic Local Alignment Search Tool, BLAST) 的独立搜索，对同一个查询-目标序列对产生了相同的比对结果，报告了相同的比特分 (bit-score)，但报告的期望值 (E-value) 却不同，第一次搜索为 $0.01$，第二次为 $0.04$。假设 E-value 的标准统计学解释为在搜索空间中随机匹配得到同样好或更好结果的预期数量，并且报告的比特分在两次运行中是直接可比的，那么下列哪几种搜索情景的组合最能解释这种情况的发生？请选择所有适用的选项。\n\nA. 运行 $1$ 是针对一个精选子集进行蛋白质-蛋白质搜索，其数据库总有效长度为 $M$ 个残基；而运行 $2$ 使用相同的查询序列和评分方案，针对一个约有 $4M$ 个残基的数据库进行搜索；比对质量相同，因此比特分也相同，但运行 $2$ 中更大的搜索空间导致其 E-value 大约是前者的 $4$ 倍。\n\nB. 运行 $1$ 和运行 $2$ 使用相同的查询序列、相同的数据库和相同的有效搜索空间，但使用了不同的替换矩阵；由于矩阵不同，即使报告的比特分相同，E-value 也可能相差 $4$ 倍。\n\nC. 运行 $1$ 对查询序列应用了低复杂度区域遮蔽，使其有效查询长度约为未遮蔽长度的四分之一，而运行 $2$ 则没有进行遮蔽；所有其他设置均相同，且比对区域不与被遮蔽的片段重叠，因此比特分保持相同，但运行 $1$ 中小四倍的有效搜索空间导致其 E-value 大约小 $4$ 倍。\n\nD. 运行 $1$ 是蛋白质-蛋白质搜索，而运行 $2$ 是蛋白质对六框翻译核苷酸序列的搜索，两者都被构建为在有效数据库中具有相同数量的目标氨基酸残基；仅凭运行 $2$ 中存在六个阅读框这一点，就足以解释在搜索空间大小和比特分相同的情况下，其 E-value 为何会大四倍。", "solution": "问题描述了这样一种情况：两次独立的 BLAST 搜索产生了一个具有相同比特分 ($S'$) 的相同比对，但期望值 (E-value) 相差四倍。具体来说，$E_1 = 0.01$，$E_2 = 0.04$。我们需要确定所提供的哪种情景可以解释这一观察结果。\n\nE-value ($E$)、比特分 ($S'$) 和搜索空间大小之间的基本关系由以下公式给出：\n$$E = m' n' 2^{-S'}$$\n其中 $m'$ 是查询序列的有效长度，$n'$ 是数据库的有效长度。乘积 $m'n'$ 构成了搜索空间的有效大小。\n\n我们已知两次运行的比特分相同，即 $S'_1 = S'_2 = S'$。两次运行的 E-value 分别为：\n$$E_1 = (m'n')_1 \\cdot 2^{-S'}$$\n$$E_2 = (m'n')_2 \\cdot 2^{-S'}$$\n这里，$(m'n')_1$ 和 $(m'n')_2$ 分别代表运行 $1$ 和运行 $2$ 的有效搜索空间大小。\n\n为了找到搜索空间之间的关系，我们计算 E-value 的比值：\n$$\\frac{E_2}{E_1} = \\frac{(m'n')_2 \\cdot 2^{-S'}}{(m'n')_1 \\cdot 2^{-S'}}$$\n由于 $2^{-S'}$ 是一个公因子，它可以被约掉，得到：\n$$\\frac{E_2}{E_1} = \\frac{(m'n')_2}{(m'n')_1}$$\n代入给定的 E-value 数值：\n$$\\frac{0.04}{0.01} = 4$$\n因此，要使观察到的 E-value 成立，必须满足的条件是：运行 $2$ 的有效搜索空间必须是运行 $1$ 的有效搜索空间的四倍大：\n$$\\frac{(m'n')_2}{(m'n')_1} = 4$$\n\n我们现在将根据这个推导出的条件来评估每个选项。\n\nA. 运行 $1$ 是针对一个精选子集进行蛋白质-蛋白质搜索，其数据库总有效长度为 $M$ 个残基；而运行 $2$ 使用相同的查询序列和评分方案，针对一个约有 $4M$ 个残基的数据库进行搜索；比对质量相同，因此比特分也相同，但运行 $2$ 中更大的搜索空间导致其 E-value 大约是前者的 $4$ 倍。\n\n在这种情景下，两次运行的查询序列相同，因此有效查询长度 $m'$ 是恒定的。有效数据库长度分别为 $n'_1 \\approx M$ 和 $n'_2 \\approx 4M$。\n搜索空间大小的比值为：\n$$\\frac{(m'n')_2}{(m'n')_1} = \\frac{m' \\cdot n'_2}{m' \\cdot n'_1} \\approx \\frac{m' \\cdot (4M)}{m' \\cdot M} = 4$$\n这个情景完全符合所需条件。比特分取决于比对和评分系统（替换矩阵和罚分），而不是数据库大小。由于比对和评分方案相同，比特分也会相同。数据库大小增加四倍，直接导致 E-value 增加四倍。\n结论：**正确**。\n\nB. 运行 $1$ 和运行 $2$ 使用相同的查询序列、相同的数据库和相同的有效搜索空间，但使用了不同的替换矩阵；由于矩阵不同，即使报告的比特分相同，E-value 也可能相差 $4$ 倍。\n\n这个陈述存在根本性错误。如果有效搜索空间 ($m'n'$) 和比特分 ($S'$) 都相同，那么根据公式 $E = m'n' \\cdot 2^{-S'}$ 计算出的 E-value 也必须相同。在这些条件下 E-value 可能不同的前提，直接与统计模型相矛盾。虽然不同的替换矩阵确实有不同的统计参数（$K$ 和 $\\lambda$），但比特分 $S' = (\\lambda S - \\ln K) / \\ln 2$ 是专门设计为一种标准化分数，可以在不同评分系统之间进行比较。对于同一个比对，使用不同的矩阵得到完全相同的比特分已经极不可能，但即使我们接受这个前提，如果搜索空间也相同，那么 E-value 会不同的结论在数学上是不可能的。\n结论：**不正确**。\n\nC. 运行 $1$ 对查询序列应用了低复杂度区域遮蔽，使其有效查询长度约为未遮蔽长度的四分之一，而运行 $2$ 则没有进行遮蔽；所有其他设置均相同，且比对区域不与被遮蔽的片段重叠，因此比特分保持相同，但运行 $1$ 中小四倍的有效搜索空间导致其 E-value 大约小 $4$ 倍。\n\n在这种情景下，两次运行的数据库相同，因此有效数据库长度 $n'$ 是恒定的。运行 $2$ 使用完整的、未遮蔽的查询序列，其有效查询长度为 $m'_2$。运行 $1$ 使用了经过遮蔽的查询序列，其有效长度减少到四分之一，因此 $m'_1 \\approx m'_2 / 4$。搜索空间大小的比值为：\n$$\\frac{(m'n')_2}{(m'n')_1} = \\frac{m'_2 \\cdot n'}{m'_1 \\cdot n'} \\approx \\frac{m'_2 \\cdot n'}{(m'_2 / 4) \\cdot n'} = 4$$\n这个情景也符合所需条件。题目中说明比特分是针对一个未被遮蔽区域的比对。局部比对的比特分与总序列长度（决定 E-value 的因素）无关，因此比特分相同是合理的。运行 $1$ 的有效查询长度减少了四倍，导致其 E-value 相对于运行 $2$ 也小了四倍。\n结论：**正确**。\n\nD. 运行 $1$ 是蛋白质-蛋白质搜索，而运行 $2$ 是蛋白质对六框翻译核苷酸序列的搜索，两者都被构建为在有效数据库中具有相同数量的目标氨基酸残基；仅凭运行 $2$ 中存在六个阅读框这一点，就足以解释在搜索空间大小和比特分相同的情况下，其 E-value 为何会大四倍。\n\n这个选项明确指出，“有效数据库中的目标氨基酸残基总数”在两次运行中是相同的。这意味着 $n'_1 = n'_2$。由于查询序列是同一个蛋白质，所以 $m'_1 = m'_2$。因此，有效搜索空间大小是相同的：$(m'n')_1 = (m'n')_2$。鉴于比特分也相同 ($S'_1 = S'_2$)，根据 $E = m'n' \\cdot 2^{-S'}$，E-value 必须相同。那种认为“仅凭运行 $2$ 中存在六个阅读框”就足以证明 E-value 不同的说法，是对 BLAST 统计学的一种误解。六框翻译的影响已经计入总有效数据库长度 $n'$ 的计算中。如果这个长度与蛋白质-蛋白质搜索中的长度相同，就不存在进一步的特设校正因子。这个情景与观察到的 E-value 差异不符。\n结论：**不正确**。", "answer": "$$\\boxed{AC}$$", "id": "2387487"}, {"introduction": "这个练习旨在解决一个在解读BLAST结果时常见的困惑，从而建立你在实际应用中的直觉。为什么一个短的、完全匹配的序列可能统计上不显著（$E>1$），而一个长的、仅有部分相似性的比对却可能极其显著（$E<10^{-10}$）？通过分析这个看似矛盾的场景，你将深刻理解比对长度在累积统计证据中的强大作用，这是超越简单地看待匹配百分比的关键一步 [@problem_id:2387464]。", "problem": "一位研究人员使用基础局部比对搜索工具（BLAST）在一个全面的蛋白质数据库中进行蛋白质搜索，并观察到以下两个局部比对结果：(i) 在一个目标序列中出现一个长度为 $6$ 个氨基酸的精确匹配，其期望值（E-value）为 $E>1$，以及 (ii) 一个长度为 $50$ 个氨基酸的有空位的局部比对，其中约有 $30\\%$ 的残基相同，其期望值为 $E<10^{-10}$。以下哪项最能解释为什么更长、一致性更低的比对可能比短的精确匹配具有远超其的统计显著性？\n\nA. 期望值（E-value）定义为在整个数据库中，随机情况下可能出现的得分不低于观测得分的比对的预期数量；长度为 $6$ 的短精确片段在一个大型蛋白质数据库中预计会随机出现多次，而一个 $50$ 个残基的比对（即使只有 $30\\%$ 的一致性）可以累积得到高得多的比对得分，因此在极值分布下，其出现的可能性呈指数级降低，从而得到一个非常小的 $E$ 值。\n\nB. 期望值（E-value）仅仅是百分比一致性的一个转换，因此较低的百分比一致性（例如 $30\\%$）总是意味着比更高的百分比一致性（例如，在 $6$ 个残基上有 $100\\%$）有更小的 $E$ 值，而与比对长度或数据库大小无关。\n\nC. 无论其他因素如何，空位总会降低期望值（E-value），因此任何有空位的比对本质上都比任何无空位的精确匹配更具统计显著性。\n\nD. 大于 $1$ 的期望值（E-value）必然表示打分矩阵失效；选择一个不同的替换矩阵会自动使任何精确匹配（即使长度为 $6$）都比任何更长、一致性更低的比对更显著。\n\nE. 短的精确匹配仅仅因为低复杂性区域屏蔽而被降权，而更长的比对逃脱了这种过滤，因此后者总是更显著，与数据库大小或打分考虑无关。", "solution": "问题陈述在科学上是有效的。它描述了生物信息学中一个关于序列比对统计显著性的经典且基础的场景，这是一个基于既定原则的、表述恰当的问题。所提供的数据对于从基础局部比对搜索工具（BLAST）搜索中获得的结果来说是符合实际的。因此，我们可以进行全面的分析。\n\n核心概念是期望值，或称 E-value，它量化了局部比对的统计显著性。E-value 表示在一个给定大小的数据库中，随机情况下预计能找到的得分不低于观测得分的比对数量。一个更小的 E-value 表示一个统计上更显著的比对，意味着它更不可能是随机产生的结果。\n\n局部比对的得分，用 $S$ 表示，是根据一个替换矩阵（例如，BLOSUM$62$）和空位罚分计算出来的。对于一个长度为 $m$ 的查询序列和一个总长度为 $n$ 的数据库之间的比对，E-value 由以下公式给出：\n$$ E = Kmn e^{-\\lambda S} $$\n在这里，$K$ 和 $\\lambda$ 是统计参数，它们是打分系统（所使用的特定替换矩阵和空位罚分）和背景氨基酸分布的特征。这个方程揭示了 E-value 的关键依赖关系：\n$1$. 它与搜索空间的大小成正比，由乘积 $mn$ 表示。更大的数据库或更长的查询序列会增加随机找到匹配的概率。\n$2$. 随着比对得分 $S$ 的增加，它呈指数级下降。这种指数关系是获得高统计显著性的最关键因素。\n\n让我们分析问题中描述的两个结果：\n\n(i) 一个长度为 $6$ 个氨基酸、$E > 1$ 的精确匹配：\n仅有 $6$ 个残基的精确匹配会导致一个相对较低的比对得分 $S$。虽然百分比一致性是 $100\\%$，但短的长度几乎没有机会累积高分。例如，使用 BLOSUM$62$ 矩阵，像 `METALA` 这样的肽段的得分将是 $5+5+1+4+1+4 = 20$。让我们假设原始得分为 $S_{\\text{short}}$。鉴于一个全面的蛋白质数据库，搜索空间 $mn$ 非常大（通常是数十亿个残基）。在公式 $E = Kmn e^{-\\lambda S_{\\text{short}}}$ 中，当 $S_{\\text{short}}$ 很小时，大的 $mn$ 项会主导 $e^{-\\lambda S_{\\text{short}}}$ 项。因此，E-value 会很大（在这种情况下，$E > 1$），这表明预计会有一个或多个这样的匹配纯粹由随机机会产生。因此，这个结果不具有统计显著性。\n\n(ii) 一个长度为 $50$ 个氨基酸、一致性 $30\\%$、$E  10^{-10}$ 的有空位比对：\n这个比对要长得多。尽管百分比一致性很低（$30\\%$），但比对得分 $S_{\\text{long}}$ 是在所有 $50$ 个位置上计算的。这包括来自 $30\\% \\times 50 = 15$ 个相同残基的正分，可能来自其他 $35$ 个位置上保守替换的正分，以及来自非保守替换和空位罚分的负分。在一段很长的序列上，即使是一个微弱但一致的关联信号也可以累积成一个非常高的总分 $S_{\\text{long}}$，使得 $S_{\\text{long}} \\gg S_{\\text{short}}$。由于 E-value 公式中的指数项 $e^{-\\lambda S}$，一个大的得分 $S_{\\text{long}}$ 会导致一个指数级小的（因此非常显著的）E-value。$E  10^{-10}$ 这个值表明观测到的比对极不可能是随机发生的。\n\n核心原则是，比对长度提供了统计功效，用以区分一个真实的、尽管是远源的同源关系与随机背景噪音。\n\n现在，我们来评估每个选项：\n\nA. 期望值（E-value）定义为在整个数据库中，随机情况下可能出现的得分不低于观测得分的比对的预期数量；长度为 $6$ 的短精确片段在一个大型蛋白质数据库中预计会随机出现多次，而一个 $50$ 个残基的比对（即使只有 $30\\%$ 的一致性）可以累积得到高得多的比对得分，因此在极值分布下，其出现的可能性呈指数级降低，从而得到一个非常小的 $E$ 值。\n这个陈述是一个精确且完整的解释。它正确地定义了 E-value。它准确地描述了为什么一个短的 6-mer 的 E-value 很差（低分无法克服巨大的搜索空间，使其成为一个统计上预期的随机事件）。它正确地指出，一个 50 个残基的长比对可以累积一个高得多的分数，由于统计的指数性质（基于局部比对得分的极值分布），这会导出一个非常小的 E-value。\n结论：**正确**。\n\nB. 期望值（E-value）仅仅是百分比一致性的一个转换，因此较低的百分比一致性（例如 $30\\%$）总是意味着比更高的百分比一致性（例如，在 $6$ 个残基上有 $100\\%$）有更小的 $E$ 值，而与比对长度或数据库大小无关。\n这个陈述有根本性的错误。E-value 不是百分比一致性的简单转换；它是比对得分 $S$ 和搜索空间大小 $mn$ 的函数。比对长度是一个关键因素，正如问题本身所展示的。一个具有 $100\\%$ 一致性的短比对可能不显著，而一个具有低一致性的长比对可能非常显著。声称较低的百分比一致性*总是*意味着较小的 E-value 是错误的，而忽略比对长度和数据库大小是一个严重的错误。\n结论：**不正确**。\n\nC. 无论其他因素如何，空位总会降低期望值（E-value），因此任何有空位的比对本质上都比任何无空位的精确匹配更具统计显著性。\n这个陈述的逻辑是颠倒的。空位是会被罚分的，这意味着它们会*降低*比对得分 $S$。根据公式 $E = Kmn e^{-\\lambda S}$，$S$ 的降低会导致 E-value 的*增加*，使得比对的显著性降低。引入空位的目的是为了获得一个更好的整体比对路径，从而得到比没有空位时更高的得分，但空位本身对得分是不利的。声称任何有空位的比对本质上都比任何无空位的比对更显著，这显然是错误的。\n结论：**不正确**。\n\nD. 大于 $1$ 的期望值（E-value）必然表示打分矩阵失效；选择一个不同的替换矩阵会自动使任何精确匹配（即使长度为 $6$）都比任何更长、一致性更低的比对更显著。\n这个陈述是不正确的。大于 $1$ 的 E-value 并不表示打分矩阵“失效”。相反，它表明统计框架正在正常工作，将一个比对标记为与随机机会一致。没有哪个标准的替换矩阵可以“自动”使一个短的、低分的匹配比一个长的、高分的匹配更显著，因为这将违反序列比较的统计学原理。统计显著性从根本上与比对的信息含量（反映在其得分中）相关，而对于一个短的匹配来说，其信息含量很低。\n结论：**不正确**。\n\nE. 短的精确匹配仅仅因为低复杂性区域屏蔽而被降权，而更长的比对逃脱了这种过滤，因此后者总是更显著，与数据库大小或打分考虑无关。\n这个解释既不充分也不完整。低复杂性区域屏蔽是针对有偏向性组成区域（例如，多聚丙氨酸序列）的一种特定过滤器，它可能适用于也可能不适用于给定的 $6$ 个残基的匹配。任何短匹配显著性低下的根本原因在于其相对于数据库大小而言潜在得分较低，这一原则即使对非低复杂性序列也适用。此外，声称显著性“与数据库大小或打分考虑无关”是明显错误的；这些正是 E-value 的主要决定因素。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2387464"}]}