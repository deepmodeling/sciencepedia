{"hands_on_practices": [{"introduction": "序列比对的核心是量化两条序列的相似度，这需要一个明确的评分系统。本练习将带你完成一项基本任务：使用一个标准的替换矩阵（如BLOSUM62）和一个线性罚分来计算一个给定比对的总分。通过这个实践[@problem_id:2136014]，你将掌握序列比对算法背后的基本算术，这是理解更复杂工具如何运作的第一步。", "problem": "在生物信息学领域，序列比对是一种基本方法，用于比较蛋白质或核苷酸序列，以识别可能因功能、结构或进化关系而产生的相似区域。比对的质量通过一个分数来量化，该分数是使用替换矩阵和空位罚分计算得出的。\n\n考虑以下两条短肽序列 Seq1 和 Seq2 的有空位的比对：\n\nSeq1: `F E S A G K D E`\nSeq2: `F R S - G K T E`\n\n请使用 BLOcks SUbstitution Matrix 62 (BLOSUM62) 和线性空位罚分来计算总比对分数。线性空位罚分意味着每个用连字符（`-`）表示的空位字符都会产生一个固定的负分，无论其长度或位置如何。对于本题，线性空位罚分为 $-8$。\n\n来自 BLOSUM62 矩阵的相关替换分数如下所示：\n- 分数(F, F) = 6\n- 分数(E, R) = 0\n- 分数(S, S) = 4\n- 分数(G, G) = 6\n- 分数(K, K) = 5\n- 分数(D, T) = -1\n- 分数(E, E) = 5\n\n请以整数形式提供总分数。", "solution": "使用替换矩阵和线性空位罚分的比对分数，是通过将每对对齐残基的替换分数求和，并加上每个空位字符的罚分来计算的。设 $s(x,y)$ 表示 BLOSUM62 替换分数，线性空位罚分为每个空位字符 $g=-8$。\n\n对于给定的跨越 8 个列的比对，各部分的贡献分数如下：\n$$\ns(F,F)=6,\\quad s(E,R)=0,\\quad s(S,S)=4,\\quad \\text{gap}=g=-8,\\quad s(G,G)=6,\\quad s(K,K)=5,\\quad s(D,T)=-1,\\quad s(E,E)=5.\n$$\n\n因此，总比对分数 $S$ 为\n$$\nS=6+0+4+(-8)+6+5+(-1)+5=17.\n$$", "answer": "$$\\boxed{17}$$", "id": "2136014"}, {"introduction": "替换矩阵中的分值并非随意设定，它们反映了深刻的进化和生物化学原理。此练习[@problem_id:2136035]将揭示这些分数是如何从真实的蛋白质比对数据中通过对数几率比（log-odds ratio）公式计算得出的。你将为一个假设的、针对特定细胞环境的“CytoBLOSUM”矩阵计算一个关键分值，从而理解矩阵分数如何反映特定生物学背景下的进化压力。", "problem": "一个计算生物学家团队正在开发一种名为“CytoBLOSUM”的特殊替换矩阵。该矩阵旨在用于精确比对已知仅存在于细胞胞质溶胶这种高度还原性环境中的蛋白质序列。该矩阵的推导遵循与广泛使用的BLOSUM（Blocks Substitution Matrix）系列矩阵相同的基本原理。\n\n在此类矩阵中，用氨基酸 $j$ 替换氨基酸 $i$ 的得分（$S_{ij}$）由观测频率与期望频率的对数优势比决定。该得分使用以下公式计算：\n$$S_{ij} = \\frac{2}{\\ln(2)} \\ln\\left(\\frac{p_{ij}}{q_i q_j}\\right)$$\n此处，$p_{ij}$ 代表在源蛋白质块中比对出现的氨基酸对 $(i, j)$ 的观测频率，而 $q_i$ 和 $q_j$ 是数据集中氨基酸 $i$ 和 $j$ 的各自背景频率。缩放因子 $\\frac{2}{\\ln(2)}$ 用于将最终得分以“半比特”为单位表示。\n\n你的任务是计算这个新的CytoBLOSUM矩阵中氨基酸半胱氨酸（Cys）的自我比对得分。半胱氨酸在生物化学上以其形成结构性二硫键的能力而闻名，这一过程主要发生在胞质溶胶外部的氧化性环境中。该团队对胞质溶胶蛋白质比对数据的频率分析得出了以下关于半胱氨酸的值：\n- 半胱氨酸（Cys）的背景频率，$q_{C,cyto} = 0.018$\n- Cys-Cys的观测配对频率，$p_{CC,cyto} = 0.0010$\n\n使用所提供的公式和数据，计算CytoBLOSUM矩阵的Cys-Cys对角线得分（$S_{CC}$）。将最终答案四舍五入到三位有效数字。", "solution": "替换得分定义为经缩放的对数优势比：\n$$S_{ij} = \\frac{2}{\\ln(2)} \\ln\\left(\\frac{p_{ij}}{q_{i} q_{j}}\\right).$$\n对于Cys-Cys对角线项，设 $i=j=C$，得到\n$$S_{CC} = \\frac{2}{\\ln(2)} \\ln\\left(\\frac{p_{CC}}{q_{C}^{2}}\\right).$$\n代入给定的频率 $p_{CC} = 0.0010$ 和 $q_{C} = 0.018$：\n$$q_{C}^{2} = (0.018)^{2} = 0.000324,$$\n$$\\frac{p_{CC}}{q_{C}^{2}} = \\frac{0.0010}{0.000324} = \\frac{1000}{324} = \\frac{250}{81}.$$\n因此，\n$$S_{CC} = \\frac{2}{\\ln(2)} \\ln\\left(\\frac{250}{81}\\right).$$\n为求数值，\n$$\\ln\\left(\\frac{250}{81}\\right) \\approx \\ln(3.086419753) \\approx 1.127011775,$$\n$$\\frac{2}{\\ln 2} \\approx 2.885390082,$$\n所以\n$$S_{CC} \\approx 2.885390082 \\times 1.127011775 \\approx 3.251868564.$$\n四舍五入到三位有效数字，Cys-Cys得分为 $3.25$（单位为半比特）。", "answer": "$$\\boxed{3.25}$$", "id": "2136035"}, {"introduction": "除了从进化数据中派生，我们还可以根据氨基酸的物理化学性质从头设计替换矩阵。这个高级练习[@problem_id:2432240]将指导你构建一个全新的评分系统，其分数$S(a,b)$不依赖于观测频率，而是基于氨基酸的疏水性$h(a)$差异。通过这种方式，你将探索如何将基本的生物物理模型融入序列比对中，为特定研究问题创建定制化的分析工具。", "problem": "给定一个简化的氨基酸字母表 $\\{A, V, I, D, K\\}$，其在 Kyte–Doolittle 疏水性标度上的疏水性值为 $h(a)$：$h(A)=1.8$，$h(V)=4.2$，$h(I)=4.5$，$h(D)=-3.5$，$h(K)=-3.9$。假设背景（独立）氨基酸频率为 $p(A)=0.30$，$p(V)=0.25$，$p(I)=0.20$，$p(D)=0.15$，$p(K)=0.10$。考虑一个由以下公式定义的目标比对残基对的联合分布\n$$\nP(a,b) \\;=\\; \\frac{1}{Z}\\,p(a)\\,p(b)\\,\\exp\\!\\big(-\\beta\\,|h(a)-h(b)|\\big),\n$$\n其中 $\\beta=0.5$，$Z$ 是唯一的归一化常数，使得 $\\sum_{a}\\sum_{b} P(a,b)=1$。将替换分数以自然对数几率单位（nats）定义为\n$$\nS(a,b)\\;=\\;\\ln\\!\\left(\\frac{P(a,b)}{p(a)\\,p(b)}\\right).\n$$\n计算该模型所隐含的替换分数 $S(V,I)$。使用自然对数，并将您的最终答案四舍五入到 4 位有效数字。将结果表示为一个纯数字（不包含单位）。", "solution": "首先对问题进行验证。\n\n步骤 1：提取已知条件\n-   简化的氨基酸字母表：$\\{A, V, I, D, K\\}$。\n-   Kyte–Doolittle 疏水性标度上的疏水性值 $h(a)$：$h(A)=1.8$，$h(V)=4.2$，$h(I)=4.5$，$h(D)=-3.5$，$h(K)=-3.9$。\n-   背景氨基酸频率：$p(A)=0.30$，$p(V)=0.25$，$p(I)=0.20$，$p(D)=0.15$，$p(K)=0.10$。\n-   目标联合分布：$P(a,b) = \\frac{1}{Z}\\,p(a)\\,p(b)\\,\\exp(-\\beta\\,|h(a)-h(b)|)$。\n-   参数：$\\beta=0.5$。\n-   归一化常数 $Z$：$\\sum_{a}\\sum_{b} P(a,b)=1$。\n-   替换分数定义：$S(a,b) = \\ln\\left(\\frac{P(a,b)}{p(a)\\,p(b)}\\right)$。\n-   任务：计算替换分数 $S(V,I)$。\n-   说明：使用自然对数，并将最终答案四舍五入到 4 位有效数字。\n\n步骤 2：使用提取的已知条件进行验证\n-   该问题具有科学依据。联合概率和对数几率替换分数的定义在计算生物学和生物信息学中是标准定义。使用带有物理性质（疏水性）的类玻尔兹曼因子是一种有效的建模技术。\n-   该问题是适定的且自洽的。所有必要的数据，包括字母表、疏水性值、频率和参数 $\\beta$ 都已提供。给定频率的总和为 $0.30+0.25+0.20+0.15+0.10 = 1.00$，这是一致的。定义是精确且无歧义的。\n-   该问题是客观的，以纯数学术语陈述，不含主观或推测性内容。\n\n步骤 3：结论与行动\n该问题有效。将提供解答。\n\n替换分数 $S(a,b)$ 以 nats（自然对数几率单位）定义为：\n$$\nS(a,b) = \\ln\\left(\\frac{P(a,b)}{p(a)\\,p(b)}\\right)\n$$\n我们已知联合概率 $P(a,b)$ 的模型为：\n$$\nP(a,b) = \\frac{1}{Z}\\,p(a)\\,p(b)\\,\\exp(-\\beta\\,|h(a)-h(b)|)\n$$\n其中 $Z$ 是一个归一化常数。将 $P(a,b)$ 的表达式代入 $S(a,b)$ 的定义中，得到：\n$$\nS(a,b) = \\ln\\left(\\frac{\\frac{1}{Z}\\,p(a)\\,p(b)\\,\\exp(-\\beta\\,|h(a)-h(b)|)}{p(a)\\,p(b)}\\right)\n$$\n分子和分母中的背景频率 $p(a)$ 和 $p(b)$ 相互抵消，这极大地简化了表达式：\n$$\nS(a,b) = \\ln\\left(\\frac{1}{Z}\\,\\exp(-\\beta\\,|h(a)-h(b)|)\\right)\n$$\n使用对数的性质 $\\ln(x y) = \\ln(x)+\\ln(y)$ 和 $\\ln(1/x) = -\\ln(x)$，我们得到：\n$$\nS(a,b) = \\ln\\left(\\frac{1}{Z}\\right) + \\ln\\left(\\exp(-\\beta\\,|h(a)-h(b)|)\\right) = -\\ln(Z) - \\beta\\,|h(a)-h(b)|\n$$\n为了计算 $S(V,I)$，我们必须首先确定归一化常数 $Z$ 的值。根据定义，所有概率的总和必须为 $1$：\n$$\n\\sum_{a,b \\in \\mathcal{A}} P(a,b) = \\sum_{a,b \\in \\mathcal{A}} \\frac{1}{Z}\\,p(a)\\,p(b)\\,\\exp(-\\beta\\,|h(a)-h(b)|) = 1\n$$\n其中 $\\mathcal{A} = \\{A, V, I, D, K\\}$。解出 $Z$ 得到：\n$$\nZ = \\sum_{a,b \\in \\mathcal{A}} p(a)\\,p(b)\\,\\exp(-\\beta\\,|h(a)-h(b)|)\n$$\n这是一个对简化的字母表中所有 $5 \\times 5 = 25$ 对氨基酸的双重求和。该和可以分为对角项 ($a=b$) 和非对角项 ($a \\neq b$)。由于 $|h(a)-h(b)| = |h(b)-h(a)|$，项矩阵是对称的。我们可以写成：\n$$\nZ = \\sum_{a \\in \\mathcal{A}} p(a)^2\\exp(-\\beta|h(a)-h(a)|) + \\sum_{a \\neq b} p(a)p(b)\\exp(-\\beta|h(a)-h(b)|)\n$$\n由于 $|h(a)-h(a)| = 0$，$\\exp(0)=1$，所以第一项简化为 $\\sum_{a \\in \\mathcal{A}} p(a)^2$。\n对角项的和为：\n$$\np(A)^2 + p(V)^2 + p(I)^2 + p(D)^2 + p(K)^2 = (0.30)^2 + (0.25)^2 + (0.20)^2 + (0.15)^2 + (0.10)^2\n$$\n$$\n= 0.09 + 0.0625 + 0.04 + 0.0225 + 0.01 = 0.225\n$$\n非对角项是对每一对 $a \\neq b$ 的 $(a,b)$ 计算的。更有效的方法是对 $a$ 在某个排序（例如，字母顺序）中先于 $b$ 的对进行求和，然后乘以 $2$。\n所需的疏水性差异 $|h(a)-h(b)|$ 和指数项 $\\exp(-0.5|h(a)-h(b)|)$ 如下：\n- $|h(A)-h(V)| = |1.8 - 4.2| = 2.4 \\implies \\exp(-1.2)$\n- $|h(A)-h(I)| = |1.8 - 4.5| = 2.7 \\implies \\exp(-1.35)$\n- $|h(A)-h(D)| = |1.8 - (-3.5)| = 5.3 \\implies \\exp(-2.65)$\n- $|h(A)-h(K)| = |1.8 - (-3.9)| = 5.7 \\implies \\exp(-2.85)$\n- $|h(V)-h(I)| = |4.2 - 4.5| = 0.3 \\implies \\exp(-0.15)$\n- $|h(V)-h(D)| = |4.2 - (-3.5)| = 7.7 \\implies \\exp(-3.85)$\n- $|h(V)-h(K)| = |4.2 - (-3.9)| = 8.1 \\implies \\exp(-4.05)$\n- $|h(I)-h(D)| = |4.5 - (-3.5)| = 8.0 \\implies \\exp(-4.0)$\n- $|h(I)-h(K)| = |4.5 - (-3.9)| = 8.4 \\implies \\exp(-4.2)$\n- $|h(D)-h(K)| = |-3.5 - (-3.9)| = 0.4 \\implies \\exp(-0.2)$\n\n非对角项的和为 $2 \\sum_{a<b} p(a)p(b)\\exp(-0.5|h(a)-h(b)|)$：\n$2 \\times [ p(A)p(V)\\exp(-1.2) + p(A)p(I)\\exp(-1.35) + p(A)p(D)\\exp(-2.65) + p(A)p(K)\\exp(-2.85) + p(V)p(I)\\exp(-0.15) + p(V)p(D)\\exp(-3.85) + p(V)p(K)\\exp(-4.05) + p(I)p(D)\\exp(-4.0) + p(I)p(K)\\exp(-4.2) + p(D)p(K)\\exp(-0.2) ]$\n$= 2 \\times [ (0.3)(0.25)\\exp(-1.2) + (0.3)(0.2)\\exp(-1.35) + (0.3)(0.15)\\exp(-2.65) + (0.3)(0.1)\\exp(-2.85) + (0.25)(0.2)\\exp(-0.15) + (0.25)(0.15)\\exp(-3.85) + (0.25)(0.1)\\exp(-4.05) + (0.2)(0.15)\\exp(-4.0) + (0.2)(0.1)\\exp(-4.2) + (0.15)(0.1)\\exp(-0.2) ]$\n$= 2 \\times [ 0.075(0.30119) + 0.06(0.25924) + 0.045(0.07065) + 0.03(0.05785) + 0.05(0.86071) + 0.0375(0.02128) + 0.025(0.01742) + 0.03(0.01832) + 0.02(0.01500) + 0.015(0.81873) ]$\n$= 2 \\times [ 0.022589 + 0.015554 + 0.003179 + 0.001736 + 0.043036 + 0.000798 + 0.000436 + 0.000550 + 0.000300 + 0.012281 ]$\n$= 2 \\times [ 0.100459 ] = 0.200918$\n\n现在，我们通过将对角项和非对角项的贡献相加来计算 $Z$：\n$$\nZ = 0.225 + 0.200918 = 0.425918\n$$\n计算出 $Z$ 后，我们就可以求出 $S(V,I)$。我们需要这对氨基酸的具体疏水性差异：\n$$\n|h(V)-h(I)| = |4.2 - 4.5| = 0.3\n$$\n参数 $\\beta$ 的值为 $0.5$。因此，分数方程中的第二项是：\n$$\n\\beta|h(V)-h(I)| = 0.5 \\times 0.3 = 0.15\n$$\n第一项是 $-\\ln(Z)$：\n$$\n-\\ln(Z) = -\\ln(0.425918) \\approx -(-0.853467) = 0.853467\n$$\n最后，我们计算 $(V,I)$ 的替换分数：\n$$\nS(V,I) = -\\ln(Z) - \\beta|h(V)-h(I)| \\approx 0.853467 - 0.15 = 0.703467\n$$\n问题要求将答案四舍五入到 $4$ 位有效数字。\n$$\nS(V,I) \\approx 0.7035\n$$\n这个结果是正数，表明在该模型下，缬氨酸 (Valine, $V$) 和异亮氨酸 (Isoleucine, $I$) 之间的替换比随机预期的可能性更大，这与它们相似的疏水特性是一致的。", "answer": "$$\n\\boxed{0.7035}\n$$", "id": "2432240"}]}