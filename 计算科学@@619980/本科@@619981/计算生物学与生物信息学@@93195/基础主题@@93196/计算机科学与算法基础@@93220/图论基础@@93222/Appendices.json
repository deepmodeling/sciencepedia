{"hands_on_practices": [{"introduction": "在我们分析生物网络之前，必须首先决定如何在计算机内存中存储它们。这一选择对性能和可扩展性具有重大的实际影响，尤其是在处理大规模基因组数据时。本练习 [@problem_id:2395757] 将引导您对两种基本数据结构——邻接矩阵和邻接表——进行定量比较，以在一个真实的生物信息学场景中理解它们各自的优劣权衡。", "problem": "一个关于 $20000$ 个基因的基因共表达网络被建模为一个平均度为 $15$ 的简单、无向、无权图。考虑两种标准的图表示法用于内存存储：\n\n1. 邻接矩阵，以稠密布尔矩阵的形式存储，其中 $n \\times n$ 个条目（包括对角线）中的每一个都恰好使用 $1$ 比特。\n2. 邻接表，其中每个存储的邻居索引是一个 $32$ 位整数；对于一个无向图，每条边贡献恰好 $2$ 个存储的邻居索引（每个端点的列表中一个）。忽略除这些存储的索引之外的任何额外的数据结构开销。\n\n设 $R$ 表示该网络中邻接矩阵表示法所需的总比特数与邻接表表示法所需的总比特数之比。以单个最简分数的形式计算 $R$ 的精确值。以单个分数形式提供您的答案，不带单位。不要四舍五入。", "solution": "我们将基因共表达网络建模为一个具有 $n$ 个节点和平均度 $\\bar{d}$ 的简单、无向、无权图。在这样的图中，边数 $m$ 可由握手引理得出。该引理指出，所有顶点的度数之和等于边数的两倍。因此，\n$$\n\\sum_{v} \\deg(v) \\;=\\; n \\,\\bar{d} \\;=\\; 2m \\;\\;\\Rightarrow\\;\\; m \\;=\\; \\frac{n\\,\\bar{d}}{2}.\n$$\n对于给定的网络，有 $n = 20000$ 和 $\\bar{d} = 15$，所以\n$$\nm \\;=\\; \\frac{20000 \\times 15}{2} \\;=\\; 150000.\n$$\n\n接下来，根据所述假设计算每种表示方法所需的内存（以比特为单位）。\n\n1. 邻接矩阵：一个稠密的布尔矩阵为所有 $n \\times n$ 个条目（包括对角线）的每个条目存储 $1$ 比特。因此，总比特数为\n$$\n\\text{bits}_{\\text{matrix}} \\;=\\; n^{2} \\;=\\; 20000^{2} \\;=\\; 400000000.\n$$\n\n2. 邻接表：每条无向边贡献两个存储的邻居索引，每个索引是一个 $32$ 位整数。因此，总比特数为\n$$\n\\text{bits}_{\\text{list}} \\;=\\; (2m) \\times 32 \\;=\\; 2 \\times 150000 \\times 32 \\;=\\; 9600000.\n$$\n\n所求的比率 $R$ 是\n$$\nR \\;=\\; \\frac{\\text{bits}_{\\text{matrix}}}{\\text{bits}_{\\text{list}}}\n\\;=\\; \\frac{400000000}{9600000}.\n$$\n化简该分数：\n$$\n\\frac{400000000}{9600000}\n\\;=\\; \\frac{4000}{96}\n\\;=\\; \\frac{250}{6}\n\\;=\\; \\frac{125}{3}.\n$$\n\n因此，精确的比率为\n$$\nR \\;=\\; \\frac{125}{3}.\n$$", "answer": "$$\\boxed{\\frac{125}{3}}$$", "id": "2395757"}, {"introduction": "生物网络通常包含执行特定功能的重复模式，即“网络基序”（motifs）。一个常见的基序是主调节因子，即单个基因控制许多其他基因的表达。通过分析这些基序的结构特性，我们可以洞察其组织原则。这个实践问题 [@problem_id:2395829] 要求您量化一个主调节因子网络中的度异质性，从而将一个生物学概念与一个基本的图统计量联系起来。", "problem": "一个基因调控网络 (Gene Regulatory Network, GRN) 被建模为一个有向图，其中节点代表基因，有向边代表一个基因对另一个基因的调控影响。考虑一个包含一个主调控基因和 $N$ 个靶基因的 GRN，总共有 $N+1$ 个基因。主调控基因到每个靶基因都有一条出向的调控边，图中没有自环，且 $N$ 个靶基因之间没有调控边。该网络使用出邻居的邻接表来表示：对于每个基因（节点）$v$，其邻接表包含所有被 $v$ 通过从 $v$ 指向它们的有向边所调控的基因。\n\n将每个节点邻接表的大小视为该节点的出度 $\\deg^{+}$。对于所有 $N+1$ 个节点，令 $\\sigma^{2}$ 表示邻接表大小的总体方差。请以 $N$ 的闭式解析表达式给出 $\\sigma^{2}$。答案无需四舍五入，也无需单位。", "solution": "首先将对所提供的问题进行严格验证。\n\n步骤 1：提取已知条件。\n问题陈述提供了以下信息：\n- 一个基因调控网络 (GRN) 被建模为一个有向图。\n- 图中节点（基因）的总数为 $N+1$。\n- 节点集由一个主调控基因和 $N$ 个靶基因组成。\n- 主调控基因到每个靶基因都有一条有向边。\n- 没有自环，即没有节点有指向自身的边。\n- $N$ 个靶基因之间没有边。\n- 该网络由每个节点的出邻居邻接表表示。\n- 节点的邻接表大小定义为其出度，记为 $\\deg^{+}$。\n- 变量 $\\sigma^{2}$ 代表所有 $N+1$ 个节点的出度（$\\deg^{+}$）的总体方差。\n- 目标是推导出一个关于 $N$ 的 $\\sigma^{2}$ 的闭式解析表达式。\n\n步骤 2：使用提取的已知条件进行验证。\n根据既定标准对问题进行评估：\n- **科学基础**：将 GRN 表示为有向图是计算生物学和系统生物学中一个基础且广泛使用的模型。所描述的特定结构，即一个主调控基因控制多个靶标，代表了一种常见的网络基序，称为单输入模块 (Single-Input Module, SIM)。这是一个科学上有效的简化。\n- **良态问题**：该问题以数学精度进行了规定。图的结构被明确定义，待计算的量（$\\sigma^{2}$）是一个标准的统计度量，且提供了足够的信息来推导出唯一解。\n- **客观性**：问题以客观、正式的语言陈述，没有任何主观或非科学的主张。\n\n基于此分析，该问题被认定为有效。这是一个定义明确的数学问题，其基础是生物信息学中的一个标准模型。没有矛盾、歧义或事实不准确之处。\n\n步骤 3：进行求解。\n一个包含 $M$ 个值 $\\{x_1, x_2, \\ldots, x_M\\}$ 的集合的总体方差 $\\sigma^{2}$ 由以下公式给出：\n$$ \\sigma^{2} = \\frac{1}{M} \\sum_{i=1}^{M} (x_i - \\mu)^{2} $$\n其中 $\\mu$ 是总体均值，定义为：\n$$ \\mu = \\frac{1}{M} \\sum_{i=1}^{M} x_i $$\n一个等价且通常计算上更简单的方差公式是：\n$$ \\sigma^{2} = \\left( \\frac{1}{M} \\sum_{i=1}^{M} x_i^{2} \\right) - \\mu^{2} $$\n\n在此问题中，总体由图中 $N+1$ 个节点的出度 $\\deg^{+}$ 组成。因此，我们的总体大小为 $M = N+1$。我们必须首先确定每个节点的出度。\n\n设节点集为 $V$。该集合由一个主调控基因（我们称之为 $v_m$）和 $N$ 个靶基因 $\\{v_{t_1}, v_{t_2}, \\ldots, v_{t_N}\\}$ 组成。\n\n1.  **主调控基因 ($v_m$) 的出度**：问题陈述，主调控基因到每个 $N$ 个靶基因都有一条出向的调控边。出度是出向边的数量。因此，$\\deg^{+}(v_m) = N$。\n\n2.  **靶基因 ($v_{t_j}$) 的出度**：问题陈述，$N$ 个靶基因之间没有调控边。这也暗示了靶基因不调控主调控基因，因为没有提及此类边。出度是出邻居邻接表的大小。由于在此模型中靶基因不调控任何其他基因，它们的邻接表是空的。因此，对于所有 $j \\in \\{1, 2, \\ldots, N\\}$，它们的出度为 $\\deg^{+}(v_{t_j}) = 0$。\n\n出度的总体是集合 $\\{N, 0, 0, \\ldots, 0\\}$，其中包含一个值 $N$ 和 $N$ 个值 $0$。值的总数是 $N+1$。\n\n首先，我们计算平均出度 $\\mu$。\n所有出度的总和是：\n$$ \\sum_{v \\in V} \\deg^{+}(v) = \\deg^{+}(v_m) + \\sum_{j=1}^{N} \\deg^{+}(v_{t_j}) = N + \\sum_{j=1}^{N} 0 = N $$\n均值是此总和除以节点总数 $N+1$：\n$$ \\mu = \\frac{N}{N+1} $$\n\n接下来，我们计算出度的平方的均值。出度的平方集是 $\\{N^{2}, 0^{2}, 0^{2}, \\ldots, 0^{2}\\}$，即 $\\{N^{2}, 0, 0, \\ldots, 0\\}$。\n出度的平方和是：\n$$ \\sum_{v \\in V} (\\deg^{+}(v))^{2} = (\\deg^{+}(v_m))^{2} + \\sum_{j=1}^{N} (\\deg^{+}(v_{t_j}))^{2} = N^{2} + \\sum_{j=1}^{N} 0 = N^{2} $$\n平方的均值是此总和除以 $N+1$：\n$$ \\frac{1}{N+1} \\sum_{v \\in V} (\\deg^{+}(v))^{2} = \\frac{N^{2}}{N+1} $$\n\n最后，我们使用方差公式 $\\sigma^{2} = (\\text{平方的均值}) - (\\text{均值的平方})$：\n$$ \\sigma^{2} = \\frac{N^{2}}{N+1} - \\left(\\frac{N}{N+1}\\right)^{2} $$\n$$ \\sigma^{2} = \\frac{N^{2}}{N+1} - \\frac{N^{2}}{(N+1)^{2}} $$\n为了合并这些项，我们进行通分：\n$$ \\sigma^{2} = \\frac{N^{2}(N+1)}{(N+1)^{2}} - \\frac{N^{2}}{(N+1)^{2}} $$\n$$ \\sigma^{2} = \\frac{N^{2}(N+1) - N^{2}}{(N+1)^{2}} $$\n从分子中提取因子 $N^{2}$：\n$$ \\sigma^{2} = \\frac{N^{2}((N+1) - 1)}{(N+1)^{2}} $$\n$$ \\sigma^{2} = \\frac{N^{2}(N)}{(N+1)^{2}} $$\n$$ \\sigma^{2} = \\frac{N^{3}}{(N+1)^{2}} $$\n这就是出度总体方差的闭式表达式。", "answer": "$$ \\boxed{\\frac{N^{3}}{(N+1)^{2}}} $$", "id": "2395829"}, {"introduction": "构建一个有效的图模型既是一门艺术，也是一门科学，需要仔细决定包含什么和排除什么。在代谢网络中，如何处理像水（$\\mathrm{H_2O}$）这样无处不在的小分子，即“通用代谢物”（currency metabolites），就是这种挑战的一个典型例子。这个问题 [@problem_id:2395779] 探讨了这一建模选择在拓扑结构上带来的后果，揭示了看似微小的决定如何能显著改变网络属性，并可能掩盖我们旨在研究的生物学通路。", "problem": "您正在根据一个经过整理的生化反应列表构建一个代谢网络。考虑从同一反应集合构建的两种常见图表示，二者都忽略化学计量系数，合并平行边并移除自环。\n\n表示M（代谢物有向投影）：图为 $G=(V,E)$，其中 $V$ 是代谢物集合。对于每个反应，从每个底物代谢物向每个产物代谢物添加一条有向边。\n\n表示B（代谢物-反应二分图）：图为 $G=(V_M \\cup V_R,E)$，其中 $V_M$ 是代谢物集合，$V_R$ 是反应集合。如果一个 $V_M$ 中的代谢物参与了 $V_R$ 中的某个反应（无论作为反应物还是产物），就在它们之间添加一条无向边。\n\n您必须决定是否将水（$\\mathrm{H_2O}$）作为一个节点包含在内。\n\n关于包含$\\mathrm{H_2O}$及其所产生的度的后果，以下哪个陈述是正确的？选择所有适用项。\n\nA. 在表示M中，将$\\mathrm{H_2O}$作为一个顶点包含进来，通常会使其获得一个非常大的总度 $k$（入度和出度之和），常常使其成为度中心性排名最高的枢纽节点。\n\nB. 在表示M中，由于合并了平行边并移除了自环，包含$\\mathrm{H_2O}$不会改变任何不同于$\\mathrm{H_2O}$的代谢物对之间的最短路径长度。\n\nC. 将$\\mathrm{H_2O}$视为一种“通用代谢物”(currency metabolite)并在构建表示M之前将其排除，可以减少人为的捷径和枢纽膨胀，从而得到一个更能反映通路特异性连接性的拓扑结构。\n\nD. 在表示B中，$\\mathrm{H_2O}$的度 $k$ 等于它所参与的反应数量。\n\nE. 在表示M或表示B中，质量平衡意味着$\\mathrm{H_2O}$的净度必须为 $k=0$。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知信息**\n- 定义了从一组生化反应派生出的代谢网络的两种图表示：\n    1.  **表示M（代谢物有向投影）**：一个有向图 $G=(V, E)$，其中 $V$ 是代谢物集合。对于每个反应，从每个底物向每个产物添加一条有向边。\n    2.  **表示B（代谢物-反应二分图）**：一个无向图 $G=(V_M \\cup V_R, E)$，其中 $V_M$ 是代谢物集合，$V_R$ 是反应集合。如果 $V_M$ 中的一个代谢物参与了 $V_R$ 中的一个反应，则在它们之间连接一条边。\n- **两种表示的通用规则**：忽略化学计量系数，合并平行边，并移除自环。\n- **核心问题**涉及将水（$\\mathrm{H_2O}$）作为节点包含在这些图中对拓扑结构产生的影响。\n\n**步骤2：验证问题陈述**\n- 该问题具有科学依据。所描述的图表示是系统生物学和生物信息学中分析代谢网络的标准模型。像$\\mathrm{H_2O}$这样的“通用代谢物”的角色及其对网络拓扑的影响是已有深入研究的课题。\n- 该问题是适定（well-posed）的。图的构建规则被明确无误地陈述。问题要求基于这些规则通过逻辑推导来评估各个陈述。\n- 该问题是客观的，并使用了精确、形式化的语言。它没有事实错误、矛盾或不科学的前提。\n\n**步骤3：结论**\n问题陈述有效。可以推导出一个严谨的解。\n\n**求解推导与选项分析**\n\n**选项A分析：**\n该陈述断言，在表示M中包含$\\mathrm{H_2O}$将导致该节点具有非常大的总度 $k$，使其成为一个枢纽节点。\n在表示M中，对于任何反应，都会从所有底物向所有产物绘制有向边。水（$\\mathrm{H_2O}$）在大量水解反应中作为底物参与（例如 $A + \\mathrm{H_2O} \\rightarrow B + C$），并在众多缩合反应中作为产物出现（例如 $D + E \\rightarrow F + \\mathrm{H_2O}$）。\n- 在水解反应中，会从$\\mathrm{H_2O}$节点向每个产物代谢物绘制一条出边，这对其出度 $k_{out}$ 有贡献。\n- 在缩合反应中，会从每个底物代谢物向$\\mathrm{H_2O}$节点绘制一条入边，这对其入度 $k_{in}$ 有贡献。\n鉴于水在典型代谢网络中生化反应的普遍存在性，与$\\mathrm{H_2O}$相连的代谢物集合将异常庞大。即使在合并平行边之后，唯一邻居的数量也会很高。总度为 $k = k_{in} + k_{out}$。根据定义，度非常高的节点就是枢纽节点。度中心性是该属性的直接度量。因此，$\\mathrm{H_2O}$几乎肯定会是度最高的节点之一。\n**结论：正确。**\n\n**选项B分析：**\n该陈述声称，在表示M中包含$\\mathrm{H_2O}$不会改变其他代谢物之间的最短路径长度。这是错误的。包含枢纽节点通常会引入捷径，从而极大地缩短原本相距较远的节点之间的路径长度。\n考虑两个没有直接连接的代谢物 $X$ 和 $Y$。假设存在一个反应 $X + S_1 \\rightarrow P_1 + \\mathrm{H_2O}$，以及另一个反应 $\\mathrm{H_2O} + S_2 \\rightarrow Y + P_2$。\n- 第一个反应创建了一条有向边 $(X, \\mathrm{H_2O})$。\n- 第二个反应创建了一条有向边 $(\\mathrm{H_2O}, Y)$。\n这就建立了一条长度为2的路径 $X \\rightarrow \\mathrm{H_2O} \\rightarrow Y$。如果在不包含$\\mathrm{H_2O}$的网络中，$X$ 和 $Y$ 之间的最短路径大于2，那么包含$\\mathrm{H_2O}$就创建了一条新的、更短的路径。当包含普遍存在的代谢物时，这种捷径是很常见的。\n**结论：不正确。**\n\n**选项C分析：**\n该陈述指出，排除像$\\mathrm{H_2O}$这样的“通用代谢物”可以减少人为的拓扑特征，并更好地反映通路逻辑。\n如选项A和B的分析所示，包含$\\mathrm{H_2O}$会导致“枢纽膨胀”（创建一个巨大的中心枢纽）和“人为捷径”（创建不代表有意义的生化转化序列的短路径）。这些效应会通过连接网络中不相关的部分，从而掩盖代谢通路的特定模块化结构。例如，一个碳水化合物代谢通路可能会仅仅因为两者都涉及水合/脱水步骤而与一个脂质降解通路被人为地连接起来。在网络分析中，排除这类通用代谢物是一个标准且必要的操作，以便专注于主要底物和中间体在专用功能通路中的流动。\n**结论：正确。**\n\n**选项D分析：**\n该陈述关系到$\\mathrm{H_2O}$在表示B中的度。\n表示B是一个二分图，其顶点集包括代谢物 $V_M$ 和反应 $V_R$。如果一个代谢物节点（例如$\\mathrm{H_2O}$）参与了某个反应，那么它与该反应节点之间就有一条边。该图是无向的。\n一个节点的度是与其关联的边的数量。根据表示B的明确定义，$\\mathrm{H_2O}$节点与每个对应的反应节点之间都会创建一条边，只要该反应中$\\mathrm{H_2O}$是底物或产物。因此，$\\mathrm{H_2O}$节点的度 $k$ 精确地等于它所参与的不同反应的总数。\n**结论：正确。**\n\n**选项E分析：**\n该陈述声称质量平衡意味着$\\mathrm{H_2O}$的净度为 $k=0$。这个论点错误地将一个动态属性（流量的质量平衡）与一个静态的拓扑属性（图的度）混为一谈。\n首先，考虑表示B。它是一个无向图。$\\mathrm{H_2O}$的度 $k$ 是它参与的反应总数，这是一个非负整数，在任何实际网络中肯定不为零。“净度”（$k_{in} - k_{out}$）的概念在无向图中没有定义。\n其次，考虑表示M，一个有向图。在稳态下的代谢系统中，质量平衡要求所有产生某个内部代谢物的反应的通量之和等于所有消耗该代谢物的反应的通量之和。然而，图的度是一个连接的组合计数，而不是通量的度量。问题陈述已说明，化学计量系数被忽略，平行边被合并。\n$\\mathrm{H_2O}$的入度 $k_{in}$ 计算的是产生它的唯一底物代谢物的数量。而出度 $k_{out}$ 计算的是它帮助产生的唯一产物代谢物的数量。没有任何物理定律或数学规则要求这两个不同的组合计数相等（即 $k_{in} - k_{out} = 0$）。例如，一个系统中有一个产生水的反应（$A \\rightarrow B + \\mathrm{H_2O}$）和两个消耗水的反应（$C + \\mathrm{H_2O} \\rightarrow D$ 和 $E + \\mathrm{H_2O} \\rightarrow F$），这将导致 $k_{in} = 1$（来自节点 $A$）和 $k_{out} = 2$（到节点 $D$ 和 $F$），净度为 $1-2 = -1$。质量平衡仍然可以通过适当的反应通量来实现，而这个概念完全不存在于图的结构中。\n**结论：不正确。**", "answer": "$$\\boxed{ACD}$$", "id": "2395779"}]}