{"hands_on_practices": [{"introduction": "在生物数据分析中，我们常常会遇到一个棘手的统计现象，即辛普森悖论 (Simpson's Paradox)。当我们将数据分组分析时，会观察到某种趋势，但一旦将数据合并，这种趋势却可能减弱、消失甚至逆转。这个练习将通过一个关于基因表达的假想场景，帮助你亲手揭示这一悖论的成因，并理解在处理多组学数据时识别混杂变量（confounding variables）的重要性 [@problem_id:2418177]。", "problem": "一位计算生物学家分析单细胞RNA测序 (scRNA-seq) 数据，以评估药物治疗是否上调某个特定基因，并在一个小鼠模型中比较了两个组织。定义随机变量：$U \\in \\{\\text{up}, \\text{not}\\}$ 表示细胞中基因是否上调，$R \\in \\{\\text{trt}, \\text{ctl}\\}$ 表示细胞是否来自处理组或对照组，以及 $S \\in \\{\\mathrm{A}, \\mathrm{B}\\}$ 表示组织身份（组织 $\\mathrm{A}$ 和组织 $\\mathrm{B}$）。观察到的计数如下：\n\n- 组织 $\\mathrm{A}$，处理组：$900$ 个细胞中有 $99$ 个上调。\n- 组织 $\\mathrm{A}$，对照组：$100$ 个细胞中有 $10$ 个上调。\n- 组织 $\\mathrm{B}$，处理组：$100$ 个细胞中有 $91$ 个上调。\n- 组织 $\\mathrm{B}$，对照组：$900$ 个细胞中有 $810$ 个上调。\n\n仅使用概率公理、条件概率的定义和独立性的定义，以下哪个陈述是正确的？\n\nA. 在每个组织内部，对于 $s \\in \\{\\mathrm{A}, \\mathrm{B}\\}$ 两种情况，都有 $P(U=\\text{up} \\mid R=\\text{trt}, S=s) > P(U=\\text{up} \\mid R=\\text{ctl}, S=s)$，然而在边际上，$P(U=\\text{up} \\mid R=\\text{trt}) < P(U=\\text{up} \\mid R=\\text{ctl})$。这种逆转的发生是因为在样本中 $R$ 和 $S$ 不独立，因此全概率定律在不同的 $r \\in \\{\\text{trt}, \\text{ctl}\\}$ 上使用了不同的权重 $P(S=s \\mid R=r)$。\n\nB. 在每个组织内部，对于两种组织，都有 $P(U=\\text{up} \\mid R=\\text{trt}, S=s) < P(U=\\text{up} \\mid R=\\text{ctl}, S=s)$，但在边际上，$P(U=\\text{up} \\mid R=\\text{trt}) > P(U=\\text{up} \\mid R=\\text{ctl})$，因此不存在悖论。\n\nC. 即使 $R$ 和 $S$ 独立，条件比较和边际比较之间的逆转仍会发生，因为辛普森悖论是条件概率的一个性质，不依赖于 $S$ 的分布。\n\nD. 获得边际概率 $P(U=\\text{up} \\mid R=r)$ 的正确方法是，用相等的权重对特定组织的概率 $P(U=\\text{up} \\mid R=r, S=\\mathrm{A})$ 和 $P(U=\\text{up} \\mid R=r, S=\\mathrm{B})$ 进行平均，这保证了组织构成不能改变效应的方向。", "solution": "问题陈述是概率论中的一个有效练习。它提供了一组来自一个假设但现实的生物实验的完整且一致的数据。任务是评估关于条件概率和边际概率的陈述，这可以使用所引用的基本原理来完成。\n\n首先，我们根据提供的细胞计数来估计所需的概率。设 $U_{up}$ 表示基因上调的事件 ($U=\\text{up}$)，$R_{trt}$ 表示属于处理组的事件 ($R=\\text{trt}$)，$R_{ctl}$ 表示属于对照组的事件 ($R=\\text{ctl}$)，$S_A$ 表示来自组织 $\\mathrm{A}$ 的事件 ($S=\\mathrm{A}$)，$S_B$ 表示来自组织 $\\mathrm{B}$ 的事件 ($S=\\mathrm{B}$)。概率被估计为样本比例。\n\n每个组织（层）内上调的条件概率为：\n对于组织 $\\mathrm{A}$：\n$$P(U_{up} \\mid R_{trt}, S_A) = \\frac{\\text{在(trt, A)中上调的细胞数}}{\\text{在(trt, A)中的总细胞数}} = \\frac{99}{900} = 0.11$$\n$$P(U_{up} \\mid R_{ctl}, S_A) = \\frac{\\text{在(ctl, A)中上调的细胞数}}{\\text{在(ctl, A)中的总细胞数}} = \\frac{10}{100} = 0.10$$\n此处我们观察到 $P(U_{up} \\mid R_{trt}, S_A) > P(U_{up} \\mid R_{ctl}, S_A)$。\n\n对于组织 $\\mathrm{B}$：\n$$P(U_{up} \\mid R_{trt}, S_B) = \\frac{\\text{在(trt, B)中上调的细胞数}}{\\text{在(trt, B)中的总细胞数}} = \\frac{91}{100} = 0.91$$\n$$P(U_{up} \\mid R_{ctl}, S_B) = \\frac{\\text{在(ctl, B)中上调的细胞数}}{\\text{在(ctl, B)中的总细胞数}} = \\frac{810}{900} = 0.90$$\n此处我们观察到 $P(U_{up} \\mid R_{trt}, S_B) > P(U_{up} \\mid R_{ctl}, S_B)$。\n在两个组织中，处理都与较高的基因上调概率相关。\n\n接下来，我们计算跨两个组织汇总的上调边际概率。\n首先，我们汇总计数：\n处理组总细胞数：$N(R_{trt}) = 900 (\\text{来自 A}) + 100 (\\text{来自 B}) = 1000$。\n处理组中上调的总细胞数：$N(U_{up}, R_{trt}) = 99 (\\text{来自 A}) + 91 (\\text{来自 B}) = 190$。\n对照组总细胞数：$N(R_{ctl}) = 100 (\\text{来自 A}) + 900 (\\text{来自 B}) = 1000$。\n对照组中上调的总细胞数：$N(U_{up}, R_{ctl}) = 10 (\\text{来自 A}) + 810 (\\text{来自 B}) = 820$。\n\n边际条件概率为：\n$$P(U_{up} \\mid R_{trt}) = \\frac{N(U_{up}, R_{trt})}{N(R_{trt})} = \\frac{190}{1000} = 0.19$$\n$$P(U_{up} \\mid R_{ctl}) = \\frac{N(U_{up}, R_{ctl})}{N(R_{ctl})} = \\frac{820}{1000} = 0.82$$\n在边际上，我们观察到 $P(U_{up} \\mid R_{trt}) < P(U_{up} \\mid R_{ctl})$。关联的方向发生了逆转。这种现象被称为辛普森悖论。\n\n这种逆转的机制可以通过全概率定律来解释：\n$$P(U_{up} \\mid R=r) = P(U_{up} \\mid R=r, S_A)P(S_A \\mid R=r) + P(U_{up} \\mid R=r, S_B)P(S_B \\mid R=r)$$\n权重 $P(S=s \\mid R=r)$ 是每个处理组中各个组织的比例。\n对于处理组 ($r=\\text{trt}$)：\n$P(S_A \\mid R_{trt}) = \\frac{900}{1000} = 0.9$ 且 $P(S_B \\mid R_{trt}) = \\frac{100}{1000} = 0.1$。\n对于对照组 ($r=\\text{ctl}$)：\n$P(S_A \\mid R_{ctl}) = \\frac{100}{1000} = 0.1$ 且 $P(S_B \\mid R_{ctl}) = \\frac{900}{1000} = 0.9$。\n由于 $P(S_A \\mid R_{trt}) \\neq P(S_A \\mid R_{ctl})$，随机变量 $R$ 和 $S$ 不独立。实验设计是不平衡的。处理组主要由上调率较低的组织 $\\mathrm{A}$（约 $0.1$）构成，而对照组主要由上调率非常高的组织 $\\mathrm{B}$（约 $0.9$）构成。\n\n让我们使用全概率定律来检验边际计算：\n$P(U_{up} \\mid R_{trt}) = (0.11)(0.9) + (0.91)(0.1) = 0.099 + 0.091 = 0.19$。\n$P(U_{up} \\mid R_{ctl}) = (0.10)(0.1) + (0.90)(0.9) = 0.010 + 0.810 = 0.82$。\n计算结果是一致的。逆转是由应用于特定分层概率的不同权重 $P(S=s \\mid R=r)$ 引起的。\n\n现在我们评估给出的选项。\n\nA. 这个陈述准确地总结了我们所有的发现。层内条件关联的方向是正确的 ($>$)，边际关联的方向是正确的 ($<$)，并且所提供的解释正是观察到逆转的数学原因。\n结论：**正确**。\n\nB. 这个陈述对不等式方向的两个主张都与我们的计算结果相反。我们的分层特定比较显示了 `>` 关系，而不是 `<`。我们的边际比较显示了 `<` 关系，而不是 `>`。因此，该陈述在事实上是不正确的，其结论“不存在悖论”也是错误的。\n结论：**不正确**。\n\nC. 这个陈述在理论上是有缺陷的。如果 $R$ 和 $S$ 独立，那么对于所有的 $r$，都有 $P(S=s \\mid R=r) = P(S=s)$。全概率定律将对处理组和对照组使用相同的权重。设 $w_A = P(S_A)$ 和 $w_B = P(S_B)$。那么边际概率的差异将是：$P(U_{up} \\mid R_{trt}) - P(U_{up} \\mid R_{ctl}) = [P(U_{up} \\mid R_{trt}, S_A) - P(U_{up} \\mid R_{ctl}, S_A)]w_A + [P(U_{up} \\mid R_{trt}, S_B) - P(U_{up} \\mid R_{ctl}, S_B)]w_B$。由于方括号中的两项都是正的（两种情况下均为 $0.01$），且权重 $w_A, w_B$ 是非负的，所以总体差异将是正的。逆转不会发生。该悖论本质上依赖于 $R$ 和 $S$ 的不独立性。\n结论：**不正确**。\n\nD. 这个陈述将边际概率的定义与一种统计调整方法混淆了。给定样本的边际概率是我们直接从汇总计数中计算得出的。使用相等的权重是一种对具有平衡组织构成的假设总体进行标准化的形式。虽然这个过程对于消除混杂效应可能有用，但它并不能得出观测数据的实际边际概率。因此，这个前提是不正确的。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2418177"}, {"introduction": "点突变是驱动进化的基本力量之一，而计算其导致特定后果的概率是序列分析中的一个核心问题。本练习将引导你运用全概率定律 (Law of Total Probability) 和条件概率 (conditional probability)，一步步拆解一个复杂问题：在给定的基因序列模型中，一个随机点突变导致氨基酸性质从疏水性变为亲水性的概率是多少。通过这个练习，你将掌握在多层次生物过程中进行概率建模和计算的关键技能 [@problem_id:2418164]。", "problem": "来自一个微生物基因组的编码序列按如下方式建模。密码子使用基于核苷酸字母表 $\\{ \\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T} \\}$ 的标准遗传密码进行翻译。为本题目的，将氨基酸分为疏水性和亲水性两类：\n- 疏水性：$\\{\\mathrm{Ala}, \\mathrm{Val}, \\mathrm{Leu}, \\mathrm{Ile}, \\mathrm{Met}, \\mathrm{Phe}, \\mathrm{Trp}, \\mathrm{Pro}\\}$。\n- 亲水性：$\\{\\mathrm{Arg}, \\mathrm{Lys}, \\mathrm{Asp}, \\mathrm{Glu}, \\mathrm{Asn}, \\mathrm{Gln}, \\mathrm{Ser}, \\mathrm{Thr}, \\mathrm{His}, \\mathrm{Tyr}, \\mathrm{Cys}\\}$。\n无义密码子（终止密码子）既不是疏水性的，也不是亲水性的。\n\n点突变被建模为：从编码序列的所有核苷酸中均匀随机地选择一个核苷酸位置，然后用其他 $3$ 种核苷酸中的一种均匀随机地替换该核苷酸。假设该编码序列具有以下组成和使用信息：\n- 编码疏水性氨基酸的密码子比例为 $f_{H} = 0.5$。\n- 在疏水性的条件下，氨基酸为亮氨酸（Leucine）的概率为 $p_{L} = 0.6$，为缬氨酸（Valine）的概率为 $p_{V} = 0.4$。\n- 亮氨酸（Leucine）在其 $6$ 个密码子中的使用频率为：$\\mathrm{CTT}: 0.15$, $\\mathrm{CTC}: 0.25$, $\\mathrm{CTA}: 0.10$, $\\mathrm{CTG}: 0.30$, $\\mathrm{TTA}: 0.10$, $\\mathrm{TTG}: 0.10$。\n- 缬氨酸（Valine）在其 $4$ 个密码子中的使用频率为：$\\mathrm{GTT}: 0.30$, $\\mathrm{GTC}: 0.25$, $\\mathrm{GTA}: 0.15$, $\\mathrm{GTG}: 0.30$。\n\n使用标准遗传密码，对于上面列出的每个起始密码子，在其 $9$ 个可能的单核苷酸突变邻居中（计算方式为 $3$ 个位置乘以 $3$ 个替代核苷酸），编码亲水性氨基酸的突变数量如下：\n- 亮氨酸（Leucine）密码子：$\\mathrm{CTT}: 2$, $\\mathrm{CTC}: 2$, $\\mathrm{CTA}: 2$, $\\mathrm{CTG}: 2$, $\\mathrm{TTA}: 1$, $\\mathrm{TTG}: 1$。\n- 缬氨酸（Valine）密码子：$\\mathrm{GTT}: 1$, $\\mathrm{GTC}: 1$, $\\mathrm{GTA}: 1$, $\\mathrm{GTG}: 1$。\n\n仅从概率公理和条件概率的定义出发，并严格按照上述突变模型中陈述的独立性假设（位置的均匀选择和替换核苷酸的均匀选择），推导并计算在该编码序列中，一个均匀随机的点突变导致编码的氨基酸从疏水性变为亲水性的概率。请将最终答案表示为小数，并四舍五入到四位有效数字。", "solution": "本题要求计算在一个编码序列中，单个随机点突变导致编码的氨基酸从疏水性变为亲水性的概率。我们将按要求从第一性原理出发进行推导。\n\n首先，我们必须验证问题陈述的有效性。\n已知条件逐字摘录如下：\n- 氨基酸分类：\n  - 疏水性：$\\{\\mathrm{Ala}, \\mathrm{Val}, \\mathrm{Leu}, \\mathrm{Ile}, \\mathrm{Met}, \\mathrm{Phe}, \\mathrm{Trp}, \\mathrm{Pro}\\}$。\n  - 亲水性：$\\{\\mathrm{Arg}, \\mathrm{Lys}, \\mathrm{Asp}, \\mathrm{Glu}, \\mathrm{Asn}, \\mathrm{Gln}, \\mathrm{Ser}, \\mathrm{Thr}, \\mathrm{His}, \\mathrm{Tyr}, \\mathrm{Cys}\\}$。\n- 突变模型：从整个编码序列中均匀随机地选择一个核苷酸位置。然后，该位置的核苷酸被其他 $3$ 种核苷酸中的一种均匀随机地替换。\n- 序列组成：\n  - 编码疏水性氨基酸的密码子比例：$f_{H} = 0.5$。\n  - 疏水性类别内的条件概率：$P(\\text{亮氨酸} | \\text{疏水性}) = p_{L} = 0.6$，$P(\\text{缬氨酸} | \\text{疏水性}) = p_{V} = 0.4$。\n- 密码子使用频率（条件）：\n  - 亮氨酸（Leucine）（$6$ 个密码子）：$\\mathrm{CTT}: 0.15$, $\\mathrm{CTC}: 0.25$, $\\mathrm{CTA}: 0.10$, $\\mathrm{CTG}: 0.30$, $\\mathrm{TTA}: 0.10$, $\\mathrm{TTG}: 0.10$。\n  - 缬氨酸（Valine）（$4$ 个密码子）：$\\mathrm{GTT}: 0.30$, $\\mathrm{GTC}: 0.25$, $\\mathrm{GTA}: 0.15$, $\\mathrm{GTG}: 0.30$。\n- 突变结果（每个密码子 $9$ 种可能的单核苷酸突变中，导致亲水性氨基酸的突变数量）：\n  - 亮氨酸（Leucine）密码子：$N_{\\to\\Phi}(\\mathrm{CTT})=2$, $N_{\\to\\Phi}(\\mathrm{CTC})=2$, $N_{\\to\\Phi}(\\mathrm{CTA})=2$, $N_{\\to\\Phi}(\\mathrm{CTG})=2$, $N_{\\to\\Phi}(\\mathrm{TTA})=1$, $N_{\\to\\Phi}(\\mathrm{TTG})=1$。\n  - 缬氨酸（Valine）密码子：$N_{\\to\\Phi}(\\mathrm{GTT})=1$, $N_{\\to\\Phi}(\\mathrm{GTC})=1$, $N_{\\to\\Phi}(\\mathrm{GTA})=1$, $N_{\\to\\Phi}(\\mathrm{GTG})=1$。\n\n该问题具有科学依据，使用了分子生物学和概率论中的既有概念。所提供的模型是一个简化模型（例如，由于 $p_L + p_V = 1.0$，疏水性类别仅由亮氨酸和缬氨酸构成），但这是该模型的一个自洽特征，并非矛盾。所有必要数据均已提供，可得出唯一解。问题提法得当且客观。因此，该问题是有效的，我们可以继续解答。\n\n设 $E$ 为随机点突变将一个疏水性（H）氨基酸变为一个亲水性（$\\Phi$）氨基酸的事件。我们要求计算概率 $P(E)$。\n\n突变过程包括两次均匀随机选择。首先，从整个序列中选择一个核苷酸位置。设序列有 $N$ 个密码子，即有 $3N$ 个核苷酸位置。选择任何一个特定位置的概率是 $\\frac{1}{3N}$。其次，该位置的核苷酸被其他 $3$ 种可能的核苷酸中的一种替换，每种选择的概率为 $\\frac{1}{3}$。因此，任何特定的突变（一个特定位置变为一个特定的新核苷酸）的概率为 $\\frac{1}{3N} \\times \\frac{1}{3} = \\frac{1}{9N}$。序列中可能的不同单核苷酸突变总数为 $3N \\times 3 = 9N$。\n\n概率 $P(E)$ 是导致 H $\\to$ $\\Phi$ 转变的突变数量与可能突变总数的比值。\n$$P(E) = \\frac{\\text{导致 H} \\to \\Phi \\text{的突变数量}}{\\text{可能的突变总数}}$$\n我们将 H $\\to$ $\\Phi$ 突变的数量记为 $|E|$。突变总数为 $9N$。\n所以，$P(E) = \\frac{|E|}{9N}$。\n\n为了找到 $|E|$，我们对序列中所有密码子的贡献求和。一个更系统的方法是对存在的密码子类型进行平均。设 $f_c$ 是密码子 $c$ 在序列中的频率。密码子 $c$ 的实例数为 $N_c = N \\times f_c$。H $\\to$ $\\Phi$ 的转变只有在原始密码子 $c$ 是疏水性的情况下才会发生。对于疏水性密码子 $c$ 的每个实例，有 $N_{\\to \\Phi}(c)$ 个单核苷酸变化会导致一个亲水性产物。\n\nH $\\to$ $\\Phi$ 的突变总数是，对所有疏水性密码子类型，将该密码子的实例数乘以每个密码子的相关突变数，然后求和：\n$$|E| = \\sum_{c \\, \\in \\, \\text{疏水性}} N_c \\times N_{\\to \\Phi}(c) = \\sum_{c \\, \\in \\, \\text{疏水性}} (N \\times f_c) \\times N_{\\to \\Phi}(c) = N \\sum_{c \\, \\in \\, \\text{疏水性}} f_c \\times N_{\\to \\Phi}(c)$$\n将此代入我们关于 $P(E)$ 的表达式中：\n$$P(E) = \\frac{N \\sum_{c \\, \\in \\, \\text{疏水性}} f_c \\times N_{\\to \\Phi}(c)}{9N} = \\frac{1}{9} \\sum_{c \\, \\in \\, \\text{疏水性}} f_c \\times N_{\\to \\Phi}(c)$$\n这个结果与序列长度 $N$ 无关，这是必然的。\n\n我们的下一个任务是确定每个相关密码子的绝对频率 $f_c$。我们已知疏水性密码子的总频率为 $f_H = 0.5$。我们还知道，在氨基酸是疏水性的条件下，它是亮氨酸（Leucine）或缬氨酸（Valine）的条件概率。\n设 $E_{Leu}$ 是随机选择的密码子编码亮氨酸（Leucine）的事件，$E_{Val}$ 是编码缬氨酸（Valine）的事件。\n问题陈述了 $P(E_{Leu} | H) = p_L = 0.6$ 和 $P(E_{Val} | H) = p_V = 0.4$。\n编码特定氨基酸的密码子的总频率是其在序列中出现的概率。根据条件概率的定义，$P(A \\cap B) = P(A|B)P(B)$，亮氨酸（Leucine）密码子的总频率为：\n$f_{Leu} = P(E_{Leu}) = P(E_{Leu} | H) \\times P(H) = 0.6 \\times 0.5 = 0.3$。\n同样，缬氨酸（Valine）密码子的总频率为：\n$f_{Val} = P(E_{Val}) = P(E_{Val} | H) \\times P(H) = 0.4 \\times 0.5 = 0.2$。\n注意，$f_{Leu} + f_{Val} = 0.3 + 0.2 = 0.5 = f_H$，这是一致的。\n\n现在我们通过将氨基酸频率与条件密码子使用频率相乘，来计算每个特定密码子 $c$ 的绝对频率 $f_c$。对于一个亮氨酸（Leucine）密码子 $c$：$f_c = P(C=c | E_{Leu}) \\times f_{Leu}$。\n$f_{\\mathrm{CTT}} = 0.15 \\times 0.3 = 0.045$\n$f_{\\mathrm{CTC}} = 0.25 \\times 0.3 = 0.075$\n$f_{\\mathrm{CTA}} = 0.10 \\times 0.3 = 0.030$\n$f_{\\mathrm{CTG}} = 0.30 \\times 0.3 = 0.090$\n$f_{\\mathrm{TTA}} = 0.10 \\times 0.3 = 0.030$\n$f_{\\mathrm{TTG}} = 0.10 \\times 0.3 = 0.030$\n\n对于缬氨酸（Valine）密码子 $c$：$f_c = P(C=c | E_{Val}) \\times f_{Val}$。\n$f_{\\mathrm{GTT}} = 0.30 \\times 0.2 = 0.060$\n$f_{\\mathrm{GTC}} = 0.25 \\times 0.2 = 0.050$\n$f_{\\mathrm{GTA}} = 0.15 \\times 0.2 = 0.030$\n$f_{\\mathrm{GTG}} = 0.30 \\times 0.2 = 0.060$\n\n现在我们将这些频率和给定的 $N_{\\to \\Phi}(c)$ 值代入 $P(E)$ 的表达式中。\n$$P(E) = \\frac{1}{9} \\left( \\sum_{c \\, \\in \\, \\text{Leu}} f_c \\times N_{\\to \\Phi}(c) + \\sum_{c \\, \\in \\, \\text{Val}} f_c \\times N_{\\to \\Phi}(c) \\right)$$\n来自亮氨酸（Leucine）密码子的贡献：\n$$ \\sum_{c \\, \\in \\, \\text{Leu}} f_c N_{\\to \\Phi}(c) = (0.045 \\times 2) + (0.075 \\times 2) + (0.030 \\times 2) + (0.090 \\times 2) + (0.030 \\times 1) + (0.030 \\times 1) $$\n$$ = 0.090 + 0.150 + 0.060 + 0.180 + 0.030 + 0.030 = 0.540 $$\n来自缬氨酸（Valine）密码子的贡献：\n$$ \\sum_{c \\, \\in \\, \\text{Val}} f_c N_{\\to \\Phi}(c) = (0.060 \\times 1) + (0.050 \\times 1) + (0.030 \\times 1) + (0.060 \\times 1) $$\n$$ = 0.060 + 0.050 + 0.030 + 0.060 = 0.200 $$\n总和为 $0.540 + 0.200 = 0.740$。\n最后，我们计算概率 $P(E)$：\n$$P(E) = \\frac{1}{9} \\times 0.740 = \\frac{0.74}{9} = \\frac{74}{900} = \\frac{37}{450}$$\n作为小数，这等于 $37 \\div 450 \\approx 0.082222...$。\n题目要求结果以小数形式表示，并四舍五入到四位有效数字。第一个有效数字是 $8$。四位有效数字是 $8, 2, 2, 2$。随后的数字是 $2$，所以我们向下舍入。\n最终结果是 $0.08222$。", "answer": "$$\\boxed{0.08222}$$", "id": "2418164"}, {"introduction": "在现代生物信息学中，根据不断出现的新证据来动态更新我们对生物系统的认知至关重要，而贝叶斯推理 (Bayesian reasoning) 为此提供了强大的数学框架。这个练习将一个经典的概率谜题“蒙提霍尔问题 (Monty Hall problem)”巧妙地改编为筛选致病基因的现实场景。通过解决这个问题，你将学会如何利用贝叶斯定理 (Bayes' theorem)，根据新的实验数据来更新你对候选基因的“信念”或后验概率 (posterior probability)，这是统计遗传学和系统生物学的基石 [@problem_id:2418209]。", "problem": "一个研究小组正在优先筛选整整$3$个候选基因，标记为$G_1$、$G_2$和$G_3$，这些基因可能是一个家族中孟德尔病的致病原因。根据先前的综合证据（例如，连锁、变异负荷和表达），每个基因含有致病变异的先验概率为：\n$P(G_1 \\text{ is causal}) = 0.5$，$P(G_2 \\text{ is causal}) = 0.3$，以及$P(G_3 \\text{ is causal}) = 0.2$。\n实验室最初承诺验证$G_1$。\n\n在进行验证之前，一个独立的审查小组进行了一项正交试验，该试验仅当一个基因非致病时才能确定性地将其排除，并且从不排除致病基因。以实验室最初承诺验证$G_1$为条件，该小组采用以下策略在$\\{G_2, G_3\\}$中公布一个被排除的基因：\n- 如果$G_1$是致病基因（因此$G_2$和$G_3$都是非致病的），该小组以$0.73$的概率排除$G_3$，以$0.27$的概率排除$G_2$。\n- 如果$G_1$非致病，那么$\\{G_2, G_3\\}$中有且只有一个是非致病的；在这种情况下，该小组确定性地排除那个非致病的基因（它从不排除致病基因）。\n\n您观察到该小组宣布$G_3$被排除。仅根据这一观察和上述先验概率，如果您现在将验证目标从$G_1$切换到$G_2$，那么$G_2$实际含有致病变异的概率是多少？请用小数表示您的答案，并四舍五入到四位有效数字。", "solution": "仔细审查问题陈述后，确认其有效。这是一个概率论中定义明确的问题，其背景是计算生物学中一个合理的情景，所有必要数据均已提供，且没有内部矛盾。我们可以着手进行形式化求解。\n\n设$C_i$为基因$G_i$是致病基因的事件，其中$i \\in \\{1, 2, 3\\}$。给定的先验概率如下：\n$$ P(C_1) = 0.5 $$\n$$ P(C_2) = 0.3 $$\n$$ P(C_3) = 0.2 $$\n这些事件是互斥且穷尽的，这可以通过它们的概率之和得到证实：$P(C_1) + P(C_2) + P(C_3) = 0.5 + 0.3 + 0.2 = 1.0$。\n\n设$R_3$为审查小组宣布基因$G_3$被排除的事件。我们需要计算在观察到$G_3$被排除的情况下，$G_2$是致病基因的后验概率。这就是条件概率$P(C_2 | R_3)$。\n\n我们将使用贝叶斯定理来计算这个后验概率：\n$$ P(C_2 | R_3) = \\frac{P(R_3 | C_2) P(C_2)}{P(R_3)} $$\n\n为了使用此公式，我们必须确定表达式中的每一项。已知先验概率$P(C_2)$为$0.3$。我们需要求出条件概率$P(R_3 | C_2)$和全概率$P(R_3)$。\n\n全概率$P(R_3)$可以通过使用全概率公式，以互斥且穷尽的事件$C_1$、$C_2$和$C_3$为条件来计算：\n$$ P(R_3) = P(R_3 | C_1) P(C_1) + P(R_3 | C_2) P(C_2) + P(R_3 | C_3) P(C_3) $$\n\n现在，我们将根据问题陈述中描述的小组策略，确定每个$i \\in \\{1, 2, 3\\}$的条件概率$P(R_3 | C_i)$。\n\n1.  **情况1：$G_1$是致病基因（事件$C_1$）。**\n    问题陈述指出，如果$G_1$是致病基因，该小组以$0.73$的概率排除$G_3$。\n    因此，$P(R_3 | C_1) = 0.73$。\n\n2.  **情况2：$G_2$是致病基因（事件$C_2$）。**\n    在这种情况下，$G_1$非致病。问题陈述指出，如果$G_1$非致病，该小组将确定性地排除$\\{G_2, G_3\\}$中的非致病基因。由于$G_2$是致病基因，那么$G_3$必定是非致病的。该小组从不排除致病基因，因此必须排除$G_3$。\n    因此，$P(R_3 | C_2) = 1$。\n\n3.  **情况3：$G_3$是致病基因（事件$C_3$）。**\n    问题陈述指出，该小组“从不排除致病基因”。如果$G_3$是致病基因，它就不能被排除。\n    因此，在$G_3$是致病基因的条件下，小组排除$G_3$的概率为零：$P(R_3 | C_3) = 0$。\n\n现在，我们可以将这些值代入全概率$P(R_3)$的公式中：\n$$ P(R_3) = (0.73)(0.5) + (1)(0.3) + (0)(0.2) $$\n$$ P(R_3) = 0.365 + 0.3 + 0 $$\n$$ P(R_3) = 0.665 $$\n\n最后，我们可以使用贝叶斯定理计算所求的后验概率$P(C_2 | R_3)$：\n$$ P(C_2 | R_3) = \\frac{P(R_3 | C_2) P(C_2)}{P(R_3)} = \\frac{(1)(0.3)}{0.665} $$\n$$ P(C_2 | R_3) = \\frac{0.3}{0.665} \\approx 0.4511278... $$\n\n问题要求答案以小数形式表示，并四舍五入到四位有效数字。将结果四舍五入得到：\n$$ P(C_2 | R_3) \\approx 0.4511 $$\n\n关于是否将验证目标从$G_1$“切换”到$G_2$的问题，可以通过比较它们的后验概率来回答。计算出的值$P(C_2 | R_3) \\approx 0.4511$是在获得新信息后，$G_2$为致病基因的概率。这就是所求的最终值。", "answer": "$$\\boxed{0.4511}$$", "id": "2418209"}]}