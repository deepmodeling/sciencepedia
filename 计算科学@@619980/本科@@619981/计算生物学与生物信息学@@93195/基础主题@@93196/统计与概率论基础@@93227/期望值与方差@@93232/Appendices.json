{"hands_on_practices": [{"introduction": "在计算生物学中，泊松分布是分析如RNA测序（RNA-seq）等计数数据的基石。本练习将带你探讨一个基本但至关重要的概念：在RNA-seq实验中，一个基因的读数计数通常可以用泊松分布来建模。通过这个实践，你将运用期望值和方差的核心性质，来理解测序深度如何直接影响我们对基因表达水平的测量及其不确定性，这是解读所有高通量测序数据的基础技能。[@problem_id:2389172]", "problem": "在一项使用RNA测序（RNA-seq）的差异基因表达研究中，假设对于一个特定基因，在固定的实验条件和固定的测序深度下，观测到的读数（read count）$X$ 服从参数为 $\\lambda$ 的泊松分布，即 $X \\sim \\operatorname{Pois}(\\lambda)$。然后，实验室在相同条件下重复该实验，但测序深度是原始深度的 $3$ 倍，并将所有读数汇集到一个文库中。根据标准假设，即读数的生成事件是独立的，且基因的期望读数与测序深度成线性关系，请确定该基因合并后的读数的新的期望值和方差。\n\n请以行向量 $\\left(\\mathbb{E}[X'], \\operatorname{Var}(X')\\right)$ 的形式报告您的答案，并用 $\\lambda$ 表示。不需要进行数值近似。", "solution": "首先必须验证问题陈述的科学性和逻辑一致性。前提如下：\n1. 初始读数，即随机变量 $X$，服从参数为 $\\lambda$ 的泊松分布。这可以写作 $X \\sim \\operatorname{Pois}(\\lambda)$。\n2. 基因的期望读数与测序深度成线性关系。\n3. 进行了一项新实验，其测序深度是原始深度的 $3$ 倍。\n\n这些前提在计算生物学领域中用于分析RNA-seq数据是标准且公认的。该模型具有科学依据，问题定义明确。我们可以继续进行求解。\n\n设原始测序深度为 $D$。初始读数是随机变量 $X$，且已知 $X \\sim \\operatorname{Pois}(\\lambda)$。泊松分布的基本性质表明，其期望值和方差均等于其参数。因此，对于初始实验，我们有：\n$$\n\\mathbb{E}[X] = \\lambda\n$$\n$$\n\\operatorname{Var}(X) = \\lambda\n$$\n\n问题陈述指出，期望读数与测序深度成正比。我们可以用一个比例常数 $k$ 来数学地表达这种关系，该常数取决于特定基因和固定的实验条件。\n$$\n\\mathbb{E}[X] = kD\n$$\n由此，我们可以将两个期望值的表达式等同起来，从而将泊松参数 $\\lambda$ 与测序深度 $D$ 联系起来：\n$$\n\\lambda = kD\n$$\n\n接下来，描述了一个新实验。设 $X'$ 是代表这个新实验中读数的随机变量。新的测序深度是原始深度的 $3$ 倍，我们记为 $D' = 3D$。问题暗示新的读数 $X'$ 也服从泊松分布，这与标准模型一致。设这个新分布的参数为 $\\lambda'$。因此，$X' \\sim \\operatorname{Pois}(\\lambda')$。\n\n我们将线性缩放假设应用于新实验。由于基因和其他条件保持不变，比例常数 $k$ 也保持不变。新的期望值为：\n$$\n\\mathbb{E}[X'] = kD' = k(3D)\n$$\n我们可以通过组合项来重写这个表达式：\n$$\n\\mathbb{E}[X'] = 3(kD)\n$$\n代入我们之前得到的 $\\lambda = kD$，我们用 $\\lambda$ 来确定新的期望值：\n$$\n\\mathbb{E}[X'] = 3\\lambda\n$$\n\n对于新的服从泊松分布的变量 $X'$，其参数 $\\lambda'$ 必须等于其期望值。因此：\n$$\n\\lambda' = \\mathbb{E}[X'] = 3\\lambda\n$$\n泊松分布的方差也等于其参数。因此，新读数 $X'$ 的方差为：\n$$\n\\operatorname{Var}(X') = \\lambda' = 3\\lambda\n$$\n\n问题要求以行向量 $(\\mathbb{E}[X'], \\operatorname{Var}(X'))$ 的形式报告新的期望值和方差。我们已经求得了这两个量。新的期望值是 $3\\lambda$，新的方差是 $3\\lambda$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3\\lambda & 3\\lambda\n\\end{pmatrix}\n}\n$$", "id": "2389172"}, {"introduction": "DNA作为一种新兴的数据存储介质，具有巨大的信息密度潜力，但其读写过程伴随着错误的产生。这个练习构建了一个简化的两阶段错误模型，模拟了数据从合成到测序的完整流程。解决此问题的关键在于运用期望的线性性质 ($E[\\sum X_i] = \\sum E[X_i]$)，这是一个极其强大的工具，它允许我们将整个复杂系统的期望分解为许多独立、简单事件的期望之和。通过此练习，你将学会如何量化和预测大规模并行过程中的总体结果。[@problem_id:2389185]", "problem": "一个脱氧核糖核酸（DNA）数据存储管道将数字信息编码为合成DNA，随后通过测序进行解码。考虑一个模型，其中每个意图二进制位都经过 $2$ 个独立阶段：\n\n- 在合成阶段，存储位以 $1-p$ 的概率与意图位相同，并以 $p$ 的概率发生翻转。\n- 在测序（读取）阶段，报告位以 $1-q$ 的概率与存储位相同，并以 $q$ 的概率发生翻转。\n\n假设所有位错误都是跨位和跨阶段发生的独立替换，并且忽略插入和删除。考虑一个大小为 $1\\,\\mathrm{KB}$ 的信息，其中 $1\\,\\mathrm{KB}=1024$ 字节，每字节 $8$ 位。\n\n经过两个阶段后，正确恢复的位的期望数量是多少？请用一个关于 $p$ 和 $q$ 的闭式解析表达式表示。请提供一个未经四舍五入的单一表达式作为答案。", "solution": "该问题要求计算一条信息在经历两阶段错误过程后，正确恢复的位的期望数量。问题陈述需要经过验证。\n\n**步骤1：提取已知条件**\n- 过程包含 $2$ 个独立阶段：合成与测序。\n- 合成错误概率（位翻转）：$p$。\n- 合成阶段无错误的概率：$1-p$。\n- 测序错误概率（位翻转）：$q$。\n- 测序阶段无错误的概率：$1-q$。\n- 所有位错误均为独立替换。\n- 忽略插入和删除。\n- 信息大小：$1\\,\\mathrm{KB}$。\n- 转换因子：$1\\,\\mathrm{KB} = 1024$ 字节。\n- 转换因子：$1$ 字节 = $8$ 位。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学上合理：** 该问题提出了一个简化但有效的 DNA 数据存储信道错误概率模型，这是计算生物学和生物信息学中的一个公认课题。所使用的概念（独立事件、概率、期望值）是数学和信息论的基础。该模型在科学上是可信的。\n- **良定的：** 该问题提供了确定唯一解析解所需的所有必要参数（$p$，$q$）和常数（信息大小）。\n- **客观的：** 该问题以精确的定量术语陈述，没有任何主观性或歧义。\n\n**结论：** 该问题在科学上合理、良定且客观。判定为**有效**。我们可以继续进行求解。\n\n设 $N$ 为信息中的总位数。给定信息大小为 $1\\,\\mathrm{KB}$，定义为 $1\\,\\mathrm{KB} = 1024$ 字节，且 $1$ 字节 $= 8$ 位。因此，总位数为：\n$$N = 1024 \\times 8 = 8192$$\n\n让我们考虑单个位。设 $X$ 为一个指示随机变量，如果该位在两个阶段后被正确恢复，则 $X=1$，否则 $X=0$。任务是求出正确恢复的位的总期望数量。设这个总数为 $S$。如果我们有 $N$ 个位，索引为 $i=1, 2, \\dots, N$，我们可以为每个位定义一个指示变量 $X_i$。正确位的总数是 $S = \\sum_{i=1}^{N} X_i$。\n\n根据期望的线性性，正确恢复的位的总期望数量为：\n$$E[S] = E\\left[\\sum_{i=1}^{N} X_i\\right] = \\sum_{i=1}^{N} E[X_i]$$\n由于每个位的错误过程是相同且独立的，因此所有 $i$ 的期望值 $E[X_i]$ 都相同。设这个共同值为 $E[X]$。因此，\n$$E[S] = N \\cdot E[X]$$\n指示随机变量的期望值是它所指示事件的概率。因此，$E[X] = P(X=1)$，即单个位被正确恢复的概率。\n\n如果最终报告的位与原始意图位相同，则该位被正确恢复。这可以通过两种互斥的方式发生：\n1. 在合成阶段该位未被翻转，且在测序阶段也未被翻转。发生了偶数次（$0$次）翻转。\n2. 在合成阶段该位被翻转，且在测序阶段再次被翻转。发生了偶数次（$2$次）翻转，使该位恢复到其原始状态。\n\n让我们计算每种情况的概率。这两个阶段是独立的。\n- 第一种情况（任一阶段均未翻转）的概率是每个阶段不翻转概率的乘积：\n$$P(\\text{no flip, no flip}) = (1-p)(1-q)$$\n- 第二种情况（两个阶段都翻转）的概率是每个阶段翻转概率的乘积：\n$$P(\\text{flip, flip}) = p \\cdot q$$\n\n单个位被正确恢复的总概率 $P(X=1)$ 是这两个不相交事件概率的和：\n$$P(X=1) = (1-p)(1-q) + pq$$\n展开此表达式，我们得到：\n$$P(X=1) = 1 - p - q + pq + pq = 1 - p - q + 2pq$$\n\n现在，我们可以通过代入 $N$ 和 $P(X=1)$ 的值来计算正确恢复的位的总期望数量 $E[S]$：\n$$E[S] = N \\cdot P(X=1) = 8192 \\cdot (1 - p - q + 2pq)$$\n这就是所求的、关于错误概率 $p$ 和 $q$ 的正确恢复位的期望数量的闭式解析表达式。", "answer": "$$\n\\boxed{8192(1 - p - q + 2pq)}\n$$", "id": "2389185"}, {"introduction": "体细胞突变的累积是衰老和癌症等多种生物学过程的核心。这个高级练习将引导你建立一个随机模型来估算造血干细胞群体在数十年间累积的突变总数。该问题涉及一个复合随机过程：细胞分裂的次数是随机的，而每次分裂产生的新突变数量也是随机的。为了解决这个问题，你需要使用一个更高级的概率工具——全期望定律（Law of Total Expectation），这展示了期望值和方差的概念如何被用来分析和预测复杂的、多层次的生物系统。[@problem_id:2389107]", "problem": "一个健康的成年人体内维持着一个大致恒定的造血干细胞（HSC）池。请考虑以下随机模型，该模型用于描述从出生到50岁期间，HSC区室中单核苷酸变异（SNV）点突变的累积过程。\n\n- HSC种群大小恒定为 $N = 5 \\times 10^{4}$ 个细胞。\n- 在长度为 $T = 50$ 年的时间区间内，每个HSC根据速率为 $d = 0.7$ 次分裂/年的齐次泊松过程进行有丝分裂，各细胞间以及时间上均独立。\n- 在一次HSC分裂的条件下，分裂的HSC基因组中引入的新SNV点突变数量是一个泊松随机变量，其均值为每次细胞分裂 $\\mu = 2.8$ 个突变。不同分裂事件中的突变计数是相互独立的。\n- 忽略选择、细胞凋亡以及任何在DNA复制之外产生的突变。计算在 $T$ 年区间内HSC区室中发生的每一个突变事件，无论突变的子细胞是继续作为HSC还是发生分化。\n\n仅使用这些假设，计算从出生到50岁期间在HSC区室中累积的SNV突变事件的总期望数。将您的答案四舍五入至两位有效数字。最终答案以纯数字形式表示（无单位）。", "solution": "首先必须严格验证问题陈述的科学和数学合理性。\n\n首先，我将逐字提取陈述中的所有给定信息。\n- HSC种群大小恒定为 $N = 5 \\times 10^{4}$ 个细胞。\n- 每个HSC根据速率为 $d = 0.7$ 次分裂/年的齐次泊松过程进行有丝分裂，各细胞间以及时间上均独立。\n- 时间区间的长度为 $T = 50$ 年。\n- 在一次HSC分裂的条件下，引入的新SNV点突变数量是一个泊松随机变量，其均值为每次细胞分裂 $\\mu = 2.8$ 个突变。\n- 不同分裂事件中的突变计数是相互独立的。\n- 该模型要求忽略选择、细胞凋亡以及任何在DNA复制之外产生的突变。\n- 任务是计算在 $T$ 年区间内HSC区室中发生的每一个突变事件。\n- 最终目标是计算SNV突变事件的总期望数，并将答案四舍五入至两位有效数字。\n\n接下来，我将根据所需标准验证该问题。\n1.  **科学依据**：该问题使用随机模型（泊松过程），这是计算生物学中用于模拟细胞分裂和突变等事件的标准有效工具。种群大小（$N$）、分裂速率（$d$）和每次分裂的突变负荷（$\\mu$）等参数值在人类造血干细胞的生物学合理范围内。虽然所作的假设是简化的，但都已明确陈述。作为一个建模练习，该问题具有科学依据。\n2.  **适定性**：所有必需的参数（$N$、$d$、$T$、$\\mu$）均已提供。目标——计算期望值——已明确定义。随机过程有明确的规定，从而可以得到唯一解。\n3.  **客观性**：问题以精确、定量的术语陈述，没有主观或含糊不清的语言。\n\n该问题是应用概率论和计算生物学中一个有效、自洽且适定的问题。它没有违反任何无效标准。因此，我将继续进行求解。\n\n设 $M_{total}$ 为表示在长度为 $T$ 的时间区间内，整个HSC区室中SNV突变事件总数的随机变量。目标是计算其期望值 $E[M_{total}]$。\n\n突变总数是每次分裂中发生的突变之和。这可以建模为随机个随机变量之和。设 $D_{total}$ 为在时间区间 $[0, T]$ 内HSC区室中HSC分裂的总次数。设 $M_j$ 为第 $j$ 次分裂事件中发生的新突变的数量。我们已知 $M_j$ 是一个均值为 $\\mu$ 的泊松随机变量。因此，$E[M_j] = \\mu$。\n\n突变总数为 $M_{total} = \\sum_{j=1}^{D_{total}} M_j$。\n为了求 $M_{total}$ 的期望，我们可以使用全期望定律，在此情境下也称为瓦尔德恒等式：\n$$E[M_{total}] = E[E[M_{total} | D_{total}]]$$\n首先，我们计算内层期望，其条件是分裂总次数 $D_{total}$ 固定。\n$$E[M_{total} | D_{total}] = E\\left[\\sum_{j=1}^{D_{total}} M_j \\bigg| D_{total}\\right]$$\n由于每次分裂的突变数（$M_j$）与其他分裂的突变数相互独立，并且也与分裂总次数本身无关（除了设定求和项数之外），我们可以使用期望的线性性质：\n$$E\\left[\\sum_{j=1}^{D_{total}} M_j \\bigg| D_{total}\\right] = \\sum_{j=1}^{D_{total}} E[M_j] = \\sum_{j=1}^{D_{total}} \\mu = D_{total} \\mu$$\n现在，我们将此结果代回全期望定律：\n$$E[M_{total}] = E[D_{total} \\mu] = \\mu E[D_{total}]$$\n问题现在简化为求解分裂总次数的期望值 $E[D_{total}]$。\n\nHSC区室由 $N$ 个细胞组成。总分裂次数 $D_{total}$ 是在时间区间 $T$ 内， $N$ 个细胞中每个细胞分裂次数的总和。设 $D_i(T)$ 为细胞 $i$ 在 $[0, T]$ 区间内的分裂次数。那么：\n$$D_{total} = \\sum_{i=1}^{N} D_i(T)$$\n根据期望的线性性质：\n$$E[D_{total}] = E\\left[\\sum_{i=1}^{N} D_i(T)\\right] = \\sum_{i=1}^{N} E[D_i(T)]$$\n对于每个细胞 $i$，其分裂次数 $D_i(T)$ 服从速率为 $d$ 的齐次泊松过程。这样一个过程在长度为 $T$ 的区间内的事件数是一个泊松分布的随机变量，其均值为 $d T$。\n因此，对于每个细胞 $i=1, \\dots, N$，都有 $E[D_i(T)] = d T$。\n\n将此代回 $E[D_{total}]$ 的表达式中：\n$$E[D_{total}] = \\sum_{i=1}^{N} (d T) = N d T$$\n最后，我们可以求出突变的总期望数：\n$$E[M_{total}] = \\mu E[D_{total}] = \\mu N d T$$\n这就是突变事件总期望数的最终解析表达式。\n\n现在，我将代入给定的数值：\n- $N = 5 \\times 10^{4}$\n- $d = 0.7$ 年$^{-1}$\n- $T = 50$ 年\n- $\\mu = 2.8$\n\n$$E[M_{total}] = (2.8) \\times (5 \\times 10^{4}) \\times (0.7) \\times (50)$$\n$$E[M_{total}] = 2.8 \\times 5 \\times 0.7 \\times 50 \\times 10^{4}$$\n$$E[M_{total}] = (2.8 \\times 0.7) \\times (5 \\times 50) \\times 10^{4}$$\n$$E[M_{total}] = 1.96 \\times 250 \\times 10^{4}$$\n$$E[M_{total}] = 490 \\times 10^{4}$$\n$$E[M_{total}] = 4.9 \\times 10^{6}$$\n问题要求答案四舍五入至两位有效数字。计算结果 $4.9 \\times 10^{6}$ 已经是以两位有效数字表示。", "answer": "$$\\boxed{4.9 \\times 10^{6}}$$", "id": "2389107"}]}