{"hands_on_practices": [{"introduction": "在生物信息学和医学诊断中，我们经常使用分类器来判断一个个体是否具有某种特征（例如，一种蛋白质是否为朊病毒，或者一个病人是否患有某种疾病）。然而，一个测试的准确率（如真阳性率和假阳性率）本身可能具有误导性，特别是当被检测的状况非常罕见时。这个练习将引导你使用贝叶斯定理，结合基础比率（先验概率），来计算一个测试的阳性预测值，这是一个评估生物信息学工具输出结果时至关重要的技能 [@problem_id:2400337]。", "problem": "一个生物信息学流程筛选一个大型真核生物蛋白质组，以识别朊病毒样蛋白。对于每个蛋白质，一个二元分类器会输出“标记”或“无标记”。令 $\\text{prion}$ 表示一个蛋白质根据真实情况确实是朊病毒样蛋白的事件，令 $\\text{flag}$ 表示分类器标记该蛋白质的事件。该分类器的真阳性率 (TPR) 为 $0.80$，即 $P(\\text{flag}\\mid \\text{prion})=0.80$。该分类器的假阳性率 (FPR) 为 $0.10$，即 $P(\\text{flag}\\mid \\neg \\text{prion})=0.10$。该蛋白质组中朊病毒样蛋白的基础率（流行率）为 $P(\\text{prion})=0.01$。一个随机选取的蛋白质被分类器标记了。\n\n后验概率 $P(\\text{prion}\\mid \\text{flag})$ 是多少？请以精确分数的形式给出答案。", "solution": "该问题要求计算后验概率 $P(\\text{prion}\\mid \\text{flag})$，即一个蛋白质在被分类器标记的条件下确实是朊病毒样蛋白的概率。这是贝叶斯定理的一个标准应用。\n\n让我们如下定义事件：\n- $\\text{prion}$: 随机选取的蛋白质确实是朊病毒样蛋白的事件。\n- $\\neg \\text{prion}$: 随机选取的蛋白质不是朊病毒样蛋白的事件。\n- $\\text{flag}$: 分类器标记该蛋白质的事件。\n\n根据问题陈述，我们已知以下概率：\n- 一个蛋白质是朊病毒样蛋白的先验概率（流行率）：$P(\\text{prion}) = 0.01$。\n- 在蛋白质是朊病毒样蛋白的条件下被标记的条件概率（真阳性率）：$P(\\text{flag}\\mid \\text{prion}) = 0.80$。\n- 在蛋白质不是朊病毒样蛋白的条件下被标记的条件概率（假阳性率）：$P(\\text{flag}\\mid \\neg \\text{prion}) = 0.10$。\n\n贝叶斯定理陈述如下：\n$$\nP(\\text{prion}\\mid \\text{flag}) = \\frac{P(\\text{flag}\\mid \\text{prion}) P(\\text{prion})}{P(\\text{flag})}\n$$\n分母 $P(\\text{flag})$ 是一个蛋白质被标记的边缘概率。该概率可使用全概率公式，对完备且不相交的事件集 $\\{\\text{prion}, \\neg \\text{prion}\\}$ 求和计算得出：\n$$\nP(\\text{flag}) = P(\\text{flag}\\mid \\text{prion}) P(\\text{prion}) + P(\\text{flag}\\mid \\neg \\text{prion}) P(\\neg \\text{prion})\n$$\n首先，我们必须确定蛋白质不是朊病毒样蛋白的概率 $P(\\neg \\text{prion})$。由于这是事件 $\\text{prion}$ 的对立事件，其概率为：\n$$\nP(\\neg \\text{prion}) = 1 - P(\\text{prion}) = 1 - 0.01 = 0.99\n$$\n现在，我们可以将已知值代入 $P(\\text{flag})$ 的表达式中：\n$$\nP(\\text{flag}) = (0.80)(0.01) + (0.10)(0.99)\n$$\n$$\nP(\\text{flag}) = 0.008 + 0.099 = 0.107\n$$\n在计算出 $P(\\text{flag})$ 的值后，我们现在可以回到贝叶斯定理来求后验概率 $P(\\text{prion}\\mid \\text{flag})$。分子是似然与先验的乘积：\n$$\nP(\\text{flag}\\mid \\text{prion}) P(\\text{prion}) = (0.80)(0.01) = 0.008\n$$\n因此，后验概率为：\n$$\nP(\\text{prion}\\mid \\text{flag}) = \\frac{0.008}{0.107}\n$$\n问题要求答案为精确分数。我们将小数值转换为其等价的分数形式以化简表达式：\n$$\nP(\\text{prion}\\mid \\text{flag}) = \\frac{\\frac{8}{1000}}{\\frac{107}{1000}}\n$$\n化简后得到：\n$$\nP(\\text{prion}\\mid \\text{flag}) = \\frac{8}{107}\n$$\n数字 $107$ 是一个质数，且不能整除 $8$。因此，分数 $\\frac{8}{107}$ 已是其最简形式。这就是在蛋白质被分类器标记的情况下，该蛋白质确实是朊病毒样蛋白的精确后验概率。", "answer": "$$\\boxed{\\frac{8}{107}}$$", "id": "2400337"}, {"introduction": "在许多生物学场景中，我们获得的证据不是简单的“是”或“否”，而是连续的数值，例如基因表达水平或分类器得分。这个练习在前一个的基础上更进一步，展示了如何在贝叶斯框架中整合这类连续数据。你将学习如何使用概率密度函数作为似然函数，从而将贝叶斯推断的逻辑从离散证据扩展到连续证据上 [@problem_id:2400344]。", "problem": "一名发热患者正在就两种互斥的病因进行评估：流感 (Flu) 和酿脓链球菌 (Strep)。根据当地监测数据，先验概率为 $P(\\text{Flu}) = 0.6$ 和 $P(\\text{Strep}) = 0.4$。一个基于RNA测序 (RNA-seq) 数据训练的宿主转录组分类器输出一个连续的无量纲分数 $s$。以真实病因为条件，该分数被建模为高斯分布：$s \\mid \\text{Flu} \\sim \\mathcal{N}(\\mu_F, \\sigma^{2})$，其中 $\\mu_F = 2.0$ 且 $\\sigma^{2} = 1.0$；以及 $s \\mid \\text{Strep} \\sim \\mathcal{N}(\\mu_S, \\sigma^{2})$，其中 $\\mu_S = 0.0$ 且 $\\sigma^{2} = 1.0$。对于这名患者，测得的分数为 $s = 1.1$。假设这两种病因是详尽无遗的且模型正确，计算后验概率 $P(\\text{Flu} \\mid s = 1.1)$。将您的答案四舍五入到四位有效数字。", "solution": "目标是计算在给定观测分数下患流感的后验概率，即 $P(\\text{Flu} \\mid s = 1.1)$。我们使用贝叶斯定理，该定理将后验概率与先验概率和似然联系起来。对于两个互斥且详尽无遗的假设（流感和链球菌）以及数据 $s$，流感的后验概率由下式给出：\n$$ P(\\text{Flu} \\mid s) = \\frac{p(s \\mid \\text{Flu}) P(\\text{Flu})}{p(s \\mid \\text{Flu}) P(\\text{Flu}) + p(s \\mid \\text{Strep}) P(\\text{Strep})} $$\n在这里，$p(s \\mid \\cdot)$ 表示以病因为条件的分数 $s$ 的概率密度函数，即似然。$P(\\cdot)$ 是先验概率。分母是数据 $p(s)$ 的边际似然。\n\n似然由正态分布 $\\mathcal{N}(\\mu, \\sigma^2)$ 的概率密度函数 (PDF) 给出：\n$$ f(x \\mid \\mu, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right) $$\n首先，我们计算在观测值 $s=1.1$ 下，流感假设的似然。参数为 $\\mu_F = 2.0$ 和 $\\sigma^2 = 1.0$。\n$$ p(s=1.1 \\mid \\text{Flu}) = \\frac{1}{\\sqrt{2\\pi(1.0)}} \\exp\\left(-\\frac{(1.1 - 2.0)^2}{2(1.0)}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(-0.9)^2}{2}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-0.405) $$\n其次，我们计算在观测值 $s=1.1$ 下，链球菌假设的似然。参数为 $\\mu_S = 0.0$ 和 $\\sigma^2 = 1.0$。\n$$ p(s=1.1 \\mid \\text{Strep}) = \\frac{1}{\\sqrt{2\\pi(1.0)}} \\exp\\left(-\\frac{(1.1 - 0.0)^2}{2(1.0)}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1.1^2}{2}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-0.605) $$\n给定的先验概率为 $P(\\text{Flu}) = 0.6$ 和 $P(\\text{Strep}) = 0.4$。\n\n现在，我们将这些组成部分代入贝叶斯定理。注意，归一化常数 $\\frac{1}{\\sqrt{2\\pi}}$ 将在分子和分母中被约掉。\n$$ P(\\text{Flu} \\mid s=1.1) = \\frac{\\exp(-0.405) \\cdot 0.6}{\\exp(-0.405) \\cdot 0.6 + \\exp(-0.605) \\cdot 0.4} $$\n现在我们计算数值：\n分子是：\n$$ 0.6 \\cdot \\exp(-0.405) \\approx 0.6 \\cdot 0.6669768 = 0.40018608 $$\n分母是：\n$$ (0.6 \\cdot \\exp(-0.405)) + (0.4 \\cdot \\exp(-0.605)) \\approx 0.40018608 + (0.4 \\cdot 0.5460835) $$\n$$ \\approx 0.40018608 + 0.2184334 = 0.61861948 $$\n后验概率是该比率：\n$$ P(\\text{Flu} \\mid s=1.1) \\approx \\frac{0.40018608}{0.61861948} \\approx 0.6468750... $$\n问题要求答案四舍五入到四位有效数字。\n$$ P(\\text{Flu} \\mid s=1.1) \\approx 0.6469 $$", "answer": "$$\n\\boxed{0.6469}\n$$", "id": "2400344"}, {"introduction": "贝叶斯推断的真正力量不仅在于估计参数，更在于利用这些参数的完整后验分布来得出科学结论。这个练习将焦点从参数估计转移到假设检验上。你将看到，一旦我们获得了参数的后验分布，我们就可以回答诸如“基因 $A$ 的表达水平高于基因 $B$ 的概率是多少？”这类更深层次的问题，这在差异表达分析等领域中至关重要 [@problem_id:2400372]。", "problem": "一项关于差异基因表达的研究，在多个生物学重复中比较了基因 A 和基因 B 的真实平均对数表达水平。设基因 A 的真实平均对数表达为 $\\mu_A$，基因 B 的为 $\\mu_B$。经由使用共轭先验和高斯似然的贝叶斯分析，得到这些参数的后验分布为相互独立的正态分布：$P(\\mu_A \\mid \\text{data}) \\sim \\mathcal{N}(10, 1)$ 及 $P(\\mu_B \\mid \\text{data}) \\sim \\mathcal{N}(8, 1)$，其中第一个参数为均值，第二个参数为方差。假设在后验分布下，$\\mu_A$ 和 $\\mu_B$ 相互独立。\n\n计算基因 A 表达高于基因 B 的后验概率，即计算 $P(\\mu_A > \\mu_B \\mid \\text{data})$。请将答案四舍五入到 $4$ 位有效数字。", "solution": "该问题要求计算基因 A 的真实平均对数表达（记为 $\\mu_A$）大于基因 B 的真实平均对数表达（记为 $\\mu_B$）的后验概率，即 $P(\\mu_A > \\mu_B \\mid \\text{data})$。\n\n给定的条件是 $\\mu_A$ 和 $\\mu_B$ 的后验分布：\n1.  $\\mu_A$ 的后验分布是均值为 $10$、方差为 $1$ 的正态分布： $\\mu_A \\mid \\text{data} \\sim \\mathcal{N}(\\mu_{A,p}, \\sigma^2_{A,p})$，其中 $\\mu_{A,p} = 10$ 且 $\\sigma^2_{A,p} = 1$。\n2.  $\\mu_B$ 的后验分布是均值为 $8$、方差为 $1$ 的正态分布： $\\mu_B \\mid \\text{data} \\sim \\mathcal{N}(\\mu_{B,p}, \\sigma^2_{B,p})$，其中 $\\mu_{B,p} = 8$ 且 $\\sigma^2_{B,p} = 1$。\n3.  随机变量 $\\mu_A$ 和 $\\mu_B$ 在其后验分布下相互独立。\n\n为了计算 $P(\\mu_A > \\mu_B \\mid \\text{data})$，我们可以将该不等式重写为 $\\mu_A - \\mu_B > 0$。我们定义一个新随机变量 $D = \\mu_A - \\mu_B$。问题就转化为计算 $P(D > 0 \\mid \\text{data})$。\n\n正态分布的一个基本性质指出，相互独立的正态随机变量的线性组合仍然是正态随机变量。$D$ 的分布是正态分布，其均值和方差计算如下：\n\n$D$ 的均值是 $\\mu_A$ 和 $\\mu_B$ 的均值之差：\n$$E[D] = E[\\mu_A] - E[\\mu_B] = \\mu_{A,p} - \\mu_{B,p} = 10 - 8 = 2$$\n\n因为 $\\mu_A$ 和 $\\mu_B$ 相互独立，所以 $D$ 的方差是 $\\mu_A$ 和 $\\mu_B$ 的方差之和：\n$$\\text{Var}(D) = \\text{Var}(\\mu_A - \\mu_B) = \\text{Var}(\\mu_A) + (-1)^2 \\text{Var}(\\mu_B) = \\sigma^2_{A,p} + \\sigma^2_{B,p} = 1 + 1 = 2$$\n\n因此，差值 $D$ 的分布为 $D \\mid \\text{data} \\sim \\mathcal{N}(2, 2)$。其均值为 $\\mu_D = 2$，方差为 $\\sigma^2_D = 2$。标准差为 $\\sigma_D = \\sqrt{2}$。\n\n我们现在需要计算 $P(D > 0)$。为此，我们将随机变量 $D$ 标准化为标准正态变量 $Z \\sim \\mathcal{N}(0, 1)$，其变换为 $Z = \\frac{D - \\mu_D}{\\sigma_D}$。\n$$P(D > 0) = P\\left(\\frac{D - \\mu_D}{\\sigma_D} > \\frac{0 - \\mu_D}{\\sigma_D}\\right)$$\n代入 $\\mu_D$ 和 $\\sigma_D$ 的值：\n$$P(D > 0) = P\\left(Z > \\frac{0 - 2}{\\sqrt{2}}\\right) = P(Z > -\\sqrt{2})$$\n根据标准正态分布的对称性，概率 $P(Z > -z)$ 等于 $P(Z < z)$。因此：\n$$P(Z > -\\sqrt{2}) = P(Z < \\sqrt{2})$$\n这个概率是标准正态分布的累积分布函数 (CDF)（记为 $\\Phi(z)$）在 $z = \\sqrt{2}$ 处的值。\n$$P(\\mu_A > \\mu_B \\mid \\text{data}) = \\Phi(\\sqrt{2})$$\n$\\sqrt{2}$ 的数值约为 $1.41421356...$。使用标准正态概率表或计算工具，我们求得 $\\Phi(\\sqrt{2})$ 的值。\n$$\\Phi(\\sqrt{2}) \\approx \\Phi(1.4142) \\approx 0.92135039...$$\n问题要求答案四舍五入到 $4$ 位有效数字。第五位有效数字是 $5$，因此需要将第四位数字进位。\n$$0.92135... \\approx 0.9214$$\n因此，基因 A 表达高于基因 B 的后验概率约为 $0.9214$。", "answer": "$$\\boxed{0.9214}$$", "id": "2400372"}]}