{"hands_on_practices": [{"introduction": "在我们深入研究预测蛋白质二级结构的计算方法之前，首先必须掌握其物理基础。蛋白质的骨架构象受到严格的立体化学限制，这些限制可以通过拉马钱德兰图（Ramachandran plot）上的主链二面角$\\phi$和$\\psi$来可视化。这个练习将挑战你思考一个基本问题：如果构成蛋白质的基本单元——氨基酸——的手性发生反转，其理想的螺旋构象会发生什么变化？通过这个思想实验[@problem_id:2421209]，你将加深对立体化学如何决定蛋白质结构可能性的理解。", "problem": "在计算结构生物学中，多肽所允许的主链扭转角在 Ramachandran 图上总结为数对 $\\left(\\phi,\\psi\\right)$，其中 $\\phi$ 是绕 $N$–$C_{\\alpha}$ 键的二面角，而 $\\psi$ 是绕 $C_{\\alpha}$–$C^{\\prime}$ 键的二面角。每个二面角的符号在固定的实验室坐标系中由右手定则定义。对于由常见的 L-氨基酸和反式肽键构成的多肽，一个理想的右手 $\\alpha$-螺旋占据一个紧凑的区域，其角度近似为 $\\left(\\phi_{0},\\psi_{0}\\right)$，且 $\\phi_{0}<0$ 和 $\\psi_{0}<0$。\n\n假设构造一个假设的螺旋，其构造方式完全相同，但每个残基都是其对映异构体（即 $C_{\\alpha}$ 立体中心反转），且肽键保持为反式。用原始的理想螺旋角 $\\left(\\phi_{0},\\psi_{0}\\right)$ 来表示，哪种变换最能描述这个对映异构螺旋的理想 $\\left(\\phi,\\psi\\right)$ 角？\n\nA. 它们保持不变：$\\left(\\phi,\\psi\\right)=\\left(\\phi_{0},\\psi_{0}\\right)$。\n\nB. 两个角度都变号：$\\left(\\phi,\\psi\\right)=\\left(-\\phi_{0},-\\psi_{0}\\right)$。\n\nC. 它们互换：$\\left(\\phi,\\psi\\right)=\\left(\\psi_{0},\\phi_{0}\\right)$。\n\nD. 只有一个变号：$\\left(\\phi,\\psi\\right)=\\left(\\phi_{0},-\\psi_{0}\\right)$。\n\nE. 两个角度都增加 $180^{\\circ}$: $\\left(\\phi,\\psi\\right)=\\left(\\phi_{0}+180^{\\circ},\\psi_{0}+180^{\\circ}\\right)$。", "solution": "这个问题的核心是理解对映异构（手性反转）对多肽主链二面角的影响。一个分子的对映异构体是其不可重叠的镜像。在几何上，进行镜像操作会使所有二面角的符号反转。\n\n原始结构是一个由L-氨基酸构成的右手α-螺旋，其理想二面角为 $(\\phi_0, \\psi_0)$。当所有L-氨基酸被它们的D-对映异构体替换后，形成的稳定螺旋将是原始螺旋的镜像，即一个左手α-螺旋。由于镜像反转了二面角的符号，所以新螺旋的理想角度 $(\\phi, \\psi)$ 将是 $(-\\phi_0, -\\psi_0)$。这对应于拉马钱德兰图上关于原点的点对称变换。因此，选项B是正确的。\n\n其他选项分析如下：\n- **A. 保持不变：** 这是不正确的。由于D-氨基酸的侧链与主链的立体化学关系不同，它在L-氨基酸的稳定区域（如右手α-螺旋的 $\\phi, \\psi$ 角）会产生严重的立体冲突。\n- **C, D, E. 互换、单边变号或增加180°：** 这些变换与镜像操作的几何性质不符，没有物理化学基础。", "answer": "$$\\boxed{B}$$", "id": "2421209"}, {"introduction": "早期的二级结构预测方法，如Chou-Fasman法，基于一个核心思想：不同的氨基酸对形成特定结构（如$\\alpha$-螺旋或$\\beta$-折叠）有着不同的“倾向性”或“潜能”。这个练习让你亲手操作一个简化的Chou-Fasman模型，计算给定肽段形成螺旋和折叠核心的潜能。通过这个过程[@problem_id:2421491]，你不仅能理解基于潜能的预测是如何工作的，还将直面并解决当一个区域同时具有形成两种结构潜力时出现的预测模糊性问题。", "problem": "给定一种简化的、自洽的Chou–Fasman方法实现，用于识别蛋白质二级结构的成核片段。对于每个氨基酸残基，定义了两种内在倾向性：α-螺旋倾向性 $P_{\\alpha}$ 和β-折叠倾向性 $P_{\\beta}$。在本问题中，螺旋核和折叠核均定义在一个长度为 $6$ 个残基的连续片段上，其标准如下：\n\n- 螺旋核是任何长度为 $6$ 的连续片段，其平均α-螺旋倾向性 $\\overline{P_{\\alpha}}$ 超过 $1.03$，并且其中至少 $4$ 个残基的 $P_{\\alpha} > 1.03$。\n- 折叠核是任何长度为 $6$ 的连续片段，其平均β-折叠倾向性 $\\overline{P_{\\beta}}$ 超过 $1.05$，并且其中至少 $4$ 个残基的 $P_{\\beta} > 1.05$。\n\n当单个片段同时满足两种成核标准（即螺旋核与折叠核完全重叠）时，应用以下确定性解析规则。定义解析分数\n$$\nR \\;=\\; \\overline{P_{\\alpha}} \\;-\\; \\overline{P_{\\beta}} \\, .\n$$\n如果 $R > 0$，该片段被指定为螺旋；如果 $R < 0$，该片段被指定为折叠；如果 $R = 0$，该片段被指定为折叠。\n\n考虑一个由 $6$ 个残基组成的蛋白质片段（单字母代码）$S = \\text{``VILFWV''}$。对于片段 $S$ 中存在的残基，使用以下Chou–Fasman残基倾向性：\n\n- Valine (V): $P_{\\alpha} = 1.06$, $P_{\\beta} = 1.70$。\n- Isoleucine (I): $P_{\\alpha} = 1.08$, $P_{\\beta} = 1.60$。\n- Leucine (L): $P_{\\alpha} = 1.34$, $P_{\\beta} = 1.22$。\n- Phenylalanine (F): $P_{\\alpha} = 1.12$, $P_{\\beta} = 1.38$。\n- Tryptophan (W): $P_{\\alpha} = 1.14$, $P_{\\beta} = 1.19$。\n\n计算上述定义的片段$S$的解析分数$R$。将最终答案表示为一个无量纲实数，并四舍五入到四位有效数字。", "solution": "所给问题是计算生物学中一个明确定义的练习，具体来说是应用一种简化的类Chou-Fasman算法的规则。该问题是自洽的，在生物信息学方法的背景下具有科学依据，并且没有歧义或矛盾。所有必要的数据和定义都已提供。因此，该问题被认为是有效的，可以构建一个正式的解决方案。\n\n任务是计算6残基蛋白质片段 $S = \\text{``VILFWV''}$ 的解析分数$R$。该片段由以下氨基酸组成：Valine (V)、Isoleucine (I)、Leucine (L)、Phenylalanine (F) 和 Tryptophan (W)。具体序列为 V($1$)、I($2$)、L($3$)、F($4$)、W($5$)、V($6$)。\n\n给定以下α-螺旋（$P_{\\alpha}$）和β-折叠（$P_{\\beta}$）的内在倾向性：\n- Valine (V): $P_{\\alpha} = 1.06$, $P_{\\beta} = 1.70$\n- Isoleucine (I): $P_{\\alpha} = 1.08$, $P_{\\beta} = 1.60$\n- Leucine (L): $P_{\\alpha} = 1.34$, $P_{\\beta} = 1.22$\n- Phenylalanine (F): $P_{\\alpha} = 1.12$, $P_{\\beta} = 1.38$\n- Tryptophan (W): $P_{\\alpha} = 1.14$, $P_{\\beta} = 1.19$\n\n首先，我们必须计算该片段的平均α-螺旋倾向性 $\\overline{P_{\\alpha}}$。这是该片段中每个残基的$P_{\\alpha}$值的算术平均值。\n片段“VILFWV”的$P_{\\alpha}$值分别为：$1.06$、$1.08$、$1.34$、$1.12$、$1.14$ 和 $1.06$。\n这些倾向性之和为：\n$$\n\\sum P_{\\alpha} = 1.06 + 1.08 + 1.34 + 1.12 + 1.14 + 1.06 = 6.80\n$$\n平均α-螺旋倾向性是总和除以残基数（即$6$）：\n$$\n\\overline{P_{\\alpha}} = \\frac{\\sum P_{\\alpha}}{6} = \\frac{6.80}{6} \\approx 1.1333\n$$\n\n接下来，我们计算同一片段的平均β-折叠倾向性 $\\overline{P_{\\beta}}$。\n片段“VILFWV”的$P_{\\beta}$值分别为：$1.70$、$1.60$、$1.22$、$1.38$、$1.19$ 和 $1.70$。\n这些倾向性之和为：\n$$\n\\sum P_{\\beta} = 1.70 + 1.60 + 1.22 + 1.38 + 1.19 + 1.70 = 8.79\n$$\n平均β-折叠倾向性是：\n$$\n\\overline{P_{\\beta}} = \\frac{\\sum P_{\\beta}}{6} = \\frac{8.79}{6} = 1.465\n$$\n\n在计算解析分数之前，我们必须严格验证该片段是否同时满足螺旋核和折叠核的标准。\n\n对于螺旋核：\n$1$. 平均倾向性 $\\overline{P_{\\alpha}}$ 必须超过 $1.03$。我们计算出 $\\overline{P_{\\alpha}} \\approx 1.1333$，而 $1.1333 > 1.03$。此条件满足。\n$2$. $6$个残基中至少有$4$个必须满足 $P_{\\alpha} > 1.03$。各个$P_{\\alpha}$值为$1.06$、$1.08$、$1.34$、$1.12$、$1.14$、$1.06$。这$6$个值都大于$1.03$。由于$6 \\ge 4$，此条件也满足。\n因此，该片段符合螺旋核的条件。\n\n对于折叠核：\n$1$. 平均倾向性 $\\overline{P_{\\beta}}$ 必须超过 $1.05$。我们计算出 $\\overline{P_{\\beta}} = 1.465$，而 $1.465 > 1.05$。此条件满足。\n$2$. $6$个残基中至少有$4$个必须满足 $P_{\\beta} > 1.05$。各个$P_{\\beta}$值为$1.70$、$1.60$、$1.22$、$1.38$、$1.19$、$1.70$。这$6$个值都大于$1.05$。由于$6 \\ge 4$，此条件也满足。\n因此，该片段符合折叠核的条件。\n\n由于该片段满足两套标准，这是一个需要解析的模糊情况。我们通过计算分数$R$来应用解析规则：\n$$\nR = \\overline{P_{\\alpha}} - \\overline{P_{\\beta}}\n$$\n代入计算出的平均值：\n$$\nR = \\frac{6.80}{6} - \\frac{8.79}{6} = \\frac{6.80 - 8.79}{6} = \\frac{-1.99}{6}\n$$\n现在，我们计算其数值：\n$$\nR \\approx -0.331666...\n$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是$3$、$3$、$1$、$6$。第五位数字是$6$，这意味着我们必须将最后一位有效数字向上取整。\n$$\nR \\approx -0.3317\n$$\n根据解析规则，由于 $R < 0$，这个模糊片段将被指定为折叠。然而，问题只要求计算$R$的值。\n最终计算出的解析分数$R$的值为$-0.3317$。", "answer": "$$\n\\boxed{-0.3317}\n$$", "id": "2421491"}, {"introduction": "更高级的预测方法不仅考虑单个氨基酸的倾向性，还会分析二级结构元素之间的序列关联性。例如，一个$\\alpha$-螺旋后面更可能跟一个无规卷曲（coil）还是一个$\\beta$-折叠？本练习将指导你使用一阶马尔可夫链来为二级结构序列建模，这是一种强大的统计工具。你将学习如何从真实数据中计算状态转移概率，例如从卷曲到螺旋的概率$P(H|C)$，并应用拉普拉斯平滑（Laplace smoothing）技术来处理数据稀疏问题[@problem_id:2421171]，从而建立一个更稳健的预测模型。", "problem": "给定一组基于蛋白质二级结构状态有限字母表 $\\{H, E, C\\}$ 的序列，其中 $H$ 表示 $\\alpha$-螺旋，$E$ 表示 $\\beta$-折叠，$C$ 表示无规卷曲。将这些序列建模为由状态空间 $S = \\{H, E, C\\}$ 上的时间齐次一阶马尔可夫链生成。对于每个有序对 $(i, j) \\in S \\times S$，令 $n_{ij}$ 表示通过扫描所有序列找到的从状态 $i$ 到状态 $j$ 的相邻转移的总计数，将序列中每对相邻状态计为一次转移。一个长度为 $L$ 的序列恰好贡献 $L-1$ 次转移，没有起始或结束标记。\n\n对于给定的非负平滑参数 $\\alpha \\in \\mathbb{R}_{\\ge 0}$，通过拉普拉斯（加-$\\alpha$）平滑定义估计的转移概率为\n$$\n\\hat{P}(j \\mid i) \\;=\\; \\frac{n_{ij} + \\alpha}{\\sum_{k \\in S} n_{ik} + \\alpha \\, |S|},\n$$\n其中 $|S| = 3$。当 $\\alpha = 0$ 时，这简化为基于相对频率的最大似然估计。所有概率值都必须表示为精确到 $6$ 位小数的小数。\n\n测试套件。对于以下每个案例，您将获得：\n- 一个基于 $\\{H,E,C\\}$ 的序列列表，\n- 一个平滑参数 $\\alpha$，\n- 一个有序查询对 $(i,j)$，\n\n而您必须计算单个值 $\\hat{P}(j \\mid i)$。\n\n- 案例 A:\n  - 序列: [\"HEHEHE\"]\n  - $\\alpha = 0$\n  - 查询对 $(i,j) = (E, H)$\n- 案例 B:\n  - 序列: [\"HHHH\"]\n  - $\\alpha = 0.5$\n  - 查询对 $(i,j) = (H, E)$\n- 案例 C:\n  - 序列: [\"HH\", \"CC\"]\n  - $\\alpha = 1.0$\n  - 查询对 $(i,j) = (E, H)$\n- 案例 D:\n  - 序列: [\"HHHEECCC\", \"HECHHEE\", \"CCCEEEHHH\"]\n  - $\\alpha = 0$\n  - 查询对 $(i,j) = (C, C)$\n- 案例 E:\n  - 序列: [\"EE\"]\n  - $\\alpha = 0.25$\n  - 查询对 $(i,j) = (E, H)$\n\n最终输出格式。您的程序应生成单行输出，其中包含案例 A 到 E 的结果，按顺序排列，格式为一个用方括号括起来的逗号分隔列表。每个条目必须是 $\\hat{P}(j \\mid i)$ 精确到 $6$ 位小数的小数值。例如，一个有效的格式是“[rA,rB,rC,rD,rE]”，其中每个 rX 是一个精确到 $6$ 位小数的小数。不应打印任何额外的字符或行。", "solution": "该问题是有效的。它在科学上基于概率序列建模的原理，特别是使用一阶马尔可夫链，这是计算生物学中的一种标准方法。该问题是适定的、客观的，并为计算每个测试用例的唯一解提供了所有必要信息。拉普拉斯平滑的公式表述正确，且测试用例在计算上是可行的。\n\n目标是计算状态空间 $S = \\{H, E, C\\}$ 上的一阶马尔可夫链的估计转移概率 $\\hat{P}(j \\mid i)$。状态空间大小为 $|S| = 3$。使用加-$\\alpha$平滑进行估计，根据以下公式：\n$$\n\\hat{P}(j \\mid i) \\;=\\; \\frac{n_{ij} + \\alpha}{\\sum_{k \\in S} n_{ik} + \\alpha \\, |S|}\n$$\n其中 $n_{ij}$ 表示观察到的从状态 $i$ 到状态 $j$ 的转移计数，$\\alpha \\ge 0$ 是平滑参数。\n\n每个测试用例的步骤如下：\n1.  构建一个 $3 \\times 3$ 的转移计数矩阵 $N$，其中条目 $n_{ij}$ 存储从状态 $i$ 到状态 $j$ 的转移次数。这通过扫描所有提供的序列来完成。长度为 $L$ 的序列中每对相邻字符贡献一次转移，每个序列总共有 $L-1$ 次转移。\n2.  确定查询对 $(i,j)$ 和平滑参数 $\\alpha$。\n3.  从矩阵 $N$ 中提取特定计数 $n_{ij}$。\n4.  计算源自状态 $i$ 的总转移数，即矩阵 $N$ 的第 $i$ 行之和：$\\sum_{k \\in S} n_{ik}$。\n5.  将这些值代入给定公式以计算 $\\hat{P}(j \\mid i)$。\n6.  将最终概率四舍五入到 $6$ 位小数。\n\n**案例 A:**\n- 序列: `[\"HEHEHE\"]`；$\\alpha = 0$；查询: $(E, H)$\n- 转移计数：$n_{HE} = 3, n_{EH} = 2$。\n- 从状态 $E$ 的总转移：$\\sum n_{Ek} = n_{EH} = 2$。\n- $\\hat{P}(H \\mid E) = (2 + 0) / (2 + 0 \\cdot 3) = 1.000000$。\n\n**案例 B:**\n- 序列: `[\"HHHH\"]`；$\\alpha = 0.5$；查询: $(H, E)$\n- 转移计数：$n_{HH} = 3$。\n- 从状态 $H$ 的总转移：$\\sum n_{Hk} = n_{HH} = 3$。\n- $\\hat{P}(E \\mid H) = (0 + 0.5) / (3 + 0.5 \\cdot 3) = 0.5 / 4.5 = 1/9 \\approx 0.111111$。\n\n**案例 C:**\n- 序列: `[\"HH\", \"CC\"]`；$\\alpha = 1.0$；查询: $(E, H)$\n- 转移计数：$n_{HH} = 1, n_{CC} = 1$。\n- 从状态 $E$ 的总转移：$\\sum n_{Ek} = 0$。\n- $\\hat{P}(H \\mid E) = (0 + 1.0) / (0 + 1.0 \\cdot 3) = 1/3 \\approx 0.333333$。\n\n**案例 D:**\n- 序列: `[\"HHHEECCC\", \"HECHHEE\", \"CCCEEEHHH\"]`；$\\alpha = 0$；查询: $(C, C)$\n- 总计数：$n_{CC} = 4, n_{CH} = 1, n_{CE} = 1$。\n- 从状态 $C$ 的总转移：$\\sum n_{Ck} = 4 + 1 + 1 = 6$。\n- $\\hat{P}(C \\mid C) = (4 + 0) / (6 + 0 \\cdot 3) = 4/6 = 2/3 \\approx 0.666667$。\n\n**案例 E:**\n- 序列: `[\"EE\"]`；$\\alpha = 0.25$；查询: $(E, H)$\n- 转移计数：$n_{EE} = 1$。\n- 从状态 $E$ 的总转移：$\\sum n_{Ek} = 1$。\n- $\\hat{P}(H \\mid E) = (0 + 0.25) / (1 + 0.25 \\cdot 3) = 0.25 / 1.75 = 1/7 \\approx 0.142857$。", "answer": "[1.000000,0.111111,0.333333,0.666667,0.142857]", "id": "2421171"}]}