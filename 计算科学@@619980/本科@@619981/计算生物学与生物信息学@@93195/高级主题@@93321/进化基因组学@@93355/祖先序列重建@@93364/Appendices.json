{"hands_on_practices": [{"introduction": "在本节中，我们将通过亲身实践来巩固对祖先序列重建的理解。第一个练习将我们带回到祖先推断最基本的方法：最大简约法。通过一个精心设计的四序列场景，你将亲手应用简约法则来推断祖先状态，并会发现即使在这种最简单的方法中，我们有时也会面临不确定性，即“模糊”的重建结果 [@problem_id:2099385]。这个练习旨在揭示简约法的核心逻辑及其固有的局限性。", "problem": "在进化生物学领域，祖先序列重建是一种计算方法，用于推断已灭绝祖先的蛋白质或核酸序列。完成这项任务最简单、最基本的方法之一是最大简约性原则。该原则指出，首选的进化历史是需要最少进化变化（例如氨基酸取代）来解释在现代生物体中观察到的序列的那个历史。\n\n考虑一组四个同源蛋白：P1、P2、P3和P4。它们的进化关系由系统发育树 `((P1, P2)Anc1, (P3, P4)Anc2)Anc-Root` 描述。这种表示法意味着P1和P2共享一个近期共同祖先Anc1。同样，P3和P4共享一个近期共同祖先Anc2。而Anc1和Anc2又都源自这四个蛋白质的最后共同祖先Anc-Root。\n\n我们正在检查这四个蛋白质序列比对中的一个单一位置。对于树中的任何给定祖先，如果单一氨基酸状态能使其到后代的总取代数最小化，则该位置氨基酸的重建被认为是“明确的”。相反，如果两种或多种不同的氨基酸状态同样简约，即它们导致相同的最小取代数，则重建是“不明确的”。\n\n以下选项列出了在四个现代蛋白质（P1、P2、P3、P4）的该特定位置上发现的氨基酸，使用它们的标准单字母代码。下列哪种情景会导致根祖先Anc-Root的重建是不明确的，同时又确保*两个*中间祖先Anc1和Anc2的重建都是明确的？\n\nA. P1: 丙氨酸 (A), P2: 丙氨酸 (A), P3: 甘氨酸 (G), P4: 甘氨酸 (G)\n\nB. P1: 半胱氨酸 (C), P2: 半胱氨酸 (C), P3: 半胱氨酸 (C), P4: 半胱氨酸 (C)\n\nC. P1: 亮氨酸 (L), P2: 亮氨酸 (L), P3: 亮氨酸 (L), P4: 缬氨酸 (V)\n\nD. P1: 脯氨酸 (P), P2: 丝氨酸 (S), P3: 脯氨酸 (P), P4: 丝氨酸 (S)\n\nE. P1: 苏氨酸 (T), P2: 天冬氨酸 (D), P3: 谷氨酸 (E), P4: 苯丙氨酸 (F)", "solution": "我们在有根二叉树 $((P1,P2)\\,\\text{Anc1},\\,(P3,P4)\\,\\text{Anc2})\\,\\text{Anc-Root}$ 上使用Fitch简约法。对于任何具有子节点状态集 $S_{L}$ 和 $S_{R}$ 的节点，其最小状态集为\n$$\nS=\\begin{cases}\nS_{L}\\cap S_{R}, & \\text{if } S_{L}\\cap S_{R}\\neq \\varnothing,\\\\\nS_{L}\\cup S_{R}, & \\text{if } S_{L}\\cap S_{R}=\\varnothing.\n\\end{cases}\n$$\n如果一个节点的状态集大小为1，则该节点是明确的；如果状态集大小至少为2，则该节点是不明确的。\n\n选项 A：P1=A, P2=A, P3=G, P4=G。\nAnc1: $S_{1}=\\{A\\}\\cap\\{A\\}=\\{A\\}$ (明确)。\nAnc2: $S_{2}=\\{G\\}\\cap\\{G\\}=\\{G\\}$ (明确)。\n根节点: $S_{R}=\\{A\\}\\cap\\{G\\}=\\varnothing \\Rightarrow S_{R}=\\{A,G\\}$ (不明确)。\n这满足要求。\n\n选项 B：全部为C。\nAnc1: $\\{C\\}$；Anc2: $\\{C\\}$；根节点: $\\{C\\}\\cap\\{C\\}=\\{C\\}$ (明确)。不符合要求。\n\n选项 C: P1=L, P2=L; P3=L, P4=V。\nAnc1: $\\{L\\}$ (明确)。\nAnc2: $\\{L\\}\\cap\\{V\\}=\\varnothing \\Rightarrow \\{L,V\\}$ (不明确)。\n根节点: $\\{L\\}\\cap\\{L,V\\}=\\{L\\}$ (明确)。不符合要求。\n\n选项 D: P1=P, P2=S; P3=P, P4=S。\nAnc1: $\\{P,S\\}$ (不明确)。\nAnc2: $\\{P,S\\}$ (不明确)。\n根节点: $\\{P,S\\}\\cap\\{P,S\\}=\\{P,S\\}$ (不明确)。不符合要求。\n\n选项 E: P1=T, P2=D; P3=E, P4=F。\nAnc1: $\\{T,D\\}$ (不明确)。\nAnc2: $\\{E,F\\}$ (不明确)。\n根节点: $\\{T,D\\}\\cap\\{E,F\\}=\\varnothing \\Rightarrow \\{T,D,E,F\\}$ (不明确)。不符合要求。\n\n因此，只有选项A能得出不明确的根节点，同时Anc1和Anc2都是明确的。", "answer": "$$\\boxed{A}$$", "id": "2099385"}, {"introduction": "从简约法的直观逻辑过渡到概率模型的严谨世界，第二个练习探讨了一个在演化分析中至关重要的问题。当所有现存后代在一个位点上都呈现相同状态时，我们能以多大的把握确定其祖先也是这个状态？[@problem_id:2372346] 这个思想实验将挑战你的直觉，并阐明分支长度（即演化时间）在概率性祖先重建中如何深刻地影响我们的置信度，这恰恰是概率方法相比简约法更为精妙之处。", "problem": "考虑一个具有固定拓扑结构和严格为正的分支长度（以每个位点的预期替换数度量）的有根系统发育树。假设沿着每个分支的序列演化遵循一个均匀、平稳、可逆的连续时间马尔可夫链 (CTMC)，其速率矩阵为 $Q$，在大小为 $k$ 的字母表上的平衡（平稳）分布为 $\\boldsymbol{\\pi}$，转移矩阵为 $P(t)=\\exp(Qt)$。假定在某个特定位点上，所有现存分类单元（叶节点）均被观察到处于同一状态 $x$。设根节点状态的先验分布为 $\\boldsymbol{\\pi}$。设总树长为所有分支长度之和，记为 $L_{\\mathrm{tot}}$。在概率性祖先序列重建（例如，在所述模型下的最大似然法或根节点的贝叶斯后验边缘概率）下，关于此位点的根节点状态是否以 $100\\%$ 的概率被推断为 $x$ 以及 $L_{\\mathrm{tot}}$ 如何影响该概率，以下哪个陈述是正确的？\n\nA. 是。如果所有叶节点都处于状态 $x$，则根节点必须以 $100\\%$ 的概率被推断为 $x$，这与 $L_{\\mathrm{tot}}$ 和模型无关，因为不需要发生任何变化。\n\nB. 否。对于一个具有严格为正的非对角线速率和根节点先验 $\\boldsymbol{\\pi}$ 的不可约CTMC，只要所有分支长度都严格为正，根节点为 $x$ 的后验概率就严格小于 $1$；当所有分支按比例缩放使得 $L_{\\mathrm{tot}}\\to 0$ 时，该概率趋近于 $1$；当所有分支按比例缩放得很长使得 $L_{\\mathrm{tot}}\\to \\infty$ 时，该概率趋近于 $\\pi_{x}$。\n\nC. 在最大简约法 (MP) 下是。该方法将根节点为 $x$ 的概率赋为 $1$，因为其简约分数为 $0$；因此，概率性方法也必须将概率赋为 $1$。\n\nD. 只要所有叶节点都为 $x$，根节点为 $x$ 的后验概率就恒为 $1/k$，这与 $L_{\\mathrm{tot}}$ 和 $\\boldsymbol{\\pi}$ 无关。\n\nE. 根节点为 $x$ 的后验概率随 $L_{\\mathrm{tot}}$ 的增加而增加，因为更长的树为根节点状态传递到叶节点提供了更多时间；因此，在更长的树上，观察到所有叶节点都为 $x$ 会使得根节点为 $x$ 的可能性更大。", "solution": "我们感兴趣的量是：在给定所有叶节点都处于状态 $x$ 的数据 $D$ 的情况下，根节点状态 $S_r$ 为 $x$ 的后验概率。根据贝叶斯定理，此概率为：\n$$ P(S_r = x | D) = \\frac{P(D | S_r = x) P(S_r = x)}{P(D)} $$\n先验给定为对于任何状态 $y$，都有 $P(S_r = y) = \\pi_y$。分母是数据的边缘似然，通过对所有可能的根节点状态求和得到：\n$$ P(D) = \\sum_{y} P(D | S_r = y) P(S_r = y) = \\sum_{y} P(D | S_r = y) \\pi_y $$\n项 $P(D | S_r = y)$ 是在给定根节点状态为 $y$ 时数据的似然，可以使用Felsenstein的剪枝算法计算。设 $L_v(i)$ 是在给定节点 $v$ 的状态为 $i$ 的条件下，从节点 $v$ 向下延伸的子树中观察到的状态的条件似然。对于本题，给定根节点状态的似然是 $L_r(y)$。\n因此，后验概率可以写为：\n$$ P(S_r = x | D) = \\frac{L_r(x) \\pi_x}{\\sum_{y} L_r(y) \\pi_y} $$\n问题假设了一个不可约的CTMC（这是典型生物学模型的引申含义，并在选项B中说明）和严格为正的分支长度。一个不可约的CTMC保证了对于任何时间 $t > 0$，从任意状态 $i$ 到任意状态 $j$ 的转移概率 $P_{ij}(t)$ 都是严格为正的。因为所有分支长度都严格为正，所以存在这样一种演化历史的可能性：根节点处于一个状态 $y \\neq x$，而随后的突变导致所有叶节点都变成了状态 $x$。例如，从 $y$ 到 $x$ 的突变可能发生在从根节点向下的两个分支上，然后状态 $x$ 被一直保留到叶节点。这样一系列事件的概率是非零的。\n因此，通过剪枝算法计算出的似然 $L_r(y)$ 对于字母表中的所有状态 $y$ 都将是严格为正的。考虑到对于一个不可约模型，平衡概率 $\\pi_y$ 也是严格为正的，分母 $\\sum_{y} L_r(y) \\pi_y$ 将严格大于分子项 $L_r(x) \\pi_x$ （假设字母表大小 $k > 1$）。因此，对于任何一组严格为正的分支长度，后验概率 $P(S_r = x | D)$ 都严格小于 $1$。\n\n接下来，我们分析该概率作为总树长 $L_{\\mathrm{tot}}$ 函数的行为。让我们考虑将所有分支长度 $t_i$ 按因子 $s \\ge 0$ 进行缩放。\n\n情况1：$L_{\\mathrm{tot}} \\to 0$（即 $s \\to 0$）。\n当 $t \\to 0$ 时，转移矩阵 $P(t) = \\exp(Qt)$ 趋近于单位矩阵 $I$。因此，$P_{ij}(t) \\to \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克δ函数。没有替换发生。在应用剪枝算法时，任何节点 $v$ 的似然 $L_v(i)$ 将会把“状态必须为 $x$”这一要求从叶节点向上“传播”。在极限情况下，$L_r(i) \\to \\delta_{ix}$。这意味着 $L_r(x) \\to 1$，并且对于所有 $y \\ne x$，$L_r(y) \\to 0$。\n后验概率变为：\n$$ \\lim_{L_{\\mathrm{tot}} \\to 0} P(S_r = x | D) = \\frac{1 \\cdot \\pi_x}{1 \\cdot \\pi_x + \\sum_{y \\ne x} 0 \\cdot \\pi_y} = 1 $$\n\n情况2：$L_{\\mathrm{tot}} \\to \\infty$（即 $s \\to \\infty$）。\n当 $t \\to \\infty$ 时，CTMC收敛到其平穩分布。转移概率 $P_{ij}(t)$ 趋近于 $\\pi_j$，与起始状态 $i$ 无关。任何节点的状态都与其由一个非常长的分支隔开的任何祖先节点的状态无关。在此极限下，叶节点的状态与根节点的状态无关。因此，数据的似然变得与假定的根节点状态无关：\n$$ \\lim_{L_{\\mathrm{tot}} \\to \\infty} P(D | S_r = y) = \\prod_{\\text{leaves }l} \\pi_{S_l} = (\\pi_x)^{N_{\\text{leaves}}} $$\n其中 $N_{\\text{leaves}}$ 是叶节点的数量。设这个常数似然为 $C$。在此极限下，对于所有 $y$，$L_r(y) \\to C$。\n后验概率变为：\n$$ \\lim_{L_{\\mathrm{tot}} \\to \\infty} P(S_r = x | D) = \\frac{C \\cdot \\pi_x}{\\sum_{y} C \\cdot \\pi_y} = \\frac{C \\cdot \\pi_x}{C \\sum_{y} \\pi_y} = \\frac{\\pi_x}{1} = \\pi_x $$\n随着树变得无限长，数据不再提供关于根节点状态的任何信息，因此后验概率回归到先验概率 $\\pi_x$。\n\n现在我们评估每个选项。\n\nA. 是。如果所有叶节点都处于状态 $x$，则根节点必须以 $100\\%$ 的概率被推断为 $x$，这与 $L_{\\mathrm{tot}}$ 和模型无关，因为不需要发生任何变化。\n这是**不正确的**。如上文推导，对于任何严格为正的分支长度，该概率都严格小于 $1$（或 $100\\%$）。一个概率模型必须考虑其他演化历史的非零概率，例如根节点状态为 $y \\neq x$，随后发生收敛突变或回复突变回到 $x$。\n\nB. 否。对于一个具有严格为正的非对角线速率和根节点先验 $\\boldsymbol{\\pi}$ 的不可约CTMC，只要所有分支长度都严格为正，根节点为 $x$ 的后验概率就严格小于 $1$；当所有分支按比例缩放使得 $L_{\\mathrm{tot}}\\to 0$ 时，该概率趋近于 $1$；当所有分支按比例缩放得很长使得 $L_{\\mathrm{tot}}\\to \\infty$ 时，该概率趋近于 $\\pi_{x}$。\n这是**正确的**。这个陈述准确地描述了从系统发育树上的CTMC模型原理推导出的三个关键性质。\n1. 对于 $L_{\\mathrm{tot}} > 0$，$P(S_r=x|D) < 1$。\n2. 当 $L_{\\mathrm{tot}} \\to 0$ 时，$P(S_r=x|D) \\to 1$。\n3. 当 $L_{\\mathrm{tot}} \\to \\infty$ 时，$P(S_r=x|D) \\to \\pi_x$。\n\nC. 在最大简约法 (MP) 下是。该方法将根节点为 $x$ 的概率赋为 $1$，因为其简约分数为 $0$；因此，概率性方法也必须将概率赋为 $1$。\n这是**不正确的**。虽然最大简约法确实会因为最小分数为 $0$ 而推断根节点状态为 $x$，但MP不是一个概率性方法。“因此概率性方法必须得出相同结果”的结论是一个逻辑谬误。简约法和概率性方法是不同的框架，它们的结果常常不同，尤其是在具有长分支、可能发生多次替换的树上。\n\nD. 只要所有叶节点都为 $x$，根节点为 $x$ 的后验概率就恒为 $1/k$，这与 $L_{\\mathrm{tot}}$ 和 $\\boldsymbol{\\pi}$ 无关。\n这是**不正确的**。如我们的推导所示，该概率高度依赖于 $L_{\\mathrm{tot}}$ 和 $\\boldsymbol{\\pi}$。当 $L_{\\mathrm{tot}}$ 很小时，它趋近于 $1$；当 $L_{\\mathrm{tot}}$ 很大时，它趋近于 $\\pi_x$。只有在 $L_{\\mathrm{tot}} \\to \\infty$ 并且平稳分布是均匀的（即对于所有 $y$ 都有 $\\pi_y = 1/k$，如Jukes-Cantor模型）这一特定情况下，才会得到 $1/k$ 这个值。其独立性的论断是错误的。\n\nE. 根节点为 $x$ 的后验概率随 $L_{\\mathrm{tot}}$ 的增加而增加，因为更长的树为根节点状态传递到叶节点提供了更多时间；因此，在更长的树上，观察到所有叶节点都为 $x$ 会使得根节点为 $x$ 的可能性更大。\n这是**不正确的**。后验概率是 $L_{\\mathrm{tot}}$ 的一个递减函数（当所有分支被一同缩放时），从 $L_{\\mathrm{tot}}=0$ 时的 $1$ 开始，随着 $L_{\\mathrm{tot}} \\to \\infty$ 而递减至 $\\pi_x < 1$。所给出的理由是有缺陷的：更长的分支增加了发生变化的概率，从而削弱了来自根节点的“信号”。对于更长的樹，观察到所有叶节点都为 $x$ 这一事实对于推断根节点状态的信息量变得更少，因此我们的确定性是降低的，而不是增加的。", "answer": "$$\\boxed{B}$$", "id": "2372346"}, {"introduction": "最后一个练习将我们带入概率性祖先序列重建的定量核心。通过一个具体的计算任务，你将应用连续时间马尔可夫链模型和贝叶斯推断，来精确计算并比较两种不同系统发育场景下的祖先状态后验概率 [@problem_id:2372309]。这个练习不仅能让你熟练运用Felsenstein的剪枝算法，还将揭示一个反直觉的现象：在某些情况下，增加更多的分类单元反而可能降低我们对某个祖先状态的置信度，从而加深你对演化模型复杂性的理解。", "problem": "考虑一个单一的同源二态性状，在一个有根系统发育树上，根据状态空间为 $\\{0,1\\}$ 的 Cavender-Farris-Neyman (CFN) 二态对称连续时间马尔可夫链 (CTMC) 进行演化。其无穷小生成元为\n$$\nQ \\;=\\; \\begin{pmatrix} -1 & 1 \\\\[4pt] 1 & -1 \\end{pmatrix},\n$$\n分支长度 $b$ 以每个位点的期望替换数来衡量，因此沿着长度为 $b$ 的边的转移概率矩阵是 $\\exp(Qb)$。假设根节点的平稳先验是均匀分布，即 $\\Pr(\\text{根}=0)=\\Pr(\\text{根}=1)=\\tfrac{1}{2}$，并且给定父节点的状态，叶节点的观测值沿着分支是条件独立的。\n\n考虑两种情景，两者所有边的长度均为 $b=\\tfrac{1}{2}\\ln 3$。\n\n情景 (i)：一个有根的 2 分类单元树，其中根节点 $R$ 通过长度为 $b$ 的边直接连接到叶节点 $A$ 和 $B$。在叶节点观测到的状态是 $A=0$ 和 $B=0$。\n\n情景 (ii)：一个有根的 4 分类单元平衡树，其中根节点 $R$ 有两个子节点，即内部节点 $X$ 和 $Y$，每个都通过长度为 $b$ 的边与 $R$ 相连。节点 $X$ 有两个子节点，即叶节点 $A$ 和 $B$，每个都通过长度为 $b$ 的边与 $X$ 相连。节点 $Y$ 有两个子节点，即叶节点 $C$ 和 $D$，每个都通过长度为 $b$ 的边与 $Y$ 相连。在叶节点观测到的状态是 $A=0$，$B=0$，$C=1$ 和 $D=1$。\n\n设 $\\rho$ 表示在这两种情景下，根节点处于状态 0 的后验概率之比，\n$$\n\\rho \\;=\\; \\frac{\\Pr(R=0 \\mid \\text{情景 (ii) 的数据})}{\\Pr(R=0 \\mid \\text{情景 (i) 的数据})}.\n$$\n精确计算 $\\rho$。将最终答案表示为单个实数或单个精确分数。无需四舍五入，也无需单位。", "solution": "问题的核心是计算两种不同情景下根节点状态的后验概率。对于给定的根状态 $s \\in \\{0, 1\\}$ 和观测数据 $D$，根据贝叶斯定理，后验概率为：\n$$\n\\Pr(R=s \\mid D) = \\frac{\\Pr(D \\mid R=s)\\Pr(R=s)}{\\Pr(D)}\n$$\n数据的总概率为 $\\Pr(D) = \\sum_{s' \\in \\{0,1\\}} \\Pr(D \\mid R=s')\\Pr(R=s')$。给定均匀先验 $\\Pr(R=0) = \\Pr(R=1) = \\frac{1}{2}$，这可以简化为：\n$$\n\\Pr(R=0 \\mid D) = \\frac{L(0)}{L(0) + L(1)}\n$$\n其中 $L(s) = \\Pr(D \\mid R=s)$ 是在根节点处于状态 $s$ 的条件下，观测数据的似然。\n\n首先，我们必须确定转移概率矩阵 $P(b) = \\exp(Qb)$。生成元为 $Q = \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix}$。$Q$ 的特征值 $\\lambda$ 由 $\\det(Q - \\lambda I) = (-1-\\lambda)^2 - 1 = \\lambda^2 + 2\\lambda = 0$ 给出，得到 $\\lambda_1 = 0$ 和 $\\lambda_2 = -2$。矩阵指数给出了在长度为 $b$ 的分支上的转移概率：\n$$\nP(b) = \\begin{pmatrix} P_{00}(b) & P_{01}(b) \\\\ P_{10}(b) & P_{11}(b) \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1+\\exp(-2b) & 1-\\exp(-2b) \\\\ 1-\\exp(-2b) & 1+\\exp(-2b) \\end{pmatrix}\n$$\n题目指定了 $b = \\frac{1}{2}\\ln 3$。我们将其代入指数项中：\n$$\n\\exp(-2b) = \\exp\\left(-2 \\cdot \\frac{1}{2}\\ln 3\\right) = \\exp(-\\ln 3) = 3^{-1} = \\frac{1}{3}\n$$\n因此，转移概率为：\n$P_{00}(b) = P_{11}(b) = \\frac{1}{2}(1 + \\frac{1}{3}) = \\frac{1}{2}(\\frac{4}{3}) = \\frac{2}{3}$。\n$P_{01}(b) = P_{10}(b) = \\frac{1}{2}(1 - \\frac{1}{3}) = \\frac{1}{2}(\\frac{2}{3}) = \\frac{1}{3}$。\n\n**情景 (i) 分析**\n该树有根节点 $R$ 和叶节点 $A, B$。数据为 $D_i = \\{A=0, B=0\\}$。分支 $(R,A)$ 和 $(R,B)$ 的长度均为 $b$。\n似然计算如下，利用了从 $R$ 派生出的子树的条件独立性：\n$$\nL_i(0) = \\Pr(A=0, B=0 \\mid R=0) = \\Pr(A=0 \\mid R=0) \\Pr(B=0 \\mid R=0) = P_{00}(b) \\cdot P_{00}(b) = \\frac{2}{3} \\cdot \\frac{2}{3} = \\frac{4}{9}\n$$\n$$\nL_i(1) = \\Pr(A=0, B=0 \\mid R=1) = \\Pr(A=0 \\mid R=1) \\Pr(B=0 \\mid R=1) = P_{10}(b) \\cdot P_{10}(b) = \\frac{1}{3} \\cdot \\frac{1}{3} = \\frac{1}{9}\n$$\n根节点处于状态 0 的后验概率是：\n$$\n\\Pr(R=0 \\mid D_i) = \\frac{L_i(0)}{L_i(0) + L_i(1)} = \\frac{\\frac{4}{9}}{\\frac{4}{9} + \\frac{1}{9}} = \\frac{\\frac{4}{9}}{\\frac{5}{9}} = \\frac{4}{5}\n$$\n\n**情景 (ii) 分析**\n该树有根节点 $R$ 和子节点 $X, Y$。$X$ 有子节点 $A, B$，$Y$ 有子节点 $C, D$。数据为 $D_{ii} = \\{A=0, B=0, C=1, D=1\\}$。所有分支的长度均为 $b$。\n我们使用 Felsenstein 的剪枝算法来计算似然。设 $L_K(s)$ 为在节点 $K$ 处于状态 $s$ 的条件下，以节点 $K$ 为根的子树中数据的条件似然。\n叶节点的似然为：$L_A=(1,0)$，$L_B=(1,0)$，$L_C=(0,1)$，$L_D=(0,1)$。\n\n首先，我们计算内部节点 $X$ 和 $Y$ 的条件似然向量。\n对于节点 $X$ (子节点为 $A=0, B=0$)：\n$L_X(0) = P_{00}(b)L_A(0) \\cdot P_{00}(b)L_B(0) = \\frac{2}{3} \\cdot 1 \\cdot \\frac{2}{3} \\cdot 1 = \\frac{4}{9}$\n$L_X(1) = P_{10}(b)L_A(0) \\cdot P_{10}(b)L_B(0) = \\frac{1}{3} \\cdot 1 \\cdot \\frac{1}{3} \\cdot 1 = \\frac{1}{9}$\n所以，$L_X = (\\frac{4}{9}, \\frac{1}{9})$。\n\n对于节点 $Y$ (子节点为 $C=1, D=1$)：\n$L_Y(0) = P_{01}(b)L_C(1) \\cdot P_{01}(b)L_D(1) = \\frac{1}{3} \\cdot 1 \\cdot \\frac{1}{3} \\cdot 1 = \\frac{1}{9}$\n$L_Y(1) = P_{11}(b)L_C(1) \\cdot P_{11}(b)L_D(1) = \\frac{2}{3} \\cdot 1 \\cdot \\frac{2}{3} \\cdot 1 = \\frac{4}{9}$\n所以，$L_Y = (\\frac{1}{9}, \\frac{4}{9})$。\n\n接下来，我们通过从其子节点 $X$ 和 $Y$ 传播似然来计算根节点 $R$ 处的似然。\n$$\nL_{ii}(s) = \\left( \\sum_{s_X=0}^1 P_{s,s_X}(b) L_X(s_X) \\right) \\left( \\sum_{s_Y=0}^1 P_{s,s_Y}(b) L_Y(s_Y) \\right)\n$$\n对于 $R=0$：\n$$\nL_{ii}(0) = \\left( P_{00}(b)L_X(0) + P_{01}(b)L_X(1) \\right) \\left( P_{00}(b)L_Y(0) + P_{01}(b)L_Y(1) \\right)\n$$\n$$\nL_{ii}(0) = \\left( \\frac{2}{3} \\cdot \\frac{4}{9} + \\frac{1}{3} \\cdot \\frac{1}{9} \\right) \\left( \\frac{2}{3} \\cdot \\frac{1}{9} + \\frac{1}{3} \\cdot \\frac{4}{9} \\right) = \\left( \\frac{8}{27} + \\frac{1}{27} \\right) \\left( \\frac{2}{27} + \\frac{4}{27} \\right) = \\left( \\frac{9}{27} \\right) \\left( \\frac{6}{27} \\right) = \\frac{1}{3} \\cdot \\frac{2}{9} = \\frac{2}{27}\n$$\n对于 $R=1$：\n$$\nL_{ii}(1) = \\left( P_{10}(b)L_X(0) + P_{11}(b)L_X(1) \\right) \\left( P_{10}(b)L_Y(0) + P_{11}(b)L_Y(1) \\right)\n$$\n$$\nL_{ii}(1) = \\left( \\frac{1}{3} \\cdot \\frac{4}{9} + \\frac{2}{3} \\cdot \\frac{1}{9} \\right) \\left( \\frac{1}{3} \\cdot \\frac{1}{9} + \\frac{2}{3} \\cdot \\frac{4}{9} \\right) = \\left( \\frac{4}{27} + \\frac{2}{27} \\right) \\left( \\frac{1}{27} + \\frac{8}{27} \\right) = \\left( \\frac{6}{27} \\right) \\left( \\frac{9}{27} \\right) = \\frac{2}{9} \\cdot \\frac{1}{3} = \\frac{2}{27}\n$$\n似然相等：$L_{ii}(0) = L_{ii}(1)$。根节点处于状态 0 的后验概率是：\n$$\n\\Pr(R=0 \\mid D_{ii}) = \\frac{L_{ii}(0)}{L_{ii}(0) + L_{ii}(1)} = \\frac{\\frac{2}{27}}{\\frac{2}{27} + \\frac{2}{27}} = \\frac{\\frac{2}{27}}{\\frac{4}{27}} = \\frac{1}{2}\n$$\n似然的相等表明，在这种对称模型和树结构下，观测数据没有提供任何信息来区分根节点的状态，因此后验分布恢复到先验分布。\n\n**$\\rho$ 比率的最终计算**\n问题要求计算比率 $\\rho$：\n$$\n\\rho = \\frac{\\Pr(R=0 \\mid D_{ii})}{\\Pr(R=0 \\mid D_i)} = \\frac{\\frac{1}{2}}{\\frac{4}{5}} = \\frac{1}{2} \\cdot \\frac{5}{4} = \\frac{5}{8}\n$$\n结果是一个精确分数。", "answer": "$$\\boxed{\\frac{5}{8}}$$", "id": "2372309"}]}