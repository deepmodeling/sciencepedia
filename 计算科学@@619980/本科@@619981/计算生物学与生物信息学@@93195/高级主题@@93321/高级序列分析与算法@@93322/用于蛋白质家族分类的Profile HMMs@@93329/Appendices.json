{"hands_on_practices": [{"introduction": "为了真正掌握轮廓隐马尔可夫模型 (profile HMM)，我们首先需要理解其作为生成模型的本质。下面的练习将带你深入 HMM 的状态空间，通过一个具体的计算任务，让你亲手实践如何在一个给定的 HMM 结构中计算特定路径的概率。这个练习将强化你对状态转移概率如何共同决定一个序列生成路径的理解，这是掌握 HMM 更复杂算法的基石。[@problem_id:2418513]", "problem": "考虑一个用于蛋白质家族（Pfam）数据库的轮廓隐马尔可夫模型（profile Hidden Markov Model, profile HMM），该模型针对一个具有两个匹配位置的蛋白质家族。隐状态集由标准的轮廓HMM拓扑状态组成：一个起始状态 $B$、匹配状态 $M_1$和$M_2$、插入状态 $I_0$、$I_1$和$I_2$、删除状态 $D_1$和$D_2$以及一个结束状态 $E$。该过程从 $B$ 开始，在进入 $E$ 时终止。在非匹配状态之间的唯一非零转移概率规定如下；任何未明确列出的转移概率均为 $0$。\n\n- 从 $B$ 出发：$B \\to M_1$ 的概率为 $\\frac{1}{2}$，$B \\to I_0$ 的概率为 $\\frac{3}{10}$，以及 $B \\to D_1$ 的概率为 $\\frac{1}{5}$。\n- 从 $I_0$ 出发：$I_0 \\to I_0$ 的概率为 $\\frac{2}{5}$，$I_0 \\to D_1$ 的概率为 $\\frac{1}{5}$，以及 $I_0 \\to M_1$ 的概率为 $\\frac{2}{5}$。\n- 从 $D_1$ 出发：$D_1 \\to D_2$ 的概率为 $\\frac{1}{2}$，$D_1 \\to I_1$ 的概率为 $\\frac{3}{10}$，以及 $D_1 \\to M_2$ 的概率为 $\\frac{1}{5}$。\n- 从 $I_1$ 出发：$I_1 \\to I_1$ 的概率为 $\\frac{1}{2}$，$I_1 \\to D_2$ 的概率为 $\\frac{1}{4}$，以及 $I_1 \\to M_2$ 的概率为 $\\frac{1}{4}$。\n- 从 $D_2$ 出发：$D_2 \\to E$ 的概率为 $\\frac{3}{5}$，以及 $D_2 \\to I_2$ 的概率为 $\\frac{2}{5}$。\n- 从 $I_2$ 出发：$I_2 \\to I_2$ 的概率为 $\\frac{1}{2}$，以及 $I_2 \\to E$ 的概率为 $\\frac{1}{2}$。\n\n定义事件 $\\mathcal{S}$ 为从 $B$ 到 $E$ 的隐状态路径在 $B$ 和 $E$ 之间只包含插入状态和删除状态；也就是说，该路径从不访问任何匹配状态 $M_1$ 或 $M_2$。在模型自身的隐状态路径生成过程中，计算概率 $\\mathbb{P}(\\mathcal{S})$。将最终答案表示为最简分数。", "solution": "首先必须对问题陈述进行严格验证。\n\n**步骤1：提取已知条件**\n- **状态集**：$\\{B, M_1, M_2, I_0, I_1, I_2, D_1, D_2, E\\}$。\n- **过程**：从 $B$ 开始，在 $E$ 结束。\n- **转移概率（非零，从非匹配状态出发）**：\n  - 从 $B$ 出发：$\\mathbb{P}(M_1|B) = \\frac{1}{2}$，$\\mathbb{P}(I_0|B) = \\frac{3}{10}$，$\\mathbb{P}(D_1|B) = \\frac{1}{5}$。\n  - 从 $I_0$ 出发：$\\mathbb{P}(I_0|I_0) = \\frac{2}{5}$，$\\mathbb{P}(D_1|I_0) = \\frac{1}{5}$，$\\mathbb{P}(M_1|I_0) = \\frac{2}{5}$。\n  - 从 $D_1$ 出发：$\\mathbb{P}(D_2|D_1) = \\frac{1}{2}$，$\\mathbb{P}(I_1|D_1) = \\frac{3}{10}$，$\\mathbb{P}(M_2|D_1) = \\frac{1}{5}$。\n  - 从 $I_1$ 出发：$\\mathbb{P}(I_1|I_1) = \\frac{1}{2}$，$\\mathbb{P}(D_2|I_1) = \\frac{1}{4}$，$\\mathbb{P}(M_2|I_1) = \\frac{1}{4}$。\n  - 从 $D_2$ 出发：$\\mathbb{P}(E|D_2) = \\frac{3}{5}$，$\\mathbb{P}(I_2|D_2) = \\frac{2}{5}$。\n  - 从 $I_2$ 出发：$\\mathbb{P}(I_2|I_2) = \\frac{1}{2}$，$\\mathbb{P}(E|I_2) = \\frac{1}{2}$。\n- **事件 $\\mathcal{S}$ 的条件**：从 $B$ 到 $E$ 的隐状态路径仅包含集合 $\\{I_0, I_1, I_2, D_1, D_2\\}$ 中的状态作为中间状态。路径不得访问 $M_1$ 或 $M_2$。\n- **目标**：计算 $\\mathbb{P}(\\mathcal{S})$。\n\n**步骤2：使用提取的已知条件进行验证**\n1.  **科学依据**：该问题描述了一个轮廓隐马尔可夫模型，这是计算生物学中用于蛋白质家族分类的一个标准且科学合理的工具。其状态拓扑和转移结构与既有模型一致。该问题牢固地建立在概率论及其在生物信息学中的应用之上。\n2.  **良构性**：该问题要求在一个完全指定的概率模型（一个有限状态马尔可夫链）中，计算一个明确定义的事件 $\\mathcal{S}$ 的概率。存在唯一解。\n3.  **完整性和一致性**：对于列出了转移的每个状态，所有出向转移的概率之和为 $1$。\n    - 从 $B$ 出发：$\\frac{1}{2} + \\frac{3}{10} + \\frac{1}{5} = \\frac{5+3+2}{10} = 1$。\n    - 从 $I_0$ 出发：$\\frac{2}{5} + \\frac{1}{5} + \\frac{2}{5} = \\frac{5}{5} = 1$。\n    - 从 $D_1$ 出发：$\\frac{1}{2} + \\frac{3}{10} + \\frac{1}{5} = \\frac{5+3+2}{10} = 1$。\n    - 从 $I_1$ 出发：$\\frac{1}{2} + \\frac{1}{4} + \\frac{1}{4} = \\frac{2+1+1}{4} = 1$。\n    - 从 $D_2$ 出发：$\\frac{3}{5} + \\frac{2}{5} = 1$。\n    - 从 $I_2$ 出发：$\\frac{1}{2} + \\frac{1}{2} = 1$。\n    该问题是自洽的，没有矛盾。匹配状态（$M_1, M_2$）的转移没有被指定，但这与计算无关，因为事件 $\\mathcal{S}$ 明确禁止访问这些状态。\n\n**步骤3：结论与行动**\n该问题有科学依据、良构且内部一致。因此它是有效的。我将继续进行求解。\n\n该问题要求在一个由马尔可夫链定义的生成过程中，计算特定事件 $\\mathcal{S}$ 的概率。事件 $\\mathcal{S}$ 是指从状态 $B$ 开始的路径仅通过插入（$I_k$）和删除（$D_k$）状态到达状态 $E$。\n\n设 $\\pi_S$ 表示从状态 $S$ 出发的路径在从不访问匹配状态（$M_1$ 或 $M_2$）的情况下最终到达结束状态 $E$ 的概率。我们需要求解的是 $\\pi_B = \\mathbb{P}(\\mathcal{S})$。\n\n该问题可以通过为相关状态 $S \\in \\{I_0, D_1, I_1, D_2, I_2\\}$ 的概率 $\\pi_S$ 建立一个线性方程组来解决。这种方法被称为首步分析法。概率 $\\pi_S$ 是转移到每个可能的下一状态 $S'$ 的概率与从该状态成功的概率 $\\pi_{S'}$ 的乘积之和。\n一般方程为：\n$$ \\pi_S = \\sum_{S'} \\mathbb{P}(S \\to S') \\pi_{S'} $$\n根据定义，已到达状态 $E$ 的路径已经成功，所以 $\\pi_E=1$。进入匹配状态的路径未能满足事件 $\\mathcal{S}$ 的条件，因此我们可以将从匹配状态出发的成功概率定义为零：$\\pi_{M_1} = 0$ 和 $\\pi_{M_2} = 0$。\n\n我们通过从结束状态 $E$ 向后推导来求解这些概率。\n\n1.  **从状态 $I_2$ 出发的概率**：\n    从 $I_2$ 的可能转移是到 $I_2$ 或 $E$。两者都不是匹配状态。\n    $\\pi_{I_2} = \\mathbb{P}(I_2 \\to I_2) \\pi_{I_2} + \\mathbb{P}(I_2 \\to E) \\pi_E$\n    $\\pi_{I_2} = \\frac{1}{2} \\pi_{I_2} + \\frac{1}{2}(1)$\n    $(1 - \\frac{1}{2}) \\pi_{I_2} = \\frac{1}{2}$\n    $\\frac{1}{2} \\pi_{I_2} = \\frac{1}{2} \\implies \\pi_{I_2} = 1$。\n\n2.  **从状态 $D_2$ 出发的概率**：\n    从 $D_2$ 的转移是到 $E$ 或 $I_2$。\n    $\\pi_{D_2} = \\mathbb{P}(D_2 \\to E) \\pi_E + \\mathbb{P}(D_2 \\to I_2) \\pi_{I_2}$\n    $\\pi_{D_2} = \\frac{3}{5}(1) + \\frac{2}{5}(1) = 1$。\n\n3.  **从状态 $I_1$ 出发的概率**：\n    从 $I_1$ 的转移是到 $I_1$、$D_2$ 或 $M_2$。到 $M_2$ 的转移是失败。\n    $\\pi_{I_1} = \\mathbb{P}(I_1 \\to I_1) \\pi_{I_1} + \\mathbb{P}(I_1 \\to D_2) \\pi_{D_2} + \\mathbb{P}(I_1 \\to M_2) \\pi_{M_2}$\n    $\\pi_{I_1} = \\frac{1}{2} \\pi_{I_1} + \\frac{1}{4}(1) + \\frac{1}{4}(0)$\n    $(1 - \\frac{1}{2}) \\pi_{I_1} = \\frac{1}{4}$\n    $\\frac{1}{2} \\pi_{I_1} = \\frac{1}{4} \\implies \\pi_{I_1} = \\frac{1}{2}$。\n\n4.  **从状态 $D_1$ 出发的概率**：\n    从 $D_1$ 的转移是到 $D_2$、$I_1$ 或 $M_2$。到 $M_2$ 的转移是失败。\n    $\\pi_{D_1} = \\mathbb{P}(D_1 \\to D_2) \\pi_{D_2} + \\mathbb{P}(D_1 \\to I_1) \\pi_{I_1} + \\mathbb{P}(D_1 \\to M_2) \\pi_{M_2}$\n    $\\pi_{D_1} = \\frac{1}{2}(1) + \\frac{3}{10}(\\frac{1}{2}) + \\frac{1}{5}(0)$\n    $\\pi_{D_1} = \\frac{1}{2} + \\frac{3}{20} = \\frac{10}{20} + \\frac{3}{20} = \\frac{13}{20}$。\n\n5.  **从状态 $I_0$ 出发的概率**：\n    从 $I_0$ 的转移是到 $I_0$、$D_1$ 或 $M_1$。到 $M_1$ 的转移是失败。\n    $\\pi_{I_0} = \\mathbb{P}(I_0 \\to I_0) \\pi_{I_0} + \\mathbb{P}(I_0 \\to D_1) \\pi_{D_1} + \\mathbb{P}(I_0 \\to M_1) \\pi_{M_1}$\n    $\\pi_{I_0} = \\frac{2}{5} \\pi_{I_0} + \\frac{1}{5}(\\frac{13}{20}) + \\frac{2}{5}(0)$\n    $(1 - \\frac{2}{5}) \\pi_{I_0} = \\frac{13}{100}$\n    $\\frac{3}{5} \\pi_{I_0} = \\frac{13}{100} \\implies \\pi_{I_0} = \\frac{13}{100} \\cdot \\frac{5}{3} = \\frac{13}{60}$。\n\n6.  **从状态 $B$ 出发的概率**：\n    最后，我们计算 $\\pi_B$。从 $B$ 的转移是到 $M_1$、$I_0$ 或 $D_1$。到 $M_1$ 的转移是失败。\n    $\\pi_B = \\mathbb{P}(B \\to M_1) \\pi_{M_1} + \\mathbb{P}(B \\to I_0) \\pi_{I_0} + \\mathbb{P}(B \\to D_1) \\pi_{D_1}$\n    $\\pi_B = \\frac{1}{2}(0) + \\frac{3}{10}(\\frac{13}{60}) + \\frac{1}{5}(\\frac{13}{20})$\n    $\\pi_B = \\frac{39}{600} + \\frac{13}{100}$\n    为了将这些分数相加，我们找到一个公分母，即 $600$。\n    $\\pi_B = \\frac{39}{600} + \\frac{13 \\cdot 6}{100 \\cdot 6} = \\frac{39}{600} + \\frac{78}{600}$\n    $\\pi_B = \\frac{39 + 78}{600} = \\frac{117}{600}$\n\n最后一步是化简分数。必须找到 $117$ 和 $600$ 的最大公约数。\n$117 = 3 \\times 39 = 3 \\times 3 \\times 13 = 3^2 \\times 13$。\n$600 = 6 \\times 100 = 2 \\times 3 \\times 10^2 = 2 \\times 3 \\times (2 \\times 5)^2 = 2^3 \\times 3 \\times 5^2$。\n最大公约数是 $3$。\n$\\pi_B = \\frac{117 \\div 3}{600 \\div 3} = \\frac{39}{200}$。\n这个分数是其最简形式，因为 $39 = 3 \\times 13$ 和 $200 = 2^3 \\times 5^2$ 没有共同因子。\n\n事件 $\\mathcal{S}$ 的概率是 $\\frac{39}{200}$。", "answer": "$$ \\boxed{\\frac{39}{200}} $$", "id": "2418513"}, {"introduction": "构建并理解了 HMM 的概率基础后，一个常见的问题是如何从模型中提取出一个“代表性”或“共有”序列。然而，“代表性”的定义不止一种，不同的定义对应着不同的算法和结果。这个练习旨在辨析两种核心概念：基于逐个位置最高概率的共有序列，以及通过 Viterbi 算法找到的全局最优路径所生成的序列，帮助你深入理解模型解码的不同策略及其含义。[@problem_id:2418536]", "problem": "在蛋白质家族数据库 (Pfam) 中，一个轮廓隐马尔可夫模型 (HMM) 被用来表示一个蛋白质家族，其形式为一系列匹配状态 $\\{M_1,\\dots,M_L\\}$，以及相关的插入状态 $\\{I_0,\\dots,I_L\\}$ 和删除状态 $\\{D_1,\\dots,D_L\\}$。每个匹配状态 $M_i$ 根据一个关于 $x \\in \\mathcal{A}$ 的位置特异性分布 $e_{M_i}(x)$，从一个字母表 $\\mathcal{A}$ 中发射一个氨基酸，而删除状态是静默的，插入状态则根据 $e_{I_i}(x)$ 发射。一个状态路径 $\\pi_0,\\pi_1,\\dots,\\pi_K$ 的概率等于沿该路径的转移概率的乘积，而沿该路径发射的序列 $x_1,\\dots,x_K$ 的联合概率等于路径概率与发射状态下的发射概率的乘积。\n\n一个轮廓 HMM 常用的报告方式是“一致性”序列，旨在总结模型在每个匹配位置上的偏好残基。另外，可以定义“最可能发射序列”，它是通过单一最可能状态路径获得的序列（即，在所有路径和序列上最大化路径和发射的联合概率的路径），该路径通常通过 Viterbi 算法找到。\n\n哪个陈述最能描述如何从一个轮廓 HMM 生成“一致性”序列，以及这与最可能发射序列有何不同？\n\nA. 一致性序列的形成方式是，在每个匹配状态 $M_i$ 处，取残基 $x_i=\\arg\\max_{x \\in \\mathcal{A}} e_{M_i}(x)$（可选择性地通过一个独立的占有率规则省略某些位置），这仅取决于每个位置的发射分布，而与转移概率无关；相比之下，最可能发射序列是沿着在转移和发射上最大化联合概率的单一状态路径所发射的序列，并且可能通过删除转移跳过匹配状态或包含插入发射，因此这两个序列可能不同。\n\nB. 只要每个 $M_i$ 都有唯一的 $e_{M_i}(x)$ 最大化者，一致性序列和最可能发射序列就是相同的，因为转移概率不能改变发射哪个残基。\n\nC. 一致性序列通过对所有状态路径求和来最大化边缘序列概率 $P(x_{1:L}\\mid\\text{model})$，而最可能发射序列则最大化与发射无关的后验路径概率 $P(\\pi\\mid\\text{model})$。\n\nD. 一致性序列通过前向-后向算法计算，以获得每个位置的后验残基，而最可能发射序列的计算方式是，在每个位置独立选择 $\\arg\\max_{x \\in \\mathcal{A}} e_{M_i}(x)$，而不考虑转移。", "solution": "首先将验证问题陈述的科学性和逻辑完整性。\n\n### 步骤1：提取已知信息\n- **模型**：一个轮廓隐马尔可夫模型 (HMM) 表示一个蛋白质家族。\n- **状态**：HMM 由匹配状态 {$M_1, \\dots, M_L$}、插入状态 {$I_0, \\dots, I_L$} 和删除状态 {$D_1, \\dots, D_L$} 组成。\n- **发射**：\n    - 匹配状态 $M_i$ 以概率 $e_{M_i}(x)$ 从字母表 $\\mathcal{A}$ 中发射一个氨基酸 $x$。\n    - 插入状态 $I_i$ 以概率 $e_{I_i}(x)$ 发射一个氨基酸 $x$。\n    - 删除状态 $D_i$ 是静默的（不发射）。\n- **概率**：\n    - 一个状态路径 $\\pi_0, \\pi_1, \\dots, \\pi_K$ 的概率是沿该路径的转移概率的乘积。\n    - 一个发射序列 $x_1, \\dots, x_K$ 和一个状态路径的联合概率是路径概率与发射状态下的发射概率的乘积。\n- **定义**：\n    - **“一致性”序列**：“旨在总结模型在每个匹配位置上的偏好残基。”\n    - **“最可能发射序列”**：“通过单一最可能状态路径获得的序列（即，在所有路径和序列上最大化路径和发射的联合概率的路径），该路径通常通过 Viterbi 算法找到。”\n- **问题**：描述“一致性”序列的生成方式，并将其与“最可能发射序列”进行对比。\n\n### 步骤2：使用提取的已知信息进行验证\n问题陈述描述了生物信息学中使用的轮廓 HMM 的标准架构，例如在 Pfam 数据库中使用的那样。所有提出的概念——匹配、插入和删除状态；发射和转移概率；路径和序列的联合概率——都是 HMM 理论的基本组成部分，并且陈述正确。为“最可能发射序列”（作为 Viterbi 路径的产物）和“一致性”序列（作为匹配位置上偏好残基的总结）给出的定义是该领域的标准定义。该问题具有科学依据，提法恰当且客观。它没有矛盾、歧义或事实错误。\n\n### 步骤3：结论和行动\n问题陈述有效。现在将推导解决方案。\n\n### 推导\n设轮廓 HMM 由一组参数 $\\theta = \\{a_{kl}, e_k(x)\\}$ 表示，其中 $a_{kl}$ 是从状态 $k$ 到状态 $l$ 的转移概率， $e_k(x)$ 是从状态 $k$ 发射符号 $x$ 的发射概率。\n\n1.  **一致性序列的生成**：问题文本将其描述为总结“每个匹配位置上的偏好残基”。对此最直接和最常见的解释是独立考虑每个匹配状态 $M_i$，并选择具有最高发射概率的氨基酸。对于每个位置 $i \\in \\{1, \\dots, L\\}$，一致性残基 $c_i$ 由以下公式确定：\n    $$ c_i = \\arg\\max_{x \\in \\mathcal{A}} e_{M_i}(x) $$\n    完整的一致性序列是 $c_1c_2 \\dots c_L$ 的串联。此过程仅依赖于匹配状态的发射概率 $e_{M_i}(x)$。它完全忽略了任何状态之间的转移概率 $a_{kl}$。它也忽略了插入状态的发射。该序列的长度恰好为 $L$。\n\n2.  **最可能发射序列的生成**：这被明确定义为来自单一最可能状态路径的发射序列。该路径 $\\pi^*$ 是最大化路径和发射序列的联合概率 $P(x, \\pi | \\theta)$ 的路径。\n    $$ (\\pi^*, x^*) = \\arg\\max_{\\pi, x} P(x, \\pi | \\theta) $$\n    该优化问题可通过 Viterbi 算法高效解决。Viterbi 算法在每一步动态计算到达每个状态的最高概率路径，同时考虑到达该状态的转移概率和观测符号的发射概率。最终路径 $\\pi^*$ 是一个全局最优解。该路径可能包含到删除状态的转移（例如，$M_{i-1} \\to D_i \\to M_{i+1}$），这会导致位置 $i$ 被跳过；或者到插入状态的转移（例如，$M_i \\to I_i \\to M_{i+1}$），这会增加额外的残基。因此，得到的序列 $x^*$ 不保证长度为 $L$，并且其组成残基不一定是从其相应匹配状态（孤立考虑时）的最可能发射。路径的选择以及由此产生的序列，是转移概率 $a_{kl}$ 和发射概率 $e_k(x)$ 的函数。\n\n**结论**：一致性序列是一个仅基于 $e_{M_i}(x)$ 的局部、逐位置的构造，而最可能发射序列是一个基于路径的全局优化，依赖于 $e_k(x)$ 和 $a_{kl}$。它们在根本上是不同的，通常不预期会相同。\n\n### 逐项分析\n\n**A. 一致性序列的形成方式是，在每个匹配状态 $M_i$ 处，取残基 $x_i=\\arg\\max_{x \\in \\mathcal{A}} e_{M_i}(x)$（可选择性地通过一个独立的占有率规则省略某些位置），这仅取决于每个位置的发射分布，而与转移概率无关；相比之下，最可能发射序列是沿着在转移和发射上最大化联合概率的单一状态路径所发射的序列，并且可能通过删除转移跳过匹配状态或包含插入发射，因此这两个序列可能不同。**\n\n这个陈述准确地描述了这两种过程。一致性序列的生成被正确地描述为匹配状态发射概率的逐位置最大化，且与转移无关。关于占有率的可选规则是一个正确的实践细节。将最可能发射序列描述为 Viterbi 路径的输出，该路径最大化联合概率并依赖于转移和发射，这也是正确的。其对比之处，即 Viterbi 路径可以使用删除和插入状态，从而导致序列差异，是关键的区别。\n**结论：正确。**\n\n**B. 只要每个 $M_i$ 都有唯一的 $e_{M_i}(x)$ 最大化者，一致性序列和最可能发射序列就是相同的，因为转移概率不能改变发射哪个残基。**\n\n这个陈述有根本性缺陷。前提“转移概率不能改变发射哪个残基”是错误的。转移概率决定了所采取的状态路径。如果进入删除状态 $D_i$ 的转移概率足够高，Viterbi 路径将绕过匹配状态 $M_i$，并且该列不会发射任何残基。这直接改变了最终的序列。例如，如果 $a_{M_{i-1}, D_i} \\cdot a_{D_i, M_{i+1}}$ 足够高，使得访问 $D_i$ 的概率高于通过 $M_i$ 的路径，即 $a_{M_{i-1}, M_i} \\cdot e_{M_i}(x_i) \\cdot a_{M_i, M_{i+1}}$，那么 Viterbi 路径将使用删除。这两个序列将会不同。\n**结论：不正确。**\n\n**C. 一致性序列通过对所有状态路径求和来最大化边缘序列概率 $P(x_{1:L}\\mid\\text{model})$，而最可能发射序列则最大化与发射无关的后验路径概率 $P(\\pi\\mid\\text{model})$。**\n\n这个陈述对两个序列的描述都不正确。最大化边缘序列概率 $P(x | \\text{model}) = \\sum_{\\pi} P(x, \\pi | \\text{model})$ 是一个不同的、计算上困难的问题，其解并非简单的一致性序列。简单的一致性序列并不最大化任何关于序列的全局概率函数。此外，Viterbi 算法（用于“最可能发射序列”）最大化的是*联合*概率 $P(x, \\pi | \\text{model})$，而不是后验路径概率 $P(\\pi | \\text{model})$，并且肯定不是“与发射无关”的概率。发射是联合概率计算中不可或缺的一部分。\n**结论：不正确。**\n\n**D. 一致性序列通过前向-后向算法计算，以获得每个位置的后验残基，而最可能发射序列的计算方式是，在每个位置独立选择 $\\arg\\max_{x \\in \\mathcal{A}} e_{M_i}(x)$，而不考虑转移。**\n\n这个陈述颠倒了定义。为最可能发射序列描述的方法（“独立选择 $\\arg\\max_{x \\in \\mathcal{A}} e_{M_i}(x)$”）实际上是生成简单一致性序列的方法。为一致性序列描述的方法（“通过前向-后向算法计算”）定义了另一种解码方式，即“后验解码”，它在给定观测序列的情况下计算每个位置最可能的状态，这与 Viterbi 路径和简单一致性序列都不同。简单的一致性序列通常不使用前向-后向算法计算，也不需要给定的序列。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2418536"}, {"introduction": "任何模型都有其适用范围和局限性，深刻理解这些边界是成为领域专家的关键。标准的 profile HMM 基于马尔可夫假设，这使得它在捕捉序列的局部模式时非常强大，但也限制了其表达残基之间长程依赖关系的能力。这个练习将促使你思考 profile HMM 的一个核心局限性，并探讨在面对如二硫键这类需要跨位置配对的复杂生物学特征时，有哪些可行且严谨的建模策略。[@problem_id:2418528]", "problem": "一位策展人正在为蛋白质家族数据库（Pfam）中的一个蛋白质家族构建一个轮廓隐马尔可夫模型（profile Hidden Markov Model, HMM）。该家族的核心结构域在位置 $i$ 和 $j$（其中 $i \\neq j$）处有两个比对列，根据结构和生化数据，已知这两个位置在功能性同源物中形成一个必需的二硫键。策展人的目标是确保被归类为该结构域成员的序列在位置 $i$ 和 $j$ 都具有半胱氨酸残基，并且在比对中这两个位置都未被删除，同时这种方式必须正确地遵循 Pfam 风格的 profile HMM 能够表示和不能表示的内容。以下哪种策略是满足此要求的有效方法？选择所有适用选项。\n\nA. 手动编辑 profile HMM，使得位置 $i$ 和 $j$ 处的匹配态发射半胱氨酸的概率为 $1$，并将位置 $i$ 和 $j$ 处的删除转移概率设置为 $0$。仅此一项就能在 profile HMM 内部完全强制执行二硫键约束。\n\nB. 将位置 $i$ 和 $j$ 处匹配态的发射进行耦合，使得位置 $i$ 处的发射依赖于位置 $j$ 处的发射，从而确保两者都是半胱氨酸；HMMER 风格的 profile HMM 支持此操作。\n\nC. 为该家族使用一个标准的 Pfam 风格 profile HMM，并应用一个比对后过滤器，拒绝那些与模型的最优比对未在位置 $i$ 和 $j$ 处都放置半胱氨酸（且未删除任一位置）的任何序列。\n\nD. 用一个支持显式成对耦合的模型类别（例如马尔可夫随机场（MRF））替换或增强 profile HMM，以编码位置 $i$ 和 $j$ 之间的依赖关系，并指出 Pfam 的 profile HMM 无法表示此类耦合。\n\nE. 将模型转换为一个 profile 随机上下文无关文法（SCFG），并通过成对发射产生式来强制实现长程配对；据称标准工具原生支持此方法用于蛋白质二硫键。", "solution": "我们分析一个 Pfam 风格的轮廓隐马尔可夫模型（profile Hidden Markov Model, HMM）能够表示哪些序列约束，不能表示哪些，然后评估每个选项。\n\n基本原理：profile HMM 通过沿一条路径的状态转移概率和状态发射概率的乘积，来定义序列上的一个概率分布。如果 $x_1, x_2, \\ldots, x_L$ 表示与匹配态 $M_1, M_2, \\ldots, M_L$ 对齐的序列符号，而 $s$ 表示状态路径，则联合概率可分解为：\n$$\nP(x, s) \\;=\\; \\left(\\prod_{t} P(s_t \\mid s_{t-1})\\right) \\left(\\prod_{t \\in \\text{emitting}} P(x_t \\mid s_t)\\right).\n$$\n关键在于，在给定状态路径的条件下，不同匹配位置的发射是独立的；不存在形如 $\\phi_{ij}(x_i, x_j)$ 这样能够耦合两个不同匹配态之间发射的项。因此，一个标准的 profile HMM 无法编码一种直接强制两个位置残基之间关系的依赖性（例如，一个成对约束，确保两者都是半胱氨酸，因为它们之间形成了二硫键）。然而，HMM 可以通过设置发射概率来强烈偏好或要求单个位置上的特定残基，也可以通过调整转移概率来偏好或禁止特定位置的删除。强制实现一个真正的成对依赖关系通常需要一个具有显式耦合的模型类别（例如，马尔可夫随机场（MRF））。或者，可以将基于 HMM 的比对与一个后验的确定性过滤器相结合，该过滤器检查指定列中是否有所需的残基。\n\n基于以上理解，我们评估每个选项：\n\n选项 A：手动编辑位置 $i$ 和 $j$ 的匹配态，使其发射半胱氨酸的概率为 $1$，并将 $i$ 和 $j$ 的删除转移概率设为 $0$；声称：仅此一项就能在 profile HMM 内部完全强制执行二硫键约束。\n- 在位置 $i$ 和 $j$ 处为半胱氨酸设置发射概率为 $1$ 并将删除转移概率设为 $0$，将迫使任何通过这些匹配态进行比对的序列在这两个位置上都具有半胱氨酸，并且必须访问这两个位置（无删除）。从狭义的、局部的角度看，它确实强制了两个列中都存在半胱氨酸。然而，声称这“在 profile HMM 内部完全强制执行二硫键约束”是夸大其词。首先，profile HMM 不会也无法编码成对依赖关系或结构键；它只能编码每个位置的发射和转移结构。其次，Pfam 会避免使用硬性的零/一概率，因为它们会破坏典型的统计训练和校准程序；HMMER 使用狄利克雷混合先验的训练方法本身不支持来自 `hmmbuild` 的精确 $0$/$1$ 约束，并且硬性的零转移概率对于稳健的打分和比对可能存在问题。在操作上，Pfam 不会实施这种手动硬性约束来强制执行结构键；最多只能用高概率来近似。因此，虽然这种操作强制了局部残基，但它并未“完全”模拟二硫键，也不是 Pfam 工作流程中编码这种结构约束的标准、有原则或受支持的方法。结论：不正确。\n\n选项 B：将位置 $i$ 和 $j$ 处匹配态的发射进行耦合，使得位置 $i$ 处的发射依赖于位置 $j$ 处的发射；声称：HMMER 风格的 profile HMM 支持此操作。\n- 跨不同匹配态的耦合发射违反了 profile HMM 的条件独立结构。HMMER 风格的 profile HMM 不支持跨列的耦合发射或成对发射因子。因此，这不受支持。结论：不正确。\n\n选项 C：使用一个标准的 Pfam 风格 profile HMM，并应用一个比对后过滤器，拒绝那些最优比对中在位置 $i$ 和 $j$ 处均缺少半胱氨酸（且未删除任一位置）的序列。\n- 这种方法将 HMM 保持在其预期范围内（在独立性假设下对比对进行评分），并在比对后确定性地强制执行生化要求。这是一个有效且实用的方法，可以确保被接受的序列在位置 $i$ 和 $j$ 都具有半胱氨酸且不删除它们，而无需声称 HMM 本身编码了这种成对依赖关系。结论：正确。\n\n选项 D：用一个支持显式成对耦合的模型（如马尔可夫随机场（MRF））替换或增强 profile HMM，以编码 $i$ 和 $j$ 之间的依赖关系；并指出 Pfam 的 profile HMM 无法表示此类耦合。\n- 马尔可夫随机场（MRF）或 Potts 模型包含形如 $\\phi_{ij}(x_i, x_j)$ 的成对项，原则上可以编码和评分位置间的成对约束，包括对半胱氨酸-半胱氨酸对的强烈偏好。这直接解决了 profile HMM 独立性假设的局限性。关于 Pfam 的 profile HMM 无法表示此类耦合的说法是正确的。尽管 Pfam 目前没有在策展中使用 MRF，但从方法论上讲，该策略是模拟这种依赖关系的有效方法。结论：正确。\n\n选项 E：转换为一个 profile 随机上下文无关文法（SCFG），并通过成对发射产生式来强制配对；声称标准工具原生支持此方法用于蛋白质二硫键。\n- Profile SCFG（协变模型）是 RNA 的标准模型，其中嵌套的碱基配对可以通过成对发射来建模。没有标准的、广泛使用的工具包能够原生应用 SCFG 的成对发射机制来在 profile 模型中强制执行蛋白质二硫键，并且蛋白质的接触模式不一定是上下文无关或嵌套的。因此，在 Pfam/蛋白质的背景下，这不是一个合适或受支持的途径。结论：不正确。\n\n因此，在给出的选项中，有效的策略是使用一个标准的 profile HMM 并配合一个比对后过滤器（选项 C），以及切换到或用一个成对耦合模型（如 MRF）来增强（选项 D），同时承认 Pfam 的 profile HMM 内部无法编码此类耦合。", "answer": "$$\\boxed{CD}$$", "id": "2418528"}]}