{"hands_on_practices": [{"introduction": "本练习旨在挑战你像计算生物物理学家一样思考，预测修改一个基本力场参数所带来的后果。通过思考改变定义原子大小的 Lennard-Jones 参数 $\\sigma$ 会发生什么，你将培养出一种直觉，理解微观相互作用如何决定蛋白质紧凑度和扩散速率等宏观属性。这种实践对于理解力场如何模拟生物分子的物理现实至关重要。[@problem_id:2417106]", "problem": "一个单链球状蛋白在显式水模型中使用全原子分子动力学（MD）进行模拟。所有非键参数均为标准参数，但所有主链$\\alpha$-碳原子的Lennard-Jones $\\sigma$参数被统一增加了$15\\%$。Lennard-Jones $\\epsilon$参数和所有静电部分电荷保持不变。假设对不同种类的原子对采用标准的Lorentz–Berthelot混合规则，并且模拟在恒定温度和压力下运行足够长的时间以重新达到平衡。相对于未经修改的模拟，以下哪种陈述最能描述蛋白质动力学和堆积的预期定性变化？\n\nA. 主链碳原子周围的有效范德华排斥作用增加，使优选的原子间距向外移动；平均回旋半径$R_g$略有增加，天然构象的分子内接触数量减少，平动扩散系数$D$减小。\n\nB. Lennard-Jones势能最小值向外移动，增加了吸引范围并稳定了更紧密的堆积；平均回旋半径$R_g$减小，平动扩散系数$D$增加。\n\nC. 预计不会有明显变化，因为只有$\\alpha$-碳原子被修改，而它们不控制堆积；堆积度量和平动扩散系数$D$都保持不变。\n\nD. Lennard-Jones $\\sigma$的增加实际上增加了蛋白质的质量，这减少了均方根涨落，并使回旋半径$R_g$保持不变。", "solution": "按照要求，首先将验证问题陈述的有效性。\n\n**第1步：提取已知条件**\n- 系统：在显式水模型中的单链球状蛋白。\n- 模拟：全原子分子动力学（MD）。\n- 力场扰动：所有主链$\\alpha$-碳原子（$C_\\alpha$）的Lennard-Jones（LJ）$\\sigma$参数被统一增加了$15\\%$。\n- 未改变的参数：LJ $\\epsilon$参数和所有静电部分电荷。\n- 混合规则：标准的Lorentz–Berthelot混合规则。\n- 模拟系综：恒温恒压（NPT）。\n- 平衡：系统被允许重新达到平衡。\n- 问题：描述相对于未经修改的模拟，蛋白质动力学（平动扩散系数$D$）和堆积（回旋半径$R_g$、天然构象接触）的预期定性变化。\n\n**第2步：使用提取的条件进行验证**\n该问题在经典分子动力学的框架内描述了一个定义明确的计算实验。其组成部分——蛋白质、显式水模型、全原子力场、Lennard-Jones势、Lorentz-Berthelot规则和NPT系综——在计算生物物理学领域都是标准配置。修改力场参数（$\\sigma$）是研究原子相互作用的能量和结构后果的常用技术。所提到的观测量（$R_g$，$D$，分子内接触）是表征蛋白质结构和动力学的标准度量。该问题具有科学依据、内容独立、客观且提法得当。它要求基于统计力学和高分子物理学的基本原理进行定性预测。\n\n**第3步：结论与行动**\n问题陈述有效。将推导解决方案。\n\n**解决方案的推导**\n用于模拟范德华相互作用的Lennard-Jones势由以下公式给出：\n$$V_{LJ}(r_{ij}) = 4\\epsilon_{ij} \\left[ \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{6} \\right]$$\n在此， $r_{ij}$ 是原子 $i$ 和 $j$ 之间的距离。参数 $\\sigma_{ij}$ 代表了粒子间势能为零时的有限距离，并与有效原子尺寸或范德华半径直接相关。与 $(r_{ij})^{-12}$ 成正比的排斥项在短距离内占主导地位，用于模拟空间排斥。与 $(r_{ij})^{-6}$ 成正比的吸引项在中等距离内占主导地位。势能在距离 $r_{min} = 2^{1/6}\\sigma_{ij}$ 处达到最小值。\n\n问题陈述指出，对于一个$\\alpha$-碳原子 $i$，其自身相互作用参数 $\\sigma_{ii}$ 增加为：$\\sigma'_{ii} = 1.15 \\times \\sigma_{ii}$。根据Lorentz–Berthelot混合规则，对于一个非同类原子对 $(i,j)$，其中 $i$ 是一个$C_\\alpha$，混合参数 $\\sigma'_{ij}$ 变为：\n$$ \\sigma'_{ij} = \\frac{\\sigma'_{ii} + \\sigma_{jj}}{2} = \\frac{1.15\\sigma_{ii} + \\sigma_{jj}}{2} $$\n由于 $\\sigma_{ii}$ 和 $\\sigma_{jj}$ 都是正定的，很明显 $\\sigma'_{ij} > \\sigma_{ij}$，其中 $\\sigma_{ij} = (\\sigma_{ii} + \\sigma_{jj})/2$。\n\n这个 $\\sigma'_{ij}$ 的增加有两个主要后果：\n1.  **空间排斥增强：** 势能的排斥壁向外推移。对于任何给定的原子间距 $r_{ij}$，排斥能 $4\\epsilon_{ij}(\\sigma'_{ij}/r_{ij})^{12}$ 比之前大得多。这意味着其它原子被$C_\\alpha$碳原子更强烈地排斥。这构成了这些主链原子周围有效范德华排斥体积的增加。\n2.  **势能最小值移动：** 最佳相互作用距离 $r'_{min} = 2^{1/6}\\sigma'_{ij}$ 增加。与主链$\\alpha$-碳原子相互作用的原子现在将倾向于处于更大的间距。\n\n由于$\\alpha$-碳原子构成了多肽链的主链，它们在结构上至关重要。增加它们的有效尺寸会迫使整个链进行调整。为了避免能量上不利的空间冲突，蛋白质必须膨胀。这导致整体结构变得不那么紧凑。\n- 因此，作为蛋白质尺寸度量的平均回旋半径 $R_g$ 将会**增加**。\n- 这种膨胀扰乱了天然状态下精确调控的堆积。侧链将重新排列，最佳的相互作用网络将被破坏。因此，天然构象的分子内接触数量预计会**减少**。\n\n接下来，我们考虑对动力学的影响。平动扩散系数 $D$ 描述了蛋白质在溶剂中移动的速度。对于在粘性流体中近似球形的对象，这由Stokes-Einstein方程描述：\n$$ D = \\frac{k_B T}{6 \\pi \\eta R_h} $$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是温度，$\\eta$ 是溶剂（水）的粘度，而 $R_h$ 是蛋白质的流体力学半径。流体力学半径是大分子在溶液中翻滚和扩散时有效尺寸的一种度量。它与回旋半径 $R_g$ 强相关。由于我们已经确定蛋白质会膨胀（$R_g$增加），其流体力学半径 $R_h$ 也将**增加**。因为 $D$ 与 $R_h$ 成反比，所以平动扩散系数 $D$ 将会**减小**。更大、更膨胀的蛋白质将受到溶剂更大的阻力，扩散得更慢。\n\n总而言之，该修改导致：空间排斥增加，$R_g$ 增加，天然构象接触减少，以及 $D$ 减小。\n\n**选项评估**\n\n**A. 主链碳原子周围的有效范德华排斥作用增加，使优选的原子间距向外移动；平均回旋半径$R_g$略有增加，天然构象的分子内接触数量减少，平动扩散系数$D$减小。**\n该陈述与推导完全一致。$\\sigma$的增加导致范德华排斥作用增强，并将优选距离向外推移。这导致蛋白质膨胀（$R_g$增加），从而破坏了天然堆积（接触减少）。更大的尺寸导致更慢的扩散（$D$减小）。\n**结论：正确。**\n\n**B. Lennard-Jones势能最小值向外移动，增加了吸引范围并稳定了更紧密的堆积；平均回旋半径$R_g$减小，平动扩散系数$D$增加。**\n该陈述不正确。虽然吸引*范围*在技术上确实延伸得更远，但增加$\\sigma$的主要影响是在更短距离上更强的排斥作用，这会*破坏*紧密堆积的稳定性。这导致$R_g$的增加，而非减少。增加的$R_g$对应于$D$的减少，而非增加。\n**结论：不正确。**\n\n**C. 预计不会有明显变化，因为只有$\\alpha$-碳原子被修改，而它们不控制堆积；堆积度量和平动扩散系数$D$都保持不变。**\n该陈述基于一个错误的前提。主链$C_\\alpha$原子对于定义蛋白质的折叠和整体堆积至关重要。修改它们的有效尺寸是一个显著的扰动，将导致结构和动力学出现明显变化。\n**结论：不正确。**\n\n**D. Lennard-Jones $\\sigma$的增加实际上增加了蛋白质的质量，这减少了均方根涨落，并使回旋半径$R_g$保持不变。**\n该陈述将LJ尺寸参数$\\sigma$与质量混淆了。这是两个不同的物理量。增加$\\sigma$并不会改变模拟中任何原子的质量。因此，基于这一错误前提得出的后续结论是无效的。此外，$R_g$预期会发生变化，而不是保持不变。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2417106"}, {"introduction": "分子动力学模拟的意义不仅在于得到一个答案，更在于基于正确的原因得到*正确*的答案。本问题呈现了一个常见情景：一个看似无害的模拟参数选择——朗之万恒温器中的摩擦系数 $\\gamma$——可能会导致对生物机制的误导性结论。通过分析这个案例，你将学会批判性地评估模拟选择如何可能产生动力学伪影，并体会热力学平衡与达到平衡的动力学路径之间的区别。[@problem_id:2417122]", "problem": "一种蛋白质受体可以采纳两种可相互转换的构象状态：一种是呈现出完全形成的结合口袋的开放状态 $P_{\\mathrm{O}}$，另一种是口袋被封闭的关闭状态 $P_{\\mathrm{C}}$。在没有配体的情况下，于温度 $T=300\\ \\mathrm{K}$ 时，$P_{\\mathrm{O}} \\rightleftharpoons P_{\\mathrm{C}}$ 之间的转换发生在亚微秒的时间尺度上。一个小分子配体 $L$ 从本体溶液中前来结合。一位研究人员在隐式溶剂中使用分子动力学 (MD) 模拟了此结合过程，采用了 Langevin 恒温器，摩擦系数为 $\\gamma=100\\ \\mathrm{ps}^{-1}$，积分时间步长为 $2\\ \\mathrm{fs}$。他观察到多个结合事件，在这些事件中，$L$ 首先与 $P_{\\mathrm{C}}$ 形成一个松散的、非特异性的接触，随后蛋白质发生较慢的构象变化转变为 $P_{\\mathrm{O}}$，而 $L$ 始终保持结合状态。基于这些轨迹，该研究人员得出结论，认为其结合机制是诱导契合（即配体结合后发生构象变化）。该体系目前没有可用的实验动力学数据。所有模拟的运行时间都足够长，以确保结合态和未结合态的平衡布居收敛。\n\n哪个选项最能解释为什么由于 $\\gamma$ 的选择，这一结论可能是错误的，并指出了一个合适的方法学上的改变来检验这一机制推断？\n\nA. 非常大的 $\\gamma$ 会使系统进入过阻尼状态，这会不成比例地抑制蛋白质构象转变速率（相对于配体平动扩散速率），从而使事件的时间顺序偏向于表观的诱导契合；补救措施是将 $\\gamma$ 减小到一个物理上实际的范围（例如，$\\gamma\\sim 1\\ \\mathrm{ps}^{-1}$），验证平衡统计量保持不变，并将推断出的事件序列和有效扩散与已知的物理值进行比较。\n\nB. 非常大的 $\\gamma$ 改变了正则系综的平衡分布，增加了 $P_{\\mathrm{C}}$ 的布居，从而强制了诱导契合的发生；补救措施是在相同的 $\\gamma$ 下运行更长时间，直到平衡恢复原状。\n\nC. 非常大的 $\\gamma$ 违反了涨落-耗散关系并破坏了细致平衡，引入了一个非物理的漂移，该漂移有利于结合后的构象变化；补救措施是将随机力设置为零，同时保留摩擦项。\n\nD. 非常大的 $\\gamma$ 提高了数值稳定性和跨越能垒估计的准确性，因此观察到的诱导契合比在较低 $\\gamma$ 下更可靠；补救措施是在不改变 $\\gamma$ 的情况下进一步增长时间步长以加速采样。", "solution": "问题陈述描述了一项计算实验，旨在阐明配体 $L$ 与一个存在两种构象——$P_{\\mathrm{O}}$（开放）和 $P_{\\mathrm{C}}$（关闭）——的蛋白质受体的结合机制。在继续解答之前，必须先确定问题设置的有效性。\n\n**问题有效性验证**\n\n**第一步：提取已知信息**\n- 体系：具有 $P_{\\mathrm{O}}$ 和 $P_{\\mathrm{C}}$ 状态的蛋白质，以及配体 $L$。\n- 去配体蛋白（Apo-protein）平衡：$P_{\\mathrm{O}} \\rightleftharpoons P_{\\mathrm{C}}$。\n- 去配体蛋白动力学：转换发生在亚微秒时间尺度上。\n- 模拟温度：$T=300\\ \\mathrm{K}$。\n- 模拟方法：分子动力学（MD），使用 Langevin 恒温器。\n- 溶剂模型：隐式溶剂。\n- 摩擦系数：$\\gamma=100\\ \\mathrm{ps}^{-1}$。\n- 积分时间步长：$2\\ \\mathrm{fs}$。\n- 模拟观察：配体 $L$ 与 $P_{\\mathrm{C}}$ 结合，随后蛋白质发生构象变化转变为 $P_{\\mathrm{O}}$。\n- 研究人员的结论：结合机制为诱导契合。\n- 数据限制：无可用实验动力学数据。\n- 收敛性：模拟运行时间足够长，已使平衡布居收敛。\n\n**第二步：有效性分析**\n该问题具有科学依据。它提出了一个计算生物学中研究蛋白质-配体结合机制的标准情景。诱导契合与构象选择的概念是该领域的核心。使用带有 Langevin 恒温器的分子动力学是一种成熟的技术。问题的核心在于对一个特定的模拟参数——摩擦系数 $\\gamma$——及其对动力学路径影响的批判性评估。这是 MD 模拟中一个不容忽视且重要的方法论考量。问题指定了 $\\gamma=100\\ \\mathrm{ps}^{-1}$ 这个值，众所周知，该值远高于液态水对应的摩擦（通常用 $\\gamma \\approx 1\\ \\mathrm{ps}^{-1}$ 建模）。这样一个参数选择如何在观察到的动力学行为中产生人为假象（artifacts），是一个有效且定义明确的科学问题。问题陈述是自洽、客观的，并且没有违反任何物理学或化学的基本原理。它描述了一项真实但可能存在缺陷的计算研究。\n\n**第三步：结论**\n问题陈述有效。我现在开始进行解答。\n\n**求解过程**\n\n目标是分析为什么基于高摩擦系数 $\\gamma=100\\ \\mathrm{ps}^{-1}$ 的 MD 模拟得出的“诱导契合”机制的结论可能是错误的。\n\n体系的动力学行为由每个原子 $i$ 的 Langevin 运动方程决定：\n$$ m_i \\frac{d^2\\mathbf{r}_i}{dt^2} = \\mathbf{F}_i(\\{\\mathbf{r}_j\\}) - \\gamma m_i \\frac{d\\mathbf{r}_i}{dt} + \\mathbf{R}_i(t) $$\n此处，$\\mathbf{F}_i$ 是从势能函数导出的保守力，第二项是摩擦阻力，$\\mathbf{R}_i(t)$ 是代表与隐式溶剂发生随机碰撞的随机力。摩擦力和随机力通过涨落-耗散定理联系在一起，该定理确保对于任何正值 $\\gamma$，只要模拟运行至收敛，体系就能正确地对正则 (NVT) 系综进行采样。问题陈述指出平衡布居已收敛，这意味着热力学性质（即各状态的相对自由能）已被正确采样。然而，研究人员的结论是关于*机制*的，这是一个关于动力学和反应路径的陈述，而不是关于热力学的。\n\n摩擦系数 $\\gamma$ 关键性地决定了体系的动力学行为。一个非常大的 $\\gamma$ 值，例如 $\\gamma=100\\ \\mathrm{ps}^{-1}$，会将体系推入高摩擦或“过阻尼”状态。在此状态下，惯性效应可以忽略不计，运动主要由系统力与摩擦力的平衡所主导。\n\n高摩擦对不同类型运动的影响是关键所在。\n1.  **配体扩散：** 配体 $L$ 的平动扩散是一个随机游走过程。其扩散系数 $D$ 与摩擦系数成反比，即 $D \\propto 1/\\gamma$。高 $\\gamma$ 值会减慢配体接近蛋白质的速度。\n2.  **蛋白质构象变化：** $P_{\\mathrm{C}} \\rightleftharpoons P_{\\mathrm{O}}$ 的转变是一个涉及跨越显著能垒的大尺度集体运动。根据 Kramers 关于过阻尼极限下越垒过程的理论，该过程的速率常数 $k_{conf}$ 也与摩擦力成反比，即 $k_{conf} \\propto 1/\\gamma$。\n\n虽然两个过程都被减慢，但它们被减慢的程度不一定相同。大分子的大尺度构象变化通常对摩擦力的增加比小分子的简单平动扩散要敏感得多。一个高的、不符合物理实际的粘度会不成比例地抑制蛋白质的慢集体运动模式。去配体蛋白内在的构象动力学（$P_{\\mathrm{C}} \\rightleftharpoons P_{\\mathrm{O}}$）在现实中发生在亚微秒时间尺度上，但被人为地减慢了几个数量级。\n\n这就造成了一个动力学假象。模拟实际上“冻结”了蛋白质的自然构象涨落。配体虽然也被减慢，但在其扩散并接近蛋白质的时间尺度上，蛋白质看起来是静态的。如果 $P_{\\mathrm{C}}$ 态是平衡时的主导构象（或者仅仅是配体遇到的第一个构象），配体就会与之结合。随后，观察到 $P_{\\mathrm{C}}L$ 复合物向最终的 $P_{\\mathrm{O}}L$ 状态的、慢得多的转变。这个事件序列——配体结合后发生构象变化——正是诱导契合的定义。\n\n然而，这条观察到的路径可能并非真实的物理路径。在现实中，当摩擦力处于物理实际的（低）水平时，蛋白质可能会在 $P_{\\mathrm{C}}$ 和 $P_{\\mathrm{O}}$ 之间快速涨落。配体可能会在溶液中等待，直到一个具有结合能力的 $P_{\\mathrm{O}}$ 状态出现，然后迅速结合。这将是一个“构象选择”机制。高摩擦的模拟通过人为减慢 $P_{\\mathrm{C}} \\to P_{\\mathrm{O}}$ 的转化，在动力学上阻断了这条路径，从而使结果偏向于诱导契合。\n\n检验这一假说的正确方法学途径是，将 $\\gamma$ 减小到一个物理上合理的数值（例如，$\\gamma \\approx 1-5\\ \\mathrm{ps}^{-1}$，这能更好地代表水的粘度），然后重复模拟。如果结合机制发生改变（例如，现在观察到了构象选择事件），那么最初的结论确实是模拟参数导致的人为结果。作为对照，必须验证所有状态的平衡布居保持不变，因为这些是力场和温度的属性，而不是动力学参数 $\\gamma$ 的属性。\n\n**选项评估**\n\n**A. 非常大的 $\\gamma$ 会使系统进入过阻尼状态，这会不成比例地抑制蛋白质构象转变速率（相对于配体平动扩散速率），从而使事件的时间顺序偏向于表观的诱导契合；补救措施是将 $\\gamma$ 减小到一个物理上实际的范围（例如，$\\gamma\\sim 1\\ \\mathrm{ps}^{-1}$），验证平衡统计量保持不变，并将推断出的事件序列和有效扩散与已知的物理值进行比较。**\n该选项正确地指出高 $\\gamma$ 会导致过阻尼状态。它正确地假定，这会不成比例地抑制蛋白质缓慢的集体构象变化（相对于其他运动），从而导致动力学偏差，使诱导契合路径显得占主导地位。所提出的补救措施在科学上是合理的：将 $\\gamma$ 减小到一个物理实际值，重新运行模拟以观察动力学，并使用平衡性质作为合理性检查。这是正确的分析。**正确**。\n\n**B. 非常大的 $\\gamma$ 改变了正则系综的平衡分布，增加了 $P_{\\mathrm{C}}$ 的布居，从而强制了诱导契合的发生；补救措施是在相同的 $\\gamma$ 下运行更长时间，直到平衡恢复原状。**\n这个陈述从根本上是错误的。一个正确实现的 Langevin 恒温器能确保对正则平衡分布进行采样，无论 $\\gamma > 0$ 的值是多少。摩擦系数影响的是动力学，而不是由势能函数决定的平衡态概率。问题也明确指出平衡布居已经收敛。基于这些原因，其补救措施是无稽之谈。**错误**。\n\n**C. 非常大的 $\\gamma$ 违反了涨落-耗散关系并破坏了细致平衡，引入了一个非物理的漂移，该漂移有利于结合后的构象变化；补救措施是将随机力设置为零，同时保留摩擦项。**\n选择一个大的 $\\gamma$ 值本身并不违反涨落-耗散定理或细致平衡；这些是积分算法的属性。这里的人为问题是动力学性质的，而不是恒温器统计力学基础的根本性崩溃。所提出的补救措施是灾难性的：移除随机力而保留摩擦力会消除热源，导致系统冷却到绝对零度（$T=0\\ \\mathrm{K}$）并停止所有运动。这将不再是一个在 $T=300\\ \\mathrm{K}$ 下的模拟。**错误**。\n\n**D. 非常大的 $\\gamma$ 提高了数值稳定性和跨越能垒估计的准确性，因此观察到的诱导契合比在较低 $\\gamma$ 下更可靠；补救措施是在不改变 $\\gamma$ 的情况下进一步增长时间步长以加速采样。**\n这个陈述具有危险的误导性。虽然高摩擦可能会增强某些积分器的数值稳定性，但它从根本上扭曲了越垒过程的物理动力学。一个人为造成的结果，根据其定义，不可能是“更可靠的”。目标是物理准确性，而不仅仅是数值稳定性。增长时间步长的补救措施也是有缺陷的；$2\\ \\mathrm{fs}$ 的时间步长对于许多生物分子系统来说已经接近极限，进一步增加它会冒着引入显著积分误差的风险，从而加剧了现有的物理不准确性。**错误**。", "answer": "$$\\boxed{A}$$", "id": "2417122"}, {"introduction": "除了模拟构象变化，分子动力学还是一个从第一性原理计算宏观输运性质的强大工具。这个实践练习将引导你完成从非平衡分子动力学（NEMD）模拟中计算水的剪切粘度 $\\eta$ 的过程。你将应用粘度的基本定义，分析假设的模拟数据，并执行必要的计算，从而在分子动力学的一个关键定量应用中获得动手实践经验。[@problem_id:2417123]", "problem": "您的任务是设计一个非平衡分子动力学模拟，以计算可转移分子间势三点（TIP3P）水模型的剪切粘度。剪切粘度的基本定义是，对于一个均匀稳态剪切流，剪切应力分量 $\\sigma_{xz}$ 与速度梯度 $\\partial v_x / \\partial z$ 成正比，其关系式为 $\\sigma_{xz} = \\eta \\, \\partial v_x / \\partial z$，其中 $\\eta$ 是剪切粘度。在使用周期性边界条件对 TIP3P 水模型进行均匀剪切的非平衡分子动力学稳态模拟中，我们沿梯度方向 $z$ 测量了层板平均速度剖面 $v_x(z)$，同时还测量了时间平均微观剪切应力 $\\sigma_{xz}$。系统沿 $z$ 方向的盒子长度为 $L_z$。\n\n对于下述每个测试用例，假设稳态剪切率是唯一的常数 $a$，$a$ 使得线性函数 $v_x(z) = a z + b$ 在限制于内部区间 $z \\in [\\alpha L_z, (1-\\alpha)L_z]$ 时，与所提供数据点 $(z_i, v_{x,i})$ 的平方偏差和最小，其中 $\\alpha$ 值因用例而异。使用这个 $a$ 作为剪切率 $\\partial v_x / \\partial z$，从定义关系式中计算 $\\eta$。所有位置 $z_i$ 和 $L_z$ 均以纳米为单位，必须转换为米。所有速度 $v_{x,i}$ 均以米每秒为单位。所有应力 $\\sigma_{xz}$ 均以帕斯卡为单位。最终的粘度 $\\eta$ 以毫帕斯卡-秒 (mPa·s) 表示，并四舍五入到三位小数。\n\n测试套件（每个用例提供 $L_z$、$\\alpha$、$\\sigma_{xz}$ 以及 $(z_i, v_{x,i})$ 点对列表）：\n\n- 用例 1：\n  - $L_z = 10$ 纳米\n  - $\\alpha = 0.2$\n  - $\\sigma_{xz} = 9.0 \\times 10^{6}$ 帕斯卡\n  - $(z_i \\text{ 单位：纳米}, v_{x,i} \\text{ 单位：米每秒})$ 列表：\n    [$(0, -50)$, $(1, -40)$, $(2, -30)$, $(3, -20)$, $(4, -10)$, $(5, 0)$, $(6, 10)$, $(7, 20)$, $(8, 30)$, $(9, 40)$, $(10, 50)$]\n- 用例 2：\n  - $L_z = 8$ 纳米\n  - $\\alpha = 0.25$\n  - $\\sigma_{xz} = -4.0 \\times 10^{6}$ 帕斯卡\n  - $(z_i \\text{ 单位：纳米}, v_{x,i} \\text{ 单位：米每秒})$ 列表：\n    [$(0, 20.2)$, $(1, 14.9)$, $(2, 10.3)$, $(3, 4.8)$, $(4, 0.0)$, $(5, -4.9)$, $(6, -10.3)$, $(7, -14.8)$, $(8, -20.1)$]\n- 用例 3：\n  - $L_z = 12$ 纳米\n  - $\\alpha = 0.2$\n  - $\\sigma_{xz} = 1.9 \\times 10^{5}$ 帕斯卡\n  - $(z_i \\text{ 单位：纳米}, v_{x,i} \\text{ 单位：米每秒})$ 列表：\n    [$(0, -1.2)$, $(2, -0.8)$, $(4, -0.4)$, $(6, 0.0)$, $(8, 0.4)$, $(10, 0.8)$, $(12, 1.2)$]\n- 用例 4：\n  - $L_z = 10$ 纳米\n  - $\\alpha = 0.3$\n  - $\\sigma_{xz} = 1.26 \\times 10^{7}$ 帕斯卡\n  - $(z_i \\text{ 单位：纳米}, v_{x,i} \\text{ 单位：米每秒})$ 列表：\n    [$(0, -52)$, $(1, -44)$, $(2, -36)$, $(3, -24)$, $(4, -12)$, $(5, 0)$, $(6, 12)$, $(7, 24)$, $(8, 36)$, $(9, 44)$, $(10, 52)$]\n\n您的程序必须为每个用例计算剪切粘度 $\\eta$（单位：毫帕斯卡-秒），仅使用基本关系式 $\\sigma_{xz} = \\eta \\, \\partial v_x / \\partial z$ 以及剪切率的定义，即 $v_x(z)$ 在指定内部区间上的最佳线性近似的斜率 $a$。所有计算必须使用国际单位制 (SI)。最终输出必须是单行文本，包含一个逗号分隔的列表，其中含有四个粘度值（单位：毫帕斯卡-秒），四舍五入到三位小数，并用方括号括起来，例如 $[x_1,x_2,x_3,x_4]$。", "solution": "基本原理是牛顿简单剪切粘性定律，该定律指出剪切应力 $\\sigma_{xz}$ 与速度梯度 $\\partial v_x / \\partial z$ 成正比，比例常数为剪切粘度 $\\eta$。用数学公式表示为 $\\sigma_{xz} = \\eta \\, \\partial v_x / \\partial z$。因此，一旦知道了稳态剪切率 $\\partial v_x / \\partial z$，就可以通过 $\\eta = \\sigma_{xz} / (\\partial v_x / \\partial z)$ 计算出粘度。\n\n在可转移分子间势三点（TIP3P）水分子的非平衡分子动力学稳态剪切模拟中，测得的层板平均速度剖面 $v_x(z)$ 与 $z$ 的关系在体相内部应近似为线性。为减轻周期性镜像或壁面附近的边界层畸变，我们将分析限制在内部区间 $z \\in [\\alpha L_z, (1-\\alpha)L_z]$，其中 $\\alpha$ 值因用例而异。此处，稳态剪切率定义为线性函数 $v_x(z) = a z + b$ 的斜率 $a$，该函数使得内部段中与所提供数据点的平方偏差和最小。这是唯一的最小二乘法最佳拟合斜率，公式如下：\n$$\na \\;=\\; \\frac{\\sum_{i} \\left(z_i - \\bar{z}\\right)\\left(v_{x,i} - \\bar{v}\\right)}{\\sum_{i} \\left(z_i - \\bar{z}\\right)^2},\n$$\n其中求和遍及所有满足 $z_i \\in [\\alpha L_z, (1-\\alpha)L_z]$ 的点，$\\bar{z}$ 是这些 $z_i$ 的平均值，$\\bar{v}$ 是对应 $v_{x,i}$ 的平均值。在计算 $a$ 之前，所有 $z_i$ 和 $L_z$ 都必须从纳米转换为米，这样 $a$ 的单位才是秒的倒数。当 $a$ 的单位为 $\\mathrm{s}^{-1}$，$\\sigma_{xz}$ 的单位为帕斯卡时，比值 $\\eta = \\sigma_{xz}/a$ 得到的粘度单位为帕斯卡-秒，再乘以 $1000$ 即可转换为毫帕斯卡-秒。\n\n将此方法应用于每个用例：\n\n- 用例 1：内部区间为 $z \\in [\\alpha L_z, (1-\\alpha)L_z] = [0.2 \\times 10, (1-0.2) \\times 10]$ 纳米 $= [2, 8]$ 纳米。所列剖面在内部完全呈线性，斜率为每纳米 10 米/秒。将纳米转换为米，得到 $a = 10 / (10^{-9}) = 1.0 \\times 10^{10}$ 秒$^{-1}$。因此，\n$$\n\\eta = \\frac{9.0 \\times 10^{6}}{1.0 \\times 10^{10}} = 9.0 \\times 10^{-4} \\text{ Pa·s} = 0.900 \\text{ mPa·s}。\n$$\n\n- 用例 2：内部区间为 $z \\in [0.25 \\times 8, (1-0.25) \\times 8]$ 纳米 $= [2, 6]$ 纳米。使用提供的五个内部点和最小二乘法公式，得到斜率约 $a \\approx -5.09 \\times 10^{9}$ 秒$^{-1}$（负号反映了负梯度）。当 $\\sigma_{xz} = -4.0 \\times 10^{6}$ 帕斯卡时，\n$$\n\\eta = \\frac{-4.0 \\times 10^{6}}{-5.09 \\times 10^{9}} \\approx 7.861 \\times 10^{-4} \\text{ Pa·s} \\approx 0.786 \\text{ mPa·s}。\n$$\n\n- 用例 3：内部区间为 $z \\in [0.2 \\times 12, (1-0.2) \\times 12]$ 纳米 $= [2.4, 9.6]$ 纳米。内部点位于 $z = 4, 6, 8$ 纳米处，对应的 $v_x$ 分别为 $-0.4, 0.0, 0.4$ 米/秒。最小二乘斜率恰好是每纳米 0.2 米/秒，因此 $a = 0.2 / (10^{-9}) = 2.0 \\times 10^{8}$ 秒$^{-1}$。当 $\\sigma_{xz} = 1.9 \\times 10^{5}$ 帕斯卡时，\n$$\n\\eta = \\frac{1.9 \\times 10^{5}}{2.0 \\times 10^{8}} = 9.5 \\times 10^{-4} \\text{ Pa·s} = 0.950 \\text{ mPa·s}。\n$$\n\n- 用例 4：内部区间为 $z \\in [0.3 \\times 10, (1-0.3) \\times 10]$ 纳米 $= [3, 7]$ 纳米。内部点呈线性关系，斜率为每纳米 12 米/秒，得到 $a = 12 / (10^{-9}) = 1.2 \\times 10^{10}$ 秒$^{-1}$。当 $\\sigma_{xz} = 1.26 \\times 10^{7}$ 帕斯卡时，\n$$\n\\eta = \\frac{1.26 \\times 10^{7}}{1.2 \\times 10^{10}} = 1.05 \\times 10^{-3} \\text{ Pa·s} = 1.050 \\text{ mPa·s}。\n$$\n\n将结果以毫帕斯卡-秒为单位汇总并四舍五入到三位小数，得到列表 $[0.900, 0.786, 0.950, 1.050]$，这符合最终输出格式的要求。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef best_fit_slope_in_interval(z_nm, v_ms, Lz_nm, alpha):\n    \"\"\"\n    Compute the least-squares slope a of v(z) = a z + b over the interior\n    interval [alpha*Lz, (1-alpha)*Lz], converting z from nm to m so that\n    a has units of 1/s.\n    \"\"\"\n    z_nm = np.asarray(z_nm, dtype=float)\n    v_ms = np.asarray(v_ms, dtype=float)\n    # Select interior points\n    z_min = alpha * Lz_nm\n    z_max = (1.0 - alpha) * Lz_nm\n    mask = (z_nm >= z_min) & (z_nm <= z_max)\n    z_sel_nm = z_nm[mask]\n    v_sel = v_ms[mask]\n    # Convert nm to m\n    z_sel_m = z_sel_nm * 1e-9\n    # Least-squares slope\n    z_mean = np.mean(z_sel_m)\n    v_mean = np.mean(v_sel)\n    dz = z_sel_m - z_mean\n    dv = v_sel - v_mean\n    denom = np.sum(dz * dz)\n    if denom == 0.0:\n        raise ValueError(\"Insufficient variation in z to determine slope.\")\n    a = np.sum(dz * dv) / denom  # units: (m/s)/m = 1/s\n    return a\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (Lz_nm, alpha, sigma_Pa, list_of_pairs (z_nm, v_ms))\n    test_cases = [\n        (\n            10.0,\n            0.2,\n            9.0e6,\n            [\n                (0.0, -50.0), (1.0, -40.0), (2.0, -30.0), (3.0, -20.0), (4.0, -10.0),\n                (5.0, 0.0), (6.0, 10.0), (7.0, 20.0), (8.0, 30.0), (9.0, 40.0), (10.0, 50.0)\n            ]\n        ),\n        (\n            8.0,\n            0.25,\n            -4.0e6,\n            [\n                (0.0, 20.2), (1.0, 14.9), (2.0, 10.3), (3.0, 4.8), (4.0, 0.0),\n                (5.0, -4.9), (6.0, -10.3), (7.0, -14.8), (8.0, -20.1)\n            ]\n        ),\n        (\n            12.0,\n            0.2,\n            1.9e5,\n            [\n                (0.0, -1.2), (2.0, -0.8), (4.0, -0.4), (6.0, 0.0),\n                (8.0, 0.4), (10.0, 0.8), (12.0, 1.2)\n            ]\n        ),\n        (\n            10.0,\n            0.3,\n            1.26e7,\n            [\n                (0.0, -52.0), (1.0, -44.0), (2.0, -36.0), (3.0, -24.0), (4.0, -12.0),\n                (5.0, 0.0), (6.0, 12.0), (7.0, 24.0), (8.0, 36.0), (9.0, 44.0), (10.0, 52.0)\n            ]\n        ),\n    ]\n\n    results = []\n    for Lz_nm, alpha, sigma_Pa, pairs in test_cases:\n        z_nm = [p[0] for p in pairs]\n        v_ms = [p[1] for p in pairs]\n        a = best_fit_slope_in_interval(z_nm, v_ms, Lz_nm, alpha)  # 1/s\n        eta_Pa_s = sigma_Pa / a  # Pa*s\n        eta_mPa_s = eta_Pa_s * 1e3  # mPa*s\n        results.append(eta_mPa_s)\n\n    # Round to three decimal places and format as required.\n    formatted = [f\"{x:.3f}\" for x in results]\n    print(f\"[{','.join(formatted)}]\")\n\nsolve()\n```", "id": "2417123"}]}