{"hands_on_practices": [{"introduction": "在药物设计和蛋白质工程中，我们经常需要量化分子变化（如突变）对结合亲和力的影响。这个练习将基础热力学原理与实际生物化学问题联系起来。通过使用一个基本方程，你将学会如何将可测量的实验数据（解离常数 $K_d$）转化为更有洞察力的热力学量——结合自由能变（$\\Delta\\Delta G$），从而精确评估突变的能量效应。[@problem_id:2112182]", "problem": "在一种新型抗生素的开发过程中，一位研究人员正在研究其与一种关键细菌酶的相互作用。该酶的野生型版本与抗生素结合的解离常数 $K_{d, \\text{WT}}$ 为 $1.0 \\times 10^{-6}$ M。发现该细菌的一个耐药菌株在这种酶中带有一个单点突变。生物化学分析显示，这种突变酶与同种抗生素的结合亲和力显著减弱，其解离常数 $K_{d, \\text{MUT}}$ 为 $5.0 \\times 10^{-5}$ M。\n\n计算由该单点突变引起的标准吉布斯结合自由能的变化，定义为 $\\Delta \\Delta G^\\circ = \\Delta G^\\circ_{\\text{MUTANT}} - \\Delta G^\\circ_{\\text{WILD-TYPE}}$。\n\n假设测量在 $298$ K 的标准温度下进行。使用理想气体常数 $R = 8.314 \\text{ J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$。最终答案以 kJ/mol 为单位，并四舍五入至三位有效数字。", "solution": "标准吉布斯结合自由能 $\\Delta G^\\circ$ 与结合过程平衡常数之间的关系是热力学中的一个基本原理。对于结合反应，平衡常数是结合常数 $K_a$。方程为：\n$$ \\Delta G^\\circ = -RT \\ln K_a $$\n其中 $R$ 是理想气体常数，$T$ 是绝对温度。\n\n题目给出了解离常数 $K_d$，它是结合常数 $K_a$ 的倒数。\n$$ K_d = \\frac{1}{K_a} $$\n将此关系代入自由能方程，我们得到用 $K_d$ 表示 $\\Delta G^\\circ$ 的表达式：\n$$ \\Delta G^\\circ = -RT \\ln\\left(\\frac{1}{K_d}\\right) $$\n利用对数性质 $\\ln(1/x) = -\\ln(x)$，我们可以将方程简化为：\n$$ \\Delta G^\\circ = RT \\ln K_d $$\n这个方程适用于野生型（WT）和突变型（MUT）的酶-抗生素相互作用。\n\n对于野生型酶，标准吉布斯结合自由能为：\n$$ \\Delta G^\\circ_{\\text{WILD-TYPE}} = RT \\ln K_{d, \\text{WT}} $$\n\n对于突变型酶，标准吉布斯结合自由能为：\n$$ \\Delta G^\\circ_{\\text{MUTANT}} = RT \\ln K_{d, \\text{MUT}} $$\n\n题目要求计算标准吉布斯结合自由能的变化量 $\\Delta \\Delta G^\\circ$，其定义为突变型和野生型的结合自由能之差：\n$$ \\Delta \\Delta G^\\circ = \\Delta G^\\circ_{\\text{MUTANT}} - \\Delta G^\\circ_{\\text{WILD-TYPE}} $$\n代入每个 $\\Delta G^\\circ$ 项的表达式：\n$$ \\Delta \\Delta G^\\circ = (RT \\ln K_{d, \\text{MUT}}) - (RT \\ln K_{d, \\text{WT}}) $$\n我们可以提取公因式 $RT$：\n$$ \\Delta \\Delta G^\\circ = RT (\\ln K_{d, \\text{MUT}} - \\ln K_{d, \\text{WT}}) $$\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$，我们得到 $\\Delta \\Delta G^\\circ$ 的最终符号表达式：\n$$ \\Delta \\Delta G^\\circ = RT \\ln\\left(\\frac{K_{d, \\text{MUT}}}{K_{d, \\text{WT}}}\\right) $$\n\n现在，我们可以将给定的数值代入此表达式。\n常数如下：\n$R = 8.314 \\text{ J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$\n$T = 298 \\text{ K}$\n\n解离常数如下：\n$K_{d, \\text{WT}} = 1.0 \\times 10^{-6} \\text{ M}$\n$K_{d, \\text{MUT}} = 5.0 \\times 10^{-5} \\text{ M}$\n\n首先，计算解离常数的比值。请注意，单位 (M) 将会抵消，留下一个无量纲的数，这是对数函数的参数所要求的。\n$$ \\frac{K_{d, \\text{MUT}}}{K_{d, \\text{WT}}} = \\frac{5.0 \\times 10^{-5} \\text{ M}}{1.0 \\times 10^{-6} \\text{ M}} = 50 $$\n\n现在，将此比值和常数代入 $\\Delta \\Delta G^\\circ$ 的方程中：\n$$ \\Delta \\Delta G^\\circ = (8.314 \\text{ J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}) \\times (298 \\text{ K}) \\times \\ln(50) $$\n计算 $R$ 和 $T$ 的乘积：\n$$ RT = 8.314 \\times 298 \\approx 2477.572 \\text{ J/mol} $$\n计算 50 的自然对数：\n$$ \\ln(50) \\approx 3.912023 $$\n现在，将这些值相乘以求得以 J/mol 为单位的 $\\Delta \\Delta G^\\circ$：\n$$ \\Delta \\Delta G^\\circ \\approx 2477.572 \\text{ J/mol} \\times 3.912023 \\approx 9692.23 \\text{ J/mol} $$\n\n题目要求答案以 kJ/mol 为单位。要从 J/mol 转换为 kJ/mol，我们除以 1000：\n$$ \\Delta \\Delta G^\\circ \\approx \\frac{9692.23}{1000} \\text{ kJ/mol} \\approx 9.69223 \\text{ kJ/mol} $$\n最后，我们必须按要求将答案四舍五入到三位有效数字：\n$$ \\Delta \\Delta G^\\circ \\approx 9.69 \\text{ kJ/mol} $$\n该正值表明突变酶的结合更不利（不稳定），这与其更高的解离常数一致。", "answer": "$$\\boxed{9.69}$$", "id": "2112182"}, {"introduction": "直接计算一个分子与蛋白质的结合自由能非常困难，但计算两个相似分子结合能力的差异则要容易得多。这个练习的核心是“热力学循环”这一巧妙构思，它是自由能计算的基石。通过理解自由能作为状态函数的特性，你可以设计出一条理论上成立的“炼金术”路径，从而间接地计算出难以通过实验直接测量的物理过程，例如相对结合亲和力。[@problem_id:2391919]", "problem": "一个蛋白质 $P$ 结合两种小分子配体：一个核心配体 $L$ 和一个延伸配体 $L^{\\ast}$。配体 $L^{\\ast}$ 是通过将一个取代基 $\\chi$ 共价附加到 $L$ 上构建的，因此 $L$ 是 $L^{\\ast}$ 的严格子结构。您希望计算在标准浓度 $c^{\\circ}=1\\,\\mathrm{M}$ 下的相对结合自由能，\n$$\\Delta\\Delta G_{\\mathrm{bind}} \\equiv \\Delta G_{\\mathrm{bind}}(L^{\\ast})-\\Delta G_{\\mathrm{bind}}(L),$$\n通过设计一个炼金术热力学循环，在蛋白质结合位点和体相水溶液中将 $L$ 变换为 $L^{\\ast}$。所有模拟均在恒温恒压下进行，当在结合位点进行炼金术变换时，除了与被变换配体的相互作用外，蛋白质环境保持不变。溶液分支中的溶剂环境是体相水，包含任何所需的抗衡离子，且其宏观热力学条件与结合位点分支相同。\n\n为清晰起见，您可以使用以下过程级符号：\n\n- $\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})$: 在 $P$ 的结合位点中，在其他热力学条件相同的情况下，将 $L$ 炼金术演变为 $L^{\\ast}$ 的平衡自由能变化，此过程不改变粒子数，并且除了炼金术映射本身固有的约束外，不引入或移除任何外部约束。\n\n- $\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$: 在体相溶剂中，在不施加任何约束的情况下，将 $L$ 演变为 $L^{\\ast}$ 的平衡自由能变化。\n\n- $\\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(X)$: 在保持配体 $X\\in\\{L,L^{\\ast}\\}$ 的化学拓扑结构不变的情况下，在 $P$ 的结合位点中，炼金术性地关闭 $X$ 与其环境的所有非键相互作用的平衡自由能；此过程在一种位置-取向约束下进行，该约束在解偶联过程中将 $X$ 局限在结合位点内。\n\n- $\\Delta G_{\\mathrm{decouple}}^{\\mathrm{solv}}(X)$: 在体相溶剂中，在没有约束的情况下，关闭配体 $X$ 的所有非键相互作用的平衡自由能。\n\n- $\\Delta G_{\\mathrm{release}}^{\\circ}$: 如果循环中包含这样一个约束释放步骤，则将一个完全解偶联、受简谐约束的配体从其约束中释放，成为相同体积内浓度为 $c^{\\circ}=1\\,\\mathrm{M}$ 的无相互作用理想气体所需的解析标准态校正。\n\n假设任何涉及约束的项，如果对于一个有效的标准态循环是必需的，则必须明确地包含 $\\Delta G_{\\mathrm{release}}^{\\circ}$。对于这个子结构对，使用一个最小的闭合热力学循环，以下哪个表达式能正确地得出 $\\Delta\\Delta G_{\\mathrm{bind}}$？\n\nA. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})-\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$.\n\nB. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})+\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$.\n\nC. $\\Delta\\Delta G_{\\mathrm{bind}}=\\big[\\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(L)-\\Delta G_{\\mathrm{decouple}}^{\\mathrm{solv}}(L)\\big]-\\big[\\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(L^{\\ast})-\\Delta G_{\\mathrm{decouple}}^{\\mathrm{solv}}(L^{\\ast})\\big]$.\n\nD. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})$.\n\nE. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})-\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})+\\Delta G_{\\mathrm{release}}^{\\circ}$.", "solution": "问题要求给出两种配体 $L$ 和 $L^{\\ast}$ 与蛋白质 $P$ 结合的相对结合自由能 $\\Delta\\Delta G_{\\mathrm{bind}}$ 的正确表达式。配体 $L^{\\ast}$ 是 $L$ 的一个超集。该计算基于一个炼金术热力学循环。\n\n首先，我们确立基本原理。吉布斯自由能 $G$ 是一个状态函数。这意味着对于任何闭合的热力学循环，自由能的净变化为零。我们将构建这样一个循环，它将结合的物理过程与将一种配体转换为另一种配体的计算性炼金术过程联系起来。\n\n我们系统涉及的状态是蛋白质 $P$ 与配体 $L$ 和 $L^{\\ast}$ 在其结合和未结合形式下的组合：\n1. 蛋白质-配体复合物 $P:L$。\n2. 蛋白质-配体复合物 $P:L^{\\ast}$。\n3. 溶液中未结合的蛋白质 $P$ 和配体 $L$。\n4. 溶液中未结合的蛋白质 $P$ 和配体 $L^{\\ast}$。\n\n这些物理过程的标准结合自由能定义为：\n$$ \\Delta G_{\\mathrm{bind}}(L) = G(P:L) - [G(P) + G(L)] $$\n$$ \\Delta G_{\\mathrm{bind}}(L^{\\ast}) = G(P:L^{\\ast}) - [G(P) + G(L^{\\ast})] $$\n这里，$G(\\cdot)$ 代表指定物种的标准吉布斯自由能。我们寻求计算的量是相对结合自由能：\n$$ \\Delta\\Delta G_{\\mathrm{bind}} \\equiv \\Delta G_{\\mathrm{bind}}(L^{\\ast}) - \\Delta G_{\\mathrm{bind}}(L) $$\n代入上述定义并简化，我们得到：\n$$ \\Delta\\Delta G_{\\mathrm{bind}} = [G(P:L^{\\ast}) - G(P:L)] - [G(L^{\\ast}) - G(L)] $$\n\n现在，我们构建热力学循环。该循环通过四个过程（两个物理过程，两个炼金术过程）连接这四个状态。\n- 路径A（物理过程，水平上侧）：$L$ 的结合。$P + L \\rightarrow P:L$。自由能变化为 $\\Delta G_{\\mathrm{bind}}(L)$。\n- 路径B（物理过程，水平下侧）：$L^{\\ast}$ 的结合。$P + L^{\\ast} \\rightarrow P:L^{\\ast}$。自由能变化为 $\\Delta G_{\\mathrm{bind}}(L^{\\ast})$。\n- 路径C（炼金术过程，垂直左侧）：在溶剂中将 $L$ 演变为 $L^{\\ast}$。$P + L \\rightarrow P + L^{\\ast}$。蛋白质 $P$ 仅是旁观者。自由能变化为 $G(L^{\\ast}) - G(L)$，这正是问题中定义的量 $\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$。\n- 路径D（炼金术过程，垂直右侧）：在结合位点中将 $L$ 演变为 $L^{\\ast}$。$P:L \\rightarrow P:L^{\\ast}$。自由能变化为 $G(P:L^{\\ast}) - G(P:L)$，这是定义为 $\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})$ 的量。\n\n该热力学循环可以可视化为一个矩形：\n$$\n\\begin{array}{ccc}\nP + L & \\xrightarrow{\\Delta G_{\\mathrm{bind}}(L)} & P:L \\\\\n\\downarrow{\\tiny\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})} & & \\downarrow{\\tiny\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})} \\\\\nP + L^{\\ast} & \\xrightarrow{\\Delta G_{\\mathrm{bind}}(L^{\\ast})} & P:L^{\\ast}\n\\end{array}\n$$\n由于 $G$ 是一个状态函数，沿闭合回路的自由能变化之和为零。从状态 $P+L$ 开始，沿顺时针方向遍历循环：\n$$ \\Delta G_{\\mathrm{bind}}(L) + \\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast}) - \\Delta G_{\\mathrm{bind}}(L^{\\ast}) - \\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast}) = 0 $$\n注意，路径B的逆过程的自由能变化为 $-\\Delta G_{\\mathrm{bind}}(L^{\\ast})$，路径C的逆过程的变化为 $-\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$。\n重新排列此方程以求解所需量 $\\Delta\\Delta G_{\\mathrm{bind}} = \\Delta G_{\\mathrm{bind}}(L^{\\ast}) - \\Delta G_{\\mathrm{bind}}(L)$：\n$$ \\Delta G_{\\mathrm{bind}}(L^{\\ast}) - \\Delta G_{\\mathrm{bind}}(L) = \\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast}) - \\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast}) $$\n因此：\n$$ \\Delta\\Delta G_{\\mathrm{bind}} = \\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast}) - \\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast}) $$\n\n此推导基于“相对”或“演变”炼金术路径。问题陈述中对 $\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})$ 和 $\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$ 的定义与此路径一致。至关重要的是要注意，对于涉及子结构修改的此类计算，与平移和旋转相关的对结合能的巨大熵贡献被假定对于 $L$ 和 $L^{\\ast}$ 是相似的，因此在相对自由能中被抵消。因此，对于这个特定循环，不需要标准态校正项 $\\Delta G_{\\mathrm{release}}^{\\circ}$。$\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$ 的定义明确指出“不施加任何约束”，这支持了这一结论。\n\n现在我们评估每个选项。\n\nA. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})-\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$.\n该表达式与我们从热力学循环中得出的推导完全匹配。它正确地将相对结合自由能表示为蛋白质中和溶剂中炼金术变换自由能之间的差值。\n**结论：正确。**\n\nB. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})+\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$.\n该表达式中溶剂化项的符号不正确。根据热力学循环，溶剂化分支和结合分支必须相减，而不是相加。这对应于一个无效的循环构建。\n**结论：不正确。**\n\nC. $\\Delta\\Delta G_{\\mathrm{bind}}=\\big[\\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(L)-\\Delta G_{\\mathrm{decouple}}^{\\mathrm{solv}}(L)\\big]-\\big[\\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(L^{\\ast})-\\Delta G_{\\mathrm{decouple}}^{\\mathrm{solv}}(L^{\\ast})\\big]$.\n该表达式是根据一种不同的方法构建的，通常称为“双解偶联”，该方法分别为每个配体计算绝对结合自由能。绝对结合自由能近似为 $\\Delta G_{\\mathrm{bind}}(X) \\approx \\Delta G_{\\mathrm{decouple}}^{\\mathrm{solv}}(X) - \\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(X)$。基于此，C中的表达式变为 $\\Delta\\Delta G_{\\mathrm{bind}} \\approx [-\\Delta G_{\\mathrm{bind}}(L)] - [-\\Delta G_{\\mathrm{bind}}(L^{\\ast})] = \\Delta G_{\\mathrm{bind}}(L^{\\ast}) - \\Delta G_{\\mathrm{bind}}(L)$。虽然这看起来是正确的，但它忽略了标准态校正的关键细节。$\\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(X)$ 的定义需要位置约束。根据问题陈述，任何涉及此类约束的项，若要构成有效的标准态循环，都必须包含 $\\Delta G_{\\mathrm{release}}^{\\circ}$。标准结合自由能的正确表达式是 $\\Delta G_{\\mathrm{bind}}^{\\circ}(X) = \\Delta G_{\\mathrm{decouple}}^{\\mathrm{solv}}(X) - \\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(X) - \\Delta G_{\\mathrm{release}}^{\\circ}$。选项C中的表达式省略了这些不可抵消的约束校正项，因此对于通过此路径计算的标准相对结合自由能来说，它是一个不完整且不正确的公式。\n**结论：不正确。**\n\nD. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})$.\n仅当 $\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast}) = 0$ 时，该表达式才正确。这意味着配体 $L$ 和 $L^{\\ast}$ 的溶剂化自由能相同。由于 $L^{\\ast}$ 是通过向 $L$ 添加一个取代基 $\\chi$ 构建的，它们的化学性质以及与溶剂（水）的相互作用必然不同。因此，在任何非平凡的情况下，$\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast}) \\neq 0$。\n**结论：不正确。**\n\nE. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})-\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})+\\Delta G_{\\mathrm{release}}^{\\circ}$.\n此选项错误地将标准态校正项 $\\Delta G_{\\mathrm{release}}^{\\circ}$ 添加到正确的相对自由能表达式中。如前所述，对于两个具有共同核心的相关配体之间的相对计算，假定与结合相关的熵变会相互抵消。所定义的炼金术演变路径不需要使用那些需要通过 $\\Delta G_{\\mathrm{release}}^{\\circ}$ 来校正其释放过程的约束类型。该项与绝对结合自由能计算（如路径C中）相关，而与此处的相对计算无关。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2391919"}, {"introduction": "在掌握了理论设计之后，下一步是处理真实的模拟数据。这个实践练习将引导你使用一种强大且在现代研究中广泛应用的统计方法——贝内特接受率（Bennett Acceptance Ratio, BAR）方法。你将学习如何通过求解一个隐式方程，从正向和反向“炼金术”模拟产生的原始数据中，计算出最精确的自由能差值，最终得到可靠的相对结合自由能。[@problem_id:2455727]", "problem": "给定来自两个热力学状态的离散样本，这两个状态代表野生型蛋白质（状态 $0$）和突变型蛋白质（状态 $1$）之间的炼金术变换。对于每种热力学环境（结合复合物和溶剂中未结合的配体），您会得到两个无量纲折合势能差的列表。对于一个构象 $\\mathbf{x}$，该差值定义为 $\\Delta u(\\mathbf{x}) = \\beta \\left[ U_1(\\mathbf{x}) - U_0(\\mathbf{x}) \\right]$，其中 $\\beta = 1/(k_B T)$，$U_0$ 和 $U_1$ 分别是状态 $0$ 和状态 $1$ 的势能，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。一个列表 $\\{\\Delta u_i^{(0)}\\}_{i=1}^{n_0}$ 包含从状态 $0$ 中采样的构象计算出的值（每个元素是 $\\Delta u(\\mathbf{x}_i)$，其中 $\\mathbf{x}_i \\sim \\pi_0$），另一个列表 $\\{\\Delta u_j^{(1)}\\}_{j=1}^{n_1}$ 包含从状态 $1$ 中采样的构象计算出的值（每个元素是 $\\Delta u(\\mathbf{y}_j)$，其中 $\\mathbf{y}_j \\sim \\pi_1$）。状态 $1$ 和状态 $0$ 之间的无量纲自由能差 $\\Delta f$ 被定义为满足以下隐式方程的唯一实数：\n$$\n\\sum_{i=1}^{n_0} \\frac{1}{1 + \\exp\\!\\left(\\Delta u_i^{(0)} - \\Delta f - \\ln\\!\\frac{n_1}{n_0}\\right)}\n=\n\\sum_{j=1}^{n_1} \\frac{1}{1 + \\exp\\!\\left(-\\Delta u_j^{(1)} + \\Delta f - \\ln\\!\\frac{n_1}{n_0}\\right)}.\n$$\n对于每种环境（结合态和非结合态），从对应的列表对中计算 $\\Delta f$。突变相对于野生型的结合自由能变化，记为 $\\Delta\\Delta G_{\\text{bind}}$，由下式给出：\n$$\n\\Delta\\Delta G_{\\text{bind}} = \\left( \\Delta f_{\\text{bound}} - \\Delta f_{\\text{unbound}} \\right) \\, k_B T N_A,\n$$\n其中 $N_A$ 是阿伏伽德罗常数。将 $\\Delta\\Delta G_{\\text{bind}}$ 以千焦耳每摩尔 (kJ/mol) 为单位表示。使用 $k_B = 1.380\\,649 \\times 10^{-23}$ 焦耳每开尔文，$N_A = 6.022\\,140\\,76 \\times 10^{23}$ 每摩尔，以及每个测试用例中指定的温度 $T$。注意，$k_B T N_A = R T$，其中 $R$ 是摩尔气体常数。\n\n您的程序必须为以下每个测试用例计算 $\\Delta\\Delta G_{\\text{bind}}$，并输出一个单行，其中包含用方括号括起来的三个结果的逗号分隔列表。每个结果必须四舍五入到恰好三位小数，单位为 kJ/mol。\n\n测试套件：\n- 用例 $1$（正常路径，中等重叠）：\n  - 温度：$T = 300$ K。\n  - 结合环境：\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{bound}} = [\\,-1.2,\\,-0.8,\\,-1.0,\\,-1.1,\\,-0.9,\\,-1.3,\\,-0.7,\\,-1.0\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{bound}} = [\\,-0.4,\\,-0.6,\\,-0.5,\\,-0.7,\\,-0.8,\\,-0.3,\\,-0.6,\\,-0.5\\,]$\n  - 未结合环境：\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{unbound}} = [\\,0.2,\\,0.1,\\,0.3,\\,0.0,\\,0.4,\\,0.2,\\,0.1,\\,0.3\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{unbound}} = [\\,0.5,\\,0.4,\\,0.6,\\,0.7,\\,0.3,\\,0.5,\\,0.4,\\,0.6\\,]$\n- 用例 $2$（边界情况，相同状态）：\n  - 温度：$T = 300$ K。\n  - 结合环境：\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{bound}} = [\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{bound}} = [\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$\n  - 未结合环境：\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{unbound}} = [\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{unbound}} = [\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$\n- 用例 $3$（样本量不等，分布倾斜）：\n  - 温度：$T = 300$ K。\n  - 结合环境：\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{bound}} = [\\,0.9,\\,1.1,\\,0.8,\\,1.0,\\,0.7,\\,1.2\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{bound}} = [\\,0.4,\\,0.3,\\,0.5\\,]$\n  - 未结合环境：\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{unbound}} = [\\,0.2,\\,0.3,\\,0.1,\\,0.4,\\,0.2,\\,0.3\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{unbound}} = [\\,0.0,\\,0.1,\\,0.2\\,]$\n\n要求：\n- 对每种环境使用所提供的 $\\Delta f$ 定义。\n- 对每个用例，以 $\\text{kJ}\\cdot\\text{mol}^{-1}$ 为单位计算 $\\Delta\\Delta G_{\\text{bind}}$，并四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3]”），不含空格或任何额外文本。", "solution": "对问题陈述进行验证。\n\n**第 1 步：提取的已知信息**\n- 无量纲折合势能差的定义：$\\Delta u(\\mathbf{x}) = \\beta \\left[ U_1(\\mathbf{x}) - U_0(\\mathbf{x}) \\right]$。\n- 从状态 $0$ 采样的数据：$\\{\\Delta u_i^{(0)}\\}_{i=1}^{n_0}$。\n- 从状态 $1$ 采样的数据：$\\{\\Delta u_j^{(1)}\\}_{j=1}^{n_1}$。\n- 无量纲自由能差 $\\Delta f$ 的隐式方程：\n$$\n\\sum_{i=1}^{n_0} \\frac{1}{1 + \\exp\\!\\left(\\Delta u_i^{(0)} - \\Delta f - \\ln\\!\\frac{n_1}{n_0}\\right)}\n=\n\\sum_{j=1}^{n_1} \\frac{1}{1 + \\exp\\!\\left(-\\Delta u_j^{(1)} + \\Delta f - \\ln\\!\\frac{n_1}{n_0}\\right)}.\n$$\n- 结合自由能变化的公式：$\\Delta\\Delta G_{\\text{bind}} = \\left( \\Delta f_{\\text{bound}} - \\Delta f_{\\text{unbound}} \\right) \\, k_B T N_A$。\n- 常量：$k_B = 1.380\\,649 \\times 10^{-23} \\, \\text{J/K}$，$N_A = 6.022\\,140\\,76 \\times 10^{23} \\, \\text{mol}^{-1}$。\n- 测试用例提供了特定温度 $T$ 以及用于“结合”和“未结合”环境的 $\\{\\Delta u\\}$ 值列表。\n\n**第 2 步：验证**\n该问题具有科学依据、适定且客观。\n- **科学依据**：该问题描述了 Bennett 接受率 (BAR) 方法，这是一种严谨且广泛用于计算自由能差的统计力学技术。所提供的方程是从 BAR 方法推导出的 $\\Delta f$ 的正确最大似然估计量。用于定义 $\\Delta\\Delta G_{\\text{bind}}$ 的热力学循环也是化学中的一个标准和基本概念。\n- **适定性**：核心任务是求解给定的关于 $\\Delta f$ 的隐式方程。我们希望找到函数 $g(\\Delta f)$ 的根，该函数定义为：\n$$\ng(\\Delta f) = \\sum_{i=1}^{n_0} \\frac{1}{1 + \\exp\\!\\left(\\Delta u_i^{(0)} - \\Delta f - K \\right)} - \\sum_{j=1}^{n_1} \\frac{1}{1 + \\exp\\!\\left(-\\Delta u_j^{(1)} + \\Delta f - K \\right)}\n$$\n其中 $K = \\ln(n_1/n_0)$。\n为了评估是否存在唯一解，我们考察 $g(\\Delta f)$ 相对于 $\\Delta f$ 的导数。设 $h(x) = (1 + e^x)^{-1}$。其导数为 $h'(x) = -e^x(1+e^x)^{-2} = -h(x)(1-h(x))$，该导数严格为负。\n第一项相对于 $\\Delta f$ 的导数为 $\\sum_{i=1}^{n_0} h'(\\dots) \\cdot (-1) > 0$。\n第二项相对于 $\\Delta f$ 的导数为 $\\sum_{j=1}^{n_1} h'(\\dots) \\cdot (+1) < 0$。\n因此，它们之差的导数 $g'(\\Delta f)$ 是两个正项之和，因此严格为正。这证明了 $g(\\Delta f)$ 是 $\\Delta f$ 的一个严格单调递增函数。此外，当 $\\Delta f \\to \\infty$ 时，$g(\\Delta f) \\to n_0 > 0$。当 $\\Delta f \\to -\\infty$ 时，$g(\\Delta f) \\to -n_1 < 0$。一个从负到正穿过轴的连续单调函数必须有且仅有一个根。因此，该问题是适定的。\n- **客观性和完整性**：问题陈述使用了精确、无歧义的数学和科学语言。所有必要的数据和常量均已提供。未发现任何瑕疵。\n\n**结论：** 问题有效。\n\n**解题步骤**\n解题过程首先为每个热力学环境（结合的蛋白质-配体复合物和溶剂中未结合的配体）确定无量纲自由能差 $\\Delta f$。这通过数值求解所提供的隐式方程来实现。然后，根据这些值计算结合自由能的变化 $\\Delta\\Delta G_{\\text{bind}}$。\n\n1.  **求解 $\\Delta f$**：对于每种环境，我们必须找到函数 $g(\\Delta f) = 0$ 的根。由于已证明 $g(\\Delta f)$ 是单调的，我们可以采用一个稳健的一维求根算法。Brent 方法因其效率和在括号区间内的保证收敛性，是此目的的绝佳选择。我们必须根据输入数据数组 $\\{\\Delta u_i^{(0)}\\}$ 和 $\\{\\Delta u_j^{(1)}\\}$ 以及样本大小 $n_0$ 和 $n_1$ 来定义函数 $g(\\Delta f)$。常数项 $K = \\ln(n_1/n_0)$ 需预先计算。考虑到函数的渐近行为，一个宽的搜索区间，如 $[-100, 100]$，足以将根括入其内。\n\n2.  **计算 $\\Delta\\Delta G_{\\text{bind}}$**：一旦计算出结合态 ($\\Delta f_{\\text{bound}}$) 和非结合态 ($\\Delta f_{\\text{unbound}}$) 的自由能差，就使用热力学循环关系计算相对结合自由能：\n    $$\n    \\Delta\\Delta G_{\\text{bind}} = (\\Delta f_{\\text{bound}} - \\Delta f_{\\text{unbound}}) \\times k_B T N_A\n    $$\n    乘积 $k_B N_A$ 是摩尔气体常数，$R \\approx 8.314\\,462\\,618 \\dots \\, \\text{J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$。所得值最初以焦耳每摩尔为单位，必须通过除以 1000 转换为千焦耳每摩尔。\n\n3.  **实现**：整体算法在一个 Python 程序中实现。对于每个测试用例，步骤如下：\n    a. 提取温度 $T$ 和四个能量差列表。\n    b. 调用一个实现 Brent 方法（使用 `scipy.optimize.brentq`）的辅助函数，使用“结合”数据求解 $\\Delta f_{\\text{bound}}$。\n    c. 调用同一个辅助函数，使用“未结合”数据求解 $\\Delta f_{\\text{unbound}}$。\n    d. 使用步骤 b 和 c 的值以 $\\text{kJ/mol}$ 为单位计算 $\\Delta\\Delta G_{\\text{bind}}$。\n    e. 按要求将结果四舍五入到三位小数。\n    f. 收集所有测试用例的结果，并将其格式化为指定的输出字符串。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the change in binding free energy for three test cases\n    using the Bennett Acceptance Ratio (BAR) method.\n    \"\"\"\n    # Define physical constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    N_A = 6.02214076e+23 # Avogadro's number in mol^-1\n    R_J_PER_MOL_K = K_B * N_A # Molar gas constant in J/(mol*K)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"T\": 300.0,\n            \"bound\": {\n                \"u0\": [-1.2, -0.8, -1.0, -1.1, -0.9, -1.3, -0.7, -1.0],\n                \"u1\": [-0.4, -0.6, -0.5, -0.7, -0.8, -0.3, -0.6, -0.5],\n            },\n            \"unbound\": {\n                \"u0\": [0.2, 0.1, 0.3, 0.0, 0.4, 0.2, 0.1, 0.3],\n                \"u1\": [0.5, 0.4, 0.6, 0.7, 0.3, 0.5, 0.4, 0.6],\n            },\n        },\n        {\n            \"T\": 300.0,\n            \"bound\": {\n                \"u0\": [0.0, 0.0, 0.0, 0.0],\n                \"u1\": [0.0, 0.0, 0.0, 0.0],\n            },\n            \"unbound\": {\n                \"u0\": [0.0, 0.0, 0.0, 0.0],\n                \"u1\": [0.0, 0.0, 0.0, 0.0],\n            },\n        },\n        {\n            \"T\": 300.0,\n            \"bound\": {\n                \"u0\": [0.9, 1.1, 0.8, 1.0, 0.7, 1.2],\n                \"u1\": [0.4, 0.3, 0.5],\n            },\n            \"unbound\": {\n                \"u0\": [0.2, 0.3, 0.1, 0.4, 0.2, 0.3],\n                \"u1\": [0.0, 0.1, 0.2],\n            },\n        },\n    ]\n\n    def _bar_objective_function(delta_f, u0, u1, log_n1_over_n0):\n        \"\"\"\n        The objective function for BAR, the root of which is delta_f.\n        g(delta_f) = LHS - RHS from the problem statement.\n        \"\"\"\n        # Arguments for the exponential function\n        arg1 = u0 - delta_f - log_n1_over_n0\n        arg2 = -u1 + delta_f - log_n1_over_n0\n        \n        # Fermi-Dirac-like terms\n        # np.exp handles large negative exponents (result is 0) and large positive\n        # exponents (result is inf), which leads to the correct limit of 0 for 1/inf.\n        lhs = np.sum(1.0 / (1.0 + np.exp(arg1)))\n        rhs = np.sum(1.0 / (1.0 + np.exp(arg2)))\n        \n        return lhs - rhs\n\n    def calculate_delta_f(u0_list, u1_list):\n        \"\"\"\n        Calculates the dimensionless free energy difference (delta_f)\n        by finding the root of the BAR equation.\n        \"\"\"\n        u0 = np.array(u0_list, dtype=np.float64)\n        u1 = np.array(u1_list, dtype=np.float64)\n        \n        n0 = len(u0)\n        n1 = len(u1)\n        \n        if n0 == 0 or n1 == 0:\n            raise ValueError(\"Sample lists cannot be empty.\")\n\n        log_n1_over_n0 = np.log(n1 / n0)\n        \n        # Use brentq a robust root-finding algorithm. The function is monotonic,\n        # so a wide bracket is safe.\n        try:\n            # A search interval of [-100, 100] is sufficiently large.\n            delta_f = brentq(\n                _bar_objective_function,\n                a=-100.0,\n                b=100.0,\n                args=(u0, u1, log_n1_over_n0)\n            )\n        except ValueError:\n            # This can happen if the function does not cross zero within the interval,\n            # which indicates an issue with the data or interval. For this problem,\n            # it should not occur. A wider interval could be used if necessary.\n            delta_f = brentq(\n                _bar_objective_function,\n                a=-1000.0,\n                b=1000.0,\n                args=(u0, u1, log_n1_over_n0)\n            )\n\n        return delta_f\n\n    results = []\n    for case in test_cases:\n        T = case[\"T\"]\n        \n        # Calculate delta_f for the bound state\n        delta_f_bound = calculate_delta_f(case[\"bound\"][\"u0\"], case[\"bound\"][\"u1\"])\n        \n        # Calculate delta_f for the unbound state\n        delta_f_unbound = calculate_delta_f(case[\"unbound\"][\"u0\"], case[\"unbound\"][\"u1\"])\n        \n        # Calculate the final binding free energy change in kJ/mol\n        # delta_delta_G = (delta_f_bound - delta_f_unbound) * R * T\n        delta_delta_G_j_mol = (delta_f_bound - delta_f_unbound) * R_J_PER_MOL_K * T\n        delta_delta_G_kj_mol = delta_delta_G_j_mol / 1000.0\n        \n        results.append(delta_delta_G_kj_mol)\n\n    # Format the results to exactly three decimal places and create the final output string.\n    formatted_results = [\"{:.3f}\".format(res) for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2455727"}]}