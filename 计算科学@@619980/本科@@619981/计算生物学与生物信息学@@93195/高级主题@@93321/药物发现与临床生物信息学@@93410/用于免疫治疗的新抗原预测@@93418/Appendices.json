{"hands_on_practices": [{"introduction": "鉴定治疗性新抗原的旅程始于对海量基因组数据的筛选。第一个动手实践模拟了这一过程中的关键步骤：构建一个计算过滤器。你将实现一个基于规则的分类器，以区分真正的体细胞新抗原与种系变异及其他假象，从而巩固你对候选肽必须满足的核心标准的理解，例如其体细胞来源、MHC结合能力和基因表达水平。[@problem_id:2409285]", "problem": "给定一个基于新抗原生物学定义的规范决策问题。新抗原是一种源于体细胞突变的肽，存在于肿瘤中但不存在于患者的生殖系中；它能被至少一个具有足够强结合力的人类白细胞抗原 (HLA) 分子（Human Leukocyte Antigen (HLA)）呈递；并且其来源转录本在肿瘤中表达。对于每个候选肽，您将获得肿瘤和正常样本中变异等位基因和参考等位基因的测序读数计数、与一个或多个 HLA 等位基因的预测结合亲和力（单位为纳摩尔）以及以每百万转录本数 (TPM) 为单位的转录本表达量。您的任务是实现一个分类器，以判断每个候选肽是否满足真实新抗原的规范定义，并将其应用于一个固定的测试集。\n\n定义和符号。对于每个候选，给定非负整数 $T_{\\mathrm{ref}}$、$T_{\\mathrm{alt}}$、$N_{\\mathrm{ref}}$ 和 $N_{\\mathrm{alt}}$，分别代表肿瘤和正常样本中参考等位基因和变异等位基因的读数计数。定义肿瘤覆盖度 $T_{\\mathrm{cov}} = T_{\\mathrm{ref}} + T_{\\mathrm{alt}}$ 和正常样本覆盖度 $N_{\\mathrm{cov}} = N_{\\mathrm{ref}} + N_{\\mathrm{alt}}$。定义肿瘤变异等位基因频率 (Variant Allele Fraction (VAF)) 为\n$$\n\\mathrm{VAF}_T = \n\\begin{cases}\n\\dfrac{T_{\\mathrm{alt}}}{T_{\\mathrm{ref}} + T_{\\mathrm{alt}}}, & \\text{if } T_{\\mathrm{ref}} + T_{\\mathrm{alt}} > 0,\\\\\n0, & \\text{if } T_{\\mathrm{ref}} + T_{\\mathrm{alt}} = 0,\n\\end{cases}\n$$\n以及正常样本变异等位基因频率为\n$$\n\\mathrm{VAF}_N = \n\\begin{cases}\n\\dfrac{N_{\\mathrm{alt}}}{N_{\\mathrm{ref}} + N_{\\mathrm{alt}}}, & \\text{if } N_{\\mathrm{ref}} + N_{\\mathrm{alt}} > 0,\\\\\n0, & \\text{if } N_{\\mathrm{ref}} + N_{\\mathrm{alt}} = 0.\n\\end{cases}\n$$\n设预测的结合亲和力（单位为纳摩尔）列表为 $A = [a_1, a_2, \\dots, a_m]$，其中 $m \\geq 1$，肿瘤表达量为一个非负实数 $E$，单位为每百万转录本数 (Transcripts Per Million (TPM))。\n\n分类器规范。一个候选肽被分类为真实新抗原，当且仅当以下所有条件同时成立：\n1. 两个样本中都有足够的测序支持：$T_{\\mathrm{cov}} \\geq c_{\\min}$ 且 $N_{\\mathrm{cov}} \\geq c_{\\min}$。\n2. 体细胞突变特征与肿瘤富集的变异等位基因和生殖系缺失一致：$\\mathrm{VAF}_T \\geq \\tau_{\\mathrm{tumor}}$ 且 $\\mathrm{VAF}_N < \\tau_{\\mathrm{germ}}$。\n3. 至少有一个足够强的人类白细胞抗原结合预测：$\\min(A) \\leq \\theta_{\\mathrm{bind}}$（纳摩尔）。\n4. 足够的肿瘤表达量：$E \\geq \\theta_{\\mathrm{expr}}$（每百万转录本数 (TPM)）。\n\n使用以下固定阈值：$c_{\\min} = 10$，$\\tau_{\\mathrm{tumor}} = 0.05$，$\\tau_{\\mathrm{germ}} = 0.20$，$\\theta_{\\mathrm{bind}} = 500$（纳摩尔），以及 $\\theta_{\\mathrm{expr}} = 1.0$（每百万转录本数 (TPM)）。除了用于结合亲和力的纳摩尔和用于表达量的每百万转录本数 (TPM) 外，没有其他物理单位；不涉及角度单位。所有比较都应在标准实数意义上进行解释。\n\n测试集。请将您的分类器应用于以下七个候选。每个候选以元组 $(T_{\\mathrm{ref}}, T_{\\mathrm{alt}}, N_{\\mathrm{ref}}, N_{\\mathrm{alt}}, A, E)$ 的形式给出，其中 $A$ 是一个或多个实数的列表。\n\n- 候选 1：$(30, 20, 50, 0, [120.0, 720.0], 8.5)$。\n- 候选 2：$(25, 35, 30, 30, [50.0, 80.0], 12.0)$。\n- 候选 3：$(42, 18, 55, 0, [650.0, 800.0], 9.0)$。\n- 候选 4：$(15, 15, 40, 0, [100.0], 0.5)$。\n- 候选 5：$(28, 12, 5, 0, [30.0, 40.0], 10.0)$。\n- 候选 6：$(25, 25, 38, 2, [200.0, 400.0], 3.0)$。\n- 候选 7：$(50, 0, 60, 0, [5.0], 9.0)$。\n\n您的程序必须根据上述规范计算每个候选的分类结果，并生成单行输出，其中包含一个用方括号括起来的、逗号分隔的整数列表，其中 $1$ 表示“真实新抗原”，$0$ 表示“非真实新抗原”。例如，三个候选的输出可能如下所示：$[1,0,1]$。\n\n您的实现必须是自包含的，测试集需嵌入程序中。不允许也不需要任何外部输入。", "solution": "提交分析的问题陈述被认为是有效的。它提出了一个生物信息学领域的规范、自洽且有科学依据的计算任务。其目标是基于一套精确的规则和一个固定的测试集，为新抗原候选实现一个确定性分类器。该问题定义明確，所有定义、参数和数据都已明确提供。不存在矛盾、歧义或违反科学原理之处。我们现在开始进行求解。\n\n将一个候选肽分类为真实新抗原需要同时满足四个不同的标准。如果所有四个条件都满足，则候选被赋予分类结果 $1$（真实新抗原），否则为 $0$。这些条件所需的参数固定如下：\n- 最低覆盖度：$c_{\\min} = 10$ 读数。\n- 最低肿瘤变异等位基因频率 (VAF)：$\\tau_{\\mathrm{tumor}} = 0.05$。\n- 最高生殖系 VAF：$\\tau_{\\mathrm{germ}} = 0.20$。\n- 最高结合亲和力：$\\theta_{\\mathrm{bind}} = 500$ 纳摩尔 (nM)。\n- 最低肿瘤表达量：$\\theta_{\\mathrm{expr}} = 1.0$ 每百万转录本数 (TPM)。\n\n这四个条件是：\n1.  **测序覆盖度**：肿瘤覆盖度 $T_{\\mathrm{cov}} = T_{\\mathrm{ref}} + T_{\\mathrm{alt}}$ 和正常样本覆盖度 $N_{\\mathrm{cov}} = N_{\\mathrm{ref}} + N_{\\mathrm{alt}}$ 都必须至少为 $c_{\\min}$。\n2.  **体细胞来源**：肿瘤 VAF $\\mathrm{VAF}_T = T_{\\mathrm{alt}} / T_{\\mathrm{cov}}$ 必须至少为 $\\tau_{\\mathrm{tumor}}$，而正常样本 VAF $\\mathrm{VAF}_N = N_{\\mathrm{alt}} / N_{\\mathrm{cov}}$ 必须严格小于 $\\tau_{\\mathrm{germ}}$。如果覆盖度为 $0$，则 VAF 定义为 $0$。\n3.  **HLA 结合**：最小预测结合亲和力 $\\min(A)$ 必须小于或等于 $\\theta_{\\mathrm{bind}}$。\n4.  **基因表达**：来源转录本的表达量 $E$ 必须至少为 $\\theta_{\\mathrm{expr}}$。\n\n我们现在将这个分类逻辑系统地应用于提供的七个候选中的每一个。\n\n**候选 1**：输入为 $(T_{\\mathrm{ref}}, T_{\\mathrm{alt}}, N_{\\mathrm{ref}}, N_{\\mathrm{alt}}, A, E) = (30, 20, 50, 0, [120.0, 720.0], 8.5)$。\n1.  覆盖度：$T_{\\mathrm{cov}} = 30 + 20 = 50 \\geq 10$。$N_{\\mathrm{cov}} = 50 + 0 = 50 \\geq 10$。此条件满足。\n2.  VAF：$\\mathrm{VAF}_T = \\frac{20}{50} = 0.4 \\geq 0.05$。$\\mathrm{VAF}_N = \\frac{0}{50} = 0 < 0.20$。此条件满足。\n3.  结合：$\\min(A) = \\min([120.0, 720.0]) = 120.0 \\leq 500$。此条件满足。\n4.  表达量：$E = 8.5 \\geq 1.0$。此条件满足。\n所有四个条件均满足。分类结果：$1$。\n\n**候选 2**：输入为 $(25, 35, 30, 30, [50.0, 80.0], 12.0)$。\n1.  覆盖度：$T_{\\mathrm{cov}} = 25 + 35 = 60 \\geq 10$。$N_{\\mathrm{cov}} = 30 + 30 = 60 \\geq 10$。此条件满足。\n2.  VAF：$\\mathrm{VAF}_T = \\frac{35}{60} \\approx 0.583 \\geq 0.05$。然而，$\\mathrm{VAF}_N = \\frac{30}{60} = 0.5$，不小于 $0.20$。此条件不满足。\n该候选未满足体细胞来源标准，表明其可能为生殖系变异。\n分类结果：$0$。\n\n**候选 3**：输入为 $(42, 18, 55, 0, [650.0, 800.0], 9.0)$。\n1.  覆盖度：$T_{\\mathrm{cov}} = 42 + 18 = 60 \\geq 10$。$N_{\\mathrm{cov}} = 55 + 0 = 55 \\geq 10$。此条件满足。\n2.  VAF：$\\mathrm{VAF}_T = \\frac{18}{60} = 0.3 \\geq 0.05$。$\\mathrm{VAF}_N = \\frac{0}{55} = 0 < 0.20$。此条件满足。\n3.  结合：$\\min(A) = \\min([650.0, 800.0]) = 650.0$。这个值不小于或等于 $500$。此条件不满足。\n该候选因预测的结合亲和力弱而未通过。\n分类结果：$0$。\n\n**候选 4**：输入为 $(15, 15, 40, 0, [100.0], 0.5)$。\n1.  覆盖度：$T_{\\mathrm{cov}} = 15 + 15 = 30 \\geq 10$。$N_{\\mathrm{cov}} = 40 + 0 = 40 \\geq 10$。此条件满足。\n2.  VAF：$\\mathrm{VAF}_T = \\frac{15}{30} = 0.5 \\geq 0.05$。$\\mathrm{VAF}_N = \\frac{0}{40} = 0 < 0.20$。此条件满足。\n3.  结合：$\\min(A) = \\min([100.0]) = 100.0 \\leq 500$。此条件满足。\n4.  表达量：$E = 0.5$。这个值不大于或等于 $1.0$。此条件不满足。\n该候选因来源转录本的表达量不足而未通过。\n分类结果：$0$。\n\n**候选 5**：输入为 $(28, 12, 5, 0, [30.0, 40.0], 10.0)$。\n1.  覆盖度：$T_{\\mathrm{cov}} = 28 + 12 = 40 \\geq 10$。然而，$N_{\\mathrm{cov}} = 5 + 0 = 5$，不大于或等于 $10$。此条件不满足。\n该候选因正常样本中的测序覆盖度不足而未通过。\n分类结果：$0$。\n\n**候选 6**：输入为 $(25, 25, 38, 2, [200.0, 400.0], 3.0)$。\n1.  覆盖度：$T_{\\mathrm{cov}} = 25 + 25 = 50 \\geq 10$。$N_{\\mathrm{cov}} = 38 + 2 = 40 \\geq 10$。此条件满足。\n2.  VAF：$\\mathrm{VAF}_T = \\frac{25}{50} = 0.5 \\geq 0.05$。$\\mathrm{VAF}_N = \\frac{2}{40} = 0.05 < 0.20$。此条件满足。\n3.  结合：$\\min(A) = \\min([200.0, 400.0]) = 200.0 \\leq 500$。此条件满足。\n4.  表达量：$E = 3.0 \\geq 1.0$。此条件满足。\n所有四个条件均满足。\n分类结果：$1$。\n\n**候选 7**：输入为 $(50, 0, 60, 0, [5.0], 9.0)$。\n1.  覆盖度：$T_{\\mathrm{cov}} = 50 + 0 = 50 \\geq 10$。$N_{\\mathrm{cov}} = 60 + 0 = 60 \\geq 10$。此条件满足。\n2.  VAF：$\\mathrm{VAF}_T = \\frac{0}{50} = 0$。这个值不大于或等于 $0.05$。此条件不满足。\n该候选未通过，因为在肿瘤样本中没有变异等位基因的证据。\n分类结果：$0$。\n\n最终的分类向量为 $[1, 0, 0, 0, 0, 1, 0]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a classifier for neoantigens based on a formal set of criteria\n    and applies it to a fixed test suite.\n    \"\"\"\n    \n    # Define fixed thresholds as per the problem specification.\n    C_MIN = 10         # Minimum read coverage\n    TAU_TUMOR = 0.05   # Minimum tumor VAF\n    TAU_GERM = 0.20    # Maximum normal VAF\n    THETA_BIND = 500   # Maximum binding affinity in nM\n    THETA_EXPR = 1.0   # Minimum expression in TPM\n\n    # Define the test suite of candidate peptides.\n    # Each tuple is (T_ref, T_alt, N_ref, N_alt, A, E).\n    test_cases = [\n        (30, 20, 50, 0, [120.0, 720.0], 8.5),   # Candidate 1\n        (25, 35, 30, 30, [50.0, 80.0], 12.0),  # Candidate 2\n        (42, 18, 55, 0, [650.0, 800.0], 9.0),  # Candidate 3\n        (15, 15, 40, 0, [100.0], 0.5),          # Candidate 4\n        (28, 12, 5, 0, [30.0, 40.0], 10.0),    # Candidate 5\n        (25, 25, 38, 2, [200.0, 400.0], 3.0),  # Candidate 6\n        (50, 0, 60, 0, [5.0], 9.0),            # Candidate 7\n    ]\n\n    def calculate_vaf(alt_reads, ref_reads):\n        \"\"\"\n        Calculates the Variant Allele Fraction (VAF).\n        Returns 0 if total coverage is 0, as specified.\n        \"\"\"\n        coverage = alt_reads + ref_reads\n        if coverage == 0:\n            return 0.0\n        return alt_reads / coverage\n\n    results = []\n    for case in test_cases:\n        t_ref, t_alt, n_ref, n_alt, a_list, e_val = case\n        \n        # Calculate intermediate values needed for the classification logic.\n        t_cov = t_ref + t_alt\n        n_cov = n_ref + n_alt\n        vaf_t = calculate_vaf(t_alt, t_ref)\n        vaf_n = calculate_vaf(n_alt, n_ref)\n        min_binding_affinity = np.min(a_list)\n        \n        # Condition 1: Adequate sequencing support in both samples.\n        cond1 = (t_cov >= C_MIN) and (n_cov >= C_MIN)\n        \n        # Condition 2: Somatic alteration signature.\n        cond2 = (vaf_t >= TAU_TUMOR) and (vaf_n < TAU_GERM)\n        \n        # Condition 3: Sufficiently strong HLA binding prediction.\n        cond3 = min_binding_affinity <= THETA_BIND\n        \n        # Condition 4: Sufficient tumor expression.\n        cond4 = e_val >= THETA_EXPR\n        \n        # A candidate is a true neoantigen if and only if all conditions hold.\n        if cond1 and cond2 and cond3 and cond4:\n            results.append(1)\n        else:\n            results.append(0)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2409285"}, {"introduction": "当潜在候选肽通过初步筛选后，下一个挑战是根据其免疫原性潜力进行排序。本练习将介绍一个量化打分模型，它将主要组织相容性复合体 (MHC) 结合亲和力 ($IC_{50}$)、源基因表达 ($TPM$) 和外源性 ($F$) 等多个关键因素整合为一个统一的分数。通过计算该分数，你将亲身体验如何将不同的生物学信号进行数学组合，以优先选出最有希望用于治疗的新抗原。[@problem_id:2409290]", "problem": "一位研究人员正在为癌症免疫疗法筛选候选新抗原肽的优先级，其方法是结合三个可衡量的免疫原性潜力决定因素：与主要组织相容性复合体（MHC）的结合亲和力，以半数抑制浓度（$IC_{50}$，单位 nM）表示；源基因表达水平，以每百万转录本数（$TPM$）表示；以及一个无量纲的异源性分数 $F \\in [0,1]$，该分数用于量化与任何自身肽的差异程度。为了获得一个随着结合力增强、表达水平增高和异源性增大而增加的无量纲优先排序分数，首先将每个决定因素映射到一个单调的无量纲因子，然后将它们相乘，从而定义分数 $S$：\n- 亲和力强度：$a = \\max\\{0, \\ln(IC_{50}^{\\mathrm{ref}}/IC_{50})\\}$，其中 $IC_{50}^{\\mathrm{ref}} = 500\\,\\mathrm{nM}$。\n- 表达强度：$e = \\ln(1 + TPM)$。\n- 异源性：$F$ 为给定值。\n- 总分：$S = a \\cdot e \\cdot F$。\n此处 $\\ln$ 表示自然对数。\n\n对于一个候选肽，其 $IC_{50} = 50\\,\\mathrm{nM}$，$TPM = 12$，且 $F = 0.70$，计算 $S$ 的值。将您的最终答案以单个实数的形式报告，并四舍五入到 $4$ 位有效数字。分数 $S$ 是无量纲的；您的答案中不应包含单位。", "solution": "在继续之前，对问题陈述进行验证。\n\n**第一步：提取已知条件**\n-   与MHC的结合亲和力：$IC_{50}$，单位为 nM。\n-   参考结合亲和力：$IC_{50}^{\\mathrm{ref}} = 500\\,\\mathrm{nM}$。\n-   源基因表达：$TPM$。\n-   异源性分数：$F \\in [0,1]$。\n-   亲和力强度因子：$a = \\max\\{0, \\ln(IC_{50}^{\\mathrm{ref}}/IC_{50})\\}$。\n-   表达强度因子：$e = \\ln(1 + TPM)$。\n-   总优先排序分数：$S = a \\cdot e \\cdot F$。\n-   候选肽的数值：$IC_{50} = 50\\,\\mathrm{nM}$，$TPM = 12$，$F = 0.70$。\n-   要求：计算 $S$ 并将结果四舍五入到 $4$ 位有效数字。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据，提出了一个简化但概念上有效的新抗原优先排序评分模型，该模型在计算免疫学中使用。各项指标（$IC_{50}$、$TPM$、异源性）及其数学转换是该领域的标准做法。问题提法明确，因为所有必要的公式和数据都已提供，可得到唯一的数值解。语言客观且精确。所提供的数值在物理和生物学上是合理的。问题是自洽的、一致的，并且需要直接应用给定的模型。\n\n**第三步：结论与行动**\n问题被判定为有效。将推导解答。\n\n任务是使用所提供的公式和数据，计算候选新抗原肽的优先排序分数 $S$。分数 $S$ 是三个无量纲因子——亲和力强度 $a$、表达强度 $e$ 和异源性 $F$——的乘积。\n\n首先，我们计算亲和力强度因子 $a$。其公式为：\n$$a = \\max\\{0, \\ln(IC_{50}^{\\mathrm{ref}}/IC_{50})\\}$$\n给定的值为 $IC_{50}^{\\mathrm{ref}} = 500\\,\\mathrm{nM}$ 和 $IC_{50} = 50\\,\\mathrm{nM}$。将这些值代入公式中，得到：\n$$a = \\max\\{0, \\ln\\left(\\frac{500}{50}\\right)\\} = \\max\\{0, \\ln(10)\\}$$\n由于 $10$ 的自然对数是一个正数（$\\ln(10) \\approx 2.3026$），因此最大值为 $\\ln(10)$。\n$$a = \\ln(10)$$\n\n其次，我们计算表达强度因子 $e$。其公式为：\n$$e = \\ln(1 + TPM)$$\n给定的每百万转录本数值为 $TPM = 12$。代入此值，我们得到：\n$$e = \\ln(1 + 12) = \\ln(13)$$\n\n第三，异源性分数 $F$ 直接以无量纲数的形式给出：\n$$F = 0.70$$\n\n最后，我们通过将这三个因子相乘来计算总分 $S$：\n$$S = a \\cdot e \\cdot F$$\n代入计算出的 $a$ 和 $e$ 的表达式，以及 $F$ 的值：\n$$S = \\ln(10) \\cdot \\ln(13) \\cdot 0.70$$\n现在我们计算其数值。使用自然对数的近似值，$\\ln(10) \\approx 2.302585$ 和 $\\ln(13) \\approx 2.564949$。\n$$S \\approx (2.302585) \\cdot (2.564949) \\cdot 0.70$$\n$$S \\approx 5.905963 \\cdot 0.70$$\n$$S \\approx 4.134174$$\n问题要求最终答案四舍五入到 $4$ 位有效数字。前四位有效数字是 $4$、$1$、$3$ 和 $4$。第五位有效数字是 $1$，小于 $5$，因此向下舍入。\n$$S \\approx 4.134$$\n这是该候选肽最终的无量纲分数。", "answer": "$$\\boxed{4.134}$$", "id": "2409290"}, {"introduction": "一个得分很高的新抗原如果并非存在于所有肿瘤细胞中，它仍可能是一个糟糕的治疗靶点。这个更进一步的实践将深入探讨肿瘤克隆性这一关键概念，要求你估算携带特定突变的肿瘤细胞比例。通过处理变异等位基因频率 ($VAF$)、肿瘤纯度 ($p$) 和拷贝数 ($C_T, C_N$) 数据，你将学会如何从数学上评估一个新抗原是否是“克隆性的”，这是决定其作为癌症疫苗靶点潜在效力的关键因素。[@problem_id:2409282]", "problem": "给定一个数学模型，用于量化一个由肿瘤细胞和正常细胞组成的混合样本中，某个候选新抗原携带性体细胞变异的克隆性。该样本被建模为一部分比例为 $p$ 的肿瘤细胞和一部分比例为 $1 - p$ 的正常细胞的混合物，其中 $p \\in [0,1]$ 是以小数表示的肿瘤纯度。在感兴趣的基因组位点，每个肿瘤细胞的总拷贝数为 $C_T \\in \\mathbb{N}$，每个正常细胞的总拷贝数为 $C_N \\in \\mathbb{N}$。该变异存在于比例为 $f \\in [0,1]$ 的肿瘤细胞中（$f$ 是待估计的未知数），并且在那些携带变异的肿瘤细胞中，它出现在 $m \\in \\{1,2,\\dots,C_T\\}$ 个拷贝上（即等位基因多重性）。假设测序读数(reads)的抽样没有等位基因偏好。观测到的变异等位基因频率 (VAF) $v \\in [0,1]$ 被定义为样本中所有细胞内突变等位基因计数与总等位基因计数的期望比率，以小数表示。\n\n将变异的克隆性得分 $S$ 定义为携带该变异的肿瘤细胞的估计比例 $f$。该值根据上述模型从基本原理计算得出，然后截断到闭区间 $[0,1]$ 内，即如果原始估计值为负，则设 $S = 0$，如果原始估计值超过 $1$，则设 $S = 1$。所有涉及比例的量都必须以小数表示，而非百分比。\n\n编写一个程序，对以下测试套件中的每一组参数，计算克隆性得分 $S$，并将结果作为浮点数输出，精确到小数点后 $6$ 位。\n\n测试套件（每个元组为 $(p, C_T, C_N, m, v)$，所有比例均为小数）：\n- 情况 1：$(0.8, 2, 2, 1, 0.4)$\n- 情况 2：$(0.7, 2, 2, 1, 0.0875)$\n- 情况 3：$(0.9, 3, 2, 2, 0.6206896551724138)$\n- 情况 4：$(0.2, 2, 2, 1, 0.1)$\n- 情况 5：$(1.0, 2, 2, 1, 0.52)$\n- 情况 6：$(0.6, 1, 2, 1, 0.42857142857142855)$\n- 情况 7：$(0.85, 4, 2, 1, 0.011486486486486488)$\n- 情况 8：$(0.95, 5, 2, 3, 0.3525773195876289)$\n\n最终输出格式：您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表内无空格，结果顺序与测试用例的顺序相同。例如，输出必须形如 $[x_1,x_2,\\dots,x_8]$，其中每个 $x_i$ 是用例 $i$ 的克隆性得分，四舍五入到小数点后恰好 $6$ 位。", "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于癌症基因组学原理，问题定义明确、客观且内部一致。未发现任何与科学合理性、完整性或逻辑结构有关的缺陷。因此，我们可以继续推导解决方案。\n\n目标是计算克隆性得分 $S$，即携带特定体细胞变异的肿瘤细胞的估计比例 $f$。该得分是根据在肿瘤和正常细胞混合样本中观测到的变异等位基因频率 (VAF) $v$ 推导出来的。\n\nVAF $v$ 被定义为在整个细胞群体中，目标位点上突变等位基因的计数与所有等位基因总数的期望比率。\n$$ v = \\frac{\\text{Number of mutated alleles}}{\\text{Total number of alleles}} $$\n\n我们现在将根据所提供的模型参数，推导该分数的分子和分母的表达式。假设样本中的细胞总数归一化为 $1$。该样本由比例为 $p$ 的肿瘤细胞和比例为 $1-p$ 的正常细胞组成。\n\n首先，我们确定等位基因的总数（分母）。这是来自肿瘤细胞区室和正常细胞区室的等位基因之和。\n来自肿瘤区室的贡献，其细胞比例为 $p$，每个细胞的总拷贝数为 $C_T$，与 $p \\cdot C_T$ 成正比。\n来自正常区室的贡献，其细胞比例为 $1-p$，每个细胞的总拷贝数为 $C_N$，与 $(1-p) \\cdot C_N$ 成正比。\n因此，样本中等位基因的总数与这些贡献的总和成正比：\n$$ \\text{Total Alleles} \\propto p \\cdot C_T + (1-p) \\cdot C_N $$\n\n接下来，我们确定突变等位基因的数量（分子）。假设体细胞变异在正常细胞中不存在。它仅存在于比例为 $f$ 的肿瘤细胞中。\n在整个样本中，对应于携带变异的肿瘤细胞的比例是 $p \\cdot f$。\n在每一个携带变异的细胞中，突变等位基因存在于 $m$ 个拷贝上，其中 $m$ 是等位基因多重性。\n因此，样本中突变等位基因的数量与携带变异的细胞比例及该变异的多重性的乘积成正比：\n$$ \\text{Mutated Alleles} \\propto p \\cdot f \\cdot m $$\n\n将这些表达式代入VAF的定义，我们得到基本关系式：\n$$ v = \\frac{p \\cdot f \\cdot m}{p \\cdot C_T + (1-p) \\cdot C_N} $$\n\n我们的目标是估计 $f$。我们重排此方程以求解 $f$。令这个原始估计值为 $\\hat{f}$。\n$$ v \\cdot (p \\cdot C_T + (1-p) \\cdot C_N) = p \\cdot f \\cdot m $$\n鉴于所有测试用例中 $p \\in (0, 1]$ 且 $m \\in \\{1, 2, \\dots, C_T\\}$（这意味着 $m \\ge 1$），项 $p \\cdot m$ 不为零。因此我们可以分离出 $\\hat{f}$：\n$$ \\hat{f} = \\frac{v \\cdot (p \\cdot C_T + (1-p) \\cdot C_N)}{p \\cdot m} $$\n\n克隆性得分 $S$ 被定义为这个原始估计值 $\\hat{f}$ 被截断到有效的闭区间 $[0, 1]$ 内的结果。这样做是为了解释现实世界测量中可能存在的噪声或模型设定不当，这些可能导致物理上不可能的值（即 $\\hat{f} < 0$ 或 $\\hat{f} > 1$）。截断操作如下：\n$$ S = \\begin{cases} 0 & \\text{if } \\hat{f} < 0 \\\\ 1 & \\text{if } \\hat{f} > 1 \\\\ \\hat{f} & \\text{if } 0 \\le \\hat{f} \\le 1 \\end{cases} $$\n这可以简明地表示为 $S = \\max(0, \\min(1, \\hat{f}))$。\n\n该公式为计算每个给定测试用例的克隆性得分 $S$ 提供了一个完整且正确的方法。我们现在将实现这一计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the clonality score for a somatic variant based on a given\n    mathematical model of a mixed tumor-normal specimen.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (p, C_T, C_N, m, v)\n    test_cases = [\n        (0.8, 2, 2, 1, 0.4),\n        (0.7, 2, 2, 1, 0.0875),\n        (0.9, 3, 2, 2, 0.6206896551724138),\n        (0.2, 2, 2, 1, 0.1),\n        (1.0, 2, 2, 1, 0.52),\n        (0.6, 1, 2, 1, 0.42857142857142855),\n        (0.85, 4, 2, 1, 0.011486486486486488),\n        (0.95, 5, 2, 3, 0.3525773195876289),\n    ]\n\n    results = []\n    for case in test_cases:\n        p, C_T, C_N, m, v = case\n\n        # Numerator of the f_hat equation: v * (total alleles)\n        # Denominator of the f_hat equation: p * m\n        \n        # Calculate the weighted average copy number across the specimen,\n        # which is proportional to the total number of alleles.\n        total_allelic_content = p * C_T + (1 - p) * C_N\n        \n        # Calculate the denominator for the f_hat expression.\n        # From the problem constraints, p > 0 and m >= 1, so no division by zero.\n        f_hat_denominator = p * m\n        \n        # Calculate the raw estimate of the clonality fraction, f_hat.\n        f_hat = (v * total_allelic_content) / f_hat_denominator\n        \n        # The clonality score S is f_hat truncated to the interval [0, 1].\n        # np.clip is efficient for this operation.\n        clonality_score = np.clip(f_hat, 0.0, 1.0)\n        \n        results.append(clonality_score)\n\n    # Format the results to exactly 6 decimal places and create the final output string.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2409282"}]}