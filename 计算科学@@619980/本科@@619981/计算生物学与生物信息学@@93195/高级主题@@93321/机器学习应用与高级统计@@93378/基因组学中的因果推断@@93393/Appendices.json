{"hands_on_practices": [{"introduction": "在估计因果效应之前，我们必须首先理解变量之间的因果关系结构。有向无环图 (DAG) 为这些关系提供了一种直观的视觉语言，而 d-分离 规则使我们能够确定需要控制哪些变量以消除混杂偏倚。本练习将锻炼您运用 DAG 和后门准则识别有效调整集的能力，这是设计严谨的观察性研究的一项基本技能。[@problem_id:2377421]", "problem": "在一项关于调控机制的基因组学研究中，考虑以下由一个有向无环图（DAG）表示的因果系统。遗传变异 $Z_1$ 和 $Z_2$ 是作用于基因调控上游的单核苷酸多态性。变量 $X$ 表示一个转录因子的信使RNA表达量，$M$ 表示一个受 $X$ 调控的下游靶标模块的表达水平，$Y$ 表示在稳态下测量的细胞表型。该DAG的结构为：\n$$Z_1 \\rightarrow X \\rightarrow M \\rightarrow Y \\leftarrow Z_2 \\rightarrow X.$$\n假设所有变量 $\\{Z_1, Z_2, X, M, Y\\}$ 均为可观测的，并且您的目标是仅使用基于给定DAG中d-分离的协变量调整方法，从纯粹的观测数据中识别 $X$ 对 $Y$ 的总因果效应。调整仅限于不属于 $X$ 后代的暴露前变量。\n\n使用上述DAG和d-分离，确定在“调整集中不得包含 $X$ 的任何后代”这一限制条件下，从变量 $\\{Z_1, Z_2, M\\}$ 中可以选出多少个不同的协变量调整集，足以通过后门准则来识别 $X$ 对 $Y$ 的总因果效应。\n\n请以单一整数形式提供您的答案。无需四舍五入。", "solution": "该问题要求基于一个给定的有向无环图（DAG）和一系列约束条件，确定足以估计变量 $X$ 对变量 $Y$ 的总因果效应的、不同协变量调整集的数量。我将首先验证问题陈述的有效性，如果问题被认为是有效的，我将继续进行严格的推导。\n\n已知条件如下：\n- 一组五个可观测变量：遗传变异 $Z_1$ 和 $Z_2$，转录因子表达量 $X$，靶标模块表达量 $M$，以及表型 $Y$。\n- 一个由DAG表示的因果结构：$Z_1 \\rightarrow X \\rightarrow M \\rightarrow Y \\leftarrow Z_2 \\rightarrow X$。该表示法指定了以下有向边：$Z_1 \\rightarrow X$，$X \\rightarrow M$，$M \\rightarrow Y$，$Z_2 \\rightarrow Y$ 和 $Z_2 \\rightarrow X$。\n- 目标是识别 $X$ 对 $Y$ 的总因果效应。\n- 方法是基于d-分离推导出的后门准则的协变量调整。\n- 用于调整的潜在协变量集是 $\\{Z_1, Z_2, M\\}$。\n- 一个关键限制是调整集不得包含 $X$ 的任何后代。\n\n该问题在基因组学因果推断领域具有科学依据，是适定、客观且内部一致的。它没有违反任何科学原理或存在逻辑谬误。该问题是有效的。\n\n为了使用协变量调整来识别 $X$ 对 $Y$ 的总因果效应，我们必须找到所有满足后门准则的协变量集 $\\mathcal{S}$。对于一个有序变量对 $(X, Y)$，如果一个变量集 $\\mathcal{S}$ 满足以下两个条件，则它满足后门准则：\n1. $\\mathcal{S}$ 中的任何变量都不是 $X$ 的后代。\n2. $\\mathcal{S}$ 阻断了 $X$ 和 $Y$ 之间的每一条后门路径。后门路径是指 $X$ 和 $Y$ 之间的一条非因果路径，其起始于一个指向 $X$ 的箭头。\n\n让我们系统地应用这些条件。\n\n首先，我们必须在给定的DAG中识别出 $X$ 的后代。从 $X$ 出发的有向路径是 $X \\rightarrow M$ 和 $X \\rightarrow M \\rightarrow Y$。因此，$X$ 的后代是变量 $\\{M, Y\\}$。问题明确禁止将 $X$ 的后代包含在调整集中。可用的协变量集是 $\\{Z_1, Z_2, M\\}$。这个约束立即排除了 $M$ 成为任何有效调整集 $\\mathcal{S}$ 的一部分的可能性。因此，任何有效的调整集 $\\mathcal{S}$ 都必须是 $\\{Z_1, Z_2\\}$ 的一个子集。\n\n其次，我们必须识别出 $X$ 和 $Y$ 之间的所有后门路径。后门路径是起始于一条指向 $X$ 的边的路径。在给定的DAG中，指向 $X$ 的边是 $Z_1 \\rightarrow X$ 和 $Z_2 \\rightarrow X$。\n- 考虑一条从 $X \\leftarrow Z_1$ 开始的路径。要使其成为一条后门路径，必须存在一条从 $Z_1$ 到 $Y$ 且不经过 $X$ 的路径。检查DAG，不存在这样的路径。从 $Z_1$ 到任何其他变量的唯一路径都经过 $X$。因此，不存在涉及 $Z_1$ 的后门路径。变量 $Z_1$ 充当的是 $X$ 对 $Y$ 效应的工具变量，而不是混杂因子。\n- 考虑一条从 $X \\leftarrow Z_2$ 开始的路径。要使其成为一条后门路径，必须存在一条从 $Z_2$ 到 $Y$ 且不经过 $X$ 的路径。DAG中包含了边 $Z_2 \\rightarrow Y$。因此，路径 $X \\leftarrow Z_2 \\rightarrow Y$ 存在。这是一条由共同原因 $Z_2$ 产生的后门路径，它混淆了 $X$ 和 $Y$ 之间的关系。这是图中唯一的后门路径。\n\n第三，调整集 $\\mathcal{S}$ 必须阻断这条后门路径 $X \\leftarrow Z_2 \\rightarrow Y$。这条路径是一个“分叉”结构，当且仅当中间变量 $Z_2$ 被包含在条件集 $\\mathcal{S}$ 中时，该路径才被d-分离（被阻断）。因此，任何有效的调整集都必须包含 $Z_2$。\n\n第四，我们必须确保以集合 $\\mathcal{S}$ 为条件不会打开任何先前被阻断的路径。通过对一个对撞节点或其后代进行条件化，可能会打开新的路径。在该DAG中，对撞节点是 $X$（见于结构 $Z_1 \\rightarrow X \\leftarrow Z_2$）和 $Y$（见于 $M \\rightarrow Y \\leftarrow Z_2$）。我们潜在的条件变量是 $Z_1$ 和 $Z_2$。它们两者都不是对撞节点，也不是对撞节点的后代。因此，以 $\\{Z_1, Z_2\\}$ 的任何子集为条件都不会打开任何伪路径。\n\n综合我们的发现：\n1. 调整集 $\\mathcal{S}$ 必须是 $\\{Z_1, Z_2\\}$ 的一个子集。\n2. 调整集 $\\mathcal{S}$ 必须包含 $Z_2$。\n\n$\\{Z_1, Z_2\\}$ 的可能子集是 $\\emptyset$、$\\{Z_1\\}$、$\\{Z_2\\}$ 和 $\\{Z_1, Z_2\\}$。我们根据我们的准则对每个子集进行评估：\n- $\\mathcal{S} = \\emptyset$：无效。它不包含 $Z_2$。\n- $\\mathcal{S} = \\{Z_1\\}$：无效。它不包含 $Z_2$。\n- $\\mathcal{S} = \\{Z_2\\}$：有效。它包含 $Z_2$ 并且是 $\\{Z_1, Z_2\\}$ 的子集。它阻断了唯一的后门路径，并且没有打开新的路径。\n- $\\mathcal{S} = \\{Z_1, Z_2\\}$：有效。它包含 $Z_2$，因此阻断了后门路径。包含 $Z_1$ 对于满足后门准则而言是冗余的，但并非不正确。该集合仍然满足后门准则的两个条件。\n\n因此，在给定的约束条件下，恰好有两个不同的协变量调整集足以识别 $X$ 对 $Y$ 的总因果效应。这些集合是 $\\{Z_2\\}$ 和 $\\{Z_1, Z_2\\}$。此类集合的数量为 $2$。", "answer": "$$ \\boxed{2} $$", "id": "2377421"}, {"introduction": "混杂不仅是一个理论问题，它还可能导致我们得出与事实完全相反的结论。辛普森悖论是一个经典的统计现象，其中一个趋势在几个不同的数据组中出现，但当这些组合并时，该趋势却消失或反转。通过分析一个假设的遗传关联研究案例，您将亲眼看到一个未观测的混杂因素（如群体结构）如何产生悖论性的结果，从而突显识别和控制混杂因素的至关重要性。[@problem_id:2377412]", "problem": "一项人类病例对照研究旨在探究在基因座 $L$ 上携带至少一个双等位基因 $G$ 对二元疾病结局 $D \\in \\{0,1\\}$ 的因果效应，其中 $D=1$ 表示病例，$D=0$ 表示对照。一个未被观测到的二元分层变量 $S \\in \\{S_1,S_2\\}$（代表隐藏的群体结构）同时影响等位基因频率和疾病风险。数据按如下方式收集，数据按 $S$ 进行了分层，但在主分析中并未记录 $S$：\n\n- 对于分层 $S_1$：病例中有 $40$ 名携带者和 $20$ 名非携带者；对照组中有 $90$ 名携带者和 $60$ 名非携带者。\n- 对于分层 $S_2$：病例中有 $10$ 名携带者和 $90$ 名非携带者；对照组中有 $4$ 名携带者和 $46$ 名非携带者。\n\n一位不了解 $S$ 的朴素分析师将 $S_1$ 和 $S_2$ 的个体合并，并将该遗传因素建模为二元暴露 $X \\in \\{0,1\\}$，其中当且仅当个体携带至少一个 $G$ 等位基因时，$X=1$。忽略 $S$，计算所有合并个体中，暴露组 $X=1$ 相对于非暴露组 $X=0$ 的疾病边际比值比。将您的答案以实数形式报告，并四舍五入到四位有效数字。", "solution": "比值比比较的是暴露组与非暴露组中的发病比值。对于一个有着如下计数的 $2 \\times 2$ 列联表：$a$（病例且 $X=1$），$b$（病例且 $X=0$），$c$（对照且 $X=1$），以及 $d$（对照且 $X=0$），其比值比为\n$$\n\\text{OR} \\;=\\; \\frac{a/b}{c/d} \\;=\\; \\frac{a d}{b c}.\n$$\n朴素分析忽略了分层变量 $S$，因此合并了 $S_1$ 和 $S_2$ 的计数。\n\n首先，汇总各层的数据：\n- 病例且 $X=1$ 的人数：$a \\,=\\, 40 + 10 \\,=\\, 50$。\n- 病例且 $X=0$ 的人数：$b \\,=\\, 20 + 90 \\,=\\, 110$。\n- 对照且 $X=1$ 的人数：$c \\,=\\, 90 + 4 \\,=\\, 94$。\n- 对照且 $X=0$ 的人数：$d \\,=\\, 60 + 46 \\,=\\, 106$。\n\n计算朴素边际比值比：\n$$\n\\text{OR}_{\\text{naive}} \\;=\\; \\frac{a d}{b c} \\;=\\; \\frac{50 \\times 106}{110 \\times 94} \\;=\\; \\frac{5300}{10340} \\;=\\; \\frac{265}{517}.\n$$\n其小数值为\n$$\n\\text{OR}_{\\text{naive}} \\;=\\; \\frac{265}{517} \\;\\approx\\; 0.512572533849\\ldots\n$$\n四舍五入到四位有效数字，\n$$\n\\text{OR}_{\\text{naive}} \\;\\approx\\; 0.5126.\n$$\n\n为了验证此设置展示了辛普森悖论，我们来考虑层内比值比（最终数值输出并不需要此项，但它能证实悖论性的逆转）。对于 $S_1$，\n$$\n\\text{OR}_{S_1} \\;=\\; \\frac{(40/20)}{(90/60)} \\;=\\; \\frac{2}{1.5} \\;=\\; \\frac{4}{3} \\;\\; 1,\n$$\n对于 $S_2$，\n$$\n\\text{OR}_{S_2} \\;=\\; \\frac{(10/90)}{(4/46)} \\;=\\; \\frac{1/9}{2/23} \\;=\\; \\frac{23}{18} \\;\\; 1.\n$$\n因此，在每个层内，基因携带者具有更高的疾病比值，但当各层数据合并后，朴素边际比值比满足 $\\text{OR}_{\\text{naive}} = 265/517  1$，这揭示了由隐藏分层变量 $S$ 的混杂效应所导致的辛普森悖论。", "answer": "$$\\boxed{0.5126}$$", "id": "2377412"}, {"introduction": "孟德尔随机化 (MR) 是一种强大的方法，它利用基因变异作为工具变量来推断因果关系，但它并非没有挑战。MR 的一个核心假设是遗传工具仅通过目标暴露影响结局，但这个假设可能被水平多效性（即基因变异影响其他通路）或与另一个真正致病变异的连锁不平衡 ($r^2$) 所违反。本编程练习模拟了一个连锁不平衡导致偏倚的双样本 MR 研究，您将量化这种偏倚，并观察它在特定条件下甚至可以逆转效应的方向，这是关于 MR 分析实践陷阱的重要一课。[@problem_id:2377409]", "problem": "考虑两个双等位基因单核苷酸多态性 (SNP)，记为 $G$ 和 $Z$，每个都经过加性编码并标准化，使其均值为 $0$，方差为 $1$。设它们的相关性为有符号的连锁不平衡 (LD) 相关系数 $r \\in [-1,1]$，LD 度量为 $r^2 \\in [0,1]$。假设有一个暴露 $E$ 和一个结局 $Y$，根据以下线性结构方程生成：\n$E = \\gamma G + \\xi$ 和 $Y = \\beta E + \\delta Z + \\varepsilon$，\n其中 $\\gamma, \\beta, \\delta \\in \\mathbb{R}$ 是固定常数，噪声项 $\\xi$ 和 $\\varepsilon$ 均值为零，且与 $(G,Z)$ 联合独立。假设 $Z$ 对 $E$ 没有因果效应，而 $G$ 除了通过 $E$ 之外，对 $Y$ 没有直接效应。考虑一项双样本孟德尔随机化 (MR) 研究，其中 $E$ 对 $G$ 的大样本边际关联在一个样本中进行估计，而 $Y$ 对 $G$ 的大样本边际关联在另一个独立样本中进行估计。MR 估计量定义为这两个大样本边际关联的比率。\n\n通过 $r^2$ 和一个符号参数 $s \\in \\{-1,+1\\}$ 间接给出了有符号的 LD 相关系数，其中 $r = s \\sqrt{r^2}$。对于每个指定的参数元组 $(\\gamma, \\beta, \\delta, r^2, s)$，计算：\n1) 以 $G$ 为工具变量，使用大样本 MR 估计 $E$ 对 $Y$ 的因果效应，\n2) 该估计值相对于真实因果效应 $\\beta$ 的绝对偏倚，\n3) 一个布尔值，指示 MR 估计值的符号是否与 $\\beta$ 的符号相反。\n\n所有计算都是无量纲的，不涉及物理单位。您的程序必须使用以下参数元组 $(\\gamma, \\beta, \\delta, r^2, s)$ 的测试套件：\n- 情况 1：$(0.2, 0.5, 0.3, 0.25, +1)$。\n- 情况 2：$(0.2, 0.5, 0.3, 0.0, +1)$。\n- 情况 3：$(0.4, 0.5, 0.3, 0.36, -1)$。\n- 情况 4：$(0.05, 0.1, 0.2, 0.81, -1)$。\n- 情况 5：$(-0.3, 0.4, 0.2, 1.0, +1)$。\n\n对于每种情况，输出一个三元列表 $[\\widehat{\\beta}_{\\mathrm{MR}}, \\mathrm{bias}, \\mathrm{flip}]$，其中 $\\widehat{\\beta}_{\\mathrm{MR}}$ 是大样本 MR 估计值，$\\mathrm{bias}$ 是绝对偏倚 $|\\widehat{\\beta}_{\\mathrm{MR}} - \\beta|$，而 $\\mathrm{flip}$ 是一个布尔值，如果 $\\widehat{\\beta}_{\\mathrm{MR}}$ 和 $\\beta$ 的符号相反，则为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。将所有浮点数四舍五入到小数点后 6 位。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素本身是对应一个测试情况的三元列表，例如，按给定情况的顺序为 $[[a,b, \\mathrm{False}],[c,d,\\mathrm{True}],\\dots]$。", "solution": "提交分析的问题陈述被认为是有效的。它在统计遗传学和因果推断领域，特别是在孟德尔随机化 (MR) 方面，具有坚实的科学基础。该问题是适定的，为获得唯一解提供了所有必要的参数和假设。它客观且没有歧义。因此，我们可以进行形式化的求解。\n\n该问题要求基于一个已定义的线性结构模型，计算大样本双样本 MR 估计值、其偏倚以及一个符号变化指示符。给定两个标准化的单核苷酸多态性 (SNP) $G$ 和 $Z$，其均值为 $0$，方差为 $1$。因此，它们的协方差等于其相关系数，即 $\\mathrm{Cov}(G, Z) = r = s \\sqrt{r^2}$。该系统由以下方程描述：\n$$ E = \\gamma G + \\xi $$\n$$ Y = \\beta E + \\delta Z + \\varepsilon $$\n其中 $G$ 是暴露 $E$ 对结局 $Y$ 效应的工具变量。$E$ 对 $Y$ 的真实因果效应是 $\\beta$。SNP $Z$ 是一个水平多效性的来源，因为它直接影响 $Y$ ($\\delta \\neq 0$)，并且与工具变量 $G$ 存在连锁不平衡 (LD) ($r \\neq 0$)。\n\nMR 估计量 $\\widehat{\\beta}_{\\mathrm{MR}}$ 定义为结局 $Y$ 对工具变量 $G$ 的大样本关联与暴露 $E$ 对 $G$ 的大样本关联之比。在大样本中，这些估计的关联会收敛到其总体对应值。对于一个标准化的工具变量 $G$ 且 $\\mathrm{Var}(G) = 1$，关联系数等于协方差。\n\n首先，我们推导 SNP-暴露关联，记为 $\\gamma_{G,E}$。\n$$ \\gamma_{G,E} = \\frac{\\mathrm{Cov}(E, G)}{\\mathrm{Var}(G)} = \\mathrm{Cov}(E, G) $$\n代入 $E$ 的模型：\n$$ \\gamma_{G,E} = \\mathrm{Cov}(\\gamma G + \\xi, G) = \\gamma \\mathrm{Cov}(G, G) + \\mathrm{Cov}(\\xi, G) $$\n考虑到 $\\mathrm{Var}(G) = 1$ 且噪声项 $\\xi$ 独立于 $G$ ($\\mathrm{Cov}(\\xi, G) = 0$)，上式简化为：\n$$ \\gamma_{G,E} = \\gamma \\cdot 1 + 0 = \\gamma $$\n\n其次，我们推导 SNP-结局关联，$\\Gamma_{G,Y}$。\n$$ \\Gamma_{G,Y} = \\frac{\\mathrm{Cov}(Y, G)}{\\mathrm{Var}(G)} = \\mathrm{Cov}(Y, G) $$\n我们代入 $Y$ 的模型，然后再代入 $E$ 的模型：\n$$ Y = \\beta E + \\delta Z + \\varepsilon = \\beta (\\gamma G + \\xi) + \\delta Z + \\varepsilon = \\beta\\gamma G + \\beta\\xi + \\delta Z + \\varepsilon $$\n现在，我们计算与 $G$ 的协方差：\n$$ \\Gamma_{G,Y} = \\mathrm{Cov}(\\beta\\gamma G + \\beta\\xi + \\delta Z + \\varepsilon, G) $$\n利用协方差的线性和噪声项的独立性 ($\\mathrm{Cov}(\\xi, G)=0, \\mathrm{Cov}(\\varepsilon, G)=0$)：\n$$ \\Gamma_{G,Y} = \\beta\\gamma \\mathrm{Cov}(G, G) + \\beta \\mathrm{Cov}(\\xi, G) + \\delta \\mathrm{Cov}(Z, G) + \\mathrm{Cov}(\\varepsilon, G) = \\beta\\gamma(1) + \\beta(0) + \\delta r + 0 = \\beta\\gamma + \\delta r $$\n\n大样本 MR 估计值 $\\widehat{\\beta}_{\\mathrm{MR}}$ 是这两个量的比值：\n$$ \\widehat{\\beta}_{\\mathrm{MR}} = \\frac{\\Gamma_{G,Y}}{\\gamma_{G,E}} = \\frac{\\beta\\gamma + \\delta r}{\\gamma} = \\beta + \\delta \\frac{r}{\\gamma} $$\n使用给定的关系 $r = s\\sqrt{r^2}$，估计值的最终表达式为：\n$$ \\widehat{\\beta}_{\\mathrm{MR}} = \\beta + \\delta \\frac{s\\sqrt{r^2}}{\\gamma} $$\n该表达式在 $\\gamma \\neq 0$ 的条件下有效，所有测试情况都满足此条件。\n\n绝对偏倚是估计值与真实效应 $\\beta$ 之间的绝对差值：\n$$ \\mathrm{bias} = |\\widehat{\\beta}_{\\mathrm{MR}} - \\beta| = \\left| \\left(\\beta + \\delta \\frac{r}{\\gamma}\\right) - \\beta \\right| = \\left| \\delta \\frac{r}{\\gamma} \\right| = \\frac{|\\delta| \\sqrt{r^2}}{|\\gamma|} $$\n\n符号翻转指示符 $\\mathrm{flip}$ 是一个布尔值，如果 $\\widehat{\\beta}_{\\mathrm{MR}}$ 和 $\\beta$ 的符号相反，则为真。这等价于检验条件 $\\widehat{\\beta}_{\\mathrm{MR}} \\cdot \\beta  0$，因为所提供的 $\\beta$ 值均不为零。\n\n现在我们将这些公式应用于每个测试情况。\n\n**情况 1：** $(\\gamma, \\beta, \\delta, r^2, s) = (0.2, 0.5, 0.3, 0.25, +1)$\n$r = +1 \\cdot \\sqrt{0.25} = 0.5$。\n$\\widehat{\\beta}_{\\mathrm{MR}} = 0.5 + 0.3 \\cdot \\frac{0.5}{0.2} = 0.5 + 0.75 = 1.25$。\n$\\mathrm{bias} = |1.25 - 0.5| = 0.75$。\n$\\mathrm{flip}$: $1.25 \\cdot 0.5  0$，所以为 $\\mathrm{False}$。\n结果：$[1.250000, 0.750000, \\mathrm{False}]$。\n\n**情况 2：** $(\\gamma, \\beta, \\delta, r^2, s) = (0.2, 0.5, 0.3, 0.0, +1)$\n$r = +1 \\cdot \\sqrt{0.0} = 0.0$。\n$\\widehat{\\beta}_{\\mathrm{MR}} = 0.5 + 0.3 \\cdot \\frac{0.0}{0.2} = 0.5$。\n$\\mathrm{bias} = |0.5 - 0.5| = 0.0$。\n$\\mathrm{flip}$: $0.5 \\cdot 0.5  0$，所以为 $\\mathrm{False}$。\n结果：$[0.500000, 0.000000, \\mathrm{False}]$。这是 LD 为零的无偏倚情况。\n\n**情况 3：** $(\\gamma, \\beta, \\delta, r^2, s) = (0.4, 0.5, 0.3, 0.36, -1)$\n$r = -1 \\cdot \\sqrt{0.36} = -0.6$。\n$\\widehat{\\beta}_{\\mathrm{MR}} = 0.5 + 0.3 \\cdot \\frac{-0.6}{0.4} = 0.5 - 0.45 = 0.05$。\n$\\mathrm{bias} = |0.05 - 0.5| = |-0.45| = 0.45$。\n$\\mathrm{flip}$: $0.05 \\cdot 0.5  0$，所以为 $\\mathrm{False}$。\n结果：$[0.050000, 0.450000, \\mathrm{False}]$。\n\n**情况 4：** $(\\gamma, \\beta, \\delta, r^2, s) = (0.05, 0.1, 0.2, 0.81, -1)$\n$r = -1 \\cdot \\sqrt{0.81} = -0.9$。\n$\\widehat{\\beta}_{\\mathrm{MR}} = 0.1 + 0.2 \\cdot \\frac{-0.9}{0.05} = 0.1 - 3.6 = -3.5$。\n$\\mathrm{bias} = |-3.5 - 0.1| = |-3.6| = 3.6$。\n$\\mathrm{flip}$: $-3.5 \\cdot 0.1  0$，所以为 $\\mathrm{True}$。\n结果：$[-3.500000, 3.600000, \\mathrm{True}]$。由于弱工具变量 ($\\gamma=0.05$) 导致的强偏倚引起了符号翻转。\n\n**情况 5：** $(\\gamma, \\beta, \\delta, r^2, s) = (-0.3, 0.4, 0.2, 1.0, +1)$\n$r = +1 \\cdot \\sqrt{1.0} = 1.0$。\n$\\widehat{\\beta}_{\\mathrm{MR}} = 0.4 + 0.2 \\cdot \\frac{1.0}{-0.3} = 0.4 - \\frac{2}{3} \\approx -0.266667$。\n$\\mathrm{bias} = |(-0.266667) - 0.4| = |-0.666667| \\approx 0.666667$。\n$\\mathrm{flip}$: $(-0.266667) \\cdot 0.4  0$，所以为 $\\mathrm{True}$。\n结果：$[-0.266667, 0.666667, \\mathrm{True}]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Mendelian randomization estimate, bias, and sign flip\n    for a series of parameter sets.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (gamma, beta, delta, r_squared, s)\n    test_cases = [\n        (0.2, 0.5, 0.3, 0.25, 1),\n        (0.2, 0.5, 0.3, 0.0, 1),\n        (0.4, 0.5, 0.3, 0.36, -1),\n        (0.05, 0.1, 0.2, 0.81, -1),\n        (-0.3, 0.4, 0.2, 1.0, 1),\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, beta, delta, r_squared, s = case\n\n        # Calculate the signed LD correlation r\n        r = s * np.sqrt(r_squared)\n\n        # Calculate the large-sample MR estimate beta_mr\n        # The formula is derived as beta_mr = beta + delta * r / gamma\n        # This is valid as gamma is non-zero in all test cases.\n        beta_mr = beta + (delta * r) / gamma\n\n        # Calculate the absolute bias of the estimate\n        bias = abs(beta_mr - beta)\n\n        # Determine if the estimate's sign is opposite to the true effect's sign.\n        # This condition is equivalent to beta_mr * beta  0, assuming beta is not 0.\n        # In all test cases, beta is positive, so this check simplifies to beta_mr  0.\n        flip = (beta_mr * beta)  0\n\n        results.append([beta_mr, bias, flip])\n\n    # Format the results into the required string format.\n    # Each result is a list [beta_mr, bias, flip].\n    # Floating point numbers are formatted to 6 decimal places.\n    # Booleans are converted to their string representation ('True' or 'False').\n    formatted_results = []\n    for res in results:\n        # Format: [float_val, float_val, Boolean]\n        # Example: [-3.500000, 3.600000, True]\n        formatted_res_str = f\"[{res[0]:.6f}, {res[1]:.6f}, {str(res[2])}]\"\n        formatted_results.append(formatted_res_str)\n\n    # Final print statement in the exact required format.\n    # Example: [[result1], [result2], ...]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2377409"}]}