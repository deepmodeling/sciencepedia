{"hands_on_practices": [{"introduction": "在分子动力学模拟中，正确选择压力控制方法对于获得物理上真实的结果至关重要。此练习探讨了一个常见的陷阱：在包含真空层的非均匀系统（例如液体-蒸汽界面）上错误地使用各向同性恒压器。通过分析这个思想实验，您将了解压力张量的各向异性以及为什么它要求使用更专门的恒压方法。[@problem_id:2464856]", "problem": "您正在模拟一个具有两个气-液界面的液体板层。该系统通过将凝聚相放置在周期性单元的中心，并在法线方向上留有较大的真空层来构建。您尝试使用各向同性控压器，在目标压力为 $1$ bar、温度为 $300$ K 的条件下，进行等温等压 (NPT) 模拟。代码报告的压力是通过维里表达式和动能贡献得到的力学压力，控压器会统一地缩放所有盒子边长，以使测量压力趋向目标压力。\n\n根据等温等压系综的基本定义，一个内能为 $U$、体积为 $V$ 的微观态的概率与 $\\exp\\!\\left[-\\beta\\,(U + p\\,V)\\right]$ 成正比，其中 $\\beta = 1/(k_{\\mathrm{B}}T)$，因此压力的控制是通过体积涨落实现的。在经典分子动力学中，微观力学压力估算量将压力与动能和维里除以瞬时体积关联起来。在一个界面板层构型中，由于表面张力的存在，压力张量是各向异性的，但各向同性控压器会对所有维度进行统一缩放，并隐含地假设了一个各向同性的目标。\n\n鉴于此设置，当您在带有真空层的板层系统上运行各向同性控压器时，哪个选项能最佳地描述将会发生什么，以及原因为何？\n\nA. 控压器将各向同性地收缩模拟单元，以提高测量压力，从而消除真空层并同时横向压缩板层；由于体积减小被统一地应用于所有方向，界面将会坍塌或与周期性镜像发生相互作用。\n\nB. 控压器将仅调整垂直于板层的盒子边长来维持目标压力，同时保持横向尺寸不变，因此真空层得以维持，界面构型保持完整。\n\nC. 控压器将各向同性地膨胀盒子，以减小来自真空的负维里贡献的量值，从而增加真空层的厚度并在目标压力下稳定界面。\n\nD. 控压器的影响将微乎其微，因为真空对维里项和动能项的贡献均为零；因此，测量压力不受真空体积的影响，并在不改变盒子尺寸的情况下保持在目标值。\n\nE. 控压器将保持体积固定，仅通过重标粒子速度来调整动能贡献，直到测量压力等于目标压力，而盒子尺寸保持不变。", "solution": "所述问题描述了分子动力学模拟中一个常见但根本上存在缺陷的操作。在继续分析之前，我们必须首先验证其前提。\n\n**问题验证**\n\n给定条件如下：\n*   系统：一个在周期性单元中具有两个气-液界面的液体板层。\n*   构型：凝聚相位于中心，沿一个维度（法线方向）存在真空层。\n*   模拟系综：等温等压 (NPT)。\n*   目标温度：$T = 300$ K。\n*   目标压力：$p = 1$ bar。\n*   控压器类型：各向同性，即“统一地缩放所有盒子边长”。\n*   压力计算：来自维里表达式和动能贡献的力学压力。\n*   系综概率：与 $\\exp[-\\beta(U + pV)]$ 成正比。\n*   压力张量状态：因表面张力而呈各向异性。\n\n该问题在科学上是合理的。它描述了一个基于统计力学和分子动力学标准原理、定义明确的计算实验。NPT系综、维里压力、各向同性控压器以及界面系统中各向异性压力张量等概念都是标准的且陈述正确。问题要求预测此设置的可预见结果。该问题提法得当、客观，且不包含任何科学或逻辑上的矛盾。这是一个有效的问题。我们可以继续进行分析。\n\n**推导**\n\n分子动力学模拟中的压力 $P$ 是根据压力张量 $\\mathbf{P}$ 计算的。对于一个各向同性系统，标量压力是对角元素的平均值：\n$$ P = \\frac{1}{3} \\mathrm{Tr}(\\mathbf{P}) = \\frac{1}{3}(P_{xx} + P_{yy} + P_{zz}) $$\n压力张量的每个分量 $P_{\\alpha\\alpha}$ 都是在整个模拟单元体积 $V$ 上计算的：\n$$ P_{\\alpha\\alpha} = \\frac{1}{V} \\left( \\sum_{i=1}^N m_i v_{i,\\alpha}^2 + \\sum_{i<j} r_{ij,\\alpha} F_{ij,\\alpha} \\right) $$\n其中第一项是动能贡献，第二项是维里贡献。因此，模拟代码测量到的总标量压力为：\n$$ P_{measured} = \\frac{1}{3V} \\left( \\sum_{i=1}^N m_i |\\mathbf{v}_i|^2 + \\sum_{i<j} \\mathbf{r}_{ij} \\cdot \\mathbf{F}_{ij} \\right) = \\frac{N k_B T}{V} + \\frac{1}{3V} \\Xi $$\n此处，$N$ 是粒子数，$k_B$ 是玻尔兹曼常数，$T$ 是温度，而 $\\Xi$ 是总内维里。\n\n所述系统的关键特征是存在一个大的真空层。构成液体板层的粒子只占据了总模拟单元体积 $V$ 的一小部分。动能和维里的求和项只包含来自这些粒子的贡献。真空区域不含任何粒子，因此它对动能和维里都没有贡献。\n\n然而，由于这个真空层的存在，出现在压力表达式分母中的模拟单元总体积 $V$ 非常大。结果，动能项 $N k_B T / V$ 和维里项 $\\Xi / (3V)$ 都变得极小。因此，测量压力 $P_{measured}$ 将是一个非常接近零的值。\n\n目标压力规定为 $p_{target} = 1$ bar。控压器的功能是调整体积 $V$，使 $P_{measured}$ 等于 $p_{target}$。在这种情况下，我们有：\n$$ P_{measured} \\approx 0 \\ll p_{target} = 1 \\text{ bar} $$\n为了增加压力，控压器必须减小模拟单元的体积。问题陈述中指明了这是一个*各向同性*控压器，它会“统一地缩放所有盒子边长”。设缩放因子为 $\\lambda$。新的盒子矢量 $\\mathbf{L}'$ 与旧的盒子矢量 $\\mathbf{L}$ 的关系为 $\\mathbf{L}' = \\lambda \\mathbf{L}$。对于收缩，$\\lambda < 1$。\n\n这种统一缩放对板层构型会产生灾难性的影响。\n1.  垂直于板层的维度（我们称之为 $z$ 轴）会收缩，从而减小真空层。\n2.  平行于板层的维度（$x$ 和 $y$ 轴）也会以相同的因子 $\\lambda$ 收缩，从而在横向上压缩液体板层。\n\n控压器将不断地各向同性收缩整个模拟单元，直到体积 $V$ 小到足以使 $P_{measured}$ 达到 $1$ bar。这个过程将不可避免地导致真空层被完全消除。系统将坍塌成一个三维周期性的体相液体（如果过度压缩，则可能变为固体），填满整个小得多的模拟盒子。界面结构被破坏。这是一个经典的、众所周知的人为效应，发生在将各向同性控压器错误地应用于像板层这样的各向异性系统时。\n\n**逐项分析**\n\nA. 控压器将各向同性地收缩模拟单元，以提高测量压力，从而消除真空层并同时横向压缩板层；由于体积减小被统一地应用于所有方向，界面将会坍塌或与周期性镜像发生相互作用。\n*   **评估**：该陈述与我们的推导结论完全一致。计算出的压力接近零，迫使各向同性控压器收缩体积。这种收缩在所有方向上都是统一的，从而破坏了真空层并压缩了板层。界面被完全破坏。\n*   **结论**：**正确**。\n\nB. 控压器将仅调整垂直于板层的盒子边长来维持目标压力，同时保持横向尺寸不变，因此真空层得以维持，界面构型保持完整。\n*   **评估**：这描述的是*各向异性*或半各向异性控压器的行为，而不是各向同性控压器。问题明确指出控压器是各向同性的，并且“统一地缩放所有盒子边长”。此选项与给定条件相矛盾。\n*   **结论**：**错误**。\n\nC. 控压器将各向同性地膨胀盒子，以减小来自真空的负维里贡献的量值，从而增加真空层的厚度并在目标压力下稳定界面。\n*   **评估**：该陈述在两个方面存在缺陷。首先，控压器会收缩而非膨胀，因为测量压力远低于目标压力。其次，真空对维里的贡献为零，而不是一个负值。因此，该选项的整个前提在物理上是不正确的。\n*   **结论**：**错误**。\n\nD. 控压器的影响将微乎其微，因为真空对维里项和动能项的贡献均为零；因此，测量压力不受真空体积的影响，并在不改变盒子尺寸的情况下保持在目标值。\n*   **评估**：虽然真空对分子（维里和动能）的贡献为零，但它对分母（体积 $V$）有显著贡献。压力的表达式为 $P \\propto 1/V$。巨大的真空体积使得压力非常低。关于压力不受真空体积影响的断言是错误的。因此，控压器将产生非常显著而非可忽略的影响。\n*   **结论**：**错误**。\n\nE. 控压器将保持体积固定，仅通过重标粒子速度来调整动能贡献，直到测量压力等于目标压力，而盒子尺寸保持不变。\n*   **评估**：该选项错误地描述了控压器的功能。控压器通过改变系统体积来控制压力，正如问题中明确指出的：“压力的控制是通过体积涨落实现的”。调整粒子速度是用于控制温度的控温器的功能。此选项混淆了这两种算法。\n*   **结论**：**错误**。", "answer": "$$\\boxed{A}$$", "id": "2464856"}, {"introduction": "即使模拟设置正确，恒压器算法底层的实现也可能存在导致灾难性错误的缺陷。本练习将您置于计算科学家的角色，任务是诊断一个显示出体积失控膨胀的NPT模拟。通过分析这些症状，您将深入了解恒压器反馈回路的稳定性和符号约定的重要性。[@problem_id:2464831]", "problem": "一位同事请您帮助调试一个等温等压（NPT）分子动力学模拟。该模拟的对象是一个简单的单原子流体，粒子间通过短程对力相互作用。模拟使用了一个具有单一盒子缩放因子的各向同性盒子，和一个与标准确定性恒温器耦合的确定性恒压器。恒温器将动能温度维持在目标值附近，只有微小波动，但体积却单调快速增长，密度随之崩溃。运行日志显示：\n- 报告的瞬时“内压”仅由一个项计算得出，即 $P_{\\mathrm{id}} = N k_{\\mathrm{B}} T / V$；日志中未列出其他贡献项。\n- 目标压力为 $P_{\\mathrm{ext}} = 1\\,\\mathrm{bar}$。\n- 在 $t=0$ 时，报告的 $P_{\\mathrm{int}}$ 为 $0.5\\,\\mathrm{bar}$（低于目标值），但恒压器却立即增大了体积，并且即使在报告的 $P_{\\mathrm{int}}$ 衰减至 $0$ 的过程中也持续这样做。\n\n根据第一性原理，回顾以下几点：\n- 在等温等压系综中，相关的热力学势涉及焓 $H = U + P_{\\mathrm{ext}} V$ 和配分函数 $\\Delta(N,P_{\\mathrm{ext}},T) = \\int_{0}^{\\infty} \\mathrm{d}V\\, e^{-\\beta P_{\\mathrm{ext}} V} Z(N,V,T)$，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$。\n- 在周期性边界条件下，经典体系的力学内压由维里表达式给出：$P_{\\mathrm{int}} = N k_{\\mathrm{B}} T / V + (1/(3 V)) \\sum_{i<j} \\mathbf{r}_{ij} \\cdot \\mathbf{f}_{ij}$，其中 $\\mathbf{r}_{ij}$ 是粒子间矢量，$\\mathbf{f}_{ij}$ 是相应的对力。\n- 一个符号正确的各向同性恒压器必须以如下方式驱动盒子变量：当 $P_{\\mathrm{int}} > P_{\\mathrm{ext}}$ 时，体积增加（以降低 $P_{\\mathrm{int}}$）；当 $P_{\\mathrm{int}} < P_{\\mathrm{ext}}$ 时，体积减小（以提高 $P_{\\mathrm{int}}$）。\n\n下列哪一个单一的实现错误与观察到的现象最一致，并且如果修正该错误，其本身就能在不影响温度控制的情况下阻止体积的失控膨胀？\n\nA. 代码忽略了位形维里，仅将 $P_{\\mathrm{int}}$ 计算为 $P_{\\mathrm{id}} = N k_{\\mathrm{B}} T / V$，这使得算法认为压力过低而扩大盒子。\n\nB. 恒压器的反馈符号被颠倒，更新各向同性缩放因子的项与 $P_{\\mathrm{ext}} - P_{\\mathrm{int}}$ 成正比，导致当 $P_{\\mathrm{int}} < P_{\\mathrm{ext}}$ 时，算法进行膨胀而非压缩。\n\nC. 当改变盒子大小时，代码未能缩放粒子坐标，因此盒子在位置保持固定的情况下变大，导致压力估计值下降，从而不断触发进一步的膨胀。\n\nD. 目标压力以 $\\mathrm{bar}$ 为单位提供，但在内部被解释为 $\\mathrm{Pa}$，因此算法不断向极低绝对压力的方向膨胀，产生失控行为。", "solution": "我们从等温等压系综中压力的第一性原理定义以及稳定恒压器的正确定性行为出发。\n\n1) 来自维里定理的内压。对于周期性盒子中具有短程对力的经典体系，瞬时内压为\n$$\nP_{\\mathrm{int}} = \\frac{N k_{\\mathrm{B}} T}{V} + \\frac{1}{3 V} \\sum_{i<j} \\mathbf{r}_{ij}\\cdot \\mathbf{f}_{ij},\n$$\n其中第一项是理想气体（动能）贡献，第二项是位形（维里）贡献。该表达式源于压力的力学定义和维里定理。在凝聚相中，维里项通常不为零，并且在吸引作用显著的体系中可以为负，部分抵消理想气体项。\n\n2) 恒压器反馈的正确符号。在扩展系综表述中（例如，类Andersen或Nosé–Hoover型各向同性恒压器），会为盒子引入一个广义坐标（例如，体积 $V$ 或缩放因子 $s$），其运动方程包含内压和外压之间的差值。作用于 $V$ 的广义力源自包含 $P_{\\mathrm{ext}} V$ 项的扩展哈密顿量或拉格朗日量。稳定反馈的简单定性要求是：\n- 如果 $P_{\\mathrm{int}} > P_{\\mathrm{ext}}$，则恒压器必须增加 $V$（膨胀）以降低 $P_{\\mathrm{int}}$。\n- 如果 $P_{\\mathrm{int}} < P_{\\mathrm{ext}}$，则恒压器必须减小 $V$（压缩）以提高 $P_{\\mathrm{int}}$。\n这等价于形式为\n$$\n\\dot{\\eta} \\propto \\big(P_{\\mathrm{int}} - P_{\\mathrm{ext}}\\big),\n$$\n的更新，其中 $\\eta$ 是各向同性应变率（或 $V$ 的类似量），比例常数为正。符号至关重要：它必须使盒子朝着减小压力失配的方向移动。\n\n3) 解释观察结果。日志显示，在 $t=0$ 时，$P_{\\mathrm{int}} = 0.5\\,\\mathrm{bar}$ 而 $P_{\\mathrm{ext}} = 1\\,\\mathrm{bar}$。因此，$P_{\\mathrm{int}} < P_{\\mathrm{ext}}$，一个符号正确的恒压器应该压缩体系（减小 $V$）。然而，代码却扩大了体积，并且在报告的 $P_{\\mathrm{int}}$ 进一步向 $0$ 减小时继续膨胀。这与所要求的响应完全相反。恒温器将 $T$ 维持在目标值附近，因此动能温度控制不是失控行为的根源。\n\n现在评估每个选项：\n\n选项A：“忽略位形维里。”如果代码仅将 $P_{\\mathrm{int}}$ 计算为 $P_{\\mathrm{id}} = N k_{\\mathrm{B}} T / V$，那么它确实忽略了相互作用。然而，从一开始观察到的 $P_{\\mathrm{int}}$ 就低于目标值（$0.5\\,\\mathrm{bar}$ 对比 $1\\,\\mathrm{bar}$）。对于一个符号正确的恒压器，$P_{\\mathrm{int}} < P_{\\mathrm{ext}}$ 应该引起压缩，而不是膨胀。忽略维里可能会导致压力的数值错误，但它本身并不会反转控制方向。因此，仅忽略维里无法解释为何在 $P_{\\mathrm{int}} < P_{\\mathrm{ext}}$ 时会发生膨胀，也无法解释为何在 $P_{\\mathrm{int}}$ 趋近于 $0$ 时膨胀仍在继续。结论：不正确。\n\n选项B：“恒压器反馈符号颠倒。”假设实现的更新所用的符号导致当 $P_{\\mathrm{int}} < P_{\\mathrm{ext}}$ 时盒子膨胀，而当 $P_{\\mathrm{int}} > P_{\\mathrm{ext}}$ 时盒子压缩。那么，从 $P_{\\mathrm{int}} = 0.5\\,\\mathrm{bar}$ 和 $P_{\\mathrm{ext}} = 1\\,\\mathrm{bar}$ 开始，算法将会膨胀。随着 $V$ 增加，理想气体项 $N k_{\\mathrm{B}} T / V$ 减小，因此报告的 $P_{\\mathrm{int}}$ 进一步下降，使得（不正确的）反馈继续膨胀，导致体积失控增长。这种行为与观察到的现象完全匹配，并且不影响恒温器维持 $T$ 的能力。结论：正确。\n\n选项C：“改变盒子时未能缩放粒子坐标。”如果盒子膨胀但坐标未被缩放，数密度会减小；报告的 $P_{\\mathrm{int}}$ 通常会下降。然而，对于一个符号正确的恒压器，一旦 $P_{\\mathrm{int}}$ 降至 $P_{\\mathrm{ext}}$ 以下，控制器应该进行压缩以抵消膨胀。未能缩放坐标可能会导致伪影和瞬态现象，但它本质上不会反转反馈方向。若没有额外的符号错误，它无法解释从初始低压开始的持续单调膨胀。结论：不正确。\n\n选项D：“压力单位不匹配（bar vs Pa）。”如果 $1\\,\\mathrm{bar}$ 的 $P_{\\mathrm{ext}}$ 被解释为 $1\\,\\mathrm{Pa}$，那么初始时 $P_{\\mathrm{int}} \\gg P_{\\mathrm{ext}}$，将会触发膨胀。但随着 $V$ 增加和 $P_{\\mathrm{int}}$ 趋近于 $0$，最终 $P_{\\mathrm{int}} < P_{\\mathrm{ext}}$（以 $\\mathrm{Pa}$ 为单位），此时一个符号正确的恒压器会反向进行压缩。一旦压力低于（被误解的）目标值，仅单位不匹配本身并不能维持无限期的膨胀。因此，仅凭单位问题无法解释即使报告的 $P_{\\mathrm{int}}$ 衰减至 $0$ 膨胀仍在继续的现象；要产生单调的失控行为，仍然需要一个符号错误。结论：不正确。\n\n因此，与所有观察结果最一致、并且修正后足以阻止失控膨胀的单一实现错误是恒压器反馈中的符号反转（选项 B）。", "answer": "$$\\boxed{B}$$", "id": "2464831"}, {"introduction": "将等温等压系综的理论概念应用于可量化的化学问题是掌握该主题的关键一步。这个实践挑战您从基本热力学原理出发，推导并计算将溶质（如盐）添加到溶剂（如水）中时系统体积的变化。通过解决这个问题，您将把系综理论与表观摩尔体积等实验可测量的属性联系起来，并将您的理解转化为实际的计算代码。[@problem_id:2464863]", "problem": "您正在模拟在等温等压系综（恒定温度和压力，NPT）下，向液态水中加入氯化钠对系统体积的影响，温度为 $T=298.15\\ \\mathrm{K}$，压力为 $P=1\\ \\mathrm{atm}$。您的目标是从第一性原理出发，推导出一个描述加入盐后系统体积变化的表达式，然后进行数值实现。您必须使用下文指定的、物理上一致的近似和数据。\n\n从以下基本依据出发：\n1. 等温等压系综 (NPT) 保持温度 $T$ 和压力 $P$ 固定，而系统体积 $V$ 可以涨落。在固定 $T$ 和 $P$ 的条件下，经典热力学表明体积的全微分可以用偏摩尔体积表示：\n   $$dV = \\sum_i \\bar{v}_i\\,dn_i,$$\n   其中 $\\bar{v}_i$ 是组分 $i$ 的偏摩尔体积， $n_i$ 是组分 $i$ 的物质的量（单位为摩尔）。\n2. 偏摩尔体积定义为\n   $$\\bar{v}_i = \\left(\\frac{\\partial V}{\\partial n_i}\\right)_{T,P,\\{n_{j\\neq i}\\}}.$$\n3. 电解质在水中的表观摩尔体积，记为 $V_{\\phi}$，是一个可通过实验测量、依赖于组成的属性，可以根据经验将其建模为质量摩尔浓度的函数。对于在 $T=298.15\\ \\mathrm{K}$ 和 $P=1\\ \\mathrm{atm}$ 下水中的氯化钠（视为 $1:1$ 电解质），假设其满足 Masson 型关系：\n   $$V_{\\phi}(m) = V_{\\phi}^{\\infty} + S_v\\,\\sqrt{m} + B_v\\,m,$$\n   本问题使用以下常数：\n   - $V_{\\phi}^{\\infty} = 16.62\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}$，\n   - $S_v = 1.50\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}\\ (\\mathrm{mol}\\ \\mathrm{kg}^{-1})^{-1/2}$，\n   - $B_v = 0.10\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}\\ (\\mathrm{mol}\\ \\mathrm{kg}^{-1})^{-1}$。\n4. 在 $T=298.15\\ \\mathrm{K}$ 和 $P=1\\ \\mathrm{atm}$ 条件下，纯液态水的摩尔体积在此处考虑的小浓度范围内近似为常数。使用\n   $$\\bar{v}_w^{0} = 18.069\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}.$$\n5. 水的摩尔质量为\n   $$M_w = 18.01528\\ \\mathrm{g}\\ \\mathrm{mol}^{-1}.$$\n6. 氯化钠的质量摩尔浓度 $m$ 定义为\n   $$m = \\frac{n_s}{m_{\\mathrm{solvent}}\\ (\\mathrm{kg})} = \\frac{n_s}{n_w M_w/1000},$$\n   其中 $n_s$ 是氯化钠的物质的量（单位为摩尔），$n_w$ 是水的物质的量（单位为摩尔），$M_w$ 是水的摩尔质量（单位为 $\\mathrm{g}\\ \\mathrm{mol}^{-1}$）。\n\n假设与模型封闭条件：\n- 将水视为溶剂，氯化钠视为溶质（电解质）。\n- 在考虑的浓度范围内，将 $\\bar{v}_w$ 近似处理为与在所述 $T$ 和 $P$ 下纯水的摩尔体积 $\\bar{v}_w^{0}$ 相等。\n- 在所述 $T$ 和 $P$ 下，使用提供给 $V_{\\phi}(m)$ 的经验模型。\n- 关注相对于纯水的系统体积变化，定义为\n  $$\\Delta V = V_{\\mathrm{solution}} - V_{\\mathrm{pure\\ water}},$$\n  其中 $V_{\\mathrm{pure\\ water}}$ 是 $n_w$ 摩尔纯水在 $T=298.15\\ \\mathrm{K}$ 和 $P=1\\ \\mathrm{atm}$ 下的体积。将 $\\Delta V$ 以立方厘米 $\\mathrm{(cm}^3)$ 为单位表示。\n\n任务：\n1. 使用上述基本定义，在所述假设下，推导 $\\Delta V$ 关于 $n_w$, $n_s$, $M_w$, 和 $V_{\\phi}(m)$ 的表达式。您的推导必须从偏摩尔体积和质量摩尔浓度的定义开始，并且不得先验地假设 $\\Delta V$ 的最终表达式。\n2. 实现一个程序，该程序：\n   - 使用给定的 $M_w$ 从 $(n_w,n_s)$ 计算质量摩尔浓度 $m$。\n   - 根据给定的 Masson 型关系计算 $V_{\\phi}(m)$。\n   - 计算体积变化 $\\Delta V$ (单位为 $\\mathrm{cm}^3$)。\n   - 将每个 $\\Delta V$ 四舍五入到三位小数。\n3. 使用以下 $(n_w,n_s)$ 数对（所有 $n$ 的单位均为摩尔）的测试用例来评估您的实现。所有氯化钠浓度都选择在 $T=298.15\\ \\mathrm{K}$ 下物理上现实的溶解度极限内：\n   - 测试 1 (边界, 无溶质): $(n_w,n_s) = (55.5, 0.0)$,\n   - 测试 2 (稀溶液): $(n_w,n_s) = (55.5, 0.1)$,\n   - 测试 3 (中等浓度): $(n_w,n_s) = (55.5, 1.0)$,\n   - 测试 4 (比例检查): $(n_w,n_s) = (111.0, 2.0)$,\n   - 测试 5 (浓溶液但低于典型溶解度极限): $(n_w,n_s) = (18.0, 1.8)$。\n4. 输出说明：\n   - 您的程序必须生成单行输出，其中包含一个由逗号分隔的浮点数列表，该列表用方括号括起来，并按上述顺序排列，例如，\n     $$\\texttt{[result1,result2,result3,result4,result5]}.$$\n   - 每个结果都必须是以 $\\mathrm{cm}^3$ 为单位的 $\\Delta V$，并四舍五入到三位小数。\n\n您的最终交付成果是一个单一、完整、可运行的程序，该程序完全按照规定执行上述计算，并以所需格式打印五个结果的列表。不允许用户输入，也不得读取或写入任何文件。", "solution": "对问题陈述进行验证。\n\n**1. 提取已知条件：**\n- 系综：恒定温度 $T=298.15\\ \\mathrm{K}$ 和压力 $P=1\\ \\mathrm{atm}$ (NPT)。\n- 体积微分: $dV = \\sum_i \\bar{v}_i\\,dn_i$。\n- 偏摩尔体积: $\\bar{v}_i = \\left(\\frac{\\partial V}{\\partial n_i}\\right)_{T,P,\\{n_{j\\neq i}\\}}$。\n- NaCl的表观摩尔体积, $V_{\\phi}(m)$: $V_{\\phi}(m) = V_{\\phi}^{\\infty} + S_v\\,\\sqrt{m} + B_v\\,m$。\n- $V_{\\phi}(m)$ 的常数:\n  - $V_{\\phi}^{\\infty} = 16.62\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}$\n  - $S_v = 1.50\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}\\ (\\mathrm{mol}\\ \\mathrm{kg}^{-1})^{-1/2}$\n  - $B_v = 0.10\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}\\ (\\mathrm{mol}\\ \\mathrm{kg}^{-1})^{-1}$\n- 纯水的摩尔体积: $\\bar{v}_w^{0} = 18.069\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}$。\n- 水的摩尔质量: $M_w = 18.01528\\ \\mathrm{g}\\ \\mathrm{mol}^{-1}$。\n- 质量摩尔浓度的定义: $m = \\frac{n_s}{n_w M_w/1000}$，其中 $n_s$ 是盐的摩尔数，$n_w$ 是水的摩尔数。\n- 假设：溶液中水的偏摩尔体积 $\\bar{v}_w$ 近似为常数，$\\bar{v}_w \\approx \\bar{v}_w^{0}$。\n- 目标量: $\\Delta V = V_{\\mathrm{solution}} - V_{\\mathrm{pure\\ water}}$，其中 $V_{\\mathrm{pure\\ water}} = n_w \\bar{v}_w^{0}$。\n\n**2. 验证：**\n- **科学依据**：该问题在化学热力学原理方面有充分的根据。偏摩尔体积和表观摩尔体积的概念、Masson 经验关系和 NPT 系综是物理化学中的标准概念。\n- **良定性**：该问题提供了所有必要的数据、常数和明确的目标。可以推导出唯一的解。\n- **客观性**：该问题以精确、客观的语言陈述。\n- **一致性**：该问题包含一个明确的假设，即 $\\bar{v}_w \\approx \\bar{v}_w^0$。根据 Gibbs-Duhem 方程以及所提供的 $V_\\phi(m)$ 函数形式，可以证明 $\\bar{v}_w$ 并非严格恒定，而是与 $\\bar{v}_w^0$ 有微小偏差（对于 $1\\ \\mathrm{molal}$ 的溶液，偏差小于 $0.1\\%$）。因此，该陈述并非逻辑矛盾，而是一种物理上合理的近似，这在建立简化模型时很常见。该问题在所述近似下是内部一致的。\n\n**3. 结论：**\n该问题被判定为 **有效**。这是一个化学热力学中的标准可解问题。\n\n**体积变化 $\\Delta V$ 的表达式推导**\n\n目标是在恒定温度 $T$ 和压力 $P$ 下，将 $n_s$ 摩尔溶质（氯化钠）添加到 $n_w$ 摩尔溶剂（水）中时，推导体积变化 $\\Delta V$ 的表达式。\n\n初始状态是纯水，其体积为 $V_{\\mathrm{pure\\ water}} = n_w \\bar{v}_w^0$。最终状态是体积为 $V_{\\mathrm{solution}}$ 的溶液。体积变化定义为 $\\Delta V = V_{\\mathrm{solution}} - V_{\\mathrm{pure\\ water}}$。\n\n我们可以通过从 $n_w$ 摩尔纯水开始，将溶质从 $0$ 摩尔增量添加到 $n_s$ 摩尔来概念化溶液的形成过程。在此过程中的任何时刻，当在恒定的 $n_w$ 下加入无穷小量的溶质 $dn_s'$ 时，总体积 $V$ 的变化由偏摩尔性质的基本关系给出：\n$$dV = \\bar{v}_s(n_w, n_s') \\, dn_s'$$\n其中 $\\bar{v}_s(n_w, n_s')$ 是在组成为 $(n_w, n_s')$ 时溶质的偏摩尔体积。\n\n总体积变化 $\\Delta V$ 是在整个添加过程中对该微分变化进行积分，从 $n_s' = 0$ 到 $n_s' = n_s$：\n$$\\Delta V = V_{\\mathrm{solution}} - V_{\\mathrm{pure\\ water}} = \\int_{0}^{n_s} \\bar{v}_s(n_w, n_s') \\, dn_s'$$\n为了计算该积分，需要一个 $\\bar{v}_s$ 作为组成函数的显式表达式。这可以从所提供的表观摩尔体积 $V_{\\phi}$ 的经验模型中推导出来。\n\n溶质的表观摩尔体积 $V_{\\phi}$ 的标准定义将溶液的总体积 $V$ 与纯溶剂的体积联系起来：\n$$V_{\\phi} \\equiv \\frac{V - n_w \\bar{v}_w^0}{n_s}$$\n这个定义可以重排以表示溶液的总体积：\n$$V = n_w \\bar{v}_w^0 + n_s V_{\\phi}$$\n$V$ 的这个表达式与问题中 $\\bar{v}_w \\approx \\bar{v}_w^0$ 的假设是一致的，这可以通过对齐次函数应用欧拉定理来证明。\n\n根据定义，溶质的偏摩尔体积 $\\bar{v}_s$ 为：\n$$\\bar{v}_s = \\left(\\frac{\\partial V}{\\partial n_s}\\right)_{T, P, n_w}$$\n用 $V_{\\phi}$ 的表达式代入 $V$：\n$$\\bar{v}_s = \\left(\\frac{\\partial}{\\partial n_s} (n_w \\bar{v}_w^0 + n_s V_{\\phi})\\right)_{n_w} = V_{\\phi} + n_s \\left(\\frac{\\partial V_{\\phi}}{\\partial n_s}\\right)_{n_w}$$\n给定的模型将 $V_{\\phi}$ 表示为质量摩尔浓度 $m$ 的函数。因此，我们必须使用链式法则。质量摩尔浓度 $m$ 定义为 $m = n_s / (n_w M_w / 1000)$。\n$$\\left(\\frac{\\partial V_{\\phi}}{\\partial n_s}\\right)_{n_w} = \\frac{dV_{\\phi}}{dm} \\frac{\\partial m}{\\partial n_s} = \\frac{dV_{\\phi}}{dm} \\left( \\frac{1}{n_w M_w / 1000} \\right) = \\frac{dV_{\\phi}}{dm} \\frac{m}{n_s}$$\n将此代入 $\\bar{v}_s$ 的表达式中：\n$$\\bar{v}_s = V_{\\phi} + n_s \\left(\\frac{dV_{\\phi}}{dm} \\frac{m}{n_s}\\right) = V_{\\phi} + m \\frac{dV_{\\phi}}{dm}$$\n经验性的 Masson 型关系为 $V_{\\phi}(m) = V_{\\phi}^{\\infty} + S_v \\sqrt{m} + B_v m$。其导数为：\n$$\\frac{dV_{\\phi}}{dm} = \\frac{1}{2} S_v m^{-1/2} + B_v$$\n因此，溶质的偏摩尔体积为：\n$$\\bar{v}_s = (V_{\\phi}^{\\infty} + S_v m^{1/2} + B_v m) + m \\left(\\frac{1}{2} S_v m^{-1/2} + B_v\\right)$$\n$$\\bar{v}_s = V_{\\phi}^{\\infty} + \\frac{3}{2} S_v m^{1/2} + 2 B_v m$$\n现在，我们将这个 $\\bar{v}_s$ 的表达式代入 $\\Delta V$ 的积分中。将积分变量从溶质的摩尔数 $n_s'$ 更改为质量摩尔浓度 $m'$ 会很方便。设 $C = n_w M_w / 1000$。则 $n_s' = C m'$ 且 $dn_s' = C dm'$。积分限变为从 $m'=0$到 $m' = m = n_s / C$。\n$$\\Delta V = \\int_0^{m} \\left( V_{\\phi}^{\\infty} + \\frac{3}{2} S_v \\sqrt{m'} + 2 B_v m' \\right) (C \\, dm')$$\n$$\\Delta V = C \\left[ V_{\\phi}^{\\infty} m' + S_v m'^{3/2} + B_v m'^2 \\right]_0^m$$\n$$\\Delta V = C \\left( V_{\\phi}^{\\infty} m + S_v m^{3/2} + B_v m^2 \\right)$$\n将 $C=n_s/m$ 代回：\n$$\\Delta V = \\frac{n_s}{m} \\left( V_{\\phi}^{\\infty} m + S_v m^{3/2} + B_v m^2 \\right)$$\n$$\\Delta V = n_s \\left( V_{\\phi}^{\\infty} + S_v m^{1/2} + B_v m \\right)$$\n认识到括号中的表达式是 $V_{\\phi}(m)$ 的定义，我们得到最终的简单结果：\n$$\\Delta V = n_s V_{\\phi}(m)$$\n这个从偏摩尔体积的基本定义出发，通过严格积分进行的推导，验证了通常被作为起点的更简单的关系。\n\n**数值实现**\n\n对每个给定的数对 $(n_w, n_s)$ 计算 $\\Delta V$ 的算法如下：\n1. 对于每个测试用例 $(n_w, n_s)$，首先检查 $n_s = 0$ 的平凡情况。如果是，则 $\\Delta V = 0$。\n2. 如果 $n_s > 0$，计算溶剂（水）的质量（单位为千克）：$m_{\\mathrm{water, kg}} = n_w \\cdot M_w / 1000$。\n3. 计算溶液的质量摩尔浓度：$m = n_s / m_{\\mathrm{water, kg}}$。\n4. 使用给定的 Masson 型关系和常数计算表观摩尔体积 $V_{\\phi}(m)$：$V_{\\phi}(m) = V_{\\phi}^{\\infty} + S_v\\,\\sqrt{m} + B_v\\,m$。\n5. 使用推导出的表达式计算总体积变化：$\\Delta V = n_s \\cdot V_{\\phi}(m)$。\n6. 每个测试用例的结果被存储，然后格式化为三位小数以用于最终输出。\n\n将对所有提供的测试用例实施此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the change in system volume upon adding sodium chloride to water,\n    based on the principles of the isothermal-isobaric (NPT) ensemble and\n    an empirical model for apparent molar volume.\n    \"\"\"\n\n    # --- Constants provided in the problem statement ---\n\n    # Apparent molar volume (V_phi) constants for NaCl in water at 298.15 K, 1 atm\n    # V_phi(m) = V_phi_inf + S_v * sqrt(m) + B_v * m\n    V_PHI_INF = 16.62  # cm^3 mol^-1\n    S_V = 1.50         # cm^3 mol^-1 (mol kg^-1)^(-1/2)\n    B_V = 0.10         # cm^3 mol^-1 (mol kg^-1)^(-1)\n\n    # Molar mass of water (H2O)\n    M_W = 18.01528     # g mol^-1\n\n    # --- Test cases ---\n    # Each tuple represents (n_w, n_s) where n are amounts in moles.\n    test_cases = [\n        (55.5, 0.0),   # Test 1 (boundary, no solute)\n        (55.5, 0.1),   # Test 2 (dilute)\n        (55.5, 1.0),   # Test 3 (moderate)\n        (111.0, 2.0),  # Test 4 (scaling check)\n        (18.0, 1.8),   # Test 5 (concentrated)\n    ]\n\n    results = []\n    for n_w, n_s in test_cases:\n        # According to the derivation, Delta_V = n_s * V_phi(m).\n        # If n_s is 0, Delta_V is trivially 0.\n        if n_s == 0.0:\n            delta_v = 0.0\n        else:\n            # Step 1: Calculate the mass of the solvent (water) in kg.\n            # The factor 1000 converts grams to kilograms.\n            mass_water_kg = n_w * M_W / 1000.0\n\n            # Step 2: Calculate the molality (m) of the NaCl solution.\n            # m = moles of solute / kg of solvent\n            molality = n_s / mass_water_kg\n\n            # Step 3: Calculate the apparent molar volume (V_phi) at this molality.\n            v_phi = V_PHI_INF + S_V * np.sqrt(molality) + B_V * molality\n            \n            # Step 4: Calculate the volume change (Delta_V).\n            # The derived expression is Delta_V = n_s * V_phi.\n            delta_v = n_s * v_phi\n\n        results.append(delta_v)\n\n    # Final print statement in the exact required format.\n    # Each result is formatted to three decimal places.\n    print(f\"[{','.join([f'{r:.3f}' for r in results])}]\")\n\nsolve()\n```", "id": "2464863"}]}