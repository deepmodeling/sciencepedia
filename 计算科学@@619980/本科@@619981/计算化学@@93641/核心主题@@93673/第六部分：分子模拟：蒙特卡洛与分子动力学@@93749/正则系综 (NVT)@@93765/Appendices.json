{"hands_on_practices": [{"introduction": "在深入研究复杂的计算模型之前，让我们先回到第一性原理。这个练习将引导你通过一个简明的晶格模型，手动计算其配分函数 $Q$，并由此推导出系统的内能 $U$ 和热容 $C_V$ 等宏观热力学性质。这项基础实践旨在强化对配分函数作为连接微观态与宏观属性桥梁的核心作用的理解。[@problem_id:2463790]", "problem": "考虑一个模型二维方格晶格，由 $2 \\times 2$ 个吸附格点（总共四个格点）组成，处于绝对温度为 $T$ 的正则系综（粒子数、体积和温度恒定；NVT系综）中。每个格点上有一个独立的、无相互作用的分子转子，它可以采取两种构象状态之一：\n\n- 能量为 $0$ 的基态，具有双重取向简并度。\n- 能量为 $\\varepsilon \\gt 0$ 的激发态，简并度为1。\n\n不同格点之间没有相互作用，且晶格体积固定。令 $k_B$ 表示玻尔兹曼常数。仅使用正则系综的第一性原理，计算四格点晶格的正则配分函数 $Q(T)$，然后推导其内能 $U(T)$ 和定容热容 $C_V(T)$。所有表达式均需以闭合形式给出。\n\n答案报告要求：仅报告 $C_V(T)$ 关于 $k_B$、$\\varepsilon$ 和 $T$ 的最终闭合形式解析表达式作为最终答案。最终报告的表达式中不应包含单位。请勿四舍五入或近似计算。", "solution": "所述问题在科学上是合理的、提法得当、客观且自洽的。它是在正则系综中应用于离散系统的统计力学的一个标准练习。所有必要的参数都已给出，不存在矛盾或模糊之处。因此，我将开始解答。\n\n该系统由位于固定晶格上的 $N=4$ 个独立的、无相互作用的、可分辨的分子转子组成。这样一个系统的总配分函数 $Q(T)$ 是单粒子配分函数 $q(T)$ 的乘积：\n$$Q(T) = [q(T)]^N$$\n这里，$N=4$。\n\n第一步是计算单粒子配分函数 $q(T)$。单个转子的配分函数是其所有可用状态的总和，并由玻尔兹曼因子 $\\exp(-E_i / (k_B T))$ 加权，其中 $E_i$ 是状态 $i$ 的能量，$g_i$ 是其简并度。\n$$q(T) = \\sum_{i} g_i \\exp\\left(-\\frac{E_i}{k_B T}\\right)$$\n问题为每个转子提供了两个能级：\n1.  基态：能量 $E_0 = 0$，简并度 $g_0 = 2$。\n2.  激发态：能量 $E_1 = \\varepsilon$，简并度 $g_1 = 1$。\n\n将这些值代入 $q(T)$ 的表达式中：\n$$q(T) = g_0 \\exp\\left(-\\frac{E_0}{k_B T}\\right) + g_1 \\exp\\left(-\\frac{E_1}{k_B T}\\right)$$\n$$q(T) = 2 \\cdot \\exp\\left(-\\frac{0}{k_B T}\\right) + 1 \\cdot \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)$$\n$$q(T) = 2 \\cdot 1 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right) = 2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)$$\n\n现在，我们可以写出 $N=4$ 个转子的总正则配分函数：\n$$Q(T) = [q(T)]^4 = \\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^4$$\n\n下一步是推导系统的内能 $U(T)$。在正则系综中，内能通过以下公式与配分函数相关联：\n$$U(T) = k_B T^2 \\frac{\\partial \\ln Q(T)}{\\partial T}$$\n让我们先求出 $\\ln Q(T)$：\n$$\\ln Q(T) = \\ln\\left[\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^4\\right] = 4 \\ln\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)$$\n为了简化微分，使用变量 $\\beta = \\frac{1}{k_B T}$ 会很方便。内能的表达式变为 $U(\\beta) = -\\frac{\\partial \\ln Q(\\beta)}{\\partial \\beta}$。\n$$\\ln Q(\\beta) = 4 \\ln\\left(2 + \\exp(-\\varepsilon\\beta)\\right)$$\n对 $\\beta$ 求导：\n$$U(\\beta) = -\\frac{\\partial}{\\partial \\beta} \\left[4 \\ln\\left(2 + \\exp(-\\varepsilon\\beta)\\right)\\right]$$\n$$U(\\beta) = -4 \\cdot \\frac{1}{2 + \\exp(-\\varepsilon\\beta)} \\cdot \\frac{\\partial}{\\partial \\beta}\\left(2 + \\exp(-\\varepsilon\\beta)\\right)$$\n$$U(\\beta) = -4 \\cdot \\frac{1}{2 + \\exp(-\\varepsilon\\beta)} \\cdot \\left(-\\varepsilon \\exp(-\\varepsilon\\beta)\\right)$$\n$$U(\\beta) = \\frac{4\\varepsilon \\exp(-\\varepsilon\\beta)}{2 + \\exp(-\\varepsilon\\beta)}$$\n将 $\\beta = \\frac{1}{k_B T}$ 代回，我们得到作为温度函数的内能：\n$$U(T) = \\frac{4\\varepsilon \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}{2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}$$\n\n最后，我们推导定容热容 $C_V(T)$。其定义为内能在定容条件下对温度的偏导数：\n$$C_V(T) = \\left(\\frac{\\partial U}{\\partial T}\\right)_V$$\n再次使用 $\\beta$ 会更直接。它们的关系是 $C_V = \\frac{\\partial U}{\\partial T} = \\frac{\\partial U}{\\partial \\beta} \\frac{\\partial \\beta}{\\partial T}$。由于 $\\beta = \\frac{1}{k_B T}$，我们有 $\\frac{\\partial \\beta}{\\partial T} = -\\frac{1}{k_B T^2}$。\n因此，$C_V = -\\frac{1}{k_B T^2} \\frac{\\partial U}{\\partial \\beta}$。我们必须对 $U(\\beta)$ 关于 $\\beta$ 求导：\n$$\\frac{\\partial U}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta} \\left(\\frac{4\\varepsilon \\exp(-\\varepsilon\\beta)}{2 + \\exp(-\\varepsilon\\beta)}\\right)$$\n使用商法则求导，$\\frac{d}{dx}\\left(\\frac{f}{g}\\right) = \\frac{f'g-fg'}{g^2}$，其中 $f(\\beta) = 4\\varepsilon \\exp(-\\varepsilon\\beta)$ 且 $g(\\beta) = 2 + \\exp(-\\varepsilon\\beta)$：\n$$f'(\\beta) = -4\\varepsilon^2 \\exp(-\\varepsilon\\beta)$$\n$$g'(\\beta) = -\\varepsilon \\exp(-\\varepsilon\\beta)$$\n$$\\frac{\\partial U}{\\partial \\beta} = \\frac{(-4\\varepsilon^2 \\exp(-\\varepsilon\\beta))(2 + \\exp(-\\varepsilon\\beta)) - (4\\varepsilon \\exp(-\\varepsilon\\beta))(-\\varepsilon \\exp(-\\varepsilon\\beta))}{(2 + \\exp(-\\varepsilon\\beta))^2}$$\n展开分子部分：\n$$\\frac{\\partial U}{\\partial \\beta} = \\frac{-8\\varepsilon^2 \\exp(-\\varepsilon\\beta) - 4\\varepsilon^2 \\exp(-2\\varepsilon\\beta) + 4\\varepsilon^2 \\exp(-2\\varepsilon\\beta)}{(2 + \\exp(-\\varepsilon\\beta))^2}$$\n$$\\frac{\\partial U}{\\partial \\beta} = \\frac{-8\\varepsilon^2 \\exp(-\\varepsilon\\beta)}{(2 + \\exp(-\\varepsilon\\beta))^2}$$\n现在，我们将其代回 $C_V$ 的表达式中：\n$$C_V(T) = -\\frac{1}{k_B T^2} \\left(\\frac{-8\\varepsilon^2 \\exp(-\\varepsilon\\beta)}{(2 + \\exp(-\\varepsilon\\beta))^2}\\right)$$\n$$C_V(T) = \\frac{8\\varepsilon^2}{k_B T^2} \\frac{\\exp(-\\varepsilon\\beta)}{(2 + \\exp(-\\varepsilon\\beta))^2}$$\n将 $\\beta$ 替换为 $\\frac{1}{k_B T}$ 得到定容热容的最终表达式：\n$$C_V(T) = \\frac{8\\varepsilon^2}{k_B T^2} \\frac{\\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}{\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^2}$$\n为了记法上的偏好，此表达式可以重排，例如：\n$$C_V(T) = 8 k_B \\left(\\frac{\\varepsilon}{k_B T}\\right)^2 \\frac{\\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}{\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^2}$$\n第一个推导出的形式是充分且完整的。", "answer": "$$\\boxed{\\frac{8 \\varepsilon^{2}}{k_B T^{2}} \\frac{\\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}{\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^{2}}}$$", "id": "2463790"}, {"introduction": "理论知识的真正力量在于其应用。在本实践中，我们将从解析计算转向计算实现，通过编写程序来模拟丙氨酸二肽这一重要生物分子的构象平衡。你将学习如何在一个离散化的构象空间（由 $\\phi$ 和 $\\psi$ 二面角定义）上，数值化地计算正则配分函数，并量化不同环境（如真空与水溶液）对分子构象偏好的影响，从而直观地理解溶剂化效应。[@problem_id:2463736]", "problem": "您需要为投影到拉马钱德兰扭转角上的丙氨酸二肽构象平衡构建一个完全指定的正则系综模型，并计算在真空与类水条件下两个盆地（α 和 β）的正则盆地布居数。您必须实现一个完整、可运行的程序，该程序在扭转角上评估离散的正则（恒定粒子数、恒定体积、恒定温度）系综，并报告盆地概率。所有数学定义如下所示；您必须严格按照给定的定义使用，并以指定的单位表示所有物理量。\n\n模型设置。考虑在二维环面 $[-180^{\\circ},180^{\\circ}) \\times [-180^{\\circ},180^{\\circ})$ 上定义的扭转角 $\\phi$ 和 $\\psi$。将基础势能面 $V_{\\text{base}}(\\phi,\\psi)$ 定义为（单位：千焦/摩尔）：\n$$\nV_{\\text{base}}(\\phi,\\psi) = V_a \\left[1 - \\cos\\!\\left(3(\\phi+60^{\\circ})\\right)\\right] + V_b \\left[1 - \\cos\\!\\left(3(\\psi+45^{\\circ})\\right)\\right] + V_c \\left[1 + \\cos\\!\\left(\\phi - \\psi\\right)\\right],\n$$\n其中所有三角函数参数的单位均为度，且 $V_a$、$V_b$、$V_c$ 是单位为千焦/摩尔的常数。\n\n将溶剂效应建模为通过环面-高斯项实现的对 α 盆地的局部稳定化和对 β 盆地的局部惩罚。设 α 盆地中心为 $(\\phi_\\alpha,\\psi_\\alpha) = (-60^{\\circ},-45^{\\circ})$，β 盆地中心为 $(\\phi_\\beta,\\psi_\\beta) = (-135^{\\circ},135^{\\circ})$。将 $(\\phi,\\psi)$ 和 $(\\phi_0,\\psi_0)$ 之间的环面距离平方定义为\n$$\nd^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_0,\\psi_0)) = \\Delta(\\phi,\\phi_0)^2 + \\Delta(\\psi,\\psi_0)^2,\n$$\n其中回绕角差 $\\Delta(\\theta,\\theta_0)$（单位为度）由下式给出：\n$$\n\\Delta(\\theta,\\theta_0) = \\operatorname{wrap}_{(-180^{\\circ},180^{\\circ}]}\\!\\left(\\theta - \\theta_0\\right), \\quad \\text{其中 } \\operatorname{wrap}_{(-180^{\\circ},180^{\\circ}]}\\!(x) = x - 360^{\\circ}\\,\\left\\lfloor \\frac{x + 180^{\\circ}}{360^{\\circ}} \\right\\rfloor.\n$$\n设 $\\sigma$ 为宽度（单位为度），$s_\\alpha$ 为 α 的稳定化振幅（单位为千焦/摩尔），$s_\\beta$ 为 β 的惩罚振幅（单位为千焦/摩尔）。溶剂贡献为\n$$\nV_{\\text{solv}}(\\phi,\\psi) = - s_\\alpha \\exp\\!\\left(-\\frac{d^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_\\alpha,\\psi_\\alpha))}{2\\sigma^2}\\right) + s_\\beta \\exp\\!\\left(-\\frac{d^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_\\beta,\\psi_\\beta))}{2\\sigma^2}\\right).\n$$\n总势能为 $V(\\phi,\\psi) = V_{\\text{base}}(\\phi,\\psi) + V_{\\text{solv}}(\\phi,\\psi)$，单位为千焦/摩尔。\n\n正则系综。对于给定的绝对温度 T（单位为开尔文），Boltzmann 常数 $k_{\\mathrm{B}} = 0.008314462618\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，定义 $\\beta = 1/(k_{\\mathrm{B}} T)$。在 $(\\phi,\\psi)$ 处的正则权重为 $w(\\phi,\\psi) = \\exp(-\\beta V(\\phi,\\psi))$。\n\n离散化。在 $[-180^{\\circ},180^{\\circ})$ 的每个维度上使用间距为 $\\Delta = 2^{\\circ}$ 的均匀角度网格。离散配分函数为\n$$\nZ = \\sum_{\\phi}\\sum_{\\psi} \\exp\\!\\left(-\\beta V(\\phi,\\psi)\\right),\n$$\n其中求和遍及所有网格点，概率通过 Z 进行归一化定义。设 α 盆地窗口为以 $(\\phi_\\alpha,\\psi_\\alpha)$ 为中心、在每个角维度上半宽为 $w = 30^{\\circ}$ 的环面矩形，即集合 ${(\\phi,\\psi)}$ 满足 $|\\Delta(\\phi,\\phi_\\alpha)| \\le w$ 和 $|\\Delta(\\psi,\\psi_\\alpha)| \\le w$。类似地，以 $(\\phi_\\beta,\\psi_\\beta)$ 为中心，使用相同的半宽 $w$ 定义 β 盆地窗口。需要报告的正则概率是\n$$\nP_\\alpha = \\frac{1}{Z}\\sum_{(\\phi,\\psi)\\in \\text{alpha window}} \\exp\\!\\left(-\\beta V(\\phi,\\psi)\\right), \\quad\nP_\\beta = \\frac{1}{Z}\\sum_{(\\phi,\\psi)\\in \\text{beta window}} \\exp\\!\\left(-\\beta V(\\phi,\\psi)\\right).\n$$\n将概率报告为无量纲的小数。\n\n常数。严格按照所给值使用 $V_a = 4\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$、$V_b = 3\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$、$V_c = 1\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$、$\\sigma = 25^{\\circ}$、$w = 30^{\\circ}$ 和 $\\Delta = 2^{\\circ}$。\n\n测试组。您的程序必须评估以下四组参数，每组指定为 $(T,\\ s_\\alpha,\\ s_\\beta)$：\n- 情况 1（真空，中等温度）：$(T=\\ 300,\\ s_\\alpha=\\ 0,\\ s_\\beta=\\ 0)$，其中 T 单位为开尔文，$s_\\alpha,s_\\beta$ 单位为千焦/摩尔。\n- 情况 2（类水，中等温度）：$(T=\\ 300,\\ s_\\alpha=\\ 5,\\ s_\\beta=\\ 2)$。\n- 情况 3（类水，高温）：$(T=\\ 600,\\ s_\\alpha=\\ 5,\\ s_\\beta=\\ 2)$。\n- 情况 4（真空，低温）：$(T=\\ 100,\\ s_\\alpha=\\ 0,\\ s_\\beta=\\ 0)$。\n\n必需输出。对于每个测试用例，计算并返回一个双元素列表 $[P_\\alpha, P_\\beta]$，两个条目均四舍五入到恰好六位小数。按相同顺序将四个案例的结果汇总到一个列表中。您的程序应产生单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，其中每个元素本身是一个双元素列表，例如 \"[[0.123456,0.234567],[...],...]\"，不含任何额外文本。\n\n角度单位要求。模型中所有角度的单位均为度。所有三角函数都应按上文定义，其参数单位为度。\n\n物理单位。能量单位必须是千焦/摩尔，温度单位为开尔文，Boltzmann 常数的单位为千焦/摩尔/开尔文。将最终概率表示为无量纲小数，并四舍五入到六位小数。", "solution": "我们被要求在正则（恒定粒子数、恒定体积、恒定温度）系综中，针对丙氨酸二肽的扭转角，在一个指定的势能函数下，计算其在真空和有类溶剂扰动两种情况下的正则概率。正则系综分配一个与 Boltzmann 因子 $\\exp(-\\beta V)$ 成正比的权重，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$V$ 是势能。\n\n首先，我们将扭转角域形式化为一个二维环面 $[-180^{\\circ},180^{\\circ}) \\times [-180^{\\circ},180^{\\circ})$，并对 $\\phi$ 和 $\\psi$ 使用间距为 $\\Delta = 2^{\\circ}$ 的均匀离散网格。这种离散化将配分函数和概率呈现为有限和，从而确保数值评估在不同实现中是明确且一致的。\n\n基础势能定义为\n$$\nV_{\\text{base}}(\\phi,\\psi) = V_a \\left[1 - \\cos\\!\\left(3(\\phi+60^{\\circ})\\right)\\right] + V_b \\left[1 - \\cos\\!\\left(3(\\psi+45^{\\circ})\\right)\\right] + V_c \\left[1 + \\cos\\!\\left(\\phi - \\psi\\right)\\right],\n$$\n其中 $V_a = 4\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，$V_b = 3\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，$V_c = 1\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。三角函数的参数单位是度；在数值上，调用标准库函数时可以将度转换为弧度，但在数学上，定义是固定的。\n\n溶剂扰动通过环面-高斯项建模，这些项可以稳定或去稳定特定区域：\n$$\nV_{\\text{solv}}(\\phi,\\psi) = - s_\\alpha \\exp\\!\\left(-\\frac{d^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_\\alpha,\\psi_\\alpha))}{2\\sigma^2}\\right) + s_\\beta \\exp\\!\\left(-\\frac{d^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_\\beta,\\psi_\\beta))}{2\\sigma^2}\\right),\n$$\n其中 $(\\phi_\\alpha,\\psi_\\alpha) = (-60^{\\circ},-45^{\\circ})$，$(\\phi_\\beta,\\psi_\\beta) = (-135^{\\circ},135^{\\circ})$，以及 $\\sigma = 25^{\\circ}$。环面距离的平方是\n$$\nd^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_0,\\psi_0)) = \\Delta(\\phi,\\phi_0)^2 + \\Delta(\\psi,\\psi_0)^2,\n$$\n其中回绕差 $\\Delta(\\theta,\\theta_0)$ 产生圆上的最小角差：\n$$\n\\Delta(\\theta,\\theta_0) = \\operatorname{wrap}_{(-180^{\\circ},180^{\\circ}]}\\!\\left(\\theta - \\theta_0\\right), \\quad \\operatorname{wrap}_{(-180^{\\circ},180^{\\circ}]}\\!(x) = x - 360^{\\circ}\\,\\left\\lfloor \\frac{x + 180^{\\circ}}{360^{\\circ}} \\right\\rfloor.\n$$\n总势能为 $V = V_{\\text{base}} + V_{\\text{solv}}$。\n\n对于给定的绝对温度 T 和 Boltzmann 常数 $k_{\\mathrm{B}} = 0.008314462618\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，我们计算 $\\beta = 1/(k_{\\mathrm{B}} T)$。每个网格点上的正则权重为 $w = \\exp(-\\beta V)$。离散配分函数是\n$$\nZ = \\sum_{\\phi}\\sum_{\\psi} w(\\phi,\\psi),\n$$\n网格点子集 $\\Omega$ 上的任何正则概率是\n$$\nP(\\Omega) = \\frac{1}{Z}\\sum_{(\\phi,\\psi)\\in \\Omega} w(\\phi,\\psi).\n$$\n\n我们将 α 窗口定义为以 $(-60^{\\circ},-45^{\\circ})$ 为中心，在每个维度上半宽为 $w = 30^{\\circ}$ 的环面矩形：\n$$\n\\Omega_\\alpha = \\left\\{(\\phi,\\psi) : |\\Delta(\\phi,-60^{\\circ})| \\le 30^{\\circ},\\ |\\Delta(\\psi,-45^{\\circ})| \\le 30^{\\circ}\\right\\}.\n$$\nβ 窗口类似地定义在 $(-135^{\\circ},135^{\\circ})$ 周围：\n$$\n\\Omega_\\beta = \\left\\{(\\phi,\\psi) : |\\Delta(\\phi,-135^{\\circ})| \\le 30^{\\circ},\\ |\\Delta(\\psi,135^{\\circ})| \\le 30^{\\circ}\\right\\}.\n$$\n所需的输出是 $P_\\alpha = P(\\Omega_\\alpha)$ 和 $P_\\beta = P(\\Omega_\\beta)$。\n\n然后我们为指定的测试组评估这些概率：\n- 情况 1：$(T=\\ 300,\\ s_\\alpha=\\ 0,\\ s_\\beta=\\ 0)$ 代表中等温度下的真空，在这种情况下，只有 $V_{\\text{base}}$ 决定分布的形态。\n- 情况 2：$(T=\\ 300,\\ s_\\alpha=\\ 5,\\ s_\\beta=\\ 2)$ 代表中等温度下的类水条件，在这种情况下，相对于真空，α 区域被稳定化，而 β 区域受到惩罚。\n- 情况 3：$(T=\\ 600,\\ s_\\alpha=\\ 5,\\ s_\\beta=\\ 2)$ 代表更高的温度，这会减少能量差异的影响，并倾向于使分布变得平坦，从而减小盆地之间的对比度。\n- 情况 4：$(T=\\ 100,\\ s_\\alpha=\\ 0,\\ s_\\beta=\\ 0)$ 代表低温下的真空，这强调了 $V_{\\text{base}}$ 的极小值，并使盆地布居数更加尖锐。\n\n从算法上讲，需要枚举网格点，计算 $V(\\phi,\\psi)$ 和 $w(\\phi,\\psi)$，形成 $Z$，通过回绕角差为 $\\Omega_\\alpha$ 和 $\\Omega_\\beta$ 构建指示掩码，并通过求和与归一化计算 $P_\\alpha$ 和 $P_\\beta$。每个案例的结果必须四舍五入到六位小数并按顺序返回。定性地讲，在固定温度下，引入类溶剂稳定化（$s_\\alpha > 0$ 和 $s_\\beta > 0$）会增加 $P_\\alpha$ 并减少 $P_\\beta$，而提高温度 T 会增加熵混合，并驱动两个盆地概率趋向于反映窗口相对几何尺寸而非能量偏好的值。在低温 T下，$P_\\alpha$ 和 $P_\\beta$ 反映了 $V_{\\text{base}}$ 的能量极小值结构，具有更强的对比度。\n\n最终的程序严格实现了这些定义，并打印一行包含四个双元素列表的列表，每个列表为 $[P_\\alpha, P_\\beta]$，均四舍五入到六位小数，并按照测试组指定的顺序排列。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef wrap_deg(x):\n    \"\"\"\n    Wrap angle(s) in degrees to the interval (-180, 180].\n    This returns a value such that boundaries are consistent on the torus.\n    \"\"\"\n    return x - 360.0 * np.floor((x + 180.0) / 360.0)\n\ndef torus_delta(a, b):\n    \"\"\"\n    Minimal wrapped difference between angles a and b (in degrees).\n    Works with numpy arrays or scalars.\n    \"\"\"\n    return np.abs(wrap_deg(a - b))\n\ndef build_potential(phi_deg, psi_deg, Va, Vb, Vc, s_alpha, s_beta, sigma_deg):\n    \"\"\"\n    Construct the total potential V(phi, psi) in kJ/mol on the 2D grid of angles (in degrees).\n    Trigonometric functions interpret arguments in degrees as per the problem statement.\n    \"\"\"\n    # Base torsional terms: convert degree arguments to radians for numpy trig.\n    # Using identities: cos(deg) -> cos(np.deg2rad(deg_argument))\n    term_phi = np.cos(np.deg2rad(3.0 * (phi_deg + 60.0)))\n    term_psi = np.cos(np.deg2rad(3.0 * (psi_deg + 45.0)))\n    term_cross = np.cos(np.deg2rad(phi_deg - psi_deg))\n    V_base = Va * (1.0 - term_phi) + Vb * (1.0 - term_psi) + Vc * (1.0 + term_cross)\n\n    # Solvent-like Gaussian stabilization/penalty on the torus\n    phi_alpha, psi_alpha = -60.0, -45.0\n    phi_beta, psi_beta = -135.0, 135.0\n    dphi_alpha = torus_delta(phi_deg, phi_alpha)\n    dpsi_alpha = torus_delta(psi_deg, psi_alpha)\n    d2_alpha = dphi_alpha**2 + dpsi_alpha**2\n\n    dphi_beta = torus_delta(phi_deg, phi_beta)\n    dpsi_beta = torus_delta(psi_deg, psi_beta)\n    d2_beta = dphi_beta**2 + dpsi_beta**2\n\n    # Gaussian terms\n    ga_alpha = np.exp(-d2_alpha / (2.0 * sigma_deg**2))\n    ga_beta = np.exp(-d2_beta / (2.0 * sigma_deg**2))\n    V_solv = -s_alpha * ga_alpha + s_beta * ga_beta\n\n    return V_base + V_solv\n\ndef basin_masks(phi_deg, psi_deg, w_half_deg):\n    \"\"\"\n    Construct boolean masks for alpha and beta rectangular windows on the torus.\n    \"\"\"\n    phi_alpha, psi_alpha = -60.0, -45.0\n    phi_beta, psi_beta = -135.0, 135.0\n    alpha_mask = (torus_delta(phi_deg, phi_alpha) <= w_half_deg) & (torus_delta(psi_deg, psi_alpha) <= w_half_deg)\n    beta_mask = (torus_delta(phi_deg, phi_beta) <= w_half_deg) & (torus_delta(psi_deg, psi_beta) <= w_half_deg)\n    return alpha_mask, beta_mask\n\ndef compute_probabilities(T, s_alpha, s_beta):\n    \"\"\"\n    Compute (P_alpha, P_beta) for given temperature T (K) and solvent parameters s_alpha, s_beta (kJ/mol).\n    \"\"\"\n    # Constants\n    kB = 0.008314462618  # kJ/mol/K\n    Va = 4.0  # kJ/mol\n    Vb = 3.0  # kJ/mol\n    Vc = 1.0  # kJ/mol\n    sigma_deg = 25.0  # degrees\n    w_half_deg = 30.0  # degrees\n    delta = 2.0  # degrees grid spacing\n\n    # Grid\n    angles = np.arange(-180.0, 180.0, delta)  # [-180, 180) degrees\n    phi_grid, psi_grid = np.meshgrid(angles, angles, indexing='ij')\n\n    # Potential and Boltzmann weights\n    V = build_potential(phi_grid, psi_grid, Va, Vb, Vc, s_alpha, s_beta, sigma_deg)\n    beta = 1.0 / (kB * T)\n    # For numerical stability, shift by min(V) before exponentiation; cancels in normalization\n    V_shift = V - np.min(V)\n    weights = np.exp(-beta * V_shift)\n\n    Z = np.sum(weights)\n\n    # Basin masks\n    alpha_mask, beta_mask = basin_masks(phi_grid, psi_grid, w_half_deg)\n\n    P_alpha = float(np.sum(weights[alpha_mask]) / Z)\n    P_beta = float(np.sum(weights[beta_mask]) / Z)\n    return P_alpha, P_beta\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (T in K, s_alpha in kJ/mol, s_beta in kJ/mol)\n    test_cases = [\n        (300.0, 0.0, 0.0),  # Case 1: vacuum, moderate T\n        (300.0, 5.0, 2.0),  # Case 2: water-like, moderate T\n        (600.0, 5.0, 2.0),  # Case 3: water-like, high T\n        (100.0, 0.0, 0.0),  # Case 4: vacuum, low T\n    ]\n\n    results = []\n    for T, s_alpha, s_beta in test_cases:\n        p_alpha, p_beta = compute_probabilities(T, s_alpha, s_beta)\n        # Round to exactly six decimal places per requirements\n        results.append([f\"{p_alpha:.6f}\", f\"{p_beta:.6f}\"])\n\n    # Final print statement in the exact required format: a single line\n    # Convert the inner strings to produce numeric-looking output without quotes\n    # Build the string manually to avoid quotes\n    out_elems = []\n    for pair in results:\n        out_elems.append(f\"[{pair[0]},{pair[1]}]\")\n    print(f\"[{','.join(out_elems)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2463736"}, {"introduction": "掌握了正则系综的经典应用后，一个优秀的科学家必须学会审视其模型的适用边界。本练习提出了一个基于计算化学模拟的思想实验，探讨了在低温下描述轻质粒子（如氢分子）时经典近似的局限性。通过分析热德布罗意波长与粒子间距的关系，你将从根本上理解为何核量子效应在这种情况下至关重要，以及忽略它会如何导致对物质相态的定性错误预测。[@problem_id:2463773]", "problem": "在一项关于低温条件下分子液氢的计算研究中，考虑在正则系综（粒子数、体积和温度恒定；NVT）中对相同系统进行的两次模拟。两个系统都包含 $N = 512$ 个刚性 $\\mathrm{H_2}$ 分子，它们通过相同的经验参数化对势相互作用。模拟在温度 $T = 20\\,\\mathrm{K}$ 和质量密度 $\\rho = 70\\,\\mathrm{kg\\,m^{-3}}$ 下进行，该密度是液氢在其正常沸点附近饱和时的特征密度。在模拟1中，原子核采用标准的分子动力学 (MD) 进行经典处理。在模拟2中，通过路径积分分子动力学 (PIMD) 包含了核量子效应 (NQE)，例如零点运动和量子离域。\n\n请从统计力学和分子运动的第一性原理出发，分析在这些条件下忽略NQE是否会定性地改变平衡结构和输运性质。你的分析应从正则系综的定义和热德布罗意波长的物理意义开始。你可以假设以下常数：普朗克常数 $h = 6.626\\times 10^{-34}\\,\\mathrm{J\\,s}$，玻尔兹曼常数 $k_\\mathrm{B} = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$，以及氢分子质量 $m \\approx 2\\,\\mathrm{amu} \\approx 3.32\\times 10^{-27}\\,\\mathrm{kg}$。衡量NQE重要性的一个有用指标是热德布罗意波长 $\\Lambda = h/\\sqrt{2\\pi m k_\\mathrm{B} T}$ 与特征分子间距 $a \\approx n^{-1/3}$ 的比值，其中数密度 $n = \\rho N_\\mathrm{A}/M$，摩尔质量 $M = 2.016\\times 10^{-3}\\,\\mathrm{kg\\,mol^{-1}}$，阿伏伽德罗常数 $N_\\mathrm{A} = 6.022\\times 10^{23}\\,\\mathrm{mol^{-1}}$。\n\n在 $T = 20\\,\\mathrm{K}$ 及固定的 $N$ 和 $V$ 下，下列哪种定性结果与你推导的基本原理最一致？\n\nA. 经典NVT模拟错误地预测了一个类固态的受阻态（例如，自扩散系数趋于零，径向分布函数 $g(r)$ 的第一峰非常尖锐且高），而PIMD模拟在相同的 $N$, $V$, $T$ 条件下保持为液态，其 $g(r)$ 峰展宽且自扩散系数为有限值。\n\nB. 两次模拟产生无法区分的平衡结构和输运性质，因为在固定的 $T$ 和 $V$ 下，正则系综中的玻尔兹曼权重仅取决于势能，而与粒子质量无关。\n\nC. PIMD模拟比经典模拟表现出更低的自扩散系数和更高的 $g(r)$ 第一峰，因为零点运动将分子更深地束缚在势阱中。\n\nD. 两次模拟的静态结构 $g(r)$ 相同，但PIMD模拟显示出更高的动能，而输运系数保持不变，因为在NVT系综中，NQE只影响动量而不影响位置。", "solution": "用户提供了一个来自计算化学领域的问题，具体涉及在正则（NVT）系综中对分子液氢的模拟。任务是验证问题陈述的有效性，如果有效，则确定包含核量子效应（NQE）的路径积分分子动力学（PIMD）模拟与经典分子动力学（MD）模拟之间最可能的定性差异。\n\n### 步骤 1：提取已知条件\n\n-   系综：正则系综 (恒定 $N$, $V$, $T$)。\n-   系统：$N = 512$ 个刚性 $\\mathrm{H_2}$ 分子。\n-   温度：$T = 20\\,\\mathrm{K}$。\n-   质量密度：$\\rho = 70\\,\\mathrm{kg\\,m^{-3}}$。\n-   相互作用：两次模拟均使用相同的经验参数化对势。\n-   模拟 1：经典分子动力学 (MD)，经典处理原子核。\n-   模拟 2：路径积分分子动力学 (PIMD)，包含核量子效应 (NQE)。\n-   提供的常数：\n    -   普朗克常数：$h = 6.626\\times 10^{-34}\\,\\mathrm{J\\,s}$。\n    -   玻尔兹曼常数：$k_\\mathrm{B} = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n    -   $\\mathrm{H_2}$ 分子质量：$m \\approx 2\\,\\mathrm{amu} \\approx 3.32\\times 10^{-27}\\,\\mathrm{kg}$。\n    -   $\\mathrm{H_2}$ 摩尔质量：$M = 2.016\\times 10^{-3}\\,\\mathrm{kg\\,mol^{-1}}$。\n    -   阿伏伽德罗常数：$N_\\mathrm{A} = 6.022\\times 10^{23}\\,\\mathrm{mol^{-1}}$。\n-   NQE重要性的度量标准：热德布罗意波长 $\\Lambda = h/\\sqrt{2\\pi m k_\\mathrm{B} T}$ 与特征分子间距 $a \\approx n^{-1/3}$ 的比值，其中 $n = \\rho N_\\mathrm{A}/M$。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n从科学合理性、完整性和客观性方面对问题陈述进行审视。\n\n1.  **科学依据**：该问题涉及凝聚态物理和物理化学中的一个基本主题：在何种条件下必须使用量子力学来描述核运动。所选系统，即 $20\\,\\mathrm{K}$ 的液氢，是一个典型的例子，由于氢分子的质量轻、温度低，NQE在此条件下至关重要。所用的方法（MD, PIMD）和概念（$\\Lambda$, $g(r)$, NVT系综）都是标准的。提供的常数和公式是正确的。该问题具有科学依据。\n2.  **问题的适定性**：该问题为同一系统在相同热力学条件（$N,V,T$）下定义了两种不同的物理模型（经典原子核 vs. 量子原子核）。它要求对其结构和输运性质进行定性比较，这是该领域的标准研究问题。提供的度量标准（$\\Lambda/a$）为解决方案提供了一条清晰的定量路径。可以得出一个唯一的、有意义的物理结论。该问题是适定的。\n3.  **客观性**：问题以精确的技术语言陈述，没有主观论断或偏见。\n4.  **完整性与一致性**：提供了进行所要求分析的所有必要数据（$T, \\rho, m, M$）和常数（$h, k_\\mathrm{B}, N_\\mathrm{A}$）。物理条件是符合实际的；$T=20\\,\\mathrm{K}$ 接近氢的正常沸点，$\\rho = 70\\,\\mathrm{kg\\,m^{-3}}$ 是一个合理的液体密度。没有内部矛盾。\n\n### 步骤 3：结论与行动\n\n问题陈述有效。我将继续推导解决方案。\n\n### 从第一性原理推导\n\n质量为 $m$ 的粒子在温度 $T$ 下的核量子效应的重要性，可以通过比较其热德布罗意波长 $\\Lambda$ 与粒子间的平均距离 $a$ 来评估。量 $\\Lambda$ 代表了由于热不确定性而导致的粒子波包的空间展宽。\n\n$$\n\\Lambda = \\frac{h}{\\sqrt{2\\pi m k_\\mathrm{B} T}}\n$$\n\n如果 $\\Lambda \\ll a$，粒子相对于它们之间的距离是很好地定域的，经典描述就足够了。如果 $\\Lambda \\gtrsim a$，波包会发生显著重叠，零点运动和离域等量子现象将变得占主导地位，使得经典描述失效。\n\n首先，我们计算数密度 $n$。\n$$\nn = \\frac{\\rho N_\\mathrm{A}}{M} = \\frac{(70\\,\\mathrm{kg\\,m^{-3}})(6.022\\times 10^{23}\\,\\mathrm{mol^{-1}})}{2.016\\times 10^{-3}\\,\\mathrm{kg\\,mol^{-1}}} \\approx 2.088 \\times 10^{28}\\,\\mathrm{m^{-3}}\n$$\n\n接下来，我们计算特征分子间距 $a$。\n$$\na \\approx n^{-1/3} = (2.088 \\times 10^{28}\\,\\mathrm{m^{-3}})^{-1/3} \\approx 3.63 \\times 10^{-10}\\,\\mathrm{m} = 3.63\\,\\text{Å}\n$$\n\n现在，我们计算在 $T=20\\,\\mathrm{K}$ 时一个氢分子的热德布罗意波长 $\\Lambda$。\n$$\n\\Lambda = \\frac{6.626\\times 10^{-34}\\,\\mathrm{J\\,s}}{\\sqrt{2\\pi (3.32\\times 10^{-27}\\,\\mathrm{kg})(1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}})(20\\,\\mathrm{K})}}\n$$\n$$\n\\Lambda \\approx \\frac{6.626\\times 10^{-34}}{\\sqrt{5.76 \\times 10^{-48}}}\\,\\mathrm{m} = \\frac{6.626\\times 10^{-34}}{2.40 \\times 10^{-24}}\\,\\mathrm{m} \\approx 2.76 \\times 10^{-10}\\,\\mathrm{m} = 2.76\\,\\text{Å}\n$$\n\n最后，我们计算比值 $\\Lambda/a$：\n$$\n\\frac{\\Lambda}{a} \\approx \\frac{2.76\\,\\text{Å}}{3.63\\,\\text{Å}} \\approx 0.76\n$$\n\n结果 $\\Lambda/a \\approx 0.76$ 是一个很大的值，接近1。这证实了在这些条件下核量子效应是极其显著的。\n\n**显著 NQE 的物理后果：**\n\n1.  **零点能 (ZPE) 与离域**：量子力学规定，一个受限粒子拥有一个与海森堡不确定性原理一致的最小动能，即ZPE。对于像 $\\mathrm{H_2}$ 这样的轻粒子，这个能量是相当大的。这种固有的动能阻止粒子停留在势阱的绝对最小值处。相反，它的波函数在一个有限的体积内离域。在路径积分形式中，这种离域可以被可视化为代表该量子粒子的“环状聚合物”的空间范围，其量级约为 $\\Lambda$。\n\n2.  **对结构和相的影响**：在经典模拟（MD）中，随着温度降低，粒子失去动能。在像 $20\\,\\mathrm{K}$ 这样足够低的温度下，热能 $k_B T$ 可能小于分子间势能阱的深度。因此，经典粒子将在这些势阱中强烈地定域，导致形成高度有序的、类固态或玻璃态（受阻）的状态。这将表现为径向分布函数 $g(r)$ 中一个非常尖锐且高的第一峰，以及一个为零或接近零的扩散系数。\n\n    在量子模拟（PIMD）中，巨大的ZPE起到了破坏性影响。它为分子提供了一个有效的动能，即使在热能 $k_B T$ 很低的情况下也能阻止它们定域。这种量子离域有效地将粒子“涂抹”在一个空间区域上，平滑了它所经历的势能面。这抵抗了有序化和结晶。因此，系统更可能保持在无序的液相中。与经典固态相比，这种状态的特征是 $g(r)$ 中的峰更宽、更低，表明结构有序性较差，并且具有有限的粒子迁移率（一个非零的自扩散系数）。\n\n**逐项分析选项**\n\n*   **A. 经典NVT模拟错误地预测了一个类固态的受阻态（例如，自扩散系数趋于零，径向分布函数 $g(r)$ 的第一峰非常尖锐且高），而PIMD模拟在相同的 $N$, $V$, $T$ 条件下保持为液态，其 $g(r)$ 峰展宽且自扩散系数为有限值。**\n    该陈述与我们的推导完全一致。经典模拟缺乏关键的ZPE和离域效应，导致其人为地“冻结”。量子模拟正确地包含了这些效应，从而得到一个更无序、更具流动性的液态。对每种情况下 $g(r)$ 和自扩散的描述是准确的。**正确。**\n\n*   **B. 两次模拟产生无法区分的平衡结构和输运性质，因为在固定的 $T$ 和 $V$ 下，正则系综中的玻尔兹曼权重仅取决于势能，而与粒子质量无关。**\n    这个推理是错误的。虽然经典的*构型*配分函数的被积函数 $e^{-\\beta U(\\mathbf{r}^N)}$ 没有显式地包含质量，但这是一种非常局限的观点。量子力学通过动能算符 $\\hat{K} = -\\sum_i \\frac{\\hbar^2}{2m_i}\\nabla_i^2$ 从根本上依赖于质量。这种质量依赖性正是产生热德布罗意波长 $\\Lambda$ 和所有NQE的原因。当NQE显著时（$\\Lambda/a \\approx 1$），像结构这样的平衡性质会强烈地依赖于质量。因此，这两次模拟将产生截然不同的结果。**不正确。**\n\n*   **C. PIMD模拟比经典模拟表现出更低的自扩散系数和更高的 $g(r)$ 第一峰，因为零点运动将分子更深地束缚在势阱中。**\n    该陈述描述了与实际物理效应相反的情况。ZPE和量子离域*阻止*粒子被深陷于势阱中。它们促进无序和流动性。因此，与经典受阻系统相比，PIMD应该显示出*更低*且*更宽*的 $g(r)$ 第一峰和*更高*的自扩散系数。**不正确。**\n\n*   **D. 两次模拟的静态结构 $g(r)$ 相同，但PIMD模拟显示出更高的动能，而输运系数保持不变，因为在NVT系综中，NQE只影响动量而不影响位置。**\n    该陈述包含多个错误。在量子力学中，位置和动量通过不确定性原理密不可分地联系在一起。对动量（动能）的影响必然会影响位置分布。静态结构 $g(r)$ 是粒子间位置概率分布的直接度量，如上所述，它将会有显著不同。虽然由于ZPE的存在，PIMD中的动能确实更高，但假设输运系数不变是错误的。粒子运动的根本机制被量子效应（如离域和隧穿）所改变，这些效应直接影响扩散。**不正确。**", "answer": "$$\\boxed{A}$$", "id": "2463773"}]}