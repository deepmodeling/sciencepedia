{"hands_on_practices": [{"introduction": "初学者常常会有一个误解：在一个总能量守恒的模拟（微正则系综或 NVE）中，温度是否也应该保持恒定？这个练习挑战了这一直观但错误的想法，旨在帮助你深入理解在有限、孤立的分子系统中，“温度”这一宏观量的微观本质。通过思考这个问题，你将巩固对模拟中统计力学基本原理的掌握。[@problem_id:2453071]", "problem": "一名学生对一个孤立分子在恒定数量、体积、能量 (NVE) 系综（也称作微正则系综）下进行经典分子动力学 (MD) 模拟。积分器在数值容差范围内保持总能量守恒，且随时间没有可辨别的漂移，但由瞬时动能计算得出的代码报告的瞬时温度，围绕一个稳定的长时间平均值剧烈涨落。哪个陈述最好地描述了这一结果在物理上和统计上是否正确，以及其原因？\n\nA. 正确：在微正则系综中，只有总能量是运动常数；瞬时动能 $K(t)$ 与势能 $U(t)$ 相互交换，使得 $E = K(t) + U(t)$ 保持恒定。由于动能温度是根据能量均分定理从 $K(t)$ 定义的，它会发生涨落。对于一个具有有限数量的二次自由度 $f$ 的系统，当 $f$ 很小时，相对涨落很大，并且大约以 $1/\\sqrt{f}$ 的规律减小。\n\nB. 错误：根据 NVE 系综的定义，总能量和温度都必须保持严格恒定；剧烈的温度涨落意味着积分器不稳定或不准确。\n\nC. 错误：温度涨落可以通过消除质心 (COM) 运动来移除；如果涨落仍然存在，那么原因在于温控器配置错误。\n\nD. 正确：只有当系统与热浴耦合时，才应该出现大的温度涨落；对于一个 NVE 系综中的真正孤立系统，动能温度必须是恒定的，因此观测到的行为表明存在隐藏的温控作用。", "solution": "从经典力学和统计力学的第一性原理出发。在一个孤立系统于恒定数量、体积、能量 (NVE) 系综下的经典 MD 轨迹中，哈密顿动力学保持总能量守恒，\n$$\nE = K(t) + U(t),\n$$\n因此\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = 0.\n$$\n然而，动能 $K(t)$ 和势能 $U(t)$ 都不是单独守恒的；它们不断地相互交换，以使其总和保持不变。经典 MD 中通常报告的“瞬时温度”是由瞬时动能通过能量均分定理定义的：\n$$\nT_{\\mathrm{inst}}(t) = \\frac{2\\,K(t)}{f\\,k_{\\mathrm{B}}},\n$$\n其中 $f$ 是二次自由度的数量，而 $k_{\\mathrm{B}}$ 是 Boltzmann 常数。因为 $K(t)$ 随时间涨落，即使在能量完全守恒的情况下，$T_{\\mathrm{inst}}(t)$ 也同样会涨落。\n\n热力学温度从根本上说是一个系综性质。在微正则系综中，它通过熵 $S$ 定义为\n$$\n\\frac{1}{T} = \\left(\\frac{\\partial S}{\\partial E}\\right)_{N,V}.\n$$\n在实践中，对于一个遍历性系统，$T_{\\mathrm{inst}}(t)$ 在足够长的 NVE 轨迹上的时间平均值被用作热力学温度的估计量。对于一个具有有限数量自由度 $f$ 的有限系统，$K(t)$ 以及因此 $T_{\\mathrm{inst}}(t)$ 的涨落是预料之中的，并且当 $f$ 很小时可能很大。在正则系综中，可以证明相对方差遵循\n$$\n\\frac{\\mathrm{Var}\\left(T_{\\mathrm{inst}}\\right)}{\\langle T_{\\mathrm{inst}}\\rangle^{2}} \\approx \\frac{2}{f},\n$$\n因此相对标准差的标度关系约为 $1/\\sqrt{f}$。$K$ 的微正则涨落对于大的 $f$ 具有密切相关的标度关系，而对于小的孤立分子（小的 $f$），瞬时温度通常表现出“剧烈”的涨落，即使总能量是完全守恒的。因此，这种行为对于 NVE 系综中的小系统来说，在物理上和统计上是正确的。\n\n评估每个选项：\n\n*   **A**: 该选项正确地指出，在微正则系综中只有总能量 $E$ 守恒，并且 $K(t)$ 及因此 $T_{\\mathrm{inst}}(t)$ 会涨落。它还正确地陈述了相对涨落幅度对自由度数 $f$ 的依赖关系，即大约以 $1/\\sqrt{f}$ 的规律减小。结论：正确。\n\n*   **B**: 该选项错误地声称，在 NVE 系综中温度是一个运动常数。微正则系综的定义是固定 $E$ (以及 $N, V$)，而不是从 $K(t)$ 定义的瞬时动能温度。如果 $E$ 守恒，$T_{\\mathrm{inst}}(t)$ 的剧烈涨落并不意味着积分器不稳定；对于小的 $f$，这些涨落是预料之中的。结论：错误。\n\n*   **C**: 移除质心 (COM) 运动消除了整体平动，但并不能抑制导致 $T_{\\mathrm{inst}}(t)$ 涨落的 $K(t)$ 和 $U(t)$ 之间的内部交换。此外，提及温控器是无关的，因为根据定义 NVE 系综没有温控器；在没有温控器的情况下，温度涨落是预料之中的。结论：错误。\n\n*   **D**: 该选项颠倒了物理情境。与热浴耦合（恒定数量、体积、温度，NVT）会约束平均温度但仍然允许涨落；NVE 系综中的孤立状态不会强迫动能温度恒定。相对于一个微小的孤立系统，隐藏的温控作用会倾向于减小而非增大涨落。结论：错误。\n\n因此，观测到的行为——在一个小的孤立系统中，能量完全守恒而瞬时温度剧烈涨落——在物理上和统计上是正确的，正如选项 A 所表述的那样。", "answer": "$$\\boxed{A}$$", "id": "2453071"}, {"introduction": "在理想的 NVE 系综中，总能量是严格守恒的。然而，在实际的计算机模拟中，数值积分的近似性以及力场的实现方式可能会引入微小的误差，从而破坏能量的守恒性。这个练习提供了一个典型的“数值病症”——总能量的系统性漂移，并要求你诊断其根本原因，将其与势能函数的具体实现方式联系起来。这个实践将锻炼你通过理解物理（力）与数值算法（积分器）之间的相互作用来调试模拟的关键技能。[@problem_id:2453046]", "problem": "一个由 $N$ 个相同粒子组成的系统，使用固定时间步长 $\\Delta t$ 的速度-Verlet积分器，在微正则 (NVE) 系综中进行经典分子动力学 (MD) 模拟。相互作用是成对的，由截断且势能平移的Lennard-Jones势给出。具体而言，基本势为\n$$\nV_{\\mathrm{LJ}}(r) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right],\n$$\n而所实现的相互作用为\n$$\nV_{\\mathrm{ps}}(r) =\n\\begin{cases}\nV_{\\mathrm{LJ}}(r) - V_{\\mathrm{LJ}}(r_c), & r \\le r_c,\\\\\n0, & r > r_c,\n\\end{cases}\n$$\n其中，力在截断半径内部计算为 $-\\mathrm{d}V_{\\mathrm{ps}}/\\mathrm{d}r$，在外部设为 $0$。模拟使用了周期性边界条件，没有使用恒温器。尽管选择的 $\\Delta t$ 小到足以解析最快的振动，总能量 $E(t)$ 却在长时间内表现出系统性漂移，而不是在有界波动范围内保持恒定。\n\n就业已实现的势 $V(r)$ 而言，哪一种诊断最能解释观测到的能量漂移的最可能原因？\n\nA. 截断在 $r = r_c$ 处导致力 $-\\mathrm{d}V/\\mathrm{d}r$ 出现跳跃不连续性，因此穿过 $r_c$ 的粒子对会因未解析的力跳跃而产生积分误差，这些误差累积成漂移。\n\nB. 势能没有经过平移以满足 $V(r_c) = 0$，所以 $V(r)$ 在 $r = r_c$ 处有一个有限的跳跃，当粒子对穿过 $r_c$ 时能量会不连续地改变。\n\nC. $V_{\\mathrm{LJ}}(r)$ 的短程排斥壁太硬，即使有平滑的截断，任何辛Verlet型积分器对于刚性势都会在 $E(t)$ 中产生长期漂移。\n\nD. 在微正则模拟中忽略对 $r > r_c$ 的能量进行解析长程尾部校正，会导致 $E(t)$ 随时间出现系统性漂移。", "solution": "在 $NVE$ 系综内的经典MD模拟中，系统的总能量 $E(t) = K(t) + U(t)$ 应该是一个守恒量。像速度-Verlet算法这样的时间可逆和辛的积分器，当应用于具有时间无关、保守且足够平滑的哈密顿量的系统时，总能量不应表现出系统性漂移，而应围绕一个恒定的平均值表现出有界涨落。观测到的 $E(t)$ 的系统性漂移表明势函数不满足平滑性要求。\n\n问题的根源在于所实现的势 $V_{\\mathrm{ps}}(r)$ 及其对应的力 $F(r) = -\\mathrm{d}V_{\\mathrm{ps}}(r)/\\mathrm{d}r$ 的性质。\n*   **势 $V_{\\mathrm{ps}}(r)$ 的连续性**：势能被平移以确保在截断处 $V_{\\mathrm{ps}}(r_c) = V_{\\mathrm{LJ}}(r_c) - V_{\\mathrm{LJ}}(r_c) = 0$，与 $r > r_c$ 的零势能相匹配。因此，势函数本身是连续的。\n*   **力 $F(r)$ 的连续性**：对于 $r \\le r_c$，力为 $F(r) = -\\mathrm{d}V_{\\mathrm{LJ}}(r)/\\mathrm{d}r$。对于 $r > r_c$，力被设为零。由于Lennard-Jones力在任意有限的截断半径 $r_c$ 处（除了势能极小点）通常不为零，因此力在 $r_c$ 处存在跳跃不连续性。\n\n这种力的不连续性违反了Verlet积分方案辛性的基本假设。每次有粒子对穿过截断距离时，积分器都会遇到一个瞬时、未解析的力跳跃，从而引入一个微小的积分误差。这些有方向性的误差随时间累积，导致总能量出现系统性漂移。\n\n评估各选项：\n*   **A**: 此陈述完全正确。它指出了力的跳跃不连续性是导致积分误差累积并产生能量漂移的根本原因。\n*   **B**: 此陈述事实上是错误的。势能经过了平移，在 $r_c$ 处是连续的。\n*   **C**: 此陈述具有误导性。虽然刚性势需要小的时间步长，但问题已声明 $\\Delta t$ 足够小。漂移的根源是力的不连续性（破坏了辛性），而非势的刚性本身。\n*   **D**: 此陈述错误。长程尾部校正是对能量的一个常数修正，不影响其随时间的变化（即动力学），因此不会引起漂移。", "answer": "$$\\boxed{A}$$", "id": "2453046"}, {"introduction": "分子模拟中最核心也最具挑战性的任务之一是确保模拟充分地探索了系统的构象空间，即“充分采样”。本练习构建了一个看似成功、实则存在根本缺陷的模拟场景：一个常用的诊断指标——动力学温度——看起来完全正常，但模拟的采样却是不充分的。通过分析这个案例，你将揭示快速的动能平衡与缓慢的构象采样之间的关键区别，这是研究具有多个亚稳态的复杂系统时必须面对的核心挑战。[@problem_id:2453013]", "problem": "对一个包含 $N=50$ 个粒子的团簇进行经典的分子动力学 (MD) 模拟，该模拟在一个设定目标温度为 $T=300\\,\\mathrm{K}$ 的恒温器下运行。其哈密顿量可分离为动能项和势能项，$H(\\mathbf{p},\\mathbf{q})=K(\\mathbf{p})+U(\\mathbf{q})$，并且运动方程以足够小的时间步长进行积分，以确保数值稳定性。在长度为 $10\\,\\mathrm{ns}$ 的轨迹中，系统被限制在单个亚稳态盆地内，该盆地与其他盆地被巨大的自由能垒隔开。通过瞬时动能和活性自由度数定义的动能温度可观测量的运行时间平均值与目标温度 $T$ 的匹配度在 $1\\%$ 以内。\n\n从正则系综的基本原理、遍历性（即长时间极限下时间平均与系综平均相等）的定义以及经典力学中动能和势能的可分离性出发，论证即使模拟是非遍历的（即陷入一个盆地中），时间平均动能温度如何能与目标温度匹配，以及为什么动能温度与 $T$ 的一致性是对良好采样的误导性诊断。\n\n以下哪些陈述正确地解释了这为何是可能的，以及为什么仅依赖动能温度会错误诊断采样质量？请选择所有适用项。\n\nA. 在具有可分离哈密顿量 $H(\\mathbf{p},\\mathbf{q})=K(\\mathbf{p})+U(\\mathbf{q})$ 的正则系综中，联合分布可因子分解，因此恒温器可以强制执行正确的麦克斯韦-玻尔兹曼动量边缘分布，从而使得 $\\langle K\\rangle$ 与 $T$ 一致，即使坐标分布被限制在一个盆地内；因此，当构型采样存在偏差时，时间平均动能温度仍能与 $T$ 匹配。\n\nB. 匹配目标温度保证了所有系综平均都是正确的，因为无论是否具有遍历性，时间平均都等于系综平均。\n\nC. 动能温度主要取决于快速的速度涨落，并且对慢集体坐标中的稀有越垒事件基本不敏感；因此，当慢模未被采样时，它仍可能看起来是正确的，这使其成为一个不可靠的构型采样指标。\n\nD. 非遍历性必然导致动能温度在长时间内偏离设定点，因此观察到时间平均动能温度与 $T$ 匹配意味着系统具有遍历性。\n\nE. 考虑约束会减少自由度的数量，一旦这个数量正确，温度将始终与 $T$ 匹配，这也意味着坐标分布是正确的。", "solution": "这个现象的根本原因在于经典正则系综中可分离哈密顿量的统计力学特性，以及动能和构型自由度在动力学上的时间尺度分离。\n\n在正则系综中，对于一个可分离的哈密顿量 $H(\\mathbf{p},\\mathbf{q}) = K(\\mathbf{p}) + U(\\mathbf{q})$，相空间中的平衡概率分布可以分解为动量和坐标的独立分布：$\\rho(\\mathbf{q}, \\mathbf{p}) = \\rho_p(\\mathbf{p}) \\rho_q(\\mathbf{q})$。这意味着动量和坐标在统计上是解耦的。恒温器的作用是确保动量分布 $\\rho_p(\\mathbf{p})$ 正确地对麦克斯韦-玻尔兹曼分布进行采样，从而使平均动能 $\\langle K \\rangle$ 与目标温度 $T$ 匹配。动量的平衡发生在非常快的时间尺度上（飞秒到皮秒）。\n\n然而，构型采样由坐标分布 $\\rho_q(\\mathbf{q})$ 决定，它需要系统探索由势能 $U(\\mathbf{q})$ 定义的整个能量形貌。当存在巨大的能垒时，跨越这些能垒的事件可能非常稀有，发生在比动量弛豫慢得多的时间尺度上（纳秒到更长）。如果模拟时间不足以观察到这些越垒事件，系统就会被困在一个构型子空间（亚稳态盆地）中，导致构型采样不充分，即模拟是非遍历的。\n\n因此，完全可能出现以下情况：恒温器成功地平衡了快速的动量自由度，使得时间平均动能温度 $\\langle T_{kin} \\rangle_{time}$ 精确地收敛到 $T$，而慢速的构型自由度却远未达到平衡，仍被困在局部。\n\n评估各选项：\n*   **A**: 此陈述完全正确。它准确地指出了哈密顿量的可分离性导致概率分布的因子分解，使得恒温器可以独立地平衡动能，即使构型采样受限。\n*   **B**: 此陈述错误。时间平均与系综平均的等价性是遍历性的定义，而问题中系统是非遍历的。\n*   **C**: 此陈述也正确。它从动力学时间尺度的角度解释了同样的问题：动能温度反映的是快速的振动和碰撞，而对缓慢的、决定采样的构象变化不敏感。\n*   **D**: 此陈述错误。如上所述，非遍历性（在构型空间中）和正确的动能温度可以共存。\n*   **E**: 此陈述错误。正确计算自由度数只是计算温度的必要步骤，它本身并不保证采样质量或坐标分布的正确性。\n\n因此，选项A和C都正确地解释了这一现象。", "answer": "$$\\boxed{AC}$$", "id": "2453013"}]}