{"hands_on_practices": [{"introduction": "这项练习将带你回到Hartree-Fock理论的基本原理。通过为最简单的多电子体系——氦原子——手动构建Fock矩阵，你将具体理解抽象的平均场算符是如何由单电子和双电子积分构成的。这种“纸笔”练习对于揭开Fock算符的神秘面纱、清晰辨别其库仑和交换项的物理意义至关重要。[@problem_id:2463880]", "problem": "考虑氦原子，其核电荷数为 $Z=2$，拥有两个电子，并使用原子单位进行描述。使用限制性 Hartree–Fock (RHF) 平均场近似，采用由单个中心在原子核上的归一化 $1s$ 型函数 $\\chi(\\mathbf{r})$ 组成的最小斯莱特型轨道-单高斯 (STO-1G) 空间基组。在自旋轨道基矢 $\\{\\chi\\alpha,\\ \\chi\\beta\\}$ 下构建 $2 \\times 2$ 的 Fock 矩阵，其中 $\\alpha$ 和 $\\beta$ 代表自旋函数。设单电子核心哈密顿算符为 $\\hat{h}=-\\frac{1}{2}\\nabla^{2}-\\frac{Z}{r}$，并定义单电子积分 $h_{11}=\\langle \\chi|\\hat{h}|\\chi\\rangle$ 和双电子库仑积分 $(11|11)=\\iint |\\chi(\\mathbf{r}_{1})|^{2}\\,\\frac{1}{r_{12}}\\,|\\chi(\\mathbf{r}_{2})|^{2}\\,d\\mathbf{r}_{1}\\,d\\mathbf{r}_{2}$。根据闭壳层体系的 Fock 算符的平均场定义，用 $h_{11}$ 和 $(11|11)$ 显式地写出 $2 \\times 2$ 的 Fock 矩阵，并在表达式中清楚地标明哪些贡献来自库仑作用，哪些来自交换作用。将最终答案表示为由 $h_{11}$ 和 $(11|11)$ 构成的解析 $2 \\times 2$ 矩阵。无需进行数值计算。", "solution": "所述问题具有科学依据，提法恰当，客观且内部一致。它提出了一个计算量子化学中标准的、可解的问题。因此，将提供一个解答。\n\n目标是在限制性 Hartree-Fock (RHF) 近似下，为氦原子构建 Fock 矩阵 $\\mathbf{F}$。该基组由两个自旋轨道构成，即 $\\psi_1 = \\chi\\alpha$ 和 $\\psi_2 = \\chi\\beta$，其中 $\\chi$ 是单个归一化的 $1s$ 空间轨道，而 $\\alpha$ 和 $\\beta$ 分别是自旋向上和自旋向下的函数。对于像基态氦这样的闭壳层体系，这两个自旋轨道就是占据轨道。\n\n在正交归一的自旋轨道基矢 $\\{\\psi_p\\}$ 中，Fock 算符 $\\hat{f}$ 的矩阵元的通式为：\n$$F_{pq} = \\langle \\psi_p | \\hat{f} | \\psi_q \\rangle = \\langle \\psi_p | \\hat{h} | \\psi_q \\rangle + \\sum_{j}^{\\text{occ}} \\left[ \\langle \\psi_p \\psi_j | \\frac{1}{r_{12}} | \\psi_q \\psi_j \\rangle - \\langle \\psi_p \\psi_j | \\frac{1}{r_{12}} | \\psi_j \\psi_q \\rangle \\right]$$\n此处，$\\hat{h}$ 是单电子核心哈密顿算符，求和遍及所有占据的自旋轨道，双电子积分采用物理学家标记法，即 $\\langle ij | kl \\rangle = \\iint \\psi_i^*(\\mathbf{x}_1) \\psi_j^*(\\mathbf{x}_2) \\frac{1}{r_{12}} \\psi_k(\\mathbf{x}_1) \\psi_l(\\mathbf{x}_2) d\\mathbf{x}_1 d\\mathbf{x}_2$。求和项中的第一项是库仑贡献 ($J_{pq}$)，第二项是交换贡献 ($K_{pq}$)。\n\n在此问题中，占据自旋轨道的集合是 $\\{\\psi_1, \\psi_2\\}$。我们必须计算这个 $2 \\times 2$ Fock 矩阵的四个元素：$F_{11}$、$F_{12}$、$F_{21}$ 和 $F_{22}$。\n\n对角元素 $F_{11}$ 的计算：\n我们令 $p=q=1$。求和遍及 $j=1, 2$。\n$$F_{11} = \\langle \\psi_1 | \\hat{h} | \\psi_1 \\rangle + \\sum_{j=1}^{2} \\left[ \\langle 1j | 1j \\rangle - \\langle 1j | j1 \\rangle \\right]$$\n单电子项是 $\\langle \\psi_1 | \\hat{h} | \\psi_1 \\rangle = \\langle \\chi\\alpha | \\hat{h} | \\chi\\alpha \\rangle$。由于 $\\hat{h}$ 与自旋无关，该项可分离为一个空间积分和一个自旋积分：$\\langle \\chi | \\hat{h} | \\chi \\rangle \\langle \\alpha | \\alpha \\rangle$。已知 $\\langle \\alpha | \\alpha \\rangle=1$ 且根据定义 $h_{11} = \\langle \\chi | \\hat{h} | \\chi \\rangle$，此项即为 $h_{11}$。\n\n双电子项分别对 $j=1$ 和 $j=2$ 进行计算：\n对于 $j=1$：贡献为 $\\langle 11 | 11 \\rangle - \\langle 11 | 11 \\rangle = 0$。这代表了交换自相互作用对库仑自相互作用的精确抵消，这是 Hartree-Fock 理论的一个基本性质。\n对于 $j=2$：贡献为 $\\langle 12 | 12 \\rangle - \\langle 12 | 21 \\rangle$。\n库仑项是 $\\langle 12 | 12 \\rangle = \\langle \\psi_1 \\psi_2 | \\frac{1}{r_{12}} | \\psi_1 \\psi_2 \\rangle = \\langle \\chi\\alpha \\chi\\beta | \\frac{1}{r_{12}} | \\chi\\alpha \\chi\\beta \\rangle$。此积分的空间部分是 $\\iint |\\chi(\\mathbf{r}_1)|^2 \\frac{1}{r_{12}} |\\chi(\\mathbf{r}_2)|^2 d\\mathbf{r}_1 d\\mathbf{r}_2$，根据定义，它就是 $(11|11)$。自旋部分是 $\\langle \\alpha | \\alpha \\rangle \\langle \\beta | \\beta \\rangle = 1 \\times 1 = 1$。因此，库仑项是 $(11|11)$。\n交换项是 $\\langle 12 | 21 \\rangle = \\langle \\psi_1 \\psi_2 | \\frac{1}{r_{12}} | \\psi_2 \\psi_1 \\rangle = \\langle \\chi\\alpha \\chi\\beta | \\frac{1}{r_{12}} | \\chi\\beta \\chi\\alpha \\rangle$。其空间部分同样是 $(11|11)$。由于自旋函数的正交性，自旋部分是 $\\langle \\alpha | \\beta \\rangle \\langle \\beta | \\alpha \\rangle = 0 \\times 0 = 0$。因此，交换项为 $0$。\n\n合并 $F_{11}$ 的所有部分：\n$F_{11} = h_{11} + 0 + [(11|11) - 0] = h_{11} + (11|11)$。\n此矩阵元的双电子贡献完全来自 $\\psi_1$ 中的电子与 $\\psi_2$ 中的电子之间的库仑相互作用。\n\n对角元素 $F_{22}$ 的计算：\n根据对称性，$F_{22}$ 的计算与 $F_{11}$ 的计算完全相同，只是 $\\alpha$ 和 $\\beta$ 自旋函数的作用互换。\n$F_{22} = \\langle \\psi_2 | \\hat{h} | \\psi_2 \\rangle + \\sum_{j=1}^{2} \\left[ \\langle 2j | 2j \\rangle - \\langle 2j | j2 \\rangle \\right]$。\n核心项是 $\\langle \\chi\\beta | \\hat{h} | \\chi\\beta \\rangle = h_{11}$。\n当 $j=2$ 时，求和项给出自相互作用的抵消。当 $j=1$ 时，求和项给出与另一个电子的相互作用：库仑部分是 $(11|11)$，交换部分是 $0$。\n因此，$F_{22} = h_{11} + (11|11)$。\n\n非对角元素 $F_{12}$ 的计算：\n我们令 $p=1, q=2$。\n$$F_{12} = \\langle \\psi_1 | \\hat{h} | \\psi_2 \\rangle + \\sum_{j=1}^{2} \\left[ \\langle 1j | 2j \\rangle - \\langle 1j | j2 \\rangle \\right]$$\n单电子项是 $\\langle \\psi_1 | \\hat{h} | \\psi_2 \\rangle = \\langle \\chi\\alpha | \\hat{h} | \\chi\\beta \\rangle = \\langle \\chi | \\hat{h} | \\chi \\rangle \\langle \\alpha | \\beta \\rangle = h_{11} \\cdot 0 = 0$。\n由于自旋正交性，双电子项也为零。对于任何 $j$，自旋积分都将涉及形式为 $\\langle \\alpha | \\beta \\rangle$ 或 $\\langle \\beta | \\alpha \\rangle$ 的内积，其值为零。例如，对于 $j=1$：\n$\\langle 11 | 21 \\rangle = \\langle \\chi\\alpha \\chi\\alpha | \\frac{1}{r_{12}} | \\chi\\beta \\chi\\alpha \\rangle \\propto \\langle \\alpha | \\beta \\rangle \\langle \\alpha | \\alpha \\rangle = 0$。\n$\\langle 11 | 12 \\rangle = \\langle \\chi\\alpha \\chi\\alpha | \\frac{1}{r_{12}} | \\chi\\alpha \\chi\\beta \\rangle \\propto \\langle \\alpha | \\alpha \\rangle \\langle \\alpha | \\beta \\rangle = 0$。\n对 $j=2$ 的类似分析也得到零。\n因此，$F_{12} = 0$。\n\n非对角元素 $F_{21}$ 的计算：\nFock 矩阵必须是厄米矩阵，所以 $F_{21} = F_{12}^* = 0$。显式计算证实了这一点，因为所有项都将再次涉及正交的自旋内积 $\\langle \\beta | \\alpha \\rangle=0$。\n\n得到的 Fock 矩阵是对角矩阵，这是符合预期的，因为自旋轨道 $\\psi_1$ 和 $\\psi_2$ 是该体系的正则 Hartree-Fock 轨道。对角元素代表轨道能量，在 RHF 形式下，对于 $\\alpha$ 和 $\\beta$ 自旋是简并的。Fock 矩阵 $\\mathbf{F}$ 是：\n$$\\mathbf{F} = \\begin{pmatrix} F_{11} & F_{12} \\\\ F_{21} & F_{22} \\end{pmatrix} = \\begin{pmatrix} h_{11} + (11|11) & 0 \\\\ 0 & h_{11} + (11|11) \\end{pmatrix}$$\n对角元素中的项 $(11|11)$ 是一个纯粹的库仑贡献，代表一个电子受到另一个位于第二自旋轨道上的电子的排斥作用。由于两个电子的自旋相反，它们之间的交换贡献为零。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nh_{11} + (11|11) & 0 \\\\\n0 & h_{11} + (11|11)\n\\end{pmatrix}\n}\n$$", "id": "2463880"}, {"introduction": "尽管平均场近似简化了多体问题，但其不同形式（如RHF和UHF）各有其重要的局限性。本练习使用一个简单的双中心模型（双原子分子的极简表示）来探索RHF/UHF不稳定性的概念。通过确定自旋限制（RHF）解变得不稳定并让位于能量更低的自旋非限制（UHF）解的解析条件，你将揭示化学键断裂的平均场描述，以及电子离域与电子关联之间的竞争。[@problem_id:2463835]", "problem": "考虑一个同核双原子“分子”，该模型被建模为一个处于半填充状态（两个电子）的双位点哈伯德二聚体。其电子哈密顿量为\n$$\n\\hat{H} \\;=\\; -\\,t\\,\\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}}\\left(\\hat{c}_{1\\sigma}^\\dagger \\hat{c}_{2\\sigma} + \\hat{c}_{2\\sigma}^\\dagger \\hat{c}_{1\\sigma}\\right) \\;+\\; U \\sum_{i\\in\\{1,2\\}} \\hat{n}_{i\\uparrow}\\,\\hat{n}_{i\\downarrow},\n$$\n其中，$t$ 是跃迁参数，$U$ 是在位电子排斥能，$\\hat{c}_{i\\sigma}^\\dagger$ 和 $\\hat{c}_{i\\sigma}$ 分别在位点 $i$ 上产生和湮灭一个自旋为 $\\sigma$ 的电子，且 $\\hat{n}_{i\\sigma}=\\hat{c}_{i\\sigma}^\\dagger \\hat{c}_{i\\sigma}$。使用 Hartree–Fock (HF) 平均场近似，其中双电子项根据下式被单电子密度的乘积所取代：\n$$\n\\hat{n}_{i\\uparrow}\\,\\hat{n}_{i\\downarrow}\\;\\approx\\;\\hat{n}_{i\\uparrow}\\,\\langle \\hat{n}_{i\\downarrow}\\rangle \\;+\\; \\langle \\hat{n}_{i\\uparrow}\\rangle\\,\\hat{n}_{i\\downarrow}\\;-\\;\\langle \\hat{n}_{i\\uparrow}\\rangle\\,\\langle \\hat{n}_{i\\downarrow}\\rangle.\n$$\n在限制性 Hartree–Fock (RHF) 近似中，对每个位点施加自旋对称性，使得对每个 $i$ 都有 $\\langle \\hat{n}_{i\\uparrow}\\rangle=\\langle \\hat{n}_{i\\downarrow}\\rangle$。在非限制性 Hartree–Fock (UHF) 近似中，不施加此约束。定义：对于相同的 $(t,U)$，如果存在一个自洽的 UHF 态，其平均场能量严格低于任何自旋对称 (RHF) 态的能量，则该 RHF 态是不稳定的。\n\n任务：对于下面测试套件中的每一对参数 $(t,U)$，根据上述定义判断 RHF 态是否不稳定。您的程序必须仅基于给定的定义，以逻辑一致的方式解决该平均场问题，并为每种情况报告一个布尔值，如果 RHF 态不稳定则为 true，否则为 false。无需用户输入。\n\n测试套件（每对为 $(t,U)$，其中 $t$ 和 $U$ 使用相同的任意能量单位）：\n- `(1.0, 0.5)`\n- `(1.0, 2.0)`\n- `(1.0, 3.0)`\n- `(-1.0, 3.0)`\n- `(0.0, 0.5)`\n- `(0.5, 0.9)`\n\n最终输出格式：您的程序应生成单行输出，其中包含一个由逗号分隔并用方括号括起来的结果列表（例如，`[result1,result2,result3]`）。每个结果必须是字面布尔标记 `True` 或 `False`，首字母大写，行内任何地方都不能有空格，且结果顺序与测试套件的顺序相同。\n\n您的程序应产生单行输出，其中包含一个由方括号括起来的逗号分隔列表的结果（例如，`[r1,r2,r3]`）。", "solution": "所述问题是有效的。这是一个来自计算化学领域的、有科学依据且良置的问题，具体涉及平均场理论在电子关联的基本模型——哈伯德模型上的应用。所有术语都有明确定义，任务是基于所提供原则的客观计算。我们将继续进行推导。\n\n该问题要求对一个双位点、双电子的哈伯德模型，比较其限制性 Hartree-Fock (RHF) 和非限制性 Hartree-Fock (UHF) 近似的基态能量。RHF 态被定义为不稳定，是指如果存在一个自洽的 UHF 态，其平均场能量严格更低。\n\n哈密顿量由下式给出\n$$\n\\hat{H} = -t \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} (\\hat{c}_{1\\sigma}^\\dagger \\hat{c}_{2\\sigma} + \\hat{c}_{2\\sigma}^\\dagger \\hat{c}_{1\\sigma}) + U \\sum_{i\\in\\{1,2\\}} \\hat{n}_{i\\uparrow}\\,\\hat{n}_{i\\downarrow}\n$$\nHartree-Fock 近似将双电子项线性化：\n$$\n\\hat{n}_{i\\uparrow}\\,\\hat{n}_{i\\downarrow} \\approx \\hat{n}_{i\\uparrow}\\,\\langle \\hat{n}_{i\\downarrow}\\rangle + \\langle \\hat{n}_{i\\uparrow}\\rangle\\,\\hat{n}_{i\\downarrow} - \\langle \\hat{n}_{i\\uparrow}\\rangle\\,\\langle \\hat{n}_{i\\downarrow}\\rangle\n$$\n这产生了一个单体平均场哈密顿量 $\\hat{H}_{MF}$，它可以分离为自旋向上 ($\\sigma=\\uparrow$) 和自旋向下 ($\\sigma=\\downarrow$) 的分量。在位点基 $\\{|1\\sigma\\rangle, |2\\sigma\\rangle\\}$ 中，自旋为 $\\sigma$ 的单电子哈密顿量的矩阵表示 $\\mathbf{h}_{\\sigma}$ 为：\n$$\n\\mathbf{h}_{\\sigma} = \\begin{pmatrix} U \\langle n_{1,-\\sigma} \\rangle & -t \\\\ -t & U \\langle n_{2,-\\sigma} \\rangle \\end{pmatrix}\n$$\n此处，$\\langle n_{i,-\\sigma} \\rangle$ 是平均电子密度，必须通过自洽方式确定。\n\n首先，我们分析 RHF 解。RHF 近似施加了自旋对称性，即对于 $i \\in \\{1, 2\\}$ 有 $\\langle n_{i\\uparrow} \\rangle = \\langle n_{i\\downarrow} \\rangle$。对于同核二聚体，位点对称性给出 $\\langle n_{1\\sigma} \\rangle = \\langle n_{2\\sigma} \\rangle$。结合这些条件，并考虑到系统总共有两个电子，即 $\\sum_{i,\\sigma} \\langle n_{i\\sigma} \\rangle = 2$，我们发现密度被唯一确定为：\n$$\n\\langle n_{1\\uparrow} \\rangle = \\langle n_{1\\downarrow} \\rangle = \\langle n_{2\\uparrow} \\rangle = \\langle n_{2\\downarrow} \\rangle = \\frac{1}{2}\n$$\n该解是内在地自洽的。RHF 福克矩阵对于两种自旋是相同的：\n$$\n\\mathbf{h}_{RHF} = \\begin{pmatrix} U/2 & -t \\\\ -t & U/2 \\end{pmatrix}\n$$\n本征值为 $\\epsilon_{\\pm} = U/2 \\pm |t|$。基态轨道能量为 $\\epsilon_g = U/2 - |t|$。我们有两个电子，因此一个自旋向上和一个自旋向下的电子占据这个能量最低的分子轨道。计算平均场能量 $E = \\langle \\hat{H}_{kin} \\rangle + U \\sum_i \\langle n_{i\\uparrow} \\rangle \\langle n_{i\\downarrow} \\rangle$。动能是在基态轨道中动能算符 $\\hat{h}_{kin} = -t(\\hat{c}_{1}^\\dagger\\hat{c}_{2}+\\hat{c}_{2}^\\dagger\\hat{c}_{1})$ 的期望值的两倍，即 $-2|t|$。相互作用项为 $U((1/2)(1/2) + (1/2)(1/2)) = U/2$。因此，RHF 基态能量为：\n$$\nE_{RHF} = -2|t| + \\frac{U}{2}\n$$\n\n接下来，我们分析 UHF 解。我们放宽自旋对称性约束，寻找具有自旋极化的解。我们可以为一个反铁磁排列将密度参数化：\n$$\n\\langle n_{1\\uparrow} \\rangle = \\frac{1+m}{2}, \\quad \\langle n_{1\\downarrow} \\rangle = \\frac{1-m}{2}\n$$\n$$\n\\langle n_{2\\uparrow} \\rangle = \\frac{1-m}{2}, \\quad \\langle n_{2\\downarrow} \\rangle = \\frac{1+m}{2}\n$$\n这里，$m$ 是磁化参数。RHF 解对应于 $m=0$。不稳定的 RHF 意味着存在一个 $m \\neq 0$ 且能量更低的稳定 UHF 解。自旋向上和自旋向下的 UHF 福克矩阵为：\n$$\n\\mathbf{h}_{\\uparrow} = \\begin{pmatrix} U(1-m)/2 & -t \\\\ -t & U(1+m)/2 \\end{pmatrix}, \\quad \\mathbf{h}_{\\downarrow} = \\begin{pmatrix} U(1+m)/2 & -t \\\\ -t & U(1-m)/2 \\end{pmatrix}\n$$\n为了找到自洽解，由这些矩阵的本征矢量计算出的密度必须与用于构建它们的密度相匹配。对于自旋-$\\sigma$，在位密度差为 $\\langle n_{1\\sigma} \\rangle - \\langle n_{2\\sigma} \\rangle$。对于一个 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a & c \\\\ c & b \\end{pmatrix}$ 的基态本征矢量，该密度差由 $-\\frac{a-b}{\\sqrt{(a-b)^2 + 4c^2}}$ 给出。\n对于自旋向上通道，我们有 $a-b = -Um$ 和 $c=-t$。自洽条件为：\n$$\nm = \\langle n_{1\\uparrow} \\rangle - \\langle n_{2\\uparrow} \\rangle = - \\frac{-Um}{\\sqrt{(-Um)^2 + 4(-t)^2}} = \\frac{Um}{\\sqrt{U^2m^2 + 4t^2}}\n$$\n对于自旋向下通道，$a-b = Um$，得到：\n$$\n-m = \\langle n_{1\\downarrow} \\rangle - \\langle n_{2\\downarrow} \\rangle = - \\frac{Um}{\\sqrt{(Um)^2 + 4(-t)^2}} = \\frac{-Um}{\\sqrt{U^2m^2 + 4t^2}}\n$$\n两个方程都可化简为 $m (1 - \\frac{U}{\\sqrt{U^2m^2 + 4t^2}}) = 0$。该方程有两类解：\n1. 平凡解，$m=0$，即 RHF 解。\n2. 如果 $1 = \\frac{U}{\\sqrt{U^2m^2 + 4t^2}}$，则存在非平凡解 ($m\\neq 0$)。这要求 $U>0$。两边平方得到 $U^2 = U^2 m^2 + 4t^2$，这给出 $m^2 = 1 - (2|t|/U)^2$。仅当 $1 - (2|t|/U)^2 > 0$ 时，才存在 $m \\neq 0$ 的实数解，该条件可简化为 $U > 2|t|$。\n\n如果 $U \\le 2|t|$，只有 $m=0$ (RHF) 解是自洽的，因此 RHF 态是稳定的。\n如果 $U > 2|t|$，则存在一个破缺对称性的 UHF 解，其 $m = \\sqrt{1 - (2|t|/U)^2}$。我们必须检查其能量是否低于 $E_{RHF}$。\n总 UHF 能量为 $E_{UHF} = \\langle \\hat{H}_{kin} \\rangle_{UHF} + U \\sum_i \\langle n_{i\\uparrow} \\rangle \\langle n_{i\\downarrow} \\rangle$。\n动能为 $\\langle \\hat{H}_{kin} \\rangle_{UHF} = -2|t|\\sqrt{1-m^2}$。使用 $m^2 = 1 - 4t^2/U^2$，我们得到 $\\sqrt{1-m^2}=2|t|/U$。所以，$\\langle \\hat{H}_{kin} \\rangle_{UHF} = -2|t|(2|t|/U) = -4t^2/U$。\n相互作用能为 $U \\sum_i \\langle n_{i{\\uparrow}} \\rangle \\langle n_{i{\\downarrow}} \\rangle = U [ (\\frac{1+m}{2})(\\frac{1-m}{2}) + (\\frac{1-m}{2})(\\frac{1+m}{2}) ] = U\\frac{1-m^2}{2} = U\\frac{4t^2/U^2}{2} = \\frac{2t^2}{U}$。\n总 UHF 能量为：\n$$\nE_{UHF} = -\\frac{4t^2}{U} + \\frac{2t^2}{U} = -\\frac{2t^2}{U}\n$$\n现在，我们比较在 $U > 2|t|$ 情况下 $E_{UHF}$ 与 $E_{RHF}$ 的大小。如果 $E_{UHF} < E_{RHF}$，RHF 态则不稳定：\n$$\n-\\frac{2t^2}{U} < -2|t| + \\frac{U}{2}\n$$\n两边乘以 $2U$（为正数），不等式方向保持不变：\n$$\n-4t^2 < -4|t|U + U^2\n$$\n$$\n0 < U^2 - 4|t|U + 4t^2\n$$\n$$\n0 < (U-2|t|)^2\n$$\n只要 $U \\neq 2|t|$，这个不等式就严格成立。由于 UHF 解只在 $U>2|t|$ 时存在，因此在该情况下该条件总是满足的。所以，RHF 态不稳定的充要条件是 $U > 2|t|$。\n\n我们将此判据应用于给定的测试用例：\n1. $(t,U) = (1.0, 0.5)$：$0.5 > 2 \\times |1.0|$ 是否成立？否，$0.5 \\ngtr 2.0$。不稳定：假。\n2. $(t,U) = (1.0, 2.0)$：$2.0 > 2 \\times |1.0|$ 是否成立？否，$2.0 \\ngtr 2.0$。不稳定：假。\n3. $(t,U) = (1.0, 3.0)$：$3.0 > 2 \\times |1.0|$ 是否成立？是，$3.0 > 2.0$。不稳定：真。\n4. $(t,U) = (-1.0, 3.0)$：$3.0 > 2 \\times |-1.0|$ 是否成立？是，$3.0 > 2.0$。不稳定：真。\n5. $(t,U) = (0.0, 0.5)$：$0.5 > 2 \\times |0.0|$ 是否成立？是，$0.5 > 0.0$。不稳定：真。\n6. $(t,U) = (0.5, 0.9)$：$0.9 > 2 \\times |0.5|$ 是否成立？否，$0.9 \\ngtr 1.0$。不稳定：假。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Hubbard dimer problem to determine RHF instability.\n    \"\"\"\n    \n    # Test suite (t, U) from the problem statement.\n    test_cases = [\n        (1.0, 0.5),\n        (1.0, 2.0),\n        (1.0, 3.0),\n        (-1.0, 3.0),\n        (0.0, 0.5),\n        (0.5, 0.9),\n    ]\n\n    results = []\n    for t, U in test_cases:\n        # According to the mean-field analysis of the two-site Hubbard model,\n        # the Restricted Hartree-Fock (RHF) solution becomes unstable with respect\n        # to a spin-polarized (UHF) solution if and only if the on-site repulsion U\n        # is strictly greater than twice the absolute value of the hopping parameter t.\n        # This condition is derived by seeking a self-consistent, broken-symmetry\n        # solution and comparing its energy to the RHF energy.\n        \n        # The instability condition is U > 2*|t|.\n        is_unstable = U > 2.0 * abs(t)\n        \n        # The output format requires the literal boolean tokens \"True\" or \"False\".\n        # Python's str() of a boolean produces the required format.\n        results.append(str(is_unstable))\n\n    # The final print statement must match the specified format exactly:\n    # A comma-separated list of boolean tokens enclosed in square brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2463835"}, {"introduction": "寻找平均场解需要一个迭代的自洽场（SCF）过程，这本质上是一个非线性问题。这项练习展示了SCF计算的一个关键实践要点：它对初始猜测的依赖性。你将亲眼看到一个“糟糕”的初始猜测如何导致SCF过程收敛到一个局部最小值——一个物理上不正确的激发态，而不是真正的基态，这突显出SCF算法并非一个保证能找到最低能量解的“黑箱”。[@problem_id:2463815]", "problem": "在一个维度为$2$的最小正交原子轨道基组中，一个闭壳层双电子体系在限制性Hartree–Fock（RHF）的自洽场（SCF）平均场近似下进行建模。设单电子（核）哈密顿量为实对称矩阵 $h \\in \\mathbb{R}^{2 \\times 2}$，其元素为 $h_{\\mu\\nu}$，电子-电子相互作用由满足所有标准置换对称性的双电子排斥积分实张量 $(\\mu\\nu|\\lambda\\sigma)$ 给出。对于给定的密度矩阵 $P \\in \\mathbb{R}^{2 \\times 2}$，RHF Fock矩阵定义为\n$$\nF_{\\mu\\nu}(P) \\;=\\; h_{\\mu\\nu} \\;+\\; \\sum_{\\lambda,\\sigma=1}^{2} P_{\\lambda\\sigma} \\left[\\, (\\mu\\nu|\\lambda\\sigma) \\;-\\; \\tfrac{1}{2}\\,(\\mu\\lambda|\\nu\\sigma) \\,\\right].\n$$\n在包含$N=2$个电子的闭壳层情况下，已占据分子轨道子空间的维度为$1$。设 $C_{\\text{occ}}(P) \\in \\mathbb{R}^{2 \\times 1}$ 表示与 $F(P)$ 的最低特征值相关联的归一化特征向量。SCF不动点条件要求密度矩阵满足\n$$\nP \\;=\\; 2\\,C_{\\text{occ}}(P)\\,C_{\\text{occ}}(P)^{\\top},\n$$\n并且总电子能量（单位为Hartree）为\n$$\nE(P) \\;=\\; \\tfrac{1}{2}\\,\\operatorname{Tr}\\!\\left[(h+F(P))\\,P\\right].\n$$\n现提供三个独立的测试用例。在每个测试用例中，重叠矩阵为单位矩阵，除总能量必须以Hartree为单位外，所有量均视为无量纲，并且所有未指定的双电子积分恒为零。对每个测试用例，运行两次SCF计算直至收敛（即达到上述映射的一个不动点）：一次从“良好”的初始密度开始，另一次从特意设置的“不良”初始密度开始。两种初始密度定义如下。\n\n- “良好”的初始密度 $P^{(0)}_{\\text{good}}$ 通过对角化单电子哈密顿量 $h$ 获得，取其最低特征值对应的归一化特征向量 $c_{\\min}$，并设置 $P^{(0)}_{\\text{good}} = 2\\,c_{\\min}c_{\\min}^{\\top}$。\n\n- “不良”的初始密度 $P^{(0)}_{\\text{poor}}$ 取为双占据较高索引原子轨道的投影矩阵，即 $P^{(0)}_{\\text{poor}} = 2\\,|2\\rangle\\langle 2| = \\begin{pmatrix}0 & 0 \\\\ 0 & 2\\end{pmatrix}$。\n\n对于每个测试用例 $k \\in \\{1,2,3\\}$，您的程序必须将从 $P^{(0)}_{\\text{good}}$ 开始的SCF迭代收敛到一个不动点，其密度为 $P^{\\star}_{\\text{good}}$，能量为 $E_{\\text{good}}$；并将从 $P^{(0)}_{\\text{poor}}$ 开始的迭代收敛到一个不动点，其密度为 $P^{\\star}_{\\text{poor}}$，能量为 $E_{\\text{poor}}$。然后，对每个测试用例，报告布尔值\n$$\n\\text{is\\_excited} \\;=\\; \\left[\\, E_{\\text{poor}} \\;>\\; E_{\\text{good}} + 10^{-6}\\,\\right],\n$$\n当且仅当从不良初始猜测开始的SCF序列收敛到了一个比从良好初始猜测获得的能量更高的稳态（激发）平均场态时，该值为真。所有能量单位均应理解为Hartree。\n\n测试套件（所有数值单位均为Hartree，所有未列出的双电子积分均为零）：\n\n- 测试用例1：\n  - 单电子矩阵\n    $$\n    h \\;=\\; \\begin{pmatrix}\n    -1.00 & -0.20 \\\\\n    -0.20 & -1.00\n    \\end{pmatrix}.\n    $$\n  - 非零双电子积分：\n    $$(11|11)=0.70,\\quad (22|22)=0.70,\\quad (11|22)=(22|11)=0.60,$$\n    $$(12|12)=(21|21)=0.20,\\quad (12|21)=(21|12)=0.20.$$\n\n- 测试用例2：\n  - 单电子矩阵\n    $$\n    h \\;=\\; \\begin{pmatrix}\n    -1.00 & -1.00 \\\\\n    -1.00 & -1.00\n    \\end{pmatrix}.\n    $$\n  - 非零双电子积分与测试用例1相同。\n\n- 测试用例3：\n  - 单电子矩阵\n    $$\n    h \\;=\\; \\begin{pmatrix}\n    -0.80 & -0.10 \\\\\n    -0.10 & -1.40\n    \\end{pmatrix}.\n    $$\n  - 非零双电子积分与测试用例1相同。\n\n角度单位不适用。要求的最终输出格式是单行包含一个Python字面量形式的列表，其中含有三个布尔值，按顺序对应于测试用例$1,2,3$，例如 `[True,False,True]`，精确打印为由方括号包围、并用逗号分隔布尔标记的单行文本。\n\n您的程序应产生单行输出，其中包含一个由方括号括起来的逗号分隔列表的结果（例如，`[r1,r2,r3]`）。", "solution": "所提出的问题是计算量子化学中的一个标准练习，具体涉及用于双电子、双轨道模型系统的限制性Hartree–Fock（RHF）自洽场（SCF）方法。该问题在科学上是合理的、定义明确的，并提供了所有必要的数据和方程。这是一个有效的问题。\n\nHartree-Fock方法是分子量子力学的基石，它为多电子薛定谔方程提供了一个近似解。它是一种平均场理论，其中每个电子被处理为在所有其他电子产生的平均静电场中运动，从而将一个复杂的多体问题转化为一组更易于处理的单电子问题。解是通过SCF程序迭代求得的。\n\n系统的状态由一个密度矩阵 $P \\in \\mathbb{R}^{2 \\times 2}$ 描述。对于一个包含$N=2$个电子的闭壳层系统，该矩阵由单个已占据分子轨道（MO）的系数 $C_{\\text{occ}} \\in \\mathbb{R}^{2 \\times 1}$ 构建，公式为 $P = 2 C_{\\text{occ}} C_{\\text{occ}}^{\\top}$。而MO系数又被确定为有效单电子算符——Fock算符的特征向量，该算符由Fock矩阵 $F$ 表示。关键点在于 $F$ 本身依赖于 $P$。这种相互依赖性导致了方程的非线性和自洽性。\n\n该问题的Fock矩阵由下式给出：\n$$\nF_{\\mu\\nu}(P) \\;=\\; h_{\\mu\\nu} \\;+\\; \\sum_{\\lambda,\\sigma=1}^{2} P_{\\lambda\\sigma} \\left[\\, (\\mu\\nu|\\lambda\\sigma) \\;-\\; \\tfrac{1}{2}\\,(\\mu\\lambda|\\nu\\sigma) \\,\\right]\n$$\n其中 $h$ 是单电子（核）哈密顿量，$(\\mu\\nu|\\lambda\\sigma)$ 是双电子排斥积分。利用提供的积分值——$(11|11)=0.7$, $(22|22)=0.7$, $(11|22)=0.6$, $(12|12)=0.2$, 和 $(12|21)=0.2$（均以Hartree为单位），并注意到诸如 $(12|21) = (12|12)$ 的对称性，我们可以推导出Fock矩阵的双电子部分 $G(P) = F(P) - h$ 的元素显式表达式。密度矩阵是对称的，$P_{12}=P_{21}$，且满足 $\\operatorname{Tr}(P)=2$，这意味着 $P_{22} = 2 - P_{11}$。\n\nFock矩阵 $F$ 的元素为：\n$F_{11} = h_{11} + G_{11}$，其中\n$G_{11} = \\frac{1}{2}P_{11}(11|11) + P_{22}\\left[(11|22) - \\frac{1}{2}(12|12)\\right] = 0.35 P_{11} + (2-P_{11})\\left[0.6 - \\frac{1}{2}(0.2)\\right] = 0.35 P_{11} + 1.0 - 0.5 P_{11} = 1.0 - 0.15 P_{11}$。\n所以，$F_{11}(P) = h_{11} + 1.0 - 0.15 P_{11}$。\n\n$F_{22} = h_{22} + G_{22}$，其中\n$G_{22} = P_{11}\\left[(22|11) - \\frac{1}{2}(21|21)\\right] + \\frac{1}{2}P_{22}(22|22) = P_{11}\\left[0.6 - \\frac{1}{2}(0.2)\\right] + \\frac{1}{2}(2-P_{11})(0.7) = 0.5 P_{11} + 0.7 - 0.35 P_{11} = 0.7 + 0.15 P_{11}$。\n所以，$F_{22}(P) = h_{22} + 0.7 + 0.15 P_{11}$。\n\n$F_{12} = h_{12} + G_{12}$，其中\n$G_{12} = P_{12}\\left[(12|12) - \\frac{1}{2}(11|22)\\right] + P_{21}\\left[(12|21)-\\frac{1}{2}(12|21)\\right]$。由于 $P_{12}=P_{21}$ 且 $(12|21)=(12|12)=0.2$：\n$G_{12} = P_{12}\\left[ (12|12) - \\frac{1}{2}(11|22) + \\frac{1}{2}(12|21) \\right] = P_{12}\\left[ 0.2 - \\frac{1}{2}(0.6) + \\frac{1}{2}(0.2) \\right] = P_{12}[0.2 - 0.3 + 0.1] = 0$。\n因此，值得注意的是，对于这组特定的积分，$F_{12}(P) = h_{12}$。\n\nSCF过程是寻找密度矩阵不动点的迭代算法：\n1.  从密度矩阵的初始猜测 $P^{(0)}$ 开始。\n2.  在第 $k$ 次迭代中，使用推导出的表达式构建Fock矩阵 $F^{(k)} = F(P^{(k)})$。\n3.  求解对称矩阵 $F^{(k)}$ 的特征值问题：$F^{(k)}C = CE$。特征向量即为MO系数。\n4.  选择与最低特征值对应的特征向量 $C_{\\text{occ}}$。这是我们$N=2$电子体系的已占据MO。\n5.  构建新的密度矩阵：$P^{(k+1)} = 2 C_{\\text{occ}} C_{\\text{occ}}^{\\top}$。\n6.  通过比较 $P^{(k+1)}$ 和 $P^{(k)}$ 来检查收敛性。一个常见的标准是差的Frobenius范数 $\\|P^{(k+1)} - P^{(k)}\\|_F$ 小于一个很小的容差（例如，$10^{-9}$）。\n7.  如果未收敛，则设置 $P^{(k)} \\leftarrow P^{(k+1)}$ 并返回步骤2。\n\nSCF方程的非线性意味着可能存在多个稳态解。这些解对应于迭代映射的不同不动点。获得的解取决于初始猜测 $P^{(0)}$。一个“良好”的猜测，通常源自忽略电子-电子排斥的核心哈密顿量 $h$，很可能收敛到全局能量最低态（基态）。一个“不良”的猜测，可能远离基态构型，可以收敛到一个不同的局部最小值，对应于平均场体系的一个激发态。\n\n该问题要求我们对三个测试用例进行探索，使用两种不同的初始猜测：\n-   $P^{(0)}_{\\text{good}}$：由核心哈密顿量 $h$ 的最低能量特征向量构成。这代表一个有物理动机的出发点。\n-   $P^{(0)}_{\\text{poor}}$：手动设置为将两个电子都定域在第二个原子轨道上，即 $P^{(0)}_{\\text{poor}} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 2 \\end{pmatrix}$。\n\n对每个测试用例，我们执行两次SCF计算直至收敛，得到能量 $E_{\\text{good}}$ 和 $E_{\\text{poor}}$。在收敛密度 $P^{\\star}$ 处的总能量计算为 $E(P^{\\star}) = \\frac{1}{2}\\operatorname{Tr}[(h+F(P^{\\star}))P^{\\star}]$。然后我们通过检查 $E_{\\text{poor}} > E_{\\text{good}} + 10^{-6}$ 来确定不良猜测是否收敛到了一个更高能量的激发态，其中小的容差考虑了当两者收敛到同一状态时可能存在的微小数值差异。\n\n实现将包含一个函数，该函数为给定的哈密顿量和初始密度执行SCF循环直至收敛。对于指定的三个测试用例中的每一个，都将为两种猜测类型调用此函数。然后收集并打印布尔结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the SCF calculations for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Test Case 1\n        {'h': np.array([[-1.00, -0.20],\n                        [-0.20, -1.00]], dtype=np.float64)},\n        # Test Case 2\n        {'h': np.array([[-1.00, -1.00],\n                        [-1.00, -1.00]], dtype=np.float64)},\n        # Test Case 3\n        {'h': np.array([[-0.80, -0.10],\n                        [-0.10, -1.40]], dtype=np.float64)},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        h_matrix = case['h']\n\n        # --- Good Guess Run ---\n        # Get eigenvector of h for lowest eigenvalue\n        _, eigvecs = np.linalg.eigh(h_matrix)\n        c_min = eigvecs[:, 0].reshape(-1, 1)\n        p_good_initial = 2.0 * (c_min @ c_min.T)\n        e_good, _ = run_scf(h_matrix, p_good_initial)\n\n        # --- Poor Guess Run ---\n        p_poor_initial = np.array([[0.0, 0.0],\n                                   [0.0, 2.0]], dtype=np.float64)\n        e_poor, _ = run_scf(h_matrix, p_poor_initial)\n\n        # --- Comparison ---\n        is_excited = e_poor > (e_good + 1e-6)\n        results.append(is_excited)\n\n    # Final print statement in the exact required format.\n    # The problem requires python literal booleans, so map to str(True/False)\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef build_fock_matrix(h_matrix, p_matrix):\n    \"\"\"\n    Builds the Fock matrix F(P) for the given 2x2 problem.\n    The expressions are simplified based on the constant two-electron integrals.\n    F_11 = h_11 + 1.0 - 0.15 * P_11\n    F_22 = h_22 + 0.7 + 0.15 * P_11\n    F_12 = h_12\n    \"\"\"\n    p11 = p_matrix[0, 0]\n    \n    f_matrix = np.copy(h_matrix)\n    f_matrix[0, 0] += 1.0 - 0.15 * p11\n    f_matrix[1, 1] += 0.7 + 0.15 * p11\n    \n    return f_matrix\n\ndef calculate_energy(h_matrix, f_matrix, p_matrix):\n    \"\"\"\n    Calculates the total electronic energy.\n    E = 0.5 * Tr((h + F) * P)\n    \"\"\"\n    return 0.5 * np.trace((h_matrix + f_matrix) @ p_matrix)\n\ndef run_scf(h_matrix, p_initial, max_iter=100, tol=1e-9):\n    \"\"\"\n    Performs the Self-Consistent Field (SCF) iteration.\n\n    Args:\n        h_matrix (np.ndarray): The 2x2 one-electron (core) Hamiltonian.\n        p_initial (np.ndarray): The 2x2 initial guess for the density matrix.\n        max_iter (int): Maximum number of SCF iterations.\n        tol (float): Convergence tolerance for the density matrix norm.\n\n    Returns:\n        tuple[float, np.ndarray]: A tuple containing the final converged energy\n                                 and the final converged density matrix.\n    \"\"\"\n    p_current = p_initial\n    \n    for i in range(max_iter):\n        # 1. Build Fock matrix\n        f_current = build_fock_matrix(h_matrix, p_current)\n        \n        # 2. Diagonalize Fock matrix\n        # eigh returns eigenvalues in ascending order and corresponding eigenvectors in columns\n        eigvals, eigvecs = np.linalg.eigh(f_current)\n        \n        # 3. Get occupied MO coefficients (eigenvector for lowest eigenvalue)\n        c_occ = eigvecs[:, 0].reshape(-1, 1) # Ensure it's a column vector\n        \n        # 4. Form new density matrix\n        p_new = 2.0 * (c_occ @ c_occ.T)\n        \n        # 5. Check for convergence\n        diff_norm = np.linalg.norm(p_new - p_current)\n        if diff_norm  tol:\n            break\n            \n        # 6. Update density matrix for next iteration\n        p_current = p_new\n        \n    # After convergence, calculate final energy with the converged density\n    p_final = p_current\n    f_final = build_fock_matrix(h_matrix, p_final)\n    energy_final = calculate_energy(h_matrix, f_final, p_final)\n    \n    return energy_final, p_final\n\nsolve()\n```", "id": "2463815"}]}