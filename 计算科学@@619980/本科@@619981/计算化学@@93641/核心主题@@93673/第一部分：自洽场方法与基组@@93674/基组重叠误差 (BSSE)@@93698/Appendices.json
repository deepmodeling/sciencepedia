{"hands_on_practices": [{"introduction": "我们从对销校正法的一个基本应用开始。我们将通过假设地将氮气分子（$N_2$）视为两个氮原子组成的二聚体，来计算其分子内基组叠加误差（BSSE）。这个练习展示了 Boys-Bernardi 公式的直接应用，并清晰地说明了 BSSE 是如何随着基组质量的提高而减小的，这是计算化学中的一个核心原则。[@problem_id:2450830]", "problem": "给你一个基组重叠误差（BSSE）的正式定义，以及一组通过衡消方法计算双氮分子 $\\mathrm{N}_2$（将每个氮原子视为一个单体）BSSE 所需的总能量。当用于描述分子复合物的基组允许每个单体通过使用以其他单体为中心的基函数来降低其自身能量时，就会产生基组重叠误差（BSSE）。根据 Boys–Bernardi 衡消定义，对于由单体 $A$ 和 $B$ 组成的二聚体，BSSE 的大小是每个单体在二聚体基组中（在伙伴原子上带有鬼函数）计算时相对于其自身孤立基组所产生的人为能量降低之和，即\n$$\n\\mathrm{BSSE} \\equiv \\left(E_A^{A} - E_A^{AB}\\right) + \\left(E_B^{B} - E_B^{AB}\\right),\n$$\n其中，$E_A^{A}$ 是在单体 $A$ 自身基组中计算得到的总能量，$E_B^{B}$ 是在单体 $B$ 自身基组中计算得到的总能量，$E_A^{AB}$ 是在二聚体基组中（在 $B$ 上有鬼轨道）计算得到的单体 $A$ 的总能量，而 $E_B^{AB}$ 对单体 $B$ 的定义与此类似。本问题中所有能量均以哈特里（原子单位）表示。你还必须使用转换因子 $1\\,\\mathrm{Hartree} = 2625.50\\,\\mathrm{kJ\\,mol^{-1}}$ 将 BSSE 表示为千焦/摩尔。\n\n任务：对于下方的每个测试用例，使用上述定义计算BSSE的大小，单位分别为哈特里和 $\\mathrm{kJ\\,mol^{-1}}$。除非数值明确暗示，否则不要假定任何对称性。为每个测试用例提供的能量集是自洽的，对应于在固定几何构型下，使用不同质量的基组对 $\\mathrm{N}_2$ 进行的计算；由于基组的差异，不同用例的absolute值可能有所不同。\n\n测试套件（每一项都是一个以哈特里为单位的四元组 $(E_A^{A}, E_B^{B}, E_A^{AB}, E_B^{AB})$）：\n- 用例 1（代表最小基组）：$(-54.400000,\\,-54.400000,\\,-54.406000,\\,-54.406000)$。\n- 用例 2（代表带轻微数值不对称性的裂价基组）：$(-54.500000,\\,-54.500000,\\,-54.502000,\\,-54.501500)$。\n- 用例 3（代表带弥散函数的三ζ基组）：$(-54.600000,\\,-54.600000,\\,-54.600300,\\,-54.600300)$。\n- 用例 4（无重叠误差的边缘用例）：$(-54.600000,\\,-54.600000,\\,-54.600000,\\,-54.600000)$。\n\n不涉及角度单位。不涉及百分比。\n\n最终输出格式：你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个结果本身是一个双元素列表 $[\\mathrm{BSSE_{Ha}},\\mathrm{BSSE_{kJ/mol}}]$。对两个值均使用定点格式，小数点后精确到 $6$ 位，并且输出中不包含任何空格。例如，整体形式必须是\n$$\n\\big[\\,[x_1,y_1],[x_2,y_2],\\ldots\\big],\n$$\n其中，每个 $x_i$ 是第 $i$ 个测试用例以哈特里为单位的 BSSE，每个 $y_i$ 是以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的 BSSE。", "solution": "该问题陈述已经过严格验证，被认为是科学上合理、提法明确且完整的。所有提供的数据，包括基组重叠误差（BSSE）的定义、能量值和转换因子，都与计算量子化学的既定原理相符。该任务是基本公式的直接应用。因此，将提供一个解决方案。\n\n该问题涉及基组重叠误差（BSSE）的计算，这是一种在对分子复合物进行量子化学计算时，由于使用有限（因此不完备）的原子轨道基组而产生的人为误差。复合物中单体（例如子系统 $A$）的能量可能被人为地降低，因为其波函数可以通过利用以其伙伴（子系统 $B$）为中心的基函数来改进其变分描述。为了获得准确的相互作用能，必须对此非物理的稳定化进行校正。\n\nBoys and Bernardi 的衡消方法提供了一个估计此误差的标准程序。二聚体 $AB$ 的 BSSE 大小被定义为：与各自以单体为中心的基组相比，当每个单体在完整的二聚体基组中计算时，其能量降低量的总和。提供的公式为：\n$$\n\\mathrm{BSSE} \\equiv \\left(E_A^{A} - E_A^{AB}\\right) + \\left(E_B^{B} - E_B^{AB}\\right)\n$$\n在这里，$E_X^Y$ 表示使用与体系 $Y$ 相关的基组计算得到的体系 $X$ 的能量。具体而言：\n- $E_A^{A}$ 是单体 $A$ 在其自身基组中的能量。\n- $E_A^{AB}$ 是单体 $A$ 在 $A$ 和 $B$ 单体的组合基组中的能量（其中 $B$ 的基函数是“鬼”轨道，即没有原子核或电子的基函数）。\n根据变分原理，$E_A^{AB} \\le E_A^{A}$ 且 $E_B^{AB} \\le E_B^{B}$，这确保了 BSSE 是一个非负量。\n\n将对每个提供的测试用例，使用给定公式和转换因子 $1\\,\\mathrm{Hartree} = 2625.50\\,\\mathrm{kJ\\,mol^{-1}}$ 执行计算。所有能量单位均为哈特里（Ha）。\n\n**用例 1：**\n给定能量：$(E_A^{A}, E_B^{B}, E_A^{AB}, E_B^{AB}) = (-54.400000, -54.400000, -54.406000, -54.406000)$。\n以哈特里为单位的 BSSE 是：\n$$\n\\mathrm{BSSE_{Ha}} = (-54.400000 - (-54.406000)) + (-54.400000 - (-54.406000))\n$$\n$$\n\\mathrm{BSSE_{Ha}} = 0.006000 + 0.006000 = 0.012000\\,\\mathrm{Ha}\n$$\n以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的 BSSE 是：\n$$\n\\mathrm{BSSE_{kJ/mol}} = 0.012000 \\times 2625.50 = 31.506000\\,\\mathrm{kJ\\,mol^{-1}}\n$$\n\n**用例 2：**\n给定能量：$(E_A^{A}, E_B^{B}, E_A^{AB}, E_B^{AB}) = (-54.500000, -54.500000, -54.502000, -54.501500)$。\n以哈特里为单位的 BSSE 是：\n$$\n\\mathrm{BSSE_{Ha}} = (-54.500000 - (-54.502000)) + (-54.500000 - (-54.501500))\n$$\n$$\n\\mathrm{BSSE_{Ha}} = 0.002000 + 0.001500 = 0.003500\\,\\mathrm{Ha}\n$$\n以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的 BSSE 是：\n$$\n\\mathrm{BSSE_{kJ/mol}} = 0.003500 \\times 2625.50 = 9.189250\\,\\mathrm{kJ\\,mol^{-1}}\n$$\n该用例显示出单体稳定化中的轻微不对称性，即使对于对称分子，如果在数值计算中未强制执行对称性约束，这种情况也是可能发生的。\n\n**用例 3：**\n给定能量：$(E_A^{A}, E_B^{B}, E_A^{AB}, E_B^{AB}) = (-54.600000, -54.600000, -54.600300, -54.600300)$。\n以哈特里为单位的 BSSE 是：\n$$\n\\mathrm{BSSE_{Ha}} = (-54.600000 - (-54.600300)) + (-54.600000 - (-54.600300))\n$$\n$$\n\\mathrm{BSSE_{Ha}} = 0.000300 + 0.000300 = 0.000600\\,\\mathrm{Ha}\n$$\n以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的 BSSE 是：\n$$\n\\mathrm{BSSE_{kJ/mol}} = 0.000600 \\times 2625.50 = 1.575300\\,\\mathrm{kJ\\,mol^{-1}}\n$$\n正如预期的那样，与用例1和2中较不完备的基组相比，更高质量的基组（由更低的绝对能量和“三ζ”的描述所暗示）导致了更小的BSSE。\n\n**用例 4：**\n给定能量：$(E_A^{A}, E_B^{B}, E_A^{AB}, E_B^{AB}) = (-54.600000, -54.600000, -54.600000, -54.600000)$。\n以哈特里为单位的 BSSE 是：\n$$\n\\mathrm{BSSE_{Ha}} = (-54.600000 - (-54.600000)) + (-54.600000 - (-54.600000))\n$$\n$$\n\\mathrm{BSSE_{Ha}} = 0.000000 + 0.000000 = 0.000000\\,\\mathrm{Ha}\n$$\n以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的 BSSE 是：\n$$\n\\mathrm{BSSE_{kJ/mol}} = 0.000000 \\times 2625.50 = 0.000000\\,\\mathrm{kJ\\,mol^{-1}}\n$$\n这个边缘用例正确地代表了完备基组的理论极限，在该极限下，添加“鬼”函数不提供额外的变分灵活性，因此 BSSE 恒等于零。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Basis Set Superposition Error (BSSE) for a series of test cases.\n    \"\"\"\n    # Define the conversion factor from Hartree to kJ/mol.\n    HARTREE_TO_KJ_MOL = 2625.50\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (E_A^A, E_B^B, E_A^AB, E_B^AB) in Hartree.\n    test_cases = [\n        # Case 1 (representative of a minimal basis)\n        (-54.400000, -54.400000, -54.406000, -54.406000),\n        # Case 2 (representative of a split-valence basis with slight numerical asymmetry)\n        (-54.500000, -54.500000, -54.502000, -54.501500),\n        # Case 3 (representative of a triple-zeta basis with diffuse functions)\n        (-54.600000, -54.600000, -54.600300, -54.600300),\n        # Case 4 (edge case with no superposition error)\n        (-54.600000, -54.600000, -54.600000, -54.600000),\n    ]\n\n    results_as_strings = []\n    for case in test_cases:\n        e_a_a, e_b_b, e_a_ab, e_b_ab = case\n\n        # Calculate the energy stabilization for each monomer.\n        # By the variational principle, this difference is non-negative.\n        delta_e_a = e_a_a - e_a_ab\n        delta_e_b = e_b_b - e_b_ab\n\n        # The total BSSE is the sum of the stabilizations for each monomer in Hartree.\n        bsse_ha = delta_e_a + delta_e_b\n\n        # Convert the BSSE from Hartree to kJ/mol.\n        bsse_kj_mol = bsse_ha * HARTREE_TO_KJ_MOL\n\n        # Format the result for the current case as a string \"[val1,val2]\"\n        # with exactly 6 digits after the decimal point and no spaces.\n        case_result_str = f\"[{bsse_ha:.6f},{bsse_kj_mol:.6f}]\"\n        results_as_strings.append(case_result_str)\n\n    # Join all formatted case results into a single comma-separated string,\n    # enclosed in square brackets.\n    final_output_string = f\"[{','.join(results_as_strings)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "2450830"}, {"introduction": "在学习了基本计算之后，我们现在来探讨一种 BSSE 会产生巨大影响的情景。本练习将研究一个氢键连接的水二聚体，其两个分子所用的基组质量存在极端不平衡。通过比较原始相互作用能与对销校正后的能量，您将看到 BSSE 如何人为地制造出强烈的、具有误导性的吸引力，从而突显出这种校正对于获得有物理意义的结果是何等重要。[@problem_id:2450800]", "problem": "你将分析一个有意设置为不平衡的氢键水二聚体中的基组叠加误差（Basis Set Superposition Error, BSSE）：其中一个单体使用大而弥散的基组（增广的相关一致性极化价层四Zeta基组），另一个单体使用最小基组（用三个高斯函数拟合的斯莱特型轨道）。当复合物中的单体通过“借用”彼此的基函数而被人为地稳定化时，就会产生基组叠加误差（BSSE）。对构（Counterpoise, CP）校正通过在完整的二聚体基组中计算每个单体的能量来补偿这种效应，此时其伴侣单体的原子核被替换为不相互作用的“鬼”中心，这些中心提供基函数但不提供电子或原子核。\n\n定义以下总电子能量，所有能量均以原子单位制中的能量单位哈特里（Hartree）表示，并将使用大基组的水分子记为单体 A，使用最小基组的水分子记为单体 B：\n- 在完整二聚体基组中的二聚体能量：$E_{AB}^{(AB)}$。\n- 在各自基组中的单体能量：$E_{A}^{(A)}$ 和 $E_{B}^{(B)}$。\n- 在完整二聚体基组中，伴侣单体仅作为鬼基组函数存在时的单体能量：$E_{A}^{(AB)}$ 和 $E_{B}^{(AB)}$。\n\n对于每个测试用例，计算以下量，单位均为哈特里：\n1. 原始相互作用能 $\\,\\Delta E_{\\text{raw}} = E_{AB}^{(AB)} - E_{A}^{(A)} - E_{B}^{(B)}\\,$。\n2. BSSE 的大小，定义为一个正值：\n$$\n\\text{BSSE} = \\left(E_{A}^{(A)} - E_{A}^{(AB)}\\right) + \\left(E_{B}^{(B)} - E_{B}^{(AB)}\\right)\n$$\n3. 经对构校正的相互作用能\n$$\n\\Delta E_{\\text{CP}} = E_{AB}^{(AB)} - E_{A}^{(AB)} - E_{B}^{(AB)}.\n$$\n4. 一个布尔标志，当且仅当 $\\,\\Delta E_{\\text{CP}} > \\Delta E_{\\text{raw}}\\,$ 时为真。\n\n所有能量均以哈特里表示，无需单位换算。布尔值必须是语言原生的布尔常量。不涉及角度或百分比。\n\n使用以下测试套件，每行列出 $\\big(E_{AB}^{(AB)}, E_{A}^{(A)}, E_{B}^{(B)}, E_{A}^{(AB)}, E_{B}^{(AB)}\\big)$ 的值（单位为哈特里）：\n- 测试 1（极端不平衡，最小基组单体发生强烈“借用”）：\n  $\\big(-152.0520,\\,-76.0570,\\,-75.9830,\\,-76.0600,\\,-76.0100\\big)$。\n- 测试 2（平衡参考，构造上无 BSSE）：\n  $\\big(-152.0700,\\,-76.0500,\\,-76.0100,\\,-76.0500,\\,-76.0100\\big)$。\n- 测试 3（净 BSSE 很小，存在轻微数值异常）：\n  $\\big(-152.0340,\\,-76.0400,\\,-75.9900,\\,-76.0398,\\,-75.9906\\big)$。\n- 测试 4（极端不平衡，BSSE 超过了原始吸引力）：\n  $\\big(-152.0180,\\,-76.0570,\\,-75.9500,\\,-76.0605,\\,-75.9800\\big)$。\n\n你的程序不应读取任何输入，并应按上述顺序为每个测试计算列表\n$[\\Delta E_{\\text{raw}},\\, \\text{BSSE},\\, \\Delta E_{\\text{CP}},\\, \\text{flag}]$。\n你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，其中每个元素是对应一个测试用例的列表，并按顺序排列。例如：\n“[[x11,x12,x13,x14],[x21,x22,x23,x24],...]”，其中 $x_{ij}$ 是上面定义的以哈特里为单位的量，布尔值是未加引号的语言原生布尔字面量。", "solution": "问题陈述已提交以供验证。该问题被认定为有效。它有科学依据，提法恰当且客观。它提出了一个关于基组叠加误差（BSSE）的计算量子化学标准练习。所有提供的定义和数据都是自洽、一致的，并且足以得到唯一解。\n\n核心概念是基组叠加误差，这是一种在使用不完备的、以原子为中心的基组计算分子间相互作用能时出现的人为误差。根据变分原理，为一个系统计算出的基态能量是其真实基态能量的上界。一个更灵活的基组（即拥有更多基函数的基组）可以更好地近似真实的波函数，从而得到更低、更准确的能量。在一个分子复合物中，一个单体可以通过“借用”邻近单体的基函数来改善自身的描述，这是一种非物理效应，会导致人为的稳定化。由 Boys 和 Bernardi 提出的对构（CP）校正是修正此误差的标准方法。\n\n该问题为一个双单体系统 A 和 B 定义了五个能量分量：\n- $E_{AB}^{(AB)}$：二聚体 $AB$ 的总能量，其中所有原子都使用其自身的基函数。\n- $E_{A}^{(A)}$ 和 $E_{B}^{(B)}$：孤立单体 $A$ 和 $B$ 的能量，每个都在仅有自身基组的情况下计算。\n- $E_{A}^{(AB)}$ 和 $E_{B}^{(AB)}$：单体 $A$ 和 $B$ 各自的能量，在伴侣单体的基函数以“鬼”原子（原子核和电子被移除）为中心存在的情况下计算。\n\n变分原理规定 $E_{A}^{(AB)} \\le E_{A}^{(A)}$ 且 $E_{B}^{(AB)} \\le E_{B}^{(B)}$，因为基组 $(AB)$ 是基组 $(A)$ 和 $(B)$ 各自的超集。增加更多的基函数只会使能量降低或保持不变。测试用例 3 出现了一个轻微的异常，其中 $E_{A}^{(AB)} = -76.0398 > E_{A}^{(A)} = -76.0400$。这是对变分原理的轻微违背，很可能是由于底层量子化学计算中使用的不同收敛阈值或积分格点所产生的可忽略的数值噪音，这在实践中很常见。它并不会使问题本身的逻辑失效。\n\n需要计算的量是：\n$1$. 原始相互作用能，$\\Delta E_{\\text{raw}} = E_{AB}^{(AB)} - E_{A}^{(A)} - E_{B}^{(B)}$。该量错误地将完全稳定的二聚体与稳定性较差的孤立单体进行比较，因此会高估相互作用强度。\n\n$2$. 基组叠加误差，$\\text{BSSE}$。问题将其定义为一个正值大小：\n$$\n\\text{BSSE} = \\left(E_{A}^{(A)} - E_{A}^{(AB)}\\right) + \\left(E_{B}^{(B)} - E_{B}^{(AB)}\\right)\n$$\n这可以重写为 $(E_{A}^{(A)} - E_{A}^{(AB)}) + (E_{B}^{(B)} - E_{B}^{(AB)})$。每一项 $(E_{M}^{(M)} - E_{M}^{(MN)})$ 代表单体 $M$ 通过借用单体 $N$ 的基函数而获得的稳定化能。根据变分原理，这些项是非负的，所以 BSSE 也是非负的。\n\n$3$. 经对构校正的相互作用能，$\\Delta E_{\\text{CP}} = E_{AB}^{(AB)} - E_{A}^{(AB)} - E_{B}^{(AB)}$。这代表了更具物理意义的相互作用能，因为片段的能量是在与二聚体本身相同的基组（完整的二聚体基组）中计算的，从而抵消了人为的稳定化效应。\n\n这些量之间存在一个重要的关系。通过代入定义，可以很容易地证明：\n$$\n\\Delta E_{\\text{CP}} = \\Delta E_{\\text{raw}} + \\text{BSSE}\n$$\n$$\nE_{AB}^{(AB)} - E_{A}^{(AB)} - E_{B}^{(AB)} = \\big(E_{AB}^{(AB)} - E_{A}^{(A)} - E_{B}^{(B)}\\big) + \\big( (E_{A}^{(A)} - E_{A}^{(AB)}) + (E_{B}^{(B)} - E_{B}^{(AB)}) \\big)\n$$\n右侧的各项相互抵消，得到左侧的表达式，从而证实了该恒等式。\n\n$4$. 布尔标志。该标志的条件是 $\\Delta E_{\\text{CP}} > \\Delta E_{\\text{raw}}$。使用上面推导的恒等式，这等价于 $\\Delta E_{\\text{raw}} + \\text{BSSE} > \\Delta E_{\\text{raw}}$，可简化为 $\\text{BSSE} > 0$。因此，当且仅当存在非零的基组叠加误差时，该标志为真。对于任何不完备的基组，情况都是如此。在理想化的测试用例 2 中，根据构造 BSSE 为零，所以标志为 `False`。对于所有其他情况，我们预期会得到一个正的 BSSE 和一个 `True` 标志。\n\n算法步骤是遍历每个测试用例，将给定的五个能量值代入四个公式中，然后组合结果。\n\n对于测试用例 $1$ $\\big(E_{AB}^{(AB)}, E_{A}^{(A)}, E_{B}^{(B)}, E_{A}^{(AB)}, E_{B}^{(AB)}\\big) = \\big(-152.0520, -76.0570, -75.9830, -76.0600, -76.0100\\big)$：\n- $\\Delta E_{\\text{raw}} = -152.0520 - (-76.0570 - 75.9830) = -0.0120$ 哈特里。\n- $\\text{BSSE} = (-76.0570 - (-76.0600)) + (-75.9830 - (-76.0100)) = 0.0300$ 哈特里。\n- $\\Delta E_{\\text{CP}} = -152.0520 - (-76.0600 - 76.0100) = 0.0180$ 哈特里。\n- 标志：$0.0180 > -0.0120$ 为真。\n\n正如下面的程序所实现的，对所有测试用例重复此计算。结果证明了 CP 校正的重要性；例如，在测试用例 4 中，一个看起来具有吸引力的相互作用（$\\Delta E_{\\text{raw}} = -0.0110$ 哈特里）在去除了较大的 BSSE 后，被揭示为是排斥性的（$\\Delta E_{\\text{CP}} = 0.0225$ 哈特里）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are needed for this problem.\n\ndef solve():\n    \"\"\"\n    Solves the Basis Set Superposition Error (BSSE) problem for a given suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (E_AB^(AB), E_A^(A), E_B^(B), E_A^(AB), E_B^(AB)) in Hartree.\n    test_cases = [\n        # Test 1 (extreme imbalance, strong borrowing by the minimal-basis monomer)\n        (-152.0520, -76.0570, -75.9830, -76.0600, -76.0100),\n        # Test 2 (balanced reference, no BSSE by construction)\n        (-152.0700, -76.0500, -76.0100, -76.0500, -76.0100),\n        # Test 3 (small net BSSE with a slight numerical anomaly)\n        (-152.0340, -76.0400, -75.9900, -76.0398, -75.9906),\n        # Test 4 (extreme imbalance, BSSE overwhelms the raw attraction)\n        (-152.0180, -76.0570, -75.9500, -76.0605, -75.9800),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        E_AB_AB, E_A_A, E_B_B, E_A_AB, E_B_AB = case\n\n        # 1. Compute the raw interaction energy, delta_E_raw\n        # delta_E_raw = E_AB^(AB) - E_A^(A) - E_B^(B)\n        delta_E_raw = E_AB_AB - (E_A_A + E_B_B)\n\n        # 2. Compute the BSSE magnitude\n        # BSSE = (E_A^(A) - E_A^(AB)) + (E_B^(B) - E_B^(AB))\n        bsse = (E_A_A - E_A_AB) + (E_B_B - E_B_AB)\n\n        # 3. Compute the Counterpoise-corrected interaction energy, delta_E_CP\n        # delta_E_CP = E_AB^(AB) - E_A^(AB) - E_B^(AB)\n        delta_E_cp = E_AB_AB - (E_A_AB + E_B_AB)\n\n        # As a verification, delta_E_CP should equal delta_E_raw + BSSE\n        # For floating point numbers, it's better to check for near equality,\n        # but the identity is exact and inputs are well-behaved here.\n        # assert np.isclose(delta_E_cp, delta_E_raw + bsse)\n\n        # 4. Compute the boolean flag\n        # flag = True if delta_E_CP > delta_E_raw\n        flag = delta_E_cp > delta_E_raw\n\n        # Append the list of results for this test case\n        # np.round is used to handle potential floating point inaccuracies from subtraction,\n        # ensuring clean output matching manual calculations.\n        # A precision of 6 decimal places is sufficient for these values.\n        result_list = [\n            np.round(delta_E_raw, 6),\n            np.round(bsse, 6),\n            np.round(delta_E_cp, 6),\n            flag\n        ]\n        all_results.append(result_list)\n\n    # Format the final output string exactly as specified.\n    # Each sublist is converted to a string, removing spaces.\n    # The list of these strings is joined by commas.\n    # The final result is enclosed in brackets.\n    sublist_strings = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output = f\"[{','.join(sublist_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2450800"}, {"introduction": "现在，我们将我们的理解应用到一个常见的化学问题上：确定构象稳定性。这个练习将探究 BSSE 对乙烷旋转能垒的影响，其中乙烷分子被分割成两个甲基自由基。这个案例研究表明，BSSE 不仅限于分子间相互作用，它还能显著影响计算出的分子内性质，如构象能量差，有时甚至会改变对哪个构象更稳定的定性预测。[@problem_id:2450842]", "problem": "考虑乙烷分子 $\\mathrm{C_2H_6}$ 分裂成两个甲基自由基 $\\mathrm{CH_3}$ 和 $\\mathrm{CH_3}$。设在给定构象 $X \\in \\{\\text{重叠式}, \\text{交错式}\\}$ 下，使用所有原子的完整基组计算得到的总电子能量记为 $E_{X}^{AB}$（单位为 Hartree, $\\mathrm{E_h}$）。对于每个构象 $X$，设 $E_{A,X}^{A}$ 和 $E_{B,X}^{B}$ 是仅使用其自身片段基组计算的单体能量（$\\mathrm{CH_3}$ 片段分别标记为 $A$ 和 $B$），并设 $E_{A,X}^{AB}$ 和 $E_{B,X}^{AB}$ 是在另一个片段的基函数（被视作只有基函数的“鬼原子”）存在的情况下，在构象 $X$ 的几何结构下计算得到的相应单体能量，所有能量单位均为 Hartree, $\\mathrm{E_h}$。构象 $X$ 的基组重叠误差 (Basis Set Superposition Error, BSSE) 定义为一个正的校正值：\n$$\n\\mathrm{BSSE}_X = \\left(E_{A,X}^{A} - E_{A,X}^{AB}\\right) + \\left(E_{B,X}^{B} - E_{B,X}^{AB}\\right),\n$$\n经过BSSE校正的总能量为\n$$\nE_{X}^{\\mathrm{corr}} = E_{X}^{AB} + \\mathrm{BSSE}_X.\n$$\n将未校正的构象能量差（重叠式减去交错式）定义为\n$$\n\\Delta E_{\\mathrm{uncorr}} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB},\n$$\n将经过BSSE校正的构象能量差定义为\n$$\n\\Delta E_{\\mathrm{corr}} = E_{\\mathrm{eclipsed}}^{\\mathrm{corr}} - E_{\\mathrm{staggered}}^{\\mathrm{corr}}.\n$$\n\n使用以下包含三个案例（$3$ 组不同的能量）的测试套件，为每个案例计算 $\\Delta E_{\\mathrm{uncorr}}$ 和 $\\Delta E_{\\mathrm{corr}}$。所有能量的单位均为 Hartree, $\\mathrm{E_h}$。\n\n测试套件：\n- 案例 1：\n  - $E_{\\mathrm{eclipsed}}^{AB} = -79.255000$, $E_{\\mathrm{staggered}}^{AB} = -79.256200$.\n  - $E_{A,\\mathrm{eclipsed}}^{A} = -39.700000$, $E_{B,\\mathrm{eclipsed}}^{B} = -39.700000$.\n  - $E_{A,\\mathrm{eclipsed}}^{AB} = -39.701000$, $E_{B,\\mathrm{eclipsed}}^{AB} = -39.701100$.\n  - $E_{A,\\mathrm{staggered}}^{A} = -39.700100$, $E_{B,\\mathrm{staggered}}^{B} = -39.700100$.\n  - $E_{A,\\mathrm{staggered}}^{AB} = -39.701000$, $E_{B,\\mathrm{staggered}}^{AB} = -39.701000$.\n- 案例 2：\n  - $E_{\\mathrm{eclipsed}}^{AB} = -79.250000$, $E_{\\mathrm{staggered}}^{AB} = -79.251000$.\n  - $E_{A,\\mathrm{eclipsed}}^{A} = -39.690000$, $E_{B,\\mathrm{eclipsed}}^{B} = -39.690000$.\n  - $E_{A,\\mathrm{eclipsed}}^{AB} = -39.690750$, $E_{B,\\mathrm{eclipsed}}^{AB} = -39.690750$.\n  - $E_{A,\\mathrm{staggered}}^{A} = -39.690500$, $E_{B,\\mathrm{staggered}}^{B} = -39.690500$.\n  - $E_{A,\\mathrm{staggered}}^{AB} = -39.691250$, $E_{B,\\mathrm{staggered}}^{AB} = -39.691250$.\n- 案例 3：\n  - $E_{\\mathrm{eclipsed}}^{AB} = -79.260000$, $E_{\\mathrm{staggered}}^{AB} = -79.260300$.\n  - $E_{A,\\mathrm{eclipsed}}^{A} = -39.695000$, $E_{B,\\mathrm{eclipsed}}^{B} = -39.695000$.\n  - $E_{A,\\mathrm{eclipsed}}^{AB} = -39.695500$, $E_{B,\\mathrm{eclipsed}}^{AB} = -39.695500$.\n  - $E_{A,\\mathrm{staggered}}^{A} = -39.695100$, $E_{B,\\mathrm{staggered}}^{B} = -39.695100$.\n  - $E_{A,\\mathrm{staggered}}^{AB} = -39.695850$, $E_{B,\\mathrm{staggered}}^{AB} = -39.695850$.\n\n要求：\n- 对于每个案例，计算以 Hartree, $\\mathrm{E_h}$ 为单位的 $\\Delta E_{\\mathrm{uncorr}}$ 和 $\\Delta E_{\\mathrm{corr}}$。\n- 将每个数值结果以 Hartree, $\\mathrm{E_h}$ 为单位表示，并四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含结果，格式为列表的列表，具体格式如下\n  $$\n  \\big[\\,[\\Delta E_{\\mathrm{uncorr}}^{(1)},\\ \\Delta E_{\\mathrm{corr}}^{(1)}],\\ [\\Delta E_{\\mathrm{uncorr}}^{(2)},\\ \\Delta E_{\\mathrm{corr}}^{(2)}],\\ [\\Delta E_{\\mathrm{uncorr}}^{(3)},\\ \\Delta E_{\\mathrm{corr}}^{(3)}]\\,\\big]\n  $$\n  对应 $3$ 个案例，并以单行 Python 风格的列表字面量形式打印，例如 $[[0.000000,0.000000],[0.000000,0.000000],[0.000000,0.000000]]$。", "solution": "所提出的问题是有效的。它在科学上基于计算化学的原理，特别是针对基组重叠误差（BSSE）的抗衡校正方法。所有定义都是标准的，所有需要的数据都已提供，并且问题是适定的、客观的且逻辑上一致的。不存在矛盾或歧义。我们将着手推导解决方案。\n\n该问题要求针对三组不同的能量数据，计算乙烷的重叠式和交错式构象之间未校正和经过BSSE校正的构象能量差。问题的核心在于细致地应用所提供的公式。\n\n让我们为给定构象 $X \\in \\{\\text{重叠式}, \\text{交错式}\\}$ 定义各个量。\n二聚体（乙烷）的总能量为 $E_X^{AB}$。\n单体 $A$（一个 $\\mathrm{CH_3}$ 片段）在其自身基组中的能量为 $E_{A,X}^A$。\n单体 $B$（另一个 $\\mathrm{CH_3}$ 片段）在其自身基组中的能量为 $E_{B,X}^B$。\n单体 $A$ 在片段 $A$ 和 $B$ 的组合基组中（其中 $B$ 的基函数是“鬼轨道”）的能量为 $E_{A,X}^{AB}$。\n单体 $B$ 在组合基组中的能量为 $E_{B,X}^{AB}$。\n\n根据定义，构象 $X$ 的基组重叠误差（一个正的校正值）为：\n$$\n\\mathrm{BSSE}_X = \\left(E_{A,X}^{A} - E_{A,X}^{AB}\\right) + \\left(E_{B,X}^{B} - E_{B,X}^{AB}\\right)\n$$\n根据变分原理，使用较大基组（即包含来自另一个片段的鬼轨道）计算的片段能量必须低于或等于仅使用其自身基组计算的能量。因此，$E_{A,X}^{AB} \\leq E_{A,X}^A$ 且 $E_{B,X}^{AB} \\leq E_{B,X}^B$，这确保了 $\\mathrm{BSSE}_X$ 是一个非负值。\n\n那么，构象 $X$ 经过BSSE校正的总能量为：\n$$\nE_{X}^{\\mathrm{corr}} = E_{X}^{AB} + \\mathrm{BSSE}_X\n$$\n由于 $\\mathrm{BSSE}_X \\geq 0$，校正后的能量 $E_{X}^{\\mathrm{corr}}$ 大于或等于未校正的能量 $E_{X}^{AB}$。这正确地移除了由基组重叠引入的人为稳定性。\n\n未校正和校正后的构象能量差（重叠式减去交错式）为：\n$$\n\\Delta E_{\\mathrm{uncorr}} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB}\n$$\n$$\n\\Delta E_{\\mathrm{corr}} = E_{\\mathrm{eclipsed}}^{\\mathrm{corr}} - E_{\\mathrm{staggered}}^{\\mathrm{corr}} = (E_{\\mathrm{eclipsed}}^{AB} + \\mathrm{BSSE}_{\\mathrm{eclipsed}}) - (E_{\\mathrm{staggered}}^{AB} + \\mathrm{BSSE}_{\\mathrm{staggered}})\n$$\n现在我们将为每个测试案例计算这些量。所有能量单位均为 Hartree, $\\mathrm{E_h}$。\n\n案例 1：\n首先，我们计算未校正的能量差：\n$$\n\\Delta E_{\\mathrm{uncorr}}^{(1)} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB} = -79.255000 - (-79.256200) = 0.001200\\ \\mathrm{E_h}\n$$\n接下来，我们确定每个构象的BSSE。\n对于重叠式构象：\n$$\n\\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(1)} = (E_{A,\\mathrm{eclipsed}}^{A} - E_{A,\\mathrm{eclipsed}}^{AB}) + (E_{B,\\mathrm{eclipsed}}^{B} - E_{B,\\mathrm{eclipsed}}^{AB})\n$$\n$$\n\\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(1)} = (-39.700000 - (-39.701000)) + (-39.700000 - (-39.701100)) = 0.001000 + 0.001100 = 0.002100\\ \\mathrm{E_h}\n$$\n对于交错式构象：\n$$\n\\mathrm{BSSE}_{\\mathrm{staggered}}^{(1)} = (E_{A,\\mathrm{staggered}}^{A} - E_{A,\\mathrm{staggered}}^{AB}) + (E_{B,\\mathrm{staggered}}^{B} - E_{B,\\mathrm{staggered}}^{AB})\n$$\n$$\n\\mathrm{BSSE}_{\\mathrm{staggered}}^{(1)} = (-39.700100 - (-39.701000)) + (-39.700100 - (-39.701000)) = 0.000900 + 0.000900 = 0.001800\\ \\mathrm{E_h}\n$$\n现在我们计算校正后的能量：\n$$\nE_{\\mathrm{eclipsed}}^{\\mathrm{corr},(1)} = E_{\\mathrm{eclipsed}}^{AB} + \\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(1)} = -79.255000 + 0.002100 = -79.252900\\ \\mathrm{E_h}\n$$\n$$\nE_{\\mathrm{staggered}}^{\\mathrm{corr},(1)} = E_{\\mathrm{staggered}}^{AB} + \\mathrm{BSSE}_{\\mathrm{staggered}}^{(1)} = -79.256200 + 0.001800 = -79.254400\\ \\mathrm{E_h}\n$$\n最后，校正后的能量差为：\n$$\n\\Delta E_{\\mathrm{corr}}^{(1)} = E_{\\mathrm{eclipsed}}^{\\mathrm{corr},(1)} - E_{\\mathrm{staggered}}^{\\mathrm{corr},(1)} = -79.252900 - (-79.254400) = 0.001500\\ \\mathrm{E_h}\n$$\n对于案例 1，结果是 $\\Delta E_{\\mathrm{uncorr}}^{(1)} = 0.001200\\ \\mathrm{E_h}$ 和 $\\Delta E_{\\mathrm{corr}}^{(1)} = 0.001500\\ \\mathrm{E_h}$。\n\n案例 2：\n以同样的方式进行：\n$$\n\\Delta E_{\\mathrm{uncorr}}^{(2)} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB} = -79.250000 - (-79.251000) = 0.001000\\ \\mathrm{E_h}\n$$\nBSSE 值为：\n$$\n\\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(2)} = 2 \\times (-39.690000 - (-39.690750)) = 2 \\times (0.000750) = 0.001500\\ \\mathrm{E_h}\n$$\n$$\n\\mathrm{BSSE}_{\\mathrm{staggered}}^{(2)} = 2 \\times (-39.690500 - (-39.691250)) = 2 \\times (0.000750) = 0.001500\\ \\mathrm{E_h}\n$$\n在这种情况下，两种构象的BSSE是相同的。\n校正后的能量为：\n$$\nE_{\\mathrm{eclipsed}}^{\\mathrm{corr},(2)} = -79.250000 + 0.001500 = -79.248500\\ \\mathrm{E_h}\n$$\n$$\nE_{\\mathrm{staggered}}^{\\mathrm{corr},(2)} = -79.251000 + 0.001500 = -79.249500\\ \\mathrm{E_h}\n$$\n校正后的能量差为：\n$$\n\\Delta E_{\\mathrm{corr}}^{(2)} = -79.248500 - (-79.249500) = 0.001000\\ \\mathrm{E_h}\n$$\n对于案例 2，结果是 $\\Delta E_{\\mathrm{uncorr}}^{(2)} = 0.001000\\ \\mathrm{E_h}$ 和 $\\Delta E_{\\mathrm{corr}}^{(2)} = 0.001000\\ \\mathrm{E_h}$。校正不改变能量差。\n\n案例 3：\n最后，对于第三个案例：\n$$\n\\Delta E_{\\mathrm{uncorr}}^{(3)} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB} = -79.260000 - (-79.260300) = 0.000300\\ \\mathrm{E_h}\n$$\nBSSE 值为：\n$$\n\\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(3)} = 2 \\times (-39.695000 - (-39.695500)) = 2 \\times (0.000500) = 0.001000\\ \\mathrm{E_h}\n$$\n$$\n\\mathrm{BSSE}_{\\mathrm{staggered}}^{(3)} = 2 \\times (-39.695100 - (-39.695850)) = 2 \\times (0.000750) = 0.001500\\ \\mathrm{E_h}\n$$\n校正后的能量为：\n$$\nE_{\\mathrm{eclipsed}}^{\\mathrm{corr},(3)} = -79.260000 + 0.001000 = -79.259000\\ \\mathrm{E_h}\n$$\n$$\nE_{\\mathrm{staggered}}^{\\mathrm{corr},(3)} = -79.260300 + 0.001500 = -79.258800\\ \\mathrm{E_h}\n$$\n校正后的能量差为：\n$$\n\\Delta E_{\\mathrm{corr}}^{(3)} = -79.259000 - (-79.258800) = -0.000200\\ \\mathrm{E_h}\n$$\n对于案例 3，结果是 $\\Delta E_{\\mathrm{uncorr}}^{(3)} = 0.000300\\ \\mathrm{E_h}$ 和 $\\Delta E_{\\mathrm{corr}}^{(3)} = -0.000200\\ \\mathrm{E_h}$。这展示了一个BSSE校正至关重要的案例，因为它反转了能量差的符号，从而定性地改变了构象的能量排序。\n\n以下程序系统地实现了这些计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Basis Set Superposition Error problem for three test cases\n    of ethane conformations.\n    \"\"\"\n    \n    # Test cases defined as a list of dictionaries. Each dictionary contains\n    # all necessary energy values for a single case.\n    # All energies are in Hartree (Eh).\n    test_cases = [\n        # Case 1\n        {\n            \"E_ecl_AB\": -79.255000, \"E_stg_AB\": -79.256200,\n            \"E_A_ecl_A\": -39.700000, \"E_B_ecl_B\": -39.700000,\n            \"E_A_ecl_AB\": -39.701000, \"E_B_ecl_AB\": -39.701100,\n            \"E_A_stg_A\": -39.700100, \"E_B_stg_B\": -39.700100,\n            \"E_A_stg_AB\": -39.701000, \"E_B_stg_AB\": -39.701000,\n        },\n        # Case 2\n        {\n            \"E_ecl_AB\": -79.250000, \"E_stg_AB\": -79.251000,\n            \"E_A_ecl_A\": -39.690000, \"E_B_ecl_B\": -39.690000,\n            \"E_A_ecl_AB\": -39.690750, \"E_B_ecl_AB\": -39.690750,\n            \"E_A_stg_A\": -39.690500, \"E_B_stg_B\": -39.690500,\n            \"E_A_stg_AB\": -39.691250, \"E_B_stg_AB\": -39.691250,\n        },\n        # Case 3\n        {\n            \"E_ecl_AB\": -79.260000, \"E_stg_AB\": -79.260300,\n            \"E_A_ecl_A\": -39.695000, \"E_B_ecl_B\": -39.695000,\n            \"E_A_ecl_AB\": -39.695500, \"E_B_ecl_AB\": -39.695500,\n            \"E_A_stg_A\": -39.695100, \"E_B_stg_B\": -39.695100,\n            \"E_A_stg_AB\": -39.695850, \"E_B_stg_AB\": -39.695850,\n        },\n    ]\n\n    results = []\n    \n    for case_data in test_cases:\n        # Calculate uncorrected conformational energy difference\n        delta_e_uncorr = case_data[\"E_ecl_AB\"] - case_data[\"E_stg_AB\"]\n\n        # Calculate BSSE for the eclipsed conformation\n        bsse_ecl = (case_data[\"E_A_ecl_A\"] - case_data[\"E_A_ecl_AB\"]) + \\\n                   (case_data[\"E_B_ecl_B\"] - case_data[\"E_B_ecl_AB\"])\n\n        # Calculate BSSE for the staggered conformation\n        bsse_stg = (case_data[\"E_A_stg_A\"] - case_data[\"E_A_stg_AB\"]) + \\\n                   (case_data[\"E_B_stg_B\"] - case_data[\"E_B_stg_AB\"])\n\n        # Calculate BSSE-corrected energies for each conformation\n        e_ecl_corr = case_data[\"E_ecl_AB\"] + bsse_ecl\n        e_stg_corr = case_data[\"E_stg_AB\"] + bsse_stg\n\n        # Calculate BSSE-corrected conformational energy difference\n        delta_e_corr = e_ecl_corr - e_stg_corr\n        \n        results.append([delta_e_uncorr, delta_e_corr])\n\n    # Format the results into the required string format.\n    # Each number must be rounded to 6 decimal places with trailing zeros.\n    formatted_pairs = []\n    for uncorr, corr in results:\n        # Use f-string formatting to ensure 6 decimal places.\n        formatted_pairs.append(f\"[{uncorr:.6f},{corr:.6f}]\")\n    \n    # Join the formatted pairs into a single string representing a list of lists.\n    final_output_string = f\"[{','.join(formatted_pairs)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "2450842"}]}