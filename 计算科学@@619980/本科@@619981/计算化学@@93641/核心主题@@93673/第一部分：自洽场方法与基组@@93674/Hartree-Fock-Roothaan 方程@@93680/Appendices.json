{"hands_on_practices": [{"introduction": "哈特里-福克-罗特汉（Hartree-Fock-Roothaan）方程将求解薛定谔方程的挑战转化为一个矩阵代数问题，但这些矩阵中的数字从何而来？第一个实践将带您进入最基础的层面，指导您分析推导高斯型轨道（Gaussian-type orbitals）重叠积分的解析表达式 [@problem_id:2643546]。掌握这一推导，您将具体理解原子轨道的数学表示如何转化为我们量子化学计算中的数值分量 $S_{\\mu\\nu}$。", "problem": "在为分子体系构建Hartree–Fock–Roothaan方程中的重叠矩阵的背景下，考虑两个分别以不同原子核位置$\\mathbf{A}$和$\\mathbf{B}$为中心的、归一化的基元$s$型高斯型轨道（GTO），其高斯指数分别为正值$\\alpha_{\\mu}$和$\\alpha_{\\nu}$。每个轨道的形式为$\\phi_{\\mu}(\\mathbf{r}) = N_{\\mu} \\exp\\!\\left(-\\alpha_{\\mu}|\\mathbf{r}-\\mathbf{A}|^{2}\\right)$和$\\phi_{\\nu}(\\mathbf{r}) = N_{\\nu} \\exp\\!\\left(-\\alpha_{\\nu}|\\mathbf{r}-\\mathbf{B}|^{2}\\right)$，其中归一化常数$N_{\\mu}$和$N_{\\nu}$由$\\mathbb{R}^{3}$中的单位范数条件确定。从重叠积分的定义$S_{\\mu\\nu}=\\langle \\phi_{\\mu}|\\phi_{\\nu}\\rangle = \\int_{\\mathbb{R}^{3}} \\phi_{\\mu}(\\mathbf{r})\\,\\phi_{\\nu}(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r}$出发，仅使用$\\mathbb{R}^{3}$中的基本高斯积分性质和高斯乘积定理（作为一个可通过配方法推导的、经过充分检验的公式）作为你的推导基础，推导出一个关于$\\alpha_{\\mu}$、$\\alpha_{\\nu}$和核间距$R_{AB}=|\\mathbf{A}-\\mathbf{B}|$的$S_{\\mu\\nu}$的解析闭合形式表达式。将您的最终结果表示为单一的闭合形式表达式。不需要进行数值计算，也不需要四舍五入。您的最终答案必须是一个无单位的单一解析表达式。", "solution": "问题陈述需经过验证。\n\n**步骤1：提取已知条件**\n- 背景是用于分子体系的Hartree-Fock-Roothaan方法。\n- 给定两个归一化的基元s型高斯型轨道（GTO）：\n  - $\\phi_{\\mu}(\\mathbf{r}) = N_{\\mu} \\exp(-\\alpha_{\\mu}|\\mathbf{r}-\\mathbf{A}|^{2})$\n  - $\\phi_{\\nu}(\\mathbf{r}) = N_{\\nu} \\exp(-\\alpha_{\\nu}|\\mathbf{r}-\\mathbf{B}|^{2})$\n- 轨道中心为$\\mathbf{A}$和$\\mathbf{B}$。\n- 高斯指数为$\\alpha_{\\mu} > 0$和$\\alpha_{\\nu} > 0$。\n- 归一化常数$N_{\\mu}$和$N_{\\nu}$确保在$\\mathbb{R}^{3}$中$\\langle \\phi_{\\mu}|\\phi_{\\mu}\\rangle = 1$且$\\langle \\phi_{\\nu}|\\phi_{\\nu}\\rangle = 1$。\n- 目标是推导重叠积分$S_{\\mu\\nu} = \\langle \\phi_{\\mu}|\\phi_{\\nu}\\rangle = \\int_{\\mathbb{R}^{3}} \\phi_{\\mu}(\\mathbf{r})\\,\\phi_{\\nu}(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r}$的闭合形式表达式。\n- 推导必须使用基本的高斯积分性质和高斯乘积定理。\n- 最终表达式必须是关于$\\alpha_{\\mu}$、$\\alpha_{\\nu}$和核间距$R_{AB}=|\\mathbf{A}-\\mathbf{B}|$的函数。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是计算量子化学领域中一个经典且基础的推导。GTO的使用和重叠积分的计算是Hartree-Fock方法中使用的LCAO-MO近似的核心。\n- **适定性：** 该问题提供了所有必要的定义和约束。目标是推导出一种特定的、众所周知的解析结果。存在唯一解。\n- **客观性：** 该问题以精确、形式化和客观的数学语言陈述。\n- **结论：** 问题陈述没有科学上的不健全性、模糊性和不完整性。它是一个理论化学中有效且适定的问题。\n\n**步骤3：裁定和行动**\n- **裁定：** 问题有效。\n- **行动：** 继续进行推导。\n\n现在开始推导重叠积分$S_{\\mu\\nu}$。我们从实值s型GTO的重叠积分定义开始：\n$$ S_{\\mu\\nu} = \\int_{\\mathbb{R}^{3}} \\phi_{\\mu}(\\mathbf{r}) \\phi_{\\nu}(\\mathbf{r}) \\, \\mathrm{d}\\mathbf{r} $$\n代入给定的轨道$\\phi_{\\mu}$和$\\phi_{\\nu}$的形式：\n$$ S_{\\mu\\nu} = \\int_{\\mathbb{R}^{3}} N_{\\mu} \\exp\\left(-\\alpha_{\\mu}|\\mathbf{r}-\\mathbf{A}|^{2}\\right) N_{\\nu} \\exp\\left(-\\alpha_{\\nu}|\\mathbf{r}-\\mathbf{B}|^{2}\\right) \\, \\mathrm{d}\\mathbf{r} $$\n归一化常数$N_{\\mu}$和$N_{\\nu}$与积分变量$\\mathbf{r}$无关，可以移到积分号外。两个指数项可以合并为一个指数：\n$$ S_{\\mu\\nu} = N_{\\mu} N_{\\nu} \\int_{\\mathbb{R}^{3}} \\exp\\left(-\\alpha_{\\mu}|\\mathbf{r}-\\mathbf{A}|^{2} - \\alpha_{\\nu}|\\mathbf{r}-\\mathbf{B}|^{2}\\right) \\, \\mathrm{d}\\mathbf{r} $$\n为简化指数，我们使用高斯乘积定理。该定理指出，两个分别以$\\mathbf{A}$和$\\mathbf{B}$为中心的高斯函数的乘积是另一个高斯函数。通过配方法处理指数。一般结果是：\n$$ \\exp\\left(-a|\\mathbf{r}-\\mathbf{A}|^{2}\\right) \\exp\\left(-b|\\mathbf{r}-\\mathbf{B}|^{2}\\right) = \\exp\\left(-\\frac{ab}{a+b}|\\mathbf{A}-\\mathbf{B}|^{2}\\right) \\exp\\left(-(a+b)\\left|\\mathbf{r}-\\mathbf{P}\\right|^{2}\\right) $$\n其中新的中心$\\mathbf{P}$定义为$\\mathbf{P} = \\frac{a\\mathbf{A} + b\\mathbf{B}}{a+b}$。\n在我们的情况中，有$a=\\alpha_{\\mu}$和$b=\\alpha_{\\nu}$。令$p = \\alpha_{\\mu} + \\alpha_{\\nu}$。新的中心是$\\mathbf{P} = \\frac{\\alpha_{\\mu}\\mathbf{A} + \\alpha_{\\nu}\\mathbf{B}}{p}$。高斯函数的乘积变为：\n$$ \\exp\\left(-\\frac{\\alpha_{\\mu}\\alpha_{\\nu}}{p}|\\mathbf{A}-\\mathbf{B}|^{2}\\right) \\exp\\left(-p\\left|\\mathbf{r}-\\mathbf{P}\\right|^{2}\\right) $$\n第一项$\\exp\\left(-\\frac{\\alpha_{\\mu}\\alpha_{\\nu}}{p}|\\mathbf{A}-\\mathbf{B}|^{2}\\right)$是相对于积分变量$\\mathbf{r}$的常数。我们可以将其移到积分号外。我们同时代入$|\\mathbf{A}-\\mathbf{B}| = R_{AB}$。\n$$ S_{\\mu\\nu} = N_{\\mu} N_{\\nu} \\exp\\left(-\\frac{\\alpha_{\\mu}\\alpha_{\\nu}}{p}R_{AB}^{2}\\right) \\int_{\\mathbb{R}^{3}} \\exp\\left(-p|\\mathbf{r}-\\mathbf{P}|^{2}\\right) \\, \\mathrm{d}\\mathbf{r} $$\n剩余的积分是一个标准的三维高斯积分。其值由公式$\\int_{\\mathbb{R}^{3}} \\exp(-c|\\mathbf{r}-\\mathbf{C}|^2) \\, \\mathrm{d}\\mathbf{r} = (\\frac{\\pi}{c})^{3/2}$给出，其中$c$为任意正常数，$\\mathbf{C}$为中心。这里，$c = p = \\alpha_{\\mu} + \\alpha_{\\nu}$。因此，该积分的计算结果为：\n$$ \\int_{\\mathbb{R}^{3}} \\exp\\left(-p|\\mathbf{r}-\\mathbf{P}|^{2}\\right) \\, \\mathrm{d}\\mathbf{r} = \\left(\\frac{\\pi}{p}\\right)^{3/2} = \\left(\\frac{\\pi}{\\alpha_{\\mu} + \\alpha_{\\nu}}\\right)^{3/2} $$\n将此结果代回到$S_{\\mu\\nu}$的表达式中：\n$$ S_{\\mu\\nu} = N_{\\mu} N_{\\nu} \\exp\\left(-\\frac{\\alpha_{\\mu}\\alpha_{\\nu}}{\\alpha_{\\mu} + \\alpha_{\\nu}}R_{AB}^{2}\\right) \\left(\\frac{\\pi}{\\alpha_{\\mu} + \\alpha_{\\nu}}\\right)^{3/2} $$\n下一步是确定归一化常数$N_{\\mu}$和$N_{\\nu}$。对于$\\phi_{\\mu}$的归一化条件是$\\langle\\phi_{\\mu}|\\phi_{\\mu}\\rangle = 1$。这是重叠积分的一个特例，其中$\\nu = \\mu$，意味着$\\mathbf{A}=\\mathbf{B}$，$R_{AB}=0$且$\\alpha_{\\nu}=\\alpha_{\\mu}$。\n$$ \\langle\\phi_{\\mu}|\\phi_{\\mu}\\rangle = \\int_{\\mathbb{R}^{3}} \\left(N_{\\mu} \\exp\\left(-\\alpha_{\\mu}|\\mathbf{r}-\\mathbf{A}|^{2}\\right)\\right)^{2} \\, \\mathrm{d}\\mathbf{r} = 1 $$\n$$ N_{\\mu}^{2} \\int_{\\mathbb{R}^{3}} \\exp\\left(-2\\alpha_{\\mu}|\\mathbf{r}-\\mathbf{A}|^{2}\\right) \\, \\mathrm{d}\\mathbf{r} = 1 $$\n这同样是一个三维高斯积分，指数常数为$c=2\\alpha_{\\mu}$。其值为$(\\frac{\\pi}{2\\alpha_{\\mu}})^{3/2}$。\n$$ N_{\\mu}^{2} \\left(\\frac{\\pi}{2\\alpha_{\\mu}}\\right)^{3/2} = 1 $$\n解出$N_{\\mu}^{2}$并取$N_{\\mu}$的正实数根：\n$$ N_{\\mu}^{2} = \\left(\\frac{2\\alpha_{\\mu}}{\\pi}\\right)^{3/2} \\implies N_{\\mu} = \\left(\\frac{2\\alpha_{\\mu}}{\\pi}\\right)^{3/4} $$\n通过完全类似的推导，$\\phi_{\\nu}$的归一化常数为：\n$$ N_{\\nu} = \\left(\\frac{2\\alpha_{\\nu}}{\\pi}\\right)^{3/4} $$\n现在我们将这些归一化常数代入$S_{\\mu\\nu}$的表达式中：\n$$ S_{\\mu\\nu} = \\left(\\frac{2\\alpha_{\\mu}}{\\pi}\\right)^{3/4} \\left(\\frac{2\\alpha_{\\nu}}{\\pi}\\right)^{3/4} \\left(\\frac{\\pi}{\\alpha_{\\mu} + \\alpha_{\\nu}}\\right)^{3/2} \\exp\\left(-\\frac{\\alpha_{\\mu}\\alpha_{\\nu}}{\\alpha_{\\mu} + \\alpha_{\\nu}}R_{AB}^{2}\\right) $$\n我们简化指数前因子：\n$$ \\left(\\frac{2\\alpha_{\\mu}}{\\pi}\\frac{2\\alpha_{\\nu}}{\\pi}\\right)^{3/4} \\left(\\frac{\\pi}{\\alpha_{\\mu} + \\alpha_{\\nu}}\\right)^{3/2} = \\left(\\frac{4\\alpha_{\\mu}\\alpha_{\\nu}}{\\pi^{2}}\\right)^{3/4} \\left(\\frac{\\pi}{\\alpha_{\\mu} + \\alpha_{\\nu}}\\right)^{3/2} $$\n这可以改写为：\n$$ \\frac{(4\\alpha_{\\mu}\\alpha_{\\nu})^{3/4}}{(\\pi^{2})^{3/4}} \\frac{\\pi^{3/2}}{(\\alpha_{\\mu} + \\alpha_{\\nu})^{3/2}} = \\frac{(4\\alpha_{\\mu}\\alpha_{\\nu})^{3/4}}{\\pi^{3/2}} \\frac{\\pi^{3/2}}{(\\alpha_{\\mu} + \\alpha_{\\nu})^{3/2}} = \\frac{(4\\alpha_{\\mu}\\alpha_{\\nu})^{3/4}}{(\\alpha_{\\mu} + \\alpha_{\\nu})^{3/2}} $$\n另一种更紧凑的简化方法是认识到所有项的幂都是$3/2$的倍数：\n$$ \\left(\\left(\\frac{4\\alpha_{\\mu}\\alpha_{\\nu}}{\\pi^{2}}\\right)^{1/2}\\right)^{3/2} \\left(\\frac{\\pi}{\\alpha_{\\mu} + \\alpha_{\\nu}}\\right)^{3/2} = \\left( \\frac{2\\sqrt{\\alpha_{\\mu}\\alpha_{\\nu}}}{\\pi} \\cdot \\frac{\\pi}{\\alpha_{\\mu} + \\alpha_{\\nu}} \\right)^{3/2} = \\left(\\frac{2\\sqrt{\\alpha_{\\mu}\\alpha_{\\nu}}}{\\alpha_{\\mu} + \\alpha_{\\nu}}\\right)^{3/2} $$\n将这个简化的前置因子与指数项结合，得到重叠积分的最终解析表达式：\n$$ S_{\\mu\\nu} = \\left(\\frac{2\\sqrt{\\alpha_{\\mu}\\alpha_{\\nu}}}{\\alpha_{\\mu} + \\alpha_{\\nu}}\\right)^{3/2} \\exp\\left(-\\frac{\\alpha_{\\mu}\\alpha_{\\nu}}{\\alpha_{\\mu} + \\alpha_{\\nu}}R_{AB}^{2}\\right) $$\n该表达式是完整的解，按要求给出了作为高斯指数和核间距函数的重叠积分。", "answer": "$$\n\\boxed{\\left(\\frac{2\\sqrt{\\alpha_{\\mu}\\alpha_{\\nu}}}{\\alpha_{\\mu} + \\alpha_{\\nu}}\\right)^{3/2} \\exp\\left(-\\frac{\\alpha_{\\mu}\\alpha_{\\nu}}{\\alpha_{\\mu} + \\alpha_{\\nu}}R_{AB}^{2}\\right)}\n$$", "id": "2643546"}, {"introduction": "“自洽场”（Self-Consistent Field, SCF）一词描述了哈特里-福克理论核心处一个优雅的迭代过程。本练习将让您为一个简单的假设分子手动执行一个完整的迭代，从而揭开 SCF 循环的神秘面纱 [@problem_id:2643602]。通过手动构建福克矩阵、求解新轨道并计算能量，您将亲身体会到轨道与其共同产生的有效势之间的相互作用。", "problem": "考虑一个最小的玩具系统，旨在阐释在非正交原子轨道(AO)基组中，闭壳层分子的Hartree-Fock-Roothaan方程。有$2$个电子双占据一个空间分子轨道（限制性闭壳层）。该基组的维度为$2$，其原子轨道重叠矩阵为\n$$\nS \\;=\\; \\begin{pmatrix}\n1.0 & 0.2 \\\\\n0.2 & 1.0\n\\end{pmatrix}.\n$$\n单电子核心哈密顿量矩阵（以哈特里原子单位计）为\n$$\nH^{\\text{core}} \\;=\\; \\begin{pmatrix}\n-1.0 & -0.2 \\\\\n-0.2 & -0.5\n\\end{pmatrix}.\n$$\n电子排斥积分以化学家标记法$(\\mu\\nu|\\lambda\\sigma)$给出，并遵循标准的排列对称性。仅有的非零双电子积分（以哈特里为单位）是\n$$\n(11|11)=0.7,\\quad (22|22)=0.6,\\quad (11|22)=(22|11)=0.2,\\quad (12|12)=(21|21)=(12|21)=(21|12)=0.25,\n$$\n所有其他的$(\\mu\\nu|\\lambda\\sigma)$均为零。假设核排斥能为$0$哈特里。\n\n从一个初始零密度开始，依据限制性闭壳层系统的Hartree-Fock-Roothaan方法，显式地执行一次自洽场(SCF)迭代：在原子轨道基组下，对初始Fock矩阵对角化求解广义本征值问题，以获得能量最低的归一化分子轨道（进行$S$-正交归一化），构建更新后的原子轨道密度矩阵，使用更新后的密度重构Fock矩阵，然后计算闭壳层电子能。在非正交原子轨道基组下，使用适用于Hartree-Fock理论的标准闭壳层定义。\n\n以哈特里为单位表示最终的电子能（不包括核排斥能），并将您的答案四舍五入到四位有效数字。您的最终答案必须是一个实数。", "solution": "该问题要求对一个限制性闭壳层系统执行一次完整的自洽场(SCF)程序迭代，如Hartree-Fock-Roothaan方程所描述。该系统由$2$个电子组成，位于由两个原子轨道（AOs）构成的非正交基组中。最终目标是在这次单次迭代后计算电子能。\n\n在原子轨道基组中的Hartree-Fock-Roothaan方程是一个广义本征值问题：\n$$ FC = SCE $$\n其中$F$是Fock矩阵，$C$是分子轨道(MO)系数矩阵，$S$是原子轨道重叠矩阵，$E$是轨道能量$\\epsilon_i$的对角矩阵。\n\n对于限制性闭壳层系统，Fock矩阵的元素$F_{\\mu\\nu}$由下式给出：\n$$ F_{\\mu\\nu} = H_{\\mu\\nu}^{\\text{core}} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right] $$\n这里，$H^{\\text{core}}$是核心哈密顿量，$(\\mu\\nu|\\lambda\\sigma)$是化学家标记法中的双电子排斥积分，$P$是密度矩阵。对于一个有$N$个电子的系统，密度矩阵元素$P_{\\lambda\\sigma}$定义为：\n$$ P_{\\lambda\\sigma} = 2 \\sum_{i=1}^{N/2} C_{\\lambda i} C_{\\sigma i}^* $$\n其中求和遍及所有占据的分子轨道。对于本问题，$N=2$，因此求和仅针对能量最低的分子轨道，即$i=1$。\n\n电子能$E_{elec}$使用收敛的密度矩阵和Fock矩阵计算：\n$$ E_{elec} = \\frac{1}{2} \\sum_{\\mu\\nu} P_{\\nu\\mu} (H_{\\mu\\nu}^{\\text{core}} + F_{\\mu\\nu}) $$\n鉴于矩阵是实数且对称的，这等价于$E_{elec} = \\frac{1}{2} \\text{Tr}[P(H^{\\text{core}} + F)]$。\n\nSCF程序从密度矩阵$P^{(0)}$的初始猜测开始。\n**步骤0：初始猜测**\n问题指定了初始零密度。因此，初始密度矩阵$P^{(0)}$是一个$2 \\times 2$的零矩阵：\n$$ P^{(0)} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix} $$\n\n**步骤1：初始Fock矩阵**\n使用$P^{(0)}$，我们构建初始Fock矩阵$F^{(0)}$。由于$P^{(0)}$是零矩阵，Fock矩阵表达式中的双电子项消失。因此，初始Fock矩阵等于核心哈密顿量：\n$$ F^{(0)} = H^{\\text{core}} = \\begin{pmatrix} -1.0 & -0.2 \\\\ -0.2 & -0.5 \\end{pmatrix} $$\n\n**步骤2：求解广义本征值问题**\n我们求解广义本征值问题$F^{(0)}C^{(1)} = SC^{(1)}E^{(1)}$，以找到分子轨道系数$C^{(1)}$和能量$E^{(1)}$的第一次迭代结果。这需要求解久期方程$\\det(F^{(0)} - \\epsilon S) = 0$。\n$$ \\det \\left( \\begin{pmatrix} -1.0 & -0.2 \\\\ -0.2 & -0.5 \\end{pmatrix} - \\epsilon \\begin{pmatrix} 1.0 & 0.2 \\\\ 0.2 & 1.0 \\end{pmatrix} \\right) = 0 $$\n$$ \\det \\begin{pmatrix} -1.0 - \\epsilon & -0.2 - 0.2\\epsilon \\\\ -0.2 - 0.2\\epsilon & -0.5 - \\epsilon \\end{pmatrix} = 0 $$\n行列式为：\n$$ (-1.0 - \\epsilon)(-0.5 - \\epsilon) - (-0.2 - 0.2\\epsilon)^2 = 0 $$\n$$ (1.0 + \\epsilon)(0.5 + \\epsilon) - (0.2)^2(1.0 + \\epsilon)^2 = 0 $$\n$$ (1.0 + \\epsilon) \\left[ (0.5 + \\epsilon) - 0.04(1.0 + \\epsilon) \\right] = 0 $$\n$$ (1.0 + \\epsilon) (0.5 + \\epsilon - 0.04 - 0.04\\epsilon) = 0 $$\n$$ (1.0 + \\epsilon) (0.96\\epsilon + 0.46) = 0 $$\n该方程产生两个轨道能量：$\\epsilon_1 = -1.0$和$\\epsilon_2 = -0.46/0.96 \\approx -0.47917$。能量最低的轨道是$\\epsilon_1 = -1.0$。\n\n**步骤3：确定并归一化能量最低的分子轨道**\n我们通过求解$(F^{(0)} - \\epsilon_1 S)C_1 = 0$来找到对应于$\\epsilon_1 = -1.0$的本征矢量$C_1$：\n$$ \\left( \\begin{pmatrix} -1.0 & -0.2 \\\\ -0.2 & -0.5 \\end{pmatrix} - (-1.0) \\begin{pmatrix} 1.0 & 0.2 \\\\ 0.2 & 1.0 \\end{pmatrix} \\right) \\begin{pmatrix} c_{11} \\\\ c_{21} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0.5 \\end{pmatrix} \\begin{pmatrix} c_{11} \\\\ c_{21} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n第二行给出$0.5 c_{21} = 0$，所以$c_{21}=0$。第一行$0=0$对$c_{11}$没有约束。我们可以设$c_{11}=1$，得到未归一化的本征矢量$C_1' = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n分子轨道必须根据$C_1^\\dagger S C_1 = 1$进行归一化。\n$$ \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1.0 & 0.2 \\\\ 0.2 & 1.0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1.0 \\\\ 0.2 \\end{pmatrix} = 1.0 $$\n归一化常数为$1$，所以归一化后的分子轨道系数矢量为$C_1^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n**步骤4：构建更新后的密度矩阵**\n在单个占据分子轨道$\\psi_1$中有$2$个电子，新的密度矩阵$P^{(1)}$为：\n$$ P_{\\mu\\nu}^{(1)} = 2 C_{\\mu 1}^{(1)} C_{\\nu 1}^{(1)} $$\n使用$C_1^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，我们得到：\n$P_{11}^{(1)} = 2(1)(1) = 2$\n$P_{12}^{(1)} = P_{21}^{(1)} = 2(1)(0) = 0$\n$P_{22}^{(1)} = 2(0)(0) = 0$\n$$ P^{(1)} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 0 \\end{pmatrix} $$\n\n**步骤5：重构Fock矩阵**\n更新后的Fock矩阵$F^{(1)}$使用$P^{(1)}$来构建。一个元素的通用表达式是：\n$$ F_{\\mu\\nu}^{(1)} = H_{\\mu\\nu}^{\\text{core}} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma}^{(1)} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right] $$\n由于只有$P_{11}^{(1)} = 2$非零，求和简化为$\\lambda=\\sigma=1$的项：\n$$ F_{\\mu\\nu}^{(1)} = H_{\\mu\\nu}^{\\text{core}} + P_{11}^{(1)} \\left[ (\\mu\\nu|11) - \\frac{1}{2}(\\mu 1|\\nu 1) \\right] = H_{\\mu\\nu}^{\\text{core}} + 2 \\left[ (\\mu\\nu|11) - \\frac{1}{2}(\\mu 1|\\nu 1) \\right] $$\n未列出的积分均为零。\n对于$F_{11}^{(1)}$: $(\\mu=1, \\nu=1)$\n$$ F_{11}^{(1)} = H_{11}^{\\text{core}} + 2 \\left[ (11|11) - \\frac{1}{2}(11|11) \\right] = H_{11}^{\\text{core}} + (11|11) = -1.0 + 0.7 = -0.3 $$\n对于$F_{22}^{(1)}$: $(\\mu=2, \\nu=2)$\n$$ F_{22}^{(1)} = H_{22}^{\\text{core}} + 2 \\left[ (22|11) - \\frac{1}{2}(21|21) \\right] = -0.5 + 2 \\left[ 0.2 - \\frac{1}{2}(0.25) \\right] = -0.5 + 2(0.075) = -0.35 $$\n对于$F_{12}^{(1)}$: $(\\mu=1, \\nu=2)$\n$$ F_{12}^{(1)} = H_{12}^{\\text{core}} + 2 \\left[ (12|11) - \\frac{1}{2}(11|21) \\right] $$\n积分$(12|11)$和$(11|21)$不在非零积分列表中，因此它们为$0$。\n$$ F_{12}^{(1)} = H_{12}^{\\text{core}} + 0 = -0.2 $$\n根据对称性，$F_{21}^{(1)} = -0.2$。新的Fock矩阵为：\n$$ F^{(1)} = \\begin{pmatrix} -0.3 & -0.2 \\\\ -0.2 & -0.35 \\end{pmatrix} $$\n\n**步骤6：计算电子能**\n一次迭代后的电子能$E_{elec}^{(1)}$使用$P^{(1)}$和$F^{(1)}$计算：\n$$ E_{elec}^{(1)} = \\frac{1}{2} \\sum_{\\mu\\nu} P_{\\mu\\nu}^{(1)} (H_{\\mu\\nu}^{\\text{core}} + F_{\\mu\\nu}^{(1)}) $$\n由于$P^{(1)}$只有一个非零元素$P_{11}^{(1)}=2$：\n$$ E_{elec}^{(1)} = \\frac{1}{2} P_{11}^{(1)} (H_{11}^{\\text{core}} + F_{11}^{(1)}) = \\frac{1}{2} (2) (-1.0 + (-0.3)) = 1 \\cdot (-1.3) = -1.3 $$\n经过一次SCF迭代后，不包括核排斥的电子能为$-1.3$哈特里。\n\n问题要求将答案四舍五入到四位有效数字。这得到$-1.300$。", "answer": "$$\\boxed{-1.300}$$", "id": "2643602"}, {"introduction": "哈特里-福克-罗特汉方法的威力在于原子轨道线性组合（linear combination of atomic orbitals, LCAO）近似，但其准确性关键取决于这些轨道的选择。本实践提供了一个警示性的案例，要求您仅使用由 p 轨道组成的不恰当基组来计算氢原子的能量 [@problem_id:2464734]。由此得到的非物理性能量将作为一个强有力的实践教训，说明为什么选择一个能够描述波函数真实性质的、经过仔细考量的基组，对于获得有意义的结果至关重要。", "problem": "要求你实现一个完整、可运行的程序，使用一个完全由笛卡尔 $p$ 型高斯型轨道（GTO）组成的基组，通过 Hartree-Fock-Roothaan (HFR) 方程，确定单电子氢原子的最低 Hartree-Fock 总能量。该系统由一个位于原点、电荷为 $Z=1$ 的原子核和一个电子组成。单电子哈密顿算符为 $h(\\mathbf{r}) = -\\tfrac{1}{2}\\nabla^2 - \\tfrac{Z}{r}$，其中 $r = \\lVert \\mathbf{r} \\rVert$，所有物理量均以原子单位表示。基组仅由以原子核为中心的未归一化笛卡尔 $p$ 型基元函数组成，其函数形式为\n$\\phi_{p_x}(\\alpha,\\mathbf{r}) = x \\exp(-\\alpha r^2)$, $\\phi_{p_y}(\\alpha,\\mathbf{r}) = y \\exp(-\\alpha r^2)$, 和 $\\phi_{p_z}(\\alpha,\\mathbf{r}) = z \\exp(-\\alpha r^2)$,\n对于给定集合中的每个指数 $\\alpha$。你必须直接从第一性原理出发，通过在 $\\mathbb{R}^3$ 上积分来构建 Hartree-Fock-Roothaan 框架所需的单电子积分矩阵：\n- 重叠矩阵元 $S_{\\mu\\nu} = \\int \\phi_{\\mu}(\\mathbf{r}) \\, \\phi_{\\nu}(\\mathbf{r}) \\, d^3\\mathbf{r}$，\n- 动能矩阵元 $T_{\\mu\\nu} = -\\tfrac{1}{2} \\int \\phi_{\\mu}(\\mathbf{r}) \\, \\nabla^2 \\phi_{\\nu}(\\mathbf{r}) \\, d^3\\mathbf{r}$，\n- 核吸引矩阵元 $V_{\\mu\\nu} = \\int \\phi_{\\mu}(\\mathbf{r}) \\, \\left(-\\tfrac{Z}{r}\\right) \\, \\phi_{\\nu}(\\mathbf{r}) \\, d^3\\mathbf{r}$，\n以及核心哈密顿矩阵 $H_{\\mu\\nu} = T_{\\mu\\nu} + V_{\\mu\\nu}$。对于单电子系统，不存在双电子贡献，其 Hartree-Fock 总能量等于从 Hartree-Fock-Roothaan 条件中获得的最低本征值。仅使用此处提供的信息，确定每个指定测试用例的最低能量值（以哈特里为单位）。\n\n重要要求：\n- 所有能量必须以哈特里（Hartree）为单位表示，并四舍五入到 $6$ 位小数。\n- 使用如上定义的未归一化笛卡尔 GTO，全部以原点处的原子核为中心，并且除 $p$ 型基元函数外，不引入任何其他函数。\n- 将每个给定的指数集视为定义了一个基组，该基组由每个指数对应的三个笛卡尔 $p$ 型基元函数组成（$p_x$、$p_y$ 和 $p_z$ 各一个），所有函数都以原子核为中心。\n- 对于此势场中的束缚电子，物理上允许的能量必须严格小于 $0$ 哈特里。程序的输出应仅报告每个测试用例的最低能量；输出中不需要额外的标志。\n\n测试套件：\n- 用例 $1$：$\\{\\alpha\\} = \\{1.0\\}$。\n- 用例 $2$：$\\{\\alpha\\} = \\{10.0\\}$。\n- 用例 $3$：$\\{\\alpha\\} = \\{0.05\\}$。\n- 用例 $4$：$\\{\\alpha\\} = \\{0.3, 1.5\\}$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果的顺序与上述用例相同。每个条目必须是该用例的最低能量（以哈特里为单位），并四舍五入到 $6$ 位小数。例如，一个语法正确的输出行格式为 $[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4]$，其中每个 $\\varepsilon_k$ 是一个小数点后恰好有 $6$ 位数字的浮点数。", "solution": "该问题要求使用未归一化的笛卡尔 $p$ 型高斯型轨道 (GTOs) 基组，计算单电子氢原子 ($Z=1$) 的最低 Hartree-Fock 能量。对于单电子系统，Hartree-Fock-Roothaan (HFR) 方程得到显著简化。双电子排斥积分消失，Fock 矩阵 $\\mathbf{F}$ 与核心哈密顿矩阵 $\\mathbf{H}$ 完全相同，后者是动能矩阵 $\\mathbf{T}$ 和核吸引矩阵 $\\mathbf{V}$ 的和。因此，问题简化为求解广义本征值方程：\n$$\n\\mathbf{H} \\mathbf{C} = \\mathbf{S} \\mathbf{C} \\boldsymbol{\\epsilon}\n$$\n其中 $\\mathbf{S}$ 是重叠矩阵，$\\mathbf{C}$ 是分子轨道系数矩阵，$\\boldsymbol{\\epsilon}$ 是轨道能量的对角矩阵。系统的总能量是单个占据轨道的能量，根据变分原理，它等于从此方程解中得到的最低本征值 $\\epsilon_{\\min}$。\n\n基组由以原点为中心的未归一化笛卡尔 p 型 GTO 组成：\n$$\n\\phi_{p_x}(\\alpha, \\mathbf{r}) = x \\exp(-\\alpha r^2) \\\\\n\\phi_{p_y}(\\alpha, \\mathbf{r}) = y \\exp(-\\alpha r^2) \\\\\n\\phi_{p_z}(\\alpha, \\mathbf{r}) = z \\exp(-\\alpha r^2)\n$$\n一个给定的指数集 $\\{\\alpha_1, \\alpha_2, \\dots, \\alpha_N\\}$ 定义了一个大小为 $3N$ 的基组。然而，由于哈密顿量和基函数的对称性，矩阵 $\\mathbf{S}$、$\\mathbf{T}$ 和 $\\mathbf{V}$ 是块对角化的，由分别对应于 $p_x$、$p_y$ 和 $p_z$ 函数的三个相同子块组成。因此，本征值将是三重简并的，我们只需要为其中一个子块（例如 $p_x$ 子块）构建并求解 $N \\times N$ 问题。\n\n矩阵元通过计算全空间上的三维积分，从第一性原理推导得出。设两个基函数为 $\\phi_i(\\mathbf{r}) = x \\exp(-\\alpha_i r^2)$ 和 $\\phi_j(\\mathbf{r}) = x \\exp(-\\alpha_j r^2)$。令 $p_{ij} = \\alpha_i + \\alpha_j$。\n\n1.  **重叠矩阵元, $S_{ij}$**:\n    重叠积分由 $S_{ij} = \\int \\phi_i(\\mathbf{r}) \\phi_j(\\mathbf{r}) d^3\\mathbf{r}$ 给出。\n    $$\n    S_{ij} = \\int x^2 \\exp(-p_{ij} r^2) d^3\\mathbf{r}\n    $$\n    该积分通过分离变量法求解：\n    $$\n    S_{ij} = \\left(\\int_{-\\infty}^{\\infty} x^2 e^{-p_{ij}x^2} dx\\right) \\left(\\int_{-\\infty}^{\\infty} e^{-p_{ij}y^2} dy\\right) \\left(\\int_{-\\infty}^{\\infty} e^{-p_{ij}z^2} dz\\right)\n    $$\n    使用标准高斯积分公式 $\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$ 和 $\\int_{-\\infty}^{\\infty} x^2 e^{-ax^2} dx = \\frac{1}{2a}\\sqrt{\\pi/a}$，我们得到：\n    $$\n    S_{ij} = \\left(\\frac{1}{2p_{ij}}\\sqrt{\\frac{\\pi}{p_{ij}}}\\right) \\left(\\sqrt{\\frac{\\pi}{p_{ij}}}\\right) \\left(\\sqrt{\\frac{\\pi}{p_{ij}}}\\right) = \\frac{1}{2p_{ij}} \\left(\\frac{\\pi}{p_{ij}}\\right)^{3/2} = \\frac{\\pi^{3/2}}{2 p_{ij}^{5/2}}\n    $$\n\n2.  **动能矩阵元, $T_{ij}$**:\n    动能积分为 $T_{ij} = -\\frac{1}{2} \\int \\phi_i(\\mathbf{r}) \\nabla^2 \\phi_j(\\mathbf{r}) d^3\\mathbf{r}$。利用动能算符的厄米性，这等价于 $T_{ij} = \\frac{1}{2} \\int (\\nabla \\phi_i(\\mathbf{r})) \\cdot (\\nabla \\phi_j(\\mathbf{r})) d^3\\mathbf{r}$。计算该积分得到：\n    $$\n    T_{ij} = \\frac{5 \\alpha_i \\alpha_j}{p_{ij}} S_{ij} = \\frac{5 \\alpha_i \\alpha_j}{\\alpha_i + \\alpha_j} S_{ij}\n    $$\n\n3.  **核吸引矩阵元, $V_{ij}$**:\n    对于位于原点、电荷为 $Z$ 的原子核，其核吸引积分为 $V_{ij} = -Z \\int \\phi_i(\\mathbf{r}) \\frac{1}{r} \\phi_j(\\mathbf{r}) d^3\\mathbf{r}$。当 $Z=1$ 时：\n    $$\n    V_{ij} = - \\int \\frac{x^2}{r} \\exp(-p_{ij} r^2) d^3\\mathbf{r}\n    $$\n    此积分可在球坐标系中求解，或使用 $1/r$ 的高斯积分变换求解。结果是：\n    $$\n    V_{ij} = -\\frac{2\\pi}{3 p_{ij}^2}\n    $$\n\n核心哈密顿矩阵元为 $H_{ij} = T_{ij} + V_{ij}$。对于由一组指数 $\\{\\alpha_k\\}$ 定义的每个测试用例，我们使用上述公式构建 $N \\times N$ 矩阵 $\\mathbf{S}$ 和 $\\mathbf{H}$。然后使用 `scipy.linalg.eigh` 对广义本征值问题进行数值求解，以找到轨道能量 $\\epsilon$。这些本征值中的最低值即为给定 p-轨道基组下所要求的基态能量。\n\n计算步骤如下：\n1.  对于一个具有 $N$ 个指数 $\\{\\alpha_1, \\dots, \\alpha_N\\}$ 的给定测试用例，初始化 $N \\times N$ 矩阵 $\\mathbf{S}$ 和 $\\mathbf{H}$。\n2.  遍历所有 $(i, j)$ 对以计算矩阵元 $S_{ij}$ 和 $H_{ij} = T_{ij} + V_{ij}$。\n3.  求解广义本征值问题 $\\mathbf{H}\\mathbf{C} = \\boldsymbol{\\epsilon}\\mathbf{S}\\mathbf{C}$ 以获得本征值 $\\epsilon_k$。\n4.  最低本征值 $\\min_k(\\epsilon_k)$ 是该测试用例的结果。\n5.  最终结果按要求四舍五入到 $6$ 位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Calculates the lowest Hartree-Fock energy for a hydrogen atom using a\n    basis of Cartesian p-type GTOs.\n    \"\"\"\n    # Test cases defined as lists of alpha exponents.\n    test_cases = [\n        [1.0],         # Case 1\n        [10.0],        # Case 2\n        [0.05],        # Case 3\n        [0.3, 1.5],    # Case 4\n    ]\n\n    results = []\n    Z = 1.0  # Nuclear charge for hydrogen atom\n\n    for alphas in test_cases:\n        n_basis = len(alphas)\n        S = np.zeros((n_basis, n_basis))\n        H = np.zeros((n_basis, n_basis))\n\n        # Construct the overlap (S) and core Hamiltonian (H) matrices.\n        # The problem reduces to an N x N system for p_x orbitals due to symmetry,\n        # yielding triply degenerate eigenvalues.\n        for i in range(n_basis):\n            for j in range(i, n_basis):\n                alpha_i = alphas[i]\n                alpha_j = alphas[j]\n                p_ij = alpha_i + alpha_j\n\n                # Overlap matrix element S_ij\n                # S_ij = integral(x*exp(-ai*r^2) * x*exp(-aj*r^2) dV)\n                # Formula: pi^(3/2) / (2 * p_ij^(5/2))\n                s_ij = (np.pi**1.5) / (2 * p_ij**2.5)\n                S[i, j] = S[j, i] = s_ij\n\n                # Kinetic energy matrix element T_ij\n                # T_ij = -1/2 * integral(phi_i * grad^2(phi_j) dV)\n                # Simplified relation: T_ij = (5 * alpha_i * alpha_j / p_ij) * S_ij\n                t_ij = (5.0 * alpha_i * alpha_j / p_ij) * s_ij\n                \n                # Nuclear attraction matrix element V_ij\n                # V_ij = integral(phi_i * (-Z/r) * phi_j dV)\n                # Formula: -2 * pi * Z / (3 * p_ij^2)\n                v_ij = (-2.0 * np.pi * Z) / (3.0 * p_ij**2)\n                \n                # Core Hamiltonian matrix element H_ij\n                H[i, j] = H[j, i] = t_ij + v_ij\n\n        # Solve the generalized eigenvalue problem H*C = S*C*e\n        # where 'e' are the orbital energies.\n        # eigh is used for Hermitian matrices; S and H are real symmetric.\n        try:\n            eigenvalues = eigh(H, S, eigvals_only=True)\n            lowest_energy = np.min(eigenvalues)\n        except np.linalg.LinAlgError:\n            # This might happen if the overlap matrix S is singular,\n            # which indicates a poorly chosen (linearly dependent) basis set.\n            lowest_energy = np.nan\n\n        results.append(lowest_energy)\n\n    # Format the results to 6 decimal places and print in the required format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2464734"}]}