{"hands_on_practices": [{"introduction": "力场参数并非凭空而来；它们是通过拟合实验数据或高精度量子力学计算得到的。这个练习将带你亲身体验参数化的核心过程。我们将使用一个简化的甲醇模型，通过调整羟基氢的局部电荷，使其预测的汽化热与实验值相匹配，从而揭示宏观性质与微观参数之间的直接联系。[@problem_id:2456417]", "problem": "给定一个简化的、基于物理的甲醇模型，在该模型中，仅羟基氢和氧携带大小相等、符号相反的局部电荷。设羟基氢携带的局部电荷为 $+q$（以基本电荷 $e$ 为单位），氧携带的局部电荷为 $-q$。甲基是电中性的。液体的预测摩尔汽化热，记作 $\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q)$，其模型为\n$$\n\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q) \\;=\\; E_{\\mathrm{ne}} \\;+\\; \\frac{s\\,z\\,k_e}{r_{\\mathrm{HB}}}\\,q^2 \\;+\\; R\\,T\n$$\n其中，$E_{\\mathrm{ne}}$ 是每摩尔的基线非静电内聚贡献，$s$ 是一个无量纲的屏蔽因子，用于解释取向平均和局部屏蔽，$z$ 是每个分子的平均氢键配位数，$k_e$ 是以力场单位表示的库仑常数，$r_{\\mathrm{HB}}$ 是一个特征性的氧-氢氢键距离，$R$ 是摩尔气体常数，而 $T$ 是绝对温度。所有能量单位为 $\\mathrm{kJ\\,mol^{-1}}$，距离单位为 $\\mathrm{nm}$，温度单位为 $\\mathrm{K}$，电荷单位为 $e$。使用常数 $k_e = 138.935456\\ \\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}$ 和 $R = 8.314462618\\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。对于下面的每个测试用例，让 $\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}}$ 表示目标实验摩尔汽化热。\n\n您的任务是：对于每个测试用例，计算非负的羟基氢局部电荷 $q_{\\mathrm{opt}}$（以 $e$ 为单位），该电荷使模型预测与实验之间的平方误差最小化，即最小化\n$$\n\\left(\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q) - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}}\\right)^2\n$$\n约束条件为 $q \\ge 0$。将每个 $q_{\\mathrm{opt}}$ 报告为以 $e$ 为单位的小数，四舍五入到小数点后四位。\n\n测试套件（每个项目按必须处理的顺序列出 $(T,\\ \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}},\\ r_{\\mathrm{HB}},\\ z,\\ s,\\ E_{\\mathrm{ne}})$）：\n- 用例1（标称甲醇条件）：$(298.15\\ \\mathrm{K},\\ 35.3\\ \\mathrm{kJ\\,mol^{-1}},\\ 0.19\\ \\mathrm{nm},\\ 1.7,\\ 0.05,\\ 20.0\\ \\mathrm{kJ\\,mol^{-1}})$。\n- 用例2（基线超过目标值；边界行为）：$(298.15\\ \\mathrm{K},\\ 35.3\\ \\mathrm{kJ\\,mol^{-1}},\\ 0.19\\ \\mathrm{nm},\\ 1.7,\\ 0.05,\\ 33.0\\ \\mathrm{kJ\\,mol^{-1}})$。\n- 用例3（高温及更低目标值）：$(350.0\\ \\mathrm{K},\\ 31.0\\ \\mathrm{kJ\\,mol^{-1}},\\ 0.19\\ \\mathrm{nm},\\ 1.7,\\ 0.05,\\ 20.0\\ \\mathrm{kJ\\,mol^{-1}})$。\n- 用例4（有效屏蔽较弱）：$(298.15\\ \\mathrm{K},\\ 35.3\\ \\mathrm{kJ\\,mol^{-1}},\\ 0.19\\ \\mathrm{nm},\\ 1.7,\\ 0.02,\\ 20.0\\ \\mathrm{kJ\\,mol^{-1}})$。\n\n最终输出格式：您的程序应生成单行输出，其中包含四个最优电荷，以逗号分隔列表的形式置于方括号内，顺序与测试套件相同，例如 $[q_1,q_2,q_3,q_4]$，每个 $q_i$ 都四舍五入到小数点后四位，并以$e$为单位表示。", "solution": "首先对问题进行严格验证。\n\n**步骤1：提取已知条件**\n- 预测的甲醇摩尔汽化热模型如下：\n$$\n\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q) \\;=\\; E_{\\mathrm{ne}} \\;+\\; \\frac{s\\,z\\,k_e}{r_{\\mathrm{HB}}}\\,q^2 \\;+\\; R\\,T\n$$\n其中，$q$ 是羟基氢上的局部电荷（以 $e$ 为单位），$E_{\\mathrm{ne}}$ 是非静电内聚能，$s$ 是屏蔽因子，$z$ 是配位数，$k_e$ 是库仑常数，$r_{\\mathrm{HB}}$ 是氢键距离，$R$ 是摩尔气体常数，$T$ 是温度。\n- 常数：\n  - $k_e = 138.935456\\ \\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}$\n  - $R = 8.314462618\\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$\n- 目标是找到非负电荷 $q_{\\mathrm{opt}} \\ge 0$，以最小化平方误差：\n$$\nL(q) = \\left(\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q) - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}}\\right)^2\n$$\n其中 $\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}}$ 是实验摩尔汽化热。\n- 提供了四个测试用例，每个用例都指定了一组参数 $(T,\\ \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}},\\ r_{\\mathrm{HB}},\\ z,\\ s,\\ E_{\\mathrm{ne}})$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该模型是对极性液体中内聚能的一种物理上合理但简化的表示。它将能量划分为非静电的 Lennard-Jones 型贡献（$E_{\\mathrm{ne}}$）、成对静电项（$q^2$ 项）以及汽化时的压力-体积功项（$RT$）。此类模型是发展经典分子力学力场的基础。常数和参数值在凝聚相甲醇的实际范围内。该问题在科学上和事实上都是合理的。\n- **适定性：** 目标是在 $q \\ge 0$ 的约束下最小化函数 $L(q)$。该函数是关于 $q$ 的简单多项式，确保存在明确定义的最小值。该问题在数学上结构良好，具有唯一且稳定的解。\n- **客观性：** 问题以精确、客观、正式的科学语言陈述，没有歧义或主观论断。\n\n**步骤3：结论与行动**\n- 该问题是有效的。它具有科学依据、适定且客观。将制定解决方案。\n\n**求解推导**\n任务是找到使平方误差函数最小化的 $q \\ge 0$ 的值：\n$$\nL(q) = \\left( \\left( E_{\\mathrm{ne}} \\;+\\; R\\,T \\;+\\; \\frac{s\\,z\\,k_e}{r_{\\mathrm{HB}}}\\,q^2 \\right) - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} \\right)^2\n$$\n为简化表达式，我们定义两个辅助量。设汽化焓的基线非静电贡献为：\n$$\nH_{\\mathrm{base}} = E_{\\mathrm{ne}} + R\\,T\n$$\n并设静电项的系数为：\n$$\nC_{\\mathrm{elec}} = \\frac{s\\,z\\,k_e}{r_{\\mathrm{HB}}}\n$$\n参数 $s$、$z$、$k_e$ 和 $r_{\\mathrm{HB}}$ 均被指定为正物理量，因此 $C_{\\mathrm{elec}} > 0$。目标函数现在采用以下形式：\n$$\nL(q) = \\left( H_{\\mathrm{base}} + C_{\\mathrm{elec}}\\,q^2 - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} \\right)^2\n$$\n我们寻求在 $q \\ge 0$ 的条件下最小化 $L(q)$。由于 $L(q)$ 是一个平方量，其最小值为 $0$。当且仅当括号内的项为零时，才能达到该最小值，前提是在 $q$ 的允许域内存在解。因此，我们将该项设为零并求解 $q$：\n$$\nH_{\\mathrm{base}} + C_{\\mathrm{elec}}\\,q^2 - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} = 0\n$$\n$$\nC_{\\mathrm{elec}}\\,q^2 = \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - H_{\\mathrm{base}}\n$$\n$$\nq^2 = \\frac{\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - H_{\\mathrm{base}}}{C_{\\mathrm{elec}}}\n$$\n让我们分析分子 $\\Delta E = \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - H_{\\mathrm{base}}$。\n\n情况1：静电相互作用有助于匹配实验值。\n如果 $\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} \\ge H_{\\mathrm{base}}$，则 $\\Delta E \\ge 0$。$q^2$ 的方程右侧为非负。我们可以找到 $q$ 的实数解：\n$$\nq = \\pm\\sqrt{\\frac{\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - H_{\\mathrm{base}}}{C_{\\mathrm{elec}}}}\n$$\n给定约束条件 $q \\ge 0$，最优电荷是主平方根：\n$$\nq_{\\mathrm{opt}} = \\sqrt{\\frac{\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - (E_{\\mathrm{ne}} + R\\,T)}{s\\,z\\,k_e / r_{\\mathrm{HB}}}}\n$$\n\n情况2：基线模型已超过实验值。\n如果 $\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} < H_{\\mathrm{base}}$，则 $\\Delta E < 0$。$q^2$ 方程的右侧为负，因此没有实数值的 $q$ 能使误差为零。在这种情况下，对于任何实数 $q$，括号内的项 $C_{\\mathrm{elec}}\\,q^2 - (-\\Delta E)$ 总是正的，因为 $C_{\\mathrm{elec}} > 0$ 且 $-\\Delta E > 0$。为了最小化平方误差 $L(q) = (C_{\\mathrm{elec}}\\,q^2 - (-\\Delta E))^2$，我们必须最小化 $C_{\\mathrm{elec}}\\,q^2$ 的值。在约束条件 $q \\ge 0$ 下，$C_{\\mathrm{elec}}\\,q^2$ 是 $q$ 的单调递增函数。其最小值出现在定义域的下边界，即 $q=0$。因此，对于这种情况：\n$$\nq_{\\mathrm{opt}} = 0\n$$\n这个结果在物理上是合乎逻辑的：如果非静电模型已经高估了内聚能，那么在这个模型中始终为正的静电贡献必须设置为零，以实现最佳拟合。\n\n结合两种情况，最优电荷 $q_{\\mathrm{opt}}$ 可以紧凑地表示为：\n$$\nq_{\\mathrm{opt}} = \\sqrt{\\max\\left(0, \\frac{\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - E_{\\mathrm{ne}} - R\\,T}{s\\,z\\,k_e / r_{\\mathrm{HB}}}\\right)}\n$$\n此公式将用于求解指定四个测试用例中每个用例的 $q_{\\mathrm{opt}}$。每个用例的结果将四舍五入到小数点后四位。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the optimal partial charge q that minimizes the squared error\n    between a simple model for the heat of vaporization of methanol and its\n    experimental value.\n    \"\"\"\n    \n    # Define physical constants from the problem statement.\n    # k_e: Coulomb constant in kJ mol^-1 nm e^-2\n    k_e = 138.935456\n    # R: Molar gas constant in kJ mol^-1 K^-1\n    R = 8.314462618e-3\n\n    # Test suite cases: (T, delta_H_vap_exp, r_HB, z, s, E_ne)\n    # T in K, delta_H_vap_exp in kJ/mol, r_HB in nm, z dimensionless,\n    # s dimensionless, E_ne in kJ/mol.\n    test_cases = [\n        # Case 1: Nominal methanol conditions\n        (298.15, 35.3, 0.19, 1.7, 0.05, 20.0),\n        # Case 2: Baseline exceeds target; boundary behavior\n        (298.15, 35.3, 0.19, 1.7, 0.05, 33.0),\n        # Case 3: Elevated temperature with lower target\n        (350.0, 31.0, 0.19, 1.7, 0.05, 20.0),\n        # Case 4: Weaker effective screening\n        (298.15, 35.3, 0.19, 1.7, 0.02, 20.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current case\n        T, delta_H_vap_exp, r_HB, z, s, E_ne = case\n\n        # Calculate the numerator for the q^2 expression:\n        # delta_H_vap_exp - (E_ne + R*T)\n        numerator = delta_H_vap_exp - E_ne - R * T\n        \n        q_opt = 0.0\n        # If the numerator is non-negative, a non-zero charge can improve the model.\n        if numerator >= 0:\n            # Calculate the denominator (electrostatic coefficient)\n            # C_elec = (s * z * k_e) / r_HB\n            denominator = (s * z * k_e) / r_HB\n            \n            # The problem parameters ensure denominator is positive.\n            q_squared = numerator / denominator\n            q_opt = np.sqrt(q_squared)\n        # If the numerator is negative, the non-electrostatic part of the model\n        # already exceeds the target value. The best fit is achieved by setting\n        # the electrostatic contribution to zero, i.e., q_opt = 0.\n\n        results.append(q_opt)\n\n    # Format results to four decimal places as strings\n    formatted_results = [f\"{res:.4f}\" for res in results]\n\n    # Print the final output in the required format: [q1,q2,q3,q4]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2456417"}, {"introduction": "一旦力场被参数化，我们就可以用它来预测和解释分子间的相互作用，这在药物设计等领域至关重要。在这个练习中，你将扮演一名计算药物化学家，利用分子动力学模拟的平均数据来评估候选药物与蛋白质靶点的氢键相互作用。你将构建一个综合评分函数，结合静电相互作用和几何偏离的能量惩罚，来量化并排序不同配体的结合亲和力。[@problem_id:2456497]", "problem": "一个制药团队对结合在同一个蛋白质口袋上的三个候选药物（标记为 $L1$、$L2$ 和 $L3$）进行了一个简短的分子动力学（MD）模拟。对于每个配体，模拟揭示了其与蛋白质之间存在两个持久的氢键。每个候选药物的时间平均氢键可观测量如下所列。每个键的报告包括平均氢-受体距离 $r$（单位：纳米）、供体-氢-受体角度 $\\theta$（单位：度）、键占有率 $f$（键在模拟帧中存在的比例），以及氢供体原子 $q_H$ 和受体原子 $q_A$ 上的部分电荷（单位：基本电荷）。蛋白质内部使用相对介电常数 $\\varepsilon_r$ 进行建模。测得以下数据：\n- 适用于所有候选药物的通用常数：相对介电常数 $\\varepsilon_r = 4.0$、理想氢-受体距离 $r_0 = 0.19 \\ \\mathrm{nm}$、理想角度 $\\theta_0 = 180^\\circ$、距离谐波常数 $k_r = 150 \\ \\mathrm{kJ \\ mol^{-1} \\ nm^{-2}}$、角度谐波常数 $k_\\theta = 0.02 \\ \\mathrm{kJ \\ mol^{-1} \\ deg^{-2}}$。使用分子力学库仑前置因子 $k_e = 138.94 \\ \\mathrm{kJ \\ mol^{-1} \\ nm \\ e^{-2}}$。\n- $L1$:\n  - 键 $1$：$f = 0.75$，$r = 0.195 \\ \\mathrm{nm}$，$\\theta = 170^\\circ$，$q_H = +0.30 \\ e$，$q_A = -0.50 \\ e$。\n  - 键 $2$：$f = 0.40$，$r = 0.220 \\ \\mathrm{nm}$，$\\theta = 155^\\circ$，$q_H = +0.25 \\ e$，$q_A = -0.45 \\ e$。\n- $L2$:\n  - 键 $1$：$f = 0.60$，$r = 0.185 \\ \\mathrm{nm}$，$\\theta = 177^\\circ$，$q_H = +0.33 \\ e$，$q_A = -0.50 \\ e$。\n  - 键 $2$：$f = 0.50$，$r = 0.240 \\ \\mathrm{nm}$，$\\theta = 150^\\circ$，$q_H = +0.20 \\ e$，$q_A = -0.40 \\ e$。\n- $L3$:\n  - 键 $1$：$f = 0.90$，$r = 0.205 \\ \\mathrm{nm}$，$\\theta = 165^\\circ$，$q_H = +0.28 \\ e$，$q_A = -0.48 \\ e$。\n  - 键 $2$：$f = 0.20$，$r = 0.180 \\ \\mathrm{nm}$，$\\theta = 180^\\circ$，$q_H = +0.35 \\ e$，$q_A = -0.55 \\ e$。\n\n从适用于经典力场的第一性原理出发，构建一个氢键分数，用以近似氢键对结合的时间平均能量贡献，并用此分数根据预测的亲和力对候选药物进行排序。仅使用以下基本要素：\n- 静电学：在介电常数为 $\\varepsilon_r$ 的介质中，两个相距为 $r$ 的点电荷 $q_1$ 和 $q_2$ 之间的库仑相互作用由公式 $E_\\text{Coul} = \\dfrac{k_e}{\\varepsilon_r}\\dfrac{q_1 q_2}{r}$ 给出，其中 $k_e$ 如上所提供。\n- 几何依赖性：在理想几何构型附近，因偏离产生的能量惩罚项可以通过与理想值偏差的二次（谐波）项很好地近似。使用所提供的理想值 $r_0$ 和 $\\theta_0$ 以及给定的谐波常数量化距离和角度的惩罚。\n- 时间平均：将每个氢键的时间平均贡献近似为占有率 $f$ 乘以在时间平均几何构型下评估的能量估算值。\n\n假设各个键的贡献是可加的，并且在其他条件相同的情况下，总分越负表示净氢键贡献越强，亲和力越高。基于以上假设和数据，哪个候选药物的总氢键分数最有利（最负）？\n\nA. $L1$\n\nB. $L2$\n\nC. $L3$\n\nD. 在给定模型中，它们无法区分（平局）", "solution": "我们首先对问题陈述进行批判性验证。该练习描述了一种使用简化的分子力学模型为蛋白质-配体氢键评分的方法。在尝试求解之前，需要对给定的数据、定义和约束条件进行初步审查，以确定其科学和逻辑上的完整性。\n\n问题提供了以下信息：\n- 三个配体 $L1$、$L2$ 和 $L3$，每个形成两个氢键。\n- 每个键的时间平均几何参数：氢-受体距离 $r$ 和供体-氢-受体角度 $\\theta$。\n- 每个键的键占有率 $f$。\n- 氢原子和受体原子的部分电荷 $q_H$ 和 $q_A$。\n- 一组通用常数：相对介电常数 $\\varepsilon_r = 4.0$、理想几何参数 $r_0 = 0.19 \\ \\mathrm{nm}$ 和 $\\theta_0 = 180^\\circ$、距离谐波力常数 $k_r = 150 \\ \\mathrm{kJ \\ mol^{-1} \\ nm^{-2}}$ 和角度谐波力常数 $k_\\theta = 0.02 \\ \\mathrm{kJ \\ mol^{-1} \\ deg^{-2}}$，以及库仑前置因子 $k_e = 138.94 \\ \\mathrm{kJ \\ mol^{-1} \\ nm \\ e^{-2}}$。\n- 一个明确的构建评分函数的方案，该函数基于静电学的库仑定律和几何惩罚的谐波势，并由占有率加权。\n- 一个寻找具有最负（最有利）总分的配体的指令。\n\n问题的表述具有科学依据。使用一个包含静电项和谐波项的简化的、可加的能量函数是分子力学力场中的一种标准近似方法。物理常数、电荷和几何参数的值对于此类系统都在实际范围内。该问题是适定的；它提供了所有必要的信息和一个清晰、明确的目标。它没有违反任何物理学或化学的基本原理，也不包含内部矛盾。因此，该问题被认定为**有效**。我们可以继续进行推导。\n\n问题要求为每个配体构建一个氢键分数 $S$。对于一个给定的配体，其总分 $S_{\\text{total}}$ 是其两个独立氢键的分数之和。\n$$S_{\\text{total}} = S_{\\text{bond},1} + S_{\\text{bond},2}$$\n\n根据问题陈述，单个键的分数 $S_{\\text{bond}}$ 是其占有率 $f$ 与在时间平均几何构型下计算的能量 $E_{\\text{bond}}$ 的乘积。\n$$S_{\\text{bond}} = f \\cdot E_{\\text{bond}}$$\n\n能量 $E_{\\text{bond}}$ 由静电贡献项和几何惩罚项组成。\n$$E_{\\text{bond}} = E_{\\text{Coul}} + E_{r} + E_{\\theta}$$\n\n各个能量项定义如下：\n1.  氢和受体点电荷之间的静电能（$E_{\\text{Coul}}$）：\n    $$E_{\\text{Coul}} = \\frac{k_e}{\\varepsilon_r}\\frac{q_H q_A}{r}$$\n2.  键长 $r$ 偏离理想距离 $r_0$ 的谐波惩罚：\n    $$E_r = k_r (r - r_0)^2$$\n3.  键角 $\\theta$ 偏离理想角度 $\\theta_0$ 的谐波惩罚：\n    $$E_\\theta = k_\\theta (\\theta - \\theta_0)^2$$\n\n综合以上各项，单个氢键的分数为：\n$$S_{\\text{bond}} = f \\left[ \\frac{k_e}{\\varepsilon_r}\\frac{q_H q_A}{r} + k_r (r - r_0)^2 + k_\\theta (\\theta - \\theta_0)^2 \\right]$$\n\n现在我们使用提供的数据将此公式应用于每个配体的每个键。单位将是 $\\mathrm{kJ \\ mol^{-1}}$。\n库仑项的常数前置因子为 $\\frac{k_e}{\\varepsilon_r} = \\frac{138.94}{4.0} = 34.735 \\ \\mathrm{kJ \\ mol^{-1} \\ nm \\ e^{-2}}$。\n\n**候选药物 $L1$**\n- 键 $1$：$f=0.75$，$r=0.195 \\ \\mathrm{nm}$，$\\theta=170^\\circ$，$q_H=0.30 \\ e$，$q_A=-0.50 \\ e$。\n  $S_1 = 0.75 \\left[ 34.735 \\frac{(0.30)(-0.50)}{0.195} + 150(0.195 - 0.19)^2 + 0.02(170 - 180)^2 \\right]$\n  $S_1 = 0.75 \\left[ -26.7192 + 150(0.005)^2 + 0.02(-10)^2 \\right]$\n  $S_1 = 0.75 \\left[ -26.7192 + 0.00375 + 2.0 \\right] = 0.75(-24.7155) \\approx -18.537 \\ \\mathrm{kJ \\ mol^{-1}}$\n- 键 $2$：$f=0.40$，$r=0.220 \\ \\mathrm{nm}$，$\\theta=155^\\circ$，$q_H=0.25 \\ e$，$q_A=-0.45 \\ e$。\n  $S_2 = 0.40 \\left[ 34.735 \\frac{(0.25)(-0.45)}{0.220} + 150(0.220 - 0.19)^2 + 0.02(155 - 180)^2 \\right]$\n  $S_2 = 0.40 \\left[ -17.7472 + 150(0.03)^2 + 0.02(-25)^2 \\right]$\n  $S_2 = 0.40 \\left[ -17.7472 + 0.135 + 12.5 \\right] = 0.40(-5.1122) \\approx -2.045 \\ \\mathrm{kJ \\ mol^{-1}}$\n- $L1$ 的总分：$S_{L1} = -18.537 - 2.045 = -20.582 \\ \\mathrm{kJ \\ mol^{-1}}$。\n\n**候选药物 $L2$**\n- 键 $1$：$f=0.60$，$r=0.185 \\ \\mathrm{nm}$，$\\theta=177^\\circ$，$q_H=0.33 \\ e$，$q_A=-0.50 \\ e$。\n  $S_1 = 0.60 \\left[ 34.735 \\frac{(0.33)(-0.50)}{0.185} + 150(0.185 - 0.19)^2 + 0.02(177 - 180)^2 \\right]$\n  $S_1 = 0.60 \\left[ -30.9850 + 150(-0.005)^2 + 0.02(-3)^2 \\right]$\n  $S_1 = 0.60 \\left[ -30.9850 + 0.00375 + 0.18 \\right] = 0.60(-30.80125) \\approx -18.481 \\ \\mathrm{kJ \\ mol^{-1}}$\n- 键 $2$：$f=0.50$，$r=0.240 \\ \\mathrm{nm}$，$\\theta=150^\\circ$，$q_H=0.20 \\ e$，$q_A=-0.40 \\ e$。\n  $S_2 = 0.50 \\left[ 34.735 \\frac{(0.20)(-0.40)}{0.240} + 150(0.240 - 0.19)^2 + 0.02(150 - 180)^2 \\right]$\n  $S_2 = 0.50 \\left[ -11.5783 + 150(0.05)^2 + 0.02(-30)^2 \\right]$\n  $S_2 = 0.50 \\left[ -11.5783 + 0.375 + 18.0 \\right] = 0.50(6.7967) \\approx +3.398 \\ \\mathrm{kJ \\ mol^{-1}}$\n- $L2$ 的总分：$S_{L2} = -18.481 + 3.398 = -15.083 \\ \\mathrm{kJ \\ mol^{-1}}$。\n\n**候选药物 $L3$**\n- 键 $1$：$f=0.90$，$r=0.205 \\ \\mathrm{nm}$，$\\theta=165^\\circ$，$q_H=0.28 \\ e$，$q_A=-0.48 \\ e$。\n  $S_1 = 0.90 \\left[ 34.735 \\frac{(0.28)(-0.48)}{0.205} + 150(0.205 - 0.19)^2 + 0.02(165 - 180)^2 \\right]$\n  $S_1 = 0.90 \\left[ -22.7592 + 150(0.015)^2 + 0.02(-15)^2 \\right]$\n  $S_1 = 0.90 \\left[ -22.7592 + 0.03375 + 4.5 \\right] = 0.90(-18.22545) \\approx -16.403 \\ \\mathrm{kJ \\ mol^{-1}}$\n- 键 $2$：$f=0.20$，$r=0.180 \\ \\mathrm{nm}$，$\\theta=180^\\circ$，$q_H=0.35 \\ e$，$q_A=-0.55 \\ e$。\n  $S_2 = 0.20 \\left[ 34.735 \\frac{(0.35)(-0.55)}{0.180} + 150(0.180 - 0.19)^2 + 0.02(180 - 180)^2 \\right]$\n  $S_2 = 0.20 \\left[ -37.1618 + 150(-0.01)^2 + 0.02(0)^2 \\right]$\n  $S_2 = 0.20 \\left[ -37.1618 + 0.015 + 0 \\right] = 0.20(-37.1468) \\approx -7.429 \\ \\mathrm{kJ \\ mol^{-1}}$\n- $L3$ 的总分：$S_{L3} = -16.403 - 7.429 = -23.832 \\ \\mathrm{kJ \\ mol^{-1}}$。\n\n总分总结：\n$S_{L1} = -20.582 \\ \\mathrm{kJ \\ mol^{-1}}$\n$S_{L2} = -15.083 \\ \\mathrm{kJ \\ mol^{-1}}$\n$S_{L3} = -23.832 \\ \\mathrm{kJ \\ mol^{-1}}$\n\n分数越负表示净氢键贡献越强。比较总分，我们得到的有利性顺序为：$S_{L3} < S_{L1} < S_{L2}$。因此，配体 $L3$ 的分数最有利。\n\n现在我们评估所提供的选项。\n\nA. $L1$：$L1$ 的计算分数为 $S_{L1} = -20.582 \\ \\mathrm{kJ \\ mol^{-1}}$。虽然这是一个有利的分数，但它的负值小于 $L3$ 的分数（$-23.832 \\ \\mathrm{kJ \\ mol^{-1}}$）。因此，$L1$ 不是分数最有利的候选药物。**错误**。\n\nB. $L2$：$L2$ 的计算分数为 $S_{L2} = -15.083 \\ \\mathrm{kJ \\ mol^{-1}}$。这是三个候选药物中负值最小，因此最不利的分数。这主要是由于它的第二个键，该键具有很大的几何惩罚，并导致一个净的正值（去稳定化）贡献。**错误**。\n\nC. $L3$：$L3$ 的计算分数为 $S_{L3} = -23.832 \\ \\mathrm{kJ \\ mol^{-1}}$。这是三个候选药物中最负的分数，表明根据指定模型预测，其氢键相互作用最强。**正确**。\n\nD. 在给定模型中，它们无法区分（平局）：计算出的分数明显不同：$-20.582$、$-15.083$ 和 $-23.832 \\ \\mathrm{kJ \\ mol^{-1}}$。在此类模型的背景下，这些差异是显著的。不存在平局。因此，这个陈述是错误的。**错误**。\n\n分析明确地表明，$L3$ 是具有最有利氢键分数的候选药物。", "answer": "$$\\boxed{C}$$", "id": "2456497"}, {"introduction": "经典力场是强大的工具，但它们是基于物理原理的近似模型，有其固有的局限性。理解这些局限性对于正确解释模拟结果和开发更精确的模型至关重要。这个思想实验将展示一个常见力场（如TIP3P）在描述一个几何受限的氢键时如何得出与量子力学截然相反的结论，并促使你思考其物理根源以及如何修正模型。[@problem_id:2456445]", "problem": "构建一个刚性的气相二聚体，其中一个水分子作为假定的氢键供体，与丙酮的羰基氧形成氢键。供体氢被约束在一个短而弯曲的接触上：丙酮的氧到供体氢的距离固定为 $r(\\mathrm{O_{acc}}{-}\\mathrm{H_{don}})=1.60\\,\\mathrm{\\AA}$，供体氢上的角度为 $\\angle \\mathrm{O_{don}}{-}\\mathrm{H_{don}}{-}\\mathrm{O_{acc}}=120^\\circ$，氧-氧距离为 $r(\\mathrm{O_{don}}{-}\\mathrm{O_{acc}})=2.60\\,\\mathrm{\\AA}$。对于这个固定的几何构型，相互作用能通过两种方法进行评估。\n\n方法 $1$ 使用一种不可极化的固定电荷经典力场，该力场采用点电荷静电学模型以及用于 Lennard–Jones 相互作用的 Lorentz–Berthelot 组合规则。水模型是可转移分子间势 $3$ 点 (TIP3P) 类型的：水氧带有的部分电荷为 $q_{\\mathrm{O_{don}}}=-0.834\\,e$ 且仅在氧原子上设置 Lennard–Jones 参数，每个氢原子带有的部分电荷为 $q_{\\mathrm{H_{don}}}=+0.417\\,e$ 且没有 Lennard–Jones 参数；丙酮的重原子具有标准的 Lennard–Jones 参数和固定的部分电荷，使得其羰基氧的电荷 $q_{\\mathrm{O_{acc}}}<0$。方法 $2$ 是在固定几何构型下进行的气相高精度从头算量子力学 (QM) 计算，其中相互作用能被定义为在该构型下二聚体和单体能量之差，并包含了基组重叠误差校正。\n\n在此几何构型下，经典力场预测了一个强烈的稳定化相互作用能 $E_{\\mathrm{FF}} \\ll 0$，而量子力学的结果则是弱排斥的，$E_{\\mathrm{QM}} > 0$。\n\n哪个选项最能解释这种差异的主要物理原因，并提出对经典模型的最小针对性修改，使得该修改最有可能在此几何构型下反转经典预测的符号，使其与量子力学结果相匹配？\n\nA. 原因：供体氢没有短程排斥项，因此在近距离 $\\mathrm{O_{acc}}{-}\\mathrm{H_{don}}$ 接触时缺失了泡利交换排斥作用，而吸引性的库仑项 $\\propto 1/r$ 仍被保留。修改：为供体氢分配非零的 Lennard–Jones (或 Buckingham) 排斥参数，以恢复短程排斥作用。\n\nB. 原因：模型缺乏显式极化，因此诱导作用被低估。修改：添加带有 Thole 阻尼的可诱导偶极子，以减少过度的短程吸引并将相互作用变为排斥。\n\nC. 原因：受体的电子密度被各向同性地建模，未能捕捉孤对电子的方向性。修改：在受体氧上引入偏离中心的孤对电子位点或原子多极矩，以惩罚弯曲的氢键并使该接触变为排斥。\n\nD. 原因：点电荷在短程存在电荷穿透误差。修改：用高斯弥散电荷替换点电荷，或应用阻尼库仑势来软化短程静电作用并反转相互作用的符号。\n\nE. 原因：经典模拟中有限范围的非键截断会截断稳定的相互作用。修改：将非键截断半径增加到 $14\\,\\mathrm{\\AA}$ 或更大，以获得与量子力学一致的排斥性接触。", "solution": "该情景指定了一个短而弯曲的接触，其中 $r(\\mathrm{O_{acc}}{-}\\mathrm{H_{don}})=1.60\\,\\mathrm{\\AA}$ 且 $\\angle \\mathrm{O_{don}}{-}\\mathrm{H_{don}}{-}\\mathrm{O_{acc}}=120^\\circ$。在如此短的距离上，第一性原理表明，受体氧和供体氢母分子上的占据电子密度的重叠会导致显著的泡利（交换）排斥。这种排斥作用在短程急剧增加，在量子力学中可以用指数形式很好地描述。使用 Lennard–Jones 势的经典力场通过 $r^{-12}$ 项来近似这种排斥作用。然而，在类 TIP3P 模型中，供体氢不携带 Lennard–Jones 参数，这意味着氢位点上没有显式的短程排斥作用；对于 $\\mathrm{O_{acc}}{-}\\mathrm{H_{don}}$ 对，只剩下静电相互作用。因此，经典模型在 $r=1.60\\,\\mathrm{\\AA}$ 处累积了一个大的吸引性库仑贡献 $E_{\\mathrm{C}} \\sim k_e q_{\\mathrm{O_{acc}}} q_{\\mathrm{H_{don}}}/r$，却没有一个补偿性的排斥核心，从而使 $E_{\\mathrm{FF}}$ 偏向于强负值。相比之下，量子力学包含了源于电子波函数反对称性的交换排斥，因电荷穿透效应而在短程减小了静电吸引，并且考虑到弯曲的角度，只提供了微弱的稳定化供体-受体轨道相互作用；最终净 $E_{\\mathrm{QM}}$ 变为正值。\n\n从分解的角度来看，氢键的量子力学相互作用能可以看作是\n$$\nE_{\\mathrm{QM}} = E_{\\mathrm{elst}}^{\\mathrm{pen}} + E_{\\mathrm{exch}} + E_{\\mathrm{ind}} + E_{\\mathrm{disp}} + \\cdots,\n$$\n其中 $E_{\\mathrm{exch}} > 0$ 随 $r$ 的减小而迅速增长，$E_{\\mathrm{elst}}^{\\mathrm{pen}}$ 是经过电荷穿透校正的静电作用（其吸引性小于点电荷的 $1/r$），$E_{\\mathrm{ind}}$（诱导）和 $E_{\\mathrm{disp}}$（色散）是吸引项，但数值较小且对几何构型敏感。在一个弯曲的、非常短的接触中，$E_{\\mathrm{exch}}$ 占主导地位，导致 $E_{\\mathrm{QM}} > 0$。\n\n在经典力场中，能量通常为\n$$\nE_{\\mathrm{FF}} = \\sum_{i<j} \\frac{k_e q_i q_j}{\\varepsilon r_{ij}} + \\sum_{i<j} 4\\epsilon_{ij}\\left[\\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{6}\\right].\n$$\n对于类 TIP3P 方案中的 $\\mathrm{O_{acc}}{-}\\mathrm{H_{don}}$ 对，$\\mathrm{H_{don}}$ 没有 Lennard–Jones 参数，这意味着针对这一特定对的 Lennard–Jones 项实际上是缺失的，而静电项依然存在。在 $r=1.60\\,\\mathrm{\\AA}$ 处，这导致了过度结合和 $E_{\\mathrm{FF}} \\ll 0$。\n\n分析各个选项：\n\nA. 该原因指出了供体氢上缺少短程排斥项是经典模型未能模仿泡利不相容原理的原因。这与许多固定电荷水模型的构建方式一致，在这些模型中氢原子没有 Lennard–Jones 参数。提议的修改——为 $\\mathrm{H_{don}}$ 分配非零的 Lennard–Jones（或指数形式的 Buckingham）排斥——直接在 $r=1.60\\,\\mathrm{\\AA}$ 处为 $\\mathrm{O_{acc}}{-}\\mathrm{H_{don}}$ 相互作用恢复了一个急剧上升的排斥墙，这很容易克服在此几何构型下被软化的静电作用，并反转 $E_{\\mathrm{FF}}$ 的符号以匹配 $E_{\\mathrm{QM}} > 0$。结论：正确。\n\nB. 该原因指出缺失极化是问题所在，并建议添加可诱导偶极子。诱导作用是一种吸引性贡献；添加显式极化通常会使氢键更具吸引力，而不是减弱。Thole 阻尼可以缓解短程的极化灾难，但添加极化的净效应不是在指定几何构型下产生排斥；它通常会增加吸引力，从而加剧差异。结论：不正确。\n\nC. 该原因强调了受体静电作用的各向同性，并提议引入偏离中心的孤对电子位点或多极矩来强制实现方向性。虽然引入各向异性会惩罚弯曲的氢键，并在 $\\angle =120^\\circ$ 时减小吸引性静电作用的强度，但若在 $\\mathrm{H_{don}}$ 上没有显式的排斥核心，仅此一项改变不能保证在 $r=1.60\\,\\mathrm{\\AA}$ 处产生排斥相互作用。经典模型仍然会缺少一种机制来重现 $\\mathrm{O_{acc}}{-}\\mathrm{H_{don}}$ 接触中占主导地位的量子力学交换排斥。因此，作为反转符号的最小单一修改，这是不够的。结论：不正确。\n\nD. 该原因引用了电荷穿透误差，并建议使用阻尼或弥散的静电模型。相对于点电荷，这会减少过度的短程静电吸引，在方向上是有帮助的。然而，在 $\\mathrm{H_{don}}$ 上没有任何排斥项的情况下，仅仅软化静电作用可能不足以在 $r=1.60\\,\\mathrm{\\AA}$ 处产生净排斥，因为对于最近接触对，仍然没有对泡利交换排斥的显式表示。作为一个旨在反转符号的独立最小修改，这不太可能是可靠的。结论：不正确。\n\nE. 该原因将问题归咎于截断伪影。该情景是在固定几何构型下对单个气相二聚体相互作用能的评估；长程截断与如此短距离下的符号错误无关。增加截断半径不会产生短程排斥。结论：不正确。\n\n因此，最佳解释和最有效的最小修正是通过一个适当的排斥项来恢复供体氢上的短程排斥，如选项A所述。", "answer": "$$\\boxed{A}$$", "id": "2456445"}]}