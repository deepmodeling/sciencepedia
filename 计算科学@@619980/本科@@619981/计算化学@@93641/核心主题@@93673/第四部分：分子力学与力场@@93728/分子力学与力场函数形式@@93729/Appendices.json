{"hands_on_practices": [{"introduction": "分子力学力场中最基本的组成部分之一是键伸缩项，通常用简谐振子模型 $V(r) = \\frac{1}{2}k(r-r_e)^2$ 来描述。这个练习将带你运用这一基本原理，通过经典力学计算同位素取代（例如将氢H替换为氘D）对化学键振动频率的影响。通过这个实践，你将深刻理解约化质量（reduced mass）的概念，并看到一个简单的力场模型如何能够预测和解释可在光谱实验中观察到的真实物理现象，即动力学同位素效应（kinetic isotope effect）[@problem_id:2458468]。", "problem": "一个氧-氢键和一个氧-氘键均被模拟为一个孤立的双体系统，在平衡间距$r_{e}$附近通过简谐势$V(r)=\\tfrac{1}{2}k\\left(r-r_{e}\\right)^{2}$相互作用。假设力常数$k$和平衡键长$r_{e}$对于这两个同位素体是相同的，并忽略所有耦合和非谐性。取同位素质量为$m_{\\mathrm{O}}=15.994914\\,\\mathrm{u}$，$m_{\\mathrm{H}}=1.007825\\,\\mathrm{u}$和$m_{\\mathrm{D}}=2.014102\\,\\mathrm{u}$，其中$\\mathrm{u}$表示原子质量单位。仅使用应用于给定势能的经典力学，确定基本振动频率之比$\\nu_{\\mathrm{OH}}/\\nu_{\\mathrm{OD}}$。将您的最终答案表示为一个纯数（无单位），并将结果四舍五入到四位有效数字。", "solution": "问题陈述已经过分析，被认为是有效的。它具有科学依据，表述清晰且客观。它提出了一个经典力学应用于分子振动的标准问题，这是计算化学和光谱学中的一个基本概念。所有必要的数据均已提供，且其假设（如同位素体的势能相同，即玻恩-奥本海默近似）对此级别的分析而言，在物理上是标准的。我们可以开始求解。\n\n问题要求计算氧-氢键和氧-氘键的基本振动频率之比$\\nu_{\\mathrm{OH}}/\\nu_{\\mathrm{OD}}$。这些化学键被模拟为由简谐势描述的孤立双体系统。\n\n一个由质量为$m_1$和$m_2$的两个物体组成的系统的振动，可以简化为单个物体在相同势场中运动的问题，该物体的质量为折合质量$\\mu$。折合质量$\\mu$定义为：\n$$\n\\mu = \\frac{m_1 m_2}{m_1 + m_2}\n$$\n对于O-H系统，其折合质量$\\mu_{\\mathrm{OH}}$为：\n$$\n\\mu_{\\mathrm{OH}} = \\frac{m_{\\mathrm{O}} m_{\\mathrm{H}}}{m_{\\mathrm{O}} + m_{\\mathrm{H}}}\n$$\n对于O-D系统，其折合质量$\\mu_{\\mathrm{OD}}$为：\n$$\n\\mu_{\\mathrm{OD}} = \\frac{m_{\\mathrm{O}} m_{\\mathrm{D}}}{m_{\\mathrm{O}} + m_{\\mathrm{D}}}\n$$\n该系统的势能由简谐势给出：\n$$\nV(r) = \\frac{1}{2}k(r - r_e)^2\n$$\n其中$k$是力常数，$r_e$是平衡键长。作用在等效单体上的力$F$由势能相对于偏离平衡位置的位移$x = r - r_e$的负梯度给出：\n$$\nF = -\\frac{dV}{dx} = -\\frac{d}{dx} \\left( \\frac{1}{2}kx^2 \\right) = -kx\n$$\n根据牛顿第二定律$F = ma$，对于我们的等效单体系统，该定律变为$F = \\mu \\ddot{x}$，其中$\\ddot{x}$是加速度。\n$$\n\\mu \\ddot{x} = -kx\n$$\n整理后得到简谐运动的标准方程：\n$$\n\\ddot{x} + \\left(\\frac{k}{\\mu}\\right)x = 0\n$$\n该微分方程的通解描述了角频率为$\\omega$的正弦振荡，其角频率由下式给出：\n$$\n\\omega^2 = \\frac{k}{\\mu} \\implies \\omega = \\sqrt{\\frac{k}{\\mu}}\n$$\n基本振动频率$\\nu$与角频率$\\omega$的关系为$\\omega = 2\\pi\\nu$。因此：\n$$\n\\nu = \\frac{\\omega}{2\\pi} = \\frac{1}{2\\pi}\\sqrt{\\frac{k}{\\mu}}\n$$\n我们需要求出比值$\\nu_{\\mathrm{OH}} / \\nu_{\\mathrm{OD}}$。使用$\\nu$的表达式：\n$$\n\\frac{\\nu_{\\mathrm{OH}}}{\\nu_{\\mathrm{OD}}} = \\frac{\\frac{1}{2\\pi}\\sqrt{\\frac{k}{\\mu_{\\mathrm{OH}}}}}{\\frac{1}{2\\pi}\\sqrt{\\frac{k}{\\mu_{\\mathrm{OD}}}}}\n$$\n问题陈述说明，两种同位素体的力常数$k$是相同的。常数$1/(2\\pi)$和$k$相互抵消，剩下：\n$$\n\\frac{\\nu_{\\mathrm{OH}}}{\\nu_{\\mathrm{OD}}} = \\sqrt{\\frac{1/\\mu_{\\mathrm{OH}}}{1/\\mu_{\\mathrm{OD}}}} = \\sqrt{\\frac{\\mu_{\\mathrm{OD}}}{\\mu_{\\mathrm{OH}}}}\n$$\n现在，我们代入折合质量的表达式：\n$$\n\\frac{\\nu_{\\mathrm{OH}}}{\\nu_{\\mathrm{OD}}} = \\sqrt{\\frac{\\frac{m_{\\mathrm{O}} m_{\\mathrm{D}}}{m_{\\mathrm{O}} + m_{\\mathrm{D}}}}{\\frac{m_{\\mathrm{O}} m_{\\mathrm{H}}}{m_{\\mathrm{O}} + m_{\\mathrm{H}}}}} = \\sqrt{\\frac{m_{\\mathrm{D}}(m_{\\mathrm{O}} + m_{\\mathrm{H}})}{m_{\\mathrm{H}}(m_{\\mathrm{O}} + m_{\\mathrm{D}})}}\n$$\n使用所提供的同位素质量：\n$m_{\\mathrm{O}} = 15.994914\\,\\mathrm{u}$\n$m_{\\mathrm{H}} = 1.007825\\,\\mathrm{u}$\n$m_{\\mathrm{D}} = 2.014102\\,\\mathrm{u}$\n\n首先，我们计算折合质量。原子质量单位（$\\mathrm{u}$）在最终的比值中会消掉，所以我们可以直接使用数值进行计算。\n$$\n\\mu_{\\mathrm{OH}} = \\frac{(15.994914)(1.007825)}{15.994914 + 1.007825} = \\frac{16.1199320}{17.002739} \\approx 0.9480838\\,\\mathrm{u}\n$$\n$$\n\\mu_{\\mathrm{OD}} = \\frac{(15.994914)(2.014102)}{15.994914 + 2.014102} = \\frac{32.2155855}{18.009016} \\approx 1.788856\\,\\mathrm{u}\n$$\n现在我们计算该比值：\n$$\n\\frac{\\nu_{\\mathrm{OH}}}{\\nu_{\\mathrm{OD}}} = \\sqrt{\\frac{\\mu_{\\mathrm{OD}}}{\\mu_{\\mathrm{OH}}}} \\approx \\sqrt{\\frac{1.788856}{0.9480838}} \\approx \\sqrt{1.886801} \\approx 1.373609\n$$\n问题要求将结果四舍五入到四位有效数字。\n$$\n1.373609 \\approx 1.374\n$$\n这个结果展示了振动频率的同位素效应：较重的同位素体（O-D）的振动频率低于较轻的同位素体（O-H）。", "answer": "$$\n\\boxed{1.374}\n$$", "id": "2458468"}, {"introduction": "一个完备的力场是多个能量项之间精妙平衡的结果，缺少任何一项都可能导致对分子结构的荒谬预测。这个思想实验旨在揭示角弯曲项在确定分子几何构型中的关键作用。通过构建一个仅包含键伸缩和非键相互作用的简化水分子模型，你将探索在没有明确的角度势能约束时，分子会如何最小化其能量 [@problem_id:2458473]。这个练习强调了非键相互作用（如范德华力和静电力）的重要性，并凸显了为什么一个精确的力场必须包含专门的角弯曲项。", "problem": "一个孤立的水分子由一个经典分子力学力场建模，该力场仅包含两种类型的能量项：每个O–H键的简谐O–H键伸缩项，以及由Lennard-Jones (LJ)和库仑静电相互作用组成的对非键相互作用。假设如下：\n- 非键相互作用针对所有非直接成键的原子对进行计算，即包括分子内的H–H（1–3）相互作用，但不包括O–H（1–2）的非键相互作用。\n- 两个O–H键是等价的，并共享相同的简谐参数，平衡键长为 $r_0$。\n- 氧原子带有 $-2q$ 的部分电荷，每个氢原子带有 $+q$ 的部分电荷，其中 $q>0$，因此分子是电中性的。不需要具体的数值。\n- 没有显式的键角弯曲项，也没有非正常扭转项或平面外项。\n\n在这些假设下，$0\\,\\mathrm{K}$ 能量最小化结构中，预测的H–O–H键角是多少？\n\nA) $104.5^\\circ$\n\nB) $0^\\circ$\n\nC) $180^\\circ$\n\nD) 不确定；任何角度都具有相同的能量", "solution": "首先必须验证问题陈述的科学性和逻辑完整性。\n\n### 步骤1：提取已知条件\n-   **体系**：一个孤立的水分子。\n-   **力场模型**：经典分子力学。\n-   **包含的能量项**：\n    1.  每个O–H键的简谐O–H键伸缩项。\n    2.  对非键相互作用：Lennard-Jones (LJ) 和库仑静电相互作用。\n-   **非键相互作用规则**：\n    -   针对所有非直接成键的原子对进行计算。\n    -   包括分子内的H–H（$1$–$3$）相互作用。\n    -   不包括O–H（$1$–$2$）的非键相互作用。\n-   **键项参数**：\n    -   两个O–H键是等价的。\n    -   共享简谐参数。\n    -   平衡键长为 $r_0$。\n-   **静电参数**：\n    -   氧原子部分电荷：$-2q$。\n    -   氢原子部分电荷：$+q$。\n    -   条件：$q>0$。\n-   **排除的能量项**：\n    -   无显式键角弯曲项。\n    -   无非正常扭转项。\n    -   无平面外项。\n-   **目标**：找出在 $0\\,\\mathrm{K}$ 能量最小化结构中预测的H–O–H键角。\n\n### 步骤2：使用已知条件进行验证\n该问题使用分子力学力场的标准组件，描述了一个简化但定义明确的水分子理论模型。这些组件（简谐键、Lennard-Jones、库仑）是基础的，并且描述正确。应用这些能量项的规则（例如，排除 $1$–$2$ 非键相互作用）是该领域的标准做法。该设定是一个清晰且可解的势能最小化问题。\n\n-   **科学依据**：该问题很好地基于计算化学和力场建模的原理。它代表了一个有效但简化的物理模型。\n-   **适定性**：该问题是适定的。它要求找到使一个明确定义的势能函数最小化的几何构型。预期存在唯一的最小值。\n-   **客观性**：语言精确、专业，没有歧义或主观性。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。它自成体系、科学合理且明确。可以推导出严谨的解。\n\n### 解的推导\n水分子的几何构型由使总势能 $U_{total}$ 最小化的坐标集决定。在此模型中，总势能是键伸缩能和非键相互作用能之和。\n$$ U_{total} = U_{bond} + U_{non-bonded} $$\n设两个O–H键的键长分别为 $r_1$ 和 $r_2$，H–O–H键角为 $\\theta$。\n\n键伸缩能由下式给出：\n$$ U_{bond} = \\frac{1}{2} k_b (r_1 - r_0)^2 + \\frac{1}{2} k_b (r_2 - r_0)^2 $$\n其中 $k_b$ 是键力常数，$r_0$ 是平衡键长。当 $r_1 = r_2 = r_0$ 时，该能量最小。虽然非键作用力可能会使键长与 $r_0$ 略有偏差，但键伸缩势通常非常“刚性”（即 $k_b$ 很大），因此在确定键角时，我们可以假设键长固定在其最小能量值 $r_0$。因此，$U_{bond}$ 可以被视为值为 $0$ 的常数。\n\n根据问题陈述，非键能 $U_{non-bonded}$ 仅包含两个氢原子之间的相互作用（一种 $1$–$3$ 相互作用）。O–H的非键相互作用（$1$–$2$）被明确排除。\n$$ U_{non-bonded} = U_{H-H} $$\n这种相互作用由一个Lennard-Jones项和一个库仑项组成：\n$$ U_{H-H}(r_{HH}) = U_{LJ}(r_{HH}) + U_{Coulomb}(r_{HH}) $$\n其中 $r_{HH}$ 是两个氢原子之间的距离。\n\n库仑项源于两个氢原子之间的静电相互作用，每个氢原子带有 $+q$ 的电荷：\n$$ U_{Coulomb}(r_{HH}) = \\frac{1}{4\\pi\\epsilon_0} \\frac{q \\cdot q}{r_{HH}} = \\frac{q^2}{4\\pi\\epsilon_0 r_{HH}} $$\n由于 $q>0$，所以 $q^2$ 是正数。此项是纯粹排斥的，并随着 $r_{HH}$ 的增加而单调递减。\n\nLennard-Jones项为：\n$$ U_{LJ}(r_{HH}) = 4\\epsilon_{HH} \\left[ \\left(\\frac{\\sigma_{HH}}{r_{HH}}\\right)^{12} - \\left(\\frac{\\sigma_{HH}}{r_{HH}}\\right)^{6} \\right] $$\n该项包含一个非常强的短程排斥部分（$r_{HH}^{-12}$ 部分）和一个较弱的中程吸引部分（$r_{HH}^{-6}$ 部分）。对于分子内的 $1$–$3$ H–H距离，其间距通常足够小，使得相互作用由排斥的 $r_{HH}^{-12}$ 项主导。\n\n因此，总的H–H相互作用势 $U_{H-H}$ 由排斥作用主导。静电和Lennard-Jones空间位阻部分都对两个氢原子之间的强排斥力有贡献。一个根本上是排斥的势是原子间距 $r_{HH}$ 的单调递减函数。因此，要最小化 $U_{H-H}$，必须最大化距离 $r_{HH}$。\n\n距离 $r_{HH}$ 是H–O–H键角 $\\theta$ 的函数。对边长为 $r_{OH} = r_0$ 的H–O–H等腰三角形使用余弦定理：\n$$ r_{HH}^2 = r_0^2 + r_0^2 - 2 r_0 r_0 \\cos\\theta = 2r_0^2(1 - \\cos\\theta) $$\n使用三角恒等式 $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$，我们得到：\n$$ r_{HH} = \\sqrt{4r_0^2\\sin^2(\\frac{\\theta}{2})} = 2r_0 \\left| \\sin(\\frac{\\theta}{2}) \\right| $$\n对于物理相关的角度范围 $\\theta \\in [0^\\circ, 180^\\circ]$（或 $[0, \\pi]$ 弧度），$\\sin(\\theta/2)$ 是非负的，所以：\n$$ r_{HH}(\\theta) = 2r_0 \\sin(\\frac{\\theta}{2}) $$\n要最大化 $r_{HH}$，我们必须最大化 $\\sin(\\theta/2)$。$\\sin(\\theta/2)$ 的最大值为 $1$，这发生在 $\\theta/2 = 90^\\circ$ 时。这对应于 $\\theta = 180^\\circ$ 的角度。\n\n由于总能量对角度的依赖关系 $U_{total}(\\theta)$ 完全通过排斥性的 $U_{H-H}(r_{HH}(\\theta))$ 项体现，最小化总能量需要最大化 $r_{HH}$，这又需要设置 $\\theta = 180^\\circ$。该问题的关键因素是明确排除了简谐键角弯曲项，在更真实的力场中，该项会提供一个恢复力，以将键角保持在其实验值附近。没有它，排斥性的非键作用力将不受任何制约。\n\n### 选项评估\n-   **A) $104.5^\\circ$**：这是水的实验键角。这个结果是通过包含特定键角弯曲势（形式为 $U_{angle} = \\frac{1}{2} k_\\theta (\\theta - \\theta_0)^2$，其中 $\\theta_0$ 被参数化为接近 $104.5^\\circ$）的模型获得的。问题明确排除了此项。因此，该选项**错误**。\n-   **B) $0^\\circ$**：$\\theta = 0^\\circ$ 的键角将意味着 $r_{HH}=0$。这将导致排斥性的Lennard-Jones和库仑能量项变为无穷大。这代表了能量最大的构型，而不是最小。这个选项显然是荒谬的。因此，该选项**错误**。\n-   **C) $180^\\circ$**：$\\theta = 180^\\circ$ 的键角使两个氢原子之间的距离 $r_{HH}$ 最大化。如前所述，在所有相关距离上，相互作用势 $U_{H-H}$ 都是排斥的。最大化间距可以最小化这种排斥能。由于这是势能中唯一与角度相关的项，因此该构型对应于给定模型的全局能量最小值。因此，该选项**正确**。\n-   **D) 不确定；任何角度都具有相同的能量**：这是错误的。总能量取决于H–H非键相互作用，而该相互作用是H–H距离 $r_{HH}$ 的函数。由于 $r_{HH}$ 是角度 $\\theta$ 的函数，所以总能量也是 $\\theta$ 的函数。能量并非对所有角度都恒定。因此，该选项**错误**。", "answer": "$$\\boxed{C}$$", "id": "2458473"}, {"introduction": "二面角（或扭转角）项是力场中最复杂但也是决定分子构象多样性的关键部分。这个综合性练习将让你扮演一次计算化学家的角色，体验力场参数化的一个核心任务。你将使用一个傅立叶级数 $V(\\phi)$ 来拟合由量子力学计算得到的丁烷分子中心碳-碳键的扭转势能曲线，并从拟合得到的系数（$V_1$, $V_2$, $V_3$）中发掘其物理意义 [@problem_id:2458507]。这项实践将理论与实际应用联系起来，展示了如何将一个数学模型与其所代表的物理相互作用（如空间位阻和扭转应力）对应起来。", "problem": "给定丁烷中绕中心碳-碳键旋转的势能扫描数据，该数据由 $\\mathrm{C{-}C{-}C{-}C}$ 扭转的二面角 $\\phi$ 参数化。在分子力学中，用于扭转贡献的标准截断傅里叶级数是\n$$\nV(\\phi) \\;=\\; \\sum_{n=1}^{3} \\frac{V_n}{2}\\,\\bigl[\\,1 + \\cos\\!\\bigl(n\\phi - \\gamma\\bigr)\\,\\bigr],\n$$\n其中 $\\phi$ 是二面角，$V_n$ 是具有能量单位的实系数，$\\gamma$ 是一个相位。对于丁烷中对称的 $\\mathrm{sp^3{-}sp^3}$ 扭转，基于对称性考虑，假设 $\\gamma = 0$。角度 $\\phi$ 以度为单位提供；任何三角函数求值都必须使用弧度单位的 $\\phi$。能量单位为 $\\mathrm{kcal\\,mol^{-1}}$，并且报告时也必须使用 $\\mathrm{kcal\\,mol^{-1}}$。\n\n请通过最小化模型与所提供能量值之间的残差平方和，将系数 $V_1$、$V_2$ 和 $V_3$ 拟合到以下三个测试扫描数据中，仅使用上述 $\\gamma=0$ 且 $n \\in \\{1,2,3\\}$ 的模型。报告每种情况下拟合得到的 $V_1$、$V_2$ 和 $V_3$。然后，单独地（不在程序输出中），解释在丁烷扭转能学的背景下，$V_1$、$V_2$ 和 $V_3$ 项的物理意义。\n\n角度单位：所提供的数据以度为单位；余弦函数内部使用弧度。能量单位：所有报告的 $V_n$ 均使用 $\\mathrm{kcal\\,mol^{-1}}$。将报告的每个 $V_n$ 四舍五入到三位小数。\n\n测试套件（每种情况由相同的角度网格和对应的能量列表组成）：\n- 角度网格 $\\{\\phi_k\\}$（单位：度，适用于所有情况）：$\\bigl[\\,0^\\circ,\\,30^\\circ,\\,60^\\circ,\\,90^\\circ,\\,120^\\circ,\\,150^\\circ,\\,180^\\circ,\\,210^\\circ,\\,240^\\circ,\\,270^\\circ,\\,300^\\circ,\\,330^\\circ\\,\\bigr]$。\n\n- 情况 A（真实的类丁烷构型）：能量（单位：$\\mathrm{kcal\\,mol^{-1}}$），\n$\\bigl[\\,3.500,\\,1.500,\\,-0.250,\\,2.250,\\,4.250,\\,1.500,\\,-1.000,\\,1.500,\\,4.250,\\,2.250,\\,-0.250,\\,1.500\\,\\bigr]$。\n\n- 情况 B（边界情况：在零点的平坦构型）：能量（单位：$\\mathrm{kcal\\,mol^{-1}}$），\n$\\bigl[\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000\\,\\bigr]$。\n\n- 情况 C（边缘情况：纯粹的三重周期性）：能量（单位：$\\mathrm{kcal\\,mol^{-1}}$），\n$\\bigl[\\,2.000,\\,1.000,\\,0.000,\\,1.000,\\,2.000,\\,1.000,\\,0.000,\\,1.000,\\,2.000,\\,1.000,\\,0.000,\\,1.000\\,\\bigr]$。\n\n最终输出格式：你的程序应生成单行输出，其中包含一个列表，内含三个拟合后的三元组，顺序为情况 A、情况 B、情况 C 的 $\\bigl[V_1,V_2,V_3\\bigr]$。要求的精确格式是一个 Python 风格的列表嵌套列表，每个 $V_n$ 四舍五入到三位小数，例如：\n$[[v_{1,A},v_{2,A},v_{3,A}],[v_{1,B},v_{2,B},v_{3,B}],[v_{1,C},v_{2,C},v_{3,C}]]$\n其中每个 $v_{i,j}$ 是一个以 $\\mathrm{kcal\\,mol^{-1}}$ 为单位的十进制数，小数点后有三位数字。", "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上是合理的、问题是适定的、客观的，并且包含了推导出唯一解所需的所有必要信息。该任务是计算化学和分子力学背景下的一个标准线性最小二乘拟合问题。\n\n问题要求将扭转势模型\n$$V(\\phi) = \\sum_{n=1}^{3} \\frac{V_n}{2}\\,\\bigl[\\,1 + \\cos(n\\phi)\\,\\bigr]$$\n的系数 $V_1$、$V_2$ 和 $V_3$ 拟合到三组给定的能量数据。这个任务可以表述为一个线性最小二乘问题。该模型相对于参数 $V_1$、$V_2$ 和 $V_3$ 是线性的。我们可以将模型重写为：\n$$V(\\phi) = V_1 f_1(\\phi) + V_2 f_2(\\phi) + V_3 f_3(\\phi)$$\n其中基函数为 $f_n(\\phi) = \\frac{1}{2}\\bigl(1 + \\cos(n\\phi)\\bigr)$。\n\n对于一组给定的 $M$ 个数据点 $(\\phi_k, E_k)$，其中 $k=1, \\dots, M$，我们希望找到系数向量 $\\mathbf{V} = [V_1, V_2, V_3]^T$ 以最小化残差平方和 $S$：\n$$S = \\sum_{k=1}^{M} \\left( E_k - V(\\phi_k) \\right)^2 = \\sum_{k=1}^{M} \\left( E_k - \\sum_{n=1}^{3} V_n f_n(\\phi_k) \\right)^2$$\n这个最小化问题等同于在最小二乘意义下求解矩阵方程 $A\\mathbf{V} = \\mathbf{E}$。在这里，$\\mathbf{E}$ 是观测能量的 $M \\times 1$ 列向量，$\\mathbf{V}$ 是未知系数的 $3 \\times 1$ 列向量，而 $A$ 是 $M \\times 3$ 的设计矩阵。设计矩阵的元素由 $A_{kn} = f_n(\\phi_k)$ 给出。在这个问题中，我们有 $M=12$ 个数据点。角度 $\\phi_k$ 以度为单位提供，在进行三角函数求值前必须转换为弧度。\n\n$\\mathbf{V}$ 的最小二乘解可以通过求解正规方程 $(A^T A)\\mathbf{V} = A^T \\mathbf{E}$ 来找到。获得此解的一种数值稳定方法是使用标准的线性最小二乘求解器，例如 `numpy.linalg.lstsq`。\n\n步骤如下：\n1.  构建 $12 \\times 3$ 的设计矩阵 $A$。角度由 $\\{\\phi_k\\} = [0^\\circ, 30^\\circ, \\dots, 330^\\circ]$ 给出。将它们转换为弧度。$A$ 的三列是向量，其中第 $n$ 列的第 $k$ 个元素是 $\\frac{1}{2}(1 + \\cos(n\\phi_k))$。\n2.  对于三个测试用例（A、B、C）中的每一个，定义相应的 $12 \\times 1$ 能量向量 $\\mathbf{E}$。\n3.  使用线性最小二乘算法求解系统 $A\\mathbf{V} = \\mathbf{E}$，得到 $\\mathbf{V} = [V_1, V_2, V_3]^T$。\n4.  收集所有三种情况得到的系数向量。\n5.  按照指定格式化结果，将每个系数四舍五入到三位小数。\n\n傅里叶系数 $V_n$ 的物理解释：\n傅里叶级数是表示周期函数的通用数学方法。在丁烷中心 $\\mathrm{C-C}$ 键的二面角势背景下，每一项都与控制分子构象能学的相互作用有物理上的对应关系。\n\n- **$V_1$ 项 ($n=1$)：** 此项的周期性为 $360^\\circ$。它决定了完全重叠的顺式共平面构象 ($\\phi=0^\\circ$) 与交错的反式共平面构象 ($\\phi=180^\\circ$) 之间的能量差。对此项的主要贡献来自两个庞大的末端甲基之间的强位阻排斥（范德华排斥）。这种相互作用在 $\\phi=0^\\circ$ 时最大，在 $\\phi=180^\\circ$ 时最小。一个正的 $V_1$ 系数正确地使顺式构象成为高能态，反式构象成为低能态。\n\n- **$V_2$ 项 ($n=2$)：** 此项的周期性为 $180^\\circ$，有助于更普遍地描述重叠构象和交错构象之间的能量差异。然而，它的主要作用是区分两种类型的交错式构象异构体（$180^\\circ$ 的反式构象与 $\\pm 60^\\circ$ 的邻位构象）以及两种主要类型的重叠式构象异构体（$0^\\circ$ 与 $\\pm 120^\\circ$）。此项可能与超共轭等电子效应有关，这些效应可能稳定键的垂直排列，但其解释不如 $V_1$ 和 $V_3$ 项直接。\n\n- **$V_3$ 项 ($n=3$)：** 此项的周期性为 $120^\\circ$，反映了 $\\mathrm{sp^3-sp^3}$ 单键的三重对称性。这是旋转势垒的基本的、“类乙烷”的组成部分。它代表了体系对交错构象（例如 $\\phi = 60^\\circ, 180^\\circ, 300^\\circ$）相对于重叠构象（例如 $\\phi = 0^\\circ, 120^\\circ, 240^\\circ$）的内在偏好。这种偏好主要源于两个中心碳原子上化学键的电子云之间的泡利排斥（位阻）。一个正的 $V_3$ 系数确保了所有交错形式的能量都低于所有重叠形式，从而产生了特征性的三重势垒轮廓。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Fits torsional potential parameters V_n to given energy scans for butane.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = {\n        \"angles_deg\": [\n            0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, \n            210.0, 240.0, 270.0, 300.0, 330.0\n        ],\n        \"A\": {\n            \"energies\": [\n                3.500, 1.500, -0.250, 2.250, 4.250, 1.500, -1.000, \n                1.500, 4.250, 2.250, -0.250, 1.500\n            ]\n        },\n        \"B\": {\n            \"energies\": [\n                0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,\n                0.000, 0.000, 0.000, 0.000, 0.000\n            ]\n        },\n        \"C\": {\n            \"energies\": [\n                2.000, 1.000, 0.000, 1.000, 2.000, 1.000, 0.000,\n                1.000, 2.000, 1.000, 0.000, 1.000\n            ]\n        }\n    }\n\n    # Extract angle grid and convert to radians\n    phi_deg = np.array(test_cases[\"angles_deg\"])\n    phi_rad = np.deg2rad(phi_deg)\n\n    # --- Construct the design matrix A ---\n    # The model is V(phi) = sum_{n=1 to 3} V_n * f_n(phi)\n    # where f_n(phi) = 0.5 * (1 + cos(n*phi))\n    # The columns of A are the basis functions f_n evaluated at each angle phi_k.\n    f1 = 0.5 * (1 + np.cos(1 * phi_rad))\n    f2 = 0.5 * (1 + np.cos(2 * phi_rad))\n    f3 = 0.5 * (1 + np.cos(3 * phi_rad))\n    \n    # Design matrix A (size 12x3)\n    A = np.vstack([f1, f2, f3]).T\n\n    results = []\n    # Loop through the cases to fit\n    for case_id in [\"A\", \"B\", \"C\"]:\n        # Energy vector E (size 12x1)\n        E = np.array(test_cases[case_id][\"energies\"])\n        \n        # Solve the linear least squares problem A*V = E for V=[V1, V2, V3]\n        # np.linalg.lstsq returns a tuple; the first element is the solution vector.\n        V, _, _, _ = np.linalg.lstsq(A, E, rcond=None)\n        \n        results.append(V)\n\n    # --- Format the output as specified ---\n    # Example format: [[v1A,v2A,v3A],[v1B,v2B,v3B],[v1C,v2C,v3C]]\n    # with each value rounded to three decimal places.\n    \n    outer_list = []\n    for res in results:\n        # Format each coefficient to 3 decimal places\n        inner_list_str = \",\".join([f\"{x:.3f}\" for x in res])\n        outer_list.append(f\"[{inner_list_str}]\")\n        \n    final_output_string = f\"[{','.join(outer_list)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "2458507"}]}