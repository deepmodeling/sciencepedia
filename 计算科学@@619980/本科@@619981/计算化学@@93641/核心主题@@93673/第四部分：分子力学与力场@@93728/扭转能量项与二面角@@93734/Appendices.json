{"hands_on_practices": [{"introduction": "在我们深入研究复杂的数值计算之前，利用化学直觉来理解扭转势能的基本形式至关重要。本练习作为一个思想实验，要求你基于分子的对称性和成键原理，为假设的分子选择最合适的扭转参数[@problem_id:2466246]。通过这个过程，你将学会如何判断决定扭转轮廓的关键因素——周期性 $n$ 和相位角 $\\delta$，从而为更复杂的力场参数化打下坚实的直觉基础。", "problem": "在分子力学力场中，围绕可旋转键的扭转（二面角）能量通常表示为以下形式的截断傅里叶级数\n$$\nV(\\phi) \\;=\\; \\sum_{n} k_n \\,\\bigl[1 + \\cos(n\\phi - \\delta_n)\\bigr],\n$$\n其中 $\\phi$ 是二面角，$n$ 是周期性，$k_n$ 是非负振幅，$\\delta_n$ 是相位。考虑一个虚构分子“氮杂丁烷”(azabutane)，其结构为 $\\mathrm{CH_3-CH_2-NH-CH_3}$，该分子有三个不同的可旋转键，分别是一个中心的 $\\mathrm{C(sp^3)-C(sp^3)}$ 键和两个对称等价的 $\\mathrm{C(sp^3)-N(sp^3)}$ 键。仅使用基于第一性原理的对称性和化学键合论证，并通过与正丁烷（$n$-butane）（用于 $\\mathrm{C(sp^3)-C(sp^3)}$ 键）的类比以及与N-甲基乙酰胺（$N$-methylacetamide）的酰胺扭转（用于与具有部分双键性质的 $\\mathrm{C{-}N}$ 键进行定性对比）的对比，为氮杂丁烷选择能够正确捕捉其扭转能极小值位置的最小且完备的扭转参数集。假设如果对称性允许，每个中心键都可以用一个主导傅里叶项来描述，并且围绕 $\\mathrm{sp^3{-}sp^3}$ 单键的交错构象是能量极小值点。\n\n哪一个选项是氮杂丁烷最合适的参数化方案？\n\nA. 对于 $\\mathrm{C{-}C}$ 键：只有一个 $n{=}3$ 项，其中 $\\delta{=}0$ 且 $k_3^{\\mathrm{CC}}{>}0$；对于每个 $\\mathrm{C{-}N}$ 键：只有一个 $n{=}3$ 项，其中 $\\delta{=}0$ 且 $k_3^{\\mathrm{CN}}{>}0$；所有其他 $k_n{=}0$。\n\nB. 对于 $\\mathrm{C{-}C}$ 键：只有一个 $n{=}3$ 项，其中 $\\delta{=}0$ 且 $k_3^{\\mathrm{CC}}{>}0$；对于每个 $\\mathrm{C{-}N}$ 键：只有一个 $n{=}2$ 项，其中 $\\delta{=}\\pi$ 且 $k_2^{\\mathrm{CN}}{>}0$；所有其他 $k_n{=}0$。\n\nC. 对于 $\\mathrm{C{-}C}$ 键：只有一个 $n{=}2$ 项，其中 $\\delta{=}0$ 且 $k_2^{\\mathrm{CC}}{>}0$；对于每个 $\\mathrm{C{-}N}$ 键：只有一个 $n{=}3$ 项，其中 $\\delta{=}0$ 且 $k_3^{\\mathrm{CN}}{>}0$；所有其他 $k_n{=}0$。\n\nD. 对于 $\\mathrm{C{-}C}$ 键：只有一个 $n{=}3$ 项，其中 $\\delta{=}\\pi$ 且 $k_3^{\\mathrm{CC}}{>}0$；对于每个 $\\mathrm{C{-}N}$ 键：只有一个 $n{=}3$ 项，其中 $\\delta{=}\\pi$ 且 $k_3^{\\mathrm{CN}}{>}0$；所有其他 $k_n{=}0$。\n\nE. 对于 $\\mathrm{C{-}C}$ 键和每个 $\\mathrm{C{-}N}$ 键：都只有一个 $n{=}1$ 项，其中 $\\delta{=}0$ 且 $k_1{>}0$；所有其他 $k_n{=}0$。", "solution": "首先必须确定问题陈述的有效性。\n\n**步骤1：提取已知条件**\n- 扭转能由以下函数形式描述：$$V(\\phi) \\;=\\; \\sum_{n} k_n \\,\\bigl[1 + \\cos(n\\phi - \\delta_n)\\bigr]$$\n- 变量定义如下：$\\phi$ (二面角)，$n$ (周期性)，$k_n$ (非负振幅)，以及 $\\delta_n$ (相位)。\n- 分子是“氮杂丁烷”(azabutane)，结构为 $\\mathrm{CH_3-CH_2-NH-CH_3}$。\n- 需要参数化的可旋转键是一个 $\\mathrm{C(sp^3)-C(sp^3)}$ 键和两个“对称等价”的 $\\mathrm{C(sp^3)-N(sp^3)}$ 键。\n- 任务是选择最小且完备的扭转参数集。\n- 指导原则和假设是：\n    1. 使用对称性和化学键合论证。\n    2. 使用正丁烷 ($n$-butane) 作为 $\\mathrm{C(sp^3)-C(sp^3)}$ 键的类比。\n    3. 使用N-甲基乙酰胺 ($N$-methylacetamide) 作为 $\\mathrm{C{-}N}$ 键的*对比*。\n    4. 假设每个中心键都可以用一个主导傅里叶项来描述。\n    5. 假设围绕 $\\mathrm{sp^3{-}sp^3}$ 单键的交错构象是能量极小值点。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于计算化学和分子力学的原理。所提供的扭转势函数形式是标准的。该分子在化学上是合理的。使用类比是一种有效的教学方法。这些假设为解决问题提供了明确的约束。\n\n有一项陈述需要仔细解释：“两个对称等价的 $\\mathrm{C(sp^3)-N(sp^3)}$ 键”。在分子 $\\mathrm{CH_3-CH_2-NH-CH_3}$ 中（在一般构象下属于 $C_1$ 点群），两个 $\\mathrm{C{-}N}$ 键（如果编号为 `C1-C2-N-C4`，则为 `C2-N` 和 `N-C4`）通过对称操作并非严格等价。然而，在创建通用性力场的背景下，将相同的参数类型分配给化学性质相似的键（例如所有脂肪族的 $\\mathrm{C(sp^3)-N(sp^3)}$ 单键）是一种标准做法。因此，该指令应被解释为参数化的指导，而非对严格分子对称性的陈述。基于此解释，该问题是良定且自洽的。它没有违反任何关键的验证标准。\n\n**步骤3：结论与行动**\n该问题是**有效的**。将推导出解答。\n\n**推导过程**\n\n势能函数为 $V(\\phi) = k_n [1 + \\cos(n\\phi - \\delta_n)]$，其中 $k_n \\ge 0$。能量极小值对应于该函数的最小值，此时 $\\cos(n\\phi - \\delta_n) = -1$。对于任意整数 $m$，该条件为 $n\\phi_{min} - \\delta_n = (2m+1)\\pi$。能量极大值（旋转能垒）出现在 $\\cos(n\\phi - \\delta_n) = +1$ 时，这意味着 $n\\phi_{max} - \\delta_n = 2m\\pi$。问题陈述交错构象是极小值点。重叠构象对应极大值点。\n\n**$\\mathrm{C(sp^3)-C(sp^3)}$ 键的分析：**\n这对应于围绕 $\\mathrm{CH_3-CH_2}$ 键的旋转。甲基（$\\mathrm{CH_3}$）具有局部 $C_{3v}$ 对称性。当它相对于分子的其余部分旋转时，在 $360^\\circ$（或 $2\\pi$ 弧度）的旋转范围内会遇到三个相同的能量壁垒和三个相同的能量极小值。这要求周期项的周期性为 $n=3$，因为势能面必须每 $2\\pi/3$ 弧度（$120^\\circ$）重复一次。\n我们现在必须确定相位 $\\delta_3$。让我们定义二面角 $\\phi=0$ 为重叠构象，它必须是能量极大值点。那么，作为极小值点的交错构象将位于 $\\phi = \\pi/3, \\pi, 5\\pi/3$（$60^\\circ, 180^\\circ, 300^\\circ$）。\n让我们测试选项中给出的两种可能的相位，$\\delta=0$ 和 $\\delta=\\pi$。\n- 如果 $\\delta_3=0$：极大值出现在 $3\\phi_{max} = 2m\\pi \\implies \\phi_{max} = 0, 2\\pi/3, 4\\pi/3$。这些是重叠位置。极小值出现在 $3\\phi_{min} = (2m+1)\\pi \\implies \\phi_{min} = \\pi/3, \\pi, 5\\pi/3$。这些是交错位置。这与第一性原理一致。\n- 如果 $\\delta_3=\\pi$：极大值出现在 $3\\phi_{max} - \\pi = 2m\\pi \\implies \\phi_{max} = (2m+1)\\pi/3$。这些是交错位置。极小值出现在 $3\\phi_{min} - \\pi = (2m+1)\\pi \\implies \\phi_{min} = (2m+2)\\pi/3$。这些是重叠位置。这与交错构象能量更低的基本原理相矛盾。\n因此，对于 $\\mathrm{C-C}$ 键，主导项的正确参数是 $n=3$ 和 $\\delta_3=0$。振幅 $k_3^{\\mathrm{CC}}$ 必须为正以产生能垒。\n\n**$\\mathrm{C(sp^3)-N(sp^3)}$ 键的分析：**\n问题指示我们用同一套参数来处理两个 $\\mathrm{C-N}$ 键（`CH2-NH` 和 `NH-CH3`），并使用N-甲基乙酰胺（NMA）进行对比。在NMA中，酰胺 $\\mathrm{C-N}$ 键具有部分双键特性，导致平面结构和高旋转能垒，其主导周期性为 $n=2$。问题中使用“对比”一词意味着氮杂丁烷中的 $\\mathrm{C(sp^3)-N(sp^3)}$ 单键*不应*具有这种行为。因此，主导的 $n=2$ 项是不合适的。\n这些是 $sp^3$ 杂化原子之间的单键。主要的能量考量是空间位阻排斥，这使得交错构象比重叠构象更为有利。\n- 对于 `NH-CH3` 部分，甲基的旋转类似于 `CH3-CH2` 基团中的旋转。它具有局部的3重对称性，因此主导的扭转项必须具有 $n=3$ 的周期性。\n- 对于 `CH2-NH` 键，局部对称性较低。然而，围绕 $sp^3-sp^3$ 键的交错构象的基本偏好是一个通用特征，最好用一个3重势来捕捉。该项确保了在一次完整旋转中有三个极小值和三个极大值。考虑到对两个 `C-N` 键使用单一主导项的约束，以及 `NH-CH3` 情况下对 $n=3$ 的明确要求，为通用的 $\\mathrm{C(sp^3)-N(sp^3)}$ 相互作用选择 $n=3$ 是最合乎逻辑的选择。\n与 $\\mathrm{C-C}$ 键的分析类似，相位必须是 $\\delta_3=0$ 以确保交错位置是极小值点，重叠位置是极大值点。振幅 $k_3^{\\mathrm{CN}}$ 必须为正。\n\n**推导结论：**\n- 对于 $\\mathrm{C-C}$ 键：$n=3$, $\\delta_3=0$, $k_3^{\\mathrm{CC}}>0$。\n- 对于 $\\mathrm{C-N}$ 键：$n=3$, $\\delta_3=0$, $k_3^{\\mathrm{CN}}>0$。\n\n**逐项分析**\n\nA. **对于 $\\mathrm{C{-}C}$ 键：只有一个 $n{=}3$ 项，其中 $\\delta{=}0$ 且 $k_3^{\\mathrm{CC}}{>}0$；对于每个 $\\mathrm{C{-}N}$ 键：只有一个 $n{=}3$ 项，其中 $\\delta{=}0$ 且 $k_3^{\\mathrm{CN}}{>}0$；所有其他 $k_n{=}0$。**\n此选项与我们推导出的参数完全匹配。周期性 $n=3$ 对于涉及 $sp^3$ 甲基的旋转是正确的，并且是通用 $sp^3-sp^3$ 键的标准。相位 $\\delta=0$ 正确地将交错构象设置为极小值点，重叠构象设置为极大值点。这是基于问题前提的正确描述。\n**结论：正确。**\n\nB. **对于 $\\mathrm{C{-}C}$ 键：只有一个 $n{=}3$ 项，其中 $\\delta{=}0$ 且 $k_3^{\\mathrm{CC}}{>}0$；对于每个 $\\mathrm{C{-}N}$ 键：只有一个 $n{=}2$ 项，其中 $\\delta{=}\\pi$ 且 $k_2^{\\mathrm{CN}}{>}0$；所有其他 $k_n{=}0$。**\n$\\mathrm{C-C}$ 键的参数化是正确的。然而，对于 $\\mathrm{C-N}$ 键，它提出了 $n=2$。如前所述， $n=2$ 项是具有部分双键特性导致平面性的键的特征，这与 $\\mathrm{C(sp^3)-N(sp^3)}$ 单键形成了明确的对比。对于饱和胺来说，这在化学上是不正确的。\n**结论：错误。**\n\nC. **对于 $\\mathrm{C{-}C}$ 键：只有一个 $n{=}2$ 项，其中 $\\delta{=}0$ 且 $k_2^{\\mathrm{CC}}{>}0$；对于每个 $\\mathrm{C{-}N}$ 键：只有一个 $n{=}3$ 项，其中 $\\delta{=}0$ 且 $k_3^{\\mathrm{CN}}{>}0$；所有其他 $k_n{=}0$。**\n$\\mathrm{C-N}$ 键的参数化是正确的。然而，对于 $\\mathrm{C-C}$ 键（`CH3-CH2-`），它提出了 $n=2$。甲基的旋转需要3重势（$n=3$），而不是2重势。\n**结论：错误。**\n\nD. **对于 $\\mathrm{C{-}C}$ 键：只有一个 $n{=}3$ 项，其中 $\\delta{=}\\pi$ 且 $k_3^{\\mathrm{CC}}{>}0$；对于每个 $\\mathrm{C{-}N}$ 键：只有一个 $n{=}3$ 项，其中 $\\delta{=}\\pi$ 且 $k_3^{\\mathrm{CN}}{>}0$；所有其他 $k_n{=}0$。**\n此选项正确地确定了两种键类型的周期性均为 $n=3$。然而，它提出了一个 $\\delta=\\pi$ 的相位。正如推导中所示，对于 $n=3$ 项，$\\delta=\\pi$ 的相位会使重叠构象成为能量极小值点，而交错构象成为能量极大值点。这直接违反了基本的空间位阻原理，并与问题的明确假设相矛盾。\n**结论：错误。**\n\nE. **对于 $\\mathrm{C{-}C}$ 键和每个 $\\mathrm{C{-}N}$ 键：都只有一个 $n{=}1$ 项，其中 $\\delta{=}0$ 且 $k_1{>}0$；所有其他 $k_n{=}0$。**\n一个 $n=1$ 的势在 $360^\\circ$ 旋转范围内只有一个极小值和一个极大值。这未能捕捉到旋转甲基时固有的3重对称性，也未能捕捉到围绕 $sp^3-sp^3$ 单键的交错/重叠相互作用的普遍3重性质。虽然 $n=1$ 项可以作为更复杂势的一部分（例如，用于区分反式和旁式），但它不能作为描述这些键的单一主导项。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2466246"}, {"introduction": "化学直觉为我们提供了扭转势能的定性蓝图，而精确的参数则需要从更高层次的理论计算中获得。本练习模拟了力场开发中的一个核心任务：将从量子力学（QM）计算得到的离散势能点，拟合到扭转角的解析函数中[@problem_id:2466268]。通过这个实践，你将掌握一种将第一性原理数据转化为实用力场参数的关键技术，真正连接起理论与应用。", "problem": "给定一个假设的 $H_3C\\text{-}X\\text{-}X\\text{-}CH_3$ 分子，通过量子力学 (QM) 计算得到其三组离散的二面角势能扫描数据。对于 $C\\text{-}X\\text{-}X\\text{-}C$ 二面角，假设其对势能的扭转贡献由以下模型描述：\n$$\nE(\\phi) \\;=\\; E_0 \\;+\\; \\frac{V}{2}\\,\\Big(1 + \\cos\\big(n\\,\\phi - \\gamma\\big)\\Big),\n$$\n其中，$E(\\phi)$ 是能量（单位为 kJ mol$^{-1}$），$\\phi$ 是二面角（单位为度），$E_0$ 是一个未知的能量偏移（单位为 kJ mol$^{-1}$），$V$ 是扭转势垒振幅（单位为 kJ mol$^{-1}$），$n$ 是一个整数周期性，$\\gamma$ 是一个相位角（单位为度）。您的任务是为每次扫描确定一个三元组 $(V,n,\\gamma)$，以使模型与给定数据之间的残差平方和最小化。允许的周期性为 $n \\in \\{1,2,3,4,6\\}$。您必须报告在区间 $[0,360)$ 内的 $\\gamma$ 值（以度为单位），且 $V \\ge 0$。扫描提供的能量已包含任何恒定的基线；您不应报告 $E_0$。\n\n三次扫描均使用同一组二面角\n$$\n\\phi \\in \\{\\,0^\\circ,\\,30^\\circ,\\,60^\\circ,\\,90^\\circ,\\,120^\\circ,\\,150^\\circ,\\,180^\\circ,\\,210^\\circ,\\,240^\\circ,\\,270^\\circ,\\,300^\\circ,\\,330^\\circ\\,\\}.\n$$\n\n对于每次扫描，相应的能量 $E(\\phi)$（单位为 kJ mol$^{-1}$）如下：\n\n- 测试用例 1：\n  $$\n  [\\,12.5,\\,6.5,\\,0.5,\\,6.5,\\,12.5,\\,6.5,\\,0.5,\\,6.5,\\,12.5,\\,6.5,\\,0.5,\\,6.5\\,].\n  $$\n- 测试用例 2：\n  $$\n  [\\,3.55,\\,4.8,\\,3.55,\\,1.05,\\,-0.2,\\,1.05,\\,3.55,\\,4.8,\\,3.55,\\,1.05,\\,-0.2,\\,1.05\\,].\n  $$\n- 测试用例 3：\n  $$\n  [\\,1.2,\\,1.367468,\\,1.825,\\,2.45,\\,3.075,\\,3.532532,\\,3.7,\\,3.532532,\\,3.075,\\,2.45,\\,1.825,\\,1.367468\\,].\n  $$\n\n角度单位要求：所有二面角 $\\phi$ 均以度为单位处理，$\\gamma$ 也以度为单位报告。能量单位要求：所有能量 $E(\\phi)$ 和拟合振幅 $V$ 均以 kJ mol$^{-1}$ 为单位处理。\n\n测试套件与答案规范：\n- 使用上述三次扫描数据，通过最小化给定角度上的残差平方和，为每次扫描确定最佳拟合三元组 $(V,n,\\gamma)$。\n- 将 $n$ 限制在集合 $\\{1, 2, 3, 4, 6\\}$ 内，并确保 $\\gamma \\in [0,360)$（以度为单位）。\n- 您的程序需要输出单行结果，其中包含一个包含三个结果的列表，每个结果都是 $[V,n,\\gamma]$ 形式的列表，其中 $V$ 和 $\\gamma$ 四舍五入到 6 位小数，$n$ 为整数。最终输出必须格式化为一个用方括号括起来的、以逗号分隔的列表，例如：\n$$\n[[V_1,n_1,\\gamma_1],[V_2,n_2,\\gamma_2],[V_3,n_3,\\gamma_3]].\n$$", "solution": "该问题要求为扭转能量模型找到参数 $(V, n, \\gamma)$，使其能最佳拟合三组量子力学数据。该模型由以下函数给出：\n$$\nE(\\phi) \\;=\\; E_0 \\;+\\; \\frac{V}{2}\\,\\Big(1 + \\cos\\big(n\\,\\phi - \\gamma\\big)\\Big),\n$$\n其中，$E(\\phi)$ 是势能，$\\phi$ 是二面角，$E_0$ 是一个恒定的能量偏移，$V$ 是势垒振幅，$n$ 是周期性，$\\gamma$ 是相位角。目标是最小化模型与在相应角度 $\\phi_i$ 上的给定能量数据 $E_i$ 之间的残差平方和 (SSR)：\n$$\n\\text{SSR} \\;=\\; \\sum_{i=1}^{N} \\left[ E_i - E(\\phi_i) \\right]^2.\n$$\n参数 $n$ 被限制在集合 $\\{1, 2, 3, 4, 6\\}$ 中。这是一个非线性最小二乘问题。然而，对于固定的 $n$ 值，该模型可以被线性化。使用差角余弦的三角恒等式 $\\cos(A - B) = \\cos A \\cos B + \\sin A \\sin B$，我们可以将模型方程重写为：\n$$\nE(\\phi) \\;=\\; E_0 \\;+\\; \\frac{V}{2} \\;+\\; \\frac{V}{2}\\cos(\\gamma)\\cos(n\\phi) \\;+\\; \\frac{V}{2}\\sin(\\gamma)\\sin(n\\phi).\n$$\n我们可以定义一组线性系数：\n$$\nC_1 \\;=\\; E_0 + \\frac{V}{2}\n$$\n$$\nC_2 \\;=\\; \\frac{V}{2}\\cos(\\gamma)\n$$\n$$\nC_3 \\;=\\; \\frac{V}{2}\\sin(\\gamma)\n$$\n这将模型转换为关于新系数 $(C_1, C_2, C_3)$ 的线性形式：\n$$\nE(\\phi_i) \\;=\\; C_1 \\cdot 1 \\;+\\; C_2 \\cos(n\\phi_i) \\;+\\; C_3 \\sin(n\\phi_i).\n$$\n对于每个数据扫描和每个允许的 $n$ 值，我们求解一个线性最小二乘问题，以找到使 SSR 最小化的最优系数 $(C_1, C_2, C_3)$。这可以表示为矩阵形式，即寻找向量 $\\mathbf{c}$ 以最小化 $\\|\\mathbf{A}\\mathbf{c} - \\mathbf{y}\\|^2_2$，其中 $\\mathbf{y}$ 是观测能量 $E_i$ 的向量，$\\mathbf{c} = [C_1, C_2, C_3]^T$，$\\mathbf{A}$ 是设计矩阵，其行向量为 $[1, \\cos(n\\phi_i), \\sin(n\\phi_i)]$。在所有计算中，给定的角度 $\\phi_i$（单位为度）必须转换为弧度，因为标准计算库的三角函数是以弧度为单位进行运算的。\n\n一旦对于给定的 $n$ 找到了最优系数 $(C_1, C_2, C_3)$，就可以恢复出原始的物理参数 $V$ 和 $\\gamma$。振幅 $V$ 可以通过观察以下关系式找到：\n$$\nC_2^2 + C_3^2 \\;=\\; \\left(\\frac{V}{2}\\right)^2 (\\cos^2\\gamma + \\sin^2\\gamma) \\;=\\; \\left(\\frac{V}{2}\\right)^2.\n$$\n考虑到约束条件 $V \\ge 0$，我们有：\n$$\nV \\;=\\; 2\\sqrt{C_2^2 + C_3^2}.\n$$\n相位角 $\\gamma$ 由 $C_3$ 与 $C_2$ 的比值确定：\n$$\n\\frac{C_3}{C_2} \\;=\\; \\frac{(V/2)\\sin(\\gamma)}{(V/2)\\cos(\\gamma)} \\;=\\; \\tan(\\gamma).\n$$\n使用双参数反正切函数 $\\operatorname{atan2}(C_3, C_2)$ 来计算 $\\gamma$（以弧度为单位），该函数能根据 $C_2$ 和 $C_3$ 的符号正确地解析其所在象限。然后将结果转换为度，并归一化到指定的区间 $[0, 360)$。需要注意的一点是，未被要求计算的能量偏移 $E_0$ 可以通过 $E_0 = C_1 - V/2 = C_1 - \\sqrt{C_2^2 + C_3^2}$ 来计算。\n\n针对每次数据扫描的总体算法如下：\n1. 将最小 SSR 值初始化为一个大数，并初始化一个数据结构来存储最佳拟合参数。\n2. 对于集合 $\\{1, 2, 3, 4, 6\\}$ 中的每个整数周期性 $n$：\n    a. 使用给定的角度 $\\phi_i$ 构建设计矩阵 $\\mathbf{A}$。\n    b. 求解线性最小二乘问题 $\\mathbf{A}\\mathbf{c} \\approx \\mathbf{y}$ 以获得系数 $\\mathbf{c} = [C_1, C_2, C_3]^T$ 和相应的残差平方和。\n    c. 将当前 SSR 与已存储的最小 SSR 进行比较。如果当前 SSR 更小，则更新最小 SSR，并存储当前的 $n$ 以及从 $C_2$ 和 $C_3$ 计算出的参数 $V$ 和 $\\gamma$ 作为迄今为止的最佳拟合参数。\n3. 遍历所有可能的 $n$ 值后，存储的参数 $(V, n, \\gamma)$ 即代表了此次数据扫描的最佳拟合结果。\n\n对问题中提供的所有三个测试用例重复此过程。这种方法保证了在允许的参数空间内找到 SSR 的全局最小值，因为我们穷举测试了每个离散的 $n$ 值，并且对于每个 $n$，线性最小二乘问题都有唯一的解析解。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the torsional parameters V, n, and gamma for three energy scans\n    by minimizing the sum of squared residuals.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Scan 1\n        np.array([12.5, 6.5, 0.5, 6.5, 12.5, 6.5, 0.5, 6.5, 12.5, 6.5, 0.5, 6.5]),\n        # Scan 2\n        np.array([3.55, 4.8, 3.55, 1.05, -0.2, 1.05, 3.55, 4.8, 3.55, 1.05, -0.2, 1.05]),\n        # Scan 3\n        np.array([1.2, 1.367468, 1.825, 2.45, 3.075, 3.532532, 3.7, 3.532532, 3.075, 2.45, 1.825, 1.367468]),\n    ]\n\n    # Dihedral angles in degrees\n    phi_deg = np.arange(0, 360, 30)\n    \n    # Convert angles to radians for numpy trigonometric functions\n    phi_rad = np.deg2rad(phi_deg)\n\n    # Allowed periodicities\n    n_values = [1, 2, 3, 4, 6]\n\n    final_results = []\n\n    for energy_scan in test_cases:\n        best_fit = {\n            'V': None, \n            'n': None, \n            'gamma': None, \n            'ssr': np.inf\n        }\n\n        for n in n_values:\n            # Construct the design matrix A for the linear least squares problem\n            # E = C1 * 1 + C2 * cos(n*phi) + C3 * sin(n*phi)\n            A = np.zeros((len(phi_rad), 3))\n            A[:, 0] = 1.0\n            A[:, 1] = np.cos(n * phi_rad)\n            A[:, 2] = np.sin(n * phi_rad)\n\n            # Solve the linear least squares problem Ac = E\n            # lstsq returns coefficients, sum of squared residuals, rank, and singular values\n            try:\n                coeffs, residuals, _, _ = np.linalg.lstsq(A, energy_scan, rcond=None)\n                \n                # The 'residuals' is an array. If it's empty, the system was not overdetermined\n                # or was rank deficient. In our case (12 points, 3 params), it should have one element.\n                # If there is a perfect fit, residuals array might be empty depending on numpy version.\n                # It's safer to calculate it if it is empty.\n                if residuals.size == 0:\n                     ssr = np.sum((energy_scan - A @ coeffs)**2)\n                else:\n                     ssr = residuals[0]\n\n            except np.linalg.LinAlgError:\n                # In case of a singular matrix, skip this n\n                continue\n\n            # Check if this fit is the best one so far\n            if ssr  best_fit['ssr']:\n                C1, C2, C3 = coeffs[0], coeffs[1], coeffs[2]\n\n                # Recover V and gamma from C2 and C3\n                # V = 2 * sqrt(C2^2 + C3^2)\n                V = 2.0 * np.sqrt(C2**2 + C3**2)\n                \n                # gamma = atan2(C3, C2)\n                gamma_rad = np.arctan2(C3, C2)\n                gamma_deg = np.degrees(gamma_rad)\n                \n                # Normalize gamma to be in [0, 360)\n                if gamma_deg  0:\n                    gamma_deg += 360.0\n\n                best_fit['V'] = V\n                best_fit['n'] = n\n                best_fit['gamma'] = gamma_deg\n                best_fit['ssr'] = ssr\n\n        final_results.append([best_fit['V'], best_fit['n'], best_fit['gamma']])\n\n    # Format the output string as per the specification\n    result_strings = []\n    for v, n, g in final_results:\n        result_strings.append(f\"[{v:.6f},{n},{g:.6f}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "2466268"}, {"introduction": "拥有了一套力场参数后，我们如何验证其准确性并在实际模拟中发现问题？本练习将你置于计算研究者的角色，面对一个蛋白质侧链在模拟中被“卡”在非天然构象的典型难题[@problem_id:2466279]。你需要分析模拟数据，并结合对热运动和能垒的基本理解，来诊断出最有可能出错的扭转参数。这个练习旨在培养你解决实际模拟问题的诊断能力和批判性思维。", "problem": "一个溶剂化蛋白质中的酪氨酸侧链，使用标准的加性生物分子力场，在温度 $300\\,\\mathrm{K}$ 下进行分子动力学 (MD) 模拟。扭转（二面角）项通过周期性势能 $U_{\\mathrm{tors}}(\\phi)=\\sum_i k_i\\left[1+\\cos\\left(n_i\\phi-\\delta_i\\right)\\right]$ 进行建模，其中 $k_i$ 是势垒振幅，$n_i$ 是周期性，而 $\\delta_i$ 是相移。对于酪氨酸，两个最低阶的侧链二面角定义为 $\\chi_1=\\angle(\\mathrm{N}-\\mathrm{C}_\\alpha-\\mathrm{C}_\\beta-\\mathrm{C}_\\gamma)$ 和 $\\chi_2=\\angle(\\mathrm{C}_\\alpha-\\mathrm{C}_\\beta-\\mathrm{C}_\\gamma-\\mathrm{C}_{\\delta 1})$。在实验测定的天然结构中，该侧链采取的旋转异构体以 $\\chi_1\\approx 180^\\circ$ 和 $\\chi_2\\approx 90^\\circ$ 为特征。\n\n在模拟中，总计 $1.0\\,\\mu\\mathrm{s}$ 的时间内观察到以下行为：\n- $\\chi_1$ 的时间序列和直方图在 $\\chi_1\\approx+60^\\circ$ 处显示一个单一的窄峰，没有发生到其他势阱的自发跃迁。\n- $\\chi_2$ 的时间序列和直方图是双峰的，峰值在 $\\chi_2\\approx +90^\\circ$ 和 $\\chi_2\\approx -90^\\circ$ 附近，并伴有频繁的相互转换（两个势阱之间大约有 $20$ 次势垒穿越）。\n- 一个对照模拟，其中将三个最近的侧链邻居突变为甘氨酸（以减少空间拥挤和特定的非键接触），显示出相同的定性行为：$\\chi_1$ 保持在 $+60^\\circ$ 附近，没有发生跃迁，而 $\\chi_2$ 继续以相似的频率在 $\\pm 90^\\circ$ 之间相互转换。\n\n基于这些观察以及关于温度 $300\\,\\mathrm{K}$ 下扭转势垒和热采样的第一性原理推理，哪个扭转参数最有可能被错误参数化，从而将酪氨酸捕获在非天然的旋转异构体中？\n\nA. $\\chi_1$ 的扭转参数不正确（势垒高度和/或相角过度稳定了 $\\chi_1\\approx+60^\\circ$ 的状态，并使其余势阱无法到达）。\n\nB. $\\chi_2$ 的扭转参数不正确（它们破坏了天然 $\\chi_2$ 取向的稳定性，并间接捕获了 $\\chi_1$）。\n\nC. $\\chi_1$ 和 $\\chi_2$ 的扭转参数都以相互补偿的方式不正确。\n\nD. 扭转参数没有问题；问题在于芳香环碳原子的非键参数，而不在于扭转项。", "solution": "必须首先验证问题陈述的科学合理性和逻辑一致性。\n\n**步骤一：提取已知条件**\n- 系统：一个溶剂化蛋白质中的酪氨酸侧链。\n- 模拟方法：分子动力学 (MD)。\n- 温度：$T = 300\\,\\mathrm{K}$。\n- 力场模型：标准的可加性生物分子力场。\n- 扭转势能：$U_{\\mathrm{tors}}(\\phi)=\\sum_i k_i\\left[1+\\cos\\left(n_i\\phi-\\delta_i\\right)\\right]$，其中 $k_i$ 是势垒振幅，$n_i$ 是周期性，$\\delta_i$ 是相移。\n- 相关二面角：\n    - $\\chi_1 = \\angle(\\mathrm{N}-\\mathrm{C}_\\alpha-\\mathrm{C}_\\beta-\\mathrm{C}_\\gamma)$\n    - $\\chi_2 = \\angle(\\mathrm{C}_\\alpha-\\mathrm{C}_\\beta-\\mathrm{C}_\\gamma-\\mathrm{C}_{\\delta 1})$\n- 实验（天然）结构：$\\chi_1 \\approx 180^\\circ$ 和 $\\chi_2 \\approx 90^\\circ$。\n- 模拟观察（总时长 $1.0\\,\\mu\\mathrm{s}$）：\n    1.  $\\chi_1$ 二面角：在 $\\chi_1 \\approx +60^\\circ$ 处呈现单一的窄布居峰。未观察到向其他构象状态的跃迁。\n    2.  $\\chi_2$ 二面角：呈现双峰布居分布，峰值在 $\\chi_2 \\approx +90^\\circ$ 和 $\\chi_2 \\approx -90^\\circ$ 附近。观察到频繁的势垒穿越（约 $20$ 次）。\n- 对照模拟：将三个最近的邻居侧链突变为甘氨酸。$\\chi_1$ 和 $\\chi_2$ 的定性行为保持不变；$\\chi_1$ 被捕获在 $\\approx +60^\\circ$ 处，而 $\\chi_2$ 继续相互转换。\n\n**步骤二：使用提取的已知条件进行验证**\n该问题具有科学依据。它呈现了计算生物物理学中的一个标准情景，涉及MD模拟、力场和氨基酸侧链的构象分析。用于扭转的势能函数是许多常用力场（例如 AMBER, CHARMM）中使用的标准形式。二面角的定义是正确的。观察到的现象——模拟与实验之间的差异，特别是动力学捕获——是力场开发和验证中一个众所周知且至关重要的问题。使用带有突变的对照模拟是一种有效且强大的方法，用于区分内在参数错误和依赖于环境的人为效应。该问题是良定的，提供了足够的数据以允许对最可能的误差来源进行逻辑推断。语言客观而精确。\n\n**步骤三：结论和行动**\n问题陈述有效。我将继续进行分析。\n\n**解题推导**\n目标是识别造成模拟构象与实验测定的天然构象之间差异的最可能原因。关键的观察是两个二面角 $\\chi_1$ 和 $\\chi_2$ 的动力学行为。\n\n1.  **构象采样分析：** 在有限温度 $T$ 下，处于热平衡的系统根据玻尔兹曼分布 $P(\\mathbf{x}) \\propto \\exp(-U(\\mathbf{x}) / k_B T)$ 采样构象状态，其中 $U(\\mathbf{x})$ 是势能。能量最小值之间的跃迁需要克服其间的能垒。此类跃迁的速率与势垒高度 $\\Delta E^{\\ddagger}$ 呈指数关系。在 $T=300\\,\\mathrm{K}$ 时，热能为 $k_B T \\approx 0.6\\,\\mathrm{kcal/mol} \\approx 2.5\\,\\mathrm{kJ/mol}$。几倍于 $k_B T$ 的势垒通常可以在 MD 模拟可及的时间尺度上被穿越。\n\n2.  **$\\chi_1$ 行为分析：** 模拟显示，在整个 $1.0\\,\\mu\\mathrm{s}$ 的模拟时间内，$\\chi_1$ 被捕获在单一的非天然状态（$\\approx +60^\\circ$）。天然状态是 $\\chi_1 \\approx 180^\\circ$。完全没有跃迁表明，对于给定的热能，要从 $\\chi_1 \\approx +60^\\circ$ 的势阱中旋转出来的能垒过高。这意味着，由力场描述的沿 $\\chi_1$ 坐标的势能面在 $\\approx +60^\\circ$ 处有一个人为过深的极小值，和/或有一个过高的势垒将其与其他极小值（包括天然的 $180^\\circ$ 状态）分离开来。此势能面的内在形状主要由 $\\chi_1$ 二面角的扭转参数（$k_i, n_i, \\delta_i$）决定。\n\n3.  **$\\chi_2$ 行为分析：** 相比之下，$\\chi_2$ 二面角在两个状态 $\\approx +90^\\circ$ 和 $\\approx -90^\\circ$ 之间表现出频繁的跃迁。其中之一（$\\approx +90^\\circ$）对应于天然结构。这种动态行为表明，$\\chi_2$ 旋转的能垒足够低，在 $300\\,\\mathrm{K}$ 时可以轻易被热能克服。对于围绕 $\\mathrm{C}_\\beta-\\mathrm{C}_\\gamma$ 键的旋转来说，这种行为是符合物理预期的，因为该键由于芳香环的存在而具有显著的双键特性，通常用主要的二重周期性 ($n=2$) 来建模。虽然这两个状态的相对布居数可能不完全准确，但关键点在于，系统相对于 $\\chi_2$ 并没有被动力学捕获。$\\chi_2$ 的参数允许进行构象采样，这与 $\\chi_1$ 的情况有根本的不同。\n\n4.  **对照模拟的解读：** 对照模拟将邻近残基突变为甘氨酸，旨在隔离捕获的原因。这种突变减少了空间位阻，并消除了酪氨酸侧链与其环境之间的特定非键相互作用（如氢键或静电接触）。$\\chi_1$ 的捕获现象在这种简化的环境中仍然存在，这个事实表明，捕获的原因并非特定蛋白质-蛋白质相互作用的人为效应。相反，原因必定是力场对酪氨酸残基本身的参数化所固有的。\n\n5.  **结论：** 证据明确指向 $\\chi_1$ 的扭转参数。该二面角的模拟势能剖面必定不正确，产生了一个深的、非天然的能量极小值，从而在动力学上捕获了侧链。问题不在于描述与环境相互作用的非键参数（已被对照实验排除），也不在于 $\\chi_2$ 的参数（其允许适当的采样动力学）。\n\n**选项评估**\n\n**A. $\\chi_1$ 的扭转参数不正确（势垒高度和/或相角过度稳定了 $\\chi_1\\approx+60^\\circ$ 的状态，并使其余势阱无法到达）。**\n这个选项是上述推理的直接结果。在一个长的模拟时间内，$\\chi_1$ 持续被捕获在非天然状态，且与局部蛋白质环境无关，这是内在扭转参数不正确的典型症状。错误的过大势垒高度 ($k_i$) 和/或不正确的相移 ($\\delta_i$) 会在 $\\approx +60^\\circ$ 处产生一个深的、非天然的极小值，并阻止对正确的天然状态 $\\approx 180^\\circ$ 的采样。\n**结论：正确。**\n\n**B. $\\chi_2$ 的扭转参数不正确（它们破坏了天然 $\\chi_2$ 取向的稳定性，并间接捕获了 $\\chi_1$）。**\n这不受数据支持。模拟显示系统频繁采样天然的 $\\chi_2 \\approx +90^\\circ$ 状态。没有出现严重到无法接近该状态的稳定性破坏。此外，“间接”捕获 $\\chi_1$ 的说法机制上不清楚，也不如一个直接原因来得简洁。$\\chi_2$ 的行为是一个柔性键的行为，而不是一个导致捕获的错误参数化的键。\n**结论：不正确。**\n\n**C. $\\chi_1$ 和 $\\chi_2$ 的扭转参数都以相互补偿的方式不正确。**\n虽然力场误差可能很复杂，但证据呈现了一幅清晰而简单的图景：$\\chi_1$ 被捕获，而 $\\chi_2$ 没有。假设一个复杂的补偿性误差方案并非最可能的解释。主要问题在于直接导致观察到的捕获现象的参数，即 $\\chi_1$ 扭转。这个选项在没有支持证据的情况下不必要地使诊断复杂化。\n**结论：不正确。**\n\n**D. 扭转参数没有问题；问题在于芳香环碳原子的非键参数，而不在于扭转项。**\n这一假设与对照模拟直接矛盾。通过将邻居突变为甘氨酸来改变非键环境，对 $\\chi_1$ 的捕获没有影响。这强烈表明问题不在于分子间的非键相互作用。虽然分子内非键项（例如，1-4相互作用）对旋转势垒有贡献，但它们的影响通常被吸收到显式扭转参数的拟合中。因此，一个不正确的旋转剖面，根据定义，是有效扭转项中的一个错误，使得该项的参数成为主要嫌疑。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2466279"}]}