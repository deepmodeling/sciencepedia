{"hands_on_practices": [{"introduction": "我们从一个基本但极具启发性的例子开始。本练习将引导你分析双原子系统的 Lennard-Jones 势能，并通过解析方法找到其能量最低点。通过这个过程，你将亲身体会到，一个分子的平衡几何构型是其势能面的内在属性，与优化算法的初始构型无关——即使是从一个奇异点（原子重叠）出发，优化过程也总会收敛到同一个能量最低点 [@problem_id:2455319]。", "problem": "考虑一个三维空间中的双原子体系，其相互作用由约化单位下的 Lennard–Jones $12\\text{–}6$ 势来模拟。势能仅取决于标量原子间距 $r$，其定义为 $r=\\lVert \\mathbf{r}_2-\\mathbf{r}_1\\rVert$，并由下式给出：\n\n$$\nE(r)=4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right],\n$$\n\n其中 $\\varepsilon=1$ 且 $\\sigma=1$。距离必须以 $\\sigma$ 为单位表示，能量以 $\\varepsilon$ 为单位表示。本问题中不使用角度。\n\n对于以下每种初始构型（由以 $\\sigma$ 为单位的原子位置 $\\mathbf{r}_1$ 和 $\\mathbf{r}_2$ 组成），请确定使 $E(r)$ 最小化的构型，并报告优化后的原子间距 $r^\\star$（以 $\\sigma$ 为单位）。将每个报告的 $r^\\star$ 值四舍五入到小数点后六位。\n\n测试集（每行列出 $\\mathbf{r}_1$ 和 $\\mathbf{r}_2$）：\n\n- A 例（完全重叠）：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(0,0,0)$。\n- B 例（近乎重叠）：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(10^{-12},0,0)$。\n- C 例（远于平衡位置）：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(3,0,0)$。\n- D 例（处于 Lennard-Jones 势阱最低点）：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(2^{1/6},0,0)$。\n\n你的程序必须计算每种情况下的 $r^\\star$。最终输出格式必须是单个文本行，其中包含四个四舍五入后的值，以逗号分隔，并用方括号括起来，例如 $[r_A^\\star,r_B^\\star,r_C^\\star,r_D^\\star]$，其中每个 $r^\\star$ 是一个以 $\\sigma$ 为单位、四舍五入到六位小数的十进制数。", "solution": "该问题要求确定使双原子体系势能最小化的原子间距 $r^\\star$。其相互作用由 Lennard-Jones $12\\text{–}6$ 势描述，采用约化单位，其中势阱深度 $\\varepsilon=1$，粒子间势能为零时的有限距离 $\\sigma$ 也为 $1$。\n\n势能 $E$ 是标量原子间距 $r = \\lVert \\mathbf{r}_2 - \\mathbf{r}_1 \\rVert$ 的函数。其函数形式为：\n$$\nE(r) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]\n$$\n在指定的约化单位 $\\varepsilon=1$ 和 $\\sigma=1$ 下，该表达式简化为：\n$$\nE(r) = 4\\left[\\left(\\frac{1}{r}\\right)^{12} - \\left(\\frac{1}{r}\\right)^{6}\\right] = 4\\left(r^{-12} - r^{-6}\\right)\n$$\n为了找到能量最低的构型，我们必须找到使势能 $E(r)$ 达到最小值的 $r$ 值。这是微积分中的一个标准流程，即通过将函数对其自变量 $r$ 的一阶导数设为零来求临界点。\n$E(r)$ 的一阶导数为：\n$$\n\\frac{dE}{dr} = \\frac{d}{dr} \\left[ 4\\left(r^{-12} - r^{-6}\\right) \\right]\n$$\n应用幂函数求导法则：\n$$\n\\frac{dE}{dr} = 4 \\left( -12r^{-13} - (-6)r^{-7} \\right) = 4 \\left( -12r^{-13} + 6r^{-7} \\right)\n$$\n为求最小值，我们将此导数设为零，其中 $r>0$：\n$$\n4 \\left( -12r^{-13} + 6r^{-7} \\right) = 0\n$$\n由于 $4 \\neq 0$，必然有：\n$$\n-12r^{-13} + 6r^{-7} = 0\n$$\n$$\n6r^{-7} = 12r^{-13}\n$$\n方程两边同除以 $6$ 再同乘以 $r^{13}$（这是允许的，因为能量在 $r=0$ 时为无穷大，最小值不可能出现在该点），得到：\n$$\nr^6 = 2\n$$\n解出 $r$ 即可得到平衡距离 $r^\\star$：\n$$\nr^\\star = 2^{1/6}\n$$\n为确认这是一个极小值，必须检查二阶导数 $\\frac{d^2E}{dr^2}$。\n$$\n\\frac{d^2E}{dr^2} = 4 \\frac{d}{dr} \\left( -12r^{-13} + 6r^{-7} \\right) = 4 \\left( (-12)(-13)r^{-14} + (6)(-7)r^{-8} \\right) = 4 \\left( 156r^{-14} - 42r^{-8} \\right)\n$$\n代入 $r = r^\\star = 2^{1/6}$，我们有 $r^6 = 2$，因此 $r^8 = r^6 r^2 = 2 \\cdot (2^{1/6})^2 = 2 \\cdot 2^{1/3}$ 且 $r^{14} = r^{12} r^2 = (r^6)^2 r^2 = 4 \\cdot 2^{1/3}$。\n$$\n\\frac{d^2E}{dr^2}\\bigg|_{r=r^\\star} = 4 \\left( \\frac{156}{4 \\cdot 2^{1/3}} - \\frac{42}{2 \\cdot 2^{1/3}} \\right) = 4 \\left( \\frac{39}{2^{1/3}} - \\frac{21}{2^{1/3}} \\right) = \\frac{4 \\cdot 18}{2^{1/3}} = \\frac{72}{2^{1/3}}\n$$\n由于 $72 > 0$ 且 $2^{1/3} > 0$，二阶导数为正。这证实了 $r^\\star = 2^{1/6}$ 对应一个局部极小值。由于这是 $r>0$ 范围内的唯一临界点，因此它也是全局最小值。\n\n$r^\\star = 2^{1/6}\\sigma$ 这个值是 Lennard-Jones 势的一个内禀性质。它代表了排斥力与吸引力达到完美平衡的那个唯一的距离。这个平衡距离不依赖于原子的初始位置。任何构型优化算法，当应用于受此势能控制的体系时，都会试图收敛到原子间距为 $r^\\star = 2^{1/6}$ 的状态。\n\n该问题提供了四种初始构型：\n- A 例：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(0,0,0)$。初始距离为 $r=0$。在该点，势能 $E(r)$ 未定义，表示一个奇点。在物理上，这对应于一个具有无穷大排斥能的状态。这不是一个稳定构型。问题要求的是使能量*最小化*的构型，该构型位于 $r^\\star$ 处，而非位于奇点。任何无穷小的位移都会导致体系向势阱最低点演化。因此，优化后的距离是 $r^\\star = 2^{1/6}$。\n- B 例：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(10^{-12},0,0)$。初始距离为 $r=10^{-12}$，位于势能的陡峭排斥壁上（$r \\ll r^\\star$）。体系将演化，使其间距增加到 $r^\\star = 2^{1/6}$。\n- C 例：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(3,0,0)$。初始距离为 $r=3$，位于势能的吸引区域（$r > r^\\star$）。体系将演化，使其间距减小到 $r^\\star = 2^{1/6}$。\n- D 例：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(2^{1/6},0,0)$。初始距离为 $r=2^{1/6}$，这正是平衡距离 $r^\\star$。体系已经处于其能量最低的构型，因此优化后的距离就是 $r^\\star = 2^{1/6}$。\n\n在所有四种情况下，使势能最小化的构型都具有相同的原子间距。因此，对于所有测试用例，最终的优化距离 $r^\\star$ 都是相同的。其数值为：\n$$\nr^\\star = 2^{1/6} \\approx 1.122462048309373\n$$\n四舍五入到小数点后六位，我们得到：\n$$\nr^\\star \\approx 1.122462\n$$\n对于这四种情况，都必须报告此值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the optimized interatomic distance for a diatomic system\n    modeled by the Lennard-Jones potential in reduced units.\n    \"\"\"\n\n    # The problem asks to find the geometry that minimizes the Lennard-Jones potential\n    # E(r) = 4 * epsilon * [(sigma/r)^12 - (sigma/r)^6].\n    # In reduced units, epsilon = 1 and sigma = 1.\n    # The minimum of this potential occurs at a specific distance r_star\n    # which can be found by setting the derivative dE/dr to zero.\n    # dE/dr = 4 * [-12/r^13 + 6/r^7] = 0\n    # => 6/r^7 = 12/r^13\n    # => r^6 = 12/6 = 2\n    # => r_star = 2^(1/6)\n    #\n    # This equilibrium distance r_star is an intrinsic property of the potential\n    # and is independent of the initial atomic positions. Therefore, the result\n    # will be the same for all test cases presented in the problem.\n\n    # Test cases are provided but not needed for the analytical solution.\n    # They are included here for completeness, as per the template.\n    test_cases = [\n        # Case A: r1=(0,0,0), r2=(0,0,0) -> initial r=0\n        {'r1': np.array([0.0, 0.0, 0.0]), 'r2': np.array([0.0, 0.0, 0.0])},\n        # Case B: r1=(0,0,0), r2=(1e-12,0,0) -> initial r=1e-12\n        {'r1': np.array([0.0, 0.0, 0.0]), 'r2': np.array([1e-12, 0.0, 0.0])},\n        # Case C: r1=(0,0,0), r2=(3,0,0) -> initial r=3\n        {'r1': np.array([0.0, 0.0, 0.0]), 'r2': np.array([3.0, 0.0, 0.0])},\n        # Case D: r1=(0,0,0), r2=(2**(1/6),0,0) -> initial r=2**(1/6)\n        {'r1': np.array([0.0, 0.0, 0.0]), 'r2': np.array([2**(1/6), 0.0, 0.0])},\n    ]\n\n    # Calculate the optimized distance analytically.\n    # This is r_star = (2)^(1/6) in units of sigma.\n    r_star = 2**(1/6)\n\n    results = []\n    # The result is the same for all cases.\n    for _ in test_cases:\n        # The optimized distance is independent of the starting geometry.\n        # The value is rounded to six decimal places as required.\n        rounded_r_star = round(r_star, 6)\n        results.append(str(rounded_r_star))\n\n    # The final output format must be a single line containing a\n    # comma-separated list of the four rounded values enclosed in square brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2455319"}, {"introduction": "接下来，我们将优化方法应用于一个真实的化学问题：Jahn-Teller 效应。这个练习建立了一个简化的模型来描述八面体铜（II）配合物 $[\\mathrm{Cu}(\\mathrm{H}_2\\mathrm{O})_6]^{2+}$ 中发生的四方畸变，这是一种重要的结构现象。通过最小化一个包含两个变量（轴向键长 $r_a$ 和赤道向键长 $r_e$）的能量函数，你将能够定量地预测这种畸变的程度，从而将抽象的优化概念与可观测的化学性质联系起来 [@problem_id:2455327]。", "problem": "考虑六水合铜(II)络合物 $[\\mathrm{Cu}(\\mathrm{H}_2\\mathrm{O})_6]^{2+}$，在理想的八面体环境中，该络合物具有 $6$ 个等价的金属-配体距离。由于 Jahn–Teller (JT) 效应，该络合物发生四方畸变，使得两个轴向键与四个赤道键产生差异。将总势能建模为谐振子键伸缩项与一个稳定四方畸变的线性振动耦合项之和。设两个轴向 $\\mathrm{Cu}-\\mathrm{O}$ 键的共同长度为 $r_a$，四个赤道 $\\mathrm{Cu}-\\mathrm{O}$ 键的共同长度为 $r_e$。设 $r_0$ 表示未畸变时的参考键长。设 $k_a$ 和 $k_e$ 分别表示轴向和赤道的谐振力常数。设 $g \\ge 0$ 表示与四方模式的线性 Jahn–Teller 耦合强度。总能量作为 $r_a$ 和 $r_e$ 的函数为\n$$\nE(r_a,r_e) \\;=\\; 2 \\cdot \\frac{1}{2} k_a \\left(r_a - r_0\\right)^2 \\;+\\; 4 \\cdot \\frac{1}{2} k_e \\left(r_e - r_0\\right)^2 \\;-\\; g \\,\\big(r_a - r_e\\big).\n$$\n所有距离 $r_a$、$r_e$ 和 $r_0$ 必须以埃（ångström，写作 $\\text{\\AA}$）为单位表示，所有能量必须以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位表示。参数 $k_a$ 和 $k_e$ 的单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-2}$，$g$ 的单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-1}$。该模型中不涉及角度。定义四方畸变振幅为 $Q = r_a - r_e$。\n\n任务：对于下面测试套件中的每一组参数，确定唯一的对 $\\big(r_a^\\star, r_e^\\star\\big)$ 以最小化 $E(r_a,r_e)$，然后计算 $Q^\\star = r_a^\\star - r_e^\\star$ 和 $E^\\star = E(r_a^\\star, r_e^\\star)$。将 $r_a^\\star$、$r_e^\\star$ 和 $Q^\\star$ 以埃为单位表示，$E^\\star$ 以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位表示。将报告的每个实数四舍五入到 $6$ 位小数。\n\n测试套件（每个元组为 $\\big(r_0, k_a, k_e, g\\big)$，单位为（$\\text{\\AA}$, $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-2}$, $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-2}$, $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-1}$））：\n- 情况 1：$\\big(2.00, 200, 250, 50\\big)$\n- 情况 2：$\\big(2.05, 300, 300, 0\\big)$\n- 情况 3：$\\big(1.98, 150, 1000, 60\\big)$\n- 情况 4：$\\big(2.00, 200, 200, 400\\big)$\n\n最终输出格式：您的程序应生成单行输出，其中包含一个结果列表，每个测试用例一个结果，每个结果是一个列表 $\\big[r_a^\\star, r_e^\\star, Q^\\star, E^\\star\\big]$。整体输出必须是单个由逗号分隔的列表，这些列表包含在方括号中，例如 $[\\,[r_{a,1}^\\star,r_{e,1}^\\star,Q_1^\\star,E_1^\\star],\\,[r_{a,2}^\\star,r_{e,2}^\\star,Q_2^\\star,E_2^\\star],\\,\\dots\\,]$，每个实数都四舍五入到 $6$ 位小数，并且没有附加文本。", "solution": "问题陈述已经过严格验证，并被确定为有效。它在科学上基于配位化学的原理，特别是 Jahn-Teller 效应，并使用标准的谐振和线性耦合近似进行建模。该问题在数学上是适定的，提供了一个双变量的凸二次能量函数，这保证了唯一的全局最小值的存在。所有参数和常数都用一致的物理单位明确定义，目标明确。因此，我们可以着手推导解决方案。\n\n任务是找到使六水合铜(II)络合物的总势能函数 $E(r_a, r_e)$ 最小化的平衡几何构型 $(r_a^\\star, r_e^\\star)$。能量函数如下：\n$$\nE(r_a,r_e) \\;=\\; k_a \\left(r_a - r_0\\right)^2 \\;+\\; 2 k_e \\left(r_e - r_0\\right)^2 \\;-\\; g \\,\\big(r_a - r_e\\big)\n$$\n其中 $r_a$ 是轴向键长，$r_e$ 是赤道键长，$r_0$ 是参考键长，$k_a$ 和 $k_e$ 是谐振力常数，$g$ 是振动耦合常数。\n\n为了找到这个可微分函数的最小值，我们必须找到临界点，在该点 $E$ 相对于坐标 $(r_a, r_e)$ 的梯度为零向量。这要求将 $E(r_a, r_e)$ 对 $r_a$ 和 $r_e$ 的偏导数设为零。\n\n首先，我们计算关于 $r_a$ 的偏导数：\n$$\n\\frac{\\partial E}{\\partial r_a} \\;=\\; \\frac{\\partial}{\\partial r_a} \\left[ k_a \\left(r_a - r_0\\right)^2 \\;+\\; 2 k_e \\left(r_e - r_0\\right)^2 \\;-\\; g \\,\\big(r_a - r_e\\big) \\right]\n$$\n$$\n\\frac{\\partial E}{\\partial r_a} \\;=\\; 2 k_a (r_a - r_0) \\;-\\; g\n$$\n接下来，我们计算关于 $r_e$ 的偏导数：\n$$\n\\frac{\\partial E}{\\partial r_e} \\;=\\; \\frac{\\partial}{\\partial r_e} \\left[ k_a \\left(r_a - r_0\\right)^2 \\;+\\; 2 k_e \\left(r_e - r_0\\right)^2 \\;-\\; g \\,\\big(r_a - r_e\\big) \\right]\n$$\n$$\n\\frac{\\partial E}{\\partial r_e} \\;=\\; 4 k_e (r_e - r_0) \\;+\\; g\n$$\n在最小值点 $(r_a^\\star, r_e^\\star)$，这些偏导数必须等于零，这给了我们一个包含两个未知数 $r_a^\\star$ 和 $r_e^\\star$ 的二元线性方程组：\n$$\n\\begin{cases}\n2 k_a (r_a^\\star - r_0) - g = 0 \\\\\n4 k_e (r_e^\\star - r_0) + g = 0\n\\end{cases}\n$$\n求解第一个关于 $r_a^\\star$ 的方程：\n$$\n2 k_a (r_a^\\star - r_0) = g \\;\\implies\\; r_a^\\star - r_0 = \\frac{g}{2 k_a} \\;\\implies\\; r_a^\\star = r_0 + \\frac{g}{2 k_a}\n$$\n求解第二个关于 $r_e^\\star$ 的方程：\n$$\n4 k_e (r_e^\\star - r_0) = -g \\;\\implies\\; r_e^\\star - r_0 = -\\frac{g}{4 k_e} \\;\\implies\\; r_e^\\star = r_0 - \\frac{g}{4 k_e}\n$$\n这些表达式提供了作为输入参数函数的最优键长 $r_a^\\star$ 和 $r_e^\\star$。最小值的存在由二阶导数的 Hessian 矩阵证实，对于正的力常数 $k_a > 0$ 和 $k_e > 0$，该矩阵是正定的。\n\n在确定了最优键长后，我们可以计算所需的量：\n1.  最优四方畸变振幅，$Q^\\star$：\n    $$\n    Q^\\star = r_a^\\star - r_e^\\star = \\left( r_0 + \\frac{g}{2 k_a} \\right) - \\left( r_0 - \\frac{g}{4 k_e} \\right) = g \\left( \\frac{1}{2 k_a} + \\frac{1}{4 k_e} \\right)\n    $$\n2.  最小能量，$E^\\star = E(r_a^\\star, r_e^\\star)$。我们将 $(r_a^\\star - r_0)$ 和 $(r_e^\\star - r_0)$ 的表达式代回原始能量函数中：\n    $$\n    E^\\star = k_a \\left(\\frac{g}{2 k_a}\\right)^2 + 2 k_e \\left(-\\frac{g}{4 k_e}\\right)^2 - g (r_a^\\star - r_e^\\star)\n    $$\n    代入 $Q^\\star = r_a^\\star - r_e^\\star$ 的表达式：\n    $$\n    E^\\star = k_a \\frac{g^2}{4 k_a^2} + 2 k_e \\frac{g^2}{16 k_e^2} - g \\left[ g \\left( \\frac{1}{2 k_a} + \\frac{1}{4 k_e} \\right) \\right]\n    $$\n    $$\n    E^\\star = \\frac{g^2}{4 k_a} + \\frac{g^2}{8 k_e} - \\frac{g^2}{2 k_a} - \\frac{g^2}{4 k_e}\n    $$\n    $$\n    E^\\star = g^2 \\left( \\frac{1}{4 k_a} - \\frac{2}{4 k_a} \\right) + g^2 \\left( \\frac{1}{8 k_e} - \\frac{2}{8 k_e} \\right)\n    $$\n    $$\n    E^\\star = -g^2 \\left( \\frac{1}{4 k_a} + \\frac{1}{8 k_e} \\right)\n    $$\n这个 $E^\\star$ 的最终表达式代表 Jahn-Teller 稳定化能。计算实现将使用这些推导出的公式来计算每个测试用例所需的值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the optimized geometry and energy for the Jahn-Teller distorted\n    [Cu(H2O)6]2+ complex based on a simplified potential energy model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (r0, ka, ke, g)\n    test_cases = [\n        (2.00, 200, 250, 50),\n        (2.05, 300, 300, 0),\n        (1.98, 150, 1000, 60),\n        (2.00, 200, 200, 400),\n    ]\n\n    all_results_as_strings = []\n    \n    for case in test_cases:\n        r0, ka, ke, g = case\n        \n        # Ensure force constants are not zero to avoid division by zero error,\n        # which is physically required anyway.\n        if ka == 0 or ke == 0:\n            # This case would be physically invalid.\n            # For this problem's scope, we assume ka > 0 and ke > 0.\n            continue\n\n        # Calculate optimal axial bond length r_a*\n        # r_a_star = r0 + g / (2 * k_a)\n        ra_star = r0 + g / (2.0 * ka)\n        \n        # Calculate optimal equatorial bond length r_e*\n        # r_e_star = r0 - g / (4 * k_e)\n        re_star = r0 - g / (4.0 * ke)\n        \n        # Calculate optimal tetragonal distortion amplitude Q*\n        # Q* = r_a* - r_e*\n        q_star = ra_star - re_star\n        \n        # Calculate the minimum energy E*\n        # E* = -g^2 * (1/(4*k_a) + 1/(8*k_e))\n        e_star = -(g**2) * (1.0 / (4.0 * ka) + 1.0 / (8.0 * ke))\n        \n        # Format the results for the current case as a string\n        # Each number is rounded to 6 decimal places.\n        # e.g., '[2.125000,1.950000,0.175000,-4.375000]'\n        case_string = (\n            f\"[{ra_star:.6f},{re_star:.6f},{q_star:.6f},{e_star:.6f}]\"\n        )\n        all_results_as_strings.append(case_string)\n\n    # Final print statement in the exact required format.\n    # e.g., '[[...],[...],...]'\n    final_output = f\"[{','.join(all_results_as_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2455327"}, {"introduction": "在许多计算化学模拟中，我们需要在特定约束条件下进行几何优化。本练习将带你探讨一个带约束的优化问题，即在一个简化的水分子模型中寻找能量最低点。更重要的是，这个实践将帮助你理解一个核心概念：在任何平衡构型下（无论是受约束还是不受约束的），作用在每个原子上的净力（即势能的梯度）都为零 [@problem_id:2455389]。", "problem": "给定一个由一个氧原子 (O) 和两个氢原子 (H) 组成的平面三原子水分子模型。该分子在三维笛卡尔空间中建模，其坐标受到约束，使得 H–O–H 键角精确为 $180^\\circ$（共线构型）。在此完整约束下，将氧原子固定在原点，并将两个氢原子分别放置在 $x$ 轴上的位置 $\\mathbf{r}_{\\mathrm{H}_1} = (r_1, 0, 0)$ 和 $\\mathbf{r}_{\\mathrm{H}_2} = (-r_2, 0, 0)$，其中 $r_1 > 0$ 且 $r_2 > 0$。因此，根据此构造，H–O–H 键角精确为 $180^\\circ$。\n\n分子内势能定义为两个谐振 O–H 键伸缩项与一个可选的、纯排斥性的、与距离的十二次方成反比的氢-氢相互作用之和。作为 $(r_1, r_2)$ 函数的总能量为\n$$\nE(r_1, r_2) \\;=\\; \\tfrac{1}{2} k_r \\left[(r_1 - r_{\\mathrm{eq}})^2 + (r_2 - r_{\\mathrm{eq}})^2\\right] \\;+\\; \\frac{A}{(d_{\\mathrm{HH}})^{12}},\n$$\n其中 $k_r$ 是 O–H 键力常数，单位为千焦耳每摩尔每平方埃；$r_{\\mathrm{eq}}$ 是 O–H 平衡键长，单位为埃；$A$ 是排斥参数，单位为千焦耳乘以埃的十二次方每摩尔；$d_{\\mathrm{HH}} = r_1 + r_2$ 是 H–H 间距，单位为埃。\n\n任务：\n- 对于下面测试套件中的每一组参数，确定能使 $E(r_1, r_2)$ 最小化的约束后几何构型，要求 $r_1 > 0$ 和 $r_2 > 0$ 并保持 H–O–H 键角精确为 $180^\\circ$（即，如上文定义的位置）。\n- 在优化后的几何构型下，计算每个原子上所受的剩余笛卡尔力，其值为总能量相对于相应笛卡尔坐标的负梯度。由于共线约束，垂直于 $x$ 轴的力分量根据构造必须为零；报告 O、H$_1$ 和 H$_2$ 上剩余力的大小（均为非负标量）。力的大小以千焦耳每摩尔每埃为单位。\n- 报告优化后的键长 $r_1^\\star$ 和 $r_2^\\star$，单位为埃。\n\n物理单位：\n- 所有距离使用埃。\n- 能量使用千焦耳每摩尔。\n- 力的大小使用千焦耳每摩尔每埃。\n- 角度约束以度为单位指定为 $180^\\circ$。\n\n测试套件（三种情况）：\n- 情况 1：$k_r = 1882.8$, $r_{\\mathrm{eq}} = 0.9572$, $A = 0$。\n- 情况 2：$k_r = 1882.8$, $r_{\\mathrm{eq}} = 0.9572$, $A = 100000$。\n- 情况 3：$k_r = 18828.0$, $r_{\\mathrm{eq}} = 0.9572$, $A = 100000$。\n\n答案规格：\n- 对于每种情况，按以下顺序输出一个包含五个浮点数的列表：$[r_1^\\star, r_2^\\star, \\|\\mathbf{F}_{\\mathrm{O}}\\|, \\|\\mathbf{F}_{\\mathrm{H}_1}\\|, \\|\\mathbf{F}_{\\mathrm{H}_2}\\|]$，其中 $\\|\\cdot\\|$ 表示该原子上所受力的欧几里得大小。\n- 将所有情况的结果汇总到单行中，该行包含一个由上述各情况列表组成的列表，其顺序与测试套件中的顺序相同。您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，\"[[a,b,c,d,e],[...],[...]]\"）。每个浮点数应四舍五入到六位小数。", "solution": "所提出的问题是计算化学中的一个标准练习，涉及对一个受约束分子系统的势能函数进行最小化。该问题在科学上是合理的，提法得当，并且包含了解决它所需的所有信息。我将开始进行解答。\n\n目标是找到由 O-H 键长 $r_1 > 0$ 和 $r_2 > 0$ 定义的几何构型，该构型能使势能函数 $E(r_1, r_2)$ 最小化。能量函数给出如下：\n$$\nE(r_1, r_2) = \\frac{1}{2} k_r \\left[(r_1 - r_{\\mathrm{eq}})^2 + (r_2 - r_{\\mathrm{eq}})^2\\right] + \\frac{A}{(r_1 + r_2)^{12}}\n$$\n可微函数的最小值出现在梯度为零的临界点。因此，我们必须求解一个方程组，其中 $E$ 对 $r_1$ 和 $r_2$ 的偏导数均为零。\n\n首先，我们计算偏导数：\n$$\n\\frac{\\partial E}{\\partial r_1} = k_r (r_1 - r_{\\mathrm{eq}}) - \\frac{12A}{(r_1 + r_2)^{13}}\n$$\n$$\n\\frac{\\partial E}{\\partial r_2} = k_r (r_2 - r_{\\mathrm{eq}}) - \\frac{12A}{(r_1 + r_2)^{13}}\n$$\n\n将这些导数设为零，得到能量最小的条件：\n$$\nk_r (r_1 - r_{\\mathrm{eq}}) = \\frac{12A}{(r_1 + r_2)^{13}} \\quad (1)\n$$\n$$\nk_r (r_2 - r_{\\mathrm{eq}}) = \\frac{12A}{(r_1 + r_2)^{13}} \\quad (2)\n$$\n\n通过令表达式 $(1)$ 和 $(2)$ 相等，我们发现：\n$$\nk_r (r_1 - r_{\\mathrm{eq}}) = k_r (r_2 - r_{\\mathrm{eq}})\n$$\n由于力常数 $k_r$ 非零，这意味着 $r_1 - r_{\\mathrm{eq}} = r_2 - r_{\\mathrm{eq}}$，可简化为 $r_1 = r_2$。势能函数的对称性决定了最小能量构型必然是对称的，具有相等的 O-H 键长。\n\n令 $r_1^\\star = r_2^\\star = r^\\star$。这两个方程组成的方程组可简化为关于最佳键长 $r^\\star$ 的单个非线性方程：\n$$\nk_r (r^\\star - r_{\\mathrm{eq}}) = \\frac{12A}{(2r^\\star)^{13}}\n$$\n\n我们现在针对每种给定的情况求解此方程。\n\n**情况 1：** $k_r = 1882.8$, $r_{\\mathrm{eq}} = 0.9572$, $A = 0$。\n当 $A=0$ 时，方程简化为：\n$$\nk_r (r^\\star - r_{\\mathrm{eq}}) = 0\n$$\n由于 $k_r \\neq 0$，解为 $r^\\star = r_{\\mathrm{eq}}$。\n因此，$r_1^\\star = r_2^\\star = 0.9572$ Å。\n\n**情况 2 和 3：** $A > 0$。\n该方程是非线性的，需要数值求解。我们定义一个函数 $f(r)$，使其根为所求的解 $r^\\star$：\n$$\nf(r) = k_r (r - r_{\\mathrm{eq}}) - \\frac{12A}{(2r)^{13}} = 0\n$$\n找到根的一种有效方法是牛顿-拉弗森算法，它使用以下迭代更新规则：\n$$\nr_{n+1} = r_n - \\frac{f(r_n)}{f'(r_n)}\n$$\n导数 $f'(r)$ 是：\n$$\nf'(r) = \\frac{d}{dr} \\left( k_r (r - r_{\\mathrm{eq}}) - 12A (2r)^{-13} \\right) = k_r - 12A \\cdot (-13)(2r)^{-14} \\cdot 2 = k_r + \\frac{312A}{(2r)^{14}}\n$$\n从初始猜测 $r_0 = r_{\\mathrm{eq}}$ 开始，我们进行迭代，直到达到足够的精度并收敛。这个过程在提供的代码中实现，用于求解情况 2 和情况 3 的 $r^\\star$。\n\n接下来，我们必须计算每个原子上的剩余笛卡尔力。原子 $i$ 上所受的力 $\\mathbf{F}_i$ 是势能 $E$ 相对于其笛卡尔坐标 $\\mathbf{r}_i$ 的负梯度：\n$$\n\\mathbf{F}_i = -\\nabla_{\\mathbf{r}_i} E\n$$\n坐标定义为 $\\mathbf{r}_{\\mathrm{O}} = (0,0,0)$、$\\mathbf{r}_{\\mathrm{H}_1} = (r_1, 0, 0)$ 和 $\\mathbf{r}_{\\mathrm{H}_2} = (-r_2, 0, 0)$。能量 $E$ 是作为 $r_1$ 和 $r_2$ 的函数给出的。参数 $r_1$ 和 $r_2$ 是系统仅有的自由度。因此，我们通过链式法则将笛卡尔坐标导数与内坐标导数关联起来。\n对于氢原子 H$_1$，力为：\n$$\n\\mathbf{F}_{\\mathrm{H}_1} = -\\nabla_{\\mathbf{r}_{\\mathrm{H}_1}} E = -\\left( \\frac{\\partial E}{\\partial r_1} \\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{H}_1}} + \\frac{\\partial E}{\\partial r_2} \\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{H}_1}} \\right)\n$$\n在给定的坐标系中，$r_1 = x_1 = \\|\\mathbf{r}_{\\mathrm{H}_1}\\|$ 且 $r_2 = -x_2 = \\|\\mathbf{r}_{\\mathrm{H}_2}\\|$。因此，$r_1$ 仅依赖于 $\\mathbf{r}_{\\mathrm{H}_1}$ 而 $r_2$ 仅依赖于 $\\mathbf{r}_{\\mathrm{H}_2}$。这简化了表达式：\n$\\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{H}_1}} = \\mathbf{\\hat{x}}$ 且 $\\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{H}_1}} = \\mathbf{0}$。\n所以，$\\mathbf{F}_{\\mathrm{H}_1} = - \\frac{\\partial E}{\\partial r_1} \\mathbf{\\hat{x}}$。\n\n对于氢原子 H$_2$ 也是类似的：\n$\\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{H}_2}} = \\mathbf{0}$ 且 $\\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{H}_2}} = -\\mathbf{\\hat{x}}$。\n所以，$\\mathbf{F}_{\\mathrm{H}_2} = - \\frac{\\partial E}{\\partial r_2} (-\\mathbf{\\hat{x}}) = \\frac{\\partial E}{\\partial r_2} \\mathbf{\\hat{x}}$。\n\n对于氧原子，其位置被视为定义 $r_1$ 和 $r_2$ 的原点。作用在它上面的力源于它与两个氢原子的相互作用：\n$\\mathbf{F}_{\\mathrm{O}} = - \\frac{\\partial E}{\\partial r_1} \\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{O}}} - \\frac{\\partial E}{\\partial r_2} \\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{O}}}$。\n$\\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{O}}} = -\\mathbf{\\hat{x}}$ 且 $\\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{O}}} = \\mathbf{\\hat{x}}$。\n所以，$\\mathbf{F}_{\\mathrm{O}} = - \\frac{\\partial E}{\\partial r_1} (-\\mathbf{\\hat{x}}) - \\frac{\\partial E}{\\partial r_2} (\\mathbf{\\hat{x}}) = \\left(\\frac{\\partial E}{\\partial r_1} - \\frac{\\partial E}{\\partial r_2}\\right) \\mathbf{\\hat{x}}$。\n\n在优化后的几何构型 $(r_1^\\star, r_2^\\star)$ 处，根据定义我们有 $\\frac{\\partial E}{\\partial r_1} = 0$ 且 $\\frac{\\partial E}{\\partial r_2} = 0$。\n将这些条件代入力表达式中：\n$$\n\\mathbf{F}_{\\mathrm{H}_1} = - (0) \\mathbf{\\hat{x}} = \\mathbf{0}\n$$\n$$\n\\mathbf{F}_{\\mathrm{H}_2} = (0) \\mathbf{\\hat{x}} = \\mathbf{0}\n$$\n$$\n\\mathbf{F}_{\\mathrm{O}} = (0 - 0) \\mathbf{\\hat{x}} = \\mathbf{0}\n$$\n因此，每个原子上的剩余笛卡尔力恒为零。这是系统处于由给定自由度定义的势能面最小值的基本推论。因此，力的大小为 $\\|\\mathbf{F}_{\\mathrm{O}}\\| = 0$, $\\|\\mathbf{F}_{\\mathrm{H}_1}\\| = 0$ 和 $\\|\\mathbf{F}_{\\mathrm{H}_2}\\| = 0$。\n\n最终结果通过计算每种情况下的 $r^\\star$ 并报告包含五个值的相应列表来获得。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the optimized geometry and residual forces for a colinear triatomic\n    molecule based on a given potential energy function.\n    \"\"\"\n\n    def solve_case(k_r, r_eq, A):\n        \"\"\"\n        Calculates the optimized bond length r* for a given set of parameters.\n        The forces at the optimum are always zero by definition of the energy minimum.\n\n        Args:\n            k_r (float): Bond force constant.\n            r_eq (float): Equilibrium bond length.\n            A (float): Repulsive parameter.\n\n        Returns:\n            list: A list of floats [r1*, r2*, ||F_O||, ||F_H1||, ||F_H2||].\n        \"\"\"\n        if A == 0:\n            r_star = r_eq\n        else:\n            # Solve the nonlinear equation for r using Newton-Raphson method\n            # f(r) = k_r * (r - r_eq) - 12 * A / (2*r)**13 = 0\n            # f'(r) = k_r + 312 * A / (2*r)**14\n            \n            r = r_eq  # Initial guess\n            \n            # Using a very small tolerance for high precision convergence.\n            tolerance = 1e-15\n            max_iterations = 100\n            \n            for _ in range(max_iterations):\n                # Calculate function value f(r) and its derivative f'(r)\n                try:\n                    r_pow13 = (2 * r)**13\n                    r_pow14 = r_pow13 * (2 * r)\n                    \n                    f_r = k_r * (r - r_eq) - 12 * A / r_pow13\n                    fp_r = k_r + 312 * A / r_pow14\n                    \n                    # Newton-Raphson update\n                    delta_r = f_r / fp_r\n                    r -= delta_r\n                    \n                    if abs(delta_r) < tolerance:\n                        break\n                except (OverflowError, ZeroDivisionError):\n                    # Handle potential numerical instability, although not expected here\n                    # with good initial guess.\n                    # Fallback to a bisection method or report error if necessary.\n                    # For this problem, Newton's method is stable.\n                    return [np.nan] * 5\n\n            r_star = r\n\n        # At the energy minimum, r1* = r2* = r_star.\n        # The forces are the negative gradient of the potential energy. Since the\n        # geometry is optimized, the gradient components along the degrees of\n        # freedom (r1, r2) are zero, which leads to zero Cartesian forces.\n        r1_star = r_star\n        r2_star = r_star\n        force_o_mag = 0.0\n        force_h1_mag = 0.0\n        force_h2_mag = 0.0\n        \n        return [r1_star, r2_star, force_o_mag, force_h1_mag, force_h2_mag]\n\n    # Test suite from the problem statement\n    test_cases = [\n        {'k_r': 1882.8, 'r_eq': 0.9572, 'A': 0},           # Case 1\n        {'k_r': 1882.8, 'r_eq': 0.9572, 'A': 100000},      # Case 2\n        {'k_r': 18828.0, 'r_eq': 0.9572, 'A': 100000},     # Case 3\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = solve_case(case['k_r'], case['r_eq'], case['A'])\n        all_results.append(result)\n\n    # Format the output string as a list of lists of floats,\n    # with each float formatted to six decimal places.\n    output_str = \"[\" + \",\".join([\n        f\"[{','.join(f'{val:.6f}' for val in res)}]\" for res in all_results\n    ]) + \"]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "2455389"}]}