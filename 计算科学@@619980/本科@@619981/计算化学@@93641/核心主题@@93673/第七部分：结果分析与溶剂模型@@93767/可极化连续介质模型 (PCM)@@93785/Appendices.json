{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式莫过于亲手实践。我们首先从一个基本问题入手：溶剂如何影响分子的构象稳定性？通过从经典静电学原理出发，推导并实现针对刚性偶极子的Onsager反应场模型，你将能够亲手计算环己烷在不同溶剂中的构象异构体能量差异。这个练习旨在将抽象的理论与具体的化学问题——构象分析——联系起来，让你直观地看到溶剂的介电常数$ \\varepsilon $是如何调节分子稳定性的。[@problem_id:2465434]", "problem": "你的任务是使用可极化连续介质模型 (PCM)，针对球形空腔和溶质的点电荷表示法，实现环己烷两种构象之间溶剂化自由能差的、基于第一性原理的计算。你的任务仅关注计算溶剂化贡献，而不涉及固有的气相构象能。所考虑的两种构象是环己烷在四氯化碳 (CCl4) 中的椅式和船式构象。你必须从连续介质静电学出发，推导出控制表达式，并用程序实现。\n\n起始点和模型假设：\n- 从电介质中的静电学开始：电势在空腔外满足拉普拉斯方程，在空腔内满足泊松方程，边界条件要求电势和电位移场的法向分量在球形界面处连续。溶质被建模为一组固定的、以原子为中心的点电荷，这些电荷在一个半径为 $a$ 的球形空腔内产生一个分子偶极矩矢量 $\\boldsymbol{\\mu}$。该空腔嵌入在一个相对介电常数为 $\\varepsilon$ 的均匀、各向同性的电介质中。\n- 连续介质对溶质电多极矩的反应，在空腔中心产生一个电场（反应场），该电场与溶质的偶极矩耦合，从而产生溶剂化自由能。你必须从边值问题出发，推导出作用于球形空腔中心偶极子上的反应场，并用它来获得溶剂化自由能的表达式。不要假定任何预先给定的溶剂化公式；应从空腔边界上感应出的极化电荷的静电能出发进行推导。\n\n所需数据和定义：\n- 使用以下环己烷碳骨架的原子中心点电荷和笛卡尔坐标。这些有效部分电荷代表了整个局部电子环境（氢原子通过这些有效电荷被隐式地包含在内）。单位：坐标以埃（ångström）为单位，电荷以基本电荷为单位。对于每种构象，总电荷都恰好为零，这符合中性分子的要求。\n- 椅式构象（六个碳位点）：\n  1. $\\mathbf{r}_1 = (1.54,\\, 0.00,\\, 0.00)$, $q_1 = -0.03$\n  2. $\\mathbf{r}_2 = (0.77,\\, 1.33,\\, 0.50)$, $q_2 = +0.01$\n  3. $\\mathbf{r}_3 = (-0.77,\\, 1.33,\\, -0.50)$, $q_3 = -0.02$\n  4. $\\mathbf{r}_4 = (-1.54,\\, 0.00,\\, 0.00)$, $q_4 = +0.02$\n  5. $\\mathbf{r}_5 = (-0.77,\\, -1.33,\\, 0.50)$, $q_5 = +0.01$\n  6. $\\mathbf{r}_6 = (0.77,\\, -1.33,\\, -0.50)$, $q_6 = +0.01$\n- 船式构象（六个碳位点）：\n  1. $\\mathbf{r}_1 = (1.54,\\, 0.00,\\, 0.60)$, $q_1 = -0.025$\n  2. $\\mathbf{r}_2 = (0.77,\\, 1.33,\\, 0.00)$, $q_2 = +0.015$\n  3. $\\mathbf{r}_3 = (-0.77,\\, 1.33,\\, 0.60)$, $q_3 = -0.015$\n  4. $\\mathbf{r}_4 = (-1.54,\\, 0.00,\\, 0.00)$, $q_4 = +0.015$\n  5. $\\mathbf{r}_5 = (-0.77,\\, -1.33,\\, 0.60)$, $q_5 = -0.005$\n  6. $\\mathbf{r}_6 = (0.77,\\, -1.33,\\, 0.00)$, $q_6 = +0.015$\n\n需要实现的计算路径：\n1. 根据给定的电荷和坐标计算分子偶极矩矢量 $\\boldsymbol{\\mu} = \\sum_i q_i \\mathbf{r}_i$，并在适当时转换为国际单位制。使用 $1$ 基本电荷 $= 1.602176634\\times 10^{-19}$ 库仑和 $1$ 埃 $= 1.0\\times 10^{-10}$ 米。最终的 $\\boldsymbol{\\mu}$ 必须以库仑·米为单位。\n2. 利用电介质中球形空腔的静电学，获得并使用由中心偶极子产生的中心反应场，计算每种构象对应的溶剂化自由能贡献 $G_{\\text{solv}}$。最终能量以千焦/摩尔表示。使用真空介电常数 $\\varepsilon_0 = 8.8541878128\\times 10^{-12}$ 法拉/米、库仑常数 $k_e = \\left(4\\pi\\varepsilon_0\\right)^{-1}$ 和阿伏伽德罗常数 $N_A = 6.02214076\\times 10^{23}$ mol$^{-1}$。确保所有中间量均使用统一的国际单位制。\n3. 报告溶剂化自由能差 $\\Delta\\Delta G_{\\text{solv}} = G_{\\text{solv}}^{\\text{chair}} - G_{\\text{solv}}^{\\text{boat}}$。\n\n角度单位：不适用。物理单位：最终结果必须以千焦/摩尔报告。\n\n测试套件：\n你的程序必须对以下测试用例评估溶剂化自由能差。每个测试用例是一对 $\\left(\\varepsilon, a\\right)$，其中 $\\varepsilon$ 是相对介电常数， $a$ 是球形空腔半径，单位为埃。在每个测试用例中，两种构象使用相同的空腔半径。\n- 用例 A (边界检查：真空): $\\varepsilon = 1.0$, $a = 3.5$\n- 用例 B (目标溶剂：四氯化碳): $\\varepsilon = 2.238$, $a = 3.5$\n- 用例 C (强极性溶剂): $\\varepsilon = 78.3553$, $a = 3.5$\n- 用例 D (四氯化碳中的半径敏感性): $\\varepsilon = 2.238$, $a = 3.0$\n\n最终输出格式：\n你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按 [用例 A, 用例 B, 用例 C, 用例 D] 的顺序列出。每个条目必须是一个浮点数，等于以千焦/摩尔为单位的 $\\Delta\\Delta G_{\\text{solv}}$，并精确到小数点后六位。例如：\"[0.000000,-0.012345,-0.067890,-0.015432]\"。", "solution": "所述问题具有科学依据、是良构的，并包含了完整解答所需的所有信息。因此，该问题被认定为有效。该任务要求在 Onsager 反应场模型的框架下，针对球形空腔推导溶剂化自由能，然后对环己烷的两种构象进行数值计算。\n\n**1. 溶剂化自由能的理论推导**\n\n该模型考虑一个由中心点偶极子 $\\boldsymbol{\\mu}$ 代表的溶质，该偶极子位于半径为 $a$ 的球形空腔的原点。空腔内填充有相对介电常数为 $\\varepsilon_{in} = 1$ 的介质（真空），并嵌入在相对介电常数为 $\\varepsilon$ 的无限、各向同性的电介质连续体中。溶剂化自由能 $G_{\\text{solv}}$ 源于溶质偶极子与周围电介质极化所产生的电场之间的相互作用。这个场被称为反应场。\n\n我们必须求解静电边值问题以找到这个反应场。静电势 $\\phi$ 必须满足以下条件：\n- 在空腔内部 ($r < a$)：电势 $\\phi_{\\text{in}}$ 是中心偶极子产生的电势 $\\phi_{\\text{dipole}}$ 和空腔上感应表面电荷产生的电势 $\\phi_{\\text{reaction}}$ 的总和。它满足泊松方程，对于 $r > 0$，该方程简化为拉普拉斯方程。\n- 在空腔外部 ($r > a$)：电势 $\\phi_{\\text{out}}$ 满足拉普拉斯方程，$\\nabla^2 \\phi_{\\text{out}} = 0$。\n\n让我们将 z 轴与偶极矩矢量对齐，使得 $\\boldsymbol{\\mu} = \\mu \\hat{\\mathbf{z}}$。位于原点的点偶极子的电势由下式给出：\n$$ \\phi_{\\text{dipole}}(r, \\theta) = \\frac{\\boldsymbol{\\mu} \\cdot \\mathbf{r}}{4\\pi\\varepsilon_0 r^3} = \\frac{\\mu \\cos\\theta}{4\\pi\\varepsilon_0 r^2} $$\n其中 $\\varepsilon_0$ 是真空介电常数。该电势表现出偶极 ($l=1$) 角向依赖性。反应电势和外部电势必须共享这种对称性。对于 $l=1$ 项，在原点处正则（对于 $\\phi_{\\text{reaction}}$）并在无穷远处消失（对于 $\\phi_{\\text{out}}$）的拉普拉斯方程在球坐标下的通解为：\n- 内部反应电势 ($r < a$)：$\\phi_{\\text{reaction}}(r, \\theta) = A r \\cos\\theta$\n- 内部总电势 ($r < a$)：$\\phi_{\\text{in}}(r, \\theta) = \\frac{\\mu \\cos\\theta}{4\\pi\\varepsilon_0 r^2} + A r \\cos\\theta$\n- 外部电势 ($r > a$)：$\\phi_{\\text{out}}(r, \\theta) = B \\frac{\\cos\\theta}{r^2}$\n\n常数 $A$ 和 $B$ 由空腔表面 $r=a$ 处的边界条件确定：\n1.  电势的连续性：$\\phi_{\\text{in}}(a, \\theta) = \\phi_{\\text{out}}(a, \\theta)$。\n    $$ \\frac{\\mu \\cos\\theta}{4\\pi\\varepsilon_0 a^2} + A a \\cos\\theta = B \\frac{\\cos\\theta}{a^2} \\implies \\frac{\\mu}{4\\pi\\varepsilon_0 a^2} + A a = \\frac{B}{a^2} \\quad (1) $$\n2.  电位移场 $\\mathbf{D} = \\varepsilon_{medium} \\varepsilon_0 \\mathbf{E}$ 的法向分量的连续性。由于 $\\mathbf{E} = -\\nabla\\phi$ 且法向为径向 ($\\hat{\\mathbf{r}}$)，该条件为 $D_{r, \\text{in}}|_{r=a} = D_{r, \\text{out}}|_{r=a}$，可转写为：\n    $$ \\varepsilon_{in} \\varepsilon_0 \\left(-\\frac{\\partial\\phi_{\\text{in}}}{\\partial r}\\right)\\bigg|_{r=a} = \\varepsilon \\varepsilon_0 \\left(-\\frac{\\partial\\phi_{\\text{out}}}{\\partial r}\\right)\\bigg|_{r=a} $$\n    当 $\\varepsilon_{in} = 1$时：\n    $$ \\left(-\\frac{\\partial}{\\partial r}\\left[\\frac{\\mu \\cos\\theta}{4\\pi\\varepsilon_0 r^2} + A r \\cos\\theta\\right]\\right)\\bigg|_{r=a} = \\varepsilon \\left(-\\frac{\\partial}{\\partial r}\\left[B \\frac{\\cos\\theta}{r^2}\\right]\\right)\\bigg|_{r=a} $$\n    $$ -\\left(-\\frac{2\\mu \\cos\\theta}{4\\pi\\varepsilon_0 a^3} + A \\cos\\theta\\right) = -\\varepsilon\\left(-\\frac{2B \\cos\\theta}{a^3}\\right) $$\n    $$ \\frac{2\\mu}{4\\pi\\varepsilon_0 a^3} - A = \\frac{2\\varepsilon B}{a^3} \\quad (2) $$\n\n求解方程组 $(1)$ 和 $(2)$ 以得到 $A$：\n从 $(1)$ 式可得，$B = a^2 \\left(\\frac{\\mu}{4\\pi\\varepsilon_0 a^2} + A a\\right) = \\frac{\\mu}{4\\pi\\varepsilon_0} + A a^3$。\n将 $B$ 代入 $(2)$ 式：\n$$ \\frac{2\\mu}{4\\pi\\varepsilon_0 a^3} - A = \\frac{2\\varepsilon}{a^3} \\left(\\frac{\\mu}{4\\pi\\varepsilon_0} + A a^3\\right) $$\n$$ \\frac{2\\mu}{4\\pi\\varepsilon_0} - A a^3 = \\frac{2\\varepsilon \\mu}{4\\pi\\varepsilon_0} + 2\\varepsilon A a^3 $$\n$$ \\frac{2\\mu}{4\\pi\\varepsilon_0}(1 - \\varepsilon) = A a^3 (1 + 2\\varepsilon) $$\n$$ A = \\frac{2(1-\\varepsilon)}{1+2\\varepsilon} \\frac{\\mu}{4\\pi\\varepsilon_0 a^3} $$\n\n反应场 $\\mathbf{R}$ 是由感应极化在原点处产生的电场。它在整个空腔内是均匀的。\n$$ \\mathbf{R} = -\\nabla \\phi_{\\text{reaction}} \\big|_{r=0} $$\n对于 $\\phi_{\\text{reaction}} = A r \\cos\\theta = A z$（其中 $\\boldsymbol{\\mu}$ 沿 $\\hat{\\mathbf{z}}$ 轴），$\\mathbf{R} = -A\\hat{\\mathbf{z}}$。对于一个广义的偶极子 $\\boldsymbol{\\mu}$，$\\phi_{\\text{reaction}} = \\frac{A}{\\mu}(\\mathbf{r} \\cdot \\boldsymbol{\\mu})$，所以 $\\mathbf{R} = -\\frac{A}{\\mu}\\boldsymbol{\\mu}$。\n代入 $A$ 的表达式：\n$$ \\mathbf{R} = -\\frac{1}{\\mu} \\left(\\frac{2(1-\\varepsilon)}{1+2\\varepsilon} \\frac{\\mu}{4\\pi\\varepsilon_0 a^3}\\right) \\boldsymbol{\\mu} = \\frac{2(\\varepsilon-1)}{2\\varepsilon+1} \\frac{1}{4\\pi\\varepsilon_0 a^3} \\boldsymbol{\\mu} $$\n溶剂化自由能 $G_{\\text{solv}}$ 是极化电介质所做的功，其大小等于偶极子与其自身反应场之间相互作用能的一半：\n$$ G_{\\text{solv}} = -\\frac{1}{2} \\boldsymbol{\\mu} \\cdot \\mathbf{R} $$\n因子 $\\frac{1}{2}$ 的出现是因为极化是由偶极子自身引起的，它代表了储存在介质中的能量。\n代入 $\\mathbf{R}$ 的表达式：\n$$ G_{\\text{solv}} = -\\frac{1}{2} \\boldsymbol{\\mu} \\cdot \\left( \\frac{2(\\varepsilon-1)}{2\\varepsilon+1} \\frac{1}{4\\pi\\varepsilon_0 a^3} \\boldsymbol{\\mu} \\right) = -\\frac{1}{4\\pi\\varepsilon_0} \\frac{\\varepsilon-1}{2\\varepsilon+1} \\frac{\\mu^2}{a^3} $$\n这是单个分子溶剂化自由能的最终表达式，其中 $\\mu^2 = \\boldsymbol{\\mu} \\cdot \\boldsymbol{\\mu}$ 是偶极矩大小的平方。\n\n**2. 计算步骤**\n\n计算过程如下：\n1.  对于每种构象（椅式和船式），根据提供的原子部分电荷 $q_i$ 和笛卡尔坐标 $\\mathbf{r}_i$ 计算分子偶极矩矢量 $\\boldsymbol{\\mu} = \\sum_{i} q_i \\mathbf{r}_i$。电荷单位从基本电荷 ($e$) 转换为库仑，坐标单位从埃 ($\\text{Å}$) 转换为米。\n2.  对每种构象，计算偶极矩大小的平方 $\\mu^2$。\n3.  对于每个由相对介电常数 $\\varepsilon$ 和空腔半径 $a$ 对定义的测试用例，使用推导出的公式计算每个分子的溶剂化自由能 $G_{\\text{solv}}$。空腔半径 $a$ 也必须转换为米。\n4.  将得到的以焦耳为单位的分子能量乘以阿伏伽德罗常数 $N_A = 6.02214076\\times 10^{23} \\, \\text{mol}^{-1}$ 并除以 $1000$，转换为以千焦/摩尔为单位的摩尔量。\n5.  最后，计算溶剂化自由能的差值 $\\Delta\\Delta G_{\\text{solv}} = G_{\\text{solv}}^{\\text{chair}} - G_{\\text{solv}}^{\\text{boat}}$。负值表示与船式构象相比，椅式构象被溶剂更强地稳定化。\n\n**用例 A 分析**：对于真空情况，$\\varepsilon = 1.0$。因子 $\\frac{\\varepsilon-1}{2\\varepsilon+1}$ 变为 $0$，导致两种构象的 $G_{\\text{solv}}$ 均为 $0$。因此，$\\Delta\\Delta G_{\\text{solv}}$ 必须恰好为 $0.0$，这可作为一个一致性检查。", "answer": "```python\nimport numpy as np\n\n# A strict Russian professor does not tolerate magic numbers.\n# All physical constants and conversion factors are explicitly defined.\n\n# Provided physical constants\nE_CHARGE = 1.602176634e-19  # Elementary charge in C\nANGSTROM = 1.0e-10           # Angstrom in m\nEPSILON_0 = 8.8541878128e-12 # Vacuum permittivity in F/m\nN_A = 6.02214076e23          # Avogadro's number in mol^-1\n\ndef get_conformation_data():\n    \"\"\"\n    Returns the atomic coordinates and charges for the chair and boat\n    conformations of cyclohexane as specified in the problem statement.\n    \"\"\"\n    # Chair conformation data: coordinates (Å), charges (e)\n    chair_data = {\n        'coords': np.array([\n            [1.54, 0.00, 0.00],\n            [0.77, 1.33, 0.50],\n            [-0.77, 1.33, -0.50],\n            [-1.54, 0.00, 0.00],\n            [-0.77, -1.33, 0.50],\n            [0.77, -1.33, -0.50]\n        ]),\n        'charges': np.array([-0.03, 0.01, -0.02, 0.02, 0.01, 0.01])\n    }\n\n    # Boat conformation data: coordinates (Å), charges (e)\n    boat_data = {\n        'coords': np.array([\n            [1.54, 0.00, 0.60],\n            [0.77, 1.33, 0.00],\n            [-0.77, 1.33, 0.60],\n            [-1.54, 0.00, 0.00],\n            [-0.77, -1.33, 0.60],\n            [0.77, -1.33, 0.00]\n        ]),\n        'charges': np.array([-0.025, 0.015, -0.015, 0.015, -0.005, 0.015])\n    }\n    return chair_data, boat_data\n\ndef calculate_mu_squared(coords_A, charges_e):\n    \"\"\"\n    Computes the squared magnitude of the molecular dipole moment in SI units.\n    \n    Args:\n        coords_A (np.ndarray): Atomic coordinates in Angstroms.\n        charges_e (np.ndarray): Atomic partial charges in elementary charge units.\n        \n    Returns:\n        float: The squared dipole moment (mu^2) in (C*m)^2.\n    \"\"\"\n    # Convert input data to SI units\n    coords_m = coords_A * ANGSTROM\n    charges_C = charges_e * E_CHARGE\n    \n    # Reshape charges for broadcasting: (N,) -> (N, 1)\n    charges_C_col = charges_C[:, np.newaxis]\n    \n    # Compute dipole moment vector: mu = sum(q_i * r_i)\n    mu_vector = np.sum(charges_C_col * coords_m, axis=0) # Result is a 1D array of size 3\n    \n    # Compute and return the squared magnitude of the dipole moment vector\n    mu_squared = np.sum(mu_vector**2)\n    return mu_squared\n\ndef compute_g_solv(mu_squared, epsilon, radius_A):\n    \"\"\"\n    Calculates the molar solvation free energy G_solv in kJ/mol.\n    \n    Args:\n        mu_squared (float): Squared molecular dipole moment in (C*m)^2.\n        epsilon (float): Relative permittivity of the solvent.\n        radius_A (float): Cavity radius in Angstroms.\n        \n    Returns:\n        float: Molar solvation free energy in kJ/mol.\n    \"\"\"\n    # Handle the vacuum case separately to avoid division by zero or precision issues\n    if epsilon == 1.0:\n        return 0.0\n\n    # Convert radius to SI units\n    radius_m = radius_A * ANGSTROM\n    \n    # Calculate the reaction field factor from the Onsager model\n    reaction_factor = (epsilon - 1.0) / (2.0 * epsilon + 1.0)\n    \n    # The derived formula for G_solv for a single molecule in Joules\n    # G_solv = - (1 / (4*pi*eps0)) * ( (eps-1)/(2*eps+1) ) * (mu^2 / a^3)\n    g_solv_joules = - (1 / (4 * np.pi * EPSILON_0)) * reaction_factor * (mu_squared / (radius_m**3))\n    \n    # Convert to molar energy in kJ/mol\n    g_solv_kj_mol = (g_solv_joules * N_A) / 1000.0\n    \n    return g_solv_kj_mol\n    \ndef solve():\n    \"\"\"\n    Main function to execute the full calculation and print the results.\n    \"\"\"\n    \n    # Define the test cases from the problem statement\n    # Each case is a tuple (relative_permittivity, cavity_radius_in_Angstrom)\n    test_cases = [\n        (1.0, 3.5),       # Case A: Vacuum\n        (2.238, 3.5),     # Case B: CCl4, a=3.5\n        (78.3553, 3.5),   # Case C: Water (highly polar)\n        (2.238, 3.0),     # Case D: CCl4, a=3.0\n    ]\n    \n    # Retrieve molecular data\n    chair_data, boat_data = get_conformation_data()\n    \n    # Pre-calculate squared dipole moments as they are independent of test cases\n    mu_sq_chair = calculate_mu_squared(chair_data['coords'], chair_data['charges'])\n    mu_sq_boat = calculate_mu_squared(boat_data['coords'], boat_data['charges'])\n\n    results = []\n    for epsilon, radius_A in test_cases:\n        # Calculate G_solv for each conformation for the current test case\n        g_solv_chair = compute_g_solv(mu_sq_chair, epsilon, radius_A)\n        g_solv_boat = compute_g_solv(mu_sq_boat, epsilon, radius_A)\n        \n        # Calculate the final energy difference\n        delta_delta_g = g_solv_chair - g_solv_boat\n        results.append(delta_delta_g)\n\n    # Format the final output as a comma-separated list of floating-point numbers\n    # with exactly six digits after the decimal point, enclosed in brackets.\n    output_str = f\"[{','.join([f'{res:.6f}' for res in results])}]\"\n    print(output_str)\n\n# Execute the solution\nsolve()\n\n```", "id": "2465434"}, {"introduction": "在真实的PCM计算中，溶质的电子云并非一成不变，它会被溶剂产生的反应场极化，而这个反应场本身又依赖于溶质的电荷分布。这种相互作用通过一个称为自洽反应场（SCRF）的迭代过程来求解，直至溶质与溶剂的电场达到平衡。本练习将让你编写一个简化的SCRF循环，从而揭开PCM方法“自洽”这一核心概念的神秘面纱。你将探索其收敛的条件，并理解为何高极化性的溶质在强极性溶剂中可能带来数值计算上的挑战，从而更深刻地体会现代PCM计算的精髓。[@problem_id:2465389]", "problem": "您将要在一个可极化连续介质模型 (Polarizable Continuum Model, PCM) 中为一个简单的自洽反应场 (Self-Consistent Reaction Field, SCRF) 循环建模。该模型描述了一个溶质，此溶质由一个点偶极子表示，位于半径为 $a$ 的球形空腔中心，并嵌入在相对介电常数为 $\\varepsilon$ 的均匀、各向同性的电介质中。该溶质具有永久偶极矩 $\\mu_{\\mathrm{perm}}$ 和各向同性极化率 $\\alpha$。为简化起见，所有量均视为沿固定方向的标量，并且所有电磁量均以原子单位表示。具体来说，偶极矩和极化率使用原子单位，空腔半径使用玻尔 (bohr)；介电常数为无量纲量。\n\n在球形空腔中，位于中心的偶极子 $\\mu$ 所经历的反应场由下式给出：\n$$\nE_{\\mathrm{reac}}(\\mu) = k\\,\\mu,\n\\quad\\text{其中}\\quad\nk = \\frac{2(\\varepsilon - 1)}{(2\\varepsilon + 1)\\,a^3}.\n$$\n\n感生偶极矩与反应场的关系如下：\n$$\n\\mu_{\\mathrm{ind}} = \\alpha\\,E_{\\mathrm{reac}}(\\mu_{\\mathrm{tot}}),\n$$\n总偶极矩满足：\n$$\n\\mu_{\\mathrm{tot}} = \\mu_{\\mathrm{perm}} + \\mu_{\\mathrm{ind}}.\n$$\n\n将 SCRF 循环定义为关于总偶极矩的不动点迭代：\n$$\n\\mu^{(n+1)} = \\mu_{\\mathrm{perm}} + \\alpha\\,k\\,\\mu^{(n)},\n$$\n初始值为 $\\mu^{(0)} = \\mu_{\\mathrm{perm}}$。当连续迭代值之间的绝对变化满足以下条件时，认为迭代收敛：\n$$\n\\left|\\mu^{(n+1)} - \\mu^{(n)}\\right| \\le \\tau,\n$$\n其中容差 $\\tau = 10^{-6}$ (原子单位)。如果在最多 $M = 10000$ 次迭代内未满足此条件，则宣告不收敛。\n\n请实现一个程序，对以下每个测试用例，返回达到收敛判据所需的迭代次数；如果在 $M$ 次迭代内未达到收敛，则该用例返回 $-1$。\n\n使用以下测试套件，所有输入均以上述原子单位给出：\n\n- 案例 1 (水中非极性甲烷)：$\\varepsilon = 78.3553$, $a = 4.0$, $\\alpha = 17.5$, $\\mu_{\\mathrm{perm}} = 0.0$。\n- 案例 2 (水中两性离子甘氨酸)：$\\varepsilon = 78.3553$, $a = 7.5$, $\\alpha = 40.0$, $\\mu_{\\mathrm{perm}} = 5.90184$。\n- 案例 3 (接近收缩极限；具有挑战性但收敛)：$\\varepsilon = 78.3553$, $a = 3.0$, $\\alpha = 27.27$, $\\mu_{\\mathrm{perm}} = 1.0$。\n- 案例 4 (超出收缩极限；发散)：$\\varepsilon = 78.3553$, $a = 3.0$, $\\alpha = 28.5$, $\\mu_{\\mathrm{perm}} = 1.0$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果 (例如, \"[n1,n2,n3,n4]\")，其中每个 $n\\_i$ 是对应案例的整数迭代次数，如果迭代在 $M$ 步内未能收敛，则为 $-1$。", "solution": "问题陈述已被解析和验证。该问题具有科学依据、提法明确且客观。它代表了计算化学中关于自洽反应场 (SCRF) 方法的一个标准练习，具体是针对球形溶质的 Onsager 模型。所有参数、方程和条件都定义清晰，允许直接且明确的算法实现。该问题有效。\n\n问题的核心是求解溶质在电介质中的总偶极矩 $\\mu_{\\mathrm{tot}}$。总偶极矩是永久偶极矩 $\\mu_{\\mathrm{perm}}$ 和感生偶极矩 $\\mu_{\\mathrm{ind}}$ 的和。感生偶极矩源于溶质的极化率 $\\alpha$ 对由极化电介质产生的反应场 $E_{\\mathrm{reac}}$ 的响应。\n\n控制方程为：\n$$ \\mu_{\\mathrm{tot}} = \\mu_{\\mathrm{perm}} + \\mu_{\\mathrm{ind}} $$\n$$ \\mu_{\\mathrm{ind}} = \\alpha E_{\\mathrm{reac}}(\\mu_{\\mathrm{tot}}) $$\n对于位于介电常数为 $\\varepsilon$ 的介质中、半径为 $a$ 的球形空腔中心的偶极子 $\\mu$，其反应场由下式给出：\n$$ E_{\\mathrm{reac}}(\\mu) = k \\mu $$\n其中反应场因子 $k$ 为：\n$$ k = \\frac{2(\\varepsilon - 1)}{(2\\varepsilon + 1)a^3} $$\n结合这些方程可得到一个关于总偶极矩的自洽方程：\n$$ \\mu_{\\mathrm{tot}} = \\mu_{\\mathrm{perm}} + \\alpha k \\mu_{\\mathrm{tot}} $$\n该问题正确地将其表述为不动点迭代，这是解决此类 SCRF 问题的常用数值方法。迭代格式定义为：\n$$ \\mu^{(n+1)} = f(\\mu^{(n)}) = \\mu_{\\mathrm{perm}} + \\alpha k \\mu^{(n)} $$\n初始猜测值为气相偶极矩，$\\mu^{(0)} = \\mu_{\\mathrm{perm}}$。\n\n这是一个形式为 $x_{n+1} = c + m x_n$ 的线性不动点迭代。此类迭代的收敛性由 Banach 不动点定理决定。如果映射函数 $f$ 是一个压缩映射，则迭代保证收敛到一个唯一的不动点。对于单变量可微函数，此条件简化为要求其导数的绝对值在相关定义域上严格小于一。这里，映射函数为 $f(\\mu) = \\mu_{\\mathrm{perm}} + \\alpha k \\mu$。其导数为一个常数：\n$$ \\frac{df}{d\\mu} = \\alpha k $$\n由于所有参数 $\\alpha$、$\\varepsilon$ 和 $a$ 均为正数，因子 $k$ 也为正数。因此，收敛条件为：\n$$ \\alpha k < 1 $$\n代入 $k$ 的表达式：\n$$ \\alpha \\frac{2(\\varepsilon - 1)}{(2\\varepsilon + 1)a^3} < 1 $$\n如果满足此条件，序列 $\\{\\mu^{(n)}\\}_{n=0}^{\\infty}$ 将收敛到不动点 $\\mu_{\\mathrm{final}}$，该不动点是方程 $\\mu_{\\mathrm{final}} = \\mu_{\\mathrm{perm}} + \\alpha k \\mu_{\\mathrm{final}}$ 的解：\n$$ \\mu_{\\mathrm{final}} = \\frac{\\mu_{\\mathrm{perm}}}{1 - \\alpha k} $$\n如果 $\\alpha k \\ge 1$，迭代将发散（除非 $\\mu_{\\mathrm{perm}}=0$，此时迭代在 $\\mu=0$ 处显然稳定）。\n\n待实现的算法将对每个测试用例执行此迭代。\n对于由参数 $\\varepsilon$、 $a$、$\\alpha$ 和 $\\mu_{\\mathrm{perm}}$ 指定的每个用例：\n1. 计算恒定的反应场因子 $k$。\n2. 将迭代计数器 $n$ 初始化为 $0$，并将当前步骤的偶极矩 $\\mu_{\\mathrm{current}}$ 初始化为 $\\mu^{(0)} = \\mu_{\\mathrm{perm}}$。\n3. 开始一个最多可运行 $M = 10000$ 次的循环。\n4. 在循环的每一步（由 $n$ 索引），计算下一个偶极矩 $\\mu_{\\mathrm{next}} = \\mu_{\\mathrm{perm}} + \\alpha k \\mu_{\\mathrm{current}}$。\n5. 通过比较绝对差值 $|\\mu_{\\mathrm{next}} - \\mu_{\\mathrm{current}}|$ 与容差 $\\tau = 10^{-6}$ 来检查收敛性。\n6. 如果满足收敛判据，则执行的迭代次数为 $n+1$。记录此值，并终止当前用例的循环。\n7. 如果不满足判据，则更新 $\\mu_{\\mathrm{current}} \\leftarrow \\mu_{\\mathrm{next}}$ 并继续下一次迭代。\n8. 如果循环完成全部 $M$ 次迭代仍未收敛，则该过程失败。为此用例记录值 $-1$。\n\n此过程将应用于提供的所有四个测试用例。对每个案例的收敛因子 $\\alpha k$ 进行快速分析，可以证实问题的描述：\n- 案例 1 ($\\mu_{\\mathrm{perm}} = 0.0$): 平凡收敛。不动点为 $\\mu=0$。初始猜测值已经是解。算法应报告 1 次迭代，因为它需要一步来确认收敛。\n- 案例 2 ($\\alpha k \\approx 0.093$): 该因子远小于 1，因此预计会快速收敛。\n- 案例 3 ($\\alpha k \\approx 0.990$): 该因子非常接近 1，表明收敛会很慢，如描述所述。\n- 案例 4 ($\\alpha k \\approx 1.035$): 该因子大于 1，因此预计迭代会发散并达到最大迭代次数限制 $M$。结果应为 -1。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the number of SCRF iterations for a set of test cases\n    based on the polarizable continuum model (PCM).\n    \"\"\"\n\n    # Define the constants from the problem statement.\n    TOLERANCE_TAU = 1e-6\n    MAX_ITERATIONS_M = 10000\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (epsilon, a, alpha, mu_perm)\n    test_cases = [\n        # Case 1 (nonpolar methane in water)\n        (78.3553, 4.0, 17.5, 0.0),\n        # Case 2 (zwitterionic glycine in water)\n        (78.3553, 7.5, 40.0, 5.90184),\n        # Case 3 (near the contraction limit)\n        (78.3553, 3.0, 27.27, 1.0),\n        # Case 4 (beyond the contraction limit)\n        (78.3553, 3.0, 28.5, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        epsilon, a, alpha, mu_perm = case\n\n        # Calculate the reaction field factor k.\n        # k = (2 * (epsilon - 1)) / ((2 * epsilon + 1) * a**3)\n        k = (2.0 * (epsilon - 1.0)) / ((2.0 * epsilon + 1.0) * a**3)\n\n        # Initialize the dipole moment for the iteration.\n        # mu^(0) = mu_perm\n        mu_current = mu_perm\n        \n        # Flag to indicate if convergence was reached.\n        converged = False\n\n        # Start the SCRF iteration loop for n = 0, 1, ..., M-1.\n        for n in range(MAX_ITERATIONS_M):\n            # Calculate the next iterate: mu^(n+1) = mu_perm + alpha * k * mu^(n)\n            mu_next = mu_perm + alpha * k * mu_current\n            \n            # Check for convergence: |mu^(n+1) - mu^(n)| <= tau\n            if abs(mu_next - mu_current) <= TOLERANCE_TAU:\n                # The number of iterations is n+1.\n                results.append(n + 1)\n                converged = True\n                break\n            \n            # Update the dipole for the next iteration.\n            mu_current = mu_next\n            \n        # If the loop finished without converging, append -1.\n        if not converged:\n            results.append(-1)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2465389"}, {"introduction": "现在，让我们将所学知识应用于一个真实的生物化学问题：为什么氨基酸的酸度（$\\mathrm{p}K_{\\mathrm{a}}$）会因其所处环境（暴露于水或深埋于蛋白质内部）而发生巨大变化？我们将结合热力学循环和用于离子的Born模型（PCM的一个简化极限）来定量解释这一现象。通过计算将去质子化后生成的阴离子从高介电常数的水转移到低介电常数的蛋白质内部所付出的能量代价，你将能够预测酪氨酸残基的$\\mathrm{p}K_{\\mathrm{a}}$偏移。这个练习展示了连续介质模型在解释生物化学现象方面的强大威力，让你掌握如何利用热力学循环来预测局部环境对化学性质的关键影响，这是酶学和蛋白质工程中的基石概念。[@problem_id:2465430]", "problem": "要求您使用可极化连续介质模型 (Polarizable Continuum Model, PCM) 模拟酪氨酸侧链上的酚性质子从液态水转移到低介电常数的蛋白质内部时其酸性的变化。您必须从静电学和热力学的基本原理出发，将溶剂化自由能与酸性联系起来。考虑在溶剂介质中的去质子化反应，写作 $\\mathrm{AH} \\rightarrow \\mathrm{A}^{-} + \\mathrm{H}^{+}$，其中 $\\mathrm{AH}$ 是中性酚，$\\mathrm{A}^{-}$ 是酚盐。通过热力学平衡常数定义酸性，即 $K_{\\mathrm{a}} = \\exp\\left(-\\Delta G_{\\mathrm{deprot}}/(R T)\\right)$ 和 $\\mathrm{p}K_{\\mathrm{a}} = -\\log_{10} K_{\\mathrm{a}} = \\Delta G_{\\mathrm{deprot}}/(R T \\ln 10)$，其中 $R$ 是摩尔气体常数， $T$ 是绝对温度。\n\n对于溶剂化模型，作如下假设：\n- 对离子溶剂化，使用 Born 近似下的可极化连续介质模型 (PCM)。一个电荷为 $z e$、半径为 $r$ 的球形离子在相对介电常数为 $\\varepsilon$ 的介质中的 Born 溶剂化自由能为\n$$\n\\Delta G_{\\mathrm{solv}}(z, r, \\varepsilon) = - \\frac{N_{\\mathrm{A}} \\, (z e)^{2}}{8 \\pi \\varepsilon_{0} \\, r} \\left(1 - \\frac{1}{\\varepsilon}\\right),\n$$\n其中 $N_{\\mathrm{A}}$ 是阿伏伽德罗常数，$e$ 是元电荷，$\\varepsilon_{0}$ 是真空介电常数。半径 $r$ 的单位必须是米，结果的单位是焦耳/摩尔。\n- 在此 Born 框架内，将中性酚 $\\mathrm{AH}$ 视为不带电荷进行溶剂化处理，即对于所有 $\\varepsilon$，取 $\\Delta G_{\\mathrm{solv}}(0, r_{\\mathrm{AH}}, \\varepsilon) = 0$。\n- 将共轭碱 $\\mathrm{A}^{-}$ 建模为具有 $z = -1$ 和有效 Born 半径 $r_{\\mathrm{A}^{-}}$ 的一价阴离子。\n- 通过一个热力学循环来定义蛋白质内部的酸性，其中释放的质子与水性质子库进行交换。也就是说，蛋白质内部的去质子化自由能包含在蛋白质内部介电常数下计算的 $\\mathrm{A}^{-}$ 的 $\\Delta G_{\\mathrm{solv}}$，而质子项则参考本体水。水相参考 $\\mathrm{p}K_{\\mathrm{a}}$ 作为输入参数给出。\n\n使用这些定义，计算酪氨酸酚从水转移到相对介电常数 $\\varepsilon_{\\mathrm{prot}} = 4$ 的蛋白质内部时的酸性偏移，然后计算蛋白质内部的 $\\mathrm{p}K_{\\mathrm{a}}$。对于每个测试用例，您的程序必须计算以下内容：\n- 输入的水相 $\\mathrm{p}K_{\\mathrm{a}}$ 值 $\\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{water}}$ (无量纲)，\n- 蛋白质内部的 $\\mathrm{p}K_{\\mathrm{a}}$ 值 $\\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{prot}}$ (无量纲)，\n- 偏移量 $\\Delta \\mathrm{p}K_{\\mathrm{a}} = \\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{prot}} - \\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{water}}$ (无量纲)。\n\n使用以下以国际单位制 (SI) 表示的物理常数：\n- $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23} \\,\\mathrm{mol}^{-1}$，\n- $e = 1.602176634 \\times 10^{-19} \\,\\mathrm{C}$，\n- $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12} \\,\\mathrm{F}\\,\\mathrm{m}^{-1}$，\n- $R = 8.31446261815324 \\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，\n- $1\\,\\text{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$，\n- $\\ln 10 = 2.302585093$。\n\n所有输出均为无量纲的 $\\mathrm{p}K_{\\mathrm{a}}$ 值；最终答案中不出现其他物理单位。不涉及角度。\n\n您必须精确实现的参数值测试套件：\n- 案例 1 (正常路径): $r_{\\mathrm{A}^{-}} = 2.0\\,\\text{\\AA}$, $\\varepsilon_{\\mathrm{prot}} = 4.0$, $\\varepsilon_{\\mathrm{water}} = 78.37$, $T = 298.15\\,\\mathrm{K}$, $\\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{water}} = 10.10$。\n- 案例 2 (尺寸敏感性): $r_{\\mathrm{A}^{-}} = 3.0\\,\\text{\\AA}$, $\\varepsilon_{\\mathrm{prot}} = 4.0$, $\\varepsilon_{\\mathrm{water}} = 78.37$, $T = 298.15\\,\\mathrm{K}$, $\\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{water}} = 10.10$。\n- 案例 3 (边界条件，无偏移): $r_{\\mathrm{A}^{-}} = 2.0\\,\\text{\\AA}$, $\\varepsilon_{\\mathrm{prot}} = 78.37$, $\\varepsilon_{\\mathrm{water}} = 78.37$, $T = 298.15\\,\\mathrm{K}$, $\\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{water}} = 10.10$。\n- 案例 4 (温度和介电常数变化): $r_{\\mathrm{A}^{-}} = 2.0\\,\\text{\\AA}$, $\\varepsilon_{\\mathrm{prot}} = 10.0$, $\\varepsilon_{\\mathrm{water}} = 78.37$, $T = 310.00\\,\\mathrm{K}$, $\\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{water}} = 10.10$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表，用方括号括起。每个测试用例贡献一个三元组列表，顺序为 $[\\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{water}}, \\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{prot}}, \\Delta \\mathrm{p}K_{\\mathrm{a}}]$。每个浮点数必须四舍五入到三位小数。例如：$[[x_{1},y_{1},z_{1}],[x_{2},y_{2},z_{2}],\\ldots]$。", "solution": "所述问题在科学上是合理的、提法得当，并包含获得唯一解所需的所有信息。因此，可以基于热力学和静电学的基本原理进行严谨的分析。\n\n核心任务是确定酚基从水性介质转移到蛋白质的疏水内部时，其酸解离常数 $\\mathrm{p}K_{\\mathrm{a}}$ 的变化。酸性由去质子化的吉布斯自由能 $\\Delta G_{\\mathrm{deprot}}$ 通过以下关系定量定义：\n$$\n\\mathrm{p}K_{\\mathrm{a}} = \\frac{\\Delta G_{\\mathrm{deprot}}}{R T \\ln 10}\n$$\n其中 $R$ 是摩尔气体常数，$T$ 是绝对温度。\n\n将酸 $\\mathrm{AH}$ 从水 (w) 转移到蛋白质内部 (p) 时，$\\mathrm{p}K_{\\mathrm{a}}$ 的偏移由下式给出：\n$$\n\\Delta \\mathrm{p}K_{\\mathrm{a}} = \\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{prot}} - \\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{water}} = \\frac{\\Delta G_{\\mathrm{deprot}, \\mathrm{p}} - \\Delta G_{\\mathrm{deprot}, \\mathrm{w}}}{R T \\ln 10}\n$$\n为了计算 $\\Delta G_{\\mathrm{deprot}, \\mathrm{p}} - \\Delta G_{\\mathrm{deprot}, \\mathrm{w}}$ 这一项，我们必须构建一个恰当的热力学循环。在溶剂介质 (s) 中的去质子化反应为 $\\mathrm{AH}_{(\\mathrm{s})} \\rightleftharpoons \\mathrm{A}^{-}_{(\\mathrm{s})} + \\mathrm{H}^{+}_{(\\mathrm{s})}$。溶剂中任意物种 $\\mathrm{X}$ 的自由能可以分解为其气相自由能 $G_{\\mathrm{gas}}(\\mathrm{X})$ 和其溶剂化自由能 $\\Delta G_{\\mathrm{solv}, \\mathrm{s}}(\\mathrm{X})$：\n$$\nG_{\\mathrm{s}}(\\mathrm{X}) = G_{\\mathrm{gas}}(\\mathrm{X}) + \\Delta G_{\\mathrm{solv}, \\mathrm{s}}(\\mathrm{X})\n$$\n因此，在溶剂 s 中的去质子化自由能为：\n$$\n\\Delta G_{\\mathrm{deprot}, \\mathrm{s}} = (G_{\\mathrm{gas}}(\\mathrm{A}^{-}) + \\Delta G_{\\mathrm{solv}, \\mathrm{s}}(\\mathrm{A}^{-})) + (G_{\\mathrm{gas}}(\\mathrm{H}^{+}) + \\Delta G_{\\mathrm{solv}, \\mathrm{s}}(\\mathrm{H}^{+})) - (G_{\\mathrm{gas}}(\\mathrm{AH}) + \\Delta G_{\\mathrm{solv}, \\mathrm{s}}(\\mathrm{AH}))\n$$\n这可以重排为气相贡献和溶剂化贡献：\n$$\n\\Delta G_{\\mathrm{deprot}, \\mathrm{s}} = \\Delta G_{\\mathrm{deprot, gas}} + (\\Delta G_{\\mathrm{solv}, \\mathrm{s}}(\\mathrm{A}^{-}) + \\Delta G_{\\mathrm{solv}, \\mathrm{s}}(\\mathrm{H}^{+}) - \\Delta G_{\\mathrm{solv}, \\mathrm{s}}(\\mathrm{AH}))\n$$\n其中 $\\Delta G_{\\mathrm{deprot, gas}} = G_{\\mathrm{gas}}(\\mathrm{A}^{-}) + G_{\\mathrm{gas}}(\\mathrm{H}^{+}) - G_{\\mathrm{gas}}(\\mathrm{AH})$ 是内禀气相酸性。\n\n问题为蛋白质环境指定了一个特定的热力学循环：$\\mathrm{AH}$ 的去质子化发生在蛋白质内部，但生成的质子被释放到本体水库中。这对应于反应 $\\mathrm{AH}_{(\\mathrm{p})} \\rightleftharpoons \\mathrm{A}^{-}_{(\\mathrm{p})} + \\mathrm{H}^{+}_{(\\mathrm{w})}$。该过程的自由能为：\n$$\n\\Delta G_{\\mathrm{deprot}, \\mathrm{p}} = \\Delta G_{\\mathrm{deprot, gas}} + (\\Delta G_{\\mathrm{solv}, \\mathrm{p}}(\\mathrm{A}^{-}) + \\Delta G_{\\mathrm{solv}, \\mathrm{w}}(\\mathrm{H}^{+}) - \\Delta G_{\\mathrm{solv}, \\mathrm{p}}(\\mathrm{AH}))\n$$\n对于在水中的参考反应，所有物种都在水相中：\n$$\n\\Delta G_{\\mathrm{deprot}, \\mathrm{w}} = \\Delta G_{\\mathrm{deprot, gas}} + (\\Delta G_{\\mathrm{solv}, \\mathrm{w}}(\\mathrm{A}^{-}) + \\Delta G_{\\mathrm{solv}, \\mathrm{w}}(\\mathrm{H}^{+}) - \\Delta G_{\\mathrm{solv}, \\mathrm{w}}(\\mathrm{AH}))\n$$\n那么，去质子化自由能的差值为：\n$$\n\\Delta G_{\\mathrm{deprot}, \\mathrm{p}} - \\Delta G_{\\mathrm{deprot}, \\mathrm{w}} = (\\Delta G_{\\mathrm{solv}, \\mathrm{p}}(\\mathrm{A}^{-}) - \\Delta G_{\\mathrm{solv}, \\mathrm{w}}(\\mathrm{A}^{-})) - (\\Delta G_{\\mathrm{solv}, \\mathrm{p}}(\\mathrm{AH}) - \\Delta G_{\\mathrm{solv}, \\mathrm{w}}(\\mathrm{AH}))\n$$\n$\\Delta G_{\\mathrm{deprot, gas}}$ 和 $\\Delta G_{\\mathrm{solv}, \\mathrm{w}}(\\mathrm{H}^{+})$ 项相互抵消。该表达式代表了将阴离子 $\\mathrm{A}^{-}$ 与中性酸 $\\mathrm{AH}$ 从水转移到蛋白质内部的自由能之差。\n\n问题基于 Born 模型框架提供了一个关键的简化：中性物种 $\\mathrm{AH}$ 的溶剂化自由能被视为零，即对于任何介质，$\\Delta G_{\\mathrm{solv}}(\\mathrm{AH}, \\varepsilon) = 0$。这将能量差简化为：\n$$\n\\Delta G_{\\mathrm{deprot}, \\mathrm{p}} - \\Delta G_{\\mathrm{deprot}, \\mathrm{w}} = \\Delta G_{\\mathrm{solv}, \\mathrm{p}}(\\mathrm{A}^{-}) - \\Delta G_{\\mathrm{solv}, \\mathrm{w}}(\\mathrm{A}^{-})\n$$\n阴离子 $\\mathrm{A}^{-}$ 在相对介电常数为 $\\varepsilon$ 的介质中，其电荷为 $z=-1$，半径为 $r_{\\mathrm{A}^{-}}$，其溶剂化自由能由 Born 公式给出：\n$$\n\\Delta G_{\\mathrm{solv}}(\\mathrm{A}^{-}) = \\Delta G_{\\mathrm{solv}}(-1, r_{\\mathrm{A}^{-}}, \\varepsilon) = - \\frac{N_{\\mathrm{A}} \\, (-1 \\cdot e)^{2}}{8 \\pi \\varepsilon_{0} \\, r_{\\mathrm{A}^{-}}} \\left(1 - \\frac{1}{\\varepsilon}\\right) = - \\frac{N_{\\mathrm{A}} e^{2}}{8 \\pi \\varepsilon_{0} r_{\\mathrm{A}^{-}}} \\left(1 - \\frac{1}{\\varepsilon}\\right)\n$$\n将此代入能量差方程得到：\n$$\n\\Delta G_{\\mathrm{deprot}, \\mathrm{p}} - \\Delta G_{\\mathrm{deprot}, \\mathrm{w}} = \\left[- \\frac{N_{\\mathrm{A}} e^{2}}{8 \\pi \\varepsilon_{0} r_{\\mathrm{A}^{-}}} \\left(1 - \\frac{1}{\\varepsilon_{\\mathrm{prot}}}\\right)\\right] - \\left[- \\frac{N_{\\mathrm{A}} e^{2}}{8 \\pi \\varepsilon_{0} r_{\\mathrm{A}^{-}}} \\left(1 - \\frac{1}{\\varepsilon_{\\mathrm{water}}}\\right)\\right]\n$$\n$$\n= - \\frac{N_{\\mathrm{A}} e^{2}}{8 \\pi \\varepsilon_{0} r_{\\mathrm{A}^{-}}} \\left[ \\left(1 - \\frac{1}{\\varepsilon_{\\mathrm{prot}}}\\right) - \\left(1 - \\frac{1}{\\varepsilon_{\\mathrm{water}}}\\right) \\right] = - \\frac{N_{\\mathrm{A}} e^{2}}{8 \\pi \\varepsilon_{0} r_{\\mathrm{A}^{-}}} \\left( \\frac{1}{\\varepsilon_{\\mathrm{water}}} - \\frac{1}{\\varepsilon_{\\mathrm{prot}}} \\right)\n$$\n$$\n= \\frac{N_{\\mathrm{A}} e^{2}}{8 \\pi \\varepsilon_{0} r_{\\mathrm{A}^{-}}} \\left( \\frac{1}{\\varepsilon_{\\mathrm{prot}}} - \\frac{1}{\\varepsilon_{\\mathrm{water}}} \\right)\n$$\n这个正能量差反映了将电荷置于低介电常数介质中相较于高介电常数介质所付出的能量代价。\n\n最后，通过除以热能因子得到 $\\mathrm{p}K_{\\mathrm{a}}$ 偏移：\n$$\n\\Delta \\mathrm{p}K_{\\mathrm{a}} = \\frac{N_{\\mathrm{A}} e^{2}}{8 \\pi \\varepsilon_{0} r_{\\mathrm{A}^{-}} R T \\ln 10} \\left( \\frac{1}{\\varepsilon_{\\mathrm{prot}}} - \\frac{1}{\\varepsilon_{\\mathrm{water}}} \\right)\n$$\n然后，蛋白质中的 $\\mathrm{p}K_{\\mathrm{a}}$ 计算为 $\\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{prot}} = \\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{water}} + \\Delta \\mathrm{p}K_{\\mathrm{a}}$。\n\n求解算法如下：\n1. 以国际单位制 (SI) 基本单位定义所有物理常数。\n2. 对于每个测试用例，检索参数：$r_{\\mathrm{A}^{-}}$ (单位为埃)、$\\varepsilon_{\\mathrm{prot}}$、$\\varepsilon_{\\mathrm{water}}$、$T$ 和 $\\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{water}}$。\n3. 将 $r_{\\mathrm{A}^{-}}$ 从埃转换为米。\n4. 使用推导出的公式计算自由能差 $\\Delta G_{\\mathrm{deprot}, \\mathrm{p}} - \\Delta G_{\\mathrm{deprot}, \\mathrm{w}}$。\n5. 计算 $\\mathrm{p}K_{\\mathrm{a}}$ 偏移量 $\\Delta \\mathrm{p}K_{\\mathrm{a}}$。\n6. 计算蛋白质内部的 $\\mathrm{p}K_{\\mathrm{a}}$，即 $\\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{prot}}$。\n7. 将三元组 [$\\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{water}}$, $\\mathrm{p}K_{\\mathrm{a}}^{\\mathrm{prot}}$, $\\Delta \\mathrm{p}K_{\\mathrm{a}}$] 格式化，每个值四舍五入到三位小数。\n8. 将所有测试用例的结果整理成一个列表，并按指定格式打印。该实现将使用 `numpy` 获取数学常数，如 $\\pi$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the pKa shift of a tyrosine side chain transferred from water to a protein interior\n    using the Born solvation model.\n    \"\"\"\n\n    # Physical constants in SI units\n    N_A = 6.02214076e23  # Avogadro's number (mol^-1)\n    e = 1.602176634e-19  # Elementary charge (C)\n    eps_0 = 8.8541878128e-12  # Vacuum permittivity (F m^-1)\n    R = 8.31446261815324  # Molar gas constant (J mol^-1 K^-1)\n    ln_10 = 2.302585093     # Natural logarithm of 10\n    A_to_m = 1.0e-10       # Angstrom to meter conversion factor\n\n    # Test cases from the problem statement\n    test_cases = [\n        # (r_A_minus in Angstrom, eps_prot, eps_water, T in Kelvin, pKa_water)\n        (2.0, 4.0, 78.37, 298.15, 10.10),\n        (3.0, 4.0, 78.37, 298.15, 10.10),\n        (2.0, 78.37, 78.37, 298.15, 10.10),\n        (2.0, 10.0, 78.37, 310.00, 10.10),\n    ]\n\n    results = []\n    \n    # Pre-calculate the constant part of the energy formula\n    # Units: (mol^-1 * C^2) / (F * m^-1) = (mol^-1 * C^2) / (C * V^-1 * m^-1) \n    # = J * m * mol^-1\n    energy_prefactor = (N_A * e**2) / (8 * np.pi * eps_0)\n\n    for case in test_cases:\n        r_A_minus_A, eps_prot, eps_water, T, pKa_water = case\n\n        # Convert radius to SI units (meters)\n        r_A_minus_m = r_A_minus_A * A_to_m\n\n        # Calculate the free energy difference for transferring the anion from water to protein\n        # This is derived in the solution text.\n        # Units: (J * m * mol^-1) / m * (dimensionless) = J * mol^-1\n        dielectric_term = (1.0 / eps_prot) - (1.0 / eps_water)\n        delta_G_diff = (energy_prefactor / r_A_minus_m) * dielectric_term\n\n        # Calculate the pKa shift\n        # Units: (J * mol^-1) / (J * mol^-1 * K^-1 * K) = dimensionless\n        delta_pKa = delta_G_diff / (R * T * ln_10)\n\n        # Calculate the pKa in the protein interior\n        pKa_prot = pKa_water + delta_pKa\n\n        # Store the required values\n        results.append([pKa_water, pKa_prot, delta_pKa])\n    \n    # Format the output exactly as required\n    output_strings = []\n    for res in results:\n        # Format each number to three decimal places\n        pka_w_str = f\"{res[0]:.3f}\"\n        pka_p_str = f\"{res[1]:.3f}\"\n        delta_pka_str = f\"{res[2]:.3f}\"\n        \n        # Assemble the string for a single test case result\n        output_strings.append(f\"[{pka_w_str},{pka_p_str},{delta_pka_str}]\")\n\n    # Join the strings for all test cases and enclose in brackets\n    final_output = f\"[{','.join(output_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2465430"}]}