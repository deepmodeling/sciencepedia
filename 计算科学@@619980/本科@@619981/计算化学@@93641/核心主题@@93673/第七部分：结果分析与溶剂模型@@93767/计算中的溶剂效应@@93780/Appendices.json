{"hands_on_practices": [{"introduction": "我们从最简单但最具启发性的情况开始：单个离子在溶剂中的溶解。本练习将引导您应用经典的 Born 模型来计算一个离子（氯离子 $\\text{Cl}^-$）的溶剂化自由能。本练习的重点不仅在于计算一个数值，更在于探索模型对一个关键参数——空腔半径的敏感性，从而揭示隐式溶剂模型的一个重要实践挑战 [@problem_id:2462575]。", "problem": "您需要编写一个完整、可运行的程序，用以计算在可极化连续介质模型 (PCM) 中，液态水中氯离子 $\\text{Cl}^-$ 的溶剂化自由能对所用空腔半径选择的敏感性。请使用 Born 模型表达式计算溶剂化自由能，该模型近似计算了半径为 $r$ 的球形离子嵌入电介质连续体中的充电功：\n$$\n\\Delta G_{\\text{solv}}(r,\\varepsilon) \\;=\\; N_{\\mathrm{A}} \\,\\frac{(z e)^2}{8\\pi \\varepsilon_0\\, r}\\,\\Big(\\frac{1}{\\varepsilon}-1\\Big),\n$$\n其中 $N_{\\mathrm{A}}$ 是阿伏伽德罗常数，$z$ 是离子电荷数，$e$ 是元电荷，$\\varepsilon_0$ 是真空介电常数，$\\varepsilon$ 是溶剂的静态相对介电常数（介电常数）。溶剂为室温下的液态水，其介电常数 $\\varepsilon = 78.37$。对于 $\\text{Cl}^-$，使用 $z=-1$。使用 $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$，$e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$，以及 $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\ \\mathrm{F\\,m^{-1}}$。将空腔半径 $r$ 视为一个以米为单位的参数。上述 Born 模型公式计算出的 $\\Delta G_{\\text{solv}}$ 单位为焦耳/摩尔；请将您的结果转换为千焦/摩尔。所有计算结果都必须以千焦/摩尔表示。\n\n对于每个测试用例，定义一个标称 PCM 空腔半径 $r_0$（以埃为单位），并考虑由 $\\pm 10\\%$ 相对变化给出的两个微扰半径：\n- 减小后的半径为 $0.9\\,r_0$。\n- 增大后的半径为 $1.1\\,r_0$。\n\n对于每个测试用例，计算以下三个量，单位均为千焦/摩尔：\n- 标称溶剂化自由能 $\\Delta G_{\\text{solv}}(r_0,\\varepsilon)$。\n- 对于 $-10\\%$ 变化的绝对误差，定义为 $\\big|\\Delta G_{\\text{solv}}(0.9\\,r_0,\\varepsilon) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon)\\big|$。\n- 对于 $+10\\%$ 变化的绝对误差，定义为 $\\big|\\Delta G_{\\text{solv}}(1.1\\,r_0,\\varepsilon) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon)\\big|$。\n\n对 $\\text{Cl}^-$ 使用以下标称空腔半径 $r_0$（以埃为单位）的测试套件：$[\\,1.60,\\ 1.81,\\ 2.00,\\ 2.20\\,]$。使用 $1$ Å $= 1.0\\times 10^{-10}$ m 将埃转换为米。\n\n您的程序必须生成单行输出，其中包含一个含 4 个子列表的列表，每个子列表对应一个测试用例。每个子列表包含上述的三个浮点数，顺序完全一致，单位为千焦/摩尔，且每个数值都四舍五入到两位小数。例如，要求的格式为\n$[\\,[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],[x_{31},x_{32},x_{33}],[x_{41},x_{42},x_{43}]\\,]$，\n无任何附加文本。", "solution": "问题陈述已根据所需标准进行了严格验证。\n\n**步骤 1：提取已知条件**\n- **模型方程**：Born 模型溶剂化自由能表达式，$\\Delta G_{\\text{solv}}(r,\\varepsilon) \\;=\\; N_{\\mathrm{A}} \\,\\frac{(z e)^2}{8\\pi \\varepsilon_0\\, r}\\,\\Big(\\frac{1}{\\varepsilon}-1\\Big)$。\n- **离子**：氯离子 ($\\text{Cl}^-$)，其电荷数 $z=-1$。\n- **溶剂**：液态水，其静态相对介电常数 $\\varepsilon = 78.37$。\n- **物理常数**：\n  - 阿伏伽德罗常数：$N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n  - 元电荷：$e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$。\n  - 真空介电常数：$\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\ \\mathrm{F\\,m^{-1}}$。\n- **单位转换**：\n  - 输入半径 $r_0$ 以埃（Å）为单位，其中 $1\\ \\text{Å} = 1.0\\times 10^{-10}\\ \\mathrm{m}$。\n  - 输出能量以千焦/摩尔（$\\mathrm{kJ \\cdot mol^{-1}}$）为单位，其中 $1\\ \\mathrm{kJ} = 1000\\ \\mathrm{J}$。\n- **测试套件**：一组用于 $\\text{Cl}^-$ 的标称空腔半径 $r_0$：$[\\,1.60,\\ 1.81,\\ 2.00,\\ 2.20\\,]$，单位为埃。\n- **任务**：对每个 $r_0$ 计算三个值：\n  1. 标称溶剂化自由能 $\\Delta G_{\\text{solv}}(r_0,\\varepsilon)$。\n  2. 半径变化 $-10\\%$ 的绝对误差：$|\\Delta G_{\\text{solv}}(0.9\\,r_0,\\varepsilon) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon)|$。\n  3. 半径变化 $+10\\%$ 的绝对误差：$|\\Delta G_{\\text{solv}}(1.1\\,r_0,\\varepsilon) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon)|$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题被评估为有科学依据、提法恰当且客观。\n- **科学依据**：它基于 Born 模型，这是物理化学中连续介质溶剂化理论的基石。所有物理常数均以其标准、公认的值给出。研究模型对某一参数（空腔半径）的敏感性是计算化学中的一项标准且有意义的任务。\n- **提法恰当性**：该问题提供了精确的数学公式、所有必要的数值输入，以及对所需输出的清晰、明确的说明。它允许一个唯一的、稳定的、可直接计算的解。\n- **客观性**：语言是定量且精确的，没有任何主观或推测性内容。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。将制定解决方案。\n\n解决方案从球形离子在电介质连续体中的溶剂化自由能 $\\Delta G_{\\text{solv}}$ 的 Born 模型方程开始：\n$$\n\\Delta G_{\\text{solv}}(r,\\varepsilon) \\;=\\; N_{\\mathrm{A}} \\,\\frac{(z e)^2}{8\\pi \\varepsilon_0\\, r}\\,\\Big(\\frac{1}{\\varepsilon}-1\\Big)\n$$\n此处，$r$ 是空腔半径，$\\varepsilon$ 是溶剂的静态相对介电常数。所有其他符号代表基本物理常数。\n\n为提高计算效率，将所有与半径 $r$ 无关的项组合成一个单一的常数因子，我们将其记为 $C_{\\text{Born}}$，这样做是有利的。\n$$\nC_{\\text{Born}} = N_{\\mathrm{A}} \\frac{(z e)^2}{8\\pi \\varepsilon_0} \\left( \\frac{1}{\\varepsilon} - 1 \\right)\n$$\n这个常数的单位是能量乘以长度除以摩尔，在国际单位制 (SI) 中为 $\\mathrm{J \\cdot m \\cdot mol^{-1}}$。于是，溶剂化自由能可以表示为简化形式：\n$$\n\\Delta G_{\\text{solv}}(r) = \\frac{C_{\\text{Born}}}{r}\n$$\n这表明，在 Born 模型中，溶剂化自由能与空腔半径 $r$ 成反比。这一关系是敏感性分析的核心。\n\n对于每个标称半径为 $r_0$（以埃为单位）的测试用例，计算步骤如下：\n1.  **定义常数**：所有物理常数（$N_{\\mathrm{A}}$、$e$、$\\varepsilon_0$）和模型参数（$z$、$\\varepsilon$）都以国际单位制 (SI) 单位定义。\n2.  **预计算 Born 常数**：使用所提供的值计算 $C_{\\text{Born}}$ 的值。此常数将用于所有后续计算。\n3.  **处理测试用例**：对于测试套件中的每个标称半径 $r_0$：\n    a. 使用转换因子 $1\\ \\text{Å} = 10^{-10}\\ \\mathrm{m}$ 将 $r_0$ 从埃转换为米。\n    b. 定义微扰半径：$r_{(-)} = 0.9 \\cdot r_0$ 和 $r_{(+)} = 1.1 \\cdot r_0$。\n    c. 使用公式 $\\Delta G_{\\text{solv}}(r_0) = C_{\\text{Born}} / r_0$ 计算标称溶剂化自由能 $\\Delta G_0$。结果以 $\\mathrm{J \\cdot mol^{-1}}$ 为单位，通过除以 $1000$ 转换为 $\\mathrm{kJ \\cdot mol^{-1}}$。\n    d. 计算微扰自由能 $\\Delta G_{(-)} = C_{\\text{Born}} / r_{(-)}$ 和 $\\Delta G_{(+)} = C_{\\text{Born}} / r_{(+)}$，并将其转换为 $\\mathrm{kJ \\cdot mol^{-1}}$。\n    e. 计算所需的绝对误差：$\\text{Err}_{(-)} = |\\Delta G_{(-)} - \\Delta G_0|$ 和 $\\text{Err}_{(+)} = |\\Delta G_{(+)} - \\Delta G_0|$。\n4.  **格式化输出**：为每个测试用例收集生成的三个浮点数（$\\Delta G_0$、$\\text{Err}_{(-)}$、$\\text{Err}_{(+)}$）。然后根据问题陈述的要求，将这些结果列表格式化为最终字符串。\n\n这个分步过程为求解提供了一条直接而严谨的路径。$\\Delta G_{\\text{solv}}$ 的负号表示离子在极性溶剂中的溶剂化过程是自发的。敏感性分析将表明，计算出的能量高度依赖于空腔半径的选择，这是连续介质模型的一个已知局限和关键参数。较小的半径导致更负（更有利）的溶剂化能，且如误差所示，变化的幅度是非线性的。半径 $-10\\%$ 变化所产生的误差大于 $+10\\%$ 变化所产生的误差，这与 $1/r$ 的依赖关系相符。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the sensitivity of the solvation free energy of Cl-\n    to the cavity radius in the Born model.\n    \"\"\"\n    # Define physical constants and parameters in SI units.\n    NA = 6.02214076e23  # Avogadro's number (mol^-1)\n    e = 1.602176634e-19  # Elementary charge (C)\n    eps0 = 8.8541878128e-12 # Vacuum permittivity (F m^-1 or C^2 J^-1 m^-1)\n    z = -1.0             # Charge number for Cl-\n    eps_r = 78.37        # Relative permittivity of water\n    \n    # Define the list of nominal cavity radii in ångströms.\n    test_cases_r0_angstrom = [1.60, 1.81, 2.00, 2.20]\n\n    # Pre-calculate the constant part of the Born equation.\n    # The result has units of J * m / mol.\n    born_constant = (NA * (z * e)**2 / (8 * np.pi * eps0)) * (1.0 / eps_r - 1.0)\n\n    def calculate_g_solv_kj_mol(r_angstrom):\n        \"\"\"\n        Calculates the solvation free energy in kJ/mol for a given radius in ångströms.\n        \"\"\"\n        if r_angstrom <= 0:\n            raise ValueError(\"Radius must be positive.\")\n        \n        # Convert radius from ångströms to meters.\n        r_meter = r_angstrom * 1.0e-10\n        \n        # Calculate solvation free energy in J/mol.\n        g_solv_j_mol = born_constant / r_meter\n        \n        # Convert to kJ/mol.\n        return g_solv_j_mol / 1000.0\n\n    # Store the results for all test cases.\n    all_results = []\n    \n    for r0_a in test_cases_r0_angstrom:\n        # Define the perturbed radii.\n        r_minus_a = 0.9 * r0_a\n        r_plus_a = 1.1 * r0_a\n\n        # Calculate the solvation free energies in kJ/mol.\n        g0 = calculate_g_solv_kj_mol(r0_a)\n        g_minus = calculate_g_solv_kj_mol(r_minus_a)\n        g_plus = calculate_g_solv_kj_mol(r_plus_a)\n\n        # Calculate the absolute errors.\n        err_minus = abs(g_minus - g0)\n        err_plus = abs(g_plus - g0)\n        \n        # Append the list of three required values.\n        all_results.append([g0, err_minus, err_plus])\n\n    # Format the final output string according to the specification.\n    # Each number is rounded to 2 decimal places.\n    formatted_sublists = []\n    for result_set in all_results:\n        g, err_m, err_p = result_set\n        formatted_sublists.append(f\"[{g:.2f},{err_m:.2f},{err_p:.2f}]\")\n\n    final_output_string = f\"[{','.join(formatted_sublists)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "2462575"}, {"introduction": "在掌握了离子溶剂化之后，我们转向更普遍的情况：中性但有极性的分子。本练习使用 Onsager 反应场模型来研究溶剂如何影响分子的旋转能垒，这是一个与反应速率直接相关的动力学性质。您将从基本物理原理出发推导所需公式，并应用它来观察溶剂对过渡态和基态的不同稳定作用 [@problem_id:2462555]。", "problem": "一个取代的联苯衍生物在气相中存在一个旋转势垒，该势垒分隔了一个平面构象的能量极小点和一个近乎正交的鞍点。在溶剂中，由于这两种结构具有不同的电偶极矩，并受到溶剂的差异化稳定作用，该势垒会发生变化。使用适用于高级模型（如可极化连续介质模型 PCM）的溶剂化连续介质图像，通过将一个大小为 $\\,\\mu\\,$ 的点偶极子放置在一个球形空腔的中心来近似每种结构的溶剂化，该空腔半径为 $\\,a\\,$，并嵌入在相对介电常数为 $\\,\\varepsilon_r\\,$ 的线性、各向同性介电介质中。仅从以下基本原理和经过充分检验的事实出发，推导您所需的表达式，并实现它们以预测溶剂对势垒的影响：\n- 偶极子 $\\,\\boldsymbol{\\mu}\\,$ 在电场 $\\,\\mathbf{E}\\,$ 中的静电能为 $\\,U = -\\boldsymbol{\\mu}\\cdot \\mathbf{E}\\,$。\n- 对于一个自洽极化问题，由极化介电质产生的反应场 $\\,\\mathbf{R}\\,$ 所带来的稳定化能由 $\\,U_{\\text{solv}} = -\\tfrac{1}{2}\\,\\boldsymbol{\\mu}\\cdot \\mathbf{R}\\,$ 给出。\n- 对于位于均匀介电质中球形空腔中心的点偶极子，其边值问题的解产生一个与 $\\,\\boldsymbol{\\mu}\\,$ 成正比、依赖于 $\\,\\varepsilon_r\\,$ 且按 $\\,a^{-3}\\,$ 衰减的反应场。\n- 相对介电常数 $\\,\\varepsilon_r\\,$ 通过 $\\,\\varepsilon = \\varepsilon_r \\varepsilon_0\\,$ 来缩放真空介电常数 $\\,\\varepsilon_0\\,$，并且库仑相互作用包含因子 $\\,1/(4\\pi \\varepsilon_0)\\,$。\n\n以此为基础，推导出每种状态（平面极小点和正交鞍点）的溶剂化自由能 $\\,\\Delta G_{\\text{solv}}(\\mu,a,\\varepsilon_r)\\,$ 关于 $\\,\\mu\\,$, $\\,a\\,$, $\\,\\varepsilon_r\\,$ 和物理常数的显式表达式，然后计算溶剂校正后的势垒\n$$\n\\Delta G^{\\ddagger}_{\\text{solv}} \\;=\\; \\Delta G^{\\ddagger}_{\\text{gas}} \\;+\\; \\big(\\Delta G_{\\text{solv}}^{\\text{TS}} - \\Delta G_{\\text{solv}}^{\\text{min}}\\big),\n$$\n其中 $\\,\\Delta G^{\\ddagger}_{\\text{gas}}\\,$ 是气相势垒，$\\,\\Delta G_{\\text{solv}}^{\\text{TS}}\\,$ 是过渡态（正交构象异构体）的溶剂化自由能，而 $\\,\\Delta G_{\\text{solv}}^{\\text{min}}\\,$ 是极小点（平面构象异构体）的溶剂化自由能。\n\n在国际单位制中使用以下物理常数：真空介电常数 $\\,\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}\\,$, 库仑常数 $\\,k_e = 1/(4\\pi\\varepsilon_0)\\,$, 阿伏伽德罗常数 $\\,N_A = 6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}\\,$, 德拜到国际单位制的转换 $\\,1\\,\\mathrm{D} = 3.33564\\times 10^{-30}\\,\\mathrm{C\\,m}\\,$, 以及埃到米的转换 $\\,1\\,\\text{\\AA} = 1.0\\times 10^{-10}\\,\\mathrm{m}\\,$.\n\n您的程序必须为以下测试套件计算溶剂校正后的势垒。每个测试用例是一个元组 $(\\Delta G^{\\ddagger}_{\\text{gas}}, \\mu_{\\text{min}}, \\mu_{\\text{TS}}, a, \\varepsilon_r)$，其中 $\\,\\Delta G^{\\ddagger}_{\\text{gas}}\\,$ 的单位是 $\\mathrm{kJ\\,mol^{-1}}$，$\\,\\mu_{\\text{min}}\\,$ 和 $\\,\\mu_{\\text{TS}}\\,$ 的单位是 $\\mathrm{D}$，$\\,a\\,$ 的单位是 $\\text{\\AA}$，$\\,\\varepsilon_r\\,$ 无量纲：\n- 测试 $\\,1\\,$ (真空基线): $(\\,8.000,\\, 2.000,\\, 2.000,\\, 4.500,\\, 1.000\\,)$.\n- 测试 $\\,2\\,$ (非极性溶剂，过渡态偶极矩更大): $(\\,9.000,\\, 1.500,\\, 3.000,\\, 4.500,\\, 2.380\\,)$.\n- 测试 $\\,3\\,$ (极性溶剂，几何结构与测试 $\\,2\\,$ 相同): $(\\,9.000,\\, 1.500,\\, 3.000,\\, 4.500,\\, 35.700\\,)$.\n- 测试 $\\,4\\,$ (水，极小点偶极矩更大): $(\\,12.000,\\, 5.000,\\, 2.500,\\, 5.000,\\, 78.400\\,)$.\n- 测试 $\\,5\\,$ (更大空腔，偶极矩相等): $(\\,7.500,\\, 4.000,\\, 4.000,\\, 6.000,\\, 35.700\\,)$.\n\n实现要求：\n- 对于每个测试用例，从您推导的表达式计算 $\\,\\Delta G_{\\text{solv}}^{\\text{min}}\\,$ 和 $\\,\\Delta G_{\\text{solv}}^{\\text{TS}}\\,$, 然后报告 $\\,\\Delta G^{\\ddagger}_{\\text{solv}}\\,$，单位为 $\\mathrm{kJ\\,mol^{-1}}$。\n- 最终数值答案以 $\\mathrm{kJ\\,mol^{-1}}$ 表示，并四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表（例如，$[\\text{result1},\\text{result2},\\text{result3}]$），顺序与测试用例相同。", "solution": "经过严格评估，该问题陈述是有效的。它具有科学依据，问题设定良好且自成体系。该问题描述了 Onsager 反应场模型，这是计算化学中用于估算介电连续溶剂对溶质性质影响的一种标准近似方法。所提供的物理原理、常数和数据是一致且物理上现实的，从而可以得出一个严谨且明确的解。\n\n目标是推导 Onsager 模型中溶剂化自由能的静电分量表达式 $\\Delta G_{\\text{solv}}$，并用它来计算几个测试案例的溶剂校正旋转势垒 $\\Delta G^{\\ddagger}_{\\text{solv}}$。总势垒由下式给出：\n$$\n\\Delta G^{\\ddagger}_{\\text{solv}} = \\Delta G^{\\ddagger}_{\\text{gas}} + (\\Delta G_{\\text{solv}}^{\\text{TS}} - \\Delta G_{\\text{solv}}^{\\text{min}})\n$$\n其中 $\\Delta G^{\\ddagger}_{\\text{gas}}$ 是气相势垒，$\\Delta G_{\\text{solv}}^{\\text{TS}}$ 和 $\\Delta G_{\\text{solv}}^{\\text{min}}$ 分别是过渡态和能量极小点构象异构体的溶剂化自由能。\n\n我们从所提供的原理开始推导。在此连续介质模型中，对溶剂化自由能的静电贡献近似为极化介电质所做的功，其由 $U_{\\text{solv}} = -\\tfrac{1}{2}\\,\\boldsymbol{\\mu}\\cdot \\mathbf{R}$ 给出。我们假设 $\\Delta G_{\\text{solv}} \\approx U_{\\text{solv}}$。这里，$\\boldsymbol{\\mu}$ 是溶质的永久偶极矩，$\\mathbf{R}$ 是它在周围介电介质中感应出的反应场。\n\n问题指定了一个点偶极子 $\\boldsymbol{\\mu}$ 位于半径为 $a$ 的球形空腔中心，该空腔嵌入在相对介电常数为 $\\varepsilon_r$ 的介质中。对于此配置，静电边值问题的解在空腔内部产生一个与 $\\boldsymbol{\\mu}$ 平行的均匀反应场 $\\mathbf{R}$。该场由著名的 Onsager 反应场公式给出：\n$$\n\\mathbf{R} = \\frac{1}{4\\pi\\varepsilon_0} \\frac{2(\\varepsilon_r - 1)}{2\\varepsilon_r + 1} \\frac{\\boldsymbol{\\mu}}{a^3}\n$$\n该表达式与问题提示中 $\\mathbf{R}$ 与 $\\boldsymbol{\\mu}$ 成正比、依赖于 $\\varepsilon_r$ 并包含因子 $1/(4\\pi\\varepsilon_0)$ 和 $a^{-3}$ 的说法一致。\n\n将此 $\\mathbf{R}$ 的表达式代入能量公式，我们得到单个分子的溶剂化自由能。由于 $\\mathbf{R}$ 和 $\\boldsymbol{\\mu}$ 平行，它们的点积变为其大小的乘积，即 $\\mu^2$：\n$$\n\\Delta G_{\\text{solv}} = -\\frac{1}{2} \\boldsymbol{\\mu} \\cdot \\left( \\frac{1}{4\\pi\\varepsilon_0} \\frac{2(\\varepsilon_r - 1)}{2\\varepsilon_r + 1} \\frac{\\boldsymbol{\\mu}}{a^3} \\right) = - \\frac{1}{4\\pi\\varepsilon_0} \\frac{(\\varepsilon_r - 1)}{2\\varepsilon_r + 1} \\frac{\\mu^2}{a^3}\n$$\n问题要求结果以摩尔能量单位（如 $\\mathrm{kJ\\,mol^{-1}}$）表示。因此，我们乘以阿伏伽德罗常数 $N_A$ 以获得摩尔溶剂化自由能：\n$$\n\\Delta G_{\\text{solv, molar}}(\\mu, a, \\varepsilon_r) = - N_A \\frac{1}{4\\pi\\varepsilon_0} \\frac{(\\varepsilon_r - 1)}{2\\varepsilon_r + 1} \\frac{\\mu^2}{a^3}\n$$\n项 $\\frac{1}{4\\pi\\varepsilon_0}$ 是库仑常数 $k_e$。势垒变化量 $\\Delta G_{\\text{solv}}^{\\text{TS}} - \\Delta G_{\\text{solv}}^{\\text{min}}$ 的表达式现在可以明确写出。由于假设空腔半径 $a$ 和溶剂 $\\varepsilon_r$ 对于极小点和过渡态是相同的，我们得到：\n$$\n\\Delta G_{\\text{solv}}^{\\text{TS}} - \\Delta G_{\\text{solv}}^{\\text{min}} = - N_A k_e \\left( \\frac{\\varepsilon_r - 1}{2\\varepsilon_r + 1} \\right) \\frac{1}{a^3} \\left( \\mu_{\\text{TS}}^2 - \\mu_{\\text{min}}^2 \\right)\n$$\n该表达式给出了由于两种构象异构体的差异化溶剂化而对旋转势垒的校正。校正的符号取决于极小点或过渡态是否具有更大的偶极矩。如果 $\\mu_{\\text{TS}} > \\mu_{\\text{min}}$，过渡态被溶剂更强地稳定，势垒降低。反之，如果 $\\mu_{\\text{min}} > \\mu_{\\text{TS}}$，极小点被更强地稳定，势垒升高。如果 $\\mu_{\\text{min}} = \\mu_{\\text{TS}}$ 或者 $\\varepsilon_r = 1$（真空），对势垒的溶剂化校正为零。\n\n为了进行计算，所有输入参数必须转换为国际单位制（SI）基本单位：偶极矩 $(\\mu)$ 从德拜 $(\\mathrm{D})$ 转换为库仑-米 $(\\mathrm{C\\,m})$，空腔半径 $(a)$ 从埃 $(\\text{\\AA})$ 转换为米 $(\\mathrm{m})$。计算出的能量差将以 $\\mathrm{J\\,mol^{-1}}$ 为单位，并且必须转换为 $\\mathrm{kJ\\,mol^{-1}}$，然后才能加到以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位提供的气相势垒 $\\Delta G^{\\ddagger}_{\\text{gas}}$ 上。最终结果 $\\Delta G^{\\ddagger}_{\\text{solv}}$ 将以所要求的单位 $\\mathrm{kJ\\,mol^{-1}}$ 表示。实现部分将使用提供的物理常数，系统地将此推导出的公式应用于每个测试用例。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the solvent-corrected rotational barrier for a biphenyl derivative\n    using the Onsager reaction field model.\n    \"\"\"\n\n    # --- Physical Constants (SI units) ---\n    # Vacuum permittivity in F/m\n    EPSILON_0 = 8.8541878128e-12\n    # Avogadro's number in mol^-1\n    N_A = 6.02214076e23\n    # Coulomb constant k_e = 1 / (4*pi*eps0) in N m^2 C^-2\n    K_E = 1 / (4 * np.pi * EPSILON_0)\n\n    # --- Unit Conversion Factors ---\n    # 1 Debye to C*m\n    D_TO_SI = 3.33564e-30\n    # 1 Angstrom to m\n    A_TO_M = 1.0e-10\n\n    # --- Test Cases ---\n    # Each case: (dG_gas [kJ/mol], mu_min [D], mu_ts [D], a [Å], eps_r)\n    test_cases = [\n        (8.000, 2.000, 2.000, 4.500, 1.000),    # Test 1\n        (9.000, 1.500, 3.000, 4.500, 2.380),    # Test 2\n        (9.000, 1.500, 3.000, 4.500, 35.700),   # Test 3\n        (12.000, 5.000, 2.500, 5.000, 78.400),  # Test 4\n        (7.500, 4.000, 4.000, 6.000, 35.700),   # Test 5\n    ]\n\n    results = []\n    for case in test_cases:\n        dG_gas, mu_min_D, mu_ts_D, a_A, eps_r = case\n\n        # The change in solvation energy is zero if eps_r is 1 (vacuum)\n        # or if the dipole moments of the two states are identical.\n        if eps_r == 1.0 or mu_min_D == mu_ts_D:\n            dG_solv_barrier = dG_gas\n            results.append(f\"{dG_solv_barrier:.3f}\")\n            continue\n\n        # Convert inputs to SI units\n        mu_min_SI = mu_min_D * D_TO_SI\n        mu_ts_SI = mu_ts_D * D_TO_SI\n        a_SI = a_A * A_TO_M\n\n        # Calculate the dielectric factor from the Onsager model\n        dielectric_factor = (eps_r - 1) / (2 * eps_r + 1)\n\n        # Calculate the molar solvation energies for min and TS in J/mol\n        # Formula: dG_solv = -N_A * k_e * dielectric_factor * mu^2 / a^3\n        \n        # Calculate the difference in solvation energy between TS and min\n        # dG(solv, TS) - dG(solv, min)\n        # = -N_A*k_e*f_eps/a^3 * (mu_ts^2 - mu_min^2)\n        \n        # Group constants to avoid re-calculation\n        # The equation for the change in the barrier due to solvation is:\n        # delta_delta_G = - (N_A * K_E * dielectric_factor / a_SI**3) * (mu_ts_SI**2 - mu_min_SI**2)\n\n        mu_min_sq_SI = mu_min_SI**2\n        mu_ts_sq_SI = mu_ts_SI**2\n\n        prefactor = -N_A * K_E * dielectric_factor / (a_SI**3)\n        delta_delta_G_J_per_mol = prefactor * (mu_ts_sq_SI - mu_min_sq_SI)\n\n        # Convert the energy difference from J/mol to kJ/mol\n        delta_delta_G_kJ_per_mol = delta_delta_G_J_per_mol / 1000.0\n\n        # Calculate the final solvent-corrected barrier\n        dG_solv_barrier = dG_gas + delta_delta_G_kJ_per_mol\n\n        # Append the formatted result\n        results.append(f\"{dG_solv_barrier:.3f}\")\n\n    # Print the final output in the specified format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2462555"}, {"introduction": "最后，我们将把连续介质模型的应用推向一个经典的化学平衡问题：酮-烯醇互变异构。通过这个练习，您将使用 Onsager 模型来量化不同极性溶剂对酮式和烯醇式异构体相对稳定性的影响。这个实践将溶剂化自由能的计算与可测量的化学结果（如平衡常数 $K$ 和摩尔分数 $x$）直接联系起来，展示了如何利用计算模型来预测和理解溶剂对化学反应的调控作用 [@problem_id:2462628]。", "problem": "我们使用一种偶极-溶剂化模型来分析溶剂极性对乙酰丙酮的酮-烯醇互变异构平衡的影响。酮式和烯醇式互变异构体被建模为点偶极子，位于嵌入均匀、各向同性、线性介电连续体中的球形空腔的中心。在相对介电常数为 $\\,\\varepsilon\\,$ 的介质中，位于半径为 $\\,a\\,$（单位为米）的球形空腔中心的偶极矩大小为 $\\,\\mu\\,$（单位为库仑·米）的偶极子的静电溶剂化自由能由下式给出\n$$\n\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu,a) = -\\,\\frac{N_{\\mathrm{A}}\\,\\mu^2}{8\\pi \\varepsilon_0\\,a^3}\\,\\frac{\\varepsilon-1}{2\\varepsilon+1},\n$$\n其中 $\\,\\varepsilon_0\\,$ 是真空介电常数，$\\,N_{\\mathrm{A}}\\,$ 是阿伏伽德罗常数。在温度 $\\,T\\,$ 下，互变异构体之间的气相标准自由能差定义为 $\\,\\Delta G_{\\mathrm{gas}} = G_{\\mathrm{keto}} - G_{\\mathrm{enol}}\\,$。在介电常数为 $\\,\\varepsilon\\,$ 的溶剂中，标准自由能差变为\n$$\n\\Delta G_{\\mathrm{tot}}(\\varepsilon) = \\Delta G_{\\mathrm{gas}} + \\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{k}},a_{\\mathrm{k}}) - \\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{e}},a_{\\mathrm{e}}),\n$$\n其中 $\\,\\mu_{\\mathrm{k}}\\,$ 和 $\\,a_{\\mathrm{k}}\\,$ 分别是酮式互变异构体的偶极矩和空腔半径，$\\,\\mu_{\\mathrm{e}}\\,$ 和 $\\,a_{\\mathrm{e}}\\,$ 分别是烯醇式互变异构体的偶极矩和空腔半径。酮式相对于烯醇式的平衡常数为\n$$\nK(\\varepsilon) = \\exp\\!\\left(-\\frac{\\Delta G_{\\mathrm{tot}}(\\varepsilon)}{R\\,T}\\right),\n$$\n其中 $\\,R\\,$ 是理想气体常数。平衡时烯醇式互变异构体的摩尔分数则为\n$$\nx_{\\mathrm{enol}}(\\varepsilon) = \\frac{1}{1 + K(\\varepsilon)}.\n$$\n\n在温度 $\\,T = 298.15\\,$ K 时，对乙酰丙酮使用以下基于物理的参数：\n- 气相自由能差：$\\,\\Delta G_{\\mathrm{gas}} = 12000\\,$ J/mol。\n- 酮式互变异构体偶极矩：$\\,\\mu_{\\mathrm{k}} = 4.0\\,$ 德拜。\n- 烯醇式互变异构体偶极矩：$\\,\\mu_{\\mathrm{e}} = 1.7\\,$ 德拜。\n- 酮式互变异构体空腔半径：$\\,a_{\\mathrm{k}} = 3.0\\,$ 埃。\n- 烯醇式互变异构体空腔半径：$\\,a_{\\mathrm{e}} = 3.3\\,$ 埃。\n\n使用以下常数：\n- 真空介电常数：$\\,\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\,$ F/m。\n- 阿伏伽德罗常数：$\\,N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\,$ mol$^{-1}$。\n- 理想气体常数：$\\,R = 8.31446261815324\\,$ J/(mol·K)。\n\n所需单位换算：\n- $\\,1\\,$ 德拜 $= 3.33564\\times 10^{-30}\\,$ C·m。\n- $\\,1\\,$ 埃 $= 1.0\\times 10^{-10}\\,$ m。\n\n任务：对于测试集中的每个相对介电常数 $\\,\\varepsilon\\,$\n$$\n[\\;1.0,\\;2.0,\\;10.0,\\;78.4,\\;200.0\\;],\n$$\n计算烯醇的摩尔分数 $\\,x_{\\mathrm{enol}}(\\varepsilon)\\,$，结果为无量纲的小数。将每个结果四舍五入到恰好六位小数。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表用方括号括起来（例如，$[\\mathrm{r}_1,\\mathrm{r}_2,\\dots]$）。输出必须是一个包含五个浮点数的列表，按顺序对应于上面给出的测试介电常数。", "solution": "我们的目标是利用连续介质静电学模型，确定溶剂极性（由相对介电常数 $\\,\\varepsilon\\,$ 量化）如何影响乙酰丙酮的酮-烯醇平衡。该框架是 Onsager 反应场模型，它为嵌入在介电常数为 $\\,\\varepsilon\\,$ 的介电介质中、半径为 $\\,a\\,$ 的球形空腔中心的偶极子 $\\,\\mu\\,$ 提供了静电溶剂化自由能 $\\,\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu,a)\\,$：\n$$\n\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu,a) = -\\,\\frac{N_{\\mathrm{A}}\\,\\mu^2}{8\\pi \\varepsilon_0\\,a^3}\\,\\frac{\\varepsilon-1}{2\\varepsilon+1}.\n$$\n该表达式源于经典静电学，通过计算极化介质所做的功，并通过阿伏伽德罗常数 $\\,N_{\\mathrm{A}}\\,$ 将单分子能量转换为摩尔单位得到。溶剂化有利于较大的偶极矩和较小的空腔半径，其稳定作用通过因子 $\\,(\\varepsilon-1)/(2\\varepsilon+1)\\,$ 随 $\\,\\varepsilon\\,$ 单调增加，该因子在 $\\,\\varepsilon=1\\,$ 时为零，并在 $\\,\\varepsilon\\to\\infty\\,$ 时趋近于 $\\,1/2\\,$。\n\n在溶剂中，酮式和烯醇式之间的总标准自由能差为\n$$\n\\Delta G_{\\mathrm{tot}}(\\varepsilon) = \\Delta G_{\\mathrm{gas}} + \\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{k}},a_{\\mathrm{k}}) - \\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{e}},a_{\\mathrm{e}}),\n$$\n其中 $\\,\\Delta G_{\\mathrm{gas}} = G_{\\mathrm{keto}} - G_{\\mathrm{enol}}\\,$ 是在 $\\,T=298.15\\,$ K 下给出的。$\\,\\Delta G_{\\mathrm{tot}}\\,$ 为正值意味着在该特定溶剂中，酮式互变异构体比烯醇式互变异构体更不稳定。酮式相对于烯醇式的平衡常数是标准的热力学关系\n$$\nK(\\varepsilon) = \\exp\\!\\left(-\\frac{\\Delta G_{\\mathrm{tot}}(\\varepsilon)}{R\\,T}\\right),\n$$\n烯醇的摩尔分数为\n$$\nx_{\\mathrm{enol}}(\\varepsilon) = \\frac{1}{1+K(\\varepsilon)}.\n$$\n\n所有量都必须使用一致的国际单位制 (SI)。因此，将给定的偶极矩和半径转换为\n$$\n\\mu_{\\mathrm{k}} = 4.0 \\times (3.33564\\times 10^{-30})\\;\\mathrm{C\\cdot m},\\quad\n\\mu_{\\mathrm{e}} = 1.7 \\times (3.33564\\times 10^{-30})\\;\\mathrm{C\\cdot m},\n$$\n$$\na_{\\mathrm{k}} = 3.0 \\times 10^{-10}\\;\\mathrm{m},\\quad\na_{\\mathrm{e}} = 3.3 \\times 10^{-10}\\;\\mathrm{m}.\n$$\n使用以下常数\n$$\n\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\;\\mathrm{F/m},\\quad\nN_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\;\\mathrm{mol^{-1}},\\quad\nR = 8.31446261815324\\;\\mathrm{J/(mol\\cdot K)},\\quad\nT = 298.15\\;\\mathrm{K}.\n$$\n\n对于测试集 $[\\,1.0,\\,2.0,\\,10.0,\\,78.4,\\,200.0\\,]$ 中的每个 $\\,\\varepsilon\\,$，以国际单位制 (SI) 单位执行以下计算：\n1. 使用上述表达式计算 $\\,\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{k}},a_{\\mathrm{k}})\\,$ 和 $\\,\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{e}},a_{\\mathrm{e}})\\,$。\n2. 通过将酮式和烯醇式溶剂化自由能之差加到 $\\,\\Delta G_{\\mathrm{gas}}=12000\\,$ J/mol 上，来构成 $\\,\\Delta G_{\\mathrm{tot}}(\\varepsilon)\\,$。\n3. 计算 $\\,K(\\varepsilon) = \\exp\\!\\left(-\\Delta G_{\\mathrm{tot}}(\\varepsilon)/(R T)\\right)\\,$。\n4. 计算 $\\,x_{\\mathrm{enol}}(\\varepsilon) = 1/(1+K(\\varepsilon))\\,$，这是一个无量纲的小数。\n\n与模型一致的定性预期：\n- 在 $\\,\\varepsilon=1\\,$ 时（无溶剂极化），两种互变异构体的 $\\,\\Delta G_{\\mathrm{solv}}=0\\,$，因此 $\\,\\Delta G_{\\mathrm{tot}}=\\Delta G_{\\mathrm{gas}}\\,$。由于 $\\,\\Delta G_{\\mathrm{gas}} > 0\\,$ 有利于烯醇式互变异构体，因此 $\\,x_{\\mathrm{enol}}\\,$ 接近于 $\\,1\\,$。\n- 随着 $\\,\\varepsilon\\,$ 的增加，由于酮式互变异构体具有较大的偶极矩和稍小的空腔半径，其溶剂化稳定作用更强，因此 $\\,\\Delta G_{\\mathrm{tot}}(\\varepsilon)\\,$ 会减小，而 $\\,x_{\\mathrm{enol}}(\\varepsilon)\\,$ 会单调减小。\n- 对于较大的 $\\,\\varepsilon\\,$，因子 $\\,(\\varepsilon-1)/(2\\varepsilon+1)\\,$ 会饱和到 $\\,1/2\\,$，因此在该模型中，溶剂引起的位移存在一个有限的极限。\n\n程序实现了这些原理，执行了单位一致的计算，评估了指定 $\\,\\varepsilon\\,$ 值下的 $\\,x_{\\mathrm{enol}}(\\varepsilon)\\,$，将每个结果四舍五入到恰好六位小数，并以要求的格式输出单行列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef onsager_solvation_energy(mu_debye, a_angstrom, eps_r):\n    \"\"\"\n    Compute electrostatic solvation free energy (J/mol) via the Onsager reaction field model:\n    ΔG_solv(ε; μ, a) = - N_A * μ^2 / (8π ε0 a^3) * ( (ε - 1) / (2 ε + 1) )\n    Inputs:\n        mu_debye: dipole moment in Debye\n        a_angstrom: cavity radius in Ångström\n        eps_r: relative permittivity (dimensionless)\n    Returns:\n        ΔG_solv in J/mol (float)\n    \"\"\"\n    # Constants (SI)\n    eps0 = 8.8541878128e-12  # F/m\n    NA = 6.02214076e23       # 1/mol\n    # Unit conversions\n    mu = mu_debye * 3.33564e-30     # C·m\n    a = a_angstrom * 1.0e-10        # m\n    # Onsager factor\n    reaction_factor = (eps_r - 1.0) / (2.0 * eps_r + 1.0)\n    # Energy\n    dG = - NA * (mu**2) / (8.0 * np.pi * eps0 * (a**3)) * reaction_factor\n    return dG\n\ndef enol_fraction(eps_r, params):\n    \"\"\"\n    Compute enol mole fraction for a given relative permittivity.\n    params: dict with keys ΔG_gas (J/mol), mu_k (D), a_k (Å), mu_e (D), a_e (Å), T (K), R (J/mol/K)\n    \"\"\"\n    dG_gas = params[\"dG_gas\"]\n    mu_k = params[\"mu_k\"]\n    a_k = params[\"a_k\"]\n    mu_e = params[\"mu_e\"]\n    a_e = params[\"a_e\"]\n    T = params[\"T\"]\n    R = params[\"R\"]\n\n    dG_solv_k = onsager_solvation_energy(mu_k, a_k, eps_r)\n    dG_solv_e = onsager_solvation_energy(mu_e, a_e, eps_r)\n    dG_tot = dG_gas + dG_solv_k - dG_solv_e\n    K = np.exp(-dG_tot / (R * T))\n    x_enol = 1.0 / (1.0 + K)\n    return x_enol\n\ndef solve():\n    # Define the test cases from the problem statement (relative permittivities).\n    test_eps = [1.0, 2.0, 10.0, 78.4, 200.0]\n\n    # Physical parameters\n    params = {\n        \"dG_gas\": 12000.0,              # J/mol (G_keto - G_enol)\n        \"mu_k\": 4.0,                    # Debye\n        \"a_k\": 3.0,                     # Å\n        \"mu_e\": 1.7,                    # Debye\n        \"a_e\": 3.3,                     # Å\n        \"T\": 298.15,                    # K\n        \"R\": 8.31446261815324           # J/(mol·K)\n    }\n\n    results = []\n    for eps_r in test_eps:\n        x = enol_fraction(eps_r, params)\n        # Round to exactly six decimal places\n        x_str = f\"{x:.6f}\"\n        results.append(x_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2462628"}]}