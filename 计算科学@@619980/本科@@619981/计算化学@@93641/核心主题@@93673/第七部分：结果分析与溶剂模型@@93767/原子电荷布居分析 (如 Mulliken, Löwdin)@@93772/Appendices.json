{"hands_on_practices": [{"introduction": "要真正掌握原子电荷的布居分析，理解其背后的数学原理至关重要。本次实践将引导你从第一性原理出发，为一个简单的双原子分子推导Mulliken电荷的表达式。通过这个符号代数练习[@problem_id:2449473]，你将清晰地看到电子密度是如何根据Mulliken方案进行划分的，从而超越“黑箱”式的定义，巩固对核心概念的理解。", "problem": "考虑一个双原子分子$A\\!-\\!B$，它在一个由2个实、归一化但非正交的基函数$\\,\\phi_{A}\\,$和$\\,\\phi_{B}\\,$组成的最小原子轨道基组中表示，这两个基函数分别以原子核$A$和$B$为中心。设重叠积分为$S_{AA}=S_{BB}=1$和$S_{AB}=S_{BA}$，其中$0<S_{AB}<1$。在此基组中，单粒子密度矩阵为$P$。对于自旋限制的闭壳层描述，该矩阵是实对称的，其矩阵元为$P_{AA}$、$P_{BB}$和$P_{AB}=P_{BA}$。设核电荷为$Z_{A}$和$Z_{B}$。\n\n使用非正交基Mulliken布居分析的基本定义，推导Mulliken原子电荷$q_{A}$和$q_{B}$的闭式符号表达式，用$Z_{A}$、$Z_{B}$、$P_{AA}$、$P_{BB}$、$P_{AB}$和$S_{AB}$表示。将你的最终结果表示为有序对$(q_{A},q_{B})$。\n\n你的最终答案必须是单一的闭式解析表达式。不需要数值四舍五入，也不需要报告单位。", "solution": "该问题陈述经过验证，具有科学依据、阐述清晰且客观。它提出了一个计算化学理论中的标准练习。\n\nMulliken原子电荷的推导始于非正交基中单粒子密度矩阵$P$、重叠矩阵$S$与总电子数$N$之间的基本关系。总电子布居数由密度矩阵和重叠矩阵乘积的迹给出：\n$$ N = \\mathrm{Tr}(PS) = \\sum_{\\mu, \\nu} P_{\\mu \\nu} S_{\\nu \\mu} $$\n在给定的由两个原子轨道$\\phi_{A}$和$\\phi_{B}$组成的最小基组中，密度矩阵$P$和重叠矩阵$S$是$2 \\times 2$的矩阵。问题陈述指出$P$是实对称的，且基函数是归一化的。矩阵明确表示为：\n$$ P = \\begin{pmatrix} P_{AA} & P_{AB} \\\\ P_{BA} & P_{BB} \\end{pmatrix} = \\begin{pmatrix} P_{AA} & P_{AB} \\\\ P_{AB} & P_{BB} \\end{pmatrix} $$\n$$ S = \\begin{pmatrix} S_{AA} & S_{AB} \\\\ S_{BA} & S_{BB} \\end{pmatrix} = \\begin{pmatrix} 1 & S_{AB} \\\\ S_{AB} & 1 \\end{pmatrix} $$\n总电子数$N$可以通过展开求和来计算：\n$$ N = \\sum_{\\mu, \\nu=\\{A,B\\}} P_{\\mu \\nu} S_{\\nu \\mu} = P_{AA}S_{AA} + P_{AB}S_{BA} + P_{BA}S_{AB} + P_{BB}S_{BB} $$\n代入给定值$S_{AA}=S_{BB}=1$以及对称性$P_{BA}=P_{AB}$和$S_{BA}=S_{AB}$：\n$$ N = P_{AA}(1) + P_{AB}S_{AB} + P_{AB}S_{AB} + P_{BB}(1) = P_{AA} + P_{BB} + 2P_{AB}S_{AB} $$\nMulliken布居分析将总电子布居数$N$分配到各个组成原子上。原子$k$上的总电子布居数$N_k$定义为中心在该原子上的所有原子轨道$\\phi_{\\mu}$的布居数之和。形式上，这等价于对布居矩阵$PS$中与以原子$k$为中心的基函数相对应的行中的元素求和：\n$$ N_k = \\sum_{\\mu \\in k} \\sum_{\\nu} P_{\\mu \\nu} S_{\\nu \\mu} $$\n对于最小基组中的双原子分子$A-B$，原子$A$只与基函数$\\phi_A$相关联，因此求和$\\sum_{\\mu \\in A}$只包含$\\mu = A$这一项。原子$A$上的总电子布居数，记为$N_A$，为：\n$$ N_A = \\sum_{\\nu=\\{A,B\\}} P_{A \\nu} S_{\\nu A} = P_{AA}S_{AA} + P_{AB}S_{BA} $$\n代入已知值$S_{AA}=1$和$S_{BA}=S_{AB}$：\n$$ N_A = P_{AA}(1) + P_{AB}S_{AB} = P_{AA} + P_{AB}S_{AB} $$\n同理，对于只与$\\phi_B$相关联的原子$B$，其总电子布居数$N_B$为：\n$$ N_B = \\sum_{\\nu=\\{A,B\\}} P_{B \\nu} S_{\\nu B} = P_{BA}S_{AB} + P_{BB}S_{BB} $$\n代入已知值$P_{BA}=P_{AB}$和$S_{BB}=1$：\n$$ N_B = P_{AB}S_{AB} + P_{BB}(1) = P_{BB} + P_{AB}S_{AB} $$\n作为一致性检验，原子总布居数之和必须恢复为总电子数：\n$$ N_A + N_B = (P_{AA} + P_{AB}S_{AB}) + (P_{BB} + P_{AB}S_{AB}) = P_{AA} + P_{BB} + 2P_{AB}S_{AB} = N $$\n该划分是一致的。原子$k$上的Mulliken原子电荷$q_k$定义为其核电荷$Z_k$与其总电子布居数$N_k$之差：\n$$ q_k = Z_k - N_k $$\n将此定义应用于原子$A$：\n$$ q_A = Z_A - N_A = Z_A - (P_{AA} + P_{AB}S_{AB}) $$\n$$ q_A = Z_A - P_{AA} - P_{AB}S_{AB} $$\n对于原子$B$：\n$$ q_B = Z_B - N_B = Z_B - (P_{BB} + P_{AB}S_{AB}) $$\n$$ q_B = Z_B - P_{BB} - P_{AB}S_{AB} $$\n这些就是Mulliken原子电荷的闭式表达式。最终答案为有序对$(q_A, q_B)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} Z_A - P_{AA} - P_{AB}S_{AB} & Z_B - P_{BB} - P_{AB}S_{AB} \\end{pmatrix}}\n$$", "id": "2449473"}, {"introduction": "在掌握了Mulliken方案后，探索其替代方法，特别是那些能够克服其某些缺陷的方案，对于进行全面的布居分析至关重要。本次实践将介绍Löwdin布居分析，它通过对原子轨道基组进行对称正交化来提供一种更稳健的电荷划分方案。这个数值计算练习[@problem_id:2449509]将指导你完成Löwdin变换的具体步骤，让你能清晰地体会到它与Mulliken方法的不同之处。", "problem": "考虑一个具有两个电子的异核双原子阳离子，在由两个以原子为中心的原子轨道（AO），即 $\\{\\chi_{A}, \\chi_{B}\\}$（每个原子上一个）组成的最小基组中进行描述。这两个原子分别标记为 $A$ 和 $B$，其核电荷分别为 $Z_{A}$ 和 $Z_{B}$。自旋求和的单粒子密度由单个双占据分子轨道（MO）构建。原子轨道（AO）的重叠矩阵为\n$$\nS \\;=\\; \\begin{pmatrix}\n1 & 0.2 \\\\\n0.2 & 1\n\\end{pmatrix}.\n$$\n设占据分子轨道（MO）的未归一化 AO 系数向量为\n$$\nv \\;=\\; \\begin{pmatrix} 0.9 \\\\ 0.3 \\end{pmatrix},\n$$\n并设 $c \\,=\\, k\\,v$ 为满足 $c^{\\mathsf T} S\\, c \\,=\\, 1$ 的归一化 AO 系数向量，其中 $k$ 是一个待定的标量。那么自旋求和的 AO 密度矩阵为 $P \\,=\\, 2\\, c\\, c^{\\mathsf T}$。\n\n使用对称正交化（Löwdin）方案，正交化变换由矩阵 $S^{-1/2}$ 定义，其中 $S^{\\pm 1/2}$ 表示正定矩阵的平方根及其逆矩阵。Löwdin 总原子布居数是 $S^{1/2} P S^{1/2}$ 的对角元素，即，对于与 AO 顺序一致的原子标记，\n$$\n\\text{GP}_{A} \\,=\\, \\big(S^{1/2} P S^{1/2}\\big)_{11}, \\qquad\n\\text{GP}_{B} \\,=\\, \\big(S^{1/2} P S^{1/2}\\big)_{22}.\n$$\nLöwdin 原子电荷定义为\n$$\nq_{A} \\,=\\, Z_{A} \\;-\\; \\text{GP}_{A}, \\qquad\nq_{B} \\,=\\, Z_{B} \\;-\\; \\text{GP}_{B}.\n$$\n\n对于一个特定体系，取 $Z_{A} \\,=\\, 2$和 $Z_{B} \\,=\\, 1$（因此在基组中有两个电子时，总电荷为 $+1$）。首先从 $S$ 计算 $S^{-1/2}$，然后得到 $S^{1/2}$，并根据上述定义，计算 Löwdin 原子电荷 $q_{A}$ 和 $q_{B}$。将您的最终答案以单行矩阵 $\\big(q_{A}\\;\\; q_{B}\\big)$ 的形式给出，并将结果四舍五入到四位有效数字。不需要单位。", "solution": "问题陈述构成了计算量子化学中一个良构的练习，具体涉及 Löwdin 布居分析。所有提供的数据和定义在科学上都是合理的、一致的，并且足以推导出唯一的解。因此，我将开始计算。\n\n目标是计算一个双电子异核双原子阳离子的 Löwdin 原子电荷 $q_{A}$ 和 $q_{B}$。提供的定义如下：\n$$q_{A} = Z_{A} - \\text{GP}_{A}$$\n$$q_{B} = Z_{B} - \\text{GP}_{B}$$\n其中 $Z_{A} = 2$ 和 $Z_{B} = 1$是核电荷，$\\text{GP}_{A}$ 和 $\\text{GP}_{B}$ 是 Löwdin 总原子布居数。布居数是经过 Löwdin 变换的密度矩阵 $P' = S^{1/2} P S^{1/2}$ 的对角元素。\n\n计算按以下系统步骤进行。\n\n首先，必须对未归一化的分子轨道（MO）系数向量 $v$ 进行归一化。归一化条件为 $c^{\\mathsf T} S c = 1$，其中 $c = k v$ 是归一化的系数向量，$S$ 是原子轨道（AO）重叠矩阵。\n给定 $v = \\begin{pmatrix} 0.9 \\\\ 0.3 \\end{pmatrix}$ 和 $S = \\begin{pmatrix} 1 & 0.2 \\\\ 0.2 & 1 \\end{pmatrix}$，我们计算归一化因子 $k$。\n标量积为：\n$$v^{\\mathsf T} S v = \\begin{pmatrix} 0.9 & 0.3 \\end{pmatrix} \\begin{pmatrix} 1 & 0.2 \\\\ 0.2 & 1 \\end{pmatrix} \\begin{pmatrix} 0.9 \\\\ 0.3 \\end{pmatrix} = \\begin{pmatrix} 0.9 & 0.3 \\end{pmatrix} \\begin{pmatrix} 1 \\cdot 0.9 + 0.2 \\cdot 0.3 \\\\ 0.2 \\cdot 0.9 + 1 \\cdot 0.3 \\end{pmatrix} = \\begin{pmatrix} 0.9 & 0.3 \\end{pmatrix} \\begin{pmatrix} 0.96 \\\\ 0.48 \\end{pmatrix}$$\n$$v^{\\mathsf T} S v = 0.9 \\cdot 0.96 + 0.3 \\cdot 0.48 = 0.864 + 0.144 = 1.008$$\n归一化常数 $k$ 由 $k = (v^{\\mathsf T} S v)^{-1/2} = (1.008)^{-1/2}$ 给出。\n归一化的 MO 系数向量为 $c = (1.008)^{-1/2} v$。\n\n第二，我们构建自旋求和的 AO 密度矩阵 $P$。对于单个双占据 MO，$P = 2 c c^{\\mathsf T}$。\n$$P = 2 \\left( (1.008)^{-1/2} v \\right) \\left( (1.008)^{-1/2} v^{\\mathsf T} \\right) = \\frac{2}{1.008} v v^{\\mathsf T}$$\n$$P = \\frac{2}{1.008} \\begin{pmatrix} 0.9 \\\\ 0.3 \\end{pmatrix} \\begin{pmatrix} 0.9 & 0.3 \\end{pmatrix} = \\frac{2}{1.008} \\begin{pmatrix} 0.81 & 0.27 \\\\ 0.27 & 0.09 \\end{pmatrix}$$\n\n第三，我们必须求出矩阵 $S^{1/2}$。题目要求先求 $S^{-1/2}$。这需要对 $S$ 进行对角化。对于一个形如 $\\begin{pmatrix} 1 & s \\\\ s & 1 \\end{pmatrix}$ 的通用 $2 \\times 2$ 矩阵，其特征值为 $\\lambda_{1,2} = 1 \\pm s$。对于 $S$，其中 $s=0.2$，特征值为 $\\lambda_{1} = 1.2$ 和 $\\lambda_{2} = 0.8$。相应的归一化特征向量为 $u_{1} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $u_{2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n特征向量矩阵为 $U = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}$。\n$S$的谱分解为 $S = U D U^{\\mathsf T}$，其中 $D = \\text{diag}(1.2, 0.8)$。\n对于任意幂 $f$，矩阵 $S^{f}$ 由 $S^{f} = U D^{f} U^{\\mathsf T}$ 给出。\n按照指示，$S^{-1/2} = U D^{-1/2} U^{\\mathsf T}$，其中 $D^{-1/2} = \\text{diag}(1/\\sqrt{1.2}, 1/\\sqrt{0.8})$。\n矩阵 $S^{1/2}$ 是 $S^{-1/2}$ 的逆矩阵，或者等价地，可以直接计算为 $S^{1/2} = U D^{1/2} U^{\\mathsf T}$，其中 $D^{1/2} = \\text{diag}(\\sqrt{1.2}, \\sqrt{0.8})$。\n$$S^{1/2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\begin{pmatrix} \\sqrt{1.2} & 0 \\\\ 0 & \\sqrt{0.8} \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} \\sqrt{1.2}+\\sqrt{0.8} & \\sqrt{1.2}-\\sqrt{0.8} \\\\ \\sqrt{1.2}-\\sqrt{0.8} & \\sqrt{1.2}+\\sqrt{0.8} \\end{pmatrix}$$\n让我们定义 $A = \\frac{1}{2}(\\sqrt{1.2}+\\sqrt{0.8})$ 和 $B = \\frac{1}{2}(\\sqrt{1.2}-\\sqrt{0.8})$。那么 $S^{1/2} = \\begin{pmatrix} A & B \\\\ B & A \\end{pmatrix}$。\n\n第四，我们计算 Löwdin 总布居数，即 $P' = S^{1/2} P S^{1/2}$ 的对角元素。\n$$\\text{GP}_{A} = (S^{1/2} P S^{1/2})_{11} = \\begin{pmatrix} A & B \\end{pmatrix} P \\begin{pmatrix} A \\\\ B \\end{pmatrix}$$\n$$\\text{GP}_{B} = (S^{1/2} P S^{1/2})_{22} = \\begin{pmatrix} B & A \\end{pmatrix} P \\begin{pmatrix} B \\\\ A \\end{pmatrix}$$\n代入 $P$ 的表达式：\n$$\\text{GP}_{A} = \\frac{2}{1.008} \\begin{pmatrix} A & B \\end{pmatrix} \\begin{pmatrix} 0.81 & 0.27 \\\\ 0.27 & 0.09 \\end{pmatrix} \\begin{pmatrix} A \\\\ B \\end{pmatrix} = \\frac{2}{1.008} (0.81 A^2 + 0.54 AB + 0.09 B^2)$$\n我们计算必要的组成部分：\n$$A^2 = \\frac{1}{4}(1.2 + 0.8 + 2\\sqrt{1.2 \\cdot 0.8}) = \\frac{1}{2}(1 + \\sqrt{0.96})$$\n$$B^2 = \\frac{1}{4}(1.2 + 0.8 - 2\\sqrt{1.2 \\cdot 0.8}) = \\frac{1}{2}(1 - \\sqrt{0.96})$$\n$$AB = \\frac{1}{4}(1.2 - 0.8) = \\frac{0.4}{4} = 0.1$$\n将这些代入 $\\text{GP}_{A}$ 的表达式中：\n$$0.81 A^2 + 0.54 AB + 0.09 B^2 = 0.81 \\cdot \\frac{1}{2}(1+\\sqrt{0.96}) + 0.54(0.1) + 0.09 \\cdot \\frac{1}{2}(1-\\sqrt{0.96})$$\n$$= 0.405(1+\\sqrt{0.96}) + 0.054 + 0.045(1-\\sqrt{0.96})$$\n$$= 0.405 + 0.405\\sqrt{0.96} + 0.054 + 0.045 - 0.045\\sqrt{0.96}$$\n$$= 0.504 + 0.36\\sqrt{0.96}$$\n所以，$\\text{GP}_{A} = \\frac{2}{1.008} (0.504 + 0.36\\sqrt{0.96}) = \\frac{1}{0.504} (0.504 + 0.36\\sqrt{0.96}) = 1 + \\frac{0.36}{0.504}\\sqrt{0.96} = 1 + \\frac{5}{7}\\sqrt{0.96}$。\n通过对称性或直接计算，$\\text{GP}_{B}$ 应该是 $1 - \\frac{5}{7}\\sqrt{0.96}$，这是由于$\\text{GP}_{A} + \\text{GP}_{B} = \\text{Tr}(P') = \\text{Tr}(S^{1/2} P S^{1/2}) = \\text{Tr}(P S) = N = 2$。\n\n第五，我们计算布居数的数值，然后计算电荷。\n使用 $\\sqrt{0.96} \\approx 0.9797959$：\n$$\\frac{5}{7}\\sqrt{0.96} \\approx \\frac{5}{7} \\cdot 0.9797959 \\approx 0.6998542$$\n$$\\text{GP}_{A} \\approx 1 + 0.6998542 = 1.6998542$$\n$$\\text{GP}_{B} \\approx 1 - 0.6998542 = 0.3001458$$\n布居数之和为 $\\text{GP}_{A} + \\text{GP}_{B} = 2$，这正确地等于总电子数。\n\n最后，计算 Löwdin 原子电荷：\n$$q_{A} = Z_{A} - \\text{GP}_{A} = 2 - (1 + \\frac{5}{7}\\sqrt{0.96}) = 1 - \\frac{5}{7}\\sqrt{0.96} \\approx 1 - 0.6998542 = 0.3001458$$\n$$q_{B} = Z_{B} - \\text{GP}_{B} = 1 - (1 - \\frac{5}{7}\\sqrt{0.96}) = \\frac{5}{7}\\sqrt{0.96} \\approx 0.6998542$$\n总电荷为 $q_{A} + q_{B} = 1$，这与体系是电荷为 $+1$ 的阳离子是一致的。\n\n将结果四舍五入到四位有效数字：\n$$q_{A} \\approx 0.3001$$\n$$q_{B} \\approx 0.6999$$\n最终答案以行矩阵的形式呈现。", "answer": "$$\\boxed{\\begin{pmatrix} 0.3001 & 0.6999 \\end{pmatrix}}$$", "id": "2449509"}, {"introduction": "在实际的计算化学研究中，选择何种布居分析方法往往取决于其结果的可靠性和稳定性。最后的这个实践是一个计算实验，旨在让你直接比较Mulliken电荷和Löwdin电荷在分子几何结构发生微小变化时的行为。通过编写一个简化的量子化学模型程序[@problem_id:2449471]，你将获得关于为何Löwdin电荷因其更高的稳定性而通常更受青睐的实践见解——这是计算化学中的一个关键概念。", "problem": "您必须编写一个完整的程序，该程序针对一个包含两个电子的异核双原子分子的最小双中心、双原子轨道(AO)模型，量化计算出的原子电荷对核间距离微小变化的敏感程度。请使用以下具有物理基础的设置。\n\n定义与模型：\n- 设两个AO分别以原子 $A$ 和 $B$ 为中心，每个轨道均由一个归一化的Slater型 $1s$ 函数描述，具有相同的Slater指数 $z$ (单位为玻尔的倒数)。核间距为 $R$ (单位为玻尔)。\n- AO重叠矩阵为 $S(R) \\in \\mathbb{R}^{2 \\times 2}$，其形式为\n  $$S(R) = \\begin{bmatrix} 1 & s(R) \\\\ s(R) & 1 \\end{bmatrix}, \\quad s(R) = e^{-z R} \\left( 1 + z R + \\frac{(z R)^2}{3} \\right)。$$\n- 单电子哈密顿矩阵 $H(R) \\in \\mathbb{R}^{2 \\times 2}$ (单位为哈特里) 定义为\n  $$H(R) = \\begin{bmatrix} \\varepsilon_A & h_{AB}(R) \\\\ h_{AB}(R) & \\varepsilon_B \\end{bmatrix}, \\quad h_{AB}(R) = K \\, s(R) \\, \\frac{\\varepsilon_A + \\varepsilon_B}{2},$$\n  其中 $K$ 是一个无量纲常数。\n- 分子轨道(MO)系数 $C(R) \\in \\mathbb{R}^{2 \\times 2}$ 通过求解广义本征值问题得到\n  $$H(R) \\, C(R) = S(R) \\, C(R) \\, E(R),$$\n  其中 $E(R)$ 是对角矩阵，且满足 $S$-正交归一约束 $C(R)^\\top S(R) C(R) = I$。用两个电子占据能量最低的MO（闭壳层）。则AO密度矩阵为\n  $$P(R) = 2 \\, c_\\text{occ}(R) \\, c_\\text{occ}(R)^\\top,$$\n  其中 $c_\\text{occ}(R)$ 是 $C(R)$ 中的已占据MO列向量。\n- Mulliken总原子布居数定义为\n  $$g_\\mu^{\\mathrm{M}}(R) = \\sum_{\\nu=1}^{2} P_{\\mu\\nu}(R) \\, S_{\\nu\\mu}(R), \\quad \\mu \\in \\{1,2\\},$$\n  其中 $\\mu=1$ 对应原子 $A$，$\\mu=2$ 对应原子 $B$。Mulliken原子电荷为\n  $$q_A^{\\mathrm{M}}(R) = Z_A - g_1^{\\mathrm{M}}(R), \\quad q_B^{\\mathrm{M}}(R) = Z_B - g_2^{\\mathrm{M}}(R)。$$\n- Löwdin对称正交化由正定矩阵平方根 $S(R)^{1/2}$ 定义，Löwdin总布居数由下式的对角元得到\n  $$\\widetilde{P}(R) = S(R)^{1/2} \\, P(R) \\, S(R)^{1/2},$$\n  Löwdin电荷为\n  $$q_A^{\\mathrm{L}}(R) = Z_A - \\widetilde{P}_{11}(R), \\quad q_B^{\\mathrm{L}}(R) = Z_B - \\widetilde{P}_{22}(R)。$$\n\n参数：\n- 使用 $z = 1.24$ (玻尔的倒数)，$\\varepsilon_A = -0.50$ (哈特里)，$\\varepsilon_B = -0.70$ (哈特里)，$K = 1.75$ (无量纲)，$Z_A = 1$ 以及 $Z_B = 1$。\n- 所有距离 $R$ 的单位必须是玻尔，所有能量的单位必须是哈特里。\n\n任务：\n- 对于下方的每个测试用例（由一对核间距离 $(R_1, R_2)$ 组成），计算在Mulliken分析下原子 $A$ 电荷的绝对变化量 $\\Delta^{\\mathrm{M}}_A = \\lvert q_A^{\\mathrm{M}}(R_2) - q_A^{\\mathrm{M}}(R_1) \\rvert$ 以及在Löwdin分析下的绝对变化量 $\\Delta^{\\mathrm{L}}_A = \\lvert q_A^{\\mathrm{L}}(R_2) - q_A^{\\mathrm{L}}(R_1) \\rvert$。对于每种情况，返回一个布尔值，指示是否满足 $\\Delta^{\\mathrm{L}}_A \\le \\Delta^{\\mathrm{M}}_A$。\n- 请严格按照上述定义实现所有必需的线性代数运算。\n\n测试套件（每一项都是探测不同区域的独立测试用例）：\n1. $(R_1, R_2) = (1.40, 1.45)$ 玻尔。\n2. $(R_1, R_2) = (0.80, 0.82)$ 玻尔。\n3. $(R_1, R_2) = (3.00, 3.10)$ 玻尔。\n4. $(R_1, R_2) = (1.20, 1.21)$ 玻尔。\n\n要求的最终输出格式：\n- 您的程序必须生成单行输出，其中包含四个测试用例的结果，格式为一个由方括号括起、逗号分隔的Python风格布尔值列表。例如，该行必须如下所示\n  $$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]。$$\n不得打印任何其他文本。答案是无单位的布尔值，无需四舍五入。", "solution": "该问题陈述具有科学依据、提法明确、客观且内容完整。它基于量子化学的既定原理，描述了一个用于双原子分子的最小但标准的分子轨道模型。哈密顿量、重叠矩阵、密度矩阵以及Mulliken和Löwdin布居分析方法的定义都是正确且标准的。所提供的参数在物理上是合理的。因此，该问题是有效的，并且可以推导出唯一的解。\n\n目标是量化并比较原子 $A$ 上的Mulliken和Löwdin原子电荷对核间距离 $R$ 微小变化的敏感性。这是通过对两种不同的电荷划分方案，计算给定距离变化 $\\Delta R = R_2 - R_1$ 所引起的电荷绝对变化量来实现的。任务的核心是实现一个函数，该函数可根据一组给定的参数在特定距离 $R$ 处计算电荷。对于每个测试用例，将分别对 $R_1$ 和 $R_2$ 调用此函数。\n\n在单个核间距离 $R$ 处计算电荷的步骤如下：\n\n1.  **定义常数**：给出模型的物理参数：Slater指数 $z = 1.24$、原子轨道能量 $\\varepsilon_A = -0.50$ 哈特里 和 $\\varepsilon_B = -0.70$ 哈特里、相互作用常数 $K = 1.75$ 以及核电荷数 $Z_A = 1$ 和 $Z_B = 1$。\n\n2.  **构建矩阵**：必须构建重叠矩阵 $S(R)$ 和单电子哈密顿矩阵 $H(R)$。\n    - 首先，使用提供的公式计算两个原子轨道之间的重叠积分 $s(R)$：\n      $$s(R) = e^{-z R} \\left( 1 + z R + \\frac{(z R)^2}{3} \\right)$$\n    - 于是 $2 \\times 2$ 重叠矩阵 $S(R)$ 为：\n      $$S(R) = \\begin{bmatrix} 1 & s(R) \\\\ s(R) & 1 \\end{bmatrix}$$\n    - 哈密顿量的非对角元素 $h_{AB}(R)$ 计算如下：\n      $$h_{AB}(R) = K \\, s(R) \\, \\frac{\\varepsilon_A + \\varepsilon_B}{2}$$\n    - 于是 $2 \\times 2$ 哈密顿矩阵 $H(R)$ 为：\n      $$H(R) = \\begin{bmatrix} \\varepsilon_A & h_{AB}(R) \\\\ h_{AB}(R) & \\varepsilon_B \\end{bmatrix}$$\n\n3.  **求解广义本征值问题**：分子轨道(MO)系数矩阵 $C(R)$ 和轨道能量矩阵 $E(R)$ 可通过求解Roothaan-Hall方程的广义本征值形式找到：\n    $$H(R) \\, C(R) = S(R) \\, C(R) \\, E(R)$$\n    该问题产生两个本征值 $E_1$ 和 $E_2$（它们是两个MO的能量）以及它们对应的本征向量 $c_1$ 和 $c_2$。体系包含两个电子，根据Aufbau原理，它们占据能量最低的MO。设此能量为 $E_\\text{occ}(R) = \\min(E_1, E_2)$，其关联的本征向量为 $c_\\text{occ}(R)$。该本征向量被归一化，使得 $c_\\text{occ}(R)^\\top S(R) c_\\text{occ}(R) = 1$。\n\n4.  **构建密度矩阵**：在原子轨道基组下，单电子密度矩阵 $P(R)$ 由已占据的MO系数构建：\n    $$P(R) = 2 \\, c_\\text{occ}(R) \\, c_\\text{occ}(R)^\\top$$\n    因子 $2$ 表示单个已占据MO中的两个电子（闭壳层构型）。\n\n5.  **计算Mulliken电荷**：Mulliken总原子布居数 $g_\\mu^{\\mathrm{M}}$ 是矩阵乘积 $P(R)S(R)$ 的对角元素。原子 $A$ 上的布居数（对应于索引 $\\mu=1$）为：\n    $$g_A^{\\mathrm{M}}(R) = [P(R)S(R)]_{11}$$\n    原子 $A$ 上的Mulliken电荷则为：\n    $$q_A^{\\mathrm{M}}(R) = Z_A - g_A^{\\mathrm{M}}(R)$$\n\n6.  **计算Löwdin电荷**：Löwdin流程首先需要对原子轨道基组进行对称正交化。这通过使用重叠矩阵的平方根 $S(R)^{1/2}$ 来实现。对于给定的 $S(R)$ 的 $2 \\times 2$ 结构，其平方根可以解析求得。设 $a = \\frac{1}{2}(\\sqrt{1+s(R)} + \\sqrt{1-s(R)})$ 且 $b = \\frac{1}{2}(\\sqrt{1+s(R)} - \\sqrt{1-s(R)})$。则：\n    $$S(R)^{1/2} = \\begin{bmatrix} a & b \\\\ b & a \\end{bmatrix}$$\n    然后将密度矩阵变换到Löwdin基组下：\n    $$\\widetilde{P}(R) = S(R)^{1/2} \\, P(R) \\, S(R)^{1/2}$$\n    原子 $A$ 上的Löwdin总原子布居数是这个变换后密度矩阵的相应对角元素：\n    $$g_A^{\\mathrm{L}}(R) = \\widetilde{P}_{11}(R)$$\n    原子 $A$ 上的Löwdin电荷为：\n    $$q_A^{\\mathrm{L}}(R) = Z_A - g_A^{\\mathrm{L}}(R)$$\n\n7.  **比较电荷敏感性**：对于每个测试用例 $(R_1, R_2)$，上述过程执行两次（一次对 $R_1$，一次对 $R_2$），以获得 $\\{q_A^{\\mathrm{M}}(R_1), q_A^{\\mathrm{L}}(R_1)\\}$ 和 $\\{q_A^{\\mathrm{M}}(R_2), q_A^{\\mathrm{L}}(R_2)\\}$。然后计算绝对变化量：\n    $$\\Delta^{\\mathrm{M}}_A = \\lvert q_A^{\\mathrm{M}}(R_2) - q_A^{\\mathrm{M}}(R_1) \\rvert$$\n    $$\\Delta^{\\mathrm{L}}_A = \\lvert q_A^{\\mathrm{L}}(R_2) - q_A^{\\mathrm{L}}(R_1) \\rvert$$\n    最后，对布尔条件 $\\Delta^{\\mathrm{L}}_A \\le \\Delta^{\\mathrm{M}}_A$ 进行求值。对所有测试用例重复这整个过程，并收集所得的布尔值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef calculate_charges_at_r(R, z, eps_A, eps_B, K, Z_A):\n    \"\"\"\n    Calculates Mulliken and Löwdin charges on atom A for a given distance R.\n    \"\"\"\n    # Step 2: Construct Matrices\n    zR = z * R\n    s_R = np.exp(-zR) * (1 + zR + (zR)**2 / 3)\n\n    S = np.array([[1.0, s_R],\n                  [s_R, 1.0]])\n\n    h_AB = K * s_R * (eps_A + eps_B) / 2.0\n    H = np.array([[eps_A, h_AB],\n                  [h_AB, eps_B]])\n\n    # Step 3: Solve the Generalized Eigenvalue Problem\n    # eigh returns eigenvalues in ascending order and corresponding eigenvectors\n    # The first eigenvector corresponds to the lowest energy MO.\n    eigenvalues, eigenvectors = eigh(H, S)\n    c_occ = eigenvectors[:, 0].reshape(2, 1)\n\n    # Step 4: Construct the Density Matrix\n    P = 2 * (c_occ @ c_occ.T)\n\n    # Step 5: Calculate Mulliken Charge\n    PS = P @ S\n    g_A_M = PS[0, 0]\n    q_A_M = Z_A - g_A_M\n\n    # Step 6: Calculate Löwdin Charge\n    # Analytically compute S^(1/2) for a 2x2 symmetric matrix\n    sqrt_1_plus_s = np.sqrt(1 + s_R)\n    sqrt_1_minus_s = np.sqrt(1 - s_R)\n    a = 0.5 * (sqrt_1_plus_s + sqrt_1_minus_s)\n    b = 0.5 * (sqrt_1_plus_s - sqrt_1_minus_s)\n    S_sqrt = np.array([[a, b], [b, a]])\n\n    P_tilde = S_sqrt @ P @ S_sqrt\n    g_A_L = P_tilde[0, 0]\n    q_A_L = Z_A - g_A_L\n\n    return q_A_M, q_A_L\n\ndef solve():\n    # Define parameters from the problem statement.\n    z = 1.24        # inverse bohr\n    eps_A = -0.50   # Hartree\n    eps_B = -0.70   # Hartree\n    K = 1.75        # dimensionless\n    Z_A = 1.0       # atomic number for A\n    Z_B = 1.0       # atomic number for B (model parameter)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.40, 1.45),\n        (0.80, 0.82),\n        (3.00, 3.10),\n        (1.20, 1.21),\n    ]\n\n    results = []\n    for R1, R2 in test_cases:\n        # Calculate charges at R1\n        q_A_M_R1, q_A_L_R1 = calculate_charges_at_r(R1, z, eps_A, eps_B, K, Z_A)\n\n        # Calculate charges at R2\n        q_A_M_R2, q_A_L_R2 = calculate_charges_at_r(R2, z, eps_A, eps_B, K, Z_A)\n\n        # Compute absolute changes\n        delta_M_A = abs(q_A_M_R2 - q_A_M_R1)\n        delta_L_A = abs(q_A_L_R2 - q_A_L_R1)\n\n        # Compare sensitivities and store the boolean result\n        results.append(delta_L_A <= delta_M_A)\n\n    # Final print statement in the exact required format.\n    # The boolean values are capitalized in f-string formatting, so map to str.\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n\nsolve()\n```", "id": "2449471"}]}