{"hands_on_practices": [{"introduction": "这个练习将带我们回到问题的根源：自相互作用误差。在一个单电子体系（如 $\\mathrm{H}_{2}^{+}$）中，电子不应该与自身发生相互作用，但近似的密度泛函会错误地包含这种虚假的自排斥能。通过一个严谨的推导，我们将证明为了对任意单电子密度完全消除这种自相互作用，杂化泛函中必须包含 $100\\%$ 的 Hartree-Fock 精确交换，这为杂化泛函的构建提供了根本的理论依据 [@problem_id:2456401]。", "problem": "在 Born-Oppenheimer 近似下，考虑一个核间距固定的氢分子离子 $\\mathrm{H}_{2}^{+}$。这是一个单电子体系。设电子密度为 $\\rho(\\mathbf{r})$，占据的自旋轨道为 $\\varphi(\\mathbf{r})$，因此有 $\\rho(\\mathbf{r}) = |\\varphi(\\mathbf{r})|^{2}$。经典库仑（Hartree）能量定义为\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\int \\int \\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'.\n$$\n对于单个 Slater 行列式，Hartree-Fock (HF) 交换能定义为\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi_{i\\sigma}\\}] = -\\frac{1}{2} \\sum_{\\sigma} \\sum_{i,j \\in \\sigma} \\int \\int \\frac{\\varphi_{i\\sigma}^{*}(\\mathbf{r})\\,\\varphi_{j\\sigma}(\\mathbf{r})\\,\\varphi_{j\\sigma}^{*}(\\mathbf{r}')\\,\\varphi_{i\\sigma}(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'.\n$$\n考虑一个形式如下的全局杂化交换相关能量\n$$\nE_{xc}^{\\mathrm{hyb}}[\\rho] = \\alpha\\,E_{x}^{\\mathrm{HF}}[\\{\\varphi_{i\\sigma}\\}] + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] + E_{c}^{\\mathrm{DFA}}[\\rho],\n$$\n其中 $\\alpha \\in [0,1]$ 是 HF 混合参数，$E_{x}^{\\mathrm{DFA}}[\\rho]$ 是来自给定密度泛函近似 (DFA) 的交换能，$E_{c}^{\\mathrm{DFA}}[\\rho]$ 是一个相关能 DFA。对于单电子密度，取精确相关能为零，并假设所采用的相关能 DFA 遵守此极限，因此对于当前体系有 $E_{c}^{\\mathrm{DFA}}[\\rho] = 0$。\n\n施加一个要求，即 $\\mathrm{H}_{2}^{+}$ 的总电子-电子相互作用贡献不存在自相互作用误差，这意味着对于任意允许的单电子密度 $\\rho(\\mathbf{r})$，经典库仑能量与杂化交换能量之和为零：\n$$\nE_{\\mathrm{H}}[\\rho] + \\alpha\\,E_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] = 0.\n$$\n\n确定对于 $\\mathrm{H}_{2}^{+}$ 的所有单电子密度，满足此条件的 $\\alpha$ 值。将你的最终答案表示为单个实数。无需单位。无需四舍五入。", "solution": "该问题要求找到 Hartree-Fock 混合参数 $\\alpha$ 的值，该值能确保全局杂化泛函对于任何单电子密度（例如氢分子离子 $\\mathrm{H}_{2}^{+}$ 的密度）都没有自相互作用误差。总电子-电子相互作用贡献为零的条件如下：\n$$\nE_{\\mathrm{H}}[\\rho] + \\alpha\\,E_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] = 0\n$$\n此处假设对于单电子体系，相关能 $E_{c}^{\\mathrm{DFA}}[\\rho]$ 为零。该条件必须对任意允许的单电子密度 $\\rho(\\mathbf{r})$ 成立。\n\n设单电子体系的单个占据自旋轨道为 $\\varphi(\\mathbf{r})$。因此电子密度为 $\\rho(\\mathbf{r}) = |\\varphi(\\mathbf{r})|^{2}$。现在，我们将针对此特定情况分析给定方程中的各项。\n\n经典库仑（Hartree）能量 $E_{\\mathrm{H}}[\\rho]$ 定义为：\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\int \\int \\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\n代入单电子密度的表达式，我们得到：\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\int \\int \\frac{|\\varphi(\\mathbf{r})|^{2}\\,|\\varphi(\\mathbf{r}')|^{2}}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\n该项表示电子的电荷分布与其自身的虚假相互作用。\n\n接下来，我们计算 Hartree-Fock (HF) 交换能 $E_{x}^{\\mathrm{HF}}$。对于单个 Slater 行列式的一般定义是：\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi_{i\\sigma}\\}] = -\\frac{1}{2} \\sum_{\\sigma} \\sum_{i,j \\in \\sigma} \\int \\int \\frac{\\varphi_{i\\sigma}^{*}(\\mathbf{r})\\,\\varphi_{j\\sigma}(\\mathbf{r})\\,\\varphi_{j\\sigma}^{*}(\\mathbf{r}')\\,\\varphi_{i\\sigma}(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\n对于只有一个电子的体系，被占据的轨道集合 $\\{\\varphi_{i\\sigma}\\}$ 只包含一个自旋轨道，我们记为 $\\varphi(\\mathbf{r})$。我们将其分配到自旋向上通道，$\\sigma=\\uparrow$，轨道指数为 $i=1$，因此 $\\varphi_{1\\uparrow}(\\mathbf{r})=\\varphi(\\mathbf{r})$。对 $\\sigma$ 的求和将只有 $\\uparrow$ 的贡献。对指数 $i$ 和 $j$ 的求和也各自只有一个项，即 $i=1$ 和 $j=1$。因此，HF 交换能的表达式简化为单个项：\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] = -\\frac{1}{2} \\int \\int \\frac{\\varphi^{*}(\\mathbf{r})\\,\\varphi(\\mathbf{r})\\,\\varphi^{*}(\\mathbf{r}')\\,\\varphi(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\n利用 $\\rho(\\mathbf{r}) = |\\varphi(\\mathbf{r})|^{2}$ 这一事实，可以将其改写为：\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] = -\\frac{1}{2} \\int \\int \\frac{|\\varphi(\\mathbf{r})|^{2}\\,|\\varphi(\\mathbf{r}')|^{2}}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\n\n通过比较单电子体系的 $E_{\\mathrm{H}}[\\rho]$ 和 $E_{x}^{\\mathrm{HF}}[\\{\\varphi\\}]$ 的推导表达式，我们建立了一个基本恒等式：\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] = -E_{\\mathrm{H}}[\\rho]\n$$\n该恒等式表明，纯 Hartree-Fock 理论完全没有自相互作用误差，因为交换项精确地抵消了非物理的 Hartree 自排斥。\n\n现在我们将该恒等式代入问题的定义条件中：\n$$\nE_{\\mathrm{H}}[\\rho] + \\alpha\\,(-E_{\\mathrm{H}}[\\rho]) + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] = 0\n$$\n对各项进行因式分解得到：\n$$\n(1-\\alpha) E_{\\mathrm{H}}[\\rho] + (1-\\alpha) E_{x}^{\\mathrm{DFA}}[\\rho] = 0\n$$\n$$\n(1-\\alpha) \\left( E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\right) = 0\n$$\n对于*任何*允许的单电子密度 $\\rho(\\mathbf{r})$ 以及一个给定的、但未具体指明的密度泛函近似 $E_{x}^{\\mathrm{DFA}}[\\rho]$，该方程必须成立。项 $\\left( E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\right)$ 代表了所选 DFA 中固有的自相互作用误差。常见的密度泛函近似（例如局域密度近似或广义梯度近似族）并非精确，并且已知会表现出非零的自相互作用误差，即对于任意单电子密度，$E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\neq 0$。\n\n要使等式 $(1-\\alpha) \\left( E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\right) = 0$ 对任何 $\\rho(\\mathbf{r})$ 普遍成立，而其中第二个因子通常不为零，那么第一个因子必须恒等于零。\n因此，我们必须施加条件：\n$$\n1 - \\alpha = 0\n$$\n解这个关于 $\\alpha$ 的简单方程，得到唯一解：\n$$\n\\alpha = 1\n$$\n这一结果表明，要使一个全局杂化泛函对所有单电子体系都严格没有自相互作用误差，它必须包含 100% 的 Hartree-Fock 交换，并完全排除 DFA 交换分量。", "answer": "$$\n\\boxed{1}\n$$", "id": "2456401"}, {"introduction": "近似的密度泛函中固有的自相互作用误差会导致一个严重的实际问题，称为离域误差。这种误差导致能量对电子数目的函数曲线偏离了正确的分段线性行为，从而不合物理地偏爱分数电荷的离域分布。本练习 [@problem_id:1373539] 将通过一个关于氯原子体系的定量模型，向您展示一个典型的 GGA 泛函如何产生这种误差，以及引入精确交换的杂化泛函是如何显著地修正这一缺陷的。", "problem": "在密度泛函理论 (DFT) 中，体系的总能量 $E(N)$ 作为电子数的函数，理想情况下应为一个在整数电子数处存在折点的分段线性函数。然而，许多近似的交换相关泛函，例如基于广义梯度近似 (GGA) 的泛函，会表现出一种虚假的凸性。这种“离域误差”会人为地偏好分离片段上的分数电子数。包含了部分精确交换的杂化泛函通常会减小这种误差。\n\n考虑一个孤立的氯原子 ($\\text{Cl}$)。对于 $N \\in [17, 18]$ 范围内的分数电子数，我们将电子数表示为 $N = 17 + \\delta$，其中 $\\delta \\in [0, 1]$。我们将由 GGA 泛函和杂化泛函计算的总能量建模如下：\n$$E_{\\text{GGA}}(17+\\delta) = (1-\\delta)E(17) + \\delta E(18) - C_{\\text{GGA}}\\delta(1-\\delta)$$\n$$E_{\\text{hyb}}(17+\\delta) = (1-\\delta)E(17) + \\delta E(18) - C_{\\text{hyb}}\\delta(1-\\delta)$$\n其中 $E(17)$ 和 $E(18)$ 分别是中性 $\\text{Cl}$ 原子和 $\\text{Cl}^-$ 阴离子的精确总能量。正常数 $C_{\\text{GGA}}$ 和 $C_{\\text{hyb}}$ 量化了每种泛函的凸性，即离域误差的严重程度。\n\n这些参数的值如下：\n- 中性氯原子的能量，$E(17) = -459.642 \\text{ Hartree}$\n- 氯阴离子的能量，$E(18) = -459.775 \\text{ Hartree}$\n- GGA 凸性参数，$C_{\\text{GGA}} = 0.210 \\text{ Hartree}$\n- 杂化泛函凸性参数，$C_{\\text{hyb}} = 0.055 \\text{ Hartree}$\n\n现在，考虑一个由两个相同且无相互作用的氯原子组成的体系。如果向这个双原子体系中添加一个电子，正确的基态对应于电子定域在其中一个原子上，形成一个 $[\\text{Cl}, \\text{Cl}^-]$ 对。然而，由于离域误差，一个近似泛函可能会错误地预测电子离域在两个原子上的状态具有更低的能量，从而得到一个 $[\\text{Cl}^{-0.5}, \\text{Cl}^{-0.5}]$ 体系。\n\n计算 GGA 泛函的虚假离域稳定化能与杂化泛函的虚假离域稳定化能之比。虚假离域稳定化能定义为离域态 $[\\text{Cl}^{-0.5}, \\text{Cl}^{-0.5}]$ 的能量减去正确定域态 $[\\text{Cl}, \\text{Cl}^-]$ 的能量。将最终答案四舍五入至三位有效数字。", "solution": "对于一个电子数为 $N=17+\\delta$ 的孤立原子，由凸性参数 $C$ 表征的给定泛函计算的近似能量为\n$$\nE_{\\text{fun}}(17+\\delta)=(1-\\delta)E(17)+\\delta E(18)-C\\,\\delta(1-\\delta).\n$$\n对于带有额外一个电子的两个无相互作用的氯原子，定域态 $[\\text{Cl}, \\text{Cl}^{-}]$ 中一个原子处于 $\\delta=0$ 状态，另一个处于 $\\delta=1$ 状态，因此其总能量为\n$$\nE_{\\text{loc}}=E_{\\text{fun}}(17)+E_{\\text{fun}}(18)=E(17)+E(18).\n$$\n离域态 $[\\text{Cl}^{-0.5}, \\text{Cl}^{-0.5}]$ 中每个原子都处于 $\\delta=\\frac{1}{2}$ 状态，其每个原子的能量为\n$$\nE_{\\text{fun}}(17+\\tfrac{1}{2})=\\tfrac{1}{2}E(17)+\\tfrac{1}{2}E(18)-C\\left(\\tfrac{1}{2}\\right)\\left(1-\\tfrac{1}{2}\\right)=\\tfrac{1}{2}E(17)+\\tfrac{1}{2}E(18)-\\tfrac{C}{4}.\n$$\n因此，离域态的总能量为\n$$\nE_{\\text{deloc}}=2E_{\\text{fun}}(17+\\tfrac{1}{2})=E(17)+E(18)-\\tfrac{C}{2}.\n$$\n因此，虚假离域稳定化能（离域态能量减去定域态能量）为\n$$\n\\Delta E_{\\text{fun}}=E_{\\text{deloc}}-E_{\\text{loc}}=-\\tfrac{C}{2}.\n$$\n因此，GGA 稳定化能与杂化泛函稳定化能之比为\n$$\nR=\\frac{\\Delta E_{\\text{GGA}}}{\\Delta E_{\\text{hyb}}}=\\frac{-\\tfrac{C_{\\text{GGA}}}{2}}{-\\tfrac{C_{\\text{hyb}}}{2}}=\\frac{C_{\\text{GGA}}}{C_{\\text{hyb}}}.\n$$\n代入给定值，\n$$\nR=\\frac{0.210}{0.055}=\\frac{210}{55}=\\frac{42}{11}\\approx 3.81818\\ldots\n$$\n四舍五入到三位有效数字，结果为 $3.82$。", "answer": "$$\\boxed{3.82}$$", "id": "1373539"}, {"introduction": "离域误差不仅影响总能量的计算，还会扭曲对电子结构的描述，例如分子轨道的空间分布。对于共轭体系，像 GGA 这样的近似泛函常常会过度离域化前线轨道，给出不切实际的电子分布图像。这个计算实践 [@problem_id:2456372] 将指导您构建一个简化但富有洞察力的模型，通过编程计算逆参与率（IPR）这一物理量，来亲手验证和量化杂化泛函是如何通过减小离域误差来获得更局域化、更符合物理实际的前线轨道的。", "problem": "要求您构建并运行一个最小化的、完全指定的计算实验，在一个简化的紧束缚模型的层面上，捕捉杂化泛函如何减少长聚烯链中最高占据分子轨道 (HOMO) 的过度离域现象。\n\n模型定义:\n- 考虑一个具有开放边界条件的 $N$ 个格点的一维链，代表一个聚烯烃。单电子哈密顿量 $H(a)$ 在格点基矢下作用，并由一个 $N \\times N$ 的实对称矩阵表示，其矩阵元为\n  - 在位能：$H_{i,i}(a) = V_i$，对于 $i \\in \\{1,\\dots,N\\}$，\n  - 最近邻耦合：$H_{i,i+1}(a) = H_{i+1,i}(a) = -t \\left[ 1 + (-1)^i d(a) \\right]$，对于 $i \\in \\{1,\\dots,N-1\\}$，\n  - 所有其他矩阵元均为零。\n- 外势是沿链方向的一个破坏反演对称性的均匀场，由 $V_i = s \\left( i - \\frac{N+1}{2} \\right)$ 给出，其中 $s$ 是场强。\n- 键交替参数 $d(a)$ 模拟了与增加杂化泛函中精确交换比例相关的键长交替的增强。其定义为 $d(a) = d_0 + k a$，其中 $a \\in [0,1]$ 是一个代表精确交换比例的参数，而 $d_0$ 和 $k$ 是给定的常数。该哈密顿量是一个 Hückel–Peierls 模型，它使用 $d(a)$ 作为代理变量，以编码杂化泛函增加带隙从而减少过度离域的定性效应。\n\n电子结构与可观测量:\n- 假设一个中性聚烯烃有 $2N$ 个 $\\pi$ 电子和 $2$ 的自旋简并度，因此恰好有 $N$ 个空间轨道被占据。设 $H(a)$ 的本征值按 $\\varepsilon_1 \\le \\varepsilon_2 \\le \\dots \\le \\varepsilon_N$ 排序，对应的归一化本征矢量为 $\\psi^{(1)},\\dots,\\psi^{(N)}$。HOMO 是与 $\\varepsilon_N$ 相关联的本征矢量 $\\psi^{(N)}$。\n- 将 HOMO 的逆参与率 (IPR) 定义为 $\\mathrm{IPR} = \\sum_{i=1}^N \\left| \\psi^{(N)}_i \\right|^4$，其中 $\\psi^{(N)}_i$ 是格点基矢下归一化的 HOMO 本征矢量的第 $i$ 个分量。较大的 $\\mathrm{IPR}$ 表示更强的空间局域化。\n\n任务:\n- 对于下面测试套件中的每一组参数，精确地按照定义构建 $H(a)$，计算其本征分解，确定 HOMO，并计算相应的 $\\mathrm{IPR}$。\n- 您的程序必须输出单行结果，该行是一个用逗号分隔的 $\\mathrm{IPR}$ 值列表，用方括号括起来，顺序与测试套件中的顺序相同。每个 $\\mathrm{IPR}$ 值必须四舍五入到 $6$ 位小数。\n\n测试套件:\n- 所有情况均使用常数 $d_0 = 0.04$ 和 $k = 0.20$。对所有量均统一使用哈密顿量单位。\n- 情况 1 (基准，无场，无杂化混合)：$N = 80$, $t = 1.0$, $s = 0.0$, $a = 0.00$。\n- 情况 2 (施加场，无杂化混合)：$N = 80$, $t = 1.0$, $s = 0.01$, $a = 0.00$。\n- 情况 3 (施加场，中等杂化混合)：$N = 80$, $t = 1.0$, $s = 0.01$, $a = 0.25$。\n- 情况 4 (施加场，较强杂化混合)：$N = 80$, $t = 1.0$, $s = 0.01$, $a = 0.50$。\n- 情况 5 (更长的链，施加场，较强杂化混合)：$N = 200$, $t = 1.0$, $s = 0.005$, $a = 0.50$。\n\n最终输出格式:\n- 您的程序应生成单行输出，其中包含一个用逗号分隔并用方括号括起来的结果列表，例如 $[\\mathrm{IPR}_1,\\mathrm{IPR}_2,\\mathrm{IPR}_3,\\mathrm{IPR}_4,\\mathrm{IPR}_5]$，每个条目都四舍五入到 $6$ 位小数。", "solution": "我们形式化了一个描述聚烯烃的 Hückel–Peierls 紧束缚模型，并引入了一个代理来体现杂化泛函效应。其核心科学原理是：杂化泛函通过包含一部分精确交换来增加电子带隙，从而减少半局域近似中特有的离域误差。在聚烯烃中，增强的键长交替会增大带隙。在弱的对称性破缺场存在的情况下，更大的带隙会使前线轨道在空间上更受限（局域化长度更短）。我们将此问题构建为一个严格定义的哈密顿量，其参数可以变化，其预测结果可以通过逆参与率 (IPR) 这一公认的局域化度量来量化。\n\n1. 哈密顿量构建。我们定义一个 $N \\times N$ 矩阵 $H(a)$，其矩阵元为\n   - $H_{i,i}(a) = s \\left( i - \\frac{N+1}{2} \\right)$，它在链上施加一个强度为 $s$ 的线性势，以破坏反演对称性并揭示 HOMO 的局域化趋势。\n   - $H_{i,i+1}(a) = H_{i+1,i}(a) = -t \\left[ 1 + (-1)^i d(a) \\right]$，对于 $i \\in \\{1,\\dots,N-1\\}$，这实现了带有键交替的最近邻跃迁。\n   - $d(a) = d_0 + k a$，该式模拟了经验上已确立的趋势，即在共轭聚合物中，增加精确交换分数 $a$ 会增强键长交替并增大带隙。\n\n   所有其他矩阵元均为零。这是一个由显式公式定义的纯数学哈密顿量，没有未指定的参数。\n\n2. 电子结构。对于一个具有 $2N$ 个 $\\pi$ 电子和自旋简并度为 $2$ 的中性聚烯烃，恰好有 $N$ 个空间轨道被占据。设 $H(a)$ 的本征值按 $\\varepsilon_1 \\le \\cdots \\le \\varepsilon_N$ 排序，对应的归一化本征矢量为 $\\psi^{(1)},\\dots,\\psi^{(N)}$。HOMO 是 $\\psi^{(N)}$。我们通过求解 $H(a)$ 的对称本征问题来计算其本征分解。\n\n3. 局域化度量。逆参与率定义为\n   $$\\mathrm{IPR} = \\sum_{i=1}^N \\left| \\psi^{(N)}_i \\right|^4,$$\n   其中根据归一化条件 $\\sum_{i=1}^N \\left| \\psi^{(N)}_i \\right|^2 = 1$。如果 HOMO 均匀离域在 $N$ 个格点上，则 $\\left| \\psi^{(N)}_i \\right|^2 \\approx \\frac{1}{N}$ 且 $\\mathrm{IPR} \\approx \\frac{1}{N}$。如果它强烈局域在少数几个格点上，IPR 会变大，在极端单格点极限下接近 $1$。\n\n4. 每个测试用例的算法步骤：\n   - 根据给定的 $a$、$d_0$ 和 $k$ 计算 $d(a) = d_0 + k a$。\n   - 组装三对角哈密顿量，其对角元为 $H_{i,i} = s \\left( i - \\frac{N+1}{2} \\right)$，非对角元为 $H_{i,i+1} = H_{i+1,i} = -t \\left[ 1 + (-1)^i d(a) \\right]$（对于 $i \\in \\{1,\\dots,N-1\\}$）。\n   - 通过对角化 $H(a)$ 计算所有本征对。因为 $H(a)$ 是实对称的，所以存在一组标准正交的本征矢量，且数值对角化是稳定的。\n   - 选择与最大本征值（在升序排列中索引为 $N$）相关联的本征矢量作为 HOMO 本征矢量。\n   - 计算 $\\mathrm{IPR} = \\sum_{i=1}^N \\left| \\psi^{(N)}_i \\right|^4$。\n   - 将得到的 $\\mathrm{IPR}$ 四舍五入到 $6$ 位小数以用于输出格式化。\n\n5. 预期的定性行为和覆盖范围：\n   - 情况 1 中 $s = 0$ 且 $a = 0$，产生一个具有反演对称性的均匀链 ($d(a) = d_0$)；HOMO 是延展的，$\\mathrm{IPR}$ 很小，接近 $\\frac{1}{N}$。\n   - 情况 2 在 $a = 0$ 时开启一个弱场 ($s > 0$)，引入了不对称性；HOMO 开始在一端积聚，使 $\\mathrm{IPR}$ 略有增加。\n   - 情况 3 和情况 4 在保持场开启的同时增加 $a$。由于 $d(a)$ 随 $a$ 增大而增大，带隙增加，HOMO 在相同场下局域化更强，因此 $\\mathrm{IPR}$ 从情况 2 到情况 4 单调增加。\n   - 情况 5 使用更长的链来探究在更强杂化混合下的长链极限；由于相对于均匀无场链的局域化增强，其 $\\mathrm{IPR}$ 仍显著大于情况 1。\n\n程序精确地实现了这些步骤，并按要求打印单行结果，其中包含五个 $\\mathrm{IPR}$ 值，这些值被四舍五入到 $6$ 位小数，并格式化为用方括号括起来的逗号分隔列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_hamiltonian(N: int, t: float, s: float, a: float, d0: float, k: float) -> np.ndarray:\n    \"\"\"\n    Construct the N x N Hamiltonian matrix H(a) for the Hückel–Peierls chain with:\n      - On-site potential: V_i = s * (i - (N+1)/2)\n      - Alternating hopping: H_{i,i+1} = H_{i+1,i} = -t * [1 + (-1)^i * d(a)]\n        where i is 1-based in the formula; in code we adjust indices accordingly.\n      - d(a) = d0 + k * a\n    Open boundary conditions are used (tridiagonal matrix).\n    \"\"\"\n    H = np.zeros((N, N), dtype=float)\n    # On-site potentials\n    center = (N + 1) / 2.0\n    for i in range(N):\n        H[i, i] = s * ((i + 1) - center)  # i+1 to map to 1-based site index\n\n    # Off-diagonal couplings\n    d_a = d0 + k * a\n    for i in range(N - 1):\n        # Map to 1-based index for alternating sign pattern (-1)^i with i = 1..N-1\n        i1_based = i + 1\n        hop = -t * (1.0 + ((-1) ** i1_based) * d_a)\n        H[i, i + 1] = hop\n        H[i + 1, i] = hop\n\n    return H\n\ndef homo_ipr(H: np.ndarray) -> float:\n    \"\"\"\n    Compute the inverse participation ratio (IPR) of the HOMO for Hamiltonian H.\n    The HOMO is the eigenvector associated with the largest eigenvalue (highest occupied),\n    assuming a neutral system with N occupied spatial orbitals (spin-degenerate).\n    \"\"\"\n    # Use eigh for symmetric matrices; returns eigenvalues in ascending order\n    w, v = np.linalg.eigh(H)\n    homo_vec = v[:, -1]  # eigenvector for the largest eigenvalue\n    # Normalize explicitly (eigh returns normalized vectors, but ensure numerical safety)\n    norm = np.linalg.norm(homo_vec)\n    if norm == 0.0:\n        return 0.0\n    psi = homo_vec / norm\n    ipr = float(np.sum(np.abs(psi) ** 4))\n    return ipr\n\ndef solve():\n    # Constants used in all test cases\n    d0 = 0.04\n    k = 0.20\n\n    # Define the test cases from the problem statement: (N, t, s, a)\n    test_cases = [\n        (80, 1.0, 0.0, 0.00),   # Case 1\n        (80, 1.0, 0.01, 0.00),  # Case 2\n        (80, 1.0, 0.01, 0.25),  # Case 3\n        (80, 1.0, 0.01, 0.50),  # Case 4\n        (200, 1.0, 0.005, 0.50) # Case 5\n    ]\n\n    results = []\n    for N, t, s, a in test_cases:\n        H = build_hamiltonian(N=N, t=t, s=s, a=a, d0=d0, k=k)\n        ipr = homo_ipr(H)\n        # Round to 6 decimal places as required\n        results.append(f\"{ipr:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2456372"}]}