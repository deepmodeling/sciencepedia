{"hands_on_practices": [{"introduction": "这项实践将带您回到密度泛函理论的源头之一——局域密度近似（LDA）的基本思想。通过为均匀电子气推导动能泛函 $T_s[n]$ 和交换能泛函 $E_x[n]$，您将理解一个系统的能量如何能够表示为其常数密度 $n_0$ 的泛函 [@problem_id:2453886]。这个基础性的练习对于领会更复杂的泛函是如何基于这一简单、理想化的模型构建起来的至关重要。", "problem": "考虑一个三维均匀电子气（常称为 jellium）：在热力学极限下，大量自旋非极化的电子以恒定的数密度 $n_{0}$ 占据一个体积为 $V$、具有周期性边界条件的立方盒子。使用 Hartree 原子单位制，即 $\\hbar=m_{e}=e=4\\pi\\varepsilon_{0}=1$。在 Kohn–Sham 密度泛函理论（DFT）中，无相互作用动能泛函 $T_{s}[n]$ 定义为可再现密度 $n(\\mathbf{r})$ 的无相互作用参考体系的基态动能，而交换能泛函 $E_{x}[n]$ 定义为该参考体系的 Fock 交换能。\n\n对于均匀密度 $n(\\mathbf{r})=n_{0}$，假设自旋简并度为 $g_{s}=2$，确定 $T_{s}[n_{0}]$ 和 $E_{x}[n_{0}]$ 对 $n_{0}$ 和 $V$ 的精确依赖关系。请将最终答案表示为一个包含两个条目的行矩阵，按顺序分别为 $T_{s}[n_{0}]$ 和 $E_{x}[n_{0}]$，单位为 Hartree 原子单位。无需取整。", "solution": "所述问题是有效的。这是一个关于均匀电子气（也称为 jellium）的固态物理学和密度泛函理论中的经典问题。问题的前提在科学上是合理的、适定的，并且所有必要信息都已提供。我们现在开始求解。\n\n问题要求解在体积 $V$ 中，密度为常数 $n_0$ 的均匀电子气的无相互作用动能泛函 $T_s[n_0]$ 和交换能泛函 $E_x[n_0]$。我们使用 Hartree 原子单位制，其中 $\\hbar = m_e = e = 4\\pi\\varepsilon_0 = 1$。给定的自旋简并度为 $g_s=2$。\n\n首先，我们确定无相互作用动能 $T_s[n_0]$。根据定义，这是一个具有基态密度 $n_0$ 的无相互作用电子体系的动能。对于均匀气体，无相互作用参考体系就是一个无相互作用的费米子气体。基态是通过填充单粒子能级直至达到费米能来构建的。\n\n在体积为 $V=L^3$、具有周期性边界条件的立方盒子中，电子的单粒子波函数是平面波：\n$$\n\\psi_{\\mathbf{k}}(\\mathbf{r}) = \\frac{1}{\\sqrt{V}} \\exp(i\\mathbf{k} \\cdot \\mathbf{r})\n$$\n对应的动能为：\n$$\n\\epsilon_{\\mathbf{k}} = \\frac{\\hbar^2 |\\mathbf{k}|^2}{2m_e} = \\frac{|\\mathbf{k}|^2}{2}\n$$\n在基态下，所有波矢模长 $|\\mathbf{k}|$ 小于等于费米波矢 $k_F$ 的态都被占据。电子总数 $N$ 与密度 $n_0$ 的关系为 $N = n_0 V$。在热力学极限下，对离散 $\\mathbf{k}$ 态的求和可以替换为在 $\\mathbf{k}$ 空间中的积分：\n$$\n\\sum_{\\mathbf{k}} \\to V \\int \\frac{d^3\\mathbf{k}}{(2\\pi)^3}\n$$\n电子总数可通过对 $\\mathbf{k}$ 空间中费米球的体积进行积分，并乘以自旋简并度 $g_s=2$ 来求得：\n$$\nN = g_s V \\int_{|\\mathbf{k}| \\le k_F} \\frac{d^3\\mathbf{k}}{(2\\pi)^3} = 2V \\left( \\frac{4\\pi k_F^3}{3(2\\pi)^3} \\right) = V \\frac{k_F^3}{3\\pi^2}\n$$\n由此，我们建立密度 $n_0 = N/V$ 和费米波矢 $k_F$ 之间的关系：\n$$\nn_0 = \\frac{k_F^3}{3\\pi^2} \\implies k_F = (3\\pi^2 n_0)^{1/3}\n$$\n总的无相互作用动能 $T_s[n_0]$ 是所有被占据态的能量之和：\n$$\nT_s[n_0] = g_s \\sum_{|\\mathbf{k}| \\le k_F} \\epsilon_{\\mathbf{k}} = g_s V \\int_{|\\mathbf{k}| \\le k_F} \\frac{|\\mathbf{k}|^2}{2} \\frac{d^3\\mathbf{k}}{(2\\pi)^3}\n$$\n代入 $g_s=2$ 并在 $\\mathbf{k}$ 空间中切换到球坐标（$d^3\\mathbf{k} = 4\\pi |\\mathbf{k}|^2 d|\\mathbf{k}|$），积分变为：\n$$\nT_s[n_0] = 2 V \\frac{4\\pi}{(2\\pi)^3} \\int_0^{k_F} \\frac{k^2}{2} k^2 dk = \\frac{V}{\\pi^2} \\int_0^{k_F} \\frac{k^4}{2} dk = \\frac{V}{2\\pi^2} \\left[ \\frac{k^5}{5} \\right]_0^{k_F} = \\frac{V k_F^5}{10\\pi^2}\n$$\n最后，我们将 $k_F$ 的表达式用 $n_0$ 代入：\n$$\nT_s[n_0] = \\frac{V}{10\\pi^2} \\left[ (3\\pi^2 n_0)^{1/3} \\right]^5 = \\frac{V}{10\\pi^2} (3\\pi^2)^{5/3} n_0^{5/3} = \\frac{3^{5/3}\\pi^{10/3}}{10\\pi^2} V n_0^{5/3} = \\frac{3}{10}(3\\pi^2)^{2/3} V n_0^{5/3}\n$$\n这就是对均匀密度求值的著名的 Thomas-Fermi 动能泛函。\n\n接下来，我们确定交换能 $E_x[n_0]$。对于均匀电子气，由局域密度近似（LDA）给出的交换能是精确的。LDA 交换能泛函由下式给出：\n$$\nE_x^{\\text{LDA}}[n] = \\int e_x^{\\text{unif}}(n(\\mathbf{r})) d^3\\mathbf{r}\n$$\n其中 $e_x^{\\text{unif}}(n)$是密度为 $n$ 的均匀、自旋非极化电子气的单位体积交换能。该量的标准表达式为：\n$$\ne_x^{\\text{unif}}(n) = - C_x n^{4/3}\n$$\n其中常数 $C_x$ 由下式给出：\n$$\nC_x = \\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3}\n$$\n对于所讨论的体系，密度是常数 $n(\\mathbf{r}) = n_0$。因此，交换能为：\n$$\nE_x[n_0] = \\int -C_x n_0^{4/3} d^3\\mathbf{r} = -C_x n_0^{4/3} \\int d^3\\mathbf{r} = -C_x V n_0^{4/3}\n$$\n代入 $C_x$ 的表达式：\n$$\nE_x[n_0] = -\\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3} V n_0^{4/3}\n$$\n这就是均匀电子气的精确交换能。\n\n我们根据要求将两个结果合并成一个行矩阵。\n第一个条目是 $T_s[n_0] = \\frac{3}{10}(3\\pi^2)^{2/3} V n_0^{5/3}$。\n第二个条目是 $E_x[n_0] = -\\frac{3}{4}(\\frac{3}{\\pi})^{1/3} V n_0^{4/3}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{10}(3\\pi^{2})^{2/3} V n_{0}^{5/3} & - \\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3} V n_{0}^{4/3} \\end{pmatrix}}\n$$", "id": "2453886"}, {"introduction": "虽然近似密度泛函功能强大，但并非完美，其最著名的缺陷之一就是自相互作用误差（SIE）。这项动手编程练习将挑战您使用局域自旋密度近似（LSDA）来量化简单氢原子的SIE [@problem_id:2453879]。通过数值计算哈特里能量和交换能，您将对这一基本限制获得具体、定量的理解，并明白为何它在量子化学中是一个关键的考量因素。", "problem": "您需要编写一个完整的程序，在使用局域自旋密度近似 (LSDA) 交换泛函时，量化单个氢原子的自相互作用误差。所有计算均在哈特里原子单位下进行。对于单电子体系，自相互作用误差定义为经典哈特里（静电）能量与交换能量之和。对于单电子密度，精确的Kohn-Sham交换将完全抵消哈特里能量，因此该和的任何残余值即为近似交换泛函的自相互作用误差。\n\n考虑氢原子的归一化基态电子密度，\n$$\nn(\\mathbf{r}) = \\frac{1}{\\pi} e^{-2 r},\n$$\n其中 $r = \\lvert \\mathbf{r} \\rvert$，且 $n(\\mathbf{r})$ 积分为 1 个电子。\n\n使用以下第一性原理定义：\n\n- 哈特里能量，\n$$\nE_{\\mathrm{H}}[n] = \\frac{1}{2} \\int \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}^{\\prime})}{\\lvert \\mathbf{r} - \\mathbf{r}^{\\prime} \\rvert} \\, d^3 r \\, d^3 r^{\\prime}.\n$$\n\n- 对于自旋密度 $n_{\\uparrow}(\\mathbf{r})$ 和 $n_{\\downarrow}(\\mathbfr)$ 的局域自旋密度近似 (LSDA) 交换能量，\n$$\nE_{x}^{\\mathrm{LSDA}}[n_{\\uparrow}, n_{\\downarrow}] = - C_{x} \\int \\left[n_{\\uparrow}(\\mathbf{r})^{4/3} + n_{\\downarrow}(\\mathbf{r})^{4/3}\\right] \\, d^3 r,\n$$\n其中\n$$\nC_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}.\n$$\n\n将自相互作用误差定义为\n$$\n\\mathrm{SIE} = E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{LSDA}}[n_{\\uparrow}, n_{\\downarrow}].\n$$\n\n对于单个电子，考虑以下两种自旋构型：\n- 完全自旋极化（对于单电子是物理构型）：$n_{\\uparrow}(\\mathbf{r}) = n(\\mathbf{r})$，$n_{\\downarrow}(\\mathbf{r}) = 0$。\n- 人为的自旋非极化（用于灵敏度分析）：$n_{\\uparrow}(\\mathbf{r}) = n_{\\downarrow}(\\mathbf{r}) = \\tfrac{1}{2} n(\\mathbf{r})$。\n\n在三个测试案例中，使用从 $r=0$ 延伸到有限截断半径 $R_{\\max}$ 的 $N_r$ 个点的径向格点来数值计算所需的积分，每个测试案例都指定了 $N_r$ 和 $R_{\\max}$。所有能量必须以哈特里（Hartree）为单位表示，并报告为四舍五入到六位小数的浮点数。\n\n测试套件（每个案例为一个三元组 $(N_r, R_{\\max}, \\text{spin})$，其中 spin 为字符串 \"polarized\" 或 \"unpolarized\"）：\n1. $(8000, 20.0, \\text{\"polarized\"})$\n2. $(1000, 12.0, \\text{\"polarized\"})$\n3. $(2000, 8.0, \\text{\"unpolarized\"})$\n\n您的程序应计算每个测试案例的自相互作用误差 $\\mathrm{SIE}$，并生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，结果顺序与测试套件中的案例顺序相同，例如：\n$$\n[\\mathrm{SIE}_1,\\mathrm{SIE}_2,\\mathrm{SIE}_3]\n$$\n所有三个数字都必须以哈特里为单位，并四舍五入到六位小数（输出中不包含任何单位符号）。", "solution": "该问题要求使用局域自旋密度近似 (LSDA) 交换泛函计算单个氢原子的自相互作用误差 (SIE)。该体系在哈特里原子单位下定义。分析将针对两种自旋构型进行：完全自旋极化和人为的自旋非极化。\n\n首先，我们验证问题陈述。\n**已知条件：**\n- 氢原子基态的电子密度：$n(\\mathbf{r}) = \\frac{1}{\\pi} e^{-2 r}$，其中 $r = |\\mathbf{r}|$。\n- 自相互作用误差定义：$\\mathrm{SIE} = E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{LSDA}}[n_{\\uparrow}, n_{\\downarrow}]$。\n- 哈特里能量：$E_{\\mathrm{H}}[n] = \\frac{1}{2} \\int \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}^{\\prime})}{\\lvert \\mathbf{r} - \\mathbf{r}^{\\prime} \\rvert} \\, d^3 r \\, d^3 r^{\\prime}$。\n- LSDA 交换能量：$E_{x}^{\\mathrm{LSDA}}[n_{\\uparrow}, n_{\\downarrow}] = - C_{x} \\int \\left[n_{\\uparrow}(\\mathbf{r})^{4/3} + n_{\\downarrow}(\\mathbf{r})^{4/3}\\right] \\, d^3 r$，其中常数 $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$。\n- 自旋构型：\n    1. 自旋极化：$n_{\\uparrow}(\\mathbf{r}) = n(\\mathbf{r})$，$n_{\\downarrow}(\\mathbf{r}) = 0$。\n    2. 自旋非极化：$n_{\\uparrow}(\\mathbf{r}) = n_{\\downarrow}(\\mathbf{r}) = \\tfrac{1}{2} n(\\mathbf{r})$。\n- 三个测试案例的数值参数：$(N_r, R_{\\max}, \\text{spin})$。\n\n**验证：**\n该问题具有科学依据，涉及密度泛函理论中的一个标准计算。所提供的电子密度、哈特里能量和 LSDA 交换能量的公式均为标准公式。对于单电子体系，自相互作用误差作为哈特里能量和近似交换能量之和的概念，是 DFT 泛函分析的基石。该问题是适定的，为数值求解提供了所有必要信息。数值积分的参数是合理的。因此，该问题被认为是**有效的**。\n\n我们现在开始求解。计算需要评估两个能量分量：哈特里能量 $E_{\\mathrm{H}}[n]$ 和 LSDA 交换能量 $E_{x}^{\\mathrm{LSDA}}$。所有积分将按照规定在径向格点上进行数值计算。\n\n**1. 哈特里能量, $E_{\\mathrm{H}}[n]$**\n\n哈特里能量代表电子密度云的经典静电自排斥。对于球对称密度 $n(r)$，该表达式可以简化。将经典静电学中计算电荷分布能量的方法（逐层构建电荷壳层）直接应用，可得到总静电能量为：\n$$\nE_{\\mathrm{H}} = \\int_0^\\infty \\frac{Q(r)}{r} \\, dq(r)\n$$\n其中 $dq(r) = n(r) 4\\pi r^2 dr$ 是半径为 $r$、厚度为 $dr$ 的球壳中的电荷量，而 $Q(r) = \\int_0^r dq(r')$ 是半径为 $r$ 的球体内部的总电荷量。这个公式对每对相互作用只计数一次，从而避免了其他公式中因重复计数而引入的 $\\frac{1}{2}$ 因子。\n\n对于给定的密度 $n(r) = \\frac{1}{\\pi}e^{-2r}$，内含电荷 $Q(r)$ 为：\n$$\nQ(r) = \\int_0^r 4\\pi (r')^2 \\left(\\frac{1}{\\pi} e^{-2r'}\\right) dr' = 4 \\int_0^r (r')^2 e^{-2r'} dr' = 1 - (2r^2 + 2r + 1)e^{-2r}\n$$\n那么哈特里能量就是积分：\n$$\nE_{\\mathrm{H}}[n] = \\int_0^\\infty \\left[ \\frac{1 - (2r^2 + 2r + 1)e^{-2r}}{r} \\right] (4r^2 e^{-2r}) dr\n$$\n$$\nE_{\\mathrm{H}}[n] = \\int_0^\\infty \\left[ 4r e^{-2r} - 4r(2r^2 + 2r + 1) e^{-4r} \\right] dr\n$$\n对此标准积分求值，得到精确的解析结果：\n$$\nE_{\\mathrm{H}}[n] = 1 - \\left(\\frac{3}{16} + \\frac{4}{16} + \\frac{4}{16}\\right) = 1 - \\frac{11}{16} = \\frac{5}{16} \\text{ Hartree}.\n$$\n这个 $E_{\\mathrm{H}}[n] = 0.3125$ 哈特里的精确值可作为我们数值实现的参考。某些文献中的差异通常是由于定义不一致造成的。我们的推导是基于第一性原理的。\n\n在数值计算中，我们首先使用累积梯形法则在径向格点上计算 $Q(r)$。然后，我们将梯形法则应用于被积函数 $4\\pi r n(r) Q(r)$ 来计算 $E_{\\mathrm{H}}$。\n\n**2. LSDA 交换能量, $E_{x}^{\\mathrm{LSDA}}$**\n\n必须针对两种指定的自旋构型评估 LSDA 交换能量积分。由于密度是球对称的，体积积分简化为径向积分：\n$$\nE_{x}^{\\mathrm{LSDA}} = -C_x \\int_0^\\infty \\left[ n_{\\uparrow}(r)^{4/3} + n_{\\downarrow}(r)^{4/3} \\right] 4\\pi r^2 dr\n$$\n常数为 $C_x = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$。\n\n情况 1：完全自旋极化\n此时，$n_{\\uparrow}(r) = n(r)$ 且 $n_{\\downarrow}(r) = 0$。表达式简化为：\n$$\nE_{x}^{\\mathrm{LSDA, pol}} = -C_x \\int_0^\\infty n(r)^{4/3} 4\\pi r^2 dr\n$$\n需要进行数值积分的项是 $-C_x \\left(\\frac{1}{\\pi} e^{-2r}\\right)^{4/3} 4\\pi r^2$。\n\n情况 2：人为的自旋非极化\n此时，$n_{\\uparrow}(r) = n_{\\downarrow}(r) = \\frac{1}{2}n(r)$。密度项的和为：\n$$\nn_{\\uparrow}^{4/3} + n_{\\downarrow}^{4/3} = 2 \\left( \\frac{n(r)}{2} \\right)^{4/3} = 2^{1 - 4/3} n(r)^{4/3} = 2^{-1/3} n(r)^{4/3}\n$$\n那么交换能量为：\n$$\nE_{x}^{\\mathrm{LSDA, unpol}} = -C_x \\cdot 2^{-1/3} \\int_0^\\infty n(r)^{4/3} 4\\pi r^2 dr\n$$\n这其实就是极化情况下的交换能量乘以一个因子 $2^{-1/3}$。对 $n(r)^{4/3}$ 的相同数值积分可以被重用。\n\n**3. 总自相互作用误差, SIE**\n\n对于每个测试案例，SIE 是数值计算出的能量之和：\n$$\n\\mathrm{SIE} = E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{LSDA}}[n]\n$$\n程序将为测试套件中的每个元组 $(N_r, R_{\\max}, \\text{spin})$ 实现这些步骤并报告结果。数值积分使用梯形法则进行，该功能由 `numpy` 和 `scipy` 库提供。对于足够多的格点数 $N_r$，此方法可以提供准确的结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import cumulative_trapezoid\n\ndef solve():\n    \"\"\"\n    Computes the self-interaction error (SIE) for a Hydrogen atom\n    using the Local Spin-Density Approximation (LSDA) exchange functional.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N_r, R_max, spin_case)\n        (8000, 20.0, \"polarized\"),\n        (1000, 12.0, \"polarized\"),\n        (2000, 8.0, \"unpolarized\"),\n    ]\n\n    results = []\n    \n    # Constant C_x for LSDA exchange in Hartree atomic units\n    C_x = (3.0 / 4.0) * (3.0 / np.pi)**(1.0 / 3.0)\n\n    for Nr, R_max, spin_case in test_cases:\n        # 1. Set up the radial grid\n        # We use a linear grid. r=0 is handled carefully.\n        r = np.linspace(0, R_max, Nr)\n        \n        # 2. Define the electron density n(r) for Hydrogen atom\n        # n(r) = (1/pi) * exp(-2r)\n        n_r = (1.0 / np.pi) * np.exp(-2.0 * r)\n        \n        # 3. Calculate the Hartree Energy E_H[n]\n        # E_H = integral [Q(r)/r] dq(r) over all space\n        # where Q(r) is enclosed charge and dq(r) is charge in a shell.\n        # This is equivalent to E_H = integral_0^inf [4*pi*r*n(r)*Q(r)] dr\n        \n        # First, compute Q(r) = integral_0^r 4*pi*r'^2*n(r') dr'\n        # Integrand for Q(r)\n        q_integrand = 4.0 * np.pi * r**2 * n_r\n        \n        # Use cumulative trapezoid rule for accurate Q(r)\n        # cumulative_trapezoid returns a result for r[1:], so we prepend 0\n        Q_r = cumulative_trapezoid(q_integrand, r, initial=0.0)\n\n        # Now, compute the integrand for Hartree energy\n        eh_integrand = 4.0 * np.pi * r * n_r * Q_r\n        \n        # Integrate using the trapezoidal rule\n        E_H = np.trapz(eh_integrand, r)\n        \n        # 4. Calculate the LSDA Exchange Energy E_x^LSDA[n]\n        # E_x = -C_x * integral [n_up^(4/3) + n_down^(4/3)] d^3r\n        \n        # Common part of the integral: integral_0^inf n(r)^(4/3) * 4*pi*r^2 dr\n        n_43 = n_r**(4.0 / 3.0)\n        ex_integrand_base = n_43 * 4.0 * np.pi * r**2\n        integral_val = np.trapz(ex_integrand_base, r)\n        \n        if spin_case == \"polarized\":\n            # n_up = n, n_down = 0\n            # Sum of densities term is n^(4/3)\n            spin_factor = 1.0\n        elif spin_case == \"unpolarized\":\n            # n_up = n/2, n_down = n/2\n            # Sum becomes 2 * (n/2)^(4/3) = 2^(-1/3) * n^(4/3)\n            spin_factor = 2.0**(-1.0 / 3.0)\n        \n        E_x = -C_x * spin_factor * integral_val\n        \n        # 5. Calculate the Self-Interaction Error\n        SIE = E_H + E_x\n        \n        results.append(SIE)\n\n    # Format the final output as specified\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2453879"}, {"introduction": "DFT计算中的总误差，是泛函的内在准确性和所算得的电子密度质量之间复杂相互作用的结果。本练习要求您通过分析一组关于拉伸 $H_2$ 分子的假设计算结果来剖析这些误差来源 [@problem_id:2453913]。通过区分“泛函驱动误差”和“密度驱动误差”，您将对如何诊断和解释DFT计算结果形成更深入的理解，这是任何计算化学家必备的一项关键技能。", "problem": "您将通过区分密度驱动误差和泛函驱动误差，来分析密度泛函理论 (DFT) 计算中的误差来源。请使用以下基本原理：(i) Hohenberg–Kohn 定理指出，基态能量是基态电子密度的泛函，精确能量通过最小化该能量泛函相对于密度的值得到；(ii) 在 Kohn–Sham (KS) 框架中，一个近似的交换相关泛函会产生一个近似的能量泛函，其自洽最小化结果为一个近似密度；(iii) 有限的单电子基组会引起允许的密度和轨道的离散化，从而导致基组不完备性误差。考虑在拉伸键长 $R=3.0\\,\\mathrm{\\AA}$ 时 H$_2$ 的 Born–Oppenheimer 基态。\n\n现有以下一组计算结果。所有能量均以 Hartree 单位 ($E_{\\mathrm{h}}$) 给出，并且所有适用的计算都是自旋非限制的。符号 $E_{\\mathrm{meth}}[n_{\\bullet}]$ 表示使用“meth”方法在密度 $n_{\\bullet}$ 上计算得到的总能量。\n\n- 在一个非常大的基组中的近乎精确的参考值（例如，完全基组极限下的完全组态相互作用）：$E_{\\mathrm{ref}}=-1.000\\,E_{\\mathrm{h}}$。\n- 在一个非常大的基组中自洽计算的半局域广义梯度近似 (GGA)，特别是 Perdew–Burke–Ernzerhof (PBE)：$E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}]=-1.030\\,E_{\\mathrm{h}}$。\n- 在同一个非常大的基组中获得的非限制 Hartree–Fock (UHF) 密度上非自洽计算的 PBE 能量：$E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}]=-1.008\\,E_{\\mathrm{h}}$。\n- 在一个最小基组中自洽计算的全局杂化泛函（例如 PBE0）：$E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}}=-0.990\\,E_{\\mathrm{h}}$。\n- 在同一个 UHF 密度上计算的相同杂化泛函能量，但 UHF 计算和杂化能量评估都限制在同一个最小基组中：$E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}}=-0.991\\,E_{\\mathrm{h}}$。\n\n用于解释的概念提示：\n- 泛函驱动误差指的是即使在精确密度上评估近似泛函时仍会存在的误差（即，它源于泛函形式本身）。\n- 密度驱动误差指的是由于近似势导致近似自洽密度偏离精确密度而产生的额外误差；在实践中，可以通过在更高保真度的密度上评估近似能量时其变化的大小来诊断。\n- 基组不完备性会限制密度和能量的质量，可能掩盖或模仿其他误差来源。\n\n问题：根据以上数据和原理，下列哪些陈述是正确的？\n\nA. 在大基组中，从 $E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}]$ 到 $E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}]$ 的巨大变化表明，对于使用半局域泛函计算的拉伸 H$_2$，密度驱动误差是总误差的一个主要组成部分。\n\nB. $E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}}$ 和 $E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}}$ 的近似相等表明，在最小基组中，对于该杂化泛函，基组不完备性误差比密度驱动误差占主导地位。\n\nC. 在大基组中，$E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}]$ 和 $E_{\\mathrm{ref}}$ 之间的残余差距可归因于泛函驱动误差（例如，半局域形式中缺失的静态相关）。\n\nD. 因为近似能量泛函在其自身的自洽密度处达到最小值，Hohenberg–Kohn 变分原理确保了将 $n_{\\mathrm{approx}}$ 替换为更好的密度（如 $n_{\\mathrm{UHF}}$）不会减少相对于 $E_{\\mathrm{ref}}$ 的总误差。\n\nE. 在最小基组中，密度误差必须主导能量误差，因为基组限制了 $n(\\mathbf{r})$ 的变分空间，因此用 $n_{\\mathrm{UHF}}$ 替换 $n_{\\mathrm{hyb}}$ 必然会产生巨大的能量改善。", "solution": "首先将验证问题陈述的科学性和逻辑合理性。\n\n**步骤 1：提取已知条件**\n\n该问题提供了在键长 $R=3.0\\,\\mathrm{\\AA}$ 下 H$_2$ 基态的以下数据和概念定义：\n\n- **原理：**\n    1.  Hohenberg-Kohn (HK) 定理：基态能量 $E$ 是基态电子密度 $n(\\mathbf{r})$ 的泛函，即 $E=E[n]$，并且由精确的基态密度使其最小化。\n    2.  Kohn-Sham (KS) DFT：一个近似的交换相关泛函 $E_{xc}^{\\mathrm{approx}}[n]$ 会导出一个近似的总能量泛函 $E^{\\mathrm{approx}}[n]$，其自洽最小化结果为一个近似密度 $n_{\\mathrm{approx}}$。\n    3.  基组不完备性误差：有限的单电子基组使允许的密度和轨道空间离散化。\n\n- **能量值 (以 Hartree, $E_{\\mathrm{h}}$ 为单位):**\n    -   在一个非常大的基组中的近乎精确的参考能量：$E_{\\mathrm{ref}} = -1.000\\,E_{\\mathrm{h}}$。\n    -   在一个非常大的基组中的 PBE 自洽能量：$E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}] = -1.030\\,E_{\\mathrm{h}}$。\n    -   在同一个非常大的基组中的 UHF 密度上计算的 PBE 能量：$E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}] = -1.008\\,E_{\\mathrm{h}}$。\n    -   在一个最小基组中的全局杂化泛函自洽能量：$E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}} = -0.990\\,E_{\\mathrm{h}}$。\n    -   在同一个最小基组中的 UHF 密度上计算的全局杂化泛函能量：$E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}} = -0.991\\,E_{\\mathrm{h}}$。\n\n- **误差定义：**\n    -   **泛函驱动误差：**当在精确密度上评估一个近似泛函时剩余的误差。\n    -   **密度驱动误差：**由近似自洽密度偏离精确密度而产生的额外误差。\n    -   **基组不完备性误差：**由使用有限基组引起的误差。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n根据验证标准对问题进行评估。\n\n-   **科学基础：**该问题牢固地植根于密度泛函理论和量子化学的原理。拉伸 H$_2$ 的情景是用于说明半局域泛函因静态相关而失效的典型例子，这是一个公认的概念。泛函驱动误差和密度驱动误差的定义在现代 DFT 文献中是标准的。\n-   **问题明确：**该问题提供了一组清晰的数值数据和定义，并要求基于这些信息评估几个陈述。问题的结构清晰，可以从所提供的数据中推导出确定的正确和错误答案。\n-   **客观性：**语言技术性强、精确且不含主观性。\n-   **自洽且一致：**所有必要的数据和定义都已提供。注意到数据点 $E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}} = -0.991 E_{\\mathrm{h}}$ 比自洽能量 $E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}} = -0.990 E_{\\mathrm{h}}$ 更低。这意味着 $E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}}  E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}}$，这表面上违反了应用于近似泛函 $E_{\\mathrm{hyb}}$ 的变分原理，是一个潜在的矛盾。然而，在实践中，数值噪音或收敛到非最小的鞍点可能导致这种微小的表面上的违规。鉴于这是一个概念性问题且数值很小 ($0.001\\,E_{\\mathrm{h}}$)，这个微小的不一致性不影响对选项背后逻辑的评估，因为评估主要依赖于能量差异的量级，而不是其确切符号。因此，该问题被认定为可供分析的**有效**问题。\n\n**求解推导**\n\n近似 DFT 计算的总误差 $\\Delta E_{\\mathrm{tot}}$ 可以分解为泛函驱动误差 $\\Delta E_F$ 和密度驱动误差 $\\Delta E_D$。\n总误差分解如下：\n$$ \\Delta E_{\\mathrm{tot}} = \\underbrace{\\left( E_{\\mathrm{approx}}[n_{\\mathrm{approx}}] - E_{\\mathrm{approx}}[n_{\\mathrm{exact}}] \\right)}_{\\Delta E_D} + \\underbrace{\\left( E_{\\mathrm{approx}}[n_{\\mathrm{exact}}] - E_{\\mathrm{exact}}[n_{\\mathrm{exact}}] \\right)}_{\\Delta E_F} $$\n在实践中，$n_{\\mathrm{exact}}$ 是未知的。我们使用一个高质量的参考密度，这里用大基组得到的 $n_{\\mathrm{UHF}}$ 来近似，以估算这些分量。因此：\n$$ \\Delta E_D \\approx E_{\\mathrm{approx}}[n_{\\mathrm{approx}}] - E_{\\mathrm{approx}}[n_{\\mathrm{UHF}}] $$\n$$ \\Delta E_F \\approx E_{\\mathrm{approx}}[n_{\\mathrm{UHF}}] - E_{\\mathrm{ref}} $$\n\n**大基组中 PBE 的分析：**\n- 总误差：$\\Delta E_{\\mathrm{tot, PBE}} = E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}] - E_{\\mathrm{ref}} = -1.030 - (-1.000) = -0.030\\,E_{\\mathrm{h}}$。\n- 近似密度驱动误差：$\\Delta E_{D, \\mathrm{PBE}} \\approx E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}] - E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}] = -1.030 - (-1.008) = -0.022\\,E_{\\mathrm{h}}$。\n- 近似泛函驱动误差：$\\Delta E_{F, \\mathrm{PBE}} \\approx E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}] - E_{\\mathrm{ref}} = -1.008 - (-1.000) = -0.008\\,E_{\\mathrm{h}}$。\n\n这些近似分量的总和是 $(-0.022) + (-0.008) = -0.030\\,E_{\\mathrm{h}}$，与总误差相符。密度驱动误差的量级 $|-0.022| = 0.022\\,E_{\\mathrm{h}}$，与总误差的量级 $|-0.030| = 0.030\\,E_{\\mathrm{h}}$ 相比是相当大的。\n\n**最小基组中杂化泛函的分析：**\n- 最小基组内的近似密度驱动误差：$\\Delta E_{D, \\mathrm{hyb}} \\approx E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}} - E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}} = -0.990 - (-0.991) = +0.001\\,E_{\\mathrm{h}}$。\n该误差分量的量级极小，为 $0.001\\,E_{\\mathrm{h}}$。\n\n**逐项分析**\n\n**A. 在大基组中，从 $E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}]$ 到 $E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}]$ 的巨大变化表明，对于使用半局域泛函计算的拉伸 H$_2$，密度驱动误差是总误差的一个主要组成部分。**\n将自洽 PBE 密度替换为 UHF 密度后的能量变化是 $E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}] - E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}] = -1.008 - (-1.030) = +0.022\\,E_{\\mathrm{h}}$。这个变化估算了密度驱动误差的相反数。其量级为 $0.022\\,E_{\\mathrm{h}}$，约占总误差量级 ($0.030\\,E_{\\mathrm{h}}$) 的 $73\\%$。这无疑是一个“主要组成部分”。这种情况是静态相关误差的典型特征，即半局域泛函产生了一个定性上不正确、过度离域的密度，从而导致了巨大的密度驱动误差。\n**结论：正确。**\n\n**B. $E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}}$ 和 $E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}}$ 的近似相等表明，在最小基组中，对于该杂化泛函，基组不完备性误差比密度驱动误差占主导地位。**\n能量差异为 $|-0.990 - (-0.991)| = 0.001\\,E_{\\mathrm{h}}$。这一近乎为零的变化意味着，*在此基组内*，从自洽密度切换到 UHF 密度的能量后果可以忽略不计。最小基组严重限制了电子密度的灵活性。它太小了，无法表示 $n_{\\mathrm{hyb}}$ 和 $n_{\\mathrm{UHF}}$ 之间的显著差异。因此，计算中观察到的误差——与精确能量的巨大偏差 ($E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}} - E_{\\mathrm{ref}} = -0.990 - (-1.000) = +0.010\\,E_{\\mathrm{h}}$)——并非由于在*允许空间内*选择了糟糕的密度，而是由于该空间本身的不充分性。这种不充分性就是基组不完备性误差。该陈述准确地得出结论：可观察到的微小密度驱动误差表明基组误差是主导因素。\n**结论：正确。**\n\n**C. 在大基组中，$E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}]$ 和 $E_{\\mathrm{ref}}$ 之间的残余差距可归因于泛函驱动误差（例如，半局域形式中缺失的静态相关）。**\n该差距为 $E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}] - E_{\\mathrm{ref}} = -1.008 - (-1.000) = -0.008\\,E_{\\mathrm{h}}$。这个量代表了 PBE 泛函在更高保真度的密度 ($n_{\\mathrm{UHF}}$) 上评估时的误差，这是我们对泛函驱动误差的最佳近似。这个误差源于 PBE 泛函本身的内在数学形式，特别是即使在提供了定性正确的密度的情况下，它也无法正确描述拉伸 H$_2$ 键的多参考性质（静态相关）。\n**结论：正确。**\n\n**D. 因为近似能量泛函在其自身的自洽密度处达到最小值，Hohenberg–Kohn 变分原理确保了将 $n_{\\mathrm{approx}}$ 替换为更好的密度（如 $n_{\\mathrm{UHF}}$）不会减少相对于 $E_{\\mathrm{ref}}$ 的总误差。**\n该陈述混淆了两个不同的变分原理。对于一个*近似*泛函 $E_{\\mathrm{approx}}[n]$ 的变分原理指出，对于任何其他密度 $n$，$E_{\\mathrm{approx}}[n_{\\mathrm{approx}}] \\le E_{\\mathrm{approx}}[n]$。这对于 PBE 是成立的：$E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}] = -1.030\\,E_{\\mathrm{h}}$ 确实低于 $E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}] = -1.008\\,E_{\\mathrm{h}}$。然而，Hohenberg-Kohn 变分原理适用于*精确*泛函，保证 $E_{\\mathrm{exact}}[n] \\ge E_{\\mathrm{ref}}$。没有任何原理能保证 $E_{\\mathrm{approx}}[n_{\\mathrm{approx}}]$ 比 $E_{\\mathrm{approx}}[n_{\\text{other}}]$ 更接近 $E_{\\mathrm{ref}}$。数据明确地反驳了该陈述的结论。使用自洽密度的总误差为 $|-1.030 - (-1.000)| = 0.030\\,E_{\\mathrm{h}}$。使用 UHF 密度的总误差为 $|-1.008 - (-1.000)| = 0.008\\,E_{\\mathrm{h}}$。通过替换密度，误差*确实*减少了。\n**结论：不正确。**\n\n**E. 在最小基组中，密度误差必须主导能量误差，因为基组限制了 $n(\\mathbf{r})$ 的变分空间，因此用 $n_{\\mathrm{UHF}}$ 替换 $n_{\\mathrm{hyb}}$ 必然会产生巨大的能量改善。**\n该陈述包含错误的推理和与数据相矛盾的结论。其前提，即限制变分空间会导致密度误差占主导地位，是错误的；实际上，它*抑制*了系统表达不同密度的能力，从而使得可观察到的密度驱动误差变小，正如对选项 B 的分析所示。其结论，即替换密度“必然会产生巨大的能量改善”，也为数据所证伪：能量变化为 $E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}} - E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}} = +0.001\\,E_{\\mathrm{h}}$，这是一个可以忽略不计的变化，而非巨大的改善。\n**结论：不正确。**", "answer": "$$\\boxed{ABC}$$", "id": "2453913"}]}