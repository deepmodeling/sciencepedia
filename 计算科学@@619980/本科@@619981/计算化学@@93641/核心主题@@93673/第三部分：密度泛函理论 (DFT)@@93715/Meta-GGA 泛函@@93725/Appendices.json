{"hands_on_practices": [{"introduction": "我们的第一个练习是一个概念性的检验，旨在巩固对 meta-GGA 泛函关键成分之一的理解。Meta-GGA 的一个核心思想是利用动能密度 $\\tau$ 来区分不同的化学环境。此练习探讨了冯·魏茨泽克 (von Weizsäcker) 动能密度 $\\tau_W$ 与精确的科恩-尚 (Kohn-Sham) 动能密度 $\\tau$ 之间的关系，揭示了 meta-GGA 设计中的一个重要物理极限。", "problem": "在计算化学中使用的 meta-广义梯度近似 (meta-GGA) 密度泛函中，动能密度是一个关键组成部分。考虑一个在 Kohn-Sham 密度泛函理论 (DFT) 框架内描述的非相对论性、自旋补偿体系。将 Kohn-Sham 动能密度定义为\n$$\\tau(\\mathbf{r}) = \\frac{1}{2}\\sum_{i} \\left|\\nabla \\psi_i(\\mathbf{r})\\right|^2,$$\n其中求和遍及所有被占据的 Kohn-Sham 轨道 $\\psi_i(\\mathbf{r})$，且电子密度为\n$$\\rho(\\mathbf{r}) = \\sum_{i} \\left|\\psi_i(\\mathbf{r})\\right|^2.$$\nvon Weizsäcker 动能密度为\n$$\\tau_W(\\mathbf{r}) = \\frac{\\left|\\nabla \\rho(\\mathbf{r})\\right|^2}{8\\,\\rho(\\mathbf{r})}.$$\n在什么极限下，$\\tau_W(\\mathbf{r})$ 会成为 $\\tau(\\mathbf{r})$ 的精确表达式？\n\nA. 均匀电子气极限，其中 $\\rho(\\mathbf{r})$ 为常数。\n\nB. 单轨道 (等轨道) 极限，例如单电子密度或占据一个空间轨道的双电子单重态，且顺磁电流为零。\n\nC. 在约化梯度固定的情况下，高密度极限 $\\rho(\\mathbf{r}) \\to \\infty$。\n\nD. 任何具有球对称性但 $\\rho(\\mathbf{r})$ 随空间变化的的多电子闭壳层原子。\n\nE. 作为二阶梯度展开基础的缓慢变化密度极限。", "solution": "验证问题陈述是必须的第一步。\n\n**第1步：提取已知信息**\n\n提供的明确信息是：\n- 体系：非相对论性、自旋补偿。\n- 框架：Kohn-Sham 密度泛函理论 (DFT)。\n- Kohn-Sham 动能密度：$$\\tau(\\mathbf{r}) = \\frac{1}{2}\\sum_{i} \\left|\\nabla \\psi_i(\\mathbf{r})\\right|^2,$$ 其中求和遍及所有被占据的 Kohn-Sham 轨道 $\\psi_i(\\mathbf{r})$。\n- 电子密度：$$\\rho(\\mathbf{r}) = \\sum_{i} \\left|\\psi_i(\\mathbf{r})\\right|^2.$$\n- von Weizsäcker 动能密度：$$\\tau_W(\\mathbf{r}) = \\frac{\\left|\\nabla \\rho(\\mathbf{r})\\right|^2}{8\\,\\rho(\\mathbf{r})}.$$\n- 问题：确定在什么极限下 $\\tau_W(\\mathbf{r})$ 是 $\\tau(\\mathbf{r})$ 的精确表达式。\n\n**第2步：使用提取的已知信息进行验证**\n\n- **科学依据**：该问题设定在标准的 Kohn-Sham DFT 框架内。电子密度 $\\rho(\\mathbf{r})$、（正定）动能密度 $\\tau(\\mathbf{r})$ 以及 von Weizsäcker 动能密度 $\\tau_W(\\mathbf{r})$ 的定义在计算化学和物理学的文献中都是标准且正确的。\n- **问题的适定性**：问题要求确定一个特定的物理或数学极限，在该极限下两个明确定义的量相等。这是一个清晰且可回答的问题。\n- **客观性**：问题使用精确的技术语言陈述，没有歧义或主观内容。\n\n问题陈述在科学上是合理的、自洽的、客观的且适定的。不存在矛盾、缺失数据或违反基本原理的情况。\n\n**第3步：结论与行动**\n\n问题是**有效的**。开始求解。\n\n**解答的推导**\n\n目标是找出使 $\\tau(\\mathbf{r}) = \\tau_W(\\mathbf{r})$ 成立的条件。让我们分析一个电子密度由单个被双电子占据的空间轨道 $\\psi(\\mathbf{r})$ 产生的体系。这就是选项 B 中提到的“占据一个空间轨道的双电子单重态”。对于一个自旋补偿体系，被占据的 Kohn-Sham 轨道是 $\\psi_1(\\mathbf{r}) = \\psi(\\mathbf{r})\\alpha$ 和 $\\psi_2(\\mathbf{r}) = \\psi(\\mathbf{r})\\beta$。\n\n电子密度为：\n$$\\rho(\\mathbf{r}) = |\\psi(\\mathbf{r})|^2 + |\\psi(\\mathbf{r})|^2 = 2|\\psi(\\mathbf{r})|^2$$\n\nKohn-Sham 动能密度为：\n$$\\tau(\\mathbf{r}) = \\frac{1}{2} \\left( |\\nabla \\psi(\\mathbf{r})|^2 + |\\nabla \\psi(\\mathbf{r})|^2 \\right) = |\\nabla \\psi(\\mathbf{r})|^2$$\n\n现在，我们计算该体系的 von Weizsäcker 动能密度 $\\tau_W(\\mathbf{r})$。首先，我们求密度的梯度 $\\nabla \\rho(\\mathbf{r})$。通常，一个复数轨道可以写成 $\\psi(\\mathbf{r}) = R(\\mathbf{r})e^{i\\phi(\\mathbf{r})}$，其中 $R(\\mathbf{r})$ 和 $\\phi(\\mathbf{r})$ 是实函数。那么 $\\rho(\\mathbf{r}) = 2R(\\mathbf{r})^2$。\n\n密度的梯度是：\n$$\\nabla \\rho(\\mathbf{r}) = \\nabla(2R(\\mathbf{r})^2) = 4R(\\mathbf{r})\\nabla R(\\mathbf{r})$$\n\n其大小的平方是：\n$$|\\nabla \\rho(\\mathbf{r})|^2 = 16R(\\mathbf{r})^2|\\nabla R(\\mathbf{r})|^2$$\n\n将此代入 $\\tau_W(\\mathbf{r})$ 的定义中：\n$$\\tau_W(\\mathbf{r}) = \\frac{|\\nabla \\rho(\\mathbf{r})|^2}{8\\rho(\\mathbf{r})} = \\frac{16R(\\mathbf{r})^2|\\nabla R(\\mathbf{r})|^2}{8(2R(\\mathbf{r})^2)} = |\\nabla R(\\mathbf{r})|^2$$\n\n现在让我们将 $\\tau(\\mathbf{r})$ 与 $R(\\mathbf{r})$ 联系起来。\n$$\\nabla\\psi(\\mathbf{r}) = \\nabla(R(\\mathbf{r})e^{i\\phi(\\mathbf{r})}) = (\\nabla R)e^{i\\phi} + iR(\\nabla\\phi)e^{i\\phi}$$\n$$|\\nabla\\psi(\\mathbf{r})|^2 = |\\nabla R|^2 + R^2|\\nabla\\phi|^2$$\n因为 $\\tau(\\mathbf{r}) = |\\nabla\\psi(\\mathbf{r})|^2$，我们有：\n$$\\tau(\\mathbf{r}) = |\\nabla R(\\mathbf{r})|^2 + R(\\mathbf{r})^2|\\nabla\\phi(\\mathbf{r})|^2$$\n\n比较 $\\tau(\\mathbf{r})$ 和 $\\tau_W(\\mathbf{r})$，我们看到：\n$$\\tau(\\mathbf{r}) = \\tau_W(\\mathbf{r}) + R(\\mathbf{r})^2|\\nabla\\phi(\\mathbf{r})|^2 = \\tau_W(\\mathbf{r}) + \\frac{\\rho(\\mathbf{r})}{2}|\\nabla\\phi(\\mathbf{r})|^2$$\n等式 $\\tau(\\mathbf{r}) = \\tau_W(\\mathbf{r})$ 成立的充要条件是第二项为零。这发生在 $\\nabla\\phi(\\mathbf{r}) = 0$ 时，意味着相位 $\\phi(\\mathbf{r})$ 是一个常数。一个具有恒定相位的轨道可以通过全局相位变换变为纯实数。非恒定的相位 $\\phi(\\mathbf{r})$ 会产生非零的顺磁电流密度，其与 $\\rho\\nabla\\phi$ 成正比。因此，对于顺磁电流为零的单轨道体系，该等式成立。\n\n对于单电子体系，也可以得到相同的结果，其中 $\\rho = |\\psi|^2$ 和 $\\tau = \\frac{1}{2}|\\nabla\\psi|^2$。遵循相同的步骤，在轨道为实值（或常数相位）的相同条件下，会得出 $\\tau(\\mathbf{r})=\\tau_W(\\mathbf{r})$。\n\n这个一般条件被称为单轨道或等轨道极限。\n\n**选项评估**\n\n**A. 均匀电子气极限，其中 $\\rho(\\mathbf{r})$ 为常数。**\n如果 $\\rho(\\mathbf{r})$ 是一个非零常数，则 $\\nabla\\rho(\\mathbf{r}) = 0$。这立即导致 $\\tau_W(\\mathbf{r}) = 0$。然而，对于均匀电子气（在均匀正电荷背景中的相互作用电子体系），动能密度是非零的。其轨道是平面波，$\\psi_{\\mathbf{k}}(\\mathbf{r}) \\propto e^{i\\mathbf{k}\\cdot\\mathbf{r}}$，动能密度是有限的，由 Thomas-Fermi 表达式给出，$\\tau_{TF}(\\mathbf{r}) = \\frac{3}{10}(3\\pi^2)^{2/3}\\rho^{5/3} > 0$。由于 $\\tau(\\mathbf{r}) > 0$ 而 $\\tau_W(\\mathbf{r}) = 0$，这两个量不相等。\n结论：**错误**。\n\n**B. 单轨道 (等轨道) 极限，例如单电子密度或占据一个空间轨道的双电子单重态，且顺磁电流为零。**\n如上文推导所示，这正是 $\\tau(\\mathbf{r}) = \\tau_W(\\mathbf{r})$ 精确成立的条件。“等轨道”一词指的是空间中的任何区域或任何体系，其密度由单个轨道决定。“顺磁电流为零”的规定确保了轨道可以被视为实数，这是等式成立的必要条件。\n结论：**正确**。\n\n**C. 在约化梯度固定的情况下，高密度极限 $\\rho(\\mathbf{r}) \\to \\infty$。**\n在高密度极限下，动能密度 $\\tau(\\mathbf{r})$ 趋近于 Thomas-Fermi 形式，$\\tau(\\mathbf{r}) \\to \\tau_{TF}(\\mathbf{r}) = C_{TF}\\rho^{5/3}$，其中 $C_{TF} = \\frac{3}{10}(3\\pi^2)^{2/3}$。相比之下，$\\tau_W(\\mathbf{r}) = \\frac{|\\nabla\\rho|^2}{8\\rho}$。这两个表达式对 $\\rho$ 及其梯度的依赖性不同，通常不相等。例如，对于均匀电子气（一个高密度体系），$\\tau \\to \\tau_{TF} > 0$ 而 $\\tau_W = 0$。\n结论：**错误**。\n\n**D. 任何具有球对称性但 $\\rho(\\mathbf{r})$ 随空间变化的的多电子闭壳层原子。**\n考虑一个多电子原子，例如氖（10个电子，构型为 $1s^2 2s^2 2p^6$）。其密度是来自多个轨道的贡献之和：$\\rho = 2|\\psi_{1s}|^2 + 2|\\psi_{2s}|^2 + 6|\\psi_{2p}|^2$。动能密度为 $\\tau = |\\nabla\\psi_{1s}|^2 + |\\nabla\\psi_{2s}|^2 + 3|\\nabla\\psi_{2p}|^2$。$\\tau_W$ 的表达式涉及 $(\\nabla\\rho)^2$，它将包含不同轨道之间的交叉项（例如，$(\\nabla|\\psi_{1s}|^2)(\\nabla|\\psi_{2s}|^2)$）。没有简单的代数关系能让 $\\tau_W = \\tau$ 对所有 $\\mathbf{r}$ 都成立。该等式仅在某个轨道对密度的贡献占绝对主导地位的区域成立，例如在原子核深处（$1s$）或在原子尾部（最高占据分子轨道，$2p$），这些是等轨道极限的特例。对于“任何”此类原子，该等式在整个空间上并不成立。\n结论：**错误**。\n\n**E. 作为二阶梯度展开基础的缓慢变化密度极限。**\n这个极限是梯度展开近似 (GEA) 的基础。在此极限下，动能密度近似为 $\\tau(\\mathbf{r}) \\approx \\tau_{TF}(\\mathbf{r}) + \\frac{1}{72}\\frac{|\\nabla\\rho|^2}{\\rho} + \\dots$，即 $\\tau(\\mathbf{r}) \\approx \\tau_{TF}(\\mathbf{r}) + \\frac{1}{9}\\tau_W(\\mathbf{r}) + \\dots$。这与 $\\tau_W(\\mathbf{r})$ 有着根本的不同。缓慢变化极限（其中 $\\tau \\approx \\tau_{TF} \\gg \\tau_W$）实际上与单轨道极限（一个快速变化的例子，其中 $\\tau = \\tau_W \\gg \\tau_{TF}$）相反。\n结论：**错误**。", "answer": "$$\\boxed{B}$$", "id": "2457647"}, {"introduction": "在理解了 $\\tau$ 和 $\\tau_W$ 的概念基础之后，下一个实践将这些抽象的公式付诸实践。我们将为一个原子在空间中的一个特定点，逐步手动计算 meta-GGA 交换能密度的所有组成部分。这个练习将帮助你熟悉各种中间变量，例如无量纲密度梯度 $s$ 和等轨道指示因子 $\\alpha$，并直观地感受它们如何共同构成最终的能量密度值。", "problem": "考虑一个闭壳层氖原子在数值求积网格上的单个实空间积分点 $\\mathbf{r}$，该体系在 Kohn-Sham 密度泛函理论 (DFT) 框架下使用 meta-广义梯度近似 (meta-GGA) 交换泛函进行处理。假设该点的密度是自旋非极化的，因此自旋向上和自旋向下密度相等。完全使用原子单位（能量单位为 Hartree，长度单位为 Bohr），并将在 $\\mathbf{r}$ 点的以下物理量视为已知：\n- 电子密度 $n(\\mathbf{r}) = 0.200$，\n- 密度梯度大小 $\\lvert \\nabla n(\\mathbf{r}) \\rvert = 0.350$，\n- Kohn-Sham 轨道动能密度 $\\tau(\\mathbf{r}) = 0.150$。\n\n从均匀电子气的第一性原理和 meta-GGA 的标准组分出发，通过以下定义来得到 meta-GGA 交换能量密度 $e_{x}^{\\text{meta}}(\\mathbf{r})$：\n1. 密度为 $n(\\mathbf{r})$ 的均匀电子气的费米波矢 $k_{F}(\\mathbf{r})$ 为 $k_{F}(\\mathbf{r}) = \\big(3\\pi^{2} n(\\mathbf{r})\\big)^{1/3}$。\n2. 约化密度梯度 $s(\\mathbf{r})$ 为 $s(\\mathbf{r}) = \\dfrac{\\lvert \\nabla n(\\mathbf{r}) \\rvert}{2 k_{F}(\\mathbf{r})\\, n(\\mathbf{r})}$。\n3. von Weizsäcker 动能密度为 $\\tau_{W}(\\mathbf{r}) = \\dfrac{\\lvert \\nabla n(\\mathbf{r}) \\rvert^{2}}{8\\, n(\\mathbf{r})}$。\n4. 均匀电子气动能密度为 $\\tau_{\\text{unif}}(\\mathbf{r}) = \\dfrac{3}{10}\\big(3\\pi^{2}\\big)^{2/3} n(\\mathbf{r})^{5/3}$。\n5. 等轨道指示因子为 $\\alpha(\\mathbf{r}) = \\dfrac{\\tau(\\mathbf{r}) - \\tau_{W}(\\mathbf{r})}{\\tau_{\\text{unif}}(\\mathbf{r})}$。\n6. 局域密度近似 (LDA) 交换能量密度为 $e_{x}^{\\text{LDA}}(\\mathbf{r}) = - C_{x}\\, n(\\mathbf{r})^{4/3}$，其中 $C_{x} = \\dfrac{3}{4}\\big(\\dfrac{3}{\\pi}\\big)^{1/3}$。\n7. meta-GGA 交换增强因子（在本问题中）定义为\n$$\nF_{x}\\big(s(\\mathbf{r}), \\alpha(\\mathbf{r})\\big) \\;=\\; 1 + \\kappa \\;-\\; \\dfrac{\\kappa}{1 + \\mu\\, s(\\mathbf{r})^{2} + \\beta\\, \\alpha(\\mathbf{r})},\n$$\n其中常数 $\\kappa = 0.804$，$\\mu = 0.21951$，且 $\\beta = 0.100$。\n8. meta-GGA 交换能量密度为 $e_{x}^{\\text{meta}}(\\mathbf{r}) = e_{x}^{\\text{LDA}}(\\mathbf{r}) \\, F_{x}\\big(s(\\mathbf{r}), \\alpha(\\mathbf{r})\\big)$。\n\n使用所提供的值，数值计算 $e_{x}^{\\text{meta}}(\\mathbf{r})$。将您的最终答案表示为一个以 $\\text{Hartree}/\\text{Bohr}^3$ 为单位的数字，并四舍五入到四位有效数字。", "solution": "题干被确认为自洽的，科学上基于 Kohn-Sham 密度泛函理论的原理，并且在数值上是适定的。所有必需的常数、变量和泛函形式都已明确给出，可以直接进行明确的计算。存在唯一解，该解将通过系统地应用给定定义来推导得出。\n\n在原子单位制下，我们在 $\\mathbf{r}$ 点有以下给定的局域物理量：\n- 电子密度：$n(\\mathbf{r}) = 0.200$\n- 密度梯度大小：$\\lvert \\nabla n(\\mathbf{r}) \\rvert = 0.350$\n- Kohn-Sham 轨道动能密度：$\\tau(\\mathbf{r}) = 0.150$\n\n计算按定义的步骤顺序进行。\n\n1.  计算费米波矢 $k_{F}(\\mathbf{r})$。\n    均匀电子气的费米波矢公式为 $k_{F}(\\mathbf{r}) = \\big(3\\pi^{2} n(\\mathbf{r})\\big)^{1/3}$。\n    代入给定的电子密度 $n(\\mathbf{r}) = 0.200$：\n    $$k_{F}(\\mathbf{r}) = \\big(3\\pi^{2} \\times 0.200\\big)^{1/3} = (0.6\\pi^{2})^{1/3} \\approx 1.80918$$\n\n2.  计算约化密度梯度 $s(\\mathbf{r})$。\n    所提供的定义为 $s(\\mathbf{r}) = \\dfrac{\\lvert \\nabla n(\\mathbf{r}) \\rvert}{2 k_{F}(\\mathbf{r})\\, n(\\mathbf{r})}$。\n    使用给定值和计算出的 $k_{F}(\\mathbf{r})$：\n    $$s(\\mathbf{r}) = \\dfrac{0.350}{2 \\times 1.80918 \\times 0.200} \\approx \\dfrac{0.350}{0.723672} \\approx 0.48364$$\n\n3.  计算 von Weizsäcker 动能密度 $\\tau_{W}(\\mathbf{r})$。\n    其定义为 $\\tau_{W}(\\mathbf{r}) = \\dfrac{\\lvert \\nabla n(\\mathbf{r}) \\rvert^{2}}{8\\, n(\\mathbf{r})}$。\n    代入给定值：\n    $$\\tau_{W}(\\mathbf{r}) = \\dfrac{(0.350)^{2}}{8 \\times 0.200} = \\dfrac{0.1225}{1.6} = 0.0765625$$\n\n4.  计算均匀电子气动能密度 $\\tau_{\\text{unif}}(\\mathbf{r})$。\n    其公式为 $\\tau_{\\text{unif}}(\\mathbf{r}) = \\dfrac{3}{10}\\big(3\\pi^{2}\\big)^{2/3} n(\\mathbf{r})^{5/3}$。\n    代入 $n(\\mathbf{r}) = 0.200$：\n    $$\\tau_{\\text{unif}}(\\mathbf{r}) = \\dfrac{3}{10}\\big(3\\pi^{2}\\big)^{2/3} (0.200)^{5/3} \\approx 0.3 \\times 9.58231 \\times 0.068399 \\approx 0.196388$$\n\n5.  计算等轨道指示因子 $\\alpha(\\mathbf{r})$。\n    其定义为 $\\alpha(\\mathbf{r}) = \\dfrac{\\tau(\\mathbf{r}) - \\tau_{W}(\\mathbf{r})}{\\tau_{\\text{unif}}(\\mathbf{r})}$。\n    使用给定的 $\\tau(\\mathbf{r})$ 和计算出的 $\\tau_{W}(\\mathbf{r})$ 和 $\\tau_{\\text{unif}}(\\mathbf{r})$：\n    $$\\alpha(\\mathbf{r}) = \\dfrac{0.150 - 0.0765625}{0.196388} = \\dfrac{0.0734375}{0.196388} \\approx 0.37394$$\n\n6.  计算局域密度近似 (LDA) 交换能量密度 $e_{x}^{\\text{LDA}}(\\mathbf{r})$。\n    其公式为 $e_{x}^{\\text{LDA}}(\\mathbf{r}) = - C_{x}\\, n(\\mathbf{r})^{4/3}$，其中常数 $C_{x} = \\dfrac{3}{4}\\big(\\dfrac{3}{\\pi}\\big)^{1/3}$。\n    首先，我们计算 $C_x$：\n    $$C_{x} = \\dfrac{3}{4}\\big(\\dfrac{3}{\\pi}\\big)^{1/3} \\approx 0.75 \\times (0.95493)^{1/3} \\approx 0.75 \\times 0.984745 \\approx 0.73856$$\n    现在，我们计算 $e_{x}^{\\text{LDA}}(\\mathbf{r})$：\n    $$e_{x}^{\\text{LDA}}(\\mathbf{r}) = - (0.73856) \\times (0.200)^{4/3} \\approx -0.73856 \\times 0.11696 \\approx -0.086383$$\n\n7.  计算 meta-GGA 交换增强因子 $F_{x}\\big(s(\\mathbf{r}), \\alpha(\\mathbf{r})\\big)$。\n    题目指定的形式为 $F_{x} = 1 + \\kappa - \\dfrac{\\kappa}{1 + \\mu\\, s(\\mathbf{r})^{2} + \\beta\\, \\alpha(\\mathbf{r})}$，其中常数 $\\kappa = 0.804$，$\\mu = 0.21951$，且 $\\beta = 0.100$。\n    我们代入计算出的 $s(\\mathbf{r})$ 和 $\\alpha(\\mathbf{r})$ 的值：\n    $$F_{x} = 1 + 0.804 - \\dfrac{0.804}{1 + (0.21951)(0.48364)^{2} + (0.100)(0.37394)}$$\n    $$F_{x} = 1.804 - \\dfrac{0.804}{1 + (0.21951)(0.233908) + 0.037394}$$\n    $$F_{x} = 1.804 - \\dfrac{0.804}{1 + 0.051346 + 0.037394} = 1.804 - \\dfrac{0.804}{1.08874} \\approx 1.804 - 0.73847 \\approx 1.06553$$\n\n8.  计算最终的 meta-GGA 交换能量密度 $e_{x}^{\\text{meta}}(\\mathbf{r})$。\n    这是 LDA 能量密度与增强因子的乘积：$e_{x}^{\\text{meta}}(\\mathbf{r}) = e_{x}^{\\text{LDA}}(\\mathbf{r}) \\, F_{x}\\big(s(\\mathbf{r}), \\alpha(\\mathbf{r})\\big)$。\n    $$e_{x}^{\\text{meta}}(\\mathbf{r}) \\approx -0.086383 \\times 1.06553 \\approx -0.092036$$\n\n题目要求最终答案四舍五入到四位有效数字。\n计算值为 $-0.092036$。将其四舍五入到四位有效数字得到 $-0.09204$。", "answer": "$$\\boxed{-0.09204}$$", "id": "2457672"}, {"introduction": "最后一个练习是一个综合性的计算任务，它展示了 meta-GGA 如何利用动能密度信息来适应不同的化学键合情况。你将分析一个类似 TPSS 泛函中的“切换函数”，这个函数依赖于等轨道指示因子 $\\alpha$ 在单轨道区域（如原子核附近）和缓变密度区域（如化学键中部）之间进行平滑插值。通过在不同模型体系中计算这个函数的“活性”，你将深刻理解 meta-GGA 泛函能够实现更高准确性的设计哲学。", "problem": "要求您在一个受控且完全指定的设定下，研究 Tao–Perdew–Staroverov–Scuseria (TPSS) meta-广义梯度近似中转换函数的作用，方法是对于由归一化高斯轨道构建的模型体系，量化其在何处最为活跃。所有计算均需在 Hartree 原子单位下进行。\n\n一个具有空间轨道 $\\{\\phi_n(\\mathbf{r})\\}$ 的自旋非极化、闭壳层 Kohn–Sham 体系，其电子密度为 $\\rho(\\mathbf{r}) = 2 \\sum_n |\\phi_n(\\mathbf{r})|^2$，正定动能密度为 $\\tau(\\mathbf{r}) = \\sum_n |\\nabla \\phi_n(\\mathbf{r})|^2$。von Weizsäcker 动能密度为 $\\tau_{\\mathrm{W}}(\\mathbf{r}) = \\dfrac{|\\nabla \\rho(\\mathbf{r})|^2}{8\\,\\rho(\\mathbf{r})}$（对于 $\\rho(\\mathbf{r})>0$），均匀电子气动能密度为 $\\tau_{\\mathrm{unif}}(\\mathbf{r}) = \\dfrac{3}{10}\\left(3\\pi^2\\right)^{2/3}\\rho(\\mathbf{r})^{5/3}$。等轨道指示因子为\n$$\n\\alpha(\\mathbf{r}) = \\frac{\\tau(\\mathbf{r}) - \\tau_{\\mathrm{W}}(\\mathbf{r})}{\\tau_{\\mathrm{unif}}(\\mathbf{r})},\n$$\n约定当 $\\rho(\\mathbf{r})=0$ 时，$\\alpha(\\mathbf{r})=0$。\n\n考虑一个理想化的类 TPSS 转换函数（一个在单轨道极限和缓变极限之间的平滑内插函数）\n$$\nw(\\alpha) = \\frac{\\alpha^2}{1+\\alpha^2},\n$$\n其导数为\n$$\nw'(\\alpha) = \\frac{2\\alpha}{\\left(1+\\alpha^2\\right)^2}。\n$$\n令 $w'_{\\max}$ 表示当 $\\alpha\\ge 0$ 时 $w'(\\alpha)$ 的全局最大值。定义局域活跃度指示因子\n$$\nA(\\mathbf{r}) =\n\\begin{cases}\n1, & \\text{若 } \\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}} \\text{ 且 } w'(\\alpha(\\mathbf{r})) \\ge \\frac{1}{2}w'_{\\max},\\\\\n0, & \\text{其它情况,}\n\\end{cases}\n$$\n其中 $\\rho_{\\mathrm{cut}} = 10^{-8}$，单位为 $\\text{bohr}^{-3}$。对于一个体系，其活跃分数 $F$ 是 $A(\\mathbf{r})=1$ 的网格点数与 $\\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}}$ 的网格点数之比。\n\n所有空间场必须在一个覆盖立方体 $[-L,L]^3$（其中 $L=6$，单位为 bohr）的均匀笛卡尔网格上进行评估，每个坐标轴使用 $N=33$ 个等距点。\n\n您将为以下三个测试案例（测试套件）评估 $F$ 值，每个案例都完全由第一性原理构造指定：\n\n1. 盒子中的均匀电子气。密度是恒定的，$\\rho(\\mathbf{r})=\\rho_0$，其中 $\\rho_0=0.05\\,\\text{bohr}^{-3}$，因此在所有点上都有 $\\nabla \\rho(\\mathbf{r})=\\mathbf{0}$，$\\tau(\\mathbf{r})=\\tau_{\\mathrm{unif}}(\\mathbf{r})$ 和 $\\tau_{\\mathrm{W}}(\\mathbf{r})=0$。\n\n2. 单轨道类原子体系。一个位于原点的、双占据的归一化 s 型高斯空间轨道，\n$$\n\\phi(\\mathbf{r}) = \\mathcal{N}\\, e^{-a|\\mathbf{r}|^2}, \\quad \\mathcal{N} = \\left(\\frac{2a}{\\pi}\\right)^{3/4}, \\quad a=0.5，单位为 $\\text{bohr}^{-2}$。\n$$\n\n3. 双中心类双原子体系。两个归一化的 s 型高斯函数，具有相同的指数 $a=0.5$（单位 $\\text{bohr}^{-2}$），中心分别位于 $\\mathbf{R}_A=(0,0,-R/2)$ 和 $\\mathbf{R}_B=(0,0,R/2)$，\n$$\ng_A(\\mathbf{r})=\\mathcal{N}\\,e^{-a|\\mathbf{r}-\\mathbf{R}_A|^2}, \\quad g_B(\\mathbf{r})=\\mathcal{N}\\,e^{-a|\\mathbf{r}-\\mathbf{R}_B|^2},\n$$\n其重叠积分为 $S=\\exp\\!\\left(-\\frac{aR^2}{2}\\right)$。构造标准正交的成键轨道和反键轨道\n$$\n\\phi_b(\\mathbf{r}) = \\frac{g_A(\\mathbf{r})+g_B(\\mathbf{r})}{\\sqrt{2(1+S)}}, \\quad\n\\phi_a(\\mathbf{r}) = \\frac{g_A(\\mathbf{r})-g_B(\\mathbf{r})}{\\sqrt{2(1-S)}},\n$$\n每个轨道都被双占据。对于候选间距 $R \\in \\{0.5,\\,1.5,\\,3.0,\\,5.0\\}$（单位 bohr），计算每个间距的活跃分数 $F(R)$，并报告使 $F(R)$ 最大化的 $R^\\star$ 值；如果多个 $R$ 达到相同的最大值 $F$，则报告其中最小的 $R$。\n\n角度单位不适用。所有长度必须以 bohr 为单位处理，所有密度必须以 bohr$^{-3}$ 为单位处理。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[F_{\\mathrm{UEG}}, F_{\\mathrm{1G}}, R^\\star]$，其中 $F_{\\mathrm{UEG}}$ 是案例 1 的活跃分数，$F_{\\mathrm{1G}}$ 是案例 2 的活跃分数，$R^\\star$ 是案例 3 的结果（单位 bohr）。将所有三个输出表示为四舍五入到三位小数的浮点数，不打印单位。例如，一个有效的输出格式是 $[0.123,0.000,1.500]$。", "solution": "所提出的问题是计算量子化学领域中一个适定且有科学依据的练习，具体涉及 meta-广义梯度近似 (meta-GGA) 密度泛函的行为。任务是为几个模型电子体系分析一个理想化的转换函数，该函数是 Tao-Perdew-Staroverov-Scuseria (TPSS) 泛函的特征。所有指定的量在密度泛函理论 (DFT) 中都是标准量，而所用模型——均匀电子气、单个高斯轨道以及由高斯轨道构建的双原子体系——是用于理解此类泛函行为的典范例子。问题陈述是完整、一致的，并且需要对已确立的物理和数学公式进行直接的数值实现。因此，该问题是有效的，并将提供一个解。\n\n问题的核心在于等轨道指示因子 $\\alpha(\\mathbf{r})$，它区分了不同的成键环境。它被定义为：\n$$\n\\alpha(\\mathbf{r}) = \\frac{\\tau(\\mathbf{r}) - \\tau_{\\mathrm{W}}(\\mathbf{r})}{\\tau_{\\mathrm{unif}}(\\mathbf{r})}\n$$\n其中 $\\tau$ 是正定动能密度，$\\tau_{\\mathrm{W}} = \\frac{|\\nabla \\rho|^2}{8\\rho}$ 是 von Weizsäcker 动能密度，而 $\\tau_{\\mathrm{unif}} = \\frac{3}{10}(3\\pi^2)^{2/3}\\rho^{5/3}$ 是密度为 $\\rho$ 的均匀电子气 (UEG) 的动能密度。根据设计，对于任何单轨道区域，$\\alpha=0$；对于 UEG，$\\alpha=1$。\n\n该问题研究了类 TPSS 转换函数 $w(\\alpha) = \\frac{\\alpha^2}{1+\\alpha^2}$ 的局域活跃度。活跃度与其导数 $w'(\\alpha) = \\frac{2\\alpha}{(1+\\alpha^2)^2}$ 的大小相关。我们必须首先找到当 $\\alpha \\ge 0$ 时 $w'(\\alpha)$ 的最大值。我们将 $w'(\\alpha)$ 关于 $\\alpha$ 的导数设为零：\n$$\n\\frac{d w'(\\alpha)}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\frac{2\\alpha}{(1+\\alpha^2)^2} \\right) = \\frac{2(1+\\alpha^2)^2 - 2\\alpha \\cdot 2(1+\\alpha^2)(2\\alpha)}{(1+\\alpha^2)^4} = 0\n$$\n$$\n2(1+\\alpha^2) - 8\\alpha^2 = 0 \\implies 2 - 6\\alpha^2 = 0 \\implies \\alpha^2 = \\frac{1}{3}\n$$\n由于 $\\alpha \\ge 0$，最大值出现在 $\\alpha = 1/\\sqrt{3}$ 处。最大值为：\n$$\nw'_{\\max} = w'(1/\\sqrt{3}) = \\frac{2(1/\\sqrt{3})}{(1 + 1/3)^2} = \\frac{2/\\sqrt{3}}{(16/9)} = \\frac{2}{\\sqrt{3}}\\frac{9}{16} = \\frac{9}{8\\sqrt{3}} = \\frac{3\\sqrt{3}}{8}\n$$\n局域活跃度指示因子 $A(\\mathbf{r})$ 为 $1$，条件是 $\\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}} = 10^{-8}$ 且 $w'(\\alpha(\\mathbf{r})) \\ge \\frac{1}{2}w'_{\\max}$。活跃分数 $F$ 是 $A(\\mathbf{r})=1$ 的网格点数与 $\\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}}$ 的总网格点数之比。\n\n我们现在分析三个指定的案例。\n\n**案例 1：均匀电子气 (UEG)**\n对于 UEG，密度是恒定的，$\\rho(\\mathbf{r}) = \\rho_0 = 0.05$。因此，其梯度为零，$\\nabla \\rho(\\mathbf{r}) = \\mathbf{0}$。这直接意味着 $\\tau_{\\mathrm{W}}(\\mathbf{r})=0$。问题指出，对于此系统，$\\tau(\\mathbf{r}) = \\tau_{\\mathrm{unif}}(\\mathbf{r})$。将这些代入 $\\alpha$ 的定义中：\n$$\n\\alpha(\\mathbf{r}) = \\frac{\\tau_{\\mathrm{unif}}(\\mathbf{r}) - 0}{\\tau_{\\mathrm{unif}}(\\mathbf{r})} = 1\n$$\n在 $\\alpha=1$ 处导数的值为 $w'(1) = \\frac{2(1)}{(1+1^2)^2} = \\frac{2}{4} = \\frac{1}{2}$。活跃度条件是 $w'(1) \\ge \\frac{1}{2}w'_{\\max}$，即 $\\frac{1}{2} \\ge \\frac{1}{2}\\frac{3\\sqrt{3}}{8}$，或 $1 \\ge \\frac{3\\sqrt{3}}{8}$。由于 $8^2 = 64$ 且 $(3\\sqrt{3})^2 = 27$，此不等式成立。密度恒定为 $0.05$，远大于 $\\rho_{\\mathrm{cut}}$。因此，在每个网格点上 $A(\\mathbf{r})=1$。活跃点数等于满足密度截断的总点数，得出活跃分数 $F_{\\mathrm{UEG}}=1$。\n\n**案例 2：单轨道类原子体系**\n该体系由一个双占据的实空间轨道 $\\phi(\\mathbf{r})$ 组成。密度为 $\\rho(\\mathbf{r}) = 2\\phi(\\mathbf{r})^2$。密度的梯度为 $\\nabla\\rho = 4\\phi(\\nabla\\phi)$。动能密度为 $\\tau(\\mathbf{r}) = (\\nabla\\phi)^2$（对一个轨道求和，虽然是双占据，但 $\\tau$ 是对自旋轨道求和，这导致了没有因子 2 的形式）。根据约定，这里通常会有因子 2 的不匹配，但问题陈述为 $\\tau=\\sum_n|\\nabla\\phi_n|^2$，其中 $\\{\\phi_n\\}$ 是空间轨道。对于一个轨道，$\\tau=|\\nabla\\phi|^2$。von Weizsäcker 动能密度为：\n$$\n\\tau_{\\mathrm{W}}(\\mathbf{r}) = \\frac{|\\nabla\\rho|^2}{8\\rho} = \\frac{|4\\phi(\\nabla\\phi)|^2}{8(2\\phi^2)} = \\frac{16\\phi^2(\\nabla\\phi)^2}{16\\phi^2} = (\\nabla\\phi)^2 = \\tau(\\mathbf{r})\n$$\n由于在所有 $\\rho(\\mathbf{r}) > 0$ 的地方都有 $\\tau(\\mathbf{r}) = \\tau_{\\mathrm{W}}(\\mathbf{r})$，所以 $\\alpha$ 的分子恒为零。因此，对于所有 $\\mathbf{r}$，$\\alpha(\\mathbf{r}) = 0$。\n在 $\\alpha=0$ 处，转换函数的导数为 $w'(0)=0$。活跃度条件是 $0 \\ge \\frac{1}{2}w'_{\\max}$，由于 $w'_{\\max}>0$，该条件为假。因此，处处有 $A(\\mathbf{r})=0$。活跃点数为零，活跃分数为 $F_{\\mathrm{1G}}=0$。\n\n**案例 3：双中心类双原子体系**\n该体系由两个双占据的标准正交轨道组成，一个成键轨道 $\\phi_b$ 和一个反键轨道 $\\phi_a$，它们由高斯基函数 $g_A$ 和 $g_B$ 构造而成。\n$$\n\\phi_b(\\mathbf{r}) = \\frac{g_A(\\mathbf{r})+g_B(\\mathbf{r})}{\\sqrt{2(1+S)}}, \\quad \\phi_a(\\mathbf{r}) = \\frac{g_A(\\mathbf{r})-g_B(\\mathbf{r})}{\\sqrt{2(1-S)}}\n$$\n这个四电子体系的总密度和动能密度为：\n$$\n\\rho(\\mathbf{r}) = 2|\\phi_b(\\mathbf{r})|^2 + 2|\\phi_a(\\mathbf{r})|^2\n$$\n$$\n\\tau(\\mathbf{r}) = |\\nabla\\phi_b(\\mathbf{r})|^2 + |\\nabla\\phi_a(\\mathbf{r})|^2\n$$\n对于每个指定的核间距 $R$，必须通过数值方法计算活跃分数 $F(R)$。步骤如下：\n1.  在 $[-6,6]^3$ bohr 的立方体内定义一个均匀笛卡尔网格，每个轴有 $33$ 个点。\n2.  对 $R \\in \\{0.5, 1.5, 3.0, 5.0\\}$ 中的每个值，执行以下步骤。\n3.  对于网格上的每个点 $\\mathbf{r}$，计算基函数 $g_{A,B}(\\mathbf{r})$ 的值及其梯度 $\\nabla g_{A,B}(\\mathbf{r})$。\n4.  根据这些值，构造轨道 $\\phi_{b,a}(\\mathbf{r})$ 及其梯度 $\\nabla \\phi_{b,a}(\\mathbf{r})$。\n5.  计算总密度 $\\rho(\\mathbf{r})$、其梯度 $\\nabla\\rho(\\mathbf{r})$ 以及动能密度 $\\tau(\\mathbf{r})$。\n6.  计算 $\\tau_{\\mathrm{W}}(\\mathbf{r})$、$\\tau_{\\mathrm{unif}}(\\mathbf{r})$，并最终计算等轨道指示因子 $\\alpha(\\mathbf{r})$。需要特别注意 $\\rho(\\mathbf{r}) \\to 0$ 的区域，将 $0/0$ 等不定式的结果设为 $0$。\n7.  对所有满足 $\\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}}$ 的点，评估活跃度条件 $w'(\\alpha(\\mathbf{r})) \\ge \\frac{1}{2}w'_{\\max}$。\n8.  将满足条件的点数与密度高于截断值的总点数之比，计算为活跃分数 $F(R)$。\n9.  计算完所有候选 $R$ 的 $F(R)$ 后，找出使 $F(R)$ 最大化的 $R$ 值，记为 $R^\\star$。如果出现多个 R 得到相同的最大值，则选择最小的那个 $R$。\n\n该数值计算将得出最终所需的值 $R^\\star$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational chemistry problem as specified.\n    1. Calculates F_UEG analytically.\n    2. Calculates F_1G analytically.\n    3. Numerically calculates F(R) for the diatomic system for several R\n       and finds R* that maximizes F(R).\n    \"\"\"\n\n    # --- Case 1: Uniform Electron Gas ---\n    # As derived in the solution, alpha = 1 for the UEG.\n    # w'(1) = 2/(1+1)^2 = 0.5.\n    # w'_max = 3*sqrt(3)/8.\n    # The condition is 0.5 >= 0.5 * (3*sqrt(3)/8), which is true.\n    # Since rho > rho_cut everywhere, all points are active.\n    f_ueg = 1.0\n\n    # --- Case 2: One-Orbital Atom-like System ---\n    # As derived in the solution, alpha = 0 for any one-orbital system.\n    # w'(0) = 0. The activity condition is 0 >= 0.5 * w'_max, which is false.\n    # No points are active.\n    f_1g = 0.0\n\n    # --- Case 3: Two-center Diatomic-like System ---\n    # Numerical calculation is required.\n\n    # Grid and constant setup\n    L = 6.0\n    N = 33\n    a = 0.5\n    rho_cut = 1.0e-8\n    candidate_R = [0.5, 1.5, 3.0, 5.0]\n\n    # Pre-calculate grid coordinates\n    points = np.linspace(-L, L, N, dtype=np.float64)\n    xx, yy, zz = np.meshgrid(points, points, points, indexing='ij')\n    grid = np.stack((xx, yy, zz), axis=-1)\n\n    # Pre-calculate constants for w'\n    w_prime_max = 3 * np.sqrt(3) / 8\n    activity_threshold = 0.5 * w_prime_max\n    \n    # Constant for tau_unif\n    tau_unif_const = (3.0 / 10.0) * (3.0 * np.pi**2)**(2.0 / 3.0)\n\n    # Gaussian normalization constant\n    norm_gauss = (2 * a / np.pi)**(3.0 / 4.0)\n\n    f_values = []\n    \n    for R in candidate_R:\n        # Define atom centers\n        R_A = np.array([0.0, 0.0, -R / 2.0])\n        R_B = np.array([0.0, 0.0, R / 2.0])\n\n        # Overlap and normalization for orbitals\n        if R == 0.0:\n            S = 1.0\n        else:\n            S = np.exp(-a * R**2 / 2.0)\n        \n        # Avoid division by zero if R is very large and 1-S is close to 0, though not an issue for given R\n        C_b = np.sqrt(2.0 * (1.0 + S))\n        C_a = np.sqrt(2.0 * (1.0 - S)) if (1.0-S) > 1e-12 else 1e-6 # Avoid instability at small R\n\n        # Calculate Gaussian basis functions and their gradients\n        r_minus_RA = grid - R_A\n        r_minus_RB = grid - R_B\n        r_A_sq = np.sum(r_minus_RA**2, axis=-1)\n        r_B_sq = np.sum(r_minus_RB**2, axis=-1)\n\n        g_A = norm_gauss * np.exp(-a * r_A_sq)\n        g_B = norm_gauss * np.exp(-a * r_B_sq)\n        \n        # Using [..., np.newaxis] to facilitate broadcasting\n        grad_g_A = -2.0 * a * r_minus_RA * g_A[..., np.newaxis]\n        grad_g_B = -2.0 * a * r_minus_RB * g_B[..., np.newaxis]\n\n        # Construct orthonormal orbitals and their gradients\n        phi_b = (g_A + g_B) / C_b\n        phi_a = (g_A - g_B) / C_a\n        grad_phi_b = (grad_g_A + grad_g_B) / C_b\n        grad_phi_a = (grad_g_A - grad_g_B) / C_a\n\n        # Calculate total density and kinetic energy density\n        rho = 2.0 * (phi_b**2 + phi_a**2)\n        tau = np.sum(grad_phi_b**2, axis=-1) + np.sum(grad_phi_a**2, axis=-1)\n\n        # Calculate quantities for alpha\n        grad_rho = 4.0 * (phi_b[..., np.newaxis] * grad_phi_b + phi_a[..., np.newaxis] * grad_phi_a)\n        \n        # Use np.divide to handle rho=0 case safely\n        tau_W = np.divide(np.sum(grad_rho**2, axis=-1), 8.0 * rho, \n                          out=np.zeros_like(rho), where=rho > 1e-15)\n                          \n        tau_unif = tau_unif_const * rho**(5.0 / 3.0)\n\n        # Calculate alpha, handling tau_unif=0 case safely\n        numerator_alpha = tau - tau_W\n        alpha = np.divide(numerator_alpha, tau_unif, \n                          out=np.zeros_like(rho), where=tau_unif > 1e-15)\n\n        # Calculate w'(alpha)\n        w_prime_alpha = 2.0 * alpha / (1.0 + alpha**2)**2\n\n        # Determine active fraction F\n        rho_mask = rho >= rho_cut\n        num_rho_points = np.sum(rho_mask)\n\n        if num_rho_points == 0:\n            F = 0.0\n        else:\n            active_mask = (w_prime_alpha >= activity_threshold)  rho_mask\n            num_active_points = np.sum(active_mask)\n            F = num_active_points / num_rho_points\n        \n        f_values.append(F)\n\n    # Find R* that maximizes F(R)\n    max_f = -1.0\n    r_star = -1.0\n    for R, F in zip(candidate_R, f_values):\n        if F > max_f:\n            max_f = F\n            r_star = R\n\n    # Assemble final results and format output\n    results = [f_ueg, f_1g, r_star]\n    formatted_results = [f\"{val:.3f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2457711"}]}