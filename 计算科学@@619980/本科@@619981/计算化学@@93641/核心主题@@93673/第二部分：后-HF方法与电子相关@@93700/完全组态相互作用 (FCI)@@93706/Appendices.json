{"hands_on_practices": [{"introduction": "理解一个理论概念最有效的方法之一就是通过计算来掌握它。我们的第一个练习将从一个最基本的问题入手：如何量化电子相关能？此练习将 Hartree-Fock ($E_{\\text{HF}}$) 的近似能量与在同一基组下的精确全组态相互作用 ($E_{\\text{FCI}}$) 能量进行对比，让你亲手计算出相关能 ($E_{\\text{corr}}$) 的具体数值，从而直观地理解 FCI 作为基准方法的价值。[@problem_id:1978313]", "problem": "一位计算化学家正在使用特定的原子轨道基组研究一个四电子原子的电子结构。第一步是使用Hartree-Fock (HF)方法进行计算，这是一种以平均场方式模拟电子-电子排斥的近似方法。该计算得出的基态能量为-39.727哈特里。\n\n为了获得更准确的基准，该化学家接着使用相同的基组进行了全组态相互作用 (Full CI) 计算。Full CI方法考虑了所有可能的电子组态，并在所选基组内为系统提供了精确的非相对论性电子能量。这个更详尽的计算得出的基态能量为-39.845哈特里。\n\n计算该基组为此原子捕获的相关能。以哈特里为单位表示您的答案，并四舍五入到三位有效数字。", "solution": "在固定基组内，相关能定义为该基组内的精确非相对论性电子能量与Hartree-Fock平均场能量之间的差值。使用Full CI作为基组内的精确参考，即\n$$\nE_{\\text{corr}} = E_{\\text{FCI}} - E_{\\text{HF}}.\n$$\n已知 $E_{\\text{HF}} = -39.727$ 哈特里 和 $E_{\\text{FCI}} = -39.845$ 哈特里，\n$$\nE_{\\text{corr}} = (-39.845) - (-39.727) = -39.845 + 39.727 = -0.118 \\text{ hartrees}.\n$$\n四舍五入到三位有效数字，相关能为-0.118哈特里。", "answer": "$$\\boxed{-0.118}$$", "id": "1978313"}, {"introduction": "既然全组态相互作用（FCI）在给定基组下是精确的，为何它未被广泛应用于所有化学计算？这个练习将通过一个组合数学问题，让你定量地感受 FCI 面临的挑战。你将计算一个典型系统（$4$ 电子，$8$ 轨道，$M_s=0$）中需要包含的斯莱特行列式的总数，从而直观地理解所谓的“维度灾难”及其对计算成本的指数级影响。[@problem_id:2455906]", "problem": "考虑一个由 $N$ 个不可区分电子组成的系统，其非相对论、不依赖自旋的电子哈密顿量在一组正交归一的空间轨道上展开。在全组态相互作用 (FCI) 计算中，多电子基组取为所有不同的斯莱特行列式，这些行列式是由自旋轨道构成的，而自旋轨道则是由每个空间轨道与一个 $\\alpha$ 或 $\\beta$ 自旋函数配对而得。\n\n现给定一个系统，包含 $N=4$ 个电子和 $M=8$ 个正交归一的空间轨道。假设每个空间轨道根据泡利不相容原理，每种自旋最多只能容纳一个电子，并且斯莱特行列式按常规方式由自旋轨道构建。\n\n现将注意力限制在总自旋投影量子数 $M_s=0$ 的子空间，该子空间对应于单重态自旋流形 ($S=0$)。在这个 $M_s=0$ 的扇区内，确定可为FCI展开构建的独立斯莱特行列式的总数。\n\n请以无单位的精确整数形式提供您的答案。", "solution": "该问题要求计算一个包含 $N=4$ 个电子分布在 $M=8$ 个空间轨道上的系统的唯一斯莱特行列式数量，其约束条件是总自旋投影为 $M_s=0$。\n\n一个自旋轨道是一个空间轨道 $\\phi_i$ 和一个自旋函数（$\\alpha$ 自旋向上或 $\\beta$ 自旋向下）的乘积。对于 $M=8$ 个空间轨道，总共有 $2M=16$ 个可用的自旋轨道。一个斯莱特行列式是通过从这16个自旋轨道中选择 $N=4$ 个不同的自旋轨道来构建的。\n\n总自旋投影量子数 $M_s$ 是单个电子自旋投影量子数 $m_s$ 的总和。处于 $\\alpha$ 自旋态的电子具有 $m_s = +\\frac{1}{2}$，而处于 $\\beta$ 自旋态的电子具有 $m_s = -\\frac{1}{2}$。设 $N_\\alpha$ 为具有 $\\alpha$ 自旋的电子数，$N_\\beta$ 为具有 $\\beta$ 自旋的电子数。总自旋投影由下式给出：\n$$M_s = N_\\alpha \\left(+\\frac{1}{2}\\right) + N_\\beta \\left(-\\frac{1}{2}\\right) = \\frac{1}{2}(N_\\alpha - N_\\beta)$$\n电子总数为 $N=N_\\alpha+N_\\beta=4$。问题指定约束条件为 $M_s = 0$，这意味着：\n$$\\frac{1}{2}(N_\\alpha - N_\\beta) = 0 \\implies N_\\alpha = N_\\beta$$\n求解以下二元一次方程组：\n\\begin{cases}\nN_\\alpha + N_\\beta = 4 \\\\\nN_\\alpha - N_\\beta = 0\n\\end{cases}\n解得 $2N_\\alpha = 4$，因此 $N_\\alpha=2$，进而 $N_\\beta=2$。\n因此，在 $M_s=0$ 子空间中的任何有效斯莱特行列式，都必须恰好包含两个 $\\alpha$ 自旋的电子和两个 $\\beta$ 自旋的电子。\n\n问题现在简化为一个组合计算。我们必须确定将 $N_\\alpha=2$ 个 $\\alpha$ 电子和 $N_\\beta=2$ 个 $\\beta$ 电子独立地放入可用轨道中的方式数量。\n对于 $\\alpha$ 电子，我们必须从 $M=8$ 个可用空间轨道中选择 $N_\\alpha=2$ 个不同的空间轨道。由于我们选择的是不同的空间轨道，因此对于这组 $\\alpha$ 自旋轨道，泡利不相容原理自动得到满足。实现这一点的方式数量由二项式系数 $\\binom{M}{N_\\alpha}$ 给出。\n$$ \\text{Number of ways for } \\alpha \\text{ electrons} = \\binom{8}{2} $$\n对于 $\\beta$ 电子，我们同样必须从相同的 $M=8$ 个可用空间轨道中选择 $N_\\beta=2$ 个不同的空间轨道。实现这一点的方式数量由 $\\binom{M}{N_\\beta}$ 给出。\n$$ \\text{Number of ways for } \\beta \\text{ electrons} = \\binom{8}{2} $$\n由于为 $\\alpha$ 电子选择空间轨道与为 $\\beta$ 电子选择空间轨道是相互独立的，因此不同斯莱特行列式（组态）的总数是这两个数的乘积。\n$$ \\text{Total number of determinants} = \\binom{8}{2} \\times \\binom{8}{2} $$\n现在我们计算二项式系数的值：\n$$ \\binom{8}{2} = \\frac{8!}{2!(8-2)!} = \\frac{8!}{2!6!} = \\frac{8 \\times 7}{2 \\times 1} = 28 $$\n因此，不同斯莱特行列式的总数为：\n$$ \\text{Total number} = 28 \\times 28 = 784 $$\n这是指定系统在 $M_s=0$ 子空间中 FCI 矩阵的大小。", "answer": "$$\n\\boxed{784}\n$$", "id": "2455906"}, {"introduction": "得到一个精确的能量值固然重要，但理解复杂的多行列式波函数背后的物理图像也同样关键。本练习将引导你从一个给定的 FCI 波函数出发，计算其自然轨道占据数。通过这个计算，你将观察到电子相关如何导致电子的占据数偏离 Hartree-Fock 模型中理想的整数 $2$ 或 $0$，这是理解相关效应如何改变电子分布的关键一步。[@problem_id:2455920]", "problem": "考虑一个铍原子的最小基组模型，该模型共有 $N=4$ 个电子，占据 $M=4$ 个正交归一的空间轨道 $\\{\\phi_1,\\phi_2,\\phi_3,\\phi_4\\}$。多电子波函数表示为闭壳层Slater行列式的归一化线性组合，每个行列式对应于两个双占据（每个自旋一个电子）的空间轨道。令自旋求和单粒子约化密度矩阵 $\\gamma$ 定义为\n$$\n\\gamma_{pq}=\\langle \\Psi \\lvert \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\hat{a}^{\\dagger}_{p\\sigma} \\hat{a}_{q\\sigma} \\rvert \\Psi \\rangle,\n$$\n其中 $\\hat{a}^{\\dagger}_{p\\sigma}$ 和 $\\hat{a}_{q\\sigma}$ 是具有自旋 $\\sigma$ 的空间轨道 $p$ 和 $q$ 的费米子产生和湮灭算符，而 $\\rvert \\Psi \\rangle$ 是给定的归一化波函数。自然轨道占据数是 $\\gamma$ 的本征值，位于区间 $[0,2]$ 内，总和为 $N=4$。\n\n对于下方的每个测试用例，波函数由一系列闭壳层行列式及其对应的实系数指定。每个行列式由无序对 $\\{i,j\\}$ 表示，其中 $1 \\le i < j \\le M$，表示轨道 $\\phi_i$ 和 $\\phi_j$ 在该行列式中是双占据的。波函数为\n$$\n\\rvert \\Psi \\rangle \\;=\\; \\sum_{k=1}^{K} c_k \\,\\rvert D_k \\rangle,\n$$\n其中 $\\sum_{k=1}^{K} c_k^2 = 1$ 且每个 $\\rvert D_k \\rangle$ 都是一个闭壳层行列式。\n\n您的任务：\n- 对于每个测试用例，根据给定的 $\\rvert \\Psi \\rangle$ 构建如上定义的自旋求和单粒子约化密度矩阵 $\\gamma$。\n- 计算作为 $\\gamma$ 本征值的自然轨道占据数。\n- 将占据数按非递增顺序排序。\n- 报告排序后并四舍五入到 $6$ 位小数的占据数。\n\n不涉及物理单位。不出现角度。输出必须是数字。\n\n测试套件：\n- 测试用例 $1$（单行列式闭壳层）：\n  - $M=4$，行列式：$\\{1,2\\}$，系数为 $c_1=1$。\n- 测试用例 $2$（对替代行列式的相关叠加）：\n  - $M=4$，行列式和系数：\n    - $\\{1,2\\}$，系数 $c_1=\\sqrt{\\tfrac{7}{10}}$，\n    - $\\{1,3\\}$，系数 $c_2=\\sqrt{\\tfrac{2}{10}}$，\n    - $\\{2,4\\}$，系数 $c_3=\\sqrt{\\tfrac{1}{10}}$。\n- 测试用例 $3$（两个行列式之间最大离域的边缘情况）：\n  - $M=4$，行列式和系数：\n    - $\\{1,2\\}$，系数 $c_1=\\tfrac{1}{\\sqrt{2}}$，\n    - $\\{3,4\\}$，系数 $c_2=\\tfrac{1}{\\sqrt{2}}$。\n\n最终输出格式：\n- 您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每一项是针对一个测试用例的、四舍五入并排序后的自然轨道占据数列表。例如，输出格式必须为\n$[ [x_{1,1},x_{1,2},x_{1,3},x_{1,4}], [x_{2,1},x_{2,2},x_{2,3},x_{2,4}], [x_{3,1},x_{3,2},x_{3,3},x_{3,4}] ]$\n不带任何附加文本。", "solution": "目标是计算自然轨道占据数，即自旋求和单粒子约化密度矩阵 $\\gamma$ 的本征值。该矩阵的矩阵元由以下表达式给出：\n$$ \\gamma_{pq} = \\langle \\Psi \\lvert \\hat{E}_{pq} \\rvert \\Psi \\rangle $$\n其中 $\\hat{E}_{pq} = \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\hat{a}^{\\dagger}_{p\\sigma} \\hat{a}_{q\\sigma}$ 是从轨道 $q$ 到 $p$ 的单电子激发算符。波函数 $\\rvert \\Psi \\rangle$ 是闭壳层行列式的线性组合：\n$$ \\rvert \\Psi \\rangle = \\sum_{k=1}^{K} c_k \\rvert D_k \\rangle $$\n将此代入 $\\gamma_{pq}$ 的表达式中，得到：\n$$ \\gamma_{pq} = \\left\\langle \\sum_k c_k \\rvert D_k \\rangle \\left\\lvert \\hat{E}_{pq} \\right\\rvert \\sum_l c_l \\rvert D_l \\rangle \\right\\rangle = \\sum_{k,l} c_k c_l \\langle D_k \\lvert \\hat{E}_{pq} \\rvert D_l \\rangle $$\n根据Slater-Condon规则，单体算符 $\\hat{E}_{pq}$ 不能连接相差两个或更多自旋轨道的行列式。由于问题中所有行列式都是闭壳层的，任何两个不同的行列式 $\\rvert D_k \\rangle$ 和 $\\rvert D_l \\rangle$ ($k \\neq l$) 至少相差两个自旋轨道。因此，矩阵元 $\\langle D_k \\lvert \\hat{E}_{pq} \\rvert D_l \\rangle$ 只有在 $k=l$ 时才非零。这大大简化了表达式：\n$$ \\gamma_{pq} = \\sum_k c_k^2 \\langle D_k \\lvert \\hat{E}_{pq} \\rvert D_k \\rangle $$\n对于对角元 ($p=q$)，$\\hat{E}_{pp}$ 是轨道 $\\phi_p$ 的数算符。对于闭壳层行列式 $\\rvert D_k \\rangle$，其期望值 $\\langle D_k \\lvert \\hat{E}_{pp} \\rvert D_k \\rangle$ 为2（如果轨道 $p$ 在 $D_k$ 中被占据）或0（如果未被占据）。\n对于非对角元 ($p \\neq q$)，$\\langle D_k \\lvert \\hat{E}_{pq} \\rvert D_k \\rangle = 0$。\n因此，$\\gamma$ 矩阵在空间轨道基底下是对角的，其对角元（即自然轨道占据数 $n_p$）为：\n$$ n_p = \\gamma_{pp} = 2 \\sum_{k \\text{ 使得 } p \\in O_k} c_k^2 $$\n其中求和遍及所有包含双占据轨道 $p$ 的行列式 $D_k$。\n\n现在我们应用这个公式计算每个测试用例：\n\n**测试用例 1：** $\\rvert\\Psi\\rangle = 1.0 \\cdot \\rvert D_{\\{1,2\\}} \\rangle$\n- $c_1^2=1.0$。行列式涉及轨道 $\\{1,2\\}$。\n- $n_1 = 2 \\times 1.0 = 2.0$\n- $n_2 = 2 \\times 1.0 = 2.0$\n- $n_3 = 0.0$\n- $n_4 = 0.0$\n- 排序后的占据数：$[2.0, 2.0, 0.0, 0.0]$。\n\n**测试用例 2：** $\\rvert\\Psi\\rangle = \\sqrt{0.7} \\rvert D_{\\{1,2\\}} \\rangle + \\sqrt{0.2} \\rvert D_{\\{1,3\\}} \\rangle + \\sqrt{0.1} \\rvert D_{\\{2,4\\}} \\rangle$\n- $c_1^2=0.7$ 对应 $\\{1,2\\}$；$c_2^2=0.2$ 对应 $\\{1,3\\}$；$c_3^2=0.1$ 对应 $\\{2,4\\}$。\n- $n_1 = 2 \\times c_1^2 + 2 \\times c_2^2 = 2 \\times 0.7 + 2 \\times 0.2 = 1.4 + 0.4 = 1.8$\n- $n_2 = 2 \\times c_1^2 + 2 \\times c_3^2 = 2 \\times 0.7 + 2 \\times 0.1 = 1.4 + 0.2 = 1.6$\n- $n_3 = 2 \\times c_2^2 = 2 \\times 0.2 = 0.4$\n- $n_4 = 2 \\times c_3^2 = 2 \\times 0.1 = 0.2$\n- 排序后的占据数：$[1.8, 1.6, 0.4, 0.2]$。\n\n**测试用例 3：** $\\rvert\\Psi\\rangle = \\frac{1}{\\sqrt{2}} \\rvert D_{\\{1,2\\}} \\rangle + \\frac{1}{\\sqrt{2}} \\rvert D_{\\{3,4\\}} \\rangle$\n- $c_1^2=0.5$ 对应 $\\{1,2\\}$；$c_2^2=0.5$ 对应 $\\{3,4\\}$。\n- $n_1 = 2 \\times c_1^2 = 2 \\times 0.5 = 1.0$\n- $n_2 = 2 \\times c_1^2 = 2 \\times 0.5 = 1.0$\n- $n_3 = 2 \\times c_2^2 = 2 \\times 0.5 = 1.0$\n- $n_4 = 2 \\times c_2^2 = 2 \\times 0.5 = 1.0$\n- 排序后的占据数：$[1.0, 1.0, 1.0, 1.0]$。", "answer": "[[2.0, 2.0, 0.0, 0.0], [1.8, 1.6, 0.4, 0.2], [1.0, 1.0, 1.0, 1.0]]", "id": "2455920"}]}