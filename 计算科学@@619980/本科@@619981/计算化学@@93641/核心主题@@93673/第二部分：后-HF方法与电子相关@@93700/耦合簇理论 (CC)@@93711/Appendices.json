{"hands_on_practices": [{"introduction": "一个稳健的科学模型必须能正确描述简单的极限情况。本练习将挑战您将耦合簇理论的形式体系应用于一个假想的非相互作用电子系统。通过这个思想实验，您将验证复杂的 CC 机器如何正确地简化为简单、精确的能量，从而加深您对电子相关究竟是什么以及 CC 理论如何处理它的理解。[@problem_id:2453787]", "problem": "考虑一个非相对论的 $N$ 电子体系，其电子哈密顿量仅包含单体项，\n\n$$\n\\hat{H} \\;=\\; \\sum_{i=1}^{N} \\hat{h}(i),\n$$\n\n其中 $\\hat{h}$ 是一个厄米单电子算符。设 $\\{\\phi_{p}\\}$ 是 $\\hat{h}$ 的一个完备正交归一的单电子本征函数集，满足\n\n$$\n\\hat{h}\\,\\phi_{p} \\;=\\; \\epsilon_{p}\\,\\phi_{p},\n$$\n\n并从 $N$ 个最低的单电子本征函数构建一个单斯莱特行列式 $|\\Phi_{0}\\rangle$。考虑使用耦合簇单双激发 (CCSD) 拟设，\n\n$$\n|\\Psi\\rangle \\;=\\; \\exp(\\hat{T}_{1}+\\hat{T}_{2})\\,|\\Phi_{0}\\rangle,\n$$\n\n其耦合簇能量定义为\n\n$$\nE_{\\mathrm{CCSD}} \\;=\\; \\langle \\Phi_{0} | \\exp(-\\hat{T}_{1}-\\hat{T}_{2})\\,\\hat{H}\\,\\exp(\\hat{T}_{1}+\\hat{T}_{2}) | \\Phi_{0} \\rangle.\n$$\n\n求解精确的 CCSD 基态能量 $E_{\\mathrm{CCSD}}$，以闭式解析表达式的形式，用构成 $|\\Phi_{0}\\rangle$ 的已占据单电子本征值集合 $\\{\\epsilon_{i}\\}$ 来表示。无需进行舍入。用符号 $\\epsilon_{i}$ 表示最终答案。", "solution": "在尝试求解之前，首先对问题陈述的有效性进行严格评估。\n\n步骤 1：提取已知条件\n问题陈述中提供了以下信息：\n- 该体系是一个非相对论的 $N$ 电子体系。\n- 电子哈密顿量仅包含单体项：$\\hat{H} = \\sum_{i=1}^{N} \\hat{h}(i)$。\n- $\\hat{h}$ 是一个厄米单电子算符。\n- $\\{\\phi_{p}\\}$ 是 $\\hat{h}$ 的一个完备正交归一的单电子本征函数集。\n- 本征函数满足 $\\hat{h}\\,\\phi_{p} = \\epsilon_{p}\\,\\phi_{p}$。\n- 单斯莱特行列式 $|\\Phi_{0}\\rangle$ 是由 $N$ 个最低的单电子本征函数构建的。\n- 耦合簇单双激发 (CCSD) 波函数拟设为 $|\\Psi\\rangle = \\exp(\\hat{T}_{1}+\\hat{T}_{2})\\,|\\Phi_{0}\\rangle$。\n- CCSD 能量定义为 $E_{\\mathrm{CCSD}} = \\langle \\Phi_{0} | \\exp(-\\hat{T}_{1}-\\hat{T}_{2})\\,\\hat{H}\\,\\exp(\\hat{T}_{1}+\\hat{T}_{2}) | \\Phi_{0} \\rangle$。\n- 任务是求解精确的 CCSD 基态能量 $E_{\\mathrm{CCSD}}$，以已占据单电子本征值 $\\{\\epsilon_{i}\\}$ 的闭式表达式表示。\n\n步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据：** 该问题设置在非相对论量子力学和多体理论的标准框架内。所给的哈密顿量虽然简化为单体项，但在量子化学中是一个有效的模型（例如，在非相互作用电子的背景下）。所呈现的耦合簇形式是标准的。该问题在科学上是合理的。\n- **良构性：** 问题提供了确定唯一解所需的所有必要定义和约束。问题具体，要求的输出也明确定义。\n- **客观性：** 语言精确、数学化，不含任何主观或推测性内容。\n- **其他缺陷：** 问题是完整的、一致的，在其理论模型内是现实的，并且与耦合簇理论的指定主题直接相关。它不包含任何列出的缺陷。\n\n步骤 3：结论与行动\n该问题被判定为**有效**。将提供一个完整的、附带推理过程的解法。\n\n出发点是将被给定的哈密顿量用二次量子化形式表示。该表示的基矢是由单电子算符 $\\hat{h}$ 的本征函数 $\\{\\phi_p\\}$ 构成的正交归一自旋轨道集。设 $a_p^\\dagger$ 和 $a_p$ 分别为在对应于 $\\phi_p$ 的自旋轨道上一个电子的产生和湮灭算符。哈密顿量是单体算符之和，可以写成：\n$$\n\\hat{H} = \\sum_{p,q} \\langle p|\\hat{h}|q \\rangle a_p^\\dagger a_q\n$$\n由于基函数 $\\{\\phi_p\\}$ 是 $\\hat{h}$ 的本征函数，矩阵元 $\\langle p|\\hat{h}|q \\rangle$ 是对角的：\n$$\n\\langle p|\\hat{h}|q \\rangle = \\int \\phi_p^*(x) \\hat{h}(x) \\phi_q(x) dx = \\epsilon_q \\int \\phi_p^*(x) \\phi_q(x) dx = \\epsilon_p \\delta_{pq}\n$$\n因此，哈密顿量简化为：\n$$\n\\hat{H} = \\sum_p \\epsilon_p a_p^\\dagger a_p\n$$\n问题陈述指出，参考态 $|\\Phi_0\\rangle$ 是由对应于 $N$ 个最低本征值的 $N$ 个本征函数构成的单斯莱特行列式。我们用索引 $i, j, k, \\dots$ 标记已占据自旋轨道集，用索引 $a, b, c, \\dots$ 标记未占据（虚）自旋轨道集。参考态是此特定哈密顿量的一个本征函数：\n$$\n\\hat{H} |\\Phi_0\\rangle = \\left( \\sum_p \\epsilon_p a_p^\\dagger a_p \\right) |\\Phi_0\\rangle = \\left( \\sum_{i \\in \\text{occ}} \\epsilon_i \\right) |\\Phi_0\\rangle = E_0 |\\Phi_0\\rangle\n$$\n其中 $E_0 = \\sum_{i \\in \\text{occ}} \\epsilon_i$ 是已占据自旋轨道的能量之和。这表明参考态 $|\\Phi_0\\rangle$ 是总哈密顿量 $\\hat{H}$ 的一个精确本征态。\n\n耦合簇理论的目标是找到精确的基态能量。由于参考态 $|\\Phi_0\\rangle$ 已经是精确的基态，CCSD 波函数 $|\\Psi\\rangle$ 必须等于 $|\\Phi_0\\rangle$（最多相差一个相位因子，这对能量而言无关紧要）。\n$$\n|\\Psi\\rangle = \\exp(\\hat{T}_1 + \\hat{T}_2) |\\Phi_0\\rangle = |\\Phi_0\\rangle\n$$\n这意味着簇算符 $\\hat{T} = \\hat{T}_1 + \\hat{T}_2$ 必须是零算符。我们可以通过求解 CCSD 振幅方程来正式证明这一点。\n\n簇振幅 $t_i^a$ 和 $t_{ij}^{ab}$ 是通过将薛定谔方程投影到单激发和双激发行列式空间上确定的：\n$$\n\\langle \\Phi_i^a | e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} | \\Phi_0 \\rangle = 0\n$$\n$$\n\\langle \\Phi_{ij}^{ab} | e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} | \\Phi_0 \\rangle = 0\n$$\n其中 $|\\Phi_i^a\\rangle = a_a^\\dagger a_i |\\Phi_0\\rangle$ 且 $|\\Phi_{ij}^{ab}\\rangle = a_a^\\dagger a_b^\\dagger a_j a_i |\\Phi_0\\rangle$。对相似变换后的哈密顿量 $\\bar{H} = e^{-\\hat{T}}\\hat{H}e^{\\hat{T}}$ 使用 Baker-Campbell-Hausdorff (BCH) 展开，单激发振幅方程在振幅的二阶以内为：\n$$\n\\langle \\Phi_i^a | \\hat{H} + [\\hat{H}, \\hat{T}_1] + \\dots | \\Phi_0 \\rangle_c = 0\n$$\n下标 $c$ 表示只包含连通项。对于单体哈密顿量 $\\hat{H} = \\hat{F}$，连通项会显著简化。单激发方程变为：\n$$\n\\langle \\Phi_i^a | \\hat{F} | \\Phi_0 \\rangle_c + \\langle \\Phi_i^a | [\\hat{F}, \\hat{T}_1] | \\Phi_0 \\rangle_c = 0\n$$\n第一项是 $\\langle \\phi_i | \\hat{h} | \\phi_a \\rangle = f_{ia} = 0$，因为基矢将 $\\hat{h}$ 对角化。这就是 Brillouin 定理的陈述。\n第二项计算如下。单激发算符为 $\\hat{T}_1 = \\sum_{j,b} t_j^b a_b^\\dagger a_j$。\n$$\n[\\hat{H}, \\hat{T}_1] = \\left[ \\sum_p \\epsilon_p a_p^\\dagger a_p, \\sum_{j,b} t_j^b a_b^\\dagger a_j \\right] = \\sum_{j,b} (\\epsilon_b - \\epsilon_j) t_j^b a_b^\\dagger a_j\n$$\n投影到 $\\langle \\Phi_i^a |$ 上：\n$$\n\\langle \\Phi_i^a | [\\hat{H}, \\hat{T}_1] | \\Phi_0 \\rangle = \\sum_{j,b} (\\epsilon_b - \\epsilon_j) t_j^b \\langle \\Phi_i^a | a_b^\\dagger a_j | \\Phi_0 \\rangle = \\sum_{j,b} (\\epsilon_b - \\epsilon_j) t_j^b \\delta_{ij} \\delta_{ab} = (\\epsilon_a - \\epsilon_i) t_i^a\n$$\n因此，单激发振幅方程简化为：\n$$\n(\\epsilon_a - \\epsilon_i) t_i^a = 0\n$$\n由于已占据轨道 $\\{i\\}$ 是 $N$ 个能量最低的态，而虚轨道 $\\{a\\}$ 是所有其他态，我们有 $\\epsilon_a > \\epsilon_i$（假设最高已占据轨道和最低未占据轨道之间没有简并）。因此，唯一的解是对于所有的 $i, a$ 都有 $t_i^a=0$。这意味着 $\\hat{T}_1=0$。\n\n类似地，对于单体哈密顿量，双激发振幅方程为：\n$$\n\\langle \\Phi_{ij}^{ab} | [\\hat{H}, \\hat{T}_2] | \\Phi_0 \\rangle_c = 0\n$$\n双激发算符为 $\\hat{T}_2 = \\frac{1}{4}\\sum_{k,l,c,d} t_{kl}^{cd} a_c^\\dagger a_d^\\dagger a_l a_k$。对易子为：\n$$\n[\\hat{H}, \\hat{T}_2] = \\frac{1}{4} \\sum_{k,l,c,d} (\\epsilon_c + \\epsilon_d - \\epsilon_k - \\epsilon_l) t_{kl}^{cd} a_c^\\dagger a_d^\\dagger a_l a_k\n$$\n将其投影到 $\\langle \\Phi_{ij}^{ab} |$ 上得到：\n$$\n(\\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j) t_{ij}^{ab} = 0\n$$\n与之前一样，由于 $\\epsilon_{a,b} > \\epsilon_{i,j}$，前因子非零（除非出现偶然简并使其总和为零），这迫使对于所有的 $i,j,a,b$ 都有 $t_{ij}^{ab}=0$。这意味着 $\\hat{T}_2=0$。\n\n由于所有的单激发和双激发振幅均为零，则 $\\hat{T}_1=0$ 且 $\\hat{T}_2=0$。现在我们可以计算 CCSD 能量：\n$$\nE_{\\mathrm{CCSD}} = \\langle \\Phi_{0} | \\exp(-0)\\,\\hat{H}\\,\\exp(0) | \\Phi_{0} \\rangle = \\langle \\Phi_{0} | \\hat{H} | \\Phi_{0} \\rangle\n$$\n这仅仅是哈密顿量对于参考态的期望值，而我们已经证明这是一个本征值方程。\n$$\nE_{\\mathrm{CCSD}} = \\langle \\Phi_0 | E_0 | \\Phi_0 \\rangle = E_0 \\langle \\Phi_0 | \\Phi_0 \\rangle = E_0\n$$\n能量是占据最低能量自旋轨道的 $N$ 个电子的轨道能量之和。问题将已占据本征值的集合表示为 $\\{\\epsilon_i\\}$。如果我们将这 $N$ 个本征值标记为 $\\epsilon_1, \\epsilon_2, \\dots, \\epsilon_N$，总能量就是它们的和。\n\n$$\nE_{\\mathrm{CCSD}} = \\sum_{i=1}^{N} \\epsilon_i\n$$\n这个结果是符合预期的：因为对于这个特定的单体哈密顿量，Hartree-Fock 参考行列式就是精确的基态，所以任何旨在在完备极限下达到精确的多体方法，例如耦合簇理论，都必须返回精确的能量，即 Hartree-Fock 能量。", "answer": "$$\n\\boxed{\\sum_{i=1}^{N} \\epsilon_i}\n$$", "id": "2453787"}, {"introduction": "变分原理是量子力学的基石，它为系统的基态能量提供了一个严格的上限。然而，并非所有高级方法都遵循这一原理，这一事实具有深远的实践意义。本练习通过一个看似矛盾的 CCSD(T) 计算结果，来探讨非变分性这一关键概念，阐明为何“黄金标准”方法有时会得到低于给定基组下精确值的能量。[@problem_id:2453851]", "problem": "一名学生使用相同的有限单电子基组，对一个固定平衡构型的水分子进行了两次电子结构计算：一次是全组态相互作用 (FCI) 计算，另一次是耦合簇单、双激发及微扰三激发 [CCSD(T)] 计算。报告的 FCI 总电子能量为 $-76.0000$ hartree，而 CCSD(T) 能量为 $-76.0002$ hartree，即比 FCI 值低 $0.0002$ hartree。该学生询问这是否是一个错误，因为在给定的有限基组中 FCI 是精确的，并且应该为近似方法设定一个下界。\n\n从 Rayleigh–Ritz 变分原理以及量子化学中变分与非变分方法的定义出发，判断哪个陈述最能解释为什么在相同基组下 CCSD(T) 的值会低于 FCI 的值，以及为什么这本身并不意味着存在错误。\n\n选择一个选项：\n\n- A. CCSD(T) 方法不是变分方法：其投影能量表达式不是使用相同左矢和右矢的厄米算符的期望值，因此 Rayleigh–Ritz 上界性质不适用；所以，在有限基组中，$E_{\\mathrm{CCSD(T)}}$ 可能低于 $E_{\\mathrm{FCI}}$。\n\n- B. 因为耦合簇理论是尺寸广延的，所以在任何有限基组中，它总能得到比 FCI 更低的能量。\n\n- C. CCSD(T) 计算必须使用了比 FCI 计算更大的基组；否则 $E_{\\mathrm{CCSD(T)}}$ 不可能小于 $E_{\\mathrm{FCI}}$。\n\n- D. CCSD(T) 中的微扰三激发校正在构造上重复计算了相关能，这保证了其能量低于 FCI。\n\n- E. 水分子表现出近简并性，在这种情况下 CCSD(T) 与 FCI 变得相同，因此其能量可能由于数值噪音而略低于 FCI。", "solution": "必须首先验证问题陈述的有效性。\n\n**步骤1：提取已知条件**\n- 系统：固定平衡构型的水分子。\n- 基组：两次计算使用相同的有限单电子基组。\n- 计算1：全组态相互作用 (FCI)。\n- 能量1：$E_{\\mathrm{FCI}} = -76.0000$ hartree。\n- 计算2：耦合簇单、双激发及微扰三激发 [CCSD(T)]。\n- 能量2：$E_{\\mathrm{CCSD(T)}} = -76.0002$ hartree。\n- 观察：$E_{\\mathrm{CCSD(T)}} < E_{\\mathrm{FCI}}$。\n- 问题：基于 Rayleigh–Ritz 变分原理以及变分和非变分方法的定义来解释这一观察结果。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题建立在量子化学的核心原理之上。全组态相互作用 (FCI) 被正确定位为有限基组内非相对论薛定谔方程的精确解，因此，它是严格变分的。耦合簇理论，特别是 CCSD(T)，是一种标准的高精度方法。其非变分性是其公式体系的一个基本方面。所提供的能量值对于水分子来说是物理上合理的。\n- **适定性**：该问题是适定的。它呈现了一个场景，尽管对初学者来说似乎是矛盾的，但其背后有一个清晰且独特的解释，根植于所涉及方法的数学形式体系。它要求一个解释，并提供了足够的信息来构建这个解释。\n- **客观性**：该问题陈述客观，提供了数值数据并要求一个理论解释。没有主观或模棱两可的术语。\n\n**步骤3：结论与行动**\n问题陈述在科学上是合理的、适定的和客观的。没有矛盾或缺失的关键信息。该问题是有效的。可以继续求解过程。\n\n---\n\n这个问题的核心在于理解一种方法被称为“变分的”的数学性质。\n\nRayleigh–Ritz 变分原理指出，对于任何归一化的试探波函数 $|\\Psi_{\\text{trial}}\\rangle$，电子哈密顿算符 $\\hat{H}$ 的期望值提供了对精确基态能量 $E_0$ 的一个上界。\n$$\nE_{\\text{trial}} = \\frac{\\langle\\Psi_{\\text{trial}}|\\hat{H}|\\Psi_{\\text{trial}}\\rangle}{\\langle\\Psi_{\\text{trial}}|\\Psi_{\\text{trial}}\\rangle} \\geq E_0\n$$\n如果一种电子结构方法的能量正是通过这个期望值来计算的，那么它就被称为**变分**方法。\n\n**全组态相互作用 (FCI)** 将其波函数 $|\\Psi_{\\text{FCI}}\\rangle$ 构造为给定单电子基组内所有可能的斯莱特行列式的线性组合。该展开式的系数是通过对角化在此行列式基矢下的哈密顿矩阵来确定的。这个过程在数学上等同于最小化能量期望值 $\\langle\\Psi|\\hat{H}|\\Psi\\rangle$。因此，FCI 是一种变分方法。在给定的有限基组内，FCI 能量 $E_{\\text{FCI}}$ 是可能达到的最低能量，并作为该基组的基准 $E_0$。\n\n**耦合簇 (CC) 理论** 采用了一种不同的方法。CC 波函数是通过一个作用于参考态 $|\\Phi_0\\rangle$（通常是 Hartree-Fock 行列式）的指数拟设来构造的：\n$$\n|\\Psi_{\\text{CC}}\\rangle = e^{\\hat{T}}|\\Phi_0\\rangle\n$$\n其中 $\\hat{T} = \\hat{T}_1 + \\hat{T}_2 + \\dots$ 是产生激发的簇算符。对于 CCSD，这被截断为 $\\hat{T} \\approx \\hat{T}_1 + \\hat{T}_2$。\n\n关键在于，CC 能量**不是**作为期望值 $\\langle\\Psi_{\\text{CC}}|\\hat{H}|\\Psi_{\\text{CC}}\\rangle$ 来计算的。这样的表达式会产生一个无法在计算上处理的无穷项级数。相反，能量是通过将薛定谔方程投影到参考态和激发态上来获得的。标准单参考 CC 的能量表达式为：\n$$\nE_{\\text{CC}} = \\langle\\Phi_0|e^{-\\hat{T}}\\hat{H}e^{\\hat{T}}|\\Phi_0\\rangle = \\langle\\Phi_0|\\bar{H}|\\Phi_0\\rangle\n$$\n其中 $\\bar{H} = e^{-\\hat{T}}\\hat{H}e^{\\hat{T}}$ 是一个非厄米的、相似变换后的哈密顿算符。因为这个能量表达式不是 $\\langle\\Psi|\\hat{H}|\\Psi\\rangle$ 形式的真正期望值（它涉及到一个投影和一个非厄米算符），所以变分原理不适用。能量不保证是精确能量上界的方法被称为**非变分**方法。\n\n**CCSD(T)** 方法在 CCSD 能量的基础上进一步增加了一个对三激发的微扰校正 $E_{(T)}$：\n$$\nE_{\\text{CCSD(T)}} = E_{\\text{CCSD}} + E_{(T)}\n$$\n这个微扰校正也是非变分的。因此，整个 CCSD(T) 方法是非变分的。\n\n由于变分原理对 CCSD(T) 不成立，没有数学定理强制要求 $E_{\\text{CCSD(T)}}$ 必须大于或等于 $E_{\\text{FCI}}$。尽管 CCSD(T) 以其高精度而闻名，但其公式体系中固有的近似偶尔会导致对相关能的轻微过度估计，从而使得总能量低于该基组的精确 FCI 值。这是该方法的一个已知特性，并不表示计算错误。\n\n**评估选项：**\n\n- **A. CCSD(T) 方法不是变分方法：其投影能量表达式不是使用相同左矢和右矢的厄米算符的期望值，因此 Rayleigh–Ritz 上界性质不适用；所以，在有限基组中，$E_{\\mathrm{CCSD(T)}}$ 可能低于 $E_{\\mathrm{FCI}}$。**\n  这个陈述是一个精确且正确的解释。它正确地指出了 CCSD(T) 是非变分的。它准确地描述了原因——能量是通过投影得到的，而不是哈密顿算符与波函数的真正期望值，这违反了变分原理的条件。其结论——$E_{\\text{CCSD(T)}}$ 可能低于 $E_{\\text{FCI}}$——是正确的推论。\n  **结论：正确。**\n\n- **B. 因为耦合簇理论是尺寸广延的，所以在任何有限基组中，它总能得到比 FCI 更低的能量。**\n  这个陈述是有缺陷的。虽然耦合簇理论具有尺寸广延性（这对于计算大体系的能量是一个理想的性质），但这个性质与能量的变分特性无关。尺寸广延性确保能量随非相互作用粒子数的增加而正确地标度，但它并不决定能量相对于 FCI 值的位置。此外，“总能”得到更低能量的说法是错误的；根据体系的不同，$E_{\\text{CCSD(T)}}$ 可能高于、等于或低于 $E_{\\text{FCI}}$。\n  **结论：不正确。**\n\n- **C. CCSD(T) 计算必须使用了比 FCI 计算更大的基组；否则 $E_{\\mathrm{CCSD(T)}}$ 不可能小于 $E_{\\mathrm{FCI}}$。**\n  这个陈述直接与问题的一个前提相矛盾，该前提明确指出使用了“**相同的有限单电子基组**”。能量排序的解释在于方法的内在属性，而不是对问题条件的违反。\n  **结论：不正确。**\n\n- **D. CCSD(T) 中的微扰三激发校正在构造上重复计算了相关能，这保证了其能量低于 FCI。**\n  `(T)` 校正是一个从多体微扰理论推导出的系统性近似；它的设计并非为了“重复计算”能量。虽然其非变分性质可能导致过度校正（能量过低），但这并非必然结果，也不是由于像“构造上重复计算”这样的粗糙缺陷。声称这“保证”了能量低于 FCI 是错误的。\n  **结论：不正确。**\n\n- **E. 水分子表现出近简并性，在这种情况下 CCSD(T) 与 FCI 变得相同，因此其能量可能由于数值噪音而略低于 FCI。**\n  这个陈述包含多个错误。水分子在其平衡构型下是一个行为良好的单参考体系，不表现出显著的近简并性。对于像水这样的 10 电子体系，CCSD(T) 不会与 FCI 相同；它只在 2 电子体系中与 FCI 相同。在真正的近简并情况下，单参考 CCSD(T) 的表现会更差，而不是更好。最后，$0.0002$ hartree 的能量差异具有物理意义，不能归因于数值噪音，后者要小好几个数量级。\n  **结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2453851"}, {"introduction": "在计算化学中，更高的精度往往伴随着陡峭的计算成本。著名的 CCSD(T) 方法就是一个典型的例子，它提供了卓越的准确性，但需要大量的计算资源。本练习邀请您剖析 CCSD 及其 (T) 校正背后的数学运算，以理解它们各自计算标度 $O(N^6)$ 和 $O(N^7)$ 的来源，从而深入了解在实际应用中准确性与可行性之间的权衡。[@problem_id:2453857]", "problem": "在采用耦合簇单双激发 (CCSD) 及其微扰非迭代三激发校正 (T) 的分子轨道计算中，令占据自旋轨道的数量为 $O$，虚拟自旋轨道的数量为 $V$，系统大小 $N$ 作为单粒子基组的特征度量进行标度，因此 $O$ 和 $V$ 都随 $N$ 增长。考虑在分子轨道基组中表示的运算，使用反对称化的双电子积分 $\\langle p q \\Vert r s \\rangle$ 和簇幅 $t_{i}^{a}$ 及 $t_{i j}^{a b}$，其中，索引 $i,j,k,\\dots$ 表示占据轨道，$a,b,c,\\dots$ 表示虚拟轨道。名义计算成本通过计算主导张量缩并中所有自由和缩并轨道索引的范围来评估。\n\n哪个选项最好地解释了为什么 CCSD 部分的计算量标度为 $N^{6}$，而微扰三激发 (T) 部分的标度为 $N^{7}$，并正确指出了每种情况下最昂贵的缩并？\n\nA. CCSD 的瓶颈是双激发残差的缩并 $R_{i j}^{a b} \\leftarrow \\sum_{e f} \\langle a b \\Vert e f \\rangle \\, t_{i j}^{e f}$，其计算量标度为 $O^{2} V^{4}$，即 $N^{6}$。(T) 的瓶颈是通过诸如 $T_{i j k}^{a b c} \\leftarrow \\sum_{e} t_{i j}^{a e} \\, \\langle e k \\Vert b c \\rangle$ （加上置换）的缩并来构建三激发贡献，其计算量标度为 $O^{3} V^{4}$，即 $N^{7}$。\n\nB. CCSD 部分的计算量标度为 $N^{6}$，但 (T) 部分需要一个双虚拟内部求和，例如 $T_{i j k}^{a b c} \\leftarrow \\sum_{e f} t_{i j}^{a e} \\, \\langle e k \\Vert b f \\rangle$，因此其计算量标度为 $O^{3} V^{5}$，即 $N^{8}$。\n\nC. CCSD 和 (T) 的计算量标度均为 $N^{6}$，因为在能量表达式中没有显式出现对轨道索引的三重求和；因此，两者的首项都是 $O^{2} V^{4}$。\n\nD. CCSD 的瓶颈是一个单-双激发耦合项 $R_{i}^{a} \\leftarrow \\sum_{m e} \\langle a m \\Vert e i \\rangle \\, t_{m}^{e}$，其计算量标度为 $O^{3} V^{3}$，即 $N^{6}$，而 (T) 部分并不更昂贵，因为它需要显式存储 $t_{i j k}^{a b c}$，其在内存和操作上的标度均为 $O^{3} V^{3}$，即 $N^{6}$。\n\nE. CCSD 的瓶颈是占据-占据缩并 $R_{i j}^{a b} \\leftarrow \\sum_{m n} \\langle m n \\Vert i j \\rangle \\, t_{m n}^{a b}$，其计算量标度为 $O^{4} V^{2}$，即 $N^{6}$，而 (T) 的瓶颈是 $T_{i j k}^{a b c} \\leftarrow \\sum_{e} t_{i j}^{a e} \\, \\langle e k \\Vert b c \\rangle$，其计算量标度为 $O^{2} V^{4}$，即 $N^{6}$，因此 (T) 步骤不增加名义计算量标度。", "solution": "该问题陈述在科学上是合理的、表述清晰且客观的。它提供了计算量子化学领域的标准定义和符号。任务是分析耦合簇单双激发 (CCSD) 方法及其非迭代微扰三激发校正 (T) 的计算成本标度。我将进行分析。\n\n设 $O$ 为占据自旋轨道的数量，$V$ 为虚拟自旋轨道的数量。在典型的分子计算中，虚拟轨道的数量 $V$ 远大于占据轨道的数量 $O$，并且两者都随系统大小（我们用一个特征度量 $N$ 表示）而变化。我们假设 $O \\propto N$ 且 $V \\propto N$。算法的计算成本由浮点运算的次数决定，这通过计算计算最密集步骤（瓶颈）中对轨道索引的循环次数来估算。\n\n**CCSD 计算成本分析**\n\nCCSD 方法涉及迭代求解一组关于单激发 ($t_i^a$) 和双激发 ($t_{ij}^{ab}$) 簇幅的非线性方程组。计算成本主要由双激发幅的更新决定，这需要计算双激发残差 $R_{ij}^{ab}$。$R_{ij}^{ab}$ 的方程包含若干项，涉及簇幅张量和双电子积分 $\\langle pq \\Vert rs \\rangle$ 的缩并。瓶颈来自于涉及对多个轨道索引求和的项。最昂贵的项是：\n\n1.  求和中涉及两个虚拟索引的缩并：\n    $$R_{ij}^{ab} \\leftarrow \\dots + \\frac{1}{2} \\sum_{ef} \\langle ab \\Vert ef \\rangle t_{ij}^{ef} + \\dots$$\n    为了计算左侧残差张量的 $O^2V^2$ 个元素，此步骤涉及对两个虚拟索引 $e$ 和 $f$ 的求和。运算次数的标度为 $O^2 \\times V^2 \\times V^2 = O^2V^4$。由于 $O \\propto N$ 且 $V \\propto N$，此步骤的标度为 $N^2 \\times N^4 = N^6$。\n\n2.  求和中涉及两个占据索引的缩并：\n    $$R_{ij}^{ab} \\leftarrow \\dots + \\frac{1}{2} \\sum_{mn} \\langle mn \\Vert ij \\rangle t_{mn}^{ab} + \\dots$$\n    此步骤涉及对两个占据索引 $m$ 和 $n$ 的求和。运算次数的标度为 $O^2 \\times V^2 \\times O^2 = O^4V^2$。此步骤的标度也为 $N^4 \\times N^2 = N^6$。\n\n3.  求和中涉及一个占据索引和一个虚拟索引的缩并：\n    $$R_{ij}^{ab} \\leftarrow \\dots + \\mathcal{P}(ij)\\mathcal{P}(ab) \\sum_{me} \\langle mb \\Vert ej \\rangle t_{im}^{ae} + \\dots$$\n    其中 $\\mathcal{P}$ 是一个置换算符。此步骤涉及对一个占据索引 $m$ 和一个虚拟索引 $e$ 的求和。其标度为 $O^2V^2 \\times O \\times V = O^3V^3$，也即 $N^6$。\n\n所有这些步骤都导致 CCSD 的总体计算量标度为 $N^6$。由于通常 $V > O$，因此 $O^2V^4$ 项通常被认为是最主要的瓶颈。\n\n**CCSD(T) 计算成本分析**\n\n(T) 校正是对连通三激发效应的微扰估计，使用收敛的 CCSD 簇幅进行非迭代计算。能量校正的形式为：\n$$E_{(T)} \\propto \\sum_{i<j<k, a<b<c} \\frac{ |T_{ijk}^{abc}|^2 }{D_{ijk}^{abc}} $$\n其中 $D_{ijk}^{abc}$ 是轨道能分母，$T_{ijk}^{abc}$ 代表三激发的贡献。瓶颈是计算三激发部分，可以示意性地写为构建一个中间张量，例如：\n$$ Z_{ijk}^{abc} \\leftarrow \\mathcal{P}(i/jk)\\mathcal{P}(a/bc) \\left( \\sum_e t_{ij}^{ae} \\langle ek \\Vert bc \\rangle - \\sum_m t_{im}^{ab} \\langle mk \\Vert jc \\rangle \\right) $$\n其中 $\\mathcal{P}$ 表示对指定索引的置换。我们来分析每一项的成本：\n\n1.  第一项 $\\sum_e t_{ij}^{ae} \\langle ek \\Vert bc \\rangle$ 需要对一个虚拟索引 $e$ 进行求和。计算必须对所有自由索引 $i,j,k,a,b,c$ 的组合进行。运算次数的标度为 $O^3 \\times V^3$（对于自由索引）乘以 $V$（对于求和索引），总标度为 $O^3V^4$。这是一个 $N^7$ 步骤。\n\n2.  第二项 $\\sum_m t_{im}^{ab} \\langle mk \\Vert jc \\rangle$ 需要对一个占据索引 $m$ 进行求和。运算次数的标度为 $O^3 \\times V^3$（自由索引）乘以 $O$（求和索引），总标度为 $O^4V^3$。这也是一个 $N^7$ 步骤。\n\n构建三激发贡献是 CCSD(T) 计算的瓶颈。由于 $V>O$ 很常见，因此 $O^3V^4$ 步骤通常是速率决定步骤。因此，(T) 校正的总计算成本与 $N^7$ 成正比。\n\n**选项评估**\n\n*   **A. CCSD 的瓶颈是双激发残差的缩并 $R_{i j}^{a b} \\leftarrow \\sum_{e f} \\langle a b \\Vert e f \\rangle \\, t_{i j}^{e f}$，其计算量标度为 $O^{2} V^{4}$，即 $N^{6}$。(T) 的瓶颈是通过诸如 $T_{i j k}^{a b c} \\leftarrow \\sum_{e} t_{i j}^{a e} \\, \\langle e k \\Vert b c \\rangle$ （加上置换）的缩并来构建三激发贡献，其计算量标度为 $O^{3} V^{4}$，即 $N^{7}$。**\n    该陈述与我们的分析完全一致。它正确地指出了 CCSD 中的一个主要 $N^6$ 瓶颈项和 (T) 校正中的主要 $N^7$ 瓶颈项，以及它们正确的计算量标度。\n    **结论：正确。**\n\n*   **B. CCSD 部分的计算量标度为 $N^{6}$，但 (T) 部分需要一个双虚拟内部求和，例如 $T_{i j k}^{a b c} \\leftarrow \\sum_{e f} t_{i j}^{a e} \\, \\langle e k \\Vert b f \\rangle$，因此其计算量标度为 $O^{3} V^{5}$，即 $N^{8}$。**\n    (T) 校正的计算量标度不为 $N^8$。所提出的包含对两个虚拟索引求和（$\\sum_{ef}$）的缩并不属于标准 CCSD(T) 理论的一部分。(T) 部分正确的计算量标度是 $N^7$。\n    **结论：不正确。**\n\n*   **C. CCSD 和 (T) 的计算量标度均为 $N^{6}$，因为在能量表达式中没有显式出现对轨道索引的三重求和；因此，两者的首项都是 $O^{2} V^{4}$。**\n    这是不正确的。虽然 (T) 能量的最终求和是一个 $O^3V^3$ 操作（一个 $N^6$ 步骤），但计算求和内部项的成本更高。如前所述，构建三激发贡献是一个 $N^7$ 的过程。所提供的推理是有缺陷的。\n    **结论：不正确。**\n\n*   **D. CCSD 的瓶颈是一个单-双激发耦合项 $R_{i}^{a} \\leftarrow \\sum_{m e} \\langle a m \\Vert e i \\rangle \\, t_{m}^{e}$，其计算量标度为 $O^{3} V^{3}$，即 $N^{6}$，而 (T) 部分并不更昂贵，因为它需要显式存储 $t_{i j k}^{a b c}$，其在内存和操作上的标度均为 $O^{3} V^{3}$，即 $N^{6}$。**\n    该陈述在多个方面都是不正确的。首先，指定的项对单激发残差 $R_i^a$ 有贡献，其标度为 $O^2V^2$ ($N^4$)，而不是 $O^3V^3$，并且它不是 CCSD 的瓶颈。其次，它错误地将 (T) 部分的计算成本等同于 $t_{ijk}^{abc}$ 簇幅的内存存储（$O^3V^3 \\implies N^6$）。推导这些簇幅的计算成本是 $N^7$。\n    **结论：不正确。**\n\n*   **E. CCSD 的瓶颈是占据-占据缩并 $R_{i j}^{a b} \\leftarrow \\sum_{m n} \\langle m n \\Vert i j \\rangle \\, t_{m n}^{a b}$，其计算量标度为 $O^{4} V^{2}$，即 $N^{6}$，而 (T) 的瓶颈是 $T_{i j k}^{a b c} \\leftarrow \\sum_{e} t_{i j}^{a e} \\, \\langle e k \\Vert b c \\rangle$，其计算量标度为 $O^{2} V^{4}$，即 $N^{6}$，因此 (T) 步骤不增加名义计算量标度。**\n    CCSD 部分正确地指出了一个 $N^6$ 的瓶颈。然而，对 (T) 部分的分析是有缺陷的。缩并 $\\sum_{e} t_{i j}^{a e} \\, \\langle e k \\Vert b c \\rangle$ 有 $O^3V^3$ 个自由索引和对一个虚拟索引的求和，导致 $O^3V^4$ ($N^7$) 的计算量标度，而不是 $O^2V^4$ ($N^6$)。因此，(T) 步骤不增加计算量标度的结论是错误的。\n    **结论：不正确。**\n\n总而言之，选项 A 为 CCSD 和 (T) 校正的计算量标度提供了最好、最准确的解释。", "answer": "$$\\boxed{A}$$", "id": "2453857"}]}