{"hands_on_practices": [{"introduction": "掌握非简并微扰理论的最好方法是将其应用于一个具体的例子。第一个练习题 [@problem_id:2459481] 将让你计算无限深势阱中粒子基态的一阶能量修正，这是量子力学中的一个基石模型，当施加一个简单的余弦形状的微扰时。通过完成这个练习，你将巩固对核心公式 $E_n^{(1)} = \\langle \\psi_n^{(0)} | \\hat{H}' | \\psi_n^{(0)} \\rangle$ 的理解，并练习从建立积分到求解最终解析解的完整过程。", "problem": "考虑一个质量为 $m$ 的一维量子粒子，被限制在从 $x=-L/2$ 到 $x=+L/2$ 的一维无限深势阱中。未微扰势 $U(x)$ 在 $|x|<L/2$ 时为 $U(x)=0$，在 $|x|\\ge L/2$ 时为 $U(x)=\\infty$。因此，未微扰定态在势阱内部满足不含时薛定谔方程，边界条件为 $\\psi(\\pm L/2)=0$。在势阱内部施加一个弱的静态微扰 $V(x)=\\epsilon \\cos\\left(\\frac{\\pi x}{L}\\right)$（对于 $|x|<L/2$）和 $V(x)=0$（对于 $|x|\\ge L/2$），其中 $\\epsilon$ 是一个具有能量量纲的实数参数，且 $|\\epsilon|$ 足够小，可以采用一阶微扰处理。\n\n使用不含时非简并微扰理论，确定基态能量的一阶修正 $E_{1}^{(1)}$。请将最终答案表示为包含 $\\epsilon$ 和 $\\pi$ 的闭合形式解析表达式。", "solution": "在尝试任何解答之前，将首先对问题进行严格的验证过程。\n\n**步骤1：提取已知条件**\n- 粒子质量：$m$。\n- 未微扰势：$U(x) = 0$（对于 $|x| < L/2$）和 $U(x) = \\infty$（对于 $|x| \\ge L/2$）。这是一个宽度为 $L$、中心在原点的一维无限深势阱。\n- 未微扰波函数的边界条件：$\\psi(\\pm L/2) = 0$。\n- 微扰势：$V(x) = \\epsilon \\cos(\\frac{\\pi x}{L})$（对于 $|x| < L/2$）和 $V(x) = 0$（其他情况）。\n- 参数 $\\epsilon$：一个具有能量量纲的微小实常数。\n- 任务：使用不含时非简并微扰理论，确定基态能量的一阶修正 $E_{1}^{(1)}$。\n- 答案要求形式：一个用 $\\epsilon$ 和 $\\pi$ 表示的闭合形式表达式。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础**：该问题基于量子力学的基本原理。无限深方势阱是一个经典的入门问题，而微扰理论是求解更复杂量子系统的标准核心方法。微扰的形式在物理上是合理的。该问题在科学上是成立的。\n- **适定性**：该问题是适定的。它要求使用指定方法求一个特定的量 $E_{1}^{(1)}$。所有必要的信息都已提供。一维势阱的基态总 是非简并的，这正确地证明了使用非简并微扰理论的合理性。因此，存在一个唯一、稳定且有意义的解。\n- **客观性**：该问题使用精确、客观的数学和物理语言进行陈述，没有任何主观性或歧义。\n\n**步骤3：结论与行动**\n问题陈述在科学上是合理的、适定的、客观的和完整的。这是一个量子力学中的标准练习题。问题有效。我现在将继续进行解答。\n\n对于一个非简并态 $|n\\rangle$，其能量的一阶修正由微扰势在未微扰态 $|\\psi_{n}^{(0)}\\rangle$ 中的期望值给出。对于基态（$n=1$），这表示为：\n$$\nE_{1}^{(1)} = \\langle \\psi_{1}^{(0)} | V | \\psi_{1}^{(0)} \\rangle = \\int_{-\\infty}^{\\infty} (\\psi_{1}^{(0)}(x))^{*} V(x) \\psi_{1}^{(0)}(x) \\, dx\n$$\n该积分仅限于波函数非零的区域，即势阱内部从 $x = -L/2$ 到 $x = +L/2$ 的范围。\n\n首先，我们必须确定中心在原点的无限深势阱的未微扰基态波函数 $\\psi_{1}^{(0)}(x)$。势阱内部的不含时薛定谔方程为：\n$$\n-\\frac{\\hbar^2}{2m} \\frac{d^2\\psi(x)}{dx^2} = E \\psi(x)\n$$\n势 $U(x)$ 是一个偶函数，因此解将具有确定的宇称。基态必须是势阱内部非零且满足边界条件 $\\psi(\\pm L/2) = 0$ 的能量最低的解。这对应于一个偶函数，即余弦函数。偶函数解的通解形式为 $\\psi_n(x) = A \\cos(k_n x)$，其中边界条件 $\\cos(k_n L/2)=0$ 意味着对于奇数 $n=1, 3, 5, \\dots$，有 $k_n L/2 = \\frac{n\\pi}{2}$。基态对应于 $n=1$，所以 $k_1 = \\pi/L$。\n因此，未微扰基态波函数为：\n$$\n\\psi_{1}^{(0)}(x) = A \\cos\\left(\\frac{\\pi x}{L}\\right)\n$$\n归一化常数 $A$ 通过要求 $\\int_{-L/2}^{L/2} |\\psi_{1}^{(0)}(x)|^2 \\, dx = 1$ 来找到：\n$$\nA^2 \\int_{-L/2}^{L/2} \\cos^2\\left(\\frac{\\pi x}{L}\\right) \\, dx = 1\n$$\n使用恒等式 $\\cos^2(\\theta) = \\frac{1}{2}(1 + \\cos(2\\theta))$：\n$$\nA^2 \\int_{-L/2}^{L/2} \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{2\\pi x}{L}\\right)\\right) \\, dx = A^2 \\frac{1}{2} \\left[x + \\frac{L}{2\\pi}\\sin\\left(\\frac{2\\pi x}{L}\\right)\\right]_{-L/2}^{L/2} = A^2 \\frac{1}{2} \\left(L\\right) = 1\n$$\n这得到 $A^2 = 2/L$，所以 $A = \\sqrt{2/L}$。归一化后的未微扰基态波函数为：\n$$\n\\psi_{1}^{(0)}(x) = \\sqrt{\\frac{2}{L}} \\cos\\left(\\frac{\\pi x}{L}\\right) \\quad \\text{for } |x| < L/2\n$$\n现在我们可以计算一阶能量修正。波函数是实数，所以 $(\\psi_{1}^{(0)}(x))^* = \\psi_{1}^{(0)}(x)$。\n$$\nE_{1}^{(1)} = \\int_{-L/2}^{L/2} \\left(\\sqrt{\\frac{2}{L}} \\cos\\left(\\frac{\\pi x}{L}\\right)\\right)^2 \\left(\\epsilon \\cos\\left(\\frac{\\pi x}{L}\\right)\\right) \\, dx\n$$\n$$\nE_{1}^{(1)} = \\frac{2\\epsilon}{L} \\int_{-L/2}^{L/2} \\cos^3\\left(\\frac{\\pi x}{L}\\right) \\, dx\n$$\n为了计算这个积分，我们进行变量替换。令 $u = \\frac{\\pi x}{L}$。那么 $du = \\frac{\\pi}{L} dx$，或 $dx = \\frac{L}{\\pi} du$。积分限从 $x = -L/2$ 变为 $u = -\\pi/2$，从 $x = L/2$ 变为 $u = \\pi/2$。\n$$\nE_{1}^{(1)} = \\frac{2\\epsilon}{L} \\int_{-\\pi/2}^{\\pi/2} \\cos^3(u) \\left(\\frac{L}{\\pi}\\right) \\, du = \\frac{2\\epsilon}{\\pi} \\int_{-\\pi/2}^{\\pi/2} \\cos^3(u) \\, du\n$$\n我们使用三角恒等式 $\\cos^3(u) = \\cos(u)(1-\\sin^2(u))$。\n$$\n\\int \\cos^3(u) \\, du = \\int (1 - \\sin^2(u)) \\cos(u) \\, du\n$$\n令 $v = \\sin(u)$，则 $dv = \\cos(u) \\, du$。积分变为：\n$$\n\\int (1-v^2) \\, dv = v - \\frac{v^3}{3} = \\sin(u) - \\frac{\\sin^3(u)}{3}\n$$\n现在我们计算该定积分：\n$$\n\\int_{-\\pi/2}^{\\pi/2} \\cos^3(u) \\, du = \\left[\\sin(u) - \\frac{\\sin^3(u)}{3}\\right]_{-\\pi/2}^{\\pi/2}\n$$\n$$\n= \\left(\\sin\\left(\\frac{\\pi}{2}\\right) - \\frac{\\sin^3\\left(\\frac{\\pi}{2}\\right)}{3}\\right) - \\left(\\sin\\left(-\\frac{\\pi}{2}\\right) - \\frac{\\sin^3\\left(-\\frac{\\pi}{2}\\right)}{3}\\right)\n$$\n因为 $\\sin(\\pi/2) = 1$ 且 $\\sin(-\\pi/2) = -1$：\n$$\n= \\left(1 - \\frac{1^3}{3}\\right) - \\left(-1 - \\frac{(-1)^3}{3}\\right) = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\n将此结果代回到 $E_{1}^{(1)}$ 的表达式中：\n$$\nE_{1}^{(1)} = \\frac{2\\epsilon}{\\pi} \\left(\\frac{4}{3}\\right) = \\frac{8\\epsilon}{3\\pi}\n$$\n因此，基态能量的一阶修正是 $\\frac{8\\epsilon}{3\\pi}$。结果按要求正确地用 $\\epsilon$ 和 $\\pi$ 表示。", "answer": "$$\n\\boxed{\\frac{8\\epsilon}{3\\pi}}\n$$", "id": "2459481"}, {"introduction": "在计算了一个非零的能量修正之后，我们现在来探讨一种一阶效应消失的情况，这揭示了一个更深层次的物理原理。在这个练习中 [@problem_id:2459507]，你将研究一个受线性微扰的量子谐振子——另一个基本模型——并发现其一阶能量移动为零。这个结果并非计算上的巧合，它突显了对称性在量子系统中的深刻作用，并展示了优雅的升降算符形式如何能简化计算并提供直接的物理洞察。", "problem": "在计算光谱学中，双原子分子在其平衡构型附近的单个振动简正模可以被建模为一个一维量子谐振子，其坐标为 $x$，有效质量为 $m$，角频率为 $\\omega$。未微扰哈密顿量为\n$$\n\\hat{H}_{0}=\\frac{\\hat{p}^{2}}{2m}+\\frac{1}{2}m\\omega^{2}\\hat{x}^{2},\n$$\n其本征态 $\\{|n\\rangle\\}_{n=0}^{\\infty}$ 是非简并的。\n\n假设一个外部均匀场与简正坐标线性耦合，产生一个微扰\n$$\n\\hat{V} = c\\,\\hat{x},\n$$\n其中 $c$ 是一个实常数。\n\n使用非简并定态微扰理论，从第一性原理出发，确定由于微扰 $\\hat{V}$ 导致的状态 $|n\\rangle$ 的能量一阶修正。请以一个单独的闭合形式解析表达式给出你的最终答案，根据需要使用符号 $m$、$\\omega$、\\hbar、$c$ 和 $n$ 表示。不需要进行数值计算或四舍五入。", "solution": "首先必须验证所述问题的科学和逻辑一致性。\n\n**步骤1：提取已知条件**\n- 该系统是一个一维量子谐振子（QHO），作为双原子分子振动简正模的模型。\n- 坐标为 $x$。\n- 有效质量为 $m$。\n- 角频率为 $\\omega$。\n- 未微扰哈密顿量为 $\\hat{H}_{0}=\\frac{\\hat{p}^{2}}{2m}+\\frac{1}{2}m\\omega^{2}\\hat{x}^{2}$。\n- $\\hat{H}_{0}$ 的本征态是 $\\{|n\\rangle\\}_{n=0}^{\\infty}$，问题陈述其为非简并的。\n- 微扰为 $\\hat{V} = c\\,\\hat{x}$。\n- 常数 $c$ 是一个实常数。\n- 目标是确定状态 $|n\\rangle$ 能量的一阶修正。\n\n**步骤2：使用提取的已知条件进行验证**\n根据有效性标准对问题进行评估。\n1.  **基于科学原理**：该问题牢固地建立在量子力学原理之上。量子谐振子是一个基本的、精确可解的模型，而线性微扰的概念是斯塔克效应等课题中的标准内容。该问题在科学上是合理的。\n2.  **适定性**：该问题要求一个从标准的、适定的物理模型（受微扰的QHO）中推导出的特定、定义明确的量（能量的一阶修正）。一维QHO的本征态确实是非简并的，这为使用非简并微扰理论提供了依据。该问题的结构决定了其具有唯一且有意义的解。\n3.  **客观性**：该问题以精确的数学和物理语言陈述，没有任何主观性或模糊性。\n\n**步骤3：结论与行动**\n问题是有效的。这是非简并定态微扰理论中的一个标准练习题。下面将推导求解。\n\n**求解推导**\n根据非简并定态微扰理论的原理，对于受微扰 $\\hat{V}$ 作用的未微扰哈密顿量 $\\hat{H}_0$ 的一个本征态 $|n\\rangle$，其能量的一阶修正 $E_n^{(1)}$ 由该微扰在未微扰态下的期望值给出。\n$$\nE_{n}^{(1)} = \\langle n | \\hat{V} | n \\rangle\n$$\n将给定的微扰 $\\hat{V} = c\\,\\hat{x}$ 代入此表达式，我们得到：\n$$\nE_{n}^{(1)} = \\langle n | c\\,\\hat{x} | n \\rangle\n$$\n由于 $c$ 是一个实常数，可以从内积中提取出来：\n$$\nE_{n}^{(1)} = c \\langle n | \\hat{x} | n \\rangle\n$$\n为了计算矩阵元 $\\langle n | \\hat{x} | n \\rangle$，最方便的方法是用阶梯（湮灭和产生）算符 $\\hat{a}$ 和 $\\hat{a}^\\dagger$ 来表示位置算符 $\\hat{x}$。位置算符由下式给出：\n$$\n\\hat{x} = \\sqrt{\\frac{\\hbar}{2m\\omega}} (\\hat{a} + \\hat{a}^\\dagger)\n$$\n阶梯算符对数子本征态 $|n\\rangle$ 的作用定义如下：\n$$\n\\hat{a} | n \\rangle = \\sqrt{n} | n-1 \\rangle \\quad (\\text{对于 } n \\ge 1) \\quad \\text{和} \\quad \\hat{a}|0\\rangle = 0\n$$\n$$\n\\hat{a}^\\dagger | n \\rangle = \\sqrt{n+1} | n+1 \\rangle\n$$\n将 $\\hat{x}$ 的表达式代入期望值，得到：\n$$\n\\langle n | \\hat{x} | n \\rangle = \\left\\langle n \\left| \\sqrt{\\frac{\\hbar}{2m\\omega}} (\\hat{a} + \\hat{a}^\\dagger) \\right| n \\right\\rangle = \\sqrt{\\frac{\\hbar}{2m\\omega}} \\left( \\langle n | \\hat{a} | n \\rangle + \\langle n | \\hat{a}^\\dagger | n \\rangle \\right)\n$$\n我们分别计算这两个矩阵元。\n对于包含湮灭算符 $\\hat{a}$ 的第一项：\n$$\n\\langle n | \\hat{a} | n \\rangle = \\langle n | \\sqrt{n} | n-1 \\rangle = \\sqrt{n} \\langle n | n-1 \\rangle\n$$\n对于包含产生算符 $\\hat{a}^\\dagger$ 的第二项：\n$$\n\\langle n | \\hat{a}^\\dagger | n \\rangle = \\langle n | \\sqrt{n+1} | n+1 \\rangle = \\sqrt{n+1} \\langle n | n+1 \\rangle\n$$\n量子谐振子的本征态 $\\{|k\\rangle\\}$ 构成一个规范正交集，这意味着它们的内积满足关系式 $\\langle j | k \\rangle = \\delta_{jk}$，其中 $\\delta_{jk}$ 是克罗内克δ函数。因此，对于 $n \\ne n-1$ 和 $n \\ne n+1$：\n$$\n\\langle n | n-1 \\rangle = 0\n$$\n$$\n\\langle n | n+1 \\rangle = 0\n$$\n因此，两个矩阵元均为零：\n$$\n\\langle n | \\hat{a} | n \\rangle = 0 \\quad \\text{和} \\quad \\langle n | \\hat{a}^\\dagger | n \\rangle = 0\n$$\n这导出一个结论：对于谐振子的任何定态，位置算符的期望值都为零：\n$$\n\\langle n | \\hat{x} | n \\rangle = \\sqrt{\\frac{\\hbar}{2m\\omega}} (0 + 0) = 0\n$$\n这个结果也可以从对称性论证来理解。未微扰势 $V_0(x) = \\frac{1}{2}m\\omega^2x^2$ 是 $x$ 的偶函数。对于所有的 $n$，概率密度 $|\\psi_n(x)|^2 = |\\langle x | n \\rangle|^2$ 也是 $x$ 的偶函数。$x$ 的期望值的被积函数，即 $x|\\psi_n(x)|^2$，是一个奇函数。奇函数在对称区间 $(-\\infty, \\infty)$ 上的积分恒等于零。\n\n最后，将此结果代回能量一阶修正的表达式中，我们得到：\n$$\nE_{n}^{(1)} = c \\cdot 0 = 0\n$$\n对于所有能级 $n$，能量的一阶修正均为零。尽管高阶修正（如二阶修正 $E_n^{(2)}$）不为零，但问题只要求一阶修正。", "answer": "$$\n\\boxed{0}\n$$", "id": "2459507"}, {"introduction": "从解析计算过渡到计算验证，这个实践为微扰理论提供了一个强大的现代视角。你的任务 [@problem_id:2459557] 是编写一个简短的程序，将微扰理论（截至二阶）预测的能量与通过数值对角化一个多能级系统的完整哈密顿量得到的精确能量进行比较。这个动手编程练习使你能够亲眼见证微扰近似的准确性，更重要的是，能够探究其在近简并或强耦合等条件下的局限性——这些情景在真实的计算化学中至关重要。", "problem": "给定一个用于计算化学建模的定态三能级量子系统。其哈密顿量定义为 $H(\\lambda) = H_0 + \\lambda V$，其中 $H_0$ 是一个对角元互不相同的实数对角矩阵，$V$ 是一个实对称矩阵，$\\lambda$ 是一个实标量参数。假设系统在 $\\lambda=0$ 时是非简并的，即 $H_0$ 的本征值全部互不相同。所有能量均为无量纲；不包含单位。\n\n您的任务是编写一个完整的程序，对每个指定的测试用例执行以下操作：\n- 计算 $H(\\lambda)$ 的本征值作为精确能量。\n- 对每个未微扰态，使用非简并微扰论计算至二阶（含二阶）的能量预测值。\n- 通过将每个微扰能量与一个精确能量一一对应，以最小化三个态的总绝对偏差的方式，来比较这两组能量，然后返回三个对应能量对中的最大绝对偏差。\n- 为每个测试用例报告一个浮点数，即这个最大绝对偏差，四舍五入到 $10$ 位小数。\n\n请使用以下测试集。对于每个用例，$H_0 = \\mathrm{diag}(E_1^{(0)}, E_2^{(0)}, E_3^{(0)})$ 且 $V = (v_{ij})$，其中 $v_{ij} = v_{ji}$。\n\n测试用例 $1$ (一般情况):\n- $E^{(0)} = (0, 1, 2)$\n- $V = \\begin{pmatrix} 0.20 & 0.05 & -0.02 \\\\ 0.05 & -0.10 & 0.03 \\\\ -0.02 & 0.03 & 0.05 \\end{pmatrix}$\n- $\\lambda = 0.10$\n\n测试用例 $2$ (零耦合边界情况):\n- $E^{(0)} = (0, 1, 2)$\n- $V = \\begin{pmatrix} 0.20 & 0.05 & -0.02 \\\\ 0.05 & -0.10 & 0.03 \\\\ -0.02 & 0.03 & 0.05 \\end{pmatrix}$\n- $\\lambda = 0$\n\n测试用例 $3$ (仅对角微扰):\n- $E^{(0)} = (0, 1, 2)$\n- $V = \\begin{pmatrix} 0.30 & 0 & 0 \\\\ 0 & -0.20 & 0 \\\\ 0 & 0 & 0.10 \\end{pmatrix}$\n- $\\lambda = 0.30$\n\n测试用例 $4$ (近简并的未微扰能谱):\n- $E^{(0)} = (0, 0.001, 1)$\n- $V = \\begin{pmatrix} 0.01 & 0.02 & -0.01 \\\\ 0.02 & -0.02 & 0.015 \\\\ -0.01 & 0.015 & 0.005 \\end{pmatrix}$\n- $\\lambda = 0.05$\n\n测试用例 $5$ (强耦合压力测试):\n- $E^{(0)} = (0, 1, 3)$\n- $V = \\begin{pmatrix} 0 & 0.20 & 0.10 \\\\ 0.20 & 0 & -0.15 \\\\ 0.10 & -0.15 & 0.25 \\end{pmatrix}$\n- $\\lambda = 0.50$\n\n对于每个测试用例，最大绝对偏差定义如下。设精确能量为 $H(\\lambda)$ 的三个本征值，微扰能量为由未微扰能级 $n \\in \\{1,2,3\\}$ 标记的三个二阶非简并微扰论预测值。确定三个微扰能量和三个精确能量之间的一一对应关系，以使绝对偏差之和最小化。然后取这三个对应能量对中的最大绝对偏差。将此最大绝对偏差四舍五入到 $10$ 位小数，生成该测试用例的单个浮点数结果。\n\n最终输出格式：您的程序应生成单行输出，其中包含五个测试用例的结果，形式为方括号内由逗号分隔的列表，无空格，且每个浮点数精确到 $10$ 位小数（例如：\"[$0.0000000000,0.1234567890,0.0000000000,0.0000123456,0.0012345678$]\"）。", "solution": "所给问题是计算量子化学中的一个标准练习，具体涉及定态非简并微扰论的应用和验证。该问题提法明确，科学上合理，并包含了获得唯一解所需的所有信息。我们将采用严谨的推导和计算策略。\n\n系统由哈密顿量 $H(\\lambda) = H_0 + \\lambda V$ 描述，其中 $H_0$ 是未微扰哈密顿量，$\\lambda V$ 是微扰。在给定基下，未微扰哈密顿量 $H_0$ 是对角矩阵，其本征值为未微扰能量 $E_n^{(0)}$，本征矢量 $|n^{(0)}\\rangle$ 为标准基矢量。对于一个三能级系统，我们有：\n$$ H_0 = \\begin{pmatrix} E_1^{(0)} & 0 & 0 \\\\ 0 & E_2^{(0)} & 0 \\\\ 0 & 0 & E_3^{(0)} \\end{pmatrix} $$\n相应的未微扰本征矢量为 $|1^{(0)}\\rangle = (1, 0, 0)^T$、 $|2^{(0)}\\rangle = (0, 1, 0)^T$ 和 $|3^{(0)}\\rangle = (0, 0, 1)^T$。问题陈述保证了未微扰能量 $E_1^{(0)}$、$E_2^{(0)}$ 和 $E_3^{(0)}$ 是互不相同的，满足了非简并微扰论的条件。\n\n我们的任务对每个测试用例包含两个主要计算：\n$1$. 完整哈密顿量 $H(\\lambda)$ 的精确能量。\n$2$. 非简并微扰论预测的截至二阶的近似能量。\n\n**1. 精确能量计算**\n\n完整哈密顿量是矩阵和 $H(\\lambda) = H_0 + \\lambda V$。由于 $H_0$ 是对角矩阵，$V$ 是实对称矩阵，因此 $H(\\lambda)$ 也是一个实对称矩阵。系统的精确能量是该矩阵的本征值。对于给定的测试用例，根据指定的 $E^{(0)}$、$V$ 和 $\\lambda$，我们构建 $3 \\times 3$ 矩阵 $H(\\lambda)$ 并计算其本征值。这是一个标准的数值线性代数问题，可以通过对角化矩阵轻松解决。这三个本征值的集合将表示为 $\\{E_{\\text{exact},i}\\}$。\n\n**2. 微扰能量计算**\n\n非简并微扰论为能量本征值 $E_n$ 和本征态提供了关于微扰参数 $\\lambda$ 的幂级数展开。对应于未微扰能级 $E_n^{(0)}$ 的能量 $E_n$ 由下式给出：\n$$ E_n(\\lambda) = E_n^{(0)} + \\lambda E_n^{(1)} + \\lambda^2 E_n^{(2)} + O(\\lambda^3) $$\n问题要求计算到二阶。\n\n能量的一阶修正 $E_n^{(1)}$ 是微扰势 $V$ 在未微扰态 $|n^{(0)}\\rangle$ 下的期望值：\n$$ E_n^{(1)} = \\langle n^{(0)} | V | n^{(0)} \\rangle = V_{nn} $$\n其中 $V_{nn}$ 是矩阵 $V$ 的第 $n$ 个对角元。\n\n能量的二阶修正 $E_n^{(2)}$ 涉及不同未微扰态之间 $V$ 的矩阵元：\n$$ E_n^{(2)} = \\sum_{k \\neq n} \\frac{|\\langle k^{(0)} | V | n^{(0)} \\rangle|^2}{E_n^{(0)} - E_k^{(0)}} = \\sum_{k \\neq n} \\frac{|V_{kn}|^2}{E_n^{(0)} - E_k^{(0)}} $$\n其中 $V_{kn}$ 是 $V$ 的非对角元。由于非简并条件，分母 $E_n^{(0)} - E_k^{(0)}$ 非零。\n\n因此，第 $n$ 个能级的截至二阶的总近似能量为：\n$$ E_{n, \\text{pert}} = E_n^{(0)} + \\lambda V_{nn} + \\lambda^2 \\sum_{k \\neq n} \\frac{|V_{kn}|^2}{E_n^{(0)} - E_k^{(0)}} $$\n我们对三个未微扰能级 $n \\in \\{1, 2, 3\\}$ 中的每一个计算该值，以获得三个微扰能量的集合 $\\{E_{n, \\text{pert}}\\}$。\n\n**3. 比较与偏差分析**\n\n为了将精确能量 $\\{E_{\\text{exact},i}\\}$ 与微扰能量 $\\{E_{n, \\text{pert}}\\}$ 进行比较，我们必须找到两组数据之间的最优配对。问题将其定义为使绝对偏差之和最小化的一一对应关系。对于两组实数，通过将两组数按升序排序并配对相应元素即可实现此最小值。设排序后的精确能量为 $E'_{\\text{exact},1} \\le E'_{\\text{exact},2} \\le E'_{\\text{exact},3}$，排序后的微扰能量为 $E'_{\\text{pert},1} \\le E'_{\\text{pert},2} \\le E'_{\\text{pert},3}$。最优配对为 $(E'_{\\text{exact},i}, E'_{\\text{pert},i})$，其中 $i=1, 2, 3$。\n\n每对的绝对偏差为 $\\Delta_i = |E'_{\\text{exact},i} - E'_{\\text{pert},i}|$。每个测试用例要报告的最终量是这些偏差中的最大值：\n$$ \\text{Max Deviation} = \\max(\\Delta_1, \\Delta_2, \\Delta_3) $$\n\n将对所提供的五个测试用例中的每一个执行此程序。数值计算将使用标准矩阵库进行，最终结果将按指定格式进行格式化。对于 $\\lambda=0$ 或 $V$ 是对角矩阵的情况，我们预期偏差为零，因为在这些条件下微扰论是精确的。具有近简并未微扰能量或较大 $\\lambda$ 值的用例，旨在测试微扰近似的极限。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational chemistry problem for a series of test cases.\n    For each case, it computes exact vs. second-order perturbative energies,\n    and finds the maximum absolute deviation between optimally paired results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (unperturbed energies E0, perturbation matrix V, parameter lambda)\n    test_cases = [\n        # Test case 1 (general case)\n        (\n            [0.0, 1.0, 2.0],\n            [[0.20, 0.05, -0.02], [0.05, -0.10, 0.03], [-0.02, 0.03, 0.05]],\n            0.10,\n        ),\n        # Test case 2 (boundary case with zero coupling)\n        (\n            [0.0, 1.0, 2.0],\n            [[0.20, 0.05, -0.02], [0.05, -0.10, 0.03], [-0.02, 0.03, 0.05]],\n            0.0,\n        ),\n        # Test case 3 (diagonal perturbation only)\n        (\n            [0.0, 1.0, 2.0],\n            [[0.30, 0.0, 0.0], [0.0, -0.20, 0.0], [0.0, 0.0, 0.10]],\n            0.30,\n        ),\n        # Test case 4 (near-degenerate unperturbed spectrum)\n        (\n            [0.0, 0.001, 1.0],\n            [[0.01, 0.02, -0.01], [0.02, -0.02, 0.015], [-0.01, 0.015, 0.005]],\n            0.05,\n        ),\n        # Test case 5 (stronger coupling stress test)\n        (\n            [0.0, 1.0, 3.0],\n            [[0.0, 0.20, 0.10], [0.20, 0.0, -0.15], [0.10, -0.15, 0.25]],\n            0.50,\n        ),\n    ]\n\n    results = []\n    for E0_diag, V_matrix, lam in test_cases:\n        # Convert inputs to numpy arrays for calculation\n        E0 = np.array(E0_diag)\n        V = np.array(V_matrix)\n        n_levels = len(E0)\n\n        # 1. Exact Energy Calculation\n        # Construct the unperturbed Hamiltonian H0 and the full Hamiltonian H\n        H0 = np.diag(E0)\n        H_full = H0 + lam * V\n        # Compute the exact eigenvalues of the full Hamiltonian.\n        # np.linalg.eigh is used for Hermitian matrices and returns sorted eigenvalues.\n        exact_energies = np.linalg.eigh(H_full)[0]\n\n        # 2. Perturbative Energy Calculation\n        pert_energies = np.zeros(n_levels)\n        for n in range(n_levels):\n            # Zeroth-order energy\n            E_n_0 = E0[n]\n\n            # First-order energy correction coefficient\n            E_n_1 = V[n, n]\n\n            # Second-order energy correction coefficient\n            E_n_2 = 0.0\n            for k in range(n_levels):\n                if k == n:\n                    continue\n                # The denominator is guaranteed non-zero by problem statement\n                denominator = E_n_0 - E0[k]\n                # V is real and symmetric, so V_kn = V_nk\n                numerator = V[k, n] ** 2\n                E_n_2 += numerator / denominator\n\n            # Total energy up to second order in lambda\n            pert_energies[n] = E_n_0 + lam * E_n_1 + (lam ** 2) * E_n_2\n\n        # 3. Comparison and Deviation Analysis\n        # To find the optimal pairing that minimizes the sum of absolute deviations,\n        # we sort both sets of energies and pair them element-wise.\n        # `exact_energies` is already sorted by `eigh`. We must sort `pert_energies`.\n        pert_energies.sort()\n\n        # Calculate the absolute deviations for the optimal pairing\n        deviations = np.abs(exact_energies - pert_energies)\n\n        # The result for this case is the largest absolute deviation\n        max_deviation = np.max(deviations)\n        results.append(f\"{max_deviation:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\n\nsolve()\n```", "id": "2459557"}]}