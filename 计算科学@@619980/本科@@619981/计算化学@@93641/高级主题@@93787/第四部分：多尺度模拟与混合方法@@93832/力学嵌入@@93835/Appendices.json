{"hands_on_practices": [{"introduction": "在运行复杂的模拟之前，能够预测不同模型将在何种情况下产生不同结果是一项至关重要的技能。本练习旨在挑战你设计一个极简的 QM/MM 系统，在该系统中，机械嵌入和静电嵌入的选择会导致结果出现本质上的差异。这项实践将帮助你深入理解分子极性在决定嵌入方案成败中的核心作用。[@problem_id:2455000]", "problem": "要求您提出一个最小的量子力学/分子力学 (QM/MM) 设置，在使用机械嵌入与静电嵌入时，该设置将为量子力学 (QM) 区域产生定性上不同的优化几何构型。在机械嵌入中，QM 哈密顿量排除了与分子力学 (MM) 区域的所有静电相互作用，并且区域间的耦合仅限于非静电项。在静电嵌入中，固定的 MM 点电荷作为外部静电势进入 QM 哈密顿量，该电势在 QM 优化过程中作用于 QM 电子和原子核。对于本问题，假设 MM 区域仅由具有指定大小和位置的固定点电荷组成，并且没有与 QM 区域耦合的成键项或范德华项。QM/MM 边界不切割共价键。请注意，“定性上不同的几何构型”意味着取向的改变或内坐标的显著变化（例如，与外场对齐的显著键长伸长），而不仅仅是微小的数值扰动。\n\n根据这些假设，选择最有可能在机械嵌入和静电嵌入之间为 QM 区域产生定性上不同的优化 QM 几何构型的选项。\n\nA. QM 区域：氟化氢 (HF)，视作孤立分子。MM 区域：一个电荷量为 $+1e$ 的固定点电荷，位于 H–F 轴的延长线上，在氢原子一侧，距离氢原子 $2.0\\,\\text{\\AA}$。MM 区域仅包含此点电荷。\n\nB. QM 区域：甲烷 ($\\text{CH}_{4}$)，视作孤立分子。MM 区域：一个电荷量为 $+1e$ 的固定点电荷，位于沿某一 C–H 键方向，距离碳原子 $2.0\\,\\text{\\AA}$ 处。MM 区域仅包含此点电荷。\n\nC. QM 区域：苯 ($\\text{C}_{6}\\text{H}_{6}$)，视作孤立分子。MM 区域：两个固定的点电荷，电荷量分别为 $+1e$ 和 $-1e$，放置在穿过苯环中心的环法线上，一个在环平面上方 $+2.0\\,\\text{\\AA}$ 处，另一个在环平面下方 $-2.0\\,\\text{\\AA}$ 处（即，对称地位于环中心上方和下方）。MM 区域仅包含这两个点电荷。\n\nD. QM 区域：水 ($\\text{H}_{2}\\text{O}$)，视作孤立分子。MM 区域：一个电荷量为 $+1e$ 的固定点电荷，与一个 O-H 键共线，位于该氢原子一侧，距离该氢原子 $1.8\\,\\text{\\AA}$。MM 区域仅包含此点电荷。\n\n选择所有适用选项。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- **方法比较：** 量子力学/分子力学 (QM/MM) 中的机械嵌入与静电嵌入。\n- **机械嵌入定义：** 量子力学 (QM) 哈密顿量 $\\hat{H}_{\\text{QM}}$ 排除了与分子力学 (MM) 区域的所有静电相互作用。耦合仅限于非静电项。在本问题中，MM 区域没有成键项或范德华项，因此机械嵌入相当于将 QM 区域视为孤立的气相系统处理。\n- **静电嵌入定义：** 固定的 MM 点电荷作为外势 $\\hat{V}_{\\text{ext}}$ 被包含在 QM 哈密顿量中。总哈密顿量为 $\\hat{H}_{\\text{QM/MM}} = \\hat{H}_{\\text{QM}} + \\hat{V}_{\\text{ext}}$。该势作用于 QM 电子和原子核。\n- **MM 区域定义：** 仅由指定位置和大小的固定点电荷组成。\n- **边界条件：** QM/MM 边界不与任何共价键相交。\n- **成功标准：** 在两种嵌入方案之间，QM 区域的优化几何构型必须“定性上不同”。定性上不同的几何构型定义为取向的改变或内坐标的显著变化。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于计算化学中的基本和标准概念，特别是 QM/MM 理论。机械嵌入和静电嵌入的定义是正确且被广泛使用的。\n- **适定性：** 该问题是适定的。它要求根据一个明确的标准来评估几种离散的物理情景。简化的模型被明确定义，使得问题是自洽的，并且可以通过应用静电学和分子结构的原理来解决。\n- **客观性：** 问题以精确、客观、科学的语言陈述。“定性上不同的几何构型”这一标准在比较这些理想化系统的背景下得到了充分的定义。\n\n**步骤 3：结论与行动**\n问题陈述有效。这是一个精心设计的问题，旨在测试对静电相互作用对分子几何构型和电子结构影响的理解。我将继续进行解答。\n\n***\n\n**求解推导**\n\n问题的核心在于，在指定约束条件下，机械嵌入和静电嵌入的哈密顿量之间的差异。\n\n根据定义，在机械嵌入中，QM 和 MM 区域之间没有相互作用。QM 分子在孤立状态下进行优化，如同在气相中一样。得到的几何构型将是孤立分子的标准平衡结构，其在空间中的取向是任意的，因为能量与取向无关。\n\n在静电嵌入中，QM 哈密顿量包含一个与来自固定位置 $\\vec{R}_J$ 的 MM 点电荷 $Q_J$ 的外势的相互作用项。哈密顿量为：\n\n$$\n\\hat{H} = \\hat{H}_{\\text{QM}} + \\sum_{A \\in \\text{QM}} \\sum_{J \\in \\text{MM}} \\frac{Z_A e Q_J}{|\\vec{R}_A - \\vec{R}_J|} - \\sum_{i \\in \\text{QM}} \\sum_{J \\in \\text{MM}} \\frac{e Q_J}{|\\vec{r}_i - \\vec{R}_J|}\n$$\n\n此处，$Z_A$ 和 $\\vec{R}_A$ 分别是 QM 原子核 $A$ 的电荷数和位置，$\\vec{r}_i$ 是 QM 电子 $i$ 的位置。MM 电荷产生一个电场 $\\vec{E}$ 及其梯度。QM 分子的电荷分布与此外场的相互作用，会在 QM 原子核上引入机械嵌入情况下所没有的力。几何优化将找到一个使所有力（包括这些新的静电力）都为零的结构。\n\n如果这些外部静电力足够强，能够引起分子的大尺度重新取向或其内坐标（键长、键角）的显著畸变，就会产生“定性上不同”的几何构型。当 QM 分子拥有较大的永久电偶极矩 $\\vec{\\mu}$ 时，这种效应最为显著。相互作用能的主导项是 $E_{\\text{int}} \\approx -\\vec{\\mu} \\cdot \\vec{E}$。该项在分子上产生一个力矩，使其与外场对齐。对于非极性分子（$\\vec{\\mu}=0$），相互作用较弱，主要由极化率（$\\alpha$）和高阶多极矩（如四极矩）决定，导致较小的几何变化。\n\n我们现在将基于此原理评估每个选项。\n\n**A. QM 区域：氟化氢 ($\\text{HF}$)，MM 区域：一个电荷量为 $+1e$ 的固定点电荷。**\n- 氟化氢分子 $\\text{HF}$ 由于氟和氢之间的高电负性差异 (H$^{\\delta+}$-F$^{\\delta-}$)而具有非常大的永久偶极矩（$\\mu \\approx 1.83\\,\\text{D}$）。\n- 在机械嵌入中，结果就是一个具有任意取向的孤立 $\\text{HF}$ 分子的平衡键长。\n- 在静电嵌入中，位于氢原子附近的 $+1e$ 电荷会产生一个强电场。分子将受到一个强大的力矩，以使其偶极矩与该场对齐。指定的初始设置已接近最低能量取向。更重要的是，强电场将使分子极化，将电子云拉向正的外部电荷，同时排斥原子核。这种力会把电子密度从氟原子上拉走，削弱 H-F 键，导致显著的键长伸长。\n- **结论：** 强烈的取向偏好和内坐标（键长）的显著变化共同构成了定性上不同的几何构型。此选项 **正确**。\n\n**B. QM 区域：甲烷 ($\\text{CH}_{4}$)，MM 区域：一个电荷量为 $+1e$ 的固定点电荷。**\n- 甲烷分子 $\\text{CH}_{4}$ 具有四面体（$T_d$）对称性。尽管单个 C-H 键是弱极性的，但它们的矢量和为零，因此该分子没有永久偶极矩（$\\vec{\\mu}=0$）。\n- 在机械嵌入中，结果是标准的甲烷四面体几何构型。\n- 在静电嵌入中，没有一阶的偶极-场相互作用来引起强烈的重新取向。相互作用将由感生偶极矩（与极化率 $\\alpha$ 成正比）和永久八极矩主导。与一个 C-H 键对齐的外场将破坏分子的 $T_d$ 对称性（将其降为 $C_{3v}$），导致该 C-H 键轻微拉伸，键角发生畸变。然而，甲烷是一个化学刚性分子，极化率低。由此产生的内坐标变化预计会很小，可能只是一个数值上的扰动，而非“显著”变化。\n- **结论：** 与涉及极性分子的情况相比，其几何变化将小得多。该设置不可能产生所定义的“定性上不同”的几何构型。此选项 **不正确**。\n\n**C. QM 区域：苯 ($\\text{C}_{6}\\text{H}_{6}$)，MM 区域：两个电荷量为 $+1e$ 和 $-1e$ 的固定点电荷。**\n- 苯分子 $\\text{C}_{6}\\text{H}_{6}$ 是具有 $D_{6h}$ 对称性的平面分子，因此没有永久偶极矩（$\\vec{\\mu}=0$）。但它确实拥有一个显著的四极矩。\n- 在机械嵌入中，几何构型是标准的平面六边形。\n- 在静电嵌入中，沿主轴对称放置的 $+1e$ 和 $-1e$ 电荷会产生一个垂直于分子平面的均匀电场。该电场会使离域的 $\\pi$ 电子体系极化，但不会对分子施加任何净力矩。原子核上受到的力相对于分子的高对称性结构是对称的。这种设置不会破坏平面内的 $D_{6h}$ 对称性。任何键长或键角的变化都将是微小且均匀的。\n- **结论：** 这种设置最不可能引起几何构型的定性变化。分子的对称性得以保持，任何畸变都将是可忽略不计的。此选项 **不正确**。\n\n**D. QM 区域：水 ($\\text{H}_{2}\\text{O}$)，MM 区域：一个电荷量为 $+1e$ 的固定点电荷。**\n- 水分子 $\\text{H}_{2}\\text{O}$ 是弯曲的（$C_{2v}$ 对称性），并拥有一个很大的永久偶极矩（$\\mu \\approx 1.85\\,\\text{D}$）。\n- 在机械嵌入中，结果是具有任意取向的水分子的标准弯曲几何构型。\n- 在静电嵌入中，$+1e$ 的外部电荷会产生一个强电场。水分子的巨大偶极矩将与该场发生强烈相互作用（$E_{\\text{int}} \\approx -\\vec{\\mu} \\cdot \\vec{E}$）。几何优化过程将由一个巨大的力矩主导，该力矩会旋转分子，使其偶极矢量与电场对齐，试图将带负电的氧原子置于离正的 MM 电荷更近的位置。这种大尺度的重新取向本身就是一种定性上的几何变化。此外，电场靠近一个氢原子会破坏分子的 $C_{2v}$ 对称性，导致两个 O-H 键和 H-O-H 键角发生不对称畸变。\n- **结论：** 导致重新取向的强力矩和内部结构的不对称畸变都代表了优化几何构型的定性变化。此选项 **正确**。", "answer": "$$\\boxed{AD}$$", "id": "2455000"}, {"introduction": "理解了机械嵌入与静电嵌入的基本差异后，我们来探讨机械嵌入的一个关键局限性。本练习着眼于氢键体系——一种在化学和生物学中普遍存在的相互作用——并要求你预测机械嵌入模型的准确性。它突出了电子极化这一至关重要的物理效应，而这恰恰是机械嵌入方案所忽略的。[@problem_id:2457637]", "problem": "一个单一氢键二聚体在混合量子力学/分子力学(QM/MM)计算中，使用力学嵌入进行建模。量子力学(QM)区域由一个水分子组成，分子力学(MM)区域由一个甲醇分子组成，该甲醇分子由标准的、非极化的、固定电荷的力场描述。这两个分子在真空中是孤立的。在力学嵌入中，QM哈密顿量不包括MM电荷的静电场，并且所有QM-MM非键相互作用（静电和范德华）都使用MM力场项进行评估（为此，为所有参与QM-MM相互作用的原子分配了固定的MM类型的部分电荷和Lennard-Jones参数）。几何结构相对于总QM/MM能量进行优化，该能量是水分子的QM能量、甲醇分子的MM能量以及MM类型的QM-MM相互作用能之和。作为参考，考虑在相同电子结构水平上，在真空中对同个二聚体进行的全QM计算。\n\n哪个陈述最能描述用力学嵌入QM/MM计算得到的氢键几何结构和相互作用能相对于全QM参考的预期准确性？\n\nA. 因为水分子是用QM处理的，所以氢键距离和角度都将与全QM结果匹配，精度优于 $0.1\\,\\text{\\AA}$ 和 $5^\\circ$，相互作用能的误差将在 $0.5\\,\\text{kcal}\\,\\text{mol}^{-1}$ 以内。\n\nB. 氢键几何结构通常在定性上是合理的（例如，距离与全QM的偏差在约 $0.1$ 到 $0.3\\,\\text{\\AA}$ 之间，角度在约 $5^\\circ$ 到 $15^\\circ$ 之间），但相互作用能通常存在偏差，由于QM区域不受MM电荷的极化作用，以及QM-MM相互作用使用固定电荷的MM静电学，通常会低估结合能，数量级为几 $\\text{kcal}\\,\\text{mol}^{-1}$（例如 $1$ 到 $3\\,\\text{kcal}\\,\\text{mol}^{-1}$）。\n\nC. 在力学嵌入中完全无法捕捉氢键，因为QM和MM区域不相互作用。\n\nD. 与全QM相比，氢键强度通常会被高估，因为在力学嵌入中，MM甲醇对QM水的电子密度产生了过强的显式极化。\n\nE. 如果MM力场参数化得很好，相互作用能可能是准确的，但优化的氢键几何结构将是严重错误的，因为在力学嵌入中，QM原子力忽略了所有QM-MM相互作用。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- **体系**：一个由一个水分子和一个甲醇分子组成的氢键二聚体，位于真空中。\n- **方法**：混合量子力学/分子力学(QM/MM)计算。\n- **体系划分**：水分子构成量子力学($\\text{QM}$)区域。甲醇分子构成分子力学($\\text{MM}$)区域。\n- **$\\text{MM}$力场**：甲醇分子由标准的、非极化的、固定电荷的力场描述。\n- **嵌入方案**：使用力学嵌入。\n- **力学嵌入的定义**：\n    1.  $\\text{QM}$哈密顿量不包含由$\\text{MM}$电荷产生的静电场。\n    2.  $\\text{QM}$和$\\text{MM}$区域之间的所有非键相互作用（静电和范德华）都使用经典的$\\text{MM}$力场项进行计算。\n    3.  为了评估$\\text{QM}$-$\\text{MM}$相互作用，为所有原子分配了固定的$\\text{MM}$类型的部分电荷和Lennard-Jones参数。\n- **总能量计算**：总$\\text{QM/MM}$能量 $E_{\\text{QM/MM}}$ 表示为以下总和：$E_{\\text{QM/MM}} = E_{\\text{QM}}(\\text{水}) + E_{\\text{MM}}(\\text{甲醇}) + E_{\\text{int}}^{\\text{QM-MM}}$。\n- **优化**：通过最小化总能量 $E_{\\text{QM/MM}}$ 来优化二聚体的几何结构。\n- **参考计算**：在真空中对同一二聚体进行的全$\\text{QM}$计算，使用与$\\text{QM/MM}$计算的$\\text{QM}$部分相同的电子结构理论水平。\n- **问题**：任务是评估这种力学嵌入$\\text{QM/MM}$计算得到的氢键几何结构和相互作用能相对于全$\\text{QM}$参考的预期准确性。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题在科学上是合理的。它描述了一个涉及$\\text{QM/MM}$方法的标准计算化学问题。力学嵌入和静电嵌入之间的区别是该领域的一个基本概念。水-甲醇二聚体的设置是氢键的常见测试案例。\n- **适定性**：该问题是适定的。它清晰地定义了体系、计算模型（力学嵌入$\\text{QM/MM}$）以及用于比较的参考（全$\\text{QM}$）。问题要求对结果进行定性和定量的比较，根据计算化学的原理，存在一个确定的答案。\n- **客观性**：该问题以客观、技术性的语言陈述，没有偏见或主观断言。\n\n**第3步：结论与行动**\n问题陈述是有效的。这是一个在理论和计算化学中明确定义的标准问题。我将继续推导解决方案。\n\n**推导**\n在指定的力学嵌入方案中，总能量由下式给出：\n\n$$\nE_{\\text{total}} = E_{\\text{QM}}(\\mathbf{R}_{\\text{QM}}) + E_{\\text{MM}}(\\mathbf{R}_{\\text{MM}}) + E_{\\text{QM-MM}}(\\mathbf{R}_{\\text{QM}}, \\mathbf{R}_{\\text{MM}})\n$$\n\n这里，$\\mathbf{R}_{\\text{QM}}$ 和 $\\mathbf{R}_{\\text{MM}}$ 分别是$\\text{QM}$（水）和$\\text{MM}$（甲醇）区域中原子的坐标。\n\n力学嵌入的关键特征是第一项 $E_{\\text{QM}}(\\mathbf{R}_{\\text{QM}})$ 的性质。问题陈述中说“$\\text{QM}$哈密顿量排除了$\\text{MM}$电荷的静电场”。这意味着薛定谔方程是针对孤立的$\\text{QM}$区域求解的：\n\n$$\n\\hat{H}_{\\text{QM}}^{0} \\Psi_0 = E_0 \\Psi_0\n$$\n\n得到的波函数 $\\Psi_0$ 及其对应的电子密度是水分子在真空中的状态，完全不知道甲醇分子所创造的静电环境。因此，$\\text{QM}$区域的电子结构没有被$\\text{MM}$区域极化。\n\n两个区域之间的相互作用 $E_{\\text{QM-MM}}$ 是纯粹用经典方法处理的：\n\n$$\nE_{\\text{QM-MM}} = \\sum_{i \\in \\text{QM}} \\sum_{j \\in \\text{MM}} \\left[ \\frac{q_i q_j}{4\\pi\\epsilon_0 r_{ij}} + 4\\epsilon_{ij} \\left( \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{6} \\right) \\right]\n$$\n\n其中 $q_i$ 和 $q_j$ 是固定的、预先分配的部分电荷。\n\n相比之下，参考的全$\\text{QM}$计算是为整个水-甲醇超分子求解薛定谔方程。超系统的哈密顿量包括所有电子和原子核之间的所有相互作用。因此，得到的波函数描述了一个水分子的电子密度被甲醇分子极化，反之亦然的系统。这种相互的电子极化是一种物理现象，它通过增强静电吸引力来显著加强氢键。\n\n由于力学嵌入方案完全忽略了这种稳定化的极化效应，计算出的水和甲醇分子之间的相互作用将被人为地减弱。这种相互作用被一个刚性的、不可极化的电荷分布的经典模型所近似。这导致对氢键相互作用能的低估。对于一个典型的中性氢键，极化能的贡献量级为几 $\\text{kcal}\\,\\text{mol}^{-1}$。\n\n几何结构是基于从 $E_{\\text{total}}$ 推导出的力进行优化的。$\\text{QM}$原子上的力为 $\\mathbf{F}_i = -\\nabla_i E_{\\text{QM}} - \\nabla_i E_{\\text{QM-MM}}$。虽然力包含来自$\\text{QM-MM}$相互作用的贡献，但这种相互作用本身是基于一个缺少极化效应的近似势。较弱的吸引力通常会导致较长的平衡键长。因此，预计氢键距离会比全$\\text{QM}$参考中的要长。由经典静电和范德华项的方向性决定的整体几何结构，通常在定性上是正确的，但在定量上是错误的。预期的误差与此类低级模型的典型性能一致。\n\n**逐项分析**\n- **选项 A**：此选项声称具有极高的准确性（误差 <$0.1\\,\\text{\\AA}$，<$5^{\\circ}$，和 <$0.5\\,\\text{kcal}\\,\\text{mol}^{-1}$）。对于一个极性的、氢键连接的体系，用力学嵌入是无法达到这样高的准确性的，正是因为它忽略了电子极化。即使对于更复杂的静电嵌入方案，这个准确度水平也会被认为是非常好的。\n- **结论**：**错误**。\n\n- **选项 B**：此选项指出几何结构在定性上是合理的（距离误差为 $0.1$ 到 $0.3\\,\\text{\\AA}$，角度误差为 $5^{\\circ}$ 到 $15^{\\circ}$），但相互作用能被低估了几 $\\text{kcal}\\,\\text{mol}^{-1}$（例如，$1$ 到 $3\\,\\text{kcal}\\,\\text{mol}^{-1}$）。它正确地将此误差归因于“$\\text{QM}$区域不受$\\text{MM}$电荷的极化作用”。这一描述与力学嵌入模型在处理极性相互作用时的已知物理缺陷完全吻合。指定的误差范围对于这种理论水平是现实的。\n- **结论**：**正确**。\n\n- **选项 C**：此选项声称氢键“完全无法被捕捉”，因为区域“不相互作用”。这显然是错误的。问题明确定义了一个$\\text{QM-MM}$相互作用能项 $E_{\\text{int}}^{\\text{QM-MM}}$，该项模拟了非键相互作用，包括作为氢键主要成分的库仑吸引。\n- **结论**：**错误**。\n\n- **选项 D**：此选项错误地声称氢键将被高估。它还做出了错误的断言，即“$\\text{MM}$甲醇显式地极化了$\\text{QM}$水的电子密度”。这是静电嵌入的定义，而不是力学嵌入。在力学嵌入中，$\\text{QM}$区域被$\\text{MM}$环境极化的程度为零。缺乏这种稳定效应导致对相互作用强度的低估，而不是高估。\n- **结论**：**错误**。\n\n- **选项 E**：此选项声称$\\text{QM}$原子上的力“忽略所有$\\text{QM-MM}$相互作用”，导致“严重错误”的几何结构。这是不正确的。$E_{\\text{QM-MM}}$项的梯度对几何优化过程中$\\text{QM}$和$\\text{MM}$原子上的力都有贡献。因此，几何结构是根据近似势进行优化的，而不是因为缺少力而“严重错误”。此外，它自相矛盾地提出能量可以准确而几何结构却很差。实际上，基本的物理缺陷（缺少极化）会同时影响能量和几何结构。\n- **结论**：**错误**。", "answer": "$$\\boxed{B}$$", "id": "2457637"}, {"introduction": "从概念预测转向动手计算，我们来处理 QM/MM 方法中的一个主要技术挑战：如何处理被边界切断的共价键。本练习使用一个简化但功能强大的苯环分析模型，旨在让你亲手量化由机械嵌入方案中典型的人工“连接”键所引入的结构应变和能量代价。通过求解这个模型，你将对边界处理的后果有更深刻的定量认识。[@problem_id:2457586]", "problem": "您正在模拟在使用机械嵌入方案时，将量子力学/分子力学 (QM/MM) 边界放置在芳香性苯环中间的共价键上所产生的能量和结构后果。在机械嵌入中，量子力学 (QM) 区域和分子力学 (MM) 区域仅通过跨越 QM/MM 界面的键合项耦合；量子力学 (QM) 哈密顿量不包括与分子力学 (MM) 点电荷的显式静电相互作用。\n\n为了获得一个可由程序求解的模型，将苯环近似为一个由 $N=6$ 个谐性弹簧（代表六个碳-碳键）组成的闭环。设键长为 $\\{r_i\\}_{i=1}^6$，平衡键长为 $\\{r_{0,i}\\}_{i=1}^6$，谐性力常数为 $\\{k_i\\}_{i=1}^6$。假设一个固定的环周长 $L$，其包含了环闭合和角刚度的综合效应。总势能模型为\n\n$$\nE(\\{r_i\\}) \\;=\\; \\frac{1}{2} \\sum_{i=1}^{6} k_i \\left(r_i - r_{0,i}\\right)^2\n$$\n\n并满足闭合约束条件\n\n$$\n\\sum_{i=1}^{6} r_i \\;=\\; L.\n$$\n\n您的任务是，对每个给定的测试用例，计算：\n- 在约束条件下最小化 $E(\\{r_i\\})$ 的优化键长集合 $\\{r_i^\\star\\}_{i=1}^6$，以及\n- 最小化后的能量 $E^\\star = E(\\{r_i^\\star\\})$。\n\n假设与单位：\n- 距离单位为 $\\mathrm{\\AA}$。\n- 力常数单位为 $\\mathrm{kJ\\ mol^{-1}\\ \\AA^{-2}}$。\n- 能量单位为 $\\mathrm{kJ\\ mol^{-1}}$。\n- 苯环仅由所述的谐性伸缩模型和周长约束来表示；优化目标中没有显式的键角或二面角项。\n- 跨越一个键的量子力学/分子力学 (QM/MM) 边界通过将该键的平衡键长 $r_{0,i}$ 和力常数 $k_i$ 替换为另一对参数来表示，以模拟机械嵌入中典型的连接原子或封端方案。\n\n实现一个程序，为每个测试用例精确求解约束最小化问题。所有浮点数结果必须四舍五入到 $6$ 位小数。\n\n测试套件：\n- 案例 1 (基准，完全均一的芳香环)：\n  - 对于 $i = 1,\\dots,6$，有 $r_{0,i} = 1.397\\ \\mathrm{\\AA}$。\n  - 对于 $i = 1,\\dots,6$，有 $k_i = 469.0\\ \\mathrm{kJ\\ mol^{-1}\\ \\AA^{-2}}$。\n  - $L = 6 \\times 1.397\\ \\mathrm{\\AA}$。\n- 案例 2 (跨越键 1 的 QM/MM 边界，采用连接键的机械嵌入)：\n  - $r_{0,1} = 1.510\\ \\mathrm{\\AA}$，$k_1 = 320.0\\ \\mathrm{kJ\\ mol^{-1}\\ \\AA^{-2}}$。\n  - 对于 $i = 2,\\dots,6$：$r_{0,i} = 1.397\\ \\mathrm{\\AA}$，$k_i = 469.0\\ \\mathrm{kJ\\ mol^{-1}\\ \\AA^{-2}}$。\n  - $L = 6 \\times 1.397\\ \\mathrm{\\AA}$。\n- 案例 3 (更刚性的芳香区域和更柔性的连接键，以强调应变的局域化)：\n  - $r_{0,1} = 1.510\\ \\mathrm{\\AA}$，$k_1 = 150.0\\ \\mathrm{kJ\\ mol^{-1}\\ \\AA^{-2}}$。\n  - 对于 $i = 2,\\dots,6$：$r_{0,i} = 1.397\\ \\mathrm{\\AA}$，$k_i = 800.0\\ \\mathrm{kJ\\ mol^{-1}\\ \\AA^{-2}}$。\n  - $L = 6 \\times 1.397\\ \\mathrm{\\AA}$。\n- 案例 4 (在轻微全局压缩下的均一环，以探究预应变下的边界行为)：\n  - 对于 $i = 1,\\dots,6$，有 $r_{0,i} = 1.397\\ \\mathrm{\\AA}$。\n  - 对于 $i = 1,\\dots,6$，有 $k_i = 469.0\\ \\mathrm{kJ\\ mol^{-1}\\ \\AA^{-2}}$。\n  - $L = 0.99 \\times 6 \\times 1.397\\ \\mathrm{\\AA}$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。\n- 每个测试用例必须产生一个包含 7 个数字的列表，顺序为 $[E^\\star, r_1^\\star, r_2^\\star, r_3^\\star, r_4^\\star, r_5^\\star, r_6^\\star]$。\n- 因此，最终输出必须是这些按案例排列的列表的列表，例如：$[[E_1^\\star,r_{1,1}^\\star,\\dots,r_{1,6}^\\star],[E_2^\\star,r_{2,1}^\\star,\\dots,r_{2,6}^\\star],\\dots]$，其中所有数字都是四舍五入到 $6$ 位小数的浮点数。", "solution": "我们从键伸缩的谐性近似和跨越量子力学/分子力学 (QM/MM) 界面的机械嵌入耦合开始。在机械嵌入中，量子力学 (QM) 区域不感受显式的分子力学 (MM) 电荷，与分子力学 (MM) 区域的唯一耦合是通过跨越边界的键合项实现的。当边界被置于芳香性苯环的共价键上时，通常会使用连接原子或类似的封端方案，用一个等效的谐性相互作用来取代真实的键，该相互作用可能具有与内禀芳香键不同的平衡长度和刚度。这可能会在环中引入结构畸变和应变能。\n\n为了在一个最小但自洽的模型中分析此效应，将环近似为具有长度 $\\{r_i\\}_{i=1}^6$、平衡长度 $\\{r_{0,i}\\}_{i=1}^6$ 和力常数 $\\{k_i\\}_{i=1}^6$ 的 $N=6$ 个谐性弹簧。能量为\n\n$$\nE(\\{r_i\\}) \\;=\\; \\frac{1}{2} \\sum_{i=1}^{6} k_i \\left(r_i - r_{0,i}\\right)^2,\n$$\n\n环的闭合和角刚度被集体地由一个固定周长约束表示\n\n$$\n\\sum_{i=1}^{6} r_i \\;=\\; L.\n$$\n\n所有距离的单位是 $\\mathrm{\\AA}$，力常数的单位是 $\\mathrm{kJ\\ mol^{-1}\\ \\AA^{-2}}$，能量的单位是 $\\mathrm{kJ\\ mol^{-1}}$。\n\n我们寻求在单一线性约束条件下使 $E$ 最小化的解 $\\{r_i^\\star\\}$。这是一个带有线性等式约束的严格凸二次规划问题，因此有唯一的全局最小值点。为该约束引入一个拉格朗日乘子 $\\lambda$，并考虑拉格朗日函数\n\n$$\n\\mathcal{L}(\\{r_i\\},\\lambda) \\;=\\; \\frac{1}{2} \\sum_{i=1}^{6} k_i \\left(r_i - r_{0,i}\\right)^2 \\;+\\; \\lambda \\left( \\sum_{i=1}^{6} r_i - L \\right).\n$$\n\n对每个 $r_i$ 求驻点可得\n\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial r_i} \\;=\\; k_i \\left(r_i - r_{0,i}\\right) + \\lambda \\;=\\; 0\n\\;\\;\\Rightarrow\\;\\;\nr_i^\\star \\;=\\; r_{0,i} \\;-\\; \\frac{\\lambda}{k_i}.\n$$\n\n在驻点处施加约束条件可得\n\n$$\n\\sum_{i=1}^{6} r_i^\\star \\;=\\; \\sum_{i=1}^{6} r_{0,i} \\;-\\; \\lambda \\sum_{i=1}^{6} \\frac{1}{k_i} \\;=\\; L,\n$$\n\n由此解出唯一的拉格朗日乘子\n\n$$\n\\lambda^\\star \\;=\\; \\frac{\\sum_{i=1}^{6} r_{0,i} - L}{\\sum_{i=1}^{6} \\frac{1}{k_i}}.\n$$\n\n代入回去，优化后的键长为\n\n$$\nr_i^\\star \\;=\\; r_{0,i} \\;-\\; \\frac{\\lambda^\\star}{k_i},\n\\quad \\text{for } i=1,\\dots,6,\n$$\n\n最小化后的能量可以通过直接代入原始的谐性形式表示，\n\n$$\nE^\\star \\;=\\; \\frac{1}{2} \\sum_{i=1}^{6} k_i \\left(r_i^\\star - r_{0,i}\\right)^2 \\;=\\; \\frac{1}{2} \\sum_{i=1}^{6} k_i \\left(\\frac{\\lambda^\\star}{k_i}\\right)^2 \\;=\\; \\frac{1}{2} \\left(\\lambda^\\star\\right)^2 \\sum_{i=1}^{6} \\frac{1}{k_i},\n$$\n\n或者等效地，使用 $\\lambda^\\star$ 的表达式，\n\n$$\nE^\\star \\;=\\; \\frac{1}{2} \\,\\frac{\\left(\\sum_{i=1}^{6} r_{0,i} - L\\right)^2}{\\sum_{i=1}^{6} \\frac{1}{k_i}}.\n$$\n\n算法设计：\n- 对于每个测试用例，根据指定构建 $\\{r_{0,i}\\}$ 和 $\\{k_i\\}$ 的数组并计算 $L$。\n- 计算标量和 $S_r = \\sum_{i=1}^{6} r_{0,i}$ 和 $S_k^{-1} = \\sum_{i=1}^{6} \\frac{1}{k_i}$。\n- 计算 $\\lambda^\\star = (S_r - L)/S_k^{-1}$。\n- 通过 $r_i^\\star = r_{0,i} - \\lambda^\\star/k_i$ 计算每个优化后的键长。\n- 通过 $E^\\star = \\frac{1}{2} (\\lambda^\\star)^2 S_k^{-1}$ 计算 $E^\\star$。\n- 将 $E^\\star$ 和所有 $r_i^\\star$ 值四舍五入到 6 位小数。\n- 将每个测试用例的输出聚合为 $[E^\\star, r_1^\\star, r_2^\\star, r_3^\\star, r_4^\\star, r_5^\\star, r_6^\\star]$。\n- 在单行中打印这些列表的列表。\n\n在机械嵌入背景下的解读：\n- 案例 1 作为健全性检查：一个均一的环，其 $L$ 与平衡键长之和相匹配，得到 $r_i^\\star = r_{0,i}$ 和 $E^\\star = 0$，表明没有应变。\n- 案例 2 通过改变 $r_{0,1}$ 和 $k_1$ 将 QM/MM 边界置于一个键上。由于 $L$ 固定为理想的芳香环周长，这种不匹配迫使应变重新分布。\n- 因为 $r_i^\\star$ 的位移与 $1/k_i$ 成比例，一个更柔性的连接键（较小的 $k_1$）会吸收更大部分的偏差，这是边界处机械嵌入的一个典型结构后果。\n- 案例 3 夸大了刚度对比，进一步将畸变局域化到边界键中，并根据周长不匹配的程度升高或降低 $E^\\star$。\n- 案例 4 展示了均一的预应变：在参数相同但 $L$ 略微减小的情况下，所有键均等压缩，说明了没有边界时的基线响应。\n\n该方法直接源于谐性近似和使用拉格朗日乘子的约束最小化，为机械嵌入下 QM/MM 边界放置的能量和结构后果提供了一种透明且计算高效的量化方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef optimize_ring(r0, k, L):\n    \"\"\"\n    Optimize a 6-bond ring with harmonic stretches under a fixed perimeter constraint.\n    Parameters:\n        r0: array-like of length 6, equilibrium bond lengths (Angstrom)\n        k: array-like of length 6, force constants (kJ/mol/Angstrom^2)\n        L: float, fixed perimeter (Angstrom)\n    Returns:\n        E_star: float, minimized energy (kJ/mol)\n        r_star: np.ndarray shape (6,), optimized bond lengths (Angstrom)\n    \"\"\"\n    r0 = np.asarray(r0, dtype=float)\n    k = np.asarray(k, dtype=float)\n    inv_k_sum = np.sum(1.0 / k)\n    r0_sum = np.sum(r0)\n    lam = (r0_sum - L) / inv_k_sum\n    r_star = r0 - lam / k\n    E_star = 0.5 * (lam ** 2) * inv_k_sum\n    return E_star, r_star\n\ndef format_case_output(E, r):\n    \"\"\"Format one case as [E, r1, r2, r3, r4, r5, r6] with 6 decimal places.\"\"\"\n    nums = [E] + list(r)\n    return \"[\" + \",\".join(f\"{x:.6f}\" for x in nums) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n\n    # Case 1: baseline homogeneous aromatic ring\n    r0_case1 = [1.397, 1.397, 1.397, 1.397, 1.397, 1.397]\n    k_case1 = [469.0, 469.0, 469.0, 469.0, 469.0, 469.0]\n    L_case1 = 6 * 1.397\n\n    # Case 2: QM/MM boundary across bond 1 with link parameters\n    r0_case2 = [1.510, 1.397, 1.397, 1.397, 1.397, 1.397]\n    k_case2 = [320.0, 469.0, 469.0, 469.0, 469.0, 469.0]\n    L_case2 = 6 * 1.397\n\n    # Case 3: stiffer aromatic region and softer link\n    r0_case3 = [1.510, 1.397, 1.397, 1.397, 1.397, 1.397]\n    k_case3 = [150.0, 800.0, 800.0, 800.0, 800.0, 800.0]\n    L_case3 = 6 * 1.397\n\n    # Case 4: uniform ring under slight global compression (pre-strain)\n    r0_case4 = [1.397, 1.397, 1.397, 1.397, 1.397, 1.397]\n    k_case4 = [469.0, 469.0, 469.0, 469.0, 469.0, 469.0]\n    L_case4 = 0.99 * 6 * 1.397\n\n    test_cases = [\n        (r0_case1, k_case1, L_case1),\n        (r0_case2, k_case2, L_case2),\n        (r0_case3, k_case3, L_case3),\n        (r0_case4, k_case4, L_case4),\n    ]\n\n    results_str = []\n    for r0, k, L in test_cases:\n        E_star, r_star = optimize_ring(r0, k, L)\n        results_str.append(format_case_output(E_star, r_star))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```", "id": "2457586"}]}