{"hands_on_practices": [{"introduction": "连接原子方案的一个主要问题是它可能扭曲分子的势能面 (Potential Energy Surface, PES)。这个练习使用丁烷的扭转这样一个经典的一维模型，来直观地展示连接原子引入的赝势（例如耦合减弱和伪影项）如何改变势能面的形状和关键的能量（如旋转能垒）。通过这个动手实践，你将量化连接原子赝势对基本分子性质的影响，从而对该方法的内在局限性有更深刻的理解。[@problem_id:2465054]", "problem": "给定一个关于丁烷中绕中心碳-碳键旋转的一维扭转势能模型，该模型可作为量子力学 (QM) 参考和量子力学/分子力学 (QM/MM) 连接原子方案的代理。扭转角用 $\\varphi$ 表示，其定义域为 $[0,2\\pi)$，角度单位为弧度。所有能量都必须以千卡/摩尔 (kcal/mol) 为单位表示。\n\n作为扭转角 $\\varphi$ 的函数的完整量子力学 (QM) 参考势由以下傅里叶级数指定\n$$\nV_{\\mathrm{QM}}(\\varphi) \\;=\\; c_1 \\left(1+\\cos \\varphi \\right) \\;+\\; c_2 \\left(1-\\cos 2\\varphi \\right) \\;+\\; c_3 \\left(1+\\cos 3\\varphi \\right),\n$$\n其系数固定为\n$$\nc_1 = 0.6 \\;\\;\\text{kcal/mol},\\quad c_2 = 0.3 \\;\\;\\text{kcal/mol},\\quad c_3 = 2.7 \\;\\;\\text{kcal/mol}。\n$$\n\n一个在中心键处切断分子的简化量子力学/分子力学 (QM/MM) 连接原子模型定义如下。跨边界三重项的振幅按因子 $\\alpha$ 进行缩放，以解释由连接原子引起的耦合减少；一个额外的一重伪迹项用于模拟由连接原子引入的残余失配。QM/MM 势定义为\n$$\nV_{\\mathrm{QM/MM}}(\\varphi;\\,\\alpha,\\,C_{\\mathrm{art}}) \\;=\\; c_1 \\left(1+\\cos \\varphi \\right) \\;+\\; c_2 \\left(1-\\cos 2\\varphi \\right) \\;+\\; \\alpha\\,c_3 \\left(1+\\cos 3\\varphi \\right) \\;+\\; C_{\\mathrm{art}}\\left(1-\\cos \\varphi \\right),\n$$\n其中 $\\alpha$ 是无量纲的，$C_{\\mathrm{art}}$ 的单位是千卡/摩尔。\n\n对于任意扭转势 $V(\\varphi)$，将旋转能垒 $\\Delta E$ 定义为\n$$\n\\Delta E \\;=\\; \\max_{\\varphi \\in [0,2\\pi)} V(\\varphi) \\;-\\; \\min_{\\varphi \\in [0,2\\pi)} V(\\varphi).\n$$\n\n任务：\n1. 计算完整量子力学势 $V_{\\mathrm{QM}}(\\varphi)$ 的旋转能垒 $\\Delta E_{\\mathrm{QM}}$。\n2. 对于量子力学/分子力学势 $V_{\\mathrm{QM/MM}}(\\varphi;\\,\\alpha,\\,C_{\\mathrm{art}})$，计算以下测试套件中每一对参数 $(\\alpha, C_{\\mathrm{art}})$ 的旋转能垒 $\\Delta E_{\\mathrm{QM/MM}}$。\n\n测试套件（角度单位为弧度，能量单位为千卡/摩尔）：\n- 情况1（边界一致性）：$\\alpha = 1.0$，$C_{\\mathrm{art}} = 0.0$。\n- 情况2（带伪迹的耦合减弱）：$\\alpha = 0.75$，$C_{\\mathrm{art}} = 0.2$。\n- 情况3（带伪迹的解耦极限）：$\\alpha = 0.0$，$C_{\\mathrm{art}} = 0.2$。\n- 情况4（带小伪迹的过耦合）：$\\alpha = 1.1$，$C_{\\mathrm{art}} = 0.1$。\n\n要求输出：\n- 一个列表，包含五个以千卡/摩尔为单位的浮点数，四舍五入到三位小数，顺序如下：\n  1. $\\Delta E_{\\mathrm{QM}}$,\n  2. 情况1的 $\\Delta E_{\\mathrm{QM/MM}}$,\n  3. 情况2的 $\\Delta E_{\\mathrm{QM/MM}}$,\n  4. 情况3的 $\\Delta E_{\\mathrm{QM/MM}}$,\n  5. 情况4的 $\\Delta E_{\\mathrm{QM/MM}}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[x1,x2,x3,x4,x5]”），每个值都四舍五入到三位小数，并以千卡/摩尔为单位表示。", "solution": "所提出的问题是计算化学中一个定义明确的练习，涉及一维扭转势能面的分析。它要求计算参考量子力学 (QM) 势和简化量子力学/分子力学 (QM/MM) 连接原子模型的旋转能垒。该问题具有科学依据，数学上一致，并且所有必要的参数都已提供。因此，它被认为是有效的，并将提供一个解决方案。\n\n我们的目标是确定给定扭转势 $V(\\varphi)$ 的旋转能垒 $\\Delta E$，其定义如下：\n$$\n\\Delta E = \\max_{\\varphi \\in [0,2\\pi)} V(\\varphi) - \\min_{\\varphi \\in [0,2\\pi)} V(\\varphi)\n$$\n为了找到像 $V(\\varphi)$ 这样的连续可微函数的最大值和最小值，我们必须找到其临界点。临界点是势关于角度 $\\varphi$ 的一阶导数为零的点：\n$$\n\\frac{dV(\\varphi)}{d\\varphi} = 0\n$$\n函数的极值将出现在这些临界点。势以余弦项的傅里叶级数形式给出，在区间 $[0, 2\\pi)$ 上是周期的。\n\n首先，让我们分析完整量子力学势 $V_{\\mathrm{QM}}(\\varphi)$：\n$$\nV_{\\mathrm{QM}}(\\varphi) = c_1 (1+\\cos \\varphi) + c_2 (1-\\cos 2\\varphi) + c_3 (1+\\cos 3\\varphi)\n$$\n其中 $c_1 = 0.6$, $c_2 = 0.3$, and $c_3 = 2.7$（单位均为 kcal/mol）。为了找到临界点，我们计算其导数：\n$$\n\\frac{dV_{\\mathrm{QM}}}{d\\varphi} = -c_1 \\sin \\varphi + 2c_2 \\sin 2\\varphi - 3c_3 \\sin 3\\varphi = 0\n$$\n使用三角恒等式 $\\sin 2\\varphi = 2\\sin\\varphi\\cos\\varphi$ 和 $\\sin 3\\varphi = \\sin\\varphi(4\\cos^2\\varphi-1)$，我们可以将方程重写为：\n$$\n\\sin\\varphi (-c_1 + 4c_2\\cos\\varphi - 3c_3(4\\cos^2\\varphi - 1)) = 0\n$$\n如果 $\\sin\\varphi = 0$（对应 $\\varphi=0$ 和 $\\varphi=\\pi$），或者括号中的项为零，则该方程成立。设 $x = \\cos\\varphi$。第二个条件变为关于 $x$ 的二次方程：\n$$\n-12c_3 x^2 + 4c_2 x + (-c_1 + 3c_3) = 0\n$$\n代入给定系数：\n$$\n-12(2.7)x^2 + 4(0.3)x + (-0.6 + 3(2.7)) = 0\n$$\n$$\n-32.4x^2 + 1.2x + 7.5 = 0\n$$\n$x = \\cos\\varphi$ 的解为 $x_1 = 0.5$ 和 $x_2 \\approx -0.46296$。两个解都在有效范围 $[-1, 1]$ 内。因此临界点为 $\\varphi = 0$，$\\varphi=\\pi$，$\\varphi=\\arccos(0.5)=\\pi/3$ 和 $\\varphi=\\arccos(-0.46296) \\approx 2.051$ rad。\n\n在这些临界点上计算 $V_{\\mathrm{QM}}(\\varphi)$ 得出：\n-   $V_{\\mathrm{QM}}(0) = c_1(2) + c_2(0) + c_3(2) = 2(0.6+2.7) = 6.6$ kcal/mol。\n-   $V_{\\mathrm{QM}}(\\pi) = c_1(0) + c_2(0) + c_3(0) = 0.0$ kcal/mol。\n-   $V_{\\mathrm{QM}}(\\pi/3) = c_1(1.5) + c_2(1.5) + c_3(0) = 1.5(0.6+0.3) = 1.35$ kcal/mol。\n-   对于 $x \\approx -0.46296$，$V_{\\mathrm{QM}} \\approx 6.172$ kcal/mol。\n\n最大值为 $V_{\\mathrm{max}} = 6.6$ kcal/mol（在 $\\varphi=0$ 处），最小值为 $V_{\\mathrm{min}} = 0.0$ kcal/mol（在 $\\varphi=\\pi$ 处）。\n因此，QM 势的旋转能垒为：\n$$\n\\Delta E_{\\mathrm{QM}} = 6.6 - 0.0 = 6.6 \\;\\text{kcal/mol}\n$$\n\n接下来，我们将相同的步骤应用于 QM/MM 势：\n$$\nV_{\\mathrm{QM/MM}}(\\varphi;\\,\\alpha,\\,C_{\\mathrm{art}}) = c_1 \\left(1+\\cos \\varphi \\right) + c_2 \\left(1-\\cos 2\\varphi \\right) + \\alpha\\,c_3 \\left(1+\\cos 3\\varphi \\right) + C_{\\mathrm{art}}\\left(1-\\cos \\varphi \\right)\n$$\n这可以重写为标准形式 $V(\\varphi) = k_0 + k_1\\cos\\varphi + k_2\\cos 2\\varphi + k_3\\cos 3\\varphi$，其系数为：\n-   $k_1 = c_1 - C_{\\mathrm{art}}$\n-   $k_2 = -c_2$\n-   $k_3 = \\alpha c_3$\n\n导数分析可从 $\\sin\\varphi=0$（即 $\\varphi=0, \\pi$）和关于 $x = \\cos\\varphi$ 的二次方程得到相同的临界点集：\n$$\n12k_3 x^2 + 4k_2 x + (k_1 - 3k_3) = 0\n$$\n$$\n12(\\alpha c_3) x^2 + 4(-c_2)x + (c_1 - C_{\\mathrm{art}} - 3\\alpha c_3) = 0\n$$\n虽然这种解析方法很严谨，但对于计算实现而言，通过在从 $0$ 到 $2\\pi$ 的 $\\varphi$ 值精细网格上评估势函数来数值搜索其最大值和最小值，是更直接和稳健的方法。每种情况的结果都是通过此方法确定的。\n\n情况1：$\\alpha = 1.0$，$C_{\\mathrm{art}} = 0.0$。\n在这种情况下，$V_{\\mathrm{QM/MM}}(\\varphi) = V_{\\mathrm{QM}}(\\varphi)$。逻辑上，能垒必须相同。\n$V_{\\mathrm{max}} = 6.6$ kcal/mol，$V_{\\mathrm{min}} = 0.0$ kcal/mol。\n$\\Delta E_{\\mathrm{QM/MM}} = 6.6 - 0.0 = 6.6$ kcal/mol。\n\n情况2：$\\alpha = 0.75$，$C_{\\mathrm{art}} = 0.2$。\n在其临界点上对势进行评估得出：\n$V_{\\mathrm{max}} \\approx 5.25$ kcal/mol（在 $\\varphi=0$ 处）。\n$V_{\\mathrm{min}} \\approx 0.40$ kcal/mol（在 $\\varphi=\\pi$ 处）。\n$\\Delta E_{\\mathrm{QM/MM}} = 5.25 - 0.40 = 4.85$ kcal/mol。\n\n情况3：$\\alpha = 0.0$，$C_{\\mathrm{art}} = 0.2$。\n此处，$\\cos 3\\varphi$ 项消失。势函数变为关于 $x = \\cos\\varphi$ 的简单二次式。\n$V(\\varphi) = -0.6(\\cos\\varphi)^2 + 0.4\\cos\\varphi + 1.4$。\n最大值出现在 $\\cos\\varphi = 1/3$ 处，得到 $V_{\\mathrm{max}} \\approx 1.467$ kcal/mol。\n最小值出现在 $\\cos\\varphi = -1$（$\\varphi = \\pi$）处，得到 $V_{\\mathrm{min}} = 0.4$ kcal/mol。\n$\\Delta E_{\\mathrm{QM/MM}} = 1.466... - 0.4 = 1.066... \\approx 1.067$ kcal/mol。\n\n情况4：$\\alpha = 1.1$，$C_{\\mathrm{art}} = 0.1$。\n在其临界点上对势进行评估得出：\n$V_{\\mathrm{max}} \\approx 7.14$ kcal/mol（在 $\\varphi=0$ 处）。\n$V_{\\mathrm{min}} \\approx 0.20$ kcal/mol（在 $\\varphi=\\pi$ 处）。\n$\\Delta E_{\\mathrm{QM/MM}} = 7.14 - 0.20 = 6.94$ kcal/mol。\n\n要求的结果是 QM 情况的能垒，后跟四种 QM/MM 情况的能垒。\n1. $\\Delta E_{\\mathrm{QM}} = 6.600$ kcal/mol\n2. $\\Delta E_{\\mathrm{QM/MM}}$ (情况1) = $6.600$ kcal/mol\n3. $\\Delta E_{\\mathrm{QM/MM}}$ (情况2) = $4.850$ kcal/mol\n4. $\\Delta E_{\\mathrm{QM/MM}}$ (情况3) = $1.067$ kcal/mol\n5. $\\Delta E_{\\mathrm{QM/MM}}$ (情况4) = $6.940$ kcal/mol\n这些值将由提供的程序计算和格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the torsional potential problem by calculating rotational barriers\n    for the QM and QM/MM models.\n    \"\"\"\n\n    # Fixed coefficients from the problem statement (in kcal/mol)\n    c1 = 0.6\n    c2 = 0.3\n    c3 = 2.7\n\n    # Define a fine grid for the torsion angle phi from 0 to 2*pi.\n    # A grid of 10000 points is sufficient for an accurate numerical search\n    # of the extrema for these smooth functions.\n    phi = np.linspace(0, 2 * np.pi, 10000, endpoint=False)\n\n    # --- Task 1: Compute the rotational barrier for the QM potential ---\n    \n    # Calculate the QM potential V_QM(phi) using Fourier series\n    # V_QM = c1*(1+cos(phi)) + c2*(1-cos(2*phi)) + c3*(1+cos(3*phi))\n    cos_phi = np.cos(phi)\n    cos_2phi = np.cos(2 * phi)\n    cos_3phi = np.cos(3 * phi)\n\n    v_qm = c1 * (1 + cos_phi) + c2 * (1 - cos_2phi) + c3 * (1 + cos_3phi)\n\n    # The rotational barrier is the difference between the max and min potential energy\n    delta_e_qm = np.max(v_qm) - np.min(v_qm)\n\n    results = [delta_e_qm]\n\n    # --- Task 2: Compute rotational barriers for the QM/MM potential cases ---\n\n    # Test suite of parameters (alpha, C_art) for the QM/MM model\n    test_cases = [\n        # Case 1 (boundary consistency)\n        (1.0, 0.0),\n        # Case 2 (reduced coupling with artifact)\n        (0.75, 0.2),\n        # Case 3 (decoupled limit with artifact)\n        (0.0, 0.2),\n        # Case 4 (overcoupling with small artifact)\n        (1.1, 0.1),\n    ]\n\n    for alpha, C_art in test_cases:\n        # Calculate the QM/MM potential V_QM/MM(phi; alpha, C_art)\n        # V_QM/MM = V_QM_base + link_atom_terms\n        # V_QM/MM = c1*(1+cos(phi)) + c2*(1-cos(2*phi)) + alpha*c3*(1+cos(3*phi)) + C_art*(1-cos(phi))\n        \n        v_qmmm = (\n            c1 * (1 + cos_phi)\n            + c2 * (1 - cos_2phi)\n            + alpha * c3 * (1 + cos_3phi)\n            + C_art * (1 - cos_phi)\n        )\n        \n        # Calculate the barrier and add to results\n        delta_e_qmmm = np.max(v_qmmm) - np.min(v_qmmm)\n        results.append(delta_e_qmmm)\n\n    # Format the results to three decimal places and print in the specified format.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2465054"}, {"introduction": "除了扭曲势能面，连接原子方案中参数的选择也会给计算结果带来显著的不确定性，其中一个关键参数就是人为固定的连接键（例如 C-H 键）的键长。这个练习运用一个简化的谐振子模型，来定量探究这个固定的键长 $r_{\\mathrm{L}}$ 的微小变化如何影响化学反应的活化能垒。这个实践将帮助你理解 QM/MM 计算结果对这些非物理参数的敏感性，并对潜在的误差大小建立直观感受。[@problem_id:2465050]", "problem": "在一个采用连接原子方法的量子力学/分子力学 (QM/MM) 组合计算中，一个氢原子被用来覆盖边界处一个被切断的碳-碳键，从而形成一个人为的碳-氢键，其长度根据设定固定为一个选定值 $r_{\\mathrm{L}}$，单位为埃 (Å)。考虑一个简单且有物理依据的模型，其中在给定的分子结构下，这个被覆盖的键对总势能的能量贡献由一个围绕内禀的、依赖于状态的平衡距离 $r_{\\mathrm{eq}}$ 的一维谐振近似来描述，\n$$\nE_{\\mathrm{link}} = \\tfrac{1}{2}\\,k\\,(r_{\\mathrm{L}} - r_{\\mathrm{eq}})^2,\n$$\n其中 $k$ 是力常数，单位为 $\\mathrm{kJ\\,mol^{-1}\\,Å^{-2}}$，$r_{\\mathrm{L}}$ 是设定的连接原子碳-氢键长，单位为 Å，$r_{\\mathrm{eq}}$ 是在该几何构型（反应物或过渡态）下，适用于量子区域电子态的平衡键长，单位为 Å。假设反应物和过渡态的内禀（未覆盖的）Born–Oppenheimer 能量不依赖于 $r_{\\mathrm{L}}$，因此计算出的反应能垒的任何变化都完全源于过渡态和反应物之间 $E_{\\mathrm{link}}$ 的差异。\n\n对于给定的 $r_{\\mathrm{L}}$ 选择，将计算得到的能垒定义为\n$$\n\\Delta G^\\ddagger_{\\text{comp}}(r_{\\mathrm{L}}) = \\left[E_0(\\text{TS}) - E_0(\\text{R})\\right] + \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L}}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L}})\\right],\n$$\n其中 $E_0(\\text{TS})$ 和 $E_0(\\text{R})$ 是不依赖于 $r_{\\mathrm{L}}$ 的内禀状态能量。当 $r_{\\mathrm{L}}$ 从 $r_{\\mathrm{L},1}$ 变为 $r_{\\mathrm{L},2}$ 时，对计算能垒的影响即为差值\n$$\n\\Delta_{\\mathrm{barrier}} = \\Delta G^\\ddagger_{\\text{comp}}(r_{\\mathrm{L},2}) - \\Delta G^\\ddagger_{\\text{comp}}(r_{\\mathrm{L},1}) = \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},2}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},2})\\right] - \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},1}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},1})\\right].\n$$\n\n使用上述模型，编写一个程序，为下面的每个测试用例计算当连接原子键长从 $r_{\\mathrm{L},1} = 1.0$ Å 变为 $r_{\\mathrm{L},2} = 1.1$ Å 时，$\\Delta_{\\mathrm{barrier}}$ 的值，单位为 $\\mathrm{kJ\\,mol^{-1}}$。对于每种状态，请使用所提供的力常数 $k$ 以及内禀平衡距离 $r_{\\mathrm{eq}}(\\text{R})$ 和 $r_{\\mathrm{eq}}(\\text{TS})$。\n\n测试用例（每项给出 $(k, r_{\\mathrm{eq}}(\\text{R}), r_{\\mathrm{eq}}(\\text{TS}))$）：\n- 情况 $1$：$(k = 1500,\\ r_{\\mathrm{eq}}(\\text{R}) = 1.09,\\ r_{\\mathrm{eq}}(\\text{TS}) = 1.08)$。\n- 情况 $2$：$(k = 1500,\\ r_{\\mathrm{eq}}(\\text{R}) = 1.09,\\ r_{\\mathrm{eq}}(\\text{TS}) = 1.09)$。\n- 情况 $3$：$(k = 1500,\\ r_{\\mathrm{eq}}(\\text{R}) = 1.10,\\ r_{\\mathrm{eq}}(\\text{TS}) = 1.06)$。\n- 情况 $4$：$(k = 500,\\ r_{\\mathrm{eq}}(\\text{R}) = 1.09,\\ r_{\\mathrm{eq}}(\\text{TS}) = 1.08)$。\n- 情况 $5$：$(k = 1500,\\ r_{\\mathrm{eq}}(\\text{R}) = 1.07,\\ r_{\\mathrm{eq}}(\\text{TS}) = 1.09)$。\n\n要求：\n- 对所有情况，使用 $r_{\\mathrm{L},1} = 1.0$ Å 和 $r_{\\mathrm{L},2} = 1.1$ Å。\n- 将每个结果 $\\Delta_{\\mathrm{barrier}}$ 以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示，并四舍五入到三位小数。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[x_1,x_2,x_3,x_4,x_5]$），其中每个 $x_i$ 对应于上面所列顺序中情况 $i$ 的结果。", "solution": "所述问题经验证。\n\n**步骤 1：提取已知条件**\n\n*   被覆盖键的能量贡献：$E_{\\mathrm{link}} = \\tfrac{1}{2}\\,k\\,(r_{\\mathrm{L}} - r_{\\mathrm{eq}})^2$。\n*   $k$：力常数，单位为 $\\mathrm{kJ\\,mol^{-1}\\,Å^{-2}}$。\n*   $r_{\\mathrm{L}}$：设定的连接原子键长，单位为 Å。\n*   $r_{\\mathrm{eq}}$：内禀的、依赖于状态的平衡键长，单位为 Å。\n*   计算得到的反应能垒：$\\Delta G^\\ddagger_{\\text{comp}}(r_{\\mathrm{L}}) = \\left[E_0(\\text{TS}) - E_0(\\text{R})\\right] + \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L}}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L}})\\right]$。\n*   计算得到的能垒变化：$\\Delta_{\\mathrm{barrier}} = \\Delta G^\\ddagger_{\\text{comp}}(r_{\\mathrm{L},2}) - \\Delta G^\\ddagger_{\\text{comp}}(r_{\\mathrm{L},1}) = \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},2}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},2})\\right] - \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},1}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},1})\\right]$。\n*   固定的连接原子长度：$r_{\\mathrm{L},1} = 1.0$ Å 和 $r_{\\mathrm{L},2} = 1.1$ Å。\n*   测试用例为 $(k, r_{\\mathrm{eq}}(\\text{R}), r_{\\mathrm{eq}}(\\text{TS}))$：\n    *   情况 1：$(1500, 1.09, 1.08)$\n    *   情况 2：$(1500, 1.09, 1.09)$\n    *   情况 3：$(1500, 1.10, 1.06)$\n    *   情况 4：$(500, 1.09, 1.08)$\n    *   情况 5：$(1500, 1.07, 1.09)$\n\n**步骤 2：使用提取的已知条件进行验证**\n\n1.  **科学依据**：该问题利用谐振势来模拟共价键，这是一种标准且物理上合理的近似（键的胡克定律）。这是一个简化但已广为接受的模型，在计算化学中用于分析 QM/MM 计算中连接原子方案产生的人为效应。所提供的物理量——C-H 键长在 $1.1$ Å 左右，力常数为 $1500$ $\\mathrm{kJ\\,mol^{-1}\\,Å^{-2}}$——在物理上是现实的。此问题是合理的。\n2.  **提法得当**：该问题以数学上精确的方式进行了规定。它为待计算量 $\\Delta_{\\mathrm{barrier}}$ 提供了明确的公式，并提供了所有必要的数值输入。存在唯一解且可求。\n3.  **客观性**：该问题以客观、定量的术语陈述，没有歧义或主观内容。\n4.  **完整性和一致性**：该问题是自洽的。所有变量（$k$、$r_{\\mathrm{L}}$、$r_{\\mathrm{eq}}$）都已定义，并且为每次计算提供了它们的值。不存在矛盾。\n\n**步骤 3：结论与操作**\n\n该问题具有科学依据、提法得当且内部一致。判定为**有效**。将推导解答。\n\n需要计算的量是当固定的连接原子键长从 $r_{\\mathrm{L},1}$ 变为 $r_{\\mathrm{L},2}$ 时，计算得到的反应能垒的变化量 $\\Delta_{\\mathrm{barrier}}$。所提供的表达式是：\n$$\n\\Delta_{\\mathrm{barrier}} = \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},2}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},2})\\right] - \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},1}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},1})\\right]\n$$\n这里，`TS` 表示过渡态，`R` 表示反应物。问题陈述暗示，对于一个给定的测试用例，反应物和过渡态模型的力常数 $k$ 是相同的。该表达式可以在进行数值计算前进行解析简化。这是一个关于正确代数变换的练习，而不仅仅是暴力计算。\n\n我们首先按状态对各项进行重新分组：\n$$\n\\Delta_{\\mathrm{barrier}} = \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},2}) - E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},1})\\right] - \\left[E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},2}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},1})\\right]\n$$\n现在，代入连接原子能量的定义，$E_{\\mathrm{link}}(S; r_{\\mathrm{L}}) = \\frac{1}{2} k (r_{\\mathrm{L}} - r_{\\mathrm{eq}}(S))^2$，其中 $S$ 为 `R` 或 `TS`：\n$$\n\\Delta_{\\mathrm{barrier}} = \\left[ \\frac{1}{2}k(r_{\\mathrm{L},2} - r_{\\mathrm{eq}}(\\text{TS}))^2 - \\frac{1}{2}k(r_{\\mathrm{L},1} - r_{\\mathrm{eq}}(\\text{TS}))^2 \\right] - \\left[ \\frac{1}{2}k(r_{\\mathrm{L},2} - r_{\\mathrm{eq}}(\\text{R}))^2 - \\frac{1}{2}k(r_{\\mathrm{L},1} - r_{\\mathrm{eq}}(\\text{R}))^2 \\right]\n$$\n提出公因式 $\\frac{1}{2}k$：\n$$\n\\Delta_{\\mathrm{barrier}} = \\frac{1}{2}k \\left( \\left[ (r_{\\mathrm{L},2} - r_{\\mathrm{eq}}(\\text{TS}))^2 - (r_{\\mathrm{L},1} - r_{\\mathrm{eq}}(\\text{TS}))^2 \\right] - \\left[ (r_{\\mathrm{L},2} - r_{\\mathrm{eq}}(\\text{R}))^2 - (r_{\\mathrm{L},1} - r_{\\mathrm{eq}}(\\text{R}))^2 \\right] \\right)\n$$\n我们应用平方差公式，$a^2 - b^2 = (a-b)(a+b)$。对于一个任意状态 $S$，令 $a = r_{\\mathrm{L},2} - r_{\\mathrm{eq}}(S)$ 和 $b = r_{\\mathrm{L},1} - r_{\\mathrm{eq}}(S)$。\n那么 $a-b = (r_{\\mathrm{L},2} - r_{\\mathrm{eq}}(S)) - (r_{\\mathrm{L},1} - r_{\\mathrm{eq}}(S)) = r_{\\mathrm{L},2} - r_{\\mathrm{L},1}$。\n并且 $a+b = (r_{\\mathrm{L},2} - r_{\\mathrm{eq}}(S)) + (r_{\\mathrm{L},1} - r_{\\mathrm{eq}}(S)) = r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(S)$。\n因此，平方差项为 $(r_{\\mathrm{L},2} - r_{\\mathrm{L},1})(r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(S))$。\n\n将此代回 $\\Delta_{\\mathrm{barrier}}$ 的表达式中：\n$$\n\\Delta_{\\mathrm{barrier}} = \\frac{1}{2}k \\left( (r_{\\mathrm{L},2} - r_{\\mathrm{L},1})(r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(\\text{TS})) - (r_{\\mathrm{L},2} - r_{\\mathrm{L},1})(r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(\\text{R})) \\right)\n$$\n提出公因式 $(r_{\\mathrm{L},2} - r_{\\mathrm{L},1})$：\n$$\n\\Delta_{\\mathrm{barrier}} = \\frac{1}{2}k (r_{\\mathrm{L},2} - r_{\\mathrm{L},1}) \\left( (r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(\\text{TS})) - (r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(\\text{R})) \\right)\n$$\n大括号内的项可以大幅简化：\n$$\n(r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(\\text{TS})) - (r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(\\text{R})) = -2 r_{\\mathrm{eq}}(\\text{TS}) + 2 r_{\\mathrm{eq}}(\\text{R}) = 2(r_{\\mathrm{eq}}(\\text{R}) - r_{\\mathrm{eq}}(\\text{TS}))\n$$\n这导出了最终的简洁表达式：\n$$\n\\Delta_{\\mathrm{barrier}} = \\frac{1}{2}k (r_{\\mathrm{L},2} - r_{\\mathrm{L},1}) \\left[ 2(r_{\\mathrm{eq}}(\\text{R}) - r_{\\mathrm{eq}}(\\text{TS})) \\right]\n$$\n$$\n\\Delta_{\\mathrm{barrier}} = k (r_{\\mathrm{L},2} - r_{\\mathrm{L},1}) (r_{\\mathrm{eq}}(\\text{R}) - r_{\\mathrm{eq}}(\\text{TS}))\n$$\n必须实现的就是这个简化公式。它揭示了能垒的变化与力常数 $k$、连接原子长度的变化 $(r_{\\mathrm{L},2} - r_{\\mathrm{L},1})$ 以及反应物和过渡态之间内禀平衡键长的变化 $(r_{\\mathrm{eq}}(\\text{R}) - r_{\\mathrm{eq}}(\\text{TS}))$ 成正比。\n\n对于所有测试用例，连接原子长度的变化是恒定的：\n$$\nr_{\\mathrm{L},2} - r_{\\mathrm{L},1} = 1.1 \\, \\text{Å} - 1.0 \\, \\text{Å} = 0.1 \\, \\text{Å}\n$$\n因此，每个测试用例的计算都使用以下公式进行：\n$$\n\\Delta_{\\mathrm{barrier}} [\\mathrm{kJ\\,mol^{-1}}] = k \\times (0.1) \\times (r_{\\mathrm{eq}}(\\text{R}) - r_{\\mathrm{eq}}(\\text{TS}))\n$$\n单位是一致的：$(\\mathrm{kJ\\,mol^{-1}\\,Å^{-2}}) \\times (\\text{Å}) \\times (\\text{Å}) = \\mathrm{kJ\\,mol^{-1}}$。数值结果将按要求四舍五入到三位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the change in the computed QM/MM reaction barrier due to a change\n    in the link-atom bond length, based on a harmonic potential model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains (k [kJ/mol/Å^2], r_eq(R) [Å], r_eq(TS) [Å]).\n    test_cases = [\n        (1500, 1.09, 1.08),  # Case 1\n        (1500, 1.09, 1.09),  # Case 2\n        (1500, 1.10, 1.06),  # Case 3\n        (500, 1.09, 1.08),   # Case 4\n        (1500, 1.07, 1.09),  # Case 5\n    ]\n    \n    # Imposed link-atom bond lengths in Ångströms.\n    r_L1 = 1.0\n    r_L2 = 1.1\n\n    # The analytical derivation simplifies the formula for the change in barrier to:\n    # delta_barrier = k * (r_L2 - r_L1) * (r_eq(R) - r_eq(TS))\n    # Pre-calculate the change in link-atom length.\n    delta_r_L = r_L2 - r_L1\n    \n    results = []\n    for case in test_cases:\n        k, req_R, req_TS = case\n        \n        # Calculate the change in equilibrium bond length between Reactant and TS.\n        delta_req = req_R - req_TS\n        \n        # Calculate the change in the computed barrier.\n        delta_barrier = k * delta_r_L * delta_req\n        \n        # Format the result to three decimal places and append to the list.\n        # Using format string to ensure trailing zeros are included.\n        results.append(f\"{delta_barrier:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2465050"}, {"introduction": "既然我们已经看到了连接原子如何引入赝势，一项至关重要的实践技能便是在真实的 QM/MM 模拟中诊断出这些问题。先进的电子结构分析方法，如自然键轨道 (Natural Bond Orbital, NBO) 理论，提供了对边界扰动高度敏感的局域化指标（如电荷、键级）。这个思维练习将指导你设计一个稳健的诊断工作流程，通过将连接原子体系的 NBO 分析与化学上更可靠的参考模型进行比较，从而精确地定位这些赝势，这是确保 QM/MM 研究结果可靠性的核心技能。[@problem_id:2465085]", "problem": "在一次针对酶活性位点的混合量子力学/分子力学 (QM/MM) 计算中，一个位于量子力学 (QM) 区域的底物碳原子与一个位于分子力学 (MM) 区域的蛋白质碳原子之间的共价键被切断，并通过一个连接到 QM 区域碳原子上的氢连接原子进行封端。您怀疑该连接原子会扰动边界附近的电子密度，可能导致 QM 区域过度极化，并改变活性位点的电子结构。您计划使用自然键轨道 (NBO) 分析来诊断连接原子是否引入了赝象。\n\n哪种基于 NBO 的诊断策略能最直接地检测和归因于 QM/MM 边界上由连接原子引起的电子密度赝象？\n\nA. 对带有连接原子的 QM 区域和一个模拟真实共价环境的化学有效参考片段（例如，用 MM 取代基的最小模型替换连接原子）进行配对的 NBO 分析。比较边界原子上的自然布居分析 (NPA) 电荷 $q_A$、跨越切断键的 Wiberg 键级 $W_{AB}$，以及涉及连接原子轨道的相互作用（例如，连接原子的 $n \\to \\sigma^*$ 或 $\\sigma \\to \\sigma^*$）的二阶施主-受主稳定化能 $E^{(2)}$。在边界处局部化的 $q_A$、$W_{AB}$ 的显著偏差或异常大的 $E^{(2)}$ 项表明存在连接原子赝象。\n\nB. 仅检查 NBO 报告的 QM 区域的总偶极矩 $\\mu$，如果 $\\mu$ 相对于未封端的底物保持在定性合理的范围内，则接受该连接原子。\n\nC. 使用 NBO 将边界附近的 Lewis 占据数冻结为每个键恰好 2.00 个电子和每个孤对电子恰好 2.00 个电子，如果这一约束可以实现，则断定连接原子没有扰动电子密度。\n\nD. 仅增加连接原子上的高斯基组大小，直到 Wiberg 键级 $W_{\\mathrm{C}_{\\mathrm{QM}}-\\mathrm{H}_{\\mathrm{link}}}$ 接近 $1.00$，如果能实现，则认为边界没有赝象。\n\nE. 比较远离边界的原子的 Mulliken 电荷和 NBO NPA 电荷 $q_A$；如果两种方案在很小的容差内一致，则推断连接原子没有扰动切断键处的电子密度。", "solution": "首先将验证问题陈述。\n\n### 步骤 1：提取已知信息\n- 系统：一个使用混合量子力学/分子力学 (QM/MM) 方法研究的酶活性位点。\n- 边界：一个位于 QM 区域的底物碳原子与一个位于 MM 区域的蛋白质碳原子之间的共价键被切断。\n- 边界处理：使用一个氢连接原子来封端 QM 碳原子。\n- 假设：连接原子可能扰动电子密度，导致 QM 区域过度极化并改变电子结构。\n- 诊断工具：自然键轨道 (NBO) 分析。\n- 问题：哪种基于 NBO 的诊断策略能最直接地检测和归因于 QM/MM 边界上由连接原子引起的电子密度赝象？\n\n### 步骤 2：使用提取的已知信息进行验证\n该问题描述了计算化学中的一个标准且关键的问题，特别是在 QM/MM 模拟中。“连接原子”方案是一种广泛使用但存在问题的方法，用于处理跨越 QM/MM 边界的共价键。连接原子（通常是氢，其电负性比它经常取代的碳更强）引起人为极化的可能性是一个有充分文献记载的问题。自然键轨道 (NBO) 分析是一种强大且标准的解释电子结构的方法，它提供局域化轨道、原子电荷、键级和离域化度量，非常适合诊断此类局部电子扰动。该问题是一个关于如何将此技术正确应用于一个特定的、真实的科学问题的适定探究。\n\n- **科学上成立**：该问题牢固地植根于量子化学和计算建模（QM/MM、NBO）的既定原理。连接原子赝象是一种已知且被研究过的现象。\n- **适定性**：问题要求“最直接的”诊断策略，这意味着要比较不同方法以找到最有效的一种。从 NBO 分析的原理可以推导出一个确切的答案。\n- **客观性**：语言精确且技术性强，没有主观论断。\n\n问题陈述是有效的。\n\n### 步骤 3：结论与行动\n问题是有效的。将推导解决方案。\n\n问题的核心在于检测局限于 QM/MM 边界的电子结构的人为扰动。这种扰动的产生是因为使用了一个连接原子（这里是氢原子 H）来饱和 QM 原子（这里是碳原子 $\\mathrm{C}_{\\mathrm{QM}}$）的价层，该 QM 原子与 MM 原子（$\\mathrm{C}_{\\mathrm{MM}}$）的共价键已被切断。$\\mathrm{C}_{\\mathrm{QM}}-\\mathrm{H}_{\\mathrm{link}}$ 键的电子性质与原始的 $\\mathrm{C}_{\\mathrm{QM}}-\\mathrm{C}_{\\mathrm{MM}}$ 键有本质上的不同。具体来说，氢的电负性明显高于碳，导致键的极性更强。这可能会将过多的电子密度吸引到 $\\mathrm{C}_{\\mathrm{QM}}$ 原子上，这种赝象被称为过度极化，进而可能影响在 QM 区域中研究的化学过程。\n\n一个成功的诊断策略必须能够：\n1.  量化边界处的局域电子结构。\n2.  将此结构与一个没有连接原子赝象的、具有物理意义的参考系统进行比较。\n3.  隔离偏差并将其明确归因于连接原子的存在。\n\nNBO 分析为此提供了几个关键量：\n- **自然布居分析 (NPA) 电荷 ($q_A$)**：这些电荷为每个原子上的电子布居提供了稳健的度量。在连接原子模型和合适的参考模型之间，$q_{\\mathrm{C}_{\\mathrm{QM}}}$ 的显著变化将直接表明存在人为极化。\n- **Wiberg 键级 ($W_{AB}$)**：它们衡量原子 A 和 B 之间的共价键级。它们可以揭示成键性质的非自然变化。\n- **二阶微扰理论分析 ($E^{(2)}$)**：该分析量化了由施主-受主轨道相互作用（例如，超共轭）产生的稳定化能。涉及连接原子轨道的异常大的 $E^{(2)}$ 能量（例如，$\\sigma_{\\mathrm{C-X}} \\rightarrow \\sigma^*_{\\mathrm{C}_{\\mathrm{QM}}-\\mathrm{H}_{\\mathrm{link}}}$ 或 $n_{\\mathrm{Y}} \\rightarrow \\sigma^*_{\\mathrm{C}_{\\mathrm{QM}}-\\mathrm{H}_{\\mathrm{link}}}$）是由人为的连接原子引入的虚假电子离域的直接标志。\n\n我们现在基于这些原则评估每个提议的选项。\n\n**A. 对带有连接原子的 QM 区域和一个模拟真实共价环境的化学有效参考片段（例如，用 MM 取代基的最小模型替换连接原子）进行配对的 NBO 分析。比较边界原子上的自然布居分析 (NPA) 电荷 $q_A$、跨越切断键的 Wiberg 键级 $W_{AB}$，以及涉及连接原子轨道的相互作用（例如，连接原子的 $n \\to \\sigma^*$ 或 $\\sigma \\to \\sigma^*$）的二阶施主-受主稳定化能 $E^{(2)}$。在边界处局部化的 $q_A$、$W_{AB}$ 的显著偏差或异常大的 $E^{(2)}$ 项表明存在连接原子赝象。**\n\n该策略在方法上是可靠且全面的。\n1.  **使用参考系统**：将连接原子系统与一个“化学有效的参考片段”（例如，用甲基 $-\\mathrm{CH}_3$ 替换连接原子来模拟原始 $\\mathrm{C}_{\\mathrm{QM}}-\\mathrm{C}_{\\mathrm{MM}}$ 键的小分子）进行比较是正确的科学方法。没有参考，任何观测值都毫无意义。\n2.  **使用局域化度量**：它侧重于局域的 NBO 度量——$q_A$、$W_{AB}$ 和 $E^{(2)}$——这些度量对边界处的特定电子变化很敏感。\n3.  **直接归因**：通过比较测试系统和参考系统之间的这些特定度量，任何显著偏差都可以直接且明确地归因于人为的连接原子。例如，在连接原子模型中，$\\mathrm{C}_{\\mathrm{QM}}$ 上的 $q_A$ 比参考模型中更负，这是过度极化的直接证据。对于像 $n_{\\text{neighbor}} \\rightarrow \\sigma^*_{\\mathrm{C}_{\\mathrm{QM}}-\\mathrm{H}_{\\mathrm{link}}}$ 这样的相互作用，异常大的 $E^{(2)}$ 是非物理电荷转移赝象的直接标志。\n\n该选项描述了诊断连接原子赝象的标准、严谨的程序。\n结论：**正确**。\n\n**B. 仅检查 NBO 报告的 QM 区域的总偶极矩 $\\mu$，如果 $\\mu$ 相对于未封端的底物保持在定性合理的范围内，则接受该连接原子。**\n\n该策略是不充分的。总偶极矩 $\\mu$ 是整个 QM 区域的全局性质。它是所有原子电荷分布的矢量和。边界处的局域赝象可能对总偶极矩影响很小，或者其影响可能被 QM 区域中其他地方的电子转移所抵消。它缺乏诊断特定于边界问题所需的局域性。此外，“定性合理的范围”是什么，这是主观的，不是一个严谨的标准。不能使用单一的、全局的且可能模棱两可的度量来诊断特定的局域赝象。\n结论：**不正确**。\n\n**C. 使用 NBO 将边界附近的 Lewis 占据数冻结为每个键恰好 2.00 个电子和每个孤对电子恰好 2.00 个电子，如果这一约束可以实现，则断定连接原子没有扰动电子密度。**\n\n该提议误解了 NBO 分析的目的。NBO 的强大之处恰恰在于它能够量化与理想化 Lewis 结构（即占据数不等于 0、1 或 2）的偏差。这些偏差，通过反键轨道和里德堡轨道中的非零占据数捕获，并由 $E^{(2)}$ 能量量化，代表了像超共轭这样的真实物理效应。将占据数强制为理想整数值不是诊断；这是一种人为的强加，它抹去了检测赝象所需的信息。这相当于通过操纵测试以产生阴性结果来检测疾病。\n结论：**不正确**。\n\n**D. 仅增加连接原子上的高斯基组大小，直到 Wiberg 键级 $W_{\\mathrm{C}_{\\mathrm{QM}}-\\mathrm{H}_{\\mathrm{link}}}$ 接近 $1.00$，如果能实现，则认为边界没有赝象。**\n\n该策略存在缺陷。首先，由于超共轭效应会将电子密度从键中离域出去，因此在真实分子中，理想单键的 Wiberg 键级并不会恰好为 $1.00$。其次，这种方法侧重于将一个特定的度量强制为理想值，而忽略了电子结构的所有其他方面。主要问题是 H 和 C 之间的电负性差异，而不是 $\\mathrm{C}_{\\mathrm{QM}}-\\mathrm{H}_{\\mathrm{link}}$ 键本身的“质量”。第三，使用不平衡的基组（在一个原子上使用非常大的基组，在其他原子上使用较小的基组）是计算赝象的一个已知来源，例如基组重叠误差 (BSSE)，并且可能会使对电子结构的描述变得更糟。\n结论：**不正确**。\n\n**E. 比较远离边界的原子的 Mulliken 电荷和 NBO NPA 电荷 $q_A$；如果两种方案在很小的容差内一致，则推断连接原子没有扰动切断键处的电子密度。**\n\n该策略在两个主要方面是错误的。首先，它检查的是“远离边界”的原子。连接原子赝象本质上是局域在 QM/MM 边界的。电子效应随距离衰减，因此远处原子电荷的一致性几乎不能提供关于切断键处潜在问题的任何信息。其次，比较 Mulliken 电荷和 NPA 电荷通常不是诊断物理赝象的可靠方法。这两种电荷方案基于根本不同的划分方法，它们通常不一致。它们之间的先验不一致是这些方法的一个特点，不一定是物理问题的标志。它们之间的一致或不一致并非边界处理质量的可靠指标。\n结论：**不正确**。\n\n总之，选项 A 提出了一个完整、严谨且科学正确的策略，通过使用合适的参考系统并分析多个相关的、局域化的 NBO 导出量，直接解决了该问题。", "answer": "$$\\boxed{A}$$", "id": "2465085"}]}