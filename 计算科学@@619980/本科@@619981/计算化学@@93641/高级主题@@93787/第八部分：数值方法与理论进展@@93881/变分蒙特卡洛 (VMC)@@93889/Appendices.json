{"hands_on_practices": [{"introduction": "变分蒙特卡罗方法的基础在于通过优化试探波函数来逼近体系的基态能量。为了牢固掌握其核心计算原理，我们从量子力学中最简单、最经典的模型——氢原子——入手。通过这个练习，你将亲手推导局域能量 (local energy) 和变分能量的表达式，并利用变分原理找到最佳的变分参数$\\alpha$，从而将抽象的理论概念转化为具体的数学实践。[@problem_id:2828337]", "problem": "在用于电子结构的变分蒙特卡罗 (VMC) 和扩散蒙特卡罗 (DMC) 方法中，对于一个试探波函数 $\\Psi_{T}(\\mathbf{R})$，局域能量定义为 $E_{L}(\\mathbf{R}) \\equiv \\dfrac{\\hat{H}\\,\\Psi_{T}(\\mathbf{R})}{\\Psi_{T}(\\mathbf{R})}$，其中 $\\hat{H}$ 是系统的哈密顿算符。考虑一个单电子类氢问题，在哈特里原子单位制中，$\\hbar = m_{e} = e = 1$ 且 $4\\pi\\varepsilon_{0} = 1$。氢原子的非相对论哈密顿算符为 $\\hat{H} = -\\dfrac{1}{2}\\nabla^{2} - \\dfrac{1}{r}$，其中 $r = |\\mathbf{r}|$。\n\n设各向同性的试探波函数为 $\\Psi_{T}(r) = \\exp(-\\alpha r)$，其中 $\\alpha > 0$ 为实参数。仅使用基本定义，完成以下步骤：\n\n1) 推导局域能量 $E_{L}(r)$。\n\n2) 使用变分能量的定义 $E_{V}(\\alpha) = \\dfrac{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2} E_{L}(\\mathbf{r})\\, d^{3}\\mathbf{r}}{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2}\\, d^{3}\\mathbf{r}}$，精确计算 $E_{V}(\\alpha)$ 作为 $\\alpha$ 的函数。\n\n3) 将 $E_{V}(\\alpha)$ 对 $\\alpha$ 求极小值，以获得最优参数 $\\alpha^{\\star}$。\n\n在球坐标系中进行计算，并从第一性原理出发展示所有步骤，包括拉普拉斯算符作用于球对称函数的过程。你可以解析地计算所有需要的积分。以 $\\text{bohr}^{-1}$ 为单位，将 $\\alpha^{\\star}$ 的精确值作为最终答案。只提供 $\\alpha^{\\star}$ 作为最终答案；不要在最终的方框中包含局域能量或最小化后的能量。无需四舍五入。", "solution": "问题陈述具有科学依据、内容自洽且定量严谨。它展示了量子力学中的一个标准练习，特别是变分原理在氢原子问题上的应用。该问题是有效的，将按所述进行求解。\n\n任务是为氢原子给定的试探波函数 $\\Psi_{T}(r) = \\exp(-\\alpha r)$ 找到最优参数 $\\alpha^{\\star}$，氢原子的哈密顿算符在哈特里原子单位制中为 $\\hat{H} = -\\dfrac{1}{2}\\nabla^{2} - \\dfrac{1}{r}$。这将通过三个连续的步骤完成：首先，推导局域能量 $E_{L}(r)$；其次，计算变分能量 $E_{V}(\\alpha)$；第三，将 $E_{V}(\\alpha)$ 对 $\\alpha$ 求极小值。\n\n步骤1：推导局域能量 $E_{L}(r)$\n\n局域能量定义为 $E_{L}(\\mathbf{R}) = \\dfrac{\\hat{H}\\,\\Psi_{T}(\\mathbf{R})}{\\Psi_{T}(\\mathbf{R})}$。由于试探波函数 $\\Psi_{T}(r)$ 是球对称的，局域能量也将只依赖于径向坐标 $r$。我们必须将哈密顿算符 $\\hat{H}$ 应用于 $\\Psi_{T}(r)$。\n\n势能算符的作用是平凡的：\n$$\n-\\frac{1}{r} \\Psi_{T}(r) = -\\frac{1}{r} \\exp(-\\alpha r)\n$$\n\n动能算符 $-\\dfrac{1}{2}\\nabla^{2}$ 的作用需要计算 $\\Psi_{T}(r)$ 的拉普拉斯算符。在球坐标系 $(r, \\theta, \\phi)$ 中，拉普拉斯算符为：\n$$\n\\nabla^{2} = \\frac{1}{r^{2}} \\frac{\\partial}{\\partial r} \\left( r^{2} \\frac{\\partial}{\\partial r} \\right) + \\frac{1}{r^{2}\\sin\\theta} \\frac{\\partial}{\\partial \\theta} \\left( \\sin\\theta \\frac{\\partial}{\\partial \\theta} \\right) + \\frac{1}{r^{2}\\sin^{2}\\theta} \\frac{\\partial^{2}}{\\partial \\phi^{2}}\n$$\n由于 $\\Psi_{T}(r)$ 只依赖于 $r$，其对 $\\theta$ 和 $\\phi$ 的导数为零。拉普拉斯算符简化为其径向部分：\n$$\n\\nabla^{2}\\Psi_{T}(r) = \\frac{1}{r^{2}} \\frac{d}{dr} \\left( r^{2} \\frac{d\\Psi_{T}(r)}{dr} \\right)\n$$\n首先，我们计算 $\\Psi_{T}(r)$ 对 $r$ 的导数：\n$$\n\\frac{d\\Psi_{T}}{dr} = \\frac{d}{dr}\\exp(-\\alpha r) = -\\alpha \\exp(-\\alpha r)\n$$\n接着，乘以 $r^2$ 并再次求导：\n$$\n\\frac{d}{dr} \\left( r^{2} \\frac{d\\Psi_{T}}{dr} \\right) = \\frac{d}{dr} \\left( -r^{2}\\alpha \\exp(-\\alpha r) \\right) = - \\alpha \\left( 2r\\exp(-\\alpha r) - \\alpha r^{2}\\exp(-\\alpha r) \\right)\n$$\n最后，除以 $r^2$：\n$$\n\\nabla^{2}\\Psi_{T}(r) = \\frac{1}{r^2} \\left[ -2\\alpha r \\exp(-\\alpha r) + \\alpha^{2} r^{2} \\exp(-\\alpha r) \\right] = \\left( -\\frac{2\\alpha}{r} + \\alpha^{2} \\right) \\exp(-\\alpha r)\n$$\n所以，动能算符的作用是：\n$$\n-\\frac{1}{2}\\nabla^{2}\\Psi_{T}(r) = -\\frac{1}{2} \\left( \\alpha^{2} - \\frac{2\\alpha}{r} \\right) \\exp(-\\alpha r) = \\left( -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha}{r} \\right) \\exp(-\\alpha r)\n$$\n现在，我们结合动能和势能项来求 $\\hat{H}\\Psi_{T}(r)$：\n$$\n\\hat{H}\\Psi_{T}(r) = \\left( -\\frac{1}{2}\\nabla^{2} - \\frac{1}{r} \\right) \\Psi_{T}(r) = \\left( -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha}{r} \\right) \\exp(-\\alpha r) - \\frac{1}{r} \\exp(-\\alpha r) = \\left( -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha - 1}{r} \\right) \\exp(-\\alpha r)\n$$\n局域能量 $E_{L}(r)$ 通过将 $\\hat{H}\\Psi_{T}(r)$ 除以 $\\Psi_{T}(r)$ 得到：\n$$\nE_{L}(r) = \\frac{\\left( -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha - 1}{r} \\right) \\exp(-\\alpha r)}{\\exp(-\\alpha r)} = -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha - 1}{r}\n$$\n\n步骤2：计算变分能量 $E_{V}(\\alpha)$\n\n变分能量是局域能量在概率分布 $|\\Psi_{T}|^{2}$ 上的期望值：\n$$\nE_{V}(\\alpha) = \\frac{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2} E_{L}(\\mathbf{r})\\, d^{3}\\mathbf{r}}{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2}\\, d^{3}\\mathbf{r}} = \\langle E_{L}(r) \\rangle\n$$\n由于 $\\Psi_{T}(r)$ 是实数，所以 $|\\Psi_{T}(r)|^{2} = \\Psi_{T}(r)^{2} = \\exp(-2\\alpha r)$。我们可以写出：\n$$\nE_{V}(\\alpha) = \\left\\langle -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha - 1}{r} \\right\\rangle = -\\frac{\\alpha^{2}}{2} + (\\alpha - 1) \\left\\langle \\frac{1}{r} \\right\\rangle\n$$\n期望值 $\\langle \\frac{1}{r} \\rangle$ 由下式给出：\n$$\n\\left\\langle \\frac{1}{r} \\right\\rangle = \\frac{\\int_{\\mathbb{R}^{3}} \\frac{1}{r} |\\Psi_{T}(\\mathbf{r})|^{2} \\,d^{3}\\mathbf{r}}{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2} \\,d^{3}\\mathbf{r}}\n$$\n我们分别计算分子和分母的积分。球坐标系中的体积元是 $d^{3}\\mathbf{r} = r^{2}\\sin\\theta\\, dr\\, d\\theta\\, d\\phi$。对角变量 $(\\theta, \\phi)$ 的积分得到一个因子 $4\\pi$。\n\n分母的积分是：\n$$\n\\int_{\\mathbb{R}^{3}} |\\Psi_{T}|^{2} \\,d^{3}\\mathbf{r} = 4\\pi \\int_{0}^{\\infty} \\exp(-2\\alpha r) r^{2}\\, dr\n$$\n这是一个标准积分，形式为 $\\int_{0}^{\\infty} x^{n} \\exp(-ax)\\, dx = \\frac{n!}{a^{n+1}}$。此处，$n=2$ 且 $a=2\\alpha$。\n$$\n\\int_{0}^{\\infty} r^{2} \\exp(-2\\alpha r)\\, dr = \\frac{2!}{(2\\alpha)^{3}} = \\frac{2}{8\\alpha^{3}} = \\frac{1}{4\\alpha^{3}}\n$$\n所以，分母是 $4\\pi \\left( \\frac{1}{4\\alpha^{3}} \\right) = \\frac{\\pi}{\\alpha^{3}}$。\n\n$\\langle \\frac{1}{r} \\rangle$ 的分子积分是：\n$$\n\\int_{\\mathbb{R}^{3}} \\frac{1}{r} |\\Psi_{T}|^{2} \\,d^{3}\\mathbf{r} = 4\\pi \\int_{0}^{\\infty} \\frac{1}{r} \\exp(-2\\alpha r) r^{2}\\, dr = 4\\pi \\int_{0}^{\\infty} r \\exp(-2\\alpha r)\\, dr\n$$\n这对应于 $n=1$ 和 $a=2\\alpha$ 的情况：\n$$\n\\int_{0}^{\\infty} r \\exp(-2\\alpha r)\\, dr = \\frac{1!}{(2\\alpha)^{2}} = \\frac{1}{4\\alpha^{2}}\n$$\n所以，分子是 $4\\pi \\left( \\frac{1}{4\\alpha^{2}} \\right) = \\frac{\\pi}{\\alpha^{2}}$。\n\n现在我们计算 $\\langle \\frac{1}{r} \\rangle$：\n$$\n\\left\\langle \\frac{1}{r} \\right\\rangle = \\frac{\\pi/\\alpha^{2}}{\\pi/\\alpha^{3}} = \\alpha\n$$\n将此结果代回到 $E_{V}(\\alpha)$ 的表达式中：\n$$\nE_{V}(\\alpha) = -\\frac{\\alpha^{2}}{2} + (\\alpha - 1)\\alpha = -\\frac{\\alpha^{2}}{2} + \\alpha^{2} - \\alpha = \\frac{\\alpha^{2}}{2} - \\alpha\n$$\n\n步骤3：$E_{V}(\\alpha)$ 的最小化\n\n为了找到使变分能量最小化的最优参数 $\\alpha^{\\star}$，我们将 $E_{V}(\\alpha)$ 对 $\\alpha$ 求导，并令其结果为零：\n$$\n\\frac{dE_{V}}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\frac{\\alpha^{2}}{2} - \\alpha \\right) = \\alpha - 1\n$$\n令导数为零，得到极值条件：\n$$\n\\alpha - 1 = 0 \\implies \\alpha^{\\star} = 1\n$$\n为确认这是一个极小值，我们检查二阶导数：\n$$\n\\frac{d^{2}E_{V}}{d\\alpha^{2}} = \\frac{d}{d\\alpha}(\\alpha - 1) = 1\n$$\n由于二阶导数为正 ($1 > 0$)，该极值为极小值。参数的最优值为 $\\alpha^{\\star} = 1$。在哈特里原子单位制中，长度以玻尔半径 $a_{0}$ 为单位进行测量。参数 $\\alpha$ 的单位是长度的倒数，因此单位为 $\\text{bohr}^{-1}$ 是正确的。最优值为 $1\\ \\text{bohr}^{-1}$。", "answer": "$$\n\\boxed{1}\n$$", "id": "2828337"}, {"introduction": "在掌握了变分能量的理论计算之后，我们需要转向变分蒙特卡罗方法的实际应用，即随机抽样过程。一个成功的 VMC 模拟不仅需要一个好的试探波函数，还需要高效地在构型空间中进行抽样。此练习探讨了一个在实际操作中至关重要的诊断问题：Metropolis 算法的接受率告诉我们关于模拟步长$\\Delta\\tau$的什么信息，以及我们应如何调整它以提高抽样效率。[@problem_id:2461082]", "problem": "变分蒙特卡罗（VMC）模拟使用 Metropolis–Hastings (MH) 算法从一个与 $\\lvert \\Psi_T(\\mathbf{R}) \\rvert^2$ 成正比的目标分布中对电子构型 $\\mathbf{R}$ 进行采样。提议移动由一个行走步长参数 $\\Delta \\tau$ 控制，使得较大的 $\\Delta \\tau$ 会产生较大的典型位移。在一次生产性运行中，观测到的 Metropolis 接受率始终为 $99.9\\%$。以下哪个陈述最能描述这对于 $\\Delta \\tau$ 的选择意味着什么，以及应如何调整 $\\Delta \\tau$ 来提高采样效率？\n\nA. $\\Delta \\tau$ 太小；应将其增大以使提议移动更大，这将使接受率从 $99.9\\%$ 降低，并减少自相关。\n\nB. $\\Delta \\tau$ 太大；应将其减小以进一步提高接受率，并消除估计能量中的偏差。\n\nC. $\\Delta \\tau$ 是最优的，因为在 VMC 中，最大化接受率总能最小化每个样本的统计误差。\n\nD. 细致平衡要求接受率为 $100\\%$，因此必须将 $\\Delta \\tau$ 设为 $0$ 以确保正确性。\n\nE. VMC 中的接受率与 $\\Delta \\tau$ 无关，因此 $99.9\\%$ 的值对于任何调整都没有提供信息。", "solution": "问题陈述需要进行验证。\n\n**步骤 1：提取已知条件**\n-   方法：变分蒙特卡罗 (VMC)\n-   电子构型 $\\mathbf{R}$ 的目标分布：与 $\\lvert \\Psi_T(\\mathbf{R}) \\rvert^2$ 成正比。\n-   采样算法：Metropolis–Hastings (MH)。\n-   提议移动控制参数：行走步长 $\\Delta \\tau$。\n-   参数效应：较大的 $\\Delta \\tau$ 导致较大的典型位移。\n-   观测结果：Metropolis 接受率始终为 $99.9\\%$。\n-   问题：解释这对 $\\Delta \\tau$ 的影响，并确定为提高采样效率所需的调整。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题在计算化学中应用的马尔可夫链蒙特卡罗（MCMC）方法的标准理论中有充分依据，特别是在 VMC 中。使用 Metropolis-Hastings 算法从 $|\\Psi_T|^2$ 分布中采样，以及步长参数在控制提议移动和接受率中的作用，都是基本概念。\n-   **适定性**：该问题是适定的。它提出了一个具体的、可量化的观测结果（$99.9\\%$ 的接受率），并要求就模拟效率得出结论，这在 MCMC 优化的框架内有一个理论上合理且唯一的答案。\n-   **客观性**：该问题以客观、技术性的语言陈述。\n\n**步骤 3：结论与行动**\n问题有效。将推导解答。\n\n**推导**\n\n在变分蒙特卡罗中，使用 Metropolis-Hastings 算法生成一系列电子构型 $\\mathbf{R}_0, \\mathbf{R}_1, \\dots, \\mathbf{R}_N$，这些构型根据概率密度函数 $p(\\mathbf{R}) \\propto |\\Psi_T(\\mathbf{R})|^2$ 分布，其中 $\\Psi_T$ 是试探波函数。该算法通过从当前构型 $\\mathbf{R}_i$ 提议一个移动到新构型 $\\mathbf{R}'$ 来进行。对于常见的对称提议分布，该移动以以下概率被接受：\n$$ \\alpha(\\mathbf{R}'|\\mathbf{R}_i) = \\min\\left(1, \\frac{p(\\mathbf{R}')}{p(\\mathbf{R}_i)}\\right) = \\min\\left(1, \\frac{|\\Psi_T(\\mathbf{R}')|^2}{|\\Psi_T(\\mathbf{R}_i)|^2}\\right) $$\n如果移动被接受，则 $\\mathbf{R}_{i+1} = \\mathbf{R}'$。如果被拒绝，则行走者停留在同一位置，因此 $\\mathbf{R}_{i+1} = \\mathbf{R}_i$。\n\n提议移动的大小 $\\mathbf{R}' - \\mathbf{R}_i$ 由步长参数 $\\Delta \\tau$ 控制。较大的 $\\Delta \\tau$ 对应于较大的提议位移。\n\n观测到的 $99.9\\%$ 的接受率表明提议移动几乎总是被接受。从 $\\alpha$ 的表达式来看，这意味着比率 $\\frac{|\\Psi_T(\\mathbf{R}')|^2}{|\\Psi_T(\\mathbf{R}_i)|^2}$ 几乎总是大于或等于 $1$。这个条件在提议构型 $\\mathbf{R}'$ 与当前构型 $\\mathbf{R}_i$ 非常接近时成立。因此，极高的接受率是提议步长 $\\Delta \\tau$ 过小的直接标志。\n\n模拟的目标是实现高采样效率。MCMC 的效率取决于算法生成统计独立样本的速度。这与生成序列的自相关时间成反比。\n-   如果 $\\Delta \\tau$ 过小，接受率会很高，但行走者探索构型空间的速度非常慢。每个构型都与前一个构型高度相关。这导致自相关时间很长，采样效率很差。\n-   如果 $\\Delta \\tau$ 过大，提议移动通常会进入概率非常低的区域（其中 $|\\Psi_T(\\mathbf{R}')|^2$ 很小），导致接受率非常低。由于拒绝，行走者会频繁地“卡”在当前位置，这也会增加自相关并导致效率低下。\n\n通过平衡移动大小和接受率以最小化自相关时间，可以实现最佳采样效率。对于许多问题，一个普遍的经验法则是，大约 $50\\%$ 的接受率提供了一个很好的权衡。$99.9\\%$ 的接受率远非这个最优区间。为了提高效率，必须更快地探索构型空间。这需要增大步长 $\\Delta \\tau$。增大 $\\Delta \\tau$ 将导致更大的提议移动，这反过来会降低接受率，但会减少样本之间的自相关，从而提高整体采样效率。\n\n**逐项分析**\n\n**A. $\\Delta \\tau$ 太小；应将其增大以使提议移动更大，这将使接受率从 $99.9\\%$ 降低，并减少自相关。**\n该陈述完全符合 MCMC 效率的原则。$99.9\\%$ 的接受率意味着 $\\Delta \\tau$ 太小。增大 $\\Delta \\tau$ 将产生更大的提议移动，这将从其当前的极值降低接受率，并允许行走者更有效地探索构型空间，从而减少自相关。\n**结论：正确**\n\n**B. $\\Delta \\tau$ 太大；应将其减小以进一步提高接受率，并消除估计能量中的偏差。**\n该陈述在多个方面都是错误的。首先，$99.9\\%$ 的接受率意味着 $\\Delta \\tau$ 太小，而不是太大。其次，进一步提高接受率会恶化采样效率。第三，Metropolis 算法的设计是，对于任何允许马尔可夫链具有遍历性的 $\\Delta \\tau > 0$，它都是渐近无偏的。$\\Delta \\tau$ 的选择影响估计的统计误差（方差），而不是其偏差。\n**结论：错误**\n\n**C. $\\Delta \\tau$ 是最优的，因为在 VMC 中，最大化接受率总能最小化每个样本的统计误差。**\n该陈述存在根本性缺陷。通过设置 $\\Delta \\tau \\to 0$ 可以实现接受率最大化。在此极限下，行走者几乎不动，导致最大自相关，并因此在给定模拟步数下产生最大统计误差。\n**结论：错误**\n\n**D. 细致平衡要求接受率为 $100\\%$，因此必须将 $\\Delta \\tau$ 设为 $0$ 以确保正确性。**\n细致平衡原理确保收敛到正确的平稳分布，但它对接受率的值没有任何要求，除了它必须被正确计算。$100\\%$ 的接受率不是正确性的要求。此外，取 $\\Delta \\tau = 0$ 会停止对构型空间的探索，使模拟变得无用。\n**结论：错误**\n\n**E. VMC 中的接受率与 $\\Delta \\tau$ 无关，因此 $99.9\\%$ 的值对于任何调整都没有提供信息。**\n该陈述在事实上是错误的。接受率强烈依赖于提议步长 $\\Delta \\tau$。小的 $\\Delta \\tau$ 值导致高接受率，而大的 $\\Delta \\tau$ 值导致低接受率。观测到的接受率是调整 $\\Delta \\tau$ 的关键诊断指标。\n**结论：错误**", "answer": "$$\\boxed{A}$$", "id": "2461082"}, {"introduction": "理论的深刻理解往往来自于对其边界和失效情况的探索。这个练习提供了一个思想实验，通过分析一个“不适格”的试探波函数——箱式函数——来揭示 VMC 方法的内在要求和潜在陷阱。通过研究这个在数学上存在问题的案例，你将更深入地理解为何试探波函数必须满足某些连续性和可微性条件，以及违反这些条件会导致何种灾难性后果，例如能量发散和估计偏差。[@problem_id:2461068]", "problem": "考虑一个质量为 $m$ 的粒子在一维谐振子势 $V(x)=\\tfrac{1}{2}k x^{2}$ 中运动，其哈密顿量为 $H=-\\tfrac{\\hbar^{2}}{2m}\\dfrac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}+\\tfrac{1}{2}k x^{2}$。在变分蒙特卡洛（Variational Monte Carlo, VMC）方法中，一种常用的能量估计量使用局域能量 $E_{\\mathrm{L}}(x)=(H\\psi_{\\mathrm{T}})/\\psi_{\\mathrm{T}}$（在其有定义的区域），并从与 $\\lvert \\psi_{\\mathrm{T}}(x)\\rvert^{2}$ 成正比的概率密度中采样构型。在带漂移的重要性采样VMC中，提议漂移与 $\\nabla \\ln\\lvert \\psi_{\\mathrm{T}}\\rvert$ 成正比。考虑如下不连续的“箱型”试探波函数\n$$\n\\psi_{\\mathrm{T}}(x)=\n\\begin{cases}\nC, & \\lvert x\\rvert\\le L \\\\\n0, & \\lvert x\\rvert> L\n\\end{cases}\n$$\n其中 $L>0$ 且归一化常数为 $C=1/\\sqrt{2L}$。\n\n关于在VMC中使用此 $\\psi_{\\mathrm{T}}$，以下哪些陈述是正确的？\n\nA. 对于几乎所有采样的 $x$，局域能量等于 $E_{\\mathrm{L}}(x)=\\tfrac{1}{2}k x^{2}$，因此其蒙特卡洛平均是对真实变分能量的无偏估计，且对于任何 $L$ 都遵循变分原理。\n\nB. 因为 $\\psi_{\\mathrm{T}}$ 是不连续的，动能的贡献使得精确的变分能量为无穷大；通过在远离边界处采样计算出的通常的局域能量平均值 $\\langle E_{\\mathrm{L}}\\rangle$ 是有偏的，并且低估了真实能量。\n\nC. 由于在 $x=\\pm L$ 处的不可微性，局域能量的方差是无穷大，尽管恰好在 $\\lvert x\\rvert=L$ 的构型出现的概率为零。\n\nD. 在与 $\\nabla \\ln\\lvert \\psi_{\\mathrm{T}}\\rvert$ 成正比的带漂移的重要性采样VMC中，漂移在其有定义的任何地方都恒等于零，因此提议过程简化为简单的随机行走，并且任何移出 $\\lvert x\\rvert\\le L$ 区域的提议的接受概率为 $0$。\n\nE. 如果对采样平均值 $\\langle E_{\\mathrm{L}}\\rangle$ 关于 $L$ 进行最小化，最优的 $L$ 趋向于 $0$，这说明了一个因忽略动能边界贡献而产生的虚假的“变分”最小值。", "solution": "首先将对问题陈述进行严格验证。\n\n### 步骤 1：提取已知条件\n\n-   **系统**：一个质量为 $m$ 的粒子在一维空间中运动。\n-   **势能**：$V(x)=\\tfrac{1}{2}k x^{2}$。\n-   **哈密顿量**：$H=-\\tfrac{\\hbar^{2}}{2m}\\dfrac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}+\\tfrac{1}{2}k x^{2}$。\n-   **方法论**：变分蒙特卡洛（VMC）。\n-   **局域能量估计量**：$E_{\\mathrm{L}}(x)=(H\\psi_{\\mathrm{T}})/\\psi_{\\mathrm{T}}$。\n-   **采样分布**：与 $\\lvert \\psi_{\\mathrm{T}}(x)\\rvert^{2}$ 成正比。\n-   **重要性采样漂移**：与 $\\nabla \\ln\\lvert \\psi_{\\mathrm{T}}\\rvert$ 成正比。\n-   **试探波函数**：\n    $$\n    \\psi_{\\mathrm{T}}(x)=\n    \\begin{cases}\n    C, & \\lvert x\\rvert\\le L \\\\\n    0, & \\lvert x\\rvert> L\n    \\end{cases}\n    $$\n-   **常数**：$L>0$， $C=1/\\sqrt{2L}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n-   **科学基础**：该问题的基础是量子力学的基本原理（谐振子）和一种标准的计算技术（变分蒙特卡洛）。使用不连续的试探波函数，虽然不代表物理态，但作为一个有效且重要的教学案例，有助于理解VMC方法的要求和局限性。其中的概念在科学上是合理的。\n-   **适定性**：问题是适定的。哈密顿量、试探波函数和VMC过程都已明确定义。问题要求分析使用这个特定试探函数的后果，这是一个定义明确的任务，具有一组唯一的正确结论。\n-   **客观性**：问题以精确、客观的语言陈述，没有歧义或主观论断。归一化常数 $C=1/\\sqrt{2L}$ 与波函数定义一致：$\\int_{-\\infty}^{\\infty} \\lvert \\psi_{\\mathrm{T}}(x) \\rvert^2 dx = \\int_{-L}^{L} C^2 dx = C^2(2L) = (1/(2L))(2L) = 1$。该设定是完备且自洽的。\n\n### 步骤 3：结论与行动\n\n问题陈述在科学上是合理的、适定的和客观的。没有可识别的缺陷。这是一个有效的问题。我们可以继续进行解答。\n\n### 推导与分析\n\n该问题的核心在于将哈密顿算符 $H$ 应用于一个不连续的试探波函数 $\\psi_{\\mathrm{T}}(x)$。\n\n**1. 真实变分能**\n精确的变分能是哈密顿量的期望值：\n$$ E_V = \\frac{\\langle \\psi_{\\mathrm{T}} | H | \\psi_{\\mathrm{T}} \\rangle}{\\langle \\psi_{\\mathrm{T}} | \\psi_{\\mathrm{T}} \\rangle} = \\langle \\psi_{\\mathrm{T}} | H | \\psi_{\\mathrm{T}} \\rangle $$\n因为 $\\psi_{\\mathrm{T}}$ 是归一化的。这便是 $E_V = \\langle T \\rangle + \\langle V \\rangle$。\n\n我们首先计算势能期望值：\n$$ \\langle V \\rangle = \\int_{-L}^{L} \\psi_{\\mathrm{T}}^*(x) \\left(\\frac{1}{2}kx^2\\right) \\psi_{\\mathrm{T}}(x) dx = \\int_{-L}^{L} C^2 \\frac{1}{2}kx^2 dx $$\n$$ \\langle V \\rangle = \\left(\\frac{1}{2L}\\right) \\frac{k}{2} \\int_{-L}^{L} x^2 dx = \\frac{k}{4L} \\left[\\frac{x^3}{3}\\right]_{-L}^{L} = \\frac{k}{4L} \\left(\\frac{L^3}{3} - \\frac{-L^3}{3}\\right) = \\frac{k L^2}{6} $$\n势能期望值是有限的。\n\n现在，考虑动能算符 $T = -\\tfrac{\\hbar^{2}}{2m}\\dfrac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}$。一个波函数必须是连续的并且其一阶导数是平方可积的，其动能才是有限的。给定的 $\\psi_{\\mathrm{T}}(x)$ 在 $x=\\pm L$ 处不连续。为了正确评估二阶导数的作用，我们必须使用广义函数。$\\psi_{\\mathrm{T}}(x)$ 的一阶导数涉及到狄拉克-δ函数：\n$$ \\frac{\\mathrm{d}\\psi_{\\mathrm{T}}}{\\mathrm{d}x} = C[\\delta(x+L) - \\delta(x-L)] $$\n动能期望值的正确计算方法是：\n$$ \\langle T \\rangle = \\int_{-\\infty}^{\\infty} \\psi_{\\mathrm{T}}^*(x) \\left( -\\frac{\\hbar^{2}}{2m}\\frac{\\mathrm{d}^2}{\\mathrm{d}x^2} \\right) \\psi_{\\mathrm{T}}(x) dx = \\frac{\\hbar^2}{2m} \\int_{-\\infty}^{\\infty} \\left| \\frac{\\mathrm{d}\\psi_{\\mathrm{T}}}{\\mathrm{d}x} \\right|^2 dx $$\n代入导数：\n$$ \\langle T \\rangle = \\frac{\\hbar^2 C^2}{2m} \\int_{-\\infty}^{\\infty} |\\delta(x+L) - \\delta(x-L)|^2 dx $$\nδ函数的平方的积分是无穷大。因此，$\\langle T \\rangle = \\infty$。\n因此，真实的变分能是 $E_V = \\langle T \\rangle + \\langle V \\rangle = \\infty$。\n\n**2. VMC能量估计**\nVMC方法通过对从概率分布 $P(x) = |\\psi_{\\mathrm{T}}(x)|^2$ 中采样的构型计算局域能量 $E_{\\mathrm{L}}(x) = (H\\psi_{\\mathrm{T}})/\\psi_{\\mathrm{T}}$ 的平均值来估计能量。这里，$P(x)$ 是在 $[-L, L]$ 上的均匀分布。\n对于开区间 $(-L, L)$ 中的任意点 $x$，$\\psi_{\\mathrm{T}}(x) = C$（一个常数）。其导数为零：\n$$ \\frac{\\mathrm{d}\\psi_{\\mathrm{T}}}{\\mathrm{d}x} = 0, \\quad \\frac{\\mathrm{d}^2\\psi_{\\mathrm{T}}}{\\mathrm{d}x^2} = 0 \\quad \\text{for } |x|<L $$\n因此，对于 $|x|<L$，局域能量为：\n$$ E_{\\mathrm{L}}(x) = \\frac{1}{C} \\left( -\\frac{\\hbar^{2}}{2m}(0) + \\frac{1}{2}kx^2 C \\right) = \\frac{1}{2}kx^2 $$\n蒙特卡洛模拟从连续分布 $P(x)$ 中采样点。采到特定点 $x=\\pm L$ 的概率为零。因此，模拟只会在 $x \\in (-L, L)$ 的范围内计算 $E_{\\mathrm{L}}(x)$。能量的蒙特卡洛估计值 $E_{VMC}$ 收敛于这个不完整的局域能量的平均值：\n$$ E_{VMC} = \\int_{-L}^{L} E_{\\mathrm{L}}(x) P(x) dx = \\int_{-L}^{L} \\left(\\frac{1}{2} kx^2\\right) \\frac{1}{2L} dx = \\frac{k}{4L} \\left[\\frac{x^3}{3}\\right]_{-L}^{L} = \\frac{k L^2}{6} $$\n这个估计完全忽略了来自边界的无穷大的动能贡献。\n\n我们现在来评估每个陈述。\n\n**A. 对于几乎所有采样的 $x$，局域能量等于 $E_{\\mathrm{L}}(x)=\\tfrac{1}{2}k x^{2}$，因此其蒙特卡洛平均是对真实变分能量的无偏估计，且对于任何 $L$ 都遵循变分原理。**\n第一部分是正确的：对于几乎所有的 $x$（即，排除了测度为零的集合 $\\{ -L, L \\}$），$E_{\\mathrm{L}}(x)=\\tfrac{1}{2}k x^{2}$。然而，结论是错误的。蒙特卡洛平均值为 $E_{VMC} = \\frac{kL^2}{6}$，而真实的变分能量是 $E_V = \\infty$。因此，该估计是严重有偏的。此外，通过选择小的 $L$，这个估计值 $E_{VMC}$ 可以变得任意小，这违反了变分原理，该原理要求能量必须高于真实的基态能量 $E_0 = \\frac{1}{2}\\hbar\\sqrt{k/m} > 0$。\n**结论：不正确。**\n\n**B. 因为 $\\psi_{\\mathrm{T}}$ 是不连续的，动能的贡献使得精确的变分能量为无穷大；通过在远离边界处采样计算出的通常的局域能量平均值 $\\langle E_{\\mathrm{L}}\\rangle$ 是有偏的，并且低估了真实能量。**\n这个陈述是对情况的精确和正确的描述。不连续性导致了无穷大的动能期望，使得精确的变分能量为无穷大。标准的VMC采样过程，通过仅在局域能量表现良好（远离边界）的地方进行评估，得到了一个有限的平均值 $E_{VMC} = kL^2/6$。这个平均值是有偏的，因为它不等于真实的期望值（$E_V=\\infty$），并且这是一个严重的低估。\n**结论：正确。**\n\n**C. 由于在 $x=\\pm L$ 处的不可微性，局域能量的方差是无穷大，尽管恰好在 $\\lvert x\\rvert=L$ 的构型出现的概率为零。**\n能量的形式方差是 $\\sigma_E^2 = \\langle (H-E_V)^2 \\rangle = \\langle H^2 \\rangle - E_V^2$。由于 $E_V = \\infty$，这个表达式没有明确定义。一个更好的度量是局域能量的方差，$\\sigma_{E_L}^2 = \\int (E_{\\mathrm{L}}(x) - E_V)^2 |\\psi_{\\mathrm{T}}(x)|^2 dx$。因为对于 $|x|<L$，$E_{\\mathrm{L}}(x)$ 是有限的，而 $E_V=\\infty$，所以被积函数在箱内处处为无穷大，使得积分为无穷大。另外，可以证明 $\\langle E_{\\mathrm{L}}^2 \\rangle = \\int |H\\psi_{\\mathrm{T}}(x)|^2/\\psi_{\\mathrm{T}}(x)|^2 \\cdot |\\psi_{\\mathrm{T}}(x)|^2 dx = \\int |H\\psi_{\\mathrm{T}}(x)|^2 dx$（对于实函数 $\\psi_{\\mathrm{T}}$），由于 $H\\psi_{\\mathrm{T}}$ 的奇异性，该值为无穷大。对于不在哈密顿量定义域内的试探函数，局域能量的方差无穷大是一个已知的病态问题。这个陈述正确地指出了这一事实及其原因。\n**结论：正确。**\n\n**D. 在与 $\\nabla \\ln\\lvert \\psi_{\\mathrm{T}}\\rvert$ 成正比的带漂移的重要性采样VMC中，漂移在其有定义的任何地方都恒等于零，因此提议过程简化为简单的随机行走，并且任何移出 $\\lvert x\\rvert\\le L$ 区域的提议的接受概率为 $0$。**\n漂移项与 $\\nabla \\ln|\\psi_{\\mathrm{T}}|$ 成正比。对于 $|x|<L$，$|\\psi_{\\mathrm{T}}(x)|=C$ 是一个常数，所以 $\\ln|\\psi_{\\mathrm{T}}(x)|$ 是一个常数，其梯度为零。漂移在其有定义的任何地方（即，对于 $|x|<L$）确实为零。因此，提议机制简化为简单的随机行走（扩散）。如果一个位于箱内位置 $x_{old}$ 的行走者提议移动到箱外的位置 $x_{new}$，基于Metropolis准则的接受概率是 $A = \\min\\left(1, \\frac{|\\psi_{\\mathrm{T}}(x_{new})|^2}{|\\psi_{\\mathrm{T}}(x_{old})|^2}\\right) = \\min\\left(1, \\frac{0^2}{C^2}\\right) = 0$。这个陈述是完全准确的。行走者被限制在箱内，这防止了算法遇到有问题的边界。\n**结论：正确。**\n\n**E. 如果对采样平均值 $\\langle E_{\\mathrm{L}}\\rangle$ 关于 $L$ 进行最小化，最优的 $L$ 趋向于 $0$，这说明了一个因忽略动能边界贡献而产生的虚假的“变分”最小值。**\n采样平均值为 $E_{VMC}(L) = \\frac{kL^2}{6}$。这个关于变分参数 $L$ 的函数需要被最小化。对于 $k>0$，当 $L \\to 0$ 时（因为 $L>0$），此函数被最小化。相应的“最小”能量趋近于 $0$。这是一个非物理的结果，远低于真实的基态能量。这展示了变分优化的灾难性失败，产生了一个虚假的最小值，因为对于这个波函数，VMC估计量存在根本性缺陷，它忽略了占主导地位的（无穷大的）动能项。\n**结论：正确。**", "answer": "$$\\boxed{BCDE}$$", "id": "2461068"}]}