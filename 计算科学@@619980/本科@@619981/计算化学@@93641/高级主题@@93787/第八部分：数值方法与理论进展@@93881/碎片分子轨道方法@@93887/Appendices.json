{"hands_on_practices": [{"introduction": "FMO方法的准确性在很大程度上取决于如何将大分子分割成小碎片。这个过程被称为“碎片化”，其中分子内共价键的切割方式会引入近似误差。本练习通过一个简化的休克尔分子轨道模型（Hückel Molecular Orbital, HMO）来研究苯分子的碎片化，让你亲手计算并比较两种不同碎片化方案所导致的FMO能量误差，从而直观地理解碎片化策略的重要性。[@problem_id:2464440]", "problem": "给定一个苯环，其模型为一个包含六个碳原子的环状图，原子标记为 $1,2,3,4,5,6$，每个原子贡献一个 $\\pi$ 电子。考虑在一个简化的、轨道零重叠的休克尔分子轨道 (HMO) 模型下，将二体展开水平 (FMO2) 的碎片分子轨道 (FMO) 方法应用于该体系。对于任意原子集合 $S$，其 Hückel 哈密顿量定义为一个实对称矩阵 $H(S)$，其矩阵元为\n$$\nH_{ij}(S) =\n\\begin{cases}\n\\alpha, & \\text{若 } i=j \\in S, \\\\\n\\beta, & \\text{若 } i\\neq j,\\ i\\in S,\\ j\\in S,\\ \\text{且 } i \\text{ 与 } j \\text{ 在苯环中成键}, \\\\\n0, & \\text{其他情况},\n\\end{cases}\n$$\n其中 $\\alpha$ 是库仑参数（在位能），$\\beta$ 是共振积分（最近邻相互作用）。苯环的成键模式是一个 6 元环：原子 $i$ 与原子 $i-1$ 和 $i+1$（索引按模 6 计算）成键。假设轨道重叠为零，且不考虑原子核排斥的贡献。对于任意子体系 $S$，其总电子能量 $E(S)$ 的定义如下：求解本征值问题 $H(S)\\mathbf{c}_k=\\varepsilon_k\\mathbf{c}_k$，将得到的本征值 $\\varepsilon_k$ 按升序排列，然后根据构造原理填充电子：每个分子轨道最多可容纳 2 个自旋相反的电子。如果电子数 $N(S)$ 为奇数，则最高占据分子轨道为单占据。由于每个碳原子贡献一个 $\\pi$ 电子，故使用 $N(S)=|S|$。\n\n对于一个碎片划分 $\\mathcal{F}=\\{F_1,\\dots,F_M\\}$，FMO2 总能量定义为\n$$\nE_{\\mathrm{FMO2}}(\\mathcal{F}) \\;=\\; \\sum_{I=1}^{M} E(F_I) \\;+\\; \\sum_{1\\le I < J \\le M} \\left[ E(F_I \\cup F_J) - E(F_I) - E(F_J) \\right].\n$$\n精确总能量 $E_{\\mathrm{exact}}$ 为 $E(\\{1,2,3,4,5,6\\})$。\n\n考虑苯的两种碎片划分：\n- 划分为 $\\mathcal{F}_{2+2+2}$，包含三个类似乙炔的单元（每个单元包含两个相邻的碳原子）：$F_1=\\{1,2\\}$, $F_2=\\{3,4\\}$, $F_3=\\{5,6\\}$。\n- 划分为 $\\mathcal{F}_{3+3}$，包含两个类似烯丙基的单元（每个单元包含三个相邻的碳原子）：$G_1=\\{1,2,3\\}$, $G_2=\\{4,5,6\\}$。\n\n对于下方测试集中的每组参数 $(\\alpha,\\beta)$，计算两种碎片划分的 FMO2 总能量误差，其定义为\n$$\n\\Delta E_{\\mathcal{F}} \\;=\\; E_{\\mathrm{FMO2}}(\\mathcal{F}) - E_{\\mathrm{exact}}.\n$$\n能量以电子伏特 (eV) 为单位报告，并四舍五入到六位小数。\n\n测试集（每对 $(\\alpha,\\beta)$ 的单位均为 eV）：\n- 案例 A（通用）：$(\\alpha,\\beta) = (\\,0.0,\\,-2.5\\,)$。\n- 案例 B（边界，无耦合）：$(\\alpha,\\beta) = (\\,1.0,\\,0.0\\,)$。\n- 案例 C（耦合符号反转）：$(\\alpha,\\beta) = (\\,0.5,\\,2.0\\,)$。\n\n你的程序必须输出单行，其中包含一个结果列表，每个测试案例对应一个结果。每个结果是该案例下的列表 $[\\Delta E_{\\mathcal{F}_{2+2+2}},\\, \\Delta E_{\\mathcal{F}_{3+3}}]$，其顺序与测试集中的顺序一致。最终输出必须是单行，格式为用方括号括起来的逗号分隔列表，例如 $[[x_1,y_1],[x_2,y_2],[x_3,y_3]]$，其中每个 $x_i$ 和 $y_i$ 是一个以 eV 为单位、四舍五入到六位小数的浮点数。", "solution": "该问题提法恰当且科学上合理，基于计算化学的既定原理，特别是 Hückel 分子轨道 (HMO) 模型和碎片分子轨道 (FMO) 方法。所有必需的定义、参数和约束条件都已提供。我将着手提供一个解决方案。\n\n问题的核心是计算苯环的两种不同碎片划分在二体 FMO 近似 (FMO2) 下的误差。误差 $\\Delta E_{\\mathcal{F}}$ 定义为 FMO2 能量与完整体系的精确能量之间的差值：\n$$\n\\Delta E_{\\mathcal{F}} = E_{\\mathrm{FMO2}}(\\mathcal{F}) - E_{\\mathrm{exact}}\n$$\n该体系是一个含有六个碳原子的苯环，每个碳原子贡献一个 $\\pi$ 电子。任何子体系 $S$ 中的总电子数等于其原子数 $|S|$。\n\n首先，必须建立一个在 HMO 模型下计算子体系 $S$ 的总电子能量 $E(S)$ 的通用步骤。\n1.  **构建 Hückel 哈密顿矩阵 $H(S)$**：对于由原子集合 $S$ 组成的子体系，其哈密顿量 $H(S)$ 是一个 $|S| \\times |S|$ 的矩阵。其矩阵元定义为：对于原子 $i \\in S$，$H_{ii}(S) = \\alpha$；如果原子 $i, j \\in S$ 在原始苯分子中成键，则 $H_{ij}(S) = \\beta$。所有其他矩阵元均为 0。苯中的成键是环状的：原子 $i \\in \\{1, \\dots, 6\\}$ 与 $i-1$ 和 $i+1$ 成键（索引按模6计算，其中0映射为6）。\n2.  **求解本征值问题**：分子轨道能量 $\\varepsilon_k$ 是 $H(S)$ 的本征值。我们通过求解久期方程 $H(S)\\mathbf{c}_k = \\varepsilon_k \\mathbf{c}_k$ 来找到这些值。本征值必须按升序排列。\n3.  **计算总能量**：总电子能量 $E(S)$ 是通过根据构造原理，用可用的电子（$N(S) = |S|$）填充分子轨道来获得的。设有 $N_{\\text{pairs}} = \\lfloor N(S)/2 \\rfloor$ 个双占据轨道和 $N_{\\text{unpaired}} = N(S) \\pmod 2$ 个单占据轨道，能量为：\n    $$\n    E(S) = \\sum_{k=1}^{N_{\\text{pairs}}} 2\\varepsilon_k + \\sum_{k=N_{\\text{pairs}}+1}^{N_{\\text{pairs}}+N_{\\text{unpaired}}} \\varepsilon_k\n    $$\n\n精确能量 $E_{\\mathrm{exact}}$ 是整个苯分子的能量，即 $E(\\{1,2,3,4,5,6\\})$。\n\n接下来，我们计算每种碎片划分的 FMO2 能量。通用的 FMO2 公式为：\n$$\nE_{\\mathrm{FMO2}}(\\mathcal{F}) = \\sum_{I=1}^{M} E(F_I) + \\sum_{1\\le I < J \\le M} \\left[ E(F_I \\cup F_J) - E(F_I) - E(F_J) \\right]\n$$\n\n**碎片划分 $\\mathcal{F}_{3+3}$：**\n这种划分由两个碎片组成，$G_1=\\{1,2,3\\}$ 和 $G_2=\\{4,5,6\\}$。在这种情况下，$M=2$。FMO2 公式大大简化：\n$$\nE_{\\mathrm{FMO2}}(\\mathcal{F}_{3+3}) = E(G_1) + E(G_2) + \\left[ E(G_1 \\cup G_2) - E(G_1) - E(G_2) \\right] = E(G_1 \\cup G_2)\n$$\n由于 $G_1 \\cup G_2 = \\{1,2,3,4,5,6\\}$ 是整个苯分子，所以 FMO2 能量恰好是完整体系的能量：\n$$\nE_{\\mathrm{FMO2}}(\\mathcal{F}_{3+3}) = E(\\{1,2,3,4,5,6\\}) = E_{\\mathrm{exact}}\n$$\n因此，无论参数 $\\alpha$ 和 $\\beta$ 如何，这种划分的误差始终为零：\n$$\n\\Delta E_{\\mathcal{F}_{3+3}} = E_{\\mathrm{FMO2}}(\\mathcal{F}_{3+3}) - E_{\\mathrm{exact}} = 0\n$$\n\n**碎片划分 $\\mathcal{F}_{2+2+2}$：**\n这种划分由三个碎片组成：$F_1=\\{1,2\\}$, $F_2=\\{3,4\\}$ 和 $F_3=\\{5,6\\}$。这里 $M=3$。FMO2 能量为：\n$$\nE_{\\mathrm{FMO2}}(\\mathcal{F}_{2+2+2}) = \\sum_{I=1}^{3} E(F_I) + \\sum_{1\\le I < J \\le 3} \\left[ E(F_I \\cup F_J) - E(F_I) - E(F_J) \\right]\n$$\n这个表达式可以重排为：\n$$\nE_{\\mathrm{FMO2}}(\\mathcal{F}_{2+2+2}) = E(F_1 \\cup F_2) + E(F_1 \\cup F_3) + E(F_2 \\cup F_3) - E(F_1) - E(F_2) - E(F_3)\n$$\n根据苯环的对称性和碎片划分模式：\n-   碎片 $F_1, F_2, F_3$ 是等价的（两个相邻原子），因此 $E(F_1) = E(F_2) = E(F_3)$。\n-   碎片对 $F_1 \\cup F_2 = \\{1,2,3,4\\}$ 和 $F_2 \\cup F_3 = \\{3,4,5,6\\}$ 是等价的（四个原子的线性链），因此 $E(F_1 \\cup F_2) = E(F_2 \\cup F_3)$。\n-   碎片对 $F_1 \\cup F_3 = \\{1,2,5,6\\}$ 不同，因为原子 1 和 6 成键，形成一个非线性结构。\nFMO2 能量的简化公式为：\n$$\nE_{\\mathrm{FMO2}}(\\mathcal{F}_{2+2+2}) = 2E(F_1 \\cup F_2) + E(F_1 \\cup F_3) - 3E(F_1)\n$$\n为了找到误差 $\\Delta E_{\\mathcal{F}_{2+2+2}}$，我们必须计算四个子体系的能量：\n1.  $S_1 = \\{1,2,3,4,5,6\\}$ 以得到 $E_{\\mathrm{exact}}$。\n2.  $S_2 = F_1 = \\{1,2\\}$ 以得到 $E(F_1)$。\n3.  $S_3 = F_1 \\cup F_2 = \\{1,2,3,4\\}$ 以得到 $E(F_1 \\cup F_2)$。\n4.  $S_4 = F_1 \\cup F_3 = \\{1,2,5,6\\}$ 以得到 $E(F_1 \\cup F_3)$。\n\n对于每个测试案例 $(\\alpha, \\beta)$，我们将为这些子体系中的每一个数值构建哈密顿矩阵，计算它们的本征值，通过填充轨道确定总电子能量，并最终计算误差 $\\Delta E_{\\mathcal{F}_{2+2+2}}$。\n\n算法如下：\n1.  对于测试集中的每对 $(\\alpha, \\beta)$：\n2.  定义苯中的键集合：$\\{(1,2), (2,3), (3,4), (4,5), (5,6), (6,1)\\}$。\n3.  计算 $E_{\\mathrm{exact}} = E(\\{1,2,3,4,5,6\\})$。\n4.  计算 $E(F_1) = E(\\{1,2\\})$。\n5.  计算 $E(F_1 \\cup F_2) = E(\\{1,2,3,4\\})$。\n6.  计算 $E(F_1 \\cup F_3) = E(\\{1,2,5,6\\})$。\n7.  计算 $E_{\\mathrm{FMO2}}(\\mathcal{F}_{2+2+2}) = 2E(F_1 \\cup F_2) + E(F_1 \\cup F_3) - 3E(F_1)$。\n8.  计算误差 $\\Delta E_{\\mathcal{F}_{2+2+2}} = E_{\\mathrm{FMO2}}(\\mathcal{F}_{2+2+2}) - E_{\\mathrm{exact}}$。\n9.  误差 $\\Delta E_{\\mathcal{F}_{3+3}}$ 为 $0.0$。\n10. 存储这对误差，四舍五入到六位小数。\n11. 处理完所有测试案例后，将收集到的结果格式化为指定的输出字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_huckel_energy(atoms, alpha, beta):\n    \"\"\"\n    Calculates the Hückel molecular orbital energy for a given subsystem of benzene.\n\n    Args:\n        atoms (tuple): A tuple of 1-based atom indices in the subsystem.\n        alpha (float): The Coulomb parameter (on-site energy).\n        beta (float): The resonance integral (hopping parameter).\n\n    Returns:\n        float: The total electronic energy of the subsystem.\n    \"\"\"\n    n = len(atoms)\n    if n == 0:\n        return 0.0\n\n    # Define benzene bonds (1-based indexing)\n    bonds = {frozenset({1, 2}), frozenset({2, 3}), frozenset({3, 4}), \n             frozenset({4, 5}), frozenset({5, 6}), frozenset({6, 1})}\n\n    # Map 1-based atom indices to 0-based matrix indices\n    atom_map = {atom_idx: i for i, atom_idx in enumerate(atoms)}\n\n    # Build the Hückel Hamiltonian matrix\n    H = np.zeros((n, n))\n    for i in range(n):\n        for j in range(i, n):\n            atom1 = atoms[i]\n            atom2 = atoms[j]\n            if i == j:\n                H[i, j] = alpha\n            elif frozenset({atom1, atom2}) in bonds:\n                H[i, j] = H[j, i] = beta\n\n    # Calculate eigenvalues (molecular orbital energies)\n    # np.linalg.eigh returns sorted eigenvalues for Hermitian matrices\n    eigenvalues = np.linalg.eigh(H)[0]\n\n    # Fill orbitals with electrons (N_electrons = N_atoms)\n    num_electrons = n\n    num_pairs = num_electrons // 2\n    num_unpaired = num_electrons % 2\n    \n    total_energy = 0.0\n    # Add energy from doubly-occupied orbitals\n    total_energy += 2.0 * np.sum(eigenvalues[:num_pairs])\n    # Add energy from singly-occupied orbitals (if any)\n    if num_unpaired > 0:\n        total_energy += eigenvalues[num_pairs]\n\n    return total_energy\n\ndef solve():\n    \"\"\"\n    Solves the FMO problem for the given test cases.\n    \"\"\"\n    # Test suite: (alpha, beta) pairs in eV\n    test_cases = [\n        (0.0, -2.5),  # Case A\n        (1.0, 0.0),   # Case B\n        (0.5, 2.0),   # Case C\n    ]\n\n    all_results = []\n\n    # Define atom sets for required subsystems\n    all_atoms = tuple(range(1, 7))\n    F1_atoms = (1, 2)\n    F1F2_atoms = (1, 2, 3, 4)\n    F1F3_atoms = (1, 2, 5, 6)\n    \n    for alpha, beta in test_cases:\n        # 1. Calculate the exact energy of the full system\n        e_exact = calculate_huckel_energy(all_atoms, alpha, beta)\n\n        # 2. Calculate error for fragmentation F_2+2+2\n        # F_2+2+2 = {F1, F2, F3} where F1={1,2}, F2={3,4}, F3={5,6}\n        # E_fmo2 = E(F1 U F2) + E(F1 U F3) + E(F2 U F3) - E(F1) - E(F2) - E(F3)\n        # By symmetry: E(F1)=E(F2)=E(F3), E(F1 U F2) = E(F2 U F3)\n        # E_fmo2 = 2*E(F1 U F2) + E(F1 U F3) - 3*E(F1)\n        \n        e_f1 = calculate_huckel_energy(F1_atoms, alpha, beta)\n        e_f1f2 = calculate_huckel_energy(F1F2_atoms, alpha, beta)\n        e_f1f3 = calculate_huckel_energy(F1F3_atoms, alpha, beta)\n        \n        e_fmo2_222 = 2 * e_f1f2 + e_f1f3 - 3 * e_f1\n        delta_e_222 = e_fmo2_222 - e_exact\n\n        # 3. Calculate error for fragmentation F_3+3\n        # F_3+3 = {G1, G2} where G1={1,2,3}, G2={4,5,6}\n        # For M=2 fragments, E_fmo2 = E(G1 U G2) = E_exact.\n        # Thus, the error is always zero.\n        delta_e_333 = 0.0\n\n        all_results.append([delta_e_222, delta_e_333])\n\n    # Format the final output string exactly as specified.\n    inner_parts = [f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in all_results]\n    final_output = f\"[{','.join(inner_parts)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2464440"}, {"introduction": "FMO方法的核心之一是计算碎片对之间的相互作用能（Pair Interaction Energy, PIE）。为了深入理解这些相互作用的物理本质，本练习将模拟一个离子（作为第一个碎片）与一个水分子（作为第二个碎片）之间的相互作用。你将通过一个简化的经典模型，把总相互作用能分解为静电相互作用和诱导（极化）相互作用，这有助于建立对FMO方法所计算的驱动分子间识别和结合的关键物理力的直观认识。[@problem_id:2464489]", "problem": "您将实现一个完整的程序，该程序使用一种受碎片分子轨道（Fragment Molecular Orbital, FMO）方法启发的简化、第一性原理静电+诱导模型，计算并比较单个水分子与单原子离子之间的近似对相互作用能（Pair Interaction Energy, PIE）。在碎片分子轨道（FMO）方法中，两个碎片之间的对相互作用能（PIE）定义为，在使用与整个系统相同的哈密顿量的情况下，这两个碎片结合时发生的能量变化。在本问题中，您将计算 PIE 的一个经典近似值，该近似值是两个具有物理动机的项之和：离子与固定的水分子部分电荷之间的直接库仑相互作用，以及由于离子电场极化水分子而产生的诱导能。所需的所有量和单位均在下面指定。\n\n水分子的几何与电荷模型：\n- 将氧原子置于原点。水分子位于 $xz$ 平面内，H–O–H 角的角平分线沿 $+z$ 轴方向。\n- O–H 键长为 $0.9572~\\mathrm{\\AA}$。H–O–H 键角为 $104.52^\\circ$。\n- 令 $\\theta = 104.52^\\circ/2 = 52.26^\\circ$。氢原子的位置为\n  $$\n  \\mathbf{r}_{\\mathrm{H}_1} = \\bigl( \\, 0.9572\\sin\\theta,\\, 0,\\, 0.9572\\cos\\theta \\, \\bigr)~\\mathrm{\\AA}, \\quad\n  \\mathbf{r}_{\\mathrm{H}_2} = \\bigl( \\, -0.9572\\sin\\theta,\\, 0,\\, 0.9572\\cos\\theta \\, \\bigr)~\\mathrm{\\AA}.\n  $$\n- 水分子上的固定部分电荷（以基本电荷 $e$ 为单位）：氧原子上为 $q_{\\mathrm{O}}=-0.834\\,e$，每个氢原子上为 $q_{\\mathrm{H}}=+0.417\\,e$。\n\n离子模型与位置：\n- 考虑一个电荷为 $q_{\\mathrm{ion}}=\\pm 1\\,e$ 的单原子离子，位于 $+z$ 轴上，位置为 $\\mathbf{r}_{\\mathrm{ion}}=(0,0,R)$，其中 $R$ 以 $\\mathrm{\\AA}$ 为单位指定。对于锂阳离子 $\\mathrm{Li}^+$，使用 $q_{\\mathrm{ion}}=+1\\,e$；对于氟阴离子 $\\mathrm{F}^-$，使用 $q_{\\mathrm{ion}}=-1\\,e$。\n\n能量模型：\n- 总相互作用能建模为\n  $$\n  E_{\\mathrm{tot}}(R;q_{\\mathrm{ion}})=E_{\\mathrm{coul}}(R;q_{\\mathrm{ion}})+E_{\\mathrm{ind}}(R;q_{\\mathrm{ion}}),\n  $$\n  其中库仑项是离子与各原子位点之间成对相互作用的总和，诱导项是模拟离子电场对水的各向同性极化。\n- 库仑项：\n  $$\n  E_{\\mathrm{coul}}(R;q_{\\mathrm{ion}})=k_e \\sum_{a\\in\\{\\mathrm{O},\\mathrm{H}_1,\\mathrm{H}_2\\}} \\frac{q_{\\mathrm{ion}}\\, q_a}{\\|\\mathbf{r}_{\\mathrm{ion}}-\\mathbf{r}_a\\|},\n  $$\n  其中 $k_e=\\dfrac{1}{4\\pi\\varepsilon_0}=8.9875517923\\times 10^9~\\mathrm{N\\,m^2\\,C^{-2}}$。在计算 $E_{\\mathrm{coul}}$（单位为焦耳）之前，使用基本电荷大小 $e=1.602176634\\times 10^{-19}~\\mathrm{C}$ 将电荷 $q_{\\mathrm{ion}}$ 和 $q_a$ 转换为库仑，并使用 $1~\\mathrm{\\AA}=1.0\\times 10^{-10}~\\mathrm{m}$ 将所有距离从 $\\mathrm{\\AA}$ 转换为米。\n- 诱导项（各向同性，线性响应，以氧原子为中心）：\n  $$\n  E_{\\mathrm{ind}}(R;q_{\\mathrm{ion}})=-\\frac{1}{2}\\,\\alpha\\, \\|\\mathbf{E}_{\\mathrm{ion}\\to \\mathrm{O}}\\|^2,\n  $$\n  其中 $\\alpha$ 是水的各向同性分子极化率，$\\mathbf{E}_{\\mathrm{ion}\\to \\mathrm{O}}$ 是仅由离子在氧原子处产生的电场。视水分子仅在氧原子处可极化。距离 $R$ 处的点电荷 $q_{\\mathrm{ion}}$ 在氧原子处产生的电场大小为\n  $$\n  \\|\\mathbf{E}_{\\mathrm{ion}\\to \\mathrm{O}}\\|=\\frac{k_e\\,|q_{\\mathrm{ion}}|}{R^2},\n  $$\n  其中 $R$ 的单位是米，$q_{\\mathrm{ion}}$ 的单位是库仑。使用各向同性极化率 $\\alpha=1.45~\\mathrm{\\AA^3}$，并通过 $1~\\mathrm{\\AA^3}=1.64877727436\\times 10^{-41}~\\mathrm{C\\,m^2\\,V^{-1}}$ 将其转换为国际单位制（SI）。\n- 使用阿伏伽德罗常数 $N_{\\mathrm{A}}=6.02214076\\times 10^{23}~\\mathrm{mol^{-1}}$ 和 $1~\\mathrm{kJ}=10^3~\\mathrm{J}$，将最终能量从焦耳/分子转换为 $\\mathrm{kJ/mol}$。\n\n角度单位说明：\n- 三角函数使用弧度。给定的键角（单位为度）在需要时必须转换为弧度。电场和库仑表达式要求距离单位为米。\n\n测试组：\n- 对以下离子-氧原子间距 $R$ （单位为 $\\mathrm{\\AA}$）进行模型评估：$[\\,2.0,\\, 2.5,\\, 3.5,\\, 10.0\\,]$。对于每个 $R$，计算三个量，单位为 $\\mathrm{kJ/mol}$：\n  1. $\\mathrm{Li}^+$ 的 $E_{\\mathrm{tot}}(R;+1\\,e)$，\n  2. $\\mathrm{F}^-$ 的 $E_{\\mathrm{tot}}(R;-1\\,e)$，\n  3. $\\Delta E(R)=E_{\\mathrm{tot}}(R;+1\\,e)-E_{\\mathrm{tot}}(R;-1\\,e)$。\n- 所有报告的能量必须四舍五入到小数点后恰好 $6$ 位，并以 $\\mathrm{kJ/mol}$ 表示。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个类 JSON 格式的 Python 列表的列表，每个内部列表对应一个测试用例，顺序与测试组相同。每个内部列表必须按 $[E_{\\mathrm{tot}}(R;+1\\,e),\\,E_{\\mathrm{tot}}(R;-1\\,e),\\,\\Delta E(R)]$ 的顺序排列，每个浮点数四舍五入到小数点后恰好 $6$ 位。例如：$[[x_{1},y_{1},z_{1}],[x_{2},y_{2},z_{2}],\\dots]$。", "solution": "所提出的问题是计算物理和计算化学领域一个有效的练习。它在科学上是有根据的、适定的、客观的，并包含了唯一解所需的所有必要信息。它要求应用静电学的基本原理来模拟简化的离子-分子相互作用，这是开发和理解分子力学力场及量子化学碎片方法中的常见做法。我们将对求解过程进行严谨的推导。\n\n离子与水分子之间的总相互作用能 $E_{\\mathrm{tot}}$ 是库仑项 $E_{\\mathrm{coul}}$ 和诱导项 $E_{\\mathrm{ind}}$ 的和。我们将分别分析每个分量，确保所有量在计算时均以国际单位制（SI）表示，然后将最终能量转换为所要求的单位 $\\mathrm{kJ/mol}$。\n\n首先，我们确定基本常数和转换因子的 SI 形式：\n- 库仑常数：$k_e = 8.9875517923 \\times 10^9~\\mathrm{N\\,m^2\\,C^{-2}}$\n- 基本电荷：$e = 1.602176634 \\times 10^{-19}~\\mathrm{C}$\n- 阿伏伽德罗常数：$N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}~\\mathrm{mol^{-1}}$\n- 埃（Angstrom）到米的转换：$1~\\mathrm{\\AA} = 1.0 \\times 10^{-10}~\\mathrm{m}$\n- 极化率体积转换（$\\mathrm{\\AA^3}$ 到 SI）：$1~\\mathrm{\\AA^3} = 1.64877727436 \\times 10^{-41}~\\mathrm{C\\,m^2\\,V^{-1}}$\n\n接下来，我们确定水分子的几何结构。氧原子位于原点 $\\mathbf{r}_{\\mathrm{O}} = (0, 0, 0)$。O-H 键长为 $d_{\\mathrm{OH}} = 0.9572~\\mathrm{\\AA}$，H-O-H 键角为 $\\phi = 104.52^\\circ$。半角 $\\theta = \\phi/2 = 52.26^\\circ$ 必须转换为弧度以用于三角函数：$\\theta_{\\mathrm{rad}} = 52.26 \\cdot (\\pi / 180)$。氢原子的坐标则为：\n$z_{\\mathrm{H}} = d_{\\mathrm{OH}} \\cos(\\theta_{\\mathrm{rad}})$\n$x_{\\mathrm{H}} = d_{\\mathrm{OH}} \\sin(\\theta_{\\mathrm{rad}})$\n因此，$\\mathbf{r}_{\\mathrm{H}_1} = (x_{\\mathrm{H}}, 0, z_{\\mathrm{H}})$ 和 $\\mathbf{r}_{\\mathrm{H}_2} = (-x_{\\mathrm{H}}, 0, z_{\\mathrm{H}})$。\n离子位于 $\\mathbf{r}_{\\mathrm{ion}} = (0, 0, R)$。所有坐标最初都以埃为单位。\n\n**1. 库仑相互作用能 $E_{\\mathrm{coul}}$**\n\n库仑能是离子与水分子部分电荷之间成对相互作用的总和：\n$$\nE_{\\mathrm{coul}}(R; q_{\\mathrm{ion}}) = k_e \\sum_{a \\in \\{\\mathrm{O}, \\mathrm{H}_1, \\mathrm{H}_2\\}} \\frac{q_{\\mathrm{ion}} q_a}{\\|\\mathbf{r}_{\\mathrm{ion}} - \\mathbf{r}_a\\|}\n$$\n电荷 $q_{\\mathrm{ion}}$ 和 $q_a$ 以 $e$ 的倍数给出。设无量纲的电荷值为 $q'_{\\mathrm{ion}}$ 和 $q'_a$。实际电荷为 $q'_{\\mathrm{ion}}e$ 和 $q'_a e$。距离必须以米为单位。\n离子与水原子之间的距离为：\n- 离子-氧距离：$d_{\\mathrm{ion-O}} = \\|\\mathbf{r}_{\\mathrm{ion}} - \\mathbf{r}_{\\mathrm{O}}\\| = \\|(0,0,R) - (0,0,0)\\| = R$。\n- 离子-氢距离：根据对称性，离子到两个氢原子的距离相同。\n$$\nd_{\\mathrm{ion-H}} = \\|\\mathbf{r}_{\\mathrm{ion}} - \\mathbf{r}_{\\mathrm{H}_1}\\| = \\sqrt{(0 - x_{\\mathrm{H}})^2 + (0 - 0)^2 + (R - z_{\\mathrm{H}})^2} = \\sqrt{x_{\\mathrm{H}}^2 + (R - z_{\\mathrm{H}})^2}\n$$\n将这些代入能量表达式，距离单位为 $\\mathrm{\\AA}$，转换因子为 $10^{-10}~\\mathrm{m/\\AA}$：\n$$\nE_{\\mathrm{coul}} [\\mathrm{J}] = k_e \\frac{(q'_{\\mathrm{ion}}e)(q'_{\\mathrm{O}}e)}{R \\times 10^{-10}} + 2 \\cdot k_e \\frac{(q'_{\\mathrm{ion}}e)(q'_{\\mathrm{H}}e)}{d_{\\mathrm{ion-H}} \\times 10^{-10}}\n$$\n$$\nE_{\\mathrm{coul}} [\\mathrm{J}] = \\frac{k_e e^2}{10^{-10}} q'_{\\mathrm{ion}} \\left( \\frac{q'_{\\mathrm{O}}}{R} + \\frac{2q'_{\\mathrm{H}}}{d_{\\mathrm{ion-H}}} \\right)\n$$\n要将其转换为 $\\mathrm{kJ/mol}$，我们乘以 $N_{\\mathrm{A}}/1000$。预因子变为：\n$$\nC_{\\mathrm{coul}} = \\frac{k_e e^2 N_{\\mathrm{A}}}{10^{-10} \\times 1000} \\approx 1389.3546~\\mathrm{kJ \\cdot \\AA \\cdot mol^{-1}}\n$$\n因此，对于 $q'_{\\mathrm{ion}}=+1$，库仑能的实用公式为：\n$$\nE_{\\mathrm{coul}}(R; +1e) [\\mathrm{kJ/mol}] = C_{\\mathrm{coul}} \\left( \\frac{-0.834}{R} + \\frac{2 \\times 0.417}{\\sqrt{x_{\\mathrm{H}}^2 + (R - z_{\\mathrm{H}})^2}} \\right)\n$$\n注意 $E_{\\mathrm{coul}}(R; -1e) = -E_{\\mathrm{coul}}(R; +1e)$。\n\n**2. 诱导能 $E_{\\mathrm{ind}}$**\n\n诱导能源于离子电场对水分子的极化。其表达式为：\n$$\nE_{\\mathrm{ind}}(R; q_{\\mathrm{ion}}) = -\\frac{1}{2} \\alpha \\|\\mathbf{E}_{\\mathrm{ion}\\to\\mathrm{O}}\\|^2\n$$\n距离 $R$ 处的离子在氧原子核（原点）处产生的电场大小为：\n$$\n\\|\\mathbf{E}_{\\mathrm{ion}\\to\\mathrm{O}}\\| = \\frac{k_e |q_{\\mathrm{ion}}|}{(R \\times 10^{-10})^2} = \\frac{k_e |q'_{\\mathrm{ion}}| e}{(R \\times 10^{-10})^2}\n$$\n极化率 $\\alpha = 1.45~\\mathrm{\\AA^3}$ 必须转换为 SI 单位：$\\alpha_{\\mathrm{SI}} = 1.45 \\times (1.64877727436 \\times 10^{-41})~\\mathrm{C\\,m^2\\,V^{-1}}$。\n将这些代入诱导能公式（其中 $|q'_{\\mathrm{ion}}|=1$）：\n$$\nE_{\\mathrm{ind}} [\\mathrm{J}] = -\\frac{1}{2} \\alpha_{\\mathrm{SI}} \\left( \\frac{k_e e}{R^2 \\times (10^{-10})^2} \\right)^2 = -\\frac{1}{2} \\frac{\\alpha_{\\mathrm{SI}} (k_e e)^2}{(10^{-10})^4} \\frac{1}{R^4}\n$$\n其中 $R$ 的单位是埃。要转换为 $\\mathrm{kJ/mol}$，我们再次乘以 $N_{\\mathrm{A}}/1000$：\n$$\nC_{\\mathrm{ind}} = \\frac{1}{2} \\frac{\\alpha_{\\mathrm{SI}} (k_e e)^2 N_{\\mathrm{A}}}{(10^{-10})^4 \\times 1000} = \\frac{1}{2} \\frac{(1.45 \\times 1.648... \\times 10^{-41}) (k_e e)^2 N_{\\mathrm{A}}}{10^{-40} \\times 1000} \\approx 149.2868~\\mathrm{kJ \\cdot \\AA^4 \\cdot mol^{-1}}\n$$\n因此，诱导能的实用公式为：\n$$\nE_{\\mathrm{ind}} [\\mathrm{kJ/mol}] = - \\frac{C_{\\mathrm{ind}}}{R^4}\n$$\n该项与离子电荷的符号无关，因为它取决于 $|q_{\\mathrm{ion}}|^2$。\n\n**3. 总能量和差异项**\n\n对于测试组中的每个距离 $R$，我们计算所需的量：\n1.  对于 $\\mathrm{Li}^+$ ($q'_{\\mathrm{ion}}=+1$)：\n    $E_{\\mathrm{tot}}(R;+1e) = E_{\\mathrm{coul}}(R;+1e) + E_{\\mathrm{ind}}(R)$\n2.  对于 $\\mathrm{F}^-$ ($q'_{\\mathrm{ion}}=-1$)：\n    $E_{\\mathrm{tot}}(R;-1e) = E_{\\mathrm{coul}}(R;-1e) + E_{\\mathrm{ind}}(R) = -E_{\\mathrm{coul}}(R;+1e) + E_{\\mathrm{ind}}(R)$\n3.  差异项：\n    $\\Delta E(R) = E_{\\mathrm{tot}}(R;+1e) - E_{\\mathrm{tot}}(R;-1e)$\n    $\\Delta E(R) = (E_{\\mathrm{coul}}(R;+1e) + E_{\\mathrm{ind}}(R)) - (-E_{\\mathrm{coul}}(R;+1e) + E_{\\mathrm{ind}}(R))$\n    $\\Delta E(R) = 2 \\cdot E_{\\mathrm{coul}}(R;+1e)$\n\n这表明相互作用能的不对称性完全是由水分子的固定、不对称电荷分布引起的，因为诱导项相对于离子电荷的符号是对称的。\n\n计算过程如下：\n- 定义所有常数和转换因子。\n- 预先计算水分子的几何参数 ($x_H, z_H$)。\n- 对每个指定的距离 $R$ 进行迭代。\n- 对于每个 $R$，使用推导出的实用公式计算 $E_{\\mathrm{coul}}(R;+1e)$ 和 $E_{\\mathrm{ind}}(R)$（单位为 $\\mathrm{kJ/mol}$）。\n- 结合这些来计算 $E_{\\mathrm{tot}}(R;+1e)$、$E_{\\mathrm{tot}}(R;-1e)$ 和 $\\Delta E(R)$。\n- 将这三个值中的每一个都四舍五入到小数点后六位。\n- 存储结果并按规定格式化最终输出。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares an approximate Pair Interaction Energy (PIE)\n    between a water molecule and a monatomic ion (Li+ or F-).\n    \"\"\"\n\n    # --- Constants and Conversion Factors (SI units) ---\n    K_E = 8.9875517923e9  # Coulomb's constant (N m^2 C^-2)\n    E_CHARGE = 1.602176634e-19  # Elementary charge (C)\n    N_A = 6.02214076e23  # Avogadro constant (mol^-1)\n    \n    # Conversion factors\n    ANGSTROM_TO_METER = 1.0e-10\n    ANGSTROM3_TO_SI_POL = 1.64877727436e-41 # (C m^2 V^-1) / A^3\n    JOULE_TO_KJ_MOL = N_A / 1000.0\n\n    # --- Problem-Specific Parameters ---\n    # Water geometry\n    D_OH = 0.9572  # O-H bond length (Angstrom)\n    THETA_HOH_DEG = 104.52  # H-O-H bond angle (degrees)\n\n    # Water partial charges (in units of elementary charge e)\n    Q_O = -0.834\n    Q_H = 0.417\n\n    # Water polarizability\n    ALPHA_WATER_A3 = 1.45 # (Angstrom^3)\n\n    # Ion charges (in units of elementary charge e)\n    Q_ION_LI = 1.0\n    Q_ION_F = -1.0\n    \n    # Test suite of ion-oxygen separations (Angstrom)\n    R_VALUES = [2.0, 2.5, 3.5, 10.0]\n\n    # --- Pre-calculations ---\n    \n    # Water atom coordinates (Angstroms)\n    theta_rad = np.deg2rad(THETA_HOH_DEG / 2.0)\n    z_h = D_OH * np.cos(theta_rad)\n    x_h = D_OH * np.sin(theta_rad)\n\n    # Prefactor for Coulomb energy calculation, converting from (e^2/Angstrom) to (kJ/mol)\n    # C_coul = (k_e * e^2) / (angstrom_to_meter) * (N_A / 1000)\n    coulomb_prefactor = (K_E * E_CHARGE**2 / ANGSTROM_TO_METER) * JOULE_TO_KJ_MOL\n\n    # Prefactor for induction energy, converting from (A^3 / A^4) to (kJ/mol)\n    # C_ind = 0.5 * (alpha_A3*conv_pol) * (k_e*e)^2 / (angstrom_to_meter)^4 * (N_A/1000)\n    # C_ind = 0.5 * alpha_A3 * [conv_pol * (k_e*e)^2 * N_A / (angstrom^4 * 1000)]\n    induction_prefactor = (0.5 * ALPHA_WATER_A3 * ANGSTROM3_TO_SI_POL * \n                           (K_E * E_CHARGE)**2 / (ANGSTROM_TO_METER**4) * \n                           JOULE_TO_KJ_MOL)\n                           \n    results = []\n    \n    # --- Main Calculation Loop ---\n    for R in R_VALUES:\n        # Distance between ion and hydrogen atoms (Angstrom)\n        d_ion_h = np.sqrt(x_h**2 + (R - z_h)**2)\n        \n        # --- 1. Coulomb Energy Calculation ---\n        # Calculate for a +1e charge (Li+)\n        # E_coul = C_coul * q_ion * (q_O/d_O + 2*q_H/d_H)\n        e_coul_pos_kjmol = coulomb_prefactor * Q_ION_LI * (\n            Q_O / R + 2 * Q_H / d_ion_h\n        )\n\n        # --- 2. Induction Energy Calculation ---\n        # The induction energy is proportional to q_ion^2, so it's the same\n        # for Li+ and F- (|q_ion|=1). The formula is E_ind = -C_ind / R^4.\n        e_ind_kjmol = -induction_prefactor / (R**4)\n\n        # --- 3. Total Energies and Difference ---\n        # Energy for Li+ (q_ion = +1)\n        e_tot_li = e_coul_pos_kjmol + e_ind_kjmol\n        \n        # Energy for F- (q_ion = -1)\n        # E_coul for -1 charge is -E_coul for +1 charge.\n        e_tot_f = -e_coul_pos_kjmol + e_ind_kjmol\n\n        # Difference E(Li+) - E(F-)\n        delta_e = e_tot_li - e_tot_f\n        # An equivalent and more direct calculation: delta_e = 2 * e_coul_pos_kjmol\n        \n        # Round results to 6 decimal places and store\n        results.append([\n            round(e_tot_li, 6),\n            round(e_tot_f, 6),\n            round(delta_e, 6)\n        ])\n\n    # --- Final Output Formatting ---\n    # Manually format the list of lists to match the required output string\n    # e.g., \"[[x1,y1,z1],[x2,y2,z2]]\"\n    output_str = '[' + ','.join(map(str, results)) + ']'\n    print(output_str)\n\nsolve()\n```", "id": "2464489"}, {"introduction": "任何计算方法都有其固有的近似，理解这些近似的来源和影响对于批判性地使用该方法至关重要。FMO方法最主要的近似在于截断了多体展开，通常只考虑至两体（成对）的相互作用。本练习通过一个描述化学反应路径的简化解析模型，让你能够精确量化因忽略三体效应而导致的反应能垒计算误差，从而深刻理解FMO方法在描述协同学效应时的局限性。[@problem_id:2464438]", "problem": "您将获得一个简化的自洽模型，用于量化当反应坐标横跨两个碎片时，由碎片分子轨道 (FMO) 方法引入的能量误差。考虑一个一维无量纲的反应进程变量 $s$，它沿着一条穿过过渡态的反应路径，同时扰动两个标记为 $A$ 和 $B$ 的碎片。沿此路径的精确 Born–Oppenheimer 电子能量定义为\n$$\nE_{\\text{exact}}(s) \\;=\\; E_A(s) \\;+\\; E_B(s) \\;+\\; E_{\\text{pair}}(s) \\;+\\; E_{\\text{3body}}(s),\n$$\n其分量为\n$$\nE_A(s) \\;=\\; a_A s^2 \\;+\\; c_A s^4,\\quad\nE_B(s) \\;=\\; a_B s^2 \\;+\\; c_B s^4,\\quad\nE_{\\text{pair}}(s) \\;=\\; J s^2,\\quad\nE_{\\text{3body}}(s) \\;=\\; C_3 s^4.\n$$\n此处，$a_A$、$a_B$、$c_A$、$c_B$、$J$ 和 $C_3$ 是以哈特里 (hartree) 为单位的实常数，它们分别参数化了碎片刚度、对耦合以及一个协同的三体稳定或不稳定项。在对 (二体) 截断水平上的碎片分子轨道 (FMO) 能量建模为\n$$\nE_{\\text{FMO2}}(s) \\;=\\; E_A(s) \\;+\\; E_B(s) \\;+\\; E_{\\text{pair}}(s),\n$$\n该模型有意省略了三体项 $E_{\\text{3body}}(s)$，以便在一个最小化的设定中分离出被忽略的多体效应的影响。\n\n将能量函数 $E(s)$ 在闭区间 $s \\in [-S,S]$（其中 $S=2$）上的能垒高度定义为：对应于过渡态区域的局部最大值点 $s^\\ddagger \\in [-S,S]$ 处的能量值，与 $s^\\ddagger$ 任意一侧相邻的能量较低的局部最小值点 $s_{\\min} \\in [-S,S]$ 处的能量值之差。所有能量必须以哈特里 (hartree) 报告。本问题不涉及角度。\n\n对于下方测试套件中的每个参数集，计算能垒高度的带符号误差，\n$$\n\\Delta \\;=\\; \\Delta E_{\\text{FMO2}} \\;-\\; \\Delta E_{\\text{exact}},\n$$\n以哈特里 (hartree) 表示。将每个 $\\Delta$ 报告为一个四舍五入到十位小数的十进制数。\n\n测试套件（每个元组为 $(a_A, a_B, c_A, c_B, J, C_3)$，单位均为哈特里）：\n- 案例 1：$(-0.10,\\,-0.05,\\,0.30,\\,0.25,\\,0.02,\\,0.10)$\n- 案例 2：$(-0.10,\\,-0.05,\\,0.30,\\,0.25,\\,0.02,\\,0.00)$\n- 案例 3：$(-0.005,\\,-0.005,\\,0.10,\\,0.10,\\,0.0,\\,0.05)$\n- 案例 4：$(-0.20,\\,-0.15,\\,0.40,\\,0.40,\\,0.05,\\,0.50)$\n- 案例 5：$(-0.12,\\,-0.08,\\,0.22,\\,0.28,\\,0.04,\\,-0.06)$\n\n您的程序应生成单行输出，其中按顺序包含案例 1 到 5 的结果，格式为用方括号括起来的逗号分隔列表，例如 $[x_1,x_2,x_3,x_4,x_5]$，其中每个 $x_i$ 是按上述规定四舍五入后的 $\\Delta$ 值（以哈特里为单位）。不应产生任何其他输出。", "solution": "在尝试求解之前，需对问题陈述进行验证。\n\n首先，逐字提取所有给定条件。\n精确的电子能量由下式给出：\n$$\nE_{\\text{exact}}(s) \\;=\\; E_A(s) \\;+\\; E_B(s) \\;+\\; E_{\\text{pair}}(s) \\;+\\; E_{\\text{3body}}(s)\n$$\n其分量为：\n$$\nE_A(s) \\;=\\; a_A s^2 \\;+\\; c_A s^4\n$$\n$$\nE_B(s) \\;=\\; a_B s^2 \\;+\\; c_B s^4\n$$\n$$\nE_{\\text{pair}}(s) \\;=\\; J s^2\n$$\n$$\nE_{\\text{3body}}(s) \\;=\\; C_3 s^4\n$$\n二体水平的碎片分子轨道 (FMO) 能量为：\n$$\nE_{\\text{FMO2}}(s) \\;=\\; E_A(s) \\;+\\; E_B(s) \\;+\\; E_{\\text{pair}}(s)\n$$\n参数 $a_A, a_B, c_A, c_B, J, C_3$ 是实常数。反应进程变量 $s$ 定义在区间 $s \\in [-S,S]$ 上，其中 $S=2$。\n能垒高度 $\\Delta E$ 定义为局部最大值点 $s^\\ddagger$ (过渡态) 与相邻的局部最小值点 $s_{\\min}$ 之间的能量差。\n需要计算的量是能垒高度的带符号误差：\n$$\n\\Delta \\;=\\; \\Delta E_{\\text{FMO2}} \\;-\\; \\Delta E_{\\text{exact}}\n$$\n为六元组 $(a_A, a_B, c_A, c_B, J, C_3)$ 提供了测试案例。\n\n对问题进行有效性评估。该问题具有科学依据，采用了一个简化的多项式势能面，这是理论化学中的一个标准教学工具。该模型正确地表示了 FMO 方法对多体效应的截断。问题提法得当，提供了所有必要的数学定义和参数。语言客观且无歧义。该问题自洽、一致且可形式化。未发现任何缺陷。结论是该问题 **有效**。我们继续进行求解。\n\n分析始于构建显式的能量函数。通过代入各分量的定义，我们得到：\n$$\nE_{\\text{exact}}(s) = (a_A + a_B + J)s^2 + (c_A + c_B + C_3)s^4\n$$\n$$\nE_{\\text{FMO2}}(s) = (a_A + a_B + J)s^2 + (c_A + c_B)s^4\n$$\n两个函数都具有 $E(s) = as^2 + cs^4$ 的一般形式。\n我们为每个模型定义系数：\n对于精确模型：$a_{\\text{exact}} = a_A + a_B + J$ 且 $c_{\\text{exact}} = c_A + c_B + C_3$。\n对于 FMO2 模型：$a_{\\text{FMO2}} = a_A + a_B + J$ 且 $c_{\\text{FMO2}} = c_A + c_B$。\n显然 $a_{\\text{exact}} = a_{\\text{FMO2}}$。我们将这个共同的系数记为 $a$。四次项系数是不同的：$c_{\\text{exact}} = c_{\\text{FMO2}} + C_3$。\n\n为求得能垒高度，我们必须确定过渡态 ($s^\\ddagger$) 和极小值点 ($s_{\\min}$) 的位置。这些是函数 $E(s)$ 的临界点，可通过求解 $\\frac{dE}{ds}=0$ 找到。\n$$\n\\frac{dE}{ds} = \\frac{d}{ds}(as^2 + cs^4) = 2as + 4cs^3 = 2s(a + 2cs^2)\n$$\n令导数为零可得到临界点 $s^*$：\n$s^* = 0$\n$a + 2c(s^*)^2 = 0 \\implies s^* = \\pm\\sqrt{-\\frac{a}{2c}}$\n\n这些点的性质由二阶导数 $\\frac{d^2E}{ds^2}$ 决定：\n$$\n\\frac{d^2E}{ds^2} = 2a + 12cs^2\n$$\n带有过渡态的反应路径意味着一个双阱势，这在 $a < 0$ 和 $c > 0$ 时出现。\n在 $s^*=0$ 处，$\\frac{d^2E}{ds^2}\\Big|_{s=0} = 2a$。对于 $a < 0$，该值为负，表示一个局部极大值。因此，过渡态位于 $s^\\ddagger = 0$。\n在 $s^*=\\pm\\sqrt{-a/(2c)}$ 处，$\\frac{d^2E}{ds^2}\\Big|_{s=\\pm\\sqrt{-a/(2c)}} = 2a + 12c\\left(-\\frac{a}{2c}\\right) = 2a - 6a = -4a$。对于 $a < 0$，该值为正，表示局部极小值。因此，$s_{\\min} = \\pm\\sqrt{-a/(2c)}$。\n\n对所有提供的测试案例的检查证实，它们的构造使得 $a = a_A+a_B+J < 0$，并且 $c_{\\text{FMO2}} = c_A+c_B > 0$ 与 $c_{\\text{exact}} = c_A+c_B+C_3 > 0$ 同时成立。这保证了对于精确模型和 FMO2 模型，都存在一个过渡态在 $s=0$ 的双阱势。此外，对于所有案例，计算出的极小值点 $|s_{\\min}|$ 都小于 $S=2$，因此极值点位于指定的区间 $[-2, 2]$ 内。\n\n能垒高度 $\\Delta E$ 计算为 $\\Delta E = E(s^\\ddagger) - E(s_{\\min})$。\n过渡态的能量是 $E(s^\\ddagger) = E(0) = a(0)^2 + c(0)^4 = 0$。\n极小值点的能量是：\n$$\nE(s_{\\min}) = a\\left(-\\frac{a}{2c}\\right) + c\\left(-\\frac{a}{2c}\\right)^2 = -\\frac{a^2}{2c} + \\frac{a^2}{4c} = -\\frac{a^2}{4c}\n$$\n因此，对于任何形式为 $E(s) = as^2 + cs^4$（其中 $a<0, c>0$）的势，其能垒高度为：\n$$\n\\Delta E = E(0) - E(s_{\\min}) = 0 - \\left(-\\frac{a^2}{4c}\\right) = \\frac{a^2}{4c}\n$$\n现在，我们将此一般性结果应用于我们的特定模型。\n精确能垒高度为：\n$$\n\\Delta E_{\\text{exact}} = \\frac{a^2}{4c_{\\text{exact}}} = \\frac{(a_A+a_B+J)^2}{4(c_A+c_B+C_3)}\n$$\nFMO2 能垒高度为：\n$$\n\\Delta E_{\\text{FMO2}} = \\frac{a^2}{4c_{\\text{FMO2}}} = \\frac{(a_A+a_B+J)^2}{4(c_A+c_B)}\n$$\n带符号误差 $\\Delta$ 是这两个量之差：\n$$\n\\Delta = \\Delta E_{\\text{FMO2}} - \\Delta E_{\\text{exact}} = \\frac{a^2}{4c_{\\text{FMO2}}} - \\frac{a^2}{4c_{\\text{exact}}}\n$$\n$$\n\\Delta = \\frac{a^2}{4} \\left( \\frac{1}{c_{\\text{FMO2}}} - \\frac{1}{c_{\\text{exact}}} \\right) = \\frac{a^2}{4} \\left( \\frac{c_{\\text{exact}} - c_{\\text{FMO2}}}{c_{\\text{FMO2}} \\cdot c_{\\text{exact}}} \\right)\n$$\n由于 $c_{\\text{exact}} - c_{\\text{FMO2}} = (c_A+c_B+C_3) - (c_A+c_B) = C_3$，我们得到了误差的最终解析表达式：\n$$\n\\Delta = \\frac{a^2 C_3}{4 \\cdot c_{\\text{FMO2}} \\cdot c_{\\text{exact}}} = \\frac{(a_A+a_B+J)^2 C_3}{4(c_A+c_B)(c_A+c_B+C_3)}\n$$\n这个简洁的公式可以直接从输入参数计算能垒高度的误差。如果 $C_3=0$，误差 $\\Delta$ 被正确地预测为 $0$。计算任务是为每个测试案例评估此表达式，并报告四舍五入到十位小数的结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the signed error in the reaction barrier height between a simplified\n    FMO2 model and an exact model for a set of given parameters.\n    \"\"\"\n    \n    # Test suite: each tuple is (a_A, a_B, c_A, c_B, J, C_3) in hartree.\n    test_cases = [\n        (-0.10, -0.05, 0.30, 0.25, 0.02, 0.10),  # Case 1\n        (-0.10, -0.05, 0.30, 0.25, 0.02, 0.00),  # Case 2\n        (-0.005, -0.005, 0.10, 0.10, 0.0, 0.05),  # Case 3\n        (-0.20, -0.15, 0.40, 0.40, 0.05, 0.50),  # Case 4\n        (-0.12, -0.08, 0.22, 0.28, 0.04, -0.06), # Case 5\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        a_A, a_B, c_A, c_B, J, C_3 = case\n\n        # The energy functions are of the form E(s) = a*s^2 + c*s^4.\n        # The common quadratic coefficient is a = a_A + a_B + J.\n        a = a_A + a_B + J\n\n        # The quartic coefficient for the FMO2 model.\n        c_fmo2 = c_A + c_B\n        \n        # The quartic coefficient for the exact model.\n        c_exact = c_A + c_B + C_3\n\n        # The barrier height for a potential E(s) = a*s^2 + c*s^4 (with a<0, c>0)\n        # is given by Delta_E = a^2 / (4*c).\n        # The error in barrier height is Delta = Delta_E_FMO2 - Delta_E_exact.\n        # Delta = a^2/(4*c_fmo2) - a^2/(4*c_exact)\n        # A simplified analytical formula for the error is:\n        # Delta = (a^2 * C_3) / (4 * c_fmo2 * c_exact)\n\n        # A direct check for C_3 = 0 makes the logic explicit.\n        if C_3 == 0.0:\n            delta_error = 0.0\n        else:\n            # Check for physically meaningful potentials (required for the\n            # derived barrier height formula to be valid).\n            # All test cases satisfy a < 0, c_fmo2 > 0, and c_exact > 0.\n            # No division by zero is possible with the given test cases.\n            delta_error = (a**2 * C_3) / (4 * c_fmo2 * c_exact)\n\n        # Format the result as a string rounded to ten decimal places.\n        # The format specifier \"{:.10f}\" handles rounding correctly.\n        results.append(f\"{delta_error:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2464438"}]}