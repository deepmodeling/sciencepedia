{"hands_on_practices": [{"introduction": "首先，我们来探索化学反应最基本的方面：当反应物相互靠近并形成产物时势能的变化。本练习模拟了两个甲基自由基的重组反应，这是一个没有内在能垒的反应，使我们能够专注于从势能面推导出的反应能 ($\\Delta E_{\\text{rxn}}$) 和活化能 ($E_a$) 的核心定义 [@problem_id:2451411]。通过同时考虑成功反应的几何要求，您将看到熵因素如何对总的自由能垒 ($\\Delta G^{\\ddagger}_{\\text{orient}}$) 做出贡献，这是过渡态理论中的一个关键概念。", "problem": "考虑在玻恩–奥本海默近似和正则系综下，两个甲基自由基重组形成乙烷的过程。将反应坐标模拟为沿一维势能面的碳间距离 $r$，该势能面描述了单个碳-碳σ键的形成。假设相互作用可以用一个成键势来表示，该势在 $r = r_e$ 处有一个束缚态最小值，并在 $r \\to \\infty$ 处有一条对应于分离的自由基的渐近线。您的任务是根据第一性原理和定义，计算活化能垒和反应能（两者均为来自势能面的焓量），并另外计算由于只有一小部分相对取向具有反应性而产生的对标准态吉布斯自由能垒的取向门控贡献。\n\n使用以下基本出发点：\n- 玻恩–奥本海默势能面将电子能量 $V(r)$ 定义为核构型 $r$ 的函数，经典活化能垒是沿从反应物到产物的最小能量路径上 $V(r)$ 相对于反应物渐近线的最大值。\n- 亥姆霍兹自由能 $A = -k_B T \\ln Z$ 的正则系综定义，标准条件下当忽略沿一维坐标的固定体积变化时吉布斯自由能 $G$ 与 $A$ 的关系，以及熵与可及微观态之间的统计力学联系。\n- 标准摩尔气体常数 $R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$ 和阿伏伽德罗常数 $N_A = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n\n实现以下建模和计算步骤：\n1. 使用一个具有参数 $(D_e, a, r_e)$ 的平滑单阱成键势，该势在 $r \\to \\infty$ 时趋于 $0$，在 $r = r_e$ 处有最小值为 $-D_e$。将 $r$ 从 $r_{\\max}$ 到 $r_e$ 在一个均匀网格上离散化，以表示从分离的自由基接近到成键最小值的过程。使用 $r_{\\max} = 5.000\\ \\mathrm{\\AA}$ 和网格间距 $\\Delta r = 0.001\\ \\mathrm{\\AA}$。确保使用 $V(r_{\\max})$ 来定义反应物渐近线。\n2. 将活化能 $E_a$（一个焓垒）定义为沿接近路径上相对于渐近线的最大能量，即 $V(r) - V(r_{\\max})$ 在 $r \\in [r_e, r_{\\max}]$ 上的最大值，以 $\\mathrm{kJ\\ mol^{-1}}$ 表示。如果在数值容差范围内最大值为非正数，则报告 $E_a = 0$。\n3. 将反应能 $\\Delta E_{\\mathrm{rxn}}$ 定义为 $V(r_e) - V(r_{\\max})$，以 $\\mathrm{kJ\\ mol^{-1}}$ 表示。\n4. 假设在相遇时，只有一小部分 $f$ 的自由基间相对取向是具有反应性的，而所有其他自由度则处于平衡状态。使用正则统计力学以及熵与可及微观态数之间的关系，推导并计算标准态取向门控对吉布斯自由能垒的贡献 $\\Delta G^{\\ddagger}_{\\mathrm{orient}}$，作为 $f$ 和温度 $T$ 的函数，以 $\\mathrm{kJ\\ mol^{-1}}$ 表示。使用上面给出的 $R$ 并进行一致的单位转换。\n\n测试套件：\n对于以下每一组参数，计算并返回三元组 $[E_a,\\ \\Delta G^{\\ddagger}_{\\mathrm{orient}},\\ \\Delta E_{\\mathrm{rxn}}]$，所有值均以 $\\mathrm{kJ\\ mol^{-1}}$ 为单位，并四舍五入到三位小数。\n- 情况1（理想情况，无取向限制）：$D_e = 368.000\\ \\mathrm{kJ\\ mol^{-1}}$，$a = 1.800\\ \\mathrm{\\AA^{-1}}$，$r_e = 1.540\\ \\mathrm{\\AA}$，$T = 298.000\\ \\mathrm{K}$，$f = 1.000$。\n- 情况2（环境温度下的中等取向门控）：$D_e = 368.000\\ \\mathrm{kJ\\ mol^{-1}}$，$a = 1.800\\ \\mathrm{\\AA^{-1}}$，$r_e = 1.540\\ \\mathrm{\\AA}$，$T = 298.000\\ \\mathrm{K}$，$f = 1.000 \\times 10^{-3}$。\n- 情况3（高温下的较强取向门控）：$D_e = 368.000\\ \\mathrm{kJ\\ mol^{-1}}$，$a = 1.800\\ \\mathrm{\\AA^{-1}}$，$r_e = 1.540\\ \\mathrm{\\AA}$，$T = 500.000\\ \\mathrm{K}$，$f = 1.000 \\times 10^{-4}$。\n- 情况4（方法依赖的欠束缚和严重取向门控）：$D_e = 350.000\\ \\mathrm{kJ\\ mol^{-1}}$，$a = 1.800\\ \\mathrm{\\AA^{-1}}$，$r_e = 1.540\\ \\mathrm{\\AA}$，$T = 298.000\\ \\mathrm{K}$，$f = 1.000 \\times 10^{-6}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个列表的列表形式的结果，每个内部列表对应上述一种情况，并按相同顺序包含三个浮点值 $[E_a,\\ \\Delta G^{\\ddagger}_{\\mathrm{orient}},\\ \\Delta E_{\\mathrm{rxn}}]$，单位为 $\\mathrm{kJ\\ mol^{-1}}$，四舍五入到三位小数。例如，整体结构必须类似于 $[[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],\\dots]$，不含额外文本。", "solution": "该问题陈述已经过严格审查，并被确定为有效。它具有科学依据，问题定义明确，并且在计算上是可行的。关于势能面 $V(r)$ 的显式函数形式存在一个小的歧义。然而，所提供的参数 $(D_e, a, r_e)$ 和指定的物理性质（在 $r=r_e$ 处有 $-D_e$ 的单最小值以及渐近线 $V(\\infty) \\to 0$）是莫尔斯势的定义特征。因此，选择莫尔斯势是将问题形式化的一个合理且必要的步骤，这是该领域任何合格的从业者都应采取的步骤。\n\n解决方案按规定分三部分进行：计算焓垒 $E_a$、反应能 $\\Delta E_{\\mathrm{rxn}}$ 以及取向门控对吉布斯自由能的贡献 $\\Delta G^{\\ddagger}_{\\mathrm{orient}}$。\n\n**1. 势能面和模型参数**\n\n两个甲基自由基沿分离坐标 $r$ 的相互作用使用莫尔斯势函数进行建模：\n$$V(r) = D_e \\left[ (1 - e^{-a(r-r_e)})^2 - 1 \\right]$$\n其中 $D_e$ 是键解离能，$r_e$ 是平衡键长，$a$ 控制势阱的宽度。此函数正确地满足边界条件 $V(r_e) = -D_e$ 和 $V(r \\to \\infty) = 0$。反应物，即分离的自由基，被定义为处于碳间距离 $r_{\\max} = 5.000\\ \\mathrm{\\AA}$。因此，这个反应物态的能量（定义了反应的渐近线）是 $V_{\\mathrm{reactants}} = V(r_{\\max})$。\n\n所需的常数是：\n- 摩尔气体常数：$R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$\n\n**2. 焓量计算：$E_a$ 和 $\\Delta E_{\\mathrm{rxn}}$**\n\n活化能 $E_a$ 定义为沿从 $r = r_{\\max}$ 到 $r = r_e$ 的反应路径上，势能相对于反应物态的最大值。\n$$E_a = \\max_{r \\in [r_e, r_{\\max}]} (V(r)) - V(r_{\\max})$$\n为了在区间 $[r_e, r_{\\max}]$ 上找到 $V(r)$ 的最大值，我们考察其导数：\n$$V'(r) = \\frac{dV}{dr} = 2aD_e e^{-a(r-r_e)} (1 - e^{-a(r-r_e)})$$\n对于 $r > r_e$，$r-r_e > 0$。由于 $a$ 和 $D_e$ 是正常数，因此 $e^{-a(r-r_e)}$ 介于 $0$ 和 $1$ 之间。所以，$e^{-a(r-r_e)}$ 和 $(1 - e^{-a(r-r_e)})$ 均为正值。因此，对于所有 $r > r_e$，$V'(r) > 0$。这证明了对于 $r > r_e$，莫尔斯势是单调递增的。因此，在区间 $[r_e, r_{\\max}]$上 $V(r)$ 的最大值必定出现在上边界 $r = r_{\\max}$ 处。\n\n将此代入 $E_a$ 的定义中：\n$$E_a = V(r_{\\max}) - V(r_{\\max}) = 0$$\n此结果是自由基重组反应的典型特征，这类反应通常在热力学上是下坡的，没有势能垒。问题陈述正确地预见到了这种可能性，规定如果能垒为非正数，则应报告为 $0$。这一解析结果避免了在离散的 $r$ 值网格上进行数值搜索的需要。\n\n反应能 $\\Delta E_{\\mathrm{rxn}}$ 是产物态（乙烷，在 $r=r_e$）和反应物态（分离的自由基，在 $r=r_{\\max}$）之间的能量差。\n$$\\Delta E_{\\mathrm{rxn}} = V(r_e) - V(r_{\\max})$$\n利用莫尔斯势的性质 $V(r_e) = -D_e$，我们有：\n$$\\Delta E_{\\mathrm{rxn}} = -D_e - V(r_{\\max}) = -D_e - D_e \\left[ (1 - e^{-a(r_{\\max}-r_e)})^2 - 1 \\right]$$\n$D_e$ 的单位是 $\\mathrm{kJ\\ mol^{-1}}$，所以 $\\Delta E_{\\mathrm{rxn}}$ 的单位也将是 $\\mathrm{kJ\\ mol^{-1}}$。\n\n**3. 取向门控自由能的推导：$\\Delta G^{\\ddagger}_{\\mathrm{orient}}$**\n\n“取向门控”是一种熵效应。问题规定，只有一小部分 $f$ 的自由基相对取向是具有反应性的。这构成了对过渡态与分离的反应物相比，可及微观态数量的约束。\n\n根据玻尔兹曼原理，熵 $S$ 与可及微观态数 $\\Omega$ 的关系为 $S = k_B \\ln \\Omega$，其中 $k_B$ 是玻尔兹曼常数。\n令 $\\Omega_{\\mathrm{reactants}}$ 为分离的反应物可用的总取向微观态数。\n令 $\\Omega_{\\mathrm{TS}}$ 为过渡态时可导致反应的取向微观态数。\n根据问题定义，我们有关系式 $\\Omega_{\\mathrm{TS}} = f \\cdot \\Omega_{\\mathrm{reactants}}$。\n\n从反应物态到过渡态的取向熵变为：\n$$\\Delta S^{\\ddagger}_{\\mathrm{orient}} = S_{\\mathrm{TS}} - S_{\\mathrm{reactants}} = k_B \\ln \\Omega_{\\mathrm{TS}} - k_B \\ln \\Omega_{\\mathrm{reactants}} = k_B \\ln\\left(\\frac{\\Omega_{\\mathrm{TS}}}{\\Omega_{\\mathrm{reactants}}}\\right) = k_B \\ln f$$\n这是每个事件（每对重组自由基）的熵变。对于摩尔量，我们乘以阿伏伽德罗常数 $N_A$，并使用 $R = N_A k_B$：\n$$\\Delta S^{\\ddagger}_{\\mathrm{orient, molar}} = N_A (k_B \\ln f) = R \\ln f$$\n这种熵变对活化吉布斯自由能 $\\Delta G^{\\ddagger}$ 的贡献由 $\\Delta G^{\\ddagger} = \\Delta H^{\\ddagger} - T\\Delta S^{\\ddagger}$ 给出。问题分别定义了焓垒（$E_a$）并暗示此取向门控是纯粹的熵效应，因此其焓贡献 $\\Delta H^{\\ddagger}_{\\mathrm{orient}}$ 为零。\n因此，对活化自由能的取向贡献为：\n$$\\Delta G^{\\ddagger}_{\\mathrm{orient}} = -T \\Delta S^{\\ddagger}_{\\mathrm{orient, molar}} = -RT \\ln f$$\n为了以 $\\mathrm{kJ\\ mol^{-1}}$ 得到结果，我们必须使用单位为 $\\mathrm{kJ\\ mol^{-1}\\ K^{-1}}$ 的 $R$：\n$$\\Delta G^{\\ddagger}_{\\mathrm{orient}} (\\mathrm{kJ\\ mol^{-1}}) = -\\frac{R}{1000} T \\ln f$$\n\n这些推导出的公式被用于每个测试案例的实现。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational chemistry problem for the given test cases.\n    \"\"\"\n    # Define fundamental constants\n    # R is the molar gas constant in J mol^-1 K^-1\n    R_CONST = 8.314462618 \n\n    # Define the parameters for the four test cases\n    # (D_e [kJ/mol], a [1/Angstrom], r_e [Angstrom], T [K], f [dimensionless])\n    test_cases = [\n        (368.000, 1.800, 1.540, 298.000, 1.000),\n        (368.000, 1.800, 1.540, 298.000, 1.000e-3),\n        (368.000, 1.800, 1.540, 500.000, 1.000e-4),\n        (350.000, 1.800, 1.540, 298.000, 1.000e-6),\n    ]\n\n    # Fixed parameters from the problem description\n    r_max = 5.000  # Angstrom\n\n    results = []\n    for case in test_cases:\n        D_e, a, r_e, T, f = case\n\n        # 1. Calculate Activation Energy (E_a)\n        # As derived in the solution, for a Morse potential, the potential is\n        # monotonically increasing for r > r_e. Thus, the maximum on the\n        # interval [r_e, r_max] is at r_max.\n        # E_a = V(r_max) - V(r_max) = 0.\n        E_a = 0.0\n\n        # 2. Calculate Reaction Energy (Delta E_rxn)\n        # Delta E_rxn = V(r_e) - V(r_max)\n        # V(r_e) = -D_e by definition.\n        # We need to calculate V(r_max) using the Morse potential formula:\n        # V(r) = D_e * [(1 - exp(-a*(r - r_e)))^2 - 1]\n        exponent_term = np.exp(-a * (r_max - r_e))\n        V_r_max = D_e * ((1 - exponent_term)**2 - 1)\n        # Delta E_rxn is in kJ/mol since D_e is in kJ/mol.\n        delta_E_rxn = -D_e - V_r_max\n\n        # 3. Calculate Orientational Gating Free Energy (Delta G_orient)\n        # Delta G_orient = -R * T * ln(f).\n        # We convert R from J/mol/K to kJ/mol/K by dividing by 1000.\n        if f > 0:\n            delta_G_orient = -(R_CONST / 1000.0) * T * np.log(f)\n        else:\n            # log(0) is -inf, leading to an infinite barrier.\n            # While not in test cases, this is the physical limit.\n            delta_G_orient = float('inf') \n\n        # Round results to three decimal places as required.\n        E_a_rounded = round(E_a, 3)\n        delta_G_orient_rounded = round(delta_G_orient, 3)\n        delta_E_rxn_rounded = round(delta_E_rxn, 3)\n\n        results.append([E_a_rounded, delta_G_orient_rounded, delta_E_rxn_rounded])\n\n    # Format the final output string as a list of lists.\n    # The `str(results)` gives almost the correct format but includes spaces.\n    # The requested output format is \"[[val1,val2,...],[...],...]\"\n    # Using a list comprehension and join is robust.\n    # The provided print statement template in the prompt is elegant and works directly.\n    # For example, `str([1.0, 2.0, 3.0])` is `'[1.0, 2.0, 3.0]'`.\n    # `map(str, results)` will convert each inner list to its string representation.\n    # `','.join(...)` will join these strings with commas.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2451411"}, {"introduction": "在电子能垒的基础上，我们现在引入一个关键的量子力学校正：零点振动能 (ZPE)。这个练习将指导您通过比较断裂 C-H 键与 C-D 键的活化能垒来计算动力学同位素效应 (KIE) [@problem_id:2451445]。您将通过计算验证氢和氘的质量差异如何影响它们的振动能，进而改变有效反应能垒并导致不同的反应速率。", "problem": "一项计算化学任务要求使用过渡态理论 (TST)，通过比较经零点振动能校正的活化能垒，来估算碳-氢键与碳-氘键断裂的动力学同位素效应。您必须实现一个完整、可运行的程序，该程序计算作为同位素异构体速率常数之比的动力学同位素效应。最终结果必须按指定格式打印。请使用以下假设和基本原理。\n\n假设和基本原理：\n- 使用过渡态理论 (TST)。基元步骤的速率常数由 $k = \\dfrac{k_{\\mathrm{B}} T}{h} \\exp\\!\\left(-\\dfrac{\\Delta G^{\\ddagger}}{R T}\\right)$ 模型化，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$h$ 是普朗克常数，$T$ 是绝对温度，$R$ 是气体常数，$\\Delta G^{\\ddagger}$ 是活化吉布斯自由能。\n- 忽略隧穿效应，并假设对于特定键的比较，$\\Delta G^{\\ddagger}$ 的熵贡献和热焓贡献在不同同位素异构体之间基本抵消，因此 $\\Delta G^{\\ddagger} \\approx \\Delta E^{\\ddagger}_{\\mathrm{corr}}$，其中 $\\Delta E^{\\ddagger}_{\\mathrm{corr}}$ 是经过渡态和反应物之间零点振动能 (ZPVE) 差校正后的电子活化能垒。\n- 对于波数为 $\\tilde{\\nu}$ (单位 $\\mathrm{cm}^{-1}$) 的单一简谐振动模式，每摩尔的零点振动能为 $E_{0} = \\dfrac{1}{2} N_{\\mathrm{A}} h c\\, \\tilde{\\nu}$，其中 $N_{\\mathrm{A}}$ 是阿伏伽德罗常数，$h$ 是普朗克常数，$c$ 是光速。此公式仅用于 C–H 和 C–D 伸缩振动模式，并假设在此比较中，其他模式在反应物和过渡态之间相互抵消。\n- 因此，对于同位素异构体 $X \\in \\{\\mathrm{H}, \\mathrm{D}\\}$，使用公式 $\\Delta E^{\\ddagger}_{\\mathrm{corr},X} = E^{\\ddagger}_{\\mathrm{el}} + \\left(\\dfrac{1}{2} N_{\\mathrm{A}} h c\\right)\\left(\\tilde{\\nu}_{\\mathrm{TS},X} - \\tilde{\\nu}_{\\mathrm{R},X}\\right)$，所有能量均以每摩尔为单位。将结果转换为 $\\mathrm{kJ\\,mol^{-1}}$。\n- 动力学同位素效应定义为 $\\mathrm{KIE} = \\dfrac{k_{\\mathrm{H}}}{k_{\\mathrm{D}}}$，这是一个无量纲量。\n\n使用的常量（在双精度浮点数范围内视为精确值）：\n- 普朗克常数 $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s}$。\n- 光速 $c = 2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s^{-1}}$。\n- 阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$。\n- 气体常数 $R = 8.31446261815324\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n实现要求：\n- 对于每个测试用例，根据所提供的目标伸缩模式的波数差计算零点振动能校正，得到以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的 ZPVE 校正活化能垒，计算在指定温度下 $\\mathrm{H}$ 和 $\\mathrm{D}$ 的 TST 速率常数，并输出比值 $\\mathrm{KIE} = k_{\\mathrm{H}}/k_{\\mathrm{D}}$（作为浮点数）。\n- 能量必须以 $\\mathrm{kJ\\,mol^{-1}}$ 处理，温度以 $\\mathrm{K}$ 处理，波数以 $\\mathrm{cm^{-1}}$ 处理。\n- 以四舍五入到 $6$ 位小数的无量纲浮点数形式回答每个动力学同位素效应。\n\n测试套件：\n对于每个元组，参数为 $(T,\\ E^{\\ddagger}_{\\mathrm{el}},\\ \\tilde{\\nu}_{\\mathrm{R,H}},\\ \\tilde{\\nu}_{\\mathrm{TS,H}},\\ \\tilde{\\nu}_{\\mathrm{R,D}},\\ \\tilde{\\nu}_{\\mathrm{TS,D}})$，其中 $T$ 的单位是 $\\mathrm{K}$，$E^{\\ddagger}_{\\mathrm{el}}$ 的单位是 $\\mathrm{kJ\\,mol^{-1}}$，所有 $\\tilde{\\nu}$ 的单位都是 $\\mathrm{cm^{-1}}$。\n- 案例 $1$：$(298.15, 100.0, 3000, 1200, 2200, 850)$\n- 案例 $2$：$(200.00, 80.0, 2900, 1000, 2100, 730)$\n- 案例 $3$ (ZPVE 差异几乎抵消，KIE 接近 1)：$(298.15, 50.0, 2900, 2890, 2060, 2053)$\n- 案例 $4$ (更高的电子能垒，更高的温度)：$(600.00, 150.0, 3100, 800, 2250, 570)$\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含四个测试用例的结果，结果为逗号分隔的列表，并用方括号括起来。例如，要求的格式是 $[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}]$，其中每个 $\\mathrm{result}$ 都四舍五入到 $6$ 位小数且无单位。", "solution": "该问题要求计算 C–H/C–D 键断裂反应的动力学同位素效应 (KIE)。其理论框架是过渡态理论 (TST)，并通过几个明确定义的近似进行了简化。KIE，表示为 $\\mathrm{KIE}$，是氢同位素异构体 ($k_{\\mathrm{H}}$) 与氘同位素异构体 ($k_{\\mathrm{D}}$) 的速率常数之比。\n\n首先，我们建立 KIE 的基本关系。根据 TST，涉及物种 $X$ (其中 $X$ 为 $\\mathrm{H}$ 或 $\\mathrm{D}$) 的基元反应的速率常数 $k_X$ 由下式给出：\n$$ k_X = \\frac{k_{\\mathrm{B}} T}{h} \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_X}{R T}\\right) $$\n此处，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$h$ 是普朗克常数，$R$ 是理想气体常数，$\\Delta G^{\\ddagger}_X$ 是物种 $X$ 的活化吉布斯自由能。\n\nKIE 定义为比率 $\\mathrm{KIE} = k_{\\mathrm{H}} / k_{\\mathrm{D}}$。代入速率常数的 TST 表达式可得：\n$$ \\mathrm{KIE} = \\frac{\\frac{k_{\\mathrm{B}} T}{h} \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{\\mathrm{H}}}{R T}\\right)}{\\frac{k_{\\mathrm{B}} T}{h} \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{\\mathrm{D}}}{R T}\\right)} $$\n指前因子 $\\frac{k_{\\mathrm{B}} T}{h}$ 对两种同位素异构体是相同的，因此可以消去，表达式简化为：\n$$ \\mathrm{KIE} = \\frac{\\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{\\mathrm{H}}}{R T}\\right)}{\\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{\\mathrm{D}}}{R T}\\right)} = \\exp\\!\\left(\\frac{\\Delta G^{\\ddagger}_{\\mathrm{D}} - \\Delta G^{\\ddagger}_{\\mathrm{H}}}{R T}\\right) $$\n问题陈述中要求用 ZPVE 校正的电子活化能垒 $\\Delta E^{\\ddagger}_{\\mathrm{corr},X}$ 来近似活化吉布斯自由能 $\\Delta G^{\\ddagger}_X$。这假设了对 $\\Delta G^{\\ddagger}_X$ 的熵和热焓贡献对于两种同位素异构体实际上是相同的，因此在求差时相互抵消。\n$$ \\mathrm{KIE} \\approx \\exp\\!\\left(\\frac{\\Delta E^{\\ddagger}_{\\mathrm{corr,D}} - \\Delta E^{\\ddagger}_{\\mathrm{corr,H}}}{R T}\\right) $$\nZPVE 校正的活化能垒定义为电子活化能垒 $E^{\\ddagger}_{\\mathrm{el}}$ 与从反应物 (R) 到过渡态 (TS) 的零点振动能变化 ($\\Delta E_{0,X}$) 之和：\n$$ \\Delta E^{\\ddagger}_{\\mathrm{corr},X} = E^{\\ddagger}_{\\mathrm{el}} + \\Delta E_{0,X} = E^{\\ddagger}_{\\mathrm{el}} + (E_{0,\\mathrm{TS},X} - E_{0,\\mathrm{R},X}) $$\n在 Born-Oppenheimer 近似下，电子能量 $E^{\\ddagger}_{\\mathrm{el}}$ 与同位素取代无关。因此，当我们计算差值 $\\Delta E^{\\ddagger}_{\\mathrm{corr,D}} - \\Delta E^{\\ddagger}_{\\mathrm{corr,H}}$ 时，$E^{\\ddagger}_{\\mathrm{el}}$ 项被抵消：\n$$ \\Delta E^{\\ddagger}_{\\mathrm{corr,D}} - \\Delta E^{\\ddagger}_{\\mathrm{corr,H}} = (E^{\\ddagger}_{\\mathrm{el}} + \\Delta E_{0,D}) - (E^{\\ddagger}_{\\mathrm{el}} + \\Delta E_{0,H}) = \\Delta E_{0,D} - \\Delta E_{0,H} $$\n问题指定使用简谐振子模型来计算具有波数 $\\tilde{\\nu}$ 的单一振动模式的零点能。每摩尔的 ZPVE 为 $E_0 = \\frac{1}{2} N_{\\mathrm{A}} h c \\tilde{\\nu}$，其中 $N_{\\mathrm{A}}$ 是阿伏伽德罗常数，$c$ 是光速。\n将此应用于 ZPVE 的变化，$\\Delta E_{0,X}$，我们有：\n$$ \\Delta E_{0,X} = E_{0,\\mathrm{TS},X} - E_{0,\\mathrm{R},X} = \\frac{1}{2} N_{\\mathrm{A}} h c (\\tilde{\\nu}_{\\mathrm{TS},X} - \\tilde{\\nu}_{\\mathrm{R},X}) $$\n因此，同位素异构体之间 ZPVE 变化的差异是：\n$$ \\Delta E_{0,D} - \\Delta E_{0,H} = \\frac{1}{2} N_{\\mathrm{A}} h c \\left[ (\\tilde{\\nu}_{\\mathrm{TS,D}} - \\tilde{\\nu}_{\\mathrm{R,D}}) - (\\tilde{\\nu}_{\\mathrm{TS,H}} - \\tilde{\\nu}_{\\mathrm{R,H}}) \\right] $$\n让我们将此能量差定义为 $\\Delta\\Delta E_0 = \\Delta E_{0,D} - \\Delta E_{0,H}$。KIE 的最终表达式是：\n$$ \\mathrm{KIE} = \\exp\\!\\left(\\frac{\\Delta\\Delta E_0}{R T}\\right) = \\exp\\!\\left( \\frac{ N_{\\mathrm{A}} h c }{2 R T} \\left[ (\\tilde{\\nu}_{\\mathrm{TS,D}} - \\tilde{\\nu}_{\\mathrm{R,D}}) - (\\tilde{\\nu}_{\\mathrm{TS,H}} - \\tilde{\\nu}_{\\mathrm{R,H}}) \\right] \\right) $$\n计算过程如下：\n$1$. 对每个测试用例，获取输入参数：$T$、$\\tilde{\\nu}_{\\mathrm{R,H}}$、$\\tilde{\\nu}_{\\mathrm{TS,H}}$、$\\tilde{\\nu}_{\\mathrm{R,D}}$ 和 $\\tilde{\\nu}_{\\mathrm{TS,D}}$。请注意，最终 KIE 的计算不需要电子能垒 $E^{\\ddagger}_{\\mathrm{el}}$。\n$2$. 计算每个同位素异构体的波数变化：$\\Delta\\tilde{\\nu}_{\\mathrm{H}} = \\tilde{\\nu}_{\\mathrm{TS,H}} - \\tilde{\\nu}_{\\mathrm{R,H}}$ 和 $\\Delta\\tilde{\\nu}_{\\mathrm{D}} = \\tilde{\\nu}_{\\mathrm{TS,D}} - \\tilde{\\nu}_{\\mathrm{R,D}}$。\n$3$. 计算这些变化之间的差异：$\\Delta\\Delta\\tilde{\\nu} = \\Delta\\tilde{\\nu}_{\\mathrm{D}} - \\Delta\\tilde{\\nu}_{\\mathrm{H}}$。\n$4$. 使用表达式 $\\Delta\\Delta E_0 = \\frac{1}{2} N_{\\mathrm{A}} h c \\Delta\\Delta\\tilde{\\nu}$ 计算总能量差 $\\Delta\\Delta E_0$，单位为 $\\mathrm{J\\,mol^{-1}}$。常量 $h$ 和 $c$ 必须使用兼容的单位（$c$ 的单位为 $\\mathrm{cm\\,s^{-1}}$ 以匹配 $\\tilde{\\nu}$ 的单位 $\\mathrm{cm^{-1}}$）。\n$5$. 计算热能项 $R T$，单位为 $\\mathrm{J\\,mol^{-1}}$。\n$6$. 计算 KIE：$\\mathrm{KIE} = \\exp(\\Delta\\Delta E_0 / (R T))$。指数函数的参数必须是无量纲的。单位分析证实了这一点：$(\\mathrm{J\\,mol^{-1}}) / (\\mathrm{J\\,mol^{-1}\\,K^{-1}} \\cdot \\mathrm{K}) = 1$。\n$7$. 最终结果按要求四舍五入到 $6$ 位小数。\n此过程提供了一种直接而高效的算法，可根据所提供的物理模型和近似值计算 KIE。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Kinetic Isotope Effect (KIE) for C-H/C-D bond cleavage\n    based on Transition State Theory and zero-point vibrational energy corrections.\n    \"\"\"\n\n    # --- Constants (treated as exact) ---\n    # Planck's constant in J·s\n    H_PLANCK = 6.62607015e-34\n    # Speed of light in cm·s⁻¹ (to match wavenumber units)\n    C_LIGHT = 2.99792458e10\n    # Avogadro's number in mol⁻¹\n    NA_AVOGADRO = 6.02214076e23\n    # Gas constant in J·mol⁻¹·K⁻¹\n    R_GAS = 8.31446261815324\n\n    # --- Test Suite ---\n    # Each tuple contains:\n    # (T [K], E_el [kJ/mol], nu_R_H [cm⁻¹], nu_TS_H [cm⁻¹], nu_R_D [cm⁻¹], nu_TS_D [cm⁻¹])\n    test_cases = [\n        (298.15, 100.0, 3000, 1200, 2200, 850),\n        (200.00, 80.0, 2900, 1000, 2100, 730),\n        (298.15, 50.0, 2900, 2890, 2060, 2053),\n        (600.00, 150.0, 3100, 800, 2250, 570),\n    ]\n\n    results = []\n    \n    # Pre-calculate the energy conversion factor for ZPVE in J·cm·mol⁻¹\n    # ZPVE_factor = 0.5 * N_A * h * c\n    # The total ZPVE difference is ZPVE_factor * delta_nu\n    zpve_factor = 0.5 * NA_AVOGADRO * H_PLANCK * C_LIGHT\n\n    for case in test_cases:\n        T_K, E_el_kJ_mol, nu_R_H, nu_TS_H, nu_R_D, nu_TS_D = case\n\n        # The KIE depends on the difference in ZPVE changes between the two isotopologues.\n        # KIE = exp( (delta_E_corr_D - delta_E_corr_H) / (R*T) )\n        # delta_E_corr_D - delta_E_corr_H simplifies to delta_E0_D - delta_E0_H\n        # where delta_E0_X = 0.5 * Na * h * c * (nu_TS_X - nu_R_X)\n\n        # 1. Calculate the change in wavenumber for H and D\n        delta_nu_H = nu_TS_H - nu_R_H\n        delta_nu_D = nu_TS_D - nu_R_D\n\n        # 2. Calculate the difference of these changes\n        delta_delta_nu = delta_nu_D - delta_nu_H\n\n        # 3. Calculate the corresponding energy difference in J/mol\n        # This is delta_E0_D - delta_E0_H\n        delta_delta_E0_J_mol = zpve_factor * delta_delta_nu\n\n        # 4. Calculate the thermal energy term RT in J/mol\n        RT_J_mol = R_GAS * T_K\n        \n        # 5. Calculate the KIE\n        # The electronic activation energy (E_el_kJ_mol) cancels out and is not needed.\n        if RT_J_mol == 0:\n            # Avoid division by zero, though T > 0 in all cases.\n            kie = np.inf\n        else:\n            exponent = delta_delta_E0_J_mol / RT_J_mol\n            kie = np.exp(exponent)\n            \n        # 6. Format the result to 6 decimal places\n        results.append(f\"{kie:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2451445"}, {"introduction": "我们最后的实践将所有概念整合到一个完整而真实的工作流程中：计算溶液中的完整反应路径。您将根据计算出的基本组分，为反应物、过渡态和产物构建总吉布斯自由能 ($G$) [@problem_id:2451417]。通过对两种不同的溶剂化模型——简化的隐式连续介质模型和更详细的显式水分子簇模型——进行此分析，您将获得如何评估理论选择对预测的反应自由能和活化自由能 ($\\Delta G^\\ddagger$) 的影响的实践经验。", "problem": "一个质子转移反应通过两种溶剂化方法进行建模：一种是针对水的隐式连续介质溶剂模型，另一种是包含六个水分子的显式团簇模型。对于每种方法，沿反应坐标的三个驻点被表征出来：反应物 (R)、过渡态 (TS) 和产物 (P)。对于每个驻点，给出了以Hartree为单位的电子能量、零点能 (ZPE)、焓的热校正以及熵。对于隐式溶剂模型，还给出了溶剂化自由能。对于显式团簇模型，根据其构造，溶剂化自由能为零，因为水分子被显式处理。使用吉布斯自由能的标准热力学定义，计算在温度 $T = 298.15\\,\\mathrm{K}$ 时每个驻点的总吉布斯自由能。使用 Hartree 到 $\\mathrm{kJ\\,mol^{-1}}$ 的转换因子 $1\\,\\mathrm{Hartree} = 2625.499638\\,\\mathrm{kJ\\,mol^{-1}}$。熵以 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 为单位提供，在计算以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的吉布斯自由能时，必须进行一致的单位转换。所有结果必须以 $\\mathrm{kJ\\,mol^{-1}}$ 表示。\n\n对于每种溶剂化方法和每个测试用例，计算反应吉布斯自由能 $\\Delta G_\\mathrm{rxn} = G_\\mathrm{P} - G_\\mathrm{R}$ 和活化吉布斯自由能 $\\Delta G^\\ddagger = G_\\mathrm{TS} - G_\\mathrm{R}$，其中 $G$ 表示在 $T = 298.15\\,\\mathrm{K}$ 时的总吉布斯自由能。然后计算显式模型和隐式模型之间活化能垒的差异，定义为 $\\Delta(\\Delta G^\\ddagger) = \\Delta G^\\ddagger_\\mathrm{explicit} - \\Delta G^\\ddagger_\\mathrm{implicit}$。所有输出均以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位报告，并四舍五入到三位小数。\n\n测试套件（三个独立的参数集）。对于每个测试用例，为隐式模型和显式六水团簇模型提供了以下数据。每个驻点条目是一个形式为 $(E_\\mathrm{elec}\\ \\mathrm{[Hartree]},\\ \\mathrm{ZPE}\\ \\mathrm{[kJ\\,mol^{-1}]},\\ H_\\mathrm{thermal}\\ \\mathrm{[kJ\\,mol^{-1}]},\\ S\\ \\mathrm{[J\\,mol^{-1}\\,K^{-1}]},\\ G_\\mathrm{solv}\\ \\mathrm{[kJ\\,mol^{-1}]})$ 的元组。对于显式团簇，$G_\\mathrm{solv} = 0$。\n\n- 测试用例 1:\n  - 隐式（连续介质水）\n    - R: $(-400.125,\\ 50.0,\\ 8.0,\\ 220.0,\\ -25.0)$\n    - TS: $(-400.100,\\ 49.0,\\ 8.1,\\ 180.0,\\ -20.0)$\n    - P: $(-400.130,\\ 49.5,\\ 7.9,\\ 210.0,\\ -27.0)$\n  - 显式（含六个水的团簇）\n    - R: $(-856.750,\\ 310.0,\\ 15.0,\\ 920.0,\\ 0.0)$\n    - TS: $(-856.725,\\ 308.0,\\ 15.1,\\ 880.0,\\ 0.0)$\n    - P: $(-856.760,\\ 309.5,\\ 14.8,\\ 900.0,\\ 0.0)$\n\n- 测试用例 2:\n  - 隐式（连续介质水）\n    - R: $(-500.000,\\ 60.0,\\ 7.0,\\ 200.0,\\ -30.0)$\n    - TS: $(-499.990,\\ 60.5,\\ 7.0,\\ 195.0,\\ -31.0)$\n    - P: $(-500.001,\\ 60.1,\\ 7.0,\\ 199.0,\\ -30.5)$\n  - 显式（含六个水的团簇）\n    - R: $(-956.000,\\ 320.0,\\ 16.0,\\ 940.0,\\ 0.0)$\n    - TS: $(-955.990,\\ 321.0,\\ 16.0,\\ 938.0,\\ 0.0)$\n    - P: $(-956.0015,\\ 320.1,\\ 16.0,\\ 939.0,\\ 0.0)$\n\n- 测试用例 3:\n  - 隐式（连续介质水）\n    - R: $(-600.500,\\ 55.0,\\ 9.0,\\ 230.0,\\ -28.0)$\n    - TS: $(-600.480,\\ 55.5,\\ 9.1,\\ 240.0,\\ -35.0)$\n    - P: $(-600.498,\\ 55.2,\\ 9.0,\\ 228.0,\\ -27.0)$\n  - 显式（含六个水的团簇）\n    - R: $(-1056.800,\\ 330.0,\\ 17.0,\\ 950.0,\\ 0.0)$\n    - TS: $(-1056.770,\\ 329.0,\\ 17.0,\\ 900.0,\\ 0.0)$\n    - P: $(-1056.805,\\ 330.1,\\ 17.0,\\ 948.0,\\ 0.0)$\n\n你的程序必须为每个测试用例计算列表 $[\\Delta G_\\mathrm{rxn}^\\mathrm{implicit},\\ \\Delta G^{\\ddagger,\\mathrm{implicit}},\\ \\Delta G_\\mathrm{rxn}^\\mathrm{explicit},\\ \\Delta G^{\\ddagger,\\mathrm{explicit}},\\ \\Delta(\\Delta G^\\ddagger)]$，所有值均以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位，并四舍五入到三位小数。最终输出必须是单行，包含一个由三个按用例划分的结果列表组成的列表，没有空格，格式完全是方括号括起来的逗号分隔列表。例如，一个有效的形状是 $[[x_{11},x_{12},x_{13},x_{14},x_{15}],[x_{21},x_{22},x_{23},x_{24},x_{25}],[x_{31},x_{32},x_{33},x_{34},x_{35}]]$，其中每个 $x_{ij}$ 都是一个浮点数。", "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上基于计算化学和统计热力学的原理，提法得当，包含了所有必要的定量数据和定义，并且完全客观。我们现在开始进行解答。\n\n基本任务是为隐式和显式溶剂化模型中的每个指定驻点（反应物 R；过渡态 TS；产物 P）计算总吉布斯自由能 $G$。溶液中的吉布斯自由能 $G_\\mathrm{sol}$ 由所提供的组分构建而成：电子能量 ($E_\\mathrm{elec}$)、零点能 (ZPE)、焓的热校正 ($H_\\mathrm{thermal}$)、熵 ($S$) 和溶剂化自由能 ($G_\\mathrm{solv}$)。\n\n总吉布斯自由能由标准热力学关系 $G = H - TS$ 定义。在计算化学输出的背景下，给定温度 $T$ 下的总焓 $H$ 是电子能量、零点能和焓的热校正的总和。因此，气相中的吉布斯自由能 $G_\\mathrm{gas}$ 由下式给出：\n$$G_\\mathrm{gas} = (E_\\mathrm{elec} + \\mathrm{ZPE} + H_\\mathrm{thermal}) - TS$$\n对于溶液中的体系，如通过隐式溶剂模型处理，总吉布斯自由能 $G_\\mathrm{sol}$ 是通过加上溶剂化自由能 $G_\\mathrm{solv}$ 得到的：\n$$G_\\mathrm{sol} = G_\\mathrm{gas} + G_\\mathrm{solv} = (E_\\mathrm{elec} + \\mathrm{ZPE} + H_\\mathrm{thermal}) - TS + G_\\mathrm{solv}$$\n在显式溶剂模型的情况下，溶剂分子是量子力学计算的一部分，它们的能量贡献已经包含在 $E_\\mathrm{elec}$、ZPE、$H_\\mathrm{thermal}$ 和 $S$ 中。根据其构造，单独的溶剂化自由能项为零，$G_\\mathrm{solv} = 0$。\n\n一个关键步骤是确保单位一致。所提供的数据需要转换为通用单位，即 $\\mathrm{kJ\\,mol^{-1}}$。\n- $E_\\mathrm{elec}$ 以 Hartree 为单位给出，必须使用提供的转换因子进行转换：$1\\,\\mathrm{Hartree} = 2625.499638\\,\\mathrm{kJ\\,mol^{-1}}$。\n- ZPE、$H_\\mathrm{thermal}$ 和 $G_\\mathrm{solv}$ 已经是 $\\mathrm{kJ\\,mol^{-1}}$ 单位。\n- 熵 $S$ 以 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 为单位给出。熵贡献 $TS$ 必须通过除以 1000 转换为 $\\mathrm{kJ\\,mol^{-1}}$。给定温度为 $T = 298.15\\,\\mathrm{K}$。\n\n因此，以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的总吉布斯自由能 $G$ 的完整公式是：\n$$G\\,[\\mathrm{kJ\\,mol^{-1}}] = (E_\\mathrm{elec}\\,[\\mathrm{Hartree}] \\times 2625.499638) + \\mathrm{ZPE}\\,[\\mathrm{kJ\\,mol^{-1}}] + H_\\mathrm{thermal}\\,[\\mathrm{kJ\\,mol^{-1}}] - \\frac{T\\,[\\mathrm{K}] \\times S\\,[\\mathrm{J\\,mol^{-1}\\,K^{-1}}]}{1000} + G_\\mathrm{solv}\\,[\\mathrm{kJ\\,mol^{-1}}]$$\n\n有了每个驻点（$G_\\mathrm{R}$, $G_\\mathrm{TS}$, $G_\\mathrm{P}$）的绝对吉布斯自由能，我们就可以为每个模型计算所需的相对能量：\n- 反应吉布斯自由能：$\\Delta G_\\mathrm{rxn} = G_\\mathrm{P} - G_\\mathrm{R}$\n- 活化吉布斯自由能：$\\Delta G^\\ddagger = G_\\mathrm{TS} - G_\\mathrm{R}$\n\n最后，我们计算两个模型之间活化能垒的差异：\n- $\\Delta(\\Delta G^\\ddagger) = \\Delta G^\\ddagger_\\mathrm{explicit} - \\Delta G^\\ddagger_\\mathrm{implicit}$\n\n让我们为测试用例1演示该过程。\n设转换因子为 $C = 2625.499638\\,\\mathrm{kJ\\,mol^{-1}\\,Hartree^{-1}}$，温度为 $T = 298.15\\,\\mathrm{K}$。\n\n对于隐式模型：\n- $G_\\mathrm{R}^\\mathrm{implicit} = (-400.125 \\times C) + 50.0 + 8.0 - \\frac{T \\times 220.0}{1000} - 25.0 = -1050510.670\\,\\mathrm{kJ\\,mol^{-1}}$\n- $G_\\mathrm{TS}^\\mathrm{implicit} = (-400.100 \\times C) + 49.0 + 8.1 - \\frac{T \\times 180.0}{1000} - 20.0 = -1050428.959\\,\\mathrm{kJ\\,mol^{-1}}$\n- $G_\\mathrm{P}^\\mathrm{implicit} = (-400.130 \\times C) + 49.5 + 7.9 - \\frac{T \\times 210.0}{1000} - 27.0 = -1050523.416\\,\\mathrm{kJ\\,mol^{-1}}$\n由此，我们推导出：\n- $\\Delta G_\\mathrm{rxn}^\\mathrm{implicit} = G_\\mathrm{P}^\\mathrm{implicit} - G_\\mathrm{R}^\\mathrm{implicit} = -12.746\\,\\mathrm{kJ\\,mol^{-1}}$\n- $\\Delta G^{\\ddagger,\\mathrm{implicit}} = G_\\mathrm{TS}^\\mathrm{implicit} - G_\\mathrm{R}^\\mathrm{implicit} = 81.711\\,\\mathrm{kJ\\,mol^{-1}}$\n\n对于显式模型 ($G_\\mathrm{solv} = 0$)：\n- $G_\\mathrm{R}^\\mathrm{explicit} = (-856.750 \\times C) + 310.0 + 15.0 - \\frac{T \\times 920.0}{1000} + 0.0 = -2249488.997\\,\\mathrm{kJ\\,mol^{-1}}$\n- $G_\\mathrm{TS}^\\mathrm{explicit} = (-856.725 \\times C) + 308.0 + 15.1 - \\frac{T \\times 880.0}{1000} + 0.0 = -2249413.286\\,\\mathrm{kJ\\,mol^{-1}}$\n- $G_\\mathrm{P}^\\mathrm{explicit} = (-856.760 \\times C) + 309.5 + 14.8 - \\frac{T \\times 900.0}{1000} + 0.0 = -2249509.989\\,\\mathrm{kJ\\,mol^{-1}}$\n由此，我们推导出：\n- $\\Delta G_\\mathrm{rxn}^\\mathrm{explicit} = G_\\mathrm{P}^\\mathrm{explicit} - G_\\mathrm{R}^\\mathrm{explicit} = -20.992\\,\\mathrm{kJ\\,mol^{-1}}$\n- $\\Delta G^{\\ddagger,\\mathrm{explicit}} = G_\\mathrm{TS}^\\mathrm{explicit} - G_\\mathrm{R}^\\mathrm{explicit} = 75.711\\,\\mathrm{kJ\\,mol^{-1}}$\n\n最后，活化能垒的差异是：\n- $\\Delta(\\Delta G^\\ddagger) = 75.711 - 81.711 = -6.000\\,\\mathrm{kJ\\,mol^{-1}}$\n\n计算得出的测试用例1的值列表，四舍五入到三位小数后为 $[-12.746, 81.711, -20.992, 75.711, -6.000]$。这一严谨的程序被应用于所有测试用例，并在提供的代码中系统地实现，以确保准确性并生成最终结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates reaction and activation Gibbs free energies for a proton transfer\n    reaction using implicit and explicit solvation models.\n    \"\"\"\n    # Define constants\n    T = 298.15  # Temperature in Kelvin\n    HARTREE_TO_KJ_MOL = 2625.499638  # Conversion factor\n\n    # Test suite data: (E_elec [Hartree], ZPE [kJ/mol], H_thermal [kJ/mol], S [J/mol K], G_solv [kJ/mol])\n    test_cases = [\n        # Test case 1\n        {\n            \"implicit\": {\n                \"R\": (-400.125, 50.0, 8.0, 220.0, -25.0),\n                \"TS\": (-400.100, 49.0, 8.1, 180.0, -20.0),\n                \"P\": (-400.130, 49.5, 7.9, 210.0, -27.0),\n            },\n            \"explicit\": {\n                \"R\": (-856.750, 310.0, 15.0, 920.0, 0.0),\n                \"TS\": (-856.725, 308.0, 15.1, 880.0, 0.0),\n                \"P\": (-856.760, 309.5, 14.8, 900.0, 0.0),\n            },\n        },\n        # Test case 2\n        {\n            \"implicit\": {\n                \"R\": (-500.000, 60.0, 7.0, 200.0, -30.0),\n                \"TS\": (-499.990, 60.5, 7.0, 195.0, -31.0),\n                \"P\": (-500.001, 60.1, 7.0, 199.0, -30.5),\n            },\n            \"explicit\": {\n                \"R\": (-956.000, 320.0, 16.0, 940.0, 0.0),\n                \"TS\": (-955.990, 321.0, 16.0, 938.0, 0.0),\n                \"P\": (-956.0015, 320.1, 16.0, 939.0, 0.0),\n            },\n        },\n        # Test case 3\n        {\n            \"implicit\": {\n                \"R\": (-600.500, 55.0, 9.0, 230.0, -28.0),\n                \"TS\": (-600.480, 55.5, 9.1, 240.0, -35.0),\n                \"P\": (-600.498, 55.2, 9.0, 228.0, -27.0),\n            },\n            \"explicit\": {\n                \"R\": (-1056.800, 330.0, 17.0, 950.0, 0.0),\n                \"TS\": (-1056.770, 329.0, 17.0, 900.0, 0.0),\n                \"P\": (-1056.805, 330.1, 17.0, 948.0, 0.0),\n            },\n        },\n    ]\n\n    def calculate_gibbs_free_energy(params):\n        \"\"\"Calculates total Gibbs free energy for a stationary point.\"\"\"\n        e_elec, zpe, h_thermal, s, g_solv = params\n        g = (e_elec * HARTREE_TO_KJ_MOL) + zpe + h_thermal - (T * s / 1000.0) + g_solv\n        return g\n\n    all_results = []\n    for case in test_cases:\n        # Implicit model calculations\n        g_r_imp = calculate_gibbs_free_energy(case[\"implicit\"][\"R\"])\n        g_ts_imp = calculate_gibbs_free_energy(case[\"implicit\"][\"TS\"])\n        g_p_imp = calculate_gibbs_free_energy(case[\"implicit\"][\"P\"])\n\n        delta_g_rxn_imp = g_p_imp - g_r_imp\n        delta_g_act_imp = g_ts_imp - g_r_imp\n\n        # Explicit model calculations\n        g_r_exp = calculate_gibbs_free_energy(case[\"explicit\"][\"R\"])\n        g_ts_exp = calculate_gibbs_free_energy(case[\"explicit\"][\"TS\"])\n        g_p_exp = calculate_gibbs_free_energy(case[\"explicit\"][\"P\"])\n\n        delta_g_rxn_exp = g_p_exp - g_r_exp\n        delta_g_act_exp = g_ts_exp - g_r_exp\n        \n        # Difference in activation barriers\n        delta_delta_g_act = delta_g_act_exp - delta_g_act_imp\n\n        # Collect and round results for the current test case\n        case_results_raw = [\n            delta_g_rxn_imp,\n            delta_g_act_imp,\n            delta_g_rxn_exp,\n            delta_g_act_exp,\n            delta_delta_g_act,\n        ]\n        \n        # Round each value to 3 decimal places\n        case_results_rounded = [round(val, 3) for val in case_results_raw]\n        all_results.append(case_results_rounded)\n\n    # Format the final output string exactly as required (no spaces)\n    case_strings = []\n    for res_list in all_results:\n        # Convert each number to its string representation\n        # Using f-string for formatting to ensure 3 decimal places for all numbers including those ending in .0\n        num_strings = [f\"{val:.3f}\" for val in res_list]\n        case_strings.append(f\"[{','.join(num_strings)}]\")\n    \n    final_output_string = f\"[{','.join(case_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "2451417"}]}