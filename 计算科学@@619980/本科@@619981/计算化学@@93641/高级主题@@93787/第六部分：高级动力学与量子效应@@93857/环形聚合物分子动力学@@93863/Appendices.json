{"hands_on_practices": [{"introduction": "路径积分方法的基础是单个量子粒子与经典环状聚合物之间的数学同构关系。本练习通过计算回旋半径 $R_g$ 来具体探索这一核心联系 [@problem_id:2461772]。通过研究当珠子（beads）数量 $P$ 增加时 $R_g$ 是如何收敛到精确量子极限的，你将对路径积分表述的准确性有一个定量的理解。", "problem": "考虑一个质量为 $m$ 的单量子粒子，其在一维空间中受谐振势 $V(q) = \\frac{1}{2} m \\omega^2 q^2$ 的约束，温度为 $T$。在环形聚合物分子动力学 (Ring Polymer Molecular Dynamics, RPMD) 中，量子正则配分函数由一个经典同构表示：一个由 $P$ 个珠子组成的环形聚合物，最近邻珠子之间由频率参数为 $\\omega_P$ 的循环谐波弹簧连接，并且每个珠子都受到相同的外势作用。设珠子位置为 $\\{q_j\\}_{j=1}^P$，并定义质心 $q_{\\mathrm{c}} = \\frac{1}{P} \\sum_{j=1}^P q_j$。回旋半径定义为\n$$\nR_g = \\sqrt{ \\left\\langle \\frac{1}{P} \\sum_{j=1}^P \\left(q_j - q_{\\mathrm{c}}\\right)^2 \\right\\rangle },\n$$\n其中 $\\langle \\cdot \\rangle$ 表示在温度 $T$ 下对环形聚合物平衡分布进行的正则系综平均。使用标准的路径积分离散化，其珠-珠弹簧频率参数为\n$$\n\\omega_P = \\frac{P}{\\beta \\hbar},\n$$\n其中 $\\beta = \\frac{1}{k_B T}$，$k_B$ 是玻尔兹曼常数，$\\hbar$ 是约化普朗克常数。所有量都必须在国际单位制 (SI) 中处理。\n\n你的任务是编写一个完整的程序，对下面的每个测试用例执行以下操作：\n- 通过计算具有 $P$ 个珠子的经典环形聚合物模型在谐振阱中所蕴含的精确热平衡平均值，来计算有限离散化预测 $R_g(P)$。\n- 使用温度为 $T$ 的谐振子的精确量子热结果，计算 $P \\to \\infty$ 的参考值 $R_g(\\infty)$。\n- 返回绝对差\n$$\n\\Delta R_g(P) = \\left| R_g(P) - R_g(\\infty) \\right|\n$$\n，单位为米。\n\n在你的实现中，可以不加推导地假设以下基本原理：\n- 温度为 $T$ 的经典系统的正则分布与 $\\exp(-\\beta H)$ 成正比，其中 $H$ 是哈密顿量。\n- 对于一维谐振势中的单个粒子，量子统计力学的环形聚合物映射是一个经典的 $P$ 珠系统，每个珠子质量为 $m$，具有频率参数为 $\\omega_P = \\frac{P}{\\beta \\hbar}$ 的循环最近邻谐波弹簧，并且每个珠子 $q_j$ 都受到外谐振势 $\\frac{1}{2} m \\omega^2 q_j^2$ 的作用。\n- 一维谐振子在温度 $T$ 下的精确量子热位置方差是统计力学中一个经过充分检验的结果。\n\n以米为单位表示每个最终答案，使用科学记数法，小数点后保留六位数字（例如，`1.234567e-10`），输出中不含单位符号。如果在中间步骤中出现角度，应以弧度处理。最终的程序输出必须是单行，包含一个逗号分隔的测试套件结果列表，并用方括号括起来，格式如 $[x_1,x_2,x_3,\\dots]$。\n\n使用以下参数元组 $(m,\\omega,T,P)$ 的测试套件：\n- 测试 1 (边界情况：单个珠子): $(m=\\;1.6735575\\times 10^{-27}\\ \\mathrm{kg},\\ \\omega=\\;1.0\\times 10^{14}\\ \\mathrm{s}^{-1},\\ T=\\;300.0\\ \\mathrm{K},\\ P=\\;1)$。\n- 测试 2 (正常路径：适中的 $P$): $(m=\\;1.6735575\\times 10^{-27}\\ \\mathrm{kg},\\ \\omega=\\;1.0\\times 10^{14}\\ \\mathrm{s}^{-1},\\ T=\\;300.0\\ \\mathrm{K},\\ P=\\;8)$。\n- 测试 3 (收敛性检查：大的 $P$): $(m=\\;1.6735575\\times 10^{-27}\\ \\mathrm{kg},\\ \\omega=\\;1.0\\times 10^{14}\\ \\mathrm{s}^{-1},\\ T=\\;300.0\\ \\mathrm{K},\\ P=\\;128)$。\n- 测试 4 (低温和较大质量): $(m=\\;1.0\\times 10^{-26}\\ \\mathrm{kg},\\ \\omega=\\;5.0\\times 10^{13}\\ \\mathrm{s}^{-1},\\ T=\\;100.0\\ \\mathrm{K},\\ P=\\;16)$。\n- 测试 5 (低温下更强的势): $(m=\\;1.6735575\\times 10^{-27}\\ \\mathrm{kg},\\ \\omega=\\;5.0\\times 10^{14}\\ \\mathrm{s}^{-1},\\ T=\\;50.0\\ \\mathrm{K},\\ P=\\;32)$。\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是对应的 $\\Delta R_g(P)$，单位为米，并按上述规定格式化。", "solution": "该问题要求计算，对于一维谐振势中的量子粒子，有限 $P$ 珠环形聚合物的回旋半径 $R_g(P)$ 与其在连续路径积分极限 ($P \\to \\infty$)下的值（记为 $R_g(\\infty)$）之间的绝对差。\n\n首先，我们建立理论框架。系统是一个质量为 $m$ 的粒子，在温度 $T$ 下处于势 $V(q) = \\frac{1}{2} m \\omega^2 q^2$ 中。在路径积分表述中，这个量子系统被映射到一个由 $P$ 个珠子组成的经典环形聚合物上。这个经典类比的势能由哈密顿量给出：\n$$\nH_P(\\mathbf{q}) = \\sum_{j=1}^P \\left[ \\frac{1}{2} m \\omega_P^2 (q_j - q_{j+1})^2 + \\frac{1}{2} m \\omega^2 q_j^2 \\right]\n$$\n其中 $\\mathbf{q} = \\{q_1, \\dots, q_P\\}$ 是珠子位置，下标是循环的 ($q_{P+1} = q_1$)，$\\beta = 1/(k_B T)$ 是逆温度，$\\omega_P = P/(\\beta \\hbar)$ 是珠间弹簧频率参数。一个可观测量 $A(\\mathbf{q})$ 的正则平均是 $\\langle A \\rangle = Z_P^{-1} \\int d\\mathbf{q} \\, A(\\mathbf{q}) \\exp(-\\beta H_P(\\mathbf{q}))$，其中 $Z_P$ 是配分函数。\n\n我们感兴趣的量是回旋半径的平方，定义为：\n$$\nR_g^2 = \\left\\langle \\frac{1}{P} \\sum_{j=1}^P \\left(q_j - q_{\\mathrm{c}}\\right)^2 \\right\\rangle\n$$\n其中 $q_c = \\frac{1}{P} \\sum_{j=1}^P q_j$ 是聚合物的质心。\n\n为了计算这个热平均值，我们通过变换到环形聚合物的简正模来对角化二次型哈密顿量 $H_P$。哈密顿量可以用这些模来表示，它们是独立的谐振子。非质心模的方差给出了回旋半径。使用由 $H_P$ 定义的多元高斯分布的协方差矩阵进行直接计算，可以得到一个紧凑的结果。协方差矩阵元素 $\\langle q_i q_j \\rangle$ 是矩阵 $(\\beta \\mathbf{K})^{-1}$ 的第 $(i,j)$ 个元素，其中 $\\mathbf{K}$ 是 $H_P$ 的 Hessian 矩阵。这导出了有限数量珠子 $P$ 的回旋半径平方的精确表达式：\n$$\nR_g^2(P) = \\frac{1}{P \\beta m} \\sum_{k=1}^{P-1} \\frac{1}{\\omega^2 + \\left(2 \\omega_P \\sin\\left(\\frac{\\pi k}{P}\\right)\\right)^2}\n$$\n代入 $\\omega_P = P/(\\beta\\hbar)$，我们得到用于计算的公式：\n$$\nR_g^2(P) = \\frac{1}{P \\beta m} \\sum_{k=1}^{P-1} \\frac{1}{\\omega^2 + \\left(\\frac{2P}{\\beta \\hbar} \\sin\\left(\\frac{\\pi k}{P}\\right)\\right)^2}\n$$\n对于 $P=1$ 的特殊情况，求和为空，这正确地得出 $R_g^2(1) = 0$。这在物理上是必然的，因为单个珠子就是其自身的质心。\n\n接下来，我们确定连续极限 $R_g(\\infty)$。在 $P \\to \\infty$ 的极限下，环形聚合物变成虚时 $\\tau \\in [0, \\beta\\hbar]$ 中的一条连续路径 $q(\\tau)$。回旋半径与粒子位置的总方差 $\\langle q^2 \\rangle_{\\text{QM}}$ 和路径质心的方差 $\\langle \\bar{q}^2 \\rangle$ 相关，其中 $\\bar{q} = \\frac{1}{\\beta\\hbar} \\int_0^{\\beta\\hbar} q(\\tau)d\\tau$。关系式为：\n$$\nR_g^2(\\infty) = \\langle q^2 \\rangle_{\\text{QM}} - \\langle \\bar{q}^2 \\rangle\n$$\n谐振子的总量子热方差是统计力学中的一个标准结果：\n$$\n\\langle q^2 \\rangle_{\\text{QM}} = \\frac{\\hbar}{2m\\omega} \\coth\\left(\\frac{\\beta \\hbar \\omega}{2}\\right)\n$$\n质心的方差对应于粒子在势中的经典热方差，因为质心代表了路径的“类经典”自由度：\n$$\n\\langle \\bar{q}^2 \\rangle = \\frac{1}{\\beta m \\omega^2} = \\frac{k_B T}{m \\omega^2}\n$$\n结合这些结果，得到回旋半径平方的精确量子极限：\n$$\nR_g^2(\\infty) = \\frac{\\hbar}{2m\\omega} \\coth\\left(\\frac{\\beta \\hbar \\omega}{2}\\right) - \\frac{1}{\\beta m \\omega^2}\n$$\n为了方便数值实现，最好将其重写为：\n$$\nR_g^2(\\infty) = \\frac{1}{\\beta m \\omega^2} \\left( \\frac{\\beta \\hbar \\omega}{2} \\coth\\left(\\frac{\\beta \\hbar \\omega}{2}\\right) - 1 \\right)\n$$\n当双曲余切的自变量很小时，这种形式在数值上更稳定。\n\n最终任务是计算绝对差 $\\Delta R_g(P) = |R_g(P) - R_g(\\infty)|$。算法如下：\n1.  对于给定的参数集 $(m, \\omega, T, P)$，计算 $\\beta = 1/(k_B T)$。\n2.  使用求和公式计算 $R_g^2(P)$。如果 $P=1$，则 $R_g^2(1)=0$。\n3.  使用闭合形式表达式计算 $R_g^2(\\infty)$。\n4.  计算平方根：$R_g(P) = \\sqrt{R_g^2(P)}$ 和 $R_g(\\infty) = \\sqrt{R_g^2(\\infty)}$。\n5.  确定绝对差 $\\Delta R_g(P) = |R_g(P) - R_g(\\infty)|$。\n将此过程应用于提供的每个测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Computes the difference between finite-P and infinite-P RPMD radius of\n    gyration for a harmonic oscillator.\n    \"\"\"\n    \n    # Define physical constants from scipy\n    k_B = constants.k\n    hbar = constants.hbar\n\n    def calculate_delta_Rg(m, omega, T, P):\n        \"\"\"\n        Calculates the absolute difference |R_g(P) - R_g(infinity)|.\n\n        Args:\n            m (float): Mass of the particle in kg.\n            omega (float): Angular frequency of the harmonic potential in s^-1.\n            T (float): Temperature in Kelvin.\n            P (int): Number of beads in the ring polymer.\n        \n        Returns:\n            float: The absolute difference in meters.\n        \"\"\"\n        if not isinstance(P, int) or P  1:\n            raise ValueError(\"Number of beads P must be a positive integer.\")\n\n        beta = 1.0 / (k_B * T)\n\n        # 1. Compute R_g(P) for a finite number of beads P.\n        if P == 1:\n            # For a single bead, the bead is its own centroid, so Rg is zero.\n            Rg_P_sq = 0.0\n        else:\n            omega_P = P / (beta * hbar)\n            k_values = np.arange(1, P)\n            \n            # Frequencies of the non-zero normal modes\n            sin_term = np.sin(np.pi * k_values / P)\n            Omega_k_sq = omega**2 + (2 * omega_P * sin_term)**2\n            \n            # Sum over the inverse squared frequencies\n            sum_term = np.sum(1.0 / Omega_k_sq)\n            \n            Rg_P_sq = (1.0 / (P * beta * m)) * sum_term\n            \n        Rg_P = np.sqrt(Rg_P_sq)\n\n        # 2. Compute R_g(infinity), the exact quantum limit.\n        # This is derived from the exact path integral expression.\n        # R_g^2(inf) = (hbar/(2*m*omega))*coth(beta*hbar*omega/2) - 1/(beta*m*omega^2)\n        # For numerical stability, we use the form:\n        # R_g^2(inf) = (1/(beta*m*omega^2)) * (x*coth(x) - 1)\n        # where x = beta*hbar*omega/2\n        \n        x = beta * hbar * omega / 2.0\n\n        if x  1e-6:\n            # Use Taylor series for x*coth(x)-1 for small x to avoid 0/0 and precision loss.\n            # x*coth(x) - 1 ~ x^2/3 - x^4/45 + ...\n            term = (x**2 / 3.0) - (x**4 / 45.0)\n        else:\n            term = x * (np.cosh(x) / np.sinh(x)) - 1.0\n\n        Rg_inf_sq = (1.0 / (beta * m * omega**2)) * term\n        Rg_inf = np.sqrt(Rg_inf_sq)\n\n        # 3. Compute the absolute difference.\n        delta_Rg = np.abs(Rg_P - Rg_inf)\n        \n        return delta_Rg\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test 1 (boundary case: single bead)\n        (1.6735575e-27, 1.0e14, 300.0, 1),\n        # Test 2 (happy path: modest P)\n        (1.6735575e-27, 1.0e14, 300.0, 8),\n        # Test 3 (convergence check: large P)\n        (1.6735575e-27, 1.0e14, 300.0, 128),\n        # Test 4 (low temperature and heavier mass)\n        (1.0e-26, 5.0e13, 100.0, 16),\n        # Test 5 (stiffer potential at low temperature)\n        (1.6735575e-27, 5.0e14, 50.0, 32),\n    ]\n\n    results = []\n    for case in test_cases:\n        m_val, omega_val, T_val, P_val = case\n        result = calculate_delta_Rg(m_val, omega_val, T_val, P_val)\n        # Format the result to scientific notation with 6 decimal places.\n        results.append(f\"{result:.6e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2461772"}, {"introduction": "在理解了静态的环状聚合物图像后，我们现在通过模拟其实时动力学来赋予它“生命”。这个综合性练习将指导你从第一性原理出发，构建一个最小化的环状聚合物分子动力学（RPMD）模拟器 [@problem_id:2461801]。你将推导运动方程并使用正交模坐标实现一个高效的积分器，从而揭开RPMD模拟内部工作原理的神秘面纱。", "problem": "要求您为一个在一维谐波势中的粒子实现一个最小化的环状聚合物分子动力学（Ring Polymer Molecular Dynamics, RPMD）模拟器。其目标是：从第一性原理出发，推导环状聚合物珠子（bead）的运动方程；构建一个正交归一的简正模变换，以对角化珠子间的弹簧耦合；并设计一个辛积分器，利用这些简正模来计算内部弹簧力。随后，您将使用您的实现来生成可用于评估正确性和稳定性的量化诊断指标。所有物理量都将在无量纲单位制下处理，其中质量、约化普朗克常数和玻尔兹曼常数均设为1，即 $m = 1$, $\\hbar = 1$ 和 $k_{\\mathrm{B}} = 1$。\n\n基本原理：\n- 在逆温 $\\beta = 1/(k_{\\mathrm{B}} T)$下，质量为 $m$ 的单个粒子的量子正则配分函数的路径积分离散化，可以映射为一个包含 $P$ 个珠子的经典环状聚合物。该环状聚合物（在一维情况下）的有效经典哈密顿量是三部分贡献之和：珠子的动能、频率参数为 $\\omega_{P}$ 的珠子间谐波弹簧，以及逐个珠子计算的物理势能。\n- 珠子间的弹簧参数定义为 $\\omega_{P} = \\dfrac{P}{\\beta \\hbar}$。\n- 此处考虑的谐波物理势为 $V(q) = \\dfrac{1}{2}\\,k\\,q^{2}$，其中 $k  0$ 且 $q \\in \\mathbb{R}$。\n\n任务 A（推导）：\n1. 从环状聚合物的哈密顿量出发，推导珠子位置 $q_{j}(t)$ 和速度 $v_{j}(t)$ 的运动方程，其中 $j \\in \\{0,1,\\dots,P-1\\}$，并采用周期性索引 $q_{j+P} \\equiv q_{j}$。\n2. 构建一个正交归一的简正模变换矩阵，以对角化与环状聚合物弹簧对应的离散拉普拉斯算子，并推导出相应的简正模弹簧频率集合。您的推导必须明确说明变换的结构（包括简并性）以及珠子坐标与简正模坐标之间的映射关系。\n\n任务 B（算法设计）：\n3. 为珠子坐标空间中的珠子运动方程设计一个时间可逆的辛速度-Verlet积分器，但内部弹簧力的计算方式如下：将珠子坐标变换到简正模，在简正模空间中施加对角化的弹簧力，然后再变换回珠子坐标空间。外部物理力为 $-\\,\\mathrm{d}V/\\mathrm{d}q$，独立地施加在珠子坐标空间中的每个珠子上。请明确说明总力的构成方式。\n4. 推导环状聚合物瞬时总能量的表达式，其形式为动能、弹簧能和物理势能之和。\n\n任务 C（谐波势的解析检验）：\n5. 对于谐波势 $V(q) = \\dfrac{1}{2}\\,k\\,q^{2}$，证明在初始内部模式为零的情况下，质心坐标 $q_{\\mathrm{c}}(t) = \\dfrac{1}{P}\\sum_{j=0}^{P-1} q_{j}(t)$ 的演化如同一个具有物理频率 $\\omega = \\sqrt{k/m}$ 的独立谐振子。因此，当初始质心位置为 $q_{\\mathrm{c}}(0) = q_{0}$ 且初始质心速度为 $\\dot{q}_{\\mathrm{c}}(0) = v_{0}$ 时，其精确解为\n$$\nq_{\\mathrm{c}}^{\\mathrm{exact}}(t) = q_{0}\\,\\cos(\\omega t) + \\frac{v_{0}}{\\omega}\\,\\sin(\\omega t).\n$$\n使用此解作为基准来定义一个量化的误差度量。\n\n任务 D（实现与测试套件）：\n6. 实现一个完整、可运行的 Python 程序，该程序能够：\n   - 构建所需的简正模变换，\n   - 实现使用简正模计算弹簧力的速度-Verlet时间积分器，\n   - 为指定案例模拟环状聚合物动力学，\n   - 记录质心 $q_{\\mathrm{c}}(t)$ 随时间的变化，\n   - 计算总能量随时间的变化。\n\n7. 定义以下三个确定性测试案例，每个案例的初始珠子位置对所有 $j$ 均为 $q_{j}(0) = q_{0}$，初始珠子速度对所有 $j$ 均为 $v_{j}(0) = v_{0}$。在所有案例中均使用 $m=1$，并在 $\\omega_{P}$ 的表达式中使用温度 $T$。在所选单位制中，将所有量视为无量纲数。\n   - 案例 1（正常路径）：$k = 1.0$, $P = 16$, $T = 0.2$, $q_{0} = 1.0$, $v_{0} = 0.0$，时间步长 $\\Delta t = 0.002$，总积分时间 $t_{\\mathrm{tot}} = 2\\pi$。\n   - 案例 2（边界情况，经典极限）：$k = 1.0$, $P = 1$, $T = 0.2$, $q_{0} = 1.0$, $v_{0} = 0.0$，时间步长 $\\Delta t = 0.002$，总积分时间 $t_{\\mathrm{tot}} = 2\\pi$。\n   - 案例 3（更刚性的内部模式）：$k = 1.0$, $P = 32$, $T = 0.2$, $q_{0} = 1.0$, $v_{0} = 0.0$，时间步长 $\\Delta t = 0.001$，总积分时间 $t_{\\mathrm{tot}} = 2\\pi$。\n\n8. 对每个案例，计算两个标量诊断指标：\n   - 轨迹上的最大绝对质心误差，定义为\n     $$\n     \\max_{n} \\left| q_{\\mathrm{c}}(t_{n}) - q_{\\mathrm{c}}^{\\mathrm{exact}}(t_{n}) \\right|,\n     $$\n     其中 $t_{n} = n\\,\\Delta t$。\n   - 轨迹上的相对能量漂移，定义为\n     $$\n     \\frac{\\max_{n} E(t_{n}) - \\min_{n} E(t_{n})}{E(0)}.\n     $$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中按顺序包含三个案例的六个结果，格式为方括号内以逗号分隔的列表：\n  $[e_{1},d_{1},e_{2},d_{2},e_{3},d_{3}]$，\n  其中 $e_{i}$ 是案例 $i$ 的最大绝对质心误差，$d_{i}$ 是案例 $i$ 的相对能量漂移。\n- 所有输出均为无量纲实数。无需报告以度或弧度为单位的角度，因为只有角频率在动力学内部起作用。将数值打印为十进制浮点数。\n\n关于可视化的说明：尽管程序必须在内部实现简正模坐标，但它不应进行绘图，而是应计算并内部保留一系列时间点上的珠子位置，从而使轨迹适合下游工具进行可视化。最终的打印输出必须严格遵守上述单行格式。", "solution": "该问题已经过严格验证，被认为是科学上合理、定义明确且客观的。它构成了计算化学中的一个标准练习，基于成熟的环状聚合物分子动力学（Ring Polymer Molecular Dynamics, RPMD）框架。所有必要的参数和定义均已提供。因此，我们可以开始进行解答。\n\n解答分为四个部分，与问题陈述的划分一致：（A）运动方程和简正模变换的推导，（B）数值积分器的设计，（C）谐波势的解析检验，以及（D）数值模拟的实现细节。我们将使用一个无量纲单位制，其中质量 $m=1$、约化普朗克常数 $\\hbar=1$ 和玻尔兹曼常数 $k_{\\mathrm{B}}=1$。\n\n### 任务 A：推导\n\n**1. 运动方程**\n\n一个含 $P$ 个珠子的一维环状聚合物的经典同构哈密顿量由下式给出：\n$$\nH(\\mathbf{q}, \\mathbf{p}) = \\sum_{j=0}^{P-1} \\frac{p_j^2}{2m} + \\sum_{j=0}^{P-1} \\frac{1}{2} m \\omega_P^2 (q_j - q_{j-1})^2 + \\sum_{j=0}^{P-1} V(q_j)\n$$\n其中 $\\mathbf{q} = (q_0, \\dots, q_{P-1})$ 和 $\\mathbf{p} = (p_0, \\dots, p_{P-1})$ 分别是珠子的位置和动量。珠子索引是周期性的，即 $q_{-1} \\equiv q_{P-1}$。参数 $\\omega_P = \\frac{P}{\\beta \\hbar}$，其中 $\\beta = 1/(k_{\\mathrm{B}}T)$。在我们选择的单位制中，这简化为 $\\omega_P = PT$。\n\n哈密顿运动方程控制着动力学：\n$$\n\\dot{q}_j = \\frac{\\partial H}{\\partial p_j} \\quad \\text{和} \\quad \\dot{p}_j = -\\frac{\\partial H}{\\partial q_j}\n$$\n第一个方程给出了速度：\n$$\n\\dot{q}_j = v_j = \\frac{p_j}{m}\n$$\n第二个方程给出了动量的时间导数，即珠子 $j$ 上受到的力 $F_j$：\n$$\n\\dot{p}_j = F_j = -\\frac{\\partial}{\\partial q_j} \\left( \\sum_{k=0}^{P-1} \\frac{1}{2} m \\omega_P^2 (q_k - q_{k-1})^2 + \\sum_{k=0}^{P-1} V(q_k) \\right)\n$$\n总力 $F_j$ 是内部弹簧力 $F_j^{\\text{spring}}$ 和外部物理力 $F_j^{\\text{ext}}$ 的和。外部力很简单：\n$$\nF_j^{\\text{ext}} = -\\frac{\\partial}{\\partial q_j} \\sum_{k=0}^{P-1} V(q_k) = -\\frac{\\mathrm{d}V(q_j)}{\\mathrm{d}q_j}\n$$\n对于弹簧力，我们对弹簧势能项进行微分。求和中依赖于 $q_j$ 的项是索引为 $k=j$ 和 $k=j+1$ 的项：\n$$\nF_j^{\\text{spring}} = -\\frac{\\partial}{\\partial q_j} \\left( \\frac{1}{2} m \\omega_P^2 (q_j - q_{j-1})^2 + \\frac{1}{2} m \\omega_P^2 (q_{j+1} - q_j)^2 \\right) \\\\\n= -m \\omega_P^2 \\left( (q_j - q_{j-1}) - (q_{j+1} - q_j) \\right) \\\\\n= -m \\omega_P^2 (2q_j - q_{j-1} - q_{j+1})\n$$\n因此，珠子位置的运动方程由 $m\\ddot{q}_j = F_j$ 给出：\n$$\nm\\ddot{q}_j = -m \\omega_P^2 (2q_j - q_{j-1} - q_{j+1}) - \\frac{\\mathrm{d}V(q_j)}{\\mathrm{d}q_j}\n$$\n其中 $j = 0, 1, \\dots, P-1$。\n\n**2. 简正模变换**\n\n弹簧势能 $U_{\\text{spring}} = \\frac{1}{2} m \\omega_P^2 \\sum_{j=0}^{P-1} (q_j - q_{j-1})^2$，可以表示为二次型 $U_{\\text{spring}} = \\frac{1}{2} m \\omega_P^2 \\mathbf{q}^T \\mathbf{A} \\mathbf{q}$，其中 $\\mathbf{A}$ 是代表离散拉普拉斯算子的 $P \\times P$ 循环矩阵：\n$$\n\\mathbf{A} = \\begin{pmatrix} 2  -1  0  \\dots  -1 \\\\ -1  2  -1  \\dots  0 \\\\ \\vdots  \\ddots  \\ddots  \\ddots  \\vdots \\\\ 0  \\dots  -1  2  -1 \\\\ -1  0  \\dots  -1  2 \\end{pmatrix}\n$$\n简正模由对角化 $\\mathbf{A}$ 的变换定义。循环矩阵的特征向量是离散傅里叶基向量。对应于第 $k$ 个模式的特征值 $\\lambda_k$ 由下式给出：\n$$\n\\lambda_k = 2 - 2\\cos\\left(\\frac{2\\pi k}{P}\\right) = 4\\sin^2\\left(\\frac{\\pi k}{P}\\right) \\quad \\text{其中 } k = 0, 1, \\dots, P-1\n$$\n注意 $\\lambda_k = \\lambda_{P-k}$，这导致当 $k \\neq 0$ 和 $k \\neq P/2$ 时出现简并。为了获得一个实的正交归一变换矩阵 $\\mathbf{C}$，我们构建复特征向量的线性组合：\n- **质心模式 ($k=0$)：** 该模式的特征值为 $\\lambda_0 = 0$，对应于整个环的均匀平移。$\\mathbf{C}$ 的列向量为：\n  $$ C_{j0} = \\frac{1}{\\sqrt{P}} $$\n- **内部模式 ($k=1, \\dots, \\lfloor(P-1)/2\\rfloor$)：** 对于每个 $k$，我们从简并的复数对中构建一对实特征向量：\n  $$ C^{\\text{cos}}_{jk} = \\sqrt{\\frac{2}{P}} \\cos\\left(\\frac{2\\pi j k}{P}\\right), \\quad C^{\\text{sin}}_{jk} = \\sqrt{\\frac{2}{P}} \\sin\\left(\\frac{2\\pi j k}{P}\\right) $$\n- **奈奎斯特模式 (如果 $P$ 是偶数, $k=P/2$)：** 这个唯一的、非简并的模式具有特征值 $\\lambda_{P/2} = 4$。其特征向量对应于珠子的交替位移：\n  $$ C_{j, P/2} = \\frac{1}{\\sqrt{P}}(-1)^j $$\n\n令 $\\tilde{\\mathbf{q}}$ 为简正模坐标的向量。变换关系为 $\\mathbf{q} = \\mathbf{C}\\tilde{\\mathbf{q}}$ 和 $\\tilde{\\mathbf{q}} = \\mathbf{C}^T\\mathbf{q}$。在这个基底下，弹簧势能变为对角化的：\n$$\nU_{\\text{spring}} = \\frac{1}{2} m \\omega_P^2 \\tilde{\\mathbf{q}}^T (\\mathbf{C}^T\\mathbf{A}\\mathbf{C}) \\tilde{\\mathbf{q}} = \\frac{1}{2} m \\omega_P^2 \\sum_{k=0}^{P-1} \\lambda_k \\tilde{q}_k^2 = \\sum_{k=0}^{P-1} \\frac{1}{2} m \\Omega_k^2 \\tilde{q}_k^2\n$$\n因此，简正模弹簧频率 $\\Omega_k$ 为：\n$$\n\\Omega_k = \\sqrt{\\omega_P^2 \\lambda_k} = 2\\omega_P \\left|\\sin\\left(\\frac{\\pi k}{P}\\right)\\right|\n$$\n其中 $k = 0, 1, \\dots, P-1$。质心模式的频率为 $\\Omega_0 = 0$。\n\n### 任务 B：算法设计\n\n**3. 辛积分器**\n\n我们采用速度-Verlet算法，该算法是时间可逆且辛的。从 $t$ 到 $t+\\Delta t$ 的单个时间步按以下步骤进行：\n1. 更新速度半步： $\\mathbf{v}(t + \\Delta t/2) = \\mathbf{v}(t) + \\frac{\\mathbf{F}(\\mathbf{q}(t))}{m} \\frac{\\Delta t}{2}$\n2. 更新位置一整步： $\\mathbf{q}(t + \\Delta t) = \\mathbf{q}(t) + \\mathbf{v}(t + \\Delta t/2) \\Delta t$\n3. 在新位置计算力 $\\mathbf{F}(\\mathbf{q}(t + \\Delta t))$。\n4. 更新速度第二个半步： $\\mathbf{v}(t + \\Delta t) = \\mathbf{v}(t + \\Delta t/2) + \\frac{\\mathbf{F}(\\mathbf{q}(t+\\Delta t))}{m} \\frac{\\Delta t}{2}$\n\n总力 $\\mathbf{F}$ 由外力和弹簧力组成，$\\mathbf{F} = \\mathbf{F}^{\\text{ext}} + \\mathbf{F}^{\\text{spring}}$。\n- 外力在珠子坐标空间中计算：$F_j^{\\text{ext}} = -\\frac{\\mathrm{d}V(q_j)}{\\mathrm{d}q_j}$。\n- 弹簧力在简正模空间中高效计算：\n    a. 将珠子坐标变换到简正模：$\\tilde{\\mathbf{q}} = \\mathbf{C}^T \\mathbf{q}$。\n    b. 在简正模空间中计算对角化的弹簧力：$\\tilde{F}_k^{\\text{spring}} = -m \\Omega_k^2 \\tilde{q}_k$。\n    c. 将力变换回珠子坐标空间：$\\mathbf{F}^{\\text{spring}} = \\mathbf{C} \\tilde{\\mathbf{F}}^{\\text{spring}}$。\n\n**4. 总能量**\n\n瞬时总能量 $E(t)$ 是动能、弹簧势能和物理势能之和：\n$$\nE(t) = K(t) + U_{\\text{spring}}(t) + U_{\\text{phys}}(t)\n$$\n其中：\n- 动能：$K(t) = \\sum_{j=0}^{P-1} \\frac{1}{2}m v_j(t)^2$\n- 弹簧势能：$U_{\\text{spring}}(t) = \\frac{1}{2} m \\omega_P^2 \\sum_{j=0}^{P-1} (q_j(t) - q_{j-1}(t))^2$\n- 物理势能：$U_{\\text{phys}}(t) = \\sum_{j=0}^{P-1} V(q_j(t))$\n对于给定的势 $V(q) = \\frac{1}{2}kq^2$，这变为 $U_{\\text{phys}}(t) = \\frac{1}{2}k\\sum_{j=0}^{P-1} q_j(t)^2$。此表达式用于监控能量守恒。\n\n### 任务 C：谐波势的解析检验\n\n**5. 质心运动的解耦**\n\n对于谐波势 $V(q) = \\frac{1}{2}kq^2$，珠子 $j$ 上的外力为 $F_j^{\\text{ext}} = -kq_j$。对所有珠子 $j=0, \\dots, P-1$ 的运动方程求和：\n$$\nm \\sum_{j=0}^{P-1} \\ddot{q}_j = \\sum_{j=0}^{P-1} F_j^{\\text{spring}} + \\sum_{j=0}^{P-1} F_j^{\\text{ext}}\n$$\n由于内部弹簧力的成对性质和周期性边界条件，其总和为零：\n$$\n\\sum_{j=0}^{P-1} F_j^{\\text{spring}} = -m\\omega_P^2 \\sum_{j=0}^{P-1} (2q_j - q_{j-1} - q_{j+1}) = 0\n$$\n外力的总和为：\n$$\n\\sum_{j=0}^{P-1} F_j^{\\text{ext}} = \\sum_{j=0}^{P-1} (-kq_j) = -k \\sum_{j=0}^{P-1} q_j\n$$\n将质心坐标定义为 $q_{\\mathrm{c}}(t) = \\frac{1}{P}\\sum_{j=0}^{P-1} q_j(t)$，求和式变为 $mP\\ddot{q}_{\\mathrm{c}} = -kPq_{\\mathrm{c}}$，简化后得到：\n$$\nm\\ddot{q}_{\\mathrm{c}}(t) + k q_{\\mathrm{c}}(t) = 0\n$$\n这是一个频率为 $\\omega = \\sqrt{k/m}$ 的独立谐振子的方程。所有珠子的初始条件 $q_j(0) = q_0$ 和 $v_j(0) = v_0$ 意味着质心从 $q_{\\mathrm{c}}(0) = q_0$ 开始，初始速度为 $\\dot{q}_{\\mathrm{c}}(0) = v_0$。因此，精确解为：\n$$\nq_{\\mathrm{c}}^{\\mathrm{exact}}(t) = q_{0}\\cos(\\omega t) + \\frac{v_{0}}{\\omega}\\sin(\\omega t)\n$$\n这为验证数值积分提供了一个精确的基准。通过将所有珠子的 $q_j(0)$ 和 $v_j(0)$ 设置为常数值，可以满足初始内部模式为零的条件，这确保了初始时只有质心模式（$k=0$）被占据。由于谐波势的线性特性，简正模在任何时候都保持解耦，内部模式也保持未被激发的状态。\n\n### 任务 D：实现\n\n实现遵循上述设计。构建一个Python程序来创建变换矩阵 $\\mathbf{C}$，实现使用简正模弹簧力的速度-Verlet积分器，并模拟给定的测试案例。对每个案例，计算并报告最大绝对质心误差和相对能量漂移。代码在最终答案部分提供。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a minimal Ring Polymer Molecular Dynamics (RPMD) simulator\n    for a 1D harmonic oscillator, computes diagnostic quantities for\n    predefined test cases, and prints the results in the specified format.\n    \"\"\"\n\n    def build_normal_mode_transform(P):\n        \"\"\"Constructs the real orthonormal normal-mode transformation matrix C.\"\"\"\n        if P == 0:\n            return np.array([[]])\n        \n        C = np.zeros((P, P))\n        j_indices = np.arange(P)\n\n        # k=0 (centroid)\n        C[:, 0] = 1.0 / np.sqrt(P)\n\n        # k=1... (cos/sin pairs)\n        for k in range(1, (P + 1) // 2):\n            # The matrix columns are indexed 0 to P-1. We map physical k to column indices.\n            # k=1 - cols 1,2; k=2 - cols 3,4 etc.\n            col_idx_cos = 2 * k - 1\n            col_idx_sin = 2 * k\n            C[:, col_idx_cos] = np.sqrt(2.0/P) * np.cos(2 * np.pi * k * j_indices / P)\n            C[:, col_idx_sin] = np.sqrt(2.0/P) * np.sin(2 * np.pi * k * j_indices / P)\n\n        # k=P/2 (Nyquist mode, if P is even)\n        if P % 2 == 0 and P  1:\n            col_idx_nyquist = P - 1\n            C[:, col_idx_nyquist] = (1.0 / np.sqrt(P)) * ((-1)**j_indices)\n            \n        return C\n\n    def get_spring_force_coeffs(P, T, m):\n        \"\"\"\n        Computes the diagonal coefficients m*Omega_k^2 for the spring force\n        in the normal-mode representation.\n        \"\"\"\n        if P = 1:\n            return np.zeros(P)\n        \n        # In dimensionless units, hbar=1, kB=1, so beta=1/T and omega_P = P*T.\n        omega_P = P * T\n        m_Omega_sq = np.zeros(P)\n\n        # The coefficients are ordered according to the columns of C.\n        # k=0 (centroid) - col 0 - Omega_0 = 0\n        m_Omega_sq[0] = 0.0\n\n        # k=1... (cos/sin pairs)\n        for k in range(1, (P + 1) // 2):\n            freq_sq = (2 * omega_P * np.sin(np.pi * k / P))**2\n            col_idx_cos = 2 * k - 1\n            col_idx_sin = 2 * k\n            m_Omega_sq[col_idx_cos] = m * freq_sq\n            m_Omega_sq[col_idx_sin] = m * freq_sq\n        \n        # k=P/2 (Nyquist mode, if P is even)\n        if P % 2 == 0 and P  1:\n            k_nyquist = P // 2\n            freq_sq = (2 * omega_P * np.sin(np.pi * k_nyquist / P))**2\n            col_idx_nyquist = P - 1\n            m_Omega_sq[col_idx_nyquist] = m * freq_sq\n            \n        return m_Omega_sq\n    \n    def calculate_total_energy(q, v, k, m, P, T):\n        \"\"\"Calculates the total instantaneous energy of the ring polymer.\"\"\"\n        K = 0.5 * m * np.sum(v**2)\n        U_phys = 0.5 * k * np.sum(q**2)\n        \n        if P  1:\n            omega_P = P * T\n            # Use np.roll for periodic boundary condition q_j - q_{j-1}\n            U_spring = 0.5 * m * omega_P**2 * np.sum((q - np.roll(q, 1))**2)\n        else:\n            U_spring = 0.0\n            \n        return K + U_phys + U_spring\n\n    def run_simulation(k, P, T, q0, v0, dt, t_tot):\n        \"\"\"\n        Runs a single RPMD simulation and returns the diagnostic metrics.\n        \"\"\"\n        m = 1.0 # Mass is 1 in the specified unit system\n        omega_phys = np.sqrt(k / m)\n        \n        # Initialization\n        q = np.full(P, q0, dtype=float)\n        v = np.full(P, v0, dtype=float)\n        \n        # Pre-computation for forces and diagnostics\n        C = build_normal_mode_transform(P)\n        m_Omega_sq_diag = get_spring_force_coeffs(P, T, m)\n        \n        # Simulation time steps\n        times = np.arange(0, t_tot, dt)\n        n_steps = len(times)\n\n        # Storage for diagnostics\n        centroid_traj = np.zeros(n_steps)\n        energy_traj = np.zeros(n_steps)\n        \n        # Initial force calculation for the first Verlet step\n        F_ext = -k * q\n        if P  1:\n            tilde_q = C.T @ q\n            tilde_F_spring = -m_Omega_sq_diag * tilde_q\n            F_spring = C @ tilde_F_spring\n        else:\n            F_spring = np.zeros(P)\n        F = F_spring + F_ext\n\n        # Main integration loop\n        for i, t in enumerate(times):\n            # Record diagnostics at the beginning of the step\n            centroid_traj[i] = np.mean(q)\n            energy_traj[i] = calculate_total_energy(q, v, k, m, P, T)\n            \n            # Velocity-Verlet integrator\n            v += 0.5 * F / m * dt  # 1. First half kick\n            q += v * dt            # 2. Full drift\n            \n            # 3. Recalculate forces at new positions\n            F_ext = -k * q\n            if P  1:\n                tilde_q = C.T @ q\n                tilde_F_spring = -m_Omega_sq_diag * tilde_q\n                F_spring = C @ tilde_F_spring\n            else:\n                F_spring = np.zeros(P)\n            F = F_spring + F_ext\n            \n            v += 0.5 * F / m * dt  # 4. Second half kick\n            \n        # Final diagnostic calculation\n        q_c_exact = q0 * np.cos(omega_phys * times) + (v0 / omega_phys) * np.sin(omega_phys * times)\n        max_centroid_error = np.max(np.abs(centroid_traj - q_c_exact))\n        \n        E0 = energy_traj[0]\n        if np.abs(E0)  1e-12: # Avoid division by zero if initial energy is zero\n             relative_energy_drift = np.max(energy_traj) - np.min(energy_traj)\n        else:\n             relative_energy_drift = (np.max(energy_traj) - np.min(energy_traj)) / E0\n        \n        return max_centroid_error, relative_energy_drift\n\n    # Define test cases from the problem statement\n    test_cases = [\n        # (k, P, T, q0, v0, dt, t_tot)\n        (1.0, 16, 0.2, 1.0, 0.0, 0.002, 2 * np.pi), # Case 1\n        (1.0, 1,  0.2, 1.0, 0.0, 0.002, 2 * np.pi), # Case 2\n        (1.0, 32, 0.2, 1.0, 0.0, 0.001, 2 * np.pi), # Case 3\n    ]\n\n    results = []\n    for case in test_cases:\n        error, drift = run_simulation(*case)\n        results.extend([error, drift])\n\n    # Print results in the specified single-line format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2461801"}, {"introduction": "只有当我们理解了一个强大模拟方法的局限性时，它才真正有用武之地。RPMD动力学可能会受到聚合物链中非物理内部模式的虚假共振影响而产生人为结果。在本练习中，你将反其道而行之，通过有意设计一个物理势，使其频率与聚合物的内部模式发生共振 [@problem_id:2461797]，从而让你对这一重要的人为效应有具体而深刻的理解。", "problem": "一个质量为 $m$ 的一维粒子使用环状聚合物分子动力学 (RPMD) 进行模拟，其中温度为 $T$ 的量子玻尔兹曼分布由一个包含 $P$ 个经典珠子的环状聚合物表示。在自由粒子极限下，相邻的珠子由劲度系数为 $m \\,\\omega_{P}^{2}$ 的谐振弹簧连接，其中 $\\omega_{P} = P k_{B} T / \\hbar$，$k_{B}$ 是玻尔兹曼常数，$\\hbar$ 是约化普朗克常数。考虑在温度 $T=300\\,\\mathrm{K}$ 时，$P=10$，粒子质量 $m = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$。你需要设计一个物理上的一维谐振势 $V(x) = \\tfrac{1}{2} k x^{2}$，使得粒子在该势中的经典振动角频率等于自由环状聚合物在这些条件下的最高频率内部简正模式，从而故意产生伪共振。\n\n使用 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$ 和 $\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}$，求出实现此共振的力常数 $k$ 的值。答案以 $\\mathrm{N\\,m^{-1}}$ 为单位，并四舍五入至四位有效数字。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 系统：一个质量为 $m$ 的一维粒子。\n- 模拟方法：环状聚合物分子动力学 (RPMD)。\n- 珠子数量：$P$。\n- 温度：$T$。\n- 自由粒子环状聚合物模型：相邻珠子由劲度系数为 $m \\,\\omega_{P}^{2}$ 的谐振弹簧连接。\n- $\\omega_{P}$ 的定义：$\\omega_{P} = P k_{B} T / \\hbar$。\n- 玻尔兹曼常数：$k_{B}$。\n- 约化普朗克常数：$\\hbar$。\n- 珠子数量的具体值：$P=10$。\n- 温度的具体值：$T=300\\,\\mathrm{K}$。\n- 质量的具体值：$m = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$。\n- 外势：$V(x) = \\tfrac{1}{2} k x^{2}$。\n- 共振条件：粒子在 $V(x)$ 中的经典振动角频率等于自由环状聚合物的最高频率内部简正模式。\n- 任务：求出力常数 $k$ 的值。\n- 玻尔兹曼常数的值：$k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n- 约化普朗克常数的值：$\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}$。\n- 要求精度：将答案四舍五入到四位有效数字。\n- 要求单位：$\\mathrm{N\\,m^{-1}}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在环状聚合物分子动力学这一计算化学中用于近似量子动力学的标准技术的既定理论框架内得到了正确表述。环状聚合物简正模式的概念及其与物理频率产生伪共振的可能性是该方法中一种有充分文献记载的人为效应。所给出的方程均为标准方程。\n- **适定性**：该问题是适定的。它提供了一个明确的目标、一个具体的共振条件，以及计算力常数 $k$ 唯一解所需的所有物理常数和参数。\n- **客观性**：语言精确、专业，没有主观或模糊的术语。\n\n**步骤3：结论与行动**\n该问题在科学上合理、适定、客观且完整。因此，判定为**有效**。将提供解答。\n\n目标是求出一维谐振势 $V(x) = \\frac{1}{2}kx^2$ 的力常数 $k$​，使得质量为 $m$ 的粒子在该势中的经典角频率与自由环状聚合物的最高内部振动频率发生共振。\n\n首先，我们确定粒子在给定势中的经典角频率。粒子受到的力由 $F = -\\frac{dV}{dx} = -kx$ 给出。根据牛顿第二定律，$m\\ddot{x} = -kx$，或 $\\ddot{x} + \\frac{k}{m}x = 0$。这是一个简谐振子方程，其角频率 $\\omega_{phys}$ 为：\n$$\n\\omega_{phys} = \\sqrt{\\frac{k}{m}}\n$$\n\n接下来，我们必须确定自由环状聚合物的简正模式频率。由 $P$ 个位置为 $\\{x_j\\}_{j=1}^P$ 的珠子组成的环状聚合物的势能由相邻珠子之间的谐振相互作用之和给出：\n$$\nU(\\{x_j\\}) = \\frac{1}{2}m\\omega_{P}^2 \\sum_{j=1}^{P} (x_j - x_{j+1})^2\n$$\n其中施加了周期性边界条件 $x_{P+1} = x_1$。第 $j$ 个珠子的运动方程为：\n$$\nm\\ddot{x}_j = -\\frac{\\partial U}{\\partial x_j} = -m\\omega_{P}^2 \\left( (x_j - x_{j-1}) - (x_j - x_{j+1}) \\right) = m\\omega_{P}^2 (x_{j-1} - 2x_j + x_{j+1})\n$$\n我们寻求形式为 $x_j(t) \\propto \\exp(i(qj - \\Omega t))$ 的简正模式解，其中 $q$ 是波矢，$\\Omega$ 是模式频率。由于周期性边界条件，允许的波矢为 $q_k = \\frac{2\\pi k}{P}$，其中 $k \\in \\{0, 1, ..., P-1\\}$。将此形式代入运动方程，得到简正模式频率 $\\Omega_k$ 的色散关系：\n$$\n-m\\Omega_k^2 = m\\omega_{P}^2 \\left( e^{-iq_k} - 2 + e^{iq_k} \\right) = m\\omega_{P}^2 \\left( 2\\cos(q_k) - 2 \\right)\n$$\n$$\n\\Omega_k^2 = 2\\omega_{P}^2 (1 - \\cos(q_k)) = 2\\omega_{P}^2 \\left( 2\\sin^2\\left(\\frac{q_k}{2}\\right) \\right) = 4\\omega_{P}^2 \\sin^2\\left(\\frac{\\pi k}{P}\\right)\n$$\n因此，简正模式频率为：\n$$\n\\Omega_k = 2\\omega_{P} \\left|\\sin\\left(\\frac{\\pi k}{P}\\right)\\right|, \\quad k = 0, 1, \\ldots, P-1\n$$\n$k=0$ 对应的模式为 $\\Omega_0 = 0$。这是质心模式，代表整个聚合物的整体平移，不是内部振动。内部模式对应于 $k=1, 2, \\ldots, P-1$。我们关心的是最高频率的内部模式。函数 $\\sin(\\theta)$ 在区间 $[0, \\pi]$ 上于 $\\theta=\\frac{\\pi}{2}$ 处取得最大值。对于给定的珠子数 $P=10$（为偶数），当 $k=\\frac{P}{2}=5$ 时，自变量 $\\frac{\\pi k}{P}$ 等于 $\\frac{\\pi}{2}$。\n这给出了最大频率：\n$$\n\\Omega_{max} = \\Omega_{k=P/2} = 2\\omega_{P} \\sin\\left(\\frac{\\pi (P/2)}{P}\\right) = 2\\omega_{P} \\sin\\left(\\frac{\\pi}{2}\\right) = 2\\omega_{P}\n$$\n共振条件要求 $\\omega_{phys} = \\Omega_{max}$。\n$$\n\\sqrt{\\frac{k}{m}} = 2\\omega_{P}\n$$\n已知 $\\omega_{P} = \\frac{P k_{B} T}{\\hbar}$。将其代入共振条件：\n$$\n\\sqrt{\\frac{k}{m}} = 2 \\left(\\frac{P k_{B} T}{\\hbar}\\right)\n$$\n求解力常数 $k$：\n$$\nk = m \\left(2 \\frac{P k_{B} T}{\\hbar}\\right)^2 = \\frac{4 m P^2 k_{B}^2 T^2}{\\hbar^2}\n$$\n现在，我们将给定的数值代入此表达式：\n$P = 10$\n$T = 300\\,\\mathrm{K}$\n$m = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$\n$k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$\n$\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}$\n\n$$\nk = \\frac{4 (1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}) (10)^2 (1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}})^2 (300\\,\\mathrm{K})^2}{(1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s})^2}\n$$\n我们来计算这个值：\n$$\nk = \\frac{4 \\times (1.66053906660 \\times 10^{-27}) \\times 100 \\times (1.9061916... \\times 10^{-46}) \\times 90000}{1.1121196... \\times 10^{-68}} \\,\\mathrm{N\\,m^{-1}}\n$$\n$$\nk = \\frac{1.1398772... \\times 10^{-65}}{1.1121196... \\times 10^{-68}} \\,\\mathrm{N\\,m^{-1}}\n$$\n$$\nk \\approx 1.0249588 \\times 10^3 \\,\\mathrm{N\\,m^{-1}} = 1024.9588 \\,\\mathrm{N\\,m^{-1}}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nk \\approx 1025 \\,\\mathrm{N\\,m^{-1}}\n$$\n这个力常数值所创建的谐振势，其频率与此系统中 RPMD 内部模式的最高、也是最有问题的伪频率相匹配。", "answer": "$$\n\\boxed{1025}\n$$", "id": "2461797"}]}