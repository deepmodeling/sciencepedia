{"hands_on_practices": [{"introduction": "我们的第一个动手实践将带领你进入计算酶催化的核心问题：一个特定的底物结合模式是否具备催化活性？我们将使用经验价键 (Empirical Valence Bond, EVB) 方法，这是一种在保持量子力学精髓的同时简化计算的强大QM/MM模型。通过这个练习，你将学习如何构建一个反应的势能面，计算活化能，并利用过渡态理论估算反应速率，从而对一个常见的科研问题——“这个结合模式是否能有效反应？”——给出定量的回答 [@problem_id:2452864]。", "problem": "要求您编写一个完整的程序，在一个简化的量子力学/分子力学 (QM/MM) 框架内，评估一个提出的底物在酶活性位点中的结合构象是否具有催化所需的动力学能力。目标是使用一个源于量子力学和过渡态理论的原理模型，对代表不同构象的几组参数集，判断其计算出的转换速率是否至少达到一个指定的阈值。\n\n假设以下物理和建模原理为基本基础：\n\n- Born–Oppenheimer 近似指出，电子和原子核的运动可以分离。沿反应坐标 $x$ 的反应电子能量可以通过一个经验价键 (Empirical Valence Bond, EVB) 双态哈密顿量进行建模，该哈密顿量将 QM/MM 能量近似为一个 $2 \\times 2$ 矩阵，其非绝热态（diabatic states）代表嵌入在固定分子力学 (MM) 环境中的类反应物和类产物构型。\n- 非绝热势能定义如下：\n  $$U_1(x) = \\tfrac{1}{2} k_1 (x - x_1)^2 + s_1 (x - x_{\\mathrm{ref}}) + c_1,$$\n  $$U_2(x) = \\Delta_0 + \\tfrac{1}{2} k_2 (x - x_2)^2 + s_2 (x - x_{\\mathrm{ref}}) + c_2,$$\n  其中 $x$ 是一维反应坐标，单位为 $\\mathrm{\\AA}$；$k_1$ 和 $k_2$ 是谐波曲率，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$；$x_1$ 和 $x_2$ 是非绝热势能最小值的位置，单位为 $\\mathrm{\\AA}$；$s_1$ 和 $s_2$ 是线性耦合项，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-1}$，用于模拟沿 $x$ 的环境极化；$x_{\\mathrm{ref}}$ 是一个参考位置，单位为 $\\mathrm{\\AA}$；$c_1$ 和 $c_2$ 是常数偏移，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$；$\\Delta_0$ 是受环境影响的非绝热能量偏移，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。恒定的非绝热耦合项是 $V$，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n- 绝热下表面 $E_{-}(x)$ 代表沿 $x$ 的 Born–Oppenheimer 基态势能，是哈密顿量\n  $$\\mathbf{H}(x) = \\begin{pmatrix} U_1(x) & V \\\\ V & U_2(x) \\end{pmatrix},$$\n  的较低特征值，由下式给出：\n  $$E_{-}(x) = \\tfrac{1}{2}\\left[U_1(x) + U_2(x) - \\sqrt{\\left(U_1(x) - U_2(x)\\right)^2 + 4 V^2}\\right].$$\n- 活化自由能 $\\Delta G^{\\ddagger}$ 近似为绝热势能面上过渡态位置 $x^{\\ddagger}$（反应物和产物最小值之间的局部最大值）与反应物最小值位置 $x_{\\mathrm{R}}$ 之间的能量差，两者均位于 $E_{-}(x)$ 上：\n  $$\\Delta G^{\\ddagger} = E_{-}(x^{\\ddagger}) - E_{-}(x_{\\mathrm{R}}).$$\n- 过渡态理论 (Transition State Theory, TST)，特别是 Eyring 方程，给出了转换速率常数 $k$ 为\n  $$k = \\frac{k_{\\mathrm{B}} T}{h} \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}}{R T}\\right),$$\n  其中 $k_{\\mathrm{B}}$ 是 Boltzmann 常数，$h$ 是 Planck 常数，$R$ 是气体常数，$T$ 是绝对温度。请使用单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 的 $R$，并在需要时将 $\\Delta G^{\\ddagger}$ 从 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 转换为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ 以确保单位一致性。\n\n您的程序必须：\n\n- 对于每组参数集，在 $x$ 的均匀网格上数值计算 $E_{-}(x)$，范围从 $x_{\\min} = \\min(x_1, x_2) - \\delta$ 到 $x_{\\max} = \\max(x_1, x_2) + \\delta$，其中 $\\delta = 0.3\\,\\mathrm{\\AA}$。在中点 $x_{\\mathrm{mid}} = \\tfrac{1}{2}(x_1 + x_2)$ 的左侧定位反应物最小值 $x_{\\mathrm{R}}$，在 $x_{\\mathrm{mid}}$ 的右侧定位产物最小值，然后识别这两个最小值之间的最大值以获得 $x^{\\ddagger}$。\n- 计算 $\\Delta G^{\\ddagger}$ (单位 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$)，然后使用 Eyring 方程在指定的温度 $T$ 下计算 $k$ (单位 $\\mathrm{s}^{-1}$)。\n- 通过检查是否 $k \\ge k_{\\mathrm{thr}}$ 来判断动力学能力，其中 $k_{\\mathrm{thr}}$ 是指定的阈值，单位为 $\\mathrm{s}^{-1}$。\n- 为每个测试用例返回一个布尔值结果。\n\n使用以下常数和单位：\n\n- $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$，$h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J}\\,\\mathrm{s}$，$R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- 温度 $T$ 的单位是 $\\mathrm{K}$。\n- 反应坐标 $x$ 的单位是 $\\mathrm{\\AA}$。\n- 能量 $U_1$, $U_2$, $V$, $\\Delta_0$, $c_1$, $c_2$ 和 $\\Delta G^{\\ddagger}$ 的单位是 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n- 速率常数 $k$ 和阈值 $k_{\\mathrm{thr}}$ 的单位是 $\\mathrm{s}^{-1}$。\n\n测试套件（三个案例，旨在探测一个典型的有效构象、一个用于新结合模式的无效高能垒构象，以及一个临界情况）：\n\n- 案例 1 (类标准有效构象):\n  - $k_1 = 500.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$, $x_1 = 2.4\\,\\mathrm{\\AA}$,\n  - $k_2 = 500.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$, $x_2 = 1.4\\,\\mathrm{\\AA}$,\n  - $\\Delta_0 = 5.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $V = 2.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n  - $s_1 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-1}$, $s_2 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-1}$,\n  - $c_1 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $c_2 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n  - $x_{\\mathrm{ref}} = 2.0\\,\\mathrm{\\AA}$, $T = 300.0\\,\\mathrm{K}$, $k_{\\mathrm{thr}} = 10.0\\,\\mathrm{s}^{-1}$.\n- 案例 2 (具有更高能垒的新构象，预期无效):\n  - $k_1 = 500.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$, $x_1 = 2.4\\,\\mathrm{\\AA}$,\n  - $k_2 = 500.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$, $x_2 = 1.4\\,\\mathrm{\\AA}$,\n  - $\\Delta_0 = 20.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $V = 2.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n  - $s_1 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-1}$, $s_2 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-1}$,\n  - $c_1 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $c_2 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n  - $x_{\\mathrm{ref}} = 2.0\\,\\mathrm{\\AA}$, $T = 300.0\\,\\mathrm{K}$, $k_{\\mathrm{thr}} = 10.0\\,\\mathrm{s}^{-1}$.\n- 案例 3 (临界新构象，接近阈值):\n  - $k_1 = 500.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$, $x_1 = 2.4\\,\\mathrm{\\AA}$,\n  - $k_2 = 500.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$, $x_2 = 1.4\\,\\mathrm{\\AA}$,\n  - $\\Delta_0 = 12.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $V = 2.4\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n  - $s_1 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-1}$, $s_2 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-1}$,\n  - $c_1 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $c_2 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n  - $x_{\\mathrm{ref}} = 2.0\\,\\mathrm{\\AA}$, $T = 300.0\\,\\mathrm{K}$, $k_{\\mathrm{thr}} = 10.0\\,\\mathrm{s}^{-1}$.\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[True,False,True]”）。每个元素必须是一个布尔值，指示相应案例是否具有动力学能力（如果 $k \\ge k_{\\mathrm{thr}}$ 则为 $\\mathrm{True}$，否则为 $\\mathrm{False}$）。此行前后不得有任何多余文本。不需要用户输入。所有计算都应是确定性的。", "solution": "所呈现的问题是计算化学动力学中的一个标准、定义明确的练习，特别是在使用经验价键 (Empirical Valence Bond, EVB) 方法的简化量子力学/分子力学 (QM/MM) 建模框架内。任务是通过计算酶促转换速率并将其与给定阈值进行比较，来评估底物结合构象的动力学能力。该问题具有科学依据，逻辑上一致，并为确定性解决方案提供了所有必要信息。因此，我们着手进行分析。\n\n解决方案是根据问题陈述中概述的物理和数学原理，通过严格、逐步的应用来构建的。\n\n首先，我们定义一维反应势能面。该系统由两个非绝热态描述，代表类反应物和类产物的电子构型。它们的势能 $U_1(x)$ 和 $U_2(x)$ 作为广义反应坐标 $x$ 的函数给出。定义如下：\n$$U_1(x) = \\tfrac{1}{2} k_1 (x - x_1)^2 + s_1 (x - x_{\\mathrm{ref}}) + c_1$$\n$$U_2(x) = \\Delta_0 + \\tfrac{1}{2} k_2 (x - x_2)^2 + s_2 (x - x_{\\mathrm{ref}}) + c_2$$\n在此，$k_1$ 和 $k_2$ 是力常数，$x_1$ 和 $x_2$ 是非绝热势能最小值的位置，$\\Delta_0$ 是非绝热能量偏移，而涉及 $s_1$、$s_2$、$c_1$ 和 $c_2$ 的项则解释了环境效应和能量移动。这两个态通过一个恒定的非对角项 $V$ 耦合。\n\nBorn-Oppenheimer 基态势能面，表示为下绝热面 $E_{-}(x)$，是从 $2 \\times 2$ EVB 哈密顿矩阵的较低特征值获得的：\n$$\\mathbf{H}(x) = \\begin{pmatrix} U_1(x) & V \\\\ V & U_2(x) \\end{pmatrix}$$\n此特征值的解析表达式已提供：\n$$E_{-}(x) = \\tfrac{1}{2}\\left[U_1(x) + U_2(x) - \\sqrt{\\left(U_1(x) - U_2(x)\\right)^2 + 4 V^2}\\right]$$\n\n计算任务的核心是分析该绝热面 $E_{-}(x)$ 的拓扑结构。我们必须在反应坐标的一个指定范围内，从 $x_{\\min} = \\min(x_1, x_2) - \\delta$到 $x_{\\max} = \\max(x_1, x_2) + \\delta$（其中 $\\delta = 0.3\\,\\mathrm{\\AA}$），对此函数进行数值评估。为确保准确性，我们将此范围离散化为一个精细、均匀的点网格。\n\n在这个 $E_{-}(x)$ 的数值表示上，我们必须确定关键点：反应物态最小值、产物态最小值，以及分隔它们俩的过渡态最大值。根据问题的约定，反应物区域定义在中点 $x_{\\mathrm{mid}} = \\tfrac{1}{2}(x_1 + x_2)$ 的左侧，产物区域在其右侧。我们通过在网格的反应物区域找到能量最低点来定位反应物最小值的位置 $x_{\\mathrm{R}}$。类似地，我们找到产物最小值 $x_{\\mathrm{P}}$。位于 $x^{\\ddagger}$ 位置的过渡态对应于连接 $x_{\\mathrm{R}}$ 和 $x_{\\mathrm{P}}$ 路径上的能量最高点。\n\n在确定了这些点之后，我们计算活化自由能 $\\Delta G^{\\ddagger}$。在此模型中，它被近似为过渡态和反应物态之间的势能差：\n$$\\Delta G^{\\ddagger} = E_{-}(x^{\\ddagger}) - E_{-}(x_{\\mathrm{R}})$$\n该能量的单位是 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n最后，我们通过 Eyring 方程应用过渡态理论 (Transition State Theory, TST) 来计算转换速率常数 $k$：\n$$k = \\frac{k_{\\mathrm{B}} T}{h} \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}}{R T}\\right)$$\n此处，$k_{\\mathrm{B}}$ 是 Boltzmann 常数，$h$ 是 Planck 常数，$T$ 是绝对温度，$R$ 是理想气体常数。保持单位一致性至关重要。由于 $R$ 的单位是 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，我们必须将 $\\Delta G^{\\ddagger}$ 从 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 乘以 1000 转换为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n\n底物构象的动力学能力由一个简单的布尔条件确定：如果计算出的速率常数 $k$ 大于或等于指定的阈值速率 $k_{\\mathrm{thr}}$，则该构象被视为有效。程序将为所提供的三个测试用例中的每一个实施整个过程，生成一个布尔结果列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational enzyme catalysis problem for a set of test cases.\n    \"\"\"\n\n    # Physical constants\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n    H = 6.62607015e-34   # Planck constant in J*s\n    R = 8.314462618     # Gas constant in J/(mol*K)\n\n    def is_kinetically_competent(params):\n        \"\"\"\n        Evaluates a single parameter set for kinetic competence.\n\n        Args:\n            params (tuple): A tuple containing all parameters for a single case.\n\n        Returns:\n            bool: True if k >= k_thr, False otherwise.\n        \"\"\"\n        k1, x1, k2, x2, delta0, V, s1, s2, c1, c2, x_ref, T, k_thr = params\n\n        # Set up the reaction coordinate grid\n        delta = 0.3\n        x_min = min(x1, x2) - delta\n        x_max = max(x1, x2) + delta\n        # Use a high-resolution grid for numerical accuracy\n        num_points = 20000\n        x_grid = np.linspace(x_min, x_max, num_points)\n\n        # Calculate diabatic potential energies U1(x) and U2(x)\n        U1 = 0.5 * k1 * (x_grid - x1)**2 + s1 * (x_grid - x_ref) + c1\n        U2 = delta0 + 0.5 * k2 * (x_grid - x2)**2 + s2 * (x_grid - x_ref) + c2\n\n        # Calculate the adiabatic ground-state potential energy surface E_(x)\n        E_minus = 0.5 * (U1 + U2 - np.sqrt((U1 - U2)**2 + 4 * V**2))\n\n        # Partition the grid into reactant and product regions\n        x_mid = 0.5 * (x1 + x2)\n        mid_idx = np.abs(x_grid - x_mid).argmin()\n\n        # Locate the reactant minimum (left of midpoint)\n        reactant_E_slice = E_minus[:mid_idx]\n        reactant_x_slice = x_grid[:mid_idx]\n        reactant_min_idx_local = np.argmin(reactant_E_slice)\n        E_R = reactant_E_slice[reactant_min_idx_local]\n        reactant_min_idx_global = reactant_min_idx_local\n        \n        # Locate the product minimum (right of midpoint)\n        product_E_slice = E_minus[mid_idx:]\n        product_min_idx_local = np.argmin(product_E_slice)\n        product_min_idx_global = mid_idx + product_min_idx_local\n\n        # Locate the transition state as the maximum between the two minima\n        # Ensure the slice indices are in the correct order\n        start_idx = min(reactant_min_idx_global, product_min_idx_global)\n        end_idx = max(reactant_min_idx_global, product_min_idx_global)\n\n        ts_E_slice = E_minus[start_idx : end_idx + 1]\n        \n        # Avoid issues with empty slices if minima are adjacent\n        if ts_E_slice.size == 0:\n            # If there's no barrier, reaction is extremely fast.\n            # This case won't be triggered by the provided parameters.\n            return True \n            \n        ts_max_idx_local = np.argmax(ts_E_slice)\n        E_TS = ts_E_slice[ts_max_idx_local]\n\n        # Calculate activation energy in kJ/mol\n        delta_G_ddagger_kjmol = E_TS - E_R\n\n        # Convert activation energy to J/mol for the Eyring equation\n        delta_G_ddagger_jmol = delta_G_ddagger_kjmol * 1000.0\n\n        # Calculate the rate constant k using the Eyring equation\n        k = (KB * T / H) * np.exp(-delta_G_ddagger_jmol / (R * T))\n\n        # Compare with the threshold\n        return k >= k_thr\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (competent canonical-like pose)\n        (500.0, 2.4, 500.0, 1.4, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 300.0, 10.0),\n        # Case 2 (new pose with higher barrier, expected incompetent)\n        (500.0, 2.4, 500.0, 1.4, 20.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 300.0, 10.0),\n        # Case 3 (borderline new pose, near threshold)\n        (500.0, 2.4, 500.0, 1.4, 12.0, 2.4, 0.0, 0.0, 0.0, 0.0, 2.0, 300.0, 10.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = is_kinetically_competent(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2452864"}, {"introduction": "在掌握了如何计算反应速率之后，下一个关键问题是：酶到底是如何降低活化能的？本练习将通过一个思想实验，让你深入探究酶催化的一个核心机制——静电稳定作用。你将分析蛋白质环境（在此被简化为一个介电常数为 $\\varepsilon$ 的连续介质）如何通过差异性地稳定过渡态而非反应物来加速反应。理解这一原理对于揭示酶催化效率的奥秘至关重要 [@problem_id:2452943]。", "problem": "在一个酶活性位点的混合量子力学/分子力学 (QM/MM) 模型中，考虑一个反应，其过渡态 (TS) 相对于基本呈中性的反应物态，涉及显著的电荷分离。量子力学区域外的分子力学环境由一个相对介电常数 (介电常数) 为 $\\varepsilon$ 的线性介电连续体表示。比较两个计算，这两个计算除了用于表示蛋白质环境的介电常数（$\\varepsilon = 1$ 对比 $\\varepsilon = 4$）之外，在所有其他方面都完全相同。假设环境呈线性响应，并且过渡态带有相距为 $r$ 的近似相反的部分电荷 $\\pm \\delta q$，而反应物态的极化程度要小得多。\n\n哪个陈述最能描述将 $\\varepsilon$ 从 $1$ 增加到 $4$ 如何影响这个电荷分离反应的计算活化能垒？\n\nA. 将 $\\varepsilon$ 从 $1$ 增加到 $4$ 通常会降低能垒，因为更具极性的环境对电荷分离的过渡态的稳定作用大于对极化程度较低的反应物的稳定作用；变化的幅度取决于电荷分布和几何构型。\n\nB. 将 $\\varepsilon$ 从 $1$ 增加到 $4$ 会升高能垒，因为静电屏蔽减弱了过渡态中相反电荷之间的吸引相互作用，使其相对于真空不稳定。\n\nC. 改变 $\\varepsilon$ 对活化能垒没有影响，因为量子力学区域已经明确处理了电子极化；能垒仅取决于量子力学能量。\n\nD. 增加 $\\varepsilon$ 会将所有静电贡献精确地按 $1/\\varepsilon$ 比例缩放，因此能垒精确地减小一个因子4，且与电荷的位置和大小无关。", "solution": "对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 系统是一个酶活性位点的混合量子力学/分子力学 (QM/MM) 模型。\n- 该反应涉及一个具有显著电荷分离的过渡态 (TS)。\n- 反应物态 (R) 被描述为基本呈中性。\n- 分子力学 (MM) 环境被建模为一个相对介电常数为 $\\varepsilon$ 的线性介电连续体。\n- 比较了两个计算：一个使用 $\\varepsilon = 1$，另一个使用 $\\varepsilon = 4$。\n- 两个计算之间的所有其他计算参数都相同。\n- 假设环境表现出线性响应。\n- 过渡态的简化模型涉及相距 $r$ 的相反的部分电荷 $\\pm \\delta q$。\n- 反应物态被明确指出比过渡态的“极化程度小得多”。\n- 问题要求说明将 $\\varepsilon$ 从 $1$ 增加到 $4$ 对计算的活化能垒有何影响。\n\n### 步骤2：使用提取的已知条件进行验证\n评估问题的有效性。\n- **科学依据：** 该问题描述了连续介质溶剂化模型在 QM/MM 框架内的标准应用，这是现代计算酶学的基石。其前提——即介电介质能稳定电荷——是静电学的一个基本原理。$\\varepsilon=1$（真空）和 $\\varepsilon=4$（一种低介电常数的非极性环境，常用于模拟蛋白质内部）这两个值在物理上和计算上都是有意义的。该问题具有科学合理性。\n- **适定性：** 问题定义清晰。它提供了一个具有两种不同状态（反应物态和过渡态）的场景，并要求在一个特定的环境参数（$\\varepsilon$）发生变化时，它们之间能量差的定性变化。可以从已有的物理化学原理中推导出一个唯一的、定性的结论。\n- **客观性：** 语言技术性强、精确，无主观或模棱两可的术语。\n\n### 步骤3：结论与行动\n问题陈述有效。这是一个计算化学领域中适定的、有科学依据的问题。将推导解答。\n\n### 推导\n活化能垒 $\\Delta E^{\\ddagger}$ 定义为过渡态能量（$E_{TS}$）与反应物态能量（$E_R$）之间的差值：\n$$\n\\Delta E^{\\ddagger} = E_{TS} - E_R\n$$\n在对 MM 部分使用连续介质溶剂模型的 QM/MM 计算中，给定状态（R 或 TS）的总能量是介电常数 $\\varepsilon$ 的函数。这个能量在概念上可以分解为气相能量（$E_{gas}$，即 QM 系统在真空中，$\\varepsilon=1$ 时所具有的能量）和溶剂化能（$E_{solv}(\\varepsilon)$，代表 QM 电荷分布与周围介电连续体之间的相互作用）。\n$$\nE_{state}(\\varepsilon) = E_{state,gas} + E_{solv}(state, \\varepsilon)\n$$\n“线性响应”假设意味着由介电质引起的稳定化能可以基于溶质的电荷分布来计算。溶剂化能 $E_{solv}$ 代表介电介质对溶质的稳定作用。对于任何电荷分布，从真空 ($\\varepsilon=1$) 移动到介电介质 ($\\varepsilon > 1$) 会导致自由能的负变化，即 $E_{solv}(state, \\varepsilon > 1) < 0$。这种稳定作用的幅度对于极性更强的溶质（即那些具有更大电荷分离或偶极矩的溶质）更大。\n\n问题陈述指出：\n1.  过渡态具有显著的电荷分离。设其偶极矩为 $\\mu_{TS}$。此值很大。\n2.  反应物态基本呈中性，极化程度小得多。设其偶极矩为 $\\mu_R$。此值很小，$\\mu_R \\approx 0$。\n\n根据静电理论（例如，Born-Onsager 模型），稳定化能的绝对值 $|E_{solv}|$ 随着溶质的极性和介质的介电常数 $\\varepsilon$ 的增加而增加。因此，对于 $\\varepsilon=4$:\n$$\n|E_{solv}(TS, \\varepsilon=4)| \\gg |E_{solv}(R, \\varepsilon=4)| \\approx 0\n$$\n因为溶剂化是一种稳定效应，所以其能量为负：\n$$\nE_{solv}(TS, \\varepsilon=4) \\ll E_{solv}(R, \\varepsilon=4) \\approx 0\n$$\n现在我们将活化能垒写成 $\\varepsilon$ 的函数：\n$$\n\\Delta E^{\\ddagger}(\\varepsilon) = E_{TS}(\\varepsilon) - E_R(\\varepsilon) = (E_{TS,gas} + E_{solv}(TS, \\varepsilon)) - (E_{R,gas} + E_{solv}(R, \\varepsilon))\n$$\n$$\n\\Delta E^{\\ddagger}(\\varepsilon) = (E_{TS,gas} - E_{R,gas}) + (E_{solv}(TS, \\varepsilon) - E_{solv}(R, \\varepsilon))\n$$\n第一项是气相活化能垒，$\\Delta E^{\\ddagger}_{gas}$。\n$$\n\\Delta E^{\\ddagger}(\\varepsilon) = \\Delta E^{\\ddagger}_{gas} + \\Delta E_{solv}^{\\ddagger}(\\varepsilon)\n$$\n其中 $\\Delta E_{solv}^{\\ddagger}(\\varepsilon) = E_{solv}(TS, \\varepsilon) - E_{solv}(R, \\varepsilon)$。\n\n我们比较在 $\\varepsilon=1$ 和 $\\varepsilon=4$ 下的能垒。\n- 对于 $\\varepsilon=1$（真空），根据定义，溶剂化能为零：$E_{solv}(TS, 1) = 0$ 和 $E_{solv}(R, 1) = 0$。\n  因此，$\\Delta E^{\\ddagger}(1) = \\Delta E^{\\ddagger}_{gas}$。\n- 对于 $\\varepsilon=4$，我们有 $E_{solv}(TS, 4) < 0$ 和 $E_{solv}(R, 4) \\approx 0$。\n  因此，反应的溶剂化能变化，$\\Delta E_{solv}^{\\ddagger}(4) = E_{solv}(TS, 4) - E_{solv}(R, 4)$，是一个显著的负值。\n  在 $\\varepsilon=4$ 下的活化能垒是：\n  $$\n  \\Delta E^{\\ddagger}(4) = \\Delta E^{\\ddagger}_{gas} + \\Delta E_{solv}^{\\ddagger}(4)\n  $$\n由于 $\\Delta E_{solv}^{\\ddagger}(4) < 0$，由此得出 $\\Delta E^{\\ddagger}(4) < \\Delta E^{\\ddagger}_{gas} = \\Delta E^{\\ddagger}(1)$。\n结论是，将 $\\varepsilon$ 从 $1$ 增加到 $4$ 会降低活化能垒。这是因为极性介电介质对高度电荷分离的过渡态提供了比对基本中性的反应物态大得多的稳定作用。\n\n### 逐项分析\n\n**A. 将 $\\varepsilon$ 从 $1$ 增加到 $4$ 通常会降低能垒，因为更具极性的环境对电荷分离的过渡态的稳定作用大于对极化程度较低的反应物的稳定作用；变化的幅度取决于电荷分布和几何构型。**\n该陈述是对上述推导的精确总结。极性环境（$\\varepsilon=4$）对极性过渡态的稳定作用大于非极性反应物，从而降低了过渡态相对于反应物的能量，减小了活化能垒。这种效应的幅度确实取决于 QM 区域的具体几何构型和电荷分布（这决定了其偶极矩、四极矩等），因为所有连续介质模型都包含这种几何依赖性（例如，通过空腔半径和多极展开）。**正确**。\n\n**B. 将 $\\varepsilon$ 从 $1$ 增加到 $4$ 会升高能垒，因为静电屏蔽减弱了过渡态中相反电荷之间的吸引相互作用，使其相对于真空不稳定。**\n这在根本上是错误的。虽然介质会屏蔽部分电荷 $\\pm \\delta q$ 之间的直接相互作用，但将电荷分布从真空置于介电介质中时的总能量变化总是稳定化的。介质的极化产生了一个反应场，该反应场对电荷做正功。声称过渡态相对于真空 ($\\varepsilon=1$) 不稳定，这直接违背了基本的静电学原理。(电荷 + 介质) 体系的能量低于 (电荷) + (未极化介质) 体系的能量。**错误**。\n\n**C. 改变 $\\varepsilon$ 对活化能垒没有影响，因为量子力学区域已经明确处理了电子极化；能垒仅取决于量子力学能量。**\n该陈述错误地描述了 QM/MM 计算的工作方式。在静电嵌入 QM/MM 方案中，总能量是 QM 能量、MM 能量和 QM-MM 相互作用能的总和：$E_{total} = E_{QM} + E_{MM} + E_{QM-MM}$。在连续介质模型中，$E_{QM-MM}$ 项表示 QM 电荷密度与连续介质反应场之间的相互作用。$\\varepsilon$ 的改变会改变这个反应场，从而改变 $E_{QM-MM}$。在自洽场 (SCF) 计算中，这个变化的场也会极化 QM 波函数，从而改变 $E_{QM}$。总能量以及因此的活化能垒都是 $\\varepsilon$ 的函数。**错误**。\n\n**D. 增加 $\\varepsilon$ 会将所有静电贡献精确地按 $1/\\varepsilon$ 比例缩放，因此能垒精确地减小一个因子4，且与电荷的位置和大小无关。**\n该陈述在多个逻辑和物理层面上都是不正确的。首先，总的静电稳定能（溶剂化能）并非简单地按 $1/\\varepsilon$ 缩放。例如，在 Onsager 的偶极子模型中，该因子是 $(\\varepsilon-1)/(2\\varepsilon+1)$，当 $\\varepsilon=4$ 时，其值为 $3/9 = 1/3$，而不是 $1/4$。其次，能垒是一个能量*差值*，$\\Delta E^{\\ddagger} = E_{TS} - E_R$。除非 $E_R=0$，否则不能简单地将缩放应用于能垒。第三，断言其与电荷位置和大小无关显然是错误的。溶剂化能高度依赖于系统的电荷分布（偶极矩及更高阶矩）以及用于定义 QM/MM 边界的几何形状（例如，空腔半径）。**错误**。", "answer": "$$\\boxed{A}$$", "id": "2452943"}, {"introduction": "我们最后的实践将带你进入计算酶学的前沿领域，探索超越静态图像的动态世界。你将对比一个静态的量子力学簇模型和一个更真实的、包含环境动力学的QM/MM模型，并亲自推导和计算蛋白质的静电涨落与构象门控效应对催化过程的贡献。这个练习将清晰地揭示，为何酶的动态特性对其功能至关重要，以及高级计算模型如何捕捉到这些被简化模型忽略的关键物理效应 [@problem_id:2452929]。", "problem": "您将沿着单一反应坐标，对一个酶催化反应的两种简化模型进行一次基于原理的比较。目标是量化和解释全原子量子力学/分子力学(QM/MM)分子动力学(MD)模型所能捕捉到、但带有隐式溶剂的静态量子力学(QM)簇模型所忽略的催化效应。为在保证可解性的同时维持科学真实性，您将用一个双势阱来模拟沿单一坐标 $x$ 的反应，该势阱代表反应物和产物势阱以及一个中心过渡态。您将从基本统计力学原理出发，推导两种模型的有效自由能曲线，然后计算它们的活化自由能。\n\n基本原理：\n- 过渡态理论(TST)通过 $k \\propto \\exp(-\\beta \\Delta G^{\\ddagger})$ 将速率常数与活化自由能联系起来，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。对于摩尔能量，使用气体常数 $R$ 代替 $k_{\\mathrm{B}}$，因此 $\\beta = 1/(R T)$。\n- 平均力势 $W(x)$ 通过对环境自由度进行边缘化来定义，$W(x) = -k_{\\mathrm{B}} T \\ln \\int \\mathrm{d}\\mathbf{s}\\, p(\\mathbf{s}) \\exp\\left(-\\beta U(x,\\mathbf{s})\\right)$，其中 $U(x,\\mathbf{s})$ 是总势能，$p(\\mathbf{s})$ 是在固定 $x$ 时环境坐标 $\\mathbf{s}$ 的平衡分布。\n- 如果环境通过与一个标量场 $E$ 的线性相互作用与反应坐标耦合，并且 $E$ 是一个均值为 $\\bar{E}$、方差为 $\\sigma_{E}^{2}$ 的高斯随机变量，那么PMF（平均力势）可以通过对 $E$ 进行解析积分得到。\n\n模型定义：\n- 沿 $x$ 的裸气相反应势（无量纲）：$V_{0}(x) = A \\left(x^{2} - x_{0}^{2}\\right)^{2}$，其在 $x \\approx \\pm x_{0}$ 附近有极小值，在 $x \\approx 0$ 附近有一个高度约为 $A x_{0}^{4}$ 的势垒。\n- 沿 $x$ 的反应耦合“电荷分离强度”：$q(x) = q_{\\mathrm{TS}} \\exp\\!\\left(-\\dfrac{(x - x_{\\mathrm{TS}})^{2}}{2 s_{q}^{2}}\\right)$，其中 $x_{\\mathrm{TS}} = 0$。这模拟了电荷重组在过渡态附近达到最大的情况。\n- 沿 $x$ 的构象门控因子（可及构象数）：$g(x) = 1 + c_{g} \\exp\\!\\left(-\\dfrac{(x - x_{\\mathrm{TS}})^{2}}{2 s_{g}^{2}}\\right)$。这模拟了由多个与过渡态对齐的构象所产生的熵贡献，该贡献使 $W(x)$ 降低了 $-k_{\\mathrm{B}} T \\ln g(x)$。\n\n待比较的模型：\n- 带隐式溶剂的QM簇模型（静态连续介质反应场）。假设平均场相互作用能的形式为 $U_{\\mathrm{imp}}(x) = - \\bar{E}\\, q(x)$，因此簇模型的自由能曲线为\n  $$\n  W_{\\mathrm{cl}}(x) = V_{0}(x) - \\bar{E}\\, q(x).\n  $$\n- QM/MM MD（全原子环境积分）。从PMF（平均力势）定义出发\n  $$\n  W_{\\mathrm{QM/MM}}(x) = -k_{\\mathrm{B}} T \\ln \\int_{-\\infty}^{\\infty} \\mathrm{d}E\\, \\mathcal{N}(E \\mid \\bar{E}, \\sigma_{E}^{2}) \\exp\\!\\left(-\\beta \\left[V_{0}(x) - q(x) E\\right]\\right) \\;-\\; k_{\\mathrm{B}} T \\ln g(x),\n  $$\n  其中 $\\mathcal{N}(E \\mid \\bar{E}, \\sigma_{E}^{2})$ 是一个均值为 $\\bar{E}$、方差为 $\\sigma_{E}^{2}$ 的高斯分布。您必须完成此高斯积分，以获得 $W_{\\mathrm{QM/MM}}(x)$ 关于 $V_{0}(x)$、$q(x)$、$\\bar{E}$、$\\sigma_{E}^{2}$、$\\beta$ 和 $g(x)$ 的闭合形式表达式。该结果应清楚地展示平均静电作用、静电涨落和熵门控的作用。\n\n活化自由能：\n- 对于每个模型，将过渡态位置定义为 $x_{\\mathrm{TS}} = 0$，并通过在包含左侧势阱（反应物势阱）的区域内对相应的 $W(x)$ 进行最小化来计算反应物态的极小值点 $x_{\\mathrm{R}}$。然后计算活化自由能\n  $$\n  \\Delta G_{\\mathrm{cl}}^{\\ddagger} = W_{\\mathrm{cl}}(x_{\\mathrm{TS}}) - \\min_{x \\in \\mathcal{D}_{\\mathrm{R}}} W_{\\mathrm{cl}}(x), \\quad\n  \\Delta G_{\\mathrm{QM/MM}}^{\\ddagger} = W_{\\mathrm{QM/MM}}(x_{\\mathrm{TS}}) - \\min_{x \\in \\mathcal{D}_{\\mathrm{R}}} W_{\\mathrm{QM/MM}}(x).\n  $$\n- 通过将差值 $\\Delta \\Delta G^{\\ddagger} = \\Delta G_{\\mathrm{QM/MM}}^{\\ddagger} - \\Delta G_{\\mathrm{cl}}^{\\ddagger}$ 分解为簇模型所忽略的两种催化效应来解释该差值：\n  1. 静电涨落稳定化效应（源于 $\\sigma_{E}^{2} > 0$）。\n  2. 熵门控效应（源于 $g(x)$，且 $c_{g} > 0$）。\n  使用推导出的 $W_{\\mathrm{QM/MM}}(x)$，估计相对于簇模型，各项对势垒降低的贡献（计算为每一项在 $x_{\\mathrm{TS}}$ 和 $x_{\\mathrm{R}}$ 之间的差值），并使用 $0.05$（能量单位）的数值阈值来判断哪些效应是显著的。\n\n单位与常数：\n- 所有能量单位必须是 $\\mathrm{kJ\\,mol^{-1}}$。\n- 温度单位必须是 $\\mathrm{K}$。\n- 使用 $R = 8.314462618 \\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。\n- 报告的活化自由能单位为 $\\mathrm{kJ\\,mol^{-1}}$，并四舍五入到三位小数。\n\n测试组：\n实现您的程序以计算以下4个案例的结果。参数顺序为 $(A, x_{0}, q_{\\mathrm{TS}}, s_{q}, \\bar{E}, \\sigma_{E}, c_{g}, s_{g}, T)$：\n1. $(50.0, 1.0, 1.0, 0.2, 5.0, 10.0, 1.0, 0.3, 300.0)$\n2. $(50.0, 1.0, 1.0, 0.2, 5.0, 0.0, 1.0, 0.3, 300.0)$\n3. $(50.0, 1.0, 1.0, 0.2, 5.0, 10.0, 0.0, 0.3, 300.0)$\n4. $(50.0, 1.0, 1.0, 0.2, 5.0, 0.0, 0.0, 0.3, 300.0)$\n\n输出规格：\n- 对于每个测试案例，输出一个形式为 $[\\Delta G_{\\mathrm{cl}}^{\\ddagger}, \\Delta G_{\\mathrm{QM/MM}}^{\\ddagger}, C]$ 的列表，其中 $C$ 是一个整数分类代码，指示簇模型忽略了哪些催化效应：\n  - $0$：均不显著，\n  - $1$：仅静电涨落，\n  - $2$：仅熵门控，\n  - $3$：两种效应均有。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的、由逗号分隔的4个列表，例如：$[[a_{1},b_{1},c_{1}],[a_{2},b_{2},c_{2}],[a_{3},b_{3},c_{3}],[a_{4},b_{4},c_{4}]]$，其中每个 $a_{i}$ 和 $b_{i}$ 是四舍五入到三位小数的浮点数，每个 $c_{i}$ 是一个整数。\n\n实现约束：\n- 过渡态位置固定在 $x_{\\mathrm{TS}} = 0$。\n- 反应物极小值必须通过在左侧势阱域 $\\mathcal{D}_{\\mathrm{R}}$ 内进行连续优化来找到；选择一个包含左侧极小值的鲁棒有界区间（例如，一个包含 $-x_{0}$ 且横跨负 $x$ 值的区间）。\n- 代码必须是一个完整、可运行的程序，并且只产生上述描述的单行输出，不含任何额外文本。", "solution": "所提出的问题是计算化学和统计力学领域一个有效的练习。它的科学基础在于过渡态理论的原理和平均力势（PMF）的定义。所提供的模型虽然简化，但代表了理解酶催化的常用方法，即带有隐式溶剂反应场的静态QM簇模型，以及一个更动态的、显式地考虑了环境涨落和构象效应的QM/MM模型。这个问题是提法恰当的，所有必需的参数、常数和函数形式都已定义，从而可以得到一个唯一且有意义的解。它的表述是客观的，不包含任何科学或逻辑上的矛盾。从高斯积分推导PMF的闭合形式表达式是一个标准且可解的过程。因此，我将给出完整的解法。\n\n问题的核心是推导QM/MM自由能曲线 $W_{\\mathrm{QM/MM}}(x)$ 的解析形式，然后用它与更简单的簇模型 $W_{\\mathrm{cl}}(x)$ 进行定量比较。\n\n让我们从推导 $W_{\\mathrm{QM/MM}}(x)$ 开始。其定义是两个项的和。第二项 $-k_{\\mathrm{B}} T \\ln g(x)$ 代表熵门控贡献，可以分开处理。我们先关注第一项，它涉及对环境电场 $E$ 的积分：\n$$\nW_{\\mathrm{int}}(x) = -k_{\\mathrm{B}} T \\ln \\int_{-\\infty}^{\\infty} \\mathrm{d}E\\, \\mathcal{N}(E \\mid \\bar{E}, \\sigma_{E}^{2}) \\exp\\left(-\\beta \\left[V_{0}(x) - q(x) E\\right]\\right)\n$$\n其中，对于摩尔能量，$\\beta = 1/(RT)$，而 $\\mathcal{N}(E \\mid \\bar{E}, \\sigma_{E}^{2}) = \\frac{1}{\\sqrt{2\\pi\\sigma_{E}^{2}}} \\exp\\left(-\\frac{(E-\\bar{E})^2}{2\\sigma_{E}^2}\\right)$ 是 $E$ 的高斯概率密度函数。\n\n设该积分为 $I(x)$。我们可以将与 $E$ 无关的项提出：\n$$\nI(x) = \\exp\\left(-\\beta V_{0}(x)\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi\\sigma_{E}^{2}}} \\exp\\left(-\\frac{(E-\\bar{E})^2}{2\\sigma_{E}^2} + \\beta q(x) E\\right) \\mathrm{d}E\n$$\n积分内部指数的参数可以通过对 $E$ 配方法来重新整理：\n\\begin{align*}\n-\\frac{(E-\\bar{E})^2}{2\\sigma_{E}^2} + \\beta q(x) E &= -\\frac{E^2 - 2E\\bar{E} + \\bar{E}^2}{2\\sigma_{E}^2} + \\beta q(x) E \\\\\n&= -\\frac{1}{2\\sigma_{E}^2} \\left[ E^2 - 2E\\bar{E} + \\bar{E}^2 - 2\\sigma_{E}^2 \\beta q(x) E \\right] \\\\\n&= -\\frac{1}{2\\sigma_{E}^2} \\left[ E^2 - 2E(\\bar{E} + \\sigma_{E}^2 \\beta q(x)) + \\bar{E}^2 \\right] \\\\\n\\end{align*}\n为了配方，我们定义一个新的均值 $\\mu' = \\bar{E} + \\sigma_{E}^2 \\beta q(x)$。表达式变为：\n\\begin{align*}\n&= -\\frac{1}{2\\sigma_{E}^2} \\left[ (E - \\mu')^2 - (\\mu')^2 + \\bar{E}^2 \\right] \\\\\n&= -\\frac{(E - \\mu')^2}{2\\sigma_{E}^2} + \\frac{(\\mu')^2 - \\bar{E}^2}{2\\sigma_{E}^2} \\\\\n&= -\\frac{(E - \\mu')^2}{2\\sigma_{E}^2} + \\frac{(\\bar{E} + \\sigma_{E}^2 \\beta q(x))^2 - \\bar{E}^2}{2\\sigma_{E}^2} \\\\\n&= -\\frac{(E - \\mu')^2}{2\\sigma_{E}^2} + \\frac{2\\bar{E}\\sigma_{E}^2 \\beta q(x) + (\\sigma_{E}^2 \\beta q(x))^2}{2\\sigma_{E}^2} \\\\\n&= -\\frac{(E - \\mu')^2}{2\\sigma_{E}^2} + \\beta \\bar{E} q(x) + \\frac{1}{2} \\beta^2 \\sigma_{E}^2 q(x)^2\n\\end{align*}\n将此结果代回 $I(x)$ 的积分中：\n$$\nI(x) = \\exp\\left(-\\beta V_{0}(x)\\right) \\exp\\left(\\beta \\bar{E} q(x) + \\frac{1}{2} \\beta^2 \\sigma_{E}^2 q(x)^2\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi\\sigma_{E}^{2}}} \\exp\\left(-\\frac{(E - \\mu')^2}{2\\sigma_{E}^2}\\right) \\mathrm{d}E\n$$\n剩下的积分是一个高斯概率密度函数在其整个定义域上的积分，其值等于1。因此：\n$$\nI(x) = \\exp\\left(-\\beta V_{0}(x) + \\beta \\bar{E} q(x) + \\frac{1}{2} \\beta^2 \\sigma_{E}^2 q(x)^2\\right)\n$$\n现在，我们计算 $W_{\\mathrm{int}}(x) = -k_{\\mathrm{B}} T \\ln I(x) = -\\frac{1}{\\beta} \\ln I(x)$：\n$$\nW_{\\mathrm{int}}(x) = -\\frac{1}{\\beta} \\left( -\\beta V_{0}(x) + \\beta \\bar{E} q(x) + \\frac{1}{2} \\beta^2 \\sigma_{E}^2 q(x)^2 \\right) = V_{0}(x) - \\bar{E} q(x) - \\frac{1}{2} \\beta \\sigma_{E}^2 q(x)^2\n$$\n将此结果与熵门控项结合，我们得到QM/MM自由能曲线的完整表达式：\n$$\nW_{\\mathrm{QM/MM}}(x) = V_{0}(x) - \\bar{E} q(x) - \\frac{1}{2} \\beta \\sigma_{E}^2 q(x)^2 - RT \\ln g(x)\n$$\n我们可以识别出前两项正是簇模型的自由能 $W_{\\mathrm{cl}}(x) = V_{0}(x) - \\bar{E} q(x)$。这允许进行清晰的分解：\n$$\nW_{\\mathrm{QM/MM}}(x) = W_{\\mathrm{cl}}(x) + \\Delta W_{\\mathrm{fluc}}(x) + \\Delta W_{\\mathrm{gate}}(x)\n$$\n其中 $\\Delta W_{\\mathrm{fluc}}(x) = - \\frac{1}{2} \\beta \\sigma_{E}^2 q(x)^2$ 是源于静电涨落的稳定化能，而 $\\Delta W_{\\mathrm{gate}}(x) = -RT \\ln g(x)$ 是源于熵门控的稳定化能。\n\n为了计算每个模型的活化自由能 $\\Delta G^{\\ddagger} = W(x_{\\mathrm{TS}}) - W(x_{\\mathrm{R}})$，我们必须首先通过在反应物势阱区域 $\\mathcal{D}_{\\mathrm{R}}$ 上对相应的势能 $W(x)$ 进行数值最小化，来找到反应物极小值的位置 $x_{\\mathrm{R}}$。鉴于 $V_{0}(x)$ 的形式，该区域可以鲁棒地选择为一个负 $x$ 值的区间，例如 $[-2x_0, 0)$。过渡态固定在 $x_{\\mathrm{TS}} = 0$。\n\n为解释活化势垒的差异，我们估算QM/MM模型中每个额外效应对相对于簇模型的活化势垒降低的贡献。该贡献是通过评估未受扰动（簇）模型的过渡态和反应物态之间每个新增能量项的变化来估算的。\n由静电涨落引起的势垒降低为：\n$$\n\\Delta(\\Delta G^{\\ddagger})_{\\mathrm{fluc}} \\approx -[\\Delta W_{\\mathrm{fluc}}(x_{\\mathrm{TS}}) - \\Delta W_{\\mathrm{fluc}}(x_{\\mathrm{R,cl}})] = \\frac{1}{2} \\beta \\sigma_{E}^2 (q(x_{\\mathrm{TS}})^2 - q(x_{\\mathrm{R,cl}})^2)\n$$\n由熵门控引起的势垒降低为：\n$$\n\\Delta(\\Delta G^{\\ddagger})_{\\mathrm{gate}} \\approx -[\\Delta W_{\\mathrm{gate}}(x_{\\mathrm{TS}}) - \\Delta W_{\\mathrm{gate}}(x_{\\mathrm{R,cl}})] = RT (\\ln g(x_{\\mathrm{TS}}) - \\ln g(x_{\\mathrm{R,cl}}))\n$$\n如果某项效应对势垒降低的贡献超过 $0.05\\ \\mathrm{kJ\\,mol^{-1}}$，则该效应被认为是显著的。分类代码 $C$ 的确定如下：若两者均不显著，则 $C=0$；若仅涨落显著，则 $C=1$；若仅门控显著，则 $C=2$；若两者均显著，则 $C=3$。\n\n下面的程序实现了这个完整的过程。它定义了能量函数，对每个测试案例的两个模型进行数值计算以确定反应物极小值和活化能，然后评估催化贡献的显著性以生成最终分类。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the enzyme catalysis model comparison problem for a given set of test cases.\n    \"\"\"\n    \n    # Universal gas constant in kJ mol^-1 K^-1\n    R = 8.314462618e-3\n\n    # Define the test cases as per the problem statement.\n    # Parameters: (A, x0, q_TS, s_q, E_bar, sigma_E, c_g, s_g, T)\n    test_cases = [\n        (50.0, 1.0, 1.0, 0.2, 5.0, 10.0, 1.0, 0.3, 300.0),\n        (50.0, 1.0, 1.0, 0.2, 5.0, 0.0, 1.0, 0.3, 300.0),\n        (50.0, 1.0, 1.0, 0.2, 5.0, 10.0, 0.0, 0.3, 300.0),\n        (50.0, 1.0, 1.0, 0.2, 5.0, 0.0, 0.0, 0.3, 300.0),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        A, x0, q_TS, s_q, E_bar, sigma_E, c_g, s_g, T = case\n        \n        beta = 1.0 / (R * T)\n        x_TS = 0.0\n\n        # Define the fundamental components of the potentials\n        def V0(x):\n            return A * (x**2 - x0**2)**2\n\n        def q(x):\n            return q_TS * np.exp(-(x - x_TS)**2 / (2 * s_q**2))\n\n        def g(x):\n            return 1.0 + c_g * np.exp(-(x - x_TS)**2 / (2 * s_g**2))\n\n        # Define the free energy profiles for both models\n        def W_cl(x):\n            return V0(x) - E_bar * q(x)\n\n        def W_qmmm(x):\n            fluc_term = -0.5 * beta * sigma_E**2 * q(x)**2\n            gate_term = -(1.0 / beta) * np.log(g(x))\n            return W_cl(x) + fluc_term + gate_term\n\n        # --- Cluster Model Calculation ---\n        # Find reactant minimum for the cluster model\n        # Search in the left well, e.g., [-2*x0, 0)\n        res_cl = minimize_scalar(W_cl, bounds=(-2.0 * x0, -1e-9), method='bounded')\n        x_R_cl = res_cl.x\n        W_R_cl = res_cl.fun\n        \n        # Calculate activation energy for the cluster model\n        W_TS_cl = W_cl(x_TS)\n        dG_cl = W_TS_cl - W_R_cl\n\n        # --- QM/MM Model Calculation ---\n        # Find reactant minimum for the QM/MM model\n        res_qmmm = minimize_scalar(W_qmmm, bounds=(-2.0 * x0, -1e-9), method='bounded')\n        x_R_qmmm = res_qmmm.x\n        W_R_qmmm = res_qmmm.fun\n        \n        # Calculate activation energy for the QM/MM model\n        W_TS_qmmm = W_qmmm(x_TS)\n        dG_qmmm = W_TS_qmmm - W_R_qmmm\n\n        # --- Interpretation and Classification ---\n        # Estimate catalytic contributions based on perturbations to the cluster model\n        # evaluated at the cluster model's stationary points (TS and Reactant).\n        \n        # Contribution from electrostatic fluctuations\n        fluc_lowering = 0.0\n        if sigma_E > 0:\n            fluc_term_at_ts = -0.5 * beta * sigma_E**2 * q(x_TS)**2\n            fluc_term_at_r = -0.5 * beta * sigma_E**2 * q(x_R_cl)**2\n            fluc_lowering = -(fluc_term_at_ts - fluc_term_at_r)\n        \n        # Contribution from entropic gating\n        gate_lowering = 0.0\n        if c_g > 0:\n            gate_term_at_ts = -(1.0 / beta) * np.log(g(x_TS))\n            gate_term_at_r = -(1.0 / beta) * np.log(g(x_R_cl))\n            gate_lowering = -(gate_term_at_ts - gate_term_at_r)\n\n        # Determine significance\n        threshold = 0.05\n        is_fluc_significant = fluc_lowering > threshold\n        is_gate_significant = gate_lowering > threshold\n\n        # Assign classification code C\n        # 0: none, 1: fluc, 2: gate, 3: both\n        C = int(is_fluc_significant) + 2 * int(is_gate_significant)\n\n        results.append([round(dG_cl, 3), round(dG_qmmm, 3), C])\n    \n    # Format the results into the required single-line string\n    # e.g., [[val1, val2, val3], [val4, val5, val6]]\n    result_str = \"[\" + \",\".join([str(r) for r in results]) + \"]\"\n    print(result_str.replace(\" \", \"\"))\n\n\nsolve()\n\n```", "id": "2452929"}]}