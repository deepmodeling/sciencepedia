{"hands_on_practices": [{"introduction": "当我们使用为三维周期性系统设计的代码来模拟二维材料（如表面或单层材料）时，我们必须将材料层与其周期性镜像隔离开。这个练习旨在挑战你设计一个标准的计算实验，以确定需要多少“真空层”才能实现这种隔离。这是获得有物理意义的表面性质（如功函数或表面能）的关键一步。[@problem_id:2460152]", "problem": "您正在使用基于平面波基组的三维周期性边界条件下的周期性密度泛函理论 (DFT) 来模拟单层石墨烯。该超胞在 $xy$ 平面内包含一个单层石墨烯，并沿 $z$ 方向设置了真空层以分离周期性镜像。沿 $z$ 方向的胞长为 $L_z = L_{\\mathrm{slab}} + L_{\\mathrm{vac}}$，其中 $L_{\\mathrm{slab}}$ 是石墨烯板层的物理厚度，$L_{\\mathrm{vac}}$ 是真空间距。该板层整体呈电中性且对称（无内禀偶极），但周期性镜像间的赝相互作用仍可能通过长程库仑和交换关联尾部以及波函数溢出而产生。您必须确定一个足够大的 $L_{\\mathrm{vac}}$，以使对于所关心的物理量而言，周期性镜像间的相互作用可以忽略不计。\n\n下列哪种计算实验是确定足够大的 $L_{\\mathrm{vac}}$ 的最恰当方法？\n\nA. 进行一系列计算，固定面内晶格、板层几何结构、平面波截断能、赝势和面内 $k$ 点采样，仅将 $L_{\\mathrm{vac}}$ 按单调序列 $L_{\\mathrm{vac}}^{(1)} < L_{\\mathrm{vac}}^{(2)} < \\cdots$ 进行改变。对于每个 $L_{\\mathrm{vac}}^{(i)}$，计算每个原子的总能量 $E_{\\mathrm{tot}}/N$、原子在面外方向的受力 $F_z$、平面平均静电势 $\\overline{V}(z) = \\frac{1}{A}\\int_A V(x,y,z)\\,dx\\,dy$（以验证真空中存在平坦的平台区），以及任何表面敏感的性质，如功函数 $W$。如果板层不对称，则引入偶极校正；如果对称，则进行包含和不包含校正的两种计算以作检查。选择能使所有被监测量在连续的 $L_{\\mathrm{vac}}^{(i)}$ 之间的变化量都低于预设容差 $\\varepsilon_E$、$\\varepsilon_F$ 和 $\\varepsilon_W$ 的最小 $L_{\\mathrm{vac}}$ 值。\n\nB. 协同改变 $L_{\\mathrm{vac}}$ 和沿 $z$ 方向的 $k$ 点采样，以保持乘积 $N_k^{(z)} L_{\\mathrm{vac}}$ 恒定，并在 $L_{\\mathrm{vac}}$ 很大时减少到仅使用 $\\Gamma$ 点。一旦在协同改变的设置下，每个胞的总能量 $E_{\\mathrm{tot}}$ 在一个小的容差范围内不再变化，就选择此时的 $L_{\\mathrm{vac}}$。\n\nC. 采用一个标准的真空厚度 $L_{\\mathrm{vac}} = 10\\,\\text{\\AA}$，因为石墨烯是电中性的且没有偶极，然后保持 $L_{\\mathrm{vac}}$ 固定，仅对平面波截断能进行收敛性验证。\n\nD. 在 $z$ 方向施加偶极校正，并在一个方便的 $L_{\\mathrm{vac}}$ 值下运行一次计算。如果计算出的功函数 $W$ 与文献值在很小的误差范围内一致，则认为该 $L_{\\mathrm{vac}}$ 足够大，不再做进一步的改变。\n\nE. 改变板层中石墨烯的层数，直到二维布里渊区中的能带结构与体相石墨的能带结构相匹配，然后将 $L_{\\mathrm{vac}}$ 设置为等于石墨的层间距，以实现真实的分离。", "solution": "问题陈述是有效的。它描述了计算材料科学中的一个标准且根本性的挑战：使用基于三维周期性边界条件的计算框架来模拟二维系统，例如单层石墨烯。核心任务是确定在非周期性方向（$z$ 方向）上应添加多大的真空间距 $L_{\\mathrm{vac}}$，以最小化板层与其周期性镜像之间的赝相互作用，从而正确地模拟一个孤立的板层。这需要进行系统的收敛性测试。问题要求找出用于此目的的最恰当的计算实验。\n\n系统的收敛性测试涉及改变感兴趣的参数——在这里是 $L_{\\mathrm{vac}}$——同时保持所有其他计算参数固定。这使得人们能够分离出被改变的参数对所计算的物理可观量的影响。当 $L_{\\mathrm{vac}}$ 进一步增加时，所关心的性质在预定义的容差范围内不再变化，则认为真空已经收敛。需要监测的性质应该对我们试图消除的赝相互作用敏感。这些性质包括总能量 $E_{\\mathrm{tot}}$、原子受力 $F$ 以及像功函数 $W$ 这样的表面特性。\n\n让我们根据这一原则来评估每个选项。\n\nA. 这个选项提出了一个系统的收敛性测试。它正确地指出，必须进行一系列计算，单调增加 $L_{\\mathrm{vac}}$，同时保持所有其他关键计算参数固定：面内晶格常数、板层内部几何结构、平面波能量截断、赝势以及面内 $k$ 点网格。这个过程正确地分离了真空间距的影响。选择监测的物理量——每个原子的总能量 ($E_{\\mathrm{tot}}/N$)、力 ($F_z$)、平面平均静电势 ($\\overline{V}(z)$) 和功函数 ($W$)——是全面且恰当的。总能量是 DFT 计算的主要输出。力对于结构弛豫至关重要。真空中平坦的电势平台是板层被孤立的直接视觉确认。功函数已知对表面静电学特别敏感，因此是判断周期性镜像赝相互作用的一个良好指标。关于偶极校正的讨论也是正确的；对于非对称板层，这是必需的，而对于对称板层，它可作为一个有用的诊断性检查。所描述的收敛标准——选择使被监测量的变化低于设定容差的最小 $L_{\\mathrm{vac}}$——是收敛的标准定义。整个过程代表了确定足够真空间距的教科书式的“最佳实践”。因此，这个选项是正确的。\n\nB. 这个选项建议协同改变真空间距 $L_{\\mathrm{vac}}$ 和 $z$ 方向的 $k$ 点数 $N_k^{(z)}$。这在方法论上是根本错误的。根据定义，收敛性测试一次只能改变一个参数，以便明确地将结果的变化归因于该参数。通过同时改变 $L_{\\mathrm{vac}}$ 和 $N_k^{(z)}$，人们无法区分周期性镜像相互作用减弱的影响和改变倒易空间采样的影响。对于一个二维板层，沿 $z$ 方向没有物理的能带色散，因此该方向上正确的 $k$ 点采样是在 $\\Gamma$ 点 ($k_z=0$) 的单个点。除非真空层非常大，否则沿 $z$ 方向引入更多 $k$ 点会产生人为的色散，而且它是一个应该被单独收敛（或者更确切地说，固定为1）的参数。将其收敛性与真空间距的收敛性混为一谈是错误的。因此，这个选项描述了一个无效的科学程序。\n\nC. 这个选项主张采用一个固定的、标准的 $L_{\\mathrm{vac}} = 10\\,\\text{\\AA}$ 值，而不进行收敛性测试。这种方法是不科学且不可靠的。虽然对于某些简单的中性体系，$10\\,\\text{\\AA}$ 可能足够，但这并非一个普适的有效选择。所需的真空层厚度取决于材料的性质（例如，波函数溢出到真空中的程度）、所用的 DFT 泛函（具有非局域相关作用的泛函，如 vdW-DF，可能具有更长程的相互作用），以及具体计算的性质（例如，功函数比总能量更敏感）。计算科学中的良好科学实践要求对所研究的特定系统的所有近似进行验证，而不是依赖于经验法则。因此，这个选项是错误的。\n\nD. 这个选项建议在任意的 $L_{\\mathrm{vac}}$ 下进行单次计算，如果结果（功函数 $W$）与文献值匹配，就接受该设置。这是一种“以结果论证”的形式，是拙劣的科学方法。与外部数值的一致性可能是偶然的，也可能是由于误差抵消（例如，不充分的真空层可能被文献研究中不同的泛函、赝势或基组选择所抵消）。收敛性测试的主要目标是确保自己计算的内部一致性和准确性，这与外部参考文献无关。必须首先收敛计算参数以产生可靠的结果，然后才能将其与实验或其他理论数据进行比较。此外，默认对对称板层应用偶极校正并非标准做法；如果电荷密度已适当收敛且对称，它理想情况下应产生零偶极矩。因此，这个选项是错误的。\n\nE. 这个选项描述的过程在概念上与既定目标相反。问题是要模拟一个孤立的石墨烯*单层*。这个选项建议修改体系以复制*体相石墨*的性质，而体相石墨是一种三维材料，其层间相互作用是内禀且至关重要的。添加真空层的目的是*消除*层间相互作用，而不是再现它们。将 $L_{\\mathrm{vac}}$ 设置为等于石墨的层间距（约 $3.35\\,\\text{\\AA}$）将在单层的周期性镜像之间引起巨大的、非物理的电子和静电相互作用，完全无法模拟一个孤立的二维薄片。因此，这个选项从根本上是错误的，因为它误解了所要模拟的物理体系。\n\n基于以上分析，选项A是唯一描述了在周期性板层计算中确定足够真空间距的科学严谨且恰当的方法。\n\n对各选项的最终评判：\nA. **正确**\nB. **错误**\nC. **错误**\nD. **错误**\nE. **错误**", "answer": "$$\\boxed{A}$$", "id": "2460152"}, {"introduction": "与具有带隙的绝缘体不同，金属具有部分填充的能带，形成费米面。这个练习呈现了一个常见的计算陷阱：一个已知金属的计算错误地显示出微小的带隙。你将诊断最可能的数值原因，从而学习到使用足够密集的$k$点网格来充分采样布里渊区，以正确捕捉金属性质的极端重要性。[@problem_id:2460180]", "problem": "对一个金属超胞的周期性密度泛函理论 (DFT) 计算，在费米能级处得到了一个 $0.01\\,\\mathrm{eV}$ 的很小但不为零的带隙。假设赝势、基组和离子几何结构都已收敛。在周期性 DFT 中，电子数和其他可观测量通过以下形式的布里渊区积分进行评估：\n$$\nN = \\sum_{n} \\int_{\\mathrm{BZ}} \\frac{d\\mathbf{k}}{\\Omega_{\\mathrm{BZ}}}\\, f\\!\\left(E_{n}(\\mathbf{k}) - E_{\\mathrm{F}}\\right),\n$$\n其中 $f$ 是费米–狄拉克 (Fermi–Dirac) 分布，$E_{n}(\\mathbf{k})$ 是能带能量，$E_{\\mathrm{F}}$ 是费米能。在实践中，该积分通过在一个带有权重 $w_{\\mathbf{k}}$ 的有限 $\\mathbf{k}$ 点网格上求和来近似：\n$$\nN \\approx \\sum_{n}\\sum_{\\mathbf{k}} w_{\\mathbf{k}}\\, f\\!\\left(E_{n}(\\mathbf{k}) - E_{\\mathrm{F}}\\right).\n$$\n对于真正的金属，在 $E_{\\mathrm{F}}$ 处的态密度不为零，并且存在一个由 $E_{n}(\\mathbf{k}) = E_{\\mathrm{F}}$ 定义的连续费米面。仅基于此框架，并且不假设哈密顿量存在任何病态问题，以下哪项是与 $\\mathbf{k}$ 点网格相关、导致在 $E_{\\mathrm{F}}$ 附近获得赝带隙的最可能原因？\n\nA. $\\mathbf{k}$ 点网格太稀疏，无法解析费米面的穿越，因此离散化采样错过了能量 $E_{n}(\\mathbf{k}) \\approx E_{\\mathrm{F}}$ 的 $\\mathbf{k}$ 点，从而产生一个赝带隙。\n\nB. $\\mathbf{k}$ 点网格太密集，对许多 $\\mathbf{k}$ 点的过度平均在数值上将能带交叉平滑成一个表观的带隙。\n\nC. 使用以 $\\Gamma$ 点为中心的 Monkhorst–Pack 网格而不是对称性移动的网格，会内在地阻止金属态的表示，从而打开一个带隙。\n\nD. $\\mathbf{k}$ 点权重 $w_{\\mathbf{k}}$ 被归一化以满足 $\\sum_{\\mathbf{k}} w_{\\mathbf{k}} = 1$ 而不是归一化到布里渊区的体积，这人为地降低了 $E_{\\mathrm{F}}$ 处的态密度并打开了一个带隙。", "solution": "对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- **体系：** 金属超胞。\n- **方法：** 周期性密度泛函理论 (DFT)。\n- **观测结果：** 在费米能级 $E_{\\mathrm{F}}$ 处计算出 $0.01\\,\\mathrm{eV}$ 的带隙。\n- **假设：** 赝势、基组和离子几何结构已收敛。哈密顿量无病态问题。\n- **背景（连续情况）：** 电子数 $N$ 通过布里渊区 (BZ) 积分计算：\n$$\nN = \\sum_{n} \\int_{\\mathrm{BZ}} \\frac{d\\mathbf{k}}{\\Omega_{\\mathrm{BZ}}}\\, f\\!\\left(E_{n}(\\mathbf{k}) - E_{\\mathrm{F}}\\right)\n$$\n其中 $f$ 是费米–狄拉克 (Fermi–Dirac) 分布，$E_{n}(\\mathbf{k})$ 是能带能量，$\\Omega_{\\mathrm{BZ}}$ 是布里渊区的体积。\n- **背景（离散情况）：** 该积分通过在有限 $\\mathbf{k}$ 点网格上进行加权求和来近似：\n$$\nN \\approx \\sum_{n}\\sum_{\\mathbf{k}} w_{\\mathbf{k}}\\, f\\!\\left(E_{n}(\\mathbf{k}) - E_{\\mathrm{F}}\\right)\n$$\n- **定义：** 真正的金属在 $E_{\\mathrm{F}}$ 处具有非零的态密度，并存在一个由 $E_{n}(\\mathbf{k}) = E_{\\mathrm{F}}$ 定义的连续费米面。\n- **问题：** 与 $\\mathbf{k}$ 点网格相关的、导致赝带隙的最可能原因是什么？\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据、提法恰当且客观。它描述了在固态电子结构计算中遇到的一种常见的数值赝象。所提供的方程是周期性体系中布里渊区积分的标准公式。所作的假设将焦点正确地缩小到该积分的数值近似问题上。术语精确，并在计算材料科学的背景下使用正确。该问题内容自洽，没有矛盾或事实错误。\n\n**第三步：结论与行动**\n问题有效。将推导解答。\n\n**基于原理的推导**\n在固体物理学中，电子能带结构 $E_n(\\mathbf{k})$ 描述了在第一布里渊区内，电子的允许能级作为其晶格动量 $\\mathbf{k}$ 的函数。对于金属，在绝对零度下，电子态被填充至费米能 $E_{\\mathrm{F}}$。关键在于，一个或多个能带会穿过这个能级，这意味着存在一组 $\\mathbf{k}$ 矢量使得 $E_n(\\mathbf{k}) = E_{\\mathrm{F}}$。这组点构成了费米面。因此，在 $E_{\\mathrm{F}}$ 上下紧邻处存在连续的态分布，导致费米能级处的态密度 (DOS) 非零，即 $g(E_{\\mathrm{F}}) \\neq 0$。不存在带隙。\n\n问题源于对连续现实的数值近似。对连续变量 $\\mathbf{k}$ 的积分被替换为在有限个点 $\\{\\mathbf{k}_i\\}$ 上的离散求和。DFT 计算只提供在这些特定点上的能带能量 $E_n(\\mathbf{k}_i)$。电子态密度以及诸如总能量和电子数等派生量，都是基于这组离散的能级构建的。\n\n当计算出的能级集合 $\\{E_n(\\mathbf{k}_i)\\}$ 在费米能附近的某一范围内不包含任何值时，就会观测到赝带隙。也就是说，对于所有采样点 $\\mathbf{k}_i$ 和所有能带 $n$，能量本征值 $E_n(\\mathbf{k}_i)$ 要么明显低于 $E_{\\mathrm{F}}$，要么明显高于 $E_{\\mathrm{F}}$。真实的体系是金属性的，这意味着连续函数 $E_n(\\mathbf{k})$ 确实会穿过 $E_{\\mathrm{F}}$。数值计算之所以未能检测到这一点，是因为采样点 $\\{\\mathbf{k}_i\\}$ 之间相距太远。离散网格太“稀疏”(coarse)。真实的连续费米面完全有可能位于 $\\mathbf{k}$ 空间中采样点*之间*的区域。因此，计算会错过费米能量附近的态，导致确定占据数和 $E_{\\mathrm{F}}$ 的算法将 $E_{\\mathrm{F}}$ 置于一个人为的空隙中，从而产生一个赝带隙。这是一个典型的欠采样误差的例子。解决此问题的方法是增加 $\\mathbf{k}$ 点网格的密度，直到计算出的性质（如总能量和带隙的有无）收敛为止。\n\n**逐项分析**\n\n**A. $\\mathbf{k}$ 点网格太稀疏，无法解析费米面的穿越，因此离散化采样错过了能量 $E_{n}(\\mathbf{k}) \\approx E_{\\mathrm{F}}$ 的 $\\mathbf{k}$ 点，从而产生一个赝带隙。**\n这个陈述准确地描述了上面推导的现象。一个稀疏的网格是对布里渊区的稀疏采样。对于具有连续费米面的金属，如果采样点不够密集，它们可能无法落在费米面上或其附近。这样，计算出的本征值集合将在费米能级周围显示出一个在真实物理体系中不存在的带隙。这是在金属的 DFT 计算中观察到小的赝带隙的最常见原因。\n**结论：正确**\n\n**B. $\\mathbf{k}$ 点网格太密集，对许多 $\\mathbf{k}$ 点的过度平均在数值上将能带交叉平滑成一个表观的带隙。**\n这是不正确的。更密集的 $\\mathbf{k}$ 点网格可以更精确地近似布里渊区积分。随着 $\\mathbf{k}$ 点数量的增加，采样变得更精细，*更*有可能找到费米能级附近的态，从而闭合任何赝带隙并正确地描述金属性。“过度平均”恰恰是收敛到正确的连续极限所需要的。它不会产生带隙，而是更准确地解析电子结构。对于金属性体系，密集的网格是收敛的要求，而不是误差的来源。\n**结论：不正确**\n\n**C. 使用以 $\\Gamma$ 点为中心的 Monkhorst–Pack 网格而不是对称性移动的网格，会内在地阻止金属态的表示，从而打开一个带隙。**\n这个陈述是错误的。以 $\\Gamma$ 点为中心的网格和移动的网格（后者是原始的 Monkhorst-Pack 方案）都是对布里渊区进行采样的标准方法。两者之间的选择会影响收敛速度，这取决于晶体对称性和能带结构中重要特征的位置。然而，这两种方案都不会“内在地阻止”金属态的表示。如果一个网格，无论其中心如何，只要足够密集，就能提供对电子结构的准确描述，包括其金属性。问题在于网格的密度（稀疏性），而不是原则上其中心类型。\n**结论：不正确**\n\n**D. $\\mathbf{k}$ 点权重 $w_{\\mathbf{k}}$ 被归一化以满足 $\\sum_{\\mathbf{k}} w_{\\mathbf{k}} = 1$ 而不是归一化到布里渊区的体积，这人为地降低了 $E_{\\mathrm{F}}$ 处的态密度并打开了一个带隙。**\n这是不正确的，原因有二。首先，权重 $w_{\\mathbf{k}}$ 的归一化影响积分量（如总电子数或 DOS）的大小，但它不决定能级的*存在*与否。带隙是在给定范围内不存在能级。本征值集合 $\\{E_n(\\mathbf{k}_i)\\}$ 首先被计算出来，权重在其后的求和/积分步骤中应用。改变权重不会从这个集合中创造或移除能级。其次，对于问题中给出的积分形式 $\\int_{\\mathrm{BZ}} (\\dots) d\\mathbf{k} / \\Omega_{\\mathrm{BZ}}$，它代表在布里渊区上的平均，其对应的离散求和 $\\sum_{\\mathbf{k}} w_{\\mathbf{k}} (\\dots)$ 要求权重之和为1，即 $\\sum_{\\mathbf{k}} w_{\\mathbf{k}} = 1$。因此，所述的归一化对于给定的公式实际上是正确的。\n**结论：不正确**", "answer": "$$\\boxed{A}$$", "id": "2460180"}, {"introduction": "为了使DFT计算可行，我们通常用一个更平滑、更弱的赝势来替代复杂的芯层电子和强烈的原子核势。这个编码练习通过一个简化的一维模型，让你亲身体验赝势的“硬度”——衡量其尖锐或柔和程度的指标——是如何直接影响一个关键的计算性质：材料的带隙。[@problem_id:2460119]", "problem": "考虑在一个一维周期性晶体势中的电子，该晶体势是晶体硅的一个简化模型，并使用Kohn–Sham密度泛函理论（KS-DFT）进行描述。设晶格常数为 $a = 5.431\\,\\text{ångström}$。假设晶格周期性的局域赝势由其在倒格矢大小 $G = 2\\pi/a$ 处的第一个傅里叶分量主导。赝势的“硬度”由一个正实数参数 $H$ (单位为 $\\text{bohr}^{-1}$) 参数化，该参数定义为核半径 $r_c$ (单位为 bohr) 的倒数，即 $r_c = 1/H$。晶格周期性Kohn–Sham势的第一个傅里叶系数由下式给出：\n$$\nV_G(H) = V_0 \\exp\\!\\left(-\\frac{(G\\, r_c)^2}{2}\\right),\n$$\n其中 $V_0 = 1.2\\,\\text{electronvolt}$。将电子视为近自由电子，并考虑在布里渊区（BZ）边界处，即波矢 $k = G/2$ 处的直接带隙。该带隙由存在周期势 $V_G(H)$ 时的一维平面波KS哈密顿量确定。\n\n程序中需要使用的物理常数和单位关系如下，任何所需的单位转换都必须在程序中明确执行：\n- $1\\,\\text{ångström} = 1.8897259886\\,\\text{bohr}$。\n- 能量必须以电子伏特为单位报告。\n\n您的任务是编写一个程序，对于每个给定的硬度值 $H$，计算该模型预测的BZ边界处的基本能带隙（单位为电子伏特）。以电子伏特表示每个结果，并四舍五入到三位小数。\n\n测试集：\n- 情况 1: $H = 0.3\\,\\text{bohr}^{-1}$。\n- 情况 2: $H = 0.5\\,\\text{bohr}^{-1}$。\n- 情况 3: $H = 0.833333333333\\,\\text{bohr}^{-1}$。\n- 情况 4: $H = 1.25\\,\\text{bohr}^{-1}$。\n- 情况 5: $H = 2.0\\,\\text{bohr}^{-1}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，顺序与上述测试集相同，例如，“[result1,result2,result3,result4,result5]”。每个条目必须是对应测试用例的带隙值，单位为电子伏特，四舍五入到三位小数（不应打印单位）。", "solution": "所提出的问题是基础固态理论中的一个标准练习，它在科学上是可靠、适定且客观的。这是一个有效的问题，可以使用应用于晶体固体的量子力学基本原理解答。我们将继续进行推导和求解。\n\n该问题要求计算一维晶体在布里渊区（BZ）边界处的直接能带隙。这个问题在近自由电子模型的框架下解决，该模型是一种求解弱周期势下单粒子Kohn-Sham（KS）方程的微扰方法。\n\n单个电子在周期势 $v_{KS}(x)$ 中的KS方程如下：\n$$\n\\left( -\\frac{\\hbar^2}{2m} \\frac{d^2}{dx^2} + v_{KS}(x) \\right) \\psi_k(x) = E_k \\psi_k(x)\n$$\n在没有势（$v_{KS}(x) = 0$）的情况下，电子是自由的，其本征函数是平面波 $\\psi_k^{(0)}(x) = A e^{ikx}$，具有连续的抛物线形能谱 $E_k^{(0)} = \\frac{\\hbar^2 k^2}{2m}$。在晶体中，势以晶格常数 $a$ 为周期，即 $v_{KS}(x+a) = v_{KS}(x)$。这样的势可以表示为关于倒格矢 $G_n = \\frac{2\\pi n}{a}$（其中 $n$ 为整数）的傅里叶级数。\n$$\nv_{KS}(x) = \\sum_{G} V_G e^{iGx}\n$$\n问题指出，该势由其第一个傅里叶分量主导，对应于倒格矢大小 $G = 2\\pi/a$。\n\n根据简并微扰理论，周期势对自由电子能量简并或近简并的电子态影响最大。这种情况发生在布里渊区边界处，即 $k = \\pm G/2 = \\pm \\pi/a$。在这些点上，波矢为 $k = G/2$ 和 $k' = k-G = -G/2$ 的自由电子态是简并的，具有相同的能量：\n$$\nE^{(0)}_{G/2} = E^{(0)}_{-G/2} = \\frac{\\hbar^2}{2m}\\left(\\frac{G}{2}\\right)^2\n$$\n周期势 $v_{KS}(x)$ 耦合了这两个态。为了找到新的能量，我们求解一个 $2 \\times 2$ 哈密顿矩阵的久期方程，该矩阵在这两个简并平面波态 $|k \\rangle = |G/2 \\rangle$ 和 $|k-G \\rangle = |-G/2 \\rangle$ 的基中构建：\n$$\n\\begin{vmatrix}\n\\langle G/2 | H | G/2 \\rangle - E & \\langle G/2 | H | -G/2 \\rangle \\\\\n\\langle -G/2 | H | G/2 \\rangle & \\langle -G/2 | H | -G/2 \\rangle - E\n\\end{vmatrix} = 0\n$$\n其中 $H = H_0 + v_{KS}(x)$。矩阵元为：\n$H_{11} = \\langle G/2 | H_0 + v_{KS} | G/2 \\rangle = E^{(0)}_{G/2} + V_{G=0}$。\n$H_{22} = \\langle -G/2 | H_0 + v_{KS} | -G/2 \\rangle = E^{(0)}_{-G/2} + V_{G=0}$。\n$H_{12} = \\langle G/2 | v_{KS} | -G/2 \\rangle = V_G$。\n$H_{21} = \\langle -G/2 | v_{KS} | G/2 \\rangle = V_{-G} = V_G^*$。\n\n假设平均势 $V_{G=0}$ 为能量零点，并记 $E_B = E^{(0)}_{G/2}$，久期方程变为：\n$$\n\\begin{vmatrix}\nE_B - E & V_G^* \\\\\nV_G & E_B - E\n\\end{vmatrix} = 0\n$$\n这得到 $(E_B - E)^2 - |V_G|^2 = 0$，从而导出两个不同的能量本征值：\n$$\nE_{\\pm} = E_B \\pm |V_G|\n$$\n周期势解除了简并，在布里渊区边界处打开了一个能隙 $E_g$。该能隙的大小是两个新能级之差：\n$E_g = E_+ - E_- = (E_B + |V_G|) - (E_B - |V_G|) = 2|V_G|$\n问题给出了傅里叶系数 $V_G$ 作为硬度参数 $H$ 的函数表达式：\n$$\nV_G(H) = V_0 \\exp\\!\\left(-\\frac{(G\\, r_c)^2}{2}\\right)\n$$\n其中 $V_0 = 1.2\\,\\text{eV}$, $r_c = 1/H$, $G = 2\\pi/a$。由于 $V_0$、$G$ 和 $r_c$ 都是实数，$V_G$ 是实数且为正。因此，带隙就是：\n$$\nE_g(H) = 2V_G(H) = 2 V_0 \\exp\\!\\left(-\\frac{1}{2}\\left(\\frac{G}{H}\\right)^2\\right)\n$$\n计算步骤如下：\n1.  使用给定的转换因子 $1\\,\\text{ångström} = 1.8897259886\\,\\text{bohr}$，将给定的晶格常数 $a = 5.431\\,\\text{ångström}$ 转换为 bohr。\n2.  计算倒格矢大小 $G = 2\\pi/a$。注意，如果 $a$ 的单位是 bohr，$G$ 的单位将是 $\\text{bohr}^{-1}$。\n3.  对于每个给定的硬度值 $H$（单位为 $\\text{bohr}^{-1}$），计算无量纲比值 $G/H$。\n4.  将该比值代入 $E_g(H)$ 的公式中，以计算带隙（单位为电子伏特），因为 $V_0$ 的单位是电子伏特。\n5.  按要求将每种情况的最终结果四舍五入到三位小数。\n此过程正确地确定了该简化模型所预测的带隙。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the fundamental energy band gap at the Brillouin zone boundary\n    for a 1D crystal model based on Kohn-Sham DFT.\n    \"\"\"\n\n    # Define the physical constants and parameters from the problem statement.\n    a_angstrom = 5.431  # Lattice constant in ångström\n    angstrom_to_bohr = 1.8897259886  # Conversion factor\n    V0_eV = 1.2  # Potential amplitude in electronvolts\n\n    # The test suite of hardness parameters H.\n    # Note: Case 3 is 5/6.\n    test_cases_H = [\n        0.3,                   # Case 1\n        0.5,                   # Case 2\n        0.833333333333,        # Case 3\n        1.25,                  # Case 4\n        2.0                    # Case 5\n    ]\n\n    # Perform unit conversions and pre-calculations.\n    # Convert lattice constant from ångström to bohr.\n    a_bohr = a_angstrom * angstrom_to_bohr\n\n    # Calculate the magnitude of the first reciprocal lattice vector.\n    # Units will be bohr^-1.\n    G = (2 * np.pi) / a_bohr\n\n    results = []\n    # Iterate through each test case for the hardness parameter H.\n    for H in test_cases_H:\n        # The core radius r_c is the inverse of the hardness H.\n        # r_c = 1.0 / H\n\n        # The band gap at the BZ boundary is given by E_g = 2 * |V_G|, where\n        # V_G = V0 * exp(-(G * r_c)^2 / 2).\n        # Since V_G is real and positive, |V_G| = V_G.\n        # We can write (G * r_c)^2 as (G / H)^2.\n        \n        # Calculate the argument of the exponential function.\n        # This term is dimensionless.\n        exponent_arg = -0.5 * (G / H)**2\n        \n        # Calculate the Fourier component of the potential V_G.\n        # The unit is eV since V0 is in eV.\n        V_G = V0_eV * np.exp(exponent_arg)\n        \n        # Calculate the energy band gap.\n        band_gap_eV = 2 * V_G\n        \n        # Round the result to three decimal places as specified.\n        rounded_band_gap = round(band_gap_eV, 3)\n        results.append(rounded_band_gap)\n\n    # Format the final output as a comma-separated list in square brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\n# Execute the main function.\nsolve()\n```", "id": "2460119"}]}