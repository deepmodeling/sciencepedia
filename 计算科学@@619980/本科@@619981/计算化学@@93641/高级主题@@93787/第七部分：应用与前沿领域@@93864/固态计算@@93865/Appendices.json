{"hands_on_practices": [{"introduction": "在材料科学中，预测材料如何响应外部压力是一个核心任务。本练习将介绍体模量 ($B_0$)，一个衡量材料抗压缩能力的物理量，并演示如何通过拟合总能量与体积的关系数据来计算它——这是计算材料科学中的一个标准流程。[@problem_id:2462510] 通过这个实践，您将学习到应用状态方程来提取关键的材料力学性能。", "problem": "晶体固体对均匀压缩的抵抗能力由等温体积模量（记为 $B_0$）来量化。对于像氮化钛 (TiN) 这样的立方晶体，在零压和 $0\\,\\mathrm{K}$ 温度下的体积模量可以通过将一组总能量 $E$ 作为体积 $V$ 函数的数据拟合到物态方程 (Equation of State, EOS) 来获得。在本问题中，请使用为能量作为体积函数的如下三阶 Birch–Murnaghan 物态方程：\n$$\nE(V) \\;=\\; E_0 \\;+\\; \\frac{9 V_0 B_0}{16} \\left\\{ \\left[\\left(\\frac{V_0}{V}\\right)^{\\tfrac{2}{3}} - 1\\right]^3 B_0' \\;+\\; \\left[\\left(\\frac{V_0}{V}\\right)^{\\tfrac{2}{3}} - 1\\right]^2 \\left(6 \\;-\\; 4 \\left(\\frac{V_0}{V}\\right)^{\\tfrac{2}{3}}\\right) \\right\\}.\n$$\n此处，$E_0$ 是平衡能量，$V_0$ 是平衡体积，$B_0$ 是体积模量，$B_0'$ 是体积模量的一阶压力导数。为保证单位一致性，能量使用电子伏特 (electronvolt)，体积使用立方埃 (cubic ångström)，并使用精确换算因子 $1\\,\\mathrm{eV/\\AA^3} = 160.21766208\\,\\mathrm{GPa}$ 在 $\\mathrm{eV/\\AA^3}$ 和 $\\mathrm{GPa}$ 之间转换体积模量。当将 $B_0$（单位为 $\\mathrm{GPa}$）代入上述公式时，请先使用 $B_0^{(\\mathrm{eV/\\AA^3})} = B_0^{(\\mathrm{GPa})}/160.21766208$ 将其转换为 $\\mathrm{eV/\\AA^3}$。\n\n你的任务是通过拟合由上述方程和所提供的参数集精确生成的能量-体积数据，来确定几个合成的 TiN 测试用例的 $B_0$。对每个测试用例，你都将得到一个元组 $(E_0, V_0, B_0, B_0')$ 和一组体积。请使用给定的参数和体积生成能量 $E(V)$。仅在测试用例 $3$ 中，在生成 $E(V)$ 后，为每个能量值添加 $+5.000\\,\\mathrm{eV}$ 的恒定偏移量，以模拟任意的参考能量偏移。然后，将同样的三阶 Birch–Murnaghan 能量函数拟合到所得的 $(V, E)$ 数据，以估算 $(E_0, V_0, B_0, B_0')$ 并报告 $B_0$。\n\n单位和报告要求：\n- 能量单位必须是 $\\mathrm{eV}$，体积单位必须是 $\\mathrm{\\AA^3}$。报告最终的体积模量值（单位为 $\\mathrm{GPa}$），并四舍五入到恰好两位小数。\n- 本问题不涉及角度。\n- 本问题不涉及百分比。\n\n测试套件：\n- 测试用例 $1$ (类 TiN，均衡采样)：\n  - 参数：$E_0 = -18.000\\,\\mathrm{eV}$，$V_0 = 19.200\\,\\mathrm{\\AA^3}$，$B_0 = 280.000\\,\\mathrm{GPa}$，$B_0' = 4.000$。\n  - 体积 (单位 $\\mathrm{\\AA^3}$)：$\\{17.664,\\;18.432,\\;18.816,\\;19.200,\\;19.584,\\;19.968,\\;20.736\\}$。\n- 测试用例 $2$ (类 TiN，稍硬且采样窗口不对称)：\n  - 参数：$E_0 = -18.500\\,\\mathrm{eV}$，$V_0 = 19.000\\,\\mathrm{\\AA^3}$，$B_0 = 300.000\\,\\mathrm{GPa}$，$B_0' = 4.200$。\n  - 体积 (单位 $\\mathrm{\\AA^3}$)：$\\{17.860,\\;18.240,\\;18.620,\\;19.000,\\;19.380,\\;19.760,\\;20.140\\}$。\n- 测试用例 $3$ (类 TiN，平衡点附近窄范围采样且带恒定能量偏移)：\n  - 参数：$E_0 = -19.200\\,\\mathrm{eV}$，$V_0 = 19.100\\,\\mathrm{\\AA^3}$，$B_0 = 250.000\\,\\mathrm{GPa}$，$B_0' = 3.800$。\n  - 体积 (单位 $\\mathrm{\\AA^3}$)：$\\{18.8135,\\;19.0045,\\;19.1000,\\;19.1955,\\;19.3865\\}$。\n  - 从 EOS 计算出 $E(V)$ 后，为每个能量值加上 $+5.000\\,\\mathrm{eV}$。\n\n要求的最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按测试用例 1、测试用例 2 和测试用例 3 的顺序排列。每个条目都是拟合得到的体积模量 $B_0$（单位为 $\\mathrm{GPa}$），四舍五入到恰好两位小数。例如：$[280.00,300.00,250.00]$。", "solution": "所给出的问题是计算材料科学领域中一个有效且定义明确的练习，具体涉及物态方程 (EOS) 数据的分析。该问题要求通过将合成的能量-体积数据拟合到三阶 Birch–Murnaghan EOS，来确定立方固体的等温体积模量 $B_0$。该问题具有科学依据，逻辑上一致，并提供了所有必要的数据和约束。\n\n问题的核心在于将非线性最小二乘拟合应用于一个已知的物理模型。其控制方程是三阶 Birch–Murnaghan EOS，它将固体的总能量 $E$ 描述为体积 $V$ 的函数：\n$$\nE(V) \\;=\\; E_0 \\;+\\; \\frac{9 V_0 B_0}{16} \\left\\{ \\left[\\left(\\frac{V_0}{V}\\right)^{\\tfrac{2}{3}} - 1\\right]^3 B_0' \\;+\\; \\left[\\left(\\frac{V_0}{V}\\right)^{\\tfrac{2}{3}} - 1\\right]^2 \\left(6 \\;-\\; 4 \\left(\\frac{V_0}{V}\\right)^{\\tfrac{2}{3}}\\right) \\right\\}\n$$\n通过拟合需要确定的参数是平衡能量 $E_0$、平衡体积 $V_0$、体积模量 $B_0$ 及其一阶压力导数 $B_0'$。\n\n对每个测试用例，指定的流程包括两个主要步骤：\n$1$. **数据生成**：首先使用提供的“真实”参数（$E_0, V_0, B_0, B_0'$）和一系列体积值，合成一组能量-体积数据对 $(V, E)$。对于测试用例 3，在所有计算出的能量上增加一个 $+5.000\\,\\mathrm{eV}$ 的恒定能量偏移。这模拟了参考能量的变化，这种变化应该只影响 $E_0$ 的拟合值，而保持其他参数（如 $B_0$）不变，因为这些参数取决于 $E(V)$ 曲线的形状，而不是其绝对垂直位置。\n\n$2$. **参数拟合**：然后，将合成的 $(V, E)$ 数据作为非线性最小二乘拟合程序的输入。目标是找到一组参数 $(E_0, V_0, B_0, B_0')$，当它们被代入 Birch–Murnaghan EOS 模型时能最好地复现数据。主要关心的值是拟合得到的体积模量 $B_0$。\n\n这项任务将使用 `scipy.optimize` 库中的 `curve_fit` 函数来完成，该函数实现了用于非线性优化的 Levenberg-Marquardt 算法。该函数需要一个用于拟合的模型函数、自变量数据（$V$）、因变量数据（$E$）以及一组参数的初始猜测值。\n\n模型函数将是 Birch–Murnaghan EOS 的直接实现。一个关键细节是单位的处理。该方程要求体积模量 $B_0$ 的单位是能量每体积，具体为 $\\mathrm{eV/\\AA^3}$。而 $B_0$ 的输入和输出值是以吉帕斯卡 ($\\mathrm{GPa}$) 为单位指定的。因此，必须在模型函数内部正确应用换算因子 $1\\,\\mathrm{eV/\\AA^3} = 160.21766208\\,\\mathrm{GPa}$。拟合函数将被定义为接受以 $\\mathrm{GPa}$ 为单位的 $B_0$ 并在内部执行转换。\n\n为确保拟合算法的稳定性和成功，合理的参数初始猜测值是必要的。这些值可以直接从输入的 $(V, E)$ 数据中估算得出：\n- 平衡体积的初始猜测值 $V_0^{\\text{guess}}$ 是数据集中对应最低能量的体积。\n- 平衡能量的初始猜测值 $E_0^{\\text{guess}}$ 就是这个最低能量值。\n- 对于体积模量 $B_0^{\\text{guess}}$，可以使用一个物理上合理的值（例如 $200\\,\\mathrm{GPa}$）作为起点。\n- 对于其压力导数 $B_0'^{\\text{guess}}$，一个典型值是 $4.0$。\n\n由于用于拟合的数据是由精确的模型函数生成的，不含任何噪声，因此非线性最小二乘拟合预计将以非常高的数值精度收敛到原始的“真实”参数。最后一步是报告每个测试用例拟合得到的 $B_0$（单位为 $\\mathrm{GPa}$），并按要求四舍五入到两位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting the Birch-Murnaghan EOS to synthetic data\n    to determine the bulk modulus B0 for three test cases.\n    \"\"\"\n\n    # Conversion factor from GPa to eV/Å^3\n    GPA_TO_EV_PER_A3 = 1.0 / 160.21766208\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {\n            \"params\": (-18.000, 19.200, 280.000, 4.000), # (E0, V0, B0_gpa, B0_prime)\n            \"volumes\": np.array([17.664, 18.432, 18.816, 19.200, 19.584, 19.968, 20.736]),\n            \"energy_offset\": 0.0\n        },\n        {\n            \"params\": (-18.500, 19.000, 300.000, 4.200),\n            \"volumes\": np.array([17.860, 18.240, 18.620, 19.000, 19.380, 19.760, 20.140]),\n            \"energy_offset\": 0.0\n        },\n        {\n            \"params\": (-19.200, 19.100, 250.000, 3.800),\n            \"volumes\": np.array([18.8135, 19.0045, 19.1000, 19.1955, 19.3865]),\n            \"energy_offset\": 5.000\n        }\n    ]\n\n    def birch_murnaghan_eos(V, E0, V0, B0_gpa, B0_prime):\n        \"\"\"\n        Third-order Birch-Murnaghan Equation of State.\n        \n        Args:\n            V (np.ndarray): Volume(s) in Å^3.\n            E0 (float): Equilibrium energy in eV.\n            V0 (float): Equilibrium volume in Å^3.\n            B0_gpa (float): Bulk modulus in GPa.\n            B0_prime (float): Pressure derivative of the bulk modulus.\n        \n        Returns:\n            np.ndarray: Energy(s) in eV.\n        \"\"\"\n        B0_ev_a3 = B0_gpa * GPA_TO_EV_PER_A3\n        \n        x = (V0 / V)**(2.0/3.0)\n        \n        term1 = ((x - 1)**3) * B0_prime\n        term2 = ((x - 1)**2) * (6 - 4*x)\n        \n        E = E0 + (9 * V0 * B0_ev_a3 / 16) * (term1 + term2)\n        \n        return E\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack the test case data\n        true_params = case[\"params\"]\n        volumes = case[\"volumes\"]\n        energy_offset = case[\"energy_offset\"]\n        \n        # 1. Generate synthetic energy-volume data\n        energies = birch_murnaghan_eos(volumes, *true_params)\n        \n        # Apply energy offset for Test Case 3\n        if energy_offset != 0.0:\n            energies += energy_offset\n            \n        # 2. Set up initial guesses for the fitting procedure\n        min_energy_index = np.argmin(energies)\n        E0_guess = energies[min_energy_index]\n        V0_guess = volumes[min_energy_index]\n        B0_guess = 200.0  # A typical physical value\n        B0_prime_guess = 4.0 # A typical physical value\n        initial_guesses = [E0_guess, V0_guess, B0_guess, B0_prime_guess]\n        \n        # 3. Perform the non-linear least squares fit\n        popt, _ = curve_fit(\n            f=birch_murnaghan_eos,\n            xdata=volumes,\n            ydata=energies,\n            p0=initial_guesses\n        )\n        \n        # 4. Extract the fitted bulk modulus\n        B0_fit_gpa = popt[2]\n        \n        results.append(B0_fit_gpa)\n\n    # Format the results as required\n    formatted_results = [f\"{res:.2f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2462510"}, {"introduction": "理解了晶体的结构稳定性之后，我们来探究其决定电学行为的电子特性。本练习将探索有效质量 ($m^*$) 的概念，这是一个描述电子在晶体中运动难易程度的关键参数。[@problem_id:2462494] 您将通过分析电子能带图的曲率来计算有效质量，从而将抽象的能带理论与重要的材料输运性质直接联系起来。", "problem": "本题是一个完全可复现的任务，旨在根据锗 (Germanium) 在导带底 (Conduction Band Minimum, CBM) 和价带顶 (Valence Band Maximum, VBM) 的一维能带曲率，确定载流子的标量有效质量。有效质量在能带极值点处由能量色散关系相对于晶体波矢的曲率定义。具体来说，对于沿某一固定方向的一维色散关系，能量是距极值点的波矢偏移量 $k$ 的函数，电子有效质量 $m_e^\\ast$ 和空穴有效质量 $m_h^\\ast$ 由在极值点处的曲率关系定义：\n- 对于电子（在极小值点），$m_e^\\ast$ 为正，并满足 $m_e^\\ast = \\hbar^2 / E''(k)$。\n- 对于空穴（在极大值点），$m_h^\\ast$ 定义为正，并满足 $m_h^\\ast = -\\hbar^2 / E''(k)$。\n此处，$E''(k)$ 表示能带能量对 $k$ 的二阶导数在极值点处的值，而 $\\hbar$ 是约化普朗克常数。\n\n使用以下物理常数（在您的计算中请精确使用这些值）：\n- 约化普朗克常数 $\\hbar = 1.054571817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$。\n- 基本电荷 $e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$。\n- 自由电子质量 $m_e = 9.1093837015\\times 10^{-31}\\ \\mathrm{kg}$。\n\n下面所有的能量 $E$ 均以电子伏特 (eV) 为单位，所有波矢偏移量 $k$ 均以米分之一 ($\\mathrm{m}^{-1}$) 为单位。将曲率从 $\\mathrm{eV}$ 转换为 $\\mathrm{J}$ 时，请使用换算因子 $1\\ \\mathrm{eV} = e\\ \\mathrm{J}$。计算并报告每种情况下的无量纲质量比 $m^\\ast/m_e$。最终答案请表示为四舍五入到六位小数的十进制数。本问题不涉及角度。\n\n输入数据以沿单一方向的极值点附近的色散关系 $E(k)$ 的离散样本形式提供。对于每个测试用例，您将获得一个波矢偏移量 $k$（相对于沿选定方向的极值点）的列表以及对应的能量 $E(k)$。每个测试用例还指明了其对应的是电子 (CBM) 还是空穴 (VBM)。您的程序必须从这些样本中推断出极值点处的曲率 $E''(k)$，应用上述定义，并返回 $m^\\ast/m_e$。\n\n测试套件（每个用例相互独立）：\n- 用例 1（L 谷附近的导带底电子，纵向）：\n  - $k = \\left[ -2.0\\times 10^{9},\\ -1.0\\times 10^{9},\\ 0.0,\\ 1.0\\times 10^{9},\\ 2.0\\times 10^{9} \\right]\\ \\mathrm{m}^{-1}$\n  - $E(k) = \\left[ 0.755892,\\ 0.683973,\\ 0.660000,\\ 0.683973,\\ 0.755892 \\right]\\ \\mathrm{eV}$\n  - 载流子类型: 电子。\n- 用例 2（L 谷附近的导带底电子，横向）：\n  - $k = \\left[ -2.0\\times 10^{9},\\ -1.0\\times 10^{9},\\ 0.0,\\ 1.0\\times 10^{9},\\ 2.0\\times 10^{9} \\right]\\ \\mathrm{m}^{-1}$\n  - $E(k) = \\left[ 2.519760,\\ 1.124940,\\ 0.660000,\\ 1.124940,\\ 2.519760 \\right]\\ \\mathrm{eV}$\n  - 载流子类型: 电子。\n- 用例 3（Γ 点附近的价带顶重空穴）：\n  - $k = \\left[ -2.0\\times 10^{9},\\ -1.0\\times 10^{9},\\ 0.0,\\ 1.0\\times 10^{9},\\ 2.0\\times 10^{9} \\right]\\ \\mathrm{m}^{-1}$\n  - $E(k) = \\left[ -0.544528,\\ -0.136132,\\ 0.0,\\ -0.136132,\\ -0.544528 \\right]\\ \\mathrm{eV}$\n  - 载流子类型: 空穴。\n- 用例 4（Γ 点附近的价带顶轻空穴，边界尺度采样）：\n  - $k = \\left[ -1.0\\times 10^{9},\\ 0.0,\\ 1.0\\times 10^{9} \\right]\\ \\mathrm{m}^{-1}$\n  - $E(k) = \\left[ -0.866295,\\ 0.0,\\ -0.866295 \\right]\\ \\mathrm{eV}$\n  - 载流子类型: 空穴。\n- 用例 5（Γ 点附近的价带顶重空穴，用于数值敏感性测试的极小 $k$ 值采样）：\n  - $k = \\left[ -1.0\\times 10^{8},\\ -5.0\\times 10^{7},\\ 0.0,\\ 5.0\\times 10^{7},\\ 1.0\\times 10^{8} \\right]\\ \\mathrm{m}^{-1}$\n  - $E(k) = \\left[ -0.00136132,\\ -0.00034033,\\ 0.0,\\ -0.00034033,\\ -0.00136132 \\right]\\ \\mathrm{eV}$\n  - 载流子类型: 空穴。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按用例 1 到 5 的顺序排列结果。列表中的每个条目都是四舍五入到六位小数的 $m^\\ast/m_e$ 值，例如：$\\left[ 1.234567,0.123456,0.654321,0.111111,0.222222 \\right]$。", "solution": "该问题是有效的。它提出了固态物理学中的一个标准任务：从给定的能量色散关系 $E(k)$ 确定载流子有效质量。所提供的数据、常数和定义在科学上是合理的、一致的，并且足以得出一个唯一解。\n\n该问题背后的基本原理是有效质量近似。在能带极值点附近，例如导带底 (CBM) 或价带顶 (VBM)，能量色散关系 $E(k)$ 可以用波矢 $k$ 的抛物线函数来近似。对于沿特定方向的一维色散关系，且极值点位于 $k=0$ 处，该近似由下式给出：\n$$\nE(k) \\approx E(0) + \\frac{1}{2} E''(0) k^2\n$$\n其中 $E(0)$ 是极值点处的能量，$E''(0)$ 是能量对波矢的二阶导数在 $k=0$ 处的值。这个二阶导数，即曲率，决定了载流子的有效质量 $m^\\ast$。\n\n问题中给出了电子和空穴有效质量的定义：\n- 对于导带底的电子（一个极小值点，因此 $E''(0) > 0$）：$m_e^\\ast = \\frac{\\hbar^2}{E''(0)}$。正曲率导致正的有效质量。\n- 对于价带顶的空穴（一个极大值点，因此 $E''(0) < 0$）：$m_h^\\ast = -\\frac{\\hbar^2}{E''(0)}$。负曲率与定义中的负号相结合，按照惯例，得到一个正的空穴有效质量。\n\n主要任务是从为每个用例提供的离散数据点 $(k_i, E_i)$ 中确定曲率 $E''(0)$ 的值。近似的抛物线性质表明，将数据拟合到一个二次多项式是正确且最直接的方法。我们将函数 $E(k) = ak^2 + bk + c$ 拟合到数据。从这个函数形式，二阶导数是一个常数：\n$$\nE'(k) = 2ak + b\n$$\n$$\nE''(k) = 2a\n$$\n因此，$E''(0) = 2a$。二次项的系数 $a$ 直接给出了所需的曲率。我们采用 `numpy.polyfit` 函数来执行一个 2 次的最小二乘多项式拟合，从而稳健地确定系数 $a$。\n\n计算的一个关键方面是单位的一致使用。输入数据提供的能量 $E$ 单位为电子伏特 ($\\mathrm{eV}$)，波矢 $k$ 单位为米分之一 ($\\mathrm{m}^{-1}$)。因此，多项式拟合将得到单位为 $\\mathrm{eV}\\cdot\\mathrm{m}^2$ 的系数 $a$。有效质量的公式要求所有量都使用国际单位制 (SI) 单位。约化普朗克常数 $\\hbar$ 的单位是 $\\mathrm{J}\\cdot\\mathrm{s}$。因此，曲率 $E''(0) = 2a$ 必须从 $\\mathrm{eV}\\cdot\\mathrm{m}^2$ 单位转换为 $\\mathrm{J}\\cdot\\mathrm{m}^2$ 单位。这个转换通过乘以基本电荷 $e$ 来实现，使用关系式 $1\\ \\mathrm{eV} = e\\ \\mathrm{J}$，其中 $e$ 的单位是库仑 ($C$)。\n因此，以 SI 单位表示的曲率为：\n$$\nE''_{\\mathrm{SI}}(0) = 2a \\times e\n$$\n\n每个测试用例的计算步骤如下：\n1.  使用 `numpy.polyfit` 函数，对给定的 $k$ 和 $E(k)$ 数据数组进行 2 次多项式拟合，以找到最佳拟合的二次多项式 $E(k) = ak^2 + bk + c$ 的系数。返回的第一个系数是 $a$。\n2.  计算以 SI 单位表示的二阶导数：$E''_{\\mathrm{SI}}(0) = 2 \\cdot a \\cdot e$。其中 $a$ 的单位是 $\\mathrm{eV}\\cdot\\mathrm{m}^2$，$e$ 的单位是 $\\mathrm{C}$。\n3.  根据载流子类型，使用适当的公式计算有效质量 $m^\\ast$（单位为千克 $\\mathrm{kg}$）：\n    - 如果是“电子”，$m^\\ast = \\frac{\\hbar^2}{E''_{\\mathrm{SI}}(0)}$。\n    - 如果是“空穴”，$m^\\ast = -\\frac{\\hbar^2}{E''_{\\mathrm{SI}}(0)}$。\n4.  计算最终的无量纲比值 $m^\\ast / m_e$，其中 $m_e$ 是自由电子质量。\n5.  按要求将所得比值四舍五入到六位小数。\n\n该程序应用于所有五个测试用例，并使用指定的物理常数：\n- $\\hbar = 1.054571817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$\n- $e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$\n- $m_e = 9.1093837015\\times 10^{-31}\\ \\mathrm{kg}$\n每个用例中提供的数据都是完美的二次关系，因此多项式拟合将是精确的。用例 3 和 5 描述了相同的能带，但 $k$ 的采样范围不同，它们将正确地得出相同的有效质量，这证明了抛物线近似在该区域的稳健性。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the dimensionless effective mass ratio m*/m_e for charge carriers\n    in Germanium from band curvature data.\n    \"\"\"\n    # Physical constants as defined in the problem statement\n    HBAR = 1.054571817e-34  # Reduced Planck constant in J.s\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    M_E = 9.1093837015e-31  # Free electron mass in kg\n\n    # Test suite from the problem statement\n    test_cases = [\n        {\n            \"k\": np.array([-2.0e9, -1.0e9, 0.0, 1.0e9, 2.0e9]),\n            \"E\": np.array([0.755892, 0.683973, 0.660000, 0.683973, 0.755892]),\n            \"type\": \"electron\"\n        },\n        {\n            \"k\": np.array([-2.0e9, -1.0e9, 0.0, 1.0e9, 2.0e9]),\n            \"E\": np.array([2.519760, 1.124940, 0.660000, 1.124940, 2.519760]),\n            \"type\": \"electron\"\n        },\n        {\n            \"k\": np.array([-2.0e9, -1.0e9, 0.0, 1.0e9, 2.0e9]),\n            \"E\": np.array([-0.544528, -0.136132, 0.0, -0.136132, -0.544528]),\n            \"type\": \"hole\"\n        },\n        {\n            \"k\": np.array([-1.0e9, 0.0, 1.0e9]),\n            \"E\": np.array([-0.866295, 0.0, -0.866295]),\n            \"type\": \"hole\"\n        },\n        {\n            \"k\": np.array([-1.0e8, -5.0e7, 0.0, 5.0e7, 1.0e8]),\n            \"E\": np.array([-0.00136132, -0.00034033, 0.0, -0.00034033, -0.00136132]),\n            \"type\": \"hole\"\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        k_data = case[\"k\"]\n        E_data = case[\"E\"]\n        carrier_type = case[\"type\"]\n\n        # Fit a quadratic polynomial E(k) = a*k^2 + b*k + c to the data.\n        # np.polyfit returns coefficients [a, b, c] for the polynomial.\n        coeffs = np.polyfit(k_data, E_data, 2)\n        a_coeff = coeffs[0]  # Coefficient 'a' is in units of eV*m^2\n\n        # The second derivative E''(0) is 2*a.\n        # Convert it to SI units (J*m^2) by multiplying with elementary charge.\n        E_double_prime_si = 2 * a_coeff * E_CHARGE\n        \n        # Calculate the effective mass m_star (in kg).\n        # The formulas are m_e* = hbar^2 / E'' and m_h* = -hbar^2 / E''.\n        hbar_squared = HBAR**2\n        \n        if carrier_type == \"electron\":\n            m_star = hbar_squared / E_double_prime_si\n        elif carrier_type == \"hole\":\n            m_star = -hbar_squared / E_double_prime_si\n        else:\n            # This case should not be reached with the given problem data.\n            raise ValueError(\"Invalid carrier type specified.\")\n\n        # Calculate the dimensionless effective mass ratio m*/m_e\n        mass_ratio = m_star / M_E\n        \n        # Format the result to six decimal places and add to the list.\n        results.append(f\"{mass_ratio:.6f}\")\n\n    # Print the final output in the required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2462494"}, {"introduction": "晶体中的原子并非静止不动，而是以称为声子 (phonons) 的集体模式在其平衡位置附近振动。本练习将模拟这些振动频率如何受到同位素取代的影响，从而清晰地展示原子质量与晶格动力学之间的基本关系。[@problem_id:2462547] 这个计算将帮助您理解在谐振子近似下，声子频率为何与振动原子质量的平方根成反比。", "problem": "要求您构建一个基于物理原理的计算模型，用以描述金刚石在经历从碳-12到碳-13的同位素取代时，其拉曼活性布里渊区中心光学声子的行为。请在 Born–Oppenheimer 近似和简谐近似的框架内进行。利用以下事实：在晶体中，给定波矢处的声子频率由质量加权的力常数矩阵（即动力学矩阵）的本征值得到，其中力常数矩阵取决于电子基态，而质量加权则取决于原子核质量。在同位素取代的晶体中，假设化学键和力常数因取代而保持不变，并且同位素无序可通过虚拟晶体近似（VCA）来近似，即每个晶格位置上的质量被替换为平均质量。\n\n从这些原理出发，推导同位素组分的变化如何改变金刚石中拉曼活性布里渊区中心光学声子的频率。将金刚石建模为具有相同原子种类的双原子基元，从而使相关的质量依赖性仅从动力学矩阵的质量加权中产生。请使用以下常数和约定：\n- 纯碳-12金刚石的基准拉曼频率：$\\nu_{12} = 1332.0$ $\\mathrm{cm}^{-1}$。\n- 同位素质量：$M_{12} = 12.000\\,\\mathrm{u}$，$M_{13} = 13.003355\\,\\mathrm{u}$。\n- 在虚拟晶体近似中，对于比例为 $x$ 的碳-13和比例为 $(1-x)$ 的碳-12，晶格位置上的质量为 $M_{\\mathrm{avg}} = (1-x) M_{12} + x M_{13}$。\n- 不涉及角度。所有要求的输出都必须是以 $\\mathrm{cm}^{-1}$ 为单位表示的声子频率。\n- 最终数值结果必须四舍五入到小数点后 $6$ 位。\n\n您的程序必须为以下碳-13比例 $x$ 的测试集计算拉曼活性布里渊区中心光学声子频率：\n- $x = 0$,\n- $x = 0.0107$,\n- $x = 0.5$,\n- $x = 1.0$,\n- $x = 1\\times 10^{-6}$。\n\n您的程序应生成单行输出，其中包含一个以逗号分隔的五个频率值列表（单位为 $\\mathrm{cm}^{-1}$），并用方括号括起来，例如 $[\\dots]$。确保每个值都精确四舍五入到小数点后 $6$ 位，并以该定点格式显示。", "solution": "所述问题是有效的。它以固态物理学原理，特别是晶格动力学为科学基础。该问题提法恰当，提供了所有必要的物理常数和明确的计算目标。问题中的假设——Born-Oppenheimer 近似、简谐近似、同位素取代下力常数的不变性，以及用于处理无序的虚拟晶体近似（VCA）——都是构建一个易于处理的模型的标准且恰当的假设。我们现在开始进行推导和求解。\n\n在简谐近似下，晶体中晶格振动的基本描述由原子位移的经典运动方程给出。对于晶胞 $l$ 中质量为 $M_k$、位移矢量为 $\\mathbf{u}(lk)$ 的原子 $k$，其方程为：\n$$\nM_k \\ddot{u}_{\\alpha}(lk) = - \\sum_{l'k'\\beta} \\Phi_{\\alpha\\beta}(lk; l'k') u_{\\beta}(l'k')\n$$\n其中 $\\Phi_{\\alpha\\beta}(lk; l'k')$ 是力常数矩阵，表示晶体势能对原子位移的二阶导数。下标 $\\alpha, \\beta$ 表示笛卡尔分量。\n\n假设一个形式为 $\\mathbf{u}(lk) = \\frac{1}{\\sqrt{M_k}} \\mathbf{e}_k(\\mathbf{q}) e^{i(\\mathbf{q} \\cdot \\mathbf{R}_l - \\omega t)}$ 的平面波解，其中 $\\mathbf{q}$ 是波矢，$\\omega$ 是角频率，$\\mathbf{e}_k(\\mathbf{q})$ 是原子 $k$ 的极化矢量，我们得到久期方程：\n$$\n\\sum_{k'\\beta} D_{\\alpha\\beta}(k,k';\\mathbf{q}) e_{\\beta}(k';\\mathbf{q}) = \\omega^2(\\mathbf{q}) e_{\\alpha}(k;\\mathbf{q})\n$$\n此处，$D_{\\alpha\\beta}(k,k';\\mathbf{q})$ 是动力学矩阵的矩阵元，该矩阵是力常数矩阵的质量加权傅里叶变换：\n$$\nD_{\\alpha\\beta}(k,k';\\mathbf{q}) = \\frac{1}{\\sqrt{M_k M_{k'}}} \\sum_{l'} \\Phi_{\\alpha\\beta}(0k; l'k') e^{i\\mathbf{q} \\cdot \\mathbf{R}_{l'}}\n$$\n对于给定的波矢 $\\mathbf{q}$，动力学矩阵的本征值即为声子频率的平方 $\\omega^2(\\mathbf{q})$。\n\n问题指定的是布里渊区中心的拉曼活性光学声子。布里渊区中心对应于 $\\mathbf{q}=\\mathbf{0}$。金刚石具有带双原子基元的面心立方晶格。为简单起见，我们将基元中的两个原子标记为 $k=1$ 和 $k=2$。问题指出，我们可以将它们建模为相同种类的原子，因此它们的质量相等，$M_1=M_2=M$。\n\n在布里渊区中心（$\\mathbf{q}=\\mathbf{0}$），对于光学模，两个子晶格彼此相对振动。这种运动可以等效地描述为：一个具有双原子系统折合质量 $\\mu$ 的单个粒子，在等效力常数 $k_{eff}$ 的作用下振动。折合质量由下式给出：\n$$\n\\mu = \\frac{M_1 M_2}{M_1 + M_2}\n$$\n由于 $M_1 = M_2 = M$，折合质量为 $\\mu = \\frac{M^2}{2M} = \\frac{M}{2}$。因此，布里渊区中心光学声子的角频率与原子质量 $M$ 的关系如下：\n$$\n\\omega_{opt}^2 = \\frac{k_{eff}}{\\mu} = \\frac{k_{eff}}{M/2} \\implies \\omega_{opt}^2 \\propto \\frac{1}{M}\n$$\n这意味着角频率本身与质量的定标关系为 $\\omega_{opt} \\propto \\frac{1}{\\sqrt{M}}$。\n\n该问题关注的是同位素取代。问题的核心在于，同位素取代改变了原子核质量 $M$，但不会改变电子结构。在 Born-Oppenheimer 近似下，原子间的作用力以及力常数矩阵 $\\Phi$（进而也包括等效力常数 $k_{eff}$）完全由基态电子分布决定。因此，$k_{eff}$ 在同位素取代下是不变的。\n\n这种不变性使我们能够建立一个直接的定标关系。设 $\\nu_{12}$ 为纯碳-12金刚石的声子频率（以波数 $\\mathrm{cm}^{-1}$ 为单位），其原子质量为 $M_{12}$。设 $\\nu_x$ 为含有比例为 $x$ 的碳-13同位素的金刚石晶体的频率。以波数为单位的频率 $\\nu$ 与角频率 $\\omega$ 成正比（$\\omega = 2\\pi c \\nu$，其中 $c$ 是光速）。因此，该定标关系也适用于 $\\nu$：\n$$\n\\nu \\propto \\omega \\propto \\frac{1}{\\sqrt{M}}\n$$\n我们可以写出频率的比率：\n$$\n\\frac{\\nu_x}{\\nu_{12}} = \\frac{1/\\sqrt{M_{eff}}}{1/\\sqrt{M_{12}}} = \\sqrt{\\frac{M_{12}}{M_{eff}}}\n$$\n其中，$M_{eff}$ 是同位素混合晶体的有效原子质量。\n\n为了对混合晶体建模，我们采用指定的虚拟晶体近似（VCA）。在 VCA 中，无序合金的性质通过一个虚拟的周期性晶体来近似，其中每个原子位置都被一个虚拟原子占据，该虚拟原子的性质是组分原子的按组分加权平均值。在本例中，每个位置上的质量被替换为平均同位素质量 $M_{\\mathrm{avg}}(x)$：\n$$\nM_{eff} = M_{\\mathrm{avg}}(x) = (1-x) M_{12} + x M_{13}\n$$\n其中 $x$ 是碳-13原子的比例。\n\n将此有效质量的表达式代入我们的定标关系，即可得到最终的计算公式：\n$$\n\\nu_x = \\nu_{12} \\sqrt{\\frac{M_{12}}{(1-x) M_{12} + x M_{13}}}\n$$\n我们已知的常数为：\n- 纯碳-12的基准频率：$\\nu_{12} = 1332.0 \\, \\mathrm{cm}^{-1}$\n- 碳-12的质量：$M_{12} = 12.000 \\, \\mathrm{u}$\n- 碳-13的质量：$M_{13} = 13.003355 \\, \\mathrm{u}$\n\n此公式将用于计算指定的一组碳-13比例 $x$ 的声子频率。对于 $x=0$ 的情况，该公式正确地恢复了 $\\nu_0 = \\nu_{12} \\sqrt{M_{12}/M_{12}} = \\nu_{12}$。对于 $x>0$ 的情况，平均质量增加，因此频率 $\\nu_x$ 将会降低。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Raman-active zone-center optical phonon frequency in diamond\n    under isotopic substitution using the Virtual Crystal Approximation.\n    \"\"\"\n    \n    # Define constants from the problem statement.\n    # Baseline Raman frequency for pure carbon-12 diamond in cm^-1.\n    nu_12 = 1332.0\n    # Isotopic mass of carbon-12 in atomic mass units (u).\n    M_12 = 12.000\n    # Isotopic mass of carbon-13 in atomic mass units (u).\n    M_13 = 13.003355\n\n    # Define the test cases for the fraction x of carbon-13.\n    test_cases = [\n        0.0,\n        0.0107,\n        0.5,\n        1.0,\n        1e-6\n    ]\n\n    results = []\n    # Iterate through each test case for the fraction x.\n    for x in test_cases:\n        # Calculate the average mass using the Virtual Crystal Approximation.\n        # M_avg = (1-x) * M_12 + x * M_13\n        m_avg = (1.0 - x) * M_12 + x * M_13\n        \n        # Calculate the frequency scaling factor from the mass ratio.\n        # The squared frequency is inversely proportional to the effective mass.\n        # nu_x / nu_12 = sqrt(M_12 / M_avg)\n        if m_avg > 0:\n            scaling_factor = np.sqrt(M_12 / m_avg)\n            # Calculate the new phonon frequency.\n            nu_x = nu_12 * scaling_factor\n        else:\n            # Handle the unlikely case of zero or negative average mass.\n            nu_x = 0.0\n\n        results.append(nu_x)\n\n    # Format the results as strings rounded to 6 decimal places in fixed-point format.\n    # Example: 1332.0 becomes \"1332.000000\".\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # Final print statement in the exact required format: [res1,res2,...]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2462547"}]}