{"hands_on_practices": [{"introduction": "在计算化学中，仅获得一个数字作为结果是远远不够的；评估该结果的可靠性至关重要。本练习将介绍一个关键的诊断工具——参考态权重 $c_0^2$。通过分析这个值，您可以判断微扰是否足够“小”以使理论有效，或者是否存在“闯入态”问题导致计算结果不可靠，这是批判性地评估多参考计算结果的关键第一步 [@problem_id:2459081]。", "problem": "在完整活性空间二阶微扰理论 (CASPT$2$) 中，零阶状态是完整活性空间自洽场 (CASSCF) 参考波函数，记为 $\\lvert \\Psi^{(0)} \\rangle$，而微扰修正将 $\\lvert \\Psi^{(0)} \\rangle$ 与外部组态混合，形成一个归一化的微扰态。许多 CASPT$2$ 的实现会报告参考权重 $c_0^2$，其定义为在归一化的、经微扰校正的波函数中 CASSCF 参考组分系数的平方。该诊断指标的取值范围在 $0$ 到 $1$ 之间。哪个选项最好地解释了为什么 $c_0^2$ 是一个用于评估零阶波函数质量的有用诊断指标？\n\nA. $c_0^2$ 直接衡量了归一化微扰态中零阶 CASSCF 组分的范数；一个小的 $c_0^2$ 值表示由于大的一阶振幅（通常源于小的能量分母或入侵态）导致了与外部组态的强烈混合，这表明零阶描述和/或活性空间可能不充分。\n\nB. $c_0^2$ 是尺寸广延的，并且等于在二阶捕获的总动态相关能的分数，因此它能定量地预测剩余能量误差。\n\nC. $c_0^2$ 等于活性空间内所有重要组态态函数系数的平方和，因此它独立于微扰报告活性空间的完备性。\n\nD. 在 CASPT$2$ 中，$c_0^2$ 由电离能-电子亲和能 (IPEA) 划分固定，并且总是约等于 $1$，因此任何偏离 $1$ 的情况都是由数值噪音而非物理原因造成的。", "solution": "该问题要求对参考权重 $c_0^2$ 在完整活性空间二阶微扰理论 (CASPT$2$) 中作为诊断指标的效用给出最佳解释。要回答这个问题，我们必须首先在微扰理论的框架内形式化 $c_0^2$ 的定义。\n\n在 CASPT$2$ 中，零阶状态是 CASSCF 波函数，我们记为 $\\lvert \\Psi_0^{(0)} \\rangle$。该状态被假定为归一化的，即 $\\langle \\Psi_0^{(0)} | \\Psi_0^{(0)} \\rangle = 1$。微扰理论的形式体系通过将此状态与外部空间的组态混合，引入了对该状态的修正。根据标准的 Rayleigh-Schrödinger 微扰理论，对波函数的一阶修正 $\\lvert \\Psi_0^{(1)} \\rangle$ 由下式给出：\n$$ \\lvert \\Psi_0^{(1)} \\rangle = \\sum_{k \\notin \\text{CAS}} \\frac{\\langle \\Psi_k^{(0)} | \\hat{V} | \\Psi_0^{(0)} \\rangle}{E_0^{(0)} - E_k^{(0)}} \\lvert \\Psi_k^{(0)} \\rangle $$\n其中 $\\lvert \\Psi_k^{(0)} \\rangle$ 是外部组态（零阶哈密顿算符 $\\hat{H}_0$ 的本征函数），$\\hat{V}$ 是微扰算符，$E_j^{(0)}$ 是零阶能量。未经归一化的一阶修正波函数是 $\\lvert \\Psi \\rangle = \\lvert \\Psi_0^{(0)} \\rangle + \\lvert \\Psi_0^{(1)} \\rangle$。\n\n问题指出 $c_0^2$ 是从*归一化*的微扰态 $\\lvert \\Psi_{\\text{norm}} \\rangle$ 推导出来的。我们通过条件 $\\langle N\\Psi | N\\Psi \\rangle = 1$ 来找到归一化常数 $N$。\n$$ N^{-2} = \\langle \\Psi_0^{(0)} + \\Psi_0^{(1)} | \\Psi_0^{(0)} + \\Psi_0^{(1)} \\rangle $$\n由于外部态 $\\lvert \\Psi_k^{(0)} \\rangle$ 与参考态 $\\lvert \\Psi_0^{(0)} \\rangle$ 正交，并且彼此也正交，上式可简化为：\n$$ N^{-2} = \\langle \\Psi_0^{(0)} | \\Psi_0^{(0)} \\rangle + \\langle \\Psi_0^{(1)} | \\Psi_0^{(1)} \\rangle = 1 + \\sum_{k \\notin \\text{CAS}} \\left| \\frac{\\langle \\Psi_k^{(0)} | \\hat{V} | \\Psi_0^{(0)} \\rangle}{E_0^{(0)} - E_k^{(0)}} \\right|^2 $$\n归一化波函数是 $\\lvert \\Psi_{\\text{norm}} \\rangle = N(\\lvert \\Psi_0^{(0)} \\rangle + \\lvert \\Psi_0^{(1)} \\rangle)$。在这个归一化状态中，参考组分 $\\lvert \\Psi_0^{(0)} \\rangle$ 的系数是 $c_0 = N$。因此，参考权重为：\n$$ c_0^2 = N^2 = \\frac{1}{1 + \\sum_{k \\notin \\text{CAS}} \\left| \\frac{\\langle \\Psi_k^{(0)} | \\hat{V} | \\Psi_0^{(0)} \\rangle}{E_0^{(0)} - E_k^{(0)}} \\right|^2} $$\n这个表达式是精确的，并构成了我们分析的基础。对于微扰理论而言，一个“好”的零阶波函数应该已经是真实波函数的主导组分，这意味着微扰修正是小的。如果修正很小，分母中的求和项就小（接近于 $0$），$c_0^2$ 就接近于 $1$。\n\n反之，如果 $c_0^2$ 显著小于 $1$，则分母中的求和项必定很大。这表明一个或多个一阶振幅 $\\frac{\\langle \\Psi_k^{(0)} | \\hat{V} | \\Psi_0^{(0)} \\rangle}{E_0^{(0)} - E_k^{(0)}}$ 很大。大的振幅可能源于强的耦合矩阵元 $\\langle \\Psi_k^{(0)} | \\hat{V} | \\Psi_0^{(0)} \\rangle$，或者更典型地是源于小的能量分母 $|E_0^{(0)} - E_k^{(0)}|$。后一种情况，即在零阶水平上某个外部态与参考态近简并，被称为“入侵态”问题。入侵态的存在表明 CASSCF 活性空间是有缺陷的，因为它忽略了与参考态有强相互作用的组态。这使得零阶描述不充分，微扰太大，以至于二阶处理不可靠。因此，一个小的 $c_0^2$ 值是对零阶 CASSCF 波函数质量和/或活性空间选择的一个关键警示。\n\n现在我们来评估给定的选项。\n\nA. $c_0^2$ 直接衡量了归一化微扰态中零阶 CASSCF 组分的范数；一个小的 $c_0^2$ 值表示由于大的一阶振幅（通常源于小的能量分母或入侵态）导致了与外部组态的强烈混合，这表明零阶描述和/或活性空间可能不充分。\n这个陈述与我们的推导完全一致。\n- $c_0^2$ 是参考态 $\\lvert \\Psi_0^{(0)} \\rangle$ 在归一化总状态中的系数平方（或权重），在口语中被正确地表述为“...组分的范数”。\n- 它正确地将小的 $c_0^2$ 与强混合（大的一阶波函数修正）联系起来。\n- 它正确地指出了这种强混合的原因：大的一阶振幅，这通常源于小的能量分母，是入侵态的标志。\n- 它得出了正确的结论：这种情况表明零阶 CASSCF 波函数是一个差的出发点，通常是因为活性空间选择不当。\n这个选项提供了完整而准确的解释。\n结论：**正确**。\n\nB. $c_0^2$ 是尺寸广延的，并且等于在二阶捕获的总动态相关能的分数，因此它能定量地预测剩余能量误差。\n- $c_0^2$ 不是尺寸广延的。随着体系尺寸的增加，外部组态的数量和波函数修正的幅度通常会增大，导致 $c_0^2$ 减小。它是一个类强度量，但不是严格的尺寸强度量。\n- $c_0^2$ 与一阶波函数修正的范数有关，而不是直接与二阶能量修正 $E_0^{(2)}$ 有关。$c_0^2$ 与相关能的分数之间没有简单的等价关系。\n- 因此，它是一个定性诊断指标，而不是一个定量预测器。一个小的 $c_0^2$ 值警告 CASPT$2$ 能量不可靠，但它并不能以 kJ/mol 为单位给出误差值。\n这个陈述在多个基本点上是错误的。\n结论：**不正确**。\n\nC. $c_0^2$ 等于活性空间内所有重要组态态函数系数的平方和，因此它独立于微扰报告活性空间的完备性。\n- CASSCF 波函数 $\\lvert \\Psi_0^{(0)} \\rangle$ *内部*所有组态系数的平方和根据定义恒为 $1$。$c_0^2$ 是整个 $\\lvert \\Psi_0^{(0)} \\rangle$ 在*微扰*态中的权重。该陈述将 CASSCF 波函数的内部结构与其在微扰理论中的作用相混淆。\n- $c_0^2$ 的值从根本上依赖于微扰，其公式中包含了微扰算符 $\\hat{V}$ 以及与*外部*态的矩阵元，这一点证明了它的依赖性。它不可能“独立于微扰”来报告活性空间。\n这个陈述错误地描述了 $c_0^2$ 的定义和性质。\n结论：**不正确**。\n\nD. 在 CASPT$2$ 中，$c_0^2$ 由电离能-电子亲和能 (IPEA) 划分固定，并且总是约等于 $1$，因此任何偏离 $1$ 的情况都是由数值噪音而非物理原因造成的。\n- IPEA 位移是一种用于修正零阶哈密顿算符 $\\hat{H}_0$ 的技术，这反过来会影响能量分母，从而影响 $c_0^2$ 的值。它的设计目的是缓解入侵态问题并将 $c_0^2$ 推向更接近 $1$ 的值，但它并不会将其固定为一个特定值。\n- 对于许多具有挑战性的体系，即使使用了 IPEA 位移，$c_0^2$ 也可能显著小于 $1$（例如，$0.8$ 或更低）。声称它“总是约等于 $1$”是错误的。\n- $c_0^2$ 显著偏离 $1$ 是深刻物理问题（例如超出活性空间范围的强多参考特征、入侵态）的标志，而不是数值噪音。它是 CASPT$2$ 计算中最重要的物理诊断指标之一。\n这个陈述完全错误地描述了 IPEA 位移和 $c_0^2$ 的诊断价值。\n结论：**不正确**。\n\n基于此分析，选项 A 是唯一正确和全面的解释。", "answer": "$$\\boxed{A}$$", "id": "2459081"}, {"introduction": "我们很容易认为，如果一个分子的电子结构由单一构型主导，那么多参考方法就显得多余了。本练习挑战了这一直觉，并阐明了静态相关和动态相关之间的根本区别。即使静态相关很弱 (即 CASSCF 波函数中有一个主导构型)，动态相关对总能量的贡献仍然不可或缺，而这正是 CASPT2 或 NEVPT2 等方法所要解决的 [@problem_id:2459116]。", "problem": "您对一个共轭多烯进行了完全活性空间自洽场 (CASSCF) 计算，活性空间为 $(8,8)$。CASSCF 基态波函数由一个单一组态主导，其振幅平方为 $c_0^2=0.95$。一位同事认为，由于 $c_0^2$ 很大，因此没有必要应用完全活性空间二阶微扰理论 (CASPT2) 或 $N$-电子价态二阶微扰理论 (NEVPT2) 来计算能量和性质。哪个(些)陈述提供了最合适的反驳论点？选择所有适用的选项。\n\nA. 即使 $c_0^2=0.95$，CASSCF 主要处理活性空间内的静态（近简并）相关，而忽略了来自活性空间外激发的大部分动态相关；需要像 CASPT2 或 NEVPT2 这样的二阶处理来恢复这部分缺失的相关，以提高能量和性质的定量准确性。\n\nB. 大的 $c_0^2$ 意味着动态相关可以忽略不计，因此应用 CASPT2 或 NEVPT2 会重复计算相关性，并通常会使结果恶化。\n\nC. CASPT2 仅在 $c_0^2<0.5$ 时有用；对于 $c_0^2\\ge 0.5$ 的情况，它通常由于入侵态而数值不稳定，因此应避免使用。\n\nD. 即使基态看起来像单组态，不同态（例如基态与激发态，或沿反应坐标的不同点）之间的微分动态相关也可能很大；加入 CASPT2 或 NEVPT2 可以减少相对能量（如激发能和能垒高度）的偏差。\n\nE. 使用足够大的单电子基组，CASSCF 可以同时包含静态和动态相关，因此无论 $c_0^2$ 大小，像 CASPT2 或 NEVPT2 这样的微扰修正是没有必要的。", "solution": "对问题陈述进行严格验证。\n\n**步骤 1：提取已知信息**\n- 方法：完全活性空间自洽场 (CASSCF)。\n- 体系：一个共轭多烯。\n- 活性空间：$(8,8)$，表示 8 个电子在 8 个活性轨道中。\n- 结果：CASSCF计算得到的基态波函数由单一组态主导。\n- 数据：主导组态的振幅平方为 $c_0^2 = 0.95$。\n- 待评估的前提：一位同事认为，由于 $c_0^2$ 很大，后续的完全活性空间二阶微扰理论 (CASPT2) 或 $N$-电子价态二阶微扰理论 (NEVPT2) 计算是不必要的。\n- 问题：找出反驳此说法的最合适的论点。\n\n**步骤 2：使用提取的已知信息进行验证**\n该问题具有科学依据。它呈现了多参考量子化学中的一个标准情景。CASSCF、CASPT2、NEVPT2、活性空间、静态和动态相关以及组态振幅等概念是该领域的基础。给定的值 $c_0^2=0.95$ 在物理上是合理的，表明波函数具有弱多参考特征。同事的论点代表了一种常见但错误的简化，使其成为一个有效的概念性问题前提。该问题提法明确，要求从选项列表中选择一个科学上正确的反驳。它是客观且自洽的。没有违反科学原理、逻辑不一致或含糊不清之处。\n\n**步骤 3：结论与行动**\n问题陈述有效。将制定完整的解决方案。\n\n问题的核心在于区分静态和动态电子相关。\nCASSCF 方法旨在通过处理由电子组态近简并引起的强电子相关效应，来提供一个定性正确的零阶波函数。这被称为**静态相关**。CASSCF 通过在一个称为活性空间的有限、化学相关的轨道集内执行完全组态相互作用 (FCI) 计算来实现这一点。在本例中，活性空间为 $(8,8)$。\n\n然而，根据其构造，CASSCF 方法几乎完全忽略了**动态相关**。动态相关源于电子试图彼此回避（“库仑洞”）时的短程相互作用。捕捉这种效应需要考虑大量从占据轨道（包括非活性和活性轨道）到未占据虚轨道的激发。这些激发位于 CASSCF 计算的 CI 空间之外。\n\n$c_0^2$ 值是 CASSCF 波函数中主导组态（通常是 Hartree-Fock 行列式）的系数平方。$c_0^2 = 0.95$ 的值表明波函数由单一电子组态主导。这意味着对于所讨论的态，静态相关效应很弱。同事的错误在于从小的静态相关部分推断出*所有*相关效应都很小。这在根本上是错误的。动态相关是一种独特的物理效应，其大小并不由 $c_0^2$ 的大小直接决定。对于几乎所有分子，动态相关对总能量都有重要贡献，并且对于获得能量和分子性质的定量准确性至关重要。\n\n像 CASPT2 和 NEVPT2 这样的方法是多参考微扰理论。它们被明确设计用于在 CASSCF 计算*之后*应用。它们使用 CASSCF 波函数作为零阶参考，并应用二阶微扰理论来计算来自活性空间外激发的能量贡献。这样做可以恢复缺失的动态相关。\n\n因此，同事关于 PT2 修正是没有必要的论点是无效的。即使静态相关很弱 ($c_0^2 \\approx 1$)，为了获得定量的结果也必须包括动态相关。现在，我们来评估每个选项。\n\n**A. 即使 $c_0^2=0.95$，CASSCF 主要处理活性空间内的静态（近简并）相关，而忽略了来自活性空间外激发的大部分动态相关；需要像 CASPT2 或 NEVPT2 这样的二阶处理来恢复这部分缺失的相关，以提高能量和性质的定量准确性。**\n这个陈述是对情况的精确和准确的描述。它正确地指出了 CASSCF 处理活性空间内的静态相关，其主要局限性是忽略了来自该空间之外的动态相关。它正确地阐述了 CASPT2/NEVPT2 的目的，即加入这部分缺失的动态相关以达到定量准确性。$c_0^2=0.95$ 这一事实并不能否定这一基本需求。\n**结论：正确。**\n\n**B. 大的 $c_0^2$ 意味着动态相关可以忽略不计，因此应用 CASPT2 或 NEVPT2 会重复计算相关性，并通常会使结果恶化。**\n这个陈述在多个方面都是不正确的。首先，大的 $c_0^2$ 表明*静态*相关较弱，而非*动态*相关可以忽略不计。动态相关几乎总是显著的。其次，CASPT2 和 NEVPT2 的构建是为了避免重复计算相关性。它们在与 CASSCF 参考空间正交的组态空间上进行操作，从而为 CASSCF 计算中未包含的相互作用添加修正。应用这些方法是改进而非恶化 CASSCF 结果的标准程序。\n**结论：错误。**\n\n**C. CASPT2 仅在 $c_0^2<0.5$ 时有用；对于 $c_0^2\\ge 0.5$ 的情况，它通常由于入侵态而数值不稳定，因此应避免使用。**\n这个陈述在事实上是不正确的。当参考态定义良好且不是病态的多组态时，即当 $c_0^2$ 很大时，CASPT2 的效果最好。$c_0^2=0.95$ 的值是 CASPT2 的理想情况。声称它仅对 $c_0^2 < 0.5$ 有用是错误的；如此低的值将表明极强的多参考特征，在这种情况下，为微扰理论选择单一参考态本身就变得有问题了。入侵态问题会导致微扰展开的发散，这是 CASPT2 中一个已知的问题，但它并不与高 $c_0^2$ 值系统性相关。它们是由零阶态能量与微扰求和中使用的激发组态能量之间的近简并引起的。现有多种技术可以减轻这些不稳定性。\n**结论：错误。**\n\n**D. 即使基态看起来像单组态，不同态（例如基态与激发态，或沿反应坐标的不同点）之间的微分动态相关也可能很大；加入 CASPT2 或 NEVPT2 可以减少相对能量（如激发能和能垒高度）的偏差。**\n这个陈述提出了一个使用后 CASSCF 方法的关键且复杂的理由。CASSCF 对一组态（例如基态和激发态）的静态相关进行均衡处理。然而，CASSCF 忽略的动态相关量在这些态之间可能有显著差异。例如，激发态通常比基态更弥散，电子上更“软”，因此具有更大的动态相关能。通过忽略这种微分效应，CASSCF 常常产生有偏差的相对能量，例如高估的激发能或反应能垒。CASPT2 和 NEVPT2 通过计算每个态的动态相关来纠正这一点，从而对能量差提供更均衡和定量准确的描述。这一点是对同事主张的有力反驳，因为它强调了即使在计算相对性质时，动态相关的重要性。\n**结论：正确。**\n\n**E. 使用足够大的单电子基组，CASSCF 可以同时包含静态和动态相关，因此无论 $c_0^2$ 大小，像 CASPT2 或 NEVPT2 这样的微扰修正是没有必要的。**\n这个陈述表明了对电子结构理论的基本误解。单电子基组的质量决定了分子轨道的表示优劣。一个大的基组对于准确描述任何电子态都是必要的。然而，它并不能改变方法本身提供的电子相关处理水平。根据定义，CASSCF 是在小活性空间内的 FCI。它不包括到虚轨道的激发，无论基组有多大。要包含所有动态相关，需要将活性空间扩展到包括所有轨道，这正是完全 CI 计算的定义——对于一个拥有8个电子且处于大基组中的体系来说，这是一项计算上难以完成的任务。因此，大的基组并不能消除对像 CASPT2 或 NEVPT2 这样的后 CASSCF 动态相关处理的需求。\n**结论：错误。**\n\n总之，陈述 A 和 D 针对同事的错误推理，提供了科学上正确且有力的反驳论点。", "answer": "$$\\boxed{AD}$$", "id": "2459116"}, {"introduction": "不同的多参考微扰理论方法，如 CASPT2 和 NEVPT2，在理论构造上存在微妙但重要的差异。本练习邀请您通过一个简化的计算模型，探讨大小一致性 (size-consistency) 这一基本理论性质。您将亲手验证 NEVPT2 的构造如何确保其严格满足大小一致性，而标准 CASPT2 的设计却可能违反这一重要原则 [@problem_id:2459090]。通过这个实践，您将对理论方法的内在属性及其对化学模拟准确性的影响有更深刻的理解。", "problem": "您将使用一个极简的、完全指定的玩具模型来分析大小一致性，该模型抽象了两种著名的多参考二阶微扰理论：带实数能级移动的完全活性空间二阶微扰理论 (CASPT2) 和 N电子价态微扰理论 (NEVPT2)。考虑两个无相互作用的片段，标记为 $A$ 和 $B$，其零阶模型态是其片段模型态的张量积。每个片段 $X \\in \\{A,B\\}$ 都有一个外部组态，其特征是相对于其片段模型态有一个能隙 $\\Delta_X > 0$ 以及模型组态与外部组态之间存在一个实数耦合振幅 $g_X$。假设总哈密顿量是严格可分的，因此没有片段间的耦合。令 $s \\ge 0$ 表示一个实数能级移动。\n\n对于 NEVPT2 的抽象（Epstein–Nesbet 可分构造），将片段的二阶能量校正定义为\n$$\nE^{(2)}_{\\mathrm{NEV}}(X) = -\\frac{g_X^2}{\\Delta_X},\n$$\n对于复合的无相互作用二聚体 $AB$，定义为\n$$\nE^{(2)}_{\\mathrm{NEV}}(AB) = -\\frac{g_A^2}{\\Delta_A} - \\frac{g_B^2}{\\Delta_B}.\n$$\n这种构造通过为仅A和仅B的激发分配不同的外部空间来强制实现强可分性。\n\n对于带能级移动的 CASPT2 的抽象（内收缩、能级移动的构造），将片段的二阶能量校正定义为\n$$\nE^{(2)}_{\\mathrm{CAS}}(X;s) = -\\frac{g_X^2}{\\Delta_X + s}.\n$$\n对于复合的无相互作用二聚体 $AB$，在单个外部类的层面上模拟内收缩，该外部类将仅A和仅B的外部组态合并为一个总耦合为 $g_A + g_B$ 并具有有效平均分母的收缩外部向量。定义\n$$\n\\overline{\\Delta}_{AB}(s) = \\frac{\\Delta_A + \\Delta_B}{2} + s,\n\\quad\nE^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(g_A + g_B)^2}{\\overline{\\Delta}_{AB}(s)}.\n$$\n这种构造模拟了内收缩的不可分效应，并结合了应用于合并激发类别的全局能级移动。\n\n将给定方法的大小一致性定义为表达式 $E^{(2)}(\\mathrm{AB}) = E^{(2)}(\\mathrm{A}) + E^{(2)}(\\mathrm{B})$ 成立。对于下面的每个参数集，在绝对容差 $\\tau = 1\\times 10^{-12}$ 内，评估 NEVPT2 和带能级移动的 CASPT2 在上述抽象中是否满足大小一致性。您的程序应为每个测试用例计算两个布尔值：\n- 第一个值表示 NEVPT2 是否具有大小一致性，\n- 第二个值表示带能级移动的 CASPT2 是否具有大小一致性。\n\n使用以下参数值测试套组 $(\\Delta_A, g_A, \\Delta_B, g_B, s)$:\n1. $(0.8, 0.25, 1.1, 0.18, 0.2)$\n2. $(0.5, 0.3, 1.5, 0.1, 0.05)$\n3. $(0.7, 0.2, 2.0, 0.0, 0.3)$\n4. $(0.5, 0.3, 0.5, 0.3, 1000.0)$\n\n所有量均为无量纲。角度不出现。不使用百分比。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列\n$[\\text{NEV-1}, \\text{CAS-1}, \\text{NEV-2}, \\text{CAS-2}, \\text{NEV-3}, \\text{CAS-3}, \\text{NEV-4}, \\text{CAS-4}]$，\n其中每一项都是使用绝对容差 $\\tau = 1\\times 10^{-12}$ 计算出的布尔值。", "solution": "问题陈述经过验证，被认为是具有科学依据、问题明确且客观的。它在计算化学领域提出了一个有效的理论练习，使用简化但合理的模型来研究多参考微扰理论中大小一致性的性质。该问题是自包含的，并为得出唯一解提供了所有必要的定义和数据。因此，我们可以进行严谨的分析。\n\n任务是评估两种抽象的二阶微扰理论 NEVPT2 和 CASPT2 对于一个由两个无相互作用片段 $A$ 和 $B$ 组成的系统的大小一致性。大小一致性要求复合系统（二聚体）的能量是单个片段能量之和，即 $E^{(2)}(AB) = E^{(2)}(A) + E^{(2)}(B)$。我们对每个模型评估此条件。数值相等的容差给定为 $\\tau = 1 \\times 10^{-12}$。\n\n首先，我们分析N电子价态微扰理论 (NEVPT2) 的抽象。\n单个片段 $X \\in \\{A, B\\}$ 的二阶能量校正由下式给出：\n$$\nE^{(2)}_{\\mathrm{NEV}}(X) = -\\frac{g_X^2}{\\Delta_X}\n$$\n因此，片段能量之和为：\n$$\nE^{(2)}_{\\mathrm{NEV}}(A) + E^{(2)}_{\\mathrm{NEV}}(B) = \\left(-\\frac{g_A^2}{\\Delta_A}\\right) + \\left(-\\frac{g_B^2}{\\Delta_B}\\right) = -\\frac{g_A^2}{\\Delta_A} - \\frac{g_B^2}{\\Delta_B}\n$$\n无相互作用二聚体 $AB$ 的能量定义为：\n$$\nE^{(2)}_{\\mathrm{NEV}}(AB) = -\\frac{g_A^2}{\\Delta_A} - \\frac{g_B^2}{\\Delta_B}\n$$\n通过直接比较，我们看到大小一致性条件\n$$\nE^{(2)}_{\\mathrm{NEV}}(AB) = E^{(2)}_{\\mathrm{NEV}}(A) + E^{(2)}_{\\mathrm{NEV}}(B)\n$$\n根据定义是精确满足的。该模型被构建为严格可分的，或“强大小一致性”的。大小一致性误差在解析上为零。因此，对于任何参数集 $(\\Delta_A, g_A, \\Delta_B, g_B, s)$，只要 $\\Delta_A, \\Delta_B > 0$，该模型都具有大小一致性。\n\n接下来，我们分析带实数能级移动的完全活性空间二阶微扰理论 (CASPT2) 的抽象。\n带有能级移动 $s \\ge 0$ 的单个片段 $X \\in \\{A, B\\}$ 的二阶能量校正为：\n$$\nE^{(2)}_{\\mathrm{CAS}}(X;s) = -\\frac{g_X^2}{\\Delta_X + s}\n$$\n片段能量之和为：\n$$\nE^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{g_A^2}{\\Delta_A + s} - \\frac{g_B^2}{\\Delta_B + s}\n$$\n二聚体 $AB$ 的能量是使用带有平均分母的内收缩模型定义的：\n$$\nE^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(g_A + g_B)^2}{\\overline{\\Delta}_{AB}(s)} = -\\frac{(g_A + g_B)^2}{\\frac{\\Delta_A + \\Delta_B}{2} + s}\n$$\n大小一致性误差 $\\delta E$ 是二聚体能量与片段能量之和的差值：\n$$\n\\delta E = E^{(2)}_{\\mathrm{CAS}}(AB;s) - \\left( E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) \\right)\n$$\n$$\n\\delta E = \\left( \\frac{g_A^2}{\\Delta_A + s} + \\frac{g_B^2}{\\Delta_B + s} \\right) - \\frac{(g_A + g_B)^2}{\\frac{\\Delta_A + \\Delta_B}{2} + s}\n$$\n此表达式通常不等于零。因此，该模型通常不具有大小一致性。大小一致性误差源于模仿真实 CASPT2 的两个模型特性：对合并的激发类别使用单一的平均分母，以及由于内收缩（此处模型化为 $(g_A + g_B)^2$）导致的分子项的不可分性。只有当 $|\\delta E| \\le \\tau$ 时，大小一致性才成立。我们必须对每个测试用例评估此条件。\n\n用例 1: $(\\Delta_A, g_A, \\Delta_B, g_B, s) = (0.8, 0.25, 1.1, 0.18, 0.2)$\n- NEVPT2: 根据定义具有大小一致性。结果：True。\n- CASPT2:\n  - $E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{0.25^2}{0.8+0.2} - \\frac{0.18^2}{1.1+0.2} = -0.0625 - \\frac{0.0324}{1.3} \\approx -0.0874230769$\n  - $E^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(0.25+0.18)^2}{\\frac{0.8+1.1}{2}+0.2} = -\\frac{0.43^2}{1.15} = -\\frac{0.1849}{1.15} \\approx -0.1607826087$\n  - $|\\delta E| \\approx |-0.1607826087 - (-0.0874230769)| \\approx 0.0733595318 \\gg \\tau$。不具有大小一致性。结果：False。\n\n用例 2: $(\\Delta_A, g_A, \\Delta_B, g_B, s) = (0.5, 0.3, 1.5, 0.1, 0.05)$\n- NEVPT2: 根据定义具有大小一致性。结果：True。\n- CASPT2:\n  - $E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{0.3^2}{0.5+0.05} - \\frac{0.1^2}{1.5+0.05} = -\\frac{0.09}{0.55} - \\frac{0.01}{1.55} \\approx -0.1700879765$\n  - $E^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(0.3+0.1)^2}{\\frac{0.5+1.5}{2}+0.05} = -\\frac{0.4^2}{1.05} = -\\frac{0.16}{1.05} \\approx -0.1523809524$\n  - $|\\delta E| \\approx |-0.1523809524 - (-0.1700879765)| \\approx 0.0177070241 \\gg \\tau$。不具有大小一致性。结果：False。\n\n用例 3: $(\\Delta_A, g_A, \\Delta_B, g_B, s) = (0.7, 0.2, 2.0, 0.0, 0.3)$\n- NEVPT2: 根据定义具有大小一致性。结果：True。\n- CASPT2: 此处 $g_B=0$。误差变为 $\\delta E = g_A^2 \\left( \\frac{1}{\\Delta_A+s} - \\frac{1}{\\frac{\\Delta_A+\\Delta_B}{2}+s} \\right)$。除非 $\\Delta_A = \\Delta_B$，否则此值非零。此处 $\\Delta_A \\neq \\Delta_B$。\n  - $E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{0.2^2}{0.7+0.3} - \\frac{0^2}{2.0+0.3} = -0.04$\n  - $E^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(0.2+0)^2}{\\frac{0.7+2.0}{2}+0.3} = -\\frac{0.04}{1.65} \\approx -0.0242424242$\n  - $|\\delta E| \\approx |-0.0242424242 - (-0.04)| \\approx 0.0157575758 \\gg \\tau$。不具有大小一致性。结果：False。\n\n用例 4: $(\\Delta_A, g_A, \\Delta_B, g_B, s) = (0.5, 0.3, 0.5, 0.3, 1000.0)$\n- NEVPT2: 根据定义具有大小一致性。结果：True。\n- CASPT2: 位移 $s$ 很大。在极限 $s \\to \\infty$ 下，误差趋近于零，为 $\\delta E \\approx -2g_A g_B / s$。对于有限但大的 $s$，误差很小但非零。\n  - $E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{0.3^2}{0.5+1000} - \\frac{0.3^2}{0.5+1000} = -2 \\frac{0.09}{1000.5} \\approx -0.0001799100$\n  - $E^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(0.3+0.3)^2}{\\frac{0.5+0.5}{2}+1000} = -\\frac{0.6^2}{1000.5} = -\\frac{0.36}{1000.5} \\approx -0.0003598201$\n  - $|\\delta E| \\approx |-0.0003598201 - (-0.0001799100)| \\approx 0.0001799101 \\gg \\tau$。不具有大小一致性。结果：False。\n\n总而言之，NEVPT2 抽象对所有测试用例都具有大小一致性，而 CASPT2 抽象对任何测试用例都不具有大小一致性，因为该模型固有地引入了在给定条件下不会消失的大小一致性误差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the size-consistency of two abstract multireference perturbation\n    theory models (NEVPT2 and CASPT2) for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (delta_A, g_A, delta_B, g_B, s)\n    test_cases = [\n        (0.8, 0.25, 1.1, 0.18, 0.2),\n        (0.5, 0.3, 1.5, 0.1, 0.05),\n        (0.7, 0.2, 2.0, 0.0, 0.3),\n        (0.5, 0.3, 0.5, 0.3, 1000.0),\n    ]\n\n    # Absolute tolerance for checking size-consistency\n    tau = 1.0e-12\n\n    results = []\n    for case in test_cases:\n        delta_A, g_A, delta_B, g_B, s = case\n\n        # --- NEVPT2 Validation ---\n        # The NEVPT2 abstraction defines the dimer energy as the exact sum of\n        # the fragment energies:\n        # E2_NEV(AB) = -g_A^2/delta_A - g_B^2/delta_B\n        # E2_NEV(A) + E2_NEV(B) = (-g_A^2/delta_A) + (-g_B^2/delta_B)\n        # These are analytically identical. The size-consistency error is zero.\n        # Therefore, the result for NEVPT2 is always True.\n        results.append(True)\n\n        # --- CASPT2-with-level-shift Validation ---\n        # Sum of fragment energies\n        E2_CAS_A = -g_A**2 / (delta_A + s)\n        if delta_B > 0: # Avoid division by zero if delta_B was 0, though problem states > 0\n            E2_CAS_B = -g_B**2 / (delta_B + s)\n        else:\n            E2_CAS_B = 0.0\n        \n        sum_E2_CAS = E2_CAS_A + E2_CAS_B\n\n        # Dimer energy\n        delta_AB_bar = (delta_A + delta_B) / 2.0 + s\n        E2_CAS_AB = -(g_A + g_B)**2 / delta_AB_bar\n\n        # Check for size-consistency\n        error_cas = abs(E2_CAS_AB - sum_E2_CAS)\n        is_cas_consistent = error_cas = tau\n        results.append(is_cas_consistent)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts Python booleans (True, False) to strings.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2459090"}]}