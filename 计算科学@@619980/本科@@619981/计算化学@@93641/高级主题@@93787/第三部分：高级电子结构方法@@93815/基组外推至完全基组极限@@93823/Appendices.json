{"hands_on_practices": [{"introduction": "理论是重要的，但真正的理解来自于实践。让我们从一个基础但非常普遍的双点外推问题开始。这个练习将指导你使用两个基组的计算结果，通过求解一个线性方程组来估算相关能的完全基组极限值 [@problem_id:2450736]。掌握这种方法是进行高精度量子化学计算的基本功。", "problem": "一个用于相关能收敛到完备基组 (CBS) 极限的常用两点模型假设，使用基数 $L$ 的相关一致基组计算得到的相关能遵循以下公式\n$$\nE_{\\text{corr}}(L) \\;=\\; E_{\\text{CBS}} \\;+\\; A\\,(L+\\tfrac{1}{2})^{-3},\n$$\n其中 $E_{\\text{CBS}}$ 是 CBS 极限下的相关能，$A$ 是一个依赖于体系的常数，而 $(L+\\tfrac{1}{2})^{-3}$ 则描述了渐近收敛行为。\n\n对于一个给定的分子，使用两种不同基数的高水平计算得到以下相关能（单位为哈特里）：\n$$\nE_{\\text{corr}}(3) \\;=\\; -0.200000, \\qquad E_{\\text{corr}}(4) \\;=\\; -0.220000.\n$$\n\n1. 将这两个方程表示为线性代数形式 $M \\cdot v = E$，其中 $v = \\begin{pmatrix} E_{\\text{CBS}} \\\\ A \\end{pmatrix}$，并明确写出矩阵 $M$ 和向量 $E$。\n2. 求解向量 $v$，并报告 $E_{\\text{CBS}}$ 和 $A$ 的数值。\n\n将您的最终数值结果四舍五入至六位有效数字。能量以哈特里为单位。以向量 $v$ 的形式给出您的最终答案。", "solution": "该问题已经过验证，被确定为计算化学领域中的一个适定问题。它具有科学依据、内容独立且客观。我们可以开始求解。\n\n该问题要求我们根据使用基数为 $L=3$ 和 $L=4$ 的相关一致基组进行的两次数值计算，来确定相关能的完备基组 (CBS) 极限 $E_{\\text{CBS}}$ 和一个拟合常数 $A$。该收敛过程由以下方程建模：\n$$\nE_{\\text{corr}}(L) = E_{\\text{CBS}} + A(L+\\tfrac{1}{2})^{-3}\n$$\n所提供的数据点为 $E_{\\text{corr}}(3) = -0.200000$ 哈特里和 $E_{\\text{corr}}(4) = -0.220000$ 哈特里。\n\n首先，我们将问题表示为矩阵形式 $M \\cdot v = E$。给定模型是关于未知数 $E_{\\text{CBS}}$ 和 $A$ 的线性方程。我们可以为每个数据点写出一个方程。\n\n对于 $L=3$：\n$$\nE_{\\text{corr}}(3) = 1 \\cdot E_{\\text{CBS}} + (3+\\tfrac{1}{2})^{-3} \\cdot A\n$$\n$$\n-0.200000 = E_{\\text{CBS}} + (3.5)^{-3} \\cdot A\n$$\n\n对于 $L=4$：\n$$\nE_{\\text{corr}}(4) = 1 \\cdot E_{\\text{CBS}} + (4+\\tfrac{1}{2})^{-3} \\cdot A\n$$\n$$\n-0.220000 = E_{\\text{CBS}} + (4.5)^{-3} \\cdot A\n$$\n\n这个二元线性方程组可以用矩阵形式写成如下：\n$$\n\\begin{pmatrix} 1 & (3.5)^{-3} \\\\ 1 & (4.5)^{-3} \\end{pmatrix} \\begin{pmatrix} E_{\\text{CBS}} \\\\ A \\end{pmatrix} = \\begin{pmatrix} -0.200000 \\\\ -0.220000 \\end{pmatrix}\n$$\n这对应于所要求的 $M \\cdot v = E$ 形式，其中未知数向量是 $v = \\begin{pmatrix} E_{\\text{CBS}} \\\\ A \\end{pmatrix}$，常数向量是 $E = \\begin{pmatrix} E_{\\text{corr}}(3) \\\\ E_{\\text{corr}}(4) \\end{pmatrix} = \\begin{pmatrix} -0.200000 \\\\ -0.220000 \\end{pmatrix}$，系数矩阵 $M$ 是：\n$$\nM = \\begin{pmatrix} 1 & (3.5)^{-3} \\\\ 1 & (4.5)^{-3} \\end{pmatrix} = \\begin{pmatrix} 1 & (\\frac{7}{2})^{-3} \\\\ 1 & (\\frac{9}{2})^{-3} \\end{pmatrix} = \\begin{pmatrix} 1 & \\frac{8}{343} \\\\ 1 & \\frac{8}{729} \\end{pmatrix}\n$$\n\n接下来，我们求解这个方程组以得到向量 $v$，它包含了 $E_{\\text{CBS}}$ 和 $A$ 的值。设这两个方程为：\n1. $E_{\\text{CBS}} + A\\frac{8}{343} = -0.200000$\n2. $E_{\\text{CBS}} + A\\frac{8}{729} = -0.220000$\n\n为了求 $A$，我们将第二个方程从第一个方程中减去：\n$$\n\\left( E_{\\text{CBS}} + A\\frac{8}{343} \\right) - \\left( E_{\\text{CBS}} + A\\frac{8}{729} \\right) = -0.200000 - (-0.220000)\n$$\n$$\nA \\left( \\frac{8}{343} - \\frac{8}{729} \\right) = 0.020000\n$$\n我们通过先化简括号中的项来求解 $A$：\n$$\n\\frac{8}{343} - \\frac{8}{729} = 8 \\left( \\frac{1}{343} - \\frac{1}{729} \\right) = 8 \\left( \\frac{729 - 343}{343 \\times 729} \\right) = 8 \\left( \\frac{386}{250047} \\right) = \\frac{3088}{250047}\n$$\n现在，我们可以计算 $A$：\n$$\nA \\cdot \\frac{3088}{250047} = 0.020000 \\implies A = \\frac{0.020000 \\times 250047}{3088} = \\frac{5000.94}{3088} \\approx 1.61947539507...\n$$\n\n为了求 $E_{\\text{CBS}}$，我们可以重排第二个方程并代入 $A$ 的值：\n$$\nE_{\\text{CBS}} = -0.220000 - A \\frac{8}{729}\n$$\n$$\nE_{\\text{CBS}} = -0.220000 - \\left( \\frac{5000.94}{3088} \\right) \\frac{8}{729} = -0.220000 - \\frac{40007.52}{2251152} \\approx -0.220000 - 0.017772020725...\n$$\n$$\nE_{\\text{CBS}} \\approx -0.237772020725...\n$$\n另外，也可以推导出一个更直接的 $E_{\\text{CBS}}$ 计算公式，这种方法不易受舍入误差传播的影响：\n$$\nE_{\\text{CBS}} = \\frac{E_{\\text{corr}}(4) (3.5)^{-3} - E_{\\text{corr}}(3) (4.5)^{-3}}{(3.5)^{-3} - (4.5)^{-3}} = \\frac{(-0.220000) \\frac{8}{343} - (-0.200000) \\frac{8}{729}}{\\frac{8}{343} - \\frac{8}{729}}\n$$\n$$\nE_{\\text{CBS}} = \\frac{\\frac{-0.220000}{343} + \\frac{0.200000}{729}}{\\frac{1}{343} - \\frac{1}{729}} = \\frac{\\frac{-0.220000 \\times 729 + 0.200000 \\times 343}{343 \\times 729}}{\\frac{729 - 343}{343 \\times 729}} = \\frac{-160.38 + 68.6}{386} = \\frac{-91.78}{386}\n$$\n$$\nE_{\\text{CBS}} = -0.237772020725...\n$$\n两种方法的结果是一致的。现在，我们根据题目要求，将 $E_{\\text{CBS}}$ 和 $A$ 的数值四舍五入到六位有效数字。\n$E_{\\text{CBS}} \\approx -0.237772$\n$A \\approx 1.61948$\n\n最终答案是包含已计算数值的向量 $v = \\begin{pmatrix} E_{\\text{CBS}} \\\\ A \\end{pmatrix}$。\n$$\nv = \\begin{pmatrix} -0.237772 \\\\ 1.61948 \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.237772 \\\\\n1.61948\n\\end{pmatrix}\n}\n$$", "id": "2450736"}, {"introduction": "虽然两点外推很有用，但为了获得更高的精度，我们常常使用包含更多数据点的模型。在此练习中，你将使用三个不同基组的计算数据，拟合一个更复杂的渐近公式，即 $E_{\\mathrm{corr}}(X) = E_{\\mathrm{corr}}(\\infty) + aX^{-3} + bX^{-5}$ [@problem_id:2450745]。这个过程模拟了研究级计算中追求高精度结果的常用策略，并能增强你处理更复杂代数系统的能力。", "problem": "在基组收敛的背景下，相关能的完备基组 (CBS) 极限是指当基组主数 $X$ 趋于 $+\\infty$ 时获得的值。对于应用于闭壳层原子的相关一致极化价 $X$-zeta (cc-pVXZ) 基组，假设当 $X$ 足够大时，相关能 $E_{\\mathrm{corr}}(X)$ 的渐近行为为\n$$\nE_{\\mathrm{corr}}(X) \\;=\\; E_{\\mathrm{corr}}(\\infty) \\;+\\; a\\,X^{-3} \\;+\\; b\\,X^{-5},\n$$\n其中 $E_{\\mathrm{corr}}(\\infty)$、$a$ 和 $b$ 是与 $X$ 无关的常数。一组使用 cc-pVXZ 基组在主数 $X = 2, 3, 4$ 时计算得到的氦原子的高水平耦合簇 (CCSD(T)) 相关能为：\n$$\nE_{\\mathrm{corr}}(2) = -0.039000 \\quad \\text{Hartree,}\n$$\n$$\nE_{\\mathrm{corr}}(3) = -0.041000 \\quad \\text{Hartree,}\n$$\n$$\nE_{\\mathrm{corr}}(4) = -0.041700 \\quad \\text{Hartree.}\n$$\n仅利用上述假设和这三个数据点，确定 CBS 极限相关能 $E_{\\mathrm{corr}}(\\infty)$。以 Hartree 为单位表示最终能量，并将您的答案四舍五入到六位有效数字。", "solution": "问题陈述已经过验证，被认定为具有科学依据、提法恰当且客观。它提出了一个计算量子化学中涉及基组外推的标准问题。未发现任何瑕疵。解答如下。\n\n所给出的相关能 $E_{\\mathrm{corr}}(X)$ 作为基组主数 $X$ 的函数的渐近关系为\n$$E_{\\mathrm{corr}}(X) = E_{\\mathrm{corr}}(\\infty) + a\\,X^{-3} + b\\,X^{-5}$$\n其中 $E_{\\mathrm{corr}}(\\infty)$、$a$ 和 $b$ 是常数。我们得到了氦原子相关能的三个数据点：\n$E_{\\mathrm{corr}}(2) = -0.039000$ Hartree，对于 $X=2$。\n$E_{\\mathrm{corr}}(3) = -0.041000$ Hartree，对于 $X=3$。\n$E_{\\mathrm{corr}}(4) = -0.041700$ Hartree，对于 $X=4$。\n\n让我们定义与完备基组 (CBS) 极限的能量差为 $\\Delta E(X) = E_{\\mathrm{corr}}(X) - E_{\\mathrm{corr}}(\\infty)$。该方程变为\n$$\\Delta E(X) = a\\,X^{-3} + b\\,X^{-5}$$\n我们可以通过将此方程两边乘以 $X^5$ 来重新整理：\n$$\\Delta E(X) X^5 = a\\,X^2 + b$$\n让我们定义一个新变量 $Z = X^2$ 和一个新函数 $g(Z) = \\Delta E(X) X^5$。代入这些定义可得\n$$g(Z) = a\\,Z + b$$\n此方程表明 $g(Z)$ 是 $Z$ 的一个线性函数。\n\n我们有三对点 $(X_i, E_{\\mathrm{corr}}(X_i))$（其中 $i \\in \\{1, 2, 3\\}$），分别对应于主数 $X=2$、$X=3$ 和 $X=4$。这些点映射到 $(Z, g(Z))$ 坐标系中的三个点：\n对于 $X_1=2$，我们有 $Z_1 = 2^2 = 4$。函数值为 $g(Z_1) = (E_{\\mathrm{corr}}(2) - E_{\\mathrm{corr}}(\\infty)) \\cdot 2^5 = 32(E_{\\mathrm{corr}}(2) - E_{\\mathrm{corr}}(\\infty))$。\n对于 $X_2=3$，我们有 $Z_2 = 3^2 = 9$。函数值为 $g(Z_2) = (E_{\\mathrm{corr}}(3) - E_{\\mathrm{corr}}(\\infty)) \\cdot 3^5 = 243(E_{\\mathrm{corr}}(3) - E_{\\mathrm{corr}}(\\infty))$。\n对于 $X_3=4$，我们有 $Z_3 = 4^2 = 16$。函数值为 $g(Z_3) = (E_{\\mathrm{corr}}(4) - E_{\\mathrm{corr}}(\\infty)) \\cdot 4^5 = 1024(E_{\\mathrm{corr}}(4) - E_{\\mathrm{corr}}(\\infty))$。\n\n由于这三个点 $(Z_1, g(Z_1))$、$(Z_2, g(Z_2))$ 和 $(Z_3, g(Z_3))$ 位于一条直线上，任意两对点之间的斜率必须相同。\n$$\\frac{g(Z_2) - g(Z_1)}{Z_2 - Z_1} = \\frac{g(Z_3) - g(Z_2)}{Z_3 - Z_2}$$\n代入 $Z_i$ 和 $g(Z_i)$ 的表达式：\n$$\\frac{243(E_{\\mathrm{corr}}(3) - E_{\\mathrm{corr}}(\\infty)) - 32(E_{\\mathrm{corr}}(2) - E_{\\mathrm{corr}}(\\infty))}{9 - 4} = \\frac{1024(E_{\\mathrm{corr}}(4) - E_{\\mathrm{corr}}(\\infty)) - 243(E_{\\mathrm{corr}}(3) - E_{\\mathrm{corr}}(\\infty))}{16 - 9}$$\n为简化表示法，令 $E_\\infty = E_{\\mathrm{corr}}(\\infty)$、$E_2=E_{\\mathrm{corr}}(2)$、$E_3=E_{\\mathrm{corr}}(3)$ 和 $E_4=E_{\\mathrm{corr}}(4)$。\n$$\\frac{243(E_3 - E_\\infty) - 32(E_2 - E_\\infty)}{5} = \\frac{1024(E_4 - E_\\infty) - 243(E_3 - E_\\infty)}{7}$$\n现在我们可以解这个关于单个未知数 $E_\\infty$ 的线性方程。\n$$7 [243E_3 - 243E_\\infty - 32E_2 + 32E_\\infty] = 5 [1024E_4 - 1024E_\\infty - 243E_3 + 243E_\\infty]$$\n$$7 [243E_3 - 32E_2 - 211E_\\infty] = 5 [1024E_4 - 243E_3 - 781E_\\infty]$$\n$$1701E_3 - 224E_2 - 1477E_\\infty = 5120E_4 - 1215E_3 - 3905E_\\infty$$\n合并含有 $E_\\infty$ 的项：\n$$E_\\infty (3905 - 1477) = 5120E_4 - 1215E_3 - 1701E_3 + 224E_2$$\n$$2428 E_\\infty = 5120E_4 - 2916E_3 + 224E_2$$\n$$E_\\infty = \\frac{5120E_4 - 2916E_3 + 224E_2}{2428}$$\n现在，我们代入给定的数值：$E_2 = -0.039000$，$E_3 = -0.041000$，$E_4 = -0.041700$。\n$$E_\\infty = \\frac{5120(-0.041700) - 2916(-0.041000) + 224(-0.039000)}{2428}$$\n$$E_\\infty = \\frac{-213.504 + 119.556 - 8.736}{2428}$$\n$$E_\\infty = \\frac{-102.684}{2428}$$\n$$E_\\infty \\approx -0.04229160049423...$$\n题目要求答案四舍五入到六位有效数字。前六位有效数字是 $4, 2, 2, 9, 1, 6$。其后的数字是 $0$，因此我们直接舍去（即不改变最后一位数字）。\n$$E_{\\mathrm{corr}}(\\infty) \\approx -0.0422916$$\n单位是 Hartree，如题目陈述中所指定。", "answer": "$$\n\\boxed{-0.0422916}\n$$", "id": "2450745"}, {"introduction": "计算出的数值如果没有不确定性的评估，其科学价值是有限的。这个实践将引导你思考一个至关重要的问题：我们计算中固有的数值误差（例如自洽场收敛阈值 $\\tau$）如何影响我们最终外推结果的可靠性？通过应用不确定性传播的原理，你将量化地评估完全基组极限能量的标准不确定度 [@problem_id:2450780]，这是成为一名严谨的计算科学家所必需的技能。", "problem": "一个闭壳层分子在哈特里-福克 (Hartree-Fock) 水平上，使用相关一致极化价层基组 (correlation-consistent polarized valence basis sets, cc-pVXZ) 进行处理，基数 (cardinal numbers) 分别为 $L=4$ (四重-$\\zeta$) 和 $L=5$ (五重-$\\zeta$)。当连续迭代之间的总能量变化满足 $|\\Delta E| < \\tau$ 时，自洽场 (SCF, Self-Consistent Field) 迭代终止，其中 $\\tau = 1.0 \\times 10^{-8}$ 哈特里 (Hartree)。假设此终止准则意味着，对于每个报告的总能量 $E(L)$，其与该 $L$ 下的精确 SCF 解之间存在一个附加误差，该误差在 $L=4$ 和 $L=5$ 之间是独立的，并且对称分布在区间 $[-\\tau, +\\tau]$ 上。\n\n计算得到的两个总能量为：\n- $E(4) = -76.02751386$ Hartree,\n- $E(5) = -76.02765321$ Hartree.\n\n假设哈特里-福克能量的渐近基组收敛性由下式描述\n$$\nE(L) \\;=\\; E_{\\infty} \\;+\\; \\frac{A}{L^{\\alpha}},\n$$\n其中指数 $\\alpha = 5$ 已知，常数 $A$ 未知，$E_{\\infty}$ 是完全基组 (CBS, Complete Basis Set) 极限能量。\n\n在上述假设下，确定仅由 SCF 终止阈值 $\\tau$ 引起的外推 CBS 极限能量 $E_{\\infty}$ 的标准不确定度（单位为 Hartree）。将最终数值结果四舍五入至三位有效数字。答案以 Hartree 为单位表示。", "solution": "任务是量化当使用模型\n$$\nE(L) \\;=\\; E_{\\infty} \\;+\\; \\frac{A}{L^{\\alpha}}\n$$\n（其中 $\\alpha = 5$）时，输入能量 $E(4)$ 和 $E(5)$ 的不确定度如何传播到外推的完全基组极限 $E_{\\infty}$。\n\n首先，使用 $L_{1}=4$ 和 $L_{2}=5$ 这两个值求解 $E_{\\infty}$。从\n$$\nE(4) \\;=\\; E_{\\infty} \\;+\\; \\frac{A}{4^{\\alpha}}, \\quad\nE(5) \\;=\\; E_{\\infty} \\;+\\; \\frac{A}{5^{\\alpha}},\n$$\n消去 $A$ 得到\n$$\nE_{\\infty} \\;=\\; \\frac{E(5)\\,5^{\\alpha} \\;-\\; E(4)\\,4^{\\alpha}}{5^{\\alpha} \\;-\\; 4^{\\alpha}}.\n$$\n定义 $L_{1}=4$, $L_{2}=5$ 以及 $D = L_{2}^{\\alpha} - L_{1}^{\\alpha}$。则\n$$\nE_{\\infty} \\;=\\; c_{1}\\,E(4) \\;+\\; c_{2}\\,E(5),\n$$\n其中\n$$\nc_{1} \\;=\\; -\\,\\frac{L_{1}^{\\alpha}}{D}, \\qquad c_{2} \\;=\\; \\frac{L_{2}^{\\alpha}}{D}.\n$$\n\nSCF 终止规则意味着每个报告的能量 $E(L)$ 都带有一个在 $[-\\tau, +\\tau]$ 上均匀分布的附加误差。对于 $[-\\tau, +\\tau]$ 上的连续均匀分布，其方差为 $\\tau^{2}/3$，因此每个输入的标准不确定度为\n$$\nu\\!\\left(E(4)\\right) \\;=\\; u\\!\\left(E(5)\\right) \\;=\\; \\frac{\\tau}{\\sqrt{3}}.\n$$\n假设两个输入误差相互独立，根据线性函数的不确定度传播定律，可得\n$$\nu\\!\\left(E_{\\infty}\\right) \\;=\\; \\sqrt{\\left(\\frac{\\partial E_{\\infty}}{\\partial E(4)}\\right)^{2} u\\!\\left(E(4)\\right)^{2} \\;+\\; \\left(\\frac{\\partial E_{\\infty}}{\\partial E(5)}\\right)^{2} u\\!\\left(E(5)\\right)^{2}} \\;=\\; \\sqrt{c_{1}^{2} + c_{2}^{2}}\\;\\frac{\\tau}{\\sqrt{3}}.\n$$\n\n代入 $\\alpha=5$, $L_{1}=4$, $L_{2}=5$。计算\n$$\nL_{1}^{\\alpha} \\;=\\; 4^{5} \\;=\\; 1024, \\qquad L_{2}^{\\alpha} \\;=\\; 5^{5} \\;=\\; 3125, \\qquad D \\;=\\; 3125 - 1024 \\;=\\; 2101.\n$$\n因此，\n$$\nc_{1} \\;=\\; -\\frac{1024}{2101} \\;\\approx\\; -0.487387, \\qquad\nc_{2} \\;=\\; \\frac{3125}{2101} \\;\\approx\\; 1.487387.\n$$\n那么\n$$\nc_{1}^{2} \\;\\approx\\; 0.237544, \\qquad c_{2}^{2} \\;\\approx\\; 2.212324, \\qquad\nc_{1}^{2} + c_{2}^{2} \\;\\approx\\; 2.449868,\n$$\n和\n$$\n\\sqrt{c_{1}^{2} + c_{2}^{2}} \\;\\approx\\; 1.565198.\n$$\n当 $\\tau = 1.0 \\times 10^{-8}$ Hartree 时，\n$$\nu\\!\\left(E_{\\infty}\\right) \\;=\\; 1.565198 \\times \\frac{1.0 \\times 10^{-8}}{\\sqrt{3}}\n\\;\\approx\\; 1.565198 \\times 5.7735027 \\times 10^{-9}\n\\;\\approx\\; 9.033 \\times 10^{-9}.\n$$\n\n四舍五入到三位有效数字并以 Hartree 表示，外推完全基组极限能量的标准不确定度为 $9.03 \\times 10^{-9}$ Hartree。", "answer": "$$\\boxed{9.03 \\times 10^{-9}}$$", "id": "2450780"}]}