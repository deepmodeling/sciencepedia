{"hands_on_practices": [{"introduction": "掌握狄拉克方程的第一步是求解最简单的情形：一个静止的自由粒子。这个基础练习将引导你直接从方程中推导出其最深刻的两个预测——自旋和反物质的存在。通过求解，你将亲手构建描述电子及其反粒子（正电子）在静止状态下的四种基本解。[@problem_id:2095231]", "problem": "一个质量为 $m$ 的自旋1/2粒子由动量空间中的不含时狄拉克方程描述，该方程可写为 $(\\gamma^\\mu p_\\mu - mc)\\psi(p) = 0$。此处，$p_\\mu$ 是四维动量，$m$ 是粒子的静止质量，$c$ 是光速，而 $\\psi(p)$ 是一个四分量旋量。在标准的狄拉克-泡利表示中，伽马矩阵 $\\gamma^\\mu$ 由下式给出：\n$$ \\gamma^0 = \\begin{pmatrix} I & 0 \\\\ 0 & -I \\end{pmatrix}, \\quad \\gamma^k = \\begin{pmatrix} 0 & \\sigma_k \\\\ -\\sigma_k & 0 \\end{pmatrix} $$\n其中 $k=1, 2, 3$，$I$ 是 $2 \\times 2$ 单位矩阵，$\\sigma_k$ 是泡利矩阵：\n$$ \\sigma_1 = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}, \\quad \\sigma_2 = \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix}, \\quad \\sigma_3 = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} $$\n使用自然单位制，使得约化普朗克常数 $\\hbar = 1$。\n\n考虑一个静止的粒子，其三维动量的空间分量为零，即 $\\vec{p} = (p_1, p_2, p_3) = (0,0,0)$。对于一个有质量的粒子，其四维动量为 $p_\\mu = (E/c, \\vec{p}) = (E/c, 0, 0, 0)$，其中 $E$ 是该粒子的能量。\n\n下列哪个选项正确表示了该静止粒子的四个线性无关、归一化的旋量解 $\\psi^{(s)}$ 及其对应能量 $E^{(s)}$ 的一个完整集合？\n\n设 $\\chi_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $\\chi_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，并令四分量旋量中的 `0` 表示零二分量向量 $\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\nA.\n$E^{(1)} = E^{(2)} = mc^2$:\n$\\psi^{(1)} = \\begin{pmatrix} \\chi_1 \\\\ 0 \\end{pmatrix}$,\n$\\psi^{(2)} = \\begin{pmatrix} \\chi_2 \\\\ 0 \\end{pmatrix}$\n$E^{(3)} = E^{(4)} = -mc^2$:\n$\\psi^{(3)} = \\begin{pmatrix} 0 \\\\ \\chi_1 \\end{pmatrix}$,\n$\\psi^{(4)} = \\begin{pmatrix} 0 \\\\ \\chi_2 \\end{pmatrix}$\n\nB.\n$E^{(1)} = E^{(2)} = mc^2$:\n$\\psi^{(1)} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\chi_1 \\\\ \\chi_1 \\end{pmatrix}$,\n$\\psi^{(2)} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\chi_2 \\\\ \\chi_2 \\end{pmatrix}$\n$E^{(3)} = E^{(4)} = -mc^2$:\n$\\psi^{(3)} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\chi_1 \\\\ -\\chi_1 \\end{pmatrix}$,\n$\\psi^{(4)} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\chi_2 \\\\ -\\chi_2 \\end{pmatrix}$\n\nC.\n$E^{(1)} = E^{(2)} = mc^2$:\n$\\psi^{(1)} = \\begin{pmatrix} 0 \\\\ \\chi_1 \\end{pmatrix}$,\n$\\psi^{(2)} = \\begin{pmatrix} 0 \\\\ \\chi_2 \\end{pmatrix}$\n$E^{(3)} = E^{(4)} = -mc^2$:\n$\\psi^{(3)} = \\begin{pmatrix} \\chi_1 \\\\ 0 \\end{pmatrix}$,\n$\\psi^{(4)} = \\begin{pmatrix} \\chi_2 \\\\ 0 \\end{pmatrix}$\n\nD.\n$E^{(1)} = E^{(3)} = mc^2$:\n$\\psi^{(1)} = \\begin{pmatrix} \\chi_1 \\\\ 0 \\end{pmatrix}$,\n$\\psi^{(3)} = \\begin{pmatrix} 0 \\\\ \\chi_1 \\end{pmatrix}$\n$E^{(2)} = E^{(4)} = -mc^2$:\n$\\psi^{(2)} = \\begin{pmatrix} \\chi_2 \\\\ 0 \\end{pmatrix}$,\n$\\psi^{(4)} = \\begin{pmatrix} 0 \\\\ \\chi_2 \\end{pmatrix}$\n\nE.\n$E^{(1)} = E^{(2)} = 0$:\n$\\psi^{(1)} = \\begin{pmatrix} \\chi_1 \\\\ 0 \\end{pmatrix}$,\n$\\psi^{(2)} = \\begin{pmatrix} \\chi_2 \\\\ 0 \\end{pmatrix}$\n$E^{(3)} = E^{(4)} = 0$:\n$\\psi^{(3)} = \\begin{pmatrix} 0 \\\\ \\chi_1 \\end{pmatrix}$,\n$\\psi^{(4)} = \\begin{pmatrix} 0 \\\\ \\chi_2 \\end{pmatrix}$", "solution": "从动量空间中的不含时狄拉克方程开始，\n$$\n(\\gamma^{\\mu} p_{\\mu} - m c)\\,\\psi(p)=0.\n$$\n对于静止粒子，$\\vec{p}=0$ 且 $p_{\\mu}=(E/c,0,0,0)$，于是方程简化为\n$$\n\\left(\\gamma^{0}\\frac{E}{c} - m c\\, I_{4}\\right)\\psi=0.\n$$\n在狄拉克-泡利表示中，$\\gamma^{0}=\\begin{pmatrix} I & 0 \\\\ 0 & -I \\end{pmatrix}$，所以\n$$\n\\gamma^{0}\\frac{E}{c} - m c\\, I_{4}\n=\n\\begin{pmatrix}\n\\frac{E}{c} I - m c\\, I & 0 \\\\\n0 & -\\frac{E}{c} I - m c\\, I\n\\end{pmatrix}.\n$$\n将四分量旋量写成一对二分量旋量，\n$$\n\\psi=\\begin{pmatrix}\\phi \\\\ \\eta\\end{pmatrix}.\n$$\n狄拉克方程便得出两个解耦的条件\n$$\n\\left(\\frac{E}{c} - m c\\right)\\phi=0, \n\\qquad\n\\left(-\\frac{E}{c} - m c\\right)\\eta=0.\n$$\n对于非平凡的 $\\phi$，必须有 $\\frac{E}{c}-m c=0$，即\n$$\nE= m c^{2},\n$$\n此时必然有 $\\eta=0$。对于非平凡的 $\\eta$，必须有 $-\\frac{E}{c}-m c=0$，即\n$$\nE= - m c^{2},\n$$\n此时必然有 $\\phi=0$。\n\n设 $\\chi_{1}=\\begin{pmatrix}1\\\\0\\end{pmatrix}$ 和 $\\chi_{2}=\\begin{pmatrix}0\\\\1\\end{pmatrix}$。它们构成了二分量旋量的一个标准正交基，所以对应的四个旋量\n$$\n\\psi^{(1)}=\\begin{pmatrix}\\chi_{1}\\\\0\\end{pmatrix},\\quad\n\\psi^{(2)}=\\begin{pmatrix}\\chi_{2}\\\\0\\end{pmatrix}\n\\quad\\text{其中}\\quad E^{(1)}=E^{(2)}= m c^{2},\n$$\n和\n$$\n\\psi^{(3)}=\\begin{pmatrix}0\\\\\\chi_{1}\\end{pmatrix},\\quad\n\\psi^{(4)}=\\begin{pmatrix}0\\\\\\chi_{2}\\end{pmatrix}\n\\quad\\text{其中}\\quad E^{(3)}=E^{(4)}= - m c^{2},\n$$\n是该方程的解，并在标准意义 $\\psi^{(s)\\dagger}\\psi^{(s)}=1$ 下是归一化的。这与选项 A 相符；选项 B、C、D 和 E 要么不满足静止系中的狄拉克方程，要么给出了错误的能量。", "answer": "$$\\boxed{A}$$", "id": "2095231"}, {"introduction": "在理解了狄拉克方程的静态解之后，我们进一步探讨其动态描述。波函数不仅是抽象的数学工具，它们还包含了关于粒子运动的物理信息。这个练习旨在通过计算守恒的概率流四维矢量，将旋量波函数的抽象分量与粒子的可观测速度联系起来，从而加深对狄拉克理论物理内涵的理解。[@problem_id:2095190]", "problem": "一个质量为 $m$ 的自由相对论性自旋1/2粒子由一个四分量旋量场 $\\psi(x)$ 描述，该场满足狄拉克方程 $(i\\gamma^\\mu\\partial_\\mu - m)\\psi(x) = 0$。在本问题中，我们将使用自然单位制，其中约化普朗克常数 $\\hbar=1$ 且光速 $c=1$。概率四维流定义为 $j^\\mu = (\\rho, \\vec{j}) = \\bar{\\psi}\\gamma^\\mu\\psi$，其中 $\\bar{\\psi} = \\psi^\\dagger \\gamma^0$。\n\n我们使用 $\\gamma$ 矩阵的 Dirac-Pauli 表示：\n$$ \\gamma^0 = \\begin{pmatrix} I & 0 \\\\ 0 & -I \\end{pmatrix}, \\quad \\gamma^k = \\begin{pmatrix} 0 & \\sigma^k \\\\ -\\sigma^k & 0 \\end{pmatrix} $$\n其中 $I$ 是 $2 \\times 2$ 单位矩阵，$\\sigma^k$ 是泡利矩阵：\n$$ \\sigma^1 = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}, \\quad \\sigma^2 = \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix}, \\quad \\sigma^3 = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} $$\n\n考虑一个形式为 $\\psi(x) = u(p) e^{-ip \\cdot x}$ 的正能平面波解，其中 $p^\\mu = (E, \\vec{p})$ 是粒子的四维动量，且 $E = \\sqrt{|\\vec{p}|^2 + m^2}$。对于一般动量 $\\vec{p}$，旋量 $u(p)$ 由下式给出：\n$$ u(p) = \\sqrt{E+m} \\begin{pmatrix} \\chi \\\\ \\frac{\\vec{\\sigma}\\cdot\\vec{p}}{E+m} \\chi \\end{pmatrix} $$\n其中 $\\vec{\\sigma} = (\\sigma^1, \\sigma^2, \\sigma^3)$，$\\chi$ 是一个表示自旋态的二分量旋量。\n\n设粒子动量 $\\vec{p} = (0, 0, p)$ 沿 z 轴正方向，且处于自旋向上态，意味着其自旋也与 z 轴对齐。对于此状态，二分量旋量为 $\\chi = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n你的任务是计算概率流空间部分的模 $|\\vec{j}|$ 与概率流的时间分量 $j^0$ 的比值。请将最终答案表示为用粒子能量 $E$ 和其动量大小 $p$ 表示的解析表达式。", "solution": "我们从平面波解 $\\psi(x) = u(p)\\exp(-i p\\cdot x)$ 开始，其中 $p^{\\mu} = (E,\\vec{p})$ 且 $E = \\sqrt{|\\vec{p}|^{2} + m^{2}}$。对于平面波，概率流为 $j^{\\mu} = \\bar{\\psi}\\gamma^{\\mu}\\psi = \\bar{u}(p)\\gamma^{\\mu}u(p)$，因为 $\\psi$ 和 $\\bar{\\psi}$ 之间的时空依赖性相互抵消了。\n\n对于沿 z 轴正方向的动量 $\\vec{p} = (0,0,p)$（其中 $p \\ge 0$）和沿 z 轴的自旋向上，我们取 $\\chi = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。正能旋量为\n$$\nu(p) = \\sqrt{E+m}\\begin{pmatrix} \\chi \\\\ \\dfrac{\\vec{\\sigma}\\cdot\\vec{p}}{E+m}\\chi \\end{pmatrix}\n= \\sqrt{E+m}\\begin{pmatrix} \\chi \\\\ \\dfrac{p\\,\\sigma^{3}}{E+m}\\chi \\end{pmatrix}.\n$$\n由于 $\\sigma^{3}\\chi = \\chi$，上式变为\n$$\nu(p) = \\sqrt{E+m}\\begin{pmatrix} \\chi \\\\ \\dfrac{p}{E+m}\\chi \\end{pmatrix}\n= \\sqrt{E+m}\\begin{pmatrix} 1 \\\\ 0 \\\\ \\dfrac{p}{E+m} \\\\ 0 \\end{pmatrix}.\n$$\n伴随旋量为 $\\bar{u}(p) = u^{\\dagger}(p)\\gamma^{0}$。在 Dirac-Pauli 表示下，使用 $\\gamma^{0} = \\mathrm{diag}(I,-I)$，\n$$\nu^{\\dagger}(p) = \\sqrt{E+m}\\begin{pmatrix} 1 & 0 & \\dfrac{p}{E+m} & 0 \\end{pmatrix}, \\quad\n\\Rightarrow\\quad\n\\bar{u}(p) = \\sqrt{E+m}\\begin{pmatrix} 1 & 0 & -\\dfrac{p}{E+m} & 0 \\end{pmatrix}.\n$$\n\n时间分量 $j^{0}$：\n使用 $j^{0} = \\bar{u}\\gamma^{0}u = u^{\\dagger}u$，\n$$\nj^{0} = u^{\\dagger}u\n= (E+m)\\left( \\chi^{\\dagger}\\chi + \\dfrac{p^{2}}{(E+m)^{2}}\\chi^{\\dagger}\\chi \\right)\n= (E+m) + \\dfrac{p^{2}}{E+m}.\n$$\n通分并使用色散关系 $E^{2} = p^{2} + m^{2}$：\n$$\nj^{0} = \\dfrac{(E+m)^{2} + p^{2}}{E+m}\n= \\dfrac{E^{2} + 2Em + m^{2} + p^{2}}{E+m}\n= \\dfrac{2E(E+m)}{E+m}\n= 2E.\n$$\n\n空间分量 $j^{k}$：\n使用 $\\gamma^{0}\\gamma^{k} = \\begin{pmatrix} 0 & \\sigma^{k} \\\\ \\sigma^{k} & 0 \\end{pmatrix}$，将 $u$ 分成上下两个二分量部分 $u = \\begin{pmatrix} \\phi \\\\ \\xi \\end{pmatrix}$，其中 $\\phi = \\sqrt{E+m}\\,\\chi$ 且 $\\xi = \\sqrt{E+m}\\,\\dfrac{p}{E+m}\\chi = \\dfrac{p}{\\sqrt{E+m}}\\chi$。那么\n$$\nj^{k} = \\bar{u}\\gamma^{k}u = u^{\\dagger}\\gamma^{0}\\gamma^{k}u = \\phi^{\\dagger}\\sigma^{k}\\xi + \\xi^{\\dagger}\\sigma^{k}\\phi = 2\\,\\mathrm{Re}\\left(\\phi^{\\dagger}\\sigma^{k}\\xi\\right).\n$$\n对于我们的实旋量，这简化为\n$$\nj^{k} = 2\\,\\phi^{\\dagger}\\sigma^{k}\\xi\n= 2\\,\\sqrt{E+m}\\,\\dfrac{p}{\\sqrt{E+m}}\\,\\chi^{\\dagger}\\sigma^{k}\\chi\n= 2p\\,\\chi^{\\dagger}\\sigma^{k}\\chi.\n$$\n对于 $\\chi = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$，我们有 $\\chi^{\\dagger}\\sigma^{1}\\chi = 0$，$\\chi^{\\dagger}\\sigma^{2}\\chi = 0$，以及 $\\chi^{\\dagger}\\sigma^{3}\\chi = 1$。因此，\n$$\nj^{1} = 0, \\quad j^{2} = 0, \\quad j^{3} = 2p,\n$$\n空间流的模为\n$$\n|\\vec{j}| = \\sqrt{(j^{1})^{2} + (j^{2})^{2} + (j^{3})^{2}} = 2p.\n$$\n\n最后，所求的比值为\n$$\n\\frac{|\\vec{j}|}{j^{0}} = \\frac{2p}{2E} = \\frac{p}{E}.\n$$\n该结果与 $u(p)$ 标准归一化下的普遍恒等式 $\\bar{u}(p)\\gamma^{\\mu}u(p) = 2p^{\\mu}$ 一致，该恒等式得出 $|\\vec{j}|/j^{0} = |\\vec{p}|/E$；此处根据构造有 $|\\vec{p}| = p$。", "answer": "$$\\boxed{\\frac{p}{E}}$$", "id": "2095190"}, {"introduction": "理论推导为我们揭示了狄拉克方程的谱结构，但没有什么比亲眼看到结果更具说服力了。这个计算实践将引导你编写一个简单的程序，在有限基组中求解一维自由粒子的狄拉克方程。通过数值对角化，你将能够直观地观察到正负能量连续谱的浮现，将抽象的理论概念转化为具体的计算结果。[@problem_id:2464130]", "problem": "实现一个完整、可运行的程序，对周期性盒子中的自由自旋-$\\tfrac{1}{2}$粒子的一维(1D)狄拉克方程进行有限基组展开，并通过计算出的能谱数值地展示正能和负能连续谱的出现。在一个长度为 $L$ 的周期性盒子中，使用自由粒子的狄拉克哈密顿量\n$$\n\\hat{H} \\;=\\; c\\,\\alpha\\,\\hat{p} \\;+\\; \\beta\\,m\\,c^2,\n$$\n其中 $m$ 是粒子质量，$c$ 是光速，$\\hat{p}$ 是动量算符，一维狄拉克矩阵选择为\n$$\n\\alpha \\;=\\; \\sigma_x \\;=\\; \\begin{pmatrix} 0 & 1 \\\\[4pt] 1 & 0 \\end{pmatrix}, \\qquad\n\\beta \\;=\\; \\sigma_z \\;=\\; \\begin{pmatrix} 1 & 0 \\\\[4pt] 0 & -1 \\end{pmatrix}.\n$$\n在长度为 $L$ 的区间上，使用满足周期性边界条件的平面波基函数。在此基组中，动量本征值为\n$$\np_n \\;=\\; \\frac{2\\pi n\\,\\hbar}{L}, \\quad \\text{for} \\quad n \\in \\mathbb{Z},\n$$\n并通过包含所有满足 $\\lvert n\\rvert \\leq N$ 的整数 $n$ 来获得一个截断基组。在这个截断的平面波基组中，哈密顿量作用于每个 $n$ 对应的双分量旋量，产生一个大小为 $2\\,(2N+1)\\times 2\\,(2N+1)$ 的有限维矩阵。数值对角化该矩阵并计算全部本征值。\n\n所有能量必须以电子伏特（表示为 $\\mathrm{eV}$）为单位报告。在您的计算中使用以下物理常数：\n- 约化普朗克常数: $\\hbar = 1.054\\,571\\,817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$。\n- 光速: $c = 2.997\\,924\\,58\\times 10^{8}\\ \\mathrm{m/s}$。\n- 用于单位转换的基本电荷: $e = 1.602\\,176\\,634\\times 10^{-19}\\ \\mathrm{C}$, 因此 $1\\ \\mathrm{eV} = e\\ \\mathrm{J}$。\n\n定义一个数值分类容差 $\\varepsilon = 10^{-9}\\ \\mathrm{eV}$。从计算出的能谱中，提取以下三个量：\n- $E_{\\min}^{(+)}$：严格大于 $\\varepsilon$ 的最小本征值。如果不存在满足此条件的本征值，则设 $E_{\\min}^{(+)} := 0$。\n- $E_{\\max}^{(-)}$：严格小于 $-\\varepsilon$ 的最大本征值。如果不存在满足此条件的本征值，则设 $E_{\\max}^{(-)} := 0$。\n- $E_{\\mathrm{gap}} := E_{\\min}^{(+)} - E_{\\max}^{(-)}$。\n\n对每个测试用例，用 $\\mathrm{eV}$ 单位表示这三个量。\n\n测试套件。您的程序必须为以下每组参数 $(m, L, N)$ 计算三元组 $\\bigl[E_{\\min}^{(+)},\\,E_{\\max}^{(-)},\\,E_{\\mathrm{gap}}\\bigr]$：\n- 情况1（一般情况）：$m = m_e$，其中 $m_e = 9.109\\,383\\,7015\\times 10^{-31}\\ \\mathrm{kg}$，$L = 1.0\\times 10^{-10}\\ \\mathrm{m}$，$N = 3$。\n- 情况2（边界尺寸）：$m = m_e$，$L = 1.0\\times 10^{-9}\\ \\mathrm{m}$，$N = 0$。\n- 情况3（无质量边缘情况）：$m = 0$，$L = 1.0\\times 10^{-9}\\ \\mathrm{m}$，$N = 4$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表，每个测试用例的元素本身也是一个按 $\\bigl[E_{\\min}^{(+)},\\,E_{\\max}^{(-)},\\,E_{\\mathrm{gap}}\\bigr]$ 顺序排列的列表。例如，输出格式必须是\n$$\n\\bigl[\\,[x_1,y_1,z_1],\\,[x_2,y_2,z_2],\\,[x_3,y_3,z_3]\\,\\bigr]\n$$\n用以 $\\mathrm{eV}$ 为单位的数值替换符号。", "solution": "该问题要求对一维狄拉克哈密顿量进行数值对角化，以处理周期性盒子中的自由粒子。这是相对论量子力学中的一个基础问题，用于说明狄拉克谱的特征，即由能隙隔开的正能和负能连续谱。所陈述的问题在科学上是合理的、适定的，并包含唯一解所需的所有必要信息。我们将着手进行其形式化求解。\n\n质量为 $m$ 的自由相对论粒子的哈密顿量由下式给出\n$$\n\\hat{H} \\;=\\; c\\,\\alpha\\,\\hat{p} \\;+\\; \\beta\\,m\\,c^2\n$$\n其中 $\\hat{p}$ 是动量算符，$c$ 是光速，$\\alpha$ 和 $\\beta$ 是狄拉克矩阵。在一维空间中，这些可以用 $2 \\times 2$ 矩阵表示。问题指定了选择\n$$\n\\alpha \\;=\\; \\sigma_x \\;=\\; \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}, \\qquad\n\\beta \\;=\\; \\sigma_z \\;=\\; \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}\n$$\n即标准的泡利矩阵。粒子的状态由一个双分量旋量波函数 $\\Psi(x) = \\begin{pmatrix} \\psi_1(x) \\\\ \\psi_2(x) \\end{pmatrix}$ 描述。\n\n我们的任务是在有限基组展开的框架内求解不含时狄拉克方程 $\\hat{H}\\Psi = E\\Psi$。系统被限制在长度为 $L$ 的盒子内，并满足周期性边界条件。波函数空间部分的自然基组是平面波集合，它们是动量算符 $\\hat{p}$ 的本征函数：\n$$\n\\phi_n(x) = \\frac{1}{\\sqrt{L}}e^{i k_n x}, \\quad \\text{其中} \\quad k_n = \\frac{2\\pi n}{L}.\n$$\n在此基组中，动量算符是对角的，其本征值为 $p_n = \\hbar k_n = \\frac{2\\pi n\\hbar}{L}$，其中整数 $n \\in \\mathbb{Z}$。\n\n旋量波函数的完整基组是空间平面波基组和二维旋量基组的张量积。一个基矢可以表示为 $|n, s\\rangle$，其中 $n$ 是动量量子数，$s \\in \\{1, 2\\}$ 是旋量分量指数。问题指定了一个截断基组，其中动量指数 $n$ 被限制在 $|n| \\leq N$ 的范围内。这导致了一个维度为 $2 \\times (2N+1)$ 的有限基组。\n\n为了构建哈密顿矩阵，我们需要其矩阵元 $H_{n's', ns} = \\langle n', s' | \\hat{H} | n, s \\rangle$。动量算符 $\\hat{p}$ 在 $\\{|n\\rangle\\}$ 基中是对角的：$\\langle n' | \\hat{p} | n \\rangle = p_n \\delta_{n'n}$。狄拉克矩阵 $\\alpha$ 和 $\\beta$ 只作用于希尔伯特空间的旋量部分。因此，哈密顿量不会耦合具有不同动量量子数 $n$ 的态。这将完整的哈密顿矩阵简化为块对角形式：\n$$\nH = \\bigoplus_{n=-N}^{N} H_n\n$$\n其中每个 $H_n$ 是一个 $2 \\times 2$ 矩阵，作用于固定动量 $p_n$ 的双分量旋量。$H_n$ 的矩阵元在标准旋量基 $\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\right\\}$ 中计算：\n$$\nH_n = c\\, p_n\\, \\alpha + m\\,c^2\\, \\beta = c\\, p_n \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix} + m\\,c^2 \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} = \\begin{pmatrix} m c^2 & c p_n \\\\ c p_n & -m c^2 \\end{pmatrix}.\n$$\n完整的哈密顿矩阵 $H$ 是一个大小为 $2(2N+1) \\times 2(2N+1)$ 的大型稀疏矩阵，其对角线上是这些 $2 \\times 2$ 的块。这个大矩阵的本征值就是每个独立 $H_n$ 块的所有本征值的集合。\n\n块 $H_n$ 的本征值可以通过求解特征方程 $\\det(H_n - E_n I) = 0$ 找到：\n$$\n(m c^2 - E_n)(-m c^2 - E_n) - (c p_n)^2 = 0 \\implies E_n^2 - (m c^2)^2 - (c p_n)^2 = 0.\n$$\n这给出了相对论的能量-动量关系，$E_n^2 = (m c^2)^2 + (c p_n)^2$，其解为：\n$$\nE_{n, \\pm} = \\pm \\sqrt{(m c^2)^2 + (c p_n)^2}.\n$$\n对于从 $-N$ 到 $N$ 的每个动量指数 $n$，我们获得两个能量本征值，一个正，一个负。计算出的能谱（对于有限的 $N$ 和 $L$，它是一个离散的点集）展示了正能连续谱和负能连续谱的出现。随着 $N$ 和 $L$ 的增加，这些本征值的密度增加，趋近于连续的能带。\n\n数值算法如下：\n1. 对于给定的测试用例 $(m, L, N)$，为每个 $n \\in \\{-N, -N+1, \\dots, N\\}$ 计算块 $H_n$，从而构建 $2(2N+1) \\times 2(2N+1)$ 的块对角哈密顿矩阵 $H$。在此步骤中，所有物理量必须使用国际单位制（SI）。\n2. 得到的矩阵 $H$ 是实对称的，因此是厄米矩阵。使用标准算法（例如 `numpy.linalg.eigh`）数值对角化 $H$，得到以焦耳为单位的全套本征值 $\\{E_i\\}$。\n3. 通过除以基本电荷 $e$ 将所有本征值转换为电子伏特（$\\mathrm{eV}$）。\n4. 使用容差 $\\varepsilon = 10^{-9}\\ \\mathrm{eV}$，将本征值筛选为一个正值集 $\\{ E_i > \\varepsilon \\}$ 和一个负值集 $\\{ E_i < -\\varepsilon \\}$。\n5. 将 $E_{\\min}^{(+)}$ 确定为正值集的最小值，如果该集合为空则设为 $0$。\n6. 将 $E_{\\max}^{(-)}$ 确定为负值集的最大值，如果该集合为空则设为 $0$。\n7. 计算能隙 $E_{\\mathrm{gap}} = E_{\\min}^{(+)} - E_{\\max}^{(-)}$。\n8. 对所有测试用例重复此过程，并按规定格式化结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a finite basis set expansion of the 1D Dirac equation for a free particle\n    in a periodic box, numerically computes the spectrum, and extracts key features.\n    \"\"\"\n    # Physical constants in SI units\n    hbar = 1.054571817e-34      # Reduced Planck constant (J.s)\n    c = 2.99792458e8           # Speed of light (m/s)\n    e_charge = 1.602176634e-19 # Elementary charge (C)\n    m_e = 9.1093837015e-31     # Electron mass (kg)\n\n    # Numerical classification tolerance in eV\n    epsilon = 1.0e-9\n\n    # Test suite with parameters (m, L, N)\n    test_cases = [\n        {'m': m_e, 'L': 1.0e-10, 'N': 3},  # Case 1\n        {'m': m_e, 'L': 1.0e-9,  'N': 0},  # Case 2\n        {'m': 0.0, 'L': 1.0e-9,  'N': 4}   # Case 3\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        m, L, N = params['m'], params['L'], params['N']\n\n        # The basis includes momentum states for n from -N to N.\n        num_momentum_states = 2 * N + 1\n        matrix_dim = 2 * num_momentum_states\n        \n        # Initialize the Hamiltonian matrix\n        H_matrix = np.zeros((matrix_dim, matrix_dim), dtype=np.float64)\n\n        momentum_indices = range(-N, N + 1)\n        \n        # Build the block-diagonal Hamiltonian matrix.\n        # Each block corresponds to a momentum quantum number n.\n        for i, n in enumerate(momentum_indices):\n            # Calculate momentum eigenvalue in SI units\n            p_n = (2.0 * np.pi * n * hbar) / L\n\n            # Elements of the 2x2 block H_n in Joules\n            E_rest = m * c**2\n            E_momentum = c * p_n\n\n            # The 2x2 Hamiltonian block for momentum p_n\n            block_H_n = np.array([\n                [E_rest,     E_momentum],\n                [E_momentum, -E_rest]\n            ])\n            \n            # Place the block into the full Hamiltonian matrix\n            row_col_start_index = 2 * i\n            H_matrix[row_col_start_index : row_col_start_index + 2, \n                     row_col_start_index : row_col_start_index + 2] = block_H_n\n\n        # The Hamiltonian is real and symmetric, so numpy.linalg.eigh is efficient.\n        # It returns eigenvalues in ascending order.\n        eigenvalues_J = np.linalg.eigh(H_matrix)[0]\n\n        # Convert eigenvalues from Joules to electronvolts (eV)\n        eigenvalues_eV = eigenvalues_J / e_charge\n\n        # Filter eigenvalues based on the tolerance epsilon\n        pos_eigs = [eig for eig in eigenvalues_eV if eig > epsilon]\n        neg_eigs = [eig for eig in eigenvalues_eV if eig < -epsilon]\n\n        # Determine E_min(+), E_max(-), and the gap\n        E_min_pos = min(pos_eigs) if pos_eigs else 0.0\n        E_max_neg = max(neg_eigs) if neg_eigs else 0.0\n        E_gap = E_min_pos - E_max_neg\n\n        all_results.append([E_min_pos, E_max_neg, E_gap])\n\n    # Format the final output string exactly as required: [[x1,y1,z1],[x2,y2,z2],...]\n    # The str() function for a list adds spaces, which must be removed.\n    final_output_str = str(all_results).replace(\" \", \"\")\n    print(final_output_str)\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2464130"}]}