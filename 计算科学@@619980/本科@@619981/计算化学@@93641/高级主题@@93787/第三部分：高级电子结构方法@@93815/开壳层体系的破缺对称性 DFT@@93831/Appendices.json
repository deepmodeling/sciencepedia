{"hands_on_practices": [{"introduction": "在密度泛函理论计算中，总自旋平方算符的期望值 $\\langle\\hat{S}^2\\rangle$ 是一个至关重要的诊断工具。这个练习将指导你如何解读一个非整的 $\\langle\\hat{S}^2\\rangle$ 值，通过一个简单的混合态模型，你可以将这个计算结果转化为对纯自旋态（如单重态和三重态）组成的直观物理图像。掌握这种解读方式是理解和分析所有开壳层体系计算结果的基础。[@problem_id:2451205]", "problem": "一次针对旨在表示单重态的开壳层体系的破缺对称性密度泛函理论 (BS-DFT) 计算，得出的总自旋平方算符的期望值为 $\\langle \\hat{S}^2 \\rangle \\approx 1.0$。假设该破缺对称性态可以解释为仅由两种纯自旋态（一个总自旋 $S=0$ 的单重态和一个总自旋 $S=1$ 的三重态）归一化混合而成。设这些组分的非负权重分别为 $w_{\\text{S}}$ 和 $w_{\\text{T}}$，且满足 $w_{\\text{S}}+w_{\\text{T}}=1$。对于一个总自旋量子数为 $S$ 的纯态，$\\hat{S}^{2}$ 的本征值为 $S(S+1)$。\n\n确定数组对 $(w_{\\text{S}}, w_{\\text{T}})$。将您的答案表示为行矩阵 $\\begin{pmatrix} w_{\\text{S}} & w_{\\text{T}} \\end{pmatrix}$。请提供精确值，无需四舍五入。", "solution": "首先验证问题。\n\n**步骤 1：提取已知条件**\n- 计算类型：破缺对称性密度泛函理论 (BS-DFT)。\n- 体系：一个开壳层体系。\n- 目标态：一个单重态。\n- 总自旋平方算符的期望值：$\\langle \\hat{S}^2 \\rangle \\approx 1.0$。\n- 态的模型：仅由两种纯自旋态构成的归一化混合。\n- 组分态：一个总自旋 $S=0$ 的单重态和一个总自旋 $S=1$ 的三重态。\n- 组分的权重：$w_{\\text{S}}$ 和 $w_{\\text{T}}$，非负。\n- 权重的归一化：$w_{\\text{S}}+w_{\\text{T}}=1$。\n- $\\hat{S}^{2}$ 的本征值：对于一个总自旋量子数为 $S$ 的纯态，其本征值为 $S(S+1)$。\n- 任务：确定数组对 $(w_{\\text{S}}, w_{\\text{T}})$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学基础**：该问题在科学上是合理的。它描述了 BS-DFT 中的自旋污染，这是计算量子化学中的一个标准概念。$\\hat{S}^2$ 本征值的公式 $S(S+1)$ 是量子力学的一个基本结果。两态混合模型是解释此类结果的一种常用且有效的近似方法。\n- **适定性**：该问题是适定的。它提供了足够的信息来确定权重 $(w_{\\text{S}}, w_{\\text{T}})$ 的唯一解。在此背景下，使用“$\\approx 1.0$”是标准的，对于理想化模型，它被解释为精确值 $1.0$。\n- **客观性**：该问题以客观、精确的语言陈述。\n\n**步骤 3：结论与操作**\n问题有效。将提供解答。\n\n对于一个态的统计混合，算符的期望值是混合中每个纯态期望值的加权平均。在本例中，破缺对称性态被描述为纯单重态 $|\\Psi_{\\text{S}}\\rangle$ 和纯三重态 $|\\Psi_{\\text{T}}\\rangle$ 的混合，其权重分别为 $w_{\\text{S}}$ 和 $w_{\\text{T}}$。\n\n因此，总自旋平方算符 $\\hat{S}^2$ 的期望值由下式给出：\n$$\n\\langle \\hat{S}^2 \\rangle = w_{\\text{S}} \\langle \\Psi_{\\text{S}} | \\hat{S}^2 | \\Psi_{\\text{S}} \\rangle + w_{\\text{T}} \\langle \\Psi_{\\text{T}} | \\hat{S}^2 | \\Psi_{\\text{T}} \\rangle\n$$\n态 $|\\Psi_{\\text{S}}\\rangle$ 和 $|\\Psi_{\\text{T}}\\rangle$ 是纯自旋态，因此是 $\\hat{S}^2$ 算符的本征态。问题中给出，对于一个总自旋量子数为 $S$ 的纯自旋态，其本征值为 $S(S+1)$。\n\n对于单重态，总自旋量子数为 $S=0$。其本征值为：\n$$\n\\langle \\Psi_{\\text{S}} | \\hat{S}^2 | \\Psi_{\\text{S}} \\rangle = 0(0+1) = 0\n$$\n对于三重态，总自旋量子数为 $S=1$。其本征值为：\n$$\n\\langle \\Psi_{\\text{T}} | \\hat{S}^2 | \\Psi_{\\text{T}} \\rangle = 1(1+1) = 2\n$$\n将这些本征值代入混合态的期望值表达式中：\n$$\n\\langle \\hat{S}^2 \\rangle = w_{\\text{S}}(0) + w_{\\text{T}}(2) = 2w_{\\text{T}}\n$$\n问题陈述计算出的期望值约为 $1.0$。对于这个理想化模型，我们将其视为精确值，即 $\\langle \\hat{S}^2 \\rangle = 1.0$。\n$$\n1.0 = 2w_{\\text{T}}\n$$\n求解三重态组分的权重 $w_{\\text{T}}$：\n$$\nw_{\\text{T}} = \\frac{1.0}{2} = 0.5\n$$\n根据条件 $w_{\\text{S}} + w_{\\text{T}} = 1$，权重是归一化的。现在我们可以求解单重态组分的权重 $w_{\\text{S}}$：\n$$\nw_{\\text{S}} + 0.5 = 1\n$$\n$$\nw_{\\text{S}} = 1 - 0.5 = 0.5\n$$\n得到的权重为 $w_{\\text{S}} = 0.5$ 和 $w_{\\text{T}} = 0.5$。这些值是非负的，与问题陈述一致。权重对为 $(w_{\\text{S}}, w_{\\text{T}}) = (0.5, 0.5)$。答案要求以行矩阵形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5 & 0.5\n\\end{pmatrix}\n}\n$$", "id": "2451205"}, {"introduction": "理解了 $\\langle\\hat{S}^2\\rangle$ 值的含义之后，让我们在一个具体的化学过程中观察它的行为。这个练习以氢分子 $H_2$ 的解离过程为模型，它是一个典型的例子，展示了限制性方法在描述化学键断裂时的局限性以及破缺对称性方法的必要性。通过亲手推导并计算 $\\langle\\hat{S}^2\\rangle$ 随键长增加而从 $0$ 趋近于 $1$ 的过程，你将深刻理解为何破缺对称性解对于正确描述成键、解离以及双自由基等体系至关重要。[@problem_id:2451223]", "problem": "你需要对氢分子 $\\text{H}_2$ 在几个不同核间距下的总自旋平方算符的期望值 $\\langle\\hat{S}^2\\rangle$ 进行建模和计算。计算需使用两种 Kohn–Sham 密度泛函理论 (DFT) 的变体：限制性 Kohn–Sham (RKS) 方法和非限制性 Kohn–Sham (UKS) 方法，并特别关注在拉伸构型下的破缺对称性行为。你的任务是从基本原理出发推导必要的表达式，然后实现一个程序来评估和报告在一组指定的键长测试下的 $\\langle\\hat{S}^2\\rangle$ 预测值。\n\n你可以使用的基本原理：\n- 总自旋算符为 $\\hat{S}^2 = \\hat{S}_x^2 + \\hat{S}_y^2 + \\hat{S}_z^2$，对于双电子体系，$\\hat{S}^2 = \\hat{S}_1^2 + \\hat{S}_2^2 + 2\\,\\hat{\\mathbf{S}}_1 \\cdot \\hat{\\mathbf{S}}_2$。对于单个电子，$\\langle\\hat{S}^2\\rangle = \\tfrac{3}{4}$。\n- 在非限制性 Kohn–Sham (UKS) 理论中，一个由空间轨道 $\\phi_\\alpha(\\mathbf{r})$ 中的 $\\alpha$ 自旋电子和空间轨道 $\\phi_\\beta(\\mathbf{r})$ 中的 $\\beta$ 自旋电子构成的单一 Slater 行列式是一个有效的平均场态；在限制性 Kohn–Sham (RKS) 理论中，对于闭壳层单重态，$\\alpha$ 和 $\\beta$ 电子的空间轨道相同，即 $\\phi_\\alpha = \\phi_\\beta$。\n- 对于 $\\text{H}_2$，假设在很大分离距离下，空间轨道变成位于原子 $A$ 和 $B$ 上的局域化类氢 $1s$ Slater 型轨道，其原子单位下的指数为 $\\zeta = 1$。在核间距为 $R$（以玻尔半径为单位）时，$1s$ 轨道之间的空间重叠为\n  $$ S(R) = e^{-\\zeta R} \\left(1 + \\zeta R + \\frac{(\\zeta R)^2}{3}\\right), $$\n  其中 $\\zeta = 1$。使用换算关系 $1\\,\\text{\\AA} = 1.889726125\\,\\text{bohr}$。\n- UKS 中的破缺对称性出现在 $\\alpha$ 和 $\\beta$ 空间轨道在空间上变得不同（分别局域在不同原子上）时；此时，该单行列式态不再是 $\\hat{S}^2$ 的本征态，并表现出所谓的自旋污染。相比之下，RKS 单重态总是强制要求 $\\phi_\\alpha = \\phi_\\beta$。\n\n你的推导必须从自旋算符的定义和 Slater 行列式的结构出发，得到一个用已占据的 $\\alpha$ 和 $\\beta$ 轨道的空间重叠表示的双电子单行列式态的 $\\langle\\hat{S}^2\\rangle$ 表达式。然后，通过在 $\\alpha$ 和 $\\beta$ 轨道局域在相距为 $R$ 的不同原子上时，使用上述 $1s$–$1s$ 重叠表达式，将此结果特化到 $\\text{H}_2$ 的情况。\n\n为使问题完全确定且可进行数值检验，需作出以下建模假设：\n- 将 RKS 单重态始终视为自旋纯的，即 $\\langle\\hat{S}^2\\rangle_{\\text{RKS}} = 0$。\n- 对于 UKS，使用以下判定规则来模拟破缺对称性的出现：定义一个临界重叠值 $S_{\\text{crit}} = 0.73$。如果 $S(R) \\ge S_{\\text{crit}}$，则假定 UKS 解塌缩为 RKS 单重态，此时 $\\langle\\hat{S}^2\\rangle_{\\text{UKS}} = 0$。如果 $S(R) < S_{\\text{crit}}$，则假定存在一个局域化的破缺对称性 UKS 解，其中 $\\alpha$ 电子在原子 $A$ 上，$\\beta$ 电子在原子 $B$ 上，并根据这些轨道间的空间重叠来计算 $\\langle\\hat{S}^2\\rangle_{\\text{UKS}}$。\n- 角度不出现；所有距离都是核间距，必须以 $\\text{\\AA}$ 为单位提供，并在内部使用给定的换算关系转换为玻尔半径。\n- 所有输出均为无量纲实数。\n\n任务：\n1. 从第一性原理（自旋算符和 Slater 行列式）出发，推导出一个用已占据的 $\\alpha$ 和 $\\beta$ 轨道的空间重叠表示的双电子单行列式态的 $\\langle\\hat{S}^2\\rangle$ 表达式。\n2. 将此表达式应用于核间距为 $R$ 的 $\\text{H}_2$ 分子。对于 RKS，由于轨道相同，重叠为 1；对于破缺对称性的 UKS，使用相距为 $R$ 的原子 $A$ 和 $B$ 之间的原子间 $1s$–$1s$ 重叠。\n3. 实现一个程序，对于下面的每个测试用例，使用该模型计算一对数值 $[\\langle\\hat{S}^2\\rangle_{\\text{RKS}},\\langle\\hat{S}^2\\rangle_{\\text{UKS}}]$，并按指定格式打印所有结果。\n\n测试集（核间距，单位为 $\\text{\\AA}$）：\n- $R_1 = 0.74\\,\\text{\\AA}$（接近平衡位置；预期无破缺对称性）。\n- $R_2 = 0.85\\,\\text{\\AA}$（在此模型中接近破缺对称性的临界点）。\n- $R_3 = 3.00\\,\\text{\\AA}$（拉伸状态）。\n- $R_4 = 10.00\\,\\text{\\AA}$（解离极限）。\n\n最终输出格式：\n- 你的程序必须生成一行包含四个条目的列表，按 $R_1, R_2, R_3, R_4$ 的顺序对应每个测试用例。每个条目都是一个双元素列表 $[\\langle\\hat{S}^2\\rangle_{\\text{RKS}},\\langle\\hat{S}^2\\rangle_{\\text{UKS}}]$。所有数字必须是浮点数，并四舍五入到六位小数。例如：\n  $$\\texttt{[[0.000000,0.000000],[0.000000,0.523456],[0.000000,0.996400],[0.000000,1.000000]]}.$$", "solution": "该问题要求推导并计算一个由单一 Slater 行列式描述的双电子体系的总自旋平方算符期望值 $\\langle\\hat{S}^2\\rangle$。这将应用于在限制性 Kohn–Sham (RKS) 和非限制性 Kohn–Sham (UKS) 框架下的 $\\text{H}_2$ 分子模型。该问题具有科学依据，提法严谨，并包含了获得唯一解所需的所有信息。我们着手进行推导。\n\n首先，我们建立理论基础。在平均场理论中，双电子态由一个单一 Slater 行列式描述。对于一个 $\\alpha$ 自旋电子在空间轨道 $\\phi_\\alpha$ 中、一个 $\\beta$ 自旋电子在空间轨道 $\\phi_\\beta$ 中的体系，其波函数为：\n$$ \\Psi(\\mathbf{x}_1, \\mathbf{x}_2) = \\frac{1}{\\sqrt{2}} \\left| \\begin{matrix} \\phi_\\alpha(\\mathbf{r}_1)\\alpha(\\omega_1) & \\phi_\\beta(\\mathbf{r}_1)\\beta(\\omega_1) \\\\ \\phi_\\alpha(\\mathbf{r}_2)\\alpha(\\omega_2) & \\phi_\\beta(\\mathbf{r}_2)\\beta(\\omega_2) \\end{matrix} \\right| $$\n其中 $\\mathbf{x}_i = (\\mathbf{r}_i, \\omega_i)$ 表示电子 $i$ 的空间和自旋坐标。这可以展开为：\n$$ \\Psi = \\frac{1}{\\sqrt{2}} [ \\phi_\\alpha(1)\\alpha(1) \\phi_\\beta(2)\\beta(2) - \\phi_\\alpha(2)\\alpha(2) \\phi_\\beta(1)\\beta(1) ] $$\n我们假设空间轨道 $\\phi_\\alpha$ 和 $\\phi_\\beta$ 是归一化的，即 $\\langle\\phi_\\alpha|\\phi_\\alpha\\rangle = 1$ 和 $\\langle\\phi_\\beta|\\phi_\\beta\\rangle=1$。它们的空间重叠记为 $S_{\\alpha\\beta} = \\langle \\phi_\\alpha | \\phi_\\beta \\rangle = \\int \\phi_\\alpha^*(\\mathbf{r}) \\phi_\\beta(\\mathbf{r}) d\\mathbf{r}$。自旋轨道 $\\chi_\\alpha(\\mathbf{x}) = \\phi_\\alpha(\\mathbf{r})\\alpha(\\omega)$ 和 $\\chi_\\beta(\\mathbf{x}) = \\phi_\\beta(\\mathbf{r})\\beta(\\omega)$ 是正交的，$\\langle\\chi_\\alpha|\\chi_\\beta\\rangle = \\langle\\phi_\\alpha|\\phi_\\beta\\rangle\\langle\\alpha|\\beta\\rangle = 0$，因此 Slater 行列式通过因子 $1/\\sqrt{2}$ 进行了正确的归一化。\n\n对于一个双电子体系，总自旋平方算符为 $\\hat{S}^2 = (\\hat{\\mathbf{S}}_1 + \\hat{\\mathbf{S}}_2)^2$。我们将其展开：\n$$ \\hat{S}^2 = \\hat{S}_1^2 + \\hat{S}_2^2 + 2\\hat{\\mathbf{S}}_1 \\cdot \\hat{\\mathbf{S}}_2 = \\hat{S}_1^2 + \\hat{S}_2^2 + 2\\hat{S}_{1z}\\hat{S}_{2z} + \\hat{S}_{1+}\\hat{S}_{2-} + \\hat{S}_{1-}\\hat{S}_{2+} $$\n期望值为 $\\langle\\hat{S}^2\\rangle = \\langle\\Psi | \\hat{S}^2 | \\Psi\\rangle$。我们逐项进行计算。\n\n1.  项 $\\langle\\hat{S}_1^2 + \\hat{S}_2^2\\rangle$：\n    对于任何单个电子（自旋为 $1/2$ 的粒子），其自身自旋平方算符的本征值为 $s(s+1) = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$。由于 $\\Psi$ 是一个归一化的双电子波函数，此项的期望值就是每个电子本征值的总和。\n    $\\langle\\Psi | (\\hat{S}_1^2 + \\hat{S}_2^2) | \\Psi\\rangle = \\langle\\hat{S}_1^2\\rangle + \\langle\\hat{S}_2^2\\rangle = \\frac{3}{4} + \\frac{3}{4} = \\frac{3}{2}$\n\n2.  项 $\\langle2\\hat{S}_{1z}\\hat{S}_{2z}\\rangle$：\n    我们将算符作用在右矢 $\\Psi$ 上。算符 $\\hat{S}_{iz}$ 作用于电子 $i$ 的自旋函数，对于 $\\alpha$ 自旋得到本征值 $+\\frac{1}{2}$，对于 $\\beta$ 自旋得到 $-\\frac{1}{2}$。\n    $$ \\hat{S}_{1z}\\hat{S}_{2z} \\Psi = \\frac{1}{\\sqrt{2}} [ \\phi_\\alpha(1)\\phi_\\beta(2)(\\hat{S}_{1z}\\alpha(1))(\\hat{S}_{2z}\\beta(2)) - \\phi_\\alpha(2)\\phi_\\beta(1)(\\hat{S}_{1z}\\beta(1))(\\hat{S}_{2z}\\alpha(2)) ] $$\n    $$ = \\frac{1}{\\sqrt{2}} [ \\phi_\\alpha(1)\\phi_\\beta(2)(+\\frac{1}{2}\\alpha(1))(-\\frac{1}{2}\\beta(2)) - \\phi_\\alpha(2)\\phi_\\beta(1)(-\\frac{1}{2}\\beta(1))(+\\frac{1}{2}\\alpha(2)) ] $$\n    $$ = -\\frac{1}{4} \\frac{1}{\\sqrt{2}} [ \\phi_\\alpha(1)\\alpha(1)\\phi_\\beta(2)\\beta(2) - \\phi_\\alpha(2)\\alpha(2)\\phi_\\beta(1)\\beta(1) ] = -\\frac{1}{4} \\Psi $$\n    因此，$\\langle\\Psi | 2\\hat{S}_{1z}\\hat{S}_{2z} | \\Psi\\rangle = 2 \\cdot \\langle \\Psi | (-\\frac{1}{4}) \\Psi \\rangle = -\\frac{1}{2}\\langle\\Psi|\\Psi\\rangle = -\\frac{1}{2}$。\n\n3.  项 $\\langle\\hat{S}_{1-}\\hat{S}_{2+} + \\hat{S}_{1+}\\hat{S}_{2-}\\rangle$：\n    此项涉及自旋翻转。我们首先计算 $\\langle\\Psi | \\hat{S}_{1-}\\hat{S}_{2+} | \\Psi\\rangle$。升降算符的作用为 $\\hat{S}_+\\beta = \\alpha$，$\\hat{S}_+\\alpha = 0$，$\\hat{S}_-\\alpha = \\beta$，$\\hat{S}_-\\beta = 0$。\n    $$ \\hat{S}_{2+} \\Psi = \\frac{1}{\\sqrt{2}} [ \\phi_\\alpha(1)\\alpha(1)\\phi_\\beta(2)\\alpha(2) - 0 ] $$\n    $$ \\hat{S}_{1-}(\\hat{S}_{2+}\\Psi) = \\frac{1}{\\sqrt{2}} [ \\phi_\\alpha(1)\\beta(1)\\phi_\\beta(2)\\alpha(2) ] $$\n    期望值积分为：\n    $$ \\langle\\Psi | \\hat{S}_{1-}\\hat{S}_{2+} | \\Psi\\rangle = \\frac{1}{2} \\langle \\phi_\\alpha(1)\\alpha(1)\\phi_\\beta(2)\\beta(2) - \\phi_\\alpha(2)\\alpha(2)\\phi_\\beta(1)\\beta(1) | \\phi_\\alpha(1)\\beta(1)\\phi_\\beta(2)\\alpha(2) \\rangle $$\n    左矢中的第一项在自旋积分后为零：$\\langle\\alpha(1)\\beta(2)|\\beta(1)\\alpha(2)\\rangle = \\langle\\alpha|\\beta\\rangle\\langle\\beta|\\alpha\\rangle = 0$。第二项得出：\n    $$ -\\frac{1}{2} \\langle\\phi_\\alpha(2)\\alpha(2)\\phi_\\beta(1)\\beta(1) | \\phi_\\alpha(1)\\beta(1)\\phi_\\beta(2)\\alpha(2)\\rangle = -\\frac{1}{2} \\langle\\phi_\\beta|\\phi_\\alpha\\rangle\\langle\\phi_\\alpha|\\phi_\\beta\\rangle\\langle\\beta|\\beta\\rangle\\langle\\alpha|\\alpha\\rangle = -\\frac{1}{2}S_{\\beta\\alpha}S_{\\alpha\\beta} = -\\frac{1}{2}|S_{\\alpha\\beta}|^2 $$\n    对于该项的第二部分，$\\langle\\Psi | \\hat{S}_{1+}\\hat{S}_{2-} | \\Psi\\rangle$：\n    $$ \\hat{S}_{2-} \\Psi = \\frac{1}{\\sqrt{2}} [ 0 - \\phi_\\alpha(2)\\beta(2)\\phi_\\beta(1)\\beta(1) ] $$\n    $$ \\hat{S}_{1+}(\\hat{S}_{2-}\\Psi) = -\\frac{1}{\\sqrt{2}} [ \\phi_\\alpha(2)\\beta(2)\\phi_\\beta(1)\\alpha(1) ] $$\n    期望值为：\n    $$ \\langle\\Psi | \\hat{S}_{1+}\\hat{S}_{2-} | \\Psi\\rangle = -\\frac{1}{2} \\langle \\phi_\\alpha(1)\\alpha(1)\\phi_\\beta(2)\\beta(2) - \\phi_\\alpha(2)\\alpha(2)\\phi_\\beta(1)\\beta(1) | \\phi_\\beta(1)\\alpha(1)\\phi_\\alpha(2)\\beta(2) \\rangle $$\n    左矢中的第二项在自旋积分后为零。第一项得出：\n    $$ -\\frac{1}{2} \\langle\\phi_\\alpha(1)\\alpha(1)\\phi_\\beta(2)\\beta(2) | \\phi_\\beta(1)\\alpha(1) \\phi_\\alpha(2)\\beta(2)\\rangle = -\\frac{1}{2} \\langle\\phi_\\alpha|\\phi_\\beta\\rangle\\langle\\phi_\\beta|\\phi_\\alpha\\rangle\\langle\\alpha|\\alpha\\rangle\\langle\\beta|\\beta\\rangle = -\\frac{1}{2}S_{\\alpha\\beta}S_{\\beta\\alpha} = -\\frac{1}{2}|S_{\\alpha\\beta}|^2 $$\n    将这两部分相加得到 $\\langle\\hat{S}_{1-}\\hat{S}_{2+} + \\hat{S}_{1+}\\hat{S}_{2-}\\rangle = -|S_{\\alpha\\beta}|^2$。\n\n综合所有项，总期望值为：\n$$ \\langle\\hat{S}^2\\rangle = \\frac{3}{2} - \\frac{1}{2} - |S_{\\alpha\\beta}|^2 = 1 - |S_{\\alpha\\beta}|^2 $$\n这是一个具有一个 $\\alpha$ 电子和一个 $\\beta$ 电子的双电子单行列式态的自旋污染的通用表达式。\n\n现在，我们将此公式应用于 $\\text{H}_2$ 分子的指定模型。\n\n对于 RKS 理论，单重态的两个电子处于相同的空间轨道，因此 $\\phi_\\alpha = \\phi_\\beta$。空间重叠为 $S_{\\alpha\\beta} = \\langle\\phi_\\alpha|\\phi_\\alpha\\rangle = 1$。\n$$ \\langle\\hat{S}^2\\rangle_{\\text{RKS}} = 1 - 1^2 = 0 $$\n这对应于一个纯单重态，该态是无自旋污染的，与问题的假设一致。\n\n对于 UKS 理论，我们使用给定的判定规则。键长 $R$ 以埃（Å）为单位给出，必须使用换算系数 $1\\,\\text{\\AA} = 1.889726125\\,a_0$ 转换为玻尔半径（$a_0$）。两个 $1s$ Slater 型轨道之间的原子间重叠由下式给出：\n$$ S(R) = e^{-\\zeta R} \\left(1 + \\zeta R + \\frac{(\\zeta R)^2}{3}\\right) $$\n其中 $\\zeta=1$ 且 $R$ 以 $a_0$ 为单位。临界重叠值为 $S_{\\text{crit}} = 0.73$。\n\n如果 $S(R) \\ge S_{\\text{crit}}$，则假定 UKS 解与 RKS 解相同。在这种情况下，$\\phi_\\alpha = \\phi_\\beta$，所以 $S_{\\alpha\\beta} = 1$ 且：\n$$ \\langle\\hat{S}^2\\rangle_{\\text{UKS}} = 0 $$\n\n如果 $S(R) < S_{\\text{crit}}$，则形成破缺对称性解。$\\alpha$ 电子局域在原子 A 上（$\\phi_\\alpha = \\phi_A$），$\\beta$ 电子局域在原子 B 上（$\\phi_\\beta = \\phi_B$）。占据轨道之间的空间重叠即原子间重叠，$S_{\\alpha\\beta} = \\langle\\phi_A|\\phi_B\\rangle = S(R)$。对于实轨道，有 $|S(R)|^2 = (S(R))^2$。因此，期望值为：\n$$ \\langle\\hat{S}^2\\rangle_{\\text{UKS}} = 1 - [S(R)]^2 $$\n当 $R \\to \\infty$ 时，$S(R) \\to 0$，且 $\\langle\\hat{S}^2\\rangle_{\\text{UKS}} \\to 1$。这对应于一个由纯单重态（$S=0, \\langle\\hat{S}^2\\rangle=0$）和纯三重态（$S=1, \\langle\\hat{S}^2\\rangle=2$）以 50/50 比例混合而成的态，其平均 $\\langle\\hat{S}^2\\rangle = (0.5 \\times 0) + (0.5 \\times 2) = 1$。\n\n计算步骤将是为每个给定的核间距 $R$ 实现此模型。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the expectation value of the total spin-squared operator <S^2>\n    for the H2 molecule at various internuclear distances using RKS and UKS models.\n    \"\"\"\n\n    # --- Problem Givens ---\n    # Conversion factor from Angstrom to Bohr\n    BOHR_PER_ANGSTROM = 1.889726125\n    # Slater-type orbital exponent for 1s orbital of H\n    ZETA = 1.0\n    # Critical overlap for the onset of broken symmetry\n    S_CRIT = 0.73\n\n    # Test suite of internuclear distances in Angstrom\n    test_cases = [\n        0.74,  # near equilibrium\n        0.85,  # near the onset of broken symmetry\n        3.00,  # stretched\n        10.00, # dissociation limit\n    ]\n\n    def calculate_sto_overlap(R_bohr: float, zeta: float) -> float:\n        \"\"\"\n        Calculates the overlap integral S between two 1s Slater-type orbitals\n        at a separation R.\n        \n        Args:\n            R_bohr: The internuclear distance in Bohr radii.\n            zeta: The exponent of the Slater-type orbital.\n\n        Returns:\n            The value of the overlap integral.\n        \"\"\"\n        zR = zeta * R_bohr\n        return np.exp(-zR) * (1.0 + zR + (zR**2) / 3.0)\n\n    results = []\n    for R_angstrom in test_cases:\n        # For RKS, the state is always a pure singlet, so <S^2> = 0.\n        s2_rks = 0.0\n\n        # Convert distance from Angstrom to Bohr\n        R_bohr = R_angstrom * BOHR_PER_ANGSTROM\n        \n        # Calculate interatomic overlap S(R)\n        s_R = calculate_sto_overlap(R_bohr, ZETA)\n\n        # Apply the decision rule for the UKS calculation\n        if s_R >= S_CRIT:\n            # Below the critical distance, the UKS solution collapses to the\n            # RKS singlet solution, which is spin-pure.\n            s2_uks = 0.0\n        else:\n            # Above the critical distance, a broken-symmetry solution appears.\n            # The spin contamination is given by 1 - S(R)^2.\n            s2_uks = 1.0 - s_R**2\n        \n        # Append the pair of results for the current distance\n        results.append([s2_rks, s2_uks])\n\n    # Format the final output string as specified\n    # e.g., [[0.000000,0.000000],[0.000000,0.516387],...]\n    output_str_parts = []\n    for pair in results:\n        formatted_pair = f\"[{pair[0]:.6f},{pair[1]:.6f}]\"\n        output_str_parts.append(formatted_pair)\n    \n    final_output = f\"[{','.join(output_str_parts)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2451223"}, {"introduction": "我们已经看到了自旋污染是什么以及它何时出现，但体系选择破缺对称性解的根本能量驱动力是什么？这个练习通过一个经典的“两中心，两电子”模型，揭示了这一现象背后的核心物理机制。你将分析电子“跃迁”能 ($t$) 与在位“排斥”能 ($U$) 之间的竞争，并确定这种竞争如何决定体系的基态是保持对称性还是自发地破缺对称性，从而为理解真实DFT计算中的电子不稳定性提供坚实的数学基础。[@problem_id:2451215]", "problem": "您将以纯数学形式，在一个类似于破缺对称性密度泛函理论 (DFT) 的开壳层平均场处理中，对一个对称性保持解如何因对称性破缺而不稳定进行建模。考虑一个双中心、双电子的平均场模型，每个中心有一个空间轨道，电子自旋相反，由跃迁参数 $t$（实数，正值）和在位相互作用强度 $U$（实数，非负值）描述。定义一个自旋极化参数 $m \\in [-\\tfrac{1}{2}, \\tfrac{1}{2}]$，使得 A 中心的自旋向上和自旋向下布居数分别为 $n_{A,\\uparrow} = \\tfrac{1}{2} + m$ 和 $n_{A,\\downarrow} = \\tfrac{1}{2} - m$，而 B 中心的布居数分别为 $n_{B,\\uparrow} = \\tfrac{1}{2} - m$ 和 $n_{B,\\downarrow} = \\tfrac{1}{2} + m$。总平均场能量是 $m$ 的函数，表达式为\n$$\nE(m; t, U) = \\frac{U}{2} - 2 \\sqrt{t^2 + U^2 m^2} + 2 U m^2.\n$$\n对称性保持（限制性）解对应于 $m = 0$，其能量为\n$$\nE_{\\mathrm{R}}(t,U) = E(0; t, U) = \\frac{U}{2} - 2 t.\n$$\n限制性解的稳定性分析由 $E(m; t, U)$ 在 $m = 0$ 处的曲率定义，即二阶导数\n$$\n\\left.\\frac{d^2 E}{d m^2}\\right|_{m=0} = 4 U - \\frac{2 U^2}{t}.\n$$\n如果该曲率为负，则 $m = 0$ 不是局部最小值，且在 $m^\\star \\in (0, \\tfrac{1}{2}]$ 的某个位置存在一个能量更低的对称性破缺解。如果该曲率为非负，则 $m = 0$ 是一个局部最小值，在定义域 $[-\\tfrac{1}{2}, \\tfrac{1}{2}]$ 内没有能量更低的对称性破缺解。\n\n您的任务是编写一个程序，对下面测试套件中的每一对参数 $(t,U)$，判断是否存在能量更低的对称性破缺解，并计算能量差\n$$\n\\Delta E(t,U) = E_{\\text{BS}}(t,U) - E_{\\text{R}}(t,U),\n$$\n其中 $E_{\\text{BS}}(t,U)$ 是 $E(m; t, U)$ 在 $m \\in [-\\tfrac{1}{2}, \\tfrac{1}{2}]$ 上的最小值。将是否存在能量更低的对称性破缺解报告为布尔值（如果 $\\Delta E(t,U) < 0$ 则为 true，否则为 false），并将 $\\Delta E(t,U)$ 报告为一个四舍五入到六位小数的实数。所有能量必须以电子伏特 (eV) 表示。对于边界上精确相等的数值比较，将 $10^{-12}$ 容差范围内的值视为相等。\n\n测试套件（每对 $(t,U)$ 均以电子伏特为单位给出）：\n- 情况 1 (正常路径，限制性解稳定)：$t = 1.00$，$U = 1.00$。\n- 情况 2 (边界条件)：$t = 1.00$，$U = 2.00$。\n- 情况 3 (正常路径，不稳定的限制性解导致对称性破缺)：$t = 1.00$，$U = 3.00$。\n- 情况 4 (小 $t$ 和较大 $U$ 的边缘情况)：$t = 0.50$，$U = 2.00$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，按顺序输出两个值：首先是表示是否存在能量更低的对称性破缺解的布尔值，然后是相应的四舍五入到六位小数的 $\\Delta E(t,U)$。将所有测试用例按给定顺序聚合到一个扁平列表中。例如，包含两个测试用例的输出将如下所示\n[true,-0.123456,false,0.000000]\n但请使用上面指定的精确用例和结果。布尔值必须以 Python 风格的大小写形式打印（True 或 False）。", "solution": "问题陈述已经过严格审查，并被确定为有效。其科学依据充分、问题定义明确且内部逻辑一致。它提出了一个可解的数学问题，该问题源于计算化学中一个用于阐释平均场理论中对称性破缺概念的简化但标准的模型。\n\n任务是对于给定的参数 $t$ 和 $U$，判断是否存在对称性破缺解，并计算能量差 $\\Delta E(t,U) = E_{\\text{BS}}(t,U) - E_{\\text{R}}(t,U)$。此处，$E_{\\text{R}}$ 是 $m=0$ 时对称性保持解的能量，而 $E_{\\text{BS}}$ 是最低能量解的能量，通过在自旋极化参数 $m$ 的整个定义域上最小化总能量函数 $E(m; t, U)$ 得到。\n\n总平均场能量由下式给出：\n$$\nE(m; t, U) = \\frac{U}{2} - 2 \\sqrt{t^2 + U^2 m^2} + 2 U m^2\n$$\n自旋极化参数的定义域为 $m \\in [-\\tfrac{1}{2}, \\tfrac{1}{2}]$。$m=0$ 时对称性保持（限制性）解的能量为：\n$$\nE_{\\text{R}}(t,U) = E(0; t, U) = \\frac{U}{2} - 2t\n$$\n我们的目标是找到 $E(m; t, U)$ 在闭区间 $[-\\tfrac{1}{2}, \\tfrac{1}{2}]$ 上的全局最小值。我们将此最小能量表示为 $E_{\\text{BS}}(t,U)$。\n\n首先，我们观察到能量函数 $E(m; t, U)$ 是 $m$ 的偶函数，因为 $m$ 仅以 $m^2$ 的形式出现。也就是说，$E(m; t, U) = E(-m; t, U)$。因此，我们可以将最小值搜索范围限制在区间 $m \\in [0, \\tfrac{1}{2}]$ 内，以简化分析。\n\n一个连续可微函数在闭区间上的全局最小值出现在区间的边界点或区间内一阶导数为零的临界点。我们所限区间的边界是 $m=0$ 和 $m=\\tfrac{1}{2}$。我们通过求 $E(m; t, U)$ 对 $m$ 的一阶导数并令其为零来找到临界点。\n\n一阶导数为：\n$$\n\\frac{dE}{dm} = \\frac{d}{dm} \\left( \\frac{U}{2} - 2 \\sqrt{t^2 + U^2 m^2} + 2 U m^2 \\right)\n$$\n$$\n\\frac{dE}{dm} = 0 - 2 \\cdot \\frac{1}{2\\sqrt{t^2 + U^2 m^2}} \\cdot (2 U^2 m) + 4 U m\n$$\n$$\n\\frac{dE}{dm} = -\\frac{2 U^2 m}{\\sqrt{t^2 + U^2 m^2}} + 4 U m = m \\left( 4U - \\frac{2 U^2}{\\sqrt{t^2 + U^2 m^2}} \\right)\n$$\n令 $\\frac{dE}{dm}=0$ 会得到临界点的两种可能性：\n1.  $m=0$。这是我们定义域 $[0, \\tfrac{1}{2}]$ 的一个边界点。\n2.  $4U - \\frac{2 U^2}{\\sqrt{t^2 + U^2 m^2}} = 0$。\n\n让我们分析第二种可能性，即一个非平凡临界点，我们将其表示为 $m^*$。假设 $U > 0$（所有测试用例均如此），我们可以重排该方程：\n$$\n4U = \\frac{2 U^2}{\\sqrt{t^2 + U^2 (m^*)^2}} \\implies 2 = \\frac{U}{\\sqrt{t^2 + U^2 (m^*)^2}}\n$$\n两边平方得：\n$$\n4 = \\frac{U^2}{t^2 + U^2 (m^*)^2} \\implies 4t^2 + 4U^2 (m^*)^2 = U^2\n$$\n$$\n4U^2 (m^*)^2 = U^2 - 4t^2 \\implies (m^*)^2 = \\frac{U^2 - 4t^2}{4U^2} = \\frac{1}{4} - \\frac{t^2}{U^2}\n$$\n只有当右侧为正，即 $U^2 - 4t^2 > 0$ 时，$m^*$ 才存在非零实数解。由于 $t$ 和 $U$ 均为正值，这可以简化为 $U > 2t$。如果存在这样的解，其值为：\n$$\nm^* = \\sqrt{\\frac{1}{4} - \\frac{t^2}{U^2}}\n$$\n这个临界点 $m^*$ 位于我们关注的定义域内，因为 $0 < \\frac{t^2}{U^2} < \\frac{1}{4}$（由于 $U>2t$），这意味着 $0 < m^* < \\frac{1}{2}$。\n\n存在非平凡最小值的条件 $U > 2t$ 正是限制性解不稳定的条件。稳定性由 $m=0$ 处的二阶导数（曲率）的符号决定：\n$$\n\\left.\\frac{d^2 E}{d m^2}\\right|_{m=0} = 4 U - \\frac{2 U^2}{t}\n$$\n如果该曲率为负，$m=0$ 是一个局部最大值，必须存在一个对称性破缺的最小值。$4 U - \\frac{2 U^2}{t} < 0 \\iff 4U < \\frac{2U^2}{t} \\iff 2t < U$。这证实了我们的发现。\n\n现在我们可以根据 $U$ 与 $t$ 的比率制定一个完整的策略。\n\n情况 1：稳定或临界稳定区域 ($U \\le 2t$)。\n在此区域内，$m=0$ 处的曲率为非负 ($4U - \\frac{2U^2}{t} \\ge 0$)。在定义域 $m \\in [0, \\infty)$ 内唯一的实数临界点是 $m=0$。对于所有 $m \\ge 0$，导数 $\\frac{dE}{dm}$ 均为非负，这意味着函数 $E(m; t, U)$ 在区间 $[0, \\tfrac{1}{2}]$ 上是单调不减的。因此，该函数在此区间上的最小值必然出现在 $m=0$ 处。\n因此，全局最小能量为 $E_{\\text{BS}}(t,U) = E(0; t, U) = E_{\\text{R}}(t,U)$。\n能量差为 $\\Delta E(t,U) = E_{\\text{BS}} - E_{\\text{R}} = 0$。\n不存在能量更低的对称性破缺解。相应的布尔值为 `False`。\n\n情况 2：不稳定区域 ($U > 2t$)。\n在此区域内，$m=0$ 处的曲率为负，表明 $m=0$ 是一个局部最大值。存在一个非平凡临界点 $m^* = \\sqrt{\\frac{1}{4} - \\frac{t^2}{U^2}}$ 位于 $(0, \\tfrac{1}{2})$ 区间内。此点对应一个局部最小值。由于 $m=0$ 是局部最大值，且 $m^*$ 是区间内唯一的其他临界点，因此 $m^*$ 必然是 $[0, \\tfrac{1}{2}]$ 上的全局最小值。\n最小能量 $E_{\\text{BS}}$ 是在 $m=m^*$ 处计算的能量：\n$$\nE_{\\text{BS}}(t,U) = E(m^*; t, U) = \\frac{U}{2} - 2 \\sqrt{t^2 + U^2 (m^*)^2} + 2 U (m^*)^2\n$$\n我们简化这些项。首先，平方根项：\n$$\n\\sqrt{t^2 + U^2 (m^*)^2} = \\sqrt{t^2 + U^2 \\left(\\frac{U^2 - 4t^2}{4U^2}\\right)} = \\sqrt{t^2 + \\frac{U^2 - 4t^2}{4}} = \\sqrt{\\frac{4t^2 + U^2 - 4t^2}{4}} = \\sqrt{\\frac{U^2}{4}} = \\frac{U}{2}\n$$\n将此项和 $(m^*)^2$ 代回能量表达式：\n$$\nE_{\\text{BS}}(t,U) = \\frac{U}{2} - 2\\left(\\frac{U}{2}\\right) + 2U\\left(\\frac{1}{4} - \\frac{t^2}{U^2}\\right) = \\frac{U}{2} - U + \\frac{U}{2} - \\frac{2t^2}{U} = -\\frac{2t^2}{U}\n$$\n现在，我们计算能量差 $\\Delta E(t,U) = E_{\\text{BS}} - E_{\\text{R}}$：\n$$\n\\Delta E(t,U) = -\\frac{2t^2}{U} - \\left(\\frac{U}{2} - 2t\\right) = \\frac{-4t^2 - U^2 + 4tU}{2U} = -\\frac{U^2 - 4tU + 4t^2}{2U}\n$$\n$$\n\\Delta E(t,U) = -\\frac{(U - 2t)^2}{2U}\n$$\n由于 $U > 2t$，$(U-2t)^2 > 0$ 且 $2U > 0$，因此 $\\Delta E(t,U)$ 严格为负。这证实了存在能量更低的对称性破缺解。相应的布尔值为 `True`。\n\n最终算法如下：对于每一对 $(t, U)$，我们检查是否 $U - 2t > 10^{-12}$。如果此条件为真，则存在能量更低的对称性破缺解；我们报告 `True` 并计算 $\\Delta E = -\\frac{(U-2t)^2}{2U}$。否则，不存在此类解；我们报告 `False` 且 $\\Delta E = 0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\n# No imports are needed for this problem.\n\ndef solve():\n    \"\"\"\n    Solves the broken-symmetry problem for a set of test cases.\n\n    For each parameter pair (t, U), this function determines if a lower-energy\n    symmetry-broken solution exists and computes the energy stabilization\n    delta_E = E_BS - E_R.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (t, U) in electronvolts (eV).\n    test_cases = [\n        (1.00, 1.00),  # Case 1: Stable restricted solution\n        (1.00, 2.00),  # Case 2: Boundary condition\n        (1.00, 3.00),  # Case 3: Unstable restricted (symmetry breaking)\n        (0.50, 2.00),  # Case 4: Edge case with small t\n    ]\n\n    # Tolerance for numerical comparison of floating-point numbers.\n    TOLERANCE = 1e-12\n\n    # A flat list to store the final results for all test cases.\n    results = []\n\n    for t, U in test_cases:\n        # The condition for instability of the restricted solution and the\n        # existence of a symmetry-broken minimum is U > 2*t.\n        # We use a tolerance for stable floating-point comparison.\n        if (U - 2 * t) > TOLERANCE:\n            # Case: A lower-energy symmetry-broken solution exists.\n            has_broken_symmetry = True\n            \n            # The energy difference is given by the analytical formula:\n            # delta_E = -(U - 2*t)^2 / (2*U)\n            delta_e = -((U - 2 * t) ** 2) / (2 * U)\n        else:\n            # Case: The restricted solution (m=0) is the minimum.\n            # This occurs when U <= 2*t.\n            has_broken_symmetry = False\n            delta_e = 0.0\n\n        # Append the boolean and the formatted energy difference to the results list.\n        # The energy difference must be a string rounded to six decimal places.\n        results.append(has_broken_symmetry)\n        results.append(f\"{delta_e:.6f}\")\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts boolean True/False and the pre-formatted\n    # float strings into a sequence of strings, which are then joined.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver function.\nsolve()\n```", "id": "2451215"}]}