{"hands_on_practices": [{"introduction": "理解半经验方法的第一步是掌握如何从最终的福克矩阵 (Fock matrix) 中提取分子轨道能量。这个练习提供了一个简单系统（乙烯的 $\\pi$ 体系）的具体手动计算过程，它让你亲身体验如何通过矩阵对角化获得轨道能量，从而加深对量子化学中核心数学操作物理意义的理解。这个基础练习是理解更复杂计算的基石 [@problem_id:2462038]。", "problem": "乙烯有一个双轨道的$\\pi$体系，由每个碳原子上的一个碳$2p_{z}$原子轨道构成。在全微分重叠忽略（CNDO/2）方法中，这些价轨道的重叠矩阵是单位矩阵，因此$\\pi$体系的久期方程简化为Fock矩阵$\\pi$块的标准特征值问题。考虑在最小基组 $\\{2p_{z}(\\mathrm{C}_{1}),\\,2p_{z}(\\mathrm{C}_{2})\\}$ 下对乙烯进行CNDO/2计算，得到的$\\pi$块Fock矩阵（单位为电子伏特）如下\n$$\nF_{\\pi}=\\begin{pmatrix}\n-11.42 & -2.80\\\\\n-2.80 & -11.42\n\\end{pmatrix}.\n$$\n假设为闭壳层基态，两个$\\pi$电子占据能量较低的分子轨道，请手动对角化$F_{\\pi}$以确定最高已占分子轨道（HOMO）和最低未占分子轨道（LUMO）的能量。以电子伏特为单位，按HOMO能量、LUMO能量的顺序报告你的最终答案，结果保留四位有效数字。", "solution": "所述问题是有效的。它具有科学依据，提法恰当且客观。它在半经验量子化学的背景下提出了一个标准的特征值问题，这是一个可解且有意义的任务。所有必要的信息都已提供。\n\n目标是确定乙烯$\\pi$体系的最高已占分子轨道（HOMO）和最低未占分子轨道（LUMO）的能量。在Hartree-Fock理论及其半经验近似（如CNDO/2）的框架内，正则分子轨道（MO）的能量是Fock矩阵 $F$ 的特征值。问题指出，在CNDO/2近似中，价轨道的重叠矩阵 $S$ 被视作单位矩阵 $I$。这将Roothaan-Hall久期方程 $FC = SCE$（其中 $C$ 是分子轨道系数矩阵， $E$ 是轨道能量 $\\epsilon_i$ 的对角矩阵）简化为标准特征值问题 $FC = CE$。\n\n我们已知在两个碳$2p_{z}$原子轨道基组下，Fock矩阵的$\\pi$块 $F_{\\pi}$ 为：\n$$\nF_{\\pi}=\\begin{pmatrix}\n-11.42 & -2.80\\\\\n-2.80 & -11.42\n\\end{pmatrix} \\, \\text{eV}\n$$\n该矩阵的特征值 $\\epsilon$ 对应于分子轨道的能量。它们通过求解特征方程得到：\n$$\n\\det(F_{\\pi} - \\epsilon I) = 0\n$$\n代入给定的矩阵 $F_{\\pi}$ 和 $2 \\times 2$ 的单位矩阵 $I$：\n$$\n\\det \\begin{pmatrix}\n-11.42 - \\epsilon & -2.80\\\\\n-2.80 & -11.42 - \\epsilon\n\\end{pmatrix} = 0\n$$\n计算行列式得到一个关于 $\\epsilon$ 的二次方程：\n$$\n(-11.42 - \\epsilon)(-11.42 - \\epsilon) - (-2.80)(-2.80) = 0\n$$\n$$\n(-11.42 - \\epsilon)^{2} - (-2.80)^{2} = 0\n$$\n$$\n(-11.42 - \\epsilon)^{2} = (2.80)^{2}\n$$\n对两边取平方根，我们得到两个线性方程：\n$$\n-11.42 - \\epsilon = \\pm 2.80\n$$\n求解 $\\epsilon$：\n$$\n-\\epsilon = 11.42 \\pm 2.80\n$$\n$$\n\\epsilon = -11.42 \\mp 2.80\n$$\n这得到了两个分子轨道的能量：\n较低的能量对应于成键$\\pi$分子轨道，为：\n$$\n\\epsilon_{1} = -11.42 - 2.80 = -14.22 \\, \\text{eV}\n$$\n较高的能量对应于反键$\\pi^{*}$分子轨道，为：\n$$\n\\epsilon_{2} = -11.42 + 2.80 = -8.62 \\, \\text{eV}\n$$\n问题指明乙烯为闭壳层基态，拥有 $2$ 个$\\pi$电子。根据Aufbau原理，这两个电子以配对自旋的方式占据能量最低的分子轨道 $\\epsilon_{1}$。\n因此，最高已占分子轨道（HOMO）是成键$\\pi$轨道。其能量为：\n$$\nE_{\\mathrm{HOMO}} = \\epsilon_{1} = -14.22 \\, \\text{eV}\n$$\n最低未占分子轨道（LUMO）是反键$\\pi^{*}$轨道。其能量为：\n$$\nE_{\\mathrm{LUMO}} = \\epsilon_{2} = -8.62 \\, \\text{eV}\n$$\n问题要求结果保留四位有效数字。\nHOMO能量 $-14.22$ 已有 4 位有效数字。\nLUMO能量 $-8.62$ 有 3 位有效数字。为了表示为 4 位有效数字，我们将其写为 $-8.620$。\n最终答案按HOMO能量、LUMO能量的顺序排列。", "answer": "$$\n\\boxed{\\begin{pmatrix}-14.22 & -8.620\\end{pmatrix}}\n$$", "id": "2462038"}, {"introduction": "在掌握了如何处理给定的哈密顿矩阵后，下一步是学习如何根据化学结构和半经验参数来构建这个矩阵。本练习将指导你为一个一维原子链模型建立一个简化“紧束缚”哈密顿量，仅使用基本的在位能参数 $\\alpha$ 和跃迁积分参数 $\\beta$。通过这个实践，你将清晰地看到哈密顿矩阵如何捕捉化学拓扑结构，以及它的本征值如何形成分子轨道的能带 [@problem_id:2462030]。", "problem": "您需要为一个一维氢原子链实现一个最小化的半经验紧束缚模型。从原子轨道的线性组合（LCAO）框架和矩阵形式的定态薛定谔方程出发，其中哈密顿矩阵仅使用两个半经验参数构建：一个在位能和一个最近邻共振积分。假设遵循以下基本近似和定义：\n- 每个原子使用一个原子轨道（氢的 $1s$ 轨道）的最小基组，形成一个标准正交基，因此重叠矩阵是单位矩阵。\n- 哈密顿矩阵元由每个原子的在位能 $\\,\\alpha\\,$ 和仅耦合相邻原子的最近邻共振积分 $\\,\\beta\\,$ 定义。\n- 开放边界条件：链中仅最近邻原子相互作用，首末原子之间没有耦合。\n\n在这些假设下，对于长度为 $\\,N\\,$ 的链，哈密顿矩阵 $\\,H\\in\\mathbb{R}^{N\\times N}\\,$ 是一个三对角矩阵，其中 $\\,H_{ii}=\\alpha\\,$ 且对于 $\\,i=1,\\dots,N-1\\,$ 有 $\\,H_{i,i+1}=H_{i+1,i}=\\beta\\,$，所有其他元素为零。通过求解本征值问题 $\\,H\\mathbf{c}=E\\mathbf{c}\\,$ 可以获得分子轨道能量。\n\n任务：\n- 编写一个程序，给定 $\\,N\\,$、$\\,\\alpha\\,$（单位为电子伏特）和 $\\,\\beta\\,$（单位为电子伏特），构建如上所述的矩阵 $\\,H\\,$，并返回排序后的本征值列表 $\\,E_1\\le\\cdots\\le E_N\\,$。\n- 所有能量均以电子伏特（eV）表示。\n- 将每个本征值四舍五入到 $\\,6\\,$ 位小数。\n\n测试套件：\n您的程序必须评估以下参数集并汇总结果：\n1. $\\,N=10\\,$, $\\,\\alpha=0.0\\,$ eV, $\\,\\beta=-2.5\\,$ eV。\n2. $\\,N=10\\,$, $\\,\\alpha=-11.0\\,$ eV, $\\,\\beta=-1.5\\,$ eV。\n3. $\\,N=10\\,$, $\\,\\alpha=0.5\\,$ eV, $\\,\\beta=2.5\\,$ eV。\n4. $\\,N=1\\,$, $\\,\\alpha=1.0\\,$ eV, $\\,\\beta=-3.0\\,$ eV。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含所有测试用例的结果，格式为列表的列表。每个内部列表是对应一个测试用例的排序后的本征值列表（按规定四舍五入）。使用方括号和逗号分隔元素，输出中不含任何空格。\n- 最终输出必须是单行，格式为列表的列表，例如，结构类似于“[[result_list_for_case_1],[result_list_for_case_2],...]”，其中每个“result_list_for_case_i”是逗号分隔的浮点数序列。", "solution": "我们在一维链上使用原子轨道线性组合（LCAO）方法，在标准的半经验近似下，构建紧束缚哈密顿量。有限基组下的定态薛定谔方程为 $\\,H\\mathbf{c}=E S\\mathbf{c}\\,$。在当前模型中，假设采用标准正交的最小基组，使得重叠矩阵为 $\\,S=I\\,$。哈密顿矩阵元由两个半经验常数参数化：在位能 $\\,\\alpha\\,$ 和最近邻共振积分 $\\,\\beta\\,$。所有其他耦合均被忽略。对于具有开放边界的 $\\,N\\,$ 个原子的线性链，这会得到\n$$\nH_{ij}=\n\\begin{cases}\n\\alpha,& i=j,\\\\\n\\beta,& |i-j|=1,\\\\\n0,& \\text{otherwise}.\n\\end{cases}\n$$\n这是一个实的、对称的、三对角的矩阵。分子轨道能量 $\\,E\\,$ 是 $\\,H\\,$ 的本征值，通过求解标准本征值问题 $\\,H\\mathbf{c}=E\\mathbf{c}\\,$ 得到。因为 $\\,H\\,$ 是对称的，所有本征值都是实数，并且可以排序为 $\\,E_1\\le E_2\\le \\cdots \\le E_N\\,$。\n\n与模型相关的基本原理推导：\n- 从 LCAO 表示 $\\,\\psi(\\mathbf{r})=\\sum_{i=1}^{N} c_i \\phi_i(\\mathbf{r})\\,$ 开始，其中 $\\,\\phi_i\\,$ 是位于位置 $\\,i\\,$ 上的局域原子轨道。\n- 将其代入薛定谔方程 $\\,\\hat{H}\\psi=E\\psi\\,$，投影到 $\\,\\phi_j\\,$ 上，并假设正交性近似 $\\,\\langle \\phi_i|\\phi_j\\rangle=\\delta_{ij}\\,$，得到 $\\,\\sum_i H_{ji} c_i = E c_j\\,$。\n- 施加半经验参数化：$\\,H_{ii}=\\alpha\\,$（在位轨道能）和 $\\,H_{i,i\\pm 1}=\\beta\\,$（最近邻耦合），所有其他 $\\,H_{ij}=0\\,$，这与开放链（首末位点之间无耦合）相符。\n- 这直接得到了上述的三对角矩阵 $\\,H\\,$，从而在近似范围内完成了从第一性原理出发的构建。\n\n用于验证和洞察的解析结构：\n对于一个开放线性链，本征矢量是驻波 $\\,c_j^{(k)} \\propto \\sin\\!\\left(\\frac{k\\pi j}{N+1}\\right)\\,$，其中 $\\,k=1,2,\\dots,N\\,$。将这些代入由 $\\,H\\mathbf{c}=E\\mathbf{c}\\,$ 得到的紧束缚递推关系中，可以产生众所周知的能谱\n$$\nE_k=\\alpha+2\\beta \\cos\\!\\left(\\frac{k\\pi}{N+1}\\right),\n$$\n其中角度以弧度为单位。尽管我们在算法中不依赖于此闭合形式表达式，但它证实了当 $\\,\\beta\\,$ 仅耦合最近邻时，能谱是实的、有序的，并且关于 $\\,\\alpha\\,$ 对称。\n\n算法设计：\n1. 对每个测试用例，构建对角线元素为 $\\,\\alpha\\,$、第一副对角线元素为 $\\,\\beta\\,$ 的矩阵 $\\,H\\in\\mathbb{R}^{N\\times N}\\,$。\n2. 使用对称本征求解器（例如，通过对角化 $\\,H\\,$）计算所有本征值。\n3. 按升序对本征值进行排序（对称本征求解器通常在构造上会返回已排序的结果）。\n4. 将每个本征值四舍五入到 $\\,6\\,$ 位小数，以生成最终的、可复现的数值输出（单位为电子伏特）。\n5. 汇总所有测试用例的结果，并打印包含列表的列表的单行输出，不含空格。\n\n指定测试套件的计算结果（每个列表按升序排序，单位为电子伏特，四舍五入到 $\\,6\\,$ 位小数）：\n- 情况 $\\,1\\,$ ($\\,N=10\\,$, $\\,\\alpha=0.0\\,$, $\\,\\beta=-2.5\\,$):\n$-4.797465$, $-4.206268$, $-3.274304$, $-2.077075$, $-0.711574$, $0.711574$, $2.077075$, $3.274304$, $4.206268$, $4.797465$。\n- 情况 $\\,2\\,$ ($\\,N=10\\,$, $\\,\\alpha=-11.0\\,$, $\\,\\beta=-1.5\\,$):\n$-13.878479$, $-13.523761$, $-12.964582$, $-12.246245$, $-11.426945$, $-10.573055$, $-9.753755$, $-9.035418$, $-8.476239$, $-8.121521$。\n- 情况 $\\,3\\,$ ($\\,N=10\\,$, $\\,\\alpha=0.5\\,$, $\\,\\beta=2.5\\,$):\n$-4.297465$, $-3.706268$, $-2.774304$, $-1.577075$, $-0.211574$, $1.211574$, $2.577075$, $3.774304$, $4.706268$, $5.297465$。\n- 情况 $\\,4\\,$ ($\\,N=1\\,$, $\\,\\alpha=1.0\\,$, $\\,\\beta=-3.0\\,$):\n$1.0$。\n\n这些值是针对每个参数集对所定义的三对角哈密顿量进行对角化后直接得出的。通过输出一个不含空格的、包含列表的列表的单行字符串，满足了格式化约束。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport json\n\ndef tight_binding_eigenvalues(N: int, alpha: float, beta: float):\n    \"\"\"\n    Construct the N x N tight-binding Hamiltonian with open boundaries:\n    H_ii = alpha, H_{i,i+1} = H_{i+1,i} = beta, others = 0.\n    Return sorted eigenvalues.\n    \"\"\"\n    # Construct Hamiltonian\n    H = np.zeros((N, N), dtype=float)\n    np.fill_diagonal(H, alpha)\n    if N >= 2:\n        # Fill first off-diagonals with beta\n        for i in range(N - 1):\n            H[i, i + 1] = beta\n            H[i + 1, i] = beta\n    # Compute eigenvalues (symmetric)\n    evals = np.linalg.eigvalsh(H)\n    return np.sort(evals)\n\ndef round_eigenvalues(evals, ndigits=6):\n    rounded = []\n    for x in evals:\n        r = round(float(x), ndigits)\n        # Normalize -0.0 to 0.0\n        if r == 0.0:\n            r = 0.0\n        rounded.append(r)\n    return rounded\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (N, alpha [eV], beta [eV])\n    test_cases = [\n        (10, 0.0, -2.5),\n        (10, -11.0, -1.5),\n        (10, 0.5, 2.5),\n        (1, 1.0, -3.0),\n    ]\n\n    results = []\n    for N, alpha, beta in test_cases:\n        evals = tight_binding_eigenvalues(N, alpha, beta)\n        rounded = round_eigenvalues(evals, ndigits=6)\n        results.append(rounded)\n\n    # Final print statement in the exact required format: a single line,\n    # list of lists, no spaces.\n    print(json.dumps(results, separators=(',',':')))\n\nsolve()\n```", "id": "2462030"}, {"introduction": "这是一个综合性的实践，它将带你超越静态哈密顿量的概念，深入到许多量子化学方法的核心——自洽场 (Self-Consistent Field, SCF) 迭代过程。这个练习要求你实现一个简化的MNDO-like框架下的SCF循环，展示福克矩阵和电子密度是如何相互依赖并迭代更新直至收敛的。完成这项任务将使你对半经验方法的计算引擎获得深刻的见解 [@problem_id:2462064]。", "problem": "要求您在一个类 Modified Neglect of Diatomic Overlap (MNDO) 框架中，为一个双原子分子实现一个最小化的自洽场 (Self-Consistent Field, SCF) 循环。其目的是要阐明单中心价轨道能量 $U_{ss}$ 和双中心共振参数 $\\beta_s$ 等半经验参数如何进入 Fock 矩阵的构建过程。您的程序必须计算几个双原子测试用例的总能量，并将结果输出在单行中。\n\n从以下基本基础和经过充分测试的建模选择开始：\n\n- 在正交最小基组中，Hartree–Fock 电子能量为\n$$\nE_{\\mathrm{el}} = \\sum_{\\mu,\\nu} P_{\\mu\\nu} H_{\\nu\\mu} + \\frac{1}{2}\\sum_{A}\\sum_{B} \\Delta q_A \\, \\Delta q_B \\, \\gamma_{AB}(R_{AB}),\n$$\n其中 $P$ 是单电子密度矩阵，$H$ 是单电子核心哈密顿量，$\\Delta q_A$ 是原子 $A$ 上的净电荷，$\\gamma_{AB}(R_{AB})$ 是一个有效的双中心电子-电子排斥积分，$R_{AB}$ 是原子 $A$ 和 $B$ 之间的核间距。总能量为\n$$\nE_{\\mathrm{tot}} = E_{\\mathrm{el}} + E_{\\mathrm{nn}},\n$$\n核排斥能为\n$$\nE_{\\mathrm{nn}} = k \\sum_{A<B} \\frac{Z_A Z_B}{R_{AB}}.\n$$\n\n- 使用双原子微分重叠忽略 (Neglect of Diatomic Differential Overlap, NDDO) 近似和正交基组（每个原子一个 $s$ 型价轨道），因此重叠矩阵是单位矩阵。原子 $A$ 上的 Mulliken 总电子布居为\n$$\nQ_A = \\sum_{\\mu \\in A} P_{\\mu\\mu},\n$$\n净电荷为\n$$\n\\Delta q_A = Z_A - Q_A,\n$$\n其中 $Z_A$ 是原子 $A$ 的价电子数。\n\n- 使用半经验参数 $U_{ss}$（价态电离势的代理）和 $\\beta_s$（共振积分的代理）来对单电子核心哈密顿量建模：\n  - 对于原子 $A$ 上的基函数 $\\mu$，对角元为\n  $$\n  H_{\\mu\\mu} = U_{ss}(A).\n  $$\n  - 对于每个都拥有一个 $s$ 轨道的不同原子 $A \\neq B$，非对角元通过一个距离衰减的共振积分来建模\n  $$\n  H_{\\mu\\nu} = \\beta_{s}^{\\mathrm{geom}} \\cdot f(R_{AB}), \\quad f(R) = e^{-\\alpha R},\n  $$\n  其中 $\\beta_{s}^{\\mathrm{geom}}$ 是原子 $A$ 和 $B$ 上 $\\beta_s$ 参数的几何平均值，$\\alpha$ 是一个单位为长度倒数的正常数阻尼参数。\n\n- 使用一个类 Ohno 的软化库仑相互作用来处理双中心电子-电子排斥\n$$\n\\gamma_{AB}(R) = \\frac{k}{\\sqrt{R^2 + \\delta_{AB}^2}},\n$$\n其中 $k = 14.399645478$ 的单位是电子伏特-埃（即库仑常数 $e^2/(4\\pi\\varepsilon_0)$ 以电子伏特-埃表示），并且\n$$\n\\delta_{AB} = \\frac{k}{\\sqrt{\\gamma_{AA}\\gamma_{BB}}},\n$$\n其中 $\\gamma_{AA}$ 是原子 $A$ 的在位 (on-site) 电子-电子排斥参数（单位为电子伏特），$\\gamma_{BB}$ 是原子 $B$ 的相应参数。\n\n- Fock 矩阵 $F$ 必须通过计算电子能量相对于密度矩阵元的导数得到，这要与上述定义和 NDDO 近似保持一致，然后迭代至自洽：\n  - 初始化一个合理的密度矩阵 $P^{(0)}$（例如，零矩阵）。\n  - 在每次迭代 $n$ 中，根据 $H$ 和当前的电荷 $\\{\\Delta q_A^{(n)}\\}$ 构建 $F^{(n)}$。\n  - 对角化 $F^{(n)}$ 以获得分子轨道，并用指定数量的电子占据能量最低的轨道（适用时，闭壳层占据因子为 $2$）。\n  - 根据已占据的轨道形成一个新的密度矩阵 $P^{(n+1)}$。\n  - 如果需要，将 $P^{(n+1)}$ 与 $P^{(n)}$混合以帮助收敛。\n  - 当 $P$ 的均方根变化降至一个容差以下时，即为收敛。\n\n- 不涉及角度。距离必须以埃（angstrom）处理，$R$ 以 $\\mathrm{\\AA}$ 为单位，所有能量必须以电子伏特（eV）报告。最终能量表示到小数点后六位。\n\n将 SCF 过程实现为一个完整、可运行的程序，为以下测试套件产生总能量 $E_{\\mathrm{tot}}$。对于所有用例，密度矩阵均方根变化的容差使用 $\\tau = 10^{-10}$，并使用混合因子 $m = 0.5$ 的简单线性混合方法。\n\n测试套件（每个用例是一个参数元组）：\n1. 用例 A（理想情况，中性双原子分子）：$R = 0.74\\,\\mathrm{\\AA}$, $Z_A = 1$, $Z_B = 1$, $U_{ss}(A) = -11.906276\\,\\mathrm{eV}$, $U_{ss}(B) = -11.906276\\,\\mathrm{eV}$, $\\beta_s(A) = -6.989064\\,\\mathrm{eV}$, $\\beta_s(B) = -6.989064\\,\\mathrm{eV}$, $\\gamma_{AA} = 12.848\\,\\mathrm{eV}$, $\\gamma_{BB} = 12.848\\,\\mathrm{eV}$, $n_e = 2$, $\\alpha = 1.75\\,\\mathrm{\\AA}^{-1}$。\n2. 用例 B（单电子体系）：$R = 2.00\\,\\mathrm{\\AA}$, 原子参数与用例 A 相同，但 $n_e = 1$, 且 $\\alpha = 1.75\\,\\mathrm{\\AA}^{-1}$。\n3. 用例 C（解离极限趋势）：$R = 5.00\\,\\mathrm{\\AA}$, 原子参数与用例 A 相同, $n_e = 2$, $\\alpha = 1.75\\,\\mathrm{\\AA}^{-1}$。\n4. 用例 D（短键长边界情况）：$R = 0.30\\,\\mathrm{\\AA}$, 原子参数与用例 A 相同, $n_e = 2$, $\\alpha = 1.75\\,\\mathrm{\\AA}^{-1}$。\n\n您的程序应：\n- 如上所述，从给定的第一性原理出发，构建并迭代 SCF。\n- 对每个用例，计算收敛后的总能量 $E_{\\mathrm{tot}}$（以电子伏特为单位）。\n- 生成单行输出，其中包含按 A、B、C、D 顺序排列的四个用例的总能量，以逗号分隔，并用方括号括起来。例如，您的程序必须打印形如\n\"[E_A,E_B,E_C,E_D]\"\n的行，其中每个 $E$ 显示到小数点后六位（例如，\"$-20.123456$\")。\n\n注意：本题旨在测试您能否推导出半经验参数 $U_{ss}$ 和 $\\beta_s$ 在 SCF 循环中的使用位置，以及它们如何影响核心哈密顿量进而影响 Fock 矩阵，同时使用一个科学上合理的类 MNDO 模型。不需要用户输入；请将测试套件硬编码在您的程序中。", "solution": "该问题要求在一个指定的半经验量子化学模型（类似于 Modified Neglect of Diatomic Overlap, MNDO 框架）内，为一个双原子分子实现一个自洽场 (Self-Consistent Field, SCF) 过程。解决方案涉及从给定的能量表达式中推导出适当的 Fock 矩阵，然后实现迭代式 SCF 算法来计算几个测试用例的总能量。\n\n首先，我们形式化描述一个由原子 $A$ 和 $B$ 组成的双原子分子模型，每个原子上有一个 $s$ 型价轨道，分别标记为原子 $A$ 上的 $\\mu=1$ 和原子 $B$ 上的 $\\nu=2$。基组假定为正交的，因此重叠矩阵 $S$ 是单位矩阵，$S_{\\mu\\nu} = \\delta_{\\mu\\nu}$。\n\n总能量 $E_{\\mathrm{tot}}$ 是电子能量 $E_{\\mathrm{el}}$ 和核-核排斥能 $E_{\\mathrm{nn}}$ 的和：\n$$ E_{\\mathrm{tot}} = E_{\\mathrm{el}} + E_{\\mathrm{nn}} $$\n对于距离为 $R_{AB}$ 的双原子分子，核排斥能由下式给出：\n$$ E_{\\mathrm{nn}} = k \\frac{Z_A Z_B}{R_{AB}} $$\n其中 $Z_A$ 和 $Z_B$ 分别是原子 $A$ 和 $B$ 上的价电子数，$k = 14.399645478 \\, \\mathrm{eV \\cdot \\AA}$ 是库仑常数。\n\n电子能量 $E_{\\mathrm{el}}$ 定义为：\n$$ E_{\\mathrm{el}} = \\sum_{\\mu,\\nu} P_{\\mu\\nu} H_{\\nu\\mu} + \\frac{1}{2}\\sum_{C,D \\in \\{A,B\\}} \\Delta q_C \\Delta q_D \\gamma_{CD} $$\n这里，$P$ 是密度矩阵，$H$ 是核心哈密顿量，$\\Delta q_C$ 是原子 $C$ 上的净电荷，定义为 $\\Delta q_C = Z_C - Q_C$，其中 $Q_C = \\sum_{\\mu \\in C} P_{\\mu\\mu}$ 是 Mulliken 电子布居。对于我们的双轨道系统，$Q_A = P_{11}$ 且 $Q_B = P_{22}$。\n\n核心哈密顿矩阵元 $H_{\\mu\\nu}$ 参数化如下：\n- 对角元：$H_{11} = U_{ss}(A)$ 和 $H_{22} = U_{ss}(B)$，其中 $U_{ss}$ 是单中心价轨道能量。\n- 非对角元：$H_{12} = H_{21} = \\beta_{s}^{\\mathrm{geom}} e^{-\\alpha R_{AB}}$，其中 $\\beta_{s}^{\\mathrm{geom}} = -\\sqrt{|\\beta_s(A)||\\beta_s(B)|}$ 是共振参数的几何平均值，$\\alpha$ 是一个阻尼常数。\n\n对于 $C \\neq D$ 的情况，双中心电子排斥积分 $\\gamma_{CD}$ 由类 Ohno 公式给出：\n$$ \\gamma_{AB} = \\frac{k}{\\sqrt{R_{AB}^2 + \\delta_{AB}^2}} \\quad \\text{with} \\quad \\delta_{AB} = \\frac{k}{\\sqrt{\\gamma_{AA}\\gamma_{BB}}} $$\n单中心排斥积分 $\\gamma_{AA}$ 和 $\\gamma_{BB}$ 是先验参数。\n\n解决方案的核心部分是通过对电子能量 $E_{\\mathrm{el}}$ 关于密度矩阵元 $P_{\\nu\\mu}$ 求导来推导 Fock 矩阵 $F$，对于正交基组，其形式为 $F_{\\mu\\nu} = \\partial E_{\\mathrm{el}} / \\partial P_{\\nu\\mu}$。\n$E_{\\mathrm{el}}$ 的单电子部分，$\\sum_{\\rho,\\sigma} P_{\\rho\\sigma} H_{\\sigma\\rho}$，对 $F_{\\mu\\nu}$ 的贡献是 $H_{\\mu\\nu}$。\n双电子部分，$E_{2e} = \\frac{1}{2}\\sum_{C,D} \\Delta q_C \\Delta q_D \\gamma_{CD}$，仅依赖于密度矩阵的对角元 $P_{11}$ 和 $P_{22}$。\n$$ E_{2e} = \\frac{1}{2} \\left[ (Z_A - P_{11})^2 \\gamma_{AA} + (Z_B - P_{22})^2 \\gamma_{BB} + 2(Z_A - P_{11})(Z_B - P_{22})\\gamma_{AB} \\right] $$\n导数为：\n- 对于非对角元 ($\\mu \\ne \\nu$): $\\partial E_{2e} / \\partial P_{21} = 0$。因此，$F_{12} = H_{12}$。\n- 对于对角元 ($\\mu = \\nu$):\n$$ \\frac{\\partial E_{2e}}{\\partial P_{11}} = \\frac{1}{2} \\left[ 2(Z_A - P_{11})(-1)\\gamma_{AA} + 2(-1)(Z_B - P_{22})\\gamma_{AB} \\right] = -\\Delta q_A \\gamma_{AA} - \\Delta q_B \\gamma_{AB} = -\\sum_{C \\in \\{A,B\\}} \\Delta q_C \\gamma_{AC} $$\n$$ \\frac{\\partial E_{2e}}{\\partial P_{22}} = -\\Delta q_A \\gamma_{AB} - \\Delta q_B \\gamma_{BB} = -\\sum_{C \\in \\{A,B\\}} \\Delta q_C \\gamma_{BC} $$\n\n因此，Fock 矩阵元为：\n$$ F_{11} = H_{11} - (\\Delta q_A \\gamma_{AA} + \\Delta q_B \\gamma_{AB}) $$\n$$ F_{22} = H_{22} - (\\Delta q_A \\gamma_{AB} + \\Delta q_B \\gamma_{BB}) $$\n$$ F_{12} = F_{21} = H_{12} $$\n这些表达式定义了参数 $U_{ss}$ 和 $\\beta_s$（通过 $H$）如何影响 Fock 矩阵。\n\nSCF 算法流程如下：\n1.  **初始化**：给定分子几何构型和原子参数，计算常数矩阵 $H$ 和排斥积分 $\\gamma_{AA}, \\gamma_{BB}, \\gamma_{AB}$。初始化密度矩阵 $P^{(0)}$，例如，作为零矩阵。\n2.  **迭代**：对于迭代 $n=0, 1, 2, \\dots$：\n    a. 计算布居数 $Q_A^{(n)} = P_{11}^{(n)}, Q_B^{(n)} = P_{22}^{(n)}$ 和净电荷 $\\Delta q_A^{(n)} = Z_A - Q_A^{(n)}, \\Delta q_B^{(n)} = Z_B - Q_B^{(n)}$。\n    b. 使用电荷 $\\Delta q^{(n)}$ 和推导出的公式构建 Fock 矩阵 $F^{(n)}$。\n    c. 求解久期方程 $F^{(n)} C^{(n)} = C^{(n)} \\epsilon^{(n)}$，这对于正交基组是一个标准的本征值问题。这将产生分子轨道 (MO) 能量 $\\epsilon_i^{(n)}$ 和 MO 系数向量 $C_i^{(n)}$。\n    d. 通过用总电子数 $n_e$ 填充分子轨道 (MO) 来形成新的密度矩阵 $P_{\\text{new}}^{(n)}$。对于 $n_e$ 个电子，密度矩阵为 $P_{\\text{new}}^{(n)} = \\sum_{i}^{\\text{occupied}} n_i C_i^{(n)} (C_i^{(n)})^\\top$，其中 $n_i$ 是 MO $i$ 的占据数。对于一个 $n_e=2$ 的闭壳层系统，能量最低的轨道被 2 个电子占据 ($n_1=2, n_2=0$)。对于一个 $n_e=1$ 的开壳层系统，它被 1 个电子占据 ($n_1=1, n_2=0$)。\n    e. 为了帮助收敛，混合新旧密度矩阵：$P^{(n+1)} = (1-m)P^{(n)} + m P_{\\text{new}}^{(n)}$，混合因子 $m=0.5$。\n3.  **收敛**：当连续密度矩阵之间的均方根差 (RMSD) 小于容差 $\\tau=10^{-10}$ 时，循环终止：$\\sqrt{\\frac{1}{4}\\sum_{\\mu,\\nu} (P_{\\mu\\nu}^{(n+1)} - P_{\\mu\\nu}^{(n)})^2} < \\tau$。\n4.  **能量计算**：一旦收敛到最终的密度矩阵 $P$，就使用初始的能量表达式计算总能量：\n    $$ E_{\\mathrm{el}} = P_{11}H_{11} + P_{22}H_{22} + 2P_{12}H_{12} + \\frac{1}{2}(\\Delta q_A^2 \\gamma_{AA} + \\Delta q_B^2 \\gamma_{BB} + 2\\Delta q_A \\Delta q_B \\gamma_{AB}) $$\n    $$ E_{\\mathrm{tot}} = E_{\\mathrm{el}} + k \\frac{Z_A Z_B}{R_{AB}} $$\n\n将此过程应用于每个测试用例，以提供收敛后的总能量。对于同核分子的情况，对称性决定了 SCF 将收敛到一个状态，其中电荷要么为零（对于中性分子），要么均匀分布（对于离子）。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the semi-empirical SCF problem for the given test suite.\n    \"\"\"\n\n    k_coulomb = 14.399645478  # eV * Angstrom\n\n    # Test suite: (R, ZA, ZB, U_A, U_B, beta_A, beta_B, gamma_AA, gamma_BB, n_e, alpha)\n    test_cases = [\n        # Case A: Happy path, neutral diatomic\n        (0.74, 1.0, 1.0, -11.906276, -11.906276, -6.989064, -6.989064, 12.848, 12.848, 2, 1.75),\n        # Case B: One-electron system\n        (2.00, 1.0, 1.0, -11.906276, -11.906276, -6.989064, -6.989064, 12.848, 12.848, 1, 1.75),\n        # Case C: Dissociation limit trend\n        (5.00, 1.0, 1.0, -11.906276, -11.906276, -6.989064, -6.989064, 12.848, 12.848, 2, 1.75),\n        # Case D: Short bond edge case\n        (0.30, 1.0, 1.0, -11.906276, -11.906276, -6.989064, -6.989064, 12.848, 12.848, 2, 1.75),\n    ]\n    \n    results = []\n    for case in test_cases:\n        energy = run_scf_calculation(case, k_coulomb)\n        results.append(f\"{energy:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef run_scf_calculation(case_params, k):\n    \"\"\"\n    Performs the SCF calculation for a single test case.\n    \"\"\"\n    R, Z_A, Z_B, U_A, U_B, beta_A, beta_B, gamma_AA, gamma_BB, n_e, alpha = case_params\n    \n    # SCF parameters\n    tolerance = 1e-10\n    mixing_factor = 0.5\n    max_iterations = 200\n\n    # --- 1. Initialization ---\n    \n    # Core Hamiltonian (H)\n    H = np.zeros((2, 2))\n    H[0, 0] = U_A\n    H[1, 1] = U_B\n    # Take negative of sqrt of product of magnitudes for beta_geom to preserve sign\n    beta_geom = -np.sqrt(np.abs(beta_A) * np.abs(beta_B))\n    H[0, 1] = H[1, 0] = beta_geom * np.exp(-alpha * R)\n\n    # Electron repulsion integrals (gamma)\n    delta_ab = k / np.sqrt(gamma_AA * gamma_BB)\n    gamma_AB = k / np.sqrt(R**2 + delta_ab**2)\n\n    # Initial density matrix\n    P = np.zeros((2, 2))\n\n    # --- 2. SCF Iteration Loop ---\n    \n    for i in range(max_iterations):\n        P_old = P.copy()\n\n        # a. Calculate charges\n        Q_A = P[0, 0]\n        Q_B = P[1, 1]\n        dq_A = Z_A - Q_A\n        dq_B = Z_B - Q_B\n\n        # b. Build Fock matrix (F)\n        F = np.zeros((2, 2))\n        F[0, 0] = H[0, 0] - (dq_A * gamma_AA + dq_B * gamma_AB)\n        F[1, 1] = H[1, 1] - (dq_A * gamma_AB + dq_B * gamma_BB)\n        F[0, 1] = F[1, 0] = H[0, 1]\n\n        # c. Solve secular equation FC = Ce\n        eigvals, eigvecs = np.linalg.eigh(F)\n        \n        # d. Form new density matrix from occupied orbitals\n        P_new = np.zeros((2, 2))\n        # Find the lowest energy orbital (ground state)\n        idx_gs = np.argmin(eigvals)\n        C_gs = eigvecs[:, idx_gs]\n        \n        # Occupation depends on n_e\n        if n_e == 2:\n            # Closed-shell: 2 electrons in the ground state orbital\n            P_new = 2.0 * np.outer(C_gs, C_gs)\n        elif n_e == 1:\n            # Open-shell: 1 electron in the ground state orbital\n            P_new = 1.0 * np.outer(C_gs, C_gs)\n        else: # Unspecified, but one could add more cases\n             P_new = np.zeros((2, 2))\n\n        # e. Mix density matrices\n        P = (1.0 - mixing_factor) * P_old + mixing_factor * P_new\n\n        # f. Check for convergence\n        rmsd = np.sqrt(np.sum((P - P_old)**2) / 4.0)\n        if rmsd  tolerance:\n            break\n\n    # --- 3. Energy Calculation ---\n    \n    # Final charges from converged density P\n    Q_A_conv = P[0, 0]\n    Q_B_conv = P[1, 1]\n    dq_A_conv = Z_A - Q_A_conv\n    dq_B_conv = Z_B - Q_B_conv\n\n    # Electronic energy\n    E_el = np.sum(P * H)  # equivalent to Tr(PH)\n    E_coulomb = 0.5 * (dq_A_conv**2 * gamma_AA + dq_B_conv**2 * gamma_BB + 2 * dq_A_conv * dq_B_conv * gamma_AB)\n    E_el += E_coulomb\n\n    # Nuclear repulsion energy\n    E_nn = k * (Z_A * Z_B) / R if R > 0 else 0\n\n    # Total energy\n    E_total = E_el + E_nn\n\n    return E_total\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2462064"}]}