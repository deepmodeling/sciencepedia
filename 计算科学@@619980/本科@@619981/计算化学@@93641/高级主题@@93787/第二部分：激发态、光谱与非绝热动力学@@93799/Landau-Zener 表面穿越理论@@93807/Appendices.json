{"hands_on_practices": [{"introduction": "朗道-曾纳公式为单次穿越非绝热交叉区域提供了简洁的概率描述。然而，在许多真实化学情境中，例如分子振动，系统可能会周期性地多次经过交叉点。此练习要求您将单次穿越的概率扩展到包含两次独立穿越的完整振荡周期，这对于理解振动预解离等现象至关重要。通过这个练习，您将加强对概率论和统计独立性假设在量子动力学中应用的理解 [@problem_id:2457019]。", "problem": "一个一维核自由度在两个耦合的电子态上运动，这两个电子态由两个在坐标 $x_{c}$ 处线性交叉的透热势能面描述。在 $x_{c}$ 附近，透热能量差是关于 $x$ 的线性函数，其斜率大小为 $|\\Delta F|$，并且透热电子耦合为常数 $V$。一条经典的核轨迹被限制在一个势阱中，这使其在每次振荡中以相同的速度大小 $v$ 两次通过交叉点 $x_{c}$。假设：\n- 运动足够局域，使得每次通过时线性交叉近似都成立，\n- 对于每次通过，耦合 $V$ 和速度 $v$ 在整个交叉区域内保持不变，\n- 两次通过之间发生完全退相干，因此两次通过在统计上是独立的，\n- 系统在周期开始时处于较低的绝热电子态上，且远离交叉点。\n\n使用 Landau-Zener 理论处理单次通过线性避免交叉的情况，请表达在完成一次完整振荡（即两次通过 $x_{c}$）后，系统处于较高绝热电子态的概率（以小数而非百分比形式）。你的最终答案必须是一个以 $V$、$v$、$|\\Delta F|$ 和 $\\hbar$ 表示的单一闭合形式解析表达式。不要对你的答案进行四舍五入。", "solution": "所述问题在科学上是合理的、良定的、客观的，并包含足够的信息以得到唯一解。它是 Landau-Zener 理论在具有退相干的两次通过系统上的一个标准应用。我们将继续进行推导。\n\n这个问题的核心是 Landau-Zener 公式，它给出了在单次通过线性曲线交叉期间发生透热跃迁的概率。在此背景下，透热跃迁意味着系统保持在其初始的透热势能曲线上。这对应于在绝热势能面之间的一次“跳跃”。这种跃迁的概率，我们记为 $P_{hop}$，由下式给出：\n$$\nP_{hop} = \\exp\\left(-\\frac{2\\pi V^2}{\\hbar v \\left| \\frac{d(E_1 - E_2)}{dx} \\right| }\\right)\n$$\n此处，$V$ 是透热耦合，$v$ 是通过交叉点时的核速度，$\\hbar$ 是约化普朗克常数，而 $\\left| \\frac{d(E_1 - E_2)}{dx} \\right|$ 是在交叉点处透热能量差的斜率大小。问题中给出的此斜率大小为 $|\\Delta F|$。因此，单次通过时从一个绝热态跳跃到另一个绝热态的概率为：\n$$\np = P_{hop} = \\exp\\left(-\\frac{2\\pi V^2}{\\hbar v |\\Delta F|}\\right)\n$$\n相应地，在单次通过期间发生绝热跃迁（即保持在同一绝热势能面上）的概率是：\n$$\nP_{stay} = 1 - p = 1 - \\exp\\left(-\\frac{2\\pi V^2}{\\hbar v |\\Delta F|}\\right)\n$$\n问题指明系统从较低的绝热态开始。然后它会两次通过交叉区域。两次通过之间完全退相干的假设意味着这两个事件在统计上是独立的。我们可以通过追踪这个两步过程中每个绝热态上的布居数来计算最终态的概率。\n\n设 $P_L(n)$ 和 $P_U(n)$ 分别为经过 $n$ 次通过后，系统处于较低和较高绝热态的概率。\n初始条件是系统处于较低的绝热态：\n$P_L(0) = 1$\n$P_U(0) = 0$\n\n第一次通过后（$n=1$）：\n系统可以以概率 $p$ 跃迁到较高态，或以概率 $1-p$ 保持在较低态。\n处于较高态的概率为：\n$P_U(1) = P_L(0) \\cdot p + P_U(0) \\cdot (1-p) = (1)(p) + (0)(1-p) = p$\n处于较低态的概率为：\n$P_L(1) = P_L(0) \\cdot (1-p) + P_U(0) \\cdot p = (1)(1-p) + (0)(p) = 1-p$\n作为检验，总概率为 $P_U(1) + P_L(1) = p + (1-p) = 1$。\n\n第二次通过后（$n=2$）：\n系统以布居数 $P_L(1)$ 和 $P_U(1)$ 开始这次通过。我们希望求得最终处于较高态的概率 $P_U(2)$。这可以通过两种互斥的方式实现：\n1. 系统在第一次通过后处于较低态（概率为 $P_L(1)$），然后在第二次通过期间跳跃到较高态（概率为 $p$）。这条路径的概率为 $P_L(1) \\cdot p$。\n2. 系统在第一次通过后处于较高态（概率为 $P_U(1)$），然后在第二次通过期间保持在较高态（概率为 $1-p$）。这条路径的概率为 $P_U(1) \\cdot (1-p)$。\n\n两次通过后处于较高态的总概率是这两条路径概率的和：\n$P_U(2) = (P_L(1) \\cdot p) + (P_U(1) \\cdot (1-p))$\n代入 $P_L(1)$ 和 $P_U(1)$ 的表达式：\n$P_U(2) = ((1-p) \\cdot p) + (p \\cdot (1-p))$\n$P_U(2) = p(1-p) + p(1-p) = 2p(1-p)$\n\n现在，我们代入单次通过跳跃概率 $p$ 的完整表达式：\n$$\nP_U(2) = 2 \\exp\\left(-\\frac{2\\pi V^2}{\\hbar v |\\Delta F|}\\right) \\left[ 1 - \\exp\\left(-\\frac{2\\pi V^2}{\\hbar v |\\Delta F|}\\right) \\right]\n$$\n这就是在经过一次包含两次独立通过的完整振荡后，系统处于较高绝热态的最终解析表达式。", "answer": "$$\n\\boxed{2 \\exp\\left(-\\frac{2\\pi V^2}{\\hbar v |\\Delta F|}\\right) \\left(1 - \\exp\\left(-\\frac{2\\pi V^2}{\\hbar v |\\Delta F|}\\right)\\right)}\n$$", "id": "2457019"}, {"introduction": "非绝热跃迁的概率并非一成不变，而是会受到外部环境的显著影响，例如外加电场。这个动手实践将引导您通过编程来模拟一个电荷转移反应，其中外电场会改变透热势能面，从而移动交叉点位置并调节能量间隙。通过这个练习，您将具体地看到理论参数（如耦合 $V_{12}$ 和斜率差）如何与可控的实验条件（如电场强度 $F$）联系起来，并最终影响反应结果 [@problem_id:2457015]。", "problem": "考虑一个一维电荷转移系统，该系统由两个沿着反应坐标 $R$ 相互作用的透热电子态建模。全文使用原子单位 (a.u.)。透热势被视为 $R$ 的线性函数，具有相反的斜率和能量偏移，并且外部均匀电场 $F$ 通过恒定的偶极矩差来改变它们的相对能量。设透热能量差为\n$$\n\\Delta E(R;F) = V_1(R;F) - V_2(R;F) = 2 a \\left(R - R_0\\right) + \\Delta_0 - \\Delta \\mu\\, F,\n$$\n其中 $a$ 是一个常数斜率参数，$R_0$ 是一个参考坐标，$\\Delta_0$ 是在 $R=R_0$ 处的零场能量偏移，$\\Delta \\mu$ 是与电场 $F$ 耦合的恒定透热偶极矩差。\n\n透热态通过一个非对角电子耦合 $V_{12}(F)$ 相互耦合，该耦合依赖于电场，具体如下\n$$\nV_{12}(F) = V_{12}^0 \\exp\\!\\left(-\\beta F^2\\right),\n$$\n其中 $V_{12}^0$ 和 $\\beta$ 是正常数。\n\n假设 Landau–Zener 模型适用于沿着 $R$ 以恒定正速度 $v$ 穿过交叉区域的经典轨迹。在此模型中，交叉坐标 $R_c$ 满足 $V_1(R_c;F) = V_2(R_c;F)$，在 $R_c$ 处的最小绝热能隙等于 $2 \\lvert V_{12}(F)\\rvert$，穿过避让交叉时改变绝热面的非绝热跃迁概率由标准的 Landau–Zener 结果给出，并以通过透热能量差的局部扫描速率表示。完全在原子单位 (a.u.) 中进行计算，其中 $\\hbar = 1$。\n\n使用以下参数值，均为原子单位：\n- $a = 0.2$,\n- $R_0 = 3.0$,\n- $\\Delta_0 = 0.1$,\n- $\\Delta \\mu = 2.0$,\n- $V_{12}^0 = 0.05$,\n- $\\beta = 0.5$.\n\n您的任务是编写一个完整的、可运行的程序，对于下面列出的每个测试用例 $(F, v)$，计算：\n- 以玻尔为单位的交叉坐标 $R_c$，四舍五入到 $6$ 位小数，\n- 以哈特里为单位的避让交叉处的最小绝热能隙 $2 \\lvert V_{12}(F)\\rvert$，四舍五入到 $6$ 位小数，\n- Landau–Zener 非绝热跃迁概率（改变绝热面），表示为小数并四舍五入到 $6$ 位小数。\n\n测试套件（每对为 $(F,v)$，其中 $F$ 的单位是原子单位电场，$v$ 的单位是玻尔/原子单位时间）：\n- $(0.0, 0.02)$,\n- $(0.5, 0.02)$,\n- $(-0.5, 0.02)$,\n- $(2.0, 0.02)$,\n- $(0.5, 0.2)$,\n- $(4.0, 0.02)$.\n\n最终输出格式：您的程序应生成单行输出，其中包含所有测试用例的结果，形式为方括号内以逗号分隔的列表。其中每个元素是针对一个测试用例的列表 $[R_c,\\; \\text{gap},\\; P_{\\mathrm{NA}}]$。例如，输出必须看起来像\n$[[r_1,g_1,p_1],[r_2,g_2,p_2],\\ldots]$\n所有数值条目均按规定四舍五入并以上述单位表示。", "solution": "对问题陈述进行验证。\n\n### 步骤 1：提取给定信息\n\n所提供的信息如下：\n- 透热能量差由以下函数给出：$\\Delta E(R;F) = V_1(R;F) - V_2(R;F) = 2 a \\left(R - R_0\\right) + \\Delta_0 - \\Delta \\mu\\, F$。\n- 依赖于场的透热耦合为：$V_{12}(F) = V_{12}^0 \\exp\\!\\left(-\\beta F^2\\right)$。\n- 系统沿着坐标 $R$ 以恒定正速度 $v$ 遵循经典轨迹。\n- 交叉坐标 $R_c$ 由条件 $V_1(R_c;F) = V_2(R_c;F)$ 定义。\n- 交叉点的最小绝热能隙为 $2 \\lvert V_{12}(F)\\rvert$。\n- 非绝热跃迁概率 $P_{\\mathrm{NA}}$ 由 Landau-Zener 公式确定。\n- 使用原子单位，其中普朗克常数 $\\hbar = 1$。\n- 原子单位下的参数值：\n  - $a = 0.2$\n  - $R_0 = 3.0$\n  - $\\Delta_0 = 0.1$\n  - $\\Delta \\mu = 2.0$\n  - $V_{12}^0 = 0.05$\n  - $\\beta = 0.5$\n- 测试用例以 $(F, v)$ 对的形式提供：$(0.0, 0.02)$, $(0.5, 0.02)$, $(-0.5, 0.02)$, $(2.0, 0.02)$, $(0.5, 0.2)$, $(4.0, 0.02)$。\n\n### 步骤 2：使用提取的信息进行验证\n\n根据既定标准对问题进行评估：\n- **科学依据**：该问题描述了一个用 Landau-Zener 理论处理的典型的双态模型系统。这是理论和计算化学中用于描述势能面交叉处非绝热跃迁的一个基本且广泛应用的概念。透热势和耦合的形式是此背景下的标准表示。该模型在科学上是合理的。\n- **适定性**：该问题提供了一整套方程和参数，足以计算每个给定测试用例所需的三个量（$R_c$、能隙、$P_{\\mathrm{NA}}$）。存在唯一解，并可通过直接计算确定。\n- **客观性**：该问题使用精确、无歧义的数学和物理术语进行表述。它不含主观或基于意见的陈述。\n- **完整性与一致性**：所有需要的常数和参数的数值都已明确给出。原子单位的使用已被声明并且是一致的。没有内部矛盾。\n- **可行性与合理性**：该问题在计算上是直接的。所提供的参数对于分子模型系统而言在物理上是合理的。\n\n### 步骤 3：结论与行动\n\n该问题有效。这是一个将 Landau-Zener 理论应用于一个具体的、可解析求解的模型的明确练习。将提供完整的解决方案。\n\n### 基于原理的求解\n\n该解决方案需要为每个测试用例 $(F, v)$ 计算三个量：交叉坐标 $R_c$、在 $R_c$ 处的最小绝热能隙以及非绝热跃迁概率 $P_{\\mathrm{NA}}$。\n\n**1. 交叉坐标 $R_c$ 的计算**\n\n交叉坐标 $R_c$ 是透热势能相等的点，即 $V_1(R_c;F) = V_2(R_c;F)$。这等效于它们的差为零的条件：$\\Delta E(R_c;F) = 0$。\n使用给定的透热能量差表达式：\n$$\n\\Delta E(R;F) = 2 a \\left(R - R_0\\right) + \\Delta_0 - \\Delta \\mu\\, F\n$$\n我们在 $R = R_c$ 处将此表达式设为零：\n$$\n2 a \\left(R_c - R_0\\right) + \\Delta_0 - \\Delta \\mu\\, F = 0\n$$\n求解 $R_c$ 得到以下公式：\n$$\n2 a (R_c - R_0) = \\Delta \\mu F - \\Delta_0\n$$\n$$\nR_c - R_0 = \\frac{\\Delta \\mu F - \\Delta_0}{2a}\n$$\n$$\nR_c(F) = R_0 + \\frac{\\Delta \\mu F - \\Delta_0}{2a}\n$$\n该公式允许对任何给定的电场强度 $F$直接计算交叉坐标。\n\n**2. 最小绝热能隙的计算**\n\n问题陈述指明，在避让交叉处的最小绝热能隙等于 $2 \\lvert V_{12}(F)\\rvert$。依赖于场的透热耦合 $V_{12}(F)$ 由下式给出：\n$$\nV_{12}(F) = V_{12}^0 \\exp\\!\\left(-\\beta F^2\\right)\n$$\n由于参数 $V_{12}^0$ 和 $\\beta$ 为正常数，对于任何实数电场 $F$，$V_{12}(F)$ 的值总是实数且为正。因此，绝对值是多余的。我们记能隙为 $\\Delta E_{\\text{gap}}$，其表达式为：\n$$\n\\Delta E_{\\text{gap}}(F) = 2 V_{12}(F) = 2 V_{12}^0 \\exp(-\\beta F^2)\n$$\n\n**3. Landau-Zener 非绝热跃迁概率 $P_{\\mathrm{NA}}$ 的计算**\n\n非绝热跃迁（即系统保持在透热曲线上从而切换绝热面）的 Landau-Zener 概率由以下公式给出：\n$$\nP_{\\mathrm{NA}} = \\exp\\left( -\\frac{2\\pi \\lvert V_{12} \\rvert^2}{\\hbar \\left| \\frac{d}{dt} \\left(V_1 - V_2\\right) \\right|_{R=R_c}} \\right)\n$$\n在这里，$V_{12}$ 是在交叉点处的耦合，即 $V_{12}(F)$。在原子单位中，$\\hbar=1$。分母中的项是系统通过交叉点时透热能量差随时间的变化率。这个扫描速率可以用链式法则表示：\n$$\n\\frac{d}{dt} \\left(V_1 - V_2\\right) = \\frac{d (\\Delta E)}{dt} = \\frac{d (\\Delta E)}{dR} \\frac{dR}{dt}\n$$\n沿反应坐标的速度是恒定的，$\\frac{dR}{dt} = v$。透热能量差相对于 $R$ 的斜率通过对 $\\Delta E(R;F)$ 求导得出：\n$$\n\\frac{d (\\Delta E)}{dR} = \\frac{d}{dR} \\left[ 2 a (R - R_0) + \\Delta_0 - \\Delta \\mu F \\right] = 2a\n$$\n这个斜率是恒定的。因此，扫描速率的绝对值为：\n$$\n\\left| \\frac{d (\\Delta E)}{dt} \\right|_{R=R_c} = |(2a) \\cdot v|\n$$\n由于 $a$ 和 $v$ 都是给定的正常数，因此不需要绝对值。扫描速率为 $2av$。将这些分量代入 Landau-Zener 公式：\n$$\nP_{\\mathrm{NA}}(F, v) = \\exp\\left( -\\frac{2\\pi (V_{12}(F))^2}{1 \\cdot (2av)} \\right) = \\exp\\left( -\\frac{\\pi (V_{12}(F))^2}{av} \\right)\n$$\n代入 $V_{12}(F) = V_{12}^0 \\exp(-\\beta F^2)$ 的表达式：\n$$\nP_{\\mathrm{NA}}(F, v) = \\exp\\left( -\\frac{\\pi \\left(V_{12}^0 \\exp(-\\beta F^2)\\right)^2}{av} \\right) = \\exp\\left( -\\frac{\\pi (V_{12}^0)^2 \\exp(-2\\beta F^2)}{av} \\right)\n$$\n这个最终表达式将用于计算。\n\n**用于实现的公式总结**：\n给定参数 $a, R_0, \\Delta_0, \\Delta \\mu, V_{12}^0, \\beta$ 和一个测试用例 $(F, v)$：\n1.  交叉坐标：$R_c = R_0 + (\\Delta \\mu F - \\Delta_0) / (2a)$\n2.  能隙：$\\Delta E_{\\text{gap}} = 2 V_{12}^0 \\exp(-\\beta F^2)$\n3.  跃迁概率：$P_{\\mathrm{NA}} = \\exp\\left( - \\frac{\\pi (V_{12}^0)^2 \\exp(-2\\beta F^2)}{av} \\right)$\n\n这些公式将针对每个测试用例进行实现，以产生最终结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the crossing coordinate, minimum adiabatic gap, and Landau-Zener\n    nonadiabatic transition probability for a model two-state system.\n    \"\"\"\n    # Define constants from the problem statement in atomic units.\n    a = 0.2\n    R0 = 3.0\n    delta0 = 0.1\n    delta_mu = 2.0\n    V12_0 = 0.05\n    beta = 0.5\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (F, v), with F in a.u. of electric field and v in Bohr/a.u. time.\n    test_cases = [\n        (0.0, 0.02),\n        (0.5, 0.02),\n        (-0.5, 0.02),\n        (2.0, 0.02),\n        (0.5, 0.2),\n        (4.0, 0.02),\n    ]\n\n    results_for_all_cases = []\n    \n    for F, v in test_cases:\n        # 1. Calculate the crossing coordinate, Rc.\n        # Rc = R0 + (delta_mu * F - delta0) / (2 * a)\n        Rc = R0 + (delta_mu * F - delta0) / (2.0 * a)\n\n        # 2. Calculate the minimum adiabatic energy gap at the crossing.\n        # V12(F) = V12_0 * exp(-beta * F^2)\n        # gap = 2 * |V12(F)|. Since V12(F) is positive, |.| is not needed.\n        V12_F = V12_0 * np.exp(-beta * F**2)\n        gap = 2.0 * V12_F\n\n        # 3. Calculate the Landau-Zener nonadiabatic transition probability, P_NA.\n        # P_NA = exp(-pi * V12(F)^2 / (a * v)) where hbar = 1.\n        exponent = - (np.pi * V12_F**2) / (a * v)\n        P_NA = np.exp(exponent)\n        \n        # Format the results to 6 decimal places as required.\n        # The use of f-strings with a format specifier ensures rounding\n        # and correct string representation.\n        Rc_f = f\"{Rc:.6f}\"\n        gap_f = f\"{gap:.6f}\"\n        P_NA_f = f\"{P_NA:.6f}\"\n        \n        # Append the formatted result for the current case as a compliant string.\n        results_for_all_cases.append(f\"[{Rc_f},{gap_f},{P_NA_f}]\")\n\n    # Final print statement in the exact required format.\n    # The output is a single string representing a list of lists.\n    print(f\"[{','.join(results_for_all_cases)}]\")\n\nsolve()\n```", "id": "2457015"}, {"introduction": "朗道-曾纳公式是一个优雅而强大的解析近似，但它的适用性有其边界。为了深刻理解其理论基础和局限性，最佳方式莫过于将其与“精确”的量子动力学结果进行直接比较。在此练习中，您将通过编写程序，数值求解含时薛定谔方程（TDSE），来模拟一个双能级系统随时间的真实演化，并将得到的跃迁概率与朗道-曾纳公式的预测值进行对比 [@problem_id:2457037]。这不仅能验证理论，还能让您亲身体验计算化学中用于模拟量子动力学的核心数值方法。", "problem": "给定一个经历线性非绝热交叉的模型两能级系统。在原子单位制中，约化普朗克常数为 $\\,\\hbar = 1\\,$，含时哈密顿量为\n$$\nH(t) \\;=\\; \\begin{pmatrix}\n\\dfrac{\\alpha t}{2} & \\Delta \\\\\n\\Delta & -\\dfrac{\\alpha t}{2}\n\\end{pmatrix},\n$$\n其中非绝热耦合常数 $\\,\\Delta \\ge 0\\,$，斜率参数 $\\,\\alpha > 0\\,$。态 $\\,\\psi(t)\\in \\mathbb{C}^2\\,$ 根据含时薛定谔方程 (TDSE) 演化\n$$\ni \\,\\dfrac{d}{dt}\\,\\psi(t) \\;=\\; H(t)\\,\\psi(t),\n$$\n初始条件为 $\\,\\psi(-T) = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}\\,$。末态的非绝热生存概率定义为\n$$\nP_{\\mathrm{num}} \\;=\\; \\bigl|\\langle 1 \\mid \\psi(+T)\\rangle\\bigr|^2 \\;=\\; \\bigl|\\psi_1(+T)\\bigr|^2,\n$$\n其中 $\\,\\lvert 1\\rangle = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}\\,$ 是非绝热基矢。对于线性交叉，非绝热生存概率的 Landau–Zener 解析预测值为\n$$\nP_{\\mathrm{LZ}} \\;=\\; \\exp\\!\\Bigl(-2\\pi\\,\\dfrac{\\Delta^2}{\\alpha}\\Bigr).\n$$\n所有量均采用原子单位：时间单位为原子时间单位，能量单位为哈特里 (Hartree)。概率必须以小数形式表示（而非百分比）。\n\n您的任务是编写一个完整的、可运行的程序，针对下方的每个测试用例，根据上述公式计算 $\\,P_{\\mathrm{LZ}}\\,$，并通过求解从 $\\,t=-T\\,$ 到 $\\,t=+T\\,$ 的含时薛定谔方程（使用给定参数）来计算 $\\,P_{\\mathrm{num}}\\,$，然后返回绝对差\n$$\nD \\;=\\; \\bigl|P_{\\mathrm{num}} - P_{\\mathrm{LZ}}\\bigr|.\n$$\n无需用户输入。\n\n测试套件（每个元组为 $\\;(\\alpha,\\;\\Delta,\\;T,\\;N)\\;$，其中 $\\,N\\,$ 是遍历区间 $\\;[-T,+T]\\,$ 所使用的相等时间步数）：\n\n- 情况 A: $\\;(\\,1.0,\\;0.2,\\;20.0,\\;40000\\,)$\n- 情况 B: $\\;(\\,5.0,\\;0.2,\\;10.0,\\;20000\\,)$\n- 情况 C: $\\;(\\,1.0,\\;0.05,\\;25.0,\\;50000\\,)$\n- 情况 D: $\\;(\\,0.5,\\;0.3,\\;30.0,\\;60000\\,)$\n- 情况 E (边缘情况，零耦合): $\\;(\\,1.0,\\;0.0,\\;10.0,\\;20000\\,)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容为按上述顺序排列的各个情况的结果，例如\n$$\n[ d_A, d_B, d_C, d_D, d_E ],\n$$\n其中每个 $\\,d_X\\,$ 是对应情况的浮点数 $\\,D\\,$。打印的列表不得包含空格。", "solution": "对问题陈述进行验证。\n\n步骤 1：提取已知条件。\n- 该系统是一个两能级量子系统，其含时哈密顿量在原子单位制（$\\hbar = 1$）下表示为：\n$$\nH(t) = \\begin{pmatrix} \\frac{\\alpha t}{2} & \\Delta \\\\ \\Delta & -\\frac{\\alpha t}{2} \\end{pmatrix}\n$$\n- 参数为斜率 $\\alpha > 0$ 和非绝热耦合 $\\Delta \\ge 0$。\n- 态矢量 $\\psi(t)$ 根据含时薛定谔方程 (TDSE) 进行演化：\n$$\ni \\frac{d}{dt}\\psi(t) = H(t)\\psi(t)\n$$\n- 初始条件为 $\\psi(-T) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n- 数值计算的非绝热生存概率为 $P_{\\mathrm{num}} = |\\psi_1(+T)|^2$。\n- 解析的 Landau-Zener 生存概率为 $P_{\\mathrm{LZ}} = \\exp(-2\\pi \\frac{\\Delta^2}{\\alpha})$。\n- 目标是计算绝对差 $D = |P_{\\mathrm{num}} - P_{\\mathrm{LZ}}|$。\n- 提供了一个包含五个测试用例的测试套件，参数为 $(\\alpha, \\Delta, T, N)$，其中 $N$ 是在区间 $[-T, +T]$ 上进行数值积分的时间步数。\n\n步骤 2：验证。\n- **科学依据**：该问题描述了 Landau-Zener 模型，这是非绝热量子动力学的基石。含时薛定谔方程是一个基本方程。Landau-Zener 公式是该模型的正确解析近似。所有物理概念和方程都是标准的且事实准确。\n- **适定性**：该问题在数学上是适定的。含时薛定谔方程是一个具有指定初始条件的线性一阶常微分方程组，这保证了其解的唯一性。解析计算和数值积分所需的所有参数都已提供。时间步数 $N$ 的指定意味着使用固定步长的数值积分器。\n- **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n\n步骤 3：结论。\n该问题在科学上是合理的、适定的和客观的。它不包含任何矛盾或缺失的信息。因此，该问题被判定为**有效**。将构建一个解决方案。\n\n任务是为几组参数计算绝对差 $D = |P_{\\mathrm{num}} - P_{\\mathrm{LZ}}|$。这要求对每种情况进行两种不同的计算：一种是解析计算，另一种是数值计算。\n\n首先，解析的 Landau-Zener 生存概率 $P_{\\mathrm{LZ}}$ 直接通过给定公式计算得出：\n$$\nP_{\\mathrm{LZ}} = \\exp\\left(-2\\pi \\frac{\\Delta^2}{\\alpha}\\right)\n$$\n该公式在无限缓慢地通过曲线交叉点的假设下有效，这对应于极限 $T \\to \\infty$。我们的数值模拟使用有限的时间 $T$，因此 $P_{\\mathrm{num}}$ 和 $P_{\\mathrm{LZ}}$ 之间预计会存在差异。\n\n其次，数值生存概率 $P_{\\mathrm{num}}$ 是通过将态矢量 $\\psi(t) = \\begin{pmatrix} c_1(t) \\\\ c_2(t) \\end{pmatrix}$ 从初始时间 $t = -T$ 演化到最终时间 $t = +T$ 来获得的。该演化由含时薛定谔方程决定，我们将其重排为用于数值积分的标准形式：\n$$\n\\frac{d\\psi(t)}{dt} = -i H(t) \\psi(t)\n$$\n这是一个矢量值的一阶常微分方程 (ODE)。求解此类常微分方程的一种稳健且广泛使用的方法是四阶龙格-库塔 (RK4) 算法。给定常微分方程 $\\frac{d\\vec{y}}{dt} = \\vec{f}(t, \\vec{y})$，时间 $t_{n+1} = t_n + \\delta t$ 的状态可由时间 $t_n$ 的状态近似得到：\n$$\n\\vec{y}_{n+1} = \\vec{y}_n + \\frac{\\delta t}{6} (\\vec{k}_1 + 2\\vec{k}_2 + 2\\vec{k}_3 + \\vec{k}_4)\n$$\n其中中间步骤为：\n$$\n\\vec{k}_1 = \\vec{f}(t_n, \\vec{y}_n)\n$$\n$$\n\\vec{k}_2 = \\vec{f}\\left(t_n + \\frac{\\delta t}{2}, \\vec{y}_n + \\frac{\\delta t}{2} \\vec{k}_1\\right)\n$$\n$$\n\\vec{k}_3 = \\vec{f}\\left(t_n + \\frac{\\delta t}{2}, \\vec{y}_n + \\frac{\\delta t}{2} \\vec{k}_2\\right)\n$$\n$$\n\\vec{k}_4 = \\vec{f}(t_n + \\delta t, \\vec{y}_n + \\delta t \\vec{k}_3)\n$$\n在我们的具体问题中，态矢量是 $\\vec{y}(t) = \\psi(t) \\in \\mathbb{C}^2$，函数是 $\\vec{f}(t, \\psi) = -i H(t) \\psi(t)$。积分在时间区间 $[-T, +T]$ 上进行，使用 $N$ 个相等的时间步，因此步长为 $\\delta t = \\frac{2T}{N}$。初始条件为 $\\psi(-T) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n对于每个测试用例 $(\\alpha, \\Delta, T, N)$，算法如下：\n1.  使用其解析公式计算 $P_{\\mathrm{LZ}}$。\n2.  在时间 $t = -T$ 初始化数值态矢量 $\\psi = \\begin{pmatrix} 1+0i \\\\ 0+0i \\end{pmatrix}$。\n3.  计算时间步长 $\\delta t = 2T / N$。\n4.  迭代 $N$ 次。在每次迭代中，将时间推进 $\\delta t$，并使用函数 $\\vec{f}(t, \\psi) = -i H(t) \\psi$ 通过一个 RK4 算法步骤来更新态矢量 $\\psi$。矩阵 $H(t)$ 必须在 RK4 步骤中的每个所需时间点（$t_n$、$t_n + \\frac{\\delta t}{2}$、$t_n + \\delta t$）重新计算。\n5.  经过 $N$ 步后，系统处于时间 $t = +T$。最终的态矢量为 $\\psi(+T) = \\begin{pmatrix} c_1(+T) \\\\ c_2(+T) \\end{pmatrix}$。\n6.  计算数值生存概率为 $P_{\\mathrm{num}} = |c_1(+T)|^2$。复数 $z$ 的模的平方为 $z^*z$。\n7.  计算最终结果 $D = |P_{\\mathrm{num}} - P_{\\mathrm{LZ}}|$。\n\n将此过程系统地应用于所有提供的测试用例，以生成最终的结果列表。对于 $\\Delta=0$ 的边缘情况，哈密顿量是对角的，因此态之间不发生混合。我们期望 $P_{\\mathrm{LZ}} = 1$ 且 $P_{\\mathrm{num}} \\approx 1$，从而得出 $D \\approx 0$。这可以作为对数值实现的一个有价值的检验。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Landau-Zener problem for a suite of test cases.\n\n    For each case, it calculates the analytical Landau-Zener survival probability\n    and compares it to a numerical solution of the time-dependent Schrödinger\n    equation (TDSE) obtained via the fourth-order Runge-Kutta (RK4) method.\n    \"\"\"\n    # Test suite: each tuple is (alpha, Delta, T, N)\n    test_cases = [\n        (1.0, 0.2, 20.0, 40000),   # Case A\n        (5.0, 0.2, 10.0, 20000),   # Case B\n        (1.0, 0.05, 25.0, 50000),  # Case C\n        (0.5, 0.3, 30.0, 60000),   # Case D\n        (1.0, 0.0, 10.0, 20000),   # Case E (edge, zero coupling)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        alpha, delta, T, N = case\n\n        # 1. Calculate the analytical Landau-Zener probability, P_LZ.\n        # The case alpha=0 is ruled out by the problem statement (alpha > 0).\n        p_lz = np.exp(-2.0 * np.pi * delta**2 / alpha)\n\n        # 2. Numerically solve the TDSE using the RK4 method to find P_num.\n        \n        # Time step for integration\n        dt = 2.0 * T / N\n        \n        # Initial condition: psi(-T) = [1, 0]\n        psi = np.array([1.0 + 0.0j, 0.0 + 0.0j], dtype=np.complex128)\n        \n        t = -T\n        \n        # The derivative function for the TDSE: d(psi)/dt = -i * H(t) * psi\n        def f(current_t, current_psi, alpha_param, delta_param):\n            H = np.array([\n                [0.5 * alpha_param * current_t, delta_param],\n                [delta_param, -0.5 * alpha_param * current_t]\n            ], dtype=np.complex128)\n            return -1.0j * (H @ current_psi)\n\n        # RK4 integration loop\n        for _ in range(N):\n            k1 = f(t, psi, alpha, delta)\n            k2 = f(t + 0.5 * dt, psi + 0.5 * dt * k1, alpha, delta)\n            k3 = f(t + 0.5 * dt, psi + 0.5 * dt * k2, alpha, delta)\n            k4 = f(t + dt, psi + dt * k3, alpha, delta)\n            \n            psi += (dt / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n            t += dt\n\n        # Final numerical survival probability P_num = |psi_1(+T)|^2\n        p_num = np.abs(psi[0])**2\n        \n        # 3. Calculate the absolute difference D.\n        difference = abs(p_num - p_lz)\n        results.append(difference)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "2457037"}]}