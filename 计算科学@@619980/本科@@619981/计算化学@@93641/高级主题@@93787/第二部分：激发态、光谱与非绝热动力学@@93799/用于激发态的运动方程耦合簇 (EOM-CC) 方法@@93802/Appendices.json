{"hands_on_practices": [{"introduction": "理论学习的最佳方式之一是亲手实践。这个练习将引导你为最简单的化学键——氢分子 ($\\text{H}_2$) 中的化学键——构建运动方程理论的数学框架。通过在最小基组下手动推导 EOM-CIS 有效哈密顿矩阵，你将把抽象的理论与具体的物理量（如轨道能级差和双电子积分）联系起来，从而为理解更复杂的计算奠定坚实的数学基础 [@problem_id:2455511]。", "problem": "考虑在由限制性 Hartree-Fock (RHF) 计算构建的空间分子轨道最小基组中的氢分子 $\\text{H}_2$。将在轨成键空间轨道表示为 $o$，反键空空间轨道表示为 $v$。在轨道能为 $\\varepsilon_o$ 和 $\\varepsilon_v$ 的正则 RHF 分子轨道基中进行计算，并定义轨道能隙 $\\Delta \\varepsilon \\equiv \\varepsilon_v - \\varepsilon_o$。\n\n采用二次量子化形式的非相对论电子哈密顿量，并使用运动方程耦合簇 (EOM-CC) 理论，其中簇算符设为零，即 $T=0$（EOM-单组态相互作用，EOM-CIS，极限）。在此极限下，相似变换后的哈密顿量等于裸哈密顿量，因此激发态流形内的有效哈密顿量可通过将哈密顿量投影到单激发行列式空间上得到。使用自旋轨道单激发基\n$\\{\\, a_{v\\alpha}^{\\dagger} a_{o\\alpha} |\\Phi_0 \\rangle,\\; a_{v\\beta}^{\\dagger} a_{o\\beta} |\\Phi_0\\rangle \\,\\}$，\n其中 $|\\Phi_0 \\rangle$ 是 RHF 参考行列式，$\\alpha,\\beta$ 表示自旋。\n\n令空间分子轨道上的标准双电子库仑积分表示为\n$$ (pq \\mid rs) \\equiv \\displaystyle \\int \\!\\!\\! \\int \\varphi_p(\\mathbf{r}_1)\\,\\varphi_q(\\mathbf{r}_1)\\,\\frac{1}{r_{12}}\\,\\varphi_r(\\mathbf{r}_2)\\,\\varphi_s(\\mathbf{r}_2)\\,d\\mathbf{r}_1\\,d\\mathbf{r}_2 $$\n并对此双轨道系统定义，\n$J \\equiv (vv \\mid oo)$ 和 $K \\equiv (vo \\mid ov)$。\n\n在上述自旋轨道单激发基中，手动构建 $2 \\times 2$ 的 EOM-CIS 有效哈密顿量矩阵 $\\bar{H}$，并用 $\\Delta \\varepsilon$、$J$ 和 $K$ 显式表示所有矩阵元。请以单个 $2 \\times 2$ 矩阵的形式给出最终答案。无需进行数值计算，也无需单位。", "solution": "本题要求为在最小基组中应用于 $\\text{H}_2$ 分子的运动方程单组态相互作用 (EOM-CIS) 构建有效哈密顿量矩阵。EOM-CIS 方法等价于将簇算符 $T$ 设为零的 EOM-耦合簇方法。在此极限下，相似变换后的哈密顿量 $\\bar{H} = \\exp(-T) H \\exp(T)$ 简化为裸哈密顿量 $H$。我们的任务是找到此哈密顿量在相对于限制性 Hartree-Fock (RHF) 基态行列式 $|\\Phi_0\\rangle$ 的单激发自旋轨道行列式基中的矩阵表示。\n\nRHF 参考态为 $|\\Phi_0\\rangle = |o\\alpha \\, o\\beta \\rangle$，其中 $o$ 是占有成键空间分子轨道。单激发态的基矢为 $\\{|\\Psi_1\\rangle, |\\Psi_2\\rangle\\}$，其中：\n$$ |\\Psi_1\\rangle = a_{v\\alpha}^{\\dagger} a_{o\\alpha} |\\Phi_0\\rangle \\equiv |\\Phi_{o\\alpha}^{v\\alpha}\\rangle $$\n$$ |\\Psi_2\\rangle = a_{v\\beta}^{\\dagger} a_{o\\beta} |\\Phi_0\\rangle \\equiv |\\Phi_{o\\beta}^{v\\beta}\\rangle $$\n此处，$v$ 表示空的反键空间分子轨道，$a_{p\\sigma}^\\dagger$ 和 $a_{q\\sigma}$ 分别是电子在自旋轨道 $p\\sigma$ 和 $q\\sigma$ 上的产生和湮灭算符。\n\n待构建的矩阵是 $\\bar{H}$，其矩阵元为 $\\bar{H}_{mn} = \\langle \\Psi_m | H | \\Psi_n \\rangle$。通常，我们会使用相对于基态能量 $E_0 = \\langle \\Phi_0 | H | \\Phi_0 \\rangle$ 移动后的哈密顿量，因为其本征值将直接给出激发能。该移动后矩阵的矩阵元（我们仍用 $\\bar{H}$ 表示）由 $\\bar{H}_{mn} = \\langle \\Psi_m | H - E_0 | \\Psi_n \\rangle$ 给出。\n\n移动后哈密顿量在两个单激发行列式 $|\\Phi_i^a\\rangle$ 和 $|\\Phi_j^b\\rangle$（其中 $i,j$ 为占有自旋轨道，$a,b$ 为空自旋轨道）之间的矩阵元的一般表达式由 Slater-Condon 规则给出。对于正则 RHF 轨道，其中 Fock 矩阵是对角的 ($f_{pq} = \\varepsilon_p \\delta_{pq}$)，此表达式简化为：\n$$ \\langle \\Phi_i^a | H - E_0 | \\Phi_j^b \\rangle = (\\varepsilon_a - \\varepsilon_i)\\delta_{ij}\\delta_{ab} + \\langle aj || ib \\rangle $$\n项 $\\langle aj || ib \\rangle$ 代表物理学家记法中的反对称化双电子积分，定义为 $\\langle aj || ib \\rangle \\equiv \\langle aj | ib \\rangle - \\langle aj | bi \\rangle$。这些自旋轨道上的积分必须转换为空问轨道上的积分。自旋轨道 $\\chi_p = \\varphi_{p'} \\sigma_p$ 和 $\\chi_q = \\varphi_{q'} \\sigma_q$ 上的一般双电子积分通过以下方式与空间积分相关联：\n$$ \\langle pq|rs \\rangle = \\int \\chi_p^*(1)\\chi_q^*(2) \\frac{1}{r_{12}} \\chi_r(1)\\chi_s(2) d\\tau_1 d\\tau_2 = (\\varphi_{p'}\\varphi_{r'}|\\varphi_{q'}\\varphi_{s'}) \\langle\\sigma_p|\\sigma_r\\rangle \\langle\\sigma_q|\\sigma_s\\rangle $$\n这里，我们在等式右侧使用题目中的积分记法，并假设轨道为实轨道，因此 $(p'r'|q's')$ 变为 $(p'r' \\mid q's')$。题目中给出了定义 $J \\equiv (vv \\mid oo)$ 和 $K \\equiv (vo \\mid ov)$。\n\n我们接下来计算 $2 \\times 2$ 矩阵 $\\bar{H}$ 的四个元素。\n\n**对角元 $\\bar{H}_{11}$：**\n对于此元素，$m=n=1$。行列式相同：$|\\Psi_1\\rangle = |\\Phi_{o\\alpha}^{v\\alpha}\\rangle$。\n自旋轨道指数为 $i=j=o\\alpha$ 和 $a=b=v\\alpha$。\n轨道能差为 $\\varepsilon_{v\\alpha} - \\varepsilon_{o\\alpha} = \\varepsilon_v - \\varepsilon_o \\equiv \\Delta\\varepsilon$。\n积分项为 $\\langle (v\\alpha)(o\\alpha) || (o\\alpha)(v\\alpha) \\rangle = \\langle (v\\alpha)(o\\alpha) | (o\\alpha)(v\\alpha) \\rangle - \\langle (v\\alpha)(o\\alpha) | (v\\alpha)(o\\alpha) \\rangle$。\n第一个积分为：\n$$ \\langle (v\\alpha)(o\\alpha) | (o\\alpha)(v\\alpha) \\rangle = (vo \\mid ov) \\langle\\alpha|\\alpha\\rangle \\langle\\alpha|\\alpha\\rangle = K \\cdot 1 \\cdot 1 = K $$\n第二个积分为：\n$$ \\langle (v\\alpha)(o\\alpha) | (v\\alpha)(o\\alpha) \\rangle = (vv \\mid oo) \\langle\\alpha|\\alpha\\rangle \\langle\\alpha|\\alpha\\rangle = J \\cdot 1 \\cdot 1 = J $$\n因此，矩阵元为：\n$$ \\bar{H}_{11} = \\Delta\\varepsilon + K - J $$\n\n**对角元 $\\bar{H}_{22}$：**\n对于此元素，$m=n=2$。行列式为 $|\\Psi_2\\rangle = |\\Phi_{o\\beta}^{v\\beta}\\rangle$。\n自旋轨道指数为 $i=j=o\\beta$ 和 $a=b=v\\beta$。计算过程与 $\\bar{H}_{11}$ 的计算相同，只是自旋为 $\\beta$ 而非 $\\alpha$。\n轨道能差为 $\\varepsilon_{v\\beta} - \\varepsilon_{o\\beta} = \\varepsilon_v - \\varepsilon_o = \\Delta\\varepsilon$。\n积分的计算结果与之前一样为 $K$ 和 $J$，因为空间部分相同且自旋函数是归一化的 ($\\langle\\beta|\\beta\\rangle=1$)。\n$$ \\bar{H}_{22} = \\Delta\\varepsilon + K - J $$\n\n**非对角元 $\\bar{H}_{12}$：**\n对于此元素，$m=1$，$n=2$。我们有 $|\\Psi_1\\rangle = |\\Phi_{o\\alpha}^{v\\alpha}\\rangle$ 和 $|\\Psi_2\\rangle = |\\Phi_{o\\beta}^{v\\beta}\\rangle$。\n自旋轨道指数为 $i=o\\alpha$，$j=o\\beta$，$a=v\\alpha$ 和 $b=v\\beta$。\n由于 $i \\neq j$ 和 $a \\neq b$，项 $(\\varepsilon_a - \\varepsilon_i)\\delta_{ij}\\delta_{ab}$ 为零。\n矩阵元仅由积分项 $\\langle aj || ib \\rangle$ 给出，其中 $i=o\\alpha, j=o\\beta, a=v\\alpha, b=v\\beta$：\n$$ \\bar{H}_{12} = \\langle (v\\alpha)(o\\beta) || (o\\alpha)(v\\beta) \\rangle = \\langle (v\\alpha)(o\\beta) | (o\\alpha)(v\\beta) \\rangle - \\langle (v\\alpha)(o\\beta) | (v\\beta)(o\\alpha) \\rangle $$\n第一个积分为：\n$$ \\langle (v\\alpha)(o\\beta) | (o\\alpha)(v\\beta) \\rangle = (vo \\mid ov) \\langle\\alpha|\\alpha\\rangle \\langle\\beta|\\beta\\rangle = K \\cdot 1 \\cdot 1 = K $$\n第二个积分为：\n$$ \\langle (v\\alpha)(o\\beta) | (v\\beta)(o\\alpha) \\rangle = (vv \\mid oo) \\langle\\alpha|\\beta\\rangle \\langle\\beta|\\alpha\\rangle = J \\cdot 0 \\cdot 0 = 0 $$\n自旋函数是正交的。因此，矩阵元为：\n$$ \\bar{H}_{12} = K - 0 = K $$\n\n**非对角元 $\\bar{H}_{21}$：**\n由于哈密顿量是厄米的，$\\bar{H}_{21} = \\bar{H}_{12}^*$。由于所有量（$\\Delta\\varepsilon, J, K$）都是实数，我们有 $\\bar{H}_{21} = \\bar{H}_{12} = K$。\n我们可以通过使用 $i=o\\beta, j=o\\alpha, a=v\\beta, b=v\\alpha$ 进行显式计算来验证这一点。\n$$ \\bar{H}_{21} = \\langle (v\\beta)(o\\alpha) || (o\\beta)(v\\alpha) \\rangle = \\langle (v\\beta)(o\\alpha) | (o\\beta)(v\\alpha) \\rangle - \\langle (v\\beta)(o\\alpha) | (v\\alpha)(o\\beta) \\rangle $$\n$$ \\langle (v\\beta)(o\\alpha) | (o\\beta)(v\\alpha) \\rangle = (vo \\mid ov) \\langle\\beta|\\beta\\rangle \\langle\\alpha|\\alpha\\rangle = K $$\n$$ \\langle (v\\beta)(o\\alpha) | (v\\alpha)(o\\beta) \\rangle = (vv \\mid oo) \\langle\\beta|\\alpha\\rangle \\langle\\alpha|\\beta\\rangle = 0 $$\n这证实了 $\\bar{H}_{21} = K$。\n\n将这些元素组合在一起，得到最终的 $2 \\times 2$ EOM-CIS 有效哈密顿量矩阵 $\\bar{H}$：\n$$ \\bar{H} = \\begin{pmatrix} \\Delta\\varepsilon + K - J & K \\\\ K & \\Delta\\varepsilon + K - J \\end{pmatrix} $$\n该矩阵的本征值为 $\\lambda_1 = \\Delta\\varepsilon - J$（对应于三重态）和 $\\lambda_2 = \\Delta\\varepsilon + 2K - J$（对应于单重态），它们是此模型系统正确的 CIS 激发能。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\Delta \\varepsilon + K - J & K \\\\\nK & \\Delta \\varepsilon + K - J\n\\end{pmatrix}\n}\n$$", "id": "2455511"}, {"introduction": "在掌握了基本推导之后，让我们将理论付诸于计算实践。这个练习要求你编写一个程序来模拟线性多烯烃的 $\\pi \\to \\pi^*$ 激发能，这是一个在光化学和材料科学中至关重要的问题。通过将 EOM-CC 理论在一个简化模型（Hückel 模型）下与直观的 HOMO-LUMO 能隙联系起来，你将学会如何通过计算来探索分子结构（如链长和键长交替）对光谱性质的影响 [@problem_id:2455544]。", "problem": "给定一个线性多烯的$\\pi$电子体系的最简模型，该模型是在一条有限开链上的单电子最近邻紧束缚哈密顿量（也称为 Hückel 模型）。该体系包含 $L$ 个格点（每个碳原子上有一个 $p_z$ 轨道），每个格点有一个电子，并具有自旋简并性。其二次量子化形式的哈密顿量为\n$$\n\\hat{H} \\;=\\; \\sum_{n=1}^{L-1} \\sum_{\\sigma\\in\\{\\uparrow,\\downarrow\\}} \\left( t_{n,n+1}\\, \\hat{c}^{\\dagger}_{n\\sigma} \\hat{c}_{n+1,\\sigma} + t_{n+1,n}\\, \\hat{c}^{\\dagger}_{n+1,\\sigma} \\hat{c}_{n\\sigma} \\right),\n$$\n采用开放边界条件，且在位能设为零。键交替通过以下方式施加：\n$$\nt_{n,n+1} \\;=\\; t \\times \\begin{cases}\n(1+\\delta), & \\text{当 } n \\text{ 为奇数时},\\\\\n(1-\\delta), & \\text{当 } n \\text{ 为偶数时},\n\\end{cases}\n$$\n且 $t_{n+1,n} = t_{n,n+1}$，其中 $t$（单位为电子伏特）是一个恒定的最近邻耦合常数，$\\delta \\in [0,1)$ 是一个无量纲的交替参数。假设 $L$ 为偶数，半填充时的基态是通过用双占据（自旋简并）的方式填充能量最低的 $L/2$ 个单电子本征态所得到的闭壳层Slater行列式。\n\n将最低的中性$\\pi \\to \\pi^*$激发能定义为：在闭壳层参考态上构建、并限制在由单粒子-单空穴算符所张成的子空间内的、粒子数守恒的激发，并由 Equation-of-Motion Coupled Cluster (EOM-CC) 方法预测的最低单重态激发能。对于上述形式的单电子哈密顿量，此激发能等于格点空间哈密顿矩阵的最低未占据单电子本征值与最高占据单电子本征值之差。\n\n编写一个完整且自洽的程序。对于下述每个测试用例，该程序应在格点基下构建 $L \\times L$ 的单电子哈密顿矩阵，按升序计算其所有 $L$ 个本征值，并返回定义为 $\\varepsilon_{\\mathrm{LUMO}} - \\varepsilon_{\\mathrm{HOMO}}$ 的最低$\\pi \\to \\pi^*$激发能（单位为电子伏特）。您的程序必须以电子伏特为单位给出答案，并且必须将每个结果四舍五入到小数点后$6$位。\n\n请使用以下测试套件，其中每个用例是一个三元组 $(L, t, \\delta)$，且 $t$ 的单位为电子伏特：\n- 测试用例 $1$：$(L, t, \\delta) = (\\,4,\\,-2.700,\\,0.230\\,)$。\n- 测试用例 $2$：$(L, t, \\delta) = (\\,6,\\,-2.700,\\,0.230\\,)$。\n- 测试用例 $3$：$(L, t, \\delta) = (\\,8,\\,-2.700,\\,0.230\\,)$。\n- 测试用例 $4$：$(L, t, \\delta) = (\\,8,\\,-2.700,\\,0.000\\,)$。\n- 测试用例 $5$：$(L, t, \\delta) = (\\,2,\\,-2.700,\\,0.230\\,)$。\n\n最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。例如，输出必须具有以下形式\n$$\n[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5],\n$$\n其中每个 $\\text{result}_k$ 是一个浮点数，四舍五入到小数点后$6$位，单位为电子伏特，并按顺序对应于测试用例1至5。", "solution": "问题陈述已经过严格审查，并被认定是有效的。它在科学上基于量子化学的原理，特别是针对$\\pi$共轭体系的Hückel紧束缚模型。该问题是适定的，为得到唯一且有意义的解提供了所有必要的参数和定义。其术语客观而精确。\n\n目标是计算一个由单电子、最近邻紧束缚模型描述的、含有 $L$ 个格点的线性多烯的最低$\\pi \\to \\pi^*$激发能。该能量定义为最低未占分子轨道 (LUMO) 能量与最高已占分子轨道 (HOMO) 能量之差。\n\n该体系由格点基哈密顿矩阵 $\\mathbf{H}$ 描述，它是一个 $L \\times L$ 的实对称矩阵。在原子$p_z$轨道基 $|i\\rangle$ （对于格点 $i=1, \\dots, L$）中，矩阵元 $H_{ij} = \\langle i | \\hat{H} | j \\rangle$ 按如下方式构建。\n\n对应于对角元的在位能给定为零：\n$$\nH_{nn} = 0 \\quad \\text{对于 } n = 1, \\dots, L\n$$\n\n由于紧束缚近似的性质，非对角元 $H_{n,m}$ 仅在最近邻 ($m = n \\pm 1$) 处非零。这些是跃迁积分 $t_{n, n+1}$：\n$$\nH_{n,n+1} = H_{n+1,n} = t_{n,n+1}\n$$\n问题指定了键交替，其中跃迁积分的值取决于键在链中的位置。对于格点 $n$ 和格点 $n+1$ 之间的键：\n$$\nt_{n,n+1} = t \\times \\begin{cases}\n\\text{若 } n \\text{ 为奇数}, & (1+\\delta) \\\\\n\\text{若 } n \\text{ 为偶数}, & (1-\\delta)\n\\end{cases}\n$$\n其中 $n=1, \\dots, L-1$。这种结构产生一个三对角矩阵：\n$$\n\\mathbf{H} = \\begin{pmatrix}\n0 & t_{1,2} & 0 & \\cdots & 0 \\\\\nt_{2,1} & 0 & t_{2,3} & \\cdots & 0 \\\\\n0 & t_{3,2} & 0 & \\ddots & \\vdots \\\\\n\\vdots & \\vdots & \\ddots & 0 & t_{L-1,L} \\\\\n0 & 0 & \\cdots & t_{L,L-1} & 0\n\\end{pmatrix}\n$$\n\n单电子能量 $\\{\\varepsilon_k\\}_{k=1}^L$ 是该矩阵 $\\mathbf{H}$ 的本征值。它们通过求解久期方程 $\\det(\\mathbf{H} - \\varepsilon \\mathbf{I}) = 0$ 得到。我们计算这些本征值并按升序排列：$\\varepsilon_1 \\le \\varepsilon_2 \\le \\dots \\le \\varepsilon_L$。\n\n体系的基态是通过将 $L$ 个电子（每个格点一个电子，考虑自旋简并）填充到这些单电子轨道中形成的。由于 $L$ 是偶数，共有 $L/2$ 对电子。它们占据了能量最低的 $L/2$ 个轨道。\n因此，最高已占分子轨道 (HOMO) 是第 $(L/2)$ 个轨道，其能量为：\n$$\n\\varepsilon_{\\mathrm{HOMO}} = \\varepsilon_{L/2}\n$$\n最低未占分子轨道 (LUMO) 是能量上紧随其后的轨道，即第 $(L/2+1)$ 个轨道：\n$$\n\\varepsilon_{\\mathrm{LUMO}} = \\varepsilon_{L/2+1}\n$$\n在此模型中，最低的中性$\\pi \\to \\pi^*$激发能对应于将一个电子从HOMO激发到LUMO。此跃迁所需的能量即为HOMO-LUMO能隙：\n$$\n\\Delta E = \\varepsilon_{\\mathrm{LUMO}} - \\varepsilon_{\\mathrm{HOMO}} = \\varepsilon_{L/2+1} - \\varepsilon_{L/2}\n$$\n解决方案涉及实现一个数值程序，为每个给定的测试用例 $(L, t, \\delta)$ 执行这些步骤。将构建一个程序来：\n1.  根据指定规则构建 $L \\times L$ 哈密顿矩阵 $\\mathbf{H}$。\n2.  对 $\\mathbf{H}$ 进行数值对角化以找到其本征值。由于 $\\mathbf{H}$ 是实对称矩阵，存在用于此目的的高效算法。\n3.  对本征值进行排序以确定 $\\varepsilon_{L/2}$ 和 $\\varepsilon_{L/2+1}$。\n4.  计算差值 $\\Delta E$ 并以电子伏特为单位报告，四舍五入到所需精度。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Hückel model for linear polyenes with bond alternation and\n    calculates the HOMO-LUMO gap, which corresponds to the lowest pi->pi*\n    excitation energy in this one-electron model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (L, t, delta).\n    test_cases = [\n        (4, -2.700, 0.230),\n        (6, -2.700, 0.230),\n        (8, -2.700, 0.230),\n        (8, -2.700, 0.000),\n        (2, -2.700, 0.230),\n    ]\n\n    results = []\n    for L, t, delta in test_cases:\n        # The problem requires L to be even.\n        if L % 2 != 0:\n            raise ValueError(\"L must be an even integer.\")\n\n        # Construct the L x L one-electron Hamiltonian matrix.\n        # It is a real, symmetric, tridiagonal matrix.\n        H = np.zeros((L, L), dtype=float)\n\n        # Populate the off-diagonal elements (hopping integrals).\n        # We iterate through the bonds. The problem uses 1-based indexing for sites n=1,...,L.\n        # Our matrix uses 0-based indices i=0,...,L-1.\n        # A bond between site n and n+1 corresponds to matrix indices (n-1, n).\n        for n in range(1, L): # n from 1 to L-1\n            # The matrix indices corresponding to sites n and n+1 are i=n-1 and j=n.\n            i, j = n - 1, n\n            \n            # Determine hopping integral based on bond alternation rule.\n            if n % 2 != 0:  # n is odd\n                hopping = t * (1.0 + delta)\n            else:  # n is even\n                hopping = t * (1.0 - delta)\n            \n            H[i, j] = hopping\n            H[j, i] = hopping # The matrix is symmetric.\n\n        # Compute the eigenvalues of the Hamiltonian matrix.\n        # Since H is real and symmetric, we can use np.linalg.eigvalsh,\n        # which is efficient and returns sorted eigenvalues.\n        eigenvalues = np.linalg.eigvalsh(H)\n\n        # Identify the HOMO and LUMO energies.\n        # For a system with L electrons (half-filling), the L/2 lowest\n        # energy levels are occupied. The number of occupied orbitals is L/2.\n        # With 0-based indexing, the HOMO is at index (L/2 - 1).\n        # The LUMO is at index L/2.\n        homo_index = L // 2 - 1\n        lumo_index = L // 2\n\n        homo_energy = eigenvalues[homo_index]\n        lumo_energy = eigenvalues[lumo_index]\n\n        # Calculate the excitation energy (HOMO-LUMO gap).\n        excitation_energy = lumo_energy - homo_energy\n\n        # Round the result to 6 decimal places.\n        results.append(round(excitation_energy, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2455544"}, {"introduction": "成为一名优秀的计算化学家不仅意味着知道如何使用一种方法，更重要的是要了解它的局限性。本次练习探讨了基于 RHF 的 EOM-CCSD 方法在处理 $\\text{F}_2$ 分子键断裂时的失败案例，这是一个经典的教科书级问题。通过分析这一过程，你将深入理解静态相关的概念，并学会识别那些单参考方法不再适用、必须采用更高级的多参考方法处理的化学情境 [@problem_id:2455482]。", "problem": "在运动方程耦合簇单双激发（Equation-of-Motion Coupled Cluster with Singles and Doubles, EOM-CCSD）方法中，电子激发态表示为 $|\\Psi_K\\rangle = \\hat{R}_K e^{\\hat{T}} |\\Phi_0\\rangle$，其中 $\\hat{T}$ 是在单、双激发水平上截断的簇算符，$\\hat{R}_K$ 是在单、双粒子-空穴阶数上截断的激发算符，而 $|\\Phi_0\\rangle$ 是一个单 Slater 行列式，通常是闭壳层限制性 Hartree-Fock（RHF）参考态。考虑氟分子 $\\text{F}_2$ 的最低单重态势能曲线，当键长 $R$ 从平衡位置增加到解离极限时的情况。\n\n从第一性原理出发，哪种说法最能解释为什么标准的基于 RHF 的 EOM-CCSD 计算无法为 $\\text{F}_2$ 提供定性正确的键断裂势能曲线？\n\nA. $\\text{F}_2$ 的解离表现出强烈的静态（非动态）相关和近简并性；精确的解离极限由对应于两个开壳层氟原子的多个行列式主导，因此单行列式 RHF 参考态和 EOM-CCSD 算符流形无法捕捉整个键断裂过程中所需的多参考特征。\n\nB. EOM-CCSD 不是尺寸一致的，因此即使对于没有显著近简并性的体系，它也必然会给出不正确的解离极限。\n\nC. 基组不完备性误差在 $\\text{F}_2$ 中占主导地位，而像 EOM-CCSD 这样的相关方法在没有极大单电子基组的情况下无法弥补这一点；这种失败主要是一种基组人为效应，而不是相关问题。\n\nD. 失败完全是由于忽略了三重激发；即使单参考图像仍然有效，键断裂也普遍需要三重激发。\n\nE. 失败完全是由于缺乏轨道弛豫；在每个 $R$ 处重新优化相同的 RHF 轨道 $|\\Phi_0\\rangle$ 就能在 EOM-CCSD 框架内解决这个问题。", "solution": "对问题陈述进行验证。\n\n**第1步：提取已知信息**\n- **方法：** 运动方程耦合簇单双激发 (Equation-of-Motion Coupled Cluster with Singles and Doubles, EOM-CCSD)。\n- **波函数拟设：** 激发态波函数由 $|\\Psi_K\\rangle = \\hat{R}_K e^{\\hat{T}} |\\Phi_0\\rangle$ 给出。\n- **算符：** $\\hat{T}$ 是耦合簇算符，在单、双激发水平上截断 ($\\hat{T} = \\hat{T}_1 + \\hat{T}_2$)。$\\hat{R}_K$ 是一个线性激发算符，在单、双粒子-空穴阶数上截断 ($\\hat{R}_K = R_{0,K} + \\hat{R}_{1,K} + \\hat{R}_{2,K}$，其中 $R_{0,K}$ 是一个标量)。\n- **参考态：** $|\\Phi_0\\rangle$ 是一个通过限制性 Hartree-Fock (RHF) 计算得到的单 Slater 行列式。\n- **体系与过程：** 计算氟分子 $\\text{F}_2$ 的势能曲线，其中核间距 $R$ 从其平衡值增加到解离极限 ($R \\to \\infty$)。\n- **观察现象：** 标准的基于 RHF 的 EOM-CCSD 计算在键断裂过程中无法为最低单重态生成一条定性正确的势能曲线。\n\n**第2步：使用提取的信息进行验证**\n- **科学依据：** 该问题描述了单参考量子化学方法失败的一个典型例子。共价键（如 $\\text{F}_2$ 中的）的解离过程涉及 RHF 方法基本假设的失效。对 EOM-CCSD 方法的描述是标准且正确的。这一现象是电子结构理论中一个公认的基本课题。该问题具有科学合理性。\n- **适定性：** 该问题要求为一个已知的计算假象找出其根本的物理原因。问题清晰、明确，并且在量子化学框架内有一个明确的概念性答案。\n- **客观性：** 该问题以精确、客观、技术性的语言陈述。没有主观内容。\n\n**第3步：结论与行动**\n该问题是**有效的**。这是一个关于计算化学基本概念的、适定且有科学依据的问题。我将继续进行详细的推导和选项评估。\n\n**正确解释的推导**\n\n问题的核心在于 $\\text{F}_2$ 分子键被拉伸时的电子结构。\n\n1.  **在平衡位置：** 在平衡键长 $R_{eq}$ 附近，$\\text{F}_2$ 分子是一个行为良好的闭壳层体系。其电子基态主要由一个单一的电子组态主导，这个组态可以被一个单 Slater 行列式 $|\\Phi_0\\rangle$ 合理地近似。这个行列式通常由 RHF 计算得到。在这种图像中，成键分子轨道 $\\sigma_g$ 被双重占据，而反键轨道 $\\sigma_u^*$ 是空的。这些轨道之间的能级差很大。\n\n2.  **在键解离过程中：** 随着核间距 $R$ 的增加，分子被拉开成两个氟原子：$\\text{F}_2 \\to \\text{F} + \\text{F}$。每个基态氟原子都有一个开壳层电子组态 ($[He] 2s^2 2p^5$)，拥有一个未配对电子。要正确描述两个相互作用的开壳层原子，需要一个能够表示由这两个未配对电子形成的纯单重态的波函数。\n\n3.  **RHF 参考态的失效：** RHF 方法从根本上无法正确描述这一解离过程。根据其构造，RHF 波函数 $|\\Phi_0\\rangle$ 强制分子轨道被双重占据。当 $R \\to \\infty$ 时，$\\text{F}_2$ 的 RHF 波函数变成了正确的共价组态 ($\\text{F}^\\cdot + \\text{F}^\\cdot$) 和不正确的、高能量的离子组态 ($\\text{F}^+ \\text{F}^-$) 的等权重叠加。这导致了灾难性的失败：RHF 势能曲线在解离极限处上升到一个完全不符合物理实际的能量值。\n\n4.  **静态相关：** 随着 $R \\to \\infty$，最高占据分子轨道 (HOMO, $\\sigma_g$) 和最低未占分子轨道 (LUMO, $\\sigma_u^*$) 之间的能量差减小。在解离极限处，$\\sigma_g$ 和 $\\sigma_u^*$ 轨道变得简并。基态波函数 $|\\Psi_{GS}\\rangle$ 发展出强烈的多参考特征，这意味着它只能由多个行列式的线性组合来正确描述。一个最小的正确描述至少需要两个行列式：$|\\Psi_{GS}\\rangle \\approx c_1 |\\dots (\\sigma_g)^2\\rangle + c_2 |\\dots (\\sigma_u^*)^2\\rangle$。当 $R \\to \\infty$ 时，系数的绝对值变得相等，即 $|c_1| \\approx |c_2|$。这种在零阶波函数中必须包含多个近简并行列式的要求，被称为**强**相关或**静态（非动态）相关**。\n\n5.  **EOM-CCSD 的失败：** EOM-CCSD 方法建立在一个单参考耦合簇基态 $|\\Psi_{CCSD}\\rangle = e^{\\hat{T}_1 + \\hat{T}_2} |\\Phi_0\\rangle$ 之上。\n    - 基态 CCSD 计算本身由于与 RHF 参考态失效相同的原因而失败。尽管指数拟设 $e^{\\hat{T}}$ 可以通过包含激发行列式（如从 $\\sigma_g$ 到 $\\sigma_u^*$ 的关键双激发）到无限阶来捕获一些静态相关，但它无法克服一个糟糕的初始参考态 $|\\Phi_0\\rangle$ 带来的定性失败。\n    - 计算的 EOM 部分，即 $|\\Psi_K\\rangle = \\hat{R}_K e^{\\hat{T}} |\\Phi_0\\rangle$，通过将线性激发算符 $\\hat{R}_K$ 应用于这个有缺陷的参考态来寻找其他电子态。通过将单、双激发算符 ($\\hat{R}_1, \\hat{R}_2$) 应用于一个单一且根本不正确的参考态 $|\\Phi_0\\rangle$ 所能达到的态空间，其灵活性不足以描述大 $R$ 时电子态的真实多参考性质。该方法试图使用一个为描述源于单组态参考态的单激发主导的态而设计的算符，来描述那些本质上由两个或更多主导组态构成的态。这导致了对势能面的不合物理的描述，常常出现人为的势垒或不正确的态序。\n\n总之，这种失败是使用基于单行列式参考态（RHF）的单参考方法（EOM-CCSD）来处理一个因强静态相关而本质上是多参考问题的直接后果。\n\n**逐项分析**\n\n*   **A. $\\text{F}_2$ 的解离表现出强烈的静态（非动态）相关和近简并性；精确的解离极限由对应于两个开壳层氟原子的多个行列式主导，因此单行列式 RHF 参考态和 EOM-CCSD 算符流形无法捕捉整个键断裂过程中所需的多参考特征。**\n    该陈述准确而全面地指出了问题的所有关键方面：强静态相关的存在、解离极限的多行列式性质、单行列式 RHF 参考态的不足，以及建立在该参考态之上的 EOM-CCSD 框架随之而来的失败。\n    **结论：正确。**\n\n*   **B. EOM-CCSD 不是尺寸一致的，因此即使对于没有显著近简并性的体系，它也必然会给出不正确的解离极限。**\n    这个说法不正确。用于计算激发能的 EOM-CCSD 是一种尺寸一致的方法。它在 $\\text{F}_2$ 解离案例中的失败不是由于普遍缺乏尺寸一致性，而是由于该体系特定的多参考特征。对于单参考描述仍然有效的键断裂过程（例如 $\\text{HeH}^+ \\to \\text{He} + \\text{H}^+$），EOM-CCSD 的表现可以令人满意。\n    **结论：错误。**\n\n*   **C. 基组不完备性误差在 $\\text{F}_2$ 中占主导地位，而像 EOM-CCSD 这样的相关方法在没有极大单电子基组的情况下无法弥补这一点；这种失败主要是一种基组人为效应，而不是相关问题。**\n    虽然基组不完备性是定量误差的一个来源，但所描述的问题是势能曲线形状上的*定性*失败。即使使用非常大的基组，这种定性失败仍然存在。其根本原因是该方法无法处理 N 电子静态相关效应，这与单电子基组问题是不同的。因此，将主要失败归咎于基组是不正确的。\n    **结论：错误。**\n\n*   **D. 失败完全是由于忽略了三重激发；即使单参考图像仍然有效，键断裂也普遍需要三重激发。**\n    这个说法有两个缺陷。首先，使用“完全”一词过于绝对。根本问题是单参考图像的失效，这比簇算符的截断级别更为根本。虽然包含三重激发（例如在 EOM-CCSDT 中）确实通过提供更多灵活性来描述静态相关，从而改善了对键拉伸的描述，但它并没有改变该方法基础的单参考性质。其次，“键断裂普遍需要三重激发”的说法是错误的。解离成闭壳层碎片的体系可以用 CCSD 水平很好地描述。是否需要更高阶激发是由电子结构决定的，而不是由键断裂过程本身普遍决定的。\n    **结论：错误。**\n\n*   **E. 失败完全是由于缺乏轨道弛豫；在每个 $R$ 处重新优化相同的 RHF 轨道 $|\\Phi_0\\rangle$ 就能在 EOM-CCSD 框架内解决这个问题。**\n    一个标准的势能面计算已经在每个几何点 $R$ 处重新优化了 RHF 轨道。问题不在于缺乏优化；问题在于，由于受到单行列式的限制，最优 RHF 解本身在大 $R$ 处就是定性错误的。在 RHF 框架内进行任何程度的重新优化都无法产生一个能正确描述两个分离的中性氟原子的波函数。轨道弛豫效应在耦合簇理论中也通过 $\\hat{T}_1$ 算符部分地得到考虑，但这不足以弥补零阶参考态的根本缺陷。\n    **结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2455482"}]}