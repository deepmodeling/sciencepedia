{"hands_on_practices": [{"introduction": "理论学习之后，最好的检验方法莫过于动手实践。让我们从一个看似简单的思想实验开始。这个练习旨在揭示执行单配置相互作用（CIS）计算的一个基本前提：必须存在可供电子跃迁的目标空间。通过思考在最小基组下对氦原子进行CIS计算的后果，你将深刻理解基组的选择如何从根本上决定了我们描述电子激发态的能力。[@problem_id:2452212]", "problem": "考虑一个氦原子，其原子序数 $Z=2$，电子数 $N=2$。使用一个包含 $M=1$ 个空间基函数的最小基组，在限制性 Hartree–Fock (RHF) 计算后，得到 $1$ 个在基态中被双占据的空间分子轨道。在组态相互作用单激发 (CIS) 方法中，该方法定义为在相对于 RHF 参考行列式的所有从占据自旋轨道到虚拟自旋轨道的单取代所张成的空间中，对电子哈密顿量进行对角化，请确定不同的 CIS 激发能的数量（即 CIS 哈密顿量的根的数量）。\n\n将您的答案以单个整数形式报告。不包含单位。无需四舍五入。", "solution": "该问题要求在特定约束条件下，对于氦原子，在组态相互作用单激发 (CIS) 框架内，确定可计算的激发态数量，或更准确地说，是不同激发能的数量。我们首先对所提供的信息进行系统分析。\n\n该系统是一个氦原子，其原子序数为 $Z=2$，电子数为 $N=2$。\n计算将使用一个包含 $M=1$ 个空间基函数的最小基组进行。\n\n根据分子轨道理论的原理，$M$ 个原子基函数的线性组合产生 $K=M$ 个分子轨道 (MO)。在这种情况下，当 $M=1$ 时，我们恰好得到 $K=1$ 个空间 MO。我们用 $\\phi_1$ 表示这个空间轨道。\n\n基态的电子构型由限制性 Hartree–Fock (RHF) 计算确定。对于一个有 $N=2$ 个电子的系统，根据 Pauli 不相容原理，基态构型涉及将两个电子以相反的自旋放入能量最低的空间 MO 中。由于只有一个空间 MO，即 $\\phi_1$，它必须被双占据。因此，RHF 基态的 Slater 行列式由下式给出：\n$$\n|\\Psi_0\\rangle = \\frac{1}{\\sqrt{2!}}\n\\begin{vmatrix}\n\\phi_1(1)\\alpha(1) & \\phi_1(1)\\beta(1) \\\\\n\\phi_1(2)\\alpha(2) & \\phi_1(2)\\beta(2)\n\\end{vmatrix}\n= |\\phi_1\\alpha \\, \\phi_1\\beta|\n$$\n这与问题陈述中 RHF 计算产生“$1$ 个在基态中被双占据的空间分子轨道”的说法一致。\n\n自旋轨道的总数为 $2K$。由于 $K=1$，我们总共有 $2 \\times 1 = 2$ 个自旋轨道。它们是 $\\chi_1 = \\phi_1\\alpha$ 和 $\\chi_2 = \\phi_1\\beta$。在 HF 基态 $|\\Psi_0\\rangle$ 中，这两个自旋轨道都被 $N=2$ 个电子占据。\n\n我们现在可以对 MO 进行分类：\n占据的空间 MO 数量为 $n_{occ} = \\frac{N}{2} = \\frac{2}{2} = 1$。\n虚拟（未占据）的空间 MO 数量为 $n_{virt} = K - n_{occ} = 1 - 1 = 0$。\n\nCIS 方法定义为在相对于 RHF 参考 $|\\Psi_0\\rangle$ 的所有单激发行列式所构成的子空间内，对哈密顿算符 $\\hat{H}$ 进行对角化。一个单激发行列式，记为 $|\\Psi_i^a\\rangle$，是通过将一个电子从占据的自旋轨道 $\\chi_i$ 提升到虚拟的自旋轨道 $\\chi_a$ 来创建的。\n\nCIS 激发态的集合被构建为所有可能的单激发行列式的线性组合：\n$$\n|\\Psi_{CIS}\\rangle = \\sum_{i \\in \\text{occ}} \\sum_{a \\in \\text{virt}} c_i^a |\\Psi_i^a\\rangle\n$$\n其中，系数 $c_i^a$ 和相应的激发能通过求解该基中哈密顿矩阵的本征值问题来找到。该矩阵的维数由可能的单激发数量确定。\n\n为了找到可能的单激发数量，我们必须计算占据和虚拟自旋轨道的数量。\n占据的自旋轨道数量 = $N = 2$。\n虚拟的自旋轨道数量 = (自旋轨道总数) - (占据的自旋轨道数量) = $2K - N = (2 \\times 1) - 2 = 0$。\n\n一次单激发需要将一个电子从一个占据的自旋轨道提升到一个虚拟的自旋轨道。这种唯一的单激发的总数是占据自旋轨道数量和虚拟自旋轨道数量的乘积。\n单激发数量 = (占据的自旋轨道数量) $\\times$ (虚拟的自旋轨道数量)\n$$\n\\text{Number of single excitations} = N \\times (2K - N) = 2 \\times 0 = 0\n$$\n或者，可以考虑空间轨道之间的提升。单重态单激发的数量是 $n_{occ} \\times n_{virt}$，三重态单激发的数量也是 $n_{occ} \\times n_{virt}$。\n在我们的情况下，$n_{occ} = 1$ 且 $n_{virt} = 0$。\n因此，可能的单重态激发数量是 $1 \\times 0 = 0$。\n可能的三重态激发数量是 $1 \\times 0 = 0$。\n单激发组态的总数是 $0$。\n\n由于没有虚拟轨道，无法从 RHF 基态形成任何单电子激发。单激发行列式的基组是空的。因此，这些行列式所张成的空间是零空间，其维数为 $0$。\n\nCIS 哈密顿矩阵是在这个基上构建的。一个 $0$ 维空间的矩阵是一个 $0 \\times 0$ 的矩阵。一个 $0 \\times 0$ 的矩阵没有元素，因此它没有本征值（根）。CIS 激发能正是这些本征值。\n\n由于没有本征值，不同的 CIS 激发能的数量是 $0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "2452212"}, {"introduction": "在光化学和光谱学中，一个核心概念是单重态和三重态激发的能量差，即所谓的单重-三重态分裂。这个练习将引导你通过第一性原理推导，揭示在CIS理论框架下这一能量分裂的物理起源。通过手动计算，你将证明该分裂值精确等于两倍的交换积分（$2K_{ia}$），从而将一个宏观可测量的量与一个纯粹的量子力学效应联系起来。[@problem_id:2452219]", "problem": "考虑一个在 Born–Oppenheimer 近似和非相对论近似下描述的闭壳层体系，其参考态为由一组正交归一的实空间轨道 $\\{\\phi_{p}\\}$ 构建的限制性 Hartree–Fock 行列式。设 $\\phi_{i}$ 为一个占据空间轨道，$\\phi_{a}$ 为一个虚拟空间轨道。在组态相互作用单激发 (Configuration Interaction Singles, CIS) 框架内，重点关注由两个单激发 Slater 行列式张成的子空间，在这两个行列式中，一个电子分别以 $\\alpha$ 自旋或 $\\beta$ 自旋从 $\\phi_{i}$ 跃迁到 $\\phi_{a}$。从这两个行列式出发，构建总自旋 $S=0$（单重态）和 $S=1$（三重态，其中 $M_{S}=0$）的自旋匹配组态态函数 (CSFs)。使用标准电子哈密顿量 $\\hat{H}=\\sum_{k}\\hat{h}(k)+\\sum_{k<l}r_{kl}^{-1}$，并且在 CIS 和给定假设之外不引入任何其他近似，求解此单激发 $i \\to a$ 的单重态-三重态能量分裂\n$$\\Delta E_{ST} \\equiv E_{S}-E_{T}$$\n并将你的最终结果纯粹用交换积分\n$$K_{ia} \\equiv \\int\\!\\!\\!\\int \\phi_{i}(\\mathbf{r}_{1})\\,\\phi_{a}(\\mathbf{r}_{1})\\,\\frac{1}{r_{12}}\\,\\phi_{a}(\\mathbf{r}_{2})\\,\\phi_{i}(\\mathbf{r}_{2})\\,d\\mathbf{r}_{1}\\,d\\mathbf{r}_{2}$$\n来表示。请提供一个仅含 $K_{ia}$ 的 $\\Delta E_{ST}$ 的单闭合形式解析表达式。不要引入任何其他量。答案应为精确表达式；无需四舍五-入，也不应报告单位。", "solution": "在尝试解答之前，需对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 体系：一个闭壳层体系。\n- 近似：Born–Oppenheimer 近似和非相对论近似。\n- 参考波函数：一个限制性 Hartree–Fock (RHF) 行列式。\n- 轨道：一组正交归一的实空间轨道 $\\{\\phi_{p}\\}$。\n- 轨道定义：$\\phi_{i}$ 是占据空间轨道；$\\phi_{a}$ 是虚拟空间轨道。\n- 方法：组态相互作用单激发 (CIS)。\n- 激发态基组：该子空间由来自激发 $\\phi_{i} \\to \\phi_{a}$ 的两个单激发 Slater 行列式张成，其自旋分别为 $\\alpha$ 和 $\\beta$。\n- 任务：为单重态 ($S=0$) 和三重态 ($S=1$, $M_S=0$) 构建自旋匹配的组态态函数 (CSFs)。\n- 哈密顿量：电子哈密顿量为 $\\hat{H}=\\sum_{k}\\hat{h}(k)+\\sum_{k<l}r_{kl}^{-1}$。\n- 目标：确定激发 $i \\to a$ 的单重态-三重态能量分裂，定义为 $\\Delta E_{ST} \\equiv E_{S}-E_{T}$。\n- 约束：最终结果必须纯粹用交换积分 $K_{ia} \\equiv \\int\\!\\!\\!\\int \\phi_{i}(\\mathbf{r}_{1})\\,\\phi_{a}(\\mathbf{r}_{1})\\,\\frac{1}{r_{12}}\\,\\phi_{a}(\\mathbf{r}_{2})\\,\\phi_{i}(\\mathbf{r}_{2})\\,d\\mathbf{r}_{1}\\,d\\mathbf{r}_{2}$ 表示。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，是量子化学中一个涉及使用成熟的 CIS 方法描述电子激发态的标准练习。问题提法恰当，有明确的目标和足够的信息来推导出唯一解。语言客观而精确。问题本身是自洽的，没有矛盾或不科学的前提。\n\n**步骤3：结论与行动**\n问题有效。将提供解答。\n\n在 CIS 近似中，激发态的能量由 $E = E_0 + \\omega$ 给出，其中 $E_0$ 是 Hartree–Fock 基态行列式 $|\\Psi_0\\rangle$ 的能量，$\\omega$ 是激发能，通过求解 CIS 矩阵 $\\mathbf{A}$ 的本征值得出。CIS 矩阵的矩阵元由 $A_{ia,jb} = \\langle \\Psi_i^a | \\hat{H} | \\Psi_j^b \\rangle - \\delta_{ij}\\delta_{ab} E_0$ 给出，其中 $|\\Psi_i^a\\rangle$ 代表一个单激发组态。\n\n该问题要求为由空间轨道 $\\phi_i$ 到 $\\phi_a$ 的单激发产生的单重态 ($S=0$) 和三重态 ($S=1$) 构建自旋匹配的 CSF。对于闭壳层 RHF 参考，基态行列式 $|\\Psi_0\\rangle$ 是一个单重态。哈密顿量 $\\hat{H}$ 与自旋无关，因此不会混合不同总自旋的态。因此，在自旋匹配的基中，CIS 矩阵是块对角的，具有分别对应单重态和三重态的独立块。\n\n我们只关心特定激发 $i \\to a$ 的子空间。这使得问题简化为求解 CIS 矩阵的单重态和三重态块的对角元，这些对角元对应于该激发的纯单重态和纯三重态的能量。\n\n让我们为 $i \\to a$ 激发定义自旋匹配的 CSF。使用 $|{}^S\\Psi_i^a\\rangle$ 表示由激发 $i \\to a$ 产生的总自旋为 $S$ 的 CSF：\n- 单重态 CSF ($S=0$, $M_S=0$) 记作 $|{}^1\\Psi_i^a\\rangle$。\n- 三重态 CSF ($S=1$, $M_S=0$) 记作 $|{}^3\\Psi_i^a\\rangle$。\n\n这些态的激发能由哈密顿量相对于基态能量 $E_0$ 的期望值给出。\n单重态激发能 $\\omega_S$ 为：\n$$ \\omega_S = \\langle {}^1\\Psi_i^a | \\hat{H} - E_0 | {}^1\\Psi_i^a \\rangle $$\n三重态激发能 $\\omega_T$ 为：\n$$ \\omega_T = \\langle {}^3\\Psi_i^a | \\hat{H} - E_0 | {}^3\\Psi_i^a \\rangle $$\n\n使用 Slater–Condon 规则来计算这些对于闭壳层 RHF 参考的矩阵元，在自旋匹配的基中 CIS 矩阵对角元的一般表达式是众所周知的。对于从轨道 $\\phi_i$ 到 $\\phi_a$ 的激发：\n单重态激发能为：\n$$ \\omega_S = \\epsilon_a - \\epsilon_i - J_{ia} + 2K_{ia} $$\n三重态激发能为：\n$$ \\omega_T = \\epsilon_a - \\epsilon_i - J_{ia} $$\n此处，$\\epsilon_p$ 是空间轨道 $\\phi_p$ 的正则 Hartree–Fock 轨道能。$J_{ia}$ 和 $K_{ia}$ 项分别是空间轨道 $\\phi_i$ 和 $\\phi_a$ 之间的库仑积分和交换积分。它们的定义如下：\n$$ J_{ia} = \\int\\!\\!\\!\\int \\phi_{i}(\\mathbf{r}_{1})\\,\\phi_{i}(\\mathbf{r}_{1})\\,\\frac{1}{r_{12}}\\,\\phi_{a}(\\mathbf{r}_{2})\\,\\phi_{a}(\\mathbf{r}_{2})\\,d\\mathbf{r}_{1}\\,d\\mathbf{r}_{2} $$\n$$ K_{ia} = \\int\\!\\!\\!\\int \\phi_{i}(\\mathbf{r}_{1})\\,\\phi_{a}(\\mathbf{r}_{1})\\,\\frac{1}{r_{12}}\\,\\phi_{a}(\\mathbf{r}_{2})\\,\\phi_{i}(\\mathbf{r}_{2})\\,d\\mathbf{r}_{1}\\,d\\mathbf{r}_{2} $$\n问题陈述中提供的 $K_{ia}$ 定义与此对实轨道的标准定义是一致的。\n\n那么，单重态和三重态激发态的总能量 $E_S$ 和 $E_T$ 分别是：\n$$ E_S = E_0 + \\omega_S = E_0 + \\epsilon_a - \\epsilon_i - J_{ia} + 2K_{ia} $$\n$$ E_T = E_0 + \\omega_T = E_0 + \\epsilon_a - \\epsilon_i - J_{ia} $$\n\n目标是求出单重态-三重态能量分裂 $\\Delta E_{ST} = E_S - E_T$。我们通过计算这两个总能量表达式的差来得出：\n$$ \\Delta E_{ST} = (E_0 + \\epsilon_a - \\epsilon_i - J_{ia} + 2K_{ia}) - (E_0 + \\epsilon_a - \\epsilon_i - J_{ia}) $$\n涉及基态能量 $E_0$、轨道能 $\\epsilon_a$ 和 $\\epsilon_i$ 以及库仑积分 $J_{ia}$ 的项相互抵消：\n$$ \\Delta E_{ST} = E_0 - E_0 + (\\epsilon_a - \\epsilon_i) - (\\epsilon_a - \\epsilon_i) - J_{ia} - (-J_{ia}) + 2K_{ia} $$\n$$ \\Delta E_{ST} = 0 + 0 - J_{ia} + J_{ia} + 2K_{ia} $$\n这就得出了能量分裂的最终表达式：\n$$ \\Delta E_{ST} = 2K_{ia} $$\n这个结果，被称为分子中的 Hund 定则，表明对于一个激发组态，三重态的能量比单重态低，其能量差等于两倍的交换积分，因为 $K_{ia}$ 是一个正定值。该结果仅取决于 $K_{ia}$，正如问题陈述所要求的。", "answer": "$$\\boxed{2K_{ia}}$$", "id": "2452219"}, {"introduction": "现在，让我们将前面学到的理论片段整合起来，解决一个更接近真实计算化学研究的实践问题。在这个练习中，你将不再只处理单个矩阵元素或理论推导，而是要为一个包含多个激发组态的模型体系，亲手构建并对角化完整的CIS哈密顿矩阵。通过编写代码实现这一过程，你不仅能加深对CIS矩阵元素公式的理解，还能直观地看到不同组态之间的相互作用（混合）如何最终决定了激发态的能量和性质。[@problem_id:2452247]", "problem": "给定一个双电子体系的闭壳层限制性Hartree-Fock (RHF) 参考态，该体系有四个空间轨道，索引为 $0,1,2,3$。组态相互作用单激发 (CIS) 空间由自旋匹配的单激发组态构成，这些组态是通过将一个电子从双占据轨道 $i=0$（唯一的占据空间轨道）激发到虚空间轨道 $a \\in \\{1,2,3\\}$ 之一而得到的。用 $\\{\\varepsilon_p\\}_{p=0}^{3}$ 表示以哈特里（Hartree）为单位的正则RHF轨道能，用化学家标记法 $(pq \\mid rs)$ 表示空间轨道上的双电子库仑积分，其具有标准的置换对称性 $(pq \\mid rs)=(qp \\mid rs)=(pq \\mid sr)=(rs \\mid pq)$ 且 $(pq \\mid rs) \\in \\mathbb{R}$。所有未指定的双电子积分均为零。请使用基本的Slater-Condon规则，应用于RHF参考态和给定的一电子和双电子数据，构建在单重态和三重态子空间中的自旋匹配组态相互作用单激发 (CIS) 哈密顿矩阵。对角化每个矩阵，并报告每个自旋流形中的最低激发能。\n\n使用以下三个独立的测试用例（每个定义一个体系）。在每个用例中，电子数为 $N=2$，空间轨道数为 $M=4$，占据轨道索引集为 $\\{0\\}$，虚轨道索引集为 $\\{1,2,3\\}$。能量必须以哈特里为单位报告，并四舍五入到六位小数。\n\n测试用例 A：\n- 轨道能 (Hartree): $[\\,-0.9,\\;0.1,\\;0.3,\\;0.6\\,]$。\n- 非零双电子积分 $(pq \\mid rs)$ (Hartree):\n  - $(1,0 \\mid 0,1)=0.15$,\n  - $(2,0 \\mid 0,2)=0.12$,\n  - $(3,0 \\mid 0,3)=0.10$,\n  - $(1,1 \\mid 0,0)=0.20$,\n  - $(2,2 \\mid 0,0)=0.18$,\n  - $(3,3 \\mid 0,0)=0.16$。\n\n测试用例 B：\n- 轨道能 (Hartree): $[\\,-1.0,\\;0.0,\\;0.5,\\;1.0\\,]$。\n- 未提供非零双电子积分；取所有 $(pq \\mid rs)=0$。\n\n测试用例 C：\n- 轨道能 (Hartree): $[\\,-0.8,\\;0.0,\\;0.0,\\;0.4\\,]$。\n- 非零双电子积分 (Hartree):\n  - $(1,0 \\mid 0,1)=0.20$,\n  - $(2,0 \\mid 0,2)=0.20$,\n  - $(3,0 \\mid 0,3)=0.05$,\n  - $(1,1 \\mid 0,0)=0.25$,\n  - $(2,2 \\mid 0,0)=0.25$,\n  - $(3,3 \\mid 0,0)=0.10$,\n  - $(1,2 \\mid 0,0)=0.05$。\n\n您的程序必须：\n- 使用上述指定的RHF轨道能和双电子积分，为每个测试用例构建自旋匹配的单重态和三重态CIS哈密顿矩阵，并强制执行 $(pq \\mid rs)$ 的完整化学家标记法对称性。\n- 对角化每个哈密顿矩阵，并提取单重态的最低本征值（以哈特里为单位）和三重态的最低本征值（以哈特里为单位）。\n\n最终输出格式要求：\n- 生成单行输出，包含一个含有六个浮点数的列表，单位为哈特里，四舍五入到六位小数，顺序为 $[E_{\\mathrm{S},A},E_{\\mathrm{T},A},E_{\\mathrm{S},B},E_{\\mathrm{T},B},E_{\\mathrm{S},C},E_{\\mathrm{T},C}]$，其中 $E_{\\mathrm{S},X}$ 和 $E_{\\mathrm{T},X}$ 分别表示测试用例 $X \\in \\{A,B,C\\}$ 的最低单重态和三重态CIS激发能。例如，输出应类似于 $[x_1,x_2,x_3,x_4,x_5,x_6]$。", "solution": "该问题在科学和数学上是适定的，代表了计算量子化学中组态相互作用单激发 (CIS) 方法的标准应用。我们将进行推导和求解。\n\n基础态是双电子体系的闭壳层限制性Hartree-Fock (RHF) 基态 $|\\Psi_0\\rangle$，其中两个电子都占据能量最低的空间轨道 $\\phi_0$。RHF波函数是对应于组态 $(0\\alpha)(0\\beta)$ 的单个Slater行列式。其余的空间轨道 $\\{\\phi_a\\}_{a=1}^3$ 是虚轨道（未占据）。\n\nCIS方法将激发态近似为所有单激发组态的线性组合。对于该体系，单激发将一个电子从占据轨道 $\\phi_0$ 提升到虚轨道 $\\phi_a$，其中 $a \\in \\{1, 2, 3\\}$。为确保得到的波函数是自旋算符 $\\hat{S}^2$ 的本征函数，我们构建了行列式态的自旋匹配线性组合。CIS展开的基函数是：\n\n对于激发 $0 \\to a$ 的单重态 ($S=0$) 组态：\n$$ |^1\\Psi_0^a\\rangle = \\frac{1}{\\sqrt{2}} \\left( |\\Psi_{0\\alpha}^{a\\alpha}\\rangle + |\\Psi_{0\\beta}^{a\\beta}\\rangle \\right) $$\n对于激发 $0 \\to a$ 的三重态 ($S=1, M_S=0$) 组态：\n$$ |^3\\Psi_0^a\\rangle = \\frac{1}{\\sqrt{2}} \\left( |\\Psi_{0\\alpha}^{a\\alpha}\\rangle - |\\Psi_{0\\beta}^{a\\beta}\\rangle \\right) $$\n其中 $|\\Psi_{i\\sigma}^{p\\sigma}\\rangle$ 表示一个Slater行列式，其中一个自旋为 $\\sigma$ 的电子从轨道 $\\phi_i$ 激发到轨道 $\\phi_p$。由于电子哈密顿算符 $\\hat{H}$ 不含自旋，三重态分量 $M_S = \\pm 1$ 的能量与 $M_S=0$ 分量的能量是简并的。\n\nCIS激发能是在这些自旋匹配组态基上构建的哈密顿矩阵的本征值。矩阵元由 $\\langle \\Psi_0^a | \\hat{H} - E_0 | \\Psi_0^b \\rangle$ 给出，其中 $E_0 = \\langle \\Psi_0 | \\hat{H} | \\Psi_0 \\rangle$ 是RHF基态能量。应用Slater-Condon规则，并使用正则Hartree-Fock轨道能 $\\varepsilon_p$ 和化学家标记法表示的双电子排斥积分 $(pq|rs)$，我们推导出单重态 ($\\mathbf{A}^S$) 和三重态 ($\\mathbf{A}^T$) 多重度下CIS矩阵的矩阵元表达式。索引 $a, b$ 遍历虚轨道 $\\{1, 2, 3\\}$。\n\n单重态CIS矩阵元由下式给出：\n$$ A^S_{ab} = \\langle ^1\\Psi_0^a | \\hat{H} - E_0 | ^1\\Psi_0^b \\rangle = \\delta_{ab}(\\varepsilon_a - \\varepsilon_0) + 2(0a|0b) - (00|ab) $$\n对角元 ($a=b$) 变为：\n$$ A^S_{aa} = (\\varepsilon_a - \\varepsilon_0) + 2(0a|0a) - (00|aa) = \\varepsilon_a - \\varepsilon_0 - J_{0a} + 2K_{0a} $$\n其中 $J_{0a}=(00|aa)$ 是轨道 $\\phi_0$ 和 $\\phi_a$ 之间的库仑积分，$K_{0a}=(0a|0a)$ 是交换积分。\n\n三重态CIS矩阵元由下式给出：\n$$ A^T_{ab} = \\langle ^3\\Psi_0^a | \\hat{H} - E_0 | ^3\\Psi_0^b \\rangle = \\delta_{ab}(\\varepsilon_a - \\varepsilon_0) - (00|ab) $$\n对角元 ($a=b$) 变为：\n$$ A^T_{aa} = (\\varepsilon_a - \\varepsilon_0) - (00|aa) = \\varepsilon_a - \\varepsilon_0 - J_{0a} $$\n双电子积分 $(pq|rs)$ 是实数，并具有8重置换对称性：$(pq|rs) = (qp|rs) = (pq|sr) = (rs|pq)$ 等。我们必须使用这些对称性从给定的列表中计算所需的积分。所有未指定的积分均为零。\n\n现在我们为每个测试用例构建并对角化这些 $3 \\times 3$ 的矩阵。\n\n**测试用例 A**\n- 轨道能: $\\varepsilon = [-0.9, 0.1, 0.3, 0.6]$ Hartree。\n- 双电子积分: $(10|01)=0.15$, $(20|02)=0.12$, $(30|03)=0.10$, $(11|00)=0.20$, $(22|00)=0.18$, $(33|00)=0.16$ Hartree。\n- 使用对称性: $(01|10)=(10|01)=0.15$, $(00|11)=(11|00)=0.20$ 等。以及 $(0a|0a)=(a0|0a)$。\n\n单重态CIS矩阵 $\\mathbf{A}^S$:\n$A^S_{11} = (\\varepsilon_1 - \\varepsilon_0) - (00|11) + 2(01|01) = (0.1 - (-0.9)) - 0.20 + 2(0.15) = 1.0 - 0.20 + 0.30 = 1.10$。\n$A^S_{22} = (\\varepsilon_2 - \\varepsilon_0) - (00|22) + 2(02|02) = (0.3 - (-0.9)) - 0.18 + 2(0.12) = 1.2 - 0.18 + 0.24 = 1.26$。\n$A^S_{33} = (\\varepsilon_3 - \\varepsilon_0) - (00|33) + 2(03|03) = (0.6 - (-0.9)) - 0.16 + 2(0.10) = 1.5 - 0.16 + 0.20 = 1.54$。\n非对角元 $A^S_{ab} = 2(0a|0b) - (00|ab)$ 为$0$，因为所有必需的积分如 $(01|02)$ 和 $(00|12)$ 都为零。\n该矩阵是对角矩阵：\n$$ \\mathbf{A}^S = \\begin{pmatrix} 1.10 & 0 & 0 \\\\ 0 & 1.26 & 0 \\\\ 0 & 0 & 1.54 \\end{pmatrix} $$\n本征值即为对角元。最低单重态激发能是 $E_{\\mathrm{S},A} = 1.10$ Hartree。\n\n三重态CIS矩阵 $\\mathbf{A}^T$:\n$A^T_{11} = (\\varepsilon_1 - \\varepsilon_0) - (00|11) = 1.0 - 0.20 = 0.80$。\n$A^T_{22} = (\\varepsilon_2 - \\varepsilon_0) - (00|22) = 1.2 - 0.18 = 1.02$。\n$A^T_{33} = (\\varepsilon_3 - \\varepsilon_0) - (00|33) = 1.5 - 0.16 = 1.34$。\n非对角元 $A^T_{ab} = -(00|ab)$ 为$0$。\n该矩阵是对角矩阵：\n$$ \\mathbf{A}^T = \\begin{pmatrix} 0.80 & 0 & 0 \\\\ 0 & 1.02 & 0 \\\\ 0 & 0 & 1.34 \\end{pmatrix} $$\n最低三重态激发能是 $E_{\\mathrm{T},A} = 0.80$ Hartree。\n\n**测试用例 B**\n- 轨道能: $\\varepsilon = [-1.0, 0.0, 0.5, 1.0]$ Hartree。\n- 所有双电子积分 $(pq|rs)=0$。\n\n由于所有积分项均为零，矩阵变为对角矩阵。\n$A^S_{ab} = A^T_{ab} = \\delta_{ab}(\\varepsilon_a - \\varepsilon_0)$。\n$A^S_{11} = A^T_{11} = \\varepsilon_1 - \\varepsilon_0 = 0.0 - (-1.0) = 1.0$。\n$A^S_{22} = A^T_{22} = \\varepsilon_2 - \\varepsilon_0 = 0.5 - (-1.0) = 1.5$。\n$A^S_{33} = A^T_{33} = \\varepsilon_3 - \\varepsilon_0 = 1.0 - (-1.0) = 2.0$。\n最低单重态激发能是 $E_{\\mathrm{S},B} = 1.0$ Hartree。\n最低三重态激发能是 $E_{\\mathrm{T},B} = 1.0$ Hartree。\n\n**测试用例 C**\n- 轨道能: $\\varepsilon = [-0.8, 0.0, 0.0, 0.4]$ Hartree。注意简并性 $\\varepsilon_1 = \\varepsilon_2$。\n- 双电子积分: $(10|01)=0.20$, $(20|02)=0.20$, $(30|03)=0.05$, $(11|00)=0.25$, $(22|00)=0.25$, $(33|00)=0.10$, $(12|00)=0.05$ Hartree。\n\n单重态CIS矩阵 $\\mathbf{A}^S$:\n$A^S_{11} = (0.0 - (-0.8)) - 0.25 + 2(0.20) = 0.8 - 0.25 + 0.40 = 0.95$。\n$A^S_{22} = (0.0 - (-0.8)) - 0.25 + 2(0.20) = 0.8 - 0.25 + 0.40 = 0.95$。\n$A^S_{33} = (0.4 - (-0.8)) - 0.10 + 2(0.05) = 1.2 - 0.10 + 0.10 = 1.20$。\n$A^S_{12} = 2(01|02) - (00|12) = 2(0) - (12|00) = -0.05$。$A^S_{21} = A^S_{12}$。\n所有其他非对角元均为零。\n$$ \\mathbf{A}^S = \\begin{pmatrix} 0.95 & -0.05 & 0 \\\\ -0.05 & 0.95 & 0 \\\\ 0 & 0 & 1.20 \\end{pmatrix} $$\n该矩阵是块对角矩阵。一个本征值是 $1.20$。左上角 $2 \\times 2$ 块的本征值是 $(0.95-\\lambda)^2 - (-0.05)^2 = 0$ 的解，得到 $\\lambda = 0.95 \\mp 0.05$。本征值为 $0.90$ 和 $1.00$。\n完整的本征值集合是 $\\{0.90, 1.00, 1.20\\}$。最低的是 $E_{\\mathrm{S},C} = 0.90$ Hartree。\n\n三重态CIS矩阵 $\\mathbf{A}^T$:\n$A^T_{11} = (0.0 - (-0.8)) - 0.25 = 0.55$。\n$A^T_{22} = (0.0 - (-0.8)) - 0.25 = 0.55$。\n$A^T_{33} = (0.4 - (-0.8)) - 0.10 = 1.10$。\n$A^T_{12} = -(00|12) = -(12|00) = -0.05$。$A^T_{21} = A^T_{12}$。\n所有其他非对角元均为零。\n$$ \\mathbf{A}^T = \\begin{pmatrix} 0.55 & -0.05 & 0 \\\\ -0.05 & 0.55 & 0 \\\\ 0 & 0 & 1.10 \\end{pmatrix} $$\n一个本征值是 $1.10$。$2 \\times 2$ 块的本征值是 $(0.55-\\lambda)^2 - (-0.05)^2 = 0$ 的解，得到 $\\lambda = 0.55 \\mp 0.05$。本征值为 $0.50$ 和 $0.60$。\n完整的本征值集合是 $\\{0.50, 0.60, 1.10\\}$。最低的是 $E_{\\mathrm{T},C} = 0.50$ Hartree。\n\n结果总结：\n- 测试用例 A: $E_{\\mathrm{S},A} = 1.100000$, $E_{\\mathrm{T},A} = 0.800000$ Hartree。\n- 测试用例 B: $E_{\\mathrm{S},B} = 1.000000$, $E_{\\mathrm{T},B} = 1.000000$ Hartree。\n- 测试用例 C: $E_{\\mathrm{S},C} = 0.900000$, $E_{\\mathrm{T},C} = 0.500000$ Hartree。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the lowest singlet and triplet CIS excitation energies for three test cases.\n    \"\"\"\n    test_cases = [\n        {\n            'name': 'A',\n            'eps': np.array([-0.9, 0.1, 0.3, 0.6]),\n            'integrals': {\n                (1, 0, 0, 1): 0.15,\n                (2, 0, 0, 2): 0.12,\n                (3, 0, 0, 3): 0.10,\n                (1, 1, 0, 0): 0.20,\n                (2, 2, 0, 0): 0.18,\n                (3, 3, 0, 0): 0.16,\n            }\n        },\n        {\n            'name': 'B',\n            'eps': np.array([-1.0, 0.0, 0.5, 1.0]),\n            'integrals': {}\n        },\n        {\n            'name': 'C',\n            'eps': np.array([-0.8, 0.0, 0.0, 0.4]),\n            'integrals': {\n                (1, 0, 0, 1): 0.20,\n                (2, 0, 0, 2): 0.20,\n                (3, 0, 0, 3): 0.05,\n                (1, 1, 0, 0): 0.25,\n                (2, 2, 0, 0): 0.25,\n                (3, 3, 0, 0): 0.10,\n                (1, 2, 0, 0): 0.05,\n            }\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        eps = case['eps']\n        raw_integrals = case['integrals']\n\n        # Pre-process integrals to handle 8-fold symmetry\n        integral_map = {}\n        for (p, q, r, s), val in raw_integrals.items():\n            p_s, q_s = sorted((p, q))\n            r_s, s_s = sorted((r, s))\n            \n            pair1 = (p_s, q_s)\n            pair2 = (r_s, s_s)\n            \n            if pair1 > pair2:\n                pair1, pair2 = pair2, pair1\n            \n            key = (pair1[0], pair1[1], pair2[0], pair2[1])\n            integral_map[key] = val\n\n        def get_integral(p, q, r, s):\n            p_s, q_s = sorted((p, q))\n            r_s, s_s = sorted((r, s))\n            \n            pair1 = (p_s, q_s)\n            pair2 = (r_s, s_s)\n            \n            if pair1 > pair2:\n                pair1, pair2 = pair2, pair1\n            \n            key = (pair1[0], pair1[1], pair2[0], pair2[1])\n            return integral_map.get(key, 0.0)\n\n        # CIS implementation\n        # Occupied orbital is always index 0\n        i_occ = 0\n        # Virtual orbitals are indices 1, 2, 3\n        virt_indices = [1, 2, 3]\n        n_virt = len(virt_indices)\n        \n        A_S = np.zeros((n_virt, n_virt))\n        A_T = np.zeros((n_virt, n_virt))\n\n        for idx_a, a in enumerate(virt_indices):\n            for idx_b, b in enumerate(virt_indices):\n                # Orbital energy difference term\n                delta_eps = eps[a] - eps[i_occ] if a == b else 0.0\n\n                # Integral terms\n                # For singlet: 2*(0a|0b) - (00|ab)\n                int_s1 = 2 * get_integral(i_occ, a, i_occ, b)\n                int_s2 = -1 * get_integral(i_occ, i_occ, a, b)\n                \n                # For triplet: -(00|ab)\n                int_t = -1 * get_integral(i_occ, i_occ, a, b)\n\n                # Assemble matrix elements\n                A_S[idx_a, idx_b] = delta_eps + int_s1 + int_s2\n                A_T[idx_a, idx_b] = delta_eps + int_t\n\n        # Diagonalize and find the lowest eigenvalue\n        eigvals_s = np.linalg.eigh(A_S)[0]\n        eigvals_t = np.linalg.eigh(A_T)[0]\n\n        lowest_s = np.min(eigvals_s)\n        lowest_t = np.min(eigvals_t)\n\n        results.extend([lowest_s, lowest_t])\n\n    # Format the final output\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2452247"}]}