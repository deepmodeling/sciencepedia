{"hands_on_practices": [{"introduction": "在量子世界中，分子即使在绝对零度下也永不静止，这归因于其零点振动能（Zero-Point Vibrational Energy, ZPVE）。本练习将带你亲手计算 ZPVE，并理解一个关键的光谱现象——同位素效应。通过比较甲烷 ($CH_4$) 与其氘代物 ($CD_4$)，我们将直接量化原子质量对分子振动能的影响 [@problem_id:2462149]。", "problem": "您的任务是在谐振近似下，计算氢代甲烷（CH$_4$）和全氘代甲烷（CD$_4$）的零点振动能（ZPVE），并量化其差异。零点振动能（ZPVE）从第一性原理定义如下。对于频率为 $\\nu_i$ 的单个谐振简正模，量子化能级为 $E_v = h \\nu_i \\left(v + \\frac{1}{2}\\right)$，其中 $v = 0, 1, 2, \\dots$。对于一个具有由 $i$ 索引的独立简正模及其简并度 $g_i$ 的多原子分子，每个分子的零点（基态，所有 $v_i = 0$）振动能为\n$$\nE_0 = \\frac{1}{2} \\sum_i g_i \\, h \\, \\nu_i,\n$$\n其中 $\\nu_i$ 是普通频率，单位为 $\\mathrm{s}^{-1}$。如果模式频率以波数 $\\tilde{\\nu}_i$（单位为 $\\mathrm{cm}^{-1}$）指定，则 $\\nu_i = c \\times \\tilde{\\nu}_i$，其中 $c$ 的单位为 $\\mathrm{cm}\\,\\mathrm{s}^{-1}$，或者等效地，当 $c$ 的单位为 $\\mathrm{cm}\\,\\mathrm{s}^{-1}$ 时，$E_0 = \\frac{1}{2} h c \\sum_i g_i \\tilde{\\nu}_i$。\n\n假设 Born–Oppenheimer 近似成立，且谐和力常数不因同位素取代而改变。在此假设下，当用氘取代氢时，简正模频率因质量变化而标度伸缩。使用局部质量标度近似，使得 CD$_4$ 中的所有 CH$_4$ 简正模均按一个单一因子进行标度伸缩\n$$\ns = \\sqrt{\\frac{m_\\mathrm{H}}{m_\\mathrm{D}}},\n$$\n其中 $m_\\mathrm{H}$ 是氢的原子质量，$m_\\mathrm{D}$ 是氘的原子质量。\n\n使用以下数据和常数：\n- 原子质量：$m_\\mathrm{H} = 1.00782503223\\,\\mathrm{u}$ 和 $m_\\mathrm{D} = 2.01410177812\\,\\mathrm{u}$。\n- 光速：$c = 299{,}792{,}458\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n- 普朗克常数：$h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J}\\,\\mathrm{s}$。\n- 阿伏伽德罗常数：$N_\\mathrm{A} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$。\n\n使用以下 CH$_4$ 简正模（近似谐振波数）及其简并度（所有波数单位均为 $\\mathrm{cm}^{-1}$）：\n- $\\tilde{\\nu}_1 = 2917.0$，简并度 $g_1 = 1$，\n- $\\tilde{\\nu}_2 = 1534.0$，简并度 $g_2 = 2$，\n- $\\tilde{\\nu}_3 = 3019.0$，简并度 $g_3 = 3$，\n- $\\tilde{\\nu}_4 = 1306.0$，简并度 $g_4 = 3$。\n\n任务及要求输出：\n- 以千焦/摩尔（kJ mol$^{-1}$）为单位计算 CH$_4$ 的 ZPVE，结果四舍五入至三位小数。\n- 通过将每个 CH$_4$ 波数乘以以上因子 $s$，以千焦/摩尔（kJ mol$^{-1}$）为单位计算 CD$_4$ 的 ZPVE，结果四舍五入至三位小数。\n- 计算无量纲比率 $R = \\mathrm{ZPVE}(\\mathrm{CD}_4)/\\mathrm{ZPVE}(\\mathrm{CH}_4)$，结果四舍五入至六位小数。\n- 计算差值 $\\Delta = \\mathrm{ZPVE}(\\mathrm{CH}_4) - \\mathrm{ZPVE}(\\mathrm{CD}_4)$，单位为千焦/摩尔（kJ mol$^{-1}$），结果四舍五入至三位小数。\n- 提供一个布尔一致性标志，如果 $\\left|R - s\\right| < 10^{-12}$ 则其值为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。\n\n单位要求：所有能量必须按规定以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 表示。不涉及角度。\n\n测试套件与覆盖范围：\n- 上述 CH$_4$ 数据构成了一个具有多重简并度的典型多原子分子的基本案例。\n- 由质量标度因子 $s$ 生成的 CD$_4$ 结果用于测试同位素取代效应。\n- 比率 $R$ 用于测试在统一频率标度伸缩下 ZPVE 的正比性。\n- 差值 $\\Delta$ 用于量化同位素取代的绝对能量效应。\n- 布尔一致性标志用于在一个严格的容差范围内测试数值稳定性是否符合理论标度预测。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序如下：\n$[$ZPVE\\_CH4\\_kJmol, ZPVE\\_CD4\\_kJmol, R, Delta\\_kJmol, consistency\\_flag$]$。", "solution": "该问题陈述已经过验证，被认为是科学上可靠、定义明确且客观的。它展示了一个计算物理化学中的标准练习，涉及零点振动能及其对同位素质量依赖性的计算。所有必要的数据、常数和明确的目标均已提供。我们可以开始求解。\n\n在谐振近似下，一个多原子物质的每个分子的零点振动能（$\\mathrm{ZPVE}$）由以下公式给出：\n$$E_0 = \\frac{1}{2} \\sum_i g_i h \\nu_i$$\n其中 $g_i$ 是第 $i$ 个简正模的简并度，$h$ 是普朗克常数，$\\nu_i$ 是该模式的频率，单位为 $\\mathrm{s}^{-1}$。当使用波数 $\\tilde{\\nu}_i$（单位为 $\\mathrm{cm}^{-1}$）时，频率为 $\\nu_i = c \\tilde{\\nu}_i$，其中 $c$ 是光速。方程变为：\n$$E_0 = \\frac{1}{2} h c \\sum_i g_i \\tilde{\\nu}_i$$\n为了得到以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位的摩尔 $\\mathrm{ZPVE}$，我们必须乘以阿伏伽德罗常数 $N_\\mathrm{A}$ 并将焦耳转换为千焦。确保单位一致性至关重要。给定 $h$ 单位为 $\\mathrm{J}\\,\\mathrm{s}$，$c$ 单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，以及 $\\tilde{\\nu}_i$ 单位为 $\\mathrm{cm}^{-1}$：\n首先，我们将光速转换为 $\\mathrm{cm}\\,\\mathrm{s}^{-1}$：\n$c = 299,792,458\\,\\mathrm{m}\\,\\mathrm{s}^{-1} = 2.99792458 \\times 10^{10}\\,\\mathrm{cm}\\,\\mathrm{s}^{-1}$。\n以焦耳为单位的摩尔能量是：\n$$\\mathrm{ZPVE}\\ (\\mathrm{J}\\,\\mathrm{mol}^{-1}) = E_0 N_\\mathrm{A} = \\frac{1}{2} h c N_\\mathrm{A} \\sum_i g_i \\tilde{\\nu}_i$$\n转换为千焦，我们除以 $1000$：\n$$\\mathrm{ZPVE}\\ (\\mathrm{kJ}\\,\\mathrm{mol}^{-1}) = \\frac{h c N_\\mathrm{A}}{2000} \\sum_i g_i \\tilde{\\nu}_i$$\n让我们使用给定的常数来定义一个转换因子 $C_{\\mathrm{factor}} = \\frac{h c N_\\mathrm{A}}{2000}$：\n$h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J}\\,\\mathrm{s}$\n$c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm}\\,\\mathrm{s}^{-1}$\n$N_\\mathrm{A} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$\n$$C_{\\mathrm{factor}} = \\frac{(6.62607015 \\times 10^{-34}) \\times (2.99792458 \\times 10^{10}) \\times (6.02214076 \\times 10^{23})}{2000} \\approx 0.0059813525 \\, \\frac{\\mathrm{kJ}\\,\\mathrm{mol}^{-1}}{\\mathrm{cm}^{-1}}$$\n\n第1步：计算 $\\mathrm{CH}_4$ 的 $\\mathrm{ZPVE}$。\n我们首先计算加权谐振波数之和，$\\sum_S = \\sum_i g_i \\tilde{\\nu}_i^{\\mathrm{CH}_4}$：\n$$\\sum_S (\\mathrm{CH}_4) = (1 \\times 2917.0) + (2 \\times 1534.0) + (3 \\times 3019.0) + (3 \\times 1306.0) \\, \\mathrm{cm}^{-1}$$\n$$\\sum_S (\\mathrm{CH}_4) = 2917.0 + 3068.0 + 9057.0 + 3918.0 = 18960.0 \\, \\mathrm{cm}^{-1}$$\n现在，我们计算 $\\mathrm{CH}_4$ 的 $\\mathrm{ZPVE}$：\n$$\\mathrm{ZPVE}(\\mathrm{CH}_4) = C_{\\mathrm{factor}} \\times \\sum_S (\\mathrm{CH}_4) \\approx 0.0059813525 \\times 18960.0$$\n$$\\mathrm{ZPVE}(\\mathrm{CH}_4) \\approx 113.4064434 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\n四舍五入到三位小数得到 $113.406 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n第2步：计算 $\\mathrm{CD}_4$ 的 $\\mathrm{ZPVE}$。\n问题指定了一个局部质量标度近似，其中所有频率都按一个单一因子 $s$ 伸缩：\n$$s = \\sqrt{\\frac{m_\\mathrm{H}}{m_\\mathrm{D}}} = \\sqrt{\\frac{1.00782503223}{2.01410177812}} \\approx 0.70738151$$\n因此，$\\mathrm{CD}_4$ 的每个波数为 $\\tilde{\\nu}_i^{\\mathrm{CD}_4} = s \\times \\tilde{\\nu}_i^{\\mathrm{CH}_4}$。\n$\\mathrm{CD}_4$ 的 $\\mathrm{ZPVE}$ 为：\n$$\\mathrm{ZPVE}(\\mathrm{CD}_4) = C_{\\mathrm{factor}} \\sum_i g_i \\tilde{\\nu}_i^{\\mathrm{CD}_4} = C_{\\mathrm{factor}} \\sum_i g_i (s \\cdot \\tilde{\\nu}_i^{\\mathrm{CH}_4})$$\n$$= s \\left( C_{\\mathrm{factor}} \\sum_i g_i \\tilde{\\nu}_i^{\\mathrm{CH}_4} \\right) = s \\times \\mathrm{ZPVE}(\\mathrm{CH}_4)$$\n$$\\mathrm{ZPVE}(\\mathrm{CD}_4) \\approx 0.70738151 \\times 113.4064434 \\approx 80.2223805 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\n四舍五入到三位小数得到 $80.222 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n第3步：计算比率 $R$。\n比率 $R$ 定义为 $R = \\mathrm{ZPVE}(\\mathrm{CD}_4)/\\mathrm{ZPVE}(\\mathrm{CH}_4)$。从我们上面的推导可以清楚地看出，当使用未四舍五入的中间值时：\n$$R = \\frac{s \\times \\mathrm{ZPVE}(\\mathrm{CH}_4)}{\\mathrm{ZPVE}(\\mathrm{CH}_4)} = s$$\n因此，$R \\approx 0.70738151$。四舍五入到六位小数得到 $0.707382$。\n\n第4步：计算差值 $\\Delta$。\n差值 $\\Delta$ 定义为 $\\Delta = \\mathrm{ZPVE}(\\mathrm{CH}_4) - \\mathrm{ZPVE}(\\mathrm{CD}_4)$。为了在最终四舍五入前获得最大精度，使用未舍入的值：\n$$\\Delta = \\mathrm{ZPVE}(\\mathrm{CH}_4) \\times (1-s) \\approx 113.4064434 \\times (1 - 0.70738151)$$\n$$\\Delta \\approx 113.4064434 \\times 0.29261849 \\approx 33.1840629 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\n四舍五入到三位小数得到 $33.184 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n第5步：确定一致性标志。\n如果 $|R - s| < 10^{-12}$，则该标志设置为 $\\mathrm{True}$。如第3步所证，在此理论模型中，$R$ 在数学上与 $s$ 是相同的。数值计算 $R = \\frac{s \\times \\mathrm{ZPVE}(\\mathrm{CH}_4)}{\\mathrm{ZPVE}(\\mathrm{CH}_4)}$ 将以机器精度得到 $s$。因此，$|R - s|$ 将实际上为零，并且肯定小于指定的容差 $10^{-12}$。该标志为 $\\mathrm{True}$。\n\n最终计算出的输出值为：\n$\\mathrm{ZPVE}(\\mathrm{CH}_4) = 113.406 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n$\\mathrm{ZPVE}(\\mathrm{CD}_4) = 80.222 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n$R = 0.707382$\n$\\Delta = 33.184 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n一致性标志 = $\\mathrm{True}$", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Zero-Point Vibrational Energy (ZPVE) for CH4 and CD4,\n    their ratio and difference, and a consistency flag, based on the harmonic\n    approximation and a mass-scaling model.\n    \"\"\"\n    \n    # The problem describes a single calculation.\n    # The `test_cases` structure is used here to package the parameters for this single case,\n    # adhering to the specified code structure.\n    test_cases = [\n        {\n            \"m_H\": 1.00782503223,\n            \"m_D\": 2.01410177812,\n            \"c_m_s\": 299792458.0,\n            \"h\": 6.62607015e-34,\n            \"N_A\": 6.02214076e23,\n            \"ch4_modes\": [\n                (2917.0, 1),  # (wavenumber in cm^-1, degeneracy)\n                (1534.0, 2),\n                (3019.0, 3),\n                (1306.0, 3)\n            ]\n        }\n    ]\n\n    # The loop will run once for the single case provided.\n    for case in test_cases:\n        # Extract parameters for clarity\n        m_H, m_D = case[\"m_H\"], case[\"m_D\"]\n        h, c_m_s, N_A = case[\"h\"], case[\"c_m_s\"], case[\"N_A\"]\n        ch4_modes = case[\"ch4_modes\"]\n\n        # 1. Calculate the master conversion factor\n        # Speed of light in cm/s\n        c_cm_s = c_m_s * 100.0\n        # This factor converts the sum of weighted wavenumbers (in cm^-1)\n        # directly to molar ZPVE in kJ/mol.\n        # ZPVE_kJmol = (1/2) * h * c_cm_s * N_A * Sum(g_i * nu_i) / 1000\n        conversion_factor = (h * c_cm_s * N_A) / (2.0 * 1000.0)\n\n        # 2. Calculate ZPVE for CH4\n        sum_g_nu_ch4 = sum(g * nu for nu, g in ch4_modes)\n        zpve_ch4_unrounded = sum_g_nu_ch4 * conversion_factor\n\n        # 3. Calculate scaling factor s and ZPVE for CD4\n        s = np.sqrt(m_H / m_D)\n        zpve_cd4_unrounded = zpve_ch4_unrounded * s\n\n        # 4. Calculate the ratio R\n        # Based on the model, R is mathematically identical to s.\n        R_unrounded = zpve_cd4_unrounded / zpve_ch4_unrounded\n\n        # 5. Calculate the difference Delta\n        delta_unrounded = zpve_ch4_unrounded - zpve_cd4_unrounded\n\n        # 6. Determine the consistency flag\n        # This check verifies the derivation R = s, allowing for floating point error.\n        consistency_flag = abs(R_unrounded - s)  1e-12\n\n        # 7. Round the final results as specified in the problem statement\n        zpve_ch4_kjmol = round(zpve_ch4_unrounded, 3)\n        zpve_cd4_kjmol = round(zpve_cd4_unrounded, 3)\n        R_rounded = round(R_unrounded, 6)\n        delta_kjmol = round(delta_unrounded, 3)\n        \n        # Assemble the list of results for printing\n        results = [\n            zpve_ch4_kjmol,\n            zpve_cd4_kjmol,\n            R_rounded,\n            delta_kjmol,\n            consistency_flag\n        ]\n        \n    # Final print statement in the exact required format.\n    # The map(str, ...) automatically handles the conversion of all types\n    # (float, bool) to their string representations.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solution\nsolve()\n```", "id": "2462149"}, {"introduction": "计算模拟的准确性在很大程度上取决于所选的理论模型。本练习将探讨不同的密度泛函理论（DFT）泛函如何对同一性质（如此处的水二聚体中 O-H 伸缩振动频率的移动）给出不同的预测结果。通过这个氢键相互作用的经典例子，我们学会批判性地评估计算模拟的结果，这是成为一名合格计算化学家所必需的技能 [@problem_id:2462224]。", "problem": "您将编写一个完整的、可运行的程序。该程序根据给定的水单体O–H伸缩坐标和水二聚体中供体O–H的有效一维谐振子力常数，计算不同密度泛函理论 (DFT) 泛函下的预测红外波数移动。计算必须严格基于谐振子模型和第一性原理定义。O–H伸缩模式被建模为一维谐振子，其约化质量 $\\mu$ 等于O–H双原子体系的约化质量。角频率 $\\omega$ 满足 $\\omega^2 = k / \\mu$，其中 $k$ 是有效力常数。单位为 $\\mathrm{cm}^{-1}$ 的红外波数 $\\bar{\\nu}$ 定义为 $\\bar{\\nu} = \\omega / (2 \\pi c)$，其中 $c$ 是以 $\\mathrm{cm/s}$ 为单位的光速。频率移动定义为 $\\Delta \\bar{\\nu} = \\bar{\\nu}_\\mathrm{dimer} - \\bar{\\nu}_\\mathrm{monomer}$，单位为 $\\mathrm{cm}^{-1}$。请使用以下常数：光速 $c = 2.99792458 \\times 10^{10}\\ \\mathrm{cm/s}$，原子质量单位 $1\\ \\mathrm{u} = 1.66053906660 \\times 10^{-27}\\ \\mathrm{kg}$，氢原子质量 $m_\\mathrm{H} = 1.00784\\ \\mathrm{u}$，以及氧原子质量 $m_\\mathrm{O} = 15.999\\ \\mathrm{u}$。约化质量为 $\\mu = \\dfrac{m_\\mathrm{H} m_\\mathrm{O}}{m_\\mathrm{H} + m_\\mathrm{O}}$，其中所有质量单位均为 $\\mathrm{kg}$。\n\n您的程序必须应用这些定义来计算以下每个测试用例的 $\\Delta \\bar{\\nu}$。每个测试用例提供了单体O–H伸缩的有效谐振子力常数 $k_\\mathrm{mono}$ 和二聚体中供体O–H伸缩的有效谐振子力常数 $k_\\mathrm{dimer}$，二者单位均为 $\\mathrm{N/m}$：\n\n- 测试用例 1 (PBE): $k_\\mathrm{mono} = 74.0\\ \\mathrm{N/m}$, $k_\\mathrm{dimer} = 70.0\\ \\mathrm{N/m}$。\n- 测试用例 2 (B3LYP): $k_\\mathrm{mono} = 76.0\\ \\mathrm{N/m}$, $k_\\mathrm{dimer} = 72.5\\ \\mathrm{N/m}$。\n- 测试用例 3 (M06-2X): $k_\\mathrm{mono} = 77.5\\ \\mathrm{N/m}$, $k_\\mathrm{dimer} = 74.0\\ \\mathrm{N/m}$。\n- 测试用例 4 (边界零移动检查): $k_\\mathrm{mono} = 76.0\\ \\mathrm{N/m}$, $k_\\mathrm{dimer} = 76.0\\ \\mathrm{N/m}$。\n\n所有答案必须以 $\\mathrm{cm}^{-1}$ 为单位表示。对于每个测试用例，计算一个浮点数结果 $\\Delta \\bar{\\nu}$ 并四舍五入到一位小数。您的程序应生成单行输出，其中包含一个用逗号分隔、无空格、并用方括号括起来的结果列表，顺序与上述测试用例一致。例如，输出格式必须严格为 $[\\Delta\\bar{\\nu}_1,\\Delta\\bar{\\nu}_2,\\Delta\\bar{\\nu}_3,\\Delta\\bar{\\nu}_4]$，其中每个 $\\Delta \\bar{\\nu}_i$ 以 $\\mathrm{cm}^{-1}$ 为单位且显示到一位小数。\n\n所提供的测试套件旨在评估：\n- 典型的氢键红移 (PBE, B3LYP, M06-2X)。\n- 当 $k_\\mathrm{mono} = k_\\mathrm{dimer}$ 时无频移发生的边界情况。\n\n您的程序必须根据上述定义计算结果，无需任何额外输入，并且必须严格使用指定的物理常数。最终输出必须是一个包含四个浮点数的列表，代表以 $\\mathrm{cm}^{-1}$ 为单位的波数移动，四舍五入到一位小数，并采用指定的单行格式。", "solution": "该问题要求基于简化的一维谐振子模型，计算O–H伸缩模式的红外波数移动。验证此问题陈述是强制性的第一步。\n\n验证过程如下。\n\n第1步：提取已知信息。\n问题提供了以下数据、定义和常数：\n- 模型：用于O–H伸缩坐标的一维谐振子。\n- O–H伸缩的约化质量：$\\mu = \\dfrac{m_\\mathrm{H} m_\\mathrm{O}}{m_\\mathrm{H} + m_\\mathrm{O}}$。\n- 角频率：$\\omega^2 = k / \\mu$，其中 $k$ 是有效力常数。\n- 波数：$\\bar{\\nu} = \\omega / (2 \\pi c)$，单位为 $\\mathrm{cm}^{-1}$。\n- 频率移动：$\\Delta \\bar{\\nu} = \\bar{\\nu}_\\mathrm{dimer} - \\bar{\\nu}_\\mathrm{monomer}$，单位为 $\\mathrm{cm}^{-1}$。\n- 常数：\n    - 光速，$c = 2.99792458 \\times 10^{10}\\ \\mathrm{cm/s}$。\n    - 原子质量单位，$1\\ \\mathrm{u} = 1.66053906660 \\times 10^{-27}\\ \\mathrm{kg}$。\n    - 氢原子质量，$m_\\mathrm{H} = 1.00784\\ \\mathrm{u}$。\n    - 氧原子质量，$m_\\mathrm{O} = 15.999\\ \\mathrm{u}$。\n- 测试用例 (力常数 $k$ 单位为 $\\mathrm{N/m}$)：\n    - 用例 1 (PBE): $k_\\mathrm{mono} = 74.0\\ \\mathrm{N/m}$, $k_\\mathrm{dimer} = 70.0\\ \\mathrm{N/m}$。\n    - 用例 2 (B3LYP): $k_\\mathrm{mono} = 76.0\\ \\mathrm{N/m}$, $k_\\mathrm{dimer} = 72.5\\ \\mathrm{N/m}$。\n    - 用例 3 (M06-2X): $k_\\mathrm{mono} = 77.5\\ \\mathrm{N/m}$, $k_\\mathrm{dimer} = 74.0\\ \\mathrm{N/m}$。\n    - 用例 4 (边界检查): $k_\\mathrm{mono} = 76.0\\ \\mathrm{N/m}$, $k_\\mathrm{dimer} = 76.0\\ \\mathrm{N/m}$。\n\n第2步：使用提取的已知信息进行验证。\n根据所需标准对问题进行评估。\n- **科学依据充分**：该问题基于谐振子模型，这是分子光谱学和量子力学的基石。根据力常数计算振动频率是计算化学中的标准程序。所有原理和常数均源于已确立的物理学。该问题是合理的。\n- **问题明确**：问题提供了为每个测试用例计算唯一解所需的所有定义、常数和输入数据。目标定义清晰。该问题是明确的。\n- **客观性**：语言精确且定量。术语是该领域的标准术语。该问题是客观的。\n- **完整性与一致性**：提供了所有必需的信息，没有矛盾之处。单位已指定且在计算中保持一致：$k$ 的单位是 $\\mathrm{N/m} = \\mathrm{kg \\cdot s^{-2}}$，$\\mu$ 将以 $\\mathrm{kg}$ 计算，而 $c$ 的单位是 $\\mathrm{cm/s}$，最终得到 $\\bar{\\nu}$ 的单位为 $\\mathrm{cm^{-1}}$，符合要求。该问题是完整且一致的。\n\n第3步：结论与行动。\n该问题是有效的。它是物理化学基本原理的直接应用。将提供一个解决方案。\n\n任务是计算波数移动 $\\Delta \\bar{\\nu} = \\bar{\\nu}_\\mathrm{dimer} - \\bar{\\nu}_\\mathrm{monomer}$。我们必须首先根据给定物理量推导出 $\\Delta \\bar{\\nu}$ 的显式表达式。\n\n波数 $\\bar{\\nu}$ 由下式给出：\n$$\n\\bar{\\nu} = \\frac{\\omega}{2 \\pi c}\n$$\n角频率 $\\omega$ 与力常数 $k$ 和约化质量 $\\mu$ 的关系为：\n$$\n\\omega = \\sqrt{\\frac{k}{\\mu}}\n$$\n将 $\\omega$ 的表达式代入 $\\bar{\\nu}$ 的方程，我们得到波数和力常数之间的直接关系：\n$$\n\\bar{\\nu} = \\frac{1}{2 \\pi c} \\sqrt{\\frac{k}{\\mu}} = \\frac{1}{2 \\pi c \\sqrt{\\mu}} \\sqrt{k}\n$$\n波数移动 $\\Delta \\bar{\\nu}$ 则是二聚体和单体波数之差：\n$$\n\\Delta \\bar{\\nu} = \\bar{\\nu}_\\mathrm{dimer} - \\bar{\\nu}_\\mathrm{monomer} = \\frac{1}{2 \\pi c \\sqrt{\\mu}} \\sqrt{k_\\mathrm{dimer}} - \\frac{1}{2 \\pi c \\sqrt{\\mu}} \\sqrt{k_\\mathrm{monomer}}\n$$\n将常数项提取出来，得到用于计算的最终表达式：\n$$\n\\Delta \\bar{\\nu} = \\frac{1}{2 \\pi c \\sqrt{\\mu}} \\left( \\sqrt{k_\\mathrm{dimer}} - \\sqrt{k_\\mathrm{monomer}} \\right)\n$$\n计算步骤如下：\n\n首先，计算以国际单位制 (SI) 单位 ($\\mathrm{kg}$) 表示的约化质量 $\\mu$。质量 $m_\\mathrm{H}$ 和 $m_\\mathrm{O}$ 以原子质量单位 ($\\mathrm{u}$) 给出，必须使用提供的转换因子转换为千克。\n$$\nm_\\mathrm{H, kg} = m_\\mathrm{H, u} \\times (1.66053906660 \\times 10^{-27}\\ \\mathrm{kg/u})\n$$\n$$\nm_\\mathrm{O, kg} = m_\\mathrm{O, u} \\times (1.66053906660 \\times 10^{-27}\\ \\mathrm{kg/u})\n$$\n当 $m_\\mathrm{H} = 1.00784\\ \\mathrm{u}$ 且 $m_\\mathrm{O} = 15.999\\ \\mathrm{u}$ 时，约化质量（单位：千克）为：\n$$\n\\mu = \\frac{m_\\mathrm{H, kg} \\cdot m_\\mathrm{O, kg}}{m_\\mathrm{H, kg} + m_\\mathrm{O, kg}} = \\frac{(1.00784 \\cdot 15.999)}{(1.00784 + 15.999)} \\times (1.66053906660 \\times 10^{-27}\\ \\mathrm{kg})\n$$\n$$\n\\mu \\approx 0.9481155 \\times 1.66053906660 \\times 10^{-27}\\ \\mathrm{kg} \\approx 1.57436 \\times 10^{-27}\\ \\mathrm{kg}\n$$\n其次，对于每个测试用例，我们都给出了力常数 $k_\\mathrm{monomer}$ 和 $k_\\mathrm{dimer}$，单位为 $\\mathrm{N/m}$。单位 $\\mathrm{N/m}$ 等价于 $\\mathrm{kg/s^2}$，这与质量的SI单位 ($\\mathrm{kg}$) 是一致的。光速 $c$ 的单位是 $\\mathrm{cm/s}$。使用这些单位，计算得到的 $\\bar{\\nu}$ 的单位将是 $\\mathrm{cm^{-1}}$，符合要求。\n项 $\\frac{1}{2 \\pi c \\sqrt{\\mu}}$ 是所有计算中的一个常数预因子。\n$$\n\\text{prefactor} = \\frac{1}{2 \\pi (2.99792458 \\times 10^{10}\\ \\mathrm{cm/s}) \\sqrt{1.57436 \\times 10^{-27}\\ \\mathrm{kg}}}\n$$\n这个预因子只需计算一次。然后，对于每一对 ($k_\\mathrm{mono}$, $k_\\mathrm{dimer}$)，使用推导出的公式计算频移 $\\Delta \\bar{\\nu}$。当 $k_\\mathrm{dimer}  k_\\mathrm{monomer}$ 时，预计會出现负向移动（称为红移），这表明O–H键在形成氢键后被削弱。每个案例的最终结果四舍五入到一位小数。程序将精确地实现这一逻辑。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the predicted infrared wavenumber shift for the O–H stretching\n    coordinate based on a one-dimensional harmonic oscillator model.\n    \"\"\"\n\n    # --- Givens and Constants ---\n    # Speed of light in cm/s\n    C_CMS = 2.99792458e10\n    # Atomic mass unit in kg\n    U_TO_KG = 1.66053906660e-27\n    # Hydrogen atomic mass in u\n    M_H_U = 1.00784\n    # Oxygen atomic mass in u\n    M_O_U = 15.999\n\n    # Test cases: (k_mono in N/m, k_dimer in N/m)\n    test_cases = [\n        (74.0, 70.0),  # Case 1 (PBE)\n        (76.0, 72.5),  # Case 2 (B3LYP)\n        (77.5, 74.0),  # Case 3 (M06-2X)\n        (76.0, 76.0),  # Case 4 (Boundary check)\n    ]\n\n    # --- Step 1: Calculate Reduced Mass in SI units (kg) ---\n    # Convert atomic masses from u to kg\n    m_h_kg = M_H_U * U_TO_KG\n    m_o_kg = M_O_U * U_TO_KG\n\n    # Calculate reduced mass for the O-H diatomic system\n    mu_kg = (m_h_kg * m_o_kg) / (m_h_kg + m_o_kg)\n\n    # --- Step 2: Calculate the prefactor for wavenumber calculation ---\n    # The formula for wavenumber shift is:\n    # delta_nu = (1 / (2 * pi * c * sqrt(mu))) * (sqrt(k_dimer) - sqrt(k_mono))\n    # The prefactor is constant for all calculations.\n    # Units: 1 / ( (cm/s) * sqrt(kg) )\n    prefactor = 1 / (2 * np.pi * C_CMS * np.sqrt(mu_kg))\n\n    # --- Step 3: Compute the shift for each test case ---\n    results = []\n    for k_mono, k_dimer in test_cases:\n        # k values are in N/m, which is kg/s^2.\n        # sqrt(k) will have units of sqrt(kg)/s.\n        # The units of the final result will be:\n        # (1 / (cm/s * sqrt(kg))) * (sqrt(kg)/s) = 1/cm = cm^-1.\n        delta_nu = prefactor * (np.sqrt(k_dimer) - np.sqrt(k_mono))\n        \n        # Round the result to one decimal place.\n        # Using string formatting `.1f` handles cases like 0.0 correctly.\n        results.append(f\"{delta_nu:.1f}\")\n\n    # --- Final Output ---\n    # The final print statement must be in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2462224"}, {"introduction": "光谱学和计算化学中的高阶课题，例如分析势能面，通常需要我们对热力学和微积分有扎实的掌握。虽然下面这个问题 [@problem_id:246197] 源于相平衡领域，但它提供了一个绝佳的机会，来练习如何从化学势出发推导热力学条件。掌握这种分析推导能力，对于任何有志于深入研究物理化学的学生来说都是一项宝贵的技能。", "problem": "考虑一个由组分 A、B 和 C构成的三元体系，该体系表现出简单的共晶行为。这意味着这些组分在液相中完全互溶，但在固相中完全不互溶，固相由纯组分构成。液相的热力学行为被描述为非理想溶液。\n\n在温-成分相图中，由 $T(x_A, x_B, x_C)$ 表示的液相线面给出了给定组成的液态混合物在冷却时形成第一个固相晶体的温度。对于组分 A 的初晶区内的某一成分，液相线温度 $T$ 由固-液平衡条件决定：\n$$\n\\mu_A^L(T, P, x_A, x_B, x_C) = \\mu_A^{S*}(T, P)\n$$\n其中 $\\mu_A^L$ 是组分 A 在液相中的化学势，而 $\\mu_A^{S*}$ 是纯固相 A 的化学势。在整个过程中，压力 $P$ 保持恒定。\n\n设想一个特定情景，液相线面上的等温线（恒温线）与连接纯 A 和纯 B 的 Gibbs 成分三角形的边缘完全相切。设切点为二元组分 $(x_A, x_B, 0)$，在该点首先结晶的固相是纯 A。\n\n推导液相溶液中组分 A 的化学势 $\\mu_A^L$ 在此切点必须满足的热力学条件。将您的结果表示为一个包含 $\\mu_A^L$ 对摩尔分数 $x_A$ 和 $x_B$ 的偏导数的方程。", "solution": "1. 在固定的 $T,P$ 和 $x_C=0$ 条件下的固-液平衡：\n$$\n\\mu_A^L(T,P,x_A,x_B,0)\\;=\\;\\mu_A^{S*}(T,P).\n$$\n2. 在恒定 $T,P$ 下对两边进行微分：\n$$\nd\\mu_A^L\n=\\frac{\\partial\\mu_A^L}{\\partial x_A}\\,dx_A\n+\\frac{\\partial\\mu_A^L}{\\partial x_B}\\,dx_B\n+\\frac{\\partial\\mu_A^L}{\\partial x_C}\\,dx_C\n=0,\n$$\n且 $dx_C=0$。\n3. 沿着二元 A–B 边，有 $x_A+x_B=1$，因此 $dx_B=-dx_A$。代入得：\n$$\n\\frac{\\partial\\mu_A^L}{\\partial x_A}\\,dx_A\n+\\frac{\\partial\\mu_A^L}{\\partial x_B}(-dx_A)\n=0\n\\quad\\Longrightarrow\\quad\n\\frac{\\partial\\mu_A^L}{\\partial x_A}\n=\\frac{\\partial\\mu_A^L}{\\partial x_B}.\n$$", "answer": "$$\\boxed{\\left.\\frac{\\partial\\mu_A^L}{\\partial x_A}\\right|_{T,P,x_C=0}\n=\\left.\\frac{\\partial\\mu_A^L}{\\partial x_B}\\right|_{T,P,x_C=0}}$$", "id": "246197"}]}