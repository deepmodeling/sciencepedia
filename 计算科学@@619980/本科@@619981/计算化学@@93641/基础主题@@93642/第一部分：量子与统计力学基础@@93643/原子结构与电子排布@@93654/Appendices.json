{"hands_on_practices": [{"introduction": "我们在普通化学中学过，电子排布遵循构造原理，但总会遇到像铬（$Cr$）这样的“例外”。这个实践将引导你超越定性规则，通过构建一个简明的计算模型来定量地探讨这一现象。你将亲手计算并比较两种可能的电子排布的总能量，从而理解轨道能量、交换稳定化能和电子配对能之间的微妙平衡，正是这种平衡决定了铬原子基态的特殊构型 [@problem_id:2450014]。", "problem": "编写一个完整、可运行的程序，使用基于第一性原理启发的近似方法，比较铬的两种电子排布 $[Ar] 3d^5 4s^1$ 和 $[Ar] 3d^4 4s^2$ 的总能量。目标是通过计算证明，在合理的物理近似下，反常基态电子排布 $[Ar] 3d^5 4s^1$ 比 $[Ar] 3d^4 4s^2$ 具有更低的总能量。\n\n你的程序必须从原子的非相对论性多电子哈密顿量出发，实现一个带有有效核电荷的中心场近似来估算单电子轨道能量，并结合受 Hartree–Fock 理论和 Hund 规则启发的简化交换和配对修正。具体而言，需实现以下建模假设和步骤。\n\n1) 基础物理模型\n- 使用带有有效核电荷 $Z_{\\text{eff}}$ 的中心场单电子能量模型：\n  $$E_{n\\ell} = -R\\,\\frac{Z_{\\text{eff}}^2}{n^2},$$\n  其中 $R = 13.6\\,\\text{eV}$ 是里德堡能量，$n$ 是主量子数。\n- 使用 Slater 规则估算 $Z_{\\text{eff}}$。将电子排布分组为：$(1s)(2s,2p)(3s,3p)(3d)(4s,4p)\\dots$。对于铬，原子序数 $Z=24$，其内核为 $[Ar] = 1s^2\\,2s^2\\,2p^6\\,3s^2\\,3p^6$（共 $18$ 个电子）。应用以下屏蔽规则：\n  - 对于 $3d^N 4s^M$ 排布中的一个 $3d$ 电子：\n    $$S(3d) = 1.00\\times(1s,2s,2p,3s,3p\\ \\text{电子}) + 0.35\\times(\\text{其他 }3d\\ \\text{电子}) + 0.00\\times(4s,4p\\ \\text{电子})。$$\n    具体到铬，低层壳层电子 $(1s,2s,2p,3s,3p)$ 总数为 $18$；因此，\n    $$S(3d) = 18 + 0.35\\times(N_d-1),$$\n    其中 $N_d$ 是正在计算能量的排布中 $3d$ 电子的数量。\n  - 对于 $3d^N 4s^M$ 排布中的一个 $4s$ 电子：\n    $$S(4s) = 0.35\\times(\\text{其他 }4s,4p\\ \\text{电子}) + 1.00\\times(3d\\ \\text{电子}) + 0.85\\times(3s,3p\\ \\text{电子}) + 1.00\\times(1s,2s,2p\\ \\text{电子})。$$\n    具体到铬，\n    $$S(4s) = 0.35\\times(M-1) + 1.00\\times N_d + 0.85\\times 8 + 1.00\\times 10,$$\n    其中 $M$ 是该排布中 $4s$ 电子的数量。\n  - 在两种情况下，$Z_{\\text{eff}} = Z - S$。\n- 使用 Hund 规则假设亚层内具有最大自旋多重度。对于 $[Ar] 3d^5 4s^1$，我们取五个自旋平行的 $3d$ 电子和一个自旋相同的 $4s$ 电子，即总共六个电子自旋对齐。对于 $[Ar] 3d^4 4s^2$，我们取四个自旋平行的 $3d$ 电子和一对自旋相反的 $4s^2$ 电子。\n\n2) 交换稳定化和配对惩罚\n- 引入一个与自旋平行电子对数量成正比的平均交换稳定化。将自旋平行电子对的交换稳定化能建模为：\n  $$E_{\\text{exch}} = -K_{dd}\\,N_{\\parallel}^{(dd)} - K_{sd}\\,N_{\\parallel}^{(sd)},$$\n  其中 $K_{dd}$ 和 $K_{sd}$（单位均为 $\\text{eV}$）分别是 $3d$–$3d$ 和 $3d$–$4s$ 自旋平行电子对的平均交换积分；$N_{\\parallel}^{(dd)}$ 和 $N_{\\parallel}^{(sd)}$ 是相应的自旋平行电子对数量。\n- 对同一 $4s$ 轨道中的每对自旋相反的电子对施加一个配对惩罚 $P_{4s}$（单位为 $\\text{eV}$）：\n  $$E_{\\text{pair}} = \\begin{cases}\n  P_{4s}, & \\text{如果存在 }4s^2,\\\\\n  0, & \\text{其他情况。}\n  \\end{cases}$$\n\n3) 两种构型的计数规则（根据 Hund 规则为高自旋）\n- 对于 $[Ar] 3d^5 4s^1$：$N_d=5$, $M=1$，\n  $$N_{\\parallel}^{(dd)} = \\binom{5}{2} = 10,\\quad N_{\\parallel}^{(sd)} = 5,\\quad E_{\\text{pair}}=0.$$\n- 对于 $[Ar] 3d^4 4s^2$：$N_d=4$, $M=2$，其中一个 $4s\\uparrow$ 和一个 $4s\\downarrow$，\n  $$N_{\\parallel}^{(dd)} = \\binom{4}{2} = 6,\\quad N_{\\parallel}^{(sd)} = 4,\\quad E_{\\text{pair}}=P_{4s}.$$\n\n4) 总能量模型\n- 对于一个在 $3d$ 中有 $N_d$ 个电子、在 $4s$ 中有 $M$ 个电子的构型，\n  $$E_{\\text{one}} = N_d\\,E_{3d} + M\\,E_{4s},\\quad E_{\\text{tot}} = E_{\\text{one}} + E_{\\text{exch}} + E_{\\text{pair}}.$$\n- 使用适用于该构型的 Slater 规则计算出的 $Z_{\\text{eff}}$，通过类氢公式计算 $E_{3d}$ 和 $E_{4s}$。\n\n5) 待计算量和要求的输出\n- 对于每个测试用例，计算能量差\n  $$\\Delta E = E_{\\text{tot}}\\big(3d^5\\,4s^1\\big) - E_{\\text{tot}}\\big(3d^4\\,4s^2\\big),$$\n  以 $\\text{eV}$ 为单位表示，并四舍五入到三位小数。负值表示 $3d^5\\,4s^1$ 的能量更低（更有利）。\n- 角度单位不适用。所有输出必须以 $\\text{eV}$ 为单位。\n- 你的程序必须打印单行内容：一个由方括号括起来的、逗号分隔的测试套件 $\\Delta E$ 值列表，例如 $[\\Delta E_1,\\Delta E_2,\\dots]$。\n\n测试套件（每个元组为 $(K_{dd}, K_{sd}, P_{4s})$，单位为 $\\text{eV}$）：\n- 情况 A（典型量级）：$(0.6,\\,0.1,\\,1.2)$。\n- 情况 B（无交换，无配对）：$(0.0,\\,0.0,\\,0.0)$。\n- 情况 C（更强的交换和配对）：$(1.0,\\,0.2,\\,1.5)$。\n- 情况 D（无 sd 交换，中等 dd 交换，适度配对）：$(0.3,\\,0.0,\\,0.5)$。\n- 情况 E（仅存在 sd 交换）：$(0.0,\\,0.5,\\,0.0)$。\n\n实现和输出要求\n- 程序必须是自包含的，且不需要任何输入。\n- 使用上述规则计算 $Z_{\\text{eff}}$、$E_{3d}$、$E_{4s}$、交换和配对贡献。\n- 按照测试套件用例的顺序，生成单行输出，包含一个由方括号括起来的、逗号分隔的结果列表，单位为 $\\text{eV}$，每个值四舍五入到三位小数。", "solution": "根据题目所述，这是一个计算化学领域的有效练习。它在科学上基于已确立但简化的原子电子结构模型，包括中心场近似、用于屏蔽的 Slater 规则以及源于 Hartree-Fock 理论的交换能和配对能的基本概念。该问题提法恰当，提供了所有必要的参数、常数以及一个清晰、客观的方法来得出唯一解。不存在不一致、矛盾或含糊之处。因此，我们将着手解决。\n\n目标是计算能量差 $\\Delta E = E_{\\text{tot}}(C_1) - E_{\\text{tot}}(C_2)$，其中 $C_1$ 是铬原子 ($Z=24$) 的电子排布 $[Ar]\\ 3d^5\\,4s^1$，$C_2$ 是 $[Ar]\\ 3d^4\\,4s^2$。负的 $\\Delta E$ 值表示构型 $C_1$ 在能量上更有利。\n\n给定构型的总能量 $E_{\\text{tot}}$ 被建模为三个分量的和：总单电子能量 $E_{\\text{one}}$、交换稳定化能 $E_{\\text{exch}}$ 和配对能惩罚 $E_{\\text{pair}}$。\n$$E_{\\text{tot}} = E_{\\text{one}} + E_{\\text{exch}} + E_{\\text{pair}}$$\n主量子数为 $n$ 的轨道的单电子能量由 $E_{n\\ell} = -R\\,Z_{\\text{eff}}^2/n^2$ 给出，其中 $R = 13.6\\,\\text{eV}$ 是里德堡能量，$Z_{\\text{eff}} = Z - S$ 是有效核电荷。屏蔽常数 $S$ 取决于电子排布。\n\n我们将系统地推导每种构型的总能量。\n\n**1. 构型 $C_1: [Ar]\\ 3d^5\\,4s^1$ 的分析**\n\n对于此构型，$3d$ 电子数为 $N_d = 5$，$4s$ 电子数为 $M = 1$。\n\n首先，我们计算 $3d$ 和 $4s$ 电子的有效核电荷 $Z_{\\text{eff}}$。原子序数 $Z=24$。\n对于一个 $3d$ 电子，屏蔽常数 $S_{3d}(C_1)$ 为：\n$$S_{3d}(C_1) = 18 + 0.35 \\times (N_d-1) = 18 + 0.35 \\times (5-1) = 18 + 1.4 = 19.4$$\n因此，有效核电荷为：\n$$Z_{\\text{eff},3d}(C_1) = Z - S_{3d}(C_1) = 24 - 19.4 = 4.6$$\n对于 $4s$ 电子，屏蔽常数 $S_{4s}(C_1)$ 为：\n$$S_{4s}(C_1) = 0.35 \\times (M-1) + 1.00 \\times N_d + 0.85 \\times 8 + 1.00 \\times 10 = 0.35 \\times 0 + 1.00 \\times 5 + 6.8 + 10 = 21.8$$\n因此，有效核电荷为：\n$$Z_{\\text{eff},4s}(C_1) = Z - S_{4s}(C_1) = 24 - 21.8 = 2.2$$\n\n接下来，我们计算单电子轨道能量：\n$$E_{3d}(C_1) = -R\\,\\frac{Z_{\\text{eff},3d}(C_1)^2}{3^2} = -13.6\\,\\text{eV} \\times \\frac{4.6^2}{9}$$\n$$E_{4s}(C_1) = -R\\,\\frac{Z_{\\text{eff},4s}(C_1)^2}{4^2} = -13.6\\,\\text{eV} \\times \\frac{2.2^2}{16}$$\n总单电子能量 $E_{\\text{one}}(C_1)$ 是五个 $3d$ 电子和一个 $4s$ 电子能量的总和：\n$$E_{\\text{one}}(C_1) = 5 \\times E_{3d}(C_1) + 1 \\times E_{4s}(C_1)$$\n\n现在，我们评估相互作用能。对于 $C_1$，所有价电子都可以自旋对齐。自旋平行电子对的数量为 $N_{\\parallel}^{(dd)} = \\binom{5}{2} = 10$ 和 $N_{\\parallel}^{(sd)} = 5 \\times 1 = 5$。交换能为：\n$$E_{\\text{exch}}(C_1) = -K_{dd}\\,N_{\\parallel}^{(dd)} - K_{sd}\\,N_{\\parallel}^{(sd)} = -10\\,K_{dd} - 5\\,K_{sd}$$\n由于 $4s$ 轨道是单占据的，配对惩罚为零：\n$$E_{\\text{pair}}(C_1) = 0$$\n\n构型 $C_1$ 的总能量为：\n$$E_{\\text{tot}}(C_1) = 5\\,E_{3d}(C_1) + E_{4s}(C_1) - 10\\,K_{dd} - 5\\,K_{sd}$$\n\n**2. 构型 $C_2: [Ar]\\ 3d^4\\,4s^2$ 的分析**\n\n对于此构型，$N_d = 4$，$M = 2$。\n\n我们重复计算有效核电荷。\n对于一个 $3d$ 电子：\n$$S_{3d}(C_2) = 18 + 0.35 \\times (N_d-1) = 18 + 0.35 \\times (4-1) = 18 + 1.05 = 19.05$$\n$$Z_{\\text{eff},3d}(C_2) = Z - S_{3d}(C_2) = 24 - 19.05 = 4.95$$\n对于一个 $4s$ 电子：\n$$S_{4s}(C_2) = 0.35 \\times (M-1) + 1.00 \\times N_d + 0.85 \\times 8 + 1.00 \\times 10 = 0.35 \\times 1 + 1.00 \\times 4 + 6.8 + 10 = 21.15$$\n$$Z_{\\text{eff},4s}(C_2) = Z - S_{4s}(C_2) = 24 - 21.15 = 2.85$$\n\n相应的单电子轨道能量为：\n$$E_{3d}(C_2) = -R\\,\\frac{Z_{\\text{eff},3d}(C_2)^2}{3^2} = -13.6\\,\\text{eV} \\times \\frac{4.95^2}{9}$$\n$$E_{4s}(C_2) = -R\\,\\frac{Z_{\\text{eff},4s}(C_2)^2}{4^2} = -13.6\\,\\text{eV} \\times \\frac{2.85^2}{16}$$\n总单电子能量 $E_{\\text{one}}(C_2)$ 为：\n$$E_{\\text{one}}(C_2) = 4 \\times E_{3d}(C_2) + 2 \\times E_{4s}(C_2)$$\n\n对于相互作用能，我们假设 $3d$ 电子处于高自旋态（四个平行自旋），而 $4s$ 轨道中的电子自旋配对。自旋平行电子对的数量为 $N_{\\parallel}^{(dd)} = \\binom{4}{2} = 6$ 和 $N_{\\parallel}^{(sd)} = 4 \\times 1 = 4$（四个 $3d$ 电子和单个自旋向上的 $4s$ 电子之间）。交换能为：\n$$E_{\\text{exch}}(C_2) = -6\\,K_{dd} - 4\\,K_{sd}$$\n$4s$ 轨道是双占据的，产生配对惩罚：\n$$E_{\\text{pair}}(C_2) = P_{4s}$$\n\n构型 $C_2$ 的总能量为：\n$$E_{\\text{tot}}(C_2) = 4\\,E_{3d}(C_2) + 2\\,E_{4s}(C_2) - 6\\,K_{dd} - 4\\,K_{sd} + P_{4s}$$\n\n**3. 能量差 $\\Delta E$ 的计算**\n\n现在我们计算最终关心的量，$\\Delta E = E_{\\text{tot}}(C_1) - E_{\\text{tot}}(C_2)$。\n$$\\Delta E = (5\\,E_{3d}(C_1) + E_{4s}(C_1) - 10\\,K_{dd} - 5\\,K_{sd}) - (4\\,E_{3d}(C_2) + 2\\,E_{4s}(C_2) - 6\\,K_{dd} - 4\\,K_{sd} + P_{4s})$$\n按类型（单电子、交换、配对）对各项进行分组：\n$$\\Delta E = (E_{\\text{one}}(C_1) - E_{\\text{one}}(C_2)) + (E_{\\text{exch}}(C_1) - E_{\\text{exch}}(C_2)) - E_{\\text{pair}}(C_2)$$\n$$\\Delta E = (5\\,E_{3d}(C_1) + E_{4s}(C_1) - 4\\,E_{3d}(C_2) - 2\\,E_{4s}(C_2)) + ((-10\\,K_{dd} - 5\\,K_{sd}) - (-6\\,K_{dd} - 4\\,K_{sd})) - P_{4s}$$\n$$\\Delta E = (5\\,E_{3d}(C_1) + E_{4s}(C_1) - 4\\,E_{3d}(C_2) - 2\\,E_{4s}(C_2)) - 4\\,K_{dd} - K_{sd} - P_{4s}$$\n现在让我们代入单电子能量的数值表达式：\n$$\\Delta E = -R \\left[ \\frac{5 \\cdot Z_{\\text{eff},3d}(C_1)^2 - 4 \\cdot Z_{\\text{eff},3d}(C_2)^2}{9} + \\frac{1 \\cdot Z_{\\text{eff},4s}(C_1)^2 - 2 \\cdot Z_{\\text{eff},4s}(C_2)^2}{16} \\right] - 4\\,K_{dd} - K_{sd} - P_{4s}$$\n代入计算出的 $Z_{\\text{eff}}$ 值：\n$$\\Delta E = -13.6 \\left[ \\frac{5 \\cdot 4.6^2 - 4 \\cdot 4.95^2}{9} + \\frac{1 \\cdot 2.2^2 - 2 \\cdot 2.85^2}{16} \\right] - 4\\,K_{dd} - K_{sd} - P_{4s}$$\n计算单电子项：\n$$\\Delta E = -13.6 \\left[ \\frac{5 \\cdot 21.16 - 4 \\cdot 24.5025}{9} + \\frac{4.84 - 2 \\cdot 8.1225}{16} \\right] - 4\\,K_{dd} - K_{sd} - P_{4s}$$\n$$\\Delta E = -13.6 \\left[ \\frac{105.8 - 98.01}{9} + \\frac{4.84 - 16.245}{16} \\right] - 4\\,K_{dd} - K_{sd} - P_{4s}$$\n$$\\Delta E = -13.6 \\left[ \\frac{7.79}{9} - \\frac{11.405}{16} \\right] - 4\\,K_{dd} - K_{sd} - P_{4s}$$\n$$\\Delta E = -13.6 \\left[ 0.86555... - 0.7128125 \\right] - 4\\,K_{dd} - K_{sd} - P_{4s}$$\n$$\\Delta E \\approx -2.0773\\,\\text{eV} - 4\\,K_{dd} - K_{sd} - P_{4s}$$\n这是需要实现的最终表达式。负的常数项表明，仅单电子能量就倾向于 $3d^5\\,4s^1$ 构型。交换和配对项（取决于参数 $K_{dd}$、$K_{sd}$ 和 $P_{4s}$）进一步加剧了这种差异，由于这些参数是正的物理量，通常会使差异更负。在此模型中，这证明了半充满 d 壳层构型的反常稳定性。以下程序将为提供的测试用例计算 $\\Delta E$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the energy difference between the 3d^5 4s^1 and 3d^4 4s^2\n    configurations of Chromium based on a simplified model.\n    \"\"\"\n\n    # Test suite cases: (K_dd, K_sd, P_4s) in eV.\n    test_cases = [\n        (0.6, 0.1, 1.2),  # Case A\n        (0.0, 0.0, 0.0),  # Case B\n        (1.0, 0.2, 1.5),  # Case C\n        (0.3, 0.0, 0.5),  # Case D\n        (0.0, 0.5, 0.0),  # Case E\n    ]\n\n    results = []\n    \n    # Constants\n    R_eV = 13.6  # Rydberg energy in eV\n    Z = 24       # Atomic number of Chromium\n\n    for case in test_cases:\n        K_dd, K_sd, P_4s = case\n        \n        # --- Total energy for configuration 1: 3d^5 4s^1 ---\n        # Configuration parameters\n        N_d1, M1 = 5, 1\n\n        # Screening and effective nuclear charge\n        S_3d1 = 18.0 + 0.35 * (N_d1 - 1)\n        Z_eff_3d1 = Z - S_3d1\n        \n        S_4s1 = 0.35 * (M1 - 1) + 1.00 * N_d1 + 0.85 * 8 + 1.00 * 10\n        Z_eff_4s1 = Z - S_4s1\n\n        # One-electron energies\n        E_3d1 = -R_eV * (Z_eff_3d1**2) / (3**2)\n        E_4s1 = -R_eV * (Z_eff_4s1**2) / (4**2)\n        E_one1 = N_d1 * E_3d1 + M1 * E_4s1\n\n        # Interaction energies\n        N_parallel_dd1 = 10  # C(5,2)\n        N_parallel_sd1 = 5\n        E_exch1 = -K_dd * N_parallel_dd1 - K_sd * N_parallel_sd1\n        E_pair1 = 0.0\n\n        E_tot1 = E_one1 + E_exch1 + E_pair1\n\n        # --- Total energy for configuration 2: 3d^4 4s^2 ---\n        # Configuration parameters\n        N_d2, M2 = 4, 2\n\n        # Screening and effective nuclear charge\n        S_3d2 = 18.0 + 0.35 * (N_d2 - 1)\n        Z_eff_3d2 = Z - S_3d2\n        \n        S_4s2 = 0.35 * (M2 - 1) + 1.00 * N_d2 + 0.85 * 8 + 1.00 * 10\n        Z_eff_4s2 = Z - S_4s2\n\n        # One-electron energies\n        E_3d2 = -R_eV * (Z_eff_3d2**2) / (3**2)\n        E_4s2 = -R_eV * (Z_eff_4s2**2) / (4**2)\n        E_one2 = N_d2 * E_3d2 + M2 * E_4s2\n\n        # Interaction energies\n        N_parallel_dd2 = 6  # C(4,2)\n        N_parallel_sd2 = 4\n        E_exch2 = -K_dd * N_parallel_dd2 - K_sd * N_parallel_sd2\n        E_pair2 = P_4s\n\n        E_tot2 = E_one2 + E_exch2 + E_pair2\n        \n        # --- Energy difference ----\n        delta_E = E_tot1 - E_tot2\n        \n        # Append result rounded to three decimal places\n        results.append(f\"{delta_E:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2450014"}, {"introduction": "轨道能量不仅仅是理论上的记账工具，它们与化学物种的真实物理稳定性密切相关。在本练习中，我们将运用科普曼定理（Koopmans' theorem），将一个可测量的热力学量——第二电子亲和能（$EA_2$）——与最高占据分子轨道（HOMO）的能量联系起来。通过这个计算实践，你将揭示为何像气相 $O^{2-}$ 这样的双负离子是不稳定的，并深刻理解正值轨道能量在物理上意味着一个非束缚的、会自发失去电子的状态 [@problem_id:2449994]。", "problem": "您需要编写一个完整、可运行的程序，该程序基于能量守恒和轨道能量诠释，通过第一性原理推导来计算一组阴离子的最高占据分子轨道（HOMO）能量。\n\n请在 Hartree-Fock (HF) 理论和 Koopmans 定理的框架内进行，并且仅使用以下基本依据：(i) 能量守恒，(ii) 电子亲和能作为相对于真空能级的能量变化的定义，以及 (iii) 将轨道能量与移除电子时的能量变化相关联的 Koopmans 定理。零点参考能量是真空能级，即所有电子和原子核都无限分离的状态。最高占据分子轨道（HOMO）能量 $\\varepsilon_{\\text{HOMO}}$ 应相对于此真空参考系进行诠释。\n\n使用的定义和假设：\n- 考虑向单阴离子 $A^{-}$ 添加一个电子形成双阴离子 $A^{2-}$ 的过程：$A^{-} + e^{-} \\to A^{2-}$。将第二电子亲和能 $\\mathrm{EA}_{2}$ 定义为该过程释放的能量，以电子伏特（eV）为单位。因此，$\\mathrm{EA}_{2} > 0$ 表示放热附着，$\\mathrm{EA}_{2} < 0$ 表示吸热附着。\n- 设电子脱附（逆过程）$A^{2-} \\to A^{-} + e^{-}$ 的热力学能量变化为 $\\Delta$。根据能量守恒，$\\Delta$ 等于附着能的负值，因此根据上述符号约定，$\\Delta$ 和 $\\mathrm{EA}_{2}$ 之间存在直接关系。\n- Hartree-Fock 理论中的 Koopmans 定理指出，从占据 HOMO 的状态中移除一个电子所需的能量变化约等于 HOMO 轨道能量的负值。特别地，如果脱附的能量变化（相对于真空）为 $\\Delta$，则 $\\varepsilon_{\\text{HOMO}} \\approx -\\Delta$。\n- 相对于真空能级诠释 $\\varepsilon_{\\text{HOMO}}$：如果 $\\varepsilon_{\\text{HOMO}} > 0$，则该轨道位于真空能级之上，不是一个束缚态；如果 $\\varepsilon_{\\text{HOMO}} \\le 0$，则该轨道位于或低于真空能级，表示一个临界束缚态或束缚态。\n\n任务：\n- 仅使用上述原理，推导您的程序必须实现的、用于从 $\\mathrm{EA}_{2}$（单位 eV）计算 $\\varepsilon_{\\text{HOMO}}$（单位 eV）的表达式。\n- 根据 $\\varepsilon_{\\text{HOMO}}$ 的符号，判断该双阴离子在气相中是否对自电离不稳定。对于此问题，定义一个布尔型不稳定性标志如下：如果 $\\varepsilon_{\\text{HOMO}} > 0$ 则返回 $\\text{True}$，否则返回 $\\text{False}$。\n\n物理和数值单位：\n- 所有能量必须以电子伏特（eV）表示。\n- 您的程序必须输出四舍五入到三位小数的 HOMO 能量。\n\n测试用例：\n为以下第二电子亲和能 $\\mathrm{EA}_{2}$ 的有序列表计算输出，每个值均以电子伏特（eV）为单位给出：\n1. 假设的气相 $O^{2-}$：$\\mathrm{EA}_{2} = -7.50$（吸热附着）。\n2. 临界状态的假设双阴离子：$\\mathrm{EA}_{2} = 0.00$。\n3. 假设的稳定双阴离子：$\\mathrm{EA}_{2} = +0.50$。\n4. 假设的气相 $F^{2-}$：$\\mathrm{EA}_{2} = -10.00$。\n5. 近阈值的假设双阴离子：$\\mathrm{EA}_{2} = -0.05$。\n\n答案规格和输出格式：\n- 对于每个测试用例，输出一个包含两个元素的列表：$[\\varepsilon_{\\text{HOMO}} \\text{（单位 eV，四舍五入到三位小数）}, \\text{不稳定性布尔值}]$。\n- 将所有测试用例的结果按顺序汇总到一个列表中。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如：$[[x_1,b_1],[x_2,b_2],\\dots]$，其中每个 $x_i$ 是一个浮点数，每个 $b_i$ 是一个布尔值。", "solution": "所述问题是有效的。它在科学上基于量子化学的原理，特别是 Hartree-Fock 理论和 Koopmans 定理，并且在数学上是适定的和内部一致的。它要求基于能量的基本定义进行严格的推导，我现在将提供此推导。\n\n任务是根据相应单阴离子 $A^{-}$ 的第二电子亲和能 $\\mathrm{EA}_{2}$，计算双阴离子 $A^{2-}$ 的最高占据分子轨道（HOMO）能量 $\\varepsilon_{\\text{HOMO}}$。我们还必须确定该双阴离子是否对自电离不稳定。推导过程将利用所提供的物理原理，形式上将给定量 $\\mathrm{EA}_{2}$ 与所求量 $\\varepsilon_{\\text{HOMO}}$ 联系起来。\n\n首先，我们将能量关系形式化。所有能量的参考点是真空能级，其值设为 $0$。一个与原子核无限分离的静止电子的能量为零。\n\n问题考虑了电子附着过程：\n$$ A^{-} + e^{-} \\to A^{2-} $$\n第二电子亲和能 $\\mathrm{EA}_{2}$ 被定义为在此过程中*释放*的能量。根据标准热力学约定，系统释放的能量对应于系统内能的负变化。设物种的总能量为 $E(A^{-})$ 和 $E(A^{2-})$，自由电子的能量为 $E(e^{-}) = 0$。附着反应的能量变化 $\\Delta E_{\\text{attach}}$ 为：\n$$ \\Delta E_{\\text{attach}} = E_{\\text{final}} - E_{\\text{initial}} = E(A^{2-}) - (E(A^{-}) + E(e^{-})) = E(A^{2-}) - E(A^{-}) $$\n第二电子亲和能 $\\mathrm{EA}_{2}$ 是该能量变化的负值：\n$$ \\mathrm{EA}_{2} = -\\Delta E_{\\text{attach}} = -(E(A^{2-}) - E(A^{-})) = E(A^{-}) - E(A^{2-}) $$\n正的 $\\mathrm{EA}_{2}$ 表示一个放热过程，其中产物 $A^{2-}$ 比反应物 $A^{-} + e^{-}$ 更稳定（能量更低）。负的 $\\mathrm{EA}_{2}$ 表示一个吸热过程，其中必须提供能量才能形成 $A^{2-}$ 物种，该物种比反应物更不稳定。\n\n接下来，我们考虑电子脱附过程，即附着的逆过程：\n$$ A^{2-} \\to A^{-} + e^{-} $$\n该过程的能量变化被定为 $\\Delta$。使用相同的能量定义：\n$$ \\Delta = E_{\\text{final}} - E_{\\text{initial}} = (E(A^{-}) + E(e^{-})) - E(A^{2-}) = E(A^{-}) - E(A^{2-}) $$\n通过比较 $\\mathrm{EA}_{2}$ 和 $\\Delta$ 的表达式，我们建立了直接关系：\n$$ \\Delta = \\mathrm{EA}_{2} $$\n\n最后一步是引用 Koopmans 定理。该定理在 Hartree-Fock 近似中指出，从特定轨道移除一个电子所需的能量（即该轨道的电离能）约等于该轨道能量 $\\varepsilon$ 的负值。对于 $A^{2-}$ 物种中最高占据分子轨道（HOMO）中的电子，其移除所需的能量即为脱附能 $\\Delta$。因此，Koopmans 定理给出了如下近似：\n$$ \\Delta \\approx -\\varepsilon_{\\text{HOMO}} $$\n现在，我们结合推导出的关系。由于 $\\Delta = \\mathrm{EA}_{2}$ 且 $\\Delta \\approx -\\varepsilon_{\\text{HOMO}}$，我们得到：\n$$ \\mathrm{EA}_{2} \\approx -\\varepsilon_{\\text{HOMO}} $$\n重新整理此方程以求解 HOMO 能量，得到我们计算的核心公式：\n$$ \\varepsilon_{\\text{HOMO}} \\approx -\\mathrm{EA}_{2} $$\n所有能量均以电子伏特（eV）为单位。\n\n问题的第二部分是确定双阴离子 $A^{2-}$ 在气相中的稳定性。轨道能量 $\\varepsilon$ 是衡量该轨道中电子相对于真空能级（$E=0$）的能量。\n- 如果 $\\varepsilon_{\\text{HOMO}} \\le 0$，HOMO 中的电子处于束缚态或临界束缚态。$A^{2-}$ 系统的能量等于或低于 $A^{-} + e^{-}$ 系统的能量。该双阴离子不会自发失去电子。\n- 如果 $\\varepsilon_{\\text{HOMO}} > 0$，HOMO 中的电子具有正的总能量。它未被束缚在阴离子上。这样的状态是一种共振态，而非真正的束缚态，并且该双阴离子对自电离不稳定，意味着它会自发地射出电子。\n问题要求一个布尔型不稳定性标志，如果双阴离子不稳定，则为 `True`。因此，不稳定的条件是：\n$$ \\text{instability} = (\\varepsilon_{\\text{HOMO}} > 0) $$\n代入我们推导出的 $\\varepsilon_{\\text{HOMO}}$ 表达式：\n$$ \\text{instability} = (-\\mathrm{EA}_{2} > 0) \\implies (\\mathrm{EA}_{2} < 0) $$\n这个结果在物理上是直观的：负的第二电子亲和能意味着附着过程是吸热的，即生成的双阴离子的能量高于分离的单阴离子和电子的能量，因此对电子损失不稳定。\n\n需要实现的算法如下：\n1. 对于每个 $\\mathrm{EA}_{2}$（单位 eV）的输入值：\n2. 计算 HOMO 能量：$\\varepsilon_{\\text{HOMO}} = -\\mathrm{EA}_{2}$。\n3. 确定不稳定性标志：如果 $\\varepsilon_{\\text{HOMO}} > 0$，则为 `True`，否则为 `False`。\n4. 将 $\\varepsilon_{\\text{HOMO}}$ 的值四舍五入到三位小数。\n5. 将结果存储为一个包含两个元素的列表：$[\\text{四舍五入后的 } \\varepsilon_{\\text{HOMO}}, \\text{不稳定性标志}]$。\n6. 将所有结果汇总到一个最终列表中。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the HOMO energy and instability for a set of anions based on\n    their second electron affinities, using Koopmans' theorem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each value is a second electron affinity (EA_2) in electronvolts (eV).\n    test_cases = [\n        -7.50,   # Hypothetical gas-phase O^2-\n        0.00,    # Borderline hypothetical dianion\n        0.50,    # Hypothetical stable dianion\n        -10.00,  # Hypothetical gas-phase F^2-\n        -0.05    # Near-threshold hypothetical dianion\n    ]\n\n    results = []\n    for ea2 in test_cases:\n        # According to the derivation based on Koopmans' theorem and the\n        # definition of electron affinity:\n        # epsilon_HOMO is approximately -EA_2.\n        # The energy is given in eV, and no unit conversion is necessary.\n        epsilon_homo = -ea2\n\n        # The instability is determined by the sign of the HOMO energy.\n        # A positive HOMO energy (relative to the vacuum level at 0) indicates\n        # that the electron is not in a bound state, and the dianion will\n        # autoionize. The problem defines instability as True if epsilon_HOMO > 0.\n        is_unstable = epsilon_homo > 0\n\n        # The problem requires the HOMO energy to be rounded to three decimal places.\n        # The instability flag must be determined from the unrounded value to\n        # correctly handle cases near zero.\n        rounded_epsilon_homo = round(epsilon_homo, 3)\n\n        # The result for each case is a two-element list.\n        result = [rounded_epsilon_homo, is_unstable]\n        results.append(result)\n\n    # The final output must be a single string representing the list of lists.\n    # The format is a comma-separated list of the inner lists, enclosed\n    # in square brackets.\n    # e.g., [[val1, bool1],[val2, bool2],...]\n    # Using map(str, results) and ','.join() correctly formats the output\n    # as specified by the problem.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2449994"}, {"introduction": "在实际的量子化学计算中，我们得到的能量值高度依赖于所选用的“基组”的完备性。这个练习将带你从执行单一计算，跨越到追求高精度结果的科学实践。你将学习一种在科研中至关重要的技术——基组外推法，通过分析一系列使用相关一致性基组（cc-pVXZ）计算得到的能量，系统地将结果外推至“完备基组极限”（CBS limit）。这个过程不仅能让你获得对氖原子基态能量更精确的估计，也让你体验到严谨的计算化学研究所需的细致与洞察力 [@problem_id:2449970]。", "problem": "编写一个完整、可运行的程序，通过基组外推至完全基组 (CBS) 极限的方法，计算氖原子在限制性Hartree-Fock (RHF) 近似下的基态总能量。该计算使用相关一致性极化价电子 $X$-zeta (cc-pVXZ) 基组，其中 $X \\in \\{2,3,4\\}$ 分别对应于双zeta (D)、三zeta (T) 和四zeta (Q) 基数。使用以下数学定义的模型来描述RHF总能量相对于基组基数的渐近收敛行为：\n$$\nE_X \\;=\\; E_{\\infty} \\;+\\; A\\,X^{-p}\n$$\n其中 Hartree-Fock 指数固定为 $p = 4$， $E_X$ 是基数为 $X$ 时的 RHF 总能量，$E_{\\infty}$ 是 CBS 极限下的 RHF 总能量，$A$ 是一个常数。所有能量必须以哈特里（原子单位）处理和报告。\n\n使用以下氖 (Ne) 的数据，这些数据是使用 cc-pVXZ 基组计算得到的 RHF 总能量：\n- 对于 $X=2$ (cc-pVDZ)：$E_2 = -128.5221$ 哈特里。\n- 对于 $X=3$ (cc-pVTZ)：$E_3 = -128.54216172839506$ 哈特里。\n- 对于 $X=4$ (cc-pVQZ)：$E_4 = -128.5455375$ 哈特里。\n\n您的程序必须计算三个 CBS 极限估计值，每个估计值都是一个以哈特里为单位的实数：\n1. 仅使用 $X \\in \\{2,3\\}$ 和模型 $E_X = E_{\\infty} + A\\,X^{-4}$ 进行两点外推。\n2. 仅使用 $X \\in \\{3,4\\}$ 和相同的模型进行两点外推。\n3. 对 $X \\in \\{2,3,4\\}$ 的数据，应用参数线性模型 $E_X = E_{\\infty} + A\\,X^{-4}$ 进行三点最小二乘拟合，即估计使残差平方和最小的 $E_{\\infty}$。\n\n测试套件和要求的输出：\n- 测试用例 1：输入对 $\\{(X,E_X)\\} = \\{(2,-128.5221),(3,-128.54216172839506)\\}$，$p=4$。输出外推得到的 $E_{\\infty}$，单位为哈特里，格式为浮点数。\n- 测试用例 2：输入对 $\\{(X,E_X)\\} = \\{(3,-128.54216172839506),(4,-128.5455375)\\}$，$p=4$。输出外推得到的 $E_{\\infty}$，单位为哈特里，格式为浮点数。\n- 测试用例 3：输入三元组 $\\{(X,E_X)\\} = \\{(2,-128.5221),(3,-128.54216172839506),(4,-128.5455375)\\}$，$p=4$。输出通过最小二乘法估计的 $E_{\\infty}$，单位为哈特里，格式为浮点数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含按顺序排列的三个结果，形式为逗号分隔的列表，并用方括号括起来。每个值都应四舍五入到六位小数，并以哈特里为单位表示，例如：\n\"[v1,v2,v3]\"。", "solution": "对问题陈述进行验证。\n\n**1. 提取已知条件：**\n- **物理体系：** 氖 (Ne) 原子，基态。\n- **理论模型：** 限制性Hartree-Fock (RHF) 近似。\n- **外推模型：** 假设对于 cc-pVXZ 基组，基数为 $X$ 时的总 RHF 能量 $E_X$ 根据公式 $E_X = E_{\\infty} + A\\,X^{-p}$ 收敛到完全基组 (CBS) 极限 $E_{\\infty}$。\n- **模型参数：** 指数固定为 $p = 4$。\n- **输入数据（能量单位：哈特里）：**\n  - 对于 $X=2$：$E_2 = -128.5221$。\n  - 对于 $X=3$：$E_3 = -128.54216172839506$。\n  - 对于 $X=4$：$E_4 = -128.5455375$。\n- **计算任务：**\n  1.  使用 $X \\in \\{2, 3\\}$ 的数据通过两点外推计算 $E_{\\infty}$。\n  2.  使用 $X \\in \\{3, 4\\}$ 的数据通过两点外推计算 $E_{\\infty}$。\n  3.  使用 $X \\in \\{2, 3, 4\\}$ 的数据通过三点最小二乘拟合计算 $E_{\\infty}$。\n\n**2. 验证：**\n- **科学依据：** 该问题牢固地植根于计算量子化学。RHF方法、cc-pVXZ基组和基组外推是标准的、广为接受的概念。所选模型 $E_X = E_{\\infty} + A\\,X^{-p}$ 是描述 Hartree-Fock 能量渐近收敛的常规有效形式。所提供的数据对于指定的体系和方法在数值上是符合实际的。\n- **适定性：** 所有三个计算任务都是适定的。两点外推对应于求解一个包含两个未知数的两个线性方程组，该方程组有唯一解。三点拟合是一个标准的线性最小二乘问题，由于设计矩阵是满秩的，它也能得到唯一解。\n- **客观性：** 问题陈述使用了精确、无歧义的数学和科学语言。\n\n**3. 结论：**\n该问题在科学上是合理的，内容是自洽的，并且在数学上是适定的。该问题是**有效的**。我们现在开始求解。\n\n核心任务是从给定的数据和模型中确定 CBS 极限能量 $E_{\\infty}$。我们将系统地处理三个所需的计算任务。\n\n**计算 1：使用 $X \\in \\{2, 3\\}$ 进行两点外推**\n\n对于两个不同的基数 $X_i$ 和 $X_j$，该模型提供了一个包含两个未知数 $E_{\\infty}$ 和 $A$ 的两个线性方程组：\n$$\n\\begin{cases}\nE_{X_i} = E_{\\infty} + A \\, X_i^{-p} \\\\\nE_{X_j} = E_{\\infty} + A \\, X_j^{-p}\n\\end{cases}\n$$\n求解该方程组以得到 $E_{\\infty}$，得出两点外推的通用公式：\n$$\nE_{\\infty} = \\frac{E_{X_j} X_j^p - E_{X_i} X_i^p}{X_j^p - X_i^p}\n$$\n对于本例，我们使用 $X_i = 2$ 和 $X_j = 3$，指数 $p=4$。数据为 $E_2 = -128.5221$ 和 $E_3 = -128.54216172839506$。\n将这些值代入公式：\n$$\nE_{\\infty, \\{2,3\\}} = \\frac{E_3 \\cdot 3^4 - E_2 \\cdot 2^4}{3^4 - 2^4} = \\frac{E_3 \\cdot 81 - E_2 \\cdot 16}{81 - 16} = \\frac{81 E_3 - 16 E_2}{65}\n$$\n代入能量的数值：\n$$\nE_{\\infty, \\{2,3\\}} = \\frac{81(-128.54216172839506) - 16(-128.5221)}{65} = \\frac{-10411.91510000000 + 2056.3536}{65} = \\frac{-8355.5615}{65} = -128.5471\n$$\n\n**计算 2：使用 $X \\in \\{3, 4\\}$ 进行两点外推**\n\n此计算与第一个类似，但使用 $X_i = 3$ 和 $X_j = 4$ 的数据点，且 $p=4$。数据为 $E_3 = -128.54216172839506$ 和 $E_4 = -128.5455375$。\n使用相同的通用公式：\n$$\nE_{\\infty, \\{3,4\\}} = \\frac{E_4 \\cdot 4^4 - E_3 \\cdot 3^4}{4^4 - 3^4} = \\frac{E_4 \\cdot 256 - E_3 \\cdot 81}{256 - 81} = \\frac{256 E_4 - 81 E_3}{175}\n$$\n代入能量的数值：\n$$\nE_{\\infty, \\{3,4\\}} = \\frac{256(-128.5455375) - 81(-128.54216172839506)}{175} = \\frac{-32907.6576 + 10411.91510000000}{175} = \\frac{-22495.7425}{175} = -128.5471\n$$\n\n**计算 3：使用 $X \\in \\{2, 3, 4\\}$ 进行三点最小二乘拟合**\n\n模型 $E_X = E_{\\infty} + A\\,X^{-4}$ 在其参数 $E_{\\infty}$ 和 $A$ 上是线性的。对于三个数据点 $(X, E_X)$，我们可以建立一个超定线性方程组。令 $\\beta_0 = E_{\\infty}$，$\\beta_1 = A$，预测变量为 $z_X = X^{-4}$。则模型变为 $E_X = \\beta_0 + \\beta_1 z_X$。\n该系统可以写成矩阵形式 $\\mathbf{y} = \\mathbf{M}\\mathbf{\\beta}$：\n$$\n\\mathbf{y} = \\begin{pmatrix} E_2 \\\\ E_3 \\\\ E_4 \\end{pmatrix}, \\quad \\mathbf{M} = \\begin{pmatrix} 1 & 2^{-4} \\\\ 1 & 3^{-4} \\\\ 1 & 4^{-4} \\end{pmatrix}, \\quad \\mathbf{\\beta} = \\begin{pmatrix} E_{\\infty} \\\\ A \\end{pmatrix}\n$$\n线性最小二乘法旨在找到向量 $\\hat{\\mathbf{\\beta}}$，以最小化残差平方和 $\\|\\mathbf{y} - \\mathbf{M}\\hat{\\mathbf{\\beta}}\\|^2$。解由正规方程给出：\n$$\n\\hat{\\mathbf{\\beta}} = (\\mathbf{M}^T \\mathbf{M})^{-1} \\mathbf{M}^T \\mathbf{y}\n$$\n所得向量 $\\hat{\\mathbf{\\beta}}$ 的第一个分量是 $E_{\\infty}$ 的最小二乘估计值。鉴于两次两点外推得出了相同的结果，这表明所提供的数据点完全位于指定的曲线上。因此，最小二乘拟合将找到这条残差误差为零的精确曲线，并且得到的 $E_{\\infty}$ 估计值必须相同。\n执行数值矩阵计算可以证实这一点：\n$$\n\\hat{E}_{\\infty, \\{2,3,4\\}} = -128.5471\n$$\n所有三种方法都得出了相同的 CBS 极限能量估计值，$E_{\\infty} = -128.5471$ 哈特里。最后一步是按要求格式化这些结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ground-state total RHF energy of a neon atom at the \n    Complete Basis Set (CBS) limit by extrapolation.\n    \"\"\"\n    \n    # Define the problem data\n    # neon_rhf_energies is a dictionary mapping cardinal number X to energy E_X in Hartree.\n    neon_rhf_energies = {\n        2: -128.5221,\n        3: -128.54216172839506,\n        4: -128.5455375\n    }\n    # The exponent in the extrapolation model E_X = E_inf + A*X**(-p)\n    p = 4.0\n\n    # test_cases is a list of tuples, where each tuple defines a computational task.\n    # The first element is the method name, and the second is a list of cardinal numbers (X) to use.\n    test_cases = [\n        (\"two-point\", [2, 3]),\n        (\"two-point\", [3, 4]),\n        (\"three-point-lsq\", [2, 3, 4])\n    ]\n\n    results = []\n    \n    # --- Calculation 1: Two-point extrapolation for X = {2, 3} ---\n    X1, X2 = test_cases[0][1]\n    E1, E2 = neon_rhf_energies[X1], neon_rhf_energies[X2]\n    # General formula for 2-point extrapolation: E_inf = (E2*X2**p - E1*X1**p) / (X2**p - X1**p)\n    E_inf_1 = (E2 * (X2**p) - E1 * (X1**p)) / (X2**p - X1**p)\n    results.append(E_inf_1)\n\n    # --- Calculation 2: Two-point extrapolation for X = {3, 4} ---\n    X1, X2 = test_cases[1][1]\n    E1, E2 = neon_rhf_energies[X1], neon_rhf_energies[X2]\n    E_inf_2 = (E2 * (X2**p) - E1 * (X1**p)) / (X2**p - X1**p)\n    results.append(E_inf_2)\n\n    # --- Calculation 3: Three-point least-squares fit for X = {2, 3, 4} ---\n    Xs = np.array(test_cases[2][1], dtype=np.float64)\n    Es = np.array([neon_rhf_energies[x] for x in Xs], dtype=np.float64)\n\n    # The model is E_X = E_inf + A * X**(-p), which is a linear model\n    # of the form y = beta0 + beta1 * z, where y=E_X, z=X**(-p), beta0=E_inf, beta1=A.\n    # We construct the design matrix M for the linear system M*beta = E.\n    z = Xs**(-p)\n    M = np.vstack([np.ones(len(z)), z]).T\n    \n    # Solve the system using numpy's least-squares function.\n    # The function returns a tuple; the first element contains the solution [E_inf, A].\n    beta, _, _, _ = np.linalg.lstsq(M, Es, rcond=None)\n    E_inf_3 = beta[0]\n    results.append(E_inf_3)\n\n    # Format the results to six decimal places as specified.\n    # The format string ensures that each number is rounded and displayed correctly.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2449970"}]}