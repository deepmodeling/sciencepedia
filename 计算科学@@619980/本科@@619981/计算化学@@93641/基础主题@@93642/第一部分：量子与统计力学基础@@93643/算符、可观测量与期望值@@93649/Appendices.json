{"hands_on_practices": [{"introduction": "本练习将深入探讨量子力学中的一个核心模型——“无限深势阱中的粒子”。我们将计算一个处于两个能量本征态叠加态的粒子的能量期望值 [@problem_id:2459745]。这个实践旨在阐明一个关键概念：对于一个由多个本征态线性组合而成的量子态，其可观测量的期望值（如此处的能量）是相应本征值的加权平均，权重为各个本征态在叠加态中所占的概率。", "problem": "在计算化学中，盒中粒子模型是用于描述电子在共轭链段中受限运动的一种标准近似。考虑一个质量为 $m$ 的无自旋粒子，被限制在宽度为 $L$ 的一维 (1D) 无限深势阱中，其势能为 $V(x)=0$（当 $0<x<L$ 时）及 $V(x)=\\infty$（其他情况）。设 $\\{\\psi_{n}(x)\\}$ 为此势阱哈密顿算符 $\\hat{H}$ 的归一化定态能量本征函数，其对应的能量本征值为 $\\{E_{n}\\}$。\n\n在 $t=0$ 时刻，该粒子处于归一化的状态\n$$\n\\Psi(x,0) \\;=\\; \\frac{1}{\\sqrt{5}}\\big(\\psi_{1}(x) + 2\\,\\psi_{2}(x)\\big).\n$$\n使用可观测量算符形式和期望值的定义，求出 $t=0$ 时刻能量的精确期望值。以 $m$、$L$ 和约化普朗克常数 $\\hbar$ 的形式，给出封闭形式的解析表达式作为最终答案。以焦耳为单位表示最终能量。请勿代入数值。", "solution": "在尝试求解之前，将首先对问题进行严格的验证。\n\n### 步骤1：提取已知条件\n问题陈述中提供了以下信息：\n- **系统**：质量为 $m$ 的无自旋粒子。\n- **约束**：宽度为 $L$ 的一维 (1D) 无限深势阱。\n- **势能**：当 $0<x<L$ 时，$V(x)=0$，其他情况 $V(x)=\\infty$。\n- **本征函数**：$\\{\\psi_{n}(x)\\}$ 是哈密顿算符 $\\hat{H}$ 的归一化定态能量本征函数。\n- **本征值**：$\\{E_{n}\\}$ 是对应的能量本征值。\n- **$t=0$ 时的状态**：粒子处于归一化状态 $\\Psi(x,0) = \\frac{1}{\\sqrt{5}}\\big(\\psi_{1}(x) + 2\\,\\psi_{2}(x)\\big)$。\n- **目标**：以 $m$、$L$ 和 $\\hbar$ 的形式，求出 $t=0$ 时能量的精确期望值的封闭形式解析表达式。\n- **约束**：以焦耳为单位表示最终能量。请勿代入数值。\n\n### 步骤2：使用提取的已知条件进行验证\n根据所需标准对问题进行评估。\n\n1.  **科学依据**：该问题基于盒中粒子模型，这是入门量子力学的基石。所有概念——哈密顿算符、本征函数、本征值、叠加原理和期望值——都是量子理论的基础。该问题在科学上是合理的。\n2.  **适定性与客观性**：该问题指定了一个明确的物理系统和初始状态，并要求一个唯一可确定的量，即能量的期望值。语言精确、客观。\n3.  **不完整或矛盾的设定**：该问题提供了所有必要信息。它声明初始状态 $\\Psi(x,0)$ 是归一化的。这一点可以验证。该状态是一个叠加态 $\\Psi(x,0) = c_{1}\\psi_{1}(x) + c_{2}\\psi_{2}(x)$，系数为 $c_{1} = \\frac{1}{\\sqrt{5}}$ 和 $c_{2} = \\frac{2}{\\sqrt{5}}$。为了归一化，系数的模平方和必须为1，因为基函数 $\\{\\psi_{n}(x)\\}$ 是正交归一的。我们检验：$|c_{1}|^2 + |c_{2}|^2 = \\left(\\frac{1}{\\sqrt{5}}\\right)^2 + \\left(\\frac{2}{\\sqrt{5}}\\right)^2 = \\frac{1}{5} + \\frac{4}{5} = 1$。该状态确实是归一化的。问题是自洽的，没有矛盾。\n4.  **不切实际或不可行**：盒中粒子是一个理想化模型，但它是一种标准且有物理意义的近似。数据是符号性的。要求以焦耳表示能量，这与最终能量解析表达式在国际单位制 (SI) 中单位为焦耳的事实是一致的。它不要求数值，从而避免了与“请勿代入”规则的任何矛盾。\n5.  **不适定或结构不良**：该问题结构清晰，使用了量子力学中标准的、无歧义的术语。存在唯一的、有意义的解。\n\n### 步骤3：结论与行动\n问题是 **有效的**。这是一个标准的、适定的量子力学问题。我将继续进行求解。\n\n对于一个处于状态 $\\Psi$ 的系统，由算符 $\\hat{A}$ 表示的可观测量，其期望值由通用公式 $\\langle A \\rangle = \\int \\Psi^* \\hat{A} \\Psi \\, d\\tau$ 给出。对于能量这个可观测量，其算符是哈密顿算符 $\\hat{H}$。在 $t=0$ 时刻，能量的期望值 $\\langle E \\rangle$ 为：\n$$\n\\langle E \\rangle = \\langle \\hat{H} \\rangle_{t=0} = \\int_{0}^{L} \\Psi^*(x,0) \\hat{H} \\Psi(x,0) \\, dx\n$$\n状态 $\\Psi(x,0)$ 被给出为能量本征函数 $\\psi_{1}(x)$ 和 $\\psi_{2}(x)$ 的叠加：\n$$\n\\Psi(x,0) = \\frac{1}{\\sqrt{5}}\\psi_{1}(x) + \\frac{2}{\\sqrt{5}}\\psi_{2}(x)\n$$\n根据定义，函数 $\\psi_{n}(x)$ 是哈密顿算符 $\\hat{H}$ 的本征函数，对应的能量本征值为 $E_{n}$。这种关系表示为 $\\hat{H}\\psi_{n}(x) = E_{n}\\psi_{n}(x)$。\n\n我们可以将哈密顿算符作用于状态 $\\Psi(x,0)$：\n$$\n\\hat{H}\\Psi(x,0) = \\hat{H}\\left(\\frac{1}{\\sqrt{5}}\\psi_{1}(x) + \\frac{2}{\\sqrt{5}}\\psi_{2}(x)\\right) = \\frac{1}{\\sqrt{5}}\\hat{H}\\psi_{1}(x) + \\frac{2}{\\sqrt{5}}\\hat{H}\\psi_{2}(x) = \\frac{1}{\\sqrt{5}}E_{1}\\psi_{1}(x) + \\frac{2}{\\sqrt{5}}E_{2}\\psi_{2}(x)\n$$\n将此结果代入期望值的积分中，得到：\n$$\n\\langle E \\rangle = \\int_{0}^{L} \\left(\\frac{1}{\\sqrt{5}}\\psi_{1}^*(x) + \\frac{2}{\\sqrt{5}}\\psi_{2}^*(x)\\right) \\left(\\frac{1}{\\sqrt{5}}E_{1}\\psi_{1}(x) + \\frac{2}{\\sqrt{5}}E_{2}\\psi_{2}(x)\\right) \\, dx\n$$\n展开积分内的乘积会产生四项。我们可以利用这样一个事实：厄米算符的能量本征函数集 $\\{\\psi_{n}(x)\\}$ 构成一个正交归一集，即 $\\int_{0}^{L} \\psi_{m}^*(x) \\psi_{n}(x) \\, dx = \\delta_{mn}$，其中 $\\delta_{mn}$ 是克罗内克 δ 函数。\n$$\n\\langle E \\rangle = \\frac{1}{5}E_{1}\\int_{0}^{L}\\psi_{1}^*(x)\\psi_{1}(x)dx + \\frac{2}{5}E_{2}\\int_{0}^{L}\\psi_{1}^*(x)\\psi_{2}(x)dx + \\frac{2}{5}E_{1}\\int_{0}^{L}\\psi_{2}^*(x)\\psi_{1}(x)dx + \\frac{4}{5}E_{2}\\int_{0}^{L}\\psi_{2}^*(x)\\psi_{2}(x)dx\n$$\n应用正交归一性条件 $\\int\\psi_{1}^*\\psi_{1}dx=1$，$\\int\\psi_{2}^*\\psi_{2}dx=1$ 和 $\\int\\psi_{1}^*\\psi_{2}dx = \\int\\psi_{2}^*\\psi_{1}dx=0$：\n$$\n\\langle E \\rangle = \\frac{1}{5}E_{1}(1) + \\frac{2}{5}E_{2}(0) + \\frac{2}{5}E_{1}(0) + \\frac{4}{5}E_{2}(1)\n$$\n$$\n\\langle E \\rangle = \\frac{1}{5}E_{1} + \\frac{4}{5}E_{2}\n$$\n这个结果展示了一个普遍原理：对于一个表示为归一化叠加态 $|\\Psi\\rangle = \\sum_{n} c_{n} |\\psi_{n}\\rangle$ 的状态，其能量期望值为 $\\langle E \\rangle = \\sum_{n} |c_{n}|^{2} E_{n}$。\n\n下一步是找出1D无限深势阱的能量本征值 $E_{n}$ 的表达式。这些是通过求解该系统的不含时薛定谔方程得到的标准结果，其解为：\n$$\nE_{n} = \\frac{n^2 \\pi^2 \\hbar^2}{2mL^2}\n$$\n其中 $n=1, 2, 3, \\dots$。\n\n我们需要 $n=1$ 和 $n=2$ 的具体本征值：\n$$\nE_{1} = \\frac{1^2 \\pi^2 \\hbar^2}{2mL^2} = \\frac{\\pi^2 \\hbar^2}{2mL^2}\n$$\n$$\nE_{2} = \\frac{2^2 \\pi^2 \\hbar^2}{2mL^2} = \\frac{4\\pi^2 \\hbar^2}{2mL^2}\n$$\n最后，我们将这些本征值表达式代入能量期望值 $\\langle E \\rangle$ 的公式中：\n$$\n\\langle E \\rangle = \\frac{1}{5}\\left(\\frac{\\pi^2 \\hbar^2}{2mL^2}\\right) + \\frac{4}{5}\\left(\\frac{4\\pi^2 \\hbar^2}{2mL^2}\\right)\n$$\n$$\n\\langle E \\rangle = \\frac{\\pi^2 \\hbar^2}{10mL^2} + \\frac{16\\pi^2 \\hbar^2}{10mL^2}\n$$\n合并各项得到最终结果：\n$$\n\\langle E \\rangle = \\frac{17\\pi^2 \\hbar^2}{10mL^2}\n$$\n这就是能量期望值的封闭形式解析表达式。其在国际单位制 (SI) 中的单位是焦耳，满足了问题的所有要求。", "answer": "$$\n\\boxed{\\frac{17\\pi^2\\hbar^2}{10mL^2}}\n$$", "id": "2459745"}, {"introduction": "接下来，我们将考察一个在环上运动的粒子，其波函数并非角动量算符的本征态。本练习要求你首先判断给定的状态是否为本征态，然后计算其角动量期望值 [@problem_id:2459766]。这个过程将凸显本征态与一般叠加态的根本区别，并让你通过积分定义实践如何计算非本征态的期望值，从而理解为何一个状态（如驻波）可以没有净动量，即使它本身并不对应一个确定的动量值。", "problem": "在计算化学中用于近似环上离域运动的平面刚性转子模型中（例如，在 Born–Oppenheimer (BO) 近似下，对限制在芳香环上的单个电子的简化描述），位形空间是由极角 $\\phi \\in [0, 2\\pi)$ 参数化的圆，并具有周期性边界条件。考虑作用于 $\\phi$ 的函数的、绕 $z$ 轴的正则角动量算符 $\\hat{L}_{z}$。提出了一个形式为 $\\Psi(\\phi) = A \\cos^{2}(\\phi)$ 的候选归一化态。\n\n仅使用量子力学中算符、可观测量和期望值的核心定义：\n- 确定与环上粒子的边界条件一致的归一化常数 $A$。\n- 在角表示下，评估 $\\Psi(\\phi)$ 是否为角动量算符 $\\hat{L}_{z}$ 的本征态，并通过检验算符在该态上的作用来证明你的结论。\n- 计算该态下的期望值 $\\langle \\hat{L}_{z} \\rangle$。用 $\\hbar$ 作单位表示你最终的期望值。不要四舍五入，提供一个精确值。", "solution": "问题陈述经审慎审查，认定有效。该问题具有科学依据、提法恰当、客观且完整。问题在标准的平面刚性转子模型框架下，探讨了量子力学的基本概念——归一化、本征态和期望值，该模型是对所描述物理系统的一个正确且恰当的简化。严谨求解所需的所有要素都已隐式或显式地提供。我们开始解答。\n\n问题要求对环上粒子的态 $\\Psi(\\phi) = A \\cos^{2}(\\phi)$ 进行三部分分析。\n\n首先，我们必须确定归一化常数 $A$。对于定义在区间 $\\phi \\in [0, 2\\pi)$ 上的波函数，其归一化条件为：其概率密度在整个位形空间上的积分必须等于 $1$。\n$$\n\\int_{0}^{2\\pi} \\Psi^{*}(\\phi) \\Psi(\\phi) d\\phi = 1\n$$\n鉴于所提出的态 $\\Psi(\\phi) = A \\cos^{2}(\\phi)$ 是一个实值函数，其复共轭 $\\Psi^{*}(\\phi)$ 等于 $\\Psi(\\phi)$。我们按照惯例选择归一化常数 $A$ 为正实数。该条件变为：\n$$\n\\int_{0}^{2\\pi} \\left(A \\cos^{2}(\\phi)\\right)^{2} d\\phi = A^{2} \\int_{0}^{2\\pi} \\cos^{4}(\\phi) d\\phi = 1\n$$\n为计算该积分，我们使用三角恒等式来降低余弦函数的幂次。我们从降幂公式 $\\cos^{2}(x) = \\frac{1}{2}(1 + \\cos(2x))$ 开始。\n$$\n\\cos^{4}(\\phi) = \\left(\\cos^{2}(\\phi)\\right)^{2} = \\left(\\frac{1 + \\cos(2\\phi)}{2}\\right)^{2} = \\frac{1}{4} \\left(1 + 2\\cos(2\\phi) + \\cos^{2}(2\\phi)\\right)\n$$\n再次对 $\\cos^{2}(2\\phi)$ 项应用降幂公式：\n$$\n\\cos^{2}(2\\phi) = \\frac{1 + \\cos(4\\phi)}{2}\n$$\n将其代回，我们得到：\n$$\n\\cos^{4}(\\phi) = \\frac{1}{4} \\left(1 + 2\\cos(2\\phi) + \\frac{1 + \\cos(4\\phi)}{2}\\right) = \\frac{1}{4} \\left(\\frac{3}{2} + 2\\cos(2\\phi) + \\frac{1}{2}\\cos(4\\phi)\\right)\n$$\n$$\n\\cos^{4}(\\phi) = \\frac{3}{8} + \\frac{1}{2}\\cos(2\\phi) + \\frac{1}{8}\\cos(4\\phi)\n$$\n现在我们可以将此表达式从 $0$ 积分到 $2\\pi$：\n$$\n\\int_{0}^{2\\pi} \\cos^{4}(\\phi) d\\phi = \\int_{0}^{2\\pi} \\left(\\frac{3}{8} + \\frac{1}{2}\\cos(2\\phi) + \\frac{1}{8}\\cos(4\\phi)\\right) d\\phi\n$$\n$\\cos(2\\phi)$ 和 $\\cos(4\\phi)$ 在一个完整周期 $[0, 2\\pi]$ 上的积分为零。\n$$\n\\int_{0}^{2\\pi} \\cos(n\\phi) d\\phi = \\left[\\frac{\\sin(n\\phi)}{n}\\right]_{0}^{2\\pi} = 0 \\quad \\text{其中整数 } n \\neq 0\n$$\n因此，积分简化为：\n$$\n\\int_{0}^{2\\pi} \\frac{3}{8} d\\phi = \\left[\\frac{3}{8}\\phi\\right]_{0}^{2\\pi} = \\frac{3}{8}(2\\pi) = \\frac{3\\pi}{4}\n$$\n将此结果代入归一化方程：\n$$\nA^{2} \\left(\\frac{3\\pi}{4}\\right) = 1 \\implies A^{2} = \\frac{4}{3\\pi}\n$$\n取归一化常数的正实数根，我们得到：\n$$\nA = \\sqrt{\\frac{4}{3\\pi}} = \\frac{2}{\\sqrt{3\\pi}}\n$$\n\n其次，我们评估 $\\Psi(\\phi)$ 是否为角动量算符 $\\hat{L}_{z}$ 的本征态。在角表示下，此算符为 $\\hat{L}_{z} = -i\\hbar \\frac{\\partial}{\\partial\\phi}$。若 $\\Psi(\\phi)$ 为 $\\hat{L}_{z}$ 的本征态，则必须满足本征值方程 $\\hat{L}_{z}\\Psi(\\phi) = \\lambda\\Psi(\\phi)$，其中 $\\lambda$ 为一个常数标量（本征值）。\n我们将算符作用于该态：\n$$\n\\hat{L}_{z}\\Psi(\\phi) = -i\\hbar \\frac{\\partial}{\\partial\\phi} \\left(A \\cos^{2}(\\phi)\\right)\n$$\n使用链式法则求导，$\\frac{d}{d\\phi}\\cos^{2}(\\phi) = 2\\cos(\\phi)(-\\sin(\\phi)) = -2\\sin(\\phi)\\cos(\\phi) = -\\sin(2\\phi)$。\n$$\n\\hat{L}_{z}\\Psi(\\phi) = -i\\hbar A (-\\sin(2\\phi)) = i\\hbar A \\sin(2\\phi)\n$$\n现在我们检查结果是否为原函数 $\\Psi(\\phi) = A \\cos^{2}(\\phi)$ 的常数倍。为使本征值方程成立，我们需要：\n$$\ni\\hbar A \\sin(2\\phi) = \\lambda \\left(A \\cos^{2}(\\phi)\\right)\n$$\n解出 $\\lambda$ 得：\n$$\n\\lambda = \\frac{i\\hbar \\sin(2\\phi)}{\\cos^{2}(\\phi)}\n$$\n由于 $\\lambda$ 是 $\\phi$ 的函数而非一个常数，因此态 $\\Psi(\\phi) = A \\cos^{2}(\\phi)$ **不是**角动量算符 $\\hat{L}_{z}$ 的本征态。\n\n第三，我们计算此态下 $\\hat{L}_{z}$ 的期望值，记为 $\\langle \\hat{L}_{z} \\rangle$。期望值通过以下积分计算：\n$$\n\\langle \\hat{L}_{z} \\rangle = \\int_{0}^{2\\pi} \\Psi^{*}(\\phi) \\hat{L}_{z} \\Psi(\\phi) d\\phi\n$$\n代入 $\\Psi^{*}(\\phi)$ 和 $\\hat{L}_{z}\\Psi(\\phi)$ 的表达式：\n$$\n\\langle \\hat{L}_{z} \\rangle = \\int_{0}^{2\\pi} \\left(A \\cos^{2}(\\phi)\\right) \\left(i\\hbar A \\sin(2\\phi)\\right) d\\phi = i\\hbar A^{2} \\int_{0}^{2\\pi} \\cos^{2}(\\phi) \\sin(2\\phi) d\\phi\n$$\n我们关注积分部分。使用二倍角恒等式 $\\sin(2\\phi) = 2\\sin(\\phi)\\cos(\\phi)$：\n$$\n\\int_{0}^{2\\pi} \\cos^{2}(\\phi) \\sin(2\\phi) d\\phi = \\int_{0}^{2\\pi} \\cos^{2}(\\phi) (2\\sin(\\phi)\\cos(\\phi)) d\\phi = 2 \\int_{0}^{2\\pi} \\cos^{3}(\\phi) \\sin(\\phi) d\\phi\n$$\n该积分可用换元法求解。令 $u = \\cos(\\phi)$，则 $du = -\\sin(\\phi)d\\phi$。积分限从 $\\phi=0$ 变为 $u=\\cos(0)=1$，从 $\\phi=2\\pi$ 变为 $u=\\cos(2\\pi)=1$。\n$$\n2 \\int_{u(0)}^{u(2\\pi)} u^{3} (-du) = -2 \\int_{1}^{1} u^{3} du\n$$\n上下限相同的积分恰好为零。\n另外，计算不定积分得到 $-\\frac{2u^{4}}{4} = -\\frac{1}{2}\\cos^{4}(\\phi)$。在定积分区间上计算此式：\n$$\n\\left[-\\frac{1}{2}\\cos^{4}(\\phi)\\right]_{0}^{2\\pi} = \\left(-\\frac{1}{2}\\cos^{4}(2\\pi)\\right) - \\left(-\\frac{1}{2}\\cos^{4}(0)\\right) = \\left(-\\frac{1}{2}(1)^{4}\\right) - \\left(-\\frac{1}{2}(1)^{4}\\right) = -\\frac{1}{2} + \\frac{1}{2} = 0\n$$\n因此，该积分为零。期望值为：\n$$\n\\langle \\hat{L}_{z} \\rangle = i\\hbar A^{2} \\cdot 0 = 0\n$$\n在态 $\\Psi(\\phi)$下，角动量的期望值为 0。这个结果是合理的；态 $\\Psi(\\phi) = A \\cos^{2}(\\phi)$ 是一个实函数，可以表示为具有相反动量的 $\\hat{L}_z$ 本征态的叠加，具体来说是 $e^{i2\\phi}$、$e^{-i2\\phi}$和一个常数项（对于 $m=0$）。来自 $+m\\hbar$ 和 $-m\\hbar$ 的贡献相互抵消，导致动量的期望值为零。例如，$\\cos^2(\\phi) = \\frac{1}{2} + \\frac{1}{4}e^{i2\\phi} + \\frac{1}{4}e^{-i2\\phi}$，这是 $m=0$、$m=2$ 和 $m=-2$ 的态的叠加。期望值是本征值的加权平均值，结果为 0。\n问题要求以 $\\hbar$ 为单位表示最终值，即为 0。", "answer": "$$\n\\boxed{0}\n$$", "id": "2459766"}, {"introduction": "作为最后的实践，我们将从解析计算转向数值实现，这是连接理论与计算化学实践的关键一步。你将根据离散化格点上的期望值定义，编写一段代码来处理一系列具体的测试案例 [@problem_id:2459733]。这项练习会让你掌握如何将抽象的积分公式转化为计算机可以处理的矩阵和向量运算，这是现代量子化学软件中计算可观测量（如能量、偶极矩等）的基础。", "problem": "考虑一个在有限网格上表示的一维离散量子态。设复值波函数是一个定义在 $N$ 个网格点上的列向量 $\\boldsymbol{\\psi} \\in \\mathbb{C}^{N}$，并具有正的求积权重 $\\mathbf{w} = (w_1,\\dots,w_N)$，这些权重通过对角权重矩阵 $\\mathbf{W} = \\mathrm{diag}(w_1,\\dots,w_N)$ 来近似网格上的积分。设可观测量由一个 $N \\times N$ 矩阵 $\\hat{\\mathbf{O}}$ 表示。该可观测量在該状态下的期望值定义为\n$$\n\\langle \\hat{O} \\rangle \\;=\\; \\frac{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\, \\hat{\\mathbf{O}} \\, \\boldsymbol{\\psi}}{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\, \\boldsymbol{\\psi}},\n$$\n其中 $(\\cdot)^\\dagger$ 表示共轭转置。假设所有量均为无量纲。\n\n编写一个程序，对下面指定的每个测试用例，使用上述定义计算期望值 $\\langle \\hat{O} \\rangle$。波函数可能未经归一化；必须严格按照给定的定义进行计算。假设 $\\hat{\\mathbf{O}}$ 对于由 $\\mathbf{W}$ 导出的加权内积是厄米的，因此 $\\langle \\hat{O} \\rangle$ 是实数。\n\n测试套件（每个用例指定 $(\\boldsymbol{\\psi}, \\hat{\\mathbf{O}}, \\mathbf{w})$）：\n\n1. 用例 A（类位置算符的对角算符，均匀权重，归一化态）：\n   - $N = 4$，\n   - 网格值 $\\mathbf{x} = (-1, 0, 1, 2)$，\n   - $\\hat{\\mathbf{O}} = \\mathrm{diag}(-1, 0, 1, 2)$，\n   - $\\mathbf{w} = (1, 1, 1, 1)$，\n   - $\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} \\, (1, 1, 0, 0)^{\\mathsf{T}}$。\n\n2. 用例 B（单位算符，非均匀权重，未归一化复态）：\n   - $N = 3$，\n   - $\\hat{\\mathbf{O}} = \\mathbf{I}_3$，\n   - $\\mathbf{w} = (0.3, 0.5, 0.2)$，\n   - $\\boldsymbol{\\psi} = (1 + i, \\, 2 - i, \\, -\\tfrac{1}{2} i)^{\\mathsf{T}}$。\n\n3. 用例 C（使用梯形权重的类位置算符的对角算符，常数态）：\n   - $N = 3$，\n   - 网格值 $\\mathbf{x} = (0, 0.5, 1.0)$，\n   - $\\hat{\\mathbf{O}} = \\mathrm{diag}(0, 0.5, 1.0)$，\n   - 梯形权重 $\\mathbf{w} = (0.25, 0.5, 0.25)$，\n   - $\\boldsymbol{\\psi} = (1, 1, 1)^{\\mathsf{T}}$。\n\n4. 用例 D（非对角厄米算符，复归一化态）：\n   - $N = 2$，\n   - $\\hat{\\mathbf{O}} = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$，\n   - $\\mathbf{w} = (1, 1)$，\n   - $\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} \\, (1, i)^{\\mathsf{T}}$。\n\n5. 用例 E（使用周期性中心差分的类动量离散算符，均匀权重，常数态）：\n   - $N = 3$，\n   - 网格间距 $\\Delta x = 1$，\n   - 定义离散动量算符\n     $$\n     \\hat{\\mathbf{P}} \\;=\\; -\\frac{i}{2 \\Delta x}\n     \\begin{pmatrix}\n     0 & 1 & -1 \\\\\n     -1 & 0 & 1 \\\\\n     1 & -1 & 0\n     \\end{pmatrix},\n     $$\n     其对应于 $-\\mathrm{i}\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}$ 的周期性中心差分表示，\n   - $\\hat{\\mathbf{O}} = \\hat{\\mathbf{P}}$，\n   - $\\mathbf{w} = (1, 1, 1)$，\n   - $\\boldsymbol{\\psi} = (1, 1, 1)^{\\mathsf{T}}$。\n\n您的程序必须计算每个用例的期望值，并生成单行输出，其中包含五个结果，形式为逗号分隔的列表并用方括号括起，每个值四舍五入到 $10$ 位小数（例如，$[a,b,c,d,e]$，其中 $a$ 到 $e$ 是格式化为 $10$ 位小数的浮点数）。将所有量视为无量纲。程序不需要用户输入；必须将测试套件内置于程序中。", "solution": "问题陈述已经过验证，被认为是科学上合理、定义明确且客观的。它提出了一个基于数值量子力学基本原理的清晰计算任务。目标是计算在带有求积权重 $\\mathbf{w}$ 的一维离散网格上，给定量子态 $\\boldsymbol{\\psi}$ 的可观测量 $\\hat{\\mathbf{O}}$ 的期望值。\n\n期望值 $\\langle \\hat{O} \\rangle$ 由广义瑞利商定义：\n$$\n\\langle \\hat{O} \\rangle \\;=\\; \\frac{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\, \\hat{\\mathbf{O}} \\, \\boldsymbol{\\psi}}{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\, \\boldsymbol{\\psi}}\n$$\n这里，$\\boldsymbol{\\psi}$ 是大小为 $N$ 的复值态向量，$\\hat{\\mathbf{O}}$ 是表示可观测量的 $N \\times N$ 矩阵，$\\mathbf{W} = \\mathrm{diag}(w_1, \\dots, w_N)$ 是正求积权重的对角矩阵，而 $(\\cdot)^\\dagger$ 表示共轭转置。分母提供了相对于由 $\\mathbf{W}$ 定义的加权内积的正确归一化。问题断言 $\\hat{\\mathbf{O}}$ 在此加权内积下是厄米的，这保证了期望值 $\\langle \\hat{O} \\rangle$ 是一个实数。\n\n计算过程包括对所提供的五个测试用例中的每一个直接应用此公式。对于每个用例，我们构建向量 $\\boldsymbol{\\psi}$ 和 $\\mathbf{w}$，以及矩阵 $\\hat{\\mathbf{O}}$。然后，我们使用矩阵-向量和向量点积计算分子和分母，并求出它们的比值。\n\n每个用例的计算如下：\n\n**用例 A:**\n- $N = 4$\n- $\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} (1, 1, 0, 0)^{\\mathsf{T}}$\n- $\\mathbf{w} = (1, 1, 1, 1)$，所以 $\\mathbf{W} = \\mathbf{I}_4$（$4 \\times 4$ 单位矩阵）。\n- $\\hat{\\mathbf{O}} = \\mathrm{diag}(-1, 0, 1, 2)$\n\n分母是模方： $D = \\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi} = \\boldsymbol{\\psi}^\\dagger \\boldsymbol{\\psi} = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 (1^* \\cdot 1 + 1^* \\cdot 1 + 0^* \\cdot 0 + 0^* \\cdot 0) = \\frac{1}{2}(2) = 1$。\n分子是 $N = \\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\hat{\\mathbf{O}} \\boldsymbol{\\psi} = \\boldsymbol{\\psi}^\\dagger \\hat{\\mathbf{O}} \\boldsymbol{\\psi}$。由于 $\\mathbf{W}$ 和 $\\hat{\\mathbf{O}}$ 都是对角矩阵，这等于 $\\sum_{k=1}^4 w_k O_{kk} |\\psi_k|^2$。\n$N = 1 \\cdot (-1) \\cdot \\left|\\frac{1}{\\sqrt{2}}\\right|^2 + 1 \\cdot 0 \\cdot \\left|\\frac{1}{\\sqrt{2}}\\right|^2 + 1 \\cdot 1 \\cdot |0|^2 + 1 \\cdot 2 \\cdot |0|^2 = -1 \\cdot \\frac{1}{2} + 0 = -0.5$。\n期望值为 $\\langle \\hat{O} \\rangle = N/D = -0.5/1 = -0.5$。\n\n**用例 B:**\n- $N = 3$\n- $\\boldsymbol{\\psi} = (1 + i, 2 - i, -0.5i)^{\\mathsf{T}}$\n- $\\mathbf{w} = (0.3, 0.5, 0.2)$\n- $\\hat{\\mathbf{O}} = \\mathbf{I}_3$（$3 \\times 3$ 单位矩阵）\n\n对于任何非零状态 $\\boldsymbol{\\psi}$，单位算符的期望值总是 $1$。该公式证实了这一点：\n$\\langle \\hat{O} \\rangle = \\frac{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\mathbf{I}_3 \\boldsymbol{\\psi}}{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi}} = \\frac{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi}}{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi}} = 1$。\n结果是 $\\langle \\hat{O} \\rangle = 1.0$。\n\n**用例 C:**\n- $N = 3$\n- $\\boldsymbol{\\psi} = (1, 1, 1)^{\\mathsf{T}}$\n- $\\mathbf{w} = (0.25, 0.5, 0.25)$\n- $\\hat{\\mathbf{O}} = \\mathrm{diag}(0, 0.5, 1.0)$\n\n分母是 $D = \\sum_{k=1}^3 w_k |\\psi_k|^2 = 0.25 \\cdot |1|^2 + 0.5 \\cdot |1|^2 + 0.25 \\cdot |1|^2 = 0.25 + 0.5 + 0.25 = 1$。\n分子是 $N = \\sum_{k=1}^3 w_k O_{kk} |\\psi_k|^2 = 0.25 \\cdot 0 \\cdot |1|^2 + 0.5 \\cdot 0.5 \\cdot |1|^2 + 0.25 \\cdot 1.0 \\cdot |1|^2 = 0 + 0.25 + 0.25 = 0.5$。\n期望值为 $\\langle \\hat{O} \\rangle = N/D = 0.5/1 = 0.5$。这对应于在区间 $[0, 1]$ 上使用梯形法则积分时，常数波函数的位置期望值的精确值。\n\n**用例 D:**\n- $N = 2$\n- $\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} (1, i)^{\\mathsf{T}}$\n- $\\mathbf{w} = (1, 1)$，所以 $\\mathbf{W} = \\mathbf{I}_2$。\n- $\\hat{\\mathbf{O}} = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$\n\n分母是 $D = \\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi} = \\boldsymbol{\\psi}^\\dagger \\boldsymbol{\\psi} = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 (1^* \\cdot 1 + i^* \\cdot i) = \\frac{1}{2}(1 + (-i)i) = \\frac{1}{2}(1+1) = 1$。\n分子是 $N = \\boldsymbol{\\psi}^\\dagger \\hat{\\mathbf{O}} \\boldsymbol{\\psi}$。\n首先，计算 $\\hat{\\mathbf{O}}\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ i \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} i \\\\ 1 \\end{pmatrix}$。\n然后，$N = \\boldsymbol{\\psi}^\\dagger (\\hat{\\mathbf{O}}\\boldsymbol{\\psi}) = \\frac{1}{\\sqrt{2}}(1, -i) \\cdot \\frac{1}{\\sqrt{2}} \\begin{pmatrix} i \\\\ 1 \\end{pmatrix} = \\frac{1}{2}(1 \\cdot i + (-i) \\cdot 1) = \\frac{1}{2}(i - i) = 0$。\n期望值为 $\\langle \\hat{O} \\rangle = N/D = 0/1 = 0$。\n\n**用例 E:**\n- $N = 3$\n- $\\boldsymbol{\\psi} = (1, 1, 1)^{\\mathsf{T}}$\n- $\\mathbf{w} = (1, 1, 1)$，所以 $\\mathbf{W} = \\mathbf{I}_3$。\n- $\\Delta x = 1$\n- $\\hat{\\mathbf{O}} = \\hat{\\mathbf{P}} = -\\frac{i}{2\\Delta x} \\begin{pmatrix} 0 & 1 & -1 \\\\ -1 & 0 & 1 \\\\ 1 & -1 & 0 \\end{pmatrix} = -0.5i \\begin{pmatrix} 0 & 1 & -1 \\\\ -1 & 0 & 1 \\\\ 1 & -1 & 0 \\end{pmatrix}$\n\n分母是 $D = \\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi} = \\boldsymbol{\\psi}^\\dagger \\boldsymbol{\\psi} = 1^* \\cdot 1 + 1^* \\cdot 1 + 1^* \\cdot 1 = 3$。\n分子是 $N = \\boldsymbol{\\psi}^\\dagger \\hat{\\mathbf{P}} \\boldsymbol{\\psi}$。\n首先，计算 $\\hat{\\mathbf{P}}\\boldsymbol{\\psi}$。矩阵部分作用于 $\\boldsymbol{\\psi}$ 得到：\n$\\begin{pmatrix} 0 & 1 & -1 \\\\ -1 & 0 & 1 \\\\ 1 & -1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\cdot 1 + 1 \\cdot 1 - 1 \\cdot 1 \\\\ -1 \\cdot 1 + 0 \\cdot 1 + 1 \\cdot 1 \\\\ 1 \\cdot 1 - 1 \\cdot 1 + 0 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n因此，$\\hat{\\mathbf{P}}\\boldsymbol{\\psi} = \\mathbf{0}$。\n分子是 $N = \\boldsymbol{\\psi}^\\dagger \\mathbf{0} = 0$。\n期望值为 $\\langle \\hat{O} \\rangle = N/D = 0/3 = 0$。这是预料之中的，因为常数波函数代表零动量态（$k=0$），而动量算符在此类状态下的期望值为零。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the expectation value of an observable for several test cases\n    in a discretized quantum mechanics framework.\n    \"\"\"\n\n    def compute_expectation_value(psi, O, w):\n        \"\"\"\n        Calculates the expectation value <O> = (psi^dag W O psi) / (psi^dag W psi).\n\n        Args:\n            psi (np.ndarray): The complex-valued wavefunction vector.\n            O (np.ndarray): The complex-valued observable matrix.\n            w (np.ndarray): The real-valued quadrature weights vector.\n\n        Returns:\n            float: The real-valued expectation value.\n        \"\"\"\n        # Ensure inputs are NumPy arrays with appropriate types for calculation.\n        psi = np.asarray(psi, dtype=np.complex128)\n        O = np.asarray(O, dtype=np.complex128)\n        w = np.asarray(w, dtype=np.float64)\n\n        # Numerator: psi^dagger @ W @ O @ psi\n        # The operation W @ vector is efficiently implemented as element-wise multiplication.\n        O_psi = O @ psi\n        W_O_psi = w * O_psi\n        numerator = np.dot(psi.conj(), W_O_psi)\n\n        # Denominator: psi^dagger @ W @ psi\n        W_psi = w * psi\n        denominator = np.dot(psi.conj(), W_psi)\n        \n        # Avoid division by zero, although not expected for valid states.\n        if np.isclose(denominator, 0.0):\n            raise ValueError(\"Denominator is zero, the state norm is zero.\")\n\n        # The problem guarantees a real result. Take the real part to discard\n        # any potential imaginary noise from floating-point arithmetic.\n        expectation_value = (numerator / denominator).real\n        return expectation_value\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {   # Case A\n            \"psi\": (1 / np.sqrt(2)) * np.array([1, 1, 0, 0]),\n            \"O\": np.diag([-1, 0, 1, 2]),\n            \"w\": np.array([1, 1, 1, 1])\n        },\n        {   # Case B\n            \"psi\": np.array([1 + 1j, 2 - 1j, -0.5j]),\n            \"O\": np.identity(3),\n            \"w\": np.array([0.3, 0.5, 0.2])\n        },\n        {   # Case C\n            \"psi\": np.array([1, 1, 1]),\n            \"O\": np.diag([0, 0.5, 1.0]),\n            \"w\": np.array([0.25, 0.5, 0.25])\n        },\n        {   # Case D\n            \"psi\": (1 / np.sqrt(2)) * np.array([1, 1j]),\n            \"O\": np.array([[0, 1], [1, 0]]),\n            \"w\": np.array([1, 1])\n        },\n        {   # Case E\n            \"psi\": np.array([1, 1, 1]),\n            \"O\": (-1j / (2.0 * 1.0)) * np.array([[0, 1, -1], [-1, 0, 1], [1, -1, 0]]),\n            \"w\": np.array([1, 1, 1])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        result = compute_expectation_value(case[\"psi\"], case[\"O\"], case[\"w\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.10f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2459733"}]}