{"hands_on_practices": [{"introduction": "简单的矩阵模型常常能为我们提供深刻的化学见解。这个练习将使用一个 $2 \\times 2$ 的哈密顿矩阵来模拟两个轨道间的相互作用，直观地展示了本征值如何对应于分子轨道的能量，而本征向量又如何描述这些新轨道的构成。这是将线性代数应用于化学的一个基础范例，它揭示了轨道混合与电荷转移等核心概念的数学本质。[@problem_id:2457197]", "id": "2457197", "problem": "一个施主碎片和一个受主碎片各提供一个正交归一的前沿轨道，构成一个单电子的最小基组。在此施主-受主基组中，单电子的哈密顿量由如下实对称矩阵表示\n$$\n\\mathbf{H} \\;=\\;\n\\begin{pmatrix}\nE_{D} & V \\\\\nV & E_{A}\n\\end{pmatrix},\n$$\n其中施主轨道能量为 $E_{D}$，受主轨道能量为 $E_{A}$，施主-受主耦合为 $V$。考虑以下具体情况\n$$\nE_{D} \\;=\\; -7.50\\,\\mathrm{eV}, \\quad E_{A} \\;=\\; -6.80\\,\\mathrm{eV}, \\quad V \\;=\\; -0.40\\,\\mathrm{eV}.\n$$\n将 $\\mathbf{H}$ 精确地视为一个 $2\\times 2$ 的厄米算符，确定两个分子轨道（MO）本征能量之间的能量分裂和归一化的本征向量。将能量分裂解释为上、下分子轨道能量之间的差值 $\\Delta E$，并将归一化的低能本征向量中受主分量的平方解释为低能分子轨道中的受主布居数（电荷密度分数）。\n\n以电子伏特为单位提供能量分裂 $\\Delta E$。为便于评分，仅报告低能分子轨道中的受主布居数 $P_{A}$，以小数形式表示。将您报告的 $P_{A}$ 值四舍五入至四位有效数字。不要包含百分号。$P_{A}$ 不带单位。", "solution": "所给问题是线性代数在量子化学中的一个标准应用，具体来说是两能级哈密顿量的对角化。该问题具有科学依据，提法明确且客观。我们将着手进行求解。\n\n问题要求我们分析一个两能级量子系统，其哈密顿算符在由施主（$|D\\rangle$）和受主（$|A\\rangle$）轨道构成的正交归一基组中的矩阵表示为：\n$$\n\\mathbf{H} =\n\\begin{pmatrix}\nE_{D} & V \\\\\nV & E_{A}\n\\end{pmatrix}\n$$\n给定的参数为施主轨道能量 $E_{D} = -7.50\\,\\mathrm{eV}$，受主轨道能量 $E_{A} = -6.80\\,\\mathrm{eV}$，以及耦合元 $V = -0.40\\,\\mathrm{eV}$。\n\n该哈密顿量的本征值代表分子轨道（MO）的能量，可以通过求解特征方程 $\\det(\\mathbf{H} - E\\mathbf{I}) = 0$ 得到：\n$$\n\\det\\begin{pmatrix}\nE_{D} - E & V \\\\\nV & E_{A} - E\n\\end{pmatrix} = (E_{D} - E)(E_{A} - E) - V^2 = 0\n$$\n这是一个关于能量 $E$ 的二次方程：\n$$\nE^2 - (E_{D} + E_{A})E + (E_{D}E_{A} - V^2) = 0\n$$\n两个本征值（我们记为 $E_{+}$ 和 $E_{-}$）的解由求根公式给出：\n$$\nE_{\\pm} = \\frac{E_{D} + E_{A}}{2} \\pm \\frac{1}{2}\\sqrt{(E_{D} - E_{A})^2 + 4V^2}\n$$\n问题将能量分裂 $\\Delta E$ 定义为上、下分子轨道能量（分别为 $E_{+}$ 和 $E_{-}$）之差。\n$$\n\\Delta E = E_{+} - E_{-} = \\sqrt{(E_{D} - E_{A})^2 + 4V^2}\n$$\n代入给定值：\n$E_{D} - E_{A} = -7.50\\,\\mathrm{eV} - (-6.80\\,\\mathrm{eV}) = -0.70\\,\\mathrm{eV}$。\n$4V^2 = 4(-0.40\\,\\mathrm{eV})^2 = 4(0.16\\,\\mathrm{eV}^2) = 0.64\\,\\mathrm{eV}^2$。\n$$\n\\Delta E = \\sqrt{(-0.70\\,\\mathrm{eV})^2 + 0.64\\,\\mathrm{eV}^2} = \\sqrt{0.49\\,\\mathrm{eV}^2 + 0.64\\,\\mathrm{eV}^2} = \\sqrt{1.13}\\,\\mathrm{eV} \\approx 1.063\\,\\mathrm{eV}\n$$\n这就是两个分子轨道之间的能量分裂。\n\n接下来，我们确定归一化的本征向量。一种巧妙的方法是使用一个旋转矩阵来对角化 $\\mathbf{H}$。本征向量是该旋转矩阵的列向量。旋转角 $\\theta$ 由旋转后哈密顿量的非对角元素为零的条件确定。该条件导出如下关系：\n$$\n\\tan(2\\theta) = \\frac{2V}{E_{D} - E_{A}}\n$$\n使用所给数值：\n$$\n\\tan(2\\theta) = \\frac{2(-0.40)}{-7.50 - (-6.80)} = \\frac{-0.80}{-0.70} = \\frac{8}{7}\n$$\n$E_D - E_A$ 的符号为负，且由于 $\\tan(2\\theta)$ 为正，我们可以推断出哪个本征值对应哪个本征向量。通过旋转对角化得到的两个本征值为 $E_1 = E_{D}\\cos^2\\theta + E_{A}\\sin^2\\theta + 2V\\sin\\theta\\cos\\theta$ 和 $E_2 = E_{D}\\sin^2\\theta + E_{A}\\cos^2\\theta - 2V\\sin\\theta\\cos\\theta$。两者的差为 $E_1 - E_2 = (E_D - E_A)\\cos(2\\theta) + 2V\\sin(2\\theta)$。利用正切关系，这可以简化为 $E_1 - E_2 = \\frac{E_D - E_A}{\\cos(2\\theta)}$。由于 $E_D - E_A < 0$ 且 $\\tan(2\\theta) > 0$（这意味着我们可以选择 $2\\theta$ 在第一象限，其中 $\\cos(2\\theta) > 0$），我们有 $E_1 - E_2 < 0$，因此 $E_1 = E_{-}$。\n\n对应于较低能量 $E_{-}$ 的本征向量是旋转矩阵的第一列，即 $\\mathbf{c}_{-} = \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}$。在施主和受主轨道基组中，该本征向量写为 $\\mathbf{c}_{-} = (\\cos\\theta)|D\\rangle + (\\sin\\theta)|A\\rangle$。其分量为 $c_{D,-} = \\cos\\theta$ 和 $c_{A,-} = \\sin\\theta$。\n\n问题要求低能分子轨道中的受主布居数 $P_{A}$。这被定义为归一化本征向量中受主分量的平方：\n$$\nP_{A} = (c_{A,-})^2 = \\sin^2\\theta\n$$\n我们可以利用半角恒等式从 $\\tan(2\\theta)$ 求出 $\\sin^2\\theta$，该恒等式与 $\\cos(2\\theta) = 1 - 2\\sin^2\\theta$ 有关。整理后得到：\n$$\n\\sin^2\\theta = \\frac{1 - \\cos(2\\theta)}{2}\n$$\n根据 $\\tan(2\\theta) = \\frac{8}{7}$，我们可以构造一个对边为 $8$、邻边为 $7$ 的直角三角形。斜边为 $\\sqrt{8^2 + 7^2} = \\sqrt{64 + 49} = \\sqrt{113}$。由于 $\\tan(2\\theta) > 0$，我们选择 $2\\theta$ 在第一象限，因此 $\\cos(2\\theta)$ 为正。\n$$\n\\cos(2\\theta) = \\frac{\\text{邻边}}{\\text{斜边}} = \\frac{7}{\\sqrt{113}}\n$$\n现在，我们将此代入 $\\sin^2\\theta$ 的表达式中：\n$$\nP_{A} = \\sin^2\\theta = \\frac{1}{2} \\left( 1 - \\frac{7}{\\sqrt{113}} \\right)\n$$\n为了获得所需的数值，我们计算此表达式：\n$$\n\\sqrt{113} \\approx 10.6301458\n$$\n$$\nP_{A} \\approx \\frac{1}{2} \\left( 1 - \\frac{7}{10.6301458} \\right) \\approx \\frac{1}{2} (1 - 0.65850125) \\approx \\frac{1}{2} (0.34149875) \\approx 0.170749375\n$$\n问题要求将此值四舍五入至四位有效数字。第五位有效数字是 $4$，所以我们向下舍入。\n$$\nP_{A} \\approx 0.1707\n$$\n这表示在低能分子轨道中，受主碎片上的电荷密度分数。", "answer": "$$\\boxed{0.1707}$$"}, {"introduction": "在实际的量子化学计算中，我们通常从一组非正交的原子轨道基组出发，这使得求解薛定谔方程变得复杂。本练习将引入重叠矩阵 $S$，并演示一种标准方法——对称正交化，以将非正交基变换为正交归一基。掌握这一方法对于理解现代计算化学程序的内部工作原理至关重要。[@problem_id:2457241]", "id": "2457241", "problem": "在一个分子碎裂方案中，两个归一化的片段轨道 $|\\phi_{1}\\rangle$ 和 $|\\phi_{2}\\rangle$ 是非正交的。它们的重叠积分定义为 $S_{ij}=\\langle \\phi_{i}|\\phi_{j}\\rangle$。假设唯一的非零非对角重叠项为 $\\langle \\phi_{1}|\\phi_{2}\\rangle=\\langle \\phi_{2}|\\phi_{1}\\rangle=s$，其中 $s=0.30$，因此重叠矩阵为\n$$\n\\mathbf{S}=\\begin{pmatrix}\n1 & s\\\\\ns & 1\n\\end{pmatrix}.\n$$\n通过一个实数对称正定变换 $\\mathbf{X}$ 定义一组新轨道 $|\\chi_{i}\\rangle$ 作为原始片段轨道的线性组合，即 $(|\\chi_{1}\\rangle,|\\chi_{2}\\rangle)^{\\top}=\\mathbf{X}\\,(|\\phi_{1}\\rangle,|\\phi_{2}\\rangle)^{\\top}$，使得新轨道是正交归一的，满足 $\\langle \\chi_{i}|\\chi_{j}\\rangle=\\delta_{ij}$。确定在 $|\\chi_{1}\\rangle$ 中 $|\\phi_{2}\\rangle$ 的系数，该系数等于 $\\mathbf{X}$ 的非对角元 $X_{12}$。将您的答案表示为一个四舍五入到四位有效数字的实数。", "solution": "该问题要求确定一个变换矩阵 $\\mathbf{X}$ 的特定元素，该矩阵将一组非正交、归一化的基轨道 $\\{|\\phi_i\\rangle\\}$ 映射到一组正交归一的轨道 $\\{|\\chi_i\\rangle\\}$。\n\n初始基由两个轨道 $|\\phi_{1}\\rangle$ 和 $|\\phi_{2}\\rangle$ 组成。它们是归一化的，所以 $\\langle\\phi_{1}|\\phi_{1}\\rangle = 1$ 且 $\\langle\\phi_{2}|\\phi_{2}\\rangle = 1$。它们之间的重叠给定为 $\\langle\\phi_{1}|\\phi_{2}\\rangle = s$。重叠矩阵 $\\mathbf{S}$ 的元素为 $S_{ij} = \\langle\\phi_i|\\phi_j\\rangle$，由下式给出：\n$$\n\\mathbf{S} = \\begin{pmatrix} 1 & s \\\\ s & 1 \\end{pmatrix}\n$$\n新轨道 $|\\chi_{1}\\rangle$ 和 $|\\chi_{2}\\rangle$ 由以下线性变换定义：\n$$\n|\\chi_{i}\\rangle = \\sum_{j=1}^{2} X_{ij} |\\phi_{j}\\rangle\n$$\n此处，$\\mathbf{X}$ 是一个实数、对称且正定的矩阵。新轨道要求是正交归一的，意味着它们的内积满足条件 $\\langle\\chi_{i}|\\chi_{j}\\rangle = \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克δ函数。\n\n我们必须用矩阵 $\\mathbf{X}$ 和 $\\mathbf{S}$ 来形式化这个正交归一条件。让我们计算内积 $\\langle\\chi_{i}|\\chi_{j}\\rangle$：\n$$\n\\langle\\chi_{i}|\\chi_{j}\\rangle = \\left\\langle \\sum_{k=1}^{2} X_{ik} \\phi_k \\middle| \\sum_{l=1}^{2} X_{jl} \\phi_l \\right\\rangle\n$$\n根据内积的线性性质以及 $\\mathbf{X}$ 是实数矩阵的事实，我们有：\n$$\n\\langle\\chi_{i}|\\chi_{j}\\rangle = \\sum_{k=1}^{2} \\sum_{l=1}^{2} X_{ik} X_{jl} \\langle\\phi_k|\\phi_l\\rangle = \\sum_{k=1}^{2} \\sum_{l=1}^{2} X_{ik} S_{kl} X_{jl}\n$$\n该表达式代表了矩阵乘积 $\\mathbf{X} \\mathbf{S} \\mathbf{X}^{\\top}$ 的第 $(i, j)$ 个元素。由于新基是正交归一的，这个矩阵乘积必须是单位矩阵 $\\mathbf{I}$：\n$$\n\\mathbf{X} \\mathbf{S} \\mathbf{X}^{\\top} = \\mathbf{I}\n$$\n问题指明变换矩阵 $\\mathbf{X}$ 是对称的，所以 $\\mathbf{X}^{\\top} = \\mathbf{X}$。该条件简化为：\n$$\n\\mathbf{X} \\mathbf{S} \\mathbf{X} = \\mathbf{I}\n$$\n由于当 $|s| < 1$ 时重叠矩阵 $\\mathbf{S}$ 是非奇异的（因为 $\\det(\\mathbf{S}) = 1-s^2$），我们可以用 $\\mathbf{X}^{-1}$（如果 $\\mathbf{X}$ 非奇异则存在）从左侧和右侧同乘，得到 $\\mathbf{S} = \\mathbf{X}^{-1}\\mathbf{X}^{-1} = (\\mathbf{X}^{-1})^2$。对两边取逆，得到：\n$$\n\\mathbf{S}^{-1} = \\mathbf{X}^2\n$$\n我们的任务是求出 $\\mathbf{X}$，它是 $\\mathbf{S}^{-1}$ 的一个平方根。问题陈述中要求 $\\mathbf{X}$ 是正定的，这使得解是唯一的：$\\mathbf{X}$ 必须是 $\\mathbf{S}^{-1}$ 的主平方根，这一过程称为对称正交化，记作 $\\mathbf{X} = \\mathbf{S}^{-1/2}$。\n\n为计算 $\\mathbf{S}^{-1/2}$，我们首先将矩阵 $\\mathbf{S}$ 对角化。设 $\\mathbf{S} = \\mathbf{U} \\mathbf{D} \\mathbf{U}^{\\top}$，其中 $\\mathbf{U}$ 是由特征向量构成的正交矩阵，$\\mathbf{D}$ 是由特征值构成的对角矩阵。那么 $\\mathbf{X} = \\mathbf{S}^{-1/2} = \\mathbf{U} \\mathbf{D}^{-1/2} \\mathbf{U}^{\\top}$。\n\n首先，我们通过解特征方程 $\\det(\\mathbf{S} - \\lambda\\mathbf{I}) = 0$ 来求 $\\mathbf{S}$ 的特征值：\n$$\n\\det\\begin{pmatrix} 1-\\lambda & s \\\\ s & 1-\\lambda \\end{pmatrix} = (1-\\lambda)^2 - s^2 = 0\n$$\n由此可得 $1 - \\lambda = \\pm s$，因此特征值为 $\\lambda_1 = 1+s$ 和 $\\lambda_2 = 1-s$。\n\n接下来，我们求出相应的归一化特征向量。\n对于 $\\lambda_1 = 1+s$：方程 $(\\mathbf{S} - \\lambda_1\\mathbf{I})\\mathbf{v}_1 = \\mathbf{0}$ 变为 $\\begin{pmatrix} -s & s \\\\ s & -s \\end{pmatrix} \\begin{pmatrix} v_{11} \\\\ v_{12} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，这意味着 $v_{11} = v_{12}$。归一化的特征向量为 $\\mathbf{u}_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n对于 $\\lambda_2 = 1-s$：方程 $(\\mathbf{S} - \\lambda_2\\mathbf{I})\\mathbf{v}_2 = \\mathbf{0}$ 变为 $\\begin{pmatrix} s & s \\\\ s & s \\end{pmatrix} \\begin{pmatrix} v_{21} \\\\ v_{22} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，这意味着 $v_{21} = -v_{22}$。归一化的特征向量为 $\\mathbf{u}_2 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\n特征向量矩阵为 $\\mathbf{U} = \\begin{pmatrix} \\mathbf{u}_1 & \\mathbf{u}_2 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}$。\n特征值对角矩阵为 $\\mathbf{D} = \\begin{pmatrix} 1+s & 0 \\\\ 0 & 1-s \\end{pmatrix}$。\n\n矩阵 $\\mathbf{X} = \\mathbf{S}^{-1/2}$ 随后通过 $\\mathbf{U} \\mathbf{D}^{-1/2} \\mathbf{U}^{\\top}$ 计算，其中 $\\mathbf{D}^{-1/2} = \\begin{pmatrix} (1+s)^{-1/2} & 0 \\\\ 0 & (1-s)^{-1/2} \\end{pmatrix}$。\n$$\n\\mathbf{X} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\begin{pmatrix} (1+s)^{-1/2} & 0 \\\\ 0 & (1-s)^{-1/2} \\end{pmatrix} \\left( \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\right)^{\\top}\n$$\n$$\n\\mathbf{X} = \\frac{1}{2}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\begin{pmatrix} (1+s)^{-1/2} & 0 \\\\ 0 & (1-s)^{-1/2} \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}\n$$\n将各矩阵相乘：\n$$\n\\mathbf{X} = \\frac{1}{2}\\begin{pmatrix} (1+s)^{-1/2} & (1-s)^{-1/2} \\\\ (1+s)^{-1/2} & -(1-s)^{-1/2} \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}\n$$\n$$\n\\mathbf{X} = \\frac{1}{2}\\begin{pmatrix} (1+s)^{-1/2} + (1-s)^{-1/2} & (1+s)^{-1/2} - (1-s)^{-1/2} \\\\ (1+s)^{-1/2} - (1-s)^{-1/2} & (1+s)^{-1/2} + (1-s)^{-1/2} \\end{pmatrix}\n$$\n问题要求的是元素 $X_{12}$，它是在 $|\\chi_1\\rangle$ 的展开式中 $|\\phi_2\\rangle$ 的系数。\n$$\nX_{12} = \\frac{1}{2} \\left( \\frac{1}{\\sqrt{1+s}} - \\frac{1}{\\sqrt{1-s}} \\right)\n$$\n给定 $s=0.30$。代入此值：\n$$\nX_{12} = \\frac{1}{2} \\left( \\frac{1}{\\sqrt{1+0.30}} - \\frac{1}{\\sqrt{1-0.30}} \\right) = \\frac{1}{2} \\left( \\frac{1}{\\sqrt{1.3}} - \\frac{1}{\\sqrt{0.7}} \\right)\n$$\n现在，我们进行数值计算：\n$$\n\\sqrt{1.3} \\approx 1.1401754\n$$\n$$\n\\sqrt{0.7} \\approx 0.8366600\n$$\n$$\nX_{12} \\approx \\frac{1}{2} \\left( \\frac{1}{1.1401754} - \\frac{1}{0.8366600} \\right) \\approx \\frac{1}{2} (0.8770580 - 1.1952286)\n$$\n$$\nX_{12} \\approx \\frac{1}{2} (-0.3181706) \\approx -0.1590853\n$$\n四舍五入到四位有效数字得到 $-0.1591$。", "answer": "$$\n\\boxed{-0.1591}\n$$"}, {"introduction": "为了让计算机能够处理量子力学问题，我们必须将描述物理规律的连续微分方程转化为离散的矩阵问题。本练习将经典的“一维无限深势阱”问题作为案例，应用有限差分法来构建动能算符的哈密顿矩阵。这个实践过程清晰地揭示了如何将连续的物理定律“翻译”成计算机可以求解的线性代数语言。[@problem_id:2457256]", "id": "2457256", "problem": "考虑一个质量为 $m$ 的非相对论性粒子，被束缚在区间 $[0,L]$ 上的一维 (1D) 无限深势阱（盒子中的粒子）中，其边界条件为 Dirichlet 边界条件 $\\psi(0)=0$ 和 $\\psi(L)=0$。在原子单位制下进行计算，其中约化普朗克常数 $\\hbar$ 等于 $1$，质量 $m$ 等于 $1$。在内部，不含时哈密顿算符为 $\\hat{H} = -\\dfrac{1}{2}\\dfrac{d^2}{dx^2}$。对于整数 $n \\ge 1$，其精确的解析本征函数和本征值分别为\n$\\psi_n(x) = \\sqrt{\\dfrac{2}{L}} \\sin\\!\\left(\\dfrac{n\\pi x}{L}\\right)$\n和\n$E_n = \\dfrac{n^2 \\pi^2}{2 L^2}$。\n\n使用一个包含 $N$ 个内部点的均匀网格来离散化该区间，点的位置为 $x_i = i\\,h$，$i=1,2,\\dots,N$，网格间距为 $h = \\dfrac{L}{N+1}$。通过排除端点来施加边界条件。在此内部网格上，使用标准的三点有限差分 (FD) 近似法处理二阶导数，以构建表示算符 $-\\dfrac{1}{2}\\dfrac{d^2}{dx^2}$ 和给定边界条件的 $N \\times N$ 实对称哈密顿矩阵 $H$。确定其本征值和一组标准正交的本征向量基。将最低的 $k$ 个离散本征对与解析解进行比较，方法如下：\n- 能量：对于每个 $n \\in \\{1,2,\\dots,k\\}$，计算相对误差 $\\left|E_n^{\\text{num}} - E_n^{\\text{ana}}\\right|/E_n^{\\text{ana}}$，其中 $E_n^{\\text{num}}$ 是 $H$ 的第 $n$ 小的本征值，而 $E_n^{\\text{ana}} = \\dfrac{n^2 \\pi^2}{2 L^2}$。\n- 本征向量：令 $\\phi_n \\in \\mathbb{R}^N$ 为对应于 $E_n^{\\text{num}}$ 的归一化数值本征向量，并令 $s_n \\in \\mathbb{R}^N$ 为分量为 $s_{n,i} = \\sqrt{\\dfrac{2}{L}} \\sin\\!\\left(\\dfrac{n\\pi x_i}{L}\\right)$ 的向量。定义离散的、网格加权的内积为 $\\langle u,v\\rangle_h = h \\sum_{i=1}^N u_i v_i$。使用此内积，计算 $\\phi_n$ 和 $s_n$ 之间的归一化重叠\n$\\mathcal{O}_n = \\dfrac{\\left|\\langle \\phi_n, s_n \\rangle_h\\right|}{\\sqrt{\\langle \\phi_n, \\phi_n \\rangle_h}\\,\\sqrt{\\langle s_n, s_n \\rangle_h}}$。\n此 $\\mathcal{O}_n$ 的值在 $[0,1]$ 区间内，并且不受整体符号差异的影响。\n\n对于每个测试用例，生成一对总结性指标：\n- 前 $k$ 个态中的最大相对能量误差，$\\max_{1 \\le n \\le k} \\left|E_n^{\\text{num}} - E_n^{\\text{ana}}\\right|/E_n^{\\text{ana}}$。\n- 前 $k$ 个态中的最小重叠，$\\min_{1 \\le n \\le k} \\mathcal{O}_n$。\n\n所有能量必须以原子单位表示。三角函数中的角度必须以弧度为单位。你的程序必须为每个测试用例计算这两个总结值，并按照下面指定的格式将它们聚合到单行输出中。\n\n测试套件：\n- 用例 1：$L = 1.0$, $N = 10$, $k = 3$。\n- 用例 2：$L = 1.0$, $N = 50$, $k = 5$。\n- 用例 3：$L = 2.0$, $N = 20$, $k = 4$。\n- 用例 4：$L = 1.0$, $N = 2$, $k = 2$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。每个测试用例贡献一个双元素列表 $[M,R]$，其中 $M$ 是最大相对能量误差，$R$ 是最小重叠，两者均为浮点数。例如，包含四个测试用例的输出必须如下所示：\n[[M_1,R_1],[M_2,R_2],[M_3,R_3],[M_4,R_4]]\n行内任何地方都不能有空格。", "solution": "此问题经过了严格验证。\n\n给定条件：\n- 模型：质量 $m=1$ 的非相对论性粒子在一维无限深势阱中。\n- 区间：$[0, L]$。\n- 边界条件：Dirichlet，$\\psi(0)=0$ 和 $\\psi(L)=0$。\n- 单位：原子单位制（$\\hbar=1, m=1$）。\n- 哈密顿算符：$\\hat{H} = -\\dfrac{1}{2}\\dfrac{d^2}{dx^2}$。\n- 解析本征函数：$\\psi_n(x) = \\sqrt{\\dfrac{2}{L}} \\sin\\!\\left(\\dfrac{n\\pi x}{L}\\right)$，对于整数 $n \\ge 1$。\n- 解析本征值：$E_n = \\dfrac{n^2 \\pi^2}{2 L^2}$。\n- 离散化：包含 $N$ 个内部点的均匀网格，$x_i = i\\,h$，$i=1,2,\\dots,N$，网格间距为 $h = \\dfrac{L}{N+1}$。\n- 数值方法：用于二阶导数的三点有限差分 (FD) 近似。\n- 任务：构建 $N \\times N$ 的哈密顿矩阵 $H$，求其本征对，并与解析解进行比较。\n- 比较指标：前 $k$ 个态的最大相对能量误差和最小本征向量重叠。\n- 相对能量误差：$\\left|E_n^{\\text{num}} - E_n^{\\text{ana}}\\right|/E_n^{\\text{ana}}$。\n- 重叠内积：$\\langle u,v\\rangle_h = h \\sum_{i=1}^N u_i v_i$。\n- 重叠定义：$\\mathcal{O}_n = \\dfrac{\\left|\\langle \\phi_n, s_n \\rangle_h\\right|}{\\sqrt{\\langle \\phi_n, \\phi_n \\rangle_h}\\,\\sqrt{\\langle s_n, s_n \\rangle_h}}$，其中 $\\phi_n$ 是数值本征向量，$s_n$ 是采样得到的解析本征向量。\n- 测试用例：\n    - 用例 1：$L = 1.0$, $N = 10$, $k = 3$。\n    - 用例 2：$L = 1.0$, $N = 50$, $k = 5$。\n    - 用例 3：$L = 2.0$, $N = 20$, $k = 4$。\n    - 用例 4：$L = 1.0$, $N = 2$, $k = 2$。\n\n验证结论：\n此问题有效。它具有科学依据，代表了量子力学中的一个典型问题（盒子中的粒子），并采用了一种标准的数值技术（有限差分法）。该问题是适定的，所有参数、定义和评估标准都已明确规定。它是客观且自洽的，不需要外部信息或假设。该问题没有任何指定的无效性缺陷。\n\n解题思路：\n目标是使用有限差分法求解一维无限深势阱中粒子的不含时薛定谔方程，并量化该数值近似的准确性。\n\n控制方程是本征值问题 $\\hat{H}\\psi(x) = E\\psi(x)$，其中在原子单位制（$m=1, \\hbar=1$）下，哈密顿算符为 $\\hat{H} = -\\frac{1}{2}\\frac{d^2}{dx^2}$。因此方程为：\n$$ -\\frac{1}{2}\\frac{d^2\\psi}{dx^2} = E\\psi(x) $$\n此方程定义在区间 $x \\in [0, L]$ 上，并满足 Dirichlet 边界条件 $\\psi(0)=0$ 和 $\\psi(L)=0$。\n\n第一步是将连续域离散化。将区间 $[0, L]$ 分成 $N+1$ 个等长的段，每段长度为 $h = \\frac{L}{N+1}$。这定义了一个包含 $N+2$ 个点的网格，点的位置为 $x_i = i \\cdot h$，$i=0, 1, \\dots, N+1$。函数 $\\psi(x)$ 由其在内部网格点上的值构成的向量 $\\mathbf{\\Psi} = [\\psi_1, \\psi_2, \\dots, \\psi_N]^T$ 表示，其中 $\\psi_i = \\psi(x_i)$。边界条件强制要求 $\\psi_0 = \\psi(0) = 0$ 和 $\\psi_{N+1} = \\psi(L) = 0$。\n\n接下来，在每个内部网格点 $x_i$ 处，使用三点中心有限差分公式来近似二阶导数算符 $\\frac{d^2}{dx^2}$：\n$$ \\frac{d^2\\psi}{dx^2}\\bigg|_{x=x_i} \\approx \\frac{\\psi(x_{i+1}) - 2\\psi(x_i) + \\psi(x_{i-1})}{h^2} = \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2} $$\n将此近似代入薛定谔方程，对每个点 $i=1, \\dots, N$ 得到一个线性方程组：\n$$ -\\frac{1}{2h^2} (\\psi_{i-1} - 2\\psi_i + \\psi_{i+1}) = E \\psi_i $$\n这可以重排为：\n$$ -\\frac{1}{2h^2}\\psi_{i-1} + \\frac{1}{h^2}\\psi_i - \\frac{1}{2h^2}\\psi_{i+1} = E\\psi_i $$\n这个包含 $N$ 个方程的系统可以表示为标准本征值问题的矩阵形式 $H\\mathbf{\\Psi} = E\\mathbf{\\Psi}$。矩阵 $H$ 是哈密顿算符的离散表示。\n\n通过考虑每个索引 $i$ 的方程可以确定 $N \\times N$ 哈密顿矩阵 $H$ 的元素。对于 $1 < i < N$，方程直接给出了第 $i$ 行的元素。对于边界索引 $i=1$ 和 $i=N$，我们使用条件 $\\psi_0=0$ 和 $\\psi_{N+1}=0$。\n对于 $i=1$：$-\\frac{1}{2h^2}\\psi_{0} + \\frac{1}{h^2}\\psi_1 - \\frac{1}{2h^2}\\psi_2 = E\\psi_1 \\implies \\frac{1}{h^2}\\psi_1 - \\frac{1}{2h^2}\\psi_2 = E\\psi_1$。\n对于 $i=N$：$-\\frac{1}{2h^2}\\psi_{N-1} + \\frac{1}{h^2}\\psi_N - \\frac{1}{2h^2}\\psi_{N+1} = E\\psi_N \\implies -\\frac{1}{2h^2}\\psi_{N-1} + \\frac{1}{h^2}\\psi_N = E\\psi_N$。\n\n这种构建方法得到一个实对称三对角矩阵 $H$，其元素如下：\n$$ H_{ij} = \\begin{cases} \\frac{1}{h^2} & \\text{若 } i=j \\\\ -\\frac{1}{2h^2} & \\text{若 } |i-j|=1 \\\\ 0 & \\text{其他情况} \\end{cases} $$\n求解矩阵本征值方程 $H\\mathbf{\\phi}_n = E_n^{\\text{num}}\\mathbf{\\phi}_n$ 可得到数值本征值 $E_n^{\\text{num}}$ 和相应的数值本征向量 $\\mathbf{\\phi}_n$。这些本征向量构成一个标准正交基。本征值按升序排序，即 $E_1^{\\text{num}} < E_2^{\\text{num}} < \\dots < E_N^{\\text{num}}$。\n\n然后，将前 $k$ 个态（$n=1, \\dots, k$）的数值结果与精确解析解进行比较。\n解析能量由 $E_n^{\\text{ana}} = \\frac{n^2 \\pi^2}{2 L^2}$ 给出。最大相对能量误差计算为 $\\max_{1 \\le n \\le k} \\left|E_n^{\\text{num}} - E_n^{\\text{ana}}\\right|/E_n^{\\text{ana}}$。\n\n为了比较本征向量，在内部网格点上采样解析本征函数 $\\psi_n(x) = \\sqrt{\\frac{2}{L}} \\sin(\\frac{n\\pi x}{L})$，以形成分量为 $s_{n,i} = \\psi_n(x_i)$ 的向量 $s_n$。数值本征向量 $\\phi_n$ 与采样得到的解析向量 $s_n$ 之间的重叠 $\\mathcal{O}_n$ 使用指定的网格加权内积 $\\langle u,v\\rangle_h = h \\sum_{i=1}^N u_i v_i$ 进行计算。其公式为：\n$$ \\mathcal{O}_n = \\frac{\\left|\\langle \\phi_n, s_n \\rangle_h\\right|}{\\sqrt{\\langle \\phi_n, \\phi_n \\rangle_h}\\,\\sqrt{\\langle s_n, s_n \\rangle_h}} $$\n项 $\\langle \\phi_n, \\phi_n \\rangle_h$ 是数值本征向量在网格加权空间中范数的平方，$\\langle s_n, s_n \\rangle_h$ 同理。分子中的绝对值确保了重叠度不受所计算本征向量任意符号的影响。前 $k$ 个态中的最小重叠 $\\min_{1 \\le n \\le k} \\mathcal{O}_n$ 是第二个总结性指标。\n\n对每个测试用例执行此过程，以生成所需的总结性指标对。使用一个用于对称矩阵的标准数值本征求解器来获得 $H$ 的本征值和本征向量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D particle in a box problem using the finite difference method\n    and compares the numerical results to analytical solutions for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L, N, k)\n    # L: length of the box\n    # N: number of interior grid points\n    # k: number of lowest energy states to compare\n    test_cases = [\n        (1.0, 10, 3),\n        (1.0, 50, 5),\n        (2.0, 20, 4),\n        (1.0, 2, 2),\n    ]\n\n    all_results = []\n\n    for L, N, k in test_cases:\n        # 1. Discretize the domain.\n        # h is the grid spacing.\n        h = L / (N + 1)\n        # x_grid represents the interior grid points x_i = i*h for i=1,...,N.\n        x_grid = np.arange(1, N + 1) * h\n\n        # 2. Construct the N x N Hamiltonian matrix H.\n        diag_val = 1.0 / (h**2)\n        off_diag_val = -1.0 / (2.0 * h**2)\n        \n        H = np.diag(np.full(N, diag_val))\n        if N > 1:\n            H += np.diag(np.full(N - 1, off_diag_val), k=1)\n            H += np.diag(np.full(N - 1, off_diag_val), k=-1)\n\n        # 3. Solve the eigenvalue problem H*phi = E*phi for eigenvalues and eigenvectors.\n        # np.linalg.eigh is used for real symmetric matrices.\n        # It returns sorted eigenvalues and corresponding orthonormal eigenvectors.\n        evals_num, evecs_num = np.linalg.eigh(H)\n\n        rel_errors = []\n        overlaps = []\n\n        # Helper function for the grid-weighted inner product <u,v>_h = h * sum(u_i * v_i).\n        def grid_inner_product(u, v, step):\n            return step * np.dot(u, v)\n\n        # 4. Compare the first k numerical eigenpairs with analytical solutions.\n        for n_idx in range(k):\n            # Quantum number n starts from 1.\n            n = n_idx + 1\n\n            # Get the numerical eigenvalue and eigenvector for state n.\n            E_num = evals_num[n_idx]\n            phi_n = evecs_num[:, n_idx]\n\n            # Calculate the analytical eigenvalue.\n            E_ana = (n**2 * np.pi**2) / (2 * L**2)\n            # Create the vector of the analytical eigenfunction sampled at grid points.\n            s_n = np.sqrt(2.0 / L) * np.sin(n * np.pi * x_grid / L)\n\n            # 5. Calculate the specified metrics for the current state n.\n            # a) Relative energy error\n            rel_error = np.abs(E_num - E_ana) / E_ana\n            rel_errors.append(rel_error)\n\n            # b) Eigenvector overlap\n            # Numerator: absolute value of the inner product |<phi_n, s_n>_h|.\n            inner_prod_phi_s = grid_inner_product(phi_n, s_n, h)\n            \n            # Denominator: product of the norms ||phi_n||_h * ||s_n||_h.\n            norm_sq_phi = grid_inner_product(phi_n, phi_n, h)\n            norm_sq_s = grid_inner_product(s_n, s_n, h)\n            \n            overlap = np.abs(inner_prod_phi_s) / (np.sqrt(norm_sq_phi) * np.sqrt(norm_sq_s))\n            overlaps.append(overlap)\n            \n        # 6. Calculate summary metrics (max error, min overlap) for the test case.\n        max_rel_error = np.max(rel_errors)\n        min_overlap = np.min(overlaps)\n        \n        all_results.append(f\"[{max_rel_error},{min_overlap}]\")\n\n    # Final print statement in the exact required format.\n    # Example: [[M_1,R_1],[M_2,R_2],[M_3,R_3],[M_4,R_4]]\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"}]}