{"hands_on_practices": [{"introduction": "波函数的归一化是量子力学概率诠释的基石，它确保了在整个空间中找到一个粒子的总概率为 $1$。这个练习以“环上粒子”这一基本模型为背景，让你实践如何处理复数形式的波函数和周期性边界条件，这对于理解芳香分子中的电子离域等化学现象至关重要。通过求解这个问题，你将掌握将波函数的模方（$|\\psi(\\phi)|^2$）在整个构型空间上积分以获得归一化常数的核心技能 [@problem_id:2467244]。", "problem": "一个非相对论性的无自旋粒子被约束在$xy$平面内一个固定半径为$R$的一维环上运动。位形坐标是极角 $\\phi \\in [0, 2\\pi)$，以弧度为单位。考虑定态波函数\n$$\n\\psi(\\phi) = A \\exp(i m \\phi),\n$$\n其中 $A$ 是一个复常数，$m$ 是一个实参数。使用波函数的概率诠释，对环的位形空间施加归一化条件，使得在环上任意位置找到该粒子的总概率为 $1$。确定归一化 $\\psi(\\phi)$ 的 $A$ 值，选择 $A$ 为实数且非负。将你的最终答案表示为一个无单位的单一闭式解析表达式。", "solution": "首先对问题陈述进行验证。\n\n第一步：提取已知条件。\n- 粒子：非相对论性，无自旋。\n- 几何：$xy$平面内固定半径为$R$的一维环。\n- 坐标：极角 $\\phi \\in [0, 2\\pi)$。\n- 波函数：$\\psi(\\phi) = A \\exp(i m \\phi)$。\n- 常数 $A$：复数。\n- 参数 $m$：实数。\n- 条件：在环上任意位置找到该粒子的总概率为 $1$。\n- 目标：确定 $A$ 的值。\n- 对 $A$ 的约束：$A$ 必须为实数且非负。\n\n第二步：使用提取的已知条件进行验证。\n该问题具有科学依据，因为它描述了量子力学中的一个标准模型——环上粒子。该波函数的形式是此系统的一个正确的定态解。基于概率诠释（玻恩定则）的归一化条件是量子力学的一个基本公理。该问题是适定的，提供了所有必要信息：波函数、坐标 $\\phi$ 的定义域，以及确保唯一解的对归一化常数 $A$ 的约束。语言客观、精确。该问题是完整的、一致的且科学上合理的。未发现任何缺陷。\n\n第三步：结论与行动。\n问题有效。将提供解答。\n\n根据 Max Born 提出的波函数的概率诠释，在特定位形坐标 $\\phi$ 处找到粒子的概率密度由波函数的模的平方 $|\\psi(\\phi)|^2$ 给出。在无穷小角区间 $d\\phi$ 内找到粒子的概率是 $|\\psi(\\phi)|^2 d\\phi$。\n\n为确保粒子必然在环上的某处被找到，总概率必须归一化为 $1$。这通过在整个位形空间上对概率密度进行积分来实现，对于环来说，该空间是区间 $\\phi \\in [0, 2\\pi)$。因此，归一化条件表示为积分：\n$$\n\\int_{0}^{2\\pi} |\\psi(\\phi)|^2 d\\phi = 1\n$$\n注意，微分元是 $d\\phi$，因为波函数是作为角度 $\\phi$ 的函数给出的，我们是对这个坐标的空间进行积分。本次特定计算不需要半径 $R$。\n\n给定的波函数是 $\\psi(\\phi) = A \\exp(i m \\phi)$，其中 $A$ 是待定的复常数，$m$ 是实参数。首先，我们计算模的平方 $|\\psi(\\phi)|^2$。这是波函数与其复共轭 $\\psi^*(\\phi)$ 的乘积。\n$\\psi(\\phi)$ 的复共轭是：\n$$\n\\psi^*(\\phi) = (A \\exp(i m \\phi))^* = A^* \\exp(-i m \\phi)\n$$\n这里，$A^*$ 是 $A$ 的复共轭。参数 $m$ 和坐标 $\\phi$ 是实数，所以 $i^* = -i$。\n\n现在，我们计算乘积 $\\psi^*(\\phi) \\psi(\\phi)$：\n$$\n|\\psi(\\phi)|^2 = \\psi^*(\\phi) \\psi(\\phi) = \\left( A^* \\exp(-i m \\phi) \\right) \\left( A \\exp(i m \\phi) \\right)\n$$\n$$\n|\\psi(\\phi)|^2 = A^* A \\exp(-i m \\phi + i m \\phi) = |A|^2 \\exp(0) = |A|^2\n$$\n概率密度 $|\\psi(\\phi)|^2$ 是一个常数 $|A|^2$，与角度 $\\phi$ 无关。这是环上动量定态的特征，反映了粒子在任何位置被找到的概率都相等的事实。\n\n我们将此结果代入归一化积分中：\n$$\n\\int_{0}^{2\\pi} |A|^2 d\\phi = 1\n$$\n由于 $|A|^2$ 是一个常数，它可以从积分中提出来：\n$$\n|A|^2 \\int_{0}^{2\\pi} d\\phi = 1\n$$\n该积分是初等的：\n$$\n\\int_{0}^{2\\pi} d\\phi = [\\phi]_{0}^{2\\pi} = 2\\pi - 0 = 2\\pi\n$$\n将此结果代回方程中，得到：\n$$\n|A|^2 (2\\pi) = 1\n$$\n求解 $|A|^2$：\n$$\n|A|^2 = \\frac{1}{2\\pi}\n$$\n对两边取平方根，得到常数 $A$ 的模：\n$$\n|A| = \\sqrt{\\frac{1}{2\\pi}} = \\frac{1}{\\sqrt{2\\pi}}\n$$\n问题指定了一个附加约束：归一化常数 $A$ 必须是实数且非负。如果 $A$ 是一个实数，它的复共轭是它本身，即 $A^* = A$，它的模就是它的绝对值 $|A|$。因为 $A$ 还必须是非负的，所以我们有 $|A| = A$。\n\n因此，我们可以得出结论：\n$$\nA = \\frac{1}{\\sqrt{2\\pi}}\n$$\n这就是满足所有给定条件的归一化常数的值。归一化后的定态波函数是 $\\psi(\\phi) = \\frac{1}{\\sqrt{2\\pi}} \\exp(i m \\phi)$。", "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{2\\pi}}}\n$$", "id": "2467244"}, {"introduction": "一旦波函数被正确归一化，我们就可以用它来预测粒子在特定区域内出现的概率，这是连接抽象理论与实验观测的关键一步。本练习以经典的“箱中粒子”模型为基础，要求你计算粒子在箱子某一特定半区内被发现的概率。这个过程不仅能让你熟练运用概率积分 $P = \\int_a^b |\\psi(x)|^2 dx$，还能加深你对量子态概率密度分布对称性的直观理解 [@problem_id:2467295]。", "problem": "一个宽度为 $L$ 的一维无限深势阱（箱中粒子）中的粒子，在 $x=0$ 和 $x=L$ 处有不可穿透的壁，势能在区间外为 $V(x)=\\infty$，区间内为 $V(x)=0$。归一化的定态本征函数为\n$$\n\\psi_{n}(x)=\n\\begin{cases}\n\\sqrt{\\frac{2}{L}}\\sin\\!\\left(\\frac{n\\pi x}{L}\\right), & 0\\le x\\le L \\\\\n0, & \\text{otherwise}\n\\end{cases}\n$$\n其中 $n$ 是一个正整数。系统被制备在量子数为 $n=2$ 的定态上。一名学生声称，在箱子的左半部分，即区间 $\\left[0,\\frac{L}{2}\\right]$ 中，找到该粒子的概率恰好是 $0.5$。利用波函数的概率诠释，并从第一性原理出发进行显式计算，确定在 $n=2$ 的状态下，在 $\\left[0,\\frac{L}{2}\\right]$ 中找到该粒子的概率。将你的最终答案表示为一个没有单位的最简分数（无需近似；不需要四舍五入）。", "solution": "波函数的概率诠释指出，在区间 $\\left[a,b\\right]$ 中找到粒子的概率由下式给出\n$$\nP\\left([a,b]\\right)=\\int_{a}^{b}\\left|\\psi(x)\\right|^{2}\\,dx.\n$$\n对于一维无限深势阱，归一化的定态本征函数为\n$$\n\\psi_{n}(x)=\\sqrt{\\frac{2}{L}}\\sin\\!\\left(\\frac{n\\pi x}{L}\\right)\n$$\n在 $0\\le x\\le L$ 范围内如此，其它情况下为零。对于 $n=2$ 的状态，这变为\n$$\n\\psi_{2}(x)=\\sqrt{\\frac{2}{L}}\\sin\\!\\left(\\frac{2\\pi x}{L}\\right).\n$$\n因此，在箱子的左半部分 $\\left[0,\\frac{L}{2}\\right]$ 中找到该粒子的概率是\n$$\nP=\\int_{0}^{L/2}\\left|\\psi_{2}(x)\\right|^{2}\\,dx=\\int_{0}^{L/2}\\frac{2}{L}\\sin^{2}\\!\\left(\\frac{2\\pi x}{L}\\right)\\,dx.\n$$\n使用三角恒等式 $\\sin^{2}(u)=\\frac{1}{2}\\left(1-\\cos(2u)\\right)$，其中 $u=\\frac{2\\pi x}{L}$，可写为\n$$\n\\sin^{2}\\!\\left(\\frac{2\\pi x}{L}\\right)=\\frac{1}{2}\\left(1-\\cos\\!\\left(\\frac{4\\pi x}{L}\\right)\\right).\n$$\n将此代入积分，得到\n$$\nP=\\int_{0}^{L/2}\\frac{2}{L}\\cdot\\frac{1}{2}\\left(1-\\cos\\!\\left(\\frac{4\\pi x}{L}\\right)\\right)\\,dx=\\int_{0}^{L/2}\\frac{1}{L}\\left(1-\\cos\\!\\left(\\frac{4\\pi x}{L}\\right)\\right)\\,dx.\n$$\n这可以分为\n$$\nP=\\frac{1}{L}\\int_{0}^{L/2}1\\,dx-\\frac{1}{L}\\int_{0}^{L/2}\\cos\\!\\left(\\frac{4\\pi x}{L}\\right)\\,dx.\n$$\n计算每一项：\n$$\n\\frac{1}{L}\\int_{0}^{L/2}1\\,dx=\\frac{1}{L}\\left[\\;x\\;\\right]_{0}^{L/2}=\\frac{1}{L}\\cdot\\frac{L}{2}=\\frac{1}{2},\n$$\n以及\n$$\n\\frac{1}{L}\\int_{0}^{L/2}\\cos\\!\\left(\\frac{4\\pi x}{L}\\right)\\,dx=\\frac{1}{L}\\cdot\\frac{L}{4\\pi}\\left[\\;\\sin\\!\\left(\\frac{4\\pi x}{L}\\right)\\;\\right]_{0}^{L/2}=\\frac{1}{4\\pi}\\left(\\sin(2\\pi)-\\sin(0)\\right)=\\frac{1}{4\\pi}\\left(0-0\\right)=0.\n$$\n合并结果，\n$$\nP=\\frac{1}{2}-0=\\frac{1}{2}.\n$$\n因此，显式计算表明，对于 $n=2$ 的情况，在 $\\left[0,\\frac{L}{2}\\right]$ 中找到粒子的概率恰好是 $\\frac{1}{2}$，所以该学生声称其恰好是 $0.5$ 的说法是正确的。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2467295"}, {"introduction": "由 $|\\psi|^2$ 所描述的波函数概率特性，不仅是理论上的概念，更是驱动现代计算化学模拟的强大引擎。这个动手编程练习将指导你实现一个蒙特卡洛采样器，这是一种根据量子概率密度在空间中生成点云来“可视化”原子轨道的关键技术。通过完成这个任务，你将亲身体验如何将抽象的量子概率转化为具体、可分析的计算数据，这是计算化学家的基本功之一 [@problem_id:2467283]。", "problem": "您需要为氢原子基态轨道实现一个蒙特卡洛采样器，并用它来计算采样分布的定量诊断指标。所使用的科学基础是波函数的玻恩诠释：位置空间中的概率密度是波函数模的平方。对于处于基态的氢原子，其 $1s$ 轨道的实空间波函数是球对称的，由下式给出\n$$\n\\psi_{1s}(r) \\;=\\; \\frac{1}{\\sqrt{\\pi}}\\,\\frac{1}{a_0^{3/2}}\\,e^{-r/a_0},\n$$\n其中 $r$ 是与原子核的径向距离，$a_0$ 是玻尔半径。在三维空间中可测量的概率密度是 $|\\psi_{1s}(r)|^2$。您所采取的每一个计算步骤都必须遵循这种概率性诠释以及上述氢原子 $1s$ 波函数的定义。\n\n您的任务是：\n- 设计一个基于概率法则的有原则的算法，用以在 $\\mathbb{R}^3$ 空间中按照 $|\\psi_{1s}(r)|^2$ 的分布进行采样。您必须从球对称性以及三维概率密度与径向分布之间的关系出发进行推导。角度必须以弧度处理。\n- 尽管概念上的目标是生成三维可视化图像，但在此编程任务中，您不能创建任何绘图。而是要计算能够验证采样正确性的定量诊断指标。\n- 对于每个测试用例，使用按规定设置种子的可复现随机数生成器生成 $N$ 个独立样本。使用这些样本，计算以下三个诊断指标，所有指标都以玻尔半径 $a_0$ 为单位，表示为无量纲量：\n  1) $r/a_0$ 的样本均值，\n  2) $(r/a_0)^2$ 的样本均值，\n  3) 满足 $r/a_0 \\le r_0/a_0$ 的点的样本比例，其中 $r_0/a_0$ 是以 $a_0$ 为单位给定的阈值。\n- 为每个测试用例按上述顺序报告这三个诊断指标，四舍五入到 $6$ 位小数。\n\n物理和数值单位：\n- 距离必须以玻尔半径 $a_0$ 为单位处理。您的输出必须是无量纲数，并按照上述规定用 $a_0$ 的适当次幂进行显式归一化。\n- 您在内部使用的任何角度变量都必须是弧度。无需输出任何角度。\n\n测试套件：\n实现您的程序以运行以下测试用例，每个用例指定为一个元组 $(N,\\ \\text{seed},\\ a_0,\\ r_0/a_0)$：\n- 用例 A: $(100000,\\ 12345,\\ 1.0,\\ 1.0)$\n- 用例 B: $(200000,\\ 2023,\\ 2.0,\\ 2.0)$\n- 用例 C: $(1000,\\ 7,\\ 0.5,\\ 0.5)$\n\n答案规格和最终输出格式：\n- 对于每个测试用例，生成一个包含三个浮点数的列表：$[\\overline{r/a_0},\\ \\overline{(r/a_0)^2},\\ \\widehat{F}(r_0/a_0)]$，其中上划线表示样本均值，帽子符号表示样本比例估计值。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为逗号分隔的列表的列表，并用方括号括起来。例如，一个包含三个用例的输出必须如下所示：\n\"[[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],[x_{31},x_{32},x_{33}]]\"\n其中每个 $x_{ij}$ 是一个四舍五入到 $6$ 位小数的浮点数，且无附加文本。", "solution": "问题陈述已经过验证，并被认定是有效的。这是一个适定问题，其基础是量子力学的基本原理，特别是氢原子波函数的概率性诠释。该问题的表述是客观、自洽且计算上可行的。任务是为基态电子分布构建一个蒙特卡洛采样器，并计算指定的统计诊断指标。\n\n解决方案的科学基础是玻恩诠释，该诠释指出，在位置 $\\vec{x}$ 处的一个小体积元 $dV$ 中找到一个粒子的概率由 $|\\psi(\\vec{x})|^2 dV$ 给出。对于氢原子 $1s$ 轨道，波函数 $\\psi_{1s}(r)$ 仅依赖于径向距离 $r = |\\vec{x}|$。该波函数由下式给出：\n$$\n\\psi_{1s}(r) = \\frac{1}{\\sqrt{\\pi} a_0^{3/2}} e^{-r/a_0}\n$$\n其中 $a_0$ 是玻尔半径。因此，三维空间中的概率密度为：\n$$\n|\\psi_{1s}(r)|^2 = \\frac{1}{\\pi a_0^3} e^{-2r/a_0}\n$$\n为了设计采样算法，我们将体积元 $dV$ 用球坐标 $(r, \\theta, \\phi)$ 表示为 $dV = r^2 \\sin\\theta dr d\\theta d\\phi$。这些坐标的联合概率密度是：\n$$\nP(r, \\theta, \\phi) dr d\\theta d\\phi = |\\psi_{1s}(r)|^2 dV = \\left(\\frac{1}{\\pi a_0^3} e^{-2r/a_0}\\right) r^2 \\sin\\theta dr d\\theta d\\phi\n$$\n该表达式可分离为径向和角向分量。分布对于方位角 $\\phi$ 在 $[0, 2\\pi]$ 上是均匀的，对于极角 $\\theta$ 在 $[0, \\pi]$ 上与 $\\sin\\theta$ 成正比。这对应于空间中方向的各向同性分布。然而，所需的诊断指标仅取决于径向距离 $r$。因此，我们可以对角度分量进行积分，以求得半径 $r$ 的边缘概率分布，记为 $P(r)$：\n$$\nP(r) dr = \\left( \\int_0^{2\\pi} d\\phi \\int_0^\\pi \\sin\\theta d\\theta \\right) \\frac{1}{\\pi a_0^3} r^2 e^{-2r/a_0} dr\n$$\n角向积分的计算结果为 $(2\\pi)(2) = 4\\pi$。代入此结果可得到径向分布函数：\n$$\nP(r) dr = (4\\pi) \\frac{1}{\\pi a_0^3} r^2 e^{-2r/a_0} dr = \\frac{4}{a_0^3} r^2 e^{-2r/a_0} dr\n$$\n为了简化问题并按要求使用无量纲量，我们引入一个缩放后的径向坐标 $\\rho = r/a_0$。因此，$r = \\rho a_0$ 且 $dr = a_0 d\\rho$。将这些代入径向分布函数，得到 $\\rho$ 的概率分布：\n$$\nP(\\rho) d\\rho = \\frac{4}{a_0^3} (\\rho a_0)^2 e^{-2(\\rho a_0)/a_0} (a_0 d\\rho) = 4 \\rho^2 e^{-2\\rho} d\\rho\n$$\n这个无量纲半径 $\\rho$ 的概率密度函数 $P(\\rho) = 4\\rho^2 e^{-2\\rho}$ 与玻尔半径 $a_0$无关。因此，计算所要求的无量纲诊断指标时，并不需要测试用例中给出的 $a_0$ 值。\n\n该算法的核心是从分布 $P(\\rho)$ 中生成随机样本。该分布是伽马分布的一个特例。具有形状参数 $k$ 和尺度参数 $\\theta$ 的伽马分布的概率密度函数由下式给出：\n$$\nf(x; k, \\theta) = \\frac{x^{k-1} e^{-x/\\theta}}{\\theta^k \\Gamma(k)}\n$$\n其中 $\\Gamma(k)$ 是伽马函数。对于我们的分布 $P(\\rho) = 4\\rho^2 e^{-2\\rho}$，我们可以确定 $k-1=2 \\implies k=3$ 和 $1/\\theta=2 \\implies \\theta=1/2$。归一化常数为 $\\frac{1}{(1/2)^3 \\Gamma(3)} = \\frac{1}{(1/8) \\cdot 2!} = \\frac{1}{1/4} = 4$，这与我们的 $P(\\rho)$ 相匹配。\n因此，无量纲半径 $\\rho$ 服从形状参数 $k=3$、尺度参数 $\\theta=0.5$ 的伽马分布：$\\rho \\sim \\text{Gamma}(k=3, \\theta=0.5)$。\n\n从该分布中采样的最符合原理且计算效率最高的方法是使用高质量的伽马分布随机数生成器，这在诸如 `NumPy` 等标准科学计算库中均有提供。\n\n计算流程如下：\n1. 对于由样本数 $N$、随机种子和阈值 $\\rho_0 = r_0/a_0$ 指定的每个测试用例，用给定的种子初始化一个随机数生成器，以确保可复现性。\n2. 从 $\\text{Gamma}(k=3, \\theta=0.5)$ 分布中生成 $N$ 个随机样本 $\\{\\rho_i\\}_{i=1}^N$。每个样本 $\\rho_i$ 代表一个 $r/a_0$ 的测量值。\n3. 根据这组样本计算所需的诊断指标：\n   - $r/a_0$ 的样本均值计算为 $\\overline{r/a_0} = \\frac{1}{N} \\sum_{i=1}^N \\rho_i$。\n   - $(r/a_0)^2$ 的样本均值计算为 $\\overline{(r/a_0)^2} = \\frac{1}{N} \\sum_{i=1}^N \\rho_i^2$。\n   - 满足 $r/a_0 \\le r_0/a_0$ 的点的样本比例是累积概率 $P(\\rho \\le \\rho_0)$ 的一个估计量，计算公式为 $\\widehat{F}(\\rho_0) = \\frac{\\text{count}(\\rho_i \\le \\rho_0)}{N}$。\n4. 然后将计算出的三个诊断指标四舍五入到 $6$ 位小数，并按规定格式化。对所有测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a Monte Carlo sampler for the hydrogen 1s orbital to compute\n    statistical diagnostics of the electron's radial distribution.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (N, seed, a_0, r_0/a_0)\n    test_cases = [\n        (100000, 12345, 1.0, 1.0),\n        (200000, 2023, 2.0, 2.0),\n        (1000, 7, 0.5, 0.5),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        N, seed, a0_val, r0_a0 = case\n\n        # The dimensionless radial coordinate rho = r/a_0 follows a Gamma distribution\n        # with shape k=3 and scale theta=0.5.\n        # PDF(rho) = 4 * rho^2 * exp(-2*rho)\n        # This derivation makes the physical parameter a_0 formally unnecessary for\n        # the computation of the requested dimensionless quantities.\n        shape_k = 3.0\n        scale_theta = 0.5\n\n        # Initialize a random number generator with the specified seed for reproducibility.\n        rng = np.random.default_rng(seed)\n\n        # Generate N samples for the dimensionless radius rho = r/a_0.\n        rho_samples = rng.gamma(shape=shape_k, scale=scale_theta, size=N)\n\n        # 1) Compute the sample mean of r/a_0.\n        mean_rho = np.mean(rho_samples)\n\n        # 2) Compute the sample mean of (r/a_0)^2.\n        mean_rho_sq = np.mean(np.square(rho_samples))\n\n        # 3) Compute the sample fraction of points with r/a_0 <= r_0/a_0.\n        # r0_a0 is the given dimensionless threshold rho_0.\n        fraction_le_r0 = np.sum(rho_samples <= r0_a0) / N\n\n        current_results = [mean_rho, mean_rho_sq, fraction_le_r0]\n        \n        # Format the numbers as strings with 6 decimal places.\n        formatted_strings = [f\"{x:.6f}\" for x in current_results]\n        \n        # Create the string representation of the list for this case.\n        all_results.append(f\"[{','.join(formatted_strings)}]\")\n\n    # Final print statement in the exact required format.\n    # Creates a string representation of a list of lists of floats.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2467283"}]}