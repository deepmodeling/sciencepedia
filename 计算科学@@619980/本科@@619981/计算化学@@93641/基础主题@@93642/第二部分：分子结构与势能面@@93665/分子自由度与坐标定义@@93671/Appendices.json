{"hands_on_practices": [{"introduction": "本练习是检验你计算非线性分子振动模式数量的基本能力的试金石。它强调了任何振动分析中的关键第一步：根据分子几何构型正确应用 $3N-6$ 规则。通过解决这个关于 $H_3^+$ 离子的具体问题，你将巩固对平动、转动和振动自由度之间区别的理解。[@problem_id:2458109]", "problem": "考虑三原子离子 $H_3^+$ 的稳定构型，它是一个位于平面内、在三维空间中自由运动的正三角形。对于一个由 $N$ 个点状原子核在三维空间中组成的分子，其构型可以由 $3N$ 个独立的笛卡尔坐标来指定。振动自由度定义为改变分子形状的独立内部坐标的数量，不包括对应于整个分子作为刚体的整体平动和整体转动的变化。确定 $H_3^+$ 在其稳定的正三角形构型下的振动自由度数。请以整数形式给出最终答案。", "solution": "该问题陈述已经过严格验证，被认为是科学上可靠、定义明确且客观的。它基于分子物理学和化学的既定原理，包含了所有必要信息，并且没有矛盾或含糊之处。因此，我将着手解答此问题。\n\n问题要求解三原子离子 $H_3^+$ 的振动自由度数。对于一个由 $N$ 个原子（视为质点）在三维空间中组成的分子，其总自由度数为 $3N$。这是因为每个原子的位置可以由三个独立的笛卡尔坐标（$x$、$y$、$z$）来描述。\n\n对于 $H_3^+$ 离子，原子数 $N=3$。因此，总自由度数为：\n$$N_{\\text{total}} = 3N = 3 \\times 3 = 9$$\n\n这些总自由度可以划分为分子整体运动的三种类型：平动、转动和振动。\n$$N_{\\text{total}} = N_{\\text{trans}} + N_{\\text{rot}} + N_{\\text{vib}}$$\n\n平动自由度数 $N_{\\text{trans}}$ 对应于分子质心的运动。在三维空间中，总是有 $3$ 个独立的平动方向（例如，沿 $x$、$y$和$z$轴）。因此：\n$$N_{\\text{trans}} = 3$$\n\n转动自由度数 $N_{\\text{rot}}$ 取决于分子的几何形状。\n- 对于**线性**分子，所有原子都位于一条直线上。绕此轴的转动不会改变原子核的位置，且对应的转动惯量实际上为零。因此，只有 $2$ 个转动自由度，对应于绕两个垂直于核间轴的轴的转动。\n- 对于**非线性**分子，原子不全在一条直线上。分子绕三个相互垂直的主轴具有非零的转动惯量。因此，有 $3$ 个转动自由度。\n\n问题陈述指出 $H_3^+$ 的稳定构型是正三角形。正三角形是三个原子的平面但非线性的排列方式。因此，$H_3^+$ 离子是一个非线性分子。其转动自由度数为：\n$$N_{\\text{rot}} = 3$$\n\n振动自由度数 $N_{\\text{vib}}$ 代表原子之间改变分子形状（键长和键角）的内部相对运动。这个数字是在扣除平动和转动的刚体运动后剩余的部分。我们可以通过重新排列分配方程来计算它：\n$$N_{\\text{vib}} = N_{\\text{total}} - N_{\\text{trans}} - N_{\\text{rot}}$$\n\n代入非线性分子的数值：\n$$N_{\\text{vib}} = 3N - 3 - 3 = 3N - 6$$\n\n现在，我们将此公式应用于 $H_3^+$ 离子，其中 $N=3$：\n$$N_{\\text{vib}} = 3(3) - 6 = 9 - 6 = 3$$\n\n因此，$H_3^+$ 离子拥有 $3$ 个振动自由度。这些振动模式对应于对称伸缩（一种呼吸模式）和一对简并的非对称伸缩和弯曲模式。", "answer": "$$\\boxed{3}$$", "id": "2458109"}, {"introduction": "超越简单的计数，这个思想实验挑战你从第一性原理推断出特定内部运动类型——扭转角——所需的最小结构复杂性。这个练习将加深你对内部坐标（如键长、键角和二面角）是如何从分子基本连接性中产生的理解，并将几何定义与自由度的抽象概念联系起来。[@problem_id:2458143]", "problem": "在三维空间中，考虑一个由 $N$ 个质点原子组成的孤立分子，这些原子通过共价键连接，形成一个单一的连通结构。关于原子 $j$ 和 $k$ 之间化学键的扭转角（二面角）被定义为通过原子 $\\{i,j,k\\}$ 的平面与通过原子 $\\{j,k,\\ell\\}$ 的平面之间的有向角，其中原子 $i$ 和 $\\ell$ 分别与 $j$ 和 $k$ 共价键合。如果一个自由度不能通过整个分子的整体平移或旋转来消除，并且是良定的（即，不存在使角度未定义的共线或重合构型），则称该自由度为非平庸的。\n\n一个分子可以拥有至少一个扭转角作为非平庸内自由度的最小整数 $N$ 是多少？请以一个不带单位的整数形式给出答案。", "solution": "首先将对问题陈述的科学性和逻辑完整性进行验证。\n\n步骤1：提取已知条件\n- 系统：一个位于三维空间中的孤立分子。\n- 组分：$N$ 个质点原子。\n- 连接性：原子通过共价键连接，形成一个单一的连通结构。\n- 扭转角的定义：通过原子 $\\{i, j, k\\}$ 的平面与通过原子 $\\{j, k, \\ell\\}$ 的平面之间的有向角，其中原子 $i$ 与 $j$ 键合，$j$ 与 $k$ 键合，$k$ 与 $\\ell$ 键合。\n- 非平庸内自由度的定义：一个自由度，(a) 不能通过整体平移或旋转消除，并且 (b) 是良定的，意味着没有共线或重合的排列使角度未定义。\n- 问题：确定能存在至少一个此类扭转角的最小整数 $N$。\n\n步骤2：使用已知条件进行验证\n该问题具有科学依据。原子、共价键、分子自由度和扭转角（二面角）等概念是化学和物理学中的基本原理，特别是在分子力学和计算化学领域。该问题提法清晰，要求满足一个明确定义条件的最小整数值。所提供的定义是标准且精确的。问题是客观的，没有主观或含糊不清的语言。它不违反任何无效性标准。\n\n步骤3：结论与行动\n该问题被判定为有效。将提供解答。\n\n为解决此问题，我们必须确定构建一个拥有扭转角作为非平庸内自由度的分子所需的最少原子数 $N$。\n\n根据其定义，扭转角涉及四个不同的、通过共价键连接的原子序列。我们将此序列表示为 $i-j-k-\\ell$。该角度由两个平面的交集定义：包含原子 $\\{i, j, k\\}$ 的平面和包含原子 $\\{j, k, \\ell\\}$ 的平面。这样一个四原子序列的存在立即确定了原子数的下限：$N \\ge 4$。\n\n现在，我们必须研究 $N < 4$ 的值是否能满足条件。\n- 对于 $N=1$，我们有一个单原子。它有 $3$ 个平动自由度。没有化学键，因此也没有内坐标。\n- 对于 $N=2$，我们有一个双原子分子。总自由度为 $3N = 3(2) = 6$。有 $3$ 个平动自由度。作为一个线性体系，它有 $2$ 个转动自由度。这剩下 $3N - 5 = 6 - 5 = 1$ 个内自由度，对应于两个原子之间化学键的伸缩。不可能形成一个四原子链。\n- 对于 $N=3$，我们有一个三原子分子。总自由度为 $3N = 3(3) = 9$。\n    - 如果分子是线性的，它有 $3N-5 = 4$ 个内自由度。但是，仅有三个原子，无法形成四原子序列 $i-j-k-\\ell$。此外，如果原子 $\\{i, j, k\\}$ 共线，包含它们的平面将是未定义的，这违反了“良定”的条件。\n    - 如果分子是非线性的，它有 $3N-6 = 3$ 个内自由度（通常是两个键的伸缩和一个角的弯曲）。同样，我们没有足够的原子来定义一个扭转角。\n因此，可以确定地得出结论，$N$ 必须至少为 $4$。\n\n接下来，我们研究 $N=4$ 的情况。考虑一个由四个原子（标记为 $1$、$2$、$3$ 和 $4$）组成的分子，它们以链状连接：$1-2-3-4$。此构型满足“单一连通结构”的要求。\n有四个原子，我们就可以定义一个关于原子 $2$ 和 $3$ 之间中心键的扭转角 $\\phi$。这个角由包含原子 $\\{1, 2, 3\\}$ 的平面和包含原子 $\\{2, 3, 4\\}$ 的平面构成。\n\n我们必须验证这个扭转角代表一个非平庸的内自由度。\n该系统的总自由度为 $3N = 3(4) = 12$。\n假设分子是非线性的（根据问题陈述，这是为了使平面良定所必需的），则有 $3$ 个平动自由度和 $3$ 个转动自由度。\n因此，内自由度的数量为 $3N - 6 = 12 - 6 = 6$。\n这 $6$ 个内自由度可以用一组内坐标来描述。对于链状分子 $1-2-3-4$，一个标准的选择是：\n1.  三个键长：$r_{12}$、$r_{23}$、$r_{34}$。\n2.  两个键角：$\\theta_{123}$、$\\theta_{234}$。\n3.  一个扭转角：$\\phi_{1234}$。\n\n这些内坐标的总数是 $3 + 2 + 1 = 6$，这与根据 $3N-6$ 公式计算出的内自由度数量完全匹配。扭转角 $\\phi_{1234}$ 是这些基本的、独立的内坐标之一。$\\phi_{1234}$ 的变化代表了围绕 $2-3$ 键的旋转，这会改变分子的内部几何构型。这种变化不能通过整个分子的刚性平移或旋转来复制，也不是简单的键伸缩或角弯曲。因此，它是一个非平庸的内自由度。“良定”条件通过规定原子不以共线方式排列来满足（例如，$\\theta_{123} \\neq \\pi$ 和 $\\theta_{234} \\neq \\pi$），这个条件对于几乎所有此类真实化学结构（如 n-butane 的碳骨架）都成立。\n\n由于 $N=4$ 是定义扭转角所需的最小原子数，并且它允许该角作为非平庸内自由度存在，因此它是最小的整数值。", "answer": "$$\\boxed{4}$$", "id": "2458143"}, {"introduction": "这最后一个实践练习将理论与计算应用联系起来，要求你编写一个程序，将分子的内部坐标（Z-矩阵）转换为我们熟悉的三维笛卡尔坐标。完成这项任务不仅能具体化你对内部坐标的理解，还能让你掌握在计算化学中构建和表示分子结构的实用技能。[@problem_id:2458138]", "problem": "编写一个完整的程序，根据一个固定的参考系约定，将一个水分子简单的内坐标规范（一个 Z-矩阵）转换为笛卡尔坐标。该分子由三个原子组成：一个氧原子和两个氢原子。该程序必须实现以下精确的数学规范，并为一组测试用例生成数值坐标。\n\n用于消除全局旋转和平移自由度的参考系约定：将原子 $1$ 放置在笛卡尔空间的原点 $(0,0,0)$，将原子 $2$ 放置在正 $x$ 轴上，其与原子 $1$ 的距离等于其键长，并将原子 $3$ 放置在 $xy$ 平面中，使其 $y$ 坐标为非负值，从而满足指定的内禀键角。角度应以度为单位进行解释。距离必须以埃（Ångström）为单位进行解释，最终坐标也必须以埃为单位表示。\n\n此处使用的标准三原子形式下的水分子的 Z-矩阵格式如下：\n- 第 $1$ 行：原子 $1$ 的标签（无参考原子）。\n- 第 $2$ 行：原子 $2$ 的标签，后跟参考原子的整数索引（必须为 $1$），再后跟以埃为单位的实数键长 $r_{12}$。\n- 第 $3$ 行：原子 $3$ 的标签，后跟键长参考原子的整数索引（必须为 $1$），再后跟以埃为单位的实数键长 $r_{13}$，然后是定义角度的原子的整数索引（必须为 $2$），最后是以度为单位的实数键角 $\\theta$。该角的顶点位于原子 $1$ 处，即 $\\theta$ 是向量 $\\overrightarrow{1\\to 2}$ 和 $\\overrightarrow{1\\to 3}$ 之间的夹角。\n\n在这些约定下，设笛卡尔坐标为 $\\mathbf{R}_1=(0,0,0)$、$\\mathbf{R}_2=(r_{12},0,0)$ 和 $\\mathbf{R}_3=(x_3,y_3,0)$，其中\n$$\nx_3 = r_{13}\\cos\\left(\\theta\\frac{\\pi}{180}\\right),\\quad\ny_3 = r_{13}\\sin\\left(\\theta\\frac{\\pi}{180}\\right),\\quad\nz_3 = 0.\n$$\n所有角度必须以度为单位进行解释，并使用因子 $\\pi/180$ 转换为弧度。\n\n您的程序必须将以下四个 Z-矩阵用例（每个用例由三行组成）硬编码为其测试套件。对于每个用例，使用上述规范计算所有三个原子的笛卡尔坐标。距离以埃为单位，角度以度为单位：\n\n- 用例 A（典型水分子几何结构）：$r_{12}=0.9572$， $r_{13}=0.9572$， $\\theta=104.5$。\n- 用例 B（不对称键，更宽的角度）：$r_{12}=1.0$， $r_{13}=0.9$， $\\theta=120.0$。\n- 用例 C（线性排列边界）：$r_{12}=1.0$， $r_{13}=1.5$， $\\theta=180.0$。\n- 用例 D（近乎塌陷的角度边界）：$r_{12}=0.5$， $r_{13}=0.5$， $\\theta=0.0$。\n\n在此问题中，每个 Z-矩阵的输入格式由标准三原子模板固定，并且必须对应于：\n- 第 1 行：O\n- 第 2 行：H $1$ $r_{12}$\n- 第 3 行：H $1$ $r_{13}$ $2$ $\\theta$\n\n您的程序必须：\n- 使用上述约定来确定每个用例的唯一笛卡尔坐标。\n- 以埃为单位表示所有坐标。\n- 将每个笛卡尔分量四舍五入到 $6$ 位小数。\n- 对于每个用例，按顺序 $[x_1,y_1,z_1,x_2,y_2,z_2,x_3,y_3,z_3]$ 返回一个包含 $9$ 个实数的列表。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，其中每个元素是对应一个用例的 $9$ 个四舍五入后的笛卡尔分量列表，顺序为用例 A、用例 B、用例 C、用例 D。例如，打印的行应具有\n$[[x_1,y_1,z_1,x_2,y_2,z_2,x_3,y_3,z_3],[\\dots],[\\dots],[\\dots]]$\n的形式，所有数值条目都显示为十进制字面量。\n\n没有用户输入。程序必须仅包含并使用上面给出的四个 Z-矩阵作为其测试套件，并在执行时产生所需的单行输出。", "solution": "该问题已经过验证，被认为是一个有效且定义明确的科学任务。它要求使用精确定义的参考系，实现一个将三原子分子的内坐标（Z-矩阵坐标）转换为笛卡尔坐标的标准坐标变换算法。所提供的数学公式和测试用例是一致且科学合理的。\n\n其核心原理是将由内坐标（键长和键角）指定的分子几何结构，转换为每个原子的一组笛卡尔坐标 $(x, y, z)$。这是计算化学和分子模拟中的一个基本操作。因为一个具有 $N$ 个原子的非线性分子有 $3N-6$ 个内禀自由度，所以在 $3N$ 维笛卡尔空间中的完整描述需要消除对应于全局平移和旋转的 $6$ 个自由度。该问题为此提供了特定的约定。\n\n设原子索引为 $1$（氧）、$2$（氢）和 $3$（氢）。它们的笛卡尔坐标向量为 $\\mathbf{R}_1$、$\\mathbf{R}_2$ 和 $\\mathbf{R}_3$。内坐标是键长 $r_{12}$（原子 $1$ 和 $2$ 之间的距离）和 $r_{13}$（原子 $1$ 和 $3$ 之间的距离），以及键角 $\\theta = \\angle(2-1-3)$。\n\n转换算法按照指定的参考系约定依次放置原子：\n\n$1$. 原子 $1$ 被放置在笛卡尔坐标系的原点。这固定了它的三个平移自由度。\n$$\n\\mathbf{R}_1 = (x_1, y_1, z_1) = (0, 0, 0)\n$$\n\n$2$. 原子 $2$ 被放置在正 $x$ 轴上。这固定了两个旋转自由度。它与原子 $1$ 的距离是键长 $r_{12}$。\n$$\n\\mathbf{R}_2 = (x_2, y_2, z_2) = (r_{12}, 0, 0)\n$$\n\n$3$. 原子 $3$ 被放置在 $y$ 分量为非负的 $xy$ 平面内。这固定了最后一个旋转自由度。它的位置由它与原子 $1$ 的距离 $r_{13}$ 以及它与向量 $\\overrightarrow{1\\to 2}$ 所成的角度 $\\theta$ 决定。在此坐标系中，向量 $\\overrightarrow{1\\to 2}$ 与 $x$ 轴对齐。通过在 $xy$ 平面中使用极坐标，可以推导出原子 $3$ 的坐标。角度 $\\theta$ 必须从度转换为弧度才能在三角函数中使用，转换因子为 $\\frac{\\pi}{180}$。\n$\\mathbf{R}_3$ 的坐标分量为：\n$$\nx_3 = r_{13} \\cos\\left(\\theta \\frac{\\pi}{180}\\right)\n$$\n$$\ny_3 = r_{13} \\sin\\left(\\theta \\frac{\\pi}{180}\\right)\n$$\n$$\nz_3 = 0\n$$\n对于非负 $y$ 分量的条件 $y_3 \\ge 0$ 是满足的，因为物理分子的键角 $\\theta$ 在 $[0, 180]$ 度的范围内，在此范围内正弦函数为非负。\n\n计算过程是为所提供的四个测试用例中的每一个应用这些公式。对于每个用例，使用参数集 $\\{r_{12}, r_{13}, \\theta\\}$ 来计算九个笛卡尔分量 $(x_1, y_1, z_1, x_2, y_2, z_2, x_3, y_3, z_3)$。每个分量必须四舍五入到 $6$ 位小数。然后将得到的九个坐标的列表收集到一个最终列表中以供输出。最终答案中的程序直接实现了这一规范。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Cartesian coordinates for four water molecule Z-matrix cases.\n    \"\"\"\n    # The problem defines four test cases with internal coordinates.\n    # Each case is a tuple: (r_12, r_13, theta_degrees)\n    # Distances are in Ångström, angles are in degrees.\n    test_cases = [\n        # Case A: typical water geometry\n        (0.9572, 0.9572, 104.5),\n        # Case B: asymmetric bonds, wider angle\n        (1.0, 0.9, 120.0),\n        # Case C: linear arrangement boundary\n        (1.0, 1.5, 180.0),\n        # Case D: nearly collapsed angle boundary\n        (0.5, 0.5, 0.0),\n    ]\n\n    results = []\n    for r12, r13, theta_deg in test_cases:\n        # Atom 1 (O) is at the origin (0, 0, 0).\n        r1_coords = [0.0, 0.0, 0.0]\n\n        # Atom 2 (H) is on the positive x-axis at a distance r12.\n        r2_coords = [r12, 0.0, 0.0]\n\n        # Atom 3 (H) is in the xy-plane.\n        # Convert angle from degrees to radians for trigonometric functions.\n        theta_rad = np.deg2rad(theta_deg)\n        \n        # Calculate coordinates for Atom 3 using polar-to-Cartesian conversion.\n        x3 = r13 * np.cos(theta_rad)\n        y3 = r13 * np.sin(theta_rad)\n        z3 = 0.0\n        r3_coords = [x3, y3, z3]\n\n        # Combine coordinates into a single list of 9 elements.\n        all_coords = r1_coords + r2_coords + r3_coords\n\n        # Round each component to 6 decimal places as required.\n        rounded_coords = [round(c, 6) for c in all_coords]\n        \n        results.append(rounded_coords)\n\n    # The final output must be a single-line string representing a list of lists.\n    # The template 'f\"[{','.join(map(str, results))}]\"' correctly formats this.\n    # For example, if results is [[1.0, 2.0], [3.0, 4.0]],\n    # map(str, results) yields '[1.0, 2.0]' and '[3.0, 4.0]'.\n    # ','.join(...) yields '[1.0, 2.0],[3.0, 4.0]'.\n    # The f-string adds the outer brackets, giving '[[1.0, 2.0],[3.0, 4.0]]'.\n    # This precisely matches the required output format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2458138"}]}