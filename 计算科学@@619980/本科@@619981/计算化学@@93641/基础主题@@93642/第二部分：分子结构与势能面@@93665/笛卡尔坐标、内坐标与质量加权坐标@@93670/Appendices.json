{"hands_on_practices": [{"introduction": "坐标变换是物理学中的一个强大工具，它通过选择一个更“自然”的视角来简化复杂问题。对于分子而言，一个关键的简化是将体系的整体运动（平动和转动）与其内部形状的变化（振动）分离开。这个练习将引导你完成一个基础但至关重要的推导，即将一个双原子体系的动能从笛卡尔坐标系转换到质心和相对坐标系，从而揭示总质量和平动、约化质量和内禀运动之间的深刻联系 [@problem_id:2452024]。", "problem": "考虑一个由两个原子组成的双原子分子，其质量分别为 $m_1$ 和 $m_2$，笛卡尔坐标位置为 $\\mathbf{r}_1, \\mathbf{r}_2 \\in \\mathbb{R}^3$。设总质量为 $M = m_1 + m_2$。通过基本关系 $\\mathbf{R}_{\\mathrm{cm}} = (m_1 \\mathbf{r}_1 + m_2 \\mathbf{r}_2)/M$ 和 $\\mathbf{r} = \\mathbf{r}_2 - \\mathbf{r}_1$ 定义质心 (COM) 位置向量 $\\mathbf{R}_{\\mathrm{cm}}$ 和相对位置向量 $\\mathbf{r}$。笛卡尔坐标系中的经典动能为 $T = \\tfrac{1}{2} m_1 |\\dot{\\mathbf{r}}_1|^2 + \\tfrac{1}{2} m_2 |\\dot{\\mathbf{r}}_2|^2$。\n\n仅使用这些定义和 $T$ 的表达式，在三维空间中完成以下任务：\n1. 推导从笛卡尔坐标 $(\\mathbf{r}_1, \\mathbf{r}_2)$ 到坐标 $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ 的线性变换及其逆变换。\n2. 计算从 $(\\mathbf{r}_1, \\mathbf{r}_2)$ 到 $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ 的变换的雅可比行列式 $J$ 的绝对值。\n3. 将 $T$ 用 $\\dot{\\mathbf{R}}_{\\mathrm{cm}}$ 和 $\\dot{\\mathbf{r}}$ 表示，并由此确定与核间距 $R = |\\mathbf{r}|$ 相关的有效质量。解释这如何与双原子内坐标表示（Z-矩阵）相关联，其中唯一的内坐标是键长 $R$，并陈述对应的键伸缩的质量加权内坐标。\n\n您最终报告的量必须是雅可比行列式 $J$。将 $J$ 表示为一个无量纲数。最终答案无需四舍五入，也不包含单位。", "solution": "在尝试任何解答之前，首先对问题陈述进行验证。\n\n第1步：提取已知条件\n- 两个原子，质量分别为 $m_1$ 和 $m_2$。\n- 笛卡尔位置向量 $\\mathbf{r}_1, \\mathbf{r}_2 \\in \\mathbb{R}^3$。\n- 总质量：$M = m_1 + m_2$。\n- 质心位置向量：$\\mathbf{R}_{\\mathrm{cm}} = (m_1 \\mathbf{r}_1 + m_2 \\mathbf{r}_2)/M$。\n- 相对位置向量：$\\mathbf{r} = \\mathbf{r}_2 - \\mathbf{r}_1$。\n- 笛卡尔坐标系中的经典动能：$T = \\tfrac{1}{2} m_1 |\\dot{\\mathbf{r}}_1|^2 + \\tfrac{1}{2} m_2 |\\dot{\\mathbf{r}}_2|^2$。\n- 任务：\n  1. 推导从 $(\\mathbf{r}_1, \\mathbf{r}_2)$ 到 $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ 的线性变换及其逆变换。\n  2. 计算从 $(\\mathbf{r}_1, \\mathbf{r}_2)$ 到 $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ 的变换的雅可比行列式 $J$ 的绝对值。\n  3. 将 $T$ 用 $\\dot{\\mathbf{R}}_{\\mathrm{cm}}$ 和 $\\dot{\\mathbf{r}}$ 表示，确定与核间距 $R = |\\mathbf{r}|$ 相关的有效质量，关联到Z-矩阵，并陈述键伸缩的质量加权内坐标。\n- 最终报告量：雅可比行列式 $J$。\n\n第2步：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确，且客观。这是经典力学和计算化学中的一个标准练习，基于坐标变换和二体问题的基本原理。所有定义都是标准和精确的。问题是自洽的，没有矛盾、歧义或事实错误。它与指定主题直接相关。满足有效问题的所有标准。\n\n第3步：结论和行动\n该问题被判定为 **有效**。将提供解答。\n\n该问题要求根据所提供的定义系统地推导几个量。我们将按顺序处理每个部分。\n\n第1部分：变换及其逆变换\n从笛卡尔坐标 $(\\mathbf{r}_1, \\mathbf{r}_2)$ 到质心和相对坐标 $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ 的变换由以下线性向量方程组给出：\n$$ \\mathbf{R}_{\\mathrm{cm}} = \\frac{m_1}{M} \\mathbf{r}_1 + \\frac{m_2}{M} \\mathbf{r}_2 $$\n$$ \\mathbf{r} = -\\mathbf{r}_1 + \\mathbf{r}_2 $$\n为求逆变换，我们必须解此方程组以得到 $\\mathbf{r}_1$ 和 $\\mathbf{r}_2$。从第二个方程，我们将 $\\mathbf{r}_2$ 用 $\\mathbf{r}_1$ 和 $\\mathbf{r}$ 表示：\n$$ \\mathbf{r}_2 = \\mathbf{r}_1 + \\mathbf{r} $$\n将此代入 $\\mathbf{R}_{\\mathrm{cm}}$ 的第一个方程中：\n$$ \\mathbf{R}_{\\mathrm{cm}} = \\frac{m_1 \\mathbf{r}_1 + m_2 (\\mathbf{r}_1 + \\mathbf{r})}{M} = \\frac{(m_1 + m_2) \\mathbf{r}_1 + m_2 \\mathbf{r}}{M} = \\frac{M \\mathbf{r}_1 + m_2 \\mathbf{r}}{M} = \\mathbf{r}_1 + \\frac{m_2}{M} \\mathbf{r} $$\n解出 $\\mathbf{r}_1$ 得：\n$$ \\mathbf{r}_1 = \\mathbf{R}_{\\mathrm{cm}} - \\frac{m_2}{M} \\mathbf{r} $$\n现在，将 $\\mathbf{r}_1$ 的这个表达式代回 $\\mathbf{r}_2$ 的方程中：\n$$ \\mathbf{r}_2 = \\left(\\mathbf{R}_{\\mathrm{cm}} - \\frac{m_2}{M} \\mathbf{r}\\right) + \\mathbf{r} = \\mathbf{R}_{\\mathrm{cm}} + \\left(1 - \\frac{m_2}{M}\\right) \\mathbf{r} = \\mathbf{R}_{\\mathrm{cm}} + \\left(\\frac{M - m_2}{M}\\right) \\mathbf{r} $$\n因为 $M = m_1 + m_2$，所以 $M - m_2 = m_1$。因此，\n$$ \\mathbf{r}_2 = \\mathbf{R}_{\\mathrm{cm}} + \\frac{m_1}{M} \\mathbf{r} $$\n因此，逆变换为：\n$$ \\mathbf{r}_1 = \\mathbf{R}_{\\mathrm{cm}} - \\frac{m_2}{m_1+m_2} \\mathbf{r} $$\n$$ \\mathbf{r}_2 = \\mathbf{R}_{\\mathrm{cm}} + \\frac{m_1}{m_1+m_2} \\mathbf{r} $$\n\n第2部分：雅可比行列式\n该变换是在构成 $(\\mathbf{r}_1, \\mathbf{r}_2)$ 的 6 个标量坐标 $(x_1, y_1, z_1, x_2, y_2, z_2)$ 与构成 $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ 的集合 $(X_{\\mathrm{cm}}, Y_{\\mathrm{cm}}, Z_{\\mathrm{cm}}, x, y, z)$ 之间进行的。雅可比矩阵 $\\mathbf{J}$ 由偏导数矩阵 $\\frac{\\partial(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})}{\\partial(\\mathbf{r}_1, \\mathbf{r}_2)}$ 给出。由于线性变换的逐分量性质，我们可以用 $3 \\times 3$ 的分块来分析它。雅可比矩阵为：\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial \\mathbf{R}_{\\mathrm{cm}}}{\\partial \\mathbf{r}_1} & \\frac{\\partial \\mathbf{R}_{\\mathrm{cm}}}{\\partial \\mathbf{r}_2} \\\\ \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{r}_1} & \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{r}_2} \\end{pmatrix} $$\n从正变换的定义方程可知：\n$$ \\frac{\\partial \\mathbf{R}_{\\mathrm{cm}}}{\\partial \\mathbf{r}_1} = \\frac{m_1}{M} \\mathbf{I}_3 \\quad , \\quad \\frac{\\partial \\mathbf{R}_{\\mathrm{cm}}}{\\partial \\mathbf{r}_2} = \\frac{m_2}{M} \\mathbf{I}_3 $$\n$$ \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{r}_1} = -\\mathbf{I}_3 \\quad , \\quad \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{r}_2} = \\mathbf{I}_3 $$\n其中 $\\mathbf{I}_3$ 是 $3 \\times 3$ 的单位矩阵。这个 $6 \\times 6$ 的雅可比矩阵是：\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{m_1}{M} \\mathbf{I}_3 & \\frac{m_2}{M} \\mathbf{I}_3 \\\\ -\\mathbf{I}_3 & \\mathbf{I}_3 \\end{pmatrix} $$\n计算逆变换的雅可比矩阵的行列式 $\\mathbf{J}^{-1} = \\frac{\\partial(\\mathbf{r}_1, \\mathbf{r}_2)}{\\partial(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})}$ 会更简单，然后使用恒等式 $\\det(\\mathbf{J}) = (\\det(\\mathbf{J}^{-1}))^{-1}$。从逆变换方程可知：\n$$ \\frac{\\partial \\mathbf{r}_1}{\\partial \\mathbf{R}_{\\mathrm{cm}}} = \\mathbf{I}_3 \\quad , \\quad \\frac{\\partial \\mathbf{r}_1}{\\partial \\mathbf{r}} = -\\frac{m_2}{M} \\mathbf{I}_3 $$\n$$ \\frac{\\partial \\mathbf{r}_2}{\\partial \\mathbf{R}_{\\mathrm{cm}}} = \\mathbf{I}_3 \\quad , \\quad \\frac{\\partial \\mathbf{r}_2}{\\partial \\mathbf{r}} = \\frac{m_1}{M} \\mathbf{I}_3 $$\n所以逆变换的雅可比矩阵是：\n$$ \\mathbf{J}^{-1} = \\begin{pmatrix} \\mathbf{I}_3 & -\\frac{m_2}{M} \\mathbf{I}_3 \\\\ \\mathbf{I}_3 & \\frac{m_1}{M} \\mathbf{I}_3 \\end{pmatrix} $$\n使用分块矩阵的行列式公式 $\\det \\begin{pmatrix} A & B \\\\ C & D \\end{pmatrix} = \\det(A) \\det(D - CA^{-1}B)$，其中 $A = \\mathbf{I}_3, B = -\\frac{m_2}{M} \\mathbf{I}_3, C = \\mathbf{I}_3, D = \\frac{m_1}{M} \\mathbf{I}_3$：\n$$ \\det(\\mathbf{J}^{-1}) = \\det(\\mathbf{I}_3) \\det\\left(\\frac{m_1}{M} \\mathbf{I}_3 - (\\mathbf{I}_3)(\\mathbf{I}_3)^{-1}(-\\frac{m_2}{M}\\mathbf{I}_3)\\right) $$\n$$ \\det(\\mathbf{J}^{-1}) = 1 \\cdot \\det\\left(\\frac{m_1}{M} \\mathbf{I}_3 + \\frac{m_2}{M}\\mathbf{I}_3\\right) = \\det\\left(\\frac{m_1+m_2}{M}\\mathbf{I}_3\\right) = \\det\\left(\\frac{M}{M}\\mathbf{I}_3\\right) = \\det(\\mathbf{I}_3) = 1 $$\n逆变换的雅可比行列式为 $1$。因此，正变换的雅可比行列式为 $J = \\det(\\mathbf{J}) = (\\det(\\mathbf{J}^{-1}))^{-1} = 1^{-1} = 1$。其绝对值为 $|J|=1$。\n\n第3部分：动能、折合质量和质量加权坐标\n为了用新坐标表示动能 $T$，我们对逆变换关系式对时间求导：\n$$ \\dot{\\mathbf{r}}_1 = \\dot{\\mathbf{R}}_{\\mathrm{cm}} - \\frac{m_2}{M} \\dot{\\mathbf{r}} $$\n$$ \\dot{\\mathbf{r}}_2 = \\dot{\\mathbf{R}}_{\\mathrm{cm}} + \\frac{m_1}{M} \\dot{\\mathbf{r}} $$\n将这些代入 $T$ 的表达式中：\n$$ T = \\frac{1}{2} m_1 \\left| \\dot{\\mathbf{R}}_{\\mathrm{cm}} - \\frac{m_2}{M} \\dot{\\mathbf{r}} \\right|^2 + \\frac{1}{2} m_2 \\left| \\dot{\\mathbf{R}}_{\\mathrm{cm}} + \\frac{m_1}{M} \\dot{\\mathbf{r}} \\right|^2 $$\n展开平方范数（点积）：\n$$ T = \\frac{1}{2} m_1 \\left( |\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2 - 2\\frac{m_2}{M}(\\dot{\\mathbf{R}}_{\\mathrm{cm}} \\cdot \\dot{\\mathbf{r}}) + \\frac{m_2^2}{M^2}|\\dot{\\mathbf{r}}|^2 \\right) + \\frac{1}{2} m_2 \\left( |\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2 + 2\\frac{m_1}{M}(\\dot{\\mathbf{R}}_{\\mathrm{cm}} \\cdot \\dot{\\mathbf{r}}) + \\frac{m_1^2}{M^2}|\\dot{\\mathbf{r}}|^2 \\right) $$\n按速度类型对各项进行分组：\n$|\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2$ 的项是 $\\frac{1}{2}(m_1+m_2)|\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2 = \\frac{1}{2}M|\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2$。\n$(\\dot{\\mathbf{R}}_{\\mathrm{cm}} \\cdot \\dot{\\mathbf{r}})$ 的交叉项是 $\\frac{1}{2}\\left(-2\\frac{m_1m_2}{M} + 2\\frac{m_2m_1}{M}\\right)(\\dot{\\mathbf{R}}_{\\mathrm{cm}} \\cdot \\dot{\\mathbf{r}}) = 0$。\n$|\\dot{\\mathbf{r}}|^2$ 的项是 $\\frac{1}{2} \\left( m_1 \\frac{m_2^2}{M^2} + m_2 \\frac{m_1^2}{M^2} \\right) |\\dot{\\mathbf{r}}|^2 = \\frac{1}{2} \\frac{m_1m_2(m_2+m_1)}{M^2} |\\dot{\\mathbf{r}}|^2 = \\frac{1}{2} \\frac{m_1m_2 M}{M^2} |\\dot{\\mathbf{r}}|^2 = \\frac{1}{2} \\frac{m_1m_2}{M} |\\dot{\\mathbf{r}}|^2$。\n我们定义折合质量 $\\mu$ 为 $\\mu = \\frac{m_1m_2}{m_1+m_2} = \\frac{m_1m_2}{M}$。\n动能分离为两个独立的项：\n$$ T = \\frac{1}{2}M|\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2 + \\frac{1}{2}\\mu|\\dot{\\mathbf{r}}|^2 $$\n第一项是整个分子作为位于质心的质点 $M$ 的平移动能。第二项是由相对向量 $\\mathbf{r}$ 描述的内运动动能。与此内运动相关的质量是折合质量 $\\mu$。因此，$\\mu$ 是与核间距 $R=|\\mathbf{r}|$ 相关运动的有效质量。\n\n对于双原子分子，Z-矩阵用单个坐标，即键长 $R_{12}$，来描述其内几何构型。这恰好是我们相对向量的模 $R=|\\mathbf{r}|$。动能表达式表明，有效质量为 $\\mu$ 的内运动与整体平动在动力学上是解耦的。\n\n构造质量加权坐标是为了简化振动的动能表达式。对于一组广义内坐标 $S_k$，振动动能为 $2T_{vib} = \\dot{\\mathbf{S}}^T \\mathbf{G}^{-1} \\dot{\\mathbf{S}}$。对于单个伸缩坐标 $S_1 = R$，相应的 Wilson G-矩阵元为 $G_{11} = \\frac{1}{m_1} + \\frac{1}{m_2} = \\frac{m_1+m_2}{m_1m_2} = \\frac{1}{\\mu}$。振动动能为 $T_{vib} = \\frac{1}{2} G_{11}^{-1} (\\dot{S}_1)^2 = \\frac{1}{2}\\mu \\dot{R}^2$。定义质量加权内坐标 $\\mathcal{S}_{stretch}$，使得动能具有 $T_{vib} = \\frac{1}{2}\\dot{\\mathcal{S}}_{stretch}^2$ 的形式。比较这两种形式，我们看到 $\\dot{\\mathcal{S}}_{stretch}^2 = \\mu \\dot{R}^2$，这意味着 $\\mathcal{S}_{stretch} = \\sqrt{\\mu}R$。\n对应的键伸缩的质量加权内坐标是 $\\sqrt{\\mu}R$。\n\n问题要求报告雅可比行列式 $J$。\n$$ J=1 $$", "answer": "$$\n\\boxed{1}\n$$", "id": "2452024"}, {"introduction": "每个坐标系都为我们观察系统的动力学行为提供了一个不同的窗口。在分子模拟中，选择使用哪种坐标系来记录数据，常常需要在数据存储量和信息完整性之间做出权衡。这个思想实验将挑战你思考一个核心问题：如果只记录一个分子的内坐标轨迹，哪些关于其运动的物理信息将不可逆转地丢失？通过这个练习，你将能更清晰地区分内禀自由度（决定分子形状）和外部自由度（决定分子的空间位置和取向）[@problem_id:2452012]。", "problem": "您正在对一个由 $N$ 个原子组成的孤立非线性分子在真空中进行分子动力学（MD）模拟。在每个保存的时刻 $t_k$，您只记录了一套完整的内坐标（Z-矩阵坐标）：足以定义分子形状的所有键长 $r$、键角 $\\theta$ 和二面角 $\\phi$，而没有保存完整的笛卡尔坐标 $\\{\\mathbf{r}_i(t_k)\\}_{i=1}^N$。您没有存储任何全局参考信息，如原点、实验室坐标系的基或任何参考原子的位置。您也精确地知道所有原子的质量 $\\{m_i\\}_{i=1}^N$。仅基于这条内坐标轨迹，即使进行任意的后处理，以下哪些关于系统轨迹的信息是根本上无法恢复的（即无法唯一重建）？\n\nA. 内部几何参数 $r(t)$、$\\theta(t)$ 和 $\\phi(t)$ 的时间序列。\n\nB. 质心位置 $\\mathbf{R}_{\\mathrm{COM}}(t)$ 在实验室坐标系中随时间的依赖关系。\n\nC. 分子在实验室坐标系中的整体旋转取向随时间的依赖关系（例如，其主惯性轴 $\\{\\hat{\\mathbf{e}}_i(t)\\}$ 的方向）。\n\nD. 在每个保存的时刻 $t$ 时，所有原子间成对距离 $d_{ij}(t)$ 的集合。\n\nE. 对于孤立分子，当力场仅依赖于原子间距离和内禀几何构型（例如，键合项加上作为 $d_{ij}$ 函数的非键合项），且没有外场时，势能 $U(t)$ 作为时间的函数。\n\n选择所有适用的选项。", "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- **系统**：一个由 $N$ 个原子组成的孤立非线性分子，处于真空中。\n- **模拟**：分子动力学（MD）。\n- **记录的数据**：在每个时间步长 $t_k$，记录了一套完整的内坐标（Z-矩阵坐标）：定义分子形状的所有键长 $r$、键角 $\\theta$ 和二面角 $\\phi$。\n- **排除的数据**：完整的笛卡尔坐标 $\\{\\mathbf{r}_i(t_k)\\}_{i=1}^N$ 以及任何全局参考系信息（原点、基、参考原子位置）。\n- **已知数据**：原子质量 $\\{m_i\\}_{i=1}^N$。\n- **问题**：确定哪些信息从给定的轨迹数据中是根本无法恢复的。\n- **关于势能的条件**：势能 $U(t)$ 仅依赖于原子间距离和内禀几何构型，且不存在外场。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题正确地构建在经典力学和计算化学的原理之上，涉及标准的坐标系（笛卡尔坐标系、内坐标系）及其性质。这些概念是合理的。\n- **适定性**：该问题是适定的。它清晰地定义了可用的信息（一套完整的内坐标和质量），并询问哪些信息无法被唯一地重建。基于坐标变换的数学性质，存在一个确定的解。\n- **客观性**：语言精确、技术性强，没有主观性。\n\n**步骤3：结论与行动**\n问题陈述有效。它在科学上是合理的、自洽的且无歧义的。将推导出解决方案。\n\n**推导**\n\n一个 $N$ 原子分子具有 $3N$ 个笛卡尔自由度，可以由实验室坐标系中的一组原子位置矢量 $\\{\\mathbf{r}_i \\in \\mathbb{R}^3\\}_{i=1}^N$ 表示。对于一个非线性分子，这 $3N$ 个自由度可以分解为：\n1.  3个平动自由度，描述质心的运动。\n2.  3个转动自由度，描述分子在空间中的整体取向。\n3.  $3N-6$ 个内（或振动）自由度，描述分子的形状（原子的相对位置）。\n\n内坐标，例如由键长（$r$）、键角（$\\theta$）和二面角（$\\phi$）组成的Z-矩阵，是一组旨在精确描述内自由度的 $3N-6$ 个参数。根据其数学构造，它们对于整个分子的刚性平动和转动是不变的。\n\n问题陈述我们已知在每个时间步长 $t_k$ 下，这套完整的 $3N-6$ 个内坐标。我们还已知原子质量 $\\{m_i\\}_{i=1}^N$。问题明确指出，没有存储任何关于实验室坐标系的信息。这意味着对应于3个平动自由度和3个转动自由度的信息已被丢弃。我们必须确定所列出的属性中，哪些依赖于这些被丢弃的信息。\n\n**逐项分析**\n\n**A. 内部几何参数 $r(t)$、$\\theta(t)$ 和 $\\phi(t)$ 的时间序列。**\n问题陈述明确说明：“您只记录了一套完整的内坐标（Z-矩阵坐标）在每个 $t_k$：所有键长 $r$、键角 $\\theta$ 和二面角 $\\phi$”。这意味着这些参数的时间序列正是所给定的数据。因此，这些信息不仅是可恢复的，它本身就是原始数据。\n结论：**错误**。\n\n**B. 质心位置 $\\mathbf{R}_{\\mathrm{COM}}(t)$ 在实验室坐标系中随时间的依赖关系。**\n质心位置由实验室坐标系中的绝对笛卡尔坐标定义：\n$$ \\mathbf{R}_{\\mathrm{COM}}(t) = \\frac{\\sum_{i=1}^N m_i \\mathbf{r}_i(t)}{\\sum_{i=1}^N m_i} $$\n这个量描述了分子的整体平动。根据定义，内坐标在任何平动 $\\mathbf{r}_i(t) \\to \\mathbf{r}_i(t) + \\mathbf{T}(t)$ 下都是不变的。由于所提供的数据中不包含任何用于固定分子空间位置的信息，因此根本不可能确定 $\\mathbf{R}_{\\mathrm{COM}}(t)$。任何质心轨迹都与给定的内坐标数据相符。因此，该信息是无法恢复的。\n结论：**正确**。\n\n**C. 分子在实验室坐标系中的整体旋转取向随时间的依赖关系（例如，其主惯性轴 $\\{\\hat{\\mathbf{e}}_i(t)\\}$ 的方向）。**\n整体旋转取向描述了分子在实验室坐标系中的朝向。与平动类似，内坐标在刚性转动下是不变的。从内坐标可以构建分子的形状，并计算相对于分子固定坐标系的属性（例如该坐标系下的惯性张量），但无法确定这个分子固定坐标系相对于外部实验室坐标系的方向。这些信息对应于已被丢弃的3个转动自由度。因此，整体旋转取向是无法恢复的。\n结论：**正确**。\n\n**D. 在每个保存的时刻 $t$ 时，所有原子间成对距离 $d_{ij}(t)$ 的集合。**\n一组完整的 $3N-6$ 个内坐标唯一地定义了分子的几何构型（形状）。从这些内坐标，可以通过算法构建一套所有原子的相对笛卡尔坐标，例如，将第一个原子置于原点，第二个原子置于一个坐标轴上，第三个原子置于一个平面上。一旦在给定的时间 $t$ 获知了这些相对原子位置 $\\{\\mathbf{r}_i^{\\text{rel}}\\}$，任何原子间的成对距离都可以通过 $d_{ij}(t) = ||\\mathbf{r}_i^{\\text{rel}}(t) - \\mathbf{r}_j^{\\text{rel}}(t)||$ 计算得出。由于距离是标量，它们对于相对坐标系原点和方向的选择是不变的。因此，所有原子间距离都可以从内坐标唯一地重建。\n结论：**错误**。\n\n**E. 对于孤立分子，当力场仅依赖于原子间距离和内禀几何构型（例如，键合项加上作为 $d_{ij}$ 函数的非键合项），且没有外场时，势能 $U(t)$ 作为时间的函数。**\n问题陈述，势能 $U(t)$ 是内部几何构型（键长、键角、二面角）和原子间距离 $d_{ij}$ 的函数。根据对选项A和D的分析：\n- 内坐标（$r, \\theta, \\phi$）是直接给出的。\n- 原子间距离（$d_{ij}$）可以从内坐标唯一地重建。\n既然势能仅依赖于那些已给定或可以从给定数据中唯一计算出的量，那么势能 $U(t)$ 本身在每个时间步长 $t_k$ 都可以被唯一地计算出来。因此，这些信息是可恢复的。\n结论：**错误**。\n\n总而言之，根本上无法恢复的信息是那些与分子在实验室坐标系中的整体平动和转动运动有关的信息。这些恰好是选项B和C中描述的量。", "answer": "$$\\boxed{BC}$$", "id": "2452012"}, {"introduction": "内坐标在理论上的优雅有时会在实际计算中遭遇严峻的挑战。一个构造不佳的Z-矩阵，即使在形式上是完备的，也可能引入严重的数值不稳定性，从而使几何优化等算法彻底失效。这个问题深入探讨了在Z-矩阵定义中，原子近乎共线这一微妙但至关重要的问题，以及它如何引发一系列连锁反应——从病态的坐标变换矩阵到停滞不前的优化过程。这个实践旨在强调在计算化学中明智选择坐标系的重要性 [@problem_id:2452028]。", "problem": "在计算化学中，几何优化通常使用通过 Z-矩阵定义的内坐标。在 Z-矩阵中，除了最初的几个原子外，每个原子的位置都是通过指定其与第一个锚定原子的键长、与第二个锚定原子的键角以及与第三个锚定原子的二面角来确定的。考虑一个简单的原子链 $A$–$B$–$C$–$D$，在其初始结构中，角 $\\angle ABC$ 为 $179.5^\\circ$，且原子 $A$、$B$ 和 $C$ 几乎共线。现考虑两种 Z-矩阵定义来放置原子 $D$：\n- Z-定义 $\\mathcal{Z}_1$：原子 $D$ 由其与 $C$ 的键、在 $B$ 处的键角（即 $\\angle DCB$）以及由平面 $(A,B,C)$ 和 $(B,C,D)$ 构成的二面角来定义。\n- Z-定义 $\\mathcal{Z}_2$：原子 $D$ 由其与 $C$ 的键、在 $C$ 处的键角（即 $\\angle DCB$）以及由平面 $(X,C,B)$ 和 $(C,B,D)$ 构成的二面角来定义，其中 $X$ 是一个不在 $A$–$B$–$C$ 直线上的非共线原子（例如，$B$ 上的取代基，确保没有近共线性的情况）。\n\n假设采用标准的准牛顿几何优化，该优化使用通过坐标变换从笛卡尔量获得的内坐标梯度和黑塞矩阵，并可选用质量加权笛卡尔坐标 $\\mathbf{x}_m = M^{1/2}\\mathbf{x}$，其中 $M$ 是对角质量矩阵。基本假设如下：\n- 内坐标是笛卡尔坐标的函数，$q_i = q_i(\\mathbf{x})$，且几何更新可以在内坐标空间中进行；空间之间的变换取决于导数 $\\partial q_i/\\partial x_{a\\alpha}$，这些导数集合成一个变换矩阵。\n- 扭转角的导数涉及归一化的平面法向量；当两个定义原子变得几乎共线时，定义这些法向量的叉积的量值会变得非常小。\n\n下列哪一陈述正确描述了 Z-矩阵中锚定原子的不当选择如何导致几何优化中的数值不稳定性和收敛緩慢？\n\nA. 如果一个二面角是使用一个近乎线性的内角（例如 $\\angle ABC \\approx 180^\\circ$）来定义的，那么平面法向量的归一化会在内坐标到笛卡尔坐标的导数中引入与 $1/\\sin\\theta$ 成正比的因子，从而使变换成为病态的；这会导致微小的内坐标步长对应于不成比例的巨大笛卡尔位移（反之亦然），从而破坏线性搜索或信赖域步长的稳定性，并减慢收敛速度。\n\nB. 选择锚定原子以最小化内坐标总数总是能提高数值稳定性，即使这会强制使用几乎共线的原子三元组来定义角度和二面角。\n\nC. 使用质量加权笛卡尔坐标 $\\mathbf{x}_m = M^{1/2}\\mathbf{x}$ 可消除因锚定原子选择不当而引起的不稳定性，因为它能正则化坐标变换并消除几何奇异点。\n\nD. 选择几乎共线或共面的锚定原子会降低内坐标变换的秩或有效秩，从而恶化内坐标黑塞矩阵和梯度变换的条件数，这会减慢準牛顿法的收敛速度。\n\nE. 不当的锚定原子选择会使名义上的局部内坐标产生长程耦合（例如，沿着几乎共线的路径），从而改变一个二面角会拖动许多原子；信赖域或线性搜索的保护机制随后会强制采用非常小的步长以防止几何结构「爆炸」（blow-ups），即使笛卡尔梯度适中，也会导致收敛缓慢。\n\n选择所有适用选项。", "solution": "首先必须验证问题陈述的科学合理性、清晰性和完整性。\n\n**步骤 1：提取已知条件**\n- **系统**：原子链 $A$–$B$–$C$–$D$。\n- **初始几何**：角 $\\angle ABC$ 为 $179.5^\\circ$，表示原子 $A$、$B$ 和 $C$ 近乎共线。\n- **原子 $D$ 的 Z-矩阵定义**：\n    - $\\mathcal{Z}_1$：与 $C$ 的键，角 $\\angle DCB$，基于平面 $(A,B,C)$ 和 $(B,C,D)$ 的二面角。\n    - $\\mathcal{Z}_2$：与 $C$ 的键，角 $\\angle DCB$，基于平面 $(X,C,B)$ 和 $(C,B,D)$ 的二面角，其中 $X$ 是一个合适的外部原子。\n- **方法**：在内坐标中进行准牛顿几何优化。梯度和黑塞矩阵从笛卡尔空间变换而来。\n- **坐标系统**：笛卡尔（$\\mathbf{x}$）、内（$q_i$）和质量加权笛卡尔（$\\mathbf{x}_m = M^{1/2}\\mathbf{x}$）。\n- **关键原理**：\n    1. 内坐标是笛卡尔坐标的函数：$q_i = q_i(\\mathbf{x})$。\n    2. 坐标系统之间的变换取决于导数矩阵 $\\partial q_i / \\partial x_{a\\alpha}$（Wilson B-矩阵）。\n    3. 二面角的导数涉及归一化的平面法向量。\n    4. 用于定义平面的原子近乎共线，会导致平面法向量的叉积量值很小。\n- **问题**：辨识哪些陈述正确描述了锚定原子的不当选择（如 $\\mathcal{Z}_1$ 中）如何导致数值不稳定性和收敛缓慢。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学基础**：该问题基于计算化学的基本且公认的原理，特别是分子几何优化和坐标变换的理论。由定义不当的内坐标（例如，涉及近乎线性原子的二面角）引起的数值不稳定性问题是该领域中一个经典且关键的课题。所提供的信息在事实上是正确的，并且在科学上是合理的。\n- **适定性（Well-Posedness）**：该问题提供了一个清晰的情景，并要求基于此情景评估几个陈述。该情景是具体的，旨在探讨一个已知的计算问题。根据既定理论，可以确定一组唯一的正确和不正确的陈述。\n- **客观性**：问题以精确的技术语言表述，没有主观性或含糊不清之处。\n\n**步骤 3：结论与行动**\n该问题在科学上是合理的、适定的且客观的。这是一个有效的问题。我将继续进行详细的解答。\n\n---\n\n核心问题在于二面角的定义及其相对于笛卡尔坐标的导数计算。对于原子序列 $1-2-3-4$，二面角 $\\tau$ 是包含原子 $(1,2,3)$ 的平面与包含原子 $(2,3,4)$ 的平面之间的夹角。设原子的位置向量为 $\\mathbf{r}_1, \\mathbf{r}_2, \\mathbf{r}_3, \\mathbf{r}_4$。\n\n第一个平面的法向量为 $\\mathbf{n}_{123} = (\\mathbf{r}_2 - \\mathbf{r}_1) \\times (\\mathbf{r}_3 - \\mathbf{r}_2)$。其量值为 $|\\mathbf{n}_{123}| = |\\mathbf{r}_2 - \\mathbf{r}_1||\\mathbf{r}_3 - \\mathbf{r}_2|\\sin(\\theta_{123})$，其中 $\\theta_{123}$ 是角 $\\angle 123$。\n\n在问题中，Z-定义 $\\mathcal{Z}_1$ 使用原子 $A, B, C$ 来定义原子 $D$ 的二面角。相关的角度是 $\\theta_{ABC} = \\angle ABC \\approx 180^\\circ$。因此，$\\sin(\\theta_{ABC}) \\approx 0$，这意味着平面 $(A,B,C)$ 的法向量几乎是一个零向量。从几何上看，由三个近乎共线的点定义的平面是定义不善的（ill-defined）。原子位置的任何无穷小变化都可能导致其方向剧烈波动。\n\n从笛卡尔坐标 $\\mathbf{x}$ 到内坐标 $\\mathbf{q}$ 的变换由 Wilson B-矩阵决定，其元素为 $B_{ik} = \\partial q_i / \\partial x_k$。二面角相对于笛卡尔坐标的导数包含与定义平面法向量量值成反比的项。对于 $\\mathcal{Z}_1$ 中的二面角，这意味着其导数将包含与 $1/|\\mathbf{n}_{ABC}| \\propto 1/\\sin(\\theta_{ABC})$ 成正比的项。当 $\\theta_{ABC} \\to 180^\\circ$ 时，这些导数项会发散。\n\n这会导致一个病态的 B-矩阵。在优化过程中，通常在内坐标中计算一个步长 $\\Delta\\mathbf{q}$，然后将其转换为笛卡尔坐标中的步长 $\\Delta\\mathbf{x}$。这种逆变换涉及 B-矩陣的广义逆。病态的 B-矩陣使得这种变换在数值上不稳定，从而导致选项中所述的问题。\n\n**逐项分析**\n\n**A. 如果一个二面角是使用一个近乎线性的内角（例如 $\\angle ABC \\approx 180^\\circ$）来定义的，那么平面法向量的归一化会在内坐标到笛卡尔坐标的导数中引入与 $1/\\sin\\theta$ 成正比的因子，从而使变换成为病态的；这会导致微小的内坐标步长对应于不成比例的巨大笛卡尔位移（反之亦然），从而破坏线性搜索或信赖域步长的稳定性，并减慢收敛速度。**\n该陈述对潜在的数学问题给出了精确而准确的描述。二面角相对于笛卡尔坐标的导数中的因子 $1/|\\mathbf{n}_{ABC}|$ 确实与 $1/\\sin(\\angle ABC)$ 成正比。当 $\\angle ABC \\to 180^\\circ$ 时，该因子发散，导致 B-矩阵的某些元素变得极大。这使得变换矩阵成为病态的，意味着其求逆（或伪逆）在数值上不稳定。一个病态的映射会导致在内坐标空间中提出的一个小的、行为良好的优化步长，在笛卡尔空间中变成一个巨大的、不符合物理规律的步长。使用线性搜索或信赖域的优化算法会检测到这种步长引起的巨大能量增加，并被迫采取极小的步长，从而导致收敛非常缓慢。该陈述是正确的。\n**对 A 的结论：正确。**\n\n**B. 选择锚定原子以最小化内坐标总数总是能提高数值稳定性，即使这会强制使用几乎共线的原子三元组来定义角度和二面角。**\n这个陈述有根本性的错误。对于一个有 $N$ 个原子的非线性分子，内坐标的数量是固定的 $3N-6$。对于线性分子，则是 $3N-5$。在 Z-矩阵中选择锚定原子不会改变这个数量；它只定义了这些坐标代表什么（哪些键、角和二面角）。选择锚定原子时的主要目标是确保坐标系统的数值稳定性。强制使用近乎共线的原子三元组是造成数值不稳定性的典型*不良*选择。良好的实践要求人们应尽力*避免*此类定义，例如像定义 $\\mathcal{Z}_2$ 所暗示的那样，使用虚拟原子或明智地选择非局部锚定原子。该陈述的主张与事实恰恰相反。\n**对 B 的结论：不正确。**\n\n**C. 使用质量加权笛卡尔坐标 $\\mathbf{x}_m = M^{1/2}\\mathbf{x}$ 可消除因锚定原子选择不当而引起的不稳定性，因为它能正则化坐标变换并消除几何奇异点。**\n质量加权坐标是通过将每个笛卡尔坐标分量乘以相应原子质量的平方根来进行变换的。内坐标 $q_i$ 是几何结构的函数，即笛卡尔坐标 $\\mathbf{x}$ 的函数，而不是质量的函数。所讨论的奇异点是纯粹几何性的：无论这些点上附加了什么质量的原子，用三个共线点定义平面的做法都会失败。从数学上讲，导数 $\\partial q_i / \\partial x_k$ 因几何原因而发散。在质量加权坐标中的导数通过链式法则相关联：$\\partial q_i / \\partial x_{m,k} = (\\partial q_i / \\partial x_k) \\cdot m_k^{-1/2}$。这种乘以常数因子 $m_k^{-1/2}$ 的缩放操作无法消除 $\\partial q_i / \\partial x_k$ 的发散。不稳定性依然存在。质量加权对于动力学和振动分析很有用，但它不能修复内坐标定义中的奇异点。\n**对 C 的结论：不正确。**\n\n**D. 选择几乎共线或共面的锚定原子会降低内坐标变换的秩或有效秩，从而恶化内坐标黑塞矩阵和梯度变换的条件数，这会减慢准牛顿法的收敛速度。**\n该陈述从线性代数的角度提供了正确的分析。B-矩阵将笛卡尔坐标的变化映射到内坐标的变化。当二面角因近共线性而定义不善时，B-矩阵中对应的行在数值上会出现问题（元素非常大）。这意味着该内坐标与其他坐标并非良好独立，或者其定义不稳定。这导致对变换至关重要的矩阵乘积 $\\mathbf{G} = \\mathbf{B}\\mathbf{B}^T$ 变得近乎奇异。一个近乎奇异的矩阵有一个或多个非常小的特征值，这意着它有非常高的条件数（最大特征值与最小特征值之比），并且其有效秩降低。准牛顿法所需的梯度和黑塞矩陣的变换依赖于 $\\mathbf{G}$ 的逆。$\\mathbf{G}$ 的高条件数使其逆矩陣在数值上不稳定，这会破坏计算出的优化步长 $\\Delta\\mathbf{q}$ 並減慢收敛。该陈述是对问题的正确而深刻的描述。\n**对 D 的结论：正确。**\n\n**E. 不当的锚定原子选择会使名义上的局部内坐标产生长程耦合（例如，沿着几乎共线的路径），从而改变一个二面角会拖动许多原子；信赖域或线性搜索的保护机制随后会强制采用非常小的步长以防止几何结构「爆炸」（blow-ups），即使笛卡尔梯度适中，也会导致收敛缓慢。**\n该陈述准确地描述了数值不稳定性的物理表现。在一个行为良好的 Z-矩阵中，改变单一内坐标（如键长或角度）只会导致分子几何结构的局部变化。然而，如果像 $\\mathcal{Z}_1$ 那样选择了不当的锚定原子，定义不善的二面角 $\\tau_{ABCD}$ 的微小变化可能导致原子 $D$ 绕 $B-C$ 轴发生非常大的旋转。如果其他原子是相对于 $D$ 定义的（例如，在原子链 $A-B-C-D-E-\\dots$ 中），$D$ 的这种大尺度运动将会拖动其后的所有原子。这在一个本应是局部的内坐标与许多可能距离很远的原子位置之间，产生了一种强烈的人为耦合。试图在该内坐标上走一小步的优化算法，将会产生一个巨大的、高能量的笛卡尔几何扭曲。算法的保护机制（信赖半径或线性搜索）会正确地将此步识别为灾难性的，并将步长减小到极小的值。这导致朝向最小值的进展极其缓慢，即使原子上的力並不是特別大。\n**对 E 的结论：正确。**", "answer": "$$\\boxed{ADE}$$", "id": "2452028"}]}