{"hands_on_practices": [{"introduction": "这第一个练习将探索矩阵求幂最直接、最基本的应用：在图中计算路径数量。我们将利用一个基本原理：邻接矩阵 $A$ 的 $k$ 次幂中位于 $(i,j)$ 位置的元素 $(A^k)_{ij}$，给出了从顶点 $i$ 到顶点 $j$ 长度为 $k$ 的路径（允许重复经过顶点和边）的数量。这个问题增加了一个实际的约束——避开一条特定的边——你将学会通过简单地修改邻接矩阵来处理这种情况，这展示了该模型的灵活性。 [@problem_id:3249456]", "problem": "考虑一个有限有向图 $G$，其顶点集为 $V=\\{1,2,3\\}$，边集为 $E=\\{(1,2),(1,3),(2,1),(2,3),(3,1),(3,2)\\}$。设 $A$ 是图 $G$ 的邻接矩阵，按顶点顺序 $(1,2,3)$ 索引，因此\n$$\nA=\\begin{pmatrix}\n0  1  1 \\\\\n1  0  1 \\\\\n1  1  0\n\\end{pmatrix} .\n$$\n要求你计算长度固定且不经过某条特定有向边的有向路径（可能重复访问顶点和边）的数量。形式化地，定义禁止边 $e=(3,2)$，源顶点 $u=1$，目标顶点 $v=2$，以及长度参数 $k=5$。请仅使用有向图邻接矩阵的基本定义，并基于数据结构和算法的第一性原理进行推理，确定从顶点 $u$ 到顶点 $v$ 的长度恰好为 $k$ 且不使用边 $e$ 的有向路径的确切数量。请以单个整数形式给出你的最终答案。无需四舍五入。", "solution": "问题要求计算在一个给定的有向图中，两个顶点之间特定长度的有向路径的数量，并附带一个约束条件，即不得使用某条特定的边。\n\n设 $G=(V, E)$ 是一个有 $n$ 个顶点的有向图，设 $A$ 是其邻接矩阵，其中如果存在从顶点 $i$ 到顶点 $j$ 的边，则 $A_{ij} = 1$，否则 $A_{ij} = 0$。图论中的一个基本原理指出，从源顶点 $u$ 到目标顶点 $v$ 的长度为 $k$ 的不同路径的数量由矩阵 $A^k$ 的第 $(u,v)$ 个元素给出。\n\n该原理可以通过对路径长度 $k$ 进行数学归纳来证明。\n- **归纳基础 (k=1):** 从 $u$ 到 $v$ 的长度为 1 的路径数就是从 $u$ 到 $v$ 的边数，这正是邻接矩阵 $A_{uv}$ 的定义。因此 $(A^1)_{uv} = A_{uv}$，原理成立。\n- **归纳步骤:** 假设原理对长度 $m$ 成立。一条从 $u$ 到 $v$ 的长度为 $m+1$ 的路径，可以看作是从 $u$ 到某个中间顶点 $p$ 的一条长度为 $m$ 的路径，后跟一条从 $p$ 到 $v$ 的边。对所有可能的中间顶点 $p$ 求和，从 $u$ 到 $v$ 的长度为 $m+1$ 的路径总数是 $\\sum_{p \\in V} (\\text{长为}m\\text{的u-p路径数}) \\times (\\text{长为}1\\text{的p-v路径数})$。根据归纳假设，这等于 $\\sum_{p=1}^{n} (A^m)_{up} \\cdot A_{pv}$。根据矩阵乘法的定义，这个和正是矩阵乘积 $A^m \\cdot A = A^{m+1}$ 的第 $(u,v)$ 个元素。因此，该原理对所有整数 $k \\ge 1$ 成立。\n\n本问题要求不使用禁止边 $e=(3,2)$。这等价于在一个移除了边 $e$ 的修改后的图 $G'$ 中计数路径。这个新图的邻接矩阵（记为 $A'$）与原矩阵 $A$ 相同，只是对应于禁止边的元素被设为 $0$。\n\n给定的邻接矩阵是：\n$$\nA = \\begin{pmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  1  0 \\end{pmatrix}\n$$\n顶点按顺序 $(1, 2, 3)$ 索引。禁止边 $e=(3,2)$ 对应于第 $3$ 行第 $2$ 列的元素。因此，我们通过将此元素设为 $0$ 来构造矩阵 $A'$：\n$$\nA' = \\begin{pmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  0  0 \\end{pmatrix}\n$$\n问题指定了源顶点 $u=1$，目标顶点 $v=2$，以及路径长度 $k=5$。根据已建立的原理，我们需要计算矩阵 $(A')^5$ 的第 $(1,2)$ 个元素。\n\n我们可以通过平方求幂来高效地计算 $A'^5 = A'^4 \\cdot A' = (A'^2)^2 \\cdot A'$。\n首先，计算 $A'^2$：\n$$\nA'^2 = A' \\cdot A' = \\begin{pmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  0  0 \\end{pmatrix} \\begin{pmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  0  0 \\end{pmatrix} = \\begin{pmatrix} 2  0  1 \\\\ 1  1  1 \\\\ 0  1  1 \\end{pmatrix}\n$$\n接着，计算 $A'^4$：\n$$\nA'^4 = A'^2 \\cdot A'^2 = \\begin{pmatrix} 2  0  1 \\\\ 1  1  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 2  0  1 \\\\ 1  1  1 \\\\ 0  1  1 \\end{pmatrix} = \\begin{pmatrix} 4  1  3 \\\\ 3  2  3 \\\\ 1  2  2 \\end{pmatrix}\n$$\n最后，计算 $A'^5$：\n$$\nA'^5 = A'^4 \\cdot A' = \\begin{pmatrix} 4  1  3 \\\\ 3  2  3 \\\\ 1  2  2 \\end{pmatrix} \\begin{pmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  0  0 \\end{pmatrix} = \\begin{pmatrix} 4  4  5 \\\\ 5  3  5 \\\\ 4  1  3 \\end{pmatrix}\n$$\n从顶点 $u=1$ 到顶点 $v=2$ 的长度为 $k=5$ 且不使用边 $(3,2)$ 的有向路径的数量是矩阵 $A'^5$ 的第 $(1,2)$ 个元素。\n$$\n((A')^5)_{12} = 4\n$$\n因此，恰好有 $4$ 条这样的路径。", "answer": "$$\n\\boxed{4}\n$$", "id": "3249456"}, {"introduction": "在图论应用之后，我们现在来解决矩阵求幂的另一个主要应用领域：求解线性递推关系。许多组合计数问题，例如这个经典的爬楼梯谜题，都可以归结为一个递推关系。本练习将指导你如何为给定的递推关系构建状态转移矩阵，然后使用矩阵求幂来高效地计算序列中某个遥远的特定项，而这对于简单的迭代方法来说计算成本会非常高。 [@problem_id:3249460]", "problem": "一个楼梯有 $n$ 级台阶。你可以通过大小属于集合 $S = \\{1, 2, 5\\}$ 的步子来爬这个楼梯。令 $W(n)$ 表示步子大小之和恰好为 $n$ 的不同有序步子序列（顺序很重要）的数量。假设 $W(0) = 1$（空序列算作一种方式），并且对于所有 $k  0$，有 $W(k) = 0$。从组合分解的第一性原理和线性递推的移位寄存器表示出发，推导出 $W(n)$ 的线性递推关系，将其转换为适用于快速幂运算的矩阵形式，并使用此框架确定 $W(25)$。将最终答案表示为一个整数。不需要四舍五入。", "solution": "该问题要求计算爬楼梯的不同方式数量，步长限制在一个特定的集合中。这是一个经典的组合问题，可以通过线性递推关系解决。\n\n**步骤 1：推导递推关系**\n设 $W(n)$ 为爬 $n$ 级台阶的方法数。要到达第 $n$ 级台阶，最后一步必须是大小为 1、2 或 5 的步子。\n- 如果最后一步大小为 1，则之前必定在第 $n-1$ 级台阶，有 $W(n-1)$ 种方法。\n- 如果最后一步大小为 2，则之前必定在第 $n-2$ 级台阶，有 $W(n-2)$ 种方法。\n- 如果最后一步大小为 5，则之前必定在第 $n-5$ 级台阶，有 $W(n-5)$ 种方法。\n\n由于这三种情况互斥，到达第 $n$ 级台阶的总方法数是这三种情况之和。因此，我们得到线性递推关系：\n$$W(n) = W(n-1) + W(n-2) + W(n-5)$$\n该递推关系的阶数为 5。初始条件为 $W(0)=1$，且对于 $k  0$，有 $W(k)=0$。\n\n**步骤 2：构建矩阵表示**\n为了使用矩阵指数法，我们需要将这个递推关系转化为 $V_{n+1} = M V_{n}$ 的形式。由于递推的阶数是 5，我们需要一个包含 5 个连续项的状态向量。定义状态向量 $V_n$ 如下：\n$$\nV_n = \\begin{pmatrix} W(n) \\\\ W(n-1) \\\\ W(n-2) \\\\ W(n-3) \\\\ W(n-4) \\end{pmatrix}\n$$\n那么，下一个状态向量 $V_{n+1}$ 可以通过 $V_n$ 的分量表示：\n$$\nV_{n+1} = \\begin{pmatrix} W(n+1) \\\\ W(n) \\\\ W(n-1) \\\\ W(n-2) \\\\ W(n-3) \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot W(n) + 1 \\cdot W(n-1) + 0 \\cdot W(n-2) + 0 \\cdot W(n-3) + 1 \\cdot W(n-4) \\\\ 1 \\cdot W(n) \\\\ 1 \\cdot W(n-1) \\\\ 1 \\cdot W(n-2) \\\\ 1 \\cdot W(n-3) \\end{pmatrix}\n$$\n这可以表示为矩阵乘法 $V_{n+1} = M V_n$，其中转移矩阵 $M$ 是：\n$$\nM = \\begin{pmatrix}\n1  1  0  0  1 \\\\\n1  0  0  0  0 \\\\\n0  1  0  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  0  1  0\n\\end{pmatrix}\n$$\n\n**步骤 3：计算初始值和最终值**\n通过迭代应用递推关系，我们可以得到序列的初始值：\n- $W(0) = 1$\n- $W(1) = W(0) = 1$\n- $W(2) = W(1) + W(0) = 1 + 1 = 2$\n- $W(3) = W(2) + W(1) = 2 + 1 = 3$\n- $W(4) = W(3) + W(2) = 3 + 2 = 5$\n\n我们可以构建一个初始状态向量，例如 $V_4$：\n$$\nV_4 = \\begin{pmatrix} W(4) \\\\ W(3) \\\\ W(2) \\\\ W(1) \\\\ W(0) \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 3 \\\\ 2 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n我们想要计算 $W(25)$，它是向量 $V_{25}$ 的第一个元素。根据矩阵关系，我们有：\n$$ V_{25} = M^{25-4} V_4 = M^{21} V_4 $$\n计算矩阵 $M$ 的 21 次幂是一项繁重的任务，但可以通过平方求幂（二进制取幂）在 $O(\\log 21)$ 次矩阵乘法内高效完成。\n执行此计算（例如，使用数值计算软件以确保准确性），我们得到矩阵 $M^{21}$。然后，我们将 $M^{21}$ 与初始向量 $V_4$ 相乘：\n$$ V_{25} = M^{21} V_4 $$\n最终得到的向量 $V_{25}$ 的第一个元素就是 $W(25)$。计算结果为：\n$$ W(25) = 382396 $$\n因此，爬 25 级台阶共有 382396 种不同的方法。", "answer": "$$\\boxed{382396}$$", "id": "3249460"}, {"introduction": "这最后一个练习展示了矩阵求幂技术在不同代数设置下的卓越通用性。我们将不再使用标准的整数算术，而是在有限域 $\\text{GF}(2)$ 上进行运算，这等同于所有计算都对 $2$ 取模。这使我们能够回答关于奇偶性的问题，例如判断两个节点之间的路径数量是奇数还是偶数，这个问题揭示了在有限域上处理矩阵时经常出现的周期性这一强大概念。 [@problem_id:3249427]", "problem": "设 $A$ 是一个节点为 $\\{1,2\\}$ 的有向图的邻接矩阵，由下式给出：\n$$\nA = \\begin{pmatrix}\n1  1\\\\\n1  0\n\\end{pmatrix} .\n$$\n根据定义，对于任意非负整数 $k$，当算术运算在整数上进行时，$A^{k}$ 的 $(i,j)$ 元等于从节点 $i$ 到节点 $j$ 的长度为 $k$ 的路径（允许重复顶点和边）的数量。我们关心的是这个计数的奇偶性，它等于 $A^{k}$ 的 $(i,j)$ 元模 $2$ 的结果。\n\n仅使用矩阵乘法和幂运算的定义，确定当 $k = 2024$ 时，从节点 $1$ 到节点 $2$ 的长度为 $k$ 的路径数量的奇偶性（即在 $\\{0,1\\}$ 中的值）。将你的最终答案表示为 $\\{0,1\\}$ 中的一个整数。不要求也不允许四舍五入。所有与奇偶性相关的算术运算都必须在伽罗瓦域 (GF(2)) 内进行模 $2$ 运算。", "solution": "问题要求确定在由邻接矩阵 $A$ 定义的有向图中，从节点 $1$ 到节点 $2$ 的长度为 $k=2024$ 的路径数量的奇偶性。用于确定奇偶性的算术运算被指定为模 $2$ 运算，这对应于在伽罗瓦域 $\\text{GF}(2)$（也记作 $\\mathbb{F}_2$）中的计算。\n\n首先，我们建立该问题的数学表述。从节点 $i$ 到节点 $j$ 的长度为 $k$ 的路径数量由矩阵 $A^k$ 的 $(i,j)$ 元给出。我们被要求求这个数的奇偶性，这等价于求该元素模 $2$ 的值。这在数学上等价于计算矩阵的幂 $A^k$，其中所有的算术运算（加法和乘法）都在 $\\mathbb{F}_2$ 中进行。\n\n设 $\\bar{A}$ 是矩阵 $A$，其元素被视为 $\\mathbb{F}_2 = \\{0, 1\\}$ 中的元素。\n给定的矩阵是：\n$$\nA = \\begin{pmatrix}\n1  1\\\\\n1  0\n\\end{pmatrix}\n$$\n由于 $A$ 的所有元素都已在 $\\{0, 1\\}$ 中，因此在 $\\mathbb{F}_2$ 上的矩阵 $\\bar{A}$ 在表示上是相同的：\n$$\n\\bar{A} = \\begin{pmatrix}\n1  1\\\\\n1  0\n\\end{pmatrix}\n$$\n问题是要求出矩阵 $\\bar{A}^{2024}$ 的 $(1,2)$ 元。我们通过使用在 $\\mathbb{F}_2$ 上的矩阵乘法和幂运算的定义来求解。让我们计算 $\\bar{A}$ 的前几个幂次。\n\n$\\bar{A}$ 的平方是：\n$$\n\\bar{A}^2 = \\bar{A} \\cdot \\bar{A} = \\begin{pmatrix}\n1  1\\\\\n1  0\n\\end{pmatrix}\n\\begin{pmatrix}\n1  1\\\\\n1  0\n\\end{pmatrix} = \\begin{pmatrix}\n1 \\cdot 1 + 1 \\cdot 1   1 \\cdot 1 + 1 \\cdot 0 \\\\\n1 \\cdot 1 + 0 \\cdot 1   1 \\cdot 1 + 0 \\cdot 0\n\\end{pmatrix}\n$$\n进行模 $2$ 算术运算：\n$$\n\\bar{A}^2 = \\begin{pmatrix}\n1 + 1   1 + 0 \\\\\n1 + 0   1 + 0\n\\end{pmatrix} \\pmod 2 = \\begin{pmatrix}\n0   1 \\\\\n1   1\n\\end{pmatrix}\n$$\n接下来，我们计算 $\\bar{A}$ 的立方：\n$$\n\\bar{A}^3 = \\bar{A}^2 \\cdot \\bar{A} = \\begin{pmatrix}\n0  1 \\\\\n1  1\n\\end{pmatrix}\n\\begin{pmatrix}\n1  1\\\\\n1  0\n\\end{pmatrix} = \\begin{pmatrix}\n0 \\cdot 1 + 1 \\cdot 1   0 \\cdot 1 + 1 \\cdot 0 \\\\\n1 \\cdot 1 + 1 \\cdot 1   1 \\cdot 1 + 1 \\cdot 0\n\\end{pmatrix}\n$$\n进行模 $2$ 算术运算：\n$$\n\\bar{A}^3 = \\begin{pmatrix}\n0 + 1   0 + 0 \\\\\n1 + 1   1 + 0\n\\end{pmatrix} \\pmod 2 = \\begin{pmatrix}\n1   0 \\\\\n0   1\n\\end{pmatrix} = I\n$$\n其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n\n$\\bar{A}^3 = I$ 这个事实意味着 $\\bar{A}$ 的幂次序列是周期性的。对于任何整数 $n \\ge 1$，我们有 $\\bar{A}^{n+3} = \\bar{A}^n \\cdot \\bar{A}^3 = \\bar{A}^n \\cdot I = \\bar{A}^n$。矩阵序列 $(\\bar{A}^k)_{k \\ge 1}$ 是周期性的，周期为 $3$。\n\n为了计算 $\\bar{A}^{2024}$，我们可以通过求指数 $2024$ 除以 $3$ 的余数来利用这个周期性。\n$$\n2024 \\div 3 = 674 \\text{ 余 } 2\n$$\n因此，我们有 $2024 \\equiv 2 \\pmod 3$。\n\n这使我们能够简化幂运算：\n$$\n\\bar{A}^{2024} = \\bar{A}^{3 \\cdot 674 + 2} = (\\bar{A}^3)^{674} \\cdot \\bar{A}^2\n$$\n代入 $\\bar{A}^3 = I$：\n$$\n\\bar{A}^{2024} = (I)^{674} \\cdot \\bar{A}^2 = I \\cdot \\bar{A}^2 = \\bar{A}^2\n$$\n问题因此简化为求 $\\bar{A}^2$ 的 $(1,2)$ 元。根据我们之前的计算：\n$$\n\\bar{A}^2 = \\begin{pmatrix}\n0  1 \\\\\n1  1\n\\end{pmatrix}\n$$\n第一行第二列的元素 $(\\bar{A}^2)_{1,2}$ 是 $1$。\n\n因此，从节点 $1$ 到节点 $2$ 的长度为 $2024$ 的路径数量的奇偶性是奇数，这对应于在 $\\mathbb{F}_2$ 中的值 $1$。", "answer": "$$\\boxed{1}$$", "id": "3249427"}]}