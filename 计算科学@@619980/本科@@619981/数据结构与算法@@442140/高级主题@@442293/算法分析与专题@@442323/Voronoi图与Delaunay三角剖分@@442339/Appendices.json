{"hands_on_practices": [{"introduction": "沃罗诺伊图最基本的构成元素是其顶点，每个顶点都与平面上的三个生成点保持等距。这个练习将引导你通过解析几何的基本原理，亲手计算出这样一个顶点的位置，从而将抽象的几何定义与具体的坐标运算联系起来。通过解决这个问题，你将掌握构建沃罗诺伊图的核心技能之一。[@problem_id:2175770]", "problem": "在计算天体物理学中，沃罗诺伊图（Voronoi diagram）被用来模拟天体周围的影响区域。一位天文学家正在分析一个新勘测的太空区域，并确定了三颗不同的、不共线的脉冲星：PSR-A、PSR-B 和 PSR-C。在一个单位为光年的二维笛卡尔坐标图上，这些脉冲星的位置分别为 $P_A = (1, 7)$、$P_B = (9, 1)$ 和 $P_C = (-3, -3)$。\n\n一个理论模型表明，在该平面中存在一个与这三颗脉冲星等距的唯一驻点。这个点在几何上具有重要意义，因为它代表了由这三个生成点定义的唯一沃罗诺伊顶点。确定这个点的位置对于校准一种新型引力波探测器至关重要。\n\n确定这个沃罗诺伊顶点的坐标 $(x_V, y_V)$。", "solution": "沃罗诺伊顶点是与给定的三个点 $P_A = (1, 7)$、$P_B = (9, 1)$ 和 $P_C = (-3, -3)$ 等距的点 $(x_V, y_V)$。这个点是由 $P_A$、$P_B$ 和 $P_C$ 构成的三角形的外心。外心可以通过求解三角形各边垂直平分线的交点来找到。我们只需要求出其中两条垂直平分线的方程，然后解所得的线性方程组。\n\n让我们来求线段 $P_A P_B$ 的垂直平分线方程。\n首先，我们求出连接 $P_A$ 和 $P_B$ 的线段的中点 $M_{AB}$：\n$$\nM_{AB} = \\left( \\frac{x_A + x_B}{2}, \\frac{y_A + y_B}{2} \\right) = \\left( \\frac{1 + 9}{2}, \\frac{7 + 1}{2} \\right) = (5, 4)\n$$\n接下来，我们确定线段 $P_A P_B$ 的斜率 $m_{AB}$：\n$$\nm_{AB} = \\frac{y_B - y_A}{x_B - x_A} = \\frac{1 - 7}{9 - 1} = \\frac{-6}{8} = -\\frac{3}{4}\n$$\n垂直平分线的斜率 $m_{\\perp AB}$ 是 $m_{AB}$ 的负倒数：\n$$\nm_{\\perp AB} = -\\frac{1}{m_{AB}} = -\\frac{1}{-3/4} = \\frac{4}{3}\n$$\n使用点 $M_{AB}=(5,4)$ 和斜率 $m_{\\perp AB} = 4/3$，根据线性方程的点斜式，我们得到第一条垂直平分线的方程：\n$$\ny - 4 = \\frac{4}{3}(x - 5)\n$$\n$$\ny = \\frac{4}{3}x - \\frac{20}{3} + 4 = \\frac{4}{3}x - \\frac{20}{3} + \\frac{12}{3}\n$$\n$$\ny = \\frac{4}{3}x - \\frac{8}{3}\n$$\n为了消去分数，我们可以将其写作 $3y = 4x - 8$，即 $4x - 3y = 8$。（方程1）\n\n现在，我们来求线段 $P_B P_C$ 的垂直平分线方程。\n首先，我们求出连接 $P_B = (9,1)$ 和 $P_C = (-3,-3)$ 的线段的中点 $M_{BC}$：\n$$\nM_{BC} = \\left( \\frac{x_B + x_C}{2}, \\frac{y_B + y_C}{2} \\right) = \\left( \\frac{9 + (-3)}{2}, \\frac{1 + (-3)}{2} \\right) = \\left( \\frac{6}{2}, \\frac{-2}{2} \\right) = (3, -1)\n$$\n接下来，我们确定线段 $P_B P_C$ 的斜率 $m_{BC}$：\n$$\nm_{BC} = \\frac{y_C - y_B}{x_C - x_B} = \\frac{-3 - 1}{-3 - 9} = \\frac{-4}{-12} = \\frac{1}{3}\n$$\n垂直平分线的斜率 $m_{\\perp BC}$ 是 $m_{BC}$ 的负倒数：\n$$\nm_{\\perp BC} = -\\frac{1}{m_{BC}} = -\\frac{1}{1/3} = -3\n$$\n使用点 $M_{BC}=(3,-1)$ 和斜率 $m_{\\perp BC} = -3$，根据点斜式，我们得到第二条垂直平分线的方程：\n$$\ny - (-1) = -3(x - 3)\n$$\n$$\ny + 1 = -3x + 9\n$$\n$$\ny = -3x + 8\n$$\n（方程2）\n\n最后，我们通过解由以下两个线性方程组成的方程组来求交点 $(x_V, y_V)$：\n1. $4x - 3y = 8$\n2. $y = -3x + 8$\n\n将方程2代入方程1：\n$$\n4x - 3(-3x + 8) = 8\n$$\n$$\n4x + 9x - 24 = 8\n$$\n$$\n13x = 32\n$$\n$$\nx_V = \\frac{32}{13}\n$$\n现在将 $x_V$ 的值代回方程2以求出 $y_V$：\n$$\ny_V = -3\\left(\\frac{32}{13}\\right) + 8 = -\\frac{96}{13} + \\frac{8 \\cdot 13}{13} = -\\frac{96}{13} + \\frac{104}{13} = \\frac{8}{13}\n$$\n因此，沃罗诺伊顶点的坐标是 $\\left(\\frac{32}{13}, \\frac{8}{13}\\right)$。", "answer": "$$\\boxed{\\left(\\frac{32}{13}, \\frac{8}{13}\\right)}$$", "id": "2175770"}, {"introduction": "在理解了单个顶点的计算之后，下一个自然的步骤是探究多个顶点和边如何共同构成一个完整的沃罗诺伊图。本题利用一个高度对称的点集布局，这使得整个图的结构变得直观易懂，让你能更专注于识别图的有限与无限边界，并精确计算其几何属性。这个问题是连接单个几何元素与完整空间划分结构的重要桥梁。[@problem_id:2175743]", "problem": "一家科技公司正在为一片广阔、平坦的开放区域设计一个新的无线通信网络。该网络由五个大功率发射塔组成。其中四个塔（我们称之为“角塔”）被放置在一个边长为 $D$ 的正方形的顶点上。第五个塔（“中心塔”）被精确地放置在该正方形的几何中心。\n\n根据设计协议，任何给定塔的服务区域是平面中所有离该塔比离任何其他塔更近的点的集合。这种基于到一组点的邻近度来划分平面的方法生成了一种称为“沃罗诺伊图”（Voronoi diagram）的结构。分隔不同服务区域的边界被称为沃罗诺伊图的边。\n\n对于这种特定的五塔配置，一些沃罗诺伊图的边是有限长度的线段，而另一些是无限延伸的射线。你的任务是计算沃罗诺伊图中所有*有限*边的总长度。请用一个关于 $D$ 的解析表达式来表示你的最终答案。", "solution": "设置坐标，使得正方形的顶点位于 $P_{1}=(a,a)$、$P_{2}=(-a,a)$、$P_{3}=(-a,-a)$、$P_{4}=(a,-a)$，其中 $a=\\frac{D}{2}$，中心塔位于 $O=(0,0)$。\n\n对于每个角点 $P$，$O$ 和 $P$ 之间的沃罗诺伊边界是线段 $OP$ 的垂直平分线，即到 $O$ 和 $P$ 等距离的点的轨迹。将此条件明确写出：\n- 对于 $P_{1}=(a,a)$: $x^{2}+y^{2}=(x-a)^{2}+(y-a)^{2}\\implies x+y=a$。\n- 对于 $P_{2}=(-a,a)$: $x^{2}+y^{2}=(x+a)^{2}+(y-a)^{2}\\implies x-y=-a$。\n- 对于 $P_{3}=(-a,-a)$: $x^{2}+y^{2}=(x+a)^{2}+(y+a)^{2}\\implies x+y=-a$。\n- 对于 $P_{4}=(a,-a)$: $x^{2}+y^{2}=(x-a)^{2}+(y+a)^{2}\\implies x-y=a$。\n\n$O$ 的沃罗诺伊单元是这些垂直平分线在 $O$ 这一侧的半平面的交集：\n$$\nx+y\\leq a,\\quad x-y\\geq -a,\\quad x+y\\geq -a,\\quad x-y\\leq a,\n$$\n这等价于 $\\{|x|+|y|\\leq a\\}$，它是一个顶点位于相邻边界线两两交点处的正方形（菱形）：\n- $(a,0)$ 来自 $x+y=a$ 和 $x-y=a$ 的交点，\n- $(0,a)$ 来自 $x+y=a$ 和 $x-y=-a$ 的交点，\n- $(-a,0)$ 来自 $x+y=-a$ 和 $x-y=-a$ 的交点，\n- $(0,-a)$ 来自 $x+y=-a$ 和 $x-y=a$ 的交点。\n\n因此，$O$ 的沃罗诺伊区域是一个正方形，其四条边是与四个角塔共享的有限沃罗诺伊边。每条这样的边是相应垂直平分线上位于连续顶点之间的线段。例如，在直线 $x+y=a$ 上，有限边是连接 $(a,0)$ 和 $(0,a)$ 的线段。\n\n计算一条边的长度，例如 $(a,0)$ 和 $(0,a)$ 之间的边：\n$$\n\\ell_{\\text{edge}}=\\sqrt{(a-0)^{2}+(0-a)^{2}}=a\\sqrt{2}.\n$$\n所有四条边都是全等的，所以所有有限沃罗诺伊边的总长度是\n$$\nL_{\\text{finite}}=4\\,\\ell_{\\text{edge}}=4a\\sqrt{2}.\n$$\n代入 $a=\\frac{D}{2}$ 得\n$$\nL_{\\text{finite}}=4\\left(\\frac{D}{2}\\right)\\sqrt{2}=2D\\sqrt{2}.\n$$\n\n为确认没有其他有限边出现，考虑相邻角点之间的垂直平分线。例如，$P_{1}$ 和 $P_{2}$ 的垂直平分线是 $x=0$。沿着这条线，中心点 $O$ 总是比 $P_1$ 或 $P_2$ 更近，因此这条垂直平分线不构成 $P_1$ 和 $P_2$ 之间的沃罗诺伊边界。只有位于凸包上的点对之间的垂直平分线才会产生无限边。", "answer": "$$\\boxed{2D\\sqrt{2}}$$", "id": "2175743"}, {"introduction": "现在，让我们转向沃罗诺伊图的对偶结构——德劳内三角剖分，它在网络优化和地理信息系统等领域有着广泛应用。一个三角剖分是否为“德劳内”的，取决于它是否满足关键的“空圆”特性。本练习模拟了计算几何算法中的一个核心步骤：检验一个给定的三角剖分，并判断其中一条内边是否“合法”，如果不是，就需要通过“边翻转”操作来优化网络，这让你能实际体验到构建最优三角剖分的过程。[@problem_id:2175772]", "problem": "为了监测一个偏远的生态区，部署了四个自主传感器站，分别记为 $S_1, S_2, S_3,$ 和 $S_4$。它们在二维笛卡尔平面上的位置由坐标 $S_1(0, 0)$、$S_2(8, 2)$、$S_3(6, 9)$ 和 $S_4(-2, 5)$ 给出。坐标单位为米。\n\n为了建立通信网络，这些站点最初被连接起来形成一个三角剖分。这些连接构成了四边形 $S_1S_2S_3S_4$ 的周界，外加一条内部连接 $S_1S_3$，该连接将区域划分为两个三角形：$\\triangle S_1S_2S_3$ 和 $\\triangle S_1S_3S_4$。\n\n为了实现最佳信号三角测量，网络必须满足德劳内(Delaunay)条件。如果网络中的每个三角形，其外接圆（通过其三个顶点的唯一圆）的内部不包含任何其他站点，则该三角剖分是德劳内三角剖分。对于由两个三角形共享的一条内部边，如果第四个顶点（不属于该边的顶点）位于由该边和另一个顶点组成的三角形的外接圆内部，则该条件被违反。如果一条边违反此条件，则它被认为是非德劳内边，必须“翻转”为四边形的另一条对角线以改进三角剖分。\n\n给定初始设置，以下哪个陈述正确描述了内部边 $S_1S_3$ 的状态和所需的操作？\n\nA) 边 $S_1S_3$ 是德劳内边，无需更改。\n\nB) 边 $S_1S_3$ 不是德劳内边，应通过翻转替换为边 $S_2S_4$。\n\nC) 备选边 $S_2S_4$ 将是非德劳内边，而当前边 $S_1S_3$ 是德劳内边。\n\nD) 四个站点共线，无法形成有效的三角剖分。\n\nE) 四个站点形成一个凹四边形，无法通过简单的边翻转来解决。", "solution": "给定 $S_{1}(0,0)$、$S_{2}(8,2)$、$S_{3}(6,9)$ 和 $S_{4}(-2,5)$。当前的三角剖分使用内部边 $S_{1}S_{3}$，形成三角形 $\\triangle S_{1}S_{2}S_{3}$ 和 $\\triangle S_{1}S_{3}S_{4}$。\n\n首先，验证多边形 $S_{1}S_{2}S_{3}S_{4}$ 是严格凸的（以排除选项 D 和 E，并确保有效的局部德劳内翻转测试适用）。计算连续三元组的有向面积（方向）：\n- 对于 $(S_{1},S_{2},S_{3})$，使用 $(S_{2}-S_{1}) \\times (S_{3}-S_{1})$：$(8,2) \\times (6,9)$ 得到 $8\\cdot 9 - 2\\cdot 6 = 60 > 0$。\n- 对于 $(S_{2},S_{3},S_{4})$：$(S_{3}-S_{2})=(-2,7)$，$(S_{4}-S_{2})=(-10,3)$，叉积为 $(-2)\\cdot 3 - 7\\cdot(-10) = 64 > 0$。\n- 对于 $(S_{3},S_{4},S_{1})$：$(S_{4}-S_{3})=(-8,-4)$，$(S_{1}-S_{3})=(-6,-9)$，叉积为 $(-8)\\cdot(-9) - (-4)\\cdot(-6) = 48 > 0$。\n- 对于 $(S_{4},S_{1},S_{2})$：$(S_{1}-S_{4})=(2,-5)$，$(S_{2}-S_{4})=(10,-3)$，叉积为 $2\\cdot(-3) - (-5)\\cdot 10 = 44 > 0$。\n所有四个结果均为正，因此该四边形按给定顺序是严格凸的。\n\n内部边 $S_{1}S_{3}$ 的局部德劳内条件要求每个相邻三角形的对顶点位于另一个三角形的外接圆之外。只需测试 $S_{2}$ 是否位于 $\\triangle S_{1}S_{3}S_{4}$ 的外接圆内部（或等价地，测试 $S_{4}$ 是否位于 $\\triangle S_{1}S_{2}S_{3}$ 的外接圆内部）即可。我们使用内圆测试行列式，并以逆时针顺序排列参考三角形的顶点。\n\n首先，确认 $\\triangle S_{1}S_{3}S_{4}$ 的方向是逆时针的：\n$$(S_{3}-S_{1}) \\times (S_{4}-S_{1}) = (6,9) \\times (-2,5) = 6\\cdot 5 - 9\\cdot(-2) = 48 > 0,$$\n因此 $(S_{1},S_{3},S_{4})$ 是逆时针顺序。\n\n定义 $r_{i} = x_{i}^{2} + y_{i}^{2}$。计算\n$$r_{1} = 0^{2} + 0^{2} = 0,\\quad r_{3} = 6^{2} + 9^{2} = 117,\\quad r_{4} = (-2)^{2} + 5^{2} = 29,\\quad r_{2} = 8^{2} + 2^{2} = 68.$$\n用于测试 $S_{2}$ 是否在 $\\triangle S_{1}S_{3}S_{4}$ 外接圆内部的内圆测试行列式为\n$$\\Delta = \n\\begin{vmatrix}\nx_{1}  y_{1}  r_{1}  1 \\\\\nx_{3}  y_{3}  r_{3}  1 \\\\\nx_{4}  y_{4}  r_{4}  1 \\\\\nx_{2}  y_{2}  r_{2}  1\n\\end{vmatrix}\n=\n\\begin{vmatrix}\n0  0  0  1 \\\\\n6  9  117  1 \\\\\n-2  5  29  1 \\\\\n8  2  68  1\n\\end{vmatrix}.$$\n沿第一行展开得到\n$$\\Delta = -\\begin{vmatrix}\n6  9  117 \\\\\n-2  5  29 \\\\\n8  2  68\n\\end{vmatrix}.$$\n计算该 $3\\times 3$ 行列式：\n\\begin{align*}\n\\begin{vmatrix}\n6  9  117 \\\\\n-2  5  29 \\\\\n8  2  68\n\\end{vmatrix}\n&= 6\\,(5\\cdot 68 - 29\\cdot 2) - 9\\,((-2)\\cdot 68 - 29\\cdot 8) + 117\\,((-2)\\cdot 2 - 5\\cdot 8) \\\\\n&= 6\\,(340 - 58) - 9\\,(-136 - 232) + 117\\,(-4 - 40) \\\\\n&= 6\\cdot 282 - 9\\cdot(-368) + 117\\cdot(-44) \\\\\n&= 1692 + 3312 - 5148 \\\\\n&= -144.\n\\end{align*}\n因此 $\\Delta = -(-144) = 144 > 0$。由于三角形顶点是逆时针排序且行列式为正，所以 $S_{2}$ 位于 $\\triangle S_{1}S_{3}S_{4}$ 的外接圆内部。\n\n因此，内部边 $S_{1}S_{3}$ 违反了德劳内条件，必须翻转为另一条对角线 $S_{2}S_{4}$。这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "2175772"}]}