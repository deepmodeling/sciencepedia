{"hands_on_practices": [{"introduction": "与具有整数容量的最大流问题总是存在整数解不同，最小费用流问题的解可能更为微妙。成本函数的性质在此起着至关重要的作用。本练习 [@problem_id:3253559] 邀请您探索不同类型的成本函数——线性、凸函数和凹函数——如何影响解的性质，并发现即使所有输入均为整数，在何种特定条件下也必然产生分数流。", "problem": "考虑一个有向图$G=(V,E)$上的最小费用流问题，图中有一个源点$s \\in V$和一个汇点$t \\in V$。一个可行的$s$-$t$流为每条弧$e \\in E$分配一个非负值$f_e$，该值不超过其容量$u_e$，在每个非源汇节点$v \\in V \\setminus \\{s,t\\}$处满足流量守恒，并从$s$到$t$输送一个预定的总流量值$F$。费用是弧可分的：每条弧$e$有一个费用函数$c_e(f_e)$，总费用为$\\sum_{e \\in E} c_e(f_e)$。在标准线性模型中，$c_e(f_e) = a_e f_e$（其中$a_e$为某个非负数），且$G$的节点-弧关联矩阵是全幺模的，这意味着当容量和供给/需求为整数时，存在一个最优流，其中所有的$f_e$都是整数。相比之下，对于严格凸的可分费用$c_e(\\cdot)$，最优流可能倾向于在平行弧之间分配。\n\n您的任务是确定以下哪种网络设计能保证，尽管所有容量$u_e$和所需的总流量$F$都是整数，但每个最优最小费用流都必须在至少一条弧上是分数流。\n\n所有选项都使用相同的基础图：从$s$到$t$的两条平行弧$e_1$和$e_2$，每条弧的容量均为$u_{e_1}=u_{e_2}=1$，所需的总$s$-$t$流量为$F=1$。令$x_1 := f_{e_1}$且$x_2 := f_{e_2}$。\n\nA. 线性等单位费用：$c_{e_1}(x_1) = x_1$ 和 $c_{e_2}(x_2) = x_2$。\n\nB. 严格凸等费用：$c_{e_1}(x_1) = x_1^2$ 和 $c_{e_2}(x_2) = x_2^2$。\n\nC. 线性不等单位费用：$c_{e_1}(x_1) = 0 \\cdot x_1$ 和 $c_{e_2}(x_2) = 2 x_2$。\n\nD. 凹等费用：$c_{e_1}(x_1) = \\sqrt{x_1}$ 和 $c_{e_2}(x_2) = \\sqrt{x_2}$。\n\n哪个选项产生的网络中，每个最优解都必然在至少一条弧上使用分数流，即$x_1$或$x_2$至少有一个不是整数？", "solution": "用户提供了一个网络优化领域中定义明确的问题，具体涉及最小费用流。\n\n### 问题形式化\n问题设定在一个有向图$G=(V, E)$上，该图有一个源点$s$和一个汇点$t$。该图由两条从$s$指向$t$的平行弧$e_1$和$e_2$组成。设$x_1$和$x_2$分别为弧$e_1$和$e_2$上的流量。\n\n问题是要找到一个流$(x_1, x_2)$，使其在满足一组约束条件的情况下最小化总费用。给定条件如下：\n- **总流量要求：** 从$s$到$t$的总流量必须为$F=1$。这给出了流量守恒方程：\n$$x_1 + x_2 = 1$$\n- **容量约束：** 每条弧上的流量不能超过其容量。\n$$0 \\le x_1 \\le u_{e_1} = 1$$\n$$0 \\le x_2 \\le u_{e_2} = 1$$\n- **费用函数：** 总费用是每条弧上费用的总和，$C(x_1, x_2) = c_{e_1}(x_1) + c_{e_2}(x_2)$。$c_{e_1}$和$c_{e_2}$的具体形式在每个选项中给出。\n\n任务是确定费用函数$c_{e_1}(\\cdot)$和$c_{e_2}(\\cdot)$的哪个选项能保证*每个*最优流解$(x_1^*, x_2^*)$都是分数的。在给定约束条件下，一个整数流解必须是$(x_1, x_2) = (1, 0)$或$(x_1, x_2) = (0, 1)$。一个分数解是任何其他有效的流，即$0  x_1  1$且$0  x_2  1$。\n\n我们可以通过总流量约束将$x_2$表示为$x_1$的函数来简化优化问题：$x_2 = 1 - x_1$。容量约束$0 \\le x_1 \\le 1$和$0 \\le x_2 \\le 1$随后等价于单个约束$0 \\le x_1 \\le 1$。因此，问题变为：\n$$\\text{最小化 } C(x_1) = c_{e_1}(x_1) + c_{e_2}(1-x_1)$$\n$$\\text{约束条件为 } 0 \\le x_1 \\le 1$$\n\n我们现在逐一分析每个选项。\n\n### 逐项分析\n\n**A. 线性等单位费用：$c_{e_1}(x_1) = x_1$ 和 $c_{e_2}(x_2) = x_2$。**\n\n总费用函数为$C(x_1, x_2) = c_{e_1}(x_1) + c_{e_2}(x_2) = x_1 + x_2$。\n在总流量约束$x_1 + x_2 = 1$的条件下，任何可行流的费用都是恒定的：\n$$C(x_1, x_2) = 1$$\n由于所有可行流的费用都相同，因此每个可行流都是最优流。最优解的集合是$\\{(x_1, 1-x_1) | x_1 \\in [0, 1]\\}$。这个集合包括整数解$(1, 0)$和$(0, 1)$，以及无限多个分数解，如$(0.5, 0.5)$。\n因为存在整数最优解，所以这个选项不能保证每个最优流都是分数流。\n\n**A 的结论：不正确。**\n\n**B. 严格凸等费用：$c_{e_1}(x_1) = x_1^2$ 和 $c_{e_2}(x_2) = x_2^2$。**\n\n总费用函数，作为$x_1$的函数，是：\n$$C(x_1) = x_1^2 + (1-x_1)^2 = x_1^2 + (1 - 2x_1 + x_1^2) = 2x_1^2 - 2x_1 + 1$$\n我们需要在区间$x_1 \\in [0, 1]$上最小化这个函数。函数$C(x_1)$是一个首项系数为正的二次函数，代表一个开口向上的抛物线，因此它是严格凸的。一个在闭区间上的严格凸函数有唯一的全局最小值。\n为了找到最小值，我们计算一阶导数并令其为零：\n$$C'(x_1) = \\frac{d}{dx_1}(2x_1^2 - 2x_1 + 1) = 4x_1 - 2$$\n令$C'(x_1) = 0$得$4x_1 - 2 = 0$，解得$x_1 = 1/2$。\n由于这个值$x_1^* = 1/2$在可行区间$[0, 1]$内，所以它是唯一的最小值点。\n第二条弧上对应的流量是$x_2^* = 1 - x_1^* = 1 - 1/2 = 1/2$。\n唯一的最优流是$(x_1^*, x_2^*) = (1/2, 1/2)$。两个分量都是非整数。\n因为最优解是唯一的且是分数的，所以可以保证*每个*最优流都必须是分数流。\n\n**B 的结论：正确。**\n\n**C. 线性不等单位费用：$c_{e_1}(x_1) = 0 \\cdot x_1$ 和 $c_{e_2}(x_2) = 2 x_2$。**\n\n总费用函数为$C(x_1, x_2) = 0 \\cdot x_1 + 2x_2 = 2x_2$。\n作为$x_1$的函数，这是：\n$$C(x_1) = 2(1-x_1) = 2 - 2x_1$$\n这是一个关于$x_1$的斜率为负的线性函数。要在区间$x_1 \\in [0, 1]$上最小化此函数，我们必须为$x_1$选择可能的最大值。\n区间中的最大值是$x_1^* = 1$。\n唯一的最优解是$x_1^* = 1$，这得到$x_2^* = 1 - 1 = 0$。\n最优流是$(1, 0)$。这是一个整数解。\n\n**C 的结论：不正确。**\n\n**D. 凹等费用：$c_{e_1}(x_1) = \\sqrt{x_1}$ 和 $c_{e_2}(x_2) = \\sqrt{x_2}$。**\n\n总费用函数，作为$x_1$的函数，是：\n$$C(x_1) = \\sqrt{x_1} + \\sqrt{1-x_1}$$\n我们必须在区间$x_1 \\in [0, 1]$上最小化这个函数。为了确定此函数的性质，我们检查它的二阶导数：\n$$C'(x_1) = \\frac{1}{2\\sqrt{x_1}} - \\frac{1}{2\\sqrt{1-x_1}}$$\n$$C''(x_1) = -\\frac{1}{4}x_1^{-3/2} - \\frac{1}{4}(1-x_1)^{-3/2} = -\\frac{1}{4}\\left(\\frac{1}{x_1\\sqrt{x_1}} + \\frac{1}{(1-x_1)\\sqrt{1-x_1}}\\right)$$\n对于所有$x_1 \\in (0, 1)$，$C''(x_1)  0$。这意味着费用函数$C(x_1)$在其定义域内部是严格凹的。凹函数的一个基本性质是，其在闭凸集（如区间$[0, 1]$）上的最小值必然出现在集合的某个极点（端点）上。\n区间的端点是$x_1 = 0$和$x_1 = 1$。我们计算这些点的费用：\n- 对于$x_1=0$：$C(0) = \\sqrt{0} + \\sqrt{1-0} = 1$。这对应于流$(0, 1)$。\n- 对于$x_1=1$：$C(1) = \\sqrt{1} + \\sqrt{1-1} = 1$。这对应于流$(1, 0)$。\n最小费用是$1$，它在两个流上达到：$(0, 1)$和$(1, 0)$。这两个最优解都是整数解。\n\n**D 的结论：不正确。**\n\n### 结论\n只有严格凸费用（选项 B）的情况导致了唯一最优流是分数流的情形，从而保证任何最优解都必须是分数流。费用函数的凸性惩罚了将流量集中在单条弧上的做法，倾向于在平行弧之间分配流量，在这种对称情况下，导致了均等分配。", "answer": "$$\\boxed{B}$$", "id": "3253559"}, {"introduction": "在建立了理论基础之后，下一步是实践寻找最小费用流的算法核心机制。解决此类问题的大多数算法都是通过在残留网络中寻找“增广路径”来迭代地改进流。这个问题 [@problem_id:3253528] 提供了一个具体的场景来练习这项核心技能，挑战您找到增加流量的最具成本效益的方式，并突显了反向边在降低总成本方面可能发挥的惊人作用。", "problem": "考虑一个有向网络 $G=(V,E)$，其顶点集为 $V=\\{s,a,b,t\\}$，有向边 $(u,v)\\in E$ 均具有非负整数容量和实数单位成本。一个流的总成本是所有有向边 $(u,v)\\in E$ 上的流量与该边单位成本的乘积之和。该网络由以下边的规格给出：\n- $(s,a)$ 的容量为 $1$，单位成本为 $1$。\n- $(s,b)$ 的容量为 $1$，单位成本为 $1$。\n- $(a,b)$ 的容量为 $1$，单位成本为 $3$。\n- $(a,t)$ 的容量为 $1$，单位成本为 $0$。\n- $(b,t)$ 的容量为 $1$，单位成本为 $0$。\n\n给定一个值为 $1$ 的可行 $s$–$t$ 流 $f$，其非零边流定义如下：\n- $f(s,a)=1$，\n- $f(a,b)=1$，\n- $f(b,t)=1$，\n且在所有其他边上 $f(u,v)=0$。\n\n从给定的流 $f$ 开始，确定将总 $s$–$t$ 流量值恰好增加 $1$ 个单位所需的最小额外成本。答案请以实数形式表示，无需进行四舍五入。", "solution": "为了确定将总流量增加1个单位所需的最小额外成本，我们需要在与当前流$f$相关的残留网络$G_f$中找到从源点$s$到汇点$t$的成本最低的路径。这条路径的成本即为所求的最小额外成本。\n\n### 1. 分析初始流和网络\n- **网络规格（容量，成本）：**\n  - $(s,a)$: $(1, 1)$\n  - $(s,b)$: $(1, 1)$\n  - $(a,b)$: $(1, 3)$\n  - $(a,t)$: $(1, 0)$\n  - $(b,t)$: $(1, 0)$\n- **初始流 $f$：**\n  - $f(s,a)=1$\n  - $f(a,b)=1$\n  - $f(b,t)=1$\n- 这个流沿路径$s \\to a \\to b \\to t$发送了1个单位的流量。\n- 初始流的总成本为$1 \\cdot c(s,a) + 1 \\cdot c(a,b) + 1 \\cdot c(b,t) = 1 \\cdot 1 + 1 \\cdot 3 + 1 \\cdot 0 = 4$。\n\n### 2. 构建残留网络 $G_f$\n残留网络包含两种类型的边：\n- **正向边：** 对于原始网络中的每条边$(u,v)$，如果其未被流量占满，则在$G_f$中存在一条正向边$(u,v)$，其残留容量为$u_f(u,v) = \\text{capacity}(u,v) - f(u,v)$，成本为$c(u,v)$。\n- **反向边：** 对于原始网络中每条有流量的边$(u,v)$，在$G_f$中存在一条反向边$(v,u)$，其残留容量为$u_f(v,u) = f(u,v)$，成本为$-c(u,v)$。这代表可以“取消”或“推回”这部分流量。\n\n根据初始流$f$，我们得到以下残留边（容量，成本）：\n- **来自 $(s,a)$:** 饱和。产生反向边 $(a,s)$，容量为$1$，成本为$-1$。\n- **来自 $(s,b)$:** 空闲。产生正向边 $(s,b)$，容量为$1$，成本为$1$。\n- **来自 $(a,b)$:** 饱和。产生反向边 $(b,a)$，容量为$1$，成本为$-3$。\n- **来自 $(a,t)$:** 空闲。产生正向边 $(a,t)$，容量为$1$，成本为$0$。\n- **来自 $(b,t)$:** 饱和。产生反向边 $(t,b)$，容量为$1$，成本为$0$。\n\n### 3. 在残留网络中寻找最短（成本最低）路径\n我们现在需要在$G_f$中寻找从$s$到$t$的最短路径。让我们检查所有可能的路径：\n- **路径 1:** $s \\to b \\to a \\to t$\n  - 这条路径由以下残留边组成：\n    - $(s,b)$: 正向边，成本为$1$。\n    - $(b,a)$: 反向边，成本为$-3$。\n    - $(a,t)$: 正向边，成本为$0$。\n  - **路径总成本:** $1 + (-3) + 0 = -2$。\n  - **路径容量（瓶颈容量）:** $\\min(u_f(s,b), u_f(b,a), u_f(a,t)) = \\min(1, 1, 1) = 1$。\n\n这条路径的物理意义是：\n1.  从$s$发送一个新单位流量到$b$（成本$+1$）。\n2.  将原来从$a$到$b$的流量“推回”到$a$（成本$-3$，即节省了原有的高成本）。\n3.  现在节点$a$有了一个单位的流量（来自步骤2），将其发送到$t$（成本$0$）。\n最终效果是，总流量从$s$到$t$增加了1，但总成本减少了2。\n\n- **其他可能的路径？**\n  - 在这个简单的残留网络中，没有其他从$s$到$t$的路径。例如，无法从$s$到达$a$（除非通过$b$），也无法从$b$直接到达$t$。\n\n### 结论\n从$s$到$t$的最短增广路径是$s \\to b \\to a \\to t$，其成本为-2。因此，将总流量增加1个单位所需的最小额外成本是-2。", "answer": "$$\n\\boxed{-2}\n$$", "id": "3253528"}, {"introduction": "最小费用流问题中的最优解的特征在于其残留网络中不存在负成本循环。这最后一个练习 [@problem_id:3253618] 将这一概念推向深入，探讨了当达到最优状态后问题参数发生变化时会发生什么。通过分析成本的降低如何引入负成本循环，您将对负循环消除算法以及最优性的动态本质有更深刻的理解。", "problem": "考虑一个处于最优可行状态的有向网络上的最小費用流实例。设其对应的残留网络（Residual Network, RN）的节点集为 $\\{A,B,C,D\\}$，并包含以下有向残留边，每条边都标注了残留容量和费用，格式为$(\\text{残留容量}, \\text{费用})$：\n- $(A,B)$，参数为 $(3, 4)$，\n- $(B,C)$，参数为 $(2, 1)$，\n- $(C,A)$，参数为 $(1, 2)$，\n- $(B,D)$，参数为 $(2, 1)$，\n- $(D,A)$，参数为 $(2, 5)$。\n\n假设不存在其他残留边，并且在此残留网络中没有负费用有向圈。残留网络中正向边的费用等于相应原始边的费用，而反向边（此处未列出）的费用等于相应原始边费用的相反数。已知当前的可行流是最优的。\n\n现在将单条边 $(A,B)$ 的原始费用减少一个非负量 $\\Delta$，其中 $\\Delta = 9$。此变更后，系统可以重新优化以得到一个新的最小费用可行流。\n\n请仅使用最小費用流最优性的基本定义（即残留网络中不存在负费用圈）以及沿负费用圈进行增广的效果，来确定因边 $(A,B)$ 的费用减少 $\\Delta$ 而可能导致的最优总费用的最大可能减少量。请以单个实数形式给出你的答案。无需四舍五-入。", "solution": "### 步骤 1：分析初始最优状态\n1.  **问题类型：** 网络中没有指定的源点或汇点，所有节点都是内部节点。这是一个最小费用循环流问题。\n2.  **初始最优性：** 问题陈述，初始流是最优的，并且其残留网络（RN）中没有负费用圈。\n3.  **初始成本：** 在给定的初始RN中，所有边的费用都是正的。对于一个循环流问题，如果所有残留路径的成本都非负，那么总成本为零的“零流”（即每条边上的流量都为0）必然是一个最优解。任何非零的循环流都会产生正成本。因此，初始的最优流是零流$f_{\\text{old}} = 0$，其总成本为$C_{\\text{old}} = 0$。\n4.  **原始网络参数：** 由于初始流是零流，给定的残留容量就是原始边的容量。例如，原始边$(A,B)$的容量是3。给定的残留费用是原始边的费用，所以原始边$(A,B)$的费用是$c(A,B) = 4$。\n\n### 步骤 2：分析成本变化及其影响\n1.  **成本更新：** 原始边$(A,B)$的费用减少了$\\Delta = 9$。新的费用为$c'(A,B) = c(A,B) - \\Delta = 4 - 9 = -5$。\n2.  **更新残留网络：** 这个变化直接影响了残留网络中边$(A,B)$的费用，其新费用也变为-5。所有其他残留边的费用保持不变。\n3.  **寻找负费用圈：** 我们需要在更新后的残留网络中检查是否存在负费用圈。\n    - **圈 1: $A \\to B \\to C \\to A$**\n      - 费用: $c'(A,B) + c(B,C) + c(C,A) = (-5) + 1 + 2 = -2$。\n      - 这是一个负费用圈，违反了最优性条件。\n    - **圈 2: $A \\to B \\to D \\to A$**\n      - 费用: $c'(A,B) + c(B,D) + c(D,A) = (-5) + 1 + 5 = 1$。\n      - 这不是一个负费用圈。\n\n### 步骤 3：通过增广流量恢复最优性\n1.  **确定增广量：** 为了消除负费用圈$A \\to B \\to C \\to A$，我们沿此圈增广流量。可增广的最大流量（即瓶颈容量）由圈上各边的残留容量决定：\n    $$k = \\min(\\text{cap}(A,B), \\text{cap}(B,C), \\text{cap}(C,A)) = \\min(3, 2, 1) = 1$$\n    我们可以沿此圈推送1个单位的流量。\n\n2.  **计算成本减少量：** 每沿负费用圈推送1单位流量，总成本就会减少该圈费用的绝对值。因此，总成本的减少量为：\n    $$\\text{减少量} = k \\times |\\text{圈费用}| = 1 \\times |-2| = 2$$\n\n### 步骤 4：验证新状态和最终答案\n1.  **新的最优流：** 增广$k=1$的流量后，边$(C,A)$的残留容量变为$1-1=0$。这使得负费用圈$A \\to B \\to C \\to A$在残留网络中断开。由于没有其他负费用圈，网络恢复到最优状态。\n2.  **新的总成本：** 新的最优流$f_{\\text{new}}$是在边$(A,B)$, $(B,C)$, $(C,A)$上各流过1单位流量。新的总成本为：\n    $$C_{\\text{new}} = 1 \\cdot c'(A,B) + 1 \\cdot c(B,C) + 1 \\cdot c(C,A)$$\n    $$C_{\\text{new}} = 1 \\cdot (-5) + 1 \\cdot (1) + 1 \\cdot (2) = -2$$\n3.  **总费用减少量：** 最优总费用的减少量是旧的最优成本与新的最优成本之差：\n    $$\\text{总减少量} = C_{\\text{old}} - C_{\\text{new}} = 0 - (-2) = 2$$\n\n因此，因边$(A,B)$的费用减少而导致的最优总费用的最大可能减少量是2。", "answer": "$$\\boxed{2}$$", "id": "3253618"}]}