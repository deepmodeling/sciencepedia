{"hands_on_practices": [{"introduction": "Shor算法的核心在于利用量子计算的优势来找到一个特定函数的周期。这个“周期”在经典数论中被称为“阶”，即对于给定的底数 $a$ 和模数 $N$，使 $a^r \\equiv 1 \\pmod{N}$ 成立的最小正整数 $r$。在我们深入量子世界之前，通过一个简单的经典计算来亲手算出一个阶，可以帮助我们直观地理解算法的目标是什么。[@problem_id:1447896]", "problem": "考虑一个函数 $f$，它将非负整数映射到一个有限整数集，其定义规则为 $f(x) = a^x \\pmod{N}$，其中 $a$ 和 $N$ 是正整数，且 $a$ 和 $N$ 的最大公约数为 1。这个函数是周期性的。其周期，记为 $r$，是满足 $a^r \\equiv 1 \\pmod{N}$ 的最小正整数。\n\n对于底数为 $a=7$、模数为 $N=15$ 的具体情况，通过直接计算来确定函数 $f(x) = 7^x \\pmod{15}$ 的周期 $r$。", "solution": "我们被要求求出 $a=7$ 对模 $N=15$ 的周期（乘法阶）$r$，它被定义为满足 $7^{r} \\equiv 1 \\pmod{15}$ 的最小正整数。由于 $\\gcd(7,15)=1$，因此在模15的乘法群中，7的幂是良定义的。根据欧拉定理，$7^{\\varphi(15)} \\equiv 1 \\pmod{15}$，其中 $\\varphi(15)=\\varphi(3)\\varphi(5)=2 \\cdot 4 = 8$，所以阶 $r$ 必须是 $8$ 的因子。我们通过直接计算来找出最小的这样的 $r$。\n\n利用性质：如果 $x \\equiv y \\pmod{15}$，那么 $7x \\equiv 7y \\pmod{15}$，我们来计算7对模15的连续幂：\n\n$7^{1} \\equiv 7 \\pmod{15}$，不与 $1$ 同余。\n\n$7^{2} \\equiv 7 \\cdot 7 = 49 \\equiv 49 - 45 = 4 \\pmod{15}$，不与 $1$ 同余。\n\n$7^{3} \\equiv 7 \\cdot 7^{2} \\equiv 7 \\cdot 4 = 28 \\equiv 28 - 15 = 13 \\pmod{15}$，不与 $1$ 同余。\n\n$7^{4} \\equiv 7 \\cdot 7^{3} \\equiv 7 \\cdot 13 = 91 \\equiv 91 - 90 = 1 \\pmod{15}$。\n\n因此，满足 $7^{r} \\equiv 1 \\pmod{15}$ 的最小正整数 $r$ 是 $r=4$。这也与阶必须是 $8$ 的因子这一事实相符，并且我们已经验证了在 $1,2,3$ 中没有更小的正指数能使结果对模15同余于 $1$。", "answer": "$$\\boxed{4}$$", "id": "1447896"}, {"introduction": "Shor算法的量子部分并不会直接告诉我们周期 $r$ 是多少，而是提供一个与 $r$ 密切相关的测量结果 $s$。我们需要一种经典方法，从这个“线索”（即分数 $\\frac{s}{Q}$）中推导出真正的周期。这个练习模拟了从量子计算机获得测量输出后的关键一步，展示了如何使用连分数算法这一强大的数学工具，将近似的测量值转换为精确的周期，这是连接量子计算与经典后处理的桥梁。[@problem_id:132580]", "problem": "在用于分解整数 $N$ 的肖尔算法中，一个关键子程序涉及寻找一个选定整数 $a$ 模 $N$ 的周期（或阶）$r$。周期 $r$ 是满足 $a^r \\equiv 1 \\pmod N$ 的最小正整数。这是通过制备一个量子态并进行一次测量来实现的，测量结果为一个在 $0$ 到 $Q-1$ 之间的整数 $s$，其中 $Q=2^L$ 是一个计算寄存器的大小。测量值 $s$ 通过近似关系 $\\frac{s}{Q} \\approx \\frac{k}{r}$ 与周期 $r$ 相关，其中 $k$ 是某个未知的整数。\n\n为了从这个近似值中找到 $r$，可以使用连分数算法。该算法会找出一系列称为渐近分数的有理数，它们是给定值的逐次更优近似。这些渐近分数的分母是周期 $r$ 的候选值。\n\n考虑一个应用肖尔算法分解数 $N=35$ 的例子，其中使用基数 $a=13$。算法的量子测量部分是使用一个大小为 $Q=1024$ 的寄存器执行的。测量结果得到分数 $\\frac{s}{Q} = \\frac{192}{1024}$。\n\n你的任务是找出函数 $f(x) = 13^x \\pmod{35}$ 的基本周期 $r$。对测量出的比率 $\\frac{s}{Q}$ 使用连分数算法，以确定一组候选周期。通过测试这些候选值，找出其中一个是真实周期倍数的值，并由此确定基本周期 $r$。", "solution": "1. 表示测量出的比率：\n$$\\frac{s}{Q}=\\frac{192}{1024}=\\frac{3}{16}.$$\n\n2. 求 $\\frac{3}{16}$ 的连分数：\n$$\\frac{3}{16}=0+\\cfrac{1}{5+\\cfrac{1}{3}}=[0;5,3].$$\n\n3. 通过以下递推关系计算渐近分数 $p_n/q_n$\n$$p_{-1}=1, p_0=0,\\quad q_{-1}=0, q_0=1,$$\n$$p_{n+1}=a_{n+1}p_n+p_{n-1},\\quad q_{n+1}=a_{n+1}q_n+q_{n-1}.$$\n此处 $a_1=5, a_2=3$ 给出\n- $n=1$: $p_1=1, q_1=5\\implies1/5$，\n- $n=2$: $p_2=3, q_2=16\\implies3/16$。\n\n4. 周期的候选分母是 $q_0=1$, $q_1=5$ 和 $q_2=16$。\n\n5. 通过检查 $13^{r'}\\pmod{35}$ 来测试每个候选值 $r'$：\n- $r'=1$: $13^1\\equiv13\\not\\equiv1\\pmod{35}$。\n- $r'=5$: $13^5 = 13^{4+1} \\equiv 13^1 \\equiv 13 \\not\\equiv 1\\pmod{35}$。（此处使用了下一步计算得到的 $13^4\\equiv 1$）\n- $r'=16$: $13^2 \\equiv 169 \\equiv 29 \\pmod{35}$, $13^4 \\equiv 29^2 = 841 \\equiv 1 \\pmod{35}$。因此 $13^{16}=(13^4)^4\\equiv1^4\\equiv1\\pmod{35}$。\n\n6. 候选分母 $r'=16$ 满足条件。这意味着真实周期 $r$ 必须是 16 的一个因子。在前面的计算中，我们已经发现 $13^4 \\equiv 1 \\pmod{35}$。为了确认 4 是最小周期，我们只需测试 4 的因子（1 和 2）：$13^1 \\not\\equiv 1$ 且 $13^2 \\not\\equiv 1 \\pmod{35}$。因此，最小正整数是 4，即基本周期 $r=4$。", "answer": "$$\\boxed{4}$$", "id": "132580"}, {"introduction": "找到了周期 $r$ 之后，我们就离成功分解整数 $N$ 只有一步之遥了。当周期 $r$ 是偶数时，我们可以构造一个 $N$ 的非平凡平方根，并通过最大公约数（GCD）运算来提取 $N$ 的因子。这个练习将引导你完成Shor算法的最后一步，通过一个假设的“故障”场景，它反而更能凸显背后数学原理的普适性和强大之处。[@problem_id:160825]", "problem": "在用于分解整数 $N$ 的 Shor 算法中，其中一个关键子程序是量子求阶。标准流程如下：首先，选择一个随机整数 $x$，使得 $1  x  N$ 且 $\\gcd(x,N)=1$。然后，使用一个量子电路来找到 $x$ 模 $N$ 的阶 $r$，即满足 $x^r \\equiv 1 \\pmod{N}$ 的最小正整数。如果 $r$ 是偶数且 $x^{r/2} \\not\\equiv -1 \\pmod{N}$，那么可以通过计算最大公约数 $d_1 = \\gcd(x^{r/2}-1, N)$ 和 $d_2 = \\gcd(x^{r/2}+1, N)$ 来找到 $N$ 的一个非平凡因子。$d_1$ 或 $d_2$ 中至少有一个将是 $N$ 的非平凡因子。\n\n考虑一个场景，其中使用一个有缺陷的 Shor 算法实现来分解整数 $N=143$。基数被选为 $x=2$。缺陷在于目标寄存器的态制备，它被错误地初始化为态 $|k\\rangle$ 而不是标准的 $|1\\rangle$。这里，$k$ 是 $N$ 的最大素因子。然而，该算法的量子求阶部分在这个格式错误的输入态上仍能正常工作。也就是说，它返回序列 $y_j = k \\cdot x^j \\pmod{N}$ 的周期，我们称之为等效阶 $r_{\\text{eff}}$。\n\n事实证明，对于 $N$、$x$ 和 $k$ 的这个特定选择，等效阶 $r_{\\text{eff}}$ 是一个偶数，从而使得经典后处理可以继续进行。假设情况如此，计算通过此过程得到的 $N$ 的非平凡因子。", "solution": "我们已知 $N = 143$ 和 $x = 2$。$N$ 的最大素因子是 $k = 13$，因为 $143 = 11 \\times 13$。目标寄存器被初始化为 $|k\\rangle = |13\\rangle$，所以序列是 $y_j = k \\cdot x^j \\pmod{N} = 13 \\cdot 2^j \\pmod{143}$。等效阶 $r_{\\text{eff}}$ 是满足对所有 $j$ 都有 $y_{j + r_{\\text{eff}}} = y_j$ 的最小正整数，或者等价地，$y_{r_{\\text{eff}}} = y_0$。因为 $y_0 = 13 \\cdot 2^0 \\pmod{143} = 13$，我们有：\n$$\n13 \\cdot 2^{r_{\\text{eff}}} \\equiv 13 \\pmod{143}.\n$$\n这意味着：\n$$\n13 \\cdot (2^{r_{\\text{eff}}} - 1) \\equiv 0 \\pmod{143}.\n$$\n由于 $143 = 11 \\times 13$，我们可以写出：\n$$\n13 \\cdot (2^{r_{\\text{eff}}} - 1) = 143 \\cdot t = 13 \\cdot 11 \\cdot t \\quad \\text{对于某个整数 } t.\n$$\n两边同除以 13（在整数中是有效的）：\n$$\n2^{r_{\\text{eff}}} - 1 = 11 \\cdot t.\n$$\n因此：\n$$\n2^{r_{\\text{eff}}} \\equiv 1 \\pmod{11}.\n$$\n等效阶 $r_{\\text{eff}}$ 是 2 模 11 的阶。测试 2 模 11 的幂：\n- $2^1 \\equiv 2 \\pmod{11}$\n- $2^2 \\equiv 4 \\pmod{11}$\n- $2^3 \\equiv 8 \\pmod{11}$\n- $2^4 \\equiv 16 \\equiv 5 \\pmod{11}$\n- $2^5 \\equiv 32 \\equiv 10 \\pmod{11}$\n- $2^6 \\equiv 64 \\equiv 9 \\pmod{11}$\n- $2^7 \\equiv 128 \\equiv 7 \\pmod{11}$\n- $2^8 \\equiv 256 \\equiv 3 \\pmod{11}$\n- $2^9 \\equiv 512 \\equiv 6 \\pmod{11}$\n- $2^{10} \\equiv 1024 \\equiv 1 \\pmod{11}$\n\n满足 $2^{r_{\\text{eff}}} \\equiv 1 \\pmod{11}$ 的最小正整数是 $r_{\\text{eff}} = 10$，这是一个偶数。\n\n经典后处理使用 $r = r_{\\text{eff}} = 10$。计算：\n$$\na = x^{r/2} = 2^{10/2} = 2^5 = 32.\n$$\n检查 $a \\not\\equiv -1 \\pmod{N}$：\n$$\n-1 \\pmod{143} \\equiv 142, \\quad 32 \\not\\equiv 142 \\pmod{143}.\n$$\n因此，条件得到满足。计算最大公约数：\n$$\nd_1 = \\gcd(a - 1, N) = \\gcd(32 - 1, 143) = \\gcd(31, 143),\n$$\n$$\nd_2 = \\gcd(a + 1, N) = \\gcd(32 + 1, 143) = \\gcd(33, 143).\n$$\n\n计算 $d_1$：\n- $143 \\div 31 = 4$ 余 $143 - 4 \\times 31 = 143 - 124 = 19$，\n- $31 \\div 19 = 1$ 余 $31 - 19 = 12$，\n- $19 \\div 12 = 1$ 余 $19 - 12 = 7$，\n- $12 \\div 7 = 1$ 余 $12 - 7 = 5$，\n- $7 \\div 5 = 1$ 余 $7 - 5 = 2$，\n- $5 \\div 2 = 2$ 余 $5 - 4 = 1$，\n- $2 \\div 1 = 2$ 余 $0$。因此，$\\gcd(31, 143) = 1$。\n\n计算 $d_2$：\n- $143 \\div 33 = 4$ 余 $143 - 4 \\times 33 = 143 - 132 = 11$，\n- $33 \\div 11 = 3$ 余 $0$。因此，$\\gcd(33, 143) = 11$。\n\n由于 $d_1 = 1$ 是平凡的，非平凡因子是 $d_2 = 11$。", "answer": "$$\\boxed{11}$$", "id": "160825"}]}