{"hands_on_practices": [{"introduction": "理论知识的价值在于其解决实际问题的能力。这个练习将贝叶斯定理和全概率定律应用于一个经典的决策场景——序贯检验，例如在医疗诊断中，你需要决定以何种顺序进行一系列测试，以在成本和诊断准确性之间取得最佳平衡。通过这个练习，你将学会如何利用新证据更新你的信念，并计算预期效用以指导决策[@problem_id:3184709]。", "problem": "一个二元状况 $Y \\in \\{\\text{存在}, \\text{不存在}\\}$ 将通过一个使用两个二元检验 $T_1$ 和 $T_2$ 的序贯检验方案进行预测，每个检验的结果为 $\\text{pos}$ (阳性) 或 $\\text{neg}$ (阴性)。该状况的先验概率为 $P(Y=\\text{存在}) = 0.03$，因此 $P(\\neg Y) = 0.97$。这些检验具有已知的操作特性：\n- $P(T_1=\\text{pos} \\mid Y=\\text{存在}) = 0.93$ 且 $P(T_1=\\text{pos} \\mid \\neg Y) = 0.08$，\n- $P(T_2=\\text{pos} \\mid Y=\\text{存在}) = 0.88$ 且 $P(T_2=\\text{pos} \\mid \\neg Y) = 0.04$。\n\n假设在给定 $Y$ 的条件下 $T_1$ 和 $T_2$ 是条件独立的，在给定 $\\neg Y$ 的条件下也是条件独立的。序贯方案如下：\n- 先进行第一次检验；如果结果为 $\\text{pos}$，则进行第二次检验；如果结果为 $\\text{neg}$，则停止检验，\n- 当且仅当两次检验结果均为 $\\text{pos}$ 时，预测 $Y=\\text{存在}$；否则预测 $Y=\\text{不存在}$。\n\n效用是可加的，规定如下：\n- 正确预测 $Y=\\text{存在}$ (真阳性) 产生 $+50$ 个效用单位，\n- 错误预测 $Y=\\text{存在}$ (假阳性) 产生 $-8$ 个效用单位，\n- 未能预测出 $Y=\\text{存在}$ (假阴性) 产生 $-20$ 个效用单位，\n- 正确预测 $Y=\\text{不存在}$ (真阴性) 产生 $0$ 个效用单位，\n- 进行检验 $T_1$ 的成本为 $7$ 个效用单位，进行检验 $T_2$ 的成本为 $9$ 个效用单位。\n\n仅使用条件概率的定义和全概率定律，计算后验概率 $P(Y=\\text{存在} \\mid T_1=\\text{pos}, T_2=\\text{pos})$。然后，在所述方案和效用模型下，确定哪种检验顺序（先 $T_1$ 后 $T_2$；或先 $T_2$ 后 $T_1$）可以最大化期望效用。将最优顺序编码为一个整数代码：如果应首先进行 $T_1$，则输出 $1$；如果应首先进行 $T_2$，则输出 $2$。\n\n以一个包含两个条目的行矩阵形式提供您的最终答案：后验概率 $P(Y=\\text{存在} \\mid T_1=\\text{pos}, T_2=\\text{pos})$ 以精确分数表示，以及最优顺序的整数代码。最终答案中不包含单位。", "solution": "该问题要求计算两个量：在两次检验均为阳性的条件下状况存在的后验概率，以及为最大化期望效用而进行这些检验的最优顺序。\n\n首先，我们建立符号表示并形式化给定的信息。\n令 $Y$ 表示状况存在的事件，则 $Y^c$ (或 $\\neg Y$) 表示状况不存在的事件。\n令 $T_{1,p}$ 和 $T_{1,n}$ 分别表示检验 $T_1$ 结果为阳性和阴性的事件。\n令 $T_{2,p}$ 和 $T_{2,n}$ 分别表示检验 $T_2$ 结果为阳性和阴性的事件。\n\n已知条件如下：\n- 先验概率: $P(Y) = 0.03$。这意味着 $P(Y^c) = 1 - 0.03 = 0.97$。\n- 检验 $T_1$ 的特性: $P(T_{1,p} | Y) = 0.93$ 且 $P(T_{1,p} | Y^c) = 0.08$。\n- 检验 $T_2$ 的特性: $P(T_{2,p} | Y) = 0.88$ 且 $P(T_{2,p} | Y^c) = 0.04$。\n- 在给定状况（$Y$ 或 $Y^c$）的条件下，检验 $T_1$ 和 $T_2$ 是条件独立的。\n- 预测规则：当且仅当两次检验均为阳性时，预测 $Y$。否则，预测 $Y^c$。\n- 预测结果的效用：\n  - 真阳性 (TP, 预测 $Y$, 实际 $Y$): $U_{TP} = +50$。\n  - 假阳性 (FP, 预测 $Y$, 实际 $Y^c$): $U_{FP} = -8$。\n  - 假阴性 (FN, 预测 $Y^c$, 实际 $Y$): $U_{FN} = -20$。\n  - 真阴性 (TN, 预测 $Y^c$, 实际 $Y^c$): $U_{TN} = 0$。\n- 检验成本: $T_1$ 的成本 $C_1 = 7$, $T_2$ 的成本 $C_2 = 9$。\n\n**第 1 部分：后验概率 $P(Y | T_{1,p}, T_{2,p})$**\n\n我们使用贝叶斯定理来计算后验概率：\n$$P(Y | T_{1,p}, T_{2,p}) = \\frac{P(T_{1,p}, T_{2,p} | Y) P(Y)}{P(T_{1,p}, T_{2,p})}$$\n分母是观察到两次阳性检验的总概率，可以使用全概率定律展开：\n$$P(T_{1,p}, T_{2,p}) = P(T_{1,p}, T_{2,p} | Y) P(Y) + P(T_{1,p}, T_{2,p} | Y^c) P(Y^c)$$\n由于 $T_1$ 和 $T_2$ 的条件独立性，我们有：\n$P(T_{1,p}, T_{2,p} | Y) = P(T_{1,p} | Y) P(T_{2,p} | Y)$\n$P(T_{1,p}, T_{2,p} | Y^c) = P(T_{1,p} | Y^c) P(T_{2,p} | Y^c)$\n\n让我们计算公式的各个组成部分。最佳实践是使用分数或具有足够精度的小数，以获得精确的分数答案。\n$P(Y) = 0.03 = \\frac{3}{100}$\n$P(Y^c) = 0.97 = \\frac{97}{100}$\n$P(T_{1,p} | Y) = 0.93 = \\frac{93}{100}$\n$P(T_{1,p} | Y^c) = 0.08 = \\frac{8}{100}$\n$P(T_{2,p} | Y) = 0.88 = \\frac{88}{100}$\n$P(T_{2,p} | Y^c) = 0.04 = \\frac{4}{100}$\n\n贝叶斯定理的分子：\n$$P(T_{1,p}, T_{2,p}, Y) = P(T_{1,p} | Y) P(T_{2,p} | Y) P(Y) = \\left(\\frac{93}{100}\\right) \\left(\\frac{88}{100}\\right) \\left(\\frac{3}{100}\\right) = \\frac{24552}{1000000} = 0.024552$$\n这一项是真阳性预测的联合概率。\n\n来自 $Y^c$ 的分母贡献：\n$$P(T_{1,p}, T_{2,p}, Y^c) = P(T_{1,p} | Y^c) P(T_{2,p} | Y^c) P(Y^c) = \\left(\\frac{8}{100}\\right) \\left(\\frac{4}{100}\\right) \\left(\\frac{97}{100}\\right) = \\frac{3104}{1000000} = 0.003104$$\n这一项是假阳性预测的联合概率。\n\n分母中的总概率：\n$$P(T_{1,p}, T_{2,p}) = P(T_{1,p}, T_{2,p}, Y) + P(T_{1,p}, T_{2,p}, Y^c) = 0.024552 + 0.003104 = 0.027656 = \\frac{27656}{1000000}$$\n现在我们计算后验概率：\n$$P(Y | T_{1,p}, T_{2,p}) = \\frac{0.024552}{0.027656} = \\frac{24552}{27656}$$\n为了化简这个分数，我们可以找到最大公约数。两个数都可以被 $8$ 整除：\n$$P(Y | T_{1,p}, T_{2,p}) = \\frac{24552 \\div 8}{27656 \\div 8} = \\frac{3069}{3457}$$\n分子的质因数分解是 $3069 = 3^2 \\times 11 \\times 31$。分母 $3457$ 不能被 $3$、$11$ 或 $31$ 整除。因此，该分数已为最简形式。\n\n**第 2 部分：最优检验顺序**\n\n总期望效用是预测结果的期望效用减去检验的期望成本：\n$$E[U] = E[U_{\\text{prediction}}] - E[C_{\\text{test}}]$$\n预测规则是当且仅当两次检验均为阳性时才预测 $Y$，而不管它们执行的顺序如何。让我们分析 $E[U_{\\text{prediction}}]$ 的组成部分：\n$$E[U_{\\text{prediction}}] = P(\\text{TP})U_{TP} + P(\\text{FP})U_{FP} + P(\\text{FN})U_{FN} + P(\\text{TN})U_{TN}$$\n这四种结果的概率仅取决于最终的联合检验结果，而与顺序无关。\n- $P(\\text{TP}) = P(T_{1,p}, T_{2,p}, Y) = 0.024552$\n- $P(\\text{FP}) = P(T_{1,p}, T_{2,p}, Y^c) = 0.003104$\n- $P(\\text{FN}) = P(\\text{预测 } Y^c, Y) = P(Y) - P(\\text{TP}) = 0.03 - 0.024552 = 0.005448$\n- $P(\\text{TN}) = P(\\text{预测 } Y^c, Y^c) = P(Y^c) - P(\\text{FP}) = 0.97 - 0.003104 = 0.966896$\n\n由于这些概率和相关的效用（$U_{TP}, U_{FP}, U_{FN}, U_{TN}$）与检验顺序无关，因此对于两种方案，$E[U_{\\text{prediction}}]$ 是相同的。因此，为了最大化总期望效用 $E[U]$，我们必须最小化期望成本 $E[C_{\\text{test}}]$。\n\n让我们计算两种可能顺序的期望成本。\n\n**情景 1：首先进行 $T_1$。**\n$T_1$ 的成本总是会产生。只有当 $T_1$ 结果为阳性时，才会产生 $T_2$ 的成本。\n$$E[C | S_1] = C_1 + C_2 \\times P(T_{1,p})$$\n我们需要计算边缘概率 $P(T_{1,p})$：\n$$P(T_{1,p}) = P(T_{1,p} | Y)P(Y) + P(T_{1,p} | Y^c)P(Y^c)$$\n$$P(T_{1,p}) = (0.93)(0.03) + (0.08)(0.97) = 0.0279 + 0.0776 = 0.1055$$\n所以，情景 1 的期望成本是：\n$$E[C | S_1] = 7 + 9 \\times 0.1055 = 7 + 0.9495 = 7.9495$$\n\n**情景 2：首先进行 $T_2$。**\n$T_2$ 的成本总是会产生。只有当 $T_2$ 结果为阳性时，才会产生 $T_1$ 的成本。\n$$E[C | S_2] = C_2 + C_1 \\times P(T_{2,p})$$\n我们需要计算边缘概率 $P(T_{2,p})$：\n$$P(T_{2,p}) = P(T_{2,p} | Y)P(Y) + P(T_{2,p} | Y^c)P(Y^c)$$\n$$P(T_{2,p}) = (0.88)(0.03) + (0.04)(0.97) = 0.0264 + 0.0388 = 0.0652$$\n所以，情景 2 的期望成本是：\n$$E[C | S_2] = 9 + 7 \\times 0.0652 = 9 + 0.4564 = 9.4564$$\n\n比较期望成本：\n$$E[C | S_1] = 7.9495$$\n$$E[C | S_2] = 9.4564$$\n由于 $E[C | S_1]  E[C | S_2]$，首先进行检验 $T_1$ 可以使期望成本最小化。这个序贯方案最大化了总期望效用。此最优顺序的整数代码是 $1$。\n\n最终答案包括后验概率和最优顺序代码。\n后验概率：$\\frac{3069}{3457}$\n最优顺序代码：$1$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3069}{3457}  1\n\\end{pmatrix}\n}\n$$", "id": "3184709"}, {"introduction": "模型假设是统计建模的基石，但错误的假设可能导致严重的预测偏差。这个练习通过一个具体的例子，揭示了朴素贝叶斯（Naive Bayes）分类器在特征不满足其核心的条件独立性假设时的缺陷，这种情况通常由未被观察到的潜在变量（latent variable）$Z$ 引起。你将通过全概率定律对潜在变量进行边缘化，构建一个更精确的模型，并量化朴素贝叶斯模型因此产生的偏差[@problem_id:3184732]。", "problem": "一个二元分类问题通过一个二元标签 $Y \\in \\{0,1\\}$、一个二元潜变量 $Z \\in \\{0,1\\}$ 和两个二元观测特征 $X_1, X_2 \\in \\{0,1\\}$ 进行生成式建模。联合数据生成过程如下。先验概率为 $P(Y=1)=0.4$ 和 $P(Y=0)=0.6$。潜变量依赖于标签，其条件概率为 $P(Z=1 \\mid Y=1)=0.7$，$P(Z=0 \\mid Y=1)=0.3$，$P(Z=1 \\mid Y=0)=0.2$ 和 $P(Z=0 \\mid Y=0)=0.8$。观测特征在给定对 $(Y,Z)$ 的条件下是条件独立的，即 $X_1 \\perp X_2 \\mid (Y,Z)$，其条件概率由以下公式指定：\n$$P(X_1=1 \\mid Y=1, Z=1)=0.95,\\quad P(X_1=1 \\mid Y=1, Z=0)=0.30,$$\n$$P(X_1=1 \\mid Y=0, Z=1)=0.85,\\quad P(X_1=1 \\mid Y=0, Z=0)=0.10,$$\n$$P(X_2=1 \\mid Y=1, Z=1)=0.90,\\quad P(X_2=1 \\mid Y=1, Z=0)=0.25,$$\n$$P(X_2=1 \\mid Y=0, Z=1)=0.80,\\quad P(X_2=1 \\mid Y=0, Z=0)=0.05.$$\n\n你观测到 $X_1=1$ 和 $X_2=1$。仅使用概率公理、全概率定律和贝叶斯定理，并从这些生成式假设出发，执行以下操作：\n\n1. 从第一性原理出发，推导正确考虑了潜变量 $Z$ 的后验概率 $P(Y=1 \\mid X_1=1, X_2=1)$ 的表达式，并计算其精确数值。\n\n2. 在朴素贝叶斯 (NB) 假设下，即 $X_1$ 和 $X_2$ 仅在给定 $Y$ 的条件下条件独立（忽略 $Z$），推导相应的后验概率 $P_{\\mathrm{NB}}(Y=1 \\mid X_1=1, X_2=1)$ 并计算其精确数值。\n\n3. 将定义为 $\\dfrac{P(Y=1 \\mid X_1=1, X_2=1)}{P_{\\mathrm{NB}}(Y=1 \\mid X_1=1, X_2=1)}$ 的乘性偏差因子报告为一个单一的精确值。\n\n精确地表示最终的偏差因子；不要四舍五入。", "solution": "用户想要计算一个乘性偏差因子，该因子比较了来自完整生成模型的后验概率与来自简化朴素贝叶斯模型的后验概率。\n\n该问题要求计算三个量：\n1. 来自完整生成模型的后验概率 $P(Y=1 \\mid X_1=1, X_2=1)$。\n2. 在朴素贝叶斯假设下的后验概率 $P_{\\mathrm{NB}}(Y=1 \\mid X_1=1, X_2=1)$。\n3. 定义为第一个量与第二个量之比的乘性偏差因子。\n\n令目标事件为 $A = \\{X_1=1, X_2=1\\}$。\n\n### 步骤 1：提取已知条件\n逐字给出的已知条件是：\n-   二元标签 $Y \\in \\{0,1\\}$，潜变量 $Z \\in \\{0,1\\}$，特征 $X_1, X_2 \\in \\{0,1\\}$。\n-   $Y$ 的先验概率：$P(Y=1)=0.4$，$P(Y=0)=0.6$。\n-   给定 $Y$ 时 $Z$ 的条件概率：\n    -   $P(Z=1 \\mid Y=1)=0.7$，$P(Z=0 \\mid Y=1)=0.3$。\n    -   $P(Z=1 \\mid Y=0)=0.2$，$P(Z=0 \\mid Y=0)=0.8$。\n-   给定 $(Y,Z)$ 时 $X_1$ 的条件概率：\n    -   $P(X_1=1 \\mid Y=1, Z=1)=0.95$。\n    -   $P(X_1=1 \\mid Y=1, Z=0)=0.30$。\n    -   $P(X_1=1 \\mid Y=0, Z=1)=0.85$。\n    -   $P(X_1=1 \\mid Y=0, Z=0)=0.10$。\n-   给定 $(Y,Z)$ 时 $X_2$ 的条件概率：\n    -   $P(X_2=1 \\mid Y=1, Z=1)=0.90$。\n    -   $P(X_2=1 \\mid Y=1, Z=0)=0.25$。\n    -   $P(X_2=1 \\mid Y=0, Z=1)=0.80$。\n    -   $P(X_2=1 \\mid Y=0, Z=0)=0.05$。\n-   条件独立性：$X_1 \\perp X_2 \\mid (Y,Z)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在概率论和统计学习中有科学依据。它描述了一个带有潜变量的标准生成模型。提供的所有概率都是有效的（即在 $[0, 1]$ 范围内）且一致的（例如，$P(Y=1)+P(Y=0)=1$）。这是一个适定的问题，提供了回答所提出问题所需的所有信息。语言客观而精确。该问题是应用全概率定律和贝叶斯定理的一个有效练习。\n\n### 步骤 3：结论和行动\n问题是有效的。我们继续进行求解。\n\n### 第 1 部分：推导正确的后验概率 $P(Y=1 \\mid X_1=1, X_2=1)$\n\n我们希望计算 $P(Y=1 \\mid A)$。使用贝叶斯定理：\n$$P(Y=1 \\mid A) = \\frac{P(A \\mid Y=1) P(Y=1)}{P(A)}$$\n分母 $P(A)$ 是证据的边缘概率，可以使用全概率定律展开：\n$$P(A) = P(A \\mid Y=1)P(Y=1) + P(A \\mid Y=0)P(Y=0)$$\n核心任务是计算类条件似然 $P(A \\mid Y=y) = P(X_1=1, X_2=1 \\mid Y=y)$，其中 $y \\in \\{0, 1\\}$。由于模型包含潜变量 $Z$，我们必须使用全概率定律将其边缘化：\n$$P(A \\mid Y=y) = \\sum_{z \\in \\{0,1\\}} P(X_1=1, X_2=1, Z=z \\mid Y=y)$$\n使用概率的链式法则 $P(B,C|D) = P(B|C,D)P(C|D)$，我们得到：\n$$P(A \\mid Y=y) = \\sum_{z \\in \\{0,1\\}} P(X_1=1, X_2=1 \\mid Y=y, Z=z) P(Z=z \\mid Y=y)$$\n问题陈述了 $X_1 \\perp X_2 \\mid (Y,Z)$，因此 $P(X_1=1, X_2=1 \\mid Y=y, Z=z) = P(X_1=1 \\mid Y=y, Z=z) P(X_2=1 \\mid Y=y, Z=z)$。\n将此代入求和式中，得到似然的完整表达式：\n$$P(A \\mid Y=y) = \\sum_{z \\in \\{0,1\\}} P(X_1=1 \\mid Y=y, Z=z) P(X_2=1 \\mid Y=y, Z=z) P(Z=z \\mid Y=y)$$\n\n现在，我们计算数值。\n对于 $Y=1$：\n$$P(A \\mid Y=1) = P(X_1=1|Y=1,Z=1)P(X_2=1|Y=1,Z=1)P(Z=1|Y=1) + P(X_1=1|Y=1,Z=0)P(X_2=1|Y=1,Z=0)P(Z=0|Y=1)$$\n$$P(A \\mid Y=1) = (0.95)(0.90)(0.7) + (0.30)(0.25)(0.3) = 0.5985 + 0.0225 = 0.621$$\n\n对于 $Y=0$：\n$$P(A \\mid Y=0) = P(X_1=1|Y=0,Z=1)P(X_2=1|Y=0,Z=1)P(Z=1|Y=0) + P(X_1=1|Y=0,Z=0)P(X_2=1|Y=0,Z=0)P(Z=0|Y=0)$$\n$$P(A \\mid Y=0) = (0.85)(0.80)(0.2) + (0.10)(0.05)(0.8) = 0.136 + 0.004 = 0.140$$\n\n现在我们可以计算贝叶斯定理的各项。\n联合概率 $P(A, Y=1) = P(A \\mid Y=1)P(Y=1) = 0.621 \\times 0.4 = 0.2484$。\n联合概率 $P(A, Y=0) = P(A \\mid Y=0)P(Y=0) = 0.140 \\times 0.6 = 0.084$。\n边缘证据是 $P(A) = P(A, Y=1) + P(A, Y=0) = 0.2484 + 0.084 = 0.3324$。\n\n后验概率是：\n$$P(Y=1 \\mid A) = \\frac{0.2484}{0.3324} = \\frac{2484}{3324} = \\frac{621}{831} = \\frac{207}{277}$$\n\n### 第 2 部分：推导朴素贝叶斯后验概率 $P_{\\mathrm{NB}}(Y=1 \\mid X_1=1, X_2=1)$\n\n朴素贝叶斯 (NB) 模型假设特征 $X_1$ 和 $X_2$ 仅在给定标签 $Y$ 的条件下是条件独立的：$X_1 \\perp X_2 \\mid Y$。后验概率由下式给出：\n$$P_{\\mathrm{NB}}(Y=1 \\mid A) = \\frac{P_{\\mathrm{NB}}(A \\mid Y=1) P(Y=1)}{P_{\\mathrm{NB}}(A)}$$\n在 NB 假设下，似然为 $P_{\\mathrm{NB}}(A \\mid Y=y) = P(X_1=1 \\mid Y=y) P(X_2=1 \\mid Y=y)$。\n\n所需的边缘条件概率 $P(X_i=1 \\mid Y=y)$ 没有直接给出。它们必须通过对潜变量 $Z$ 进行边缘化，从完整生成模型中推导出来：\n$$P(X_i=1 \\mid Y=y) = \\sum_{z \\in \\{0,1\\}} P(X_i=1 \\mid Y=y, Z=z) P(Z=z \\mid Y=y)$$\n\n我们计算这些边缘概率：\n$$P(X_1=1 \\mid Y=1) = (0.95)(0.7) + (0.30)(0.3) = 0.665 + 0.09 = 0.755$$\n$$P(X_2=1 \\mid Y=1) = (0.90)(0.7) + (0.25)(0.3) = 0.63 + 0.075 = 0.705$$\n$$P(X_1=1 \\mid Y=0) = (0.85)(0.2) + (0.10)(0.8) = 0.17 + 0.08 = 0.25$$\n$$P(X_2=1 \\mid Y=0) = (0.80)(0.2) + (0.05)(0.8) = 0.16 + 0.04 = 0.20$$\n\n现在，我们计算 NB 似然：\n$$P_{\\mathrm{NB}}(A \\mid Y=1) = P(X_1=1 \\mid Y=1)P(X_2=1 \\mid Y=1) = 0.755 \\times 0.705 = 0.532275$$\n$$P_{\\mathrm{NB}}(A \\mid Y=0) = P(X_1=1 \\mid Y=0)P(X_2=1 \\mid Y=0) = 0.25 \\times 0.20 = 0.05$$\n\n接下来，我们计算 NB 版贝叶斯定理的各项。\n联合概率 $P_{\\mathrm{NB}}(A, Y=1) = P_{\\mathrm{NB}}(A \\mid Y=1)P(Y=1) = 0.532275 \\times 0.4 = 0.21291$。\n联合概率 $P_{\\mathrm{NB}}(A, Y=0) = P_{\\mathrm{NB}}(A \\mid Y=0)P(Y=0) = 0.05 \\times 0.6 = 0.03$。\nNB 边缘证据是 $P_{\\mathrm{NB}}(A) = P_{\\mathrm{NB}}(A, Y=1) + P_{\\mathrm{NB}}(A, Y=0) = 0.21291 + 0.03 = 0.24291$。\n\nNB 后验概率是：\n$$P_{\\mathrm{NB}}(Y=1 \\mid A) = \\frac{0.21291}{0.24291} = \\frac{21291}{24291}$$\n通过将分子和分母除以它们的最大公约数 3 来化简此分数：\n$$P_{\\mathrm{NB}}(Y=1 \\mid A) = \\frac{7097}{8097}$$\n\n### 第 3 部分：计算乘性偏差因子\n\n乘性偏差因子是真实后验概率与 NB 后验概率之比：\n$$\\text{Bias Factor} = \\frac{P(Y=1 \\mid A)}{P_{\\mathrm{NB}}(Y=1 \\mid A)} = \\frac{207/277}{21291/24291}$$\n$$\\text{Bias Factor} = \\frac{207}{277} \\times \\frac{24291}{21291}$$\n我们可以使用 NB 后验概率的未化简分数，看看是否可以进行约分：\n$$\\text{Bias Factor} = \\frac{P(A, Y=1) / P(A)}{P_{\\mathrm{NB}}(A, Y=1) / P_{\\mathrm{NB}}(A)} = \\frac{0.2484 / 0.3324}{0.21291 / 0.24291}$$\n$$\\text{Bias Factor} = \\frac{2484}{3324} \\times \\frac{24291}{21291}$$\n最终结果为：\n$$\\text{Bias Factor} = \\frac{207}{277} \\times \\frac{24291}{21291} = \\frac{5028237}{5898507} = \\frac{1676079}{1965869}$$", "answer": "$$\\boxed{\\frac{1676079}{1965869}}$$", "id": "3184732"}, {"introduction": "统计学充满了看似矛盾的现象，辛普森悖论（Simpson's paradox）便是其中最著名的一个。该悖论指的是在分组数据中观察到的一种趋势，在将数据合并后却消失或逆转的现象。本练习将引导你构造一个这样的场景，让你亲手推导出现悖论的临界条件，从而深刻理解混杂变量（confounding variables）和数据聚合如何扭曲我们对事物之间真实关系的认知[@problem_id:3184667]。", "problem": "一个二元分类任务涉及一个二元特征 $X \\in \\{0,1\\}$、一个二元结果 $Y \\in \\{0,1\\}$ 和一个二元子组指示符 $Z \\in \\{0,1\\}$。在每个子组 $Z=z$ 内部，$X$ 和 $Y$ 之间的关联偏向于 $X=1$，即对于 $z=0$ 和 $z=1$ 两种情况，都有 $P(Y=1 \\mid X=1, Z=z)  P(Y=1 \\mid X=0, Z=z)$。具体来说，子组条件下的成功率如下：\n- 对于 $Z=1$：$P(Y=1 \\mid X=1, Z=1) = 0.62$ 且 $P(Y=1 \\mid X=0, Z=1) = 0.60$。\n- 对于 $Z=0$：$P(Y=1 \\mid X=1, Z=0) = 0.52$ 且 $P(Y=1 \\mid X=0, Z=0) = 0.50$。\n\n子组占比为 $P(Z=1) = 0.50$。子组内的特征倾向性为 $P(X=1 \\mid Z=1) = 0.20$ 和 $P(X=1 \\mid Z=0) = b$，其中 $b \\in [0,1]$ 是一个由您控制的未知设计参数。\n\n仅使用条件概率的定义、全概率定律和贝叶斯定理，通过对 $Z$ 进行适当的边缘化，推导出 $P(Y=1 \\mid X=1)$ 和 $P(Y=1 \\mid X=0)$ 作为 $b$ 的函数。然后，确定精确的阈值 $b^{\\star} \\in [0,1]$，在该值下 $X$ 和 $Y$ 之间的聚合关联发生逆转，即 $P(Y=1 \\mid X=1) = P(Y=1 \\mid X=0)$；对于 $b  b^{\\star}$，聚合关联表现出辛普森悖论的逆转，即 $P(Y=1 \\mid X=1)  P(Y=1 \\mid X=0)$，尽管在每个子组内部，$X=1$ 都具有更高的成功率。\n\n请以 $b^{\\star}$ 的精确封闭形式值给出您的最终答案。请勿四舍五入。", "solution": "首先验证问题，以确保其是自洽的、一致的且在科学上是合理的。\n\n### 步骤 1：提取已知条件\n问题为具有一个特征 $X \\in \\{0,1\\}$、一个结果 $Y \\in \\{0,1\\}$ 和一个子组指示符 $Z \\in \\{0,1\\}$ 的二元分类任务提供了以下数据和定义：\n- $Z=1$ 的子组条件成功率：\n  - $P(Y=1 \\mid X=1, Z=1) = 0.62$\n  - $P(Y=1 \\mid X=0, Z=1) = 0.60$\n- $Z=0$ 的子组条件成功率：\n  - $P(Y=1 \\mid X=1, Z=0) = 0.52$\n  - $P(Y=1 \\mid X=0, Z=0) = 0.50$\n- 子组占比：\n  - $P(Z=1) = 0.50$，这意味着 $P(Z=0) = 1 - 0.50 = 0.50$。\n- 子组内的特征倾向性：\n  - $P(X=1 \\mid Z=1) = 0.20$\n  - $P(X=1 \\mid Z=0) = b$，其中 $b \\in [0,1]$。\n- 目标：找到阈值 $b^{\\star}$，使得 $P(Y=1 \\mid X=1) = P(Y=1 \\mid X=0)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是概率论中一个定义明确的练习，具体涉及全概率定律、贝叶斯定理以及被称为辛普森悖论的统计现象。\n- **科学依据：** 该问题基于概率论的标准公理和定理。辛普森悖论是统计学中一个有充分记载的基本概念。\n- **良构性：** 所有必要的概率都已提供以定义该系统。目标是基于单个方程求解单个参数 $b$，预期在指定域 $b \\in [0,1]$ 内会产生唯一解。\n- **客观性：** 问题使用精确的数学符号和客观语言陈述，没有任何主观或模糊的断言。\n- **一致性：** 所提供的条件概率 $P(Y=1 \\mid X=x, Z=z)$ 都是 $[0,1]$ 内的有效概率。对于两个子组（$z=0$ 和 $z=1$），关联都是正向的：$P(Y=1 \\mid X=1, Z=z)  P(Y=1 \\mid X=0, Z=z)$。\n\n### 步骤 3：结论与行动\n该问题是有效的。将推导出完整的解法。\n\n目标是找到 $b$ 的值（记为 $b^{\\star}$），使得聚合成功率相等：$P(Y=1 \\mid X=1) = P(Y=1 \\mid X=0)$。为此，我们必须首先通过对子组变量 $Z$ 进行边缘化，将这两个条件概率表示为 $b$ 的函数。\n\n我们可以使用条件概率的定义 $P(A \\mid B) = \\frac{P(A, B)}{P(B)}$ 来求得 $P(Y=1 \\mid X=x)$。因此，我们需要计算联合概率 $P(Y=1, X=x)$ 和边缘概率 $P(X=x)$。\n\n首先，我们使用全概率定律，以 $Z$ 为条件计算 $X=1$ 的边缘概率：\n$$P(X=1) = P(X=1 \\mid Z=1)P(Z=1) + P(X=1 \\mid Z=0)P(Z=0)$$\n代入给定值：\n$$P(X=1) = (0.20)(0.50) + (b)(0.50) = 0.10 + 0.50b$$\n$X=0$ 的概率是其补集：\n$$P(X=0) = 1 - P(X=1) = 1 - (0.10 + 0.50b) = 0.90 - 0.50b$$\n\n接下来，我们通过对 $Z$ 进行边缘化来计算联合概率 $P(Y=1, X=1)$：\n$$P(Y=1, X=1) = P(Y=1, X=1 \\mid Z=1)P(Z=1) + P(Y=1, X=1 \\mid Z=0)P(Z=0)$$\n使用条件概率的链式法则，$P(A,B \\mid C) = P(A \\mid B,C)P(B \\mid C)$：\n$$P(Y=1, X=1) = P(Y=1 \\mid X=1, Z=1)P(X=1 \\mid Z=1)P(Z=1) + P(Y=1 \\mid X=1, Z=0)P(X=1 \\mid Z=0)P(Z=0)$$\n代入给定值：\n$$P(Y=1, X=1) = (0.62)(0.20)(0.50) + (0.52)(b)(0.50) = 0.062 + 0.26b$$\n\n类似地，我们计算联合概率 $P(Y=1, X=0)$：\n$$P(Y=1, X=0) = P(Y=1 \\mid X=0, Z=1)P(X=0 \\mid Z=1)P(Z=1) + P(Y=1 \\mid X=0, Z=0)P(X=0 \\mid Z=0)P(Z=0)$$\n首先，我们求出 $X=0$ 所需的条件概率：\n$P(X=0 \\mid Z=1) = 1 - P(X=1 \\mid Z=1) = 1 - 0.20 = 0.80$\n$P(X=0 \\mid Z=0) = 1 - P(X=1 \\mid Z=0) = 1 - b$\n代入这些值和其他给定值：\n$$P(Y=1, X=0) = (0.60)(0.80)(0.50) + (0.50)(1-b)(0.50)$$\n$$P(Y=1, X=0) = 0.24 + 0.25(1-b) = 0.24 + 0.25 - 0.25b = 0.49 - 0.25b$$\n\n现在我们可以构建聚合条件概率：\n$$P(Y=1 \\mid X=1) = \\frac{P(Y=1, X=1)}{P(X=1)} = \\frac{0.062 + 0.26b}{0.10 + 0.50b}$$\n$$P(Y=1 \\mid X=0) = \\frac{P(Y=1, X=0)}{P(X=0)} = \\frac{0.49 - 0.25b}{0.90 - 0.50b}$$\n\n我们正在寻找使这两个表达式相等的阈值 $b^{\\star}$：\n$$\\frac{0.062 + 0.26b}{0.10 + 0.50b} = \\frac{0.49 - 0.25b}{0.90 - 0.50b}$$\n为求解 $b$，我们进行交叉相乘：\n$$(0.062 + 0.26b)(0.90 - 0.50b) = (0.49 - 0.25b)(0.10 + 0.50b)$$\n展开方程两边：\n左式：$(0.062)(0.90) - (0.062)(0.50b) + (0.26b)(0.90) - (0.26b)(0.50b) = 0.0558 - 0.031b + 0.234b - 0.13b^2$\n$$0.0558 + 0.203b - 0.13b^2$$\n右式：$(0.49)(0.10) + (0.49)(0.50b) - (0.25b)(0.10) - (0.25b)(0.50b) = 0.049 + 0.245b - 0.025b - 0.125b^2$\n$$0.049 + 0.22b - 0.125b^2$$\n令两个表达式相等：\n$$0.0558 + 0.203b - 0.13b^2 = 0.049 + 0.22b - 0.125b^2$$\n重新整理各项，得到一个 $ax^2+bx+c=0$ 形式的标准二次方程：\n$$(-0.13 + 0.125)b^2 + (0.203 - 0.22)b + (0.0558 - 0.049) = 0$$\n$$-0.005b^2 - 0.017b + 0.0068 = 0$$\n为了简化，我们可以将整个方程乘以 $-2000$：\n$$10b^2 + 34b - 13.6 = 0$$\n或者，为了使用整数计算，我们可以将原二次方程乘以 $-10000$：\n$$50b^2 + 170b - 68 = 0$$\n除以 $2$：\n$$25b^2 + 85b - 34 = 0$$\n我们使用求根公式 $b = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 来解这个关于 $b$ 的二次方程，其中 $A=25$, $B=85$, $C=-34$。\n$$b^{\\star} = \\frac{-85 \\pm \\sqrt{85^2 - 4(25)(-34)}}{2(25)}$$\n$$b^{\\star} = \\frac{-85 \\pm \\sqrt{7225 - 100(-34)}}{50}$$\n$$b^{\\star} = \\frac{-85 \\pm \\sqrt{7225 + 3400}}{50}$$\n$$b^{\\star} = \\frac{-85 \\pm \\sqrt{10625}}{50}$$\n为了简化平方根，我们找到 10625 的质因数：$10625 = 5^4 \\times 17 = 625 \\times 17$。\n因此，$\\sqrt{10625} = \\sqrt{625 \\times 17} = 25\\sqrt{17}$。\n将此代回 $b^{\\star}$ 的解中：\n$$b^{\\star} = \\frac{-85 \\pm 25\\sqrt{17}}{50}$$\n我们可以将分子和分母同除以它们的最大公约数 $5$：\n$$b^{\\star} = \\frac{-17 \\pm 5\\sqrt{17}}{10}$$\n这给出了两个可能的解：\n$$b_1 = \\frac{-17 - 5\\sqrt{17}}{10} \\quad \\text{和} \\quad b_2 = \\frac{-17 + 5\\sqrt{17}}{10}$$\n问题陈述了 $b \\in [0,1]$。\n第一个解 $b_1$ 显然是负数，因为分子中的两项都是负数。所以，$b_1$ 不是一个有效的解。\n对于第二个解 $b_2$，我们注意到 $\\sqrt{16}  \\sqrt{17}  \\sqrt{25}$，所以 $4  \\sqrt{17}  5$。\n分子约等于 $-17 + 5(4.123) = -17 + 20.615 = 3.615$。\n所以，$b_2 \\approx \\frac{3.615}{10} = 0.3615$，这在有效范围 $[0,1]$ 内。\n因此，精确的阈值为：\n$$b^{\\star} = \\frac{-17 + 5\\sqrt{17}}{10}$$\n这可以写作：\n$$b^{\\star} = \\frac{5\\sqrt{17} - 17}{10}$$\n对于 $b  b^{\\star}$，聚合关联发生逆转，产生辛普森悖论。", "answer": "$$\\boxed{\\frac{5\\sqrt{17} - 17}{10}}$$", "id": "3184667"}]}