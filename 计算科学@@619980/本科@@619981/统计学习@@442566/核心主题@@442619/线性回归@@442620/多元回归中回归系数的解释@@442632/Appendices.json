{"hands_on_practices": [{"introduction": "掌握多元回归系数解释的最好方法之一就是通过动手实践。我们将从一个基本但至关重要的问题开始：如果我们改变一个预测变量的度量单位（例如，将身高从厘米改为米），它的回归系数会发生什么变化？[@problem_id:3132949] 这个练习将引导你推导系数如何进行相应调整，以确保模型对任何个体的预测值保持不变。这个过程突显了一个核心原则：回归系数的大小与其单位直接相关，而模型的物理预测则必须是单位不变的。", "problem": "一位研究人员使用普通最小二乘法 (OLS) 拟合了一个多元线性回归模型，以建模拟收缩压与身高和年龄之间的函数关系。响应变量是收縮壓 $y$（单位：$\\mathrm{mmHg}$），预测变量是身高 $x_{1}$（单位：厘米）和年龄 $x_{2}$（单位：岁）。使用厘米作为身高单位的拟合模型是\n$$\ny \\;=\\; \\beta_{0} \\;+\\; \\beta_{1}\\,x_{1} \\;+\\; \\beta_{2}\\,x_{2} \\;+\\; \\varepsilon,\n$$\n其估计系数为\n$$\n\\hat{\\beta}_{0} \\;=\\; 50,\\quad \\hat{\\beta}_{1} \\;=\\; 0.12,\\quad \\hat{\\beta}_{2} \\;=\\; 0.7.\n$$\n然后，该研究人员决定使用米作为身高单位来报告结果，定义 $z_{1} \\equiv x_{1}/100$，并将模型写为\n$$\ny \\;=\\; \\gamma_{0} \\;+\\; \\gamma_{1}\\,z_{1} \\;+\\; \\gamma_{2}\\,x_{2} \\;+\\; \\varepsilon.\n$$\n任务：\n- 从多元线性回归模型的定义出发，并根据“对于同一个体，拟合预测值必须在测量单位改变时保持不变”的原则，推导当用 $z_{1} \\equiv x_{1}/100$ 替换 $x_{1}$ 时，系数如何变换。利用此结果计算 $\\hat{\\gamma}_{1}$ 的数值。\n- 对于一个身高为 $x_{1} = 180$ 厘米（即 $z_{1} = 1.80$ 米）、年龄为 $x_{2} = 50$ 岁的人，使用厘米和米两种表示方法计算拟合值 $\\hat{y}$，并验证它们是否相等。\n\n最终答案只需报告重新缩放后的斜率系数 $\\hat{\\gamma}_{1}$ 的值，不带单位。无需四舍五入。", "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知信息\n问题提供了以下信息：\n- 一个用于模拟收缩压 $y$（单位 mmHg）与身高 $x_{1}$（单位厘米）和年龄 $x_{2}$（单位岁）之间关系的多元线性回归模型：\n$$y \\;=\\; \\beta_{0} \\;+\\; \\beta_{1}\\,x_{1} \\;+\\; \\beta_{2}\\,x_{2} \\;+\\; \\varepsilon$$\n- 通过普通最小二乘法 (OLS) 得到的该模型的估计系数为：\n$$\n\\hat{\\beta}_{0} \\;=\\; 50,\\quad \\hat{\\beta}_{1} \\;=\\; 0.12,\\quad \\hat{\\beta}_{2} \\;=\\; 0.7\n$$\n- 提出了第二个模型，其中身高以米为单位（$z_{1}$），通过变换 $z_{1} \\equiv x_{1}/100$ 定义。该模型的形式为：\n$$y \\;=\\; \\gamma_{0} \\;+\\; \\gamma_{1}\\,z_{1} \\;+\\; \\gamma_{2}\\,x_{2} \\;+\\; \\varepsilon$$\n- 问题要求基于“拟合预测值 $\\hat{y}$ 必须对身高单位的变化保持不变”的原则，推导从系数 $(\\beta_{0}, \\beta_{1}, \\beta_{2})$ 到 $(\\gamma_{0}, \\gamma_{1}, \\gamma_{2})$ 的变换关系。\n- 必须计算 $\\hat{\\gamma}_{1}$ 的数值。\n- 必须对一个身高 $x_{1} = 180$ 厘米、年龄 $x_{2} = 50$ 岁的特定个体，验证拟合值的相等性。\n\n### 步骤 2：使用提取的已知信息进行验证\n该问题在科学上和数学上都是合理的。它涉及线性回归中一个标准的基本概念：预测变量的线性变换对回归系数的影响。前提条件一致，语言精确，设置合理，能够导出一个唯一且有意义的解。所提供的值在生物统计学背景下是合理的。该问题不违反任何无效性标准。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解题推导\n设第一个使用厘米作身高单位（$x_{1}$）的拟合模型为 $M_{1}$，第二个使用米作身高单位（$z_{1}$）的拟合模型为 $M_{2}$。\n\n模型 $M_{1}$ 预测的收縮压 $\\hat{y}$ 方程为：\n$$\n\\hat{y}_{M_1} = \\hat{\\beta}_{0} + \\hat{\\beta}_{1}x_{1} + \\hat{\\beta}_{2}x_{2}\n$$\n模型 $M_{2}$ 的预测值方程为：\n$$\n\\hat{y}_{M_2} = \\hat{\\gamma}_{0} + \\hat{\\gamma}_{1}z_{1} + \\hat{\\gamma}_{2}x_{2}\n$$\n问题中陈述的核心原则是，对于任何给定的个体，预测值必须与预测变量所使用的单位无关。这是一个物理不变性原则。因此，对于任何身高为 $x_{1}$（厘米）或 $z_{1}$（米）且年龄为 $x_{2}$ 的个体，预测值必须相等：\n$$\n\\hat{y}_{M_1} = \\hat{y}_{M_2}\n$$\n这意味着：\n$$\n\\hat{\\beta}_{0} + \\hat{\\beta}_{1}x_{1} + \\hat{\\beta}_{2}x_{2} = \\hat{\\gamma}_{0} + \\hat{\\gamma}_{1}z_{1} + \\hat{\\gamma}_{2}x_{2}\n$$\n我们已知 $x_{1}$ 和 $z_{1}$ 之间的关系：$z_{1} = x_{1}/100$，这等价于 $x_{1} = 100z_{1}$。为了关联这些系数，我们将 $z_{1}$ 的定义代入等式的右边：\n$$\n\\hat{\\beta}_{0} + \\hat{\\beta}_{1}x_{1} + \\hat{\\beta}_{2}x_{2} = \\hat{\\gamma}_{0} + \\hat{\\gamma}_{1}\\left(\\frac{x_{1}}{100}\\right) + \\hat{\\gamma}_{2}x_{2}\n$$\n让我们重新排列右侧，按原始预测变量 $x_{1}$ 和 $x_{2}$ 对各项进行分组：\n$$\n\\hat{\\beta}_{0} + \\hat{\\beta}_{1}x_{1} + \\hat{\\beta}_{2}x_{2} = \\hat{\\gamma}_{0} + \\left(\\frac{\\hat{\\gamma}_{1}}{100}\\right)x_{1} + \\hat{\\gamma}_{2}x_{2}\n$$\n为使此恒等式对预测变量 $x_{1}$ 和 $x_{2}$ 的所有可能值都成立，等式两边对应项的系数必须相等。这是多项式系数相等原理的直接应用。\n\n通过比较常数项（截距），我们发现：\n$$\n\\hat{\\beta}_{0} = \\hat{\\gamma}_{0}\n$$\n通过比较 $x_{1}$ 项的系数，我们发现：\n$$\n\\hat{\\beta}_{1} = \\frac{\\hat{\\gamma}_{1}}{100}\n$$\n通过比较 $x_{2}$ 项的系数，我们发现：\n$$\n\\hat{\\beta}_{2} = \\hat{\\gamma}_{2}\n$$\n从第二个等式中，我们可以解出 $\\hat{\\gamma}_{1}$：\n$$\n\\hat{\\gamma}_{1} = 100 \\cdot \\hat{\\beta}_{1}\n$$\n使用给定的数值 $\\hat{\\beta}_{1} = 0.12$，我们计算 $\\hat{\\gamma}_{1}$：\n$$\n\\hat{\\gamma}_{1} = 100 \\cdot 0.12 = 12\n$$\n以米为单位的模型中的其他系数是 $\\hat{\\gamma}_{0} = \\hat{\\beta}_{0} = 50$ 和 $\\hat{\\gamma}_{2} = \\hat{\\beta}_{2} = 0.7$。\n\n### 验证\n现在我们来验证，对于一个身高 $x_{1} = 180$ 厘米、年龄 $x_{2} = 50$ 岁的个体，其拟合值 $\\hat{y}$ 是否相同。相应的身高（米）为 $z_{1} = 180 / 100 = 1.80$ 米。\n\n使用第一个模型（厘米）：\n$$\n\\hat{y}_{M_1} = \\hat{\\beta}_{0} + \\hat{\\beta}_{1}x_{1} + \\hat{\\beta}_{2}x_{2} = 50 + (0.12)(180) + (0.7)(50)\n$$\n$$\n\\hat{y}_{M_1} = 50 + 21.6 + 35 = 106.6\n$$\n使用第二个模型（米）：\n$$\n\\hat{y}_{M_2} = \\hat{\\gamma}_{0} + \\hat{\\gamma}_{1}z_{1} + \\hat{\\gamma}_{2}x_{2} = 50 + (12)(1.80) + (0.7)(50)\n$$\n$$\n\\hat{y}_{M_2} = 50 + 21.6 + 35 = 106.6\n$$\n预测值完全相同，$\\hat{y}_{M_1} = \\hat{y}_{M_2} = 106.6$，这验证了我们推导的系数变换是正确的。问题要求的是 $\\hat{\\gamma}_{1}$ 的数值。", "answer": "$$\n\\boxed{12}\n$$", "id": "3132949"}, {"introduction": "虽然单位换算的影响是直接的，但加入其它相关联的预测变量可能会带来令人惊讶甚至违反直觉的结果。这个练习探讨了统计学中的“抑制效应”（suppression effect）：一个与响应变量呈正相关的预测变量，在模型中控制了另一个变量后，其回归系数却可能变为负值。[@problem_id:3132937] 通过从协方差和最小二乘法的基本原理出发推导系数，你将深入理解“在所有其他变量保持不变的情况下”这一解释的真正含义，并揭示了为何必须考虑预测变量之间的相互关系。", "problem": "考虑一个总体，其中预测变量对 $\\{x_{1}, x_{2}\\}$ 和响应变量 $y$ 联合分布且具有有限二阶矩。预测变量经过标准化，使得 $\\operatorname{E}[x_{1}] = \\operatorname{E}[x_{2}] = 0$ 且 $\\operatorname{Var}(x_{1}) = \\operatorname{Var}(x_{2}) = 1$。假设预测变量是正相关的，$\\operatorname{Cov}(x_{1}, x_{2}) = \\rho$，其中 $0  \\rho  1$，并且响应变量的均值为零，$\\operatorname{E}[y] = 0$。对该总体的经验研究得到以下协方差：$\\operatorname{Cov}(x_{1}, y) = 0.2$ 和 $\\operatorname{Cov}(x_{2}, y) = 0.8$。\n\n我们通过普通最小二乘法 (OLS) 拟合多元线性模型 $y = \\beta_{0} + \\beta_{1} x_{1} + \\beta_{2} x_{2} + \\varepsilon$，这被解释为将 $y$ 线性投影到由 $\\{x_{1}, x_{2}\\}$ 张成的空间上，以最小化期望残差平方。从协方差、方差和线性投影的最小二乘最优性（正规方程）的基本定义出发，推导系数 $\\beta_{1}$ 作为 $\\rho$ 的函数，然后在 $\\rho = 0.9$ 时计算其值。在你的推导中，请阐明为什么 $x_{1}$ 和 $y$ 之间的正边际关联并不排除在控制了 $x_{2}$ 后出现负的偏系数 $\\beta_{1}$（抑制效应），并使用正交投影从几何角度解释这种符号反转。\n\n计算 $\\rho = 0.9$ 时 $\\beta_{1}$ 的数值，并将答案四舍五入到四位有效数字。该系数不需要单位。", "solution": "问题要求推导一个多元回归系数，解释抑制效应，并进行数值计算。我们首先验证问题陈述的有效性。\n\n### 问题有效性验证\n该问题在理论统计学和线性模型的框架内是良定义的。\n**已知条件：**\n- 预测变量 $\\{x_{1}, x_{2}\\}$ 和响应变量 $y$ 是具有有限二阶矩的随机变量。\n- $\\operatorname{E}[x_{1}] = 0$, $\\operatorname{E}[x_{2}] = 0$, $\\operatorname{E}[y] = 0$。\n- $\\operatorname{Var}(x_{1}) = 1$, $\\operatorname{Var}(x_{2}) = 1$。\n- $\\operatorname{Cov}(x_{1}, x_{2}) = \\rho$，其中 $0  \\rho  1$。\n- $\\operatorname{Cov}(x_{1}, y) = 0.2$。\n- $\\operatorname{Cov}(x_{2}, y) = 0.8$。\n- 模型为 $y = \\beta_{0} + \\beta_{1} x_{1} + \\beta_{2} x_{2} + \\varepsilon$，通过普通最小二乘法 (OLS) 拟合。\n\n**有效性验证：**\n1.  **科学上成立：** 问题使用了期望、方差、协方差和普通最小二乘回归等标准、成熟的概念。所有前提都与统计理论一致。\n2.  **良态问题：** 问题提供了确定 OLS 系数 $\\beta_{1}$ 和 $\\beta_{2}$ 所需的所有信息（协方差和方差）。条件 $0  \\rho  1$ 确保了预测变量之间不是完全共线性的，从而保证了解的唯一性。\n3.  **客观性：** 问题以精确的数学语言陈述，并要求进行形式化推导和数值计算。\n\n该问题被认为是有效且自洽的。\n\n### 系数 $\\beta_{1}$ 的推导\nOLS 过程旨在最小化期望残差平方，$S = \\operatorname{E}[\\varepsilon^2] = \\operatorname{E}[(y - \\beta_{0} - \\beta_{1} x_{1} - \\beta_{2} x_{2})^2]$。\n\n首先，我们确定截距 $\\beta_{0}$。对模型方程取期望：\n$$ \\operatorname{E}[y] = \\operatorname{E}[\\beta_{0} + \\beta_{1} x_{1} + \\beta_{2} x_{2} + \\varepsilon] = \\beta_{0} + \\beta_{1} \\operatorname{E}[x_{1}] + \\beta_{2} \\operatorname{E}[x_{2}] + \\operatorname{E}[\\varepsilon] $$\n根据 OLS 的构造，它确保了残差的期望值为零，即 $\\operatorname{E}[\\varepsilon] = 0$。利用给定的零均值条件，我们有：\n$$ 0 = \\beta_{0} + \\beta_{1}(0) + \\beta_{2}(0) + 0 $$\n这意味着 $\\beta_{0} = 0$。模型简化为 $y = \\beta_{1} x_{1} + \\beta_{2} x_{2} + \\varepsilon$。\n\n最小化 $S = \\operatorname{E}[(y - \\beta_{1} x_{1} - \\beta_{2} x_{2})^2]$ 导出了正规方程，即残差向量必须与每个预测变量向量正交。用期望表示，即 $\\operatorname{E}[\\varepsilon x_{1}] = 0$ 和 $\\operatorname{E}[\\varepsilon x_{2}] = 0$。\n$$ \\operatorname{E}[(y - \\beta_{1} x_{1} - \\beta_{2} x_{2})x_{1}] = 0 \\implies \\operatorname{E}[yx_{1}] - \\beta_{1} \\operatorname{E}[x_{1}^2] - \\beta_{2} \\operatorname{E}[x_{1}x_{2}] = 0 $$\n$$ \\operatorname{E}[(y - \\beta_{1} x_{1} - \\beta_{2} x_{2})x_{2}] = 0 \\implies \\operatorname{E}[yx_{2}] - \\beta_{1} \\operatorname{E}[x_{1}x_{2}] - \\beta_{2} \\operatorname{E}[x_{2}^2] = 0 $$\n鉴于所有变量的均值为零，乘积的期望等于协方差，平方的期望等于方差：\n- $\\operatorname{E}[yx_{1}] = \\operatorname{Cov}(x_{1}, y) = 0.2$\n- $\\operatorname{E}[yx_{2}] = \\operatorname{Cov}(x_{2}, y) = 0.8$\n- $\\operatorname{E}[x_{1}^2] = \\operatorname{Var}(x_{1}) = 1$\n- $\\operatorname{E}[x_{2}^2] = \\operatorname{Var}(x_{2}) = 1$\n- $\\operatorname{E}[x_{1}x_{2}] = \\operatorname{Cov}(x_{1}, x_{2}) = \\rho$\n\n将这些值代入正规方程，得到关于 $\\beta_{1}$ 和 $\\beta_{2}$ 的以下线性方程组：\n$$ \\begin{cases} (1) \\quad 1 \\cdot \\beta_{1} + \\rho \\cdot \\beta_{2} = 0.2 \\\\ (2) \\quad \\rho \\cdot \\beta_{1} + 1 \\cdot \\beta_{2} = 0.8 \\end{cases} $$\n我们可以解这个方程组来求 $\\beta_{1}$。从方程 (1) 中，我们用 $\\beta_{1}$ 表示 $\\beta_{2}$：\n$$ \\beta_{2} = \\frac{0.2 - \\beta_{1}}{\\rho} $$\n将此代入方程 (2)：\n$$ \\rho \\beta_{1} + \\left( \\frac{0.2 - \\beta_{1}}{\\rho} \\right) = 0.8 $$\n两边乘以 $\\rho$（非零）以消去分母：\n$$ \\rho^2 \\beta_{1} + 0.2 - \\beta_{1} = 0.8 \\rho $$\n$$ \\beta_{1}(\\rho^2 - 1) = 0.8 \\rho - 0.2 $$\n$$ \\beta_{1} = \\frac{0.8 \\rho - 0.2}{\\rho^2 - 1} = \\frac{-(0.2 - 0.8 \\rho)}{-(1 - \\rho^2)} $$\n这就得到了 $\\beta_{1}$ 作为 $\\rho$ 的函数的表达式：\n$$ \\beta_{1} = \\frac{0.2 - 0.8 \\rho}{1 - \\rho^2} $$\n\n### 抑制效应与几何解释\n$x_{1}$ 和 $y$ 之间的边际关联由 $\\operatorname{Cov}(x_{1}, y) = 0.2$ 给出，是正的。然而，偏系数 $\\beta_{1}$ 可能是负的。这种现象是一种抑制效应。$\\beta_{1}$ 为负的条件是：\n$$ \\frac{0.2 - 0.8 \\rho}{1 - \\rho^2}  0 $$\n由于 $0  \\rho  1$，分母 $1 - \\rho^2$ 是正的。因此，$\\beta_{1}$ 的符号由分子决定：\n$$ 0.2 - 0.8 \\rho  0 \\implies 0.2  0.8 \\rho \\implies \\rho > \\frac{0.2}{0.8} = 0.25 $$\n所以，如果 $\\rho > 0.25$，尽管 $x_{1}$ 和 $y$ 之间存在正的边际协方差，但 $x_{1}$ 对 $y$ 的偏效应是负的。\n\n**概念解释：**\n系数 $\\beta_{1}$ 表示在保持 $x_{2}$ 不变的情况下，$x_{1}$ 每增加一个单位时 $y$ 的期望变化。预测变量 $x_{2}$ 与 $y$ 有很强的正相关性（$\\operatorname{Cov}(x_{2}, y) = 0.8$），并且 $x_{1}$ 也与 $x_{2}$ 正相关（$\\rho > 0$）。观测到的 $x_{1}$ 和 $y$ 之间的正相关性有一部分是通过 $x_{2}$ 中介的：$x_{1}$ 的增加与 $x_{2}$ 的增加相关，而 $x_{2}$ 的增加又与 $y$ 的强劲增加相关。多元回归“剔除”了这种间接效应的影响。如果通过 $x_{2}$ 的间接正相关性足够强（即 $\\rho$ 足够大），它就可能掩盖 $x_{1}$ 和 $y$ 之间潜在的负向直接关联。\n\n**几何解释：**\n在零均值随机变量的向量空间中，OLS 系数 $\\beta_{1}$ 可以通过正交投影来理解，正如 Frisch-Waugh-Lovell 定理所阐明的那样。系数 $\\beta_{1}$ 是 $y$ 对 $x_{1}$ 中与 $x_{2}$ 正交的部分的回归系数。令 $x_{1|2}$ 为 $x_{1}$ 对 $x_{2}$ 回归的残差：\n$$ x_{1|2} = x_{1} - \\frac{\\operatorname{Cov}(x_{1}, x_{2})}{\\operatorname{Var}(x_{2})} x_{2} = x_{1} - \\rho x_{2} $$\n那么 $\\beta_{1}$ 由 $y$ 对 $x_{1|2}$ 的简单回归给出：\n$$ \\beta_{1} = \\frac{\\operatorname{Cov}(y, x_{1|2})}{\\operatorname{Var}(x_{1|2})} $$\n分子是：\n$$ \\operatorname{Cov}(y, x_{1} - \\rho x_{2}) = \\operatorname{Cov}(y, x_{1}) - \\rho \\operatorname{Cov}(y, x_{2}) = 0.2 - \\rho(0.8) $$\n分母是：\n$$ \\operatorname{Var}(x_{1} - \\rho x_{2}) = \\operatorname{Var}(x_{1}) - 2\\rho \\operatorname{Cov}(x_{1}, x_{2}) + \\rho^2 \\operatorname{Var}(x_{2}) = 1 - 2\\rho(\\rho) + \\rho^2(1) = 1 - \\rho^2 $$\n因此，$\\beta_{1} = \\frac{0.2 - 0.8\\rho}{1 - \\rho^2}$，这证实了我们的推导。从几何上看，$\\beta_{1}$ 不是由向量 $y$ 在 $x_{1}$ 上的投影（该投影为正）决定的，而是由 $y$ 在向量 $x_{1|2}$（$x_{1}$ 中与 $x_{2}$ 正交的部分）上的投影决定的。如果 $\\rho$ 很大且为正，则向量 $x_{1}$ 和 $x_{2}$ 的方向接近。向量 $x_{1|2}$ 表示从 $\\rho x_{2}$ 变为 $x_{1}$ 所需的“修正量”。即使 $y$ 在 $x_{1}$ 上的投影是正的，它在这个“修正”向量上的投影也可能是负的。当 $y$ 受 $x_{2}$ 的强拉力（由于 $\\operatorname{Cov}(y, x_{2}) = 0.8$）占主导地位，以至于 $x_{1}$ 的残差部分所需的向量分量变为负值时，就会发生这种情况。\n\n### 数值计算\n我们计算 $\\rho = 0.9$ 时的 $\\beta_{1}$ 值：\n$$ \\beta_{1} = \\frac{0.2 - 0.8(0.9)}{1 - (0.9)^2} = \\frac{0.2 - 0.72}{1 - 0.81} = \\frac{-0.52}{0.19} $$\n$$ \\beta_{1} \\approx -2.736842... $$\n四舍五入到四位有效数字，我们得到 $\\beta_{1} = -2.737$。\n这个结果证实了抑制效应：当相关性很高时（$\\rho = 0.9$，大于 0.25），偏系数 $\\beta_{1}$ 确实是负的。", "answer": "$$\\boxed{-2.737}$$", "id": "3132937"}, {"introduction": "现在我们将注意力从连续变量转向分类变量。在使用虚拟变量（indicator variables）时，系数的解释严重依赖于基准或参考类别的选择。[@problem_id:3132938] 这个练习通过比较两种不同的基准类别设定，清晰地展示了虽然单个系数的数值会随着参考类别的改变而改变，但模型所蕴含的实际意义——即不同组别之间预测值的差异（或对比）——是保持不变的。掌握这一技能对于准确地解释和沟通涉及分类数据的模型结果至关重要。", "problem": "一个临床数据集使用多元线性回归进行建模，以研究以毫米汞柱（mmHg）为单位的收缩压如何依赖于药物类型和一个连续的基线风险评分。令结果变量表示为 $y$（mmHg）。有三个互斥的药物类别：$A$、$B$ 和 $C$。基线风险评分是一个连续预测变量，用 $x$ 表示（无量纲）。该模型包含一个截距项，但没有交互项。分类药物预测变量使用标准指示变量表示，在同一拟合模型的两种不同参数化中，基线类别的选择有所不同。\n\n参数化 $1$ 使用药物 $A$ 作为基线，并采用指示变量 $I(B)$ 和 $I(C)$。$I(B)=1$ 表示患者接受了药物 $B$，$I(B)=0$ 表示其他情况，对 $I(C)$ 的定义类似。拟合后的模型为\n$$\ny \\;=\\; b_{0} \\;+\\; b_{B}\\,I(B) \\;+\\; b_{C}\\,I(C) \\;+\\; \\gamma\\,x,\n$$\n估计出的系数为 $b_{0}=130$，$b_{B}=-6$，$b_{C}=9$ 和 $\\gamma=1.8$。\n\n参数化 $2$ 使用药物 $B$ 作为基线，并采用类似定义的指示变量 $I(A)$ 和 $I(C)$。拟合后的模型为\n$$\ny \\;=\\; a_{0} \\;+\\; a_{A}\\,I(A) \\;+\\; a_{C}\\,I(C) \\;+\\; \\gamma\\,x,\n$$\n估计出的系数为 $a_{0}=124$，$a_{A}=6$，$a_{C}=15$ 和 $\\gamma=1.8$。\n\n两种参数化都是通过对相同数据重新拟合相同模型得到的，使用了带有单个截距且无交互作用的标准指示编码，因此对于任何（药物, $x$）组合，它们产生相同的拟合值和预测值。\n\n从多元线性回归的定义和分类预测变量的指示变量构建出发，推导两种参数化下预测的类别均值，并正式论证哪个数值量决定了两个药物类别之间的对比。然后，对于特定的基线风险评分 $x=20$，计算药物 $C$ 和 $A$ 之间收缩压的预测对比，即 $y_{C}-y_{A}$，并报告其数值。以毫米汞柱（mmHg）为单位表示最终的对比。无需四舍五入；提供精确值。最后，解释为什么尽管某些单个系数的符号随基线选择而改变，但计算出的这个对比对于基线类别的选择是不变的。", "solution": "分析首先形式化两种指定参数化下的多元线性回归模型的结构。在此模型中，结果变量（收缩压 $y$）的期望值是连续预测变量（基线风险评分 $x$）和三水平分类预测变量（药物类型 $A$、$B$ 或 $C$）的线性函数。该模型不包含交互项，这意味着风险评分 $x$ 对 $y$ 的影响在所有药物类别中被假定为恒定的，并且任意两种药物效果的差异在所有 $x$ 值上也是恒定的。\n\n首先，我们分析参数化 $1$，其中药物 $A$ 作为基线类别。模型由下式给出：\n$$\n\\hat{y} = b_{0} + b_{B}I(B) + b_{C}I(C) + \\gamma x\n$$\n这里，$I(B)$ 是一个指示变量，如果药物是 $B$，则其值为 $1$，否则为 $0$。类似地，如果药物是 $C$，则 $I(C)$ 为 $1$，否则为 $0$。对于基线类别 $A$， $I(B)$ 和 $I(C)$ 均为 $0$。\n\n估计出的系数为 $b_{0}=130$，$b_{B}=-6$，$b_{C}=9$ 和 $\\gamma=1.8$。\n\n根据这个模型，我们可以将每个药物类别的预测平均收缩压表示为风险评分 $x$ 的函数：\n- 对于药物 $A$（$I(B)=0$, $I(C)=0$）：$\\hat{y}_{A}(x) = b_{0} + \\gamma x = 130 + 1.8x$\n- 对于药物 $B$（$I(B)=1$, $I(C)=0$）：$\\hat{y}_{B}(x) = b_{0} + b_{B} + \\gamma x = 130 - 6 + 1.8x = 124 + 1.8x$\n- 对于药物 $C$（$I(B)=0$, $I(C)=1$）：$\\hat{y}_{C}(x) = b_{0} + b_{C} + \\gamma x = 130 + 9 + 1.8x = 139 + 1.8x$\n\n在这种参数化中，截距 $b_{0}$ 代表当连续预测变量 $x$ 为零时，基线组（药物 $A$）的预测血压。系数 $b_{B}$ 代表药物 $B$ 和药物 $A$ 之间预测血压的差异，即 $\\hat{y}_{B}(x) - \\hat{y}_{A}(x) = -6$ mmHg。类似地，$b_{C}$ 是药物 $C$ 和药物 $A$ 之间的差异，即 $\\hat{y}_{C}(x) - \\hat{y}_{A}(x) = 9$ mmHg。\n\n接下来，我们分析参数化 $2$，其中药物 $B$ 作为基线类别。模型由下式给出：\n$$\n\\hat{y} = a_{0} + a_{A}I(A) + a_{C}I(C) + \\gamma x\n$$\n估计出的系数为 $a_{0}=124$，$a_{A}=6$，$a_{C}=15$ 和 $\\gamma=1.8$。\n\n每个药物类别的预测平均收缩压为：\n- 对于药物 $A$（$I(A)=1, I(C)=0$）：$\\hat{y}_{A}(x) = a_{0} + a_{A} + \\gamma x = 124 + 6 + 1.8x = 130 + 1.8x$\n- 对于药物 $B$（$I(A)=0, I(C)=0$）：$\\hat{y}_{B}(x) = a_{0} + \\gamma x = 124 + 1.8x$\n- 对于药物 $C$（$I(A)=0, I(C)=1$）：$\\hat{y}_{C}(x) = a_{0} + a_{C} + \\gamma x = 124 + 15 + 1.8x = 139 + 1.8x$\n\n正如预期的那样，由于两个模型代表了对相同数据的相同拟合关系，因此在两种参数化下，预测值（$\\hat{y}_{A}(x)$、$\\hat{y}_{B}(x)$ 和 $\\hat{y}_{C}(x)$）是相同的。\n\n决定两个药物类别之间对比的量是它们预测的平均结果的差异。例如，药物 $C$ 和 $A$ 之间的对比定义为 $\\hat{y}_{C}(x) - \\hat{y}_{A}(x)$。这个差异是一个可估量，意味着它的值对于非奇异参数化的特定选择（即基线类别的选择）是不变的。\n\n问题要求计算在基线风险评分为 $x=20$ 时，药物 $C$ 和 $A$ 之间收缩压的预测对比的数值，记为 $y_{C}-y_{A}$。我们可以使用任一参数化来计算这个值。\n\n使用参数化 $1$：\n该对比直接由系数 $b_{C}$ 给出，它代表类别 $C$ 和基线类别 $A$ 之间的差异。\n$$\n\\hat{y}_{C}(x) - \\hat{y}_{A}(x) = (b_{0} + b_{C} + \\gamma x) - (b_{0} + \\gamma x) = b_{C}\n$$\n这个对比的值是 $b_{C} = 9$。由于没有与 $x$ 的交互项，这个对比对于所有 $x$ 值都是恒定的。因此，对于 $x=20$，对比是 $9$ mmHg。\n\n使用参数化 $2$：\n该对比必须计算为定义类别 $C$ 和 $A$ 均值的系数线性组合之间的差异。\n$$\n\\hat{y}_{C}(x) - \\hat{y}_{A}(x) = (a_{0} + a_{C} + \\gamma x) - (a_{0} + a_{A} + \\gamma x) = a_{C} - a_{A}\n$$\n代入给定的系数值：\n$$\na_{C} - a_{A} = 15 - 6 = 9\n$$\n这证实了无论使用哪种参数化，对比都是 $9$ mmHg。该值也与 $x=20$ 的具体值无关。\n\n这个对比对于基线类别的选择之所以是不变的，是因为指示变量的系数总是表示与*当前*基线的比较。改变基线会改变参照点，从而改变系数值，但任意两个类别之间的根本差异保持不变。\n- 以 $A$ 为基线，$b_{C}$ 代表对比 $(C-A)$。\n- 以 $B$ 为基线，$a_{A}$ 代表 $(A-B)$，$a_{C}$ 代表 $(C-B)$。对比 $(C-A)$ 可以通过 $(C-B) - (A-B) = a_{C} - a_{A}$ 恢复。\n这些关系在代数上证明了不变性。例如，$a_{A} = \\hat{y}_A(x) - \\hat{y}_B(x) = (\\hat{y}_A(x) - \\hat{y}_A(x)) - (\\hat{y}_B(x) - \\hat{y}_A(x)) = 0 - b_{B} = -b_{B}$。确实，$6 = -(-6)$。同样地，$a_{C} = \\hat{y}_C(x) - \\hat{y}_B(x) = (\\hat{y}_C(x) - \\hat{y}_A(x)) - (\\hat{y}_B(x) - \\hat{y}_A(x)) = b_{C} - b_{B}$。确实，$15 = 9 - (-6)$。\n对比 $(C-A)$ 是一个可估函数，其估计是唯一的。像 $b_{C}$ 或 $a_{C}$ 这样的单个系数，如果不参考特定的模型参数化，它们本身不是可估量；它们的值和解释取决于所选的基线。在 $b_{B} = -6$ 与 $a_{A} = 6$ 中观察到的符号变化是颠倒比较方向的直接结果：$b_{B}$ 估计 $(B-A)$ 而 $a_{A}$ 估计 $(A-B)$，因此必然有 $a_{A} = -b_{B}$。药物 $A$ 和 $B$ 效果之间的根本差异被保留了下来。\n\n最终要求的值是药物 $C$ 和 $A$ 之间收缩压的预测对比，即 $9$ mmHg。", "answer": "$$\n\\boxed{9}\n$$", "id": "3132938"}]}