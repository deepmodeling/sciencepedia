{"hands_on_practices": [{"introduction": "本练习将从 F 检验最基本的应用入手：比较两个嵌套模型。通过利用残差平方和（RSS）手动计算 F 统计量，您将具体理解该检验如何量化添加新预测变量所带来的模型拟合优度提升。这项练习旨在巩固 F 检验的核心计算机制 [@problem_id:3130377]。", "problem": "一位数据分析师对同一个样本量为 $n=100$ 的数据集拟合了两个嵌套的多元线性回归模型，其响应变量为 $Y$，预测变量为 $X_{1},X_{2},X_{3},X_{4},X_{5}$。全模型为 $Y=\\beta_{0}+\\beta_{1}X_{1}+\\beta_{2}X_{2}+\\beta_{3}X_{3}+\\beta_{4}X_{4}+\\beta_{5}X_{5}+\\varepsilon$。简化模型施加了联合原假设 $H_{0}:\\beta_{2}=\\beta_{3}=0$，因此只包含预测变量 $X_{1},X_{4},X_{5}$ 以及截距项。\n\n统计软件报告了这两个拟合的以下结果：\n- 全模型残差自由度：$94$；残差平方和：$1800.0$。\n- 简化模型残差自由度：$96$；残差平方和：$1933.2$。\n- 对于移除了 $X_{2}$ 和 $X_{3}$ 的联合检验，软件显示 $p$ 值为 $3.46\\times 10^{-2}$。\n\n仅使用线性回归和假设检验的基本定义，通过组合给定的平方和与自由度，重构用于检验 $H_{0}:\\beta_{2}=\\beta_{3}=0$ 的偏 $F$ 统计量。然后，利用 $H_{0}$ 下 $F$ 分布的定义性质，来检验您计算出的统计量是否与报告的 $p$ 值一致。您最终提交的答案必须是 $F$ 统计量的值。将您的答案四舍五入到四位有效数字。", "solution": "该问题要求计算一个偏 $F$ 统计量，用于检验一个多元线性回归模型中部分系数的联合原假设。首先对问题的正确性和一致性进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 样本量：$n=100$\n- 全模型：$Y=\\beta_{0}+\\beta_{1}X_{1}+\\beta_{2}X_{2}+\\beta_{3}X_{3}+\\beta_{4}X_{4}+\\beta_{5}X_{5}+\\varepsilon$\n- 简化模型对应于原假设 $H_{0}:\\beta_{2}=\\beta_{3}=0$。\n- 全模型残差平方和：$RSS_{F} = 1800.0$\n- 全模型残差自由度：$df_{F} = 94$\n- 简化模型残差平方和：$RSS_{R} = 1933.2$\n- 简化模型残差自由度：$df_{R} = 96$\n- 联合检验报告的 $p$ 值：$3.46\\times 10^{-2}$\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它涉及线性回归中的标准假设检验。检查所提供数据的内部一致性。\n全模型有 $p=5$ 个预测变量。估计的参数数量为 $p+1=6$（包括截距项 $\\beta_0$）。全模型的残差自由度被正确地给出为 $df_{F} = n-(p+1) = 100 - (5+1) = 94$。\n简化模型排除了 $X_2$ 和 $X_3$，剩下 $3$ 个预测变量。估计的参数数量为 $3+1=4$。简化模型的残差自由度被正确地给出为 $df_{R} = n-(3+1) = 100 - 4 = 96$。\n原假设 $H_{0}:\\beta_{2}=\\beta_{3}=0$ 涉及约束 $q=2$ 个参数。这与自由度的差异是一致的：$q = df_{R} - df_{F} = 96 - 94 = 2$。\n简化（更受约束）模型的残差平方和必须大于全模型的残差平方和。给定的值 $RSS_{R} = 1933.2 > RSS_{F} = 1800.0$ 遵循这一原则。\n所有提供的信息都是自洽的、一致的，并且遵循线性回归分析的原则。因此，该问题是有效的。\n\n### 解答\n\n偏 $F$ 统计量用于通过将全模型与一个简化（嵌套）模型进行比较，来检验一部分预测变量的联合显著性。原假设 $H_{0}$ 假定一部分预测变量的系数全部为零。备择假设 $H_{A}$ 是这些系数中至少有一个不为零。\n\n$F$ 统计量的公式为：\n$$ F = \\frac{(RSS_{R} - RSS_{F}) / q}{RSS_{F} / df_{F}} $$\n其中：\n- $RSS_{R}$ 是简化模型的残差平方和。\n- $RSS_{F}$ 是全模型的残差平方和。\n- $q$ 是被检验的系数数量（即，从全模型中排除以创建简化模型的预测变量数量）。\n- $df_{F}$ 是全模型的残差自由度。\n\n根据问题陈述，我们有：\n- $RSS_{R} = 1933.2$\n- $RSS_{F} = 1800.0$\n- $df_{F} = 94$\n\n原假设 $H_{0}:\\beta_{2}=\\beta_{3}=0$ 下的约束数量为 $q=2$。这也可以通过两个模型残差自由度的差异来证实：$q = df_{R} - df_{F} = 96 - 94 = 2$。\n\n将给定值代入 $F$ 统计量的公式中：\n$$ F = \\frac{(1933.2 - 1800.0) / 2}{1800.0 / 94} $$\n首先，我们计算分子，它是每个约束下残差平方和的变化量：\n$$ \\frac{RSS_{R} - RSS_{F}}{q} = \\frac{133.2}{2} = 66.6 $$\n接下来，我们计算分母，它是来自全模型的残差均方（或无偏方差估计，$\\hat{\\sigma}^2$）：\n$$ \\frac{RSS_{F}}{df_{F}} = \\frac{1800.0}{94} \\approx 19.148936 $$\n现在，我们计算 $F$ 统计量：\n$$ F = \\frac{66.6}{1800.0 / 94} = \\frac{66.6 \\times 94}{1800.0} = \\frac{6260.4}{1800.0} = 3.478 $$\n将结果四舍五入到四位有效数字，得到 $3.478$。\n\n为了检查一致性，我们考虑原假设下该统计量的分布。$F$ 统计量服从自由度为 $q$ 和 $df_{F}$ 的 $F$ 分布，在本例中为 $F_{2, 94}$。$p$ 值是从该分布中观测到大于或等于我们计算出的统计量的值的概率：$p\\text{-value} = P(F_{2, 94} \\geq 3.478)$。\n使用统计软件或足够详细的 $F$ 分布表，可以验证在显著性水平 $\\alpha=0.05$ 下，$F_{2, 94}$ 分布的临界值约为 $3.10$。由于我们计算的统计量 $F = 3.478$ 大于此临界值，所以 $p$ 值必须小于 $0.05$。提供的 $p$ 值 $3.46 \\times 10^{-2} = 0.0346$ 确实小于 $0.05$，这证实了我们计算的 $F$ 统计量与软件输出一致。更精确的计算表明 $P(F_{2, 94} \\geq 3.478) \\approx 0.0346$，这与给定的 $p$ 值相匹配。因此，计算是正确的。\n\n$F$ 统计量的值，四舍五入到四位有效数字后为 $3.478$。", "answer": "$$\\boxed{3.478}$$", "id": "3130377"}, {"introduction": "为什么我们需要用 F 检验来评估分类变量，而不是仅仅看各个 t 检验的结果？本练习通过探索编码不变性这一概念来解答这个关键问题。您将亲眼看到，尽管单个系数的估计值及其 t 统计量会随着参考水平的改变而变化，但代表整个变量的预测变量组的 F 统计量却保持不变，这证明了 F 检验在为变量的整体显著性提供单一、明确的检验方面的威力 [@problem_id:3130441]。", "problem": "一个包含 $n=60$ 个观测值的数据集使用普通最小二乘法（OLS）进行分析。结果变量 $Y$ 被建模为一个中心化的连续协变量 $X$（含截距项）和一个具有三个水平 $A$、$B$ 和 $C$ 的分类因子 $G$ 的线性函数。在一个包含截距项、$X$ 和指示变量的全模型中，因子 $G$ 由两个指示变量表示。一个简化模型仅包含截距项和 $X$。\n\n使用了两种等价的 $G$ 编码方案：\n\n- 方案 S1（参考水平为 $A$）：分别为水平 $B$ 和 $C$ 设置指示变量 $I_{B}$ 和 $I_{C}$。\n- 方案 S2（参考水平为 $C$）：分别为水平 $A$ 和 $B$ 设置指示变量 $J_{A}$ 和 $J_{B}$。\n\n从模型拟合中，您获得了以下信息：\n\n- 简化模型（仅含截距项和 $X$）得到的残差平方和为 $RSS_{R}=820$，估计了 $p_{R}=2$ 个参数。\n- 全模型（含截距项、$X$ 和 $G$ 的两个指示变量）得到的残差平方和为 $RSS_{F}=760$，估计了 $p_{F}=4$ 个参数。\n- 在方案 S1 下，两个组指示变量的 OLS 估计值及其标准误为：$\\hat{\\beta}_{B}=-3.0$，标准误为 $1.8$；$\\hat{\\beta}_{C}=-1.5$，标准误为 $1.9$。\n- 在方案 S2 下，两个组指示变量的 OLS 估计值及其标准误为：$\\hat{\\gamma}_{A}=+1.5$，标准误为 $1.6$；$\\hat{\\gamma}_{B}=-1.5$，标准误为 $1.7$。\n\n任务：\n\n1) 仅使用一般线性模型的定义，判断改变 $G$ 的参考水平是否会改变全模型的拟合值或残差平方和，并解释这对将 $G$ 作为一个整体进行联合检验意味着什么。\n\n2) 计算在方案 S1 和 S2 下组指示变量的各个 $t$ 统计量，并说明它们是否随编码方式的改变而改变。\n\n3) 计算用于检验在给定截距项和 $X$ 的情况下 $G$ 无效应的原假设（即检验两个指示变量系数联合为零）的公共 $F$ 统计量的值。将您的最终数值答案四舍五入到四位有效数字。", "solution": "该问题经验证是自洽的，在线性模型理论上具有科学依据，且提法明确。所有提供的数据都是一致且足以完成任务的。\n\n### 任务 1：拟合值、RSS 的不变性及其对联合检验的启示\n\n一般线性模型用矩阵形式表示为 $\\mathbf{Y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}$，其中 $\\mathbf{Y}$ 是响应向量，$\\mathbf{X}$ 是设计矩阵，$\\boldsymbol{\\beta}$ 是参数向量，$\\boldsymbol{\\epsilon}$ 是误差向量。$\\boldsymbol{\\beta}$ 的普通最小二乘（OLS）估计量是 $\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{Y}$。拟合值向量由 $\\mathbf{Y}$ 在 $\\mathbf{X}$ 的列空间（记作 $C(\\mathbf{X})$）上的正交投影给出。该投影为 $\\hat{\\mathbf{Y}} = \\mathbf{X}\\hat{\\boldsymbol{\\beta}} = \\mathbf{X}(\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{Y} = \\mathbf{H}\\mathbf{Y}$，其中 $\\mathbf{H}$ 是投影矩阵，通常称为“帽子矩阵”。\n\n用于分类因子 $G$ 的两种编码方案 S1 和 S2，代表了对全模型的一种重新参数化。设方案 S1 的设计矩阵为 $\\mathbf{X}_1$，方案 S2 的设计矩阵为 $\\mathbf{X}_2$。\n对于 S1（参考水平 A），设计矩阵的列是 $[\\mathbf{1}, \\mathbf{X}_{\\text{cov}}, \\mathbf{I}_B, \\mathbf{I}_C]$，其中 $\\mathbf{1}$ 是代表截距项的全 1 向量，$\\mathbf{X}_{\\text{cov}}$ 是连续协变量 $X$ 的向量，$\\mathbf{I}_B, \\mathbf{I}_C$ 是水平 $B$ 和 $C$ 的指示向量。\n对于 S2（参考水平 C），设计矩阵的列是 $[\\mathbf{1}, \\mathbf{X}_{\\text{cov}}, \\mathbf{J}_A, \\mathbf{J}_B]$。\n\n指示向量之间通过恒等式 $\\mathbf{I}_A + \\mathbf{I}_B + \\mathbf{I}_C = \\mathbf{1}$ 相关联。这两种方案中使用的向量也直接相关：$\\mathbf{J}_A = \\mathbf{I}_A$ 和 $\\mathbf{J}_B = \\mathbf{I}_B$。\n在 S1 中，与因子 $G$ 相关联的子空间的基向量是 $\\{\\mathbf{I}_B, \\mathbf{I}_C\\}$（在有截距项的情况下），而在 S2 中是 $\\{\\mathbf{J}_A, \\mathbf{J}_B\\}$。我们来证明，当这些向量集与截距项和协变量结合时，它们张成相同的空间。\n列空间 $C(\\mathbf{X}_1)$ 的基向量是 $\\{\\mathbf{1}, \\mathbf{X}_{\\text{cov}}, \\mathbf{I}_B, \\mathbf{I}_C\\}$。\n列空间 $C(\\mathbf{X}_2)$ 的基向量是 $\\{\\mathbf{1}, \\mathbf{X}_{\\text{cov}}, \\mathbf{J}_A, \\mathbf{J}_B\\}$。\n我们可以用 S1 的基向量来表示 S2 的基向量：\n$\\mathbf{J}_A = \\mathbf{I}_A = \\mathbf{1} - \\mathbf{I}_B - \\mathbf{I}_C$。\n$\\mathbf{J}_B = \\mathbf{I}_B$。\n由于 $C(\\mathbf{X}_2)$ 的每个基向量都是 $C(\\mathbf{X}_1)$ 基向量的线性组合，因此 $C(\\mathbf{X}_2) \\subseteq C(\\mathbf{X}_1)$。同样，我们可以用 S2 的基来表示 S1 的基向量：\n$\\mathbf{I}_C = \\mathbf{1} - \\mathbf{I}_A - \\mathbf{I}_B = \\mathbf{1} - \\mathbf{J}_A - \\mathbf{J}_B$。\n$\\mathbf{I}_B = \\mathbf{J}_B$。\n这表明 $C(\\mathbf{X}_1) \\subseteq C(\\mathbf{X}_2)$。\n因此，列空间是相同的：$C(\\mathbf{X}_1) = C(\\mathbf{X}_2)$。\n\n由于列空间相同，两种方案的投影矩阵 $\\mathbf{H}$ 也是相同的。因此，拟合值 $\\hat{\\mathbf{Y}} = \\mathbf{H}\\mathbf{Y}$ 不因参考水平的选择而改变。因此，残差向量 $\\mathbf{e} = \\mathbf{Y} - \\hat{\\mathbf{Y}}$ 也是不变的。所以，残差平方和 $RSS_F = \\mathbf{e}^T\\mathbf{e}$ 不会因为重新参数化而改变。问题陈述通过提供单个值 $RSS_{F}=760$ 证实了这一点。\n\n这种不变性对于 $G$ 的联合检验至关重要。用于检验代表 $G$ 的变量块显著性的 $F$ 检验，比较了全模型（含 $G$）和简化模型（不含 $G$）。$F$ 统计量是 $RSS_R$、$RSS_F$、$n$、$p_R$ 和 $p_F$ 的函数。由于这些量都不依赖于为全模型选择的具体编码方案，因此对于联合原假设 $H_0: \\beta_B = \\beta_C = 0$（在 S1下）或 $H_0: \\gamma_A = \\gamma_B = 0$（在 S2下）所得的 $F$ 统计量将是相同的。联合检验为因子 $G$ 对模型的整体贡献提供了一个明确的评估。\n\n### 任务 2：单个 t 统计量\n\n系数估计值 $\\hat{\\beta}$ 的 $t$ 统计量计算公式为 $t = \\frac{\\hat{\\beta}}{SE(\\hat{\\beta})}$。\n\n对于方案 S1（参考水平 A）：\n指示变量 $I_B$ 的 $t$ 统计量为：\n$$ t_{B, S1} = \\frac{\\hat{\\beta}_{B}}{SE(\\hat{\\beta}_{B})} = \\frac{-3.0}{1.8} = -1.666... $$\n指示变量 $I_C$ 的 $t$ 统计量为：\n$$ t_{C, S1} = \\frac{\\hat{\\beta}_{C}}{SE(\\hat{\\beta}_{C})} = \\frac{-1.5}{1.9} \\approx -0.78947... $$\n\n对于方案 S2（参考水平 C）：\n指示变量 $J_A$ 的 $t$ 统计量为：\n$$ t_{A, S2} = \\frac{\\hat{\\gamma}_{A}}{SE(\\hat{\\gamma}_{A})} = \\frac{+1.5}{1.6} = 0.9375 $$\n指示变量 $J_B$ 的 $t$ 统计量为：\n$$ t_{B, S2} = \\frac{\\hat{\\gamma}_{B}}{SE(\\hat{\\gamma}_{B})} = \\frac{-1.5}{1.7} \\approx -0.88235... $$\n\n单个 $t$ 统计量显然随编码方案的改变而改变。这是因为它们检验的是不同的假设。例如，$t_{B, S1}$ 检验的是组 $B$ 的平均响应是否与参考组 $A$ 不同，而 $t_{B, S2}$ 检验的是组 $B$ 是否与参考组 $C$ 不同。\n\n### 任务 3：公共的 F 统计量\n\n用于检验一个系数块为零的原假设的 $F$ 统计量，是通过比较全模型（$RSS_F$）和简化模型（$RSS_R$）的残差平方和来计算的。其公式为：\n$$ F = \\frac{(RSS_R - RSS_F) / (p_F - p_R)}{RSS_F / (n - p_F)} $$\n其中 $p_F$ 和 $p_R$ 分别是全模型和简化模型中的参数数量，$n$ 是观测值的数量。\n\n已知条件如下：\n- 简化模型的 RSS：$RSS_{R} = 820$\n- 全模型的 RSS：$RSS_{F} = 760$\n- 简化模型中的参数数量：$p_{R} = 2$（截距项和 $X$）\n- 全模型中的参数数量：$p_{F} = 4$（截距项、$X$ 和 $G$ 的两个指示变量）\n- 观测值数量：$n = 60$\n\n被检验的参数数量（即 $G$ 的指示变量数量）是 $p_F - p_R = 4 - 2 = 2$。\n分子的自由度是 $df_1 = p_F - p_R = 2$。\n分母的自由度是 $df_2 = n - p_F = 60 - 4 = 56$。\n\n将这些值代入公式：\n$$ F = \\frac{(820 - 760) / (4 - 2)}{760 / (60 - 4)} $$\n$$ F = \\frac{60 / 2}{760 / 56} $$\n$$ F = \\frac{30}{760 / 56} $$\n$$ F = \\frac{30 \\times 56}{760} = \\frac{1680}{760} = \\frac{168}{76} = \\frac{42}{19} $$\n$$ F \\approx 2.2105263... $$\n\n四舍五入到四位有效数字，其值为 $2.211$。\n这个 $F$ 统计量检验的是因子 $G$ 无效应的原假设，即其两个指示变量的系数联合为零。如任务 1 中所述，该值不因参考水平的选择而改变。", "answer": "$$\\boxed{2.211}$$", "id": "3130441"}, {"introduction": "F 检验的真正威力在于它能够检验关于模型系数的任何线性约束，而不仅仅是检验它们是否为零。这项高级练习要求您将复杂的假设（例如系数之间的关系）形式化为矩阵方程。通过推导并应用通用的 F 统计量公式，您将掌握一个能够对模型参数提出更精细问题的强大工具 [@problem_id:3130426]。", "problem": "一位研究人员拟合了一个带有截距的普通最小二乘（OLS）多元线性回归模型，用四个特征来预测一个响应变量。该模型为通用线性模型\n$$\n\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}, \\quad \\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^{2}\\mathbf{I}_{n}),\n$$\n其中 $\\mathbf{X}$ 具有满列秩，$\\boldsymbol{\\beta} = (\\beta_{0}, \\beta_{1}, \\beta_{2}, \\beta_{3}, \\beta_{4})^{\\top}$ 包含一个截距 $\\beta_{0}$ 和四个斜率系数， $n$ 是样本量。OLS 估计值为 $\\widehat{\\boldsymbol{\\beta}}$，并且从拟合模型中得到的残差平方和（RSS）是已知的。\n\n您希望检验施加了三个线性约束的联合原假设：\n(i) $H_{0}^{(1)}\\!:\\,\\beta_{2}/\\beta_{3} = 1$,\n(ii) $H_{0}^{(2)}\\!:\\,\\beta_{1} + \\beta_{4} = 0$,\n(iii) $H_{0}^{(3)}\\!:\\,\\beta_{0} = 0$.\n\n1) 将比率约束 $H_{0}^{(1)}$ 重写为齐次线性约束，并将所有三个约束整合为矩阵形式 $H_{0}: \\mathbf{R}\\boldsymbol{\\beta} = \\mathbf{0}$，其中 $\\mathbf{R}$ 是一个 $q \\times p$ 矩阵，且 $q = 3$，$p = 5$。\n\n2) 在标准通用线性模型的假设下，从第一性原理出发，推导用于检验 $H_{0}: \\mathbf{R}\\boldsymbol{\\beta} = \\mathbf{0}$ 的费雪-斯内德克（Fisher-Snedecor）$F$ 检验统计量的表达式，该表达式完全用 $\\widehat{\\boldsymbol{\\beta}}$、$\\mathbf{R}$、$(\\mathbf{X}^{\\top}\\mathbf{X})^{-1}$、完整模型的 RSS 以及样本量 $n$ 来表示。\n\n3) 使用以下拟合模型的输出，数值计算 $F$ 统计量：\n$$\n\\widehat{\\boldsymbol{\\beta}} = \\begin{pmatrix} 2.0 \\\\ -0.5 \\\\ 0.8 \\\\ 0.75 \\\\ 0.3 \\end{pmatrix}, \\quad\n(\\mathbf{X}^{\\top}\\mathbf{X})^{-1} = \\begin{pmatrix}\n0.10  0  0  0  0 \\\\\n0  0.05  0  0  0 \\\\\n0  0  0.04  0  0 \\\\\n0  0  0  0.04  0 \\\\\n0  0  0  0  0.09\n\\end{pmatrix},\n$$\n样本量 $n = 100$，完整模型的残差平方和 $\\mathrm{RSS}_{\\text{full}} = 180$。\n\n将您的最终数值答案四舍五入到四位有效数字。", "solution": "该问题要求一个三部分的解答，涉及对多元线性回归模型系数的一组线性约束进行 $F$ 检验的公式化和计算。\n\n首先，我将验证问题陈述的有效性。该问题提供了一个标准通用线性模型的设置：$\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}$，其中误差项为高斯分布 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^{2}\\mathbf{I}_{n})$。它指定了预测变量的数量（4个）并包含一个截距，使得参数向量 $\\boldsymbol{\\beta}$ 的维度为 $p=5$。待检验的约束已给出，同时提供了拟合模型的所有必要数值：估计的系数向量 $\\widehat{\\boldsymbol{\\beta}}$、矩阵 $(\\mathbf{X}^{\\top}\\mathbf{X})^{-1}$、样本量 $n$ 以及残差平方和 $\\mathrm{RSS}_{\\text{full}}$。任务是将约束形式化，推导 $F$ 统计量的一般公式，然后计算其值。该问题在统计理论上具有科学依据，问题设定良好、客观且自洽。所提供的数据在数值上是一致的，足以得出一个唯一解。$(\\mathbf{X}^{\\top}\\mathbf{X})^{-1}$ 为对角矩阵这一简化意味着设计矩阵 $\\mathbf{X}$ 的列是正交的（如果存在截距，则在中心化之后），这是一个特殊但有效的情况。因此，该问题是有效的。\n\n第 1 部分：将原假设形式化为矩阵形式。\n原假设包含对参数向量 $\\boldsymbol{\\beta} = (\\beta_{0}, \\beta_{1}, \\beta_{2}, \\beta_{3}, \\beta_{4})^{\\top}$ 的三个约束。我们需要将它们表示为一个齐次线性方程组 $\\mathbf{R}\\boldsymbol{\\beta} = \\mathbf{0}$，其中 $\\mathbf{R}$ 是一个 $q \\times p$ 矩阵，且 $q=3$，$p=5$。\n\n这三个约束是：\n(i) $H_{0}^{(1)}\\!:\\,\\beta_{2}/\\beta_{3} = 1$。假设 $\\beta_3 \\neq 0$，这等价于线性约束 $\\beta_2 - \\beta_3 = 0$。这可以写成向量积 $\\mathbf{r}_1^{\\top}\\boldsymbol{\\beta} = 0$，其中 $\\mathbf{r}_1^{\\top} = \\begin{pmatrix} 0  0  1  -1  0 \\end{pmatrix}$。\n(ii) $H_{0}^{(2)}\\!:\\,\\beta_{1} + \\beta_{4} = 0$。这已经是线性形式。它可以写成 $\\mathbf{r}_2^{\\top}\\boldsymbol{\\beta} = 0$，其中 $\\mathbf{r}_2^{\\top} = \\begin{pmatrix} 0  1  0  0  1 \\end{pmatrix}$。\n(iii) $H_{0}^{(3)}\\!:\\,\\beta_{0} = 0$。这也是一个线性约束，可以写成 $\\mathbf{r}_3^{\\top}\\boldsymbol{\\beta} = 0$，其中 $\\mathbf{r}_3^{\\top} = \\begin{pmatrix} 1  0  0  0  0 \\end{pmatrix}$。\n\n矩阵 $\\mathbf{R}$ 是通过堆叠这些行向量形成的。行的顺序是任意的；我们将使用所给出的顺序。\n$$\n\\mathbf{R} = \\begin{pmatrix} \\mathbf{r}_1^{\\top} \\\\ \\mathbf{r}_2^{\\top} \\\\ \\mathbf{r}_3^{\\top} \\end{pmatrix} = \\begin{pmatrix}\n0  0  1  -1  0 \\\\\n0  1  0  0  1 \\\\\n1  0  0  0  0\n\\end{pmatrix}\n$$\n这是一个 $3 \\times 5$ 的矩阵，因此按要求 $q=3$ 且 $p=5$。原假设为 $H_{0}: \\mathbf{R}\\boldsymbol{\\beta} = \\mathbf{0}$。\n\n第 2 部分：推导 $F$ 检验统计量。\n用于检验一般线性假设的 $F$ 检验，比较的是完整模型（full model）的残差平方和（$\\mathrm{RSS}_{\\text{full}}$）与在原假设约束下估计的简化模型（reduced model）的残差平方和（$\\mathrm{RSS}_{\\text{reduced}}$）。$F$ 统计量定义为：\n$$\nF = \\frac{(\\mathrm{RSS}_{\\text{reduced}} - \\mathrm{RSS}_{\\text{full}}) / q}{\\mathrm{RSS}_{\\text{full}} / (n-p)}\n$$\n其中 $q$ 是线性约束的数量（$\\mathbf{R}$ 中的行数），$n$ 是样本量，$p$ 是完整模型中的参数数量。分母 $\\hat{\\sigma}^2 = \\mathrm{RSS}_{\\text{full}} / (n-p)$ 是来自完整模型的误差方差 $\\sigma^2$ 的无偏估计量。\n\n我们的目标是用所提供的量来表示分子项 $\\mathrm{RSS}_{\\text{reduced}} - \\mathrm{RSS}_{\\text{full}}$。\n在通用线性模型的标准假设下，OLS 估计量 $\\widehat{\\boldsymbol{\\beta}}$ 服从正态分布：\n$$\n\\widehat{\\boldsymbol{\\beta}} \\sim \\mathcal{N}\\left(\\boldsymbol{\\beta}, \\sigma^2(\\mathbf{X}^{\\top}\\mathbf{X})^{-1}\\right)\n$$\n由此可知，线性组合 $\\mathbf{R}\\widehat{\\boldsymbol{\\beta}}$ 也服从正态分布：\n$$\n\\mathbf{R}\\widehat{\\boldsymbol{\\beta}} \\sim \\mathcal{N}\\left(\\mathbf{R}\\boldsymbol{\\beta}, \\mathbf{R}(\\sigma^2(\\mathbf{X}^{\\top}\\mathbf{X})^{-1})\\mathbf{R}^{\\top}\\right) = \\mathcal{N}\\left(\\mathbf{R}\\boldsymbol{\\beta}, \\sigma^2\\mathbf{R}(\\mathbf{X}^{\\top}\\mathbf{X})^{-1}\\mathbf{R}^{\\top}\\right)\n$$\n在原假设 $H_{0}: \\mathbf{R}\\boldsymbol{\\beta} = \\mathbf{0}$ 下，该分布的均值为 $\\mathbf{0}$。因此，与此多元正态向量相关的、并经 $\\sigma^2$ 缩放的二次型服从自由度为 $q$ 的卡方分布：\n$$\n\\frac{1}{\\sigma^2} (\\mathbf{R}\\widehat{\\boldsymbol{\\beta}})^{\\top} \\left[\\mathbf{R}(\\mathbf{X}^{\\top}\\mathbf{X})^{-1}\\mathbf{R}^{\\top}\\right]^{-1} (\\mathbf{R}\\widehat{\\boldsymbol{\\beta}}) \\sim \\chi_q^2\n$$\n线性模型理论中的一个基本结果指出，由于施加约束而导致的残差平方和的增加量恰好是这个二次型：\n$$\n\\mathrm{RSS}_{\\text{reduced}} - \\mathrm{RSS}_{\\text{full}} = (\\mathbf{R}\\widehat{\\boldsymbol{\\beta}})^{\\top} \\left[\\mathbf{R}(\\mathbf{X}^{\\top}\\mathbf{X})^{-1}\\mathbf{R}^{\\top}\\right]^{-1} (\\mathbf{R}\\widehat{\\boldsymbol{\\beta}})\n$$\n我们也知道，完整模型的经缩放的残差平方和服从卡方分布：\n$$\n\\frac{\\mathrm{RSS}_{\\text{full}}}{\\sigma^2} \\sim \\chi_{n-p}^2\n$$\n根据科克伦定理（Cochran's theorem），$\\mathrm{RSS}_{\\text{reduced}} - \\mathrm{RSS}_{\\text{full}}$ 和 $\\mathrm{RSS}_{\\text{full}}$ 的二次型是独立的。因此，这两个独立的卡方变量分别除以其自由度后的比率，构成一个服从 $F$ 分布的随机变量：\n$$\nF = \\frac{\\frac{1}{q\\sigma^2}(\\mathrm{RSS}_{\\text{reduced}} - \\mathrm{RSS}_{\\text{full}})}{\\frac{1}{(n-p)\\sigma^2}\\mathrm{RSS}_{\\text{full}}} = \\frac{\\left( (\\mathbf{R}\\widehat{\\boldsymbol{\\beta}})^{\\top} \\left[\\mathbf{R}(\\mathbf{X}^{\\top}\\mathbf{X})^{-1}\\mathbf{R}^{\\top}\\right]^{-1} (\\mathbf{R}\\widehat{\\boldsymbol{\\beta}}) \\right) / q}{ \\mathrm{RSS}_{\\text{full}} / (n-p) }\n$$\n这个表达式就是所求的 $F$ 统计量，完全由 $\\widehat{\\boldsymbol{\\beta}}$、$\\mathbf{R}$、$(\\mathbf{X}^{\\top}\\mathbf{X})^{-1}$、$\\mathrm{RSS}_{\\text{full}}$、$n$、$p$ 和 $q$ 表示。\n\n第 3 部分：数值计算 $F$ 统计量。\n我们已知：\n$n = 100$, $p = 5$, $q = 3$, $\\mathrm{RSS}_{\\text{full}} = 180$.\n$\\widehat{\\boldsymbol{\\beta}} = \\begin{pmatrix} 2.0 \\\\ -0.5 \\\\ 0.8 \\\\ 0.75 \\\\ 0.3 \\end{pmatrix}$ 且 $(\\mathbf{X}^{\\top}\\mathbf{X})^{-1} = \\mathrm{diag}(0.10, 0.05, 0.04, 0.04, 0.09)$.\n$\\mathbf{R} = \\begin{pmatrix} 0  0  1  -1  0 \\\\ 0  1  0  0  1 \\\\ 1  0  0  0  0 \\end{pmatrix}$.\n\n第 1 步：计算 $F$ 统计量的分母。\n$$ \\frac{\\mathrm{RSS}_{\\text{full}}}{n-p} = \\frac{180}{100-5} = \\frac{180}{95} \\approx 1.894737 $$\n\n第 2 步：计算分子项 $(\\mathrm{RSS}_{\\text{reduced}} - \\mathrm{RSS}_{\\text{full}})$。\n首先，计算 $\\mathbf{R}\\widehat{\\boldsymbol{\\beta}}$：\n$$ \\mathbf{R}\\widehat{\\boldsymbol{\\beta}} = \\begin{pmatrix} 0  0  1  -1  0 \\\\ 0  1  0  0  1 \\\\ 1  0  0  0  0 \\end{pmatrix} \\begin{pmatrix} 2.0 \\\\ -0.5 \\\\ 0.8 \\\\ 0.75 \\\\ 0.3 \\end{pmatrix} = \\begin{pmatrix} (1)(0.8)+(-1)(0.75) \\\\ (1)(-0.5)+(1)(0.3) \\\\ (1)(2.0) \\end{pmatrix} = \\begin{pmatrix} 0.05 \\\\ -0.2 \\\\ 2.0 \\end{pmatrix} $$\n接下来，计算矩阵 $\\mathbf{M} = \\mathbf{R}(\\mathbf{X}^{\\top}\\mathbf{X})^{-1}\\mathbf{R}^{\\top}$：\n$$\n\\begin{align*} \\mathbf{M} = \\begin{pmatrix} 0  0  1  -1  0 \\\\ 0  1  0  0  1 \\\\ 1  0  0  0  0 \\end{pmatrix} \\begin{pmatrix} 0.10  0  0  0  0 \\\\ 0  0.05  0  0  0 \\\\ 0  0  0.04  0  0 \\\\ 0  0  0  0.04  0 \\\\ 0  0  0  0  0.09 \\end{pmatrix} \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\\\ 1  0  0 \\\\ -1  0  0 \\\\ 0  1  0 \\end{pmatrix} \\\\\n= \\begin{pmatrix} 0  0  0.04  -0.04  0 \\\\ 0  0.05  0  0  0.09 \\\\ 0.10  0  0  0  0 \\end{pmatrix} \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\\\ 1  0  0 \\\\ -1  0  0 \\\\ 0  1  0 \\end{pmatrix} \\\\\n= \\begin{pmatrix} 0.04+0.04  0  0 \\\\ 0  0.05+0.09  0 \\\\ 0  0  0.10 \\end{pmatrix} = \\begin{pmatrix} 0.08  0  0 \\\\ 0  0.14  0 \\\\ 0  0  0.10 \\end{pmatrix}\\end{align*}\n$$\n然后，求逆矩阵 $\\mathbf{M}^{-1}$：\n$$ \\mathbf{M}^{-1} = \\begin{pmatrix} 1/0.08  0  0 \\\\ 0  1/0.14  0 \\\\ 0  0  1/0.10 \\end{pmatrix} = \\begin{pmatrix} 12.5  0  0 \\\\ 0  50/7  0 \\\\ 0  0  10 \\end{pmatrix} $$\n现在，计算二次型 $(\\mathbf{R}\\widehat{\\boldsymbol{\\beta}})^{\\top} \\mathbf{M}^{-1} (\\mathbf{R}\\widehat{\\boldsymbol{\\beta}})$：\n$$\n\\begin{align*}\n(\\mathrm{RSS}_{\\text{reduced}} - \\mathrm{RSS}_{\\text{full}}) = \\begin{pmatrix} 0.05  -0.2  2.0 \\end{pmatrix} \\begin{pmatrix} 12.5  0  0 \\\\ 0  50/7  0 \\\\ 0  0  10 \\end{pmatrix} \\begin{pmatrix} 0.05 \\\\ -0.2 \\\\ 2.0 \\end{pmatrix} \\\\\n= (0.05)^2(12.5) + (-0.2)^2(50/7) + (2.0)^2(10) \\\\\n= (0.0025)(12.5) + (0.04)(50/7) + (4)(10) \\\\\n= 0.03125 + 2/7 + 40 \\\\\n= 40.03125 + 0.285714... = 40.316964...\n\\end{align*}\n$$\n\n第 3 步：组合 $F$ 统计量。\n分子是 $(\\mathrm{RSS}_{\\text{reduced}} - \\mathrm{RSS}_{\\text{full}}) / q = 40.316964... / 3 \\approx 13.438988$。\n$$\nF = \\frac{13.438988...}{1.894737...} \\approx 7.09275\n$$\n四舍五入到四位有效数字，我们得到 $7.093$。\n让我们使用分数重新计算以确保精度。\n$\\mathrm{RSS}_{\\text{red}} - \\mathrm{RSS}_{\\text{full}} = \\frac{1}{32} + \\frac{2}{7} + 40 = \\frac{7+64}{224} + 40 = \\frac{71}{224} + \\frac{8960}{224} = \\frac{9031}{224}$。\n$$ F = \\frac{(9031/224)/3}{180/95} = \\frac{9031}{672} \\times \\frac{95}{180} = \\frac{857945}{120960} \\approx 7.092754629... $$\n四舍五入到四位有效数字，结果是 $7.093$。", "answer": "$$\n\\boxed{7.093}\n$$", "id": "3130426"}]}