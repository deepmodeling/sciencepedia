{"hands_on_practices": [{"introduction": "尽管平滑样条在理论上是在一个无限维函数空间中定义的，但其求解最终归结为解一个有限维的线性方程组。本练习将揭示这个方程组的特殊结构，这正是其计算效率的关键。通过推导其系数矩阵的带状性质 [@problem_id:3174213]，你将理解为何平滑样条能够被快速地拟合到大型数据集上，其计算复杂度仅为 $O(n)$。", "problem": "考虑在闭区间 $[a,b]$ 上的一组严格递增的设计点 $\\{x_{i}\\}_{i=1}^{n}$ 和观测到的响应值 $\\{y_{i}\\}_{i=1}^{n}$。将平滑样条估计量 $\\hat{f}$ 定义为在 $[a,b]$ 上的自然三次样条函数类中最小化惩罚经验风险的函数：\n$$\n\\sum_{i=1}^{n}\\big(y_{i}-f(x_{i})\\big)^{2}+\\lambda\\int_{a}^{b}\\big(f''(x)\\big)^{2}\\,dx\n$$\n其中 $\\lambda>0$ 是一个固定的平滑参数。使用自然三次样条基 $\\{B_{j}(x)\\}_{j=1}^{m}$（该基由一个包含不同点 $\\{x_{i}\\}$ 并满足自然边界条件 $f''(a)=f''(b)=0$ 的节点序列构建），并将 $f$ 表示为 $f(x)=\\sum_{j=1}^{m}\\theta_{j}B_{j}(x)$，其中系数向量为 $\\boldsymbol{\\theta}\\in\\mathbb{R}^{m}$。关于三次B样条基，以下经过充分验证的事实成立且可以使用：\n- 每个三次B样条基函数 $B_{j}$ 具有紧支集，最多跨越四个连续的节点区间。\n- 两个三次B样条基函数 $B_{j}$ 和 $B_{k}$ 的支集重叠，当且仅当 $|j-k|\\leq 3$。\n\n从这些基础出发，导出由最小化问题所蕴含的关于 $\\boldsymbol{\\theta}$ 的正规方程组，并确定系数矩阵的稀疏性和块结构，该结构使得带状求解的计算成本与 $n$ 呈线性关系。最后，确定最小的非负整数 $b$（半带宽），使得系数矩阵在宽度为 $2b+1$ 的中心带之外的元素均为零。\n\n你的最终答案必须是整数 $b$。无需四舍五入。", "solution": "问题要求解平滑样条估计量的正规方程组中系数矩阵的半带宽。我们首先用矩阵-向量表示法来形式化该问题，然后分析所得矩阵的结构。\n\n平滑样条估计量 $\\hat{f}$ 最小化惩罚经验风险：\n$$\nS(f) = \\sum_{i=1}^{n}\\big(y_{i}-f(x_{i})\\big)^{2}+\\lambda\\int_{a}^{b}\\big(f''(x)\\big)^{2}\\,dx\n$$\n函数 $f$ 表示为自然三次样条基函数 $\\{B_{j}(x)\\}_{j=1}^{m}$ 的线性组合：\n$$\nf(x) = \\sum_{j=1}^{m}\\theta_{j}B_{j}(x) = \\mathbf{B}(x)^T \\boldsymbol{\\theta}\n$$\n其中 $\\mathbf{B}(x) = (B_1(x), \\dots, B_m(x))^T$ 是基函数向量，$\\boldsymbol{\\theta} = (\\theta_1, \\dots, \\theta_m)^T$ 是系数向量。\n\n我们用 $\\boldsymbol{\\theta}$ 来表示目标函数 $S(f)$ 的两项。\n\n第一项是残差平方和 (RSS)。设 $\\mathbf{y} = (y_1, \\dots, y_n)^T$。函数 $f$ 在设计点 $x_i$ 处的值可以写成一个向量 $\\mathbf{f}_{\\mathbf{x}} = (f(x_1), \\dots, f(x_n))^T$。该向量可以表示为：\n$$\n\\mathbf{f}_{\\mathbf{x}} = \\mathbf{B} \\boldsymbol{\\theta}\n$$\n其中 $\\mathbf{B}$ 是 $n \\times m$ 的求值矩阵，其元素为 $B_{ij} = B_j(x_i)$。那么 RSS 项为：\n$$\n\\sum_{i=1}^{n}\\big(y_{i}-f(x_{i})\\big)^{2} = \\|\\mathbf{y} - \\mathbf{B}\\boldsymbol{\\theta}\\|_{2}^{2} = (\\mathbf{y} - \\mathbf{B}\\boldsymbol{\\theta})^T (\\mathbf{y} - \\mathbf{B}\\boldsymbol{\\theta})\n$$\n\n第二项是惩罚项，它依赖于 $f(x)$ 的二阶导数：\n$$\nf''(x) = \\frac{d^2}{dx^2} \\sum_{j=1}^{m}\\theta_{j}B_{j}(x) = \\sum_{j=1}^{m}\\theta_{j}B''_{j}(x)\n$$\n该积分可以写成：\n$$\n\\int_{a}^{b}\\big(f''(x)\\big)^{2}\\,dx = \\int_{a}^{b} \\left( \\sum_{j=1}^{m}\\theta_{j}B''_{j}(x) \\right) \\left( \\sum_{k=1}^{m}\\theta_{k}B''_{k}(x) \\right) dx = \\sum_{j=1}^{m}\\sum_{k=1}^{m} \\theta_j \\theta_k \\left( \\int_{a}^{b} B''_{j}(x) B''_{k}(x) dx \\right)\n$$\n这是 $\\boldsymbol{\\theta}$ 的一个二次型。我们定义一个 $m \\times m$ 的惩罚矩阵 $\\mathbf{\\Omega}$，其元素为：\n$$\n\\Omega_{jk} = \\int_{a}^{b} B''_{j}(x) B''_{k}(x) dx\n$$\n惩罚项可以写作 $\\boldsymbol{\\theta}^T \\mathbf{\\Omega} \\boldsymbol{\\theta}$。\n\n结合这两项，需要对 $\\boldsymbol{\\theta}$ 最小化的目标函数是：\n$$\nS(\\boldsymbol{\\theta}) = (\\mathbf{y} - \\mathbf{B}\\boldsymbol{\\theta})^T (\\mathbf{y} - \\mathbf{B}\\boldsymbol{\\theta}) + \\lambda \\boldsymbol{\\theta}^T \\mathbf{\\Omega} \\boldsymbol{\\theta}\n$$\n展开第一项得到 $S(\\boldsymbol{\\theta}) = \\mathbf{y}^T\\mathbf{y} - 2\\mathbf{y}^T\\mathbf{B}\\boldsymbol{\\theta} + \\boldsymbol{\\theta}^T\\mathbf{B}^T\\mathbf{B}\\boldsymbol{\\theta} + \\lambda \\boldsymbol{\\theta}^T \\mathbf{\\Omega} \\boldsymbol{\\theta}$。\n为了找到最小化器 $\\hat{\\boldsymbol{\\theta}}$，我们计算 $S(\\boldsymbol{\\theta})$ 关于 $\\boldsymbol{\\theta}$ 的梯度并将其设为零。\n$$\n\\nabla_{\\boldsymbol{\\theta}} S(\\boldsymbol{\\theta}) = -2\\mathbf{B}^T\\mathbf{y} + 2\\mathbf{B}^T\\mathbf{B}\\boldsymbol{\\theta} + 2\\lambda\\mathbf{\\Omega}\\boldsymbol{\\theta}\n$$\n将梯度设为 $\\mathbf{0}$：\n$$\n-2\\mathbf{B}^T\\mathbf{y} + 2(\\mathbf{B}^T\\mathbf{B} + \\lambda\\mathbf{\\Omega})\\boldsymbol{\\theta} = \\mathbf{0}\n$$\n这给出了系数向量 $\\boldsymbol{\\theta}$ 的正规方程组：\n$$\n(\\mathbf{B}^T\\mathbf{B} + \\lambda\\mathbf{\\Omega})\\boldsymbol{\\theta} = \\mathbf{B}^T\\mathbf{y}\n$$\n这个线性系统的系数矩阵是 $\\mathbf{M} = \\mathbf{B}^T\\mathbf{B} + \\lambda\\mathbf{\\Omega}$。问题要求我们确定该矩阵 $\\mathbf{M}$ 的半带宽 $b$。这由 $\\mathbf{B}^T\\mathbf{B}$ 和 $\\mathbf{\\Omega}$ 的稀疏模式决定。\n\n我们使用题目给出的三次B样条基函数的性质：\n1. 每个 $B_j$ 都有紧支集。\n2. 两个基函数 $B_j$ 和 $B_k$ 的支集重叠，当且仅当 $|j-k| \\leq 3$。\n\n我们来分析 $\\mathbf{\\Omega}$ 的结构。其第 $(j,k)$ 个元素是 $\\Omega_{jk} = \\int_{a}^{b} B''_{j}(x) B''_{k}(x) dx$。$B''_j(x)$ 的支集包含在 $B_j(x)$ 的支集内。因此，如果 $B_j(x)$ 和 $B_k(x)$ 的支集不相交，那么 $B''_j(x)$ 和 $B''_k(x)$ 的支集也不相交。在这种情况下，被积函数 $B''_j(x) B''_k(x)$ 恒为零，且 $\\Omega_{jk}=0$。根据给定的性质，$B_j$ 和 $B_k$ 的支集在 $|j-k| > 3$ 时不相交。因此，当 $|j-k| > 3$ 时，$\\Omega_{jk} = 0$。这意味着 $\\mathbf{\\Omega}$ 是一个半带宽为 3 的带状矩阵。\n\n接下来，我们分析 $\\mathbf{B}^T\\mathbf{B}$ 的结构。其第 $(j,k)$ 个元素是：\n$$\n(\\mathbf{B}^T\\mathbf{B})_{jk} = \\sum_{i=1}^{n} B_{ij}^T B_{ik} = \\sum_{i=1}^{n} B_j(x_i) B_k(x_i)\n$$\n要使求和中的任意一项 $B_j(x_i) B_k(x_i)$ 不为零，$B_j(x_i)$ 和 $B_k(x_i)$ 都必须不为零。这只可能在点 $x_i$ 位于 $B_j$ 和 $B_k$ 支集的交集内时发生。如果 $B_j$ 和 $B_k$ 的支集不相交，则不存在这样的 $x_i$，求和将为零。再次使用给定的性质，当 $|j-k| > 3$ 时，支集不相交。因此，当 $|j-k| > 3$ 时，$(\\mathbf{B}^T\\mathbf{B})_{jk} = 0$。所以，$\\mathbf{B}^T\\mathbf{B}$ 也是一个半带宽为 3 的带状矩阵。\n\n系数矩阵为 $\\mathbf{M} = \\mathbf{B}^T\\mathbf{B} + \\lambda\\mathbf{\\Omega}$。$\\mathbf{M}$ 的第 $(j,k)$ 个元素是 $M_{jk} = (\\mathbf{B}^T\\mathbf{B})_{jk} + \\lambda \\Omega_{jk}$。\n如果 $|j-k| > 3$，则 $(\\mathbf{B}^T\\mathbf{B})_{jk}=0$ 和 $\\Omega_{jk}=0$ 都成立。因此，当 $|j-k| > 3$ 时，$M_{jk}=0$。这证明了 $\\mathbf{M}$ 的半带宽最多为 3。\n\n为了确认半带宽不小于 3，我们必须检查当 $|j-k|=3$ 时元素是否可以为非零。我们考虑 $M_{j, j+3}$。$B_j$ 和 $B_{j+3}$ 的支集是重叠的。对于一个典型的节点序列，这个重叠区域是一个非空区间，并且 $B_j(x)$ 和 $B_{j+3}(x)$（以及它们的二阶导数）都在这个区间内非零。因此，通常情况下 $\\Omega_{j, j+3} = \\int B''_j(x)B''_{j+3}(x)dx \\neq 0$。类似地，如果任何数据点 $x_i$ 落入这个重叠区域，那么 $(\\mathbf{B}^T\\mathbf{B})_{j, j+3}$ 将为非零。由于 $\\lambda > 0$，不能保证这两项会相互抵消。总的来说，$M_{j, j+3} \\neq 0$。\n\n因此，使得对于所有满足 $|j-k|>b$ 的 $j,k$ 都有 $M_{jk}=0$ 的最小非负整数 $b$ 是 3。矩阵 $\\mathbf{M}$ 是一个对称带状矩阵，总带宽为 $2b+1 = 2(3)+1 = 7$（即，它是一个七对角矩阵）。\n\n使用带状求解器（如带状 Cholesky 分解）求解这样一个带状 $m \\times m$ 矩阵的线性系统，其计算成本为 $O(m b^2)$。鉴于基函数数量 $m$ 通常与数据点数量 $n$ 成正比（通常 $m \\approx n$），成本为 $O(n \\cdot 3^2) = O(n)$，与 $n$ 呈线性关系。这与问题的陈述一致。\n\n半带宽是 $b=3$。", "answer": "$$\\boxed{3}$$", "id": "3174213"}, {"introduction": "标准的平滑样条在数据范围之外会进行线性外插，这对于在特定区域外为零的紧支撑函数会产生不切实际的“尾巴”。本练习将通过一个具体的函数来探讨这个问题，并测试一种实用的修正方法：添加加权的“锚点”来强制实现期望的边界行为 [@problem_id:3174194]。这个过程展示了如何将关于真实函数的先验知识融入模型以改善其性能，这是应用统计中一项至关重要的技能。", "problem": "你的任务是检验当真实回归函数具有紧支集时，立方平滑样条的行为，并量化边界线性外插是否会引入人为的尾部。该研究必须从平滑样条作为罚最小二乘泛函的最小化子的定义开始。具体来说，考虑二次可微函数的空间和基本变分公式：对于给定的观测值 $\\{(x_i, y_i)\\}_{i=1}^n$ 和非负权重 $\\{w_i\\}_{i=1}^n$，平滑样条估计量 $\\hat{f}$ 定义为在所有函数 $f$ 中使目标函数最小化的解：\n$$\nJ[f] = \\sum_{i=1}^n w_i^2 \\left(y_i - f(x_i)\\right)^2 + \\lambda \\int_{a}^{b} \\left(f''(t)\\right)^2 \\, dt,\n$$\n其中 $\\lambda \\ge 0$ 控制平滑度，$[a,b]$ 是训练域。对于具有自然边界条件的立方平滑样条，得到的 $\\hat{f}$ 是一个自然立方样条，它在 $[a,b]$ 之外进行线性外插。当真实函数具有紧支集时，这种线性外插会引入人为的尾部。\n\n构建一个程序，以完全确定的方式实现以下协议。\n\n1) 数据生成过程。\n- 定义真实的紧支集目标函数 $f^\\star(x)$ 为\n$$\nf^\\star(x) = \\max\\left(0, 1 - |x|\\right),\n$$\n其支集在 $[-1,1]$ 上。\n- 定义确定性加性扰动 $\\varepsilon(x)$ 为\n$$\n\\varepsilon(x) = 0.05 \\sin(13 x) + 0.02 \\cos(7 x),\n$$\n其中角度以弧度为单位。\n- 将训练输入网格 $\\{x_i\\}_{i=1}^n$ 定义为 $[-1.2, 1.2]$ 上的 $n$ 个等距点，其中 $n = 481$。定义响应值 $y_i = f^\\star(x_i) + \\varepsilon(x_i)$。\n\n2) 基线平滑样条。\n- 使用单位权重，将立方平滑样条 $\\hat{f}_{\\text{base}}$ 拟合到 $\\{(x_i, y_i)\\}$，平滑因子由下面描述的测试套件选择。使用立方平滑样条公式所蕴含的标准自然边界条件。\n\n3) 边界节点修正法。\n- 通过在已知支集边缘添加高置信度的边界锚点来构建一个增广数据集，以抑制边界线性外插产生非零尾部。具体来说，在以下位置添加四个锚点：\n$$\nx = -1.000,\\quad x = -1.000 + 10^{-3},\\quad x = 1.000 - 10^{-3},\\quad x = 1.000,\n$$\n响应值固定为 $0$。为原始的 $n$ 个训练点分配单位权重，并为四个锚点中的每一个分配一个大权重 $W = 1000$。使用与基线相同的平滑因子，将立方平滑样条 $\\hat{f}_{\\text{anch}}$ 拟合到这个增广和加权的数据集上。\n\n4) 尾部度量。\n- 为了量化由于超出观测范围的线性外插而产生的人为尾部，在训练域之外未用于拟合数据的尾部区域上评估每个拟合函数。将两个不相交的尾部区间定义为 $[-1.8, -1.2]$ 和 $[1.2, 1.8]$。在每个尾部区间上，采样 $M = 301$ 个等距点，并定义大小为 $2M$ 的聚合尾部网格。对于任何拟合函数 $\\hat{f}$，定义尾部大小\n$$\nT(\\hat{f}) = \\frac{1}{2M}\\sum_{j=1}^{2M} \\left| \\hat{f}(z_j) \\right|,\n$$\n其中 $\\{z_j\\}_{j=1}^{2M}$ 是由两个区间拼接而成的尾部网格点。\n\n5) 输出度量。\n- 对于每个测试用例，计算比率\n$$\nR = \\frac{T\\left(\\hat{f}_{\\text{anch}}\\right)}{T\\left(\\hat{f}_{\\text{base}}\\right)},\n$$\n约定如果 $T\\left(\\hat{f}_{\\text{base}}\\right)$ 等于 $0$，则将分母替换为 $\\max\\left(T\\left(\\hat{f}_{\\text{base}}\\right), 10^{-12}\\right)$ 以避免除以零。\n\n测试套件：\n- 使用以下平滑因子（上述目标函数中的第二项通过立方平滑样条例程实现的平滑因子来控制；每个值都会在保真度和平滑度之间产生不同的折衷）：\n    - 情况 A：$s = 0.05$。\n    - 情况 B：$s = 0.5$。\n    - 情况 C：$s = 2.0$。\n\n对于每种情况，运行步骤 $1$–$5$ 并将比率 $R$ 记录为浮点数。\n\n最终输出格式：\n- 你的程序应生成一行输出，其中包含三个比率 $[R_A, R_B, R_C]$，形式为用方括号括起来的逗号分隔列表。每个比率必须四舍五入到小数点后恰好六位。例如，输出格式必须如下所示：\n$$\n[\\;0.123456,0.234567,0.345678\\;].\n$$\n不得打印任何其他文本。", "solution": "本问题的解决思路是，通过一个数值实验来对比标准平滑样条和边界修正后的平滑样条在拟合紧支集函数时的表现。\n\n1.  **数据生成**：我们首先按照题目要求生成数据。真实函数 $f^\\star(x)$ 是一个在 $[-1, 1]$ 区间外为零的“帐篷”函数。我们在这个函数上添加一个确定的高频扰动，并在 $[-1.2, 1.2]$ 区间上采样，得到训练数据。这个采样区间有意地超出了真实函数的支集。\n\n2.  **基线模型拟合**：我们使用单位权重，将一个标准的立方平滑样条 $\\hat{f}_{\\text{base}}$ 拟合到生成的数据上。由于标准样条的自然边界条件会导致在数据范围之外进行线性外插，且数据点在 $x=\\pm 1.2$ 附近因扰动而不为零，我们预期 $\\hat{f}_{\\text{base}}$ 在 $[-1, 1]$ 之外会产生不希望有的非零“尾部”。\n\n3.  **边界修正模型拟合**：为了修正这个问题，我们利用已知的先验知识——真实函数在 $x=\\pm 1$ 处为零。我们在 $x=\\pm 1$ 附近添加四个响应值为0的“锚点”，并为这些锚点分配一个极大的权重（$W=1000$）。然后，我们将一个加权立方平滑样条 $\\hat{f}_{\\text{anch}}$ 拟合到这个包含原始数据和锚点的增强数据集上。大权重会强制样条曲线非常接近这些锚点，从而有效地将样条“固定”在 $x$ 轴上，抑制线性外插。\n\n4.  **效果量化**：最后，我们在远离训练数据的尾部区域（$[-1.8, -1.2]$ 和 $[1.2, 1.8]$）评估两个模型的表现。我们计算每个模型在这些区域的平均绝对值，作为其“尾部大小”的度量。通过计算两个模型尾部大小的比率 $R$，我们可以量化锚点方法对减少人为尾部的有效性。\n\n整个过程对测试套件中给出的三个不同平滑因子 $s$ 分别重复进行。", "answer": "$$[\\;0.000300,0.038166,0.160164\\;]$$", "id": "3174194"}, {"introduction": "平滑样条的性能不仅取决于平滑参数 $\\lambda$，还高度依赖于数据点的空间分布。本练习将探讨非均匀甚至“对抗性”的数据点布局如何影响平滑器的等价核，并可能导致局部偏差显著增大 [@problem_id:3174196]。通过这个实践，你将对平滑器作为局部加权平均的本质建立起更深刻的直觉，并认识到数据本身的“设计”对模型表现的影响。", "problem": "给定一个惩罚最小二乘框架下的平滑样条问题。目标是分析当设计点被对抗性地放置以引发振荡时，等价核以及由此产生的偏差的行为。所有工作都在区间 $[0,1]$ 的一维空间中进行。\n\n从以下基本基础出发：在一组有限的设计点 $\\{x_i\\}_{i=0}^{n-1}$ 上的平滑样条估计量 $\\hat{\\mathbf{f}}$ 是通过最小化以下惩罚目标函数得到的：\n$$\n\\sum_{i=0}^{n-1} \\left( y_i - f(x_i) \\right)^2 \\;+\\; \\lambda \\int_{0}^{1} \\left( f''(t) \\right)^2 \\, dt,\n$$\n其中 $\\lambda > 0$ 是一个固定的平滑参数，$f''$ 表示二阶导数。在不规则设计点的离散近似中，使用非均匀有限差分格式来近似内部点的二阶导数：\n$$\nf''(x_i) \\approx \\frac{2}{h_i + h_{i-1}} \\left( \\frac{f_{i+1} - f_i}{h_i} - \\frac{f_i - f_{i-1}}{h_{i-1}} \\right), \\quad i = 1,2,\\dots,n-2,\n$$\n其中 $h_i = x_{i+1} - x_i$ 且 $f_i := f(x_i)$。使用类梯形权重 $w_i = \\frac{1}{2}(h_{i-1} + h_i)$，通过加权和来近似该积分。设 $\\mathbf{D}$ 为一个 $(n-2) \\times n$ 的矩阵，用于编码线性映射 $\\mathbf{r} = \\mathbf{D}\\mathbf{f}$，其分量为：\n$$\nr_i \\;=\\; a_i f_{i-1} + b_i f_i + c_i f_{i+1}, \\quad\na_i = \\frac{2}{(h_i + h_{i-1}) h_{i-1}}, \\quad\nb_i = -\\frac{2}{h_i + h_{i-1}}\\left(\\frac{1}{h_{i}}+\\frac{1}{h_{i-1}}\\right), \\quad\nc_i = \\frac{2}{(h_i + h_{i-1}) h_{i}},\n$$\n并设 $\\mathbf{W}$ 为一个对角线元素为 $w_i$ 的 $(n-2) \\times (n-2)$ 对角矩阵。那么离散惩罚项可以写成 $\\mathbf{f}^\\top \\mathbf{Q} \\mathbf{f}$，其中 $\\mathbf{Q} = \\mathbf{D}^\\top \\mathbf{W} \\mathbf{D}$。在设计点上的最终估计量是以下线性系统的唯一解：\n$$\n\\left( \\mathbf{I}_n + \\lambda \\mathbf{Q} \\right) \\hat{\\mathbf{f}} \\;=\\; \\mathbf{y},\n$$\n其中 $\\mathbf{I}_n$ 是 $n \\times n$ 的单位矩阵，$\\mathbf{y}$ 是观测值向量。这定义了一个线性平滑器，其等价核矩阵为\n$$\n\\mathbf{S}_\\lambda \\;=\\; \\left( \\mathbf{I}_n + \\lambda \\mathbf{Q} \\right)^{-1},\n$$\n因此 $\\hat{\\mathbf{f}} = \\mathbf{S}_\\lambda \\mathbf{y}$。考虑无噪声情况 $\\mathbf{y} = \\mathbf{f}^{\\star}$，其中 $f^{\\star}(x)$ 是一个已知的平滑真实函数，因此逐点偏差为 $\\hat{f}(x_i) - f^{\\star}(x_i)$。\n\n你的任务是构造对抗性设计，以在 $\\mathbf{S}_\\lambda$ 的行（在设计点上评估的等价核）中引发振荡行为，并根据固定的 $\\lambda$ 凭经验证明偏差的最坏情况区域。振荡可以通过计算核函数行中的符号变化次数来量化。\n\n用固定的 $\\lambda$ 和固定的真实函数 $f^{\\star}(x)$ 实现以下测试套件：\n\n- 全局参数：\n  - 定义域：$[0,1]$。\n  - 点数：$n = 51$。\n  - 平滑参数：$\\lambda = 10^{-4}$。\n  - 真实函数：$f^{\\star}(x) = \\sin(6\\pi x)$。\n\n- 测试用例（每个用例定义设计点 $\\{x_i\\}_{i=0}^{n-1}$）：\n  1. 均匀网格（理想情况）：$x_i = \\frac{i}{n-1}$，对于 $i = 0,1,\\dots,n-1$。\n  2. 大小间隙交替（对抗性振荡）：使用交替出现的小间隙 $h_s = 0.005$ 和大间隙 $h_b$ 的连续区间，选择 $h_b$ 以使总长度为 $1$。具体来说，由于有 $n-1 = 50$ 个区间和 $25$ 对，设置 $h_b = \\frac{1}{25} - h_s$，并定义 $x_0 = 0$ 和 $x_{i+1} = x_i + h_i$，其中 $h_i$ 交替为 $h_s, h_b, h_s, h_b, \\dots$。\n  3. 中心聚类（在 $x = 0.5$ 附近的对抗性聚类）：从均匀参数 $u_i = \\frac{i}{n-1}$ 开始，通过 $x_i = \\frac{1}{2} + \\frac{\\tanh\\left(\\alpha(u_i - \\frac{1}{2})\\right)}{2 \\tanh(\\alpha/2)}$ 进行映射，其中 $\\alpha = 3$。\n  4. 左边界聚类（在 $x = 0$ 附近的对抗性聚类）：设置 $x_i = u_i^{\\gamma}$，其中 $u_i = \\frac{i}{n-1}$ 且 $\\gamma = 3$。\n\n对于每个测试用例，计算：\n- 在设计点上的估计量 $\\hat{\\mathbf{f}} = \\mathbf{S}_\\lambda \\mathbf{f}^{\\star}$。\n- 绝对偏差向量 $\\mathbf{b}$，其分量为 $b_i = \\left|\\hat{f}(x_i) - f^{\\star}(x_i)\\right|$。\n- 找出具有最大绝对偏差的索引 $i^{\\star}$，如有并列，则取最小的索引。\n- 令 $\\mathbf{k}^{(i^{\\star})}$ 表示 $\\mathbf{S}_\\lambda$ 的第 $i^{\\star}$ 行。计算 $\\mathbf{k}^{(i^{\\star})}$ 中连续条目的符号变化次数，将零视为无符号且不计入符号变化。\n\n你的程序应为每个测试用例输出一个包含以下内容的三元组：\n- 位置 $x_{i^{\\star}}$。\n- 最大绝对偏差 $\\max_i b_i$。\n- $\\mathbf{k}^{(i^{\\star})}$ 中符号变化的整数计数。\n\n格式和数值规范：\n- 将前两个量报告为四舍五入到 $6$ 位小数的浮点数，最后一个量报告为整数。\n- 你的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身也是按上述顺序排列的列表。例如，一个有效的输出格式是 $[\\,[x_1,b_1,c_1],\\,[x_2,b_2,c_2],\\,[x_3,b_3,c_3],\\,[x_4,b_4,c_4]\\,]$，其中每个 $x_k$ 和 $b_k$ 四舍五入到 $6$ 位小数，而 $c_k$ 是一个整数。", "solution": "本题的解决策略是，通过数值模拟来系统地探究数据点分布对平滑样条性能的影响。对于题目给出的四种不同设计点布局（均匀、交替、中心聚类、左边界聚类），我们都执行以下步骤：\n\n1.  **生成设计点**：根据每种情况的规则，在 $[0,1]$ 区间上生成 $n=51$ 个数据点。\n2.  **构建惩罚矩阵**：基于这些点，使用非均匀有限差分公式来构建离散化的二阶导数算子矩阵 $\\mathbf{D}$ 和积分权重矩阵 $\\mathbf{W}$。然后，通过矩阵乘法计算出惩罚矩阵 $\\mathbf{Q} = \\mathbf{D}^\\top \\mathbf{W} \\mathbf{D}$。这个矩阵代表了对函数“粗糙度”的离散化度量。\n3.  **计算平滑矩阵**：利用给定的平滑参数 $\\lambda=10^{-4}$，我们构建系统矩阵 $(\\mathbf{I}_n + \\lambda \\mathbf{Q})$ 并求其逆，得到平滑矩阵（或称等价核）$\\mathbf{S}_\\lambda$。\n4.  **分析偏差与核函数**：在无噪声的设定下（即观测值 $y_i$ 等于真实函数值 $f^\\star(x_i)$），我们计算平滑样条的拟合值 $\\hat{\\mathbf{f}} = \\mathbf{S}_\\lambda \\mathbf{f}^\\star$ 以及它与真实函数值之间的逐点偏差。\n5.  **量化结果**：我们找出偏差最大的点 $x_{i^\\star}$，并记录其位置和偏差大小。同时，我们提取平滑矩阵中对应的行 $\\mathbf{k}^{(i^\\star)}$（即该点的等价核），并通过计算其连续元素间的符号变化次数来量化其振荡程度。\n\n通过比较四种情况下的结果（最大偏差和核函数振荡），我们可以清晰地看到非均匀或“对抗性”的数据分布是如何通过扭曲等价核的形状，从而在特定区域导致显著增大的局部偏差。", "answer": "[[0.980000,0.007554,12],[0.985000,0.222956,24],[0.053897,0.027004,12],[0.511199,0.211756,28]]", "id": "3174196"}]}