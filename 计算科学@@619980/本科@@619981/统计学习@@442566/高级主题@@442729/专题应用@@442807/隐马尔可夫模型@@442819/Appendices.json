{"hands_on_practices": [{"introduction": "隐马尔可夫模型（HMM）的核心应用之一是评估问题：给定一个模型和一个观测序列，我们的模型产生这个序列的可能性有多大？这个问题在模式识别等领域至关重要，例如判断一段语音是否对应某个特定词汇。这个练习将通过一个工业传感器的具体场景，引导你使用前向算法来解决评估问题，这是掌握HMMs的基石。[@problem_id:1306030]", "problem": "一个工业传感器被用于监测流水线上组件的质量。该传感器的状态不能直接观察，可以被建模为一个具有两个隐藏状态的系统：“运行正常”（Operational）和“故障”（Malfunctioning）。在每个时间步，对应于对一个组件的检查，传感器要么保持当前状态，要么转换到另一个状态。对于其检查的每个组件，传感器会输出两种信号之一：“合格”（Pass）或“缺陷”（Defect）。\n\n该系统的行为可以用一个由以下参数定义的隐马尔可夫模型（HMM）来描述：\n\n设隐藏状态集为 $S = \\{S_{\\text{Op}}, S_{\\text{Mal}}\\}$，其中 $S_{\\text{Op}}$ 代表“运行正常”状态，$S_{\\text{Mal}}$ 代表“故障”状态。\n\n1.  **初始状态概率 ($\\pi$):** 在观察期开始时（时间 $t=1$），传感器处于每个状态的概率为：\n    *   $P(S_{\\text{Op}}) = 0.95$\n    *   $P(S_{\\text{Mal}}) = 0.05$\n\n2.  **状态转移概率矩阵 ($A$):** 该矩阵给出了在连续时间步之间从一个状态转移到另一个状态的概率。\n    $$\n    A = \n    \\begin{pmatrix}\n    P(S_{t+1}=S_{\\text{Op}} | S_t=S_{\\text{Op}})  P(S_{t+1}=S_{\\text{Mal}} | S_t=S_{\\text{Op}}) \\\\\n    P(S_{t+1}=S_{\\text{Op}} | S_t=S_{\\text{Mal}})  P(S_{t+1}=S_{\\text{Mal}} | S_t=S_{\\text{Mal}})\n    \\end{pmatrix}\n    =\n    \\begin{pmatrix}\n    0.98  0.02 \\\\\n    0.15  0.85\n    \\end{pmatrix}\n    $$\n\n3.  **观测发射概率矩阵 ($B$):** 该矩阵给出了在传感器当前隐藏状态下，观测到特定信号的概率。\n    $$\n    B = \n    \\begin{pmatrix}\n    P(\\text{'Pass'} | S_{\\text{Op}})  P(\\text{'Defect'} | S_{\\text{Op}}) \\\\\n    P(\\text{'Pass'} | S_{\\text{Mal}})  P(\\text{'Defect'} | S_{\\text{Mal}})\n    \\end{pmatrix}\n    =\n    \\begin{pmatrix}\n    0.99  0.01 \\\\\n    0.20  0.80\n    \\end{pmatrix}\n    $$\n\n一位工程师观察到传感器对连续三个组件发出的信号序列为：（'Pass', 'Pass', 'Defect'）。\n\n计算观测到这个特定序列的总概率。将您的最终答案四舍五入到四位有效数字。", "solution": "我们使用前向算法来建模该观测序列。令 $\\alpha_{t}(s) = P(o_{1:t}, S_{t}=s)$，其中 $o_{1:t}$ 表示从时间 $1$ 到 $t$ 的观测值，$S_{t}$ 是时间 $t$ 的隐藏状态。递归公式为：\n$$\n\\alpha_{1}(s) = \\pi(s)\\, b_{s}(o_{1}), \\quad\n\\alpha_{t+1}(s') = \\left[\\sum_{s \\in S} \\alpha_{t}(s)\\, a_{s \\to s'}\\right] b_{s'}(o_{t+1}),\n$$\n并且观测序列 $o_{1:3} = (\\text{Pass}, \\text{Pass}, \\text{Defect})$ 的总概率为\n$$\nP(o_{1:3}) = \\sum_{s \\in S} \\alpha_{3}(s).\n$$\n\n对于 $t=1$ 且 $o_{1}=\\text{Pass}$ 的初始步骤：\n$$\n\\alpha_{1}(S_{\\text{Op}}) = \\pi(S_{\\text{Op}})\\, b_{S_{\\text{Op}}}(\\text{Pass}) = 0.95 \\cdot 0.99 = 0.9405,\n$$\n$$\n\\alpha_{1}(S_{\\text{Mal}}) = \\pi(S_{\\text{Mal}})\\, b_{S_{\\text{Mal}}}(\\text{Pass}) = 0.05 \\cdot 0.20 = 0.01.\n$$\n\n对于 $t=2$ 且 $o_{2}=\\text{Pass}$ 的归纳步骤：\n$$\n\\alpha_{2}(S_{\\text{Op}}) = \\left[\\alpha_{1}(S_{\\text{Op}})\\, a_{\\text{Op}\\to\\text{Op}} + \\alpha_{1}(S_{\\text{Mal}})\\, a_{\\text{Mal}\\to\\text{Op}}\\right] b_{S_{\\text{Op}}}(\\text{Pass})\n= \\left[0.9405 \\cdot 0.98 + 0.01 \\cdot 0.15\\right] \\cdot 0.99\n= 0.92319 \\cdot 0.99 = 0.9139581,\n$$\n$$\n\\alpha_{2}(S_{\\text{Mal}}) = \\left[\\alpha_{1}(S_{\\text{Op}})\\, a_{\\text{Op}\\to\\text{Mal}} + \\alpha_{1}(S_{\\text{Mal}})\\, a_{\\text{Mal}\\to\\text{Mal}}\\right] b_{S_{\\text{Mal}}}(\\text{Pass})\n= \\left[0.9405 \\cdot 0.02 + 0.01 \\cdot 0.85\\right] \\cdot 0.20\n= 0.02731 \\cdot 0.20 = 0.005462.\n$$\n\n对于 $t=3$ 且 $o_{3}=\\text{Defect}$ 的归纳步骤：\n$$\n\\alpha_{3}(S_{\\text{Op}}) = \\left[\\alpha_{2}(S_{\\text{Op}})\\, a_{\\text{Op}\\to\\text{Op}} + \\alpha_{2}(S_{\\text{Mal}})\\, a_{\\text{Mal}\\to\\text{Op}}\\right] b_{S_{\\text{Op}}}(\\text{Defect})\n= \\left[0.9139581 \\cdot 0.98 + 0.005462 \\cdot 0.15\\right] \\cdot 0.01\n= 0.896498238 \\cdot 0.01 = 0.00896498238,\n$$\n$$\n\\alpha_{3}(S_{\\text{Mal}}) = \\left[\\alpha_{2}(S_{\\text{Op}})\\, a_{\\text{Op}\\to\\text{Mal}} + \\alpha_{2}(S_{\\text{Mal}})\\, a_{\\text{Mal}\\to\\text{Mal}}\\right] b_{S_{\\text{Mal}}}(\\text{Defect})\n= \\left[0.9139581 \\cdot 0.02 + 0.005462 \\cdot 0.85\\right] \\cdot 0.80\n= 0.022921862 \\cdot 0.80 = 0.0183374896.\n$$\n\n序列的总概率为\n$$\nP(\\text{Pass}, \\text{Pass}, \\text{Defect}) = \\alpha_{3}(S_{\\text{Op}}) + \\alpha_{3}(S_{\\text{Mal}}) = 0.00896498238 + 0.0183374896 = 0.02730247198.\n$$\n\n四舍五入到四位有效数字得到 $0.02730$。", "answer": "$$\\boxed{0.02730}$$", "id": "1306030"}, {"introduction": "在评估了观测序列的整体概率之后，我们自然会想知道背后发生了什么。通常，我们更关心的是最有可能产生这些观测结果的隐藏状态序列是什么。这就是“解码”问题，它在生物信息学中用于基因发现或在自然语言处理中用于词性标注。本练习通过一个直观的植物健康与天气模型，向你介绍维特比算法（Viterbi algorithm），这是一种高效找到此最优路径的动态规划方法。[@problem_id:1305999]", "problem": "一位生物学家正在一个偏远、无人监测的岛屿上研究一种特定、敏感的植物物种的健康状况。每天观察到的植物健康状况可分为`Fresh`（新鲜）或`Wilted`（枯萎）。生物学家假设，植物的状态主要由前一天未被观测到的大气状况决定，大气状况可能是`Dry`（干燥）或`Humid`（湿润）。\n\n该系统被建模为一个隐马尔可夫模型（HMM），具有以下参数：\n\n1.  **初始状态概率**：观测第一天天气状态的概率。\n    *   $P(\\text{Day 1 is Dry}) = 0.7$\n    *   $P(\\text{Day 1 is Humid}) = 0.3$\n\n2.  **转移概率**：连续几天内从一种天气状态转移到另一种天气状态的概率。\n    *   $P(\\text{Today is Dry} | \\text{Yesterday was Dry}) = 0.8$\n    *   $P(\\text{Today is Humid} | \\text{Yesterday was Dry}) = 0.2$\n    *   $P(\\text{Today is Dry} | \\text{Yesterday was Humid}) = 0.4$\n    *   $P(\\text{Today is Humid} | \\text{Yesterday was Humid}) = 0.6$\n\n3.  **发射概率**：在给定当天天气状况的情况下，观察到植物状况的概率。\n    *   $P(\\text{Plant is Wilted} | \\text{Weather is Dry}) = 0.9$\n    *   $P(\\text{Plant is Fresh} | \\text{Weather is Dry}) = 0.1$\n    *   $P(\\text{Plant is Wilted} | \\text{Weather is Humid}) = 0.2$\n    *   $P(\\text{Plant is Fresh} | \\text{Weather is Humid}) = 0.8$\n\n生物学家收到一份为期三天的植物状况报告：`Fresh`、`Wilted`、`Wilted`。\n\n确定最可能产生此观测序列的天气状态序列（第1天，第2天，第3天）。\n\nA. 湿润, 干燥, 干燥\n\nB. 湿润, 湿润, 干燥\n\nC. 干燥, 干燥, 干燥\n\nD. 湿润, 干燥, 湿润\n\nE. 干燥, 湿润, 干燥", "solution": "我们将隐藏的天气状态建模为 $S=\\{\\text{D},\\text{H}\\}$，分别代表干燥（Dry）和湿润（Humid）。三天内的观测序列为 $O=(\\text{Fresh},\\text{Wilted},\\text{Wilted})$。初始概率为 $\\pi(\\text{D})=0.7$，$\\pi(\\text{H})=0.3$。转移概率为 $a_{\\text{DD}}=0.8$，$a_{\\text{DH}}=0.2$，$a_{\\text{HD}}=0.4$，$a_{\\text{HH}}=0.6$。发射概率为 $b_{\\text{D}}(\\text{Fresh})=0.1$，$b_{\\text{D}}(\\text{Wilted})=0.9$，$b_{\\text{H}}(\\text{Fresh})=0.8$，$b_{\\text{H}}(\\text{Wilted})=0.2$。\n\n使用维特比算法。定义\n$$\n\\delta_{t}(s)=\\max_{s_{1},\\ldots,s_{t-1}} P(s_{1},\\ldots,s_{t-1},s_{t}=s,\\; o_{1},\\ldots,o_{t}),\n$$\n递推公式为\n$$\n\\delta_{1}(s)=\\pi(s)\\,b_{s}(o_{1}),\\quad \\delta_{t}(s)=b_{s}(o_{t})\\max_{s'}\\left[\\delta_{t-1}(s')\\,a_{s's}\\right],\n$$\n和回溯指针 $\\psi_{t}(s)=\\arg\\max_{s'}\\left[\\delta_{t-1}(s')\\,a_{s's}\\right]$。\n\n当 $t=1$ 且观测值为 $o_{1}=\\text{Fresh}$ 时的初始化：\n$$\n\\delta_{1}(\\text{D})=\\pi(\\text{D})\\,b_{\\text{D}}(\\text{Fresh})=0.7\\cdot 0.1=0.07,\\quad\n\\delta_{1}(\\text{H})=\\pi(\\text{H})\\,b_{\\text{H}}(\\text{Fresh})=0.3\\cdot 0.8=0.24.\n$$\n\n当 $t=2$ 且观测值为 $o_{2}=\\text{Wilted}$ 时的递推：\n- 对于状态 D：\n$$\n\\delta_{2}(\\text{D})=b_{\\text{D}}(\\text{Wilted})\\max\\{\\delta_{1}(\\text{D})a_{\\text{DD}},\\,\\delta_{1}(\\text{H})a_{\\text{HD}}\\}\n=0.9\\max\\{0.07\\cdot 0.8,\\,0.24\\cdot 0.4\\}=0.9\\cdot 0.096=0.0864,\n$$\n因此 $\\psi_{2}(\\text{D})=\\text{H}$。\n- 对于状态 H：\n$$\n\\delta_{2}(\\text{H})=b_{\\text{H}}(\\text{Wilted})\\max\\{\\delta_{1}(\\text{D})a_{\\text{DH}},\\,\\delta_{1}(\\text{H})a_{\\text{HH}}\\}\n=0.2\\max\\{0.07\\cdot 0.2,\\,0.24\\cdot 0.6\\}=0.2\\cdot 0.144=0.0288,\n$$\n因此 $\\psi_{2}(\\text{H})=\\text{H}$。\n\n当 $t=3$ 且观测值为 $o_{3}=\\text{Wilted}$ 时的递推：\n- 对于状态 D：\n$$\n\\delta_{3}(\\text{D})=b_{\\text{D}}(\\text{Wilted})\\max\\{\\delta_{2}(\\text{D})a_{\\text{DD}},\\,\\delta_{2}(\\text{H})a_{\\text{HD}}\\}\n=0.9\\max\\{0.0864\\cdot 0.8,\\,0.0288\\cdot 0.4\\}=0.9\\cdot 0.06912=0.062208,\n$$\n因此 $\\psi_{3}(\\text{D})=\\text{D}$。\n- 对于状态 H：\n$$\n\\delta_{3}(\\text{H})=b_{\\text{H}}(\\text{Wilted})\\max\\{\\delta_{2}(\\text{D})a_{\\text{DH}},\\,\\delta_{2}(\\text{H})a_{\\text{HH}}\\}\n=0.2\\max\\{0.0864\\cdot 0.2,\\,0.0288\\cdot 0.6\\}=0.2\\cdot 0.01728=0.003456,\n$$\nargmax 中出现平局；此处的后向指针选择不影响最终的最可能路径。\n\n终止与回溯：\n$$\n\\max\\{\\delta_{3}(\\text{D}),\\delta_{3}(\\text{H})\\}=0.062208 \\text{ at state D}.\n$$\n回溯：在 $t=3$ 时状态为 D；$\\psi_{3}(\\text{D})=\\text{D}$ 给出在 $t=2$ 时状态为 D；$\\psi_{2}(\\text{D})=\\text{H}$ 给出在 $t=1$ 时状态为 H。因此，最可能的隐藏序列是“湿润, 干燥, 干燥”，对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1305999"}, {"introduction": "我们已经学习了用于评估和解码的高效算法，但理解其为何不可或缺至关重要。如果没有这些算法，计算将是怎样的？本练习将通过对比两种方法来加深你对HMMs计算复杂度的理解：首先，通过暴力枚举所有可能的隐藏状态路径来计算观测概率；然后，使用前向算法完成同样的任务。通过比较这两种方法的计算量，你将直观地体会到朴素方法的指数级复杂性，并真正理解动态规划方法所带来的效率提升。[@problem_id:3128474]", "problem": "一个离散隐马尔可夫模型 (HMM) 的隐状态集为 $\\{X, Y\\}$，观测字母表为 $\\{A, B\\}$。初始状态分布由 $\\pi(X) = 0.6$ 和 $\\pi(Y) = 0.4$ 给出。状态转移概率为 $a_{XX} = 0.8$，$a_{XY} = 0.2$，$a_{YX} = 0.3$ 和 $a_{YY} = 0.7$。发射概率为 $b_X(A) = 0.5$，$b_X(B) = 0.5$，$b_Y(A) = 0.2$ 和 $b_Y(B) = 0.8$。考虑长度为 $3$ 的观测序列 $(A, B, A)$。\n\n仅使用隐马尔可夫模型中条件独立性的基本定义（即隐状态的一阶马尔可夫性质和给定当前状态下观测值的条件独立性），完成以下任务：\n1. 通过显式地枚举所有长度为 $3$ 的隐状态序列并对它们的联合概率求和，来计算观测序列 $(A, B, A)$ 的概率。\n2. 使用从这些定义推导出的前向算法独立地验证相同的概率，并确定在此实例中，(i) 完全枚举所有隐藏路径和 (ii) 前向算法所需的标量乘法和加法次数。\n\n仅报告此 HMM 中 $(A, B, A)$ 的概率作为您的最终数值答案，四舍五入到四位有效数字。", "solution": "隐马尔可夫模型的基本假设是：\n1.  **马尔可夫性质**：当前隐状态的概率仅取决于前一个隐状态。$P(q_t|q_{t-1}, q_{t-2}, \\dots, q_1) = P(q_t|q_{t-1})$。\n2.  **输出独立性**：当前观测的概率仅取决于当前隐状态。$P(O_t|q_t, q_{t-1}, \\dots, q_1, O_{t-1}, \\dots, O_1) = P(O_t|q_t)$。\n\n这些假设使得观测序列 $O=(O_1, \\dots, O_T)$ 和隐状态序列 $Q=(q_1, \\dots, q_T)$ 的联合概率可以表示为：\n$$P(O,Q) = P(q_1) \\prod_{t=2}^{T} P(q_t|q_{t-1}) \\prod_{t=1}^{T} P(O_t|q_t) = \\pi_{q_1} b_{q_1}(O_1) \\prod_{t=2}^{T} a_{q_{t-1}q_t} b_{q_t}(O_t)$$\n\n观测序列 $O$ 的概率是通过将此联合概率对所有可能的隐状态序列 $Q$ 求和得到的：\n$$P(O) = \\sum_{\\text{all } Q} P(O,Q)$$\n\n我们被要求计算给定 HMM 的 $P(O=(A,B,A))$。\n\n**第 1 部分：通过完全枚举计算**\n当状态数 $N=2$、序列长度 $T=3$ 时，存在 $N^T = 2^3 = 8$ 种可能的隐状态序列 $Q = (q_1, q_2, q_3)$。我们计算每个序列的联合概率 $P(O, Q)$ 并将结果相加。观测序列为 $O=(A,B,A)$。\n\n每条路径的公式为 $P(O,Q) = \\pi_{q_1} b_{q_1}(A) a_{q_1q_2} b_{q_2}(B) a_{q_2q_3} b_{q_3}(A)$。\n\n1.  $Q = (X,X,X)$: $P(O,Q) = \\pi_X b_X(A) a_{XX} b_X(B) a_{XX} b_X(A) = (0.6)(0.5)(0.8)(0.5)(0.8)(0.5) = 0.048$\n2.  $Q = (X,X,Y)$: $P(O,Q) = \\pi_X b_X(A) a_{XX} b_X(B) a_{XY} b_Y(A) = (0.6)(0.5)(0.8)(0.5)(0.2)(0.2) = 0.0048$\n3.  $Q = (X,Y,X)$: $P(O,Q) = \\pi_X b_X(A) a_{XY} b_Y(B) a_{YX} b_X(A) = (0.6)(0.5)(0.2)(0.8)(0.3)(0.5) = 0.0072$\n4.  $Q = (X,Y,Y)$: $P(O,Q) = \\pi_X b_X(A) a_{XY} b_Y(B) a_{YY} b_Y(A) = (0.6)(0.5)(0.2)(0.8)(0.7)(0.2) = 0.00672$\n5.  $Q = (Y,X,X)$: $P(O,Q) = \\pi_Y b_Y(A) a_{YX} b_X(B) a_{XX} b_X(A) = (0.4)(0.2)(0.3)(0.5)(0.8)(0.5) = 0.0048$\n6.  $Q = (Y,X,Y)$: $P(O,Q) = \\pi_Y b_Y(A) a_{YX} b_X(B) a_{XY} b_Y(A) = (0.4)(0.2)(0.3)(0.5)(0.2)(0.2) = 0.00048$\n7.  $Q = (Y,Y,X)$: $P(O,Q) = \\pi_Y b_Y(A) a_{YY} b_Y(B) a_{YX} b_X(A) = (0.4)(0.2)(0.7)(0.8)(0.3)(0.5) = 0.00672$\n8.  $Q = (Y,Y,Y)$: $P(O,Q) = \\pi_Y b_Y(A) a_{YY} b_Y(B) a_{YY} b_Y(A) = (0.4)(0.2)(0.7)(0.8)(0.7)(0.2) = 0.006272$\n\n将这些概率相加：\n$P(O) = 0.048 + 0.0048 + 0.0072 + 0.00672 + 0.0048 + 0.00048 + 0.00672 + 0.006272 = 0.084992$。\n\n**第 2 部分：使用前向算法进行验证**\n前向算法提供了一种从相同的第一性原理推导出的更有效的方法。前向变量 $\\alpha_t(i)$ 定义为观测到前 $t$ 个观测值且在时间 $t$ 处于状态 $S_i$ 的联合概率：$\\alpha_t(i) = P(O_1, \\dots, O_t, q_t=S_i)$。\n\n- **初始化 ($t=1$)：** 观测值为 $O_1=A$。\n$\\alpha_1(X) = \\pi_X b_X(O_1) = (0.6)(0.5) = 0.3$\n$\\alpha_1(Y) = \\pi_Y b_Y(O_1) = (0.4)(0.2) = 0.08$\n\n- **递推 ($t=2$)：** 观测值为 $O_2=B$。\n递推步骤为 $\\alpha_t(j) = \\left[ \\sum_{i=1}^{N} \\alpha_{t-1}(i) a_{ij} \\right] b_j(O_t)$。\n$\\alpha_2(X) = [\\alpha_1(X) a_{XX} + \\alpha_1(Y) a_{YX}] b_X(O_2) = [(0.3)(0.8) + (0.08)(0.3)] (0.5) = [0.24 + 0.024](0.5) = (0.264)(0.5) = 0.132$\n$\\alpha_2(Y) = [\\alpha_1(X) a_{XY} + \\alpha_1(Y) a_{YY}] b_Y(O_2) = [(0.3)(0.2) + (0.08)(0.7)] (0.8) = [0.06 + 0.056](0.8) = (0.116)(0.8) = 0.0928$\n\n- **递推 ($t=3$)：** 观测值为 $O_3=A$。\n$\\alpha_3(X) = [\\alpha_2(X) a_{XX} + \\alpha_2(Y) a_{YX}] b_X(O_3) = [(0.132)(0.8) + (0.0928)(0.3)] (0.5) = [0.1056 + 0.02784](0.5) = (0.13344)(0.5) = 0.06672$\n$\\alpha_3(Y) = [\\alpha_2(X) a_{XY} + \\alpha_2(Y) a_{YY}] b_Y(O_3) = [(0.132)(0.2) + (0.0928)(0.7)] (0.2) = [0.0264 + 0.06496](0.2) = (0.09136)(0.2) = 0.018272$\n\n- **终止：**\n最终概率是最终前向变量之和：\n$P(O) = \\alpha_3(X) + \\alpha_3(Y) = 0.06672 + 0.018272 = 0.084992$。\n结果与通过完全枚举得到的结果相匹配，这起到了验证作用。\n\n**第 3 部分：复杂度比较**\n\n- **(i) 完全枚举：**\n  对于 $N^T$ 个可能的隐状态序列中的每一个，其联合概率的计算涉及 $(T-1)$ 次转移概率乘法和 $T$ 次发射概率乘法，每个序列总共需要 $2T-1$ 次乘法。\n  这 $N^T$ 个概率的总和需要 $N^T-1$ 次加法。\n  对于 $N=2$ 和 $T=3$：\n  - 乘法次数：$N^T (2T-1) = 2^3 (2 \\cdot 3 - 1) = 8 \\times 5 = 40$。\n  - 加法次数：$N^T - 1 = 2^3 - 1 = 7$。\n\n- **(ii) 前向算法：**\n  前向算法的复杂度主要由递推步骤决定，该步骤执行 $T-1$ 次。在每个步骤中，对于 $N$ 个状态中的每一个，我们计算一个 $N$ 项之和（需要 $N$ 次乘法和 $N-1$ 次加法），然后再进行一次乘法。这使得每个时间步需要 $N(N)$ 次乘法和 $N(N-1)$ 次加法，再加上与发射概率相乘所需的 $N$ 次乘法。初始化步骤需要 $N$ 次乘法。终止步骤需要 $N-1$ 次加法。总复杂度约为 $O(N^2 T)$。\n  对于 $N=2$ 和 $T=3$：\n  - 乘法次数：\n    - $t=1$: $N=2$ 次乘法。\n    - $t=2$: $N(N) + N = 2(2) + 2 = 6$ 次乘法。\n    - $t=3$: $N(N) + N = 2(2) + 2 = 6$ 次乘法。\n    - 总计：$2 + 6 + 6 = 14$。\n  - 加法次数：\n    - $t=1$: $0$ 次加法。\n    - $t=2$: $N(N-1) = 2(2-1) = 2$ 次加法。\n    - $t=3$: $N(N-1) = 2(2-1) = 2$ 次加法。\n    - 终止：$N-1 = 1$ 次加法。\n    - 总计：$2 + 2 + 1 = 5$。\n\n前向算法的效率要高得多，特别是对于较长的序列，因为它避免了枚举所有路径的指数级复杂度。\n\n**最终答案**\n观测序列 $(A, B, A)$ 的概率为 $0.084992$。问题要求将此值四舍五入到四位有效数字。前四位有效数字是 $8$、$4$、$9$、$9$。其后的数字是 $2$，小于 $5$，因此我们向下舍入（即不改变最后一位有效数字）。\n四舍五入后的概率是 $0.08499$。", "answer": "$$\\boxed{0.08499}$$", "id": "3128474"}]}