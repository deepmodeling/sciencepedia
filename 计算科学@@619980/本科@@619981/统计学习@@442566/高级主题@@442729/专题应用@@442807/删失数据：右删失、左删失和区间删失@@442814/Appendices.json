{"hands_on_practices": [{"introduction": "第一个实践练习处理生存分析的基石：从右删失数据中非参数地估计生存函数。我们不仅要学习如何应用Kaplan-Meier公式，更要深入其理论基础，以推导出其方差的Greenwood公式。掌握这个练习 [@problem_id:3107041] 将巩固你对如何量化生存估计不确定性的理解。", "problem": "一项生物医学研究观察了右删失情况下的生存时间。对于受试者 $i$，令 $T_i$ 为其失败时间，$C_i$ 为其删失时间，且删失是独立的。观测数据为 $(X_i, \\Delta_i)$，其中 $X_i = \\min(T_i, C_i)$ 且 $\\Delta_i = \\mathbf{1}\\{T_i \\leq C_i\\}$。定义生存函数 $S(t) = \\mathbb{P}(T > t)$，累积风险函数 $\\Lambda(t) = \\int_0^t \\lambda(u)\\,\\mathrm{d}u$，以及根据在不同观测事件时间点的经验跳跃构建的 Kaplan–Meier (KM) 估计量 $\\hat{S}(t)$。该研究追踪了 $n = 10$ 名个体，其观测数据对为\n$$\n\\{(t_i, \\delta_i)\\}_{i=1}^{10} = \\{(1.5,1),\\ (2.0,0),\\ (3.0,1),\\ (4.0,1),\\ (5.5,0),\\ (6.0,1),\\ (7.0,0),\\ (7.5,1),\\ (8.0,1),\\ (9.0,0)\\},\n$$\n其中 $t_i$ 的单位是月，$\\delta_i \\in \\{0,1\\}$ 表示删失（$0$）或事件（$1$）。假设为非信息性右删失，且潜在的失败时间分布是连续的。\n\n从右删失、风险过程 $Y(t) = \\sum_{i=1}^{n} \\mathbf{1}\\{X_i \\geq t\\}$ 和计数过程 $N(t) = \\sum_{i=1}^{n} \\mathbf{1}\\{X_i \\leq t,\\ \\Delta_i=1\\}$ 的基本定义出发，通过以下步骤推导在固定时间 $t$ 处 $\\hat{S}(t)$ 的影响函数：\n- 在独立右删失条件下，建立 $\\Lambda(t)$ 的 Nelson–Aalen 估计量的影响函数，\n- 应用泛函 delta 方法将累积风险映射到生存函数，\n- 仔细地线性化 $\\hat{S}(t)$ 的乘积-极限形式，以获得一个经过右删失调整的影响函数表示，从而导出 $\\hat{S}(t)$ 的经典大样本方差，即 Greenwood 公式。\n\n然后，使用所提供的数据集，计算在 $t = 8.0$ 个月时的 Kaplan-Meier 估计值 $\\hat{S}(8.0)$ 以及 $\\hat{S}(8.0)$ 的 Greenwood 大样本方差。将估计的渐近方差的最终数值表示为一个实数，并将您的答案四舍五入到四位有效数字。无需物理单位。", "solution": "用户需要对一个生存分析问题进行详细的推导和计算。\n\n### 第一步：问题验证\n\n**1.1. 提取已知条件**\n\n- **模型：**右删失生存数据。$T_i$ 是失败时间，$C_i$ 是删失时间。删失是独立的和非信息性的。\n- **观测数据：**对于受试者 $i$，数据为 $(X_i, \\Delta_i)$，其中 $X_i = \\min(T_i, C_i)$ 且 $\\Delta_i = \\mathbf{1}\\{T_i \\leq C_i\\}$。\n- **定义：**\n    - 生存函数：$S(t) = \\mathbb{P}(T > t)$。\n    - 累积风险函数：$\\Lambda(t) = \\int_0^t \\lambda(u)\\,\\mathrm{d}u$。\n    - 风险过程：$Y(t) = \\sum_{i=1}^{n} \\mathbf{1}\\{X_i \\geq t\\}$。\n    - 计数过程：$N(t) = \\sum_{i=1}^{n} \\mathbf{1}\\{X_i \\leq t, \\Delta_i=1\\}$。\n    - Kaplan-Meier (KM) 估计量：$\\hat{S}(t)$。\n- **数据集：**$n = 10$ 名受试者，数据为 $\\{(t_i, \\delta_i)\\}_{i=1}^{10} = \\{(1.5,1), (2.0,0), (3.0,1), (4.0,1), (5.5,0), (6.0,1), (7.0,0), (7.5,1), (8.0,1), (9.0,0)\\}$。时间单位为月。\n- **任务：**\n    1. 使用涉及 Nelson-Aalen 估计量、泛函 delta 方法和乘积-极限公式线性化的指定路径，推导 $\\hat{S}(t)$ 的影响函数，最终得到 Greenwood 方差公式。\n    2. 使用提供的数据集，计算 $\\hat{S}(8.0)$ 及其使用 Greenwood 公式的大样本方差。\n\n**1.2. 使用提取的已知条件进行验证**\n\n- **结论：**该问题有效。\n- **推理：**\n    - **科学上成立：**该问题是生存分析中的一个标准练习，是生物统计学和统计学习的核心课题。所有引入的概念——右删失、Kaplan-Meier 估计、Nelson-Aalen 估计、影响函数、计数过程和 Greenwood 公式——都是该领域的基础且得到公认的。\n    - **提法明确：**该问题提供了进行推导和计算所需的所有必要数据和理论构造。要求具体，并能导出一个唯一的、有意义的解。\n    - **客观性：**问题以精确、形式化的数学和统计语言陈述，没有歧义或主观性。\n    - 该问题不违反任何无效标准。它在指定的科学领域内是一个完整、一致且可形式化的问题。\n\n### 第二步：推导与求解\n\n求解过程分为两部分：首先是影响函数和方差的理论推导，其次是使用所提供数据集的数值计算。\n\n**第一部分：理论推导**\n\n主要目标是找到 $\\hat{S}(t) - S(t)$ 的一个渐近表示，该表示能揭示每个观测值的影响。由此可以得到影响函数和渐近方差的公式。\n\n**1.1. Nelson-Aalen 估计量的影响函数**\n\n累积风险函数 $\\Lambda(t) = \\int_0^t \\lambda(u)\\,\\mathrm{d}u$ 的 Nelson-Aalen (NA) 估计量由一个 Stieltjes 积分给出：\n$$\n\\hat{\\Lambda}_{NA}(t) = \\int_0^t \\frac{\\mathrm{d}N(u)}{Y(u)} = \\sum_{j: t_j \\leq t, \\delta_j=1} \\frac{1}{Y(t_j)}\n$$\n其中 $t_j$ 是不同的事件时间。\n\n为了理解 $\\hat{\\Lambda}_{NA}(t)$ 的性质，我们使用计数过程理论。对于每个受试者 $i$，我们定义计数过程 $N_i(t) = \\mathbf{1}\\{X_i \\leq t, \\Delta_i=1\\}$ 和风险过程 $Y_i(t) = \\mathbf{1}\\{X_i \\geq t\\}$。过程 $M_i(t) = N_i(t) - \\int_0^t Y_i(u)\\,\\mathrm{d}\\Lambda(u)$ 是一个零均值鞅。聚合过程是 $N(t) = \\sum_i N_i(t)$ 和 $Y(t) = \\sum_i Y_i(t)$，聚合鞅是 $M(t) = \\sum_i M_i(t)$。\n\n我们可以将差值 $\\hat{\\Lambda}_{NA}(t) - \\Lambda(t)$ 写为：\n$$\n\\hat{\\Lambda}_{NA}(t) - \\Lambda(t) = \\int_0^t \\frac{\\mathrm{d}N(u)}{Y(u)} - \\int_0^t \\mathrm{d}\\Lambda(u) = \\int_0^t \\frac{\\mathrm{d}N(u) - Y(u)\\mathrm{d}\\Lambda(u)}{Y(u)}\n$$\n代入 $\\mathrm{d}N(u) = \\mathrm{d}M(u) + Y(u)\\mathrm{d}\\Lambda(u)$，我们得到：\n$$\n\\hat{\\Lambda}_{NA}(t) - \\Lambda(t) = \\int_0^t \\frac{\\mathrm{d}M(u)}{Y(u)} = \\sum_{i=1}^n \\int_0^t \\frac{\\mathrm{d}M_i(u)}{Y(u)}\n$$\n对于大的 $n$，根据大数定律，有 $Y(u)/n \\to \\pi(u) = \\mathbb{P}(X_i \\geq u) = S(u-)P(C_i \\geq u-)$。因此我们可以用 $n\\pi(u)$ 来近似 $Y(u)$。\n$$\n\\hat{\\Lambda}_{NA}(t) - \\Lambda(t) \\approx \\sum_{i=1}^n \\int_0^t \\frac{\\mathrm{d}M_i(u)}{n\\pi(u)} = \\frac{1}{n} \\sum_{i=1}^n \\int_0^t \\frac{\\mathrm{d}M_i(u)}{\\pi(u)}\n$$\n这个表示表明 $\\hat{\\Lambda}_{NA}(t) - \\Lambda(t)$ 渐近地是独立同分布项的和。第 $i$ 个受试者对 $\\hat{\\Lambda}_{NA}(t)$ 的影响函数 (IF) 是和式中的项：\n$$\nIF_i(\\hat{\\Lambda}_{NA}, t) = \\int_0^t \\frac{\\mathrm{d}M_i(u)}{\\pi(u)} = \\int_0^t \\frac{\\mathrm{d}N_i(u) - Y_i(u)\\mathrm{d}\\Lambda(u)}{\\pi(u)}\n= \\frac{\\Delta_i \\mathbf{1}\\{X_i \\leq t\\}}{\\pi(X_i)} - \\int_0^t \\frac{Y_i(u)\\mathrm{d}\\Lambda(u)}{\\pi(u)}\n$$\n\n**1.2. 从累积风险到生存函数**\n\nKaplan-Meier 估计量由乘积-极限公式定义：\n$$\n\\hat{S}(t) = \\prod_{u \\leq t} \\left(1 - \\frac{\\mathrm{d}N(u)}{Y(u)}\\right)\n$$\n真实的生存函数可以表示为累积风险的乘积积分：$S(t) = \\prod_{u \\leq t}(1 - \\mathrm{d}\\Lambda(u))$。为了找到 $\\hat{S}(t)$ 的影响函数，我们将该估计量线性化。一个常用的方法是首先对对数进行线性化：\n$$\n\\ln \\hat{S}(t) = \\sum_{u \\leq t} \\ln\\left(1 - \\frac{\\mathrm{d}N(u)}{Y(u)}\\right)\n$$\n对小的 $x$ 使用泰勒展开 $\\ln(1-x) \\approx -x$，并注意到 $\\mathrm{d}N(u)/Y(u)$ 很小，我们有：\n$$\n\\ln \\hat{S}(t) \\approx \\sum_{u \\leq t} -\\frac{\\mathrm{d}N(u)}{Y(u)} = -\\hat{\\Lambda}_{NA}(t)\n$$\n类似地，$\\ln S(t) = \\sum_{u \\leq t} \\ln(1 - \\mathrm{d}\\Lambda(u)) \\approx -\\int_0^t \\mathrm{d}\\Lambda(u) = -\\Lambda(t)$。\n这给出了近似式 $\\ln \\hat{S}(t) - \\ln S(t) \\approx -(\\hat{\\Lambda}_{NA}(t) - \\Lambda(t))$。\n进行指数化和线性化 $\\exp(x) \\approx 1+x$，得到：\n$$\n\\hat{S}(t) = S(t) \\exp(\\ln \\hat{S}(t) - \\ln S(t)) \\approx S(t) (1 + \\ln \\hat{S}(t) - \\ln S(t)) \\approx S(t) (1 - (\\hat{\\Lambda}_{NA}(t) - \\Lambda(t)))\n$$\n整理后得到关键关系：\n$$\n\\hat{S}(t) - S(t) \\approx -S(t) (\\hat{\\Lambda}_{NA}(t) - \\Lambda(t))\n$$\n这是泛函 delta 方法的一个应用，其中对于连续情况，映射为 $\\phi(\\Lambda) = \\exp(-\\Lambda(t))$，其导数为 $-\\exp(-\\Lambda(t))=-S(t)$。基于 Duhamel 方程的更严格的论证证实了这一结果。\n\n代入 $\\hat{\\Lambda}_{NA}(t)$ 的影响函数表示，我们得到 $\\hat{S}(t)$ 的影响函数：\n$$\nIF_i(\\hat{S}, t) = -S(t) IF_i(\\hat{\\Lambda}_{NA}, t) = -S(t) \\int_0^t \\frac{\\mathrm{d}M_i(u)}{\\pi(u)}\n$$\n\n**1.3. 渐近方差和 Greenwood 公式**\n\n$\\sqrt{n}(\\hat{S}(t) - S(t))$ 的渐近方差由影响函数的方差 $\\mathbb{E}[IF_i(\\hat{S},t)^2]$ 给出。\n$$\n\\text{Var}(\\sqrt{n}(\\hat{S}(t)-S(t))) \\approx \\mathbb{E}[IF_i(\\hat{S},t)^2] = S(t)^2 \\mathbb{E}\\left[ \\left(\\int_0^t \\frac{\\mathrm{d}M_i(u)}{\\pi(u)}\\right)^2 \\right]\n$$\n根据关于鞅的随机积分的性质，方差为：\n$$\n\\mathbb{E}\\left[\\int_0^t \\frac{\\mathrm{d}\\langle M_i \\rangle_u}{\\pi(u)^2}\\right] = \\int_0^t \\frac{\\mathbb{E}[\\mathrm{d}\\langle M_i \\rangle_u]}{\\pi(u)^2}\n$$\n可预测变差是 $\\mathrm{d}\\langle M_i \\rangle_u = Y_i(u)(1-\\mathrm{d}\\Lambda(u))\\mathrm{d}\\Lambda(u)$，其期望是 $\\pi(u)(1-\\mathrm{d}\\Lambda(u))\\mathrm{d}\\Lambda(u)$。\n所以，$\\sqrt{n}(\\hat{S}(t)-S(t))$ 的渐近方差是：\n$$\nS(t)^2 \\int_0^t \\frac{(1-\\mathrm{d}\\Lambda(u))\\mathrm{d}\\Lambda(u)}{\\pi(u)}\n$$\n为了从数据中估计这个方差，我们用经验对应物替换理论量。积分变成了对观测到的事件时间 $t_j$ 的求和。我们用 $d_j/Y_j$ 来估计 $\\mathrm{d}\\Lambda(t_j)$，用 $Y_j/n$ 来估计 $\\pi(t_j)$。$\\hat{S}(t)$ 的方差（未被 $\\sqrt{n}$ 缩放）的估计量是：\n$$\n\\widehat{\\text{Var}}(\\hat{S}(t)) = \\frac{1}{n} \\hat{S}(t)^2 \\left( \\sum_{j: t_j \\leq t} \\frac{(1-d_j/Y_j)(d_j/Y_j)}{Y_j/n} \\right) = \\hat{S}(t)^2 \\sum_{j: t_j \\leq t} \\frac{d_j(Y_j-d_j)}{Y_j^3}\n$$\n这个公式渐近地等价于 Greenwood 公式。Greenwood 公式是从有限样本（超几何）论证中推导出来的，由于其在小样本中表现更佳而通常被优先使用。其形式为：\n$$\n\\widehat{\\text{Var}}_{GW}(\\hat{S}(t)) = \\hat{S}(t)^2 \\sum_{j: t_j \\leq t} \\frac{d_j}{Y_j(Y_j - d_j)}\n$$\n对于大的 $Y_j$，$Y_j-d_j \\approx Y_j$，所以 $\\frac{d_j}{Y_j(Y_j-d_j)} \\approx \\frac{d_j}{Y_j^2}$，这与基于鞅的估计相差一个因子 $(Y_j-d_j)/Y_j$。两种方法都导出渐近等价的结果，这证明了使用 Greenwood 公式作为“经典大样本方差”的合理性。\n\n**第二部分：数值计算**\n\n我们为给定数据计算 $\\hat{S}(8.0)$ 及其方差。排序后的观测时间是 $1.5_E, 2.0_C, 3.0_E, 4.0_E, 5.5_C, 6.0_E, 7.0_C, 7.5_E, 8.0_E, 9.0_C$，其中 E 表示事件，C 表示删失。不同的事件时间是 $1.5, 3.0, 4.0, 6.0, 7.5, 8.0$。由于所有事件时间都是唯一的，所以在每个事件时间 $t_j$ 的事件数 $d_j$ 均为 1。\n\n我们构建 Kaplan-Meier 表：\n- $t_j$：不同的事件时间。\n- $Y_j = Y(t_j)$：在时间 $t_j$ 之前处于风险中的受试者数量。\n- $d_j$：在时间 $t_j$ 的事件数。\n\n| 事件时间 $t_j$ | 风险人数 $Y_j$ | 事件数 $d_j$ | 生存因子 $(1-d_j/Y_j)$ | KM 估计值 $\\hat{S}(t_j)$ | Greenwood 项 $\\frac{d_j}{Y_j(Y_j-d_j)}$ |\n|---|---|---|---|---|---|\n| $1.5$ | $10$ | $1$ | $1 - \\frac{1}{10} = 0.9$ | $1.0 \\times 0.9 = 0.90$ | $\\frac{1}{10(9)} = \\frac{1}{90}$ |\n| $3.0$ | $8$ | $1$ | $1 - \\frac{1}{8} = 0.875$ | $0.90 \\times 0.875 = 0.7875$ | $\\frac{1}{8(7)} = \\frac{1}{56}$ |\n| $4.0$ | $7$ | $1$ | $1 - \\frac{1}{7} \\approx 0.8571$ | $0.7875 \\times \\frac{6}{7} \\approx 0.675$ | $\\frac{1}{7(6)} = \\frac{1}{42}$ |\n| $6.0$ | $5$ | $1$ | $1 - \\frac{1}{5} = 0.8$ | $0.675 \\times 0.8 = 0.54$ | $\\frac{1}{5(4)} = \\frac{1}{20}$ |\n| $7.5$ | $3$ | $1$ | $1 - \\frac{1}{3} \\approx 0.6667$ | $0.54 \\times \\frac{2}{3} = 0.36$ | $\\frac{1}{3(2)} = \\frac{1}{6}$ |\n| $8.0$ | $2$ | $1$ | $1 - \\frac{1}{2} = 0.5$ | $0.36 \\times 0.5 = 0.18$ | $\\frac{1}{2(1)} = \\frac{1}{2}$ |\n\n**2.1. $\\hat{S}(8.0)$ 的计算**\n\n在 $t=8.0$ 时的 Kaplan-Meier 估计是在 $t=8.0$ 的事件发生后计算的值。\n$$\n\\hat{S}(8.0) = \\left(1-\\frac{1}{10}\\right)\\left(1-\\frac{1}{8}\\right)\\left(1-\\frac{1}{7}\\right)\\left(1-\\frac{1}{5}\\right)\\left(1-\\frac{1}{3}\\right)\\left(1-\\frac{1}{2}\\right)\n$$\n$$\n\\hat{S}(8.0) = \\frac{9}{10} \\times \\frac{7}{8} \\times \\frac{6}{7} \\times \\frac{4}{5} \\times \\frac{2}{3} \\times \\frac{1}{2}\n$$\n$$\n\\hat{S}(8.0) = \\frac{9 \\times 7 \\times 6 \\times 4 \\times 2 \\times 1}{10 \\times 8 \\times 7 \\times 5 \\times 3 \\times 2} = \\frac{9 \\times 6 \\times 4}{10 \\times 8 \\times 5 \\times 3} = \\frac{216}{1200} = \\frac{9}{50} = 0.18\n$$\n\n**2.2. $\\hat{S}(8.0)$ 方差的计算**\n\n我们使用 Greenwood 公式：$\\widehat{\\text{Var}}_{GW}(\\hat{S}(t)) = \\hat{S}(t)^2 \\sum_{j: t_j \\leq t} \\frac{d_j}{Y_j(Y_j - d_j)}$。对于 $t=8.0$，求和包含表中计算的所有项。\n$$\n\\sum_{j: t_j \\leq 8.0} \\frac{d_j}{Y_j(Y_j-d_j)} = \\frac{1}{90} + \\frac{1}{56} + \\frac{1}{42} + \\frac{1}{20} + \\frac{1}{6} + \\frac{1}{2}\n$$\n为了对分数求和，我们找到一个公分母。$90, 56, 42, 20, 6, 2$ 的最小公倍数是 $2520$。\n$$\n\\text{Sum} = \\frac{28}{2520} + \\frac{45}{2520} + \\frac{60}{2520} + \\frac{126}{2520} + \\frac{420}{2520} + \\frac{1260}{2520} = \\frac{28+45+60+126+420+1260}{2520} = \\frac{1939}{2520}\n$$\n现在，我们可以计算方差：\n$$\n\\widehat{\\text{Var}}_{GW}(\\hat{S}(8.0)) = (\\hat{S}(8.0))^2 \\times \\frac{1939}{2520} = (0.18)^2 \\times \\frac{1939}{2520}\n$$\n$$\n\\widehat{\\text{Var}}_{GW}(\\hat{S}(8.0)) = 0.0324 \\times \\frac{1939}{2520} \\approx 0.0324 \\times 0.769444... \\approx 0.02492999...\n$$\n将最终值四舍五入到四位有效数字得到 $0.02493$。", "answer": "$$\\boxed{0.02493}$$", "id": "3107041"}, {"introduction": "现实世界的数据挑战往往比简单的右删失更复杂，例如区间删失。本练习 [@problem_id:3107138] 介绍了一种强大的组合方法，即使用参数化的加速失效时间（AFT）模型和期望最大化（EM）算法来处理此类数据。你将推导EM算法的核心部分，学习在精确事件时间未知时如何找到最大似然估计。", "problem": "考虑独立事件时间 $T_1,\\dots,T_n$，其协变量为 $\\mathbf{X}_i \\in \\mathbb{R}^p$，由加速失效时间 (AFT) 模型 $\\ln T_i = \\mathbf{X}_i^{\\top}\\beta + \\sigma \\epsilon_i$ 建模，其中 $\\epsilon_i$ 服从标准I型极值（Gumbel，最小值）分布，因此 $T_i \\mid \\mathbf{X}_i$ 服从威布尔分布，其形状参数为 $k = 1/\\sigma$，尺度参数为 $\\lambda_i = \\exp(\\mathbf{X}_i^{\\top}\\beta)$。给定 $\\mathbf{X}_i$ 时 $T_i$ 的威布尔密度函数和分布函数分别为\n$$\nf_i(t \\mid \\beta,k) = \\frac{k}{\\lambda_i}\\left(\\frac{t}{\\lambda_i}\\right)^{k-1}\\exp\\!\\left(-\\left(\\frac{t}{\\lambda_i}\\right)^k\\right), \\quad\nF_i(t \\mid \\beta,k) = 1 - \\exp\\!\\left(-\\left(\\frac{t}{\\lambda_i}\\right)^k\\right),\n$$\n其中 $\\lambda_i = \\exp(\\mathbf{X}_i^{\\top}\\beta)$ 且 $k0$。每个 $T_i$ 都没有被精确观测到；相反，你观测到一个区间 $(L_i, R_i]$ 使得 $T_i \\in (L_i, R_i]$，其中左删失对应 $L_i = 0$，右删失对应 $R_i = \\infty$，而一般区间删失则有 $0  L_i  R_i  \\infty$。\n\n你的目标是通过期望最大化 (EM) 算法来估计 $(\\beta,k)$，方法是将未观测到的精确事件时间 $T_i$ 视为潜在完整数据。设完整数据对数似然是 $\\ln f_i(T_i \\mid \\beta,k)$ 对 $i=1,\\dots,n$ 的总和。在 EM 算法的第 $m$ 次迭代中，当前参数值为 $(\\beta^{(m)},k^{(m)})$，E步计算完整数据对数似然在给定观测区间和当前参数下的条件期望，记为\n$$\nQ(\\beta,k \\mid \\beta^{(m)},k^{(m)}) \\equiv \\mathbb{E}\\!\\left[\\sum_{i=1}^{n} \\ln f_i(T_i \\mid \\beta,k)\\,\\bigg|\\, T_i \\in (L_i, R_i],\\, \\beta^{(m)},k^{(m)}\\right].\n$$\n仅从上述定义和截断分布的条件期望定律出发，推导 $Q(\\beta,k \\mid \\beta^{(m)},k^{(m)})$ 的一个闭式表达式（在相差一个不依赖于 $(\\beta,k)$ 的可加常数的情况下），该表达式用协变量 $\\mathbf{X}_i$ 和在当前参数 $(\\beta^{(m)},k^{(m)})$ 下计算的以下条件期望来表示：\n- $M_{1i}^{(m)} \\equiv \\mathbb{E}^{(m)}\\!\\left[\\ln T_i \\,\\big|\\, T_i \\in (L_i,R_i]\\right]$,\n- $M_{2i}^{(m)}(k) \\equiv \\mathbb{E}^{(m)}\\!\\left[T_i^{k} \\,\\big|\\, T_i \\in (L_i,R_i]\\right]$,\n其中上标 $(m)$ 强调用于这些期望的条件分布是由 $(\\beta^{(m)},k^{(m)})$ 导出的截断威布尔分布。\n\n请提供你关于 $Q(\\beta,k \\mid \\beta^{(m)},k^{(m)})$ 的最终答案，形式为一个单一解析表达式（在相差一个不依赖于 $(\\beta,k)$ 的可加常数的情况下）。不要对 $M_{1i}^{(m)}$ 或 $M_{2i}^{(m)}(k)$ 进行超出其定义的简化。你的最终答案必须是一个单一的闭式表达式，并且不含单位。无需四舍五入。", "solution": "用户要求我为用于期望最大化 (EM) 算法的区间删失威布尔加速失效时间 (AFT) 模型推导Q函数。\n\n### 步骤1：提取已知条件\n\n-   **AFT 模型**: $\\ln T_i = \\mathbf{X}_i^{\\top}\\beta + \\sigma \\epsilon_i$，其中 $T_i$ 是独立事件时间，$\\mathbf{X}_i \\in \\mathbb{R}^p$ 是协变量。\n-   **误差分布**: $\\epsilon_i$ 服从标准I型极值（Gumbel，最小值）分布。\n-   **事件时间分布**: $T_i \\mid \\mathbf{X}_i$ 服从威布尔分布。\n-   **威布尔参数**: 形状参数 $k = 1/\\sigma$ 和尺度参数 $\\lambda_i = \\exp(\\mathbf{X}_i^{\\top}\\beta)$。\n-   **威布尔概率密度函数 (PDF)**: $f_i(t \\mid \\beta,k) = \\frac{k}{\\lambda_i}\\left(\\frac{t}{\\lambda_i}\\right)^{k-1}\\exp\\!\\left(-\\left(\\frac{t}{\\lambda_i}\\right)^k\\right)$。\n-   **威布尔累积分布函数 (CDF)**: $F_i(t \\mid \\beta,k) = 1 - \\exp\\!\\left(-\\left(\\frac{t}{\\lambda_i}\\right)^k\\right)$。\n-   **观测数据**: 对于每个观测值 $i=1, \\dots, n$，观测到区间 $(L_i, R_i]$，使得真实事件时间 $T_i \\in (L_i, R_i]$。\n-   **完整数据**: 未观测到的精确事件时间 $T_i$。\n-   **完整数据对数似然**: $\\sum_{i=1}^{n} \\ln f_i(T_i \\mid \\beta,k)$。\n-   **Q函数定义**: $Q(\\beta,k \\mid \\beta^{(m)},k^{(m)}) \\equiv \\mathbb{E}\\!\\left[\\sum_{i=1}^{n} \\ln f_i(T_i \\mid \\beta,k)\\,\\bigg|\\, T_i \\in (L_i, R_i],\\, \\beta^{(m)},k^{(m)}\\right]$。\n-   **要求的条件期望**:\n    -   $M_{1i}^{(m)} \\equiv \\mathbb{E}^{(m)}\\!\\left[\\ln T_i \\,\\big|\\, T_i \\in (L_i,R_i]\\right]$。\n    -   $M_{2i}^{(m)}(k) \\equiv \\mathbb{E}^{(m)}\\!\\left[T_i^{k} \\,\\big|\\, T_i \\in (L_i,R_i]\\right]$。\n    $\\mathbb{E}^{(m)}$ 上的上标 $(m)$ 表示期望是关于由参数 $(\\beta^{(m)}, k^{(m)})$ 定义的分布计算的。\n\n### 步骤2：使用提取的已知条件进行验证\n\n-   **科学合理**: 该问题基于生存分析、统计建模（威布尔AFT模型）和计算统计学（EM算法）的标准、成熟原理。AFT模型中Gumbel误差分布与威布尔事件时间分布之间的联系是正确的。所有元素都具有科学合理性。\n-   **定义明确**: 问题定义良好。它要求在清晰的定义和约束下推导一个特定的数学对象（Q函数）。存在唯一解。\n-   **客观**: 语言是形式化的、数学化的，没有主观或含糊的陈述。\n-   **完整性和一致性**: 问题为推导提供了所有必要的定义，包括模型、分布以及最终答案应表示成的量。内部设定是一致的。\n\n### 步骤3：结论与行动\n\n问题是**有效的**。我将继续推导。\n\n### Q函数的推导\n\n目标是计算 $Q$ 函数，即完整数据对数似然函数在给定观测数据（区间）和当前参数估计值 $(\\beta^{(m)}, k^{(m)})$ 下的条件期望。\n\n$Q$ 函数定义为：\n$$\nQ(\\beta,k \\mid \\beta^{(m)},k^{(m)}) = \\mathbb{E}^{(m)}\\!\\left[\\sum_{i=1}^{n} \\ln f_i(T_i \\mid \\beta,k)\\,\\bigg|\\, \\{T_j \\in (L_j, R_j]\\}_{j=1}^n \\right]\n$$\n根据期望的线性和观测值 $T_i$ 的独立性，我们可以将其写为单个期望的总和：\n$$\nQ(\\beta,k \\mid \\beta^{(m)},k^{(m)}) = \\sum_{i=1}^{n} \\mathbb{E}^{(m)}\\!\\left[\\ln f_i(T_i \\mid \\beta,k)\\,\\bigg|\\, T_i \\in (L_i, R_i]\\right]\n$$\n让我们首先展开单个观测值的对数似然项 $\\ln f_i(T_i \\mid \\beta,k)$。使用给定的PDF：\n$$\nf_i(T_i \\mid \\beta,k) = \\frac{k}{\\lambda_i}\\left(\\frac{T_i}{\\lambda_i}\\right)^{k-1}\\exp\\!\\left(-\\left(\\frac{T_i}{\\lambda_i}\\right)^k\\right)\n$$\n取自然对数，我们得到：\n$$\n\\ln f_i(T_i \\mid \\beta,k) = \\ln\\left(\\frac{k}{\\lambda_i}\\right) + (k-1)\\ln\\left(\\frac{T_i}{\\lambda_i}\\right) - \\left(\\frac{T_i}{\\lambda_i}\\right)^k\n$$\n$$\n= \\ln(k) - \\ln(\\lambda_i) + (k-1)(\\ln(T_i) - \\ln(\\lambda_i)) - \\frac{T_i^k}{\\lambda_i^k}\n$$\n$$\n= \\ln(k) - \\ln(\\lambda_i) + (k-1)\\ln(T_i) - (k-1)\\ln(\\lambda_i) - \\frac{T_i^k}{\\lambda_i^k}\n$$\n合并含有 $\\ln(\\lambda_i)$ 的项：\n$$\n\\ln f_i(T_i \\mid \\beta,k) = \\ln(k) + (k-1)\\ln(T_i) - k\\ln(\\lambda_i) - \\frac{T_i^k}{\\lambda_i^k}\n$$\n我们已知 $\\lambda_i = \\exp(\\mathbf{X}_i^{\\top}\\beta)$。因此，$\\ln(\\lambda_i) = \\mathbf{X}_i^{\\top}\\beta$。将其代入表达式中：\n$$\n\\ln f_i(T_i \\mid \\beta,k) = \\ln(k) + (k-1)\\ln(T_i) - k\\mathbf{X}_i^{\\top}\\beta - T_i^k \\exp(-k\\mathbf{X}_i^{\\top}\\beta)\n$$\n现在，我们使用参数 $(\\beta^{(m)}, k^{(m)})$，对该表达式关于 $T_i$ 在 $T_i \\in (L_i, R_i]$ 条件下的分布取条件期望。让我们将此期望记为 $\\mathbb{E}^{(m)}[\\cdot \\mid T_i \\in (L_i,R_i]]$。期望是关于随机变量 $T_i$ 计算的。参数 $(\\beta, k)$ 是我们在M步中最大化的函数的参数，因此它们在期望算子中被视为固定值。\n$$\n\\mathbb{E}^{(m)}\\!\\left[\\ln f_i(T_i \\mid \\beta,k)\\,\\bigg|\\, T_i \\in (L_i, R_i]\\right] = \\mathbb{E}^{(m)}\\!\\left[\\ln(k) + (k-1)\\ln(T_i) - k\\mathbf{X}_i^{\\top}\\beta - T_i^k \\exp(-k\\mathbf{X}_i^{\\top}\\beta)\\,\\bigg|\\, T_i \\in (L_i, R_i]\\right]\n$$\n应用期望的线性性质：\n$$\n= \\mathbb{E}^{(m)}\\left[\\ln(k)\\right] + (k-1)\\mathbb{E}^{(m)}\\left[\\ln(T_i)\\,\\big|\\, T_i \\in (L_i,R_i]\\right] - k\\mathbf{X}_i^{\\top}\\beta - \\exp(-k\\mathbf{X}_i^{\\top}\\beta) \\mathbb{E}^{(m)}\\left[T_i^k\\,\\big|\\, T_i \\in (L_i,R_i]\\right]\n$$\n项 $\\ln(k)$、$k-1$、$k\\mathbf{X}_i^{\\top}\\beta$ 和 $\\exp(-k\\mathbf{X}_i^{\\top}\\beta)$ 不涉及随机变量 $T_i$，因此在期望内被视为常数。现在，我们代入定义的量 $M_{1i}^{(m)}$ 和 $M_{2i}^{(m)}(k)$：\n$$\n\\mathbb{E}^{(m)}\\!\\left[\\ln f_i(T_i \\mid \\beta,k)\\,\\bigg|\\, T_i \\in (L_i, R_i]\\right] = \\ln(k) + (k-1)M_{1i}^{(m)} - k\\mathbf{X}_i^{\\top}\\beta - M_{2i}^{(m)}(k) \\exp(-k\\mathbf{X}_i^{\\top}\\beta)\n$$\n完整的 $Q$ 函数是这些项对 $i=1, \\dots, n$ 的总和：\n$$\nQ(\\beta,k \\mid \\beta^{(m)},k^{(m)}) = \\sum_{i=1}^{n} \\left[ \\ln(k) + (k-1)M_{1i}^{(m)} - k\\mathbf{X}_i^{\\top}\\beta - M_{2i}^{(m)}(k) \\exp(-k\\mathbf{X}_i^{\\top}\\beta) \\right]\n$$\n我们可以重组求和中的项：\n$$\nQ(\\beta,k \\mid \\beta^{(m)},k^{(m)}) = n\\ln(k) + (k-1)\\sum_{i=1}^{n} M_{1i}^{(m)} - k\\sum_{i=1}^{n}\\mathbf{X}_i^{\\top}\\beta - \\sum_{i=1}^{n} M_{2i}^{(m)}(k) \\exp(-k\\mathbf{X}_i^{\\top}\\beta)\n$$\n问题要求表达式在相差一个不依赖于优化参数 $(\\beta, k)$ 的可加常数的情况下成立。我们可以展开项 $(k-1)\\sum_{i=1}^{n} M_{1i}^{(m)}$：\n$$\nQ(\\beta,k \\mid \\beta^{(m)},k^{(m)}) = n\\ln(k) + k\\sum_{i=1}^{n} M_{1i}^{(m)} - \\sum_{i=1}^{n} M_{1i}^{(m)} - k\\sum_{i=1}^{n}\\mathbf{X}_i^{\\top}\\beta - \\sum_{i=1}^{n} M_{2i}^{(m)}(k) \\exp(-k\\mathbf{X}_i^{\\top}\\beta)\n$$\n项 $-\\sum_{i=1}^{n} M_{1i}^{(m)}$ 不依赖于 $(\\beta, k)$，因为 $M_{1i}^{(m)}$ 是使用参数 $(\\beta^{(m)}, k^{(m)})$ 从E步预先计算的值。因此，该项是相对于M步最大化的一个可加常数，可以舍去。\n\n$Q$ 函数的最终表达式，在相差一个不依赖于 $(\\beta,k)$ 的可加常数的情况下为：\n$$\nn\\ln(k) + k\\sum_{i=1}^{n} M_{1i}^{(m)} - k\\sum_{i=1}^{n}\\mathbf{X}_i^{\\top}\\beta - \\sum_{i=1}^{n} M_{2i}^{(m)}(k) \\exp(-k\\mathbf{X}_i^{\\top}\\beta)\n$$\n为了清晰起见，可以重排该表达式：\n$$\nn\\ln(k) + k \\sum_{i=1}^{n} \\left(M_{1i}^{(m)} - \\mathbf{X}_i^{\\top}\\beta\\right) - \\sum_{i=1}^{n} M_{2i}^{(m)}(k) \\exp(-k\\mathbf{X}_i^{\\top}\\beta)\n$$\n这就是所求的闭式表达式。", "answer": "$$\\boxed{n\\ln(k) + k \\sum_{i=1}^{n} \\left(M_{1i}^{(m)} - \\mathbf{X}_i^{\\top}\\beta\\right) - \\sum_{i=1}^{n} M_{2i}^{(m)}(k) \\exp(-k\\mathbf{X}_i^{\\top}\\beta)}$$", "id": "3107138"}, {"introduction": "删失不仅影响生存估计，也影响着几乎所有的统计分析，包括回归。本练习 [@problem_id:3107062] 介绍了通用的逆概率删失加权（IPCW）方法，以便对带有删失结果的变量进行回归分析。该练习还强调了稳健性的关键概念，展示了为何标准方法可能会失效，以及稳健损失函数如何提供必要的保障。", "problem": "考虑在右删失情况下的独立同分布观测值。对于每个个体，令真实事件时间为 $T \\geq 0$，删失时间为 $C \\geq 0$，且 $T$ 与 $C$ 相互独立。我们观测到 $Y = \\min\\{T, C\\}$ 和删失指示符 $\\Delta = \\mathbf{1}\\{T \\leq C\\}$。$C$ 的生存函数为 $G(t) = \\mathbb{P}(C > t)$，对于 $T$ 的支撑集中的所有 $t$，该函数严格为正。删失概率逆加权 (IPCW) 使用权重 $\\Delta / G(Y)$ 在独立性假设下对删失进行校正。\n\n我们的目标是通过最小化关于 $\\mu \\in \\mathbb{R}$ 的总体风险来对 $T$ 进行仅含截距的线性回归，我们考虑以下两种损失：\n\n1. 平方损失，$L_{\\text{LS}}(u) = u^{2}$。\n2. 阈值为 $\\kappa  0$ 的 Huber 损失，$L_{\\kappa}(u) = \\rho_{\\kappa}(u)$，其中\n$$\n\\rho_{\\kappa}(u) = \n\\begin{cases}\n\\frac{1}{2} u^{2},  |u| \\leq \\kappa, \\\\\n\\kappa |u| - \\frac{1}{2}\\kappa^{2},  |u|  \\kappa,\n\\end{cases}\n$$\n且相应的得分（导数）函数为\n$$\n\\psi_{\\kappa}(u) = \n\\begin{cases}\nu,  |u| \\leq \\kappa, \\\\\n\\kappa \\, \\operatorname{sign}(u),  |u|  \\kappa.\n\\end{cases}\n$$\n\n定义 IPCW 总体风险\n$$\nQ_{\\text{LS}}(\\mu) = \\mathbb{E}\\!\\left[ \\frac{\\Delta}{G(Y)} \\, L_{\\text{LS}}(T - \\mu) \\right], \n\\qquad \nQ_{\\kappa}(\\mu) = \\mathbb{E}\\!\\left[ \\frac{\\Delta}{G(Y)} \\, \\rho_{\\kappa}(T - \\mu) \\right].\n$$\n\n假设 $T$ 服从尺度为 $t_{0} = 1$、形状参数为 $\\alpha  0$ 的 Pareto 分布，因此 $T \\in [1, \\infty)$，其概率密度函数为 $f_{T}(t) = \\alpha \\, t^{-(\\alpha + 1)}$，累积分布函数为 $F_{T}(t) = 1 - t^{-\\alpha}$（对于 $t \\geq 1$）。\n\n任务：\n- 仅使用定义以及 $T$ 和 $C$ 的独立性，证明 $Q_{\\text{LS}}(\\mu) = \\mathbb{E}\\!\\left[(T - \\mu)^{2}\\right]$ 和 $Q_{\\kappa}(\\mu) = \\mathbb{E}\\!\\left[\\rho_{\\kappa}(T - \\mu)\\right]$。然后，通过分析总体风险及其一阶条件的存​​在性和良定性，解释为什么当 $T$ 具有无穷均值的重尾（即 $\\alpha \\leq 1$）时，IPCW 最小二乘估计量可能是不一致的。\n- 提出一种基于 Huber 损失的稳健 IPCW 回归，并推导其最小化子 $\\mu_{\\kappa}^{\\star}$ 的总体一阶条件为 $\\mathbb{E}\\!\\left[\\psi_{\\kappa}(T - \\mu_{\\kappa}^{\\star})\\right] = 0$。简要说明为什么当 $\\alpha  1$ 时 $Q_{\\kappa}(\\mu)$ 是有限的，即使对于 $\\alpha \\leq 2$ 时 $\\mathbb{E}\\!\\left[T^{2}\\right] = \\infty$。\n- 在 Huber 阈值趋于零的极限情况下，即 $\\kappa \\to 0$，Huber 损失简化为绝对损失 $L_{1}(u) = |u|$。在给定的 Pareto 模型下，计算 $Q_{1}(\\mu) = \\mathbb{E}\\!\\left[ \\frac{\\Delta}{G(Y)} \\, |T - \\mu| \\right]$ 的唯一 IPCW 总体最小化子 $\\mu^{\\star}$，作为 $\\alpha$ 的闭式函数。你的最终答案必须是一个单一的解析表达式。不需要四舍五入。", "solution": "该问题被评估为有效。它在统计学习和生存分析方面具有科学依据，问题良定、客观且内部一致。我们开始解题。\n\n该问题要求进行几项与删失概率逆加权 (IPCW) 相关的推导和计算，这些推导和计算适用于不同损失函数下的仅含截距回归模型。\n\n首先，我们建立 IPCW 的基本性质。对于真实事件时间 $T$ 的任意函数 $h(T)$，只要 $\\mathbb{E}[|h(T)|]$ 有限，那么 $h(T)$ 在观测数据上的 IPCW 加权期望等于 $h(T)$ 的真实期望。具体来说，我们证明 $\\mathbb{E}\\left[ \\frac{\\Delta}{G(Y)} h(T) \\right] = \\mathbb{E}[h(T)]$。\n\n期望是关于 $T$ 和 $C$ 的联合分布计算的。设它们各自的概率密度函数为 $f_T(t)$ 和 $f_C(c)$。由于它们的独立性，联合密度为 $f_{T,C}(t,c) = f_T(t)f_C(c)$。期望的定义是：\n$$\n\\mathbb{E}\\left[ \\frac{\\Delta}{G(Y)} h(T) \\right] = \\int_0^\\infty \\int_0^\\infty \\frac{\\mathbf{1}\\{t \\leq c\\}}{G(\\min\\{t, c\\})} h(t) f_T(t) f_C(c) \\,dc \\,dt\n$$\n指示函数 $\\mathbf{1}\\{t \\leq c\\}$ 将积分域限制在 $t \\leq c$ 的区域。在该区域中，观测时间为 $Y = \\min\\{t, c\\} = t$。将此代入表达式可得：\n$$\n\\mathbb{E}\\left[ \\frac{\\Delta}{G(Y)} h(T) \\right] = \\int_0^\\infty \\left( \\int_t^\\infty \\frac{h(t)}{G(t)} f_T(t) f_C(c) \\,dc \\right) \\,dt\n$$\n由于 $h(t)$、$f_T(t)$ 和 $G(t)$ 不依赖于 $c$，我们可以将它们从内层积分中提出来：\n$$\n\\mathbb{E}\\left[ \\frac{\\Delta}{G(Y)} h(T) \\right] = \\int_0^\\infty \\frac{h(t)f_T(t)}{G(t)} \\left( \\int_t^\\infty f_C(c) \\,dc \\right) \\,dt\n$$\n内层积分 $\\int_t^\\infty f_C(c) \\,dc$ 是概率 $\\mathbb{P}(C > t)$，根据定义，这是删失时间的生存函数 $G(t)$。$G(t) > 0$（对于 $T$ 支撑集中的所有 $t$）的假设确保了除以 $G(t)$ 是良定的。\n$$\n\\mathbb{E}\\left[ \\frac{\\Delta}{G(Y)} h(T) \\right] = \\int_0^\\infty \\frac{h(t)f_T(t)}{G(t)} G(t) \\,dt = \\int_0^\\infty h(t)f_T(t) \\,dt\n$$\n这个最终的积分就是 $\\mathbb{E}[h(T)]$ 的定义。\n这个一般性结果适用于问题中的特定损失函数：\n对于平方损失，我们令 $h(T) = L_{\\text{LS}}(T - \\mu) = (T - \\mu)^2$。因此，$Q_{\\text{LS}}(\\mu) = \\mathbb{E}\\left[(T - \\mu)^2\\right]$。\n对于 Huber 损失，我们令 $h(T) = L_{\\kappa}(T - \\mu) = \\rho_{\\kappa}(T - \\mu)$。因此，$Q_{\\kappa}(\\mu) = \\mathbb{E}\\left[\\rho_{\\kappa}(T - \\mu)\\right]$。\n\n接下来，我们分析 IPCW 最小二乘估计量在 $T$ 为重尾分布时的不一致性。$Q_{\\text{LS}}(\\mu) = \\mathbb{E}[(T - \\mu)^2]$ 的最小化子可以通过求解一阶条件 $\\frac{d}{d\\mu}Q_{\\text{LS}}(\\mu) = 0$ 找到。\n$$\n\\frac{d}{d\\mu} \\mathbb{E}[(T - \\mu)^2] = \\mathbb{E}\\left[\\frac{d}{d\\mu}(T - \\mu)^2\\right] = \\mathbb{E}[-2(T - \\mu)] = -2\\mathbb{E}[T] + 2\\mu\n$$\n将其设为零，得到总体最小化子 $\\mu^{\\star}_{\\text{LS}} = \\mathbb{E}[T]$。\n问题陈述 $T$ 服从尺度为 $t_0=1$、形状为 $\\alpha > 0$ 的 Pareto 分布。我们来计算其期望值：\n$$\n\\mathbb{E}[T] = \\int_1^\\infty t \\cdot f_T(t) \\,dt = \\int_1^\\infty t \\cdot \\alpha t^{-(\\alpha+1)} \\,dt = \\alpha \\int_1^\\infty t^{-\\alpha} \\,dt\n$$\n这个积分仅当指数小于 $-1$ 时收敛，即 $-\\alpha  -1$，这意味着 $\\alpha > 1$。如果 $\\alpha \\leq 1$，积分发散，$\\mathbb{E}[T]$ 为无穷大。\n如果 $\\alpha \\leq 1$，总体均值 $\\mathbb{E}[T]$ 不作为有限数存在。因此，总体风险 $Q_{\\text{LS}}(\\mu) = \\mathbb{E}[T^2] - 2\\mu\\mathbb{E}[T] + \\mu^2$ 不是良定的，因为其项是无穷的。试图估计一个无穷量的经验估计量不会收敛到一个固定值，这意味着该估计量是不一致的。\n\n现在，我们考虑基于 Huber 损失的稳健 IPCW 回归。总体风险为 $Q_{\\kappa}(\\mu) = \\mathbb{E}[\\rho_{\\kappa}(T - \\mu)]$。为了找到最小化子 $\\mu_{\\kappa}^{\\star}$，我们将其关于 $\\mu$ 的导数设为零。假设我们可以交换微分和期望的顺序：\n$$\n\\frac{d}{d\\mu} Q_{\\kappa}(\\mu) = \\mathbb{E}\\left[ \\frac{d}{d\\mu} \\rho_{\\kappa}(T - \\mu) \\right] = \\mathbb{E}\\left[ -\\psi_{\\kappa}(T - \\mu) \\cdot 1 \\right] = -\\mathbb{E}\\left[\\psi_{\\kappa}(T - \\mu)\\right]\n$$\n将导数设为零，得到最小化子 $\\mu_{\\kappa}^{\\star}$ 的总体一阶条件：\n$$\n\\mathbb{E}\\left[\\psi_{\\kappa}(T - \\mu_{\\kappa}^{\\star})\\right] = 0\n$$\n如果 $\\alpha > 1$，风险 $Q_{\\kappa}(\\mu) = \\mathbb{E}[\\rho_{\\kappa}(T-\\mu)]$ 是有限的。对于其参数 $u$ 的较大值，Huber 损失 $\\rho_{\\kappa}(u)$ 呈线性增长，即 $\\rho_{\\kappa}(u) = \\kappa|u| - \\frac{1}{2}\\kappa^2$。因此，对于较大的 $T$，$\\rho_{\\kappa}(T-\\mu)$ 的行为类似于 $\\kappa T$。因此，$\\mathbb{E}[\\rho_{\\kappa}(T-\\mu)]$ 的存在性取决于 $\\mathbb{E}[T]$ 的存在性，而我们已经证明，当 $\\alpha > 1$ 时 $\\mathbb{E}[T]$ 是有限的。相比之下，平方损失 $L_{\\text{LS}}(T-\\mu)=(T-\\mu)^2$ 对于较大的 $T$ 行为类似于 $T^2$。其期望 $\\mathbb{E}[(T-\\mu)^2]$ 要求 $\\mathbb{E}[T^2]$ 存在。对于 Pareto 分布，$\\mathbb{E}[T^2] = \\int_1^\\infty t^2 \\alpha t^{-(\\alpha+1)} dt = \\alpha \\int_1^\\infty t^{1-\\alpha} dt$，该积分仅当 $1-\\alpha  -1$ 时收敛，即 $\\alpha > 2$。因此，对于 $1  \\alpha \\leq 2$，Huber 风险 $Q_{\\kappa}(\\mu)$ 是有限的，而最小二乘风险 $Q_{\\text{LS}}(\\mu)$ 是无穷的。这证明了 Huber 损失对重尾的稳健性。\n\n最后，我们计算绝对损失 $L_1(u) = |u|$ 的 IPCW 总体最小化子。问题要求找到 $Q_{1}(\\mu) = \\mathbb{E}\\left[ \\frac{\\Delta}{G(Y)} |T - \\mu| \\right]$ 的最小化子 $\\mu^{\\star}$。根据我们最初的推导，这等价于最小化 $\\mathbb{E}[|T - \\mu|]$。\n统计学中一个标准结果是，对于一个随机变量 $X$，使 $\\mathbb{E}[|X - \\mu|]$ 最小化的 $\\mu$ 值是 $X$ 分布的中位数。因此，我们必须找到尺度为 $t_0=1$、形状为 $\\alpha>0$ 的 Pareto 分布的中位数。\n中位数，我们记为 $\\mu^{\\star}$，是满足 $\\mathbb{P}(T \\leq \\mu^{\\star}) = 1/2$ 的值。使用给定的累积分布函数 $F_T(t) = 1 - t^{-\\alpha}$（对于 $t \\geq 1$）：\n$$\nF_T(\\mu^{\\star}) = 1 - (\\mu^{\\star})^{-\\alpha} = \\frac{1}{2}\n$$\n求解 $\\mu^{\\star}$：\n$$\n(\\mu^{\\star})^{-\\alpha} = 1 - \\frac{1}{2} = \\frac{1}{2}\n$$\n$$\n\\mu^{\\star} = \\left(\\frac{1}{2}\\right)^{-1/\\alpha} = (2^{-1})^{-1/\\alpha} = 2^{1/\\alpha}\n$$\n此中位数对于所有 $\\alpha > 0$ 都存在，这突显了基于绝对损失的估计量的稳健性，因为它即使在均值为无穷大（$\\alpha \\leq 1$）时也是良定的。\n唯一的总体最小化子是 $\\mu^{\\star} = 2^{1/\\alpha}$。", "answer": "$$\\boxed{2^{1/\\alpha}}$$", "id": "3107062"}]}