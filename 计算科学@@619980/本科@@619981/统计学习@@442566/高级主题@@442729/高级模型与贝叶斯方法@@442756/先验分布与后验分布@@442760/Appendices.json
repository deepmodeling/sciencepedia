{"hands_on_practices": [{"introduction": "贝叶斯推断的核心在于利用数据更新我们的信念。这个练习提供了一个具体的情景：我们需要观察到多少次连续的成功，才能对一个过程的成功率建立起高度的信心？[@problem_id:1946628] 该问题使用了基础的贝叶斯模型——贝塔-二项分布模型，其中我们关于一个比例 $p$ 的信念会随着成功或失败的数据而更新。这个练习将帮助你直观地理解数据是如何塑造我们的后验信念的。", "problem": "一家材料科学公司开发了一种用于制造光纤的全新实验性工艺。关键的质量指标是制造出的光纤中满足严格信号传输标准的比例 $p$。由于该工艺是全新的，工程团队对其有效性没有任何先验知识。他们决定使用区间 $[0, 1]$ 上的连续均匀分布来对他们关于 $p$ 的初始信念进行建模，这等价于一个参数为 $\\alpha=1$ 和 $\\beta=1$ 的 Beta 分布。\n\n为了更新他们的信念，他们测试了一系列新制造的光纤。他们发现，他们测试的前 $n$ 根光纤全部满足传输标准。为了使比例 $p$ 的后验均值超过 $0.98$，所需的连续成功测试的最小整数次数 $n$ 是多少？", "solution": "成功比例 $p$ 的先验分布为 $p \\sim \\mathrm{Beta}(\\alpha,\\beta)$，其中 $\\alpha=1$ 和 $\\beta=1$。在 Beta-二项共轭模型下，观测到 $S$ 次成功和 $F$ 次失败后，后验分布为 $\\mathrm{Beta}(\\alpha+S,\\beta+F)$。在本题中，前 $n$ 次测试全部成功，所以 $S=n$ 且 $F=0$，得到的后验分布为\n$$\np \\mid \\text{data} \\sim \\mathrm{Beta}(1+n,1).\n$$\n一个 $\\mathrm{Beta}(a,b)$ 分布的均值为 $\\frac{a}{a+b}$，因此后验均值为\n$$\n\\mathbb{E}[p \\mid \\text{data}] = \\frac{n+1}{n+2}.\n$$\n我们要求满足以下条件的最小整数 $n$：\n$$\n\\frac{n+1}{n+2} > 0.98.\n$$\n由于对于所有整数 $n \\geq 0$ 都有 $n+2 > 0$，我们可以在不等式两边同乘以 $n+2$ 而不改变不等号的方向：\n$$\nn+1 > 0.98(n+2).\n$$\n展开并整理可得，\n$$\nn+1 > 0.98n + 1.96 \\quad \\Rightarrow \\quad n - 0.98n > 1.96 - 1 \\quad \\Rightarrow \\quad 0.02\\,n > 0.96.\n$$\n两边同除以 $0.02$（正数）得到\n$$\nn > 48.\n$$\n因此，满足该严格不等式的最小整数 $n$ 是 $n=49$。注意，当 $n=48$ 时，均值为 $\\frac{49}{50}=0.98$，并未超过 $0.98$，这证实了需要 $n=49$。", "answer": "$$\\boxed{49}$$", "id": "1946628"}, {"introduction": "在掌握了关于比例的推断后，让我们将视野拓宽到事件发生率的建模，例如材料中的瑕疵数量或单位时间内的顾客到达数。[@problem_id:1946607] 这个问题引入了另一个重要的共轭先验族：泊松-伽马模型，它是处理此类计数数据的有力工具。通过这个例子，你将看到相同的贝叶斯原理如何应用于不同类型的数据和模型，从而加深对贝叶斯方法的普适性的理解。", "problem": "一个工业过程生产大片的特种聚合物。一位质量控制专家将随机选择的 1 厘米 × 1 厘米方形聚合物样本中发现的微观缺陷数量建模为一个随机变量，该变量服从泊松分布，其未知平均率为每平方厘米 $\\lambda$ 个缺陷。\n\n根据在类似制造过程中的丰富经验，该专家对参数 $\\lambda$ 的先验信念由一个伽马分布建模，其形状参数 $\\alpha = 3$，速率参数 $\\beta = 2$。$\\mathrm{Gamma}(\\alpha, \\beta)$ 分布的概率密度函数由 $f(x; \\alpha, \\beta) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} x^{\\alpha-1} \\exp(-\\beta x)$ 给出，其中 $x > 0$。\n\n然后，该专家取了五个独立的 1 厘米 × 1 厘米方形样本，并观察到以下缺陷数量：4, 2, 0, 3, 1。\n\n根据这些新数据，速率参数 $\\lambda$ 的更新期望值（均值）是多少？请用精确分数表示你的答案。", "solution": "设观测到的计数为 $y_{1},\\dots,y_{n}$，其中 $n=5$ 且 $y_{1},\\dots,y_{5}\\in \\{4,2,0,3,1\\}$。抽样模型假设 $y_{i}\\mid \\lambda \\sim \\text{Poisson}(\\lambda)$ 独立同分布，因此似然函数为\n$$\nL(\\lambda; y_{1:n})=\\prod_{i=1}^{n}\\frac{\\exp(-\\lambda)\\lambda^{y_{i}}}{y_{i}!} \\propto \\lambda^{\\sum_{i=1}^{n} y_{i}} \\exp(-n\\lambda).\n$$\n先验分布为 $\\lambda \\sim \\text{Gamma}(\\alpha,\\beta)$，其密度函数为\n$$\np(\\lambda)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}\\lambda^{\\alpha-1}\\exp(-\\beta \\lambda), \\quad \\lambda>0.\n$$\n根据共轭性，后验分布正比于先验分布和似然函数的乘积：\n$$\np(\\lambda\\mid y_{1:n}) \\propto \\lambda^{\\alpha-1}\\exp(-\\beta \\lambda)\\cdot \\lambda^{\\sum_{i=1}^{n} y_{i}}\\exp(-n\\lambda)\n= \\lambda^{\\alpha+\\sum_{i=1}^{n} y_{i}-1}\\exp\\!\\big(-( \\beta+n)\\lambda\\big),\n$$\n这是 $\\text{Gamma}(\\alpha+\\sum_{i=1}^{n} y_{i},\\, \\beta+n)$ 分布（形状-速率参数化）的核。\n\n对于给定的值 $\\alpha=3$, $\\beta=2$, $n=5$ 和 $\\sum_{i=1}^{5} y_{i}=4+2+0+3+1=10$，后验分布为\n$$\n\\lambda \\mid y_{1:5} \\sim \\text{Gamma}(3+10,\\, 2+5)=\\text{Gamma}(13,7).\n$$\n一个 $\\text{Gamma}(\\alpha',\\beta')$ 分布（速率参数化）的均值是 $\\alpha'/\\beta'$，因此更新后的期望值为\n$$\n\\mathbb{E}[\\lambda \\mid y_{1:5}] = \\frac{13}{7}.\n$$", "answer": "$$\\boxed{\\frac{13}{7}}$$", "id": "1946607"}, {"introduction": "我们是应该一次性获取所有数据，还是分批次地接收它们，这会对最终的结论产生影响吗？[@problem_id:1946578] 这个问题探讨了贝叶斯更新的一个根本性质：数据顺序的无关性。你将证明，无论是将所有观测数据作为一个“批次”进行一次性更新，还是逐个观测进行序贯更新，最终都会得到完全相同的后验信念。这个练习深刻地揭示了贝叶斯框架的内在一致性和逻辑之美。", "problem": "一位质量控制工程师正在评估一种旨在生产高可靠性电子元件的新制造工艺。该工艺的成功率，定义为一个元件无缺陷的概率 $p$，是未知的。工程师对此概率 $p$ 的初始信念被建模为一个服从贝塔分布的随机变量，其已知参数为 $\\alpha > 0$ 和 $\\beta > 0$。该信念的概率密度函数正比于 $p^{\\alpha-1}(1-p)^{\\beta-1}$。\n\n工程师观察了一批新生产的 $n$ 个元件的测试批次。在此批次中，总共有 $k$ 个元件被发现是无缺陷的（成功），因此，有 $n-k$ 个元件是有缺陷的（失败）。工程师希望根据这些观察结果更新他们对 $p$ 的信念。考虑了两种不同的更新方法。\n\n方法1（批量更新）：工程师等到所有 $n$ 个元件都测试完毕。然后，他们使用 $k$ 次成功和 $n-k$ 次失败的总计数一次性更新他们的初始信念（先验）。更新后的信念（后验）是另一个贝塔分布，其新参数我们记为 $(\\alpha_{batch}, \\beta_{batch})$。\n\n方法2（序贯更新）：工程师在每个元件测试后逐一更新其信念。从相同的初始信念 $(\\alpha, \\beta)$ 开始，他们在第一次观察后进行更新。得到的后验分布随即作为第二次观察的先验。对序列中的所有 $n$ 个观察重复此过程。设经过所有 $n$ 次更新后的最终贝塔分布的参数记为 $(\\alpha_{seq}, \\beta_{seq})$。\n\n确定批量更新产生的参数 $\\alpha_{batch}$ 的表达式和序贯更新产生的参数 $\\beta_{seq}$ 的表达式。将您的答案以表达式对 $(\\alpha_{batch}, \\beta_{seq})$ 的形式呈现。", "solution": "我们用一个参数为 $(\\alpha,\\beta)$ 的贝塔先验来为未知的成功概率 $p$ 建模，其密度正比于 $p^{\\alpha-1}(1-p)^{\\beta-1}$。对于有 $k$ 次成功和 $n-k$ 次失败的 $n$ 次独立伯努利试验，其似然函数正比于 $p^{k}(1-p)^{n-k}$。\n\n批量更新：根据贝叶斯法则和贝塔-二项共轭性，后验密度正比于先验和似然的乘积，\n$$\np^{\\alpha-1}(1-p)^{\\beta-1}\\cdot p^{k}(1-p)^{n-k}\n= p^{\\alpha-1+k}(1-p)^{\\beta-1+(n-k)}.\n$$\n这是参数为 $(\\alpha+k,\\beta+n-k)$ 的贝塔分布的核。因此，与 $p$ 的指数相对应的批量更新参数为\n$$\n\\alpha_{batch}=\\alpha+k.\n$$\n\n序贯更新：考虑单次伯努利观测 $x\\in\\{0,1\\}$，其先验为 $\\operatorname{Beta}(a,b)$。似然函数正比于 $p^{x}(1-p)^{1-x}$。那么后验正比于\n$$\np^{a-1}(1-p)^{b-1}\\cdot p^{x}(1-p)^{1-x}\n= p^{(a-1)+x}(1-p)^{(b-1)+(1-x)},\n$$\n这是 $\\operatorname{Beta}(a+x,\\,b+1-x)$ 的核。因此，每次成功（$x=1$）使第一个参数增加1，每次失败（$x=0$）使第二个参数增加1。在 $k$ 次成功和 $n-k$ 次失败后，从 $(\\alpha,\\beta)$ 开始，最终参数为 $(\\alpha+k,\\beta+n-k)$。因此，序贯更新的第二个参数为\n$$\n\\beta_{seq}=\\beta+(n-k).\n$$\n\n因此，所求的参数对是 $(\\alpha_{batch},\\beta_{seq})=(\\alpha+k,\\beta+n-k)$。", "answer": "$$\\boxed{\\begin{pmatrix}\\alpha+k & \\beta+n-k\\end{pmatrix}}$$", "id": "1946578"}]}