{"hands_on_practices": [{"introduction": "许多游戏看似复杂，但其背后可能隐藏着优美的数学结构。本练习将介绍一类被称为“无偏博弈”（impartial game）的游戏，其特点是任何游戏状态下的合法走法仅取决于状态本身，而与轮到哪位玩家无关。我们将通过一个城市规划游戏 [@problem_id:1416843] 来探索如何使用 Sprague-Grundy 定理等工具，通过将复杂的游戏分解为独立的子游戏来确定必胜策略。", "problem": "在计算复杂性理论的研究中，许多完美信息双人博弈可以用来为复杂的决策问题建模。考虑这样一种名为“城市隔离”的游戏，由一名规划者（玩家1）和一名破坏者（玩家2）进行。\n\n游戏在一个由7个地块组成的一维网格上进行，这些地块排成一行，编号从1到7。一些地块可能已经被规划为“住宅区”（R）或“工业区”（I），而其他地块则是空的。双方轮流行动，规划者先走。一步行动包括选择一个空地块，并将其规划为“R”或“I”。\n\n然而，一手棋只有在不产生“住宅区”和“工业区”相邻的情况下才是合法的。例如，如果4号地块被规划为“R”，则玩家不能将3号或5号地块规划为“I”。如果玩家试图走一步会造成这种相邻情况的棋，那么这步棋是被禁止的。\n\n当轮到某位玩家时，如果他/她没有任何合法的棋步可走，游戏就结束了。该玩家输掉游戏，另一位玩家获胜。\n\n假设游戏开始时，7个地块的初始配置如下：\n\n`R _ _ I _ _ R`\n\n（这里，`_` 表示空地块。地块从左到右编号，所以1号地块是“R”，4号地块是“I”，7号地块是“R”，而2、3、5、6号地块是空的）。\n\n假设两位玩家都以最佳方式进行游戏以求获胜，那么下列哪个陈述是正确的？\n\nA. 规划者有必胜策略，该策略以将2号地块规划为“住宅区”开始。\n\nB. 规划者有必胜策略，该策略以将3号地块规划为“工业区”开始。\n\nC. 规划者有必胜策略，但其开局走法与选项A和B中描述的不同。\n\nD. 无论规划者的第一步如何，破坏者都有必胜策略。", "solution": "将该局面建模为两个独立的空地块段的析取和（disjunctive sum），每个段都被已规划好的固定端点所界定。初始配置 $R\\,\\_\\,\\_\\,I\\,\\_\\,\\_\\,R$ 包含两个长度为 $2$、端点类型相反的段：2-3号地块位于R和I之间，5-6号地块位于I和R之间。该游戏是公平博弈（impartial game）（即在任何局面下，双方的可选合法走法都相同）并且采用正常游戏规则（normal play）；因此，斯普拉格-格伦迪（Sprague–Grundy）定理适用。整个局面的Grundy值是各独立段的Grundy值的nim和。\n\n定义 $g_{E}(n)$ 为一个长度为 $n$ 的连续空地块段的Grundy数，其两端端点类型相同；定义 $g_{O}(n)$ 为端点类型相反的情况。基本情况：$g_{E}(0)=0$ 和 $g_{O}(0)=0$ （没有可走的棋步）。\n\n对于 $n=1$：\n- 端点相同：唯一合法的走法是放置与端点相同的区域类型，这会将其分裂成两个长度为0的空段，因此后续局面的值为 $0 \\oplus 0=0$，故 $g_{E}(1)=\\operatorname{mex}\\{0\\}=1$。\n- 端点相反：放置任何一种区域类型都会与其中一端的相反区域相邻，因此没有合法的走法；故 $g_{O}(1)=0$。\n\n对于 $n=2$：\n- 端点相同：在 $j=1$ 的位置上，只有放置与端点匹配的区域类型是合法的，这会产生一个左边长度为0（端点相同）和一个右边长度为1（端点相同）的段，因此后续局面的值为 $0 \\oplus g_{E}(1)=1$。类似地，在 $j=2$ 的位置上，后续局面的值为 $g_{E}(1)\\oplus 0=1$。因此，$g_{E}(2)=\\operatorname{mex}\\{1\\}=0$。\n- 端点相反：在 $j=1$ 的位置上，只有放置与左端点匹配的区域类型是合法的，这会分裂成一个左边长度为0（端点相同）和一个右边长度为1（端点相反）的段，得到 $0 \\oplus g_{O}(1)=0$。在 $j=2$ 的位置上，只有放置与右端点匹配的区域类型是合法的，这会分裂成一个左边长度为1（端点相反）和一个右边长度为0（端点相同）的段，得到 $g_{O}(1)\\oplus 0=0$。因此，$g_{O}(2)=\\operatorname{mex}\\{0\\}=1$。\n\n因此，初始局面中的两个段的Grundy值均为 $g_{O}(2)=1$，总的Grundy值为 $1 \\oplus 1=0$。nim和为0表示这是一个先手败局面（$\\mathcal{P}$-position，即上一个玩家获胜的局面）；因此，在破坏者采取最优策略的情况下，下一个行动者（规划者）处于必败局面。具体来说，规划者任何合法的开局走法都是在2、3、5、6号地块之一填充该位置唯一允许的区域类型；这会立即阻塞该段中的另一个单元格，并使另一个长度为2且端点相反的段保持不变。然后，破坏者在另一个段中填充相应的单元格（这是那里唯一合法的走法），之后将不再有任何合法走法，所以规划者无棋可走而失败。因此，正确的陈述是，无论规划者的第一步如何，破坏者都有必胜策略。", "answer": "$$\\boxed{D}$$", "id": "1416843"}, {"introduction": "并非所有游戏都能找到如前一个练习般简洁的数学结构。本练习 [@problem_id:1416894] 探讨了一种更通用、更根本的策略分析方法：探索博弈的状态空间。我们将通过一个结构化的辩论游戏，学习如何从游戏的终局状态出发，逆向推理出哪些是必胜位置（Winning position），哪些是必败位置（Losing position），这是解决许多逻辑谜题和双人对策游戏的核心技巧。", "problem": "两位辩手，辩手1和辩手2，进行一场结构化的辩论。辩论是通过从一个预定义的列表中陈述命题来构建的。辩手1先手。辩手们轮流进行，每次陈述一个命题。一个命题只有在其所有先决条件都已被任意一方辩手陈述过的情况下，才能被陈述。任何已被陈述过的命题不能再次被陈述。如果轮到某位辩手，而他们无法做出有效行动（即，没有任何可以陈述的命题了），则该辩手判负。\n\n可用的命题集合为 $\\{A, B, C, D, E, F, G\\}$。先决条件结构如下：\n- 命题 $A$ 没有先决条件。\n- 命题 $B$ 需要命题 $A$。\n- 命题 $C$ 需要命题 $A$。\n- 命题 $D$ 需要命题 $B$。\n- 命题 $E$ 需要命题 $C$。\n- 命题 $F$ 需要命题 $D$ 和 $E$。\n- 命题 $G$ 需要命题 $F$。\n\n两位辩手都以获胜为目的进行最优博弈。关于这场博弈，以下哪个陈述是正确的？\n\nA. 辩手1有必胜策略。\n\nB. 辩手2有必胜策略。\n\nC. 如果双方都进行最优博弈，游戏可能以平局告终。\n\nD. 游戏的结果取决于辩手2在第一步选择陈述哪个命题（$B$ 或 $C$）。", "solution": "为了确定谁有必胜策略，我们可以通过探索所有可能移动的博弈树来分析这场博弈。由于双方都进行最优博弈，我们可以为每个博弈状态确定，当前行动的辩手是处于必胜位置还是必败位置。如果当前辩手可以走一步，使对手进入必败位置（L），那么当前位置就是一个必胜位置（W）。如果所有可能的移动都导致对手进入必胜位置，那么当前位置就是一个必败位置（L）。没有任何有效移动的辩手处于必败位置。\n\n让我们从头开始追踪博弈过程。我们将轮到行动的辩手记为 P1（辩手1）或 P2（辩手2）。博弈的状态可以用已经陈述的命题集合来表示。\n\n**行动 1 (P1):**\n初始状态是已陈述命题的空集，$\\emptyset$。唯一没有先决条件的命题是 $A$。因此，辩手1只有一个可能的行动：陈述 $A$。\n*   P1 陈述 $A$。\n*   新状态：$\\{A\\}$。现在轮到辩手2行动。\n\n**行动 2 (P2):**\n已陈述命题的集合是 $\\{A\\}$。P2 可以陈述任何其先决条件在 $\\{A\\}$ 中的命题。这些命题是 $B$ 和 $C$。P2 有两种选择。我们必须分析这两个分支。\n\n*   **情况 1：P2 陈述 $B$。**\n    *   新状态：$\\{A, B\\}$。现在轮到 P1 行动。\n    *   **行动 3 (P1)：** P1 可以陈述任何其先决条件在 $\\{A, B\\}$ 中的命题。有效的行动是 $C$（需要 $A$）和 $D$（需要 $B$）。\n        *   **子情况 1.1：P1 陈述 $C$。**\n            *   新状态：$\\{A, B, C\\}$。现在轮到 P2 行动。\n            *   **行动 4 (P2)：** P2 的有效行动是 $D$（需要 $B$）和 $E$（需要 $C$）。\n                *   让我们从 $\\{A, B, C\\}$ 状态开始分析剩下的博弈。还剩下4个命题：$D, E, F, G$。总行动步数将是 $3+4=7$。走最后一步的辩手获胜。P1 走了第3步。P2 走第4步，P1 走第5步，P2 走第6步，P1 走第7步。P1 走完第7步后，所有命题都被陈述，轮到 P2 时将没有可行的行动。P2 失败，P1 获胜。让我们验证这个序列是强制的。\n                *   从 $\\{A, B, C\\}$ 开始，P2 可以走 $D$ 或 $E$。\n                    *   如果 P2 走 $D$（行动 4）：状态为 $\\{A, B, C, D\\}$。轮到 P1。唯一有效的行动是 $E$。\n                    *   P1 走 $E$（行动 5）：状态为 $\\{A, B, C, D, E\\}$。轮到 P2。唯一有效的行动是 $F$。\n                    *   P2 走 $F$（行动 6）：状态为 $\\{A, B, C, D, E, F\\}$。轮到 P1。唯一有效的行动是 $G$。\n                    *   P1 走 $G$（行动 7）：状态为 $\\{A, B, C, D, E, F, G\\}$。所有命题均已陈述。轮到 P2，没有可行的行动。P2 失败。P1 获胜。\n                *   如果 P2 先选择 $E$，也会出现相同的结果，D 和 E 的角色将在辩手之间交换。如果 P2 走 $E$（行动 4），P1 必须走 $D$（行动 5），P2 必须走 $F$（行动 6），P1 必须走 $G$（行动 7），P2 失败。\n                *   所以，如果 P1 到达状态 $\\{A, B, C\\}$，P1 就有必胜策略。这意味着状态 $\\{A, B, C\\}$ 对当前行动的辩手（P2）来说是一个必败位置（L-position）。\n            *   因此，在子情况 1.1 中，P1 从状态 $\\{A, B\\}$ 陈述 $C$ 的这一步，是把 P2 移动到一个必败位置。这使得状态 $\\{A, B\\}$ 成为 P1 的一个必胜位置（W-position）。\n        *   由于 P1 从状态 $\\{A, B\\}$ 找到了一个必胜的行动（$C$），我们不需要分析 P1 的另一个选项（$D$）。一个最优的 P1 会选择 $C$。\n\n*   **情况 2：P2 陈述 $C$。**\n    *   新状态：$\\{A, C\\}$。现在轮到 P1 行动。\n    *   **行动 3 (P1)：** P1 可以陈述任何其先决条件在 $\\{A, C\\}$ 中的命题。有效的行动是 $B$（需要 $A$）和 $E$（需要 $C$）。\n        *   **子情况 2.1：P1 陈述 $B$。**\n            *   新状态：$\\{A, C, B\\}$。这与子情况 1.1 中的状态 $\\{A, B, C\\}$ 相同。\n            *   正如我们所发现的，这个状态对于当前行动的辩手（P2）来说是一个必败位置。\n            *   因此，P1 从状态 $\\{A, C\\}$ 陈述 $B$ 的这一步，是把 P2 移动到一个必败位置。这使得状态 $\\{A, C\\}$ 成为 P1 的一个必胜位置。\n        *   由于 P1 找到了一个必胜的行动（$B$），我们不需要分析 P1 的另一个选项（$E$）。\n\n**结论：**\n在 P1 必然的第一步（陈述 $A$）之后，博弈处于状态 $\\{A\\}$，轮到 P2 行动。P2 可以选择陈述 $B$ 或 $C$。\n- 如果 P2 选择 $B$，状态变为 $\\{A, B\\}$。我们发现这是一个 P1 的必胜位置。所以 P1 将会获胜。\n- 如果 P2 选择 $C$，状态变为 $\\{A, C\\}$。我们发现这是一个 P1 的必胜位置。所以 P1 将会获胜。\n\n无论哪种情况，不管 P2 的第一步如何走，P1 都能做出确保胜利的应对之策。因此，辩手1从博弈一开始就拥有必胜策略。\n\n我们来评估一下给出的选项：\nA. 辩手1有必胜策略。根据我们的分析，这是正确的。\nB. 辩手2有必胜策略。这是错误的。\nC. 如果双方都进行最优博弈，游戏可能以平局告终。这是错误的。该博弈包含有限数量的行动（7个命题），并在一方辩手无法行动时结束。必定有一方会输。\nD. 游戏的结果取决于辩手2在第一步选择陈述哪个命题（$B$ 或 $C$）。这是错误的。我们已经证明，无论辩手2作何选择，辩手1都会获胜。", "answer": "$$\\boxed{A}$$", "id": "1416894"}, {"introduction": "与前面两个“无偏博弈”不同，本练习将带我们进入“有偏博弈”（partisan game）的世界，其中玩家各自拥有并积累不同的资源。在这个独立集游戏中 [@problem_id:1416871]，你不仅要考虑如何构建自己的获胜条件，还必须时刻防范并阻止对手达成目标。这个练习旨在让你体会攻防转换的策略复杂性，并理解在这些游戏中，分析和创造“威胁”是通往胜利的关键。", "problem": "在一个名为“独立集博弈”的新竞争性游戏中，两名玩家（玩家 A 和玩家 B）轮流从一个给定的图 $G=(V, E)$ 中占有顶点。一旦一个顶点被某个玩家占有，它就不能再被任何一方选择。当一名玩家个人占有的顶点集合中包含一个大小为 $k$ 的独立集时，该玩家立即获胜。独立集是指一个顶点集合，其中任意两个顶点之间都没有边相连。如果所有顶点都被占有，但没有玩家达成目标，则游戏为平局。\n\n考虑此游戏的一个实例，它在一个 7-圈图 $G$ 上进行，其顶点集为 $V = \\{1, 2, 3, 4, 5, 6, 7\\}$，边集为 $E = \\{\\{1,2\\}, \\{2,3\\}, \\{3,4\\}, \\{4,5\\}, \\{5,6\\}, \\{6,7\\}, \\{7,1\\}\\}$。独立集的目标大小为 $k=3$。\n\n游戏正在进行中。玩家 A 已经占有顶点 $\\{1\\}$，玩家 B 已经占有顶点 $\\{4\\}$。现在轮到玩家 A 选择一个未被占有的顶点。\n\n下列哪个陈述是正确的？\n\nA. 玩家 A 在这一轮选择顶点 2 有获胜策略。\n\nB. 玩家 A 在这一轮选择顶点 3 有获胜策略。\n\nC. 玩家 A 在这一轮选择顶点 5 有获胜策略。\n\nD. 玩家 A 在这一轮选择顶点 7 有获胜策略。\n\nE. 玩家 B 有获胜策略，这意味着玩家 A 没有任何走法可以保证获胜。", "solution": "我们在 7-圈图 $C_{7}$ 上进行分析，其顶点集为 $V=\\{1,2,3,4,5,6,7\\}$，边集为 $\\{\\{i,i+1\\}:i=1,\\ldots,6\\}\\cup\\{\\{7,1\\}\\}$。在 $C_{7}$ 上，一个大小为 3 的独立集必定是最大独立集，而所有这样的集合恰好是以下 7 个三元组：\n$$\nS_{j}=\\{j,\\ j+2,\\ j+4\\}\\quad\\text{(下标在 $\\{1,\\ldots,7\\}$ 内模 $7$ 计算)}。\n$$\n根据构造（下标之差模 7 后为 2 或 4），这些集合中的顶点两两不相邻，并且每个最大独立集都具有这种形式。\n\n最初，玩家 A 拥有 $\\{1\\}$，玩家 B 拥有 $\\{4\\}$。现在轮到 A 行动。\n\n考虑 A 在这一轮选择 3。那么 A 就拥有 $\\{1,3\\}$。注意到 $\\{1,3\\}\\subset S_{1}=\\{1,3,5\\}$ 且 $\\{1,3\\}\\subset S_{6}=\\{6,1,3\\}$。因此，A 威胁要通过拿取 5 来完成 $S_{1}$，或者通过拿取 6 来完成 $S_{6}$。对于 B 的回应：\n- 如果 B 拿取 $5$，那么 A 下一步拿取 $6$，并以 $\\{1,3,6\\}$ 获胜。\n- 如果 B 拿取 $6$，那么 A 下一步拿取 $5$，并以 $\\{1,3,5\\}$ 获胜。\n- 如果 B 拿取任何其他顶点，5 和 6 都仍然可用，所以 A 下一步拿取 5 或 6 即可获胜。\nB 不可能在 A 的下一步行动之前获胜，因为 B 目前只有一个顶点（4），还需要两个顶点才能组成一个独立三元组，而 A 将在紧接着的下一步中完成目标。因此，选择 3 能让 A 强制获胜。\n\n为了完整性，我们验证在 B 进行最优博弈的情况下，其他列出的走法不能保证 A 获胜：\n- 如果 A 选择 2，B 可以回应 3。这样一来，A 就无法再利用顶点 1 形成获胜组合（因为 $S_{1}$ 和 $S_{6}$ 都需要 3），而唯一剩下的、通过顶点 2 可构成的三元组是 $S_{5}=\\{2,5,7\\}$。B 总是可以通过拿走 $\\{5,7\\}$ 中 A 尚未拿走的那个顶点来阻止 A，所以 A 没有强制获胜的策略。\n- 如果 A 选择 5，那么直接的单一威胁是 $S_{1}=\\{1,3,5\\}$；B 通过拿取 3 来阻止。之后，A 通过 5 能构成的唯一剩下的三元组是 $S_{5}=\\{2,5,7\\}$，B 总是可以像上面那样继续阻止；因此 A 没有强制获胜策略。\n- 如果 A 选择 7，B 再次回应 3，此举排除了 $S_{1}$ 和 $S_{6}$（这是 A 能以 1 为目标且不含 4 的仅有的三元组）。通过 7 唯一剩下的三元组是 $S_{5}=\\{2,5,7\\}$，B 可如前述方法阻止；因此 A 没有强制获胜的策略。\n\n因此，只有选择顶点 3 才能为玩家 A 提供一个获胜策略；其他列出的走法不能保证获胜，并且在这种局面下玩家 B 也没有总体的获胜策略。", "answer": "$$\\boxed{B}$$", "id": "1416871"}]}