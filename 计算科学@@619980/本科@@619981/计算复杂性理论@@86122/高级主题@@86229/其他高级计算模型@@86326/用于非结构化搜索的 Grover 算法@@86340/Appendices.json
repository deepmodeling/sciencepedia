{"hands_on_practices": [{"introduction": "Grover 算法的核心在于“神谕”（oracle）的巧妙设计，它能“标记”出我们寻找的目标。然而，这个神谕并非凭空而来，而是需要用基本的量子门精心构建。这个练习将带你动手将一个抽象的搜索任务——标记特定的量子态 $|110\\rangle$——转化为一个具体的量子线路，让你深入理解理论与实践之间的联系。[@problem_id:1426395]", "problem": "在开发一个3量子比特系统的量子搜索算法时，一个关键组成部分是“预言机”算符 $U_w$。该算符旨在通过对一个特定的“标记”计算基态 $|w\\rangle$ 施加一个 $-1$ 的相移来识别它，同时保持所有其他基态不变。该预言机的作用可正式描述为变换 $U_w|x\\rangle = (-1)^{f(x)}|x\\rangle$，其中当输入态 $|x\\rangle$ 是标记态 $|w\\rangle$ 时，$f(x)=1$，否则 $f(x)=0$。\n\n考虑一个3量子比特寄存器，其中量子比特从右到左索引，因此一个通用基态写作 $|q_2 q_1 q_0\\rangle$。此搜索问题的标记态为 $|w\\rangle = |110\\rangle$。\n\n为构建此预言机，提供了一个基本量子门库，其中包括：\n1.  单量子比特泡利X门，记作 $X_k$，作用于量子比特 $k$。此门会翻转该量子比特的状态，使得 $X_k|0\\rangle = |1\\rangle$ 且 $X_k|1\\rangle = |0\\rangle$。\n2.  三量子比特双控Z门，记作 $CCZ_{i,j,k}$。此门当且仅当两个控制量子比特 $i$ 和 $j$ 都处于 $|1\\rangle$ 态时，才对目标量子比特 $k$ 施加一个泡利Z门。泡利Z门对 $|1\\rangle$ 态施加一个相位翻转（$Z|1\\rangle = -|1\\rangle$），而保持 $|0\\rangle$ 态不变（$Z|0\\rangle = |0\\rangle$）。因此，$CCZ_{i,j,k}$ 门仅对量子比特 $i, j, k$ 均处于 $|1\\rangle$ 的基态施加一个 $-1$ 的相位。\n\n门序列按从右到左的应用顺序书写。例如，序列 $A \\cdot B \\cdot C$ 意味着先应用门 $C$，接着是门 $B$，最后是门 $A$。\n\n下列哪个门序列正确实现了标记态为 $|w\\rangle = |110\\rangle$ 所需的预言机？\n\nA. $CCZ_{2,1,0}$\n\nB. $X_0 \\cdot CCZ_{2,1,0} \\cdot X_0$\n\nC. $X_2 \\cdot CCZ_{2,1,0} \\cdot X_2$\n\nD. $X_1 \\cdot CCZ_{2,1,0} \\cdot X_1$\n\nE. $X_2 \\cdot X_1 \\cdot CCZ_{2,1,0} \\cdot X_1 \\cdot X_2$", "solution": "我们需要一个预言机 $U_{w}$，它对计算基态的作用如下：\n$$\nU_{w}|q_{2}q_{1}q_{0}\\rangle =\n\\begin{cases}\n-\\,|q_{2}q_{1}q_{0}\\rangle, & \\text{if } |q_{2}q_{1}q_{0}\\rangle=|110\\rangle,\\\\\n\\;\\;|q_{2}q_{1}q_{0}\\rangle, & \\text{otherwise}.\n\\end{cases}\n$$\n等效地，对于比特值 $q_{k}\\in\\{0,1\\}$，这可以表示为：\n$$\nU_{w}|q_{2}q_{1}q_{0}\\rangle = (-1)^{q_{2}q_{1}(1-q_{0})}|q_{2}q_{1}q_{0}\\rangle,\n$$\n因此只有 $q_{2}=1$, $q_{1}=1$, $q_{0}=0$ 的状态会获得一个 $-1$ 的相位。\n\n可用的 $CCZ_{2,1,0}$ 门仅对 $|111\\rangle$ 施加一个 $-1$ 的相位，即：\n$$\nCCZ_{2,1,0}|q_{2}q_{1}q_{0}\\rangle = (-1)^{q_{2}q_{1}q_{0}}|q_{2}q_{1}q_{0}\\rangle.\n$$\n为了将标记模式从 $|111\\rangle$ 变换为 $|110\\rangle$，我们用 $X_0$ 对 $CCZ_{2,1,0}$ 进行变换，在其作用前后作用 $X_0$ 以翻转第三个量子比特（目标比特）：\n$$\nU := X_{0}\\cdot CCZ_{2,1,0}\\cdot X_{0}.\n$$\n作用于一个通用基态时：\n1) 最右边的 $X_{0}$ 将 $|q_{2}q_{1}q_{0}\\rangle$ 映射到 $|q_{2}q_{1}\\bar{q}_{0}\\rangle$，其中 $\\bar{q}_{0}=1-q_{0}$。\n2) 然后 $CCZ_{2,1,0}$ 当且仅当 $q_{2}=1$，$q_{1}=1$ 且 $\\bar{q}_{0}=1$ 时贡献一个 $-1$ 的相位，即恰好在 $q_{2}=1$，$q_{1}=1$，$q_{0}=0$ 时。\n3) 最左边的 $X_{0}$ 恢复第三个量子比特，得到原始基态和预期的相位。\n\n因此\n$$\n\\left(X_{0}\\cdot CCZ_{2,1,0}\\cdot X_{0}\\right)|q_{2}q_{1}q_{0}\\rangle\n= (-1)^{q_{2}q_{1}(1-q_{0})}|q_{2}q_{1}q_{0}\\rangle,\n$$\n这正是标记态为 $|110\\rangle$ 所需的预言机。\n\n对其他选项的验证：\n- 单独的 $CCZ_{2,1,0}$ 标记的是 $|111\\rangle$，而不是 $|110\\rangle$。\n- $X_{2}\\cdot CCZ_{2,1,0}\\cdot X_{2}$ 标记的是 $q_{2}=0, q_{1}=1, q_{0}=1$ 的状态，即 $|011\\rangle$。\n- $X_{1}\\cdot CCZ_{2,1,0}\\cdot X_{1}$ 标记的是 $|101\\rangle$。\n- $X_{2}\\cdot X_{1}\\cdot CCZ_{2,1,0}\\cdot X_{1}\\cdot X_{2}$ 标记的是 $|001\\rangle$。\n\n因此，正确的序列是 $X_{0}\\cdot CCZ_{2,1,0}\\cdot X_{0}$，即选项 B。", "answer": "$$\\boxed{B}$$", "id": "1426395"}, {"introduction": "理解了如何构建神谕之后，让我们来看看 Grover 算法的核心机制——振幅放大（amplitude amplification）——是如何运作的。本练习探讨了一种特殊但极具启发性的情况：当标记项的数量占总数的四分之一时。通过分析这种 $M=N/4$ 的场景，你将发现 Grover 算法仅需一次迭代就能以 $100\\%$ 的概率找到目标，这清晰地揭示了其背后强大的几何直觉和惊人效率。[@problem_id:1426374]", "problem": "一位量子计算研究员的任务是搜索一个包含总共 $N$ 个条目的大型、非结构化数据库。目标是识别出具有特定属性的条目，我们称之为“标记”条目。该研究员使用Grover量子搜索算法来完成这项任务。\n\n根据数据库的规格说明可知，标记条目的数量 $M$ 恰好是总条目数的四分之一，即 $M = N/4$。算法开始时，系统处于所有可能状态的均匀叠加态。之后，单次Grover迭代会对系统状态施加一个特定的幺正变换。\n\n假设量子计算机在没有任何错误的情况下运行，确定为使测量时测得标记条目的概率最大化，所需的最小非负整数Grover迭代次数 $k_{opt}$。此外，计算这个最大成功概率 $P_{max}$。\n\n以数对 $(k_{opt}, P_{max})$ 的形式给出您的答案。", "solution": "设 $N$ 为数据库条目的总数，$M$ 为标记条目的数量。在Grover算法中，其动力学被限制在由标记状态和未标记状态的均匀叠加态所张成的二维子空间内。将所有条目的均匀叠加态记为 $|s\\rangle$，其与标记子空间的交叠由角度 $\\theta$ 参数化，定义如下\n$$\n\\sin^{2}(\\theta)=\\frac{M}{N}.\n$$\n单次Grover迭代会在这个平面内产生一个朝向标记子空间、角度为 $2\\theta$ 的旋转。经过 $k$ 次Grover迭代后，状态与标记子空间的交叠，其幅度为\n$$\n\\sin\\big((2k+1)\\theta\\big),\n$$\n因此，经过 $k$ 次迭代后的成功概率为\n$$\nP_{k}=\\sin^{2}\\big((2k+1)\\theta\\big).\n$$\n给定 $M=\\frac{N}{4}$，我们有\n$$\n\\sin^{2}(\\theta)=\\frac{1}{4}\\quad\\Rightarrow\\quad \\sin(\\theta)=\\frac{1}{2}\\quad\\Rightarrow\\quad \\theta=\\arcsin\\!\\left(\\frac{1}{2}\\right)=\\frac{\\pi}{6}.\n$$\n因此，\n$$\nP_{k}=\\sin^{2}\\!\\left((2k+1)\\frac{\\pi}{6}\\right).\n$$\n为了在非负整数 $k$ 上最大化 $P_{k}$，注意到当 $x=\\frac{\\pi}{2}+m\\pi$（其中 $m$ 为整数）时，$\\sin^{2}(x)$ 达到其最大值 $1$。满足下式的最小非负 $k$\n$$\n(2k+1)\\frac{\\pi}{6}=\\frac{\\pi}{2}\n$$\n可以通过求解 $2k+1=3$ 得到，解出 $k=1$。将其代回，得到\n$$\nP_{\\max}=\\sin^{2}\\!\\left(\\frac{\\pi}{2}\\right)=1.\n$$\n因此，使成功概率最大化的最小非负整数Grover迭代次数是 $k_{\\text{opt}}=1$，且最大成功概率是 $P_{\\max}=1$。", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 1 \\end{pmatrix}}$$", "id": "1426374"}, {"introduction": "前一个练习展示了在特殊条件下一次迭代即可成功的完美情景，但在更普遍的情况下，当目标项非常稀少时，情况会如何呢？算法迭代次数过少会导致振幅放大不足，而迭代次数过多则可能“过犹不及”，反而降低成功概率。这个练习将挑战你计算并应用 Grover 算法的最佳迭代次数，这是在实际搜索问题中有效运用该算法的一项关键技能，帮助你学会在振幅放大过程中找到最佳平衡点。[@problem_id:1426405]", "problem": "一个网络安全团队正在使用一台量子计算机来搜索一个密码系统中的漏洞。总搜索空间由 $N = 2^{10}$ 种可能的配置组成。由于一个设计缺陷，已知这些配置中恰好有 $M=4$ 个是“弱”配置，如果找到它们，将会危害系统的安全。该团队采用Grover搜索算法来寻找这些弱配置中的一个。\n\n在Grover算法中，一系列被称为“Grover迭代”的量子操作被重复地应用于一个量子态。经过一定次数的迭代后，会进行一次测量。测量到弱配置的概率取决于所执行的迭代次数。\n\n确定团队应该执行的最佳Grover迭代次数 $k$，以在测量时有最高的概率识别出一个弱配置。迭代次数必须是整数。", "solution": "设 $N$ 为项的总数，$M$ 为标记（弱）项的数量。在Grover算法中，定义角度 $\\theta$ 为\n$$\n\\sin(\\theta)=\\sqrt{\\frac{M}{N}}.\n$$\n经过 $k$ 次Grover迭代后，成功概率为\n$$\nP(k)=\\sin^{2}\\big((2k+1)\\theta\\big).\n$$\n当 $(2k+1)\\theta$ 尽可能接近 $\\frac{\\pi}{2}$ 时，该概率达到最大值，这给出了最佳迭代次数：\n$$k^{\\ast}=\\left\\lfloor \\frac{\\pi}{4\\theta}-\\frac{1}{2}\\right\\rfloor$$\n对于给定的值 $N=2^{10}$ 和 $M=4$，\n$$\n\\sqrt{\\frac{M}{N}}=\\sqrt{\\frac{4}{2^{10}}}=\\sqrt{\\frac{1}{256}}=\\frac{1}{16},\n$$\n因此\n$$\n\\theta=\\arcsin\\!\\left(\\frac{1}{16}\\right).\n$$\n从而，\n$$\nk^{\\ast}=\\left\\lfloor \\frac{\\pi}{4\\arcsin\\!\\left(\\frac{1}{16}\\right)}-\\frac{1}{2}\\right\\rfloor.\n$$\n为了选择正确的整数，我们进行近似计算。使用 $\\arcsin(x)$ 在 $x=\\frac{1}{16}$ 处的级数展开，\n$$\n\\arcsin(x)=x+\\frac{x^{3}}{6}+\\frac{3x^{5}}{40}+\\frac{5x^{7}}{112}+\\cdots,\n$$\n可得\n$$\n\\theta=\\arcsin\\!\\left(\\frac{1}{16}\\right)\\approx 0.062540761796,\n$$\n因此\n$$\n\\frac{\\pi}{4\\theta}\\approx \\frac{3.141592653589793}{4\\times 0.062540761796}\\approx 12.5581803,\n$$\n于是\n$$\n\\frac{\\pi}{4\\theta}-\\frac{1}{2}\\approx 12.0581803.\n$$\n向下取整可得 $k^{\\ast}=12$。等价地，使用常用近似公式 $k\\approx \\left\\lfloor \\frac{\\pi}{4}\\sqrt{\\frac{N}{M}} \\right\\rfloor$ 可得 $\\left\\lfloor \\frac{\\pi}{4}\\cdot 16 \\right\\rfloor=\\left\\lfloor 4\\pi \\right\\rfloor=12$，这与更精确的计算结果一致。", "answer": "$$\\boxed{12}$$", "id": "1426405"}]}