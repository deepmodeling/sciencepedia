{"hands_on_practices": [{"introduction": "为了理解 BQP 的强大之处，首先思考一下是哪些量子特性赋予了它这种能力，这一点至关重要。这个练习探讨了一个仅限于经典可逆门（如 Toffoli 门）而无法产生量子叠加的计算模型 [@problem_id:1445657]。通过分析这个受限模型的能力，我们可以清晰地认识到，BQP 超越经典计算的潜力并非源于可逆性本身，而是源于量子叠加与干涉等核心量子现象。", "problem": "在计算复杂性理论中，BQP类代表“有界错误量子多项式时间”（Bounded-error Quantum Polynomial time），它指的是一类判定问题，这些问题能由量子计算机在多项式时间内以最多1/3的错误概率解决。一台通用量子计算机可以实现一组门，包括哈达玛门和托福利门。\n\n考虑一个基于量子原理构建的假设计算设备，但其门集合受到限制。具体来说，它只能实现经典可逆门，如CNOT门和托福利门。这台机器无法创建叠加态（例如，它没有哈达玛门）或利用量子干涉。所有计算都在基态上确定性地执行。\n\n下列哪个经典复杂性类精确地刻画了这台受限计算设备在多项式时间内可解决的判定问题集合？\n\nA. BQP\n\nB. P\n\nC. BPP（有界错误概率多项式时间）\n\nD. NP（非确定性多项式时间）\n\nE. L（对数空间）", "solution": "我们分析这台受限设备的计算能力。该设备只能实现经典可逆门（如CNOT和托福利门），无法创建叠加态，并在计算基态上确定性地演化。\n\n首先，刻画该设备的操作。由于不允许叠加，状态始终是一个基字符串，每个门都确定性地将基字符串映射到基字符串。因此，任何作用于$n$个比特的电路计算的都是一个双射\n$$\nF:\\{0,1\\}^{n}\\to\\{0,1\\}^{n},\n$$\n即位字符串上的一个排列。从量子角度看，总的酉算子是计算基上的一个置换矩阵；从经典角度看，它是一个可逆电路。\n\n上界：由确定性多项式时间模拟。每个门（CNOT、托福利门）都是对常数数量比特进行的常数规模的确定性操作，因此一台标准的确定性图灵机可以在每个门以一个常数因子为界的时间内模拟其应用。因此，一个规模为输入长度多项式的电路可以在确定性多项式时间内被模拟。所以，此设备在多项式时间内可判定的语言类是P的子集。\n\n下界：实现任何确定性多项式时间计算。任何可由确定性图灵机在时间$T(m)$内计算的函数$f:\\{0,1\\}^{m}\\to\\{0,1\\}^{k}$，都可以通过Bennett的可逆模拟方法，以最多多项式的时间和空间开销进行可逆模拟。具体来说，可以使用一个可逆门集合，将$f$嵌入到一个可逆映射中\n$$\n(x,0^{a})\\mapsto (x,f(x),g(x)),\n$$\n其中$a$是一些辅助比特的数量，$g(x)$是一些垃圾比特。使用反计算，可以清除垃圾比特得到\n$$\n(x,0^{a})\\mapsto (x,f(x),0^{a}),\n$$\n而开销仅为多项式级别。由于托福利门对于经典可逆计算是通用的，并且CNOT是一个标准的可逆门，该设备可以以多项式开销实现所需的可逆电路。因此，P中的任何语言都可由该设备在多项式时间内判定。因此，P是该设备计算能力的一个子集。\n\n结合这两种包含关系，这台受限设备在多项式时间内可解决的判定问题集合恰好是P。\n\n排除其他选项：BQP需要叠加和干涉，而该设备没有这些特性；BPP需要随机性，而该设备的演化是确定性的，因此不存在随机性；NP是一个非确定性类，并且通常认为它严格包含比P更难的问题；L通常是P的一个严格子类，并且限制性太强，因为该设备并未被限制在对数空间内。\n\n因此，正确的经典复杂性类是P。", "answer": "$$\\boxed{B}$$", "id": "1445657"}, {"introduction": "明确了量子叠加和干涉是 BQP 强大算力的核心来源后，我们接下来需要掌握如何根据其严格的数学定义来评判一个量子算法。本练习提供了一个具体而直接的实践机会，你将分析一个简单的量子电路，并通过计算来验证其成功概率是否满足 BQP 类问题的“有界错误”要求 [@problem_id:1445651]。这能帮助你将抽象的复杂度定义与实际的量子线路分析联系起来。", "problem": "考虑一个名为 `EQUALITY_CHECK` 的判定问题，它接受一个两位比特串 $x_1x_0$ 作为输入。如果两位比特相等 ($x_1 = x_0$)，该问题的输出为 ‘是’；如果它们不同 ($x_1 \\neq x_0$)，输出为 ‘否’。\n\n一名本科生提出了一个量子算法来解决这个问题。该算法作用于一个 2-量子比特寄存器，其中的量子比特被标记为 1 (最高有效位) 和 0 (最低有效位)。其过程如下：\n\n1.  将 2-量子比特寄存器初始化为对应于输入比特串的状态 $|x_1x_0\\rangle$。\n2.  对量子比特 1 应用一个 Hadamard (H) 门。\n3.  应用一个受控非 (CNOT) 门，使用量子比特 1 作为控制位，量子比特 0 作为目标位。\n4.  再次对量子比特 1 应用一个 Hadamard (H) 门。\n5.  在计算基 $\\{|0\\rangle, |1\\rangle\\}$ 中测量量子比特 1。如果测量结果为 0，算法输出 ‘是’。如果结果为 1，算法输出 ‘否’。\n\n这些门在计算基态上的作用定义如下：\n- Hadamard 门：$H|0\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$ 并且 $H|1\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$。\n- CNOT 门：如果控制量子比特为 $|1\\rangle$，则翻转目标量子比特。例如，$CNOT|10\\rangle = |11\\rangle$ 并且 $CNOT|01\\rangle = |01\\rangle$。\n\n一个判定问题属于复杂度类“有界错误量子多项式时间 (BQP)”，如果存在一个量子算法，对于任何输入实例，它能以至少 $2/3$ 的概率给出正确答案。这被形式化地表述为：\n- 对于任何‘是’实例，算法必须以 $P_{\\text{是}} \\geq 2/3$ 的概率输出‘是’。\n- 对于任何‘否’实例，算法必须以 $P_{\\text{否}} \\geq 2/3$ 的概率输出‘否’，这等价于以 $P_{\\text{是}} \\leq 1/3$ 的概率输出‘是’。\n\n基于对该学生所提算法的分析，关于 `EQUALITY_CHECK` 问题，以下哪个陈述是正确的？\n\nA. 是的，该算法成功地将问题置于 BQP 中，因为它总是以 100% 的概率给出正确答案。\n\nB. 是的，该算法成功地将问题置于 BQP 中，因为对于所有输入，其成功概率都满足所需界限。\n\nC. 不，该算法失败，因为正确识别‘是’实例的概率太低，尽管它能以足够高的概率正确识别‘否’实例。\n\nD. 不，该算法失败，因为将‘否’实例错误识别为‘是’的概率太高，尽管它能以足够高的概率正确识别‘是’实例。\n\nE. 不，该算法未能将问题置于 BQP 中，因为对于‘是’和‘否’两种实例，其成功概率均不满足指定的界限。", "solution": "我们对任意输入 $|x_{1}x_{0}\\rangle$ 逐步分析该学生的线路。\n\n1) 初始化：\n初始状态为\n$$\n|x_{1}x_{0}\\rangle.\n$$\n\n2) 对量子比特 1 应用 $H$ 门：\n使用 $H|x_{1}\\rangle=\\frac{1}{\\sqrt{2}}\\left(|0\\rangle+(-1)^{x_{1}}|1\\rangle\\right)$，状态变为\n$$\n\\frac{1}{\\sqrt{2}}\\left(|0\\rangle+(-1)^{x_{1}}|1\\rangle\\right)\\otimes|x_{0}\\rangle.\n$$\n\n3) 应用 CNOT 门，控制位为量子比特 1，目标位为量子比特 0：\nCNOT 门将 $|0\\rangle|x_{0}\\rangle$ 映射到 $|0\\rangle|x_{0}\\rangle$，将 $|1\\rangle|x_{0}\\rangle$ 映射到 $|1\\rangle|x_{0}\\oplus 1\\rangle$，因此状态变为\n$$\n\\frac{1}{\\sqrt{2}}\\left(|0\\rangle|x_{0}\\rangle+(-1)^{x_{1}}|1\\rangle|x_{0}\\oplus 1\\rangle\\right).\n$$\n\n4) 再次对量子比特 1 应用 $H$ 门：\n使用 $H|0\\rangle=\\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle)$ 和 $H|1\\rangle=\\frac{1}{\\sqrt{2}}(|0\\rangle-|1\\rangle)$，测量前的最终状态为\n$$\n\\frac{1}{2}\\left[(|0\\rangle+|1\\rangle)|x_{0}\\rangle+(-1)^{x_{1}}(|0\\rangle-|1\\rangle)|x_{0}\\oplus 1\\rangle\\right]\n=\n\\frac{1}{2}\\left[\n|0\\rangle\\left(|x_{0}\\rangle+(-1)^{x_{1}}|x_{0}\\oplus 1\\rangle\\right)\n+\n|1\\rangle\\left(|x_{0}\\rangle-(-1)^{x_{1}}|x_{0}\\oplus 1\\rangle\\right)\n\\right].\n$$\n\n5) 在计算基中测量量子比特 1 并输出：\n- 结果为 0 的振幅矢量是 $\\frac{1}{2}\\left(|x_{0}\\rangle+(-1)^{x_{1}}|x_{0}\\oplus 1\\rangle\\right)$。\n- 结果为 1 的振幅矢量是 $\\frac{1}{2}\\left(|x_{0}\\rangle-(-1)^{x_{1}}|x_{0}\\oplus 1\\rangle\\right)$。\n\n由于 $|x_{0}\\rangle$ 和 $|x_{0}\\oplus 1\\rangle$ 是标准正交的，\n$$\nP(\\text{测得 }0)=\\left\\|\\frac{1}{2}\\left(|x_{0}\\rangle+(-1)^{x_{1}}|x_{0}\\oplus 1\\rangle\\right)\\right\\|^{2}\n=\\frac{1}{4}\\left(\\|\\,|x_{0}\\rangle\\|^{2}+\\|\\,|x_{0}\\oplus 1\\rangle\\|^{2}\\right)\n=\\frac{1}{2},\n$$\n并且同样地\n$$\nP(\\text{测得 }1)=\\frac{1}{2}.\n$$\n\n算法在测量结果为 0 时输出‘是’，在结果为 1 时输出‘否’。因此，对于每个输入（无论是 $x_{1}=x_{0}$ 还是 $x_{1}\\neq x_{0}$），算法都以 $\\frac{1}{2}$ 的概率输出‘是’，以 $\\frac{1}{2}$ 的概率输出‘否’。\n\n与 BQP 的成功标准比较：\n- 对于‘是’实例，我们要求 $P_{\\text{是}}\\geq \\frac{2}{3}$，但这里 $P_{\\text{是}}=\\frac{1}{2}<\\frac{2}{3}$。\n- 对于‘否’实例，我们要求 $P_{\\text{是}}\\leq \\frac{1}{3}$ (等价于 $P_{\\text{否}}\\geq \\frac{2}{3}$），但这里 $P_{\\text{是}}=\\frac{1}{2}>\\frac{1}{3}$。\n\n因此，该算法对于‘是’和‘否’两种情况均未能满足所需界限。正确选项是 E。", "answer": "$$\\boxed{E}$$", "id": "1445651"}, {"introduction": "在理解了 BQP 的定义和基本原理之后，一个自然而然的问题是：BQP 是否真的比其经典对应——有界错误概率多项式时间（BPP）——更强大？本练习构建了一个基于“预言机”（oracle）的场景，它本质上是非阿贝尔群“隐藏子群问题”的一个变体 [@problem_id:1445653]。通过解决这个问题，你将探索量子算法相较于经典概率算法所能实现的指数级加速，这是支持 BQP 可能优于 BPP 的关键理论证据之一。", "problem": "设 $n$ 是一个大于或等于 2 的整数。考虑二面体群 $D_{2^n}$，它是正 $2^n$-边形的对称群。该群的阶为 $2^{n+1}$，并可以通过呈示\n$$G = \\langle r, s \\mid r^{2^n} = s^2 = e, srs = r^{-1} \\rangle$$\n来描述。该群的中心，记作 $Z(G)$，是子群 $\\{e, r^{2^{n-1}}\\}$，其阶为 2。\n\n给定对一个函数 $f: G \\to S$ 的预言机（oracle）的查询权限，其中 $S$ 是某个标签集合。保证函数 $f$ 属于以下两种情况之一：\n\n*   **情况 1 (单射):** 函数 $f$ 是一对一的。对于 $G$ 中任意两个不同的元素 $g_1, g_2$，都有 $f(g_1) \\neq f(g_2)$。\n*   **情况 2 (隐藏中心):** 函数 $f$ “隐藏”了中心 $Z(G)$。这意味着，对于 $G$中的任意两个元素 $g_1, g_2$，$f(g_1) = f(g_2)$ 当且仅当 $g_1$ 和 $g_2$ 属于子群 $Z(G)$ 的同一个左陪集。\n\n设 $Q_{BQP}(n)$ 是一个量子算法以至少 $2/3$ 的成功概率正确判断预言机属于情况 1 还是情况 2 所需的最小预言机查询次数。\n设 $Q_{BPP}(n)$ 是一个概率经典算法达到相同成功概率所需的最小预言机查询次数。\n\n当 $n$ 很大时，以下哪个陈述正确描述了这些查询复杂度的渐进标度？\n\nA. $Q_{BQP}(n) = O(\\text{poly}(n))$ 且 $Q_{BPP}(n) = O(\\text{poly}(n))$\n\nB. $Q_{BQP}(n) = O(\\text{poly}(n))$ 且 $Q_{BPP}(n) = \\Omega(2^{n/2})$\n\nC. $Q_{BQP}(n) = \\Omega(2^{n/2})$ 且 $Q_{BPP}(n) = O(\\text{poly}(n))$\n\nD. $Q_{BQP}(n) = \\Omega(2^{n/2})$ 且 $Q_{BPP}(n) = \\Omega(2^{n/2})$", "solution": "令 $G = D_{2^{n}}$，其阶为 $|G| = 2^{n+1}$，中心为 $Z(G) = \\{e, r^{2^{n-1}}\\}$，大小为 $|Z(G)| = 2$。在情况 2 中，预言机 $f$ 在 $Z(G)$ 的左陪集上是常数，在不同的陪集上取值不同。因此，在情况 2 中，$f$ 是严格的 $2$-到-$1$ 函数，而在情况 1 中，$f$ 是 $1$-到-$1$ 函数。因此，该判定问题归结为在一个标准黑盒预言机模型下，区分一个定义在大小为 $|G| = 2^{n+1}$ 的域上的 $1$-到-$1$ 函数和一个 $2$-到-$1$ 函数（仅仅知道 $Z(G)$ 的大小为 2 这个抽象知识，并不能告诉我们对于一个给定的输入 $g$，哪个其他输入会与其共享相同的标签，除非使用预言机）。\n\n经典下界。令 $N := |G| = 2^{n+1}$。考虑任意进行 $q$ 次预言机查询（可能自适应地）的随机经典算法。根据 Yao 的最小最大原理，我们只需考虑预言机上的一个困难分布：等概率地随机选择一个满足承诺的 $1$-到-$1$ 预言机或一个 $2$-到-$1$ 预言机。在算法观察到 $q$ 次查询输出中的任何碰撞之前，其记录（查询输入的多重集及其不同的输出）在两种情况下具有相同的分布，因此没有可用于区分这两种情况的信息。在 $2$-到-$1$ 的情况下，$q$ 次查询产生任何碰撞的概率上限为\n$$\n\\Pr[\\text{some collision among }q\\text{ outputs}] \\leq \\frac{q(q-1)}{N}.\n$$\n因此，除非 $q = \\Omega(N^{1/2})$，否则区分优势为 $o(1)$，要达到至少 $2/3$ 的成功概率需要\n$$\nq = \\Omega\\!\\left( N^{1/2} \\right) = \\Omega\\!\\left( 2^{(n+1)/2} \\right) = \\Omega\\!\\left( 2^{n/2} \\right).\n$$\n因此 $Q_{BPP}(n) = \\Omega(2^{n/2})$。\n\n量子上界。一次叠加态查询，然后测量预言机的输出寄存器，会在输入寄存器中产生：\n- 在情况 1 (单射) 中，一个基态 $\\ket{g}$，其中 $g$ 是 $G$ 中一个均匀随机的元素；\n- 在情况 2 (隐藏中心) 中，一个均匀陪集态 $\\ket{gH}$，其中 $H = Z(G)$ 且 $|H| = 2$。\n\n对 $G$ 应用量子傅里叶变换，并执行弱傅里叶采样（只测量不可约表示的标签）。在情况 1 中，观察到的不可约表示 $\\rho$ 服从 Plancherel 分布\n$$\np_{\\text{inj}}(\\rho) = \\frac{d_{\\rho}^{2}}{|G|},\n$$\n其中 $d_{\\rho}$ 是 $\\rho$ 的维数。在情况 2 中，观察到的不可约表示 $\\rho$ 的概率为\n$$\np_{H}(\\rho) = \\frac{d_{\\rho}}{|G|} \\left\\| \\sum_{h \\in H} \\rho(h) \\right\\|_{F}^{2}\n= \\frac{d_{\\rho}}{|G|} |H|^{2} \\operatorname{rank}\\!\\left( P_{H}^{\\rho} \\right),\n\\quad\nP_{H}^{\\rho} := \\frac{1}{|H|} \\sum_{h \\in H} \\rho(h).\n$$\n对于 $H = Z(G) = \\{e, z_{0}\\}$，其中 $z_{0} = r^{2^{n-1}}$ 是阶为 2 的中心元，根据 Schur 引理，我们有 $\\rho(z_{0}) = \\lambda_{\\rho} I$，其中 $\\lambda_{\\rho} \\in \\{+1, -1\\}$，因此\n$$\nP_{H}^{\\rho} = \\frac{1}{2}\\left(I + \\rho(z_{0})\\right) =\n\\begin{cases}\nI & \\text{if } \\lambda_{\\rho} = +1,\\\\\n0 & \\text{if } \\lambda_{\\rho} = -1,\n\\end{cases}\n$$\n于是\n$$\np_{H}(\\rho) =\n\\begin{cases}\n\\dfrac{4 d_{\\rho}^{2}}{|G|} & \\text{if } \\lambda_{\\rho} = +1,\\\\\n0 & \\text{if } \\lambda_{\\rho} = -1.\n\\end{cases}\n$$\n在 $D_{2^{n}}$ 中，每个一维不可约表示都满足 $\\lambda_{\\rho} = +1$，因为 $\\rho(r) \\in \\{\\pm 1\\}$ 意味着 $\\rho(z_{0}) = \\rho(r)^{2^{n-1}} = 1$。而每个二维不可约表示 $\\rho_{k}$ 则满足\n$$\n\\rho_{k}(r) = \\begin{pmatrix}\n\\cos\\!\\left( \\frac{2\\pi k}{2^{n}} \\right) & -\\sin\\!\\left( \\frac{2\\pi k}{2^{n}} \\right)\\\\\n\\sin\\!\\left( \\frac{2\\pi k}{2^{n}} \\right) & \\cos\\!\\left( \\frac{2\\pi k}{2^{n}} \\right)\n\\end{pmatrix},\n\\quad\n\\rho_{k}(z_{0}) = \\rho_{k}(r)^{2^{n-1}} = -I,\n$$\n所以 $\\lambda_{\\rho_{k}} = -1$。因此，在情况 2 中，弱傅里叶采样只产生一维不可约表示，而在情况 1 中，它产生 Plancherel 分布，该分布将总质量\n$$\n\\sum_{\\rho \\text{ two-dim}} \\frac{d_{\\rho}^{2}}{|G|}\n= \\frac{4\\,(2^{n-1}-1)}{2^{n+1}}\n= 1 - \\frac{2}{2^{n+1}}\n$$\n分配给二维不可约表示。因此，对于所有足够大的 $n$，这两个输出分布的总变差距离的下界是一个正常数，常数次的预言机查询和测量就足以用至少 $2/3$ 的成功概率区分这两种情况。所以，\n$$\nQ_{BQP}(n) = O(1) \\subseteq O(\\text{poly}(n)).\n$$\n\n结合两种分析得出\n$$\nQ_{BQP}(n) = O(\\text{poly}(n)), \\qquad Q_{BPP}(n) = \\Omega(2^{n/2}),\n$$\n这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1445653"}]}