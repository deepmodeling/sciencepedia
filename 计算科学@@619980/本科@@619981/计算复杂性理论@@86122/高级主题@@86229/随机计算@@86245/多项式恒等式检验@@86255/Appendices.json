{"hands_on_practices": [{"introduction": "Schwartz-Zippel 引理为我们提供了一个强大的随机化工具，来检验两个多项式是否恒等。本练习将带你入门多项式恒等测试（PIT）的基本机制。通过在一个具体场景中精确计算“假阳性”的概率，你将亲手理解该测试的工作原理及其潜在的错误来源，从而将抽象的理论根植于具体的计算之中 [@problem_id:1435754]。", "problem": "一位软件验证工程师的任务是检查两个算术模块的等价性，这两个模块设计用于对一对输入变量 $x$ 和 $y$ 进行计算。第一个模块指定计算多项式 $P_1(x, y) = x(x+y)^2$。第二个模块计算多项式 $P_2(x, y) = x^2(x+y) + y(x^2+y)$。\n\n为了验证这两个模块是否等价（即 $P_1$ 和 $P_2$ 是否表示同一个多项式），该工程师采用了一种随机化测试。该测试包含单次运行，其中通过从集合 $S = \\{0, 1, 2, \\dots, 99\\}$ 中独立且均匀随机地选择 $r_x$ 和 $r_y$ 来选取一对整数输入 $(r_x, r_y)$。然后比较这两个模块对于该输入对的输出。\n\n如果模块功能上不同（意味着 $P_1$ 和 $P_2$ 不是同一个多项式），但为测试选择的特定随机输入 $(r_x, r_y)$ 恰好产生相同的输出，即 $P_1(r_x, r_y) = P_2(r_x, r_y)$，则认为该测试产生了“假阳性” (false positive)。\n\n该测试产生假阳性的确切概率是多少？\n\nA. $\\frac{199}{10000}$\n\nB. $\\frac{3}{100}$\n\nC. $\\frac{1}{50}$\n\nD. $\\frac{3}{10000}$", "solution": "我们首先对每个多项式进行符号展开。对于 $P_{1}$，\n$$\nP_{1}(x,y)=x(x+y)^{2}=x(x^{2}+2xy+y^{2})=x^{3}+2x^{2}y+xy^{2}.\n$$\n对于 $P_{2}$，\n$$\nP_{2}(x,y)=x^{2}(x+y)+y(x^{2}+y)=x^{3}+x^{2}y+x^{2}y+y^{2}=x^{3}+2x^{2}y+y^{2}.\n$$\n因此，它们的差是\n$$\nP_{1}(x,y)-P_{2}(x,y)=xy^{2}-y^{2}=y^{2}(x-1).\n$$\n两个模块在输入对 $(r_{x},r_{y})$ 上产生相同的输出，当且仅当 $P_{1}(r_{x},r_{y})=P_{2}(r_{x},r_{y})$，即当\n$$\ny^{2}(x-1)=0.\n$$\n在整数上，这发生当且仅当 $y=0$ 或 $x=1$。\n\n由于 $r_{x}$ 和 $r_{y}$ 是从集合 $S=\\{0,1,2,\\dots,99\\}$ 中独立且均匀选择的，总的输入对数量为 $|S|\\cdot|S|=100\\cdot 100=10000$。$y=0$ 的数对有 $100$ 对（任意 $x\\in S$），$x=1$ 的数对有 $100$ 对（任意 $y\\in S$），而重叠部分 $(x=1,y=0)$ 被计算了两次，因此根据容斥原理，产生相等结果的总数对数量为\n$$\n100+100-1=199.\n$$\n因此，（在多项式不恒等的前提下）产生假阳性的确切概率是\n$$\n\\frac{199}{10000},\n$$\n这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1435754"}, {"introduction": "了解了随机化测试后，人们可能会想：我们能否用一小组精心选择的确定性点集来替代随机点呢？本练习旨在挑战你探索确定性测试的局限性。通过构造一个特定的非零多项式，使其在一个固定的测试点集上全部取值为零，你将发现为何在大定义域上进行随机化选择通常是必要的，以避免算法被“欺骗” [@problem_id:1435764]。", "problem": "在计算复杂性理论中，多项式恒等性检验（Polynomial Identity Testing, PIT）问题是指有效确定一个给定多项式是否恒等于零多项式的问题。PIT 的一类常见算法涉及在一组测试点上对多项式进行求值。如果所有求值结果都为零，该算法就断定该多项式是零多项式。然而，如果测试点集太小或选择得不够仔细，这样的算法可能会被“欺骗”。\n\n考虑一个简单的随机化 PIT 算法，它通过在集合 $S = \\{(0,0), (0,1), (1,0), (1,1)\\}$ 中的所有点上对一个二元多项式 $P(x,y)$ 进行求值来测试它。如果对于 $S$ 中的所有四个点都有 $P(x,y)=0$，该算法就报告称 $P$ 是零多项式。\n\n你的任务是找到一个能欺骗此算法的特定非零多项式。请找出满足以下所有三个条件的唯一非零多项式 $P(x,y)$：\n1. 它的通用形式为 $P(x,y) = x^2 + A y^2 + B x + C y + D$，其中 $A, B, C, D$ 是有理常数。\n2. 它关于其变量对称，即对于所有的 $x,y$ 都有 $P(x,y) = P(y,x)$。\n3. 对于集合 $S$ 中的所有点对 $(x,y)$，其求值结果为零。\n\n请将最终得到的多项式 $P(x,y)$ 的表达式作为最终答案。", "solution": "我们寻找一个形式为 $P(x,y) = x^{2} + A y^{2} + B x + C y + D$ 的多项式，其中 $A,B,C,D$ 为有理常数，该多项式是对称的，即对所有 $x,y$ 都有 $P(x,y) = P(y,x)$，并且在 $S = \\{(0,0),(0,1),(1,0),(1,1)\\}$ 上为零。\n\n交换 $x$ 和 $y$ 的对称性要求 $P(x,y)$ 和 $P(y,x) = y^{2} + A x^{2} + B y + C x + D$ 的系数相匹配。对所有 $x,y$ 令系数相等可得：\n$$A = 1,\\quad C = B.$$\n因此，多项式化简为\n$$P(x,y) = x^{2} + y^{2} + B(x + y) + D.$$\n\n应用在 $S$ 上的零点条件：\n- 在点 $(0,0)$ 处：$P(0,0) = D = 0$，因此 $D = 0$。\n- 在点 $(1,0)$ 处：$P(1,0) = 1 + B + D = 0 \\Rightarrow 1 + B = 0 \\Rightarrow B = -1$。\n- 在点 $(0,1)$ 处：$P(0,1) = 1 + B + D = 0 \\Rightarrow B = -1$（与之前结果一致）。\n- 在点 $(1,1)$ 处：$P(1,1) = 2 + 2B + D = 0 \\Rightarrow 2 + 2(-1) + 0 = 0$（与之前结果一致）。\n\n因此，唯一的系数是 $A = 1$，$B = -1$，$C = -1$，$D = 0$，得到\n$$P(x,y) = x^{2} + y^{2} - x - y.$$\n这个多项式是非零的、对称的，并且在 $S$ 中的所有点上求值结果均为零，因此它欺骗了给定的 PIT 算法。", "answer": "$$\\boxed{x^{2} + y^{2} - x - y}$$", "id": "1435764"}, {"introduction": "在关键应用中，单次随机测试的可靠性可能不足。本练习聚焦于“概率放大”（probability amplification）这一增强随机化算法的标准技术。你将推导出一个通用公式，用以确定需要多少次独立试验才能将错误概率降低到任意期望的阈值以下，这是将一个概率性的概念验证转化为一个稳健可靠算法的关键技能 [@problem_id:1435768]。", "problem": "一位工程师的任务是验证新型处理器中一个复杂的计算单元。该单元计算的函数可以建模为一个多元多项式 $P(x_1, \\dots, x_n)$。目标是执行多项式恒等式检验（PIT），以检查该单元是否出现故障，计算了恒零多项式 $P \\equiv 0$，而不是预期的非零函数。\n\n由于电路的复杂性，详尽的符号验证在计算上是不可行的。因此，工程师采用了一种随机化测试。该测试包括选择一个随机输入向量 $(r_1, \\dots, r_n)$ 并对多项式求值。每个分量 $r_i$ 都是从一个有限集 $S$ 中独立且均匀随机地选择的。\n\n如果 $P(r_1, \\dots, r_n) \\neq 0$，测试会正确报告该多项式为非零。如果 $P(r_1, \\dots, r_n) = 0$，测试会报告该多项式为零。该测试存在单边错误：如果真实多项式为非零，测试有可能会因为偶然选到了一个根而错误地将其报告为零。根据多项式的性质可知，对于任意总次数为 $d$ 的非零多项式 $P$，单次测试错误地报告“零”的概率至多为 $\\frac{d}{|S|}$，其中 $|S|$ 是集合 $S$ 的大小。我们可以假定，对于任何实际测试，都有 $|S| > d$。\n\n为了提高结果的可信度，工程师决定进行 $k$ 次独立试验。只有当所有 $k$ 次试验都报告“零”时，总体结论才是“零”。只要有任意一次试验报告“非零”，总体结论就是“非零”。\n\n请确定为确保将非零多项式错误地判定为“零”的概率至多为 $\\delta$（一个代表期望容错率的小正值）所需执行的最小整数试验次数 $k$。你的答案应该是一个用 $d$、$|S|$ 和 $\\delta$ 表示的解析表达式。由于 $k$ 必须是整数，请在最终表达式中使用上取整函数 $\\lceil \\cdot \\rceil$。", "solution": "我们来分析整个过程的错误概率。该过程仅在一种特定情况下会产生不正确的结果：当多项式 $P$ 非零，但所有 $k$ 次试验都恰好求值为零。\n\n设 $E$ 为整个过程将非零多项式错误地判定为“零”的事件。这当且仅当所有 $k$ 次独立试验都失败时才会发生。设 $F_i$ 为第 $i$ 次试验失败的事件，即对一个非零多项式返回了“零”。\n\n题中说明，单次试验失败的概率有一个上界。对于任意次数为 $d$ 的非零多项式，第 $i$ 次试验失败的概率为：\n$$ P(F_i) \\le \\frac{d}{|S|} $$\n我们将这个单次试验错误概率的上界记为 $p_{err} = \\frac{d}{|S|}$。\n\n总体错误事件 $E$ 是各次独立失败事件的交集：$E = F_1 \\cap F_2 \\cap \\dots \\cap F_k$。由于各次试验是独立的，总体错误概率是各次独立失败概率的乘积：\n$$ P(E) = P(F_1) \\times P(F_2) \\times \\dots \\times P(F_k) $$\n利用每次试验的上界，我们可以得到总体错误概率的上界：\n$$ P(E) \\le (p_{err})^k = \\left(\\frac{d}{|S|}\\right)^k $$\n我们被要求这个总体错误概率必须不大于一个指定的容错率 $\\delta$。因此，我们需要找到满足以下不等式的最小整数 $k$：\n$$ \\left(\\frac{d}{|S|}\\right)^k \\le \\delta $$\n为了解出 $k$，我们可以对两边取自然对数。\n$$ \\ln\\left(\\left(\\frac{d}{|S|}\\right)^k\\right) \\le \\ln(\\delta) $$\n利用对数性质 $\\ln(a^b) = b \\ln(a)$，我们得到：\n$$ k \\ln\\left(\\frac{d}{|S|}\\right) \\le \\ln(\\delta) $$\n现在，我们希望分离出 $k$。我们需要除以 $\\ln\\left(\\frac{d}{|S|}\\right)$。由于题中说明，对于实际测试有 $|S| > d$，所以分数 $\\frac{d}{|S|}$ 小于 1。一个介于 0 和 1 之间的数的自然对数是负数。当我们将一个不等式两边同时除以一个负数时，必须反转不等号：\n$$ k \\ge \\frac{\\ln(\\delta)}{\\ln\\left(\\frac{d}{|S|}\\right)} $$\n这个表达式是正确的，但我们可以利用对数性质将其改写成更直观的形式。注意 $\\ln(a/b) = -\\ln(b/a)$ 以及 $\\ln(x) = -\\ln(1/x)$。\n$$ k \\ge \\frac{-\\ln(1/\\delta)}{-\\ln(|S|/d)} $$\n$$ k \\ge \\frac{\\ln(1/\\delta)}{\\ln(|S|/d)} $$\n这种形式通常更受欢迎，因为分子和分母都是正数（因为 $\\delta < 1$ 意味着 $1/\\delta > 1$，且 $|S|/d > 1$）。\n\n问题要求的是最小*整数*试验次数。由于 $k$ 必须是整数并满足此不等式，我们必须对右侧表达式取上取整，以找到 $k$ 的最小整数值。\n$$ k = \\left\\lceil \\frac{\\ln(1/\\delta)}{\\ln(|S|/d)} \\right\\rceil $$\n这就是满足所需容错率的最小试验次数。", "answer": "$$\\boxed{\\left\\lceil \\frac{\\ln(1/\\delta)}{\\ln(|S|/d)} \\right\\rceil}$$", "id": "1435768"}]}