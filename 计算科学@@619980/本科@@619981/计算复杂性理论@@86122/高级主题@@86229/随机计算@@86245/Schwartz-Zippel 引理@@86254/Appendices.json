{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。让我们从一个具体的例子开始，这个例子模拟了在现实中我们可能遇到的一个常见问题：如何快速验证一个复杂的数学公式的正确性。这个练习 [@problem_id:1462426] 将在一个简单的单变量环境中，向你展示多项式恒等式检验的核心思想。通过在一个随机点上测试一个非零的“差分多项式”，我们可以以极高的概率检测出一个错误的恒等式。", "problem": "一名计算机科学专业的学生受命验证一本旧数学手册中的一个复杂公式。该手册声称，对于任何正整数 $n$，以下关于立方和的恒等式成立：\n$$ \\sum_{k=1}^{n} k^3 = \\frac{1}{4}n^4 + \\frac{1}{2}n^3 - \\frac{3}{4}n^2 + 15n - 50 $$\n由于没有时间进行完整的符号证明，该学生决定使用概率性测试。该过程包括从整数集合 $S = \\{1, 2, 3, \\ldots, 500\\}$ 中均匀随机地选择一个整数 $n$。然后，学生将为这个选定的 $n$ 计算等式左侧（求和）和右侧（多项式）的值。如果这两个值匹配，学生将得出结论，该恒等式是正确的。否则，他们将得出结论，该恒等式是错误的。\n\n实际上，该声称的恒等式是错误的。学生测试未能发现这一错误，即他们错误地得出恒等式是正确的结论的概率是多少？将答案表示为小数，并四舍五入到三位有效数字。", "solution": "立方和的真实公式是\n$$\nS(n)=\\sum_{k=1}^{n} k^{3}=\\left(\\frac{n(n+1)}{2}\\right)^{2}=\\frac{1}{4}\\left(n^{4}+2n^{3}+n^{2}\\right)=\\frac{1}{4}n^{4}+\\frac{1}{2}n^{3}+\\frac{1}{4}n^{2}.\n$$\n声称的多项式是\n$$\nP(n)=\\frac{1}{4}n^{4}+\\frac{1}{2}n^{3}-\\frac{3}{4}n^{2}+15n-50.\n$$\n当 $S(n)=P(n)$ 时，恒等式才精确成立。考虑两者的差\n$$\nD(n)=S(n)-P(n)=\\left(\\frac{1}{4}n^{4}+\\frac{1}{2}n^{3}+\\frac{1}{4}n^{2}\\right)-\\left(\\frac{1}{4}n^{4}+\\frac{1}{2}n^{3}-\\frac{3}{4}n^{2}+15n-50\\right).\n$$\n逐项简化，\n$$\nD(n)=\\left(\\frac{1}{4}-\\frac{1}{4}\\right)n^{4}+\\left(\\frac{1}{2}-\\frac{1}{2}\\right)n^{3}+\\left(\\frac{1}{4}+\\frac{3}{4}\\right)n^{2}-15n+50 = n^{2}-15n+50.\n$$\n因此，声称的恒等式仅在以下情况下精确成立\n$$\nn^{2}-15n+50=0.\n$$\n解得，\n$$\nn=\\frac{15\\pm\\sqrt{15^{2}-4\\cdot 1\\cdot 50}}{2}=\\frac{15\\pm\\sqrt{225-200}}{2}=\\frac{15\\pm 5}{2}\\in\\{5,10\\}.\n$$\n$n=5$ 和 $n=10$ 都在 $S=\\{1,2,\\ldots,500\\}$ 中。因此，当 $n$ 从 $S$ 中均匀选择时，（错误地）得出恒等式正确的结论的概率等于\n$$\n\\frac{|\\{5,10\\}|}{|S|}=\\frac{2}{500}=\\frac{1}{250}=0.00400,\n$$\n四舍五入到三位有效数字。", "answer": "$$\\boxed{0.00400}$$", "id": "1462426"}, {"introduction": "上一个例子表明，随机测试的出错概率似乎很小，但这究竟是巧合还是一个普遍规律？这个练习 [@problem_id:1462388] 将我们从具体的计算带到普适的原理。它将直接应用 Schwartz-Zippel 引理，来确定多项式恒等式测试失败的“最大”可能概率，从而将多项式的次数 $d$ 和我们抽样集合的大小 $|S|$ 与结论的可靠性直接联系起来。", "problem": "一家公司开发了一个密码校验和系统，用于在分布式网络中验证数据完整性。一台中央服务器持有一个主数据集，该数据集在数学上由多项式 $P(x_1, x_2, x_3)$ 表示。一个远程客户端处理一些信息并生成其自己的数据集，该数据集由多项式 $Q(x_1, x_2, x_3)$ 表示。当且仅当客户端的多项式 $Q$ 与主多项式 $P$ 完全相同时，其计算才被认为是正确的。\n\n为了在不传输庞大多项式的情况下验证客户端的工作，他们使用了一种概率性验证协议。服务器公开宣布一个有限整数集 $S$。然后，通过从集合 $S$ 中独立且均匀随机地选择每个坐标 $r_i$ 来安全地生成一个随机求值点 $(r_1, r_2, r_3)$。如果客户端的多项式在该随机点上的求值结果与服务器的相同，即 $P(r_1, r_2, r_3) = Q(r_1, r_2, r_3)$，则客户端的工作被接受。\n\n假设已知主多项式 $P$ 和客户端多项式 $Q$ 的总次数至多为 $d=20$。在一次特定的验证运行中，服务器宣布 $r_1, r_2,$ 和 $r_3$ 的值必须从集合 $S = \\{0, 1, 2, \\dots, 999\\}$ 中选择。\n\n假设客户端的计算是错误的，且其多项式 $Q$ 与 $P$ 不完全相同，那么单次验证测试未能检测到该错误（即测试通过）的最大可能概率是多少？请将您的答案表示为最简精确分数。", "solution": "设 $S=\\{0,1,2,\\dots,999\\}$，则 $|S|=1000$。验证过程从 $S^{3}$ 中独立均匀随机地选取点 $(r_{1},r_{2},r_{3})$。假设 $Q\\not\\equiv P$。定义差多项式\n$$\nR(x_{1},x_{2},x_{3})=P(x_{1},x_{2},x_{3})-Q(x_{1},x_{2},x_{3}).\n$$\n那么 $R$ 是一个总次数至多为 $d=20$ 的非零多项式。测试通过当且仅当 $P(r_{1},r_{2},r_{3})=Q(r_{1},r_{2},r_{3})$，即 $R(r_{1},r_{2},r_{3})=0$ 时。\n\n根据 Schwartz–Zippel 引理，对于一个总次数至多为 $d$ 的非零多项式 $R$ 和一个从 $S^{n}$（这里 $n=3$）中均匀随机选取的点，$R$ 的求值为零的概率至多为 $\\frac{d}{|S|}$。将 $d=20$ 和 $|S|=1000$ 代入此引理可得\n$$\n\\Pr\\big(R(r_{1},r_{2},r_{3})=0\\big)\\leq \\frac{20}{1000}=\\frac{1}{50}.\n$$\n此外，这个界是紧的：例如，取 $R(x_{1},x_{2},x_{3})=\\prod_{k=1}^{20}(x_{1}-a_{k})$，其中 $a_{k}\\in S$ 且互不相同。那么 $R$ 的次数为 $20$，且当且仅当 $r_{1}\\in\\{a_{1},\\dots,a_{20}\\}$ 时其值为零，这种情况发生的概率为 $\\frac{20}{1000}=\\frac{1}{50}$，且与 $r_{2}$ 和 $r_{3}$ 的取值无关。因此，单次测试未能检测到错误的最大可能概率等于 $\\frac{1}{50}$。", "answer": "$$\\boxed{\\frac{1}{50}}$$", "id": "1462388"}, {"introduction": "概率算法的威力远不止于简单的恒等式检验（即判断 $P \\equiv Q$）。这个更高级的练习 [@problem_id:1462404] 展示了如何利用 Schwartz-Zippel 引理来设计一个测试，以判断多项式是否具有某种结构特性——在这个例子中是“对称性”。通过引入一个辅助变量，我们将多个检验条件巧妙地合并成一个单一的测试多项式，这充分体现了 Schwartz-Zippel 引理在算法设计中的多功能性和巧妙之处。", "problem": "算术电路是一种表示多项式的计算模型。它是一个有向无环图，其中叶节点用输入变量（$x_1, \\dots, x_n$）或常数标记，内部节点（门）用算术运算（$+, \\times, -$）标记。电路的输出是在指定根节点处计算出的多项式。即使对于高次多项式，这种表示也可以非常紧凑。\n\n如果一个多元多项式 $P(x_1, \\dots, x_n)$ 的值在其变量的任何排列下都保持不变，则称其为**对称的**。也就是说，对于集合 $\\{1, 2, \\dots, n\\}$ 的每个排列 $\\sigma$，恒等式 $P(x_1, \\dots, x_n) \\equiv P(x_{\\sigma(1)}, \\dots, x_{\\sigma(n)})$ 成立。\n\n考虑一个具有 $n \\ge 2$ 个变量的多项式 $P(x_1, \\dots, x_n)$，它由一个在实数域上的算术电路给出。已知 $P$ 的总次数至多为 $d$。你的任务是设计一个随机算法来检验 $P$ 是否对称。\n\n你的算法必须基于在单个随机选择的点上，对一个由 $P$ 构建的单一测试表达式进行求值。该测试必须具有单边错误：如果 $P$ 是对称的，测试必须必然通过。如果 $P$ 不是对称的，测试可能会以一定概率失败（即错误地报告 $P$ 是对称的）。\n\n为了构建你的测试，你可以使用群论中的以下事实：对于 $n \\ge 2$，对称群 $S_n$（即 $n$ 个元素的所有排列构成的群）由对换 $\\tau = (1, 2)$（交换前两个元素）和长循环 $\\pi = (1, 2, \\dots, n)$（循环置换所有元素）生成。这意味着任何在 $\\tau$ 和 $\\pi$ 作用下都不变的多项式都是完全对称的。\n\n你将使用 $P$、一个辅助变量 $y$ 以及排列 $\\tau$ 和 $\\pi$ 来构建你的测试。该测试将涉及从一个有限整数集 $S$ 中独立且一致地随机选取 $x_1, \\dots, x_n$ 和 $y$ 的值。\n\n对于此类测试，错误结果（即当 $P$ 不是对称时，算法输出“对称”）的概率的最紧上界是多少？用一个包含 $d$ 和采样集大小 $|S|$ 的单一闭式解析表达式来表示你的答案。", "solution": "设 $n \\ge 2$，且 $P(x_{1},\\dots,x_{n})$ 由一个定义在 $\\mathbb{R}$ 上，总次数至多为 $d$ 的算术电路给出。对于 $x=(x_{1},\\dots,x_{n})$，定义 $S_{n}$ 的生成元的作用如下\n$$\n\\tau(x)=(x_{2},x_{1},x_{3},\\dots,x_{n}),\\qquad \\pi(x)=(x_{2},x_{3},\\dots,x_{n},x_{1}).\n$$\n令\n$$\nA(x) \\equiv P(x)-P(\\tau(x)),\\qquad B(x) \\equiv P(x)-P(\\pi(x)).\n$$\n由于排列不改变总次数，因此 $A$ 和 $B$ 的总次数都至多为 $d$。引入一个辅助变量 $y$ 并定义单个测试多项式\n$$\nQ(x,y) \\equiv A(x) + y\\,B(x).\n$$\n我们从一个有限整数集 $S$ 中独立且一致地随机选取 $x_{1},\\dots,x_{n},y$，当且仅当在采样点处 $Q(x,y)=0$ 时，输出“对称”。\n\n该测试具有单边错误：\n- 如果 $P$ 是对称的，那么它在 $\\tau$ 和 $\\pi$ 作用下都不变，因此 $A \\equiv 0$ 且 $B \\equiv 0$，所以 $Q \\equiv 0$。因此，测试总是输出“对称”。\n- 如果 $P$ 不是对称的，那么 $A,B$ 中至少有一个是非零多项式，因此 $Q$ 是关于变量 $(x_{1},\\dots,x_{n},y)$ 的非零多项式。\n\n我们使用 Schwartz–Zippel 引理来界定错误概率（即当 $Q \\not\\equiv 0$ 时，在采样点处 $Q(x,y)=0$ 这一事件的概率）。$Q$ 的总次数满足\n$$\n\\deg(Q) \\le \\max\\{\\deg(A),\\,\\deg(yB)\\} \\le \\max\\{d,\\,1+d\\} = d+1,\n$$\n因为 $\\deg(A) \\le d$ 且 $\\deg(B) \\le d$，而与 $y$ 相乘使总次数至多增加 $1$。根据 Schwartz–Zippel 引理，对于一个域上的总次数至多为 $D$ 的非零多项式，当每个变量都从一个有限集 $S$ 中独立且一致地随机采样时，其值为零的概率至多为 $D/|S|$。将此引理应用于 $D=d+1$ 的情况可得\n$$\n\\Pr[Q(x,y)=0 \\mid Q \\not\\equiv 0] \\le \\frac{d+1}{|S|}.\n$$\n对于这种形式的测试，这个界通常是紧的，因为在最坏情况下（当 $\\deg(B)=d$ 时），$\\deg(Q)$ 的下界不能低于 $d+1$，并且对于给定总次数的多项式，Schwartz–Zippel 界在达到等号的意义下是最优的。\n\n因此，错误接受概率的最紧上界是 $\\frac{d+1}{|S|}$。", "answer": "$$\\boxed{\\frac{d+1}{|S|}}$$", "id": "1462404"}]}