{"hands_on_practices": [{"introduction": "在BPP的定义中，错误概率常被设为 $1/3$，但这看起来有些随意。本练习旨在探讨BPP类定义的稳健性。我们将思考一个问题：如果错误概率仅仅是与 $1/2$ 有一个多项式级别的微小差距，我们是否还能得到一个同样强大的计算类？通过这个练习，你将亲身体会到概率放大技术的力量，并理解为何BPP是一个定义明确且强大的复杂性类。[@problem_id:1444372]", "problem": "在计算复杂性理论中，BPP 类（代表有界错误概率多项式时间，Bounded-error Probabilistic Polynomial time）被定义为这样一类判定问题：它们可以由一台概率图灵机在多项式时间内解决，且错误概率被一个严格小于 1/2 的常数所界定。形式上，一个语言 $L$ 属于 BPP，如果存在一个概率多项式时间图灵机 $M$ 和一个常数 $\\epsilon$（满足 $0 \\leq \\epsilon < 1/2$），使得对于所有输入 $x$：\n- 如果 $x \\in L$，那么 $P(M(x) \\text{ 接受}) \\geq 1 - \\epsilon$。\n- 如果 $x \\notin L$，那么 $P(M(x) \\text{ 接受}) \\leq \\epsilon$。\n通常情况下，$\\epsilon$ 被选为 $1/3$。\n\n考虑一个修改后的复杂性类，我们称之为 $BPP_{weak}$，其中错误概率不再由常数界定，而是由一个多项式接近于 $1/2$ 的值界定。具体来说，一个语言 $L$ 属于 $BPP_{weak}$，如果存在一个概率多项式时间图灵机 $M$ 和一个多项式 $p(n)$，使得对于任何长度为 $n$ 的输入 $x$：\n- 如果 $x \\in L$，那么 $P(M(x) \\text{ 接受}) \\geq \\frac{1}{2} + \\frac{1}{p(n)}$。\n- 如果 $x \\notin L$，那么 $P(M(x) \\text{ 接受}) \\leq \\frac{1}{2} - \\frac{1}{p(n)}$。\n\n给定其他复杂性类（如 NP (非确定性多项式时间)、PP (概率多项式时间，其错误概率仅需 $ 1/2$) 和 PH (多项式层级)）的标准定义，下列哪个陈述正确地描述了复杂性类 $BPP_{weak}$？\n\nA. $BPP_{weak} = P$\n\nB. $BPP_{weak} = BPP$\n\nC. $BPP_{weak} = NP$\n\nD. $BPP_{weak} = PP$\n\nE. $BPP_{weak}$ 包含整个多项式层级 (PH)。", "solution": "我们首先重申这两个类的定义。在 $BPP$ 中，存在一个概率多项式时间图灵机 $M$ 和一个常数 $\\epsilon$（满足 $0 \\leq \\epsilon  \\frac{1}{2}$），使得对于所有 $x$：\n- 如果 $x \\in L$，那么 $P(M(x)\\ \\text{接受}) \\geq 1 - \\epsilon$。\n- 如果 $x \\notin L$，那么 $P(M(x)\\ \\text{接受}) \\leq \\epsilon$。\n\n在 $BPP_{weak}$ 中，存在一个概率多项式时间图灵机 $M$ 和一个多项式 $p(n)$，使得对于所有 $|x|=n$ 的 $x$：\n- 如果 $x \\in L$，那么 $P(M(x)\\ \\text{接受}) \\geq \\frac{1}{2} + \\frac{1}{p(n)}$。\n- 如果 $x \\notin L$，那么 $P(M(x)\\ \\text{接受}) \\leq \\frac{1}{2} - \\frac{1}{p(n)}$。\n\n我们将通过证明两个方向的包含关系来证明 $BPP_{weak} = BPP$。\n\n1) $BPP \\subseteq BPP_{weak}$:\n假设 $L \\in BPP$。那么存在一个在多项式时间内运行的机器 $M$，其错误率至多为 $\\epsilon$，其中 $0 \\leq \\epsilon  \\frac{1}{2}$。令 $\\delta = \\frac{1}{2} - \\epsilon$，它满足 $\\delta  0$ 且是一个与 $n$ 无关的常数。对于 $x \\in L$，我们有\n$$\nP(M(x)\\ \\text{接受}) \\geq 1 - \\epsilon = \\frac{1}{2} + \\delta,\n$$\n对于 $x \\notin L$，\n$$\nP(M(x)\\ \\text{接受}) \\leq \\epsilon = \\frac{1}{2} - \\delta.\n$$\n选择多项式 $p(n) \\equiv \\frac{1}{\\delta}$（一个常数多项式）。那么 $\\frac{1}{p(n)} = \\delta$，并且 $BPP_{weak}$ 的条件得到满足。因此 $L \\in BPP_{weak}$，这就证明了 $BPP \\subseteq BPP_{weak}$。\n\n2) $BPP_{weak} \\subseteq BPP$:\n假设 $L \\in BPP_{weak}$。那么存在一个概率多项式时间图灵机 $M$ 和一个多项式 $p(n)$，使得对于 $|x|=n$ 的输入，\n- 如果 $x \\in L$，那么 $P(M(x)\\ \\text{接受}) \\geq \\frac{1}{2} + \\frac{1}{p(n)}$。\n- 如果 $x \\notin L$，那么 $P(M(x)\\ \\text{接受}) \\leq \\frac{1}{2} - \\frac{1}{p(n)}$。\n\n定义 $\\delta(n) = \\frac{1}{p(n)}$。考虑一台新机器 $M'$，它在接收到长度为 $n$ 的输入 $x$ 时，独立运行 $M(x)$ 共 $t$ 次（每次使用新的随机位），并输出这 $t$ 次结果的多数票。我们选择 $t$ 为 $n$ 的一个多项式；具体来说，我们设置\n$$\nt(n) = \\left\\lceil \\frac{\\ln 3}{2}\\, p(n)^{2} \\right\\rceil.\n$$\n令 $X_{1},\\dots,X_{t}$ 为 $M$ 的 $t$ 次运行的指示随机变量，其中如果第 $i$ 次运行接受则 $X_{i}=1$，否则 $X_{i}=0$。并令 $S = \\sum_{i=1}^{t} X_{i}$。\n\n对于 $x \\in L$，我们有 $\\mathbb{E}[X_{i}] \\geq \\frac{1}{2} + \\delta(n)$，因此 $\\mathbb{E}[S] \\geq t\\left(\\frac{1}{2} + \\delta(n)\\right)$。$M'$ 在“是”实例上出错的事件是 $\\{S \\leq t/2\\}$。根据 Hoeffding 不等式的加法形式（一个 Chernoff 界），对于独立的 $X_{i} \\in \\{0,1\\}$，\n$$\nP\\left(S - \\mathbb{E}[S] \\leq -\\delta(n)\\, t\\right) \\leq \\exp\\!\\left(-\\frac{2\\, \\delta(n)^{2}\\, t^{2}}{t}\\right) = \\exp\\!\\left(-2\\, \\delta(n)^{2}\\, t\\right).\n$$\n因此\n$$\nP(M'(x)\\ \\text{在 } x \\in L \\text{ 上出错}) \\leq \\exp\\!\\left(-2\\, \\delta(n)^{2}\\, t\\right).\n$$\n代入 $\\delta(n) = \\frac{1}{p(n)}$ 和 $t = \\left\\lceil \\frac{\\ln 3}{2}\\, p(n)^{2} \\right\\rceil$，我们得到\n$$\n\\exp\\!\\left(-2 \\cdot \\frac{1}{p(n)^{2}} \\cdot \\frac{\\ln 3}{2}\\, p(n)^{2}\\right) = \\exp(-\\ln 3) = \\frac{1}{3}.\n$$\n因此对于 $x \\in L$，$P(M'(x)\\ \\text{接受}) \\geq \\frac{2}{3}$。\n\n一个对称的论证适用于 $x \\notin L$ 的情况，此时 $\\mathbb{E}[X_{i}] \\leq \\frac{1}{2} - \\delta(n)$；错误事件为 $\\{S \\geq t/2\\}$，且同样的上界可得出\n$$\nP(M'(x)\\ \\text{在 } x \\notin L \\text{ 上出错}) \\leq \\frac{1}{3},\n$$\n所以 $P(M'(x)\\ \\text{接受}) \\leq \\frac{1}{3}$。\n\n因此，$M'$ 是一台判定语言 $L$ 的概率多项式时间机器，其双边错误率至多为 $\\frac{1}{3}$，即 $L \\in BPP$。由于 $p(n)$ 是一个多项式，$t(n)$ 也是一个多项式，因此 $M'$ 在多项式时间内运行。\n\n结合两个方向的包含关系，我们得出结论 $BPP_{weak} = BPP$。\n\n在给定的选项中，这对应于选项 B，而其他选项在一般情况下不成立。", "answer": "$$\\boxed{B}$$", "id": "1444372"}, {"introduction": "许多NP问题，如布尔可满足性问题（SAT），拥有一个优雅的特性，称为自可约性，它允许我们利用判定性问题的“预言机”来构造一个实际的解。然而，当这个预言机是概率性的（即一个BPP算法）时，情况会发生根本性的变化。这个练习将引导你分析为什么直接套用这种“搜索-判定”的归约方法在BPP情境下会失败，从而揭示处理概率算法时错误累积的核心挑战。[@problem_id:1444373]", "problem": "在计算复杂性理论中，一种关联问题的搜索版本和判定版本的常用技术是*自可归约性*（self-reducibility）。对于非确定性多项式时间 (NP) 类中的许多问题，例如布尔可满足性问题 (SAT)，一个用于判定问题（即“该公式是否可满足？”）的预言机可以被用来解决搜索问题（即“找到一个可满足赋值”）。对于一个公式 $\\phi(x_1, x_2, \\ldots, x_n)$，可以查询预言机，将 $x_1$ 固定为 `false` 来询问 $\\phi$。如果结果公式是可满足的，我们就将 $x_1$ 固定为 `false`；否则，我们将其固定为 `true`。对 $x_2, x_3, \\ldots, x_n$ 重复此过程，以构造一个完整的可满足赋值。\n\n现在，考虑一个假设的自可归约判定问题 $L$，它属于复杂性类有界错误概率多项式时间 (BPP)。如果存在一个概率算法能在多项式时间内解决一个问题，且对任何输入的错误概率最多为 $1/3$，那么该问题就属于 BPP。因此，$L$ 的预言机就是这样一个概率算法，它提供一个“是”或“否”的答案，其正确的概率至少为 $2/3$。\n\n假设我们尝试使用相同的自可归约策略来为 $L$ 的搜索版本寻找一个解。这涉及到对 BPP 预言机进行 $n$ 次查询的序列，以逐一确定解的 $n$ 个比特。\n\n以下哪个陈述为这种自可归约过程的直接应用未能为搜索问题产生一个可靠算法提供了最准确和最根本的原因？\n\nA. BPP 问题的搜索空间结构不允许解被逐比特地增量构造。\n\nB. 根据定义，BPP 预言机不为“是”的答案提供证书或见证，而搜索到判定的归约从根本上要求在每一步都能验证这样的见证。\n\nC. 该过程需要多项式次数的顺序查询，而 BPP 预言机为序列中的每一次查询都返回正确答案的概率随着查询次数的增加而变得指数级小。\n\nD. BPP 中的错误是不对称的；“是”的答案比“否”的答案更可靠，这破坏了自可归约中对两种预言机答案同等信任的逻辑。\n\nE. 因为普遍猜想 BPP = P，所以任何 BPP 语言的搜索问题也必须在 P 中。因此，这种复杂的归约在计算上是多余且低效的。", "solution": "我们将自可归约过程形式化，并量化当预言机仅具有 BPP 级别的准确性时的可靠性。\n\n设语言 $L$ 的判定预言机是一个 BPP 算法，对任意输入，它返回正确的“是/否”答案的概率至少为 $p$，根据定义 $p \\geq \\frac{2}{3}$。标准的自可归约进行 $n$ 次自适应查询来确定一个 $n$ 比特的解：在步骤 $i \\in \\{1,\\ldots,n\\}$，它通过查询一个受限实例上的预言机并信任返回的答案来固定第 $i$ 个比特。\n\n对于每个步骤 $i$，定义事件 $E_{i}$ 为“步骤 $i$ 中预言机对所查询的受限实例的回答是正确的”。对每个 $i$，我们有\n$$\n\\Pr(E_{i}) \\geq p \\geq \\frac{2}{3}.\n$$\n为了输出一个正确的整体解，该过程需要所有 $n$ 个答案同时正确，即事件 $\\bigcap_{i=1}^{n} E_{i}$ 发生。如果我们在每一步都使用新的随机性来运行预言机，那么查询的正确性事件在自适应选择的输入条件下可以被视为独立的。在这种使用新随机性的标准情况下，所有 $n$ 个答案都正确的概率满足\n$$\n\\Pr\\left(\\bigcap_{i=1}^{n} E_{i}\\right) \\;=\\; \\prod_{i=1}^{n} \\Pr(E_{i}) \\;\\geq\\; p^{n} \\;\\geq\\; \\left(\\frac{2}{3}\\right)^{n}.\n$$\n因此，当每个比特只使用一次查询时，整个自可归约成功概率的最佳保证最多是一个随 $n$ 指数级衰减的界；更准确地说，保证的下界是 $\\left(\\frac{2}{3}\\right)^{n}$，这个值随 $n$ 呈指数级小。因此，直接应用是不可靠的：随着 $n$ 的增长，在整个序列中不出错的几率可能会变得指数级小。\n\n等价地，考虑至少有一个步骤出错的失败概率。根据联合界 (union bound)，\n$$\n\\Pr\\left(\\bigcup_{i=1}^{n} \\overline{E_{i}}\\right) \\;\\leq\\; \\sum_{i=1}^{n} \\Pr(\\overline{E_{i}}) \\;\\leq\\; n \\left(1 - p\\right) \\;\\leq\\; \\frac{n}{3},\n$$\n所以成功的平凡下界 $1 - \\frac{n}{3}$ 在 $n$ 很大时变得无意义。两种计算都表明，如果不进行错误削减（放大），直接顺序使用 BPP 预言机得到的总成功概率无法可靠地保持一个大于零的下界；在典型的独立情况下，它像 $\\left(\\frac{2}{3}\\right)^{n}$ 一样衰减。\n\n这指出了根本问题：在多项式长度的序列上，每次查询的常数级错误会累积，使得正确回答每个查询的概率变得指数级小，除非我们加入放大（amplification）过程。因此，选项中最准确和最根本的原因是，常数级错误判定的顺序组合使得全部正确的事件发生的可能性呈指数级小，这对应于选项 C。其他选项并非核心障碍：BPP 的“是/否”错误之间没有内在的不对称性（与 D 矛盾），搜索到判定的归约不要求 NP 风格的见证（与 B 矛盾），搜索空间的结构不是障碍（与 A 矛盾），关于 $\\mathrm{BPP}=\\mathrm{P}$ 的猜想与这种直接归约的可靠性无关（与 E 矛盾）。", "answer": "$$\\boxed{C}$$", "id": "1444373"}, {"introduction": "作为上一个练习的延伸，我们来设想一个理想化的情景：如果我们拥有一个错误概率极小（指数级小）的BPP预言机，情况又会如何？本练习要求你分析在这种强力假设下，搜索-判定归约是否能够成功。这个思想实验不仅解决了错误累积的问题，还将引导你得出一个关于NP和BPP之间关系的深刻结论。[@problem_id:1444357]", "problem": "在计算复杂性理论中，许多非确定性多项式时间 (NP) 搜索问题可以通过对一个能在多项式时间内解决相应判定问题的假设预言机进行多项式次调用来解决。这被称为搜索到判定归约。\n\n考虑布尔可满足性问题 (SAT)，这是一个典型的NP完全问题。其判定版本询问给定的布尔公式 $\\phi$ 是否有可满足赋值。其搜索版本要求在存在可满足赋值的情况下找到这样一个赋值。一个针对具有 $n$ 个变量的SAT问题的标准搜索到判定归约，通过对判定预言机进行大约 $n$ 次调用来逐一确定每个变量的值。\n\n现在，考虑一个假设情景：我们没有一个用于SAT问题的确定性多项式时间预言机。相反，我们有一个能够解决SAT判定问题的概率算法，该算法属于复杂性类有界错误概率多项式时间 (BPP)。该算法的运行时间是输入规模 $m=|\\phi|$ 的多项式，并且具有错误概率 $\\epsilon$。具体而言，对于任何规模为 $m$ 的输入公式 $\\phi$，该算法保证其错误概率 $\\epsilon \\le 2^{-m^c}$，其中 $c \\ge 1$ 是某个固定常数。\n\n在此情景下，请分析使用这个概率预言机进行SAT的搜索到判定归约的可行性。以下哪个陈述代表了可以得出的最强的正确结论？\n\nA. 搜索到判定归约会失败，因为对BPP预言机的多次查询所累积的错误概率变得不可忽略（即，不是多项式小的），从而无法可靠地构造一个解。\n\nB. 搜索到判定归约成功地为搜索问题创建了一个概率算法，并且一个NP完全问题存在BPP算法意味着 $\\text{BPP} \\subseteq \\text{NP}$。\n\nC. 搜索到判定归约成功地为搜索问题创建了一个概率算法，并且一个NP完全问题存在BPP算法意味着 $\\text{NP} \\subseteq \\text{BPP}$。\n\nD. 搜索到判定归约成功，但仅此事实本身并未提供关于判定复杂性类NP和BPP之间关系的任何新信息。\n\nE. 即使是概率性的，一个NP完全问题存在BPP算法也足以意味着 $\\text{P} = \\text{NP}$，这使得搜索到判定归约的属性成为一个次要结果。", "solution": "设 $\\phi$ 是一个具有 $n$ 个变量且规模为 $m=|\\phi|$ 的输入公式。假设我们有一个用于SAT的概率判定算法，其运行时间是输入规模的多项式，并且对于任何规模为 $m'$ 的输入，其错误概率至多为 $\\epsilon(m') \\le 2^{-(m')^{c}}$，其中 $c \\ge 1$ 是某个固定常数。\n\n标准的搜索到判定归约逐一固定变量 $x_{1},\\dots,x_{n}$。在第 $i$ 步，给定对 $x_{1},\\dots,x_{i-1}$ 的部分赋值，我们通过查询判定预言机来确定 $x_{i}$ 的值。查询的公式是通过将强制实施该部分赋值的单元子句以及 $x_{i}$ 或 $\\lnot x_{i}$ 与 $\\phi$ 合取而得到的。为了统一控制错误上界，我们通过添加重言式子句来填充每个查询，以使每个被查询的公式规模至少为 $m$ 且至多是 $m$ 的多项式。填充不改变可满足性，并且它确保了对于每个查询 $q_{i}$，我们有 $|q_{i}| \\ge m$，因此\n$$\n\\epsilon_{i} \\le 2^{-|q_{i}|^{c}} \\le 2^{-m^{c}}.\n$$\n预言机查询的次数 $t$ 至多为 $n$，并且由于对于任何对 $\\phi$ 的合理编码都有 $n \\le m$，我们有 $t \\le p(m)$，其中 $p$ 是某个多项式。这些查询是自适应的，但联合界并不要求独立性。因此，$t$ 次查询中任何一次出错的概率满足\n$$\n\\Pr[\\text{any error among the }t\\text{ queries}] \\le \\sum_{i=1}^{t} \\epsilon_{i} \\le t \\cdot 2^{-m^{c}} \\le p(m)\\cdot 2^{-m^{c}}.\n$$\n因此，整个重构的赋值是正确的概率至少为 $1 - p(m)\\cdot 2^{-m^{c}}$，这仍然是指数级小的失败概率。我们还可以在确定性多项式时间内通过在该赋值下对 $\\phi$ 求值来验证最终的赋值；如果验证失败，重复整个过程会得到一个期望多项式运行时间的拉斯维加斯算法，因为每次运行的失败概率是 $p(m)\\cdot 2^{-m^{c}}$。\n\n因此，搜索到判定归约成功，并为SAT的搜索版本产生了一个具有可忽略错误的概率多项式时间算法。\n\n对于复杂性类的推论，如果 $\\text{SAT} \\in \\text{BPP}$，那么每个 $L \\in \\text{NP}$ 都可以通过一个确定性多项式时间映射归约 $f$ 归约到SAT，其中 $x \\in L$ 当且仅当 $f(x) \\in \\text{SAT}$。将 $f$ 与用于SAT的BPP算法复合，就得到了一个用于 $L$ 的BPP算法，所以\n$$\n\\text{NP} \\subseteq \\text{BPP}.\n$$\n因此，最强的正确结论是，搜索到判定归约成功，并且一个NP完全问题存在BPP算法意味着 $\\text{NP} \\subseteq \\text{BPP}$。", "answer": "$$\\boxed{C}$$", "id": "1444357"}]}