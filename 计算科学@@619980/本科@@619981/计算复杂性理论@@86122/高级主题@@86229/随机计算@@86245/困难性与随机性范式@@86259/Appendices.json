{"hands_on_practices": [{"introduction": "伪随机生成器 (PRG) 的核心安全要求是其输出与真正的随机字符串在计算上不可区分。理解这一点的第一步是观察一个设计不佳的生成器如何被一个简单的统计测试“攻破”。这个练习 [@problem_id:1457800] 让你通过分析一个极其简单的“补零”生成器，亲手计算“区分优势”($$Adv_G(T)$$)，从而直观地把握 PRG 安全性的基本概念。", "problem": "在计算复杂性理论中，伪随机生成器 (PRG) 是一种将短的真随机种子扩展为更长的伪随机字符串的算法。形式上，如果一个函数 $G: \\{0,1\\}^k \\to \\{0,1\\}^n$（其中 $n>k$）的输出与一个长度为 $n$ 的真随机字符串“计算上不可区分”，那么它就是一个 PRG。变量 $k$ 被称为安全参数。\n\n不可区分性是通过统计测试来衡量的，统计测试是任何以一个 $n$ 位字符串为输入并输出单个比特 0 或 1 的概率多项式时间算法 $T$。如果一个测试 $T$ 能够以不可忽略的优势区分生成器 $G$ 的输出和真随机字符串，我们就说这个测试“攻破”或“区分”了生成器 $G$。\n\n测试 $T$ 对于生成器 $G$ 的优势定义为：\n$$\n\\text{Adv}_G(T) = \\left| \\Pr_{s \\sim U_k}[T(G(s))=1] - \\Pr_{r \\sim U_n}[T(r)=1] \\right|\n$$\n其中 $s \\sim U_k$ 表示 $s$ 是从 $\\{0,1\\}^k$ 中均匀随机选择的种子，而 $r \\sim U_n$ 表示 $r$ 是从 $\\{0,1\\}^n$ 中均匀随机选择的字符串。\n\n如果存在一个正常数 $c$，使得对于所有足够大的 $k$ 都有 $\\text{Adv}_G(T) \\ge \\frac{1}{k^c}$，则该优势被认为是不可忽略的。如果该优势比 $k$ 的任何多项式倒数都收缩得更快（即，它是可忽略的），则该测试未能攻破生成器。\n\n考虑一个简单的候选生成器，我们称之为“补零”生成器，$G_{PZ}: \\{0,1\\}^k \\to \\{0,1\\}^{k+1}$。对于任何 $k$ 位种子 $s \\in \\{0,1\\}^k$，该生成器定义为：\n$$\nG_{PZ}(s) = s \\circ 0\n$$\n其中 $\\circ$ 表示字符串拼接。该生成器只是在种子后面附加一个固定的比特 '0'。\n\n以下哪个统计测试 $T: \\{0,1\\}^{k+1} \\to \\{0,1\\}$ 通过获得不可忽略的优势成功攻破了 $G_{PZ}$ 生成器？\n\nA. 对于输入 $x \\in \\{0,1\\}^{k+1}$，$T(x)$ 在 $x$ 的最后一位是 0 时输出 1，否则输出 0。\n\nB. 对于输入 $x \\in \\{0,1\\}^{k+1}$，$T(x)$ 在 $x$ 的汉明权重（`1` 的数量）为奇数时输出 1，否则输出 0。\n\nC. 对于输入 $x \\in \\{0,1\\}^{k+1}$，$T(x)$ 在 $x$ 的第一位是 0 时输出 1，否则输出 0。\n\nD. 对于输入 $x \\in \\{0,1\\}^{k+1}$，$T(x)$ 在 $x$ 的汉明权重小于或等于 $k/4$ 时输出 1，否则输出 0。假设 $k$ 是 4 的倍数。", "solution": "我们使用区分优势的定义\n$$\n\\text{Adv}_{G}(T)=\\left|\\Pr_{s \\sim U_{k}}[T(G(s))=1]-\\Pr_{r \\sim U_{k+1}}[T(r)=1]\\right|.\n$$\n对于补零生成器 $G_{PZ}(s)=s \\circ 0$，输出的最后一位始终为 $0$，而前 $k$ 位与 $s$ 一样是均匀分布的。\n\n测试 A：$T(x)$ 输出 $1$ 当且仅当 $x$ 的最后一位是 $0$。\n对于 $G_{PZ}$，最后一位永远是 $0$，因此\n$$\n\\Pr_{s \\sim U_{k}}[T(G_{PZ}(s))=1]=1.\n$$\n对于均匀随机的 $r \\sim U_{k+1}$，最后一位是 $0$ 的概率为 $\\frac{1}{2}$，因此\n$$\n\\Pr_{r \\sim U_{k+1}}[T(r)=1]=\\frac{1}{2}.\n$$\n因此\n$$\n\\text{Adv}_{G_{PZ}}(T)=\\left|1-\\frac{1}{2}\\right|=\\frac{1}{2},\n$$\n这是一个常数，因而是不可忽略的。所以 A 攻破了 $G_{PZ}$。\n\n测试 B：$T(x)$ 输出 $1$ 当且仅当 $x$ 的汉明权重是奇数。\n对于 $G_{PZ}(s)=s \\circ 0$，其汉明权重的奇偶性与 $s$ 的相同，而 $s$ 是均匀的；因此\n$$\n\\Pr_{s \\sim U_{k}}[T(G_{PZ}(s))=1]=\\frac{1}{2}.\n$$\n对于 $r \\sim U_{k+1}$，奇偶性也是平衡的，所以\n$$\n\\Pr_{r \\sim U_{k+1}}[T(r)=1]=\\frac{1}{2}.\n$$\n因此\n$$\n\\text{Adv}_{G_{PZ}}(T)=0,\n$$\n这是可忽略的。所以 B 没有攻破 $G_{PZ}$。\n\n测试 C：$T(x)$ 输出 $1$ 当且仅当 $x$ 的第一位是 $0$。\n对于 $G_{PZ}(s)$，第一位就是 $s$ 的第一位，是均匀的，所以\n$$\n\\Pr_{s \\sim U_{k}}[T(G_{PZ}(s))=1]=\\frac{1}{2}.\n$$\n对于 $r \\sim U_{k+1}$，第一位也是均匀的，所以\n$$\n\\Pr_{r \\sim U_{k+1}}[T(r)=1]=\\frac{1}{2}.\n$$\n因此\n$$\n\\text{Adv}_{G_{PZ}}(T)=0,\n$$\n这是可忽略的。所以 C 没有攻破 $G_{PZ}$。\n\n测试 D：$T(x)$ 输出 $1$ 当且仅当 $x$ 的汉明权重小于或等于 $k/4$（其中 $k$ 是 $4$ 的倍数）。\n设 $Y \\sim \\text{Bin}(k,\\frac{1}{2})$ 是 $s$ 的汉明权重，设 $X \\sim \\text{Bin}(k+1,\\frac{1}{2})$ 是 $r$ 的汉明权重。那么\n$$\n\\Pr_{s \\sim U_{k}}[T(G_{PZ}(s))=1]=\\Pr[Y \\leq k/4].\n$$\n将 $X$写作 $X=Y+B$，其中 $B \\sim \\text{Bernoulli}(\\frac{1}{2})$ 与 $Y$ 独立（即均匀随机的 $r$ 中额外附加的比特）。那么\n$$\n\\Pr_{r \\sim U_{k+1}}[T(r)=1]=\\Pr[X \\leq k/4]=\\frac{1}{2}\\Pr[Y \\leq k/4]+\\frac{1}{2}\\Pr[Y \\leq k/4 - 1].\n$$\n因此\n$$\n\\text{Adv}_{G_{PZ}}(T)=\\left|\\Pr[Y \\leq k/4]-\\left(\\frac{1}{2}\\Pr[Y \\leq k/4]+\\frac{1}{2}\\Pr[Y \\leq k/4 - 1]\\right)\\right|=\\frac{1}{2}\\Pr[Y=k/4].\n$$\n由于 $Y \\sim \\text{Bin}(k,\\frac{1}{2})$ 且 $k/4$ 与均值 $k/2$ 相差一个常数比例，根据均值为 $\\mu=k/2$、$\\delta=\\frac{1}{2}$ 的 Chernoff 界，点概率满足\n$$\n\\Pr[Y=k/4] \\leq \\Pr[Y \\leq k/4] \\leq \\exp\\!\\left(-\\frac{k}{16}\\right)\n$$\n因此\n$$\n\\text{Adv}_{G_{PZ}}(T) \\leq \\frac{1}{2}\\exp\\!\\left(-\\frac{k}{16}\\right),\n$$\n这是可忽略的。所以 D 没有攻破 $G_{PZ}$。\n\n结论：只有测试 A 获得了不可忽略的优势。", "answer": "$$\\boxed{A}$$", "id": "1457800"}, {"introduction": "理论分析是评估 PRG 的基础，但在实践中，我们常常通过大规模的统计实验来检验其安全性。这个练习 [@problem_id:1457819] 模拟了一个典型的评估场景，你需要根据实验收集到的数据来估计一个区分器的优势。通过这个过程，你将把区分优势的抽象概率定义与可观测的经验频率联系起来，从而更深刻地理解其现实意义。", "problem": "在密码学领域，伪随机生成器（PRG）是一种算法，它接收一个称为种子的短的、真正随机的二进制串，并将其确定性地扩展成一个看起来是随机的、更长的二进制串。我们将一个 PRG 表示为函数 $G: \\{0,1\\}^n \\to \\{0,1\\}^m$，其中 $n$ 是种子长度，$m$ 是输出长度，且 $m > n$。\n\nPRG的一个关键安全属性是其与真正随机源的不可区分性。为了测试这一点，我们使用一个“区分器”，它是一种算法，通常建模为布尔电路 $C: \\{0,1\\}^m \\to \\{0,1\\}$。电路 $C$ 试图猜测其输入是来自 PRG 还是来自真正的随机源。电路 $C$ 针对生成器 $G$ 的“区分优势”被正式定义为：当给定一个真正的随机输入时 $C$ 输出 ‘1’ 的概率，与当给定一个由随机种子生成的 $G$ 的输出时 $C$ 输出 ‘1’ 的概率，这两者之差的绝对值。\n\n一位网络安全分析师的任务是评估一个新提出的 PRG，我们称之为 $G_{new}$。为此，他们使用了一个专门设计的区分器电路，$C_{test}$。他们进行了一个由两部分组成的大规模统计实验：\n\n1.  在实验的第一部分，他们生成了 $1,500,000$ 个长度为 $m$ 的真正随机串，并将每一个作为输入提供给电路 $C_{test}$。他们记录到该电路总共输出了 $750,900$ 次 ‘1’。\n2.  在实验的第二部分，他们生成了 $1,500,000$ 个长度为 $n$ 的真正随机种子，将生成器 $G_{new}$ 应用于每个种子以产生 $1,500,000$ 个伪随机串，并将这些串逐一输入到电路 $C_{test}$ 中。在这种情况下，他们记录到电路总共输出了 $752,475$ 次 ‘1’。\n\n根据该实验的结果，计算电路 $C_{test}$ 针对生成器 $G_{new}$ 的估计区分优势。将你的答案表示为小数，并四舍五入到三位有效数字。", "solution": "电路 $C$ 针对生成器 $G$ 的区分优势定义为\n$$\n\\Delta(C,G) = \\left|\\Pr_{X \\leftarrow U_{m}}[C(X)=1] - \\Pr_{s \\leftarrow U_{n}}[C(G(s))=1]\\right|.\n$$\n在每种条件下从 $N$ 个样本中获得此优势的无偏经验估计，是通过将概率替换为相应的样本比例得到的。在每种条件下进行 $N=1500000$ 次试验，经验比例为\n$$\n\\hat{p}_{U} = \\frac{750900}{1500000}, \\quad \\hat{p}_{G} = \\frac{752475}{1500000}.\n$$\n因此，估计的区分优势为\n$$\n\\hat{\\Delta} = \\left|\\hat{p}_{U} - \\hat{p}_{G}\\right| = \\left|\\frac{750900 - 752475}{1500000}\\right| = \\frac{1575}{1500000} = 0.00105.\n$$\n四舍五入到三位有效数字，结果仍为 $0.00105$。", "answer": "$$\\boxed{0.00105}$$", "id": "1457819"}, {"introduction": "一个强大的 PRG 必须在各种统计测试下都表现得像随机的。然而，一些有缺陷的生成器能够成功模仿某些随机属性（如“成对独立性”），但在更复杂的测试面前却会暴露其非随机的本质。这个练习 [@problem_id:1457782] 探讨了一个其输出比特是成对独立的生成器，但一个简单的、同时检查三个比特的测试就能揭示其内在的确定性结构。通过计算协方差 ($$Cov(A, B)$$)，你将发现一个隐藏的相关性，这清晰地表明了为什么真正的伪随机性需要隐藏比简单统计特性更复杂的模式。", "problem": "在计算复杂度领域，一个关键挑战是生成看似随机的比特序列，即使它们是由确定性过程产生的。这些被称为伪随机比特。\n\n考虑一个简单的统计分析器，它被设计用来测试3比特伪随机字符串的质量。对于任意给定的3比特字符串 $x_1x_2x_3$，该分析器计算两个二元随机变量 $A$ 和 $B$ 之间的协方差，定义如下：\n-   如果字符串是回文（即，其第一位等于第三位，$x_1 = x_3$），则变量 $A$ 为1，否则为0。\n-   变量 $B$ 是中间位 $x_2$ 的值。\n\n一个特定的伪随机生成器被构造成是“两两独立”的。它首先生成两个真正独立且均匀随机的比特 $z_1$ 和 $z_2$。然后，它通过设置 $y_1 = z_1$，$y_2 = z_2$ 和 $y_3 = z_1 \\oplus z_2$ 来构造一个3比特字符串 $y_1y_2y_3$，其中 $\\oplus$ 表示异或 (XOR) 运算。\n\n你的任务是计算由这个特定伪随机生成器产生的3比特字符串的协方差 $Cov(A, B)$。请将你的最终答案表示为一个精确的分数。", "solution": "设 $z_{1}$ 和 $z_{2}$ 是独立且均匀随机的比特。生成器输出 $y_{1}=z_{1}$，$y_{2}=z_{2}$，以及 $y_{3}=z_{1}\\oplus z_{2}$。定义 $A$ 为字符串是回文的指示变量，即 $A=1$ 当且仅当 $y_{1}=y_{3}$，并定义 $B=y_{2}$。\n\n根据 $A$ 的定义，\n$$\nA=1 \\iff y_{1}=y_{3} \\iff z_{1}=z_{1}\\oplus z_{2}.\n$$\n使用异或恒等式 $u\\oplus u=0$ 和 $u\\oplus 0=u$，我们将等式两边与 $z_{1}$ 进行异或运算，得到\n$$\nz_{1}\\oplus z_{1}=z_{2} \\iff 0=z_{2}.\n$$\n因此，$A=1$ 当且仅当 $z_{2}=0$，否则 $A=0$。因为 $B=y_{2}=z_{2}$，所以可以确定性地得出\n$$\nA=1-B.\n$$\n\n我们使用公式 $\\operatorname{Cov}(A,B)=\\mathbb{E}[AB]-\\mathbb{E}[A]\\mathbb{E}[B]$ 来计算协方差。由于 $A=1-B$，\n$$\nAB=B(1-B)=B-B^{2}.\n$$\n对于一个二元变量 $B\\in\\{0,1\\}$，我们有 $B^{2}=B$ 逐点成立，因此 $AB=0$ 几乎必然成立，并且\n$$\n\\mathbb{E}[AB]=0.\n$$\n因为 $z_{2}$ 是均匀分布的，所以 $\\mathbb{E}[B]=\\mathbb{P}(z_{2}=1)=\\frac{1}{2}$ 且 $\\mathbb{E}[A]=\\mathbb{P}(z_{2}=0)=\\frac{1}{2}$。因此，\n$$\n\\operatorname{Cov}(A,B)=0-\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right)=-\\frac{1}{4}.\n$$", "answer": "$$\\boxed{-\\frac{1}{4}}$$", "id": "1457782"}]}