{"hands_on_practices": [{"introduction": "要理解为何需要复杂的随机化素性检验，最好的方式是先了解简单方法的不足。费马素性检验是一种基于费马小定理的优雅但有缺陷的方法，它可能被一些被称为“费马伪素数”的合数欺骗，因为这些数对特定基数 $a$ 满足 $a^{n-1} \\equiv 1 \\pmod{n}$ 的条件。通过动手寻找对常用基数 $2$ 的最小奇合数伪素数 [@problem_id:1441645]，你将具体理解为何我们需要更可靠的算法。", "problem": "费马素性检验是一种用于判断一个数是否可能为素数的概率性方法。对于一个待检验的给定整数 $n > 2$，我们选择一个称为基的整数 $a$，使得 $1 < a < n-1$。根据费马小定理，如果 $n$ 是一个素数，那么 $a^{n-1} \\equiv 1 \\pmod{n}$。\n\n该检验的工作原理如下：如果 $a^{n-1} \\not\\equiv 1 \\pmod{n}$，那么 $n$ 必定是合数。然而，如果 $a^{n-1} \\equiv 1 \\pmod{n}$，数 $n$ 就被称为关于基 $a$ 的“可能素数”。尽管所有素数对于任何有效的基 $a$ 都能通过此检验，但某些合数对于特定的基也满足该同余关系。这些合数被称为费马伪素数，它们代表了该检验的“假阳性”结果。\n\n你的任务是找到最小的奇合数 $n$，它是一个关于基 $a=2$ 的费马伪素数。", "solution": "我们寻求满足 $2^{n-1} \\equiv 1 \\pmod{n}$ 的最小奇合数 $n$。这样的 $n$ 被称为关于基 $2$ 的费马伪素数。\n\n考虑 $n=341$。首先分解 $341=11 \\cdot 31$，且 $\\gcd(2,341)=1$。根据费马小定理，对于素数 $p$，我们有 $2^{p-1} \\equiv 1 \\pmod{p}$，并且 $2$ 模 $p$ 的乘法阶整除 $p-1$。\n\n计算如下：\n- 模 $11$：$2^{5}=32 \\equiv 10 \\equiv -1 \\pmod{11}$，因此 $2^{10} \\equiv 1 \\pmod{11}$。\n- 模 $31$：$2^{5}=32 \\equiv 1 \\pmod{31}$，因此 $2^{10} \\equiv 1 \\pmod{31}$。\n\n因此有 $2^{10} \\equiv 1 \\pmod{11}$ 且 $2^{10} \\equiv 1 \\pmod{31}$。由于 $11$ 和 $31$ 互素，根据中国剩余定理，这蕴含着\n$$\n2^{10} \\equiv 1 \\pmod{341}.\n$$\n将两边取 $34$ 次幂，得到\n$$\n2^{340} = \\left(2^{10}\\right)^{34} \\equiv 1^{34} \\equiv 1 \\pmod{341}.\n$$\n因此，$341$ 是一个关于基 $2$ 的费马伪素数。\n\n这是一个标准且公认的事实，即 $341$ 是具有此性质的最小奇合数（第一个关于基 $2$ 的费马伪素数，也被称为第一个 Poulet 数）。因此，满足 $2^{n-1} \\equiv 1 \\pmod{n}$ 的最小奇合数 $n$ 是 $341$。", "answer": "$$\\boxed{341}$$", "id": "1441645"}, {"introduction": "在认识到费马检验的局限性后，我们现在转向更强大、在实践中广泛应用的米勒-拉宾（Miller-Rabin）检验。该测试的核心在于识别一个“强证据”（strong witness），这是一个利用了比费马小定理更严格的数论性质来揭示一个数的合数本质的整数。这个练习 [@problem_id:1441673] 将指导你为一个小型合数手动计算强证据，从而让你逐步分解并掌握米勒-拉宾算法的内部工作机制。", "problem": "在计算数论领域，Miller-Rabin 测试是一种广泛使用的概率性算法，用于判断一个数是否为合数。该测试中的一个关键概念是“强证据”(strong witness)。对于我们希望测试的奇数 $n > 2$，我们首先将 $n-1$ 写成 $2^k \\cdot m$ 的形式，其中 $m$ 是一个奇数且 $k \\ge 1$。\n\n如果满足以下两个条件，则称满足 $1 < a < n-1$ 的整数 $a$ 是 $n$ 的合数性的一个**强证据**：\n1. $a^m \\not\\equiv 1 \\pmod n$\n2. 对于所有在 $0 \\le i < k$ 范围内的整数 $i$，都有 $a^{2^i \\cdot m} \\not\\equiv -1 \\pmod n$。\n\n如果找到了这样的强证据 $a$，那么数 $n$ 必定是合数。\n\n考虑一个场景，一个密码系统的素性测试模块正在被验证。它被输入已知的合数 $n=57$。你的任务是执行一次手动检查，找到可作为 $n=57$ 的合数性的强证据的最小整数 $a > 1$。", "solution": "给定 $n=57$，我们必须将 $n-1$ 写成 $2^{k} m$ 的形式，其中 $m$ 为奇数。由于 $57-1=56$ 且 $56=2^{3}\\cdot 7$，我们得到 $k=3$ 且 $m=7$。\n\n我们寻找满足 $1<a<n-1$ 的最小整数 $a$，它是一个强证据，即满足：\n1. $a^{m} \\not\\equiv 1 \\pmod{57}$，\n2. 对所有 $0 \\leq i < 3$ 的 $i$，都有 $a^{2^{i} m} \\not\\equiv -1 \\pmod{57}$。\n\n测试 $a=2$（最小的允许基数）。计算模 $57$ 下的连续幂次：\n$$\n2^{6}=64 \\equiv 7 \\pmod{57} \\quad \\Rightarrow \\quad 2^{7}=2\\cdot 2^{6} \\equiv 2\\cdot 7=14 \\pmod{57}.\n$$\n因此 $2^{m} \\equiv 14 \\not\\equiv 1 \\pmod{57}$，满足第一个条件。\n\n现在连续进行平方运算，以检验 $i=0,1,2$ 时是否满足第二个条件：\n$$\n2^{14} \\equiv 14^{2}=196 \\equiv 196-3\\cdot 57=196-171=25 \\pmod{57},\n$$\n$$\n2^{28} \\equiv 25^{2}=625 \\equiv 625-10\\cdot 57=625-570=55 \\pmod{57}.\n$$\n注意到 $-1 \\equiv 56 \\pmod{57}$。$14$，$25$ 和 $55$ 模 $57$ 后都不等于 $56$。因此，对于 $i=0,1,2$，我们有 $2^{2^{i} m} \\not\\equiv -1 \\pmod{57}$。\n\n根据给定的定义，$a=2$ 是 $n=57$ 的合数性的一个强证据。由于 $2$ 是大于 $1$ 的最小允许整数，所以它是最小的强证据。", "answer": "$$\\boxed{2}$$", "id": "1441673"}, {"introduction": "接下来，我们将用米勒-拉宾检验来挑战一类特别具有欺骗性的合数——卡迈克尔数（Carmichael numbers），它们能骗过所有与之互素的基数的费马检验。这个练习 [@problem_id:1441663] 旨在展示，即使对于费马检验的“最坏情况”，米勒-拉宾检验依然能够有效地将其识别为合数。通过处理这个经典反例，你可以深刻体会到米勒-拉宾检验相较于费马检验的巨大优势，并巩固对随机算法能力和错误率控制的理解。", "problem": "在计算数论的研究中，Miller-Rabin检验是一种广泛使用的概率算法，用于判断一个给定的数是否为素数。它改进了像费马素性检验这样更简单的方法，后者可能会被被称为卡迈克尔数的合数所欺骗。\n\n对于一个奇数 $n > 2$，该检验首先需要找到整数 $k$ 和 $d$，使得 $d$ 是奇数且满足 $n-1 = 2^k d$。然后，在范围 $1 < a < n-1$ 内随机选择一个底数 $a$。该检验基于以下模幂运算序列：\n$x_0 = a^d \\pmod{n}$\n$x_1 = (x_0)^2 \\pmod{n} = a^{2d} \\pmod{n}$\n$x_2 = (x_1)^2 \\pmod{n} = a^{4d} \\pmod{n}$\n...\n$x_{k-1} = (x_{k-2})^2 \\pmod{n} = a^{2^{k-1}d} \\pmod{n}$\n\n考虑数字 $n=561$，它是最小的卡迈克尔数。为了了解 Miller-Rabin 检验如何揭示其合数本质，我们可以执行初始步骤。\n\n使用底数 $a=2$，确定 Miller-Rabin 检验序列中的第一项 $x_0$ 的值。", "solution": "对于 Miller-Rabin 检验的设置，将 $n-1$ 写成 $2^{k}d$ 的形式，其中 $d$ 为奇数。对于 $n=561$：\n$$\n561-1=560=2\\cdot 280=2^{2}\\cdot 140=2^{3}\\cdot 70=2^{4}\\cdot 35,\n$$\n所以 $k=4$ 且 $d=35$。对于底数 $a=2$，第一项是\n$$\nx_{0}\\equiv 2^{d}\\equiv 2^{35}\\pmod{561}.\n$$\n使用中国剩余定理计算 $2^{35}\\pmod{561}$。将 $561=3\\cdot 11\\cdot 17$ 分解因式，并对每个因子取模：\n- 模 $3$：$2\\equiv -1\\pmod{3}$，因此 $2^{35}\\equiv (-1)^{35}\\equiv -1\\equiv 2\\pmod{3}$。\n- 模 $11$：根据费马小定理，$2^{10}\\equiv 1\\pmod{11}$，所以 $2^{35}\\equiv 2^{5}\\equiv 32\\equiv 10\\pmod{11}$。\n- 模 $17$：使用 $2^{16}\\equiv 1\\pmod{17}$，我们得到 $2^{35}\\equiv 2^{32}\\cdot 2^{3}\\equiv 1\\cdot 8\\equiv 8\\pmod{17}$。\n\n因此 $x$ 必须满足\n$$\nx\\equiv 2\\pmod{3},\\quad x\\equiv 10\\pmod{11},\\quad x\\equiv 8\\pmod{17}.\n$$\n通过设 $x=10+11t$ 并对 $3$ 取模化简，来合并 $x\\equiv 10\\pmod{11}$ 和 $x\\equiv 2\\pmod{3}$：\n$$\n10+11t\\equiv 1+2t\\equiv 2\\pmod{3}\\;\\Rightarrow\\;2t\\equiv 1\\pmod{3}\\;\\Rightarrow\\;t\\equiv 2\\pmod{3}.\n$$\n设 $t=2+3s$，得到 $x=10+11(2+3s)=32+33s$，即 $x\\equiv 32\\pmod{33}$。现在代入条件 $x\\equiv 8\\pmod{17}$：\n$$\n32+33s\\equiv 8\\pmod{17},\\quad 32\\equiv 15,\\;33\\equiv -1\\pmod{17}\\;\\Rightarrow\\;15-s\\equiv 8\\pmod{17}\\;\\Rightarrow\\;s\\equiv 7\\pmod{17}.\n$$\n取 $s=7$ 可得最小正解\n$$\nx=32+33\\cdot 7=263,\n$$\n即为模 $561$ 所求的余数。因此，\n$$\nx_{0}\\equiv 2^{35}\\equiv 263\\pmod{561}.\n$$", "answer": "$$\\boxed{263}$$", "id": "1441663"}]}