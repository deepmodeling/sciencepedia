{"hands_on_practices": [{"introduction": "让我们从一个基本练习开始，来估计一系列独立随机事件之和的偏差。这个问题将探讨一个随机矩阵中一行元素之和远超其期望值的概率。通过解决这个问题，你将练习使用一个标准的切尔诺夫上界，这是理解和应用尾部不等式的第一步。[@problem_id:1414244]", "problem": "在随机算法和复杂网络的分析中，我们经常使用随机矩阵对系统进行建模。考虑一个 $n \\times n$ 矩阵 $A$，其中对于 $1 \\le i, j \\le n$，每个元素 $A_{ij}$ 是一个独立的随机变量，以概率 $p$ 取值为1，以概率 $1-p$ 取值为0，其中 $0 < p < 1$。\n\n令 $S$ 为该矩阵第一行所有元素之和。我们关心的是这个和显著偏离其期望值的概率。\n\n此问题需要使用特定形式的 Chernoff 界。对于一个随机变量 $X$，它是若干独立伯努利随机变量之和，其期望为 $\\mu = E[X]$，并且对于任意 $\\delta \\in (0, 1]$，以下不等式成立：\n$$P(X \\ge (1+\\delta)\\mu) \\le \\exp\\left(-\\frac{\\delta^2 \\mu}{3}\\right)$$\n使用此不等式，求出和 $S$ 至少是其期望值两倍的概率的一个上界。将你的答案表示为 $n$ 和 $p$ 的函数。", "solution": "令 $S$ 表示第一行中 $n$ 个独立伯努利随机变量的和，每个变量的成功概率为 $p$。那么 $S$ 服从二项分布，其期望为 $\\mu = \\mathbb{E}[S] = np$。\n\n我们寻求 $S$ 至少是其期望值两倍的概率的上界，即 $\\mathbb{P}(S \\ge 2\\mu)$。给定的 Chernoff 界指出，对于任意 $\\delta \\in (0,1]$，\n$$\n\\mathbb{P}(X \\ge (1+\\delta)\\mu) \\le \\exp\\left(-\\frac{\\delta^{2}\\mu}{3}\\right).\n$$\n为了界定 $\\mathbb{P}(S \\ge 2\\mu)$，我们设 $(1+\\delta)\\mu = 2\\mu$，这得出 $\\delta = 1$。这个选择满足 $\\delta \\in (0,1]$。将 $X=S$、$\\mu = np$ 和 $\\delta = 1$ 应用于该界，得到\n$$\n\\mathbb{P}(S \\ge 2np) \\le \\exp\\left(-\\frac{1^{2}\\cdot np}{3}\\right) = \\exp\\left(-\\frac{np}{3}\\right).\n$$\n因此，所求的关于 $n$ 和 $p$ 的函数的上界是 $\\exp\\left(-\\frac{np}{3}\\right)$。", "answer": "$$\\boxed{\\exp\\left(-\\frac{np}{3}\\right)}$$", "id": "1414244"}, {"introduction": "切尔诺夫界不仅能估计事件发生过多（上界）的概率，也能估计事件发生过少（下界）的概率。在这个练习中，我们将分析一个随机算法在多次尝试中未能取得任何成功的可能性。这个问题将帮助你熟练运用切尔诺夫下界，展示了它在评估算法性能和可靠性方面的对称性和实用性。[@problem_id:1414214]", "problem": "一家科技公司正在开发一种新的人工智能（AI）模型，该模型使用一种随机局部搜索算法来设计新颖的蛋白质结构。该算法以离散的步骤运行。在每一步中，它会对当前的蛋白质结构提出一个修改，并评估其预测的稳定性。如果新结构的稳定性高于先前发现的任何结构，则该步骤被认为是“成功”的。工程团队已经确定，对于这个特定的搜索空间，任何给定步骤成功的概率是一个恒定值 $p$，且每一步都相互独立。\n\n该算法被设定为连续运行 $N$ 步。团队担心算法会陷入停滞，完全找不到任何改进。\n\n对于一个代表 $N$ 次独立伯努利试验（每次成功概率为 $p$）成功总数的随机变量 $X$，其期望成功次数为 $\\mu=Np$。为了分析稀有事件，可以使用切尔诺夫界（Chernoff bound）。对于本问题，您需要使用以下形式的下尾界：\n$$P(X \\le (1-\\delta)\\mu) \\le \\exp\\left(-\\frac{\\delta^2 \\mu}{2}\\right) \\quad \\text{for } 0 < \\delta \\le 1$$\n\n给定 $N=600$ 步和成功概率 $p=0.15$，计算算法在整个运行过程中找到零次成功步骤的概率的上限。请用科学记数法表示您的答案，并四舍五入到三位有效数字。", "solution": "设 $X$ 为 $N$ 次独立伯努利试验中成功的次数，每次成功的概率为 $p$。那么 $X \\sim \\text{Binomial}(N,p)$，其均值为 $\\mu = Np$。\n\n我们需要求 $P(X=0)$ 的一个上界。由于 $X$ 是一个非负整数，所以 $P(X=0) = P(X \\le 0)$。使用给定的切尔诺夫下尾界，\n$$\nP(X \\le (1-\\delta)\\mu) \\le \\exp\\left(-\\frac{\\delta^{2}\\mu}{2}\\right) \\quad \\text{for } 0<\\delta \\le 1.\n$$\n为了界定 $P(X \\le 0)$，选择 $\\delta$ 使得 $(1-\\delta)\\mu = 0$，这给出 $\\delta = 1$（这在允许的范围内）。因此，\n$$\nP(X=0) = P(X \\le 0) \\le \\exp\\left(-\\frac{1^{2}\\mu}{2}\\right) = \\exp\\left(-\\frac{\\mu}{2}\\right).\n$$\n当 $N=600$ 且 $p=0.15$ 时，均值为\n$$\n\\mu = Np = 600 \\times 0.15 = 90.\n$$\n因此，\n$$\nP(X=0) \\le \\exp\\left(-\\frac{90}{2}\\right) = \\exp(-45).\n$$\n数值上，$\\exp(-45) \\approx 2.86251858 \\times 10^{-20}$，四舍五入到三位有效数字是\n$$\n2.86 \\times 10^{-20}.\n$$", "answer": "$$\\boxed{2.86 \\times 10^{-20}}$$", "id": "1414214"}, {"introduction": "现在，让我们转向一个更高级的实际应用：分析布隆过滤器（Bloom filter）的性能，这是一种在计算机科学中广泛使用的概率数据结构。这个问题要求你使用一个更通用、更精确的切尔诺夫界来估计哈希冲突的概率。通过这个练习，你将学会如何为更复杂的问题选择和应用更强大的数学工具，从而加深对不同形式切尔诺夫界之间细微差别的理解。[@problem_id:1414267]", "problem": "一个网页缓存系统使用布隆过滤器来快速判断一个统一资源定位符 (URL) 是否最近被访问过，从而避免昂贵的数据库查询。该过滤器由一个大小为 $m = 50000$ 的位数组和 $k = 4$ 个独立且均匀的哈希函数实现。最初，数组中所有的位都为0。然后，用 $n = 5000$ 个不同的 URL 填充缓存。\n\n对于这 $n$ 个 URL 中的每一个，其值被哈希 $k$ 次，并且数组中对应 $k$ 个索引处的位被设置为1。当检查一个新的 URL（一个不在初始 $n$ 个 URL 中）时，我们关心“哈希碰撞”的数量，我们将其定义为其 $k$ 个哈希位置指向已被设置为1的位的数量。\n\n这个新 URL 的碰撞次数 $X$ 可以被建模为 $k$ 次独立伯努利试验的总和。任意单个哈希函数映射到一个已经被置为1的位的概率 $p$（过滤器的“填充率”）可以通过以下公式很好地近似：\n$$p = 1 - \\exp\\left(-\\frac{kn}{m}\\right)$$\n为了分析高负载下的性能，您需要找到一个极端碰撞事件概率的上界。使用以下版本的切诺夫界。对于一个随机变量 $X$，它是期望值为 $\\mu = E[X]$ 的独立伯努利试验之和，其显著高于均值的概率由以下不等式界定：\n$$P(X \\ge (1+\\delta)\\mu) \\le \\left(\\frac{e^{\\delta}}{(1+\\delta)^{1+\\delta}}\\right)^{\\mu} \\quad \\text{对于任何 } \\delta > 0$$\n\n利用这些信息，计算新 URL 的所有4个哈希位置都对应于已被设置为1的位的概率的上界。将您的最终答案四舍五入到三位有效数字。", "solution": "我们将新 URL 的碰撞次数建模为 $X=\\sum_{i=1}^{k}Y_{i}$，其中 $Y_{i}$ 是成功概率为 $p$ 的独立伯努利试验。过滤器的参数为 $m=50000$, $k=4$, $n=5000$。填充率可近似为\n$$\np = 1 - \\exp\\left(-\\frac{kn}{m}\\right) = 1 - \\exp\\left(-\\frac{4\\cdot 5000}{50000}\\right) = 1 - \\exp(-0.4).\n$$\n期望的碰撞次数为\n$$\n\\mu = E[X] = k p = 4p.\n$$\n我们关心的是所有4个哈希位置都已被设置的事件，即 $X=4$。使用上尾的切诺夫界，将 $(1+\\delta)\\mu$ 设置为阈值4，我们求解\n$$\n(1+\\delta)\\mu = 4 \\quad \\Longrightarrow \\quad (1+\\delta)\\cdot 4p = 4 \\quad \\Longrightarrow \\quad 1+\\delta = \\frac{1}{p} \\quad \\Longrightarrow \\quad \\delta = \\frac{1-p}{p}.\n$$\n将这个 $\\delta$ 和 $\\mu$ 代入界中\n$$\nP\\big(X \\ge (1+\\delta)\\mu\\big) \\le \\left(\\frac{\\exp(\\delta)}{(1+\\delta)^{1+\\delta}}\\right)^{\\mu},\n$$\n我们得到\n$$\nP(X \\ge 4) \\le \\left(\\frac{\\exp\\!\\left(\\frac{1-p}{p}\\right)}{\\left(\\frac{1}{p}\\right)^{\\frac{1}{p}}}\\right)^{4p}\n= \\left(\\exp\\!\\left(\\frac{1-p}{p}\\right)p^{\\frac{1}{p}}\\right)^{4p}\n= \\exp\\!\\big(4(1-p)\\big)\\,p^{4}.\n$$\n因此，所有4个位置都已经是1的概率的一个明确的切诺夫上界是\n$$\n\\exp\\!\\big(4(1-p)\\big)\\,p^{4} \\quad \\text{其中} \\quad p=1-\\exp(-0.4).\n$$\n现在进行数值计算：\n$$\np = 1 - \\exp(-0.4) \\approx 0.329679953964361,\n$$\n$$\np^{4} \\approx 0.0118132709059,\\quad \\exp\\!\\big(4(1-p)\\big) = \\exp\\!\\big(4\\exp(-0.4)\\big) \\approx \\exp(2.681280184142556) \\approx 14.6037664347,\n$$\n所以\n$$\nP(X=4) \\le \\exp\\!\\big(4(1-p)\\big)\\,p^{4} \\approx 14.6037664347 \\times 0.0118132709059 \\approx 0.172518.\n$$\n四舍五入到三位有效数字得到 $0.173$。", "answer": "$$\\boxed{0.173}$$", "id": "1414267"}]}