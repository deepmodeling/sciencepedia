{"hands_on_practices": [{"introduction": "Valiant-Vazirani 引理的核心思想是通过引入随机性来简化问题，其目标是将一个拥有多个解的问题转化为一个拥有唯一解的问题。然而，这个过程并非总是成功的。这个引导性练习旨在帮助你建立对该过程基本逻辑的直观理解，通过分析当“隔离”失败时可能出现的各种结果，让你明确该随机化过程的成功与失败的定义。[@problem_id:1465691]", "problem": "一位计算机科学家正在研究一个用于布尔可满足性（SAT）问题的随机算法。该算法使用一种受 Valiant-Vazirani 定理启发的技巧来简化 SAT 实例。该过程如下：\n\n1.  从一个关于 $n$ 个变量的布尔公式 $\\phi$ 开始，已知该公式是可满足的（即，它至少有一个满足赋值）。\n2.  在二元域 $\\mathbb{F}_2$ 上生成一组随机线性方程。\n3.  通过将原始公式 $\\phi$ 与新的线性方程组进行逻辑与（AND）运算，创建一个新的、约束更强的公式 $\\phi'$。\n\n此过程的预期目标是“分离”出单个满足赋值，这意味着新公式 $\\phi'$ 应该恰好只有一个解。如果对于某次运行，$\\phi'$ 恰好有一个满足赋值，则该过程被认为是“成功”的。反之，如果 $\\phi'$ 没有恰好一个满足赋值，则该过程被认为是“失败”的。\n\n设 $N$ 是新公式 $\\phi'$ 的满足赋值的数量。如果对一个可满足公式 $\\phi$ 的某次运行导致了失败，那么以下哪个陈述正确且完整地描述了 $N$ 的所有可能值？\n\nA. $N = 0$\n\nB. $N > 1$\n\nC. $N = 0$ 或 $N = 1$\n\nD. $N = 0$ 或 $N > 1$\n\nE. $N \\ge 0$", "solution": "设 $\\phi$ 在 $n$ 个变量上是可满足的，并设 $S$ 表示 $\\phi$ 的满足赋值集合，因此 $|S| \\ge 1$。设 $\\mathcal{L}$ 是在 $\\mathbb{F}_{2}$ 上添加的随机线性方程组，并定义 $\\phi' = \\phi \\land \\mathcal{L}$。设 $S'$ 表示 $\\phi'$ 的满足赋值集合，且 $N = |S'|$。\n\n根据构造，任何满足 $\\phi'$ 的赋值也满足 $\\phi$，因此 $S' \\subseteq S$。所以，\n$$\n0 \\le N = |S'| \\le |S|.\n$$\n根据定义，当 $\\phi'$ 有唯一的满足赋值时，即当 $N = 1$ 时，该过程恰好成功。当 $N \\ne 1$ 时，恰好发生失败。由于 $N$ 是一个非负整数，其上界为 $|S|$，所以在失败情况下的唯一可能性是\n$$\nN = 0 \\quad \\text{或者} \\quad N > 1.\n$$\n这两种情况都是可能达到的：添加的线性方程可以过度约束系统，使得没有赋值能同时满足 $\\phi$ 和 $\\mathcal{L}$，从而得到 $N = 0$；或者它们可以在不分离出单个赋值的情况下进行限制，从而得到 $N > 1$。\n\n因此，在失败情况下，对 $N$ 的所有可能值的完整且正确的描述是 $N = 0$ 或 $N > 1$，这对应于选项D。", "answer": "$$\\boxed{D}$$", "id": "1465691"}, {"introduction": "理解了 Valiant-Vazirani 过程的目标后，我们来深入探究其核心机制：随机线性约束。每个随机约束都有一定的概率区分开两个不同的解。这个练习将引导你计算一个关键概率：单个随机线性约束未能区分开两个给定解的概率。这个计算是在一个通用的有限域 $\\mathbb{F}_p$ 上进行的，其结果是理解整个隔离引理有效性的基石。[@problem_id:1465648]", "problem": "在理论计算机科学领域，处理具有多个解的问题时，一种常用技术是添加随机约束来“分离”出单个解。这是著名的Valiant-Vazirani定理背后的核心思想。\n\n考虑一个计算搜索问题，其解是有限域上$n$维空间中的向量。具体来说，解集$S$是$\\mathbb{F}_p^n$的一个子集，其中$\\mathbb{F}_p$是具有$p$个元素的有限域（$p$为某个素数），$n$是代表变量数量的正整数。\n\n为了分离一个解，我们为该问题增加了$m$个随机线性约束。每个约束$k \\in \\{1, 2, \\dots, m\\}$的形式为$a_k \\cdot x = b_k$，其中向量$a_k \\in \\mathbb{F}_p^n$和标量$b_k \\in \\mathbb{F}_p$是独立且均匀随机选择的。表达式$a_k \\cdot x$表示标准点积$\\sum_{i=1}^n (a_k)_i x_i$，所有算术运算都在$\\mathbb{F}_p$中进行。如果一个解$x \\in S$满足所有约束，则称该解“通过”(survived)了这组约束。\n\n假设原问题至少有两个解。设$x_A$和$x_B$是来自集合$S$的两个不同的、固定的解。我们已知$x_A$和$x_B$都通过了前$m-1$个随机约束。\n\n那么，$x_A$和$x_B$也都通过第$m$个随机约束的概率是多少？\n\n您的答案应该是一个关于$p$、$n$和$m$（如适用）的闭式解析表达式。", "solution": "设 $x_{A},x_{B} \\in \\mathbb{F}_{p}^{n}$ 是两个不同的、已满足前 $m-1$ 个随机线性约束的固定解。第 $m$ 个约束是通过独立且均匀随机地选择 $a_{m} \\in \\mathbb{F}_{p}^{n}$ 和 $b_{m} \\in \\mathbb{F}_{p}$ 生成的，且与其他所有选择无关。\n\n我们要求的是在$x_{A}$和$x_{B}$都通过了前$m-1$个约束的条件下，它们也都满足第$m$个约束的条件概率。根据约束的独立性，第$m$个约束与前面的约束无关，因此该条件概率等于无条件概率\n$$\n\\Pr\\big[(a_{m}\\cdot x_{A}=b_{m}) \\wedge (a_{m}\\cdot x_{B}=b_{m})\\big].\n$$\n\n设 $v=x_{A}-x_{B}\\neq 0$。$x_{A}$ 和 $x_{B}$ 同时满足同一个约束的事件等价于以下方程组\n$$\na_{m}\\cdot x_{A}=b_{m},\\qquad a_{m}\\cdot x_{B}=b_{m},\n$$\n该方程组等价于\n$$\na_{m}\\cdot v=0 \\quad \\text{and} \\quad b_{m}=a_{m}\\cdot x_{A}.\n$$\n考虑由 $L_{v}(a)=a\\cdot v$ 给出的线性泛函 $L_{v}:\\mathbb{F}_{p}^{n}\\to\\mathbb{F}_{p}$。由于 $v\\neq 0$，$L_{v}$ 是一个非零线性泛函，因此是满射的；对于均匀随机的 $a_{m}$，随机变量 $a_{m}\\cdot v$ 在 $\\mathbb{F}_{p}$ 上均匀分布。因此，\n$$\n\\Pr[a_{m}\\cdot v=0]=\\frac{1}{p}.\n$$\n给定任意固定的 $a_{m}$，标量 $b_{m}$ 是从 $\\mathbb{F}_{p}$ 中独立且均匀地选择的，所以\n$$\n\\Pr[b_{m}=a_{m}\\cdot x_{A}\\mid a_{m}]=\\frac{1}{p}.\n$$\n结合这些独立条件，\n$$\n\\Pr\\big[(a_{m}\\cdot x_{A}=b_{m}) \\wedge (a_{m}\\cdot x_{B}=b_{m})\\big]\n=\\Pr[a_{m}\\cdot v=0]\\cdot \\Pr[b_{m}=a_{m}\\cdot x_{A}\\mid a_{m}]\n=\\frac{1}{p}\\cdot \\frac{1}{p}\n=\\frac{1}{p^{2}}.\n$$\n因此，在$x_{A}$和$x_{B}$都通过了前$m-1$个约束的条件下，它们都通过第$m$个约束的概率是 $\\frac{1}{p^{2}}$。", "answer": "$$\\boxed{\\frac{1}{p^{2}}}$$", "id": "1465648"}, {"introduction": "我们已经分析了单个随机约束的行为，现在是时候将所有部分组合起来了。当我们将多个独立的随机约束（或哈希函数）应用于一个解集时，我们如何计算成功隔离出唯一解的总概率？这个综合性练习将引导你完成这一计算。你将运用二项分布的知识，在一个简化的、假设解线性无关的场景下，精确计算出 Valiant-Vazirani 过程的成功概率。[@problem_id:61665]", "problem": "在计算复杂性理论中，Valiant-Vazirani 定理提供了一个从 NP 完全问题到相关问题的随机化归约，该相关问题有很大概率具有唯一解。这种“解的隔离”是一个强大的工具。我们来分析这项技术的核心。\n\n考虑一个关于 $n$ 个布尔变量 $x_1, \\dots, x_n$ 的 3-可满足性 (3-SAT) 实例 $\\phi$。一个可满足赋值是一个向量 $s \\in \\{0,1\\}^n$，它使得公式 $\\phi$ 为真。设 $S \\subset \\{0,1\\}^n$ 是 $\\phi$ 的所有可满足赋值的集合。\n\nValiant-Vazirani 哈希过程旨在从 $S$ 中隔离出单个解。该过程如下：\n1.  从 $\\{0,1\\}^n$ 中独立且均匀随机地选择 $m$ 个向量 $v_1, v_2, \\dots, v_m$。\n2.  对变量向量 $x \\in \\{0,1\\}^n$ 构造一组新的约束：\n    $$C = \\{v_i \\cdot x = 0 \\pmod 2 \\mid i=1, \\dots, m\\}$$\n    其中 $v_i \\cdot x = \\sum_{j=1}^n (v_i)_j x_j$ 是在有限域 $\\mathbb{F}_2$ 上的点积。\n3.  新的解集是 $S' = \\{s \\in S \\mid s \\text{ 满足 } C \\text{ 中的所有约束}\\}$。\n4.  如果新的解集 $S'$ 只包含一个元素，即 $|S'| = 1$，则该过程被视为一次“成功”。\n\n假设我们有一个 3-SAT 实例，其可满足赋值集合 $S$ 的大小为 $|S| = K$。此外，假设集合 $S$ 具有以下性质：\n- $S$ 中的所有向量都是非零向量。\n- $S$ 中的 $K$ 个向量在域 $\\mathbb{F}_2$ 上线性无关。\n\n给定 $K=5$ 和 $m=3$，计算成功的确切概率。", "solution": "设 $K$ 个可满足赋值的集合为 $S = \\{s_1, s_2, \\dots, s_K\\}$，其中每个 $s_j \\in \\{0,1\\}^n \\setminus \\{\\mathbf{0}\\}$。我们已知这 $K$ 个向量在 $\\mathbb{F}_2$ 上线性无关。\n\n该过程从 $\\{0,1\\}^n$ 中均匀且独立地选择 $m$ 个向量 $v_1, \\dots, v_m$。一个解 $s_j \\in S$ 能保留下来，如果它被包含在新的解集 $S'$ 中，这意味着它必须满足所有新约束：\n$$v_i \\cdot s_j = 0 \\pmod 2 \\quad \\text{for all } i \\in \\{1, \\dots, m\\}.$$\n\n我们为每个解 $s_j$ 定义一个“哈希值”，即这 $m$ 个点积结果组成的向量：\n$$h(s_j) = (v_1 \\cdot s_j, v_2 \\cdot s_j, \\dots, v_m \\cdot s_j) \\in \\{0,1\\}^m.$$\n一个解 $s_j$ 属于 $S'$ 当且仅当其哈希值为零向量，即 $h(s_j) = \\mathbf{0} \\in \\{0,1\\}^m$。如果恰好有一个 $s_j \\in S$ 使得 $h(s_j) = \\mathbf{0}$，则该过程是成功的。\n\n我们来确定哈希向量 $h(s_1), \\dots, h(s_K)$ 的概率分布。\n考虑单个哈希函数向量 $v_i$。我们来分析随机变量 $(v_i \\cdot s_1, v_i \\cdot s_2, \\dots, v_i \\cdot s_K)$ 的联合分布。这是一个在 $\\{0,1\\}^K$ 中的向量。\n我们已知向量 $s_1, \\dots, s_K$ 在 $\\mathbb{F}_2$ 上线性无关。考虑由 $L(v) = (v \\cdot s_1, v \\cdot s_2, \\dots, v \\cdot s_K)$ 定义的线性映射 $L: \\{0,1\\}^n \\to \\{0,1\\}^K$。由于向量 $s_1, \\dots, s_K$ 是线性无关的，线性形式 $v \\mapsto v \\cdot s_j$ 也是线性无关的。这意味着映射 $L$ 是满射。\n由于 $v_i$ 是从 $\\{0,1\\}^n$ 中均匀随机选择的，输出向量 $L(v_i)$ 在 $\\{0,1\\}^K$ 上均匀分布。也就是说，对于任何向量 $y \\in \\{0,1\\}^K$，概率 $P(L(v_i) = y) = 1/2^K$。\n\n哈希向量是 $h(s_j)$，它们是 $m \\times K$ 矩阵 $M$ 的列，其中 $M_{ij} = v_i \\cdot s_j$。该矩阵的行是向量 $L(v_i)$。由于 $v_i$ 是独立选择的，所以 $M$ 的行是在 $\\{0,1\\}^K$ 中独立同分布的均匀随机向量。\n这意味着任何特定矩阵 $M$ 出现的概率为 $(1/2^K)^m = 1/2^{mK}$。\n\n我们感兴趣的是 $M$ 的列的分布，也就是哈希向量 $h(s_j)$ 的分布。我们来证明它们在 $\\{0,1\\}^m$ 中是独立且均匀分布的。\n哈希向量取特定值 $c_1, \\dots, c_K \\in \\{0,1\\}^m$ 的联合概率为：\n$$P(h(s_1)=c_1, \\dots, h(s_K)=c_K) = P(\\text{Matrix } M \\text{ has columns } c_1, \\dots, c_K).$$\n这定义了一个特定的矩阵 $M$，因此概率为 $1/2^{mK}$。\n\n现在我们来求单个哈希向量的边际概率，比如 $h(s_j)$：\n$$P(h(s_j) = c_j) = \\sum_{c_k \\in \\{0,1\\}^m, k \\neq j} P(h(s_1)=c_1, \\dots, h(s_K)=c_K).$$\n对于其他 $K-1$ 列，有 $(2^m)^{K-1}$ 种选择。所以，\n$$P(h(s_j) = c_j) = (2^m)^{K-1} \\cdot \\frac{1}{2^{mK}} = \\frac{2^{m(K-1)}}{2^{mK}} = \\frac{1}{2^m}.$$\n这证实了每个哈希向量 $h(s_j)$ 在 $\\{0,1\\}^m$ 中是均匀分布的。\n\n为了验证独立性，我们检查联合概率是否等于边际概率的乘积：\n$$P(h(s_1)=c_1) \\cdots P(h(s_K)=c_K) = \\left(\\frac{1}{2^m}\\right)^K = \\frac{1}{2^{mK}}.$$\n这与联合概率 $P(h(s_1)=c_1, \\dots, h(s_K)=c_K)$ 相符，因此哈希向量 $h(s_1), \\dots, h(s_K)$是独立的。\n\n现在问题简化为：我们有 $K$ 个独立的随机向量，每个向量都在 $\\{0,1\\}^m$ 中均匀分布。恰好其中一个向量是零向量的概率是多少？\n\n设 $E_j$ 为事件 $h(s_j) = \\mathbf{0}$。该事件的概率是：\n$$p = P(E_j) = P(h(s_j) = \\mathbf{0}) = \\frac{1}{2^m}.$$\n成功的事件是指独立事件 $E_1, \\dots, E_K$ 中恰好有一个发生。这是一个经典的二项概率问题。试验次数为 $K$，每次试验“成功”的概率为 $p$。恰好一次成功的概率由二项式公式给出：\n$$P(\\text{success}) = \\binom{K}{1} p^1 (1-p)^{K-1} = K p (1-p)^{K-1}.$$\n\n我们给定的参数是 $K=5$ 和 $m=3$。首先，我们计算 $p$：\n$$p = \\frac{1}{2^3} = \\frac{1}{8}.$$\n然后，单次试验失败的概率是：\n$$1-p = 1 - \\frac{1}{8} = \\frac{7}{8}.$$\n现在，我们将这些值代入二项概率公式：\n$$P(\\text{success}) = 5 \\cdot \\left(\\frac{1}{8}\\right) \\cdot \\left(\\frac{7}{8}\\right)^{5-1} = 5 \\cdot \\frac{1}{8} \\cdot \\left(\\frac{7}{8}\\right)^4.$$\n$$P(\\text{success}) = \\frac{5}{8} \\cdot \\frac{7^4}{8^4} = \\frac{5 \\cdot 2401}{8^5} = \\frac{12005}{32768}.$$\n因此，隔离出单个解的确切概率是 $\\frac{12005}{32768}$。", "answer": "$$ \\boxed{\\frac{12005}{32768}} $$", "id": "61665"}]}