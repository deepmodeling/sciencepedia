{"hands_on_practices": [{"introduction": "置信度传播（Belief Propagation）解码的第一步，是将来自信道的原始观测值转化为一种概率度量。对数似然比（Log-Likelihood Ratio, LLR），即 $L(c) = \\ln(P(c=0|\\text{observation})/P(c=1|\\text{observation}))$，正是为此而生的关键工具，它量化了每个接收比特为 '0' 或 '1' 的相对可信度。这个练习将指导你完成这一基础计算，为后续的消息传递迭代奠定基础 [@problem_id:1603925]。", "problem": "一种简单的纠错方案是 (3,1) 重复码，其中单个数据位通过将自身重复三次来编码成一个三位的码字。为了传输数据位 '0'，发送码字 '000'；为了传输数据位 '1'，发送码字 '111'。\n\n这些码字位通过一个有噪的二元对称信道 (BSC) 顺序传输。BSC 是一种信道模型，其中每个传输的比特有概率 $p$ 翻转成相反的值（'0' 变为 '1' 或 '1' 变为 '0'），并有概率 $1-p$ 被正确传输。对于这个特定的通信系统，交叉概率为 $p = 0.1$。\n\n假设正在传输一个码字，并且观测到接收到的三个比特中的第一个是 '1'。\n\n现代译码算法，如置信度传播算法，会为每个接收到的比特计算一个初始可靠性值。这个值代表了信道证据，其定义为两个条件概率之比的自然对数：即在原始数据位为 '0' 的条件下，在该比特位置接收到 '1' 的概率，除以在原始数据位为 '1' 的条件下，在该比特位置接收到 '1' 的概率。\n\n根据接收到的第一个比特计算这个可靠性值。将你的最终答案四舍五入到四位有效数字。", "solution": "在一个交叉概率为 $p$ 的二元对称信道上，对于单个传输比特的条件概率是：\n$$P(\\text{receive }1 \\mid \\text{transmit }0) = p, \\quad P(\\text{receive }1 \\mid \\text{transmit }1) = 1-p.$$\n在 (3,1) 重复码中，每个传输的比特都等于原始数据位，所以对于接收到的一个 '1'，其信道证据（对数似然比）定义为\n$$L = \\ln\\!\\left(\\frac{P(\\text{receive }1 \\mid \\text{data }0)}{P(\\text{receive }1 \\mid \\text{data }1)}\\right) = \\ln\\!\\left(\\frac{p}{1-p}\\right).$$\n当 $p=0.1$ 时，此式变为\n$$L = \\ln\\!\\left(\\frac{0.1}{0.9}\\right) = \\ln\\!\\left(\\frac{1}{9}\\right) = -\\ln(9) \\approx -2.197224576.$$\n四舍五入到四位有效数字得到 $-2.197$。", "answer": "$$\\boxed{-2.197}$$", "id": "1603925"}, {"introduction": "在获得了初始的信道 LLR 之后，置信度传播算法的核心——消息传递——便开始了。这个练习聚焦于 BP 算法的心脏地带：在一个简单的因子图上，计算一个校验节点传递给一个变量节点的消息 [@problem_id:1603932]。通过这个练习，你将亲身体会到图上的约束条件（例如奇偶校验 $c_1 \\oplus c_2 = 0$）是如何被用来提炼和更新我们对比特值的信念的。", "problem": "在数字通信领域，置信度传播是一种功能强大的消息传递算法，用于解码纠错码。考虑一个简单的线性分组码，它由一个因子图定义，该图包含三个表示码字比特 $(c_1, c_2, c_3)$ 的变量节点和两个校验节点 $f_A$ 和 $f_B$。校验节点 $f_A$ 连接到 $c_1$ 和 $c_2$，并强制执行奇偶校验约束 $c_1 \\oplus c_2 = 0$（其中 $\\oplus$ 表示模2加法）。校验节点 $f_B$ 连接到 $c_2$ 和 $c_3$，并强制执行 $c_2 \\oplus c_3 = 0$。这种配置等效于一个 [3,1] 重复码。\n\n来自此码的一个码字通过噪声信道传输。在接收端，关于已传输比特的初始置信度由信道对数似然比 (LLR) 捕获。比特 $c$ 的 LLR 定义为 $L(c) = \\ln \\frac{P(c=0 | \\text{observation})}{P(c=1 | \\text{observation})}$。测得的三个比特的信道 LLR 如下：\n$L_{ch}(c_1) = +0.5$\n$L_{ch}(c_2) = -1.2$\n$L_{ch}(c_3) = -0.8$\n\n你的任务是，在基于 LLR 的置信度传播算法的第一次迭代中，计算从校验节点 $f_A$ 发送到变量节点 $c_1$ 的第一条消息。在此算法中，一条消息也是一个 LLR 值。\n\n将你的答案表示为一个实数，保留三位有效数字。", "solution": "我们在 LLR 域中进行计算。在第一次迭代中，变量到校验节点的消息由信道 LLR 初始化，因此对于任何变量节点 $c_{i}$ 和相邻的校验节点 $f$：\n$$\nL_{c_{i} \\to f}^{(1)} = L_{ch}(c_{i}).\n$$\n对于一个强制执行 $c_{1} \\oplus c_{2} = 0$ 的奇偶校验节点 $f$，从 $f$ 到 $c_{1}$ 的 LLR 消息由标准校验节点更新规则给出\n$$\nL_{f \\to c_{1}}^{(1)} = 2 \\text{arctanh}\\!\\left(\\prod_{v \\in \\mathcal{N}(f)\\setminus c_{1}} \\tanh\\!\\left(\\frac{L_{v \\to f}^{(1)}}{2}\\right)\\right).\n$$\n对于邻居为 $\\{c_{1}, c_{2}\\}$ 的节点 $f_{A}$，该规则简化为\n$$\nL_{f_{A} \\to c_{1}}^{(1)} = 2 \\text{arctanh}\\!\\left(\\tanh\\!\\left(\\frac{L_{c_{2} \\to f_{A}}^{(1)}}{2}\\right)\\right).\n$$\n使用对所有实数 $x$ 均成立的恒等式 $\\text{arctanh}(\\tanh(x)) = x$，我们得到\n$$\nL_{f_{A} \\to c_{1}}^{(1)} = L_{c_{2} \\to f_{A}}^{(1)}.\n$$\n在第一次迭代中，$L_{c_{2} \\to f_{A}}^{(1)} = L_{ch}(c_{2}) = -1.2$。因此，\n$$\nL_{f_{A} \\to c_{1}}^{(1)} = -1.2.\n$$\n保留三位有效数字，所需的消息为 $-1.20$。", "answer": "$$\\boxed{-1.20}$$", "id": "1603932"}, {"introduction": "解码过程的最终目标是输出一个有效的码字，但当置信度传播算法迭代结束仍未满足所有校验时，我们该怎么办？BP 解码器的一大优势在于它提供的是“软”输出（最终的后验 LLR），而不仅仅是“硬”判决（0 或 1）。这个练习将展示这些软信息的实用价值：当解码失败时，如何利用最终 LLR 的大小来定位最可能出错的比特位，这在错误分析和辅助解码策略中至关重要 [@problem_id:1603921]。", "problem": "一个线性分组码由二元域 $\\mathbb{F}_2$ 上的以下校验矩阵 $H$ 定义：\n$$\nH = \\begin{pmatrix}\n1 & 0 & 1 & 1 & 0 & 0 \\\\\n0 & 1 & 1 & 0 & 1 & 0 \\\\\n1 & 1 & 0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\n该码的一个码字通过噪声信道传输。一个置信传播（BP）解码器被用来恢复传输的码字。经过一定次数的迭代后，解码器为六个编码比特 $(c_1, c_2, c_3, c_4, c_5, c_6)$ 输出一个最终的后验对数似然比（LLR）向量。比特 $c_i$ 的 LLR 定义为 $L(c_i) = \\ln(P(c_i=0|\\text{observation})/P(c_i=1|\\text{observation}))$。\n\n最终的后验 LLR 向量是：\n$$\n\\mathbf{L}_{\\text{post}} = [4.1, -0.3, 0.7, -2.5, -0.5, 1.8]\n$$\n对每个比特进行硬判决，其中正的 LLR 映射为比特值 0，负的 LLR 映射为比特值 1。得到的硬判决向量不是由 $H$ 定义的码的有效码字。\n\n你的任务是找出这个硬判决向量中最可能出错的比特位置。请提供三个最可能的错误位置列表，用它们的比特索引（从 1 到 6）来标识。该列表应按从最可能到第三最可能的错误位置排序。", "solution": "我们已知校验矩阵 $H$ 和最终的后验 LLR $\\mathbf{L}_{\\text{post}} = [4.1, -0.3, 0.7, -2.5, -0.5, 1.8]$。硬判决将 $L(c_{i})>0$ 映射为 $\\hat{c}_{i}=0$，将 $L(c_{i})<0$ 映射为 $\\hat{c}_{i}=1$。将此规则应用于每个分量，得到\n$$\n\\hat{\\mathbf{c}} = [0,\\,1,\\,0,\\,1,\\,1,\\,0].\n$$\n为了验证 $\\hat{\\mathbf{c}}$ 不是一个有效码字，计算在 $\\mathbb{F}_{2}$ 上的伴随式 $\\mathbf{s}=H\\hat{\\mathbf{c}}^{T}$。使用 $H$ 的行：\n- 第一个校验：$c_{1}+c_{3}+c_{4}=0+0+1=1$。\n- 第二个校验：$c_{2}+c_{3}+c_{5}=1+0+1=0$。\n- 第三个校验：$c_{1}+c_{2}+c_{6}=0+1+0=1$。\n因此\n$$\n\\mathbf{s}=\\begin{pmatrix}1\\\\0\\\\1\\end{pmatrix}\\neq\\mathbf{0},\n$$\n所以 $\\hat{\\mathbf{c}}$ 不是一个有效码字。\n\n比特 $i$ 的后验 LLR 是 $L_{i}=\\ln\\!\\big(P(c_{i}=0|\\text{observation})/P(c_{i}=1|\\text{observation})\\big)$。给定硬判决 $\\hat{c}_{i}$，该硬判决错误的后验概率等于\n$$\np_{e,i}=\\begin{cases}\n\\displaystyle \\frac{1}{1+\\exp(L_{i})},  L_{i}>0, \\\\[1ex]\n\\displaystyle \\frac{1}{1+\\exp(-L_{i})},  L_{i}0,\n\\end{cases}\n$$\n它可以紧凑地写成\n$$\np_{e,i}=\\frac{1}{1+\\exp(|L_{i}|)}.\n$$\n因此，$p_{e,i}$ 是 $|L_{i}|$ 的一个严格递减函数。因此，三个最可能的错误位置是 $|L_{i}|$ 最小的三个索引。\n\n计算绝对值：\n$$\n|L_{1}|=4.1,\\quad |L_{2}|=0.3,\\quad |L_{3}|=0.7,\\quad |L_{4}|=2.5,\\quad |L_{5}|=0.5,\\quad |L_{6}|=1.8.\n$$\n将这些值从小到大排序，得到绝对值最小的三个索引是 $2$ $(0.3)$、$5$ $(0.5)$ 和 $3$ $(0.7)$。因此，从最可能到第三最可能的三个错误位置是比特 $2$、$5$ 和 $3$。", "answer": "$$\\boxed{\\begin{pmatrix}2  5  3\\end{pmatrix}}$$", "id": "1603921"}]}