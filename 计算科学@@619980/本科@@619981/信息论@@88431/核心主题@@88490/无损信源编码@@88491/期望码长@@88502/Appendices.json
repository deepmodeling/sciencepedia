{"hands_on_practices": [{"introduction": "本练习将指导你应用霍夫曼编码算法这一基本工具，为给定的信源概率分布构建最优前缀码。通过解决这个问题 [@problem_id:1623278]，你将亲身实践如何从头开始构建一个最优码并计算其期望长度，这是数据压缩领域的一项核心技能。", "problem": "一个深空探测器被设计用于监测和分类五种不同类型的宇宙射线事件，分别标记为 A、B、C、D 和 E。该探测器自主运行，并且由于其发射器的功率限制，必须使用尽可能高效的方案，将每个检测到的事件的分类编码成一个二进制数字（比特）序列。根据大量的先前观测，在一个标准观测窗口内检测到每种事件类型的长期概率已经被确定。事件 A 和 B 发生的概率各为 $1/3$。事件 C、D 和 E 发生的概率各为 $1/9$。\n\n假设目标是最小化每个事件传输的平均比特数，那么这个可能的最小平均长度是多少？请将您的答案表示为一个分数。", "solution": "我们将该问题建模为构建一个二进制前缀码以最小化期望码长。设符号概率为 $p_{A}=p_{B}=\\frac{1}{3}$ 和 $p_{C}=p_{D}=p_{E}=\\frac{1}{9}$。为了在二进制前缀码中达到最优性，我们应用霍夫曼编码。\n\n使用最小概率进行霍夫曼合并的步骤如下：\n1. 合并两个概率为 $\\frac{1}{9}$ 的符号，形成一个权重为 $\\frac{2}{9}$ 的节点。这使得这两个符号的码长增加 $1$。\n2. 将权重为 $\\frac{2}{9}$ 的节点与剩下的那个概率为 $\\frac{1}{9}$ 的符号合并，形成一个权重为 $\\frac{3}{9}=\\frac{1}{3}$ 的节点。这使得这三个概率为 $\\frac{1}{9}$ 的符号的码长各增加 $1$（到目前为止累积：前两个增加了 $2$，最后一个增加了 $1$）。\n3. 现在权重的多重集是 $\\left\\{\\frac{1}{3},\\frac{1}{3},\\frac{1}{3}\\right\\}$。合并任意两个权重为 $\\frac{1}{3}$ 的项，得到一个权重为 $\\frac{2}{3}$ 的节点。这使得这两个符号的码长增加 $1$。\n4. 将权重为 $\\frac{2}{3}$ 的节点与剩下的那个权重为 $\\frac{1}{3}$ 的节点合并，形成根节点。这使得这些节点下的所有符号的码长都增加 $1$。\n\n追踪深度（码长）：\n- 符号 $A$ 和 $B$（概率均为 $\\frac{1}{3}$）在第3步中一起合并，然后在第4步中与另一个权重为 $\\frac{1}{3}$ 的节点合并，所以 $l_{A}=l_{B}=2$。\n- 在 $\\{C,D,E\\}$ 中没有参与第一次合并的那个符号（我们称之为 $E$），在第2步和第4步中被合并，所以 $l_{E}=2$。\n- 最先被合并的两个符号（我们称之为 $C$ 和 $D$），在第1、2、4步中被合并，所以 $l_{C}=l_{D}=3$。\n\n因此，期望码长为\n$$\nL=\\frac{1}{3}\\cdot l_{A}+\\frac{1}{3}\\cdot l_{B}+\\frac{1}{9}\\cdot l_{C}+\\frac{1}{9}\\cdot l_{D}+\\frac{1}{9}\\cdot l_{E}\n= \\frac{1}{3}\\cdot 2+\\frac{1}{3}\\cdot 2+\\frac{1}{9}\\cdot 3+\\frac{1}{9}\\cdot 3+\\frac{1}{9}\\cdot 2.\n$$\n计算：\n$$\nL=\\frac{2}{3}+\\frac{2}{3}+\\frac{3}{9}+\\frac{3}{9}+\\frac{2}{9}=\\frac{4}{3}+\\frac{8}{9}=\\frac{12}{9}+\\frac{8}{9}=\\frac{20}{9}.\n$$\n根据霍夫曼编码的最优性，这就是每个事件的最小可能平均比特数。作为一致性检验，以比特为单位的信源熵为\n$$\nH=-2\\cdot \\frac{1}{3}\\log_{2}\\!\\left(\\frac{1}{3}\\right)-3\\cdot \\frac{1}{9}\\log_{2}\\!\\left(\\frac{1}{9}\\right)=\\frac{4}{3}\\log_{2}(3),\n$$\n并且确实有 $H \\leq \\frac{20}{9}$，这与编码界限一致。", "answer": "$$\\boxed{\\frac{20}{9}}$$", "id": "1623278"}, {"introduction": "在掌握了基本的最优码构建方法后，我们来探讨一个更深层次的问题：最优编码是唯一的吗？本练习 [@problem_id:1623280] 使用了与前一个练习相同的信源概率分布，揭示了可能存在多种不同的霍夫曼码，它们都能达到相同的最小期望长度。通过比较这些最优码的码长方差，你将学会根据其他实际性能指标（如数据流的稳定性）来评估和选择编码方案。", "problem": "一个离散无记忆信源从字母表 $\\mathcal{S} = \\{S_1, S_2, S_3, S_4, S_5\\}$ 中发出符号。这些符号的概率由下式给出：\n$P(S_1) = 1/3$\n$P(S_2) = 1/3$\n$P(S_3) = 1/9$\n$P(S_4) = 1/9$\n$P(S_5) = 1/9$\n\n对于此特定概率分布，使用Huffman算法可以构造出不止一种最优前缀码，这些码的区别在于其码长集合不同。\n\n构造两种这样的不同Huffman码。对于每种码，计算其码长的方差。码长 $l$ 的方差 $\\sigma^2$ 定义为 $\\sigma^2 = E[l^2] - (E[l])^2$，其中 $E[\\cdot]$ 表示关于信源概率的期望。\n\n计算出的两个方差之间的绝对差值是多少？将你的最终答案表示为四舍五入到四位有效数字的小数。", "solution": "按非递减顺序排列信源概率：三个符号的概率为 $1/9$，两个符号的概率为 $1/3$。应用二元Huffman算法。在某次合并中，概率相等的情况允许有不同的选择，从而导致具有不同码长集合的两种不同的最优树。\n\n构造码 A（在第三步将两个概率为 $1/3$ 的符号合并）：\n- 合并三个 $1/9$ 中的两个，得到 $2/9$。\n- 合并 $1/9$ 和 $2/9$，得到 $1/3$。\n- 合并两个概率为 $1/3$ 的信源符号得到 $2/3$，然后与概率为 $1/3$ 的复合节点合并。\n\n与这棵树一致的一种明确分配是：\nS1: 00, S2: 01, S3: 10, S4: 110, S5: 111.\n这得到的码长集合为 $\\{2,2,2,3,3\\}$，分别对应概率 $\\{1/3,1/3,1/9,1/9,1/9\\}$。\n\n计算码 A 的期望值：\n$$E[l]=\\frac{1}{3}\\cdot 2+\\frac{1}{3}\\cdot 2+\\frac{1}{9}\\cdot 2+\\frac{1}{9}\\cdot 3+\\frac{1}{9}\\cdot 3=\\frac{20}{9}.$$\n$$E[l^{2}]=\\frac{1}{3}\\cdot 4+\\frac{1}{3}\\cdot 4+\\frac{1}{9}\\cdot 4+\\frac{1}{9}\\cdot 9+\\frac{1}{9}\\cdot 9=\\frac{46}{9}.$$\n因此\n$$\\sigma^{2}_{A}=E[l^{2}]-(E[l])^{2}=\\frac{46}{9}-\\left(\\frac{20}{9}\\right)^{2}=\\frac{46}{9}-\\frac{400}{81}=\\frac{14}{81}.$$\n\n构造码 B（在第三步将一个概率为 $1/3$ 的符号与概率为 $1/3$ 的复合节点合并）：\n- 合并三个 $1/9$ 中的两个，得到 $2/9$。\n- 合并 $1/9$ 和 $2/9$，得到 $1/3$。\n- 合并一个概率为 $1/3$ 的信源符号与概率为 $1/3$ 的复合节点得到 $2/3$，然后与剩下的概率为 $1/3$ 的信源符号合并。\n\n与这棵树一致的一种明确分配是：\nS2: 0, S1: 10, S3: 110, S4: 1110, S5: 1111.\n这得到的码长集合为 $\\{1,2,3,4,4\\}$，分别对应概率 $\\{1/3,1/3,1/9,1/9,1/9\\}$。\n\n计算码 B 的期望值：\n$$E[l]=\\frac{1}{3}\\cdot 1+\\frac{1}{3}\\cdot 2+\\frac{1}{9}\\cdot 3+\\frac{1}{9}\\cdot 4+\\frac{1}{9}\\cdot 4=\\frac{20}{9}.$$\n$$E[l^{2}]=\\frac{1}{3}\\cdot 1+\\frac{1}{3}\\cdot 4+\\frac{1}{9}\\cdot 9+\\frac{1}{9}\\cdot 16+\\frac{1}{9}\\cdot 16=\\frac{56}{9}.$$\n因此\n$$\\sigma^{2}_{B}=E[l^{2}]-(E[l])^{2}=\\frac{56}{9}-\\left(\\frac{20}{9}\\right)^{2}=\\frac{56}{9}-\\frac{400}{81}=\\frac{104}{81}.$$\n\n两个方差之间的绝对差值为\n$$\\left|\\sigma^{2}_{B}-\\sigma^{2}_{A}\\right|=\\left|\\frac{104}{81}-\\frac{14}{81}\\right|=\\frac{90}{81}=\\frac{10}{9}.$$\n作为一个四舍五入到四位有效数字的小数，结果是 $1.111$。", "answer": "$$\\boxed{1.111}$$", "id": "1623280"}, {"introduction": "我们已经学习了如何构建最优码并分析其特性，现在让我们来研究当信源本身的统计特性发生变化时会发生什么。本练习 [@problem_id:1623265] 通过一个简洁的三符号信源模型，清晰地展示了期望码长是如何随着概率分布的改变而变化的。这个实践有助于你理解保持编码与信源统计特性匹配的重要性，并为自适应编码等高级概念奠定基础。", "problem": "一个数据采集系统监控一个物理过程，该过程会产生三种不同的结果，分别标记为状态 A、B 和 C。为了进行初始系统校准，这些状态的长期概率被确定为 $P(A) = 0.40$、$P(B) = 0.30$ 和 $P(C) = 0.30$。基于这些概率，设计了一种最优无前缀二元码，用于对状态流进行编码以实现高效传输。\n\n在新环境中运行数月后，进行了一次重新校准。新的分析显示过程动态发生了变化，状态概率现在变为 $P'(A) = 0.60$、$P'(B) = 0.20$ 和 $P'(C) = 0.20$。为了保持最优性能，必须基于这些更新后的概率生成一种新的无前缀二元码。\n\n计算新的（重新校准的）码的期望码长与原始码的期望码长之差，即 $L_{new} - L_{original}$。将您的答案以比特/符号为单位，表示为一个精确的小数值。", "solution": "对于一个包含三个符号的二元 Huffman 码，若其概率按 $p_{1}\\geq p_{2}\\geq p_{3}$ 排序，Huffman 过程会将两个最小的概率合并到一个节点中，从而生成一个码字长度为 $\\ell_{1}=1$ 和 $\\ell_{2}=\\ell_{3}=2$ 的满二叉树。这满足 Kraft 等式 $2^{-1}+2^{-2}+2^{-2}=1$ 并且是最优的。\n\n因此，期望码长为\n$$\nL=\\sum_{i=1}^{3}p_{i}\\ell_{i}=p_{1}\\cdot 1+p_{2}\\cdot 2+p_{3}\\cdot 2=2-p_{1}.\n$$\n\n原始分布：$P(A)=0.40$、$P(B)=0.30$、$P(C)=0.30$ 给出 $p_{1}=0.40$，因此\n$$\nL_{\\text{original}}=2-0.40=1.60.\n$$\n\n新分布：$P'(A)=0.60$、$P'(B)=0.20$、$P'(C)=0.20$ 给出 $p'_{1}=0.60$，因此\n$$\nL_{\\text{new}}=2-0.60=1.40.\n$$\n\n所求的差值为\n$$\nL_{\\text{new}}-L_{\\text{original}}=1.40-1.60=-0.20.\n$$", "answer": "$$\\boxed{-0.2}$$", "id": "1623265"}]}