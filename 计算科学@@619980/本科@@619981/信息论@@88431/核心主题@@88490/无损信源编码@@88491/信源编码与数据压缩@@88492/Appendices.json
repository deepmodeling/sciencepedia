{"hands_on_practices": [{"introduction": "霍夫曼编码是构建最优前缀码的基石，但其应用不限于二元字母表。这个练习将带你挑战一个三元 ($D=3$) 霍夫曼编码的构建过程，让你深入理解霍夫曼算法的核心规则，特别是在符号数量不满足直接分组时如何通过添加“哑”符号来解决问题。通过这个实践，你将掌握将霍夫曼方法推广到任意 $D$ 元编码方案的关键技巧。[@problem_id:1659054]", "problem": "一个研究团队正在为一个简化的化学信号系统开发一种通信协议。该系统使用六种不同的分子信号，记为 $S = \\{s_1, s_2, s_3, s_4, s_5, s_6\\}$。观测到每个信号的概率由经验确定为 $P(s_1) = 0.35$，$P(s_2) = 0.25$，$P(s_3) = 0.15$，$P(s_4) = 0.12$，$P(s_5) = 0.08$ 和 $P(s_6) = 0.05$。\n\n为了高效地传输此信息，该团队决定使用三元 Huffman 码，其码字母表为 $\\{0, 1, 2\\}$。\n\n计算生成的三元 Huffman 码的平均长度。答案以“三元数字/源符号”为单位，并保留三位有效数字。", "solution": "目标是为一个有六个符号的信源构建一个三元 Huffman 码，然后计算其平均长度。三元码使用 $D=3$ 个码元。\n\n用于D元码的 Huffman 算法要求，在每一步中要合并的符号数量 $N_k$ 必须满足条件 $(N_k - 1) \\pmod{D-1} = 0$，其中 $N_k$ 是步骤 $k$ 的符号数。这必须对初始符号集 $N_0$ 成立。在这里，我们有 $N=6$ 个源符号，并且我们正在创建一个三元码，所以 $D=3$。该条件是 $(N_0 - 1) \\pmod{2} = 0$。由于我们的初始符号数量是 $N=6$，我们有 $(6-1) \\pmod{2} = 5 \\pmod{2} = 1 \\neq 0$。\n\n为了满足这个条件，我们必须添加概率为零的哑符号，直到符号总数 $N_0$ 使 $(N_0 - 1)$ 成为一个偶数。这意味着 $N_0$ 必须是奇数。大于或等于6的最小奇数是7。因此，我们需要添加 $7-6=1$ 个哑符号 $d_1$，其概率为 $P(d_1) = 0$。\n\n我们的初始符号集和概率是：\n$s_1: 0.35$\n$s_2: 0.25$\n$s_3: 0.15$\n$s_4: 0.12$\n$s_5: 0.08$\n$s_6: 0.05$\n$d_1: 0.00$\n\n现在我们继续执行 Huffman 算法，在每一步中将 $D=3$ 个概率最小的符号合并成一个新的复合符号。\n\n**步骤 1：**\n三个概率最小的符号是 $d_1(0.00)$、$s_6(0.05)$ 和 $s_5(0.08)$。我们将它们合并成一个新节点（我们称之为 $n_1$），其概率为 $0.00 + 0.05 + 0.08 = 0.13$。\n符号及其概率列表变为：\n$s_1: 0.35$\n$s_2: 0.25$\n$s_3: 0.15$\n$n_1: 0.13$\n$s_4: 0.12$\n\n**步骤 2：**\n我们对新列表进行排序，并再次合并三个概率最小的符号。当前按概率排序的列表是：$\\{s_4(0.12), n_1(0.13), s_3(0.15), s_2(0.25), s_1(0.35)\\}$。\n三个概率最小的符号是 $s_4(0.12)$、$n_1(0.13)$ 和 $s_3(0.15)$。我们将它们合并成一个新节点 ($n_2$)，其概率为 $0.12 + 0.13 + 0.15 = 0.40$。\n符号和概率列表变为：\n$n_2: 0.40$\n$s_1: 0.35$\n$s_2: 0.25$\n\n**步骤 3：**\n我们剩下三个符号：$n_2(0.40)$、$s_1(0.35)$ 和 $s_2(0.25)$。我们将它们合并以形成树的根节点，概率为 $0.40 + 0.35 + 0.25 = 1.00$。构建完成。\n\n现在，我们通过从根节点遍历树来分配码字。我们将码元 $\\{0, 1, 2\\}$ 按照它们所指向的节点的概率递减顺序分配给各个分支。\n\n- 在根节点（总和=1.00），分支指向 $n_2(0.40)$、$s_1(0.35)$ 和 $s_2(0.25)$。\n  - $n_2(0.40) \\rightarrow 0$\n  - $s_1(0.35) \\rightarrow 1$。因此，$s_1$ 的码字是 `1`。\n  - $s_2(0.25) \\rightarrow 2$。因此，$s_2$ 的码字是 `2`。\n\n- 从节点 $n_2(0.40)$ 出发，分支指向 $s_3(0.15)$、$n_1(0.13)$ 和 $s_4(0.12)$。\n  - $s_3(0.15) \\rightarrow 0$。从根节点出发的路径是 `0`，所以 $s_3$ 的码字是 `00`。\n  - $n_1(0.13) \\rightarrow 1$。从根节点出发的路径是 `0`，所以前缀是 `01`。\n  - $s_4(0.12) \\rightarrow 2$。从根节点出发的路径是 `0`，所以 $s_4$ 的码字是 `02`。\n\n- 从节点 $n_1(0.13)$ 出发，分支指向 $s_5(0.08)$、$s_6(0.05)$ 和 $d_1(0.00)$。\n  - $s_5(0.08) \\rightarrow 0$。从根节点出发的路径是 `01`，所以 $s_5$ 的码字是 `010`。\n  - $s_6(0.05) \\rightarrow 1$。从根节点出发的路径是 `01`，所以 $s_6$ 的码字是 `011`。\n  - $d_1(0.00) \\rightarrow 2$。从根节点出发的路径是 `01`，所以 $d_1$ 的码字是 `012`，该码字不被使用。\n\n最终的码本是：\n- $s_1: 1$ (长度 $l_1=1$)\n- $s_2: 2$ (长度 $l_2=1$)\n- $s_3: 00$ (长度 $l_3=2$)\n- $s_4: 02$ (长度 $l_4=2$)\n- $s_5: 010$ (长度 $l_5=3$)\n- $s_6: 011$ (长度 $l_6=3$)\n\n平均长度 $L_{avg}$ 是每个符号的概率与其码字长度的乘积之和：\n$L_{avg} = \\sum_{i=1}^{6} P(s_i) l_i$\n$L_{avg} = (0.35 \\times 1) + (0.25 \\times 1) + (0.15 \\times 2) + (0.12 \\times 2) + (0.08 \\times 3) + (0.05 \\times 3)$\n$L_{avg} = 0.35 + 0.25 + 0.30 + 0.24 + 0.24 + 0.15$\n$L_{avg} = 1.53$\n\n平均长度是 $1.53$ 三元数字/源符号。该值已保留三位有效数字。", "answer": "$$\\boxed{1.53}$$", "id": "1659054"}, {"introduction": "算术编码提供了一种与霍夫曼编码截然不同的压缩思路，它将整个符号序列映射到 $[0, 1)$ 区间内的一个小数，而不是为每个符号分配独立的码字。这个练习将引导你手动执行算术编码的核心过程——区间递归划分，直观地展示一个符号序列如何被精确地表示为一个浮点数区间。通过这个具体计算，你将对算术编码的精妙机制及其实现高压缩率的潜力有更深刻的认识。[@problem_id:1659115]", "problem": "一个简单的随机源从字母表 {A, B, C} 中生成符号。这些符号的概率如下所示：\n$P(\\text{A}) = 0.25$\n$P(\\text{B}) = 0.60$\n$P(\\text{C}) = 0.15$\n\n一种特定的数据压缩方案将这些符号的任何序列映射到初始区间 $[0, 1)$ 内一个唯一的浮点子区间。映射过程递归定义如下：\n1. 初始区间为 $[0, 1)$。该区间按 A、B、C 的顺序被划分为与这些符号对应的子区间。每个子区间的长度等于相应符号的概率。\n2. 为编码一个序列，将初始区间缩小至序列中第一个符号对应的子区间。\n3. 这个新的、更小的区间本身再按照与原始区间 $[0, 1)$ 相同的比例进行划分。然后，过程缩小到序列中第二个符号对应的子区间。\n4. 对序列中的所有符号重复此递归过程。\n\n确定代表序列 \"BCA\" 的最终区间 $[L, U)$。以行矩阵的形式给出答案，该矩阵按顺序包含下界 $L$ 和上界 $U$，两个值均保留五位有效数字。", "solution": "我们应用算术编码中的递归区间细化方法。设当前区间为 $[L, U)$，宽度为 $R=U-L$。符号顺序为 A、B、C，概率为 $p_{A}=0.25$、$p_{B}=0.60$、$p_{C}=0.15$，则任意区间 $[L,U)$ 内的划分为：\n- A: $[L,\\, L + 0.25R)$\n- B: $[L + 0.25R,\\, L + 0.85R)$\n- C: $[L + 0.85R,\\, U)$\n\n从 $[L_{0}, U_{0}) = [0, 1)$ 开始，所以 $R_{0}=1$。\n\n第一个符号 B：选择 $[L_{1}, U_{1}) = [L_{0} + 0.25R_{0},\\, L_{0} + 0.85R_{0}) = [0.25,\\, 0.85)$。那么 $R_{1} = U_{1} - L_{1} = 0.60$。\n\n第二个符号 C：在 $[0.25, 0.85)$ 内选择 $[L_{2}, U_{2}) = [L_{1} + 0.85R_{1},\\, U_{1}) = [0.25 + 0.85 \\cdot 0.60,\\, 0.85) = [0.76,\\, 0.85)$。那么 $R_{2} = U_{2} - L_{2} = 0.09$。\n\n第三个符号 A：在 $[0.76, 0.85)$ 内选择 $[L_{3}, U_{3}) = [L_{2},\\, L_{2} + 0.25R_{2}) = [0.76,\\, 0.76 + 0.25 \\cdot 0.09] = [0.76,\\, 0.7825)$。\n\n因此，最终区间为 $[L, U) = [0.76, 0.7825)$。将每个边界值保留五位有效数字，得到 $L = 0.76000$ 和 $U = 0.78250$。", "answer": "$$\\boxed{\\begin{pmatrix}0.76000 & 0.78250\\end{pmatrix}}$$", "id": "1659115"}, {"introduction": "“最优”是否意味着“唯一”？这个练习将探讨霍夫曼编码的一个微妙而重要的特性：对于同一信源，可能存在多个平均码长相同（因此都是“最优”）的霍夫曼码。你将亲手构建两个不同的最优码，并进一步分析它们的次级属性——码长方差，从而揭示即使在平均效率上等价，不同的编码方案在码长分布的稳定性上可能存在差异。这个实践有助于你更全面地理解“最优性”的含义。[@problem_id:1659058]", "problem": "考虑一个离散无记忆信源，其生成的符号来自符号集 $\\mathcal{S} = \\{\\mathcal{A}, \\mathcal{B}, \\mathcal{C}, \\mathcal{D}\\}$。这些符号的概率由 $P(\\mathcal{A}) = 0.4$，$P(\\mathcal{B}) = 0.2$，$P(\\mathcal{C}) = 0.2$ 和 $P(\\mathcal{D}) = 0.2$ 给出。\n\n霍夫曼编码算法可用于为该信源生成一个最优二进制前缀码。然而，由于特定的概率分布，构造过程中的平局处理选择可能导致生成至少两种不同的最优码，它们的区别在于具有不同的码长集合。\n\n令 $L$ 为一个随机变量，表示从信源中抽取的一个符号的码长。对于一个符号 $s_i \\in \\mathcal{S}$，$L$ 的值为其码长 $l_i$，其出现的概率为 $p_i = P(s_i)$。码长的方差定义为 $\\sigma^2 = E[L^2] - (E[L])^2$。\n\n你的任务是构造两种不同的最优霍夫曼码（我们称之为“码1”和“码2”），使得码1的码长多重集 $\\{l_{1,\\mathcal{A}}, l_{1,\\mathcal{B}}, l_{1,\\mathcal{C}}, l_{1,\\mathcal{D}}\\}$ 与码2的码长多重集 $\\{l_{2,\\mathcal{A}}, l_{2,\\mathcal{B}}, l_{2,\\mathcal{C}}, l_{2,\\mathcal{D}}\\}$ 不同。\n\n计算这两种码的码长方差，分别记为 $\\sigma_1^2$ 和 $\\sigma_2^2$。然后，计算这两个方差的绝对差 $|\\sigma_1^2 - \\sigma_2^2|$。\n\n将你的最终答案保留两位有效数字。", "solution": "信源的概率为 $p_{\\mathcal{A}}=0.4$ 和 $p_{\\mathcal{B}}=p_{\\mathcal{C}}=p_{\\mathcal{D}}=0.2$。应用霍夫曼算法，注意三个 $0.2$ 概率之间存在的平局情况允许多种不同的合并顺序，从而产生不同的最优树。\n\n构造码1：将 $0.2$ 与 $0.2$ 合并得到 $0.4$，然后将 $0.2$ 与 $0.4$ 合并得到 $0.6$，最后将 $0.6$ 与 $0.4$ 合并。在第二步合并时，选择不将两个 $0.4$ 的节点在最后一步之前合并。这样会使得所有四个叶节点处于相同的深度，因此一个具体的编码示例是 $\\mathcal{A}:00$，$\\mathcal{B}:01$，$\\mathcal{C}:10$，$\\mathcal{D}:11$。因此，码长的多重集为 $\\{2,2,2,2\\}$。对于随机码长 $L$，我们有 $P(L=2)=1$。因此，\n$$\nE[L]=2,\\qquad E[L^{2}]=4,\\qquad \\sigma_{1}^{2}=E[L^{2}]-(E[L])^{2}=4-4=0.\n$$\n\n构造码2：合并两个 $0.2$ 得到 $0.4$，然后将该 $0.4$ 与剩下的 $0.2$ 合并得到 $0.6$，最后将 $0.6$ 与剩下的 $0.4$ (符号 $\\mathcal{A}$) 合并。一个具体的编码示例是 $\\mathcal{A}:0$，$\\mathcal{D}:10$，$\\mathcal{B}:110$，$\\mathcal{C}:111$。码长的多重集为 $\\{1,2,3,3\\}$。$L$ 的导出分布为 $P(L=1)=0.4$，$P(L=2)=0.2$，$P(L=3)=0.4$。计算\n$$\nE[L]=0.4\\cdot 1+0.2\\cdot 2+0.4\\cdot 3=2,\n$$\n$$\nE[L^{2}]=0.4\\cdot 1^{2}+0.2\\cdot 2^{2}+0.4\\cdot 3^{2}=0.4+0.8+3.6=4.8,\n$$\n因此\n$$\n\\sigma_{2}^{2}=E[L^{2}]-(E[L])^{2}=4.8-4=0.8.\n$$\n\n方差的绝对差为\n$$\n|\\sigma_{1}^{2}-\\sigma_{2}^{2}|=|0-0.8|=0.8,\n$$\n保留两位有效数字后为 $0.80$。", "answer": "$$\\boxed{0.80}$$", "id": "1659058"}]}