{"hands_on_practices": [{"introduction": "理论学习之后，最好的检验方式莫过于亲手实践。下面的练习将引导我们从不同角度计算和理解信道容量。我们首先从一个思想实验开始，它揭示了信道容量的核心概念。这个练习 [@problem_id:1618511] 描述了一个独特的信道，其输出符号集被划分成互不相交的子集，每个子集唯一对应一个输入符号。通过分析这种“无歧义”的信道，我们可以直观地理解条件熵 $H(X|Y)$ 的含义，并揭示在何种理想情况下，信道容量能够达到其理论上限。", "problem": "一个新颖的通信系统，称为“分割输出信道”，是为一种特殊应用而设计的。该系统有一个有限的输入符号集 $\\mathcal{X} = \\{x_1, x_2, \\ldots, x_K\\}$，其中 $K$ 是不同输入符号的总数。输出符号集用 $\\mathcal{Y}$ 表示。\n\n该信道的一个定义性特征是其输出结构。输出字母表 $\\mathcal{Y}$ 被分割成 $K$ 个不相交的非空子集 $\\mathcal{Y}_1, \\mathcal{Y}_2, \\ldots, \\mathcal{Y}_K$，使得 $\\mathcal{Y} = \\bigcup_{i=1}^{K} \\mathcal{Y}_i$ 且对于所有 $i \\neq j$ 都有 $\\mathcal{Y}_i \\cap \\mathcal{Y}_j = \\emptyset$。\n\n信道的行为由以下规则决定：当输入符号 $x_i$ 被发送时，产生的输出符号 $y$ 保证属于相应的子集 $\\mathcal{Y}_i$。形式上，信道的条件概率分布 $p(y|x_i)$ 满足，如果 $y \\notin \\mathcal{Y}_i$，则 $p(y|x_i) = 0$。对于任何给定的输入 $x_i$，其关联输出子集上的概率总和为 1，即 $\\sum_{y \\in \\mathcal{Y}_i} p(y|x_i) = 1$。对于 $y \\in \\mathcal{Y}_i$ 的具体概率 $p(y|x_i)$ 是非零的，但没有进一步说明。\n\n假设此系统被建模为离散无记忆信道，确定其信道容量 $C$。用包含输入符号数 $K$ 的符号表达式来表示你的答案。最终表达式中的对数必须以 2 为底。", "solution": "设 $X$ 是信道输入，取值于 $\\mathcal{X}=\\{x_{1},\\ldots,x_{K}\\}$；$Y$ 是信道输出，取值于 $\\mathcal{Y}=\\bigcup_{i=1}^{K}\\mathcal{Y}_{i}$，其中对于 $i\\neq j$ 有 $\\mathcal{Y}_{i}\\cap\\mathcal{Y}_{j}=\\emptyset$。离散无记忆信道的容量是\n$$\nC=\\max_{p(x)} I(X;Y),\n$$\n其中\n$$\nI(X;Y)=H(X)-H(X|Y).\n$$\n根据分割输出的特性，对于每个 $y\\in\\mathcal{Y}$，存在一个唯一的索引 $i$ 使得 $y\\in\\mathcal{Y}_{i}$。信道定律满足，对于所有 $j\\neq i$ 有 $p(y|x_{j})=0$，而 $p(y|x_{i})>0$。因此，对于任何先验概率 $p(x)$，\n$$\np(x_{i}|y)=\\frac{p(y|x_{i})p(x_{i})}{\\sum_{j=1}^{K}p(y|x_{j})p(x_{j})}=\\frac{p(y|x_{i})p(x_{i})}{p(y|x_{i})p(x_{i})}=1,\n$$\n且对于 $j\\neq i$ 有 $p(x_{j}|y)=0$。因此，对于每一个 $y$ 都有 $H(X|Y=y)=0$，这意味着\n$$\nH(X|Y)=\\sum_{y}p(y)H(X|Y=y)=0.\n$$\n所以，\n$$\nI(X;Y)=H(X).\n$$\n最大化互信息等价于最大化 $K$ 个符号上的输入熵。熵的界限给出\n$$\nH(X)\\leq \\log_{2}(K),\n$$\n当输入为均匀分布 $p(x_{i})=\\frac{1}{K}$（对于所有 $i$）时，等号成立。因此，\n$$\nC=\\max_{p(x)}I(X;Y)=\\max_{p(x)}H(X)=\\log_{2}(K).\n$$", "answer": "$$\\boxed{\\log_{2}(K)}$$", "id": "1618511"}, {"introduction": "从理想化的“无歧义”信道出发，我们现在转向一个更贴近现实的非对称噪声场景。在许多通信系统中，不同符号的传输可靠性并不相同。这个练习 [@problem_id:1618455] 模拟了一种常见于光通信的“Z信道”（Z-channel），其中一个符号的传输是完美的，而另一个符号则有一定概率被错误识别。要解决这个问题，我们不能再简单地认为条件熵为零，而必须通过优化输入概率分布来最大化互信息，从而发掘出这种非对称信道所能承载的最大信息率。", "problem": "考虑一个简化的光通信系统模型，该系统以光脉冲的形式传输二进制数据，“0”和“1”。该系统设计为用高强度脉冲表示“1”，用低强度脉冲表示“0”。检测器在识别高强度脉冲方面是完全可靠的，因此当发送“1”时，总是能正确地接收为“1”。然而，代表“0”的低强度脉冲可能会受到检测器中杂散光子或热噪声的影响。这导致发送的“0”被错误地记录为“1”的概率不为零，记为 $p$。“0”被正确接收的概率为 $1-p$。我们假设该信道是无记忆的，即每次比特传输的结果与所有其他传输相互独立，并且噪声参数 $p$ 是一个满足 $0 < p < 1$ 的常数。\n\n令随机变量 $X$ 表示该信道的二进制输入，$Y$ 表示二进制输出。您的任务是确定两个量：信道容量 $C$（即通过该信道可能的最大信息传输速率），以及达到该容量的特定输入概率分布。令这个最优分布由发送“0”的概率定义，记为 $w_0 = P(X=0)$。\n\n请提供两个解析表达式，用错误概率 $p$ 和二元熵函数 $H_2(x) = -x \\log_2(x) - (1-x) \\log_2(1-x)$ 来表示。第一个表达式应为容量 $C$（单位为比特/信道使用），第二个表达式应为最优输入概率 $w_0$。", "solution": "通过条件概率定义该二进制输入、二进制输出信道：对于 $X \\in \\{0,1\\}$ 和 $Y \\in \\{0,1\\}$，\n$$\nP(Y=1 \\mid X=1)=1, \\quad P(Y=0 \\mid X=1)=0, \\quad P(Y=1 \\mid X=0)=p, \\quad P(Y=0 \\mid X=0)=1-p,\n$$\n其中 $0<p<1$。令 $w_{0}=P(X=0)=q$ 且 $w_{1}=P(X=1)=1-q$。输出分布为\n$$\nP(Y=1)=p q+(1-q)=1-q(1-p), \\quad P(Y=0)=(1-p) q.\n$$\n因此输出熵为\n$$\nH(Y)=H_{2}(P(Y=1))=H_{2}(1-q(1-p))=H_{2}(q(1-p)),\n$$\n利用了 $H_{2}(x)=H_{2}(1-x)$。条件熵为\n$$\nH(Y \\mid X)=P(X=0) H(Y \\mid X=0)+P(X=1) H(Y \\mid X=1)=q\\,H_{2}(p)+ (1-q)\\cdot 0=q\\,H_{2}(p).\n$$\n因此，作为 $q$ 的函数的互信息为\n$$\nI(X;Y)=H(Y)-H(Y \\mid X)=H_{2}\\big((1-p) q\\big)-q\\,H_{2}(p).\n$$\n为了求得容量，需要在 $q \\in [0,1]$ 上最大化 $I(X;Y)$。对 $q$ 求导；使用 $\\frac{d}{du}H_{2}(u)=\\log_{2}\\!\\left(\\frac{1-u}{u}\\right)$ 和链式法则可得\n$$\n\\frac{d}{dq} I(X;Y)=(1-p)\\,\\log_{2}\\!\\left(\\frac{1-(1-p) q}{(1-p) q}\\right)-H_{2}(p).\n$$\n令导数为零可得\n$$\n(1-p)\\,\\log_{2}\\!\\left(\\frac{1-(1-p) q^{\\star}}{(1-p) q^{\\star}}\\right)=H_{2}(p).\n$$\n令 $r^{\\star}=(1-p) q^{\\star}$。则\n$$\n\\log_{2}\\!\\left(\\frac{1-r^{\\star}}{r^{\\star}}\\right)=\\frac{H_{2}(p)}{1-p}\n\\quad\\Longrightarrow\\quad\n\\frac{1-r^{\\star}}{r^{\\star}}=2^{\\frac{H_{2}(p)}{1-p}}\n\\quad\\Longrightarrow\\quad\nr^{\\star}=\\frac{1}{1+2^{\\frac{H_{2}(p)}{1-p}}}.\n$$\n因此，发送“0”的达到容量的输入概率为\n$$\nw_{0}^{\\star}=q^{\\star}=\\frac{r^{\\star}}{1-p}=\\frac{1}{(1-p)\\left(1+2^{\\frac{H_{2}(p)}{1-p}}\\right)}.\n$$\n由 $\\frac{d^{2}}{du^{2}}H_{2}(u)=-\\frac{1}{\\ln 2}\\left(\\frac{1}{u}+\\frac{1}{1-u}\\right)<0$ 以及线性变量代换 $u=(1-p) q$ 可知函数是凹函数，因此该驻点给出了唯一的全局最大值。\n\n在 $q^{\\star}$ 处计算容量：\n$$\nC=I(X;Y)\\big|_{q=q^{\\star}}=H_{2}(r^{\\star})-\\frac{r^{\\star}}{1-p}\\,H_{2}(p).\n$$\n令 $a=\\frac{H_{2}(p)}{1-p}$ 且 $A=2^{a}$。由于 $r^{\\star}=\\frac{1}{1+A}$，计算\n$$\nH_{2}(r^{\\star})=-\\frac{1}{1+A}\\log_{2}\\!\\frac{1}{1+A}-\\frac{A}{1+A}\\log_{2}\\!\\frac{A}{1+A}\n=\\log_{2}(1+A)-\\frac{A}{1+A}\\log_{2}A.\n$$\n由于 $\\log_{2}A=a$，我们有\n$$\nC=\\left[\\log_{2}(1+A)-\\frac{A}{1+A}a\\right]-\\frac{1}{1-p}\\cdot\\frac{1}{1+A}H_{2}(p)\n=\\log_{2}(1+A)-a.\n$$\n代回 $a=\\frac{H_{2}(p)}{1-p}$ 和 $A=2^{a}$ 得到闭式表达式\n$$\nC=\\log_{2}\\!\\left(1+2^{\\frac{H_{2}(p)}{1-p}}\\right)-\\frac{H_{2}(p)}{1-p}.\n$$\n这些表达式给出了以比特/信道使用为单位的信道容量，以及发送“0”的达到容量的输入概率。", "answer": "$$\\boxed{\\begin{pmatrix}\\log_{2}\\!\\left(1+2^{\\frac{H_{2}(p)}{1-p}}\\right)-\\frac{H_{2}(p)}{1-p} & \\frac{1}{(1-p)\\left(1+2^{\\frac{H_{2}(p)}{1-p}}\\right)}\\end{pmatrix}}$$", "id": "1618455"}, {"introduction": "最后，让我们从更宏观的系统角度来审视信道。在实际应用中，信道输入往往是经过编码器处理的结构化数据。这个练习 [@problem_id:1618445] 探讨了一个确定性信道，其输入由两个独立的二进制数据流构成，输出则是它们的和。解决这个问题将帮助我们理解一个关键原则：对于确定性信道，其容量等于输出熵的最大值。这个练习不仅是一个计算挑战，更重要的是，它揭示了在有输入约束（如此处的独立性）的情况下，如何通过设计输入统计特性来最大化系统的整体信息传输效率。", "problem": "考虑一个为专用通信系统设计的数字编码器。该编码器接收两个独立的二进制数据流，由随机变量 $X_1$ 和 $X_2$ 表示。每个变量可以从集合 $\\{0, 1\\}$ 中取值。编码器从每个流中取一个比特组合起来，形成一个输入对 $(X_1, X_2)$，并根据确定性规则 $Y = X_1 + X_2$ 将其映射到单个输出符号 $Y$。输出符号 $Y$ 随后被传输。这个过程定义了一个离散无记忆信道，其输入字母表是配对集合 $\\mathcal{X} = \\{(0,0), (0,1), (1,0), (1,1)\\}$，其输出字母表是 $\\mathcal{Y} = \\{0, 1, 2\\}$。\n\n该信道的容量定义为输入对 $(X_1, X_2)$ 和输出 $Y$ 之间的最大可能互信息，其关键约束是输入比特 $X_1$ 和 $X_2$ 必须始终统计独立。\n\n计算该信道的容量。请以“比特/信道使用”为单位表示结果。", "solution": "设 $X_{1} \\sim \\operatorname{Bern}(p)$ 和 $X_{2} \\sim \\operatorname{Bern}(q)$ 是独立的。该信道是确定性的，规则为 $Y=X_{1}+X_{2}$，因此对于任何输入对 $(X_{1},X_{2})$，输出 $Y$ 都是固定的。因此，\n$$\nI\\big((X_{1},X_{2});Y\\big)=H(Y)-H\\big(Y \\mid X_{1},X_{2}\\big)=H(Y).\n$$\n因此，在独立性约束下的容量为\n$$\nC=\\max_{p \\in [0,1],\\, q \\in [0,1]} H(Y).\n$$\n由独立的 $X_{1}$ 和 $X_{2}$ 导出的 $Y$ 的分布为\n$$\n\\begin{aligned}\nr_{0} &\\triangleq \\Pr(Y=0)=\\Pr(X_{1}=0, X_{2}=0)=(1-p)(1-q),\\\\\nr_{1} &\\triangleq \\Pr(Y=1)=\\Pr(X_{1}=1, X_{2}=0)+\\Pr(X_{1}=0, X_{2}=1)=p(1-q)+(1-p)q=p+q-2pq,\\\\\nr_{2} &\\triangleq \\Pr(Y=2)=\\Pr(X_{1}=1, X_{2}=1)=pq,\n\\end{aligned}\n$$\n满足 $r_{0}+r_{1}+r_{2}=1$。以比特为单位的熵为\n$$\nH(Y)=-\\sum_{y \\in \\{0,1,2\\}} r_{y} \\log_{2} r_{y}.\n$$\n我们在 $p,q \\in [0,1]$ 上最大化 $H(Y)$。使用恒等式计算偏导数\n$$\n\\frac{\\partial}{\\partial \\theta} H(Y)=-\\sum_{y} \\frac{\\partial r_{y}}{\\partial \\theta} \\log_{2} r_{y},\n$$\n该恒等式可由 $\\sum_{y} r_{y}=1$ 导出。关于 $p$，\n$$\n\\frac{\\partial r_{0}}{\\partial p}=-(1-q)=q-1,\\quad \\frac{\\partial r_{1}}{\\partial p}=1-2q,\\quad \\frac{\\partial r_{2}}{\\partial p}=q,\n$$\n所以平稳性条件 $\\frac{\\partial H}{\\partial p}=0$ 为\n$$\n(q-1)\\log_{2} r_{0}+(1-2q)\\log_{2} r_{1}+q\\log_{2} r_{2}=0.\n$$\n类似地，关于 $q$，\n$$\n(p-1)\\log_{2} r_{0}+(1-2p)\\log_{2} r_{1}+p\\log_{2} r_{2}=0.\n$$\n将这两个方程相减可得\n$$\n(q-p)\\left(\\log_{2} r_{0}-2\\log_{2} r_{1}+\\log_{2} r_{2}\\right)=0,\n$$\n因此任何内部驻点必须满足 $p=q$ 或 $r_{0}r_{2}=r_{1}^{2}$。后者在定义域内部是不可能的：记 $p=\\frac{u}{1+u}$ 和 $q=\\frac{v}{1+v}$，其中 $u,v \\in [0,\\infty)$，可得 $r_{0}r_{2}=\\frac{uv}{(1+u)^{2}(1+v)^{2}}$ 和 $r_{1}=\\frac{u+v}{(1+u)(1+v)}$，因此 $r_{0}r_{2}=r_{1}^{2}$ 意味着 $uv=(u+v)^{2}$，即 $u^{2}+uv+v^{2}=0$，这迫使 $u=v=0$（一个边界点）。因此，任何内部最大值点必须有 $p=q$。\n\n设 $p=q=a$。那么 $Y \\sim \\operatorname{Binomial}(2,a)$，且\n$$\nr_{0}=(1-a)^{2},\\quad r_{1}=2a(1-a),\\quad r_{2}=a^{2}.\n$$\n定义 $g(a)=H(Y)$。根据对称性 $g(a)=g(1-a)$，所以 $a=\\frac{1}{2}$ 是一个临界点。使用以下公式计算导数\n$$\n\\frac{d g}{d a}= -\\left(\\frac{d r_{0}}{d a}\\log_{2} r_{0}+\\frac{d r_{1}}{d a}\\log_{2} r_{1}+\\frac{d r_{2}}{d a}\\log_{2} r_{2}\\right),\n$$\n其中 $\\frac{d r_{0}}{d a}=2(a-1)$，$\\frac{d r_{1}}{d a}=2-4a$，$\\frac{d r_{2}}{d a}=2a$，在 $a=\\frac{1}{2}$ 处可得：\n$$\n\\left.(a-1)\\log_{2} r_{0}+(1-2a)\\log_{2} r_{1}+a\\log_{2} r_{2}\\right|_{a=\\frac{1}{2}}=\\left(-\\frac{1}{2}\\right)\\log_{2}\\left(\\frac{1}{4}\\right)+0\\cdot \\log_{2}\\left(\\frac{1}{2}\\right)+\\left(\\frac{1}{2}\\right)\\log_{2}\\left(\\frac{1}{4}\\right)=0,\n$$\n证实了其平稳性。边界情况（例如，$q=0$ 或 $q=1$）得出 $H(Y)\\leq 1$，因为此时 $Y$ 是二元变量。因此，内部驻点必定是最大值点。在 $a=\\frac{1}{2}$ 处计算 $H(Y)$，\n$$\nH(Y)= -\\frac{1}{4}\\log_{2}\\left(\\frac{1}{4}\\right)-\\frac{1}{2}\\log_{2}\\left(\\frac{1}{2}\\right)-\\frac{1}{4}\\log_{2}\\left(\\frac{1}{4}\\right)=\\frac{1}{2}+\\frac{1}{2}+\\frac{1}{2}=\\frac{3}{2}.\n$$\n因此，在独立性约束下的信道容量是 $\\frac{3}{2}$ 比特/信道使用。", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "1618445"}]}