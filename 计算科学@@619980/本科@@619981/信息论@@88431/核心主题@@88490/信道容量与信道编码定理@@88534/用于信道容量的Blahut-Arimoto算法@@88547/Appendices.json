{"hands_on_practices": [{"introduction": "理解一个迭代算法最好的方式就是亲手、仔细地走完它的每一步。本练习将引导你完整地执行一次 Blahut-Arimoto 算法的迭代。通过手动计算更新后的输入分布，你将对算法的核心机制，以及正向和反向概率之间的相互作用，建立起一个具体的认识。[@problem_id:1605109]", "problem": "考虑一个离散无记忆信道，其输入符号集为二元的 $\\mathcal{X} = \\{x_1, x_2\\}$，输出符号集为二元的 $\\mathcal{Y} = \\{y_1, y_2\\}$。该信道的行为由条件概率矩阵 $P(y_j|x_i)$ 描述，其中行对应于输入 $x_i$，列对应于输出 $y_j$。具体的信道矩阵由下式给出：\n$$\nP(y|x) = \\begin{pmatrix} P(y_1|x_1) & P(y_2|x_1) \\\\ P(y_1|x_2) & P(y_2|x_2) \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix}\n$$\nBlahut-Arimoto 算法是一种迭代过程，用于计算信道容量以及达到该容量的输入概率分布 $p(x)$。该算法的单次迭代将一个初始概率分布 $p_k(x)$ 更新为一个新的分布 $p_{k+1}(x)$。更新包括以下步骤：\n1.  根据当前输入分布 $p_k(x)$ 和信道矩阵 $P(y|x)$ 计算反向条件概率分布 $q_k(x|y)$：\n    $$\n    q_k(x|y) = \\frac{p_k(x) P(y|x)}{\\sum_{x' \\in \\mathcal{X}} p_k(x') P(y|x')}\n    $$\n2.  为每个输入符号计算新的、未归一化的权重 $c_k(x)$：\n    $$\n    c_k(x) = \\prod_{y \\in \\mathcal{Y}} [q_k(x|y)]^{P(y|x)}\n    $$\n    在此计算中，使用约定 $0^0 = 1$。\n3.  将权重归一化，以获得更新后的输入分布 $p_{k+1}(x)$：\n    $$\n    p_{k+1}(x) = \\frac{c_k(x)}{\\sum_{x' \\in \\mathcal{X}} c_k(x')}\n    $$\n您的任务是执行该算法的一次完整迭代。从均匀输入分布 $p_0(x) = (p_0(x_1), p_0(x_2)) = (\\frac{1}{2}, \\frac{1}{2})$ 开始，计算更新后的分布 $p_1(x) = (p_1(x_1), p_1(x_2))$。\n\n以行矩阵的形式，给出您的最终答案的精确解析表达式。", "solution": "目标是，在 Blahut-Arimoto 算法的一次迭代后，从均匀分布 $p_0(x_1) = 1/2$, $p_0(x_2) = 1/2$ 开始，计算概率分布 $p_1(x) = (p_1(x_1), p_1(x_2))$。信道矩阵由下式给出：\n$$\nP(y|x) = \\begin{pmatrix} 1 & 0 \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix}\n$$\n\n第一步是计算与初始输入分布 $p_0(x)$ 相对应的输出概率分布 $p_0(y)$。\n$$\np_0(y_1) = \\sum_{i=1}^{2} p_0(x_i) P(y_1|x_i) = p_0(x_1)P(y_1|x_1) + p_0(x_2)P(y_1|x_2)\n$$\n$$\np_0(y_1) = \\left(\\frac{1}{2}\\right)(1) + \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = \\frac{1}{2} + \\frac{1}{4} = \\frac{3}{4}\n$$\n$$\np_0(y_2) = \\sum_{i=1}^{2} p_0(x_i) P(y_2|x_i) = p_0(x_1)P(y_2|x_1) + p_0(x_2)P(y_2|x_2)\n$$\n$$\np_0(y_2) = \\left(\\frac{1}{2}\\right)(0) + \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = 0 + \\frac{1}{4} = \\frac{1}{4}\n$$\n作为检验，$p_0(y_1) + p_0(y_2) = 3/4 + 1/4 = 1$。\n\n接下来，我们计算反向条件概率 $q_0(x|y)$。\n对于 $y=y_1$：\n$$\nq_0(x_1|y_1) = \\frac{p_0(x_1)P(y_1|x_1)}{p_0(y_1)} = \\frac{(1/2)(1)}{3/4} = \\frac{1/2}{3/4} = \\frac{2}{3}\n$$\n$$\nq_0(x_2|y_1) = \\frac{p_0(x_2)P(y_1|x_2)}{p_0(y_1)} = \\frac{(1/2)(1/2)}{3/4} = \\frac{1/4}{3/4} = \\frac{1}{3}\n$$\n检验：$q_0(x_1|y_1) + q_0(x_2|y_1) = 2/3 + 1/3 = 1$。\n\n对于 $y=y_2$：\n$$\nq_0(x_1|y_2) = \\frac{p_0(x_1)P(y_2|x_1)}{p_0(y_2)} = \\frac{(1/2)(0)}{1/4} = 0\n$$\n$$\nq_0(x_2|y_2) = \\frac{p_0(x_2)P(y_2|x_2)}{p_0(y_2)} = \\frac{(1/2)(1/2)}{1/4} = \\frac{1/4}{1/4} = 1\n$$\n检验：$q_0(x_1|y_2) + q_0(x_2|y_2) = 0 + 1 = 1$。\n\n现在，我们计算未归一化的权重 $c_0(x)$。\n对于 $x=x_1$：\n$$\nc_0(x_1) = [q_0(x_1|y_1)]^{P(y_1|x_1)} \\cdot [q_0(x_1|y_2)]^{P(y_2|x_1)} = \\left(\\frac{2}{3}\\right)^1 \\cdot (0)^0\n$$\n使用指定的约定 $0^0=1$：\n$$\nc_0(x_1) = \\frac{2}{3} \\cdot 1 = \\frac{2}{3}\n$$\n\n对于 $x=x_2$：\n$$\nc_0(x_2) = [q_0(x_2|y_1)]^{P(y_1|x_2)} \\cdot [q_0(x_2|y_2)]^{P(y_2|x_2)} = \\left(\\frac{1}{3}\\right)^{1/2} \\cdot (1)^{1/2}\n$$\n$$\nc_0(x_2) = \\sqrt{\\frac{1}{3}} \\cdot 1 = \\frac{1}{\\sqrt{3}}\n$$\n\n最后，我们通过归一化这些权重来找到新的分布 $p_1(x)$。归一化常数是权重的总和：\n$$\nZ = c_0(x_1) + c_0(x_2) = \\frac{2}{3} + \\frac{1}{\\sqrt{3}} = \\frac{2}{3} + \\frac{\\sqrt{3}}{3} = \\frac{2+\\sqrt{3}}{3}\n$$\n现在我们求 $p_1(x)$ 的每个分量：\n$$\np_1(x_1) = \\frac{c_0(x_1)}{Z} = \\frac{2/3}{(2+\\sqrt{3})/3} = \\frac{2}{2+\\sqrt{3}}\n$$\n为简化，我们对分母进行有理化：\n$$\np_1(x_1) = \\frac{2}{2+\\sqrt{3}} \\cdot \\frac{2-\\sqrt{3}}{2-\\sqrt{3}} = \\frac{2(2-\\sqrt{3})}{2^2 - (\\sqrt{3})^2} = \\frac{4-2\\sqrt{3}}{4-3} = 4 - 2\\sqrt{3}\n$$\n$$\np_1(x_2) = \\frac{c_0(x_2)}{Z} = \\frac{1/\\sqrt{3}}{(2+\\sqrt{3})/3} = \\frac{1}{\\sqrt{3}} \\cdot \\frac{3}{2+\\sqrt{3}} = \\frac{\\sqrt{3}}{2+\\sqrt{3}}\n$$\n对分母进行有理化：\n$$\np_1(x_2) = \\frac{\\sqrt{3}}{2+\\sqrt{3}} \\cdot \\frac{2-\\sqrt{3}}{2-\\sqrt{3}} = \\frac{\\sqrt{3}(2-\\sqrt{3})}{4-3} = \\frac{2\\sqrt{3}-3}{1} = 2\\sqrt{3} - 3\n$$\n作为最终检验，我们对概率求和：\n$$\np_1(x_1) + p_1(x_2) = (4 - 2\\sqrt{3}) + (2\\sqrt{3} - 3) = 4 - 3 = 1\n$$\n更新后的分布为 $p_1(x) = (4 - 2\\sqrt{3}, 2\\sqrt{3} - 3)$。\n以所要求的行矩阵格式表示，结果为 $\\pmatrix{4 - 2\\sqrt{3} & 2\\sqrt{3} - 3}$。", "answer": "$$\\boxed{\\begin{pmatrix} 4 - 2\\sqrt{3} & 2\\sqrt{3} - 3 \\end{pmatrix}}$$", "id": "1605109"}, {"introduction": "在熟悉了算法的机械步骤之后，让我们通过一个思想实验来探索其基本性质。本练习将探讨一个关键问题：如果我们将某个输入符号的初始概率设为零，即$p_0(x_i)=0$，算法会如何演变？分析这个边界情况将揭示算法乘性更新规则的一个核心特点，并帮助你理解它如何在其解空间中进行搜索。[@problem_id:1605115]", "problem": "考虑一个离散无记忆信道 (DMC)，其输入字母表为 $\\mathcal{X} = \\{x_1, x_2, x_3\\}$，输出字母表为 $\\mathcal{Y} = \\{y_1, y_2\\}$。该信道由以下条件概率矩阵 $P(Y|X)$ 表征，其中第 $i$ 行第 $j$ 列的元素是 $p(y_j|x_i)$:\n$$\nP(Y|X) = \n\\begin{pmatrix} \n0.8 & 0.2 \\\\\n0.5 & 0.5 \\\\\n0.1 & 0.9 \n\\end{pmatrix}\n$$\nBlahut-Arimoto 算法是一种迭代过程，用于寻找能达到信道容量的输入概率分布 $p(x)$。令 $p_k(x_i)$ 表示在第 $k$ 次迭代时输入符号 $x_i$ 的概率。该算法根据以下规则更新概率：\n$$\np_{k+1}(x_i) = \\frac{p_k(x_i) \\exp\\left( \\sum_{j=1}^{2} p(y_j|x_i) \\ln \\frac{p(y_j|x_i)}{p_k(y_j)} \\right)}{Z_k}\n$$\n其中 $p_k(y_j) = \\sum_{i=1}^{3} p(y_j|x_i) p_k(x_i)$ 是在第 $k$ 次迭代时输出符号 $y_j$ 的概率，而 $Z_k$ 是一个归一化因子，以确保 $\\sum_{i=1}^{3} p_{k+1}(x_i) = 1$。\n\n假设算法在 $k=0$ 时使用输入分布 $p_0(x) = (p_0(x_1), p_0(x_2), p_0(x_3)) = (0, 0.5, 0.5)$ 进行初始化。对于任何迭代 $k \\geq 1$，以下哪个陈述准确地描述了概率质量 $p_k(x_1)$ 的值？\n\nA. 对于所有 $k \\geq 1$，$p_k(x_1)$ 将保持为 0。\n\nB. $p_k(x_1)$ 将在第一次迭代后变为非零，并收敛到 $x_1$ 的最优概率。\n\nC. $p_k(x_1)$ 的值取决于信道矩阵中的特定非零值，在不运行完整算法的情况下无法确定。\n\nD. 算法将在第一次迭代时遇到除零错误，因为对于某个 $j$，$p_0(y_j)$ 将为零。\n\nE. $p_k(x_1)$ 将在第一次迭代中增加到一个小的正值，然后在第二次迭代中减小回零。", "solution": "Blahut-Arimoto 对输入分布的更新公式为\n$$\np_{k+1}(x_{i})=\\frac{p_{k}(x_{i})\\exp\\left(\\sum_{j=1}^{2}p(y_{j}\\mid x_{i})\\ln\\frac{p(y_{j}\\mid x_{i})}{p_{k}(y_{j})}\\right)}{Z_{k}},\n$$\n其中\n$$\np_{k}(y_{j})=\\sum_{i=1}^{3}p(y_{j}\\mid x_{i})p_{k}(x_{i}),\\quad Z_{k}=\\sum_{i=1}^{3}p_{k}(x_{i})\\exp\\left(\\sum_{j=1}^{2}p(y_{j}\\mid x_{i})\\ln\\frac{p(y_{j}\\mid x_{i})}{p_{k}(y_{j})}\\right).\n$$\n初始化为 $p_{0}(x_{1})=0$, $p_{0}(x_{2})=\\frac{1}{2}$, $p_{0}(x_{3})=\\frac{1}{2}$，信道矩阵的元素为 $p(y_{1}\\mid x_{1})=\\frac{4}{5}$, $p(y_{2}\\mid x_{1})=\\frac{1}{5}$, $p(y_{1}\\mid x_{2})=\\frac{1}{2}$, $p(y_{2}\\mid x_{2})=\\frac{1}{2}$, $p(y_{1}\\mid x_{3})=\\frac{1}{10}$, $p(y_{2}\\mid x_{3})=\\frac{9}{10}$。首先计算 $k=0$ 时的输出分布：\n$$\np_{0}(y_{1})=\\sum_{i=1}^{3}p(y_{1}\\mid x_{i})p_{0}(x_{i})=\\frac{1}{2}\\cdot\\frac{1}{2}+\\frac{1}{2}\\cdot\\frac{1}{10}=\\frac{1}{4}+\\frac{1}{20}=\\frac{3}{10},\n$$\n$$\np_{0}(y_{2})=\\sum_{i=1}^{3}p(y_{2}\\mid x_{i})p_{0}(x_{i})=\\frac{1}{2}\\cdot\\frac{1}{2}+\\frac{1}{2}\\cdot\\frac{9}{10}=\\frac{1}{4}+\\frac{9}{20}=\\frac{7}{10}.\n$$\n$p_{0}(y_{1})$ 和 $p_{0}(y_{2})$ 都是严格为正的，因此更新公式中的所有对数都是有限的。然后，在 $k=0$ 时使用 $i=1$ 的更新公式，\n$$\np_{1}(x_{1})=\\frac{p_{0}(x_{1})\\exp\\left(\\sum_{j=1}^{2}p(y_{j}\\mid x_{1})\\ln\\frac{p(y_{j}\\mid x_{1})}{p_{0}(y_{j})}\\right)}{Z_{0}}=\\frac{0\\cdot\\exp(\\cdot)}{Z_{0}}=0,\n$$\n其中 $Z_{0}>0$，因为至少 $i=2,3$ 贡献了严格为正的项。这表明 $p_{1}(x_{1})=0$。\n\n我们现在通过归纳法证明，对于所有 $k\\geq 1$，$p_{k}(x_{1})=0$。如上所示，基础情况 $k=1$ 成立。假设 $p_{k}(x_{1})=0$ 且 $p_{k}(x_{2})>0$, $p_{k}(x_{3})>0$（后两个成立是因为更新过程将正的 $p_{k-1}(x_{i})$ 乘以正的指数项并进行重新归一化）。那么对于每个输出符号，\n$$\np_{k}(y_{j})=\\sum_{i=1}^{3}p(y_{j}\\mid x_{i})p_{k}(x_{i})=\\sum_{i=2}^{3}p(y_{j}\\mid x_{i})p_{k}(x_{i})>0,\n$$\n因为 $p(y_{j}\\mid x_{2})$ 和 $p(y_{j}\\mid x_{3})$ 是严格为正的，并且 $p_{k}(x_{2}),p_{k}(x_{3})>0$。因此对于 $i=1$ 的指数项是有限的，并且\n$$\np_{k+1}(x_{1})=\\frac{p_{k}(x_{1})\\exp\\left(\\sum_{j=1}^{2}p(y_{j}\\mid x_{1})\\ln\\frac{p(y_{j}\\mid x_{1})}{p_{k}(y_{j})}\\right)}{Z_{k}}=\\frac{0\\cdot\\exp(\\cdot)}{Z_{k}}=0,\n$$\n其中 $Z_{k}>0$ 的原因同前。因此，通过归纳法，对于所有 $k\\geq 1$，$p_{k}(x_{1})=0$。\n\n这证明了 Blahut-Arimoto 乘性更新保留了 $x_{1}$ 上的零概率。第一次迭代中没有除零错误，因为 $p_{0}(y_{1})=\\frac{3}{10}$ 和 $p_{0}(y_{2})=\\frac{7}{10}$ 都是严格为正的。因此，在这些选项中，准确的陈述是 $p_{k}(x_{1})$ 在所有迭代中都保持为零。", "answer": "$$\\boxed{A}$$", "id": "1605115"}, {"introduction": "现实世界的问题常常包含可以简化分析的对称性。本练习提出了一个特殊的信道，其中两个不同的输入符号具有完全相同的统计特性，即它们的信道转移概率行向量是相同的。通过考察这种情况，你将学会识别这类对称性并预测 Blahut-Arimoto 算法会如何处理它们，从而让你从繁琐的计算中解放出来，并加深对概念的掌握。[@problem_id:1605140]", "problem": "一位工程师的任务是表征一个离散无记忆信道。该信道的输入符号集为 $\\mathcal{X} = \\{x_1, x_2, x_3, x_4\\}$，输出符号集为 $\\mathcal{Y} = \\{y_1, y_2, y_3\\}$。该信道的行为由条件概率矩阵 $P(y_j|x_i)$ 描述，其中第 $i$ 行第 $j$ 列的元素表示在发送输入 $x_i$ 的情况下接收到输出 $y_j$ 的概率。该矩阵由下式给出：\n$$\nP(y|x) = \\begin{pmatrix}\n0.5 & 0.2 & 0.3 \\\\\n0.5 & 0.2 & 0.3 \\\\\n0.1 & 0.8 & 0.1 \\\\\n0.4 & 0.3 & 0.3\n\\end{pmatrix}\n$$\n为了找到信道容量，该工程师采用了 Blahut-Arimoto 算法。该算法通过迭代的方式优化初始输入概率分布 $p(x)$，使其收敛到能达到信道容量的分布。迭代过程定义如下：\n\n1.  从一个初始概率分布 $p_0(x)$ 开始，其中对于所有 $x \\in \\mathcal{X}$ 都有 $p_0(x) > 0$。\n2.  对于每次迭代 $k = 0, 1, 2, \\dots$，使用以下公式为每个输入符号 $x \\in \\mathcal{X}$ 计算一组辅助值 $c_k(x)$：\n    $$\n    c_k(x) = \\exp\\left(\\sum_{y \\in \\mathcal{Y}} P(y|x) \\ln\\left( \\frac{P(y|x)}{q_k(y)} \\right)\\right)\n    $$\n    其中 $q_k(y) = \\sum_{x' \\in \\mathcal{X}} p_k(x') P(y|x')$。\n3.  使用以下公式更新下一次迭代的输入概率分布 $p_{k+1}(x)$：\n    $$\n    p_{k+1}(x) = \\frac{p_k(x) c_k(x)}{\\sum_{x'' \\in \\mathcal{X}} p_k(x'') c_k(x'')}\n    $$\n\n工程师使用初始分布 $p_0(x_1) = 0.1$，$p_0(x_2) = 0.4$，$p_0(x_3) = 0.3$ 和 $p_0(x_4) = 0.2$ 来启动该算法。\n\n在运行该算法若干步后，工程师希望分析输入概率的演变过程。计算第 5 次迭代结束时比值 $p_5(x_1) / p_5(x_2)$ 的值。将你的答案以实数形式给出，并四舍五入到三位有效数字。", "solution": "给定一个离散无记忆信道，其输入符号为 $x_{1},x_{2},x_{3},x_{4}$，条件概率矩阵的行满足 $P(y|x_{1})=P(y|x_{2})=[0.5,0.2,0.3]$。Blahut-Arimoto 迭代使用\n$$\nq_{k}(y)=\\sum_{x'} p_{k}(x')P(y|x'),\\quad\nc_{k}(x)=\\exp\\left(\\sum_{y}P(y|x)\\ln\\left(\\frac{P(y|x)}{q_{k}(y)}\\right)\\right),\n$$\n和\n$$\np_{k+1}(x)=\\frac{p_{k}(x)c_{k}(x)}{\\sum_{x''}p_{k}(x'')c_{k}(x'')}.\n$$\n我们要求解比值 $p_{5}(x_{1})/p_{5}(x_{2})$。将第 $k$ 次迭代时的比值定义为 $r_{k}=\\frac{p_{k}(x_{1})}{p_{k}(x_{2})}$。使用更新公式，\n$$\n\\frac{p_{k+1}(x_{1})}{p_{k+1}(x_{2})}=\\frac{p_{k}(x_{1})c_{k}(x_{1})}{p_{k}(x_{2})c_{k}(x_{2})}=r_{k}\\cdot\\frac{c_{k}(x_{1})}{c_{k}(x_{2})}.\n$$\n为了计算 $\\frac{c_{k}(x_{1})}{c_{k}(x_{2})}$，注意到对于所有的 $y\\in\\mathcal{Y}$ 都有 $P(y|x_{1})=P(y|x_{2})$。由于 $q_{k}(y)$ 只依赖于 $p_{k}$ 和信道，而与在 $c_{k}(x)$ 中所计算的 $x$ 无关，因此可以得出\n$$\nc_{k}(x_{1})=\\exp\\left(\\sum_{y}P(y|x_{1})\\ln\\left(\\frac{P(y|x_{1})}{q_{k}(y)}\\right)\\right)\n=\\exp\\left(\\sum_{y}P(y|x_{2})\\ln\\left(\\frac{P(y|x_{2})}{q_{k}(y)}\\right)\\right)=c_{k}(x_{2}).\n$$\n因此 $\\frac{c_{k}(x_{1})}{c_{k}(x_{2})}=1$，该比值在迭代过程中保持不变：\n$$\nr_{k+1}=r_{k}\\quad\\text{for all }k.\n$$\n对于初始分布 $p_{0}(x_{1})=0.1$ 和 $p_{0}(x_{2})=0.4$，我们有\n$$\nr_{0}=\\frac{p_{0}(x_{1})}{p_{0}(x_{2})}=\\frac{0.1}{0.4}=\\frac{1}{4}.\n$$\n因此对于所有的 $k$，特别是对于 $k=5$，\n$$\n\\frac{p_{5}(x_{1})}{p_{5}(x_{2})}=r_{5}=r_{0}=\\frac{1}{4}=0.25.\n$$\n四舍五入到三位有效数字，所求的比值为 $0.250$。", "answer": "$$\\boxed{0.250}$$", "id": "1605140"}]}