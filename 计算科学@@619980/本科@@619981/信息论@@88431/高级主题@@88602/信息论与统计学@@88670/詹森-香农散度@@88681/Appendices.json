{"hands_on_practices": [{"introduction": "掌握任何新概念的第一步都是直接应用其定义。这个练习将提供计算两个简单离散概率分布之间詹森-香农散度（JSD）的实践。通过按部就班地计算混合分布 $M$，然后计算两个 KL 散度，最后得出 JSD，你将为更复杂的应用奠定坚实的计算基础。[@problem_id:1634129]", "problem": "在机器学习领域，经常需要量化两个概率分布之间的相似性。其中一种度量方法是詹森-香农散度（JSD）。\n\n考虑两个相互竞争的图像分类模型，模型A和模型B。两个模型都负责将一幅图像分类到三个可能的类别之一：'猫'、'狗'或'鸟'。对于一个特定的输入图像，模型A输出关于这些类别的概率分布 $P$，模型B则输出概率分布 $Q$。这些分布如下所示：\n$$P = [p_1, p_2, p_3] = [0.8, 0.1, 0.1]$$\n$$Q = [q_1, q_2, q_3] = [0.1, 0.8, 0.1]$$\n其中，元素分别对应'猫'、'狗'和'鸟'的概率。\n\n$P$ 和 $Q$ 之间的詹森-香农散度是使用Kullback-Leibler散度（KLD）来定义的。对于两个离散概率分布 $X = [x_i]$ 和 $Y = [y_i]$，KLD由以下公式给出：\n$$D_{KL}(X || Y) = \\sum_{i} x_i \\log_{2}\\left(\\frac{x_i}{y_i}\\right)$$\n然后，JSD被定义为KLD的对称化版本：\n$$JSD(P || Q) = \\frac{1}{2} D_{KL}(P || M) + \\frac{1}{2} D_{KL}(Q || M)$$\n其中 $M$ 是混合分布，定义为 $M = \\frac{1}{2}(P+Q)$。对数以2为底，因此得到的散度以比特（bits）为单位。\n\n计算给定分布的詹森-香农散度 $JSD(P || Q)$。将您的答案以比特为单位表示，并四舍五入到四位有效数字。", "solution": "我们已知 $P=[0.8,0.1,0.1]$ 和 $Q=[0.1,0.8,0.1]$。Jensen-Shannon散度的定义为\n$$\nJSD(P||Q)=\\frac{1}{2}D_{KL}(P||M)+\\frac{1}{2}D_{KL}(Q||M),\n$$\n其中混合分布为 $M=\\frac{1}{2}(P+Q)$。我们逐元素计算 $M$：\n$$\nM=\\frac{1}{2}([0.8+0.1,\\,0.1+0.8,\\,0.1+0.1])=[0.45,\\,0.45,\\,0.1].\n$$\n使用以2为底的对数的Kullback-Leibler散度定义，\n$$\nD_{KL}(X||Y)=\\sum_{i}x_{i}\\log_{2}\\!\\left(\\frac{x_{i}}{y_{i}}\\right),\n$$\n我们计算 $D_{KL}(P||M)$：\n$$\nD_{KL}(P||M)=0.8\\log_{2}\\!\\left(\\frac{0.8}{0.45}\\right)+0.1\\log_{2}\\!\\left(\\frac{0.1}{0.45}\\right)+0.1\\log_{2}\\!\\left(\\frac{0.1}{0.1}\\right).\n$$\n由于 $\\frac{0.8}{0.45}=\\frac{16}{9}$，$\\frac{0.1}{0.45}=\\frac{2}{9}$ 并且 $\\log_{2}(1)=0$，上式可简化为\n$$\nD_{KL}(P||M)=0.8\\log_{2}\\!\\left(\\frac{16}{9}\\right)+0.1\\log_{2}\\!\\left(\\frac{2}{9}\\right).\n$$\n同理，我们计算 $D_{KL}(Q||M)$：\n$$\nD_{KL}(Q||M)=0.1\\log_{2}\\!\\left(\\frac{2}{9}\\right)+0.8\\log_{2}\\!\\left(\\frac{16}{9}\\right).\n$$\n因此，JSD的计算如下：\n$$\nJSD(P||Q)=\\frac{1}{2}\\left[0.8\\log_{2}\\!\\left(\\frac{16}{9}\\right)+0.1\\log_{2}\\!\\left(\\frac{2}{9}\\right)\\right]+\\frac{1}{2}\\left[0.1\\log_{2}\\!\\left(\\frac{2}{9}\\right)+0.8\\log_{2}\\!\\left(\\frac{16}{9}\\right)\\right].\n$$\n由于两个KL散度项相等，其结果等于\n$$\nJSD(P||Q)=0.8\\log_{2}\\!\\left(\\frac{16}{9}\\right)+0.1\\log_{2}\\!\\left(\\frac{2}{9}\\right).\n$$\n使用 $\\log_{2}\\!\\left(\\frac{16}{9}\\right)=\\log_{2}(16)-\\log_{2}(9)=4-2\\log_{2}(3)$ 和 $\\log_{2}\\!\\left(\\frac{2}{9}\\right)=\\log_{2}(2)-\\log_{2}(9)=1-2\\log_{2}(3)$ 来简化每个对数项。则\n$$\nJSD(P||Q)=0.8\\left(4-2\\log_{2}(3)\\right)+0.1\\left(1-2\\log_{2}(3)\\right)=3.3-1.8\\log_{2}(3).\n$$\n为了得到以比特为单位的数值，使用 $\\log_{2}(3)\\approx 1.5849625007$：\n$$\nJSD(P||Q)\\approx 3.3-1.8\\times 1.5849625007\\approx 3.3-2.8529325013\\approx 0.4470674987.\n$$\n四舍五入到四位有效数字，得到 $0.4471$ 比特。", "answer": "$$\\boxed{0.4471}$$", "id": "1634129"}, {"introduction": "在实际应用中，我们常常需要比较遵循特定统计模型的分布，而不仅仅是简单的概率向量。这个问题要求你比较两个二项分布，这是为固定次数试验的随机过程建模的基础。在应用 JSD 公式之前，你首先需要计算每个分布的概率质量函数，这让你能熟练地将 JSD 应用于更真实的情景中。[@problem_id:1634170]", "problem": "考虑制造一个部件的两种不同工艺，工艺 A 和工艺 B。两种工艺都可能导致部件出现 0、1 或 2 个缺陷，由 $k \\in \\{0, 1, 2\\}$ 索引。\n\n来自工艺 A 的部件具有 $k$ 个缺陷的概率由概率质量函数 $P(k)$ 给出，定义为：\n$$\nP(k) = \\binom{2}{k} (0.5)^{k} (1 - 0.5)^{2-k}\n$$\n来自工艺 B 的部件具有 $k$ 个缺陷的概率由概率质量函数 $Q(k)$ 给出，定义为：\n$$\nQ(k) = \\binom{2}{k} (0.25)^{k} (1 - 0.25)^{2-k}\n$$\n为了量化这两种制造工艺之间的差异，我们可以计算一个对称散度得分 $S$。该得分通过两个步骤计算。首先，我们定义一个混合概率分布 $M(k)$，作为这两个分布的平均值：\n$$\nM(k) = \\frac{P(k) + Q(k)}{2}\n$$\n其次，我们使用以下公式计算得分 $S$：\n$$\nS = \\frac{1}{2} \\sum_{k=0}^{2} \\left[ P(k) \\ln\\left(\\frac{P(k)}{M(k)}\\right) + Q(k) \\ln\\left(\\frac{Q(k)}{M(k)}\\right) \\right]\n$$\n其中 $\\ln$ 表示自然对数。\n\n计算差异得分 $S$ 的数值。将您的最终答案四舍五入到四位有效数字。", "solution": "给定两个关于 $k \\in \\{0,1,2\\}$ 的二项概率质量函数：$P(k)$ 的参数为 $n=2, p=\\frac{1}{2}$，$Q(k)$ 的参数为 $n=2, p=\\frac{1}{4}$。使用二项式公式，\n$$\nP(k) = \\binom{2}{k}\\left(\\frac{1}{2}\\right)^{k}\\left(1-\\frac{1}{2}\\right)^{2-k}, \n\\quad\nQ(k) = \\binom{2}{k}\\left(\\frac{1}{4}\\right)^{k}\\left(1-\\frac{1}{4}\\right)^{2-k}.\n$$\n对每个 $k$ 求值可得\n$$\nP(0)=\\frac{1}{4},\\quad P(1)=\\frac{1}{2},\\quad P(2)=\\frac{1}{4},\n$$\n$$\nQ(0)=\\left(\\frac{3}{4}\\right)^{2}=\\frac{9}{16},\\quad Q(1)=2\\cdot\\frac{1}{4}\\cdot\\frac{3}{4}=\\frac{3}{8},\\quad Q(2)=\\left(\\frac{1}{4}\\right)^{2}=\\frac{1}{16}.\n$$\n混合分布 $M(k)=\\frac{P(k)+Q(k)}{2}$ 则为\n$$\nM(0)=\\frac{\\frac{1}{4}+\\frac{9}{16}}{2}=\\frac{13}{32},\\quad\nM(1)=\\frac{\\frac{1}{2}+\\frac{3}{8}}{2}=\\frac{7}{16},\\quad\nM(2)=\\frac{\\frac{1}{4}+\\frac{1}{16}}{2}=\\frac{5}{32}.\n$$\n差异得分为\n$$\nS=\\frac{1}{2}\\sum_{k=0}^{2}\\left[P(k)\\ln\\!\\left(\\frac{P(k)}{M(k)}\\right)+Q(k)\\ln\\!\\left(\\frac{Q(k)}{M(k)}\\right)\\right].\n$$\n计算每个 $k$ 的比率：\n$$\n\\frac{P(0)}{M(0)}=\\frac{\\frac{1}{4}}{\\frac{13}{32}}=\\frac{8}{13},\\quad\n\\frac{Q(0)}{M(0)}=\\frac{\\frac{9}{16}}{\\frac{13}{32}}=\\frac{18}{13},\n$$\n$$\n\\frac{P(1)}{M(1)}=\\frac{\\frac{1}{2}}{\\frac{7}{16}}=\\frac{8}{7},\\quad\n\\frac{Q(1)}{M(1)}=\\frac{\\frac{3}{8}}{\\frac{7}{16}}=\\frac{6}{7},\n$$\n$$\n\\frac{P(2)}{M(2)}=\\frac{\\frac{1}{4}}{\\frac{5}{32}}=\\frac{8}{5},\\quad\n\\frac{Q(2)}{M(2)}=\\frac{\\frac{1}{16}}{\\frac{5}{32}}=\\frac{2}{5}.\n$$\n因此 $S$ 内的求和项分解为\n$$\n\\sum_{k=0}^{2}\\left[P(k)\\ln\\!\\left(\\frac{P(k)}{M(k)}\\right)+Q(k)\\ln\\!\\left(\\frac{Q(k)}{M(k)}\\right)\\right]\n= C_{0}+C_{1}+C_{2},\n$$\n其中\n$$\nC_{0}=\\frac{1}{4}\\ln\\!\\left(\\frac{8}{13}\\right)+\\frac{9}{16}\\ln\\!\\left(\\frac{18}{13}\\right),\\quad\nC_{1}=\\frac{1}{2}\\ln\\!\\left(\\frac{8}{7}\\right)+\\frac{3}{8}\\ln\\!\\left(\\frac{6}{7}\\right),\\quad\nC_{2}=\\frac{1}{4}\\ln\\!\\left(\\frac{8}{5}\\right)+\\frac{1}{16}\\ln\\!\\left(\\frac{2}{5}\\right).\n$$\n使用对数性质 $\\ln\\!\\left(\\frac{a}{b}\\right)=\\ln a-\\ln b$ 然后进行数值计算，\n$$\n\\ln\\!\\left(\\frac{8}{13}\\right)\\approx -0.485507816,\\quad\n\\ln\\!\\left(\\frac{18}{13}\\right)\\approx 0.325422400,\\quad\n\\ln\\!\\left(\\frac{8}{7}\\right)\\approx 0.133531393,\\quad\n\\ln\\!\\left(\\frac{6}{7}\\right)\\approx -0.154150680,\n$$\n$$\n\\ln\\!\\left(\\frac{8}{5}\\right)\\approx 0.470003629,\\quad\n\\ln\\!\\left(\\frac{2}{5}\\right)\\approx -0.916290732.\n$$\n因此\n$$\nC_{0}\\approx \\frac{1}{4}(-0.485507816)+\\frac{9}{16}(0.325422400)\\approx 0.061673146,\n$$\n$$\nC_{1}\\approx \\frac{1}{2}(0.133531393)+\\frac{3}{8}(-0.154150680)\\approx 0.008959191,\n$$\n$$\nC_{2}\\approx \\frac{1}{4}(0.470003629)+\\frac{1}{16}(-0.916290732)\\approx 0.060232737.\n$$\n求和得到\n$$\n\\sum_{k=0}^{2}\\left[P(k)\\ln\\!\\left(\\frac{P(k)}{M(k)}\\right)+Q(k)\\ln\\!\\left(\\frac{Q(k)}{M(k)}\\right)\\right]\\approx 0.130865074,\n$$\n所以\n$$\nS=\\frac{1}{2}\\times 0.130865074\\approx 0.065432537.\n$$\n四舍五入到四位有效数字，差异得分为 $0.06543$。", "answer": "$$\\boxed{0.06543}$$", "id": "1634170"}, {"introduction": "在学会如何计算 JSD 之后，理解其性质以及其数值背后的含义至关重要。本练习通过要求你找出使两个相反的伯努利分布之间散度最大化的条件，来探索 JSD 的行为。这不仅将 JSD 与统计可区分性的概念联系起来，还揭示了它与熵的深刻关系，从而加深你对 JSD 的直观理解。[@problem_id:1634107]", "problem": "在信息论中，衡量两个概率分布之间差异性的一个基本度量是詹森-香农散度 (JSD)。JSD建立在Kullback-Leibler (KL)散度的基础上。\n\n对于定义在相同结果集$\\mathcal{X}$上的两个离散概率分布$P=\\{P(x)\\}$和$Q=\\{Q(x)\\}$，从$Q$到$P$的Kullback-Leibler (KL)散度由下式给出：\n$$D_{KL}(P || Q) = \\sum_{x \\in \\mathcal{X}} P(x) \\ln\\left(\\frac{P(x)}{Q(x)}\\right)$$\n对数的底是自然数$e$。\n\n詹森-香农散度 (JSD)是 KL 散度的一个对称化和平滑化版本，定义为：\n$$JSD(P || Q) = \\frac{1}{2} D_{KL}(P || M) + \\frac{1}{2} D_{KL}(Q || M)$$\n其中$M$是混合分布，对所有$x \\in \\mathcal{X}$，定义为 $M(x) = \\frac{1}{2}(P(x) + Q(x))$。\n\n考虑一个涉及两枚有偏硬币的场景。每次抛硬币的行为可以通过伯努利分布$\\text{Ber}(\\theta)$来建模，该分布描述了一个具有两种结果的实验，标记为$1$（正面）和$0$（反面）。得到正面的概率是$P(\\text{outcome}=1) = \\theta$，得到反面的概率是$P(\\text{outcome}=0) = 1-\\theta$。\n\n设第一枚硬币的行为由分布$P \\sim \\text{Ber}(p)$描述，第二枚硬币的行为由分布$Q \\sim \\text{Ber}(1-p)$描述，其中$p$为某个参数。$p$的定义域是闭区间$[0, 1]$。\n\n找出在区间$[0, 1]$上能使詹森-香农散度$JSD(P || Q)$最大化的所有$p$值。", "solution": "设在结果集$\\{0,1\\}$上，$P \\sim \\text{Ber}(p)$ 且 $Q \\sim \\text{Ber}(1-p)$，因此有$P(1)=p$，$P(0)=1-p$，$Q(1)=1-p$以及$Q(0)=p$。混合分布$M$为\n$$\nM(x)=\\frac{1}{2}\\big(P(x)+Q(x)\\big), \\quad x \\in \\{0,1\\}.\n$$\n因此\n$$\nM(1)=\\frac{1}{2}\\big(p+(1-p)\\big)=\\frac{1}{2}, \\qquad M(0)=\\frac{1}{2}\\big((1-p)+p\\big)=\\frac{1}{2}.\n$$\n于是$M$是参数为$\\frac{1}{2}$的公平伯努利分布，与$p$无关。\n\n计算$D_{KL}(P||M)$：\n$$\nD_{KL}(P||M)=\\sum_{x \\in \\{0,1\\}} P(x)\\ln\\!\\left(\\frac{P(x)}{M(x)}\\right)\n= p \\ln\\!\\left(\\frac{p}{1/2}\\right) + (1-p)\\ln\\!\\left(\\frac{1-p}{1/2}\\right).\n$$\n这可以简化为\n$$\nD_{KL}(P||M)=p \\ln(2p) + (1-p)\\ln\\big(2(1-p)\\big)\n= \\ln 2 + p \\ln p + (1-p)\\ln(1-p).\n$$\n根据对称性，对$Q$进行相同的计算可得\n$$\nD_{KL}(Q||M)=\\ln 2 + (1-p)\\ln(1-p) + p \\ln p.\n$$\n因此，\n$$\nJSD(P||Q)=\\frac{1}{2}D_{KL}(P||M)+\\frac{1}{2}D_{KL}(Q||M)\n= \\ln 2 + p \\ln p + (1-p)\\ln(1-p),\n$$\n其中，根据连续性，当$p=0$和$p=1$时，使用约定$0\\ln 0=0$。\n\n为了在$p \\in [0,1]$上最大化$JSD(P||Q)$，我们对$p$求导：\n$$\n\\frac{d}{dp}\\,JSD(P||Q)=\\frac{d}{dp}\\big(\\ln 2 + p \\ln p + (1-p)\\ln(1-p)\\big)\n= \\ln p + 1 - \\big(\\ln(1-p) + 1\\big)\n= \\ln\\!\\left(\\frac{p}{1-p}\\right).\n$$\n临界点满足\n$$\n\\ln\\!\\left(\\frac{p}{1-p}\\right)=0 \\quad \\Longleftrightarrow \\quad \\frac{p}{1-p}=1 \\quad \\Longleftrightarrow \\quad p=\\frac{1}{2}.\n$$\n二阶导数是\n$$\n\\frac{d^{2}}{dp^{2}}\\,JSD(P||Q)=\\frac{1}{p}+\\frac{1}{1-p}=\\frac{1}{p(1-p)} > 0 \\quad \\text{for } p \\in (0,1),\n$$\n因此$p=\\frac{1}{2}$是一个严格最小值点。因此，在闭区间$[0,1]$上的最大值出现在端点$p=0$和$p=1$处（此时$JSD=\\ln 2$）。", "answer": "$$\\boxed{\\begin{pmatrix}0 & 1\\end{pmatrix}}$$", "id": "1634107"}]}