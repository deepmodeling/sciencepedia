{"hands_on_practices": [{"introduction": "掌握指数族的第一步是能够识别其在各种概率分布中的形式。本练习将引导你运用代数方法，将一个常见的几何分布重新表述为指数族的标准形式。通过这个过程，你将学会识别其关键组成部分——充分统计量 $T(x)$、自然参数 $\\eta$ 和对数配分函数 $A(\\eta)$，为理解更高级的概念打下坚实的基础。[@problem_id:1623491]", "problem": "在设计一个可靠的数据传输协议时，一位工程师对发送数据包的过程进行建模。每次传输尝试都是一次独立的伯努利试验，成功概率为 $p$，其中 $0 < p < 1$。令随机变量 $X$ 表示在第一次成功传输发生之前的失败尝试次数。$X$ 的概率质量函数由几何分布给出：\n$$P(X=x) = (1-p)^x p, \\quad \\text{for } x \\in \\{0, 1, 2, \\dots\\}$$\n任何可以写成如下形式的概率分布\n$$f(x|\\theta) = h(x) \\exp(\\eta(\\theta) T(x) - A(\\eta(\\theta)))$$\n都是指数族的一员。对于正则形式，我们使用自然参数 $\\eta = \\eta(\\theta)$ 并将分布写为：\n$$f(x|\\eta) = h(x) \\exp(\\eta T(x) - A(\\eta))$$\n其中 $h(x)$ 是基础测度，$T(x)$ 是充分统计量，$\\eta$ 是自然参数，而 $A(\\eta)$ 是对数配分函数（或累积量生成函数）。\n\n你的任务是将给定的几何分布表示成这种正则指数族形式。在 $\\eta = \\ln(1-p)$ 的情况下，以下哪个选项正确地标识了分量三元组 $(h(x), T(x), A(\\eta))$？\n\nA. $(h(x)=1, \\quad T(x)=x, \\quad A(\\eta)=-\\ln(1-e^\\eta))$\n\nB. $(h(x)=1, \\quad T(x)=x, \\quad A(\\eta)=\\eta - \\ln(1-e^\\eta))$\n\nC. $(h(x)=p, \\quad T(x)=x, \\quad A(\\eta)=0)$\n\nD. $(h(x)=1, \\quad T(x)=x, \\quad A(\\eta)=\\ln(1-e^\\eta))$\n\nE. $(h(x)=1, \\quad T(x)=1, \\quad A(\\eta)=-\\ln(1-e^\\eta))$", "solution": "我们从描述第一次成功前失败次数的几何分布概率质量函数开始：\n$$\nP(X=x) = (1-p)^{x} p,\\quad x \\in \\{0,1,2,\\dots\\}.\n$$\n令 $q = 1-p$，所以 $0<q<1$。题目指定自然参数为 $\\eta = \\ln(1-p)$，因此 $\\eta = \\ln q$ 且 $q = \\exp(\\eta)$，其中 $\\eta < 0$。\n\n用 $\\eta$ 来表示该概率质量函数：\n$$\nP(X=x) = (1-q) q^{x} = \\bigl(1-\\exp(\\eta)\\bigr)\\exp(\\eta x).\n$$\n为了将其写成正则指数族形式，\n$$\nf(x \\mid \\eta) = h(x)\\exp\\bigl(\\eta T(x) - A(\\eta)\\bigr),\n$$\n我们可以选择 $h(x)=1$ 和 $T(x)=x$。然后由归一化条件决定 $A(\\eta)$。我们要求\n$$\n\\sum_{x=0}^{\\infty} f(x \\mid \\eta) = \\sum_{x=0}^{\\infty} \\exp\\bigl(\\eta x - A(\\eta)\\bigr) = \\exp\\bigl(-A(\\eta)\\bigr)\\sum_{x=0}^{\\infty} \\exp(\\eta x) = 1.\n$$\n对于 $\\eta<0$，该几何级数的和为\n$$\n\\sum_{x=0}^{\\infty} \\exp(\\eta x) = \\frac{1}{1-\\exp(\\eta)}.\n$$\n因此，\n$$\n\\exp\\bigl(-A(\\eta)\\bigr)\\cdot \\frac{1}{1-\\exp(\\eta)} = 1\n\\quad\\Longrightarrow\\quad\n\\exp\\bigl(-A(\\eta)\\bigr) = 1 - \\exp(\\eta)\n\\quad\\Longrightarrow\\quad\n-A(\\eta) = \\ln\\bigl(1-\\exp(\\eta)\\bigr),\n$$\n所以\n$$\nA(\\eta) = -\\ln\\bigl(1-\\exp(\\eta)\\bigr).\n$$\n因此，正则形式由以下各项得到：\n$$\nh(x)=1,\\quad T(x)=x,\\quad A(\\eta)=-\\ln\\bigl(1-\\exp(\\eta)\\bigr),\n$$\n这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1623491"}, {"introduction": "一旦我们将一个分布表示为指数族形式，就能解锁许多强大的分析工具。这个练习将展示指数族最优雅的特性之一：通过对对数配分函数求导，便可以轻松计算出充分统计量的期望值（如均值）。通过解决这个问题，你将更深刻地体会到指数族的结构如何简化复杂的计算，并揭示分布的核心性质。[@problem_id:1623484]", "problem": "考虑一个离散随机变量 $X$，其定义域为整数集合 $\\{0, 1, 2\\}$。$X$ 的概率质量函数 (PMF) 由一个双参数的指数族描述，形式如下：\n$$p(x | \\eta_1, \\eta_2) = \\exp(\\eta_1 T_1(x) + \\eta_2 T_2(x) - A(\\eta_1, \\eta_2))$$\n其中 $\\eta_1$ 和 $\\eta_2$ 是自然参数，$A(\\eta_1, \\eta_2)$ 是对分布进行归一化的对数配分函数。基测度是均匀的，即对于定义域中的所有 $x$，都有 $h(x) = 1$。\n\n该族的充分统计量定义为：\n$T_1(x) = x$\n$T_2(x) = |x-1|$\n\n对于该分布的一个具体实例，给定自然参数为 $\\eta_1 = 1.0$ 和 $\\eta_2 = -1.0$。计算该随机变量的期望值 $E[X]$。\n\n将你的最终答案四舍五入到四位有效数字。", "solution": "指数族由下式给出\n$$p(x \\mid \\eta_{1},\\eta_{2})=\\exp\\!\\left(\\eta_{1}T_{1}(x)+\\eta_{2}T_{2}(x)-A(\\eta_{1},\\eta_{2})\\right),$$\n基测度为 $h(x)=1$，充分统计量为 $T_{1}(x)=x$, $T_{2}(x)=|x-1|$，对数配分函数为\n$$A(\\eta_{1},\\eta_{2})=\\ln\\!\\left(\\sum_{x\\in\\{0,1,2\\}}\\exp\\!\\left(\\eta_{1}x+\\eta_{2}|x-1|\\right)\\right)。$$\n指数族的一个标准性质是\n$$E[T_{1}(X)]=\\frac{\\partial A}{\\partial \\eta_{1}},$$\n所以 $E[X]=\\frac{\\partial A}{\\partial \\eta_{1}}$。\n\n对于 $\\eta_{1}=1$ 和 $\\eta_{2}=-1$，计算未归一化的权重\n$$w(x)=\\exp\\!\\left(\\eta_{1}x+\\eta_{2}|x-1|\\right)。$$\n对于 $x=0,1,2$：\n$$w(0)=\\exp(-1),\\quad w(1)=\\exp(1),\\quad w(2)=\\exp(1)。$$\n因此配分函数是\n$$Z=\\sum_{x}w(x)=\\exp(-1)+2\\exp(1),\\quad A=\\ln Z。$$\n那么\n$$E[X]=\\frac{\\partial A}{\\partial \\eta_{1}}=\\frac{1}{Z}\\sum_{x}x\\,w(x)=\\frac{0\\cdot \\exp(-1)+1\\cdot \\exp(1)+2\\cdot \\exp(1)}{\\exp(-1)+2\\exp(1)}=\\frac{3\\exp(1)}{\\exp(-1)+2\\exp(1)}=\\frac{3\\exp(2)}{1+2\\exp(2)}。$$\n数值上，\n$$E[X]\\approx \\frac{3\\exp(2)}{1+2\\exp(2)}\\approx 1.404931605,$$\n其结果四舍五入到四位有效数字为 $1.405$。", "answer": "$$\\boxed{1.405}$$", "id": "1623484"}, {"introduction": "我们已经学习了如何分析和使用指数族，但它们从何而来？最大熵原理为我们提供了一个深刻的答案。这个问题要求你在给定某些观测数据（一个平均能量值）的约束下，推导出最无偏的概率分布，这是最大熵原理的一个典型应用。你将亲眼见证，在约束条件下最大化熵会自然地产生一个属于指数族的分布，从而揭示信息论原理与这类基本统计模型之间的深刻联系。[@problem_id:1623482]", "problem": "已知一个物理系统拥有三个离散能级，$E_1=\\epsilon_0, E_2=2\\epsilon_0, E_3=3\\epsilon_0$，其中 $\\epsilon_0$ 是一个正能量常数。通过对在相同条件下制备的大量相同系统组成的系综进行一系列测量，测得其平均能量为 $\\langle E \\rangle = \\frac{7}{3}\\epsilon_0$。根据最大熵原理，假设系统的状态分布 $\\{p_1, p_2, p_3\\}$ 是与此观测平均能量一致且具有最大可能熵的分布。计算系统处于第二能级 $E_2$ 的概率 $p_2$。请用一个单一的闭合形式解析表达式表示你的答案。", "solution": "该问题要求解在特定约束条件下，使 Shannon 熵最大化的概率分布 $\\{p_1, p_2, p_3\\}$。Shannon 熵由 $H(p_1, p_2, p_3) = - \\sum_{i=1}^{3} p_i \\ln(p_i)$ 给出。\n\n关于概率的约束条件是：\n1. 归一化：所有概率之和必须为 1。\n$$g_1(p_1, p_2, p_3) = \\sum_{i=1}^{3} p_i - 1 = p_1 + p_2 + p_3 - 1 = 0$$\n2. 平均能量：能量的期望值必须与观测值相符。\n$$g_2(p_1, p_2, p_3) = \\sum_{i=1}^{3} p_i E_i - \\langle E \\rangle = p_1 E_1 + p_2 E_2 + p_3 E_3 - \\langle E \\rangle = 0$$\n\n我们使用 Lagrange 乘数法来解决这个约束优化问题。构建拉格朗日量 $\\mathcal{L}$ 如下：\n$$\\mathcal{L}(p_1, p_2, p_3, \\lambda_1, \\lambda_2) = H - \\lambda_1 g_1 - \\lambda_2 g_2$$\n$$\\mathcal{L} = -\\sum_{i=1}^{3} p_i \\ln(p_i) - \\lambda_1 (p_1+p_2+p_3-1) - \\lambda_2 (p_1 E_1 + p_2 E_2 + p_3 E_3 - \\langle E \\rangle)$$\n为求最大值，我们计算 $\\mathcal{L}$ 对每个 $p_i$ 的偏导数并令其为零。\n$$\\frac{\\partial \\mathcal{L}}{\\partial p_i} = -(\\ln(p_i) + 1) - \\lambda_1 - \\lambda_2 E_i = 0$$\n求解 $p_i$：\n$$\\ln(p_i) = -1 - \\lambda_1 - \\lambda_2 E_i$$\n$$p_i = \\exp(-1 - \\lambda_1 - \\lambda_2 E_i) = \\exp(-1-\\lambda_1) \\exp(-\\lambda_2 E_i)$$\n我们定义一个新常数 $\\beta = \\lambda_2$。项 $\\exp(-1-\\lambda_1)$ 是一个常数，可以通过归一化约束来确定。我们称其为 $1/Z$。于是，概率分布呈现为 Boltzmann 分布的形式，它是指数族的一员：\n$$p_i = \\frac{1}{Z} \\exp(-\\beta E_i)$$\n归一化常数 $Z$，也称为配分函数，通过对所有概率求和得到：\n$$Z = \\sum_{i=1}^{3} \\exp(-\\beta E_i)$$\n\n现在，我们使用给定的值：$E_1=\\epsilon_0, E_2=2\\epsilon_0, E_3=3\\epsilon_0$ 以及 $\\langle E \\rangle = \\frac{7}{3}\\epsilon_0$。平均能量约束为：\n$$\\langle E \\rangle = \\sum_{i=1}^{3} p_i E_i = \\frac{1}{Z} \\sum_{i=1}^{3} E_i \\exp(-\\beta E_i) = \\frac{7}{3}\\epsilon_0$$\n代入 $E_i$ 的表达式：\n$$\\frac{\\epsilon_0 \\exp(-\\beta \\epsilon_0) + 2\\epsilon_0 \\exp(-2\\beta \\epsilon_0) + 3\\epsilon_0 \\exp(-3\\beta \\epsilon_0)}{\\exp(-\\beta \\epsilon_0) + \\exp(-2\\beta \\epsilon_0) + \\exp(-3\\beta \\epsilon_0)} = \\frac{7}{3}\\epsilon_0$$\n常数 $\\epsilon_0$ 从等式两边消去。我们引入一个变量 $x = \\exp(-\\beta \\epsilon_0)$。方程变为：\n$$\\frac{x + 2x^2 + 3x^3}{x + x^2 + x^3} = \\frac{7}{3}$$\n因为 $x$ 不能为零（否则概率将无定义），我们可以从分子和分母中提出因子 $x$：\n$$\\frac{1 + 2x + 3x^2}{1 + x + x^2} = \\frac{7}{3}$$\n现在我们求解 $x$：\n$$3(1 + 2x + 3x^2) = 7(1 + x + x^2)$$\n$$3 + 6x + 9x^2 = 7 + 7x + 7x^2$$\n$$2x^2 - x - 4 = 0$$\n这是一个关于 $x$ 的二次方程。使用二次求根公式 $x = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$：\n$$x = \\frac{1 \\pm \\sqrt{(-1)^2 - 4(2)(-4)}}{2(2)} = \\frac{1 \\pm \\sqrt{1 + 32}}{4} = \\frac{1 \\pm \\sqrt{33}}{4}$$\n由于 $x = \\exp(-\\beta \\epsilon_0)$ 且 $\\epsilon_0>0$ 是一个物理能量，$\\beta$ 必须是实数，这意味着 $x$ 必须是一个正实数。因此，我们取正根：\n$$x = \\frac{1 + \\sqrt{33}}{4}$$\n问题要求的是概率 $p_2$。我们用 $x$ 来表示 $p_2$：\n$$p_2 = \\frac{\\exp(-2\\beta\\epsilon_0)}{Z} = \\frac{\\exp(-2\\beta\\epsilon_0)}{\\exp(-\\beta\\epsilon_0) + \\exp(-2\\beta\\epsilon_0) + \\exp(-3\\beta\\epsilon_0)}$$\n$$p_2 = \\frac{x^2}{x + x^2 + x^3} = \\frac{x}{1 + x + x^2}$$\n根据二次方程 $2x^2 - x - 4 = 0$，我们有 $x^2 = \\frac{x+4}{2}$。我们将此代入 $p_2$ 表达式的分母中：\n$$1 + x + x^2 = 1 + x + \\frac{x+4}{2} = \\frac{2 + 2x + x + 4}{2} = \\frac{3x+6}{2}$$\n现在将此结果代回到 $p_2$ 的表达式中：\n$$p_2 = \\frac{x}{\\frac{3x+6}{2}} = \\frac{2x}{3x+6} = \\frac{2x}{3(x+2)}$$\n最后，我们代入 $x = \\frac{1+\\sqrt{33}}{4}$ 的值：\n$$p_2 = \\frac{2(\\frac{1+\\sqrt{33}}{4})}{3(\\frac{1+\\sqrt{33}}{4} + 2)} = \\frac{\\frac{1+\\sqrt{33}}{2}}{3(\\frac{1+\\sqrt{33}+8}{4})} = \\frac{1+\\sqrt{33}}{2} \\cdot \\frac{4}{3(9+\\sqrt{33})} = \\frac{2(1+\\sqrt{33})}{3(9+\\sqrt{33})}$$\n为简化起见，我们将分子和分母同乘以 $(9+\\sqrt{33})$ 的共轭项 $(9-\\sqrt{33})$，以使分母有理化：\n$$p_2 = \\frac{2(1+\\sqrt{33})(9-\\sqrt{33})}{3(9+\\sqrt{33})(9-\\sqrt{33})} = \\frac{2(9 - \\sqrt{33} + 9\\sqrt{33} - 33)}{3(9^2 - (\\sqrt{33})^2)} = \\frac{2(8\\sqrt{33} - 24)}{3(81 - 33)}$$\n$$p_2 = \\frac{2 \\cdot 8(\\sqrt{33} - 3)}{3(48)} = \\frac{16(\\sqrt{33} - 3)}{144}$$\n简化分数 $\\frac{16}{144} = \\frac{1}{9}$：\n$$p_2 = \\frac{\\sqrt{33} - 3}{9}$$", "answer": "$$\\boxed{\\frac{\\sqrt{33}-3}{9}}$$", "id": "1623482"}]}