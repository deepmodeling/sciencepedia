{"hands_on_practices": [{"introduction": "我们从一个看似简单却极具启发性的场景开始。想象一下，一个随机过程本应产生多种符号，但在一次极长的观测序列中，某个本应出现的符号却完全没有出现。这个练习将引导你计算这种极端稀有事件的概率指数，并将其与直接的概率计算联系起来 [@problem_id:1655867]。这不仅是一个很好的基础练习，也揭示了萨诺夫定理如何为我们直观理解的概率提供一个普适的理论框架。", "problem": "考虑一个源，其生成一个符号序列 $X_1, X_2, \\ldots, X_n$，这些符号是独立同分布 (i.i.d.) 的。这些符号从一个有限字母表 $\\mathcal{X} = \\{x_1, x_2, \\ldots, x_K\\}$ 中抽取，其中 $K \\ge 2$。生成符号 $x_k$ 的概率由 $p_k = \\text{Pr}(X_i = x_k)$ 给出，适用于任何 $i$。给定对于所有的 $k \\in \\{1, 2, \\ldots, K\\}$，都有 $p_k > 0$。\n\n对于一个长度为 $n$ 的很长序列，符号 $x_k$ 的经验频率是它在该序列中出现的比例。特定符号 $x_K$ 的经验频率恰好为零的概率是一个罕见事件。当 $n$ 很大时，该概率可以很好地近似为以下形式：\n$$ \\text{Pr}(x_K \\text{的经验频率为} 0) \\approx \\exp(-nC) $$\n其中 $C$ 是一个依赖于源概率的正常数。\n\n请确定常数 $C$，将其表示为关于概率 $p_K$ 的解析表达式。", "solution": "设 $X_{1},\\ldots,X_{n}$ 是在 $\\mathcal{X}$ 上独立同分布的随机变量，满足 $\\text{Pr}(X_{i}=x_{K})=p_{K}$ 且 $0<p_{K}<1$。$x_{K}$ 的经验频率为零的事件，等价于 $x_{K}$ 在 $n$ 次独立抽取中从未出现的事件。根据独立性，\n$$\n\\text{Pr}(n\\text{次抽取中没有 }x_{K})=(1-p_{K})^{n}.\n$$\n使用对数将此概率重写为指数形式：\n$$\n(1-p_{K})^{n}=\\exp\\!\\big(n\\ln(1-p_{K})\\big)=\\exp\\!\\big(-n\\big[-\\ln(1-p_{K})\\big]\\big).\n$$\n与渐近形式 $\\exp(-nC)$ 比较，我们确定\n$$\nC=-\\ln(1-p_{K}).\n$$\n由于 $0<p_{K}<1$，我们有 $1-p_{K}\\in(0,1)$，因此 $-\\ln(1-p_{K})>0$，所以 $C$ 是所要求的正数。\n\n为完整起见，同样的常数可以由大偏差理论（Sanov’s theorem）导出：在满足 $q_{K}=0$ 的所有分布 $q$ 上最小化相对熵 $D(q\\|p)$，可得最优化解为 $q_{i}=p_{i}/(1-p_{K})$ (对 $i<K$ 成立)，且\n$$\nD(q\\|p)=\\sum_{i<K}q_{i}\\ln\\!\\left(\\frac{q_{i}}{p_{i}}\\right)=\\sum_{i<K}q_{i}\\ln\\!\\left(\\frac{1}{1-p_{K}}\\right)=\\ln\\!\\left(\\frac{1}{1-p_{K}}\\right)=-\\ln(1-p_{K}),\n$$\n与上面得到的常数一致。", "answer": "$$\\boxed{-\\ln(1-p_{K})}$$", "id": "1655867"}, {"introduction": "从“零频率”事件过渡到“特定频率”事件，我们来探讨一个更常见的大偏差问题。一个有偏的随机过程（例如有固定次品率的生产线）碰巧产生了一个看起来完全“公平”或“均衡”的结果，这种情况的概率有多大？这个练习将让你运用萨诺夫定理，通过计算K-L散度来直接量化这种偏离期望的事件的发生率 [@problem_id:1655921]，让你掌握大偏差率函数的核心计算方法。", "problem": "一家工厂生产大量微芯片。由于一个持续存在的制造缺陷，每个芯片有 $p = 1/3$ 的概率是次品。质量控制过程包括测试一长串随机抽取的 $n$ 个芯片。测试结果被认为是独立同分布 (i.i.d.) 的随机变量。\n\n设 $N_G$ 为长度为 $n$ 的测试序列中合格芯片的数量，$N_F$ 为次品的数量。当测试芯片数量非常大时（即 $n \\to \\infty$），观测到的次品分数 $N_F/n$ 显著偏离真实概率 $p$ 的概率，已知遵循大偏差原理 (Large Deviation Principle)。这意味着观测到一个不寻ormal事件的概率随 $n$ 指数衰减：\n$$P(\\text{event}) \\approx \\exp(-nI)$$\n其中 $I$ 是一个称为速率函数 (rate function) 的正常数，其值取决于具体的事件。\n\n考虑事件：序列中合格芯片的数量与次品芯片的数量完全相等。计算此事件的速率函数 $I$ 的值。请以单个、闭合形式的解析表达式给出您的答案。", "solution": "令 $X_{i} \\in \\{0,1\\}$ 表示第 $i$ 个测试的芯片是否为次品，其中 $P(X_{i}=1)=p=\\frac{1}{3}$ 且 $P(X_{i}=0)=1-p=\\frac{2}{3}$。和 $S_{n}=\\sum_{i=1}^{n}X_{i}=N_{F}$ 是次品芯片的总数，而事件 $N_{G}=N_{F}$ (对于偶数 $n$) 等价于 $S_{n}=\\frac{n}{2}$，即经验分数 $\\hat{q}_{n}=S_{n}/n$ 等于 $q=\\frac{1}{2}$。\n\n根据 Cramér 定理（或针对伯努利测度的 Sanov 定理），经验均值 $\\hat{q}_{n}$ 满足一个大偏差原理，其速率函数为\n$$\nI(q)=\\sup_{t \\in \\mathbb{R}}\\{tq-\\Lambda(t)\\},\\qquad \\Lambda(t)=\\ln\\big((1-p)+p\\exp(t)\\big).\n$$\n为计算 $I(q)$，需最大化 $tq-\\Lambda(t)$。一阶条件是\n$$\n0=\\frac{\\partial}{\\partial t}\\big(tq-\\Lambda(t)\\big)=q-\\Lambda'(t),\\qquad \\Lambda'(t)=\\frac{p\\exp(t)}{(1-p)+p\\exp(t)}.\n$$\n解方程 $q=\\Lambda'(t)$ 得\n$$\nq=\\frac{p\\exp(t)}{(1-p)+p\\exp(t)}\\;\\;\\Longrightarrow\\;\\;\\exp(t^{\\ast})=\\frac{q(1-p)}{(1-q)p}.\n$$\n在 $t^{\\ast}$ 处计算上确界：\n$$\nI(q)=q\\,t^{\\ast}-\\Lambda(t^{\\ast})\n= q\\ln\\!\\left(\\frac{q(1-p)}{(1-q)p}\\right) - \\ln\\!\\left((1-p)+p\\frac{q(1-p)}{(1-q)p}\\right).\n$$\n由于 $(1-p)+p\\frac{q(1-p)}{(1-q)p}=\\frac{1-p}{1-q}$，该式可简化为 Kullback–Leibler 散度\n$$\nI(q)=q\\ln\\!\\left(\\frac{q}{p}\\right) + (1-q)\\ln\\!\\left(\\frac{1-q}{1-p}\\right).\n$$\n对于事件 $N_{G}=N_{F}$，我们有 $q=\\frac{1}{2}$ 和 $p=\\frac{1}{3}$，因此\n$$\nI= \\frac{1}{2}\\ln\\!\\left(\\frac{\\frac{1}{2}}{\\frac{1}{3}}\\right) + \\frac{1}{2}\\ln\\!\\left(\\frac{\\frac{1}{2}}{\\frac{2}{3}}\\right)\n= \\frac{1}{2}\\left[\\ln\\!\\left(\\frac{3}{2}\\right) + \\ln\\!\\left(\\frac{3}{4}\\right)\\right]\n= \\frac{1}{2}\\ln\\!\\left(\\frac{9}{8}\\right).\n$$\n此速率决定了当 $n$ 为偶数时 $P(N_{F}=n/2)$ 的行为；当 $n$ 为奇数时该事件不可能发生，但这不影响沿偶数子序列的指数衰减率。", "answer": "$$\\boxed{\\frac{1}{2}\\ln\\!\\left(\\frac{9}{8}\\right)}$$", "id": "1655921"}, {"introduction": "现在，让我们将概念再推进一步。如果我们关心的不是某个特定的经验分布，而是一整类满足特定结构性质的分布，该怎么办？这个练习将向你展示如何计算一个分布*集合*的大偏差率 [@problem_id:1655912]。它引入了信息投影的强大思想：在所有符合条件的“目标”分布中，找到那个与真实分布“最接近”的分布，其距离（K-L散度）即为我们所求的速率函数。", "problem": "某个随机过程从字母表 $\\mathcal{X} = \\{A, B, C\\}$ 中生成一个符号序列。这些符号是独立同分布地生成的，遵循概率分布 $Q$，其中 $Q(A) = 1/2$，$Q(B) = 1/4$，且 $Q(C) = 1/4$。\n\n我们观测一个长度为 $n$ 的长符号序列，并计算其经验频率分布 $P = (p_A, p_B, p_C)$，其中 $p_x$ 是符号 $x$ 在该序列中出现的比例。我们关心的是观测到的经验分布属于一个特定集合 $\\mathcal{E}$ 的概率。该集合 $\\mathcal{E}$ 包含了 $\\mathcal{X}$ 上所有满足以下条件的概率分布：'A' 的概率是 'B' 和 'C' 的概率的算术平均值。\n\n根据关于大偏差的 Sanov 定理，对于大量的观测次数 $n$，这个概率可近似表示为 $P(P \\in \\mathcal{E}) \\approx \\exp(-n I)$，其中 $I$ 是速率常数。这个常数是从源分布 $Q$ 到集合 $\\mathcal{E}$ 中任意分布 $P$ 的 Kullback-Leibler (KL) 散度的最小值：\n$$I = \\inf_{P \\in \\mathcal{E}} D_{KL}(P || Q)$$\nKL 散度由以下公式给出：$D_{KL}(P || Q) = \\sum_{x \\in \\{A, B, C\\}} p_x \\ln\\left(\\frac{p_x}{q_x}\\right)$。\n\n确定速率常数 $I$ 的值。请以单个闭式解析表达式给出答案，单位为奈特。", "solution": "我们要计算 Sanov 速率\n$$I=\\inf_{P\\in\\mathcal{E}}D_{KL}(P\\|Q),\\quad D_{KL}(P\\|Q)=\\sum_{x\\in\\{A,B,C\\}}p_{x}\\ln\\left(\\frac{p_{x}}{q_{x}}\\right),$$\n其中 $Q(A)=\\frac{1}{2}$，$Q(B)=\\frac{1}{4}$，$Q(C)=\\frac{1}{4}$，并且 $\\mathcal{E}=\\{P:\\,p_{A}=(p_{B}+p_{C})/2\\}$。\n\n设 $P=(a,b,c)$，其中 $a=p_{A}$，$b=p_{B}$，$c=p_{C}$。约束条件为\n$$a=\\frac{b+c}{2},\\qquad a+b+c=1,\\qquad a,b,c\\geq 0.$$\n将 $a=\\frac{b+c}{2}$ 代入归一化条件可得\n$$\\frac{b+c}{2}+b+c=1\\;\\;\\Longrightarrow\\;\\;\\frac{3}{2}(b+c)=1\\;\\;\\Longrightarrow\\;\\;b+c=\\frac{2}{3},\\quad a=\\frac{1}{3}.$$\n因此，$\\mathcal{E}$ 化简为线段 $\\{(a,b,c):a=\\frac{1}{3},\\,b+c=\\frac{2}{3},\\,b,c\\geq 0\\}$。\n\n我们在这个线段上最小化 $D_{KL}(P\\|Q)$。由于 $q_{B}=q_{C}$ 且约束条件对 $b$ 和 $c$ 是对称的，根据对称性和严格凸性，最小值点满足 $b=c$。为进行形式化推导，我们在 $b+c=\\frac{2}{3}$ 且 $a=\\frac{1}{3}$ 的约束下最小化\n$$f(b,c)=a\\ln\\left(\\frac{a}{q_{A}}\\right)+b\\ln\\left(\\frac{b}{q_{B}}\\right)+c\\ln\\left(\\frac{c}{q_{C}}\\right),$$\n对约束 $b+c=\\frac{2}{3}$ 使用拉格朗日乘子 $\\lambda$，平稳点条件为\n$$\\frac{\\partial}{\\partial b}\\left[b\\ln\\left(\\frac{b}{q_{B}}\\right)\\right]=\\ln\\left(\\frac{b}{q_{B}}\\right)+1=\\lambda,\\qquad \\frac{\\partial}{\\partial c}\\left[c\\ln\\left(\\frac{c}{q_{C}}\\right)\\right]=\\ln\\left(\\frac{c}{q_{C}}\\right)+1=\\lambda.$$\n因此 $\\ln\\left(\\frac{b}{q_{B}}\\right)=\\ln\\left(\\frac{c}{q_{C}}\\right)$，所以 $\\frac{b}{q_{B}}=\\frac{c}{q_{C}}$。由于 $q_{B}=q_{C}=\\frac{1}{4}$，这得出 $b=c$。结合 $b+c=\\frac{2}{3}$，我们得到 $b=c=\\frac{1}{3}$，因此 $a=\\frac{1}{3}$。该点是可行的（严格为正），并且根据 $D_{KL}$ 的严格凸性，它是唯一的最小值点。\n\n因此，I-投影为 $P^{\\star}=(\\frac{1}{3},\\frac{1}{3},\\frac{1}{3})$，速率常数为\n$$I=D_{KL}(P^{\\star}\\|Q)=\\frac{1}{3}\\ln\\left(\\frac{\\frac{1}{3}}{\\frac{1}{2}}\\right)+\\frac{1}{3}\\ln\\left(\\frac{\\frac{1}{3}}{\\frac{1}{4}}\\right)+\\frac{1}{3}\\ln\\left(\\frac{\\frac{1}{3}}{\\frac{1}{4}}\\right).$$\n计算每一项：$\\frac{\\frac{1}{3}}{\\frac{1}{2}}=\\frac{2}{3}$ 且 $\\frac{\\frac{1}{3}}{\\frac{1}{4}}=\\frac{4}{3}$。因此\n$$I=\\frac{1}{3}\\ln\\left(\\frac{2}{3}\\right)+\\frac{2}{3}\\ln\\left(\\frac{4}{3}\\right)=\\frac{1}{3}\\ln\\left(\\frac{2}{3}\\cdot\\left(\\frac{4}{3}\\right)^{2}\\right)=\\frac{1}{3}\\ln\\left(\\frac{32}{27}\\right).$$\n等价地，$I=\\frac{5}{3}\\ln 2-\\ln 3$。两者都是以奈特为单位的单个闭式解析表达式。", "answer": "$$\\boxed{\\frac{1}{3}\\ln\\left(\\frac{32}{27}\\right)}$$", "id": "1655912"}]}