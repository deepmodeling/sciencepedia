{"hands_on_practices": [{"introduction": "让我们从一个引人入胜的例子开始，它揭示了对数最优投资组合理论的一个核心优势。即使单个资产长期来看是亏损的，通过巧妙的多元化和再平衡，我们也能构建一个盈利的投资组合 [@problem_id:1638083]。这个练习将通过计算来具体展示这一看似矛盾却极其重要的“波动性”收益现象。", "problem": "一位投资者正在分析一个简化的、波动的市场，该市场由两只相互竞争的科技股 QuantaLeap 和 Photonix 组成。市场有两种可能的、等概率的未来状态：“牛市”和“熊市”，每种状态发生的概率均为 $0.5$。在这两种状态下，这些股票的表现是负相关的。\n\n在牛市状态下，QuantaLeap的价值乘以一个因子 $u$，而Photonix的价值乘以一个因子 $d$。\n在熊市状态下，QuantaLeap的价值乘以一个因子 $d$，而Photonix的价值乘以一个因子 $u$。\n\n假设 $u > d > 0$ 且 $ud < 1$。后一个条件意味着，基于几何平均数，从长远来看，单独持有任何一只股票都是一个亏损的命题。\n\n投资组合的长期平均对数增长率 $W$ 由以下公式给出：\n$$W = \\sum_{s} p_s \\ln(R_s)$$\n其中 $p_s$ 是市场状态 $s$ 发生的概率，而 $R_s$ 是投资组合在该状态下的总回报因子。\n\n该投资者考虑两种策略：\n1.  **单一股票策略**：将100%的资本投入单一股票（例如 QuantaLeap）。此策略的增长率记为 $W_{single}$。由于问题的对称性，完全投资于 Photonix 将产生相同的增长率。\n2.  **多元化策略**：将50%的资本投资于 QuantaLeap，50%投资于 Photonix。此策略的增长率记为 $W_{div}$。\n\n计算比率 $\\frac{W_{div}}{W_{single}}$。请将您的答案表示为一个关于 $u$ 和 $d$ 的闭式解析表达式。", "solution": "存在两种等概率的市场状态，牛市和熊市，每种状态的概率为 $\\frac{1}{2}$。设 $u>d>0$ 且 $ud<1$。\n\n对于单一股票策略（例如，全部投资于 QuantaLeap），在牛市状态下，单周期回报因子为 $R_{\\text{Bullish}}=u$；在熊市状态下，为 $R_{\\text{Bearish}}=d$。根据给定的长期平均对数增长率的定义，\n$$\nW_{\\text{single}}=\\sum_{s}p_{s}\\ln(R_{s})=\\frac{1}{2}\\ln(u)+\\frac{1}{2}\\ln(d)=\\frac{1}{2}\\ln(ud).\n$$\n\n对于通过持续再平衡以维持50-50比例的多元化策略，在任一状态下，投资组合的回报因子都是该状态下各成分股回报的加权和。在牛市状态下，投资组合的回报为\n$$\nR_{\\text{Bullish}}=\\frac{1}{2}u+\\frac{1}{2}d=\\frac{u+d}{2},\n$$\n在熊市状态下，\n$$\nR_{\\text{Bearish}}=\\frac{1}{2}d+\\frac{1}{2}u=\\frac{u+d}{2}.\n$$\n因此，回报因子与市场状态无关，其增长率为\n$$\nW_{\\text{div}}=\\sum_{s}p_{s}\\ln(R_{s})=\\ln\\!\\left(\\frac{u+d}{2}\\right).\n$$\n\n因此，所求的比率为\n$$\n\\frac{W_{\\text{div}}}{W_{\\text{single}}}=\\frac{\\ln\\!\\left(\\frac{u+d}{2}\\right)}{\\frac{1}{2}\\ln(ud)}=\\frac{2\\,\\ln\\!\\left(\\frac{u+d}{2}\\right)}{\\ln(ud)}.\n$$", "answer": "$$\\boxed{\\frac{2\\,\\ln\\!\\left(\\frac{u+d}{2}\\right)}{\\ln(ud)}}$$", "id": "1638083"}, {"introduction": "在领略了多元化投资的魅力之后，下一个自然的问题是：在更复杂的市场中，我们如何系统地计算出最优的资本配置比例？这个练习将带你深入理论核心，学习如何运用拉格朗日乘数法推导出确定对数最优投资组合的一般性方程组 [@problem_id:1638086]。掌握这个方法是应用凯利准则解决实际问题的基础。", "problem": "一位投资者正在通过在三种不同的投机性资产$A_1$、$A_2$和$A_3$之间分配资本来构建一个投资组合。市场有三种可能的未来状态$S_1$、$S_2$和$S_3$，它们发生的概率分别为$p_1$、$p_2$和$p_3$。这些资产的表现由一个财富相对数（回报因子）矩阵$X$描述，其中元素$X_{ij}$表示如果市场状态为$S_i$，资产$A_j$的乘法回报。例如，如果$X_{12} = 1.15$，这意味着资产$A_2$在状态$S_1$下有15%的收益。\n\n一个投资组合由权重向量$\\boldsymbol{b} = (b_1, b_2, b_3)$定义，其中$b_j$是投资于资产$A_j$的总资本的比例。如果状态$S_i$发生，投资组合$\\boldsymbol{b}$的回报由$W_i(\\boldsymbol{b}) = \\sum_{j=1}^3 b_j X_{ij}$给出。投资者希望找到对数最优投资组合，也称为 Kelly criterion 投资组合，即能够使投资组合回报的自然对数的期望值最大化的配置$\\boldsymbol{b}^*=(b_1, b_2, b_3)$。投资者投入其全部资本，这意味着投资组合的权重必须总和为1：$\\sum_{j=1}^3 b_j = 1$。\n\n下列哪个方程组正确地定义了最优配置$\\boldsymbol{b}$？\n\nA.\n$$\n\\begin{cases}\n\\sum_{i=1}^{3} p_i \\frac{X_{i1}}{W_i(\\boldsymbol{b})} = 0 \\\\\n\\sum_{i=1}^{3} p_i \\frac{X_{i2}}{W_i(\\boldsymbol{b})} = 0 \\\\\nb_1 + b_2 + b_3 = 1\n\\end{cases}\n$$\n\nB.\n$$\n\\begin{cases}\n\\sum_{i=1}^{3} p_i \\frac{X_{i1}}{W_i(\\boldsymbol{b})} = 1 \\\\\n\\sum_{i=1}^{3} p_i \\frac{X_{i2}}{W_i(\\boldsymbol{b})} = 1 \\\\\nb_1 + b_2 + b_3 = 1\n\\end{cases}\n$$\n\nC.\n$$\n\\begin{cases}\n\\sum_{i=1}^{3} p_i X_{i1} = \\sum_{i=1}^{3} p_i X_{i2} \\\\\n\\sum_{i=1}^{3} p_i X_{i2} = \\sum_{i=1}^{3} p_i X_{i3} \\\\\nb_1 + b_2 + b_3 = 1\n\\end{cases}\n$$\n\nD.\n$$\n\\begin{cases}\n\\sum_{i=1}^{3} p_i \\frac{W_i(\\boldsymbol{b})}{X_{i1}} = 1 \\\\\n\\sum_{i=1}^{3} p_i \\frac{W_i(\\boldsymbol{b})}{X_{i2}} = 1 \\\\\nb_1 + b_2 + b_3 = 1\n\\end{cases}\n$$", "solution": "我们希望在完全投资的约束下，最大化投资组合的期望对数回报。定义\n$$\nW_{i}(\\boldsymbol{b})=\\sum_{j=1}^{3} b_{j} X_{ij},\n$$\n目标函数为\n$$\nF(\\boldsymbol{b})=\\sum_{i=1}^{3} p_{i}\\ln\\left(W_{i}(\\boldsymbol{b})\\right),\n$$\n约束条件为\n$$\ng(\\boldsymbol{b})=\\sum_{j=1}^{3} b_{j}-1=0.\n$$\n引入拉格朗日乘子$\\lambda$并构造拉格朗日函数\n$$\n\\mathcal{L}(\\boldsymbol{b},\\lambda)=\\sum_{i=1}^{3} p_{i}\\ln\\left(W_{i}(\\boldsymbol{b})\\right)-\\lambda\\left(\\sum_{j=1}^{3} b_{j}-1\\right).\n$$\n为求关于$b_{k}$的驻点，计算\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial b_{k}}=\\sum_{i=1}^{3} p_{i}\\frac{1}{W_{i}(\\boldsymbol{b})}\\frac{\\partial W_{i}(\\boldsymbol{b})}{\\partial b_{k}}-\\lambda.\n$$\n因为$\\frac{\\partial W_{i}(\\boldsymbol{b})}{\\partial b_{k}}=X_{ik}$，一阶条件为\n$$\n\\sum_{i=1}^{3} p_{i}\\frac{X_{ik}}{W_{i}(\\boldsymbol{b})}=\\lambda,\\quad k=1,2,3,\n$$\n以及约束条件$\\sum_{j=1}^{3} b_{j}=1$。\n\n为了确定$\\lambda$的值，将这三个方程分别乘以$b_{k}$，然后对$k$求和：\n$$\n\\sum_{k=1}^{3} b_{k}\\sum_{i=1}^{3} p_{i}\\frac{X_{ik}}{W_{i}(\\boldsymbol{b})}=\\sum_{k=1}^{3} b_{k}\\lambda.\n$$\n交换左侧的求和顺序，并使用$W_{i}(\\boldsymbol{b})$的定义：\n$$\n\\sum_{i=1}^{3} p_{i}\\frac{\\sum_{k=1}^{3} b_{k}X_{ik}}{W_{i}(\\boldsymbol{b})}=\\lambda\\sum_{k=1}^{3} b_{k}\n\\;\\;\\Longrightarrow\\;\\;\n\\sum_{i=1}^{3} p_{i}\\frac{W_{i}(\\boldsymbol{b})}{W_{i}(\\boldsymbol{b})}=\\lambda\\cdot 1\n\\;\\;\\Longrightarrow\\;\\;\n\\sum_{i=1}^{3} p_{i}=\\lambda.\n$$\n因为$\\sum_{i=1}^{3} p_{i}=1$，所以$\\lambda=1$。因此，最优性条件简化为\n$$\n\\sum_{i=1}^{3} p_{i}\\frac{X_{i1}}{W_{i}(\\boldsymbol{b})}=1,\\quad\n\\sum_{i=1}^{3} p_{i}\\frac{X_{i2}}{W_{i}(\\boldsymbol{b})}=1,\\quad\nb_{1}+b_{2}+b_{3}=1,\n$$\n这正是系统B。", "answer": "$$\\boxed{B}$$", "id": "1638086"}, {"introduction": "找到了最优策略并不意味着一劳永逸，投资过程本身是一个随机游走。这个练习将探讨对数最优策略的一个更深层次的方面：风险评估 [@problem_id:1638067]。通过将投资组合的财富路径建模为随机过程，你将计算即使在采用凯利准则的情况下，财富减半的概率先于翻倍的概率，从而更深刻地理解风险与回报的动态关系。", "problem": "一位投资者正在分析一种高投机性的数字资产。根据历史数据和市场分析，他们对该资产在离散时间段（例如，每日）内的价格变动进行建模。在任何给定时期，该资产的价值预计将以 $p=0.6$ 的概率翻倍（乘法因子为 $u=2$），或以 $1-p=0.4$ 的概率减半（乘法因子为 $d=0.5$）。不同时期的结果是相互独立的。\n\n该投资者决定在每个时期开始时，将其总财富的一个固定比例再投资于该资产，来管理其投资组合，剩余部分则以现金形式持有（不产生任何回报）。他们选择使用凯利准则来确定这个固定比例，因为已知该策略能在长期内最大化财富对数的期望值。\n\n设投资者的初始财富为 $W_0$。他们将无限期地继续这一投资策略。在财富增长到其初始值的两倍（$2 W_0$）之前，其财富先下降到其初始值的一半（$0.5 W_0$）的概率是多少？\n\n请以小数形式提供您的答案，并四舍五入到三位有效数字。", "solution": "设 $p=0.6$, $q=0.4$, $u=2$, 且 $d=0.5$。如果在每个时期投资财富的比例为 $f$，则单周期财富乘数为\n$$\na_{u}=1+f(u-1)=1+f,\\qquad a_{d}=1+f(d-1)=1-0.5f.\n$$\n根据凯利准则，$f$ 最大化期望对数增长\n$$\ng(f)=p\\,\\ln(1+f)+q\\,\\ln(1-0.5f).\n$$\n令 $g'(f)=0$ 可得\n$$\n\\frac{p}{1+f}-\\frac{0.5\\,q}{1-0.5f}=0\n\\;\\;\\Longrightarrow\\;\\;\n-\\frac{1}{2}f=\\frac{1}{2}q-p\n\\;\\;\\Longrightarrow\\;\\;\nf^{*}=0.8.\n$$\n因此\n$$\na_{u}=1+f^{*}=1.8,\\qquad a_{d}=1-0.5f^{*}=0.6.\n$$\n\n定义 $X_{t}=\\ln(W_{t}/W_{0})$。那么 $X_{t}$ 是一个随机游走，其独立同分布的增量以概率 $p$ 取值 $\\ln a_{u}$，以概率 $q$ 取值 $\\ln a_{d}$。我们寻求从 $X_{0}=0$ 开始，在到达上边界 $U=\\ln 2$ 之前先到达下边界 $L=\\ln(0.5)=-\\ln 2$ 的概率。\n\n设 $P(x)$ 为从 $x$ 开始，在到达 $L$ 之前先到达 $U$ 的概率。它满足调和方程\n$$\nP(x)=p\\,P(x+\\ln a_{u})+q\\,P(x+\\ln a_{d}),\\quad P(L)=0,\\;P(U)=1.\n$$\n一个标准的指数拟设在 $\\theta\\neq 0$ 满足以下条件时，会产生非平凡解\n$$\np\\,\\exp(\\theta\\ln a_{u})+q\\,\\exp(\\theta\\ln a_{d})=1\n\\;\\;\\Longleftrightarrow\\;\\;\np\\,a_{u}^{\\theta}+q\\,a_{d}^{\\theta}=1.\n$$\n对于 $a_{u}=1.8$，$a_{d}=0.6$，$p=0.6$，$q=0.4$，观察到 $\\theta=-1$ 是一个精确解：\n$$\n0.6\\cdot 1.8^{-1}+0.4\\cdot 0.6^{-1}=\\frac{0.6}{1.8}+\\frac{0.4}{0.6}=\\frac{1}{3}+\\frac{2}{3}=1.\n$$\n因此解为\n$$\nP(x)=\\frac{\\exp(\\theta x)-\\exp(\\theta L)}{\\exp(\\theta U)-\\exp(\\theta L)}.\n$$\n从 $x=0$ 开始，首先到达上边界的概率是\n$$\nP(0)=\\frac{1-\\exp(\\theta L)}{\\exp(\\theta U)-\\exp(\\theta L)}.\n$$\n因此，首先到达下边界的概率是\n$$\n1-P(0)=\\frac{\\exp(\\theta U)-1}{\\exp(\\theta U)-\\exp(\\theta L)}.\n$$\n当 $\\theta=-1$，$U=\\ln 2$，$L=-\\ln 2$ 时，\n$$\n\\exp(\\theta U)=\\exp(-\\ln 2)=\\frac{1}{2},\\qquad \\exp(\\theta L)=\\exp(\\ln 2)=2,\n$$\n所以\n$$\n\\text{Prob}(\\text{hit }L\\text{ before }U)=\\frac{\\frac{1}{2}-1}{\\frac{1}{2}-2}=\\frac{-\\frac{1}{2}}{-\\frac{3}{2}}=\\frac{1}{3}=0.333\\ldots\n$$\n四舍五入到三位有效数字，所求概率为 $0.333$。", "answer": "$$\\boxed{0.333}$$", "id": "1638067"}]}