{"hands_on_practices": [{"introduction": "本练习是一个基础的起点。我们将通过直接应用其定义方程 $\\pi = \\pi P$，为一个简单的双状态马尔可夫链计算其平稳分布。这个练习将巩固你对如何建立和求解控制系统长期行为的线性方程组的理解。[@problem_id:1660504]", "problem": "一个算法交易模型将股票的每日行为分为两种状态之一：状态 1 (上升趋势) 或状态 2 (下降趋势)。该模型对下一天状态的预测仅取决于当天的状态。如果股票今天处于上升趋势，那么它明天转移到下降趋势的概率是 $\\alpha$。如果股票今天处于下降趋势，那么它明天转移到上升趋势的概率是 $3\\alpha$。参数 $\\alpha$ 由市场条件决定，并被约束为 $0 < \\alpha < 1/3$。\n\n在系统运行很长一段时间后，预计它会进入一个稳态。确定向量 $\\pi = [\\pi_1, \\pi_2]$，它分别代表股票处于上升趋势状态 ($\\pi_1$) 和下降趋势状态 ($\\pi_2$) 的长期时间比例。将您的答案表示为 $\\alpha$ 的函数。", "solution": "令两个状态分别用 $1$ (上升趋势) 和 $2$ (下降趋势) 索引。单步转移矩阵 $P$（行表示当前状态，列表示下一状态）为\n$$\nP=\\begin{pmatrix}\n1-\\alpha & \\alpha \\\\\n3\\alpha & 1-3\\alpha\n\\end{pmatrix},\n$$\n因为从状态 $1$ 出发，链以 $1-\\alpha$ 的概率停留在状态 $1$，以 $\\alpha$ 的概率转移到状态 $2$；而从状态 $2$ 出发，它以 $3\\alpha$ 的概率转移到状态 $1$，以 $1-3\\alpha$ 的概率停留在状态 $2$。约束条件 $0<\\alpha<\\frac{1}{3}$ 确保 $P$ 是一个随机矩阵，且其对角线元素严格为正，因此该马尔可夫链是不可约和非周期的，并拥有唯一的平稳分布。\n\n令 $\\pi=[\\pi_{1},\\pi_{2}]$ 表示平稳分布。根据定义，它满足 $\\pi=\\pi P$ 和归一化条件 $\\pi_{1}+\\pi_{2}=1$。由 $\\pi=\\pi P$ 写出平衡方程，得到\n$$\n\\pi_{1}=\\pi_{1}(1-\\alpha)+\\pi_{2}(3\\alpha), \\quad \\pi_{2}=\\pi_{1}\\alpha+\\pi_{2}(1-3\\alpha).\n$$\n从第一个方程，\n$$\n\\pi_{1}-\\pi_{1}(1-\\alpha)=3\\alpha\\,\\pi_{2}\\;\\;\\Longrightarrow\\;\\;\\alpha\\,\\pi_{1}=3\\alpha\\,\\pi_{2}\\;\\;\\Longrightarrow\\;\\;\\pi_{1}=3\\pi_{2},\n$$\n这里我们利用 $\\alpha>0$ 的条件，将等式两边同除以 $\\alpha$。使用归一化条件 $\\pi_{1}+\\pi_{2}=1$，\n$$\n3\\pi_{2}+\\pi_{2}=1 \\;\\;\\Longrightarrow\\;\\; 4\\pi_{2}=1 \\;\\;\\Longrightarrow\\;\\; \\pi_{2}=\\frac{1}{4}, \\quad \\pi_{1}=\\frac{3}{4}.\n$$\n因此，处于每种状态的长期天数比例与 $\\alpha$ 无关（在给定范围内），等于 $[\\frac{3}{4},\\frac{1}{4}]$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{3}{4} & \\frac{1}{4} \\end{pmatrix}}$$", "id": "1660504"}, {"introduction": "在简单的代数运算之外，本题引入了强大的对称性概念。我们将分析一个在对称图上的随机游走，并见证如何利用系统内在的对称性来极大简化寻找平稳分布的过程。与强行求解整个方程组相比，这种方法通常能提供更优雅、更直观的解法。[@problem_id:1660523]", "problem": "一个小型、孤立的计算机网络由四个服务器节点组成，标记为 A、B、C 和 D，排列成一个正方形。节点 A 与其相邻的节点 B 和 D 相连。与 A 对角相对的节点 C 也与节点 B 和 D 相连。因此，这些连接形成了一个闭环 A-B-C-D-A。\n\n一个诊断数据包在该网络中不断地被路由。在每个时间步，数据包以相等的概率从当前节点移动到其两个相连的邻居节点之一。例如，如果数据包在节点 A，它将在下一个时间步以 $1/2$ 的概率移动到节点 B 或节点 D。\n\n当数据包已经移动了很长时间后，它在任何给定节点上花费的时间的长期平均比例会收敛到一个固定值。这个值可以解释为，如果在遥远的未来的一个随机时间点检查，在该节点找到数据包的概率。\n\n计算在节点 A 找到数据包的这个极限概率。请用一个精确的分数表示你的答案。", "solution": "将数据包的运动建模为四个节点上的马尔可夫链，其中从每个节点到其两个邻居节点的转移概率均为 $\\frac{1}{2}$。设平稳分布为 $\\pi=(\\pi_{A},\\pi_{B},\\pi_{C},\\pi_{D})$，它满足 $\\pi=\\pi P$ 和 $\\pi_{A}+\\pi_{B}+\\pi_{C}+\\pi_{D}=1$。以分量形式使用 $\\pi=\\pi P$ 可得\n$$\n\\pi_{A}=\\frac{1}{2}\\pi_{B}+\\frac{1}{2}\\pi_{D},\\quad\n\\pi_{B}=\\frac{1}{2}\\pi_{A}+\\frac{1}{2}\\pi_{C},\\quad\n\\pi_{C}=\\frac{1}{2}\\pi_{B}+\\frac{1}{2}\\pi_{D},\\quad\n\\pi_{D}=\\frac{1}{2}\\pi_{A}+\\frac{1}{2}\\pi_{C}.\n$$\n将第一个和第三个方程相减，得到\n$$\n\\pi_{A}-\\pi_{C}=\\frac{1}{2}(\\pi_{B}-\\pi_{B})+\\frac{1}{2}(\\pi_{D}-\\pi_{D})=0 \\quad \\Rightarrow \\quad \\pi_{A}=\\pi_{C}.\n$$\n将第二个和第四个方程相减，得到\n$$\n\\pi_{B}-\\pi_{D}=\\frac{1}{2}(\\pi_{A}-\\pi_{A})+\\frac{1}{2}(\\pi_{C}-\\pi_{C})=0 \\quad \\Rightarrow \\quad \\pi_{B}=\\pi_{D}.\n$$\n将 $\\pi_{C}=\\pi_{A}$ 和 $\\pi_{D}=\\pi_{B}$ 代入 $\\pi_{A}=\\frac{1}{2}\\pi_{B}+\\frac{1}{2}\\pi_{D}$ 中，得到\n$$\n\\pi_{A}=\\frac{1}{2}\\pi_{B}+\\frac{1}{2}\\pi_{B}=\\pi_{B},\n$$\n因此 $\\pi_{A}=\\pi_{B}=\\pi_{C}=\\pi_{D}$。使用归一化条件，\n$$\n\\pi_{A}+\\pi_{B}+\\pi_{C}+\\pi_{D}=4\\pi_{A}=1 \\quad \\Rightarrow \\quad \\pi_{A}=\\frac{1}{4}.\n$$\n因此，在节点 A 找到数据包的长期概率是 $\\frac{1}{4}$。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "1660523"}, {"introduction": "这道最后的练习题提出了一个更复杂的场景：在一个立方体上的有偏随机游走。在这里，转移概率不再是均匀的，打破了我们之前看到的简单对称性。你将学习应用一种更精妙的对称性论证方法，即状态聚合（或称“状态合并”），来解决一个否则将极其困难的八状态问题。[@problem_id:1660536]", "problem": "一个质点在一个单位立方体的八个顶点上进行离散时间随机游走。这些顶点由其坐标 $(x,y,z)$ 标识，其中 $x, y, z$ 均可取 0 或 1。在每一步中，当前位于顶点 $v$ 的质点会移动到其三个相邻顶点之一。\n\n移动到哪个相邻顶点的选择是概率性的，并且基于潜在目标顶点的 z 坐标存在偏向。具体来说，从当前顶点 $v$ 移动到特定相邻顶点 $u$ 的概率与分配给目标顶点 $u$ 的权重 $w(u)$ 成正比。该权重的定义如下：\n- 如果顶点 $u$ 的 z 坐标为 0，则 $w(u) = 1$。\n- 如果顶点 $u$ 的 z 坐标为 1，则 $w(u) = 2$。\n\n例如，如果位于顶点 $v$ 的质点有三个相邻顶点 $u_1, u_2, u_3$，则下一步转移到相邻顶点 $u_1$ 的概率由表达式 $\\frac{w(u_1)}{w(u_1) + w(u_2) + w(u_3)}$ 给出。\n\n经过很长一段时间后，质点的位置将由一个关于这八个顶点的平稳概率分布来描述。计算质点位于顶点 $(1,1,1)$ 的平稳概率。将你的答案表示为最简有理数形式。", "solution": "用坐标 $(x,y,z)$ 标记八个顶点，其中 $x,y,z \\in \\{0,1\\}$。从任意顶点出发，其三个相邻顶点可通过翻转恰好一个坐标得到。从当前顶点 $v$ 到相邻顶点 $u$ 的转移概率与权重 $w(u)$ 成正比，其中如果 $u$ 的 z 坐标为 $0$，则 $w(u)=1$；如果为 $1$，则 $w(u)=2$。\n\n从一个 $z=0$ 的顶点出发：\n- 两个相邻顶点保持 $z=0$（翻转 $x$ 或 $y$），每个权重为 $1$。\n- 一个相邻顶点变为 $z=1$（翻转 $z$），权重为 $2$。\n因此，转移概率分别为 $1/4$、$1/4$ 和 $1/2$，所以移动到 $z=1$ 层的概率是 $\\frac{1}{2}$，停留在 $z=0$ 层的概率是 $\\frac{1}{2}$。\n\n从一个 $z=1$ 的顶点出发：\n- 两个相邻顶点保持 $z=1$（翻转 $x$ 或 $y$），每个权重为 $2$。\n- 一个相邻顶点变为 $z=0$（翻转 $z$），权重为 $1$。\n因此，转移概率分别为 $2/5$、$2/5$ 和 $1/5$，所以移动到 $z=0$ 层的概率是 $\\frac{1}{5}$，停留在 $z=1$ 层的概率是 $\\frac{4}{5}$。\n\n根据 $x$ 和 $y$ 的对称性，同一 $z$ 层内的所有顶点具有相同的平稳概率。设 $q_{0}$ 和 $q_{1}$ 分别为处于 $z=0$ 和 $z=1$ 层的平稳概率。导出的两状态马尔可夫链的转移矩阵为\n$$\n\\begin{pmatrix}\n\\frac{1}{2} & \\frac{1}{2} \\\\\n\\frac{1}{5} & \\frac{4}{5}\n\\end{pmatrix},\n$$\n因此平稳性条件给出\n$$\nq_{0} = \\frac{1}{2}q_{0} + \\frac{1}{5}q_{1}, \\quad q_{1} = \\frac{1}{2}q_{0} + \\frac{4}{5}q_{1}, \\quad q_{0}+q_{1}=1.\n$$\n由第一个方程，\n$$\nq_{0} - \\frac{1}{2}q_{0} = \\frac{1}{5}q_{1} \\quad \\Rightarrow \\quad \\frac{1}{2}q_{0} = \\frac{1}{5}q_{1} \\quad \\Rightarrow \\quad q_{0} = \\frac{2}{5}q_{1}.\n$$\n使用 $q_{0}+q_{1}=1$，\n$$\n\\frac{2}{5}q_{1} + q_{1} = 1 \\quad \\Rightarrow \\quad \\frac{7}{5}q_{1} = 1 \\quad \\Rightarrow \\quad q_{1} = \\frac{5}{7}, \\quad q_{0} = \\frac{2}{7}.\n$$\n每个层有 $4$ 个顶点，根据对称性，$z=1$ 层中每个顶点的平稳概率为 $q_{1}/4$，因此 $(1,1,1)$ 的平稳概率是\n$$\n\\frac{q_{1}}{4} = \\frac{1}{4}\\cdot \\frac{5}{7} = \\frac{5}{28}.\n$$\n等价地，跨越一条 z 轴方向边的细致平衡条件要求 $\\pi_{0}\\cdot \\frac{1}{2} = \\pi_{1}\\cdot \\frac{1}{5}$，所以 $\\pi_{1}/\\pi_{0} = \\frac{5}{2}$；归一化 $4\\pi_{0}+4\\pi_{1}=1$ 得到对于任何 $z=1$ 的顶点，$\\pi_{1}=\\frac{5}{28}$，与上述结果一致。", "answer": "$$\\boxed{\\frac{5}{28}}$$", "id": "1660536"}]}