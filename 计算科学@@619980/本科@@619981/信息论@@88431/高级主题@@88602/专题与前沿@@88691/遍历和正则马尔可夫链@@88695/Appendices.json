{"hands_on_practices": [{"introduction": "平稳分布描述了马尔可夫链在长时间运行后的平衡状态。这个练习将引导你为一个简单的双状态系统计算这个分布，这是分析更复杂模型的基础技能。通过解决这个问题 [@problem_id:1621829]，你将掌握定义平稳分布的核心方程 $\\pi P = \\pi$ 的直接应用。", "problem": "一个用于计算机中央处理器 (CPU) 功耗管理的简化模型，描述了其在离散时间间隔的状态。CPU 可以处于两种状态之一：状态1（活动）或状态2（低功耗）。这些状态之间的转换被建模为马尔可夫链。\nCPU 从一个时间步到下一个时间步保持在活动状态的概率为 $p_{11} = 0.75$。\nCPU 从一个时间步到下一个时间步保持在低功耗状态的概率为 $p_{22} = 0.5$。\n如果系统不保持在当前状态，则必须转换到另一个状态。\n假设该系统运行很长时间，它将趋近于一个稳态，此时处于任一状态的概率都将变为常数。这种稳态概率分布被称为平稳分布。\n计算平稳分布向量 $\\pi = (\\pi_1, \\pi_2)$，其中 $\\pi_1$ 是 CPU 处于活动状态的长期概率，$\\pi_2$ 是 CPU 处于低功耗状态的长期概率。\n将平稳分布向量的分量表示为精确分数。", "solution": "设两个状态为状态1（活动）和状态2（低功耗）。问题给出了保持在某个给定状态的概率。我们可以利用这些信息来构建一步转移概率矩阵 $P$。矩阵 $P$ 是一个 $2 \\times 2$ 矩阵，其中元素 $P_{ij}$ 是从状态 $i$ 转移到状态 $j$ 的概率。\n\n保持在活动状态（状态1）的概率为 $p_{11} = 0.75$。由于转移矩阵中任意一行的概率之和必须为1，从活动状态转移到低功耗状态（状态2）的概率为 $p_{12} = 1 - p_{11} = 1 - 0.75 = 0.25$。\n\n保持在低功耗状态（状态2）的概率为 $p_{22} = 0.5$。因此，从低功耗状态转移到活动状态（状态1）的概率为 $p_{21} = 1 - p_{22} = 1 - 0.5 = 0.5$。\n\n根据这些概率，转移矩阵 $P$ 为：\n$$\nP = \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{21} & p_{22} \\end{pmatrix} = \\begin{pmatrix} 0.75 & 0.25 \\\\ 0.5 & 0.5 \\end{pmatrix}\n$$\n\n平稳分布是一个概率向量 $\\pi = (\\pi_1, \\pi_2)$，它满足两个条件：\n1. $\\pi P = \\pi$\n2. $\\pi_1 + \\pi_2 = 1$ (概率之和必须为1)\n\n我们使用第一个条件 $\\pi P = \\pi$：\n$$\n(\\pi_1, \\pi_2) \\begin{pmatrix} 0.75 & 0.25 \\\\ 0.5 & 0.5 \\end{pmatrix} = (\\pi_1, \\pi_2)\n$$\n\n这个矩阵方程给出了一个由两个线性方程组成的方程组：\n(i) $0.75 \\pi_1 + 0.5 \\pi_2 = \\pi_1$\n(ii) $0.25 \\pi_1 + 0.5 \\pi_2 = \\pi_2$\n\n我们来简化第一个方程 (i)：\n$$\n0.5 \\pi_2 = \\pi_1 - 0.75 \\pi_1\n$$\n$$\n0.5 \\pi_2 = 0.25 \\pi_1\n$$\n两边同乘以4以消去小数，我们得到：\n$$\n2 \\pi_2 = \\pi_1\n$$\n\n第二个方程 (ii) 是多余的，因为它会产生相同的关系。我们来验证一下：\n$$\n0.25 \\pi_1 = \\pi_2 - 0.5 \\pi_2\n$$\n$$\n0.25 \\pi_1 = 0.5 \\pi_2\n$$\n乘以4可得：\n$$\n\\pi_1 = 2 \\pi_2\n$$\n正如预期的，两个方程是等价的。\n\n现在我们使用第二个条件，即归一化方程：\n$$\n\\pi_1 + \\pi_2 = 1\n$$\n将关系式 $\\pi_1 = 2 \\pi_2$ 代入归一化方程：\n$$\n(2 \\pi_2) + \\pi_2 = 1\n$$\n$$\n3 \\pi_2 = 1\n$$\n$$\n\\pi_2 = \\frac{1}{3}\n$$\n\n现在我们可以用关系式 $\\pi_1 = 2 \\pi_2$ 来求 $\\pi_1$：\n$$\n\\pi_1 = 2 \\left( \\frac{1}{3} \\right) = \\frac{2}{3}\n$$\n\n因此，平稳分布向量为 $\\pi = (\\pi_1, \\pi_2) = (\\frac{2}{3}, \\frac{1}{3})$。这意味着，从长远来看，CPU 大约有 $66.7\\%$ 的时间处于活动状态，大约有 $33.3\\%$ 的时间处于低功耗状态。问题要求将分量表示为精确分数。\n平稳分布为 $(\\frac{2}{3}, \\frac{1}{3})$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2}{3} & \\frac{1}{3} \\end{pmatrix}}$$", "id": "1621829"}, {"introduction": "现实世界中的模型通常包含两个以上的状态，这使得计算变得更加复杂。这个练习 [@problem_id:1621847] 让你将平稳分布的原理应用于一个三状态系统，在实践中检验一个给定的概率向量是否真正代表了系统的长期平衡。这不仅能巩固你的代数技巧，还能加深你对平衡条件的理解。", "problem": "一个用于新的在线内容平台的简化用户行为模型追踪用户如何在三个内容类别之间转移：新闻（状态 1）、娱乐（状态 2）和教育（状态 3）。该系统的推荐算法导致了这些类别之间的概率性转移，这可以被建模为一个离散时间马尔可夫链。一步转移概率矩阵 $P$ 如下所示，其中条目 $P_{ij}$ 表示用户在单一步骤中从类别 $i$ 转移到类别 $j$ 的概率。\n\n$$\nP = \\begin{pmatrix}\n1/2 & 1/4 & 1/4 \\\\\n1/3 & 1/3 & 1/3 \\\\\n1/6 & 1/2 & 1/3\n\\end{pmatrix}\n$$\n\n在系统长时间运行后，预计它将达到一个平衡状态，在该状态下，每个类别中的用户比例保持不变。一位工程师为这个平衡分布 $\\pi = [\\pi_1, \\pi_2, \\pi_3]$ 提出了几个可能的向量，其中 $\\pi_i$ 是类别 $i$ 中用户的长期比例。\n\n下列哪个提出的向量代表了该系统的正确平衡分布？\n\nA. $[\\frac{20}{59}, \\frac{21}{59}, \\frac{18}{59}]$\n\nB. $[\\frac{18}{59}, \\frac{21}{59}, \\frac{20}{59}]$\n\nC. $[\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3}]$\n\nD. $[\\frac{20}{143}, \\frac{21}{143}, \\frac{102}{143}]$\n\n你的答案应该是对应于正确选项的单个大写字母。", "solution": "设平稳分布为 $\\pi = [\\pi_{1}, \\pi_{2}, \\pi_{3}]$。对于具有转移矩阵 $P$ 的离散时间马尔可夫链，其平衡（平稳）分布满足平稳性条件 $\\pi P = \\pi$ 以及归一化条件 $\\pi_{1} + \\pi_{2} + \\pi_{3} = 1$。\n\n当 $P$ 由下式给出时\n$$\nP = \\begin{pmatrix}\n\\frac{1}{2} & \\frac{1}{4} & \\frac{1}{4} \\\\\n\\frac{1}{3} & \\frac{1}{3} & \\frac{1}{3} \\\\\n\\frac{1}{6} & \\frac{1}{2} & \\frac{1}{3}\n\\end{pmatrix},\n$$\n平稳性方程 $\\pi = \\pi P$ 的分量形式是\n$$\n\\pi_{1} = \\frac{1}{2}\\pi_{1} + \\frac{1}{3}\\pi_{2} + \\frac{1}{6}\\pi_{3},\n$$\n$$\n\\pi_{2} = \\frac{1}{4}\\pi_{1} + \\frac{1}{3}\\pi_{2} + \\frac{1}{2}\\pi_{3},\n$$\n$$\n\\pi_{3} = \\frac{1}{4}\\pi_{1} + \\frac{1}{3}\\pi_{2} + \\frac{1}{3}\\pi_{3}.\n$$\n重写这些方程，\n$$\n\\frac{1}{2}\\pi_{1} = \\frac{1}{3}\\pi_{2} + \\frac{1}{6}\\pi_{3} \\;\\;\\Longrightarrow\\;\\; 3\\pi_{1} = 2\\pi_{2} + \\pi_{3},\n$$\n$$\n\\frac{2}{3}\\pi_{2} = \\frac{1}{4}\\pi_{1} + \\frac{1}{2}\\pi_{3} \\;\\;\\Longrightarrow\\;\\; 8\\pi_{2} = 3\\pi_{1} + 6\\pi_{3},\n$$\n$$\n\\frac{2}{3}\\pi_{3} = \\frac{1}{4}\\pi_{1} + \\frac{1}{3}\\pi_{2} \\;\\;\\Longrightarrow\\;\\; 8\\pi_{3} = 3\\pi_{1} + 4\\pi_{2}.\n$$\n使用最后两个线性方程，用 $\\pi_{1}$ 来表示 $\\pi_{2}$ 和 $\\pi_{3}$。从 $8\\pi_{2} - 6\\pi_{3} = 3\\pi_{1}$ 和 $-4\\pi_{2} + 8\\pi_{3} = 3\\pi_{1}$，将第二个方程乘以2得到 $-8\\pi_{2} + 16\\pi_{3} = 6\\pi_{1}$。与第一个方程相加得到 $10\\pi_{3} = 9\\pi_{1}$，因此\n$$\n\\pi_{3} = \\frac{9}{10}\\pi_{1}.\n$$\n代入 $8\\pi_{2} - 6\\pi_{3} = 3\\pi_{1}$ 中得到\n$$\n8\\pi_{2} - 6\\cdot \\frac{9}{10}\\pi_{1} = 3\\pi_{1} \\;\\;\\Longrightarrow\\;\\; 8\\pi_{2} = 3\\pi_{1} + \\frac{54}{10}\\pi_{1} = \\frac{42}{5}\\pi_{1},\n$$\n所以\n$$\n\\pi_{2} = \\frac{21}{20}\\pi_{1}.\n$$\n应用归一化条件 $\\pi_{1} + \\pi_{2} + \\pi_{3} = 1$：\n$$\n\\pi_{1} + \\frac{21}{20}\\pi_{1} + \\frac{9}{10}\\pi_{1} = 1 \\;\\;\\Longrightarrow\\;\\; \\left(\\frac{20}{20} + \\frac{21}{20} + \\frac{18}{20}\\right)\\pi_{1} = \\frac{59}{20}\\pi_{1} = 1,\n$$\n因此\n$$\n\\pi_{1} = \\frac{20}{59}, \\quad \\pi_{2} = \\frac{21}{59}, \\quad \\pi_{3} = \\frac{18}{59}.\n$$\n这与选项A匹配。", "answer": "$$\\boxed{A}$$", "id": "1621847"}, {"introduction": "是否所有马尔可夫链最终都会达到一个唯一的平稳分布？答案是否定的，这取决于链的结构特性。这个练习 [@problem_id:1621848] 探讨了一个不可约但具有周期性的链，它并不会收敛到单一的稳态。通过分析这个案例，你将理解遍历性（包括不可约性和非周期性）为何是保证唯一平稳分布存在的关键。", "problem": "一个网络数据路由器缓冲区的简化模型由一个具有三个状态的离散时间马尔可夫链描述：$S_1$ (空)、$S_2$ (半满) 和 $S_3$ (满)。路由器的状态在每个时间步结束时被观测。状态之间的转换遵循以下规则：\n\n1.  如果在一个时间步开始时缓冲区为空 ($S_1$)，则一个数据包必然会到达，导致缓冲区在该时间步结束时变为半满 ($S_2$)。\n2.  如果缓冲区为半满 ($S_2$)，则有50%的概率会有一个新数据包到达，使其变为满 ($S_3$)；同时有50%的概率一个数据包被处理并发送出去，使其变为空 ($S_1$)。这是仅有的两种可能性。\n3.  如果缓冲区为满 ($S_3$)，路由器会优先发送一个数据包。它必然会处理并发送一个数据包，导致缓冲区在该时间步结束时变为半满 ($S_2$)。\n\n基于此模型，你将如何对所得到的马尔可夫链进行分类？\n\nA. 该链是正则的。\n\nB. 该链是遍历的但不是正则的。\n\nC. 该链是不可约的但不是遍历的。\n\nD. 该链不是不可约的。\n\nE. 该链至少有一个吸收态。", "solution": "设状态排序为 $(S_{1},S_{2},S_{3})$。根据规则：\n- 从 $S_{1}$ 出发，下一状态为 $S_{2}$ 的概率为 $1$。\n- 从 $S_{2}$ 出发，下一状态为 $S_{1}$ 的概率为 $\\frac{1}{2}$，为 $S_{3}$ 的概率为 $\\frac{1}{2}$。\n- 从 $S_{3}$ 出发，下一状态为 $S_{2}$ 的概率为 $1$。\n\n因此，一步转移矩阵为\n$$\nP=\\begin{pmatrix}\n0 & 1 & 0\\\\\n\\frac{1}{2} & 0 & \\frac{1}{2}\\\\\n0 & 1 & 0\n\\end{pmatrix}.\n$$\n\n不可约性：如果一个有限状态马尔可夫链中的每个状态都与所有其他状态互通，则该链是不可约的。从 $S_{1}$ 出发，一步可达 $S_{2}$，通过 $S_{2}$ 两步可达 $S_{3}$。从 $S_{3}$ 出发，一步可达 $S_{2}$，通过 $S_{2}$ 两步可达 $S_{1}$。从 $S_{2}$ 出发，一步可达 $S_{1}$ 或 $S_{3}$。因此，任意两个状态都互通，所以该链是不可约的。\n\n周期性：状态 $i$ 的周期是 $d(i)=\\gcd\\{n\\ge 1: (P^{n})_{ii}>0\\}$。考虑 $S_{2}$。我们有 $(P^{1})_{22}=0$，$(P^{2})_{22}>0$ 因为 $S_{2}\\to S_{1}\\to S_{2}$ 以概率 $\\frac{1}{2}\\cdot 1>0$ 发生，以及 $(P^{3})_{22}=0$ 因为任何从 $S_{2}$ 出发的长度为3的路径都必须在第1步离开 $S_{2}$，在第2步返回，然后在第3步离开，因此它不能在 $S_{2}$ 结束。更一般地，返回到 $S_{2}$ 只在偶数时间步发生，所以 $\\{n\\ge 1:(P^{n})_{22}>0\\}=\\{2,4,6,\\dots\\}$ 且 $d(S_{2})=2$。在一个不可约链中，所有状态共享相同的周期，所以每个状态的周期都为 $2$。因此该链是周期的（不是非周期的）。\n\n对选项的推论：\n- 由于对所有 $i$ 都有 $(P)_{ii}\\neq 1$，因此没有吸收态。所以选项 E 是错误的。\n- 该链是不可约的（所以选项 D 是错误的），但它是周期为 $2$ 的周期链，因此在标准意义上（不可约且非周期）它不是遍历的。因此选项 B 是错误的。\n- 一个正则链（本原链）要求某个幂次 $P^{n}$ 的所有元素都严格为正；对于像这样的周期性二分链，这个条件不成立，所以选项 A 是错误的。\n- 因此，正确的分类是该链是不可约的但不是遍历的。\n\n因此，正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "1621848"}]}