{"hands_on_practices": [{"introduction": "本章节的第一个练习将探讨一个基础情形：一个未来状态与过去状态无关的信源。尽管它被建模为马尔可夫链，但其行为实质上是一个无记忆的，或称独立同分布（IID）的过程。通过解决这个问题 [@problem_id:1621359]，您将看到马尔可夫信源熵率的通用公式在这种特殊情况下如何简化，从而将其与您可能已经熟悉的基本熵定义联系起来。", "problem": "考虑一个随机文本生成器的简化模型，该生成器从字母表 $\\{X, Y, Z\\}$ 中产生一个字符序列。该生成器被设计为一个一阶平稳 Markov 信源。然而，由于一个特殊的设计选择，生成下一个字符的概率实际上与序列中的当前字符无关。\n\n具体来说，无论前一个字符是什么，生成 “X” 的概率是 $p_X$，生成 “Y” 的概率是 $p_Y$，生成 “Z” 的概率是 $p_Z$。值 $p_X$、$p_Y$ 和 $p_Z$ 是和为 1 的正常数：$p_X + p_Y + p_Z = 1$。\n\n假设此过程在很久以前已经开始并已达到稳态，请确定该信源的熵率。将答案表示为以 $p_X$、$p_Y$ 和 $p_Z$ 表示的解析表达式，使用以 2 为底的对数。", "solution": "该问题要求计算一个平稳一阶 Markov 信源的熵率。设状态集为 $S = \\{X, Y, Z\\}$。\n\n首先，我们需要为这个 Markov 信源定义转移概率矩阵 $P$。元素 $P_{ij}$ 表示从状态 $i$ 转移到状态 $j$ 的概率。根据问题描述，下一个字符的概率与当前字符无关。这意味着转移矩阵的每一行都是相同的。\n\n矩阵的行代表当前状态（X、Y 或 Z），列代表下一个状态（X、Y 或 Z）。因此，转移矩阵 $P$ 为：\n$$\nP = \\begin{pmatrix}\nP(X_{n+1}=X | X_n=X) & P(X_{n+1}=Y | X_n=X) & P(X_{n+1}=Z | X_n=X) \\\\\nP(X_{n+1}=X | X_n=Y) & P(X_{n+1}=Y | X_n=Y) & P(X_{n+1}=Z | X_n=Y) \\\\\nP(X_{n+1}=X | X_n=Z) & P(X_{n+1}=Y | X_n=Z) & P(X_{n+1}=Z | X_n=Z)\n\\end{pmatrix}\n$$\n根据描述，无论当前状态如何，这些概率分别为 $p_X, p_Y, p_Z$。所以，该矩阵变为：\n$$\nP = \\begin{pmatrix}\np_X & p_Y & p_Z \\\\\np_X & p_Y & p_Z \\\\\np_X & p_Y & p_Z\n\\end{pmatrix}\n$$\n\n平稳 Markov 信源的熵率 $H(\\mathcal{X})$ 由以下公式给出：\n$$\nH(\\mathcal{X}) = \\sum_{i \\in S} \\pi_i H(P_{i,\\cdot})\n$$\n其中 $\\boldsymbol{\\pi} = (\\pi_X, \\pi_Y, \\pi_Z)$ 是该 Markov 链的平稳分布，而 $H(P_{i,\\cdot})$ 是由转移矩阵 $P$ 的第 $i$ 行给出的概率分布的熵。\n\n首先，我们通过求解方程 $\\boldsymbol{\\pi} P = \\boldsymbol{\\pi}$ 并满足约束条件 $\\pi_X + \\pi_Y + \\pi_Z = 1$ 来找到平稳分布 $\\boldsymbol{\\pi}$。\n方程 $\\boldsymbol{\\pi} P = \\boldsymbol{\\pi}$ 展开为：\n$$\n(\\pi_X, \\pi_Y, \\pi_Z)\n\\begin{pmatrix}\np_X & p_Y & p_Z \\\\\np_X & p_Y & p_Z \\\\\np_X & p_Y & p_Z\n\\end{pmatrix}\n= (\\pi_X, \\pi_Y, \\pi_Z)\n$$\n这给了我们一个线性方程组：\n1.  $\\pi_X p_X + \\pi_Y p_X + \\pi_Z p_X = \\pi_X$\n2.  $\\pi_X p_Y + \\pi_Y p_Y + \\pi_Z p_Y = \\pi_Y$\n3.  $\\pi_X p_Z + \\pi_Y p_Z + \\pi_Z p_Z = \\pi_Z$\n\n我们来分析第一个方程：\n$(\\pi_X + \\pi_Y + \\pi_Z) p_X = \\pi_X$\n因为 $\\pi_X + \\pi_Y + \\pi_Z = 1$，所以这简化为 $p_X = \\pi_X$。\n类似地，从第二个和第三个方程中，我们得到 $p_Y = \\pi_Y$ 和 $p_Z = \\pi_Z$。\n因此，平稳分布是 $\\boldsymbol{\\pi} = (p_X, p_Y, p_Z)$。这与约束条件 $\\sum \\pi_i = p_X + p_Y + p_Z = 1$ 一致。\n\n接下来，我们计算转移矩阵每一行的熵。令 $H_i = H(P_{i,\\cdot}) = -\\sum_{j \\in S} P_{ij} \\log_2(P_{ij})$。\n由于 $P$ 的所有行都相同，因此每一行的熵也相同。我们计算第一行（状态X）的熵：\n$$\nH_X = -(p_X \\log_2(p_X) + p_Y \\log_2(p_Y) + p_Z \\log_2(p_Z))\n$$\n类似地，对于第二行和第三行：\n$$\nH_Y = -(p_X \\log_2(p_X) + p_Y \\log_2(p_Y) + p_Z \\log_2(p_Z)) = H_X\n$$\n$$\nH_Z = -(p_X \\log_2(p_X) + p_Y \\log_2(p_Y) + p_Z \\log_2(p_Z)) = H_X\n$$\n\n最后，我们计算熵率 $H(\\mathcal{X})$：\n$$\nH(\\mathcal{X}) = \\pi_X H_X + \\pi_Y H_Y + \\pi_Z H_Z\n$$\n代入我们为 $\\boldsymbol{\\pi}$ 和行熵找到的值：\n$$\nH(\\mathcal{X}) = p_X H_X + p_Y H_X + p_Z H_X = (p_X + p_Y + p_Z) H_X\n$$\n因为 $p_X + p_Y + p_Z = 1$，我们有：\n$$\nH(\\mathcal{X}) = 1 \\cdot H_X = H_X\n$$\n所以，该信源的熵率就是公共行向量的熵。\n$$\nH(\\mathcal{X}) = -(p_X \\log_2(p_X) + p_Y \\log_2(p_Y) + p_Z \\log_2(p_Z))\n$$\n这个结果是符合预期的，因为一个其下一状态与当前状态无关的 Markov 信源等价于一个无记忆或独立同分布（IID）信源。IID 信源的熵率就是单个符号概率分布的熵。", "answer": "$$\\boxed{-(p_X \\log_{2}(p_X) + p_Y \\log_{2}(p_Y) + p_Z \\log_{2}(p_Z))}$$", "id": "1621359"}, {"introduction": "在建立了无记忆信源的基准之后，我们现在转向一个真正的马尔可夫过程，其中下一个状态依赖于当前状态。这个问题 [@problem_id:1621329] 使用了一个直观的天气模型来演示计算熵率的标准流程。您将练习求解稳态分布，然后对每个状态的条件熵进行加权平均，这个过程将帮助您理解信源的“记忆”如何影响其平均不确定性。", "problem": "一个描述某偏远岛屿的简化气候模型将任意一天的天气描述为“晴天”或“雨天”。该模型是一个平稳一阶马尔可夫过程。晴天之后是雨天的概率为 $p$。同样地，雨天之后是晴天的概率也是 $p$。$p$ 的值是一个常数，满足 $0 < p < 1$。\n\n假设此模型已达到其稳态，求每日天气序列的熵率。请用含 $p$ 的符号表达式表示你的答案。所有计算均使用以 2 为底的对数。最终答案的单位应为比特/天。", "solution": "设马尔可夫过程的两个状态为：$S$ 代表晴天，$R$ 代表雨天。题目陈述给出了这些状态之间的转移概率。\n\n从晴天转移到雨天的概率给定为 $P(R|S) = p$。\n由于第二天的天气只能是晴天或雨天，从晴天转移出去的概率之和必须为 1。因此，晴天之后还是晴天的概率为：\n$P(S|S) = 1 - P(R|S) = 1 - p$。\n\n同样地，从雨天转移到晴天的概率给定为 $P(S|R) = p$。\n雨天之后还是雨天的概率为：\n$P(R|R) = 1 - P(S|R) = 1 - p$。\n\n我们可以将这些转移概率表示为一个转移矩阵 $P$，其中行对应当前状态，列对应下一个状态（按 S, R 顺序）：\n$$\nP = \\begin{pmatrix} P(S|S) & P(R|S) \\\\ P(S|R) & P(R|R) \\end{pmatrix} = \\begin{pmatrix} 1-p & p \\\\ p & 1-p \\end{pmatrix}\n$$\n\n题目要求计算该过程在稳态下的熵率。对于一个平稳马尔可夫链，熵率 $H(\\mathcal{X})$ 由给定当前状态下下一状态的条件熵给出：\n$$\nH(\\mathcal{X}) = H(X_{n+1} | X_n) = \\sum_{i \\in \\{S, R\\}} \\pi_i H(X_{n+1} | X_n=i)\n$$\n其中 $\\pi = (\\pi_S, \\pi_R)$ 是马尔可夫链的平稳分布。\n\n首先，我们需要找到满足方程 $\\pi P = \\pi$ 的平稳分布 $\\pi$。这个方程加上归一化条件 $\\pi_S + \\pi_R = 1$，使我们能够解出 $\\pi_S$ 和 $\\pi_R$。\n方程 $\\pi P = \\pi$ 给出：\n$$\n(\\pi_S, \\pi_R) \\begin{pmatrix} 1-p & p \\\\ p & 1-p \\end{pmatrix} = (\\pi_S, \\pi_R)\n$$\n这得到了一个线性方程组：\n1. $\\pi_S(1-p) + \\pi_R p = \\pi_S$\n2. $\\pi_S p + \\pi_R (1-p) = \\pi_R$\n\n由方程 1：\n$-\\pi_S p + \\pi_R p = 0 \\implies p(\\pi_R - \\pi_S) = 0$。\n因为 $0 < p < 1$，我们必然有 $\\pi_R = \\pi_S$。\n\n使用归一化条件 $\\pi_S + \\pi_R = 1$：\n$\\pi_S + \\pi_S = 1 \\implies 2\\pi_S = 1 \\implies \\pi_S = \\frac{1}{2}$。\n因此，$\\pi_R = \\frac{1}{2}$。平稳分布为 $\\pi = (\\frac{1}{2}, \\frac{1}{2})$。这对于对称转移矩阵是符合预期的。\n\n接下来，我们计算每个状态的条件熵。题目指定使用以 2 为底的对数。\n给定当前状态为晴天的条件熵是：\n$$\nH(X_{n+1} | X_n=S) = -\\sum_{j \\in \\{S,R\\}} P(j|S) \\log_2 P(j|S)\n$$\n$$\nH(X_{n+1} | X_n=S) = -[P(S|S)\\log_2 P(S|S) + P(R|S)\\log_2 P(R|S)]\n$$\n$$\nH(X_{n+1} | X_n=S) = -[(1-p)\\log_2(1-p) + p\\log_2(p)]\n$$\n\n给定当前状态为雨天的条件熵是：\n$$\nH(X_{n+1} | X_n=R) = -\\sum_{j \\in \\{S,R\\}} P(j|R) \\log_2 P(j|R)\n$$\n$$\nH(X_{n+1} | X_n=R) = -[P(S|R)\\log_2 P(S|R) + P(R|R)\\log_2 P(R|R)]\n$$\n$$\nH(X_{n+1} | X_n=R) = -[p\\log_2(p) + (1-p)\\log_2(1-p)]\n$$\n两个条件熵都等于二元熵函数 $H_b(p)$。\n\n最后，我们使用平稳分布计算熵率：\n$$\nH(\\mathcal{X}) = \\pi_S H(X_{n+1} | X_n=S) + \\pi_R H(X_{n+1} | X_n=R)\n$$\n$$\nH(\\mathcal{X}) = \\frac{1}{2} [-p\\log_2(p) - (1-p)\\log_2(1-p)] + \\frac{1}{2} [-p\\log_2(p) - (1-p)\\log_2(1-p)]\n$$\n$$\nH(\\mathcal{X}) = (\\frac{1}{2} + \\frac{1}{2}) [-p\\log_2(p) - (1-p)\\log_2(1-p)]\n$$\n$$\nH(\\mathcal{X}) = -p\\log_2(p) - (1-p)\\log_2(1-p)\n$$\n这个函数通常表示为二元熵函数 $H_b(p)$。单位是比特/符号，或者在此背景下，是比特/天。", "answer": "$$\\boxed{-p\\log_{2}(p) - (1-p)\\log_{2}(1-p)}$$", "id": "1621329"}, {"introduction": "最后一个练习通过分析一个由两个独立部分组成的复合系统，来深入探讨熵率的几个基本性质 [@problem_id:1621350]。这个练习将阐明两个关键概念：首先，一个完全可预测的（确定性）过程不会产生新信息，因此其熵率为零。其次，它强化了熵率的可加性原理，即多个独立信源产生的总信息量等于它们各自信息量之和。", "problem": "一个数据记录系统以离散的时间间隔监控两个独立的子系统，系统A和系统B，从而生成一个状态对序列。\n\n系统A是一个具有$M$个不同状态的高稳定性存储设备。一旦该设备被设置到某一特定状态，它将无限期地保持在该状态。其状态随时间的演变被建模为一个平稳马尔可夫过程。\n\n系统B是一个监控波动的二元现象的传感器。它有两个状态，标记为0和1。在每个时间步，系统有概率$p$转换到相反的状态，有概率$1-p$保持在同一状态。此过程也被建模为一个平稳马尔可夫信源。\n\n数据记录器在每个时间步记录来自两个系统的状态对。确定这个复合信息源的熵率。将你的答案表示为关于参数$p$的符号表达式，单位为比特/时间步。计算中，对数的底数必须为2。", "solution": "设复合信息源用$\\mathcal{C}$表示，它产生一个状态对序列$(S_A, S_B)$，其中$S_A$是系统A的状态，$S_B$是系统B的状态。设系统A和系统B的单个信源分别为$\\mathcal{A}$和$\\mathcal{B}$。由于两个子系统是独立的，复合信源的熵率是各单个信源熵率之和：\n$$H(\\mathcal{C}) = H(\\mathcal{A}) + H(\\mathcal{B})$$\n\n我们现在将分别计算每个信源的熵率。\n\n首先，考虑系统A。它有$M$个状态，一旦进入一个状态，就永远不会离开。这可以用一个$M \\times M$的马尔可夫转移矩阵$P^{(A)}$来描述，其中对角线元素为1，所有非对角线元素为0。这就是单位矩阵，$P^{(A)} = I_M$。\n\n一个平稳马尔可夫信源$\\mathcal{S}$的熵率由以下公式给出：\n$$H(\\mathcal{S}) = \\sum_{i} \\pi_i H_i$$\n其中$\\pi_i$是处于状态$i$的平稳概率，而$H_i$是在当前状态为$i$的条件下，下一状态分布的熵。量$H_i$的计算公式为：\n$$H_i = -\\sum_{j} P_{ij} \\log_{2}(P_{ij})$$\n其中$P_{ij}$是从状态$i$到状态$j$的转移概率。\n\n对于系统A，转移概率为$P^{(A)}_{ij} = \\delta_{ij}$，其中$\\delta_{ij}$是克罗内克δ。对于任意给定状态$i$，条件熵$H_i^{(A)}$为：\n$$H_i^{(A)} = -\\sum_{j=1}^{M} P^{(A)}_{ij} \\log_{2}(P^{(A)}_{ij}) = - P^{(A)}_{ii} \\log_{2}(P^{(A)}_{ii}) - \\sum_{j \\neq i} P^{(A)}_{ij} \\log_{2}(P^{(A)}_{ij})$$\n代入值$P^{(A)}_{ii} = 1$和$P^{(A)}_{ij} = 0$（当$j \\neq i$时）：\n$$H_i^{(A)} = - 1 \\cdot \\log_{2}(1) - \\sum_{j \\neq i} 0 \\cdot \\log_{2}(0)$$\n根据约定，当$x \\to 0$时，$x \\log x \\to 0$，该表达式简化为：\n$$H_i^{(A)} = -1 \\cdot 0 - 0 = 0$$\n由于这对所有状态$i=1, \\dots, M$都成立，系统A的熵率为：\n$$H(\\mathcal{A}) = \\sum_{i=1}^{M} \\pi_i^{(A)} \\cdot 0 = 0$$\n这个结果在直观上是合理的：在初始状态已知后，系统的演变是完全确定的（它从不改变），因此在每个时间步都不会产生新的信息。\n\n接下来，考虑系统B。这是一个状态为{0, 1}的二元马尔可夫信源，其转移矩阵为：\n$$P^{(B)} = \\begin{pmatrix} 1-p & p \\\\ p & 1-p \\end{pmatrix}$$\n由于信源是平稳的，其状态分布$\\boldsymbol{\\pi}^{(B)} = (\\pi_0, \\pi_1)$必须满足平稳条件$\\boldsymbol{\\pi}^{(B)} P^{(B)} = \\boldsymbol{\\pi}^{(B)}$。\n$$(\\pi_0, \\pi_1) \\begin{pmatrix} 1-p & p \\\\ p & 1-p \\end{pmatrix} = (\\pi_0, \\pi_1)$$\n这给出了方程组：\n1. $\\pi_0(1-p) + \\pi_1 p = \\pi_0 \\implies -\\pi_0 p + \\pi_1 p = 0 \\implies \\pi_0 = \\pi_1$ (当 $p \\neq 0$ 时)。\n2. $\\pi_0 p + \\pi_1 (1-p) = \\pi_1 \\implies \\pi_0 p - \\pi_1 p = 0 \\implies \\pi_0 = \\pi_1$ (当 $p \\neq 0$ 时)。\n我们还有归一化条件$\\pi_0 + \\pi_1 = 1$。结合这些，我们找到平稳分布：\n$$\\pi_0 = \\pi_1 = \\frac{1}{2}$$\n注意，如果$p=0$，$P^{(B)}$是单位矩阵，任何分布都是平稳的。如果$p=1$，系统确定性地翻转状态，而$\\boldsymbol{\\pi}^{(B)}=(1/2, 1/2)$是唯一的平稳分布。以下计算对所有有效的$p \\in [0, 1]$均成立。\n\n现在我们计算系统B的条件熵$H_0^{(B)}$和$H_1^{(B)}$。\n$$H_0^{(B)} = - \\left( P^{(B)}_{00} \\log_{2}(P^{(B)}_{00}) + P^{(B)}_{01} \\log_{2}(P^{(B)}_{01}) \\right) = - \\left( (1-p) \\log_{2}(1-p) + p \\log_{2}(p) \\right)$$\n$$H_1^{(B)} = - \\left( P^{(B)}_{10} \\log_{2}(P^{(B)}_{10}) + P^{(B)}_{11} \\log_{2}(P^{(B)}_{11}) \\right) = - \\left( p \\log_{2}(p) + (1-p) \\log_{2}(1-p) \\right)$$\n两者都等于二元熵函数，$H_b(p) = -p\\log_{2}(p) - (1-p)\\log_{2}(1-p)$。\n\n系统B的熵率为：\n$$H(\\mathcal{B}) = \\pi_0 H_0^{(B)} + \\pi_1 H_1^{(B)} = \\frac{1}{2} H_b(p) + \\frac{1}{2} H_b(p) = H_b(p)$$\n$$H(\\mathcal{B}) = -p \\log_{2}(p) - (1-p) \\log_{2}(1-p)$$\n\n最后，复合信源$\\mathcal{C}$的总熵率是各单个熵率之和：\n$$H(\\mathcal{C}) = H(\\mathcal{A}) + H(\\mathcal{B}) = 0 + \\left( -p \\log_{2}(p) - (1-p) \\log_{2}(1-p) \\right)$$\n$$H(\\mathcal{C}) = -p \\log_{2}(p) - (1-p) \\log_{2}(1-p)$$", "answer": "$$\\boxed{-p \\log_{2}(p) - (1-p) \\log_{2}(1-p)}$$", "id": "1621350"}]}