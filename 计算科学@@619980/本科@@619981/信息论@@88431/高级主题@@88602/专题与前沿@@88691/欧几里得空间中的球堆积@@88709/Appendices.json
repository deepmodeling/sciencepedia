{"hands_on_practices": [{"introduction": "我们在理论探讨之后，现在通过一个基础练习来巩固核心概念。这个练习将引导你计算二维空间中最简单、最直观的编码结构——方形晶格的堆积密度。通过这个计算 [@problem_id:1659588]，你将亲手实践如何确定最小距离、堆积半径以及基本区域的体积，这些都是评估任何编码效率的基础步骤。", "problem": "考虑一个简化的数字通信系统模型，其中信号被表示为二维欧几里得空间 $\\mathbb{R}^2$ 中的点。所有有效信号点的集合（称为码字）由无穷集合 $C = \\{(i, j) \\mid i, j \\in \\mathbb{Z}\\}$ 定义，其中 $\\mathbb{Z}$ 代表所有整数的集合。该结构形成一个简单的方格格点。\n\n为了分析此编码的效率，我们可以计算其球堆积密度。这个密度是指以每个码字为中心、互不重叠的“球”（在二维情况下是圆盘）所占据信号空间的比例。这些球的半径是能防止任意两个球发生重叠的最大可能值。密度 $\\Delta$ 被正式定义为单个球的体积与单个码字关联的基本区域的体积之比。\n\n给定码字的基本区域是空间中所有点的集合，这些点到该码字的距离比到任何其他码字的距离都更近。在这个二维情况下，“体积”指的是面积。\n\n计算这个无穷方格格点编码的球堆积密度 $\\Delta$。请用一个单一的闭式解析表达式来表示你的答案。", "solution": "该编码是方格格点 $\\mathbb{Z}^{2}$，其生成基向量为 $(1,0)$ 和 $(0,1)$。不同格点之间的最小距离等于最短非零格点向量的长度，即\n$$\nd_{\\min}=1.\n$$\n为使以格点为中心的等半径圆盘不发生重叠，堆积半径必须是最小距离的一半：\n$$\nr=\\frac{d_{\\min}}{2}=\\frac{1}{2}.\n$$\n一个这样的圆盘的面积是\n$$\nA_{\\text{disk}}=\\pi r^{2}=\\pi\\left(\\frac{1}{2}\\right)^{2}=\\frac{\\pi}{4}.\n$$\n格点的基本区域（沃罗诺伊单元）的面积等于其生成矩阵行列式的绝对值。对于 $\\mathbb{Z}^{2}$ 的单位生成矩阵，这个面积是\n$$\nA_{\\text{fund}}=1.\n$$\n因此，球（圆盘）堆积密度，定义为一个圆盘的面积与基本区域面积之比，为\n$$\n\\Delta=\\frac{A_{\\text{disk}}}{A_{\\text{fund}}}=\\frac{\\pi/4}{1}=\\frac{\\pi}{4}.\n$$", "answer": "$$\\boxed{\\frac{\\pi}{4}}$$", "id": "1659588"}, {"introduction": "从无限晶格转向更贴近实际应用的有限信号点集，即“信号星座”。在数字通信中，以尽可能低的能量实现可靠的传输至关重要。这个练习 [@problem_id:1659517] 让你比较两种不同的四点信号星座几何构型，在保持相同最小距离（即相同抗噪声性能）的前提下，哪一种构型更节能。这揭示了球堆积的几何学如何直接影响通信系统的能量效率。", "problem": "在数字通信系统中，信息通常被编码为信号，并表示为多维空间中的点。这种点的排列被称为信号星座图。一个包含 $M$ 个点的星座图，其中第 $i$ 个点位于坐标向量 $\\mathbf{s}_i$ 处，其平均能量定义为 $E_{avg} = \\frac{1}{M} \\sum_{i=1}^{M} \\|\\mathbf{s}_i\\|^2$。最小距离 $d_{min}$ 是星座图中任意两个不同点之间的最小欧几里得距离。在给定的能量水平下，较大的 $d_{min}$ 通常意味着在有噪声存在时性能更好。\n\n考虑在二维平面上两种不同的4点信号星座图，两者都以原点为中心。\n\n1.  **星座图 A**：一种4点脉冲幅度调制 (PAM) 风格的星座图，其中所有点都位于x轴上，关于原点对称，并且等间隔分布。\n2.  **星座图 B**：一种4点正交幅度调制 (QAM) 风格的星座图，其中这些点形成一个以原点为中心、边与坐标轴平行的正方形的顶点。\n\n两种星座图都经过缩放，使得它们的最小距离 $d_{min}$ 相同。确定星座图 A 的平均能量与星座图 B 的平均能量之比，即 $\\frac{E_{avg, A}}{E_{avg, B}}$。", "solution": "设两个星座图的最小距离均为 $d_{min}$。我们将根据 $d_{min}$ 确定每个星座图中点的坐标，计算它们各自的平均能量，然后求出比值。\n\n**星座图A（PAM类型）的分析**\n\n星座图A由位于x轴上的四个点组成，这些点等间隔分布且关于原点对称。设原点到最内侧点的距离为 $\\alpha$。由于等间隔和对称性，这些点必须位于坐标 $( -3\\alpha, 0)$、$(-\\alpha, 0)$、$(\\alpha, 0)$ 和 $(3\\alpha, 0)$ 处。\n\n任意两个相邻点之间的距离为 $(3\\alpha - \\alpha) = 2\\alpha$ 或 $(\\alpha - (-\\alpha)) = 2\\alpha$。其他距离都比这个值大。因此，最小距离是 $d_{min} = 2\\alpha$，这意味着 $\\alpha = \\frac{d_{min}}{2}$。\n\n星座图A中四个点的坐标是：\n$s_{A,1} = (-\\frac{3}{2}d_{min}, 0)$\n$s_{A,2} = (-\\frac{1}{2}d_{min}, 0)$\n$s_{A,3} = (\\frac{1}{2}d_{min}, 0)$\n$s_{A,4} = (\\frac{3}{2}d_{min}, 0)$\n\n每个点的平方范数（能量）是其到原点距离的平方。\n$\\|\\mathbf{s}_{A,1}\\|^2 = (-\\frac{3}{2}d_{min})^2 + 0^2 = \\frac{9}{4}d_{min}^2$\n$\\|\\mathbf{s}_{A,2}\\|^2 = (-\\frac{1}{2}d_{min})^2 + 0^2 = \\frac{1}{4}d_{min}^2$\n$\\|\\mathbf{s}_{A,3}\\|^2 = (\\frac{1}{2}d_{min})^2 + 0^2 = \\frac{1}{4}d_{min}^2$\n$\\|\\mathbf{s}_{A,4}\\|^2 = (\\frac{3}{2}d_{min})^2 + 0^2 = \\frac{9}{4}d_{min}^2$\n\n星座图A的平均能量为：\n$E_{avg, A} = \\frac{1}{4} \\sum_{i=1}^{4} \\|\\mathbf{s}_{A,i}\\|^2 = \\frac{1}{4} \\left( \\frac{9}{4}d_{min}^2 + \\frac{1}{4}d_{min}^2 + \\frac{1}{4}d_{min}^2 + \\frac{9}{4}d_{min}^2 \\right)$\n$E_{avg, A} = \\frac{1}{4} \\left( 2 \\cdot \\frac{9}{4}d_{min}^2 + 2 \\cdot \\frac{1}{4}d_{min}^2 \\right) = \\frac{1}{4} \\left( \\frac{18}{4}d_{min}^2 + \\frac{2}{4}d_{min}^2 \\right)$\n$E_{avg, A} = \\frac{1}{4} \\left( \\frac{20}{4}d_{min}^2 \\right) = \\frac{5}{4}d_{min}^2$\n\n**星座图B（QAM类型）的分析**\n\n星座图B由形成一个以原点为中心、边与坐标轴平行的正方形的四个点组成。设正方形的顶点位于 $(\\pm \\beta, \\pm \\beta)$。\n这四个点的坐标是：\n$s_{B,1} = (-\\beta, -\\beta)$\n$s_{B,2} = (-\\beta, \\beta)$\n$s_{B,3} = (\\beta, -\\beta)$\n$s_{B,4} = (\\beta, \\beta)$\n\n相邻顶点之间的距离，例如 $(\\beta, \\beta)$ 和 $(-\\beta, \\beta)$ 之间的距离，是 $\\sqrt{(\\beta - (-\\beta))^2 + (\\beta - \\beta)^2} = \\sqrt{(2\\beta)^2} = 2\\beta$。这是正方形的边长。对角线距离，例如 $(\\beta, \\beta)$ 和 $(-\\beta, -\\beta)$ 之间的距离，是 $\\sqrt{(\\beta - (-\\beta))^2 + (\\beta - (-\\beta))^2} = \\sqrt{(2\\beta)^2 + (2\\beta)^2} = \\sqrt{8\\beta^2} = 2\\sqrt{2}\\beta$。\n\n任意两点之间的最小距离是正方形的边长。所以，$d_{min} = 2\\beta$，这意味着 $\\beta = \\frac{d_{min}}{2}$。\n\n星座图B中四个点的坐标是：\n$s_{B,1} = (-\\frac{d_{min}}{2}, -\\frac{d_{min}}{2})$\n$s_{B,2} = (-\\frac{d_{min}}{2}, \\frac{d_{min}}{2})$\n$s_{B,3} = (\\frac{d_{min}}{2}, -\\frac{d_{min}}{2})$\n$s_{B,4} = (\\frac{d_{min}}{2}, \\frac{d_{min}}{2})$\n\n根据对称性，所有四个点到原点的距离都相同，因此它们的能量也相同。我们来计算其中一个点，比如 $s_{B,4}$ 的能量：\n$\\|\\mathbf{s}_{B,4}\\|^2 = (\\frac{d_{min}}{2})^2 + (\\frac{d_{min}}{2})^2 = \\frac{d_{min}^2}{4} + \\frac{d_{min}^2}{4} = \\frac{2d_{min}^2}{4} = \\frac{1}{2}d_{min}^2$\n\n由于所有点的能量都相同，平均能量就是任意一个点的能量：\n$E_{avg, B} = \\|\\mathbf{s}_{B,4}\\|^2 = \\frac{1}{2}d_{min}^2$\n\n**计算比值**\n\n最后，我们计算平均能量的比值：\n$\\frac{E_{avg, A}}{E_{avg, B}} = \\frac{\\frac{5}{4}d_{min}^2}{\\frac{1}{2}d_{min}^2}$\n\n$d_{min}^2$ 项被消掉：\n$\\frac{E_{avg, A}}{E_{avg, B}} = \\frac{5/4}{1/2} = \\frac{5}{4} \\times \\frac{2}{1} = \\frac{10}{4} = \\frac{5}{2}$", "answer": "$$\\boxed{\\frac{5}{2}}$$", "id": "1659517"}, {"introduction": "现在，让我们将视野从二维特例扩展到更普适的 $n$ 维空间，并从分析现有编码转向思考如何构造新编码。本题 [@problem_id:1659562] 提出了一个贪心算法来逐步构建一个纠错码，并要求你基于该算法的终止条件推导出一个关于码字数量的下界。这个练习不仅让你体验构造性证明的思路，还引入了“覆盖论证”这一强大工具，它是信息论中用于确立编码能力极限（如著名的 Gilbert-Varshamov 界）的核心思想。", "problem": "一个通信系统将消息编码为 $n$ 维欧几里得空间 $\\mathbb{R}^n$ 中的点（码字）。当一个码字 $\\vec{x}_i$ 被发送时，接收到的向量 $\\vec{y}$ 会被噪声所干扰，使得误差向量 $\\vec{e} = \\vec{y} - \\vec{x}_i$ 的大小满足 $\\|\\vec{e}\\| < r$。为确保完美解码，所有可能码字的集合 $\\{\\vec{x}_1, \\vec{x}_2, \\ldots, \\vec{x}_M\\}$ 的选择必须满足：以每个码字为中心、半径为 $r$ 的开球是互不相交的。\n\n考虑一个任务，即从一个总体积为 $V_{total}$ 的大超区域中选择码字来构建这样一个码本。为此任务提出了一个贪心算法：\n\n1.  将码本 $C$ 初始化为空集。\n2.  从该超区域中选择一个任意点 $\\vec{p}_1$ 并将其添加到 $C$ 中。\n3.  迭代地从该超区域中选择一个新的候选点 $\\vec{p}_{new}$。\n4.  如果 $\\vec{p}_{new}$ 到 $C$ 中每个已有码字 $\\vec{x}_i \\in C$ 的距离都至少为 $2r$，则将 $\\vec{p}_{new}$ 添加到码本 $C$ 中。\n5.  重复步骤3，直到无法再向码本中添加任何点为止。\n\n令 $M$ 为该算法生成的最终码本中的码字总数。通过考虑算法终止时的系统状态，推导出 $M$ 的最强可能下界。假设该超区域的边界效应可以忽略不计。\n\n一个半径为 $R$ 的 $n$ 维球体的体积由公式 $V_n(R) = C_n R^n$ 给出，其中 $C_n$ 是一个仅取决于维度 $n$ 的常数。\n\n请将 $M$ 的下界表示为 $V_{total}$、$r$、$n$ 和 $C_n$ 的函数。", "solution": "问题要求解由一个特定贪心算法生成的码字数量 $M$ 的下界。关键在于分析算法终止的条件。\n\n首先，我们来理解编码约束。对于码本 $C$ 中任意两个不同的码字 $\\vec{x}_i$ 和 $\\vec{x}_j$，它们周围半径为 $r$ 的开球必须互不相交。两个球 $B(\\vec{x}_i, r)$ 和 $B(\\vec{x}_j, r)$ 互不相交的条件是，它们中心之间的距离必须至少等于它们的半径之和。因此，对于 $i \\neq j$ 的任意 $\\vec{x}_i, \\vec{x}_j \\in C$，我们必须有 $\\|\\vec{x}_i - \\vec{x}_j\\| \\ge r + r = 2r$。这正是贪心算法步骤4中用于接纳一个新码字的条件。\n\n当无法再向码本 $C$ 中添加新点时，算法终止。设最终码本包含 $M$ 个码字，即 $C = \\{\\vec{x}_1, \\vec{x}_2, \\ldots, \\vec{x}_M\\}$。终止条件意味着，对于体积为 $V_{total}$ 的超区域中的任何点 $\\vec{p}$（该点不是已选码字之一），将其添加到码本的条件被违反了。\n\n添加点 $\\vec{p}$ 的条件是对于所有 $i \\in \\{1, \\ldots, M\\}$ 都满足 $\\|\\vec{p} - \\vec{x}_i\\| \\ge 2r$。该条件的违反意味着，对于任何这样的点 $\\vec{p}$，必然存在至少一个码字 $\\vec{x}_k \\in C$ 使得 $\\|\\vec{p} - \\vec{x}_k\\| < 2r$。\n\n这意味着在算法结束时，超区域中的每个点都与 $M$ 个码字中的至少一个的距离在 $2r$ 以内。换句话说，整个体积为 $V_{total}$ 的超区域被以 $M$ 个码字为中心、半径为 $2r$ 的 $M$ 个开球的并集所“覆盖”。\n\n令 $\\mathcal{V}$ 为体积为 $V_{total}$ 的超区域。覆盖条件可以表述为：\n$$\n\\mathcal{V} \\subseteq \\bigcup_{i=1}^{M} B(\\vec{x}_i, 2r)\n$$\n其中 $B(\\vec{c}, R)$ 表示以 $\\vec{c}$ 为中心、半径为 $R$ 的开$n$-球。\n\n根据体积（或更一般地，测度）的性质，集合并集的体积小于或等于各个集合体积之和。\n$$\n\\text{Volume}(\\mathcal{V}) \\le \\text{Volume}\\left(\\bigcup_{i=1}^{M} B(\\vec{x}_i, 2r)\\right) \\le \\sum_{i=1}^{M} \\text{Volume}(B(\\vec{x}_i, 2r))\n$$\n\n我们已知 $\\text{Volume}(\\mathcal{V}) = V_{total}$。\n单个半径为 $2r$ 的 $n$-球的体积由公式 $V_n(R) = C_n R^n$ 给出，其中 $R=2r$。\n$$\nV_n(2r) = C_n (2r)^n = C_n 2^n r^n\n$$\n\n由于这 $M$ 个覆盖球的半径都相同，它们的体积之和为：\n$$\n\\sum_{i=1}^{M} \\text{Volume}(B(\\vec{x}_i, 2r)) = M \\cdot V_n(2r) = M C_n 2^n r^n\n$$\n\n将这些代入我们的不等式，得到：\n$$\nV_{total} \\le M C_n 2^n r^n\n$$\n\n为了求出 $M$ 的下界，我们通过除以正量 $C_n 2^n r^n$ 来整理不等式：\n$$\nM \\ge \\frac{V_{total}}{C_n 2^n r^n}\n$$\n\n因此，从这个覆盖论证中可以推导出的 $M$ 的最强下界是 $\\frac{V_{total}}{C_n 2^n r^n}$。", "answer": "$$\\boxed{\\frac{V_{total}}{C_n 2^n r^n}}$$", "id": "1659562"}]}