{"hands_on_practices": [{"introduction": "探索统计空间的几何结构，第一步是理解其度量。本练习将通过计算一个常见的连续概率分布（逻辑斯谛分布）的费雪信息，让你实践如何确定作为度量张量的费雪信息。这项技能是进行所有后续几何分析的基础。[@problem_id:1631458]", "problem": "在统计信号处理中，逻辑斯谛分布有时被用来对测量中的噪声或误差进行建模。一族逻辑斯谛分布由其概率密度函数 (PDF) 描述：\n$$\np(x; \\mu, s) = \\frac{\\exp\\left(-\\frac{x-\\mu}{s}\\right)}{s\\left(1 + \\exp\\left(-\\frac{x-\\mu}{s}\\right)\\right)^2}\n$$\n其中 $\\mu$ 是位置参数（代表分布的均值），$s$ 是尺度参数（与方差相关）。\n\n考虑一个特定的测量系统，其噪声由尺度参数固定为 $s=1$ 的逻辑斯谛分布建模。位置参数 $\\mu$ 对应于被测量的真实物理量，是我们希望从观测值 $x$ 中估计的参数。\n\n费雪信息，记作 $I(\\mu)$，量化了随机变量 $x$ 所携带的关于未知参数 $\\mu$ 的信息量。对于此模型，计算关于位置参数 $\\mu$ 的费雪信息。\n\n请以精确分数形式给出你的答案。", "solution": "给定尺度参数固定为 $s=1$ 的逻辑斯谛密度函数：\n$$\np(x;\\mu) = \\frac{\\exp\\left(-\\left(x-\\mu\\right)\\right)}{\\left(1+\\exp\\left(-\\left(x-\\mu\\right)\\right)\\right)^{2}}.\n$$\n对于关于位置参数 $\\mu$ 的费雪信息，我们使用其定义\n$$\nI(\\mu) = \\mathbb{E}\\!\\left[\\left(\\frac{\\partial}{\\partial \\mu}\\ln p(X;\\mu)\\right)^{2}\\right].\n$$\n引入 $y = x - \\mu$，使得\n$$\np(x;\\mu) = f(y), \\quad \\text{with} \\quad f(y) = \\frac{\\exp(-y)}{\\left(1+\\exp(-y)\\right)^{2}}.\n$$\n作为 $y$ 的函数的对数密度为\n$$\n\\ln p(x;\\mu) = \\ln f(y) = -y - 2\\ln\\!\\left(1+\\exp(-y)\\right).\n$$\n根据链式法则，由于 $y = x - \\mu$ 意味着 $\\frac{\\mathrm{d}y}{\\mathrm{d}\\mu} = -1$，\n$$\n\\frac{\\partial}{\\partial \\mu}\\ln p(x;\\mu) = -\\frac{\\mathrm{d}}{\\mathrm{d} y}\\ln f(y).\n$$\n将 $\\ln f(y)$ 对 $y$ 求导：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d} y}\\ln f(y) = -1 - 2 \\cdot \\frac{1}{1+\\exp(-y)} \\cdot \\frac{\\mathrm{d}}{\\mathrm{d} y}\\left(1+\\exp(-y)\\right)\n= -1 - 2 \\cdot \\frac{1}{1+\\exp(-y)} \\cdot \\left(-\\exp(-y)\\right)\n= -1 + \\frac{2\\exp(-y)}{1+\\exp(-y)}.\n$$\n因此分数函数为\n$$\n\\frac{\\partial}{\\partial \\mu}\\ln p(x;\\mu) = 1 - \\frac{2\\exp(-y)}{1+\\exp(-y)} = -1 + \\frac{2}{1+\\exp(-y)}.\n$$\n定义逻辑斯谛累积分布函数\n$$\nF(y) = \\frac{1}{1+\\exp(-y)}.\n$$\n那么分数函数简化为\n$$\n\\frac{\\partial}{\\partial \\mu}\\ln p(x;\\mu) = 2 F(y) - 1.\n$$\n因此，费雪信息为\n$$\nI(\\mu) = \\mathbb{E}\\!\\left[(2F(Y)-1)^{2}\\right],\n$$\n其中 $Y$ 的密度函数为 $f(y)$，累积分布函数为 $F(y)$。根据概率积分变换，$W = F(Y)$ 在区间 $[0,1]$ 上服从均匀分布，并且 $\\mathrm{d}w = f(y)\\,\\mathrm{d}y$。因此，\n$$\nI(\\mu) = \\int_{-\\infty}^{\\infty} \\left(2F(y)-1\\right)^{2} f(y)\\,\\mathrm{d}y\n= \\int_{0}^{1} (2w-1)^{2}\\,\\mathrm{d}w.\n$$\n计算该积分：\n$$\n\\int_{0}^{1} (2w-1)^{2}\\,\\mathrm{d}w\n= \\int_{0}^{1} \\left(4w^{2} - 4w + 1\\right)\\mathrm{d}w\n= \\left[\\frac{4}{3}w^{3} - 2w^{2} + w\\right]_{0}^{1}\n= \\frac{4}{3} - 2 + 1\n= \\frac{1}{3}.\n$$\n因此，当 $s=1$ 时，关于位置参数 $\\mu$ 的费雪信息是精确分数 $\\frac{1}{3}$。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1631458"}, {"introduction": "有了度量，我们就可以定义两点之间最短或最直的路径——即测地线。本练习利用一个直观的场景（给骰子“加载”），探讨如何在概率分布流形上找到测地线路径。你将运用强大的等距映射方法，将问题转化到超球面上来解决。[@problem_id:1631496]", "problem": "考虑一个标准的六面骰子。其统计状态由一个概率分布向量 $P = (p_1, p_2, p_3, p_4, p_5, p_6)$ 描述，其中 $p_i$ 是掷出点数为 $i$ 的面的概率。这些概率必须满足 $p_i \\ge 0$ (对所有 $i$) 且 $\\sum_{i=1}^{6} p_i = 1$。所有此类分布的集合构成一个5维统计流形。\n\n该流形上赋予了费雪信息度量，它提供了一种自然的方式来衡量不同概率分布之间的“距离”。这个特定统计流形的一个基本性质是其与球面几何的联系。通过坐标变换 $\\xi_i = 2\\sqrt{p_i}$，该概率分布流形被等距地映射到嵌入在六维欧几里得空间（$\\mathbb{R}^6$）中半径为 $R=2$ 的5维球面的正象限上。此球面上的所有点都满足方程 $\\sum_{i=1}^{6} \\xi_i^2 = 4$。在此映射下，统计流形上的测地线（代表“最直的可能路径”）对应于该超球面上的大圆。\n\n假设骰子最初是公平的，即对所有 $i \\in \\{1, 2, 3, 4, 5, 6\\}$ 都有 $p_i(0) = 1/6$。然后，骰子以一种非常特殊的方式被“加权”。其概率分布开始变化，并沿着统计流形上的一条测地线路径演变。这种变化的初始方向是使得掷出“6”的概率增加，而掷出其他五个面（“1”到“5”）的概率对称地减少（即以相同的速率减少）。\n\n请确定掷出“6”的概率，记为 $p_6(s)$，其是沿此测地线路径从公平的初始状态开始所经过的费雪信息弧长 $s$ 的函数。", "solution": "我们使用费雪度量流形的等距嵌入 $\\xi_{i}=2\\sqrt{p_{i}}$，将其嵌入到 $\\mathbb{R}^{6}$ 中半径为 $R=2$ 的5维球面上，该球面上的所有点都满足 $\\sum_{i=1}^{6}\\xi_{i}^{2}=4$。在此映射下，费雪信息弧长等于球面上沿大圆的欧几里得弧长。\n\n在公平分布时，对所有 $i$ 都有 $p_{i}(0)=\\frac{1}{6}$，因此\n$$\n\\xi_{i}(0)=\\frac{2}{\\sqrt{6}} \\quad \\text{对所有 } i,\n$$\n位置向量为\n$$\n\\Xi_{0}=\\left(\\frac{2}{\\sqrt{6}},\\frac{2}{\\sqrt{6}},\\frac{2}{\\sqrt{6}},\\frac{2}{\\sqrt{6}},\\frac{2}{\\sqrt{6}},\\frac{2}{\\sqrt{6}}\\right).\n$$\n测地线沿着一个方向延伸，该方向使得 $p_{6}$ 增加，而 $p_{1},\\dots,p_{5}$ 对称地减少。在 $\\xi$ 坐标系中，设 $s=0$ 处的初始切向量 $v$ 的分量为\n$$\nv_{1}=v_{2}=v_{3}=v_{4}=v_{5}=a,\\quad v_{6}=b,\n$$\n且满足切空间条件 $v\\cdot \\Xi_{0}=0$（与半径向量正交）和单位速率条件 $\\|v\\|=1$（因为 $s$ 是弧长）。正交性条件给出\n$$\n\\Xi_{0}\\cdot v=\\sum_{i=1}^{6}\\xi_{i}(0)\\,v_{i}=\\frac{2}{\\sqrt{6}}\\,(5a+b)=0\n\\;\\;\\Longrightarrow\\;\\; b=-5a.\n$$\n单位速率条件要求\n$$\n\\|v\\|^{2}=5a^{2}+b^{2}=5a^{2}+25a^{2}=30a^{2}=1\n\\;\\;\\Longrightarrow\\;\\; a=-\\frac{1}{\\sqrt{30}},\\quad b=\\frac{5}{\\sqrt{30}},\n$$\n选择 $a0$ 是为了使 $v_{6}=b0$，从而 $p_{6}$ 初始时增加。\n\n在半径为 $R=2$ 的球面上，由弧长 $s$ 参数化的单位速率大圆为\n$$\n\\xi(s)=\\Xi_{0}\\cos\\!\\left(\\frac{s}{2}\\right)+2\\,v\\,\\sin\\!\\left(\\frac{s}{2}\\right).\n$$\n因此第六个坐标的演变如下\n$$\n\\xi_{6}(s)=\\frac{2}{\\sqrt{6}}\\cos\\!\\left(\\frac{s}{2}\\right)+2\\cdot\\frac{5}{\\sqrt{30}}\\sin\\!\\left(\\frac{s}{2}\\right)\n=\\frac{\\sqrt{6}}{3}\\cos\\!\\left(\\frac{s}{2}\\right)+\\frac{\\sqrt{30}}{3}\\sin\\!\\left(\\frac{s}{2}\\right).\n$$\n使用 $p_{6}(s)=\\xi_{6}(s)^{2}/4$ 映射回概率，得到\n$$\np_{6}(s)=\\frac{1}{36}\\left(\\sqrt{6}\\cos\\!\\left(\\frac{s}{2}\\right)+\\sqrt{30}\\sin\\!\\left(\\frac{s}{2}\\right)\\right)^{2}.\n$$\n作为检验，在 $s=0$ 时，我们得到 $p_{6}(0)=\\frac{1}{36}\\left(\\sqrt{6}\\right)^{2}=\\frac{1}{6}$，并且初始导数为正，这与指定的加权方向一致。", "answer": "$$\\boxed{\\frac{1}{36}\\left(\\sqrt{6}\\cos\\left(\\frac{s}{2}\\right)+\\sqrt{30}\\sin\\left(\\frac{s}{2}\\right)\\right)^{2}}$$", "id": "1631496"}, {"introduction": "信息几何不仅能描述路径，还提供了理解点与子流形之间关系的工具，例如投影。本练习要求你使用库尔贝克-莱布勒（$D_{KL}$）散度来验证一个信息几何版本的毕达哥拉斯定理。这个过程将具体展示几何、距离和统计推断之间的深刻联系。[@problem_id:1631519]", "problem": "在信息几何领域，所有给定形式的概率分布的集合可以被看作是一个光滑流形。对于一个有三种可能结果的离散随机变量，所有可能的概率分布集合构成一个二维统计流形，这可以被看作是 $\\mathbb{R}^3$ 中的一个单纯形。\n\n考虑一个可以取三种状态 $\\{1, 2, 3\\}$ 之一的随机变量的两个特定概率分布 $P$ 和 $R$。这些分布由以下概率向量给出：\n- $P = (p_1, p_2, p_3) = (1/2, 1/4, 1/4)$\n- $R = (r_1, r_2, r_3) = (1/3, 1/3, 1/3)$\n\n令 $S$ 为此空间内的一个一维子流形，由前两个结果的概率相等的线性约束所定义。即，$S = \\{Q = (q_1, q_2, q_3) | q_1 = q_2 \\text{ 且 } \\sum q_i = 1, q_i  0\\}$。\n\n信息几何勾股定理将一个点 $P$ 与其在子流形 $S$ 上的投影联系起来。$P$ 在 $S$ 上的“e-投影”（我们记作 $P^*$）是 $S$ 中唯一的点，它使得从 $P$ 到 $S$ 中各点的 Kullback-Leibler (KL) 散度最小。对于两个分布 $A=(a_i)$ 和 $B=(b_i)$，KL 散度定义为 $D_{KL}(A||B) = \\sum_{i} a_i \\ln(a_i/b_i)$。该定理指出，对于所述设定，有 $D_{KL}(P||R) = D_{KL}(P||P^*) + D_{KL}(P^*||R)$。\n\n您的任务是为给定的分布验证此定理。首先，求出 $P$ 在子流形 $S$ 上的 e-投影 $P^*$。然后，计算三个散度的值：$A = D_{KL}(P||R)$，$B = D_{KL}(P||P^*)$ 和 $C = D_{KL}(P^*||R)$。\n\n计算比值 $\\frac{A}{B+C}$ 的数值。最终结果应为一个精确值，而不是一个小数近似值。", "solution": "给定 $P=(p_{1},p_{2},p_{3})=(\\frac{1}{2},\\frac{1}{4},\\frac{1}{4})$，$R=(r_{1},r_{2},r_{3})=(\\frac{1}{3},\\frac{1}{3},\\frac{1}{3})$，以及子流形 $S=\\{Q=(q_{1},q_{2},q_{3}):q_{1}=q_{2},\\,q_{1}+q_{2}+q_{3}=1,\\,q_{i}0\\}$。\n\n为了求出 $P$ 在 $S$ 上的 e-投影 $P^{*}$，我们需要在 $Q\\in S$ 的条件下最小化 $D_{KL}(P\\|Q)=\\sum_{i=1}^{3}p_{i}\\ln\\!\\left(\\frac{p_{i}}{q_{i}}\\right)$。由于 $\\sum_{i}p_{i}\\ln p_{i}$ 相对于 $Q$ 是一个常数，这等价于在约束条件 $q_{1}=q_{2}$ 和 $q_{1}+q_{2}+q_{3}=1$ 下最小化\n$$\nf(Q)=-\\sum_{i=1}^{3}p_{i}\\ln q_{i}\n$$\n令 $q_{1}=q_{2}=t$ 且 $q_{3}=1-2t$，其中 $0t\\frac{1}{2}$。则\n$$\nf(t)=-(p_{1}+p_{2})\\ln t-p_{3}\\ln(1-2t).\n$$\n求导并令其为零：\n$$\n\\frac{df}{dt}=-\\frac{p_{1}+p_{2}}{t}+\\frac{2p_{3}}{1-2t}=0\n\\quad\\Longrightarrow\\quad\n\\frac{2p_{3}}{1-2t}=\\frac{p_{1}+p_{2}}{t}.\n$$\n交叉相乘得到\n$$\n2p_{3}t=(p_{1}+p_{2})(1-2t)\n\\;\\Longrightarrow\\;\n2\\big(p_{3}+p_{1}+p_{2}\\big)t=p_{1}+p_{2}\n\\;\\Longrightarrow\\;\n2t=p_{1}+p_{2}\n\\;\\Longrightarrow\\;\nt=\\frac{p_{1}+p_{2}}{2}.\n$$\n由于 $p_{1}+p_{2}+p_{3}=1$，可得 $q_{3}=1-2t=p_{3}$。因此\n$$\nP^{*}=\\left(\\frac{p_{1}+p_{2}}{2},\\,\\frac{p_{1}+p_{2}}{2},\\,p_{3}\\right)=\\left(\\frac{3}{8},\\,\\frac{3}{8},\\,\\frac{1}{4}\\right).\n$$\n二阶导数为\n$$\n\\frac{d^{2}f}{dt^{2}}=\\frac{p_{1}+p_{2}}{t^{2}}+\\frac{4p_{3}}{(1-2t)^{2}}0,\n$$\n因此该临界点是唯一的最小值点，这符合 e-投影的要求。\n\n接下来，计算散度 $A=D_{KL}(P\\|R)$，$B=D_{KL}(P\\|P^{*})$ 和 $C=D_{KL}(P^{*}\\|R)$。\n\n对于 $A$：\n$$\nA=\\sum_{i=1}^{3}p_{i}\\ln\\!\\left(\\frac{p_{i}}{r_{i}}\\right)\n=\\sum_{i=1}^{3}p_{i}\\ln(3p_{i})\n=\\frac{1}{2}\\ln\\!\\left(\\frac{3}{2}\\right)+\\frac{1}{4}\\ln\\!\\left(\\frac{3}{4}\\right)+\\frac{1}{4}\\ln\\!\\left(\\frac{3}{4}\\right)\n=\\frac{1}{2}\\ln\\!\\left(\\frac{9}{8}\\right).\n$$\n\n对于 $B$：\n$$\nB=\\sum_{i=1}^{3}p_{i}\\ln\\!\\left(\\frac{p_{i}}{q_{i}^{*}}\\right)\n=\\frac{1}{2}\\ln\\!\\left(\\frac{\\frac{1}{2}}{\\frac{3}{8}}\\right)+\\frac{1}{4}\\ln\\!\\left(\\frac{\\frac{1}{4}}{\\frac{3}{8}}\\right)+\\frac{1}{4}\\ln\\!\\left(\\frac{\\frac{1}{4}}{\\frac{1}{4}}\\right)\n=\\frac{1}{2}\\ln\\!\\left(\\frac{4}{3}\\right)+\\frac{1}{4}\\ln\\!\\left(\\frac{2}{3}\\right)+0.\n$$\n使用 $\\ln\\!\\left(\\frac{4}{3}\\right)=-\\ln\\!\\left(\\frac{3}{4}\\right)$ 和 $\\ln\\!\\left(\\frac{2}{3}\\right)=-\\ln\\!\\left(\\frac{3}{2}\\right)$，我们得到\n$$\nB=-\\frac{1}{2}\\ln\\!\\left(\\frac{3}{4}\\right)-\\frac{1}{4}\\ln\\!\\left(\\frac{3}{2}\\right).\n$$\n\n对于 $C$：\n$$\nC=\\sum_{i=1}^{3}q_{i}^{*}\\ln\\!\\left(\\frac{q_{i}^{*}}{r_{i}}\\right)\n=\\sum_{i=1}^{3}q_{i}^{*}\\ln(3q_{i}^{*})\n=\\frac{3}{8}\\ln\\!\\left(\\frac{9}{8}\\right)+\\frac{3}{8}\\ln\\!\\left(\\frac{9}{8}\\right)+\\frac{1}{4}\\ln\\!\\left(\\frac{3}{4}\\right)\n=\\frac{3}{4}\\ln\\!\\left(\\frac{9}{8}\\right)+\\frac{1}{4}\\ln\\!\\left(\\frac{3}{4}\\right).\n$$\n由于 $\\ln\\!\\left(\\frac{9}{8}\\right)=\\ln\\!\\left(\\frac{3}{2}\\right)+\\ln\\!\\left(\\frac{3}{4}\\right)$，我们可以将 C 写成\n$$\nC=\\frac{3}{4}\\ln\\!\\left(\\frac{3}{2}\\right)+\\ln\\!\\left(\\frac{3}{4}\\right).\n$$\n\n现在对 $B$ 和 $C$ 求和：\n$$\nB+C=\\left[-\\frac{1}{2}\\ln\\!\\left(\\frac{3}{4}\\right)-\\frac{1}{4}\\ln\\!\\left(\\frac{3}{2}\\right)\\right]+\\left[\\frac{3}{4}\\ln\\!\\left(\\frac{3}{2}\\right)+\\ln\\!\\left(\\frac{3}{4}\\right)\\right]\n=\\frac{1}{2}\\ln\\!\\left(\\frac{3}{2}\\right)+\\frac{1}{2}\\ln\\!\\left(\\frac{3}{4}\\right)\n=\\frac{1}{2}\\ln\\!\\left(\\frac{9}{8}\\right).\n$$\n因此 $A=B+C$，所求的比值为\n$$\n\\frac{A}{B+C}=1.\n$$\n这就为给定的分布和子流形验证了信息几何勾股定理。", "answer": "$$\\boxed{1}$$", "id": "1631519"}]}