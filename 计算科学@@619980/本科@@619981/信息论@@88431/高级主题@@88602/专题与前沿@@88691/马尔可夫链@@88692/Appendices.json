{"hands_on_practices": [{"introduction": "理解马尔可夫链的第一步是学会如何追踪其随时间的状态演化。这个练习将带你实践如何运用概率论中的链式法则和全概率公式，来计算一个特定状态序列的发生概率。这是一个基础但至关重要的技能，它构成了所有更复杂分析的基石，例如预测一个简化的基因表达模型在未来几个时间步内的行为 [@problem_id:1639051]。", "problem": "一个简化的生物物理模型描述了某个特定基因的转录活性。该基因的启动子可以处于两种状态之一：'ON'（正在主动转录信使RNA）或 'OFF'（非活动状态）。在离散时间步 $n$，基因的状态由随机变量 $X_n$ 表示。该过程被建模为一个时间齐次马尔可夫链。\n\n在观察开始时，即时间 $n=0$ 时，基因处于 'ON' 状态的概率为 $P(X_0 = \\text{'ON'}) = \\frac{1}{3}$。\n\n单个时间步内的状态转移遵循以下概率：\n- 在时间 $n$ 处于 'ON' 状态的基因，在时间 $n+1$ 仍然处于 'ON' 状态的概率为 $0.8$。\n- 在时间 $n$ 处于 'OFF' 状态的基因，在时间 $n+1$ 转移到 'ON' 状态的概率为 $0.4$。\n\n计算基因在时间步 $n=1$ 处于 'ON' 状态，并且在时间步 $n=2$ 处于 'OFF' 状态的联合概率。换句话说，求出 $P(X_1 = \\text{'ON'}, X_2 = \\text{'OFF'})$ 的值。将最终答案表示为小数，并四舍五入到三位有效数字。", "solution": "问题要求计算联合概率 $P(X_1 = \\text{'ON'}, X_2 = \\text{'OFF'})$。我们可以通过首先定义状态和转移概率，然后利用马尔可夫链的性质和概率的链式法则来解决这个问题。\n\n让我们将两种状态表示为 $S_{on} = \\text{'ON'}$ 和 $S_{off} = \\text{'OFF'}$。\n\n首先，我们根据给定信息建立完整的初始概率和转移概率集合。\n\n在时间 $n=0$ 时的初始概率为：\n$P(X_0 = S_{on}) = \\frac{1}{3}$\n由于只有两种状态，初始时处于 'OFF' 状态的概率为：\n$P(X_0 = S_{off}) = 1 - P(X_0 = S_{on}) = 1 - \\frac{1}{3} = \\frac{2}{3}$\n\n给定的转移概率为：\n$P(X_{n+1} = S_{on} | X_n = S_{on}) = 0.8$\n$P(X_{n+1} = S_{on} | X_n = S_{off}) = 0.4$\n\n由此，我们可以推导出另外两个转移概率，因为从一个给定状态转移出去的概率之和必须为1：\n$P(X_{n+1} = S_{off} | X_n = S_{on}) = 1 - P(X_{n+1} = S_{on} | X_n = S_{on}) = 1 - 0.8 = 0.2$\n$P(X_{n+1} = S_{off} | X_n = S_{off}) = 1 - P(X_{n+1} = S_{on} | X_n = S_{off}) = 1 - 0.4 = 0.6$\n\n现在，我们可以计算目标联合概率 $P(X_1 = S_{on}, X_2 = S_{off})$。使用概率的链式法则，我们可以写出：\n$$P(X_1 = S_{on}, X_2 = S_{off}) = P(X_2 = S_{off} | X_1 = S_{on}) \\times P(X_1 = S_{on})$$\n\n第一项 $P(X_2 = S_{off} | X_1 = S_{on})$ 是从 'ON' 转移到 'OFF' 的概率。由于马尔可夫链的时间齐次性，这正是我们之前找到的单步转移概率：\n$$P(X_2 = S_{off} | X_1 = S_{on}) = 0.2$$\n\n第二项 $P(X_1 = S_{on})$ 是基因在时间 $n=1$ 处于 'ON' 状态的总概率。我们可以使用全概率公式，对 $n=0$ 时的所有可能状态求和来计算它：\n$$P(X_1 = S_{on}) = P(X_1 = S_{on} | X_0 = S_{on})P(X_0 = S_{on}) + P(X_1 = S_{on} | X_0 = S_{off})P(X_0 = S_{off})$$\n代入已知值：\n$$P(X_1 = S_{on}) = (0.8) \\left(\\frac{1}{3}\\right) + (0.4) \\left(\\frac{2}{3}\\right)$$\n$$P(X_1 = S_{on}) = \\frac{0.8}{3} + \\frac{0.8}{3} = \\frac{1.6}{3}$$\n\n现在我们可以将计算出的两个部分代回到我们最初的联合概率方程中：\n$$P(X_1 = S_{on}, X_2 = S_{off}) = (0.2) \\times \\left(\\frac{1.6}{3}\\right)$$\n$$P(X_1 = S_{on}, X_2 = S_{off}) = \\frac{0.32}{3}$$\n$$P(X_1 = S_{on}, X_2 = S_{off}) = 0.10666...$$\n\n问题要求答案四舍五入到三位有效数字。第一位有效数字是 1，第二位是 0，第三位是 6。下一位数字是 6，大于或等于 5，所以我们将第三位有效数字向上取整。\n$$0.10666... \\approx 0.107$$", "answer": "$$\\boxed{0.107}$$", "id": "1639051"}, {"introduction": "在掌握了系统的短期演化之后，一个自然而然的问题是：从长远来看，系统会呈现出怎样的行为？这个练习将探索“平稳分布”这一核心概念，它描述了当马尔可夫链运行很长时间后，系统处于各个状态的概率分布。通过为一个在房间内移动的扫地机器人的场景建立模型，你将亲手构建并求解描述系统平衡状态的方程组，这是分析马尔可夫链稳态行为的一项基本技术 [@problem_id:1639083]。", "problem": "一款新型扫地机器人正在一个由客厅、厨房和卧室三个房间组成的小型公寓里进行测试。机器人在这几个房间之间的移动是概率性的，可以用一个离散时间马尔可夫链来描述。系统的状态是机器人当前所在的房间。在每个房间完成一个清洁周期后，机器人会根据一组固定的概率决定其下一个位置。\n\n移动规则如下：\n- 当机器人在客厅时，它有 $\\frac{1}{2}$ 的概率在下一个周期停留在客厅，有 $\\frac{1}{2}$ 的概率移动到厨房。它不能直接从客厅移动到卧室。\n- 当机器人在厨房时，它总是会移动到另一个不同的房间。它有 $\\frac{1}{3}$ 的概率移动到客厅，有 $\\frac{2}{3}$ 的概率移动到卧室。\n- 当机器人在卧室时，它有 $\\frac{1}{4}$ 的概率在下一个周期停留在卧室，有 $\\frac{3}{4}$ 的概率移动到厨房。它不能直接从卧室移动到客厅。\n\n当机器人运行了很长时间后，在任何一个给定房间找到它的概率会趋于一个稳态。这被称为马尔可夫链的平稳分布。\n\n计算这个平稳分布。请将你的答案以行矩阵 $(\\pi_L, \\pi_K, \\pi_B)$ 的形式给出，其中 $\\pi_L$、$\\pi_K$ 和 $\\pi_B$ 分别代表在客厅、厨房和卧室找到机器人的长期概率。请将这些概率表示为精确分数。", "solution": "将机器人的移动建模为一个离散时间马尔可夫链，状态按客厅 (L)、厨房 (K)、卧室 (B) 的顺序排列。各行之和为 1 的转移矩阵 $P$ 是\n$$\nP=\\begin{pmatrix}\n\\frac{1}{2} & \\frac{1}{2} & 0 \\\\\n\\frac{1}{3} & 0 & \\frac{2}{3} \\\\\n0 & \\frac{3}{4} & \\frac{1}{4}\n\\end{pmatrix}.\n$$\n设平稳分布为 $\\pi=(\\pi_{L},\\pi_{K},\\pi_{B})$，这是一个满足 $\\pi=\\pi P$ 和 $\\pi_{L}+\\pi_{K}+\\pi_{B}=1$ 的行向量。根据 $\\pi=\\pi P$ 写出分量方程，得到\n$$\n\\pi_{L}=\\frac{1}{2}\\pi_{L}+\\frac{1}{3}\\pi_{K},\\quad\n\\pi_{K}=\\frac{1}{2}\\pi_{L}+\\frac{3}{4}\\pi_{B},\\quad\n\\pi_{B}=\\frac{2}{3}\\pi_{K}+\\frac{1}{4}\\pi_{B}.\n$$\n由第一个方程，\n$$\n\\pi_{L}-\\frac{1}{2}\\pi_{L}=\\frac{1}{3}\\pi_{K}\\;\\Rightarrow\\;\\frac{1}{2}\\pi_{L}=\\frac{1}{3}\\pi_{K}\\;\\Rightarrow\\;\\pi_{K}=\\frac{3}{2}\\pi_{L}.\n$$\n由第三个方程，\n$$\n\\pi_{B}-\\frac{1}{4}\\pi_{B}=\\frac{2}{3}\\pi_{K}\\;\\Rightarrow\\;\\frac{3}{4}\\pi_{B}=\\frac{2}{3}\\pi_{K}\\;\\Rightarrow\\;\\pi_{B}=\\frac{8}{9}\\pi_{K}.\n$$\n使用 $\\pi_{K}=\\frac{3}{2}\\pi_{L}$，将所有变量用 $\\pi_{L}$ 表示，得到\n$$\n\\pi_{B}=\\frac{8}{9}\\cdot\\frac{3}{2}\\pi_{L}=\\frac{4}{3}\\pi_{L}.\n$$\n应用归一化条件：\n$$\n\\pi_{L}+\\pi_{K}+\\pi_{B}=\\pi_{L}+\\frac{3}{2}\\pi_{L}+\\frac{4}{3}\\pi_{L}=\\left(1+\\frac{3}{2}+\\frac{4}{3}\\right)\\pi_{L}=\\frac{23}{6}\\pi_{L}=1,\n$$\n所以\n$$\n\\pi_{L}=\\frac{6}{23},\\quad \\pi_{K}=\\frac{3}{2}\\cdot\\frac{6}{23}=\\frac{9}{23},\\quad \\pi_{B}=\\frac{4}{3}\\cdot\\frac{6}{23}=\\frac{8}{23}.\n$$\n因此，平稳分布为 $(\\frac{6}{23},\\frac{9}{23},\\frac{8}{23})$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{6}{23} & \\frac{9}{23} & \\frac{8}{23} \\end{pmatrix}}$$", "id": "1639083"}, {"introduction": "马尔可夫链不仅仅是理论模型，它们是模拟现实世界过程（如语言和数据流）的强大工具。这个练习将深入探讨其在数据压缩领域的实际应用，通过比较两种不同的编码策略来凸显其价值。通过计算并比较两种策略下的平均码长，你将具体地理解到，利用马尔可夫信源的状态依赖结构（即符号间的关联性）相比于简单地基于其平稳分布进行独立编码，能够带来多么显著的效率提升 [@problem_id:1639043]。", "problem": "一个离散时间时齐马尔可夫信源从字母表 $\\mathcal{S} = \\{A, B, C\\}$ 中产生一个符号序列。信源在任意时刻的状态对应于其刚刚发出的符号。状态转移遵循以下右随机矩阵 $P$，其中元素 $P_{ij}$ 表示从状态 $i$ 转移到状态 $j$ 的概率。状态按 $(A, B, C)$ 的顺序排列。\n\n$$\nP = \\begin{pmatrix}\n0.8 & 0.1 & 0.1 \\\\\n0.2 & 0.6 & 0.2 \\\\\n0.1 & 0.2 & 0.7\n\\end{pmatrix}\n$$\n\n为压缩该信源的输出，正在评估两种不同的二进制编码策略。\n- **策略 1：** 基于符号的无条件概率（由信源的平稳分布确定），设计一个单一的、静态的 Huffman 编码。\n- **策略 2：** 使用一组三个不同的 Huffman 码。当前符号所使用的码本取决于前一个发出的符号（即前一个状态）。\n\n计算使用策略 2 相对于策略 1 所实现的压缩效率增益。该增益定义为每符号的长期平均码字长度的减少量。\n\n将您的最终答案以 比特/符号 为单位表示，并四舍五入到三位有效数字。", "solution": "设平稳符号概率为 $s_{A}, s_{B}, s_{C}$，满足 $s_{A}+s_{B}+s_{C}=1$ 且 $(s_{A},s_{B},s_{C})P=(s_{A},s_{B},s_{C})$。由\n$$\n\\begin{aligned}\ns_{A}&=0.8 s_{A}+0.2 s_{B}+0.1 s_{C},\\\\\ns_{B}&=0.1 s_{A}+0.6 s_{B}+0.2 s_{C},\n\\end{aligned}\n$$\n可得 $2 s_{A}-2 s_{B}-s_{C}=0$ 和 $4 s_{B}-s_{A}-2 s_{C}=0$。结合 $s_{A}+s_{B}+s_{C}=1$ 求解，得到\n$$\ns_{A}=\\frac{8}{19},\\quad s_{B}=\\frac{5}{19},\\quad s_{C}=\\frac{6}{19}.\n$$\n\n策略 1 对概率分布 $(s_{A},s_{B},s_{C})=(\\frac{8}{19},\\frac{5}{19},\\frac{6}{19})$ 使用单一的 Huffman 编码。对于三个符号，最优前缀码长为 $(1,2,2)$，概率最大的符号被分配长度为 1 的码字。期望长度为\n$$\nL_{1}=\\frac{8}{19}\\cdot 1+\\frac{5}{19}\\cdot 2+\\frac{6}{19}\\cdot 2=\\frac{30}{19}.\n$$\n\n策略 2 使用上下文相关的 Huffman 码，该编码基于给定前一符号的条件分布，即矩阵 $P$ 的行向量。\n- 给定前一符号为 $A$：概率分布为 $(0.8,0.1,0.1)=(\\frac{4}{5},\\frac{1}{10},\\frac{1}{10})$，得到码长 $(1,2,2)$ 且\n$$\nL_{A}=\\frac{4}{5}\\cdot 1+\\frac{1}{10}\\cdot 2+\\frac{1}{10}\\cdot 2=\\frac{6}{5}.\n$$\n- 给定前一符号为 $B$：概率分布为 $(0.2,0.6,0.2)=(\\frac{1}{5},\\frac{3}{5},\\frac{1}{5})$，得到码长 $(1,2,2)$ 且\n$$\nL_{B}=\\frac{3}{5}\\cdot 1+\\frac{1}{5}\\cdot 2+\\frac{1}{5}\\cdot 2=\\frac{7}{5}.\n$$\n- 给定前一符号为 $C$：概率分布为 $(0.1,0.2,0.7)=(\\frac{1}{10},\\frac{1}{5},\\frac{7}{10})$，得到码长 $(1,2,2)$ 且\n$$\nL_{C}=\\frac{7}{10}\\cdot 1+\\frac{1}{5}\\cdot 2+\\frac{1}{10}\\cdot 2=\\frac{13}{10}.\n$$\n策略 2 下的长期平均码长是各上下文平均码长的平稳加权平均：\n$$\nL_{2}=s_{A}L_{A}+s_{B}L_{B}+s_{C}L_{C}\n=\\frac{8}{19}\\cdot\\frac{6}{5}+\\frac{5}{19}\\cdot\\frac{7}{5}+\\frac{6}{19}\\cdot\\frac{13}{10}\n=\\frac{48}{95}+\\frac{35}{95}+\\frac{39}{95}=\\frac{122}{95}.\n$$\n\n压缩效率增益是码长的减少量 $L_{1}-L_{2}$：\n$$\nL_{1}-L_{2}=\\frac{30}{19}-\\frac{122}{95}=\\frac{150-122}{95}=\\frac{28}{95}\\approx 0.2947368421.\n$$\n四舍五入到三位有效数字，增益为 $0.295$ 比特/符号。", "answer": "$$\\boxed{0.295}$$", "id": "1639043"}]}