{"hands_on_practices": [{"introduction": "Blahut-Arimoto 算法的核心在于其迭代过程。要掌握这个算法，最好的起点是亲手执行一次完整的迭代。这个练习将引导你完成这一基本操作，从一个给定的初始分布开始，应用算法的更新规则 [@problem_id:1605365]。通过手动计算更新后的概率分布，你将对该算法如何在每一步中权衡失真和信息率有一个具体而深入的理解。", "problem": "考虑一个涉及二进制信源的通信问题，其中信源字母表为 $\\mathcal{X} = \\{0, 1\\}$。该信源是不对称的，生成符号的概率为 $p(x=0) = 0.75$ 和 $p(x=1) = 0.25$。我们希望使用一个再现字母表 $\\mathcal{\\hat{X}} = \\{0, 1\\}$ 来表示信源输出。再现的质量由汉明失真度量，其定义为：当 $x = \\hat{x}$ 时 $d(x, \\hat{x}) = 0$，当 $x \\neq \\hat{x}$ 时 $d(x, \\hat{x}) = 1$。\n\n该信源的率失真函数可以通过 Blahut-Arimoto 算法进行数值计算。该算法通过迭代优化条件分布 $q(\\hat{x}|x)$ 和再现分布 $q(\\hat{x})$ 来找到率失真曲线上的一个点。迭代更新依赖于一个拉格朗日乘子 $\\beta > 0$。对于迭代步骤 $k$，更新规则如下：\n\n1.  更新条件分布：\n    $$ q_{k+1}(\\hat{x}|x) = \\frac{q_k(\\hat{x}) \\exp(-\\beta d(x, \\hat{x}))}{\\sum_{\\hat{x}' \\in \\mathcal{\\hat{X}}} q_k(\\hat{x}') \\exp(-\\beta d(x, \\hat{x}'))} $$\n\n2.  更新再现分布：\n    $$ q_{k+1}(\\hat{x}) = \\sum_{x \\in \\mathcal{X}} p(x) q_{k+1}(\\hat{x}|x) $$\n\n假设我们使用均匀的再现分布 $q_0(\\hat{x}=0) = q_0(\\hat{x}=1) = 0.5$ 来初始化算法（在步骤 $k=0$ 时）。使用参数值 $\\beta = 2.0$，执行一次完整的算法迭代，以找到更新后的再现分布 $q_1(\\hat{x})$。\n\n计算 $q_1(\\hat{x}=0)$ 的值。将您的答案表示为四舍五入到四位有效数字的小数。", "solution": "我们给定一个二进制信源，其 $p(0)=0.75$ 和 $p(1)=0.25$，汉明失真为 $d(x,\\hat{x})$，初始再现分布为 $q_{0}(\\hat{x}=0)=q_{0}(\\hat{x}=1)=0.5$，以及 $\\beta=2.0$。Blahut-Arimoto 算法的第一步是使用初始的 $q_0(\\hat{x})$ 来更新条件分布 $q_1(\\hat{x}|x)$：\n$$\nq_{1}(\\hat{x}\\mid x)=\\frac{q_{0}(\\hat{x})\\exp(-\\beta d(x,\\hat{x}))}{\\sum_{\\hat{x}'\\in\\{0,1\\}}q_{0}(\\hat{x}')\\exp(-\\beta d(x,\\hat{x}'))}.\n$$\n令 $E=\\exp(-2)$，因为 $\\beta=2$ 且当失真为1时指数项为 $\\exp(-2 \\cdot 1)$。\n对于 $x=0$，我们有 $d(0,0)=0$ 和 $d(0,1)=1$。分母为 $q_0(0)\\exp(-2 \\cdot 0) + q_0(1)\\exp(-2 \\cdot 1) = 0.5(1+E)$。条件概率为：\n$$\nq_{1}(0\\mid 0)=\\frac{0.5\\cdot \\exp(0)}{0.5(1+E)}=\\frac{1}{1+E},\\quad\nq_{1}(1\\mid 0)=\\frac{0.5\\cdot \\exp(-2)}{0.5(1+E)}=\\frac{E}{1+E}.\n$$\n对于 $x=1$，我们有 $d(1,0)=1$ 和 $d(1,1)=0$。分母为 $q_0(0)\\exp(-2 \\cdot 1) + q_0(1)\\exp(-2 \\cdot 0) = 0.5(E+1)$。条件概率为：\n$$\nq_{1}(0\\mid 1)=\\frac{0.5\\cdot \\exp(-2)}{0.5(1+E)}=\\frac{E}{1+E},\\quad q_{1}(1\\mid 1)=\\frac{0.5\\cdot \\exp(0)}{0.5(1+E)}=\\frac{1}{1+E}.\n$$\n算法的第二步是使用新的条件分布 $q_1(\\hat{x}|x)$ 来更新再现分布 $q_1(\\hat{x})$：\n$$\nq_{1}(\\hat{x})=\\sum_{x\\in\\{0,1\\}}p(x)\\,q_{1}(\\hat{x}\\mid x).\n$$\n因此，对于 $\\hat{x}=0$：\n$$\nq_{1}(0)=p(0)\\,q_{1}(0\\mid 0)+p(1)\\,q_{1}(0\\mid 1)=\\frac{3}{4}\\cdot \\frac{1}{1+E}+\\frac{1}{4}\\cdot \\frac{E}{1+E}=\\frac{3+E}{4(1+E)}.\n$$\n代入 $E=\\exp(-2)\\approx 0.135335$，我们得到：\n$$\nq_{1}(0)=\\frac{3+0.135335}{4(1+0.135335)}=\\frac{3.135335}{4(1.135335)}=\\frac{3.135335}{4.54134} \\approx 0.69041,\n$$\n四舍五入到四位有效数字后为 $0.6904$。", "answer": "$$\\boxed{0.6904}$$", "id": "1605365"}, {"introduction": "在掌握了单步迭代的计算之后，我们自然会想知道，连续的迭代如何导向一个有意义的结果。本练习将让你执行两次完整的迭代，以观察算法的收敛行为，特别是在一个对称信源的理想情况下 [@problem_id:1605389]。通过这个过程，你不仅能巩固对迭代机制的理解，还能看到概率分布如何迅速稳定下来，并最终将这个稳定的结果与可实现的压缩率（即互信息）联系起来。", "problem": "考虑一个二元无记忆信源，其生成的符号来自字母表 $\\mathcal{X} = \\{0, 1\\}$。这些符号以相等的概率生成，即 $p(X=0) = 1/2$ 且 $p(X=1) = 1/2$。我们希望压缩该信源，并使用字母表 $\\hat{\\mathcal{X}} = \\{0, 1\\}$ 对其进行重构。重构的质量由汉明失真度量，其定义为：如果 $x = \\hat{x}$，则 $d(x, \\hat{x}) = 0$；如果 $x \\neq \\hat{x}$，则 $d(x, \\hat{x}) = 1$。\n\nBlahut-Arimoto 算法可用于迭代地找到最优的条件概率分布 $q(\\hat{x}|x)$，该分布在给定的失真水平下最小化互信息 $I(X; \\hat{X})$。对于固定的权衡参数 $\\beta > 0$，该算法通过以下两个步骤将分布 $q_k(\\hat{x}|x)$ 更新为 $q_{k+1}(\\hat{x}|x)$：\n\n1.  首先，基于当前的信道 $q_k(\\hat{x}|x)$ 计算边缘输出分布：\n    $$ q_k(\\hat{x}) = \\sum_{x \\in \\mathcal{X}} p(x) q_k(\\hat{x}|x) $$\n2.  然后，使用上一步得到的边缘分布更新信道分布：\n    $$ q_{k+1}(\\hat{x}|x) = \\frac{q_k(\\hat{x}) \\exp(-\\beta d(x, \\hat{x}))}{\\sum_{\\hat{x}' \\in \\hat{\\mathcal{X}}} q_k(\\hat{x}') \\exp(-\\beta d(x, \\hat{x}'))} $$\n\n你的任务是分析在特定场景下此过程。设参数为 $\\beta = \\ln(9)$。初始分布为 $q_0(\\hat{x}|x) = 1/2$，适用于 $x \\in \\mathcal{X}$ 和 $\\hat{x} \\in \\hat{\\mathcal{X}}$ 的所有组合。\n\n执行两轮完整的 Blahut-Arimoto 算法迭代来确定分布 $q_2(\\hat{x}|x)$。随后，计算与此分布对应的互信息 $I_2(X; \\hat{X})$。互信息代表了可实现的压缩率，其由以下公式给出：\n$$ I(X; \\hat{X}) = \\sum_{x \\in \\mathcal{X}} \\sum_{\\hat{x} \\in \\hat{\\mathcal{X}}} p(x) q(\\hat{x}|x) \\log_2\\left(\\frac{q(\\hat{x}|x)}{q(\\hat{x})}\\right) $$\n给出这个率的值。最终答案以比特为单位，并四舍五入到四位有效数字。", "solution": "信源是二元的，满足 $p(0)=p(1)=\\frac{1}{2}$，且重构字母表也是二元的。失真为汉明失真：如果 $x=\\hat{x}$，则 $d(x,\\hat{x})=0$；否则 $d(x,\\hat{x})=1$。对于固定的 $\\beta>0$，Blahut-Arimoto 更新公式为\n$$\nq_{k}(\\hat{x})=\\sum_{x\\in\\mathcal{X}}p(x)\\,q_{k}(\\hat{x}\\mid x),\n\\qquad\nq_{k+1}(\\hat{x}\\mid x)=\\frac{q_{k}(\\hat{x})\\exp(-\\beta d(x,\\hat{x}))}{\\sum_{\\hat{x}'\\in\\hat{\\mathcal{X}}}q_{k}(\\hat{x}')\\exp(-\\beta d(x,\\hat{x}'))}.\n$$\n给定 $\\beta=\\ln(9)$ 以及对于所有 $x, \\hat{x}$ 的初始条件 $q_{0}(\\hat{x}\\mid x)=\\frac{1}{2}$。\n\n第 0 到 1 次迭代：\n首先使用 $q_{0}(\\hat{x}\\mid x)$ 计算边缘输出分布：\n$$\nq_{0}(\\hat{x})=\\sum_{x\\in\\mathcal{X}}p(x)\\,q_{0}(\\hat{x}\\mid x)=\\frac{1}{2}\\cdot\\frac{1}{2}+\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{2},\\quad\\text{对于 }\\hat{x}\\in\\{0,1\\}。\n$$\n使用 $\\beta=\\ln(9)$，我们得到 $\\exp(-\\beta)=\\exp(-\\ln(9))=\\frac{1}{9}$。然后，对于每个 $x$ 更新得到：\n- 如果 $\\hat{x}=x$（此时 $d(x,\\hat{x})=0$），则分子为 $q_{0}(\\hat{x})\\exp(0)=\\frac{1}{2}$。\n- 如果 $\\hat{x}\\neq x$（此时 $d(x,\\hat{x})=1$），则分子为 $q_{0}(\\hat{x})\\exp(-\\beta)=\\frac{1}{2}\\cdot\\frac{1}{9}$。\n分母是这两项的和：\n$$\n\\frac{1}{2}+\\frac{1}{2}\\cdot\\frac{1}{9}=\\frac{1}{2}\\left(1+\\frac{1}{9}\\right)=\\frac{1}{2}\\cdot\\frac{10}{9}=\\frac{5}{9}.\n$$\n因此，\n$$\nq_{1}(\\hat{x}=x\\mid x)=\\frac{\\frac{1}{2}}{\\frac{5}{9}}=\\frac{9}{10},\\qquad\nq_{1}(\\hat{x}\\neq x\\mid x)=\\frac{\\frac{1}{2}\\cdot\\frac{1}{9}}{\\frac{5}{9}}=\\frac{1}{10}.\n$$\n因此 $q_{1}(\\hat{x}\\mid x)$ 是一个交叉概率为 $\\frac{1}{10}$ 的二元对称信道。\n\n第 1 到 2 次迭代：\n使用 $q_{1}(\\hat{x}\\mid x)$ 计算新的边缘分布：\n$$\nq_{1}(0)=\\frac{1}{2}\\,q_{1}(0\\mid 0)+\\frac{1}{2}\\,q_{1}(0\\mid 1)=\\frac{1}{2}\\cdot\\frac{9}{10}+\\frac{1}{2}\\cdot\\frac{1}{10}=\\frac{1}{2},\n$$\n同理可得 $q_{1}(1)=\\frac{1}{2}$。在更新中使用这些边缘分布和相同的 $\\beta$ 会得到与上面相同的计算结果，因此\n$$\nq_{2}(\\hat{x}=x\\mid x)=\\frac{9}{10},\\qquad q_{2}(\\hat{x}\\neq x\\mid x)=\\frac{1}{10}.\n$$\n所以 $q_{2}(\\hat{x}\\mid x)=q_{1}(\\hat{x}\\mid x)$。\n\n$q_{2}$ 的互信息：\n使用\n$$\nI(X;\\hat{X})=\\sum_{x\\in\\mathcal{X}}\\sum_{\\hat{x}\\in\\hat{\\mathcal{X}}}p(x)\\,q(\\hat{x}\\mid x)\\,\\log_{2}\\!\\left(\\frac{q(\\hat{x}\\mid x)}{q(\\hat{x})}\\right),\n$$\n并且对于两个 $\\hat{x}$ 都有 $q_{2}(\\hat{x})=\\frac{1}{2}$，以及 $q_{2}(x\\mid x)=\\frac{9}{10}$ 和 $q_{2}(\\hat{x}\\neq x\\mid x)=\\frac{1}{10}$，我们得到\n$$\nI_{2}(X;\\hat{X})=\\frac{1}{2}\\sum_{x}\\left[\\frac{9}{10}\\log_{2}\\!\\left(\\frac{\\frac{9}{10}}{\\frac{1}{2}}\\right)+\\frac{1}{10}\\log_{2}\\!\\left(\\frac{\\frac{1}{10}}{\\frac{1}{2}}\\right)\\right]\n=\\left(\\frac{9}{10}\\right)\\log_{2}\\!\\left(\\frac{9}{5}\\right)+\\left(\\frac{1}{10}\\right)\\log_{2}\\!\\left(\\frac{1}{5}\\right).\n$$\n等价地，$I_{2}(X;\\hat{X})=1-\\left[-\\frac{1}{10}\\log_{2}\\!\\left(\\frac{1}{10}\\right)-\\frac{9}{10}\\log_{2}\\!\\left(\\frac{9}{10}\\right)\\right]=1-H_{2}\\!\\left(\\frac{1}{10}\\right)$。数值上，\n$$\nI_{2}(X;\\hat{X})\\approx 0.5310044064\\ \\text{比特}.\n$$\n四舍五入到四位有效数字，结果是 $0.5310$ 比特。", "answer": "$$\\boxed{0.5310}$$", "id": "1605389"}, {"introduction": "任何数值算法在实际应用中都可能存在“陷阱”，Blahut-Arimoto 算法也不例外，其初始状态的选择至关重要。这个练习是一个概念性的挑战，旨在探讨不当的初始化会带来怎样的后果 [@problem_id:1605398]。通过分析当某个备选的重构符号从一开始就被赋予零概率时算法的行为，你将学到关于数值优化的一个关键教训：算法可能会陷入局部最优解，从而无法找到真正的全局最优。在实际问题中应用该算法时，这种洞察力至关重要。", "problem": "一位信息论专业的学生正在使用 Blahut-Arimoto 算法，以数值方式近似一个离散无记忆信源的率失真函数上的一个点。其目标是找到一个信道（即一个条件概率分布 $q(\\hat{x}|x)$），以最小化泛函 $J = I(X;\\hat{X}) + \\beta D$，其中 $I(X;\\hat{X})$ 是互信息，$D$ 是期望失真，$\\beta > 0$ 是一个固定的正常数。\n\n该信源由一个字母表 $\\mathcal{X}$ 定义，其概率质量函数 $p(x) > 0$ 对所有 $x \\in \\mathcal{X}$ 成立。再现字母表为 $\\mathcal{\\hat{X}}$，任何源符号 $x$ 和再现符号 $\\hat{x}$ 之间的失真由一个有限值 $d(x, \\hat{x})$ 给出。\n\n该迭代算法从对边缘再现分布 $q_0(\\hat{x})$ 的一个初始猜测开始，按以下步骤进行：\n\n1.  **对于第 $k$ 次迭代，更新条件分布：**\n    $$ q_{k+1}(\\hat{x}|x) = \\frac{q_k(\\hat{x}) \\exp(-\\beta d(x, \\hat{x}))}{\\sum_{\\hat{x}' \\in \\mathcal{\\hat{X}}} q_k(\\hat{x}') \\exp(-\\beta d(x, \\hat{x}'))} $$\n2.  **更新边缘再现分布：**\n    $$ q_{k+1}(\\hat{x}) = \\sum_{x \\in \\mathcal{X}} p(x) q_{k+1}(\\hat{x}|x) $$\n\n该学生对再现字母表上的分布做了一个特定的初始化选择。他们选择了一个特定的符号 $\\hat{x}_0 \\in \\mathcal{\\hat{X}}$ 并将其初始概率设置为零，$q_0(\\hat{x}_0) = 0$。对于所有其他再现符号 $\\hat{x} \\in \\mathcal{\\hat{X}}$ 且 $\\hat{x} \\neq \\hat{x}_0$，其初始概率严格为正，$q_0(\\hat{x}) > 0$。\n\n对于该算法的所有后续迭代（即对于所有 $k \\ge 1$），以下哪个陈述是这种特定初始化策略的必然结果？\n\nA. 期望失真 $D_k = \\sum_{x, \\hat{x}} p(x)q_k(\\hat{x}|x)d(x,\\hat{x})$ 将是无穷大。\nB. 该算法必然会收敛到最小化泛函 $J$ 的全局最优信道。\nC. 互信息 $I_k(X;\\hat{X})$ 将为零。\nD. 对于特定符号 $\\hat{x}_0$，其边缘概率将保持为零，即 $q_k(\\hat{x}_0) = 0$。\nE. 条件概率 $q_1(\\hat{x}_0|x)$ 对于至少一个源符号 $x$ 将变为严格为正，因为算法会试图纠正不良的初始化。", "solution": "第 $k$ 次迭代的 Blahut-Arimoto 更新公式为\n$$\nq_{k+1}(\\hat{x}\\mid x)=\\frac{q_{k}(\\hat{x})\\exp(-\\beta d(x,\\hat{x}))}{\\sum_{\\hat{x}'\\in\\mathcal{\\hat{X}}}q_{k}(\\hat{x}')\\exp(-\\beta d(x,\\hat{x}'))},\\qquad\nq_{k+1}(\\hat{x})=\\sum_{x\\in\\mathcal{X}}p(x)q_{k+1}(\\hat{x}\\mid x).\n$$\n给定 $\\beta>0$ 且对于所有 $(x,\\hat{x})$，$d(x,\\hat{x})$ 都是有限的，则我们有 $\\exp(-\\beta d(x,\\hat{x}))>0$ 对所有 $(x,\\hat{x})$ 成立。\n\n假设初始化满足 $q_{0}(\\hat{x}_{0})=0$ 且对于所有 $\\hat{x}\\neq\\hat{x}_{0}$ 有 $q_{0}(\\hat{x})>0$。对于任意 $x\\in\\mathcal{X}$，在 $k=0$ 时对 $\\hat{x}_{0}$ 的更新得出\n$$\nq_{1}(\\hat{x}_{0}\\mid x)=\\frac{q_{0}(\\hat{x}_{0})\\exp(-\\beta d(x,\\hat{x}_{0}))}{\\sum_{\\hat{x}'\\in\\mathcal{\\hat{X}}}q_{0}(\\hat{x}')\\exp(-\\beta d(x,\\hat{x}'))}\n=\\frac{0}{\\sum_{\\hat{x}'\\neq\\hat{x}_{0}}q_{0}(\\hat{x}')\\exp(-\\beta d(x,\\hat{x}'))}=0,\n$$\n因为分母由于至少存在一个 $\\hat{x}'\\neq\\hat{x}_{0}$ 使得 $q_{0}(\\hat{x}')>0$ 并且指数项严格为正，所以分母严格为正。因此，\n$$\nq_{1}(\\hat{x}_{0})=\\sum_{x\\in\\mathcal{X}}p(x)q_{1}(\\hat{x}_{0}\\mid x)=0.\n$$\n通过归纳法，假设对于某个 $k\\geq 0$ 有 $q_{k}(\\hat{x}_{0})=0$。那么对于所有 $x$，\n$$\nq_{k+1}(\\hat{x}_{0}\\mid x)=\\frac{q_{k}(\\hat{x}_{0})\\exp(-\\beta d(x,\\hat{x}_{0}))}{\\sum_{\\hat{x}'\\in\\mathcal{\\hat{X}}}q_{k}(\\hat{x}')\\exp(-\\beta d(x,\\hat{x}'))}=0,\n$$\n这意味着\n$$\nq_{k+1}(\\hat{x}_{0})=\\sum_{x\\in\\mathcal{X}}p(x)q_{k+1}(\\hat{x}_{0}\\mid x)=0.\n$$\n因此，对于所有 $k\\geq 0$ 都有 $q_{k}(\\hat{x}_{0})=0$，并且对于所有 $x$ 和所有 $k\\geq 0$ 都有 $q_{k+1}(\\hat{x}_{0}\\mid x)=0$。\n\n确立了这一点后，我们来评估各个选项：\n- A 是错误的，因为期望失真 $D_{k}=\\sum_{x,\\hat{x}}p(x)q_{k}(\\hat{x}\\mid x)d(x,\\hat{x})$ 是有限值 $d(x,\\hat{x})$ 的有限加权和，其非负权重之和为1；因此 $D_{k}$ 是有限的。\n- B 不保证成立：由于对所有 $k$ 都固定了 $q_{k}(\\hat{x}_{0})=0$，算法被限制在支撑集为 $\\mathcal{\\hat{X}}\\setminus\\{\\hat{x}_{0}\\}$ 的信道上；如果全局最小解赋予 $\\hat{x}_{0}$ 正的概率质量，那么该解是无法达到的。\n- C 不保证成立：互信息 $I_{k}(X;\\hat{X})=\\sum_{x,\\hat{x}}p(x)q_{k}(\\hat{x}\\mid x)\\ln\\!\\left(\\frac{q_{k}(\\hat{x}\\mid x)}{q_{k}(\\hat{x})}\\right)$ 不必为零，除非对所有 $x$ 都有 $q_{k}(\\hat{x}\\mid x)=q_{k}(\\hat{x})$，而更新过程并不强制这一点。\n- D 由上述归纳法保证成立：对于所有 $k\\geq 0$ 都有 $q_{k}(\\hat{x}_{0})=0$。\n- E 是错误的，因为如前所示，对所有 $x$ 都有 $q_{1}(\\hat{x}_{0}\\mid x)=0$。\n\n因此，必然的结果是 $\\hat{x}_{0}$ 的边缘概率在所有迭代中都保持为零。", "answer": "$$\\boxed{D}$$", "id": "1605398"}]}