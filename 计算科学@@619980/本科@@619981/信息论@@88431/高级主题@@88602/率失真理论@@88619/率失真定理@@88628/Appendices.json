{"hands_on_practices": [{"introduction": "在我们优化率与失真之间的权衡之前，我们必须首先牢固掌握如何计算失真。这个练习提供了一个基础场景：如果我们不传输任何关于信源的信息（即以零速率传输），并且简单地对所有输出使用单一的恒定猜测值，失真会是多少？通过这个计算，我们可以得到一个性能基准，以便与更复杂的压缩方案进行比较。[@problem_id:1652370]", "problem": "考虑一个由随机变量 $X$ 表示的离散无记忆信源，该信源从字母表 $\\mathcal{A} = \\{0, 1, 2, 3\\}$ 中生成符号。该信源具有均匀概率分布，这意味着 $\\mathcal{A}$ 中的每个符号被生成的可能性是相等的。采用一种非常基础的有损压缩方案，其中来自信源的每个符号 $x$ 都被表示为一个单一的常量值 $\\hat{x} = 1.5$。这种编码方式对应于零传输率，因为其表示不依赖于输入符号。\n\n该压缩的性能使用平方误差失真度量进行评估，由 $d(x, \\hat{x}) = (x - \\hat{x})^2$ 给出。计算该系统的期望失真 $D = E[d(X, \\hat{x})]$。请将答案表示为小数。", "solution": "随机变量 $X$ 在 $\\mathcal{A}=\\{0,1,2,3\\}$ 上是均匀分布的，所以对于每个 $x\\in\\mathcal{A}$，都有 $p(x)=\\frac{1}{4}$。重构值是常量 $\\hat{x}=1.5=\\frac{3}{2}$，失真度量是 $d(x,\\hat{x})=(x-\\hat{x})^{2}$。期望失真为\n$$\nD=E[d(X,\\hat{x})]=\\sum_{x\\in\\mathcal{A}} p(x)\\,(x-\\hat{x})^{2}=\\sum_{x\\in\\{0,1,2,3\\}} \\frac{1}{4}\\left(x-\\frac{3}{2}\\right)^{2}.\n$$\n计算每一项，\n$$\n\\left(0-\\frac{3}{2}\\right)^{2}=\\frac{9}{4},\\quad \\left(1-\\frac{3}{2}\\right)^{2}=\\frac{1}{4},\\quad \\left(2-\\frac{3}{2}\\right)^{2}=\\frac{1}{4},\\quad \\left(3-\\frac{3}{2}\\right)^{2}=\\frac{9}{4}.\n$$\n因此，\n$$\nD=\\frac{1}{4}\\left(\\frac{9}{4}+\\frac{1}{4}+\\frac{1}{4}+\\frac{9}{4}\\right)=\\frac{1}{4}\\cdot\\frac{20}{4}=\\frac{20}{16}=\\frac{5}{4}=1.25.\n$$\n所以，期望失真是 $1.25$。", "answer": "$$\\boxed{1.25}$$", "id": "1652370"}, {"introduction": "理解了失真的概念后，我们现在来解决有损压缩的核心挑战：在严格的数据率预算下最小化失真。这个实践模拟了一个常见的工程问题，即信道容量有限（例如，每符号 $1$ 比特）。你将通过设计一个最优的两级量化器来确定理论上可能达到的最佳保真度，从而将率失真理论的核心原理直接应用于实际场景。[@problem_id:1652375]", "problem": "一个简化的数字环境传感器被设计用来测量温度。传感器的输出是一个离散随机变量 $X$，它可以从字母表 $\\mathcal{X} = \\{1, 2, 3, 4\\}$ 中取四个整数值之一。长期观察表明，这四个值中的每一个出现的可能性都相等。\n\n为了节省功耗，传感器的读数在通过无线信道传输之前必须进行压缩。该信道可支持的最大数据速率为每个传感器读数 $R = 1$ 比特。压缩系统的性能通过平均平方误差失真来评估，定义为 $D = E[(X - \\hat{X})^2]$，其中 $\\hat{X}$ 是传输和解压缩后的重建值。\n\n假设使用最优的压缩和解压缩方案，在给定信道速率约束的情况下，可以实现的理论最小平均平方误差失真 $D$ 是多少？请以精确分数形式给出你的答案。", "solution": "问题要求在给定信源和速率约束 $R$ 的情况下，求出可实现的最小平均平方误差失真 $D$。这是一个率失真理论中的经典问题。\n\n信源变量 $X$ 以相等的概率从集合 $\\mathcal{X} = \\{1, 2, 3, 4\\}$ 中取值。因此，对于任意 $x \\in \\mathcal{X}$，都有 $P(X=x) = \\frac{1}{4}$。失真度量是平方误差，$d(x, \\hat{x}) = (x - \\hat{x})^2$。速率约束为每个符号 $R = 1$ 比特。\n\n速率 $R$ 限制了重建信号 $\\hat{X}$ 可以取的不同值的数量。如果重建字母表 $\\hat{\\mathcal{X}}$ 的大小为 $|\\hat{\\mathcal{X}}| = M$，那么表示这些值所需的最小速率是输出的熵 $H(\\hat{X})$。为了传输这些信息，我们需要 $R \\ge H(\\hat{X})$。最简单的编码形式是使用定长码，其中电平数 $M$ 必须满足 $M \\le 2^R$。在本例中，$R = 1$，我们有 $M \\le 2^1 = 2$。这意味着我们最多可以使用两个不同的重建电平，我们称之为 $\\hat{x}_1$ 和 $\\hat{x}_2$。\n\n因此，问题简化为为信源 $X$ 寻找最优的 2-电平量化器，以最小化平均平方误差失真。一个最优量化器将信源字母表划分为不相交的集合，并将给定集合中的所有符号映射到单个重建值。对于平方误差失真度量，任何信源符号集合的最优重建值是它们的条件期望（即它们的均值）。\n\n我们需要将信源字母表 $\\mathcal{X} = \\{1, 2, 3, 4\\}$ 划分为两个非空子集 $S_1$ 和 $S_2$。在不考虑集合重新标记的情况下，有三种不同的划分方式：\n1.  $S_1 = \\{1\\}$, $S_2 = \\{2, 3, 4\\}$\n2.  $S_1 = \\{1, 2\\}$, $S_2 = \\{3, 4\\}$\n3.  $S_1 = \\{1, 2, 3\\}$, $S_2 = \\{4\\}$\n\n我们将计算每种情况下的最小平均失真。\n\n**情况 1：划分 $S_1 = \\{1\\}$ 和 $S_2 = \\{2, 3, 4\\}$**\n$S_1$ 的最优重建电平是其元素的均值：\n$\\hat{x}_1 = E[X | X \\in S_1] = 1$。\n$S_2$ 的最优重建电平是：\n$\\hat{x}_2 = E[X | X \\in S_2] = \\frac{2+3+4}{3} = 3$。\n平均失真 $D_1$ 通过对每个信源符号的平方误差求平均来计算：\n$$D_1 = \\sum_{x \\in \\mathcal{X}} P(X=x) d(x, \\hat{x}(x))$$\n其中，如果 $x \\in S_1$，则 $\\hat{x}(x) = \\hat{x}_1$；如果 $x \\in S_2$，则 $\\hat{x}(x) = \\hat{x}_2$。\n$$D_1 = P(1)(1-1)^2 + P(2)(2-3)^2 + P(3)(3-3)^2 + P(4)(4-3)^2$$\n$$D_1 = \\frac{1}{4}(0)^2 + \\frac{1}{4}(-1)^2 + \\frac{1}{4}(0)^2 + \\frac{1}{4}(1)^2 = \\frac{1}{4}(0 + 1 + 0 + 1) = \\frac{2}{4} = \\frac{1}{2}$$\n\n**情况 2：划分 $S_1 = \\{1, 2\\}$ 和 $S_2 = \\{3, 4\\}$**\n$S_1$ 的最优重建电平：\n$\\hat{x}_1 = E[X | X \\in S_1] = \\frac{1+2}{2} = 1.5$。\n$S_2$ 的最优重建电平：\n$\\hat{x}_2 = E[X | X \\in S_2] = \\frac{3+4}{2} = 3.5$。\n平均失真 $D_2$ 为：\n$$D_2 = P(1)(1-1.5)^2 + P(2)(2-1.5)^2 + P(3)(3-3.5)^2 + P(4)(4-3.5)^2$$\n$$D_2 = \\frac{1}{4}(-0.5)^2 + \\frac{1}{4}(0.5)^2 + \\frac{1}{4}(-0.5)^2 + \\frac{1}{4}(0.5)^2$$\n$$D_2 = \\frac{1}{4}(0.25) + \\frac{1}{4}(0.25) + \\frac{1}{4}(0.25) + \\frac{1}{4}(0.25) = \\frac{1}{4}(4 \\times 0.25) = \\frac{1}{4}(1) = \\frac{1}{4}$$\n\n**情况 3：划分 $S_1 = \\{1, 2, 3\\}$ 和 $S_2 = \\{4\\}$**\n根据与情况 1 的对称性，我们期望得到相同的失真，但为了完整性，我们仍将进行计算。\n$S_1$ 的最优重建电平：\n$\\hat{x}_1 = E[X | X \\in S_1] = \\frac{1+2+3}{3} = 2$。\n$S_2$ 的最优重建电平：\n$\\hat{x}_2 = E[X | X \\in S_2] = 4$。\n平均失真 $D_3$ 为：\n$$D_3 = P(1)(1-2)^2 + P(2)(2-2)^2 + P(3)(3-2)^2 + P(4)(4-4)^2$$\n$$D_3 = \\frac{1}{4}(-1)^2 + \\frac{1}{4}(0)^2 + \\frac{1}{4}(1)^2 + \\frac{1}{4}(0)^2 = \\frac{1}{4}(1 + 0 + 1 + 0) = \\frac{2}{4} = \\frac{1}{2}$$\n\n比较这三种情况，可实现的最小失真为 $D_{\\min} = \\min(D_1, D_2, D_3) = \\min(\\frac{1}{2}, \\frac{1}{4}, \\frac{1}{2}) = \\frac{1}{4}$。\n\n最后，我们必须验证这个最优量化器所需的速率不大于 $R=1$。对于最优划分（情况 2），重建电平为 $\\hat{x}_1 = 1.5$ 和 $\\hat{x}_2 = 3.5$。使用这些电平的概率是：\n$P(\\hat{X} = \\hat{x}_1) = P(X \\in S_1) = P(X=1) + P(X=2) = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$。\n$P(\\hat{X} = \\hat{x}_2) = P(X \\in S_2) = P(X=3) + P(X=4) = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$。\n输出分布的熵是编码它所需的最小速率：\n$H(\\hat{X}) = -\\sum_i P(\\hat{X}=\\hat{x}_i)\\log_2 P(\\hat{X}=\\hat{x}_i) = -(\\frac{1}{2}\\log_2\\frac{1}{2} + \\frac{1}{2}\\log_2\\frac{1}{2}) = - \\log_2\\frac{1}{2} = 1$ 比特/符号。\n由于所需速率 $H(\\hat{X})=1$ 等于可用信道速率 $R=1$，因此这个最小失真是可以实现的。\n\n因此，理论上的最小平均平方误差失真是 $\\frac{1}{4}$。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "1652375"}, {"introduction": "现实世界的数据并不总是完全符合我们为其设计压缩系统时所用的统计模型。本练习探讨了这种“模型失配”的实际后果。通过将一个为特定数据源优化的压缩方案应用于另一个不同的信源，你将计算出其最终性能，从而深入理解最优压缩的信源依赖性，以及理论率失真函数与特定编码器操作率之间的差异。[@problem_id:1652583]", "problem": "在有损数据压缩领域，率失真函数描述了压缩率与重构数据保真度之间的基本权衡。考虑一个无记忆二进制信源，其产生的符号来自字母表 $\\mathcal{X} = \\{0, 1\\}$。信源符号 $x$ 与其重构符号 $\\hat{x}$ 之间的失真由汉明失真度量，定义为：如果 $x = \\hat{x}$，则 $d(x, \\hat{x}) = 0$；如果 $x \\neq \\hat{x}$，则 $d(x, \\hat{x}) = 1$。二元熵函数由 $H_b(p) = -p \\log_2(p) - (1-p) \\log_2(1-p)$ 给出。\n\n一个压缩系统最初是为一个对称二进制信源 $X$ 设计的，其中符号是等概率的，即 $P(X=1) = 1/2$。该系统在率失真意义上被构建为最优系统，达到了一个特定的平均失真度 $D = E[d(X, \\hat{X})] = 0.1$。对于使用汉明失真的伯努利(1/2)信源，根据率失真理论的一个已知结果，对于目标失真度 $D$（其中 $0 \\leq D \\leq 1/2$），最优压缩方案是通过一个随机映射实现的，该映射等效于将信源通过一个交叉概率为 $p_c = D$ 的二进制对称信道 (BSC)。\n\n现在，这套对于信源 $X$ 而言是最优的压缩系统，被重新用于压缩一个不同的无记忆二进制信源 $Y$。这个新信源是不对称的，其产生 '1' 的概率为 $P(Y=1) = 1/4$。\n\n计算将这个已有的压缩系统应用于新信源 $Y$ 时，所产生的新平均失真度 $D' = E[d(Y, \\hat{Y})]$ 和新操作率 $R' = I(Y; \\hat{Y})$。你的答案应该是一对数值 $(D', R')$。请用比特/符号表示码率 $R'$。最终答案中的两个数值都应四舍五入到四位有效数字。", "solution": "问题要求我们评估一个固定的压缩方案在应用于一个与其优化目标不同的信源时的性能（失真度和码率）。\n\n首先，我们确定这个固定压缩方案的特性。问题指出，该方案是为伯努利(1/2)信源设计的，在汉明失真度量下，其目标平均失真度为 $D=0.1$，且该方案在率失真意义上是最优的。题目还给出，对于这种设置，最优方案等效于一个交叉概率 $p_c$ 等于目标失真度 $D$ 的二进制对称信道 (BSC)。\n因此，该压缩系统是一个交叉概率为 $p_c = 0.1$ 的 BSC。\n该信道由以下条件概率定义：\n$P(\\hat{x}=1|x=0) = p_c = 0.1$\n$P(\\hat{x}=0|x=0) = 1 - p_c = 0.9$\n$P(\\hat{x}=0|x=1) = p_c = 0.1$\n$P(\\hat{x}=1|x=1) = 1 - p_c = 0.9$\n通常，对于任意 $x \\in \\{0, 1\\}$，有 $P(\\hat{x} \\neq x | x) = p_c$。\n\n接下来，我们将这个固定的 BSC 应用于新信源 $Y$，这是一个伯努利信源，其 $P(Y=1) = p = 1/4 = 0.25$。因此，$P(Y=0) = 1-p = 3/4 = 0.75$。我们将该信道的输出表示为 $\\hat{Y}$。\n\n我们来计算新的平均失真度 $D'$。失真度是汉明失真函数的期望值，等价于错误概率 $P(Y \\neq \\hat{Y})$。\n根据全概率公式：\n$$D' = P(Y \\neq \\hat{Y}) = \\sum_{y \\in \\{0,1\\}} P(Y=y) P(Y \\neq \\hat{Y} | Y=y)$$\n项 $P(Y \\neq \\hat{Y} | Y=y)$ 是信道的交叉概率，即 $p_c$。\n$$D' = P(Y=0) \\cdot p_c + P(Y=1) \\cdot p_c$$\n$$D' = (P(Y=0) + P(Y=1)) \\cdot p_c = 1 \\cdot p_c = p_c$$\n代入 $p_c$ 的值：\n$$D' = 0.1$$\n四舍五入到四位有效数字，我们得到 $D' = 0.1000$。\n\n现在，我们来计算新的操作率 $R'$。有损压缩方案的码率由信源与其重构之间的互信息给出，即 $R' = I(Y; \\hat{Y})$。\n我们可以使用公式 $I(Y; \\hat{Y}) = H(\\hat{Y}) - H(\\hat{Y}|Y)$ 来计算互信息。\n\n首先，我们求条件熵 $H(\\hat{Y}|Y)$：\n$$H(\\hat{Y}|Y) = \\sum_{y \\in \\{0,1\\}} P(Y=y) H(\\hat{Y}|Y=y)$$\n对于一个固定的输入 $y$ 到一个交叉概率为 $p_c$ 的 BSC，输出 $\\hat{Y}$ 是一个参数为 $p_c$ 的伯努利随机变量（如果我们考虑翻转事件）。这个条件分布的熵是交叉概率的二元熵，即 $H_b(p_c)$。\n$$H(\\hat{Y}|Y=y) = H_b(p_c) \\quad \\text{for } y \\in \\{0,1\\}$$\n因此，\n$$H(\\hat{Y}|Y) = P(Y=0)H_b(p_c) + P(Y=1)H_b(p_c) = H_b(p_c)$$\n使用 $p_c = 0.1$：\n$$H(\\hat{Y}|Y) = H_b(0.1) = -0.1 \\log_2(0.1) - (1-0.1) \\log_2(0.9) \\approx 0.4689956 \\text{ 比特/符号}$$\n\n接下来，我们求输出的熵 $H(\\hat{Y})$。为此，我们需要 $\\hat{Y}$ 的概率分布。设 $q = P(\\hat{Y}=1)$。\n根据全概率公式：\n$$q = P(\\hat{Y}=1) = P(\\hat{Y}=1|Y=0)P(Y=0) + P(\\hat{Y}=1|Y=1)P(Y=1)$$\n我们有：\n$P(\\hat{Y}=1|Y=0) = p_c = 0.1$\n$P(Y=0) = 0.75$\n$P(\\hat{Y}=1|Y=1) = 1-p_c = 0.9$\n$P(Y=1) = 0.25$\n$$q = (0.1)(0.75) + (0.9)(0.25) = 0.075 + 0.225 = 0.3$$\n所以，输出 $\\hat{Y}$ 是一个伯努利(0.3)随机变量。其熵为：\n$$H(\\hat{Y}) = H_b(0.3) = -0.3 \\log_2(0.3) - (1-0.3) \\log_2(0.7) \\approx 0.8812909 \\text{ 比特/符号}$$\n\n最后，我们可以计算码率 $R'$：\n$$R' = H(\\hat{Y}) - H(\\hat{Y}|Y) \\approx 0.8812909 - 0.4689956$$\n$$R' \\approx 0.4122953 \\text{ 比特/符号}$$\n四舍五入到四位有效数字，我们得到 $R' = 0.4123$ 比特/符号。\n\n最终得到的结果对 $(D', R')$ 是 $(0.1000, 0.4123)$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.1000 & 0.4123 \\end{pmatrix}}$$", "id": "1652583"}]}