{"hands_on_practices": [{"introduction": "在分析复杂系统之前，我们必须掌握其基本原理。第一个练习聚焦于均匀标量量化器 ($uniform scalar quantizer$) 的核心机制。通过为一个具体的输入值计算量化误差，你将对连续信号如何被映射到离散电平，以及这个过程中引入的内在误差，有一个具体而深刻的理解。[@problem_id:1656261]", "problem": "一个数字信号处理系统采用均匀标量量化器，将一个连续时间模拟信号转换为一组离散值。该量化器设计用于处理已知范围在 $[0, 6]$ 内的输入信号。该量化器有 $L=12$ 个不同的输出电平。一个值为 $x = 2.34$ 的特定信号样本被输入到该量化器中。量化器将此输入值映射到最接近的量化电平。计算量化误差，其定义为量化输出值与原始输入值之差 ($e = \\hat{x} - x$)。将您的答案以单个实数形式报告，并四舍五入到三位有效数字。", "solution": "一个在范围 $[x_{\\min}, x_{\\max}]$ 内具有 $L$ 个电平的均匀标量量化器，其步长为\n$$\\Delta=\\frac{x_{\\max}-x_{\\min}}{L}。$$\n在此， $x_{\\min}=0$，$x_{\\max}=6$，且 $L=12$，所以\n$$\\Delta=\\frac{6-0}{12}=0.5。$$\n对于一个在有界范围内具有 $L$ 个电平的中升型均匀量化器，其判决阈值为\n$$t_{k}=x_{\\min}+k\\Delta,\\quad k=0,1,\\ldots,L,$$\n且重构（量化）电平为\n$$r_{k}=x_{\\min}+\\left(k-\\frac{1}{2}\\right)\\Delta,\\quad k=1,2,\\ldots,L。$$\n对于 $x=2.34$，找到满足 $t_{k-1}\\leq x<t_{k}$ 的 $k$。因为 $t_{4}=2.0$ 且 $t_{5}=2.5$，我们得到 $k=5$。相应的量化输出为\n$$\\hat{x}=r_{5}=0+\\left(5-\\frac{1}{2}\\right)0.5=2.25。$$\n量化误差定义为 $e=\\hat{x}-x$，因此\n$$e=2.25-2.34=-0.09。$$\n四舍五入到三位有效数字，结果为 $-0.0900$。", "answer": "$$\\boxed{-0.0900}$$", "id": "1656261"}, {"introduction": "量化器的效率不仅取决于其量化电平的数量，更在于它与待处理信号的匹配程度。本练习将通过信噪比 ($SQNR$) 这一指标来探讨这个关键概念。你将定量地看到，一个为大动态范围设计的量化器在处理小幅度信号时性能会如何下降，从而揭示系统设计中的一个基本原则。[@problem_id:1656250]", "problem": "一位工程师的任务是设计一个数字音频系统。一个关键组件是均匀标量量化器，其性能通过信号量化噪声比（SQNR）进行评估。\n\n该工程师最初设计了一个$N$级均匀量化器，我们称之为量化器A，其设计假设是输入信号电压为一个在$[-V_{max}, V_{max}]$范围内均匀分布的随机变量$X$。然而，在构建系统后，他们用一段非常安静的音频对其进行测试。测量结果表明，对于这段特定的音频，信号电压可以更准确地建模为一个在小得多的范围$[-V_{max}/10, V_{max}/10]$内均匀分布的随机变量$Y$。\n\n一位同事建议，对于这段安静的音频，如果使用一个为实际信号范围$[-V_{max}/10, V_{max}/10]$专门设计的、不同的$N$级均匀量化器B，可以获得显著更优的SQNR。\n\n您的任务是比较这两个量化器在处理安静音频信号时的性能。在您的分析中，请使用信息论中的以下标准定义和近似公式：\n- 一个在区间$[-L, L]$上均匀分布的随机变量，其概率密度函数（PDF）为：当$x \\in [-L, L]$时，$f(x) = 1/(2L)$，否则$f(x)=0$。\n- 零均值信号的信号功率$P_S$是其均方值。\n- 一个为范围$[-L, L]$设计的$N$级均匀量化器，其量化步长为$\\Delta = 2L/N$。\n- 量化噪声的功率$P_Q$可以近似为$P_Q \\approx \\Delta^2/12$，此近似成立的条件是量化级别数$N$足够大，且量化器未过载（即输入信号在设计范围内）。\n- 信号量化噪声比定义为线性比率$SQNR = P_S / P_Q$。\n\n当两个量化器都用来处理安静信号时，计算所提出的正确匹配的量化器B所实现的SQNR（$SQNR_B$）与原始不匹配的量化器A所实现的SQNR（$SQNR_A$）之比。请将您的最终答案表示为一个实数。", "solution": "问题要求计算比率$\\frac{SQNR_B}{SQNR_A}$，其中两个量化器都在处理安静信号，该信号是一个在$[-V_{max}/10, V_{max}/10]$上均匀分布的随机变量$Y$。\n\n首先，我们来确定输入信号$Y$的属性。该信号在区间$[-L_Y, L_Y]$上均匀分布，其中$L_Y = V_{max}/10$。\n信号功率$P_S$是$Y$的均方值，由于$Y$是零均值信号，因此其均方值等于其方差。\n$$P_S = E[Y^2] = \\int_{-L_Y}^{L_Y} y^2 f_Y(y) dy$$\n$Y$的概率密度函数为$f_Y(y) = \\frac{1}{2L_Y}$。\n$$P_S = \\int_{-L_Y}^{L_Y} y^2 \\frac{1}{2L_Y} dy = \\frac{1}{2L_Y} \\left[ \\frac{y^3}{3} \\right]_{-L_Y}^{L_Y} = \\frac{1}{2L_Y} \\left( \\frac{L_Y^3}{3} - \\frac{(-L_Y)^3}{3} \\right) = \\frac{1}{2L_Y} \\left( \\frac{2L_Y^3}{3} \\right) = \\frac{L_Y^2}{3}$$\n代入$L_Y = V_{max}/10$：\n$$P_S = \\frac{(V_{max}/10)^2}{3} = \\frac{V_{max}^2}{300}$$\n这个信号功率$P_S$在两种情况下是相同的，因为它是输入信号本身的属性。\n\n现在，我们来分析量化器A（不匹配的情况）。\n量化器A是为范围$[-V_{max}, V_{max}]$设计的。其步长$\\Delta_A$为：\n$$\\Delta_A = \\frac{2V_{max}}{N}$$\n当安静信号$Y$（其范围为$[-V_{max}/10, V_{max}/10]$）输入到量化器A时，量化器并未过载。我们可以使用给定的量化噪声功率近似公式，该公式取决于量化器的步长$\\Delta_A$。\n$$P_{Q,A} \\approx \\frac{\\Delta_A^2}{12} = \\frac{1}{12} \\left( \\frac{2V_{max}}{N} \\right)^2 = \\frac{4V_{max}^2}{12N^2} = \\frac{V_{max}^2}{3N^2}$$\n量化器A的SQNR为：\n$$SQNR_A = \\frac{P_S}{P_{Q,A}} = \\frac{V_{max}^2 / 300}{V_{max}^2 / (3N^2)} = \\frac{3N^2}{300} = \\frac{N^2}{100}$$\n\n接下来，我们来分析量化器B（匹配的情况）。\n量化器B是专门为安静信号的范围$[-V_{max}/10, V_{max}/10]$设计的。其步长$\\Delta_B$为：\n$$\\Delta_B = \\frac{2(V_{max}/10)}{N} = \\frac{2V_{max}}{10N} = \\frac{V_{max}}{5N}$$\n量化器B的量化噪声功率为：\n$$P_{Q,B} \\approx \\frac{\\Delta_B^2}{12} = \\frac{1}{12} \\left( \\frac{V_{max}}{5N} \\right)^2 = \\frac{V_{max}^2}{12 \\cdot 25 N^2} = \\frac{V_{max}^2}{300N^2}$$\n量化器B的SQNR为：\n$$SQNR_B = \\frac{P_S}{P_{Q,B}} = \\frac{V_{max}^2 / 300}{V_{max}^2 / (300N^2)} = N^2$$\n\n最后，我们需要计算比率$\\frac{SQNR_B}{SQNR_A}$。\n$$\\frac{SQNR_B}{SQNR_A} = \\frac{N^2}{N^2 / 100} = 100$$\n该比率为100。这意味着对于安静信号，正确匹配的量化器比不匹配的量化器提供了100倍的SQNR（即提升了20 dB）。这是因为量化器A的步长对于低幅值信号而言过大，导致了更大的相对量化误差。", "answer": "$$\\boxed{100}$$", "id": "1656250"}, {"introduction": "尽管均匀量化器简单易用，但它通常不是最高效的。对于某些值比其他值更可能出现的信源（例如概率密度函数非均匀的信源），非均匀量化器能以更低的失真度完成量化。本练习将介绍经典的 Lloyd-Max 算法，这是一种设计最优标量量化器的迭代方法，你将通过对一个真实信号模型完成单步迭代，初步探索这一优化过程。[@problem_id:1656236]", "problem": "一个连续信号源由一个随机变量 $X$ 建模，该随机变量服从一个均值为零的拉普拉斯概率密度函数 (PDF)：\n$$p(x) = \\frac{1}{2b} \\exp\\left(-\\frac{|x|}{b}\\right)$$\n其尺度参数设为 $b=1$。\n\n我们希望使用 Lloyd-Max 算法为该信号源设计一个 2 比特（$M=4$ 个电平）的标量量化器。我们以一组初始重建电平开始迭代过程：$q_1 = -3$、$q_2 = -1$、$q_3 = 1$ 和 $q_4 = 3$。\n\n执行一次完整的 Lloyd-Max 算法迭代。首先，根据初始重建电平确定新的判决边界。然后，使用这些新的判决边界计算更新后的重建电平。\n\n求出两个新的正重建电平的值，记为 $q'_3$ 和 $q'_4$。请以有序对 $(q'_3, q'_4)$ 的形式给出你的答案，每个值四舍五入到四位有效数字。", "solution": "我们使用针对均方误差的 Lloyd-Max 最优性条件：\n1) 判决边界的最近邻条件，和\n2) 重建电平的质心条件。\n\n给定初始重建电平 $q_{1}=-3$，$q_{2}=-1$，$q_{3}=1$，$q_{4}=3$，判决边界是相邻电平之间的中点：\n$$\nb_{1}=\\frac{q_{1}+q_{2}}{2}=-2,\\quad b_{2}=\\frac{q_{2}+q_{3}}{2}=0,\\quad b_{3}=\\frac{q_{3}+q_{4}}{2}=2.\n$$\n\n在这些固定的边界下，更新后的重建电平是其各自量化区间上的条件均值。对于 $b=1$ 的拉普拉斯 PDF，$p(x)=\\frac{1}{2}\\exp(-|x|)$。在 $(0,\\infty)$ 上，我们有 $p(x)=\\frac{1}{2}\\exp(-x)$。\n\n$q'_{3}$ 对应的量化区间是 $(0,2)$，所以\n$$\nq'_{3}=\\frac{\\int_{0}^{2} x\\,p(x)\\,dx}{\\int_{0}^{2} p(x)\\,dx}\n=\\frac{\\frac{1}{2}\\int_{0}^{2} x \\exp(-x)\\,dx}{\\frac{1}{2}\\int_{0}^{2} \\exp(-x)\\,dx}.\n$$\n使用不定积分 $\\int x\\exp(-x)\\,dx=-(x+1)\\exp(-x)$，我们得到\n$$\n\\int_{0}^{2} x \\exp(-x)\\,dx=\\left[-(x+1)\\exp(-x)\\right]_{0}^{2}=1-3\\exp(-2),\n$$\n并且\n$$\n\\int_{0}^{2} \\exp(-x)\\,dx=1-\\exp(-2).\n$$\n因此，\n$$\nq'_{3}=\\frac{1-3\\exp(-2)}{1-\\exp(-2)}=1-\\frac{2}{\\exp(2)-1}.\n$$\n\n$q'_{4}$ 对应的量化区间是 $(2,\\infty)$，所以\n$$\nq'_{4}=\\frac{\\int_{2}^{\\infty} x\\,p(x)\\,dx}{\\int_{2}^{\\infty} p(x)\\,dx}\n=\\frac{\\frac{1}{2}\\int_{2}^{\\infty} x \\exp(-x)\\,dx}{\\frac{1}{2}\\int_{2}^{\\infty} \\exp(-x)\\,dx}.\n$$\n使用相同的不定积分，\n$$\n\\int_{2}^{\\infty} x \\exp(-x)\\,dx=\\lim_{b\\to\\infty}\\left[-(x+1)\\exp(-x)\\right]_{2}^{b}=3\\exp(-2),\n$$\n并且\n$$\n\\int_{2}^{\\infty} \\exp(-x)\\,dx=\\exp(-2).\n$$\n因此，\n$$\nq'_{4}=\\frac{3\\exp(-2)}{\\exp(-2)}=3.\n$$\n\n数值计算并保留四位有效数字，\n$$\nq'_{3}=1-\\frac{2}{\\exp(2)-1}\\approx 0.6870,\\qquad q'_{4}=3.000.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 0.6870 & 3.000 \\end{pmatrix}}$$", "id": "1656236"}]}