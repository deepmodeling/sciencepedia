{"hands_on_practices": [{"introduction": "这个首个练习解决了一个量化中的核心问题：当我们将一组信源值归为一类后，应该用哪个单一的值来代表它们？我们将看到，为了最小化均方误差失真，最佳选择是该组数值的“质心” (centroid)，即条件期望。这个练习通过一个离散信源的具体例子，让你能够直接应用这一基本优化原理。[@problem_id:1659863]", "id": "1659863", "problem": "一个离散无记忆信源 $X$ 从字母表 $\\mathcal{X} = \\{1, 2, 4, 8\\}$ 中产生符号。每个符号以相等的概率生成。我们希望使用一个两级量化器设计一个简单的数据压缩方案。信源字母表被划分为两个不相交的集合：$R_1 = \\{1, 2\\}$ 和 $R_2 = \\{4, 8\\}$。$R_1$ 中的所有符号都映射到单个表示电平 $\\hat{x}_1$，$R_2$ 中的所有符号都映射到第二个表示电平 $\\hat{x}_2$。\n\n量化的质量通过平均平方误差失真来衡量，其定义为信源符号与其表示之间差的平方的期望值。\n\n确定最优表示电平 $\\hat{x}_1^*$ 和 $\\hat{x}_2^*$，以最小化给定划分下的平均平方误差失真。按顺序给出 $\\hat{x}_1^*$ 和 $\\hat{x}_2^*$ 的精确值作为您的答案。", "solution": "问题要求找到最优表示电平 $\\hat{x}_1^*$ 和 $\\hat{x}_2^*$，以最小化给定信源和划分下的平均平方误差失真。\n\n信源字母表为 $\\mathcal{X} = \\{1, 2, 4, 8\\}$。由于四个符号中的每一个都以相等的概率生成，因此对于每个 $x \\in \\mathcal{X}$，其概率质量函数 (PMF) 为 $p(x) = \\frac{1}{4}$。\n\n失真度量是平方误差，$d(x, \\hat{x}) = (x - \\hat{x})^2$。\n\n平均失真 $D$ 是失真的期望值，可以写成对所有信源符号的求和：\n$$D = E[d(X, \\hat{X})] = \\sum_{x \\in \\mathcal{X}} p(x) d(x, \\hat{x}(x))$$\n其中 $\\hat{x}(x)$ 是信源符号 $x$ 的表示电平。\n\n信源字母表被划分为 $R_1 = \\{1, 2\\}$ 和 $R_2 = \\{4, 8\\}$。$R_1$ 中的所有符号由 $\\hat{x}_1$ 表示，$R_2$ 中的所有符号由 $\\hat{x}_2$ 表示。因此，我们可以将平均失真写成 $\\hat{x}_1$ 和 $\\hat{x}_2$ 的函数：\n$$D(\\hat{x}_1, \\hat{x}_2) = \\sum_{x \\in R_1} p(x) (x - \\hat{x}_1)^2 + \\sum_{x \\in R_2} p(x) (x - \\hat{x}_2)^2$$\n和中的两项是相互独立的。第一项仅取决于 $\\hat{x}_1$，第二项仅取决于 $\\hat{x}_2$。因此，我们可以通过分别最小化每一项来最小化 $D$。\n\n为了找到区域 $R_1$ 的最优表示电平 $\\hat{x}_1^*$，我们通过对相应项求关于 $\\hat{x}_1$ 的导数并将其设为零来最小化该项：\n$$\\frac{\\partial}{\\partial \\hat{x}_1} \\left[ \\sum_{x \\in R_1} p(x) (x - \\hat{x}_1)^2 \\right] = 0$$\n$$\\sum_{x \\in R_1} p(x) \\cdot 2(x - \\hat{x}_1) \\cdot (-1) = 0$$\n$$-2 \\left( \\sum_{x \\in R_1} x p(x) - \\hat{x}_1 \\sum_{x \\in R_1} p(x) \\right) = 0$$\n求解 $\\hat{x}_1$，我们得到最优值 $\\hat{x}_1^*$：\n$$\\hat{x}_1^* = \\frac{\\sum_{x \\in R_1} x p(x)}{\\sum_{x \\in R_1} p(x)}$$\n这是在 $X \\in R_1$ 条件下 $X$ 的条件期望，也称为该区域的质心。\n\n现在我们可以代入区域 $R_1 = \\{1, 2\\}$ 的值：\n$$p(1) = \\frac{1}{4}, \\quad p(2) = \\frac{1}{4}$$\n$$\\hat{x}_1^* = \\frac{1 \\cdot p(1) + 2 \\cdot p(2)}{p(1) + p(2)} = \\frac{1 \\cdot \\frac{1}{4} + 2 \\cdot \\frac{1}{4}}{\\frac{1}{4} + \\frac{1}{4}} = \\frac{\\frac{3}{4}}{\\frac{2}{4}} = \\frac{3}{2}$$\n\n类似地，对于区域 $R_2 = \\{4, 8\\}$，最优表示电平 $\\hat{x}_2^*$ 是 $R_2$ 的质心：\n$$\\hat{x}_2^* = \\frac{\\sum_{x \\in R_2} x p(x)}{\\sum_{x \\in R_2} p(x)}$$\n代入区域 $R_2 = \\{4, 8\\}$ 的值：\n$$p(4) = \\frac{1}{4}, \\quad p(8) = \\frac{1}{4}$$\n$$\\hat{x}_2^* = \\frac{4 \\cdot p(4) + 8 \\cdot p(8)}{p(4) + p(8)} = \\frac{4 \\cdot \\frac{1}{4} + 8 \\cdot \\frac{1}{4}}{\\frac{1}{4} + \\frac{1}{4}} = \\frac{\\frac{12}{4}}{\\frac{2}{4}} = \\frac{12}{2} = 6$$\n\n因此，最小化平均平方误差失真的最优表示电平是 $\\hat{x}_1^* = 3/2$ 和 $\\hat{x}_2^* = 6$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{3}{2} & 6 \\end{pmatrix}}$$"}, {"introduction": "在实际系统中，带宽或存储等资源总是有限的。这个问题提出了一个典型的权衡：在只有一个比特可用的情况下，你应该用它来量化一个高方差信号还是一个低方差信号？通过分析总失真，你将发现数据压缩的一个关键原则：将比特应用于系统中最不确定（方差最高）的部分，能带来最显著的失真降低。[@problem_id:1659835]", "id": "1659835", "problem": "一个数据采集系统测量两个独立的物理量，这两个物理量可以被建模为两个独立的随机变量 $X$ 和 $Y$。两者都服从均值为零的正态分布。$X$ 的方差为 $\\sigma_X^2 = 9$，$Y$ 的方差为 $\\sigma_Y^2 = 1$。\n\n由于带宽限制，您只能使用一个比特来改进其中一个量的表示。您有两个选择：\n1.  使用该比特为 $X$ 创建一个一位量化器。在这种情况下，$Y$ 的表示（记为 $\\hat{Y}$）将是其期望值。\n2.  使用该比特为 $Y$ 创建一个一位量化器。在这种情况下，$X$ 的表示（记为 $\\hat{X}$）将是其期望值。\n\n假设无论对哪个变量进行量化，都使用一个最优的一位量化器。最优量化器是指能使均方误差失真最小化的量化器。系统的总失真是各个失真之和：$D_{total} = E[(X-\\hat{X})^2] + E[(Y-\\hat{Y})^2]$。\n\n以下哪种策略会导致更低的总均方误差失真？\n\nA. 用一位量化 $X$ 会导致更低的总失真。\nB. 用一位量化 $Y$ 会导致更低的总失真。\nC. 两种策略导致完全相同的总失真。\nD. 如果没有关于量化器设计的更多信息，无法确定哪种策略更好。", "solution": "设 $X \\sim \\mathcal{N}(0,\\sigma_{X}^{2})$，其中 $\\sigma_{X}^{2}=9$；$Y \\sim \\mathcal{N}(0,\\sigma_{Y}^{2})$，其中 $\\sigma_{Y}^{2}=1$，且 $X$ 和 $Y$ 相互独立。如果一个变量没有被量化，而是用其均值（在此为零）来表示，那么它的均方误差等于其方差：\n$$\nE[(V-0)^{2}] = \\operatorname{Var}(V).\n$$\n\n对于使用最优均方误差（MSE）量化器进行一位量化的变量，首先考虑标准正态分布的情况 $Z \\sim \\mathcal{N}(0,1)$。根据对称性和 Lloyd-Max 最优性条件，最优的一位量化器具有零阈值和对称的重建电平 $\\pm a$。定义如果 $Z \\geq 0$，$Q(Z)=a$；如果 $Z<0$，$Q(Z)=-a$。失真作为 $a$ 的函数为\n$$\nD(a)=E[(Z-Q(Z))^{2}]=E[Z^{2}] - 2a\\,E[Z\\,\\operatorname{sign}(Z)] + a^{2}.\n$$\n因为 $Z\\,\\operatorname{sign}(Z)=|Z|$ 且 $E[Z^{2}]=1$，我们有\n$$\nD(a)=1 - 2a\\,E[|Z|] + a^{2}.\n$$\n对 $a$ 进行最小化可得\n$$\n\\frac{dD}{da}=-2E[|Z|]+2a=0 \\quad \\Rightarrow \\quad a^{\\star}=E[|Z|].\n$$\n因此最小失真是\n$$\nD^{\\star}=1-(E[|Z|])^{2}.\n$$\n对于 $Z \\sim \\mathcal{N}(0,1)$，使用 $\\phi(z)=\\frac{1}{\\sqrt{2\\pi}}\\exp(-z^{2}/2)$,\n$$\nE[|Z|]=2\\int_{0}^{\\infty} z \\phi(z)\\,dz=2\\left[-\\phi(z)\\right]_{0}^{\\infty}=2\\phi(0)=\\sqrt{\\frac{2}{\\pi}},\n$$\n所以\n$$\nD^{\\star}=1-\\frac{2}{\\pi}.\n$$\n\n根据尺度不变性，如果 $V=\\sigma Z$，应用缩放后的最优一位量化器会得到\n$$\nE[(V-\\hat{V})^{2}]=\\sigma^{2} D^{\\star}=\\sigma^{2}\\left(1-\\frac{2}{\\pi}\\right).\n$$\n\n现在评估这两种策略：\n\n1) 量化 $X$，用均值表示 $Y$：\n$$\nD_{\\text{total},X}=E[(X-\\hat{X})^{2}] + E[(Y-\\hat{Y})^{2}]\n= \\sigma_{X}^{2}\\left(1-\\frac{2}{\\pi}\\right) + \\sigma_{Y}^{2}\n= 9\\left(1-\\frac{2}{\\pi}\\right) + 1.\n$$\n\n2) 量化 $Y$，用均值表示 $X$：\n$$\nD_{\\text{total},Y}=E[(X-\\hat{X})^{2}] + E[(Y-\\hat{Y})^{2}]\n= \\sigma_{X}^{2} + \\sigma_{Y}^{2}\\left(1-\\frac{2}{\\pi}\\right)\n= 9 + \\left(1-\\frac{2}{\\pi}\\right).\n$$\n\n比较：\n$$\nD_{\\text{total},X} - D_{\\text{total},Y}\n= \\left[9\\left(1-\\frac{2}{\\pi}\\right)+1\\right] - \\left[9 + \\left(1-\\frac{2}{\\pi}\\right)\\right]\n= -\\frac{16}{\\pi} < 0.\n$$\n因此 $D_{\\text{total},X} < D_{\\text{total},Y}$，所以量化 $X$ 会产生更低的总失真。\n\n因此，正确选项是A。", "answer": "$$\\boxed{A}$$"}, {"introduction": "最后的这个练习将我们带入一个更复杂、更真实的二维信号场景。当使用极坐标表示一个二维位置时，我们应该如何在半径和角度之间分配有限的比特预算，以最好地保留原始位置信息？这个练习引入了高率量化理论——一个分析复杂系统的强大工具，并揭示了一个优美的原则，即如何平衡相互竞争的误差源以实现最小的总体失真。[@problem_id:1659814]", "id": "1659814", "problem": "一个传感器网络被用来跟踪一个移动智能体的位置。该智能体的位置被建模为一个二维随机向量 $(X, Y)$，它在一个由内半径 $r_{in}$ 和外半径 $r_{out}$ 定义的环形区域上均匀分布，其中 $0 < r_{in} < r_{out}$。为了传输该位置数据，系统首先将笛卡尔坐标 $(X, Y)$ 转换为极坐标 $(R, \\Theta)$，其中 $R = \\sqrt{X^2 + Y^2}$ 是半径，$\\Theta = \\arctan(Y/X)$ 是角度。\n\n然后，径向分量 $R$ 和角度分量 $\\Theta$ 使用两个独立的标量量化器分别进行量化。每个样本可用的总比特率为 $R_{total}$ 比特，该比特率在两个量化器之间分配，使得 $R_{total} = R_r + R_\\theta$，其中 $R_r$ 和 $R_\\theta$ 分别是用于径向量化器和角度量化器的比特数。目标是最小化总期望失真，该失真定义为原始笛卡尔坐标 $(X,Y)$ 与从量化后的极坐标 $(\\hat{R}, \\hat{\\Theta})$ 获得的重建笛卡尔坐标 $(\\hat{X}, \\hat{Y})$ 之间的均方误差 (MSE)。\n\n假设总比特率 $R_{total}$ 非常高，确定应该分配给径向坐标 $R$ 量化的最优比特分数 $f = R_r / R_{total}$，以最小化此笛卡尔均方误差。您的答案应为一个数值。", "solution": "设 $(X,Y)$ 在环形区域 $\\{(x,y): r_{in} \\leq \\sqrt{x^{2}+y^{2}} \\leq r_{out}\\}$ 上均匀分布。转换为极坐标后，$R=\\sqrt{X^{2}+Y^{2}}$，$\\Theta$ 在 $[0,2\\pi)$ 上均匀分布且与 $R$ 独立，而 $R$ 的密度函数为 $f_{R}(r)=\\frac{2r}{r_{out}^{2}-r_{in}^{2}}$，其中 $r\\in[r_{in},r_{out}]$。特别地，\n$$\n\\mathbb{E}[R^{2}]=\\frac{\\int_{r_{in}}^{r_{out}} r^{2} r \\, dr}{\\int_{r_{in}}^{r_{out}} r \\, dr}=\\frac{1}{2}\\left(r_{out}^{2}+r_{in}^{2}\\right).\n$$\n\n设量化误差为 $e_{r}=\\hat{R}-R$ 和 $e_{\\theta}=\\hat{\\Theta}-\\Theta$。对于小误差（高比特率情况），对笛卡尔重建进行线性化可得\n$$\n\\begin{aligned}\nX&=R\\cos\\Theta,\\quad Y=R\\sin\\Theta,\\\\\n\\hat{X}&\\approx (R+e_{r})\\cos(\\Theta+e_{\\theta})\\approx R\\cos\\Theta+e_{r}\\cos\\Theta-R e_{\\theta}\\sin\\Theta,\\\\\n\\hat{Y}&\\approx (R+e_{r})\\sin(\\Theta+e_{\\theta})\\approx R\\sin\\Theta+e_{r}\\sin\\Theta+R e_{\\theta}\\cos\\Theta.\n\\end{aligned}\n$$\n因此，笛卡尔坐标的平方误差为\n$$\n(\\hat{X}-X)^{2}+(\\hat{Y}-Y)^{2}=(e_{r}\\cos\\Theta-R e_{\\theta}\\sin\\Theta)^{2}+(e_{r}\\sin\\Theta+R e_{\\theta}\\cos\\Theta)^{2}=e_{r}^{2}+R^{2} e_{\\theta}^{2}.\n$$\n在高比特率标量量化下，误差与信源以及误差之间近似不相关，其方差为 $D_{r}=\\mathbb{E}[e_{r}^{2}]$ 和 $D_{\\theta}=\\mathbb{E}[e_{\\theta}^{2}]$。因此，笛卡尔均方误差为\n$$\nD=\\mathbb{E}\\big[(\\hat{X}-X)^{2}+(\\hat{Y}-Y)^{2}\\big]=D_{r}+\\mathbb{E}[R^{2}]\\,D_{\\theta}.\n$$\n\n对于高比特率最优标量量化器（固定速率或熵编码），每种失真都遵循指数速率定律\n$$\nD_{r}\\approx \\alpha\\,2^{-2 R_{r}},\\qquad D_{\\theta}\\approx \\beta\\,2^{-2 R_{\\theta}},\n$$\n其中 $\\alpha$ 和 $\\beta$ 是取决于信源边缘分布和量化器设计的正常数。当 $R_{r}=f R_{total}$ 和 $R_{\\theta}=(1-f)R_{total}$ 时，总失真为\n$$\nD(f)\\approx \\alpha\\,2^{-2 f R_{total}}+\\gamma\\,2^{-2(1-f)R_{total}},\\quad \\gamma\\triangleq \\mathbb{E}[R^{2}]\\,\\beta.\n$$\n求导并令其为零以求最小值：\n$$\n\\frac{dD}{df}=-2 R_{total}\\ln 2\\,\\alpha\\,2^{-2 f R_{total}}+2 R_{total}\\ln 2\\,\\gamma\\,2^{-2(1-f)R_{total}}=0,\n$$\n可得\n$$\n\\alpha\\,2^{-2 f R_{total}}=\\gamma\\,2^{-2(1-f)R_{total}}.\n$$\n取以 2 为底的对数，\n$$\n\\log_{2}\\alpha-2 f R_{total}=\\log_{2}\\gamma-2(1-f)R_{total},\n$$\n所以\n$$\n2 R_{total}(1-2f)=\\log_{2}\\!\\left(\\frac{\\gamma}{\\alpha}\\right)\\quad\\Rightarrow\\quad f=\\frac{1}{2}-\\frac{1}{4 R_{total}}\\log_{2}\\!\\left(\\frac{\\gamma}{\\alpha}\\right).\n$$\n在假设的非常高比特率情况（大的 $R_{total}$）下，偏移项可以忽略不计，最优分配收敛于\n$$\nf\\to \\frac{1}{2}.\n$$\n因此，分配给径向坐标的最优比特分数为 $f=0.5$。", "answer": "$$\\boxed{0.5}$$"}]}