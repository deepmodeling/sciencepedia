{"hands_on_practices": [{"introduction": "在数字世界中，我们经常需要将连续的模拟信号（如温度）转换为离散的数字值，这一过程称为量化。这个练习将带你探讨量化过程中不可避免的误差。我们将使用两种最常见的失真度量——平方误差和绝对误差——来量化这种误差，并计算它们的平均值，从而直观地理解不同度量标准如何影响我们对系统性能的评估 [@problem_id:1618900]。", "problem": "一个数字温度计被设计用来测量环境温度。真实温度，记为连续随机变量 $X$，可以精确地用一个在 $[-5.5, 5.5]$ 摄氏度范围内的均匀分布来建模。温度计的内部模数转换器处理真实温度 $X$ 并输出一个量化值 $\\hat{X}$，它是与 $X$ 最接近的整数。\n\n这个量化过程的性能可以通过不同的失真度量来评估。我们考虑两种常见的度量：\n1.  平方误差失真，对于真实值 $x$ 及其量化版本 $\\hat{x}$ 定义为 $d_2(x, \\hat{x}) = (x - \\hat{x})^2$。\n2.  绝对误差失真，定义为 $d_1(x, \\hat{x}) = |x - \\hat{x}|$。\n\n平均失真是失真度量在真实温度 $X$ 的分布上的期望值。设 $D_2$ 为平均平方误差失真，$D_1$ 为平均绝对误差失真。\n\n计算比值 $\\frac{D_2}{D_1}$。请将答案表示为一个精确分数。", "solution": "量化器将每个 $x \\in [k - \\frac{1}{2}, k + \\frac{1}{2}]$ 映射到整数 $k$，其中 $k \\in \\{-5,-4,\\ldots,5\\}$。在半整数点上的取值构成一个零测集，不影响期望的计算。真实温度 $X$ 在 $[-5.5, 5.5]$ 上服从均匀分布，因此其概率密度函数在此区间上为 $f_{X}(x) = \\frac{1}{11}$。\n\n定义量化误差 $U = X - \\hat{X}$。在每个单元区间 $[k - \\frac{1}{2}, k + \\frac{1}{2}]$ 中，令 $x = k + u$，其中 $u \\in \\left[-\\frac{1}{2}, \\frac{1}{2}\\right]$，此时有 $\\hat{X} = k$，所以 $U = u$。根据均匀性和平移不变性，每个单元区间的贡献是相同的，并且总共有 11 个这样的单元区间。因此，\n$$\nD_{2} = \\mathbb{E}\\!\\left[(X - \\hat{X})^{2}\\right] = \\sum_{k=-5}^{5} \\int_{k - \\frac{1}{2}}^{k + \\frac{1}{2}} (x - k)^{2} \\cdot \\frac{1}{11} \\, dx = \\int_{-\\frac{1}{2}}^{\\frac{1}{2}} u^{2} \\, du,\n$$\n其中，在进行变量代换 $u = x - k$ 后，来自求和的因子 $11$ 与概率密度中的 $\\frac{1}{11}$ 相抵消。计算该积分为\n$$\n\\int_{-\\frac{1}{2}}^{\\frac{1}{2}} u^{2} \\, du = \\left[ \\frac{u^{3}}{3} \\right]_{-\\frac{1}{2}}^{\\frac{1}{2}} = \\frac{2}{3} \\left(\\frac{1}{2}\\right)^{3} = \\frac{1}{12}.\n$$\n类似地，\n$$\nD_{1} = \\mathbb{E}\\!\\left[|X - \\hat{X}|\\right] = \\sum_{k=-5}^{5} \\int_{k - \\frac{1}{2}}^{k + \\frac{1}{2}} |x - k| \\cdot \\frac{1}{11} \\, dx = \\int_{-\\frac{1}{2}}^{\\frac{1}{2}} |u| \\, du.\n$$\n根据对称性，\n$$\n\\int_{-\\frac{1}{2}}^{\\frac{1}{2}} |u| \\, du = 2 \\int_{0}^{\\frac{1}{2}} u \\, du = 2 \\cdot \\frac{1}{2} \\left(\\frac{1}{2}\\right)^{2} = \\frac{1}{4}.\n$$\n因此，该比值为\n$$\n\\frac{D_{2}}{D_{1}} = \\frac{\\frac{1}{12}}{\\frac{1}{4}} = \\frac{1}{3}.\n$$", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1618900"}, {"introduction": "失真度量不仅适用于连续信号，也同样是评估离散信息系统性能的关键。这个练习以一个交通信号灯的例子为背景，让你构建一个失真矩阵，其中不同类型的错误具有不同的“代价”——例如，将“红灯”错判为“绿灯”的后果远比其他错误严重。通过这个实践，你将学会如何根据具体应用场景的风险来量身定制失真函数，并计算系统的平均失真 [@problem_id:1618910]。", "problem": "一个用于自动驾驶汽车网络的远程监控系统传输交通信号灯的状态。所有可能的状态集合（源字母表）为 $\\mathcal{X} = \\{x_1, x_2, x_3\\}$，分别对应{红灯, 黄灯, 绿灯}。对交通信号灯的长期统计观测表明，每种状态的概率如下：$P(x_1=\\text{红灯}) = 0.45$，$P(x_2=\\text{黄灯}) = 0.10$，$P(x_3=\\text{绿灯}) = 0.45$。\n\n该状态通过一个噪声信道进行传输。该信道是对称的，任何符号被正确传输的概率为 $1-p$，其中 $p=0.02$。如果发生错误（概率为 $p$），则发送的符号被接收为其他两个符号中任意一个的概率是均等的。接收符号的集合（重建字母表）为 $\\mathcal{Y} = \\{y_1, y_2, y_3\\}$，同样对应{红灯, 黄灯, 绿灯}。\n\n为了量化传输错误的影响，定义了一个失真度量 $d(x, y)$。该度量基于无量纲的“成本单位”。\n- 如果一个符号被正确传输和接收（即 $x=y$），则失真为 0。\n- 大多数不正确的传输（即 $x \\neq y$）被认为是一种不便，并被赋予 1 个成本单位的失真。\n- 然而，当状态为“红灯”（$x_1$）但被接收为“绿灯”（$y_3$）时，这种特定错误被认为是高度危险的。这种特定错误被赋予 10 个成本单位的失真。所有其他类型的错误，包括“绿灯”被接收为“红灯”，其失真为 1 个成本单位。\n\n计算该通信系统的平均失真。将您的答案表示为一个实数，保留三位有效数字。", "solution": "令 $X \\in \\mathcal{X}$ 表示发送的符号，$Y \\in \\mathcal{Y}$ 表示接收的符号。该信道是对称的，其特性为\n$$\nP(Y=y \\mid X=x)=\\begin{cases}\n1-p, & y=x,\\\\\n\\frac{p}{2}, & y \\neq x,\n\\end{cases}\n$$\n其中 $p=0.02$。失真度量满足：如果 $x=y$，则 $d(x,y)=0$；$d(x_{1},y_{3})=10$；对于所有其他 $x \\neq y$ 的情况，$d(x,y)=1$。\n\n平均失真为\n$$\n\\mathbb{E}[d(X,Y)] = \\sum_{x \\in \\mathcal{X}} P_{X}(x) \\sum_{y \\in \\mathcal{Y}} P_{Y|X}(y \\mid x)\\, d(x,y).\n$$\n\n计算条件期望：\n- 对于 $X=x_{1}$ (红灯):\n$$\n\\mathbb{E}[d \\mid X=x_{1}] = \\frac{p}{2}\\cdot 1 + \\frac{p}{2}\\cdot 10 = \\frac{11}{2}p.\n$$\n- 对于 $X=x_{2}$ (黄灯):\n$$\n\\mathbb{E}[d \\mid X=x_{2}] = \\frac{p}{2}\\cdot 1 + \\frac{p}{2}\\cdot 1 = p.\n$$\n- 对于 $X=x_{3}$ (绿灯):\n$$\n\\mathbb{E}[d \\mid X=x_{3}] = \\frac{p}{2}\\cdot 1 + \\frac{p}{2}\\cdot 1 = p.\n$$\n\n按源概率 $P(x_{1})=0.45$，$P(x_{2})=0.10$，$P(x_{3})=0.45$ 进行加权，\n$$\n\\mathbb{E}[d(X,Y)] = 0.45 \\cdot \\frac{11}{2}p + 0.10 \\cdot p + 0.45 \\cdot p\n= p\\left( \\frac{11}{2} \\cdot 0.45 + 0.55 \\right).\n$$\n将 $0.45=\\frac{9}{20}$ 和 $0.55=\\frac{11}{20}$ 代入，\n$$\n\\mathbb{E}[d(X,Y)] = p \\left( \\frac{11}{2} \\cdot \\frac{9}{20} + \\frac{11}{20} \\right)\n= p \\left( \\frac{99}{40} + \\frac{22}{40} \\right)\n= p \\cdot \\frac{121}{40}.\n$$\n\n代入 $p=0.02=\\frac{1}{50}$ 得\n$$\n\\mathbb{E}[d(X,Y)] = \\frac{121}{40} \\cdot \\frac{1}{50} = \\frac{121}{2000} = 0.0605.\n$$\n保留三位有效数字，结果为 $0.0605$。", "answer": "$$\\boxed{0.0605}$$", "id": "1618910"}, {"introduction": "在许多现实世界的预测问题中，例如金融建模或库存管理，高估和低估所带来的成本往往是不对称的。这个练习将挑战你处理一个非对称的失真函数，它对高估的惩罚更为严厉。你不仅需要计算平均失真，更重要的是，你需要运用优化技巧来找到那个能使预期失真最小化的最佳预测值，这体现了失真理论在实际决策制定中的核心作用 [@problem_id:1618945]。", "problem": "一个自动化的金融建模系统旨在预测某种特定商品的次日收盘价。实际收盘价，由随机变量 $X$ 表示，被建模为在一个已知区间 $[A, B]$ 上均匀分布，其中 $A$ 和 $B$ 是正常数且 $A < B$。\n\n该系统采用一种简单的预测策略：它总是预测一个恒定值 $\\hat{x} = c$。预测的性能通过该公司设计的自定义失真函数 $d(x, \\hat{x})$ 进行评估。该函数对预测误差进行非对称惩罚。具体来说，它对过度预测（当预测价格高于实际价格时）的惩罚比对预测不足的惩罚更严厉。失真定义如下：\n$$d(x, \\hat{x}) = \\begin{cases} (x - \\hat{x})^2 & \\text{如果 } x > \\hat{x} \\quad \\text{(预测不足)} \\\\ 2(x - \\hat{x})^2 & \\text{如果 } x \\le \\hat{x} \\quad \\text{(过度预测)} \\end{cases}$$\n\n您的任务是确定最优预测值 $c$，使得平均（期望）失真 $D(c) = E[d(X, c)]$ 最小。请用一个关于 $A$ 和 $B$ 的闭式解析表达式来表示您的最终答案。", "solution": "设 $X \\sim \\text{Unif}[A,B]$，其密度函数为 $f_{X}(x) = \\frac{1}{B-A}$，对于 $x \\in [A,B]$。对于一个常数预测器 $\\hat{x}=c$，期望失真是\n$$\nD(c) = \\mathbb{E}[d(X,c)] = \\frac{1}{B-A} \\left( \\int_{A}^{\\min\\{c,B\\}} 2(x-c)^{2} \\, dx + \\int_{\\max\\{c,A\\}}^{B} (x-c)^{2} \\, dx \\right).\n$$\n我们根据 $c$ 相对于 $A$ 和 $B$ 的位置分段计算 $D(c)$。\n\n1) 如果 $c \\leq A$，那么对于所有 $x \\in [A,B]$ 都有 $x>c$，所以\n$$\nD(c) = \\frac{1}{B-A} \\int_{A}^{B} (x-c)^{2} \\, dx = \\frac{1}{3(B-A)} \\left[ (B-c)^{3} - (A-c)^{3} \\right].\n$$\n求导，\n$$\nD'(c) = \\frac{1}{B-A} \\left[ (A-c)^{2} - (B-c)^{2} \\right] = 2c - (A+B).\n$$\n对于 $c \\leq A < \\frac{A+B}{2}$，我们有 $D'(c) < 0$，因此 $D(c)$ 在 $(-\\infty,A]$ 上是递减的，并在此区域的 $c=A$ 处达到其最小值。\n\n2) 如果 $A \\leq c \\leq B$，则\n$$\nD(c) = \\frac{1}{B-A} \\left( \\int_{A}^{c} 2(x-c)^{2} \\, dx + \\int_{c}^{B} (x-c)^{2} \\, dx \\right)\n= \\frac{1}{3(B-A)} \\left[ (B-c)^{3} - 2(A-c)^{3} \\right].\n$$\n求导，\n$$\nD'(c) = \\frac{1}{B-A} \\left[ - (B-c)^{2} + 2(A-c)^{2} \\right].\n$$\n在 $[A,B]$ 中的临界点满足\n$$\n2(A-c)^{2} = (B-c)^{2} \\quad \\Longrightarrow \\quad \\sqrt{2}(c-A) = B-c \\quad \\Longrightarrow \\quad c^{*} = \\frac{B + \\sqrt{2}\\, A}{1 + \\sqrt{2}}.\n$$\n二阶导数是\n$$\nD''(c) = \\frac{1}{B-A} \\left[ 2(B-c) - 4(A-c) \\right] = \\frac{2}{B-A} \\left( B - 2A + c \\right),\n$$\n对于所有 $c \\in [A,B]$，该式都为正，因为 $B - 2A + c \\geq B - A > 0$。因此 $c^{*}$ 是在 $[A,B]$ 中的唯一最小值点。\n\n3) 如果 $c \\geq B$，那么对于所有 $x \\in [A,B]$ 都有 $x \\leq c$，所以\n$$\nD(c) = \\frac{2}{B-A} \\int_{A}^{B} (x-c)^{2} \\, dx = \\frac{2}{3(B-A)} \\left[ (B-c)^{3} - (A-c)^{3} \\right],\n$$\n并且\n$$\nD'(c) = 4c - 2(A+B) > 0 \\quad \\text{for } c \\geq B,\n$$\n因此 $D(c)$ 在 $[B,\\infty)$ 上是递增的，并在此区域的 $c=B$ 处达到其最小值。\n\n综合各个区域，$D(c)$ 在 $c \\leq A$ 时递减，在 $[A,B]$ 上是严格凸的，其唯一最小值点在 $c^{*} = \\frac{B + \\sqrt{2}\\, A}{1 + \\sqrt{2}}$，并且在 $c \\geq B$ 时递增。因此，全局最小值点是\n$$\nc^{*} = \\frac{B + \\sqrt{2}\\, A}{1 + \\sqrt{2}}.\n$$", "answer": "$$\\boxed{\\frac{B+\\sqrt{2}\\,A}{1+\\sqrt{2}}}$$", "id": "1618945"}]}