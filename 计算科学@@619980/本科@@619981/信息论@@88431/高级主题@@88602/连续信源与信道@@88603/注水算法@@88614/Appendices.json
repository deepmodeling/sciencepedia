{"hands_on_practices": [{"introduction": "我们的第一个练习将直接应用注水原理。它解决了一个最基本的情景：如何将固定的总功率 $P$ 在两个噪声水平不同的信道间进行分配，以实现最大化的总容量。通过这个练习，你将建立对该算法的核心直觉。[@problem_id:1668042]", "problem": "一个无线通信系统工作在两个独立、不互相干扰的频段上。每个频段都可以建模为一个并行的加性高斯白噪声（AWGN）信道，其中AWGN指的是一种信道模型，其唯一的损伤是线性叠加的宽带或白噪声，该噪声具有恒定的谱密度和高斯分布的幅度。就本题而言，假设两个频段的信道功率增益均为1。\n\n第一个频段的噪声功率由方差 $\\sigma_1^2 = 1.0$ 任意单位表征，而第二个频段的噪声功率方差为 $\\sigma_2^2 = 3.0$ 任意单位。发射机总功率预算为 $P = 4.0$ 任意单位，该功率可以在两个频段之间分配。\n\n为了实现两个信道的最大可能总信息论容量，必须采用一种最优的功率分配策略。确定分配给第一个信道的最佳功率 $P_1$ 和分配给第二个信道的最佳功率 $P_2$。\n\n以数值对 $(P_1, P_2)$ 的形式给出你的答案，单位为任意单位。", "solution": "我们将这两个频段建模为具有单位增益和噪声方差 $\\sigma_{1}^{2}$ 和 $\\sigma_{2}^{2}$ 的并行AWGN信道。设 $P_{1}$ 和 $P_{2}$ 是分配给信道1和信道2的功率，满足 $P_{1} \\ge 0$, $P_{2} \\ge 0$ 和 $P_{1} + P_{2} = P$。\n\n总容量（每次信道使用）与下式成正比\n$$\nC(P_{1},P_{2}) \\propto \\ln\\!\\left(1 + \\frac{P_{1}}{\\sigma_{1}^{2}}\\right) + \\ln\\!\\left(1 + \\frac{P_{2}}{\\sigma_{2}^{2}}\\right),\n$$\n其中使用 $\\ln$（自然对数）不失一般性，因为在相同约束下，任何正的乘法或单调变换都不会改变最大化问题的解。\n\n构造用于在约束条件 $P_{1} + P_{2} = P$ 和 $P_{i} \\ge 0$ 下最大化 $C$ 的拉格朗日函数：\n$$\n\\mathcal{L} = \\sum_{i=1}^{2} \\ln\\!\\left(1 + \\frac{P_{i}}{\\sigma_{i}^{2}}\\right) - \\lambda\\left(P_{1} + P_{2} - P\\right) - \\sum_{i=1}^{2} \\nu_{i} P_{i},\n$$\n其中 $\\lambda$ 是等式约束的乘子，$\\nu_{i} \\ge 0$ 是非负约束的乘子。\n\n对于任何 $P_{i} > 0$（因此 $\\nu_{i} = 0$）的 $i$，KKT平稳性条件给出\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial P_{i}} = \\frac{1}{\\sigma_{i}^{2} + P_{i}} - \\lambda = 0\n\\;\\;\\Rightarrow\\;\\;\nP_{i} = \\frac{1}{\\lambda} - \\sigma_{i}^{2}.\n$$\n施加 $P_{i} \\ge 0$ 的约束，得到注水解\n$$\nP_{i} = \\max\\!\\left(0,\\, \\mu - \\sigma_{i}^{2}\\right), \\quad \\text{其中 } \\mu \\equiv \\frac{1}{\\lambda},\n$$\n其中选择 $\\mu$ 以满足总功率约束\n$$\n\\sum_{i=1}^{2} \\max\\!\\left(0,\\, \\mu - \\sigma_{i}^{2}\\right) = P.\n$$\n\n代入给定值 $\\sigma_{1}^{2} = 1$，$\\sigma_{2}^{2} = 3$ 和 $P = 4$。检验两个信道是否都处于活动状态。如果 $\\mu \\le 3$，那么 $P_{2} = 0$ 且 $P_{1} = \\mu - 1$。强制 $P_{1} = 4$ 将要求 $\\mu = 5$，这与 $\\mu \\le 3$ 矛盾。因此 $\\mu > 3$，所以两个信道都处于活动状态，并且\n$$\n(\\mu - 1) + (\\mu - 3) = 4\n\\;\\;\\Rightarrow\\;\\;\n2\\mu - 4 = 4\n\\;\\;\\Rightarrow\\;\\;\n\\mu = 4.\n$$\n因此\n$$\nP_{1} = \\mu - \\sigma_{1}^{2} = 4 - 1 = 3,\n\\qquad\nP_{2} = \\mu - \\sigma_{2}^{2} = 4 - 3 = 1,\n$$\n它们满足 $P_{1} + P_{2} = 4$ 和 $P_{i} \\ge 0$，因此是该最优分配问题的解。", "answer": "$$\\boxed{\\begin{pmatrix}3 & 1\\end{pmatrix}}$$", "id": "1668042"}, {"introduction": "注水算法不仅分配功率，还决定哪些信道值得使用。这个问题探讨了信道变得“活跃”的临界阈值。通过计算启动对次优信道分配功率所需的确切总功率，你将更深入地理解此优化问题中信道选择的“全有或全无”特性。[@problem_id:1668056]", "problem": "一个通信系统通过三个并行的独立加性高斯白噪声（AWGN）信道运行。每个信道的噪声功率是恒定且已知的。设这三个信道的噪声功率分别为 $\\sigma_1^2 = 2$、$\\sigma_2^2 = 5$ 和 $\\sigma_3^2 = 10$（单位任意）。有一个总发射功率 $P$ 可用于分配给这三个信道。为了最大化并行信道的总和速率容量，进行最优的功率分配。\n\n确定在第二个信道（噪声功率为 $\\sigma_2^2 = 5$ 的那个信道）刚开始获得非零功率分配的临界点上，总功率 $P$ 的精确值。", "solution": "在总功率约束下最大化并行高斯信道和速率容量的问题，是一个经典的优化问题，可通过注水算法解决。\n\n根据香农-哈特利定理，分配功率为 $P_i$ 且噪声方差为 $\\sigma_i^2$ 的单个 AWGN 信道 $i$ 的容量由 $C_i = B \\log_2(1 + \\frac{P_i}{B N_i})$ 给出，其中 $B$ 是带宽， $N_i$ 是噪声功率谱密度。假设归一化带宽（$B=1/2$ 以符合常见的信息论符号表示，或者简单地看作对数前因子为 1/2），容量表达式变为 $C_i = \\frac{1}{2} \\log_2(1 + \\frac{P_i}{\\sigma_i^2})$，其中 $\\sigma_i^2$ 是噪声功率。目标是在总功率约束 $\\sum_{i=1}^{3} P_i = P$ 下，最大化总容量 $C = \\sum_{i=1}^{3} C_i$。\n\n注水算法提供了最优的功率分配方案。其直观思想是，我们应该为“更好”的信道分配更多的功率，即噪声较小的信道。这可以被形象地看作是将总量为 $P$ 的“水”（功率）注入一个容器中，该容器的底部具有不同的深度，对应于噪声水平 $\\sigma_i^2$。\n\n分配给信道 $i$ 的功率 $P_i$ 由以下公式给出：\n$$P_i = \\max(0, \\mu - \\sigma_i^2)$$\n其中 $\\mu$ 是由总功率 $P$ 决定的“水位”。水位 $\\mu$ 对所有信道都是一个常数，其选择要满足总功率约束条件：\n$$P = \\sum_{i=1}^{3} \\max(0, \\mu - \\sigma_i^2)$$\n\n问题要求的是在第二个信道刚开始获得非零功率分配时总功率 $P$ 的具体值。信道按其噪声功率排序为：$\\sigma_1^2 = 2 < \\sigma_2^2 = 5 < \\sigma_3^2 = 10$。\n\n注水过程首先将功率分配给噪声最低的信道（信道1）。随着总功率 $P$ 的增加，水位 $\\mu$ 上升。\n- 如果 $\\mu < \\sigma_1^2$，没有信道获得功率。\n- 如果 $\\sigma_1^2 < \\mu < \\sigma_2^2$，只有信道1获得功率。\n- 第二个信道（噪声功率为 $\\sigma_2^2$）将在水位 $\\mu$ 恰好达到其噪声基底 $\\sigma_2^2$ 的那一刻开始接收非零功率分配。\n\n所以，临界点由条件 $\\mu = \\sigma_2^2$ 定义。\n\n在此水位上，我们可以计算分配给三个信道中每一个的功率：\n1.  对于信道1（噪声 $\\sigma_1^2 = 2$）：\n    $P_1 = \\max(0, \\mu - \\sigma_1^2) = \\max(0, \\sigma_2^2 - \\sigma_1^2) = \\max(0, 5 - 2) = 3$。\n    由于 $\\sigma_2^2 > \\sigma_1^2$，信道1获得正功率。\n\n2.  对于信道2（噪声 $\\sigma_2^2 = 5$）：\n    $P_2 = \\max(0, \\mu - \\sigma_2^2) = \\max(0, \\sigma_2^2 - \\sigma_2^2) = \\max(0, 0) = 0$。\n    这与它“刚开始”接收功率的条件是一致的。总功率的任何无限小增加都会使 $\\mu$ 升高到 $\\sigma_2^2$ 以上，从而使 $P_2 > 0$。\n\n3.  对于信道3（噪声 $\\sigma_3^2 = 10$）：\n    $P_3 = \\max(0, \\mu - \\sigma_3^2) = \\max(0, \\sigma_2^2 - \\sigma_3^2) = \\max(0, 5 - 10) = \\max(0, -5) = 0$。\n    由于 $\\sigma_2^2 < \\sigma_3^2$，信道3没有获得功率。\n\n此临界点上的总功率 $P$ 是分配给所有信道的功率之和：\n$$P = P_1 + P_2 + P_3$$\n$$P = 3 + 0 + 0 = 3$$\n\n因此，需要总功率 $P=3$ 才能将水位恰好提升到第二个信道的噪声基底。", "answer": "$$\\boxed{3}$$", "id": "1668056"}, {"introduction": "最后的这个练习综合了功率分配和信道选择的概念，以解决一个更完整的问题。你将为一个四信道系统确定最佳功率分布，然后利用该分布计算可实现的最大总容量 $C_{\\text{total}}$。这个练习模拟了一个真实的工程任务，并展示了注水算法的最终目标。[@problem_id:1668060]", "problem": "考虑一个采用并行信道的通信系统简化模型，这是正交频分复用（OFDM）等技术中的一个基础概念。该系统由四个独立的并行加性高斯白噪声（AWGN）信道组成。四个信道各自的噪声功率（由方差 $\\sigma_i^2$ 表示）分别为 $\\sigma_1^2 = 1.0$，$\\sigma_2^2 = 2.0$，$\\sigma_3^2 = 4.0$ 和 $\\sigma_4^2 = 8.0$，单位均为标准化功率单位。\n\n总发射功率预算为 $P_{total} = 10.0$ 单位，可分配给这四个信道。为了最大化总数据速率，功率根据注水算法进行分配。\n\n单个信道 $i$ 的容量 $C_i$ 由其分配功率 $P_i$ 和噪声功率 $\\sigma_i^2$ 决定，其公式为 $C_i = \\log_2(1 + P_i / \\sigma_i^2)$。容量的单位是比特/信道使用。\n\n计算系统的总容量 $C_{total} = \\sum_{i=1}^4 C_i$。最终答案以比特/信道使用为单位，并四舍五入到四位有效数字。", "solution": "我们必须在总功率约束 $\\sum_{i=1}^{4}P_{i}=P_{\\text{total}}=10$ 和 $P_{i}\\geq 0$ 的条件下，最大化四个噪声方差分别为 $\\sigma_{1}^{2}=1$，$\\sigma_{2}^{2}=2$，$\\sigma_{3}^{2}=4$，$\\sigma_{4}^{2}=8$ 的独立AWGN子信道的总容量。每个信道的容量为 $C_{i}=\\log_{2}\\!\\left(1+\\frac{P_{i}}{\\sigma_{i}^{2}}\\right)$，因此优化问题是\n$$\n\\max_{P_{i}\\geq 0,\\ \\sum P_{i}=10}\\ \\sum_{i=1}^{4}\\log_{2}\\!\\left(1+\\frac{P_{i}}{\\sigma_{i}^{2}}\\right).\n$$\n对这个凹优化问题使用KKT条件，最优分配由注水法则给出\n$$\nP_{i}=\\max\\{0,\\ \\lambda-\\sigma_{i}^{2}\\},\n$$\n其中水位 $\\lambda$ 的选择需要满足 $\\sum_{i=1}^{4}P_{i}=10$。\n\n将噪声方差排序为 $1,2,4,8$。首先检验所有四个信道都被激活的假设，这要求 $\\lambda>8$。那么\n$$\n\\sum_{i=1}^{4}P_{i}=\\sum_{i=1}^{4}(\\lambda-\\sigma_{i}^{2})=4\\lambda-(1+2+4+8)=4\\lambda-15=10,\n$$\n这得出 $\\lambda=\\frac{25}{4}=6.25$，与 $\\lambda>8$ 相矛盾。因此，并非所有四个信道都被激活。\n\n接下来检验三个信道（前三个）被激活的情况，这要求 $4<\\lambda\\leq 8$。那么\n$$\n\\sum_{i=1}^{3}P_{i}=3\\lambda-(1+2+4)=3\\lambda-7=10 \\quad\\Rightarrow\\quad \\lambda=\\frac{17}{3}.\n$$\n由于 $\\frac{17}{3}\\in(4,8)$，这是相符的。因此，最优功率分配为\n$$\nP_{1}=\\frac{17}{3}-1=\\frac{14}{3},\\quad P_{2}=\\frac{17}{3}-2=\\frac{11}{3},\\quad P_{3}=\\frac{17}{3}-4=\\frac{5}{3},\\quad P_{4}=0,\n$$\n并且确实有 $\\frac{14}{3}+\\frac{11}{3}+\\frac{5}{3}=10$。\n\n对于激活的信道，注意到\n$$\n1+\\frac{P_{i}}{\\sigma_{i}^{2}}=1+\\frac{\\lambda-\\sigma_{i}^{2}}{\\sigma_{i}^{2}}=\\frac{\\lambda}{\\sigma_{i}^{2}}.\n$$\n因此，各个信道的容量为\n$$\nC_{1}=\\log_{2}\\!\\left(\\frac{\\lambda}{\\sigma_{1}^{2}}\\right)=\\log_{2}\\!\\left(\\frac{17}{3}\\right),\\quad\nC_{2}=\\log_{2}\\!\\left(\\frac{\\lambda}{\\sigma_{2}^{2}}\\right)=\\log_{2}\\!\\left(\\frac{17}{6}\\right),\\quad\nC_{3}=\\log_{2}\\!\\left(\\frac{\\lambda}{\\sigma_{3}^{2}}\\right)=\\log_{2}\\!\\left(\\frac{17}{12}\\right),\\quad\nC_{4}=0,\n$$\n总容量为\n$$\nC_{\\text{total}}=\\log_{2}\\!\\left(\\frac{17}{3}\\right)+\\log_{2}\\!\\left(\\frac{17}{6}\\right)+\\log_{2}\\!\\left(\\frac{17}{12}\\right)\n=\\log_{2}\\!\\left(\\frac{17^{3}}{3\\cdot 6\\cdot 12}\\right)\n=\\log_{2}\\!\\left(\\frac{4913}{216}\\right).\n$$\n数值上，\n$$\nC_{\\text{total}}=\\log_{2}\\!\\left(\\frac{4913}{216}\\right)\\approx 4.507501\\ \\text{比特/信道使用},\n$$\n四舍五入到四位有效数字后是 $4.508$。", "answer": "$$\\boxed{4.508}$$", "id": "1668060"}]}