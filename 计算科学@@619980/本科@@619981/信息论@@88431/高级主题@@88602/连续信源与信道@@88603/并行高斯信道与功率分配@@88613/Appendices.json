{"hands_on_practices": [{"introduction": "在深入研究复杂的功率优化分配策略之前，让我们先从一个简单直观的基准案例入手。这个练习将要求你计算在并行信道间平均分配总功率时系统的总容量。通过这种方式，我们可以为更先进的“注水”算法所能带来的性能提升建立一个量化的参考基准。[@problem_id:1644845]", "problem": "一个无线通信系统被建模为由三个并行的、独立的加性高斯白噪声（AWGN）信道组成。这些信道工作在独立的、互不干扰的频带上。三个信道中的每一个都具有相同的带宽 $W = 1.0$ MHz。由于每个频带的环境干扰不同，这三个信道的噪声功率也不同；测得其值分别为 $N_1 = 1.0$ 瓦，$N_2 = 2.0$ 瓦和 $N_3 = 5.0$ 瓦。\n\n该系统的总可用发射功率为 $P_{total} = 15.0$ 瓦。采用一种简单的功率分配策略，将此总功率平均分配给三个信道。\n\n计算在该指定的功率分配策略下，此系统的总理论容量。以百万比特每秒（Mbps）为单位表示您的答案。将最终答案四舍五入至三位有效数字。", "solution": "对于一个带宽为 $W$、信号功率为 $P$、该频带上噪声功率为 $N$ 的AWGN信道，其香农容量为\n$$\nC = W \\log_{2}\\!\\left(1+\\frac{P}{N}\\right).\n$$\n对于三个独立的、互不干扰的并行信道，总容量是各个信道容量之和：\n$$\nC_{\\text{total}} = \\sum_{i=1}^{3} W \\log_{2}\\!\\left(1+\\frac{P_{i}}{N_{i}}\\right).\n$$\n总可用功率被平均分配，所以\n$$\nP_{1} = P_{2} = P_{3} = \\frac{P_{\\text{total}}}{3}.\n$$\n已知 $W = 1.0 \\times 10^{6}$ Hz，$P_{\\text{total}} = 15.0$ W，以及 $(N_{1},N_{2},N_{3})=(1.0,2.0,5.0)$ W，我们得到\n$$\nP_{1}=P_{2}=P_{3}=5.0 \\text{ W}.\n$$\n因此，\n$$\nC_{\\text{total}} = W\\left[\\log_{2}\\!\\left(1+\\frac{5.0}{1.0}\\right)+\\log_{2}\\!\\left(1+\\frac{5.0}{2.0}\\right)+\\log_{2}\\!\\left(1+\\frac{5.0}{5.0}\\right)\\right].\n$$\n计算每一项：\n$$\n\\log_{2}(1+5.0)=\\log_{2}(6), \\quad \\log_{2}\\!\\left(1+\\frac{5.0}{2.0}\\right)=\\log_{2}(3.5), \\quad \\log_{2}\\!\\left(1+\\frac{5.0}{5.0}\\right)=\\log_{2}(2)=1.\n$$\n于是，\n$$\nC_{\\text{total}} = \\left(1.0 \\times 10^{6}\\right)\\left[\\log_{2}(6)+\\log_{2}(3.5)+1\\right] \\text{ bits per second}.\n$$\n以百万比特每秒（Mbps）为单位表示，总容量为\n$$\nC_{\\text{total}} \\text{ (in Mbps)} = \\log_{2}(6)+\\log_{2}(3.5)+1.\n$$\n数值计算如下，\n$$\n\\log_{2}(6) \\approx 2.5849625007, \\quad \\log_{2}(3.5) \\approx 1.8073549221,\n$$\n所以\n$$\nC_{\\text{total}} \\approx 2.5849625007+1.8073549221+1 = 5.3923174228 \\text{ Mbps}.\n$$\n四舍五入至三位有效数字，得到 $5.39$ Mbps。", "answer": "$$\\boxed{5.39}$$", "id": "1644845"}, {"introduction": "现实中的信道质量往往参差不齐，将功率平均分配并非最优选择。此练习将引导你探索最优功率分配的核心思想——“注水”算法的直观体现。你将推导出一个临界功率阈值，只有当总功率超过该阈值时，我们才开始为噪声较大的“差”信道分配功率，这揭示了优先利用高质量信道的优化原则。[@problem_id:1644871]", "problem": "一台深空探测器设计用于通过 $N$ 个并行、独立的通信信道将数据传回地球，其中 $N$ 为一个正偶数。所有信道均建模为加性高斯白噪声（AWGN）信道。由于背景辐射和干扰的变化，这些信道的质量并非均一。具体而言，一半的信道（$N/2$ 个）被归类为“好”信道，其噪声功率方差较低，为 $\\sigma_g^2$。另一半信道（$N/2$ 个）为“坏”信道，其噪声功率方差显著更高，为 $\\sigma_b^2$，且 $\\sigma_b^2 > \\sigma_g^2$。\n\n探测器上的一个中央功率控制器必须将总可用功率 $P_{total}$ 分配给这 $N$ 个信道。分配给第 $i$ 个信道的功率记为 $P_i$，须满足 $\\sum_{i=1}^{N} P_i = P_{total}$ 且对所有 $i$ 都有 $P_i \\ge 0$。执行此分配是为了最大化系统的总香农容量。\n\n求出总功率的精确阈值，记为 $P_{threshold}$，当总功率达到此阈值时，最优功率分配策略开始向“坏”信道分配非零功率。也就是说，对于任何总功率 $P_{total} \\le P_{threshold}$，全部功率均分配给“好”信道；而对于任何 $P_{total} > P_{threshold}$，“坏”信道中至少有一个会获得功率。\n\n将答案表示为关于 $N$、$\\sigma_g^2$ 和 $\\sigma_b^2$ 的解析表达式。", "solution": "我们将第 $i$ 个 AWGN 信道建模为噪声方差为 $\\sigma_{i}^{2}$，功率分配为 $P_{i} \\ge 0$。总容量（单位为奈特/信道使用，由于对数的底不影响优化器，使用自然对数即可）为\n$$\nC=\\sum_{i=1}^{N}\\ln\\!\\left(1+\\frac{P_{i}}{\\sigma_{i}^{2}}\\right),\n$$\n约束条件为 $\\sum_{i=1}^{N}P_{i}=P_{total}$ 且对所有 $i$ 都有 $P_{i}\\ge 0$。\n\n这是一个带线性约束的凹最大化问题，因此 Karush-Kuhn-Tucker (KKT) 条件是其解的充要条件。构造拉格朗日函数\n$$\n\\mathcal{L}=\\sum_{i=1}^{N}\\ln\\!\\left(1+\\frac{P_{i}}{\\sigma_{i}^{2}}\\right)-\\lambda\\!\\left(\\sum_{i=1}^{N}P_{i}-P_{total}\\right)-\\sum_{i=1}^{N}\\nu_{i}P_{i},\n$$\n其中 $\\lambda$ 是总功率约束对应的拉格朗日乘子，$\\nu_{i}\\ge 0$ 是 $P_{i}\\ge 0$ 约束对应的拉格朗日乘子。对每个 $i$，平稳性条件为：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial P_{i}}=\\frac{1}{\\sigma_{i}^{2}+P_{i}}-\\lambda-\\nu_{i}=0.\n$$\n根据互补松弛性，若 $P_{i}>0$ 则 $\\nu_{i}=0$，可得\n$$\n\\frac{1}{\\sigma_{i}^{2}+P_{i}}=\\lambda \\quad \\Longrightarrow \\quad P_{i}=\\frac{1}{\\lambda}-\\sigma_{i}^{2}.\n$$\n若 $P_{i}=0$，则 $\\nu_{i}\\ge 0$ 进行调整以满足平稳性条件。因此，最优分配方案为注水解\n$$\nP_{i}=\\max\\!\\left\\{0,\\,\\mu-\\sigma_{i}^{2}\\right\\}, \\quad \\text{其中 } \\mu=\\frac{1}{\\lambda},\n$$\n且选择 $\\mu$ 以满足 $\\sum_{i=1}^{N}P_{i}=P_{total}$。\n\n在本问题中，有 $\\frac{N}{2}$ 个噪声方差为 $\\sigma_{g}^{2}$ 的好信道和 $\\frac{N}{2}$ 个噪声方差为 $\\sigma_{b}^{2}$ 的坏信道，且 $\\sigma_{b}^{2}>\\sigma_{g}^{2}$。根据对称性，在注水算法下，所有好信道接收相同的功率，所有坏信道也接收相同的功率。当 $\\mu$ 从 $\\sigma_{g}^{2}$ 开始向上增加时，功率首先仅分配给好信道；当水位恰好达到坏信道的噪声基底时，即当 $\\mu=\\sigma_{b}^{2}$ 时，坏信道开始接收非零功率。\n\n当只有好信道处于激活状态时，所用总功率为\n$$\nP_{total}=\\frac{N}{2}\\bigl(\\mu-\\sigma_{g}^{2}\\bigr), \\quad \\text{对于 } \\sigma_{g}^{2}\\le \\mu \\le \\sigma_{b}^{2}.\n$$\n在坏信道即将被激活的阈值点，令 $\\mu=\\sigma_{b}^{2}$ 可得\n$$\nP_{threshold}=\\frac{N}{2}\\bigl(\\sigma_{b}^{2}-\\sigma_{g}^{2}\\bigr).\n$$\n对于任何 $P_{total}\\le P_{threshold}$，最优分配方案会将所有坏信道的 $P_i$ 设为 0，并将功率均分给所有好信道。对于任何 $P_{total}>P_{threshold}$，水位将超过 $\\sigma_{b}^{2}$，最优分配方案将为每个坏信道分配正功率。", "answer": "$$\\boxed{\\frac{N}{2}\\left(\\sigma_{b}^{2}-\\sigma_{g}^{2}\\right)}$$", "id": "1644871"}, {"introduction": "为了进一步巩固你对“注水”算法工作机制的理解，让我们从一个逆向的视角来审视这个问题。在这个练习中，你将不再是去分配给定的总功率 $P$，而是根据已知的最优“水位” $\\mu$ 来反推系统所使用的总功率。这项实践能够加深你对“水位”、信道噪声和最终功率分配三者之间精确数学关系的理解。[@problem_id:1644887]", "problem": "一位工程师的任务是分析一个通信系统的性能，该系统使用五个并行、独立的信道。每个信道都被建模为加性高斯白噪声（AWGN）信道，但具有不同的噪声功率。这五个信道的噪声功率已经测得，由集合 $\\sigma^2 = \\{2.5, 4.0, 7.8, 10.5, 12.0\\}$ 给出，所有值的单位均为毫瓦（mW）。\n\n为了最大化总数据速率，该系统采用了一种最优功率分配策略。该策略将可用的总发射功率分配到各个信道中。该算法的运行方式是，对于任何被分配了非零信号功率 $P_i > 0$ 的信道，其信号功率和噪声功率之和为一个常数，即 $P_i + \\sigma_i^2 = \\mu$。对于未被使用（分配了零功率）的信道，其噪声功率 $\\sigma_i^2$ 大于或等于这个常数水平 $\\mu$。\n\n运行分配算法后，系统报告了一个最优常数水平 $\\mu = 9.5$ mW。根据此信息，计算系统分配到这五个信道上的总发射功率 $P$。\n\n将您的最终答案以瓦特（W）为单位表示，并四舍五入到三位有效数字。", "solution": "我们使用注水原理来建模并行AWGN信道上的最优功率分配。对于每个噪声功率为 $\\sigma_{i}^{2}$ 的信道，其分配的信号功率为\n$$\nP_{i}=\\max\\{\\mu-\\sigma_{i}^{2},\\,0\\},\n$$\n其中 $\\mu$ 是水位。总发射功率是其总和\n$$\nP=\\sum_{i=1}^{5}P_{i}=\\sum_{i=1}^{5}\\max\\{\\mu-\\sigma_{i}^{2},\\,0\\}.\n$$\n给定 $\\mu=9.5$ mW 和 $\\sigma^{2}=\\{2.5,\\,4.0,\\,7.8,\\,10.5,\\,12.0\\}$ mW，活跃信道是那些满足 $\\sigma_{i}^{2}<\\mu$ 的信道，即噪声功率为 $2.5$、$4.0$ 和 $7.8$ mW 的信道。它们各自的功率分配为\n$$\nP_{1}=9.5-2.5=7.0\\ \\text{mW},\\quad P_{2}=9.5-4.0=5.5\\ \\text{mW},\\quad P_{3}=9.5-7.8=1.7\\ \\text{mW},\n$$\n而对于其余的信道，\n$$\nP_{4}=\\max\\{9.5-10.5,0\\}=0,\\quad P_{5}=\\max\\{9.5-12.0,0\\}=0.\n$$\n因此，以毫瓦为单位的总发射功率是\n$$\nP=7.0+5.5+1.7=14.2\\ \\text{mW}.\n$$\n转换为瓦特，\n$$\nP=14.2\\times 10^{-3}\\ \\text{W}=0.0142\\ \\text{W}.\n$$\n四舍五入到三位有效数字，该值仍为 $0.0142$。", "answer": "$$\\boxed{0.0142}$$", "id": "1644887"}]}