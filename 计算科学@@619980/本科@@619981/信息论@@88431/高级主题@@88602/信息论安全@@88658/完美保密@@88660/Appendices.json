{"hands_on_practices": [{"introduction": "要真正掌握完美保密的精髓，我们必须理解其核心要求。这个练习将带你超越简单的二进制异或（XOR）运算，探索一个更通用的加密系统。通过推导实现完美保密对密钥分发所提出的必要且充分的条件，你将从根本上理解为什么一次性密码本（One-time Pad）要求密钥必须是完全随机和均匀的[@problem_id:1657913]。", "problem": "一个极简的安全通信系统被设计用于传输三种可能的消息之一，这些消息由整数集合 $\\mathcal{M} = \\{0, 1, 2\\}$ 表示。为了加密一条消息 $m \\in \\mathcal{M}$，一个密钥 $k$ 从集合 $\\mathcal{K} = \\{0, 1, 2\\}$ 中根据概率分布 $P(K=k)$ 选取。加密函数将消息 $m$ 和密钥 $k$ 映射到一个密文 $c$，该函数由模运算规则 $c = (m + k) \\pmod 3$ 给出。得到的密文 $c$ 也是集合 $\\{0, 1, 2\\}$ 中的一个元素。\n\n该系统被设计来达到完美保密性。一个密码系统具有完美保密性的充要条件是，对于所有可能的密文，在给定明文 $m$ 的条件下观察到密文 $c$ 的条件概率（记作 $P(C=c|M=m)$）与明文 $m$ 无关。\n\n以下哪项描述了该系统要达到完美保密性，其密钥概率分布所必须满足的充要条件？\n\nA. $P(K=0) = P(K=1) = P(K=2)$\n\nB. $P(K=0) = 1/2$, $P(K=1) = 1/4$, $P(K=2) = 1/4$\n\nC. 密钥分布必须与明文分布相同，即对于 $i \\in \\{0, 1, 2\\}$，$P(K=i) = P(M=i)$。\n\nD. 必须确定性地选择一个密钥，例如 $P(K=0)=1$。\n\nE. 任何只要满足对所有 $k \\in \\mathcal{K}$ 都有 $P(K=k) > 0$ 的分布都是有效的。", "solution": "给定一个在集合 $\\{0,1,2\\}$ 上的密码，其加密规则为 $c = (m + k) \\bmod 3$。密钥 $K$ 根据分布 $P(K=k)$ 选取，并且，根据完美保密性分析的标准假设，$K$ 的选择与 $M$ 无关。完美保密性要求对于所有的 $c$，$P(C=c \\mid M=m)$ 都与 $m$ 无关。\n\n由于加密是确定性的，对于任意固定的 $m$ 和 $c$，事件 $\\{C=c\\}$ 发生的充要条件是 $K \\equiv c - m \\pmod{3}$。利用 $K$ 和 $M$ 的独立性，我们得到\n$$\nP(C=c \\mid M=m) = P\\big(K = (c - m) \\bmod 3\\big).\n$$\n因此，为了实现完美保密性（$C$ 与 $M$ 的独立性），等式右边不能依赖于 $m$。固定 $c$，并比较不同的 $m$ 值：\n- 当 $m=0$ 时：$P(C=c \\mid M=0) = P(K=c)$。\n- 当 $m=1$ 时：$P(C=c \\mid M=1) = P(K=(c-1) \\bmod 3)$。\n- 当 $m=2$ 时：$P(C=c \\mid M=2) = P(K=(c-2) \\bmod 3)$。\n\n与 $m$ 的无关性意味着，对于每个固定的 $c$，都有\n$$\nP(K=0) = P(K=1) = P(K=2).\n$$\n这证明了必要性。对于充分性，如果 $P(K=0) = P(K=1) = P(K=2)$，那么对于任意的 $m$ 和 $c$，\n$$\nP(C=c \\mid M=m) = P\\big(K = (c - m) \\bmod 3\\big)\n$$\n对于 $(c-m) \\bmod 3$ 的所有三种可能值都等于同一个常数，因此它与 $m$ 无关。因此该条件也是充分的。\n\n因此，密钥分布必须是在 $\\{0,1,2\\}$ 上的均匀分布，这正是选项 A。", "answer": "$$\\boxed{A}$$", "id": "1657913"}, {"introduction": "在理论上，完美保密提供了一种无懈可击的安全保证，但在实践中，加密系统的设计缺陷或不当使用会导致信息泄露。本练习让你扮演一名密码分析师的角色，面对一个有缺陷的加密系统。通过应用贝叶斯定理，你将能够根据截获的密文来更新对原始明文的概率判断，从而亲身体验“信息泄露”的实际含义[@problem_id:1645924]。", "problem": "一位密码学家为一个专门的应用设计了一个小型密码系统。可能的明文集合是 $\\mathcal{M} = \\{m_1, m_2, m_3\\}$，可能的密钥集合是 $\\mathcal{K} = \\{k_1, k_2, k_3\\}$，得到的密文集合是 $\\mathcal{C} = \\{c_1, c_2, c_3, c_4\\}$。\n\n明文消息 $M$ 和加密密钥 $K$ 的选择是相互独立的。明文的概率分布由 $P(M=m_1) = \\frac{1}{2}$，$P(M=m_2) = \\frac{1}{4}$ 和 $P(M=m_3) = \\frac{1}{4}$ 给出。密钥的概率分布由 $P(K=k_1) = \\frac{1}{2}$，$P(K=k_2) = \\frac{1}{4}$ 和 $P(K=k_3) = \\frac{1}{4}$ 给出。\n\n加密函数将一个明文和一个密钥映射到一个密文 $c = E(k, m)$，它由下表定义，其中行对应密钥，列对应明文：\n\n| $E(k,m)$ | $m_1$ | $m_2$ | $m_3$ |\n|---|---|---|---|\n| $k_1$ | $c_1$ | $c_2$ | $c_1$ |\n| $k_2$ | $c_2$ | $c_3$ | $c_4$ |\n| $k_3$ | $c_1$ | $c_2$ | $c_2$ |\n\n一个敌手截获了密文 $c_1$。基于这一观察，原始明文是 $m_1$ 的更新概率是多少？计算条件概率 $P(M=m_1 | C=c_1)$，结果表示为精确分数。", "solution": "我们使用贝叶斯法则以及 $M$ 和 $K$ 的独立性。由于 $M$ 和 $K$ 是独立的，且加密是确定性的，我们有\n$$\nP(M=m_{1}\\mid C=c_{1})=\\frac{P(M=m_{1},C=c_{1})}{P(C=c_{1})}.\n$$\n首先计算分子中的联合概率。事件 $\\{M=m_{1},C=c_{1}\\}$ 发生当 $M=m_{1}$ 且密钥 $K$ 满足 $E(K,m_{1})=c_{1}$。从表中可知，$E(k_{1},m_{1})=c_{1}$ 且 $E(k_{3},m_{1})=c_{1}$，而 $E(k_{2},m_{1})\\neq c_{1}$。因此\n$$\nP(M=m_{1},C=c_{1})=P(M=m_{1},K=k_{1})+P(M=m_{1},K=k_{3}).\n$$\n根据独立性，\n$$\nP(M=m_{1},K=k_{1})=P(M=m_{1})P(K=k_{1})=\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{4},\n$$\n$$\nP(M=m_{1},K=k_{3})=P(M=m_{1})P(K=k_{3})=\\frac{1}{2}\\cdot\\frac{1}{4}=\\frac{1}{8},\n$$\n从而\n$$\nP(M=m_{1},C=c_{1})=\\frac{1}{4}+\\frac{1}{8}=\\frac{3}{8}.\n$$\n接下来，使用全概率定律，对所有满足 $E(k,m)=c_{1}$ 的 $(k,m)$ 计算分母 $P(C=c_{1})$。从表中可知，产生 $c_{1}$ 的对是 $(k_{1},m_{1})$、$(k_{1},m_{3})$ 和 $(k_{3},m_{1})$。因此\n$$\nP(C=c_{1})=P(M=m_{1},K=k_{1})+P(M=m_{3},K=k_{1})+P(M=m_{1},K=k_{3}).\n$$\n根据独立性，\n$$\nP(M=m_{3},K=k_{1})=P(M=m_{3})P(K=k_{1})=\\frac{1}{4}\\cdot\\frac{1}{2}=\\frac{1}{8},\n$$\n并使用前面计算出的项，\n$$\nP(C=c_{1})=\\frac{1}{4}+\\frac{1}{8}+\\frac{1}{8}=\\frac{1}{2}.\n$$\n因此，\n$$\nP(M=m_{1}\\mid C=c_{1})=\\frac{\\frac{3}{8}}{\\frac{1}{2}}=\\frac{3}{4}.\n$$", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "1645924"}, {"introduction": "我们如何精确地衡量一个非完美保密系统到底“泄露了多少”信息？信息论为此提供了强大的数学工具——互信息（Mutual Information）。在这个练习中，加密算法本身是经典的异或操作，但密钥的生成过程存在偏差。你的任务是计算明文 $M$ 和密文 $C$ 之间的互信息 $I(M;C)$，这将让你从定性理解信息泄露，跃升到用“比特”为单位进行定量分析的层面[@problem_id:1645954]。", "problem": "一位工程师正在分析一个为加密单个二进制位而设计的简单密码系统。该系统模型如下：明文消息，由随机变量 $M$ 表示，可以是 0 或 1。消息源是无偏的，即 $P(M=0) = 0.5$。加密密钥，由随机变量 $K$ 表示，也是一个二进制位。该密钥由一个本应是随机的过程生成，但一个缺陷导致了有偏分布：生成 0 的概率为 $P(K=0) = 0.2$。密文 $C$ 是通过对消息和密钥进行按位异或（XOR）运算生成的，即 $C = M \\oplus K$。假设密钥生成过程与消息独立。\n\n您的任务是通过计算消息 $M$ 和密文 $C$ 之间的互信息 $I(M;C)$ 来量化该系统的信息泄露。您的答案应以比特为单位，并四舍五入到三位有效数字。", "solution": "设 $M\\in\\{0,1\\}$ 且 $P(M=0)=P(M=1)=\\frac{1}{2}$，$K\\in\\{0,1\\}$ 且与 $M$ 独立，其中 $P(K=0)=0.2$ 且 $P(K=1)=0.8$。密文为 $C=M\\oplus K$。\n\n我们使用以下公式计算互信息\n$$\nI(M;C)=H(C)-H(C|M).\n$$\n\n首先，计算 $H(C)$。由于 $C=M\\oplus K$，\n$$\nP(C=1)=P(M\\neq K)=P(M=0)P(K=1)+P(M=1)P(K=0)=\\tfrac{1}{2}\\cdot 0.8+\\tfrac{1}{2}\\cdot 0.2=\\tfrac{1}{2},\n$$\n同样地，$P(C=0)=\\tfrac{1}{2}$。因此\n$$\nH(C)=H_{2}\\!\\left(\\tfrac{1}{2}\\right)=1 \\text{ 比特},\n$$\n其中 $H_{2}(p)=-p\\log_{2}p-(1-p)\\log_{2}(1-p)$ 是二元熵函数。\n\n接下来，计算 $H(C|M)$。对于任何固定的 $m\\in\\{0,1\\}$，\n$$\nP(C=m\\,|\\,M=m)=P(K=0)=0.2,\\quad P(C\\neq m\\,|\\,M=m)=P(K=1)=0.8,\n$$\n所以\n$$\nH(C|M=m)=H_{2}(0.8).\n$$\n对 $M$ 求平均值可得\n$$\nH(C|M)=H_{2}(0.8).\n$$\n\n因此，\n$$\nI(M;C)=H(C)-H(C|M)=1-H_{2}(0.8).\n$$\n从数值上看，\n$$\nH_{2}(0.8)=-0.8\\log_{2}(0.8)-0.2\\log_{2}(0.2)\\approx 0.721928094887,\n$$\n因此\n$$\nI(M;C)\\approx 1-0.721928094887=0.278071905113 \\text{ 比特}.\n$$\n四舍五入到三位有效数字，结果是 $0.278$ 比特。", "answer": "$$\\boxed{0.278}$$", "id": "1645954"}]}