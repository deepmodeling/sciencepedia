{"hands_on_practices": [{"introduction": "一次性密码本的安全性根植于信息论的坚实基础之上。为了精确分析其安全性，我们首先需要量化系统中固有的不确定性。这个练习将引导你计算构成一次性密码本的两个核心随机元素——消息 $M$ 和密钥 $K$ ——的联合熵，为理解加密如何“隐藏”信息打下基础。[@problem_id:1644099]", "problem": "在一个使用一次性密码本（OTP）加密协议的高度安全的通信网络中，一条明文消息 $M$ 表示为一个长度为 $n$ 的比特串。用于加密的密钥 $K$ 也是一个长度为 $n$ 的比特串。为使OTP提供完美保密性，必须满足两个条件：(1) 消息源是均匀随机的，意味着 $2^n$ 种可能的消息中的任何一种都是等概率的。(2) 密钥也是从所有可能的 $n$ 比特串集合中均匀随机选择的，并且与消息统计独立。在这些理想条件下，计算联合熵 $H(M, K)$，它量化了与变量对 $(M, K)$ 相关的总平均不确定性。请用含 $n$ 的解析表达式表示你的最终答案。", "solution": "设 $M$ 和 $K$ 为在 $\\{0,1\\}^{n}$ 中取值的随机变量。在所述条件下：\n- 均匀性：对于每个 $m \\in \\{0,1\\}^{n}$，$\\Pr(M=m)=2^{-n}$，且对于每个 $k \\in \\{0,1\\}^{n}$，$\\Pr(K=k)=2^{-n}$。\n- 独立性：对于每一对 $(m,k)$，$\\Pr(M=m, K=k)=\\Pr(M=m)\\Pr(K=k)=2^{-n}\\cdot 2^{-n}=2^{-2n}$。\n\n根据定义，对于一个具有概率质量函数（pmf）$p_{X}$ 的离散随机变量 $X$，其香农熵（以比特为单位）为\n$$\nH(X)=-\\sum_{x} p_{X}(x)\\,\\log_{2}\\big(p_{X}(x)\\big).\n$$\n\n首先计算边缘熵。对于 $M$：\n$$\nH(M)=-\\sum_{m \\in \\{0,1\\}^{n}} 2^{-n}\\,\\log_{2}\\big(2^{-n}\\big)\n= -2^{n}\\cdot 2^{-n}\\cdot (-n)=n.\n$$\n通过同样的论证，可得 $H(K)=n$。\n\n使用链式法则和独立性，\n$$\nH(M,K)=H(M)+H(K \\mid M).\n$$\n独立性意味着 $H(K \\mid M)=H(K)$，因此\n$$\nH(M,K)=H(M)+H(K)=n+n=2n.\n$$\n\n等价地，直接从联合概率质量函数计算：\n$$\nH(M,K)=-\\sum_{m,k} 2^{-2n}\\,\\log_{2}\\big(2^{-2n}\\big)\n=-2^{2n}\\cdot 2^{-2n}\\cdot (-2n)=2n,\n$$\n这与使用链式法则得到的结果一致。", "answer": "$$\\boxed{2n}$$", "id": "1644099"}, {"introduction": "一次性密码本的“完美保密性”依赖于一个至关重要的假设：密钥必须在所有可能的密钥中完全均匀随机地选择。如果密钥生成过程存在缺陷，导致密钥只能从一个较小的子集中产生，会发生什么？本练习将通过计算互信息 $I(M; C)$，来量化在这种情况下攻击者最多能获取到多少关于原始消息的信息。[@problem_id:1644119]", "problem": "一家密码学初创公司正在设计一个基于一次性密码本原理的系统。在该系统中，一个表示为 $n$ 位二进制字符串的秘密消息 $M$，通过与一个 $n$ 位的密钥 $K$ 进行按位异或操作来加密。得到的 $n$ 位密文为 $C = M \\oplus K$。\n\n由于密钥生成过程中存在缺陷，密钥 $K$ 并非从所有 $2^n$ 个可能密钥的整个集合中均匀随机选择。而是从一个特定的、公开已知的密钥子集 $\\mathcal{S}$ 中均匀随机选择。已知该子集的大小为 $|\\mathcal{S}| = 2^{n-k}$，其中 $n$ 和 $k$ 是正整数且 $k < n$。\n\n一个攻击者 Eve 截获了一段密文 $C$。Eve 知道加密算法（$C = M \\oplus K$）和受限密钥集 $\\mathcal{S}$ 的确切构成。Eve 通过观察密文 $C$ 能获得的关于消息 $M$ 的信息量，可以用互信息 $I(M; C)$ 来量化。这个值可能取决于原始消息 $M$ 的统计分布。\n\n假设消息 $M$ 和密钥 $K$ 是独立选择的，请确定互信息 $I(M; C)$ 的最大可能值（以比特为单位）。这个最大值是在消息 $M$ 的所有可能概率分布上取得的。你的答案应为一个用 $n$ 和/或 $k$ 表示的表达式。", "solution": "令 $H(\\cdot)$ 表示以比特为单位的香农熵。互信息满足\n$$\nI(M;C)=H(C)-H(C|M).\n$$\n因为 $C=M\\oplus K$，且对于任意固定的 $m$，映射 $k\\mapsto c=m\\oplus k$ 是 $\\{0,1\\}^{n}$ 上的一个双射，我们有\n$$\nH(C|M=m)=H(K) \\quad \\text{对所有 } m,\n$$\n并且因为 $M$ 和 $K$ 是独立的，这得出\n$$\nH(C|M)=H(K).\n$$\n已知 $K$ 在 $|\\mathcal{S}|=2^{n-k}$ 的集合 $\\mathcal{S}$ 上均匀分布，我们得到\n$$\nH(K)=\\log_{2}|\\mathcal{S}|=\\log_{2}\\left(2^{n-k}\\right)=n-k.\n$$\n因此\n$$\nI(M;C)=H(C)-(n-k).\n$$\n由于 $C$ 的取值在 $\\{0,1\\}^{n}$ 中，我们有界 $H(C)\\leq n$，这意味着\n$$\nI(M;C)\\leq n-(n-k)=k.\n$$\n为了证明这个上界是可以达到的，选择 $M$ 在 $\\{0,1\\}^{n}$ 上均匀分布。那么对于任意 $c$，\n$$\nP_{C}(c)=\\sum_{m}P_{M}(m)P_{K}(c\\oplus m)=\\frac{1}{2^{n}}\\sum_{m}P_{K}(c\\oplus m)=\\frac{1}{2^{n}}\\sum_{k}P_{K}(k)=\\frac{1}{2^{n}},\n$$\n所以 $C$ 是均匀分布的，且 $H(C)=n$。代入可得\n$$\nI(M;C)=n-(n-k)=k.\n$$\n因此，在所有消息分布上取得的最大值为 $k$ 比特。", "answer": "$$\\boxed{k}$$", "id": "1644119"}, {"introduction": "在现实世界的密码学应用中，我们必须考虑部分信息泄露的可能性。假设一个一次性密码本系统被正确实施，但攻击者通过其他手段成功获取了部分明文，系统的安全性会受到多大影响？这个练习将使用条件熵来精确计算在这种部分明文泄露的情况下，我们对整个密钥的剩余不确定性，从而揭示一次性密码本的恢复能力。[@problem_id:1644090]", "problem": "一个安全的军事通信系统使用一次性密码本（OTP）来加密消息。在此系统中，消息、密钥和密文被视作比特序列。\n\n消息 $M$ 是一个长度为 $L$ 的比特序列，$M = (M_1, M_2, \\dots, M_L)$。密钥 $K$ 也是一个长度为 $L$ 的比特序列，$K = (K_1, K_2, \\dots, K_L)$，它由一个真随机数生成器生成，其中每个密钥比特 $K_i$ 都是从 $\\{0, 1\\}$ 中独立且均匀随机地选择的。此外，密钥 $K$ 在统计上独立于消息 $M$。密文 $C = (C_1, C_2, \\dots, C_L)$ 是通过按位异或（XOR）运算生成的：对于从 $1$ 到 $L$ 的每个比特 $i$，有 $C_i = M_i \\oplus K_i$。\n\n某个情报机构截获了一段特定的密文 $C$。一段时间后，一次部分安全漏洞泄露了原始明文消息的前 $b$ 个比特，其中 $0 < b < L$。设这部分已知的消息表示为 $M_{1..b} = (M_1, M_2, \\dots, M_b)$。该机构对于明文中余下的 $L-b$ 个比特没有任何信息。\n\n该机构希望量化其对于生成被截获密文所使用的完整密钥 $K$ 的剩余不确定性。计算在给定完整密文 $C$ 和已知部分明文 $M_{1..b}$ 的条件下，密钥 $K$ 的条件熵。将你的答案表示为以 $L$ 和 $b$ 为变量的符号表达式。本题中熵的单位是比特，这意味着在所有熵的计算中都使用以 2 为底的对数。", "solution": "设 $M=(M_{1},\\dots,M_{L})$，$K=(K_{1},\\dots,K_{L})$，以及 $C=(C_{1},\\dots,C_{L})$，其中 $C_{i}=M_{i}\\oplus K_{i}$。将所有向量划分为前 $b$ 个分量和剩余的 $L-b$ 个分量：\n$$\nK=\\bigl(K_{1..b},\\,K_{b+1..L}\\bigr),\\quad M=\\bigl(M_{1..b},\\,M_{b+1..L}\\bigr),\\quad C=\\bigl(C_{1..b},\\,C_{b+1..L}\\bigr).\n$$\n我们需要计算 $H\\bigl(K\\,\\big|\\,C,M_{1..b}\\bigr)$，单位为比特。\n\n根据熵的链式法则，\n$$\nH\\bigl(K\\,\\big|\\,C,M_{1..b}\\bigr)\n=H\\bigl(K_{1..b},K_{b+1..L}\\,\\big|\\,C_{1..b},C_{b+1..L},M_{1..b}\\bigr)\n$$\n$$\n=H\\bigl(K_{1..b}\\,\\big|\\,C_{1..b},C_{b+1..L},M_{1..b}\\bigr)+H\\bigl(K_{b+1..L}\\,\\big|\\,K_{1..b},C_{1..b},C_{b+1..L},M_{1..b}\\bigr).\n$$\n\n对于第一项，由于 $C_{i}=M_{i}\\oplus K_{i}$，对于每个 $i\\leq b$，知道 $C_{i}$ 和 $M_{i}$ 就能确定 $K_{i}$，因此\n$$\nH\\bigl(K_{1..b}\\,\\big|\\,C_{1..b},C_{b+1..L},M_{1..b}\\bigr)=0.\n$$\n\n对于第二项，利用不同位置之间的独立性以及 $K$ 和 $M$ 之间的独立性。在一次性密码本模型中，由于不同位置的比特是独立的，变量 $\\bigl(K_{b+1..L},C_{b+1..L}\\bigr)$ 独立于 $\\bigl(K_{1..b},C_{1..b},M_{1..b}\\bigr)$。因此，\n$$\nH\\bigl(K_{b+1..L}\\,\\big|\\,K_{1..b},C_{1..b},C_{b+1..L},M_{1..b}\\bigr)=H\\bigl(K_{b+1..L}\\,\\big|\\,C_{b+1..L}\\bigr).\n$$\n\n我们现在来计算 $H\\bigl(K_{b+1..L}\\,\\big|\\,C_{b+1..L}\\bigr)$。题目陈述该机构对于 $M_{b+1..L}$ 没有任何信息，因此我们把每个未知的明文比特 $M_{i}$（其中 $i>b$）建模为在 $\\{0,1\\}$上独立且均匀分布，并且独立于 $K$。对于任何 $i>b$ 和任何 $c,k\\in\\{0,1\\}$，\n$$\n\\Pr\\bigl(K_{i}=k,C_{i}=c\\bigr)=\\sum_{m\\in\\{0,1\\}}\\Pr\\bigl(K_{i}=k,M_{i}=m\\bigr)\\,\\mathbf{1}\\{c=m\\oplus k\\}\n=\\Pr(K_{i}=k)\\Pr\\bigl(M_{i}=c\\oplus k\\bigr)=\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{4}.\n$$\n因此 $K_{i}$ 和 $C_{i}$ 是独立的，并且在给定 $C_{i}$ 的条件下，$K_{i}$ 仍然是均匀分布的：\n$$\n\\Pr\\bigl(K_{i}=k\\,\\big|\\,C_{i}=c\\bigr)=\\frac{\\Pr(K_{i}=k,C_{i}=c)}{\\Pr(C_{i}=c)}=\\frac{1/4}{1/2}=\\frac{1}{2},\n$$\n所以\n$$\nH\\bigl(K_{i}\\,\\big|\\,C_{i}\\bigr)=H(K_{i})=1\\quad\\text{比特}.\n$$\n不同位置之间的独立性意味着\n$$\nH\\bigl(K_{b+1..L}\\,\\big|\\,C_{b+1..L}\\bigr)=\\sum_{i=b+1}^{L}H\\bigl(K_{i}\\,\\big|\\,C_{i}\\bigr)=\\sum_{i=b+1}^{L}1=L-b.\n$$\n\n综合两部分，\n$$\nH\\bigl(K\\,\\big|\\,C,M_{1..b}\\bigr)=0+(L-b)=L-b\\quad\\text{比特}.\n$$", "answer": "$$\\boxed{L-b}$$", "id": "1644090"}]}