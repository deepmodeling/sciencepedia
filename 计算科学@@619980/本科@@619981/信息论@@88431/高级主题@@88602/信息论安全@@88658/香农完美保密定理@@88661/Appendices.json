{"hands_on_practices": [{"introduction": "让我们通过一个具体的例子来检验我们对完美保密性的理解。这个练习要求你将完美保密性的基本定义——即观察到密文 $C=c$ 不应改变你对明文 $M$ 的任何认知——应用到一个简单、假设的密码系统中。通过计算后验概率 $P(M=m|C=c)$，你将直接判断该系统是否泄露了信息，从而亲身体验这一核心安全原则。[@problem_id:1657890]", "problem": "一个极简安全消息系统被设计用于传输两个关键指令之一：“保持”（HOLD）或“继续”（PROCEED）。该系统的规格如下：\n\n- 消息空间为 $\\mathcal{M} = \\{m_0, m_1\\}$，其中 $m_0$ 代表“保持”，$m_1$ 代表“继续”。\n- 根据操作环境，发送“保持”的先验概率为 $P(M=m_0) = \\frac{1}{3}$，发送“继续”的概率为 $P(M=m_1) = \\frac{2}{3}$。\n- 密钥空间为 $\\mathcal{K} = \\{k_A, k_B\\}$。每次传输都会均匀随机选择一个密钥，即 $P(K=k_A) = P(K=k_B) = \\frac{1}{2}$。密钥的选择与消息的选择无关。\n- 密文根据以下加密表生成，其中行代表密钥，列代表明文消息，单元格包含来自空间 $\\mathcal{C} = \\{c_X, c_Y, c_Z\\}$ 的结果密文。\n\n| $E(k,m)$      | $m_0$ ('保持') | $m_1$ ('继续') |\n| :-----------: | :------------: | :---------------: |\n| $\\mathbf{k_A}$| $c_X$          | $c_Y$             |\n| $\\mathbf{k_B}$| $c_Y$          | $c_Z$             |\n\n如果观察到密文没有提供关于明文消息的任何信息，则称加密系统具有完美保密性。在数学上，当且仅当对于所有消息 $m \\in \\mathcal{M}$ 和所有满足 $P(C=c) > 0$ 的密文 $c \\in \\mathcal{C}$，都有 $P(M=m | C=c) = P(M=m)$ 成立。\n\n根据此定义，对于所描述的系统，以下哪个陈述是正确的？\n\nA. 是的，该系统具有完美保密性，因为密钥的数量等于消息的数量。\n\nB. 是的，该系统具有完美保密性，因为对于每条消息，都有多种可能的密文。\n\nC. 不，该系统不具有完美保密性，因为观察到密文 $c_X$ 会揭示明文消息。\n\nD. 不，该系统不具有完美保密性，因为消息概率不是均匀的。", "solution": "我们使用完美保密性的定义：对于所有满足 $P(C=c)>0$ 的密文 $c$ 和所有消息 $m$，完美保密性要求 $P(M=m \\mid C=c)=P(M=m)$。\n\n给定 $M$ 和 $K$ 的独立性以及确定性加密 $C=E(K,M)$，我们通过对 $K$ 求期望来计算 $P(C=c \\mid M=m)$：\n$$\nP(C=c \\mid M=m)=\\sum_{k \\in \\mathcal{K}} P(C=c \\mid M=m,K=k) P(K=k),\n$$\n其中，如果 $E(k,m)=c$，则 $P(C=c \\mid M=m,K=k)=1$，否则为 $0$。\n\n从表中可知：\n- 对于 $c_{X}$：$E(k_{A},m_{0})=c_{X}$，没有其他组合能产生 $c_{X}$。\n- 对于 $c_{Y}$：$E(k_{A},m_{1})=c_{Y}$ 且 $E(k_{B},m_{0})=c_{Y}$。\n- 对于 $c_{Z}$：$E(k_{B},m_{1})=c_{Z}$，没有其他组合能产生 $c_{Z}$。\n\n计算 $c_{X}$ 的情况：\n- $P(C=c_{X} \\mid M=m_{0})=P(K=k_{A})=\\frac{1}{2}$，且 $P(C=c_{X} \\mid M=m_{1})=0$。\n- 根据全概率定律，\n$$\nP(C=c_{X})=\\sum_{m \\in \\mathcal{M}} P(C=c_{X} \\mid M=m) P(M=m)=\\frac{1}{2}\\cdot \\frac{1}{3}+0 \\cdot \\frac{2}{3}=\\frac{1}{6}.\n$$\n- 根据贝叶斯法则，\n$$\nP(M=m_{0} \\mid C=c_{X})=\\frac{P(C=c_{X} \\mid M=m_{0})P(M=m_{0})}{P(C=c_{X})}=\\frac{\\frac{1}{2}\\cdot \\frac{1}{3}}{\\frac{1}{6}}=1,\n$$\n$$\nP(M=m_{1} \\mid C=c_{X})=\\frac{P(C=c_{X} \\mid M=m_{1})P(M=m_{1})}{P(C=c_{X})}=0.\n$$\n由于 $P(M=m_{0})=\\frac{1}{3} \\neq 1$ 且 $P(M=m_{1})=\\frac{2}{3} \\neq 0$，我们有 $P(M=m \\mid C=c_{X}) \\neq P(M=m)$。因此，该系统不具备完美保密性。\n\n为完整起见，$c_{Z}$ 同样会以 $1$ 的后验概率揭示 $m_{1}$，而 $c_{Y}$ 产生的后验概率等于先验概率。然而，完美保密性要求该等式对所有具有正概率的密文都成立；$c_{X}$ 的情况不成立足以断定该系统不具备完美保密性。\n\n因此，正确的陈述是观察到密文 $c_{X}$ 会揭示明文消息。", "answer": "$$\\boxed{C}$$", "id": "1657890"}, {"introduction": "在检验了一个系统的完美保密性之后，让我们将角色从分析师转变为设计师。本实践探讨了一个关键问题：我们必须如何设计一个系统才能*实现*完美保密性？以我们熟悉的凯撒密码为模型，你将确定密钥 $K$ 必须满足的概率分布，以确保无论明文自身有何种统计特性，系统都能实现安全。[@problem_id:1657898] 这个过程在一个实际的场景中揭示了香农定理的一项基本要求。", "problem": "在一个密码学场景中，某通信系统采用一种简单的凯撒密码来加密消息。明文、密文和密钥的字母表是整数集合 $\\mathcal{S} = \\{0, 1, \\dots, 25\\}$，它对应于 26 个英文字母。使用密钥 $k \\in \\mathcal{S}$ 加密一个明文符号 $m \\in \\mathcal{S}$，会根据规则 $c = (m + k) \\pmod{26}$ 产生一个密文符号 $c$。\n\n已知明文消息源具有非均匀的概率分布。任何给定明文符号 $m$ 出现的概率为 $P(M=m) = p_m$，其中已知对于所有 $m \\in \\mathcal{S}$ 都有 $p_m > 0$ 且 $\\sum_{m=0}^{25} p_m = 1$。\n\n为使该密码系统达到安全，其目标是实现完美保密性。如果观察密文不能提供关于明文的任何信息，则称该密码系统具有完美保密性。其形式化定义为：对于任何明文符号 $m$ 和任何密文符号 $c$，在给定密文为 $c$ 的条件下明文为 $m$ 的条件概率等于明文为 $m$ 的先验概率。即，$P(M=m|C=c) = P(M=m)$。\n\n为了实现这一点，必须根据一个特定的概率分布 $P(K=k)$ 从 $\\mathcal{S}$ 中随机选择密钥 $k$。请确定对于任何密钥 $k \\in \\mathcal{S}$ 所需的概率 $P(K=k)$。请将你的答案表示为一个数值分数。", "solution": "设明文、密钥和密文的字母表为 $\\mathcal{S}=\\{0,1,\\dots,25\\}$，加密方式为 $c=(m+k)\\bmod 26$。完美保密性要求对于所有的 $m,c$，都有 $P(M=m\\mid C=c)=P(M=m)$。根据贝叶斯法则，\n$$\nP(M=m\\mid C=c)=\\frac{P(C=c\\mid M=m)P(M=m)}{P(C=c)}.\n$$\n因此，对于所有 $P(M=m)>0$ 的 $m$，完美保密性意味着\n$$\nP(C=c\\mid M=m)=P(C=c)\\quad\\text{for all }m,c.\n$$\n给定 $M=m$，当且仅当 $K=(c-m)\\bmod 26$ 时，密文 $C$ 等于 $c$，所以\n$$\nP(C=c\\mid M=m)=P\\bigl(K=(c-m)\\bmod 26\\bigr).\n$$\n因此，完美保密性条件变为\n$$\nP\\bigl(K=(c-m)\\bmod 26\\bigr)=P(C=c)\\quad\\text{for all }m,c.\n$$\n固定任意 $c$，取两个明文 $m$ 和 $m'$，则有\n$$\nP\\bigl(K=(c-m)\\bmod 26\\bigr)=P\\bigl(K=(c-m')\\bmod 26\\bigr).\n$$\n因为对于固定的 $c$，集合 $\\{(c-m)\\bmod 26:m\\in\\mathcal{S}\\}$ 等于集合 $\\mathcal{S}$，所以对于所有的 $k\\in\\mathcal{S}$，$P(K=k)$ 都是同一个常数。设这个常数为 $q$。利用 $\\sum_{k=0}^{25}P(K=k)=1$ 可得 $26q=1$，因此 $q=\\frac{1}{26}$。因此\n$$\nP(K=k)=\\frac{1}{26}\\quad\\text{for all }k\\in\\mathcal{S}.\n$$\n此选择可得，对于所有 $m,c$ 都有 $P(C=c\\mid M=m)=\\frac{1}{26}$，所以 $P(M=m\\mid C=c)=P(M=m)$，从而对于任何满足 $p_m>0$ 的 $\\{p_m\\}$ 均实现了完美保密性。", "answer": "$$\\boxed{\\frac{1}{26}}$$", "id": "1657898"}, {"introduction": "完美保密性是一个非常严格的条件，即使对安全设计的微小偏离也可能导致彻底的失败。本练习提出了一个与理论上安全的一次性密码本非常相似的密码系统，但它包含一个单一、微妙的改动。你的任务是采取一种对抗性的思维方式，分析这个看似无足轻重的变化如何造成致命的漏洞，从而加深你的理解：在密码学中，每一个细节都至关重要。[@problem_id:1657844]", "problem": "为设计一个安全的通信信道，一位工程师提出了一种新的加密方案，用于加密长度固定为 $L$ 的消息。消息空间 $\\mathcal{M}$、密钥空间 $\\mathcal{K}$ 和密文空间 $\\mathcal{C}$ 都是长度为 $L$ 的二进制字符串集合，即 $\\{0,1\\}^L$。\n\n密钥 $K$ 总是从 $\\mathcal{K}$ 中均匀随机选取，并且与消息 $M$ 统计独立。消息的分布满足以下条件：发送全零消息 $m_0 = (0, 0, \\dots, 0)$ 的概率非零，即 $P(M=m_0) > 0$，同时也小于一，即 $P(M=m_0) < 1$。\n\n所提出的加密规则是标准一次性密码本的一个修改版：\n1. 如果消息 $M$ 是全零字符串 $m_0$，则无论选择什么密钥 $K$，生成的密文 $C$ 也是全零字符串 $m_0$。\n2. 对于任何其他消息 $M \\neq m_0$，密文计算为 $C = M \\oplus K$，其中 $\\oplus$ 表示按位异或操作。\n\n这个加密系统是否提供完全保密性？\n\nA. 是的，该系统在所有条件下都提供完全保密性。\n\nB. 不，该系统不提供完全保密性。\n\nC. 该系统提供完全保密性，当且仅当消息在所有非零消息上呈均匀分布。\n\nD. 如果不知道 $P(M=m_0)$ 的确切值，则无法确定该系统的安全性。", "solution": "令 $\\mathcal{M}=\\mathcal{K}=\\mathcal{C}=\\{0,1\\}^{L}$，并令 $m_{0}$ 表示全零字符串。令 $p_{0}=P(M=m_{0})$，其中 $0<p_{0}<1$。完全保密性要求对于所有 $m\\in\\mathcal{M}$ 和所有满足 $P(C=c)>0$ 的 $c\\in\\mathcal{C}$，都有\n$$\nP(M=m\\mid C=c)=P(M=m).\n$$\n\n我们计算在所提出的方案下，给定 $M$ 时 $C$ 的条件分布。\n- 如果 $M=m_{0}$，根据规则 1可得\n$$\nP(C=c\\mid M=m_{0})=\\begin{cases}\n1, & c=m_{0},\\\\\n0, & c\\neq m_{0}.\n\\end{cases}\n$$\n- 如果 $M\\neq m_{0}$，根据规则 2，$C=M\\oplus K$，其中 $K$ 在 $\\{0,1\\}^{L}$ 上均匀分布且独立，因此 $C$ 在 $\\{0,1\\}^{L}$ 上均匀分布：\n$$\nP(C=c\\mid M=m)=2^{-L}\\quad\\text{对于所有 }c\\in\\{0,1\\}^{L}.\n$$\n\n使用全概率公式，对于任何 $c\\in\\{0,1\\}^{L}$，\n$$\nP(C=c)=P(C=c\\mid M=m_{0})P(M=m_{0})+\\sum_{m\\neq m_{0}}P(C=c\\mid M=m)P(M=m).\n$$\n因此，\n$$\nP(C=m_{0})=p_{0}+(1-p_{0})2^{-L},\n$$\n对于任何 $c\\neq m_{0}$，\n$$\nP(C=c)=(1-p_{0})2^{-L}.\n$$\n由于 $0<p_{0}<1$，我们有对于所有 $c$ 都有 $P(C=c)>0$。\n\n现在计算 $P(M=m_{0}\\mid C=c)$。\n- 对于任何 $c\\neq m_{0}$，\n$$\nP(M=m_{0}\\mid C=c)=\\frac{P(C=c\\mid M=m_{0})P(M=m_{0})}{P(C=c)}=\\frac{0\\cdot p_{0}}{(1-p_{0})2^{-L}}=0.\n$$\n因为 $p_{0}>0$，这得到 $P(M=m_{0}\\mid C=c)=0\\neq p_{0}$，违反了完全保密性条件。\n\n为完整起见，对于 $c=m_{0}$，\n$$\nP(M=m_{0}\\mid C=m_{0})=\\frac{1\\cdot p_{0}}{p_{0}+(1-p_{0})2^{-L}}.\n$$\n该表达式等于 $p_{0}$ 当且仅当 $p_{0}=0$ 或 $p_{0}=1$，这与 $0<p_{0}<1$ 的条件相矛盾。\n\n因此，对于任何 $0<p_{0}<1$ 的情况，该方案都不提供完全保密性，这与 $p_{0}$ 的确切值无关，也与非零消息上的分布无关。", "answer": "$$\\boxed{B}$$", "id": "1657844"}]}