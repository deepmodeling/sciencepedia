{"hands_on_practices": [{"introduction": "在进行隐私放大之前，我们首先必须掌握如何量化初始密钥中存在的“不确定性”或“随机性”。最小熵（min-entropy）是衡量这种最坏情况下不可预测性的黄金标准。这个练习提供了一个直接的、动手计算最小熵的机会，通过分析一个存在明显结构缺陷的密钥源，帮助你建立关于数据依赖性如何削弱随机性的直观理解 [@problem_id:1647791]。", "problem": "一个密码学协议依赖于一个能生成 $n$ 位密钥的源，其中 $n$ 是一个正偶数。实现中的一个缺陷导致密钥生成过程的行为如下：一个长度为 $n/2$ 的比特串被均匀随机地选择，该比特串构成密钥的前半部分。然后，密钥的后半部分被设置为前半部分的一个精确副本。所得到的 $n$ 位密钥由随机变量 $X$ 表示。\n\n一个离散随机变量 $Y$ 的最小熵定义为 $H_{\\infty}(Y) = -\\log_{2}(\\max_{y} P(Y=y))$，其中最大化是在变量 $Y$ 的所有可能取值 $y$ 上进行的。该度量是衡量攻击者单次猜测成功概率的一个关键指标。\n\n计算随机变量 $X$ 的最小熵。将您的答案以比特为单位表示为 $n$ 的函数。", "solution": "设 $n$ 为一个正偶数。该过程从 $\\{0,1\\}^{n/2}$ 中均匀随机地选择一个长度为 $n/2$ 的字符串 $w$，并输出 $n$ 位字符串 $X = ww$。因此，$X$ 的支撑集是集合\n$$\nS = \\{ ww : w \\in \\{0,1\\}^{n/2} \\},\n$$\n其基数为\n$$\n|S| = 2^{n/2}.\n$$\n由于 $w$ 是均匀选择的，并被确定性地映射到 $ww$，所以 $X$ 在 $S$ 上是均匀分布的。因此，对于任何 $x \\in S$，\n$$\nP(X = x) = \\frac{1}{2^{n/2}},\n$$\n且对于任何 $x \\notin S$，$P(X = x) = 0$。因此，任何取值的最大概率为\n$$\n\\max_{x} P(X = x) = \\frac{1}{2^{n/2}}.\n$$\n根据最小熵的定义，\n$$\nH_{\\infty}(X) = -\\log_{2}\\!\\left( \\max_{x} P(X = x) \\right) = -\\log_{2}\\!\\left( 2^{-n/2} \\right) = \\frac{n}{2}.\n$$\n因此，$X$ 的最小熵为 $\\frac{n}{2}$ 比特。", "answer": "$$\\boxed{\\frac{n}{2}}$$", "id": "1647791"}, {"introduction": "一旦我们能够量化原始密钥的最小熵 $k$，我们就可以将剩余哈希引理（Leftover Hash Lemma）作为一个强大的工程工具来使用。这个问题模拟了一个现实世界中的设计场景：一位密码学工程师需要确定原始密钥源必须满足的最低随机性要求，以生成一个具有特定安全级别的最终密钥。通过解决这个问题，你将亲身体验到在隐私放大过程中，输入不确定性 $k$、输出密钥长度 $m$ 和安全参数 $\\epsilon$ 之间是如何权衡的 [@problem_id:1647754]。", "problem": "一位密码学工程师的任务是为一个安全通信系统设计隐私放大模块。该模块处理一个部分泄露的原始密钥，以生成一个更短、高度安全的最终密钥。原始密钥表示为随机变量 $X$，其初始不确定性由它的最小熵 $k$ 量化，单位为比特。\n\n系统使用一个随机选择的全域哈希函数将原始密钥转换为长度为 $m$ 的最终密钥。这个最终密钥的安全性由参数 $\\epsilon$ 保证，它表示该密钥与一个真正随机的字符串之间的统计可区分性。$\\epsilon$ 的值越小，表示密钥越安全。所选隐私放大协议的理论安全保证由以下不等式给出：\n$$ \\epsilon \\le \\frac{1}{2} 2^{(m-k)/2} $$\n系统必须生成一个长度为 $m=64$ 比特的最终密钥。为了使其预期应用在密码学上是安全的，安全参数必须满足条件 $\\epsilon \\le 2^{-20}$。\n\n为确保系统设计正确，请确定为满足这些安全性和输出长度要求，原始密钥所必须具备的最小熵 $k$ 的最小整数值。", "solution": "我们已知，一个使用全域哈希函数的隐私放大协议保证：\n$$ \\epsilon \\le \\frac{1}{2} 2^{(m - k)/2}. $$\n为确保最终密钥在输出长度 $m = 64$ 时满足设计要求 $\\epsilon \\le 2^{-20}$，我们只需使其上界至多为 $2^{-20}$：\n$$ \\frac{1}{2} 2^{(64 - k)/2} \\le 2^{-20}. $$\n不等式两边均为正数，且 $\\log_{2}$ 是一个严格递增函数，所以我们对两边取以 2 为底的对数：\n$$ \\log_{2}\\!\\left(\\frac{1}{2} 2^{(64 - k)/2}\\right) \\le \\log_{2}\\!\\left(2^{-20}\\right). $$\n计算两边可得：\n$$ -1 + \\frac{64 - k}{2} \\le -20. $$\n逐步整理：\n$$ \\frac{64 - k}{2} \\le -19, $$\n$$ 64 - k \\le -38, $$\n$$ -k \\le -102, $$\n$$ k \\ge 102. $$\n由于 $k$ 必须是整数，满足该要求的最小整数值为 $k = 102$。", "answer": "$$\\boxed{102}$$", "id": "1647754"}, {"introduction": "这个高级练习旨在反映真实系统设计中可能出现的复杂性，它将我们的视野从单次应用隐私放大扩展到一个优化的多阶段协议。在这个假设场景中，为了平衡硬件和软件模块的处理负载，采用了两阶段的密钥生成流程。你的任务是找到最优的中间密钥长度，以最大限度地提高最终密钥的安全性。这个问题挑战你不仅仅是将剩余哈希引理作为一个公式来应用，而是将其作为更大优化问题中的一个构建模块，最终揭示出一个惊人而优雅的设计原则 [@problem_id:1647785]。", "problem": "一个安全数据记录系统被设计用于从物理环境噪声中生成每日主密钥。一天中收集的原始数据形成一个比特串 $X$。由于可预测的环境模式和潜在的侧信道泄漏，假设攻击者拥有关于 $X$ 的部分知识。$X$ 中不可预测信息的量由其最小熵 $H_\\infty(X) = k$ 来量化。\n\n为生成安全密钥，该设备采用一个两阶段的隐私放大协议。这样做是为了平衡一个快速的专用硬件单元和一个更灵活的基于软件的密码学模块之间的处理负载。\n1.  在第一阶段，硬件单元将一个从公开的2-全域哈希函数族 $\\mathcal{H}_1$ 中均匀随机选择的哈希函数 $h_1$ 应用于原始数据 $X$。这会产生一个长度为 $m_1$ 的中间密钥 $S_1 = h_1(X)$。\n2.  在第二阶段，软件模块将另一个从公开的2-全域哈希函数族 $\\mathcal{H}_2$ 中均匀随机选择的哈希函数 $h_2$ 应用于中间密钥 $S_1$。这会产生一个长度固定为 $m_2$ 的最终主密钥 $S_2 = h_2(S_1)$。\n\n密钥的安全性由它与同等长度的完全均匀字符串之间的统计距离来量化，其中在同一集合 $\\mathcal{Z}$ 上的两个概率分布 $P$ 和 $Q$ 之间的统计距离定义为 $\\frac{1}{2} \\sum_{z \\in \\mathcal{Z}} |P(z) - Q(z)|$。剩余哈希引理为使用随机哈希函数时的该量提供了一个上界。对于一个最小熵为 $H_\\infty(Z) = k'$ 的源变量 $Z$，如果我们使用一个来自2-全域哈希函数族的哈希函数 $h$ 计算一个长度为 $m'$ 的密钥 $S=h(Z)$，其与均匀分布 $U_{m'}$ 的期望统计距离的上界如下：\n$$ \\mathbb{E}_{h} \\left[ \\text{distance}(S, U_{m'}) \\right] \\le \\frac{1}{2} 2^{-\\frac{1}{2}(k' - m')} $$\n设计目标是选择中间密钥长度 $m_1$，以最小化最终密钥 $S_2$ 与均匀分布 $U_{m_2}$ 之间期望统计距离的总上界。为进行此优化，你可以将密钥长度 $k$、$m_1$ 和 $m_2$ 视为满足 $k > m_1 > m_2$ 的连续正实数变量。求 $m_1$ 的最优值，并将其表示为关于 $k$ 和 $m_2$ 的表达式。", "solution": "设 $X$ 是原始比特串，其最小熵为 $H_{\\infty}(X)=k$。在阶段1，一个随机的 $h_{1}\\in\\mathcal{H}_{1}$（2-全域）输出长度为 $m_{1}$ 的 $S_{1}=h_{1}(X)$。在阶段2，一个随机的 $h_{2}\\in\\mathcal{H}_{2}$（2-全域）输出长度为 $m_{2}$ 的 $S_{2}=h_{2}(S_{1})$。我们通过混合论证/三角不等式来界定 $S_{2}$ 与 $U_{m_{2}}$ 之间期望统计距离的上界：\n$$\n\\text{distance}(S_{2},U_{m_{2}})\\le \\text{distance}\\big(h_{2}(S_{1}),h_{2}(U_{m_{1}})\\big)+\\text{distance}\\big(h_{2}(U_{m_{1}}),U_{m_{2}}\\big).\n$$\n对 $h_1$ 和 $h_2$ 的独立选择取期望，并使用数据处理不等式（统计距离在任何固定函数下都不会增加），我们得到\n$$\n\\mathbb{E}_{h_{1},h_{2}}\\big[\\text{distance}(S_{2},U_{m_{2}})\\big]\\le \\mathbb{E}_{h_{1}}\\big[\\text{distance}(S_{1},U_{m_{1}})\\big]+\\mathbb{E}_{h_{2}}\\big[\\text{distance}\\big(h_{2}(U_{m_{1}}),U_{m_{2}}\\big)\\big].\n$$\n对每一项应用剩余哈希引理：\n- 对于第一项，输入 $X$ 的最小熵为 $k$，输出长度为 $m_{1}$，所以\n$$\n\\mathbb{E}_{h_{1}}\\big[\\text{distance}(S_{1},U_{m_{1}})\\big]\\le \\frac{1}{2}\\,2^{-\\frac{1}{2}(k-m_{1})}.\n$$\n- 对于第二项，输入为 $U_{m_1}$，其最小熵为 $m_1$，输出长度为 $m_2$，所以\n$$\n\\mathbb{E}_{h_{2}}\\big[\\text{distance}\\big(h_{2}(U_{m_{1}}),U_{m_{2}}\\big)\\big]\\le \\frac{1}{2}\\,2^{-\\frac{1}{2}(m_{1}-m_{2})}.\n$$\n因此，总期望距离的一个上界是\n$$\nF(m_{1})=\\frac{1}{2}\\,2^{-\\frac{1}{2}(k-m_{1})}+\\frac{1}{2}\\,2^{-\\frac{1}{2}(m_{1}-m_{2})}.\n$$\n我们在约束条件 $k>m_{1}>m_{2}$ 下对 $m_1$ 最小化 $F(m_1)$。由于乘法因子 $\\frac{1}{2}$ 是常数，这等价于最小化\n$$\nG(m_{1})=2^{-\\frac{1}{2}(k-m_{1})}+2^{-\\frac{1}{2}(m_{1}-m_{2})}.\n$$\n使用 $\\frac{\\mathrm{d}}{\\mathrm{d}x}2^{ax}=(\\ln 2)\\,a\\,2^{ax}$ 进行求导：\n$$\n\\frac{\\mathrm{d}G}{\\mathrm{d}m_{1}}=\\frac{1}{2}\\ln 2\\,2^{-\\frac{1}{2}(k-m_{1})}-\\frac{1}{2}\\ln 2\\,2^{-\\frac{1}{2}(m_{1}-m_{2})}.\n$$\n令导数为零：\n$$\n2^{-\\frac{1}{2}(k-m_{1})}=2^{-\\frac{1}{2}(m_{1}-m_{2})}\\;\\;\\Longrightarrow\\;\\;k-m_{1}=m_{1}-m_{2}\\;\\;\\Longrightarrow\\;\\;m_{1}=\\frac{k+m_{2}}{2}.\n$$\n二阶导数满足\n$$\n\\frac{\\mathrm{d}^{2}G}{\\mathrm{d}m_{1}^{2}}=\\frac{(\\ln 2)^{2}}{4}\\left(2^{-\\frac{1}{2}(k-m_{1})}+2^{-\\frac{1}{2}(m_{1}-m_{2})}\\right)>0,\n$$\n因此这个临界点是唯一的全局最小值点。由于 $k>m_{2}$，我们有 $m_{2}<\\frac{k+m_{2}}{2}<k$，这符合约束条件 $k>m_{1}>m_{2}$。\n\n因此，最优的中间密钥长度为 $m_{1}^{\\ast}=\\frac{k+m_{2}}{2}$。", "answer": "$$\\boxed{\\frac{k+m_{2}}{2}}$$", "id": "1647785"}]}