{"hands_on_practices": [{"introduction": "要真正掌握交叉熵，我们首先从一个基础计算开始。这个练习使用一个常见的六面骰子作为例子，来量化真实、均匀的概率分布与一个有缺陷的模型之间的“距离”。通过亲手计算交叉熵，你将具体理解这个指标是如何衡量一个模型的预测效率的。[@problem_id:1615181]", "problem": "一位信息理论家正在分析一个关于标准六面骰子游戏的简化模型，其可能的结果来自集合 $\\{1, 2, 3, 4, 5, 6\\}$。已知该骰子是完全公平的，这意味着六个结果中的每一个出现的概率都相等。这是真实的概率分布，我们称之为 $P$。\n\n一位经验不足的分析师提出了一个简化模型，该模型基于一个错误的假设，即骰子是有偏差的。该模型的概率分布，我们称之为 $Q$，假设掷出偶数的概率恰好是掷出奇数概率的两倍。\n\n计算交叉熵 $H(P, Q)$，它衡量使用为分布 $Q$ 设计的最优编码来编码来自分布 $P$ 的消息所需的平均比特数。请以比特为单位表示你的最终答案，并四舍五入到四位有效数字。", "solution": "设 $P$ 为公平骰子的真实分布：对于每个 $x \\in \\{1,2,3,4,5,6\\}$，$P(x) = \\frac{1}{6}$。所提出的模型 $Q$ 假设偶数结果的总概率是奇数结果的两倍。设每个奇数点数面的概率为 $q_{o}$，每个偶数点数面的概率为 $q_{e}$。那么\n$$3q_{e} = 2(3q_{o}) \\quad \\Rightarrow \\quad q_{e} = 2q_{o},$$\n且归一化可得\n$$3q_{e} + 3q_{o} = 1 \\quad \\Rightarrow \\quad 3(2q_{o}) + 3q_{o} = 1 \\quad \\Rightarrow \\quad 9q_{o} = 1 \\quad \\Rightarrow \\quad q_{o} = \\frac{1}{9}, \\quad q_{e} = \\frac{2}{9}.$$\n\n交叉熵（以比特为单位）定义为\n$$H(P,Q) = -\\sum_{x} P(x)\\,\\log_{2} Q(x).$$\n将结果分为三个奇数和三个偶数，并使用 $P(x) = \\frac{1}{6}$，\n$$H(P,Q) = -\\frac{1}{6}\\left[3\\log_{2}\\!\\left(\\frac{1}{9}\\right) + 3\\log_{2}\\!\\left(\\frac{2}{9}\\right)\\right] = -\\frac{1}{2}\\left[\\log_{2}\\!\\left(\\frac{1}{9}\\right) + \\log_{2}\\!\\left(\\frac{2}{9}\\right)\\right].$$\n使用 $\\log_{2}(ab) = \\log_{2}a + \\log_{2}b$，\n$$H(P,Q) = -\\frac{1}{2}\\log_{2}\\!\\left(\\frac{2}{81}\\right) = \\frac{1}{2}\\log_{2}\\!\\left(\\frac{81}{2}\\right).$$\n因为 $81 = 3^{4}$，\n$$H(P,Q) = \\frac{1}{2}\\left(\\log_{2}81 - \\log_{2}2\\right) = \\frac{1}{2}\\left(4\\log_{2}3 - 1\\right).$$\n数值上，$\\log_{2}3 \\approx 1.5849625007$，所以\n$$H(P,Q) \\approx \\frac{1}{2}\\left(4 \\times 1.5849625007 - 1\\right) \\approx \\frac{1}{2}\\left(6.3398500028 - 1\\right) \\approx \\frac{1}{2}\\times 5.3398500028 \\approx 2.6699250014.$$\n四舍五入到四位有效数字，结果为 $2.670$ 比特。", "answer": "$$\\boxed{2.670}$$", "id": "1615181"}, {"introduction": "交叉熵在惩罚那些过于自信且错误的模型时尤其有效。在此实践中，我们将探讨一个极端情况：一个确定性模型对可能发生的事件赋予了零概率。这个练习将揭示交叉熵的一个关键数学特性，并阐明为何它在机器学习中是一个如此高效的损失函数。[@problem_id:1615201]", "problem": "一位数据科学家正在评估两个用于预测某特定城市天气的计算模型。可能的天气结果集合是{晴天, 多云, 雨天}。根据大量的历史数据，这些结果的真实概率分布 $P$ 已知：\n- $P(\\text{晴天}) = 0.5$\n- $P(\\text{多云}) = 0.3$\n- $P(\\text{雨天}) = 0.2$\n\n第一个模型，模型A，是一个概率预测器，它为第二天的天气提供了其自身的概率分布 $Q_A$：\n- $Q_A(\\text{晴天}) = 0.7$\n- $Q_A(\\text{多云}) = 0.2$\n- $Q_A(\\text{雨天}) = 0.1$\n\n第二个模型，模型B，是一个简单的确定性模型，它总是预测“晴天”。因此，其预测的概率分布 $Q_B$ 为：\n- $Q_B(\\text{晴天}) = 1$\n- $Q_B(\\text{多云}) = 0$\n- $Q_B(\\text{雨天}) = 0$\n\n为了评估每个模型的预测与真实分布的吻合程度，该数据科学家计算了以比特（bits）为单位的交叉熵 $H(P, Q)$。交叉熵的公式为 $H(P, Q) = -\\sum_{x} P(x) \\log_2(Q(x))$，其中总和是遍历所有可能的结果 $x$。\n\n确定模型A相对于真实分布的交叉熵 $H(P, Q_A)$，以及模型B相对于真实分布的交叉熵 $H(P, Q_B)$。选择正确报告了这两个值的选项。\n\nA. $H(P, Q_A) = 1.485$；$H(P, Q_B) = 0$\n\nB. $H(P, Q_A) = 1.122$；$H(P, Q_B)$ 未定义\n\nC. $H(P, Q_A) = 1.618$；$H(P, Q_B)$ 为无穷大\n\nD. $H(P, Q_A) = 1.618$；$H(P, Q_B) = 0$\n\nE. $H(P, Q_A) = 1.280$；$H(P, Q_B)$ 为无穷大", "solution": "我们使用以比特为单位的交叉熵定义：\n$$H(P,Q)=-\\sum_{x}P(x)\\log_{2}\\bigl(Q(x)\\bigr).$$\n\n对于模型A，\n$$H(P,Q_{A})=-\\Bigl[0.5\\,\\log_{2}(0.7)+0.3\\,\\log_{2}(0.2)+0.2\\,\\log_{2}(0.1)\\Bigr].$$\n使用换底公式 $\\log_{2}(x)=\\frac{\\ln x}{\\ln 2}$ 来获得数值：\n$$\\log_{2}(0.7)\\approx-0.5145731728,\\quad \\log_{2}(0.2)=-2.3219280949,\\quad \\log_{2}(0.1)=-3.3219280949.$$\n因此，\n$$0.5\\,\\log_{2}(0.7)\\approx-0.2572865864,\\quad 0.3\\,\\log_{2}(0.2)\\approx-0.6965784285,\\quad 0.2\\,\\log_{2}(0.1)\\approx-0.6643856190,$$\n所以括号内的和约等于 $-1.6182506339$，因此\n$$H(P,Q_{A})\\approx 1.6182506339\\ \\text{比特}\\approx 1.618.$$\n\n对于模型B，\n$$H(P,Q_{B})=-\\Bigl[0.5\\,\\log_{2}(1)+0.3\\,\\log_{2}(0)+0.2\\,\\log_{2}(0)\\Bigr].$$\n由于 $\\log_{2}(1)=0$ 且 $\\log_{2}(0)=-\\infty$，且权重 $0.3$ 和 $0.2$ 为正，交叉熵发散：\n$$H(P,Q_{B})=+\\infty.$$\n\n因此，正确的选项是报告 $H(P,Q_{A})=1.618$ 且 $H(P,Q_{B})$ 为无穷大的那一个，也就是选项C。", "answer": "$$\\boxed{C}$$", "id": "1615201"}, {"introduction": "除了简单地评估模型，交叉熵更是一个用于模型优化的强大目标函数。这个练习将交叉熵从一个评估指标提升为一个学习工具，你将通过最小化模型相对于真实分布的交叉熵，来为一个简单的参数化模型找到最优参数。这一实践直接模拟了机器学习中训练分类模型的核心过程。[@problem_id:1615207]", "problem": "在高能物理领域，机器学习模型常用于对探测器记录的事件进行分类。考虑一个简化场景：某粒子对撞机实验产生的事件可归为三个不同类别之一：类别1、类别2或类别3。根据一个成熟的理论框架，一个事件属于每个类别的真实概率分布 $P$ 由 $P = (p_1, p_2, p_3) = (1/2, 1/3, 1/6)$ 给出。\n\n一位数据科学家提出了一个新的、计算成本低廉的模型 $Q_\\theta$ 来近似这个真实分布。该模型的概率依赖于单个可调参数 $\\theta$，并由 $Q_\\theta = (q_1(\\theta), q_2(\\theta), q_3(\\theta)) = (\\theta, 1 - 2\\theta, \\theta)$ 给出。为了使 $Q_\\theta$ 表示一个有效的概率分布，参数 $\\theta$ 的取值范围必须是 $[0, 1/2]$。\n\n为了找到该模型的最佳版本，该科学家决定通过最小化真实分布 $P$ 和模型分布 $Q_\\theta$ 之间的交叉熵 $H(P, Q_\\theta)$ 来调整参数 $\\theta$。交叉熵是衡量当使用为分布 $Q_\\theta$ 优化的编码时，对来自 $P$ 的事件进行编码所需的平均比特数。\n\n确定使交叉熵 $H(P, Q_\\theta)$ 最小化的参数 $\\theta$ 的精确值。请将您的答案表示为分数。", "solution": "以比特为单位的交叉熵定义为\n$$H_{2}(P,Q_{\\theta})=-\\sum_{i=1}^{3}p_{i}\\log_{2}q_{i}.$$\n由于 $\\log_{2}x=\\ln x/\\ln 2$，对 $\\theta$ 最小化 $H_{2}(P,Q_{\\theta})$ 等价于最小化\n$$F(\\theta)=-\\sum_{i=1}^{3}p_{i}\\ln q_{i}.$$\n当 $P=(\\frac{1}{2},\\frac{1}{3},\\frac{1}{6})$ 且 $Q_{\\theta}=(\\theta,1-2\\theta,\\theta)$，对于 $\\theta\\in[0,\\frac{1}{2}]$，我们有\n$$F(\\theta)=-\\left(\\frac{1}{2}\\ln\\theta+\\frac{1}{3}\\ln(1-2\\theta)+\\frac{1}{6}\\ln\\theta\\right)=-\\left(\\frac{2}{3}\\ln\\theta+\\frac{1}{3}\\ln(1-2\\theta)\\right).$$\n在开区间 $(0,\\frac{1}{2})$ 上求导：\n$$F'(\\theta)=-\\left(\\frac{2}{3}\\frac{1}{\\theta}+\\frac{1}{3}\\cdot\\frac{-2}{1-2\\theta}\\right)=-\\frac{2}{3}\\left(\\frac{1}{\\theta}-\\frac{1}{1-2\\theta}\\right).$$\n令 $F'(\\theta)=0$ 以求驻点：\n$$\\frac{1}{\\theta}-\\frac{1}{1-2\\theta}=0\\;\\;\\Longrightarrow\\;\\;\\frac{1}{\\theta}=\\frac{1}{1-2\\theta}\\;\\;\\Longrightarrow\\;\\;1-2\\theta=\\theta\\;\\;\\Longrightarrow\\;\\;\\theta=\\frac{1}{3}.$$\n计算二阶导数以确认是最小值点：\n$$F''(\\theta)=-\\frac{2}{3}\\left(-\\frac{1}{\\theta^{2}}-\\frac{2}{(1-2\\theta)^{2}}\\right)=\\frac{2}{3}\\left(\\frac{1}{\\theta^{2}}+\\frac{2}{(1-2\\theta)^{2}}\\right)>0,$$\n因此 $F$ 在 $(0,\\frac{1}{2})$ 上是严格凸的，该驻点是唯一的全局最小值点。端点 $\\theta=0$ 和 $\\theta=\\frac{1}{2}$ 不是有效的最小化点，因为当 $\\theta\\to 0^{+}$ 或 $\\theta\\to(\\frac{1}{2})^{-}$ 时，由于 $\\ln 0$ 项的存在，有 $F(\\theta)\\to+\\infty$。因此，在 $[0,\\frac{1}{2}]$ 上的最小值点是\n$$\\theta^{\\ast}=\\frac{1}{3}.$$", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1615207"}]}