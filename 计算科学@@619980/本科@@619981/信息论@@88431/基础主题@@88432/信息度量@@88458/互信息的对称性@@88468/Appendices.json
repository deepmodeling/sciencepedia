{"hands_on_practices": [{"introduction": "在社会学或市场研究等许多实践领域，我们经常通过分析数据来揭示不同变量之间的关系。互信息为量化这种统计依赖性提供了一个强有力的工具。第一个练习 [@problem_id:1662184] 将引导你走过直接从一个联合概率分布计算互信息的全过程，正如在真实世界的研究中可能遇到的那样。这是一项将抽象理论与具体数据分析联系起来的基础技能。", "problem": "一项社会学研究调查了特定人群中个人最高教育水平与其年收入等级之间的统计关系。设 $E$ 是一个代表教育水平的离散随机变量，其结果 $\\{e_1, e_2, e_3\\}$ 分别对应于“高中及以下”、“学士学位”和“研究生学位”。设 $I$ 是一个代表收入等级的离散随机变量，其结果 $\\{i_1, i_2, i_3\\}$ 分别对应于“低”、“中”和“高”。\n\n根据广泛的调查数据，这两个变量的联合概率质量函数 $P(I=i, E=e)$ 如下：\n\n$P(I=i_1, E=e_1) = 0.20$\n$P(I=i_1, E=e_2) = 0.10$\n$P(I=i_1, E=e_3) = 0.02$\n\n$P(I=i_2, E=e_1) = 0.15$\n$P(I=i_2, E=e_2) = 0.20$\n$P(I=i_2, E=e_3) = 0.10$\n\n$P(I=i_3, E=e_1) = 0.05$\n$P(I=i_3, E=e_2) = 0.10$\n$P(I=i_3, E=e_3) = 0.08$\n\n计算这两个变量之间的互信息 $I(I; E)$ 的值。所有对数均以2为底。答案以比特（bits）表示，并四舍五入到四位有效数字。", "solution": "给定联合pmf值 $P(I=i_{k},E=e_{j})$，其中 $k,j\\in\\{1,2,3\\}$。首先，通过对另一个变量的联合概率求和来计算边缘概率：\n$$\nP(I=i_{1})=0.20+0.10+0.02=0.32,\\quad P(I=i_{2})=0.15+0.20+0.10=0.45,\\quad P(I=i_{3})=0.05+0.10+0.08=0.23,\n$$\n$$\nP(E=e_{1})=0.20+0.15+0.05=0.40,\\quad P(E=e_{2})=0.10+0.20+0.10=0.40,\\quad P(E=e_{3})=0.02+0.10+0.08=0.20.\n$$\n根据定义，以比特为单位的互信息为\n$$\nI(I;E)=\\sum_{k=1}^{3}\\sum_{j=1}^{3} P(I=i_{k},E=e_{j})\\,\\log_{2}\\!\\left(\\frac{P(I=i_{k},E=e_{j})}{P(I=i_{k})\\,P(E=e_{j})}\\right).\n$$\n计算每个贡献项 $c_{kj}=P(i_{k},e_{j})\\log_{2}\\!\\big(P(i_{k},e_{j})/[P(i_{k})P(e_{j})]\\big)$：\n\n对于 $i_{1}$：\n- $(i_{1},e_{1})$: $p=0.20$，分母 $0.32\\cdot 0.40=0.128$，比率 $0.20/0.128=25/16$，所以\n$$\nc_{11}=0.20\\log_{2}\\!\\left(\\frac{25}{16}\\right)=0.20\\cdot 0.6438561897747247\\approx 0.1287712379549449.\n$$\n- $(i_{1},e_{2})$: $p=0.10$，分母 $0.128$，比率 $0.10/0.128=25/32$，所以\n$$\nc_{12}=0.10\\log_{2}\\!\\left(\\frac{25}{32}\\right)=0.10\\cdot(-0.3561438102252753)\\approx -0.0356143810225275.\n$$\n- $(i_{1},e_{3})$: $p=0.02$，分母 $0.32\\cdot 0.20=0.064$，比率 $0.02/0.064=5/16$，所以\n$$\nc_{13}=0.02\\log_{2}\\!\\left(\\frac{5}{16}\\right)=0.02\\cdot(-1.6780719051126376)\\approx -0.0335614381022528.\n$$\n$i_{1}$ 的行和：\n$$\nc_{11}+c_{12}+c_{13}\\approx 0.0595954188301647.\n$$\n\n对于 $i_{2}$：\n- $(i_{2},e_{1})$: $p=0.15$，分母 $0.45\\cdot 0.40=0.18$，比率 $0.15/0.18=5/6$，所以\n$$\nc_{21}=0.15\\log_{2}\\!\\left(\\frac{5}{6}\\right)=0.15\\cdot(-0.2630344058337938)\\approx -0.0394551608750691.\n$$\n- $(i_{2},e_{2})$: $p=0.20$，分母 $0.18$，比率 $0.20/0.18=10/9$，所以\n$$\nc_{22}=0.20\\log_{2}\\!\\left(\\frac{10}{9}\\right)=0.20\\cdot 0.1520030934450500\\approx 0.0304006186890100.\n$$\n- $(i_{2},e_{3})$: $p=0.10$，分母 $0.45\\cdot 0.20=0.09$，比率 $0.10/0.09=10/9$，所以\n$$\nc_{23}=0.10\\log_{2}\\!\\left(\\frac{10}{9}\\right)=0.10\\cdot 0.1520030934450500\\approx 0.0152003093445050.\n$$\n$i_{2}$ 的行和：\n$$\nc_{21}+c_{22}+c_{23}\\approx 0.0061457671584459.\n$$\n\n对于 $i_{3}$：\n- $(i_{3},e_{1})$: $p=0.05$，分母 $0.23\\cdot 0.40=0.092$，比率 $0.05/0.092=25/46$，所以\n$$\nc_{31}=0.05\\log_{2}\\!\\left(\\frac{25}{46}\\right)\\approx 0.05\\cdot(-0.8797057662822882)\\approx -0.0439852883141144.\n$$\n- $(i_{3},e_{2})$: $p=0.10$，分母 $0.092$，比率 $0.10/0.092=25/23$，所以\n$$\nc_{32}=0.10\\log_{2}\\!\\left(\\frac{25}{23}\\right)\\approx 0.10\\cdot 0.1202942337177110\\approx 0.0120294233717711.\n$$\n- $(i_{3},e_{3})$: $p=0.08$，分母 $0.23\\cdot 0.20=0.046$，比率 $0.08/0.046=40/23$，所以\n$$\nc_{33}=0.08\\log_{2}\\!\\left(\\frac{40}{23}\\right)\\approx 0.08\\cdot 0.7983661388303490\\approx 0.0638692911064279.\n$$\n$i_{3}$ 的行和：\n$$\nc_{31}+c_{32}+c_{33}\\approx 0.0319134261640846.\n$$\n\n最后，将所有贡献项相加，得到以比特为单位的互信息：\n$$\nI(I;E)\\approx 0.0595954188301647+0.0061457671584459+0.0319134261640846=0.0976546121526952.\n$$\n四舍五入到四位有效数字，此值为 $0.09765$ 比特。", "answer": "$$\\boxed{0.09765}$$", "id": "1662184"}, {"introduction": "除了基本公式，将互信息理解为“不确定性的减少量”通常更为直观。这个练习 [@problem_id:1662202] 使用了一个简单明了的场景——从牌堆中抽牌——来阐释这一概念。通过将互信息计算为一个事件的初始不确定性与在另一个事件已知后其剩余不确定性之间的差值，我们可以更深刻地理解 $I(X;Y)$ 究竟衡量了什么。", "problem": "一副标准扑克牌包含四种花色：黑桃（S）、红心（H）、方块（D）和梅花（C）。考虑一副特殊的、简化的牌组，仅包含四张牌：黑桃A、红心A、方块A和梅花A。从这副牌中，不放回地依次抽取两张牌。\n\n令随机变量 $S_1$ 表示抽出的第一张牌的花色，令 $S_2$ 表示抽出的第二张牌的花色。$S_1$ 和 $S_2$ 的可能结果都来自集合 {S, H, D, C}。\n\n计算随机变量 $S_1$ 和 $S_2$ 之间的互信息 $I(S_1; S_2)$。使用以 2 为底的对数。你的最终答案以比特为单位表示，并四舍五入到三位有效数字。", "solution": "我们对从一副包含每种花色各一张牌的牌组中不放回地依次抽取两张牌进行建模。具有不同元素的花色有序对构成了样本空间；共有 $4 \\times 3$ 个这样的有序结果，每个结果的概率为 $1/(4 \\times 3)$。\n\n根据对称性，$S_{1}$ 和 $S_{2}$ 都在 $\\{S,H,D,C\\}$ 上均匀分布。因此，\n$$\nH(S_{2})=-\\sum_{s \\in \\{S,H,D,C\\}} \\frac{1}{4} \\log_{2}\\!\\left(\\frac{1}{4}\\right)=\\log_{2}(4)=2.\n$$\n给定 $S_{1}=a$，第二次抽取的 $S_{2}$ 在不等于 $a$ 的三种花色上均匀分布，所以\n$$\nH(S_{2}\\,|\\,S_{1}=a)=-\\sum_{b \\neq a} \\frac{1}{3} \\log_{2}\\!\\left(\\frac{1}{3}\\right)=\\log_{2}(3).\n$$\n对 $S_{1}$ 求平均，\n$$\nH(S_{2}\\,|\\,S_{1})=\\sum_{a} P(S_{1}=a)\\,H(S_{2}\\,|\\,S_{1}=a)=\\log_{2}(3).\n$$\n互信息是\n$$\nI(S_{1};S_{2})=H(S_{2})-H(S_{2}\\,|\\,S_{1})=2-\\log_{2}(3).\n$$\n使用以 2 为底的对数，并四舍五入到三位有效数字，结果等于 $0.415$ 比特。", "answer": "$$\\boxed{0.415}$$", "id": "1662202"}, {"introduction": "互信息的对称性，即 $I(X;Y) = I(Y;X)$，是一个核心定理，但其正确性并非总是显而易见的，特别是当 $X$ 和 $Y$ 之间的关系不对称时。这个问题 [@problem_id:1662217] 展示了一个变量是另一个变量的确定性但不可逆函数的情况。你将亲手验证，虽然在已知 $X$ 的情况下 $Y$ 的不确定性为零，但在已知 $Y$ 的情况下 $X$ 的不确定性却不为零，然而从两个角度计算出的互信息是完全相同的。这个练习将巩固你对对称性的理解，即它是信息的基本定律，独立于变量之间的因果或函数关系。", "problem": "考虑一个离散随机变量 $X$，它在整数集合 $\\mathcal{X} = \\{-3, -2, -1, 0, 1, 2, 3\\}$ 上均匀分布。第二个随机变量 $Y$ 由 $X$ 根据确定性函数 $Y = f(X)$ 生成，其中 $f(X) = X \\pmod 3$。模运算定义为 $a \\pmod n = a - n \\lfloor a/n \\rfloor$，其中 $\\lfloor \\cdot \\rfloor$ 是向下取整函数。计算这两个变量之间的互信息 $I(X;Y)$。将您的答案表示为以 2 为底的对数的单个符号表达式。所有熵都应使用以 2 为底的对数计算（单位为比特）。", "solution": "互信息 $I(X;Y)$ 量化了因了解一个随机变量而导致的另一个随机变量不确定性的减少量。它是对称的，即 $I(X;Y) = I(Y;X)$。我们可以使用以下两个等价公式之一来计算它：\n1. $I(X;Y) = H(X) - H(X|Y)$\n2. $I(X;Y) = H(Y) - H(Y|X)$\n\n我们将使用第一个公式计算结果，然后使用第二个公式进行验证，以明确展示本例中的对称性。\n\n首先，我们来分析随机变量 $X$ 和 $Y$ 的性质。\n随机变量 $X$ 在集合 $\\mathcal{X} = \\{-3, -2, -1, 0, 1, 2, 3\\}$ 上均匀分布。该集合的大小为 $|\\mathcal{X}|=7$。对于所有 $x \\in \\mathcal{X}$，任何特定结果的概率为 $P(X=x) = \\frac{1}{7}$。\n\n随机变量 $Y$ 由 $Y = X \\pmod 3$ 定义。我们来求出 $Y$ 的可能取值（集合 $\\mathcal{Y}$）及其概率。\n- $X = -3 \\implies Y = -3 \\pmod 3 = 0$\n- $X = -2 \\implies Y = -2 \\pmod 3 = 1$\n- $X = -1 \\implies Y = -1 \\pmod 3 = 2$\n- $X = 0 \\implies Y = 0 \\pmod 3 = 0$\n- $X = 1 \\implies Y = 1 \\pmod 3 = 1$\n- $X = 2 \\implies Y = 2 \\pmod 3 = 2$\n- $X = 3 \\implies Y = 3 \\pmod 3 = 0$\n\n$Y$ 的样本空间为 $\\mathcal{Y} = \\{0, 1, 2\\}$。\n$Y$ 取值的概率为：\n- $P(Y=0) = P(X=-3) + P(X=0) + P(X=3) = \\frac{1}{7} + \\frac{1}{7} + \\frac{1}{7} = \\frac{3}{7}$。\n- $P(Y=1) = P(X=-2) + P(X=1) = \\frac{1}{7} + \\frac{1}{7} = \\frac{2}{7}$。\n- $P(Y=2) = P(X=-1) + P(X=2) = \\frac{1}{7} + \\frac{1}{7} = \\frac{2}{7}$。\n\n**使用 $I(X;Y) = H(X) - H(X|Y)$ 进行计算**\n\n首先，我们计算 $X$ 的熵，记为 $H(X)$。由于 $X$ 服从一个有 7 个可能结果的均匀分布：\n$$H(X) = -\\sum_{x \\in \\mathcal{X}} P(X=x) \\log_{2}(P(X=x)) = -7 \\times \\left(\\frac{1}{7} \\log_{2}\\left(\\frac{1}{7}\\right)\\right) = -\\log_{2}\\left(\\frac{1}{7}\\right) = \\log_{2}(7)$$\n\n接下来，我们计算条件熵 $H(X|Y)$，它是 $X$ 在给定 $Y$ 取值条件下的熵的期望值：\n$$H(X|Y) = \\sum_{y \\in \\mathcal{Y}} P(Y=y) H(X|Y=y)$$\n我们需要求出对于每个 $y$ 值的条件熵。\n- 对于 $Y=0$：$X$ 的可能取值是 $\\{-3, 0, 3\\}$。给定 $Y=0$，$X$ 在这 3 个值上均匀分布，因此对于 $x \\in \\{-3, 0, 3\\}$，$P(X=x|Y=0) = 1/3$。\n$$H(X|Y=0) = - \\sum_{x \\in \\{-3,0,3\\}} \\frac{1}{3}\\log_{2}\\left(\\frac{1}{3}\\right) = -3 \\times \\frac{1}{3}\\log_{2}\\left(\\frac{1}{3}\\right) = \\log_{2}(3)$$\n- 对于 $Y=1$：$X$ 的可能取值是 $\\{-2, 1\\}$。给定 $Y=1$，$X$ 在这 2 个值上均匀分布，因此对于 $x \\in \\{-2, 1\\}$，$P(X=x|Y=1) = 1/2$。\n$$H(X|Y=1) = - \\sum_{x \\in \\{-2,1\\}} \\frac{1}{2}\\log_{2}\\left(\\frac{1}{2}\\right) = -2 \\times \\frac{1}{2}\\log_{2}\\left(\\frac{1}{2}\\right) = \\log_{2}(2) = 1$$\n- 对于 $Y=2$：$X$ 的可能取值是 $\\{-1, 2\\}$。给定 $Y=2$，$X$ 在这 2 个值上均匀分布，因此对于 $x \\in \\{-1, 2\\}$，$P(X=x|Y=2) = 1/2$。\n$$H(X|Y=2) = - \\sum_{x \\in \\{-1,2\\}} \\frac{1}{2}\\log_{2}\\left(\\frac{1}{2}\\right) = -2 \\times \\frac{1}{2}\\log_{2}\\left(\\frac{1}{2}\\right) = \\log_{2}(2) = 1$$\n\n现在，我们计算总条件熵 $H(X|Y)$：\n$$H(X|Y) = P(Y=0)H(X|Y=0) + P(Y=1)H(X|Y=1) + P(Y=2)H(X|Y=2)$$\n$$H(X|Y) = \\left(\\frac{3}{7}\\right) \\log_{2}(3) + \\left(\\frac{2}{7}\\right) (1) + \\left(\\frac{2}{7}\\right) (1) = \\frac{3}{7}\\log_{2}(3) + \\frac{4}{7}$$\n\n最后，我们计算互信息：\n$$I(X;Y) = H(X) - H(X|Y) = \\log_{2}(7) - \\left( \\frac{3}{7}\\log_{2}(3) + \\frac{4}{7} \\right) = \\log_{2}(7) - \\frac{4}{7} - \\frac{3}{7}\\log_{2}(3)$$\n\n**使用 $I(Y;X) = H(Y) - H(Y|X)$ 进行验证**\n\n首先，我们计算 $Y$ 的熵，记为 $H(Y)$：\n$$H(Y) = -\\sum_{y \\in \\mathcal{Y}} P(Y=y) \\log_{2}(P(Y=y))$$\n$$H(Y) = -\\left[ \\frac{3}{7}\\log_{2}\\left(\\frac{3}{7}\\right) + \\frac{2}{7}\\log_{2}\\left(\\frac{2}{7}\\right) + \\frac{2}{7}\\log_{2}\\left(\\frac{2}{7}\\right) \\right]$$\n$$H(Y) = -\\frac{3}{7}(\\log_{2}(3) - \\log_{2}(7)) - \\frac{4}{7}(\\log_{2}(2) - \\log_{2}(7))$$\n$$H(Y) = -\\frac{3}{7}\\log_{2}(3) + \\frac{3}{7}\\log_{2}(7) - \\frac{4}{7}(1) + \\frac{4}{7}\\log_{2}(7)$$\n$$H(Y) = \\frac{7}{7}\\log_{2}(7) - \\frac{4}{7} - \\frac{3}{7}\\log_{2}(3) = \\log_{2}(7) - \\frac{4}{7} - \\frac{3}{7}\\log_{2}(3)$$\n\n接下来，我们计算条件熵 $H(Y|X)$。由于 $Y$ 是 $X$ 的一个确定性函数，知道 $X$ 的值就完全确定了 $Y$ 的值。这意味着一旦知道了 $X$，$Y$ 就不再有任何不确定性。对于任何给定的 $X=x$，条件概率分布 $P(Y|X=x)$ 对某个 $y$ 值的概率为 1，对所有其他值的概率为 0。这种分布的熵为 0。\n$$H(Y|X=x) = 0 \\quad \\text{for all } x \\in \\mathcal{X}$$\n因此，总条件熵也为零：\n$$H(Y|X) = \\sum_{x \\in \\mathcal{X}} P(X=x) H(Y|X=x) = \\sum_{x \\in \\mathcal{X}} P(X=x) \\cdot 0 = 0$$\n\n现在，我们使用第二个公式计算互信息：\n$$I(Y;X) = H(Y) - H(Y|X) = H(Y) - 0 = H(Y)$$\n$$I(Y;X) = \\log_{2}(7) - \\frac{4}{7} - \\frac{3}{7}\\log_{2}(3)$$\n\n两次计算得出了相同的结果，证实了 $I(X;Y) = I(Y;X)$。互信息是得知 $Y$ 后关于 $X$ 的不确定性的减少量，即 $H(X) - H(X|Y)$；或者等价地，是得知 $X$ 后关于 $Y$ 的不确定性的减少量，即 $H(Y) - H(Y|X)$。", "answer": "$$\\boxed{\\log_{2}(7) - \\frac{4}{7} - \\frac{3}{7}\\log_{2}(3)}$$", "id": "1662217"}]}