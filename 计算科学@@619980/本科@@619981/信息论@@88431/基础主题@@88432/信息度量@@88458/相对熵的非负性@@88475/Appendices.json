{"hands_on_practices": [{"introduction": "相对熵，或称Kullback-Leibler (KL)散度，是衡量两个概率分布之间差异的一种方法。然而，一个常见的误解是将其视为像欧几里得距离那样的真正“距离”度量。这个练习将通过一个具体的计算，揭示KL散度的一个核心特性：不对称性。通过计算$D_{KL}(P||Q)$和$D_{KL}(Q||P)$，您将亲手验证它们通常不相等，从而深刻理解为什么KL散度不是一个对称的距离度量。[@problem_id:1643606]", "problem": "在信息论中，库尔贝克-莱布勒（KL）散度，又称相对熵，是衡量一个概率分布与第二个参考概率分布之间差异的一种度量。\n\n考虑一个可以取三种可能结果之一的离散随机变量，我们将其标记为 $\\{O_1, O_2, O_3\\}$。提出了两种不同的概率模型，模型 $P$ 和模型 $Q$，来描述这些结果的可能性。\n\n模型 $P$ 由概率分布 $P(O_1) = \\frac{1}{2}$，$P(O_2) = \\frac{1}{4}$ 和 $P(O_3) = \\frac{1}{4}$ 描述。\n模型 $Q$ 假设所有三种结果都是等可能的；也就是说，它是在结果集合上的一个均匀分布。\n\n你的任务是计算 $P$ 相对于 $Q$ 的KL散度，记为 $D_{KL}(P||Q)$，以及 $Q$ 相对于 $P$ 的KL散度，记为 $D_{KL}(Q||P)$。请将你的结果以有序数值对 $(D_{KL}(P||Q), D_{KL}(Q||P))$ 的形式给出。\n\n请用以奈特（nat）为单位的精确解析表达式给出你的答案，这对应于使用自然对数（$\\ln$）。", "solution": "我们有三个结果 $\\{O_{1},O_{2},O_{3}\\}$，模型 $P$ 由 $P(O_{1})=\\frac{1}{2}$、$P(O_{2})=\\frac{1}{4}$、$P(O_{3})=\\frac{1}{4}$ 给出，模型 $Q$ 是均匀分布，因此对于 $i\\in\\{1,2,3\\}$，$Q(O_{i})=\\frac{1}{3}$。\n\n根据定义，$P$ 相对于 $Q$ 的库尔贝克-莱布勒散度是\n$$\nD_{KL}(P\\|Q)=\\sum_{i=1}^{3}P(O_{i})\\ln\\!\\left(\\frac{P(O_{i})}{Q(O_{i})}\\right).\n$$\n代入概率值，\n$$\nD_{KL}(P\\|Q)=\\frac{1}{2}\\ln\\!\\left(\\frac{\\frac{1}{2}}{\\frac{1}{3}}\\right)+\\frac{1}{4}\\ln\\!\\left(\\frac{\\frac{1}{4}}{\\frac{1}{3}}\\right)+\\frac{1}{4}\\ln\\!\\left(\\frac{\\frac{1}{4}}{\\frac{1}{3}}\\right)\n=\\frac{1}{2}\\ln\\!\\left(\\frac{3}{2}\\right)+\\frac{1}{2}\\ln\\!\\left(\\frac{3}{4}\\right)\n=\\frac{1}{2}\\ln\\!\\left(\\frac{9}{8}\\right).\n$$\n\n类似地，$Q$ 相对于 $P$ 的库尔贝克-莱布勒散度是\n$$\nD_{KL}(Q\\|P)=\\sum_{i=1}^{3}Q(O_{i})\\ln\\!\\left(\\frac{Q(O_{i})}{P(O_{i})}\\right),\n$$\n得到\n$$\nD_{KL}(Q\\|P)=\\frac{1}{3}\\ln\\!\\left(\\frac{\\frac{1}{3}}{\\frac{1}{2}}\\right)+\\frac{1}{3}\\ln\\!\\left(\\frac{\\frac{1}{3}}{\\frac{1}{4}}\\right)+\\frac{1}{3}\\ln\\!\\left(\\frac{\\frac{1}{3}}{\\frac{1}{4}}\\right)\n=\\frac{1}{3}\\ln\\!\\left(\\frac{2}{3}\\right)+\\frac{2}{3}\\ln\\!\\left(\\frac{4}{3}\\right)\n=\\frac{1}{3}\\ln\\!\\left(\\frac{32}{27}\\right).\n$$\n\n因此，有序对 $(D_{KL}(P\\|Q), D_{KL}(Q\\|P))$ 是 $\\left(\\frac{1}{2}\\ln\\left(\\frac{9}{8}\\right), \\frac{1}{3}\\ln\\left(\\frac{32}{27}\\right)\\right)$，单位是奈特。", "answer": "$$\\boxed{\\left(\\frac{1}{2}\\ln\\left(\\frac{9}{8}\\right), \\frac{1}{3}\\ln\\left(\\frac{32}{27}\\right)\\right)}$$", "id": "1643606"}, {"introduction": "在科学和工程领域，我们经常使用简化模型来描述复杂系统。KL散度为我们提供了一个强大的工具，用以量化使用简化模型（由分布$Q$表示）相对于真实系统（由分布$P$表示）所带来的信息损失。这个练习模拟了一个半导体制造的场景，您将计算一个简化的均匀概率模型与实际观测到的有偏分布之间的“模型散度”。[@problem_id:1643625] 这个计算不仅巩固了KL散度的公式应用，也直观地展示了吉布斯不等式 ($D_{KL}(P||Q) \\geq 0$) 的含义：任何不完美的模型都会导致一个正的信息散度值。", "problem": "一位工程师的任务是分析一种新的半导体制造工艺。该工艺生产的每个芯片可被分为两种状态之一：“可运行”或“有缺陷”。在缺少初始数据的情况下，提出了一个简化模型，该模型假设任何给定的芯片成为“可运行”或“有缺陷”状态的概率均等。\n\n经过一次试生产后，详细分析表明芯片“可运行”的真实概率为 $p$。为了量化简化模型与观测现实之间的差异，计算了一个“模型散度”指标 $D$。该指标由以下公式定义：\n\n$$D = \\sum_{s \\in S} P(s) \\ln\\left(\\frac{P(s)}{Q(s)}\\right)$$\n\n其中 $S = \\{\\text{可运行, 有缺陷}\\}$ 是芯片所有可能状态的集合，$P(s)$ 是由试生产确定的各状态的真实概率分布，而 $Q(s)$ 是简化模型所假设的概率分布。\n\n给定芯片“可运行”的真实概率为 $p = 0.90$，计算模型散度指标 $D$ 的值。将答案表示为四舍五入到三位有效数字的实数。", "solution": "我们给定一个二元状态空间 $S=\\{\\text{可运行},\\text{有缺陷}\\}$，其真实分布为 $P$，模型分布为 $Q$。模型假设 $Q(\\text{可运行})=Q(\\text{有缺陷})=\\frac{1}{2}$。试生产得到的真实分布为 $P(\\text{可运行})=p$ 和 $P(\\text{有缺陷})=1-p$，其中 $p=0.90$。\n\n模型散度即为库尔贝克-莱布勒散度\n$$\nD=\\sum_{s\\in S}P(s)\\ln\\!\\left(\\frac{P(s)}{Q(s)}\\right).\n$$\n代入两个状态及其概率，\n$$\nD=p\\ln\\!\\left(\\frac{p}{\\frac{1}{2}}\\right)+(1-p)\\ln\\!\\left(\\frac{1-p}{\\frac{1}{2}}\\right)\n=p\\ln(2p)+(1-p)\\ln\\!\\bigl(2(1-p)\\bigr).\n$$\n当 $p=0.90$ 时，我们得到\n$$\nD=0.90\\,\\ln(1.8)+0.10\\,\\ln(0.2).\n$$\n使用 $\\ln(1.8)\\approx 0.5877866649$ 和 $\\ln(0.2)=-\\ln(5)\\approx -1.6094379124$，计算\n$$\n0.90\\,\\ln(1.8)\\approx 0.90\\times 0.5877866649\\approx 0.5290079984,\n$$\n$$\n0.10\\,\\ln(0.2)\\approx 0.10\\times(-1.6094379124)\\approx -0.1609437912.\n$$\n因此，\n$$\nD\\approx 0.5290079984-0.1609437912=0.3680642072.\n$$\n四舍五入到三位有效数字，得到 $D\\approx 0.368$。", "answer": "$$\\boxed{0.368}$$", "id": "1643625"}, {"introduction": "我们已经知道KL散度是非负的，并且仅当两个分布完全相同时才为零。这一特性使其成为机器学习和统计推断中一个理想的优化目标。这个练习将这一概念提升到了一个新的层次，要求您在一个包含连续高斯分布的通信信道模型中，通过最小化模型与真实信道之间的期望KL散度来寻找最优模型参数。[@problem_id:1643617] 通过解决这个问题，您将证明，最小化信息散度的过程自然地引导我们选择最接近真实数据生成过程的模型，这揭示了KL散度在模型拟合和参数估计中的根本重要性。", "problem": "一位工程师正在为一个数字通信信道设计一个简化模型。该信道的输入是一个二元随机变量 $X \\in \\{0, 1\\}$，其先验概率分布已知，为 $p(X=1) = p$ 和 $p(X=0) = 1-p$，其中 $0  p  1$。\n\n该信道的真实物理行为由一个条件概率密度函数 $p(y|x)$ 描述，其中 $y$ 是连续输出信号。对于给定的输入 $x$，输出 $y$ 服从高斯分布，其均值取决于输入比特，方差为常数 $\\sigma^2$。具体来说，真实信道由以下公式给出：\n$$p(y|x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y - \\mu_x)^2}{2\\sigma^2}\\right)$$\n其中均值为 $\\mu_x$。具体来说，$\\mu_1 = m$ 和 $\\mu_0 = -m$，此处的 $m$ 是一个已知的正常数。\n\n工程师的简化模型 $q(y|x)$ 也被假设为高斯分布，具有相同的方差 $\\sigma^2$，但其均值使用模型参数 $\\nu_1$ 和 $\\nu_0$。\n$$q(y|x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y - \\nu_x)^2}{2\\sigma^2}\\right)$$\n为了找到最佳拟合模型，工程师决定最小化真实信道与模型之间的平均信息损失。该损失通过 $p(y|x)$ 和 $q(y|x)$ 之间的期望 Kullback-Leibler (KL) 散度来量化，其中期望是针对输入 $X$ 的分布计算的。需要最小化的目标函数是：\n$$L(\\nu_0, \\nu_1) = \\mathbb{E}_{p(x)}[D_{KL}(p(y|x) || q(y|x))]$$\n请确定能最小化此平均散度的最优模型参数 $\\nu_0$ 和 $\\nu_1$ 的表达式。最终答案应为一组用 $m$、$p$ 和 $\\sigma$ 表示的 $\\nu_0$ 和 $\\nu_1$ 的表达式。", "solution": "我们已知一个二元输入 $X \\in \\{0,1\\}$，其分布为 $p(X=1)=p$ 和 $p(X=0)=1-p$，以及一个真实的条件密度函数 $p(y|x)$，它是一个方差为 $\\sigma^{2}$、均值为 $\\mu_{x}$ 的高斯分布。模型 $q(y|x)$ 也是一个方差为 $\\sigma^{2}$、均值为 $\\nu_{x}$ 的高斯分布。要最小化的平均损失是期望 Kullback-Leibler 散度\n$$\nL(\\nu_{0},\\nu_{1})=\\mathbb{E}_{p(x)}\\left[D_{KL}\\left(p(y|x)\\,\\|\\,q(y|x)\\right)\\right].\n$$\n对于固定的 $x$，两个具有相同方差 $\\sigma^{2}$、均值分别为 $\\mu_{x}$ 和 $\\nu_{x}$ 的单变量高斯分布之间的 KL 散度可直接根据定义计算：\n$$\nD_{KL}\\left(p(y|x)\\,\\|\\,q(y|x)\\right)=\\mathbb{E}_{p(y|x)}\\left[\\ln\\frac{p(y|x)}{q(y|x)}\\right].\n$$\n使用\n$$\n\\ln p(y|x)=-\\frac{1}{2}\\ln(2\\pi\\sigma^{2})-\\frac{(y-\\mu_{x})^{2}}{2\\sigma^{2}},\\quad\n\\ln q(y|x)=-\\frac{1}{2}\\ln(2\\pi\\sigma^{2})-\\frac{(y-\\nu_{x})^{2}}{2\\sigma^{2}},\n$$\n它们的差为\n$$\n\\ln p(y|x)-\\ln q(y|x)=\\frac{(y-\\nu_{x})^{2}-(y-\\mu_{x})^{2}}{2\\sigma^{2}}.\n$$\n对 $p(y|x)$ 求期望，其中 $y\\sim\\mathcal{N}(\\mu_{x},\\sigma^{2})$，我们使用\n$$\n\\mathbb{E}\\left[(y-\\mu_{x})^{2}\\right]=\\sigma^{2},\\quad\n\\mathbb{E}\\left[(y-\\nu_{x})^{2}\\right]=\\sigma^{2}+(\\mu_{x}-\\nu_{x})^{2},\n$$\n得到\n$$\nD_{KL}\\left(p(y|x)\\,\\|\\,q(y|x)\\right)=\\frac{(\\mu_{x}-\\nu_{x})^{2}}{2\\sigma^{2}}.\n$$\n因此，目标函数变为\n$$\nL(\\nu_{0},\\nu_{1})=\\mathbb{E}_{p(x)}\\left[\\frac{(\\mu_{x}-\\nu_{x})^{2}}{2\\sigma^{2}}\\right]\n=\\frac{p}{2\\sigma^{2}}(\\mu_{1}-\\nu_{1})^{2}+\\frac{1-p}{2\\sigma^{2}}(\\mu_{0}-\\nu_{0})^{2}.\n$$\n由于 $0p1$ 且 $\\sigma^{2}0$，该函数在 $(\\nu_{0},\\nu_{1})$ 上是可分的和严格凸的。求偏导数并令其为零，\n$$\n\\frac{\\partial L}{\\partial \\nu_{1}}=\\frac{p}{\\sigma^{2}}(\\nu_{1}-\\mu_{1})=0 \\;\\Rightarrow\\; \\nu_{1}^{\\star}=\\mu_{1},\n$$\n$$\n\\frac{\\partial L}{\\partial \\nu_{0}}=\\frac{1-p}{\\sigma^{2}}(\\nu_{0}-\\mu_{0})=0 \\;\\Rightarrow\\; \\nu_{0}^{\\star}=\\mu_{0}.\n$$\n代入问题中定义的真实均值 $\\mu_1 = m$ 和 $\\mu_0 = -m$，我们得到最优参数：\n$$\n\\nu_{1}^{\\star}=m,\\qquad \\nu_{0}^{\\star}=-m,\n$$\n与 $p$ 和 $\\sigma$ 无关。", "answer": "$$\\boxed{\\begin{pmatrix}-m  m\\end{pmatrix}}$$", "id": "1643617"}]}