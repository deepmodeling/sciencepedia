{"hands_on_practices": [{"introduction": "熵的链式法则是分析序列事件系统的有力工具。第一个练习 [@problem_id:1608627] 提供了一个清晰直观的两道题小测验场景，演示了如何将一个系统的总不确定性分解为第一个事件的不确定性，加上在第一个事件已知条件下第二个事件的剩余不确定性。通过一步步计算熵，你将对链式法则的实际应用有一个扎实且具象的理解。", "problem": "一名学生正在参加一个由两道是非题组成的测验。令随机变量 $A_1$ 和 $A_2$ 分别代表学生对第一道题 ($Q_1$) 和第二道题 ($Q_2$) 的回答。每个回答的可能结果为 'True'（真）或 'False'（假）。该学生的答题行为已通过一个概率过程进行建模。\n\n学生对第一道题回答 'True' 的概率为 $P(A_1 = \\text{'True'}) = 0.8$。\n\n学生对第二道题的回答条件性地依赖于他们对第一道题的回答。\n- 如果学生对 $Q_1$ 回答 'True'，那么他们对 $Q_2$ 回答 'True' 的概率是 $P(A_2 = \\text{'True'} | A_1 = \\text{'True'}) = 0.5$。\n- 如果学生对 $Q_1$ 回答 'False'，那么他们对 $Q_2$ 回答 'True' 的概率是 $P(A_2 = \\text{'True'} | A_1 = \\text{'False'}) = 0.25$。\n\n计算学生回答的联合概率分布的总熵 $H(A_1, A_2)$。请将您的最终答案以比特为单位表示，并四舍五入到三位有效数字。所有熵的计算均使用以 2 为底的对数。", "solution": "我们应用以 2 为底的对数的熵链式法则：\n$$\nH(A_{1},A_{2})=H(A_{1})+H(A_{2}\\mid A_{1}).\n$$\n首先计算 $A_{1}$ 的边缘熵。当 $P(A_{1}=\\text{T})=0.8$ 且 $P(A_{1}=\\text{F})=0.2$ 时，\n$$\nH(A_{1})=-\\big[0.8\\,\\log_{2}(0.8)+0.2\\,\\log_{2}(0.2)\\big].\n$$\n使用 $\\log_{2}(0.8)\\approx -0.3219280949$ 和 $\\log_{2}(0.2)\\approx -2.3219280949$，\n$$\nH(A_{1})\\approx -\\big[0.8(-0.3219280949)+0.2(-2.3219280949)\\big]\\approx 0.7219280949.\n$$\n\n接下来计算条件熵 $H(A_{2}\\mid A_{1})$：\n$$\nH(A_{2}\\mid A_{1})=P(A_{1}=\\text{T})\\,H(A_{2}\\mid A_{1}=\\text{T})+P(A_{1}=\\text{F})\\,H(A_{2}\\mid A_{1}=\\text{F}).\n$$\n给定 $P(A_{2}=\\text{T}\\mid A_{1}=\\text{T})=0.5$，我们有\n$$\nH(A_{2}\\mid A_{1}=\\text{T})=-\\big[0.5\\,\\log_{2}(0.5)+0.5\\,\\log_{2}(0.5)\\big]=1.\n$$\n给定 $P(A_{2}=\\text{T}\\mid A_{1}=\\text{F})=0.25$，我们有\n$$\nH(A_{2}\\mid A_{1}=\\text{F})=-\\big[0.25\\,\\log_{2}(0.25)+0.75\\,\\log_{2}(0.75)\\big].\n$$\n使用 $\\log_{2}(0.25)=-2$ 和 $\\log_{2}(0.75)\\approx -0.4150374993$，\n$$\nH(A_{2}\\mid A_{1}=\\text{F})\\approx -\\big[0.25(-2)+0.75(-0.4150374993)\\big]\\approx 0.8112781245.\n$$\n因此，\n$$\nH(A_{2}\\mid A_{1})\\approx 0.8\\times 1+0.2\\times 0.8112781245\\approx 0.9622556249.\n$$\n\n最后，联合熵为\n$$\nH(A_{1},A_{2})\\approx 0.7219280949+0.9622556249\\approx 1.6841837198.\n$$\n四舍五入到三位有效数字（单位为比特），结果为 $1.68$。", "answer": "$$\\boxed{1.68}$$", "id": "1608627"}, {"introduction": "掌握了双变量的情况后，让我们来探索链式法则如何优雅地扩展到处理多变量序列。这个问题 [@problem_id:1608589] 将随机排列的生成过程建模为一系列无放回的选择。应用链式法则可以将一个看似复杂的联合熵计算，转变为一系列简单的条件熵之和，最终得出一个深刻而简洁的结果。", "problem": "一个密码系统依赖于为其密钥调度生成随机排列。整数集合 $\\{1, 2, \\dots, n\\}$ 的一个排列 $\\pi = (\\pi_1, \\pi_2, \\dots, \\pi_n)$ 是通过一个序列选择过程生成的。首先，从包含 $n$ 个整数的整个集合中均匀随机地选择一个元素 $\\pi_1$。接着，从剩下的 $n-1$ 个整数中均匀随机地选择一个元素 $\\pi_2$。这个过程持续进行，在第 $k$ 步时，从尚未被选择的 $n-k+1$ 个整数中均匀随机地选择元素 $\\pi_k$。当最后一个剩下的整数 $\\pi_n$ 被选出时，这个过程结束。\n\n令代表这个过程的随机变量序列为 $(\\pi_1, \\pi_2, \\dots, \\pi_n)$。计算该序列的总联合熵 $H(\\pi_1, \\pi_2, \\dots, \\pi_n)$。\n\n将你的答案表示为一个关于 $n$ 的单一封闭形式解析表达式。在最终表达式中使用以2为底的对数。", "solution": "问题要求计算序列生成的随机变量序列 $(\\pi_1, \\pi_2, \\dots, \\pi_n)$ 的联合熵。联合熵可以使用熵的链式法则来计算，该法则表明：\n$$H(X_1, X_2, \\dots, X_n) = \\sum_{k=1}^{n} H(X_k | X_1, \\dots, X_{k-1})$$\n按照惯例，$H(X_1 | X_0)$ 就是 $H(X_1)$。\n\n将此法则应用于我们的问题，联合熵为：\n$$H(\\pi_1, \\pi_2, \\dots, \\pi_n) = H(\\pi_1) + H(\\pi_2 | \\pi_1) + H(\\pi_3 | \\pi_1, \\pi_2) + \\dots + H(\\pi_n | \\pi_1, \\dots, \\pi_{n-1})$$\n\n我们需要计算这个和式中的每一项条件熵。\n\n第1步：计算 $H(\\pi_1)$。\n第一个元素 $\\pi_1$ 是从一个包含 $n$ 个元素的集合中均匀随机选择的。在一个大小为 $M$ 的集合上均匀分布的离散随机变量的熵是 $\\log_2(M)$。在本例中，$M=n$。\n$$H(\\pi_1) = \\log_2(n)$$\n\n第2步：计算 $H(\\pi_2 | \\pi_1)$。\n已知 $\\pi_1$ 已被选定，第二个元素 $\\pi_2$ 是从剩下的 $n-1$ 个元素中均匀随机选择的。在给定 $\\pi_1$ 的任何特定值的情况下，$\\pi_2$ 的条件概率分布在一个大小为 $n-1$ 的集合上是均匀的。因此，条件熵为：\n$$H(\\pi_2 | \\pi_1) = \\log_2(n-1)$$\n\n第3步：对第 $k$ 项 $H(\\pi_k | \\pi_1, \\dots, \\pi_{k-1})$ 进行推广。\n在第 $k$ 步，前 $k-1$ 个元素 $(\\pi_1, \\dots, \\pi_{k-1})$ 已经被选定。下一个元素 $\\pi_k$ 是从尚未被选择的元素集合中均匀选择的。这个集合的大小是 $n - (k-1) = n - k + 1$。\n$\\pi_k$ 的条件分布在一个大小为 $n-k+1$ 的集合上是均匀的。因此，条件熵为：\n$$H(\\pi_k | \\pi_1, \\dots, \\pi_{k-1}) = \\log_2(n-k+1)$$\n\n第4步：将所有条件熵项相加。\n我们现在可以将总联合熵写为这些项从 $k=1$ 到 $n$ 的和：\n$$H(\\pi_1, \\dots, \\pi_n) = \\sum_{k=1}^{n} H(\\pi_k | \\pi_1, \\dots, \\pi_{k-1}) = \\sum_{k=1}^{n} \\log_2(n-k+1)$$\n让我们展开这个和式来观察其规律：\n$$H(\\pi_1, \\dots, \\pi_n) = \\log_2(n-1+1) + \\log_2(n-2+1) + \\dots + \\log_2(n-n+1)$$\n$$H(\\pi_1, \\dots, \\pi_n) = \\log_2(n) + \\log_2(n-1) + \\dots + \\log_2(1)$$\n最后一项，即当 $k=n$ 时，是 $H(\\pi_n | \\pi_1, \\dots, \\pi_{n-1}) = \\log_2(n-n+1) = \\log_2(1) = 0$。这是合理的，因为一旦前 $n-1$ 个元素已知，最后一个元素也就确定了。\n\n第5步：合并对数项。\n利用对数的性质 $\\log(a) + \\log(b) = \\log(ab)$，我们可以将对数的和合并为乘积的对数：\n$$H(\\pi_1, \\dots, \\pi_n) = \\log_2(n \\cdot (n-1) \\cdot (n-2) \\cdot \\dots \\cdot 2 \\cdot 1)$$\n乘积 $n \\cdot (n-1) \\cdot \\dots \\cdot 1$ 是 $n$ 的阶乘的定义，记为 $n!$。\n因此，联合熵的最终表达式是：\n$$H(\\pi_1, \\dots, \\pi_n) = \\log_2(n!)$$\n这个结果与以下事实相符：该序列生成过程以相等的概率 $\\frac{1}{n!}$ 产生 $n!$ 种可能排列中的每一种，而在 $n!$ 个结果上均匀分布的熵为 $\\log_2(n!)$。", "answer": "$$\\boxed{\\log_{2}(n!)}$$", "id": "1608589"}, {"introduction": "为了加深我们对链式法则 $H(X,Y) = H(X) + H(Y|X)$ 的理解，研究其极端情况是很有启发性的。最后一个练习 [@problem_id:1991843] 探讨了一个完全相关的场景，即知道一个变量的状态就能完全确定另一个变量的状态。通过分析这种情况，你将看到条件熵项如何表现，以及联合熵为何会简化，从而巩固关于信息和依赖性的核心概念。", "problem": "考虑一个由两个可区分的亚基 A 和 B 组成的系统。每个亚基可以处于 $N$ 个可能的离散能级之一，由 $i \\in \\{1, 2, \\dots, N\\}$ 索引。最初，这些亚基是独立制备的。然后使它们相互接触，并通过一个特殊过程发生相互作用，使其状态完全关联。在此相互作用之后，总是发现这两个亚基处于相同的能级；也就是说，如果对亚基 A 的能级进行测量得到索引 $i$，那么同时对亚基 B 的能级进行测量也保证会得到索引 $i$。\n\n这种相互作用可能会重新分配占据各个能级的概率。相互作用后，发现亚基 A 处于第 $i$ 个能级的概率由 $p_i$ 给出，其中 $\\sum_{i=1}^{N} p_i = 1$。设 $X_A$ 和 $X_B$ 分别是相互作用后代表亚基 A 和 B 能级索引的随机变量。\n\n使用涉及玻尔兹曼常数 $k_B$ 和自然对数的统计力学熵定义，相互作用后组合系统的联合香农熵 $S(X_A, X_B)$ 是什么？请用 $k_B$ 和概率 $p_i$ 的符号表达式来表示你的答案。", "solution": "给定两个可区分的亚基 A 和 B，其相互作用后能级索引的联合分布是完全相关的，使得 $X_A = X_B$ 的概率为 1。$X_A$（以及等效地 $X_B$）的边缘分布由 $p_i$ 指定，且 $\\sum_{i=1}^{N} p_i = 1$。因此，联合概率质量函数为\n$$\nP(X_A=i, X_B=j) =\n\\begin{cases}\np_i, & i=j, \\\\\n0, & i \\neq j.\n\\end{cases}\n$$\n使用统计力学形式的香农熵，联合熵定义为\n$$\nS(X_A, X_B) = -k_{B} \\sum_{i=1}^{N} \\sum_{j=1}^{N} P(X_A=i, X_B=j)\\,\\ln\\big(P(X_A=i, X_B=j)\\big).\n$$\n代入联合概率，并注意到由于 $x \\ln x$ 在 $x=0$ 处的连续性，$P=0$ 的项贡献为零，因此双重求和简化为对角项 $i=j$：\n$$\nS(X_A, X_B) = -k_{B} \\sum_{i=1}^{N} p_i \\ln p_i.\n$$\n因此，联合熵等于边缘分布 $\\{p_i\\}$ 的熵，这与相互作用后 $X_B$ 是 $X_A$ 的确定性函数这一事实相符。", "answer": "$$\\boxed{-k_{B}\\sum_{i=1}^{N} p_{i}\\ln p_{i}}$$", "id": "1991843"}]}