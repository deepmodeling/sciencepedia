{"hands_on_practices": [{"introduction": "理解一个抽象数学不等式的最好方法之一就是通过一个具体的例子来检验它。这个练习将引导你使用两个伯努利分布，模拟一个理想制造过程与其发生漂移后的实际情况，来分别计算克尔贝克-莱布勒（KL）散度 $D_{KL}(P || Q)$ 和全变差距离 $TV(P, Q)$。通过这个直接的计算，你将亲手验证平斯克不等式 $D_{KL}(P || Q) \\ge 2[TV(P, Q)]^2$ 是如何将这两个重要的度量联系起来的 [@problem_id:1646398]。", "problem": "在一个数字制造过程中，一个部件被设计为处于两种状态之一，标记为 0 和 1。理想的制造规范规定，一个部件处于状态 1 的概率恰好为 $p$。这可以由一个伯努利分布建模，我们称之为 $P$，其概率质量函数为 $P(1) = p$ 和 $P(0) = 1-p$。\n\n运行一段时间后，一次质量控制检查显示该过程发生了偏移。现在的部件遵循一个不同的伯努利分布 $Q$，其概率质量函数为 $Q(1) = q$ 和 $Q(0) = 1-q$。\n\n为了量化理想分布 $P$ 和实际分布 $Q$ 之间的统计差异，使用了两种来自信息论的重要度量：\n\n1.  全变差距离 (Total Variation Distance)，定义为 $TV(P, Q) = \\frac{1}{2} \\sum_{x \\in \\{0, 1\\}} |P(x) - Q(x)|$。\n2.  Kullback-Leibler (KL) 散度，定义为 $D_{KL}(P || Q) = \\sum_{x \\in \\{0, 1\\}} P(x) \\ln\\left(\\frac{P(x)}{Q(x)}\\right)$。\n\n这两种度量通过 Pinsker 不等式相关联，该不等式表明 $D_{KL}(P || Q) \\ge 2[TV(P, Q)]^2$。项 $2[TV(P, Q)]^2$ 作为 KL 散度的一个理论下界。\n\n假设理想规范为 $p=0.5$，但实际观测到的过程已偏移至 $q=0.8$。计算实际 KL 散度与 Pinsker 不等式给出的理论下界之间的比率。也就是说，计算比率 $R = \\frac{D_{KL}(P || Q)}{2[TV(P, Q)]^2}$ 的值。\n\n将您的最终答案四舍五入到三位有效数字。", "solution": "参数为 $p$ 和 $q$ 的两个伯努利分布之间的全变差距离为\n$$\nTV(P,Q)=\\frac{1}{2}\\left(|p-q|+|(1-p)-(1-q)|\\right)=\\frac{1}{2}\\left(|p-q|+|q-p|\\right)=|p-q|.\n$$\n对于 $p=\\frac{1}{2}$ 和 $q=\\frac{4}{5}$，\n$$\nTV(P,Q)=\\left|\\frac{1}{2}-\\frac{4}{5}\\right|=\\left|\\frac{5-8}{10}\\right|=\\frac{3}{10}.\n$$\nPinsker 下界为\n$$\n2[TV(P,Q)]^{2}=2\\left(\\frac{3}{10}\\right)^{2}=2\\cdot\\frac{9}{100}=\\frac{9}{50}.\n$$\n伯努利分布的 Kullback-Leibler 散度为\n$$\nD_{KL}(P\\|Q)=p\\ln\\!\\left(\\frac{p}{q}\\right)+(1-p)\\ln\\!\\left(\\frac{1-p}{1-q}\\right).\n$$\n代入 $p=\\frac{1}{2}$ 和 $q=\\frac{4}{5}$ 得到\n$$\nD_{KL}(P\\|Q)=\\frac{1}{2}\\ln\\!\\left(\\frac{\\frac{1}{2}}{\\frac{4}{5}}\\right)+\\frac{1}{2}\\ln\\!\\left(\\frac{\\frac{1}{2}}{\\frac{1}{5}}\\right)=\\frac{1}{2}\\left[\\ln\\!\\left(\\frac{5}{8}\\right)+\\ln\\!\\left(\\frac{5}{2}\\right)\\right]=\\frac{1}{2}\\ln\\!\\left(\\frac{25}{16}\\right)=\\ln\\!\\left(\\frac{5}{4}\\right).\n$$\n因此，该比率为\n$$\nR=\\frac{D_{KL}(P\\|Q)}{2[TV(P,Q)]^{2}}=\\frac{\\ln\\!\\left(\\frac{5}{4}\\right)}{\\frac{9}{50}}=\\frac{50}{9}\\ln\\!\\left(\\frac{5}{4}\\right)\\approx 1.239686\\ldots\n$$\n四舍五入到三位有效数字，得到 $R=1.24$。", "answer": "$$\\boxed{1.24}$$", "id": "1646398"}, {"introduction": "在验证了平斯克不等式的有效性之后，一个自然而然的问题是：这个界有多“紧”？这个练习旨在探索这个界限的性质，展示一个数学界限不一定总是一个紧密的近似。通过一个精心设计的离散分布例子，你将计算由平斯克不等式给出的全变差距离的上界，并会发现这个界有时可能是相当“松散”的。这个实践突显了不等式作为理论保证的本质，对于培养批判性思维至关重要 [@problem_id:1646412]。", "problem": "在信息论中，我们经常需要量化两个概率分布之间的“差异”。两个常用的度量是全变差距离和Kullback-Leibler (KL) 散度。\n\n考虑定义在同一离散样本空间 $\\mathcal{X} = \\{x_1, x_2, x_3\\}$ 上的两个概率分布 $P$ 和 $Q$。其概率由下式给出：\n- $P(x_1) = 0.90$, $P(x_2) = 0.05$, $P(x_3) = 0.05$\n- $Q(x_1) = 0.01$, $Q(x_2) = 0.495$, $Q(x_3) = 0.495$\n\n$P$ 和 $Q$ 之间的全变差距离定义为：\n$$TV(P, Q) = \\frac{1}{2} \\sum_{i=1}^{3} |P(x_i) - Q(x_i)|$$\nKullback-Leibler (KL) 散度，用于衡量一个概率分布与另一个期望概率分布的偏离程度，其定义为：\n$$D_{KL}(P || Q) = \\sum_{i=1}^{3} P(x_i) \\ln\\left(\\frac{P(x_i)}{Q(x_i)}\\right)$$\n其中 $\\ln$ 表示自然对数。\n\nPinsker不等式给出了全变差距离的一个以KL散度表示的上界：\n$$TV(P, Q) \\leq \\sqrt{\\frac{1}{2} D_{KL}(P || Q)}$$\n\n右侧的项 $\\sqrt{\\frac{1}{2} D_{KL}(P || Q)}$ 是 $TV(P, Q)$ 的一个上界。对于给定的分布 $P$ 和 $Q$，计算此上界的数值。将你的最终答案四舍五入到三位有效数字。", "solution": "我们使用给定的定义。首先计算KL散度：\n$$\nD_{KL}(P\\|Q)=\\sum_{i=1}^{3} P(x_i)\\ln\\left(\\frac{P(x_i)}{Q(x_i)}\\right)\n=0.90\\ln\\left(\\frac{0.90}{0.01}\\right)+0.05\\ln\\left(\\frac{0.05}{0.495}\\right)+0.05\\ln\\left(\\frac{0.05}{0.495}\\right).\n$$\n简化比率：\n$$\n\\frac{0.90}{0.01}=90,\\qquad \\frac{0.05}{0.495}=\\frac{10}{99}.\n$$\n因此，\n$$\nD_{KL}(P\\|Q)=0.90\\ln(90)+0.10\\ln\\left(\\frac{10}{99}\\right).\n$$\n数值计算对数：\n$$\n\\ln(90)=4.499809670330265\\ldots,\\qquad \\ln\\left(\\frac{10}{99}\\right)=-2.292534757140543\\ldots,\n$$\n所以\n$$\nD_{KL}(P\\|Q)\\approx 0.90\\times 4.499809670330265+0.10\\times(-2.292534757140543)\n=4.049828703297239-0.229253475714054\n=3.820575227583185.\n$$\nPinsker不等式给出的上界为\n$$\n\\sqrt{\\frac{1}{2}D_{KL}(P\\|Q)}=\\sqrt{\\frac{3.820575227583185}{2}}=\\sqrt{1.910287613791592}\\approx 1.38213155\\ldots\n$$\n四舍五入到三位有效数字，上界是 $1.38$。", "answer": "$$\\boxed{1.38}$$", "id": "1646412"}, {"introduction": "为了获得对平斯克不等式更深层次的直观理解，我们最后一个练习将超越简单的数值验证，转而使用微积分的工具。通过考察当两个伯努利分布变得无限接近时，KL散度与全变差距离平方的行为，我们可以揭示它们之间的局部关系。这个练习将向你展示，平斯克不等式中的平方关系源于KL散度函数 $g(p) = D_{KL}(P_0 || P_p)$ 在两分布相等点 $p=p_0$ 处的一阶导数为零而二阶导数（曲率）非零的特性 [@problem_id:1646421]。", "problem": "在信息论和统计学中，人们使用多种度量来量化两个概率分布之间的“差异”。其中最基本的两个是 Kullback-Leibler 散度和全变差距离。本问题探讨对于伯努利分布族，这两种度量之间的局部关系。\n\n对于一个二元随机变量 $X \\in \\{0, 1\\}$，其伯努利分布（记作 `Bern(p)`）由概率质量函数 $P(X=1) = p$ 和 $P(X=0) = 1-p$ 定义，其中参数 $p \\in (0, 1)$。\n\n在样本空间 $\\Omega$ 上，从一个离散概率分布 $Q$ 到另一个分布 $P$ 的 Kullback-Leibler (KL) 散度定义为：\n$$ D_{KL}(P \\| Q) = \\sum_{x \\in \\Omega} P(x) \\ln\\left(\\frac{P(x)}{Q(x)}\\right) $$\n在样本空间 $\\Omega$ 上，两个离散概率分布 $P$ 和 $Q$ 之间的全变差 (TV) 距离定义为：\n$$ TV(P, Q) = \\frac{1}{2} \\sum_{x \\in \\Omega} |P(x) - Q(x)| $$\n\n考虑一个固定的参考分布 $P_0 = \\text{Bern}(p_0)$ 和一个可变分布 $P_p = \\text{Bern}(p)$。我们定义关于 $p$ 的两个函数：\n1.  $g(p) = D_{KL}(P_0 \\| P_p)$\n2.  $f(p) = \\left( TV(P_0, P_p) \\right)^2$\n\n这两个函数都度量了两个分布之间的差异，并且当 $p = p_0$ 时，它们的值都为零。我们感兴趣的是，当 $p$ 开始偏离 $p_0$ 时，这两个函数的增长速度如何。\n\n对于参数为 $p_0 = 0.25$ 的参考分布，计算以下极限的值：\n$$ L = \\lim_{p \\to p_0} \\frac{g(p)}{f(p)} $$\n请以实数形式给出 $L$ 的值。将最终答案四舍五入到四位有效数字。", "solution": "我们考虑 $P_{0}=\\text{Bern}(p_{0})$ 和 $P_{p}=\\text{Bern}(p)$，其中 $p_{0}=0.25$。根据定义，\n$$\ng(p)=D_{KL}(P_{0}\\|P_{p})=p_{0}\\ln\\!\\left(\\frac{p_{0}}{p}\\right)+(1-p_{0})\\ln\\!\\left(\\frac{1-p_{0}}{1-p}\\right).\n$$\n对于伯努利分布，全变差距离为\n$$\nTV(P_{0},P_{p})=\\frac{1}{2}\\sum_{x\\in\\{0,1\\}}|P_{0}(x)-P_{p}(x)|=\\frac{1}{2}\\left(|p_{0}-p|+|(1-p_{0})-(1-p)|\\right)=|p-p_{0}|,\n$$\n所以\n$$\nf(p)=\\left(TV(P_{0},P_{p})\\right)^{2}=(p-p_{0})^{2}.\n$$\n\n我们将 $g(p)$ 在 $p=p_{0}$ 附近进行展开。求导：\n$$\ng'(p)=\\frac{d}{dp}\\left[-p_{0}\\ln p-(1-p_{0})\\ln(1-p)\\right]=-\\,\\frac{p_{0}}{p}+\\frac{1-p_{0}}{1-p},\n$$\n所以\n$$\ng'(p_{0})=-\\,\\frac{p_{0}}{p_{0}}+\\frac{1-p_{0}}{1-p_{0}}=-1+1=0.\n$$\n二阶导数：\n$$\ng''(p)=\\frac{p_{0}}{p^{2}}+\\frac{1-p_{0}}{(1-p)^{2}},\n$$\n因此\n$$\ng''(p_{0})=\\frac{p_{0}}{p_{0}^{2}}+\\frac{1-p_{0}}{(1-p_{0})^{2}}=\\frac{1}{p_{0}}+\\frac{1}{1-p_{0}}=\\frac{1}{p_{0}(1-p_{0})}.\n$$\n根据泰勒展开式，并且 $g'(p_{0})=0$，我们有\n$$\ng(p)=\\frac{1}{2}g''(p_{0})(p-p_{0})^{2}+o\\!\\left((p-p_{0})^{2}\\right).\n$$\n因此，\n$$\nL=\\lim_{p\\to p_{0}}\\frac{g(p)}{f(p)}=\\lim_{p\\to p_{0}}\\frac{\\frac{1}{2}g''(p_{0})(p-p_{0})^{2}+o\\!\\left((p-p_{0})^{2}\\right)}{(p-p_{0})^{2}}=\\frac{1}{2}g''(p_{0})=\\frac{1}{2p_{0}(1-p_{0})}.\n$$\n当 $p_{0}=0.25$ 时，我们有 $p_{0}(1-p_{0})=\\frac{1}{4}\\cdot\\frac{3}{4}=\\frac{3}{16}$，所以\n$$\nL=\\frac{1}{2\\cdot\\frac{3}{16}}=\\frac{1}{\\frac{3}{8}}=\\frac{8}{3}\\approx 2.666666\\ldots\n$$\n四舍五入到四位有效数字，得到 $L=2.667$。", "answer": "$$\\boxed{2.667}$$", "id": "1646421"}]}