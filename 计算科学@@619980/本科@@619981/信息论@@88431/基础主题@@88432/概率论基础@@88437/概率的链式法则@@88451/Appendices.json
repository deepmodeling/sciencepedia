{"hands_on_practices": [{"introduction": "概率链式法则是计算一系列相关事件复合概率的基本工具。本练习将通过一个自适应学习系统的例子，让你亲手实践如何利用链式法则来计算一个特定结果序列的概率。这个过程将凸显马尔可夫性质（即当前事件的概率仅依赖于前一个事件）如何简化计算，这是理解随机过程和时序数据分析的关键第一步。[@problem_id:1609151]", "problem": "一个自适应学习系统向一名学生展示了三个连续的数学问题。该系统的算法会根据学生在前一个问题上的表现来调整每个问题的难度。设 $S_k$ 表示学生成功解决问题 $k$ 的事件， $F_k$ 表示学生未能解决问题 $k$ 的事件。\n\n该系统基于以下概率规则运行：\n1.  对于第一个问题，成功解决的概率为 $P(S_1) = 0.65$。\n2.  对于任何后续问题 $k > 1$，成功的概率取决于问题 $k-1$ 的结果。\n    -   如果学生解决了问题 $k-1$，系统会提供一个更难的问题，解决问题 $k$ 的概率为 $P(S_k | S_{k-1}) = 0.40$。\n    -   如果学生未能解决问题 $k-1$，系统会提供一个更简单的问题，解决问题 $k$ 的概率为 $P(S_k | F_{k-1}) = 0.85$。\n3.  任何问题 $k$ 的结果，在给定问题 $k-1$ 结果的条件下，与问题 $k-1$ 之前的所有结果条件独立。\n\n计算该学生解答这三个问题的结果序列为成功、失败、再成功的概率。将你的最终答案以小数形式给出，并四舍五入到三位有效数字。", "solution": "我们要求解序列 $S_{1}, F_{2}, S_{3}$ 的概率。根据概率的链式法则，\n$$\nP(S_{1} \\cap F_{2} \\cap S_{3}) = P(S_{1}) \\, P(F_{2} \\mid S_{1}) \\, P(S_{3} \\mid F_{2}, S_{1}).\n$$\n根据指定的条件独立规则（马尔可夫性质），问题3的结果仅取决于问题2，因此\n$$\nP(S_{3} \\mid F_{2}, S_{1}) = P(S_{3} \\mid F_{2}).\n$$\n使用给定的转移概率，\n$$\nP(S_{1}) = 0.65, \\quad P(F_{2} \\mid S_{1}) = 1 - P(S_{2} \\mid S_{1}) = 1 - 0.40 = 0.60, \\quad P(S_{3} \\mid F_{2}) = 0.85.\n$$\n因此，\n$$\nP(S_{1} \\cap F_{2} \\cap S_{3}) = 0.65 \\times 0.60 \\times 0.85 = 0.3315.\n$$\n四舍五入到三位有效数字，概率为 $0.332$。", "answer": "$$\\boxed{0.332}$$", "id": "1609151"}, {"introduction": "现实世界中的问题通常比计算单个序列的概率更复杂。本练习将背景设定在一个带有记忆效应的噪声信道中，要求你计算一个数据块可被纠正的总体概率，这需要考虑所有错误数小于等于一的情形。通过解决这个问题，你将学会如何将链式法则与概率的加法法则结合起来，处理由多个互斥事件共同构成的复杂事件，这是信息论在通信系统可靠性分析中的一个典型应用。[@problem_id:1609163]", "problem": "一个4位数据块通过一个有噪声的数字信道进行传输。该信道表现出记忆效应，即在给定位置发生比特错误的概率取决于其前一个位置是否发生了错误。设 $E_i$ 为在比特位置 $i$ 发生错误的事件，其中 $i \\in \\{1, 2, 3, 4\\}$。\n\n其错误特性如下：\n- 第一个比特发生错误的概率为 $P(E_1) = p_1$。\n- 对于任何后续比特 $i > 1$，在前一比特位置 $i-1$ 发生错误的条件下，该比特发生错误的条件概率为 $P(E_i | E_{i-1}) = p_c$。\n- 对于任何后续比特 $i > 1$，在前一比特位置 $i-1$ 没有发生错误的条件下，该比特发生错误的条件概率为 $P(E_i | E_{i-1}^c) = p_u$，其中 $E_{i-1}^c$ 是 $E_{i-1}$ 的补事件。\n\n接收到的数据块随后由一个单位纠错码的解码器进行处理。该解码器能够成功恢复原始的4位数据块，当且仅当接收到的数据块中包含至多一个比特错误。\n\n给定参数 $p_1 = 0.05$，$p_c = 0.4$ 和 $p_u = 0.02$，计算一个传输的4位数据块可被此解码器纠正的总概率。将最终答案保留四位有效数字。", "solution": "设 $E_{i}$ 表示比特 $i$ 发生错误的事件， $E_{i}^{c}$ 为其补事件。该信道具有一阶记忆性，因此一个长度为4的错误/无错误序列的概率等于初始概率与三个以其紧邻的前一个结果为条件的转移概率的乘积。\n\n定义补概率\n$$q_{1} = 1 - p_{1}, \\quad q_{c} = 1 - p_{c}, \\quad q_{u} = 1 - p_{u}。$$\n\n解码器成功当且仅当数据块中至多存在一个错误。我们计算所有零错误序列和恰好有一个错误的序列的概率之和。\n\n零错误（模式 $E_{1}^{c}E_{2}^{c}E_{3}^{c}E_{4}^{c}$）：\n$$P_{0} = P(E_{1}^{c}) P(E_{2}^{c} \\mid E_{1}^{c}) P(E_{3}^{c} \\mid E_{2}^{c}) P(E_{4}^{c} \\mid E_{3}^{c}) = q_{1} \\, q_{u}^{3}。$$\n\n在位置1恰好有一个错误（模式 $E_{1}E_{2}^{c}E_{3}^{c}E_{4}^{c}$）：\n$$P_{1} = P(E_{1}) P(E_{2}^{c} \\mid E_{1}) P(E_{3}^{c} \\mid E_{2}^{c}) P(E_{4}^{c} \\mid E_{3}^{c}) = p_{1} \\, q_{c} \\, q_{u}^{2}。$$\n\n在位置2恰好有一个错误（模式 $E_{1}^{c}E_{2}E_{3}^{c}E_{4}^{c}$）：\n$$P_{2} = P(E_{1}^{c}) P(E_{2} \\mid E_{1}^{c}) P(E_{3}^{c} \\mid E_{2}) P(E_{4}^{c} \\mid E_{3}^{c}) = q_{1} \\, p_{u} \\, q_{c} \\, q_{u}。$$\n\n在位置3恰好有一个错误（模式 $E_{1}^{c}E_{2}^{c}E_{3}E_{4}^{c}$）：\n$$P_{3} = P(E_{1}^{c}) P(E_{2}^{c} \\mid E_{1}^{c}) P(E_{3} \\mid E_{2}^{c}) P(E_{4}^{c} \\mid E_{3}) = q_{1} \\, q_{u} \\, p_{u} \\, q_{c}。$$\n\n在位置4恰好有一个错误（模式 $E_{1}^{c}E_{2}^{c}E_{3}^{c}E_{4}$）：\n$$P_{4} = P(E_{1}^{c}) P(E_{2}^{c} \\mid E_{1}^{c}) P(E_{3}^{c} \\mid E_{2}^{c}) P(E_{4} \\mid E_{3}^{c}) = q_{1} \\, q_{u}^{2} \\, p_{u}。$$\n\n因此，总的可纠正概率为\n$$P_{\\text{corr}} = P_{0} + P_{1} + P_{2} + P_{3} + P_{4} = q_{1} q_{u}^{3} + p_{1} q_{c} q_{u}^{2} + 2 q_{1} p_{u} q_{c} q_{u} + q_{1} q_{u}^{2} p_{u}。$$\n使用 $q_{u}^{3} + q_{u}^{2} p_{u} = q_{u}^{2} (q_{u} + p_{u}) = q_{u}^{2}$，该式可简化为\n$$P_{\\text{corr}} = q_{1} q_{u} \\left(q_{u} + 2 p_{u} q_{c}\\right) + p_{1} q_{c} q_{u}^{2}。$$\n\n代入 $p_{1} = 0.05$，$p_{c} = 0.4$，$p_{u} = 0.02$，因此 $q_{1} = 0.95$，$q_{c} = 0.6$，$q_{u} = 0.98$：\n$$q_{u}^{2} = 0.9604, \\quad 2 p_{u} q_{c} = 2 \\cdot 0.02 \\cdot 0.6 = 0.024,$$\n$$q_{u} + 2 p_{u} q_{c} = 0.98 + 0.024 = 1.004,$$\n$$q_{1} q_{u} \\left(q_{u} + 2 p_{u} q_{c}\\right) = 0.95 \\cdot 0.98 \\cdot 1.004 = 0.934724,$$\n$$p_{1} q_{c} q_{u}^{2} = 0.05 \\cdot 0.6 \\cdot 0.9604 = 0.028812.$$\n因此，\n$$P_{\\text{corr}} = 0.934724 + 0.028812 = 0.963536.$$\n四舍五入到四位有效数字，得到 $0.9635$。", "answer": "$$\\boxed{0.9635}$$", "id": "1609163"}, {"introduction": "链式法则的威力远不止于处理简单的一维序列。这个挑战性练习将带你进入一个二维网格模型，其中每个单元的状态都受其先前确定的邻居影响。你需要按照特定的“光栅扫描”顺序，一步步地应用链式法则，来计算整个系统呈现特定构型的概率。这个练习旨在深化你对条件概率和序列分解的理解，展示了链式法则在分析更复杂系统（如图像处理或统计物理模型）时的普适性和强大功能。[@problem_id:1609176]", "problem": "考虑一种新型存储阵列的简化模型，该模型由一个 $3 \\times 3$ 的相互作用的二进制单元网格组成。位于第 $i$ 行、第 $j$ 列的单元的状态由一个随机变量 $X_{i,j} \\in \\{0, 1\\}$ 表示，其中 $i, j \\in \\{1, 2, 3\\}$。\n\n这些单元的状态按光栅扫描顺序依次确定：$X_{1,1}, X_{1,2}, X_{1,3}, X_{2,1}, X_{2,2}, X_{2,3}, X_{3,1}, X_{3,2}, X_{3,3}$。每个单元的状态条件依赖于其先前已确定邻居的状态。如果 $|i-k| + |j-l| = 1$，则单元 $(i,j)$ 和 $(k,l)$ 被视为邻居。\n\n决定单元 $(i,j)$ 状态的概率规则如下。首先，根据其在光栅扫描序列中已经确定状态的邻居，计算一个局部影响场 $h_{i,j}$。该场由下式给出：\n$$h_{i,j} = \\sum_{(k,l) \\in N_{i,j}^{\\text{prev}}} (2X_{k,l} - 1)$$\n其中 $N_{i,j}^{\\text{prev}}$ 是 $(i,j)$ 的先前已确定的邻居集合。如果一个单元没有先前已确定的邻居，其影响场为 $h_{i,j}=0$。\n\n然后，一个单元状态为 1 的条件概率由该场的 logistic 函数给出：\n$$P(X_{i,j}=1 | \\text{past states}) = \\frac{1}{1 + \\exp(-\\gamma h_{i,j})}$$\n其中 $\\gamma = \\ln(3)$ 是一个耦合常数。\n\n您的任务是计算观测到整个网格出现以下特定棋盘格构型的概率：\n$$\n\\begin{pmatrix}\nX_{1,1} & X_{1,2} & X_{1,3} \\\\\nX_{2,1} & X_{2,2} & X_{2,3} \\\\\nX_{3,1} & X_{3,2} & X_{3,3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 0 \\\\\n1 & 0 & 1\n\\end{pmatrix}\n$$\n计算这个总概率，并以保留四位有效数字的小数形式给出您的答案。", "solution": "我们使用与光栅扫描顺序一致的链式法则，通过序贯规范来表示联合概率。对每个单元，局部场为\n$$\nh_{i,j}=\\sum_{(k,l)\\in N_{i,j}^{\\text{prev}}} (2X_{k,l}-1),\n$$\n且条件概率为 logistic 形式：\n$$\nP(X_{i,j}=1 \\mid \\text{past})=\\frac{1}{1+\\exp(-\\gamma h_{i,j})},\\quad \\gamma=\\ln(3).\n$$\n因此\n$$\n\\exp(-\\gamma h)=\\exp(-\\ln(3)\\,h)=3^{-h},\n$$\n所以\n$$\nP(X=1\\mid h)=\\frac{1}{1+3^{-h}},\\qquad P(X=0\\mid h)=1-P(X=1\\mid h)=\\frac{1}{1+3^{h}}.\n$$\n指定构型的联合概率等于这些条件概率按光栅扫描顺序的乘积。\n\n我们为目标构型\n$$\n\\begin{pmatrix}\n1 & 0 & 1\\\\\n0 & 1 & 0\\\\\n1 & 0 & 1\n\\end{pmatrix}\n$$\n计算每个因子，计算过程如下，仅使用先前已确定的邻居（左侧和/或上方）：\n\n1) $(1,1)$: $N_{1,1}^{\\text{prev}}=\\varnothing$，所以 $h_{1,1}=0$。当 $X_{1,1}=1$ 时，\n$$\nP=\\frac{1}{2}.\n$$\n\n2) $(1,2)$: $N_{1,2}^{\\text{prev}}=\\{(1,1)\\}$ 且 $X_{1,1}=1$，所以 $h_{1,2}=+1$。当 $X_{1,2}=0$ 时，\n$$\nP=\\frac{1}{1+3^{1}}=\\frac{1}{4}.\n$$\n\n3) $(1,3)$: $N_{1,3}^{\\text{prev}}=\\{(1,2)\\}$ 且 $X_{1,2}=0$，所以 $h_{1,3}=-1$。当 $X_{1,3}=1$ 时，\n$$\nP=\\frac{1}{1+3}=\\frac{1}{4}.\n$$\n\n4) $(2,1)$: $N_{2,1}^{\\text{prev}}=\\{(1,1)\\}$ 且 $X_{1,1}=1$，所以 $h_{2,1}=+1$。当 $X_{2,1}=0$ 时，\n$$\nP=\\frac{1}{4}.\n$$\n\n5) $(2,2)$: $N_{2,2}^{\\text{prev}}=\\{(2,1),(1,2)\\}$ 且 $X_{2,1}=0$、$X_{1,2}=0$，所以 $h_{2,2}=-1-1=-2$。当 $X_{2,2}=1$ 时，\n$$\nP=\\frac{1}{1+3^{2}}=\\frac{1}{10}.\n$$\n\n6) $(2,3)$: $N_{2,3}^{\\text{prev}}=\\{(2,2),(1,3)\\}$ 且 $X_{2,2}=1$、$X_{1,3}=1$，所以 $h_{2,3}=+1+1=+2$。当 $X_{2,3}=0$ 时，\n$$\nP=\\frac{1}{1+3^{2}}=\\frac{1}{10}.\n$$\n\n7) $(3,1)$: $N_{3,1}^{\\text{prev}}=\\{(2,1)\\}$ 且 $X_{2,1}=0$，所以 $h_{3,1}=-1$。当 $X_{3,1}=1$ 时，\n$$\nP=\\frac{1}{4}.\n$$\n\n8) $(3,2)$: $N_{3,2}^{\\text{prev}}=\\{(3,1),(2,2)\\}$ 且 $X_{3,1}=1$、$X_{2,2}=1$，所以 $h_{3,2}=+2$。当 $X_{3,2}=0$ 时，\n$$\nP=\\frac{1}{10}.\n$$\n\n9) $(3,3)$: $N_{3,3}^{\\text{prev}}=\\{(3,2),(2,3)\\}$ 且 $X_{3,2}=0$、$X_{2,3}=0$，所以 $h_{3,3}=-2$。当 $X_{3,3}=1$ 时，\n$$\nP=\\frac{1}{10}.\n$$\n\n因此，总概率为\n$$\nP_{\\text{total}}=\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{4}\\right)^{4}\\left(\\frac{1}{10}\\right)^{4}\n=\\frac{1}{2\\cdot 4^{4}\\cdot 10^{4}}=\\frac{1}{512\\cdot 10^{4}}=\\frac{1}{5120000}.\n$$\n转换为科学记数法并保留四位有效数字，\n$$\n\\frac{1}{5120000}=1.953125\\times 10^{-7}\\approx 1.953\\times 10^{-7}.\n$$", "answer": "$$\\boxed{1.953 \\times 10^{-7}}$$", "id": "1609176"}]}