{"hands_on_practices": [{"introduction": "第一个练习提供了计算离散随机变量条件概率的基础实践。通过一个清晰的联合概率质量函数（PMF）表格，你将学习如何通过关注一个特定事件来推导条件 PMF。这是理解关于一个变量的信息如何改变我们对另一个变量的概率评估的第一步。 [@problem_id:1906145]", "problem": "在一家半导体制造厂中，一道质量控制工序负责检查成批的处理器是否存在缺陷。设离散随机变量 $X$ 表示在一个随机选择的批次中发现的重大缺陷数量，离散随机变量 $Y$ 表示发现的次要缺陷数量。这两个变量的联合概率质量函数（PMF），$p_{X,Y}(x,y)$，由下表给出：\n\n| $p_{X,Y}(x,y)$ | $y=0$ | $y=1$ | $y=2$ | $y=3$ |\n|:--------------:|:-----:|:-----:|:-----:|:-----:|\n|     **$x=0$**    | 0.10  | 0.15  | 0.08  | 0.05  |\n|     **$x=1$**    | 0.08  | 0.20  | 0.12  | 0.02  |\n|     **$x=2$**    | 0.05  | 0.07  | 0.06  | 0.02  |\n\n一名检查员发现某个特定批次恰好包含一个次要缺陷。根据此信息，重大缺陷数量 $X$ 的条件概率质量函数是什么？\n\n请将条件概率质量函数 $p_{X|Y}(x|1)$ 在 $x=0, 1, 2$ 处的值以行矩阵的形式给出，矩阵元素对应于 $x$ 的递增值。请用精确分数表示您的答案。", "solution": "目标是求出在随机变量 $Y$ 已取值为 $1$ 的条件下，随机变量 $X$ 的条件概率质量函数（PMF）。该条件PMF记为 $p_{X|Y}(x|1)$。\n\n给定 $Y=y$ 时 $X$ 的条件PMF的定义是：\n$$p_{X|Y}(x|y) = \\frac{p_{X,Y}(x,y)}{p_Y(y)}$$\n其中 $p_{X,Y}(x,y)$ 是 $X$ 和 $Y$ 的联合PMF，而 $p_Y(y)$ 是 $Y$ 的边缘PMF。边缘PMF $p_Y(y)$ 是通过对联合PMF关于所有可能的 $X$ 值求和得到的：\n$$p_Y(y) = \\sum_{\\text{all } x} p_{X,Y}(x,y)$$\n\n在本问题中，我们关心的是 $y=1$ 的情况。首先，我们必须计算边缘概率 $p_Y(1)$。为此，我们将给定的联合PMF表中对应于 $y=1$ 的那一列的概率相加。$X$ 的可能取值是 $0, 1, 2$。\n\n$$p_Y(1) = p_{X,Y}(0,1) + p_{X,Y}(1,1) + p_{X,Y}(2,1)$$\n\n代入表格中的数值：\n$$p_Y(1) = 0.15 + 0.20 + 0.07 = 0.42$$\n\n现在我们得到了边缘概率 $p_Y(1)$，我们可以求出在 $Y=1$ 的条件下，对于每个可能的 $X$ 值（即 $x=0, 1, 2$）的条件概率。\n\n对于 $x=0$：\n$$p_{X|Y}(0|1) = \\frac{p_{X,Y}(0,1)}{p_Y(1)} = \\frac{0.15}{0.42}$$\n为了将其表示为精确分数，我们可以写作：\n$$p_{X|Y}(0|1) = \\frac{15}{42} = \\frac{3 \\times 5}{3 \\times 14} = \\frac{5}{14}$$\n\n对于 $x=1$：\n$$p_{X|Y}(1|1) = \\frac{p_{X,Y}(1,1)}{p_Y(1)} = \\frac{0.20}{0.42}$$\n作为精确分数：\n$$p_{X|Y}(1|1) = \\frac{20}{42} = \\frac{2 \\times 10}{2 \\times 21} = \\frac{10}{21}$$\n\n对于 $x=2$：\n$$p_{X|Y}(2|1) = \\frac{p_{X,Y}(2,1)}{p_Y(1)} = \\frac{0.07}{0.42}$$\n作为精确分数：\n$$p_{X|Y}(2|1) = \\frac{7}{42} = \\frac{7 \\times 1}{7 \\times 6} = \\frac{1}{6}$$\n\n作为检验，这些条件概率的总和应为 1：\n$$\\sum_{x} p_{X|Y}(x|1) = \\frac{5}{14} + \\frac{10}{21} + \\frac{1}{6}$$\n为了对这些分数求和，我们找到一个公分母，即 42。\n$$\\frac{5 \\times 3}{14 \\times 3} + \\frac{10 \\times 2}{21 \\times 2} + \\frac{1 \\times 7}{6 \\times 7} = \\frac{15}{42} + \\frac{20}{42} + \\frac{7}{42} = \\frac{15+20+7}{42} = \\frac{42}{42} = 1$$\n这些概率之和正确地等于 1。\n\n因此，在给定 $Y=1$ 的条件下 $X$ 的条件PMF为：\n$p_{X|Y}(0|1) = \\frac{5}{14}$\n$p_{X|Y}(1|1) = \\frac{10}{21}$\n$p_{X|Y}(2|1) = \\frac{1}{6}$\n\n题目要求将这些值按 $x$ 的递增顺序表示为一个行矩阵。最终结果是一个以这三个计算出的分数为元素的矩阵。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{5}{14} & \\frac{10}{21} & \\frac{1}{6} \\end{pmatrix}}$$", "id": "1906145"}, {"introduction": "现在，让我们来探索一个常用连续分布的迷人且反直觉的特性。这个问题利用一个元件寿命的假设场景，引导你推导指数分布的“无记忆性”。理解这一特性对于模拟那些“过去不影响未来”的系统至关重要，这一概念在可靠性理论和排队论等领域有着广泛的应用。 [@problem_id:1906142]", "problem": "一艘深空探测器由一个关键的不可充电电源供电。该电源的寿命，用随机变量 $T$（单位：年）表示，遵循一个常数速率参数为 $\\lambda > 0$ 的指数分布模型。$T$ 的概率密度函数 (PDF) 为 $f_T(t) = \\lambda \\exp(-\\lambda t)$（当 $t \\ge 0$ 时），以及 $f_T(t) = 0$（当 $t < 0$ 时）。\n\n在探测器成功运行了 $t_0$ 年后，任务控制中心希望分析其在剩余任务期间的可靠性。令 $Y = T - t_0$ 表示在电源已经工作超过时间 $t_0$ 的条件下，其额外的寿命。\n\n对于 $y \\ge 0$，确定随机变量 $Y$ 的概率密度函数。请将您的答案表示为 $y$ 和 $\\lambda$ 的函数。", "solution": "我们已知 $T$ 服从速率参数为 $\\lambda>0$ 的指数分布，因此其概率密度函数为 $f_{T}(t)=\\lambda \\exp(-\\lambda t)$（当 $t\\ge 0$ 时）和 $f_{T}(t)=0$（当 $t<0$ 时）。在时间 $t_{0}$ 后的额外寿命定义为 $Y=T-t_{0}$，条件是事件 $\\{T>t_{0}\\}$ 发生。\n\n为了求出 $Y$ 的密度，我们使用在已知生存超过 $t_{0}$ 的条件下 $T$ 的条件密度，然后应用平移变换。对于 $y\\ge 0$，\n$$\nf_{Y}(y)=f_{T\\mid T>t_{0}}(t_{0}+y)=\\frac{f_{T}(t_{0}+y)}{\\mathbb{P}(T>t_{0})}.\n$$\n我们计算生存概率：\n$$\n\\mathbb{P}(T>t_{0})=\\int_{t_{0}}^{\\infty}\\lambda \\exp(-\\lambda t)\\,dt=\\exp(-\\lambda t_{0}).\n$$\n将 $f_{T}(t_{0}+y)=\\lambda \\exp\\!\\big(-\\lambda(t_{0}+y)\\big)$ 代入并除以 $\\exp(-\\lambda t_{0})$，得到\n$$\nf_{Y}(y)=\\frac{\\lambda \\exp\\!\\big(-\\lambda(t_{0}+y)\\big)}{\\exp(-\\lambda t_{0})}=\\lambda \\exp(-\\lambda y),\\quad y\\ge 0.\n$$\n为了完整性，当 $y<0$ 时，$f_{Y}(y)=0$。这证明了无记忆性：$Y$ 服从相同的速率参数 $\\lambda$ 的指数分布，并且不依赖于 $t_{0}$。", "answer": "$$\\boxed{\\lambda \\exp(-\\lambda y)}$$", "id": "1906142"}, {"introduction": "最后一个实践展示了条件概率的一个强大应用：根据新数据更新我们的知识。通过一个使用含噪声传感器测量物理量的场景，你将使用贝叶斯定理推导后验分布。这个练习阐释了贝叶斯推断的核心机制，这是从机器学习到实验物理学等领域的一项基本技术，展示了我们如何定量地将先验信念与新证据相结合。 [@problem_id:1613129]", "problem": "一位材料科学家正在对一种新开发的光伏电池进行表征。该电池的真实但未知的开路电压由随机变量 $X$ 表示。基于理论模型和早期原型机的结果，该科学家对 $X$ 的先验信念由一个均值为 $\\mu_X$、方差为 $\\sigma_X^2$ 的高斯概率密度函数 (PDF) 建模。\n\n为了获得更精确的估计，该科学家使用两台不同的高精度万用表对电压进行了两次测量。每台万用表的测量过程都受到零均值加性高斯噪声的干扰。两台万用表的噪声源相互独立，并且也与真实电压 $X$ 独立。\n\n- 万用表1 得出测量值 $Y_1$。测量误差是一个方差为 $\\sigma_1^2$ 的高斯随机变量。\n- 万用表2 得出测量值 $Y_2$。测量误差是一个方差为 $\\sigma_2^2$ 的高斯随机变量。\n\n测量值与真实电压之间的关系由 $Y_i = X + N_i$ 给出，其中 $i \\in \\{1, 2\\}$，$N_i$ 表示第 $i$ 台万用表的噪声项。考虑到噪声的独立性，在给定真实电压的条件下，测量值的联合条件概率密度函数为 $p(y_1, y_2|x) = p(y_1|x)p(y_2|x)$。\n\n在获得具体的测量值 $y_1$ 和 $y_2$ 后，科学家通过计算后验概率密度函数 $p(x|y_1, y_2)$ 来更新他们关于 $X$ 的知识。已知该后验分布也是高斯分布。你的任务是确定该后验分布的均值 $\\mu_{\\text{post}}$ 和方差 $\\sigma_{\\text{post}}^2$。\n\n请提供两个独立的符号表达式，一个用于 $\\mu_{\\text{post}}$，一个用于 $\\sigma_{\\text{post}}^2$。第一个表达式应为均值，第二个为方差。两个表达式都应该用给定的参数来表示：$\\mu_X, \\sigma_X^2, y_1, \\sigma_1^2, y_2$ 和 $\\sigma_2^2$。", "solution": "问题要求我们求出后验分布 $p(x|y_1, y_2)$ 的参数。我们可以使用连续随机变量的贝叶斯定理。后验概率密度函数与似然函数和先验概率密度函数的乘积成正比：\n$$p(x|y_1, y_2) = \\frac{p(y_1, y_2|x)p(x)}{p(y_1, y_2)}$$\n分母 $p(y_1, y_2)$ 是一个不依赖于 $x$ 的归一化常数。因此，我们可以处理正比关系：\n$$p(x|y_1, y_2) \\propto p(y_1, y_2|x)p(x)$$\n问题陈述了在给定 $x$ 的条件下，测量是条件独立的，因此有 $p(y_1, y_2|x) = p(y_1|x)p(y_2|x)$。这得到：\n$$p(x|y_1, y_2) \\propto p(y_1|x) p(y_2|x) p(x)$$\n现在，我们写出右侧三个高斯概率密度函数的具体形式。\n$X$ 的先验分布是均值为 $\\mu_X$、方差为 $\\sigma_X^2$ 的高斯分布：\n$$p(x) = \\frac{1}{\\sqrt{2\\pi\\sigma_X^2}} \\exp\\left(-\\frac{(x - \\mu_X)^2}{2\\sigma_X^2}\\right)$$\n第一次测量 $Y_1$ 的似然函数是 $p(y_1|x)$。由于 $Y_1 = X + N_1$ 且 $N_1 \\sim \\mathcal{N}(0, \\sigma_1^2)$，因此在条件 $X=x$ 下，$Y_1$ 的分布是一个均值为 $x$、方差为 $\\sigma_1^2$ 的高斯分布：\n$$p(y_1|x) = \\frac{1}{\\sqrt{2\\pi\\sigma_1^2}} \\exp\\left(-\\frac{(y_1 - x)^2}{2\\sigma_1^2}\\right)$$\n类似地，第二次测量 $Y_2$ 的似然函数均值为 $x$，方差为 $\\sigma_2^2$：\n$$p(y_2|x) = \\frac{1}{\\sqrt{2\\pi\\sigma_2^2}} \\exp\\left(-\\frac{(y_2 - x)^2}{2\\sigma_2^2}\\right)$$\n将这些代入正比关系中，并忽略常数乘法因子：\n$$p(x|y_1, y_2) \\propto \\exp\\left(-\\frac{(y_1 - x)^2}{2\\sigma_1^2}\\right) \\exp\\left(-\\frac{(y_2 - x)^2}{2\\sigma_2^2}\\right) \\exp\\left(-\\frac{(x - \\mu_X)^2}{2\\sigma_X^2}\\right)$$\n我们可以合并指数部分：\n$$p(x|y_1, y_2) \\propto \\exp\\left[ -\\frac{1}{2} \\left( \\frac{(x - y_1)^2}{\\sigma_1^2} + \\frac{(x - y_2)^2}{\\sigma_2^2} + \\frac{(x - \\mu_X)^2}{\\sigma_X^2} \\right) \\right]$$\n括号内的表达式是关于 $x$ 的二次式。因为已知后验分布是高斯分布，其概率密度函数必具有 $p(x|y_1, y_2) \\propto \\exp\\left( -\\frac{(x - \\mu_{\\text{post}})^2}{2\\sigma_{\\text{post}}^2} \\right)$ 的形式。为了求出 $\\mu_{\\text{post}}$ 和 $\\sigma_{\\text{post}}^2$，我们展开指数部分，并匹配 $x^2$ 和 $x$ 的系数。设 $E$ 是大括号中的项：\n$$E = \\frac{x^2 - 2xy_1 + y_1^2}{\\sigma_1^2} + \\frac{x^2 - 2xy_2 + y_2^2}{\\sigma_2^2} + \\frac{x^2 - 2x\\mu_X + \\mu_X^2}{\\sigma_X^2}$$\n收集含有 $x^2$ 和 $x$ 的项：\n$$E = x^2 \\left( \\frac{1}{\\sigma_1^2} + \\frac{1}{\\sigma_2^2} + \\frac{1}{\\sigma_X^2} \\right) - 2x \\left( \\frac{y_1}{\\sigma_1^2} + \\frac{y_2}{\\sigma_2^2} + \\frac{\\mu_X}{\\sigma_X^2} \\right) + (\\text{不含 } x \\text{ 的项})$$\n均值为 $\\mu$、方差为 $\\sigma^2$ 的高斯分布指数的一般形式是 $\\frac{(x - \\mu)^2}{\\sigma^2} = \\frac{x^2 - 2x\\mu + \\mu^2}{\\sigma^2} = x^2\\left(\\frac{1}{\\sigma^2}\\right) - 2x\\left(\\frac{\\mu}{\\sigma^2}\\right) + \\frac{\\mu^2}{\\sigma^2}$。\n通过将我们表达式 $E$ 中 $x^2$ 的系数与通用形式进行比较，我们确定了后验方差的倒数：\n$$\\frac{1}{\\sigma_{\\text{post}}^2} = \\frac{1}{\\sigma_1^2} + \\frac{1}{\\sigma_2^2} + \\frac{1}{\\sigma_X^2}$$\n解出 $\\sigma_{\\text{post}}^2$，我们得到：\n$$\\sigma_{\\text{post}}^2 = \\left( \\frac{1}{\\sigma_1^2} + \\frac{1}{\\sigma_2^2} + \\frac{1}{\\sigma_X^2} \\right)^{-1}$$\n接下来，我们比较 $x$ 的线性项系数。从通用形式来看，该系数是 $-2\\frac{\\mu_{\\text{post}}}{\\sigma_{\\text{post}}^2}$，而从我们推导的指数来看，它是 $-2\\left( \\frac{y_1}{\\sigma_1^2} + \\frac{y_2}{\\sigma_2^2} + \\frac{\\mu_X}{\\sigma_X^2} \\right)$。\n令二者相等可得：\n$$\\frac{\\mu_{\\text{post}}}{\\sigma_{\\text{post}}^2} = \\frac{y_1}{\\sigma_1^2} + \\frac{y_2}{\\sigma_2^2} + \\frac{\\mu_X}{\\sigma_X^2}$$\n现在我们求解后验均值 $\\mu_{\\text{post}}$：\n$$\\mu_{\\text{post}} = \\sigma_{\\text{post}}^2 \\left( \\frac{y_1}{\\sigma_1^2} + \\frac{y_2}{\\sigma_2^2} + \\frac{\\mu_X}{\\sigma_X^2} \\right)$$\n代入 $\\sigma_{\\text{post}}^2$ 的表达式，可得 $\\mu_{\\text{post}}$ 为：\n$$\\mu_{\\text{post}} = \\frac{\\frac{y_1}{\\sigma_1^2} + \\frac{y_2}{\\sigma_2^2} + \\frac{\\mu_X}{\\sigma_X^2}}{\\frac{1}{\\sigma_1^2} + \\frac{1}{\\sigma_2^2} + \\frac{1}{\\sigma_X^2}}$$\n这就是后验均值和方差的最终表达式。后验均值是先验均值和两次测量值的加权平均，其中每一项的权重是其精度（方差的倒数）。后验精度是各个精度的总和。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\frac{y_1}{\\sigma_1^2} + \\frac{y_2}{\\sigma_2^2} + \\frac{\\mu_X}{\\sigma_X^2}}{\\frac{1}{\\sigma_1^2} + \\frac{1}{\\sigma_2^2} + \\frac{1}{\\sigma_X^2}} & \\left( \\frac{1}{\\sigma_1^2} + \\frac{1}{\\sigma_2^2} + \\frac{1}{\\sigma_X^2} \\right)^{-1} \\end{pmatrix}}$$", "id": "1613129"}]}