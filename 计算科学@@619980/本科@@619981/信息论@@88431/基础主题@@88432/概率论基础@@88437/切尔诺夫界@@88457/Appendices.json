{"hands_on_practices": [{"introduction": "在许多工程和科学应用中，我们不仅想知道一个随机事件的平均结果，更关心它偏离平均值的极端情况的概率。切诺夫界为我们提供了一个强有力的工具来估计这些“尾部概率”。这个练习将通过一个网络安全中的实际场景，直观地展示切诺夫界相比于马尔可夫不等式和切比雪夫不等式所具有的巨大优势，特别是在处理大量独立事件之和时。[@problem_id:1610102]", "problem": "一家网络安全公司正在评估其新型网络防火墙的误报率。在一次测试中，一个包含 $N = 20,000$ 个数据包的数据流被发送通过该系统，所有这些数据包都已知是良性的。该防火墙的分析算法具有已知的假阳性概率：任何单个良性数据包被错误标记为恶意的概率为 $p = 0.1$。\n\n该防火墙采用了一种自动锁定机制。如果数据流中被标记为恶意的数据包总数超过阈值 $k=2,500$，整个网络将被锁定。设 $X$ 为表示被标记数据包总数的随机变量。\n\n工程师们需要找到误报概率 $P(X \\ge 2,500)$ 的一个严格上界。他们已经使用不同的集中不等式计算了几个可能的上界。以下哪个值代表了可以使用标准集中不等式（如 Markov 不等式、Chebyshev 不等式或 Chernoff 不等式）推导出的最紧的有效上界？\n\nA. $8.00 \\times 10^{-1}$\n\nB. $7.20 \\times 10^{-3}$\n\nC. $6.01 \\times 10^{-26}$\n\nD. $2.14 \\times 10^{-56}$", "solution": "设 $X \\sim \\mathrm{Binomial}(n,p)$，其中 $n=20000$ 且 $p=0.1$。则\n$$\n\\mu = \\mathbb{E}[X] = np = 2000, \\quad \\mathrm{Var}(X) = np(1-p) = 1800.\n$$\n我们寻求 $\\mathbb{P}(X \\ge 2500)$ 的一个上界，即在 $k=2500=\\mu+500$ 处的上尾概率。定义相对偏差\n$$\n\\delta = \\frac{k-\\mu}{\\mu} = \\frac{500}{2000} = \\frac{1}{4}.\n$$\n\n对于非负的 $X$，Markov 不等式给出\n$$\n\\mathbb{P}(X \\ge 2500) \\le \\frac{\\mathbb{E}[X]}{2500} = \\frac{2000}{2500} = \\frac{4}{5} = 8.00 \\times 10^{-1}.\n$$\n\nChebyshev 不等式给出\n$$\n\\mathbb{P}(|X-\\mu| \\ge 500) \\le \\frac{\\mathrm{Var}(X)}{500^{2}} = \\frac{1800}{250000} = 7.20 \\times 10^{-3}.\n$$\n\n一个标准的 Chernoff（乘法形式）界，用于独立伯努利变量之和，表明对于 $\\delta>0$，\n$$\n\\mathbb{P}(X \\ge (1+\\delta)\\mu) \\le \\left(\\frac{\\exp(\\delta)}{(1+\\delta)^{1+\\delta}}\\right)^{\\mu}\n= \\exp\\!\\left(-\\mu\\left[(1+\\delta)\\ln(1+\\delta)-\\delta\\right]\\right).\n$$\n当 $\\mu=2000$ 且 $\\delta=\\frac{1}{4}$ 时，\n$$\n(1+\\delta)\\ln(1+\\delta)-\\delta = \\frac{5}{4}\\ln\\!\\left(\\frac{5}{4}\\right) - \\frac{1}{4},\n$$\n所以\n$$\n\\mathbb{P}(X \\ge 2500) \\le \\exp\\!\\left(-2000\\left[\\frac{5}{4}\\ln\\!\\left(\\frac{5}{4}\\right) - \\frac{1}{4}\\right]\\right).\n$$\n数值计算上，\n$$\n\\frac{5}{4}\\ln\\!\\left(\\frac{5}{4}\\right) - \\frac{1}{4} \\approx 0.028929439,\\quad\n2000 \\times 0.028929439 \\approx 57.858878,\n$$\n因此\n$$\n\\mathbb{P}(X \\ge 2500) \\lesssim \\exp(-57.858878) \\approx 7.45 \\times 10^{-26}.\n$$\n\n比较这三个标准上界：\n- Markov: $8.00 \\times 10^{-1}$ (选项A)，\n- Chebyshev: $7.20 \\times 10^{-3}$ (选项B)，\n- Chernoff: 数量级为 $10^{-26}$，与选项C $6.01 \\times 10^{-26}$ 一致，且远大于选项D $2.14 \\times 10^{-56}$。\n\n因此，在所列出的值中，通过标准集中不等式可获得的最紧的有效上界是与选项C对应的 Chernoff 型界。", "answer": "$$\\boxed{C}$$", "id": "1610102"}, {"introduction": "上一个练习我们探讨了事件发生次数“过多”的上限（上尾界）。同样地，切诺夫界也能有效地估计事件发生次数“过少”的概率（下尾界）。这个问题将我们带到半导体制造的质量控制领域，在这里，一个批次的产品可能因为随机性而表现出欺骗性的低缺陷率，从而错误地通过检验。通过计算这个风险的概率上界，我们可以更好地理解如何利用切诺夫界来管理和量化质量保证过程中的风险。[@problem_id:1610148]", "problem": "一家顶尖的半导体制造厂生产用于高性能计算的先进处理器。由于制造过程极其复杂，存在非零的缺陷概率。该过程既定的基准表明，任何单个处理器含有严重缺陷的概率为 $p = 0.05$，且与其他处理器独立。一次标准的生产运行包含一批 $n=10,000$ 个处理器。\n\n作为质量保证协议的一部分，如果一批处理器中观察到的次品率至多为 $0.04$，则该批次将被批准发货。公司希望量化一个统计上幸运的批次（即观察到的缺陷数量具有欺骗性地低）通过检验的风险，尽管其潜在的过程质量并未改变。\n\n计算一个随机选择的批次通过此质量检验的概率的数值上界。为此，您应使用标准乘法形式的 Chernoff 界来处理独立随机变量之和的下尾问题。将您的最终答案表示为一个四舍五入到三位有效数字的数值。", "solution": "令 $X_{i}$ 为处理器 $i$ 是次品的指示变量，其中 $X_{i} \\sim \\text{Bernoulli}(p)$，$p=0.05$，对于 $i=1,\\dots,n$ 独立，其中 $n=10000$。令 $X=\\sum_{i=1}^{n} X_{i}$ 为该批次中次品的总数。那么均值为 $\\mu=\\mathbb{E}[X]=np=10000 \\cdot 0.05=500$。\n\n如果观察到的次品率至多为 $0.04$，即如果 $X \\leq 0.04\\,n=400$，则该批次通过检验。这是一个相对于均值 $\\mu=500$ 的下尾事件。定义 $\\delta \\in [0,1]$ 使得 $(1-\\delta)\\mu=400$。由于 $\\mu=0.05\\,n$，我们计算\n$$\n\\delta \\;=\\; 1 - \\frac{400}{\\mu} \\;=\\; 1 - \\frac{0.04\\,n}{0.05\\,n} \\;=\\; 1 - \\frac{4}{5} \\;=\\; \\frac{1}{5}.\n$$\n\n根据独立伯努利随机变量之和的下尾的标准乘法形式 Chernoff 界，对于 $0 \\leq \\delta \\leq 1$，\n$$\n\\mathbb{P}\\!\\left(X \\leq (1-\\delta)\\mu\\right) \\;\\leq\\; \\exp\\!\\left(-\\frac{\\mu \\delta^{2}}{2}\\right).\n$$\n代入 $\\mu=500$ 和 $\\delta=\\frac{1}{5}$，\n$$\n\\mathbb{P}(X \\leq 400) \\;\\leq\\; \\exp\\!\\left(-\\frac{500 \\cdot (1/5)^{2}}{2}\\right)\n\\;=\\; \\exp\\!\\left(-\\frac{500 \\cdot \\frac{1}{25}}{2}\\right)\n\\;=\\; \\exp(-10).\n$$\n\n从数值上看，$\\exp(-10) \\approx 4.539992976 \\times 10^{-5}$，四舍五入到三位有效数字为 $4.54 \\times 10^{-5}$。", "answer": "$$\\boxed{4.54 \\times 10^{-5}}$$", "id": "1610148"}, {"introduction": "切诺夫界的美妙之处在于其与信息论的深刻联系。这个练习将揭示这种联系，展示如何使用KL散度（Kullback-Leibler divergence）来表达一个更通用和更紧确的切诺夫界。我们将通过一个典型的假设检验问题——区分系统是“正常运行”还是“故障运行”——来推导并应用这个界。这个过程不仅能解决一个实际的决策问题，还能加深我们对切诺夫界作为衡量两个概率分布之间“距离”的工具的理解。[@problem_id:1610163]", "problem": "一个制造过程的自动化质量控制系统对每个产品执行一系列 $n$ 次独立测试。每次测试的结果是二元的，即成功（0）或失败（1）。设这些结果由随机变量 $X_1, X_2, \\dots, X_n$ 表示，这些变量被假定为独立同分布的伯努利随机变量，其参数为 $p$，$p$ 代表真实的失败概率。\n\n该系统旨在区分生产线的两种状态：\n1.  正常运行（假设 $H_0$）：失败概率为 $p_0$。\n2.  故障运行（假设 $H_1$）：失败概率为 $p_1$，其中 $p_1 > p_0$。\n\n决策是基于观测到的失败样本均值 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^n X_i$ 做出的。如果 $\\bar{X}$ 大于或等于某个阈值 $\\alpha$，系统会将该操作标记为故障。否则，它被认为是正常的。这种将正常运行标记为故障的事件，被称为“误报”。\n\n给定以下参数：\n-   测试次数：$n = 1000$\n-   正常运行下的失败概率：$p_0 = 0.10$\n-   决策阈值：$\\alpha = 0.15$\n\n计算误报概率的一个紧指数上界。将最终答案四舍五入到三位有效数字。", "solution": "问题要求计算误报概率的一个上界。误报发生于真实状态是正常运行（$H_0$，失败概率为 $p_0$）但系统却判定运行为故障时。如果失败的样本均值 $\\bar{X}$ 大于或等于阈值 $\\alpha$，则会做出此决策。我们想要在数据 $X_i$ 来自 Bernoulli($p_0$) 分布的假设下，找到 $P(\\bar{X} \\ge \\alpha)$ 的一个上界。\n\n设 $S_n = \\sum_{i=1}^n X_i$ 为失败的总次数。条件 $\\bar{X} \\ge \\alpha$ 等价于 $\\frac{S_n}{n} \\ge \\alpha$，即 $S_n \\ge n\\alpha$。我们正在寻找 $P(S_n \\ge n\\alpha)$ 的一个上界。\n\n我们使用 Chernoff 界方法，该方法从 Markov 不等式开始。对于任意 $s > 0$，事件 $S_n \\ge n\\alpha$ 等价于 $\\exp(sS_n) \\ge \\exp(sn\\alpha)$。应用 Markov 不等式：\n$$P(S_n \\ge n\\alpha) = P(\\exp(sS_n) \\ge \\exp(sn\\alpha)) \\le \\frac{E[\\exp(sS_n)]}{\\exp(sn\\alpha)}$$\n由于随机变量 $X_i$ 是独立同分布的，总和的矩生成函数（MGF）是单个变量 MGF 的 $n$ 次方：\n$$E[\\exp(sS_n)] = (E[\\exp(sX)])^n$$\n其中 $E[\\exp(sX)]$ 是单个 Bernoulli($p_0$) 随机变量的 MGF：\n$$M_X(s) = E[\\exp(sX)] = (1-p_0)\\exp(s \\cdot 0) + p_0\\exp(s \\cdot 1) = 1 - p_0 + p_0 \\exp(s)$$\n将此代入我们的不等式，得到：\n$$P(S_n \\ge n\\alpha) \\le \\frac{(1 - p_0 + p_0 \\exp(s))^n}{\\exp(sn\\alpha)} = \\left(\\frac{1 - p_0 + p_0 \\exp(s)}{\\exp(s\\alpha)}\\right)^n$$\n这个界对任何 $s > 0$ 都有效。为了获得最紧的界，我们必须找到使指数的底数最小化的 $s$ 值。我们通过对数求导并设为零来最小化该表达式。更直接地，我们知道这个最优化的结果可以表示为 KL 散度。\n\n这个最优上界的形式是 $\\exp(-n D_{KL}(\\alpha || p_0))$，其中 $D_{KL}(\\alpha || p_0)$ 是参数为 $\\alpha$ 和 $p_0$ 的伯努利分布之间的 Kullback-Leibler (KL) 散度。KL 散度的公式为：\n$$D_{KL}(\\alpha || p_0) = \\alpha \\ln\\left(\\frac{\\alpha}{p_0}\\right) + (1-\\alpha) \\ln\\left(\\frac{1-\\alpha}{1-p_0}\\right)$$\n因此，最紧的上界是 $P(\\bar{X} \\ge \\alpha) \\le \\exp(-n D_{KL}(\\alpha || p_0))$。\n\n现在，我们代入给定的数值：$n=1000$，$p_0=0.10$ 和 $\\alpha=0.15$。\n首先，计算 KL 散度 $D_{KL}(0.15 || 0.10)$：\n$$D_{KL}(0.15 || 0.10) = 0.15 \\ln\\left(\\frac{0.15}{0.10}\\right) + (1-0.15) \\ln\\left(\\frac{1-0.15}{1-0.10}\\right)$$\n$$D_{KL}(0.15 || 0.10) = 0.15 \\ln(1.5) + 0.85 \\ln\\left(\\frac{0.85}{0.90}\\right)$$\n使用计算器计算自然对数：\n$\\ln(1.5) \\approx 0.405465$\n$\\ln(0.85/0.90) = \\ln(17/18) \\approx -0.057158$\n$$D_{KL}(0.15 || 0.10) \\approx 0.15 \\times 0.405465 + 0.85 \\times (-0.057158)$$\n$$D_{KL}(0.15 || 0.10) \\approx 0.060820 - 0.048584 \\approx 0.012236$$\n现在，我们计算最终的界：\n$$\\text{Bound} = \\exp(-n D_{KL}(\\alpha || p_0)) = \\exp(-1000 \\times 0.012236) = \\exp(-12.236)$$\n使用更高的精度进行中间步骤计算：\n$D_{KL}(0.15 || 0.10) \\approx 0.15 \\times 0.405465108 - 0.85 \\times 0.057158062 = 0.012235413$\n界 $= \\exp(-1000 \\times 0.012235413) = \\exp(-12.235413) \\approx 4.85708 \\times 10^{-6}$。\n四舍五入到三位有效数字，我们得到 $4.86 \\times 10^{-6}$。", "answer": "$$\\boxed{4.86 \\times 10^{-6}}$$", "id": "1610163"}]}