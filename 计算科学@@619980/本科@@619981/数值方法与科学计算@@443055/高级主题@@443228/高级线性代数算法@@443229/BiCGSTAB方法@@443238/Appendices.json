{"hands_on_practices": [{"introduction": "在理想的精确算术环境中，像BiCGSTAB这样的Krylov子空间方法保证能在有限步内找到线性系统的精确解，这个性质是这些迭代方法的核心理论基础之一。本练习 [@problem_id:3210293] 将通过一个具体的例子，帮助你将迭代次数与矩阵的最小多项式联系起来，从而深入理解BiCGSTAB的有限终止性，为你掌握该方法奠定坚实的理论基础。", "problem": "考虑将双共轭梯度稳定（BiCGSTAB）方法应用于一个由二维实、非奇异、非对称矩阵构成的线性系统。设\n$$\nA \\;=\\; \\begin{pmatrix} 2  1 \\\\ 0  3 \\end{pmatrix},\n$$\n并假设初始猜测为 $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，右端项为 $b \\in \\mathbb{R}^{2}$ 使得 $b \\neq 0$，并选择影子残差 $\\hat{r}_{0} = r_{0} := b - A x_{0} = b$。假设 BiCGSTAB 递推过程中不发生崩溃（即，该方法定义的所有除法运算对于此输入都是良定义的）。\n\n仅使用以下基本原理：\n- Krylov 子空间 $ \\mathcal{K}_{k}(A, r_{0}) = \\operatorname{span}\\{ r_{0}, A r_{0}, \\dots, A^{k-1} r_{0} \\}$ 的定义，\n- 矩阵 $A$ 的最小多项式 $\\mu_{A}(t)$ 的定义，即满足 $\\mu_{A}(A) = 0$ 的次数最小的唯一首一多项式，\n- 以及双共轭梯度稳定方法的更新关系，该关系将每个 BiCGSTAB 残差 $r_{k}$ 建立为 $r_{k} = \\phi_{k}(A)\\,r_{0}$ 的形式，其中 $\\phi_{k}$ 是某个多项式，\n\n完成以下任务：\n1) 从双共轭梯度稳定方法的更新方程推导出，经过 $k$ 次外迭代后，残差具有形式 $r_{k} = \\phi_{k}(A)\\,r_{0}$，其中 $\\deg(\\phi_{k}) \\leq 2k$，并且 $\\phi_{k}(t)$ 可分解为一个 $k$ 次“稳定”多项式和一个 $k$ 次双共轭梯度残差多项式的乘积。使用此结构，结合最小多项式的定义，证明在二维情况下，只要不发生崩溃，该方法在至多两次外迭代后有限终止（即，在精确算术中 $r_{2} = 0$）。\n2) 对于上述特定矩阵 $A$，显式计算其唯一的首一最小多项式 $\\mu_{A}(t)$。\n\n你的最终答案必须是多项式 $\\mu_{A}(t)$ 的显式解析表达式。不需要数值四舍五入。不要包含单位。", "solution": "问题分为两部分。第一部分是关于双共轭梯度稳定（BiCGSTAB）方法终止性质的理论推导。第二部分是针对给定矩阵计算其最小多项式。\n\n第1部分：BiCGSTAB 残差结构与有限终止性\n\nBiCGSTAB 方法是一种求解非对称线性系统 $A x = b$ 的迭代方法。该方法生成一个迭代序列 $x_k$，使得相应的残差 $r_k = b - A x_k$ 逐渐减小。像 BiCGSTAB 这样的 Krylov 子空间方法的一个关键性质是，经过 $k$ 次迭代后的残差可以表示为一个作用于初始残差 $r_0$ 的矩阵 $A$ 的多项式。\n\n如问题所述，经过 $k$ 次外迭代后，BiCGSTAB 方法的残差具有形式 $r_k = \\phi_k(A) r_0$，其中 $\\phi_k(t)$ 是一个多项式。问题进一步指明了该多项式的结构。从算法的递推关系进行的详细推导证实了 $\\phi_k(t)$ 是两个次数均为 $k$ 的多项式的乘积：\n$$ \\phi_k(t) = \\sigma_k(t) \\psi_k(t) $$\n在这里，$\\psi_k(t)$ 是一个 $k$ 次多项式，源于该算法底层的双共轭梯度（BiCG）结构。它被称为 BiCG 残差多项式。第二个多项式 $\\sigma_k(t) = \\prod_{j=1}^{k} (1 - \\omega_j t)$ 是一个 $k$ 次多项式，源于“稳定化”步骤，这些步骤类似于单步广义最小残差（GMRES）更新。系数 $\\omega_j$ 在每一步被选择以局部最小化残差的范数。因此，BiCGSTAB 残差多项式 $\\phi_k(t)$ 的总次数为 $\\deg(\\phi_k) = \\deg(\\sigma_k) + \\deg(\\psi_k) = k + k = 2k$。这证明了所要求的第一个性质。\n\n现在，我们使用此结构来证明 BiCGSTAB 对于 $2 \\times 2$ 矩阵的有限终止性。该论证依赖于矩阵最小多项式的性质。\n设 $A$ 是一个 $N \\times N$ 矩阵。$A$ 的最小多项式，记作 $\\mu_A(t)$，是满足 $\\mu_A(A) = 0$ 的次数最小的唯一首一多项式，其次数为 $m$。根据 Cayley-Hamilton 定理，有 $m \\le N$。\n对于任意向量 $v$，向量 $v$ 关于矩阵 $A$ 的最小多项式，记作 $\\mu_{A,v}(t)$，是满足 $\\mu_{A,v}(A)v=0$ 的次数最小的唯一首一多项式，其次数为 $m'$。该多项式整除 $\\mu_A(t)$，因此其次数满足 $m' \\le m \\le N$。\n\n假设不发生崩溃，BiCG 方法保证在至多 $m'$ 步内找到精确解，其中 $m'$ 是初始残差 $r_0$ 关于 $A$ 的最小多项式的次数。这意味着当 $k=m'$ 时，BiCG 残差多项式 $\\psi_k(t)$ 必须是 $\\mu_{A, r_0}(t)$ 的一个标量倍。由于 $\\psi_{m'}(t)$ 和 $\\mu_{A, r_0}(t)/\\mu_{A, r_0}(0)$ 都是次数为 $m'$ 且在 $t=0$ 时等于 1 的多项式，它们必定相同。因此，在第 $m'$ 步的 BiCG 残差为零：\n$$ r_{m'}^{\\text{BCG}} = \\psi_{m'}(A) r_0 = \\frac{\\mu_{A, r_0}(A)}{\\mu_{A, r_0}(0)} r_0 = 0 $$\n问题陈述 BiCGSTAB 残差多项式 $\\phi_k(t)$ 分解为一个稳定部分和一个 BiCG 残差多项式部分 $\\psi_k(t)$。因此，在第 $k=m'$ 步的 BiCGSTAB 残差由下式给出：\n$$ r_{m'} = \\sigma_{m'}(A) \\psi_{m'}(A) r_0 $$\n代入 $\\psi_{m'}(A) r_0 = 0$ 的结果，我们得到：\n$$ r_{m'} = \\sigma_{m'}(A) \\cdot 0 = 0 $$\n这表明 BiCGSTAB 也必须在至多 $m'$ 步内终止。\n\n对于问题中给出的具体情况，矩阵 $A$ 的维数为 $N=2$。其最小多项式 $\\mu_A(t)$ 的次数为 $m \\le 2$。$r_0$ 关于 $A$ 的最小多项式的次数为 $m' \\le m \\le 2$。因此，BiCGSTAB 方法保证对于某个 $k \\le m' \\le 2$ 以 $r_k=0$ 终止。这意味着该方法在至多 2 次外迭代中找到精确解。\n\n第2部分：最小多项式的计算\n\n我们给定的矩阵是：\n$$ A = \\begin{pmatrix} 2  1 \\\\ 0  3 \\end{pmatrix} $$\n为了找到最小多项式 $\\mu_A(t)$，我们首先计算特征多项式 $\\chi_A(t)$。\n$$ \\chi_A(t) = \\det(A - tI) = \\det\\begin{pmatrix} 2-t  1 \\\\ 0  3-t \\end{pmatrix} $$\n$$ \\chi_A(t) = (2-t)(3-t) = t^2 - 5t + 6 $$\n最小多项式 $\\mu_A(t)$ 必须整除特征多项式 $\\chi_A(t)$。$\\chi_A(t)$ 的根是 $A$ 的特征值，即 $\\lambda_1 = 2$ 和 $\\lambda_2 = 3$。由于特征值是互异的，矩阵 $A$ 是可对角化的。对于可对角化矩阵，其最小多项式是对应于每个不同特征值的线性因子的乘积。\n因此，最小多项式必须是：\n$$ \\mu_A(t) = (t-2)(t-3) = t^2 - 5t + 6 $$\n最小多项式要求是首一的，而这个多项式满足此条件。其次数为 2。$\\chi_A(t)$ 的其他唯一的首一因式是 $(t-2)$ 和 $(t-3)$，它们的次数均为 1。我们检查它们是否零化 $A$：\n$$ A - 2I = \\begin{pmatrix} 2  1 \\\\ 0  3 \\end{pmatrix} - \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 0  1 \\end{pmatrix} \\neq 0 $$\n$$ A - 3I = \\begin{pmatrix} 2  1 \\\\ 0  3 \\end{pmatrix} - \\begin{pmatrix} 3  0 \\\\ 0  3 \\end{pmatrix} = \\begin{pmatrix} -1  1 \\\\ 0  0 \\end{pmatrix} \\neq 0 $$\n由于没有 1 次多项式能零化 $A$，所以最小多项式的次数必须为 2。因为它必须整除特征多项式，且与特征多项式次数相同（并且两者都是首一的），所以它们必须相等。\n\n因此，$A$ 的唯一首一最小多项式是 $\\mu_A(t) = t^2 - 5t + 6$。", "answer": "$$\\boxed{t^2 - 5t + 6}$$", "id": "3210293"}, {"introduction": "在了解了理想情况后，我们来探讨一个推动BiCGSTAB方法发展的实际挑战。BiCGSTAB方法所基于的双共轭梯度（BiCG）方法可能会遭遇“崩溃”，导致算法过早失败。本练习 [@problem_id:2376326] 设计了一个BiCG方法失败的具体场景，并展示了BiCGSTAB中的“稳定化”步骤如何使其能够继续进行，从而突显其改进后的稳健性。", "problem": "要求您从克里洛夫子空间迭代法的第一性原理出发，演示双共轭梯度（BiCG）法在何种情况下会发生崩溃，而稳定双共轭梯度（BiCGSTAB）法在相同的线性系统上仍然收敛。考虑线性系统 $A x = b$，其中\n$$\nA \\;=\\; \\begin{pmatrix}\n2  0  1\\\\\n1  3  0\\\\\n0  0  4\n\\end{pmatrix}, \n\\qquad\nb \\;=\\; \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix},\n\\qquad\nx_0 \\;=\\; \\begin{pmatrix} 0\\\\ 0\\\\ 0 \\end{pmatrix}.\n$$\n对于双共轭梯度（BiCG）法，设初始残差为 $r_0 = b - A x_0$，初始影子残差为 $\\tilde{r}_0 = r_0$。仅使用 BiCG 中第一步更新的定义（残差和影子残差由带双正交配对的单步克里洛夫投影定义），显式计算 $r_1$ 和 $\\tilde{r}_1$，并验证 $r_1 \\neq 0$, $\\tilde{r}_1 \\neq 0$ 且 $r_1^{T}\\tilde{r}_1 = 0$，这表明 BiCG 将在下一步发生崩溃。\n\n接下来，将稳定双共轭梯度（BiCGSTAB）法应用于具有相同初始猜测 $x_0$、相同初始残差 $r_0$ 以及选择的固定影子残差 $\\hat{r}$ 的同一系统：\n$$\n\\hat{r} \\;=\\; r_0 + \\begin{pmatrix} 0\\\\ 1\\\\ 0 \\end{pmatrix} \\;=\\; \\begin{pmatrix} 1\\\\ 1\\\\ 0 \\end{pmatrix}.\n$$\n使用 BiCGSTAB 递推的标准定义（标量系数由 $r_{k-1}$、$\\hat{r}$ 和在 $A$ 下的克里洛夫像的内积定义），执行第一次 BiCGSTAB 迭代以计算平滑参数 $\\omega_1$。\n\n您的任务是提供标量 $\\omega_1$ 的值。请将最终答案精确表示为最简分数。无需四舍五入。最终答案必须是单个无单位的数字。", "solution": "所考虑的线性系统为 $A x = b$，给定条件如下：\n$$\nA \\;=\\; \\begin{pmatrix}\n2  0  1\\\\\n1  3  0\\\\\n0  0  4\n\\end{pmatrix}, \n\\qquad\nb \\;=\\; \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix},\n\\qquad\nx_0 \\;=\\; \\begin{pmatrix} 0\\\\ 0\\\\ 0 \\end{pmatrix}.\n$$\n\n首先，我们分析 BiCG 方法。初始残差为 $r_0 = b - A x_0 = b - 0 = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix}$。\n问题指定设置初始影子残差 $\\tilde{r}_0 = r_0$。因此，$\\tilde{r}_0 = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix}$。\nBiCG 算法设置初始搜索方向为 $p_0 = r_0$ 和 $\\tilde{p}_0 = \\tilde{r}_0$。\n在每个步骤 $k$，标量 $\\alpha_k$ 计算如下：$\\alpha_k = \\frac{\\tilde{r}_k^T r_k}{\\tilde{p}_k^T A p_k}$。\n对于第一步 ($k=0$)：\n分子是 $\\tilde{r}_0^T r_0 = r_0^T r_0 = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} = 1$。\n为了计算分母，我们首先找到 $A p_0$：\n$A p_0 = A r_0 = \\begin{pmatrix} 2  0  1\\\\ 1  3  0\\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2\\\\ 1\\\\ 0 \\end{pmatrix}$。\n则分母为 $\\tilde{p}_0^T A p_0 = \\tilde{r}_0^T (A r_0) = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 2\\\\ 1\\\\ 0 \\end{pmatrix} = 2$。\n因此，$\\alpha_0 = \\frac{1}{2}$。\n\n更新后的残差 $r_1$ 和 $\\tilde{r}_1$ 计算如下：\n$r_1 = r_0 - \\alpha_0 A p_0 = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} - \\frac{1}{2} \\begin{pmatrix} 2\\\\ 1\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1\\\\ 1/2\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0\\\\ -1/2\\\\ 0 \\end{pmatrix}$。\n$\\tilde{r}_1 = \\tilde{r}_0 - \\alpha_0 A^T \\tilde{p}_0$。$A$ 的转置是 $A^T = \\begin{pmatrix} 2  1  0\\\\ 0  3  0\\\\ 1  0  4 \\end{pmatrix}$。\n$A^T \\tilde{p}_0 = A^T \\tilde{r}_0 = \\begin{pmatrix} 2  1  0\\\\ 0  3  0\\\\ 1  0  4 \\end{pmatrix} \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2\\\\ 0\\\\ 1 \\end{pmatrix}$。\n$\\tilde{r}_1 = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} - \\frac{1}{2} \\begin{pmatrix} 2\\\\ 0\\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1\\\\ 0\\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} 0\\\\ 0\\\\ -1/2 \\end{pmatrix}$。\n\n我们验证问题中陈述的条件：\n1. $r_1 = \\begin{pmatrix} 0\\\\ -1/2\\\\ 0 \\end{pmatrix} \\neq 0$。\n2. $\\tilde{r}_1 = \\begin{pmatrix} 0\\\\ 0\\\\ -1/2 \\end{pmatrix} \\neq 0$。\n3. $r_1^T \\tilde{r}_1 = \\begin{pmatrix} 0  -1/2  0 \\end{pmatrix} \\begin{pmatrix} 0\\\\ 0\\\\ -1/2 \\end{pmatrix} = (0)(0) + (-1/2)(0) + (0)(-1/2) = 0$。\n\nBiCG 算法的下一步是计算 $\\beta_0 = \\frac{\\tilde{r}_1^T r_1}{\\tilde{r}_0^T r_0} = \\frac{0}{1} = 0$。\n这会得到新的搜索方向 $p_1 = r_1 + \\beta_0 p_0 = r_1$ 和 $\\tilde{p}_1 = \\tilde{r}_1 + \\beta_0 \\tilde{p}_0 = \\tilde{r}_1$。\n然后，下一个标量 $\\alpha_1$ 计算为 $\\alpha_1 = \\frac{\\tilde{r}_1^T r_1}{\\tilde{p}_1^T A p_1} = \\frac{0}{\\tilde{r}_1^T A r_1}$。\n分母项为 $\\tilde{r}_1^T A r_1 = \\begin{pmatrix} 0  0  -1/2 \\end{pmatrix} \\begin{pmatrix} 2  0  1\\\\ 1  3  0\\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 0\\\\ -1/2\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0  0  -2 \\end{pmatrix} \\begin{pmatrix} 0\\\\ -1/2\\\\ 0 \\end{pmatrix} = 0$。\n由于 $\\alpha_1$ 的分子和分母都为零，这构成了 BiCG 算法的严重崩溃。\n\n接下来，我们应用 BiCGSTAB 方法。初始残差为 $r_0 = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix}$。给定的固定影子残差为 $\\hat{r} = \\begin{pmatrix} 1\\\\ 1\\\\ 0 \\end{pmatrix}$。\n标准算法以初始值 $\\rho_0=1$, $\\alpha_0=1$, $\\omega_0=1$, $p_0=0$ 和 $v_0=0$ 开始。我们执行第一次迭代（$k=1$）。\n\n1. 计算 $\\rho_1 = \\hat{r}^T r_0$：\n$\\rho_1 = \\begin{pmatrix} 1  1  0 \\end{pmatrix} \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} = 1$。\n\n2. 计算 $\\beta_1 = \\frac{\\rho_1}{\\rho_0} \\frac{\\alpha_0}{\\omega_0}$：\n$\\beta_1 = \\frac{1}{1} \\cdot \\frac{1}{1} = 1$。\n\n3. 计算 $p_1 = r_0 + \\beta_1 (p_0 - \\omega_0 v_0)$：\n$p_1 = r_0 + 1 (0 - 1 \\cdot 0) = r_0 = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix}$。\n\n4. 计算 $v_1 = A p_1$：\n$v_1 = A r_0 = \\begin{pmatrix} 2  0  1\\\\ 1  3  0\\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2\\\\ 1\\\\ 0 \\end{pmatrix}$。\n\n5. 计算 $\\alpha_1 = \\frac{\\rho_1}{\\hat{r}^T v_1}$：\n$\\hat{r}^T v_1 = \\begin{pmatrix} 1  1  0 \\end{pmatrix} \\begin{pmatrix} 2\\\\ 1\\\\ 0 \\end{pmatrix} = (1)(2) + (1)(1) + (0)(0) = 3$。\n$\\alpha_1 = \\frac{1}{3}$。\n\n6. 计算临时残差 $s_1 = r_0 - \\alpha_1 v_1$：\n$s_1 = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} - \\frac{1}{3} \\begin{pmatrix} 2\\\\ 1\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 - 2/3\\\\ 0 - 1/3\\\\ 0 - 0 \\end{pmatrix} = \\begin{pmatrix} 1/3\\\\ -1/3\\\\ 0 \\end{pmatrix}$。\n\n7. 计算 $t_1 = A s_1$：\n$t_1 = \\begin{pmatrix} 2  0  1\\\\ 1  3  0\\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 1/3\\\\ -1/3\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2(1/3) + 0(-1/3) + 1(0) \\\\ 1(1/3) + 3(-1/3) + 0(0) \\\\ 0(1/3) + 0(-1/3) + 4(0) \\end{pmatrix} = \\begin{pmatrix} 2/3\\\\ 1/3 - 1\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2/3\\\\ -2/3\\\\ 0 \\end{pmatrix}$。\n\n8. 计算平滑参数 $\\omega_1 = \\frac{t_1^T s_1}{t_1^T t_1}$：\n分子是 $t_1^T s_1 = \\begin{pmatrix} 2/3  -2/3  0 \\end{pmatrix} \\begin{pmatrix} 1/3\\\\ -1/3\\\\ 0 \\end{pmatrix} = (\\frac{2}{3})(\\frac{1}{3}) + (\\frac{-2}{3})(\\frac{-1}{3}) = \\frac{2}{9} + \\frac{2}{9} = \\frac{4}{9}$。\n分母是 $t_1^T t_1 = \\begin{pmatrix} 2/3  -2/3  0 \\end{pmatrix} \\begin{pmatrix} 2/3\\\\ -2/3\\\\ 0 \\end{pmatrix} = (\\frac{2}{3})^2 + (\\frac{-2}{3})^2 = \\frac{4}{9} + \\frac{4}{9} = \\frac{8}{9}$。\n$\\omega_1 = \\frac{4/9}{8/9} = \\frac{4}{8} = \\frac{1}{2}$。\n\n平滑参数 $\\omega_1$ 的值为 $\\frac{1}{2}$。这表明，通过适当选择 $\\hat{r}$，BiCGSTAB 算法不会崩溃，并能继续进行计算。", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "2376326"}, {"introduction": "尽管BiCGSTAB比BiCG更稳健，但其收敛过程并非总是平滑的，实践中常会观察到残差范数在最终下降前出现短暂增大的“尖峰”。本练习 [@problem_id:2376279] 深入探究了这一现象，通过分析一个具有特殊特征值分布的系统，揭示了离群特征值如何导致这些尖峰的产生。这有助于你理解该方法的实际性能特点，并能对收敛行为做出更准确的预判。", "problem": "一个线性系统由一个离散化的偏微分方程产生，需要用无预处理的双共轭梯度稳定 (BiCGSTAB) 方法在精确算术下求解。考虑实对角矩阵\n$$\nA = \\operatorname{diag}(L, 1, 1, \\dots, 1) \\in \\mathbb{R}^{m \\times m},\n$$\n其中 $m \\geq 2$ 且 $L > 0$。令初始猜测为 $x_{0} = 0$，并选择右端项使得初始残差为\n$$\nr_{0} = b - A x_{0} = b = \\begin{pmatrix} 1 \\\\ 1 \\\\ \\vdots \\\\ 1 \\end{pmatrix} \\in \\mathbb{R}^{m}.\n$$\n使用标准欧几里得内积 $(u, v) = u^{\\mathsf{T}} v$ 和欧几里得范数 $\\|v\\|_{2} = \\sqrt{(v, v)}$。令影子残差为 $\\,\\hat{r} = r_{0}$。\n\n定义第一次 BiCGSTAB 迭代如下\n$$\np_{1} = r_{0}, \\quad v_{1} = A p_{1}, \\quad \\alpha_{1} = \\frac{(\\hat{r}, r_{0})}{(\\hat{r}, v_{1})}, \\quad s_{1} = r_{0} - \\alpha_{1} v_{1},\n$$\n$$\nt_{1} = A s_{1}, \\quad \\omega_{1} = \\frac{(t_{1}, s_{1})}{(t_{1}, t_{1})}, \\quad r_{1} = s_{1} - \\omega_{1} t_{1}.\n$$\n\n在特征值分布由一个极端离群值 $L$ 和一个在 $1$ 处的紧密簇构成的区域中（即，取极限 $L \\to \\infty$ 且 $m$ 固定），定义尖峰放大因子\n$$\nQ(m) \\equiv \\lim_{L \\to \\infty} \\frac{\\|s_{1}\\|_{2}}{\\|r_{1}\\|_{2}}.\n$$\n\n推导 $Q(m)$ 作为 $m$ 的函数的精确闭式表达式。你的最终答案必须是单一的解析表达式。不包含任何单位。无需四舍五入。", "solution": "该问题要求推导尖峰放大因子 $Q(m)$ 的闭式表达式，其定义为 BiCGSTAB 方法第一次迭代中两个中间残差 $s_1$ 和 $r_1$ 的范数之比的极限。该极限是在系统矩阵 $A$ 的单个离群特征值 $L$ 趋于无穷大时计算的。我们将通过对所有涉及的量进行直接和系统的计算来推导。\n\n给定参数如下：\n矩阵 $A = \\operatorname{diag}(L, 1, 1, \\dots, 1) \\in \\mathbb{R}^{m \\times m}$，其中 $m \\geq 2$ 且 $L > 0$。\n初始猜测为 $x_{0} = 0$。\n初始残差为 $r_{0} = b = \\begin{pmatrix} 1  1  \\dots  1 \\end{pmatrix}^{\\mathsf{T}}$。我们用 $\\mathbf{1}_{m}$ 表示这个全一向量。\n影子残差为 $\\hat{r} = r_{0} = \\mathbf{1}_{m}$。\n\n第一步是计算第一次 BiCGSTAB 迭代中定义的各个量。\n\n1.  计算搜索方向 $p_1$ 和向量 $v_1 = A p_1$。\n    根据标准算法，我们设置 $p_1 = r_0$。\n    $$p_{1} = r_{0} = \\mathbf{1}_{m}$$\n    然后，$v_{1}$ 计算如下：\n    $$v_{1} = A p_{1} = A r_{0} = \\operatorname{diag}(L, 1, \\dots, 1) \\begin{pmatrix} 1 \\\\ 1 \\\\ \\vdots \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} L \\\\ 1 \\\\ \\vdots \\\\ 1 \\end{pmatrix}$$\n    $v_1$ 的第一个分量是 $L$，其余的 $m-1$ 个分量都是 $1$。\n\n2.  计算系数 $\\alpha_1$。\n    $\\alpha_{1} = \\frac{(\\hat{r}, r_{0})}{(\\hat{r}, v_{1})}$。由于 $\\hat{r}=r_0$，这可以简化为 $\\alpha_1 = \\frac{(r_0, r_0)}{(r_0, v_1)}$。\n    所需的内积为：\n    $$(\\hat{r}, r_{0}) = (r_{0}, r_{0}) = r_{0}^{\\mathsf{T}} r_{0} = \\sum_{i=1}^{m} 1^2 = m$$\n    $$(\\hat{r}, v_{1}) = (r_{0}, v_{1}) = r_{0}^{\\mathsf{T}} v_{1} = \\begin{pmatrix} 1  1  \\dots  1 \\end{pmatrix} \\begin{pmatrix} L \\\\ 1 \\\\ \\vdots \\\\ 1 \\end{pmatrix} = 1 \\cdot L + (m-1) \\cdot 1 = L + m - 1$$\n    因此，$\\alpha_1$ 是：\n    $$\\alpha_{1} = \\frac{m}{L + m - 1}$$\n\n3.  计算中间残差 $s_1 = r_0 - \\alpha_1 v_1$。\n    $$s_{1} = \\mathbf{1}_{m} - \\frac{m}{L + m - 1} \\begin{pmatrix} L \\\\ 1 \\\\ \\vdots \\\\ 1 \\end{pmatrix}$$\n    我们计算 $s_1$ 的分量：\n    第一个分量是：\n    $$s_{1,1} = 1 - \\alpha_1 L = 1 - \\frac{m L}{L + m - 1} = \\frac{L + m - 1 - m L}{L + m - 1} = \\frac{(1-m)L + m - 1}{L + m - 1} = \\frac{-(m-1)L + (m-1)}{L + m - 1} = \\frac{(m-1)(1-L)}{L + m - 1}$$\n    对于 $i \\in \\{2, \\dots, m\\}$，分量是：\n    $$s_{1,i} = 1 - \\alpha_1 \\cdot 1 = 1 - \\frac{m}{L + m - 1} = \\frac{L + m - 1 - m}{L + m - 1} = \\frac{L-1}{L+m-1}$$\n    我们可以提出一个公因子，将 $s_1$ 写得更紧凑：\n    $$s_{1} = \\frac{L-1}{L+m-1} \\begin{pmatrix} -(m-1) \\\\ 1 \\\\ \\vdots \\\\ 1 \\end{pmatrix}$$\n\n4.  计算 $t_1 = A s_1$ 和系数 $\\omega_1$。\n    $$t_{1} = A s_{1} = \\frac{L-1}{L+m-1} \\operatorname{diag}(L, 1, \\dots, 1) \\begin{pmatrix} -(m-1) \\\\ 1 \\\\ \\vdots \\\\ 1 \\end{pmatrix} = \\frac{L-1}{L+m-1} \\begin{pmatrix} -L(m-1) \\\\ 1 \\\\ \\vdots \\\\ 1 \\end{pmatrix}$$\n    系数 $\\omega_1$ 由 $\\omega_{1} = \\frac{(t_{1}, s_{1})}{(t_{1}, t_{1})}$ 给出。\n    让我们计算内积：\n    $$(t_{1}, s_{1}) = \\left(\\frac{L-1}{L+m-1}\\right)^2 \\left( (-L(m-1))(-(m-1)) + \\sum_{i=2}^{m} 1 \\cdot 1 \\right) = \\left(\\frac{L-1}{L+m-1}\\right)^2 (L(m-1)^2 + m-1)$$\n    $$(t_{1}, s_{1}) = \\left(\\frac{L-1}{L+m-1}\\right)^2 (m-1)(L(m-1)+1)$$\n    $$(t_{1}, t_{1}) = \\|t_1\\|_2^2 = \\left(\\frac{L-1}{L+m-1}\\right)^2 \\left( (-L(m-1))^2 + \\sum_{i=2}^{m} 1^2 \\right) = \\left(\\frac{L-1}{L+m-1}\\right)^2 (L^2(m-1)^2 + m-1)$$\n    $$(t_{1}, t_{1}) = \\left(\\frac{L-1}{L+m-1}\\right)^2 (m-1)(L^2(m-1)+1)$$\n    因此，系数 $\\omega_1$ 是：\n    $$\\omega_{1} = \\frac{\\left(\\frac{L-1}{L+m-1}\\right)^2 (m-1)(L(m-1)+1)}{\\left(\\frac{L-1}{L+m-1}\\right)^2 (m-1)(L^2(m-1)+1)} = \\frac{L(m-1)+1}{L^2(m-1)+1}$$\n\n5.  计算第一次迭代的最终残差 $r_1 = s_1 - \\omega_1 t_1$。\n    首先，我们逐分量地确定向量 $s_1 - \\omega_1 t_1$。\n    第一个分量：\n    $$s_{1,1} - \\omega_{1} t_{1,1} = \\frac{(L-1)(-(m-1))}{L+m-1} - \\frac{L(m-1)+1}{L^2(m-1)+1} \\frac{(L-1)(-L(m-1))}{L+m-1}$$\n    $$= \\frac{(L-1)(-(m-1))}{L+m-1} \\left(1 - \\frac{L(L(m-1)+1)}{L^2(m-1)+1}\\right) = \\frac{-(L-1)(m-1)}{L+m-1} \\left(\\frac{L^2(m-1)+1 - L^2(m-1)-L}{L^2(m-1)+1}\\right)$$\n    $$= \\frac{-(L-1)(m-1)}{L+m-1} \\frac{1-L}{L^2(m-1)+1} = \\frac{(L-1)^2(m-1)}{(L+m-1)(L^2(m-1)+1)}$$\n    对于 $i \\in \\{2, \\dots, m\\}$，分量是：\n    $$s_{1,i} - \\omega_{1} t_{1,i} = \\frac{L-1}{L+m-1} - \\frac{L(m-1)+1}{L^2(m-1)+1} \\frac{L-1}{L+m-1} = \\frac{L-1}{L+m-1} \\left(1 - \\frac{L(m-1)+1}{L^2(m-1)+1}\\right)$$\n    $$= \\frac{L-1}{L+m-1} \\left(\\frac{L^2(m-1)+1 - L(m-1)-1}{L^2(m-1)+1}\\right) = \\frac{L-1}{L+m-1} \\frac{L^2(m-1)-L(m-1)}{L^2(m-1)+1}$$\n    $$= \\frac{(L-1)L(m-1)(L-1)}{(L+m-1)(L^2(m-1)+1)} = \\frac{L(L-1)^2(m-1)}{(L+m-1)(L^2(m-1)+1)}$$\n    结合这些分量，我们得到向量 $r_1$：\n    $$r_{1} = \\frac{(L-1)^2(m-1)}{(L+m-1)(L^2(m-1)+1)} \\begin{pmatrix} 1 \\\\ L \\\\ \\vdots \\\\ L \\end{pmatrix}$$\n\n6.  计算范数 $\\|s_1\\|_2$ 和 $\\|r_1\\|_2$。\n    对于 $\\|s_1\\|_2$：\n    $$\\|s_1\\|_2^2 = \\left(\\frac{L-1}{L+m-1}\\right)^2 \\left( (-(m-1))^2 + (m-1) \\cdot 1^2 \\right) = \\left(\\frac{L-1}{L+m-1}\\right)^2 ((m-1)^2 + m-1)$$\n    $$\\|s_1\\|_2^2 = \\left(\\frac{L-1}{L+m-1}\\right)^2 m(m-1)$$\n    对于大的 $L$，$L-1 > 0$，所以我们取正平方根：\n    $$\\|s_1\\|_2 = \\frac{L-1}{L+m-1} \\sqrt{m(m-1)}$$\n    对于 $\\|r_1\\|_2$：\n    $$\\|r_1\\|_2^2 = \\left(\\frac{(L-1)^2(m-1)}{(L+m-1)(L^2(m-1)+1)}\\right)^2 \\left( 1^2 + (m-1) L^2 \\right)$$\n    注意到项 $1+(m-1)L^2 = L^2(m-1)+1$。这导致一个消去：\n    $$\\|r_1\\|_2^2 = \\frac{(L-1)^4(m-1)^2}{(L+m-1)^2(L^2(m-1)+1)^2} (L^2(m-1)+1) = \\frac{(L-1)^4(m-1)^2}{(L+m-1)^2(L^2(m-1)+1)}$$\n    取平方根：\n    $$\\|r_1\\|_2 = \\frac{(L-1)^2(m-1)}{(L+m-1)\\sqrt{L^2(m-1)+1}}$$\n\n7.  计算比率并取极限以求得 $Q(m)$。\n    比率为：\n    $$\\frac{\\|s_1\\|_2}{\\|r_1\\|_2} = \\frac{\\frac{L-1}{L+m-1}\\sqrt{m(m-1)}}{\\frac{(L-1)^2(m-1)}{(L+m-1)\\sqrt{L^2(m-1)+1}}} = \\frac{(L-1)\\sqrt{m(m-1)}}{1} \\cdot \\frac{\\sqrt{L^2(m-1)+1}}{(L-1)^2(m-1)}$$\n    $$= \\frac{\\sqrt{m}\\sqrt{m-1}}{(L-1)(m-1)} \\sqrt{L^2(m-1)+1} = \\frac{\\sqrt{m}}{(L-1)\\sqrt{m-1}} \\sqrt{L^2(m-1)+1}$$\n    $$= \\frac{\\sqrt{m}}{\\sqrt{m-1}} \\cdot \\frac{\\sqrt{L^2(m-1)+1}}{L-1}$$\n    现在我们取 $L \\to \\infty$ 的极限：\n    $$Q(m) = \\lim_{L \\to \\infty} \\frac{\\|s_1\\|_2}{\\|r_1\\|_2} = \\frac{\\sqrt{m}}{\\sqrt{m-1}} \\lim_{L \\to \\infty} \\frac{\\sqrt{L^2(m-1)+1}}{L-1}$$\n    极限计算如下：\n    $$\\lim_{L \\to \\infty} \\frac{\\sqrt{L^2(m-1)+1}}{L-1} = \\lim_{L \\to \\infty} \\frac{\\sqrt{L^2(m-1+1/L^2)}}{L(1-1/L)} = \\lim_{L \\to \\infty} \\frac{L\\sqrt{m-1+1/L^2}}{L(1-1/L)}$$\n    $$= \\lim_{L \\to \\infty} \\frac{\\sqrt{m-1+1/L^2}}{1-1/L} = \\frac{\\sqrt{m-1+0}}{1-0} = \\sqrt{m-1}$$\n    将此结果代回 $Q(m)$ 的表达式中：\n    $$Q(m) = \\frac{\\sqrt{m}}{\\sqrt{m-1}} \\cdot \\sqrt{m-1} = \\sqrt{m}$$\n推导完成。尖峰放大因子的精确闭式表达式为 $\\sqrt{m}$。", "answer": "$$\\boxed{\\sqrt{m}}$$", "id": "2376279"}]}