{"hands_on_practices": [{"introduction": "单纯形法的核心在于其迭代过程，每一次迭代都通过“轴心旋转”操作从一个基本可行解移动到另一个，以期改进目标函数值。这个练习将带你完成一次完整的轴心旋转，这是掌握单纯形法计算机制的基础。通过解决一个市场营销预算分配的假设性问题，你将亲手实践如何选择入基和出基变量，并更新单纯形表 [@problem_id:2221017]。", "problem": "一家市场分析公司正在使用线性规划来确定客户广告预算的最优分配。其目标是最大化客户覆盖率。决策变量是 $x_1$（在社交媒体上购买的广告单元数量）和 $x_2$（在搜索引擎上购买的广告单元数量）。该问题已被表述为一个标准最大化问题，其初始单纯形表如下所示。变量 $s_1$ 和 $s_2$ 是松弛变量，分别代表未使用的预算和员工工时。变量 $Z$ 代表待最大化的总客户覆盖率。\n\n表的各行对应于目标函数 $Z$ 以及以 $s_1$ 和 $s_2$ 为基变量的两个约束条件。各列对应于变量 $Z, x_1, x_2, s_1, s_2$ 和右端项 (RHS) 值。\n\n初始单纯形表为：\n$$\n\\begin{array}{c|cccccc}\n\\text{基变量}  Z  x_1  x_2  s_1  s_2  \\text{RHS} \\\\\n\\hline\nZ  1  -5  -4  0  0  0 \\\\\ns_1  0  10  8  1  0  80 \\\\\ns_2  0  2  3  0  1  24 \\\\\n\\end{array}\n$$\n\n根据最大化问题的标准单纯形算法，执行一次完整的枢轴运算。确定 Z 行中 $x_2$ 的系数、Z 行中 $s_1$ 的系数以及目标函数 $Z$ 的新值（Z 行的 RHS 值）。\n\n你的答案应为一组按指定顺序排列的三个数值，以行矩阵的形式呈现：（$x_2$ 的系数，$s_1$ 的系数，$Z$ 的值）。", "solution": "我们应用最大化问题的标准单纯形枢轴规则。\n\n1) 确定进基变量：在 Z 行中，决策变量的最负系数是 $x_{1}$ 的 $-5$，因此 $x_{1}$ 进基。\n\n2) 对 $x_{1}$ 列执行最小比值检验以选择出基变量：\n$$\n\\frac{80}{10}=8 \\quad \\text{对于 } s_{1}, \\qquad \\frac{24}{2}=12 \\quad \\text{对于 } s_{2}.\n$$\n最小比值为 $8$，因此 $s_{1}$ 出基。枢轴元素是 $s_{1}$ 行和 $x_{1}$ 列中的 $10$。\n\n3) 进行枢轴运算，使枢轴元素变为 1，并从其他行中消去 $x_{1}$。\n\n将枢轴行（$s_{1}$ 行）除以 $10$ 进行归一化：\n$$\ns_{1}\\text{-行}: \\quad [0,\\;10,\\;8,\\;1,\\;0\\;|\\;80] \\;\\to\\; [0,\\;1,\\;\\tfrac{4}{5},\\;\\tfrac{1}{10},\\;0\\;|\\;8].\n$$\n\n将新的 $s_{1}$ 行乘以 $5$ 加到 Z 行上，以消去 Z 行中的 $x_{1}$：\n$$\nZ\\text{-行}: \\quad [1,\\;-5,\\;-4,\\;0,\\;0\\;|\\;0] + 5\\cdot[0,\\;1,\\;\\tfrac{4}{5},\\;\\tfrac{1}{10},\\;0\\;|\\;8]\n= [1,\\;0,\\;0,\\;\\tfrac{1}{2},\\;0\\;|\\;40].\n$$\n\n（从 $s_{2}$ 行中消去 $x_{1}$ 是完整枢轴运算的一部分，但对于求解所要求的 Z 行系数不是必需的。）\n\n因此，在这次单次枢轴运算后，Z 行中 $x_{2}$ 的系数是 $0$，Z 行中 $s_{1}$ 的系数是 $\\tfrac{1}{2}$，新的目标函数值 $Z$（Z 行的 RHS）是 $40$。", "answer": "$$\\boxed{\\begin{pmatrix}0  \\frac{1}{2}  40\\end{pmatrix}}$$", "id": "2221017"}, {"introduction": "在现实世界的优化问题中，我们设定的约束条件有时可能是相互矛盾的，导致问题无解。单纯形法如何识别这种情况？“两阶段法”提供了一个优雅的解决方案，它通过构造一个辅助的“第一阶段”问题来专门判断原始问题是否存在可行解 [@problem_id:2443911]。本练习通过一个假设的饮食规划问题，让你计算第一阶段的目标函数最优值，并理解这个值如何揭示问题的不可行性。", "problem": "一家贸易公司的食堂经理正在设计一份低钠、高蛋白的膳食计划，使用两种食物，记作 $x_{1}$ 和 $x_{2}$，其中 $x_{1}$ 和 $x_{2}$ 是每种食物的份数，且必须满足 $x_{1} \\geq 0$ 和 $x_{2} \\geq 0$。每份食物 $x_{1}$ 提供 $5$ 克蛋白质和 $4$ 克钠，而每份食物 $x_{2}$ 提供 $2$ 克蛋白质和 $3$ 克钠。饮食要求是：\n- 总蛋白质摄入量至少为 $20$ 克，且\n- 总钠摄入量最多为 $5$ 克。\n\n在两阶段单纯形法框架下，将此可行性问题表述为一个线性规划问题。在第一阶段，仅为带有 $\\geq$ 算子的约束引入人工变量，并将人工变量之和的最小化作为第一阶段的目标。该问题第一阶段目标的最优值是多少？请用克作答。无需四舍五入，最终答案必须是一个数字。", "solution": "在尝试求解之前，对问题陈述进行严格验证。\n\n**步骤 1：提取已知条件**\n- 决策变量：$x_{1}, x_{2}$，代表两种食物的份数。\n- 非负性：$x_{1} \\geq 0$, $x_{2} \\geq 0$。\n- 食物 $1$（每份）：$5$ 克蛋白质，$4$ 克钠。\n- 食物 $2$（每份）：$2$ 克蛋白质，$3$ 克钠。\n- 约束 $1$：总蛋白质摄入量必须至少为 $20$ 克。\n- 约束 $2$：总钠摄入量最多为 $5$ 克。\n- 任务：构建并求解第一阶段线性规划，以找到第一阶段目标的最优值。\n- 第一阶段设置：为 '$\\geq$' 约束引入一个人工变量，并最小化其值。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是线性规划的一个标准应用，特别是两阶段单纯形法，用于确定一个线性不等式组的可行性。该问题在科学上是合理的，提法得当且客观。这些约束虽然最终被发现是相互矛盾的（即可行域为空），但其表述方式使得关于第一阶段结果的问题变得有意义。第一阶段的目的正是为了检测这种不可行性。要求以克为单位作答是量纲一致的，因为人工变量继承了其所添加的约束的单位。\n\n**结论：问题有效。**\n\n我们继续求解。\n\n首先，我们将问题形式化为一个线性规划。决策变量是 $x_{1}$ 和 $x_{2}$。约束条件源于营养需求。\n\n蛋白质约束为：\n$$5x_{1} + 2x_{2} \\geq 20$$\n钠约束为：\n$$4x_{1} + 3x_{2} \\leq 5$$\n非负约束为：\n$$x_{1} \\geq 0, \\quad x_{2} \\geq 0$$\n\n为了应用单纯形法，我们必须通过引入松弛变量和剩余变量，将这些不等式转换成标准形式（等式）。\n从 '$\\geq$' 约束中减去一个剩余变量 $s_{1} \\geq 0$：\n$$5x_{1} + 2x_{2} - s_{1} = 20$$\n向 '$\\leq$' 约束中加入一个松弛变量 $s_{2} \\geq 0$：\n$$4x_{1} + 3x_{2} + s_{2} = 5$$\n\n得到的方程组为：\n$$5x_{1} + 2x_{2} - s_{1} = 20$$\n$$4x_{1} + 3x_{2} + s_{2} = 5$$\n$$x_{1}, x_{2}, s_{1}, s_{2} \\geq 0$$\n\n初始基本可行解不是立即可得的。对于第一个方程，如果我们设置非基变量 $x_{1}=0$ 和 $x_{2}=0$，我们得到 $-s_{1}=20$，即 $s_{1}=-20$，这违反了 $s_1$ 的非负性。因此，按照处理 '$\\geq$' 约束的标准程序，我们在第一个方程中引入一个人工变量 $a_{1} \\geq 0$。第二个方程中的松弛变量 $s_{2}$ 可以作为基变量。\n\n第一阶段问题的方程组是：\n$$5x_{1} + 2x_{2} - s_{1} + a_{1} = 20$$\n$$4x_{1} + 3x_{2} + s_{2} = 5$$\n$$x_{1}, x_{2}, s_{1}, s_{2}, a_{1} \\geq 0$$\n\n第一阶段的目标是最小化人工变量之和。这里，我们只有一个，所以我们最小化 $w = a_{1}$。如果 $w$ 的最小值大于零，则原问题是不可行的。\n\n我们用非基变量来表示目标函数 $w$。从第一个约束得出：\n$$a_{1} = 20 - 5x_{1} - 2x_{2} + s_{1}$$\n所以，目标是最小化 $w = 20 - 5x_{1} - 2x_{2} + s_{1}$。这等同于在单纯形表中建立目标行。初始基变量是 $a_{1}$ 和 $s_{2}$。非基变量是 $x_{1}$、$x_{2}$ 和 $s_{1}$。\n\n第一阶段最小化问题的初始单纯形表构建如下。目标行 ($z_{j}-c_{j}$) 包含用非基变量表示的目标函数 $w$ 的系数。目标是 $w + 5x_1 + 2x_2 - s_1 = 20$。\n当前基本解为：$x_1=0, x_2=0, s_1=0$，得出 $a_1=20, s_2=5$。初始目标值为 $w=20$。\n\n**初始单纯形表：**\n$$\n\\begin{array}{c|c|ccccc|c}\n\\text{基}  w  x_{1}  x_{2}  s_{1}  a_{1}  s_{2}  \\text{右端项} \\\\\n\\hline\na_{1}  0  5  2  -1  1  0  20 \\\\\ns_{2}  0  4  3  0  0  1  5 \\\\\n\\hline\n\\text{目标}  1  5  2  -1  0  0  20\n\\end{array}\n$$\n对于最小化问题，我们选择目标行 ($z_j - c_j$) 中具有最大正系数的变量进入基。这个变量是 $x_{1}$，其系数为 $5$。\n\n为了确定离基变量，我们进行最小比值检验：\n对于 $a_{1}$ 行：$\\frac{20}{5} = 4$。\n对于 $s_{2}$ 行：$\\frac{5}{4} = 1.25$。\n\n最小比值为 $1.25$，对应于 $s_{2}$ 行。因此，$s_{2}$ 离开基，$x_{1}$ 进入基。主元是 $4$。我们执行一次主元运算。\n\n首先，将主元行（$s_2$ 行）除以主元（$4$）：\n$$R_{2, \\text{new}} = R_{2} / 4 \\implies [1, \\frac{3}{4}, 0, 0, \\frac{1}{4} | \\frac{5}{4}]$$\n这是基变量 $x_{1}$ 的新行。\n\n接下来，我们更新其他行，使它们在主元列中的值为零。\n更新 $a_{1}$ 行：$R_{1, \\text{new}} = R_{1} - 5 \\times R_{2, \\text{new}}$\n$$R_{1, \\text{new}} = [5, 2, -1, 1, 0 | 20] - 5 \\times [1, \\frac{3}{4}, 0, 0, \\frac{1}{4} | \\frac{5}{4}]$$\n$$R_{1, \\text{new}} = [0, 2 - \\frac{15}{4}, -1, 1, -\\frac{5}{4} | 20 - \\frac{25}{4}] = [0, -\\frac{7}{4}, -1, 1, -\\frac{5}{4} | \\frac{55}{4}]$$\n\n更新目标行：$R_{\\text{obj, new}} = R_{\\text{obj}} - 5 \\times R_{2, \\text{new}}$\n$$R_{\\text{obj, new}} = [5, 2, -1, 0, 0 | 20] - 5 \\times [1, \\frac{3}{4}, 0, 0, \\frac{1}{4} | \\frac{5}{4}]$$\n$$R_{\\text{obj, new}} = [0, 2 - \\frac{15}{4}, -1, 0, -\\frac{5}{4} | 20 - \\frac{25}{4}] = [0, -\\frac{7}{4}, -1, 0, -\\frac{5}{4} | \\frac{55}{4}]$$\n\n**一次迭代后的单纯形表：**\n$$\n\\begin{array}{c|c|ccccc|c}\n\\text{基}  w  x_{1}  x_{2}  s_{1}  a_{1}  s_{2}  \\text{右端项} \\\\\n\\hline\na_{1}  0  0  -\\frac{7}{4}  -1  1  -\\frac{5}{4}  \\frac{55}{4} \\\\\nx_{1}  0  1  \\frac{3}{4}  0  0  \\frac{1}{4}  \\frac{5}{4} \\\\\n\\hline\n\\text{目标}  1  0  -\\frac{7}{4}  -1  0  -\\frac{5}{4}  \\frac{55}{4}\n\\end{array}\n$$\n当前基本解为 $a_{1} = \\frac{55}{4}$，$x_{1} = \\frac{5}{4}$。目标值为 $w = \\frac{55}{4}$。\n我们检查目标行系数 ($z_{j}-c_{j}$)：$[0, -\\frac{7}{4}, -1, 0, -\\frac{5}{4}]$。所有系数都小于或等于零。这满足了最小化问题的最优性条件。\n因此，单纯形算法终止。\n\n第一阶段目标函数的最优（最小）值为 $w^* = a_{1} = \\frac{55}{4}$。\n由于 $w^*  0$，我们得出结论，原问题没有可行解。然而，问题要求的是第一阶段目标的最优值，我们已经找到了这个值。\n\n该值为 $\\frac{55}{4} = 13.75$。人工变量 $a_{1}$ 被添加到以克为单位的蛋白质约束中。因此，值 $a_1$ 的单位是克。在给定其他约束的情况下，$a_1$ 的最小值代表了满足蛋白质需求时不可避免的最小亏欠量。在钠含量限制下可实现的最大蛋白质为 $5(\\frac{5}{4}) + 2(0) = \\frac{25}{4}$ 克，这比要求的 $20$ 克少了 $\\frac{55}{4}$ 克。这证实了我们的结果。", "answer": "$$\\boxed{\\frac{55}{4}}$$", "id": "2443911"}, {"introduction": "一个常见的误解是：无界的可行域必然导致无界的目标函数。这个练习旨在通过构造一个清晰的反例来纠正这一观念，从而加深你对线性规划基本原理的理解 [@problem_id:2443959]。你将需要从第一性原理出发，分析可行域的几何形状与目标函数梯度 $c$ 之间的关系，并解释为何即使可以在可行域内沿某个方向 $d$ 无限移动，只要满足 $c^T d \\le 0$，目标函数的值就不会无界增长。", "problem": "在线性规划中，一个常见的误解是无界可行域必然导致目标函数无界。请仅使用基本原理，构造并分析一个二维线性规划问题，作为对此论断的反例。\n\n从以下基本定义出发：\n- 可行域是满足问题所有线性约束的点的集合。\n- 如果存在一个方向向量，沿着该向量可以任意远地移动而始终保持在集合内，则该集合是无界的。\n- 线性目标函数是关于决策向量 $x$ 的线性形式 $c^{\\top}x$。\n\n考虑以下包含两个变量 $x_{1}$ 和 $x_{2}$ 的线性规划问题：\n- 决策变量：$x_{1} \\geq 0$, $x_{2} \\geq 0$。\n- 约束条件：$x_{1} \\leq 1$。\n- 目标：最大化 $z = x_{1}$。\n\n任务：\n1. 使用以上定义，直接根据约束集论证可行域是无界的。\n2. 仅利用目标函数的线性性质和约束条件 $x_{1} \\leq 1$，确定目标函数的最优值。\n3. 解释为何在此例中，可行域的无界性并未导致目标函数的无界性，并指出存在一个目标函数不增加的可行方向。\n\n请给出最大目标值作为最终答案。答案请以精确数值表示，无需四舍五入。", "solution": "该问题提出了一个线性规划，并要求进行分析，以证明无界可行域不一定意味着目标函数无界。我们将严格遵守基本原理和所给定义，系统地完成每一项任务。\n\n该线性规划问题由决策变量 $x_1$ 和 $x_2$ 定义如下：\n最大化 $z = x_1$\n约束条件：\n$x_1 \\leq 1$\n$x_1 \\geq 0$\n$x_2 \\geq 0$\n\n令可行域用集合 $S$ 表示。一个点 $p = (x_1, x_2)$ 属于 $S$ 当且仅当其坐标同时满足所有三个约束条件。因此，$S = \\{ (x_1, x_2) \\in \\mathbb{R}^2 \\mid 0 \\leq x_1 \\leq 1, x_2 \\geq 0 \\}$。该集合表示笛卡尔平面第一象限中的一个半无限带状区域。\n\n**任务1：可行域的无界性**\n\n为了证明可行域 $S$ 是无界的，我们必须根据所给定义证明：存在一个方向向量，沿着该向量可以任意远地移动而始终保持在集合内。\n\n让我们选择一个点 $p_0 \\in S$。一个简单的选择是 $p_0 = (0, 0)$，它显然满足 $0 \\leq 0 \\leq 1$ 和 $0 \\geq 0$。\n现在，我们定义一个方向向量 $d = (0, 1)^T$。我们构造一条从 $p_0$ 点出发，方向为 $d$ 的射线。这条射线上的任意点可以由 $\\lambda \\geq 0$ 参数化表示为：\n$$ p(\\lambda) = p_0 + \\lambda d = (0, 0)^T + \\lambda (0, 1)^T = (0, \\lambda)^T $$\n任何这样一个点的坐标是 $(x_1, x_2) = (0, \\lambda)$。我们必须验证对于任意非负值 $\\lambda$，$p(\\lambda)$ 是否保持在可行域 $S$ 内。我们检查约束条件：\n1.  $x_1 \\leq 1$: 条件为 $0 \\leq 1$，成立。\n2.  $x_1 \\geq 0$: 条件为 $0 \\geq 0$，成立。\n3.  $x_2 \\geq 0$: 条件为 $\\lambda \\geq 0$，根据我们对参数 $\\lambda$ 的定义，该条件成立。\n\n由于对于任意 $\\lambda \\geq 0$，所有约束条件都得到满足，因此射线 $(0, \\lambda)$ 上的任意点都在可行集 $S$ 中。因为我们可以选择任意大的 $\\lambda$，所以我们可以沿着方向 $d=(0,1)^T$ 从原点移动任意远的距离，同时保持在 $S$ 内。因此，根据给定的定义，可行域 $S$ 是无界的。\n\n**任务2：目标函数的最优值**\n\n目标是在可行域 $S$ 中对所有点 $(x_1, x_2)$ 最大化函数 $z = x_1$。$S$ 的定义包含了约束条件 $x_1 \\leq 1$。这个约束条件本身就对 $x_1$ 的可能取值施加了一个上界。\n\n目标函数 $z$ 是一个仅依赖于变量 $x_1$ 的线性函数。要最大化 $z$，我们必须找到在可行域 $S$ 内所允许的 $x_1$ 的最大可能值。定义 $S$ 的约束条件是 $0 \\leq x_1 \\leq 1$ 和 $x_2 \\geq 0$。从约束条件 $x_1 \\leq 1$ 可以清楚地看出，$x_1$ 的值永远不会超过 $1$。\n\n这个最大值在可行域内存在吗？是的。考虑点 $p^* = (1, 0)$。\n- $p^*$ 是可行点吗？我们检查约束条件：$x_1 = 1$ 满足 $0 \\leq 1 \\leq 1$，$x_2 = 0$ 满足 $0 \\geq 0$。因此，$p^* \\in S$。\n- 在该点，目标函数值为 $z = x_1 = 1$。\n\n因为对于可行域 $S$ 中的任意点 $(x_1, x_2)$，都有 $x_1 \\leq 1$，所以目标函数 $z = x_1$ 的上界为 $1$。由于我们已经找到了一个可以达到该值的可行点，因此目标函数的最大值恰好是 $1$。\n\n**任务3：解释无界区域下的有界目标**\n\n在本例中，可行域的无界性并未导致目标函数的无界性。原因在于目标函数的梯度与可行域的无界方向之间的关系。\n\n目标函数为 $z = x_1$。这可以写成向量形式 $z = c^T x$，其中 $x = (x_1, x_2)^T$，成本向量（即 $z$ 的梯度）为 $c = (1, 0)^T$。\n\n在任务1中，我们确定了一个无界方向 $d = (0, 1)^T$。该向量表明我们可以在正 $x_2$ 方向上无限移动。要使目标函数无界，其值必须在沿此可行方向移动时无限增加。让我们分析目标函数沿此方向 $d$ 的变化。\n\n目标函数 $z$ 在方向 $d$ 上的变化率由方向导数给出，对于线性函数，方向导数就是点积 $c^T d$。我们来计算这个值：\n$$ c^T d = (1, 0) \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = (1)(0) + (0)(1) = 0 $$\n结果 $c^T d = 0$ 表明，沿着无界方向 $d$ 移动根本不会改变目标函数的值。无界方向与目标函数的增加方向是正交的。\n\n为了说明这一点，考虑任意可行点 $p_0 = (x_{1,0}, x_{2,0}) \\in S$。我们从该点沿方向 $d$ 移动。新点为 $p(\\lambda) = p_0 + \\lambda d = (x_{1,0}, x_{2,0} + \\lambda)$，其中 $\\lambda \\geq 0$。只要 $0 \\leq x_{1,0} \\leq 1$，这个新点对于所有 $\\lambda \\geq 0$ 都保持可行。该新点的目标值为：\n$$ z(p(\\lambda)) = c^T p(\\lambda) = c^T(p_0 + \\lambda d) = c^T p_0 + \\lambda(c^T d) $$\n由于我们已求得 $c^T d = 0$，上式简化为：\n$$ z(p(\\lambda)) = c^T p_0 = x_{1,0} $$\n这证实了在可行集内，沿着任何平行于 $x_2$ 轴的射线，目标函数的值保持不变。区域的无界性存在于一个目标函数不增加的方向上。目标函数是有界的，因为它的值仅取决于 $x_1$，而 $x_1$ 本身受到约束的限制。\n\n总而言之，对于一个具有无界可行域的线性规划问题，要使其目标函数无界，必须存在一个无界可行方向 $d$，满足 $c^T d  0$。在这个反例中，不存在这样的方向；对于唯一的无界方向，我们有 $c^T d = 0$。", "answer": "$$\\boxed{1}$$", "id": "2443959"}]}