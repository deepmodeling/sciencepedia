{"hands_on_practices": [{"introduction": "波动方程是物理学和工程学中模拟振动弦、声波或电磁波传播等现象的基石。这个练习将CFL条件直接应用于一个典型场景，让你能够为一个数值模拟计算出保证其稳定性的最大时间步长。通过这个实践，你将掌握连接物理波速 $c$、空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 的核心计算技能。", "problem": "一位工程师正在为一种特殊同轴电缆上的电压脉冲传播开发数值模拟。在一个简化的一维模型中，位置 $x$ 和时间 $t$ 处的电压 $u(x, t)$ 由波动方程决定：\n$$ \\frac{\\partial^2 u}{\\partial t^2} = 16 \\frac{\\partial^2 u}{\\partial x^2} $$\n其中 $x$ 的单位是米， $t$ 的单位是秒。\n\n该工程师决定使用标准的显式有限差分格式来数值求解这个方程。模拟所用的空间网格设置了均匀间距 $\\Delta x = 0.05$ 米。为了确保数值解的稳定性，时间步长 $\\Delta t$ 必须被仔细选择。\n\n在满足该格式的 Courant-Friedrichs-Lewy (CFL) 稳定性条件的情况下，可以使用的最大时间步长 $\\Delta t$ 是多少？答案以秒为单位，并四舍五入到三位有效数字。", "solution": "我们从标准形式的一维波动方程开始\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}}=c^{2}\\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\n通过与给定方程 $\\frac{\\partial^{2} u}{\\partial t^{2}}=16\\,\\frac{\\partial^{2} u}{\\partial x^{2}}$ 进行比较，可知波速为 $c=4$。\n\n在具有空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 的均匀网格上，一个标准的显式二阶有限差分（时间与空间中心差分）离散格式为\n$$\n\\frac{u_{j}^{n+1}-2u_{j}^{n}+u_{j}^{n-1}}{(\\Delta t)^{2}}=c^{2}\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{(\\Delta x)^{2}}.\n$$\n整理后得到更新公式\n$$\nu_{j}^{n+1}=2u_{j}^{n}-u_{j}^{n-1}+r^{2}\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right),\n$$\n其中 Courant 数定义为\n$$\nr=\\frac{c\\,\\Delta t}{\\Delta x}.\n$$\n\n为了确定稳定性约束，我们进行 von Neumann 分析，寻找形式为 $u_{j}^{n}=G^{n}\\exp(\\mathrm{i}\\kappa j\\Delta x)$ 的傅里叶模解，其中 $G$ 是放大因子， $\\kappa$ 是波数。代入更新公式可得\n$$\nG-2+G^{-1}=r^{2}\\left(e^{\\mathrm{i}\\kappa\\Delta x}-2+e^{-\\mathrm{i}\\kappa\\Delta x}\\right)=-4r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right).\n$$\n等价地，\n$$\nG+G^{-1}=2\\left[1-2r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right)\\right].\n$$\n这导出了色散关系\n$$\n\\cos(\\omega\\Delta t)=1-2r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right),\n$$\n因此，稳定性（要求对所有模都有 $|G|=1$）成立的条件是，对于所有的 $\\kappa$，方程右侧的值都位于区间 $[-1,1]$ 内。由于 $\\sin^{2}(\\cdot)\\in[0,1]$，对于所有 $\\kappa$，右侧的最小值为 $1-2r^{2}$。要求 $1-2r^{2}\\geq -1$ 可得\n$$\nr^{2}\\leq 1 \\quad\\Longleftrightarrow\\quad r\\leq 1.\n$$\n因此，该显式格式的 Courant-Friedrichs-Lewy 稳定性条件是\n$$\n\\frac{c\\,\\Delta t}{\\Delta x}\\leq 1 \\quad\\Longrightarrow\\quad \\Delta t\\leq \\frac{\\Delta x}{c}.\n$$\n\n对于给定的数据 $\\Delta x=0.05$ 和 $c=4$，因此最大稳定时间步长为\n$$\n\\Delta t_{\\max}=\\frac{0.05}{4}=0.0125.\n$$\n四舍五入到三位有效数字，该值为 $0.0125$ 秒。", "answer": "$$\\boxed{0.0125}$$", "id": "2139541"}, {"introduction": "在掌握了如何计算稳定性极限后，下一个关键是深入理解其物理意义。这个练习是一个思想实验，探讨了当库朗数 $\\sigma = \\frac{c \\Delta t}{\\Delta x}$ 恰好为1时的特殊情况。通过分析这个“理想”情景，你将对CFL条件建立起深刻的直观理解，明白它为何是物理信息传播速度与数值网格之间的基本关系。", "problem": "考虑一维线性平流方程，该方程模拟了某个量 $u$ 以恒定速度的输运过程。方程由下式给出：\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\n其中 $u(x, t)$ 是在位置 $x$ 和时间 $t$ 的输运量，$c$ 是一个恒定的正平流速度 ($c > 0$)。该方程在空间域 $x \\in (-\\infty, \\infty)$ 和时间 $t \\ge 0$ 上求解。\n\n在 $t=0$ 时的初始条件是一个定义明确的局部脉冲，$u(x, 0) = f(x)$，它仅在一个有限区间上非零。\n\n为了数值求解该方程，我们建立了一个具有均匀空间步长 $\\Delta x$ 和均匀时间步长 $\\Delta t$ 的计算网格。网格点表示为 $x_j = j \\Delta x$ 和 $t_n = n \\Delta t$，其中 $j$ 是整数，$n$ 是非负整数。令 $U_j^n$ 表示 $u(x_j, t_n)$ 的数值近似。\n\n数值解采用一阶迎风有限差分格式。给定正平流速度 $c>0$，该格式通过对时间导数使用向前差分、对空间导数使用向后差分来定义：\n$$\n\\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_j^n - U_{j-1}^n}{\\Delta x} = 0\n$$\n空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 被特别选择，使得定义为 $\\sigma = \\frac{c \\Delta t}{\\Delta x}$ 的库朗数（Courant number）恰好等于 1。\n\n在系统演化 $N$ 个时间步长（其中 $N$ 是一个正整数）后，下列哪个陈述最能描述数值解剖面 $\\{U_j^N\\}_{j \\in \\mathbb{Z}}$ 相对于初始离散剖面 $\\{U_j^0\\}_{j \\in \\mathbb{Z}}$ 的关系？\n\nA. 数值解在网格点上与精确解析解完全相同，表现为初始剖面的一个完美的、保持形状的平移。\n\nB. 脉冲的峰值减小，其基底变宽，表明存在数值耗散。\n\nC. 数值解中出现了伪振荡，尤其是在初始脉冲梯度较大的区域附近。\n\nD. 数值解的量值无界增长，表明存在数值不稳定性。\n\nE. 脉冲发生了平移，但变得不对称，一侧比另一侧更陡峭。\n\nF. 脉冲保持在初始位置中心，但其振幅随时间衰减。", "solution": "该连续问题是具有恒定正速度 $c>0$ 的线性平流方程，\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0,\n$$\n其初始条件为紧支集函数 $u(x,0)=f(x)$。根据特征线法，沿着满足 $\\frac{\\mathrm{d}x}{\\mathrm{d}t}=c$ 的曲线，解是恒定的。因此，精确解为\n$$\nu(x,t) = f(x - c t).\n$$\n\n在均匀网格 $x_j=j \\Delta x$，$t_n=n \\Delta t$ 上，针对 $c>0$ 的一阶迎风格式为\n$$\n\\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_j^n - U_{j-1}^n}{\\Delta x} = 0.\n$$\n引入库朗数 $\\sigma = \\frac{c \\Delta t}{\\Delta x}$ 并重新整理可得\n$$\nU_j^{n+1} = U_j^n - \\sigma \\left(U_j^n - U_{j-1}^n\\right) = (1-\\sigma) U_j^n + \\sigma U_{j-1}^n.\n$$\n当特别选择 $\\sigma=1$ 时，该更新公式简化为纯粹的平移算子\n$$\nU_j^{n+1} = U_{j-1}^n.\n$$\n将此恒等式迭代 $N$ 个时间步长，可得\n$$\nU_j^{N} = U_{j-1}^{N-1} = \\cdots = U_{j-N}^{0}.\n$$\n因此，离散剖面向右精确平移了 $N$ 个网格单元，形状或振幅没有任何改变。\n\n为了与时间 $t_N = N \\Delta t$ 时网格点上的精确解进行比较，计算\n$$\nu(x_j, t_N) = f(x_j - c t_N) = f\\big(j \\Delta x - c N \\Delta t\\big).\n$$\n由于 $\\sigma= \\frac{c \\Delta t}{\\Delta x} = 1$，我们有 $c N \\Delta t = N \\Delta x$，因此\n$$\nu(x_j, t_N) = f\\big((j-N)\\Delta x\\big) = f(x_{j-N}).\n$$\n根据初始离散数据的定义，$U_{j-N}^{0} = f(x_{j-N})$，所以\n$$\nU_j^{N} = U_{j-N}^{0} = u(x_j, t_N).\n$$\n因此，在网格点上，数值解与解析解完全吻合，表现为初始剖面向右平移 $N$ 个单元的完美、保形平移。在这种情况下，数值耗散、伪振荡、不稳定性、不对称性或静止衰减等效应均未发生。\n\n正确选项是 A。", "answer": "$$\\boxed{A}$$", "id": "2139538"}, {"introduction": "真实的物理系统往往比单一的波动或平流更复杂。例如，在环境科学中模拟污染物扩散时，需要同时考虑平流（物质的整体输运）和扩散（物质的展开）。这个练习将带你进入一个更真实的场景，演示当多个物理过程并存时如何确定稳定性。它教会我们一个至关重要的原则：最终选择的时间步长必须足够小，以同时满足所有过程的稳定性要求。", "problem": "一位计算工程师正在开发一个模拟程序，用于模拟一种可溶性化学污染物在长的、均匀的通道中的浓度。污染物的浓度 $u(x,t)$（其中 $x$ 是沿通道的位置，$t$ 是时间）由一维对流-扩散方程控制：\n$$ \\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = D \\frac{\\partial^2 u}{\\partial x^2} $$\n此处，$c$ 是水流的恒定对流速度，$D$ 是污染物的恒定扩散系数。\n\n为了进行数值模拟，该工程师采用了一种基于均匀网格的显式有限差分方法，其空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。该格式对时间导数使用前向差分，对对流项（一阶空间导数）使用中心差分，对扩散项（二阶空间导数）使用中心差分。这得到了浓度 $U_j^n \\approx u(j\\Delta x, n\\Delta t)$ 的以下离散更新方程：\n$$ \\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_{j+1}^n - U_{j-1}^n}{2\\Delta x} = D \\frac{U_{j+1}^n - 2U_j^n + U_{j-1}^n}{(\\Delta x)^2} $$\n\n通道和污染物的物理参数如下：\n- 对流速度, $c = 0.5 \\text{ m/s}$\n- 扩散系数, $D = 0.01 \\text{ m}^2\\text{/s}$\n\n该工程师将模拟的空间网格间距设为 $\\Delta x = 0.1 \\text{ m}$。为确保模拟不会产生非物理振荡并无界增长，必须选择时间步长 $\\Delta t$ 以满足此数值格式的稳定性条件。根据 Courant-Friedrichs-Lewy (CFL) 稳定性判据，存在一个最大允许时间步长。\n\n确定使该数值格式稳定的最大允许时间步长 $\\Delta t_{max}$。以秒为单位表示你的答案，并保留三位有效数字。", "solution": "给定的显式有限差分更新方程为\n$$\n\\frac{U_{j}^{n+1}-U_{j}^{n}}{\\Delta t}+c\\frac{U_{j+1}^{n}-U_{j-1}^{n}}{2\\Delta x}\n= D\\frac{U_{j+1}^{n}-2U_{j}^{n}+U_{j-1}^{n}}{(\\Delta x)^{2}}.\n$$\n重写方程，引入无量纲参数\n$$\n\\mu \\equiv \\frac{c\\,\\Delta t}{\\Delta x}, \\qquad \\beta \\equiv \\frac{D\\,\\Delta t}{(\\Delta x)^{2}},\n$$\n以得到\n$$\nU_{j}^{n+1} = U_{j}^{n} - \\frac{\\mu}{2}\\left(U_{j+1}^{n}-U_{j-1}^{n}\\right)\n+ \\beta \\left(U_{j+1}^{n}-2U_{j}^{n}+U_{j-1}^{n}\\right).\n$$\n使用傅里叶模 $U_{j}^{n}=\\xi^{n}\\exp(i\\theta j)$（其中 $\\theta=k\\Delta x$）进行 von Neumann 分析。代入 $U_{j\\pm 1}^{n}=\\xi^{n}\\exp[i\\theta(j\\pm 1)]$ 得到放大因子\n$$\n\\xi = 1 - i\\mu \\sin\\theta + 2\\beta(\\cos\\theta - 1).\n$$\n稳定性要求对于所有 $\\theta$ 都有 $|\\xi|\\leq 1$。计算\n$$\n|\\xi|^{2} = \\left[1 + 2\\beta(\\cos\\theta - 1)\\right]^{2} + \\mu^{2}\\sin^{2}\\theta.\n$$\n使用半角恒等式 $\\cos\\theta - 1 = -2\\sin^{2}(\\tfrac{\\theta}{2})$ 和 $\\sin\\theta = 2\\sin(\\tfrac{\\theta}{2})\\cos(\\tfrac{\\theta}{2})$。令 $y \\equiv \\sin^{2}(\\tfrac{\\theta}{2})\\in[0,1]$，从而 $\\cos^{2}(\\tfrac{\\theta}{2})=1-y$。那么\n$$\n|\\xi|^{2} = \\left(1 - 4\\beta y\\right)^{2} + 4\\mu^{2}y(1-y)\n= 1 + y\\left(-8\\beta + 4\\mu^{2}\\right) + y^{2}\\left(16\\beta^{2} - 4\\mu^{2}\\right).\n$$\n定义二次增量 $R(y) \\equiv |\\xi|^{2} - 1 = y(-8\\beta + 4\\mu^{2}) + y^{2}(16\\beta^{2} - 4\\mu^{2})$。稳定性等价于对于所有 $y\\in[0,1]$ 都有 $R(y)\\leq 0$。在端点处求值：\n$$\nR(0)=0,\\qquad R(1)=16\\beta^{2} - 8\\beta = 8\\beta(2\\beta - 1)\\leq 0 \\;\\;\\Longleftrightarrow\\;\\; \\beta \\leq \\frac{1}{2}.\n$$\n当 $16\\beta^{2} - 4\\mu^{2}\\geq 0$（凸情况）时，$R$ 在 $[0,1]$ 上的最大值出现在端点，因此 $\\beta\\leq \\frac{1}{2}$ 就足够了。当 $16\\beta^{2} - 4\\mu^{2}  0$（凹情况）时，如果顶点 $y^{*}$ 位于 $(0,1)$ 区间内，它就是最大值。为防止这种情况，顶点必须位于 $[0,1]$ 之外，这是充分必要条件，可简化为条件\n$$\n\\mu^{2} \\leq 2\\beta.\n$$\n因此，此格式的 von Neumann 稳定性区域为\n$$\n\\mu^{2} \\leq 2\\beta \\quad \\text{and} \\quad \\beta \\leq \\frac{1}{2}.\n$$\n转换回关于 $\\Delta t$ 的表达式，\n$$\n\\left(\\frac{c\\,\\Delta t}{\\Delta x}\\right)^{2} \\leq 2\\,\\frac{D\\,\\Delta t}{(\\Delta x)^{2}}\n\\;\\;\\Longleftrightarrow\\;\\; c^{2}\\Delta t \\leq 2D\n\\;\\;\\Longleftrightarrow\\;\\; \\Delta t \\leq \\frac{2D}{c^{2}},\n$$\n和\n$$\n\\frac{D\\,\\Delta t}{(\\Delta x)^{2}} \\leq \\frac{1}{2}\n\\;\\;\\Longleftrightarrow\\;\\; \\Delta t \\leq \\frac{(\\Delta x)^{2}}{2D}.\n$$\n因此\n$$\n\\Delta t_{\\max} = \\min\\!\\left(\\frac{2D}{c^{2}},\\, \\frac{(\\Delta x)^{2}}{2D}\\right).\n$$\n代入给定值 $c=0.5$，$D=0.01$，$\\Delta x=0.1$：\n$$\n\\frac{2D}{c^{2}} = \\frac{2\\times 0.01}{(0.5)^{2}} = \\frac{0.02}{0.25} = 0.08,\n\\qquad\n\\frac{(\\Delta x)^{2}}{2D} = \\frac{0.01}{0.02} = 0.5.\n$$\n因此，最大允许时间步长是\n$$\n\\Delta t_{\\max} = 0.08,\n$$\n保留三位有效数字为 $8.00\\times 10^{-2}$。", "answer": "$$\\boxed{8.00 \\times 10^{-2}}$$", "id": "2139560"}]}