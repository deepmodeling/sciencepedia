{"hands_on_practices": [{"introduction": "理论是基础，但真正的理解来自于实践。本章节提供了一系列精心设计的动手练习，旨在帮助你将弱形式和伽辽金方法的抽象概念转化为具体的计算技能。我们将从有限元方法最核心的计算单元——局部刚度矩阵的推导开始。通过这个练习，你将掌握如何将抽象的双线性形式 $a(u,v)$ 转化为可计算的矩阵，这是连接理论与编程实现的关键一步 [@problem_id:3286521]。", "problem": "考虑由二阶微分方程 $-u''(x)=f(x)$ 在有界区间上定义的一维模型问题，其满足齐次狄利克雷边界条件。在标准弱形式中，我们在索博列夫空间 $H_{0}^{1}$ 中寻找 $u$，使得对于所有检验函数 $v\\in H_{0}^{1}$，双线性形式 $a(u,v)=\\int u'(x)v'(x)\\,dx$ 等于线性泛函 $\\ell(v)=\\int f(x)v(x)\\,dx$。在有限元法 (FEM) 中，对于一个具有双节点线性基函数的单元 $[x_i,x_{i+1}]$，其局部单元刚度矩阵的各项由 $K_{mn}^{(e)}=\\int_{x_i}^{x_{i+1}} N_m'(x)N_n'(x)\\,dx$ 定义，其中 $N_m$ 和 $N_n$ 是该单元的节点基函数。\n\n仅使用弱形式的第一性原理、通过双线性形式定义的单元刚度以及从参考单元出发的仿射映射，推导在 $[x_i,x_{i+1}]$ 上的线性单元的 $2\\times 2$ 局部刚度矩阵 $K^{(e)}$ 的显式表达式。使用仿射变换 $x=x_i+h_e\\hat{x}$（其中 $h_e=x_{i+1}-x_i$）和参考线性基函数，从参考单元 $\\hat{x}\\in[0,1]$ 进行映射。将 $K^{(e)}$ 的最终答案表示为仅含 $h_e$ 的闭合形式函数。推导过程中不要跳过步骤。最终答案必须是单一的闭合形式解析表达式；不需要进行数值评估或四舍五入。", "solution": "问题陈述需要经过验证。\n\n### 步骤 1：提取已知条件\n- **微分方程：** $-u''(x) = f(x)$\n- **定义域：** 一个有界区间 $[x_i, x_{i+1}]$ 即为单个单元。\n- **边界条件：** 齐次狄利克雷，$u \\in H_{0}^{1}$。\n- **弱形式：** 寻找 $u \\in H_{0}^{1}$，使得对所有 $v \\in H_{0}^{1}$ 都有 $a(u,v) = \\ell(v)$。\n- **双线性形式：** $a(u,v) = \\int u'(x)v'(x)\\,dx$。\n- **线性泛函：** $\\ell(v) = \\int f(x)v(x)\\,dx$。\n- **局部单元刚度矩阵定义：** $K_{mn}^{(e)} = \\int_{x_i}^{x_{i+1}} N_m'(x)N_n'(x)\\,dx$。\n- **单元基函数：** 双节点线性基函数，$N_m(x)$ 和 $N_n(x)$。\n- **参考单元：** $\\hat{x} \\in [0,1]$。\n- **仿射映射：** $x(\\hat{x}) = x_i + h_e\\hat{x}$。\n- **单元长度：** $h_e = x_{i+1} - x_i$。\n- **目标：** 推导 $2 \\times 2$ 的局部刚度矩阵 $K^{(e)}$，使其为 $h_e$ 的函数。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是偏微分方程数值方法领域（特别是有限元法）中的一个典型推导。它是一个适定问题，因为它提供了所有必要的定义、变换和约束，以得出一个唯一的、定义明确的解析表达式。该问题是客观的，并使用标准的、无歧义的术语。它不违反任何科学原理，不基于错误的前提，并且是完全可形式化的。其设定是完整且内部一致的。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供解答。\n\n目标是推导一维线性单元的 $2 \\times 2$ 局部刚度矩阵 $K^{(e)}$。该矩阵的各项由在单元域 $[x_i, x_{i+1}]$ 上的积分定义：\n$$\nK_{mn}^{(e)} = \\int_{x_i}^{x_{i+1}} N_m'(x)N_n'(x)\\,dx\n$$\n其中 $m, n \\in \\{1, 2\\}$，$N_m(x)$ 是物理单元上的线性基函数（也称为形函数）。\n\n推导过程是通过将此积分从物理坐标系 $x \\in [x_i, x_{i+1}]$ 变换到参考坐标系 $\\hat{x} \\in [0,1]$ 来进行的。\n\n**1. 参考单元基函数**\n在参考单元 $[0,1]$ 上，两个线性基函数（记为 $\\hat{N}_1(\\hat{x})$ 和 $\\hat{N}_2(\\hat{x})$）由节点性质定义：\n$\\hat{N}_m(\\hat{x}_n) = \\delta_{mn}$，其中 $\\hat{x}_1 = 0$ 和 $\\hat{x}_2 = 1$ 是参考单元的节点。\n满足 $\\hat{N}_1(0)=1$ 和 $\\hat{N}_1(1)=0$ 的线性函数是：\n$$\n\\hat{N}_1(\\hat{x}) = 1 - \\hat{x}\n$$\n满足 $\\hat{N}_2(0)=0$ 和 $\\hat{N}_2(1)=1$ 的线性函数是：\n$$\n\\hat{N}_2(\\hat{x}) = \\hat{x}\n$$\n这些参考基函数相对于参考坐标 $\\hat{x}$ 的导数是常数：\n$$\n\\frac{d\\hat{N}_1}{d\\hat{x}} = -1\n$$\n$$\n\\frac{d\\hat{N}_2}{d\\hat{x}} = 1\n$$\n\n**2. 坐标变换与导数映射**\n问题指定了从参考单元到物理单元的仿射映射：\n$$\nx(\\hat{x}) = x_i + h_e\\hat{x}\n$$\n其中 $h_e = x_{i+1} - x_i$ 是单元的长度。\n为了变换导数 $N_m'(x) = \\frac{dN_m}{dx}$，我们使用链式法则。物理基函数通过 $N_m(x) = \\hat{N}_m(\\hat{x}(x))$ 与参考基函数相关联。因此，\n$$\n\\frac{dN_m}{dx} = \\frac{d\\hat{N}_m}{d\\hat{x}} \\frac{d\\hat{x}}{dx}\n$$\n我们需要 $\\frac{d\\hat{x}}{dx}$ 这一项。从映射 $x(\\hat{x})$，我们可以计算变换的雅可比：\n$$\n\\frac{dx}{d\\hat{x}} = h_e\n$$\n因此，其逆为：\n$$\n\\frac{d\\hat{x}}{dx} = \\left(\\frac{dx}{d\\hat{x}}\\right)^{-1} = \\frac{1}{h_e}\n$$\n将此代入链式法则表达式，得到物理导数和参考导数之间的关系：\n$$\nN_m'(x) = \\frac{1}{h_e}\\frac{d\\hat{N}_m}{d\\hat{x}}\n$$\n\n**3. 积分的变换**\n现在我们将变换后的导数代入 $K_{mn}^{(e)}$ 的定义中。我们还需要改变微分元 $dx$ 和积分限。\n微分元变换如下：\n$$\ndx = \\frac{dx}{d\\hat{x}}d\\hat{x} = h_e d\\hat{x}\n$$\n积分限 $x \\in [x_i, x_{i+1}]$ 对应于 $\\hat{x} \\in [0,1]$。\n刚度矩阵各项的积分变为：\n$$\nK_{mn}^{(e)} = \\int_{0}^{1} \\left(\\frac{1}{h_e}\\frac{d\\hat{N}_m}{d\\hat{x}}\\right) \\left(\\frac{1}{h_e}\\frac{d\\hat{N}_n}{d\\hat{x}}\\right) (h_e \\, d\\hat{x})\n$$\n通过合并包含 $h_e$ 的项来简化表达式：\n$$\nK_{mn}^{(e)} = \\frac{1}{h_e^2} \\cdot h_e \\int_{0}^{1} \\frac{d\\hat{N}_m}{d\\hat{x}} \\frac{d\\hat{N}_n}{d\\hat{x}} \\, d\\hat{x} = \\frac{1}{h_e} \\int_{0}^{1} \\frac{d\\hat{N}_m}{d\\hat{x}} \\frac{d\\hat{N}_n}{d\\hat{x}} \\, d\\hat{x}\n$$\n\n**4. 矩阵各项的计算**\n现在我们可以通过代入参考基函数导数的常数值来计算 $2 \\times 2$ 矩阵 $K^{(e)}$ 的四个项。\n\n- 项 $K_{11}^{(e)}$ (对于 $m=1, n=1$)：\n$$\nK_{11}^{(e)} = \\frac{1}{h_e} \\int_{0}^{1} \\left(\\frac{d\\hat{N}_1}{d\\hat{x}}\\right)\\left(\\frac{d\\hat{N}_1}{d\\hat{x}}\\right) \\, d\\hat{x} = \\frac{1}{h_e} \\int_{0}^{1} (-1)(-1) \\, d\\hat{x} = \\frac{1}{h_e} \\int_{0}^{1} 1 \\, d\\hat{x} = \\frac{1}{h_e} [\\hat{x}]_0^1 = \\frac{1}{h_e}\n$$\n\n- 项 $K_{12}^{(e)}$ (对于 $m=1, n=2$)：\n$$\nK_{12}^{(e)} = \\frac{1}{h_e} \\int_{0}^{1} \\left(\\frac{d\\hat{N}_1}{d\\hat{x}}\\right)\\left(\\frac{d\\hat{N}_2}{d\\hat{x}}\\right) \\, d\\hat{x} = \\frac{1}{h_e} \\int_{0}^{1} (-1)(1) \\, d\\hat{x} = \\frac{1}{h_e} \\int_{0}^{1} (-1) \\, d\\hat{x} = -\\frac{1}{h_e} [\\hat{x}]_0^1 = -\\frac{1}{h_e}\n$$\n\n- 项 $K_{21}^{(e)}$ (对于 $m=2, n=1$)：\n由于双线性形式的对称性，$K^{(e)}$ 必须是一个对称矩阵，所以 $K_{21}^{(e)} = K_{12}^{(e)}$。我们明确地验证这一点：\n$$\nK_{21}^{(e)} = \\frac{1}{h_e} \\int_{0}^{1} \\left(\\frac{d\\hat{N}_2}{d\\hat{x}}\\right)\\left(\\frac{d\\hat{N}_1}{d\\hat{x}}\\right) \\, d\\hat{x} = \\frac{1}{h_e} \\int_{0}^{1} (1)(-1) \\, d\\hat{x} = -\\frac{1}{h_e}\n$$\n\n- 项 $K_{22}^{(e)}$ (对于 $m=2, n=2$)：\n$$\nK_{22}^{(e)} = \\frac{1}{h_e} \\int_{0}^{1} \\left(\\frac{d\\hat{N}_2}{d\\hat{x}}\\right)\\left(\\frac{d\\hat{N}_2}{d\\hat{x}}\\right) \\, d\\hat{x} = \\frac{1}{h_e} \\int_{0}^{1} (1)(1) \\, d\\hat{x} = \\frac{1}{h_e} \\int_{0}^{1} 1 \\, d\\hat{x} = \\frac{1}{h_e}\n$$\n\n**5. 组装局部刚度矩阵**\n组合这四个项，我们得到局部刚度矩阵 $K^{(e)}$：\n$$\nK^{(e)} = \\begin{pmatrix}\nK_{11}^{(e)} & K_{12}^{(e)} \\\\\nK_{21}^{(e)} & K_{22}^{(e)}\n\\end{pmatrix} = \\begin{pmatrix}\n\\frac{1}{h_e} & -\\frac{1}{h_e} \\\\\n-\\frac{1}{h_e} & \\frac{1}{h_e}\n\\end{pmatrix}\n$$\n提取公因子 $\\frac{1}{h_e}$，一维线性单元的局部刚度矩阵的最终表达式为：\n$$\nK^{(e)} = \\frac{1}{h_e}\n\\begin{pmatrix}\n1 & -1 \\\\\n-1 & 1\n\\end{pmatrix}\n$$\n此表达式仅取决于单元长度 $h_e$，符合要求。", "answer": "$$\n\\boxed{\\frac{1}{h_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}}\n$$", "id": "3286521"}, {"introduction": "在掌握了如何构建矩阵的基本单元后，下一步是解决一个完整的边值问题。这个练习 [@problem_id:3286619] 将引导你处理一个由点源（即狄拉克 $\\delta$ 函数）驱动的泊松方程，这突显了弱形式在处理广义函数时的强大能力与简洁性。通过在一个仅包含单个基函数的极简近似空间中求解，你可以清晰地洞察建立和求解伽辽金方程 $a(u_h, v_h) = L(v_h)$ 的全过程，从而对方法的核心机制建立直观的认识。", "problem": "考虑在开区间 $(0,1)$ 上带有齐次 Dirichlet 边界条件的边值问题：\n$$\n-u''(x) \\;=\\; \\delta(x-x_0), \\quad x \\in (0,1), \\qquad u(0)=0, \\quad u(1)=0,\n$$\n其中 $\\delta(x-x_0)$ 是以固定点 $x_0 \\in (0,1)$ 为中心的 Dirac delta 分布。从基本定义出发，将 $\\delta(x-x_0)$ 视为一个分布，它对所有具有紧支集的光滑测试函数 $v$ 满足 $\\langle \\delta(x-x_0), v \\rangle = v(x_0)$。使用分部积分法在 Sobolev 空间 $H_0^1(0,1)$（在边界上具有零迹、平方可积且弱导数也平方可积的函数空间）中推导弱形式。\n\n然后，使用有限元法 (FEM) 和试探子空间\n$$\nV_h \\;=\\; \\operatorname{span}\\{\\varphi\\},\n$$\n构建一个一维 Galerkin 近似，其中 $\\varphi$ 是与均匀网格 $\\{0, \\tfrac{1}{2}, 1\\}$ 相关联的标准分片线性帽子函数，定义为 $\\varphi(0)=0$、$\\varphi(\\tfrac{1}{2})=1$ 和 $\\varphi(1)=0$。Galerkin 解的形式为 $u_h(x) = \\alpha \\,\\varphi(x)$，其中标量 $\\alpha \\in \\mathbb{R}$ 由 Galerkin 方程确定。\n\n推导出 $\\alpha$ 作为 $x_0$ 函数的闭式表达式。您的最终答案必须是关于 $x_0$ 的单个闭式解析表达式。无需四舍五入。", "solution": "所述问题是有效的。这是一个适定的、有科学依据的边值问题，是偏微分方程数值方法研究的核心。所有必要信息均已提供，问题没有矛盾或歧义。\n\n我们首先推导给定边值问题的弱形式。\n问题的强形式是：\n$$\n-u''(x) = \\delta(x-x_0), \\quad x \\in (0,1)\n$$\n带有齐次 Dirichlet 边界条件 $u(0)=0$ 和 $u(1)=0$。点 $x_0$ 固定在 $(0,1)$ 区间内。\n\n为了找到弱形式，我们在 Sobolev 空间 $H_0^1(0,1)$ 中寻找解 $u$。该空间由平方可积、弱导数平方可积且满足齐次边界条件的函数组成。我们从同一空间中选择一个测试函数 $v \\in H_0^1(0,1)$，这确保了 $v(0)=0$ 和 $v(1)=0$。\n\n我们将微分方程乘以测试函数 $v(x)$，并在定义域 $\\Omega = (0,1)$ 上积分：\n$$\n\\int_0^1 -u''(x)v(x) \\,dx = \\int_0^1 \\delta(x-x_0)v(x) \\,dx\n$$\n右侧通过 Dirac delta 分布的定义属性 $\\langle \\delta(x-x_0), v \\rangle = v(x_0)$ 来计算。因此，方程变为：\n$$\n\\int_0^1 -u''(x)v(x) \\,dx = v(x_0)\n$$\n我们对左侧应用分部积分：\n$$\n\\int_0^1 -u''(x)v(x) \\,dx = -\\left[u'(x)v(x)\\right]_0^1 + \\int_0^1 u'(x)v'(x) \\,dx\n$$\n边界项 $-\\left[u'(x)v(x)\\right]_0^1 = -(u'(1)v(1) - u'(0)v(0))$ 为零，因为测试函数 $v$ 属于 $H_0^1(0,1)$，这要求 $v(0)=0$ 和 $v(1)=0$。\n\n将处理后的左侧与右侧相等，我们得到弱形式：寻找 $u \\in H_0^1(0,1)$，使得对于所有 $v \\in H_0^1(0,1)$，\n$$\n\\int_0^1 u'(x)v'(x) \\,dx = v(x_0)\n$$\n这通常写成 $a(u,v) = L(v)$ 的形式，其中 $a(u,v) = \\int_0^1 u'(x)v'(x) \\,dx$ 是一个双线性形式，而 $L(v) = v(x_0)$ 是一个线性泛函。\n\n接下来，我们应用 Galerkin 方法。我们在一个指定的有限维试探子空间 $V_h \\subset H_0^1(0,1)$ 内寻找近似解 $u_h(x)$。Galerkin 问题是找到 $u_h \\in V_h$，使得对于所有测试函数 $v_h \\in V_h$ 都有 $a(u_h, v_h) = L(v_h)$。\n问题指定了试探子空间 $V_h = \\operatorname{span}\\{\\varphi\\}$，其中 $\\varphi$ 是在网格 $\\{0, \\frac{1}{2}, 1\\}$ 上的分片线性帽子函数，满足 $\\varphi(0)=0$，$\\varphi(\\frac{1}{2})=1$ 和 $\\varphi(1)=0$。\n\nGalerkin 解的形式为 $u_h(x) = \\alpha \\varphi(x)$，其中标量系数 $\\alpha \\in \\mathbb{R}$ 待定。由于 $V_h$ 是一维空间，只需对基函数 $\\varphi(x)$ 本身进行测试。因此，我们设 $v_h(x) = \\varphi(x)$。将 $u_h$ 和 $v_h$ 代入弱形式，得到：\n$$\n\\int_0^1 (\\alpha \\varphi(x))'(\\varphi(x))' \\,dx = \\varphi(x_0)\n$$\n利用导数和积分的线性性质，我们可以将常数 $\\alpha$ 提取出来：\n$$\n\\alpha \\int_0^1 (\\varphi'(x))^2 \\,dx = \\varphi(x_0)\n$$\n求解 $\\alpha$ 可得：\n$$\n\\alpha = \\frac{\\varphi(x_0)}{\\int_0^1 (\\varphi'(x))^2 \\,dx}\n$$\n为了求出 $\\alpha$，我们需要计算分子和分母。\n\n首先，我们确定 $\\varphi(x)$ 及其导数 $\\varphi'(x)$ 的显式形式。\n函数 $\\varphi(x)$ 是分片线性的，连接点 $(0,0)$、$(\\frac{1}{2}, 1)$ 和 $(1,0)$。\n对于 $x \\in [0, \\frac{1}{2}]$，直线从 $(0,0)$ 到 $(\\frac{1}{2},1)$，因此其方程为 $\\varphi(x) = 2x$。\n对于 $x \\in [\\frac{1}{2}, 1]$，直线从 $(\\frac{1}{2},1)$ 到 $(1,0)$，因此其方程为 $\\varphi(x) - 0 = \\frac{1-0}{\\frac{1}{2}-1}(x-1)$，简化为 $\\varphi(x) = -2(x-1) = 2(1-x)$。\n因此，该函数及其弱导数为：\n$$\n\\varphi(x) = \\begin{cases} 2x, & x \\in [0, \\frac{1}{2}] \\\\ 2(1-x), & x \\in [\\frac{1}{2}, 1] \\end{cases} \\qquad \\text{和} \\qquad \\varphi'(x) = \\begin{cases} 2, & x \\in (0, \\frac{1}{2}) \\\\ -2, & x \\in (\\frac{1}{2}, 1) \\end{cases}\n$$\n现在我们计算分母，即 $(\\varphi'(x))^2$ 的积分：\n$$\n\\int_0^1 (\\varphi'(x))^2 \\,dx = \\int_0^{1/2} (2)^2 \\,dx + \\int_{1/2}^1 (-2)^2 \\,dx = \\int_0^{1/2} 4 \\,dx + \\int_{1/2}^1 4 \\,dx\n$$\n$$\n= [4x]_0^{1/2} + [4x]_{1/2}^1 = (4 \\cdot \\frac{1}{2} - 0) + (4 \\cdot 1 - 4 \\cdot \\frac{1}{2}) = 2 + (4 - 2) = 4\n$$\n分子是 $\\varphi(x_0)$。由于 $x_0 \\in (0,1)$，其值取决于 $x_0$ 所在的子区间：\n$$\n\\varphi(x_0) = \\begin{cases} 2x_0, & \\text{若 } x_0 \\in (0, \\frac{1}{2}] \\\\ 2(1-x_0), & \\text{若 } x_0 \\in (\\frac{1}{2}, 1) \\end{cases}\n$$\n这个分段定义可以使用最小值函数表示为单个闭式形式。注意到 $x_0 \\le 1-x_0$ 当且仅当 $2x_0 \\le 1$，即 $x_0 \\le \\frac{1}{2}$。因此，$\\varphi(x_0) = 2\\min(x_0, 1-x_0)$。\n\n将分子和分母代回 $\\alpha$ 的表达式中：\n$$\n\\alpha(x_0) = \\frac{\\varphi(x_0)}{4} = \\frac{2\\min(x_0, 1-x_0)}{4} = \\frac{1}{2}\\min(x_0, 1-x_0)\n$$\n这就得到了作为 $x_0$ 函数的 $\\alpha$。例如，如果 $x_0 \\in (0, \\frac{1}{2}]$，则 $\\alpha(x_0) = \\frac{x_0}{2}$。如果 $x_0 \\in (\\frac{1}{2}, 1)$，则 $\\alpha(x_0) = \\frac{1-x_0}{2}$。\n也可以使用绝对值函数构建单个解析表达式。$\\alpha(x_0)$ 的函数是一个以 $x_0=\\frac{1}{2}$ 为中心、“峰值”为 $\\alpha(\\frac{1}{2}) = \\frac{1-1/2}{2} = \\frac{1}{4}$ 的“帽子”函数。其方程形式为 $C_1 - C_2|x_0 - \\frac{1}{2}|$。\n在 $x_0=\\frac{1}{2}$ 处，我们有 $\\alpha(\\frac{1}{2}) = C_1 = \\frac{1}{4}$。在 $x_0=0$ 处，我们有 $\\alpha(0)=0$，所以 $\\frac{1}{4} - C_2|0 - \\frac{1}{2}| = 0$，这得出 $\\frac{1}{4} - \\frac{C_2}{2} = 0$，因此 $C_2 = \\frac{1}{2}$。\n因此，表达式为：\n$$\n\\alpha(x_0) = \\frac{1}{4} - \\frac{1}{2}\\left|x_0 - \\frac{1}{2}\\right|\n$$\n这是 $\\alpha$ 作为 $x_0$ 函数的单个闭式解析表达式。", "answer": "$$\n\\boxed{\\frac{1}{4} - \\frac{1}{2}\\left|x_0 - \\frac{1}{2}\\right|}\n$$", "id": "3286619"}, {"introduction": "真实世界的物理问题常常涉及由不同材料构成的区域，这导致微分方程中的系数（如热导率、扩散系数）出现不连续。本练习 [@problem_id:3286550] 旨在展示弱形式如何优雅地处理这类具有分段常数系数的变系数问题，例如模拟不同材料的界面。理解这一点至关重要，因为它揭示了伽辽金方法相较于依赖强形式的传统数值方法的一个显著优势，即无需在界面处进行特殊处理。", "problem": "考虑区间 $\\Omega = (0,1)$ 上的一维泊松型偏微分方程 (PDE)，\n$$\n-\\frac{d}{dx}\\big(a(x)\\,u'(x)\\big) = f(x),\n$$\n具有齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。扩散系数 $a(x)$ 是一个正阶梯函数，由下式给出\n$$\na(x) = \\begin{cases}\na_{1}, & 0 \\le x \\le \\frac{1}{2} \\\\\na_{2}, & \\frac{1}{2} \\le x \\le 1\n\\end{cases}\n$$\n其中 $a_{1} > 0$ 和 $a_{2} > 0$ 是常数，且 $f \\in L^{2}(\\Omega)$ 是一个给定的源项。从强形式出发，仅使用基本微积分运算（乘法法则和分部积分）以及标准的函数空间定义，推导该边值问题的弱形式，其中试探空间和检验空间均取为在边界上迹为零的一阶索博列夫空间 $H_{0}^{1}(\\Omega)$。明确指定其双线性形式和线性泛函。\n\n然后，考虑在节点位于 $x = 0$、$x = \\tfrac{1}{2}$ 和 $x = 1$ 的网格上的标准连续分片线性有限元基函数。令 $\\varphi(x)$ 表示以 $x = \\tfrac{1}{2}$ 为中心的帽子函数，定义如下\n$$\n\\varphi(x) = \\begin{cases}\n\\frac{x}{1/2}, & 0 \\le x \\le \\frac{1}{2} \\\\\n\\frac{1-x}{1/2}, & \\frac{1}{2} \\le x \\le 1 \\\\\n0, & \\text{其他情况}\n\\end{cases}\n$$\n使用你推导出的弱形式，计算刚度贡献 $B(\\varphi,\\varphi)$ 的精确值，其中 $B(\\cdot,\\cdot)$ 是弱问题的双线性形式。将你的最终答案表示为一个用 $a_{1}$ 和 $a_{2}$ 表示的单一闭式解析表达式。无需四舍五入。", "solution": "问题陈述经确认为具有科学依据、适定、客观且完整。它代表了偏微分方程数值分析领域，特别是在有限元方法主题下的一个标准练习。其中不存在矛盾、歧义或违反科学原理的情况。我将继续进行解答。\n\n第一个任务是为给定的边值问题推导弱形式。\n问题的强形式是找到一个函数 $u(x)$，使其满足：\n$$\n-\\frac{d}{dx}\\left(a(x)\\frac{du}{dx}\\right) = f(x) \\quad \\text{for } x \\in \\Omega = (0,1)\n$$\n并满足齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。\n\n为了推导弱形式，我们将偏微分方程 (PDE) 乘以一个任意的检验函数 $v(x)$。问题指定解 $u$ 的试探空间和 $v$ 的检验空间均为索博列夫空间 $H_{0}^{1}(\\Omega)$。该空间由平方可积、具有平方可积的弱导数，并且在定义域 $\\Omega$ 边界上为零的函数组成。因此，对任意 $v \\in H_{0}^{1}(\\Omega)$，我们有 $v(0) = 0$ 和 $v(1) = 0$。\n\n将 PDE 乘以 $v(x)$ 并在定义域 $\\Omega = (0,1)$ 上积分，得到：\n$$\n\\int_{0}^{1} -\\frac{d}{dx}\\left(a(x)\\frac{du}{dx}\\right) v(x) \\, dx = \\int_{0}^{1} f(x) v(x) \\, dx\n$$\n我们对该方程的左侧应用分部积分。分部积分的公式是 $\\int_{a}^{b} F(x)G'(x) \\, dx = [F(x)G(x)]_{a}^{b} - \\int_{a}^{b} F'(x)G(x) \\, dx$。我们令 $F(x) = v(x)$ 和 $G'(x) = -\\frac{d}{dx}\\left(a(x)\\frac{du}{dx}\\right)$。这意味着 $F'(x) = \\frac{dv}{dx}$ 和 $G(x) = -a(x)\\frac{du}{dx}$。应用该公式，我们得到：\n$$\n\\int_{0}^{1} -\\frac{d}{dx}\\left(a(x)\\frac{du}{dx}\\right) v(x) \\, dx = \\left[ -a(x)\\frac{du}{dx} v(x) \\right]_{0}^{1} - \\int_{0}^{1} \\left(-a(x)\\frac{du}{dx}\\right) \\frac{dv}{dx} \\, dx\n$$\n$$\n= \\left[ -a(x)\\frac{du}{dx} v(x) \\right]_{0}^{1} + \\int_{0}^{1} a(x)\\frac{du}{dx} \\frac{dv}{dx} \\, dx\n$$\n边界项计算如下：\n$$\n\\left[ -a(x)\\frac{du}{dx} v(x) \\right]_{0}^{1} = \\left(-a(1)\\frac{du}{dx}(1) v(1)\\right) - \\left(-a(0)\\frac{du}{dx}(0) v(0)\\right)\n$$\n由于检验函数 $v(x)$ 属于 $H_{0}^{1}(\\Omega)$，我们有 $v(0) = 0$ 和 $v(1) = 0$。因此，边界项为零：\n$$\n\\left(-a(1)\\frac{du}{dx}(1) \\cdot 0\\right) - \\left(-a(0)\\frac{du}{dx}(0) \\cdot 0\\right) = 0\n$$\n将此代回，积分方程的左侧简化为：\n$$\n\\int_{0}^{1} a(x)\\frac{du}{dx} \\frac{dv}{dx} \\, dx\n$$\n将其与右侧相等，我们得到弱形式：找到 $u \\in H_{0}^{1}(\\Omega)$，使得对所有 $v \\in H_{0}^{1}(\\Omega)$，\n$$\n\\int_{0}^{1} a(x)\\frac{du}{dx} \\frac{dv}{dx} \\, dx = \\int_{0}^{1} f(x) v(x) \\, dx\n$$\n该方程的形式为 $B(u, v) = L(v)$。双线性形式 $B(\\cdot, \\cdot)$ 和线性泛函 $L(\\cdot)$ 定义如下：\n双线性形式：$B(u, v) = \\int_{0}^{1} a(x) u'(x) v'(x) \\, dx$\n线性泛函：$L(v) = \\int_{0}^{1} f(x) v(x) \\, dx$\n\n第二个任务是计算给定基函数 $\\varphi(x)$ 的刚度贡献 $B(\\varphi, \\varphi)$。帽子函数 $\\varphi(x)$ 定义如下：\n$$\n\\varphi(x) = \\begin{cases}\n2x, & 0 \\le x \\le \\frac{1}{2} \\\\\n2(1-x), & \\frac{1}{2} \\le x \\le 1 \\\\\n0, & \\text{其他情况}\n\\end{cases}\n$$\n$\\varphi(x)$ 的导数 $\\varphi'(x)$ 在弱意义下存在，是一个分段常数函数：\n$$\n\\varphi'(x) = \\frac{d\\varphi}{dx} = \\begin{cases}\n2, & 0 < x < \\frac{1}{2} \\\\\n-2, & \\frac{1}{2} < x < 1\n\\end{cases}\n$$\n刚度贡献 $B(\\varphi, \\varphi)$ 由以下积分给出：\n$$\nB(\\varphi, \\varphi) = \\int_{0}^{1} a(x) (\\varphi'(x))^2 \\, dx\n$$\n扩散系数 $a(x)$ 是一个分段常数函数：\n$$\na(x) = \\begin{cases}\na_{1}, & 0 \\le x \\le \\frac{1}{2} \\\\\na_{2}, & \\frac{1}{2} \\le x \\le 1\n\\end{cases}\n$$\n由于 $a(x)$ 和 $\\varphi'(x)$ 都是在 $x = \\frac{1}{2}$ 处有共同断点的分段常数函数，我们将积分分成两部分：\n$$\nB(\\varphi, \\varphi) = \\int_{0}^{\\frac{1}{2}} a(x) (\\varphi'(x))^2 \\, dx + \\int_{\\frac{1}{2}}^{1} a(x) (\\varphi'(x))^2 \\, dx\n$$\n现在，我们在每个子区间内代入 $a(x)$ 和 $\\varphi'(x)$ 各自的常数值：\n$$\nB(\\varphi, \\varphi) = \\int_{0}^{\\frac{1}{2}} a_{1} (2)^2 \\, dx + \\int_{\\frac{1}{2}}^{1} a_{2} (-2)^2 \\, dx\n$$\n$$\nB(\\varphi, \\varphi) = \\int_{0}^{\\frac{1}{2}} 4a_{1} \\, dx + \\int_{\\frac{1}{2}}^{1} 4a_{2} \\, dx\n$$\n由于 $a_1$ 和 $a_2$ 是常数，我们可以将它们从积分中提出：\n$$\nB(\\varphi, \\varphi) = 4a_{1} \\int_{0}^{\\frac{1}{2}} 1 \\, dx + 4a_{2} \\int_{\\frac{1}{2}}^{1} 1 \\, dx\n$$\n计算这些简单积分得到：\n$$\nB(\\varphi, \\varphi) = 4a_{1} [x]_{0}^{\\frac{1}{2}} + 4a_{2} [x]_{\\frac{1}{2}}^{1}\n$$\n$$\nB(\\varphi, \\varphi) = 4a_{1} \\left(\\frac{1}{2} - 0\\right) + 4a_{2} \\left(1 - \\frac{1}{2}\\right)\n$$\n$$\nB(\\varphi, \\varphi) = 4a_{1} \\left(\\frac{1}{2}\\right) + 4a_{2} \\left(\\frac{1}{2}\\right)\n$$\n$$\nB(\\varphi, \\varphi) = 2a_{1} + 2a_{2}\n$$\n这是用 $a_{1}$ 和 $a_{2}$ 表示的刚度贡献的最终闭式解析表达式。", "answer": "$$\n\\boxed{2a_{1} + 2a_{2}}\n$$", "id": "3286550"}]}