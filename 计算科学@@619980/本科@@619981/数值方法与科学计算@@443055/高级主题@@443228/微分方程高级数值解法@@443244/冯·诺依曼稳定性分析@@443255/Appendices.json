{"hands_on_practices": [{"introduction": "对于纯对流问题，前向时间中心差分（FTCS）格式是无条件不稳定的，这在数值方法中是一个众所周知的问题。一个常见的解决方法是在原方程中引入一个“人工粘性”项，这在数学上等同于增加一个扩散项，从而改变方程的性质。本练习将引导你通过冯·诺依曼稳定性分析，推导保证此混合格式稳定的具体条件 [@problem_id:2225609]。这个过程将揭示在实际计算中，我们如何利用理论分析来设计和验证稳定的数值方案。", "problem": "在计算流体动力学中，有时需要在双曲型偏微分方程中引入“人工粘性”项，以控制数值解中的不稳定性。考虑带有人工粘性项的一维线性平流方程：\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = \\epsilon \\frac{\\partial^2 u}{\\partial x^2}\n$$\n此处，$u(x,t)$ 是一个标量， $c$ 是恒定的平流速度，$\\epsilon$ 是人工粘性系数，其中 $c$ 和 $\\epsilon$ 均为正常数。\n\n为了对该方程进行数值求解，我们使用空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的网格。我们将 $u(j\\Delta x, n\\Delta t)$ 的数值近似记为 $u_j^n$。一种常见的显式有限差分方法是前向时间中心空间（Forward-Time Central-Space, FTCS）格式。对于给定的方程，FTCS 离散格式为：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\left( \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} \\right) = \\epsilon \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} \\right)\n$$\n该格式的稳定性取决于两个无量纲参数：库朗数 $\\nu = \\frac{c \\Delta t}{\\Delta x}$ 和扩散数 $d = \\frac{\\epsilon \\Delta t}{(\\Delta x)^2}$。\n\n通过 Von Neumann 稳定性分析可以证明，为使该格式对所有波数都稳定，必须满足两个不同的条件。第一个条件对扩散数本身设定了上限，形式为 $d \\le d_{max}$。第二个条件建立了库朗数和扩散数之间的关系，形式为 $\\nu^2 \\le g(d)$。\n\n你的任务是确定函数 $g(d)$。", "solution": "我们应用 Von Neumann 稳定性分析。假设一个傅里叶模式 $u_{j}^{n}=\\zeta^{n} e^{i j \\theta}$，其中 $\\zeta$ 是放大因子，$\\theta$ 是无量纲波数。将其代入 FTCS 格式\n$$\n\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}+c\\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\\Delta x}=\\epsilon\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{(\\Delta x)^{2}},\n$$\n使用 $\\nu=\\frac{c\\Delta t}{\\Delta x}$ 和 $d=\\frac{\\epsilon\\Delta t}{(\\Delta x)^{2}}$，以及以下恒等式\n$$\n\\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\\Delta x}\\mapsto \\frac{e^{i\\theta}-e^{-i\\theta}}{2\\Delta x} \\hat{u}^n e^{ij\\theta} = \\frac{i}{\\Delta x}\\sin\\theta \\hat{u}^n e^{ij\\theta},\n$$\n$$\n\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{(\\Delta x)^{2}}\\mapsto \\frac{e^{i\\theta}-2+e^{-i\\theta}}{(\\Delta x)^{2}} \\hat{u}^n e^{ij\\theta} = \\frac{-4}{(\\Delta x)^{2}}\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right) \\hat{u}^n e^{ij\\theta}.\n$$\n这给出了放大因子\n$$\n\\zeta=1-i\\nu\\sin\\theta-4d\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right).\n$$\n稳定性要求对所有 $\\theta$ 都有 $|\\zeta|^{2}\\leq 1$。计算\n$$\n|\\zeta|^{2}=\\left(1-4d\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)\\right)^{2}+\\nu^{2}\\sin^{2}\\theta.\n$$\n令 $s=\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)\\in[0,1]$，则 $\\sin^{2}\\theta=4s(1-s)$。那么\n$$\n|\\zeta|^{2}= \\left(1-4ds\\right)^{2}+4\\nu^{2}s(1-s),\n$$\n并且稳定性条件 $|\\zeta|^{2}\\leq 1$ 变为\n$$\n\\left(1-4ds\\right)^{2}+4\\nu^{2}s(1-s)\\leq 1,\\quad \\forall s\\in[0,1].\n$$\n减去 $1$ 并展开得到\n$$\n\\left(1-4ds\\right)^{2}+4\\nu^{2}s(1-s)-1 = s\\left[(-8d+4\\nu^{2})+s(16d^{2}-4\\nu^{2})\\right]\\leq 0.\n$$\n因为 $s\\geq 0$，这个不等式对所有 $s\\in[0,1]$ 成立，等价于要求线性函数\n$$\nh(s)=(-8d+4\\nu^{2})+s(16d^{2}-4\\nu^{2})\n$$\n对所有 $s\\in[0,1]$ 满足 $h(s)\\leq 0$。对于一个线性函数，这等价于 $h(0)\\leq 0$ 和 $h(1)\\leq 0$。这两个条件分别给出\n$$\nh(0)\\leq 0 \\;\\Longrightarrow\\; -8d+4\\nu^{2}\\leq 0 \\;\\Longrightarrow\\; \\nu^{2}\\leq 2d,\n$$\n$$\nh(1)\\leq 0 \\;\\Longrightarrow\\; -8d+16d^{2}\\leq 0 \\;\\Longrightarrow\\; d\\leq \\frac{1}{2}.\n$$\n因此，两个稳定性条件是 $d\\leq \\frac{1}{2}$ 和 $\\nu^{2}\\leq 2d$。所以，关联库朗数和扩散数的函数是\n$$\ng(d)=2d.\n$$", "answer": "$$\\boxed{2d}$$", "id": "2225609"}, {"introduction": "确定一个数值格式是否稳定是至关重要的第一步，但稳定性分析能做的远不止于此。对于一个不稳定的格式，不同的误差模态（即不同波长的误差分量）其增长速度是不同的。通过深入分析放大因子 $G(k)$ 的性质，我们可以找出增长最快的那个模态，它将主导数值解中的误差演化。本练习将带你探究不稳定的FTCS对流格式，并精确定位导致其“爆炸”的罪魁祸首——增长最快的傅里叶模态 [@problem_id:2225581]。这有助于将抽象的稳定性理论与计算中观察到的具体误差模式联系起来。", "problem": "考虑一维线性平流方程，该方程描述了一个量 $u(x,t)$ 以恒定的正速度 $c$ 进行输运：\n$$ \\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0 $$\n一位工程师试图在一个具有空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 的均匀网格上对该方程进行数值求解。他们采用了时间前向、空间中心 (FTCS) 格式，该格式由以下有限差分方程给出：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0 $$\n其中 $u_j^n$ 是 $u(j\\Delta x, n\\Delta t)$ 的数值近似。\n\n众所周知，该格式是无条件不稳定的，会导致任何初始舍入误差随时间增长。误差可以分解为傅里叶模态的叠加。单个波数为 $k$ 的傅里叶模态从一个时间步到下一个时间步的演化由一个复放大因子 $G(k)$ 控制。对应于该因子最大模 $|G(k)|$ 的模态将增长最快，并最终主导数值解。\n\n你的任务是确定经历最快增长的傅里叶模态的具体波数 $k$。将此波数 $k$ 表示为关于空间网格间距 $\\Delta x$ 的符号表达式。", "solution": "考虑FTCS格式\n$$\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}+c\\,\\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\\Delta x}=0.$$\n进行冯·诺依曼 (Von Neumann) 分析，代入单个傅里叶模态\n$$u_{j}^{n}=\\hat{u}^{n}e^{i j \\theta},\\quad \\theta=k\\Delta x,$$\n并通过 $u_{j}^{n+1}=G\\,u_{j}^{n}$ 定义放大因子。代入后得到\n$$\\frac{G-1}{\\Delta t}+c\\,\\frac{e^{i\\theta}-e^{-i\\theta}}{2\\Delta x}=0.$$\n使用 $e^{i\\theta}-e^{-i\\theta}=2i\\sin\\theta$，我们得到\n$$\\frac{G-1}{\\Delta t}+c\\,\\frac{i\\sin\\theta}{\\Delta x}=0 \\quad\\Longrightarrow\\quad G=1-i\\nu\\sin\\theta,$$\n其中 $\\nu=\\frac{c\\,\\Delta t}{\\Delta x}$ 是库朗数。放大因子的模为\n$$|G|=\\sqrt{1+\\nu^{2}\\sin^{2}\\theta}.$$\n对于固定的 $\\nu$，每个时间步的增长在 $|G|$ 最大化时达到最大，这发生在 $|\\sin\\theta|$ 为最大值时。由于 $|\\sin\\theta|$ 在以下位置达到其最大值 $1$：\n$$\\theta=\\frac{\\pi}{2}+m\\pi,\\quad m\\in\\mathbb{Z},$$\n对应的波数满足\n$$k\\Delta x=\\frac{\\pi}{2}+m\\pi \\quad\\Longrightarrow\\quad k=\\frac{(2m+1)\\pi}{2\\Delta x}.$$\n限制在第一布里渊区中的主波数，得到特定的增长最快的模态\n$$k=\\frac{\\pi}{2\\Delta x}.$$", "answer": "$$\\boxed{\\frac{\\pi}{2\\Delta x}}$$", "id": "2225581"}, {"introduction": "冯·诺依曼分析的威力并不仅限于评估时间步进格式的稳定性。其核心思想——在傅里叶空间中分析算子的作用——可以被推广应用于更广泛的数值操作，例如空间滤波。在复杂的模拟中，我们常常需要设计滤波器来选择性地消除高频数值噪音，同时保留解的物理特征。本高级练习将让你扮演数值工程师的角色，运用放大因子的概念来设计一个具有特定频率响应的数值滤波器 [@problem_id:3286118]。你将学习如何通过设定对特定模态的阻尼要求，来精确确定滤波器的参数，这展示了冯·诺依曼分析作为一种强大设计工具的潜力。", "problem": "考虑一个空间索引为 $j \\in \\mathbb{Z}$ 的一维均匀网格和一个时间步进程序，该程序在任何非耗散更新后，在每个时间层级上对标量场 $u$ 应用一个五点平滑滤波器。该滤波器定义为\n$$\nu_{j}^{n+1} \\leftarrow \\tilde{u}_{j}^{n+1} - \\varepsilon \\left(\\tilde{u}_{j-2}^{n+1} - 4 \\tilde{u}_{j-1}^{n+1} + 6 \\tilde{u}_{j}^{n+1} - 4 \\tilde{u}_{j+1}^{n+1} + \\tilde{u}_{j+2}^{n+1}\\right),\n$$\n其中 $\\tilde{u}_{j}^{n+1}$ 表示在时间层级 $n+1$ 上进行基础更新后、滤波前的值，$\\varepsilon  0$ 是一个无量纲的滤波器强度。这种类型的平滑对应于标准的四阶 Kreiss–Oliger (KO) 耗散。\n\n使用 Von Neumann 稳定性分析，将该滤波器视为作用于离散傅里叶模态的线性算子，并推导依赖于模态的放大因子 $F(\\xi)$，其中 $\\xi \\in [-\\pi,\\pi]$ 是无量纲波数。然后，通过施加以下要求来设计该滤波器，使其能强力衰减最高频率的“棋盘”模态，同时高精度地保持低频模态：\n- 最高频率模态 $\\xi = \\pi$ 滤波后的振幅必须恰好是其滤波前振幅的 $0.05$。\n- 对于小的 $|\\xi|$，由滤波器引入的领头阶相对振幅误差必须按 $\\mathcal{O}(\\xi^{4})$ 缩放。\n\n确定满足这两个要求的 $\\varepsilon$ 的精确值。您的最终答案必须是单一的闭式表达式。无需四舍五入，最终答案中不应包含单位。", "solution": "该问题要求为一个给定的五点平滑滤波器确定其强度参数 $\\varepsilon$ 的值。该滤波器必须满足两个特定的设计要求。对问题陈述的验证证实了它是科学上成立、适定且客观的。因此，我们可以进行形式化的求解。\n\n该滤波器由以下更新规则定义：\n$$\nu_{j}^{n+1} = \\tilde{u}_{j}^{n+1} - \\varepsilon \\left(\\tilde{u}_{j-2}^{n+1} - 4 \\tilde{u}_{j-1}^{n+1} + 6 \\tilde{u}_{j}^{n+1} - 4 \\tilde{u}_{j+1}^{n+1} + \\tilde{u}_{j+2}^{n+1}\\right)\n$$\n其中 $\\tilde{u}_{j}^{n+1}$ 代表滤波前的状态，而 $u_{j}^{n+1}$ 是滤波后的状态。\n\n首先，我们进行 Von Neumann 稳定性分析以求得滤波器的放大因子 $F(\\xi)$。我们考虑滤波前的场 $\\tilde{u}_{j}^{n+1}$ 的单个离散傅里叶模态：\n$$\n\\tilde{u}_{j}^{n+1} = \\hat{\\tilde{u}}^{n+1}(\\xi) e^{ij\\xi}\n$$\n其中 $j$ 是空间网格索引，$i = \\sqrt{-1}$ 是虚数单位，$\\xi = k \\Delta x$ 是无量纲波数，其中 $k$ 是物理波数，$\\Delta x$ 是网格间距。滤波后的场将具有以下形式：\n$$\nu_{j}^{n+1} = \\hat{u}^{n+1}(\\xi) e^{ij\\xi}\n$$\n放大因子 $F(\\xi)$ 定义为傅里叶振幅之比：\n$$\nF(\\xi) = \\frac{\\hat{u}^{n+1}(\\xi)}{\\hat{\\tilde{u}}^{n+1}(\\xi)}\n$$\n因此，我们可以写出 $u_{j}^{n+1} = F(\\xi) \\tilde{u}_{j}^{n+1}$。为了求 $F(\\xi)$，我们将傅里叶模态代入滤波器方程。一个关键性质是，对于常系数线性算子，$m$ 个网格点的空间平移在傅里叶空间中对应于乘以 $e^{im\\xi}$：$\\tilde{u}_{j+m}^{n+1} = e^{im\\xi} \\tilde{u}_{j}^{n+1}$。将此应用于滤波器方程：\n$$\nF(\\xi) \\tilde{u}_{j}^{n+1} = \\tilde{u}_{j}^{n+1} - \\varepsilon \\left(e^{-i2\\xi}\\tilde{u}_{j}^{n+1} - 4 e^{-i\\xi}\\tilde{u}_{j}^{n+1} + 6 \\tilde{u}_{j}^{n+1} - 4 e^{i\\xi}\\tilde{u}_{j}^{n+1} + e^{i2\\xi}\\tilde{u}_{j}^{n+1}\\right)\n$$\n两边同除以 $\\tilde{u}_{j}^{n+1}$（非零）得到 $F(\\xi)$ 的表达式：\n$$\nF(\\xi) = 1 - \\varepsilon \\left(e^{-i2\\xi} - 4e^{-i\\xi} + 6 - 4e^{i\\xi} + e^{i2\\xi}\\right)\n$$\n我们将复指数项分组并使用欧拉公式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$：\n$$\nF(\\xi) = 1 - \\varepsilon \\left((e^{i2\\xi} + e^{-i2\\xi}) - 4(e^{i\\xi} + e^{-i\\xi}) + 6\\right)\n$$\n$$\nF(\\xi) = 1 - \\varepsilon \\left(2\\cos(2\\xi) - 8\\cos(\\xi) + 6\\right)\n$$\n括号中的项是 $(e^{i\\xi/2} - e^{-i\\xi/2})^4 = (2i\\sin(\\xi/2))^4 = 16\\sin^4(\\xi/2)$。\n所以，放大因子是：\n$$\nF(\\xi) = 1 - 16\\varepsilon \\sin^4\\left(\\frac{\\xi}{2}\\right)\n$$\n现在，我们应用这两个设计要求。\n\n要求2：对于小的 $|\\xi|$，领头阶相对振幅误差必须按 $\\mathcal{O}(\\xi^4)$ 缩放。\n理想的滤波器不做任何事，因此其放大因子为 $F_{ideal}(\\xi) = 1$。相对振幅误差为 $\\big||F(\\xi)| - |F_{ideal}(\\xi)|\\big| = \\big||F(\\xi)| - 1\\big|$。对于小的 $|\\xi|$，$F(\\xi)$ 接近于 $1$ 且为正，因此 $|F(\\xi)|=F(\\xi)$。误差为 $|F(\\xi)-1|$。\n使用泰勒级数 $\\sin(x) = x - x^3/6 + \\mathcal{O}(x^5)$，其中 $x=\\xi/2$：\n$$\n\\sin\\left(\\frac{\\xi}{2}\\right) = \\frac{\\xi}{2} - \\frac{1}{6}\\left(\\frac{\\xi}{2}\\right)^3 + \\mathcal{O}(\\xi^5) = \\frac{\\xi}{2} - \\frac{\\xi^3}{48} + \\mathcal{O}(\\xi^5)\n$$\n因此，\n$$\n\\sin^4\\left(\\frac{\\xi}{2}\\right) = \\left(\\frac{\\xi}{2} + \\mathcal{O}(\\xi^3)\\right)^4 = \\frac{\\xi^4}{16} + \\mathcal{O}(\\xi^6)\n$$\n将此代入 $F(\\xi)$ 的表达式：\n$$\nF(\\xi) = 1 - 16\\varepsilon\\left(\\frac{\\xi^4}{16} + \\mathcal{O}(\\xi^6)\\right) = 1 - \\varepsilon\\xi^4 + \\mathcal{O}(\\xi^6)\n$$\n误差为 $|F(\\xi)-1| = |-\\varepsilon\\xi^4 + \\mathcal{O}(\\xi^6)| = \\varepsilon\\xi^4 + \\mathcal{O}(\\xi^6)$。领头阶误差确实按 $\\mathcal{O}(\\xi^4)$ 缩放。这证实了给定滤波器的结构内在地满足了第二个要求。这是因为有限差分模板 $[1, -4, 6, -4, 1]$ 是四阶导数算子的离散近似，其设计旨在消去低阶项。这个要求没有对 $\\varepsilon$ 的值施加约束。\n\n要求1：最高频率模态 $\\xi=\\pi$ 滤波后的振幅必须恰好是其滤波前振幅的 $0.05$。\n振幅之比由 $|F(\\xi)|$ 给出。对于最高频率（棋盘）模态，$\\xi = \\pi$。该要求是 $|F(\\pi)| = 0.05$。\n我们计算 $F(\\pi)$:\n$$\nF(\\pi) = 1 - 16\\varepsilon \\sin^4\\left(\\frac{\\pi}{2}\\right)\n$$\n由于 $\\sin(\\pi/2) = 1$，我们得到：\n$$\nF(\\pi) = 1 - 16\\varepsilon\n$$\n约束条件变为 $|1 - 16\\varepsilon| = 0.05$。这个方程为 $\\varepsilon$ 得出两个可能的解：\n1. $1 - 16\\varepsilon = 0.05 \\implies 16\\varepsilon = 1 - 0.05 = 0.95 \\implies \\varepsilon = \\frac{0.95}{16} = \\frac{95}{1600} = \\frac{19}{320}$。\n2. $1 - 16\\varepsilon = -0.05 \\implies 16\\varepsilon = 1 + 0.05 = 1.05 \\implies \\varepsilon = \\frac{1.05}{16} = \\frac{105}{1600} = \\frac{21}{320}$。\n\n为了选择正确的值，我们考虑数值方法中“平滑滤波器”或“耗散”算子的目的。其目标是衰减高频分量而不引入虚假振荡。如果放大因子是非负的，即对所有 $\\xi \\in [-\\pi, \\pi]$ 都有 $F(\\xi) \\ge 0$，则可以最好地实现这一点。最大衰减发生在 $|\\xi|=\\pi$ 处。因此，非振荡滤波器的条件是 $F(\\pi) \\ge 0$。\n$$\n1 - 16\\varepsilon \\ge 0 \\implies 16\\varepsilon \\le 1 \\implies \\varepsilon \\le \\frac{1}{16}\n$$\n我们将此界限转换为分母为320的形式：$\\frac{1}{16} = \\frac{20}{320}$。\n现在我们根据这个标准检查我们的两个潜在解：\n- 对于 $\\varepsilon = \\frac{19}{320}$，我们有 $\\frac{19}{320}  \\frac{20}{320}$，因此 $\\varepsilon  \\frac{1}{16}$。这个选择导致 $F(\\pi) = 0.05$，满足非负性条件。放大因子 $F(\\xi)$ 从 $\\xi=0$ 处的 $1$ 单調递减到 $\\xi=\\pi$ 处的 $0.05$，这对应于一个纯耗散滤波器。\n- 对于 $\\varepsilon = \\frac{21}{320}$，我们有 $\\frac{21}{320} > \\frac{20}{320}$，因此 $\\varepsilon > \\frac{1}{16}$。这个选择导致 $F(\\pi) = -0.05$。它违反了非负性准则，并为最高频率模态引入了相位反转。这在平滑滤波器中通常是不希望出现的。\n\n基于数值滤波器设计的标准原则，我们必须选择能确保滤波器是纯耗散的 $\\varepsilon$ 值。因此，正确的值是满足 $\\varepsilon \\le 1/16$ 的那个。\n\n所要求的 $\\varepsilon$ 值为 $\\frac{19}{320}$。", "answer": "$$\\boxed{\\frac{19}{320}}$$", "id": "3286118"}]}