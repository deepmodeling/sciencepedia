{"hands_on_practices": [{"introduction": "将理论应用于实践是掌握数值方法稳定性的关键。本练习将引导你完成一个基本但至关重要的任务：利用一个给定数值方法的绝对稳定域，来为一个标准测试方程计算出保证数值解稳定性的最大步长 $h$。通过这个过程，你将学会如何把一个几何上的区域（稳定域）转化为一个具体的计算约束条件。[@problem_id:2205701]", "problem": "一位数值分析家正在研究一种用于求解形如 $y'(t) = f(t, y(t))$ 的初值问题的单步法。这种方法的一个关键特性是其绝对稳定区域。当该方法应用于标准测试方程 $y'(t) = \\lambda y(t)$（其中 $\\lambda$ 是一个复常数）时，数值解能保证随时间保持有界，当且仅当量 $z = h\\lambda$ 位于该区域内。此处，$h > 0$ 是步长。\n\n对于所考虑的特定方法，其绝对稳定区域被定义为满足条件 $|z + 1| \\leq 1$ 的所有复数 $z$ 的集合。\n\n您的任务是应用此方法求解以下常微分方程 (ODE)：\n$$y'(t) = -5y(t)$$\n确定为保证该 ODE 的数值解稳定所需的最大可能步长 $h$。您的答案应该是一个单一的数值。", "solution": "对于一个绝对稳定区域由所有满足 $|z+1| \\leq 1$ 的 $z$ 定义的单步法，要使测试方程 $y'(t)=\\lambda y(t)$ 稳定，需要 $z=h\\lambda$ 位于该区域内。\n\n将该方法应用于 ODE $y'(t)=-5y(t)$，得到 $\\lambda=-5$，因此 $z=h\\lambda=-5h$。稳定性条件变为\n$$\n|-5h+1| \\leq 1.\n$$\n这等价于双重不等式\n$$\n-1 \\leq -5h+1 \\leq 1.\n$$\n由左侧不等式，\n$$\n-1 \\leq -5h+1 \\implies -2 \\leq -5h \\implies 2 \\geq 5h \\implies h \\leq \\frac{2}{5}.\n$$\n由右侧不等式，\n$$\n-5h+1 \\leq 1 \\implies -5h \\leq 0 \\implies h \\geq 0.\n$$\n考虑到 $h>0$，允许的范围是 $0 < h \\leq \\frac{2}{5}$。因此，确保稳定性的最大可能步长是\n$$\nh_{\\max}=\\frac{2}{5}.\n$$", "answer": "$$\\boxed{\\frac{2}{5}}$$", "id": "2205701"}, {"introduction": "真实的物理系统通常由多个相互耦合的方程描述。这个练习将我们从单个方程带入更现实的方程组情境，并引入一个核心概念：“刚性”（stiffness）。你将通过计算系统矩阵的特征值来诊断一个系统是否为刚性，并基于此分析，做出在显式和隐式方法之间进行选择的关键决策，以实现高效且稳定的长期数值积分。[@problem_id:2205695]", "problem": "在常微分方程（ODEs）的数值方法研究中，一个关键的考虑因素是系统的“刚性”（stiffness），这与解中存在巨大差异的时间尺度有关。刚性系统对许多数值求解器构成了挑战。\n\n考虑一个由两个耦合的线性一阶常微分方程组成的系统，该系统模拟了两个量 $u(t)$ 和 $v(t)$ 的演化，具体如下：\n$$\n\\begin{cases}\nu'(t) = 998 u(t) + 1998 v(t) \\\\\nv'(t) = -999 u(t) - 1999 v(t)\n\\end{cases}\n$$\n其中 $u'(t)$ 和 $v'(t)$ 表示关于时间 $t$ 的导数。\n\n为了在长时间区间上对该系统进行数值求解，必须选择一类合适的方法（显式或隐式）。这种选择取决于方法的稳定性性质和系统的特性，而系统特性由其系数矩阵的特征值决定。\n\n下列哪个陈述正确地指出了该系统系数矩阵的特征值，并说明了哪一类数值方法对于稳定的长期积分计算效率更高？\n\nA. 特征值为 -1 和 -1000；隐式方法效率更高。\n\nB. 特征值为 -1 和 -1000；显式方法效率更高。\n\nC. 特征值为 1 和 1000；显式方法效率更高。\n\nD. 特征值为 1 和 1000；隐式方法效率更高。\n\nE. 特征值为 -1001 和 1000；隐式方法效率更高。", "solution": "该系统可以写成向量形式 $y'(t) = A y(t)$，其中 $y = \\begin{pmatrix} u \\\\ v \\end{pmatrix}$ 且\n$$\nA = \\begin{pmatrix}\n998 & 1998 \\\\\n-999 & -1999\n\\end{pmatrix}.\n$$\n$A$ 的特征值是特征多项式 $\\chi_{A}(\\lambda) = \\det(\\lambda I - A)$ 的根。对于一个 $2 \\times 2$ 矩阵，该多项式可以写为\n$$\n\\chi_{A}(\\lambda) = \\lambda^{2} - (\\operatorname{tr} A)\\lambda + \\det A.\n$$\n计算迹：\n$$\n\\operatorname{tr} A = 998 + (-1999) = -1001.\n$$\n计算行列式：\n$$\n\\det A = 998 \\cdot (-1999) - 1998 \\cdot (-999).\n$$\n计算每个乘积：\n$$\n998 \\cdot (-1999) = -1999 \\cdot 998 = -\\big(1999 \\cdot (1000 - 2)\\big) = -(1999 \\cdot 1000 - 1999 \\cdot 2) = -(1{,}999{,}000 - 3{,}998) = -1{,}995{,}002,\n$$\n$$\n1998 \\cdot (-999) = -\\big(1998 \\cdot 999\\big) = -\\big(1998 \\cdot (1000 - 1)\\big) = -(1{,}998{,}000 - 1{,}998) = -1{,}996{,}002.\n$$\n因此\n$$\n\\det A = -1{,}995{,}002 - (-1{,}996{,}002) = 1{,}000.\n$$\n所以，\n$$\n\\chi_{A}(\\lambda) = \\lambda^{2} - (-1001)\\lambda + 1000 = \\lambda^{2} + 1001 \\lambda + 1000.\n$$\n通过观察对二次多项式进行因式分解：\n$$\n\\lambda^{2} + 1001 \\lambda + 1000 = (\\lambda + 1000)(\\lambda + 1),\n$$\n所以特征值为 $\\lambda_{1} = -1000$ 和 $\\lambda_{2} = -1$。\n\n由于特征值是实数、负数，且量级差异巨大，因此该系统是刚性的。对于显式单步法，如显式欧拉法，其在负实轴上的稳定性要求步长很小，且受最大模特征值的限制。例如，显式欧拉法要求 $|1 + h \\lambda| \\le 1$，对于 $\\lambda = -1000$，这导致 $0 < h \\le \\frac{2}{1000}$，从而迫使在长区间上使用非常小的步长。相比之下，A-稳定的隐式方法（例如，后向欧拉法、梯形法则）在负实轴上对所有 $h > 0$ 都是稳定的，允许使用更大的步长，其主要受精度限制。因此，对于这种刚性系统的稳定长期积分，隐式方法的计算效率更高。\n\n正确的选项是：特征值为 -1 和 -1000；隐式方法效率更高。", "answer": "$$\\boxed{A}$$", "id": "2205695"}, {"introduction": "在追求数值解的稳定性之后，我们必须提出一个更深层次的问题：一个稳定的解就一定是一个好（准确）的解吗？这个练习探讨了步长 $h$ 选择中两个相互竞争又密不可分的方面：稳定性和准确性。你将分别推导由稳定性和局部截断误差（准确性的一个度量）所决定的步长限制，并比较它们之间的关系，从而深刻理解在实际计算中如何平衡这两者。[@problem_id:2205699]", "problem": "考虑由常微分方程 $y'(t) = -\\lambda y(t)$ 和初始条件 $y(0) = y_0$ 给出的初值问题（IVP）。这里，$\\lambda$ 是一个正实数常数，而 $y_0$ 是一个非零实数常数。我们将使用前向欧拉法 $y_{n+1} = y_n + h f(t_n, y_n)$ 来数值求解这个初值问题，其中 $h$ 是步长，$f(t,y) = y'(t)$。\n\n我们对步长 $h$ 的两种不同约束感兴趣。\n\n1.  **稳定性约束：** 对于此问题，如果其放大因子（数值解在每一步中乘以的因子）的模小于或等于1，则认为前向欧拉法是稳定的。令 $h_{stab}$ 为满足此稳定性条件的最大可能步长。\n\n2.  **精度约束：** 该方法的精度与其局部截断误差（LTE）有关。从 $t_n$ 到 $t_{n+1}$ 的单步 LTE 定义为 $T_{n+1} = y(t_{n+1}) - y_{n+1}^{*}$，其中 $y(t_{n+1})$ 是精确解，$y_{n+1}^{*}$ 是假设前一个点是精确的数值近似，即 $y_{n+1}^{*} = y(t_n) + h f(t_n, y(t_n))$。我们基于第一步（$n=0$）的单位步长局部截断误差来定义一个精度准则。令其为 $\\tau_1 = T_1/h$。我们要求 $\\tau_1$ 的模（用其关于 $h$ 的主阶项来近似）必须等于初始变化率 $|y'(0)|$ 的模的一个小分数 $\\epsilon$。令 $h_{acc}$ 为满足此条件，即 $|\\tau_1| = \\epsilon |y'(0)|$ 的步长。\n\n计算比率 $R = \\frac{h_{stab}}{h_{acc}}$。用给定参数的符号表达式来表示你的答案。", "solution": "我们考虑初值问题 $y'(t)=-\\lambda y(t)$，其中 $\\lambda>0$，$y(0)=y_{0}\\neq 0$。前向欧拉法的更新公式为\n$$\ny_{n+1}=y_{n}+h f(t_{n},y_{n})。\n$$\n对于这个常微分方程，右侧项为 $f(t,y)=-\\lambda y$，所以递推关系变为\n$$\ny_{n+1}=(1-h\\lambda)y_{n}。\n$$\n因此，放大因子为 $g(h)=1-h\\lambda$。\n\n稳定性要求放大因子的模小于或等于 $1$：\n$$\n|1-h\\lambda|\\leq 1。\n$$\n该不等式等价于\n$$\n-1\\leq 1-h\\lambda\\leq 1。\n$$\n从右侧不等式 $1-h\\lambda\\leq 1$ 可得 $-h\\lambda\\leq 0$，即 $h\\lambda\\geq 0$，这对 $h\\geq 0$ 成立。从左侧不等式 $-1\\leq 1-h\\lambda$ 可得 $-2\\leq -h\\lambda$，因此 $h\\lambda\\leq 2$。因此，最大的稳定步长是\n$$\nh_{stab}=\\frac{2}{\\lambda}。\n$$\n\n接下来，我们分析局部截断误差（LTE）。根据定义，\n$$\nT_{n+1}=y(t_{n+1})-\\bigl(y(t_{n})+h f(t_{n},y(t_{n}))\\bigr)。\n$$\n使用泰勒展开，\n$$\ny(t_{n+1})=y(t_{n})+h y'(t_{n})+\\frac{h^{2}}{2}y''(t_{n})+\\mathcal{O}(h^{3}),\n$$\n所以\n$$\nT_{n+1}=\\frac{h^{2}}{2}y''(t_{n})+\\mathcal{O}(h^{3})。\n$$\n对于 $y'=-\\lambda y$，我们有 $y''=-\\lambda y'=\\lambda^{2}y$，因此\n$$\nT_{n+1}=\\frac{h^{2}}{2}\\lambda^{2}y(t_{n})+\\mathcal{O}(h^{3})。\n$$\n单位步长局部截断误差为 $\\tau_{n+1}=T_{n+1}/h$，其主阶项为\n$$\n\\tau_{n+1}\\approx \\frac{h}{2}\\lambda^{2}y(t_{n})。\n$$\n在第一步 $n=0$ 时，这给出\n$$\n\\tau_{1}\\approx \\frac{h}{2}\\lambda^{2}y_{0}。\n$$\n精度要求是使用主阶项的 $|\\tau_{1}|=\\epsilon |y'(0)|$。因为 $y'(0)=-\\lambda y_{0}$，我们有 $|y'(0)|=\\lambda |y_{0}|$。因此，\n$$\n\\left|\\frac{h}{2}\\lambda^{2}y_{0}\\right|=\\epsilon \\lambda |y_{0}|。\n$$\n当 $\\lambda>0$ 且 $y_{0}\\neq 0$ 时，消去 $\\lambda |y_{0}|$ 得到\n$$\n\\frac{h}{2}\\lambda=\\epsilon \\quad\\Rightarrow\\quad h_{acc}=\\frac{2\\epsilon}{\\lambda}。\n$$\n\n最后，所求的比率为\n$$\nR=\\frac{h_{stab}}{h_{acc}}=\\frac{\\frac{2}{\\lambda}}{\\frac{2\\epsilon}{\\lambda}}=\\frac{1}{\\epsilon}。\n$$", "answer": "$$\\boxed{\\frac{1}{\\epsilon}}$$", "id": "2205699"}]}