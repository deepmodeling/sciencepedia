{"hands_on_practices": [{"introduction": "掌握多项式插值误差公式是进行数值分析的基础。这个练习提供了一个直接应用该公式的机会，通过对一个多项式函数进行插值，我们可以精确地计算出误差值，因为其高阶导数是一个常数，这消除了误差项中不确定的变量 $\\xi$。通过解决这个问题 [@problem_id:2169688]，你将为后续更复杂的误差分析和控制打下坚实的基础。", "problem": "考虑函数 $f(x) = 3x^4 - 2x^2 + 5$。一个唯一的三次多项式，记为 $P_3(x)$，被构造用于在不同的节点 $x_0 = -1$，$x_1 = 0$，$x_2 = 1$ 和 $x_3 = 2$ 处对函数 $f(x)$ 进行插值。在点 $x$ 处的插值误差定义为 $E(x) = f(x) - P_3(x)$。计算误差 $E(-0.5)$ 的精确值。\n\n将您的答案表示为最简精确分数形式。", "solution": "我们使用在不同节点 $x_{0},\\dots,x_{n}$ 处进行 $n$ 次插值的标准多项式插值误差公式：\n$$\nE(x)=f(x)-P_{n}(x)=\\frac{f^{(n+1)}(\\xi)}{(n+1)!}\\prod_{i=0}^{n}(x-x_{i}),\n$$\n其中 $\\xi$ 位于 $\\{x_{0},\\dots,x_{n},x\\}$ 的凸包内。这里 $n=3$，节点为 $x_{0}=-1$，$x_{1}=0$，$x_{2}=1$，$x_{3}=2$。\n\n给定 $f(x)=3x^{4}-2x^{2}+5$，计算其导数：\n$$\nf'(x)=12x^{3}-4x,\\quad f''(x)=36x^{2}-4,\\quad f^{(3)}(x)=72x,\\quad f^{(4)}(x)=72.\n$$\n由于 $f^{(4)}(x)$ 是一个常数，误差变得精确且不依赖于 $\\xi$：\n$$\nE(x)=\\frac{72}{4!}\\,(x+1)\\,x\\,(x-1)\\,(x-2).\n$$\n在 $x=-\\frac{1}{2}$ 处求值：\n$$\nE\\left(-\\frac{1}{2}\\right) = \\frac{72}{24} \\left(-\\frac{1}{2}+1\\right)\\left(-\\frac{1}{2}\\right)\\left(-\\frac{1}{2}-1\\right)\\left(-\\frac{1}{2}-2\\right) = 3 \\left(\\frac{1}{2}\\right)\\left(-\\frac{1}{2}\\right)\\left(-\\frac{3}{2}\\right)\\left(-\\frac{5}{2}\\right)\n$$\n$$\nE\\left(-\\frac{1}{2}\\right) = 3\\left(-\\frac{15}{16}\\right)=-\\frac{45}{16}.\n$$\n\n作为一致性检验，由于 $E(x)$ 是一个在四个节点处为零的 4 次多项式，并且 $\\prod_{i=0}^{3}(x-x_{i})$ 是一个首项系数为 1 的 4 次多项式，因此 $E(x)$ 中 $x^4$ 的系数必须等于 $f(x)$ 中 $x^4$ 的系数，即 3。这证实了 $E(x)=3\\prod_{i=0}^{3}(x-x_{i})$，并在 $x=-\\frac{1}{2}$ 处得到相同的值。", "answer": "$$\\boxed{-\\frac{45}{16}}$$", "id": "2169688"}, {"introduction": "在学习了如何计算插值误差后，我们需要建立关于误差大小的正确直觉。这个练习 [@problem_id:3225517] 提供了一个发人深省的反例，它将向你展示，在某些情况下，插值误差的绝对值可能大于函数本身的绝对值。这个看似反直觉的结果突显了进行严格误差分析的必要性，而不是仅仅依赖于“插值是近似”这一模糊概念。", "problem": "在多项式插值中，点 $x$ 处的插值误差定义为 $E_n(x) = f(x) - P_n(x)$，其中 $P_n(x)$ 是在 $n+1$ 个不同节点上对函数 $f(x)$ 进行插值的次数至多为 $n$ 的多项式。从插值的基本定义，即在选定的节点 $\\{x_i\\}_{i=0}^n$ 上要求 $P_n(x_i) = f(x_i)$ 出发，通过显式构造证明在某个点上可能出现 $|E_n(x)| > |f(x)|$ 的情况。\n\n使用节点 $x_0 = 0$、$x_1 = \\pi$、$x_2 = 2\\pi$ (角度以弧度为单位) 构造函数 $f(x) = \\cos(x)$ 的二次 ($n=2$) 插值多项式 $P_2(x)$。然后计算在 $x = \\frac{\\pi}{2}$ 处的误差，并验证是否满足 $|E_2\\!\\left(\\frac{\\pi}{2}\\right)| > |f\\!\\left(\\frac{\\pi}{2}\\right)|$。\n\n给出 $|E_2\\!\\left(\\frac{\\pi}{2}\\right)|$ 的精确值作为最终答案。", "solution": "目标是为给定的函数和节点集构造一个二次插值多项式，然后计算在特定点上的插值误差，以证明误差的绝对值可以超过函数本身的绝对值。\n\n待插值的函数是 $f(x) = \\cos(x)$。\n多项式的次数为 $n=2$，这意味着我们需要 $n+1=3$ 个插值节点。\n给定的节点是 $x_0 = 0$、$x_1 = \\pi$ 和 $x_2 = 2\\pi$。\n\n首先，我们必须计算函数 $f(x)$ 在每个节点上的值，以建立插值条件。\n$f(x_0) = f(0) = \\cos(0) = 1$\n$f(x_1) = f(\\pi) = \\cos(\\pi) = -1$\n$f(x_2) = f(2\\pi) = \\cos(2\\pi) = 1$\n\n设二次插值多项式为 $P_2(x) = ax^2 + bx + c$。我们需要找到系数 $a$、$b$ 和 $c$，使得多项式通过点 $(0, 1)$、$(\\pi, -1)$ 和 $(2\\pi, 1)$。这给出了一个三元线性方程组：\n\n1.  在 $x_0 = 0$ 处：$P_2(0) = a(0)^2 + b(0) + c = f(0) = 1$。这立即得出 $c = 1$。\n2.  在 $x_1 = \\pi$ 处：$P_2(\\pi) = a\\pi^2 + b\\pi + c = f(\\pi) = -1$。代入 $c=1$，我们得到 $a\\pi^2 + b\\pi + 1 = -1$，化简为 $a\\pi^2 + b\\pi = -2$。\n3.  在 $x_2 = 2\\pi$ 处：$P_2(2\\pi) = a(2\\pi)^2 + b(2\\pi) + c = f(2\\pi) = 1$。代入 $c=1$，我们得到 $4a\\pi^2 + 2b\\pi + 1 = 1$，化简为 $4a\\pi^2 + 2b\\pi = 0$。两边除以 $2\\pi$ (因为 $\\pi \\neq 0$) 得到 $2a\\pi + b = 0$，或者 $b = -2a\\pi$。\n\n现在我们得到一个关于 $a$ 和 $b$ 的二元方程组：\n(i) $a\\pi^2 + b\\pi = -2$\n(ii) $b = -2a\\pi$\n\n将方程(ii)代入方程(i)：\n$a\\pi^2 + (-2a\\pi)\\pi = -2$\n$a\\pi^2 - 2a\\pi^2 = -2$\n$-a\\pi^2 = -2$\n$a = \\frac{2}{\\pi^2}$\n\n现在将 $a$ 的值代回方程(ii)求 $b$：\n$b = -2 \\left(\\frac{2}{\\pi^2}\\right)\\pi = -\\frac{4\\pi}{\\pi^2} = -\\frac{4}{\\pi}$\n\n因此，系数为 $a = \\frac{2}{\\pi^2}$，$b = -\\frac{4}{\\pi}$ 和 $c=1$。二次插值多项式为：\n$$P_2(x) = \\frac{2}{\\pi^2}x^2 - \\frac{4}{\\pi}x + 1$$\n\n点 $x$ 处的插值误差定义为 $E_n(x) = f(x) - P_n(x)$。对于本题，$E_2(x) = f(x) - P_2(x)$。我们被要求计算在 $x = \\frac{\\pi}{2}$ 处的这个误差。\n\n首先，计算函数 $f(x)$ 在 $x = \\frac{\\pi}{2}$ 处的值：\n$$f\\left(\\frac{\\pi}{2}\\right) = \\cos\\left(\\frac{\\pi}{2}\\right) = 0$$\n\n接着，计算多项式 $P_2(x)$ 在 $x = \\frac{\\pi}{2}$ 处的值：\n$$P_2\\left(\\frac{\\pi}{2}\\right) = \\frac{2}{\\pi^2}\\left(\\frac{\\pi}{2}\\right)^2 - \\frac{4}{\\pi}\\left(\\frac{\\pi}{2}\\right) + 1$$\n$$P_2\\left(\\frac{\\pi}{2}\\right) = \\frac{2}{\\pi^2}\\left(\\frac{\\pi^2}{4}\\right) - \\frac{4\\pi}{2\\pi} + 1$$\n$$P_2\\left(\\frac{\\pi}{2}\\right) = \\frac{1}{2} - 2 + 1 = -\\frac{1}{2}$$\n\n现在，计算误差 $E_2\\left(\\frac{\\pi}{2}\\right)$：\n$$E_2\\left(\\frac{\\pi}{2}\\right) = f\\left(\\frac{\\pi}{2}\\right) - P_2\\left(\\frac{\\pi}{2}\\right) = 0 - \\left(-\\frac{1}{2}\\right) = \\frac{1}{2}$$\n\n题目要求我们验证是否 $|E_2\\left(\\frac{\\pi}{2}\\right)| > |f\\left(\\frac{\\pi}{2}\\right)|$。\n$|E_2\\left(\\frac{\\pi}{2}\\right)| = \\left|\\frac{1}{2}\\right| = \\frac{1}{2}$\n$|f\\left(\\frac{\\pi}{2}\\right)| = |0| = 0$\n因为 $\\frac{1}{2} > 0$，该条件确实满足，这证明了插值误差的绝对值可以大于函数本身的绝对值。\n\n最后的任务是给出 $|E_2\\left(\\frac{\\pi}{2}\\right)|$ 的精确值。如上所算，这个值是 $\\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3225517"}, {"introduction": "理解并计算误差是第一步，而在科学计算中，我们的最终目标往往是控制并最小化误差。插值误差公式 $E(x) = \\frac{f^{(n+1)}(\\xi)}{(n+1)!} \\prod_{i=0}^{n}(x-x_{i})$ 表明，误差大小取决于函数的高阶导数和节点多项式 $\\omega(x) = \\prod_{i=0}^{n}(x-x_{i})$。虽然我们无法改变函数本身，但我们可以通过精心选择插值节点来最小化 $|\\omega(x)|$ 的最大值。这个问题 [@problem_id:3225452] 将引导你探索如何通过优化节点布局（例如使用Chebyshev节点）来显著提高插值的精度，这是数值分析中一个极为强大且实用的技术。", "problem": "考虑在区间 $[-1,1]$ 上使用三个不同的节点 $x_{1}, x_{2}, x_{3} \\in [-1,1]$ 对一个足够光滑的函数 $f$ 进行多项式插值。插值误差可以用节点多项式 $\\omega_{3}(x) = (x - x_{1})(x - x_{2})(x - x_{3})$ 来表示，这是一个首一的3次多项式。对于 $f$ 的三阶导数的一个固定界，在 $[-1,1]$ 上的最坏情况插值误差由量 $\\max_{x \\in [-1,1]} |\\omega_{3}(x)|$ 的大小决定。\n\n现给定一组选择不佳的等距节点：$x_{1}=-1$, $x_{2}=0$, $x_{3}=1$。请按以下步骤操作：\n\n1. 计算等距节点下 $\\displaystyle \\max_{x \\in [-1,1]} \\left| (x+1)x(x-1) \\right|$ 的值。\n2. 在 $[-1,1]$ 中确定一组三个节点，使得在所有三个节点的选择中，$\\displaystyle \\max_{x \\in [-1,1]} |\\omega_{3}(x)|$ 最小化，并根据适用于数值方法和科学计算的基本原理，证明你的选择为何能达到此最小值。\n3. 计算由你的最优节点所达到的 $\\displaystyle \\min_{x_{1},x_{2},x_{3} \\in [-1,1]} \\max_{x \\in [-1,1]} \\left| (x - x_{1})(x - x_{2})(x - x_{3}) \\right|$ 的精确值。\n4. 最后，报告精确的比值\n$$\nR \\;=\\; \\frac{\\max_{x \\in [-1,1]} \\left| (x+1)x(x-1) \\right|}{\\displaystyle \\min_{x_{1},x_{2},x_{3} \\in [-1,1]} \\max_{x \\in [-1,1]} \\left| (x - x_{1})(x - x_{2})(x - x_{3}) \\right|}.\n$$\n\n将最终答案表示为单个精确的解析表达式。不要四舍五入。", "solution": "我们按照问题的要求分步解决。\n\n**第 1 部分：计算等距节点情况下的最大误差贡献**\n\n对于等距节点 $x_1=-1, x_2=0, x_3=1$，节点多项式为：\n$$ \\omega_3(x) = (x - (-1))(x - 0)(x - 1) = (x+1)x(x-1) = x^3 - x $$\n为了在区间 $[-1, 1]$ 上找到 $|\\omega_3(x)|$ 的最大值，我们首先求其导数以找到极值点：\n$$ \\omega_3'(x) = 3x^2 - 1 $$\n令 $\\omega_3'(x) = 0$，我们得到 $3x^2 = 1$，解得 $x = \\pm \\frac{1}{\\sqrt{3}}$。这两个点都在区间 $[-1, 1]$ 内。\n现在我们计算在这些极值点处的函数值：\n$$ \\omega_3\\left(\\frac{1}{\\sqrt{3}}\\right) = \\left(\\frac{1}{\\sqrt{3}}\\right)^3 - \\frac{1}{\\sqrt{3}} = \\frac{1}{3\\sqrt{3}} - \\frac{1}{\\sqrt{3}} = -\\frac{2}{3\\sqrt{3}} $$\n$$ \\omega_3\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\left(-\\frac{1}{\\sqrt{3}}\\right)^3 - \\left(-\\frac{1}{\\sqrt{3}}\\right) = -\\frac{1}{3\\sqrt{3}} + \\frac{1}{\\sqrt{3}} = \\frac{2}{3\\sqrt{3}} $$\n因此，等距节点下 $|\\omega_3(x)|$ 在 $[-1,1]$ 上的最大值为：\n$$ \\max_{x \\in [-1,1]} |\\omega_3(x)| = \\frac{2}{3\\sqrt{3}} = \\frac{2\\sqrt{3}}{9} $$\n\n**第 2 部分：确定最优节点**\n\n根据逼近理论，在区间 $[-1,1]$ 上，所有 $n$ 次首一多项式（即最高次项系数为1的多项式）中，具有最小一致范数（即最小最大绝对值）的是缩放后的切比雪夫多项式 $\\tilde{T}_n(x) = 2^{1-n} T_n(x)$。\n本问题中的节点多项式 $\\omega_3(x)$ 是一个首一的3次多项式。因此，为了最小化 $\\max_{x \\in [-1,1]} |\\omega_3(x)|$，我们应选择 $\\omega_3(x)$ 为缩放后的3次切比雪夫多项式 $\\tilde{T}_3(x)$。\n$$ \\tilde{T}_3(x) = 2^{1-3} T_3(x) = \\frac{1}{4} (4x^3 - 3x) = x^3 - \\frac{3}{4}x $$\n最优的插值节点就是这个多项式的根。我们求解 $\\tilde{T}_3(x) = 0$：\n$$ x^3 - \\frac{3}{4}x = 0 \\implies x\\left(x^2 - \\frac{3}{4}\\right) = 0 $$\n解得最优节点为：\n$$ x_1 = -\\frac{\\sqrt{3}}{2}, \\quad x_2 = 0, \\quad x_3 = \\frac{\\sqrt{3}}{2} $$\n这组节点被称为切比雪夫节点。\n\n**第 3 部分：计算最优情况下的最小-最大值**\n\n最优节点下的最小-最大值就是多项式 $\\tilde{T}_3(x)$ 在 $[-1, 1]$ 上的最大绝对值。\n$$ \\min_{x_1,x_2,x_3} \\max_{x \\in [-1,1]} |\\omega_3(x)| = \\max_{x \\in [-1,1]} |\\tilde{T}_3(x)| = \\max_{x \\in [-1,1]} \\left| \\frac{1}{4} T_3(x) \\right| $$\n由于切比雪夫多项式 $T_n(x)$ 在区间 $[-1, 1]$ 上的最大绝对值为 1，所以：\n$$ \\max_{x \\in [-1,1]} \\left| \\frac{1}{4} T_3(x) \\right| = \\frac{1}{4} \\max_{x \\in [-1,1]} |T_3(x)| = \\frac{1}{4} \\cdot 1 = \\frac{1}{4} $$\n\n**第 4 部分：计算比值 R**\n\n最后，我们计算所要求的比值 $R$：\n$$ R = \\frac{\\text{等距节点情况下的最大值}}{\\text{最优节点情况下的最小值}} = \\frac{\\frac{2}{3\\sqrt{3}}}{\\frac{1}{4}} $$\n$$ R = \\frac{2}{3\\sqrt{3}} \\cdot 4 = \\frac{8}{3\\sqrt{3}} $$\n为了将分母有理化，我们分子分母同乘 $\\sqrt{3}$：\n$$ R = \\frac{8\\sqrt{3}}{3\\sqrt{3} \\cdot \\sqrt{3}} = \\frac{8\\sqrt{3}}{9} $$", "answer": "$$\\boxed{\\frac{8\\sqrt{3}}{9}}$$", "id": "3225452"}]}