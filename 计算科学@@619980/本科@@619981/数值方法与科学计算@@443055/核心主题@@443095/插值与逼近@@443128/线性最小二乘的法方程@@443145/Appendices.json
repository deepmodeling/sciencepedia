{"hands_on_practices": [{"introduction": "我们从最小二乘法的一个经典应用开始：数据拟合。这个问题 [@problem_id:2218047] 将引导你为一组实验数据找到“最佳拟合”直线。通过求解正规方程，你将确定线性模型的最佳参数，并学会量化模型的拟合优度。", "problem": "一位工程师正在校准一种新型热传感器。该传感器的输出电压 $V$ 被假定为环境温度 $T$ 的线性函数。该关系由方程 $V(T) = c_0 + c_1 T$ 建模，其中 $c_0$ 和 $c_1$ 是待确定的校准常数。为了求出这些常数，在受控环境中进行了四次测量：\n\n*   在温度 $T=10$ 摄氏度时，测得电压为 $V=2.6$ 伏特。\n*   在温度 $T=20$ 摄氏度时，测得电压为 $V=3.4$ 伏特。\n*   在温度 $T=30$ 摄氏度时，测得电压为 $V=4.7$ 伏特。\n*   在温度 $T=40$ 摄氏度时，测得电压为 $V=5.4$ 伏特。\n\n参数 $c_0$ 和 $c_1$ 的确定方式是，使得测量电压与线性模型预测电压之间的平方差之和最小。设得到的最佳拟合直线为 $\\hat{V}(T) = \\hat{c}_0 + \\hat{c}_1 T$。\n\n你的任务是计算残差向量的欧几里得范数，其中残差向量的分量是单次测量电压与该最佳拟合直线预测的相应电压之间的差值。\n\n你的最终答案以伏特为单位，并四舍五入到三位有效数字。", "solution": "我们将电压建模为温度的线性函数 $V(T)=c_{0}+c_{1}T$，并使用四组测量数据 $(T_{i},V_{i})=(10,2.6),(20,3.4),(30,4.7),(40,5.4)$ 通过最小二乘法来确定 $(\\hat{c}_{0},\\hat{c}_{1})$。设设计矩阵为 $X=\\begin{pmatrix}1  10 \\\\ 1  20 \\\\ 1  30 \\\\ 1  40\\end{pmatrix}$，观测向量为 $\\boldsymbol{V}=\\begin{pmatrix}2.6 \\\\ 3.4 \\\\ 4.7 \\\\ 5.4\\end{pmatrix}$。最小二乘估计满足\n$$\n\\begin{pmatrix}\\hat{c}_{0} \\\\ \\hat{c}_{1}\\end{pmatrix}=(X^{T}X)^{-1}X^{T}\\boldsymbol{V},\n$$\n等价于正规方程组\n$$\n\\begin{pmatrix}n  \\sum T_{i} \\\\ \\sum T_{i}  \\sum T_{i}^{2}\\end{pmatrix}\\begin{pmatrix}\\hat{c}_{0} \\\\ \\hat{c}_{1}\\end{pmatrix}=\\begin{pmatrix}\\sum V_{i} \\\\ \\sum T_{i}V_{i}\\end{pmatrix}.\n$$\n计算各项和：$n=4$，$\\sum T_{i}=10+20+30+40=100$，$\\sum T_{i}^{2}=10^{2}+20^{2}+30^{2}+40^{2}=3000$，$\\sum V_{i}=2.6+3.4+4.7+5.4=16.1$，以及 $\\sum T_{i}V_{i}=10\\cdot 2.6+20\\cdot 3.4+30\\cdot 4.7+40\\cdot 5.4=451$。因此我们求解\n$$\n\\begin{pmatrix}4  100 \\\\ 100  3000\\end{pmatrix}\\begin{pmatrix}\\hat{c}_{0} \\\\ \\hat{c}_{1}\\end{pmatrix}=\\begin{pmatrix}16.1 \\\\ 451\\end{pmatrix}.\n$$\n行列式为 $4\\cdot 3000-100\\cdot 100=2000$，所以\n$$\n\\hat{c}_{0}=\\frac{3000\\cdot 16.1-100\\cdot 451}{2000}=1.6,\\quad \\hat{c}_{1}=\\frac{-100\\cdot 16.1+4\\cdot 451}{2000}=0.097.\n$$\n因此最佳拟合直线为 $\\hat{V}(T)=1.6+0.097\\,T$。\n\n计算在四个温度下的残差 $r_{i}=V_{i}-\\hat{V}(T_{i})$：\n$$\n\\hat{V}(10)=1.6+0.097\\cdot 10=2.57,\\quad r_{1}=2.6-2.57=0.03,\n$$\n$$\n\\hat{V}(20)=1.6+0.097\\cdot 20=3.54,\\quad r_{2}=3.4-3.54=-0.14,\n$$\n$$\n\\hat{V}(30)=1.6+0.097\\cdot 30=4.51,\\quad r_{3}=4.7-4.51=0.19,\n$$\n$$\n\\hat{V}(40)=1.6+0.097\\cdot 40=5.48,\\quad r_{4}=5.4-5.48=-0.08.\n$$\n残差向量 $\\boldsymbol{r}$ 的欧几里得范数是\n$$\n\\|\\boldsymbol{r}\\|_{2}=\\sqrt{\\sum_{i=1}^{4}r_{i}^{2}}=\\sqrt{(0.03)^{2}+(-0.14)^{2}+(0.19)^{2}+(-0.08)^{2}}=\\sqrt{0.063}.\n$$\n计算平方根并四舍五入到三位有效数字，得到\n$$\n\\|\\boldsymbol{r}\\|_{2}\\approx 0.251.\n$$\n这个值的单位是伏特，因为每个残差都是电压差。", "answer": "$$\\boxed{0.251}$$", "id": "2218047"}, {"introduction": "这个练习 [@problem_id:2218040] 从几何视角阐释了最小二乘法，将其描述为将一个向量正交投影到一个由模型基函数张成的子空间上。这种观点揭示了为什么最小二乘解是在模型允许范围内与目标向量最“接近”的解，是理解其背后原理的关键。", "problem": "您是一名控制系统工程师，正在研究一个简单的二自由度（2-DOF）机械臂。该机器人的末端执行器在三维空间中移动，其相对于基座的位置由坐标向量 $\\mathbf{p} = [x, y, z]^T$ 描述。该机器人的运动由两个独立的执行器产生。第一个执行器沿方向向量 $\\mathbf{u}_1 = [1, 0, 1]^T$ 移动末端执行器，第二个执行器沿方向向量 $\\mathbf{u}_2 = [0, 1, 1]^T$ 移动它。因此，任何可达位置 $\\mathbf{p}_{reach}$ 都必须是这两个向量的线性组合：$\\mathbf{p}_{reach} = c_1 \\mathbf{u}_1 + c_2 \\mathbf{u}_2$，其中标量系数 $c_1$ 和 $c_2$ 代表执行器的位移。这意味着所有可达点构成的集合形成一个通过原点的平面。\n\n一项任务要求机器人的末端执行器移动到目标位置 $\\mathbf{b} = [1, 2, 2]^T$。该点可能不在机器人的可达平面内。控制系统的目标是找到可达平面内离目标点 $\\mathbf{b}$ 几何距离最近的点 $\\mathbf{p}^*$。这个最优点是 $\\mathbf{b}$ 在由执行器方向向量张成的子空间上的正交投影。\n\n使用正规方程法，确定这个最优可达点 $\\mathbf{p}^*$ 的坐标向量。将您的答案表示为具有精确分数分量的列向量。", "solution": "问题要求计算向量 $\\mathbf{b}$ 在由向量 $\\mathbf{u}_1$ 和 $\\mathbf{u}_2$ 张成的子空间上的正交投影。该子空间是以 $\\mathbf{u}_1$ 和 $\\mathbf{u}_2$ 为列的矩阵 $A$ 的列空间。投影 $\\mathbf{p}^*$ 是 $A$ 的列空间中离 $\\mathbf{b}$ 最近的向量。\n\n首先，我们定义矩阵 $A$ 和向量 $\\mathbf{b}$：\n$$ A = \\begin{bmatrix} \\mathbf{u}_1  \\mathbf{u}_2 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{bmatrix}, \\quad \\mathbf{b} = \\begin{bmatrix} 1 \\\\ 2 \\\\ 2 \\end{bmatrix} $$\n\n投影 $\\mathbf{p}^*$ 可以表示为 $A$ 的列的线性组合，即 $\\mathbf{p}^* = A\\mathbf{c}^*$，其中 $\\mathbf{c}^* = \\begin{bmatrix} c_1 \\\\ c_2 \\end{bmatrix}$ 是使平方欧几里得距离 $\\|A\\mathbf{c} - \\mathbf{b}\\|^2$ 最小化的系数向量。这是一个线性最小二乘问题。解 $\\mathbf{c}^*$ 可以通过求解正规方程得到：\n$$ A^T A \\mathbf{c}^* = A^T \\mathbf{b} $$\n\n我们通过计算该方程的各组成部分来求解。\n\n第1步：计算矩阵 $A^T A$。\n$A$ 的转置是：\n$$ A^T = \\begin{bmatrix} 1  0  1 \\\\ 0  1  1 \\end{bmatrix} $$\n现在，我们计算乘积 $A^T A$：\n$$ A^T A = \\begin{bmatrix} 1  0  1 \\\\ 0  1  1 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{bmatrix} = \\begin{bmatrix} (1)(1)+(0)(0)+(1)(1)  (1)(0)+(0)(1)+(1)(1) \\\\ (0)(1)+(1)(0)+(1)(1)  (0)(0)+(1)(1)+(1)(1) \\end{bmatrix} = \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $$\n\n第2步：计算向量 $A^T \\mathbf{b}$。\n$$ A^T \\mathbf{b} = \\begin{bmatrix} 1  0  1 \\\\ 0  1  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 2 \\\\ 2 \\end{bmatrix} = \\begin{bmatrix} (1)(1)+(0)(2)+(1)(2) \\\\ (0)(1)+(1)(2)+(1)(2) \\end{bmatrix} = \\begin{bmatrix} 3 \\\\ 4 \\end{bmatrix} $$\n\n第3步：求解正规方程以得到 $\\mathbf{c}^*$。\n该方程组为：\n$$ \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} \\begin{bmatrix} c_1 \\\\ c_2 \\end{bmatrix} = \\begin{bmatrix} 3 \\\\ 4 \\end{bmatrix} $$\n这对应于两个线性方程：\n1) $2c_1 + c_2 = 3$\n2) $c_1 + 2c_2 = 4$\n\n从方程(1)中，我们可以用 $c_1$ 表示 $c_2$：\n$c_2 = 3 - 2c_1$\n\n将此代入方程(2)：\n$c_1 + 2(3 - 2c_1) = 4$\n$c_1 + 6 - 4c_1 = 4$\n$-3c_1 = -2$\n$c_1 = \\frac{2}{3}$\n\n现在，将 $c_1$ 的值代回以求得 $c_2$：\n$c_2 = 3 - 2\\left(\\frac{2}{3}\\right) = 3 - \\frac{4}{3} = \\frac{9}{3} - \\frac{4}{3} = \\frac{5}{3}$\n因此，系数向量为 $\\mathbf{c}^* = \\begin{bmatrix} 2/3 \\\\ 5/3 \\end{bmatrix}$。\n\n第4步：计算投影向量 $\\mathbf{p}^*$。\n最优可达点 $\\mathbf{p}^*$ 由 $A\\mathbf{c}^*$ 给出：\n$$ \\mathbf{p}^* = A\\mathbf{c}^* = \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{bmatrix} \\begin{bmatrix} \\frac{2}{3} \\\\ \\frac{5}{3} \\end{bmatrix} = \\begin{bmatrix} (1)\\left(\\frac{2}{3}\\right) + (0)\\left(\\frac{5}{3}\\right) \\\\ (0)\\left(\\frac{2}{3}\\right) + (1)\\left(\\frac{5}{3}\\right) \\\\ (1)\\left(\\frac{2}{3}\\right) + (1)\\left(\\frac{5}{3}\\right) \\end{bmatrix} = \\begin{bmatrix} \\frac{2}{3} \\\\ \\frac{5}{3} \\\\ \\frac{2}{3} + \\frac{5}{3} \\end{bmatrix} = \\begin{bmatrix} \\frac{2}{3} \\\\ \\frac{5}{3} \\\\ \\frac{7}{3} \\end{bmatrix} $$\n\n最优可达点的坐标向量为 $\\mathbf{p}^* = [2/3, 5/3, 7/3]^T$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2}{3} \\\\\n\\frac{5}{3} \\\\\n\\frac{7}{3}\n\\end{pmatrix}\n}\n$$", "id": "2218040"}, {"introduction": "线性最小二乘法的功能并不仅限于拟合直线。这个实践 [@problem_id:2218043] 将展示如何使用该方法拟合多项式模型，具体来说是一条二次曲线。你会看到，只要模型对于待求系数是线性的，我们就可以运用相同的正规方程框架来解决更复杂的拟合问题，这体现了该方法的广泛适用性。", "problem": "一位工程师正在校准一种新型的低温温度传感器。该传感器的电阻 $R$ 假设随绝对温度 $T$ 呈二次方关系变化。提出的模型为 $R(T) = c_{0} + c_{1} T + c_{2} T^{2}$，其中 $c_0$、$c_1$ 和 $c_2$ 是待确定的校准系数。为了求出这些系数，进行了一系列测量，得到了以下四个数据点 $(T_i, R_i)$：\n\n- (10.0 K, 125.0 Ω)\n- (20.0 K, 180.0 Ω)\n- (30.0 K, 250.0 Ω)\n- (40.0 K, 350.0 Ω)\n\n您的任务是通过求解线性最小二乘问题，确定系数的最佳拟合值，该问题旨在最小化测量电阻值与模型预测值之间的平方差之和。\n\n求出线性系数 $c_1$ 的值。答案以 $\\Omega/\\text{K}$ 为单位，并四舍五入到四位有效数字。", "solution": "我们将电阻建模为 $R(T)=c_{0}+c_{1}T+c_{2}T^{2}$，并在线性最小二乘的意义下确定 $c_{0},c_{1},c_{2}$。使用最小二乘法的正规方程，其中设计矩阵的行是 $[1,\\,T_{i},\\,T_{i}^{2}]$，数据是 $R_{i}$，我们建立方程 $(X^{T}X)\\mathbf{c}=X^{T}\\mathbf{y}$。定义和 $S_{k}=\\sum_{i}T_{i}^{k}$ (其中 $k=0,1,2,3,4$) 以及 $b_{0}=\\sum_{i}R_{i}$、$b_{1}=\\sum_{i}T_{i}R_{i}$、$b_{2}=\\sum_{i}T_{i}^{2}R_{i}$。对于数据点 $(T_{i},R_{i})\\in\\{(10,125),(20,180),(30,250),(40,350)\\}$，这些和为\n$$\nS_{0}=4,\\quad S_{1}=100,\\quad S_{2}=3000,\\quad S_{3}=100000,\\quad S_{4}=3540000,\n$$\n$$\nb_{0}=905,\\quad b_{1}=26350,\\quad b_{2}=869500.\n$$\n因此正规方程为\n$$\n\\begin{bmatrix}\n4  100  3000\\\\\n100  3000  100000\\\\\n3000  100000  3540000\n\\end{bmatrix}\n\\begin{bmatrix}\nc_{0}\\\\\nc_{1}\\\\\nc_{2}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n905\\\\\n26350\\\\\n869500\n\\end{bmatrix}.\n$$\n将这些方程按分量写出，\n$$\n\\begin{aligned}\n4c_{0}+100c_{1}+3000c_{2}=905\\quad\\text{(1)},\\\\\n100c_{0}+3000c_{1}+100000c_{2}=26350\\quad\\text{(2)},\\\\\n3000c_{0}+100000c_{1}+3540000c_{2}=869500\\quad\\text{(3)}.\n\\end{aligned}\n$$\n由(1)式，解出 $c_{0}$：\n$$\nc_{0}=\\frac{905-100c_{1}-3000c_{2}}{4}=226.25-25c_{1}-750c_{2}.\n$$\n将此代入(2)式和(3)式。对于(2)式：\n$$\n100(226.25-25c_{1}-750c_{2})+3000c_{1}+100000c_{2}=26350,\n$$\n化简为\n$$\n500c_{1}+25000c_{2}=3725\\;\\Rightarrow\\;20c_{1}+1000c_{2}=149.\\quad\\text{(A)}\n$$\n对于(3)式：\n$$\n3000(226.25-25c_{1}-750c_{2})+100000c_{1}+3540000c_{2}=869500,\n$$\n化简为\n$$\n25000c_{1}+1290000c_{2}=190750\\;\\Rightarrow\\;100c_{1}+5160c_{2}=763.\\quad\\text{(B)}\n$$\n求解(A)和(B)。将(A)式乘以 $5$，然后从(B)式中减去：\n$$\n\\bigl(100c_{1}+5160c_{2}\\bigr)-\\bigl(100c_{1}+5000c_{2}\\bigr)=763-745\\;\\Rightarrow\\;160c_{2}=18,\n$$\n所以\n$$\nc_{2}=\\frac{18}{160}=\\frac{9}{80}=0.1125.\n$$\n代入(A)式：\n$$\n20c_{1}+1000\\cdot\\frac{9}{80}=149\\;\\Rightarrow\\;20c_{1}+112.5=149\\;\\Rightarrow\\;20c_{1}=36.5\\;\\Rightarrow\\;c_{1}=\\frac{73}{40}=1.825.\n$$\n以要求的单位四舍五入到四位有效数字，线性系数为 $1.825$。", "answer": "$$\\boxed{1.825}$$", "id": "2218043"}]}