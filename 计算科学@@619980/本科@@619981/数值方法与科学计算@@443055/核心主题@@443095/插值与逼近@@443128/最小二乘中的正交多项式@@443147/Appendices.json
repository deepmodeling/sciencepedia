{"hands_on_practices": [{"introduction": "我们将从最基本的情形入手：用一个常数（零次多项式）来逼近一个函数。这个练习将帮助你掌握最小二乘逼近的核心思想，即通过最小化误差的平方积分来找到最佳逼近。通过求解这个问题 [@problem_id:2192794]，你会发现，对于一个给定的函数，其最佳常数逼近其实就是该函数在区间上的平均值。", "problem": "在数值分析和信号处理的许多应用中，用一个更简单的函数来近似一个复杂的函数通常是很有用的。这种近似的质量通常使用最小二乘准则来衡量。\n\n考虑定义在区间 $[0, \\pi/2]$ 上的函数 $f(x) = \\cos(x)$。我们希望用一个常数函数，比如 $g(x) = c$，来找到 $f(x)$ 的最佳可能近似。在连续最小二乘意义下的最佳常数近似，是指在给定区间上，使 $f(x)$ 和 $c$ 之间平方误差的积分最小化的常数 $c$ 的值。这个误差作为 $c$ 的函数，由以下积分定义：\n$$ E(c) = \\int_{0}^{\\pi/2} [f(x) - c]^2 \\, dx $$\n确定这个最优常数 $c$ 的值。你的答案应该是一个单一的封闭形式解析表达式。", "solution": "我们寻求使平方误差泛函 $E(c) = \\int_{0}^{\\pi/2} [\\cos(x) - c]^{2} \\, dx$ 最小化的常数 $c$。这是在内积 $\\langle u, v \\rangle = \\int_{0}^{\\pi/2} u(x)v(x) \\, dx$ 下，$f(x)=\\cos(x)$ 到由常数函数 $1$ 张成的子空间上的连续最小二乘投影。最小化子满足正规方程 $\\int_{0}^{\\pi/2} [\\cos(x) - c]\\cdot 1 \\, dx = 0$。等价地，我们对 $E(c)$ 关于 $c$ 求导，以得到相同的条件。\n\n对 $E(c)$ 求导：\n$$\nE'(c) = \\int_{0}^{\\pi/2} 2[\\cos(x) - c](-1) \\, dx = 2 \\int_{0}^{\\pi/2} [c - \\cos(x)] \\, dx.\n$$\n令 $E'(c)=0$ 可得\n$$\n0 = 2 \\left[ c \\int_{0}^{\\pi/2} dx - \\int_{0}^{\\pi/2} \\cos(x) \\, dx \\right].\n$$\n因此，\n$$\nc \\int_{0}^{\\pi/2} dx = \\int_{0}^{\\pi/2} \\cos(x) \\, dx.\n$$\n计算积分：\n$$\n\\int_{0}^{\\pi/2} dx = \\frac{\\pi}{2}, \\qquad \\int_{0}^{\\pi/2} \\cos(x) \\, dx = \\left. \\sin(x) \\right|_{0}^{\\pi/2} = 1.\n$$\n所以，\n$$\nc \\cdot \\frac{\\pi}{2} = 1 \\quad \\Longrightarrow \\quad c = \\frac{2}{\\pi}.\n$$\n为确认它是一个最小化子，计算二阶导数：\n$$\nE''(c) = 2 \\int_{0}^{\\pi/2} dx = 2 \\cdot \\frac{\\pi}{2} = \\pi > 0,\n$$\n所以 $c=\\frac{2}{\\pi}$ 是唯一的最小化子。", "answer": "$$\\boxed{\\frac{2}{\\pi}}$$", "id": "2192794"}, {"introduction": "接下来，我们将探讨一个更进一步的例子：寻找一个二次函数的最佳线性（一次）逼近。这个问题 [@problem_id:2192780] 精妙地揭示了使用正交基（如勒让德多项式）的巨大威力。其出人意料的简单结果，深刻地展示了正交性如何能够极大地简化逼近问题，将复杂的计算化为乌有。", "problem": "考虑定义在区间 $[-1, 1]$ 上的函数 $f(x) = \\frac{3}{2}x^2 - \\frac{1}{2}$。我们希望找到该函数在最小二乘意义下的最佳线性逼近。该逼近是一个形式为 $L(x) = c_0 + c_1 x$ 的多项式，其中选择实系数 $c_0$ 和 $c_1$ 以最小化误差平方积分，其定义为：\n\n$$E(c_0, c_1) = \\int_{-1}^{1} (f(x) - L(x))^2 \\, dx$$\n\n确定在区间 $[-1, 1]$ 上最佳逼近 $f(x)$ 的线性多项式 $L(x)$。将您的答案表示为关于 $x$ 的多项式。", "solution": "我们寻求函数 $f(x)=\\frac{3}{2}x^{2}-\\frac{1}{2}$ 在区间 $[-1,1]$ 上关于内积 $\\langle g,h\\rangle=\\int_{-1}^{1}g(x)h(x)\\,dx$ 的最佳最小二乘线性逼近 $L(x)=c_{0}+c_{1}x$。最小二乘条件是残差 $r(x)=f(x)-c_{0}-c_{1}x$ 与由 $\\{1,x\\}$ 张成的子空间正交，这导出法方程\n$$\n\\int_{-1}^{1}\\left(f(x)-c_{0}-c_{1}x\\right)\\,dx=0,\\qquad \\int_{-1}^{1}x\\left(f(x)-c_{0}-c_{1}x\\right)\\,dx=0.\n$$\n展开这些方程得到\n$$\n\\int_{-1}^{1}f(x)\\,dx - c_{0}\\int_{-1}^{1}1\\,dx - c_{1}\\int_{-1}^{1}x\\,dx=0,\n$$\n$$\n\\int_{-1}^{1}x f(x)\\,dx - c_{0}\\int_{-1}^{1}x\\,dx - c_{1}\\int_{-1}^{1}x^{2}\\,dx=0.\n$$\n计算所需的积分。首先，\n$$\n\\int_{-1}^{1}f(x)\\,dx=\\int_{-1}^{1}\\left(\\frac{3}{2}x^{2}-\\frac{1}{2}\\right)\\,dx=\\frac{3}{2}\\int_{-1}^{1}x^{2}\\,dx-\\frac{1}{2}\\int_{-1}^{1}1\\,dx.\n$$\n使用 $\\int_{-1}^{1}x^{2}\\,dx=\\left[\\frac{x^{3}}{3}\\right]_{-1}^{1}=\\frac{2}{3}$ 和 $\\int_{-1}^{1}1\\,dx=2$，我们得到\n$$\n\\int_{-1}^{1}f(x)\\,dx=\\frac{3}{2}\\cdot\\frac{2}{3}-\\frac{1}{2}\\cdot 2=1-1=0.\n$$\n接下来，由于 $f$ 是偶函数而 $x$ 是奇函数，因此 $x f(x)$ 是奇函数，故\n$$\n\\int_{-1}^{1}x f(x)\\,dx=0.\n$$\n同样，如上所示 $\\int_{-1}^{1}x\\,dx=0$ 且 $\\int_{-1}^{1}x^{2}\\,dx=\\frac{2}{3}$。因此，法方程化简为\n$$\n0 - 2c_{0} - c_{1}\\cdot 0=0 \\quad\\Rightarrow\\quad c_{0}=0,\n$$\n$$\n0 - c_{0}\\cdot 0 - c_{1}\\cdot \\frac{2}{3}=0 \\quad\\Rightarrow\\quad c_{1}=0.\n$$\n因此在 $[-1,1]$ 上的最佳最小二乘线性逼近是\n$$\nL(x)=0.\n$$", "answer": "$$\\boxed{0}$$", "id": "2192780"}, {"introduction": "最后，我们将从连续的理论世界迈向离散的实践应用。在处理真实世界的实验数据时，我们面对的往往是离散的数据点，而非连续函数。这个练习 [@problem_id:2192741] 将让你亲手实践三项递推关系，这是为特定数据集生成定制化正交多项式的核心算法，也是连接理论与计算的关键桥梁。", "problem": "在实验数据的数值分析中，使用一组关于数据点正交的函数基通常是有利的。考虑在坐标 $\\{x_i\\} = \\{0, 1, 3, 6\\}$ 处的一组四个实验测量值。我们希望生成一个关于离散内积正交的首一多项式序列 $\\{p_k(x)\\}_{k=0}^\\infty$。\n\n两个实值函数 $f(x)$ 和 $g(x)$ 在这组点上的内积定义为：\n$$ \\langle f, g \\rangle = \\sum_{i=1}^{4} f(x_i) g(x_i) $$\n该正交首一多项式序列由三项递推关系生成：\n$$ p_{k+1}(x) = (x - \\alpha_k) p_k(x) - \\beta_k p_{k-1}(x) $$\n其中 $k \\ge 0$，初始条件定义为 $p_0(x) = 1$ 和 $p_{-1}(x) = 0$。\n\n你的任务是确定递推系数 $\\alpha_1$ 的精确值。请将最终答案表示为最简分数形式。", "solution": "我们使用给定的离散内积\n$$\\langle f, g \\rangle = \\sum_{i=1}^{4} f(x_{i}) g(x_{i}), \\quad \\{x_{i}\\}=\\{0,1,3,6\\},$$\n以及首一三项递推关系\n$$p_{k+1}(x)=(x-\\alpha_{k})p_{k}(x)-\\beta_{k}p_{k-1}(x), \\quad p_{0}(x)=1,\\; p_{-1}(x)=0.$$\n\n对于首一正交多项式，将递推关系与 $p_{k}$ 作内积可得\n$$\\langle p_{k+1},p_{k}\\rangle=\\langle (x-\\alpha_{k})p_{k},p_{k}\\rangle-\\beta_{k}\\langle p_{k-1},p_{k}\\rangle.$$\n根据正交性，$\\langle p_{k+1},p_{k}\\rangle=0$ 且 $\\langle p_{k-1},p_{k}\\rangle=0$，因此\n$$0=\\langle x p_{k},p_{k}\\rangle-\\alpha_{k}\\langle p_{k},p_{k}\\rangle,$$\n所以\n$$\\alpha_{k}=\\frac{\\langle x p_{k},p_{k}\\rangle}{\\langle p_{k},p_{k}\\rangle}.$$\n\n首先，计算 $\\alpha_{0}$：\n$$\\alpha_{0}=\\frac{\\langle x p_{0},p_{0}\\rangle}{\\langle p_{0},p_{0}\\rangle}\n=\\frac{\\sum_{i=1}^{4} x_{i}}{\\sum_{i=1}^{4} 1}\n=\\frac{0+1+3+6}{4}\n=\\frac{10}{4}\n=\\frac{5}{2}.$$\n因此\n$$p_{1}(x)=x-\\alpha_{0}=x-\\frac{5}{2}.$$\n\n现在使用以下公式计算 $\\alpha_{1}$：\n$$\\alpha_{1}=\\frac{\\langle x p_{1},p_{1}\\rangle}{\\langle p_{1},p_{1}\\rangle}\n=\\frac{\\sum_{i=1}^{4} x_{i}\\,p_{1}(x_{i})^{2}}{\\sum_{i=1}^{4} p_{1}(x_{i})^{2}}.$$\n在数据点处计算 $p_{1}(x)$ 的值：\n$$p_{1}(0)=-\\frac{5}{2},\\quad p_{1}(1)=-\\frac{3}{2},\\quad p_{1}(3)=\\frac{1}{2},\\quad p_{1}(6)=\\frac{7}{2}.$$\n平方：\n$$p_{1}(0)^{2}=\\frac{25}{4},\\quad p_{1}(1)^{2}=\\frac{9}{4},\\quad p_{1}(3)^{2}=\\frac{1}{4},\\quad p_{1}(6)^{2}=\\frac{49}{4}.$$\n分母：\n$$\\langle p_{1},p_{1}\\rangle=\\frac{25}{4}+\\frac{9}{4}+\\frac{1}{4}+\\frac{49}{4}=\\frac{84}{4}=21.$$\n分子：\n$$\\langle x p_{1},p_{1}\\rangle=0\\cdot\\frac{25}{4}+1\\cdot\\frac{9}{4}+3\\cdot\\frac{1}{4}+6\\cdot\\frac{49}{4}\n=\\frac{9}{4}+\\frac{3}{4}+\\frac{294}{4}=\\frac{306}{4}=\\frac{153}{2}.$$\n因此\n$$\\alpha_{1}=\\frac{\\frac{153}{2}}{21}=\\frac{153}{42}=\\frac{51}{14}.$$\n此分数已为最简形式。", "answer": "$$\\boxed{\\frac{51}{14}}$$", "id": "2192741"}]}