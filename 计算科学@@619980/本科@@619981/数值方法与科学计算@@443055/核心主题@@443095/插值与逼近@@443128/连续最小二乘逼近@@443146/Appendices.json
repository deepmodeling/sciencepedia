{"hands_on_practices": [{"introduction": "最简单的近似形式是寻找一个单一的常数值，在给定区间上“最接近”一个函数。这个练习 [@problem_id:3218137] 通过最小化加权误差积分，将最小二乘法的抽象思想置于一个简单直观的情境中。它展示了如何运用微积分推导出最优常数，而这个最优常数实际上是原函数的一个加权平均值。", "problem": "考虑一个函数 $f:[a,b]\\to\\mathbb{R}$ 和一个在区间 $[a,b]$ 上可积的严格正权重函数 $w:[a,b]\\to\\mathbb{R}$。任务是找到一个常数 $c\\in\\mathbb{R}$，它在关于权重 $w$ 的连续最小二乘意义下最佳地逼近 $f$，即 $c$ 最小化加权均方误差\n$$\n\\int_{a}^{b} w(x)\\,\\big(f(x)-c\\big)^{2}\\,dx.\n$$\n仅从加权均方误差的基本定义出发，推导表征最小化常数 $c$ 的条件，并用包含 $f$ 和 $w$ 在 $[a,b]$ 上的积分来表示 $c$。然后，将您的推导应用于具体情况 $a=1$，$b=e$，$f(x)=\\ln(x)$ 和 $w(x)=x$，以计算精确的最小化常数。将您的最终答案表示为精确的符号表达式；不要四舍五入。", "solution": "问题要求找到常数 $c \\in \\mathbb{R}$，它在关于权重函数 $w:[a,b]\\to\\mathbb{R}$ 的连续最小二乘意义下最佳地逼近函数 $f:[a,b]\\to\\mathbb{R}$。这是通过最小化由泛函 $E(c)$ 给出的加权均方误差来实现的：\n$$\nE(c) = \\int_{a}^{b} w(x)\\,\\big(f(x)-c\\big)^{2}\\,dx.\n$$\n为了找到最小化 $E(c)$ 的 $c$ 值，我们使用微积分中的标准方法。最小值的必要条件是 $E(c)$ 关于 $c$ 的导数必须为零。由于积分是关于 $x$ 的，我们可以应用莱布尼茨积分法则（积分号下求导）来计算 $E(c)$ 关于 $c$ 的导数：\n$$\n\\frac{dE}{dc} = \\frac{d}{dc} \\int_{a}^{b} w(x)\\,\\big(f(x)-c\\big)^{2}\\,dx = \\int_{a}^{b} \\frac{\\partial}{\\partial c} \\left[ w(x)\\,\\big(f(x)-c\\big)^{2} \\right] \\,dx.\n$$\n对被积函数使用链式法则，我们求得偏导数：\n$$\n\\frac{\\partial}{\\partial c} \\left[ w(x)\\,(f(x)-c)^{2} \\right] = w(x) \\cdot 2(f(x)-c) \\cdot \\frac{\\partial}{\\partial c}(f(x)-c) = w(x) \\cdot 2(f(x)-c) \\cdot (-1) = -2w(x)(f(x)-c).\n$$\n将此代回 $E(c)$ 导数的表达式中：\n$$\n\\frac{dE}{dc} = \\int_{a}^{b} -2w(x)(f(x)-c) \\,dx = -2 \\int_{a}^{b} \\big(w(x)f(x) - cw(x)\\big) \\,dx.\n$$\n将此导数设为零，可得到最优 $c$ 的条件：\n$$\n-2 \\int_{a}^{b} \\big(w(x)f(x) - cw(x)\\big) \\,dx = 0.\n$$\n由于 $-2 \\neq 0$，积分本身必须为零：\n$$\n\\int_{a}^{b} \\big(w(x)f(x) - cw(x)\\big) \\,dx = 0.\n$$\n根据积分算子的线性性质，我们可以分离各项：\n$$\n\\int_{a}^{b} w(x)f(x) \\,dx - \\int_{a}^{b} cw(x) \\,dx = 0.\n$$\n由于 $c$ 是关于积分变量 $x$ 的常数，我们可以将其从第二个积分中提出：\n$$\n\\int_{a}^{b} w(x)f(x) \\,dx - c \\int_{a}^{b} w(x) \\,dx = 0.\n$$\n解出 $c$ 可得：\n$$\nc \\int_{a}^{b} w(x) \\,dx = \\int_{a}^{b} w(x)f(x) \\,dx.\n$$\n问题陈述 $w(x)$ 是一个严格正的权重函数，因此对于 $a < b$，积分 $\\int_{a}^{b} w(x) \\,dx$ 是正且非零的。因此，我们可以用它来除，得到最小化常数 $c$ 的一般表达式：\n$$\nc = \\frac{\\int_{a}^{b} w(x)f(x) \\,dx}{\\int_{a}^{b} w(x) \\,dx}.\n$$\n为了验证这个 $c$ 值对应于一个最小值，我们检查二阶导数 $\\frac{d^{2}E}{dc^{2}}$。对 $\\frac{dE}{dc} = -2\\int_{a}^{b} w(x)f(x) \\,dx + 2c\\int_{a}^{b} w(x) \\,dx$ 关于 $c$ 求导：\n$$\n\\frac{d^{2}E}{dc^{2}} = \\frac{d}{dc} \\left( -2\\int_{a}^{b} w(x)f(x) \\,dx + 2c\\int_{a}^{b} w(x) \\,dx \\right) = 2 \\int_{a}^{b} w(x) \\,dx.\n$$\n如前所述，由于在 $[a,b]$ 上 $w(x) > 0$，积分 $\\int_{a}^{b} w(x) \\,dx$ 是正的。因此，$\\frac{d^{2}E}{dc^{2}} > 0$，这证实了该临界点是一个最小值。由于 $E(c)$ 是一个关于 $c$ 的二次式，其首项系数为正，因此这是一个全局最小值。\n\n现在我们将此结果应用于给定的具体情况：$a=1$，$b=e$，$f(x)=\\ln(x)$ 和 $w(x)=x$。$c$ 的公式为：\n$$\nc = \\frac{\\int_{1}^{e} x \\ln(x) \\,dx}{\\int_{1}^{e} x \\,dx}.\n$$\n我们使用分部积分法 $\\int u \\,dv = uv - \\int v \\,du$ 来计算分子积分 $\\int_{1}^{e} x \\ln(x) \\,dx$。令 $u=\\ln(x)$ 和 $dv=x\\,dx$，则 $du=\\frac{1}{x}\\,dx$ 且 $v=\\frac{x^{2}}{2}$。\n$$\n\\int_{1}^{e} x \\ln(x) \\,dx = \\left[ \\frac{x^{2}}{2}\\ln(x) \\right]_{1}^{e} - \\int_{1}^{e} \\frac{x^{2}}{2} \\cdot \\frac{1}{x} \\,dx = \\left( \\frac{e^{2}}{2}\\ln(e) - \\frac{1^{2}}{2}\\ln(1) \\right) - \\int_{1}^{e} \\frac{x}{2} \\,dx.\n$$\n由于 $\\ln(e)=1$ 且 $\\ln(1)=0$，上式简化为：\n$$\n= \\left( \\frac{e^{2}}{2} - 0 \\right) - \\left[ \\frac{x^{2}}{4} \\right]_{1}^{e} = \\frac{e^{2}}{2} - \\left( \\frac{e^{2}}{4} - \\frac{1^{2}}{4} \\right) = \\frac{e^{2}}{2} - \\frac{e^{2}}{4} + \\frac{1}{4} = \\frac{2e^{2}-e^{2}+1}{4} = \\frac{e^{2}+1}{4}.\n$$\n接下来，我们计算分母积分 $\\int_{1}^{e} x \\,dx$：\n$$\n\\int_{1}^{e} x \\,dx = \\left[ \\frac{x^{2}}{2} \\right]_{1}^{e} = \\frac{e^{2}}{2} - \\frac{1^{2}}{2} = \\frac{e^{2}-1}{2}.\n$$\n最后，我们将这些结果代回 $c$ 的表达式中：\n$$\nc = \\frac{\\frac{e^{2}+1}{4}}{\\frac{e^{2}-1}{2}} = \\frac{e^{2}+1}{4} \\cdot \\frac{2}{e^{2}-1} = \\frac{e^{2}+1}{2(e^{2}-1)}.\n$$", "answer": "$$\n\\boxed{\\frac{\\exp(2)+1}{2(\\exp(2)-1)}}\n$$", "id": "3218137"}, {"introduction": "在第一个练习的基础上，我们将近似从常数（0次多项式）推广到更高次的多项式子空间。这个练习 [@problem_id:3218261] 引入了最小二乘法的几何解释，即正交投影。它揭示了通过强制要求误差（残差）与近似子空间正交，可以求解这个问题，这引出了“法向方程”(normal equations)。在对称区间上利用函数奇偶性提供了一个强大的捷径，突显了问题中重要的结构特性。", "problem": "令 $C([-1,1])$ 表示 $[-1,1]$ 上的连续实值函数空间，并为其配备标准内积 $\\langle g,h\\rangle=\\int_{-1}^{1} g(x)\\,h(x)\\,dx$ 和诱导范数 $\\|g\\|=\\sqrt{\\langle g,g\\rangle}$。考虑函数 $f(x)=x^{3}$ 和子空间 $V=\\operatorname{span}\\{1,x,x^{2}\\}$。\n\n仅使用此内积空间中内积、范数和正交投影的定义，通过强制要求残差 $r=f-p^{\\ast}$ 与 $V$ 正交，来确定唯一的函数 $p^{\\ast}\\in V$，使得 $\\|f-p\\|$ 在 $p\\in V$ 上最小化。然后，计算最小平方误差 $\\|f-p^{\\ast}\\|^{2}$，并解释 $f$ 和 $V$ 中基函数的奇偶性如何影响在对称区间 $[-1,1]$ 上的正交性。\n\n将最小平方误差 $\\|f-p^{\\ast}\\|^{2}$ 的精确值以最简分数形式给出。不要四舍五入。", "solution": "问题是在子空间 $V = \\operatorname{span}\\{1, x, x^2\\}$ 中找到函数 $p^{\\ast}(x)$，它在最小二乘意义上最佳地逼近区间 $[-1, 1]$ 上的函数 $f(x) = x^3$。函数空间 $C([-1,1])$ 配备了内积 $\\langle g, h \\rangle = \\int_{-1}^{1} g(x)h(x)dx$。最佳逼近 $p^{\\ast}(x)$ 是 $V$ 中唯一的函数，它最小化误差范数 $\\|f - p\\|$，其中 $\\|g\\| = \\sqrt{\\langle g, g \\rangle}$。这个最小值在残差向量 $r(x) = f(x) - p^{\\ast}(x)$ 与子空间 $V$ 正交时出现。\n\n$V$ 中的任何函数 $p(x)$ 都可以写成基函数的线性组合：$p(x) = c_0 \\cdot 1 + c_1 \\cdot x + c_2 \\cdot x^2$。记基函数为 $\\phi_0(x) = 1$，$\\phi_1(x) = x$ 和 $\\phi_2(x) = x^2$。残差 $r(x) = f(x) - p^{\\ast}(x)$ 与 $V$ 正交的条件意味着 $r(x)$ 必须与 $V$ 的每个基函数正交。这产生了一个由三个线性方程组成的方程组，称为法方程：\n$$ \\langle f - p^{\\ast}, \\phi_i \\rangle = 0 \\quad \\text{for } i = 0, 1, 2 $$\n$$ \\langle f, \\phi_i \\rangle = \\langle p^{\\ast}, \\phi_i \\rangle \\quad \\text{for } i = 0, 1, 2 $$\n代入 $p^{\\ast}(x) = c_0^{\\ast}\\phi_0(x) + c_1^{\\ast}\\phi_1(x) + c_2^{\\ast}\\phi_2(x)$，我们得到：\n$$ \\langle f, \\phi_i \\rangle = c_0^{\\ast}\\langle \\phi_0, \\phi_i \\rangle + c_1^{\\ast}\\langle \\phi_1, \\phi_i \\rangle + c_2^{\\ast}\\langle \\phi_2, \\phi_i \\rangle \\quad \\text{for } i = 0, 1, 2 $$\n\n在计算积分之前，我们可以通过考虑对称区间 $[-1, 1]$ 上所涉及函数的奇偶性来简化问题。\n如果 $g(-x) = g(x)$，则函数 $g(x)$ 是偶函数；如果 $g(-x) = -g(x)$，则函数 $g(x)$ 是奇函数。奇函数在对称区间 $[-a, a]$ 上的积分总是零。两个偶函数或两个奇函数的乘积是偶函数。一个偶函数和一个奇函数的乘积是奇函数。\n我们要逼近的函数是 $f(x) = x^3$，它是一个奇函数。\n$V$ 的基由 $\\phi_0(x) = 1$ (偶函数)，$\\phi_1(x) = x$ (奇函数) 和 $\\phi_2(x) = x^2$ (偶函数) 组成。\n\n这种奇偶性结构直接影响正交性。如果被积函数 $g(x)h(x)$ 是奇函数，则内积 $\\langle g, h \\rangle = \\int_{-1}^{1} g(x)h(x)dx$ 将为零。这种情况发生在一个函数是偶函数而另一个函数是奇函数时。这显著地简化了法方程组。\n\n让我们计算所需的内积：\n法方程的右边，$\\langle f, \\phi_i \\rangle$：\n$f(x) = x^3$ 是奇函数。\n$\\langle f, \\phi_0 \\rangle = \\langle x^3, 1 \\rangle = \\int_{-1}^{1} x^3 dx = 0$ (被积函数是奇函数)。\n$\\langle f, \\phi_1 \\rangle = \\langle x^3, x \\rangle = \\int_{-1}^{1} x^4 dx = \\left[\\frac{x^5}{5}\\right]_{-1}^{1} = \\frac{1}{5} - (-\\frac{1}{5}) = \\frac{2}{5}$。\n$\\langle f, \\phi_2 \\rangle = \\langle x^3, x^2 \\rangle = \\int_{-1}^{1} x^5 dx = 0$ (被积函数是奇函数)。\n\n左边矩阵元素 (格拉姆矩阵)，$\\langle \\phi_j, \\phi_i \\rangle$：\n$\\langle \\phi_0, \\phi_0 \\rangle = \\langle 1, 1 \\rangle = \\int_{-1}^{1} 1 dx = 2$。\n$\\langle \\phi_0, \\phi_1 \\rangle = \\langle 1, x \\rangle = \\int_{-1}^{1} x dx = 0$。\n$\\langle \\phi_0, \\phi_2 \\rangle = \\langle 1, x^2 \\rangle = \\int_{-1}^{1} x^2 dx = \\frac{2}{3}$。\n$\\langle \\phi_1, \\phi_1 \\rangle = \\langle x, x \\rangle = \\int_{-1}^{1} x^2 dx = \\frac{2}{3}$。\n$\\langle \\phi_1, \\phi_2 \\rangle = \\langle x, x^2 \\rangle = \\int_{-1}^{1} x^3 dx = 0$。\n$\\langle \\phi_2, \\phi_2 \\rangle = \\langle x^2, x^2 \\rangle = \\int_{-1}^{1} x^4 dx = \\frac{2}{5}$。\n\n关于系数 $(c_0^{\\ast}, c_1^{\\ast}, c_2^{\\ast})$ 的方程组变为：\n1. $c_0^{\\ast}\\langle \\phi_0, \\phi_0 \\rangle + c_1^{\\ast}\\langle \\phi_1, \\phi_0 \\rangle + c_2^{\\ast}\\langle \\phi_2, \\phi_0 \\rangle = \\langle f, \\phi_0 \\rangle \\implies c_0^{\\ast}(2) + c_1^{\\ast}(0) + c_2^{\\ast}(\\frac{2}{3}) = 0$。\n2. $c_0^{\\ast}\\langle \\phi_0, \\phi_1 \\rangle + c_1^{\\ast}\\langle \\phi_1, \\phi_1 \\rangle + c_2^{\\ast}\\langle \\phi_2, \\phi_1 \\rangle = \\langle f, \\phi_1 \\rangle \\implies c_0^{\\ast}(0) + c_1^{\\ast}(\\frac{2}{3}) + c_2^{\\ast}(0) = \\frac{2}{5}$。\n3. $c_0^{\\ast}\\langle \\phi_0, \\phi_2 \\rangle + c_1^{\\ast}\\langle \\phi_1, \\phi_2 \\rangle + c_2^{\\ast}\\langle \\phi_2, \\phi_2 \\rangle = \\langle f, \\phi_2 \\rangle \\implies c_0^{\\ast}(\\frac{2}{3}) + c_1^{\\ast}(0) + c_2^{\\ast}(\\frac{2}{5}) = 0$。\n\n基于奇偶性，该方程组解耦。第二个方程仅涉及奇基函数 $\\phi_1$，可以独立求解：\n$\\frac{2}{3} c_1^{\\ast} = \\frac{2}{5} \\implies c_1^{\\ast} = \\frac{3}{5}$。\n\n第一个和第三个方程构成了一个关于偶基函数系数的方程组：\n$$ 2c_0^{\\ast} + \\frac{2}{3}c_2^{\\ast} = 0 $$\n$$ \\frac{2}{3}c_0^{\\ast} + \\frac{2}{5}c_2^{\\ast} = 0 $$\n这是一个齐次线性方程组。系数矩阵的行列式为 $(2)(\\frac{2}{5}) - (\\frac{2}{3})(\\frac{2}{3}) = \\frac{4}{5} - \\frac{4}{9} = \\frac{36-20}{45} = \\frac{16}{45} \\neq 0$。由于该矩阵是非奇异的，唯一的解是平凡解：$c_0^{\\ast} = 0$ 和 $c_2^{\\ast} = 0$。\n\n这说明了一个一般原理：由偶函数和奇函数组成的基对一个奇函数 $f$ 的最佳逼近将仅由奇基函数构成。$f$ 在偶函数子空间上的投影为零。\n系数为 $c_0^{\\ast}=0$，$c_1^{\\ast}=\\frac{3}{5}$，$c_2^{\\ast}=0$。因此，最佳逼近多项式是 $p^{\\ast}(x) = \\frac{3}{5}x$。\n\n接下来，我们计算最小平方误差 $\\|f - p^{\\ast}\\|^2$。\n$\\|f - p^{\\ast}\\|^2 = \\langle f - p^{\\ast}, f - p^{\\ast} \\rangle$。\n根据 $p^{\\ast}$ 的构造，残差 $f-p^{\\ast}$ 与 $V$ 中的任何函数都正交。由于 $p^{\\ast} \\in V$，我们有 $\\langle f - p^{\\ast}, p^{\\ast} \\rangle = 0$。\n因此，我们可以将范数的平方展开为：\n$\\|f - p^{\\ast}\\|^2 = \\langle f - p^{\\ast}, f \\rangle - \\langle f - p^{\\ast}, p^{\\ast} \\rangle = \\langle f, f \\rangle - \\langle p^{\\ast}, f \\rangle$。\n\n我们计算所需的两项：\n$\\|f\\|^2 = \\langle f, f \\rangle = \\langle x^3, x^3 \\rangle = \\int_{-1}^{1} x^6 dx = \\left[\\frac{x^7}{7}\\right]_{-1}^{1} = \\frac{1}{7} - (-\\frac{1}{7}) = \\frac{2}{7}$。\n$\\langle p^{\\ast}, f \\rangle = \\langle \\frac{3}{5}x, x^3 \\rangle = \\frac{3}{5} \\langle x, x^3 \\rangle = \\frac{3}{5} \\int_{-1}^{1} x^4 dx = \\frac{3}{5} \\left( \\frac{2}{5} \\right) = \\frac{6}{25}$。\n\n最小平方误差是：\n$\\|f - p^{\\ast}\\|^2 = \\frac{2}{7} - \\frac{6}{25} = \\frac{2 \\cdot 25}{7 \\cdot 25} - \\frac{6 \\cdot 7}{25 \\cdot 7} = \\frac{50}{175} - \\frac{42}{175} = \\frac{8}{175}$。\n这个分数是最简形式，因为 $8=2^3$ 且 $175=5^2 \\cdot 7$。\n或者，可以直接计算残差平方的积分：\n$\\|f - p^{\\ast}\\|^2 = \\int_{-1}^{1} \\left(x^3 - \\frac{3}{5}x\\right)^2 dx = \\int_{-1}^{1} \\left(x^6 - \\frac{6}{5}x^4 + \\frac{9}{25}x^2\\right) dx$。\n由于被积函数是偶函数：\n$= 2 \\left[\\frac{x^7}{7} - \\frac{6}{5}\\frac{x^5}{5} + \\frac{9}{25}\\frac{x^3}{3}\\right]_{0}^{1} = 2 \\left(\\frac{1}{7} - \\frac{6}{25} + \\frac{3}{25}\\right) = 2 \\left(\\frac{1}{7} - \\frac{3}{25}\\right) = 2 \\left(\\frac{25-21}{175}\\right) = 2\\left(\\frac{4}{175}\\right) = \\frac{8}{175}$。\n两种方法得到相同的结果。最小平方误差是 $\\frac{8}{175}$。", "answer": "$$\n\\boxed{\\frac{8}{175}}\n$$", "id": "3218261"}]}