{"hands_on_practices": [{"introduction": "这项练习将带领我们对对称矩阵的性质进行基础性的探究。一个矩阵即使是对称的，也未必是正定的，而正定性是许多数值方法能够正确运行的关键属性。我们将探索如何通过一个简单的修改——“对角移位”——将一个非正定矩阵转化为正定矩阵，并通过分析矩阵的特征值来精确确定所需的最小移位量。这个技术不仅仅是理论上的概念，它是在优化和数值线性代数算法中广泛使用的基本工具。[@problem_id:3276792]", "problem": "考虑由下式定义的对称矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$\n$$\nA \\;=\\; \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n1 & 0 & 0 & 0 \\\\\n0 & 0 & 2 & 0 \\\\\n0 & 0 & 0 & 3\n\\end{pmatrix}.\n$$\n您将从特殊矩阵类型和谱条件的角度来分析 $A$。仅使用线性代数中的基本定义和熟知事实。\n\n(a) 判断矩阵 $A$ 是否为严格对角占优矩阵，以及是否为对称正定 (SPD; symmetric positive-definite) 矩阵。请从对角占优的定义和正定性定义（即对于所有非零向量 $x \\in \\mathbb{R}^{n}$，$x^{\\top} A x > 0$）出发，并结合熟知事实（即对于对称矩阵，正定性等价于其所有特征值均为严格正数）来证明您的结论。\n\n(b) 求加到单位矩阵 $I$ 上的最小扰动 $\\epsilon \\in \\mathbb{R}$，使得 $A + \\epsilon I$ 是对称正定的。在精确的阈值意义上理解“最小”：确定值 $\\epsilon_{\\mathrm{th}}$，使得对于所有 $\\epsilon > \\epsilon_{\\mathrm{th}}$，$A + \\epsilon I$ 都是对称正定的，并将该单一阈值 $\\epsilon_{\\mathrm{th}}$ 作为您的答案。无需四舍五入。", "solution": "经评估，该问题有效，因为它在科学上基于线性代数，是适定、客观且自洽的，没有可识别的缺陷。\n\n给定的矩阵是\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n1 & 0 & 0 & 0 \\\\\n0 & 0 & 2 & 0 \\\\\n0 & 0 & 0 & 3\n\\end{pmatrix}.\n$$\n题目陈述断言 $A$ 是对称的。如果一个矩阵 $M$ 满足 $M = M^\\top$，则该矩阵是对称的。对于给定的矩阵 $A$，我们可以看到 $a_{12} = a_{21} = 1$，且所有其他非对角元素 $a_{ij}$（其中 $i \\neq j$）均为零，这意味着对于所有的 $i,j$，都有 $a_{ij} = a_{ji}$。因此，$A$ 确实是对称的。\n\n(a) 我们分析 $A$ 是否为严格对角占优矩阵，以及是否为对称正定矩阵。\n\n首先，我们考虑严格对角占优性。如果对于每一行 $i$，对角元素的绝对值严格大于该行所有其他元素的绝对值之和，则矩阵 $A$ 是严格对角占优的。也就是说，对于所有的 $i \\in \\{1, 2, 3, 4\\}$，条件 $|a_{ii}| > \\sum_{j \\neq i} |a_{ij}|$ 必须成立。\n\n我们来检验矩阵 $A$ 是否满足此条件：\n对于第 $i=1$ 行：我们必须检查是否 $|a_{11}| > |a_{12}| + |a_{13}| + |a_{14}|$。\n这些值为 $|0| > |1| + |0| + |0|$，简化后为 $0 > 1$。这个不等式不成立。\n由于第一行不满足严格对角占优的条件，因此矩阵 $A$ 不是严格对角占优的。我们无需检查其他行。\n\n接下来，我们判断 $A$ 是否为对称正定 (SPD) 矩阵。一个对称矩阵是正定的，当且仅当它的所有特征值都严格为正。我们将计算 $A$ 的特征值。\n矩阵 $A$ 是一个分块对角矩阵，形式为 $A = \\begin{pmatrix} A_1 & 0 \\\\ 0 & A_2 \\end{pmatrix}$，其中\n$$\nA_1 = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix} \\quad \\text{和} \\quad A_2 = \\begin{pmatrix} 2 & 0 \\\\ 0 & 3 \\end{pmatrix}.\n$$\n$A$ 的特征值是 $A_1$ 和 $A_2$ 特征值的并集。\n对角矩阵 $A_2$ 的特征值是其对角线元素，即 $2$ 和 $3$。这两个值都是正数。\n为了求出 $A_1$ 的特征值，我们求解特征方程 $\\det(A_1 - \\lambda I) = 0$：\n$$\n\\det\\begin{pmatrix}\n0 - \\lambda & 1 \\\\\n1 & 0 - \\lambda\n\\end{pmatrix} = (-\\lambda)(-\\lambda) - (1)(1) = \\lambda^2 - 1 = 0.\n$$\n解为 $\\lambda = 1$ 和 $\\lambda = -1$。\n$A$ 的所有特征值的集合是 $\\{-1, 1, 2, 3\\}$。由于其中一个特征值为负 ($\\lambda = -1$)，矩阵 $A$ 不是正定的。\n\n根据要求，我们也可以使用定义 $x^\\top A x > 0$（对于所有非零向量 $x \\in \\mathbb{R}^4$）来证明这个结论。如果一个矩阵不是正定的，那么必然存在至少一个非零向量 $x$，使得 $x^\\top A x \\le 0$。对于这样的向量，一个典型的选择是对应于非正特征值的特征向量。我们找到了一个特征值 $\\lambda = -1$。让我们求出其对应的特征向量。$A_1$ 对应于 $\\lambda=-1$ 的特征向量 $v = (v_1, v_2)^\\top$ 必须满足 $(A_1 - (-1)I)v=0$：\n$$\n\\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n这给出了方程 $v_1 + v_2 = 0$。一个简单的非零解是 $v_1=1, v_2=-1$，所以 $v = (1, -1)^\\top$。我们可以通过补零将其扩展为完整矩阵 $A$ 的一个非零特征向量：$x = (1, -1, 0, 0)^\\top$。\n现在我们计算二次型 $x^\\top A x$：\n$$\nx^\\top A x = \\begin{pmatrix} 1 & -1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n1 & 0 & 0 & 0 \\\\\n0 & 0 & 2 & 0 \\\\\n0 & 0 & 0 & 3\n\\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 & -1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = (1)(-1) + (-1)(1) = -2.\n$$\n由于我们找到了一个非零向量 $x$ 使得 $x^\\top A x = -2 \\le 0$，所以矩阵 $A$ 不是正定的。\n\n总结(a)部分：$A$ 不是严格对角占优的，也不是对称正定的。\n\n(b) 我们寻找最小的实数 $\\epsilon$（记作 $\\epsilon_{\\mathrm{th}}$），使得矩阵 $B(\\epsilon) = A + \\epsilon I$ 对于所有 $\\epsilon > \\epsilon_{\\mathrm{th}}$ 都是对称正定的。\n\n首先，$B(\\epsilon)$ 是两个对称矩阵（$A$ 和 $\\epsilon I$）的和，因此对于任何 $\\epsilon \\in \\mathbb{R}$，它也是对称的。\n关联 $A$ 和 $A + \\epsilon I$ 特征值的一个关键性质是：如果 $\\lambda$ 是 $A$ 的一个特征值，那么 $\\lambda + \\epsilon$ 就是 $A + \\epsilon I$ 的一个特征值。这是因为如果对于某个特征向量 $v$ 有 $Av = \\lambda v$，那么 $(A + \\epsilon I)v = Av + \\epsilon Iv = \\lambda v + \\epsilon v = (\\lambda + \\epsilon)v$。\n$A$ 的特征值为 $\\{-1, 1, 2, 3\\}$。\n因此，$B(\\epsilon) = A + \\epsilon I$ 的特征值为 $\\{-1+\\epsilon, 1+\\epsilon, 2+\\epsilon, 3+\\epsilon\\}$。\n\n要使 $B(\\epsilon)$ 是对称正定的，其所有特征值必须严格为正。这给了我们一个不等式组：\n\\begin{enumerate}\n    \\item $-1 + \\epsilon > 0 \\implies \\epsilon > 1$\n    \\item $1 + \\epsilon > 0 \\implies \\epsilon > -1$\n    \\item $2 + \\epsilon > 0 \\implies \\epsilon > -2$\n    \\item $3 + \\epsilon > 0 \\implies \\epsilon > -3$\n\\end{enumerate}\n为了同时满足这四个不等式，我们必须满足最严格的一个，即 $\\epsilon > 1$。\n使得 $A+\\epsilon I$ 是对称正定的所有 $\\epsilon$ 的集合是区间 $(1, \\infty)$。问题要求的是阈值 $\\epsilon_{\\mathrm{th}}$，使得对于所有 $\\epsilon > \\epsilon_{\\mathrm{th}}$，该性质都成立。这个阈值是有效 $\\epsilon$ 值集合的下确界。\n区间 $(1, \\infty)$ 的下确界是 $1$。\n因此，最小的这种扰动阈值是 $\\epsilon_{\\mathrm{th}} = 1$。对于任何 $\\epsilon > 1$，矩阵 $A+\\epsilon I$ 都将是对称正定的。当 $\\epsilon=1$ 时，最小的特征值为 $0$，这使得矩阵是半正定的，但不是正定的。\n所要求的阈值为 $\\epsilon_{\\mathrm{th}} = 1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "3276792"}, {"introduction": "在前一个练习修改矩阵以改变其性质的概念基础上，本练习将从解析计算转向计算探索。在实际应用中，我们经常处理随时间或某个参数变化的系统。本练习模拟了这样一个场景，通过考察一个参数化的矩阵族，要求你精确定位该矩阵族从正定变为非正定的临界点。你将实现一个稳健的数值策略，该策略结合了作为对称正定（SPD）权威测试的Cholesky分解和高效搜索此临界阈值的二分法。[@problem_id:3276796]", "problem": "要求您通过构造和计算来研究，当通过修改单个元素使对称正定矩阵脱离对称正定类别时，不选主元的 Cholesky 分解是否会以一种可控的方式失败。请纯粹在数学和算法逻辑的框架内进行研究，并假设精确算术是概念基础。您的实现应使用双精度浮点数来模拟有限精度实数算术。\n\n从以下基本依据开始：\n- 定义：对于一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$，如果对所有非零向量 $x \\in \\mathbb{R}^{n}$ 都有 $x^{\\top} A x \\gt 0$，则该矩阵是对称正定 (SPD) 的。\n- 事实：不选主元的 Cholesky 算法尝试计算 $A = LL^{\\top}$，其中 $L$ 是具有严格正对角元的下三角矩阵。在精确算术中，该算法当且仅当 $A$ 是 SPD 时才能成功。\n- 事实：在不选主元的 Cholesky 算法（$LL^{\\top}$ 的 Doolittle 类形式）中，在第 $k$ 步，会形成更新后的对角元（第 $k$ 个舒尔补主元）$s_k = a_{kk} - \\sum_{j=1}^{k-1} \\ell_{kj}^{2}$。如果 $s_k \\le 0$，则 $A$ 不是 SPD，算法停止；否则 $\\ell_{kk} = \\sqrt{s_k}$ 且该步骤继续。\n\n您的任务：\n- 对于给定的对称基矩阵 $A$ 和一个对称更新方向 $S$（其在对角线上有一个非零位置，或在非对角线上有一对对称的非零元），考虑单参数族 $A(t) = A + t S$，其中 $t \\in [0, t_{\\max}]$。\n- 假设 $A(0)$ 是 SPD，且存在某个 $t^\\star \\in (0, t_{\\max}]$，使得 $A(t)$ 在此点不再是 SPD。\n- 实现一个例程，使用不选主元的 Cholesky 分解来测试 $A(t)$ 是否为 SPD。方法是依次检查每个更新后的对角元 $s_k$ 的正性，并在遇到第一个非正的 $s_k$ 时停止。记录序列 $\\{s_1, s_2, \\dots\\}$ 直至并包括失败的主元。\n- 在 $[0, t_{\\max}]$ 区间上对 $t$ 使用二分法，以找到该区间内（在规定的绝对公差范围内）使不选主元的 Cholesky 分解失败（即某个 $s_k \\le 0$）的最小 $t^\\star$。您不得依赖特征值计算；必须仅通过 Cholesky 测试来判断 SPD。二分法依赖于特征值的连续性以及 SPD 与不选主元的 Cholesky 分解成功的等价性。\n\n科学真实性要求：\n- 当任何更新后的对角元 $s_k \\le \\varepsilon_{\\text{chol}}$ 时，视为失败，其中 $\\varepsilon_{\\text{chol}}$ 是一个小的正公差，以反映有限精度。使用 $\\varepsilon_{\\text{chol}} = 10^{-12}$。\n- 使用绝对二分公差 $\\varepsilon_t = 10^{-12}$，并返回最终区间的上端点作为 $t^\\star$，以便您的 Cholesky 测试能检测到 $A(t^\\star)$ 失败。\n\n跟踪要求：\n- 对于您在每个测试用例中找到的最终 $t^\\star$，对 $A(t^\\star)$ 再次运行不选主元的 Cholesky 测试并记录：\n  1. 失败步骤索引 $k_{\\text{fail}}$（使用基于 1 的索引），\n  2. 直至并包括失败主元所遇到的更新后对角元值列表 $\\left[s_1, s_2, \\dots, s_{k_{\\text{fail}}}\\right]$。\n\n测试套件：\n提供以下三种情况的结果。在每种情况下，$A$ 是对称的，$S$ 是对称的，且在对角线上有一个非零元或一对对称的非对角元，$t_{\\max}$ 的选择确保失败发生在区间内。\n- 情况 1（严格对角占优基底，非对角扰动）：\n  - $A = \\begin{bmatrix} 4 & -1 & 0 \\\\ -1 & 4 & -1 \\\\ 0 & -1 & 3 \\end{bmatrix}$，\n  - $S = \\begin{bmatrix} 0 & 0 & -1 \\\\ 0 & 0 & 0 \\\\ -1 & 0 & 0 \\end{bmatrix}$，\n  - $t_{\\max} = 10$。\n- 情况 2（对角元减少导致失去正定性）：\n  - $A = \\begin{bmatrix} 2 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 2 \\end{bmatrix}$，\n  - $S = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}$，\n  - $t_{\\max} = 3$。\n- 情况 3（近边界分块结构，非对角元增加）：\n  - $A = \\begin{bmatrix} 1 & 0.999 & 0 & 0 \\\\ 0.999 & 1 & 0 & 0 \\\\ 0 & 0 & 1.5 & 0.1 \\\\ 0 & 0 & 0.1 & 1.5 \\end{bmatrix}$，\n  - $S = \\begin{bmatrix} 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{bmatrix}$，\n  - $t_{\\max} = 0.01$。\n\n对于每种情况，您的程序必须计算并报告：\n- $t^\\star$ 四舍五入到 12 位小数，\n- $k_{\\text{fail}}$ 作为整数，\n- 在 $t^\\star$ 处的更新后对角元列表 $\\left[s_1, \\dots, s_{k_{\\text{fail}}}\\right]$，每个值四舍五入到 12 位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个无逗号、无空格的 JSON 风格列表形式的结果。输出必须是形如 \"[[t1,k1,[p11,p12,...]],[t2,k2,[p21,p22,...]],[t3,k3,[p31,p32,...]]]\" 的单行字符串，所有浮点值均以十进制形式打印。不应打印任何中间文本。\n\n角度单位不适用。不涉及物理单位。所有数值答案必须按要求以十进制浮点数或整数形式返回。该问题具有普遍适用性，必须能用任何现代语言完全解决；您必须使用指定的语言和仅必需的库来实现它。", "solution": "### 步骤 1：提取已知信息\n- **定义**：一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定 (SPD) 的，如果对所有非零向量 $x \\in \\mathbb{R}^{n}$ 都有 $x^{\\top} A x > 0$。\n- **事实**：不选主元的 Cholesky 算法尝试计算 $A = LL^{\\top}$，其中 $L$ 是具有严格正对角元的下三角矩阵。它当且仅当 $A$ 是 SPD 时才能成功（在精确算术中）。\n- **算法细节**：在不选主元的 Cholesky 算法的第 $k$ 步，更新后的对角主元是 $s_k = a_{kk} - \\sum_{j=1}^{k-1} \\ell_{kj}^{2}$。如果 $s_k \\le 0$，算法失败。否则，$\\ell_{kk} = \\sqrt{s_k}$。\n- **问题设置**：\n    - 定义了一个单参数矩阵族 $A(t) = A + t S$，其中 $t \\in [0, t_{\\max}]$。\n    - 给定 $A(0)$ 是 SPD。\n    - 已知存在某个 $t^\\star \\in (0, t_{\\max}]$，使得 $A(t)$ 不再是 SPD。\n- **任务**：\n    1. 实现一个不选主元的 Cholesky 分解例程来测试 SPD 属性。失败定义为任何主元 $s_k \\le \\varepsilon_{\\text{chol}}$。\n    2. 在区间 $[0, t_{\\max}]$ 上对参数 $t$ 使用二分法，找到 Cholesky 分解失败的最小 $t^\\star$。\n    3. 对于计算出的 $t^\\star$，记录失败步骤索引 $k_{\\text{fail}}$（基于 1）和主元序列 $[s_1, s_2, \\dots, s_{k_{\\text{fail}}}]$。\n- **公差**：\n    - Cholesky 失败公差：$\\varepsilon_{\\text{chol}} = 10^{-12}$。\n    - 二分法绝对公差：$\\varepsilon_t = 10^{-12}$。\n- **测试用例**：\n    - **情况 1**：\n        - $A = \\begin{bmatrix} 4 & -1 & 0 \\\\ -1 & 4 & -1 \\\\ 0 & -1 & 3 \\end{bmatrix}$\n        - $S = \\begin{bmatrix} 0 & 0 & -1 \\\\ 0 & 0 & 0 \\\\ -1 & 0 & 0 \\end{bmatrix}$\n        - $t_{\\max} = 10$\n    - **情况 2**：\n        - $A = \\begin{bmatrix} 2 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 2 \\end{bmatrix}$\n        - $S = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}$\n        - $t_{\\max} = 3$\n    - **情况 3**：\n        - $A = \\begin{bmatrix} 1 & 0.999 & 0 & 0 \\\\ 0.999 & 1 & 0 & 0 \\\\ 0 & 0 & 1.5 & 0.1 \\\\ 0 & 0 & 0.1 & 1.5 \\end{bmatrix}$\n        - $S = \\begin{bmatrix} 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{bmatrix}$\n        - $t_{\\max} = 0.01$\n- **输出要求**：\n    - 报告 $t^\\star$，四舍五入到 12 位小数。\n    - 报告 $k_{\\text{fail}}$，作为整数。\n    - 报告在 $t^\\star$ 处的主元列表，每个值四舍五入到 12 位小数。\n    - 最终程序输出必须是单行字符串：`[[t1,k1,[p11,p12,...]],[t2,k2,[p21,p22,...]],[t3,k3,[p31,p32,...]]]`\n\n### 步骤 2：使用提取的已知信息进行验证\n该问题在科学上基于矩阵分析和数值方法的基本理论。对称正定性与 Cholesky 分解成功之间的关系是一个基石定理。使用二分法寻找参数化矩阵的 SPD 锥边界是一种标准且适定的数值研究。问题陈述具有数学精确性，提供了所有必需的矩阵、参数、算法和公差。它是客观、自洽的，没有矛盾或歧义。它没有违反任何指定的无效标准。\n\n### 步骤 3：结论与行动\n问题有效。将构建一个解决方案。\n\n### 方法\n该问题要求找到临界参数 $t^\\star$，在该参数下，矩阵族 $A(t) = A + tS$ 不再是对称正定 (SPD) 的。该方法的核心是利用这样一个事实：一个对称矩阵是 SPD 的，当且仅当其不选主元的 Cholesky 分解 $A=LL^\\top$ 存在，其中 $L$ 是具有严格正对角元的下三角矩阵。\n\n总体步骤如下：\n\n1.  **Cholesky SPD 测试**：实现一个函数来测试给定的对称矩阵 $M$ 是否为 SPD。该函数尝试计算 Cholesky 因子 $L$。在每一步 $k$（对于 $k=1, \\dots, n$），它通过主元 $s_k$ 计算预期的对角项 $\\ell_{kk}$。主元的公式源自矩阵方程 $M=LL^\\top$：\n    $$m_{kk} = \\sum_{j=1}^{k} \\ell_{kj}^2 = \\ell_{kk}^2 + \\sum_{j=1}^{k-1} \\ell_{kj}^2$$\n    这给出了第 $k$ 个主元的表达式，也就是舒尔补的第 $k$ 个对角元：\n    $$s_k = \\ell_{kk}^2 = m_{kk} - \\sum_{j=1}^{k-1} \\ell_{kj}^2$$\n    如果任何 $s_k \\le 0$，矩阵 $M$ 就不是 SPD。为了考虑有限精度算术，我们用一个小的正公差进行测试，$s_k \\le \\varepsilon_{\\text{chol}}$。如果满足此条件，分解失败，函数报告该矩阵不是 SPD，并返回失败索引 $k$ 和截至该点计算出的主元列表。如果对所有 $k$ 分解都完成，则认为该矩阵是 SPD。\n\n2.  **二分搜索**：Cholesky SPD 测试可作为一个布尔函数 $f(t)$，如果 $A(t)$ 是 SPD，则为 true，否则为 false。我们已知 $f(0)$ 为 true，$f(t_{\\max})$ 为 false。由于 $A(t)$ 的特征值是 $t$ 的连续函数，并且一个矩阵是 SPD 当且仅当其所有特征值都为正，因此使 $A(t)$ 为 SPD 的 $t$ 集合是一个连续区间 $[0, t^\\star)$。因此，二分法非常适合用来寻找 $t^\\star$。\n    - 初始化搜索区间 $[t_{\\text{low}}, t_{\\text{high}}] = [0, t_{\\max}]$。\n    - 当区间宽度 $(t_{\\text{high}} - t_{\\text{low}})$ 大于指定公差 $\\varepsilon_t$ 时进行迭代。\n    - 在每次迭代中，计算中点 $t_{\\text{mid}} = t_{\\text{low}} + (t_{\\text{high}} - t_{\\text{low}}) / 2$。\n    - 使用 Cholesky SPD 测试来测试矩阵 $A(t_{\\text{mid}})$。\n        - 如果 $A(t_{\\text{mid}})$ 是 SPD，则意味着失败点在更大的 $t$ 值处。我们通过设置 $t_{\\text{low}} = t_{\\text{mid}}$ 来更新区间。\n        - 如果 $A(t_{\\text{mid}})$ 不是 SPD，则失败点在 $t_{\\text{mid}}$ 或更小的值处。我们通过设置 $t_{\\text{high}} = t_{\\text{mid}}$ 来更新区间。\n    - 当搜索区间足够小时，过程终止。问题指定返回最终区间的上端点 $t_{\\text{high}}$ 作为 $t^\\star$ 的估计值。\n\n3.  **结果计算**：对于每个测试用例，运行二分搜索以找到其对应的 $t^\\star$。然后，构成矩阵 $A(t^\\star)$，并最后一次运行 Cholesky SPD 测试，以获得确定的失败索引 $k_{\\text{fail}}$ 和主元列表 $[s_1, s_2, \\dots, s_{k_{\\text{fail}}}]$。这些结果将根据问题规范进行四舍五入和格式化。", "answer": "[[2.819316533351,3,[4.000000000000,3.750000000000,0.000000000000]],[2.000000000000,2,[2.000000000000,0.000000000000]],[0.001000000000,2,[1.000000000000,0.000000000000]]]", "id": "3276796"}, {"introduction": "我们的探索之旅现在将从精确算术的世界转向计算的实际应用。理论上，一个对称正定矩阵总能进行Cholesky分解。然而，在真实计算机上使用有限精度的浮点算术时，由于舍入误差的累积，分解过程可能会意外失败，对于病态矩阵尤其如此。这项动手编程任务将挑战你来验证这一核心概念，通过实验展示理论上完美的Cholesky算法如何对著名的病态希尔伯特(Hilbert)矩阵失效，并探索一种称为“正则化”的技术如何成为恢复数值稳定性的实用生命线。[@problem_id:3276870]", "problem": "考虑一个基本事实：一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定（Symmetric Positive-Definite, SPD）的，当且仅当对于所有非零向量 $x \\in \\mathbb{R}^n$，都有 $x^{\\top} A x > 0$。根据此定义和矩阵分解理论，可以推断出任何 SPD 矩阵都存在唯一的 Cholesky 分解，即 $A = L L^{\\top}$，其中 $L$ 是一个对角线元素严格为正的下三角矩阵。在精确算术中，每个 SPD 矩阵都存在这种分解。\n\n然而，在有限精度浮点算术中，每个基本运算都会有舍入。我们可以将单个有限精度运算建模为将实数值 $y$ 映射到 $\\operatorname{round}(y)$，其中 $\\operatorname{round}(y)$ 表示舍入到指定有效数字位数后的值。由于舍入误差的累积，一个在精确算术下能够产生有效 Cholesky 分解的算法，在有限精度下可能会遇到非正主元（即计算出的 $A_{ii} - \\sum_{k=1}^{i-1} L_{ik}^2 \\le 0$），并因此失败终止。这种现象对于病态 SPD 矩阵尤其显著，例如希尔伯特矩阵（Hilbert matrix），其元素定义为 $H_{ij} = \\frac{1}{i + j - 1}$。\n\n你的任务是设计并实现一个独立的程序，该程序通过将中间结果舍入到固定的有效数字位数来模拟有限精度算术，并使用此模拟来演示浮点舍入如何导致一个理论上的 SPD 矩阵（具体来说是希尔伯特矩阵）在实践中无法通过 Cholesky 分解测试。该程序必须实现：\n- 通过 $H_{ij} = \\frac{1}{i + j - 1}$ 构建希尔伯特矩阵 $H \\in \\mathbb{R}^{n \\times n}$。\n- 一个 Cholesky 分解程序，它在模拟的有限精度下执行所有中间算术运算，即在每次加、减、乘、除和开方运算后都舍入到指定的有效数字位数。\n- 一个对角正则化操作，将 $A$ 替换为 $A + \\varepsilon I$（其中 $I$ 是单位矩阵，$\\varepsilon > 0$ 是选定的正则化参数），以测试添加一个小的正对角项如何在有限精度下稳定分解过程。\n\n使用以下参数值测试套件来涵盖该现象的多个方面：\n1. 理想情况（高精度）：$n = 5$，有效数字 $s = 16$，无正则化（$\\varepsilon = 0$）。报告一个布尔值，指示模拟精度下的 Cholesky 分解是否失败。\n2. 舍入引发的失败（中等精度）：$n = 12$，有效数字 $s = 6$，无正则化（$\\varepsilon = 0$）。报告一个布尔值，指示分解是否失败。\n3. 强舍入引发的失败：$n = 12$，有效数字 $s = 4$，无正则化（$\\varepsilon = 0$）。报告一个布尔值，指示分解是否失败。\n4. 通过对角正则化实现稳定：对于 $n = 12$ 和有效数字 $s = 6$，在集合 $\\{10^{-12}, 10^{-10}, 10^{-8}, 10^{-6}, 10^{-5}, 10^{-4}, 10^{-3}, 10^{-2}, 10^{-1}\\}$ 中搜索最小的 $\\varepsilon$，使得 $H + \\varepsilon I$ 在模拟精度下的 Cholesky 分解成功。将此 $\\varepsilon$ 作为浮点数报告。如果无一成功，则报告 $\\mathrm{NaN}$。\n5. 正则化后验证：使用测试4中找到的 $\\varepsilon$（如果未找到，则为 $\\mathrm{NaN}$），对 $n = 12, s = 6$ 再次运行模拟精度下的 Cholesky 分解。报告一个布尔值，指示分解是否失败。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4,result5]”），结果按顺序对应上述五个测试。所有报告的值必须是指定的布尔值或浮点数。此问题不涉及物理单位或角度单位。", "solution": "该问题要求分析 Cholesky 分解算法在模拟有限精度算术下应用于病态对称正定（SPD）矩阵时的数值稳定性。我们将构建一个程序，使用希尔伯特矩阵来演示这一现象。\n\n### Cholesky 分解原理\n\n一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 被定义为对称正定（SPD），如果对于所有非零向量 $x \\in \\mathbb{R}^n$，其二次型 $x^{\\top} A x$ 严格为正。线性代数中的一个基本定理指出，一个矩阵是 SPD 的，当且仅当它存在唯一的 Cholesky 分解 $A = L L^{\\top}$，其中 $L \\in \\mathbb{R}^{n \\times n}$ 是一个对角线元素严格为正（$L_{ii} > 0$）的下三角矩阵。\n\n$L$ 的元素可以按顺序计算。$L_{ij}$ 各项的公式（使用基于 1 的索引）如下：\n- 对角线元素（$j=i$）：\n$$L_{ii} = \\sqrt{A_{ii} - \\sum_{k=1}^{i-1} L_{ik}^2}$$\n- 非对角线元素（$j  i$）：\n$$L_{ij} = \\frac{1}{L_{jj}} \\left( A_{ij} - \\sum_{k=1}^{j-1} L_{ik}L_{jk} \\right)$$\n在算法的每一步，计算对角元素 $L_{ii}$ 都需要对一个值开平方根。如果这个值是负数或零，分解就会失败。在精确算术中，对于 SPD 矩阵，这个值总是正的。然而，在有限精度下，舍入误差的累积可能导致这个值变为非正数，尤其是在处理病态矩阵（其特征值范围很广）时。\n\n### 希尔伯特矩阵与病态性\n\n希尔伯特矩阵 $H$ 的元素为 $H_{ij} = 1/(i+j-1)$。这是一个经典的 SPD 矩阵，但它也是出了名的病态。随着矩阵大小 $n$ 的增加，其条件数会呈指数级增长。这意味着即使是微小的输入误差（如浮点舍入）也可能在计算中被极大地放大。\n\n### 正则化\n\n对角正则化是一种通过向矩阵的对角线添加一个小的正值 $\\varepsilon$ 来改善其数值性质的技术，即 $A_{\\text{reg}} = A + \\varepsilon I$。这种操作会使矩阵的特征值 $\\lambda_k$ 变为 $\\lambda_k + \\varepsilon$，从而确保所有特征值都离零更远。这有效地降低了矩阵的条件数，使其在有限精度计算中更加稳定。\n\n### 模拟与测试\n\n该问题要求通过模拟具有固定有效数字位数的算术运算来验证这些概念。这意味着程序中的每次加法、减法、乘法、除法和开方运算都必须在执行后立即舍入到指定的有效数字位数。通过在一系列参数下（矩阵大小 $n$、有效数字 $s$ 和正则化参数 $\\varepsilon$）运行模拟的 Cholesky 分解，我们将观察并量化理论上稳定的算法在实践中是如何失效的，以及如何通过正则化来修复它。", "answer": "[False,True,True,1e-10,False]", "id": "3276870"}]}