{"hands_on_practices": [{"introduction": "理论误差界限是一个强大的预测工具，能让我们在执行计算前就估算所需的计算量。本练习 [@problem_id:3224894] 将指导你应用辛普森法则的理论误差公式，来精确确定为了使积分误差小于一个给定的阈值（例如 $10^{-10}$），所需要的最少子区间数量 $n$。这个技能对于高效地规划计算任务至关重要。", "problem": "考虑定积分 $\\int_{0}^{\\pi} \\cos(x)\\,dx$ 及其通过复合辛普森法则的近似，该近似使用 $[0,\\pi]$ 的一个均匀分割，分为 $n$ 个子区间，其中 $n$ 是一个正偶数，步长为 $h = \\frac{\\pi}{n}$。从第一性原理出发——具体来说，是带余项的泰勒定理和辛普森法则对至多3次多项式的精确性——推导一个复合辛普森法则的理论全局截断误差界，该界依赖于 $h$ 和被积函数的四阶导数。然后，将此界应用于函数 $f(x) = \\cos(x)$ 在 $[0,\\pi]$ 上，并确定最小的偶数整数 $n$，使得该界严格小于 $10^{-10}$。你的最终答案必须是单个整数 $n$。不要四舍五入；找出满足所述不等式的最小偶数 $n$。", "solution": "该问题是有效的，因为它科学地基于数值分析的原理，问题提法良好且有唯一解，并以客观、正式的语言表达。它自成体系，没有矛盾。我现在开始解答。\n\n该问题要求完成两个主要任务：首先，从第一性原理推导复合辛普森法则的全局截断误差界；其次，应用此界找到最小的偶数整数 $n$，以保证积分 $\\int_{0}^{\\pi} \\cos(x)\\,dx$ 达到一定的精度。\n\n**第一部分：全局截断误差界的推导**\n\n令 $I = \\int_{a}^{b} f(x)\\,dx$。复合辛普森法则通过将区间 $[a,b]$ 分割成偶数个子区间（$n$ 个），每个子区间的宽度为 $h = \\frac{b-a}{n}$，来近似该积分。该法则应用于连续的子区间对，即在形如 $[x_{2i}, x_{2i+2}]$ 的 $n/2$ 个区间上应用，其中 $i$ 的范围从 $0$ 到 $\\frac{n}{2}-1$。\n\n推导始于基本辛普森法则在宽度为 $2h$、中心点为 $c$ 的单个区间上的误差。设该区间为 $[c-h, c+h]$。基本辛普森法则的近似值为 $S = \\frac{h}{3}[f(c-h) + 4f(c) + f(c+h)]$。局部误差为 $E_{loc} = \\int_{c-h}^{c+h} f(x)\\,dx - S$。\n\n问题指定使用辛普森法则对至多3次的多项式是精确的这一事实。令 $P_3(x)$ 为 $f(x)$ 在中心点 $c$ 展开的3次泰勒多项式：\n$$P_3(x) = f(c) + f'(c)(x-c) + \\frac{f''(c)}{2!}(x-c)^2 + \\frac{f'''(c)}{3!}(x-c)^3$$\n根据泰勒定理，余项为 $R_3(x) = f(x) - P_3(x) = \\frac{f^{(4)}(\\xi_x)}{4!}(x-c)^4$，对于某个在 $c$ 和 $x$ 之间的 $\\xi_x$。\n\n误差泛函 $E_{loc}(f)$ 是线性的。因此，\n$$E_{loc}(f) = E_{loc}(P_3(x) + R_3(x)) = E_{loc}(P_3(x)) + E_{loc}(R_3(x))$$\n由于辛普森法则对任何3次或以下的多项式都是精确的，所以 $E_{loc}(P_3(x)) = 0$。因此，误差完全由余项决定：\n$$E_{loc}(f) = E_{loc}(R_3(x)) = \\int_{c-h}^{c+h} R_3(x)\\,dx - \\frac{h}{3}[R_3(c-h) + 4R_3(c) + R_3(c+h)]$$\n我们计算每一项：\n$R_3(x) = \\frac{f^{(4)}(\\xi_x)}{24}(x-c)^4$。\n$R_3(c) = 0$。\n$R_3(c-h) = \\frac{f^{(4)}(\\eta_1)}{24}(-h)^4 = \\frac{h^4}{24}f^{(4)}(\\eta_1)$，对于某个 $\\eta_1 \\in (c-h, c)$。\n$R_3(c+h) = \\frac{f^{(4)}(\\eta_2)}{24}(h)^4 = \\frac{h^4}{24}f^{(4)}(\\eta_2)$，对于某个 $\\eta_2 \\in (c, c+h)$。\n\n积分项为 $\\int_{c-h}^{c+h} \\frac{f^{(4)}(\\xi_x)}{24}(x-c)^4\\,dx$。由于在区间上 $(x-c)^4 \\ge 0$，我们可以应用积分中值定理。假设 $f^{(4)}(x)$ 在 $[c-h, c+h]$ 上连续，则存在一个 $\\zeta_1 \\in (c-h, c+h)$ 使得：\n$$\\int_{c-h}^{c+h} \\frac{f^{(4)}(\\xi_x)}{24}(x-c)^4\\,dx = \\frac{f^{(4)}(\\zeta_1)}{24} \\int_{c-h}^{c+h} (x-c)^4\\,dx = \\frac{f^{(4)}(\\zeta_1)}{24} \\left[\\frac{(x-c)^5}{5}\\right]_{c-h}^{c+h} = \\frac{f^{(4)}(\\zeta_1)}{24} \\frac{2h^5}{5} = \\frac{h^5}{60}f^{(4)}(\\zeta_1)$$\n近似项为：\n$$\\frac{h}{3}[R_3(c-h) + 4R_3(c) + R_3(c+h)] = \\frac{h}{3}\\left[\\frac{h^4}{24}f^{(4)}(\\eta_1) + 0 + \\frac{h^4}{24}f^{(4)}(\\eta_2)\\right] = \\frac{h^5}{72}[f^{(4)}(\\eta_1)+f^{(4)}(\\eta_2)]$$\n根据介值定理，存在一个 $\\zeta_2 \\in (c-h, c+h)$ 使得 $f^{(4)}(\\eta_1) + f^{(4)}(\\eta_2) = 2f^{(4)}(\\zeta_2)$。所以该项变为 $\\frac{2h^5}{72}f^{(4)}(\\zeta_2) = \\frac{h^5}{36}f^{(4)}(\\zeta_2)$。\n\n综合这些结果，局部误差为：\n$$E_{loc}(f) = \\frac{h^5}{60}f^{(4)}(\\zeta_1) - \\frac{h^5}{36}f^{(4)}(\\zeta_2)$$\n如果 $f^{(4)}(x)$ 是一个常数 $K$，误差将是 $K h^5(\\frac{1}{60} - \\frac{1}{36}) = K h^5(\\frac{3-5}{180}) = -\\frac{K h^5}{90}$。\n更正式地，通过达布定理（或使用此处不要求的更高级的皮亚诺核论证），存在一个单一值 $\\xi \\in (c-h, c+h)$，使得局部误差精确为：\n$$E_{loc} = -\\frac{h^5}{90}f^{(4)}(\\xi)$$\n这是辛普森法则在宽度为 $2h$ 的单个区间上应用的误差。\n\n对于复合法则，区间 $[a,b]$ 被分成 $n$ 个宽度为 $h_{comp} = \\frac{b-a}{n}$ 的子区间。该法则在宽度为 $2h_{comp}$ 的 $[x_{2i}, x_{2i+2}]$ 区间上应用 $n/2$ 次。因此，每次应用的半宽度是 $h_{comp}$。让我们将 $h_{comp}$ 重命名为 $h$ 以匹配问题陈述。在子区间 $[x_{2i}, x_{2i+2}]$ 上的误差是：\n$$E_i = -\\frac{h^5}{90}f^{(4)}(\\xi_i)$$\n对于某个 $\\xi_i \\in (x_{2i}, x_{2i+2})$。\n\n总的全局误差 $E_S$ 是这些局部误差的和：\n$$E_S = \\sum_{i=0}^{n/2 - 1} E_i = \\sum_{i=0}^{n/2 - 1} \\left( -\\frac{h^5}{90}f^{(4)}(\\xi_i) \\right) = -\\frac{h^5}{90} \\sum_{i=0}^{n/2 - 1} f^{(4)}(\\xi_i)$$\n由于 $f^{(4)}(x)$ 在 $[a,b]$ 上连续，我们可以对和应用介值定理：\n$$\\sum_{i=0}^{n/2 - 1} f^{(4)}(\\xi_i) = \\left(\\frac{n}{2}\\right) f^{(4)}(\\xi)$$\n对于某个 $\\xi \\in (a,b)$。\n将此代入 $E_S$ 的表达式中：\n$$E_S = -\\frac{h^5}{90} \\left(\\frac{n}{2}\\right) f^{(4)}(\\xi) = -\\frac{nh^5}{180}f^{(4)}(\\xi)$$\n最后，我们代入 $n = \\frac{b-a}{h}$：\n$$E_S = -\\frac{(b-a)/h \\cdot h^5}{180}f^{(4)}(\\xi) = -\\frac{(b-a)h^4}{180}f^{(4)}(\\xi)$$\n理论全局截断误差界是该表达式的绝对值，在 $\\xi$ 的可能值上取最大值：\n$$|E_S| \\le \\frac{(b-a)h^4}{180} \\max_{x \\in [a,b]} |f^{(4)}(x)|$$\n推导到此完成。\n\n**第二部分：应用于具体问题**\n\n我们给定的积分是 $\\int_{0}^{\\pi} \\cos(x)\\,dx$。\n这里，$f(x) = \\cos(x)$，$a=0$，$b=\\pi$。区间长度是 $b-a = \\pi$。\n步长是 $h = \\frac{\\pi}{n}$。\n我们必须求出 $f(x)$ 的四阶导数：\n$f'(x) = -\\sin(x)$\n$f''(x) = -\\cos(x)$\n$f'''(x) = \\sin(x)$\n$f^{(4)}(x) = \\cos(x)$\n\n接下来，我们求四阶导数在区间 $[0, \\pi]$ 上的最大绝对值：\n$$\\max_{x \\in [0,\\pi]} |f^{(4)}(x)| = \\max_{x \\in [0,\\pi]} |\\cos(x)| = 1$$\n这个最大值在 $x=0$ 和 $x=\\pi$ 处取得。\n\n将这些值代入误差界公式：\n$$|E_S| \\le \\frac{\\pi \\cdot h^4}{180} \\cdot 1 = \\frac{\\pi h^4}{180}$$\n现在，我们代入 $h = \\pi/n$：\n$$|E_S| \\le \\frac{\\pi}{180} \\left(\\frac{\\pi}{n}\\right)^4 = \\frac{\\pi^5}{180 n^4}$$\n\n**第三部分：确定最小的偶数整数 $n$**\n\n我们需要找到最小的偶数整数 $n$，使得该误差界严格小于 $10^{-10}$。\n$$\\frac{\\pi^5}{180 n^4}  10^{-10}$$\n我们解这个关于 $n$ 的不等式：\n$$n^4 > \\frac{\\pi^5}{180 \\cdot 10^{-10}}$$\n$$n^4 > \\frac{\\pi^5 \\cdot 10^{10}}{180}$$\n两边取四次方根：\n$$n > \\left(\\frac{\\pi^5 \\cdot 10^{10}}{180}\\right)^{1/4}$$\n$$n > \\left(\\frac{\\pi^5}{180}\\right)^{1/4} \\cdot (10^{10})^{1/4}$$\n$$n > \\left(\\frac{\\pi^5}{180}\\right)^{1/4} \\cdot 10^{2.5}$$\n现在我们计算数值：\n$\\pi^5 \\approx 306.0196847$\n$\\frac{\\pi^5}{180} \\approx \\frac{306.0196847}{180} \\approx 1.700109359$\n$\\left(\\frac{\\pi^5}{180}\\right)^{1/4} \\approx (1.700109359)^{1/4} \\approx 1.1418765$\n$10^{2.5} = 100\\sqrt{10} \\approx 100 \\cdot 3.16227766 \\approx 316.227766$\n所以，关于 $n$ 的不等式是：\n$$n > 1.1418765 \\times 316.227766 \\approx 361.0593$$\n因为 $n$ 必须严格大于 $361.0593$ 并且必须是一个正偶数，所以 $n$ 的最小整数值是 $362$。$362$ 是偶数。\n\n因此，满足条件的最小偶数整数 $n$ 是 $362$。", "answer": "$$\\boxed{362}$$", "id": "3224894"}, {"introduction": "误差的收敛阶数是衡量数值方法效率的核心指标。理论预测，对于足够光滑的函数，梯形和辛普森法则的全局误差 $E(h)$ 分别满足 $E(h) \\approx C_T h^2$ 和 $E(h) \\approx C_S h^4$。本实践 [@problem_id:3224834] 将理论与代码相结合，你将通过数值实验来亲自验证这些收敛阶数，并学习如何通过对数-对数线性回归从数据中提取这些关键的性能参数。", "problem": "考虑函数 $f(x)=e^x$ 在区间 $[0,1]$ 上的情况。令 $I=\\int_{0}^{1} f(x)\\,dx$ 表示精确积分值。对于具有 $n$ 个子区间和步长 $h=(1-0)/n$ 的均匀划分，将复化梯形法则近似值 $T_n$ 和复化辛普森法则近似值 $S_n$ 定义为其在节点 $x_k=0+kh$（其中 $k=0,1,\\dots,n$）上的标准求和形式：\n- 复化梯形法则：\n$$\nT_n = h\\left(\\frac{f(0)}{2} + \\sum_{k=1}^{n-1} f(x_k) + \\frac{f(1)}{2}\\right).\n$$\n- 复化辛普森法则（要求 $n$ 为偶数）：\n$$\nS_n = \\frac{h}{3}\\left(f(0) + f(1) + 4\\sum_{k=1,\\,k\\text{ odd}}^{n-1} f(x_k) + 2\\sum_{k=2,\\,k\\text{ even}}^{n-2} f(x_k)\\right).\n$$\n\n从数值积分的基本定义和函数 $f(x)=e^x$ 的光滑性出发，当 $h$ 足够小时，每个复化法则的全局误差 $E(h)$ 作为 $h$ 的函数，表现出渐近幂律行为 $E(h)\\approx C\\,h^p$，其中 $p$ 是收敛阶，$C$ 是一个依赖于函数 $f$ 和所用法则的非零常数。可以使用 $f$ 在 $[0,1]$ 上的相应阶数导数的上确界来建立全局误差的理论上界，具体来说，复化梯形法则是 $\\sup_{x\\in[0,1]}|f''(x)|$，复化辛普森法则是 $\\sup_{x\\in[0,1]}|f^{(4)}(x)|$。\n\n您的程序必须：\n1. 根据指数函数的定义和微积分基本定理，精确计算 $I$。\n2. 对于下面测试套件中每个指定的 $n$ 值列表，计算 $T_n$ 和 $S_n$（辛普森法则仅适用于偶数 $n$）、它们的绝对全局误差 $|I-T_n|$ 和 $|I-S_n|$，以及步长 $h=1/n$。\n3. 对每个法则和每个 $n$ 值列表，使用自然对数对数据点对 $\\left(\\log(h),\\log(|E(h)|)\\right)$ 进行线性回归，以估计最佳拟合线的斜率 $p$ 和截距 $\\log(C)$，从而获得 $p$ 和 $C=e^{\\text{截距}}$ 的经验估计值。\n4. 计算理论导数上确界 $\\sup_{x\\in[0,1]}|f''(x)|$ 和 $\\sup_{x\\in[0,1]}|f^{(4)}(x)|$，并使用包含这些上确界的标准全局误差上界形式，检查每个列表中的每个 $n$ 值，对应的法则的绝对全局误差是否小于或等于其界限。报告一个布尔值，指示对于列表中的所有 $n$，两个法则的界限是否同时成立。\n\n测试套件：\n- 情况 A (理想路径): $n\\in\\{4,8,16,32,64\\}$。\n- 情况 B (中等粗糙): $n\\in\\{2,4,6,8,10,12\\}$。\n- 情况 C (精细网格): $n\\in\\{128,256,512,1024\\}$。\n\n最终输出规范：\n- 对于每种情况，生成一个列表 $[p_T, C_T, p_S, C_S, \\text{bound\\_ok}]$，其中 $p_T$ 和 $C_T$ 是复化梯形法则的经验斜率和常数，$p_S$ 和 $C_S$ 是复化辛普森法则的经验斜率和常数，而 $\\text{bound\\_ok}$ 是一个布尔值，当且仅当在该情况下的所有 $n$ 值， $|I-T_n|$ 和 $|I-S_n|$ 都小于或等于它们各自从 $\\sup_{x\\in[0,1]}|f''(x)|$ 和 $\\sup_{x\\in[0,1]}|f^{(4)}(x)|$ 推导出的理论上界时，该值为真。\n- 您的程序应生成单行输出，其中包含三个情况的结果，形式为方括号内以逗号分隔的列表，例如：\n$$\n[\\,[p_T^{(A)},C_T^{(A)},p_S^{(A)},C_S^{(A)},\\text{bound\\_ok}^{(A)}],\\,[p_T^{(B)},C_T^{(B)},p_S^{(B)},C_S^{(B)},\\text{bound\\_ok}^{(B)}],\\,[p_T^{(C)},C_T^{(C)},p_S^{(C)},C_S^{(C)},\\text{bound\\_ok}^{(C)}]\\,].\n$$\n所有数值结果必须在此聚合列表中以原始浮点数和布尔值的形式报告。本问题不涉及物理单位或角度单位。", "solution": "该问题要求分析函数 $f(x) = e^x$ 在区间 $[0,1]$ 上，复化梯形法则和复化辛普森数值积分法则的收敛性质。此分析涉及计算数值近似值、其误差、将它们与理论界限进行比较，并经验性地估计收敛阶。\n\n首先，我们确定积分的精确基准值。要积分的函数是 $f(x) = e^x$，积分区间是 $[0,1]$。积分的精确值（记为 $I$）使用微积分基本定理计算：\n$$\nI = \\int_{0}^{1} e^x \\,dx = \\left[e^x\\right]_{0}^{1} = e^1 - e^0 = e - 1\n$$\n该值作为比较数值近似值 $T_n$ 和 $S_n$ 的参考标准。\n\n接下来，我们建立理论误差界限。复化梯形法则和辛普森法则的标准误差界限公式取决于函数 $f(x)$ 在积分区间上某阶导数绝对值的上确界。积分区间为 $[a,b]=[0,1]$，步长为 $h=(b-a)/n = 1/n$。\n\n对于复化梯形法则，误差界限涉及二阶导数。\n$f(x)=e^x$ 的导数是 $f'(x)=e^x$，$f''(x)=e^x$，依此类推。所有阶导数都是 $e^x$。\n函数 $e^x$ 在 $[0,1]$ 上是正的且单调递增。因此，其导数在该区间上的上确界在 $x=1$ 处取得。\n$$\nM_2 = \\sup_{x\\in[0,1]}|f''(x)| = \\sup_{x\\in[0,1]}|e^x| = e^1 = e\n$$\n复化梯形法则的理论误差界限是：\n$$\n|I - T_n| \\le \\frac{(b-a)h^2}{12} M_2 = \\frac{1 \\cdot (1/n)^2}{12} e = \\frac{e}{12n^2}\n$$\n对于复化辛普森法则，误差界限涉及四阶导数。\n$$\nM_4 = \\sup_{x\\in[0,1]}|f^{(4)}(x)| = \\sup_{x\\in[0,1]}|e^x| = e^1 = e\n$$\n复化辛普森法则（对于偶数 $n$）的理论误差界限是：\n$$\n|I - S_n| \\le \\frac{(b-a)h^4}{180} M_4 = \\frac{1 \\cdot (1/n)^4}{180} e = \\frac{e}{180n^4}\n$$\n程序必须对每个测试用例中的每个 $n$ 值进行验证，检查计算出的绝对误差 $|I-T_n|$ 和 $|I-S_n|$ 是否小于或等于它们各自的界限。\n\n该问题还要求从渐近关系 $|E(h)| \\approx C h^p$ 中经验性地估计收敛阶 $p$ 和误差常数 $C$，其中 $E(h)$ 是给定步长 $h$ 的全局误差。对等式两边取自然对数，得到一个线性关系：\n$$\n\\ln(|E(h)|) \\approx \\ln(C) + p \\ln(h)\n$$\n该方程形式为 $y = m x + c$，其中 $y = \\ln(|E(h)|)$，$x = \\ln(h)$，斜率为 $m=p$，y轴截距为 $c=\\ln(C)$。通过计算一系列步长 $h_i=1/n_i$ 对应的误差，我们可以生成一组数据点 $(\\ln(h_i), \\ln(|E(h_i)|))$。对这些点进行简单的线性回归，可以得到斜率 $p$ 和y轴截距 $\\ln(C)$ 的估计值，由此可以计算出 $C = e^{\\ln(C)}$。此过程分别对梯形法则和辛普森法则执行。\n\n每个测试用例的计算步骤如下：\n1.  定义精确积分 $I=e-1$ 和导数上确界 $M_2=e$ 和 $M_4=e$。初始化一个布尔标志 `bound_ok` 为真。\n2.  对于给定列表中的每个子区间数 $n$：\n    a. 计算步长 $h=1/n$。\n    b. 生成节点 $x_k = kh$（其中 $k=0, 1, \\dots, n$）并计算 $y_k = f(x_k)$。\n    c. 使用其求和公式计算梯形近似值 $T_n$。\n    d. 计算绝对误差 $|E_{T_n}| = |I-T_n|$ 和理论误差界限 $B_{T_n} = e h^2 / 12$。如果 $|E_{T_n}| > B_{T_n}$，则将 `bound_ok` 设为假。\n    e. 如果 $n$ 是偶数，计算辛普森近似值 $S_n$、其误差 $|E_{S_n}|=|I-S_n|$ 及其界限 $B_{S_n} = e h^4 / 180$。如果 $|E_{S_n}| > B_{S_n}$，则将 `bound_ok` 设为假。\n    f. 存储 $h$、$|E_{T_n}|$ 以及（如果适用）$|E_{S_n}|$ 以用于回归分析。\n3.  对收集到的梯形法则的自然对数-对数数据进行线性回归，以找到其经验参数 $p_T$ 和 $C_T$。\n4.  对收集到的辛普森法则的自然对数-对数数据进行线性回归，以找到其经验参数 $p_S$ 和 $C_S$。\n5.  将结果整合到列表 $[p_T, C_T, p_S, C_S, \\text{bound\\_ok}]$ 中。\n对三个指定的测试用例中的每一个重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the numerical integration error analysis problem for three test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        [4, 8, 16, 32, 64],        # Case A\n        [2, 4, 6, 8, 10, 12],      # Case B\n        [128, 256, 512, 1024],      # Case C\n    ]\n\n    # The function to integrate f(x) = e^x\n    f = lambda x: np.exp(x)\n    \n    # Exact value of the integral over [0, 1]\n    I_exact = np.e - 1.0\n\n    # Supremum of derivatives on [0, 1] for error bounds\n    # f''(x) = e^x, sup|f''(x)| = e^1 = e\n    # f^(4)(x) = e^x, sup|f^(4)(x)| = e^1 = e\n    M2 = np.e\n    M4 = np.e\n\n    interval_a = 0.0\n    interval_b = 1.0\n\n    all_results = []\n\n    for n_values in test_cases:\n        h_T_vals, errors_T = [], []\n        h_S_vals, errors_S = [], []\n        bounds_hold = True\n\n        for n in n_values:\n            h = (interval_b - interval_a) / n\n            x_nodes = np.linspace(interval_a, interval_b, n + 1)\n            y_values = f(x_nodes)\n\n            # Composite Trapezoidal Rule\n            T_n = h * (np.sum(y_values[1:-1]) + (y_values[0] + y_values[-1]) / 2.0)\n            error_T = np.abs(I_exact - T_n)\n            \n            # Theoretical bound for Trapezoidal Rule\n            bound_T = M2 * h**2 / 12.0\n            if error_T  bound_T:\n                bounds_hold = False\n            \n            h_T_vals.append(h)\n            errors_T.append(error_T)\n\n            # Composite Simpson's Rule (for even n)\n            if n % 2 == 0:\n                # S_n = h/3 * (f(x_0) + f(x_n) + 4*sum(odd terms) + 2*sum(even terms))\n                # Odd terms indices: 1, 3, ..., n-1\n                # Even terms indices: 2, 4, ..., n-2\n                odd_sum = np.sum(y_values[1:n:2])\n                even_sum = np.sum(y_values[2:n-1:2])\n                S_n = (h / 3.0) * (y_values[0] + y_values[-1] + 4.0 * odd_sum + 2.0 * even_sum)\n                error_S = np.abs(I_exact - S_n)\n                \n                # Theoretical bound for Simpson's Rule\n                bound_S = M4 * h**4 / 180.0\n                if error_S  bound_S:\n                    bounds_hold = False\n                \n                h_S_vals.append(h)\n                errors_S.append(error_S)\n        \n        # Perform linear regression on log-log data\n        # For Trapezoidal Rule\n        log_h_T = np.log(np.array(h_T_vals))\n        log_err_T = np.log(np.array(errors_T))\n        p_T, log_C_T = np.polyfit(log_h_T, log_err_T, 1)\n        C_T = np.exp(log_C_T)\n\n        # For Simpson's Rule\n        log_h_S = np.log(np.array(h_S_vals))\n        log_err_S = np.log(np.array(errors_S))\n        p_S, log_C_S = np.polyfit(log_h_S, log_err_S, 1)\n        C_S = np.exp(log_C_S)\n        \n        case_result = [p_T, C_T, p_S, C_S, bounds_hold]\n        all_results.append(case_result)\n\n\n    # Final print statement in the exact required format.\n    # We convert the list of lists to its string representation and remove spaces for compactness.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "3224834"}, {"introduction": "高阶方法一定更准确吗？这个看似理所当然的结论在特定情况下可能会失效。本练习 [@problem_id:3284359] 将挑战你的直觉，要求你构建一个函数，使得在使用相同数量的采样点时，低阶的梯形法则反而比高阶的辛普森法则能给出更精确的积分结果。通过这个“反例”的构建，你将深入理解采样、混叠现象以及数值方法发挥作用的前提条件。", "problem": "考虑在区间 $[0,1]$ 上对一个光滑函数进行数值积分，预算固定为在均匀间隔的节点 $x_j = j/8$（其中 $j = 0,1,\\dots,8$）上进行 $9$ 次函数求值。对于这组节点，可以通过在局部用多项式插值 $f(x)$，然后对这些插值多项式进行积分来构造复合求积法则，以近似定积分 $\\int_{0}^{1} f(x)\\,dx$。两种广泛使用的此类法则是基于线性插值（复合梯形法则）和二次插值（复合辛普森法则），两者都作用于均匀网格上。\n\n请严格从数值求积的这些核心定义（即在均匀节点上构建的插值型公式）出发，并且不使用任何预先给定的误差常数或闭式误差公式，设计一个特定的、在 $[0,1]$ 上连续可微的函数 $f(x)$，使得当两种法则都使用相同的、位于节点 $\\{x_j\\}_{j=0}^{8}$ 上的 $9$ 个函数求值点时，复合梯形法则对 $\\int_{0}^{1} f(x)\\,dx$ 的近似结果比复合辛普森法则更精确。\n\n你的答案必须是 $f(x)$ 的一个显式解析表达式，并且你必须在推理中证明，对于这个 $f(x)$ 和指定的节点，复合梯形法则的结果严格比复合辛普森法则的结果更接近真实的积分值，即 $|I - T|  |I - S|$。无需四舍五入，也不涉及单位；请在推理中提供精确值。", "solution": "### 求解过程\n\n我们的目标是找到一个在 $[0,1]$ 上连续可微的函数 $f(x)$，使得在给定的9点均匀网格上，复合梯形法则对 $I = \\int_0^1 f(x) dx$ 的近似比复合辛普森法则更精确。网格间距为 $h = (1-0)/8 = 1/8$，节点为 $x_j = j/8$，其中 $j \\in \\{0, 1, \\dots, 8\\}$。\n\n我们必须证明 $|I - T|  |I - S|$。不使用预先给定的误差公式，解决此问题的途径是提出一个合适的候选函数，然后显式地计算真实积分 $I$ 和两个近似值 $T$ 和 $S$，以验证该不等式。\n\n一个关键的洞见是，这些法则的精度与它们底层的多项式插值能多好地捕捉函数的行为有关。辛普森法则在宽度为 $2h$ 的区间上使用分段二次插值，而梯形法则在宽度为 $h$ 的区间上使用分段线性插值。如果一个函数的行为在给定的节点间距下难以被二次插值捕捉，但能被线性插值很好地近似，那么这个函数就是一个有希望的候选者。高振荡函数可以表现出这种性质。\n\n让我们提出函数 $f(x) = \\cos(8\\pi x)$。这个函数在 $[0,1]$ 上是连续可微的（实际上是 $C^\\infty$）。\n\n首先，我们在指定节点 $x_j = j/8$ 处计算函数值：\n$$f(x_j) = f\\left(\\frac{j}{8}\\right) = \\cos\\left(8\\pi \\frac{j}{8}\\right) = \\cos(j\\pi) = (-1)^j$$\n函数值序列 $\\{f_j\\}_{j=0}^8$ 为：\n$$f_0=1, f_1=-1, f_2=1, f_3=-1, f_4=1, f_5=-1, f_6=1, f_7=-1, f_8=1$$\n\n接着，我们计算积分的精确值 $I$：\n$$I = \\int_{0}^{1} \\cos(8\\pi x) \\,dx = \\left[ \\frac{\\sin(8\\pi x)}{8\\pi} \\right]_{0}^{1} = \\frac{\\sin(8\\pi) - \\sin(0)}{8\\pi} = \\frac{0-0}{8\\pi} = 0$$\n\n现在，我们使用复合梯形法则计算近似值 $T$。该法则定义为：\n$$T = h \\left( \\frac{f_0}{2} + \\sum_{j=1}^{7} f_j + \\frac{f_8}{2} \\right)$$\n其中 $N=8$，$h=1/8$，以及我们的节点值：\n$$T = \\frac{1}{8} \\left( \\frac{1}{2} + (-1) + 1 + (-1) + 1 + (-1) + 1 + (-1) + \\frac{1}{2} \\right)$$\n$$T = \\frac{1}{8} \\left( \\left(\\frac{1}{2} + \\frac{1}{2}\\right) + (-1+1) + (-1+1) + (-1+1) -1 \\right)$$\n$$T = \\frac{1}{8} \\left( 1 - 1 \\right) = 0$$\n\n接下来，我们使用复合辛普森法则计算近似值 $S$。对于 $N=8$ 个子区间（一个偶数），该法则为：\n$$S = \\frac{h}{3} \\left( f_0 + 4f_1 + 2f_2 + 4f_3 + 2f_4 + 4f_5 + 2f_6 + 4f_7 + f_8 \\right)$$\n使用我们的节点值：\n$$S = \\frac{1/8}{3} \\left( 1 + 4(-1) + 2(1) + 4(-1) + 2(1) + 4(-1) + 2(1) + 4(-1) + 1 \\right)$$\n$$S = \\frac{1}{24} \\left( 1 - 4 + 2 - 4 + 2 - 4 + 2 - 4 + 1 \\right)$$\n$$S = \\frac{1}{24} \\left( (1+2+2+2+1) + 4 \\times (-4) \\right) = \\frac{1}{24} (8 - 16) = \\frac{-8}{24} = -\\frac{1}{3}$$\n\n最后，我们比较绝对误差。\n梯形法则的绝对误差为：\n$$|E_T| = |I - T| = |0 - 0| = 0$$\n辛普森法则的绝对误差为：\n$$|E_S| = |I - S| = \\left|0 - \\left(-\\frac{1}{3}\\right)\\right| = \\frac{1}{3}$$\n比较两个绝对误差，我们发现：\n$$0  \\frac{1}{3}$$\n因此， $|E_T|  |E_S|$。\n\n函数 $f(x)=\\cos(8\\pi x)$ 是连续可微的，并且对于给定的节点，复合梯形法则的结果完全精确，而复合辛普森法则却产生显著误差。这证明了在这种特定情况下，梯形法则比辛普森法则更精确，满足了问题的所有条件。这种情况的发生是因为函数的频率恰好是网格的奈奎斯特频率 $1/(2h)$。梯形法则之所以精确，是因为每个子区间上的误差项 $\\int_{x_j}^{x_{j+1}} (f(x) - L_j(x))dx$ 由于余弦函数在每个子区间内的对称性而恰好为零。然而，辛普森法则是为多项式设计的，相对于其三点采样区间，它被函数的振荡特性严重误导，从而导致了较大的误差。", "answer": "$$\\boxed{\\cos(8\\pi x)}$$", "id": "3284359"}]}