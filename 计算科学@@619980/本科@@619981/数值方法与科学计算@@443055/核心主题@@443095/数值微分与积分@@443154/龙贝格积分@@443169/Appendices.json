{"hands_on_practices": [{"introduction": "龙贝格积分法的核心思想是通过理查森外推法加速梯形公式的收敛。这个入门练习将引导您完成龙贝格积分法的第一个完整步骤。通过计算一个我们已知其精确解的简单积分，您可以亲眼见证如何将两个相对粗糙的梯形法则近似值组合起来，从而得到一个精度显著更高的结果 [@problem_id:2198712]。", "problem": "考虑对定积分 $I = \\int_0^{\\pi} \\sin(x) dx$ 进行数值计算，其中正弦函数的参数以弧度为单位。我们将使用龙贝格积分来近似其值。龙贝格表通过以下递归公式构建：\n$$R_{k, j} = \\frac{4^{j-1} R_{k, j-1} - R_{k-1, j-1}}{4^{j-1} - 1}$$\n对于 $k \\ge 2$ 和 $j \\ge 2$。第一列，$R_{k,1}$（对于 $k \\ge 1$），使用具有 $n = 2^{k-1}$ 个子区间的复化梯形法则计算。对于一个积分 $\\int_a^b f(x) dx$，使用 $n$ 个宽度为 $h=(b-a)/n$ 的子区间的复化梯形法则由下式给出：\n$$T_n = \\frac{h}{2} \\left[f(a) + 2\\sum_{i=1}^{n-1} f(a+ih) + f(b)\\right]$$\n我们令 $R_{k,1} = T_{2^{k-1}}$。\n\n你的任务是计算给定积分的近似值 $R_{2,2}$。将你的答案以四舍五入到四位有效数字的数值形式报告。", "solution": "问题要求计算积分 $I = \\int_0^{\\pi} \\sin(x) dx$ 的龙贝格积分近似值 $R_{2,2}$。为了求得 $R_{2,2}$，我们首先需要计算梯形近似值 $R_{1,1}$ 和 $R_{2,1}$。\n\n**步骤 1：计算 $R_{1,1}$**\n$R_{1,1}$ 对应于使用 $n = 2^{1-1} = 1$ 个子区间的复化梯形法则。\n区间为 $[a, b] = [0, \\pi]$。\n步长为 $h = \\frac{b-a}{n} = \\frac{\\pi-0}{1} = \\pi$。\n使用单个子区间的梯形法则公式为：\n$$R_{1,1} = T_1 = \\frac{h}{2}[f(a) + f(b)]$$\n代入 $f(x) = \\sin(x)$，$a=0$，$b=\\pi$ 和 $h=\\pi$ 的值：\n$$R_{1,1} = \\frac{\\pi}{2}[\\sin(0) + \\sin(\\pi)]$$\n因为 $\\sin(0) = 0$ 且 $\\sin(\\pi) = 0$，我们有：\n$$R_{1,1} = \\frac{\\pi}{2}[0 + 0] = 0$$\n\n**步骤 2：计算 $R_{2,1}$**\n$R_{2,1}$ 对应于使用 $n = 2^{2-1} = 2$ 个子区间的复化梯形法则。\n步长为 $h = \\frac{b-a}{n} = \\frac{\\pi-0}{2} = \\frac{\\pi}{2}$。\n求值点为 $x_0 = 0$，$x_1 = 0+h = \\frac{\\pi}{2}$ 和 $x_2 = 0+2h = \\pi$。\n使用两个子区间的复化梯形法则公式为：\n$$R_{2,1} = T_2 = \\frac{h}{2}[f(x_0) + 2f(x_1) + f(x_2)]$$\n代入数值：\n$$R_{2,1} = \\frac{\\pi/2}{2}\\left[\\sin(0) + 2\\sin\\left(\\frac{\\pi}{2}\\right) + \\sin(\\pi)\\right]$$\n因为 $\\sin(0) = 0$，$\\sin(\\frac{\\pi}{2}) = 1$ 和 $\\sin(\\pi) = 0$，我们得到：\n$$R_{2,1} = \\frac{\\pi}{4}[0 + 2(1) + 0] = \\frac{\\pi}{4}(2) = \\frac{\\pi}{2}$$\n\n**步骤 3：计算 $R_{2,2}$**\n现在我们使用问题描述中提供的龙贝格外推公式来求得 $R_{2,2}$。对于 $k=2$ 和 $j=2$，公式为：\n$$R_{2,2} = \\frac{4^{2-1} R_{2, 2-1} - R_{2-1, 2-1}}{4^{2-1} - 1} = \\frac{4R_{2,1} - R_{1,1}}{3}$$\n代入先前计算出的值 $R_{1,1}=0$ 和 $R_{2,1}=\\frac{\\pi}{2}$：\n$$R_{2,2} = \\frac{4\\left(\\frac{\\pi}{2}\\right) - 0}{3} = \\frac{2\\pi}{3}$$\n\n**步骤 4：数值计算与四舍五入**\n最后，我们计算其数值，并按要求将其四舍五入到四位有效数字。\n$$R_{2,2} = \\frac{2\\pi}{3} \\approx \\frac{2 \\times 3.14159265...}{3} \\approx 2.0943951...$$\n四舍五入到四位有效数字，我们看第五位数字。由于该数字是 3（小于 5），我们向下舍入。\n$$R_{2,2} \\approx 2.094$$", "answer": "$$\\boxed{2.094}$$", "id": "2198712"}, {"introduction": "在掌握了基本的外推步骤后，让我们来处理一个更接近实际工程应用的场景。这个问题的被积函数更为复杂，其解析解不易求得，凸显了数值积分的实用价值。您需要系统地构建一个更大的龙贝格表，计算至二阶外推值 $R_{3,3}$，从而更深入地理解该方法的迭代过程和加速收敛的威力 [@problem_id:2198775]。", "problem": "一位工程师正在为一个新型机器人执行器的能耗建模。在很短的时间间隔内，该执行器消耗的瞬时功率 $P(t)$ 由函数 $P(t) = P_0 f(t)$ 描述，其中 $f(t) = (1 + \\sin^2(\\pi t)) \\exp(-0.5 t)$，时间 $t$ 的单位为秒。为了精确确定从 $t=0$ 到 $t=1$ 秒时间间隔内消耗的总能量，该工程师需要计算无量纲积分 $I = \\int_0^1 f(t) dt$。\n\n该工程师决定使用龙贝格积分（Romberg integration）来近似这个积分。龙贝格积分表，记为 $R_{i, j}$，按如下方式构造：\n1.  第一列，$R_{i, 1}$（对于 $i \\ge 1$），包含由复化梯形法则得到的近似值。具体来说，$R_{i, 1}$ 是使用 $n = 2^{i-1}$ 个子区间的复化梯形法则的结果。\n2.  后续的列（对于 $j \\ge 2$）使用理查森外推公式（Richardson extrapolation formula）生成：\n    $$R_{i, j} = R_{i, j-1} + \\frac{R_{i, j-1} - R_{i-1, j-1}}{4^{j-1} - 1}$$\n    其中 $i \\ge j \\ge 2$。\n\n你的任务是计算龙贝格积分表中的元素 $R_{3,3}$ 的值。将你的最终答案四舍五入到五位有效数字。", "solution": "我们需要通过龙贝格积分法计算 $I=\\int_{0}^{1} f(t)\\,dt$ 的 $R_{3,3}$ 值，其中 $f(t)=(1+\\sin^{2}(\\pi t))\\exp(-0.5\\,t)$。\n\n首先，计算复化梯形近似值 $R_{i,1}$，其中 $i=1,2,3$。\n- 对于 $i=1$（$n=1$ 个区间），$h=1$，节点为 $t_{0}=0$，$t_{1}=1$：\n$$\nf(0)=(1+\\sin^{2}(0))\\exp(0)=1,\\quad f(1)=(1+\\sin^{2}(\\pi))\\exp(-0.5)=\\exp(-0.5).\n$$\n因此\n$$\nR_{1,1}=\\frac{h}{2}\\left[f(0)+f(1)\\right]=\\frac{1}{2}\\left(1+\\exp(-0.5)\\right).\n$$\n- 对于 $i=2$ ($n=2$)，$h=\\frac{1}{2}$，节点为 $t=0,\\frac{1}{2},1$：\n$$\nf\\!\\left(\\tfrac{1}{2}\\right)=(1+\\sin^{2}(\\tfrac{\\pi}{2}))\\exp(-0.25)=2\\,\\exp(-0.25).\n$$\n于是\n$$\nR_{2,1}=\\frac{h}{2}\\left[f(0)+2f\\!\\left(\\tfrac{1}{2}\\right)+f(1)\\right]\n=\\frac{1}{4}\\left(1+4\\exp(-0.25)+\\exp(-0.5)\\right).\n$$\n- 对于 $i=3$ ($n=4$)，$h=\\frac{1}{4}$，节点为 $t=0,\\frac{1}{4},\\frac{1}{2},\\frac{3}{4},1$：\n$$\nf\\!\\left(\\tfrac{1}{4}\\right)=\\left(1+\\sin^{2}\\!\\left(\\tfrac{\\pi}{4}\\right)\\right)\\exp(-0.125)=\\frac{3}{2}\\exp(-0.125),\n$$\n$$\nf\\!\\left(\\tfrac{3}{4}\\right)=\\left(1+\\sin^{2}\\!\\left(\\tfrac{3\\pi}{4}\\right)\\right)\\exp(-0.375)=\\frac{3}{2}\\exp(-0.375),\n$$\n以及如上所示的 $f(0)$、$f(\\tfrac{1}{2})$ 和 $f(1)$。那么\n$$\nR_{3,1}=\\frac{h}{2}\\left[f(0)+2\\left(f\\!\\left(\\tfrac{1}{4}\\right)+f\\!\\left(\\tfrac{1}{2}\\right)+f\\!\\left(\\tfrac{3}{4}\\right)\\right)+f(1)\\right]\n=\\frac{1}{8}\\left(1+3\\exp(-0.125)+4\\exp(-0.25)+3\\exp(-0.375)+\\exp(-0.5)\\right).\n$$\n\n接下来，应用理查森外推法：\n$$\nR_{i,j}=R_{i,j-1}+\\frac{R_{i,j-1}-R_{i-1,j-1}}{4^{j-1}-1},\\quad i\\geq j\\geq 2.\n$$\n因此，\n$$\nR_{2,2}=R_{2,1}+\\frac{R_{2,1}-R_{1,1}}{3},\\qquad\nR_{3,2}=R_{3,1}+\\frac{R_{3,1}-R_{2,1}}{3},\n$$\n$$\nR_{3,3}=R_{3,2}+\\frac{R_{3,2}-R_{2,2}}{15}.\n$$\n\n现在进行数值计算（使用 $\\exp(-0.125)\\approx 0.8824969025845954$，$\\exp(-0.25)\\approx 0.7788007830714049$，$\\exp(-0.375)\\approx 0.6872892787909722$，$\\exp(-0.5)\\approx 0.6065306597126334$）：\n$$\nR_{1,1}\\approx 0.8032653298563167,\\quad\nR_{2,1}\\approx 1.1804334479995632,\\quad\nR_{3,1}\\approx 1.1788865420156195,\n$$\n$$\nR_{2,2}\\approx 1.3061561540473120,\\quad\nR_{3,2}\\approx 1.1783709066876382,\n$$\n$$\nR_{3,3}\\approx 1.1698518901969933.\n$$\n四舍五入到五位有效数字得到 $1.1699$。", "answer": "$$\\boxed{1.1699}$$", "id": "2198775"}, {"introduction": "强大的数值方法并非万能钥匙，它们都建立在特定的数学假设之上。这个高阶练习将挑战您的批判性思维，探讨当被积函数不满足光滑性条件时，龙贝格积分法为何会失效。更重要的是，它将引导您学习如何通过巧妙的变量替换来“修复”被积函数，恢复方法的高阶收敛性，这是科学与工程计算中一项至关重要的技能 [@problem_id:3268261]。", "problem": "考虑积分 $I=\\int_{0}^{1}\\sqrt{x}\\,\\sin(x)\\,dx$ 以及应用龙贝格积分法来近似 $I$。龙贝格积分是通过对复合梯形法则在步长逐次减半的情况下应用理查森外推法得到的，它依赖于这样一个假设，即在被积函数于 $[0,1]$ 上足够光滑的条件下，复合梯形法则的误差对于步长 $h$ 存在一个规则的渐近结构。仅使用此定义以及被积函数形式在端点附近所暗示的导数行为，从基本原理出发论证这些光滑性条件是否满足，以及 $h$ 的误差结构会受到怎样的影响。然后，找出一个变量代换，以恢复在 $[0,1]$ 上高阶龙贝格收敛性所需的可微性。\n\n哪个选项正确解释了观察到的龙贝格积分法未能达到其名义上的偶数阶收敛序列的现象，并提出了一个恢复高阶收敛性的有效变量代换？\n\n- A. 龙贝格积分法失败是因为被积函数在 $[0,1]$ 上不是周期的，这使得外推法所需的端点抵消失效。使用 $x=\\sin^{2}(t)$ 来强制实现类似周期的端点行为，然后在 $[0,\\pi/2]$ 上对 $t$ 应用龙贝格积分法。\n\n- B. 龙贝格积分法失败是因为被积函数的高阶导数在 $x=0$ 处无界，因此梯形法则的误差包含 $h$ 的非整数次幂，而标准的外推法无法在一系列偶数次幂中将其消除。使用代数去奇异点代换 $x=t^{2}$ 得到 $\\int_{0}^{1}2t^{2}\\sin(t^{2})\\,dt$，然后对 $t\\in[0,1]$ 应用龙贝格积分法。\n\n- C. 龙贝格积分法失败是因为 $\\sin(x)$ 产生振荡，需要使用渐近振荡求积法。在进行 $x=\\ln(t)$ 代换以转换区间后，使用驻相法，然后对变换后的积分应用龙贝格积分法。\n\n- D. 龙贝格积分法失败是因为在 $x=1$ 处有一个尖点，破坏了误差展开中的边界项。使用 $x=1-t^{2}$ 来平滑右端点的行为，然后对 $t\\in[0,1]$ 应用龙贝格积分法。", "solution": "该问题要求分析龙贝格积分法对积分 $I=\\int_{0}^{1}\\sqrt{x}\\,\\sin(x)\\,dx$ 失效的原因，并找出一个合适的变量代换来恢复其高阶收敛性质。\n\n龙贝格积分法的核心原理是对复合梯形法则应用理查森外推法。这种外推法的成功取决于梯形法则的误差 $E_T(h)$ 是否具有一个关于步长 $h$ 的偶数次幂的特定渐近展开式。该展开式由欧拉-麦克劳林公式给出。对于一个积分 $I = \\int_a^b f(x) \\, dx$，使用步长为 $h=(b-a)/n$ 的复合梯形法则 $T(h)$ 进行近似，其误差为：\n$$ E_T(h) = T(h) - I = \\sum_{k=1}^{m-1} \\frac{B_{2k}}{(2k)!} h^{2k} [f^{(2k-1)}(b) - f^{(2k-1)}(a)] + R_{2m}(h) $$\n这里，$B_{2k}$ 是伯努利数，$R_{2m}(h)$ 是一个 $O(h^{2m})$ 阶的余项。为了使这个展开式存在到 $h^{2m-2}$ 项，被积函数 $f(x)$ 必须至少是 $C^{2m-1}[a, b]$ 类函数，即它的前 $2m-1$ 阶导数必须在闭区间 $[a, b]$ 上存在且连续。龙贝格积分法利用这种结构，通过创建不同 $h$ 值下的梯形和的线性组合，来系统地消除误差项 $c_1 h^2, c_2 h^4, c_3 h^6, \\dots$，从而达到更高阶的精度。\n\n我们来分析给定的被积函数 $f(x) = \\sqrt{x}\\sin(x)$ 在区间 $[0, 1]$ 上的性质。可微性的潜在问题点是端点 $x=0$。\n\n一阶导数是：\n$$ f'(x) = \\frac{d}{dx}(x^{1/2}\\sin(x)) = \\frac{1}{2}x^{-1/2}\\sin(x) + x^{1/2}\\cos(x) $$\n为了检查在 $x=0$ 处的连续性，我们计算当 $x \\to 0^+$ 时的极限。对于很小的 $x$，使用近似 $\\sin(x) \\approx x$，第一项的行为类似于 $\\frac{1}{2}x^{-1/2}(x) = \\frac{1}{2}x^{1/2}$，其极限为 $0$。第二项 $x^{1/2}\\cos(x)$ 的极限也为 $0$。因此，$f'(x)$ 在 $x=0$ 处是连续的，且 $f'(0)=0$。\n\n二阶导数是：\n$$ f''(x) = \\frac{d}{dx} \\left( \\frac{1}{2}x^{-1/2}\\sin(x) + x^{1/2}\\cos(x) \\right) $$\n$$ f''(x) = \\left( -\\frac{1}{4}x^{-3/2}\\sin(x) + \\frac{1}{2}x^{-1/2}\\cos(x) \\right) + \\left( \\frac{1}{2}x^{-1/2}\\cos(x) - x^{1/2}\\sin(x) \\right) $$\n$$ f''(x) = -\\frac{1}{4}x^{-3/2}\\sin(x) + x^{-1/2}\\cos(x) - x^{1/2}\\sin(x) $$\n我们来考察当 $x \\to 0^+$ 时 $f''(x)$ 的行为。\n- 项 $-\\frac{1}{4}x^{-3/2}\\sin(x) \\approx -\\frac{1}{4}x^{-3/2}(x) = -\\frac{1}{4}x^{-1/2}$，是无界的。\n- 项 $x^{-1/2}\\cos(x) \\approx x^{-1/2}$，也是无界的。\n- 项 $-x^{1/2}\\sin(x) \\approx -x^{3/2}$，极限为 $0$。\n\n由于当 $x \\to 0^+$ 时 $f''(x)$ 无界，函数 $f(x)$ 不属于 $C^2[0, 1]$。所有更高阶的导数在 $x=0$ 处也都将是无界的。这违反了标准欧拉-麦克劳林展开式所要求的光滑性条件。\n\n当被积函数不够光滑时，误差展开式中会包含 $h$ 的非整数次幂。对于形如 $f(x) = x^\\alpha g(x)$ 的被积函数，其中 $g(x)$ 光滑且 $\\alpha > -1$，广义欧拉-麦克劳林公式表明，梯形法则的误差除了通常的 $h$ 的偶数次幂外，还包含形如 $h^{\\alpha+1+k}$ 的项。在我们的例子中，$f(x) = x^{1/2} \\sin(x) = x^{1/2}(x - x^3/6 + \\dots) = x^{3/2} - x^{7/2}/6 + \\dots$。主要的非解析行为来自于 $x^{3/2}$ 项（对应于 $\\alpha=3/2 > -1$）。梯形法则的误差展开式将具有以下形式：\n$$ E_T(h) = d_1 h^{3/2+1} + \\dots + c_1 h^2 + d_2 h^{3/2+2} + \\dots + c_2 h^4 + \\dots $$\n如果我们只考虑 $x^{3/2}$ 的积分， $h$ 的最低次幂是 $h^{3/2+1} = h^{5/2}$。更仔细的分析（Lyness-Ninham级数）表明，领头的异常项阶数为 $h^{1/2+1} = h^{3/2}$。总误差为 $E_T(h) = c_1 h^{3/2} + c_2 h^2 + c_3 h^{5/2} + c_4 h^4 + \\dots$。\n标准的龙贝格外推法假设误差展开为 $h^2, h^4, \\dots$ 次幂，但它无法正确消除领头的 $h^{3/2}$ 项，因此会失败。\n\n为了恢复高阶收敛性，我们必须使用变量代换来使被积函数变得光滑。奇异性来源于 $\\sqrt{x}=x^{1/2}$ 项。代数代换 $x = t^2$ 是移除此类奇异性的标准方法。\n令 $x = t^2$。那么 $dx = 2t \\, dt$。积分限改变：当 $x$ 从 $0$ 变到 $1$ 时，$t$ 也从 $0$ 变到 $1$。\n积分变为：\n$$ I = \\int_{0}^{1} \\sqrt{t^2} \\sin(t^2) (2t \\, dt) = \\int_{0}^{1} t \\sin(t^2) (2t \\, dt) = \\int_{0}^{1} 2t^2 \\sin(t^2) \\, dt $$\n新的被积函数是 $g(t) = 2t^2 \\sin(t^2)$。我们检查它在 $[0,1]$ 上的光滑性。\n使用 $\\sin(u)$ 的泰勒级数 $\\sin(u) = u - u^3/3! + u^5/5! - \\dots$，我们有：\n$$ g(t) = 2t^2 \\left( t^2 - \\frac{(t^2)^3}{6} + \\frac{(t^2)^5}{120} - \\dots \\right) = 2t^4 - \\frac{1}{3}t^8 + \\frac{1}{60}t^{12} - \\dots $$\n这是一个对所有 $t$ 都收敛的关于 $t$ 的幂级数。函数 $g(t)$ 是解析的，因此是无穷次可微的（$C^\\infty$）在 $[0,1]$ 上。它的所有导数都有界。对这个变换后的积分应用龙贝格积分法，将会展现出预期的高阶收敛性，因为欧拉-麦克劳林公式的条件得到了满足。\n\n现在我们评估每个选项：\n\n- **A.** “龙贝格积分法失败是因为被积函数在 $[0,1]$ 上不是周期的，这使得外推法所需的端点抵消失效。使用 $x=\\sin^{2}(t)$ 来强制实现类似周期的端点行为，然后在 $[0,\\pi/2]$ 上对 $t$ 应用龙贝格积分法。”\n  关于失败原因是缺少周期性的说法是不正确的。周期性是梯形法则超代数收敛的一个条件，但它的缺失并非标准龙贝格积分法失败的原因。失败是由于缺少光滑性（无界导数）。$x=\\sin^2(t)$ 的代换确实能产生一个光滑的被积函数，但为失败所给出的理由是错误的。因此，这个选项没有*正确解释*失败原因。**不正确**。\n\n- **B.** “龙贝格积分法失败是因为被积函数的高阶导数在 $x=0$ 处无界，因此梯形法则的误差包含 $h$ 的非整数次幂，而标准的外推法无法在一系列偶数次幂中将其消除。使用代数去奇异点代换 $x=t^{2}$ 得到 $\\int_{0}^{1}2t^{2}\\sin(t^{2})\\,dt$，然后对 $t\\in[0,1]$ 应用龙贝格积分法。”\n  这个选项正确地指出了失败的原因：在 $x=0$ 处的高阶导数无界。它正确地解释了其后果：误差展开式包含 $h$ 的非整数次幂，这破坏了标准的理查森外推法。它还提出了正确且有效的变量代换 $x=t^2$，并正确地推导出了变换后的积分。此选项与我们的分析完全一致。**正确**。\n\n- **C.** “龙贝格积分法失败是因为 $\\sin(x)$ 产生振荡，需要使用渐近振荡求积法。在进行 $x=\\ln(t)$ 代换以转换区间后，使用驻相法，然后对变换后的积分应用龙贝格积分法。”\n  在 $[0,1]$ 上由 $\\sin(x)$ 产生的振荡并非“高频”，也不是该方法失败的原因。如果被积函数光滑，标准的求积法则能很好地处理这种温和的振荡。驻相法在这里是不相关的。所提议的代换 $x=\\ln(t)$ 将 $x=0$ 处的奇异点映射到 $t=1$，但并未消除它，因此是无效的。解释不正确，提议的解决方案也不恰当。**不正确**。\n\n- **D.** “龙贝格积分法失败是因为在 $x=1$ 处有一个尖点，破坏了误差展开中的边界项。使用 $x=1-t^{2}$ 来平滑右端点的行为，然后对 $t\\in[0,1]$ 应用龙贝格积分法。”\n  这个陈述在事实上是错误的。被积函数 $f(x) = \\sqrt{x}\\sin(x)$ 在 $x=1$ 处是解析的。问题出在 $x=0$ 处。所提议的代换 $x=1-t^2$ 是为处理 $x=1$ 处的奇异点而设计的，而不是 $x=0$ 处的。它只会把问题从积分区间的一个端点转移到另一个端点。解释不正确，提议的解决方案也用错了地方。**不正确**。", "answer": "$$\\boxed{B}$$", "id": "3268261"}]}