{"hands_on_practices": [{"introduction": "掌握一种数值方法不仅仅是应用公式，更需要理解其精度和局限性。第一个练习将提供一个基础性的实践。通过将复合梯形法则应用于一个已知精确解的积分，你将计算出近似值的实际误差和由误差界限公式预测的理论最大误差。这种直接的比较将帮助你建立关于数值误差理论如何与实际计算相结合的直观认识。[@problem_id:2210486]", "problem": "一位数值分析师正在研究使用复合梯形法则近似计算定积分 $I = \\int_1^2 \\frac{1}{x} dx$ 的精度。该近似计算使用 $n=4$ 个等宽子区间进行。\n\n该积分的精确值已知为 $I = \\ln(2)$。复合梯形法则的理论误差界由不等式 $|E_T| \\le \\frac{M(b-a)^3}{12n^2}$ 给出，其中 $[a, b]$ 是积分区间，$M$ 是一个常数，使得对于所有在 $[a, b]$ 内的 $x$，都有 $|f''(x)| \\le M$。\n\n计算理论最大绝对误差（即误差界，使用 $M$ 的最小可能值）与近似的实际绝对误差之间的差值。在本次计算中，请使用数值 $\\ln(2) \\approx 0.69314718$。\n\n将最终答案表示为一个实数，并四舍五入到六位有效数字。", "solution": "我们使用复合梯形法则和 $n=4$ 个子区间来近似 $I=\\int_{1}^{2}\\frac{1}{x}\\,dx$。步长为\n$$\nh=\\frac{b-a}{n}=\\frac{2-1}{4}=\\frac{1}{4}.\n$$\n节点为 $x_{0}=1$，$x_{1}=1+\\frac{1}{4}=\\frac{5}{4}$，$x_{2}=1+\\frac{2}{4}=\\frac{3}{2}$，$x_{3}=1+\\frac{3}{4}=\\frac{7}{4}$，$x_{4}=2$。\n\n复合梯形近似值为\n$$\nT=\\frac{h}{2}\\left[f(x_{0})+2\\sum_{k=1}^{n-1}f(x_{k})+f(x_{n})\\right].\n$$\n当 $f(x)=\\frac{1}{x}$ 时，我们有\n$$\nf(x_{0})=1,\\quad f(x_{1})=\\frac{4}{5},\\quad f(x_{2})=\\frac{2}{3},\\quad f(x_{3})=\\frac{4}{7},\\quad f(x_{4})=\\frac{1}{2}.\n$$\n计算加权和：\n$$\nS=f(x_{0})+2\\big(f(x_{1})+f(x_{2})+f(x_{3})\\big)+f(x_{4})\n=1+2\\left(\\frac{4}{5}+\\frac{2}{3}+\\frac{4}{7}\\right)+\\frac{1}{2}.\n$$\n对括号内的项通分，公分母为 $105$，\n$$\n\\frac{4}{5}+\\frac{2}{3}+\\frac{4}{7}=\\frac{84+70+60}{105}=\\frac{214}{105},\n$$\n所以\n$$\nS=1+2\\cdot\\frac{214}{105}+\\frac{1}{2}\n=1+\\frac{428}{105}+\\frac{1}{2}\n=\\frac{1171}{210}.\n$$\n因此\n$$\nT=\\frac{h}{2}S=\\frac{1/4}{2}\\cdot\\frac{1171}{210}=\\frac{1}{8}\\cdot\\frac{1171}{210}=\\frac{1171}{1680}.\n$$\n\n使用 $\\ln(2)\\approx 0.69314718$，实际绝对误差为\n$$\nE_{\\text{actual}}=\\left|\\,\\ln(2)-T\\,\\right|=\\left|\\;0.69314718-\\frac{1171}{1680}\\;\\right|\n\\approx |0.69314718 - 0.69702381| \\approx 0.00387663.\n$$\n由于 $f''(x) = 2/x^3 > 0$ 在 $[1,2]$ 上，函数是下凹的，因此梯形法则会高估积分值，我们有 $T > \\ln(2)$。更精确地计算：\n$$\nE_{\\text{actual}} = \\frac{1171}{1680} - 0.69314718 \\approx 0.6970238095 - 0.69314718 = 0.0038766295.\n$$\n\n对于梯形法则的误差界，\n$$|E_{T}|\\le \\frac{M(b-a)^{3}}{12n^{2}},$$\n由于 $f''(x)=\\frac{2}{x^{3}}$，所以在 $[1,2]$ 上满足 $|f''(x)|\\le M$ 的最小 $M$ 值为 $M=f''(1)=2$。当 $b-a=1$ 且 $n=4$ 时，我们得到\n$$\nE_{\\text{bound}}=\\frac{2\\cdot 1^{3}}{12\\cdot 4^{2}}=\\frac{2}{192}=\\frac{1}{96}\\approx 0.0104166667.\n$$\n\n所求的差值（误差界减去实际绝对误差）为\n$$\nD=E_{\\text{bound}}-E_{\\text{actual}} \\approx 0.0104166667 - 0.0038766295 = 0.0065400372.\n$$\n四舍五入到六位有效数字得到\n$$\nD\\approx 0.00654004.\n$$", "answer": "$$\\boxed{0.00654004}$$", "id": "2210486"}, {"introduction": "在理解了误差分析的基础上，我们现在可以主动地运用这些知识。在实际应用中，我们常常需要保证计算结果达到一定的精度要求。这个练习让你扮演一位生物医学工程师的角色，你需要确定所需的最少子区间数量，以确保数值积分结果满足规定的误差容限。这个实践将重点从后验的误差分析转移到为保证精度而进行的前期规划上。[@problem_id:2210520]", "problem": "在一项药代动力学研究中，一种新药在患者血液中的浓度被建模为时间 $t$ 的函数，其方程为 $C(t) = C_0 \\exp(-kt^2)$。这里，$t$ 是注射后的时间（单位：小时），$C_0 = 50$ mg/L 是初始浓度，$k = 0.5 \\text{ hr}^{-2}$ 是一个与药物消除速率相关的常数。\n\n为了评估前两个小时内的总药物暴露量，一位生物医学工程师需要计算曲线下面积 (AUC)，它由定积分 $A = \\int_{0}^{T} C(t) dt$ 给出，其中 $T=2$ 小时。\n\n该工程师使用一种数值近似方法。时间区间 $[0, T]$ 被分成 $n$ 个相等的子区间，积分值通过对每个子区间上连接点 $(t_i, C(t_i))$ 和 $(t_{i+1}, C(t_{i+1}))$ 构成的梯形面积求和来近似。\n\n对于这种特定的数值方法，已知绝对误差 $|E_n|$ 受以下不等式约束：\n$$|E_n| \\le \\frac{M(T-0)^3}{12n^2}$$\n其中 $M$ 是浓度函数二阶导数的最大绝对值，$M = \\max_{t \\in [0, T]} |C''(t)|$。\n\n确定该工程师必须使用的最小整数子区间数 $n$，以保证计算出的 AUC 的绝对误差小于 $10^{-3}$ mg·hr/L。", "solution": "给定 $C(t) = C_{0}\\exp(-k t^{2})$，其中 $C_{0} = 50$，$k = 0.5$，以及梯形法则的误差界\n$$|E_{n}| \\le \\frac{M(T-0)^{3}}{12 n^{2}}, \\quad M = \\max_{t \\in [0,T]} |C''(t)|, \\quad T=2.$$\n\n首先计算 $C''(t)$。求导可得，\n$$C'(t) = C_{0}\\exp(-k t^{2})(-2 k t),$$\n$$C''(t) = C_{0}\\exp(-k t^{2})\\left(-2k + 4k^{2} t^{2}\\right) = 2k C_{0}\\exp(-k t^{2})\\left(2k t^{2} - 1\\right).$$\n因此\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left| 2k t^{2} - 1 \\right|.$$\n\n为了找到 $|C''(t)|$ 在 $[0,2]$ 上的最大值，我们检查其导数。令 $g(t) = C''(t)$。\n$g'(t) = 2kC_0 \\left[ \\exp(-kt^2)(-2kt)(2kt^2-1) + \\exp(-kt^2)(4kt) \\right] = 4k^2C_0 t \\exp(-kt^2) [-(2kt^2-1)+2] = 4k^2C_0 t \\exp(-kt^2)(3-2kt^2)$.\n临界点在 $t=0$ 和 $3-2kt^2=0 \\implies t = \\sqrt{3/(2k)}$。\n给定 $k=0.5$，临界点为 $t=0$ 和 $t=\\sqrt{3} \\approx 1.732$，两者都在 $[0,2]$ 区间内。\n我们还需检查使 $2kt^2-1=0$ 的点（即 $t=1/\\sqrt{2k}=1$），因为绝对值函数在此处不可导。\n我们需要在这些临界点和区间的端点处评估 $|C''(t)|$：$t=0, 1, \\sqrt{3}, 2$。\n代入 $C_0=50, k=0.5$，$C''(t) = 50\\exp(-0.5t^2)(t^2-1)$。\n- 在 $t=0$ 处，$|C''(0)| = |50 \\cdot 1 \\cdot (0-1)| = 50$。\n- 在 $t=1$ 处，$|C''(1)| = |50 \\exp(-0.5)(1-1)| = 0$。\n- 在 $t=\\sqrt{3}$ 处，$|C''(\\sqrt{3})| = |50 \\exp(-1.5)(3-1)| = 100\\exp(-1.5) \\approx 100 \\cdot 0.2231 = 22.31$。\n- 在 $t=2$ 处，$|C''(2)| = |50 \\exp(-2)(4-1)| = 150\\exp(-2) \\approx 150 \\cdot 0.1353 = 20.30$。\n比较这些值，最大值在 $t=0$ 处取得：\n$$M = \\max_{t \\in [0,2]} |C''(t)| = 50.$$\n\n应用 $T=2$ 时的误差界：\n$$|E_{n}| \\le \\frac{M T^{3}}{12 n^{2}} = \\frac{50 \\cdot 2^{3}}{12 n^{2}} = \\frac{400}{12 n^{2}} = \\frac{100}{3 n^{2}}.$$\n要求 $|E_{n}| < 10^{-3}$：\n$$\\frac{100}{3 n^{2}} < 10^{-3} \\quad \\Longleftrightarrow \\quad n^{2} > \\frac{100}{3 \\cdot 10^{-3}} = \\frac{100000}{3} \\approx 33333.33.$$\n因此 $n > \\sqrt{\\frac{100000}{3}} \\approx 182.574$。\n满足该不等式的最小整数 $n$ 是\n$$n = 183.$$", "answer": "$$\\boxed{183}$$", "id": "2210520"}, {"introduction": "虽然增加子区间数量 $n$ 可以提高精度，但这通常会带来高昂的计算成本。有没有更聪明的方法呢？本练习将介绍一种强大的加速收敛技术——理查森外推法 (Richardson extrapolation)。通过巧妙地组合使用不同步长得到的两个近似值，我们可以消除主要的误差项，从而获得一个精度显著更高的结果。这个练习揭示了数值分析中的一个关键思想：通过巧妙的算法而非“暴力计算”来获得更高的精度。[@problem_id:2210511]", "problem": "一颗科研卫星被设计用于测量其穿过行星状星云时特定类型的宇宙辐射。测得的辐射通量 $F(t)$ 作为时间 $t$ 的函数，根据以下模型变化：\n$$F(t) = F_0 \\exp\\left(-\\frac{t^2}{\\tau^2}\\right) \\cos(\\omega t)$$\n卫星探测器在观测期间接收到的单位面积总能量，称为能流密度 $\\Phi$，由通量的时间积分给出。\n\n给定以下观测参数：\n-   峰值通量, $F_0 = 100.0 \\, \\text{J/(m}^2 \\cdot \\text{s)}$\n-   特征时间, $\\tau = 2.0 \\, \\text{s}$\n-   角频率, $\\omega = 0.5 \\, \\text{rad/s}$\n\n你的任务是估算从 $t=0$ 秒到 $t=2.0$ 秒的总能流密度。为此，首先使用复合梯形法则计算积分的两个近似值：一个使用 $n=2$ 个子区间，另一个使用 $2n=4$ 个子区间。然后，使用这两个近似值执行一步理查森外推法，以找到更精确的能流密度值。\n\n计算总能流密度 $\\Phi$ 的最终外推值。你的答案以焦耳每平方米（J/m$^2$）为单位，并四舍五入到四位有效数字。", "solution": "能流密度是观测窗口内通量的时间积分：\n$$\n\\Phi=\\int_{0}^{2}F(t)\\,dt=\\int_{0}^{2}F_{0}\\exp\\left(-\\frac{t^{2}}{\\tau^{2}}\\right)\\cos(\\omega t)\\,dt.\n$$\n使用复合梯形法则，有 $n$ 个子区间和步长 $h=\\frac{b-a}{n}$，\n$$\nT_{n}=h\\left[\\frac{F(a)+F(b)}{2}+\\sum_{i=1}^{n-1}F(a+ih)\\right],\n$$\n其中 $a=0$ 且 $b=2$。\n\n对于 $n=2$，$h=1$，节点为 $t_{0}=0$，$t_{1}=1$，$t_{2}=2$。已知 $F_{0}=100$，$\\tau=2$，$\\omega=0.5$，\n$$\nF(t)=100\\,\\exp\\left(-\\frac{t^{2}}{4}\\right)\\cos\\left(0.5\\,t\\right).\n$$\n计算：\n$$\nF(0)=100,\n$$\n$$\nF(1)=100\\,\\exp\\left(-\\frac{1}{4}\\right)\\cos\\left(0.5\\right)\\approx 68.34619863,\n$$\n$$\nF(2)=100\\,\\exp(-1)\\cos(1)\\approx 19.87661103.\n$$\n因此，\n$$\nT_{2}=1\\left[\\frac{100+19.87661103}{2}+68.34619863\\right]\\approx 59.9383055 + 68.34619863 \\approx 128.284504.\n$$\n\n对于 $n=4$，$h=0.5$，节点为 $t=0, 0.5, 1.0, 1.5, 2.0$。计算额外的点：\n$$\nF(0.5)=100\\,\\exp\\left(-\\frac{(0.5)^{2}}{4}\\right)\\cos\\left(0.25\\right)\\approx 91.02089855,\n$$\n$$\nF(1.5)=100\\,\\exp\\left(-\\frac{(1.5)^{2}}{4}\\right)\\cos\\left(0.75\\right)\\approx 41.69037505.\n$$\n然后，\n$$\nT_{4}=0.5\\left[\\frac{100+19.87661103}{2}+91.02089855+68.34619863+41.69037505\\right]\\approx 0.5 [59.9383055 + 201.05747223] \\approx 130.497889.\n$$\n\n对于梯形法则，误差展开式具有形式 $T(h)=I+C h^{2}+O(h^{4})$，因此单步理查森外推法给出\n$$\n\\Phi \\approx \\frac{4T(h/2)-T(h)}{3}=\\frac{4T_{4}-T_{2}}{3}.\n$$\n代入计算出的值，\n$$\n\\Phi \\approx \\frac{4\\cdot 130.497889 - 128.284504}{3} \\approx \\frac{521.991556 - 128.284504}{3} = \\frac{393.707052}{3} \\approx 131.235684.\n$$\n四舍五入到四位有效数字，得到 $131.2$ J/m$^{2}$。", "answer": "$$\\boxed{131.2}$$", "id": "2210511"}]}