{"hands_on_practices": [{"introduction": "我们从一个基本问题入手，来理解“精度” (degree of precision) 这一概念。本练习将引导你通过测试最简单的单点高斯-勒让德求积法则（即中点法则），来验证其多项式精度。这个过程将为你展示确定任何数值积分法则精度的标准方法，是后续更复杂分析的基础 [@problem_id:2175007]。", "problem": "一个数值求积法则的精确度阶是指该法则能对次数最高为 $d$ 的所有多项式精确计算积分的最大整数 $d$。\n\n考虑单点高斯-勒让德求积法则，它使用以下公式近似计算函数 $f(x)$ 在区间 $[-1, 1]$ 上的定积分：\n$$ \\int_{-1}^{1} f(x) \\,dx \\approx 2 f(0) $$\n\n为了确定该法则的精确度阶，你必须在形如 $f(x) = x^k$（其中 $k = 0, 1, 2, \\ldots$ 为非负整数）的单项式上测试其准确性。通过找出使该法则给出精确结果的 $k$ 的最大值，你就可以确定其精确度阶。\n\n上述单点高斯-勒让德求积法则的精确度阶是多少？\n\nA. 0\n\nB. 1\n\nC. 2\n\nD. 3", "solution": "我们在单项式 $f(x)=x^{k}$ 上测试法则 $Q(f)=2 f(0)$，并与在 $[-1,1]$ 上的精确积分进行比较，以确定使得该法则对所有次数至多为 $d$ 的多项式都精确的最大整数 $d$。\n\n对于 $k=0$（常数）：\n$$\\int_{-1}^{1} x^{0} \\, dx=\\int_{-1}^{1} 1 \\, dx=2,$$\n而求积法则给出\n$$Q(x^{0})=2 \\cdot 1=2.$$\n因此，它对 $k=0$ 是精确的。\n\n对于 $k=1$（线性）：\n$$\\int_{-1}^{1} x \\, dx=0,$$\n且\n$$Q(x)=2 \\cdot 0=0.$$\n因此，它对 $k=1$ 是精确的。\n\n对于 $k=2$（二次）：\n$$\\int_{-1}^{1} x^{2} \\, dx=\\left.\\frac{x^{3}}{3}\\right|_{-1}^{1}=\\frac{2}{3},$$\n但是\n$$Q(x^{2})=2 \\cdot 0^{2}=0.$$\n因此，它对 $k=2$ 不是精确的。\n\n因此，该法则对所有次数至多为 $1$ 的多项式都是精确的，而在次数为 $2$ 时失效。因此，精确度阶为 $1$，对应选项 B。（注意：尽管由于对称性和 $f(0)=0$，该法则对所有奇次单项式也精确，但精确度阶要求对直到给定次数的所有多项式都精确，而在 $k=2$ 处的失效将精确度阶限制为 $1$。）", "answer": "$$\\boxed{B}$$", "id": "2175007"}, {"introduction": "掌握了基本方法后，我们来挑战一个更复杂的场景。本练习提供了一个未知的三点求积法则的节点和权重，要求你系统地测试并确定其精度 [@problem_id:2419560]。通过这个实践，你将学会如何仅根据求积法则的定义来评估其性能，并体会到精心设计的数值方法（如高斯求积）所能达到的惊人精度。", "problem": "一个未知的3点求积公式 $Q[f]$ 是为积分 $\\int_{-1}^{1} f(x)\\,dx$ 所指定的，其节点和权重如下：\n- 节点：$x_{1}=-\\sqrt{\\dfrac{3}{5}}$，$x_{2}=0$，$x_{3}=+\\sqrt{\\dfrac{3}{5}}$。\n- 权重：$w_{1}=\\dfrac{5}{9}$，$w_{2}=\\dfrac{8}{9}$，$w_{3}=\\dfrac{5}{9}$。\n\n仅使用这些节点和权重，确定此公式的代数精度，也即，对于次数至多为 $m$ 的任意多项式 $p$ ，$Q[p]=\\int_{-1}^{1} p(x)\\,dx$ 均成立的最大整数 $m$。\n\n选择一项：\nA. $3$\n\nB. $4$\n\nC. $5$\n\nD. $6$", "solution": "一个求积公式的代数精度 $m$ 是指该公式能精确积分所有次数最高为 $m$ 的多项式的最大整数。为求得 $m$，我们用单项式基 $p_k(x) = x^k$（其中 $k = 0, 1, 2, \\dots$）来测试该公式。如果该公式对于所有 $k \\leq m$ 都精确，而对于 $k = m+1$ 不精确，那么它的代数精度就是 $m$。\n\n单项式 $x^k$ 在区间 $[-1, 1]$ 上的精确积分为：\n$$I[x^k] = \\int_{-1}^{1} x^k \\,dx = \\left[ \\frac{x^{k+1}}{k+1} \\right]_{-1}^{1} = \\frac{1 - (-1)^{k+1}}{k+1}$$\n计算结果为：\n- 如果 $k$ 是偶数，$I[x^k] = \\frac{2}{k+1}$。\n- 如果 $k$ 是奇数，$I[x^k] = 0$。\n\n求积近似值为：\n$$Q[x^k] = w_1 x_1^k + w_2 x_2^k + w_3 x_3^k = \\frac{5}{9}\\left(-\\sqrt{\\frac{3}{5}}\\right)^k + \\frac{8}{9}(0)^k + \\frac{5}{9}\\left(+\\sqrt{\\frac{3}{5}}\\right)^k$$\n\n我们现在对递增的 $k$ 值进行测试。\n\n对于 $k=0$：多项式为 $p_0(x) = 1$。\n$I[1] = \\int_{-1}^{1} 1 \\,dx = 2$。\n$Q[1] = \\frac{5}{9}(1) + \\frac{8}{9}(1) + \\frac{5}{9}(1) = \\frac{5+8+5}{9} = \\frac{18}{9} = 2$。\n$I[1] = Q[1]$。该公式对0次多项式精确。\n\n对于奇数 $k \\ge 1$：节点和权重关于 $x=0$ 对称。即 $x_1 = -x_3$ 且 $w_1 = w_3$。对于任意奇函数 $f(x)$，$Q[f] = w_1 f(x_1) + w_2 f(0) + w_3 f(x_3) = w_1 f(-x_3) + w_2 f(0) + w_1 f(x_3) = -w_1 f(x_3) + w_2 f(0) + w_1 f(x_3) = w_2 f(0)$。\n对于 $p_k(x) = x^k$ 且 $k$ 为奇数 $\\ge 1$，$p_k(0)=0$。因此，$Q[x^k] = 0$。\n对于奇数 $k$，精确积分为 $I[x^k]=0$。\n因此，对于所有奇数 $k \\ge 1$，$I[x^k] = Q[x^k]$。我们已经对 $k=1, 3, 5$ 进行了明确验证：\n- 对于 $k=1$：$I[x]=0$，$Q[x]=0$。\n- 对于 $k=3$：$I[x^3]=0$，$Q[x^3]=0$。\n- 对于 $k=5$：$I[x^5]=0$，$Q[x^5]=0$。\n该公式对1次、3次和5次多项式是精确的。\n\n我们只需要检查偶数次幂。\n对于偶数 $k$：\n$Q[x^k] = \\frac{5}{9}\\left(-\\sqrt{\\frac{3}{5}}\\right)^k + \\frac{8}{9}(0)^k + \\frac{5}{9}\\left(+\\sqrt{\\frac{3}{5}}\\right)^k = 2 \\cdot \\frac{5}{9}\\left(\\frac{3}{5}\\right)^{k/2} = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^{k/2}$。\n\n对于 $k=2$：\n$I[x^2] = \\frac{2}{2+1} = \\frac{2}{3}$。\n$Q[x^2] = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^{2/2} = \\frac{10}{9}\\left(\\frac{3}{5}\\right) = \\frac{30}{45} = \\frac{2}{3}$。\n$I[x^2] = Q[x^2]$。该公式对2次多项式精确。\n\n对于 $k=4$：\n$I[x^4] = \\frac{2}{4+1} = \\frac{2}{5}$。\n$Q[x^4] = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^{4/2} = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^2 = \\frac{10}{9}\\left(\\frac{9}{25}\\right) = \\frac{10}{25} = \\frac{2}{5}$。\n$I[x^4] = Q[x^4]$。该公式对4次多项式精确。\n\n由于该公式对0, 1, 2, 3, 4, 5次单项式都精确，因此它对这些单项式的任意线性组合（即任何次数至多为5的多项式）都精确。代数精度至少为5。\n\n现在我们必须测试 $k=6$：\n$I[x^6] = \\frac{2}{6+1} = \\frac{2}{7}$。\n$Q[x^6] = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^{6/2} = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^3 = \\frac{10}{9}\\left(\\frac{27}{125}\\right) = \\frac{10 \\cdot 27}{9 \\cdot 125} = \\frac{2 \\cdot 5 \\cdot 3 \\cdot 9}{9 \\cdot 25 \\cdot 5} = \\frac{6}{25}$。\n我们比较 $I[x^6]$ 和 $Q[x^6]$：\n$I[x^6] = \\frac{2}{7} \\approx 0.2857$。\n$Q[x^6] = \\frac{6}{25} = 0.24$。\n显然，$I[x^6] \\neq Q[x^6]$。该公式对6次多项式不精确。\n\n该公式对所有次数至多为 $m$ 的多项式都精确的最大整数 $m$ 是 $5$。\n\n**选项评估**\n\nA. $3$：这是**不正确**的。该公式已被证明对4次和5次多项式是精确的。\n\nB. $4$：这是**不正确**的。该公式已被证明对5次多项式是精确的。\n\nC. $5$：这是**正确**的。该公式对所有次数不超过5（包括5）的多项式都精确，但对一个6次多项式则不精确。\n\nD. $6$：这是**不正确**的。该公式对多项式 $p(x)=x^6$ 不精确。", "answer": "$$\\boxed{C}$$", "id": "2419560"}, {"introduction": "精度分析不仅限于数值积分，它在数值微分中同样至关重要。这个练习将探讨一个核心的实际问题：如何在计算导数时，平衡由公式近似产生的截断误差和由计算机浮点运算产生的舍入误差 [@problem_id:3222056]。通过推导最佳步长 $h$，你将深入理解理论精度与计算现实之间的权衡，这是科学计算中的一个普遍挑战。", "problem": "您正在使用前向差分公式 $D(h) = \\frac{f(x+h) - f(x)}{h}$ 来近似光滑函数 $f$ 在点 $x$ 处的导数，该计算在单位舍入误差为 $u \\in (0,1)$ 的标准浮点运算中进行。假设 $f$ 在 $x$ 的一个邻域内至少是二阶连续可微的，且 $f''(x) \\neq 0$，$|f(x)| > 0$。采用传统的浮点模型，即每次求值返回的函数值 $\\widehat{f}(y)$ 都满足 $\\widehat{f}(y) = f(y)\\,(1+\\delta)$，其中 $|\\delta| \\leq u$，且每次求值的误差是独立的。\n\n使用泰勒定理分析截断误差，并使用上述浮点模型分析舍入误差，推导 $D(h)$ 作为 $f'(x)$ 近似值的绝对误差的一个显式上界（作为步长 $h>0$ 的函数）。然后，通过最小化该上界，确定能平衡截断误差和舍入误差的步长 $h$。请以包含 $u$、$|f(x)|$ 和 $|f''(x)|$ 的单一闭式表达式给出您的最终答案。不要为这些量引入任何数值，也不要做出超出所述假设范围的任何抵消假设。您的最终答案必须是一个单一的解析表达式。", "solution": "导数 $f'(x)$ 的计算近似值 $\\widehat{D}(h)$ 的总误差由 $E_{total}(h) = |\\widehat{D}(h) - f'(x)|$ 给出。我们可以使用三角不等式将此误差分解为两个部分：截断误差和舍入误差。\n$$E_{total}(h) = |(\\widehat{D}(h) - D(h)) + (D(h) - f'(x))| \\le |\\widehat{D}(h) - D(h)| + |D(h) - f'(x)|$$\n项 $|D(h) - f'(x)|$ 是截断误差 $E_{trunc}(h)$，其产生原因是我们使用有限差分公式来近似一个极限。项 $|\\widehat{D}(h) - D(h)|$ 是舍入误差 $E_{round}(h)$，其产生原因是浮点运算的有限精度。\n\n首先，我们来分析截断误差 $E_{trunc}(h)$。由于假设函数 $f$ 至少是二阶连续可微的，我们可以使用泰勒定理将 $f(x+h)$ 在 $x$ 附近展开：\n$$f(x+h) = f(x) + hf'(x) + \\frac{h^2}{2} f''(\\xi)$$\n其中 $\\xi$ 是介于 $x$ 和 $x+h$ 之间的某个点。\n将此展开式代入 $D(h)$ 的公式中：\n$$D(h) = \\frac{\\left(f(x) + hf'(x) + \\frac{h^2}{2} f''(\\xi)\\right) - f(x)}{h} = f'(x) + \\frac{h}{2} f''(\\xi)$$\n因此，截断误差为：\n$$D(h) - f'(x) = \\frac{h}{2} f''(\\xi)$$\n截断误差的大小有界：\n$$E_{trunc}(h) = |D(h) - f'(x)| = \\left|\\frac{h}{2} f''(\\xi)\\right| = \\frac{h}{2} |f''(\\xi)|$$\n由于 $f''$ 是连续的，对于很小的 $h$，$f''(\\xi)$ 的值趋近于 $f''(x)$。因此，截断误差的一个标准的主阶上界是：\n$$E_{trunc}(h) \\le \\frac{h}{2} |f''(x)|$$\n\n接下来，我们分析舍入误差 $E_{round}(h)$。导数的计算值 $\\widehat{D}(h)$ 基于函数的计算值 $\\widehat{f}(x)$ 和 $\\widehat{f}(x+h)$。根据问题的模型：\n$$\\widehat{f}(x) = f(x)(1+\\delta_1) \\quad \\text{with } |\\delta_1| \\le u$$\n$$\\widehat{f}(x+h) = f(x+h)(1+\\delta_2) \\quad \\text{with } |\\delta_2| \\le u$$\n计算出的差商是 $\\widehat{D}(h) = \\frac{\\widehat{f}(x+h) - \\widehat{f}(x)}{h}$。在此分析中，我们忽略减法和除法引入的额外舍入误差，因为通常由函数求值产生的误差占主导地位。\n舍入误差是：\n$$E_{round}(h) = |\\widehat{D}(h) - D(h)| = \\left|\\frac{f(x+h)(1+\\delta_2) - f(x)(1+\\delta_1)}{h} - \\frac{f(x+h) - f(x)}{h}\\right|$$\n$$E_{round}(h) = \\left|\\frac{f(x+h)\\delta_2 - f(x)\\delta_1}{h}\\right|$$\n对分子使用三角不等式：\n$$E_{round}(h) \\le \\frac{|f(x+h)\\delta_2| + |f(x)\\delta_1|}{h} \\le \\frac{|f(x+h)||\\delta_2| + |f(x)||\\delta_1|}{h}$$\n使用界 $|\\delta_i| \\le u$：\n$$E_{round}(h) \\le \\frac{u (|f(x+h)| + |f(x)|)}{h}$$\n由于 $f$ 是连续的，对于很小的 $h$，$f(x+h) \\approx f(x)$。因此，我们可以通过用 $|f(x)|$ 替换 $|f(x+h)|$ 来近似该界：\n$$E_{round}(h) \\le \\frac{2u|f(x)|}{h}$$\n这个近似是合理的，因为它捕捉到了两个几乎相等的数 $f(x+h)$ 和 $f(x)$ 相减时发生的灾难性抵消效应，该效应会将初始舍入误差放大一个与 $\\frac{1}{h}$ 成正比的因子。\n\n现在我们得到了总误差的一个上界，记为 $E(h)$：\n$$E(h) = E_{trunc}(h) + E_{round}(h) \\approx \\frac{h}{2}|f''(x)| + \\frac{2u|f(x)|}{h}$$\n为了找到使该误差界最小化的步长 $h$，我们将 $E(h)$ 对 $h$ 求导，并令结果为零。\n$$\\frac{dE}{dh} = \\frac{d}{dh}\\left(\\frac{h}{2}|f''(x)| + \\frac{2u|f(x)|}{h}\\right) = \\frac{1}{2}|f''(x)| - \\frac{2u|f(x)|}{h^2}$$\n令 $\\frac{dE}{dh} = 0$：\n$$\\frac{1}{2}|f''(x)| = \\frac{2u|f(x)|}{h^2}$$\n解出 $h^2$：\n$$h^2 = \\frac{4u|f(x)|}{|f''(x)|}$$\n由于 $h>0$，我们取正平方根：\n$$h = \\sqrt{\\frac{4u|f(x)|}{|f''(x)|}} = 2\\sqrt{\\frac{u|f(x)|}{|f''(x)|}}$$\n为了确认这是一个最小值，我们检查二阶导数：\n$$\\frac{d^2E}{dh^2} = \\frac{d}{dh}\\left(\\frac{1}{2}|f''(x)| - 2u|f(x)|h^{-2}\\right) = -2u|f(x)|(-2h^{-3}) = \\frac{4u|f(x)|}{h^3}$$\n鉴于 $u>0$，$|f(x)|>0$ 且 $h>0$，二阶导数 $\\frac{d^2E}{dh^2}$ 总是正的。这证实了所找到的 $h$ 值对应于误差界函数 $E(h)$ 的一个最小值。这个最优步长代表了递减的截断误差和递增的舍入误差达到平衡的点。", "answer": "$$ \\boxed{2\\sqrt{\\frac{u|f(x)|}{|f''(x)|}}} $$", "id": "3222056"}]}