{"hands_on_practices": [{"introduction": "掌握任何数值方法的第一步都是将其应用于一个具体问题。本练习将数值积分这一抽象概念与压缩气体过程中做功的物理计算联系起来 ([@problem_id:2222091])。通过仅使用两个区间来应用梯形法则，你将练习该方法的基本步骤，并在实践中体会其几何意义。", "problem": "在一个材料科学实验中，一个活塞被用来压缩气缸中的气体。这个过程进行得很缓慢，因此可以被认为是准静态和等温的。将活塞保持在位置 $x$ (从气缸的封闭端测量) 所需的力 $F$ 被发现遵循定律 $F(x) = \\frac{k}{x}$，其中 $k$ 是一个与温度和气体量相关的常数。\n\n为了移动活塞并压缩气体，必须做功。由外部作用力将活塞从初始位置 $x_i$ 移动到最终位置 $x_f$ 所做的精确功 $W$ 由积分 $W = \\int_{x_i}^{x_f} F(x) dx$ 给出。\n\n假设活塞从 $x_i = 1$ 米移动到 $x_f = 3$ 米，且常数 $k$ 等于 1 牛·米。你的任务是求出所做功的近似值。近似方法包括以下步骤：\n1. 将总位移区间 $[x_i, x_f]$ 分成两个等长的子区间。\n2. 对于每个子区间，用力-位移曲线下的面积近似为由 x 轴、子区间端点处的垂线以及连接这些端点处力值的直线段所形成的梯形的面积。\n3. 将这两个梯形的面积相加，得到总的近似功。\n\n使用这种方法，计算移动活塞所做的近似功。以焦耳为单位，用一个简化的分数表示你的答案。", "solution": "问题要求计算在力 $F(x) = \\frac{k}{x}$ 的作用下，将活塞从 $x_i = 1$ 米移动到 $x_f = 3$ 米所做的功 $W$ 的近似值。我们已知 $k = 1$ 牛·米。功由以下积分给出：\n$$W = \\int_{1}^{3} \\frac{1}{x} dx$$\n\n问题描述了一种数值近似方法，它等同于使用两个分段的复合梯形法则。设区间为 $[a, b] = [1, 3]$，分段数为 $n=2$。要积分的函数是 $f(x) = \\frac{1}{x}$。\n\n首先，我们计算每个子区间的宽度 $h$：\n$$h = \\frac{b - a}{n} = \\frac{3 - 1}{2} = 1$$\n\n两个子区间是 $[1, 2]$ 和 $[2, 3]$。求值点（子区间的端点）是 $x_0 = 1$，$x_1 = 2$ 和 $x_2 = 3$。\n\n所描述的近似方法是求两个梯形的面积之和。\n第一个梯形在区间 $[x_0, x_1]$ 上的面积是：\n$$A_1 = \\frac{h}{2} (f(x_0) + f(x_1))$$\n第二个梯形在区间 $[x_1, x_2]$ 上的面积是：\n$$A_2 = \\frac{h}{2} (f(x_1) + f(x_2))$$\n\n总的近似功 $W_{approx}$ 是这两个面积的和：\n$$W_{approx} = A_1 + A_2 = \\frac{h}{2}(f(x_0) + f(x_1)) + \\frac{h}{2}(f(x_1) + f(x_2))$$\n这可以简化为标准的复合梯形法则公式：\n$$W_{approx} = \\frac{h}{2} (f(x_0) + 2f(x_1) + f(x_2))$$\n\n现在我们在点 $x_0, x_1, x_2$ 处计算函数 $f(x) = \\frac{1}{x}$ 的值：\n$$f(x_0) = f(1) = \\frac{1}{1} = 1$$\n$$f(x_1) = f(2) = \\frac{1}{2}$$\n$$f(x_2) = f(3) = \\frac{1}{3}$$\n\n现在，我们将这些值代入 $W_{approx}$ 的公式中。我们还代入 $h=1$。\n$$W_{approx} = \\frac{1}{2} \\left( 1 + 2\\left(\\frac{1}{2}\\right) + \\frac{1}{3} \\right)$$\n\n我们简化括号内的表达式：\n$$W_{approx} = \\frac{1}{2} \\left( 1 + 1 + \\frac{1}{3} \\right)$$\n$$W_{approx} = \\frac{1}{2} \\left( 2 + \\frac{1}{3} \\right)$$\n\n为了将括号内的项相加，我们找到一个公分母：\n$$W_{approx} = \\frac{1}{2} \\left( \\frac{6}{3} + \\frac{1}{3} \\right)$$\n$$W_{approx} = \\frac{1}{2} \\left( \\frac{7}{3} \\right)$$\n\n最后，我们进行乘法运算：\n$$W_{approx} = \\frac{7}{6}$$\n\n问题说明 $k$ 的单位是牛·米，$x$ 的单位是米，所以功 $W$ 的单位是焦耳。问题要求答案以焦耳为单位，用一个简化的分数表示。我们的结果是 $7/6$。", "answer": "$$\\boxed{\\frac{7}{6}}$$", "id": "2222091"}, {"introduction": "在真实的科学应用中，仅仅得到一个近似值通常是不够的；我们还必须保证其准确性。本实践问题超越了简单的应用，进入了误差控制这一关键概念 ([@problem_id:2210520])。通过一个药物动力学的场景，你将学习如何利用梯形法则的误差界来确定达到所需精度所需的最少子区间数。", "problem": "在一项药代动力学研究中，一种新药在患者血液中的浓度被建模为时间 $t$ 的函数，其方程为 $C(t) = C_0 \\exp(-kt^2)$。此处，$t$ 是注射后的时间（单位：小时），$C_0 = 50$ mg/L 是初始浓度，$k = 0.5 \\text{ hr}^{-2}$ 是一个与药物消除速率相关的常数。\n\n为了评估最初两小时内的总药物暴露量，一位生物医学工程师需要计算曲线下面积（AUC），该面积由定积分 $A = \\int_{0}^{T} C(t) dt$ 给出，其中 $T=2$ 小时。\n\n该工程师使用一种数值近似方法。时间区间 $[0, T]$ 被分成 $n$ 个相等的子区间，积分值通过对每个子区间上连接点 $(t_i, C(t_i))$ 和 $(t_{i+1}, C(t_{i+1}))$ 所形成的梯形的面积求和来近似。\n\n对于这种特定的数值方法，已知绝对误差 $|E_n|$ 受以下不等式约束：\n$$|E_n| \\le \\frac{M(T-0)^3}{12n^2}$$\n其中 $M$ 是浓度函数二阶导数绝对值的最大值，$M = \\max_{t \\in [0, T]} |C''(t)|$。\n\n确定该工程师必须使用的最小整数子区间数 $n$，以保证计算出的 AUC 的绝对误差小于 $10^{-3}$ mg·hr/L。", "solution": "我们已知 $C(t) = C_{0}\\exp(-k t^{2})$，其中 $C_{0} = 50$，$k = 0.5$，以及梯形法则的误差界\n$$|E_{n}| \\le \\frac{M(T-0)^{3}}{12 n^{2}}, \\quad M = \\max_{t \\in [0,T]} |C''(t)|, \\quad T=2.$$\n\n首先计算 $C''(t)$。求导可得：\n$$C'(t) = C_{0}\\exp(-k t^{2})(-2 k t),$$\n$$C''(t) = C_{0}\\exp(-k t^{2})\\left(-2k + 4k^{2} t^{2}\\right) = 2k C_{0}\\exp(-k t^{2})\\left(2k t^{2} - 1\\right).$$\n因此\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left| 2k t^{2} - 1 \\right|.$$\n\n令 $t_{0} = \\frac{1}{\\sqrt{2k}}$。当 $k=0.5$ 时，$t_0 = 1$。对于 $t \\in [0,t_{0}]$，我们有 $2k t^{2} - 1 \\le 0$，所以\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left(1 - 2k t^{2}\\right).$$\n定义 $h_{1}(t) = 2k C_{0}\\exp(-k t^{2})(1 - 2k t^{2})$。其导数为\n$$h_{1}'(t) = 4 k^{2} C_{0} t \\exp(-k t^{2})\\left(2k t^{2} - 3\\right).$$\n在 $(0,t_{0}]$ 上，由于 $t_{0}^{2} = \\frac{1}{2k}$，我们有 $2k t^{2} \\le 1$，因此 $2k t^{2} - 3  0$。所以 $h_{1}'(t) \\le 0$。所以 $h_{1}$ 在 $[0,t_{0}]$ 上是递减的，并在 $t=0$ 处取得其最大值：\n$$h_{1}(0) = 2k C_{0}.$$\n\n对于 $t \\in [t_{0},T]$，我们有 $2k t^{2} - 1 \\ge 0$，所以\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left(2k t^{2} - 1\\right).$$\n定义 $h_{2}(t) = 2k C_{0}\\exp(-k t^{2})(2k t^{2} - 1)$。其导数为\n$$h_{2}'(t) = 4 k^{2} C_{0} t \\exp(-k t^{2})\\left(3 - 2k t^{2}\\right).$$\n在 $[t_{0},T]$ 中的临界点出现在 $t = \\sqrt{\\frac{3}{2k}}$ 处，如果该点位于区间内。当 $k = 0.5$ 时，我们有 $t_{0} = 1$，$T=2$，且 $\\sqrt{\\frac{3}{2k}} = \\sqrt{3} \\in [1,2]$。在候选点处计算 $h_{2}$ 的值：\n- 在 $t = t_{0} = 1$ 处，$h_{2}(1) = 0$。\n- 在 $t = \\sqrt{3}$ 处，由于 $2k t^{2} = 3$，\n$$h_{2}\\!\\left(\\sqrt{3}\\right) = 2k C_{0} \\exp\\!\\left(-\\frac{3}{2}\\right) (3-1) = 4k C_{0}\\exp\\!\\left(-\\frac{3}{2}\\right).$$\n- 在 $t = T=2$ 处，\n$$h_{2}(2) = 2k C_{0}\\left(2k(4) - 1\\right)\\exp(-4k) = 2kC_0(8k-1) \\exp(-4k).$$\n\n将这些值与 $2k C_{0}$ 进行比较。注意\n$$4k C_{0}\\exp\\!\\left(-\\frac{3}{2}\\right) = 2k C_{0} \\cdot 2\\exp\\!\\left(-\\frac{3}{2}\\right)  2k C_{0}$$\n因为 $\\exp\\!\\left(\\frac{3}{2}\\right) > 2$，所以 $2\\exp(-\\frac{3}{2})  1$。对于 $k=0.5$，$h_{2}(2) = 50(3)e^{-2} = 150e^{-2}  50$。因此，在 $[0,2]$ 上的最大值在 $t=0$ 处取得：\n$$M = \\max_{t \\in [0,2]} |C''(t)| = 2k C_{0} = 2 \\cdot 0.5 \\cdot 50 = 50.$$\n\n应用 $T=2$ 时的误差界：\n$$|E_{n}| \\le \\frac{M T^{3}}{12 n^{2}} = \\frac{50 \\cdot 2^{3}}{12 n^{2}} = \\frac{400}{12n^2} = \\frac{100}{3 n^{2}}.$$\n要求 $|E_{n}|  10^{-3}$：\n$$\\frac{100}{3 n^{2}}  10^{-3} \\quad \\Longleftrightarrow \\quad n^{2} > \\frac{100}{3 \\cdot 10^{-3}} = \\frac{100000}{3}.$$\n因此 $n > \\sqrt{\\frac{100000}{3}} \\approx \\sqrt{33333.33} \\approx 182.57$。\n满足该不等式的最小整数 $n$ 是\n$$n = 183.$$", "answer": "$$\\boxed{183}$$", "id": "2210520"}, {"introduction": "人们通常认为，阶数越高的数值方法总是越好。这个高级问题将挑战这一假设，并鼓励你深入思考函数与用于近似其积分的方法之间的相互作用 ([@problem_id:3284359])。你将设计一个特定的函数，使得简单的梯形法则出人意料地比更复杂的辛普森法则产生更准确的结果，这为理解方法基本原理的重要性提供了宝贵的一课。", "problem": "考虑在区间 $[0,1]$ 上对一个光滑函数进行数值积分，预算固定为在均匀间隔的节点 $x_j = j/8$（其中 $j = 0,1,\\dots,8$）上进行 $9$ 次函数求值。对于这组节点，可以通过用多项式对 $f(x)$ 进行局部插值，然后对这些插值多项式进行积分，来构造复合求积法则，以近似定积分 $\\int_{0}^{1} f(x)\\,dx$。两种广泛使用的此类法则是基于线性插值（复合梯形法则）和二次插值（复合辛普森法则），两者都作用于均匀网格。\n\n严格从数值求积的这些核心定义（即在均匀节点上构造的插值型公式）出发，且不引用任何预先给出的误差常数或闭式误差公式，请设计一个在 $[0,1]$ 上的具体、连续可微的函数 $f(x)$，使得当两种法则在节点 $\\{x_j\\}_{j=0}^{8}$ 上使用相同的 $9$ 次函数求值时，复合梯形法则对 $\\int_{0}^{1} f(x)\\,dx$ 的近似结果比复合辛普森法则更精确。\n\n你的答案必须是 $f(x)$ 的一个显式解析表达式，并且你必须在推理过程中证明，对于这个 $f(x)$ 和指定的节点，复合梯形法则确实比复合辛普森法则严格更接近真实积分值。无需四舍五入，也不涉及任何单位；请在你的推理中使用精确值。", "solution": "我们的目标是找到一个在 $[0,1]$ 上连续可微的函数 $f(x)$，使得在给定的 $9$ 点均匀网格上，复合梯形法则对 $I = \\int_0^1 f(x) dx$ 的近似比复合辛普森法则更精确。网格间距为 $h = (1-0)/8 = 1/8$，节点为 $x_j = j/8$，其中 $j \\in \\{0, 1, \\dots, 8\\}$。\n\n我们需要证明 $|I - T|  |I - S|$。一个关键的思路是选择一个函数，其行为能被分段线性插值很好地捕捉，但却会让分段二次插值产生较大偏差。一个高频振荡的函数是理想的候选者。\n\n我们提出函数 $f(x) = \\cos(8\\pi x)$。该函数在 $[0,1]$ 上是无限次可微的（$C^\\infty$）。\n\n首先，我们在指定节点 $x_j = j/8$ 处计算函数值：\n$$f(x_j) = f\\left(\\frac{j}{8}\\right) = \\cos\\left(8\\pi \\frac{j}{8}\\right) = \\cos(j\\pi) = (-1)^j$$\n函数值的序列 $\\{f_j\\}_{j=0}^8$ 是：\n$$f_0=1, f_1=-1, f_2=1, f_3=-1, f_4=1, f_5=-1, f_6=1, f_7=-1, f_8=1$$\n\n接下来，我们计算积分的精确值 $I$：\n$$I = \\int_{0}^{1} \\cos(8\\pi x) \\,dx = \\left[ \\frac{\\sin(8\\pi x)}{8\\pi} \\right]_{0}^{1} = \\frac{\\sin(8\\pi) - \\sin(0)}{8\\pi} = \\frac{0-0}{8\\pi} = 0$$\n\n现在，我们使用复合梯形法则计算近似值 $T$。该法则定义为：\n$$T = \\frac{h}{2} \\left( f_0 + 2\\sum_{j=1}^{N-1} f_j + f_N \\right)$$\n当 $N=8$, $h=1/8$ 时，使用我们的节点值：\n$$T = \\frac{1/8}{2} \\left( f_0 + 2(f_1 + f_2 + f_3 + f_4 + f_5 + f_6 + f_7) + f_8 \\right)$$\n$$T = \\frac{1}{16} \\left( 1 + 2(-1 + 1 - 1 + 1 - 1 + 1 - 1) + 1 \\right)$$\n$$T = \\frac{1}{16} \\left( 1 + 2(-1) + 1 \\right) = \\frac{1}{16} (1 - 2 + 1) = 0$$\n因此，梯形法则的近似值为 $T=0$。\n\n接下来，我们使用复合辛普森法则计算近似值 $S$。对于 $N=8$ 个子区间，该法则为：\n$$S = \\frac{h}{3} \\left( f_0 + 4f_1 + 2f_2 + 4f_3 + 2f_4 + 4f_5 + 2f_6 + 4f_7 + f_8 \\right)$$\n使用我们的节点值：\n$$S = \\frac{1/8}{3} \\left( 1 + 4(-1) + 2(1) + 4(-1) + 2(1) + 4(-1) + 2(1) + 4(-1) + 1 \\right)$$\n$$S = \\frac{1}{24} \\left( 1 - 4 + 2 - 4 + 2 - 4 + 2 - 4 + 1 \\right)$$\n$$S = \\frac{1}{24} \\left( (1+2+2+2+1) + (-4-4-4-4) \\right) = \\frac{1}{24} (8 - 16) = \\frac{-8}{24} = -\\frac{1}{3}$$\n因此，辛普森法则的近似值为 $S = -\\frac{1}{3}$。\n\n最后，我们比较绝对误差。\n梯形法则的绝对误差是：\n$$|E_T| = |I - T| = |0 - 0| = 0$$\n辛普森法则的绝对误差是：\n$$|E_S| = |I - S| = \\left|0 - \\left(-\\frac{1}{3}\\right)\\right| = \\frac{1}{3}$$\n比较这两个绝对误差，我们发现：\n$$0  \\frac{1}{3}$$\n因此，$|E_T|  |E_S|$。\n\n函数 $f(x)=\\cos(8\\pi x)$ 是连续可微的，并且对于给定的节点，复合梯形法则的结果是完全精确的，而复合辛普森法则产生了一个显著的误差。这证明了在这种特定情况下，梯形法则比辛普森法则更精确，满足了问题的所有条件。出现这种情况是因为函数的频率恰好是网格的奈奎斯特频率的两倍。梯形法则是精确的，因为在每个子区间上的误差项 $\\int_{x_j}^{x_{j+1}} (f(x) - L_j(x))dx$ 由于余弦函数在每个子区间内的对称性而恰好为零。然而，辛普森法则的三点二次插值被函数在采样区间内的振荡行为严重误导，从而导致了很大的误差。", "answer": "$$\\boxed{\\cos(8\\pi x)}$$", "id": "3284359"}]}