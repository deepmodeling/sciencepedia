{"hands_on_practices": [{"introduction": "这个练习是机器学习和数据科学领域的一个基石问题。我们将运用基本的Karush-Kuhn-Tucker（KKT）条件，为一个向量在概率单纯形上的投影问题，推导出一个出人意料地优雅且高效的解。这项实践不仅具体地应用了KKT理论，还展示了它如何揭示最优解的显式结构，这对于理解和解决现实世界中的优化问题至关重要。[@problem_id:3217521]", "problem": "考虑将一个向量 $v \\in \\mathbb{R}^{n}$ 欧几里得投影到概率单纯形上，该单纯形定义为集合 $\\Delta^{n} = \\{ x \\in \\mathbb{R}^{n} : x_{i} \\ge 0 \\text{ for all } i, \\ \\sum_{i=1}^{n} x_{i} = 1 \\}$。该投影是以下优化问题的解\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\ \\frac{1}{2} \\| x - v \\|^{2} \\quad \\text{subject to} \\quad x_{i} \\ge 0 \\ \\text{for all } i, \\ \\sum_{i=1}^{n} x_{i} = 1.\n$$\n从凸优化的基本原理出发，使用 Karush-Kuhn-Tucker (KKT) 条件推导此问题的充要最优性条件。具体而言，为等式约束引入一个拉格朗日乘子，为非负性约束引入适当的乘子，然后利用互补松弛性消去不等式乘子，从而获得关于 $v$ 和一个标量阈值的最优解的显式结构形式。\n\n然后，将您的推导应用于 $n = 6$ 的具体情况，其中\n$$\nv = \\begin{pmatrix} 1.2 \\\\ 0.9 \\\\ 0.7 \\\\ 0.4 \\\\ 0.05 \\\\ -0.2 \\end{pmatrix}.\n$$\n计算在您的显式形式中强制执行单纯形约束的等式约束乘子（即标量阈值）的值。请提供精确值。您的最终答案必须是一个实数。", "solution": "我们从凸优化的基本原理开始。目标函数 $f(x) = \\frac{1}{2} \\| x - v \\|^{2}$ 是严格凸的，因为其 Hessian 矩阵是单位矩阵，而单位矩阵是正定的。约束 $x_{i} \\ge 0$ (对所有 $i$) 和 $\\sum_{i=1}^{n} x_{i} = 1$ 是仿射的，因此也是凸的。所以，该问题是一个具有严格凸目标和仿射约束的凸优化问题，Karush–Kuhn–Tucker (KKT) 条件是最优性的充要条件。\n\n为等式约束引入单个乘子 $\\nu \\in \\mathbb{R}$，为非负性约束引入乘子 $\\lambda_{i} \\ge 0$，构造拉格朗日函数：\n$$\n\\mathcal{L}(x,\\nu,\\lambda) = \\frac{1}{2} \\sum_{i=1}^{n} (x_{i} - v_{i})^{2} + \\nu \\left( \\sum_{i=1}^{n} x_{i} - 1 \\right) - \\sum_{i=1}^{n} \\lambda_{i} x_{i}.\n$$\nKKT 条件如下：\n- 原始可行性：$x_{i} \\ge 0$ (对所有 $i$)，以及 $\\sum_{i=1}^{n} x_{i} = 1$。\n- 对偶可行性：$\\lambda_{i} \\ge 0$ (对所有 $i$)。\n- 互补松弛性：$\\lambda_{i} x_{i} = 0$ (对所有 $i$)。\n- 平稳性：$\\nabla_{x} \\mathcal{L} = 0$，其分量形式为\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial x_{i}} = x_{i} - v_{i} + \\nu - \\lambda_{i} = 0 \\quad \\Longrightarrow \\quad x_{i} = v_{i} - \\nu + \\lambda_{i}.\n$$\n\n利用互补松弛性来消去 $\\lambda_{i}$。对于每个索引 $i$ 有两种情况：\n- 如果 $x_{i} > 0$，那么根据互补松弛性，$\\lambda_{i} = 0$，因此 $x_{i} = v_{i} - \\nu$，从而 $v_{i} > \\nu$。\n- 如果 $x_{i} = 0$，那么根据平稳性条件，$\\lambda_{i} = \\nu - v_{i}$，而对偶可行性意味着 $\\nu - v_{i} \\ge 0$，因此 $v_{i} \\le \\nu$。\n\n综合这些情况，最优解具有显式形式\n$$\nx_{i}^{\\star} = \\max(v_{i} - \\nu, 0).\n$$\n令 $\\tau := \\nu$ 表示标量阈值。强制执行等式约束 $\\sum_{i=1}^{n} x_{i}^{\\star} = 1$ 会得到以下标量方程\n$$\n\\sum_{i=1}^{n} \\max(v_{i} - \\tau, 0) = 1.\n$$\n等价地，如果 $A = \\{ i : v_{i} > \\tau \\}$ 是 $x_{i}^{\\star} > 0$ 的索引的活动集，则\n$$\n\\sum_{i \\in A} (v_{i} - \\tau) = 1 \\quad \\Longrightarrow \\quad \\tau = \\frac{\\sum_{i \\in A} v_{i} - 1}{|A|},\n$$\n并满足一致性条件 $v_{i} > \\tau$ (对于 $i \\in A$) 和 $v_{j} \\le \\tau$ (对于 $j \\notin A$)。\n\n我们现在将此应用于给定的实例，其中 $n = 6$ 且\n$$\nv = \\begin{pmatrix} 1.2 \\\\ 0.9 \\\\ 0.7 \\\\ 0.4 \\\\ 0.05 \\\\ -0.2 \\end{pmatrix}.\n$$\n将 $v$ 的分量按非递增顺序排序，以测试可能的活动集大小 $k \\in \\{1,2,\\dots,6\\}$：\n$$\nv_{(1)} = 1.2, \\quad v_{(2)} = 0.9, \\quad v_{(3)} = 0.7, \\quad v_{(4)} = 0.4, \\quad v_{(5)} = 0.05, \\quad v_{(6)} = -0.2.\n$$\n对于每个 $k$，定义\n$$\n\\tau_{k} = \\frac{\\sum_{i=1}^{k} v_{(i)} - 1}{k},\n$$\n并检查一致性条件 $v_{(k)} > \\tau_{k} \\ge v_{(k+1)}$ (约定 $v_{(7)} = -\\infty$ )。\n\n计算候选值：\n- 对于 $k = 1$：$\\tau_{1} = \\frac{1.2 - 1}{1} = 0.2$。检查 $v_{(1)} > \\tau_{1}$ 即 $1.2 > 0.2$ (成立)，但 $\\tau_{1} \\ge v_{(2)}$ 要求 $0.2 \\ge 0.9$ (不成立)。所以 $k = 1$ 无效。\n- 对于 $k = 2$：$\\tau_{2} = \\frac{1.2 + 0.9 - 1}{2} = \\frac{1.1}{2} = 0.55$。检查 $v_{(2)} > \\tau_{2}$ 即 $0.9 > 0.55$ (成立)，但 $\\tau_{2} \\ge v_{(3)}$ 要求 $0.55 \\ge 0.7$ (不成立)。所以 $k = 2$ 无效。\n- 对于 $k = 3$：$\\tau_{3} = \\frac{1.2 + 0.9 + 0.7 - 1}{3} = \\frac{2.8 - 1}{3} = \\frac{1.8}{3} = 0.6$。检查 $v_{(3)} > \\tau_{3}$ 即 $0.7 > 0.6$ (成立)，且 $\\tau_{3} \\ge v_{(4)}$ 即 $0.6 \\ge 0.4$ (成立)。因此 $k = 3$ 是一致的。\n\n因此，等式约束乘子 (阈值) 为 $\\tau = \\tau_{3} = 0.6$。这唯一地确定了投影 $x_{i}^{\\star} = \\max(v_{i} - 0.6, 0)$，并且正数部分的总和确实为 1：\n$$\n(1.2 - 0.6) + (0.9 - 0.6) + (0.7 - 0.6) = 0.6 + 0.3 + 0.1 = 1.\n$$\n因此，所需的标量阈值恰好是 $0.6$。", "answer": "$$\\boxed{0.6}$$", "id": "3217521"}, {"introduction": "虽然KKT条件描述了最优性，但大多数复杂问题需要迭代算法来找到解。这个练习让你一窥二次规划中经典的有效集法的内部工作机制。通过在一个非最优点计算拉格朗日乘子，你将精确地看到算法如何决定“释放”一个约束以取得进展，从而阐明最优性条件与算法步骤之间的动态相互作用。[@problem_id:3217327]", "problem": "考虑凸二次规划问题\n在 $x \\in \\mathbb{R}^2$ 上最小化：$f(x) = \\dfrac{1}{2} x^\\top x$\n满足三个线性不等式约束：\n$1)$ $x_1 \\ge 0$，\n$2)$ $x_2 \\ge 0$，\n$3)$ $x_1 + x_2 \\ge 1$。\n假设采用二次规划的积极集方法。初始可行点为 $x^{(0)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$。初始工作集选择为 $\\mathcal{W}^{(0)} = \\{1, 3\\}$，即约束 $x_1 \\ge 0$ 和 $x_1 + x_2 \\ge 1$ 在 $x^{(0)}$ 处被视为等式。\n\n仅使用凸二次规划的基本定义和 Karush–Kuhn–Tucker (KKT) 条件，确定从 $x^{(0)}$ 和 $\\mathcal{W}^{(0)}$ 开始的经典可行积极集迭代的正确下一步操作。特别地，判断是否必须从工作集中删除一个约束以严格改进目标函数，如果是，是哪一个。\n\n选择唯一一个选项：\n\nA. 在 $x^{(0)}$ 处宣布最优，因为与工作集 $\\mathcal{W}^{(0)}$ 中的积极约束相关的所有拉格朗日乘子都是非负的；不应删除任何约束。\n\nB. 删除约束 1（即约束 $x_1 \\ge 0$），然后计算保持 $x_1 + x_2 = 1$ 的等式约束搜索方向，并沿该方向移动以严格减小 $f(x)$，达到 $x = \\begin{bmatrix} \\tfrac{1}{2} \\\\ \\tfrac{1}{2} \\end{bmatrix}$。\n\nC. 删除约束 3（即约束 $x_1 + x_2 \\ge 1$），然后计算保持 $x_1 = 0$ 的等式约束搜索方向，并沿该方向移动以严格减小 $f(x)$。\n\nD. 将两个约束都保留在工作集中，并沿着积极约束的一维零空间进行非零下降步，以在不修改工作集的情况下严格减小 $f(x)$。", "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n问题陈述提供了以下信息：\n- **目标函数**：在 $x \\in \\mathbb{R}^2$ 上最小化 $f(x) = \\dfrac{1}{2} x^\\top x$。\n- **约束条件**：\n    1. $x_1 \\ge 0$\n    2. $x_2 \\ge 0$\n    3. $x_1 + x_2 \\ge 1$\n- **方法**：二次规划的积极集方法。\n- **初始可行点**：$x^{(0)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$。\n- **初始工作集**：$\\mathcal{W}^{(0)} = \\{1, 3\\}$，对应于将约束 $x_1 \\ge 0$ 和 $x_1 + x_2 \\ge 1$ 视为等式。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是一个标准的凸二次规划 (QP) 问题。\n- **科学依据**：该问题在数学上是良定义的。目标函数 $f(x) = \\frac{1}{2} x^\\top x$ 的海森矩阵 $H = I$（单位矩阵）是正定的。这使得目标函数是严格凸的。约束是线性的，定义了一个凸可行域。因此，这是一个凸优化问题，保证了局部最小值也是全局最小值。积极集方法是解决此类问题的经典标准算法。该问题在数学优化理论中有坚实的基础。\n- **良态性**：可行域非空（例如，$x^{(0)}$ 是一个可行点）且闭合。目标函数是严格凸的，并且当 $\\|x\\| \\to \\infty$ 时无界增长。因此，存在唯一解。\n- **客观性**：问题使用精确的数学语言陈述，没有歧义或主观元素。\n\n初始点 $x^{(0)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$ 是可行的：\n- $x_1^{(0)} = 0 \\ge 0$\n- $x_2^{(0)} = 1 \\ge 0$\n- $x_1^{(0)} + x_2^{(0)} = 0 + 1 = 1 \\ge 1$\n在 $x^{(0)}$ 处积极的约束是 $x_1=0$（约束 1）和 $x_1+x_2=1$（约束 3）。指定的初始工作集 $\\mathcal{W}^{(0)} = \\{1, 3\\}$ 与初始点一致。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。这是一个在数值优化领域中良态、自洽且科学合理的问题。我们可以继续进行求解。\n\n## 解题推导\n\n问题要求在一次经典的可行积极集迭代中的下一步操作。当前迭代点为 $x^{(0)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$，工作集为 $\\mathcal{W}^{(0)} = \\{1, 3\\}$。工作集中的约束被视为等式：\n$x_1 = 0$\n$x_1 + x_2 = 1$\n点 $x^{(0)}$ 是该方程组的唯一解。在积极集方法中，当迭代点满足工作集的等式约束，并且不存在保持这些等式的可行下降方向时（即，积极约束矩阵的零空间是平凡的），我们必须检查拉格朗日乘子的符号，以确定我们是否处于最优点，或者是否应删除一个约束。\n\n由工作集定义的等式约束子问题的 Karush-Kuhn-Tucker (KKT) 系统的平稳性条件指出，目标函数的梯度必须是积极约束梯度的线性组合。让我们将约束写成 $c_i(x) \\ge 0$ 的形式：\n$c_1(x) = x_1 \\ge 0$\n$c_2(x) = x_2 \\ge 0$\n$c_3(x) = x_1 + x_2 - 1 \\ge 0$\n\n目标函数的梯度为 $\\nabla f(x) = x$。\n约束的梯度为：\n$\\nabla c_1(x) = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$\n$\\nabla c_2(x) = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$\n$\\nabla c_3(x) = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$\n\n在点 $x^{(0)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$ 处，平稳性条件为 $\\nabla f(x^{(0)}) = \\sum_{i \\in \\mathcal{W}^{(0)}} \\lambda_i \\nabla c_i(x^{(0)})$，其中 $\\lambda_i$ 是拉格朗日乘子。对于我们的工作集 $\\mathcal{W}^{(0)} = \\{1, 3\\}$，这变为：\n$$\n\\nabla f(x^{(0)}) = \\lambda_1 \\nabla c_1(x^{(0)}) + \\lambda_3 \\nabla c_3(x^{(0)})\n$$\n代入数值：\n$$\n\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\lambda_1 \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} + \\lambda_3 \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\n这个向量方程等价于以下关于 $\\lambda_1$ 和 $\\lambda_3$ 的两个线性方程组：\n1. $0 = \\lambda_1 + \\lambda_3$\n2. $1 = (0)\\lambda_1 + \\lambda_3$\n\n从方程(2)中，我们立即得到 $\\lambda_3 = 1$。\n将此代入方程(1)，我们得到 $0 = \\lambda_1 + 1$，解得 $\\lambda_1 = -1$。\n\n计算出的积极约束的拉格朗日乘子为 $\\lambda_1 = -1$ 和 $\\lambda_3 = 1$。原始不等式约束问题的最优性 KKT 条件要求所有拉格朗日乘子都为非负（对于所有积极约束 $i$，$\\lambda_i \\ge 0$）。由于 $\\lambda_1 = -1  0$，点 $x^{(0)}$ 不是最优解。\n\n积极集策略规定，如果一个或多个拉格朗日乘子为负，我们应该从工作集中删除相应的约束之一，以便获得一个能够改进目标函数的可行下降方向。通常，选择与最负的乘子相关联的约束。在这种情况下，$\\lambda_1 = -1$ 是唯一的负乘子，因此我们必须从工作集中删除约束 1 ($x_1 \\ge 0$)。\n\n新的工作集是 $\\mathcal{W}^{(1)} = \\{3\\}$。下一步是从 $x^{(0)}$ 计算一个搜索方向 $p$，该方向在保持在 $\\mathcal{W}^{(1)}$ 中单个积极约束所定义的超平面（即 $x_1 + x_2 = 1$）上的同时，最小化目标函数。\n\n目标是找到一个 $x = x^{(0)} + p$，它在满足 $x_1 + x_2 = 1$ 的条件下最小化 $f(x)$。这等价于在直线 $x_1 + x_2 = 1$ 上找到离原点最近的点。该子问题的解是原点到该直线上的正交投影。\n设 $x^*_{\\text{sub}}$ 为该子问题的解。这个新的等式约束问题的 KKT 条件是：\n$\\nabla f(x^*_{\\text{sub}}) = \\mu_3 \\nabla c_3(x^*_{\\text{sub}})$\n$\\begin{bmatrix} x_1^* \\\\ x_2^* \\end{bmatrix} = \\mu_3 \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$，这意味着 $x_1^* = x_2^* = \\mu_3$。\n该点还必须满足约束：$x_1^* + x_2^* = 1$。\n将 $x_1^* = x_2^*$ 代入约束得到 $2x_1^* = 1$，所以 $x_1^* = \\frac{1}{2}$。因此，$x_2^* = \\frac{1}{2}$。\n该子问题的最小化点是 $x^*_{\\text{sub}} = \\begin{bmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\end{bmatrix}$。\n\n搜索方向是 $p = x^*_{\\text{sub}} - x^{(0)} = \\begin{bmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{2} \\\\ -\\frac{1}{2} \\end{bmatrix}$。\n新的迭代点将是 $x^{(1)} = x^{(0)} + \\alpha p$。步长 $\\alpha$ 被选为 1（到子问题最小化点的步长）和不违反任何非积极约束的最大可行步长之间的较小者。\n非积极约束是 $c_1(x) = x_1 \\ge 0$ 和 $c_2(x) = x_2 \\ge 0$。\n我们需要 $x^{(0)} + \\alpha p \\ge 0$（对于这些特定约束）按分量成立。\n$x_1(\\alpha) = 0 + \\alpha(\\frac{1}{2}) \\ge 0 \\implies \\alpha \\ge 0$。\n$x_2(\\alpha) = 1 + \\alpha(-\\frac{1}{2}) \\ge 0 \\implies 1 \\ge \\frac{\\alpha}{2} \\implies \\alpha \\le 2$。\n最大可行步长是 $\\alpha_{\\text{max}} = 2$。\n到子问题最小化点的步长是 $\\alpha = 1$。\n因为 $1  2$，没有新的约束变为积极。我们取完整步长，$\\alpha=1$。\n新的点是 $x^{(1)} = x^{(0)} + 1 \\cdot p = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} + \\begin{bmatrix} \\frac{1}{2} \\\\ -\\frac{1}{2} \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\end{bmatrix}$。\n目标函数值从 $f(x^{(0)}) = \\frac{1}{2}(0^2+1^2) = \\frac{1}{2}$ 减小到 $f(x^{(1)}) = \\frac{1}{2}((\\frac{1}{2})^2+(\\frac{1}{2})^2) = \\frac{1}{2}(\\frac{1}{4}+\\frac{1}{4}) = \\frac{1}{4}$。\n\n## 逐项分析\n\n**A. 在 $x^{(0)}$ 处宣布最优，因为与工作集 $\\mathcal{W}^{(0)}$ 中的积极约束相关的所有拉格朗日乘子都是非负的；不应删除任何约束。**\n我们的计算表明，约束 1 的拉格朗日乘子是 $\\lambda_1 = -1$，为负数。因此，该选项的前提是错误的。点 $x^{(0)}$ 不是最优的。\n**结论：错误。**\n\n**B. 删除约束 1（即约束 $x_1 \\ge 0$），然后计算保持 $x_1 + x_2 = 1$ 的等式约束搜索方向，并沿该方向移动以严格减小 $f(x)$，达到 $x = \\begin{bmatrix} \\tfrac{1}{2} \\\\ \\tfrac{1}{2} \\end{bmatrix}$。**\n我们的分析表明，因为 $\\lambda_1 = -1  0$，必须删除约束 1。新的子问题涉及在剩余的积极约束 $x_1 + x_2 = 1$ 下最小化 $f(x)$。该子问题的解确实是 $x = \\begin{bmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\end{bmatrix}$。从 $x^{(0)}$ 移动到这个新点构成了一次积极集方法的迭代，包括一个搜索方向和一个步长为 $\\alpha=1$ 的完整步。该选项正确描述了这次迭代的整个操作序列。\n**结论：正确。**\n\n**C. 删除约束 3（即约束 $x_1 + x_2 \\ge 1$），然后计算保持 $x_1 = 0$ 的等式约束搜索方向，并沿该方向移动以严格减小 $f(x)$。**\n与约束 3 相关联的拉格朗日乘子是 $\\lambda_3 = 1$，为非负。标准的积极集方法不会删除具有非负乘子的约束。因此，此操作是错误的。\n**结论：错误。**\n\n**D. 将两个约束都保留在工作集中，并沿着积极约束的一维零空间进行非零下降步，以在不修改工作集的情况下严格减小 $f(x)$。**\n积极约束为 $x_1=0$ 和 $x_1+x_2=1$。积极约束梯度的矩阵是 $A = \\begin{bmatrix} \\nabla c_1^\\top \\\\ \\nabla c_3^\\top \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 1  1 \\end{bmatrix}$。在 $\\mathbb{R}^2$ 中，这两个梯度是线性无关的。$A$ 的零空间包含满足 $Ap=0$ 的向量 $p$。由于 $A$ 是可逆的，唯一的解是 $p=0$。零空间是零维的（只包含零向量）。因此，在保持两个约束都积极的情况下，无法采取非零下降步。\n**结论：错误。**", "answer": "$$\\boxed{B}$$", "id": "3217327"}, {"introduction": "选择正确的算法与理解理论本身同等重要。本练习对比了处理等式约束的两种主要方法：直观的二次罚函数法和更精巧的增广拉格朗日法。通过一个简单但富有启发性的例子，你将发现困扰罚函数法的关键数值病态问题，并看到增广拉格朗日法如何巧妙地避免这一陷阱，从而确保稳健而高效的收敛。[@problem_id:3217528]", "problem": "考虑一个等式约束优化问题，即在一个线性约束下最小化一个二次函数：\n最小化 $f(x) = \\tfrac{1}{2} x_1^2 + \\tfrac{1}{2} x_2^2$，约束条件为 $c(x) = x_1 - 1 = 0$，其中 $x = (x_1, x_2) \\in \\mathbb{R}^2$。您将研究两种经典方法：标准的二次罚函数法和增广拉格朗日方法。\n\n根据第一性原理，约束下的极小值点 $(x^\\star, \\lambda^\\star)$ 满足 Karush-Kuhn-Tucker (KKT) 条件，对于等式约束，这些条件是平稳性条件和可行性条件：\n$\\nabla f(x^\\star) + \\lambda^\\star \\nabla c(x^\\star) = 0$ 和 $c(x^\\star) = 0$，\n其中 $\\lambda^\\star$ 是拉格朗日乘子。\n\n二次罚函数法求解一系列无约束问题，形式为\n$\\min_x \\, \\phi_\\rho(x) = f(x) + \\tfrac{\\rho}{2} \\, c(x)^2$，其中罚参数 $\\rho  0$。\n增广拉格朗日方法求解形式为\n$\\min_x \\, \\mathcal{L}_\\rho(x, \\lambda) = f(x) + \\lambda \\, c(x) + \\tfrac{\\rho}{2} \\, c(x)^2$ 的子问题，其中 $\\rho  0$ 是一个固定的适中值，同时通过 $\\lambda_{k+1} = \\lambda_k + \\rho \\, c(x_k)$ 更新乘子。\n\n假设您希望约束违反量 $|c(x)| = |x_1 - 1|$ 至多为容差 $t = 10^{-8}$。对于罚函数法，令 $x_\\rho$ 表示 $\\phi_\\rho$ 的精确极小值点。对于增广拉格朗日方法，考虑一个固定的 $\\rho = 10$ 和在每次迭代中使用乘子更新 $\\lambda_{k+1} = \\lambda_k + \\rho \\, c(x(\\lambda_k))$ 时 $\\mathcal{L}_\\rho(\\cdot, \\lambda)$ 的精确极小值点 $x(\\lambda)$。\n\n下列哪个陈述是正确的？\n\nA. 在罚函数法中，要实现 $|x_{1,\\rho} - 1| \\le t$，需要 $\\rho \\ge 10^8$，这使得 $\\phi_\\rho$ 的 Hessian 矩阵等于 $\\nabla^2 \\phi_\\rho(x) = \\begin{pmatrix} 1 + \\rho  0 \\\\ 0  1 \\end{pmatrix}$，并产生一个条件数 $\\kappa(\\nabla^2 \\phi_\\rho) \\approx 10^8$，导致病态问题；相比之下，使用 $\\rho = 10$ 的增广拉格朗日方法的子问题 Hessian 矩阵为 $\\nabla^2_x \\mathcal{L}_\\rho = \\begin{pmatrix} 1 + \\rho  0 \\\\ 0  1 \\end{pmatrix}$，条件数 $\\kappa \\approx 11$，并且乘子更新使误差以 $1/(1+\\rho) = 1/11$ 的因子在每次迭代中收缩，因此它能稳健地收敛。\n\nB. 罚函数法和增广拉格朗日方法都需要令 $\\rho \\to \\infty$ 来使 $|x_1 - 1| \\to 0$，因此两个 Hessian 矩阵都必然会变得严重病态。\n\nC. 二次罚函数法产生的 Hessian 矩阵与 $\\rho$ 无关，因此不会出现病态问题；而增广拉格朗日方法的 Hessian 矩阵随着 $\\rho$ 的增长而变得病态，使其稳健性较差。\n\nD. 增广拉格朗日方法无法处理线性等式约束；在这种情况下只有罚函数法适用。\n\n选择正确的选项。", "solution": "用户提供了一个约束优化问题，要求对二次罚函数法和增广拉格朗日方法进行比较分析。\n\n### 第一步：问题验证\n\n对问题陈述进行有效性分析。\n\n-   **提取的已知条件**：\n    -   目标函数：$f(x) = \\tfrac{1}{2} x_1^2 + \\tfrac{1}{2} x_2^2$\n    -   约束函数：$c(x) = x_1 - 1 = 0$\n    -   定义域：$x = (x_1, x_2) \\in \\mathbb{R}^2$\n    -   KKT 条件：$\\nabla f(x^\\star) + \\lambda^\\star \\nabla c(x^\\star) = 0$ 和 $c(x^\\star) = 0$\n    -   二次罚函数：$\\phi_\\rho(x) = f(x) + \\tfrac{\\rho}{2} \\, c(x)^2$\n    -   增广拉格朗日函数：$\\mathcal{L}_\\rho(x, \\lambda) = f(x) + \\lambda \\, c(x) + \\tfrac{\\rho}{2} \\, c(x)^2$\n    -   增广拉格朗日乘子更新：$\\lambda_{k+1} = \\lambda_k + \\rho \\, c(x_k)$\n    -   约束违反容差：$t = 10^{-8}$\n    -   增广拉格朗日罚参数：$\\rho = 10$\n\n-   **有效性评估**：\n    -   该问题具有**科学依据**且**客观**。它提出了一个数值优化领域的标准、典型问题，该领域是数值方法和科学计算的一个子学科。\n    -   方法（二次罚函数法、增广拉格朗日方法）和分析工具（KKT 条件）的定义是正确且标准的。\n    -   该问题是**适定的**且**自洽的**。目标函数是严格凸的，约束是线性的，这保证了唯一解的存在。所有必要的数据和定义都已提供。\n    -   该问题没有违反任何科学原理，不基于错误前提，也没有歧义。\n\n-   **结论**：问题陈述有效。可以继续分析。\n\n### 第二步：推导精确解\n\n首先，我们使用 Karush-Kuhn-Tucker (KKT) 条件找到约束问题的精确解 $(x^\\star, \\lambda^\\star)$。目标函数和约束函数的梯度为：\n$$\n\\nabla f(x) = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}, \\quad \\nabla c(x) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\nKKT 条件是：\n1.  **可行性**：$c(x^\\star) = x_1^\\star - 1 = 0 \\implies x_1^\\star = 1$。\n2.  **平稳性**：$\\nabla f(x^\\star) + \\lambda^\\star \\nabla c(x^\\star) = 0 \\implies \\begin{pmatrix} x_1^\\star \\\\ x_2^\\star \\end{pmatrix} + \\lambda^\\star \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n从平稳性条件，我们得到两个标量方程：\n$x_1^\\star + \\lambda^\\star = 0$\n$x_2^\\star = 0$\n\n使用可行性条件得到的 $x_1^\\star = 1$，我们发现 $\\lambda^\\star = -x_1^\\star = -1$。\n因此，唯一的极小值点是 $x^\\star = (1, 0)$，对应的拉格朗日乘子是 $\\lambda^\\star = -1$。\n\n### 第三步：二次罚函数法分析\n\n二次罚函数法涉及为 $\\min_x \\phi_\\rho(x)$ 求解一系列无约束问题，其中：\n$$\n\\phi_\\rho(x) = f(x) + \\frac{\\rho}{2} c(x)^2 = \\frac{1}{2} x_1^2 + \\frac{1}{2} x_2^2 + \\frac{\\rho}{2} (x_1 - 1)^2\n$$\n通过将 $\\phi_\\rho(x)$ 的梯度设为零来找到极小值点 $x_\\rho$：\n$$\n\\nabla \\phi_\\rho(x) = \\begin{pmatrix} x_1 + \\rho(x_1 - 1) \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} (1+\\rho)x_1 - \\rho \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n解这个方程组得到极小值点 $x_\\rho = (x_{1,\\rho}, x_{2,\\rho})$：\n$x_{1,\\rho} = \\frac{\\rho}{1+\\rho}$\n$x_{2,\\rho} = 0$\n\n此时的约束违反量为：\n$$\nc(x_\\rho) = x_{1,\\rho} - 1 = \\frac{\\rho}{1+\\rho} - 1 = \\frac{\\rho - (1+\\rho)}{1+\\rho} = -\\frac{1}{1+\\rho}\n$$\n为了满足容差要求 $|c(x_\\rho)| \\le t = 10^{-8}$：\n$$\n\\left| -\\frac{1}{1+\\rho} \\right| = \\frac{1}{1+\\rho} \\le 10^{-8} \\implies 1+\\rho \\ge 10^8 \\implies \\rho \\ge 10^8 - 1\n$$\n这证实了罚参数 $\\rho$ 必须非常大（约 $10^8$）才能达到高精度。\n\n现在，我们通过计算 $\\phi_\\rho(x)$ 的 Hessian 矩阵来分析子问题的条件数：\n$$\n\\nabla^2 \\phi_\\rho(x) = \\begin{pmatrix} 1+\\rho  0 \\\\ 0  1 \\end{pmatrix}\n$$\n该 Hessian 矩阵的特征值为 $\\mu_1 = 1+\\rho$ 和 $\\mu_2 = 1$。条件数是最大特征值与最小特征值的比值：\n$$\n\\kappa(\\nabla^2 \\phi_\\rho) = \\frac{\\mu_{\\text{max}}}{\\mu_{\\text{min}}} = \\frac{1+\\rho}{1} = 1+\\rho\n$$\n对于 $\\rho \\ge 10^8 - 1$，条件数 $\\kappa(\\nabla^2 \\phi_\\rho) \\ge 10^8$。这个极大的条件数表明，当 $\\rho \\to \\infty$ 时，无约束最小化子问题变得严重病态。\n\n### 第四步：增广拉格朗日方法分析\n\n增广拉格朗日方法针对一个固定的、适中的 $\\rho  0$ 求解形式为 $\\min_x \\mathcal{L}_\\rho(x, \\lambda)$ 的子问题，然后进行乘子更新。这里，$\\rho = 10$。\n$$\n\\mathcal{L}_\\rho(x, \\lambda) = f(x) + \\lambda c(x) + \\frac{\\rho}{2} c(x)^2 = \\frac{1}{2} x_1^2 + \\frac{1}{2} x_2^2 + \\lambda(x_1 - 1) + \\frac{\\rho}{2}(x_1 - 1)^2\n$$\n令 $x_k = x(\\lambda_k)$ 为 $\\mathcal{L}_\\rho(x, \\lambda_k)$ 的极小值点。我们通过将其关于 $x$ 的梯度设为零来找到它：\n$$\n\\nabla_x \\mathcal{L}_\\rho(x, \\lambda_k) = \\begin{pmatrix} x_1 + \\lambda_k + \\rho(x_1 - 1) \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} (1+\\rho)x_1 - \\rho + \\lambda_k \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n求解 $x_{1,k}$ 和 $x_{2,k}$：\n$x_{1,k} = \\frac{\\rho - \\lambda_k}{1+\\rho}$\n$x_{2,k} = 0$\n\n乘子更新规则是 $\\lambda_{k+1} = \\lambda_k + \\rho c(x_k)$。在 $x_k$ 处的约束值为：\n$$\nc(x_k) = x_{1,k} - 1 = \\frac{\\rho - \\lambda_k}{1+\\rho} - 1 = \\frac{\\rho - \\lambda_k - (1+\\rho)}{1+\\rho} = \\frac{-1 - \\lambda_k}{1+\\rho}\n$$\n将此代入更新规则：\n$$\n\\lambda_{k+1} = \\lambda_k + \\rho \\left( \\frac{-1 - \\lambda_k}{1+\\rho} \\right) = \\frac{(1+\\rho)\\lambda_k - \\rho(1+\\lambda_k)}{1+\\rho} = \\frac{\\lambda_k - \\rho}{1+\\rho}\n$$\n为分析收敛性，我们考察误差 $\\lambda_k - \\lambda^\\star = \\lambda_k - (-1) = \\lambda_k + 1$：\n$$\n\\lambda_{k+1} + 1 = \\frac{\\lambda_k - \\rho}{1+\\rho} + 1 = \\frac{\\lambda_k - \\rho + 1 + \\rho}{1+\\rho} = \\frac{\\lambda_k + 1}{1+\\rho}\n$$\n这表明拉格朗日乘子估计的误差 $(\\lambda_k - \\lambda^\\star)$ 在每次迭代中以因子 $\\frac{1}{1+\\rho}$ 减小。当 $\\rho=10$ 时，收缩因子为 $\\frac{1}{11}$。这证明了方法能线性收敛到真实乘子 $\\lambda^\\star = -1$，而无需 $\\rho \\to \\infty$。因此，约束违反量 $c(x_k) = -\\frac{1}{1+\\rho}(\\lambda_k+1)$ 也线性收敛到 $0$。\n\n现在，我们分析增广拉格朗日子问题的条件数。$\\mathcal{L}_\\rho(x, \\lambda)$ 关于 $x$ 的 Hessian 矩阵为：\n$$\n\\nabla^2_x \\mathcal{L}_\\rho(x, \\lambda) = \\begin{pmatrix} 1+\\rho  0 \\\\ 0  1 \\end{pmatrix}\n$$\n这与罚函数法的 Hessian 矩阵形式相同。然而，关键区别在于 $\\rho$ 是一个固定的、适中的常数。对于 $\\rho = 10$：\n$$\n\\nabla^2_x \\mathcal{L}_{10}(x, \\lambda) = \\begin{pmatrix} 11  0 \\\\ 0  1 \\end{pmatrix}\n$$\n特征值为 $\\mu_1 = 11$ 和 $\\mu_2 = 1$。条件数为：\n$$\n\\kappa(\\nabla^2_x \\mathcal{L}_{10}) = \\frac{11}{1} = 11\n$$\n这是一个小的、恒定的条件数，意味着子问题是良态的，并且可以稳健地求解。\n\n### 第五步：逐项分析\n\n-   **A. 在罚函数法中，要实现 $|x_{1,\\rho} - 1| \\le t$，需要 $\\rho \\ge 10^8$，这使得 $\\phi_\\rho$ 的 Hessian 矩阵等于 $\\nabla^2 \\phi_\\rho(x) = \\begin{pmatrix} 1 + \\rho  0 \\\\ 0  1 \\end{pmatrix}$，并产生一个条件数 $\\kappa(\\nabla^2 \\phi_\\rho) \\approx 10^8$，导致病态问题；相比之下，使用 $\\rho = 10$ 的增广拉格朗日方法的子问题 Hessian 矩阵为 $\\nabla^2_x \\mathcal{L}_\\rho = \\begin{pmatrix} 1 + \\rho  0 \\\\ 0  1 \\end{pmatrix}$，条件数 $\\kappa \\approx 11$，并且乘子更新使误差以 $1/(1+\\rho) = 1/11$ 的因子在每次迭代中收缩，因此它能稳健地收敛。**\n    -   这个陈述准确地总结了我们的分析结果。罚函数法需要 $\\rho \\approx 10^8$，导致条件数约为 $10^8$。增广拉格朗日方法使用固定的 $\\rho=10$，得到一个条件数为 $\\kappa=11$ 的良态 Hessian 矩阵，并通过乘子更新收敛，误差收缩因子为 $1/11$。\n    -   结论：**正确**。\n\n-   **B. 罚函数法和增广拉格朗日方法都需要令 $\\rho \\to \\infty$ 来使 $|x_1 - 1| \\to 0$，因此两个 Hessian 矩阵都必然会变得严重病态。**\n    -   这是不正确的。增广拉格朗日方法通过更新拉格朗日乘子估计，在固定的、有限的 $\\rho$ 值下实现收敛。它不需要 $\\rho \\to \\infty$。因此，其 Hessian 矩阵不一定会变得病态。\n    -   结论：**不正确**。\n\n-   **C. 二次罚函数法产生的 Hessian 矩阵与 $\\rho$ 无关，因此不会出现病态问题；而增广拉格朗日方法的 Hessian 矩阵随着 $\\rho$ 的增长而变得病态，使其稳健性较差。**\n    -   这是不正确的。罚函数法的 Hessian 矩阵 $\\nabla^2 \\phi_\\rho$ 直接依赖于 $\\rho$，并且当 $\\rho \\to \\infty$ 时会变得病态。虽然增广拉格朗日方法的 Hessian 矩阵也依赖于 $\\rho$，但该方法的设计使得 $\\rho$ 不需要增长。该陈述颠倒了两种方法的属性。\n    -   结论：**不正确**。\n\n-   **D. 增广拉格朗日方法无法处理线性等式约束；在这种情况下只有罚函数法适用。**\n    -   这在事实上是错误的。增广拉格朗日方法专门为等式约束问题设计，并且对它们非常有效，包括线性约束，正如我们的分析所证明的。\n    -   结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "3217528"}]}