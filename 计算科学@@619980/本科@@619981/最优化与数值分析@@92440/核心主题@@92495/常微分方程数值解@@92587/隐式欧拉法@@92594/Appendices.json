{"hands_on_practices": [{"introduction": "理解一个数值方法的最佳途径莫过于亲手实践。我们的第一个练习将从一个线性常微分方程开始，这是应用隐式欧拉法最直接的情形。通过这个练习 [@problem_id:2178316]，你将实践如何重排隐式方程，从而显式地解出下一个时间步的值，这是掌握并应用该方法的基础核心技能。", "problem": "一个中央处理器（CPU）在可变负载下的简化热模型由以下一阶常微分方程描述：\n$$ \\frac{dT}{dt} = -k(T - T_a) + P(t) $$\n其中 $T(t)$ 是 CPU 在时间 $t$（单位为分钟）时的温度，单位为摄氏度 ($^\\circ\\text{C}$)，$k$ 是散热常数，$T_a$ 是恒定的环境温度，$P(t)$ 代表 CPU 活动产生的热量。\n\n假设参数如下：\n- 散热常数，$k = 0.5 \\text{ min}^{-1}$\n- 环境温度，$T_a = 25^\\circ\\text{C}$\n- 生热函数，$P(t) = P_0 \\cos(\\omega t)$，其中 $P_0 = 10^\\circ\\text{C}/\\text{min}$ 且 $\\omega = \\frac{\\pi}{6} \\text{ rad/min}$。\n- CPU 的初始温度为 $T(0) = 85^\\circ\\text{C}$。\n\n为预测温度的演变，采用了一种数值方法。下一个时间步 $t_{n+1}$ 的温度 $T_{n+1}$ 是根据当前时间步 $t_n$ 的温度 $T_n$ 使用以下更新规则来估计的：\n$$ T_{n+1} = T_n + h \\left( \\frac{dT}{dt} \\right)_{t=t_{n+1}, T=T_{n+1}} $$\n其中 $h = t_{n+1} - t_n$ 是时间步长。\n\n使用该数值方法，取步长 $h = 0.5$ 分钟进行单步计算，求出 CPU 在 $t = 0.5$ 分钟时的近似温度。\n\n答案以摄氏度表示，并四舍五入到四位有效数字。", "solution": "给定一阶常微分方程\n$$\n\\frac{dT}{dt}=-k\\left(T-T_{a}\\right)+P(t), \\quad P(t)=P_{0}\\cos(\\omega t),\n$$\n我们要应用步长为 $h$ 的隐式（后向）欧拉法，从 $t_{0}=0$ 到 $t_{1}=h$ 进行一步计算。后向欧拉更新式为\n$$\nT_{1}=T_{0}+h\\left.\\frac{dT}{dt}\\right|_{t=t_{1},\\,T=T_{1}}=T_{0}+h\\big(-k(T_{1}-T_{a})+P_{0}\\cos(\\omega t_{1})\\big).\n$$\n解这个关于 $T_{1}$ 的方程。展开右侧并合并含 $T_1$ 的项：\n$$\nT_{1}=T_{0}-hkT_{1}+hkT_{a}+hP_{0}\\cos(\\omega t_{1}).\n$$\n将含 $T_{1}$ 的项移到左侧：\n$$\nT_{1}+hkT_{1}=T_{0}+hkT_{a}+hP_{0}\\cos(\\omega t_{1}).\n$$\n对左侧进行因式分解并求解 $T_{1}$：\n$$\nT_{1}=\\frac{T_{0}+hkT_{a}+hP_{0}\\cos(\\omega t_{1})}{1+hk}.\n$$\n现在代入给定数据 $T_{0}=85$, $k=0.5$, $T_{a}=25$, $P_{0}=10$, $\\omega=\\frac{\\pi}{6}$, $h=0.5$ 和 $t_{1}=0.5$：\n$$\n1+hk=1+0.5\\times 0.5=1.25,\n$$\n$$\nhkT_{a}=0.5\\times 0.5\\times 25=6.25,\n$$\n$$\nhP_{0}\\cos(\\omega t_{1})=0.5\\times 10\\times \\cos\\!\\left(\\frac{\\pi}{6}\\times 0.5\\right)=5\\cos\\!\\left(\\frac{\\pi}{12}\\right).\n$$\n因此\n$$\nT_{1}=\\frac{85+6.25+5\\cos\\!\\left(\\frac{\\pi}{12}\\right)}{1.25}.\n$$\n使用 $\\cos\\!\\left(\\frac{\\pi}{12}\\right)\\approx 0.9659258263$, 我们得到\n$$\nT_{1}\\approx \\frac{85+6.25+4.829629131}{1.25}=\\frac{96.079629131}{1.25}\\approx 76.86370331.\n$$\n四舍五入到四位有效数字，在 $t=0.5$ 分钟时的近似温度是 $76.86$ 摄氏度。", "answer": "$$\\boxed{76.86}$$", "id": "2178316"}, {"introduction": "在掌握了线性问题之后，我们进而探讨在科学与工程领域中更为常见的非线性方程。这个练习 [@problem_id:2178299] 引入了一个非线性常微分方程，求解下一步的浓度值需要解一个二次方程。这清晰地表明，随着模型复杂度的增加，每个时间步所面临的代数求解挑战也随之提升。", "problem": "在化学反应器中，一种反应物 $C(t)$ 在二阶分解反应中的浓度由以下微分方程描述：\n$$\n\\frac{dC}{dt} = - \\alpha C(t)^{2}\n$$\n其中，$t$ 是时间，$\\alpha$ 是一个正的反应速率常数。\n\n为对解进行数值近似，一位工程师采用了一种格式，其中下一时间步的浓度 $C_{n+1}$ 是根据在*下一*时间步评估的变化率从当前时间步的浓度 $C_n$ 确定的。更新规则如下：\n$$\nC_{n+1} = C_n + h \\left( \\frac{dC}{dt} \\right)\\bigg|_{t=t_{n+1}}\n$$\n其中 $h = t_{n+1} - t_n$ 是恒定的时间步长，而 $C_n$ 是 $C(t_n)$ 的近似值。\n\n假设 $C_n$、$\\alpha$ 和 $h$ 均为正量，推导 $C_{n+1}$ 仅用 $C_n$、$\\alpha$ 和 $h$ 表示的显式闭式表达式。", "solution": "我们已知自治常微分方程 $\\,\\frac{dC}{dt}=-\\alpha C^{2}\\,$（其中 $\\alpha>0$），以及在下一时间层级计算变化率的单步格式：\n$$\nC_{n+1}=C_{n}+h\\left(\\frac{dC}{dt}\\right)\\bigg|_{t=t_{n+1}}.\n$$\n由于方程右侧仅取决于 $C$，我们将 $\\left.\\frac{dC}{dt}\\right|_{t=t_{n+1}}=-\\alpha C_{n+1}^{2}$ 代入，得到隐式更新方程\n$$\nC_{n+1}=C_{n}-h\\,\\alpha\\,C_{n+1}^{2}.\n$$\n整理各项得到一个关于 $C_{n+1}$ 的二次方程：\n$$\nh\\,\\alpha\\,C_{n+1}^{2}+C_{n+1}-C_{n}=0.\n$$\n应用二次方程求根公式，其中 $a=h\\alpha$，$b=1$，$c=-C_{n}$，可得\n$$\nC_{n+1}=\\frac{-1\\pm\\sqrt{1-4(h\\alpha)(-C_{n})}}{2h\\alpha}\n=\\frac{-1\\pm\\sqrt{1+4\\alpha h C_{n}}}{2\\alpha h}.\n$$\n由于 $C_{n}>0$，$\\alpha>0$ 且 $h>0$，判别式 $1+4\\alpha h C_{n}>0$。分子中取负号的根为负值，而平方根前取正号的根为正值。为保持 $C_{n+1}>0$，我们选择以下根\n$$\nC_{n+1}=\\frac{-1+\\sqrt{1+4\\alpha h C_{n}}}{2\\alpha h}.\n$$\n这就是 $C_{n+1}$ 用 $C_{n}$、$\\alpha$ 和 $h$ 表示的显式闭式表达式。", "answer": "$$\\boxed{\\frac{-1+\\sqrt{1+4\\alpha h C_{n}}}{2\\alpha h}}$$", "id": "2178299"}, {"introduction": "对于更复杂的非线性问题，我们往往需要依赖牛顿法等迭代求根算法来求解隐式步方程。然而，这些求解器本身也有其成功应用的条件。最后一个练习 [@problem_id:2178312] 旨在探讨一个特殊情况：牛顿法因雅可比矩阵奇异而失效。这不仅揭示了隐式欧拉法在实际应用中可能遇到的挑战，也让我们对数值方法实现的深层细节有了更进一步的理解。", "problem": "考虑一个单标量函数 $y(t)$ 的初值问题 (IVP) 的数值解：\n$$\ny'(t) = \\sqrt{y(t)}, \\quad y(0) = 0\n$$\n我们希望使用单步隐式欧拉法来近似在时间 $t=h$ 处的解。隐式欧拉法的一般公式为 $y_{n+1} = y_n + h f(y_{n+1})$，其中 $h$ 是步长。对于第一步，这将产生一个关于未知值 $y_1 \\approx y(h)$ 的非线性代数方程。\n\n求解此类非线性方程的一个标准方法是牛顿法。为求解形如 $g(x)=0$ 的方程，牛顿法使用一种迭代格式，需要计算函数 $g(x)$ 及其导数 $g'(x)$。在此一维情况下，$g'(x)$ 就是系统的雅可比矩阵。如果在任何迭代中雅可比矩阵变为奇异（即等于零），牛顿法将失效。\n\n确定 $y_1$ 的具体正值，使得用于隐式欧拉步的牛顿法求解器对应的雅可比矩阵变为奇异。将您的答案表示为以步长 $h$ 表示的符号表达式。", "solution": "我们将单步隐式欧拉法应用于初值问题 $y'(t)=\\sqrt{y(t)}$, $y(0)=0$。隐式欧拉法的更新公式为\n$$\ny_{1}=y_{0}+h f(y_{1})=0+h\\sqrt{y_{1}},\n$$\n这得到了非线性方程\n$$\ng(y_{1})=y_{1}-h\\sqrt{y_{1}}=0.\n$$\n求解 $g(y)=0$ 的牛顿法使用雅可比（即导数）$g'(y)$。我们计算\n$$\ng'(y)=\\frac{d}{dy}\\left(y-h\\sqrt{y}\\right)=1-\\frac{h}{2\\sqrt{y}},\n$$\n其定义域为 $y>0$。当 $g'(y)=0$ 时，雅可比矩阵变为奇异。因此我们求解\n$$\n1-\\frac{h}{2\\sqrt{y}}=0 \\quad \\Longrightarrow \\quad \\frac{h}{2\\sqrt{y}}=1 \\quad \\Longrightarrow \\quad 2\\sqrt{y}=h \\quad \\Longrightarrow \\quad \\sqrt{y}=\\frac{h}{2} \\quad \\Longrightarrow \\quad y=\\frac{h^{2}}{4}.\n$$\n因此，使得牛顿法的雅可比矩阵变为奇异的 $y_{1}$ 的具体正值为 $y_{1}=h^{2}/4$。", "answer": "$$\\boxed{\\frac{h^{2}}{4}}$$", "id": "2178312"}]}