{"hands_on_practices": [{"introduction": "隐式方法的核心特征是其更新公式将新状态 $y_{n+1}$ 定义为其自身的函数，这使得求解过程不再是简单的直接计算。本练习将带领你处理一个简单的线性常微分方程，通过代数变换，从隐式中点法的格式中显式地解出 $y_{n+1}$。这个过程是理解和实现所有隐式方法的第一步，它清晰地揭示了“求解代数方程”这一核心任务的本质。[@problem_id:2178584]", "problem": "在计算物理中，许多问题需要对常微分方程（ODEs）进行数值求解。考虑一个描述电子元件温度 $y(t)$ 随时间变化的简化模型。其温度的变化率由以下线性一阶常微分方程描述：\n$$ \\frac{dy}{dt} = ay + b $$\n其中 $y_n$ 表示在时间 $t_n$ 的已知温度，$a$ 和 $b$ 是由该元件的物理特性及其环境决定的实常数。\n\n为了对解进行数值近似，我们可以使用一种隐式方法。隐式中点法则就是这样一种方法，它使用以下公式计算下一个时间步 $y_{n+1} = y(t_n + h)$ 的状态：\n$$ y_{n+1} = y_n + h f\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right) $$\n这里，$h$ 是恒定的时间步长，$f(t,y)$ 是定义该常微分方程的函数，即 $f(t,y) = \\frac{dy}{dt}$。\n\n将单步隐式中点法则应用于给定的常微分方程，推导出 $y_{n+1}$ 关于 $y_n$、$h$、$a$ 和 $b$ 的显式解析表达式。", "solution": "我们从常微分方程 $ \\frac{dy}{dt} = a y + b $ 开始，并应用隐式中点法则\n$$\ny_{n+1} = y_n + h f\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right).\n$$\n这里 $f(t,y) = a y + b$ 是自治的（不依赖于 $t$），因此\n$$\nf\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right) = a \\left(\\frac{y_n + y_{n+1}}{2}\\right) + b.\n$$\n代入更新公式得到\n$$\ny_{n+1} = y_n + h \\left[ a \\left(\\frac{y_n + y_{n+1}}{2}\\right) + b \\right].\n$$\n展开并合并关于 $y_{n+1}$ 的项，\n$$\ny_{n+1} = y_n + \\frac{a h}{2} y_n + \\frac{a h}{2} y_{n+1} + h b,\n$$\n可得\n$$\n\\left(1 - \\frac{a h}{2}\\right) y_{n+1} = \\left(1 + \\frac{a h}{2}\\right) y_n + h b.\n$$\n解出 $y_{n+1}$，得到如下的显式解析表达式\n$$\ny_{n+1} = \\frac{\\left(1 + \\frac{a h}{2}\\right) y_n + h b}{1 - \\frac{a h}{2}}.\n$$", "answer": "$$\\boxed{\\frac{\\left(1 + \\frac{a h}{2}\\right) y_n + h b}{1 - \\frac{a h}{2}}}$$", "id": "2178584"}, {"introduction": "我们之所以愿意面对求解隐式代数方程的复杂性，是因为隐式方法卓越的稳定性。本练习通过一个理想化的振荡系统 $y'(t) = i\\omega y(t)$ 来检验这一关键特性，该系统的精确解模长保持恒定。你将比较后向欧拉法和梯形法则这两种隐式格式，通过分析它们的放大因子，揭示它们在保持解的模长（一种能量的类似物）方面的根本差异，从而理解方法选择对于捕捉系统长期物理行为的重要性。[@problem_id:2178599]", "problem": "在常微分方程（ODEs）数值方法的稳定性分析中，一个用于振荡系统的关键测试问题是方程 $y'(t) = i\\omega y(t)$，其初始条件为 $y(0) = y_0$。这里，$y(t)$ 是一个复值函数，$i = \\sqrt{-1}$，$\\omega$ 是一个代表角频率的实正常数。该方程的精确解为 $y(t) = y_0 \\exp(i\\omega t)$，其模 $|y(t)|$ 对所有时间 $t$ 保持恒定。\n\n对于此类问题，一个理想的数值方法应该能保持这个模恒定的性质。考虑用常数时间步长 $h > 0$ 求解此常微分方程的两种隐式数值方法。\n\n方法 A（后向欧拉法）：该格式由关系式定义\n$$y_{n+1} = y_n + h (i\\omega y_{n+1})$$\n\n方法 B（梯形法则）：该格式由关系式定义\n$$y_{n+1} = y_n + \\frac{h}{2} (i\\omega y_n + i\\omega y_{n+1})$$\n\n令 $|y_n^{(A)}|$ 和 $|y_n^{(B)}|$ 分别表示由方法 A 和方法 B 在时间 $t_n = n h$ 生成的数值解的模。对于任意选择的步长 $h > 0$ 和频率 $\\omega > 0$，下列哪个陈述正确地描述了这些模的演变？\n\nA. $|y_{n+1}^{(A)}| > |y_n^{(A)}|$ 且 $|y_{n+1}^{(B)}| > |y_n^{(B)}|$\n\nB. $|y_{n+1}^{(A)}| < |y_n^{(A)}|$ 且 $|y_{n+1}^{(B)}| = |y_n^{(B)}|$\n\nC. $|y_{n+1}^{(A)}| = |y_n^{(A)}|$ 且 $|y_{n+1}^{(B)}| < |y_n^{(B)}|$\n\nD. $|y_{n+1}^{(A)}| > |y_n^{(A)}|$ 且 $|y_{n+1}^{(B)}| = |y_n^{(B)}|$\n\nE. $|y_{n+1}^{(A)}| < |y_n^{(A)}|$ 且 $|y_{n+1}^{(B)}| < |y_n^{(B)}|$\n\nF. $|y_{n+1}^{(A)}| = |y_n^{(A)}|$ 且 $|y_{n+1}^{(B)}| > |y_n^{(B)}|$", "solution": "我们分析线性测试常微分方程 $y'(t)=i\\omega y(t)$ 在这两种单步隐式方法下的表现，每种方法都会产生一个形如 $y_{n+1}=G y_n$ 的线性递推关系，其中 $G$ 是一个复放大因子。模的行为由 $|G|$ 决定。\n\n对于方法 A（后向欧拉法），其更新关系式为\n$$\ny_{n+1}=y_n+h(i\\omega y_{n+1}).\n$$\n整理得\n$$\n(1-i\\omega h)\\,y_{n+1}=y_n \\quad\\Rightarrow\\quad y_{n+1}=\\frac{1}{1-i\\omega h}\\,y_n.\n$$\n因此放大因子为\n$$\nG_{A}=\\frac{1}{1-i\\omega h}.\n$$\n其模为\n$$\n|G_{A}|^{2}=G_{A}\\overline{G_{A}}=\\frac{1}{(1-i\\omega h)(1+i\\omega h)}=\\frac{1}{1+(\\omega h)^{2}},\n$$\n所以\n$$\n|G_{A}|=\\frac{1}{\\sqrt{1+(\\omega h)^{2}}}<1 \\quad\\text{for}\\quad h>0,\\ \\omega>0.\n$$\n因此，\n$$\n|y_{n+1}^{(A)}|=|G_{A}|\\,|y_{n}^{(A)}|<|y_{n}^{(A)}|.\n$$\n\n对于方法 B（梯形法则），其更新关系式为\n$$\ny_{n+1}=y_n+\\frac{h}{2}\\big(i\\omega y_n+i\\omega y_{n+1}\\big).\n$$\n整理得\n$$\n\\big(1-\\tfrac{i\\omega h}{2}\\big)y_{n+1}=\\big(1+\\tfrac{i\\omega h}{2}\\big)y_n \\quad\\Rightarrow\\quad y_{n+1}=\\frac{1+\\tfrac{i\\omega h}{2}}{1-\\tfrac{i\\omega h}{2}}\\,y_n.\n$$\n因此放大因子为\n$$\nG_{B}=\\frac{1+\\tfrac{i\\omega h}{2}}{1-\\tfrac{i\\omega h}{2}}.\n$$\n分子和分母的模相等：\n$$\n\\left|1+\\tfrac{i\\omega h}{2}\\right|=\\sqrt{1+\\left(\\tfrac{\\omega h}{2}\\right)^{2}}=\\left|1-\\tfrac{i\\omega h}{2}\\right|,\n$$\n因此\n$$\n|G_{B}|=1,\n$$\n所以\n$$\n|y_{n+1}^{(B)}|=|y_{n}^{(B)}|.\n$$\n\n综合这些结果，对于任何 $h>0$ 和 $\\omega>0$，后向欧拉法会严格减小其模，而梯形法则能精确地保持其模不变。这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "2178599"}, {"introduction": "虽然隐式方法允许我们使用更大的时间步长，但这引出了一个新的挑战：我们如何高效地求解每一步产生的代数方程？本练习探讨了在求解一个典型刚性问题时，使用简单的定点迭代法所遇到的困境。通过推导其收敛条件，你将发现该迭代法的成功运行要求步长 $h$ 非常小，这恰恰违背了我们使用隐式方法处理刚性问题的初衷，从而凸显了为隐式方法配备强大求解器（如牛顿法）的必要性。[@problem_id:2178627]", "problem": "考虑一个一阶常微分方程（ODE）的数值解，该方程模拟了一个系统状态 $y(t)$，它会迅速调整以适应一个时变外部信号 $g(t)$。其动力学由以下方程描述：\n$$ y'(t) = \\alpha (g(t) - y(t)) $$\n其中，$\\alpha$ 是一个大的正常数，这使得该方程是“刚性”的。\n\n为了数值求解此 ODE，我们应用后向欧拉法，这是一种由下式定义的隐式格式：\n$$ y_{n+1} = y_n + h f(t_{n+1}, y_{n+1}) $$\n其中 $y_n \\approx y(t_n)$，$h$ 是时间步长，且 $f(t,y) = \\alpha (g(t) - y)$。\n\n为了在每个时间步求解关于 $y_{n+1}$ 的隐式方程，使用了一种简单的定点迭代法。从一个初始猜测 $y_{n+1}^{(0)}$ 开始，迭代过程如下：\n$$ y_{n+1}^{(k+1)} = y_n + h \\alpha (g(t_{n+1}) - y_{n+1}^{(k)}) $$\n其中 $k=0, 1, 2, \\dots$ 是迭代指数。\n\n为保证此定点迭代法对于任意初始猜测都能收敛到 $y_{n+1}$ 的正确值，步长 $h$ 必须严格小于某个临界值，我们称之为 $h_{crit}$。这个临界值取决于系统的参数。\n\n请确定这个临界步长 $h_{crit}$ 关于参数 $\\alpha$ 的表达式。", "solution": "我们从常微分方程 $y'(t)=\\alpha\\left(g(t)-y(t)\\right)$ 的后向欧拉步开始：\n$$\ny_{n+1}=y_{n}+h\\,\\alpha\\left(g(t_{n+1})-y_{n+1}\\right).\n$$\n将迭代中使用的定点映射定义为\n$$\nF(y):=y_{n}+h\\,\\alpha\\left(g(t_{n+1})-y\\right)=y_{n}+h\\,\\alpha\\,g(t_{n+1})-h\\,\\alpha\\,y.\n$$\n定点迭代为 $y_{n+1}^{(k+1)}=F\\!\\left(y_{n+1}^{(k)}\\right)$，且不动点 $y_{n+1}^{\\ast}$ 满足\n$$\ny_{n+1}^{\\ast}=F\\!\\left(y_{n+1}^{\\ast}\\right).\n$$\n为确保对任意初始猜测都收敛，$F$ 必须是 $\\mathbb{R}$ 上的一个压缩映射。根据 Banach 不动点定理，一个充分（在本线性情况下也是必要）条件是 $F$ 的利普希茨常数 $L$ 满足 $L<1$。由于 $F$ 对 $y$ 是可微且线性的，我们计算\n$$\nF'(y)=-h\\,\\alpha,\n$$\n因此利普希茨常数为\n$$\nL=\\sup_{y\\in\\mathbb{R}}|F'(y)|=|-h\\,\\alpha|=h\\,\\alpha.\n$$\n因此，迭代对任意初始猜测都收敛，当且仅当\n$$\nh\\,\\alpha<1.\n$$\n等价地，临界步长是\n$$\nh_{\\text{crit}}=\\frac{1}{\\alpha},\n$$\n且要求是 $h<h_{\\text{crit}}$。\n\n一个等价的误差分析也能得到相同的条件：令 $e^{(k)}=y_{n+1}^{(k)}-y_{n+1}^{\\ast}$，我们有\n$$\ne^{(k+1)}=F\\!\\left(y_{n+1}^{(k)}\\right)-F\\!\\left(y_{n+1}^{\\ast}\\right)=-h\\,\\alpha\\,e^{(k)},\n$$\n因此 $|e^{(k+1)}|=h\\,\\alpha\\,|e^{(k)}|$ 趋于零，当且仅当 $h\\,\\alpha<1$，这给出了相同的 $h_{\\text{crit}}=\\frac{1}{\\alpha}$。", "answer": "$$\\boxed{\\frac{1}{\\alpha}}$$", "id": "2178627"}]}