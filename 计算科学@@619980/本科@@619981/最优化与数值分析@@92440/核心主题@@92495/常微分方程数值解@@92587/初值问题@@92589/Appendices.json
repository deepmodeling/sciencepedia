{"hands_on_practices": [{"introduction": "我们从求解初值问题最基本的方法——欧拉法开始。这个练习将带你亲手完成单步欧拉法的计算，它通过在当前点沿切线方向前进一小步来逼近下一个点的函数值。通过这个具体的计算 [@problem_id:2180117]，你将直观地理解如何将一个连续的微分方程问题转化为一个离散的、可由计算机执行的迭代过程。", "problem": "考虑由常微分方程 $y' = x + \\cos(\\pi y)$ 和初始条件 $y(0) = 1$ 给出的初值问题。使用单步欧拉方法来近似 $y(0.1)$ 的值。", "solution": "我们使用一个从 $x_{0}=0$ 到 $x_{1}=0.1$ 的单步欧拉方法，步长为 $h=0.1$。欧拉方法的更新公式为\n$$\ny_{1}=y_{0}+h\\,f(x_{0},y_{0}),\n$$\n其中 $f(x,y)=x+\\cos(\\pi y)$。根据在 $x_{0}=0$ 处的初始条件 $y_{0}=1$，我们计算斜率：\n$$\nf(0,1)=0+\\cos(\\pi\\cdot 1)=\\cos(\\pi)=-1.\n$$\n因此，$y(0.1)$ 的近似值为：\n$$\ny(0.1)\\approx y_{1}=1+0.1\\cdot(-1)=1-0.1=0.9.\n$$", "answer": "$$\\boxed{0.9}$$", "id": "2180117"}, {"introduction": "并非所有数值方法都具有相同的性能，特别是在模拟需要长期保持稳定性的物理系统时。本练习 [@problem_id:1684988] 旨在通过对比显式欧拉法和辛欧拉法在模拟简谐振子时的表现，揭示不同数值积分器对系统能量等守恒量的影响。这将帮助你理解为物理问题选择合适的、能够保持其内在结构（如能量）的数值方法的重要性。", "problem": "一个质量为单位1 ($m=1$) 的质点与一根线性弹簧相连，构成一个简谐振子。其运动由二阶常微分方程 $\\frac{d^2x}{dt^2} + \\omega^2 x = 0$ 描述，该方程可等价地写成一个包含两个一阶方程的方程组：\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -\\omega^2 x\n$$\n该系统的角频率为 $\\omega = 1.0 \\text{ rad/s}$，并从初始状态 $(x_0, v_0) = (x(0), v(0)) = (1.0 \\text{ m}, 1.0 \\text{ m/s})$ 释放。\n\n我们希望比较两种不同的积分方法生成的数值轨迹，两种方法均使用 $h=0.5 \\text{ s}$ 的时间步长。设第 $n$ 步的状态为 $(x_n, v_n)$。这两种方法的定义如下：\n\n**方法 A（显式欧拉法）：**\n$$\nx_{n+1} = x_n + h v_n\n$$\n$$\nv_{n+1} = v_n - h \\omega^2 x_n\n$$\n\n**方法 B（辛欧拉法）：**\n$$\nx_{n+1} = x_n + h v_n\n$$\n$$\nv_{n+1} = v_n - h \\omega^2 x_{n+1}\n$$\n\n系统的机械能由 $E(x, v) = \\frac{1}{2} m v^2 + \\frac{1}{2} m \\omega^2 x^2$ 给出。对于单位质量（$m=1$），我们将能量函数定义为 $E(x, v) = \\frac{1}{2}(v^2 + \\omega^2 x^2)$。\n\n经过整好 $N=4$ 步后，设由方法 A 计算出的状态为 $(x_A, v_A)$，其对应的能量为 $E_A = E(x_A, v_A)$。同样地，设由方法 B 计算出的状态为 $(x_B, v_B)$，其能量为 $E_B = E(x_B, v_B)$。\n\n计算比值 $R = \\frac{E_A}{E_B}$ 的数值。将你的最终答案四舍五入到四位有效数字。", "solution": "给定简谐振子的单位质量和角频率 $\\omega=1$，因此一阶方程组为\n$$\n\\frac{dx}{dt}=v,\\qquad \\frac{dv}{dt}=-x,\n$$\n离散时间步长为 $h=0.5$。单位质量的能量为\n$$\nE(x,v)=\\frac{1}{2}\\left(v^{2}+x^{2}\\right).\n$$\n\n**方法 A（显式欧拉法）**\n初始条件为 $(x_{0},v_{0})=(1,1)$。迭代四步：\n- 第1步：$x_{1}=1+0.5\\cdot 1=1.5$, $v_{1}=1-0.5\\cdot 1=0.5$。\n- 第2步：$x_{2}=1.5+0.5\\cdot 0.5=1.75$, $v_{2}=0.5-0.5\\cdot 1.5=-0.25$。\n- 第3步：$x_{3}=1.75+0.5\\cdot\\left(-0.25\\right)=1.625$, $v_{3}=-0.25-0.5\\cdot 1.75=-1.125$。\n- 第4步：$x_{4}=1.625+0.5\\cdot\\left(-1.125\\right)=1.0625$, $v_{4}=-1.125-0.5\\cdot 1.625=-1.9375$。\n因此 $(x_{A},v_{A})=\\left(\\frac{17}{16},-\\frac{31}{16}\\right)$ 并且\n$$\nE_{A}=\\frac{1}{2}\\left[\\left(-\\frac{31}{16}\\right)^{2}+\\left(\\frac{17}{16}\\right)^{2}\\right]\n=\\frac{1}{2}\\cdot\\frac{961+289}{256}=\\frac{1250}{512}=\\frac{625}{256}.\n$$\n\n**方法 B（辛欧拉法）**\n初始条件相同。迭代四步：\n- 第1步：$x_{1}=1+0.5\\cdot 1=1.5$, $v_{1}=1-0.5\\cdot 1.5=0.25$。\n- 第2步：$x_{2}=1.5+0.5\\cdot 0.25=1.625$, $v_{2}=0.25-0.5\\cdot 1.625=-0.5625$。\n- 第3步：$x_{3}=1.625+0.5\\cdot\\left(-0.5625\\right)=1.34375$, $v_{3}=-0.5625-0.5\\cdot 1.34375=-1.234375$。\n- 第4步：$x_{4}=1.34375+0.5\\cdot\\left(-1.234375\\right)=0.7265625$, $v_{4}=-1.234375-0.5\\cdot 0.7265625=-1.59765625$。\n因此 $(x_{B},v_{B})=\\left(\\frac{93}{128},-\\frac{409}{256}\\right)$ 并且\n$$\nE_{B}=\\frac{1}{2}\\left[\\left(-\\frac{409}{256}\\right)^{2}+\\left(\\frac{93}{128}\\right)^{2}\\right]\n=\\frac{1}{2}\\left(\\frac{167281}{65536}+\\frac{34596}{65536}\\right)\n=\\frac{1}{2}\\cdot\\frac{201877}{65536}\n=\\frac{201877}{131072}.\n$$\n\n因此，比值为\n$$\nR=\\frac{E_{A}}{E_{B}}=\\frac{\\frac{625}{256}}{\\frac{201877}{131072}}\n=\\frac{625\\cdot 131072}{256\\cdot 201877}=\\frac{625 \\cdot 512}{201877}=\\frac{320000}{201877}\\approx 1.585123615\\ldots\n$$\n四舍五入到四位有效数字，得到 $R=1.585$。", "answer": "$$\\boxed{1.585}$$", "id": "1684988"}, {"introduction": "在掌握了如何应用数值方法后，一个更高级的技能是分析和评估这些方法的质量。“精度阶” ($p$) 是一个关键指标，它量化了当步长 $h$ 减小时，方法的全局误差 $E(h)$ 如何随之减小，通常关系为 $E(h) \\approx C h^p$。本练习 [@problem_id:2179607] 将指导你通过一个数值实验来确定一个新方法的精度阶，这是验证数值求解器和理解其收敛特性的标准实践。", "problem": "提出了一种新颖的显式两步线性多步法，用于求解形如 $y'(t) = f(t, y(t))$ 的一阶初值问题（IVP）。对于均匀步长 $h$，该方法由以下递推关系定义：\n$$\ny_{n+1} = 2y_n - y_{n-1} + h \\left( f(t_n, y_n) - f(t_{n-1}, y_{n-1}) \\right)\n$$\n其中 $n \\ge 1$，$y_k$ 是在时间 $t_k = t_0 + kh$ 时真实解 $y(t_k)$ 的数值近似。作为一个两步法，它需要两个初始值 $y_0$ 和 $y_1$ 来开始迭代。\n\n在固定的最终时间 $T$ 处，一个数值方法的全局误差 $E(h)$ 通常遵循 $E(h) \\approx C h^p$ 形式的幂律，其中 $p$ 是该方法的精度阶，而 $C$ 是一个常数。您的任务是对此特定方法数值估计其精度阶 $p$。\n\n考虑以下初值问题：\n$$\ny'(t) = -2y(t) + \\sin(t), \\quad y(0) = 1\n$$\n该初值问题的精确解析解为 $y(t) = \\frac{1}{5}(2\\sin(t) - \\cos(t)) + \\frac{6}{5}\\exp(-2t)$。\n\n为估计精度阶 $p$，请执行以下步骤：\n1.  使用四种不同的均匀步长：$h_1 = 0.1$，$h_2 = 0.05$，$h_3 = 0.025$ 和 $h_4 = 0.0125$，从 $t=0$ 到 $T=2$ 数值求解该初值问题。\n2.  对于每次运行，使用精确的初始值来初始化方法：$y_0 = y(t_0)$ 和 $y_1 = y(t_1) = y(h)$。\n3.  令 $E_i$ 为最终时间 $T=2$ 时的绝对误差，定义为 $E_i = |y_{N_i} - y(T)|$，其中 $y_{N_i}$ 是使用步长 $h_i$ 计算得到的 $t=T$ 时的数值解，且 $N_i = T/h_i$。\n4.  使用最小的两个步长（$h_3$ 和 $h_4$）运行的结果，计算表观精度阶 $p$。\n\n报告您计算出的 $p$ 值，保留三位有效数字。", "solution": "该方法的精度阶 $p$ 可以通过使用两次不同步长（$h_3$ 和 $h_4$）运行得到的全局误差（$E_3$ 和 $E_4$）来数值估计。所使用的公式为：\n$$\np \\approx \\frac{\\ln(E_3 / E_4)}{\\ln(h_3 / h_4)}\n$$\n根据题意，$h_3 = 0.025$ 且 $h_4 = 0.0125$，因此 $h_3 / h_4 = 2$。公式简化为：\n$$\np \\approx \\frac{\\ln(E_3 / E_4)}{\\ln(2)}\n$$\n虽然问题要求进行数值估计，但我们也可以从理论上分析该方法的阶。通过对该线性多步法进行局部截断误差分析（例如，使用泰勒级数展开），可以证明其局部截断误差为 $O(h^3)$。对于一个满足根条件的稳定方法，这对应于 $O(h^2)$ 的全局收敛阶。因此，该方法的理论精度阶为 $p=2$。\n\n假设我们的数值实验处于误差的渐近区，即全局误差 $E(h)$ 严格遵循 $E(h) \\approx C h^2$ 的关系，那么误差比率应为：\n$$\n\\frac{E_3}{E_4} \\approx \\frac{C h_3^2}{C h_4^2} = \\left(\\frac{h_3}{h_4}\\right)^2 = 2^2 = 4\n$$\n将这个比率代入我们的估计公式中，我们得到：\n$$\np \\approx \\frac{\\ln(4)}{\\ln(2)} = \\frac{2\\ln(2)}{\\ln(2)} = 2\n$$\n因此，我们期望从数值实验中得到的表观精度阶为 $2$。保留三位有效数字，结果为 $2.00$。", "answer": "$$\\boxed{2.00}$$", "id": "2179607"}]}