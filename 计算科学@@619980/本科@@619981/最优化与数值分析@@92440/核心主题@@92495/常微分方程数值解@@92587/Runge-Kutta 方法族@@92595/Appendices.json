{"hands_on_practices": [{"introduction": "并非所有数值方法都生而平等。本练习旨在通过直接比较，展示龙格-库塔方法相较于简单方法所带来的精度提升。我们将从最基础的前向欧拉法开始，然后引入一个二阶龙格-库塔方法（改进欧拉法），并通过计算来量化它们之间的差异。这个练习将帮助你直观地理解通过“预测-校正”思想来提升求解精度的核心价值 [@problem_id:2220001]。", "problem": "考虑如下给定的一阶常微分方程（ODE）初值问题：\n$$ \\frac{dy}{dt} = f(t, y) = y - t^2, \\quad y(0) = 1 $$\n我们希望在 $t=0.2$ 处近似求解 $y(t)$ 的值。完成此任务的两种常用数值方法是向前欧拉法和改进欧拉法（也称为休恩法）。\n\n对两种方法均使用大小为 $h = 0.2$ 的单步，计算通过向前欧拉法得到的 $y(0.2)$ 的近似值与通过改进欧拉法得到的近似值之间的绝对差。\n\n将最终答案四舍五入到四位有效数字。", "solution": "给定初值问题 $y^{\\prime}(t)=f(t,y)=y-t^{2}$ 及 $y(0)=1$，我们想用步长 $h=0.2$ 的向前欧拉法和改进欧拉（休恩）法对 $y(0.2)$ 进行单步近似，然后计算这两个近似值之间的绝对差。\n\n对于向前欧拉法，其更新公式为\n$$\ny_{n+1}=y_{n}+h\\,f(t_{n},y_{n}).\n$$\n当 $t_{0}=0$，$y_{0}=1$ 且 $h=0.2$ 时，我们有\n$$\nf(t_{0},y_{0})=f(0,1)=1-0^{2}=1,\n$$\n所以\n$$\ny_{1}^{\\text{FE}}=1+0.2\\cdot 1=1.2.\n$$\n\n对于改进欧拉（休恩）法，我们首先计算预测值\n$$\ny^{p}=y_{0}+h\\,f(t_{0},y_{0})=1+0.2\\cdot 1=1.2,\n$$\n并设 $t_{1}=t_{0}+h=0.2$。然后我们计算\n$$\nf(t_{1},y^{p})=f(0.2,1.2)=1.2-(0.2)^{2}=1.16.\n$$\n校正后的值为\n$$\ny_{1}^{\\text{IE}}=y_{0}+\\frac{h}{2}\\left[f(t_{0},y_{0})+f(t_{1},y^{p})\\right]\n=1+\\frac{0.2}{2}\\left[1+1.16\\right]\n=1+0.1\\cdot 2.16\n=1.216.\n$$\n\n两个近似值之间的绝对差为\n$$\n\\left|y_{1}^{\\text{FE}}-y_{1}^{\\text{IE}}\\right|=\\left|1.2-1.216\\right|=0.016.\n$$\n四舍五入到四位有效数字，结果为 $1.600 \\times 10^{-2}$。", "answer": "$$\\boxed{1.600 \\times 10^{-2}}$$", "id": "2220001"}, {"introduction": "在体验了二阶方法的优势后，我们将深入探究龙格-库塔家族中最著名的成员：经典的四阶龙格-库塔（RK4）方法。这个练习的核心任务不是求得最终解，而是解构该方法的“引擎”——四个阶段斜率（$k_1, k_2, k_3, k_4$）。通过亲手计算这些中间值，你将具体地感受到RK4方法是如何通过在区间内不同点进行多次“侦察”，从而实现其高精度的 [@problem_id:2219964]。", "problem": "考虑如下给定的一阶常微分方程 (ODE)：\n$$\n\\frac{dy}{dt} = \\sin(t) - y^{2}\n$$\n其初始条件为 $y(0) = 0.5$。\n\n我们希望使用经典的四阶龙格-库塔 (RK4) 方法来近似其解。该方法的第一步涉及计算四个中间斜率值，或称为“阶”，记为 $k_1, k_2, k_3,$ 和 $k_4$。对于形式为 $\\frac{dy}{dt} = f(t, y)$ 的常微分方程，从点 $(t_n, y_n)$ 开始，步长为 $h$，这些阶定义如下：\n\\begin{align*}\nk_1 &= f(t_n, y_n) \\\\\nk_2 &= f\\left(t_n + \\frac{h}{2}, y_n + h\\frac{k_1}{2}\\right) \\\\\nk_3 &= f\\left(t_n + \\frac{h}{2}, y_n + h\\frac{k_2}{2}\\right) \\\\\nk_4 &= f(t_n + h, y_n + h k_3)\n\\end{align*}\n\n从给定的初始条件出发，使用步长 $h = 0.2$，计算单个步长内四个阶 $k_1, k_2, k_3,$ 和 $k_4$ 的值。假设正弦函数的参数以弧度为单位。\n\n按顺序给出 $k_1, k_2, k_3,$ 和 $k_4$ 的值，形式为一组四个数，每个数四舍五入到四位有效数字。", "solution": "我们有常微分方程 $y' = f(t,y) = \\sin(t) - y^{2}$，初始点为 $(t_{0},y_{0})=(0,0.5)$，步长为 $h=0.2$。RK4 的各阶为\n$$\nk_{1}=f(t_{0},y_{0}),\\quad\nk_{2}=f\\left(t_{0}+\\frac{h}{2},\\,y_{0}+\\frac{h}{2}k_{1}\\right),\\quad\nk_{3}=f\\left(t_{0}+\\frac{h}{2},\\,y_{0}+\\frac{h}{2}k_{2}\\right),\\quad\nk_{4}=f\\left(t_{0}+h,\\,y_{0}+h\\,k_{3}\\right).\n$$\n计算每一阶：\n1) $k_{1} = \\sin(0) - (0.5)^{2} = 0 - 0.25 = -0.25$。\n\n2) 对于 $k_{2}$，使用 $t_{0}+\\frac{h}{2}=0.1$ 和 $y_{0}+\\frac{h}{2}k_{1}=0.5+\\frac{0.2}{2}(-0.25)=0.475$，因此\n$$\nk_{2}=\\sin(0.1) - (0.475)^{2} = 0.09983341664682815 - 0.225625 = -0.12579158335317182.\n$$\n\n3) 对于 $k_{3}$，使用 $t_{0}+\\frac{h}{2}=0.1$ 和 $y_{0}+\\frac{h}{2}k_{2}=0.5+0.1(-0.12579158335317182)=0.4874208416646828$，因此\n$$\n(0.4874208416646828)^{2} \\approx 0.23757907690468282,\n$$\n所以\n$$\nk_{3}=\\sin(0.1) - (0.4874208416646828)^{2} = 0.09983341664682815 - 0.23757907690468282 = -0.13774566025785467.\n$$\n\n4) 对于 $k_{4}$，使用 $t_{0}+h=0.2$ 和 $y_{0}+h\\,k_{3}=0.5+0.2(-0.13774566025785467)=0.47245086794842906$，因此\n$$\n(0.47245086794842906)^{2} \\approx 0.22321002262447222,\\quad \\sin(0.2)=0.19866933079506122,\n$$\n所以\n$$\nk_{4}=\\sin(0.2) - (0.47245086794842906)^{2} = 0.19866933079506122 - 0.22321002262447222 = -0.02454069182941100.\n$$\n\n四舍五入到四位有效数字：\n$$\nk_{1}=-0.2500,\\quad k_{2}=-0.1258,\\quad k_{3}=-0.1377,\\quad k_{4}=-0.02454.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-0.2500 & -0.1258 & -0.1377 & -0.02454\\end{pmatrix}}$$", "id": "2219964"}, {"introduction": "数值精度并非评价一个方法好坏的唯一标准。最后一个练习将引导我们探索一个更深层次的概念：数值格式如何影响其所模拟的物理系统的内在属性。我们将以简谐振子为例，从理论上证明前向欧拉法会系统性地增加系统能量，这违背了物理学的基本守恒定律。这个关键的洞察强调了选择数值方法时，不仅要考虑局部误差，更要关注其是否能“尊重”问题的定性特征 [@problem_id:2219992]。", "problem": "考虑一个简谐振子，其运动由以下一阶常微分方程组描述：\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -x\n$$\n其中 $x$ 是振子的位置，$v$ 是振子的速度。系统的总机械能定义为 $E = \\frac{1}{2}(x^2 + v^2)$。\n\n假设在时间 $t=0$ 时，系统处于初始状态 $(x_0, v_0)$，初始能量为 $E_0$。我们希望使用前向欧拉法的一步来近似系统在稍后时间 $t=h$ 的状态。对于系统 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$，前向欧拉法使用公式 $\\mathbf{y}_{n+1} = \\mathbf{y}_n + h \\cdot \\mathbf{f}(t_n, \\mathbf{y}_n)$ 将解从 $\\mathbf{y}_n$ 推进到 $\\mathbf{y}_{n+1}$，其中 $h$ 是时间步长，且我们假设 $h > 0$。\n\n令新状态为 $(x_1, v_1)$，对应的能量为 $E_1$。求比值 $\\frac{E_1}{E_0}$，假设初始状态不是原点（即 $E_0 \\neq 0$）。你的答案应仅用步长 $h$ 表示。", "solution": "我们将系统写成向量形式 $\\mathbf{y} = \\begin{pmatrix} x \\\\ v \\end{pmatrix}$，其中 $\\mathbf{f}(\\mathbf{y}) = \\begin{pmatrix} v \\\\ -x \\end{pmatrix}$。从 $(x_{0}, v_{0})$ 开始，使用步长为 $h$ 的单步前向欧拉法，得到\n$$\nx_{1} = x_{0} + h v_{0}, \\quad v_{1} = v_{0} + h(-x_{0}) = v_{0} - h x_{0}.\n$$\n第 $n$ 步的能量定义为 $E_{n} = \\frac{1}{2}(x_{n}^{2} + v_{n}^{2})$。因此，\n$$\nE_{1} = \\frac{1}{2}\\left(x_{1}^{2} + v_{1}^{2}\\right) = \\frac{1}{2}\\left((x_{0} + h v_{0})^{2} + (v_{0} - h x_{0})^{2}\\right).\n$$\n将每个平方项展开并求和，\n$$\n(x_{0} + h v_{0})^{2} = x_{0}^{2} + 2 h x_{0} v_{0} + h^{2} v_{0}^{2}, \\quad (v_{0} - h x_{0})^{2} = v_{0}^{2} - 2 h x_{0} v_{0} + h^{2} x_{0}^{2},\n$$\n所以\n$$\nx_{1}^{2} + v_{1}^{2} = x_{0}^{2} + v_{0}^{2} + h^{2}(x_{0}^{2} + v_{0}^{2}).\n$$\n因此，\n$$\nE_{1} = \\frac{1}{2}(1 + h^{2})(x_{0}^{2} + v_{0}^{2}) = (1 + h^{2}) E_{0}.\n$$\n由于 $E_{0} \\neq 0$，该比值为\n$$\n\\frac{E_{1}}{E_{0}} = 1 + h^{2}.\n$$", "answer": "$$\\boxed{1 + h^{2}}$$", "id": "2219992"}]}