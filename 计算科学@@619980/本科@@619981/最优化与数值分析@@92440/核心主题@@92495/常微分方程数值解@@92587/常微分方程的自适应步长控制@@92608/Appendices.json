{"hands_on_practices": [{"introduction": "自适应步长控制的核心思想是利用两种不同阶数的数值方法来估计局部误差。本练习将指导您推导出最基本的步长控制法则，将局部截断误差的理论概念与一个实用的算法联系起来。通过比较一阶欧拉法和二阶Heun法的近似结果，您将亲手构建一个根据预设容差自动调整步长的机制。[@problem_id:2181287]", "problem": "在数值分析领域，自适应步长方法对于有效求解形式为$y'(t) = f(t, y)$且初始条件为$y(t_0) = y_0$的常微分方程 (ODE) 至关重要。这些方法通过调整步长$h$来维持所需的精度水平。\n\n考虑用两种数值方法来近似$t_0+h$处的解：\n1.  **前向 Euler 法**：其近似值（我们称之为$y_1$）由下式给出：\n    $$y_1 = y_0 + h f(t_0, y_0)$$\n2.  **Heun 法 (改进 Euler 法)**：其近似值（我们称之为$y_2$）由下式给出：\n    $$y_2 = y_0 + \\frac{h}{2} \\left[ f(t_0, y_0) + f(t_0+h, y_0 + hf(t_0,y_0)) \\right]$$\n\n前向 Euler 法的局部截断误差是二阶的，这意味着它与步长的平方$h^2$成正比。Heun 法更为精确，其局部截断误差具有更高的阶。一种常见的步长控制策略是，使用两种近似值之差$|y_2 - y_1|$来估计较不精确方法（前向 Euler 法）在当前步长$h$下的误差。\n\n你的任务是推导下一个步长$h_{\\text{new}}$的控制规则。假设当前大小为$h$的步长产生了近似值$y_1$和$y_2$。目标是选择$h_{\\text{new}}$，使得下一步的估计误差等于一个预定义的目标容差$\\epsilon$。请找出一个用$h$、$\\epsilon$、$y_1$和$y_2$表示$h_{\\text{new}}$的表达式。", "solution": "令$y(t)$表示精确解。前向 Euler 法的局部截断误差为$h^{2}$阶，因此对于某个取决于$f$在$(t_{0},y_{0})$处的导数的常数$K$，我们有\n$$\ny_{1}=y(t_{0}+h)-K h^{2}+O(h^{3})。\n$$\nHeun 法的阶更高，其局部截断误差为$O(h^{3})$，因此\n$$\ny_{2}=y(t_{0}+h)+O(h^{3})。\n$$\n两式相减可得\n$$\ny_{2}-y_{1}=K h^{2}+O(h^{3})，\n$$\n因此，步长为$h$时前向 Euler 法的局部误差大小可以估计为\n$$\nE(h)\\approx |y_{2}-y_{1}|\\approx |K| h^{2}。\n$$\n假设在下一步中局部常数$K$保持不变，则新步长$h_{\\text{new}}$的误差满足\n$$\nE(h_{\\text{new}})\\approx |K| h_{\\text{new}}^{2}。\n$$\n使用$|K|\\approx |y_{2}-y_{1}|/h^{2}$消去$|K|$，可得\n$$\nE(h_{\\text{new}})\\approx \\frac{|y_{2}-y_{1}|}{h^{2}}\\,h_{\\text{new}}^{2}。\n$$\n施加控制目标$E(h_{\\text{new}})=\\epsilon$并求解$h_{\\text{new}}$：\n$$\n\\epsilon=\\frac{|y_{2}-y_{1}|}{h^{2}}\\,h_{\\text{new}}^{2}\n\\quad\\Longrightarrow\\quad\nh_{\\text{new}}=h\\left(\\frac{\\epsilon}{|y_{2}-y_{1}|}\\right)^{\\frac{1}{2}}。\n$$\n这使用嵌入对（前向 Euler 法，Heun 法）所提供的误差估计，将下一个步长表示为$h$、$\\epsilon$、$y_{1}$和$y_{2}$的函数。", "answer": "$$\\boxed{h\\left(\\frac{\\epsilon}{|y_{2}-y_{1}|}\\right)^{\\frac{1}{2}}}$$", "id": "2181287"}, {"introduction": "理解了如何控制步长后，我们可以更进一步：通过观察步长本身的行为来诊断问题。本练习探讨了刚性常微分方程（Stiff ODEs）这一重要挑战，并揭示了步长历史$h(t)$作为一种强大的诊断工具。您将学会区分受精度限制的步长和受稳定性限制的步长，这是理解显式求解器在处理不同类型问题时性能差异的关键。[@problem_id:2372234]", "problem": "两个常微分方程 (ODE) 初值问题采用相同的一个阶数为$p=5$的显式嵌入式龙格-库塔方法，在$t\\in[0,10]$上进行积分。积分过程使用标准的局部误差控制，其中相对容差$\\mathrm{rtol}=10^{-6}$，绝对容差$\\mathrm{atol}=10^{-12}$，安全因子$S\\in(0,1)$，初始步长$h(0)=10^{-3}$。问题如下：\n- 系统$S$：$y^{\\prime}(t)=-\\lambda\\,y(t)$，其中$\\lambda=10^{4}$且$y(0)=1$。\n- 系统$N$：$y^{\\prime}(t)=-y(t)$，其中$y(0)=1$。\n\n对每个系统进行一次运行，得到以下观测到的步长历史$h(t)$：\n- 运行$\\mathrm{R1}$：经过初始自适应后，对于$t\\in[0,10]$的大部分区间，$h(t)$稳定在一个近乎恒定的平台期，$h(t)\\approx 5\\times 10^{-4}$。将$\\mathrm{rtol}$乘以$10$或除以$10$后重复运行，该平台期基本保持不变。\n- 运行$\\mathrm{R2}$：在积分区间的早期部分，$h(t)$增加了几个数量级，并最终在温和波动中达到$h(t)\\approx 5\\times 10^{-1}$。当$\\mathrm{rtol}$收紧$10$倍时，渐近的$h(t)$系统性地减小；当$\\mathrm{rtol}$放宽$10$倍时，渐近的$h(t)$系统性地增加。\n\n仅使用步长历史$h(t)$中的信息作为诊断工具，比较求解器在刚性与非刚性系统上的性能，以下哪些陈述是有效的？选择所有适用的选项。\n\nA. 运行$\\mathrm{R1}$对应于刚性系统$S$；观测到的$h(t)$平台期及其对$\\mathrm{rtol}$变化的非敏感性表明，步长主要受限于线性稳定性，即受限于形式为$\\lvert h\\,\\lambda\\rvert\\lesssim \\gamma$的约束（其中$\\gamma$是与方法相关的常数），而非受限于精度。\n\nB. 运行$\\mathrm{R2}$对应于刚性系统$S$；增长的$h(t)$表明显式方法可以跨越快速暂态过程采用非常大的步长，因为刚性问题允许跳过快速衰减的模态。\n\nC. 对于非刚性系统$N$，在使用阶数为$p$的自适应嵌入式方法和局部误差控制下，当解在$\\mathcal{O}(1)$尺度上变化时，渐近接受步长满足$h\\propto \\mathrm{rtol}^{1/(p+1)}$的关系，这解释了$\\mathrm{R2}$对$\\mathrm{rtol}$变化的敏感性。\n\nD. 如果两次运行都使用一个阶数相当且具有相同容差的隐式 A-稳定（在整个左半复平面绝对稳定）方法重复进行，那么刚性情况仍会出于相同的稳定性原因表现出小$h$平台期，因此$h(t)$中平台期的存在将无助于诊断刚性。\n\nE. 仅凭频繁的步长拒绝就足以确切地证明刚性，因此无论$h(t)$的其他特征如何，步长拒绝次数更多的运行必然是刚性的。", "solution": "对问题陈述进行验证。\n\n**1. 提取已知条件：**\n- 积分区间为$t \\in [0, 10]$。\n- 数值方法为$p=5$阶的显式嵌入式龙格-库塔方法。\n- 自适应步长控制使用相对容差$\\mathrm{rtol}=10^{-6}$和绝对容差$\\mathrm{atol}=10^{-12}$。使用了一个安全因子$S \\in (0, 1)$。\n- 初始步长为$h(0)=10^{-3}$。\n- 系统$S$是常微分方程 (ODE) $y^{\\prime}(t)=-\\lambda\\,y(t)$，其中$\\lambda=10^{4}$，初始条件为$y(0)=1$。\n- 系统$N$是常微分方程 (ODE) $y^{\\prime}(t)=-y(t)$，初始条件为$y(0)=1$。\n- 运行$\\mathrm{R1}$得到的步长历史$h(t)$稳定在一个平台期$h(t)\\approx 5\\times 10^{-4}$，且该平台期对$\\mathrm{rtol}$的变化不敏感。\n- 运行$\\mathrm{R2}$得到的步长历史$h(t)$增加了几个数量级，达到渐近值$h(t)\\approx 5\\times 10^{-1}$，且该值对$\\mathrm{rtol}$的变化敏感。\n- 目标是利用步长历史$h(t)$来比较求解器在这两个系统上的性能。\n\n**2. 问题陈述的验证：**\n- **科学依据：** 该问题描述了数值常微分方程领域的一个典型例子，即比较一个刚性与一个非刚性线性系统的积分。其中涉及的刚性、显式龙格-库塔方法、基于局部误差估计的自适应步长控制以及绝对稳定域等概念，均为标准概念且使用正确。\n- **适定性：** 该问题是适定的。所提供的信息充分且一致，允许进行严谨的演绎分析。对两次运行$\\mathrm{R1}$和$\\mathrm{R2}$的描述，符合给定系统和方法下预期的数值行为特征。\n- **客观性：** 该问题以精确、客观、技术性的语言表述。没有主观或含糊不清的陈述。\n\n**3. 结论：**\n问题陈述是有效的。它提出了一个计算科学领域的标准、适定场景，可以从第一性原理进行分析。\n\n**求解推导：**\n\n首先，我们必须识别刚性系统和非刚性系统。刚性源于系统中存在多个时间尺度，特别是一个非常快速衰减的暂态分量。\n- 系统$S$：$y'(t) = -10^4 y(t)$。特征值为$-\\lambda = -10^4$。解为$y(t) = e^{-10^4 t}$。特征时间尺度为$\\tau_S = 1/\\lambda = 10^{-4}$。与积分区间$[0, 10]$相比，这个时间尺度极短。因此该系统是**非常刚性**的。\n- 系统$N$：$y'(t) = -y(t)$。特征值为$-1$。解为$y(t) = e^{-t}$。特征时间尺度为$\\tau_N = 1$。这与积分区间的数量级相当。因此该系统是**非刚性**的。\n\n显式方法的自适应步长控制器必须同时满足两个约束。步长$h$被选为满足精度要求和稳定性要求的步长中的较小者：$h \\approx \\min(h_{\\text{accuracy}}, h_{\\text{stability}})$。\n\n对于应用于$y' = -\\lambda y$的显式龙格-库塔方法，数值稳定性约束是乘积$h\\lambda$必须位于该方法的绝对稳定域内。其形式为$|h\\lambda| \\leq \\gamma$，其中$\\gamma$是一个与方法相关的常数。因此，受稳定性限制的步长为$h_{\\text{stability}} \\leq \\gamma / \\lambda$。\n\n精度约束由局部误差控制机制决定。对于一个$p$阶方法，局部截断误差 (LTE) 的形式为$LTE = C h^{p+1} y^{(p+1)}(t) + \\mathcal{O}(h^{p+2})$。控制器通过调整$h$来使该误差的估计值低于给定容差$\\mathrm{Tol}(t) = \\mathrm{rtol}|y(t)| + \\mathrm{atol}$。这导致受精度限制的步长满足$h_{\\text{accuracy}} \\propto (\\mathrm{Tol})^{1/(p+1)}$。\n\n现在我们分析每个系统的行为：\n\n- **系统$S$(刚性)：** 由于$\\lambda = 10^4$，稳定性约束为$h_{\\text{stability}} \\leq \\gamma/10^4$。对于一个典型的$p=5$阶显式RK方法（如Dormand-Prince 5(4)对），稳定边界约为$\\gamma \\approx 5.1$。这对步长施加了严格的限制：$h_{\\text{stability}} \\lesssim 5.1 \\times 10^{-4}$。在一个非常短暂的暂态过程之后（对于$t \\gg 10^{-4}$），真实解$y(t)$及其所有导数都接近于零。精度要求变得极其宽松，主要由$\\mathrm{atol}$决定，并允许一个非常大的$h_{\\text{accuracy}}$。然而，求解器被迫遵守稳定性限制。因此，步长将由稳定性主导：$h(t) \\approx h_{\\text{stability}} \\approx 5 \\times 10^{-4}$。这个步长仅取决于$\\lambda$和方法的稳定域，而与容差$\\mathrm{rtol}$无关。这一行为与运行$\\mathrm{R1}$的描述完全匹配。\n\n- **系统$N$(非刚性)：** 由于$\\lambda = 1$，稳定性约束为$h_{\\text{stability}} \\leq \\gamma/1 \\approx 5.1$。这是一个非常宽松的约束。步长将由精度决定。由于$p=5$，我们有$h \\approx h_{\\text{accuracy}} \\propto (\\mathrm{Tol})^{1/(p+1)} = (\\mathrm{rtol}|e^{-t}| + \\mathrm{atol})^{1/6}$。这个步长显然依赖于$\\mathrm{rtol}$。随着$t$的增加，$y(t)=e^{-t}$衰减，达到精度要求变得更容易，控制器将增加步长。这一行为与运行$\\mathrm{R2}$的描述完全匹配。\n\n在将$\\mathrm{R1}$与刚性系统$S$、将$\\mathrm{R2}$与非刚性系统$N$匹配之后，我们来评估各个选项。\n\n**逐项分析：**\n\n**A. 运行$\\mathrm{R1}$对应于刚性系统$S$；观测到的$h(t)$平台期及其对$\\mathrm{rtol}$变化的非敏感性表明，步长主要受限于线性稳定性，即受限于形式为$\\lvert h\\,\\lambda\\rvert\\lesssim \\gamma$的约束（其中$\\gamma$是与方法相关的常数），而非受限于精度。**\n这个陈述与我们的分析完全一致。运行$\\mathrm{R1}$确实是刚性系统$S$。在$h(t) \\approx 5 \\times 10^{-4}$处的平坦平台期是稳定性极限$h \\leq \\gamma/\\lambda$的体现。这个极限与容差$\\mathrm{rtol}$无关，这解释了所观察到的非敏感性。\n结论：**正确**。\n\n**B. 运行$\\mathrm{R2}$对应于刚性系统$S$；增长的$h(t)$表明显式方法可以跨越快速暂态过程采用非常大的步长，因为刚性问题允许跳过快速衰减的模态。**\n这个陈述在两个方面都是错误的。首先，如已确定的，运行$\\mathrm{R2}$对应于非刚性系统$N$。其次，“*显式*方法可以在刚性问题上采用大步长”的说法是一个根本性的误解。正是显式方法的稳定性限制阻止了它们“跳过”已衰减的快速模态。这种能力是适用的*隐式*方法（如A-稳定的方法）的主要特征。\n结论：**不正确**。\n\n**C. 对于非刚性系统$N$，在使用阶数为$p$的自适应嵌入式方法和局部误差控制下，当解在$\\mathcal{O}(1)$尺度上变化时，渐近接受步长满足$h\\propto \\mathrm{rtol}^{1/(p+1)}$的关系，这解释了$\\mathrm{R2}$对$\\mathrm{rtol}$变化的敏感性。**\n这个陈述是正确的。运行$\\mathrm{R2}$对应于非刚性系统$N$。对于一个$p$阶方法，为满足给定容差$\\mathrm{Tol}$所需的步长满足$h \\propto (\\mathrm{Tol})^{1/(p+1)}$。当绝对容差$\\mathrm{atol}$很小且解不接近于零时，$\\mathrm{Tol} \\approx \\mathrm{rtol}|y|$，导致步长关系为$h \\propto \\mathrm{rtol}^{1/(p+1)}$。当$p=5$时，即为$h \\propto \\mathrm{rtol}^{1/6}$。这一理论关系正确地解释了在运行R2中观察到的步长对$\\mathrm{rtol}$的系统性依赖。\n结论：**正确**。\n\n**D. 如果两次运行都使用一个阶数相当且具有相同容差的隐式 A-稳定（在整个左半复平面绝对稳定）方法重复进行，那么刚性情况仍会出于相同的稳定性原因表现出小$h$平台期，因此$h(t)$中平台期的存在将无助于诊断刚性。**\n这个陈述存在根本性缺陷。根据定义，当应用于$\\lambda > 0$的$y' = -\\lambda y$时，一个 A-稳定的方法对任何步长$h > 0$都是数值稳定的。因此，对于刚性系统$S$，步长将**没有**由稳定性引起的限制。步长将完全由精度要求决定。在初始的快速暂态之后，解基本上为零，一个 A-稳定的方法将能够采用非常大的步长。不存在由稳定性引起的平台期，这正是对刚性问题使用此类方法的根本原因。\n结论：**不正确**。\n\n**E. 仅凭频繁的步长拒绝就足以确切地证明刚性，因此无论$h(t)$的其他特征如何，步长拒绝次数更多的运行必然是刚性的。**\n这是一种严重的过度简化。虽然用显式方法求解刚性问题时，当步长试图增长并超出稳定边界时常会导致步长拒绝，但频繁的步长拒绝并不能确切地证明刚性。它们也可能由其他问题引起，例如在奇点附近积分、存在高频振荡的问题，或者仅仅是初始步长选择不当。当使用显式方法时，与仅仅计算拒绝次数相比，$h(t)$中对容差不敏感的特征性平台期是诊断刚性远为更可靠的指标。\n结论：**不正确**。", "answer": "$$\\boxed{AC}$$", "id": "2372234"}, {"introduction": "现实世界中的系统通常由多个相互关联的变量描述，需要用向量形式的常微分方程组来建模。此时，我们如何衡量一个误差“向量”的大小？本练习深入探讨了在多维系统中，不同向量范数（如$L_1$、$L_2$和$L_\\infty$范数）的选择对步长接受和调整的具体影响。通过该计算，您将认识到求解器设计中的细节（如范数的选择）并非无关紧要，而是会切实影响求解器的性能和效率。[@problem_id:2372270]", "problem": "考虑一个维度为$n=3$的向量值常微分方程（ODE）系统。一个$5(4)$阶的嵌入式龙格-库塔（RK）对使用试验步长$h$将数值解从时间$t_n$推进到$t_{n+1}=t_n+h$。设高阶解为$y^{[5]}$，低阶解为$y^{[4]}$，并定义局部误差估计向量$e = y^{[5]} - y^{[4]}$。使用标准的分量误差缩放，其公式为\n$$\n\\mathrm{sc}_i = \\mathrm{atol} + \\mathrm{rtol}\\,\\max\\!\\big(|y_{n,i}|,\\ |y^{[5]}_i|\\big),\\quad i=1,2,3,\n$$\n其中$\\mathrm{atol}$和$\\mathrm{rtol}$分别是绝对容差和相对容差。缩放误差向量为$r$，其分量为$r_i = e_i/\\mathrm{sc}_i$。步长接受准则是 不等式$\\|r\\| \\le 1$，其中$\\|\\cdot\\|$表示所选的向量范数。步长控制器通过以下公式更新下一步长：\n$$\nh_{\\mathrm{new}} = \\eta\\, h\\, \\|r\\|^{-1/q},\n$$\n其中安全因子$\\eta=0.9$，指数$q=5$。考虑$\\mathbb{R}^3$上的三种范数选择：$L_1$范数$\\|r\\|_1=\\sum_{i=1}^3 |r_i|$，$L_2$范数$\\|r\\|_2=\\big(\\sum_{i=1}^3 r_i^2\\big)^{1/2}$，以及$L_\\infty$范数$\\|r\\|_\\infty=\\max_{1\\le i\\le 3}|r_i|$。\n\n在时间$t_n$时，数据如下：\n- $h = 0.1$,\n- $y_n = (1.0,\\ 0.0100,\\ 10.0)$,\n- $y^{[5]} = (1.10,\\ 0.0105,\\ 9.90)$,\n- $e = (0.0008808,\\ 0.0000023,\\ 0.00050005)$,\n- $\\mathrm{atol} = 10^{-6}$, $\\mathrm{rtol} = 10^{-3}$。\n\n关于三种范数下的步长接受情况以及由此产生的$h_{\\mathrm{new}}$的排序，以下哪个陈述是正确的？\n\nA. 在$L_\\infty$和$L_2$范数下步长被接受，但在$L_1$范数下被拒绝；此外，$h_{\\mathrm{new}}^{(1)}  h_{\\mathrm{new}}^{(2)}  h_{\\mathrm{new}}^{(\\infty)}$。\n\nB. 在所有三种范数下步长均被接受；此外，$h_{\\mathrm{new}}^{(\\infty)}  h_{\\mathrm{new}}^{(2)}  h_{\\mathrm{new}}^{(1)}$。\n\nC. 在所有三种范数下步长均被拒绝；此外，$h_{\\mathrm{new}}^{(1)} = h_{\\mathrm{new}}^{(2)} = h_{\\mathrm{new}}^{(\\infty)}$。\n\nD. 仅在$L_1$范数下步长被接受；此外，$h_{\\mathrm{new}}^{(1)}  h_{\\mathrm{new}}^{(2)}  h_{\\mathrm{new}}^{(\\infty)}$。", "solution": "在尝试解答之前，将对问题进行验证。\n\n### 步骤1：提取已知条件\n问题陈述中提供的数据如下：\n- ODE 系统维度：$n=3$。\n- 龙格-库塔对阶数：$5(4)$，其中$y^{[5]}$为高阶解，$y^{[4]}$为低阶解。\n- 局部误差估计向量：$e = y^{[5]} - y^{[4]}$。\n- 分量误差缩放因子：$\\mathrm{sc}_i = \\mathrm{atol} + \\mathrm{rtol}\\,\\max\\!\\big(|y_{n,i}|,\\ |y^{[5]}_i|\\big)$，对于$i=1,2,3$。\n- 缩放误差向量：$r$，其分量为$r_i = e_i/\\mathrm{sc}_i$。\n- 步长接受准则：$\\|r\\| \\le 1$。\n- 步长更新规则：$h_{\\mathrm{new}} = \\eta\\, h\\, \\|r\\|^{-1/q}$。\n- 需要考虑的范数：$L_1$范数（$\\|r\\|_1$），$L_2$范数（$\\|r\\|_2$）和$L_\\infty$范数（$\\|r\\|_\\infty$）。\n- 参数：安全因子$\\eta=0.9$，指数$q=5$。\n- 时间$t_n$时的数据：\n    - 试验步长：$h = 0.1$。\n    - $t_n$时的解：$y_n = (1.0,\\ 0.0100,\\ 10.0)$。\n    - $t_{n+1}$时的高阶解：$y^{[5]} = (1.10,\\ 0.0105,\\ 9.90)$。\n    - 局部误差估计向量：$e = (0.0008808,\\ 0.0000023,\\ 0.00050005)$。\n    - 容差：$\\mathrm{atol} = 10^{-6}$，$\\mathrm{rtol} = 10^{-3}$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题是数值分析领域的一个标准练习，具体涉及求解常微分方程的自适应步长控制的实现。\n- **科学依据：** 该问题使用了数值ODE求解器中已确立的概念和公式，例如嵌入式龙格-库塔方法、局部误差估计和比例-积分（PI）步长控制。所有概念在计算科学中都是标准的。\n- **适定性：** 提供了所有必要的数据和公式。问题要求基于这些输入进行直接计算和比较。可以确定一个唯一且有意义的解。\n- **客观性：** 语言精确且量化，没有主观因素。\n- **完整性和一致性：** 问题是自洽的。所有变量都已定义，所有数值都已提供。没有内部矛盾。\n\n### 步骤3：结论与行动\n问题陈述有效。我将继续推导解答。\n\n### 解答推导\n解答需要三部分计算：首先，确定缩放误差向量$r$；其次，对三种范数分别评估步长接受准则；第三，确定控制器对每种范数提出的新步长$h_{\\mathrm{new}}$的相对排序。\n\n**1. 计算缩放因子$\\mathrm{sc}_i$**\n使用公式$\\mathrm{sc}_i = \\mathrm{atol} + \\mathrm{rtol}\\,\\max\\!\\big(|y_{n,i}|,\\ |y^{[5]}_i|\\big)$:\n- 对于$i=1$：\n$|y_{n,1}| = 1.0$, $|y^{[5]}_1| = 1.10$. $\\max(1.0, 1.10) = 1.10$.\n$$\n\\mathrm{sc}_1 = 10^{-6} + 10^{-3} \\times 1.10 = 0.000001 + 0.0011 = 0.001101.\n$$\n- 对于$i=2$：\n$|y_{n,2}| = 0.0100$, $|y^{[5]}_2| = 0.0105$. $\\max(0.0100, 0.0105) = 0.0105$.\n$$\n\\mathrm{sc}_2 = 10^{-6} + 10^{-3} \\times 0.0105 = 0.000001 + 0.0000105 = 0.0000115.\n$$\n- 对于$i=3$：\n$|y_{n,3}| = 10.0$, $|y^{[5]}_3| = 9.90$. $\\max(10.0, 9.90) = 10.0$.\n$$\n\\mathrm{sc}_3 = 10^{-6} + 10^{-3} \\times 10.0 = 0.000001 + 0.01 = 0.010001.\n$$\n\n**2. 计算缩放误差向量$r$**\n使用公式$r_i = e_i/\\mathrm{sc}_i$和给定的误差向量$e = (0.0008808,\\ 0.0000023,\\ 0.00050005)$:\n- 对于$i=1$：\n$$\nr_1 = \\frac{0.0008808}{0.001101} = \\frac{8808 \\times 10^{-7}}{1101 \\times 10^{-6}} = \\frac{8 \\times 1101 \\times 10^{-7}}{1101 \\times 10^{-6}} = 8 \\times 10^{-1} = 0.8.\n$$\n- 对于$i=2$：\n$$\nr_2 = \\frac{0.0000023}{0.0000115} = \\frac{2.3 \\times 10^{-6}}{11.5 \\times 10^{-6}} = \\frac{2.3}{11.5} = \\frac{1}{5} = 0.2.\n$$\n- 对于$i=3$：\n$$\nr_3 = \\frac{0.00050005}{0.010001} = \\frac{5.0005 \\times 10^{-4}}{1.0001 \\times 10^{-2}} = \\frac{5 \\times 1.0001 \\times 10^{-4}}{1.0001 \\times 10^{-2}} = 5 \\times 10^{-2} = 0.05.\n$$\n缩放误差向量为$r = (0.8,\\ 0.2,\\ 0.05)$。\n\n**3. 步长接受分析**\n如果$\\|r\\| \\le 1$，则步长被接受。\n- **$L_\\infty$范数：**\n$$\n\\|r\\|_\\infty = \\max(|r_1|, |r_2|, |r_3|) = \\max(0.8, 0.2, 0.05) = 0.8.\n$$\n因为$\\|r\\|_\\infty = 0.8 \\le 1$，所以在$L_\\infty$范数下步长被**接受**。\n- **$L_2$范数：**\n$$\n\\|r\\|_2 = \\sqrt{r_1^2 + r_2^2 + r_3^2} = \\sqrt{0.8^2 + 0.2^2 + 0.05^2} = \\sqrt{0.64 + 0.04 + 0.0025} = \\sqrt{0.6825}.\n$$\n因为$0.8^2 = 0.64$和$0.9^2 = 0.81$，我们有$0.8  \\sqrt{0.6825}  0.9$。更精确地说，$\\sqrt{0.6825} \\approx 0.826$。\n由于$\\|r\\|_2 \\approx 0.826 \\le 1$，所以在$L_2$范数下步长被**接受**。\n- **$L_1$范数：**\n$$\n\\|r\\|_1 = |r_1| + |r_2| + |r_3| = 0.8 + 0.2 + 0.05 = 1.05.\n$$\n因为$\\|r\\|_1 = 1.05  1$，所以在$L_1$范数下步长被**拒绝**。\n\n总结来说，在$L_\\infty$和$L_2$范数下步长被接受，但在$L_1$范数下被拒绝。\n\n**4. 新步长$h_{\\mathrm{new}}$的排序**\n新步长的公式是$h_{\\mathrm{new}} = \\eta\\, h\\, \\|r\\|^{-1/q}$。当$\\eta=0.9$，$h=0.1$和$q=5$时，公式变为$h_{\\mathrm{new}} = 0.09 \\times \\|r\\|^{-1/5}$。\n函数$f(x) = x^{-1/5}$对于正数$x$是一个严格递减函数。因此，更大的范数$\\|r\\|$将导致更小的建议步长$h_{\\mathrm{new}}$。\n我们来比较这三种范数的大小：\n$$\n\\|r\\|_\\infty = 0.8\n$$\n$$\n\\|r\\|_2 = \\sqrt{0.6825} \\approx 0.826\n$$\n$$\n\\|r\\|_1 = 1.05\n$$\n范数的排序是：\n$$\n\\|r\\|_\\infty  \\|r\\|_2  \\|r\\|_1\n$$\n因为$h_{\\mathrm{new}}$是$\\|r\\|$的递减函数，所以新步长的排序将与范数的排序相反：\n$$\nh_{\\mathrm{new}}^{(\\infty)}  h_{\\mathrm{new}}^{(2)}  h_{\\mathrm{new}}^{(1)}\n$$\n这等价于：\n$$\nh_{\\mathrm{new}}^{(1)}  h_{\\mathrm{new}}^{(2)}  h_{\\mathrm{new}}^{(\\infty)}\n$$\n\n### 逐项分析\n\n**A. 在$L_\\infty$和$L_2$范数下步长被接受，但在$L_1$范数下被拒绝；此外，$h_{\\mathrm{new}}^{(1)}  h_{\\mathrm{new}}^{(2)}  h_{\\mathrm{new}}^{(\\infty)}$。**\n- **步长接受情况：** 我的分析表明，在$L_\\infty$和$L_2$范数下步长被接受，但在$L_1$范数下被拒绝。这部分是正确的。\n- **步长排序：** 我的分析表明$h_{\\mathrm{new}}^{(1)}  h_{\\mathrm{new}}^{(2)}  h_{\\mathrm{new}}^{(\\infty)}$。这部分也是正确的。\n- **结论：** **正确**。\n\n**B. 在所有三种范数下步长均被接受；此外，$h_{\\mathrm{new}}^{(\\infty)}  h_{\\mathrm{new}}^{(2)}  h_{\\mathrm{new}}^{(1)}$。**\n- **步长接受情况：** 这是不正确的。在$L_1$范数下步长被拒绝。\n- **步长排序：** 这个排序对应于$\\|r\\|_\\infty  \\|r\\|_2  \\|r\\|_1$，这是不正确的。\n- **结论：** **不正确**。\n\n**C. 在所有三种范数下步长均被拒绝；此外，$h_{\\mathrm{new}}^{(1)} = h_{\\mathrm{new}}^{(2)} = h_{\\mathrm{new}}^{(\\infty)}$。**\n- **步长接受情况：** 这是不正确的。在$L_\\infty$和$L_2$范数下步长被接受。\n- **步长排序：** 仅当$\\|r\\|_1 = \\|r\\|_2 = \\|r\\|_\\infty$时等式才成立，但对于所讨论的向量$r$并非如此。这是不正确的。\n- **结论：** **不正确**。\n\n**D. 仅在$L_1$范数下步长被接受；此外，$h_{\\mathrm{new}}^{(1)}  h_{\\mathrm{new}}^{(2)}  h_{\\mathrm{new}}^{(\\infty)}$。**\n- **步长接受情况：** 这是不正确的。在$L_1$范数下步长被拒绝，而在其他两种范数下被接受。\n- **步长排序：** 排序$h_{\\mathrm{new}}^{(1)}  h_{\\mathrm{new}}^{(2)}  h_{\\mathrm{new}}^{(\\infty)}$等价于$h_{\\mathrm{new}}^{(\\infty)}  h_{\\mathrm{new}}^{(2)}  h_{\\mathrm{new}}^{(1)}$，在对选项B的分析中已经证明这是不正确的。\n- **结论：** **不正确**。", "answer": "$$\\boxed{A}$$", "id": "2372270"}]}