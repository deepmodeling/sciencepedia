{"hands_on_practices": [{"introduction": "多步法，顾名思义，需要利用多个过去的时间点来预测未来。但这带来了一个启动问题：最初的几个点从何而来？本练习将指导你解决这个常见的实际问题，即使用像前向欧拉法这样的单步法来生成亚当斯-巴什福斯（Adams-Bashforth）法所需的初始值。通过这个练习，你将掌握在实践中启动多步法的标准流程。[@problem_id:2152563]", "problem": "考虑以下初值问题 (IVP)：\n$$ y'(t) = -y(t)\\sin(t), \\quad y(0) = 1 $$\n我们希望使用多步法求出 $y(0.3)$ 的一个数值近似解。\n\n您需要使用两步 Adams-Bashforth (AB2) 方法，恒定步长为 $h=0.1$。AB2 方法的公式如下：\n$$ y_{n+1} = y_n + \\frac{h}{2}(3f_n - f_{n-1}) $$\n其中 $t_k = kh$, $y_k \\approx y(t_k)$，且 $f_k = f(t_k, y_k) = -y_k\\sin(t_k)$。\n\n由于 AB2 方法是两步法，它需要两个初始值来启动。使用给定的初始条件 $y_0 = y(0) = 1$，并使用前向欧拉法计算第一个近似值 $y_1 \\approx y(0.1)$：\n$$ y_{n+1} = y_n + h f_n $$\n求出 $y_1$ 后，使用 AB2 方法计算后续步骤，以求得 $y(0.3)$ 的近似值。\n\n计算 $y(0.3)$ 近似值的数值。将最终答案四舍五入到五位有效数字。", "solution": "我们已知初值问题为 $y'(t)=-y(t)\\sin(t)$，其中 $y(0)=1$，步长 $h=0.1$，且 $f(t,y)=-y\\sin(t)$。定义 $t_{k}=kh$，$y_{k}\\approx y(t_{k})$，以及 $f_{k}=f(t_{k},y_{k})$。\n\n首先使用前向欧拉法获得 $y_{1}$：\n$$\ny_{0}=1,\\quad f_{0}=-y_{0}\\sin(0)=0,\\quad y_{1}=y_{0}+h f_{0}=1+0.1\\cdot 0=1.\n$$\n\n现在应用 AB2 方法 $y_{n+1}=y_{n}+\\frac{h}{2}\\left(3f_{n}-f_{n-1}\\right)$。\n\n步进到 $t_{2}=0.2$：\n$$\nf_{1}=-y_{1}\\sin(0.1)=-\\sin(0.1)\\approx -0.0998334166468282,\n$$\n$$\ny_{2}=y_{1}+\\frac{h}{2}\\left(3f_{1}-f_{0}\\right)=1+0.05\\left(3(-0.0998334166468282)-0\\right)\n=1-0.0149750124970242\\approx 0.9850249875029758.\n$$\n\n计算 $f_{2}$：\n$$\nf_{2}=-y_{2}\\sin(0.2)\\approx -0.9850249875029758\\cdot 0.19866933079506122\\approx -0.19569425508362975.\n$$\n\n步进到 $t_{3}=0.3$：\n$$\ny_{3}=y_{2}+\\frac{h}{2}\\left(3f_{2}-f_{1}\\right)\n=0.9850249875029758+0.05\\left(3(-0.19569425508362975)-(-0.0998334166468282)\\right)\n$$\n$$\n=0.9850249875029758+0.05\\left(-0.58708276525088925+0.0998334166468282\\right)\n=0.9850249875029758-0.0243624674302031\\approx 0.9606625200727727.\n$$\n\n因此，$y(0.3)$ 的 AB2 近似值为 $0.9606625200727727$，四舍五入到五位有效数字后为 $0.96066$。", "answer": "$$\\boxed{0.96066}$$", "id": "2152563"}, {"introduction": "我们通常认为高阶数值方法会提供更精确的结果，但这并非总是如此。本练习通过一个精心设计的思想实验，探讨了一个导数不光滑的特殊情况。你将发现，在这种情况下，基于多项式外推的二步亚当斯-巴什福斯法，其表现甚至劣于更简单的前向欧拉法，这突显了理解方法背后假设（如函数光滑性）的重要性。[@problem_id:2152541]", "problem": "考虑由以下常微分方程给出的初值问题：\n$$\n\\frac{dy}{dt} = |t - 1|\n$$\n其初始条件为 $y(0) = 0$。\n\n我们希望使用两种不同的数值方法来近似 $y(2.0)$ 的值，两种方法的步长均为 $h=1.0$。\n\n方法1是前向欧拉（Forward Euler）方法，定义为：\n$y_{n+1} = y_n + h f(t_n, y_n)$。\n\n方法2是两步 Adams-Bashforth (AB2) 方法，定义为：\n$y_{n+1} = y_n + \\frac{h}{2} [3 f(t_n, y_n) - f(t_{n-1}, y_{n-1})]$。\n为了初始化 AB2 方法，第一步的值，即 $y(1.0)$ 的近似值，将使用一步前向欧拉方法计算。\n\n设 $E_{FE}$ 为前向欧拉方法的绝对误差 $|y_{true}(2.0) - y_{approx}^{FE}(2.0)|$，设 $E_{AB2}$ 为两步 Adams-Bashforth 方法的绝对误差 $|y_{true}(2.0) - y_{approx}^{AB2}(2.0)|$。\n\n根据您的计算，以下哪个陈述正确描述了这两个误差之间的关系？\n\nA. $E_{AB2} < E_{FE}$\n\nB. $E_{AB2} = E_{FE}$\n\nC. $E_{AB2} > E_{FE}$\n\nD. 两种方法都是精确的，即 $E_{AB2} = E_{FE} = 0$。\n\nE. Adams-Bashforth 方法不适用，因为函数 $f(t,y)=|t-1|$ 在 $t=1$ 处不可微。", "solution": "我们已知初值问题 $y'(t) = |t - 1|$，其中 $y(0)=0$，并且我们寻求使用步长 $h=1.0$ 计算 $y(2.0)$。\n\n首先，计算在 $t=2$ 时的精确解。由于 $y'(t)=|t-1|$ 仅依赖于 $t$，解即为积分\n$$\ny(t) = \\int_{0}^{t} |s - 1| \\, ds.\n$$\n因此，\n$$\ny(2) = \\int_{0}^{1} (1 - s) \\, ds + \\int_{1}^{2} (s - 1) \\, ds = \\left[ s - \\frac{s^{2}}{2} \\right]_{0}^{1} + \\left[ \\frac{s^{2}}{2} - s \\right]_{1}^{2} = \\frac{1}{2} + \\frac{1}{2} = 1.\n$$\n\n前向欧拉 (FE) 方法，使用步长 $h=1.0$，取 $t_{0}=0$, $t_{1}=1$, $t_{2}=2$ 和 $y_{0}=0$，其更新公式为\n$$\ny_{n+1} = y_{n} + h f(t_{n}, y_{n}), \\quad f(t,y)=|t-1|.\n$$\n从 $t_{0}$ 到 $t_{1}$ 的步骤：\n$$\ny_{1} = y_{0} + 1 \\cdot |0 - 1| = 0 + 1 = 1.\n$$\n从 $t_{1}$ 到 $t_{2}$ 的步骤：\n$$\ny_{2}^{FE} = y_{1} + 1 \\cdot |1 - 1| = 1 + 0 = 1.\n$$\n因此 $y_{approx}^{FE}(2.0)=1$，所以\n$$\nE_{FE} = |y_{true}(2.0) - y_{approx}^{FE}(2.0)| = |1 - 1| = 0.\n$$\n\n两步 Adams-Bashforth (AB2) 方法，通过一步前向欧拉 (FE) 步骤进行初始化。如上所述，FE 初始化得到 $y_{1}=1$。AB2 的更新公式为\n$$\ny_{n+1} = y_{n} + \\frac{h}{2} \\big(3 f(t_{n}, y_{n}) - f(t_{n-1}, y_{n-1}) \\big).\n$$\n对于 $n=1$，有 $h=1$, $t_{1}=1$, $t_{0}=0$，我们得到\n$$\nf(t_{1}, y_{1}) = |1 - 1| = 0, \\quad f(t_{0}, y_{0}) = |0 - 1| = 1,\n$$\n所以\n$$\ny_{2}^{AB2} = y_{1} + \\frac{1}{2} \\big(3 \\cdot 0 - 1 \\big) = 1 - \\frac{1}{2} = \\frac{1}{2}.\n$$\n因此\n$$\nE_{AB2} = |y_{true}(2.0) - y_{approx}^{AB2}(2.0)| = \\left| 1 - \\frac{1}{2} \\right| = \\frac{1}{2}.\n$$\n\n因此，误差满足 $E_{AB2} > E_{FE}$。Adams-Bashforth 方法在这里是适用的，因为它只需要对函数 $f(t,y)$ 进行求值，而 $f(t,y)=|t-1|$ 在所需的点上是连续且有明确定义的；在单一点的不可微性并不妨碍该方法的应用。\n\n正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "2152541"}, {"introduction": "在模拟真实物理或生物系统时，我们经常会遇到“刚性”（stiff）方程，其中系统的不同部分以迥异的时间尺度演化。本练习将深入探讨数值稳定性这一关键概念，指导你如何为一个刚性常微分方程确定亚当斯-巴什福斯法允许的最大步长 $h_{max}$，以防止数值解失控。这是将理论方法应用于复杂现实问题的关键一步。[@problem_id:2152558]", "problem": "一位数值分析师的任务是求解以下一阶常微分方程 (ODE)，该方程模拟了一个包含快速衰减分量和振荡强迫项的系统：\n$$ \\frac{dy}{dt} = -100(y - \\cos(t)) $$\n初始条件为 $y(0) = 1$。\n\n分析师决定采用显式四步 Adams-Bashforth (AB4) 方法。该方法的更新规则如下：\n$$ y_{n+1} = y_n + \\frac{h}{24} (55 f_n - 59 f_{n-1} + 37 f_{n-2} - 9 f_{n-3} ) $$\n其中 $h$ 是步长，$y_k$ 是 $y(t_k)$ 的数值近似值，而 $f_k = \\frac{dy}{dt}\\Big|_{t=t_k, y=y_k}$。\n\n当将此方法应用于标准测试方程 $y'=\\lambda y$（其中 $\\lambda$ 为复常数）时，其稳定性由 $\\mu = h\\lambda$ 必须位于该方法的绝对稳定区域内这一条件决定。对于 AB4 方法，其沿实轴的绝对稳定区间已知约为 $[-0.3, 0]$。\n\n给定 ODE 的刚性主要由其微分方程的齐次部分决定，这种刚性可能会导致数值不稳定性。为防止数值解出现无界增长，所选步长 $h$ 必须确保对应的 $\\mu$ 值落在稳定区间内。\n\n计算在确保计算保持在绝对稳定区域内的前提下，可以使用的最大可能步长 $h_{max}$。将最终答案四舍五入到三位有效数字。", "solution": "我们首先确定控制刚性的分量。给定的 ODE 是\n$$\n\\frac{dy}{dt} = -100\\bigl(y - \\cos(t)\\bigr) = -100\\,y + 100\\cos(t).\n$$\n刚性由齐次部分决定，即\n$$\n\\frac{dy}{dt} = -100\\,y,\n$$\n因此，在线性稳定性分析中，我们与测试方程 $y'=\\lambda y$ 进行比较，并取\n$$\n\\lambda = -100.\n$$\n对于显式四步 Adams-Bashforth (AB4) 方法，其对测试方程 $y'=\\lambda y$ 的绝对稳定性条件是 $\\mu = h\\lambda$ 必须位于该方法的稳定区域内。在实轴上，我们已知其绝对稳定区间约为 $[-0.3, 0]$。因此，对于实负数 $\\lambda$，我们需要满足\n$$\n-0.3 \\leq h\\lambda \\leq 0.\n$$\n代入 $\\lambda=-100$ 得到\n$$\n-0.3 \\leq -100\\,h \\leq 0.\n$$\n不等式两边同乘以 $-1$，不等号方向反转：\n$$\n0.3 \\geq 100\\,h \\geq 0.\n$$\n各项除以 $100$ 得到\n$$\n0.003 \\geq h \\geq 0.\n$$\n因此，为使 $\\mu$ 保持在稳定区间内，所允许的最大步长为\n$$\nh_{\\max} = 0.003.\n$$\n四舍五入到三位有效数字，结果是\n$$\nh_{\\max} = 3.00 \\times 10^{-3}.\n$$", "answer": "$$\\boxed{3.00 \\times 10^{-3}}$$", "id": "2152558"}]}