{"hands_on_practices": [{"introduction": "$\\theta$方法家族是研究数值方法稳定性的一个绝佳起点，因为它统一了多种基本方法。本练习旨在探索参数 $\\theta$ 的取值如何直接决定方法的A-稳定性。通过这个实践，你将建立起对方法构造如何影响其处理刚性问题稳定性的基础理解 [@problem_id:2151760]。", "problem": "考虑由 $y'(t) = f(t, y(t))$ 给定的一阶常微分方程(ODE)的一般初值问题，其初始条件为 $y(t_0) = y_0$。用于近似求解此类问题的一族通用的单步数值方法是 $\\theta$-方法，由以下递推关系定义：\n$$y_{n+1} = y_n + h \\left[ (1-\\theta)f(t_n, y_n) + \\theta f(t_{n+1}, y_{n+1}) \\right]$$\n此处，$y_n$ 是在时间 $t_n = t_0 + nh$ 时 $y(t_n)$ 的数值近似值，$h$ 是恒定步长，而 $\\theta$ 是范围在 $[0, 1]$ 内的一个参数。选择不同的 $\\theta$ 值会得到不同的著名方法，例如显式欧拉法（$\\theta=0$）和隐式欧拉法（$\\theta=1$）。\n\n数值方法的一个关键性质是其稳定性。一个方法被称为 A-稳定，是指当它应用于 Dahlquist 测试方程 $y'(t) = \\lambda y(t)$ 时，对于任意实部为负（$\\text{Re}(\\lambda) < 0$）的复数 $\\lambda$ 以及任意步长 $h > 0$，数值近似序列 $y_n$ 在 $n \\to \\infty$ 时均收敛于零。该条件等价于要求方法的放大因子 $R(z) = y_{n+1}/y_n$（其中 $z = h\\lambda$）对于所有实部 $\\text{Re}(z) < 0$ 的复数 $z$ 都满足 $|R(z)| \\le 1$。\n\n对于 $\\theta \\in [0, 1]$ 的 $\\theta$-方法族，确定能确保该方法 A-稳定的参数 $\\theta$ 的完整取值范围。\n\nA. $\\theta \\in [0, 1/2)$\n\nB. $\\theta \\in [1/2, 1]$\n\nC. $\\theta \\in (1/2, 1]$\n\nD. $\\theta = 1/2$ only\n\nE. $\\theta = 1$ only", "solution": "将 $\\theta$-方法应用于 Dahlquist 测试方程 $y'(t)=\\lambda y(t)$，其中 $z=h\\lambda$。递推关系变为\n$$\ny_{n+1}=y_n+h\\left[(1-\\theta)\\lambda y_n+\\theta\\lambda y_{n+1}\\right].\n$$\n合并关于 $y_{n+1}$ 的项，得到\n$$\n(1-\\theta z)y_{n+1}=(1+(1-\\theta)z)y_n,\n$$\n因此，放大因子为\n$$\nR(z)=\\frac{y_{n+1}}{y_n}=\\frac{1+(1-\\theta)z}{1-\\theta z}.\n$$\nA-稳定性要求对于所有 $\\Re(z)<0$ 的 $z$，都有 $|R(z)|\\le 1$。这等价于\n$$\n|1+(1-\\theta)z|^2\\le |1-\\theta z|^2\\quad\\text{for all }z=x+\\mathrm{i}y\\text{ with }x<0.\n$$\n令 $a=1-\\theta$ 和 $b=\\theta$。则\n$$\n|1+az|^2=(1+ax)^2+(ay)^2=1+2ax+a^2(x^2+y^2),\n$$\n$$\n|1-bz|^2=(1-bx)^2+(by)^2=1-2bx+b^2(x^2+y^2).\n$$\n因此，该不等式变为\n$$\n1+2ax+a^2(x^2+y^2)\\le 1-2bx+b^2(x^2+y^2),\n$$\n可简化为\n$$\n2(a+b)x\\le (b^2-a^2)(x^2+y^2).\n$$\n由于 $a+b=1$ 且 $b^2-a^2=(\\theta^2-(1-\\theta)^2)=2\\theta-1$，我们得到\n$$\n2x\\le (2\\theta-1)(x^2+y^2)\\quad\\text{for all }x<0,\\;y\\in\\mathbb{R}.\n$$\n设 $s=2\\theta-1$。考虑以下三种情况：\n\n1) 若 $s<0$（即 $\\theta<\\frac{1}{2}$），则对于任意固定的 $x<0$，当 $|y|\\to\\infty$ 时，右侧 $s(x^2+y^2)\\to -\\infty$，因此对于足够大的 $|y|$，该不等式不成立。故该方法不是 A-稳定的。\n\n2) 若 $s=0$（即 $\\theta=\\frac{1}{2}$），不等式简化为 $2x\\le 0$，这对所有 $x<0$ 都成立。故该方法是 A-稳定的。\n\n3) 若 $s>0$（即 $\\theta>\\frac{1}{2}$），则对于固定的 $x<0$，不等式右侧在 $y=0$ 时取最小值，因此只需检验\n$$\n2x\\le s x^2\\quad\\text{for all }x<0.\n$$\n这等价于 $s x^2-2x=x(sx-2)\\ge 0$。由于 $x<0$ 且 $sx-2<0$，它们的乘积为非负数，因此该不等式对所有 $x<0$ 成立，进而对所有 $y$ 也成立。故该方法是 A-稳定的。\n\n综合以上情况，A-稳定性成立的充要条件是 $2\\theta-1\\ge 0$，即 $\\theta\\in\\left[\\frac{1}{2},1\\right]$。在所给选项中，这对应于选项B。", "answer": "$$\\boxed{B}$$", "id": "2151760"}, {"introduction": "在掌握了A-稳定性的概念之后，我们引入一个更强的稳定性条件——L-稳定性，它对于处理极端刚性问题至关重要。这个练习将要求你运用A-稳定性和L-稳定性的数学定义，去分析一个给定的假设方法。这有助于你区分这两种稳定性，并提升你的分析能力 [@problem_id:2151768]。", "problem": "在分析求解常微分方程 (ODEs) 的数值方法时，方法的稳定性是一个关键性质。这通常通过将该方法应用于 Dahlquist 测试方程 $y' = \\lambda y$ 来研究，其中 $\\lambda$ 是一个满足 $\\text{Re}(\\lambda) \\leq 0$ 的复数。该分析会得到一个稳定性函数 $R(z)$，其中 $z = h\\lambda$ 且 $h$ 是步长。$R(z)$ 的行为决定了该方法的稳定性性质。\n\n两个重要的稳定性性质是 A-稳定性和 L-稳定性：\n1.  如果一个方法的绝对稳定区域包含整个复平面的左半平面，则该方法是 **A-稳定**的。对于一个具有有理稳定性函数 $R(z)$ 的方法，这等价于条件 $|R(z)| \\leq 1$ 对所有满足 $\\text{Re}(z) \\leq 0$ 的复数 $z$ 成立。\n2.  如果一个方法是 A-稳定的，并且其稳定性函数还满足条件 $\\lim_{z \\to \\infty} R(z) = 0$，则该方法是 **L-稳定**的。\n\n考虑一个假设的单步数值方法，其稳定性函数由以下有理函数给出：\n$$\nR(z) = \\frac{1+\\frac{1}{3}z}{1-\\frac{2}{3}z}\n$$\n\n根据所提供的定义，判断该方法的稳定性性质。\n\nA. 该方法是 A-稳定的，但不是 L-稳定的。\n\nB. 该方法是 L-稳定的。\n\nC. 该方法不是 A-稳定的。\n\nD. 该方法既不是 A-稳定的，也不是 L-稳定的。", "solution": "给定的稳定性函数为\n$$\nR(z) = \\frac{1+\\frac{1}{3}z}{1-\\frac{2}{3}z}.\n$$\nA-稳定性要求绝对稳定区域\n$$\nS=\\{z\\in\\mathbb{C}:\\,|R(z)|\\leq 1\\}\n$$\n包含整个左半平面 $\\{z:\\,\\text{Re}(z)\\leq 0\\}$。我们通过求解以下不等式来分析 $S$：\n$$\n\\left|\\frac{1+\\frac{1}{3}z}{1-\\frac{2}{3}z}\\right|\\leq 1\n\\quad\\Longleftrightarrow\\quad\n\\left|1+\\frac{1}{3}z\\right|\\leq\\left|1-\\frac{2}{3}z\\right|.\n$$\n令 $z=x+iy$，其中 $x,y\\in\\mathbb{R}$。对于实数 $\\alpha$，使用 $|1+\\alpha z|^{2}=(1+\\alpha x)^{2}+(\\alpha y)^{2}$，我们计算可得\n$$\n\\left|1+\\frac{1}{3}z\\right|^{2}=1+\\frac{2}{3}x+\\frac{1}{9}(x^{2}+y^{2}),\\qquad\n\\left|1-\\frac{2}{3}z\\right|^{2}=1-\\frac{4}{3}x+\\frac{4}{9}(x^{2}+y^{2}).\n$$\n因此\n$$\n1+\\frac{2}{3}x+\\frac{1}{9}(x^{2}+y^{2}) \\leq 1-\\frac{4}{3}x+\\frac{4}{9}(x^{2}+y^{2}).\n$$\n消去 $1$ 并合并同类项得到\n$$\n\\frac{2}{3}x+\\frac{1}{9}(x^{2}+y^{2}) \\leq -\\frac{4}{3}x+\\frac{4}{9}(x^{2}+y^{2}),\n$$\n$$\n\\frac{2}{3}x+\\frac{4}{3}x \\leq \\frac{4}{9}(x^{2}+y^{2})-\\frac{1}{9}(x^{2}+y^{2}),\n$$\n$$\n2x \\leq \\frac{1}{3}(x^{2}+y^{2}).\n$$\n两边乘以 $3$ 并整理可得\n$$\n6x \\leq x^{2}+y^{2}\\quad\\Longleftrightarrow\\quad x^{2}+y^{2}-6x \\geq 0.\n$$\n配方后，\n$$\n(x-3)^{2}+y^{2} \\geq 9.\n$$\n因此，绝对稳定区域 $S$ 是以 $(3,0)$ 为圆心、半径为 $3$ 的圆的外部（包括边界）。对于任何满足 $\\text{Re}(z)=x\\leq 0$ 的 $z$，我们有 $(x-3)^{2}\\geq 9$，因此 $(x-3)^{2}+y^{2}\\geq 9$，所以所有这样的 $z$ 都位于 $S$ 中。因此，整个左半平面都包含在内，故该方法是 A-稳定的。\n\n为了检验 L-稳定性，我们计算当 $z\\to\\infty$ 时 $R(z)$ 的极限。由于分子和分母的次数相同，该极限是最高次项系数之比：\n$$\n\\lim_{z\\to\\infty}R(z)=\\lim_{z\\to\\infty}\\frac{\\frac{1}{3}z}{-\\frac{2}{3}z}=-\\frac{1}{2}\\neq 0.\n$$\n因此，该方法不是 L-稳定的。\n\n综合这些结果，该方法是 A-稳定的但不是 L-稳定的，这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "2151768"}, {"introduction": "理论与实践在本练习中交汇。通过将一个仅为A-稳定的方法和一个L-稳定的方法应用于一个典型的刚性方程，并使用较大的步长，你将直接观察到它们在数值行为上的显著差异。这个计算生动地揭示了为何L-稳定性是获得有意义数值解的关键性质，而不仅仅是一个理论上的概念 [@problem_id:2151749]。", "problem": "考虑一个刚性初值问题 (IVP)，其微分方程为 $y'(t) = -1000 y(t)$，初始条件为 $y(0) = 1$。我们希望使用两种不同的隐式单步数值方法来近似求解。\n\n第一种方法，我们称之为方法 A，由以下递推关系定义：\n$$y_{n+1} = y_n + \\frac{h}{2} (f(t_n, y_n) + f(t_{n+1}, y_{n+1}))$$\n其中 $h$ 是步长，$f(t, y) = y'(t)$。\n\n第二种方法，方法 B，由以下递推关系定义：\n$$y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})$$\n\n使用大小为 $h=0.1$ 的单步，计算在时间 $t_1 = 0.1$ 时解的第一次步进近似值 $y_1$。设方法 A 的结果为 $y_{1,A}$，方法 B 的结果为 $y_{1,B}$。\n\n将您的答案表示为一个包含两个值 $(y_{1,A}, y_{1,B})$ 的行矩阵。将最终答案中的两个数值四舍五入到三位有效数字。", "solution": "我们已知刚性初值问题为 $y'(t) = -1000\\,y(t)$，其中 $y(0)=1$ 且步长 $h=0.1$。令 $f(t,y)=-1000\\,y$。\n\n对于方法 A（隐式梯形法则），单步更新公式为\n$$\ny_{1} = y_{0} + \\frac{h}{2}\\left(f(t_{0},y_{0}) + f(t_{1},y_{1})\\right).\n$$\n代入 $f(t,y)=-1000\\,y$ 得\n$$\ny_{1} = y_{0} + \\frac{h}{2}\\left(-1000\\,y_{0} - 1000\\,y_{1}\\right)\n= y_{0} - 500\\,h\\,(y_{0} + y_{1}).\n$$\n移项整理得，\n$$\ny_{1} + 500\\,h\\,y_{1} = y_{0} - 500\\,h\\,y_{0},\n$$\n所以\n$$\ny_{1}(1 + 500\\,h) = y_{0}(1 - 500\\,h),\n$$\n因此\n$$\ny_{1} = \\frac{1 - 500\\,h}{1 + 500\\,h}\\,y_{0}.\n$$\n当 $h=0.1$ 和 $y_{0}=1$ 时，\n$$\ny_{1,A} = \\frac{1 - 50}{1 + 50} = -\\frac{49}{51} \\approx -0.960784\\ldots,\n$$\n四舍五入到三位有效数字为 $-0.961$。\n\n对于方法 B（向后欧拉法），单步更新公式为\n$$\ny_{1} = y_{0} + h\\,f(t_{1},y_{1}) = y_{0} - 1000\\,h\\,y_{1}.\n$$\n移项整理得，\n$$\ny_{1} + 1000\\,h\\,y_{1} = y_{0} \\quad \\Rightarrow \\quad y_{1}(1 + 1000\\,h) = y_{0},\n$$\n因此\n$$\ny_{1} = \\frac{y_{0}}{1 + 1000\\,h}.\n$$\n当 $h=0.1$ 和 $y_{0}=1$ 时，\n$$\ny_{1,B} = \\frac{1}{1 + 100} = \\frac{1}{101} \\approx 0.00990099\\ldots,\n$$\n四舍五入到三位有效数字为 $0.00990$。\n\n因此，所求的行矩阵是 $\\begin{pmatrix} y_{1,A} & y_{1,B} \\end{pmatrix} = \\begin{pmatrix} -0.961 & 0.00990 \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix}-0.961 & 0.00990\\end{pmatrix}}$$", "id": "2151749"}]}