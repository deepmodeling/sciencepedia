{"hands_on_practices": [{"introduction": "要掌握样条插值，最好的起点是理解其最基本的形式：线性样条。这个练习将指导您通过一个简单的过程，即用直线段连接离散的数据点，从而构建一个连续的分段函数。通过解决这个问题 [@problem_id:2185130]，您将练习从给定的数据点推导出特定区间内线性样条的数学表达式，这是理解更复杂样条结构的基础。", "problem": "一位科学家正在为一根细金属棒的温度分布建模。在三个不同的点上进行了温度测量。在位置 $x=0$ 米处，温度为1摄氏度。在位置 $x=1$ 米处，温度为4摄氏度。在位置 $x=2$ 米处，温度为2摄氏度。\n\n为了创建一个简单的连续温度模型，使用这三个数据点 $(0, 1)$、$(1, 4)$ 和 $(2, 2)$ 构建了一个线性样条。\n\n设 $S(x)$ 表示该线性样条函数。确定在区间 $[1, 2]$ 上有效的样条段的解析表达式，我们称其为 $S_1(x)$，其中 $x$ 是以米为单位的位置。", "solution": "线性样条是一个通过用直线段连接一系列数据点而构建的函数。每一段都是在一个特定区间上有效的线性函数。我们已知数据点 $(x_0, y_0) = (0, 1)$、$(x_1, y_1) = (1, 4)$ 和 $(x_2, y_2) = (2, 2)$。\n\n问题要求解在区间 $[1, 2]$ 上的样条段的解析表达式。这个区间由点 $(x_1, y_1) = (1, 4)$ 和 $(x_2, y_2) = (2, 2)$ 定义。样条段 $S_1(x)$ 就是穿过这两点的直线方程。\n\n我们可以使用点斜式 $y - y_a = m(x - x_a)$ 来求直线方程，其中 $m$ 是斜率，$(x_a, y_a)$ 是直线上的一个点。\n\n首先，我们计算连接 $(1, 4)$ 和 $(2, 2)$ 的线段的斜率 $m$：\n$$m = \\frac{y_2 - y_1}{x_2 - x_1}$$\n代入点的坐标：\n$$m = \\frac{2 - 4}{2 - 1} = \\frac{-2}{1} = -2$$\n\n现在我们使用斜率 $m=-2$ 和其中一个点，例如 $(x_1, y_1) = (1, 4)$，来应用点斜式。样条段 $S_1(x)$ 的方程为：\n$$S_1(x) - y_1 = m(x - x_1)$$\n$$S_1(x) - 4 = -2(x - 1)$$\n\n为了求出 $S_1(x)$ 的显式表达式，我们将其移到方程的一边：\n$$S_1(x) = -2(x - 1) + 4$$\n分配 $-2$：\n$$S_1(x) = -2x + 2 + 4$$\n合并常数项：\n$$S_1(x) = -2x + 6$$\n\n这就是该样条段在区间 $[1, 2]$ 上有效的解析表达式。我们可以用另一个点 $(2, 2)$ 来验证这个结果：\n$$S_1(2) = -2(2) + 6 = -4 + 6 = 2$$\n由于当 $x=2$ 时，函数值正确地等于 $y=2$，因此我们的表达式是正确的。", "answer": "$$\\boxed{-2x + 6}$$", "id": "2185130"}, {"introduction": "虽然线性样条是连续的，但它们在连接点（节点）处存在尖角，这意味着它们的一阶导数不连续。为了构建更平滑的曲线，我们转向二次样条，它要求在内部节点处一阶导数必须连续。本练习 [@problem_id:2185128] 将引导您构建一个二次样条，您需要应用插值条件、一阶导数连续性以及一个额外的边界条件来唯一确定样条的系数。", "problem": "二次样条 $S(x)$ 用于为一系列路径点建立平滑路径模型。该样条由分段二次多项式组成。对于一组节点 $x_0 < x_1 < \\dots < x_n$，在每个子区间 $[x_i, x_{i+1}]$ 上的样条由一个二次多项式 $S_i(x) = a_i(x-x_i)^2 + b_i(x-x_i) + c_i$ 表示。\n\n考虑一条必须穿过三个路径点 $(x_0, y_0) = (0, 1)$、$(x_1, y_1) = (1, 2)$ 和 $(x_2, y_2) = (2, 0)$ 的路径。该路径由一个包含两部分的二次样条 $S(x)$ 定义：$S_0(x)$ 在区间 $[0, 1]$ 上，以及 $S_1(x)$ 在区间 $[1, 2]$ 上。\n\n该样条必须满足以下条件：\n1.  它必须对路径点进行插值，即对于 $i=0, 1, 2$，有 $S(x_i) = y_i$。\n2.  该样条在内部节点 $x_1$ 处必须具有连续的一阶导数，即 $S'_0(x_1) = S'_1(x_1)$。\n3.  施加一个“自然”起始条件，使得在起点处的二阶导数为零：$S''(0) = 0$。\n\n确定样条第二段 $S_1(x)$（定义在 $x \\in [1, 2]$ 上）的系数 $(a_1, b_1, c_1)$。将答案以 $(a_1, b_1, c_1)$ 的顺序表示为一组三个数值。", "solution": "我们将每个分段建模为 $S_i(x)=a_i(x-x_i)^2+b_i(x-x_i)+c_i$。\n\n对于在 $[0,1]$ 上的第一段，$S_0(x)=a_0x^2+b_0x+c_0$。\n自然条件 $S''(0)=0$ 意味着 $S_0''(x)=2a_0$，因此\n$$2a_0=0 \\Rightarrow a_0=0$$\n在 $x=0$ 处的插值条件给出 $S_0(0)=c_0=1$，所以\n$$c_0=1$$\n在 $x=1$ 处的插值条件给出 $S_0(1)=a_0\\cdot 1^2+b_0\\cdot 1+c_0=2$，因此\n$$0+b_0+1=2 \\Rightarrow b_0=1$$\n因此 $S_0'(x)=2a_0(x-0)+b_0=b_0=1$，所以\n$$S'_0(1)=1$$\n\n对于在 $[1,2]$ 上的第二段，$S_1(x)=a_1(x-1)^2+b_1(x-1)+c_1$。\n在 $x=1$ 处的插值条件给出\n$$S_1(1)=c_1=2 \\Rightarrow c_1=2$$\n在 $x=2$ 处的插值条件给出\n$$S_1(2)=a_1\\cdot 1^2+b_1\\cdot 1+c_1=0 \\Rightarrow a_1+b_1+2=0 \\Rightarrow a_1+b_1=-2$$\n在 $x=1$ 处的导数连续性要求 $S'_0(1)=S'_1(1)$。由于 $S'_1(x)=2a_1(x-1)+b_1$，我们有\n$$S'_1(1)=b_1=S'_0(1)=1 \\Rightarrow b_1=1$$\n代入 $a_1+b_1=-2$ 得到\n$$a_1+1=-2 \\Rightarrow a_1=-3$$\n结合 $c_1=2$，$S_1$ 的系数为 $(a_1,b_1,c_1)=(-3,1,2)$。", "answer": "$$\\boxed{\\begin{pmatrix}-3 & 1 & 2\\end{pmatrix}}$$", "id": "2185128"}, {"introduction": "样条不仅用于数据插值，更是一种强大的分析工具，能够将离散数据转化为可微的函数模型，用于解决实际的优化问题。在这个综合性练习 [@problem_id:2185163] 中，您将为一个模拟太阳能系统功率输出的场景构建一个二次样条模型。完成样条构建后，您需要运用微积分知识来分析这个分段函数，以确定其在整个时间区间内的最大功率输出，这充分展示了样条在工程和科学领域的实际应用价值。", "problem": "微电网功率管理系统（MPMS）用于对一个小型太阳能系统在8小时周期内（从 $t=0$ 即工作日开始，到 $t=8$ 小时）的净功率输出进行建模。为从离散测量值创建一个连续功率模型 $P(t)$，构造了一个二次样条插值 $S(t)$。\n\n该样条定义在区间 $[0, 8]$ 上，节点位于 $t_0=0, t_1=3, t_2=5,$ 和 $t_3=8$。在这些节点上测得的功率值（单位：千瓦，kW）为：\n$P(0) = 10$\n$P(3) = 80$\n$P(5) = 90$\n$P(8) = 45$\n\n二次样条 $S(t)$ 由三个二次多项式 $S_0(t)$、$S_1(t)$ 和 $S_2(t)$ 组成，分别对应区间 $[0, 3]$、$3, 5]$ 和 $[5, 8]$。样条的构建遵循以下规则：\n1. 插值性：样条必须穿过所有测量数据点，即对 $i=0, 1, 2, 3$ 都有 $S(t_i) = P(t_i)$。\n2. 光滑性：样条必须在内部节点（$t=3$ 和 $t=5$）处具有连续的一阶导数 $S'(t)$。\n3. 边界条件：已知在周期开始时，功率以每小时20千瓦的速率增加，即 $S'(0) = 20$。\n\n你的任务是分析这个功率模型。确定最大功率出现的时间 $t_{max}$（单位：小时）和最大功率值 $P_{max}$（单位：千瓦）。将两个值都四舍五入到四位有效数字。", "solution": "二次样条 $S(t)$ 是分段定义的。对于每个子区间 $[t_i, t_{i+1}]$，对应的分段 $S_i(t)$ 可以写成以下形式：\n$$S_i(t) = a_i (t-t_i)^2 + b_i(t-t_i) + c_i$$\n这种形式很方便，因为系数具有直接的含义：$c_i = S_i(t_i)$ 且 $b_i = S'_i(t_i)$。\n\n**第1步：确定样条系数。**\n给定节点 $t_0=0, t_1=3, t_2=5, t_3=8$ 和对应的值 $y_0=10, y_1=80, y_2=90, y_3=45$。区间长度为 $h_0=t_1-t_0=3$，$h_1=t_2-t_1=2$ 和 $h_2=t_3-t_2=3$。\n\n根据插值条件 $S(t_i)=y_i$ 和 $S_i(t)$ 的形式，我们立即得到 $c_i = S_i(t_i) = y_i$。\n因此，$c_0 = y_0 = 10$，$c_1 = y_1 = 80$，$c_2 = y_2 = 90$。\n\n根据导数连续性条件 $S'_i(t_i) = b_i$，我们可以为系数 $b_i$ 建立一个递推关系。每段的导数为 $S'_i(t) = 2a_i(t-t_i) + b_i$。\n样条函数本身的连续性要求 $S_i(t_{i+1}) = y_{i+1}$。\n$$a_i h_i^2 + b_i h_i + c_i = y_{i+1} \\implies a_i = \\frac{y_{i+1} - y_i - b_i h_i}{h_i^2}$$\n在内部节点 $t_i$ 处一阶导数的连续性意味着 $S'_{i-1}(t_i) = S'_i(t_i)$。\n在区间 $i-1$ 右端的导数为 $S'_{i-1}(t_i) = 2a_{i-1}(t_i - t_{i-1}) + b_{i-1} = 2a_{i-1}h_{i-1} + b_{i-1}$。\n在区间 $i$ 左端的导数为 $S'_i(t_i) = b_i$。\n因此，$b_i = 2a_{i-1}h_{i-1} + b_{i-1}$。\n代入 $a_{i-1}$ 的表达式：\n$$b_i = 2 \\left( \\frac{y_i - y_{i-1} - b_{i-1}h_{i-1}}{h_{i-1}^2} \\right) h_{i-1} + b_{i-1}$$\n$$b_i = \\frac{2(y_i - y_{i-1})}{h_{i-1}} - 2b_{i-1} + b_{i-1}$$\n这可以简化为递推关系：$b_i + b_{i-1} = \\frac{2(y_i - y_{i-1})}{h_{i-1}}$。\n\n我们已知边界条件 $S'(0) = 20$。由于 $t_0=0$，这意味着 $b_0 = S'_0(t_0) = 20$。\n现在我们可以求出其他的 $b_i$ 系数：\n对于 $i=1$（在节点 $t_1=3$ 处）：\n$$b_1 + b_0 = \\frac{2(y_1 - y_0)}{h_0} \\implies b_1 + 20 = \\frac{2(80-10)}{3} = \\frac{140}{3}$$\n$$b_1 = \\frac{140}{3} - 20 = \\frac{140-60}{3} = \\frac{80}{3}$$\n\n对于 $i=2$（在节点 $t_2=5$ 处）：\n$$b_2 + b_1 = \\frac{2(y_2 - y_1)}{h_1} \\implies b_2 + \\frac{80}{3} = \\frac{2(90-80)}{2} = 10$$\n$$b_2 = 10 - \\frac{80}{3} = \\frac{30-80}{3} = -\\frac{50}{3}$$\n\n现在我们求出剩余的 $a_i$ 系数：\n$$a_0 = \\frac{y_1 - y_0 - b_0 h_0}{h_0^2} = \\frac{80-10 - 20(3)}{3^2} = \\frac{70-60}{9} = \\frac{10}{9}$$\n$$a_1 = \\frac{y_2 - y_1 - b_1 h_1}{h_1^2} = \\frac{90-80 - (\\frac{80}{3})(2)}{2^2} = \\frac{10 - \\frac{160}{3}}{4} = \\frac{\\frac{30-160}{3}}{4} = \\frac{-130/3}{4} = -\\frac{130}{12} = -\\frac{65}{6}$$\n$$a_2 = \\frac{y_3 - y_2 - b_2 h_2}{h_2^2} = \\frac{45-90 - (-\\frac{50}{3})(3)}{3^2} = \\frac{-45 + 50}{9} = \\frac{5}{9}$$\n\n**第2步：找到 S(t) 在 [0, 8] 上的全局最大值。**\n全局最大值必定出现在区间 $[0, 8]$ 的端点，或者导数为零的内部点。最大值的候选点是：\n1. 整个区间的端点：$t=0$ 和 $t=8$。\n2. 定义多项式发生变化的内部节点：$t=3$ 和 $t=5$。\n3. 每个二次分段的临界点，如果这些点落在它们各自的子区间内。\n\n端点和节点处的值是已知的：\n$P(0) = 10$，$P(3) = 80$，$P(5) = 90$，$P(8) = 45$。\n\n现在，我们通过令导数为零来检查每个分段内的临界点。\n对于在 $[0, 3]$ 上的 $S_0(t)$：\n$S'_0(t) = 2a_0(t-t_0) + b_0 = 2(\\frac{10}{9})t + 20$。令 $S'_0(t)=0$ 得 $t = -9$，这在区间 $[0, 3]$ 之外。由于 $a_0 > 0$，抛物线开口向上，因此此子区间上的最大值出现在右端点，即 $P(3)=80$。\n\n对于在 $[3, 5]$ 上的 $S_1(t)$：\n$S'_1(t) = 2a_1(t-t_1) + b_1 = 2(-\\frac{65}{6})(t-3) + \\frac{80}{3} = -\\frac{65}{3}(t-3) + \\frac{80}{3}$。\n令 $S'_1(t)=0$：\n$$-\\frac{65}{3}(t-3) = -\\frac{80}{3} \\implies 65(t-3) = 80 \\implies t-3 = \\frac{80}{65} = \\frac{16}{13}$$\n$$t_{crit} = 3 + \\frac{16}{13} = \\frac{39+16}{13} = \\frac{55}{13}$$\n这个时间点在区间 $[3, 5]$ 内，因为 $3 < 55/13 \\approx 4.23 < 5$。由于 $a_1 = -65/6 < 0$，抛物线开口向下，所以这个临界点是一个局部最大值。我们计算其值：\n$P_{crit} = S_1(\\frac{55}{13}) = a_1(\\frac{16}{13})^2 + b_1(\\frac{16}{13}) + c_1 = -\\frac{65}{6}(\\frac{16}{13})^2 + \\frac{80}{3}(\\frac{16}{13}) + 80$\n$P_{crit} = -\\frac{65}{6}\\frac{256}{169} + \\frac{1280}{39} + 80 = -\\frac{5 \\cdot 13}{2 \\cdot 3}\\frac{256}{13^2} + \\frac{1280}{39} + 80$\n$P_{crit} = -\\frac{5 \\cdot 256}{78} + \\frac{1280}{39} + 80 = -\\frac{640}{39} + \\frac{1280}{39} + \\frac{3120}{39} = \\frac{640+3120}{39} = \\frac{3760}{39}$。\n\n对于在 $[5, 8]$ 上的 $S_2(t)$：\n$S'_2(t) = 2a_2(t-t_2) + b_2 = 2(\\frac{5}{9})(t-5) - \\frac{50}{3} = \\frac{10}{9}(t-5) - \\frac{50}{3}$。\n令 $S'_2(t)=0$：$\\frac{10}{9}(t-5) = \\frac{50}{3} \\implies t-5 = \\frac{50}{3} \\cdot \\frac{9}{10} = 15$。\n$t=20$，这在区间 $[5, 8]$ 之外。由于 $a_2 > 0$，这个抛物线开口向上，所以它在此子区间上的最大值位于一个端点处，即 $P(5)=90$。\n\n**第3步：比较候选值并确定全局最大值。**\n最大功率的候选值有：\n$P(0) = 10$\n$P(3) = 80$\n$P(5) = 90$\n$P(8) = 45$\n$P(55/13) = \\frac{3760}{39} \\approx 96.410256...$\n\n比较这些值，全局最大值为 $P_{max} = \\frac{3760}{39}$，出现在 $t_{max} = \\frac{55}{13}$。\n\n**第4步：格式化最终答案。**\n题目要求将数值四舍五入到四位有效数字。\n$t_{max} = \\frac{55}{13} \\approx 4.230769...$\n四舍五入到四位有效数字得到 $t_{max} = 4.231$。\n\n$P_{max} = \\frac{3760}{39} \\approx 96.410256...$\n四舍五入到四位有效数字得到 $P_{max} = 96.41$。", "answer": "$$\\boxed{\\begin{pmatrix} 4.231 & 96.41 \\end{pmatrix}}$$", "id": "2185163"}]}