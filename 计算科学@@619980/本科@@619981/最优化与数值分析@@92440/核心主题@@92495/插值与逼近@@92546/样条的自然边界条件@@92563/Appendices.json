{"hands_on_practices": [{"introduction": "构建自然三次样条的核心是求解每个内部节点上的二阶导数值。第一个练习提供了一个直接的动手实践机会，让您应用其基本公式。通过为一组特定的数据点建立线性方程组，您将巩固对样条插值背后机理的理解 [@problem_id:2193878]。", "problem": "在计算建模中，立方样条是一种强大的工具，用于通过一条平滑的曲线对一组数据点进行插值。如果一个函数 $s(x)$ 是一个分段三次多项式，它穿过所有 $n+1$ 个数据点 $(x_0, y_0), (x_1, y_1), \\dots, (x_n, y_n)$，并且在内部点 $x_1, \\dots, x_{n-1}$ 处具有连续的一阶和二阶导数，那么该函数 $s(x)$ 就是一个对这些数据点进行插值的立方样条。\n\n令 $M_i = s''(x_i)$ 为样条在点 $x_i$ 处的二阶导数，令 $h_i = x_{i+1} - x_i$ 为连续点之间的间距。内部点（$i=1, \\dots, n-1$）的 $M_i$ 值通过以下线性方程组相关联：\n$$ \\frac{h_{i-1}}{6} M_{i-1} + \\frac{h_{i-1} + h_i}{3} M_i + \\frac{h_i}{6} M_{i+1} = \\frac{y_{i+1} - y_i}{h_i} - \\frac{y_i - y_{i-1}}{h_{i-1}} $$\n“自然”立方样条由附加的边界条件 $M_0 = 0$ 和 $M_n = 0$ 定义。这些条件在物理上对应于柔性梁的两端不受弯矩作用。\n\n考虑寻找一个自然立方样条来插值以下四个数据点：$(0, 1)$、$(1, 3)$、$(3, 2)$ 和 $(4, 4)$。这些条件导出了一组关于未知内部二阶导数 $M_1$ 和 $M_2$ 的线性方程组。该方程组可以写成矩阵形式 $A \\mathbf{M} = \\mathbf{b}$，其中 $\\mathbf{M} = \\begin{pmatrix} M_1 \\\\ M_2 \\end{pmatrix}$，$A$ 是一个 $2 \\times 2$ 的系数矩阵，$\\mathbf{b}$ 是一个 $2 \\times 1$ 的常数向量。\n\n确定矩阵 $A = \\begin{pmatrix} a_{11} & a_{12} \\\\ a_{21} & a_{22} \\end{pmatrix}$ 和向量 $\\mathbf{b} = \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$ 中各元素的数值。将您的最终答案表示为一个单行矩阵，按顺序包含六个值 $(a_{11}, a_{12}, a_{21}, a_{22}, b_1, b_2)$。将所有值表示为精确分数或整数。", "solution": "给定内部点的立方样条三对角关系式：\n$$\\frac{h_{i-1}}{6}M_{i-1}+\\frac{h_{i-1}+h_{i}}{3}M_{i}+\\frac{h_{i}}{6}M_{i+1}=\\frac{y_{i+1}-y_{i}}{h_{i}}-\\frac{y_{i}-y_{i-1}}{h_{i-1}},$$\n对于点 $(x_{0},y_{0})=(0,1)$、$(x_{1},y_{1})=(1,3)$、$(x_{2},y_{2})=(3,2)$ 和 $(x_{3},y_{3})=(4,4)$，其自然边界条件为 $M_{0}=0$ 和 $M_{3}=0$。\n\n首先计算间距：\n$$h_{0}=x_{1}-x_{0}=1,\\quad h_{1}=x_{2}-x_{1}=2,\\quad h_{2}=x_{3}-x_{2}=1。$$\n\n对于 $i=1$：\n$$\\frac{h_{0}}{6}M_{0}+\\frac{h_{0}+h_{1}}{3}M_{1}+\\frac{h_{1}}{6}M_{2}=\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}。$$\n代入数值：\n$$\\frac{1}{6}M_{0}+\\frac{1+2}{3}M_{1}+\\frac{2}{6}M_{2}=\\frac{2-3}{2}-\\frac{3-1}{1},$$\n$$0+1\\cdot M_{1}+\\frac{1}{3}M_{2}=-\\frac{1}{2}-2=-\\frac{5}{2}。$$\n因此第一行为 $a_{11}=1$，$a_{12}=\\frac{1}{3}$ 且 $b_{1}=-\\frac{5}{2}$。\n\n对于 $i=2$：\n$$\\frac{h_{1}}{6}M_{1}+\\frac{h_{1}+h_{2}}{3}M_{2}+\\frac{h_{2}}{6}M_{3}=\\frac{y_{3}-y_{2}}{h_{2}}-\\frac{y_{2}-y_{1}}{h_{1}}。$$\n代入数值：\n$$\\frac{2}{6}M_{1}+\\frac{2+1}{3}M_{2}+\\frac{1}{6}M_{3}=\\frac{4-2}{1}-\\frac{2-3}{2},$$\n$$\\frac{1}{3}M_{1}+1\\cdot M_{2}+0=2-(-\\frac{1}{2})=\\frac{5}{2}。$$\n因此第二行为 $a_{21}=\\frac{1}{3}$，$a_{22}=1$ 且 $b_{2}=\\frac{5}{2}$。\n\n因此，\n$$A=\\begin{pmatrix}1 & \\frac{1}{3} \\\\ \\frac{1}{3} & 1\\end{pmatrix},\\quad \\mathbf{b}=\\begin{pmatrix}-\\frac{5}{2} \\\\ \\frac{5}{2}\\end{pmatrix},$$\n因此所求的单行矩阵为 $\\begin{pmatrix}1 & \\frac{1}{3} & \\frac{1}{3} & 1 & -\\frac{5}{2} & \\frac{5}{2}\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix}1 & \\frac{1}{3} & \\frac{1}{3} & 1 & -\\frac{5}{2} & \\frac{5}{2}\\end{pmatrix}}$$", "id": "2193878"}, {"introduction": "一旦我们知道如何构建样条，一个自然的问题便是它在节点之间的形状和行为。这个练习挑战您超越纯粹的计算，转而分析所得曲线的几何特性，特别是确定导致局部极值存在的条件。这项实践将样条的代数公式与其视觉上的定性特征联系起来，这是数据建模中的一项关键技能 [@problem_id:2189213]。", "problem": "一个记为 $S(x)$ 的自然三次样条被构建，用于插值三个非共线点 $P_0 = (x_0, y_0)$、$P_1 = (x_1, y_1)$ 和 $P_2 = (x_2, y_2)$。该样条由两段三次多项式组成，一段在区间 $[x_0, x_1]$ 上，另一段在区间 $[x_1, x_2]$ 上，且在连接处平滑连接。“自然”条件指定样条在整个区间的端点处的二阶导数为零，即 $S''(x_0) = 0$ 和 $S''(x_2) = 0$。\n\n考虑一组特定的点 $P_0 = (-1, 1)$、$P_1 = (0, 0)$ 和 $P_2 = (2, c)$，其中 $c$ 是一个实值常数。非共线条件意味着 $c$ 不能取某个特定的值，该值会使 $P_2$ 位于由 $P_0$ 和 $P_1$ 定义的直线上。\n\n确定常数 $c$ 的所有可能值的集合，使得最终得到的自然三次样条 $S(x)$ 在开区间 $(-1, 2)$ 内严格地拥有至少一个局部极值（一个点 $x^*$ 使得 $S'(x^*) = 0$）。\n\n选择描述 $c$ 的取值集合的正确选项。\nA. $c < -14$ 或 $c > -1/2$\n\nB. $-14 < c < -1/2$\n\nC. $c < -2$ 或 $c > -2$\n\nD. $c < -2$ 或 $c > -1/14$\n\nE. 对于任何 $c$ 值，样条在 $(-1, 2)$ 内都没有极值。", "solution": "令 $x_{0}=-1$，$x_{1}=0$，$x_{2}=2$，以及 $y_{0}=1$，$y_{1}=0$，$y_{2}=c$。对于自然三次样条，设 $M_{i}=S''(x_{i})$。自然条件给出 $M_{0}=0$ 和 $M_{2}=0$。关于 $M_{1}$ 的标准三对角方程组是\n$$\nh_{0}M_{0}+2(h_{0}+h_{1})M_{1}+h_{1}M_{2}=6\\left(\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}\\right),\n$$\n其中 $h_{0}=x_{1}-x_{0}=1$ 且 $h_{1}=x_{2}-x_{1}=2$。代入可得\n$$\nM_{0}+6M_{1}+2M_{2}=6\\left(\\frac{c}{2}-(-1)\\right)=3c+6,\n$$\n因此 $6M_{1}=3c+6$，所以\n$$\nM_{1}=1+\\frac{c}{2}=:m.\n$$\n\n在 $[x_{0},x_{1}]$ 上，使用标准的三次样条形式，其中 $h=1$，$M_{0}=0$，$M_{1}=m$，$y_{0}=1$，$y_{1}=0$，我们得到\n$$\nS_{0}(x)=\\frac{m}{6}(x+1)^{3}-x-\\frac{m}{6}(x+1),\n$$\n所以\n$$\nS_{0}'(x)=\\frac{m}{6}\\left(3(x+1)^{2}-1\\right)-1=\\frac{m}{2}(x+1)^{2}-\\frac{m}{6}-1.\n$$\n令 $S_{0}'(x)=0$ 得到\n$$\n(x+1)^{2}=\\frac{2}{m}+\\frac{1}{3}=:R_{L}.\n$$\n一个根位于 $(-1,0)$ 内当且仅当 $0<R_{L}<1$，即\n$$\n0<\\frac{2}{m}+\\frac{1}{3}<1.\n$$\n分情况求解：\n\n- 如果 $m>0$，则 $\\frac{2}{m}>0$，因此左侧不等式自动成立；右侧不等式给出 $\\frac{2}{m}<\\frac{2}{3}$，所以 $m>3$，即 $c>4$。当 $m=3$ (即 $c=4$) 时，$R_{L}=1$ 得到 $x=0$，它在 $(-1,2)$ 内，并在节点处给出一个驻点。\n\n- 如果 $m<0$，则 $0<\\frac{2}{m}+\\frac{1}{3}$ 意味着 $\\frac{2}{m}>-\\frac{1}{3}$；两边乘以 $m<0$ 会反转不等号，得到 $2<-\\frac{m}{3}$，即 $m<-6$，等价于 $c<-14$。对于 $m<0$，上界不等式自动成立。\n\n因此，从左区间来看，如果 $c<-14$ 或 $c\\geq 4$ (其中 $c=4$ 产生 $x^{*}=0$)，则存在一个内部驻点。\n\n在 $[x_{1},x_{2}]$ 上，其中 $h=2$，$M_{1}=m$，$M_{2}=0$，$y_{1}=0$，$y_{2}=c$，\n$$\nS_{1}(x)=\\frac{m}{12}(2-x)^{3}-\\frac{m}{3}(2-x)+\\frac{c}{2}x,\n$$\n所以\n$$\nS_{1}'(x)=-\\frac{m}{4}(2-x)^{2}+\\frac{m}{3}+\\frac{c}{2}.\n$$\n令 $S_{1}'(x)=0$ 得到\n$$\n(2-x)^{2}=\\frac{4}{m}\\left(\\frac{m}{3}+\\frac{c}{2}\\right)=\\frac{4(1+2c)}{3m}=:R_{R}.\n$$\n一个根位于 $(0,2)$ 内当且仅当 $0<R_{R}<4$，即\n$$\n0<\\frac{1+2c}{m}<3.\n$$\n令 $n=1+2c$ 并回顾 $m=1+\\frac{c}{2}$。考虑 $c$ 的区间：\n\n- 如果 $c<-2$，则 $m<0$ 且 $n<0$，所以 $\\frac{n}{m}>0$。不等式 $\\frac{n}{m}<3$ 变为 $n>3m$ (因为 $m<0$)，即 $(1+2c)>3(1+\\frac{c}{2})$，简化为 $\\frac{c}{2}-2>0$，即 $c>4$，这在这里是不可能的。因此对于 $c<-2$，在 $(0,2)$ 内没有根。\n\n- 如果 $-2<c<-\\frac{1}{2}$，则 $m>0$ 且 $n<0$，所以 $\\frac{n}{m}<0$，违反了正性条件；没有根。\n\n- 如果 $c>-\\frac{1}{2}$，则 $m>0$ 且 $n>0$，所以正性条件成立；边界 $\\frac{n}{m}<3$ 要求 $1+2c<3(1+\\frac{c}{2})$，即 $\\frac{c}{2}-2<0$，因此 $c<4$。所以对于 $-\\frac{1}{2}<c<4$，在 $(0,2)$ 内有一个根。当 $c=4$ 时，我们得到 $(2-x)^{2}=4$，得出 $x=0$ 或 $x=4$；$x=0$ 位于 $(-1,2)$ 内，并且是节点处的一个驻点。当 $c=-\\frac{1}{2}$ 时，$(2-x)^{2}=0$ 给出 $x=2$，不在 $(0,2)$ 内。\n\n综合两个区间，当 $c<-14$（左区间）或 $-\\frac{1}{2}<c<4$（右区间）时，在 $(-1,2)$ 内存在一个驻点，并且在 $c=4$ 时也存在（驻点在 $x=0$）。因此，它们的并集是 $c<-14$ 或 $c>-\\frac{1}{2}$。被排除的共线情况 $c=-2$ 不在这个并集中。因此正确选项是 A。\n\n最后，由于在上述范围内驻点处的 $S''$ 非零（左侧：$S_{0}''(x)=m(x+1)$，其中 $m>3$ 或 $m<-6$ 且 $x+1>0$；右侧：$S_{1}''(x)=\\frac{m}{2}(2-x)$，其中 $m>0$ 且 $0<x<2$），这些驻点确实是局部极值。", "answer": "$$\\boxed{A}$$", "id": "2189213"}, {"introduction": "为什么“自然”样条被如此广泛地使用？最后一个练习揭示了其定义背后深刻的优化原理：它们是“最平滑”的可能插值曲线。您将探索如何选择一个数据点以最小化样条的总弯曲能量，该能量由二阶导数平方的积分 $E = \\int [S''(x)]^2 dx$ 表示，从而深入理解自然样条的变分本质 [@problem_id:2189239]。", "problem": "给定一组五个数据点 $(x_i, y_i)$（$i=0, 1, 2, 3, 4$）用于插值。节点位于等距位置，即 $x_i = x_0 + i h$，其中 $x_0$ 是一个初始点，$h$ 是一个正常数步长。纵坐标 $y_0, y_1, y_3,$ 和 $y_4$ 是已知的，但中间的纵坐标 $y_2$ 是一个可以自由选择的变量。\n\n构造一个自然三次样条，记作 $S(x)$，来插值这五个点。定义在区间 $[x_0, x_4]$ 上的函数 $S(x)$ 若满足以下条件，则为自然三次样条：\n1. 在每个子区间 $[x_{i-1}, x_i]$（$i=1, 2, 3, 4$）上，$S(x)$ 是一个三次多项式。\n2. $S(x)$ 及其一阶导数 $S'(x)$ 和二阶导数 $S''(x)$ 在整个区间 $[x_0, x_4]$ 上都是连续的。\n3. 对每个 $i \\in \\{0, 1, 2, 3, 4\\}$，都有 $S(x_i) = y_i$。\n4. 满足“自然”边界条件：$S''(x_0) = 0$ 和 $S''(x_4) = 0$。\n\n该样条的总弯曲能由积分 $E = \\int_{x_0}^{x_4} [S''(x)]^2 dx$ 定义。你的任务是求出使该总弯曲能最小的未知纵坐标 $y_2$ 的值。\n\n将 $y_2$ 的答案表示为由已知纵坐标 $y_0, y_1, y_3$ 和 $y_4$ 构成的符号表达式。", "solution": "令 $M_{i} := S''(x_{i})$，其中 $i=0,1,2,3,4$。对于均匀步长 $h$ 和自然边界条件 $M_{0}=M_{4}=0$，三次样条矩 $M_i$（其中 $i=1,2,3$）满足以下方程：\n$$\nM_{i-1} + 4 M_{i} + M_{i+1} = \\frac{6}{h^{2}}\\left(y_{i+1} - 2 y_{i} + y_{i-1}\\right).\n$$\n定义 $k := \\frac{6}{h^{2}}$ 以及离散二阶差分\n$$\nr_{1} := y_{2} - 2 y_{1} + y_{0},\\quad r_{2} := y_{3} - 2 y_{2} + y_{1},\\quad r_{3} := y_{4} - 2 y_{3} + y_{2}.\n$$\n则方程组为\n$$\n4 M_{1} + M_{2} = k r_{1},\\quad M_{1} + 4 M_{2} + M_{3} = k r_{2},\\quad M_{2} + 4 M_{3} = k r_{3}.\n$$\n解此三对角系统可得\n$$\nM_{1} = \\frac{k}{56}\\left(15 r_{1} + r_{3} - 4 r_{2}\\right),\\quad\nM_{2} = \\frac{k}{14}\\left(- r_{1} + 4 r_{2} - r_{3}\\right),\\quad\nM_{3} = \\frac{k}{56}\\left(15 r_{3} + r_{1} - 4 r_{2}\\right).\n$$\n在每个子区间 $[x_{i-1},x_{i}]$ 上，$S''(x)$ 是 $M_{i-1}$ 和 $M_{i}$ 之间的线性插值，所以\n$$\nS''(x) = M_{i-1}(1-t) + M_{i} t,\\quad t := \\frac{x - x_{i-1}}{h}\\in[0,1].\n$$\n因此，区间 $[x_{i-1},x_{i}]$ 对弯曲能的贡献为\n$$\n\\int_{x_{i-1}}^{x_{i}} \\left(S''(x)\\right)^{2} dx\n= h \\int_{0}^{1} \\left((1-t) M_{i-1} + t M_{i}\\right)^{2} dt\n= \\frac{h}{3}\\left(M_{i-1}^{2} + M_{i-1} M_{i} + M_{i}^{2}\\right).\n$$\n对 $i=1,2,3,4$ 求和并利用 $M_{0}=M_{4}=0$ 可得\n$$\nE = \\frac{h}{3}\\left(2 M_{1}^{2} + M_{1} M_{2} + 2 M_{2}^{2} + M_{2} M_{3} + 2 M_{3}^{2}\\right).\n$$\n只有 $y_{2}$ 是变量；因此 $r_{1}, r_{2}, r_{3}$ 以及 $M_{1}, M_{2}, M_{3}$ 都线性地依赖于 $y_{2}$。将 $E$ 对 $y_{2}$ 求导。令 $X := y_{2}$。用 $M_{1}', M_{2}', M_{3}'$ 表示对 $X$ 的导数，则该二次型的导数为\n$$\n\\frac{dE}{dX} = \\frac{h}{3}\\left(4 M_{1} M_{1}' + 4 M_{3} M_{3}' + M_{1}' M_{2} + M_{1} M_{2}' + 4 M_{2} M_{2}' + M_{2}' M_{3} + M_{2} M_{3}'\\right).\n$$\n根据显式公式，\n$$\nM_{1}' = \\frac{24k}{56},\\quad M_{2}' = \\frac{-10k}{14},\\quad M_{3}' = \\frac{24k}{56}.\n$$\n利用这些常数重新整理该导数，可得\n$$\n\\frac{dE}{dX} = \\frac{h}{3}\\left[ \\frac{24k}{56}\\left(4 M_{1} + M_{2}\\right) + \\frac{24k}{56}\\left(4 M_{3} + M_{2}\\right) - \\frac{10k}{14}\\left(M_{1} + 4 M_{2} + M_{3}\\right) \\right].\n$$\n使用样条矩方程，\n$$\n4 M_{1} + M_{2} = k r_{1},\\quad M_{1} + 4 M_{2} + M_{3} = k r_{2},\\quad 4 M_{3} + M_{2} = k r_{3},\n$$\n我们得到\n$$\n\\frac{dE}{dX} = \\frac{h}{3}\\left[ \\frac{24k}{56}\\,k(r_{1} + r_{3}) - \\frac{10k}{14}\\,k r_{2} \\right]\n= \\frac{h k^{2}}{3}\\cdot \\frac{1}{7}\\left(3(r_{1}+r_{3}) - 5 r_{2}\\right).\n$$\n令 $\\frac{dE}{dX}=0$ 即得到最小化的充分必要条件（因为该二次型是正定的），即\n$$\n3(r_{1}+r_{3}) - 5 r_{2} = 0.\n$$\n代入 $r_{1} = y_{2} - 2 y_{1} + y_{0}$、$r_{2} = y_{3} - 2 y_{2} + y_{1}$ 和 $r_{3} = y_{4} - 2 y_{3} + y_{2}$：\n$$\n3\\left(2 y_{2} - 2 y_{1} - 2 y_{3} + y_{0} + y_{4}\\right) - 5\\left(y_{3} - 2 y_{2} + y_{1}\\right) = 0.\n$$\n化简得，\n$$\n16 y_{2} - 11 y_{1} - 11 y_{3} + 3 y_{0} + 3 y_{4} = 0,\n$$\n因此，使弯曲能最小化的纵坐标为\n$$\ny_{2} = \\frac{11 y_{1} + 11 y_{3} - 3 y_{0} - 3 y_{4}}{16}.\n$$", "answer": "$$\\boxed{\\frac{11 y_{1} + 11 y_{3} - 3 y_{0} - 3 y_{4}}{16}}$$", "id": "2189239"}]}