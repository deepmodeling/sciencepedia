{"hands_on_practices": [{"introduction": "第一个练习是带钳位边界条件的三次样条的基本入门。通过处理一个简单的三点数据集，并给定端点导数为零的条件，你将应用核心方程来构建样条并计算其值。这项实践对于具体理解钳位边界条件如何整合到样条公式中至关重要。[@problem_id:2159084]", "problem": "使用夹持三次样条对一组数据点进行插值。一个三次样条 $S(x)$ 由分段三次多项式组成，每个多项式对应一个连续数据点之间的区间。对于一组点 $(x_0, y_0), (x_1, y_1), \\dots, (x_n, y_n)$，在区间 $[x_j, x_{j+1}]$ 上的多项式为 $S_j(x) = a_j + b_j(x-x_j) + c_j(x-x_j)^2 + d_j(x-x_j)^3$。\n\n考虑一个由三个点组成的数据集：$(x_0, y_0) = (0, 0)$，$(x_1, y_1) = (1, 2)$ 和 $(x_2, y_2) = (2, 1)$。构建一个穿过这些点的夹持三次样条 $S(x)$，其附加的边界条件为端点处的导数为零，即 $S'(0) = 0$ 和 $S'(2) = 0$。\n\n计算该样条在 $x=1.5$ 处的值。将最终答案四舍五入到三位有效数字。", "solution": "对于节点为 $x_{0}=0$, $x_{1}=1$, $x_{2}=2$ 且端点导数为 $S'(0)=0, S'(2)=0$ 的夹持三次样条，可以使用标准的二阶导数（弯矩）公式来构建。令 $M_{i}=S''(x_{i})$ 且 $h_{i}=x_{i+1}-x_{i}$。对于夹持端点，求解 $M_{0}, M_{1}, M_{2}$ 的方程组为\n$$\n2h_{0}M_{0}+h_{0}M_{1}=6\\left(\\frac{y_{1}-y_{0}}{h_{0}}-S'(x_{0})\\right),\n$$\n$$\nh_{0}M_{0}+2(h_{0}+h_{1})M_{1}+h_{1}M_{2}=6\\left(\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}\\right),\n$$\n$$\nh_{1}M_{1}+2h_{1}M_{2}=6\\left(S'(x_{2})-\\frac{y_{2}-y_{1}}{h_{1}}\\right).\n$$\n此处 $h_{0}=h_{1}=1$，$ (y_{0},y_{1},y_{2})=(0,2,1)$，$\\frac{y_{1}-y_{0}}{h_{0}}=2$，$\\frac{y_{2}-y_{1}}{h_{1}}=-1$，且 $S'(x_{0})=S'(x_{2})=0$。该方程组变为\n$$\n2M_{0}+M_{1}=12,\\quad M_{0}+4M_{1}+M_{2}=-18,\\quad M_{1}+2M_{2}=6.\n$$\n解得\n$$\nM_{0}=\\frac{21}{2},\\quad M_{1}=-9,\\quad M_{2}=\\frac{15}{2}.\n$$\n在区间 $[x_{1},x_{2}]=[1,2]$ 上，样条函数为\n$$\nS_{1}(x)=\\frac{M_{1}}{6}(x_{2}-x)^{3}+\\frac{M_{2}}{6}(x-x_{1})^{3}+\\left(y_{1}-\\frac{M_{1}h_{1}^{2}}{6}\\right)\\frac{x_{2}-x}{h_{1}}+\\left(y_{2}-\\frac{M_{2}h_{1}^{2}}{6}\\right)\\frac{x-x_{1}}{h_{1}}.\n$$\n在 $h_{1}=1$，$x_{1}=1$，$x_{2}=2$，$M_{1}/6=-\\frac{3}{2}$，$M_{2}/6=\\frac{5}{4}$，$y_{1}-M_{1}/6=\\frac{7}{2}$ 且 $y_{2}-M_{2}/6=-\\frac{1}{4}$ 的条件下，上式可简化为\n$$\nS_{1}(x)=-\\frac{3}{2}(2-x)^{3}+\\frac{5}{4}(x-1)^{3}+\\frac{7}{2}(2-x)-\\frac{1}{4}(x-1).\n$$\n在 $x=1.5$ 处，令 $u=0.5$ 可得\n$$\nS(1.5)=-\\frac{3}{2}u^{3}+\\frac{5}{4}u^{3}+\\frac{7}{2}u-\\frac{1}{4}u\n= -\\frac{3}{16}+\\frac{5}{32}+\\frac{7}{4}-\\frac{1}{8}\n=\\frac{51}{32}=1.59375.\n$$\n四舍五入到三位有效数字，得到 $1.59$。", "answer": "$$\\boxed{1.59}$$", "id": "2159084"}, {"introduction": "在许多实际应用中，构建钳位样条所需的端点导数是未知的。本问题将引导你解决这一实际挑战，在构建样条之前，先利用局部数据点来估计这些导数。这个练习展示了一种在边界数据不完整情况下应用钳位样条的稳健技术，这在数据分析和工程领域中非常常见。[@problem_id:2159068]", "problem": "一位数值分析家的任务是为一组数据点创建一个光滑的插值函数，方法是使用固定端点三次样条。给定的数据点 $(x_i, y_i)$ 如下：\n- $(x_0, y_0) = (0, 0.0000)$\n- $(x_1, y_1) = (1, 0.6065)$\n- $(x_2, y_2) = (2, 0.7358)$\n- $(x_3, y_3) = (3, 0.6694)$\n- $(x_4, y_4) = (4, 0.5413)$\n\n一个三次样条 $S(x)$ 由每个区间 $[x_i, x_{i+1}]$ 上的分段三次多项式 $S_i(x)$ 构成。对于固定端点样条，必须指定端点处的一阶导数 $S'(x_0)$ 和 $S'(x_4)$。然而，对于给定的数据集，这些导数是未知的。为了继续进行，该分析家决定使用局部数据来估计它们。\n\n所需的边界条件，即端点 $x_0$ 和 $x_4$ 处的一阶导数，将按如下方式估计：\n- $S'(x_0)$ 的值将通过找到经过前三个数据点 $(x_0, y_0)$、$(x_1, y_1)$ 和 $(x_2, y_2)$ 的唯一二次多项式，然后计算该二次多项式在 $x_0$ 处的导数来估计。\n- 类似地，$S'(x_4)$ 的值将通过找到经过后三个数据点 $(x_2, y_2)$、$(x_3, y_3)$ 和 $(x_4, y_4)$ 的唯一二次多项式，然后计算该二次多项式在 $x_4$ 处的导数来估计。\n\n在用这些估计的边界条件构建了固定端点三次样条 $S(x)$ 之后，确定该样条在 $x=2.5$ 处的值。报告其数值，并四舍五入到四位有效数字。", "solution": "设 $x_{i}=i$ 且 $y_{0}=0, y_{1}=0.6065, y_{2}=0.7358, y_{3}=0.6694, y_{4}=0.5413$。网格是均匀的，步长 $h=x_{i+1}-x_{i}=1$。\n\n根据二次拟合（对于均匀网格上的二次函数是精确的）得到端点斜率，使用三点公式：\n$$S'(x_{0})=\\frac{-3y_{0}+4y_{1}-y_{2}}{2h},\\qquad S'(x_{4})=\\frac{3y_{4}-4y_{3}+y_{2}}{2h}.$$\n当 $h=1$ 时，\n$$S'(x_{0})=\\frac{-3\\cdot 0+4\\cdot 0.6065-0.7358}{2}=0.8451=\\frac{8451}{10000},$$\n$$S'(x_{4})=\\frac{3\\cdot 0.5413-4\\cdot 0.6694+0.7358}{2}=-0.15895=-\\frac{3179}{20000}.$$\n\n对于固定端点三次样条，用二阶导数 $M_{i}=S''(x_{i})$ 表示的方程组为\n$$2h\\,M_{0}+h\\,M_{1}=6\\left(\\frac{y_{1}-y_{0}}{h}-S'(x_{0})\\right),$$\n$$h\\,M_{i-1}+2(h+h)\\,M_{i}+h\\,M_{i+1}=6\\left(\\frac{y_{i+1}-y_{i}}{h}-\\frac{y_{i}-y_{i-1}}{h}\\right),\\quad i=1,2,3,$$\n$$h\\,M_{3}+2h\\,M_{4}=6\\left(S'(x_{4})-\\frac{y_{4}-y_{3}}{h}\\right).$$\n当 $h=1$ 时，这些方程变为\n$$2M_{0}+M_{1}=6\\left((y_{1}-y_{0})-S'(x_{0})\\right)=-\\frac{3579}{2500},$$\n$$M_{0}+4M_{1}+M_{2}=6(y_{2}-2y_{1}+y_{0})=-\\frac{7158}{2500},$$\n$$M_{1}+4M_{2}+M_{3}=6(y_{3}-2y_{2}+y_{1})=-\\frac{5871}{5000},$$\n$$M_{2}+4M_{3}+M_{4}=6(y_{4}-2y_{3}+y_{2})=-\\frac{1851}{5000},$$\n$$M_{3}+2M_{4}=6\\left(S'(x_{4})-(y_{4}-y_{3})\\right)=-\\frac{1851}{10000}.$$\n\n求解这个三对角系统（例如，通过 Thomas 算法）得到精确的有理数值\n$$M_{4}=-\\frac{40847}{560000},\\quad M_{3}=-\\frac{1065157}{27160000},\\quad M_{2}=-\\frac{99136037}{706160000},$$\n并通过回代得到，\n$$M_{1}=-\\frac{1417271947}{2471560000},\\quad M_{0}=-\\frac{2121013349}{4943120000}.$$\n\n在区间 $[x_{2},x_{3}]$ 上，当 $h=1$ 时，三次样条可以写成\n$$S_{2}(x)=\\frac{M_{2}}{6}(x_{3}-x)^{3}+\\frac{M_{3}}{6}(x-x_{2})^{3}+\\left(y_{2}-\\frac{M_{2}}{6}\\right)(x_{3}-x)+\\left(y_{3}-\\frac{M_{3}}{6}\\right)(x-x_{2}).$$\n在中点 $x=2.5$ 处，有 $x-x_{2}=x_{3}-x=\\frac{1}{2}$，所以\n$$S(2.5)=\\frac{y_{2}+y_{3}}{2}-\\frac{M_{2}+M_{3}}{16}.$$\n已知 $y_{2}+y_{3}=\\frac{14052}{10000}$ 且 $M_{2}+M_{3}=-\\frac{126830119}{706160000}$，\n$$S(2.5)=\\frac{3513}{5000}-\\left(-\\frac{126830119}{706160000}\\right)\\frac{1}{16}\n=\\frac{3513}{5000}+\\frac{126830119}{11298560000}\n=\\frac{8065198375}{11298560000}.$$\n数值上，\n$$S(2.5)\\approx 0.713825335\\quad\\text{(到足够精度)},$$\n四舍五入到四位有效数字后为 $0.7138$。", "answer": "$$\\boxed{0.7138}$$", "id": "2159068"}, {"introduction": "边界条件的选择会极大地影响样条模型的质量和物理真实性。本练习旨在探讨这一关键概念，要求你确定初始导数 $v_0$ 的取值，以防止最终曲线出现不符合物理直觉的“摆动”或振荡。通过确保样条函数保持凹性（即其二阶导数 $S''(t)$ 始终为非正值），你将更深刻地体会到如何利用钳位条件来施加定性约束，从而生成更有意义的插值结果。[@problem_id:2159102]", "problem": "一个夹持三次样条被用于根据三个离散的测量值对一个物理过程进行建模。数据点 $(t_i, y_i)$ 分别为 $(0, 1)$、$(1, 3)$ 和 $(3, 2)$，其中 $t$ 是任意单位下的时间，$y$ 是传感器读数。\n\n该样条记为 $S(t)$，对这些点进行插值。为确保与后续数据的平滑过渡，该样条在终点被“夹持”，其导数值被指定为：$S'(3) = -1$。起始点的导数 $v_0 = S'(0)$ 是一个需要工程师选择的参数。\n\n已知所建模的潜在物理过程具有固有凹性，即其真实的二阶导数始终为非正。如果初始导数 $v_0$ 的选择不当，会导致样条模型出现人为的“摆动”，这表现为一个凸性区域，在该区域内样条的二阶导数 $S''(t)$ 变为正值。这样的区域在模型中代表了一种非物理假象。\n\n请确定初始导数 $v_0$ 的最小数值，以确保最终的样条 $S(t)$ 在整个区间 $[0, 3]$ 上是纯凹的，从而避免任何非物理假象。答案请四舍五入到三位有效数字。", "solution": "我们在节点 $t_{0}=0$、$t_{1}=1$、$t_{2}=3$ 上构建夹持三次样条，其对应值为 $y_{0}=1$、$y_{1}=3$、$y_{2}=2$，并指定端点导数为 $S'(0)=v_{0}$（未知）和 $S'(3)=-1$。令 $h_{0}=t_{1}-t_{0}=1$ 且 $h_{1}=t_{2}-t_{1}=2$。在标准三次样条公式中，令 $M_{i}=S''(t_{i})$，其中 $i=0,1,2$。对于夹持样条，$M_{i}$ 满足以下三对角系统：\n- 内部方程（源于 $S'$ 在 $t_{1}$ 处的连续性）：\n$$\nh_{0} M_{0} + 2(h_{0}+h_{1}) M_{1} + h_{1} M_{2} = 6\\left( \\frac{y_{2}-y_{1}}{h_{1}} - \\frac{y_{1}-y_{0}}{h_{0}} \\right).\n$$\n- 左边界（夹持）方程：\n$$\n2 h_{0} M_{0} + h_{0} M_{1} = 6\\left( \\frac{y_{1}-y_{0}}{h_{0}} - v_{0} \\right).\n$$\n- 右边界（夹持）方程：\n$$\nh_{1} M_{1} + 2 h_{1} M_{2} = 6\\left( -1 - \\frac{y_{2}-y_{1}}{h_{1}} \\right).\n$$\n\n计算所需的斜率：\n$$\n\\frac{y_{1}-y_{0}}{h_{0}} = 2, \\qquad \\frac{y_{2}-y_{1}}{h_{1}} = -\\frac{1}{2}.\n$$\n将 $h_{0}=1$、$h_{1}=2$ 和这些斜率代入，方程组变为\n$$\n\\text{(I)}\\quad M_{0} + 6 M_{1} + 2 M_{2} = -15,\n$$\n$$\n\\text{(L)}\\quad 2 M_{0} + M_{1} = 12 - 6 v_{0},\n$$\n$$\n\\text{(R)}\\quad 2 M_{1} + 4 M_{2} = -3.\n$$\n求解 $M_{i}$ 关于 $v_{0}$ 的表达式。由 (R) 式，$M_{1} = -\\frac{3}{2} - 2 M_{2}$。代入 (I) 式得到 $M_{0} = -6 + 10 M_{2}$。将两者代入 (L) 式：\n$$\n2(-6 + 10 M_{2}) + \\left( -\\frac{3}{2} - 2 M_{2} \\right) = 12 - 6 v_{0},\n$$\n化简为\n$$\n18 M_{2} - \\frac{27}{2} = 12 - 6 v_{0}.\n$$\n因此\n$$\nM_{2} = \\frac{51 - 12 v_{0}}{36} = \\frac{17 - 4 v_{0}}{12}.\n$$\n那么\n$$\nM_{1} = -\\frac{3}{2} - 2 M_{2} = -\\frac{3}{2} - \\frac{17 - 4 v_{0}}{6} = \\frac{2 v_{0} - 13}{3},\n$$\n以及\n$$\nM_{0} = -6 + 10 M_{2} = -6 + \\frac{10(17 - 4 v_{0})}{12} = \\frac{49 - 20 v_{0}}{6}.\n$$\n\n在每个子区间上，三次样条的二阶导数是线性的：\n$$\nS''(t) = M_{i} \\frac{t_{i+1}-t}{h_{i}} + M_{i+1} \\frac{t - t_{i}}{h_{i}}, \\qquad t \\in [t_{i}, t_{i+1}],\n$$\n因此 $S''$ 是 $M_i$ 和 $M_{i+1}$ 之间的线性插值。所以，当且仅当以下条件成立时，对于所有 $t \\in [0,3]$ 都有 $S''(t) \\le 0$：\n$$\nM_{0} \\le 0, \\quad M_{1} \\le 0, \\quad M_{2} \\le 0.\n$$\n将上述表达式代入这些不等式：\n- $M_{2} \\le 0 \\implies \\frac{17 - 4 v_{0}}{12} \\le 0 \\implies v_{0} \\ge \\frac{17}{4}.$\n- $M_{1} \\le 0 \\implies \\frac{2 v_{0} - 13}{3} \\le 0 \\implies v_{0} \\le \\frac{13}{2}.$\n- $M_{0} \\le 0 \\implies \\frac{49 - 20 v_{0}}{6} \\le 0 \\implies v_{0} \\ge \\frac{49}{20}.$\n\n综合以上不等式可得\n$$\nv_{0} \\in \\left[ \\frac{17}{4}, \\frac{13}{2} \\right],\n$$\n因此，确保在 $[0,3]$ 上 $S''(t) \\le 0$ 的最小 $v_{0}$ 值为 $v_{0} = \\frac{17}{4} = 4.25$。四舍五入到三位有效数字，结果是 $4.25$。", "answer": "$$\\boxed{4.25}$$", "id": "2159102"}]}