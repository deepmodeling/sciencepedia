{"hands_on_practices": [{"introduction": "掌握任何新算法的第一步都是通过具体计算来熟悉其运作机制。这个练习将引导你手动执行 Steffensen 方法的单次迭代，计算一个给定函数的不动点。通过这个直接的应用[@problem_id:2206211]，你将能够巩固对该方法核心公式的理解，并为解决更复杂的问题打下基础。", "problem": "Steffensen方法是一种迭代过程，用于寻找函数 $g(x)$ 的不动点，即满足 $p = g(p)$ 的值 $p$。给定一个初始近似值 $x_0$，该方法生成一个收敛于不动点的序列。产生下一个近似值 $x_1$ 的首次迭代公式如下：\n\n$$x_1 = x_0 - \\frac{(g(x_0) - x_0)^2}{g(g(x_0)) - 2g(x_0) + x_0}$$\n\n考虑函数 $g(x) = \\exp(-x)$。从初始猜测值 $x_0 = 1$ 开始，应用一次Steffensen方法的迭代来寻找近似值 $x_1$。\n\n计算 $x_1$ 的值，并将最终答案四舍五入到五位有效数字。", "solution": "Steffensen方法通过以下公式从 $x_{0}$ 更新得到 $x_{1}$：\n$$\nx_{1}=x_{0}-\\frac{(g(x_{0})-x_{0})^{2}}{g(g(x_{0}))-2g(x_{0})+x_{0}}.\n$$\n当 $g(x)=\\exp(-x)$ 且 $x_{0}=1$ 时，计算\n$$\ng(x_{0})=\\exp(-1),\\quad g(g(x_{0}))=\\exp(-\\exp(-1)).\n$$\n因此，\n$$\nx_{1}=1-\\frac{(\\exp(-1)-1)^{2}}{\\exp(-\\exp(-1))-2\\exp(-1)+1}.\n$$\n使用恒等式 $(\\exp(-1))^{2}=\\exp(-2)$ 将分子写作：\n$$\n(\\exp(-1)-1)^{2}=(1-\\exp(-1))^{2}=1-2\\exp(-1)+\\exp(-2).\n$$\n因此，\n$$\nx_{1}=1-\\frac{1-2\\exp(-1)+\\exp(-2)}{1-2\\exp(-1)+\\exp(-\\exp(-1))}.\n$$\n现在进行数值计算（因为需要一个十进制近似值）：\n$$\n\\exp(-1)\\approx 0.3678794411714423,\\quad \\exp(-2)\\approx 0.1353352832366127,\\quad \\exp(-\\exp(-1))\\approx 0.6922006275553464.\n$$\n因此，\n$$\n\\text{分子}\\approx 1-2(0.3678794411714423)+0.1353352832366127\\approx 0.3995764008937280,\n$$\n$$\n\\text{分母}\\approx 1-2(0.3678794411714423)+0.6922006275553464\\approx 0.9564417452124617,\n$$\n$$\n\\frac{\\text{分子}}{\\text{分母}}\\approx 0.417773903,\n$$\n所以\n$$\nx_{1}\\approx 1-0.417773903\\approx 0.582226097.\n$$\n四舍五入到五位有效数字得到 $x_{1}\\approx 0.58223$。", "answer": "$$\\boxed{0.58223}$$", "id": "2206211"}, {"introduction": "Steffensen 方法虽然强大，但并非万无一失，理解其局限性与掌握其应用同样重要。这个练习挑战你跳出常规，去寻找一个特殊的初始点，它本身不是根，却能导致算法在第一步就因分母为零而失败[@problem_id:2206185]。解决这个问题将深化你对该方法迭代公式结构的认识，并揭示其潜在的数值不稳定性。", "problem": "Steffensen 方法是一种用于求解函数 $f(x)$ 根的数值算法。其迭代公式为：\n$$x_{n+1} = x_n - \\frac{[f(x_n)]^2}{f(x_n + f(x_n)) - f(x_n)}$$\n如果对于某次迭代 $n$，修正项的分母变为零，则该方法可能会失败。\n\n考虑函数 $f(x) = \\sin(x)$，其中所有角度均以弧度为单位。在开区间 $(0, \\pi/2)$ 内存在一个唯一的初始猜测值 $x_0$，它使得 Steffensen 方法的第一步无定义，尽管 $x_0$ 并非 $f(x)$ 的根。\n\n下列哪个方程正确地定义了这个特定的值 $x_0$？\n\nA) $2x_0 + \\sin(x_0) = \\pi$\n\nB) $x_0 - \\cos(x_0) = \\pi/2$\n\nC) $\\tan(x_0) = \\pi - 2x_0$\n\nD) $2x_0 - \\sin(x_0) = \\pi$\n\nE) $\\sin(x_0) = \\frac{x_0}{2}$", "solution": "当分母为零时，第一次 Steffensen 迭代无定义：\n$$\nf(x_{0}+f(x_{0}))-f(x_{0})=0.\n$$\n当 $f(x)=\\sin x$ 时，上式变为\n$$\n\\sin\\!\\bigl(x_{0}+\\sin x_{0}\\bigr)=\\sin x_{0}.\n$$\n利用 $\\sin u=\\sin v$ 的通解，即 $u=v+2k\\pi$ 或 $u=\\pi - v+2k\\pi$（其中 $k\\in\\mathbb{Z}$），令 $u=x_{0}+\\sin x_{0}$ 且 $v=x_{0}$。\n\n情况1：$x_{0}+\\sin x_{0}=x_{0}+2k\\pi$ 得到 $\\sin x_{0}=2k\\pi$。对于 $x_{0}\\in(0,\\pi/2)$，有 $\\sin x_{0}\\in(0,1)$，所以唯一可能的 $k$ 是 $k=0$，但这将导致 $\\sin x_{0}=0$，与 $x_{0}$ 不是根的条件相矛盾。因此这种情况不成立。\n\n情况2：$x_{0}+\\sin x_{0}=\\pi - x_{0}+2k\\pi$ 得到\n$$\n2x_{0}+\\sin x_{0}=\\pi+2k\\pi.\n$$\n对于 $x_{0}\\in(0,\\pi/2)$，等式左边满足 $0<2x_{0}+\\sin x_{0}<\\pi+1$，因此唯一能使等式成立的整数 $k$ 是 $k=0$。所以，\n$$\n2x_{0}+\\sin x_{0}=\\pi.\n$$\n这个方程定义了一个唯一的 $x_{0}\\in(0,\\pi/2)$，因为函数 $h(x)=2x+\\sin x$ 在 $(0,\\pi/2)$ 上是严格单调递增的（因为 $h'(x)=2+\\cos x>1$），并且 $h(0)=0$，$h(\\pi/2)=\\pi+1$。\n\n与选项比较，这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "2206185"}, {"introduction": "理论上完美的算法在实际的计算机上运行时，往往会面临有限精度算术带来的挑战。这个思想实验将理论与实践联系起来，探讨当初始猜测值非常接近真解时，计算机的舍入误差如何导致 Steffensen 方法意外失效[@problem_id:2206171]。通过分析这种情况，你将体会到数值计算中机器精度（machine precision）的关键作用，并理解为何稳健的算法设计必须考虑这些现实因素。", "problem": "Steffensen 方法是一种迭代求根算法，其公式为：\n$$x_{n+1} = x_n - \\frac{f(x_n)^2}{f(x_n+f(x_n)) - f(x_n)}$$\n其中 $x_n$ 是第 $n$ 次迭代时根的估计值。\n\n考虑求解函数 $f(x) = \\ln(x) - C$ 的根的任务，其中 $C > 0$ 是一个给定的正常数。计算在一个具有有限精度算术的简化计算机上执行。该计算机对于浮点加法具有以下性质：对于任意两个实数 $a$ 和 $b$，它们的和在计算上被评估为 `fl(a+b) = a`，如果条件 $|b| < \\epsilon |a|$ 满足。此处，$\\epsilon$ 是一个称为机器精度的小正常数。\n\n如果迭代公式的分母计算结果为零，这种有限精度可能导致 Steffensen 方法在第一步（$n=0$）就失败。假设我们从一个非常接近函数 $f(x)$ 真根 $\\alpha$ 的初始猜测值 $x_0$ 开始。我们可以将这个初始猜测值写成 $x_0 = \\alpha + \\delta$，其中 $\\delta$ 代表一个微小的偏差。\n\n确定此偏差的临界量值 $\\delta_c > 0$，使得对于任何满足 $|\\delta| < \\delta_c$ 的初始猜测值，Steffensen 方法的第一步都会因所述的浮点行为导致的除零错误而失败。用 $C$ 和 $\\epsilon$ 表示你的答案 $\\delta_c$。", "solution": "$f(x)=\\ln(x)-C$ 的根是满足 $\\ln(\\alpha)-C=0$ 的 $\\alpha$，因此 $\\alpha=\\exp(C)$。设初始猜测值为 $x_{0}=\\alpha+\\delta$，其中 $\\delta$ 很小。\n\n计算在 $x_{0}$ 处的函数值：\n$$\nf(x_{0})=\\ln(x_{0})-C=\\ln(\\alpha+\\delta)-C=\\ln(\\alpha)+\\ln\\!\\left(1+\\frac{\\delta}{\\alpha}\\right)-C=\\ln\\!\\left(1+\\frac{\\delta}{\\alpha}\\right).\n$$\n\nSteffensen 方法第一步的分母是 $f(x_{0}+f(x_{0}))-f(x_{0})$。根据浮点运算法则，当且仅当\n$$\n|f(x_{0})|<\\epsilon\\,|x_{0}|\n$$\n时，中间加法 $x_{0}+f(x_{0})$ 被计算为 $\\mathrm{fl}(x_{0}+f(x_{0}))=x_{0}$。\n当这种情况发生时，$f(x_{0}+f(x_{0}))$ 将在舍入后的自变量 $x_{0}$ 处求值，得到 $f(x_{0}+f(x_{0}))=f(x_{0})$，因此分母变为零，方法在 $n=0$ 时失败。\n\n因此，失败的条件是\n$$\n\\left|\\ln\\!\\left(1+\\frac{\\delta}{\\alpha}\\right)\\right|<\\epsilon\\,|\\alpha+\\delta|.\n$$\n对于 $|\\delta|\\ll\\alpha$（如题所述，$x_{0}$ 非常接近 $\\alpha$），我们使用一阶展开式 $\\ln(1+u)=u+O(u^{2})$（其中 $u=\\delta/\\alpha$），以及 $|\\alpha+\\delta|=\\alpha+O(|\\delta|)$。在主导阶上，失败的边界满足\n$$\n\\frac{|\\delta|}{\\alpha}=\\epsilon\\,\\alpha,\n$$\n这给出了临界量值\n$$\n\\delta_{c}=\\epsilon\\,\\alpha^{2}=\\epsilon\\,\\exp(2C).\n$$\n因此，对于任何满足 $|\\delta|<\\delta_{c}$ 的初始值 $x_{0}=\\alpha+\\delta$，Steffensen 方法的第一步会因为浮点加法将 $x_{0}+f(x_{0})$ 舍入回 $x_{0}$ 而失败。", "answer": "$$\\boxed{\\epsilon\\,\\exp(2C)}$$", "id": "2206171"}]}