{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。本节的第一个练习将带您亲手体验迭代法的核心机制。我们将使用雅可比法 (Jacobi method) 求解一个简单的线性系统，让您直观地看到解是如何通过一步步迭代逼近真实值的。此练习特别设计了两种不同的初始猜测值，旨在揭示迭代法的一个关键特性：初始解的选取会显著影响收敛速度 [@problem_id:2160049]。", "problem": "考虑以下线性方程组，它代表了某个物理系统的稳态条件：\n$$\n\\begin{align*}\n5x_1 - 2x_2 &= 11 \\\\\nx_1 + 4x_2 &= 10\n\\end{align*}\n$$\n雅可比（Jacobi）方法是一种用于求解线性方程组数值解的迭代算法。对于一个系统 $A\\mathbf{x} = \\mathbf{b}$，在第 $k+1$ 步，解向量 $\\mathbf{x}^{(k+1)}$ 的第 $i$ 个分量的迭代公式如下：\n$$\nx_i^{(k+1)} = \\frac{1}{a_{ii}} \\left( b_i - \\sum_{j \\neq i} a_{ij} x_j^{(k)} \\right)\n$$\n迭代解 $\\mathbf{x}^{(k)}$ 的精度通常用误差向量 $\\mathbf{e}^{(k)} = \\mathbf{x}^{(k)} - \\mathbf{x}_{\\text{true}}$ 来衡量，其中 $\\mathbf{x}_{\\text{true}}$ 是精确解。我们使用误差的无穷范数，定义为 $||\\mathbf{e}^{(k)}||_\\infty = \\max_{i} |e_i^{(k)}|$，来量化误差的大小。\n\n你的任务是比较雅可比方法在两种不同初始猜测值下的收敛性。\n情况 A：从初始向量 $\\mathbf{x}^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 开始。\n情况 B：从初始向量 $\\mathbf{y}^{(0)} = \\begin{pmatrix} 3 \\\\ 2 \\end{pmatrix}$ 开始。\n\n设 $E_A = ||\\mathbf{x}^{(2)} - \\mathbf{x}_{\\text{true}}||_\\infty$ 为情况 A 经过两次迭代后的误差范数，设 $E_B = ||\\mathbf{y}^{(2)} - \\mathbf{x}_{\\text{true}}||_\\infty$ 为情况 B 经过两次迭代后的误差范数。\n\n计算比率 $E_A / E_B$。将最终答案四舍五入到三位有效数字。", "solution": "我们首先为该系统重写雅可比迭代格式\n$$\n\\begin{aligned}\n5x_{1}-2x_{2}&=11,\\\\\nx_{1}+4x_{2}&=10.\n\\end{aligned}\n$$\n对每个方程求解其对角线上的变量，得到迭代格式\n$$\nx_{1}^{(k+1)}=\\frac{1}{5}\\left(11+2x_{2}^{(k)}\\right),\\qquad x_{2}^{(k+1)}=\\frac{1}{4}\\left(10-x_{1}^{(k)}\\right).\n$$\n\n计算精确解 $\\mathbf{x}_{\\text{true}}$。由 $x_{1}=10-4x_{2}$ 代入 $5x_{1}-2x_{2}=11$，\n$$\n5(10-4x_{2})-2x_{2}=11\\;\\Rightarrow\\;50-22x_{2}=11\\;\\Rightarrow\\;x_{2}=\\frac{39}{22},\n$$\n且\n$$\nx_{1}=10-4\\cdot\\frac{39}{22}=10-\\frac{156}{22}=\\frac{32}{11}.\n$$\n因此 $\\mathbf{x}_{\\text{true}}=\\begin{pmatrix}\\frac{32}{11} \\\\ \\frac{39}{22}\\end{pmatrix}$。\n\n情况 A：$\\mathbf{x}^{(0)}=\\begin{pmatrix}0\\\\0\\end{pmatrix}$。那么\n$$\nx_{1}^{(1)}=\\frac{1}{5}(11+2\\cdot 0)=\\frac{11}{5},\\quad x_{2}^{(1)}=\\frac{1}{4}(10-0)=\\frac{5}{2},\n$$\n$$\nx_{1}^{(2)}=\\frac{1}{5}\\left(11+2\\cdot\\frac{5}{2}\\right)=\\frac{1}{5}(11+5)=\\frac{16}{5},\\quad\nx_{2}^{(2)}=\\frac{1}{4}\\left(10-\\frac{11}{5}\\right)=\\frac{1}{4}\\cdot\\frac{39}{5}=\\frac{39}{20}.\n$$\n因此\n$$\n\\mathbf{x}^{(2)}-\\mathbf{x}_{\\text{true}}=\\begin{pmatrix}\\frac{16}{5}-\\frac{32}{11} \\\\ \\frac{39}{20}-\\frac{39}{22}\\end{pmatrix}\n=\\begin{pmatrix}\\frac{16}{55} \\\\ \\frac{39}{220}\\end{pmatrix},\n$$\n所以\n$$\nE_{A}=\\left\\|\\mathbf{x}^{(2)}-\\mathbf{x}_{\\text{true}}\\right\\|_{\\infty}=\\max\\left(\\left|\\frac{16}{55}\\right|,\\left|\\frac{39}{220}\\right|\\right)=\\frac{16}{55}.\n$$\n\n情况 B：$\\mathbf{y}^{(0)}=\\begin{pmatrix}3\\\\2\\end{pmatrix}$。那么\n$$\ny_{1}^{(1)}=\\frac{1}{5}(11+2\\cdot 2)=\\frac{15}{5}=3,\\quad y_{2}^{(1)}=\\frac{1}{4}(10-3)=\\frac{7}{4},\n$$\n$$\ny_{1}^{(2)}=\\frac{1}{5}\\left(11+2\\cdot\\frac{7}{4}\\right)=\\frac{1}{5}\\cdot\\frac{29}{2}=\\frac{29}{10},\\quad\ny_{2}^{(2)}=\\frac{1}{4}(10-3)=\\frac{7}{4}.\n$$\n因此\n$$\n\\mathbf{y}^{(2)}-\\mathbf{x}_{\\text{true}}=\\begin{pmatrix}\\frac{29}{10}-\\frac{32}{11} \\\\ \\frac{7}{4}-\\frac{39}{22}\\end{pmatrix}\n=\\begin{pmatrix}-\\frac{1}{110} \\\\ -\\frac{1}{44}\\end{pmatrix},\n$$\n所以\n$$\nE_{B}=\\left\\|\\mathbf{y}^{(2)}-\\mathbf{x}_{\\text{true}}\\right\\|_{\\infty}=\\max\\left(\\left|\\frac{1}{110}\\right|,\\left|\\frac{1}{44}\\right|\\right)=\\frac{1}{44}.\n$$\n\n因此，该比率为\n$$\n\\frac{E_{A}}{E_{B}}=\\frac{\\frac{16}{55}}{\\frac{1}{44}}=\\frac{16}{55}\\cdot 44=\\frac{16\\cdot 44}{55}=\\frac{64}{5}=12.8,\n$$\n保留三位有效数字为 $12.8$。", "answer": "$$\\boxed{12.8}$$", "id": "2160049"}, {"introduction": "在上一个练习中，我们看到了雅可比法如何运作，但它为什么能收敛呢？这个练习将带我们深入探究其背后的数学原理。我们将计算雅可比迭代矩阵的谱半径($\\rho(T_J)$)，这是一个决定迭代过程成败的关键指标。通过这个计算，您可以验证一个重要的理论：当谱半径小于1时，迭代法才能保证收敛，这为我们选择和诊断迭代求解器提供了坚实的理论依据 [@problem_id:2160047]。", "problem": "在数值线性代数领域，对于形如 $A\\mathbf{x} = \\mathbf{b}$ 的线性方程组，迭代法提供了直接法之外的另一种求解途径。最简单的迭代格式之一是雅可比法。雅可比法的收敛性由其迭代矩阵的谱半径决定。\n\n对于一个给定的 $n \\times n$ 矩阵 $A$，我们可以将其分解为 $A = D - L - U$，其中 $D$ 是包含 $A$ 的对角元素的对角矩阵，$-L$ 是 $A$ 的严格下三角部分，$-U$ 是 $A$ 的严格上三角部分。雅可比迭代矩阵（记作 $T_J$）定义为 $T_J = D^{-1}(L+U)$。基于此矩阵的迭代过程对任意初始猜测都收敛的充分必要条件是其谱半径 $\\rho(T_J)$ 小于 1。谱半径是 $T_J$ 的特征值绝对值的最大值。\n\n考虑以下特定矩阵：\n$$\nA = \\begin{pmatrix} 4 & 1 \\\\ -2 & 5 \\end{pmatrix}\n$$\n该矩阵是严格对角占优的，这保证了雅可比法的收敛性。你的任务是通过直接计算来明确地验证这一理论保证。\n\n计算给定矩阵 $A$ 的精确谱半径 $\\rho(T_J)$。将你的答案表示为一个单一、简化的解析表达式。", "solution": "给定矩阵 $A=\\begin{pmatrix}4 & 1 \\\\ -2 & 5\\end{pmatrix}$，其分解为 $A=D-L-U$，其中 $D$ 是 $A$ 的对角部分，$-L$ 是 $A$ 的严格下三角部分，$-U$ 是 $A$ 的严格上三角部分。因此\n$$\nD=\\begin{pmatrix}4 & 0 \\\\ 0 & 5\\end{pmatrix},\\quad -L=\\begin{pmatrix}0 & 0 \\\\ -2 & 0\\end{pmatrix}\\;\\Rightarrow\\;L=\\begin{pmatrix}0 & 0 \\\\ 2 & 0\\end{pmatrix},\\quad -U=\\begin{pmatrix}0 & 1 \\\\ 0 & 0\\end{pmatrix}\\;\\Rightarrow\\;U=\\begin{pmatrix}0 & -1 \\\\ 0 & 0\\end{pmatrix}.\n$$\n雅可比迭代矩阵为\n$$\nT_{J}=D^{-1}(L+U).\n$$\n计算 $L+U$ 和 $D^{-1}$：\n$$\nL+U=\\begin{pmatrix}0 & -1 \\\\ 2 & 0\\end{pmatrix},\\qquad D^{-1}=\\begin{pmatrix}\\frac{1}{4} & 0 \\\\ 0 & \\frac{1}{5}\\end{pmatrix}.\n$$\n因此\n$$\nT_{J}=D^{-1}(L+U)=\\begin{pmatrix}\\frac{1}{4} & 0 \\\\ 0 & \\frac{1}{5}\\end{pmatrix}\\begin{pmatrix}0 & -1 \\\\ 2 & 0\\end{pmatrix}=\\begin{pmatrix}0 & -\\frac{1}{4} \\\\ \\frac{2}{5} & 0\\end{pmatrix}.\n$$\n为了求谱半径，我们计算 $T_{J}$ 的特征值。其特征多项式为\n$$\n\\det(\\lambda I - T_{J})=\\det\\begin{pmatrix}\\lambda & \\frac{1}{4} \\\\ -\\frac{2}{5} & \\lambda\\end{pmatrix}=\\lambda^{2}+\\frac{1}{10}.\n$$\n因此特征值满足 $\\lambda^{2}=-\\frac{1}{10}$，可得\n$$\n\\lambda=\\pm i\\,\\frac{1}{\\sqrt{10}}.\n$$\n谱半径是特征值绝对值的最大值，因此\n$$\n\\rho(T_{J})=\\frac{1}{\\sqrt{10}}.\n$$\n该值小于 $1$，证实了方法的收敛性，并且这就是精确的谱半径。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{10}}}$$", "id": "2160047"}, {"introduction": "掌握了直接法和迭代法的基本原理与收敛条件后，一个更实际的问题摆在面前：在具体应用中，我们应该如何选择？本练习将理论应用于实践，构建了一个计算成本分析模型。您将通过分析两种不同求解方案（一种基于直接法，一种基于迭代法）的计算成本随问题规模变化的趋势，推导出决定哪种方法更优的临界点。这个练习能够极大地锻炼您在现实工程与科学计算中进行算法选型和性能预估的能力 [@problem_id:2160054]。", "problem": "一位计算科学家正在评估两种不同的数值方案，用于求解一个源于物理模型的线性方程组。问题的分辨率由单个正整数参数 $N$ 控制。方案的选择取决于它们的计算成本，该成本以浮点运算次数 (flops) 估算。\n\n**方案1：基于稀疏矩阵的直接求解器**\n该方案对整个区域进行离散化，得到一个大小为 $n_1 \\times n_1$ 的大规模稀疏线性系统。矩阵大小与分辨率参数的关系为 $n_1 = N^2$。该系统使用直接稀疏LU分解法求解。此求解器的计算成本可以很好地通过以下公式近似：\n$$F_1 = \\gamma_D n_1^{3/2}$$\n其中 $\\gamma_D$ 是一个与求解器效率和矩阵结构相关的常数。\n\n**方案2：基于稠密矩阵的迭代求解器**\n该方案使用了一种不同的公式化方法，仅需要对区域的边界进行离散化。这会得到一个规模较小但稠密的线性系统，其大小为 $n_2 \\times n_2$。此方案的矩阵大小为 $n_2 = \\gamma_S N$，其中 $\\gamma_S$ 是一个缩放常数。得到的稠密矩阵是病态的，其条件数 $\\kappa$ 随分辨率的变化关系为 $\\kappa = \\gamma_K N$，其中 $\\gamma_K$ 是另一个常数。该方案采用一个迭代求解器，其总计算成本可由以下公式估算：\n$$F_2 = \\gamma_I n_2^2 \\sqrt{\\kappa}$$\n其中 $\\gamma_I$ 是一个反映该迭代方法性质的常数。\n\n所有常数 $\\gamma_D, \\gamma_S, \\gamma_K, \\text{和} \\gamma_I$ 都是正实数。\n\n请确定临界分辨率参数 $N_{\\text{crit}}$ 的解析表达式，在该参数下两种方案的计算成本相同。答案应用常数 $\\gamma_D, \\gamma_S, \\gamma_K, \\text{和} \\gamma_I$ 来表示。", "solution": "给定两种计算成本模型，它们都是分辨率参数 $N$ 的函数。对于方案1，矩阵大小为 $n_{1} = N^{2}$，成本为\n$$\nF_{1} = \\gamma_{D} n_{1}^{3/2}.\n$$\n将 $n_{1} = N^{2}$ 代入，我们得到\n$$\nF_{1} = \\gamma_{D} (N^{2})^{3/2} = \\gamma_{D} N^{3}.\n$$\n\n对于方案2，矩阵大小为 $n_{2} = \\gamma_{S} N$，条件数为 $\\kappa = \\gamma_{K} N$。成本模型为\n$$\nF_{2} = \\gamma_{I} n_{2}^{2} \\sqrt{\\kappa}.\n$$\n将 $n_{2} = \\gamma_{S} N$ 和 $\\kappa = \\gamma_{K} N$ 代入，我们得到\n$$\nF_{2} = \\gamma_{I} (\\gamma_{S} N)^{2} \\sqrt{\\gamma_{K} N} = \\gamma_{I} \\gamma_{S}^{2} N^{2} \\gamma_{K}^{1/2} N^{1/2} = \\gamma_{I} \\gamma_{S}^{2} \\gamma_{K}^{1/2} N^{5/2}.\n$$\n\n临界分辨率 $N_{\\text{crit}}$ 由 $F_{1} = F_{2}$ 定义。令两个成本相等，\n$$\n\\gamma_{D} N^{3} = \\gamma_{I} \\gamma_{S}^{2} \\gamma_{K}^{1/2} N^{5/2}.\n$$\n由于 $N > 0$，两边同除以 $N^{5/2}$ 得到\n$$\n\\gamma_{D} N^{1/2} = \\gamma_{I} \\gamma_{S}^{2} \\gamma_{K}^{1/2}.\n$$\n解出 $N^{1/2}$ 并将两边平方，得到\n$$\nN_{\\text{crit}} = \\frac{\\gamma_{I}^{2} \\gamma_{S}^{4} \\gamma_{K}}{\\gamma_{D}^{2}}.\n$$\n所有常数均为正数，因此 $N_{\\text{crit}}$ 为正数，符合要求。", "answer": "$$\\boxed{\\frac{\\gamma_{I}^{2} \\gamma_{S}^{4} \\gamma_{K}}{\\gamma_{D}^{2}}}$$", "id": "2160054"}]}