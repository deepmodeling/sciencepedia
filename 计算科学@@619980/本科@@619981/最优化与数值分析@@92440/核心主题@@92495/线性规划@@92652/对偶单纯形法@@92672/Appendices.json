{"hands_on_practices": [{"introduction": "第一个练习通过一个相关场景将理论与实践联系起来。在应用对偶单纯形法之前，我们必须首先正确地描述问题并构建其初始单纯形表。这个练习 [@problem_id:2213009] 将指导你如何将一个涉及决策变量（如 $x_1, x_2, x_3$）的最小化问题及其“大于等于”约束转化为对偶单纯形法所需的标准形式，这是解决许多现实世界优化问题的关键第一步。", "problem": "一家半导体制造厂正在为制造一种定制芯片开发一种新工艺，该工艺涉及三种不同类型的离子注入步骤，分别表示为工艺1、工艺2和工艺3。设 $x_1, x_2, x_3$ 分别代表每种工艺运行的持续时间（单位：小时）。工厂旨在最小化的总能耗是这些持续时间的线性函数。要最小化的目标函数为 $E = 4x_1 + 3x_2 + 5x_3$，单位为兆瓦时 (MWh)。\n\n为了使芯片正常工作，必须满足两个质量控制规范。这些规范与两种类型的掺杂剂（P型和N型）所需的最小浓度有关，这些浓度是工艺持续时间的函数。\n1.  P型掺杂剂浓度约束：$2x_1 + x_2 + 3x_3 \\ge 10$ （浓度单位为任意单位）\n2.  N型掺杂剂浓度约束：$x_1 + 2x_2 + x_3 \\ge 12$ （浓度单位为任意单位）\n3.  持续时间必须为非负：$x_1, x_2, x_3 \\ge 0$。\n\n为了使用对偶单纯形法解决这个线性规划问题，您必须首先建立初始单纯形表。该方法的标准形式要求在添加松弛变量（$s_1, s_2$）以形成等式之前，将 `≥` 不等式转换为 `≤` 不等式。单纯形表应首先排列目标函数行，然后是两个约束的行。列应按 $x_1, x_2, x_3, s_1, s_2$ 的顺序列出变量。\n\n根据对偶单纯形算法的规则，确定所选的第一个主元的位置。用一对整数 `(行索引, 列索引)` 表示您的答案。这些索引指的是约束对应的系数矩阵内的位置（即，不包括目标行和右端项/RHS列）。使用1-based索引，其中行1是第一个约束行，列1对应于变量 $x_1$。", "solution": "我们需要最小化 $E = 4x_{1} + 3x_{2} + 5x_{3}$，约束条件为\n$$2x_{1} + x_{2} + 3x_{3} \\ge 10, \\quad x_{1} + 2x_{2} + x_{3} \\ge 12, \\quad x_{1},x_{2},x_{3} \\ge 0.$$\n\n对于所要求的标准形式的对偶单纯形法，通过将两边乘以 $-1$ 将 $\\ge$ 约束转换为 $\\le$ 约束，然后添加松弛变量 $s_{1}, s_{2} \\ge 0$：\n$$-2x_{1} - x_{2} - 3x_{3} + s_{1} = -10,$$\n$$-x_{1} - 2x_{2} - x_{3} + s_{2} = -12.$$\n\n将目标函数写成规范形式，松弛变量的成本为零：\n$$E - 4x_{1} - 3x_{2} - 5x_{3} = 0.$$\n\n将初始单纯形表排列成列为 $(x_{1}, x_{2}, x_{3}, s_{1}, s_{2})$ 且目标函数行在最前面（为使系数清晰，此处省略了RHS）：\n- 目标函数行系数：$(-4, -3, -5, 0, 0)$。\n- 约束1系数：$(-2, -1, -3, 1, 0)$，RHS为 $-10$。\n- 约束2系数：$(-1, -2, -1, 0, 1)$，RHS为 $-12$。\n\n由于松弛变量是基变量，$c_{B} = 0$，因此对于 $x_{1}, x_{2}, x_{3}$，其检验数为 $\\bar{c}_{j} = c_{j}$，对于 $s_{1}, s_{2}$，其检验数为 $0$。目标函数行的条目是 $-\\bar{c}_{j}$，即 $(-4,-3,-5,0,0)$，这些都是非正数，因此基是对偶可行的。右端项 $(-10,-12)$ 是负数，因此基是原始不可行的，满足对偶单纯形法的起始条件。\n\n对偶单纯形法主元选择：\n1. 选择RHS中值最小的行作为换出（离基）行。此处，$\\min\\{-10,-12\\} = -12$，因此主元行是第二个约束（行索引为 $2$）。\n2. 在主元行中系数为负的列中，计算比率 $\\bar{c}_{j}/(-a_{rj})$ 并选择最小值。在行 $2$ 中，负系数出现在列 $x_{1}, x_{2}, x_{3}$，其中 $a_{2,1} = -1$, $a_{2,2} = -2$, $a_{2,3} = -1$。使用 $\\bar{c}_{1} = 4$, $\\bar{c}_{2} = 3$, $\\bar{c}_{3} = 5$：\n$$\\frac{\\bar{c}_{1}}{-a_{2,1}} = \\frac{4}{1} = 4, \\quad \\frac{\\bar{c}_{2}}{-a_{2,2}} = \\frac{3}{2}, \\quad \\frac{\\bar{c}_{3}}{-a_{2,3}} = \\frac{5}{1} = 5.$$\n最小比率为 $\\frac{3}{2}$，在列 $x_{2}$ 处，即列索引为 $2$。\n\n因此，第一个主元位于第 $2$ 行、第 $2$ 列（即第二个约束行中 $x_{2}$ 列的条目 $-2$）。", "answer": "$$\\boxed{\\begin{pmatrix} 2 & 2 \\end{pmatrix}}$$", "id": "2213009"}, {"introduction": "有了格式正确的单纯形表，下一步就是掌握主元操作本身。这个练习 [@problem_id:2212987] 单独展示了对偶单纯形法的一次迭代，让你能够专注于核心过程：从最负的右侧值（RHS）中确定离基变量，并使用对偶比例检验选择进基变量。成功完成这次主元变换是走向最优解或其他终止状态的基础。", "problem": "考虑以下用于标准最大化问题的单纯形表，其中 $z$ 是目标函数，变量 $x_3, x_4, x_5$ 是当前的基变量。\n\n$$\n\\begin{array}{c|cccccc|c}\n\\text{基} & z & x_1 & x_2 & x_3 & x_4 & x_5 & \\text{右端项} \\\\\n\\hline\nz & 1 & 3 & 2 & 0 & 0 & 0 & 50 \\\\\n\\hline\nx_3 & 0 & 1 & 3 & 1 & 0 & 0 & 10 \\\\\nx_4 & 0 & -1 & 2 & 0 & 1 & 0 & -4 \\\\\nx_5 & 0 & -2 & -1 & 0 & 0 & 1 & -5 \\\\\n\\end{array}\n$$\n\n使用对偶单纯形法执行一次枢轴操作。在这次单次迭代后，确定新的基变量集合。报告这些新基变量的值以及目标函数 $z$ 的值。将基变量的值按照其变量下标的升序排列。您的答案应该是一个包含这些值，后跟 $z$ 值的单行矩阵。例如，如果新的基变量是 $x_a, x_b, x_c$ 且 $a<b<c$，您应该以 $[x_a, x_b, x_c, z]$ 的格式报告您的答案。", "solution": "我们应用对偶单纯形法，因为当前基 $\\{x_{3},x_{4},x_{5}\\}$ 导致 $x_{4}$ 和 $x_{5}$ 的右端项为负，这表明原始问题不可行，而 $z$ 行中非基变量 $x_{1},x_{2}$ 的判别数是非负的，这表明在 $z_{j}-c_{j}$ 准则下对偶问题可行。\n\n步骤 1：选择右端项值最小的基变量作为出基变量。从表中可知，基行的右端项值分别为 $10$ （对于 $x_{3}$），$-4$ （对于 $x_{4}$），和 $-5$ （对于 $x_{5}$）。最小的值是 $-5$，所以 $x_{5}$ 是出基变量。\n\n步骤 2：使用对偶单纯形法的比率检验选择进基变量。对于枢轴行（$x_{5}$ 行），考虑满足 $a_{rj}<0$ 的列 $j$。在 $x_5$ 行中，$a_{5,1}=-2$ 和 $a_{5,2}=-1$，所以候选变量是 $x_1$ 和 $x_2$。将 $z$ 行的条目解释为 $z_{j}-c_{j}$，我们计算\n$$\n\\min\\left\\{\\frac{z_{1}-c_{1}}{-a_{5,1}}, \\frac{z_{2}-c_{2}}{-a_{5,2}}\\right\\} = \\min\\left\\{\\frac{3}{2}, \\frac{2}{1}\\right\\} = \\min\\{1.5, 2\\} = 1.5\n$$\n最小值为 $1.5$，所以 $x_{1}$ 是进基变量。枢轴元素是位于 $x_5$ 行和 $x_1$ 列交点处的 $-2$。\n\n步骤 3：执行枢轴操作。首先将枢轴行乘以 $-\\frac{1}{2}$ 以使枢轴元素变为 1：\n$$\nR_{5}'=\\left[\\,0,\\;1,\\;\\frac{1}{2},\\;0,\\;0,\\;-\\frac{1}{2}\\;\\middle|\\;\\frac{5}{2}\\right].\n$$\n从其他行中消去 $x_{1}$：\n\n- 新的 $z$ 行：$R_{z}'=R_{z}-3R_{5}'$ 得到\n$$\n[\\,1,\\;0,\\;\\tfrac{1}{2},\\;0,\\;0,\\;\\tfrac{3}{2}\\;|\\;\\tfrac{85}{2}\\,].\n$$\n\n- 新的 $x_{3}$ 行：$R_{3}'=R_{3}-R_{5}'$ 得到\n$$\n[\\,0,\\;0,\\;\\tfrac{5}{2},\\;1,\\;0,\\;\\tfrac{1}{2}\\;|\\;\\tfrac{15}{2}\\,].\n$$\n\n- 新的 $x_{4}$ 行：$R_{4}'=R_{4}+R_{5}'$ 得到\n$$\n[\\,0,\\;0,\\;\\tfrac{5}{2},\\;0,\\;1,\\;-\\tfrac{1}{2}\\;|\\;-\\tfrac{3}{2}\\,].\n$$\n\n在这次单次对偶单纯形迭代之后，基变量为 $\\{x_{1},x_{3},x_{4}\\}$，非基变量为 $\\{x_{2},x_{5}\\}$。将非基变量设置为 0，基变量的值可以从它们所在行的右端项读取：\n$$\nx_{1}=\\frac{5}{2},\\quad x_{3}=\\frac{15}{2},\\quad x_{4}=-\\frac{3}{2}.\n$$\n目标函数值是 $z$ 行的右端项：\n$$\nz=\\frac{85}{2}.\n$$\n将基变量 $(x_{1},x_{3},x_{4})$ 按下标升序排列，所求的行是 $\\left[\\frac{5}{2},\\,\\frac{15}{2},\\, -\\frac{3}{2},\\, \\frac{85}{2}\\right]$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{5}{2} & \\frac{15}{2} & -\\frac{3}{2} & \\frac{85}{2}\\end{pmatrix}}$$", "id": "2212987"}, {"introduction": "一个算法只有在我们能解释其结论时才有用。对偶单纯形法可以以不同方式终止，并不总是得到一个最优的目标函数值 $Z$。这最后一个练习 [@problem_id:2212994] 展示了一个关键场景，其中算法证明了原始问题没有可行解。通过遵循这些步骤，你将学会识别标志着不可行性的特定单纯形表条件，这是该方法提供的一个强大洞见。", "problem": "给定以下最大化线性规划（LP）问题的初始单纯形表。决策变量为 $x_1$ 和 $x_2$，松弛变量为 $s_1$ 和 $s_2$，目标函数值为 $Z$。顶行代表目标函数方程 $Z - x_1 - x_2 = 0$。\n\n```\n+--------------+---+----+----+----+----+-----+\n| Basic Var.   | Z | x1 | x2 | s1 | s2 | RHS |\n+--------------+---+----+----+----+----+-----+\n| Z            | 1 |  1 |  1 |  0 |  0 |   0 |\n| s1           | 0 | -1 | -1 |  1 |  0 |  -5 |\n| s2           | 0 |  1 |  1 |  0 |  1 |   2 |\n+--------------+---+----+----+----+-----+\n```\n\n该单纯形表是对偶可行的（目标行中非基变量的系数均为非负），但不是原始可行的（至少有一个右端（RHS）值为负）。你的任务是对该单纯形表应用对偶单纯形法，直到满足终止条件。根据单纯形表的最终状态，关于相关LP问题的性质，哪个结论是正确的？\n\nA. 问题有唯一最优解。\n\nB. 问题有多重最优解。\n\nC. 问题不可行。\n\nD. 问题无界。\n\nE. 对偶单纯形法无法应用于此单纯形表。", "solution": "我们得到一个最大化LP单纯形表，它是对偶可行的（目标行中非基变量的条目为非负），但不是原始可行的（一个基变量的RHS值为负）。适用对偶单纯形法。\n\n初始单纯形表（各行解释为方程）：\n- 目标行：$Z - x_{1} - x_{2} = 0$，检验数 $\\bar{c}_{x_{1}} = 1$，$\\bar{c}_{x_{2}} = 1$（非负）。\n- 约束行：\n  - $-x_{1} - x_{2} + s_{1} = -5$（基变量 $s_{1}$ 的RHS值为 $-5 < 0$）。\n  - $x_{1} + x_{2} + s_{2} = 2$（基变量 $s_{2}$ 的RHS值为 $2 \\ge 0$）。\n\n对偶单纯形枢轴变换规则：\n- 选择RHS值最小的行 $r$ 作为出基行。此处 $r$ 是 $s_{1}$ 所在行，因为 $-5$ 是最小的值。\n- 在满足 $a_{rj} < 0$ 的列 $j$ 中，选择使 $\\bar{c}_{j} / |a_{rj}|$ 最小的 $j$ 作为入基列。\n\n对于行 $r$（$s_{1}$ 所在行），系数为 $a_{r,x_{1}} = -1$，$a_{r,x_{2}} = -1$，检验数为 $\\bar{c}_{x_{1}} = 1$，$\\bar{c}_{x_{2}} = 1$。比率为\n$$\n\\frac{\\bar{c}_{x_{1}}}{|a_{r,x_{1}}|} = \\frac{1}{1} = 1, \\quad \\frac{\\bar{c}_{x_{2}}}{|a_{r,x_{2}}|} = \\frac{1}{1} = 1.\n$$\n出现相同值；选择 $x_{1}$ 作为入基变量。在 $a_{r,x_{1}} = -1$ 上进行枢轴变换。\n\n执行枢轴变换：\n- 缩放枢轴行：新 $r$ 行 $:= (-1)\\times$ 旧 $r$ 行，得到\n$$\nx_{1} + x_{2} - s_{1} = 5.\n$$\n- 从其他行中消去 $x_{1}$：\n  - 新 $Z$ 行 $:=$ 旧 $Z$ 行 $-$ ($Z$ 行中 $x_{1}$ 的系数)$\\times$ 新 $r$ 行：\n    $$\n    (Z - x_{1} - x_{2} = 0) - 1\\cdot(x_{1} + x_{2} - s_{1} = 5)\n    \\;\\Rightarrow\\;\n    Z - 2x_{2} + s_{1} = -5.\n    $$\n    非基变量的检验数保持为 $\\bar{c}_{x_{2}} = 0$ 和 $\\bar{c}_{s_{1}} = 1$，均为非负，因此保持了对偶可行性。\n  - 新 $s_{2}$ 行 $:=$ 旧 $s_{2}$ 行 $-$ ($s_{2}$ 行中 $x_{1}$ 的系数)$\\times$ 新 $r$ 行：\n    $$\n    (x_{1} + x_{2} + s_{2} = 2) - 1\\cdot(x_{1} + x_{2} - s_{1} = 5)\n    \\;\\Rightarrow\\;\n    s_{1} + s_{2} = -3.\n    $$\n\n现在基变量为 $x_{1}$ 和 $s_{2}$，其RHS值分别为 $5$ 和 $-3$。该单纯形表仍然是对偶可行的（目标行中非基变量的系数为非负），但不是原始可行的，因为 $s_{2}$ 所在行的RHS值为 $-3 < 0$。\n\n再次应用对偶单纯形步骤：\n- 选择出基行：$s_{2}$ 所在行（RHS值为 $-3$，是负数）。\n- 确定入基变量：我们需要一个非基列 $j$ 且其在 $s_{2}$ 行的系数 $a_{rj} < 0$，以便在提高原始可行性的同时保持对偶可行性。此阶段的非基变量是 $x_{2}$ 和 $s_{1}$。在 $s_{2}$ 所在行，我们有系数\n$$\na_{r,x_{2}} = 0, \\quad a_{r,s_{1}} = 1,\n$$\n两者均不为负。因此，没有合格的入基变量（对于任何非基变量 $j$，都没有 $a_{rj} < 0$）。\n\n这是对偶单纯形法的不可行证明：如果一个出基行具有负的RHS值，并且在任何具有非负检验数的非基列中都没有系数 $a_{rj} < 0$，那么没有任何枢轴变换可以在保持对偶可行性的同时恢复原始可行性，原始LP问题是不可行的。\n\n作为独立检验，初始单纯形表所隐含的原始约束是\n$$\n-x_{1} - x_{2} + s_{1} = -5 \\;\\Rightarrow\\; x_{1} + x_{2} \\ge 5,\n$$\n$$\nx_{1} + x_{2} + s_{2} = 2 \\;\\Rightarrow\\; x_{1} + x_{2} \\le 2,\n$$\n其中 $s_{1} \\ge 0$，$s_{2} \\ge 0$。这些约束是不一致的，从而证实了不可行性。\n\n因此，相关的LP问题是不可行的。", "answer": "$$\\boxed{C}$$", "id": "2212994"}]}