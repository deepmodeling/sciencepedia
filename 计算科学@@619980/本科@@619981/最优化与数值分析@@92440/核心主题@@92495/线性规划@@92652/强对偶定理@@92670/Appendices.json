{"hands_on_practices": [{"introduction": "我们的第一个练习是拉格朗日对偶性的一个经典且直观的应用。我们将寻找平面上一条直线距离原点最近的点。这个问题将直观地展示原始问题（最小化距离）和其对偶问题如何得到相同的最优值，从而在一个清晰的几何情境中验证强对偶定理 [@problem_id:2221847]。", "problem": "考虑一个定义在 $\\mathbb{R}^2$ 上的优化问题。其目标是找到一个点 $(x, y)$，以最小化该点到原点的平方欧几里得距离，此距离由函数 $f_0(x, y) = x^2 + y^2$ 给出。该最小化问题受一个线性等式约束 $ax + by = c$ 的限制，其中 $a, b, c$ 均为非零实常数。此公式被称为原始问题。令该原始问题的最优值为 $p^*$。\n\n相应的拉格朗日对偶问题涉及最大化拉格朗日对偶函数 $g(\\nu)$。令该对偶问题的最优值为 $d^*$。\n\n您的任务是确定原始最优值 $p^*$ 和对偶最优值 $d^*$ 关于常数 $a, b, c$ 的解析表达式。\n\n请将您的最终答案表示为一个 $1 \\times 2$ 的行矩阵，其中第一个元素为 $p^*$ 的值，第二个元素为 $d^*$ 的值。", "solution": "我们正在最小化凸二次函数 $f_{0}(x,y)=x^{2}+y^{2}$，其约束条件为仿射等式约束 $ax+by=c$，由于 $a\\neq 0$ 且 $b\\neq 0$，因此可行集非空，KKT 条件是充分且必要的。\n\n构建拉格朗日函数，其中对偶变量为 $\\nu\\in\\mathbb{R}$：\n$$\nL(x,y,\\nu)=x^{2}+y^{2}+\\nu(ax+by-c).\n$$\n关于 $x$ 和 $y$ 的驻点条件要求\n$$\n\\frac{\\partial L}{\\partial x}=2x+\\nu a=0,\\qquad \\frac{\\partial L}{\\partial y}=2y+\\nu b=0,\n$$\n得到\n$$\nx=-\\frac{\\nu a}{2},\\qquad y=-\\frac{\\nu b}{2}.\n$$\n施加原始可行性条件 $ax+by=c$ 可得\n$$\na\\left(-\\frac{\\nu a}{2}\\right)+b\\left(-\\frac{\\nu b}{2}\\right)=c\n\\;\\;\\Longrightarrow\\;\\;\n-\\frac{\\nu}{2}(a^{2}+b^{2})=c\n\\;\\;\\Longrightarrow\\;\\;\n\\nu^{\\star}=-\\frac{2c}{a^{2}+b^{2}}.\n$$\n因此，原始最优点是\n$$\nx^{\\star}=\\frac{ac}{a^{2}+b^{2}},\\qquad y^{\\star}=\\frac{bc}{a^{2}+b^{2}},\n$$\n原始最优值为\n$$\np^{\\star}=(x^{\\star})^{2}+(y^{\\star})^{2}\n=\\frac{a^{2}c^{2}+b^{2}c^{2}}{(a^{2}+b^{2})^{2}}\n=\\frac{c^{2}}{a^{2}+b^{2}}.\n$$\n\n对于对偶问题，对偶函数为 $g(\\nu)=\\inf_{x,y}L(x,y,\\nu)$，通过代入驻点 $x=-\\nu a/2$ 和 $y=-\\nu b/2$ 得到：\n$$\nx^{2}+y^{2}=\\frac{\\nu^{2}}{4}(a^{2}+b^{2}),\\qquad\nax+by=-\\frac{\\nu}{2}(a^{2}+b^{2}),\n$$\n所以\n$$\ng(\\nu)=\\frac{\\nu^{2}}{4}(a^{2}+b^{2})+\\nu\\left(-\\frac{\\nu}{2}(a^{2}+b^{2})-c\\right)\n=-\\frac{a^{2}+b^{2}}{4}\\nu^{2}-c\\nu.\n$$\n对偶问题是 $\\max_{\\nu\\in\\mathbb{R}}g(\\nu)$；求导并令其为零：\n$$\ng'(\\nu)=-\\frac{a^{2}+b^{2}}{2}\\nu-c=0\n\\;\\;\\Longrightarrow\\;\\;\n\\nu^{\\star}=-\\frac{2c}{a^{2}+b^{2}}.\n$$\n计算对偶最优值，\n$$\nd^{\\star}=g(\\nu^{\\star})\n=-\\frac{a^{2}+b^{2}}{4}\\left(\\frac{4c^{2}}{(a^{2}+b^{2})^{2}}\\right)-c\\left(-\\frac{2c}{a^{2}+b^{2}}\\right)\n=-\\frac{c^{2}}{a^{2}+b^{2}}+\\frac{2c^{2}}{a^{2}+b^{2}}\n=\\frac{c^{2}}{a^{2}+b^{2}}.\n$$\n由于该问题是凸问题，带有仿射等式约束，并且存在可行点，因此强对偶性成立，所以 $p^{\\star}=d^{\\star}=\\frac{c^{2}}{a^{2}+b^{2}}$。\n\n因此，所要求的 $1\\times 2$ 行矩阵为 $\\begin{pmatrix}p^{\\star} & d^{\\star}\\end{pmatrix}=\\begin{pmatrix}\\frac{c^{2}}{a^{2}+b^{2}} & \\frac{c^{2}}{a^{2}+b^{2}}\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{c^{2}}{a^{2}+b^{2}} & \\frac{c^{2}}{a^{2}+b^{2}}\\end{pmatrix}}$$", "id": "2221847"}, {"introduction": "在上一个练习的基础上，这个问题通过将解限制在一个线段而非整条直线上，引入了不等式约束。这个实践对于理解卡罗需-库恩-塔克 (Karush-Kuhn-Tucker, KKT) 条件和互补松弛性至关重要。你将看到对偶变量如何像“指示器”一样，告诉我们最优解是位于可行域的内部还是边界上 [@problem_id:2221842]。", "problem": "一个点机器人必须在二维笛卡尔平面中沿一条直线段路径移动。该路径的起点为 $A=(1, 5)$，终点为 $B=(5, 3)$。为执行一项监测任务，需要找到该路径上距离位于原点 $(0,0)$ 的一个静止传感器最近的点。\n\n这个几何问题可以表述为一个约束优化问题。线段上的点可以由 $P(t) = (1-t)A + tB$ 参数化，其中参数 $t$ 的取值范围被约束在区间 $[0, 1]$ 内。目标是最小化从原点到点 $P(t)$ 的欧几里得距离的平方。\n\n设 $d_{min}^2$ 为最小平方距离。在此类问题的标准形式中，我们为关于 $t$ 的不等式约束引入拉格朗日乘数（对偶变量）。设 $\\lambda_1$ 为约束 $t \\ge 0$（可写作 $-t \\le 0$）的拉格朗日乘数，$\\lambda_2$ 为约束 $t \\le 1$（可写作 $t-1 \\le 0$）的拉格朗日乘数。\n\n确定最小平方距离 $d_{min}^2$ 的数值，以及对应的拉格朗日乘数 $\\lambda_1$ 和 $\\lambda_2$ 的最优值。请以三元组 $(d_{min}^2, \\lambda_1, \\lambda_2)$ 的形式给出答案。", "solution": "我们用 $P(t)=(1-t)A+tB$ 来参数化线段上的点，其中 $A=(1,5)$ 且 $B=(5,3)$。因此\n$$\nP(t)=(1,5)+t\\big((5,3)-(1,5)\\big)=(1,5)+t(4,-2)=(1+4t,\\,5-2t),\n$$\n约束条件为 $t\\in[0,1]$。\n\n从原点到该点的欧几里得距离平方即为目标函数\n$$\nf(t)=\\|P(t)\\|^{2}=(1+4t)^{2}+(5-2t)^{2}.\n$$\n展开后，\n$$\n(1+4t)^{2}=1+8t+16t^{2},\\qquad (5-2t)^{2}=25-20t+4t^{2},\n$$\n故\n$$\nf(t)=\\big(1+8t+16t^{2}\\big)+\\big(25-20t+4t^{2}\\big)=20t^{2}-12t+26.\n$$\n\n我们将其表述为一个带有不等式约束 $g_{1}(t)=-t\\le 0$ 和 $g_{2}(t)=t-1\\le 0$ 的约束优化问题。拉格朗日函数为\n$$\n\\mathcal{L}(t,\\lambda_{1},\\lambda_{2})=20t^{2}-12t+26+\\lambda_{1}(-t)+\\lambda_{2}(t-1),\n$$\n其中 $\\lambda_{1}\\ge 0$ 且 $\\lambda_{2}\\ge 0$。\n\nKarush–Kuhn–Tucker 条件如下：\n- 平稳性条件：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial t}=40t-12-\\lambda_{1}+\\lambda_{2}=0.\n$$\n- 原始可行性： $0\\le t\\le 1$。\n- 对偶可行性： $\\lambda_{1}\\ge 0$, $\\lambda_{2}\\ge 0$。\n- 互补松弛性：\n$$\n\\lambda_{1}(-t)=0\\quad\\Longleftrightarrow\\quad \\lambda_{1}t=0,\\qquad \\lambda_{2}(t-1)=0.\n$$\n\n首先，我们通过令 $f'(t)=0$ 来求 $f(t)$ 的无约束最小值点：\n$$\nf'(t)=40t-12=0\\quad\\Longrightarrow\\quad t^{*}=\\frac{12}{40}=\\frac{3}{10}.\n$$\n由于 $t^{*}=\\frac{3}{10}\\in(0,1)$，两个不等式约束均未激活（即严格不等式成立）：$-t^{*}<0$ 且 $t^{*}-1<0$。根据互补松弛性条件，这蕴含着\n$$\n\\lambda_{1}^{*}=0,\\qquad \\lambda_{2}^{*}=0.\n$$\n代入这些值，平稳性条件简化为 $40t-12=0$，验证了 $t^{*}=\\frac{3}{10}$。\n\n计算最小平方距离：\n$$\nd_{\\min}^{2}=f\\!\\left(\\frac{3}{10}\\right)=20\\left(\\frac{3}{10}\\right)^{2}-12\\left(\\frac{3}{10}\\right)+26=20\\cdot \\frac{9}{100}-\\frac{36}{10}+26=\\frac{9}{5}-\\frac{18}{5}+26=26-\\frac{9}{5}=\\frac{121}{5}.\n$$\n\n因此，最优元组为 $\\left(d_{\\min}^{2},\\lambda_{1}^{*},\\lambda_{2}^{*}\\right)=\\left(\\frac{121}{5},0,0\\right)$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{121}{5} & 0 & 0\\end{pmatrix}}$$", "id": "2221842"}, {"introduction": "为了展示对偶理论在简单二次问题之外的通用性，我们的最后一个练习将最小化一个由指数项描述的能量函数。这类函数在统计力学和信息论等领域很常见。通过解决这个问题，你将练习处理非多项式目标函数，并巩固你对推导和求解对偶问题的掌握 [@problem_id:2221850]。", "problem": "一个系统由两个状态变量 $x$ 和 $y$ 描述，它们受到关系 $x+y=2$ 的约束。系统的总“能量”由函数 $E(x,y) = \\exp(x) + \\exp(y)$ 给出。一位工程师声称，当状态变量相等时，即 $x=y=1$ 时，该系统达到最小可能能量。\n\n您的任务是确定该系统的真实最小能量 $E_{\\text{min}}$。为此，您将使用拉格朗日对偶框架来分析此问题。已知该问题是凸问题，并满足保证强对偶性的约束条件，这意味着最优原始值等于最优对偶值。\n\n求最小能量 $E_{\\text{min}}$。请用一个单一、精确的解析表达式表示您的答案。", "solution": "我们考虑在仿射约束 $x+y=2$ 下最小化 $E(x,y)=\\exp(x)+\\exp(y)$ 的凸优化问题。该问题是凸的，并满足保证强对偶性的正则性条件，因此最优原始值等于最优对偶值。\n\n针对等式约束 $x+y-2=0$ 构造拉格朗日函数，其中乘子为 $\\lambda$：\n$$\nL(x,y,\\lambda)=\\exp(x)+\\exp(y)+\\lambda(x+y-2).\n$$\n对偶函数为\n$$\ng(\\lambda)=\\inf_{x,y}L(x,y,\\lambda)=\\inf_{x}\\big(\\exp(x)+\\lambda x\\big)+\\inf_{y}\\big(\\exp(y)+\\lambda y\\big)-2\\lambda.\n$$\n考虑一般形式的下确界 $\\inf_{t}\\big(\\exp(t)+\\lambda t\\big)$。它关于 $t$ 的导数是 $\\exp(t)+\\lambda$。令其为零得到平稳性条件\n$$\n\\exp(t)+\\lambda=0 \\quad \\Rightarrow \\quad \\exp(t)=-\\lambda.\n$$\n这要求 $\\lambda<0$，此时唯一的极小值点是 $t^{*}=\\ln(-\\lambda)$。在此极小值点上求值可得\n$$\n\\inf_{t}\\big(\\exp(t)+\\lambda t\\big)=\\exp(t^{*})+\\lambda t^{*}=-\\lambda+\\lambda\\ln(-\\lambda).\n$$\n因此，对于 $\\lambda<0$,\n$$\ng(\\lambda)=2\\big(-\\lambda+\\lambda\\ln(-\\lambda)\\big)-2\\lambda=-4\\lambda+2\\lambda\\ln(-\\lambda).\n$$\n当 $\\lambda=0$ 时，$\\inf_{t}\\exp(t)=0$，因此 $g(0)=0$。当 $\\lambda>0$ 时，$\\inf_{t}\\big(\\exp(t)+\\lambda t\\big)=-\\infty$，所以 $g(\\lambda)=-\\infty$。因此有效域为 $\\lambda\\leq 0$，其中上述表达式在 $\\lambda<0$ 时有效，并连续至 $\\lambda=0$。\n\n在 $\\lambda\\leq 0$ 上最大化 $g(\\lambda)$。对于 $\\lambda<0$,\n$$\ng'(\\lambda) = \\frac{d}{d\\lambda}\\big(-4\\lambda+2\\lambda\\ln(-\\lambda)\\big) = -4 + 2\\big(\\ln(-\\lambda)+1\\big) = 2\\ln(-\\lambda)-2,\n$$\n并且\n$$\ng''(\\lambda)=\\frac{d}{d\\lambda}\\big(2\\ln(-\\lambda)-2\\big)=\\frac{2}{\\lambda}<0 \\quad \\text{for } \\lambda<0,\n$$\n所以 $g$ 在其定义域上是严格凹的，这与对偶函数的性质相符。令 $g'(\\lambda)=0$ 可得\n$$\n2\\ln(-\\lambda)-2=0 \\quad \\Rightarrow \\quad \\ln(-\\lambda)=1 \\quad \\Rightarrow \\quad -\\lambda=\\exp(1),\n$$\n因此唯一的极大值点是 $\\lambda^{*}=-\\exp(1)$。最优对偶值为\n$$\ng(\\lambda^{*})=-4\\lambda^{*}+2\\lambda^{*}\\ln(-\\lambda^{*})= -4\\big(-\\exp(1)\\big)+2\\big(-\\exp(1)\\big)\\cdot 1=4\\exp(1)-2\\exp(1)=2\\exp(1).\n$$\n根据强对偶性，最优原始值等于最优对偶值，所以最小能量为 $E_{\\text{min}}=2\\exp(1)$。\n\n为完整起见，KKT条件给出了原始最优点。平稳性条件要求\n$$\n\\frac{\\partial L}{\\partial x}=\\exp(x)+\\lambda=0, \\quad \\frac{\\partial L}{\\partial y}=\\exp(y)+\\lambda=0,\n$$\n所以 $\\exp(x)=\\exp(y)=-\\lambda=\\exp(1)$，这意味着 $x=y=1$。这满足 $x+y=2$ 并得出 $E(1,1)=\\exp(1)+\\exp(1)=2\\exp(1)$，与对偶最优值相匹配。", "answer": "$$\\boxed{2\\exp(1)}$$", "id": "2221850"}]}