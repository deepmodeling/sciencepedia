{"hands_on_practices": [{"introduction": "掌握按比例缩放部分主元法的关键在于其第一步：计算比例因子向量并选择初始主元行。这个练习让您专注于这个基础操作，确保您能准确地为一个给定的矩阵启动主元选择过程。这是后续所有消元步骤的基石。[@problem_id:2199854]", "problem": "考虑线性方程组 $A\\mathbf{x} = \\mathbf{b}$，其中矩阵 $A$ 为：\n$$ A = \\begin{pmatrix} 2 & 1 & -5 \\\\ -4 & 8 & 2 \\\\ 3 & -1 & 4 \\end{pmatrix} $$\n当使用缩放部分主元策略的高斯消元法求解该方程组时，过程首先确定一个初始比例向量并选择第一个主元行。比例向量 $\\mathbf{s}$ 是一个列向量，其第 $i$ 个分量 $s_i$ 是矩阵 $A$ 的第 $i$ 行元素的最大绝对值（即 $s_i = \\max_{j} |a_{ij}|$）。然后，通过找出使比值 $\\frac{|a_{p1}|}{s_p}$ 最大的行索引 $p$ 来选择第一个主元行。\n\n下列哪个选项正确地指出了初始比例向量 $\\mathbf{s}$（为方便显示，写成行向量）和第一个主元行的索引？（假设行从1开始索引）。\n\nA. 比例向量 $[5, 8, 4]$，第一个主元行为 2。\n\nB. 比例向量 $[2, 4, 3]$，第一个主元行为 2。\n\nC. 比例向量 $[5, 8, 4]$，第一个主元行为 3。\n\nD. 比例向量 $[8, 14, 8]$，第一个主元行为 3。\n\nE. 比例向量 $[5, 8, 4]$，第一个主元行为 1。", "solution": "我们使用缩放部分主元法。对于每一行 $i$，比例因子 $s_{i}$ 定义为 $s_{i}=\\max_{j}|a_{ij}|$。对于给定的矩阵\n$$\nA=\\begin{pmatrix}\n2 & 1 & -5\\\\\n-4 & 8 & 2\\\\\n3 & -1 & 4\n\\end{pmatrix},\n$$\n我们计算每行元素绝对值的最大值：\n- 第 1 行：$\\max(|2|,|1|,|{-5}|)=5$，所以 $s_{1}=5$。\n- 第 2 行：$\\max(|{-4}|,|8|,|2|)=8$，所以 $s_{2}=8$。\n- 第 3 行：$\\max(|3|,|{-1}|,|4|)=4$，所以 $s_{3}=4$。\n\n因此，初始比例向量（显示为行向量）是 $[5,8,4]$。\n\n为选择第一个主元行，我们计算 $i=1,2,3$ 时的比值 $r_{i}=\\frac{|a_{i1}|}{s_{i}}$：\n$$\nr_{1}=\\frac{|2|}{5}=\\frac{2}{5},\\quad\nr_{2}=\\frac{|{-4}|}{8}=\\frac{4}{8}=\\frac{1}{2},\\quad\nr_{3}=\\frac{|3|}{4}=\\frac{3}{4}.\n$$\n最大比值为 $\\frac{3}{4}$，在第 3 行取得。因此，第一个主元行的索引是 $3$。\n\n与选项比较，这对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "2199854"}, {"introduction": "高斯消元法是一个迭代过程，主元选择贯穿始终。这个练习将带您超越第一步，在一个特殊的 $4 \\times 4$ 矩阵上逐步地应用按比例缩放部分主元策略。通过追踪完整的主元选择序列，您将深入理解该算法的动态执行流程。[@problem_id:2199837]", "problem": "在数值线性代数中，按比例部分主元法是一种在诸如高斯消去法或LU分解等算法中选择主元的策略，用以减轻舍入误差的影响。该过程可总结如下：\n\n首先，对于原始的 $n \\times n$ 矩阵 $A$，为每一行 $i=1, \\dots, n$ 计算一个比例因子 $s_i$。该比例因子定义为该行中所有元素绝对值的最大值：$s_i = \\max_{1 \\le j \\le n} |A_{ij}|$。\n\n然后，对于消去过程的每一步 $k$（从 $k=1$ 到 $n-1$）：\n1. 对于部分处理后矩阵中从当前第 $k$ 行到第 $n$ 行的每个候选行 $i$，计算一个比率。该比率为该行在主元列（第 $k$ 列）中元素的绝对值除以该行的比例因子（比例因子始终是根据原始矩阵计算得出的）。\n2. 产生最大比率的行被选为第 $k$ 步的主元行。设该被选行的*原始*索引为 $p_k$。\n3. 将当前第 $k$ 行与该主元行交换。\n4. 执行消去操作，在第 $k$ 列的主元元素下方产生零。\n\n考虑给定的 $4 \\times 4$ 矩阵 $A$：\n$$A = \\begin{pmatrix} 0 & 0 & 0 & 8 \\\\ 0 & 0 & 2 & 0 \\\\ 0 & 4 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\end{pmatrix}$$\n确定消去过程前三步所选择的主元行序列 $(p_1, p_2, p_3)$。每个 $p_k$ 必须是在第 $k$ 步被选为主元的行的*原始*行索引（1, 2, 3, 或 4）。\n\n将您的答案表示为由这三个整数索引组成的行矩阵。", "solution": "我们应用按比例部分主元法。首先从原始矩阵 $A$ 计算行比例因子：\n$$s_{1}=\\max(|0|,|0|,|0|,|8|)=8,\\quad s_{2}=\\max(|0|,|0|,|2|,|0|)=2,\\quad s_{3}=\\max(|0|,|4|,|0|,|0|)=4,\\quad s_{4}=\\max(|1|,|0|,|0|,|0|)=1.$$\n\n第 $k=1$ 步，主元列为第1列，候选行为当前第1行至第4行（初始时与原始行相同）。各比率为\n$$\\frac{|A_{11}|}{s_{1}}=\\frac{0}{8}=0,\\quad \\frac{|A_{21}|}{s_{2}}=\\frac{0}{2}=0,\\quad \\frac{|A_{31}|}{s_{3}}=\\frac{0}{4}=0,\\quad \\frac{|A_{41}|}{s_{4}}=\\frac{1}{1}=1.$$\n最大比率出现在当前第4行，其原始索引为 $p_{1}=4$。交换当前第1行和第4行。按原始索引表示的当前行顺序变为 $(4,2,3,1)$。在第1列主元下方的消去操作不产生任何变化，因为这些元素已经为零。\n\n第 $k=2$ 步，主元列为第2列，候选行为当前第2行至第4行，其原始索引为 $(2,3,1)$。使用 $k=1$ 步交换后的当前矩阵，第2列的元素和比率分别为\n$$\\text{当前第2行 (原始第2行)}:\\ \\frac{|a_{22}|}{s_{2}}=\\frac{0}{2}=0,\\quad \\text{当前第3行 (原始第3行)}:\\ \\frac{|a_{32}|}{s_{3}}=\\frac{4}{4}=1,\\quad \\text{当前第4行 (原始第1行)}:\\ \\frac{|a_{42}|}{s_{1}}=\\frac{0}{8}=0.$$\n最大比率出现在当前第3行，其原始索引为 $p_{2}=3$。交换当前第2行和第3行。按原始索引表示的当前行顺序变为 $(4,3,2,1)$。在第2列主元下方的消去操作不产生任何变化，因为这些元素为零。\n\n第 $k=3$ 步，主元列为第3列，候选行为当前第3行至第4行，其原始索引为 $(2,1)$。各比率为\n$$\\text{当前第3行 (原始第2行)}:\\ \\frac{|a_{33}|}{s_{2}}=\\frac{2}{2}=1,\\quad \\text{当前第4行 (原始第1行)}:\\ \\frac{|a_{43}|}{s_{1}}=\\frac{0}{8}=0.$$\n最大比率出现在当前第3行，其原始索引为 $p_{3}=2$。不需要进行交换。 \n\n因此，主元行序列为 $(p_{1},p_{2},p_{3})=(4,3,2)$。", "answer": "$$\\boxed{\\begin{pmatrix}4 & 3 & 2\\end{pmatrix}}$$", "id": "2199837"}, {"introduction": "主元的选择有时会对矩阵中的数值变化非常敏感。这个进階练习挑战您超越机械的计算，去分析矩阵内一个参数的改变如何影响后续步骤中的主元决策。解决这个问题将帮助您洞察该算法行为的微妙之处，并理解为何初始矩阵的全局结构（通过比例因子向量 $s$ 体现）至关重要。[@problem_id:2199850]", "problem": "在应用高斯消元法求解线性方程组 $A\\mathbf{x} = \\mathbf{b}$ 时，通常采用主元策略来增强数值稳定性。其中一种策略是比例部分主元法。在这种方法中，在第 $k$ 步消元之前，我们从行集合 $\\{k, k+1, \\dots, n\\}$ 中选择一个主元行。所选的主元行（其索引记为 $p$）是使潜在主元元素的绝对值与该行预先计算的比例因子之比值达到最大的那一行。具体来说，我们找到 $p$ 使得\n$$\n\\frac{|A_{pk}^{(k-1)}|}{s_p} = \\max_{i=k, \\dots, n} \\frac{|A_{ik}^{(k-1)}|}{s_i}\n$$\n其中 $A_{ij}^{(k-1)}$ 表示经过前 $k-1$ 步消元后的矩阵元素，而每行 $i$ 的比例因子 $s_i$ 仅由原始矩阵 $A^{(0)} = A$ 一次性确定，即 $s_i = \\max_{j=1, \\dots, n} |A_{ij}|$。如果最大比值出现平局，则选择索引最小的行作为主元行。\n\n考虑如下定义的 $3 \\times 3$ 矩阵 $A$：\n$$\nA = \\begin{pmatrix}\n10 & 2 & -1 \\\\\n5 & 20 & 5 \\\\\n-2 & C & 8\n\\end{pmatrix}\n$$\n其中 $C$ 是一个实数参数。当对该矩阵执行比例部分主元法进行高斯消元时，已知在 $C=18$ 的情况下，选择的第二个主元行（用于第二步消元）是第 3 行。\n\n请确定严格小于 18 的最大正整数 $C$ 的值，使得第二个主元行变为第 2 行。", "solution": "我们应用比例部分主元法。由原始矩阵 $A$ 一次性计算出的行比例因子为\n$$\ns_{1}=\\max\\{|10|,|2|,|{-1}|\\}=10,\\quad s_{2}=\\max\\{|5|,|20|,|5|\\}=20,\\quad s_{3}=\\max\\{|{-2}|,|C|,|8|\\}=\\max\\{8,|C|\\}.\n$$\n在第一步（$k=1$）中，选择比值为\n$$\n\\frac{|A_{11}|}{s_{1}}=\\frac{10}{10}=1,\\quad \\frac{|A_{21}|}{s_{2}}=\\frac{5}{20}=\\frac{1}{4},\\quad \\frac{|A_{31}|}{s_{3}}=\\frac{2}{\\max\\{8,|C|\\}}\\leq \\frac{1}{4}.\n$$\n因此第 1 行是主元行。用乘子 $m_{21}=A_{21}/A_{11}=1/2$ 和 $m_{31}=A_{31}/A_{11}=-1/5$ 进行消元。第一步消元后，第 2 列更新后的元素为\n$$\nA_{22}^{(1)}=20-\\frac{1}{2}\\cdot 2=19,\\qquad A_{32}^{(1)}=C-\\left(-\\frac{1}{5}\\right)\\cdot 2=C+\\frac{2}{5}.\n$$\n对于第二步（$k=2$），从第 2 行和第 3 行中选择主元的比例比值为\n$$\nr_{2}=\\frac{|A_{22}^{(1)}|}{s_{2}}=\\frac{19}{20},\\qquad r_{3}=\\frac{|A_{32}^{(1)}|}{s_{3}}=\\frac{C+\\frac{2}{5}}{\\max\\{8,|C|\\}}.\n$$\n根据平局决胜规则（选择较小的索引），当且仅当 $r_{2}\\geq r_{3}$ 时，选择第 2 行为主元行。考虑 $s_{3}$ 的两种情况：\n\n1) 如果 $C\\geq 8$，则 $s_{3}=C$ 且\n$$\nr_{3}=\\frac{C+\\frac{2}{5}}{C}=1+\\frac{2}{5C}>1>\\frac{19}{20}=r_{2},\n$$\n所以选择第 3 行。\n\n2) 如果 $0<C<8$，则 $s_{3}=8$，且条件 $r_{2}\\geq r_{3}$ 变为\n$$\n\\frac{19}{20}\\geq \\frac{C+\\frac{2}{5}}{8}\\quad\\Longleftrightarrow\\quad 19\\cdot 8\\geq 20\\left(C+\\frac{2}{5}\\right)\\quad\\Longleftrightarrow\\quad 152\\geq 20C+8\n$$\n$$\n\\Longleftrightarrow\\quad 144\\geq 20C\\quad\\Longleftrightarrow\\quad C\\leq \\frac{36}{5}=7.2.\n$$\n对于小于 18 的正整数 $C$，这得出当 $C\\in\\{1,2,3,4,5,6,7\\}$ 时，第二个主元行是第 2 行。因此，使得第二个主元行为第 2 行的、严格小于 18 的最大正整数 $C$ 是 $7$。", "answer": "$$\\boxed{7}$$", "id": "2199850"}]}