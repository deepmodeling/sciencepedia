{"hands_on_practices": [{"introduction": "理论是实践的根基。本练习将引导你完成使用LU分解计算矩阵逆的完整流程。通过这个基础的 $2 \\times 2$ 矩阵示例，你将亲手实践 $A = LU$ 分解、求解三角矩阵的逆（$L^{-1}$ 和 $U^{-1}$），并最终通过 $A^{-1} = U^{-1}L^{-1}$ 计算出矩阵的逆，从而牢固掌握该方法的核心步骤与原理。[@problem_id:2161050]", "problem": "在许多数值应用中，例如求解线性方程组或在优化算法中，计算矩阵的逆是一项基本操作。完成此任务的一种稳健方法是首先将矩阵分解为一个下三角矩阵和一个上三角矩阵的乘积。\n\n考虑矩阵 $A$ 如下：\n$$\nA = \\begin{pmatrix} 4 & 3 \\\\ 6 & 2 \\end{pmatrix}\n$$\n你的任务是通过首先找到 $A$ 的下三角-上三角（LU）分解来计算该矩阵的逆 $A^{-1}$。请将最终答案以一个2x2矩阵的形式呈现，其元素表示为精确分数。", "solution": "我们首先通过计算其行列式来验证 $A$ 是可逆的。使用 $\\det\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix} = ad - bc$，我们有\n$$\n\\det(A) = 4\\cdot 2 - 3\\cdot 6 = 8 - 18 = -10 \\neq 0,\n$$\n因此 $A$ 是可逆的。\n\n为了通过LU分解计算 $A^{-1}$，我们写出 $A = LU$，其中 $L$ 是对角线元素为1的下三角矩阵，$U$ 是上三角矩阵。对于\n$$\nA = \\begin{pmatrix} 4 & 3 \\\\ 6 & 2 \\end{pmatrix},\\quad L = \\begin{pmatrix} 1 & 0 \\\\ \\ell_{21} & 1 \\end{pmatrix},\\quad U = \\begin{pmatrix} u_{11} & u_{12} \\\\ 0 & u_{22} \\end{pmatrix},\n$$\n根据Doolittle关系可得：\n- $u_{11} = a_{11} = 4$,\n- $u_{12} = a_{12} = 3$,\n- $\\ell_{21} = \\dfrac{a_{21}}{u_{11}} = \\dfrac{6}{4} = \\dfrac{3}{2}$,\n- $u_{22} = a_{22} - \\ell_{21}u_{12} = 2 - \\dfrac{3}{2}\\cdot 3 = 2 - \\dfrac{9}{2} = -\\dfrac{5}{2}$.\n\n因此，\n$$\nL = \\begin{pmatrix} 1 & 0 \\\\ \\frac{3}{2} & 1 \\end{pmatrix},\\quad U = \\begin{pmatrix} 4 & 3 \\\\ 0 & -\\frac{5}{2} \\end{pmatrix}.\n$$\n\n由于 $A = LU$，我们有 $A^{-1} = U^{-1}L^{-1}$。我们通过求解三角方程组来计算 $L^{-1}$ 和 $U^{-1}$。\n\n对于 $L^{-1}$，求解 $LZ = I$，其中 $L$ 是单位下三角矩阵。通过直接计算，\n$$\nL^{-1} = \\begin{pmatrix} 1 & 0 \\\\ -\\frac{3}{2} & 1 \\end{pmatrix}.\n$$\n\n对于 $U^{-1}$，求解 $UY = I$，其中 $U$ 是上三角矩阵。设 $Y = \\begin{pmatrix} y_{11} & y_{12} \\\\ y_{21} & y_{22} \\end{pmatrix}$。从\n$$\n\\begin{pmatrix} 4 & 3 \\\\ 0 & -\\frac{5}{2} \\end{pmatrix} \\begin{pmatrix} y_{11} & y_{12} \\\\ y_{21} & y_{22} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix},\n$$\n下面一行给出 $-\\dfrac{5}{2}y_{21} = 0$ 和 $-\\dfrac{5}{2}y_{22} = 1$，因此 $y_{21} = 0$ 且 $y_{22} = -\\dfrac{2}{5}$。上面一行给出 $4y_{11} + 3y_{21} = 1$ 和 $4y_{12} + 3y_{22} = 0$，因此 $y_{11} = \\dfrac{1}{4}$ 且 $y_{12} = \\dfrac{3}{10}$。因此，\n$$\nU^{-1} = \\begin{pmatrix} \\frac{1}{4} & \\frac{3}{10} \\\\ 0 & -\\frac{2}{5} \\end{pmatrix}.\n$$\n\n最后，相乘得到 $A^{-1} = U^{-1}L^{-1}$：\n$$\nA^{-1} = \\begin{pmatrix} \\frac{1}{4} & \\frac{3}{10} \\\\ 0 & -\\frac{2}{5} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ -\\frac{3}{2} & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4} - \\frac{9}{20} & \\frac{3}{10} \\\\ \\frac{3}{5} & -\\frac{2}{5} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{5} & \\frac{3}{10} \\\\ \\frac{3}{5} & -\\frac{2}{5} \\end{pmatrix}.\n$$\n\n这与通过伴随矩阵公式得到的结果相符，从而证实了正确性。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{5} & \\frac{3}{10} \\\\ \\frac{3}{5} & -\\frac{2}{5}\\end{pmatrix}}$$", "id": "2161050"}, {"introduction": "在实际的科学计算中，我们往往不需要计算整个逆矩阵，而是更关心它的特定列，因为这等价于求解一个线性方程组。这个练习将带你进入一个更贴近实际应用的场景，即如何利用带主元选择的LU分解（$PA=LU$）来高效求解逆矩阵的某一列。通过引入置换矩阵 $P$，你将学会处理更一般、更稳健的数值计算问题。[@problem_id:2161048]", "problem": "在许多大规模科学计算应用中，计算一个矩阵 $A$ 的完整逆矩阵在计算上是昂贵的且不必要的。通常，只需要逆矩阵 $A^{-1}$ 的特定列。带部分主元消去的 LU 分解提供了一种通过求解线性方程组来找到这些列的有效方法。\n\n考虑一个非奇异的 3x3 矩阵 $A$，它已被分解为 $PA = LU$ 的形式，其中 $P$ 是一个置换矩阵， $L$ 是一个单位下三角矩阵， $U$ 是一个上三角矩阵。该分解的具体矩阵如下：\n\n$$\nP = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 1 & 0 & 0 \\end{pmatrix}, \\quad\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}, \\quad\nU = \\begin{pmatrix} 2 & -1 & 4 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}\n$$\n\n您的任务是求出逆矩阵 $A^{-1}$ 的第三个列向量。将您的答案表示为一个 3x1 的列向量。", "solution": "我们要求 $A^{-1}$ 的第三列，也就是方程 $A x = e_{3}$ 的唯一解 $x$，其中 $e_{3} = (0,0,1)^{T}$。\n\n给定带部分主元消去的 LU 分解 $PA = LU$，为了求解 $A x = b$，我们使用 $PA x = P b$，因此 $LU x = P b$。我们接着依次求解：\n1) 通过前向替换解 $L y = P b$，\n2) 通过后向替换解 $U x = y$。\n\n在这里，$b = e_{3}$，所以首先计算 $P e_{3}$。由于\n$$\nP = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 1 & 0 & 0 \\end{pmatrix}\n$$\n的第三列是 $\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$，我们有\n$$\nP e_{3} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n\n求解 $L y = P e_{3}$，其中\n$$\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}, \\quad y = \\begin{pmatrix} y_{1} \\\\ y_{2} \\\\ y_{3} \\end{pmatrix}.\n$$\n方程组为\n$$\n\\begin{cases}\ny_{1} = 0, \\\\\n2 y_{1} + y_{2} = 1, \\\\\n- y_{1} + 3 y_{2} + y_{3} = 0.\n\\end{cases}\n$$\n由第一个方程得 $y_{1} = 0$，然后 $y_{2} = 1$，最后 $y_{3} = -3$。因此\n$$\ny = \\begin{pmatrix} 0 \\\\ 1 \\\\ -3 \\end{pmatrix}.\n$$\n\n接下来求解 $U x = y$，其中\n$$\nU = \\begin{pmatrix} 2 & -1 & 4 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}, \\quad x = \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix}.\n$$\n后向替换给出\n$$\n-2 x_{3} = -3 \\;\\Rightarrow\\; x_{3} = \\frac{3}{2},\n$$\n$$\n3 x_{2} + x_{3} = 1 \\;\\Rightarrow\\; 3 x_{2} + \\frac{3}{2} = 1 \\;\\Rightarrow\\; x_{2} = -\\frac{1}{6},\n$$\n$$\n2 x_{1} - x_{2} + 4 x_{3} = 0 \\;\\Rightarrow\\; 2 x_{1} + \\frac{1}{6} + 6 = 0 \\;\\Rightarrow\\; 2 x_{1} + \\frac{37}{6} = 0 \\;\\Rightarrow\\; x_{1} = -\\frac{37}{12}.\n$$\n\n因此，$A^{-1}$ 的第三列是\n$$\n\\begin{pmatrix} -\\frac{37}{12} \\\\ -\\frac{1}{6} \\\\ \\frac{3}{2} \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{37}{12}\\\\-\\frac{1}{6}\\\\\\frac{3}{2}\\end{pmatrix}}$$", "id": "2161048"}, {"introduction": "数值计算的精度是有限的，这会导致求解结果存在误差。本练习介绍了一种强大的技术——迭代改进法，用于提高已得解的精度。你将学习如何利用已有的LU分解，通过计算残差并求解一个修正方程来迭代地逼近更精确的解，这深刻揭示了LU分解在高性能计算中应对数值误差的实际效用。[@problem_id:2161022]", "problem": "一位数值分析师正在研究一个问题，该问题需要求解一个给定的3x3矩阵 $A$ 的逆矩阵的第二列。该矩阵定义如下：\n$$\nA = \\begin{pmatrix} 2 & -1 & 3 \\\\ 6 & 1 & 10 \\\\ -2 & -7 & -7 \\end{pmatrix}\n$$\n该分析师已经计算出矩阵 $A$ 的LU分解（下上三角分解），使得 $A=LU$，其中 $L$ 是一个单位下三角矩阵，$U$ 是一个上三角矩阵。这两个矩阵是：\n$$\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ 3 & 1 & 0 \\\\ -1 & -2 & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 2 & -1 & 3 \\\\ 0 & 4 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}\n$$\n一个初始的低精度计算得到了 $A^{-1}$ 第二列的一个近似解，记为 $x^{(0)}$：\n$$\nx^{(0)} = \\begin{pmatrix} 1.7 \\\\ 0.6 \\\\ -1.1 \\end{pmatrix}\n$$\n为改进该近似解，该分析师应用了一步迭代改进过程。对于一个近似解 $x^{(k)}$，下一个近似解 $x^{(k+1)}$ 通过以下步骤求得：\n1. 计算残差向量 $r = e_2 - A x^{(k)}$，其中 $e_2$ 是标准基向量 $\\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix}^T$。\n2. 求解线性系统 $A \\delta = r$，得到修正向量 $\\delta$。\n3. 更新解：$x^{(k+1)} = x^{(k)} + \\delta$。\n\n你的任务是，对初始近似解 $x^{(0)}$ 应用一次该过程，计算得到的改进向量 $x^{(1)}$ 的第一个分量。使用所提供的LU分解来高效地求解步骤2中的线性系统。\n\n将你的最终答案四舍五入到四位有效数字。", "solution": "我们正在对 $A x = e_{2}$ 的解的近似值进行改进，其中\n$$\nA = \\begin{pmatrix} 2 & -1 & 3 \\\\ 6 & 1 & 10 \\\\ -2 & -7 & -7 \\end{pmatrix}, \\quad L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 3 & 1 & 0 \\\\ -1 & -2 & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 2 & -1 & 3 \\\\ 0 & 4 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}, \\quad x^{(0)} = \\begin{pmatrix} 1.7 \\\\ 0.6 \\\\ -1.1 \\end{pmatrix}, \\quad e_{2}=\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n步骤1（残差）：计算 $r = e_{2} - A x^{(0)}$。\n首先计算 $A x^{(0)}$：\n$$\nA x^{(0)} = \\begin{pmatrix}\n2\\cdot 1.7 + (-1)\\cdot 0.6 + 3\\cdot (-1.1) \\\\\n6\\cdot 1.7 + 1\\cdot 0.6 + 10\\cdot (-1.1) \\\\\n-2\\cdot 1.7 + (-7)\\cdot 0.6 + (-7)\\cdot (-1.1)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-0.5 \\\\ -0.2 \\\\ 0.1\n\\end{pmatrix}.\n$$\n因此\n$$\nr = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} -0.5 \\\\ -0.2 \\\\ 0.1 \\end{pmatrix} = \\begin{pmatrix} 0.5 \\\\ 1.2 \\\\ -0.1 \\end{pmatrix}.\n$$\n步骤2（使用 $LU$ 求解 $A\\delta=r$）：求解 $L y = r$，然后求解 $U \\delta = y$。\n前向代入 $L y = r$：\n$$\ny_{1} = 0.5,\\quad 3 y_{1} + y_{2} = 1.2 \\Rightarrow y_{2} = -0.3,\\quad -y_{1} - 2 y_{2} + y_{3} = -0.1 \\Rightarrow y_{3} = -0.2.\n$$\n所以 $y = \\begin{pmatrix} 0.5 \\\\ -0.3 \\\\ -0.2 \\end{pmatrix}$。\n后向代入 $U \\delta = y$：\n$$\n-2 \\delta_{3} = -0.2 \\Rightarrow \\delta_{3} = 0.1,\\quad 4 \\delta_{2} + \\delta_{3} = -0.3 \\Rightarrow \\delta_{2} = -0.1,\n$$\n$$\n2 \\delta_{1} - \\delta_{2} + 3 \\delta_{3} = 0.5 \\Rightarrow 2 \\delta_{1} + 0.1 + 0.3 = 0.5 \\Rightarrow \\delta_{1} = 0.05.\n$$\n因此\n$$\n\\delta = \\begin{pmatrix} 0.05 \\\\ -0.1 \\\\ 0.1 \\end{pmatrix}.\n$$\n步骤3（更新）：$x^{(1)} = x^{(0)} + \\delta$ 得到\n$$\nx^{(1)} = \\begin{pmatrix} 1.7 \\\\ 0.6 \\\\ -1.1 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.1 \\\\ 0.1 \\end{pmatrix} = \\begin{pmatrix} 1.75 \\\\ 0.5 \\\\ -1.0 \\end{pmatrix}.\n$$\n第一个分量是 $1.75$，四舍五入到四位有效数字是 $1.750$。", "answer": "$$\\boxed{1.750}$$", "id": "2161022"}]}