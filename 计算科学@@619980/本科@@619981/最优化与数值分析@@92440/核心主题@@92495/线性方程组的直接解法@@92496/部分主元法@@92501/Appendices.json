{"hands_on_practices": [{"introduction": "掌握任何算法的第一步都是理解其核心操作。这个练习旨在帮助你熟悉部分主元法最基本的一步：在当前列中找到绝对值最大的元素作为主元，并执行必要的行交换。通过这个简单的练习，你将为在高斯消元法中运用这一关键技巧打下坚实的基础。[@problem_id:2193012]", "problem": "在数值线性代数中，为提高像高斯消元法这类算法的稳定性，会采用一些策略。考虑由矩阵方程 $A\\mathbf{x} = \\mathbf{b}$ 表示的线性方程组，其中系数矩阵 $A$ 如下所示：\n\n$$\nA = \\begin{pmatrix}\n3.1 & -1.5 & 4.2 \\\\\n-2.5 & 8.9 & -0.7 \\\\\n-7.8 & 3.4 & 1.1\n\\end{pmatrix}\n$$\n\n为了开始使用部分主元法的高斯消元法来求解该方程组，首先必须执行一次特定的行交换，以确保主元具有最大可能的绝对值。下列哪项描述了该策略所要求的第一步操作？\n\nA. 交换第1行和第2行。\n\nB. 交换第1行和第3行。\n\nC. 交换第2行和第3行。\n\nD. 第一步不需要行交换。\n\nE. 由于矩阵是奇异的，该策略无法应用。", "solution": "该问题要求确定对给定的 $3 \\times 3$ 矩阵 $A$ 应用使用部分主元法的高斯消元法的第一步。\n\n矩阵为：\n$$\nA = \\begin{pmatrix}\n3.1 & -1.5 & 4.2 \\\\\n-2.5 & 8.9 & -0.7 \\\\\n-7.8 & 3.4 & 1.1\n\\end{pmatrix}\n$$\n\n对于第一列（步骤 $k=1$），部分主元法需要确定第一列中绝对值最大的元素所在的行。该元素将成为第一阶段消元的主元。\n\n让我们将矩阵的元素表示为 $a_{ij}$，其中 $i$ 是行索引，$j$ 是列索引。我们需要检查第一列中的元素：$a_{11}$、$a_{21}$ 和 $a_{31}$。\n\n这些元素是：\n$a_{11} = 3.1$\n$a_{21} = -2.5$\n$a_{31} = -7.8$\n\n接下来，我们计算这些元素的绝对值：\n$|a_{11}| = |3.1| = 3.1$\n$|a_{21}| = |-2.5| = 2.5$\n$|a_{31}| = |-7.8| = 7.8$\n\n现在我们找出这些绝对值中的最大值：\n$\\max(|a_{11}|, |a_{21}|, |a_{31}|) = \\max(3.1, 2.5, 7.8) = 7.8$。\n\n这个最大的绝对值对应于元素 $a_{31}$，它位于第三行。\n\n根据部分主元法的步骤，包含主元（当前列中绝对值最大的元素）的行必须与当前主元行进行交换。对于第一步，当前主元行是第1行。由于绝对值最大的元素在第3行，我们必须交换第1行和第3行。\n\n交换后，矩阵将如下所示：\n$$\nA' = \\begin{pmatrix}\n-7.8 & 3.4 & 1.1 \\\\\n-2.5 & 8.9 & -0.7 \\\\\n3.1 & -1.5 & 4.2\n\\end{pmatrix}\n$$\n新的主元是 $a'_{11} = -7.8$，其绝对值大于第一列中其他原始元素的绝对值。\n\n因此，所需的第一步操作是交换第1行和第3行。这对应于选项B。选项E是错误的，因为无论矩阵是否奇异，都可以应用主元法（尽管奇异矩阵会在某个阶段导致主元为零），且该操作是明确定义的。", "answer": "$$\\boxed{B}$$", "id": "2193012"}, {"introduction": "在掌握了单步的行交换后，下一步是将其应用于完整的高斯消元过程中。这个练习要求你对一个 $4 \\times 4$ 矩阵执行带有部分主元法的高斯消元，并追踪每一步主元来自原始矩阵的哪一行。这个过程将考验你的细心和对算法迭代性质的理解，因为每一步的选择都依赖于前一步计算后更新的矩阵。[@problem_id:2192993]", "problem": "考虑使用部分主元法的高斯消元法求解线性方程组 $Ax=b$ 的过程。在这种方法中，对于给定的列 $k$ 进行消元之前，算法会找到第 $i$ 行（$i \\geq k$），使得该行在第 $k$ 列的元素的绝对值最大。然后将第 $i$ 行与当前的第 $k$ 行进行交换。此时位于位置 $(k,k)$ 的元素成为该步骤的主元。\n\n给定以下 $4 \\times 4$ 矩阵 $A$：\n$$\nA = \\begin{pmatrix}\n1 & -2 & 3 & 4 \\\\\n3 & 1 & -5 & 2 \\\\\n-4 & 5 & 1 & -1 \\\\\n2 & -3 & 4 & 1\n\\end{pmatrix}\n$$\n\n设矩阵的原始行索引为 1 到 4。当您对矩阵 $A$ 执行带部分主元法的高斯消元时，您将为四个步骤中的每一步（即，对于列 $k=1, 2, 3, 4$）选择一个主元元素。请确定在每一步中选定的主元元素的*原始*行索引序列。\n\n例如，如果第一步（k=1）的主元来自原始矩阵的第三行，则序列中的第一个数字是 3。如果第二步（k=2）的主元来自原始矩阵的第一行，则序列将以 `[3, 1, ...]` 开始。\n\n以下哪项代表了主元元素的正确原始行索引序列？\n\nA. [1, 2, 3, 4]\n\nB. [3, 2, 1, 4]\n\nC. [3, 2, 4, 1]\n\nD. [3, 1, 2, 4]", "solution": "我们应用带部分主元法的高斯消元。在每一步 $k$ 中，我们在第 $k$ 列中从第 $i \\geq k$ 行中选择绝对值最大的元素作为主元，将该行与第 $k$ 行交换，然后消除主元下方的元素。我们跟踪原始行索引。\n\n初始时，\n$$\nA=\\begin{pmatrix}\n1 & -2 & 3 & 4 \\\\\n3 & 1 & -5 & 2 \\\\\n-4 & 5 & 1 & -1 \\\\\n2 & -3 & 4 & 1\n\\end{pmatrix}.\n$$\n\n步骤 $k=1$：在第 1 列中，绝对值为 $|1|,|3|,|{-4}|,|2|$，最大值为 $4$，位于原始第 3 行。将第 1 行与第 3 行交换（主元的原始索引为 3）：\n$$\n\\begin{pmatrix}\n-4 & 5 & 1 & -1 \\\\\n3 & 1 & -5 & 2 \\\\\n1 & -2 & 3 & 4 \\\\\n2 & -3 & 4 & 1\n\\end{pmatrix}.\n$$\n使用 $m_{21}=\\frac{3}{-4}=-\\frac{3}{4}$，$m_{31}=\\frac{1}{-4}=-\\frac{1}{4}$，$m_{41}=\\frac{2}{-4}=-\\frac{1}{2}$ 进行消元，即 $\\text{row}_{i}\\leftarrow \\text{row}_{i}-m_{i1}\\text{row}_{1}$：\n$$\n\\text{row}_{2}=\\begin{pmatrix}3 & 1 & -5 & 2\\end{pmatrix}+\\frac{3}{4}\\begin{pmatrix}-4 & 5 & 1 & -1\\end{pmatrix}=\\begin{pmatrix}0 & \\frac{19}{4} & -\\frac{17}{4} & \\frac{5}{4}\\end{pmatrix},\n$$\n$$\n\\text{row}_{3}=\\begin{pmatrix}1 & -2 & 3 & 4\\end{pmatrix}+\\frac{1}{4}\\begin{pmatrix}-4 & 5 & 1 & -1\\end{pmatrix}=\\begin{pmatrix}0 & -\\frac{3}{4} & \\frac{13}{4} & \\frac{15}{4}\\end{pmatrix},\n$$\n$$\n\\text{row}_{4}=\\begin{pmatrix}2 & -3 & 4 & 1\\end{pmatrix}+\\frac{1}{2}\\begin{pmatrix}-4 & 5 & 1 & -1\\end{pmatrix}=\\begin{pmatrix}0 & -\\frac{1}{2} & \\frac{9}{2} & \\frac{1}{2}\\end{pmatrix}.\n$$\n\n步骤 $k=2$：在第 2 列（从第 2 行到第 4 行）中，绝对值为 $\\left|\\frac{19}{4}\\right|,\\left|-\\frac{3}{4}\\right|,\\left|-\\frac{1}{2}\\right|$，最大值为 $\\frac{19}{4}$，位于当前第 2 行（原始第 2 行）。无需交换（主元的原始索引为 2）。使用\n$$\nm_{32}=\\frac{-\\frac{3}{4}}{\\frac{19}{4}}=-\\frac{3}{19},\\quad m_{42}=\\frac{-\\frac{1}{2}}{\\frac{19}{4}}=-\\frac{2}{19}.\n$$\n进行消元。因此，\n$$\n\\text{row}_{3}=\\begin{pmatrix}0 & -\\frac{3}{4} & \\frac{13}{4} & \\frac{15}{4}\\end{pmatrix}+\\frac{3}{19}\\begin{pmatrix}0 & \\frac{19}{4} & -\\frac{17}{4} & \\frac{5}{4}\\end{pmatrix}=\\begin{pmatrix}0 & 0 & \\frac{49}{19} & \\frac{75}{19}\\end{pmatrix},\n$$\n$$\n\\text{row}_{4}=\\begin{pmatrix}0 & -\\frac{1}{2} & \\frac{9}{2} & \\frac{1}{2}\\end{pmatrix}+\\frac{2}{19}\\begin{pmatrix}0 & \\frac{19}{4} & -\\frac{17}{4} & \\frac{5}{4}\\end{pmatrix}=\\begin{pmatrix}0 & 0 & \\frac{77}{19} & \\frac{12}{19}\\end{pmatrix}.\n$$\n\n步骤 $k=3$：在第 3 列（第 3 行和第 4 行）中，绝对值为 $\\left|\\frac{49}{19}\\right|$ 和 $\\left|\\frac{77}{19}\\right|$，最大值为 $\\frac{77}{19}$，位于当前第 4 行（原始第 4 行）。交换第 3 行和第 4 行（主元的原始索引为 4），然后进行消元：\n$$\n\\text{row}_{4}\\leftarrow \\text{row}_{4}-\\frac{\\frac{49}{19}}{\\frac{77}{19}}\\text{row}_{3}=\\begin{pmatrix}0 & 0 & \\frac{49}{19} & \\frac{75}{19}\\end{pmatrix}-\\frac{49}{77}\\begin{pmatrix}0 & 0 & \\frac{77}{19} & \\frac{12}{19}\\end{pmatrix}=\\begin{pmatrix}0 & 0 & 0 & \\frac{39}{11}\\end{pmatrix}.\n$$\n\n步骤 $k=4$：只剩下第 4 行；其原始索引是 1（主元的原始索引为 1）。\n\n因此，主元的原始行索引序列是 $[3,2,4,1]$，这对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "2192993"}, {"introduction": "为什么我们需要部分主元法？这个练习通过一个精心设计的思想实验，揭示了其至关重要的原因：数值稳定性。你将使用简化的“三位数截断法”进行计算，这种方法会放大舍入误差，从而让你亲手验证，在没有部分主元法时，一个微小的主元如何导致灾难性的计算错误，而部分主元法又是如何巧妙地解决这个问题的。[@problem_id:2193047]", "problem": "考虑以下线性方程组：\n$$\n\\begin{align*}\n(2.00 \\times 10^{-4}) x_1 + 2.00 x_2 &= 4.00 \\\\\n1.00 x_1 + 3.00 x_2 &= 5.00\n\\end{align*}\n$$\n要求使用高斯消去法求解该系统，但所有计算都必须使用一种简化的浮点表示法，称为**三位截断算术**。在这种算术系统中，数字首先被写成规格化十进制形式，$\\pm 0.d_1d_2d_3d_4... \\times 10^n$，其中 $d_1 \\in \\{1, 2, \\dots, 9\\}$。然后通过“截断”第三位之后的所有数字来存储该数，得到形式 $\\pm 0.d_1d_2d_3 \\times 10^n$。每次独立的算术运算（加法、减法、乘法、除法）之后都会进行这种截断。\n\n使用**带部分主元法**的高斯消去法计算解向量 $\\mathbf{x} = [x_1, x_2]^T$。将你的最终答案表示为解向量的两个分量。", "solution": "我们在三位截断算术下应用带部分主元法的高斯消去法（每次运算后以三位有效数字的规格化形式存储数字）。\n\n从增广矩阵开始\n$$\n\\left[\\begin{array}{cc|c}\n2.00\\times 10^{-4} & 2.00 & 4.00\\\\\n1.00 & 3.00 & 5.00\n\\end{array}\\right].\n$$\n对第1列进行部分主元选取，比较 $|2.00\\times 10^{-4}|$ 和 $|1.00|$，因此我们交换两行：\n$$\n\\left[\\begin{array}{cc|c}\n1.00 & 3.00 & 5.00\\\\\n2.00\\times 10^{-4} & 2.00 & 4.00\n\\end{array}\\right].\n$$\n消元乘子\n$$\n\\ell_{21}=\\text{chop}_{3}\\left(\\frac{2.00\\times 10^{-4}}{1.00}\\right)=2.00\\times 10^{-4}.\n$$\n更新第2行的元素，每次运算后进行截断：\n- 新的 $a_{21}$:\n$$\n\\text{chop}_{3}\\left(2.00\\times 10^{-4}-\\ell_{21}\\cdot 1.00\\right)=\\text{chop}_{3}\\left(2.00\\times 10^{-4}-2.00\\times 10^{-4}\\right)=0.\n$$\n- 新的 $a_{22}$:\n$$\n\\ell_{21}\\cdot a_{12}=\\text{chop}_{3}\\left((2.00\\times 10^{-4})\\cdot 3.00\\right)=6.00\\times 10^{-4},\n$$\n$$\na_{22}^{(new)}=\\text{chop}_{3}\\left(2.00-6.00\\times 10^{-4}\\right)=\\text{chop}_{3}(1.9994)=1.99.\n$$\n- 新的 $b_{2}$:\n$$\n\\ell_{21}\\cdot b_{1}=\\text{chop}_{3}\\left((2.00\\times 10^{-4})\\cdot 5.00\\right)=1.00\\times 10^{-3},\n$$\n$$\nb_{2}^{(new)}=\\text{chop}_{3}\\left(4.00-1.00\\times 10^{-3}\\right)=\\text{chop}_{3}(3.999)=3.99.\n$$\n因此，上三角系统为\n$$\n\\begin{cases}\n1.00\\,x_{1}+3.00\\,x_{2}=5.00,\\\\\n1.99\\,x_{2}=3.99.\n\\end{cases}\n$$\n进行回代，每次运算后进行截断：\n$$\nx_{2}=\\text{chop}_{3}\\left(\\frac{3.99}{1.99}\\right)=\\text{chop}_{3}(2.005025\\ldots)=2.00.\n$$\n然后\n$$\na_{12}\\,x_{2}=\\text{chop}_{3}(3.00\\cdot 2.00)=6.00,\\quad\nb_{1}-a_{12}x_{2}=\\text{chop}_{3}(5.00-6.00)=-1.00,\n$$\n$$\nx_{1}=\\text{chop}_{3}\\left(\\frac{-1.00}{1.00}\\right)=-1.00.\n$$\n因此，在带部分主元法的三位截断算术下，解为 $x_{1}=-1.00$ 和 $x_{2}=2.00$。", "answer": "$$\\boxed{\\begin{pmatrix}-1.00 & 2.00\\end{pmatrix}}$$", "id": "2193047"}]}