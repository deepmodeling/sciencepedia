{"hands_on_practices": [{"introduction": "全主元消元法的核心在于每一步都选择整个（剩余）矩阵中绝对值最大的元素作为主元。这个过程通过行和列的置换来实现。本练习旨在帮助你掌握这一关键的第一步：如何为给定的矩阵确定相应的行置换矩阵 $P_1$ 和列置换矩阵 $Q_1$，从而将数值上最优的主元移动到主导位置。理解这一基础操作是将算法应用于更复杂问题的基石。[@problem_id:2174480]", "problem": "在对矩阵 $A$ 进行全主元高斯消元法的第一步中，会确定一个行置换矩阵 $P_1$ 和一个列置换矩阵 $Q_1$。选择这些矩阵，使得变换后矩阵 $A' = P_1 A Q_1$ 在位置 $(1,1)$ 上的元素在 $A$ 的所有元素中具有最大绝对值。\n\n考虑给定的矩阵 $A$：\n$$\nA = \\begin{pmatrix}\n2 & 1 & -3 & 4 \\\\\n-5 & 6 & 1 & 0 \\\\\n3 & -2 & 8 & -1 \\\\\n-4 & 7 & -9 & 5\n\\end{pmatrix}\n$$\n\n对矩阵 $A$ 执行全主元高斯消元法的第一步，请确定正确的矩阵对 $(P_1, Q_1)$。从以下选项中选择有效的选项。\n\nA. $P_1 = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}, \\quad Q_1 = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}$\n\nB. $P_1 = \\begin{pmatrix} 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}, \\quad Q_1 = \\begin{pmatrix} 0 & 0 & 0 & 1 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 1 & 0 & 0 & 0 \\end{pmatrix}$\n\nC. $P_1 = \\begin{pmatrix} 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}, \\quad Q_1 = \\begin{pmatrix} 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}$\n\nD. $P_1 = \\begin{pmatrix} 0 & 0 & 0 & 1 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 1 & 0 & 0 & 0 \\end{pmatrix}, \\quad Q_1 = \\begin{pmatrix} 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}$", "solution": "在全主元高斯消元法中，第一步我们选择置换，使得整个矩阵中绝对值最大的元素成为 $A' = P_{1} A Q_{1}$ 在位置 $(1,1)$ 上的主元。\n\n给定\n$$\nA=\\begin{pmatrix}\n2 & 1 & -3 & 4 \\\\\n-5 & 6 & 1 & 0 \\\\\n3 & -2 & 8 & -1 \\\\\n-4 & 7 & -9 & 5\n\\end{pmatrix},\n$$\n我们计算其元素的绝对值，发现\n$$\n\\max_{i,j} |a_{ij}| = 9 \\quad \\text{在位置} \\quad (4,3) \\text{ 处，其值为 } a_{4,3}=-9.\n$$\n因此，我们必须进行行置换，将第 4 行移动到第 1 行；并进行列置换，将第 3 列移动到第 1 列。相应的置换矩阵是执行行对换 $(1\\,4)$ 和列对换 $(1\\,3)$ 的矩阵。\n\n交换第 1 行和第 4 行的置换矩阵是\n$$\nP_{1}=\\begin{pmatrix}\n0 & 0 & 0 & 1 \\\\\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n1 & 0 & 0 & 0\n\\end{pmatrix},\n$$\n因为 $P_{1}$ 的第一行选择了 $A$ 的第四行，而第四行选择了 $A$ 的第一行。\n\n交换第 1 列和第 3 列的置换矩阵是\n$$\nQ_{1}=\\begin{pmatrix}\n0 & 0 & 1 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix},\n$$\n因为右乘 $Q_{1}$ 将第一列替换为原始的第三列，并将第三列替换为原始的第一列。\n\n使用这些矩阵，变换后的矩阵满足\n$$\nA'_{1,1}=(P_{1} A Q_{1})_{1,1}=a_{4,3}=-9,\n$$\n其在 $A$ 的所有元素中具有最大绝对值。在所提供的选项中，这对矩阵与选项 D 匹配。其他选项要么不能将全局最大值移动到位置 $(1,1)$，要么将一个不同的元素移动到该位置（例如，选项 C 得到 $A'_{1,1}=a_{3,3}=8$，这并非最大值）。", "answer": "$$\\boxed{D}$$", "id": "2174480"}, {"introduction": "掌握了选择主元的机制后，让我们将其应用于一个完整的线性方程组求解过程。这个练习展示了全主元策略的一个重要优势：即使系数矩阵的对角线上出现零，它也能稳健地处理，而朴素的高斯消元法此时会因除零错误而失败。通过解决这个看似棘手但实际上很直接的 $2 \\times 2$ 系统，你将亲身体验到全主元法如何通过重新排列方程和变量，确保算法的顺利进行。[@problem_id:2174449]", "problem": "一个包含两个未知数 $x_1$ 和 $x_2$ 的二元线性方程组由以下关系式定义：\n$$a_{11} x_1 + a_{12} x_2 = b_1$$\n$$a_{21} x_1 + a_{22} x_2 = b_2$$\n系数的数值为 $a_{11} = 0.0$，$a_{12} = 4.8$，$a_{21} = 2.1$ 和 $a_{22} = -3.5$。等式右侧的常数为 $b_1 = 12.0$ 和 $b_2 = 1.4$。\n\n你的任务是应用高斯消元算法结合全主元策略来求解该方程组，得到变量 $x_1$ 和 $x_2$ 的值。在确定 $x_1$ 和 $x_2$ 的值后，计算它们的和 $S = x_1 + x_2$。\n\n报告 $S$ 的值，保留三位有效数字。", "solution": "给定的线性系统为\n$$a_{11}x_{1}+a_{12}x_{2}=b_{1},\\quad a_{21}x_{1}+a_{22}x_{2}=b_{2}$$\n其数值系数为\n$$a_{11}=0,\\quad a_{12}=4.8,\\quad a_{21}=2.1,\\quad a_{22}=-3.5,\\quad b_{1}=12,\\quad b_{2}=1.4.$$\n其矩阵形式为\n$$\\begin{pmatrix}0 & 4.8 \\\\ 2.1 & -3.5\\end{pmatrix}\\begin{pmatrix}x_{1}\\\\x_{2}\\end{pmatrix}=\\begin{pmatrix}12\\\\1.4\\end{pmatrix}.$$\n\n应用带全主元策略的高斯消元法。在初始步骤中，检查系数矩阵中所有元素的绝对值以选择主元。绝对值最大的元素是位于位置 $(1,2)$ 的 $4.8$。全主元策略通过交换列将此主元移动到位置 $(1,1)$。将第1列与第2列交换，等同于将未知数重新排序为 $(x_{2},x_{1})$。列交换后，系统变为\n$$\\begin{pmatrix}4.8 & 0 \\\\ -3.5 & 2.1\\end{pmatrix}\\begin{pmatrix}y_{1}\\\\y_{2}\\end{pmatrix}=\\begin{pmatrix}12\\\\1.4\\end{pmatrix},$$\n其中 $y_{1}=x_{2}$ 且 $y_{2}=x_{1}$。\n\n使用位置 $(1,1)$ 处的主元 $4.8$ 继续进行消元。用于消除位置 $(2,1)$ 处元素的乘数为\n$$m_{21}=\\frac{-3.5}{4.8}=-\\frac{35}{48}.$$\n通过 $R_{2}\\leftarrow R_{2}-m_{21}R_{1}$ 更新第2行。由于 $(1,2)$ 位置的元素为 $0$，所以 $(2,2)$ 位置的元素保持为\n$$a_{22}^{(new)}=2.1=\\frac{21}{10}.$$\n等式右侧更新为\n$$b_{2}^{(new)}=1.4-\\left(-\\frac{35}{48}\\right)\\cdot 12=\\frac{7}{5}+\\frac{35}{4}=\\frac{203}{20}.$$\n\n得到的上三角系统为\n$$4.8\\,y_{1}=12,\\qquad \\frac{21}{10}\\,y_{2}=\\frac{203}{20}.$$\n求解这些方程：\n$$y_{1}=\\frac{12}{4.8}=\\frac{120}{48}=\\frac{5}{2},\\qquad y_{2}=\\frac{\\frac{203}{20}}{\\frac{21}{10}}=\\frac{203}{42}=\\frac{29}{6}.$$\n\n回顾 $y_{1}=x_{2}$ 且 $y_{2}=x_{1}$，因此\n$$x_{1}=\\frac{29}{6},\\qquad x_{2}=\\frac{5}{2}.$$\n它们的和为\n$$S=x_{1}+x_{2}=\\frac{29}{6}+\\frac{5}{2}=\\frac{29}{6}+\\frac{15}{6}=\\frac{44}{6}=\\frac{22}{3}.$$\n保留三位有效数字， $S=7.33$。", "answer": "$$\\boxed{7.33}$$", "id": "2174449"}, {"introduction": "我们为什么总是选择绝对值“最大”的元素作为主元，而不是“最小”的非零元素呢？本练习将通过一个精心设计的思想实验来探讨这个问题，从而深化你对数值稳定性的理解。你将分析一个假设的“最小量级”主元策略，并在有限精度计算环境下观察其后果。通过这个反例，你会明白选择最大主元是抑制舍入误差增长、确保计算结果准确性的关键。[@problem_id:2174438]", "problem": "在一个使用浮点运算并四舍五入到四位有效数字的计算环境中，一位研究员提出了一种新颖的主元选择策略，用于通过高斯消去法求解线性系统 $A\\mathbf{x} = \\mathbf{b}$。该策略，我们称之为“最小模完全主元策略”，规定在消去过程的每一步 $k$（对于 $k=1, 2, \\dots, n-1$），通过搜索整个剩余子矩阵（从 $k$ 到 $n$ 的行和列）中具有最小非零绝对值的元素来选择主元。然后，通过将其所在的行和列分别与第 $k$ 行和第 $k$ 列交换，将该元素移动到对角线位置 $(k,k)$。\n\n现要求您分析该策略对于以下 $2 \\times 2$ 系统的数值稳定性：\n$$\nA = \\begin{pmatrix} 2.000 \\times 10^{-5} & 1.000 \\\\ 1.000 & 1.000 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 1.000 \\\\ 3.000 \\end{pmatrix}\n$$\n请使用高斯消去法结合此最小模完全主元策略，并对所有中间计算结果四舍五入到四位有效数字，求出解向量的第二个分量 $x_2$ 的值。\n\n请将您的最终答案四舍五入到四位有效数字。", "solution": "我们在浮点运算下进行计算，所有结果均四舍五入到四位有效数字，并使用最小模完全主元策略。\n\n在步骤 $k=1$ 时，剩余子矩阵为整个矩阵 $A$，其元素的绝对值分别为 $2.000\\times 10^{-5}$、$1.000$、$1.000$、$1.000$。最小的非零绝对值是位于 $(1,1)$ 位置的 $2.000\\times 10^{-5}$，因此不进行行或列交换。主元为 $a_{11}=2.000\\times 10^{-5}$。\n\n计算用于消去 $a_{21}$ 的乘子：\n$$\nm_{21}=\\frac{a_{21}}{a_{11}}=\\frac{1.000}{2.000\\times 10^{-5}}=5.000\\times 10^{4}\n$$\n该结果已四舍五入到四位有效数字。\n\n更新次对角线元素（以确认三角形式）：\n$$\na_{21}^{\\text{new}}=a_{21}-m_{21}a_{11}=1.000-(5.000\\times 10^{4})(2.000\\times 10^{-5})=1.000-1.000=0.000\n$$\n其中每个乘积和差都四舍五入到四位有效数字。\n\n更新元素 $a_{22}$：\n$$\nm_{21}a_{12}=(5.000\\times 10^{4})(1.000)=5.000\\times 10^{4},\n$$\n$$\na_{22}^{\\text{new}}=a_{22}-m_{21}a_{12}=1.000-5.000\\times 10^{4}=-4.9999\\times 10^{4}\\;\\;\\text{(精确值为 }-49999\\text{)}\n$$\n其四舍五入到四位有效数字为\n$$\na_{22}^{\\text{new}}=-5.000\\times 10^{4}.\n$$\n\n更新右端项：\n$$\nm_{21}b_{1}=(5.000\\times 10^{4})(1.000)=5.000\\times 10^{4},\n$$\n$$\nb_{2}^{\\text{new}}=b_{2}-m_{21}b_{1}=3.000-5.000\\times 10^{4}=-4.9997\\times 10^{4}\\;\\;\\text{(精确值为 }-49997\\text{)}\n$$\n其四舍五入到四位有效数字为\n$$\nb_{2}^{\\text{new}}=-5.000\\times 10^{4}.\n$$\n\n回代求解得\n$$\nx_{2}=\\frac{b_{2}^{\\text{new}}}{a_{22}^{\\text{new}}}=\\frac{-5.000\\times 10^{4}}{-5.000\\times 10^{4}}=1.000\n$$\n该结果已四舍五入到四位有效数字。\n\n因此，第二个分量为 $x_{2}=1.000$（保留四位有效数字）。", "answer": "$$\\boxed{1.000}$$", "id": "2174438"}]}