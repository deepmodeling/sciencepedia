{"hands_on_practices": [{"introduction": "在深入研究求解三对角系统的特定算法之前，理解为何这类系统在计算上具有特殊价值是至关重要的。这个练习让你通过一个具体的矩阵-向量乘法任务，亲身体验利用矩阵稀疏性所带来的计算效率优势 [@problem_id:2223673]。通过分析完成计算所需的乘法操作总数，你将明确地认识到，相较于处理稠密矩阵的 $O(n^2)$ 复杂度，针对三对角矩阵的线性复杂度 $O(n)$ 操作是何等高效。", "problem": "在数值分析中，利用矩阵的稀疏性对于计算效率至关重要。考虑一个 $n \\times n$ 的三对角矩阵 $T$，它不是以一个完整的方阵形式表示，而是通过三个向量来存储其非零元素：一个次对角线向量 $\\mathbf{a} = (a_2, \\dots, a_n)$、一个主对角线向量 $\\mathbf{b} = (b_1, \\dots, b_n)$ 和一个超对角线向量 $\\mathbf{c} = (c_1, \\dots, c_{n-1})$。该矩阵的元素由 $T_{i,i} = b_i$，$i > 1$ 时 $T_{i,i-1} = a_i$，以及 $i  n$ 时 $T_{i,i+1} = c_i$ 给出。$T$ 的所有其他元素均为零。\n\n令 $n=100$。对所有有效的索引 $i$，对角向量由以下规则定义：\n- $a_i = \\frac{i-1}{4}$\n- $b_i = \\frac{3i}{2}$\n- $c_i = \\frac{i}{2}$\n\n此外，考虑一个向量 $\\mathbf{x} = (x_1, \\dots, x_n)^T$，其分量由 $x_i = (-1)^{i}$ 给出。\n\n一个新的向量 $\\mathbf{y} = (y_1, \\dots, y_n)^T$ 通过矩阵和向量的乘积计算得出，即 $\\mathbf{y} = T\\mathbf{x}$。\n\n你需要求出两个值：\n1. 结果向量的第40个分量的值，$y_{40}$。\n2. 计算整个向量 $\\mathbf{y}$ 所需的乘法运算总数，假设计算明确使用 $T$ 的三向量表示法（即不执行涉及已知零元素的操作）。\n\n请以一对数字的形式，分别给出 $y_{40}$ 和乘法总数的答案。", "solution": "给定一个三对角矩阵 $T$，其元素为 $T_{i,i}=b_{i}$，$i1$时为$T_{i,i-1}=a_{i}$，$in$时为$T_{i,i+1}=c_{i}$，以及一个向量 $\\mathbf{x}$，其分量为 $x_{i}=(-1)^{i}$，则矩阵-向量积 $\\mathbf{y}=T\\mathbf{x}$ 的分量为\n$$\ny_{i}=\\sum_{j=1}^{n}T_{i,j}x_{j}.\n$$\n根据稀疏性，只有第 $i-1$、$i$ 和 $i+1$ 列的元素有贡献，所以对于 $1in$，\n$$\ny_{i}=a_{i}x_{i-1}+b_{i}x_{i}+c_{i}x_{i+1},\n$$\n而在边界处，\n$$\ny_{1}=b_{1}x_{1}+c_{1}x_{2}, \\quad y_{n}=a_{n}x_{n-1}+b_{n}x_{n}.\n$$\n\n对于 $i=40$（一个内部索引），使用给定的定义 $a_{i}=\\frac{i-1}{4}$，$b_{i}=\\frac{3i}{2}$，$c_{i}=\\frac{i}{2}$ 和 $x_{i}=(-1)^{i}$：\n$$\na_{40}=\\frac{39}{4}, \\quad b_{40}=60, \\quad c_{40}=20, \\quad x_{39}=-1, \\quad x_{40}=1, \\quad x_{41}=-1.\n$$\n因此，\n$$\ny_{40}=a_{40}x_{39}+b_{40}x_{40}+c_{40}x_{41}=\\frac{39}{4}(-1)+60(1)+20(-1)=-\\frac{39}{4}+40=\\frac{121}{4}.\n$$\n\n要计算使用三向量表示法并跳过已知零元素来计算 $\\mathbf{y}$ 所有分量所需的乘法总数，注意到 $T$ 的每个非零元素都与 $\\mathbf{x}$ 的一个分量相乘。一个三对角 $n\\times n$ 矩阵中非零元素的总数为\n$$\n(n-1) \\text{ on the subdiagonal} + n \\text{ on the main diagonal} + (n-1) \\text{ on the superdiagonal} = 3n-2.\n$$\n等效地，就每一行而言，第一行和最后一行各有 $2$ 次乘法，每个内部行有 $3$ 次乘法，总计为 $2+3(n-2)+2=3n-2$。对于 $n=100$，这给出\n$$\n3n-2=3\\cdot 100-2=298.\n$$\n因此，$y_{40}=\\frac{121}{4}$ 并且乘法总数为 $298$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{121}{4}  298 \\end{pmatrix}}$$", "id": "2223673"}, {"introduction": "托马斯算法是求解三对角线性系统的核心工具，它本质上是为这种特殊结构量身定制的高斯消元法。为了真正掌握该算法，手动推导其核心步骤是不可或缺的一步 [@problem_id:2223712]。本练习将引导你逐行完成托马斯算法前向消元过程的初始步骤，通过符号运算，你将清晰地看到系数是如何被系统地更新和消除的，从而深刻理解算法的内在递归逻辑。", "problem": "考虑一个一般的 $4 \\times 4$ 三对角线性方程组，表示为矩阵方程 $Ax = d$。其中矩阵 $A$ 和向量 $d$ 由下式给出：\n\n$$\nA = \\begin{pmatrix}\nb_1  c_1  0  0 \\\\\na_2  b_2  c_2  0 \\\\\n0  a_3  b_3  c_3 \\\\\n0  0  a_4  b_4\n\\end{pmatrix}\n, \\quad\nd = \\begin{pmatrix}\nd_1 \\\\\nd_2 \\\\\nd_3 \\\\\nd_4\n\\end{pmatrix}\n$$\n\n其中所有元素 $a_i, b_i, c_i, d_i$ 均为非零。托马斯算法（Thomas algorithm）是高斯消元法的一种特殊形式，它通过首先执行前向消元过程将系统转换为上三角形式，然后进行回代过程来求解该系统。\n\n前向消元阶段通过修改系数来进行。对于从 $2$ 到 $4$ 的每一行 $i$，通过使用上一行（$i-1$）的值来更新对角元素 $b_i$ 和右端项元素 $d_i$，从而消去元素 $a_i$。令修改后的系数用撇号表示（例如，$b_i'$ 和 $d_i'$）。\n\n执行前向消元过程的前两个步骤（针对行 $i=2$ 和 $i=3$）。确定第三行修改后的主对角线元素 $b_3'$ 和第三行修改后的右端项元素 $d_3'$ 的最终表达式。用原始系数 $a_i, b_i, c_i, d_i$ 完全表示这两个量。\n\n将你的最终答案表示为一个 $1 \\times 2$ 的行矩阵，其中按顺序包含 $b_3'$ 和 $d_3'$ 的表达式。", "solution": "该三对角系统可以按行写为\n$$\n\\begin{aligned}\nb_{1}x_{1} + c_{1}x_{2} = d_{1},\\\\\na_{2}x_{1} + b_{2}x_{2} + c_{2}x_{3} = d_{2},\\\\\na_{3}x_{2} + b_{3}x_{3} + c_{3}x_{4} = d_{3},\\\\\na_{4}x_{3} + b_{4}x_{4} = d_{4}.\n\\end{aligned}\n$$\n托马斯前向消元法使用乘数 $m_{i} = a_{i}/b_{i-1}'$ 来消去 $i=2,3,4$ 时的 $a_{i}$，其中 $b_{1}'=b_{1}$ 和 $d_{1}'=d_{1}$，并更新\n$$\nb_{i}' = b_{i} - m_{i} c_{i-1}, \\qquad d_{i}' = d_{i} - m_{i} d_{i-1}'.\n$$\n\n步骤 $i=2$：使用 $m_{2} = a_{2}/b_{1}$。则\n$$\nb_{2}' = b_{2} - \\frac{a_{2}}{b_{1}}\\,c_{1} = \\frac{b_{2}b_{1} - a_{2}c_{1}}{b_{1}}, \\qquad\nd_{2}' = d_{2} - \\frac{a_{2}}{b_{1}}\\,d_{1} = \\frac{d_{2}b_{1} - a_{2}d_{1}}{b_{1}}.\n$$\n\n步骤 $i=3$：使用 $m_{3} = a_{3}/b_{2}'$。则\n$$\nb_{3}' = b_{3} - \\frac{a_{3}}{b_{2}'}\\,c_{2}, \\qquad d_{3}' = d_{3} - \\frac{a_{3}}{b_{2}'}\\,d_{2}'.\n$$\n代入步骤 $i=2$ 中 $b_{2}'$ 和 $d_{2}'$ 的表达式可得\n$$\nb_{3}' = b_{3} - \\frac{a_{3}c_{2}}{(b_{2}b_{1} - a_{2}c_{1})/b_{1}} = b_{3} - \\frac{a_{3}c_{2}b_{1}}{b_{2}b_{1} - a_{2}c_{1}},\n$$\n$$\nd_{3}' = d_{3} - \\frac{a_{3}}{(b_{2}b_{1} - a_{2}c_{1})/b_{1}}\\cdot \\frac{d_{2}b_{1} - a_{2}d_{1}}{b_{1}} = d_{3} - \\frac{a_{3}(d_{2}b_{1} - a_{2}d_{1})}{b_{2}b_{1} - a_{2}c_{1}}.\n$$\n这些表达式完全由原始系数表示。", "answer": "$$\\boxed{\\begin{pmatrix} b_{3} - \\frac{a_{3}c_{2}b_{1}}{b_{2}b_{1} - a_{2}c_{1}}  d_{3} - \\frac{a_{3}\\left(d_{2}b_{1} - a_{2}d_{1}\\right)}{b_{2}b_{1} - a_{2}c_{1}} \\end{pmatrix}}$$", "id": "2223712"}, {"introduction": "任何数值算法都有其适用范围和局限性，即便是高效的托马斯算法也不例外。这个练习展示了一个特殊但重要的情景：一个保证有唯一解的非奇异三对角系统，标准的托马斯算法却因计算过程中出现零主元（pivot element）而失败 [@problem_id:2223672]。通过解决这个看似矛盾的问题，你将认识到数值稳定性的重要性，并理解在应用算法时进行批判性思考的必要性，这对于培养严谨的科学计算思维至关重要。", "problem": "一位数值分析师的任务是求解一个线性方程组 $A\\mathbf{x} = \\mathbf{d}$，该方程组模拟了一个具有特定、非标准配置的三质量四弹簧系统的稳态位移。该系统由三对角矩阵 $A$ 和外力向量 $\\mathbf{d}$ 定义如下：\n\n$$\nA = \\begin{pmatrix}\n1  2  0 \\\\\n2  4  1 \\\\\n0  1  1\n\\end{pmatrix}, \\quad \\mathbf{d} = \\begin{pmatrix}\n5 \\\\\n13 \\\\\n4\n\\end{pmatrix}\n$$\n\n该分析师试图采用标准的 Thomas 算法（也称为三对角矩阵算法，即 TDMA）来求解位移向量 $\\mathbf{x} = [x_1, x_2, x_3]^T$。这种标准实现是不使用主元选择的高斯消元法的一种特殊形式。在前向消元阶段，程序因除零错误而意外终止。\n\n尽管这个特定算法失败了，但矩阵 $A$ 是非奇异的，因此 $\\mathbf{x}$ 的唯一解是存在的。您的任务是找到这个解，并计算其各分量之和 $x_1 + x_2 + x_3$。", "solution": "我们求解线性方程组 $A\\mathbf{x}=\\mathbf{d}$，其中\n$$\nA=\\begin{pmatrix}\n1  2  0 \\\\\n2  4  1 \\\\\n0  1  1\n\\end{pmatrix},\\quad\n\\mathbf{d}=\\begin{pmatrix}\n5\\\\\n13\\\\\n4\n\\end{pmatrix},\n$$\n该方程组可通过显式写出方程并进行精确的代数消元来求解（由于 $A$ 是非奇异的，此方法有效）。\n\n该方程组为\n$$\n\\begin{cases}\nx_{1}+2x_{2}=5,\\\\\n2x_{1}+4x_{2}+x_{3}=13,\\\\\nx_{2}+x_{3}=4.\n\\end{cases}\n$$\n由第三个方程，解出 $x_{3}$：\n$$\nx_{3}=4-x_{2}.\n$$\n代入第二个方程：\n$$\n2x_{1}+4x_{2}+(4-x_{2})=13 \\;\\Rightarrow\\; 2x_{1}+3x_{2}=9.\n$$\n由第一个方程，用 $x_{2}$ 表示 $x_{1}$：\n$$\nx_{1}=5-2x_{2}.\n$$\n将此代入 $2x_{1}+3x_{2}=9$ 中：\n$$\n2(5-2x_{2})+3x_{2}=9 \\;\\Rightarrow\\; 10-4x_{2}+3x_{2}=9 \\;\\Rightarrow\\; 10-x_{2}=9 \\;\\Rightarrow\\; x_{2}=1.\n$$\n回代以求得 $x_{1}$ 和 $x_{3}$：\n$$\nx_{1}=5-2\\cdot 1=3,\\quad x_{3}=4-1=3.\n$$\n因此，\n$$\nx_{1}+x_{2}+x_{3}=3+1+3=7.\n$$\n\n为求完整，我们指出，在不使用主元选择的标准 Thomas 算法中，除零错误发生于前向消元阶段更新第二个对角元素之时：以初始值 $b_{1}=1, a_{2}=2, c_{1}=2$ 进行更新，会得到 $b_{2}=4-\\frac{a_{2}c_{1}}{b_{1}}=4-4=0$，这便导致了零主元。尽管如此，如上文所示，该方程组本身是相容的，并有唯一解。", "answer": "$$\\boxed{7}$$", "id": "2223672"}]}