{"hands_on_practices": [{"introduction": "掌握 Cholesky 分解的最佳方式是从一个具体的计算开始。这个练习将引导你对一个 2x2 的对称正定矩阵进行分解，这是一个理想的起点，因为它足够简单，可以手动计算，同时又能完整展示算法的每一步。通过为金融学中常见的协方差矩阵计算其 Cholesky 因子，你将掌握这一核心技能，并初步体会其在实际问题中的应用价值。[@problem_id:2158812]", "problem": "在量化金融中，资产回报率的协方差矩阵是投资组合优化和风险管理的基本工具。考虑一个由两只股票组成的简化投资组合。这些股票的每日回报率被建模为具有联合协方差矩阵 $A$ 的随机变量。对于这对特定的股票，其协方差矩阵由以下公式给出：\n$$\nA = \\begin{pmatrix} 2 & 1 \\\\ 1 & 3 \\end{pmatrix}\n$$\n为了使用诸如蒙特卡罗模拟等方法来模拟相关的回报情景，通常需要找到一个矩阵 $L$ 使得 $A = LL^T$。这被称为 $A$ 的Cholesky分解，其中 $L$ 是一个对角线元素严格为正的唯一下三角矩阵。\n\n你的任务是为给定的协方差矩阵 $A$ 计算其Cholesky因子 $L$。", "solution": "我们寻求一个对角线元素严格为正的下三角矩阵 $L$，使得 $A=LL^{T}$，其中\n$$\nA=\\begin{pmatrix}2 & 1 \\\\ 1 & 3\\end{pmatrix},\\quad L=\\begin{pmatrix} \\ell_{11} & 0 \\\\ \\ell_{21} & \\ell_{22} \\end{pmatrix}.\n$$\n计算 $LL^{T}$：\n$$\nLL^{T}=\\begin{pmatrix} \\ell_{11}^{2} & \\ell_{11}\\ell_{21} \\\\ \\ell_{21}\\ell_{11} & \\ell_{21}^{2}+\\ell_{22}^{2} \\end{pmatrix}.\n$$\n令其与 $A$ 的各项相等：\n1) 根据第 $(1,1)$ 项，有 $\\ell_{11}^{2}=2$。又因为 $\\ell_{11}>0$，我们得到 $\\ell_{11}=\\sqrt{2}$。\n\n2) 根据第 $(1,2)$ 项，有 $\\ell_{11}\\ell_{21}=1$，因此 $\\ell_{21}=\\frac{1}{\\ell_{11}}=\\frac{1}{\\sqrt{2}}$。\n\n3) 根据第 $(2,2)$ 项，有 $\\ell_{21}^{2}+\\ell_{22}^{2}=3$，所以\n$$\n\\ell_{22}^{2}=3-\\left(\\frac{1}{\\sqrt{2}}\\right)^{2}=3-\\frac{1}{2}=\\frac{5}{2},\n$$\n又因为 $\\ell_{22}>0$，我们得到 $\\ell_{22}=\\sqrt{\\frac{5}{2}}$。\n\n因此，Cholesky因子为\n$$\nL=\\begin{pmatrix} \\sqrt{2} & 0 \\\\ \\frac{1}{\\sqrt{2}} & \\sqrt{\\frac{5}{2}} \\end{pmatrix},\n$$\n该矩阵满足 $LL^{T}=A$ 且其对角线元素严格为正，这保证了唯一性。", "answer": "$$\\boxed{\\begin{pmatrix}\\sqrt{2} & 0 \\\\ \\frac{1}{\\sqrt{2}} & \\sqrt{\\frac{5}{2}}\\end{pmatrix}}$$", "id": "2158812"}, {"introduction": "在学会如何执行 Cholesky 分解后，一个很自然的问题是：这个方法总能成功吗？这个练习旨在通过一个反例来加深你的理解。你将尝试对一个非正定矩阵进行分解，并在此过程中发现算法在何处以及为何会“失败”，从而揭示 Cholesky 分解的一个重要特性：它不仅是一种计算工具，也是检验矩阵是否为正定的一种有效方法。[@problem_id:2158795]", "problem": "在数值线性代数中，Cholesky分解是把一个Hermite正定矩阵分解为一个下三角矩阵与其共轭转置的乘积。对于一个实对称矩阵$A$，该分解的形式为 $A = LL^T$，其中 $L$ 是一个对角线元素为正的实下三角矩阵。一个矩阵是正定的，当且仅当它有唯一的Cholesky分解。\n\n考虑以下对称矩阵 $A$：\n$$\nA = \\begin{pmatrix} 4 & 6 & 2 \\\\ 6 & 10 & 5 \\\\ 2 & 5 & 3 \\end{pmatrix}\n$$\n尝试以 $A=LL^T$ 的形式计算 $A$ 的Cholesky分解，其中 $L$ 是一个下三角矩阵：\n$$\nL = \\begin{pmatrix} l_{11} & 0 & 0 \\\\ l_{21} & l_{22} & 0 \\\\ l_{31} & l_{32} & l_{33} \\end{pmatrix}\n$$\n找出分解过程对该特定矩阵失败的主要原因。\n\nA. 算法在第一步失败，因为元素 $a_{11}$ 不是正数。\nB. 算法在计算元素 $l_{22}$ 时失败，因为平方根下的表达式 $a_{22} - l_{21}^2$ 是负数。\nC. 算法在计算元素 $l_{33}$ 时失败，因为平方根下的表达式 $a_{33} - l_{31}^2 - l_{32}^2$ 是负数。\nD. 算法失败，因为矩阵 $A$ 不是对称的。\nE. 算法没有失败；该矩阵存在一个有效的Cholesky分解。", "solution": "对于一个实对称矩阵 $A$，Cholesky算法构造一个下三角矩阵 $L$，其元素由以下公式递归地给出：\n$$\nl_{kk}=\\sqrt{a_{kk}-\\sum_{j=1}^{k-1} l_{kj}^{2}}, \\quad l_{ik}=\\frac{a_{ik}-\\sum_{j=1}^{k-1} l_{ij}l_{kj}}{l_{kk}} \\quad \\text{对于 } i>k.\n$$\n这要求所有平方根的参数（被开方数）都为正。\n\n将此算法应用于\n$$\nA=\\begin{pmatrix}4&6&2\\\\6&10&5\\\\2&5&3\\end{pmatrix}.\n$$\n步骤 $k=1$：\n$$\nl_{11}=\\sqrt{a_{11}}=\\sqrt{4}=2,\\quad l_{21}=\\frac{a_{21}}{l_{11}}=\\frac{6}{2}=3,\\quad l_{31}=\\frac{a_{31}}{l_{11}}=\\frac{2}{2}=1.\n$$\n步骤 $k=2$：\n$$\nl_{22}=\\sqrt{a_{22}-l_{21}^{2}}=\\sqrt{10-9}=\\sqrt{1}=1,\\quad l_{32}=\\frac{a_{32}-l_{31}l_{21}}{l_{22}}=\\frac{5-1\\cdot 3}{1}=2.\n$$\n步骤 $k=3$：\n$$\nl_{33}=\\sqrt{a_{33}-l_{31}^{2}-l_{32}^{2}}=\\sqrt{3-1-4}=\\sqrt{-2},\n$$\n该结果不是实数，因为平方根下的表达式是负数。因此，Cholesky过程恰好在计算 $l_{33}$ 时失败。\n\n这个失败反映了矩阵 $A$ 不是正定的；事实上，$\\det(A)=4(30-25)-6(18-10)+2(30-20)=20-48+20=-8<0$。因此，正确的选项是，算法在计算 $l_{33}$ 这一步因被开方数为负而失败。", "answer": "$$\\boxed{C}$$", "id": "2158795"}, {"introduction": "现在你已经掌握了 Cholesky 分解的计算方法和其适用条件，是时候探索它的强大应用了。求解线性方程组 $Ax=b$ 是科学计算中的一个核心任务，而当矩阵 $A$ 是对称正定时，Cholesky 分解提供了一种极为高效和数值稳定的解决方案。本练习将向你展示如何利用已知的 Cholesky 因子 $L$，通过简单的正向和反向代入，将一个复杂的求解问题分解为两个易于处理的步骤。[@problem_id:2158813]", "problem": "在许多数值优化和数据分析问题中，必须求解形如 $Ax=b$ 的线性方程组，其中矩阵 $A$ 是对称正定的。解决该问题的一个高效且稳定的方法是首先计算 $A$ 的 Cholesky 分解，它是一种形如 $A = LL^T$ 的分解，其中 $L$ 是一个对角元为正的下三角矩阵。\n\n假设对于一个特定问题，Cholesky 因子 $L$ 和向量 $b$ 由下式给出：\n$$L = \\begin{pmatrix} 2 & 0 & 0 \\\\ 1 & \\sqrt{5} & 0 \\\\ 3 & \\sqrt{5} & 2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 10 \\\\ 12 \\\\ 22 \\end{pmatrix}$$\n确定满足方程 $Ax=b$ 的解向量 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$ 的分量 $(x_1, x_2, x_3)$。", "solution": "我们已知一个具有 Cholesky 分解 $A=LL^{T}$ 的对称正定系统 $Ax=b$。标准的求解步骤如下：\n1) 通过前向代入法求解下三角系统 $L y = b$。\n2) 通过回代法求解上三角系统 $L^{T} x = y$。\n\n令 $y = \\begin{pmatrix} y_{1} \\\\ y_{2} \\\\ y_{3} \\end{pmatrix}$。由 $L y = b$ 及\n$$\nL = \\begin{pmatrix}\n2 & 0 & 0 \\\\\n1 & \\sqrt{5} & 0 \\\\\n3 & \\sqrt{5} & 2\n\\end{pmatrix},\n\\quad\nb = \\begin{pmatrix}\n10 \\\\ 12 \\\\ 22\n\\end{pmatrix},\n$$\n我们得到方程组\n$$\n2 y_{1} = 10, \\quad y_{1} + \\sqrt{5}\\, y_{2} = 12, \\quad 3 y_{1} + \\sqrt{5}\\, y_{2} + 2 y_{3} = 22.\n$$\n依次求解：\n$$\ny_{1} = 5,\n$$\n$$\n\\sqrt{5}\\, y_{2} = 12 - y_{1} = 7 \\;\\Rightarrow\\; y_{2} = \\frac{7}{\\sqrt{5}},\n$$\n$$\n\\sqrt{5}\\, y_{2} + 2 y_{3} = 22 - 3 y_{1} = 7 \\;\\Rightarrow\\; 7 + 2 y_{3} = 7 \\;\\Rightarrow\\; y_{3} = 0.\n$$\n因此 $y = \\begin{pmatrix} 5 \\\\ \\frac{7}{\\sqrt{5}} \\\\ 0 \\end{pmatrix}$。\n\n接下来求解 $L^{T} x = y$，其中\n$$\nL^{T} = \\begin{pmatrix}\n2 & 1 & 3 \\\\\n0 & \\sqrt{5} & \\sqrt{5} \\\\\n0 & 0 & 2\n\\end{pmatrix}, \\quad x = \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix}.\n$$\n回代法给出\n$$\n2 x_{3} = y_{3} = 0 \\;\\Rightarrow\\; x_{3} = 0,\n$$\n$$\n\\sqrt{5}\\, x_{2} + \\sqrt{5}\\, x_{3} = y_{2} = \\frac{7}{\\sqrt{5}} \\;\\Rightarrow\\; \\sqrt{5}\\, x_{2} = \\frac{7}{\\sqrt{5}} \\;\\Rightarrow\\; x_{2} = \\frac{7}{5},\n$$\n$$\n2 x_{1} + x_{2} + 3 x_{3} = y_{1} = 5 \\;\\Rightarrow\\; 2 x_{1} + \\frac{7}{5} = 5 \\;\\Rightarrow\\; 2 x_{1} = \\frac{18}{5} \\;\\Rightarrow\\; x_{1} = \\frac{9}{5}.\n$$\n因此，解向量为 $x = \\begin{pmatrix} \\frac{9}{5} \\\\ \\frac{7}{5} \\\\ 0 \\end{pmatrix}$，所求的分量为 $\\left(x_{1}, x_{2}, x_{3}\\right) = \\left(\\frac{9}{5}, \\frac{7}{5}, 0\\right)$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{9}{5} \\\\ \\frac{7}{5} \\\\ 0 \\end{pmatrix}}$$", "id": "2158813"}]}