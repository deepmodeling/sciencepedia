{"hands_on_practices": [{"introduction": "在我们深入研究如何计算 LU 分解本身之前，首先掌握如何使用一个已知的分解来求解线性系统至关重要。这个练习将重点放在求解过程的核心：通过两步法——前向替换和后向替换——来有效地找到解。通过这个实践 [@problem_id:2204086]，你将熟练掌握利用 $L$ 和 $U$ 矩阵的三角结构来简化问题的基本技巧。", "problem": "一个线性方程组由矩阵方程 $Ax=b$ 给出。矩阵 $A$ 已被分解为一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 的乘积，使得 $A=LU$。这种特定类型的下三角-上三角（LU）分解满足上三角矩阵 $U$ 的主对角线元素均为1。\n\n给定矩阵 $L$、$U$ 和向量 $b$ 如下：\n$$\nL = \\begin{pmatrix} 2 & 0 & 0 \\\\ -1 & 3 & 0 \\\\ 4 & -2 & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 1 & 2 & -1 \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\quad \\text{和} \\quad b = \\begin{pmatrix} -4 \\\\ 5 \\\\ -9 \\end{pmatrix}\n$$\n求出解向量 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$。", "solution": "我们已知 $A=LU$，其中 $L$ 为下三角矩阵，$U$ 为主对角线元素为1的上三角矩阵，并且我们要解 $Ax=b$。令 $y=Ux$。然后，可以通过向前代入法求解 $Ly=b$，接着通过回代法求解 $Ux=y$。\n\n首先求解 $Ly=b$，其中\n$$\nL=\\begin{pmatrix}2&0&0\\\\-1&3&0\\\\4&-2&1\\end{pmatrix},\\quad\ny=\\begin{pmatrix}y_{1}\\\\y_{2}\\\\y_{3}\\end{pmatrix},\\quad\nb=\\begin{pmatrix}-4\\\\5\\\\-9\\end{pmatrix}.\n$$\n写出该方程组：\n$$\n2y_{1}=-4,\\quad -y_{1}+3y_{2}=5,\\quad 4y_{1}-2y_{2}+y_{3}=-9.\n$$\n由第一个方程得，\n$$\ny_{1}=\\frac{-4}{2}=-2.\n$$\n代入第二个方程：\n$$\n-(-2)+3y_{2}=5\\;\\Rightarrow\\;2+3y_{2}=5\\;\\Rightarrow\\;3y_{2}=3\\;\\Rightarrow\\;y_{2}=1.\n$$\n将 $y_{1}$ 和 $y_{2}$ 代入第三个方程：\n$$\n4(-2)-2(1)+y_{3}=-9\\;\\Rightarrow\\;-8-2+y_{3}=-9\\;\\Rightarrow\\;-10+y_{3}=-9\\;\\Rightarrow\\;y_{3}=1.\n$$\n因此，\n$$\ny=\\begin{pmatrix}-2\\\\1\\\\1\\end{pmatrix}.\n$$\n\n接下来求解 $Ux=y$，其中\n$$\nU=\\begin{pmatrix}1&2&-1\\\\0&1&3\\\\0&0&1\\end{pmatrix},\\quad\nx=\\begin{pmatrix}x_{1}\\\\x_{2}\\\\x_{3}\\end{pmatrix},\\quad\ny=\\begin{pmatrix}-2\\\\1\\\\1\\end{pmatrix}.\n$$\n写出该方程组：\n$$\nx_{3}=1,\\quad x_{2}+3x_{3}=1,\\quad x_{1}+2x_{2}-x_{3}=-2.\n$$\n由第三行得，\n$$\nx_{3}=1.\n$$\n由第二行得，\n$$\nx_{2}+3(1)=1\\;\\Rightarrow\\;x_{2}=-2.\n$$\n由第一行得，\n$$\nx_{1}+2(-2)-1=-2\\;\\Rightarrow\\;x_{1}-4-1=-2\\;\\Rightarrow\\;x_{1}-5=-2\\;\\Rightarrow\\;x_{1}=3.\n$$\n因此，解向量为 $x=\\begin{pmatrix}3\\\\-2\\\\1\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} 3 \\\\ -2 \\\\ 1 \\end{pmatrix}}$$", "id": "2204086"}, {"introduction": "掌握了如何使用分解求解方程组后，下一步自然是学习如何从头开始进行 LU 分解。本练习将引导你完成整个过程：首先对一个包含参数的矩阵 $A$ 进行 Doolittle 分解，得到单位下三角矩阵 $L$ 和上三角矩阵 $U$。然后，利用这个分解来求解一个典型的线性系统 $A\\mathbf{x} = \\mathbf{b}$ [@problem_id:2204091]，从而将分解和求解两个步骤融会贯通。", "problem": "在对某个双变量线性动力系统的分析中，其稳态行为由矩阵方程 $A\\mathbf{x} = \\mathbf{b}$ 描述。系统矩阵 $A$ 和输入向量 $\\mathbf{b}$ 依赖于一个表示耦合强度的实参数 $\\gamma$。它们由下式给出：\n$$A = \\begin{pmatrix} \\gamma & \\gamma \\\\ 1 & 2\\gamma \\end{pmatrix} \\quad \\text{且} \\quad \\mathbf{b} = \\begin{pmatrix} 2\\gamma \\\\ 3 \\end{pmatrix}$$\n已知参数 $\\gamma$ 为正 ($\\gamma > 0$) 且不等于 $1/2$。\n\n你的任务是求出稳态解向量 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$。为此，你必须首先求出矩阵 $A$ 的 LU 分解（下三角-上三角分解），形式为 $A = LU$，其中 $L$ 是主对角线元素为1的下三角矩阵，$U$ 是上三角矩阵。然后，使用此分解求解 $\\mathbf{x}$。将你的最终答案 $\\mathbf{x}$ 用 $\\gamma$ 表示。", "solution": "我们寻求 $A$ 的 LU 分解，其中 $L$ 是单位下三角矩阵，$U$ 是上三角矩阵，然后通过向前和向后代入法求解 $A\\mathbf{x}=\\mathbf{b}$。由于 $\\gamma>0$，我们有 $\\gamma\\neq 0$，且给定的 $\\gamma\\neq \\frac{1}{2}$ 确保了 $\\det(A)=\\gamma(2\\gamma-1)\\neq 0$。\n\n假设\n$$\nL=\\begin{pmatrix}1&0\\\\ \\ell&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}&u_{12}\\\\ 0&u_{22}\\end{pmatrix},\n$$\n从而 $A=LU$ 意味着\n$$\n\\begin{pmatrix}\\gamma&\\gamma\\\\ 1&2\\gamma\\end{pmatrix}\n=\n\\begin{pmatrix}1&0\\\\ \\ell&1\\end{pmatrix}\n\\begin{pmatrix}u_{11}&u_{12}\\\\ 0&u_{22}\\end{pmatrix}\n=\n\\begin{pmatrix}u_{11}&u_{12}\\\\ \\ell u_{11}&\\ell u_{12}+u_{22}\\end{pmatrix}.\n$$\n令各项对应相等，可得\n$$\nu_{11}=\\gamma,\\quad u_{12}=\\gamma,\\quad \\ell u_{11}=1,\\quad \\ell u_{12}+u_{22}=2\\gamma.\n$$\n从 $\\ell u_{11}=1$ 我们得到 $\\ell=\\frac{1}{\\gamma}$。那么\n$$\nu_{22}=2\\gamma-\\ell u_{12}=2\\gamma-\\frac{1}{\\gamma}\\,\\gamma=2\\gamma-1.\n$$\n因此\n$$\nL=\\begin{pmatrix}1&0\\\\ \\frac{1}{\\gamma}&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}\\gamma&\\gamma\\\\ 0&2\\gamma-1\\end{pmatrix}.\n$$\n\n为了解 $A\\mathbf{x}=\\mathbf{b}$，我们将其写为 $LU\\mathbf{x}=\\mathbf{b}$，并先求解 $L\\mathbf{y}=\\mathbf{b}$ 得到 $\\mathbf{y}$，然后再求解 $U\\mathbf{x}=\\mathbf{y}$。当 $\\mathbf{b}=\\begin{pmatrix}2\\gamma\\\\ 3\\end{pmatrix}$ 时，方程组 $L\\mathbf{y}=\\mathbf{b}$ 为\n$$\n\\begin{pmatrix}1&0\\\\ \\frac{1}{\\gamma}&1\\end{pmatrix}\n\\begin{pmatrix}y_{1}\\\\ y_{2}\\end{pmatrix}\n=\n\\begin{pmatrix}2\\gamma\\\\ 3\\end{pmatrix}.\n$$\n从第一行得到 $y_{1}=2\\gamma$。从第二行得到 $\\frac{1}{\\gamma}y_{1}+y_{2}=3$，因此\n$$\ny_{2}=3-\\frac{1}{\\gamma}(2\\gamma)=3-2=1,\n$$\n所以 $\\mathbf{y}=\\begin{pmatrix}2\\gamma\\\\ 1\\end{pmatrix}$。\n\n现在求解 $U\\mathbf{x}=\\mathbf{y}$：\n$$\n\\begin{pmatrix}\\gamma&\\gamma\\\\ 0&2\\gamma-1\\end{pmatrix}\n\\begin{pmatrix}x_{1}\\\\ x_{2}\\end{pmatrix}\n=\n\\begin{pmatrix}2\\gamma\\\\ 1\\end{pmatrix}.\n$$\n从第二行得到 $(2\\gamma-1)x_{2}=1$，所以\n$$\nx_{2}=\\frac{1}{2\\gamma-1}.\n$$\n从第一行得到 $\\gamma(x_{1}+x_{2})=2\\gamma$，因此 $x_{1}+x_{2}=2$，所以\n$$\nx_{1}=2-\\frac{1}{2\\gamma-1}=\\frac{4\\gamma-3}{2\\gamma-1}.\n$$\n\n因此，稳态解向量为\n$$\n\\mathbf{x}=\\begin{pmatrix}\\frac{4\\gamma-3}{2\\gamma-1}\\\\ \\frac{1}{2\\gamma-1}\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{4\\gamma-3}{2\\gamma-1}\\\\ \\frac{1}{2\\gamma-1}\\end{pmatrix}}$$", "id": "2204091"}, {"introduction": "LU 分解的一个关键优势在于其计算效率，尤其是在需要多次求解具有相同系数矩阵的线性系统时。本练习 [@problem_id:2204064] 提出了一个更复杂的挑战：求解形如 $A^2\\mathbf{x} = \\mathbf{b}$ 的系统。你将学习如何通过将问题分解为两个连续的、更易于处理的线性系统（$A\\mathbf{y} = \\mathbf{b}$ 和 $A\\mathbf{x} = \\mathbf{y}$）来巧妙地利用 $A$ 的 LU 分解，从而避免了计算成本高昂的矩阵乘法 $A^2$。", "problem": "在一个机械系统的计算模型中，稳态位移向量 $\\mathbf{x}$ 是通过求解形如 $A^2\\mathbf{x} = \\mathbf{b}$ 的矩阵方程来确定的。相较于为计算 $A^2$ 而执行耗时的矩阵乘法，利用矩阵 $A$ 的 LU 分解可以找到一种更高效的解法。\n\n给定一个 $3 \\times 3$ 矩阵 $A$ 的 LU 分解，使得 $A=LU$。矩阵 $L$ 是一个单位下三角矩阵，而 $U$ 是一个上三角矩阵。具体的矩阵和向量 $\\mathbf{b}$ 如下：\n\n$L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}$, $U = \\begin{pmatrix} 2 & 1 & -1 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}$, 和 $\\mathbf{b} = \\begin{pmatrix} -3 \\\\ -45 \\\\ -90 \\end{pmatrix}$\n\n你的任务是求出解向量 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$。\n\n将你的最终答案表示为 $\\begin{pmatrix} x_1 & x_2 & x_3 \\end{pmatrix}$ 形式的行矩阵。", "solution": "我们需要求解 $A^{2}\\mathbf{x}=\\mathbf{b}$，其中 $A=LU$。引入辅助向量 $\\mathbf{y}$，定义为 $\\mathbf{y}=A\\mathbf{x}$。则有 $A\\mathbf{y}=\\mathbf{b}$。因此，我们可以利用 $A$ 的 LU 分解来求解两个系数矩阵同为 $A$ 的连续线性系统：\n1) 求解 $A\\mathbf{y}=\\mathbf{b}$。\n2) 求解 $A\\mathbf{x}=\\mathbf{y}$。\n\n由于 $A=LU$，求解 $A\\mathbf{w}=\\mathbf{r}$ 的过程可分解为：首先求解 $L\\mathbf{z}=\\mathbf{r}$（正向代入），然后求解 $U\\mathbf{w}=\\mathbf{z}$（回代）。\n\n首先求解 $A\\mathbf{y}=\\mathbf{b}$，其中 $L=\\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}$，$U=\\begin{pmatrix} 2 & 1 & -1 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}$，以及 $\\mathbf{b}=\\begin{pmatrix} -3 \\\\ -45 \\\\ -90 \\end{pmatrix}$。\n\n对 $L\\mathbf{z}=\\mathbf{b}$ 进行正向代入：\n$$\n\\begin{cases}\nz_{1}=-3,\\\\\n2z_{1}+z_{2}=-45 \\;\\Rightarrow\\; z_{2}=-39,\\\\\n-z_{1}+3z_{2}+z_{3}=-90 \\;\\Rightarrow\\; z_{3}=24,\n\\end{cases}\n$$\n所以 $\\mathbf{z}=\\begin{pmatrix}-3\\\\-39\\\\24\\end{pmatrix}$。\n\n对 $U\\mathbf{y}=\\mathbf{z}$ 进行回代：\n$$\n\\begin{cases}\n-2y_{3}=24 \\;\\Rightarrow\\; y_{3}=-12,\\\\\n3y_{2}+y_{3}=-39 \\;\\Rightarrow\\; y_{2}=-9,\\\\\n2y_{1}+y_{2}-y_{3}=-3 \\;\\Rightarrow\\; y_{1}=-3,\n\\end{cases}\n$$\n所以 $\\mathbf{y}=\\begin{pmatrix}-3\\\\-9\\\\-12\\end{pmatrix}$。\n\n接下来求解 $A\\mathbf{x}=\\mathbf{y}$。\n\n对 $L\\mathbf{t}=\\mathbf{y}$ 进行正向代入：\n$$\n\\begin{cases}\nt_{1}=-3,\\\\\n2t_{1}+t_{2}=-9 \\;\\Rightarrow\\; t_{2}=-3,\\\\\n-t_{1}+3t_{2}+t_{3}=-12 \\;\\Rightarrow\\; t_{3}=-6,\n\\end{cases}\n$$\n所以 $\\mathbf{t}=\\begin{pmatrix}-3\\\\-3\\\\-6\\end{pmatrix}$。\n\n对 $U\\mathbf{x}=\\mathbf{t}$ 进行回代：\n$$\n\\begin{cases}\n-2x_{3}=-6 \\;\\Rightarrow\\; x_{3}=3,\\\\\n3x_{2}+x_{3}=-3 \\;\\Rightarrow\\; x_{2}=-2,\\\\\n2x_{1}+x_{2}-x_{3}=-3 \\;\\Rightarrow\\; x_{1}=1,\n\\end{cases}\n$$\n所以 $\\mathbf{x}=\\begin{pmatrix}1\\\\-2\\\\3\\end{pmatrix}$。\n\n因此，所求的行矩阵是 $\\begin{pmatrix}1 & -2 & 3\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} 1 & -2 & 3 \\end{pmatrix}}$$", "id": "2204064"}]}