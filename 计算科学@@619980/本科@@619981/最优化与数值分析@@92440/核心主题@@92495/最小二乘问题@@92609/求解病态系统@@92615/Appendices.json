{"hands_on_practices": [{"introduction": "诊断病态系统的第一步是量化其不稳定性。条件数 $ \\kappa(A) $ 是实现这一目标的主要工具，它衡量了输入数据的微小变化会对解产生多大影响。本练习将提供使用不同标准范数（$1$-范数、$2$-范数和 $\\infty$-范数）直接计算这一关键指标的实践，帮助您建立对“大”条件数的具体理解。[@problem_id:2203804]", "problem": "在数值线性代数中，矩阵的条件数用于衡量线性系统解对输入数据微小变化的敏感程度。条件数高的系统被称为病态系统。考虑一个给定的 $2 \\times 2$ 矩阵 $A$：\n$$\nA = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.001 \\end{pmatrix}\n$$\n条件数 $\\kappa(A)$ 的值取决于所选择的矩阵范数。对于一个非奇异矩阵 $A$，其关于范数 $\\| \\cdot \\|$ 的条件数定义为 $\\kappa(A) = \\|A\\| \\|A^{-1}\\|$。\n\n你需要使用三种不同的标准矩阵范数来计算矩阵 $A$ 的条件数，对于一个 $m \\times n$ 的矩阵 $A = (a_{ij})$，这些范数定义如下：\n1.  $1$-范数（或最大绝对列和范数）：$\\|A\\|_1 = \\max_{1 \\le j \\le n} \\sum_{i=1}^{m} |a_{ij}|$。\n2.  $\\infty$-范数（或最大绝对行和范数）：$\\|A\\|_\\infty = \\max_{1 \\le i \\le m} \\sum_{j=1}^{n} |a_{ij}|$。\n3.  $2$-范数（或谱范数）：$\\|A\\|_2 = \\sqrt{\\lambda_{\\max}(A^T A)}$，其中 $A^T$ 是 $A$ 的转置，$\\lambda_{\\max}(A^T A)$ 是矩阵 $A^T A$ 的最大特征值。\n\n计算条件数 $\\kappa_1(A)$、$\\kappa_\\infty(A)$ 和 $\\kappa_2(A)$。将你计算出的 $\\kappa_1(A)$、$\\kappa_\\infty(A)$ 和 $\\kappa_2(A)$ 三个结果按顺序以一行数字的形式呈现。所有数值必须四舍五入到五位有效数字。", "solution": "该问题要求计算给定矩阵 $A$ 的条件数 $\\kappa_1(A)$、$\\kappa_\\infty(A)$ 和 $\\kappa_2(A)$。条件数的定义是 $\\kappa(A) = \\|A\\| \\|A^{-1}\\|$。\n\n首先，我们需要求矩阵 $A$ 的逆矩阵。\n给定的矩阵是 $A = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.001 \\end{pmatrix}$。\n$A$ 的行列式是 $\\det(A) = (1)(1.001) - (1)(1) = 1.001 - 1 = 0.001$。\n一个通用的 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ 的逆是 $\\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$。\n所以，$A$ 的逆矩阵是：\n$$\nA^{-1} = \\frac{1}{0.001} \\begin{pmatrix} 1.001 & -1 \\\\ -1 & 1 \\end{pmatrix} = 1000 \\begin{pmatrix} 1.001 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 1001 & -1000 \\\\ -1000 & 1000 \\end{pmatrix}\n$$\n\n现在我们计算 $A$ 和 $A^{-1}$ 所需的范数。\n\n**第1步：计算 $\\kappa_1(A)$**\n$1$-范数是最大绝对列和。\n对于矩阵 $A$：\n第一列绝对值之和为 $|1| + |1| = 2$。\n第二列绝对值之和为 $|1| + |1.001| = 2.001$。\n所以, $\\|A\\|_1 = \\max(2, 2.001) = 2.001$。\n对于矩阵 $A^{-1}$：\n第一列绝对值之和为 $|1001| + |-1000| = 1001 + 1000 = 2001$。\n第二列绝对值之和为 $|-1000| + |1000| = 1000 + 1000 = 2000$。\n所以, $\\|A^{-1}\\|_1 = \\max(2001, 2000) = 2001$。\n$1$-范数下的条件数是：\n$$\n\\kappa_1(A) = \\|A\\|_1 \\|A^{-1}\\|_1 = 2.001 \\times 2001 = 4004.001\n$$\n\n**第2步：计算 $\\kappa_\\infty(A)$**\n$\\infty$-范数是最大绝对行和。\n对于矩阵 $A$：\n第一行绝对值之和为 $|1| + |1| = 2$。\n第二行绝对值之和为 $|1| + |1.001| = 2.001$。\n所以, $\\|A\\|_\\infty = \\max(2, 2.001) = 2.001$。\n对于矩阵 $A^{-1}$：\n第一行绝对值之和为 $|1001| + |-1000| = 1001 + 1000 = 2001$。\n第二行绝对值之和为 $|-1000| + |1000| = 1000 + 1000 = 2000$。\n所以, $\\|A^{-1}\\|_\\infty = \\max(2001, 2000) = 2001$。\n$\\infty$-范数下的条件数是：\n$$\n\\kappa_\\infty(A) = \\|A\\|_\\infty \\|A^{-1}\\|_\\infty = 2.001 \\times 2001 = 4004.001\n$$\n\n**第3步：计算 $\\kappa_2(A)$**\n$2$-范数条件数由 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$ 给出。一个等价的定义是 $\\kappa_2(A) = \\sqrt{\\frac{\\lambda_{\\max}(A^T A)}{\\lambda_{\\min}(A^T A)}}$，其中 $\\lambda_{\\max}$ 和 $\\lambda_{\\min}$分别是 $A^T A$ 的最大和最小特征值。\n首先，我们计算矩阵 $A^T A$：\n$$\nA^T A = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.001 \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.001 \\end{pmatrix} = \\begin{pmatrix} 1\\cdot1+1\\cdot1 & 1\\cdot1+1\\cdot1.001 \\\\ 1\\cdot1+1.001\\cdot1 & 1\\cdot1+1.001\\cdot1.001 \\end{pmatrix}\n$$\n$$\nA^T A = \\begin{pmatrix} 2 & 2.001 \\\\ 2.001 & 1 + 1.002001 \\end{pmatrix} = \\begin{pmatrix} 2 & 2.001 \\\\ 2.001 & 2.002001 \\end{pmatrix}\n$$\n接下来，我们通过求解特征方程 $\\det(A^T A - \\lambda I) = 0$ 来求 $A^T A$ 的特征值：\n$$\n\\det \\begin{pmatrix} 2-\\lambda & 2.001 \\\\ 2.001 & 2.002001-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(2-\\lambda)(2.002001-\\lambda) - (2.001)^2 = 0\n$$\n$$\n\\lambda^2 - (2.002001+2)\\lambda + (2)(2.002001) - (2.001)^2 = 0\n$$\n$$\n\\lambda^2 - 4.002001\\lambda + 4.004002 - 4.004001 = 0\n$$\n$$\n\\lambda^2 - 4.002001\\lambda + 0.000001 = 0\n$$\n我们使用二次公式求解特征值。\n$$\n\\lambda = \\frac{4.002001 \\pm \\sqrt{(-4.002001)^2 - 4(1)(0.000001)}}{2}\n$$\n$$\n\\lambda = \\frac{4.002001 \\pm \\sqrt{16.016008004001}}{2}\n$$\n最大和最小特征值分别为：\n$$\n\\lambda_{\\max} \\approx 4.00200075\n$$\n$$\n\\lambda_{\\min} \\approx 0.000000249875\n$$\n现在，我们计算 $2$-范数条件数：\n$$\n\\kappa_2(A) = \\sqrt{\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}} \\approx \\sqrt{\\frac{4.00200075}{0.000000249875}} \\approx \\sqrt{16016413} \\approx 4002.0511\n$$\n\n**第4步：最终结果与四舍五入**\n计算出的值为：\n$\\kappa_1(A) = 4004.001$\n$\\kappa_\\infty(A) = 4004.001$\n$\\kappa_2(A) \\approx 4002.0511$\n\n四舍五入到五位有效数字：\n$\\kappa_1(A) \\approx 4004.0$\n$\\kappa_\\infty(A) \\approx 4004.0$\n$\\kappa_2(A) \\approx 4002.1$\n\n最终答案应以一行这三个数字的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4004.0 & 4004.0 & 4002.1\n\\end{pmatrix}\n}\n$$", "id": "2203804"}, {"introduction": "一个大的条件数不仅仅是一个抽象的数学属性，它会带来真实的、往往是灾难性的后果。本练习将通过一个控制系统的假想场景，演示即使是在测量数据（即右侧向量 $ \\mathbf{b} $）中存在微小且不可避免的误差，也可能被一个病态矩阵极大地放大，从而导致计算出的解出现巨大的、不可靠的误差。通过这个练习，您可以将条件数与误差传播的幅度直接联系起来。[@problem_id:2203854]", "problem": "一个制造过程中的控制系统由线性方程组 $A\\mathbf{x} = \\mathbf{b}$ 描述，其中 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ 代表两个执行器的设置。该系统的行为由以下矩阵决定：\n$$\nA = \\begin{pmatrix} 1 & 0.999 \\\\ 1 & 1 \\end{pmatrix}\n$$\n向量 $\\mathbf{b}$ 由传感器读数确定。由于固有的噪声和校准限制，测量所得的向量（我们称之为 $\\mathbf{b}_{\\text{pert}}$）与真实的理想向量 $\\mathbf{b}_{\\text{true}}$ 存在微小偏差。这种不确定性通过一个最大相对误差来量化，使用无穷范数（$L_\\infty$-范数），使得：\n$$\n\\frac{||\\mathbf{b}_{\\text{pert}} - \\mathbf{b}_{\\text{true}}||_\\infty}{||\\mathbf{b}_{\\text{true}}||_\\infty} \\le 1.2 \\times 10^{-4}\n$$\n当控制系统计算执行器设置时，它求解 $A\\mathbf{x}_{\\text{comp}} = \\mathbf{b}_{\\text{pert}}$，其中 $\\mathbf{x}_{\\text{comp}}$ 是计算出的解。我们关心的是这个计算解与满足 $A\\mathbf{x}_{\\text{true}} = \\mathbf{b}_{\\text{true}}$ 的真实理想解 $\\mathbf{x}_{\\text{true}}$ 会有多大的偏差。\n\n使用线性系统的理论误差界，确定解中的最大可能相对误差，定义为 $\\frac{||\\mathbf{x}_{\\text{comp}} - \\mathbf{x}_{\\text{true}}||_\\infty}{||\\mathbf{x}_{\\text{true}}||_\\infty}$。\n\n对于此问题，所有向量和矩阵计算均使用无穷范数。向量 $\\mathbf{v} = (v_i)$ 的无穷范数是 $||\\mathbf{v}||_\\infty = \\max_i |v_i|$，其诱导的矩阵范数是 $||A||_\\infty = \\max_i \\sum_j |A_{ij}|$。\n\n将您的最终答案四舍五入到两位有效数字。", "solution": "我们使用仅在右侧存在扰动的线性系统的标准扰动界。设 $A \\mathbf{x}_{\\text{true}} = \\mathbf{b}_{\\text{true}}$ 且 $A \\mathbf{x}_{\\text{comp}} = \\mathbf{b}_{\\text{pert}}$。那么\n$$\n\\mathbf{x}_{\\text{comp}} - \\mathbf{x}_{\\text{true}} = A^{-1}(\\mathbf{b}_{\\text{pert}} - \\mathbf{b}_{\\text{true}}),\n$$\n因此根据诱导 $\\infty$-范数，\n$$\n\\|\\mathbf{x}_{\\text{comp}} - \\mathbf{x}_{\\text{true}}\\|_{\\infty} \\le \\|A^{-1}\\|_{\\infty}\\,\\|\\mathbf{b}_{\\text{pert}} - \\mathbf{b}_{\\text{true}}\\|_{\\infty}.\n$$\n为了将其与 $\\|\\mathbf{x}_{\\text{true}}\\|_{\\infty}$ 关联，使用 $A \\mathbf{x}_{\\text{true}} = \\mathbf{b}_{\\text{true}}$ 和不等式 $\\|A \\mathbf{x}\\|_{\\infty} \\le \\|A\\|_{\\infty}\\,\\|\\mathbf{x}\\|_{\\infty}$ 可得\n$$\n\\|\\mathbf{x}_{\\text{true}}\\|_{\\infty} \\ge \\frac{\\|\\mathbf{b}_{\\text{true}}\\|_{\\infty}}{\\|A\\|_{\\infty}}.\n$$\n因此，\n$$\n\\frac{\\|\\mathbf{x}_{\\text{comp}} - \\mathbf{x}_{\\text{true}}\\|_{\\infty}}{\\|\\mathbf{x}_{\\text{true}}\\|_{\\infty}} \\le \\|A\\|_{\\infty}\\,\\|A^{-1}\\|_{\\infty}\\,\\frac{\\|\\mathbf{b}_{\\text{pert}} - \\mathbf{b}_{\\text{true}}\\|_{\\infty}}{\\|\\mathbf{b}_{\\text{true}}\\|_{\\infty}} = \\kappa_{\\infty}(A)\\,\\frac{\\|\\mathbf{b}_{\\text{pert}} - \\mathbf{b}_{\\text{true}}\\|_{\\infty}}{\\|\\mathbf{b}_{\\text{true}}\\|_{\\infty}}.\n$$\n\n接下来使用 $\\infty$-范数计算 $\\kappa_{\\infty}(A) = \\|A\\|_{\\infty}\\,\\|A^{-1}\\|_{\\infty}$。给定\n$$\nA = \\begin{pmatrix} 1 & 0.999 \\\\ 1 & 1 \\end{pmatrix},\n$$\n各行绝对值之和分别为 $1+0.999=1.999$ 和 $1+1=2$，所以\n$$\n\\|A\\|_{\\infty} = 2.\n$$\n行列式为 $\\det(A) = 1\\cdot 1 - 0.999\\cdot 1 = 0.001$，因此\n$$\nA^{-1} = \\frac{1}{0.001}\\begin{pmatrix} 1 & -0.999 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 1000 & -999 \\\\ -1000 & 1000 \\end{pmatrix}.\n$$\n$A^{-1}$ 的各行绝对值之和分别为 $1000+999=1999$ 和 $1000+1000=2000$，所以\n$$\n\\|A^{-1}\\|_{\\infty} = 2000.\n$$\n因此，\n$$\n\\kappa_{\\infty}(A) = \\|A\\|_{\\infty}\\,\\|A^{-1}\\|_{\\infty} = 2 \\cdot 2000 = 4000.\n$$\n\n根据给定的 $\\mathbf{b}$ 的相对扰动界，\n$$\n\\frac{\\|\\mathbf{b}_{\\text{pert}} - \\mathbf{b}_{\\text{true}}\\|_{\\infty}}{\\|\\mathbf{b}_{\\text{true}}\\|_{\\infty}} \\le 1.2 \\times 10^{-4},\n$$\n我们得到解中的最大可能相对误差界：\n$$\n\\frac{\\|\\mathbf{x}_{\\text{comp}} - \\mathbf{x}_{\\text{true}}\\|_{\\infty}}{\\|\\mathbf{x}_{\\text{true}}\\|_{\\infty}} \\le \\kappa_{\\infty}(A)\\left(1.2 \\times 10^{-4}\\right) = 4000 \\times 1.2 \\times 10^{-4} = 0.48.\n$$\n四舍五入到两位有效数字，该界为 $0.48$。", "answer": "$$\\boxed{0.48}$$", "id": "2203854"}, {"introduction": "一旦识别出病态问题，我们该如何处理？直接求解通常是不可行的，因此需要更稳健的方法。本练习介绍了一种强大且广泛使用的技术——正则化，特别是利用奇异值分解（SVD）的方法。通过系统地忽略与极小奇异值相关的部分信息，我们可以滤除解中最易受噪声影响的分量，从而计算出一个稳定且有意义的近似解。[@problem_id:2203817]", "problem": "在数据分析领域，如果矩阵 $A$ 是病态的 (ill-conditioned)，求解线性方程组 $Ax=b$ 可能会出现问题。这意味着测量向量 $b$ 中的微小误差可能导致解向量 $x$ 中出现巨大的、物理上无意义的误差。为了克服这个问题，通常采用正则化过程来寻找一个稳定的近似解。\n\n考虑这样一个系统，其中矩阵 $A$ 的奇异值分解 (Singular Value Decomposition, SVD) 由 $A = U \\Sigma V^T$ 给出。该分解的各分量和测量向量 $b$ 如下所示：\n$$ U = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1 & -2 \\\\ 2 & 1 \\end{pmatrix}, \\quad \\Sigma = \\begin{pmatrix} \\sqrt{50} & 0 \\\\ 0 & 10^{-5} \\end{pmatrix}, \\quad V = \\frac{1}{\\sqrt{10}}\\begin{pmatrix} 1 & -3 \\\\ 3 & 1 \\end{pmatrix} $$\n$$ b = \\begin{pmatrix} 5\\sqrt{5} \\\\ 0 \\end{pmatrix} $$\n一个正则化解，记作 $x_{\\text{reg}}$，通过以下三步计算得出：\n1.  首先，通过计算 $b' = U^T b$，将测量向量 $b$ 转换到由 $U$ 定义的新基中。设 $b'$ 的分量为 $b'_1$ 和 $b'_2$。\n2.  接下来，构造一个滤波后的向量 $w = \\begin{pmatrix} w_1 \\\\ w_2 \\end{pmatrix}$。$w$ 的分量由以下规则确定：如果对应的奇异值 $\\sigma_i$ 大于阈值 $\\tau = 10^{-3}$，则 $w_i = \\frac{b'_i}{\\sigma_i}$。如果 $\\sigma_i$ 不大于 $\\tau$，则 $w_i = 0$。奇异值 $\\sigma_i$ 是矩阵 $\\Sigma$ 的对角线元素。\n3.  最后，使用关系式 $x_{\\text{reg}} = Vw$ 将滤波后的向量 $w$ 转换回原始基，以找到正则化解。\n\n计算正则化解向量 $x_{\\text{reg}}$。将最终答案表示为一个 2x1 的列向量，其数值项四舍五入到三位有效数字。", "solution": "我们已知 SVD 的各分量 $U$、$\\Sigma$、$V$ 以及向量 $b$，我们遵循指定的三步正则化过程。\n\n步骤 1：计算 $b' = U^{T} b$。已知\n$$\nU^{T} = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1 & 2 \\\\ -2 & 1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 5\\sqrt{5} \\\\ 0 \\end{pmatrix},\n$$\n我们得到\n$$\nb' = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1 & 2 \\\\ -2 & 1 \\end{pmatrix}\\begin{pmatrix} 5\\sqrt{5} \\\\ 0 \\end{pmatrix}\n= \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 5\\sqrt{5} \\\\ -10\\sqrt{5} \\end{pmatrix}\n= \\begin{pmatrix} 5 \\\\ -10 \\end{pmatrix}.\n$$\n因此 $b'_{1} = 5$ 且 $b'_{2} = -10$。\n\n步骤 2：使用奇异值 $\\sigma_{1} = \\sqrt{50} = 5\\sqrt{2}$ 和 $\\sigma_{2} = 10^{-5}$，以及阈值 $\\tau = 10^{-3}$，根据阈值规则构造 $w$。因为 $\\sigma_{1} > \\tau$，我们设\n$$\nw_{1} = \\frac{b'_{1}}{\\sigma_{1}} = \\frac{5}{\\sqrt{50}} = \\frac{5}{5\\sqrt{2}} = \\frac{1}{\\sqrt{2}}.\n$$\n因为 $\\sigma_{2} \\leq \\tau$，我们设 $w_{2} = 0$。因此\n$$\nw = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}.\n$$\n\n步骤 3：计算 $x_{\\text{reg}} = V w$。已知\n$$\nV = \\frac{1}{\\sqrt{10}}\\begin{pmatrix} 1 & -3 \\\\ 3 & 1 \\end{pmatrix},\n$$\n我们得到\n$$\nx_{\\text{reg}} = \\frac{1}{\\sqrt{10}}\\begin{pmatrix} 1 & -3 \\\\ 3 & 1 \\end{pmatrix}\\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}\n= \\frac{1}{\\sqrt{10}}\\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\frac{3}{\\sqrt{2}} \\end{pmatrix}\n= \\begin{pmatrix} \\frac{1}{\\sqrt{20}} \\\\ \\frac{3}{\\sqrt{20}} \\end{pmatrix}.\n$$\n数值上，使用 $\\sqrt{20} = 2\\sqrt{5}$，这得到\n$$\nx_{\\text{reg}} \\approx \\begin{pmatrix} 0.2236067978 \\\\ 0.6708203933 \\end{pmatrix}.\n$$\n将每个元素四舍五入到三位有效数字，得到\n$$\nx_{\\text{reg}} \\approx \\begin{pmatrix} 0.224 \\\\ 0.671 \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.224 \\\\ 0.671\\end{pmatrix}}$$", "id": "2203817"}]}