{"hands_on_practices": [{"introduction": "我们从一个简单的几何例子开始，以建立对病态问题直观的理解。本练习将探讨当数据矩阵的列向量（代表两个向量）变得几乎平行时，正规方程矩阵的条件数会如何变化。通过计算条件数作为向量间夹角 $\\theta$ 的函数，我们可以直接揭示几何上的共线性与数值不稳定性之间的联系 [@problem_id:2162074]。", "problem": "在数值线性代数中，矩阵的条件数是衡量其对输入数据误差敏感性的一个关键指标。对于一个线性最小二乘问题 $A\\mathbf{x} \\approx \\mathbf{b}$，其敏感性由正规方程矩阵 $A^TA$ 的条件数决定。当矩阵 $A$ 的列向量近似线性相关时，通常会出现病态条件。\n\n考虑一个简单的 $2 \\times 2$ 矩阵 $A$，其列向量代表了平面中的两个基向量。第一列是向量 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，第二列是向量 $\\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}$，其中 $\\theta$（以弧度为单位）是两个向量之间的夹角。假设 $\\theta$ 是一个小的正角。因此，矩阵 $A$ 表示为 $A = \\begin{pmatrix} 1 & \\cos\\theta \\\\ 0 & \\sin\\theta \\end{pmatrix}$。\n\n求在 $\\theta \\to 0^+$ 的极限情况下，相关正规方程矩阵 $A^TA$ 的 2-范数条件数的主阶渐近表达式。您的答案应该是一个关于 $\\theta$ 的简单表达式，能够捕捉其在小角度下的主导行为。", "solution": "我们被要求求出对于 $A=\\begin{pmatrix} 1 & \\cos\\theta \\\\ 0 & \\sin\\theta \\end{pmatrix}$，在 $\\theta \\to 0^{+}$ 的极限情况下，正规方程矩阵 $A^{T}A$ 的 2-范数条件数。对于一个对称正定矩阵 $M$，其 2-范数条件数为 $\\kappa_{2}(M)=\\frac{\\lambda_{\\max}(M)}{\\lambda_{\\min}(M)}$，其中 $\\lambda_{\\max}$ 和 $\\lambda_{\\min}$ 分别是 $M$ 的最大和最小特征值。\n\n计算 $A^{T}A$：\n$$\nA^{T}=\\begin{pmatrix} 1 & 0 \\\\ \\cos\\theta & \\sin\\theta \\end{pmatrix}, \\quad\nA^{T}A=\\begin{pmatrix} 1 & \\cos\\theta \\\\ \\cos\\theta & 1 \\end{pmatrix}.\n$$\n矩阵 $\\begin{pmatrix} 1 & \\cos\\theta \\\\ \\cos\\theta & 1 \\end{pmatrix}$ 的特征值为\n$$\n\\lambda_{\\pm}=1 \\pm \\cos\\theta.\n$$\n因此，\n$$\n\\kappa_{2}(A^{T}A)=\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}=\\frac{1+\\cos\\theta}{1-\\cos\\theta}.\n$$\n对于小的 $\\theta$，使用泰勒展开 $\\cos\\theta=1-\\frac{\\theta^{2}}{2}+O(\\theta^{4})$。因此\n$$\n1-\\cos\\theta=\\frac{\\theta^{2}}{2}+O(\\theta^{4}), \\quad 1+\\cos\\theta=2-\\frac{\\theta^{2}}{2}+O(\\theta^{4}).\n$$\n于是\n$$\n\\kappa_{2}(A^{T}A)=\\frac{2-\\frac{\\theta^{2}}{2}+O(\\theta^{4})}{\\frac{\\theta^{2}}{2}+O(\\theta^{4})}\n=\\frac{4}{\\theta^{2}}+O(1),\n$$\n所以当 $\\theta \\to 0^{+}$ 时，主阶渐近行为是\n$$\n\\kappa_{2}(A^{T}A)\\sim \\frac{4}{\\theta^{2}}.\n$$", "answer": "$$\\boxed{\\frac{4}{\\theta^{2}}}$$", "id": "2162074"}, {"introduction": "在几何直观的基础上，我们现在来考虑一个在数据拟合中常见的情景：使用两个彼此非常接近的数据点。这个实践问题展示了在几乎相同的位置上采集数据如何导致正规方程矩阵的病态，这种情况与近乎平行的列向量是相似的。通过分析当数据点之间的距离 $\\epsilon$ 趋近于零时条件数的变化，可以加深我们对数据采样与最小二乘解稳定性之间关系的理解 [@problem_id:2162115]。", "problem": "考虑一个线性最小二乘问题，用以将模型 $y(x) = c_1 + c_2 x$ 拟合到两个数据点。这些数据点的 x 坐标为 $x_1 = 1$ 和 $x_2 = 1 + \\epsilon$，其中 $\\epsilon$ 是一个小的正实数。该问题的设计矩阵 $A$ 的元素为 $A_{ij} = x_i^{j-1}$，其中 $i,j \\in \\{1,2\\}$。求解相关正规方程 $A^T A \\mathbf{c} = A^T \\mathbf{y}$ 的稳定性与矩阵 $B(\\epsilon) = A^T A(\\epsilon)$ 的条件数有关。\n\n对称正定矩阵 $B(\\epsilon)$ 的 2-范数条件数定义为其最大特征值与最小特征值之比，即 $\\kappa_2(B(\\epsilon)) = \\frac{\\lambda_{\\max}(B(\\epsilon))}{\\lambda_{\\min}(B(\\epsilon))}$。对于小的 $\\epsilon$，该条件数可以由以下形式的渐近公式近似：\n$$ \\kappa_2(B(\\epsilon)) \\approx \\frac{C}{\\epsilon^n} $$\n其中 $C$ 是一个正常数，$n$ 是一个正整数。\n\n确定常数 $C$ 和整数 $n$ 的值。将答案表示为一个 1x2 的行矩阵，其元素依次为 $C$ 和 $n$。", "solution": "我们为 $x_{1}=1$ 和 $x_{2}=1+\\epsilon$ 这两个点构建范德蒙型的设计矩阵：\n$$\nA=\\begin{pmatrix}\n1 & x_{1} \\\\\n1 & x_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & 1 \\\\\n1 & 1+\\epsilon\n\\end{pmatrix}.\n$$\n正规矩阵为 $B(\\epsilon)=A^{T}A$，对于 $\\epsilon>0$ 它是对称正定的（因为当 $x_{1}\\neq x_{2}$ 时，$A$ 的两行是线性无关的）。显式地计算 $B(\\epsilon)$：\n$$\nB(\\epsilon)=A^{T}A=\n\\begin{pmatrix}\n\\sum_{i=1}^{2}1^{2} & \\sum_{i=1}^{2}1\\cdot x_{i} \\\\\n\\sum_{i=1}^{2}x_{i}\\cdot 1 & \\sum_{i=1}^{2}x_{i}^{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2 & 2+\\epsilon \\\\\n2+\\epsilon & 2+2\\epsilon+\\epsilon^{2}\n\\end{pmatrix}.\n$$\n对于一个 $2\\times 2$ 的对称矩阵 $\\begin{pmatrix}a & b \\\\ b & c\\end{pmatrix}$，其特征值满足 $\\lambda_{\\max}+\\lambda_{\\min}=\\operatorname{tr}=a+c$ 和 $\\lambda_{\\max}\\lambda_{\\min}=\\det=ac-b^{2}$。此处，\n$$\na=2,\\quad b=2+\\epsilon,\\quad c=2+2\\epsilon+\\epsilon^{2}.\n$$\n因此，行列式为\n$$\n\\det B(\\epsilon)=ac-b^{2}=2(2+2\\epsilon+\\epsilon^{2})-(2+\\epsilon)^{2}=(4+4\\epsilon+2\\epsilon^{2})-(4+4\\epsilon+\\epsilon^{2})=\\epsilon^{2}.\n$$\n在 $\\epsilon=0$ 时，我们有\n$$\nB(0)=\\begin{pmatrix}2 & 2 \\\\ 2 & 2\\end{pmatrix},\n$$\n其特征值为 $4$ 和 $0$。因此，对于小的 $\\epsilon>0$，根据连续性，\n$$\n\\lambda_{\\max}(B(\\epsilon))=4+O(\\epsilon).\n$$\n使用恒等式 $\\lambda_{\\min}=\\det/\\lambda_{\\max}$，\n$$\n\\lambda_{\\min}(B(\\epsilon))=\\frac{\\det B(\\epsilon)}{\\lambda_{\\max}(B(\\epsilon))}=\\frac{\\epsilon^{2}}{4+O(\\epsilon)}=\\frac{1}{4}\\epsilon^{2}+O(\\epsilon^{3}).\n$$\n因此，2-范数条件数为\n$$\n\\kappa_{2}(B(\\epsilon))=\\frac{\\lambda_{\\max}(B(\\epsilon))}{\\lambda_{\\min}(B(\\epsilon))}=\\frac{4+O(\\epsilon)}{\\frac{1}{4}\\epsilon^{2}+O(\\epsilon^{3})}=\\frac{16}{\\epsilon^{2}}+O\\!\\left(\\frac{1}{\\epsilon}\\right).\n$$\n因此，渐近形式 $\\kappa_{2}(B(\\epsilon))\\approx \\frac{C}{\\epsilon^{n}}$ 中的参数为\n$$\nC=16,\\quad n=2.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}16 & 2\\end{pmatrix}}$$", "id": "2162115"}, {"introduction": "最后，我们将探讨一个源于数据科学和工程领域的实际问题：特征缩放的影响。本练习揭示了即使特征之间的相关性不强，仅仅改变一个特征相对于另一个特征的尺度，也可能急剧增大正规方程矩阵的条件数。理解这一现象对于数据预处理至关重要，以确保在回归分析中获得稳定可靠的数值解 [@problem_id:2162068]。", "problem": "在线性最小二乘问题中，需要对正规方程矩阵 $A^T A$ 进行求逆。此求逆过程的数值稳定性与 $A^T A$ 的条件数有关。考虑一个由两个列向量组成的数据矩阵 $A = [v_1, v_2]$，其中 $v_1, v_2 \\in \\mathbb{R}^m$，$m$ 为某个大整数。这些列代表了在一次实验中测量到的两个不同特征。这些向量经过归一化，其欧几里德范数为1，即 $v_1^T v_1 = 1$ 且 $v_2^T v_2 = 1$。特征之间是相关的，其列向量的内积为 $v_1^T v_2 = c$。\n\n假设我们用一个大的因子 $\\alpha > 0$ 对第二个特征进行重新缩放，得到一个新的数据矩阵 $A_\\alpha = [v_1, \\alpha v_2]$。这是数据预处理中的一个常见操作，例如，在改变测量单位时。这种缩放会显著影响相应的正规方程矩阵 $B_\\alpha = A_\\alpha^T A_\\alpha$ 的条件。\n\n对于一个对称正定矩阵，其2-范数条件数定义为其最大特征值与最小特征值之比。当 $\\alpha$ 取较大值时，可以发现 $B_\\alpha$ 的2-范数条件数（记为 $\\kappa_2(B_\\alpha)$）随 $\\alpha$ 呈二次方增长。即，对于某个常数 $K$，有 $\\kappa_2(B_\\alpha) \\approx K \\alpha^2$。\n\n已知相关常数 $c = 1/3$，求比例常数 $K$ 的精确值。", "solution": "我们给定 $A_{\\alpha} = [v_{1}, \\alpha v_{2}]$，其中 $v_{1}^{T} v_{1} = 1$，$v_{2}^{T} v_{2} = 1$，$v_{1}^{T} v_{2} = c$。正规方程矩阵是格拉姆矩阵\n$$\nB_{\\alpha} = A_{\\alpha}^{T} A_{\\alpha} = \\begin{pmatrix} 1 & \\alpha c \\\\ \\alpha c & \\alpha^{2} \\end{pmatrix}.\n$$\n对于对称正定矩阵，其2-范数条件数是最大特征值与最小特征值之比。一个 $2 \\times 2$ 对称矩阵的特征值可以用其迹和行列式来表示。这里\n$$\n\\operatorname{tr}(B_{\\alpha}) = 1 + \\alpha^{2}, \\qquad \\det(B_{\\alpha}) = \\alpha^{2}(1 - c^{2}).\n$$\n因此，特征值为\n$$\n\\lambda_{\\pm} = \\frac{1 + \\alpha^{2} \\pm \\sqrt{(1 + \\alpha^{2})^{2} - 4 \\alpha^{2}(1 - c^{2})}}{2}\n= \\frac{1 + \\alpha^{2} \\pm \\sqrt{(\\alpha^{2} - 1)^{2} + 4 \\alpha^{2} c^{2}}}{2}.\n$$\n所以条件数为\n$$\n\\kappa_{2}(B_{\\alpha}) = \\frac{\\lambda_{+}}{\\lambda_{-}} = \\frac{1 + \\alpha^{2} + \\sqrt{(\\alpha^{2} - 1)^{2} + 4 \\alpha^{2} c^{2}}}{1 + \\alpha^{2} - \\sqrt{(\\alpha^{2} - 1)^{2} + 4 \\alpha^{2} c^{2}}}.\n$$\n\n为提取当 $\\alpha$ 较大时的主导项，将平方根内的 $\\alpha^{2}$ 因子提出。设\n$$\nS_{\\alpha} = \\sqrt{(\\alpha^{2} - 1)^{2} + 4 \\alpha^{2} c^{2}} = \\sqrt{\\alpha^{4} + \\alpha^{2}(-2 + 4 c^{2}) + 1}\n= \\alpha^{2} \\sqrt{1 + \\frac{-2 + 4 c^{2}}{\\alpha^{2}} + \\frac{1}{\\alpha^{4}}}.\n$$\n使用展开式 $\\sqrt{1 + x} = 1 + \\frac{1}{2} x + O(x^{2})$，其中 $x = \\frac{-2 + 4 c^{2}}{\\alpha^{2}} + \\frac{1}{\\alpha^{4}}$，得到\n$$\nS_{\\alpha} = \\alpha^{2} \\left(1 + \\frac{-2 + 4 c^{2}}{2 \\alpha^{2}} + O\\left(\\frac{1}{\\alpha^{4}}\\right)\\right)\n= \\alpha^{2} + \\frac{-2 + 4 c^{2}}{2} + O\\left(\\frac{1}{\\alpha^{2}}\\right).\n$$\n则\n$$\n1 + \\alpha^{2} + S_{\\alpha} = 2 \\alpha^{2} + \\frac{-2 + 4 c^{2}}{2} + 1 + O\\left(\\frac{1}{\\alpha^{2}}\\right),\n$$\n$$\n1 + \\alpha^{2} - S_{\\alpha} = 1 - \\frac{-2 + 4 c^{2}}{2} + O\\left(\\frac{1}{\\alpha^{2}}\\right) = 2 - 2 c^{2} + O\\left(\\frac{1}{\\alpha^{2}}\\right).\n$$\n因此\n$$\n\\kappa_{2}(B_{\\alpha}) = \\frac{2 \\alpha^{2} + O(1)}{2 - 2 c^{2} + O\\left(\\frac{1}{\\alpha^{2}}\\right)}\n= \\frac{\\alpha^{2}}{1 - c^{2}} + O(1) \\quad \\text{当 } \\alpha \\to \\infty.\n$$\n因此，比例常数为\n$$\nK = \\frac{1}{1 - c^{2}}.\n$$\n代入 $c = \\frac{1}{3}$，我们得到\n$$\nK = \\frac{1}{1 - \\left(\\frac{1}{3}\\right)^{2}} = \\frac{1}{1 - \\frac{1}{9}} = \\frac{1}{\\frac{8}{9}} = \\frac{9}{8}.\n$$", "answer": "$$\\boxed{\\frac{9}{8}}$$", "id": "2162068"}]}