{"hands_on_practices": [{"introduction": "让我们从最基本的数据拟合问题开始：如何用一个常数值来最佳地代表一组测量数据？这个练习将引导你应用最小二乘法原理，来寻找一条最能拟合数据点的水平线 $y=c$。通过这个过程，你将发现一个深刻的联系：最小二乘估计在这个最简单的情况下，恰好就是我们所熟悉的算术平均值。[@problem_id:2218976]", "problem": "进行了一项实验来确定一个恒定的物理参数。由于随机实验误差，多次测量得出了略有不同的值。收集到的数据包含三对测量值 $(x_i, y_i)$，其中 $x_i$ 代表一个自变量（例如时间），而 $y_i$ 是该参数的测量值。观测到的数据点为 $(1, 3)$，$(2, 5)$ 和 $(3, 4)$。\n\n假设该参数的真实值为一个常数，我们希望找到这个常数的最佳估计值。这可以通过将数据拟合到一条形式为 $y = c$ 的水平线来实现。\n\n使用最小二乘法原理，确定常数 $c$ 的值，使得它能为给定的数据点提供最佳拟合。将您的答案表示为一个精确的数。", "solution": "我们用一个常数 $c$ 来为测量值建模，使得每个观测值 $y_{i}$ 都由 $c$ 来近似。根据最小二乘法原理，我们选择 $c$ 以最小化残差平方和\n$$\nS(c)=\\sum_{i=1}^{3}\\left(y_{i}-c\\right)^{2}.\n$$\n对 $c$ 求导并将导数设为零：\n$$\n\\frac{dS}{dc}=\\sum_{i=1}^{3}2\\left(y_{i}-c\\right)(-1) = 2\\left(3c-\\sum_{i=1}^{3}y_{i}\\right)=0.\n$$\n这得出了正规方程\n$$\n3c=\\sum_{i=1}^{3}y_{i}\\quad\\Longrightarrow\\quad c=\\frac{1}{3}\\sum_{i=1}^{3}y_{i}.\n$$\n代入数据 $y_{1}=3$，$y_{2}=5$，$y_{3}=4$ 可得\n$$\nc=\\frac{1}{3}(3+5+4)=\\frac{12}{3}=4.\n$$\n为了验证这是一个最小值，注意到\n$$\n\\frac{d^{2}S}{dc^{2}}=\\sum_{i=1}^{3}2=6>0,\n$$\n因此 $c=4$ 使 $S(c)$ 最小化，并且是最小二乘估计值（即 $y_{i}$ 值的样本均值）。", "answer": "$$\\boxed{4}$$", "id": "2218976"}, {"introduction": "在许多科学和工程应用中，两个变量之间存在正比关系，可以用通过原点的直线 $y=mx$ 来建模。这个练习将指导你如何使用最小二乘法来确定最佳的斜率 $m$，从而找到最能拟合给定数据点的直线。这个实践是理解更复杂回归模型的基础，并展示了如何通过最小化误差来推导模型参数。[@problem_id:2219020]", "problem": "在许多物理系统中，预期两个量之间存在正比关系，这可以用形如 $y = mx$ 的方程来建模。考虑一个实验，它产生了一组包含 $N$ 个数据点 $(x_1, y_1), (x_2, y_2), \\dots, (x_N, y_N)$ 的数据集。我们希望为这个数据集找到一条通过原点的“最佳拟合”直线。\n\n根据最小二乘法原理，最佳拟合是指能够使观测数据点与模型直线之间的垂直距离平方和最小化的拟合。设这个误差平方和用 $S$ 表示。\n\n确定能够使 $S$ 最小化的斜率 $m$ 的解析表达式。你的答案应该用给定的数据坐标 $x_i$ 和 $y_i$ 来表示。", "solution": "我们假设模型为 $y=m x$（一条被约束通过原点的直线）。对于数据 $\\{(x_{i},y_{i})\\}_{i=1}^{N}$，作为 $m$ 的函数的最小二乘目标（垂直残差平方和）是\n$$\nS(m)=\\sum_{i=1}^{N}\\left(y_{i}-m x_{i}\\right)^{2}.\n$$\n为了找到最小化斜率，我们将 $S(m)$ 对 $m$ 求导，并将导数设为零（一阶最优性条件）：\n$$\n\\frac{dS}{dm}=\\sum_{i=1}^{N}2\\left(y_{i}-m x_{i}\\right)\\left(-x_{i}\\right)=-2\\sum_{i=1}^{N}x_{i}y_{i}+2m\\sum_{i=1}^{N}x_{i}^{2}.\n$$\n令 $\\frac{dS}{dm}=0$：\n$$\n-2\\sum_{i=1}^{N}x_{i}y_{i}+2m\\sum_{i=1}^{N}x_{i}^{2}=0.\n$$\n解出 $m$：\n$$\nm\\sum_{i=1}^{N}x_{i}^{2}=\\sum_{i=1}^{N}x_{i}y_{i}\\quad\\Rightarrow\\quad m=\\frac{\\sum_{i=1}^{N}x_{i}y_{i}}{\\sum_{i=1}^{N}x_{i}^{2}}.\n$$\n为了确认这是一个最小值，我们计算二阶导数：\n$$\n\\frac{d^{2}S}{dm^{2}}=2\\sum_{i=1}^{N}x_{i}^{2}\\ge 0,\n$$\n只要至少有一个 $x_{i}\\neq 0$，该二阶导数就严格为正，从而确保了存在唯一的最小值点。如果 $\\sum_{i=1}^{N}x_{i}^{2}=0$（即所有 $x_{i}=0$），那么 $S(m)=\\sum_{i=1}^{N}y_{i}^{2}$ 与 $m$ 无关，因此斜率是不可辨识的。否则，使误差平方和最小的斜率就是上面的表达式。", "answer": "$$\\boxed{\\frac{\\sum_{i=1}^{N} x_{i} y_{i}}{\\sum_{i=1}^{N} x_{i}^{2}}}$$", "id": "2219020"}, {"introduction": "这个实践将简单回归问题推广到了线性最小二乘问题的一般形式。你将学习如何使用核心的“正规方程” ($A^T A \\hat{\\mathbf{x}} = A^T \\mathbf{b}$) 来求解一个通常没有精确解的超定系统 $A\\mathbf{x} = \\mathbf{b}$。通过解决这个问题，你不仅能掌握一种强大的计算方法，还能深入理解当数据能够被模型完美拟合时，最小二乘解与精确解之间的关系。[@problem_id:2218998]", "problem": "在许多数据分析应用中，我们会遇到形如 $A\\mathbf{x} = \\mathbf{b}$ 的超定线性系统，其中矩阵 $A$ 的行数多于列数。这类系统通常没有精确解。最小二乘法原理提供了一种寻找近似解 $\\hat{\\mathbf{x}}$ 的方法，其通过最小化残差向量 $r = A\\mathbf{x} - \\mathbf{b}$ 的欧几里得范数的平方来实现。\n\n考虑一个具体的超定系统 $A\\mathbf{x} = \\mathbf{b}$，其中矩阵 $A$ 和向量 $\\mathbf{b}$ 如下所示：\n$$\nA = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 2 \\\\ 3 \\\\ 5 \\end{pmatrix}\n$$\n求该系统的最小二乘解向量 $\\hat{\\mathbf{x}} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$。你的答案应为向量 $\\hat{\\mathbf{x}}$。", "solution": "我们寻求最小二乘解 $\\hat{\\mathbf{x}}$，它使得 $\\|A\\mathbf{x}-\\mathbf{b}\\|^{2}$ 最小化。其最小值点的一个必要条件由以下正规方程组给出：\n$$\nA^{\\top}A\\,\\hat{\\mathbf{x}}=A^{\\top}\\mathbf{b}.\n$$\n已知\n$$\nA=\\begin{pmatrix}1&0\\\\0&1\\\\1&1\\end{pmatrix},\\quad \\mathbf{b}=\\begin{pmatrix}2\\\\3\\\\5\\end{pmatrix},\n$$\n计算\n$$\nA^{\\top}=\\begin{pmatrix}1&0&1\\\\0&1&1\\end{pmatrix},\n$$\n可得\n$$\nA^{\\top}A=\\begin{pmatrix}1&0&1\\\\0&1&1\\end{pmatrix}\\begin{pmatrix}1&0\\\\0&1\\\\1&1\\end{pmatrix}\n=\\begin{pmatrix}2&1\\\\1&2\\end{pmatrix},\n$$\n以及\n$$\nA^{\\top}\\mathbf{b}=\\begin{pmatrix}1&0&1\\\\0&1&1\\end{pmatrix}\\begin{pmatrix}2\\\\3\\\\5\\end{pmatrix}\n=\\begin{pmatrix}7\\\\8\\end{pmatrix}.\n$$\n因此 $\\hat{\\mathbf{x}}$ 满足\n$$\n\\begin{pmatrix}2&1\\\\1&2\\end{pmatrix}\\begin{pmatrix}x_{1}\\\\x_{2}\\end{pmatrix}=\\begin{pmatrix}7\\\\8\\end{pmatrix}.\n$$\n求解该方程组，\n$$\n\\begin{cases}\n2x_{1}+x_{2}=7,\\\\\nx_{1}+2x_{2}=8,\n\\end{cases}\n\\quad\\Rightarrow\\quad x_{2}=7-2x_{1},\n$$\n代入第二个方程：\n$$\nx_{1}+2(7-2x_{1})=8\\;\\Rightarrow\\;-3x_{1}=-6\\;\\Rightarrow\\;x_{1}=2,\n$$\n然后\n$$\nx_{2}=7-2\\cdot 2=3.\n$$\n所以，\n$$\n\\hat{\\mathbf{x}}=\\begin{pmatrix}2\\\\3\\end{pmatrix}.\n$$\n值得注意的是，$A\\hat{\\mathbf{x}}=\\begin{pmatrix}2\\\\3\\\\5\\end{pmatrix}=\\mathbf{b}$，因此残差为零，该系统是相容的。", "answer": "$$\\boxed{\\begin{pmatrix}2\\\\3\\end{pmatrix}}$$", "id": "2218998"}]}