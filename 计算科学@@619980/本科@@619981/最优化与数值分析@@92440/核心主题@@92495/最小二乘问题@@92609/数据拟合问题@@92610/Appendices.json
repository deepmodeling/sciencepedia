{"hands_on_practices": [{"introduction": "我们从一个基本但至关重要的数据拟合任务开始：将三维空间中的一组点拟合到一个平面。这个练习是简单线性回归的直接扩展，将最小二乘法的核心思想应用到多维情境中。通过解决这个问题，你将掌握使用矩阵代数构建和求解正规方程的技能，这是解决更复杂拟合问题的基石。[@problem_id:2212243]", "problem": "一位质量控制工程师正在检查一块新制造的矩形板，该板应为完全平坦的。为了评估其平坦度，工程师使用三坐标测量机记录板表面上几个点的高度 $z$，这些点对应于坐标 $(x, y)$。工程师为板表面建立的模型是一个由方程 $z = ax + by + c$ 定义的平面，其中 $a$ 和 $b$ 分别表示在 $x$ 和 $y$ 方向上的倾斜度，而 $c$ 是原点 $(0, 0)$ 处的高度。\n\n采集了以下四个测量值，所有坐标均以无量纲单位给出：\n- 点 1：$(x_1, y_1, z_1) = (0, 0, 1)$\n- 点 2：$(x_2, y_2, z_2) = (1, 0, 3)$\n- 点 3：$(x_3, y_3, z_3) = (0, 2, 2)$\n- 点 4：$(x_4, y_4, z_4) = (1, 2, 5)$\n\n假设“最佳拟合”平面是使测量点与该平面之间的垂直距离平方和最小的平面，请确定参数 $a$、$b$ 和 $c$ 的最优值。\n\n请将参数 $(a, b, c)$ 的最终答案以行矩阵的形式表示。", "solution": "我们将表面建模为 $z=ax+by+c$，并通过最小化残差平方和 $S(a,b,c)=\\sum_{i=1}^{4}\\left(ax_{i}+by_{i}+c-z_{i}\\right)^{2}$ 来寻求 $(a,b,c)$ 的最小二乘估计。将 $S$ 相对于 $(a,b,c)$ 的梯度设为零，得到正规方程组\n$$\nX^{T}X\\,\\theta=X^{T}z,\n$$\n其中 $X$ 的行是 $[x_{i}\\;y_{i}\\;1]$，$z$ 是测量高度的向量，且 $\\theta=\\begin{pmatrix}a\\\\ b\\\\ c\\end{pmatrix}$。根据数据，\n$$\nX=\\begin{pmatrix}\n0 & 0 & 1\\\\\n1 & 0 & 1\\\\\n0 & 2 & 1\\\\\n1 & 2 & 1\n\\end{pmatrix},\\quad\nz=\\begin{pmatrix}\n1\\\\\n3\\\\\n2\\\\\n5\n\\end{pmatrix}.\n$$\n计算\n$$\nX^{T}X=\\begin{pmatrix}\n\\sum x_{i}^{2} & \\sum x_{i}y_{i} & \\sum x_{i}\\\\\n\\sum x_{i}y_{i} & \\sum y_{i}^{2} & \\sum y_{i}\\\\\n\\sum x_{i} & \\sum y_{i} & 4\n\\end{pmatrix}\n=\\begin{pmatrix}\n2 & 2 & 2\\\\\n2 & 8 & 4\\\\\n2 & 4 & 4\n\\end{pmatrix},\n$$\n和\n$$\nX^{T}z=\\begin{pmatrix}\n\\sum x_{i}z_{i}\\\\\n\\sum y_{i}z_{i}\\\\\n\\sum z_{i}\n\\end{pmatrix}\n=\\begin{pmatrix}\n8\\\\\n14\\\\\n11\n\\end{pmatrix}.\n$$\n因此我们求解\n$$\n\\begin{pmatrix}\n2 & 2 & 2\\\\\n2 & 8 & 4\\\\\n2 & 4 & 4\n\\end{pmatrix}\n\\begin{pmatrix}\na\\\\\nb\\\\\nc\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n8\\\\\n14\\\\\n11\n\\end{pmatrix}.\n$$\n将每个方程都除以 $2$ 得到\n$$\n\\begin{cases}\na+b+c=4,\\\\\na+4b+2c=7,\\\\\na+2b+2c=\\frac{11}{2}.\n\\end{cases}\n$$\n将第二个方程减去第一个方程得到 $3b+c=3$，将第三个方程减去第一个方程得到 $b+c=\\frac{3}{2}$。将这两个方程相减得到 $2b=\\frac{3}{2}$，因此 $b=\\frac{3}{4}$。代入 $b+c=\\frac{3}{2}$ 得到 $c=\\frac{3}{4}$。最后，从 $a+b+c=4$ 我们得到 $a=4-\\frac{3}{4}-\\frac{3}{4}=\\frac{5}{2}$。因此，最小二乘最佳拟合参数为 $(a,b,c)=\\left(\\frac{5}{2},\\frac{3}{4},\\frac{3}{4}\\right)$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{5}{2} & \\frac{3}{4} & \\frac{3}{4}\\end{pmatrix}}$$", "id": "2212243"}, {"introduction": "标准的最小二乘法假设自变量（$x$ 轴）没有误差，这在许多现实情况下并不成立。这个练习引入了一种称为“总体最小二乘法”（Total Least Squares）的强大替代方法，它旨在最小化数据点到拟合直线的垂直距离。通过处理同时存在于两个变量中的误差，这个实践突显了根据数据的误差结构选择合适的目标函数的重要性，从而获得更准确、更真实的模型。[@problem_id:2212231]", "problem": "一位物理专业的本科生正在研究一个几乎无摩擦的直线上小珠的运动。一个理论模型预测，小珠的位置 $p$ 与实验控制参数时间 $t$ 之间存在线性关系，由方程 $p = mt + c$ 给出。为了检验这个理论并确定常数 $m$ 和 $c$，该学生收集了一系列数据点。然而，由于测量设备固有的局限性，位置读数和时间测量都存在随机实验误差。\n\n该学生决定采用一种考虑了两个变量误差的方法来找到“最佳拟合”直线。这种方法将最佳拟合直线定义为使每个数据点到直线的平方*垂直*距离之和最小化的那条直线。\n\n收集的实验数据包含四对 $(t, p)$：\n(2 s, 3 m), (4 s, 8 m), (7 s, 10 m), (9 s, 15 m)。\n\n使用这些数据，计算通过最小化平方垂直距离之和定义的最佳拟合直线的斜率 $m$ 和截距 $c$。你的答案中斜率的单位应为 m/s，截距的单位应为 m。将最终答案四舍五入到四位有效数字。", "solution": "我们用直线 $p = m t + c$ 对数据进行建模，并将要最小化的平方垂直距离之和定义为\n$$\nF(m,c) = \\sum_{i=1}^{n} \\frac{(m t_{i} - p_{i} + c)^{2}}{m^{2} + 1}.\n$$\n令 $\\partial F/\\partial c=0$ 可得\n$$\n\\frac{2}{m^{2}+1}\\sum_{i=1}^{n}\\left(m t_{i} - p_{i} + c\\right)=0 \\quad\\Longrightarrow\\quad c=\\bar{p}-m\\bar{t},\n$$\n其中 $\\bar{t}$ 和 $\\bar{p}$ 是样本均值。定义中心化变量 $t_{i}'=t_{i}-\\bar{t}$ 和 $p_{i}'=p_{i}-\\bar{p}$。代入 $c=\\bar{p}-m\\bar{t}$ 可得\n$$\nF(m)=\\frac{1}{m^{2}+1}\\sum_{i=1}^{n}\\left(m t_{i}' - p_{i}'\\right)^{2}\n=\\frac{m^{2} S_{tt} - 2 m S_{tp} + S_{pp}}{m^{2}+1},\n$$\n其中 $S_{tt}=\\sum (t_{i}')^{2}$，$S_{pp}=\\sum (p_{i}')^{2}$，以及 $S_{tp}=\\sum t_{i}'p_{i}'$。对 $m$ 求导并令其为零，得到总体最小二乘条件\n$$\nS_{tp} m^{2} + (S_{tt} - S_{pp}) m - S_{tp} = 0,\n$$\n等价地\n$$\nS_{tp}(m^{2}-1) + (S_{tt}-S_{pp}) m = 0.\n$$\n解这个二次方程，\n$$\nm=\\frac{S_{pp}-S_{tt} \\pm \\sqrt{(S_{pp}-S_{tt})^{2}+4 S_{tp}^{2}}}{2 S_{tp}}.\n$$\n我们计算数据 $(t,p)\\in\\{(2,3),(4,8),(7,10),(9,15)\\}$ 的样本均值和总和。当 $n=4$ 时，\n$$\n\\bar{t}=\\frac{2+4+7+9}{4}=\\frac{22}{4}=5.5,\\qquad \\bar{p}=\\frac{3+8+10+15}{4}=\\frac{36}{4}=9.\n$$\n中心化值为 $(t',p')\\in\\{(-3.5,-6),(-1.5,-1),(1.5,1),(3.5,6)\\}$，得到\n$$\nS_{tt}=(-3.5)^{2}+(-1.5)^{2}+(1.5)^{2}+(3.5)^{2}=29,\n$$\n$$\nS_{pp}=(-6)^{2}+(-1)^{2}+(1)^{2}+(6)^{2}=74,\n$$\n$$\nS_{tp}=(-3.5)(-6)+(-1.5)(-1)+(1.5)(1)+(3.5)(6)=45.\n$$\n因此\n$$\nm=\\frac{74-29 \\pm \\sqrt{(74-29)^{2}+4\\cdot 45^{2}}}{2\\cdot 45}\n=\\frac{45 \\pm 45\\sqrt{5}}{90}=\\frac{1\\pm \\sqrt{5}}{2}.\n$$\n数据显示正相关，因此我们取正根，\n$$\nm=\\frac{1+\\sqrt{5}}{2}.\n$$\n截距由 $c=\\bar{p}-m\\bar{t}$ 得出：\n$$\nc=9-\\left(\\frac{1+\\sqrt{5}}{2}\\right)\\cdot 5.5\n=9-\\frac{11(1+\\sqrt{5})}{4}\n=\\frac{25-11\\sqrt{5}}{4}.\n$$\n数值上，保留四位有效数字，\n$$\nm\\approx 1.618,\\qquad c\\approx 0.1008.\n$$\n这分别对应于 $m$ 的单位 m/s 和 $c$ 的单位 m，符合要求。", "answer": "$$\\boxed{\\begin{pmatrix}1.618 & 0.1008\\end{pmatrix}}$$", "id": "2212231"}, {"introduction": "成功拟合模型只是数据分析过程的一半，验证模型的假设同样重要。此练习将引导你进行模型诊断的关键步骤：残差分析。我们将学习如何通过检验残差的方差来评估一个基本假设——同方差性（即误差方差恒定）。这个问题提供了一种定量的方法来检测异方差性，这是线性回归中常见的问题，从而让你能够更批判性地评估你的拟合结果。[@problem_id:2212247]", "problem": "一位化学工程师正在研究操作压力与一种特种聚合物最终产率之间的关系。进行了八次实验运行，得到以下压力（$P$，单位：巴）和产率（$Y$，单位：千克）的数据对：\n\n(100, 40.5), (120, 45.0), (140, 53.0), (160, 52.0), (180, 65.5), (200, 68.0), (220, 81.0), (240, 79.0)\n\n一位分析师对这些数据进行了简单线性回归，并提出了模型 $\\hat{Y} = 0.27P + 13.0$，其中 $\\hat{Y}$ 是预测产率。\n\n为了检验模型关于恒定误差方差（同方差性）假设的有效性，进行了一项诊断检验。首先，根据数据点的拟合值 $\\hat{Y}_i$ 进行排序。然后，将数据分成大小相等的两组：第1组，包含拟合值最低的四个数据点；第2组，包含拟合值最高的四个数据点。\n\n计算每组残差的样本方差，其中残差定义为 $e_i = Y_i - \\hat{Y}_i$。设第1组的样本方差为 $s_1^2$，第2组的样本方差为 $s_2^2$。对于一组包含 $n$ 个残差 $e_i$ 且均值为 $\\bar{e}$ 的数据，其样本方差由公式 $s^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (e_i - \\bar{e})^2$ 给出。\n\n计算比率 $F = \\frac{s_2^2}{s_1^2}$。这个比率常用于检测异方差性，当其值显著不等于1时，表明误差方差不是恒定的。将您的最终答案四舍五入到三位有效数字。", "solution": "拟合模型为 $\\hat{Y} = 0.27P + 13.0$。对于每个数据对 $(P, Y)$，计算拟合值 $\\hat{Y}$ 和残差 $e = Y - \\hat{Y}$：\n- 对于 $P=100$：$\\hat{Y}=0.27\\cdot 100+13=40.0$，所以 $e=40.5-40.0=0.5$。\n- 对于 $P=120$：$\\hat{Y}=0.27\\cdot 120+13=45.4$，所以 $e=45.0-45.4=-0.4$。\n- 对于 $P=140$：$\\hat{Y}=0.27\\cdot 140+13=50.8$，所以 $e=53.0-50.8=2.2$。\n- 对于 $P=160$：$\\hat{Y}=0.27\\cdot 160+13=56.2$，所以 $e=52.0-56.2=-4.2$。\n- 对于 $P=180$：$\\hat{Y}=0.27\\cdot 180+13=61.6$，所以 $e=65.5-61.6=3.9$。\n- 对于 $P=200$：$\\hat{Y}=0.27\\cdot 200+13=67.0$，所以 $e=68.0-67.0=1.0$。\n- 对于 $P=220$：$\\hat{Y}=0.27\\cdot 220+13=72.4$，所以 $e=81.0-72.4=8.6$。\n- 对于 $P=240$：$\\hat{Y}=0.27\\cdot 240+13=77.8$，所以 $e=79.0-77.8=1.2$。\n\n由于 $\\hat{Y}$ 随 $P$ 的增加而增加，因此按 $\\hat{Y}$ 排序等同于按 $P$ 排序。因此：\n- 第1组（最低的四个 $\\hat{Y}$）：残差 $e=\\{0.5,-0.4,2.2,-4.2\\}$。\n- 第2组（最高的四个 $\\hat{Y}$）：残差 $e=\\{3.9,1.0,8.6,1.2\\}$。\n\n对于第1组，其中 $n=4$，样本残差均值为\n$$\n\\bar{e}_{1}=\\frac{0.5-0.4+2.2-4.2}{4}=\\frac{-1.9}{4}=-0.475.\n$$\n离差平方和为\n$$\n\\sum_{i=1}^{4}(e_{i}-\\bar{e}_{1})^{2}=(0.5+0.475)^{2}+(-0.4+0.475)^{2}+(2.2+0.475)^{2}+(-4.2+0.475)^{2}\n$$\n$$\n=0.975^{2}+0.075^{2}+2.675^{2}+(-3.725)^{2}=0.950625+0.005625+7.155625+13.875625=21.9875.\n$$\n因此样本方差为\n$$\ns_{1}^{2}=\\frac{1}{n-1}\\sum_{i=1}^{n}(e_{i}-\\bar{e}_{1})^{2}=\\frac{21.9875}{3}=\\frac{1759}{240}.\n$$\n\n对于第2组，样本残差均值为\n$$\n\\bar{e}_{2}=\\frac{3.9+1.0+8.6+1.2}{4}=\\frac{14.7}{4}=3.675.\n$$\n离差平方和为\n$$\n\\sum_{i=1}^{4}(e_{i}-\\bar{e}_{2})^{2}=(3.9-3.675)^{2}+(1.0-3.675)^{2}+(8.6-3.675)^{2}+(1.2-3.675)^{2}\n$$\n$$\n=0.225^{2}+(-2.675)^{2}+4.925^{2}+(-2.475)^{2}=0.050625+7.155625+24.255625+6.125625=37.5875.\n$$\n因此样本方差为\n$$\ns_{2}^{2}=\\frac{37.5875}{3}=\\frac{3007}{240}.\n$$\n\n该比率为\n$$\nF=\\frac{s_{2}^{2}}{s_{1}^{2}}=\\frac{\\frac{3007}{240}}{\\frac{1759}{240}}=\\frac{3007}{1759}\\approx 1.70949.\n$$\n四舍五入到三位有效数字，得到 $F\\approx 1.71$。", "answer": "$$\\boxed{1.71}$$", "id": "2212247"}]}