{"hands_on_practices": [{"introduction": "最小二乘逼近的核心思想是寻找一个简单的函数来“最贴近”一个复杂的函数。本练习将引导你为指数函数 $f(x) = e^x$ 在区间 $[-1, 1]$ 上寻找最佳的二次多项式逼近。通过直接最小化积分平方误差，你将推导并求解被称为“正规方程组”的线性方程组，以确定多项式的系数，这个实践旨在锻炼你应用微积分解决经典数值分析问题的基本技能。[@problem_id:2192786]", "problem": "在数值分析中，使用一个更简单的函数（如多项式）来近似一个复杂的函数通常是很有用的。考虑在区间 $[-1, 1]$ 上的函数 $f(x) = \\exp(x)$。我们希望找到形式为 $p(x) = c_0 + c_1 x + c_2 x^2$ 的“最佳”二次近似。\n\n近似的质量由积分平方误差来衡量，其定义为：\n$$E(c_0, c_1, c_2) = \\int_{-1}^{1} \\left[ f(x) - p(x) \\right]^2 dx$$\n\n你的任务是找到唯一的实系数集合 $(c_0, c_1, c_2)$，使得该误差 $E$ 最小。\n\n计算系数 $c_0, c_1$ 和 $c_2$ 的值。在你的最终答案中，按 $(c_0, c_1, c_2)$ 的顺序给出系数，并将每个值四舍五入到四位有效数字。", "solution": "我们寻求用 $p(x)=c_{0}+c_{1}x+c_{2}x^{2}$ 在 $L^{2}([-1,1])$ 中对 $f(x)=\\exp(x)$ 进行最小二乘近似。该最小化子满足由正交性条件给出的正规方程组\n$$\n\\int_{-1}^{1}\\left(\\exp(x)-p(x)\\right)\\phi_{k}(x)\\,dx=0,\\quad k=0,1,2,\n$$\n，其中的基函数为 $\\phi_{0}(x)=1$，$\\phi_{1}(x)=x$ 和 $\\phi_{2}(x)=x^{2}$。\n\n计算在 $[-1,1]$ 上的必要积分：\n$$\nS_{0}=\\int_{-1}^{1}1\\,dx=2,\\quad S_{1}=\\int_{-1}^{1}x\\,dx=0,\\quad S_{2}=\\int_{-1}^{1}x^{2}\\,dx=\\frac{2}{3},\n$$\n$$\nS_{3}=\\int_{-1}^{1}x^{3}\\,dx=0,\\quad S_{4}=\\int_{-1}^{1}x^{4}\\,dx=\\frac{2}{5}.\n$$\n对于等式右边，使用原函数：\n$$\n\\int \\exp(x)\\,dx=\\exp(x),\n$$\n$$\n\\int x\\exp(x)\\,dx=x\\exp(x)-\\exp(x),\n$$\n$$\n\\int x^{2}\\exp(x)\\,dx=\\exp(x)\\left(x^{2}-2x+2\\right).\n$$\n从 $-1$ 到 $1$ 计算定积分，可得\n$$\nb_{0}=\\int_{-1}^{1}\\exp(x)\\,dx=\\exp(1)-\\exp(-1)=2\\sinh(1),\n$$\n$$\nb_{1}=\\int_{-1}^{1}x\\exp(x)\\,dx=\\left[x\\exp(x)-\\exp(x)\\right]_{-1}^{1}=2\\exp(-1),\n$$\n$$\nb_{2}=\\int_{-1}^{1}x^{2}\\exp(x)\\,dx=\\left[\\exp(x)\\left(x^{2}-2x+2\\right)\\right]_{-1}^{1}=\\exp(1)-5\\exp(-1).\n$$\n\n正规方程组为\n$$\nb_{0}-c_{0}S_{0}-c_{1}S_{1}-c_{2}S_{2}=0,\\quad\nb_{1}-c_{0}S_{1}-c_{1}S_{2}-c_{2}S_{3}=0,\\quad\nb_{2}-c_{0}S_{2}-c_{1}S_{3}-c_{2}S_{4}=0.\n$$\n代入数值，\n$$\n2\\sinh(1)-2c_{0}-\\frac{2}{3}c_{2}=0,\\quad\n2\\exp(-1)-\\frac{2}{3}c_{1}=0,\\quad\n\\exp(1)-5\\exp(-1)-\\frac{2}{3}c_{0}-\\frac{2}{5}c_{2}=0.\n$$\n从中间的方程，\n$$\nc_{1}=3\\exp(-1).\n$$\n从第一个方程，\n$$\nc_{0}=\\sinh(1)-\\frac{1}{3}c_{2}.\n$$\n将此式代入第三个方程：\n$$\n\\exp(1)-5\\exp(-1)-\\frac{2}{3}\\left(\\sinh(1)-\\frac{1}{3}c_{2}\\right)-\\frac{2}{5}c_{2}=0.\n$$\n使用 $\\sinh(1)=\\frac{\\exp(1)-\\exp(-1)}{2}$ 化简：\n$$\n\\exp(1)-5\\exp(-1)-\\frac{2}{3}\\sinh(1)+\\left(\\frac{2}{9}-\\frac{2}{5}\\right)c_{2}=0,\n$$\n$$\n\\left(\\frac{2}{9}-\\frac{2}{5}\\right)c_{2}=-\\exp(1)+5\\exp(-1)+\\frac{2}{3}\\sinh(1),\n$$\n$$\n-\\frac{8}{45}c_{2}=-\\exp(1)+5\\exp(-1)+\\frac{1}{3}\\left(\\exp(1)-\\exp(-1)\\right),\n$$\n$$\n-\\frac{8}{45}c_{2}=-\\frac{2}{3}\\exp(1)+\\frac{14}{3}\\exp(-1),\n$$\n$$\nc_{2}=\\frac{45}{8}\\cdot\\frac{2}{3}\\left(\\exp(1)-7\\exp(-1)\\right)=\\frac{15}{4}\\left(\\exp(1)-7\\exp(-1)\\right).\n$$\n然后\n$$\nc_{0}=\\sinh(1)-\\frac{1}{3}c_{2}=\\sinh(1)-\\frac{5}{4}\\left(\\exp(1)-7\\exp(-1)\\right)\n=-\\frac{3}{4}\\exp(1)+\\frac{33}{4}\\exp(-1).\n$$\n\n因此，系数的符号表达式为：\n$$\nc_{0}=\\frac{33\\exp(-1)-3\\exp(1)}{4},\\quad c_{1}=3\\exp(-1),\\quad c_{2}=\\frac{15}{4}\\left(\\exp(1)-7\\exp(-1)\\right).\n$$\n\n对于所要求的数值（四位有效数字），使用 $\\exp(1)\\approx 2.718281828$ 和 $\\exp(-1)\\approx 0.367879441$：\n$$\nc_{0}\\approx 0.996294018\\ \\Rightarrow\\ 0.9963,\\quad\nc_{1}\\approx 1.103638324\\ \\Rightarrow\\ 1.104,\\quad\nc_{2}\\approx 0.536721526\\ \\Rightarrow\\ 0.5367.\n$$\n因此，按 $(c_{0},c_{1},c_{2})$ 的顺序，系数如下。", "answer": "$$\\boxed{\\begin{pmatrix}0.9963 & 1.104 & 0.5367\\end{pmatrix}}$$", "id": "2192786"}, {"introduction": "虽然直接求解正规方程组的方法是可行的，但对于高次多项式，这种方法在数值上可能变得不稳定。一种更稳健的策略是首先构造一组正交基。本练习将介绍 Gram-Schmidt 过程，这是一个基础算法，能将任何一组线性无关的向量（或函数，如多项式）转化为一个正交集。你将亲手应用此过程，从给定基底生成一组新的正交多项式，这是简化最小二乘计算的关键工具。[@problem_id:2192756]", "problem": "考虑在区间 $[-1, 1]$ 上定义的所有次数至多为二的实值多项式构成的向量空间。对于该空间中的任意两个多项式 $f(x)$ 和 $g(x)$，我们可以定义一个内积为 $\\langle f, g \\rangle = \\int_{-1}^{1} f(x)g(x) dx$。这个空间的一个可能的基是多项式的有序集合 $B = \\{v_0(x), v_1(x), v_2(x)\\}$，其中 $v_0(x) = 1$，$v_1(x) = x+1$，$v_2(x) = x^2$。\n\n为了便于某些数值计算，将给定基变换为正交基通常很有用。对有序基 $B$ 应用Gram-Schmidt过程，生成一组新的正交多项式 $\\{p_0(x), p_1(x), p_2(x)\\}$。\n\n求第三个正交多项式 $p_2(x)$ 在 $x = \\frac{1}{2}$ 处的值。将你的答案表示为最简分数。", "solution": "我们被要求对有序基 $\\{v_0(x), v_1(x), v_2(x)\\} = \\{1, x+1, x^2\\}$ 应用Gram-Schmidt过程，其内积为 $\\langle f, g \\rangle = \\int_{-1}^{1} f(x)g(x) dx$。得到的正交多项式 $\\{p_0(x), p_1(x), p_2(x)\\}$ 的构造如下。\n\n首先，我们将第一个正交多项式 $p_0(x)$ 设为等于第一个基向量 $v_0(x)$：\n$$p_0(x) = v_0(x) = 1$$\n\n接下来，我们通过从 $v_1(x)$ 中减去 $v_1(x)$ 在 $p_0(x)$ 上的投影来找到第二个正交多项式 $p_1(x)$：\n$$p_1(x) = v_1(x) - \\frac{\\langle v_1, p_0 \\rangle}{\\langle p_0, p_0 \\rangle} p_0(x)$$\n为了计算这个，我们需要评估所需的内积。\n$$ \\langle p_0, p_0 \\rangle = \\int_{-1}^{1} (1)(1) dx = [x]_{-1}^{1} = 1 - (-1) = 2 $$\n$$ \\langle v_1, p_0 \\rangle = \\int_{-1}^{1} (x+1)(1) dx = \\left[\\frac{x^2}{2} + x\\right]_{-1}^{1} = \\left(\\frac{1}{2} + 1\\right) - \\left(\\frac{(-1)^2}{2} - 1\\right) = \\frac{3}{2} - \\left(-\\frac{1}{2}\\right) = 2 $$\n现在我们可以将这些值代回到 $p_1(x)$ 的表达式中：\n$$p_1(x) = (x+1) - \\frac{2}{2}(1) = x+1-1 = x$$\n\n最后，我们通过从 $v_2(x)$ 中减去 $v_2(x)$ 在 $p_0(x)$ 和 $p_1(x)$ 上的投影来构造第三个正交多项式 $p_2(x)$：\n$$p_2(x) = v_2(x) - \\frac{\\langle v_2, p_0 \\rangle}{\\langle p_0, p_0 \\rangle} p_0(x) - \\frac{\\langle v_2, p_1 \\rangle}{\\langle p_1, p_1 \\rangle} p_1(x)$$\n我们需要再计算三个内积。我们已经有 $\\langle p_0, p_0 \\rangle = 2$。\n$$ \\langle p_1, p_1 \\rangle = \\int_{-1}^{1} (x)(x) dx = \\int_{-1}^{1} x^2 dx = \\left[\\frac{x^3}{3}\\right]_{-1}^{1} = \\frac{1}{3} - \\frac{-1}{3} = \\frac{2}{3} $$\n$$ \\langle v_2, p_0 \\rangle = \\int_{-1}^{1} (x^2)(1) dx = \\int_{-1}^{1} x^2 dx = \\left[\\frac{x^3}{3}\\right]_{-1}^{1} = \\frac{2}{3} $$\n$$ \\langle v_2, p_1 \\rangle = \\int_{-1}^{1} (x^2)(x) dx = \\int_{-1}^{1} x^3 dx = \\left[\\frac{x^4}{4}\\right]_{-1}^{1} = \\frac{1}{4} - \\frac{1}{4} = 0 $$\n注意，$\\langle v_2, p_1 \\rangle$ 的积分为零，因为被积函数 $x^3$ 是一个在对称区间上积分的奇函数。\n现在，我们将这些值代入 $p_2(x)$ 的表达式中：\n$$p_2(x) = x^2 - \\frac{2/3}{2}(1) - \\frac{0}{2/3}(x) = x^2 - \\frac{1}{3} - 0 = x^2 - \\frac{1}{3}$$\n这组正交多项式是 $\\{1, x, x^2 - \\frac{1}{3}\\}$。\n\n题目要求 $p_2(x)$ 在 $x = \\frac{1}{2}$ 处的值。\n$$ p_2\\left(\\frac{1}{2}\\right) = \\left(\\frac{1}{2}\\right)^2 - \\frac{1}{3} = \\frac{1}{4} - \\frac{1}{3} $$\n为了进行分数减法，我们找到一个公分母，即 12：\n$$ p_2\\left(\\frac{1}{2}\\right) = \\frac{3}{12} - \\frac{4}{12} = -\\frac{1}{12} $$\n第三个正交多项式在 $x=1/2$ 处的值是 $-\\frac{1}{12}$。", "answer": "$$\\boxed{-\\frac{1}{12}}$$", "id": "2192756"}, {"introduction": "对于多项式而言，存在一个比通用 Gram-Schmidt 过程更高效、更简洁的方法来生成正交集：三项递推关系。这个强大的关系式能够逐个构造正交多项式，是许多数值算法的核心。本练习将焦点从连续函数转向离散的实验数据，要求你计算该递推关系中的一个系数。通过这个实践，你将了解到这些理论工具是如何被应用于实际的、由数据驱动的场景中的。[@problem_id:2192741]", "problem": "在实验数据的数值分析中，使用相对于数据点正交的函数基通常是有利的。考虑在坐标 $\\{x_i\\} = \\{0, 1, 3, 6\\}$ 处的一组四个实验测量值。我们感兴趣的是生成一个相对于离散内积正交的首一多项式序列 $\\{p_k(x)\\}_{k=0}^\\infty$。\n\n两个实值函数 $f(x)$ 和 $g(x)$ 在这组点上的内积定义为：\n$$ \\langle f, g \\rangle = \\sum_{i=1}^{4} f(x_i) g(x_i) $$\n该正交首一多项式序列由以下三项递推关系生成：\n$$ p_{k+1}(x) = (x - \\alpha_k) p_k(x) - \\beta_k p_{k-1}(x) $$\n其中 $k \\ge 0$，初始条件定义为 $p_0(x) = 1$ 和 $p_{-1}(x) = 0$。\n\n您的任务是确定递推系数 $\\alpha_1$ 的精确值。请将您的最终答案表示为最简分数形式。", "solution": "我们使用给定的离散内积\n$$\\langle f, g \\rangle = \\sum_{i=1}^{4} f(x_{i}) g(x_{i}), \\quad \\{x_{i}\\}=\\{0,1,3,6\\},$$\n以及首一三项递推关系\n$$p_{k+1}(x)=(x-\\alpha_{k})p_{k}(x)-\\beta_{k}p_{k-1}(x), \\quad p_{0}(x)=1,\\; p_{-1}(x)=0.$$\n\n对于首一正交多项式，将递推关系与 $p_{k}$ 取内积可得\n$$\\langle p_{k+1},p_{k}\\rangle=\\langle (x-\\alpha_{k})p_{k},p_{k}\\rangle-\\beta_{k}\\langle p_{k-1},p_{k}\\rangle.$$\n根据正交性，$\\langle p_{k+1},p_{k}\\rangle=0$ 且 $\\langle p_{k-1},p_{k}\\rangle=0$，因此\n$$0=\\langle x p_{k},p_{k}\\rangle-\\alpha_{k}\\langle p_{k},p_{k}\\rangle,$$\n所以\n$$\\alpha_{k}=\\frac{\\langle x p_{k},p_{k}\\rangle}{\\langle p_{k},p_{k}\\rangle}.$$\n\n首先，计算 $\\alpha_{0}$：\n$$\\alpha_{0}=\\frac{\\langle x p_{0},p_{0}\\rangle}{\\langle p_{0},p_{0}\\rangle}\n=\\frac{\\sum_{i=1}^{4} x_{i}}{\\sum_{i=1}^{4} 1}\n=\\frac{0+1+3+6}{4}\n=\\frac{10}{4}\n=\\frac{5}{2}.$$\n因此\n$$p_{1}(x)=x-\\alpha_{0}=x-\\frac{5}{2}.$$\n\n现在使用以下公式计算 $\\alpha_{1}$\n$$\\alpha_{1}=\\frac{\\langle x p_{1},p_{1}\\rangle}{\\langle p_{1},p_{1}\\rangle}\n=\\frac{\\sum_{i=1}^{4} x_{i}\\,p_{1}(x_{i})^{2}}{\\sum_{i=1}^{4} p_{1}(x_{i})^{2}}.$$\n在数据点处计算 $p_{1}(x)$ 的值：\n$$p_{1}(0)=-\\frac{5}{2},\\quad p_{1}(1)=-\\frac{3}{2},\\quad p_{1}(3)=\\frac{1}{2},\\quad p_{1}(6)=\\frac{7}{2}.$$\n平方：\n$$p_{1}(0)^{2}=\\frac{25}{4},\\quad p_{1}(1)^{2}=\\frac{9}{4},\\quad p_{1}(3)^{2}=\\frac{1}{4},\\quad p_{1}(6)^{2}=\\frac{49}{4}.$$\n分母：\n$$\\langle p_{1},p_{1}\\rangle=\\frac{25}{4}+\\frac{9}{4}+\\frac{1}{4}+\\frac{49}{4}=\\frac{84}{4}=21.$$\n分子：\n$$\\langle x p_{1},p_{1}\\rangle=0\\cdot\\frac{25}{4}+1\\cdot\\frac{9}{4}+3\\cdot\\frac{1}{4}+6\\cdot\\frac{49}{4}\n=\\frac{0+9+3+294}{4}=\\frac{306}{4}=\\frac{153}{2}.$$\n因此\n$$\\alpha_{1}=\\frac{\\frac{153}{2}}{21}=\\frac{153}{42}=\\frac{51}{14}.$$\n此分数已为最简形式。", "answer": "$$\\boxed{\\frac{51}{14}}$$", "id": "2192741"}]}