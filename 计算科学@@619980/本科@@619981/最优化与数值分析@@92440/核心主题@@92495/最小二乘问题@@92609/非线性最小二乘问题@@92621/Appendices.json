{"hands_on_practices": [{"introduction": "在尝试最小化一个目标函数之前，我们首先必须学会如何计算它的值。这个练习将引导你计算非线性最小二乘法中的核心量——残差平方和（Sum of Squared Residuals, SSR）。通过为一个给定的模型和参数计算这个值，你将掌握评估模型拟合优度的基本方法，这是理解和实施任何优化算法的第一步 [@problem_id:2214255]。", "problem": "在数据分析和数值优化领域，非线性最小二乘法是一种将模型拟合到一组观测数据点的基本技术。其目标是找到模型参数，以最小化观测数据与模型预测值之间差值的平方和。\n\n考虑一个用于描述饱和过程的模型，由以下函数给出：\n$$f(x, \\beta) = \\frac{\\beta_1}{1 + x^{\\beta_2}}$$\n其中 $\\beta = (\\beta_1, \\beta_2)$ 是模型参数的向量。\n\n假设一次实验得到两个数据点：$(x_1, y_1) = (1, 1)$ 和 $(x_2, y_2) = (2, 0.5)$。\n\n对于一组特定的参数选择，其拟合质量由平方误差和目标函数 $S(\\beta)$ 来量化，该函数定义为残差的平方和：\n$$S(\\beta) = \\sum_{i=1}^{2} (y_i - f(x_i, \\beta))^2$$\n\n作为诸如高斯-牛顿法等优化过程的第一步，必须在参数的初始猜测值处评估目标函数。计算当参数向量为 $\\beta = (2, 1)$ 时 $S(\\beta)$ 的值。\n\n请将您的最终答案表示为最简精确分数。", "solution": "给定函数 $f(x,\\beta)=\\dfrac{\\beta_{1}}{1+x^{\\beta_{2}}}$ 和 $S(\\beta)=\\sum_{i=1}^{2}\\left(y_{i}-f(x_{i},\\beta)\\right)^{2}$，数据点为 $(x_{1},y_{1})=(1,1)$ 和 $(x_{2},y_{2})=(2,\\dfrac{1}{2})$。对于 $\\beta=(2,1)$，模型计算为\n$$\nf(x,(2,1))=\\frac{2}{1+x^{1}}=\\frac{2}{1+x}.\n$$\n在 $x_{1}=1$ 处，我们有\n$$\nf(1,(2,1))=\\frac{2}{1+1}=\\frac{2}{2}=1,\n$$\n所以残差为 $r_{1}=y_{1}-f(1,(2,1))=1-1=0$，得到 $r_{1}^{2}=0$。\n在 $x_{2}=2$ 处，我们有\n$$\nf(2,(2,1))=\\frac{2}{1+2}=\\frac{2}{3},\n$$\n所以残差为\n$$\nr_{2}=y_{2}-f(2,(2,1))=\\frac{1}{2}-\\frac{2}{3}=\\frac{3-4}{6}=-\\frac{1}{6},\n$$\n得到 $r_{2}^{2}=\\left(-\\frac{1}{6}\\right)^{2}=\\frac{1}{36}$。\n因此，\n$$\nS(\\beta)=r_{1}^{2}+r_{2}^{2}=0+\\frac{1}{36}=\\frac{1}{36}.\n$$", "answer": "$$\\boxed{\\frac{1}{36}}$$", "id": "2214255"}, {"introduction": "高斯-牛顿法是求解非线性最小二乘问题的有效算法，但它的效率源于一个关键的近似。这个练习通过让你直接比较高斯-牛顿法中的近似Hessian矩阵 ($J^T J$) 与误差函数的真实Hessian矩阵，揭示了该算法的核心思想。理解这两者之间的差异，可以帮助你洞察该算法的收敛特性以及其在不同情况下的表现 [@problem_id:2214286]。", "problem": "考虑一个用于描述生长过程的单参数非线性模型，其函数为 $f(x; \\beta) = \\exp(\\beta x)$，其中 $\\beta$ 是模型参数。我们希望将此模型拟合到单个实验数据点 $(x_1, y_1) = (1, 3)$。\n\n对于给定的 $\\beta$，拟合的质量由最小二乘目标函数衡量，对于单个数据点，该函数为残差平方：\n$$ S(\\beta) = (f(x_1; \\beta) - y_1)^2 $$\n\n在优化中，目标函数的二阶导数（海森矩阵）提供了关于误差曲面曲率的信息。$S(\\beta)$ 的真实海森矩阵是标量 $H = \\frac{d^2S}{d\\beta^2}$。高斯-牛顿算法是求解非线性最小二乘问题的一种常用方法，它使用海森矩阵的近似值，由 $H_{GN} = J^T J$ 给出，其中 $J$ 是残差函数 $r(\\beta) = f(x_1; \\beta) - y_1$ 的雅可比矩阵。由于只有一个参数和一个数据点，雅可比矩阵 $J$ 是一个 $1 \\times 1$ 矩阵。\n\n计算在特定参数值 $\\beta=1$ 处，真实海森矩阵与高斯-牛顿近似之间的差值 $\\Delta H = H - H_{GN}$ 的精确值。", "solution": "我们有一个单参数模型 $f(x;\\beta)=\\exp(\\beta x)$ 和一个数据点 $(x_{1},y_{1})=(1,3)$。残差定义为 $r(\\beta)=f(x_{1};\\beta)-y_{1}=\\exp(\\beta)-3$。单个数据点的最小二乘目标是 $S(\\beta)=r(\\beta)^{2}$。\n\n为计算真实海森矩阵，对 $S(\\beta)=r(\\beta)^{2}$ 求导。根据链式法则，\n$$\n\\frac{dS}{d\\beta}=2\\,r(\\beta)\\,r'(\\beta),\n$$\n再次求导得到\n$$\nH=\\frac{d^{2}S}{d\\beta^{2}}=2\\left[(r'(\\beta))^{2}+r(\\beta)\\,r''(\\beta)\\right].\n$$\n对于 $r(\\beta)=\\exp(\\beta)-3$，我们有 $r'(\\beta)=\\exp(\\beta)$ 和 $r''(\\beta)=\\exp(\\beta)$。代入得，\n$$\nH=2\\left[\\exp(2\\beta)+(\\exp(\\beta)-3)\\exp(\\beta)\\right]\n=2\\left[\\exp(2\\beta)+\\exp(2\\beta)-3\\exp(\\beta)\\right]\n=4\\exp(2\\beta)-6\\exp(\\beta).\n$$\n\n高斯-牛顿近似使用 $H_{GN}=J^{T}J$，其中 $J$ 是 $r(\\beta)$ 关于 $\\beta$ 的雅可比矩阵。由于在这种标量情况下 $J=r'(\\beta)=\\exp(\\beta)$，我们有\n$$\nH_{GN}=J^{T}J=(\\exp(\\beta))^{2}=\\exp(2\\beta).\n$$\n\n差值为\n$$\n\\Delta H=H-H_{GN}=\\left(4\\exp(2\\beta)-6\\exp(\\beta)\\right)-\\exp(2\\beta)\n=3\\exp(2\\beta)-6\\exp(\\beta).\n$$\n在 $\\beta=1$ 处求值得到\n$$\n\\Delta H=3\\exp(2)-6\\exp(1)=3\\exp(1)\\left(\\exp(1)-2\\right).\n$$", "answer": "$$\\boxed{3\\exp(2)-6\\exp(1)}$$", "id": "2214286"}, {"introduction": "现在，让我们将理论应用于一个引人入胜的实际问题：利用声学信号定位声源。这个练习将指导你完成高斯-牛顿法的一次完整迭代，包括计算残差、构建雅可比矩阵，并求解参数的更新步长。通过解决一个像声源定位这样的真实场景问题，你将巩固对算法各理论部分如何协同工作以解决实际挑战的理解 [@problem_id:2191258]。", "problem": "一个声音定位系统用于在一个二维平面内确定声源的位置。该系统由三个麦克风组成，分别位于位置 $\\mathbf{m}_1 = (0, 0)$、$\\mathbf{m}_2 = (L, 0)$ 和 $\\mathbf{m}_3 = (0, L)$。声源位于一个未知位置 $\\mathbf{p} = (x, y)$。\n\n该系统通过测量声音信号到达不同麦克风的到达时间差 (TDOA) 来工作。时间差是相对于信号到达参考麦克风 $\\mathbf{m}_1$ 的时间来测量的。麦克风 $\\mathbf{m}_i$ 和 $\\mathbf{m}_1$ 之间的时间差的理论模型由公式 $\\Delta t_{i1}(\\mathbf{p}) = \\frac{\\|\\mathbf{p} - \\mathbf{m}_i\\| - \\|\\mathbf{p} - \\mathbf{m}_1\\|}{v_s}$ 给出，其中 $\\|\\cdot\\|$ 表示欧几里得距离， $v_s$ 是声速。\n\n位置 $\\mathbf{p}$ 的估计是通过找到坐标 $(x, y)$ 以最小化测量的 TDOA 值与模型预测值之间的平方差之和来实现的。这个非线性最小二乘问题将使用高斯-牛顿 (Gauss-Newton) 算法来求解。该算法使用以下更新规则，将估计值 $\\mathbf{p}^{(k)}$ 迭代地优化为新的估计值 $\\mathbf{p}^{(k+1)}$：\n$$ \\mathbf{p}^{(k+1)} = \\mathbf{p}^{(k)} + \\Delta\\mathbf{p} $$\n其中更新量 $\\Delta\\mathbf{p}$ 是线性方程组 $(J^T J) \\Delta\\mathbf{p} = J^T \\mathbf{r}$ 的解。在这里，$\\mathbf{r}$ 是残差向量（测量值减去模型预测值），$J$ 是模型函数的雅可比 (Jacobian) 矩阵，两者都在当前估计值 $\\mathbf{p}^{(k)}$ 处计算。\n\n给定以下参数：\n- 麦克风配置常数: $L = 100 \\text{ m}$\n- 声速: $v_s = 340 \\text{ m/s}$\n- 测量的 TDOA: $\\tau_{21} = \\frac{5(1-\\sqrt{2})}{17} \\text{ s}$ 和 $\\tau_{31} = \\frac{5(1-\\sqrt{2})}{17} \\text{ s}$\n- 声源位置的初始猜测值: $\\mathbf{p}^{(0)} = (L/2, L/2)$\n\n你的任务是通过执行单步高斯-牛顿(Gauss-Newton)算法来计算下一个位置估计值 $\\mathbf{p}^{(1)} = (x_1, y_1)$。以解析表达式的形式给出坐标 $(x_1, y_1)$。", "solution": "我们对麦克风 $\\mathbf{m}_{2}$ 和 $\\mathbf{m}_{3}$ 相对于 $\\mathbf{m}_{1}$ 的TDOA进行建模：\n$$\nh_{i}(\\mathbf{p})=\\Delta t_{i1}(\\mathbf{p})=\\frac{\\|\\mathbf{p}-\\mathbf{m}_{i}\\|-\\|\\mathbf{p}-\\mathbf{m}_{1}\\|}{v_{s}},\\quad i\\in\\{2,3\\}.\n$$\n给定测量的 TDOA $\\tau_{21}$ 和 $\\tau_{31}$，在当前估计值 $\\mathbf{p}^{(k)}$ 处的残差向量为\n$$\n\\mathbf{r}=\\begin{pmatrix}\\tau_{21}-h_{2}(\\mathbf{p}^{(k)})\\\\ \\tau_{31}-h_{3}(\\mathbf{p}^{(k)})\\end{pmatrix}.\n$$\n高斯-牛顿 (Gauss-Newton) 步求解 $(J^{T}J)\\,\\Delta\\mathbf{p}=J^{T}\\mathbf{r}$，其中 $J$ 是 $(h_{2},h_{3})$ 在 $\\mathbf{p}^{(k)}$ 处的雅可比 (Jacobian) 矩阵。对于 $\\mathbf{p}\\neq\\mathbf{a}$，使用 $\\nabla_{\\mathbf{p}}\\|\\mathbf{p}-\\mathbf{a}\\|=\\frac{\\mathbf{p}-\\mathbf{a}}{\\|\\mathbf{p}-\\mathbf{a}\\|}$，我们得到\n$$\n\\nabla h_{i}(\\mathbf{p})=\\frac{1}{v_{s}}\\left(\\frac{\\mathbf{p}-\\mathbf{m}_{i}}{\\|\\mathbf{p}-\\mathbf{m}_{i}\\|}-\\frac{\\mathbf{p}-\\mathbf{m}_{1}}{\\|\\mathbf{p}-\\mathbf{m}_{1}\\|}\\right),\\quad i\\in\\{2,3\\}.\n$$\n\n代入初始猜测值 $\\mathbf{p}^{(0)}=\\left(\\frac{L}{2},\\frac{L}{2}\\right)$ 以及 $\\mathbf{m}_{1}=(0,0)$、$\\mathbf{m}_{2}=(L,0)$、$\\mathbf{m}_{3}=(0,L)$。那么\n$$\n\\mathbf{p}^{(0)}-\\mathbf{m}_{1}=\\left(\\frac{L}{2},\\frac{L}{2}\\right),\\quad\n\\mathbf{p}^{(0)}-\\mathbf{m}_{2}=\\left(-\\frac{L}{2},\\frac{L}{2}\\right),\\quad\n\\mathbf{p}^{(0)}-\\mathbf{m}_{3}=\\left(\\frac{L}{2},-\\frac{L}{2}\\right),\n$$\n它们的范数都相等：\n$$\n\\left\\|\\mathbf{p}^{(0)}-\\mathbf{m}_{1}\\right\\|=\\left\\|\\mathbf{p}^{(0)}-\\mathbf{m}_{2}\\right\\|=\\left\\|\\mathbf{p}^{(0)}-\\mathbf{m}_{3}\\right\\|=\\frac{L}{\\sqrt{2}}.\n$$\n因此，单位向量为\n$$\n\\frac{\\mathbf{p}^{(0)}-\\mathbf{m}_{1}}{\\|\\mathbf{p}^{(0)}-\\mathbf{m}_{1}\\|}=\\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right),\\quad\n\\frac{\\mathbf{p}^{(0)}-\\mathbf{m}_{2}}{\\|\\mathbf{p}^{(0)}-\\mathbf{m}_{2}\\|}=\\left(-\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right),\\quad\n\\frac{\\mathbf{p}^{(0)}-\\mathbf{m}_{3}}{\\|\\mathbf{p}^{(0)}-\\mathbf{m}_{3}\\|}=\\left(\\frac{1}{\\sqrt{2}},-\\frac{1}{\\sqrt{2}}\\right).\n$$\n因此，在 $\\mathbf{p}^{(0)}$ 处的雅可比 (Jacobian) 矩阵的行向量为\n$$\n\\nabla h_{2}(\\mathbf{p}^{(0)})=\\frac{1}{v_{s}}\\left(\\left(-\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right)-\\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right)\\right)=\\left(-\\frac{\\sqrt{2}}{v_{s}},\\,0\\right),\n$$\n$$\n\\nabla h_{3}(\\mathbf{p}^{(0)})=\\frac{1}{v_{s}}\\left(\\left(\\frac{1}{\\sqrt{2}},-\\frac{1}{\\sqrt{2}}\\right)-\\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right)\\right)=\\left(0,\\,-\\frac{\\sqrt{2}}{v_{s}}\\right).\n$$\n于是\n$$\nJ=\\begin{pmatrix}-\\frac{\\sqrt{2}}{v_{s}}  0 \\\\[4pt] 0  -\\frac{\\sqrt{2}}{v_{s}}\\end{pmatrix},\\qquad\nJ^{T}J=\\begin{pmatrix}\\frac{2}{v_{s}^{2}}  0\\\\ 0  \\frac{2}{v_{s}^{2}}\\end{pmatrix},\\qquad\n(J^{T}J)^{-1}=\\begin{pmatrix}\\frac{v_{s}^{2}}{2}  0\\\\ 0  \\frac{v_{s}^{2}}{2}\\end{pmatrix}.\n$$\n\n在 $\\mathbf{p}^{(0)}$ 处，模型预测值为 $h_{2}(\\mathbf{p}^{(0)})=h_{3}(\\mathbf{p}^{(0)})=0$（距离相等），因此对于 $\\tau_{21}=\\tau_{31}=\\tau$，\n$$\n\\mathbf{r}=\\begin{pmatrix}\\tau\\\\ \\tau\\end{pmatrix},\\qquad\nJ^{T}\\mathbf{r}=\\begin{pmatrix}-\\frac{\\sqrt{2}}{v_{s}}\\,\\tau \\\\[4pt] -\\frac{\\sqrt{2}}{v_{s}}\\,\\tau\\end{pmatrix}.\n$$\n因此，高斯-牛顿 (Gauss-Newton) 更新量为\n$$\n\\Delta\\mathbf{p}=(J^{T}J)^{-1}J^{T}\\mathbf{r}=\\begin{pmatrix}-\\frac{v_{s}\\,\\tau}{\\sqrt{2}} \\\\[4pt] -\\frac{v_{s}\\,\\tau}{\\sqrt{2}}\\end{pmatrix}.\n$$\n更新后得到\n$$\n\\mathbf{p}^{(1)}=\\mathbf{p}^{(0)}+\\Delta\\mathbf{p}=\\left(\\frac{L}{2}-\\frac{v_{s}\\,\\tau}{\\sqrt{2}},\\,\\frac{L}{2}-\\frac{v_{s}\\,\\tau}{\\sqrt{2}}\\right).\n$$\n\n代入给定值 $L=100$，$v_{s}=340$ 和 $\\tau=\\frac{5(1-\\sqrt{2})}{17}$，\n$$\n-\\frac{v_{s}\\,\\tau}{\\sqrt{2}}=-\\frac{340\\cdot \\frac{5(1-\\sqrt{2})}{17}}{\\sqrt{2}}=-\\frac{100(1-\\sqrt{2})}{\\sqrt{2}}=100\\left(1-\\frac{1}{\\sqrt{2}}\\right),\n$$\n所以\n$$\n\\mathbf{p}^{(1)}=\\left(\\frac{L}{2}+100\\left(1-\\frac{1}{\\sqrt{2}}\\right),\\,\\frac{L}{2}+100\\left(1-\\frac{1}{\\sqrt{2}}\\right)\\right)=\\left(150-\\frac{100}{\\sqrt{2}},\\,150-\\frac{100}{\\sqrt{2}}\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}150-\\frac{100}{\\sqrt{2}}  150-\\frac{100}{\\sqrt{2}}\\end{pmatrix}}$$", "id": "2191258"}]}