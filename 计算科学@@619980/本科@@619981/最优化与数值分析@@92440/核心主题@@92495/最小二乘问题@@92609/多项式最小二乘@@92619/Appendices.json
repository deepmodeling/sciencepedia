{"hands_on_practices": [{"introduction": "我们从一个基础但至关重要的练习开始。在科学实验中，我们经常收集数据以验证理论模型并提取物理常数。本练习模拟了一个典型的物理实验场景——验证胡克定律，要求你使用最小二乘法从一组力与位移的数据点中找到最佳拟合直线，从而确定弹簧常数 $k$。这个过程不仅能让你掌握线性最小二乘法的核心计算步骤，即建立并求解正规方程，还能让你体会到如何将数学工具应用于从实验数据中提取有意义的物理信息。[@problem_id:2194103]", "problem": "在一个旨在验证胡克定律的物理实验室实验中，一名学生测量了弹簧在不同外力作用下的位移。该学生使用线性方程 $F(x) = kx + F_0$ 来模拟所施加的力 $F$ 与产生的位移 $x$ 之间的关系，其中 $k$ 是劲度系数，而 $F_0$ 是由于预加载或测量零点误差可能引起的力偏移。\n\n收集了以下五个数据点 $(x_i, F_i)$，其中位移 $x$ 的单位是米 (m)，力 $F$ 的单位是牛顿 (N)：\n$$ (0.10, 16.0), \\ (0.20, 30.0), \\ (0.30, 46.0), \\ (0.40, 61.5), \\ (0.50, 74.0) $$\n\n使用最小二乘法，确定劲度系数 $k$ 和力偏移 $F_0$ 的最佳拟合值。报告劲度系数 $k$（单位为 N/m）和力偏移 $F_0$（单位为 N）的值。将您的最终答案均舍入至三位有效数字。", "solution": "问题要求为一组给定的五个数据点 $(x_i, F_i)$ 找到形式为 $F(x) = kx + F_0$ 的最佳拟合直线。最小二乘法旨在最小化残差平方和 $S$，即观测到的力值 $F_i$ 与线性模型预测值 $F(x_i)$ 之间差值的平方和。\n\n需要最小化的函数是：\n$$ S(k, F_0) = \\sum_{i=1}^{5} (F_i - (kx_i + F_0))^2 $$\n\n为了找到使 $S$ 最小化的 $k$ 和 $F_0$ 的值，我们对 $S$ 分别求关于 $k$ 和 $F_0$ 的偏导数，并令它们等于零。\n\n关于 $k$ 的偏导数是：\n$$ \\frac{\\partial S}{\\partial k} = \\sum_{i=1}^{5} 2(F_i - kx_i - F_0)(-x_i) = -2 \\left( \\sum_{i=1}^{5} x_i F_i - k \\sum_{i=1}^{5} x_i^2 - F_0 \\sum_{i=1}^{5} x_i \\right) = 0 $$\n这可以简化为第一个正规方程：\n$$ k \\left( \\sum_{i=1}^{5} x_i^2 \\right) + F_0 \\left( \\sum_{i=1}^{5} x_i \\right) = \\sum_{i=1}^{5} x_i F_i $$\n\n关于 $F_0$ 的偏导数是：\n$$ \\frac{\\partial S}{\\partial F_0} = \\sum_{i=1}^{5} 2(F_i - kx_i - F_0)(-1) = -2 \\left( \\sum_{i=1}^{5} F_i - k \\sum_{i=1}^{5} x_i - F_0 \\sum_{i=1}^{5} 1 \\right) = 0 $$\n这可以简化为第二个正规方程，其中 $n=5$ 是数据点的数量：\n$$ k \\left( \\sum_{i=1}^{5} x_i \\right) + n F_0 = \\sum_{i=1}^{5} F_i $$\n\n现在，我们根据给定的数据计算所需的总和：\n$(x_1, F_1) = (0.10, 16.0)$，$(x_2, F_2) = (0.20, 30.0)$，$(x_3, F_3) = (0.30, 46.0)$，$(x_4, F_4) = (0.40, 61.5)$，$(x_5, F_5) = (0.50, 74.0)$。\n\n$$ \\sum_{i=1}^{5} x_i = 0.10 + 0.20 + 0.30 + 0.40 + 0.50 = 1.50 $$\n$$ \\sum_{i=1}^{5} F_i = 16.0 + 30.0 + 46.0 + 61.5 + 74.0 = 227.5 $$\n$$ \\sum_{i=1}^{5} x_i^2 = (0.10)^2 + (0.20)^2 + (0.30)^2 + (0.40)^2 + (0.50)^2 = 0.01 + 0.04 + 0.09 + 0.16 + 0.25 = 0.55 $$\n$$ \\sum_{i=1}^{5} x_i F_i = (0.10)(16.0) + (0.20)(30.0) + (0.30)(46.0) + (0.40)(61.5) + (0.50)(74.0) $$\n$$ \\sum_{i=1}^{5} x_i F_i = 1.6 + 6.0 + 13.8 + 24.6 + 37.0 = 83.0 $$\n\n正规方程组的矩阵形式是：\n$$ \\begin{pmatrix} \\sum x_i^2 & \\sum x_i \\\\ \\sum x_i & n \\end{pmatrix} \\begin{pmatrix} k \\\\ F_0 \\end{pmatrix} = \\begin{pmatrix} \\sum x_i F_i \\\\ \\sum F_i \\end{pmatrix} $$\n\n代入计算出的值：\n$$ \\begin{pmatrix} 0.55 & 1.50 \\\\ 1.50 & 5 \\end{pmatrix} \\begin{pmatrix} k \\\\ F_0 \\end{pmatrix} = \\begin{pmatrix} 83.0 \\\\ 227.5 \\end{pmatrix} $$\n\n我们可以求解这个 2x2 方程组来得到 $k$ 和 $F_0$。我们将使用矩阵求逆法。设矩阵为 $M$。\n$$ M = \\begin{pmatrix} 0.55 & 1.50 \\\\ 1.50 & 5 \\end{pmatrix} $$\n$M$ 的行列式是：\n$$ \\det(M) = (0.55)(5) - (1.50)(1.50) = 2.75 - 2.25 = 0.50 $$\n$M$ 的逆矩阵是：\n$$ M^{-1} = \\frac{1}{\\det(M)} \\begin{pmatrix} 5 & -1.50 \\\\ -1.50 & 0.55 \\end{pmatrix} = \\frac{1}{0.50} \\begin{pmatrix} 5 & -1.50 \\\\ -1.50 & 0.55 \\end{pmatrix} = \\begin{pmatrix} 10 & -3 \\\\ -3 & 1.1 \\end{pmatrix} $$\n\n现在，求解系数向量：\n$$ \\begin{pmatrix} k \\\\ F_0 \\end{pmatrix} = M^{-1} \\begin{pmatrix} 83.0 \\\\ 227.5 \\end{pmatrix} = \\begin{pmatrix} 10 & -3 \\\\ -3 & 1.1 \\end{pmatrix} \\begin{pmatrix} 83.0 \\\\ 227.5 \\end{pmatrix} $$\n\n计算 $k$：\n$$ k = (10)(83.0) - (3)(227.5) = 830 - 682.5 = 147.5 $$\n\n计算 $F_0$：\n$$ F_0 = (-3)(83.0) + (1.1)(227.5) = -249 + 250.25 = 1.25 $$\n\n因此，劲度系数为 $k = 147.5$ N/m，力偏移为 $F_0 = 1.25$ N。\n\n题目要求将两个值都舍入到三位有效数字。\n$k = 147.5$ 舍入为 $148$。\n$F_0 = 1.25$ 本身就是三位有效数字。\n\n最终答案是 $k = 148$ N/m 和 $F_0 = 1.25$ N。", "answer": "$$\\boxed{\\begin{pmatrix} 148 & 1.25 \\end{pmatrix}}$$", "id": "2194103"}, {"introduction": "在掌握了如何拟合模型后，一个自然而然的问题是：我们能让拟合误差完全消失吗？这个练习是一个思想实验，它探讨了多项式拟合的一个理论极限。通过思考对 $n$ 个不同的数据点拟合一个 $n-1$ 次多项式的情况，你将揭示近似（拟合）与精确匹配（插值）之间的深刻联系。理解这个边界情况至关重要，因为它直接引出了“过拟合”的概念——即模型过于复杂以至于完美地“记住”了数据，但失去了对普遍规律的预测能力。[@problem_id:2194113]", "problem": "一位数据科学家得到一组 $n$ 个数据点，记作 $(x_1, y_1), (x_2, y_2), \\dots, (x_n, y_n)$，其中 $n$ 是一个大于或等于2的整数。已知该数据集中的所有 $x_i$ 值都是互不相同的。该科学家的目标是找到一个能够最佳拟合这些数据的多项式模型。\n\n他们选择使用最小二乘法，用一个次数至多为 $n-1$ 的多项式 $P(x)$ 来拟合这些数据点。该方法旨在找到一个特定的多项式 $P(x)$，它能够最小化多项式与数据点之间的垂直距离平方和。这个和被称为误差平方和，由以下表达式给出：\n$$\nS = \\sum_{i=1}^{n} (P(x_i) - y_i)^2\n$$\n\n在这种特定设置下，以下哪个陈述正确地描述了最小化后的误差平方和 $S_{min}$ 的值？\n\nA. 最小化的误差平方和将是一个很小的非零正值，因为最小二乘法旨在找到一个近似解，而对任意数据的完美拟合通常是不可能的。\n\nB. 最小化的误差平方和将恰好为零。这是因为总可以构建一个唯一的、次数至多为 $n-1$ 的多项式，使其完美地穿过任意 $n$ 个不同的点。\n\nC. 最小化的误差平方和将恰好为零，但这个结果只有在与点集 $\\{x_i\\}$ 相关联的范德蒙矩阵是奇异的情况下才可能实现。\n\nD. 在不知道数据点 $(x_i, y_i)$ 的具体数值的情况下，通常无法确定最小化的误差平方和的值。", "solution": "我们寻求一个次数至多为 $n-1$ 的多项式 $P(x)$，它能够最小化误差平方和\n$$\nS=\\sum_{i=1}^{n}\\left(P(x_{i})-y_{i}\\right)^{2}。\n$$\n将 $P(x)$ 在单项式基底下写为\n$$\nP(x)=\\sum_{k=0}^{n-1}a_{k}x^{k},\n$$\n其系数向量为 $a=(a_{0},a_{1},\\dots,a_{n-1})^{\\top}$。定义范德蒙矩阵 $V\\in\\mathbb{R}^{n\\times n}$ 为\n$$\nV_{ik}=x_{i}^{k-1}\\quad\\text{for}\\quad i=1,\\dots,n,\\;k=1,\\dots,n,\n$$\n和数据向量 $y=(y_{1},\\dots,y_{n})^{\\top}$。对所有 $i$ 的插值条件 $P(x_{i})=y_{i}$ 等价于线性系统\n$$\nVa=y.\n$$\n因为 $x_{i}$ 是互不相同的，所以范德蒙行列式满足\n$$\n\\det(V)=\\prod_{1\\le i<j\\le n}(x_{j}-x_{i})\\neq 0,\n$$\n所以 $V$ 是可逆的，并且存在唯一的 $a=V^{-1}y$，从而得到一个次数至多为 $n-1$ 的多项式 $P$，使得对所有 $i$ 都有 $P(x_{i})=y_{i}$。\n\n对于这个 $P$，误差平方和为\n$$\nS=\\sum_{i=1}^{n}\\left(P(x_{i})-y_{i}\\right)^{2}=\\sum_{i=1}^{n}0^{2}=0.\n$$\n由于 $S$ 是平方和，对于任何次数至多为 $n-1$ 的多项式，都有 $S\\ge 0$。因此，能够达到 $S=0$ 表明其最小值是\n$$\nS_{\\min}=0.\n$$\n这与“一个唯一的、次数至多为 $n-1$ 的多项式会穿过 $n$ 个具有不同x坐标的点”的陈述完全吻合，所以正确选项是B。而C是错误的，因为范德蒙矩阵的奇异性会阻止这种完美拟合。", "answer": "$$\\boxed{B}$$", "id": "2194113"}, {"introduction": "前面的练习解决了“如何拟合”和“拟合的极限”，现在我们来应对一个更真实、更复杂的工程挑战：“如何选择最佳模型？”。在实际应用中，我们通常不知道数据背后的真实函数形式，因此需要在一系列候选模型（例如，不同次数的多项式）中做出选择。本练习引入了模型选择的关键技术，即使用训练集来拟合模型，并利用一个独立的验证集来评估模型的泛化能力，从而选择最优的多项式次数。掌握这种方法能帮助你有效避免过拟合，构建出在新数据上表现同样出色的预测模型。[@problem_id:2194119]", "problem": "一个工程团队正在对一种新型无源电子元件进行特性分析，该元件的电阻是一个外部控制参数的函数。为了建立该行为的预测模型，他们收集了一组实验数据点，其中 $x$ 是控制参数的值（单位任意），$y$ 是测得的电阻值（单位为欧姆）。\n\n该团队希望使用多项式函数 $P_d(x) = \\sum_{j=0}^{d} c_j x^j$ 来对此关系进行建模，其中 $d$ 是多项式的次数。为避免过拟合，他们将数据分成了训练集和验证集。对于给定的次数 $d$，模型的系数 $c_j$ 将通过对训练数据进行最小二乘拟合来确定。然后，选择在独立的验证数据上预测误差最小的次数 $d$ 作为最优次数。\n\n误差使用均方根误差 (RMSE) 来量化，其定义为 $E_{RMSE} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2}$，其中 $y_i$ 是真实的测量值，$\\hat{y}_i$ 是模型对 $n$ 个数据点的预测值。\n\n收集的数据如下：\n- **训练集**：$(0, 5.6)$, $(1, 3.1)$, $(2, 1.4)$, $(4, 1.6)$, $(5, 2.9)$, $(6, 5.7)$\n- **验证集**：$(0.5, 4.2)$, $(2.5, 1.0)$, $(3.5, 1.2)$, $(5.5, 4.0)$\n\n您的任务是从候选集合 $\\{1, 2, 3\\}$ 中确定最优的多项式次数 $d$，该次数通过最小化验证集上的均方根误差 (RMSE) 来最佳地模拟元件的行为。\n\n以下哪个是最优的多项式次数？\n\nA. $d=1$\n\nB. $d=2$\n\nC. $d=3$\n\nD. 三个次数得到的验证集RMSE值在两位有效数字内相等。", "solution": "我们用多项式 $P_{d}(x)=\\sum_{j=0}^{d}c_{j}x^{j}$ 对 $y$ 进行建模，该多项式通过对训练集进行最小二乘拟合得到，然后我们选择使验证集 RMSE 最小的 $d\\in\\{1,2,3\\}$。因为 $\\sqrt{\\cdot}$ 是严格递增的，所以最小化 RMSE 等价于最小化均方误差 (MSE)，即验证集上残差平方的平均值。\n\n训练数据（转换为精确分数）：$(0,\\frac{28}{5}), (1,\\frac{31}{10}), (2,\\frac{7}{5}), (4,\\frac{8}{5}), (5,\\frac{29}{10}), (6,\\frac{57}{10})$。\n验证数据：$(\\frac{1}{2},\\frac{21}{5}), (\\frac{5}{2},1), (\\frac{7}{2},\\frac{6}{5}), (\\frac{11}{2},4)$。\n\n次数 $d=1$（线性）：$P_{1}(x)=a+bx$。使用正规方程公式\n$$\nb=\\frac{n\\sum x_{i}y_{i}-(\\sum x_{i})(\\sum y_{i})}{n\\sum x_{i}^{2}-(\\sum x_{i})^{2}},\\quad\na=\\frac{\\sum y_{i}-b\\sum x_{i}}{n},\n$$\n其中 $n=6$，$\\sum x_{i}=18$，$\\sum y_{i}=\\frac{203}{10}$，$\\sum x_{i}^{2}=82$，$\\sum x_{i}y_{i}=61$，我们得到\n$$\nb=\\frac{6\\cdot 61-18\\cdot \\frac{203}{10}}{6\\cdot 82-18^{2}}=\\frac{1}{280},\\quad\na=\\frac{\\frac{203}{10}-\\frac{1}{280}\\cdot 18}{6}=\\frac{2833}{840}。\n$$\n因此 $P_{1}(x)=\\frac{2833}{840}+\\frac{1}{280}x$。验证集的预测值和残差 $r_{i}=y_{i}-\\hat{y}_{i}$ 为：\n- $x=\\frac{1}{2}$: $\\hat{y}=\\frac{5669}{1680}$, $r=\\frac{21}{5}-\\frac{5669}{1680}=\\frac{1387}{1680}$。\n- $x=\\frac{5}{2}$: $\\hat{y}=\\frac{5681}{1680}$, $r=1-\\frac{5681}{1680}=-\\frac{4001}{1680}$。\n- $x=\\frac{7}{2}$: $\\hat{y}=\\frac{5687}{1680}$, $r=\\frac{6}{5}-\\frac{5687}{1680}=-\\frac{3671}{1680}$。\n- $x=\\frac{11}{2}$: $\\hat{y}=\\frac{5699}{1680}$, $r=4-\\frac{5699}{1680}=\\frac{1021}{1680}$。\n残差平方和为：$\\sum r_{i}^{2}=\\frac{32{,}450{,}452}{1680^{2}}$。因此\n$$\n\\text{MSE}_{1}=\\frac{1}{4}\\sum r_{i}^{2}=\\frac{32{,}450{,}452}{4\\cdot 1680^{2}}=\\frac{32{,}450{,}452}{11{,}289{,}600}。\n$$\n\n次数 $d=2$（二次）：$P_{2}(x)=c_{0}+c_{1}x+c_{2}x^{2}$。使用来自训练集 $x\\in\\{0,1,2,4,5,6\\}$ 的求和项 $\\sum x^{k}$ 和 $\\sum x^{k}y$ 得到的正规方程为\n$$\n\\begin{aligned}\n6c_{0}+18c_{1}+82c_{2}&=\\frac{203}{10},\\\\\n18c_{0}+82c_{1}+414c_{2}&=61,\\\\\n82c_{0}+414c_{1}+2194c_{2}&=312.\n\\end{aligned}\n$$\n消去 $c_{0}$ 得到 $c_{1}+6c_{2}=\\frac{1}{280}$ 和 $364c_{1}+2772c_{2}=307$，由此可得\n$$\nc_{2}=\\frac{1019}{1960},\\quad c_{1}=\\frac{1}{280}-6c_{2}=-\\frac{6107}{1960},\\quad\nc_{0}=\\frac{5513}{980}。\n$$\n因此 $P_{2}(x)=\\frac{5513}{980}-\\frac{6107}{1960}x+\\frac{1019}{1960}x^{2}$，等价于\n$$\n\\hat{y}(x)=\\frac{11026-6107x+1019x^{2}}{1960}。\n$$\n验证集的预测值和残差 $r_{i}=y_{i}-\\hat{y}_{i}$ 为：\n- $x=\\frac{1}{2}$: $\\hat{y}=\\frac{32909}{7840}$, $r=\\frac{21}{5}-\\hat{y}=\\frac{19}{7840}$。\n- $x=\\frac{5}{2}$: $\\hat{y}=\\frac{8509}{7840}$, $r=1-\\hat{y}=-\\frac{669}{7840}$。\n- $x=\\frac{7}{2}$: $\\hat{y}=\\frac{8537}{7840}$, $r=\\frac{6}{5}-\\hat{y}=\\frac{871}{7840}$。\n- $x=\\frac{11}{2}$: $\\hat{y}=\\frac{33049}{7840}$, $r=4-\\hat{y}=-\\frac{1689}{7840}$。\n残差平方和：$\\sum r_{i}^{2}=\\frac{4{,}059{,}284}{7840^{2}}$。因此\n$$\n\\text{MSE}_{2}=\\frac{1}{4}\\sum r_{i}^{2}=\\frac{4{,}059{,}284}{4\\cdot 7{,}840^{2}}=\\frac{4{,}059{,}284}{245{,}862{,}400}。\n$$\n\n次数 $d=3$（三次）：$P_{3}(x)=c_{0}+c_{1}x+c_{2}x^{2}+c_{3}x^{3}$。对训练集 $x$ 值使用最高到 $\\sum x^{6}$ 的幂和以及最高到 $k=3$ 的 $\\sum x^{k}y$，正规方程为\n$$\n\\begin{aligned}\n6c_{0}+18c_{1}+82c_{2}+414c_{3}&=\\frac{203}{10},\\\\\n18c_{0}+82c_{1}+414c_{2}+2194c_{3}&=61,\\\\\n82c_{0}+414c_{1}+2194c_{2}+11958c_{3}&=312,\\\\\n414c_{0}+2194c_{1}+11958c_{2}+66442c_{3}&=\\frac{8552}{5}。\n\\end{aligned}\n$$\n消去 $c_{0}$ 得到简化的方程组\n$$\n\\begin{aligned}\n28c_{1}+168c_{2}+952c_{3}&=\\frac{1}{10},\\\\\n504c_{1}+3220c_{2}+18900c_{3}&=\\frac{1037}{10},\\\\\n952c_{1}+6300c_{2}+37876c_{3}&=\\frac{3097}{10}。\n\\end{aligned}\n$$\n由此，消去 $c_{1}$ 得到\n$$\nc_{2}+9c_{3}=\\frac{1019}{1960},\\quad 49c_{2}+459c_{3}=\\frac{1021}{40},\n$$\n所以\n$$\nc_{3}=\\frac{1}{360},\\quad c_{2}=\\frac{97}{196}。\n$$\n回代入 $28c_{1}+168c_{2}+952c_{3}=\\frac{1}{10}$ 得到\n$$\nc_{1}=-\\frac{53983}{17640},\\quad c_{0}=\\frac{1649}{294}。\n$$\n因此 $P_{3}(x)=\\frac{1649}{294}-\\frac{53983}{17640}x+\\frac{97}{196}x^{2}+\\frac{1}{360}x^{3}$。验证集的残差（通分后分母为 $141{,}120$）为：\n$$\nr_{1}=-\\frac{393}{141120},\\quad r_{2}=-\\frac{13365}{141120},\\quad r_{3}=\\frac{17001}{141120},\\quad r_{4}=-\\frac{29667}{141120}。\n$$\n残差平方和：$\\sum r_{i}^{2}=\\frac{1{,}347{,}942{,}564}{141{,}120^{2}}$。因此\n$$\n\\text{MSE}_{3}=\\frac{1}{4}\\sum r_{i}^{2}=\\frac{1{,}347{,}942{,}564}{4\\cdot 141{,}120^{2}}=\\frac{1{,}347{,}942{,}564}{79{,}659{,}417{,}600}。\n$$\n\n验证误差比较：为了精确比较 $\\text{MSE}_{2}$ 和 $\\text{MSE}_{3}$，注意到 $141{,}120=18\\cdot 7{,}840$，所以将 $\\text{MSE}_{2}$ 的分子乘以 $18^{2}=324$ 以通分：\n$$\n324\\cdot 4{,}059{,}284=1{,}315{,}208{,}016<1{,}347{,}942{,}564,\n$$\n因此 $\\text{MSE}_{2}<\\text{MSE}_{3}$。此外，$\\text{MSE}_{1}=\\frac{32{,}450{,}452}{11{,}289{,}600}$ 远大于 $\\text{MSE}_{2}$（因此 RMSE$_{1}\\gg$RMSE$_{2}$）。因此，在 $d\\in\\{1,2,3\\}$ 中，二次多项式产生的验证集 RMSE 最小。\n\n所以，最优次数为 $d=2$，对应选项 B。", "answer": "$$\\boxed{B}$$", "id": "2194119"}]}