{"hands_on_practices": [{"introduction": "复合中点法则是将一维积分近似方法直接、直观地推广到多重积分的一种方式。本练习通过将这种基于网格的方法应用于一个简单、规则的区域——单位立方体 $R=[0,1]^3$，提供了一个基础性的实践。掌握这个练习将帮助你建立对如何离散化多维空间并通过求和函数值来估算积分的坚实理解 [@problem_id:2191981]。", "problem": "一个标量场在三维区域上由函数 $f(x,y,z) = x^2 y \\exp(z)$ 定义。我们关心此函数在由不等式 $0 \\le x \\le 1$，$0 \\le y \\le 1$ 和 $0 \\le z \\le 1$ 定义的立方体区域 $R$ 上的三重积分的值。\n\n使用复合中点法则来估计积分 $I = \\iiint_R f(x,y,z) \\,dV$ 的值。该估计应基于将区域 $R$ 划分为更小的相同立方体，沿 x 轴、y 轴和 z 轴各使用 2 个划分。\n\n将积分的估计值以单个闭式解析表达式的形式给出。", "solution": "我们应用三维复合中点法则。将单位立方体 $R=[0,1]^{3}$ 划分为 $2 \\times 2 \\times 2$ 个相同的子立方体。步长为 $h_{x}=\\frac{1}{2}$，$h_{y}=\\frac{1}{2}$ 和 $h_{z}=\\frac{1}{2}$，因此每个子立方体的体积为 $\\Delta V=h_{x}h_{y}h_{z}=\\frac{1}{8}$。沿每个坐标轴的中点为 $x^{*} \\in \\{\\frac{1}{4},\\frac{3}{4}\\}$，$y^{*} \\in \\{\\frac{1}{4},\\frac{3}{4}\\}$ 和 $z^{*} \\in \\{\\frac{1}{4},\\frac{3}{4}\\}$。\n\n复合中点法则给出\n$$\nI \\approx \\sum_{i=1}^{2}\\sum_{j=1}^{2}\\sum_{k=1}^{2} f\\!\\left(x_{i}^{*},y_{j}^{*},z_{k}^{*}\\right)\\,\\Delta V.\n$$\n由于 $f(x,y,z)=x^{2}y\\exp(z)$ 是可分离的，该和式可以因式分解为：\n$$\n\\sum_{i,j,k} f\\!\\left(x_{i}^{*},y_{j}^{*},z_{k}^{*}\\right)\n=\\left(\\sum_{i=1}^{2} \\left(x_{i}^{*}\\right)^{2}\\right)\\left(\\sum_{j=1}^{2} y_{j}^{*}\\right)\\left(\\sum_{k=1}^{2} \\exp\\!\\left(z_{k}^{*}\\right)\\right).\n$$\n计算每个因子：\n$$\n\\sum_{i=1}^{2} \\left(x_{i}^{*}\\right)^{2}\n=\\left(\\frac{1}{4}\\right)^{2}+\\left(\\frac{3}{4}\\right)^{2}\n=\\frac{1}{16}+\\frac{9}{16}\n=\\frac{10}{16}\n=\\frac{5}{8},\n$$\n$$\n\\sum_{j=1}^{2} y_{j}^{*}\n=\\frac{1}{4}+\\frac{3}{4}\n=1,\n$$\n$$\n\\sum_{k=1}^{2} \\exp\\!\\left(z_{k}^{*}\\right)\n=\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right).\n$$\n因此，\n$$\nI \\approx \\Delta V \\cdot \\frac{5}{8} \\cdot 1 \\cdot \\left(\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right)\\right)\n=\\frac{1}{8}\\cdot \\frac{5}{8}\\left(\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right)\\right)\n=\\frac{5}{64}\\left(\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right)\\right).\n$$", "answer": "$$\\boxed{\\frac{5}{64}\\left(\\exp\\left(\\frac{1}{4}\\right)+\\exp\\left(\\frac{3}{4}\\right)\\right)}$$", "id": "2191981"}, {"introduction": "并非所有的数值积分都依赖于结构化网格；概率方法提供了一种强大的替代方案，尤其适用于高维或复杂的问题。本练习将介绍蒙特卡洛方法，它基于大数定律，通过随机抽样来近似积分值。通过一个假设的模拟实验，你将估算一个概率，这本质上是一个面积计算，从而直观地理解概率与积分之间的联系 [@problem_id:2191964]。", "problem": "一个计算模型通过从区间 $[0,1]$ 上的均匀随机分布中独立选择坐标 $x$ 和 $y$ 来生成点 $(x,y)$。这个过程有效地从单位正方形中采样点。如果一个点的坐标满足不等式 $y > \\sin(\\pi x)$，则该点被视为一次“命中”。\n\n进行了一次模拟，总共生成了 $N = 1000$ 个随机点。在这次模拟中，总共有 358 个点被记录为命中。\n\n根据这次模拟的结果，单位正方形中随机选择一个点是命中的估计概率是多少？将您的答案表示为保留三位有效数字的小数。", "solution": "该模拟对独立对 $(X,Y)$ 进行采样，其中 $X \\sim \\text{Uniform}(0,1)$ 且 $Y \\sim \\text{Uniform}(0,1)$。定义命中事件 $H=\\{Y>\\sin(\\pi X)\\}$。在有 $N$ 次独立试验的蒙特卡洛模拟中，命中概率 $p=\\mathbb{P}(H)$ 的标准无偏估计量是命中的样本比例：\n$$\n\\hat{p}=\\frac{k}{N},\n$$\n其中 $k$ 是观测到的命中次数。\n\n给定 $N=1000$ 和 $k=358$，我们计算\n$$\n\\hat{p}=\\frac{358}{1000}=0.358.\n$$\n保留三位有效数字后，$0.358$ 保持不变。", "answer": "$$\\boxed{0.358}$$", "id": "2191964"}, {"introduction": "现实世界的应用常常涉及在非矩形区域上的积分，标准的网格方法无法直接适用。本练习将介绍一种至关重要的专业技巧：使用变量变换将复杂区域（一个平行四边形）映射到一个简单的单位正方形上。你将首先推导这个变换及其雅可比行列式 $|J|$，然后在变换后的简单积分上应用标准的数值方法，从而将解析处理与数值近似联系起来 [@problem_id:2191987]。", "problem": "考虑函数 $f(x,y) = (x-y)^2$ 在 $xy$-平面内一个平行四边形区域 $R$ 上的积分。平行四边形 $R$ 的顶点为点 $V_1 = (1, 2)$、$V_2 = (4, 3)$、$V_3 = (2, 6)$ 和 $V_4 = (5, 7)$。\n\n您的任务是近似计算二重积分 $I = \\iint_R f(x,y) \\,dA$。\n\n为此，首先请确定一个仿射变换 $T(u,v) = (x(u,v), y(u,v))$，该变换将 $uv$-平面中单位正方形 $S = [0,1] \\times [0,1]$ 的四个顶点 $(0,0), (1,0), (0,1), (1,1)$ 分别映射到平行四边形 $R$ 的四个顶点 $V_1, V_2, V_3, V_4$。然后，使用此变换进行积分换元，将变量从 $(x,y)$ 变换为 $(u,v)$。\n\n最后，基于一个 $2 \\times 2$ 的均匀子正方形网格，使用复合中点法则来近似计算在单位正方形 $S$ 上的所得积分。\n\n计算此近似的数值。将最终答案四舍五入至四位有效数字。", "solution": "本题要求对积分 $I = \\iint_R (x-y)^2 \\,dA$ 进行数值近似计算，其中 $R$ 是一个顶点为 $V_1=(1,2)$、$V_2=(4,3)$、$V_3=(2,6)$ 和 $V_4=(5,7)$ 的平行四边形。近似计算需通过将积分变换到单位正方形 $S = [0,1] \\times [0,1]$ 上，然后应用一个基于 $2 \\times 2$ 网格的复合中点法则来完成。\n\n首先，我们求出将 $uv$-平面中的单位正方形 $S$ 映射到 $xy$-平面中的平行四边形 $R$ 的仿射变换 $T(u,v) = (x(u,v), y(u,v))$。仿射变换具有以下一般形式：\n$$x(u,v) = x_0 + au + cv$$\n$$y(u,v) = y_0 + bu + dv$$\n\n我们使用给定的顶点映射关系：\n1.  $T(0,0) = (1,2)$:\n    $x(0,0) = x_0 = 1$\n    $y(0,0) = y_0 = 2$\n2.  $T(1,0) = (4,3)$:\n    $x(1,0) = x_0 + a(1) + c(0) = 1 + a = 4 \\implies a = 3$\n    $y(1,0) = y_0 + b(1) + d(0) = 2 + b = 3 \\implies b = 1$\n3.  $T(0,1) = (2,6)$:\n    $x(0,1) = x_0 + a(0) + c(1) = 1 + c = 2 \\implies c = 1$\n    $y(0,1) = y_0 + b(0) + d(1) = 2 + d = 6 \\implies d = 4$\n\n因此，该仿射变换为：\n$$x(u,v) = 1 + 3u + v$$\n$$y(u,v) = 2 + u + 4v$$\n\n我们可以用第四个顶点来验证：$T(1,1) = (1+3+1, 2+1+4) = (5,7)$，结果正确。\n\n接下来，我们应用二重积分的换元公式：\n$I = \\iint_R f(x,y) \\,dx\\,dy = \\iint_S f(x(u,v), y(u,v)) \\left| \\det(J) \\right| \\,du\\,dv$\n其中 $J$ 是变换 $T$ 的雅可比矩阵。\n$$J = \\begin{pmatrix} \\frac{\\partial x}{\\partial u} & \\frac{\\partial x}{\\partial v} \\\\ \\frac{\\partial y}{\\partial u} & \\frac{\\partial y}{\\partial v} \\end{pmatrix} = \\begin{pmatrix} 3 & 1 \\\\ 1 & 4 \\end{pmatrix}$$\n雅可比行列式为 $\\det(J) = (3)(4) - (1)(1) = 12 - 1 = 11$。\n其绝对值为 $|\\det(J)| = 11$。由于这是一个常数，平行四边形的面积是单位正方形面积的 $11$ 倍。\n\n现在，我们对被积函数 $f(x,y) = (x-y)^2$ 进行变换：\n$x - y = (1 + 3u + v) - (2 + u + 4v) = -1 + 2u - 3v$\n所以，$f(x(u,v), y(u,v)) = (-1 + 2u - 3v)^2$。\n\n积分变为：\n$I = \\int_0^1 \\int_0^1 (-1 + 2u - 3v)^2 \\cdot 11 \\,du\\,dv$\n令新的被积函数为 $g(u,v) = 11(-1 + 2u - 3v)^2$。\n\n我们需要使用基于 $2 \\times 2$ 网格的复合中点法则来近似此积分。单位正方形 $S$ 被划分为四个子正方形，每个的面积为 $\\Delta A = 0.5 \\times 0.5 = 0.25$。这些子正方形的中点为：\n$(u_1, v_1) = (0.25, 0.25)$\n$(u_2, v_2) = (0.75, 0.25)$\n$(u_3, v_3) = (0.25, 0.75)$\n$(u_4, v_4) = (0.75, 0.75)$\n\n积分的近似值由下式给出：\n$I \\approx \\sum_{i=1}^{4} g(u_i,v_i) \\Delta A = 0.25 \\left[ g(0.25, 0.25) + g(0.75, 0.25) + g(0.25, 0.75) + g(0.75, 0.75) \\right]$\n\n我们在每个中点处计算 $g(u,v)$ 的值：\n1.  $g(0.25, 0.25) = 11(-1 + 2(0.25) - 3(0.25))^2 = 11(-1 + 0.5 - 0.75)^2 = 11(-1.25)^2 = 11(1.5625) = 17.1875$\n2.  $g(0.75, 0.25) = 11(-1 + 2(0.75) - 3(0.25))^2 = 11(-1 + 1.5 - 0.75)^2 = 11(-0.25)^2 = 11(0.0625) = 0.6875$\n3.  $g(0.25, 0.75) = 11(-1 + 2(0.25) - 3(0.75))^2 = 11(-1 + 0.5 - 2.25)^2 = 11(-2.75)^2 = 11(7.5625) = 83.1875$\n4.  $g(0.75, 0.75) = 11(-1 + 2(0.75) - 3(0.75))^2 = 11(-1 + 1.5 - 2.25)^2 = 11(-1.75)^2 = 11(3.0625) = 33.6875$\n\n现在，我们将这些值求和并乘以 $\\Delta A$：\n$I \\approx 0.25 (17.1875 + 0.6875 + 83.1875 + 33.6875) = 0.25 (134.75) = 33.6875$\n\n最后，我们将结果四舍五入到四位有效数字。\n$I \\approx 33.69$。", "answer": "$$\\boxed{33.69}$$", "id": "2191987"}]}