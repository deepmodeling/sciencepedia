{"hands_on_practices": [{"introduction": "第一个练习将带你直接应用复合梯形法则。我们将通过对一个发光二极管（LED）中随时间变化的电流 $I(t)$ 进行积分，来计算流经该设备的总电荷 $Q$。这个练习旨在巩固应用该方法的基本步骤：划分区间、在离散点上评估函数值，并根据公式将结果加权求和。通过这个具体的物理情景 [@problem_id:2210513]，你将熟练掌握复合梯形法则的核心计算过程。", "problem": "在一个表征新型发光二极管（LED）特性的实验中，测量了通过该器件的随时间变化的电流 $I(t)$。在从 $t=0$ s 到 $t=T$ 的时间区间内，电流对电压脉冲的响应由以下函数建模：\n$$I(t) = I_0 \\left(1 + \\alpha t^2\\right) \\exp(-\\beta t) \\cos^2(\\omega t)$$\n其中 $t$ 是时间，单位为秒。在此时间区间内流过LED的总电荷量 $Q$ 由电流对时间的积分给出。\n\n使用具有 $n$ 个子区间的复化梯形法则，近似计算流过该器件的总电荷量 $Q$。\n\n实验参数如下：\n- 峰值电流比例因子, $I_0 = 0.50$ A\n- 时间区间长度, $T = 1.0$ s\n- 多项式系数, $\\alpha = 0.20 \\text{ s}^{-2}$\n- 指数衰减率, $\\beta = 0.80 \\text{ s}^{-1}$\n- 角频率, $\\omega = 2\\pi \\text{ rad/s}$\n- 子区间数量, $n = 4$\n\n计算总电荷量 $Q$。以库仑（C）为单位表示你的答案，并四舍五入到三位有效数字。", "solution": "总电荷量是电流在该区间上的时间积分：\n$$Q=\\int_{0}^{T} I(t)\\,dt,$$\n其中 $I(t)=I_{0}\\left(1+\\alpha t^{2}\\right)\\exp(-\\beta t)\\cos^{2}(\\omega t)$。\n\n使用具有 $n$ 个子区间和步长 $h=T/n$ 的复化梯形法则，近似值为\n$$Q_{\\text{trap}}=\\frac{h}{2}\\left[I(t_{0})+2\\sum_{k=1}^{n-1}I(t_{k})+I(t_{n})\\right],$$\n其中 $t_{k}=kh$。\n\n代入给定参数 $I_{0}=0.50$, $T=1.0$, $\\alpha=0.20$, $\\beta=0.80$, $\\omega=2\\pi$, $n=4$。那么\n$$h=\\frac{T}{n}=\\frac{1.0}{4}=0.25,$$\n节点为 $t_{0}=0$, $t_{1}=0.25$, $t_{2}=0.50$, $t_{3}=0.75$, $t_{4}=1.00$。\n\n计算 $I(t_{k})$：\n- 在 $t_{0}=0$ 处：\n$$I(t_{0})=0.50\\left(1+0.20\\cdot 0^{2}\\right)\\exp(0)\\cos^{2}(2\\pi\\cdot 0)=0.50.$$\n- 在 $t_{1}=0.25$ 处：\n$$\\cos^{2}(2\\pi\\cdot 0.25)=\\cos^{2}\\!\\left(\\frac{\\pi}{2}\\right)=0 \\;\\Rightarrow\\; I(t_{1})=0.$$\n- 在 $t_{2}=0.50$ 处：\n$$I(t_{2})=0.50\\left(1+0.20\\cdot 0.50^{2}\\right)\\exp(-0.80\\cdot 0.50)\\cos^{2}(\\pi)=0.50\\cdot 1.05\\cdot \\exp(-0.40)\\cdot 1=0.525\\,\\exp(-0.40).$$\n- 在 $t_{3}=0.75$ 处：\n$$\\cos^{2}(2\\pi\\cdot 0.75)=\\cos^{2}\\!\\left(\\frac{3\\pi}{2}\\right)=0 \\;\\Rightarrow\\; I(t_{3})=0.$$\n- 在 $t_{4}=1.00$ 处：\n$$I(t_{4})=0.50\\left(1+0.20\\cdot 1^{2}\\right)\\exp(-0.80\\cdot 1)\\cos^{2}(2\\pi)=0.50\\cdot 1.20\\cdot \\exp(-0.80)\\cdot 1=0.60\\,\\exp(-0.80).$$\n\n应用梯形公式：\n$$Q_{\\text{trap}}=\\frac{0.25}{2}\\left[0.50+2(0+0.525\\,\\exp(-0.40)+0)+0.60\\,\\exp(-0.80)\\right].$$\n等价地，\n$$Q_{\\text{trap}}=0.25\\left[\\frac{1}{2}\\cdot 0.50+0+0.525\\,\\exp(-0.40)+0+\\frac{1}{2}\\cdot 0.60\\,\\exp(-0.80)\\right].$$\n\n计算数值：\n$$\\exp(-0.40)\\approx 0.670320046,\\quad \\exp(-0.80)\\approx 0.449328964,$$\n$$Q_{\\text{trap}}\\approx 0.25\\left[0.25+0.525\\cdot 0.670320046+0.30\\cdot 0.449328964\\right] \\approx 0.25\\left[0.25+0.351918024+0.134798689\\right]\\approx 0.25\\cdot 0.736716713\\approx 0.184179178.$$\n\n四舍五入到三位有效数字，总电荷量为 $0.184$ C。", "answer": "$$\\boxed{0.184}$$", "id": "2210513"}, {"introduction": "简单地应用数值方法得出一个近似值是不够的，保证结果的准确性同样至关重要。这个练习将探讨复合梯形法则误差界限的实际应用 [@problem_id:2210520]。通过一个药代动力学模型的案例，你将确定为达到预定精度所需的最小子区间数 $n$。这个过程将锻炼你在数值分析中的一项关键技能：如何规划计算以满足特定的精度要求。", "problem": "在一项药代动力学研究中，一种新药在患者血液中的浓度被建模为时间 $t$ 的函数，方程为 $C(t) = C_0 \\exp(-kt^2)$。此处，$t$ 是注射后的时间（单位：小时），$C_0 = 50 \\text{ mg/L}$ 是初始浓度，$k = 0.5 \\text{ hr}^{-2}$ 是一个与药物消除速率相关的常数。\n\n为了评估前两个小时内的总药物暴露量，一位生物医学工程师需要计算曲线下面积（AUC），其由定积分 $A = \\int_{0}^{T} C(t) dt$ 给出，其中 $T=2$ 小时。\n\n该工程师使用了一种数值近似方法。时间区间 $[0, T]$ 被分成 $n$ 个相等的子区间，积分值通过对每个子区间上由连接点 $(t_i, C(t_i))$ 和 $(t_{i+1}, C(t_{i+1}))$ 形成的梯形面积求和来近似。\n\n对于这种特定的数值方法，其绝对误差 $|E_n|$ 已知受以下不等式约束：\n$$|E_n| \\le \\frac{M(T-0)^3}{12n^2}$$\n其中 $M$ 是浓度函数二阶导数的最大绝对值，$M = \\max_{t \\in [0, T]} |C''(t)|$。\n\n确定该工程师必须使用的最小整数子区间数 $n$，以保证计算出的AUC的绝对误差小于 $10^{-3} \\text{ mg}\\cdot\\text{hr/L}$。", "solution": "给定 $C(t) = C_{0}\\exp(-k t^{2})$，其中 $C_{0} = 50$ 且 $k = 0.5$，以及梯形法则误差界\n$$|E_{n}| \\le \\frac{M(T-0)^{3}}{12 n^{2}}, \\quad M = \\max_{t \\in [0,T]} |C''(t)|, \\quad T=2.$$\n\n首先计算 $C''(t)$。求导得，\n$$C'(t) = C_{0}\\exp(-k t^{2})(-2 k t),$$\n$$C''(t) = C_{0}\\exp(-k t^{2})\\left(-2k + 4k^{2} t^{2}\\right) = 2k C_{0}\\exp(-k t^{2})\\left(2k t^{2} - 1\\right).$$\n因此\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left| 2k t^{2} - 1 \\right|.$$\n\n令 $t_{0} = \\frac{1}{\\sqrt{2k}}$。对于 $t \\in [0,t_{0}]$，我们有 $2k t^{2} - 1 \\le 0$，所以\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left(1 - 2k t^{2}\\right).$$\n定义 $h_{1}(t) = 2k C_{0}\\exp(-k t^{2})(1 - 2k t^{2})$。其导数为\n$$h_{1}'(t) = 4 k^{2} C_{0} t \\exp(-k t^{2})\\left(2k t^{2} - 3\\right).$$\n在 $(0,t_{0}]$ 上，因为 $t_{0}^{2} = \\frac{1}{2k}$，我们有 $2k t^{2} - 3 \\le 1 - 3 = -2 < 0$，因此 $h_{1}'(t) < 0$。所以 $h_{1}$ 在 $[0,t_{0}]$ 上是递减的，并在 $t=0$ 处取得其最大值：\n$$h_{1}(0) = 2k C_{0}.$$\n\n对于 $t \\in [t_{0},T]$，我们有 $2k t^{2} - 1 \\ge 0$，所以\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left(2k t^{2} - 1\\right).$$\n定义 $h_{2}(t) = 2k C_{0}\\exp(-k t^{2})(2k t^{2} - 1)$。其导数为\n$$h_{2}'(t) = 4 k^{2} C_{0} t \\exp(-k t^{2})\\left(3 - 2k t^{2}\\right).$$\n区间 $[t_{0},T]$ 内的临界点在 $t = \\sqrt{\\frac{3}{2k}}$ 处出现，如果该点位于区间内。当 $k = 0.5$ 时，我们有 $t_{0} = 1$，$T=2$，且 $\\sqrt{\\frac{3}{2k}} = \\sqrt{3} \\in [1,2]$。计算各候选点处的 $h_{2}$ 值：\n- 在 $t = t_{0}$ 处，$h_{2}(t_{0}) = 0$。\n- 在 $t = \\sqrt{\\frac{3}{2k}}$ 处，因为 $2k t^{2} = 3$，\n$$h_{2}\\!\\left(\\sqrt{\\frac{3}{2k}}\\right) = 2k C_{0} \\cdot 2 \\cdot \\exp\\!\\left(-\\frac{3}{2}\\right) = 4k C_{0}\\exp\\!\\left(-\\frac{3}{2}\\right).$$\n- 在 $t = T=2$ 处，\n$$h_{2}(2) = 2k C_{0}\\left(8k - 1\\right)\\exp(-4k).$$\n\n将这些值与 $2k C_{0}$ 进行比较。注意到\n$$4k C_{0}\\exp\\!\\left(-\\frac{3}{2}\\right) = 2k C_{0}\\cdot 2\\exp\\!\\left(-\\frac{3}{2}\\right) < 2k C_{0}$$\n因为 $\\exp\\!\\left(\\frac{3}{2}\\right) > 2$，所以 $2\\exp(-\\frac{3}{2}) < 1$。此外，对于 $k=0.5$，$h_{2}(2)$ 也小于 $2k C_{0}$。因此，在 $[0,2]$ 上的最大值在 $t=0$ 处取得：\n$$M = \\max_{t \\in [0,2]} |C''(t)| = 2k C_{0} = 2 \\cdot 0.5 \\cdot 50 = 50.$$\n\n应用 $T=2$ 的误差界：\n$$|E_{n}| \\le \\frac{M T^{3}}{12 n^{2}} = \\frac{50 \\cdot 2^{3}}{12 n^{2}} = \\frac{100}{3 n^{2}}.$$\n要求 $|E_{n}| < 10^{-3}$：\n$$\\frac{100}{3 n^{2}} < 10^{-3} \\quad \\Longleftrightarrow \\quad n^{2} > \\frac{100}{3 \\cdot 10^{-3}} = \\frac{100000}{3}.$$\n因此 $n > \\sqrt{\\frac{100000}{3}}$。因为 $182^{2} = 33124 < \\frac{100000}{3} \\approx 33333.3$ 且 $183^{2} = 33489 > \\frac{100000}{3}$，所以满足该不等式的最小整数 $n$ 是\n$$n = 183.$$", "answer": "$$\\boxed{183}$$", "id": "2210520"}, {"introduction": "我们如何在不显著增加计算量的情况下获得更精确的结果呢？本练习将介绍一种强大的精度提升技术——理查森外推法（Richardson extrapolation）。通过巧妙地结合使用不同步长（即子区间数量分别为 $n$ 和 $2n$）的梯形法则得到的两个近似结果，我们可以消除主要的误差项，从而获得一个更高阶的数值近似 [@problem_id:2210511]。这个方法展示了如何从已有的计算结果中“提炼”出更准确的信息。", "problem": "一颗科研卫星被设计用于测量其穿过一片行星状星云时特定类型的宇宙辐射。测量到的辐射通量 $F(t)$ 是时间 $t$ 的函数，其变化遵循以下模型：\n$$F(t) = F_0 \\exp\\left(-\\frac{t^2}{\\tau^2}\\right) \\cos(\\omega t)$$\n在观测期间，卫星探测器接收到的单位面积总能量，称为能流 $\\Phi$，由通量的时间积分给出。\n\n给定以下观测参数：\n-   峰值通量，$F_0 = 100.0 \\, \\text{J/(m}^2 \\cdot \\text{s)}$\n-   特征时间，$\\tau = 2.0 \\, \\text{s}$\n-   角频率，$\\omega = 0.5 \\, \\text{rad/s}$\n\n你的任务是估算从 $t=0$ s 到 $t=2.0$ s 的总能流。为此，首先使用复合梯形法则计算积分的两个近似值：一个使用 $n=2$ 个子区间，另一个使用 $2n=4$ 个子区间。然后，利用这两个近似值执行一步理查森外推，以求得更精确的能流值。\n\n计算总能流 $\\Phi$ 的最终外推值。答案以焦耳每平方米（$\\text{J/m}^2$）为单位，并四舍五入到四位有效数字。", "solution": "能流是观测窗口内通量的时间积分：\n$$\n\\Phi=\\int_{0}^{2}F(t)\\,dt=\\int_{0}^{2}F_{0}\\exp\\left(-\\frac{t^{2}}{\\tau^{2}}\\right)\\cos(\\omega t)\\,dt.\n$$\n使用复合梯形法则，有 $n$ 个子区间，步长为 $h=\\frac{b-a}{n}$，\n$$\nT_{n}=h\\left[\\frac{F(a)+F(b)}{2}+\\sum_{i=1}^{n-1}F(a+ih)\\right],\n$$\n其中 $a=0$ 且 $b=2$。\n\n对于 $n=2$，$h=1$，节点为 $t_{0}=0, t_{1}=1, t_{2}=2$。给定 $F_{0}=100, \\tau=2, \\omega=0.5$，\n$$\nF(t)=100\\,\\exp\\left(-\\frac{t^{2}}{4}\\right)\\cos\\left(0.5\\,t\\right).\n$$\n计算：\n$$\nF(0)=100,\n$$\n$$\nF(1)=100\\,\\exp\\left(-\\frac{1}{4}\\right)\\cos\\left(0.5\\right)\\approx 68.3461986304491,\n$$\n$$\nF(2)=100\\,\\exp(-1)\\cos(1)\\approx 19.8766110346413.\n$$\n因此，\n$$\nT_{2}=1\\left[\\frac{100+19.8766110346413}{2}+68.3461986304491\\right]\\approx 128.28450414776973.\n$$\n\n对于 $n=4$, $h=0.5$, 节点为 $t=0,0.5,1.0,1.5,2.0$。计算额外的点：\n$$\nF(0.5)=100\\,\\exp\\left(-\\frac{(0.5)^{2}}{4}\\right)\\cos\\left(0.25\\right)\\approx 91.0208985544476,\n$$\n$$\nF(1.5)=100\\,\\exp\\left(-\\frac{(1.5)^{2}}{4}\\right)\\cos\\left(0.75\\right)\\approx 41.69037505318272.\n$$\n然后，\n$$\nT_{4}=0.5\\left[\\frac{100+19.8766110346413}{2}+91.0208985544476+68.3461986304491+41.69037505318272\\right]\\approx 130.49788887770003.\n$$\n\n对于梯形法则，误差展开式具有 $T(h)=I+C h^{2}+O(h^{4})$ 的形式，因此单步理查森外推给出\n$$\n\\Phi \\approx \\frac{4T(h/2)-T(h)}{3}=\\frac{4T_{4}-T_{2}}{3}.\n$$\n代入计算出的值，\n$$\n\\frac{4\\cdot 130.49788887770003-128.28450414776973}{3}\\approx 131.23568378767678.\n$$\n四舍五入到四位有效数字，得到 $131.2$ J/m$^{2}$。", "answer": "$$\\boxed{131.2}$$", "id": "2210511"}]}