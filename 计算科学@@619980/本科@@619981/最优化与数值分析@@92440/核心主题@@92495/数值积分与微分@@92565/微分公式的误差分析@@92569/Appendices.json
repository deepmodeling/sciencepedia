{"hands_on_practices": [{"introduction": "我们不仅要学会使用现成的数值微分公式，更要理解它们是如何从基本原理中构建出来的。本练习将引导你使用泰勒级数和待定系数法来推导一阶导数的差分近似公式。通过这个实践，你将揭开中心差分等常见数值公式的神秘面纱，并掌握一种构建自定义数值格式的强大技术 [@problem_id:2169453]。", "problem": "考虑使用一个足够光滑的函数 $f(x)$ 在三个等距点 $x-h$、$x$ 和 $x+h$ 上的值的线性组合来近似其一阶导数 $f'(x)$ 的任务，其中 $h$ 是一个小的正步长。所提出的近似具有以下一般形式：\n$$ f'(x) \\approx A f(x-h) + B f(x) + C f(x+h) $$\n您的目标是确定作为步长 $h$ 的函数的系数 $A$、$B$ 和 $C$。必须选择这些系数，使得该公式对于任意二次或更低次的多项式都能得到导数的精确值。\n\n请以一个行矩阵的形式给出您的答案，其中按顺序包含系数 $A$、$B$ 和 $C$ 的符号表达式。", "solution": "我们假设 $f$ 足够光滑，并使用泰勒级数将 $f(x\\pm h)$ 在点 $x$ 处展开：\n$$\nf(x+h)=f(x)+h f'(x)+\\frac{h^{2}}{2} f''(x)+\\frac{h^{3}}{6} f^{(3)}(x)+\\cdots,\n$$\n$$\nf(x-h)=f(x)-h f'(x)+\\frac{h^{2}}{2} f''(x)-\\frac{h^{3}}{6} f^{(3)}(x)+\\cdots.\n$$\n构建线性组合：\n$$\nA f(x-h)+B f(x)+C f(x+h).\n$$\n代入泰勒展开式并合并同类项可得\n$$\nA f(x-h)+B f(x)+C f(x+h)=(A+B+C)f(x)+(C-A)h f'(x)+(A+C)\\frac{h^{2}}{2} f''(x)+(C-A)\\frac{h^{3}}{6} f^{(3)}(x)+\\cdots.\n$$\n为了对任意二次或更低次的多项式都能精确地得到 $f'(x)$，我们必须匹配 $f(x)$、$f'(x)$ 和 $f''(x)$ 的系数，得到：\n$$\nA+B+C=0,\\qquad (C-A)h=1,\\qquad (A+C)\\frac{h^{2}}{2}=0.\n$$\n由 $A+C=0$ 可得 $C=-A$。将其代入 $(C-A)h=1$ 得到 $(-A-A)h=-2Ah=1$，于是 $A=-\\frac{1}{2h}$，因此 $C=\\frac{1}{2h}$。最后，由 $A+B+C=0$ 可得 $B=0$。\n\n因此，系数为 $A=-\\frac{1}{2h}$、$B=0$ 和 $C=\\frac{1}{2h}$，这就得到了对于二次及二次以下多项式精确的中心差分公式。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{2h} & 0 & \\frac{1}{2h}\\end{pmatrix}}$$", "id": "2169453"}, {"introduction": "推导出公式后，下一个关键步骤是分析其精度。本练习将聚焦于量化我们之前构建的中心差分公式的截断误差。你将运用泰勒展开来精确地找到误差的主导项，从而在解析层面上深刻理解近似精度如何依赖于步长 $h$ [@problem_id:2169420]。", "problem": "在数值分析中，中心差分公式是逼近函数导数的一种常用方法。对于一个足够光滑的函数 $f(x)$，其一阶导数 $f'(x)$ 可以用以下公式逼近：\n$$\nD(h) = \\frac{f(x+h) - f(x-h)}{2h}\n$$\n其中 $h$ 是一个很小的步长。该逼近的截断误差定义为 $E(x, h) = D(h) - f'(x)$。对于小的 $h$ 值，该误差可以表示为 $h$ 的幂级数，其主项决定了误差的行为。该主项的形式为 $C(x)h^p$，其中 $p$ 为某个整数，$C(x)$ 是一个依赖于 $f(x)$ 性质的函数。\n\n考虑具体函数 $f(x) = \\alpha x^4$，其中 $\\alpha$ 是一个非零常数。已知对于中心差分公式，该逼近具有二阶精度，这意味着主误差项的 $p=2$。你的任务是确定主误差项 $C(x)h^2$ 中函数 $C(x)$ 的精确表达式。", "solution": "我们从一阶导数的中心差分逼近开始，\n$$\nD(h) = \\frac{f(x+h) - f(x-h)}{2h},\n$$\n并将截断误差定义为 $E(x,h) = D(h) - f'(x)$。使用 $f(x \\pm h)$ 在 $x$ 点的泰勒展开，\n$$\nf(x+h) = f(x) + f'(x)h + \\frac{f''(x)}{2}h^{2} + \\frac{f^{(3)}(x)}{6}h^{3} + \\frac{f^{(4)}(x)}{24}h^{4} + \\frac{f^{(5)}(x)}{120}h^{5} + \\cdots,\n$$\n$$\nf(x-h) = f(x) - f'(x)h + \\frac{f''(x)}{2}h^{2} - \\frac{f^{(3)}(x)}{6}h^{3} + \\frac{f^{(4)}(x)}{24}h^{4} - \\frac{f^{(5)}(x)}{120}h^{5} + \\cdots.\n$$\n将两式相减再除以 $2h$ 得到\n$$\nD(h) = f'(x) + \\frac{f^{(3)}(x)}{6}h^{2} + \\frac{f^{(5)}(x)}{120}h^{4} + \\cdots,\n$$\n因此主截断误差项为\n$$\nE(x,h) = \\frac{f^{(3)}(x)}{6}h^{2} + O(h^{4}).\n$$\n对于 $f(x) = \\alpha x^{4}$，我们计算其各阶导数：\n$$\nf'(x) = 4\\alpha x^{3}, \\quad f''(x) = 12\\alpha x^{2}, \\quad f^{(3)}(x) = 24\\alpha x, \\quad f^{(5)}(x) = 0.\n$$\n因此，\n$$\nE(x,h) = \\frac{24\\alpha x}{6}h^{2} = 4\\alpha x\\, h^{2},\n$$\n这表明主误差项的 $p=2$ 且\n$$\nC(x) = 4\\alpha x.\n$$\n作为一致性检验，我们对该多项式精确地计算 $D(h)$：\n$$\nf(x+h) - f(x-h) = \\alpha\\big((x+h)^{4} - (x-h)^{4}\\big) = \\alpha\\big(8x^{3}h + 8x h^{3}\\big),\n$$\n所以\n$$\nD(h) = \\frac{\\alpha(8x^{3}h + 8x h^{3})}{2h} = 4\\alpha x^{3} + 4\\alpha x h^{2},\n$$\n因此 $E(x,h) = 4\\alpha x h^{2}$，这证实了 $C(x) = 4\\alpha x$。", "answer": "$$\\boxed{4\\alpha x}$$", "id": "2169420"}, {"introduction": "在本节的最后一个练习中，我们将让理论与实践相结合，通过具体计算来验证我们对误差的分析预测。你将把中心差分公式应用于一个具体的三角函数，并计算在给定步长 $h$ 下的近似误差。这个练习将连接抽象的误差分析与具体的数值结果，从而巩固你对误差 $O(h^2)$ 行为的理解 [@problem_id:2169444]。", "problem": "一位数值分析课程的学生正在研究使用中心差分公式近似函数一阶导数时产生的误差。对于函数 $f(x)$ 在点 $x_0$ 处的导数，使用小步长 $h$ 的中心差分近似 $D_h(f, x_0)$ 由下式给出：\n$$D_h(f, x_0) = \\frac{f(x_0+h) - f(x_0-h)}{2h}$$\n对于一个足够光滑的函数，此近似的绝对误差，定义为 $E(h) = |D_h(f, x_0) - f'(x_0)|$，预计与步长的平方成正比。当 $h$ 很小时，这种关系可以表示为 $E(h) \\approx C h^2$，其中 $C$ 是某个非零常数。\n\n你的任务是对于函数 $f(x) = \\cos(2x)$ 在点 $x_0 = \\frac{\\pi}{6}$ 处，计算这个常数 $C$ 的一个数值估计。为此，请使用步长 $h = 0.01$ 和公式 $C \\approx \\frac{E(h)}{h^2}$。\n\n确保所有三角计算都以弧度为单位进行。将最终答案四舍五入到四位有效数字。", "solution": "我们已知 $f(x)=\\cos(2x)$，$x_{0}=\\frac{\\pi}{6}$，以及 $h=0.01$。中心差分为\n$$\nD_{h}(f,x_{0})=\\frac{f(x_{0}+h)-f(x_{0}-h)}{2h}\n=\\frac{\\cos(2x_{0}+2h)-\\cos(2x_{0}-2h)}{2h}.\n$$\n使用和差化积公式 $\\cos A-\\cos B=-2\\sin\\left(\\frac{A+B}{2}\\right)\\sin\\left(\\frac{A-B}{2}\\right)$，并令 $A=2x_{0}+2h$ 和 $B=2x_{0}-2h$，可得\n$$\nD_{h}(f,x_{0})=\\frac{-2\\sin(2x_{0})\\sin(2h)}{2h}\n=-\\frac{\\sin(2x_{0})}{h}\\sin(2h).\n$$\n精确导数是 $f'(x)=-2\\sin(2x)$，因此\n$$\nf'(x_{0})=-2\\sin(2x_{0}).\n$$\n在 $x_{0}=\\frac{\\pi}{6}$ 处，$2x_{0}=\\frac{\\pi}{3}$ 且 $\\sin\\!\\left(\\frac{\\pi}{3}\\right)=\\frac{\\sqrt{3}}{2}$，因此\n$$\nD_{h}(f,x_{0})=-\\frac{\\sqrt{3}}{2}\\,\\frac{\\sin(2h)}{h},\n\\qquad\nf'(x_{0})=-\\sqrt{3}.\n$$\n因此，绝对误差是\n$$\nE(h)=\\left|D_{h}(f,x_{0})-f'(x_{0})\\right|\n=\\sqrt{3}\\left|1-\\frac{1}{2}\\frac{\\sin(2h)}{h}\\right|.\n$$\n当 $h=0.01$ (弧度)，$2h=0.02$ 时，使用泰勒级数 $\\sin x=x-\\frac{x^{3}}{3!}+\\frac{x^{5}}{5!}-\\frac{x^{7}}{7!}+\\cdots$，我们计算\n$$\n\\sin(0.02)\\approx 0.01999866669333308.\n$$\n然后\n$$\n\\frac{1}{2}\\frac{\\sin(0.02)}{0.01}=50\\sin(0.02)\\approx 0.999933334666654,\n$$\n所以\n$$\n\\left|1-\\frac{1}{2}\\frac{\\sin(2h)}{h}\\right|\n=\\left|1-50\\sin(0.02)\\right|\\approx 6.6665333346\\times 10^{-5}.\n$$\n因此\n$$\nE(h)\\approx \\sqrt{3}\\times 6.6665333346\\times 10^{-5}\\approx 1.154677444\\times 10^{-4}.\n$$\n所求的估计值为\n$$\nC\\approx \\frac{E(h)}{h^{2}}=\\frac{1.154677444\\times 10^{-4}}{(0.01)^{2}}\n\\approx 1.154677444.\n$$\n四舍五入到四位有效数字，得到 $C\\approx 1.155$。", "answer": "$$\\boxed{1.155}$$", "id": "2169444"}]}