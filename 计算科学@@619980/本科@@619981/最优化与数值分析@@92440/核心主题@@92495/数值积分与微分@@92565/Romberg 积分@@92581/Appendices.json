{"hands_on_practices": [{"introduction": "掌握任何一种新算法的第一步都是通过具体计算来建立直观的认识。这个练习将引导你手动计算龙贝格表中最开始的几个关键项。通过处理一个简单的多项式积分，你将亲手实践复合梯形法则的应用，并执行第一次理查森外推，从而直观地体验龙贝格积分是如何通过迭代来系统性地提高近似精度的 [@problem_id:2198730]。", "problem": "龙贝格积分是一种通过对梯形法则的结果应用理查森外推法来估计函数定积分的数值方法。这些估计值被组织在一个称为龙贝格表的三角形阵列中，记为 $R_{k,j}$。第一列 $R_{k,1}$ (对于 $k \\geq 1$) 是使用具有 $n = 2^{k-1}$ 个子区间的复化梯形法则生成的。后续的项使用以下递推公式计算：\n$$R_{k,j} = R_{k,j-1} + \\frac{1}{4^{j-1} - 1}(R_{k,j-1} - R_{k-1,j-1}) \\quad \\text{for } k \\geq j \\geq 2.$$\n\n考虑多项式函数 $f(x) = 4x^3 - 3x^2 + 5$ 在区间 $[0, 2]$ 上的定积分。你的任务是为该积分手动计算龙贝格表的前三项。\n\n计算 $R_{1,1}$、$R_{2,1}$ 和 $R_{2,2}$ 的值。将你的答案以精确整数形式表示为包含三个数值 $(R_{1,1}, R_{2,1}, R_{2,2})$ 的行向量。", "solution": "我们在 $[a,b]=[0,2]$ 上对 $f(x)=4x^{3}-3x^{2}+5$ 进行积分。具有 $n$ 个子区间且宽度为 $h=\\frac{b-a}{n}$ 的复化梯形法则为\n$$\nT_{n}=\\frac{h}{2}\\left(f(a)+2\\sum_{i=1}^{n-1}f(a+ih)+f(b)\\right).\n$$\n根据定义，$R_{k,1}=T_{2^{\\,k-1}}$。\n\n对于 $R_{1,1}$，取 $n=1$ 于是 $h=2$。计算 $f(0)=5$ 以及 $f(2)=4\\cdot 2^{3}-3\\cdot 2^{2}+5=32-12+5=25$。那么\n$$\nR_{1,1}=T_{1}=\\frac{2}{2}\\left(f(0)+f(2)\\right)=1\\cdot(5+25)=30.\n$$\n\n对于 $R_{2,1}$，取 $n=2$ 于是 $h=1$，节点为 $0,1,2$。计算 $f(1)=4-3+5=6$。那么\n$$\nR_{2,1}=T_{2}=\\frac{1}{2}\\left(f(0)+2f(1)+f(2)\\right)=\\frac{1}{2}\\left(5+2\\cdot 6+25\\right)=\\frac{42}{2}=21.\n$$\n\n龙贝格外推法使用\n$$\nR_{k,j}=R_{k,j-1}+\\frac{1}{4^{\\,j-1}-1}\\left(R_{k,j-1}-R_{k-1,j-1}\\right), \\quad k\\geq j\\geq 2.\n$$\n因此，\n$$\nR_{2,2}=R_{2,1}+\\frac{1}{4^{1}-1}\\left(R_{2,1}-R_{1,1}\\right)=21+\\frac{1}{3}(21-30)=21-\\frac{9}{3}=18.\n$$\n\n作为一致性检验，其精确积分为\n$$\n\\int_{0}^{2}\\left(4x^{3}-3x^{2}+5\\right)\\,dx=\\left(x^{4}-x^{3}+5x\\right)\\bigg|_{0}^{2}=16-8+10=18,\n$$\n与 $R_{2,2}$ 的值一致，这对于三次多项式是预料之中的。", "answer": "$$\\boxed{\\begin{pmatrix}30 & 21 & 18\\end{pmatrix}}$$", "id": "2198730"}, {"introduction": "在掌握了基本计算之后，一个自然而然的问题是：龙贝格积分的威力究竟有多大？这个练习将带你从计算转向理论，探究该方法的精度阶数。通过分析龙贝格积分对于多项式函数的表现，你将揭示出算法的核心优势：每一列外推都能够精确地积分越来越高阶的多项式，这正是其高效性的来源 [@problem_id:2198758]。", "problem": "龙贝格积分是一种用于估算函数定积分的数值方法，它将逐次理查森外推应用于复合梯形法则的结果。其结果通常被组织在一个称为龙贝格积分表的三角形阵列中，表项记为 $T_{m,k}$。\n\n第一列，$T_{m,0}$ ($m = 0, 1, 2, \\ldots$)，包含使用 $2^m$ 个子区间的复合梯形法则得到的近似值。后续各列由以下递推关系式生成：\n$$\nT_{m, k} = T_{m, k-1} + \\frac{T_{m, k-1} - T_{m-1, k-1}}{4^k - 1} \\quad \\text{for } k \\ge 1\n$$\n每一列 $k$ 都代表了更高阶的精度。对于一个足够光滑的函数，积分表中的值会收敛到积分的真值。\n\n考虑对一个任意的5次多项式进行积分。存在一个最小的列标 $k$，使得对于任何足够大的行标 $m$，结果 $T_{m,k}$ 不再是一个近似值，而是积分的精确值。这个最小的 $k$ 值是多少？\n\nA. 1\n\nB. 2\n\nC. 3\n\nD. 4\n\nE. 5", "solution": "设积分为 $I=\\int_{a}^{b} f(x)\\,dx$，并设 $h=(b-a)/2^{m}$。步长为 $h$ 的复合梯形法则是 $T(h)=T_{m,0}$。根据梯形法则的 Euler–Maclaurin 展开式，\n$$\nI=T(h)+\\sum_{n=1}^{\\infty}\\frac{B_{2n}}{(2n)!}h^{2n}\\left(f^{(2n-1)}(b)-f^{(2n-1)}(a)\\right),\n$$\n其中 $B_{2n}$ 是伯努利数。如果 $f$ 是一个5次多项式，那么对于 $k\\geq 6$ 有 $f^{(k)}\\equiv 0$，因此该级数在 $n=3$ (即 $h^{6}$ 项) 之后被截断。此外，对于 $n=3$，$f^{(5)}$ 是常数，因此 $f^{(5)}(b)-f^{(5)}(a)=0$，所以 $h^{6}$ 项恒为零。因此，对于5次多项式，该展开式是精确的，并简化为\n$$\nI=T(h)+c_{2}h^{2}+c_{4}h^{4},\n$$\n其中 $c_{2}=\\frac{B_{2}}{2!}\\left(f'(b)-f'(a)\\right)$ 且 $c_{4}=\\frac{B_{4}}{4!}\\left(f^{(3)}(b)-f^{(3)}(a)\\right)$。\n\n对步长 $2h$ 写出同样的公式：\n$$\nI=T(2h)+c_{2}(2h)^{2}+c_{4}(2h)^{4}.\n$$\n因此\n$$\nT(h)-T(2h)=\\left[I-c_{2}h^{2}-c_{4}h^{4}\\right]-\\left[I-c_{2}(2h)^{2}-c_{4}(2h)^{4}\\right]\n=3c_{2}h^{2}+15c_{4}h^{4}.\n$$\n第一次龙贝格外推（$k=1$列）为\n$$\nT_{m,1}=T(h)+\\frac{T(h)-T(2h)}{4-1}\n=I-c_{2}h^{2}-c_{4}h^{4}+\\left(c_{2}h^{2}+5c_{4}h^{4}\\right)\n=I+4c_{4}h^{4},\n$$\n这样 $h^{2}$ 项就被消除了，剩余误差为 $O(h^{4})$。\n\n为进行第二次外推，对步长 $2h$ 应用同样的方法。我们有\n$$\nT_{m-1,1}=T(2h)+\\frac{T(2h)-T(4h)}{4-1}=I+4c_{4}(2h)^{4}=I+64c_{4}h^{4}.\n$$\n因此，第二次龙贝格外推（$k=2$列）为\n$$\nT_{m,2}=T_{m,1}+\\frac{T_{m,1}-T_{m-1,1}}{4^{2}-1}\n=\\left(I+4c_{4}h^{4}\\right)+\\frac{\\left(I+4c_{4}h^{4}\\right)-\\left(I+64c_{4}h^{4}\\right)}{16-1}\n=I+4c_{4}h^{4}-\\frac{60c_{4}h^{4}}{15}\n=I.\n$$\n因此，对于任何5次多项式，$T_{m,2}$ 都等于积分的精确值（对于任何使这些量有定义的 $m$；因此满足了“$m$足够大”的条件）。等价地，龙贝格积分的第 $k$ 列具有 $2k+1$ 次代数精度，因此 $k=2$ 的情况可以精确地对所有次数不超过5的多项式进行积分。\n\n因此最小的 $k$ 值为2。", "answer": "$$\\boxed{B}$$", "id": "2198758"}, {"introduction": "标准的龙贝格积分法是基于一个重要假设：被积函数的泰勒展开误差项仅包含步长 $h$ 的偶数次幂。然而，在实际应用中，我们可能会遇到行为更复杂的函数。此练习模拟了这样一个情景，挑战你当误差不再具有标准形式时的应对策略，这将迫使你回归理查森外推法的本质，学习如何修改和调整公式以适应新的情况，从而培养更灵活和深刻的数值分析能力 [@problem_id:2198771]。", "problem": "一位工程师正在一个长度为 $L$ 的区间上，使用一个新的数值积分库测试一个专有的、非平凡的函数 $f(x)$。他们使用复合梯形法则，并尝试使用龙贝格外推法来提高精度。使用 $N=2^{i-1}$ 个子区间的梯形法则近似值记为 $R_{i,0}$。该近似的步长为 $h_i = L/2^{i-1}$。龙贝格表格的第一列计算得出为：\n\n$R_{1,0} = 2.79159265$\n$R_{2,0} = 2.85096765$\n$R_{3,0} = 2.97030359$\n$R_{4,0} = 3.04905115$\n\n该工程师观察到，收敛性并非如对一个非常光滑的函数所预期的那样是二阶的。对被积函数 $f(x)$ 的理论分析表明，梯形法则近似的误差 $E(h_i) = I - R_{i,0}$（其中 $I$ 是积分的真值）有一个以步长 $h_i$ 的整数次幂展开的完整渐近展开式。也就是说，$E(h_i) \\sim \\sum_{k=1}^{\\infty} C_k h_i^k$，对于某些非零系数 $C_k$，而不是一个仅含 $h_i$ 偶数次幂的展开式。\n\n基于此信息，确定构建龙贝格表格的正确外推程序。使用此程序，根据给定数据计算积分的最精确的可能估计值，该值对应于 $R_{4,3}$。\n\n将最终答案表示为一个四舍五入到五位有效数字的实数。", "solution": "复合梯形近似值为 $R_{i,0}$，步长为 $h_{i} = L/2^{i-1}$。误差满足一个以所有整数次幂展开的渐近展开式，\n$$\nR_{i,0} = I + \\sum_{k=1}^{\\infty} C_{k} h_{i}^{k}, \\quad C_{k} \\neq 0 \\text{ in general}.\n$$\n由于 $h_{i-1} = 2 h_{i}$，两个连续的近似值展开为\n$$\nR_{i,0} = I + C_{1} h_{i} + C_{2} h_{i}^{2} + C_{3} h_{i}^{3} + \\cdots,\n$$\n$$\nR_{i-1,0} = I + C_{1} (2 h_{i}) + C_{2} (2 h_{i})^{2} + C_{3} (2 h_{i})^{3} + \\cdots = I + \\sum_{k=1}^{\\infty} C_{k} 2^{k} h_{i}^{k}.\n$$\n为了消除首项 $h_{i}^{1}$，构建因子为 2 的理查森组合：\n$$\nR_{i,1} = \\frac{2 R_{i,0} - R_{i-1,0}}{2 - 1} = 2 R_{i,0} - R_{i-1,0}.\n$$\n其误差从 $O(h_{i}^{2})$ 开始。重复此逻辑，经过 $j-1$ 次外推后，首项误差为 $O(h_{i}^{j})$，因此下一次消元使用因子 $2^{j}$。因此，对于一个以所有整数次幂展开的误差，正确的类龙贝格递推关系是\n$$\nR_{i,j} = \\frac{2^{j} R_{i,j-1} - R_{i-1,j-1}}{2^{j} - 1}, \\quad j \\geq 1.\n$$\n\n使用给定的第一列：\n$$\nR_{1,0} = 2.79159265,\\quad R_{2,0} = 2.85096765,\\quad R_{3,0} = 2.97030359,\\quad R_{4,0} = 3.04905115,\n$$\n计算该表格：\n\n第一次外推 ($j=1$):\n$$\nR_{2,1} = 2 R_{2,0} - R_{1,0} = 2.91034265,\n$$\n$$\nR_{3,1} = 2 R_{3,0} - R_{2,0} = 3.08963953,\n$$\n$$\nR_{4,1} = 2 R_{4,0} - R_{3,0} = 3.12779871.\n$$\n\n第二次外推 ($j=2$):\n$$\nR_{3,2} = \\frac{4 R_{3,1} - R_{2,1}}{3} = \\frac{4 \\cdot 3.08963953 - 2.91034265}{3} = 3.1494051566666667,\n$$\n$$\nR_{4,2} = \\frac{4 R_{4,1} - R_{3,1}}{3} = \\frac{4 \\cdot 3.12779871 - 3.08963953}{3} = 3.1405184366666667.\n$$\n\n第三次外推 ($j=3$):\n$$\nR_{4,3} = \\frac{8 R_{4,2} - R_{3,2}}{7} = \\frac{8 \\cdot 3.1405184366666667 - 3.1494051566666667}{7} = 3.139249048095238.\n$$\n\n因此，根据给定数据得出的最精确估计值是 $R_{4,3} \\approx 3.139249048095238$，四舍五入到五位有效数字后为 $3.1392$。", "answer": "$$\\boxed{3.1392}$$", "id": "2198771"}]}