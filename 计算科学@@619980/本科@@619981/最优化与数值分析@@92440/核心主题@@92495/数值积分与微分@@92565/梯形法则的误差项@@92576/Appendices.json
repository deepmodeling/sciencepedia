{"hands_on_practices": [{"introduction": "梯形法则误差项的一个主要实际应用是在执行计算之前预估所需的工作量。通过使用误差界公式，我们可以确定为达到特定精度要求所需的最少子区间数 $n$。这个练习将带你亲身实践这一核心技能，即如何为一个给定的积分和期望的误差容限，计算出必要的子区间数量。[@problem_id:2170455]", "problem": "一位数值分析师的任务是使用复合梯形法则来近似计算定积分 $I = \\int_{0}^{\\pi/2} \\exp(x) \\cos(x) \\, dx$。对于在区间 $[a, b]$ 上使用 $n$ 个子区间的函数 $f(x)$，该方法的误差 $E_T$ 由以下不等式界定：\n$$|E_T| \\le \\frac{K(b-a)^3}{12n^2}$$\n其中 $K$ 是满足 $|f''(x)| \\le K$ (对于所有 $x \\in [a, b]$) 的任意数。\n\n为保证近似的绝对误差最多为 $10^{-4}$，所需的最小子区间整数数量 $n$ 是多少？", "solution": "我们应用复合梯形法则的误差界\n$$|E_{T}| \\le \\frac{K(b-a)^{3}}{12 n^{2}},$$\n其中 $K$ 在 $[a,b]$ 上满足 $|f''(x)| \\le K$。对于在 $[0,\\frac{\\pi}{2}]$ 上的函数 $f(x)=\\exp(x)\\cos(x)$，计算其导数：\n$$f'(x)=\\exp(x)(\\cos x-\\sin x),$$\n$$f''(x)=\\exp(x)(\\cos x-\\sin x) + \\exp(x)(-\\sin x-\\cos x) = -2\\,\\exp(x)\\sin x.$$\n因此，\n$$|f''(x)|=2\\,\\exp(x)|\\sin x|=2\\,\\exp(x)\\sin x \\quad \\text{for } x \\in \\left[0,\\frac{\\pi}{2}\\right].$$\n令 $g(x)=\\exp(x)\\sin x$。则在 $\\left(0,\\frac{\\pi}{2}\\right)$ 上，$g'(x)=\\exp(x)(\\sin x+\\cos x)>0$，所以 $g$ 是递增的，并在 $x=\\frac{\\pi}{2}$ 处达到其最大值。因此，\n$$K=\\max_{x \\in [0,\\frac{\\pi}{2}]} |f''(x)| = 2\\,\\exp\\!\\left(\\frac{\\pi}{2}\\right).$$\n当 $a=0, b=\\frac{\\pi}{2}$ 时，误差界变为\n$$|E_{T}| \\le \\frac{2\\,\\exp\\!\\left(\\frac{\\pi}{2}\\right)\\left(\\frac{\\pi}{2}\\right)^{3}}{12 n^{2}} = \\frac{\\exp\\!\\left(\\frac{\\pi}{2}\\right)\\pi^{3}}{48\\,n^{2}}.$$\n为保证 $|E_{T}| \\le 10^{-4}$，我们需要\n$$\\frac{\\exp\\!\\left(\\frac{\\pi}{2}\\right)\\pi^{3}}{48\\,n^{2}} \\le 10^{-4} \\quad \\Longrightarrow \\quad n \\ge \\sqrt{\\frac{\\exp\\!\\left(\\frac{\\pi}{2}\\right)\\pi^{3}\\times 10^{4}}{48}}.$$\n现在进行数值计算以确定最小整数 $n$：\n$$\\exp\\!\\left(\\frac{\\pi}{2}\\right) \\approx 4.810477380965351, \\quad \\pi^{3} \\approx 31.0062766802998,$$\n$$\\exp\\!\\left(\\frac{\\pi}{2}\\right)\\pi^{3} \\approx 149.154992638,$$\n$$\\frac{\\exp\\!\\left(\\frac{\\pi}{2}\\right)\\pi^{3}\\times 10^{4}}{48} \\approx 31073.9568038,$$\n$$\\sqrt{31073.9568038} \\approx 176.28.$$\n因此，满足该界的最小整数 $n$ 是 $n=177$。", "answer": "$$\\boxed{177}$$", "id": "2170455"}, {"introduction": "这个练习将传统问题反转过来，为你提供一个独特视角来理解误差公式。在某些特殊情况下，例如对于二次函数，由于其二阶导数是常数，误差公式 $|E_T| \\le \\frac{K(b-a)^3}{12n^2}$ 中的 $\\xi$ 不再是未知数，从而使得误差可以被精确计算。我们将利用这一特性，仅根据一个近似计算结果和误差理论，反向推导出积分的精确值，从而加深对近似值、精确值和误差之间关系的理解。[@problem_id:2170474]", "problem": "一位环境分析员正在对一个工厂烟囱的污染物排放率进行建模。该排放率记为 $R(t)$，由函数 $R(t) = k t^2$ 给出，其中 $t$ 是运行开始后的小时数，$R(t)$ 的单位是千克/小时 (kg/hr)。常数 $k$ 是一个与该工厂工艺流程相关的特定参数。\n\n为了确定运行第一个小时内（即时间间隔从 $t=0$ 到 $t=1$）排放的污染物总质量，该分析员使用单区间（$n=1$）的梯形法则进行了一次快速计算。该近似计算得到的总质量为 $M_{approx} = 50.0$ kg。\n\n与梯形法则相关的误差定义为 $E_T = M_{exact} - M_{approx}$，其中 $M_{exact}$ 是真实的总质量。该误差的理论公式为 $E_T = -\\frac{(b-a)^3}{12n^2} f''(\\xi)$，其中 $[a, b]$ 是积分区间，$\\xi$ 是 $(a, b)$ 内的某个值。对于这个特定的二次速率函数 $R(t)$，其二阶导数 $R''(t)$ 是一个常数，这使得误差 $E_T$ 可以被精确计算。\n\n利用分析员的近似值和提供的误差公式，求出第一个小时内排放的污染物精确总质量 $M_{exact}$。您的答案以千克为单位，并四舍五入到三位有效数字。", "solution": "在某一时间间隔内排放的总质量等于排放率的时间积分，因此在 $[0,1]$ 区间上的精确质量是\n$$\nM_{\\text{exact}}=\\int_{0}^{1} R(t)\\,dt=\\int_{0}^{1} k t^{2}\\,dt=\\left.\\frac{k t^{3}}{3}\\right|_{0}^{1}=\\frac{k}{3}.\n$$\n在 $[a,b]=[0,1]$ 上使用单区间的梯形法则是\n$$\nM_{\\text{approx}}=T_{1}=\\frac{b-a}{2}\\left(R(a)+R(b)\\right)=\\frac{1}{2}\\left(R(0)+R(1)\\right)=\\frac{1}{2}\\left(0+k\\right)=\\frac{k}{2}.\n$$\n已知 $M_{\\text{approx}}=50.0$，这意味着\n$$\n\\frac{k}{2}=50.0 \\quad\\Rightarrow\\quad k=100.\n$$\n梯形误差由 $E_{T}=M_{\\text{exact}}-M_{\\text{approx}}$ 定义，对于复化梯形法则，其误差公式为\n$$\nE_{T}=-\\frac{(b-a)^{3}}{12 n^{2}} f''(\\xi).\n$$\n此处，$f(t)=R(t)=k t^{2}$ 的二阶导数 $f''(t)=R''(t)=2k$ 是一个常数，且 $a=0$，$b=1$，$n=1$，我们得到\n$$\nE_{T}=-\\frac{1^{3}}{12\\cdot 1^{2}}\\cdot 2k=-\\frac{k}{6}.\n$$\n因此，\n$$\nM_{\\text{exact}}=M_{\\text{approx}}+E_{T}=M_{\\text{approx}}-\\frac{k}{6}=50.0-\\frac{100}{6}=\\frac{150-50}{3}=\\frac{100}{3}.\n$$\n从数值上看，$\\frac{100}{3}=33.333\\ldots$，四舍五入到三位有效数字后是 $33.3$。", "answer": "$$\\boxed{33.3}$$", "id": "2170474"}, {"introduction": "数值分析中充满了有趣的“悖论”，它们往往能揭示更深层次的原理。在这个练习中，我们将探索一个奇特的情景：梯形法则对某个特定积分给出了完全精确的结果，但其理论误差界却是一个非零值。通过分析这个案例，你将学会区分“实际误差”和“误差上限”这两个重要概念，并理解由于函数和积分区间的对称性而产生的误差抵消现象，这是数值方法中一个强大而微妙的效应。[@problem_id:2170446]", "problem": "考虑定积分 $I = \\int_{-a}^{a} x^3 \\, dx$，其中 $a$ 是一个正实常数。我们希望分析复化梯形法则对此积分的性能。\n\n首先，通过直接计算证明，两区间复化梯形法则（$n=2$）可以得出 $I$ 的精确值。\n\n其次，使用标准的复化梯形法则公式，计算该近似的理论误差界：\n$$|E_T| \\leq \\frac{(b-a)^3}{12n^2} \\max_{x \\in [a,b]} |f''(x)|$$\n其中 $[a,b]$ 是积分区间，$n$ 是子区间的数量，$f(x)$ 是被积函数。\n\n你会发现实际误差为零，但理论误差界是一个关于 $a$ 的非零函数。下列哪个陈述为解释这一明显的矛盾，提供了最正确且最具体的数学上的理由？\n\nA. 众所周知，对于任何奇函数，当积分区间关于原点对称时，梯形法则是精确的，而 $f(x)=x^3$ 正是一个奇函数。\n\nB. 在更基本的误差公式 $E_T = -\\frac{(b-a)h^2}{12}f''(\\xi)$ 中，对于这个特定的函数和区间配置，$\\xi$ 的值恰好为 $\\xi=0$。由于 $f''(0)=0$，所以误差为零。\n\nC. 标准误差界公式总是一个最坏情况下的上界。实际误差可以介于零和该界之间，而对于本问题，误差恰好为零纯属巧合。\n\nD. 复化误差是每个子区间误差的总和。简化后的全局误差界公式的推导过程隐含地假设了二阶导数不会以一种会导致系统性抵消的方式改变符号。对于对称的子区间 $[-a, 0]$ 和 $[0, a]$，由于二阶导数 $f''(x)=6x$ 的奇对称性，第一个区间的误差贡献恰好被第二个区间的误差所抵消。\n\nE. 所提供的误差界公式仅适用于在积分区间上二阶导数非负的函数，而 $f(x)=x^3$ 在 $[-a, a]$ 上不满足此条件。", "solution": "计算该积分的精确值。$f(x)=x^{3}$ 的一个原函数是 $\\frac{x^{4}}{4}$，所以\n$$\nI=\\int_{-a}^{a} x^{3}\\,dx=\\left.\\frac{x^{4}}{4}\\right|_{-a}^{a}=\\frac{a^{4}}{4}-\\frac{(-a)^{4}}{4}=0.\n$$\n\n在 $[-a,a]$ 上应用两区间复化梯形法则。步长为\n$$\nh=\\frac{a-(-a)}{2}=a,\n$$\n节点为 $x_{0}=-a$，$x_{1}=0$，$x_{2}=a$。复化梯形近似值为\n$$\nT_{2}=\\frac{h}{2}\\big(f(x_{0})+2f(x_{1})+f(x_{2})\\big)=\\frac{a}{2}\\big(f(-a)+2f(0)+f(a)\\big).\n$$\n当 $f(x)=x^{3}$ 时，可得\n$$\nT_{2}=\\frac{a}{2}\\big((-a)^{3}+2\\cdot 0^{3}+a^{3}\\big)=\\frac{a}{2}\\big(-a^{3}+a^{3}\\big)=0,\n$$\n这等于积分的精确值 $I=0$。因此，两区间复化梯形法则得出了精确值。\n\n现在计算理论误差界。标准误差界为\n$$\n|E_{T}|\\leq \\frac{(b-a)^{3}}{12 n^{2}}\\max_{x\\in[a,b]}|f''(x)|.\n$$\n此处 $[a,b]=[-a,a]$（端点为 $-a$ 和 $a$），所以 $b-a=2a$，$n=2$ 且 $f''(x)=6x$。因此，\n$$\n\\max_{x\\in[-a,a]}|f''(x)|=\\max_{x\\in[-a,a]}|6x|=6a,\n$$\n并且\n$$\n|E_{T}|\\leq \\frac{(2a)^{3}}{12\\cdot 2^{2}}\\cdot 6a=\\frac{8a^{3}}{48}\\cdot 6a=\\frac{a^{3}}{6}\\cdot 6a=a^{4}.\n$$\n因此误差界为 $a^{4}$，而实际误差为零。\n\n为解释这一点，我们观察在两个对称子区间上的精确抵消机制。对于 $f(x)=x^{3}$，在任何单个子区间 $[p,q]$ 上的精确局部梯形误差（其中 $E=I-T$）可以由 Peano 核定理的积分形式给出，或通过直接计算：\n$$\nE(p,q)=\\int_{p}^{q}x^{3}\\,dx-\\frac{q-p}{2}\\big(f(p)+f(q)\\big)\n=\\frac{q^{4}-p^{4}}{4}-\\frac{q-p}{2}\\big(p^{3}+q^{3}\\big).\n$$\n因式分解并简化：\n$$\n\\frac{q^{4}-p^{4}}{4}=\\frac{(q-p)(q+p)(q^{2}+p^{2})}{4},\\quad\n\\frac{q-p}{2}\\big(p^{3}+q^{3}\\big)=\\frac{(q-p)(p+q)(p^{2}-pq+q^{2})}{2},\n$$\n所以\n$$\nE(p,q)=(q-p)(p+q)\\left[\\frac{q^{2}+p^{2}}{4}-\\frac{p^{2}-pq+q^{2}}{2}\\right]\n=-(q-p)(p+q)\\frac{(p-q)^{2}}{4}.\n$$\n由于 $(p-q)^{2}=(q-p)^{2}$，上式变为\n$$\nE(p,q)=-\\frac{(q-p)^{3}}{4}(p+q).\n$$\n将此公式应用于两个区间 $[-a,0]$ 和 $[0,a]$（每个长度为 $a$）：\n$$\nE([-a,0])=-\\frac{(0-(-a))^{3}}{4}(-a+0)=-\\frac{a^{3}}{4}(-a)=\\frac{a^{4}}{4},\n$$\n$$\nE([0,a])=-\\frac{(a-0)^{3}}{4}(0+a)=-\\frac{a^{3}}{4}(a)=-\\frac{a^{4}}{4}.\n$$\n这两项正好相互抵消，使得总误差 $E=0$。\n\n因此，虽然基于 $\\max|f''|$ 的界 $|E_{T}|\\leq a^{4}$ 是一个有效的最坏情况上界，但实际的复化误差由于两个对称区间误差的精确抵消而消失为零，这是二阶导数 $f''(x)=6x$ 奇对称性的一个结果。在给定的选项中，这一点由选项 D 最为具体地捕捉到了。", "answer": "$$\\boxed{D}$$", "id": "2170446"}]}