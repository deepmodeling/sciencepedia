{"hands_on_practices": [{"introduction": "在数值分析中，一个核心任务是在保证计算精度的同时，最小化计算成本。本练习将带你实践一项基本技能：如何利用梯形法则的误差界限公式，来预估达到特定精度要求所需的最小子区间数 $n$。这个过程让你能够将理论误差分析直接应用于实际的计算规划中。[@problem_id:2180744]", "problem": "一名数值分析师的任务是使用复化梯形法则来近似计算定积分 $I = \\int_{0}^{\\pi} \\exp(\\cos(x)) dx$。其目标是确保近似值的绝对误差不超过指定的容差 $\\epsilon = 5.0 \\times 10^{-3}$。\n\n当使用 $n$ 个等距子区间来近似计算 $\\int_{a}^{b} f(x) dx$ 时，复化梯形法则的误差界由以下不等式给出：\n$$|E_T| \\leq \\frac{K(b-a)^3}{12n^2}$$\n其中 $K$ 是一个常数，满足对于区间 $[a, b]$ 中的所有 $x$，都有 $|f''(x)| \\leq K$。\n\n对于区间 $[0, \\pi]$ 上的特定函数 $f(x) = \\exp(\\cos(x))$，已知其二阶导数有界，一个有效的上界为常数 $K=e$ (欧拉数)。\n\n请确定所需的最小子区间数 $n$，以保证近似的绝对误差小于或等于指定的容差 $\\epsilon$。最终答案必须是整数。", "solution": "我们要求复化梯形法则的误差界至多为该容差。误差界为\n$$|E_{T}| \\leq \\frac{K(b-a)^{3}}{12 n^{2}}。$$\n为保证 $|E_{T}| \\leq \\epsilon$，只需满足\n$$\\frac{K(b-a)^{3}}{12 n^{2}} \\leq \\epsilon。$$\n对 $n$ 求解可得\n$$n^{2} \\geq \\frac{K(b-a)^{3}}{12\\,\\epsilon}, \\quad \\text{所以} \\quad n \\geq \\sqrt{\\frac{K(b-a)^{3}}{12\\,\\epsilon}}。$$\n对于 $[0,\\pi]$ 上的函数 $f(x)=\\exp(\\cos x)$，我们有 $K=e$，$a=0$，$b=\\pi$ 以及 $\\epsilon=5.0 \\times 10^{-3}$。代入得：\n$$n \\geq \\sqrt{\\frac{e\\,\\pi^{3}}{12\\,(5.0 \\times 10^{-3})}}。$$\n由于 $12\\,(5.0 \\times 10^{-3})=6.0 \\times 10^{-2}=\\frac{3}{50}$，上式可化简为\n$$n \\geq \\sqrt{\\frac{e\\,\\pi^{3}}{3/50}}=\\sqrt{\\frac{50}{3}\\,e\\,\\pi^{3}}。$$\n数值上，\n$$e\\,\\pi^{3} \\approx 84.283798678,\\quad \\frac{50}{3}\\,e\\,\\pi^{3} \\approx 1404.72997797,$$\n所以\n$$n \\geq \\sqrt{1404.72997797} \\approx 37.4797。$$\n因此，保证满足误差容差的最小整数 $n$ 是\n$$n_{\\min}=\\lceil 37.4797 \\rceil=38。$$", "answer": "$$\\boxed{38}$$", "id": "2180744"}, {"introduction": "实际应用中的数值积分问题往往比教科书中的例子更为复杂。例如，当我们划分的区间数量不满足某个特定高阶积分法则（如辛普森法则）的要求时，该怎么办？本练习将向你展示一种灵活的复合策略，通过组合使用辛普森1/3法则和3/8法则，来解决这类非标准情况，这在科学计算中是一项非常实用的技巧。[@problem_id:2180764]", "problem": "在科学计算中，一个常见的任务是计算那些没有简单原函数的函数的定积分。考虑函数 $f(x) = (x+1)\\ln(x+1)$ 在一个特定区间上的积分：\n$$I = \\int_{0}^{4} (x+1)\\ln(x+1) \\, dx$$\n你需要通过将区间 $[0, 4]$ 分成五个相等的子区间来近似计算这个积分。为了进行数值积分，你必须使用一种复合策略。对前两个子区间应用辛普森1/3法则，对剩下的三个子区间应用辛普森3/8法则。\n\n计算积分 $I$ 的近似值。将你的最终答案四舍五入到五位有效数字。", "solution": "我们将区间 $[0,4]$ 分成 $5$ 个相等的子区间，所以步长为 $h=\\frac{4-0}{5}=0.8$。节点为 $x_{0}=0$，$x_{1}=0.8$，$x_{2}=1.6$，$x_{3}=2.4$，$x_{4}=3.2$，$x_{5}=4$。设 $f(x)=(x+1)\\ln(x+1)$ 并定义 $f_{i}=f(x_{i})$。\n\n使用 $y_{i}=x_{i}+1$ 计算函数值：\n$$y_{0}=1,\\ y_{1}=1.8,\\ y_{2}=2.6,\\ y_{3}=3.4,\\ y_{4}=4.2,\\ y_{5}=5,$$\n$$f_{0}=1\\cdot \\ln 1=0,$$\n$$f_{1}=1.8\\ln(1.8)\\approx 1.0580159968236,$$\n$$f_{2}=2.6\\ln(2.6)\\approx 2.4843297570702,$$\n$$f_{3}=3.4\\ln(3.4)\\approx 4.1608364675148,$$\n$$f_{4}=4.2\\ln(4.2)\\approx 6.0273550062138,$$\n$$f_{5}=5\\ln(5)\\approx 8.0471895621700.$$\n\n对前两个子区间 $[x_{0},x_{2}]$ 应用辛普森1/3法则：\n$$I_{0\\to 2}\\approx \\frac{h}{3}\\left[f_{0}+4f_{1}+f_{2}\\right]=\\frac{0.8}{3}\\left[0+4(1.0580159968236)+2.4843297570702\\right]\\approx 1.791038331831.$$\n\n对剩下的三个子区间 $[x_{2},x_{5}]$ 应用辛普森3/8法则：\n$$I_{2\\to 5}\\approx \\frac{3h}{8}\\left[f_{2}+3f_{3}+3f_{4}+f_{5}\\right]=\\frac{3(0.8)}{8}\\left[2.4843297570702+3(4.1608364675148)+3(6.0273550062138)+8.0471895621700\\right]\\approx 12.328828122128.$$\n\n复合近似值为\n$$I\\approx I_{0\\to 2}+I_{2\\to 5}\\approx 1.791038331831+12.328828122128=14.119866453959.$$\n\n四舍五入到五位有效数字，得到 $14.120$。", "answer": "$$\\boxed{14.120}$$", "id": "2180764"}, {"introduction": "我们通常认为梯形法则只对线性函数是精确的，但这个观念并不完全正确。本练习是一个有趣的思维实验，它将挑战你的直觉，探索梯形法则在何种条件下能够精确计算一个非多项式函数的积分。通过分析误差项的性质，你将更深刻地理解数值积分方法背后的原理，以及函数对称性等特性如何影响其精度。[@problem_id:2180762]", "problem": "用于近似函数 $f(x)$ 在区间 $[a, b]$ 上积分的单区间梯形法则由 $T_1(f) = \\frac{b-a}{2}[f(a)+f(b)]$ 给出。虽然众所周知该法则对于次数为一或更低的多项式是精确的，但在特定条件下，它对于某些非线性、非多项式函数也可能同样精确。\n\n考虑一个形式为 $f(x) = A \\cos(x) + B x^2$ 的函数，其中 $A$ 和 $B$ 是非零实常数。确定比值 $A/B$ 的值，使得单区间梯形法则能够给出积分 $\\int_{-\\pi}^{\\pi} f(x) dx$ 的精确值。请以闭式解析表达式的形式给出你的答案。", "solution": "我们要求对于函数 $f(x)=A\\cos(x)+B x^{2}$，在区间 $[-\\pi,\\pi]$ 上的单区间梯形法则的计算结果等于其精确积分值。\n\n首先，利用线性和奇偶性计算精确积分：\n$$\n\\int_{-\\pi}^{\\pi} f(x)\\,dx=\\int_{-\\pi}^{\\pi} \\left(A\\cos(x)+B x^{2}\\right)\\,dx\n= A\\int_{-\\pi}^{\\pi}\\cos(x)\\,dx + B\\int_{-\\pi}^{\\pi} x^{2}\\,dx.\n$$\n由于 $\\cos(x)$ 是偶函数，且 $\\int_{-\\pi}^{\\pi}\\cos(x)\\,dx=2\\int_{0}^{\\pi}\\cos(x)\\,dx=2[\\sin(x)]_{0}^{\\pi}=0$，并且 $x^{2}$ 也是偶函数，有\n$$\n\\int_{-\\pi}^{\\pi} x^{2}\\,dx=2\\int_{0}^{\\pi} x^{2}\\,dx=2\\left[\\frac{x^{3}}{3}\\right]_{0}^{\\pi}=\\frac{2\\pi^{3}}{3},\n$$\n我们得到\n$$\n\\int_{-\\pi}^{\\pi} f(x)\\,dx = B\\cdot \\frac{2\\pi^{3}}{3}.\n$$\n\n接下来，计算单区间的梯形近似值：\n$$\nT_{1}(f)=\\frac{(\\pi-(-\\pi))}{2}\\left(f(-\\pi)+f(\\pi)\\right)=\\pi\\left(f(-\\pi)+f(\\pi)\\right).\n$$\n计算端点处的函数值：\n$$\nf(\\pi)=A\\cos(\\pi)+B\\pi^{2}=-A+B\\pi^{2},\\qquad f(-\\pi)=A\\cos(-\\pi)+B(-\\pi)^{2}=-A+B\\pi^{2}.\n$$\n因此，\n$$\nT_{1}(f)=\\pi\\left[(-A+B\\pi^{2})+(-A+B\\pi^{2})\\right]=\\pi\\left(-2A+2B\\pi^{2}\\right)=-2A\\pi+2B\\pi^{3}.\n$$\n\n为了达到精确，令 $T_{1}(f)$ 等于精确积分值：\n$$\n-2A\\pi+2B\\pi^{3}=\\frac{2B\\pi^{3}}{3}.\n$$\n重新整理并求解 $A/B$：\n$$\n-2A\\pi+2B\\pi^{3}-\\frac{2B\\pi^{3}}{3}=0\n\\;\\;\\Longrightarrow\\;\\;\n-2A\\pi+\\frac{4B\\pi^{3}}{3}=0\n\\;\\;\\Longrightarrow\\;\\;\n2A\\pi=\\frac{4B\\pi^{3}}{3}\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{A}{B}=\\frac{2\\pi^{2}}{3}.\n$$", "answer": "$$\\boxed{\\frac{2\\pi^{2}}{3}}$$", "id": "2180762"}]}