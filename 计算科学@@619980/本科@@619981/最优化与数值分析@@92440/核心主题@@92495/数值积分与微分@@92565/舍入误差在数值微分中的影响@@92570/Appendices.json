{"hands_on_practices": [{"introduction": "在数值微分中，步长 $h$ 的选择是一项至关重要的权衡。本练习将探讨截断误差（随 $h$ 减小而减小）与舍入误差（随 $h$ 减小而增大）之间的基本权衡。通过解析推导最小化总误差的最优步长，您将对计算科学中的这一核心挑战获得基础性的理解。[@problem_id:2167887]", "problem": "在数值分析领域，一个基本的挑战是平衡截断误差（源于数学近似）与舍入误差（源于有限精度硬件）。考虑使用中心差分公式计算函数 $f(x) = \\sin(x)$ 在任意点 $x=a$ 处的导数。\n\n总误差 $E_{total}(h)$ 作为步长 $h$ 的函数，被建模为这两种误差类型绝对值的和。\n对于中心差分方法，截断误差的绝对值由以下表达式给出：\n$$|E_{trunc}(h)| = \\frac{h^2}{6} |f'''(a)|$$\n舍入误差的绝对值，它源于浮点运算的限制，被建模为：\n$$|E_{round}(h)| = \\frac{\\epsilon}{h}$$\n此处，$\\epsilon$ 是一个小的正常数，代表了单次函数求值绝对误差的上界。\n\n因此，总误差由和 $E_{total}(h) = |E_{trunc}(h)| + |E_{round}(h)|$ 近似。你的任务是找到最优步长 $h_{opt}$，使得该总误差最小。\n\n请以闭式解析表达式的形式给出你的答案，该表达式应由参数 $a$ 和 $\\epsilon$ 表示。你可以假设 $\\cos(a) \\neq 0$。", "solution": "给定函数 $f(x) = \\sin(x)$以及中心差分总误差模型\n$$E_{total}(h) = |E_{trunc}(h)| + |E_{round}(h)| = \\frac{h^{2}}{6}\\,|f'''(a)| + \\frac{\\epsilon}{h}.$$\n对于 $f(x) = \\sin(x)$，其三阶导数为 $f'''(x) = -\\cos(x)$，因此 $|f'''(a)| = |\\cos(a)|$。所以，\n$$E_{total}(h) = \\frac{h^{2}}{6}\\,|\\cos(a)| + \\frac{\\epsilon}{h}, \\quad h>0.$$\n为了找到最小化误差的步长，对 $h$ 求导并将导数设为零：\n$$\\frac{dE_{total}}{dh} = \\frac{2h}{6}\\,|\\cos(a)| - \\frac{\\epsilon}{h^{2}} = \\frac{h}{3}\\,|\\cos(a)| - \\frac{\\epsilon}{h^{2}}.$$\n令 $\\frac{dE_{total}}{dh}=0$ 可得\n$$\\frac{h}{3}\\,|\\cos(a)| = \\frac{\\epsilon}{h^{2}} \\quad \\Longrightarrow \\quad \\frac{|\\cos(a)|}{3}\\,h^{3} = \\epsilon \\quad \\Longrightarrow \\quad h^{3} = \\frac{3\\epsilon}{|\\cos(a)|}.$$\n因此，\n$$h_{opt} = \\left(\\frac{3\\epsilon}{|\\cos(a)|}\\right)^{\\frac{1}{3}}.$$\n为验证这是一个极小值点，计算二阶导数：\n$$\\frac{d^{2}E_{total}}{dh^{2}} = \\frac{1}{3}\\,|\\cos(a)| + \\frac{2\\epsilon}{h^{3}},$$\n对于 $h>0$，该式严格为正，这证实了该临界点是一个极小值点。因此，最优步长是\n$$h_{opt} = \\left(\\frac{3\\epsilon}{|\\cos(a)|}\\right)^{\\frac{1}{3}}.$$", "answer": "$$\\boxed{\\left(\\frac{3\\epsilon}{|\\cos(a)|}\\right)^{\\frac{1}{3}}}$$", "id": "2167887"}, {"introduction": "数值微分的最优步长并非一个通用常数，它与执行计算的硬件深度相关。本练习将展示机器精度（由机器 $\\epsilon$ 量化）如何直接影响最优步长 $h_{opt}$。通过比较一个资源受限的16位系统和一个标准的64位系统的结果，您将看到硬件精度对数值准确性的巨大实际影响。[@problem_id:2167868]", "problem": "一位工程师正在为一个卫星的姿态控制机构开发一个实时控制系统。该系统需要在点 $x = \\pi/4$ 处计算函数 $f(x) = \\cos(x)$ 的导数，以确定一个变化率。由于处理能力的限制，该导数使用一阶前向差分公式进行近似计算：\n$$\nf'(x) \\approx \\frac{f(x+h) - f(x)}{h}\n$$\n这种数值微分的总绝对误差是绝对截断误差与绝对舍入误差之和。截断误差可以很好地由 $\\frac{h}{2}|f''(x)|$ 近似。舍入误差源于浮点运算的有限精度，并由 $\\frac{2\\epsilon |f(x)|}{h}$ 近似，其中 $\\epsilon$ 是计算机的机器精度。最优步长 $h_{opt}$ 是使这个总误差最小的 $h > 0$ 的值。\n\n工程师必须为这个计算在两个硬件平台之间做出选择：\n1.  一个带有定制16位浮点单元的资源受限嵌入式处理器，其机器精度为 $\\epsilon_{16} = 2^{-11}$。\n2.  一个使用64位双精度运算的标准地面工作站，其机器精度为 $\\epsilon_{64} = 2^{-53}$。\n\n设 $h_{opt, 16}$ 为16位系统的最优步长，$h_{opt, 64}$ 为64位系统的最优步长。计算比率 $\\frac{h_{opt, 16}}{h_{opt, 64}}$。\n\n将您的最终答案四舍五入至三位有效数字。", "solution": "前向差分导数近似的总绝对误差可建模为\n$$\nE(h)=\\frac{h}{2}\\,|f''(x)|+\\frac{2\\epsilon\\,|f(x)|}{h},\n$$\n其中第一项是截断误差，第二项是舍入误差。为求最优步长，对 $h$ 求导并令其为零：\n$$\n\\frac{dE}{dh}=\\frac{1}{2}|f''(x)|-\\frac{2\\epsilon\\,|f(x)|}{h^{2}}=0.\n$$\n对 $h$ 求解得到\n$$\nh_{\\text{opt}}=\\sqrt{\\frac{2\\epsilon\\,|f(x)|}{\\tfrac{1}{2}|f''(x)|}}=2\\sqrt{\\frac{\\epsilon\\,|f(x)|}{|f''(x)|}}.\n$$\n对于 $f(x)=\\cos(x)$，我们有 $f''(x)=-\\cos(x)$。在 $x=\\pi/4$ 处， $|f(x)|=|\\cos(\\pi/4)|=\\frac{\\sqrt{2}}{2}$ 且 $|f''(x)|=|-\\cos(\\pi/4)|=\\frac{\\sqrt{2}}{2}$，所以\n$$\n\\frac{|f(x)|}{|f''(x)|}=1,\n$$\n因此\n$$\nh_{\\text{opt}}=2\\sqrt{\\epsilon}.\n$$\n因此，两个系统之间的最优步长比率为\n$$\n\\frac{h_{\\text{opt},16}}{h_{\\text{opt},64}}=\\frac{2\\sqrt{\\epsilon_{16}}}{2\\sqrt{\\epsilon_{64}}}=\\sqrt{\\frac{\\epsilon_{16}}{\\epsilon_{64}}}=\\sqrt{\\frac{2^{-11}}{2^{-53}}}=\\sqrt{2^{42}}=2^{21}=2097152.\n$$\n四舍五入到三位有效数字，得到\n$$\n2.10\\times 10^{6}.\n$$", "answer": "$$\\boxed{2.10 \\times 10^{6}}$$", "id": "2167868"}, {"introduction": "尽管误差模型为我们提供了宏观视角，但亲眼见证误差如何累积能带来宝贵的洞察力。本练习模拟了一台假设计算机的有限精度运算，揭示了每次操作后的舍入如何导致显著的误差。通过手动追踪一个简单线性函数导数的计算过程，您将直接观察到“灾难性抵消”如何放大舍入误差——这是一种理论模型只能近似描述的现象。[@problem_id:2167890]", "problem": "在计算科学领域，理解浮点运算的局限性对于解读数值结果至关重要。考虑一个场景，一位科学家正在模拟一个由分段线性函数 $f(x)$ 控制的物理过程，该函数定义如下：\n\n$$\nf(x) = \\begin{cases} 109.995 - 2x & \\text{if } x < 50 \\\\ 9.995 + 3(x-50) & \\text{if } x \\ge 50 \\end{cases}\n$$\n\n一台假设的计算机的任务是数值估算该函数的导数。这台计算机使用一种保持5位有效数字精度的浮点标准来执行其所有计算。每次算术运算后，结果都会被舍入到其5位有效数字的表示形式。采用的舍入规则是“半值向上舍入”（例如，2.555 舍入到3位有效数字是 2.56，而 2.554 是 2.55）。\n\n该计算机使用前向有限差分公式来近似导数：\n$$\nf'(x) \\approx \\frac{f(x+h) - f(x)}{h}\n$$\n\n你的任务是确定这台计算机在点 $x = 1.0$ 处，使用步长 $h = 10^{-4}$ 计算出的 $f(x)$ 的导数值。\n\n将你的答案表示为整数。", "solution": "我们必须以5位有效数字的精度模拟计算机的运算，并在每次运算后进行“半值向上舍入”。对于 $x=1$ 附近的输入，函数使用 $f(x)=109.995-2x$ 这个分支。\n\n将 $R(\\cdot)$ 定义为使用“半值向上舍入”规则舍入到5位有效数字。\n\n首先计算 $x+h$：\n$$\nx=1.0,\\quad h=10^{-4},\\quad x+h=R(1.0+10^{-4})=R(1.0001)=1.0001.\n$$\n\n计算 $f(x)$ 在 $x=1.0$ 处的值：\n- 乘法：$R(2\\cdot 1.0)=R(2.0)=2.0000$。\n- 减法：$R(109.995-2.0000)=R(107.995)=108.00$（因为第六位有效数字是5，所以向上舍入）。\n\n因此，在计算机中 $f(1.0)=108.00$。\n\n计算 $f(x+h)$ 在 $x+h=1.0001$ 处的值：\n- 乘法：$R(2\\cdot 1.0001)=R(2.0002)=2.0002$。\n- 减法：$R(109.995-2.0002)=R(107.9948)=107.99$（因为第六位有效数字是4，所以向下舍入）。\n\n因此，在计算机中 $f(1.0001)=107.99$。\n\n构造前向差分的分子并除以 $h$：\n$$\nR\\big(f(1.0001)-f(1.0)\\big)=R(107.99-108.00)=R(-0.01)=-0.01,\n$$\n$$\nR\\left(\\frac{-0.01}{10^{-4}}\\right)=R(-100)=-100.\n$$\n\n因此，计算机在 $x=1.0$ 处，使用 $h=10^{-4}$ 计算出的导数值是 $-100$。", "answer": "$$\\boxed{-100}$$", "id": "2167890"}]}