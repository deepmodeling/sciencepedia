{"hands_on_practices": [{"introduction": "在构建一个完整的算法之前，理解其核心构件至关重要。本练习提供了一个具体情景，让你直接应用 Armijo 条件，检验一个给定的步长是否能确保目标函数值的充分下降。这个实践旨在巩固你对 Armijo 不等式本身的理解 [@problem_id:2154929]。", "problem": "在机器人领域，一位工程师正在微调一个参数 $x$，该参数控制着行走步态的稳定性。步态的不稳定性由成本函数 $J(x) = 5(x-100)^2$ 量化，其中 $x$ 是一个无量纲参数。目标是找到使 $J(x)$ 最小的 $x$ 值。优化过程从初始猜测值 $x_k = 101$ 开始。\n\n算法采用了梯度下降法。在 $x_k=101$ 处，算法计算出一个搜索方向 $p_k = -1$。为确定沿此方向前进的步长，使用了回溯线搜索，其初始试验步长为 $\\alpha = 0.1$。如果一个步长满足充分下降的 Armijo 条件，则认为该步长是可接受的：\n$$J(x_k + \\alpha p_k) \\le J(x_k) + c_1 \\alpha \\nabla J(x_k) \\cdot p_k$$\n该准则的常数设置为 $c_1 = 0.5$。\n\n基于这些值，下列哪个陈述是正确的？\n\nA. Armijo 条件不满足，因此必须减小步长 $\\alpha$。\n\nB. Armijo 条件满足，并且新的成本函数值为 $J(x_{k+1}) = 4.05$。\n\nC. Armijo 条件满足，并且新的成本函数值为 $J(x_{k+1}) = 4.50$。\n\nD. Armijo 条件不满足，但成本函数值仍然减小。\n\nE. 搜索方向 $p_k=-1$ 在 $x_k=101$ 处不是一个下降方向。", "solution": "给定成本函数 $J(x) = 5(x-100)^{2}$，当前点 $x_{k} = 101$，搜索方向 $p_{k} = -1$，初始试验步长 $\\alpha = 0.1$，以及 Armijo 条件\n$$\nJ(x_{k} + \\alpha p_{k}) \\le J(x_{k}) + c_{1}\\alpha \\nabla J(x_{k}) \\cdot p_{k},\n$$\n其中 $c_{1} = 0.5$。\n\n首先，计算 $J$ 的梯度。由于 $J(x) = 5(x-100)^{2}$，通过求导可得\n$$\n\\nabla J(x) = \\frac{d}{dx} \\left[5(x-100)^{2}\\right] = 10(x-100).\n$$\n在 $x_{k} = 101$ 处，可得\n$$\n\\nabla J(x_{k}) = 10(101 - 100) = 10.\n$$\n检验 $p_{k}$ 是否为下降方向：\n$$\n\\nabla J(x_{k}) \\cdot p_{k} = 10 \\cdot (-1) = -10 < 0,\n$$\n所以 $p_{k}$ 是一个下降方向，这排除了选项 E。\n\n计算 Armijo 条件的左侧：\n$$\nx_{k} + \\alpha p_{k} = 101 + 0.1(-1) = 100.9,\n$$\n$$\nJ(x_{k} + \\alpha p_{k}) = J(100.9) = 5(100.9 - 100)^{2} = 5(0.9)^{2} = 5 \\cdot 0.81 = 4.05.\n$$\n\n计算右侧：\n$$\nJ(x_{k}) = 5(101 - 100)^{2} = 5(1)^{2} = 5,\n$$\n$$\nJ(x_{k}) + c_{1}\\alpha \\nabla J(x_{k}) \\cdot p_{k} = 5 + 0.5 \\cdot 0.1 \\cdot (-10) = 5 - 0.5 = 4.5.\n$$\n\n比较两侧：\n$$\nJ(x_{k} + \\alpha p_{k}) = 4.05 \\le 4.5 = J(x_{k}) + c_{1}\\alpha \\nabla J(x_{k}) \\cdot p_{k}.\n$$\n因此，对于试验步长 $\\alpha = 0.1$，Armijo 条件得到满足，并且新的成本函数值为 $J(x_{k+1}) = 4.05$。\n\n这证实了选项 B 是正确的。选项 A 和 D 是错误的，因为 Armijo 条件得到了满足；选项 C 给出了一个不正确的新的成本值；选项 E 是错误的，因为 $p_{k}$ 是一个下降方向。", "answer": "$$\\boxed{B}$$", "id": "2154929"}, {"introduction": "仅仅验证单个步长只是故事的一部分；回溯算法的真正威力在于其迭代过程。本练习将你从静态的检验带入动态的搜索过程，模拟计算机如何从一个初始步长开始，系统地缩减步长 $\\alpha$ 直至满足充分下降条件。这个练习将帮助你内化完整的回溯循环机制 [@problem_id:2154887]。", "problem": "在数值优化领域，最速下降法是一种迭代算法，用于寻找函数的局部最小值。在每次迭代 $k$ 中，下一个点 $x_{k+1}$ 是通过从当前点 $x_k$ 沿负梯度方向移动一定距离来确定的。更新规则由 $x_{k+1} = x_k + \\alpha_k p_k$ 给出，其中 $p_k$ 是搜索方向，$\\alpha_k > 0$ 是步长。\n\n一种确定合适步长 $\\alpha_k$ 的常用策略是回溯线搜索。该过程从步长的初始猜测值 $\\bar{\\alpha}$ 开始，并迭代地减小它，直到函数值达到充分下降。这被形式化为 Armijo 条件。\n\n考虑最小化函数 $f(x, y) = x^2 + 4y^2$ 的任务。我们位于点 $x_k = (3, 1)$，并希望使用最速下降方向找到下一个迭代点。因此，搜索方向 $p_k$ 由 $p_k = -\\nabla f(x_k)$ 给出。\n\n为了找到步长 $\\alpha_k$，您将使用以下参数执行回溯线搜索：初始步长 $\\bar{\\alpha} = 1$，缩减因子 $\\rho = 0.5$，以及充分下降常数 $c_1 = 0.25$。过程如下：\n1. 从 $\\alpha = \\bar{\\alpha}$ 开始。\n2. 检查 Armijo 条件是否满足：$f(x_k + \\alpha p_k) \\le f(x_k) + c_1 \\alpha \\nabla f(x_k)^T p_k$。\n3. 如果条件满足，则接受的步长为 $\\alpha_k = \\alpha$。\n4. 如果条件不满足，则通过设置 $\\alpha \\leftarrow \\rho \\alpha$ 更新步长，并从步骤2重复。\n\n确定此过程产生的可接受步长 $\\alpha_k$。", "solution": "我们需要最小化 $f(x,y)=x^{2}+4y^{2}$。其梯度为 $\\nabla f(x,y)=(2x,8y)$。在点 $x_{k}=(3,1)$ 处，\n$$\n\\nabla f(x_{k})=(6,8), \\quad p_{k}=-\\nabla f(x_{k})=(-6,-8).\n$$\n参数为 $c_{1}=\\frac{1}{4}$ 且步长为 $\\alpha>0$ 的 Armijo 条件是\n$$\nf(x_{k}+\\alpha p_{k}) \\le f(x_{k}) + c_{1}\\,\\alpha\\,\\nabla f(x_{k})^{T}p_{k}.\n$$\n计算所需的量。首先，\n$$\nf(x_{k})=3^{2}+4\\cdot 1^{2}=13, \\quad \\nabla f(x_{k})^{T}p_{k}=(6,8)\\cdot(-6,-8)=-100.\n$$\n接下来，沿搜索方向进行参数化：\n$$\nx_{k}+\\alpha p_{k}=(3-6\\alpha,\\,1-8\\alpha),\n$$\n因此\n$$\nf(x_{k}+\\alpha p_{k})=(3-6\\alpha)^{2}+4(1-8\\alpha)^{2}\n=9-36\\alpha+36\\alpha^{2}+4-64\\alpha+256\\alpha^{2}\n=13-100\\alpha+292\\alpha^{2}.\n$$\n因此 Armijo 不等式变为\n$$\n13-100\\alpha+292\\alpha^{2} \\le 13 + \\frac{1}{4}\\alpha(-100) = 13-25\\alpha,\n$$\n可简化为\n$$\n-100\\alpha+292\\alpha^{2} \\le -25\\alpha \\;\\;\\Longleftrightarrow\\;\\; 292\\alpha^{2} \\le 75\\alpha.\n$$\n对于 $\\alpha>0$，这等价于\n$$\n\\alpha \\le \\frac{75}{292}.\n$$\n回溯线搜索从 $\\bar{\\alpha}=1$ 和 $\\rho=0.5$ 开始。依次测试：\n- $\\alpha=1$：由于 $1>\\frac{75}{292}$，条件不满足；将 $\\alpha$ 减小到 $0.5$。\n- $\\alpha=0.5$：由于 $0.5>\\frac{75}{292}$，条件不满足；将 $\\alpha$ 减小到 $0.25$。\n- $\\alpha=0.25$：由于 $\\frac{1}{4}\\le \\frac{75}{292}$，Armijo 条件成立。确实，\n$$\nf(x_{k}+\\tfrac{1}{4}p_{k})=13-100\\cdot \\tfrac{1}{4}+292\\cdot \\tfrac{1}{16}\n=13-25+\\frac{73}{4}=\\frac{25}{4} \\le 13-\\frac{25}{4}=\\frac{27}{4}.\n$$\n因此，接受的步长是 $\\alpha_{k}=\\frac{1}{4}$。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "2154887"}, {"introduction": "现实世界中的优化问题常常受到各种约束。这个更进一步的练习展示了如何调整回溯线搜索以处理边界约束，确保每一步不仅能带来充分的函数值下降，还能将解保持在可行域内。你将学习如何将可行性检查融入回溯循环，这是解决实际应用问题的关键技能 [@problem_id:2154884]。", "problem": "考虑一个优化问题，其目标是最小化函数 $f: \\mathbb{R}^2 \\to \\mathbb{R}$，并受约束于变量 $x = (x_1, x_2)$ 必须保持在一个简单的箱形可行域 $\\mathcal{F}$ 内。该域由下界 $l = (l_1, l_2)$ 和上界 $u = (u_1, u_2)$ 定义，使得 $\\mathcal{F} = \\{x \\in \\mathbb{R}^2 \\mid l_i \\le x_i \\le u_i, \\text{ for } i=1,2\\}$。\n\n我们将采用一种迭代下降法，其中下一个迭代点通过更新规则 $x_{k+1} = x_k + \\alpha_k p_k$ 找到。方向 $p_k$ 选择为最速下降方向，即 $p_k = -\\nabla f(x_k)$。步长 $\\alpha_k > 0$ 通过一种为处理域约束而设计的专门的回溯线搜索过程确定。\n\n在迭代 $k$ 处寻找步长 $\\alpha_k$ 的过程定义如下：\n1.  从一个给定的初始步长 $\\bar{\\alpha} > 0$、一个缩减因子 $\\rho \\in (0, 1)$ 和一个充分下降常数 $c_1 \\in (0, 1)$ 开始。\n2.  初始化当前步长测试值，$\\alpha = \\bar{\\alpha}$。\n3.  从当前迭代点 $x_k$ 和选定的方向 $p_k$，构造一个试验点 $x_{trial} = x_k + \\alpha p_k$。\n4.  首先，检查试验点是否可行：$x_{trial} \\in \\mathcal{F}$。\n5.  如果试验点可行，则检查其是否满足充分下降条件：$f(x_{trial}) \\le f(x_k) + c_1 \\alpha \\nabla f(x_k)^T p_k$。\n6.  如果步骤3中的试验点被发现是不可行的，或者它可行但在步骤5中未能满足充分下降条件，则将步长减小为 $\\alpha \\leftarrow \\rho \\alpha$，并从步骤3开始重复该过程。\n7.  第一个使得试验点同时满足可行性（步骤4）和充分下降（步骤5）的 $\\alpha$ 值被接受为当前迭代的步长，因此 $\\alpha_k = \\alpha$。\n\n对于该过程的一次迭代，您被给予以下具体细节：\n- 目标函数为 $f(x_1, x_2) = (x_1 - 4)^2 + 4(x_2 - 2)^2$。\n- 可行域 $\\mathcal{F}$ 由边界 $l = (0, 0)$ 和 $u = (5, 5)$ 定义。\n- 起始点为 $x_0 = (1, 1)$。\n- 线搜索参数为：初始步长 $\\bar{\\alpha} = 1$，缩减因子 $\\rho = 0.5$，以及充分下降常数 $c_1 = 0.1$。\n\n您的任务是确定从 $x_0$ 开始执行此约束下降过程单个步骤后，下一个迭代点 $x_1$ 的坐标。请将您的答案表示为 `(x_coord_1, x_coord_2)` 形式的行矩阵，其中包含坐标的数值。", "solution": "我们使用带有回溯线搜索的最速下降法，在箱型区域 $\\mathcal{F}=\\{x\\in\\mathbb{R}^{2}\\mid 0\\le x_{i}\\le 5,\\ i=1,2\\}$ 上最小化函数 $f(x_{1},x_{2})=(x_{1}-4)^{2}+4(x_{2}-2)^{2}$。在 $x_{0}=(1,1)$ 处，计算梯度\n$$\n\\nabla f(x)=\\begin{pmatrix}2(x_{1}-4)\\\\ 8(x_{2}-2)\\end{pmatrix},\n\\quad\n\\nabla f(x_{0})=\\begin{pmatrix}2(1-4)\\\\ 8(1-2)\\end{pmatrix}=\\begin{pmatrix}-6\\\\ -8\\end{pmatrix}.\n$$\n最速下降方向为\n$$\np_{0}=-\\nabla f(x_{0})=\\begin{pmatrix}6\\\\ 8\\end{pmatrix}.\n$$\n回溯参数为 $\\bar{\\alpha}=1$，$\\rho=0.5$ 和 $c_{1}=0.1$。我们从 $\\alpha=1$ 开始测试步长 $\\alpha$，并以 $\\rho$ 为因子进行缩减，直至同时满足可行性和充分下降条件。同时计算\n$$\nf(x_{0})=(1-4)^{2}+4(1-2)^{2}=9+4=13,\n\\quad\n\\nabla f(x_{0})^{T}p_{0}=(-6)(6)+(-8)(8)=-36-64=-100.\n$$\n\n测试 $\\alpha=1$：\n$$\nx_{\\text{trial}}=x_{0}+\\alpha p_{0}=(1,1)+(1)(6,8)=(7,9).\n$$\n可行性检查：$(7,9)\\notin[0,5]^{2}$，不可行。更新 $\\alpha \\leftarrow 0.5$。\n\n测试 $\\alpha=0.5$：\n$$\nx_{\\text{trial}}=(1,1)+0.5(6,8)=(4,5).\n$$\n可行性检查：$(4,5)\\in[0,5]^{2}$，可行。充分下降检查：\n$$\nf(4,5)=(4-4)^{2}+4(5-2)^{2}=0+4\\cdot 9=36,\n$$\n$$\nf(x_{0})+c_{1}\\alpha\\,\\nabla f(x_{0})^{T}p_{0}=13+0.1\\cdot 0.5\\cdot(-100)=13-5=8.\n$$\n由于 $36\\le 8$ 为假，该条件不满足。更新 $\\alpha \\leftarrow 0.25$。\n\n测试 $\\alpha=0.25$：\n$$\nx_{\\text{trial}}=(1,1)+0.25(6,8)=(2.5,3).\n$$\n可行性检查：$(2.5,3)\\in[0,5]^{2}$，可行。充分下降检查：\n$$\nf(2.5,3)=(2.5-4)^{2}+4(3-2)^{2}=(-1.5)^{2}+4\\cdot 1=2.25+4=6.25,\n$$\n$$\nf(x_{0})+c_{1}\\alpha\\,\\nabla f(x_{0})^{T}p_{0}=13+0.1\\cdot 0.25\\cdot(-100)=13-2.5=10.5.\n$$\n由于 $6.25\\le 10.5$ 成立，接受 $\\alpha_0 = 0.25$。因此，\n$$\nx_{1}=x_{0}+\\alpha_{0}p_{0}=(1,1)+0.25(6,8)=(2.5,3)=\\left(\\frac{5}{2},3\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{5}{2} & 3\\end{pmatrix}}$$", "id": "2154884"}]}