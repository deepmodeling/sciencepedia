{"hands_on_practices": [{"introduction": "在数值优化中，验证一个给定的步长是否“有效”是线搜索算法的核心。这个练习提供了一个基础但至关重要的实践：在一个简单的二维二次函数上，直接应用沃尔夫条件。通过计算梯度并代入不等式，你将熟悉确保充分下降和曲率条件的基本力学，这是理解更复杂优化过程的第一步 [@problem_id:2226157]。", "problem": "在数值优化中，线搜索算法通过迭代来寻找函数 $f: \\mathbb{R}^n \\to \\mathbb{R}$ 的最小值。该算法在每一步从当前点 $x_k$ 选择一个搜索方向 $p_k$，然后寻找一个合适的步长 $\\alpha > 0$ 以最小化 $f(x_k + \\alpha p_k)$。Wolfe 条件是一对不等式，用于定义何为“合适的”步长。\n\n考虑目标函数 $f(x_1, x_2) = 2x_1^2 + 3x_2^2$。我们当前位于点 $x_k = (3, -2)^T$，并选择最速下降方向作为我们的搜索方向 $p_k$。我们希望测试一个潜在的步长 $\\alpha = 0.1$。\n\n对于给定的步长 $\\alpha$，Wolfe 条件如下：\n1.  **Armijo (充分下降) 条件**：$f(x_k + \\alpha p_k) \\le f(x_k) + c_1 \\alpha \\nabla f(x_k)^T p_k$\n2.  **曲率条件**：$\\nabla f(x_k + \\alpha p_k)^T p_k \\ge c_2 \\nabla f(x_k)^T p_k$\n\n使用标准常数 $c_1 = 10^{-4}$ 和 $c_2 = 0.9$，判断对于步长 $\\alpha = 0.1$，这两个条件中的哪些被满足。\n\nA. 仅满足 Armijo 条件。\n\nB. 仅满足曲率条件。\n\nC. Armijo 条件和曲率条件均满足。\n\nD. Armijo 条件和曲率条件均不满足。", "solution": "我们使用最速下降法，因此搜索方向是负梯度。目标函数为 $f(x_{1},x_{2})=2x_{1}^{2}+3x_{2}^{2}$，因此\n$$\n\\nabla f(x)=\\begin{pmatrix}\\frac{\\partial f}{\\partial x_{1}}\\\\\\frac{\\partial f}{\\partial x_{2}}\\end{pmatrix}\n=\\begin{pmatrix}4x_{1}\\\\6x_{2}\\end{pmatrix}.\n$$\n在点 $x_{k}=\\begin{pmatrix}3\\\\ -2\\end{pmatrix}$ 处，我们有\n$$\n\\nabla f(x_{k})=\\begin{pmatrix}12\\\\ -12\\end{pmatrix},\\quad p_{k}=-\\nabla f(x_{k})=\\begin{pmatrix}-12\\\\ 12\\end{pmatrix}.\n$$\n计算基准函数值和方向导数：\n$$\nf(x_{k})=2\\cdot 3^{2}+3\\cdot(-2)^{2}=18+12=30,\\quad \\nabla f(x_{k})^{T}p_{k}=\\begin{pmatrix}12 & -12\\end{pmatrix}\\begin{pmatrix}-12\\\\ 12\\end{pmatrix}=-288.\n$$\n对于 $\\alpha=0.1$，试验点为\n$$\nx_{k}+\\alpha p_{k}=\\begin{pmatrix}3\\\\ -2\\end{pmatrix}+0.1\\begin{pmatrix}-12\\\\ 12\\end{pmatrix}=\\begin{pmatrix}1.8\\\\ -0.8\\end{pmatrix}.\n$$\n在试验点处计算 $f$ 的值：\n$$\nf(x_{k}+\\alpha p_{k})=2\\cdot (1.8)^{2}+3\\cdot (-0.8)^{2}=2\\cdot 3.24+3\\cdot 0.64=6.48+1.92=8.4.\n$$\n使用常数 $c_{1}=10^{-4}$ 时，Armijo 条件要求\n$$\nf(x_{k}+\\alpha p_{k})\\le f(x_{k})+c_{1}\\alpha\\,\\nabla f(x_{k})^{T}p_{k}.\n$$\n右侧等于\n$$\n30+(10^{-4})(0.1)(-288)=30-2.88\\times 10^{-3}=29.99712,\n$$\n且由于 $8.4\\le 29.99712$，Armijo 条件满足。\n\n对于使用常数 $c_{2}=0.9$ 的曲率条件，计算新的梯度及其方向导数：\n$$\n\\nabla f(x_{k}+\\alpha p_{k})=\\begin{pmatrix}4\\cdot 1.8\\\\ 6\\cdot (-0.8)\\end{pmatrix}=\\begin{pmatrix}7.2\\\\ -4.8\\end{pmatrix},\n$$\n$$\n\\nabla f(x_{k}+\\alpha p_{k})^{T}p_{k}=\\begin{pmatrix}7.2 & -4.8\\end{pmatrix}\\begin{pmatrix}-12\\\\ 12\\end{pmatrix}=-86.4-57.6=-144.\n$$\n曲率条件要求\n$$\n\\nabla f(x_{k}+\\alpha p_{k})^{T}p_{k}\\ge c_{2}\\,\\nabla f(x_{k})^{T}p_{k}=0.9\\cdot(-288)=-259.2.\n$$\n由于 $-144\\ge -259.2$，曲率条件也满足。\n\n因此，对于 $\\alpha=0.1$，两个 Wolfe 条件都满足。", "answer": "$$\\boxed{C}$$", "id": "2226157"}, {"introduction": "沃尔夫条件为何必须同时满足？本练习通过一个思想实验巧妙地回答了这个问题，让你去寻找一个仅满足曲率条件但未能满足充分下降条件（Armijo 条件）的步长 $\\alpha$。这种“失败案例”的探索极具启发性，它直观地揭示了 Armijo 条件的作用——防止因步长过大而导致函数值下降不充分，从而加深你对每个条件在算法收敛中独特角色的理解 [@problem_id:2226173]。", "problem": "在一个使用线搜索算法的优化程序中，我们考虑一维目标函数 $f(x) = 2x^3 + 2x^2 - 4x$。该算法当前位于迭代点 $x_k=0$ 处，并已确定一个下降搜索方向 $p_k=1$。\n\n目标是找到一个步长 $\\alpha > 0$ 来满足 Wolfe 条件。第一个 Wolfe 条件，也称为 Armijo 条件（或充分下降条件），由下式给出：\n$$f(x_k + \\alpha p_k) \\le f(x_k) + c_1 \\alpha p_k f'(x_k)$$\n第二个 Wolfe 条件，也称为曲率条件，由下式给出：\n$$f'(x_k + \\alpha p_k) p_k \\ge c_2 f'(x_k) p_k$$\n对于本次特定的搜索，常数设置为 $c_1 = 0.25$ 和 $c_2 = 0.75$。\n\n在以下选项中，哪个步长 $\\alpha$ 的值满足曲率条件，但不满足 Armijo 条件？\n\nA. $\\alpha = 0.1$\n\nB. $\\alpha = 0.5$\n\nC. $\\alpha = 0.7$\n\nD. $\\alpha = 0.9$", "solution": "给定 $f(x) = 2x^{3} + 2x^{2} - 4x$，其中 $x_{k} = 0$ 且 $p_{k} = 1$。其导数为\n$$\nf'(x) = 6x^{2} + 4x - 4.\n$$\n在 $x_{k}=0$ 处，我们有\n$$\nf(0) = 0, \\quad f'(0) = -4,\n$$\n并且 $p_{k}$ 是一个下降方向，因为 $p_{k}f'(x_{k}) = -4 < 0$。\n\n当 $c_{1} = 0.25$ 时的 Armijo 条件是\n$$\nf(x_{k} + \\alpha p_{k}) \\le f(x_{k}) + c_{1}\\alpha p_{k} f'(x_{k}),\n$$\n可简化为\n$$\nf(\\alpha) \\le -\\alpha.\n$$\n由于 $f(\\alpha) = 2\\alpha^{3} + 2\\alpha^{2} - 4\\alpha$，这等价于\n$$\n2\\alpha^{3} + 2\\alpha^{2} - 4\\alpha \\le -\\alpha \\;\\;\\Longleftrightarrow\\;\\; 2\\alpha^{3} + 2\\alpha^{2} - 3\\alpha \\le 0 \\;\\;\\Longleftrightarrow\\;\\; \\alpha\\left(2\\alpha^{2} + 2\\alpha - 3\\right) \\le 0.\n$$\n对于 $\\alpha > 0$，这变为\n$$\n2\\alpha^{2} + 2\\alpha - 3 \\le 0,\n$$\n其正根为\n$$\n\\alpha_{A} = \\frac{-1 + \\sqrt{7}}{2}.\n$$\n因此 Armijo 条件对于 $0 < \\alpha \\le \\alpha_{A}$ 成立，而对于 $\\alpha > \\alpha_{A}$ 不成立。\n\n当 $c_{2} = 0.75$ 时的曲率条件是\n$$\nf'(x_{k} + \\alpha p_{k})p_{k} \\ge c_{2} f'(x_{k})p_{k},\n$$\n可简化为\n$$\nf'(\\alpha) \\ge -3.\n$$\n由于 $f'(\\alpha) = 6\\alpha^{2} + 4\\alpha - 4$，这即是\n$$\n6\\alpha^{2} + 4\\alpha - 4 \\ge -3 \\;\\;\\Longleftrightarrow\\;\\; 6\\alpha^{2} + 4\\alpha - 1 \\ge 0.\n$$\n$6\\alpha^{2} + 4\\alpha - 1 = 0$ 的正根是\n$$\n\\alpha_{C} = \\frac{-2 + \\sqrt{10}}{6}.\n$$\n因此曲率条件对于 $\\alpha \\ge \\alpha_{C}$ 成立。\n\n现在通过直接代入计算来检验这两个条件的选项：\n\n- 对于 $\\alpha = 0.1$：\nArmijo 条件：$2(0.1)^{3} + 2(0.1)^{2} - 3(0.1) = 0.002 + 0.02 - 0.3 = -0.278 \\le 0$ 成立。\n曲率条件：$f'(0.1) = 6(0.1)^{2} + 4(0.1) - 4 = 0.06 + 0.4 - 4 = -3.54 \\not\\ge -3$ 不成立。\n\n- 对于 $\\alpha = 0.5$：\nArmijo 条件：$2(0.5)^{3} + 2(0.5)^{2} - 3(0.5) = 0.25 + 0.5 - 1.5 = -0.75 \\le 0$ 成立。\n曲率条件：$f'(0.5) = 6(0.5)^{2} + 4(0.5) - 4 = 1.5 + 2 - 4 = -0.5 \\ge -3$ 成立。\n\n- 对于 $\\alpha = 0.7$：\nArmijo 条件：$2(0.7)^{3} + 2(0.7)^{2} - 3(0.7) = 0.686 + 0.98 - 2.1 = -0.434 \\le 0$ 成立。\n曲率条件：$f'(0.7) = 6(0.7)^{2} + 4(0.7) - 4 = 2.94 + 2.8 - 4 = 1.74 \\ge -3$ 成立。\n\n- 对于 $\\alpha = 0.9$：\nArmijo 条件：$2(0.9)^{3} + 2(0.9)^{2} - 3(0.9) = 1.458 + 1.62 - 2.7 = 0.378 > 0$ 不成立。\n曲率条件：$f'(0.9) = 6(0.9)^{2} + 4(0.9) - 4 = 4.86 + 3.6 - 4 = 4.46 \\ge -3$ 成立。\n\n因此，满足曲率条件但不满足 Armijo 条件的步长是 $\\alpha = 0.9$。", "answer": "$$\\boxed{D}$$", "id": "2226173"}, {"introduction": "从“验证”步长到“寻找”步长，是理论到实践的关键一跃。这个高级练习将你置于一个模拟的线搜索算法“缩放”（zoom）阶段中，任务是利用沃尔夫条件来迭代地缩小搜索区间，最终定位一个可接受的步长。通过追踪这个简化的算法流程，你将不再仅仅是条件的检验者，而是成为一个主动的探索者，亲身体验优化算法如何智能地在无限的可能性中找到通往最优解的有效路径 [@problem_id:2226137]。", "problem": "在数值优化中，线搜索算法旨在沿给定搜索方向找到一个合适的步长 $\\alpha > 0$。强 Wolfe 条件是终止线搜索的一组常用准则。它们确保目标函数得到充分下降，并且投影梯度的大小也得到充分减小。\n\n考虑一个一维搜索函数 $\\phi(\\alpha)$，它表示目标函数沿搜索方向的值，起始点处有 $\\phi(0) = 5$ 且方向导数为 $\\phi'(0) = -12$。该函数由以下三次多项式给出：\n$$\n\\phi(\\alpha) = 2\\alpha^3 - 3\\alpha^2 - 12\\alpha + 5\n$$\n强 Wolfe 条件定义如下：\n1.  **充分下降条件**：$\\phi(\\alpha) \\le \\phi(0) + c_1 \\alpha \\phi'(0)$\n2.  **强曲率条件**：$|\\phi'(\\alpha)| \\le c_2 |\\phi'(0)|$\n\n对于本问题，使用常数 $c_1 = \\frac{1}{10}$ 和 $c_2 = \\frac{1}{2}$。\n\n一个线搜索算法首先执行了区间限定阶段，并找到了一个初始区间 $[\\alpha_{lo}, \\alpha_{hi}] = [1, 4]$。已知此区间满足算法 'zoom' 阶段的标准进入条件：充分下降条件在 $\\alpha_{lo}$ 处成立，而在 $\\alpha_{hi}$ 处不成立。\n\n你的任务是追踪 'zoom' 阶段以找到一个可接受的步长。在每次迭代中，通过取当前区间 $[\\alpha_{lo}, \\alpha_{hi}]$ 的中点（二分法）来选择一个试验步长 $\\alpha_j$。然后根据以下规则更新区间：\n\n*   **规则 A**：如果充分下降条件在试验点 $\\alpha_j$ 处不成立，则新区间变为 $[\\alpha_{lo}, \\alpha_j]$。\n*   **规则 B**：如果充分下降条件在 $\\alpha_j$ 处满足：\n    1.  检查强曲率条件是否也满足。如果满足，则搜索终止，$\\alpha_j$ 即为解。\n    2.  如果曲率条件不满足，则检查导数 $\\phi'(\\alpha_j)$ 的符号。\n        *   如果 $\\phi'(\\alpha_j) \\ge 0$，则新区间变为 $[\\alpha_{lo}, \\alpha_j]$。\n        *   如果 $\\phi'(\\alpha_j) < 0$，则新区间变为 $[\\alpha_j, \\alpha_{hi}]$。\n\n确定此过程找到的第一个同时满足两个强 Wolfe 条件的 $\\alpha$ 值。将你的最终答案表示为一个精确分数。", "solution": "给定 $\\phi(\\alpha)=2\\alpha^{3}-3\\alpha^{2}-12\\alpha+5$，其中 $\\phi(0)=5$ 且 $\\phi'(0)=-12$。其导数为\n$$\n\\phi'(\\alpha)=6\\alpha^{2}-6\\alpha-12=6(\\alpha-2)(\\alpha+1).\n$$\n强 Wolfe 常数为 $c_{1}=\\frac{1}{10}$ 和 $c_{2}=\\frac{1}{2}$。因此，充分下降条件为\n$$\n\\phi(\\alpha)\\leq \\phi(0)+c_{1}\\alpha\\phi'(0)=5-\\frac{6}{5}\\alpha,\n$$\n且强曲率条件为\n$$\n|\\phi'(\\alpha)|\\leq c_{2}|\\phi'(0)|=6.\n$$\n\n首先，验证区间限定区间 $[\\alpha_{lo},\\alpha_{hi}]=[1,4]$：\n- 在 $\\alpha=1$ 处，计算 $\\phi(1)=2-3-12+5=-8$，不等式右侧为 $5-\\frac{6}{5}\\cdot 1=\\frac{19}{5}$。因为 $-8\\leq \\frac{19}{5}$，所以充分下降条件在 $\\alpha_{lo}=1$ 处成立。\n- 在 $\\alpha=4$ 处，计算 $\\phi(4)=128-48-48+5=37$，不等式右侧为 $5-\\frac{6}{5}\\cdot 4=\\frac{1}{5}$。因为 $37\\leq \\frac{1}{5}$ 不成立，所以充分下降条件在 $\\alpha_{hi}=4$ 处不满足。\n因此，zoom 的进入条件得到满足。\n\nZoom 迭代 1 (二分法)：\n- 试验 $\\alpha_{1}=\\frac{1+4}{2}=\\frac{5}{2}$。计算 $\\phi\\!\\left(\\frac{5}{2}\\right)$ 的值：\n$$\n\\phi\\!\\left(\\frac{5}{2}\\right)=2\\left(\\frac{125}{8}\\right)-3\\left(\\frac{25}{4}\\right)-12\\left(\\frac{5}{2}\\right)+5=\\frac{125}{4}-\\frac{75}{4}-30+5=-\\frac{25}{2}.\n$$\n充分下降条件的右侧为 $5-\\frac{6}{5}\\cdot \\frac{5}{2}=2$。因为 $-\\frac{25}{2}\\leq 2$，所以充分下降条件成立。\n- 检查在 $\\alpha_{1}$ 处的曲率：\n$$\n\\phi'\\!\\left(\\frac{5}{2}\\right)=6\\left(\\frac{5}{2}-2\\right)\\left(\\frac{5}{2}+1\\right)=6\\left(\\frac{1}{2}\\right)\\left(\\frac{7}{2}\\right)=\\frac{21}{2},\n$$\n所以 $|\\phi'\\!\\left(\\frac{5}{2}\\right)|=\\frac{21}{2}>6$，强曲率条件不满足。由于 $\\phi'\\!\\left(\\frac{5}{2}\\right)\\geq 0$，应用导数非负的规则 B，将新区间设置为 $[\\alpha_{lo},\\alpha_{1}]=\\left[1,\\frac{5}{2}\\right]$。\n\nZoom 迭代 2 (二分法)：\n- 试验 $\\alpha_{2}=\\frac{1+\\frac{5}{2}}{2}=\\frac{7}{4}$。计算 $\\phi\\!\\left(\\frac{7}{4}\\right)$ 的值：\n$$\n\\phi\\!\\left(\\frac{7}{4}\\right)=2\\left(\\frac{343}{64}\\right)-3\\left(\\frac{49}{16}\\right)-12\\left(\\frac{7}{4}\\right)+5=\\frac{343}{32}-\\frac{147}{16}-21+5=-\\frac{463}{32}.\n$$\n充分下降条件的右侧为 $5-\\frac{6}{5}\\cdot \\frac{7}{4}=\\frac{29}{10}$。因为 $-\\frac{463}{32}\\leq \\frac{29}{10}$，所以充分下降条件成立。\n- 检查在 $\\alpha_{2}$ 处的曲率：\n$$\n\\phi'\\!\\left(\\frac{7}{4}\\right)=6\\left(\\frac{7}{4}-2\\right)\\left(\\frac{7}{4}+1\\right)=6\\left(-\\frac{1}{4}\\right)\\left(\\frac{11}{4}\\right)=-\\frac{33}{8},\n$$\n所以 $|\\phi'\\!\\left(\\frac{7}{4}\\right)|=\\frac{33}{8}\\leq 6$，因为 $\\frac{33}{8}\\leq \\frac{48}{8}$。因此，强曲率条件成立。\n\n由于在 $\\alpha=\\frac{7}{4}$ 处，两个强 Wolfe 条件都得到满足，zoom 阶段终止，并将此步长作为该过程找到的第一个可接受值。", "answer": "$$\\boxed{\\frac{7}{4}}$$", "id": "2226137"}]}