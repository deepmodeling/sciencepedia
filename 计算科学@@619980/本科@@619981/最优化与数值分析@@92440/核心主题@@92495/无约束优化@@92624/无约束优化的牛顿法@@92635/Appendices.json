{"hands_on_practices": [{"introduction": "为了巩固对牛顿法核心机制的理解，我们从一个基础练习开始。这个练习将优化过程中涉及的微积分计算（即梯度和海森矩阵的推导）剥离，让您专注于牛顿更新步骤本身。通过直接使用给定的梯度 $\\nabla f(\\mathbf{x}_k)$ 和海森矩阵 $H(\\mathbf{x}_k)$，您可以练习计算牛顿步并更新迭代点，这是掌握该方法的关键第一步 [@problem_id:2190699]。", "problem": "一个优化算法正被用来寻找函数 $f(\\mathbf{x})$ 的最小值，其中 $\\mathbf{x}$ 是一个二维向量。该算法当前位于点 $\\mathbf{x}_k = [3, -4]^T$。在此点，函数的梯度已计算为 $\\nabla f(\\mathbf{x}_k) = [2, -1]^T$，Hessian矩阵为 $H(\\mathbf{x}_k) = \\begin{pmatrix} 5 & 1 \\\\ 1 & 1 \\end{pmatrix}$。应用一次完整的牛顿法步骤，确定下一个点 $\\mathbf{x}_{k+1}$。将您的最终答案表示为一个行向量 $[x, y]$，其中分量以精确分数形式给出。", "solution": "无约束优化中牛顿法的核心思想是，通过在当前点创建一个二次近似，然后移动到该近似的最小值点，来迭代地寻找函数的最小值。一次完整牛顿法步骤的更新法则由下式给出：\n$$\n\\mathbf{x}_{k+1} = \\mathbf{x}_k - [H(\\mathbf{x}_k)]^{-1} \\nabla f(\\mathbf{x}_k)\n$$\n其中 $\\mathbf{x}_k$ 是当前点，$\\nabla f(\\mathbf{x}_k)$ 是函数在该点的梯度，而 $H(\\mathbf{x}_k)$ 是在该点的Hessian矩阵。\n\n题目提供了以下信息：\n- 当前迭代点：$\\mathbf{x}_k = \\begin{pmatrix} 3 \\\\ -4 \\end{pmatrix}$\n- 在 $\\mathbf{x}_k$ 处的梯度：$\\nabla f(\\mathbf{x}_k) = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$\n- 在 $\\mathbf{x}_k$ 处的Hessian矩阵：$H(\\mathbf{x}_k) = \\begin{pmatrix} 5 & 1 \\\\ 1 & 1 \\end{pmatrix}$\n\n首先，我们需要计算Hessian矩阵的逆矩阵，$H(\\mathbf{x}_k)^{-1}$。对于一个一般的2x2矩阵 $A = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$，其逆矩阵由以下公式给出：\n$$\nA^{-1} = \\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}\n$$\n项 $ad-bc$ 是该矩阵的行列式。我们来计算 $H(\\mathbf{x}_k)$ 的行列式：\n$$\n\\det(H(\\mathbf{x}_k)) = (5)(1) - (1)(1) = 5 - 1 = 4\n$$\n现在，我们可以求出Hessian矩阵的逆：\n$$\nH(\\mathbf{x}_k)^{-1} = \\frac{1}{4} \\begin{pmatrix} 1 & -1 \\\\ -1 & 5 \\end{pmatrix} = \\begin{pmatrix} 1/4 & -1/4 \\\\ -1/4 & 5/4 \\end{pmatrix}\n$$\n接下来，我们计算Hessian逆矩阵与梯度的乘积：\n$$\nH(\\mathbf{x}_k)^{-1} \\nabla f(\\mathbf{x}_k) = \\begin{pmatrix} 1/4 & -1/4 \\\\ -1/4 & 5/4 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}\n$$\n执行矩阵-向量乘法：\n$$\nH(\\mathbf{x}_k)^{-1} \\nabla f(\\mathbf{x}_k) = \\begin{pmatrix} (1/4)(2) + (-1/4)(-1) \\\\ (-1/4)(2) + (5/4)(-1) \\end{pmatrix} = \\begin{pmatrix} 2/4 + 1/4 \\\\ -2/4 - 5/4 \\end{pmatrix} = \\begin{pmatrix} 3/4 \\\\ -7/4 \\end{pmatrix}\n$$\n现在我们可以更新点 $\\mathbf{x}_k$ 来求得 $\\mathbf{x}_{k+1}$：\n$$\n\\mathbf{x}_{k+1} = \\mathbf{x}_k - H(\\mathbf{x}_k)^{-1} \\nabla f(\\mathbf{x}_k) = \\begin{pmatrix} 3 \\\\ -4 \\end{pmatrix} - \\begin{pmatrix} 3/4 \\\\ -7/4 \\end{pmatrix}\n$$\n逐分量地执行向量减法：\n$$\n\\mathbf{x}_{k+1} = \\begin{pmatrix} 3 - 3/4 \\\\ -4 - (-7/4) \\end{pmatrix} = \\begin{pmatrix} 12/4 - 3/4 \\\\ -16/4 + 7/4 \\end{pmatrix} = \\begin{pmatrix} 9/4 \\\\ -9/4 \\end{pmatrix}\n$$\n题目要求答案以行向量 $[x, y]$ 的形式表示，且分量为精确分数。\n因此，下一个点是 $\\mathbf{x}_{k+1} = [9/4, -9/4]$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{9}{4} & -\\frac{9}{4} \\end{pmatrix}}$$", "id": "2190699"}, {"introduction": "在掌握了基本的更新计算之后，下一个合乎逻辑的步骤是处理一个完整的优化问题。在这个练习中，您将从一个给定的目标函数出发，亲自推导其梯度向量和海森矩阵。这个过程结合了微积分知识和线性代数运算，模拟了应用牛顿法解决实际问题的完整流程，从而加深您对方法全貌的理解 [@problem_id:2190727]。", "problem": "一个工程师团队正在致力于最小化一款新型机械臂的运营成本。该成本由一个关于两个无量纲设计参数 $x$ 和 $y$ 的函数 $f(x, y)$ 建模。该函数为：\n$$f(x, y) = (y - x^2)^2 + (1-x)^2$$\n为找到最小化此成本的最优参数，该团队决定使用无约束优化中的牛顿法。他们从初始设计点 $(x_0, y_0) = (2, 3)$ 开始。\n\n计算应用一步牛顿法后得到的下一个迭代点 $(x_1, y_1)$ 的坐标。将您的答案表示为一个由精确分数组成的有序对。", "solution": "对于双变量的无约束优化，一步牛顿法的迭代更新公式为\n$$\n\\mathbf{z}_{k+1} = \\mathbf{z}_{k} - H(\\mathbf{z}_{k})^{-1} \\nabla f(\\mathbf{z}_{k}),\n$$\n其中 $\\nabla f$ 是 $f$ 的梯度，$H$ 是 $f$ 的海森矩阵，$\\mathbf{z} = (x, y)$ 是迭代点。\n\n已知 $f(x, y) = (y - x^{2})^{2} + (1 - x)^{2}$，计算梯度：\n$$\n\\frac{\\partial f}{\\partial x} = 2(y - x^{2})(-2x) + 2(1 - x)(-1) = -4xy + 4x^{3} - 2 + 2x,\n$$\n$$\n\\frac{\\partial f}{\\partial y} = 2(y - x^{2}) = 2y - 2x^{2}.\n$$\n因此，\n$$\n\\nabla f(x, y) = \\begin{pmatrix} -4xy + 4x^{3} - 2 + 2x \\\\ 2y - 2x^{2} \\end{pmatrix}.\n$$\n\n计算海森矩阵：\n$$\n\\frac{\\partial^{2} f}{\\partial x^{2}} = \\frac{\\partial}{\\partial x}\\left(-4xy + 4x^{3} - 2 + 2x\\right) = -4y + 12x^{2} + 2,\n$$\n$$\n\\frac{\\partial^{2} f}{\\partial x \\partial y} = \\frac{\\partial}{\\partial y}\\left(-4xy + 4x^{3} - 2 + 2x\\right) = -4x,\n$$\n$$\n\\frac{\\partial^{2} f}{\\partial y^{2}} = \\frac{\\partial}{\\partial y}\\left(2y - 2x^{2}\\right) = 2.\n$$\n因此，\n$$\nH(x, y) = \\begin{pmatrix} 12x^{2} - 4y + 2 & -4x \\\\ -4x & 2 \\end{pmatrix}.\n$$\n\n在点 $(x_{0}, y_{0}) = (2, 3)$ 处求值：\n$$\n\\nabla f(2, 3) = \\begin{pmatrix} -4\\cdot 2 \\cdot 3 + 4\\cdot 2^{3} - 2 + 2\\cdot 2 \\\\ 2\\cdot 3 - 2\\cdot 2^{2} \\end{pmatrix} = \\begin{pmatrix} 10 \\\\ -2 \\end{pmatrix},\n$$\n$$\nH(2, 3) = \\begin{pmatrix} 12\\cdot 2^{2} - 4\\cdot 3 + 2 & -4\\cdot 2 \\\\ -4\\cdot 2 & 2 \\end{pmatrix} = \\begin{pmatrix} 38 & -8 \\\\ -8 & 2 \\end{pmatrix}.\n$$\n\n牛顿步 $\\mathbf{s}$ 通过求解方程 $H(2, 3)\\,\\mathbf{s} = -\\nabla f(2, 3)$ 得到：\n$$\n\\begin{pmatrix} 38 & -8 \\\\ -8 & 2 \\end{pmatrix} \\begin{pmatrix} s_{1} \\\\ s_{2} \\end{pmatrix} = \\begin{pmatrix} -10 \\\\ 2 \\end{pmatrix}.\n$$\n对于方程组\n$$\n38 s_{1} - 8 s_{2} = -10, \\quad -8 s_{1} + 2 s_{2} = 2,\n$$\n将第二个方程乘以 $4$ 得到 $-32 s_{1} + 8 s_{2} = 8$，并将其与第一个方程相加，得到 $6 s_{1} = -2$，因此 $s_{1} = -\\frac{1}{3}$。将 $s_1$ 代入 $-8 s_{1} + 2 s_{2} = 2$ 中，得到 $8/3 + 2 s_{2} = 2$，所以 $2 s_{2} = -2/3$，且 $s_{2} = -\\frac{1}{3}$。\n\n因此，\n$$\n(x_{1}, y_{1}) = (x_{0}, y_{0}) + \\mathbf{s} = \\left(2 - \\frac{1}{3},\\, 3 - \\frac{1}{3}\\right) = \\left(\\frac{5}{3},\\, \\frac{8}{3}\\right).\n$$", "answer": "$$\\boxed{\\left(\\frac{5}{3}, \\frac{8}{3}\\right)}$$", "id": "2190727"}, {"introduction": "虽然牛顿法功能强大，但并非万无一失。理解其局限性与掌握其应用同样重要。这个练习引导我们进行一次批判性思考：在什么情况下牛顿法会失效？通过分析一个特定函数，您将发现当海森矩阵（或二阶导数）在某点为奇异（或零）时，牛顿步将无法定义，从而导致算法失败。这个思想实验有助于我们建立对牛顿法适用条件的深刻直觉 [@problem_id:2190705]。", "problem": "牛顿法是无约束优化的一个经典算法。考虑最小化一维目标函数 $f(x) = (x^2 - A)^2$ 的问题，其中 $A$ 是一个给定的正常数。牛顿法的迭代格式从一个初始猜测值 $x_0$ 开始，并生成一个旨在收敛到局部最小值的点序列。然而，对于某些 $x_0$ 的选择，该算法可能在第一步就失败，因为更新无法计算。确定导致此失败发生的初始猜测值 $x_0$ 的正值。你的答案应该是一个用 $A$ 表示的符号表达式。", "solution": "用于一维无约束最小化的牛顿法根据以下公式更新：\n$$\nx_{k+1} = x_{k} - \\frac{f'(x_{k})}{f''(x_{k})}.\n$$\n当且仅当分母为零时，即 $f''(x_{0}) = 0$ 时，更新无法在第一步计算。\n\n给定 $f(x) = (x^{2} - A)^{2}$ 且 $A > 0$，计算其一阶和二阶导数：\n$$\nf'(x) = 2(x^{2} - A)\\cdot 2x = 4x(x^{2} - A),\n$$\n$$\nf''(x) = 4(x^{2} - A) + 8x^{2} = 12x^{2} - 4A = 4(3x^{2} - A).\n$$\n令 $f''(x_{0}) = 0$ 来找到有问题的初始猜测值：\n$$\n4(3x_{0}^{2} - A) = 0 \\;\\Longrightarrow\\; 3x_{0}^{2} - A = 0 \\;\\Longrightarrow\\; x_{0}^{2} = \\frac{A}{3}.\n$$\n因此，使牛顿步未定义的正初始猜测值为\n$$\nx_{0} = \\sqrt{\\frac{A}{3}}.\n$$", "answer": "$$\\boxed{\\sqrt{\\frac{A}{3}}}$$", "id": "2190705"}]}