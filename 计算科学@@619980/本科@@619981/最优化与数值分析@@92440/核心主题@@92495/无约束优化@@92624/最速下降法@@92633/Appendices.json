{"hands_on_practices": [{"introduction": "任何优化算法的学习都始于理解其第一步如何迈出。最速下降法因其核心策略而得名：沿着函数值下降最快的方向移动。本练习要求你通过计算著名的 Rosenbrock 函数（一个经典的优化基准问题）在初始点的负梯度，来确定这个初始下降方向 [@problem_id:2221567]。", "problem": "在数值优化领域，新算法的性能通常使用一组标准测试函数来进行基准测试。其中一个这样的函数是 Rosenbrock 函数，由于其狭窄的抛物线形山谷，该函数难以最小化。\n\n考虑一个二维形式的 Rosenbrock 函数，其表达式为\n$$f(x,y) = (a-x)^2 + b(y-x^2)^2$$\n其中 $a$ 和 $b$ 是正常数。\n\n一个迭代最小化算法从点 $(x_0, y_0) = (0, 0)$ 开始。该算法的第一步是确定初始搜索方向。该方向被定义为函数值从起始点下降最快的方向向量。\n\n确定这个初始搜索方向向量 $\\mathbf{d}_0$。请用常数 $a$ 和 $b$ 将您的答案表示为列向量。", "solution": "函数 $f$ 在某一点下降最快的方向是该点的负梯度，因此从 $(x_{0},y_{0})=(0,0)$ 出发的初始搜索方向是 $\\mathbf{d}_{0}=-\\nabla f(0,0)$。\n\n计算 $f(x,y)=(a-x)^{2}+b(y-x^{2})^{2}$ 的梯度：\n- 关于 $x$ 的偏导数是\n$$\n\\frac{\\partial f}{\\partial x}=2(x-a)-4bx(y-x^{2}).\n$$\n- 关于 $y$ 的偏导数是\n$$\n\\frac{\\partial f}{\\partial y}=2b(y-x^{2}).\n$$\n\n在 $(0,0)$ 处求这些偏导数的值：\n$$\n\\frac{\\partial f}{\\partial x}(0,0)=-2a,\\qquad \\frac{\\partial f}{\\partial y}(0,0)=0.\n$$\n因此，\n$$\n\\nabla f(0,0)=\\begin{pmatrix}-2a\\\\0\\end{pmatrix},\n\\quad\n\\mathbf{d}_{0}=-\\nabla f(0,0)=\\begin{pmatrix}2a\\\\0\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}2a\\\\0\\end{pmatrix}}$$", "id": "2221567"}, {"introduction": "确定了下降方向后，下一个关键问题是“我们应该沿着这个方向走多远？”。这个练习聚焦于最速下降法的一个关键组成部分——“精确线搜索”。通过将多维问题转化为简单的单变量微积分任务，你将计算出能使目标函数在选定方向上达到最小的最优步长 $\\alpha$ [@problem_id:2170908]。", "problem": "在数值优化领域，最速下降法是寻找函数局部最小值的基本算法。该方法的一个关键部分是线搜索，它决定了每次迭代中沿搜索方向移动的步长。\n\n考虑最小化二次函数 $f(x_1, x_2) = 2x_1^2 + x_2^2 + x_1 x_2$ 的任务。最速下降算法的第一步始于初始点 $\\mathbf{x}_0 = (3, 0)$，并沿着在该点计算的负梯度方向移动，我们记此方向为 $\\mathbf{p}_0 = -\\nabla f(\\mathbf{x}_0)$。\n\n执行精确线搜索以找到最优步长 $\\alpha > 0$，该步长使得函数沿此方向的值最小。这需要找到能使一维函数 $\\phi(\\alpha) = f(\\mathbf{x}_0 + \\alpha \\mathbf{p}_0)$ 最小化的 $\\alpha$ 值。\n\n您的任务是确定这个最优步长 $\\alpha$。请将您的答案表示为最简精确分数形式。", "solution": "我们使用最速下降法和精确线搜索来最小化函数 $f(x_{1},x_{2})=2x_{1}^{2}+x_{2}^{2}+x_{1}x_{2}$，起始点为 $\\mathbf{x}_{0}=(3,0)$。梯度为\n$$\n\\nabla f(x_{1},x_{2})=\\begin{pmatrix}4x_{1}+x_{2}\\\\ x_{1}+2x_{2}\\end{pmatrix}.\n$$\n在 $\\mathbf{x}_{0}$ 处计算，得到\n$$\n\\mathbf{g}_{0}=\\nabla f(\\mathbf{x}_{0})=\\begin{pmatrix}4\\cdot 3+0\\\\ 3+2\\cdot 0\\end{pmatrix}=\\begin{pmatrix}12\\\\ 3\\end{pmatrix},\n$$\n因此最速下降方向为 $\\mathbf{p}_{0}=-\\mathbf{g}_{0}=\\begin{pmatrix}-12\\\\ -3\\end{pmatrix}$。\n\n定义直线 $x(\\alpha)=\\mathbf{x}_{0}+\\alpha \\mathbf{p}_{0}=(3-12\\alpha,-3\\alpha)$ 和一维函数 $\\phi(\\alpha)=f(x(\\alpha))$。那么\n$$\n\\phi(\\alpha)=2(3-12\\alpha)^{2}+(-3\\alpha)^{2}+(3-12\\alpha)(-3\\alpha).\n$$\n展开每一项：\n$$\n(3-12\\alpha)^{2}=9-72\\alpha+144\\alpha^{2},\\quad 2(3-12\\alpha)^{2}=18-144\\alpha+288\\alpha^{2},\n$$\n$$\n(-3\\alpha)^{2}=9\\alpha^{2},\\quad (3-12\\alpha)(-3\\alpha)=-9\\alpha+36\\alpha^{2}.\n$$\n求和，\n$$\n\\phi(\\alpha)=18-144\\alpha+288\\alpha^{2}+9\\alpha^{2}-9\\alpha+36\\alpha^{2}\n=18-153\\alpha+333\\alpha^{2}.\n$$\n对于精确线搜索，将导数设为零：\n$$\n\\phi'(\\alpha)=-153+666\\alpha=0 \\quad \\Rightarrow \\quad \\alpha=\\frac{153}{666}.\n$$\n化简分数：\n$$\n\\frac{153}{666}=\\frac{51}{222}=\\frac{17}{74}.\n$$\n由于 $\\phi''(\\alpha)=666>0$，这个 $\\alpha$ 确实使 $\\phi$ 最小化。", "answer": "$$\\boxed{\\frac{17}{74}}$$", "id": "2170908"}, {"introduction": "现在，让我们将所有部分组合起来，观察最速下降法的实际运行过程。通过执行两次完整的迭代，你不仅将练习计算下降方向和最优步长，还将深入了解该算法的实际表现。这个针对简单二次函数的练习将揭示其特有的“之”字形收敛路径，这是理解该方法在病态问题上性能表现的关键 [@problem_id:2221576]。", "problem": "考虑最小化函数 $f(x, y) = 10x^2 + y^2$ 的无约束优化问题。优化过程从点 $\\mathbf{x}_0 = (x_0, y_0) = (1, 1)$ 开始。\n\n将使用最速下降法。对于每次迭代 $k$，步长（记为 $\\alpha_k > 0$）通过精确线搜索确定。这意味着对于给定的点 $\\mathbf{x}_k$ 和下降方向 $\\mathbf{p}_k$，选择步长 $\\alpha_k$ 以找到单变量函数 $g(\\alpha) = f(\\mathbf{x}_k + \\alpha \\mathbf{p}_k)$ 的全局最小值。\n\n计算该方法经过两次完整迭代后的点 $\\mathbf{x}_2 = (x_2, y_2)$ 的坐标。最终答案中的坐标应表示为最简精确分数形式。", "solution": "我们使用带有精确线搜索的最速下降法，从点 $\\mathbf{x}_{0}=(1,1)$ 开始最小化 $f(x,y)=10x^{2}+y^{2}$。梯度和 Hessian 矩阵为\n$$\n\\nabla f(x,y)=\\begin{pmatrix}20x\\\\2y\\end{pmatrix},\\qquad H=\\begin{pmatrix}20&0\\\\0&2\\end{pmatrix}.\n$$\n在第 $k$ 次迭代中，设 $\\mathbf{g}_{k}=\\nabla f(\\mathbf{x}_{k})$ 且方向为 $\\mathbf{p}_{k}=-\\mathbf{g}_{k}$，精确线搜索将最小化 $g(\\alpha)=f(\\mathbf{x}_{k}+\\alpha\\mathbf{p}_{k})$。由于 $H$ 是常数（因为原函数是二次函数），其导数为\n$$\ng'(\\alpha)=\\nabla f(\\mathbf{x}_{k}-\\alpha \\mathbf{g}_{k})^{\\mathsf{T}}(-\\mathbf{g}_{k})=\\left(\\mathbf{g}_{k}-\\alpha H\\mathbf{g}_{k}\\right)^{\\mathsf{T}}(-\\mathbf{g}_{k})=-(\\mathbf{g}_{k}^{\\mathsf{T}}\\mathbf{g}_{k})+\\alpha\\,\\mathbf{g}_{k}^{\\mathsf{T}}H\\mathbf{g}_{k}.\n$$\n令 $g'(\\alpha)=0$，可得精确步长\n$$\n\\alpha_{k}=\\frac{\\mathbf{g}_{k}^{\\mathsf{T}}\\mathbf{g}_{k}}{\\mathbf{g}_{k}^{\\mathsf{T}}H\\mathbf{g}_{k}}.\n$$\n\n迭代 $0$：$\\mathbf{x}_{0}=(1,1)$，可得\n$$\n\\mathbf{g}_{0}=\\begin{pmatrix}20\\\\2\\end{pmatrix},\\quad \\mathbf{g}_{0}^{\\mathsf{T}}\\mathbf{g}_{0}=404,\\quad H\\mathbf{g}_{0}=\\begin{pmatrix}400\\\\4\\end{pmatrix},\\quad \\mathbf{g}_{0}^{\\mathsf{T}}H\\mathbf{g}_{0}=8008,\n$$\n所以\n$$\n\\alpha_{0}=\\frac{404}{8008}=\\frac{101}{2002}.\n$$\n接着\n$$\n\\mathbf{x}_{1}=\\mathbf{x}_{0}-\\alpha_{0}\\mathbf{g}_{0}=\\begin{pmatrix}1-20\\alpha_{0}\\\\1-2\\alpha_{0}\\end{pmatrix}=\\begin{pmatrix}1-\\frac{1010}{1001}\\\\1-\\frac{101}{1001}\\end{pmatrix}=\\begin{pmatrix}-\\frac{9}{1001}\\\\\\frac{900}{1001}\\end{pmatrix}.\n$$\n\n迭代 $1$：$\\mathbf{x}_{1}=\\left(-\\frac{9}{1001},\\,\\frac{900}{1001}\\right)$，可得\n$$\n\\mathbf{g}_{1}=\\begin{pmatrix}20x_{1}\\\\2y_{1}\\end{pmatrix}=\\begin{pmatrix}-\\frac{180}{1001}\\\\\\frac{1800}{1001}\\end{pmatrix}.\n$$\n计算\n$$\n\\mathbf{g}_{1}^{\\mathsf{T}}\\mathbf{g}_{1}=\\frac{180^{2}+1800^{2}}{1001^{2}}=\\frac{180^{2}\\cdot 101}{1001^{2}},\\qquad\nH\\mathbf{g}_{1}=\\begin{pmatrix}-\\frac{3600}{1001}\\\\\\frac{3600}{1001}\\end{pmatrix},\\qquad\n\\mathbf{g}_{1}^{\\mathsf{T}}H\\mathbf{g}_{1}=\\frac{7128000}{1001^{2}}.\n$$\n因此\n$$\n\\alpha_{1}=\\frac{\\mathbf{g}_{1}^{\\mathsf{T}}\\mathbf{g}_{1}}{\\mathbf{g}_{1}^{\\mathsf{T}}H\\mathbf{g}_{1}}=\\frac{3272400}{7128000}=\\frac{101}{220}.\n$$\n更新\n$$\n\\mathbf{x}_{2}=\\mathbf{x}_{1}-\\alpha_{1}\\mathbf{g}_{1}=\\begin{pmatrix}-\\frac{9}{1001}-\\frac{101}{220}\\left(-\\frac{180}{1001}\\right)\\\\\\frac{900}{1001}-\\frac{101}{220}\\left(\\frac{1800}{1001}\\right)\\end{pmatrix}=\\begin{pmatrix}-\\frac{9}{1001}+\\frac{909}{11011}\\\\\\frac{900}{1001}-\\frac{9090}{11011}\\end{pmatrix}=\\begin{pmatrix}\\frac{810}{11011}\\\\\\frac{810}{11011}\\end{pmatrix}.\n$$\n这些分数已经是最简形式，因为 $\\gcd(810,11011)=1$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{810}{11011} \\\\ \\frac{810}{11011} \\end{pmatrix}}$$", "id": "2221576"}]}