{"hands_on_practices": [{"introduction": "本练习是掌握二次罚函数法核心机制的绝佳起点。通过为一个带线性等式约束的二次目标函数构建罚函数，你将直接推导出近似最优解如何依赖于罚参数 $\\mu$。这个过程将为你展示将一个约束优化问题转化为无约束问题求解的基本流程，并让你亲身体验罚函数法的魅力。[@problem_id:2193291]", "problem": "考虑一个约束优化问题，其目标是最小化函数 $f(x_1, x_2) = (x_1 - a)^2 + (x_2 - b)^2$，并满足线性约束 $h(x_1, x_2) = x_1 + x_2 - c = 0$。在此，$a$、$b$ 和 $c$ 是实值常数。\n\n这类问题可以使用二次惩罚法来解决。该方法涉及创建一个无约束的目标函数，称为惩罚函数，定义为 $P(x_1, x_2; \\mu) = f(x_1, x_2) + \\frac{\\mu}{2}[h(x_1, x_2)]^2$，其中 $\\mu > 0$ 是一个称为惩罚参数的正大常数。原约束问题的解可以通过找到 $P(x_1, x_2; \\mu)$ 的极小值点来近似。当 $\\mu$ 趋于无穷大时，该极小值点收敛到约束问题的真实解。\n\n确定无约束惩罚函数 $P(x_1, x_2; \\mu)$ 的极小值点 $(x_1^*(\\mu), x_2^*(\\mu))$。将您的答案表示为一个含两个分量的向量，其中每个分量都是关于参数 $a, b, c$ 和 $\\mu$ 的解析表达式。", "solution": "给定惩罚函数\n$$\nP(x_{1},x_{2};\\mu)= (x_{1}-a)^{2}+(x_{2}-b)^{2}+\\frac{\\mu}{2}\\left(x_{1}+x_{2}-c\\right)^{2},\n$$\n其中 $\\mu>0$。为求其无约束极小值点，令梯度为零。其偏导数为\n$$\n\\frac{\\partial P}{\\partial x_{1}}=2(x_{1}-a)+\\mu(x_{1}+x_{2}-c),\n$$\n$$\n\\frac{\\partial P}{\\partial x_{2}}=2(x_{2}-b)+\\mu(x_{1}+x_{2}-c).\n$$\n令这些偏导数等于零，得到线性系统\n$$\n2(x_{1}-a)+\\mu(x_{1}+x_{2}-c)=0,\\qquad 2(x_{2}-b)+\\mu(x_{1}+x_{2}-c)=0.\n$$\n等价于\n$$\n(2+\\mu)x_{1}+\\mu x_{2}=2a+\\mu c,\\qquad \\mu x_{1}+(2+\\mu)x_{2}=2b+\\mu c.\n$$\n写成矩阵形式为\n$$\n\\begin{pmatrix}\n2+\\mu & \\mu\\\\\n\\mu & 2+\\mu\n\\end{pmatrix}\n\\begin{pmatrix}\nx_{1}\\\\\nx_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2a+\\mu c\\\\\n2b+\\mu c\n\\end{pmatrix}.\n$$\n系数矩阵的行列式为 $(2+\\mu)^{2}-\\mu^{2}=4(1+\\mu)$，对于 $\\mu>0$，该值为正，因此解是唯一的。使用克莱姆法则（Cramer’s rule），\n$$\nx_{1}=\\frac{(2a+\\mu c)(2+\\mu)-\\mu(2b+\\mu c)}{4(1+\\mu)}=\\frac{2a+\\mu(a-b+c)}{2(1+\\mu)},\n$$\n$$\nx_{2}=\\frac{(2+\\mu)(2b+\\mu c)-\\mu(2a+\\mu c)}{4(1+\\mu)}=\\frac{2b+\\mu(b-a+c)}{2(1+\\mu)}.\n$$\n当 $\\mu\\to\\infty$ 时，这些解收敛于精确的约束解 $\\left(\\frac{a-b+c}{2},\\frac{b-a+c}{2}\\right)$，这与到直线 $x_{1}+x_{2}=c$ 上的投影是一致的。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{2 a+\\mu\\left(a-b+c\\right)}{2\\left(1+\\mu\\right)} & \\frac{2 b+\\mu\\left(b-a+c\\right)}{2\\left(1+\\mu\\right)}\\end{pmatrix}}$$", "id": "2193291"}, {"introduction": "这个练习提出了一个引人深思的情景：如果一个问题的无约束最优解恰好满足其约束条件，会发生什么？通过分析这个特殊案例，你将发现罚函数项在这种情况下不起作用，无论罚参数 $\\mu$ 如何取值，其解都保持不变。这个练习有助于加深对约束最优化问题本质的理解，并揭示了罚函数法的一个重要理论特性。[@problem_id:2193301]", "problem": "考虑将二次罚函数法应用于一个优化问题。目标是对于一个通用的罚参数 $\\mu > 0$，求出带罚项的目标函数 $P(x_1, x_2; \\mu)$ 的极小值点 $(x_{1,\\mu}, x_{2,\\mu})$。该函数定义为：\n\n$$P(x_1, x_2; \\mu) = (x_1 - 1)^2 + (x_2 - 2)^2 + \\frac{1}{2\\mu} (x_1 + x_2 - 3)^2$$\n\n其中 $x_1$ 和 $x_2$ 是实变量。\n\n求使此函数最小化的点 $(x_{1,\\mu}, x_{2,\\mu})$ 的坐标。你的答案应该是一个具有恒定坐标的点，该点对任意 $\\mu > 0$ 的选择都成立。将最终答案表示为一个 $1 \\times 2$ 的行矩阵。", "solution": "我们对 $\\mu>0$ 的二次函数 $P(x_{1},x_{2};\\mu)=(x_{1}-1)^{2}+(x_{2}-2)^{2}+\\frac{1}{2\\mu}(x_{1}+x_{2}-3)^{2}$ 求极小值。由于 $P$ 是关于 $(x_{1},x_{2})$ 的严格凸二次函数（其Hessian矩阵为对称矩阵\n$$\nH=\\begin{pmatrix}2+\\frac{1}{\\mu} & \\frac{1}{\\mu} \\\\ \\frac{1}{\\mu} & 2+\\frac{1}{\\mu}\\end{pmatrix},\n$$\n对于 $\\mu>0$，该矩阵是严格对角占优的，因此是正定的），唯一的极小值点由一阶最优性条件 $\\nabla P=0$ 确定。\n\n计算偏导数：\n$$\n\\frac{\\partial P}{\\partial x_{1}}=2(x_{1}-1)+\\frac{1}{\\mu}(x_{1}+x_{2}-3),\n$$\n$$\n\\frac{\\partial P}{\\partial x_{2}}=2(x_{2}-2)+\\frac{1}{\\mu}(x_{1}+x_{2}-3).\n$$\n令它们为零，可得线性方程组\n$$\n2(x_{1}-1)+\\frac{1}{\\mu}(x_{1}+x_{2}-3)=0,\\qquad 2(x_{2}-2)+\\frac{1}{\\mu}(x_{1}+x_{2}-3)=0.\n$$\n等价地，\n$$\n\\left(2+\\frac{1}{\\mu}\\right)x_{1}+\\frac{1}{\\mu}x_{2}=2+\\frac{3}{\\mu},\\qquad \\frac{1}{\\mu}x_{1}+\\left(2+\\frac{1}{\\mu}\\right)x_{2}=4+\\frac{3}{\\mu}.\n$$\n用第二个方程减去第一个方程，得到\n$$\n-2x_{1}+2x_{2}=2 \\;\\;\\Rightarrow\\;\\; x_{2}=x_{1}+1.\n$$\n代入第一个方程，\n$$\n\\left(2+\\frac{1}{\\mu}\\right)x_{1}+\\frac{1}{\\mu}(x_{1}+1)=2+\\frac{3}{\\mu}\n\\;\\;\\Rightarrow\\;\\;\n\\left(2+\\frac{2}{\\mu}\\right)x_{1}+\\frac{1}{\\mu}=2+\\frac{3}{\\mu},\n$$\n所以\n$$\n\\left(2+\\frac{2}{\\mu}\\right)x_{1}=2+\\frac{2}{\\mu}\n\\;\\;\\Rightarrow\\;\\;\nx_{1}=1.\n$$\n则 $x_{2}=x_{1}+1=2$。此解与 $\\mu>0$ 无关，因此对任何罚参数都成立。", "answer": "$$\\boxed{\\begin{pmatrix}1 & 2\\end{pmatrix}}$$", "id": "2193301"}, {"introduction": "现实世界中的优化问题常常涉及不等式约束，这比等式约束更为复杂。本练习旨在让你掌握处理不等式约束的正确方法，并通过对比一个常见的概念错误（将不等式误作等式处理）来巩固你的理解。这个实践将强化你对罚函数法正确应用的认识，对于避免在解决实际问题时犯下代价高昂的错误至关重要。[@problem_id:2193329]", "problem": "考虑一个一维约束优化问题，该问题是关于变量 $x \\in \\mathbb{R}$ 最小化目标函数 $f(x) = (x-c)^2$。此最小化问题受单个不等式约束 $x \\le b$ 的限制。参数 $c$ 和 $b$ 是满足条件 $c < b$ 的固定实数常数。\n\n我们将使用二次罚函数法来分析此问题，其中罚参数记为 $\\mu > 0$。对于一个目标为最小化 $f(x)$ 且受不等式约束 $g(x) \\le 0$ 限制的一般问题，其罚目标函数由以下公式给出：\n$$P(x; \\mu) = f(x) + \\frac{1}{2\\mu} \\left( \\max(0, g(x)) \\right)^2$$\n\n首先，令 $x_I^*(\\mu)$ 为针对给定的不等式约束问题，使其正确构造的罚目标函数最小化的 $x$ 的值。\n\n接下来，考虑一个常见的概念性错误，即分析者错误地将不等式约束 $x \\le b$ 视为等式约束 $x=b$。对于一个目标为最小化 $f(x)$ 且受等式约束 $h(x) = 0$ 限制的一般问题，其罚目标函数由以下公式给出：\n$$P(x; \\mu) = f(x) + \\frac{1}{2\\mu} \\left( h(x) \\right)^2$$\n令 $x_E^*(\\mu)$ 为在这种不正确的等式形式下，使罚目标函数最小化的 $x$ 的值。\n\n您的任务是，在罚函数变得无限严格时，确定这两种方法之间差异的极限值。具体来说，就是计算极限 $\\lim_{\\mu \\to 0^+} \\left( x_E^*(\\mu) - x_I^*(\\mu) \\right)$ 的值。您的最终答案应为一个用常数 $b$ 和 $c$ 表示的表达式。", "solution": "给定函数 $f(x)=(x-c)^{2}$ 和不等式约束 $x\\le b$，其中 $c<b$。对于不等式 $g(x)\\le 0$ 的二次罚函数，我们设 $g(x)=x-b$，因此正确构造的罚目标函数为\n$$\nP_{I}(x;\\mu)= (x-c)^{2}+\\frac{1}{2\\mu}\\left(\\max(0,x-b)\\right)^{2}.\n$$\n对于 $x\\le b$，罚项为零，此时 $P_{I}(x;\\mu)=(x-c)^{2}$，在 $x=c$ 处取得最小值。由于 $c<b$，该最小化子是可行的，并得出 $P_{I}(c;\\mu)=0$。当 $x>b$ 时，我们有\n$$\nP_{I}(x;\\mu)=(x-c)^{2}+\\frac{1}{2\\mu}(x-b)^{2}.\n$$\n通过求导并令其为零，可以得到该区域的驻点条件：\n$$\n2(x-c)+\\frac{1}{\\mu}(x-b)=0 \\;\\;\\Longrightarrow\\;\\; x=\\frac{b+2\\mu c}{1+2\\mu}.\n$$\n因为 $c<b$，所以 $b+2\\mu c<b+2\\mu b=(1+2\\mu)b$，因此 $\\frac{b+2\\mu c}{1+2\\mu}<b$，所以在 $x>b$ 的区域内没有驻点。因此，对于所有 $\\mu>0$，$P_{I}$ 的全局最小化子是 $x_{I}^{*}(\\mu)=c$。\n\n在不正确的等式罚函数形式下，即 $h(x)=x-b=0$，罚目标函数为\n$$\nP_{E}(x;\\mu)=(x-c)^{2}+\\frac{1}{2\\mu}(x-b)^{2}.\n$$\n这是一个严格凸函数。其一阶最优性条件为\n$$\n\\frac{d}{dx}P_{E}(x;\\mu)=2(x-c)+\\frac{1}{\\mu}(x-b)=0,\n$$\n解得\n$$\nx_{E}^{*}(\\mu)=\\frac{2c+\\frac{b}{\\mu}}{2+\\frac{1}{\\mu}}=\\frac{b+2\\mu c}{1+2\\mu}.\n$$\n\n差异为\n$$\nx_{E}^{*}(\\mu)-x_{I}^{*}(\\mu)=\\frac{b+2\\mu c}{1+2\\mu}-c=\\frac{b+2\\mu c-c(1+2\\mu)}{1+2\\mu}=\\frac{b-c}{1+2\\mu}.\n$$\n取 $\\mu\\to 0^{+}$ 的极限，得到\n$$\n\\lim_{\\mu\\to 0^{+}}\\left(x_{E}^{*}(\\mu)-x_{I}^{*}(\\mu)\\right)=b-c.\n$$", "answer": "$$\\boxed{b-c}$$", "id": "2193329"}]}