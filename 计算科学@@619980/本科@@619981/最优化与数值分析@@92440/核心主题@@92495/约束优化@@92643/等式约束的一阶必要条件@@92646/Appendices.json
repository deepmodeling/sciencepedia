{"hands_on_practices": [{"introduction": "我们从一个直观的几何问题开始。在许多工程和物理应用中，我们常常需要找到一个受限于某个曲面的点，使其到某个特定点（如原点）的距离最短。这个问题 [@problem_id:2173333] 是等式约束优化中的一个典型入门练习。它不仅帮助我们练习建立目标函数和约束条件，更能让我们从几何上理解为什么在最优点，目标函数的梯度必须与约束曲面的梯度平行，这是拉格朗日乘子法的核心思想。", "problem": "在设计一个组件时，一位工程师将一个三维笛卡尔坐标系中的关键点 $(x, y, z)$ 约束在一个双曲抛物面上。该曲面的方程为 $z = xy + 1$。为了保证结构完整性，有必要找到该曲面上离原点 $(0, 0, 0)$ 最近的点，因为在特定的加载模型下，该位置将承受最小应力。\n\n确定该点的笛卡尔坐标 $(x, y, z)$。答案应以点的坐标形式给出。", "solution": "我们要寻找曲面 $z=xy+1$ 上的一个点，使其到原点的欧几里得距离最小。从 $(0,0,0)$ 到 $(x,y,z)$ 的距离的平方为 $x^{2}+y^{2}+z^{2}$。因为最小化距离的平方与最小化距离本身得到的最小值点相同，我们最小化\n$$\nD(x,y,z) = x^{2} + y^{2} + z^{2} \\quad \\text{且满足} \\quad z=xy+1.\n$$\n代入约束条件，我们得到一个无约束的二元函数\n$$\nS(x,y) = x^{2} + y^{2} + (xy+1)^{2} = x^{2} + y^{2} + x^{2}y^{2} + 2xy + 1.\n$$\n将一阶偏导数设为零：\n$$\n\\frac{\\partial S}{\\partial x} = 2x + 2xy^{2} + 2y = 2\\big(x + xy^{2} + y\\big) = 0,\n$$\n$$\n\\frac{\\partial S}{\\partial y} = 2y + 2x^{2}y + 2x = 2\\big(y + x^{2}y + x\\big) = 0.\n$$\n等价地，\n$$\nx(1+y^{2}) + y = 0, \\qquad y(1+x^{2}) + x = 0.\n$$\n由第一个方程可得 $y = -x(1+y^{2})$。将其代入第二个方程得出\n$$\ny(1+x^{2}) + x = \\big(-x(1+y^{2})\\big)(1+x^{2}) + x = x\\big(1 - (1+y^{2})(1+x^{2})\\big) = 0.\n$$\n因此，$x=0$ 或 $(1+y^{2})(1+x^{2})=1$。由于 $(1+y^{2})(1+x^{2}) \\geq 1$ 且等号仅在 $x=0$ 和 $y=0$ 时成立，所以第二种可能性也意味着 $x=0$ 和 $y=0$。如果 $x=0$，那么第一个方程给出 $y=0$。因此，在 $(x,y)$ 平面上的唯一临界点是 $(0,0)$。\n\n为了确认在此临界点处可取得全局最小值，我们将 $S$ 改写为\n$$\nS(x,y) = 1 + (x+y)^{2} + (xy)^{2}.\n$$\n由于对所有实数 $x,y$，都有 $(x+y)^{2} \\geq 0$ 和 $(xy)^{2} \\geq 0$，可得 $S(x,y) \\geq 1$。等号成立当且仅当 $x+y=0$ 且 $xy=0$，这两个条件共同意味着 $x=y=0$。因此，$S$ 的全局最小值为 $1$，且该值仅在 $(x,y)=(0,0)$ 处取得。\n\n在该点，曲面上对应的 $z$ 坐标为\n$$\nz = xy + 1 = 1.\n$$\n因此，曲面上离原点最近的点是 $(0,0,1)$。", "answer": "$$\\boxed{\\begin{pmatrix}0 & 0 & 1\\end{pmatrix}}$$", "id": "2173333"}, {"introduction": "接下来，我们将优化问题从一个无界曲面推广到一个有界曲面——椭球。这个问题 [@problem_id:2173341] 要求我们找到椭球上距离原点最远的点，这在概念上与寻找最近点类似，但其解法展示了如何处理更复杂的约束并比较多个候选极值点。通过解决这个问题，我们能更深入地理解拉格朗日乘子法，并体会到在紧集（有界闭集）上连续函数必然存在最大值和最小值的基本原理，同时其材料科学背景也展示了该方法的实际应用价值。", "problem": "在各向异性材料的塑性研究中，屈服面是定义材料在复杂加载条件下弹性极限的一个准则。对于一种特定的正交各向异性材料，其主应力状态，由向量 $(\\sigma_1, \\sigma_2, \\sigma_3)$ 表示，被约束在一个椭球屈服面上。该曲面的方程由下式给出：\n$$ \\frac{\\sigma_1^2}{S_1^2} + \\frac{\\sigma_2^2}{S_2^2} + \\frac{\\sigma_3^2}{S_3^2} = 1 $$\n此处，$S_1, S_2,$ 和 $S_3$ 表示材料沿其三个主轴方向的屈服强度。它们是正常数，并且对于此特定材料，它们的大小顺序为 $S_1 > S_2 > S_3 > 0$。\n\n我们感兴趣的是找出该屈服面上具有最大总模量的应力状态。应力向量的模定义为 $M = \\sqrt{\\sigma_1^2 + \\sigma_2^2 + \\sigma_3^2}$。\n\n确定位于该屈服面上的应力状态的模 $M$ 的最大可能值。", "solution": "该问题是要求解在约束方程 $\\frac{\\sigma_1^2}{S_1^2} + \\frac{\\sigma_2^2}{S_2^2} + \\frac{\\sigma_3^2}{S_3^2} = 1$ 定义的椭球面上，一个点 $(\\sigma_1, \\sigma_2, \\sigma_3)$ 的应力向量的模 $M = \\sqrt{\\sigma_1^2 + \\sigma_2^2 + \\sigma_3^2}$ 的最大值。\n\n这是一个约束优化问题。为简化计算，由于 $M$ 总是非负的，我们可以最大化其平方 $M^2$，而不是最大化 $M$。设需要最大化的函数为 $f(\\sigma_1, \\sigma_2, \\sigma_3) = \\sigma_1^2 + \\sigma_2^2 + \\sigma_3^2$。约束函数为 $g(\\sigma_1, \\sigma_2, \\sigma_3) = \\frac{\\sigma_1^2}{S_1^2} + \\frac{\\sigma_2^2}{S_2^2} + \\frac{\\sigma_3^2}{S_3^2} - 1 = 0$。\n\n我们使用拉格朗日乘子法。拉格朗日函数 $\\mathcal{L}$ 定义为：\n$$ \\mathcal{L}(\\sigma_1, \\sigma_2, \\sigma_3, \\lambda) = f(\\sigma_1, \\sigma_2, \\sigma_3) - \\lambda g(\\sigma_1, \\sigma_2, \\sigma_3) $$\n$$ \\mathcal{L}(\\sigma_1, \\sigma_2, \\sigma_3, \\lambda) = (\\sigma_1^2 + \\sigma_2^2 + \\sigma_3^2) - \\lambda \\left( \\frac{\\sigma_1^2}{S_1^2} + \\frac{\\sigma_2^2}{S_2^2} + \\frac{\\sigma_3^2}{S_3^2} - 1 \\right) $$\n为求极值，我们计算 $\\mathcal{L}$ 关于 $\\sigma_1, \\sigma_2, \\sigma_3$ 的偏导数，并令它们为零。\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\sigma_1} = 2\\sigma_1 - \\frac{2\\lambda \\sigma_1}{S_1^2} = 2\\sigma_1 \\left( 1 - \\frac{\\lambda}{S_1^2} \\right) = 0 $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\sigma_2} = 2\\sigma_2 - \\frac{2\\lambda \\sigma_2}{S_2^2} = 2\\sigma_2 \\left( 1 - \\frac{\\lambda}{S_2^2} \\right) = 0 $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\sigma_3} = 2\\sigma_3 - \\frac{2\\lambda \\sigma_3}{S_3^2} = 2\\sigma_3 \\left( 1 - \\frac{\\lambda}{S_3^2} \\right) = 0 $$\n以及约束条件本身。从前三个方程，我们分析非平凡解的条件（原点 $(\\sigma_1, \\sigma_2, \\sigma_3) = (0,0,0)$ 不在椭球面上，因为它不满足约束条件）。\n\n情况 1：$\\sigma_1 \\neq 0$, $\\sigma_2 = 0$, $\\sigma_3 = 0$。\n第一个方程给出 $1 - \\frac{\\lambda}{S_1^2} = 0$，这意味着 $\\lambda = S_1^2$。由于 $\\sigma_2=0$ 和 $\\sigma_3=0$，第二和第三个方程得到满足。\n将 $\\sigma_2 = 0$ 和 $\\sigma_3 = 0$ 代入约束方程：\n$$ \\frac{\\sigma_1^2}{S_1^2} + 0 + 0 = 1 \\implies \\sigma_1^2 = S_1^2 \\implies \\sigma_1 = \\pm S_1 $$\n候选点为 $(\\pm S_1, 0, 0)$。在这些点上，我们的目标函数的值为 $f = (\\pm S_1)^2 + 0^2 + 0^2 = S_1^2$。\n\n情况 2：$\\sigma_2 \\neq 0$, $\\sigma_1 = 0$, $\\sigma_3 = 0$。\n第二个方程给出 $1 - \\frac{\\lambda}{S_2^2} = 0$，这意味着 $\\lambda = S_2^2$。\n将 $\\sigma_1 = 0$ 和 $\\sigma_3 = 0$ 代入约束方程：\n$$ 0 + \\frac{\\sigma_2^2}{S_2^2} + 0 = 1 \\implies \\sigma_2^2 = S_2^2 \\implies \\sigma_2 = \\pm S_2 $$\n候选点为 $(0, \\pm S_2, 0)$。目标函数的值为 $f = 0^2 + (\\pm S_2)^2 + 0^2 = S_2^2$。\n\n情况 3：$\\sigma_3 \\neq 0$, $\\sigma_1 = 0$, $\\sigma_2 = 0$。\n第三个方程给出 $1 - \\frac{\\lambda}{S_3^2} = 0$，这意味着 $\\lambda = S_3^2$。\n将 $\\sigma_1 = 0$ 和 $\\sigma_2 = 0$ 代入约束方程：\n$$ 0 + 0 + \\frac{\\sigma_3^2}{S_3^2} = 1 \\implies \\sigma_3^2 = S_3^2 \\implies \\sigma_3 = \\pm S_3 $$\n候选点为 $(0, 0, \\pm S_3)$。目标函数的值为 $f = 0^2 + 0^2 + (\\pm S_3)^2 = S_3^2$。\n\n其他 $(\\sigma_1, \\sigma_2, \\sigma_3)$ 的分量多于一个为非零的情况是不可能的。例如，如果 $\\sigma_1 \\neq 0$ 且 $\\sigma_2 \\neq 0$，那么从前两个偏导数方程，我们必须有 $\\lambda = S_1^2$ 和 $\\lambda = S_2^2$。这将意味着 $S_1^2 = S_2^2$，这与给定的条件 $S_1 > S_2 > S_3 > 0$ 相矛盾。\n\n现在我们比较三种情况下目标函数 $f = M^2$ 的值：$S_1^2, S_2^2, S_3^2$。\n我们已知 $S_1 > S_2 > S_3 > 0$。对这些正值进行平方会保持不等式关系：$S_1^2 > S_2^2 > S_3^2$。\n因此，$f = M^2$ 的最大值是 $S_1^2$。\n模 $M$ 的最大值是该值的平方根。\n$$ M_{\\text{max}} = \\sqrt{S_1^2} = S_1 $$\n（我们取正平方根，因为 $M$ 是一个模，且 $S_1$ 已知为正值）。", "answer": "$$\\boxed{S_1}$$", "id": "2173341"}, {"introduction": "最后，我们把等式约束优化的思想从三维几何空间推广到更抽象的函数参数空间。这个问题 [@problem_id:2173359] 模拟了一个在满足实验数据点约束的条件下，寻找一组最接近“理想”模型的函数系数的工程场景。这个练习完美地展示了拉格朗日乘子法的普适性——同样是寻找“最近点”，但“空间”的维度和性质已经截然不同，这为我们将来应用这些工具解决信号处理或机器学习中的参数估计问题奠定了基础。", "problem": "一位工程师正在使用形式为 $P(t) = c_1 \\cos(t) + c_2 \\sin(t) + c_3 \\cos(2t) + c_4 \\sin(2t)$ 的三角多项式对一个周期性物理过程进行建模。这些系数被收集在一个向量 $\\mathbf{x} = (c_1, c_2, c_3, c_4)^T$ 中。根据先前的理论工作，一组理想的系数被认为是 $\\mathbf{x}_{\\text{target}} = (2, 0, 1, 0)^T$。然而，一项新的实验测量要求模型满足条件 $P(\\pi/3) = 1$。该工程师决定在满足实验约束的同时，找到在最小二乘意义上最接近理想向量 $\\mathbf{x}_{\\text{target}}$ 的系数向量 $\\mathbf{x}^*$。这意味着最小化欧几里得范数的平方 $\\|\\mathbf{x} - \\mathbf{x}_{\\text{target}}\\|^2$。请确定最优系数向量 $\\mathbf{x}^* = (c_1^*, c_2^*, c_3^*, c_4^*)^T$ 的分量。请将您的答案表示为一个包含四个系数精确分数形式的行矩阵。", "solution": "我们在线性约束条件下最小化欧几里得距离的平方。设 $\\mathbf{x}=(c_{1},c_{2},c_{3},c_{4})^{T}$，$\\mathbf{x}_{\\text{target}}=\\mathbf{x}_{0}=(2,0,1,0)^{T}$，且约束条件为 $P(\\pi/3)=1$。该约束可以写成 $\\mathbf{a}^{T}\\mathbf{x}=b$ 的形式，其中\n$$\n\\mathbf{a}=\\begin{pmatrix}\\cos(\\pi/3)\\\\ \\sin(\\pi/3)\\\\ \\cos(2\\pi/3)\\\\ \\sin(2\\pi/3)\\end{pmatrix}\n=\\begin{pmatrix}\\frac{1}{2}\\\\ \\frac{\\sqrt{3}}{2}\\\\ -\\frac{1}{2}\\\\ \\frac{\\sqrt{3}}{2}\\end{pmatrix},\\quad b=1.\n$$\n我们通过正交投影（等价于拉格朗日乘子法）来解决这个约束最小二乘问题。标准结果是\n$$\n\\mathbf{x}^{*}=\\mathbf{x}_{0}+\\frac{b-\\mathbf{a}^{T}\\mathbf{x}_{0}}{\\|\\mathbf{a}\\|^{2}}\\,\\mathbf{a}.\n$$\n计算所需的量：\n$$\n\\|\\mathbf{a}\\|^{2}=\\left(\\frac{1}{2}\\right)^{2}+\\left(\\frac{\\sqrt{3}}{2}\\right)^{2}+\\left(-\\frac{1}{2}\\right)^{2}+\\left(\\frac{\\sqrt{3}}{2}\\right)^{2}=\\frac{1}{4}+\\frac{3}{4}+\\frac{1}{4}+\\frac{3}{4}=2,\n$$\n$$\n\\mathbf{a}^{T}\\mathbf{x}_{0}=2\\cdot\\frac{1}{2}+0\\cdot\\frac{\\sqrt{3}}{2}+1\\cdot\\left(-\\frac{1}{2}\\right)+0\\cdot\\frac{\\sqrt{3}}{2}=\\frac{1}{2}.\n$$\n因此\n$$\n\\frac{b-\\mathbf{a}^{T}\\mathbf{x}_{0}}{\\|\\mathbf{a}\\|^{2}}=\\frac{1-\\frac{1}{2}}{2}=\\frac{1}{4},\n$$\n所以\n$$\n\\mathbf{x}^{*}=\\mathbf{x}_{0}+\\frac{1}{4}\\mathbf{a}=\\begin{pmatrix}2\\\\ 0\\\\ 1\\\\ 0\\end{pmatrix}+\\frac{1}{4}\\begin{pmatrix}\\frac{1}{2}\\\\ \\frac{\\sqrt{3}}{2}\\\\ -\\frac{1}{2}\\\\ \\frac{\\sqrt{3}}{2}\\end{pmatrix}=\\begin{pmatrix}2+\\frac{1}{8}\\\\ \\frac{\\sqrt{3}}{8}\\\\ 1-\\frac{1}{8}\\\\ \\frac{\\sqrt{3}}{8}\\end{pmatrix}=\\begin{pmatrix}\\frac{17}{8}\\\\ \\frac{\\sqrt{3}}{8}\\\\ \\frac{7}{8}\\\\ \\frac{\\sqrt{3}}{8}\\end{pmatrix}.\n$$\n直接验算表明，使用这些系数时 $P(\\pi/3)=1$，并且根据构造，它们是在欧几里得范数下最接近 $\\mathbf{x}_{\\text{target}}$ 的向量。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{17}{8} & \\frac{\\sqrt{3}}{8} & \\frac{7}{8} & \\frac{\\sqrt{3}}{8}\\end{pmatrix}}$$", "id": "2173359"}]}