{"hands_on_practices": [{"introduction": "要掌握障碍方法，第一步是理解其核心构件——障碍函数。这些函数将约束问题转化为一系列无约束问题，而对这些新函数进行优化的基础是计算其梯度。本练习将引导你计算标准对数障碍函数的梯度，这是实现内点法所需的一项基本微积分技能。通过这个练习，你将熟悉如何处理由一组线性不等式定义的多胞形的障碍函数 [@problem_id:2155906]。", "problem": "在优化领域，内点法是用于求解线性和非线性凸优化问题的一类算法。这类方法的一个关键组成部分是使用障碍函数来处理不等式约束。\n\n考虑一个由$\\mathbb{R}^n$中的$m$个线性不等式组定义的可行集，其矩阵形式写为$Ax \\le b$，其中$A$是一个$m \\times n$矩阵，$b$是一个$m \\times 1$向量。记$a_i^T$为矩阵$A$的第$i$行，记$b_i$为向量$b$的第$i$个分量。因此，第$i$个不等式为$a_i^T x \\le b_i$。\n\n对于严格可行（即对所有$i=1, \\dots, m$都有$a_i^T x < b_i$）的点$x$，此不等式组的标准对数障碍函数定义为：\n$$ \\phi(x) = -\\sum_{i=1}^m \\ln(b_i - a_i^T x) $$\n您的任务是求出该函数的梯度$\\nabla \\phi(x)$。请用向量$a_i$（其中$a_i$是与行向量$a_i^T$的转置相对应的列向量）、$x$和标量$b_i$来表示您的最终答案。", "solution": "我们已知对于严格可行的$x$的对数障碍函数为：\n$$\n\\phi(x) = -\\sum_{i=1}^{m} \\ln\\!\\big(b_i - a_i^{T} x\\big).\n$$\n对每个$i$定义$f_i(x) = -\\ln\\!\\big(b_i - a_i^{T} x\\big)$。根据应用于标量函数$g(u) = -\\ln(u)$与$u_i(x) = b_i - a_i^{T} x$的复合函数的链式法则，我们有\n$$\n\\nabla f_i(x) = g^{\\prime}\\!\\big(u_i(x)\\big)\\,\\nabla u_i(x).\n$$\n计算导数：\n- $g^{\\prime}(u) = -\\frac{1}{u}$，所以$g^{\\prime}\\!\\big(u_i(x)\\big) = -\\frac{1}{b_i - a_i^{T} x}$。\n- 由于$u_i(x) = b_i - a_i^{T} x$是仿射函数，其梯度为$\\nabla u_i(x) = -a_i$。\n\n因此，\n$$\n\\nabla f_i(x) = -\\frac{1}{b_i - a_i^{T} x}\\,(-a_i) = \\frac{a_i}{b_i - a_i^{T} x}.\n$$\n对所有$i$求和，\n$$\n\\nabla \\phi(x) = \\sum_{i=1}^{m} \\nabla f_i(x) = \\sum_{i=1}^{m} \\frac{a_i}{b_i - a_i^{T} x}.\n$$\n该表达式对于满足所有$i$都有$a_i^{T} x < b_i$的严格可行的$x$成立。", "answer": "$$\\boxed{\\sum_{i=1}^{m}\\frac{a_i}{b_i - a_i^{T} x}}$$", "id": "2155906"}, {"introduction": "在计算出梯度之后，下一步自然是考虑如何高效地求解中心路径上的点。牛顿法是一种强大的工具，它利用目标函数的二阶导数（即Hessian矩阵）来加速收敛。本练习通过一个简单的一维问题，让你计算一个障碍目标函数的二阶导数，从而直观地理解障碍项如何影响函数的曲率，并保证中心化子问题的凸性 [@problem_id:2155935]。", "problem": "在数值优化中，内点法（通常也称为障碍法）通过将有约束优化问题转化为一系列无约束问题来求解。这是通过在目标函数中加入一个“障碍”项来实现的，该项会对接近可行域边界的解进行惩罚。\n\n考虑以下一维优化问题：\n$$\n\\begin{align*}\n\\text{minimize} \\quad & f(x) = \\frac{1}{2}x^2 \\\\\n\\text{subject to} \\quad & x \\le b\n\\end{align*}\n$$\n其中$x$是优化变量，$b$是一个给定的实数常量。\n\n对数障碍法通过最小化无约束目标函数来近似此问题\n$$\nF_t(x) = f(x) - \\frac{1}{t} \\ln(b-x)\n$$\n其中$t > 0$是一个控制近似精度的参数。该表达式在$x < b$时有效，这正是可行集的严格内部。\n\n你的任务是求障碍目标函数$F_t(x)$关于$x$的二阶导数。请用$x$、$b$和$t$的符号表达式来表示你的答案。", "solution": "给定的障碍目标函数为\n$$\nF_{t}(x)=\\frac{1}{2}x^{2}-\\frac{1}{t}\\ln(b-x),\n$$\n在$x<b$时有效，其中$t>0$是一个常数。为了求出关于$x$的二阶导数，我们分步进行。\n\n使用线性和链式法则求一阶导数：\n- $\\frac{1}{2}x^{2}$的导数是$x$。\n- 对于对数项，使用$\\frac{\\mathrm{d}}{\\mathrm{d}x}\\ln(u)=\\frac{1}{u}\\frac{\\mathrm{d}u}{\\mathrm{d}x}$，令$u=b-x$，因此$\\frac{\\mathrm{d}}{\\mathrm{d}x}\\ln(b-x)=-\\frac{1}{b-x}$。\n因此，\n$$\nF_{t}'(x)=x-\\frac{1}{t}\\left(-\\frac{1}{b-x}\\right)=x+\\frac{1}{t(b-x)}.\n$$\n\n对$(b-x)^{-1}$使用幂法则和链式法则求二阶导数：\n- $x$的导数是$1$。\n- 将$\\frac{1}{t(b-x)}$写作$\\frac{1}{t}(b-x)^{-1}$；那么\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left[\\frac{1}{t}(b-x)^{-1}\\right]=\\frac{1}{t}\\cdot(-1)(b-x)^{-2}\\cdot(-1)=\\frac{1}{t(b-x)^{2}}.\n$$\n所以，\n$$\nF_{t}''(x)=1+\\frac{1}{t(b-x)^{2}}.\n$$", "answer": "$$\\boxed{1+\\frac{1}{t(b-x)^{2}}}$$", "id": "2155935"}, {"introduction": "理解了梯度和Hessian矩阵的计算后，我们便可以将这些基本工具应用于更通用且更实际的优化问题中。内点法的核心在于，在每一次迭代中，通过求解一个线性系统来计算牛顿搜索方向。本练习将带你从简单的导数计算，迈向构建求解二次规划（QP）问题的牛顿系统，要求你推导该系统雅可比矩阵的关键部分。这不仅巩固了你对导数的理解，也揭示了复杂优化算法的内部运作机制 [@problem_id:2155926]。", "problem": "考虑一个标准的凸二次规划 (QP) 问题，其目标是在线性不等式约束下最小化一个二次函数：\n$$\n\\min_{x \\in \\mathbb{R}^n} \\frac{1}{2}x^T Q x + c^T x \\quad \\text{subject to} \\quad Ax \\le b\n$$\n其中，$x \\in \\mathbb{R}^n$是优化变量，$Q \\in \\mathbb{R}^{n \\times n}$是一个对称正半定矩阵，$c \\in \\mathbb{R}^n$是一个向量，$A \\in \\mathbb{R}^{m \\times n}$是一个矩阵，而$b \\in \\mathbb{R}^m$是一个向量。\n\n原始-对偶内点法是解决此类问题的强大技术。它们通过引入松弛变量$s \\in \\mathbb{R}^m$将不等式约束转换为等式约束 ($Ax+s=b, s \\ge 0$)，然后对$s$的非负约束应用对数障碍。该方法将原始约束问题转化为一个寻找解$(x, \\lambda, s)$的任务，该解满足一组针对参数$t>0$的扰动 Karush-Kuhn-Tucker (KKT) 条件：\n1.  $Qx + c + A^T \\lambda = 0$\n2.  $Ax + s - b = 0$\n3.  $\\operatorname{diag}(s)\\lambda = (1/t)\\mathbf{1}$\n\n其中，$\\lambda \\in \\mathbb{R}^m$是对偶变量向量，$\\mathbf{1}$是所有元素均为1的$m \\times 1$向量，$\\operatorname{diag}(v)$表示一个方阵，其主对角线上的元素是向量$v$的元素，其他位置为零。\n\n为了求解这个非线性系统，我们采用牛顿法。在每次迭代中，给定一个严格可行点$(x, \\lambda, s)$ (其中$s>0, \\lambda>0$)，我们通过求解对 KKT 方程进行线性化后得到的线性系统，来计算搜索方向$(\\Delta x, \\Delta \\lambda, \\Delta s)$。该线性系统可以写成一个 3x3 的分块矩阵形式：\n$$\n\\begin{pmatrix} M_{11} & M_{12} & M_{13} \\\\ M_{21} & M_{22} & M_{23} \\\\ M_{31} & M_{32} & M_{33} \\end{pmatrix} \\begin{pmatrix} \\Delta x \\\\ \\Delta \\lambda \\\\ \\Delta s \\end{pmatrix} = \\begin{pmatrix} r_{\\text{dual}} \\\\ r_{\\text{primal}} \\\\ r_{\\text{cent}} \\end{pmatrix}\n$$\n其中左侧的矩阵是 KKT 方程组的雅可比矩阵。\n\n确定构成该雅可比矩阵第一分块列的分块矩阵：$M_{11}$、$M_{21}$和$M_{31}$。用问题数据 ($Q, A, b, c$) 和当前迭代点的变量 ($x, \\lambda, s$) 来表示你的答案。你的最终答案应该是一个包含这三个所需分块矩阵的复合行矩阵，并按顺序排列。使用$I$表示单位矩阵，使用$0$表示适当维度的零矩阵。", "solution": "我们将扰动的 KKT 方程写成如下映射\n$$\nF(x,\\lambda,s) \\equiv \\begin{pmatrix}\nQx + c + A^{T}\\lambda \\\\\nAx + s - b \\\\\n\\operatorname{diag}(s)\\lambda - \\frac{1}{t}\\mathbf{1}\n\\end{pmatrix} = 0.\n$$\n牛顿系统在一个严格可行点对该映射进行线性化并使用其雅可比矩阵。雅可比矩阵的第一分块列由每个分块方程对$x$的偏导数组成。\n\n对于第一个方程$Qx + c + A^{T}\\lambda = 0$，其关于$x$的导数是\n$$\n\\frac{\\partial}{\\partial x}(Qx + c + A^{T}\\lambda) = Q,\n$$\n所以$M_{11} = Q$。\n\n对于第二个方程$Ax + s - b = 0$，其关于$x$的导数是\n$$\n\\frac{\\partial}{\\partial x}(Ax + s - b) = A,\n$$\n所以$M_{21} = A$。\n\n对于第三个方程$\\operatorname{diag}(s)\\lambda - \\frac{1}{t}\\mathbf{1} = 0$，它不依赖于$x$，因此\n$$\n\\frac{\\partial}{\\partial x}\\big(\\operatorname{diag}(s)\\lambda - \\tfrac{1}{t}\\mathbf{1}\\big) = 0,\n$$\n所以$M_{31} = 0$ (其维度为$m \\times n$)。\n\n因此，第一分块列由三个分块$M_{11} = Q$、$M_{21} = A$和$M_{31} = 0$给出，我们按要求的复合行矩阵顺序列出它们。", "answer": "$$\\boxed{\\begin{pmatrix} Q & A & 0 \\end{pmatrix}}$$", "id": "2155926"}]}