{"hands_on_practices": [{"introduction": "在我们领略快速傅里叶变换（FFT）的“快”之前，我们必须首先理解变换本身。第一个练习将我们带回基础，将离散傅里叶变换（DFT）的基本定义应用于最简单的非平凡信号。通过手动计算 2 点 DFT，你将对时域信号如何转换为其频域表示建立起坚实的理解 [@problem_id:2213507]。", "problem": "离散傅里叶变换 (DFT) 是数字信号处理中的一个基本工具，它将一个函数的有限等间隔采样序列转换为其离散时间傅里叶变换的等长等间隔采样序列。对于一个包含 $N$ 个数的有限序列 $x = [x_0, x_1, \\dots, x_{N-1}]$，其 DFT，记为 $X = [X_0, X_1, \\dots, X_{N-1}]$，由以下公式定义：\n$$X_k = \\sum_{n=0}^{N-1} x_n \\cdot \\exp\\left(-i \\frac{2\\pi kn}{N}\\right)$$\n其中 $k = 0, 1, \\dots, N-1$。这里，$i$ 是虚数单位，满足 $i^2 = -1$。\n\n考虑一个长度为 $N=2$ 的简单实值序列 $x = [a, b]$，其中 $a$ 和 $b$ 是任意实常数。\n\n计算该序列的 2 点 DFT。将您的答案表示为一个按顺序包含分量 $X_0$ 和 $X_1$ 的行向量。", "solution": "题目要求我们求序列 $x = [x_0, x_1] = [a, b]$ 的 2 点离散傅里叶变换 (DFT)。该序列的大小为 $N=2$。DFT 的通用公式为：\n$$X_k = \\sum_{n=0}^{N-1} x_n \\cdot \\exp\\left(-i \\frac{2\\pi kn}{N}\\right)$$\n\n我们需要计算分量 $X_0$ 和 $X_1$。\n\n首先，我们通过在公式中令 $k=0$ 来计算分量 $X_0$：\n$$X_0 = \\sum_{n=0}^{1} x_n \\cdot \\exp\\left(-i \\frac{2\\pi (0)n}{2}\\right)$$\n$$X_0 = \\sum_{n=0}^{1} x_n \\cdot \\exp(0)$$\n由于 $\\exp(0) = 1$，表达式可简化为：\n$$X_0 = \\sum_{n=0}^{1} x_n = x_0 + x_1$$\n代入给定值 $x_0 = a$ 和 $x_1 = b$，我们得到：\n$$X_0 = a + b$$\n\n接下来，我们通过在公式中令 $k=1$ 来计算分量 $X_1$：\n$$X_1 = \\sum_{n=0}^{1} x_n \\cdot \\exp\\left(-i \\frac{2\\pi (1)n}{2}\\right)$$\n$$X_1 = \\sum_{n=0}^{1} x_n \\cdot \\exp(-i \\pi n)$$\n我们展开这个求和：\n$$X_1 = x_0 \\cdot \\exp(-i \\pi \\cdot 0) + x_1 \\cdot \\exp(-i \\pi \\cdot 1)$$\n$$X_1 = x_0 \\cdot \\exp(0) + x_1 \\cdot \\exp(-i \\pi)$$\n我们知道 $\\exp(0)=1$。对于第二项，我们使用欧拉公式 $\\exp(i\\theta) = \\cos(\\theta) + i\\sin(\\theta)$。\n$$\\exp(-i\\pi) = \\cos(-\\pi) + i\\sin(-\\pi) = -1 + i(0) = -1$$\n将这些值代回 $X_1$ 的表达式中：\n$$X_1 = x_0 \\cdot (1) + x_1 \\cdot (-1)$$\n$$X_1 = x_0 - x_1$$\n代入给定值 $x_0 = a$ 和 $x_1 = b$，我们得到：\n$$X_1 = a - b$$\n\n得到的 DFT 序列为 $X = [X_0, X_1] = [a+b, a-b]$。题目要求将这些分量按顺序表示为一个行向量。", "answer": "$$\\boxed{\\begin{pmatrix} a+b & a-b \\end{pmatrix}}$$", "id": "2213507"}, {"introduction": "FFT 的输出是一组抽象的复数。为了使其有用，我们必须学会将这些数值转换回它们所代表的物理频率。本练习模拟了一个来自生物医学工程的真实场景，你将把 FFT 输出的索引映射到以赫兹（Hz）为单位的特定频率 [@problem_id:2213513]。这项技能对于任何分析信号的人来说都是基础，无论是音频工程师还是天体物理学家。", "problem": "一位生物医学工程师正在分析肌电图 (EMG) 信号，该信号测量骨骼肌的电活动，以研究肌肉疲劳。该信号是使用表面电极从一名运动员的腿部肌肉中采集的。数据以 $f_s = 400$ Hz 的恒定速率进行采样。为了进行频谱分析，使用快速傅里叶变换 (FFT) 算法处理了一段包含 $N = 128$ 个连续数据点的信号。得到的频谱在频率索引 $k=10$ 处显示出一个显著的峰值。这个峰值代表了在特定收缩期间肌肉放电率中的一个主导频率分量。假设索引 $k=0$ 对应于直流 (DC) 分量，请确定此主导分量的物理频率。\n\n答案以赫兹 (Hz) 为单位的数值表示。", "solution": "对于一个以速率 $f_s$ 采样并使用 $N$ 点 DFT/FFT 进行分析的离散时间信号，频率间隔（分辨率）为\n$$\n\\Delta f = \\frac{f_s}{N}.\n$$\n对应于索引 $k$（其中 $k=0$ 为直流分量）的物理频率为\n$$\nf_k = k\\,\\Delta f = \\frac{k f_s}{N}.\n$$\n已知 $f_s = 400$ Hz，$N = 128$，且 $k = 10$，\n$$\nf_{10} = \\frac{10 \\times 400}{128} = \\frac{4000}{128} = \\frac{250}{8} = 31.25 \\text{ Hz}.\n$$\n因此，主导分量位于 31.25 Hz。", "answer": "$$\\boxed{31.25}$$", "id": "2213513"}, {"introduction": "FFT 最强大的应用之一是它能够比传统方法快得多地执行卷积运算，这对于信号滤波和图像处理等任务至关重要。本练习让你扮演一名需要高效过滤时间序列的数据科学家的角色，要求你为基于 FFT 的卷积确定正确的设置 [@problem_id:2213563]。它突出了一个关键的实际考虑：通过补零来确保计算的正确性和效率。", "problem": "一位数据科学家正在分析一段高频金融时间序列。该数据段包含 $N_1 = 50$ 个离散数据点。为减少噪声并识别潜在趋势，该科学家决定使用移动平均法来应用一个平滑滤波器。这个移动平均滤波器的脉冲响应长度为 $N_2 = 10$ 个点。\n\n该科学家计划通过计算数据段与滤波器脉冲响应的线性卷积来执行滤波操作。为提高计算效率，此操作将使用快速傅里叶变换 (FFT) 算法来实现。为确保结果等同于线性卷积（而非循环卷积），信号在变换前必须进行适当的零填充。当变换长度是2的幂时，FFT 算法的效率最高。\n\n要正确计算数据段与滤波器响应之间的线性卷积，所需的最小的2的幂次FFT长度是多少？", "solution": "设数据段长度为 $N_{1}=50$，滤波器脉冲响应长度为 $N_{2}=10$。两个有限长度序列的线性卷积长度为\n$$\nN_{\\text{lin}}=N_{1}+N_{2}-1.\n$$\n要通过基于FFT的循环卷积来计算线性卷积，每个序列都必须进行零填充，以使循环卷积长度 $L$ 满足\n$$\nL\\geq N_{\\text{lin}}=N_{1}+N_{2}-1.\n$$\n因为FFT对于2的幂次长度效率最高，所以最小的有效FFT长度是不小于 $N_{1}+N_{2}-1$ 的最小2的幂，即\n$$\nL_{\\min}=2^{\\lceil \\log_{2}(N_{1}+N_{2}-1)\\rceil}.\n$$\n代入给定的长度，\n$$\nN_{\\text{lin}}=50+10-1=59.\n$$\n找到满足 $2^{m}\\geq 59$ 的最小整数 $m$。由于 $2^{5}=32<59$ 且 $2^{6}=64\\geq 59$，可得 $m=6$，因此\n$$\nL_{\\min}=2^{6}=64.\n$$\n因此，所需的最小的2的幂次FFT长度是 $64$。", "answer": "$$\\boxed{64}$$", "id": "2213563"}]}