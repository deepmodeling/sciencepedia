{"hands_on_practices": [{"introduction": "矩形脉冲是数字通信和电子学中的一个基石信号。掌握将这种看似简单的非正弦函数表示为正弦和余弦之和的能力，是理解傅里叶级数的一个基本必经之路。这个练习 [@problem_id:2223999] 将引导你使用积分定义计算傅里叶系数，提供一个具体的例子，展示复杂的周期性波形是如何由简单的谐波分量构成的。", "problem": "在数字电子学中，信号常被建模为周期性脉冲序列。考虑一个周期为 $2\\pi$ 的理想化周期信号 $f(x)$。在一个周期的主区间 $[-\\pi, \\pi]$ 上，该函数由一个单一的矩形脉冲定义：\n$$\nf(x) = \\begin{cases} 1 & \\text{if } -\\frac{\\pi}{2} \\le x \\le \\frac{\\pi}{2} \\\\ 0 & \\text{if } -\\pi \\le x < -\\frac{\\pi}{2} \\text{ or } \\frac{\\pi}{2} < x \\le \\pi \\end{cases}\n$$\n任何此类周期函数都可以用傅里叶级数表示，其形式为 $f(x) = \\frac{a_0}{2} + \\sum_{n=1}^{\\infty} (a_n \\cos(nx) + b_n \\sin(nx))$。\n\n对于任何整数 $n \\ge 1$，确定余弦系数 $a_n$ 的通用表达式。该表达式应为一个关于 $n$ 的单一公式。", "solution": "对于一个周期为 $2\\pi$ 的实值函数，其傅里叶余弦系数由下式给出\n$$\na_{n}=\\frac{1}{\\pi}\\int_{-\\pi}^{\\pi} f(x)\\cos(nx)\\,dx,\\quad n\\ge 1.\n$$\n给定的函数 $f(x)$ 在 $[-\\frac{\\pi}{2},\\frac{\\pi}{2}]$ 上等于 $1$，在区间 $[-\\pi,\\pi]$ 内的其他位置等于 $0$。因此，\n$$\na_{n}=\\frac{1}{\\pi}\\int_{-\\frac{\\pi}{2}}^{\\frac{\\pi}{2}} \\cos(nx)\\,dx.\n$$\n进行积分，\n$$\n\\int \\cos(nx)\\,dx=\\frac{1}{n}\\sin(nx),\n$$\n所以\n$$\na_{n}=\\frac{1}{\\pi}\\left[\\frac{1}{n}\\sin(nx)\\right]_{x=-\\frac{\\pi}{2}}^{x=\\frac{\\pi}{2}}\n=\\frac{1}{n\\pi}\\left(\\sin\\!\\left(\\frac{n\\pi}{2}\\right)-\\sin\\!\\left(-\\frac{n\\pi}{2}\\right)\\right).\n$$\n利用正弦函数的奇函数性质 $\\sin(-y)=-\\sin(y)$，上式可简化为\n$$\na_{n}=\\frac{2}{n\\pi}\\sin\\!\\left(\\frac{n\\pi}{2}\\right).\n$$\n这个单一公式对每个整数 $n\\ge 1$ 都成立。", "answer": "$$\\boxed{\\frac{2}{n\\pi}\\sin\\!\\left(\\frac{n\\pi}{2}\\right)}$$", "id": "2223999"}, {"introduction": "虽然连续函数是出色的理论模型，但现实世界的信号处理是在计算机上使用离散数据点进行的。这就需要我们从连续的傅里叶级数转向其计算上的对应物——离散傅里叶变换（DFT）。这个实践 [@problem_id:2223980] 让你亲自动手应用DFT的定义，计算一个简单离散信号的频率分量，看看在数字域中信号的能量是如何分布在不同频率上的。", "problem": "在数字信号处理中，一个简单的振荡信号可以由一个离散的样本序列表示。考虑这样一个信号，在四个时间点上进行采样，得到序列 $x = (x[0], x[1], x[2], x[3])$，其中 $x[0]=1$，$x[1]=0$，$x[2]=-1$，且 $x[3]=0$。\n\n为了分析该信号的频率成分，可以计算其离散傅里叶变换 (DFT)。一个长度为 $N$ 的序列 $x[n]$ 的 $N$ 点 DFT 是另一个长度为 $N$ 的序列 $X[k]$，由以下分析方程定义：\n$$ X[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\left(-i \\frac{2\\pi}{N} nk\\right) $$\n对于 $k = 0, 1, \\dots, N-1$，其中 $i$ 是满足 $i^2 = -1$ 的虚数单位。\n\n使用上述定义，计算给定信号序列 $x$ 的 4 点 DFT。你的答案应该是复数序列 $(X[0], X[1], X[2], X[3])$。", "solution": "给定一个长度为 $N$ 的序列 $x[n]$，其中 $N=4$，$x[0]=1$，$x[1]=0$，$x[2]=-1$，且 $x[3]=0$。4 点 DFT 的定义为\n$$\nX[k] = \\sum_{n=0}^{3} x[n] \\exp\\left(-i \\frac{2\\pi}{4} nk\\right), \\quad k=0,1,2,3.\n$$\n将给定的 $x[n]$ 值代入求和式中，\n$$\nX[k] = 1\\cdot \\exp(0) + 0\\cdot \\exp\\left(-i \\frac{2\\pi}{4} k\\right) + (-1)\\cdot \\exp\\left(-i \\frac{2\\pi}{4} 2k\\right) + 0\\cdot \\exp\\left(-i \\frac{2\\pi}{4} 3k\\right).\n$$\n使用 $\\exp(0)=1$，上式可简化为\n$$\nX[k] = 1 - \\exp(-i \\pi k).\n$$\n对于整数 $k$，使用欧拉公式可得\n$$\n\\exp(-i \\pi k) = \\cos(\\pi k) - i \\sin(\\pi k) = (-1)^{k},\n$$\n因为 $\\sin(\\pi k)=0$ 且 $\\cos(\\pi k)=(-1)^{k}$。因此，\n$$\nX[k] = 1 - (-1)^{k}.\n$$\n对 $k=0,1,2,3$ 求值：\n- 当 $k=0$ 时：$X[0] = 1 - 1 = 0$。\n- 当 $k=1$ 时：$X[1] = 1 - (-1) = 2$。\n- 当 $k=2$ 时：$X[2] = 1 - 1 = 0$。\n- 当 $k=3$ 时：$X[3] = 1 - (-1) = 2$。\n\n因此，4 点 DFT 序列为 $(0, 2, 0, 2)$。", "answer": "$$\\boxed{\\begin{pmatrix} 0 & 2 & 0 & 2 \\end{pmatrix}}$$", "id": "2223980"}, {"introduction": "在实际应用中，我们处理的往往是一组可能包含噪声的测量数据，而不是一个完美的数学函数。在这种情况下，强迫一个模型精确地穿过每一个数据点（即插值）可能会产生误导。这个练习 [@problem_id:2224003] 介绍了最小二乘近似这一强大概念，它是一种寻找“最佳拟合”三角多项式以捕捉数据基本趋势的方法，这是数据分析、科学建模和工程领域的一项关键技能。", "problem": "一位工程师正在分析一个周期信号，他在一个基本周期内以等时间间隔采集了 $N=4$ 个测量值。这些数据点记为 $(x_j, y_j)$（其中 $j=0, 1, 2, 3$），定义在一个归一化区间 $[0, 2\\pi)$ 上。这些点由 $x_j = \\frac{\\pi j}{2}$ 给出，对应的测量值为 $y_0 = 1.0$、$y_1 = 0.0$、$y_2 = -1.0$ 和 $y_3 = 0.2$。\n\n该工程师考虑用两种不同的三角模型来拟合这些数据。\n\n**模型 A：** 三角插值多项式 $P(x)$，它被构建为精确地穿过所有四个数据点。根据定义，该模型的平方误差和 $\\sum_{j=0}^{3} (y_j - P(x_j))^2$ 精确为零。\n\n**模型 B：** 1次的最小二乘三角逼近，记为 $S(x)$。该多项式形式为 $S(x) = \\frac{c_0}{2} + c_1 \\cos(x) + d_1 \\sin(x)$，其系数的选择是为了最小化平方误差和 $E = \\sum_{j=0}^{3} (y_j - S(x_j))^2$。\n\n计算模型 B 的平方误差和 $E$。", "solution": "给定一个周期内的四个等距样本：$x_{j}=\\frac{\\pi j}{2}$（$j=0,1,2,3$），以及对应的 $y_{0}=1$、$y_{1}=0$、$y_{2}=-1$、$y_{3}=\\frac{1}{5}$。模型 B 为 $S(x)=\\frac{c_{0}}{2}+c_{1}\\cos x + d_{1}\\sin x$，其最小二乘系数使得 $E=\\sum_{j=0}^{3}\\left(y_{j}-S(x_{j})\\right)^{2}$ 最小化。\n\n在网格点 $x_{j}=0,\\frac{\\pi}{2},\\pi,\\frac{3\\pi}{2}$ 上，使用离散内积 $\\langle f,g\\rangle=\\sum_{j=0}^{3}f(x_{j})g(x_{j})$，基 $\\{1,\\cos x,\\sin x\\}$ 是正交的：\n$\\langle 1,1\\rangle=4$, $\\langle \\cos x,\\cos x\\rangle=2$, $\\langle \\sin x,\\sin x\\rangle=2$，并且它们之间的所有交叉内积均为零。因此，最优系数是正交投影：\n$$\n\\frac{c_{0}}{2}=\\frac{\\langle y,1\\rangle}{\\langle 1,1\\rangle},\\quad\nc_{1}=\\frac{\\langle y,\\cos x\\rangle}{\\langle \\cos x,\\cos x\\rangle},\\quad\nd_{1}=\\frac{\\langle y,\\sin x\\rangle}{\\langle \\sin x,\\sin x\\rangle}.\n$$\n使用 $\\cos x_{j}=[1,0,-1,0]$ 和 $\\sin x_{j}=[0,1,0,-1]$ 计算所需的和：\n$$\n\\langle y,1\\rangle = 1+0-1+\\frac{1}{5} = \\frac{1}{5},\\quad\n\\langle y,\\cos x\\rangle = 1\\cdot 1 + 0\\cdot 0 + (-1)\\cdot(-1) + \\frac{1}{5}\\cdot 0 = 2,\n$$\n$$\n\\langle y,\\sin x\\rangle = 1\\cdot 0 + 0\\cdot 1 + (-1)\\cdot 0 + \\frac{1}{5}\\cdot(-1) = -\\frac{1}{5}.\n$$\n因此，\n$$\n\\frac{c_{0}}{2}=\\frac{\\frac{1}{5}}{4}=\\frac{1}{20}\\quad\\Rightarrow\\quad c_{0}=\\frac{1}{10},\\qquad\nc_{1}=\\frac{2}{2}=1,\\qquad\nd_{1}=\\frac{-\\frac{1}{5}}{2}=-\\frac{1}{10}.\n$$\n于是 $S(x)=\\frac{1}{20}+ \\cos x - \\frac{1}{10}\\sin x$。计算 $S(x_{j})$ 和残差 $r_{j}=y_{j}-S(x_{j})$：\n- 在 $x_{0}=0$ 处：$S(0)=\\frac{1}{20}+1+0=\\frac{21}{20}$，所以 $r_{0}=1-\\frac{21}{20}=-\\frac{1}{20}$。\n- 在 $x_{1}=\\frac{\\pi}{2}$ 处：$S\\!\\left(\\frac{\\pi}{2}\\right)=\\frac{1}{20}+0-\\frac{1}{10}=-\\frac{1}{20}$，所以 $r_{1}=0-\\left(-\\frac{1}{20}\\right)=\\frac{1}{20}$。\n- 在 $x_{2}=\\pi$ 处：$S(\\pi)=\\frac{1}{20}-1+0=-\\frac{19}{20}$，所以 $r_{2}=-1-\\left(-\\frac{19}{20}\\right)=-\\frac{1}{20}$。\n- 在 $x_{3}=\\frac{3\\pi}{2}$ 处：$S\\!\\left(\\frac{3\\pi}{2}\\right)=\\frac{1}{20}+0+\\frac{1}{10}=\\frac{3}{20}$，所以 $r_{3}=\\frac{1}{5}-\\frac{3}{20}=\\frac{1}{20}$。\n\n因此，\n$$\nE=\\sum_{j=0}^{3} r_{j}^{2} = 4\\left(\\frac{1}{20}\\right)^{2} = \\frac{4}{400} = \\frac{1}{100}.\n$$", "answer": "$$\\boxed{\\frac{1}{100}}$$", "id": "2224003"}]}