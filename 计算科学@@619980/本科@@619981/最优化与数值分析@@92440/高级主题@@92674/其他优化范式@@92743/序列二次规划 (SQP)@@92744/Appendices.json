{"hands_on_practices": [{"introduction": "序列二次规划（SQP）的核心思想是在每个迭代点用一个二次规划（QP）子问题来逼近原始的非线性规划问题。构建这个QP子问题需要原始问题在当前点的局部信息，即目标函数的梯度和约束函数的雅可比矩阵。本练习将引导你计算这些基本构建模块，为理解SQP算法的第一步奠定坚实的基础。[@problem_id:2201991]", "problem": "考虑以下非线性优化问题：\n最小化 $f(x_1, x_2) = \\exp(x_1 + x_2)$\n满足等式约束 $h(x_1, x_2) = x_1^2 + x_2^2 - 1 = 0$。\n\n解决此类问题的一个有效方法是序列二次规划 (Sequential Quadratic Programming, SQP) 算法。该算法的第一次迭代从一个初始点 $\\mathbf{x}_0$ 开始，并涉及求解一个二次规划 (Quadratic Programming, QP) 子问题。为了构建这个子问题，我们需要目标函数的梯度 $\\nabla f(\\mathbf{x})$ 和约束函数的雅可比矩阵 $J_h(\\mathbf{x})$。\n\n给定初始点 $\\mathbf{x}_0 = (1, 1)$，求目标函数的梯度 $\\nabla f(\\mathbf{x}_0)$ 和约束的雅可比矩阵 $J_h(\\mathbf{x}_0)$。\n\n将您的结果表示为一个 $2 \\times 2$ 矩阵，其中第一行是目标函数梯度的转置 $\\nabla f(\\mathbf{x}_0)^T$ 的分量，第二行是约束函数雅可比矩阵 $J_h(\\mathbf{x}_0)$ 的分量。", "solution": "我们给定的目标函数为 $f(x_{1},x_{2})=\\exp(x_{1}+x_{2})$，等式约束为 $h(x_{1},x_{2})=x_{1}^{2}+x_{2}^{2}-1=0$，初始点为 $\\mathbf{x}_{0}=(1,1)$。我们需要求 $\\nabla f(\\mathbf{x}_{0})$ 和 $J_{h}(\\mathbf{x}_{0})$。\n\n首先，计算目标函数的梯度。对 $f(x_{1},x_{2})=\\exp(x_{1}+x_{2})$ 使用链式法则，\n$$\n\\frac{\\partial f}{\\partial x_{1}}=\\exp(x_{1}+x_{2}), \\quad \\frac{\\partial f}{\\partial x_{2}}=\\exp(x_{1}+x_{2}).\n$$\n因此，\n$$\n\\nabla f(x_{1},x_{2})=\\begin{pmatrix}\\exp(x_{1}+x_{2}) \\\\ \\exp(x_{1}+x_{2})\\end{pmatrix}.\n$$\n在点 $\\mathbf{x}_{0}=(1,1)$ 处求值得到\n$$\n\\nabla f(\\mathbf{x}_{0})=\\begin{pmatrix}\\exp(2) \\\\ \\exp(2)\\end{pmatrix}, \\quad \\nabla f(\\mathbf{x}_{0})^{T}=\\begin{pmatrix}\\exp(2)  \\exp(2)\\end{pmatrix}.\n$$\n\n接下来，计算约束的雅可比矩阵。对于 $h(x_{1},x_{2})=x_{1}^{2}+x_{2}^{2}-1$，其偏导数为\n$$\n\\frac{\\partial h}{\\partial x_{1}}=2x_{1}, \\quad \\frac{\\partial h}{\\partial x_{2}}=2x_{2}.\n$$\n由于 $h:\\mathbb{R}^{2}\\to\\mathbb{R}$，其雅可比矩阵是一个 $1\\times 2$ 的行向量\n$$\nJ_{h}(x_{1},x_{2})=\\begin{pmatrix}2x_{1}  2x_{2}\\end{pmatrix}.\n$$\n在点 $\\mathbf{x}_{0}=(1,1)$ 处求值得到\n$$\nJ_{h}(\\mathbf{x}_{0})=\\begin{pmatrix}2  2\\end{pmatrix}.\n$$\n\n因此，所求的 $2\\times 2$ 矩阵，其第一行为 $\\nabla f(\\mathbf{x}_{0})^{T}$，第二行为 $J_{h}(\\mathbf{x}_{0})$，是\n$$\n\\begin{pmatrix}\n\\exp(2)  \\exp(2) \\\\\n2  2\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\exp(2)  \\exp(2) \\\\ 2  2\\end{pmatrix}}$$", "id": "2201991"}, {"introduction": "掌握了构建QP子问题的基本要素后，下一步是完整地求解它以获得搜索方向。这个搜索方向 $p$ 指导我们如何从当前点移动到下一个更优的估计点。通过解决这个实际问题，你将亲身体验SQP算法的核心迭代步骤，将理论模型转化为具体的求解过程。[@problem_id:2202023]", "problem": "考虑在等式约束 $c(x_1, x_2) = 0$ 下最小化函数 $f(x_1, x_2)$ 的非线性优化问题。序列二次规划 (SQP) 方法是求解此类问题的一种迭代算法。在每次迭代中，通过求解一个二次规划 (QP) 子问题来找到搜索方向，该子问题由拉格朗日函数的二次模型和约束的线性模型构建而成。\n\n设目标函数为 $f(x_1, x_2) = x_1 + x_2^2$，等式约束由方程 $(x_1-1)^2 + x_2^2 = 1$ 给出。\n\n我们希望从初始点 $x_0 = (1, 1)$ 开始，执行 SQP 算法的第一次迭代。用于寻找搜索方向 $p = (p_1, p_2)$ 的 QP 子问题定义如下：\n\n最小化：$q(p) = \\frac{1}{2} p^T B_0 p + \\nabla f(x_0)^T p$\n约束条件：$\\nabla c(x_0)^T p + c(x_0) = 0$\n\n对于此问题，使用单位矩阵 $B_0 = I$ 作为拉格朗日函数的海森矩阵的近似。约束函数定义为 $c(x_1, x_2) = (x_1-1)^2 + x_2^2 - 1$。\n\n求解这第一个 QP 子问题，确定得到的搜索方向 $p = (p_1, p_2)$。将您的答案 $p$ 表示为行矩阵。", "solution": "我们已知 $f(x_{1},x_{2})=x_{1}+x_{2}^{2}$ 和 $c(x_{1},x_{2})=(x_{1}-1)^{2}+x_{2}^{2}-1$，以及 $x_{0}=(1,1)$ 和 $B_{0}=I$。QP 子问题是\n$$\n\\min_{p}\\; q(p)=\\frac{1}{2}p^{T}Ip+\\nabla f(x_{0})^{T}p\n\\quad\\text{s.t.}\\quad \\nabla c(x_{0})^{T}p+c(x_{0})=0.\n$$\n在 $x_{0}$ 处计算梯度：\n$$\n\\nabla f(x)=\\begin{pmatrix}1\\\\2x_{2}\\end{pmatrix}\\;\\Rightarrow\\;\\nabla f(x_{0})=\\begin{pmatrix}1\\\\2\\end{pmatrix},\\qquad\n\\nabla c(x)=\\begin{pmatrix}2(x_{1}-1)\\\\2x_{2}\\end{pmatrix}\\;\\Rightarrow\\;\\nabla c(x_{0})=\\begin{pmatrix}0\\\\2\\end{pmatrix}.\n$$\n另外，$c(x_{0})=(1-1)^{2}+1^{2}-1=0$。因此 QP 子问题是\n$$\n\\min_{p}\\;\\frac{1}{2}(p_{1}^{2}+p_{2}^{2})+p_{1}+2p_{2}\n\\quad\\text{s.t.}\\quad 0\\cdot p_{1}+2p_{2}+0=0\\;\\Rightarrow\\;p_{2}=0.\n$$\n当 $p_{2}=0$ 时，目标函数简化为\n$$\n\\min_{p_{1}}\\;\\frac{1}{2}p_{1}^{2}+p_{1},\n$$\n其一阶条件 $p_{1}+1=0$ 得到 $p_{1}=-1$。\n\n等价地，求解该 QP 的 KKT 系统，\n$$\nIp+\\nabla f(x_{0})+\\lambda\\,\\nabla c(x_{0})=0,\\qquad \\nabla c(x_{0})^{T}p=0,\n$$\n得到以下分量方程\n$$\np_{1}+1+0\\cdot\\lambda=0,\\quad p_{2}+2+2\\lambda=0,\\quad 0\\cdot p_{1}+2p_{2}=0,\n$$\n从中可得 $p_{2}=0$，$p_{1}=-1$ 和 $\\lambda=-1$。\n\n因此，SQP 搜索方向为 $p=(-1,0)$，表示为行矩阵。", "answer": "$$\\boxed{\\begin{pmatrix}-1  0\\end{pmatrix}}$$", "id": "2202023"}, {"introduction": "尽管SQP方法功能强大，但其依赖的线性化近似并非总是完美的。在某些情况下，约束的线性化模型可能会相互矛盾，导致QP子问题没有可行解。这个练习揭示了SQP算法中的一个重要现实挑战，帮助你理解为何实际的SQP求解器需要包含处理不可行子问题的复杂机制。[@problem_id:2202038]", "problem": "考虑以下包含两个变量 $x_1$ 和 $x_2$ 的非线性规划（NLP）问题：\n\n最小化 $f(x_1, x_2) = (x_1-5)^2 + x_2^2$\n\n约束条件为：\n$c_1(x_1, x_2) = -x_1^2 + x_2 - 1 \\ge 0$\n$c_2(x_1, x_2) = 0.2x_1^4 + x_2^2 - x_2 - 1 \\ge 0$\n\n使用一种基于序列二次规划（SQP）的优化算法来求解该问题。该算法从初始点 $x_0 = (0, 0)$ 开始。在 SQP 方法的第一次迭代中，会构建一个二次规划（QP）子问题，以求解搜索方向（步长）$p = (p_1, p_2)$。该 QP 子问题是在当前点 $x_0$ 处，通过对目标函数进行二次近似和对约束条件进行线性化来构建的。\n\n下列哪个陈述正确地描述了用于求解搜索方向 $p$ 的第一个 QP 子问题？\n\nA. QP 子问题是无界的。\n\nB. QP 子问题对于 $p$ 有唯一的非零解。\n\nC. QP 子问题的唯一可行解是 $p=0$。\n\nD. QP 子问题是不可行的。\n\nE. 当前点 $x_0$ 必须是原始 NLP 问题的局部极小值点。", "solution": "在当前迭代点 $x_{0}=(0,0)$ 处，我们使用标准的 SQP 第一个 QP 子问题。该 QP 最小化一个带有线性化约束的拉格朗日函数的二次模型：\n$$\n\\min_{p\\in\\mathbb{R}^{2}} \\;\\; \\nabla f(x_{0})^{\\top}p + \\frac{1}{2} p^{\\top} B_{0} p\n\\quad\\text{subject to}\\quad\nc_{i}(x_{0}) + \\nabla c_{i}(x_{0})^{\\top} p \\ge 0,\\; i=1,2,\n$$\n其中，当初始乘子取为零时，$B_{0}$ 通常选择为 $\\nabla^{2} f(x_{0})$。\n\n在 $x_{0}$ 处计算所需各项：\n- 目标函数：$f(x_{1},x_{2})=(x_{1}-5)^{2}+x_{2}^{2}$，所以\n$$\n\\nabla f(x) = \\begin{pmatrix} 2(x_{1}-5) \\\\ 2 x_{2} \\end{pmatrix}, \\quad \\nabla f(x_{0})=\\begin{pmatrix} -10 \\\\ 0 \\end{pmatrix}, \\quad \\nabla^{2} f(x)=\\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}, \\; B_{0}=\\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}.\n$$\n- 约束及其线性化：\n对于 $c_{1}(x)=-x_{1}^{2}+x_{2}-1$，\n$$\nc_{1}(x_{0})=-1,\\quad \\nabla c_{1}(x)=\\begin{pmatrix} -2 x_{1} \\\\ 1 \\end{pmatrix},\\quad \\nabla c_{1}(x_{0})=\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\n$$\n因此\n$$\nc_{1}(x_{0})+\\nabla c_{1}(x_{0})^{\\top}p = -1 + p_{2} \\ge 0 \\;\\;\\Longleftrightarrow\\;\\; p_{2} \\ge 1.\n$$\n对于 $c_{2}(x)=0.2\\,x_{1}^{4}+x_{2}^{2}-x_{2}-1$，\n$$\nc_{2}(x_{0})=-1,\\quad \\nabla c_{2}(x)=\\begin{pmatrix} 0.8\\,x_{1}^{3} \\\\ 2 x_{2}-1 \\end{pmatrix},\\quad \\nabla c_{2}(x_{0})=\\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix},\n$$\n因此\n$$\nc_{2}(x_{0})+\\nabla c_{2}(x_{0})^{\\top}p = -1 - p_{2} \\ge 0 \\;\\;\\Longleftrightarrow\\;\\; p_{2} \\le -1.\n$$\n线性化的约束要求同时满足 $p_{2} \\ge 1$ 和 $p_{2} \\le -1$，这是不可能的。因此，QP 子问题的可行集为空，所以该 QP 子问题是不可行的。\n\n因此，在所列出的陈述中，正确的陈述是 QP 子问题是不可行的。", "answer": "$$\\boxed{D}$$", "id": "2202038"}]}