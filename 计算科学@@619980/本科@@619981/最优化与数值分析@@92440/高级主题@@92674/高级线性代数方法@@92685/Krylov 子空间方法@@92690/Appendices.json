{"hands_on_practices": [{"introduction": "在我们运用Krylov子空间方法解决实际问题之前，首先必须理解它的基本构成。这个练习将引导你亲手构建一个小型Krylov子空间的基向量，并通过计算验证它们的线性无关性，从而巩固Krylov子空间的核心定义。通过这个具体的计算，你将对这些方法赖以运作的“舞台”有一个直观的认识 [@problem_id:2183348]。", "problem": "考虑由下式给出的实矩阵 $A$ 和实列向量 $b$：\n$$A = \\begin{pmatrix} 1 & 1 & 0 \\\\ 1 & 2 & 1 \\\\ 0 & 1 & 1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 4 \\\\ 1 \\\\ 0 \\end{pmatrix}$$\n由 $A$ 和 $b$ 生成的 $m$ 阶 Krylov 子空间，记作 $\\mathcal{K}_m(A, b)$，是由向量 $\\{b, Ab, A^2b, \\dots, A^{m-1}b\\}$ 张成的线性子空间。求 Krylov 子空间 $\\mathcal{K}_3(A, b)$ 的维数。", "solution": "Krylov 子空间 $\\mathcal{K}_{3}(A,b)$ 是由 $\\{b, Ab, A^{2}b\\}$ 张成的空间。为求其维数，我们计算这些向量并检验它们的线性无关性。\n给定\n$$\nA=\\begin{pmatrix}1&1&0\\\\1&2&1\\\\0&1&1\\end{pmatrix},\\quad b=\\begin{pmatrix}4\\\\1\\\\0\\end{pmatrix},\n$$\n我们计算\n$$\nAb=A\\begin{pmatrix}4\\\\1\\\\0\\end{pmatrix}=\\begin{pmatrix}1\\cdot 4+1\\cdot 1+0\\cdot 0\\\\1\\cdot 4+2\\cdot 1+1\\cdot 0\\\\0\\cdot 4+1\\cdot 1+1\\cdot 0\\end{pmatrix}=\\begin{pmatrix}5\\\\6\\\\1\\end{pmatrix}.\n$$\n接下来，\n$$\nA^{2}b=A(Ab)=A\\begin{pmatrix}5\\\\6\\\\1\\end{pmatrix}=\\begin{pmatrix}1\\cdot 5+1\\cdot 6+0\\cdot 1\\\\1\\cdot 5+2\\cdot 6+1\\cdot 1\\\\0\\cdot 5+1\\cdot 6+1\\cdot 1\\end{pmatrix}=\\begin{pmatrix}11\\\\18\\\\7\\end{pmatrix}.\n$$\n将这些向量作为列向量构成矩阵：\n$$\nK=\\begin{pmatrix}4&5&11\\\\1&6&18\\\\0&1&7\\end{pmatrix}.\n$$\n这些向量是线性无关的，当且仅当 $\\det(K)\\neq 0$。计算\n$$\n\\det(K)=4\\begin{vmatrix}6&18\\\\1&7\\end{vmatrix}-5\\begin{vmatrix}1&18\\\\0&7\\end{vmatrix}+11\\begin{vmatrix}1&6\\\\0&1\\end{vmatrix}\n=4(42-18)-5(7)+11(1)=96-35+11=72\\neq 0.\n$$\n因此，$\\{b, Ab, A^{2}b\\}$ 是线性无关的，$\\mathcal{K}_{3}(A,b)$ 的维数是 $3$。", "answer": "$$\\boxed{3}$$", "id": "2183348"}, {"introduction": "Krylov子空间方法的精髓在于，它在逐步扩大的子空间中迭代地寻找最优解。本练习聚焦于共轭梯度法（CG）中的一个关键步骤——计算最优步长$α_0$，它展示了该方法如何在每一步的搜索方向上最小化误差。掌握这个计算过程，是理解这些迭代法为何如此高效和强大的关键 [@problem_id:2183332]。", "problem": "共轭梯度法（CG法）是一种迭代算法，用于数值求解线性方程组 $Ax = b$，其中矩阵 $A$ 是对称正定（SPD）的。该方法生成一个近似解序列 $x_k$，该序列收敛于真实解。\n\n考虑由以下定义的 $2 \\times 2$ 线性系统 $Ax = b$：\n$$\nA = \\begin{pmatrix} 3 & 2 \\\\ 2 & 3 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\nCG 算法的第一步是从一个初始猜测 $x_0$ 开始，计算一个改进解 $x_1$。更新由公式 $x_1 = x_0 + \\alpha_0 p_0$ 给出，其中 $p_0$ 是初始搜索方向，$\\alpha_0$ 是使该方向上的误差最小化的最优步长。\n\n给定初始猜测 $x_0 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，确定共轭梯度法第一次迭代的最优步长 $\\alpha_0$ 的值。\n\n将您的答案表示为最简分数形式。", "solution": "对于带有 SPD 矩阵的共轭梯度法，初始搜索方向为 $p_{0} = r_{0}$，其中残差为 $r_{0} = b - A x_{0}$。沿 $p_{0}$ 方向，使二次型 $f(x) = \\frac{1}{2} x^{T} A x - b^{T} x$ 最小化的最优步长是通过最小化 $f(x_{0} + \\alpha p_{0})$ 得到的，结果为\n$$\n\\alpha_{0} = \\frac{p_{0}^{T} r_{0}}{p_{0}^{T} A p_{0}}.\n$$\n当 $p_{0} = r_{0}$ 时，这变为\n$$\n\\alpha_{0} = \\frac{r_{0}^{T} r_{0}}{r_{0}^{T} A r_{0}}.\n$$\n\n使用 $x_{0} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 计算残差：\n$$\nA x_{0} = \\begin{pmatrix} 3 & 2 \\\\ 2 & 3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 5 \\end{pmatrix}, \\quad\nr_{0} = b - A x_{0} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 5 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} -4 \\\\ -5 \\end{pmatrix}.\n$$\n那么\n$$\nr_{0}^{T} r_{0} = (-4)^{2} + (-5)^{2} = 16 + 25 = 41,\n$$\n和\n$$\nA r_{0} = \\begin{pmatrix} 3 & 2 \\\\ 2 & 3 \\end{pmatrix} \\begin{pmatrix} -4 \\\\ -5 \\end{pmatrix} = \\begin{pmatrix} -22 \\\\ -23 \\end{pmatrix}, \\quad\nr_{0}^{T} A r_{0} = \\begin{pmatrix} -4 & -5 \\end{pmatrix} \\begin{pmatrix} -22 \\\\ -23 \\end{pmatrix} = 88 + 115 = 203.\n$$\n因此，\n$$\n\\alpha_{0} = \\frac{41}{203}.\n$$\n分数 $\\frac{41}{203}$ 已经是其最简形式。", "answer": "$$\\boxed{\\frac{41}{203}}$$", "id": "2183332"}, {"introduction": "对于非对称线性系统，存在多种Krylov子空间方法，它们施加了不同的优化准则。本练习通过直接比较两种基本算法——完全正交化方法（FOM）和广义最小残差方法（GMRES），来揭示它们的设计哲学差异。通过计算每种方法最终的残差，你将亲眼见证GMRES最核心的特性：在每一步迭代中，它总能保证残差最小 [@problem_id:2183323]。", "problem": "考虑线性系统 $Ax=b$，其中\n$$ A = \\begin{pmatrix} 1 & 1 & 0 \\\\ 0 & 1 & 1 \\\\ 1 & 0 & 1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}. $$\n我们希望使用两步 ($m=2$) 的克雷洛夫子空间方法，从初始猜测 $x_0 = \\vec{0}$ 开始，寻找一个近似解。这两种方法是完全正交化方法 (FOM) 和广义最小残差方法 (GMRES)。\n\n两种方法都始于使用 Arnoldi 过程为克雷洛夫子空间 $\\mathcal{K}_2(A, r_0)$ 构建一个标准正交基 $\\{v_1, v_2\\}$，其中 $r_0 = b - Ax_0$。该过程产生关系式 $AV_2 = V_3 \\tilde{H}_2$，其中 $V_k = [v_1, \\dots, v_k]$ 是以基向量为列的矩阵，而 $\\tilde{H}_2$ 是一个 $3 \\times 2$ 的上Hessenberg矩阵。令 $H_2$ 为通过移除 $\\tilde{H}_2$ 的最后一行得到的 $2 \\times 2$ 矩阵。\n\n两步后的近似解由 $x_2 = x_0 + V_2 y_2$ 给出，其中 $y_2$ 是 $\\mathbb{R}^2$ 中的一个向量。\n- 对于 FOM(2)，向量 $y_2^{\\text{FOM}}$ 通过求解系统 $H_2 y = \\|r_0\\|_2 e_1$ 找到，其中 $e_1 = [1, 0]^T$。\n- 对于 GMRES(2)，向量 $y_2^{\\text{GMRES}}$ 通过求解最小二乘问题 $\\min_{y \\in \\mathbb{R}^2} \\| \\tilde{H}_2 y - \\|r_0\\|_2 e_1 \\|_2$ 找到，其中 $e_1 = [1, 0, 0]^T$。\n\n最终的残差向量为 $r_2^{\\text{FOM}} = b - Ax_2^{\\text{FOM}}$ 和 $r_2^{\\text{GMRES}} = b - Ax_2^{\\text{GMRES}}$。\n\n计算两种方法的最终残差向量的2-范数，即 $\\|r_2^{\\text{FOM}}\\|_2$ 和 $\\|r_2^{\\text{GMRES}}\\|_2$。将你的答案表示为一对精确解析值 $(\\|r_2^{\\text{FOM}}\\|_2, \\|r_2^{\\text{GMRES}}\\|_2)$。", "solution": "我们有线性系统 $Ax=b$，其中\n$$\nA=\\begin{pmatrix}1&1&0\\\\0&1&1\\\\1&0&1\\end{pmatrix},\\quad b=\\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix},\n$$\n初始猜测 $x_{0}=\\vec{0}$，且 $r_{0}=b-Ax_{0}=b$。因此 $\\beta=\\|r_{0}\\|_{2}=1$ 且 $v_{1}=r_{0}/\\beta=\\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix}$。\n\n我们运行两步 Arnoldi 过程来构建 $\\mathcal{K}_{2}(A,r_{0})$ 的一个标准正交基 $\\{v_{1},v_{2}\\}$，并得到关系式 $AV_{2}=V_{3}\\tilde{H}_{2}$，其中 $V_{k}=[v_{1},\\dots,v_{k}]$。\n\n第1步：\n$$\nw=A v_{1}=A\\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix}=\\begin{pmatrix}1\\\\0\\\\1\\end{pmatrix},\\quad h_{1,1}=v_{1}^{T}w=1,\n$$\n$$\nw:=w-h_{1,1}v_{1}=\\begin{pmatrix}0\\\\0\\\\1\\end{pmatrix},\\quad h_{2,1}=\\|w\\|_{2}=1,\\quad v_{2}=w/h_{2,1}=\\begin{pmatrix}0\\\\0\\\\1\\end{pmatrix}.\n$$\n\n第2步：\n$$\nw=A v_{2}=A\\begin{pmatrix}0\\\\0\\\\1\\end{pmatrix}=\\begin{pmatrix}0\\\\1\\\\1\\end{pmatrix},\\quad h_{1,2}=v_{1}^{T}w=0,\\quad w:=w-h_{1,2}v_{1}=\\begin{pmatrix}0\\\\1\\\\1\\end{pmatrix},\n$$\n$$\nh_{2,2}=v_{2}^{T}w=1,\\quad w:=w-h_{2,2}v_{2}=\\begin{pmatrix}0\\\\1\\\\0\\end{pmatrix},\\quad h_{3,2}=\\|w\\|_{2}=1,\\quad v_{3}=w/h_{3,2}=\\begin{pmatrix}0\\\\1\\\\0\\end{pmatrix}.\n$$\n\n因此，\n$$\n\\tilde{H}_{2}=\\begin{pmatrix}h_{1,1}&h_{1,2}\\\\ h_{2,1}&h_{2,2}\\\\ 0&h_{3,2}\\end{pmatrix}\n=\\begin{pmatrix}1&0\\\\ 1&1\\\\ 0&1\\end{pmatrix},\\qquad\nH_{2}=\\begin{pmatrix}1&0\\\\ 1&1\\end{pmatrix}.\n$$\n\n两步近似解具有形式 $x_{2}=x_{0}+V_{2}y$，其中 $y\\in\\mathbb{R}^{2}$。\n\n对于 FOM(2)，$y^{\\text{FOM}}$ 求解 $H_{2}y=\\beta e_{1}$，其中 $e_{1}=\\begin{pmatrix}1\\\\0\\end{pmatrix}$：\n$$\n\\begin{pmatrix}1&0\\\\1&1\\end{pmatrix}\\begin{pmatrix}y_{1}\\\\y_{2}\\end{pmatrix}=\\begin{pmatrix}1\\\\0\\end{pmatrix}\n\\;\\Rightarrow\\; y_{1}=1,\\; y_{2}=-1.\n$$\n因此 $x_{2}^{\\text{FOM}}=V_{2}y^{\\text{FOM}}=v_{1}\\cdot 1+v_{2}\\cdot(-1)=\\begin{pmatrix}1\\\\0\\\\-1\\end{pmatrix}$，残差为\n$$\nr_{2}^{\\text{FOM}}=b-Ax_{2}^{\\text{FOM}}=\\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix}-A\\begin{pmatrix}1\\\\0\\\\-1\\end{pmatrix}\n=\\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix}-\\begin{pmatrix}1\\\\-1\\\\0\\end{pmatrix}\n=\\begin{pmatrix}0\\\\1\\\\0\\end{pmatrix},\n$$\n所以 $\\|r_{2}^{\\text{FOM}}\\|_{2}=1$。\n\n对于 GMRES(2)，$y^{\\text{GMRES}}$ 最小化 $\\|\\tilde{H}_{2}y-\\beta e_{1}\\|_{2}$，其中 $e_{1}=\\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix}$。令 $y=\\begin{pmatrix}y_{1}\\\\y_{2}\\end{pmatrix}$。那么\n$$\n\\tilde{H}_{2}y-\\beta e_{1}=\\begin{pmatrix}y_{1}-1\\\\ y_{1}+y_{2}\\\\ y_{2}\\end{pmatrix},\n$$\n要最小化的范数的平方是\n$$\nf(y_{1},y_{2})=(y_{1}-1)^{2}+(y_{1}+y_{2})^{2}+y_{2}^{2}.\n$$\n将梯度设为零，\n$$\n\\frac{\\partial f}{\\partial y_{1}}=2(y_{1}-1)+2(y_{1}+y_{2})=0\\;\\Rightarrow\\;2y_{1}+y_{2}-1=0,\n$$\n$$\n\\frac{\\partial f}{\\partial y_{2}}=2(y_{1}+y_{2})+2y_{2}=0\\;\\Rightarrow\\;y_{1}+2y_{2}=0.\n$$\n求解得 $y_{2}=-\\frac{1}{3}$ 且 $y_{1}=\\frac{2}{3}$。最小化的残差范数为\n$$\n\\|\\tilde{H}_{2}y^{\\text{GMRES}}-\\beta e_{1}\\|_{2}\n=\\left\\|\\begin{pmatrix}\\frac{2}{3}-1\\\\ \\frac{2}{3}-\\frac{1}{3}\\\\ -\\frac{1}{3}\\end{pmatrix}\\right\\|_{2}\n=\\left\\|\\begin{pmatrix}-\\frac{1}{3}\\\\ \\frac{1}{3}\\\\ -\\frac{1}{3}\\end{pmatrix}\\right\\|_{2}\n=\\sqrt{\\frac{1}{9}+\\frac{1}{9}+\\frac{1}{9}}=\\sqrt{\\frac{1}{3}}.\n$$\n因为 $r_{2}^{\\text{GMRES}}=V_{3}(\\beta e_{1}-\\tilde{H}_{2}y^{\\text{GMRES}})$ 且 $V_{3}$ 是标准正交的，我们有 $\\|r_{2}^{\\text{GMRES}}\\|_{2}=\\|\\tilde{H}_{2}y^{\\text{GMRES}}-\\beta e_{1}\\|_{2}=\\sqrt{\\frac{1}{3}}$。\n\n因此，所求的残差范数对为 $(\\|r_{2}^{\\text{FOM}}\\|_{2},\\|r_{2}^{\\text{GMRES}}\\|_{2})=\\left(1,\\sqrt{\\frac{1}{3}}\\right)$。", "answer": "$$\\boxed{\\begin{pmatrix}1 & \\sqrt{\\frac{1}{3}}\\end{pmatrix}}$$", "id": "2183323"}]}