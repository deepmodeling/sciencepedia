{"hands_on_practices": [{"introduction": "要真正掌握不完全分解，我们必须从最基本的操作开始。本练习 [@problem_id:2179135] 将引导您对一个典型的对称正定矩阵，手动执行零填充不完全Cholesky分解（IC(0)）。通过亲手计算，您将具体地理解分解算法的执行过程以及“稀疏模式”这一核心概念，这是掌握此类预处理器的基石。", "problem": "在数值分析领域，通常使用迭代法来求解形如 $Ax=b$ 的大型线性方程组。为了加速这些方法的收敛，会使用一个预处理矩阵 $M$，将原方程组变换为 $M^{-1}Ax = M^{-1}b$。一个好的预处理矩阵 $M$ 应该近似于 $A$，同时其逆矩阵要易于计算。对于对称正定矩阵 $A$，一种常见的选择是令 $M = \\tilde{L}\\tilde{L}^T$，其中 $\\tilde{L}$ 是 $A$ 的一个近似Cholesky因子。\n\n零填充不完全Cholesky分解（记作IC(0)）就是一种寻找 $\\tilde{L}$ 的方法。它计算一个下三角矩阵，该矩阵的稀疏模式（即其非零元的位置集合）被强制要求与原矩阵 $A$ 的下三角部分的稀疏模式相同。也就是说，如果对于 $i > j$ 有 $a_{ij}=0$，那么因子 $\\tilde{L}$ 中对应的元素 $\\tilde{l}_{ij}$ 也被强制为零。\n\n考虑如下给出的对称正定矩阵 $A$：\n$$\nA = \\begin{pmatrix}\n4 & -1 & 0 \\\\\n-1 & 4 & -1 \\\\\n0 & -1 & 4\n\\end{pmatrix}\n$$\n使用IC(0)过程，计算该矩阵 $A$ 的不完全Cholesky因子 $\\tilde{L}$。请将答案表示为一个 $3 \\times 3$ 矩阵，其元素为精确的解析值。", "solution": "我们寻求一个下三角矩阵 $\\tilde{L}$，其稀疏模式与 $A$ 的下三角部分相同，使得 $A \\approx \\tilde{L}\\tilde{L}^{T}$。对于像 $A$ 这样的对称正定三对角矩阵，其精确Cholesky因子在第一条次对角线之外没有额外的填充，因此在稀疏模式的约束下，IC(0)分解与精确Cholesky分解是一致的。因此，我们写出\n$$\n\\tilde{L}=\\begin{pmatrix}\n\\ell_{11} & 0 & 0 \\\\\n\\ell_{21} & \\ell_{22} & 0 \\\\\n0 & \\ell_{32} & \\ell_{33}\n\\end{pmatrix},\n\\quad \\text{其中 } \\ell_{33}>0, \\ell_{22}>0, \\ell_{11}>0,\n$$\n并逐项强制 $\\tilde{L}\\tilde{L}^{T}=A$。\n\n从 $(1,1)$ 项可得：\n$$\n\\ell_{11}^{2}=4 \\;\\Rightarrow\\; \\ell_{11}=2.\n$$\n从 $(2,1)$ 项可得：\n$$\n\\ell_{21}\\ell_{11}=-1 \\;\\Rightarrow\\; \\ell_{21}=-\\frac{1}{2}.\n$$\n从 $(2,2)$ 项可得：\n$$\n\\ell_{21}^{2}+\\ell_{22}^{2}=4 \\;\\Rightarrow\\; \\ell_{22}^{2}=4-\\left(\\frac{1}{2}\\right)^{2}=\\frac{15}{4} \\;\\Rightarrow\\; \\ell_{22}=\\frac{\\sqrt{15}}{2}.\n$$\n对于 $(3,1)$ 项，稀疏模式要求 $\\ell_{31}=0$，这与 $a_{31}=0$ 相匹配。\n\n从 $(3,2)$ 项可得：\n$$\n\\ell_{32}\\ell_{22}=-1 \\;\\Rightarrow\\; \\ell_{32}=-\\frac{1}{\\ell_{22}}=-\\frac{2}{\\sqrt{15}}.\n$$\n从 $(3,3)$ 项可得：\n$$\n\\ell_{32}^{2}+\\ell_{33}^{2}=4 \\;\\Rightarrow\\; \\ell_{33}^{2}=4-\\left(\\frac{2}{\\sqrt{15}}\\right)^{2}=4-\\frac{4}{15}=\\frac{56}{15} \\;\\Rightarrow\\; \\ell_{33}=\\sqrt{\\frac{56}{15}}=\\frac{2\\sqrt{14}}{\\sqrt{15}}.\n$$\n\n因此，IC(0)因子为\n$$\n\\tilde{L}=\\begin{pmatrix}\n2 & 0 & 0 \\\\\n-\\frac{1}{2} & \\frac{\\sqrt{15}}{2} & 0 \\\\\n0 & -\\frac{2}{\\sqrt{15}} & \\frac{2\\sqrt{14}}{\\sqrt{15}}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\n2 & 0 & 0 \\\\\n-\\frac{1}{2} & \\frac{\\sqrt{15}}{2} & 0 \\\\\n0 & -\\frac{2}{\\sqrt{15}} & \\frac{2\\sqrt{14}}{\\sqrt{15}}\n\\end{pmatrix}}$$", "id": "2179135"}, {"introduction": "构造出预处理器的因子后，下一步自然是学习如何应用它们。一个预处理器的价值在于求解系统 $Mz=r$ 的计算成本足够低。本练习 [@problem_id:2179164] 演示了当预处理器 $M$ 已被分解为 $\\tilde{L}\\tilde{U}$ 的形式时，求解过程如何高效地简化为前向替换和后向替换两个步骤，从而揭示了LU类型预处理器计算效率的根源。", "problem": "在许多求解形如 $Ax=b$ 的大型稀疏线性系统的数值方法中，会使用一个预处理器 $M$ 将系统转换为一个等价的、对迭代求解器具有更好性质的系统。一类广泛使用的预处理器是基于不完全 LU (ILU) 分解，它计算矩阵 $A$ 的一个近似 LU 分解。\n\n考虑一个预处理系统 $Mz = r$，它作为迭代方法中的一个子问题出现。预处理器 $M$ 由两个矩阵的乘积给出，$M = \\tilde{L}\\tilde{U}$，这两个因子是通过零填充不完全 LU 分解（ILU(0)）得到的。\n\n因子由下式给出：\n$$\n\\tilde{L} = \\begin{pmatrix} 1 & 0 & 0 \\\\ -2 & 1 & 0 \\\\ 0 & 3 & 1 \\end{pmatrix} \\quad \\text{和} \\quad \\tilde{U} = \\begin{pmatrix} 4 & 1 & 0 \\\\ 0 & 5 & -1 \\\\ 0 & 0 & 2 \\end{pmatrix}\n$$\n向量 $r$ 由下式给出：\n$$\nr = \\begin{pmatrix} 7 \\\\ -20 \\\\ -16 \\end{pmatrix}\n$$\n求解系统 $\\tilde{L}\\tilde{U}z = r$ 的解向量 $z = \\begin{pmatrix} z_1 \\\\ z_2 \\\\ z_3 \\end{pmatrix}$。\n\n下列哪个向量代表了正确的解 $z$？\n\nA) $z = \\begin{pmatrix} 2 \\\\ -1 \\\\ 1 \\end{pmatrix}$\n\nB) $z = \\begin{pmatrix} 7 \\\\ -6 \\\\ 2 \\end{pmatrix}$\n\nC) $z = \\begin{pmatrix} 3.15 \\\\ -5.6 \\\\ -8 \\end{pmatrix}$\n\nD) $z = \\begin{pmatrix} 3.15 \\\\ 0.7 \\\\ -10.1 \\end{pmatrix}$", "solution": "我们必须求解预处理系统 $\\tilde{L}\\tilde{U}z=r$。令 $y=\\tilde{U}z$，这样我们首先求解单位下三角系统 $\\tilde{L}y=r$，然后求解上三角系统 $\\tilde{U}z=y$。\n\n已知\n$$\n\\tilde{L}=\\begin{pmatrix}1&0&0\\\\-2&1&0\\\\0&3&1\\end{pmatrix},\\quad\n\\tilde{U}=\\begin{pmatrix}4&1&0\\\\0&5&-1\\\\0&0&2\\end{pmatrix},\\quad\nr=\\begin{pmatrix}7\\\\-20\\\\-16\\end{pmatrix}.\n$$\n\n对 $\\tilde{L}y=r$ 进行前向替换，其中 $y=\\begin{pmatrix}y_{1}\\\\y_{2}\\\\y_{3}\\end{pmatrix}$：\n$$\ny_{1}=7,\n$$\n$$\n-2y_{1}+y_{2}=-20\\;\\Rightarrow\\;y_{2}=-20+2y_{1}=-20+14=-6,\n$$\n$$\n3y_{2}+y_{3}=-16\\;\\Rightarrow\\;y_{3}=-16-3y_{2}=-16-3(-6)=-16+18=2.\n$$\n因此\n$$\ny=\\begin{pmatrix}7\\\\-6\\\\2\\end{pmatrix}.\n$$\n\n对 $\\tilde{U}z=y$ 进行后向替换，其中 $z=\\begin{pmatrix}z_{1}\\\\z_{2}\\\\z_{3}\\end{pmatrix}$：\n$$\n2z_{3}=y_{3}=2\\;\\Rightarrow\\;z_{3}=1,\n$$\n$$\n5z_{2}-z_{3}=y_{2}=-6\\;\\Rightarrow\\;5z_{2}-1=-6\\;\\Rightarrow\\;5z_{2}=-5\\;\\Rightarrow\\;z_{2}=-1,\n$$\n$$\n4z_{1}+z_{2}=y_{1}=7\\;\\Rightarrow\\;4z_{1}-1=7\\;\\Rightarrow\\;4z_{1}=8\\;\\Rightarrow\\;z_{1}=2.\n$$\n因此\n$$\nz=\\begin{pmatrix}2\\\\-1\\\\1\\end{pmatrix},\n$$\n这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "2179164"}, {"introduction": "在掌握了基本操作后，让我们深入探讨一个更根本的问题：什么才是一个“好”的预处理器？一个普遍的直觉是，预处理器 $M$ 对原始矩阵 $A$ 的近似越好（例如，矩阵范数 $\\|A-M\\|$ 越小），其加速效果就越佳。然而，这个练习 [@problem_id:2179128] 通过一个巧妙的反例挑战了这一直觉，它揭示了收敛速度的真正关键在于迭代矩阵 $I - M^{-1}A$ 的谱半径，而非简单的近似误差。这将加深您对收敛理论的理解，并促使您更批判性地评估预处理器的性能。", "problem": "在求解线性系统 $Ax=b$ 的迭代法研究中，预处理是加速收敛的一项关键技术。预处理器 $M \\approx A$ 用于将原系统转换为一个等价的、更易求解的系统，例如 $M^{-1}Ax = M^{-1}b$。预处理定常迭代法的收敛速度由其迭代矩阵的谱半径 $\\rho(I-M^{-1}A)$ 决定，谱半径越小意味着收敛越快。\n\n一个常见的直觉是，如果预处理器 $M_1$ 比另一个预处理器 $M_2$ 更能近似 $A$（例如，在某种矩阵范数下 $\\|A-M_1\\| < \\|A-M_2\\|$），那么它应该能带来更快的收敛。本问题将探討一个具体的反例，该反例表明预处理器的有效性并非简单地取决于 $M$ 对 $A$ 的近似程度，而是更微妙地与 $M^{-1}$ 如何影响 $A$ 的谱有关。\n\n考虑由参数 $\\delta \\in (0, 1)$ 定义的矩阵 $A$：\n$$A = \\begin{pmatrix} 1 & 1 \\\\ \\delta & 1 \\end{pmatrix}$$\n设 $A$ 的精确LU分解为 $A=LU$。通过修改这些精确因子来构造两个预处理器 $M_1$ 和 $M_2$：\n1.  $M_1 = L \\tilde{U}$，其中 $\\tilde{U}$ 是将精确因子 $U$ 的第二个对角元素 $u_{22}$ 替换为 1 得到的。\n2.  $M_2 = \\tilde{L} U$，其中 $\\tilde{L}$ 是将精确因子 $L$ 的唯一非对角元素 $l_{21}$ 置为 0 得到的。\n\n你的任务是分析这两个预处理器。计算近似误差之比 $R = \\frac{\\|A-M_2\\|_F}{\\|A-M_1\\|_F}$（其中 $\\|\\cdot\\|_F$ 表示Frobenius范数），以及与第一个预处理器相关联的迭代矩阵的谱半径 $\\rho_1 = \\rho(I - M_1^{-1}A)$。\n\n将你的最终答案表示为一个 $1 \\times 2$ 的行矩阵，其中依次包含 $R$ 和 $\\rho_1$ 的表达式。表达式应以参数 $\\delta$ 表示。", "solution": "我们首先计算 $A=\\begin{pmatrix} 1 & 1 \\\\ \\delta & 1 \\end{pmatrix}$（其中 $\\delta \\in (0,1)$）的精确LU分解。对于一个 $a_{11}\\neq 0$ 的 $2\\times 2$ 矩阵，其 Doolittle 分解给出 $L=\\begin{pmatrix} 1 & 0 \\\\ l_{21} & 1 \\end{pmatrix}$ 和 $U=\\begin{pmatrix} u_{11} & u_{12} \\\\ 0 & u_{22} \\end{pmatrix}$，其中\n$$\nu_{11}=a_{11},\\quad u_{12}=a_{12},\\quad l_{21}=\\frac{a_{21}}{a_{11}},\\quad u_{22}=a_{22}-l_{21}u_{12}.\n$$\n将此方法应用于矩阵 $A$ 可得\n$$\nL=\\begin{pmatrix} 1 & 0 \\\\ \\delta & 1 \\end{pmatrix},\\quad U=\\begin{pmatrix} 1 & 1 \\\\ 0 & 1-\\delta \\end{pmatrix}.\n$$\n\n对于第一个预处理器，我们通过将 $u_{22}$ 替换为 $1$ 来定义 $\\tilde{U}$，因此\n$$\n\\tilde{U}=\\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix},\\quad M_{1}=L\\tilde{U}=\\begin{pmatrix} 1 & 1 \\\\ \\delta & 1+\\delta \\end{pmatrix}.\n$$\n所以，\n$$\nA-M_{1}=\\begin{pmatrix} 0 & 0 \\\\ 0 & -\\delta \\end{pmatrix},\\quad \\|A-M_{1}\\|_{F}=\\sqrt{0^{2}+0^{2}+0^{2}+(-\\delta)^{2}}=\\delta.\n$$\n\n对于第二个预处理器，我们在 $L$ 中设置 $l_{21}=0$ 得到 $\\tilde{L}=I$，因此\n$$\nM_{2}=\\tilde{L}U=U=\\begin{pmatrix} 1 & 1 \\\\ 0 & 1-\\delta \\end{pmatrix}.\n$$\n于是，\n$$\nA-M_{2}=\\begin{pmatrix} 0 & 0 \\\\ \\delta & \\delta \\end{pmatrix},\\quad \\|A-M_{2}\\|_{F}=\\sqrt{\\delta^{2}+\\delta^{2}}=\\sqrt{2}\\,\\delta.\n$$\n因此，近似误差之比为\n$$\nR=\\frac{\\|A-M_{2}\\|_{F}}{\\|A-M_{1}\\|_{F}}=\\frac{\\sqrt{2}\\,\\delta}{\\delta}=\\sqrt{2}.\n$$\n\n接下来，我们计算使用 $M_1$ 的预处理系统的迭代矩阵。利用性质 $(L\\tilde{U})^{-1}=\\tilde{U}^{-1}L^{-1}$，我们有\n$$\nM_{1}^{-1}A=\\tilde{U}^{-1}L^{-1}LU=\\tilde{U}^{-1}U.\n$$\n因为 $\\tilde{U}^{-1}=\\begin{pmatrix} 1 & -1 \\\\ 0 & 1 \\end{pmatrix}$，我们得到\n$$\n\\tilde{U}^{-1}U=\\begin{pmatrix} 1 & -1 \\\\ 0 & 1 \\end{pmatrix}\\begin{pmatrix} 1 & 1 \\\\ 0 & 1-\\delta \\end{pmatrix}=\\begin{pmatrix} 1 & \\delta \\\\ 0 & 1-\\delta \\end{pmatrix}.\n$$\n迭代矩阵为\n$$\nI-M_{1}^{-1}A=\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}-\\begin{pmatrix} 1 & \\delta \\\\ 0 & 1-\\delta \\end{pmatrix}=\\begin{pmatrix} 0 & -\\delta \\\\ 0 & \\delta \\end{pmatrix}.\n$$\n该矩阵是上三角矩阵，因此其特征值为对角元 $0$ 和 $\\delta$。所以谱半径为\n$$\n\\rho_{1}=\\max\\{|0|,|\\delta|\\}=\\delta,\n$$\n因为 $\\delta \\in (0,1)$。\n\n因此，所需的表达式为 $R=\\sqrt{2}$ 和 $\\rho_{1}=\\delta$。", "answer": "$$\\boxed{\\begin{pmatrix} \\sqrt{2} & \\delta \\end{pmatrix}}$$", "id": "2179128"}]}