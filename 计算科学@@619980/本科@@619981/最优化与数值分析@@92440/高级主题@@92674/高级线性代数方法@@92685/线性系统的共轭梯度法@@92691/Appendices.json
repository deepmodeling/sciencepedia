{"hands_on_practices": [{"introduction": "要真正理解一个算法，没有什么比亲手实践更好的方法了。第一个练习将引导你完成共轭梯度法的一次完整迭代[@problem_id:2211037]。通过处理一个简单的对角系统，你可以专注于计算初始残差、更新解等一系列操作流程，为理解算法的迭代过程打下坚实的基础。", "problem": "考虑求解线性方程组 $Ax = b$ 的问题，其中 $A$ 是一个对称正定矩阵。共轭梯度（CG）法是一种非常适用于此类问题的迭代算法。\n\n给定由矩阵 $A$ 和向量 $b$ 定义的具体系统：\n$$\nA = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 4 & 0 \\\\ 0 & 0 & 5 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n从初始猜测值 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 开始，执行一次完整的共轭梯度算法迭代，以求得下一个近似解 $x_1$。\n\n你的最终答案应该是向量 $x_1$，并以其分量组成的行矩阵形式表示。", "solution": "共轭梯度（CG）法是用于求解线性系统 $Ax=b$ 的一种迭代算法，其中 $A$ 是对称正定矩阵。题目要求我们从 $x_0 = \\mathbf{0}$ 开始，求出第一个近似解 $x_1$。\n\n共轭梯度算法的第一次迭代（从 $k=0$ 到 $k=1$）的步骤如下：\n\n1.  **初始化残差：** 初始残差 $r_0$ 定义为 $r_0 = b - Ax_0$。\n2.  **初始化搜索方向：** 第一个搜索方向 $p_0$ 被设置为等于初始残差，即 $p_0 = r_0$。\n3.  **计算步长：** 沿着搜索方向 $p_0$ 移动的最优步长 $\\alpha_0$ 由 $\\alpha_0 = \\frac{r_0^T r_0}{p_0^T A p_0}$ 给出。\n4.  **更新解：** 新的近似解 $x_1$ 通过从 $x_0$ 沿方向 $p_0$ 移动一步得到：$x_1 = x_0 + \\alpha_0 p_0$。\n\n让我们将这些步骤应用于给定问题。\n\n**步骤1：初始化残差 $r_0$**\n给定 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n残差为 $r_0 = b - Ax_0$。\n$$\nAx_0 = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 4 & 0 \\\\ 0 & 0 & 5 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n因此，\n$$\nr_0 = b - \\mathbf{0} = b = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n\n**步骤2：初始化搜索方向 $p_0$**\n初始搜索方向被设置为初始残差：\n$$\np_0 = r_0 = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n\n**步骤3：计算步长 $\\alpha_0$**\n步长的公式为 $\\alpha_0 = \\frac{r_0^T r_0}{p_0^T A p_0}$。\n首先，我们计算分子 $r_0^T r_0$：\n$$\nr_0^T r_0 = \\begin{pmatrix} 1 & 2 & 3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = (1)(1) + (2)(2) + (3)(3) = 1 + 4 + 9 = 14\n$$\n接下来，我们计算分母 $p_0^T A p_0$。由于 $p_0 = r_0$，我们需要计算 $p_0^T A p_0$。让我们先计算向量 $A p_0$：\n$$\nA p_0 = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 4 & 0 \\\\ 0 & 0 & 5 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} (2)(1) \\\\ (4)(2) \\\\ (5)(3) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 8 \\\\ 15 \\end{pmatrix}\n$$\n现在我们可以计算点积 $p_0^T (A p_0)$：\n$$\np_0^T A p_0 = \\begin{pmatrix} 1 & 2 & 3 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 8 \\\\ 15 \\end{pmatrix} = (1)(2) + (2)(8) + (3)(15) = 2 + 16 + 45 = 63\n$$\n最后，我们计算 $\\alpha_0$：\n$$\n\\alpha_0 = \\frac{14}{63} = \\frac{2 \\times 7}{9 \\times 7} = \\frac{2}{9}\n$$\n\n**步骤4：更新解以求得 $x_1$**\n更新后的解为 $x_1 = x_0 + \\alpha_0 p_0$。\n$$\nx_1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{2}{9} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} (2/9) \\times 1 \\\\ (2/9) \\times 2 \\\\ (2/9) \\times 3 \\end{pmatrix} = \\begin{pmatrix} 2/9 \\\\ 4/9 \\\\ 6/9 \\end{pmatrix} = \\begin{pmatrix} 2/9 \\\\ 4/9 \\\\ 2/3 \\end{pmatrix}\n$$\n因此，经过一次迭代后的第一个近似解为 $x_1 = \\begin{pmatrix} 2/9 \\\\ 4/9 \\\\ 2/3 \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2}{9} & \\frac{4}{9} & \\frac{2}{3} \\end{pmatrix}}$$", "id": "2211037"}, {"introduction": "共轭梯度法的效率与矩阵 $A$ 的性质密切相关。这个练习邀请你探究一个理想情景：当 $A$ 是单位矩阵时会发生什么[@problem_id:2211022]？这不仅仅是一个计算题，更是一个思想实验，它揭示了该方法卓越的最优性，并帮助你理解为何在这种完美条件下它能一步收敛到精确解。", "problem": "共轭梯度法（CG法）是一种迭代算法，用于数值求解形如 $A\\vec{x} = \\vec{b}$ 的线性方程组，其中 $A$ 是一个 $n \\times n$ 的对称正定矩阵，$\\vec{x}$ 是未知向量，$\\vec{b}$ 是已知向量。\n\n该算法从一个初始猜测值 $\\vec{x}_0$ 开始，流程如下：\n1.  初始化残差 $\\vec{r}_0 = \\vec{b} - A\\vec{x}_0$。\n2.  初始化搜索方向 $\\vec{p}_0 = \\vec{r}_0$。\n3.  对于 $k = 0, 1, 2, \\dots$，直到解收敛：\n    a. 计算步长：$\\alpha_k = \\frac{\\vec{r}_k^T \\vec{r}_k}{\\vec{p}_k^T A \\vec{p}_k}$\n    b. 更新解：$\\vec{x}_{k+1} = \\vec{x}_k + \\alpha_k \\vec{p}_k$\n    c. 更新残差：$\\vec{r}_{k+1} = \\vec{r}_k - \\alpha_k A \\vec{p}_k$\n    d. 计算搜索方向的改进因子：$\\beta_k = \\frac{\\vec{r}_{k+1}^T \\vec{r}_{k+1}}{\\vec{r}_k^T \\vec{r}_k}$\n    e. 更新搜索方向：$\\vec{p}_{k+1} = \\vec{r}_{k+1} + \\beta_k \\vec{p}_k$\n\n考虑线性系统 $A\\vec{x} = \\vec{b}$ 的一个特殊情况，其中 $A$ 是 $n \\times n$ 的单位矩阵 $I_n$。右端向量由 $\\vec{b} = \\vec{u}$ 给出，算法的初始猜测值为 $\\vec{x}_0 = \\vec{v}$。向量 $\\vec{u}$ 和 $\\vec{v}$ 是 $\\mathbb{R}^n$ 中不同的向量。\n\n您的任务是确定 CG 算法经过一次完整迭代后解向量的状态。求出向量 $\\vec{x}_1$。请用 $\\vec{u}$ 和 $\\vec{v}$ 来表示您的答案。", "solution": "我们将共轭梯度算法应用于系统 $A\\vec{x}=\\vec{b}$，其中 $A=I_{n}$，$\\vec{b}=\\vec{u}$，初始猜测值为 $\\vec{x}_{0}=\\vec{v}$。初始残差为\n$$\n\\vec{r}_{0}=\\vec{b}-A\\vec{x}_{0}=\\vec{u}-I_{n}\\vec{v}=\\vec{u}-\\vec{v}.\n$$\n初始搜索方向为\n$$\n\\vec{p}_{0}=\\vec{r}_{0}=\\vec{u}-\\vec{v}.\n$$\n步长为\n$$\n\\alpha_{0}=\\frac{\\vec{r}_{0}^{T}\\vec{r}_{0}}{\\vec{p}_{0}^{T}A\\vec{p}_{0}}=\\frac{\\vec{r}_{0}^{T}\\vec{r}_{0}}{\\vec{p}_{0}^{T}\\vec{p}_{0}},\n$$\n并且由于 $\\vec{p}_{0}=\\vec{r}_{0}$，可得\n$$\n\\alpha_{0}=\\frac{\\vec{r}_{0}^{T}\\vec{r}_{0}}{\\vec{r}_{0}^{T}\\vec{r}_{0}}=1.\n$$\n因此，经过一次迭代后的更新解为\n$$\n\\vec{x}_{1}=\\vec{x}_{0}+\\alpha_{0}\\vec{p}_{0}=\\vec{v}+1\\cdot(\\vec{u}-\\vec{v})=\\vec{u}.\n$$\n为了完整起见，残差将变为\n$$\n\\vec{r}_{1}=\\vec{r}_{0}-\\alpha_{0}A\\vec{p}_{0}=(\\vec{u}-\\vec{v})-1\\cdot(\\vec{u}-\\vec{v})=\\vec{0},\n$$\n因此该方法在一步内终止。所求的向量是 $\\vec{x}_{1}=\\vec{u}$。", "answer": "$$\\boxed{\\vec{u}}$$", "id": "2211022"}, {"introduction": "人们很容易认为，一个优化算法在每一步都应该使误差减小，无论你如何度量它。本练习旨在挑战这一直观想法，并揭示共轭梯度法收敛性的一个微妙但至关重要的方面[@problem_id:2211015]。你将分析一个残差的欧几里得范数 $\\|\\mathbf{r}_k\\|_2$ 暂时增大的案例，这将帮助你理解在 $A$-范数下的单调收敛与其他误差度量标准可能出现的复杂行为之间的关键区别。", "problem": "共轭梯度法 (CG) 是一种迭代算法，用于数值求解线性方程组 $A\\mathbf{x} = \\mathbf{b}$，其中矩阵 $A$ 是对称正定的。虽然残差的 $A$-范数 $\\|\\mathbf{r}_k\\|_A = \\sqrt{\\mathbf{r}_k^T A \\mathbf{r}_k}$ 保证随每次迭代 $k$ 单调递减，但更标准的欧几里得范数 $\\|\\mathbf{r}_k\\|_2$ 却并非如此。\n\n考虑一个线性系统 $A\\mathbf{x} = \\mathbf{b}$，它由 $3 \\times 3$ 的对称正定矩阵\n$$\nA = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 50 & 0 \\\\ 0 & 0 & 100 \\end{pmatrix}\n$$\n和右端向量 $\\mathbf{b} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 定义。\n\nCG 算法以初始猜测 $\\mathbf{x}_0 = \\begin{pmatrix} -2 \\\\ 0 \\\\ -0.01 \\end{pmatrix}$ 开始。第一次迭代（$k=0$）按以下步骤进行：\n1. 计算初始残差：$\\mathbf{r}_0 = \\mathbf{b} - A\\mathbf{x}_0$。\n2. 设置初始搜索方向：$\\mathbf{p}_0 = \\mathbf{r}_0$。\n3. 计算步长：$\\alpha_0 = \\frac{\\mathbf{r}_0^T \\mathbf{r}_0}{\\mathbf{p}_0^T A \\mathbf{p}_0}$。\n4. 更新残差：$\\mathbf{r}_1 = \\mathbf{r}_0 - \\alpha_0 A \\mathbf{p}_0$。\n\n计算第一步之后残差向量的欧几里得范数之比 $\\|\\mathbf{r}_1\\|_2 / \\|\\mathbf{r}_0\\|_2$。将最终答案四舍五入到四位有效数字。", "solution": "给定 $A=\\operatorname{diag}(1,50,100)$，$\\mathbf{b}=\\begin{pmatrix}0\\\\0\\\\0\\end{pmatrix}$ 和 $\\mathbf{x}_{0}=\\begin{pmatrix}-2\\\\0\\\\-0.01\\end{pmatrix}$。初始残差定义为 $\\mathbf{r}_{0}=\\mathbf{b}-A\\mathbf{x}_{0}$。计算 $A\\mathbf{x}_{0}=\\begin{pmatrix}1\\cdot(-2)\\\\50\\cdot 0\\\\100\\cdot(-0.01)\\end{pmatrix}=\\begin{pmatrix}-2\\\\0\\\\-1\\end{pmatrix}$，因此\n$$\n\\mathbf{r}_{0}=\\begin{pmatrix}2\\\\0\\\\1\\end{pmatrix}.\n$$\n初始搜索方向为 $\\mathbf{p}_{0}=\\mathbf{r}_{0}$。步长为\n$$\n\\alpha_{0}=\\frac{\\mathbf{r}_{0}^{T}\\mathbf{r}_{0}}{\\mathbf{p}_{0}^{T}A\\mathbf{p}_{0}}=\\frac{2^{2}+0^{2}+1^{2}}{1\\cdot 2^{2}+50\\cdot 0^{2}+100\\cdot 1^{2}}=\\frac{5}{104}.\n$$\n我们通过 $\\mathbf{r}_{1}=\\mathbf{r}_{0}-\\alpha_{0}A\\mathbf{p}_{0}$ 来更新残差。首先计算 $A\\mathbf{p}_{0}=\\begin{pmatrix}2\\\\0\\\\100\\end{pmatrix}$，所以\n$$\n\\mathbf{r}_{1}=\\begin{pmatrix}2\\\\0\\\\1\\end{pmatrix}-\\frac{5}{104}\\begin{pmatrix}2\\\\0\\\\100\\end{pmatrix}=\\begin{pmatrix}2-\\frac{10}{104}\\\\0\\\\1-\\frac{500}{104}\\end{pmatrix}=\\begin{pmatrix}\\frac{99}{52}\\\\0\\\\-\\frac{99}{26}\\end{pmatrix}=\\frac{99}{52}\\begin{pmatrix}1\\\\0\\\\-2\\end{pmatrix}.\n$$\n因此，\n$$\n\\|\\mathbf{r}_{0}\\|_{2}=\\sqrt{2^{2}+0^{2}+1^{2}}=\\sqrt{5},\\qquad \\|\\mathbf{r}_{1}\\|_{2}=\\frac{99}{52}\\sqrt{1^{2}+0^{2}+(-2)^{2}}=\\frac{99}{52}\\sqrt{5}.\n$$\n该比值为\n$$\n\\frac{\\|\\mathbf{r}_{1}\\|_{2}}{\\|\\mathbf{r}_{0}\\|_{2}}=\\frac{99}{52}.\n$$\n数值上，$\\frac{99}{52}=1.903846\\ldots$，四舍五入到四位有效数字是 $1.904$。", "answer": "$$\\boxed{1.904}$$", "id": "2211015"}]}