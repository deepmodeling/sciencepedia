{"hands_on_practices": [{"introduction": "这个入门练习将通过一个简单的病态系统，让你直接上手进行计算。通过求解一个特定的正则化参数 $\\lambda$ 值，使得解向量的两个分量相等，你将具体地感受到 $\\lambda$ 是如何直接调整解向量的，从而在拟合数据和抑制解的范数之间取得平衡。这个过程有助于你建立对正则化参数作用的基本直觉。[@problem_id:2223140]", "problem": "在许多科学和工程应用中，会遇到形如 $Ax=b$ 的“病态”线性方程组。这意味着测量向量 $b$ 的微小变化可能导致解向量 $x$ 的巨大变化。Tikhonov 正则化是在这种情况下稳定解的一种常用方法。正则化解（记为 $x_{\\lambda}$）通过求解一个修正的优化问题得到，其公式为：\n$$x_{\\lambda} = (A^T A + \\lambda^2 I)^{-1} A^T b$$\n其中，$A$ 是系统矩阵，$b$ 是测量向量，$I$ 是单位矩阵，而 $\\lambda > 0$ 是一个用户选择的正则化参数，用于控制拟合数据与稳定解之间的权衡。\n\n考虑一个由以下矩阵 $A$ 和测量向量 $b$ 表征的简单二维系统：\n$$A = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0.1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$$\n$A$ 矩阵中的小元素使得该系统对噪声敏感，因此是进行正则化的一个很好选择。您的任务是研究正则化解 $x_{\\lambda}$ 的行为。\n\n确定正则化参数 $\\lambda$ 的具体值，使得解向量 $x_{\\lambda}$ 的两个分量相等。请将您的答案以保留三位有效数字的实数形式给出。", "solution": "我们使用 Tikhonov 正则化解的公式：\n$$\nx_{\\lambda}=(A^{T}A+\\lambda^2 I)^{-1}A^{T}b.\n$$\n对于给定的对角矩阵 $A=\\begin{pmatrix}1&0\\\\0&\\frac{1}{10}\\end{pmatrix}$，我们有 $A^{T}=A$，所以\n$$\nA^{T}A=\\begin{pmatrix}1&0\\\\0&\\frac{1}{100}\\end{pmatrix}, \\quad A^{T}b=\\begin{pmatrix}1\\\\ \\frac{1}{5}\\end{pmatrix}.\n$$\n因此，\n$$\nA^{T}A+\\lambda^2 I=\\begin{pmatrix}1+\\lambda^2&0\\\\0&\\lambda^2+\\frac{1}{100}\\end{pmatrix}, \\quad (A^{T}A+\\lambda^2 I)^{-1}=\\begin{pmatrix}\\frac{1}{1+\\lambda^2}&0\\\\0&\\frac{1}{\\lambda^2+\\frac{1}{100}}\\end{pmatrix}.\n$$\n所以，\n$$\nx_{\\lambda}=\\begin{pmatrix}\\frac{1}{1+\\lambda^2}&0\\\\0&\\frac{1}{\\lambda^2+\\frac{1}{100}}\\end{pmatrix}\\begin{pmatrix}1\\\\ \\frac{1}{5}\\end{pmatrix}=\\begin{pmatrix}\\frac{1}{1+\\lambda^2}\\\\ \\frac{\\frac{1}{5}}{\\lambda^2+\\frac{1}{100}}\\end{pmatrix}.\n$$\n我们寻求使两个分量相等的 $\\lambda$：\n$$\n\\frac{1}{1+\\lambda^2}=\\frac{\\frac{1}{5}}{\\lambda^2+\\frac{1}{100}}.\n$$\n交叉相乘得到\n$$\n\\lambda^2+\\frac{1}{100}=\\frac{1}{5}(1+\\lambda^2).\n$$\n两边乘以 $100$，\n$$\n100\\lambda^2+1=20(1+\\lambda^2) \\quad \\Rightarrow \\quad 100\\lambda^2+1=20+20\\lambda^2 \\quad \\Rightarrow \\quad 80\\lambda^2=19 \\quad \\Rightarrow \\quad \\lambda^2=\\frac{19}{80}.\n$$\n由于 $\\lambda > 0$，我们取正平方根：\n$$\n\\lambda = \\sqrt{\\frac{19}{80}} = \\sqrt{0.2375} \\approx 0.4873397...\n$$\n数值上，保留三位有效数字为 $0.487$。", "answer": "$$\\boxed{0.487}$$", "id": "2223140"}, {"introduction": "在第一个练习的基础上，本实践引入了“解路径” (solution path) 这一几何概念。通过考察解向量 $x_{\\lambda}$ 随着 $\\lambda$ 变化在平面上的移动轨迹，我们可以更深刻地理解在拟合数据（小 $\\lambda$）和稳定解（大 $\\lambda$）之间的权衡。计算这个路径与坐标轴的交点，就如同在这条轨迹上识别一个清晰的地标，揭示了正则化过程的一个关键转折点。[@problem_id:2223157]", "problem": "在许多科学和工程应用中，人们需要求解线性方程组 $Ax=b$，其中矩阵 $A$ 是病态的。一种稳定求解的常用方法是Tikhonov正则化，其目的是找到一个向量 $x$ 来最小化复合目标函数 $\\|Ax-b\\|^2_2 + \\lambda^2 \\|x\\|^2_2$，其中 $\\| \\cdot \\|_2$ 表示欧几里得范数，$\\lambda > 0$ 是一个正则化参数。此最小化问题的唯一解记为 $x_\\lambda$，由公式 $x_\\lambda = (A^T A + \\lambda^2 I)^{-1} A^T b$ 给出，其中 $I$ 是单位矩阵。\n\n考虑一个病态线性系统，其矩阵 $A$ 和向量 $b$ 定义如下：\n$$\nA = \\begin{pmatrix} 1 & 1.01 \\\\ 1 & 1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}\n$$\n解向量 $x_\\lambda = \\begin{pmatrix} x_1(\\lambda) \\\\ x_2(\\lambda) \\end{pmatrix}$ 随着参数 $\\lambda$ 的变化在平面上描绘出一条轨迹。存在一个唯一的正值 $\\lambda$，我们称之为 $\\lambda^*$，使得解的轨迹与 $x_2$ 轴相交。这对应于解向量的第一个分量为零，即 $x_1(\\lambda^*) = 0$。\n\n确定在此特定交点处第二个分量 $x_2(\\lambda^*)$ 的值。将最终答案四舍五入到四位有效数字。", "solution": "系统 $Ax=b$ 的Tikhonov正则化解由 $x_\\lambda = (A^T A + \\lambda^2 I)^{-1} A^T b$ 给出。我们已知的矩阵 $A$ 和向量 $b$ 为：\n$$\nA = \\begin{pmatrix} 1 & 1.01 \\\\ 1 & 1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}\n$$\n\n首先，我们计算所需的矩阵和向量乘积。\n$A$ 的转置是：\n$$\nA^T = \\begin{pmatrix} 1 & 1 \\\\ 1.01 & 1 \\end{pmatrix}\n$$\n接下来，我们计算 $A^T A$：\n$$\nA^T A = \\begin{pmatrix} 1 & 1 \\\\ 1.01 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 1.01 \\\\ 1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2 & 2.01 \\\\ 2.01 & 2.0201 \\end{pmatrix}\n$$\n现在，我们计算 $A^T b$：\n$$\nA^T b = \\begin{pmatrix} 1 & 1 \\\\ 1.01 & 1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 3.02 \\end{pmatrix}\n$$\n$x_\\lambda$ 的表达式中包含矩阵 $(A^T A + \\lambda^2 I)$：\n$$\nA^T A + \\lambda^2 I = \\begin{pmatrix} 2+\\lambda^2 & 2.01 \\\\ 2.01 & 2.0201+\\lambda^2 \\end{pmatrix}\n$$\n为了求该矩阵的逆，我们首先计算其行列式：\n$$\n\\det(A^T A + \\lambda^2 I) = (2+\\lambda^2)(2.0201+\\lambda^2) - (2.01)^2\n$$\n$$\n= (\\lambda^2)^2 + 4.0201\\lambda^2 + 4.0402 - 4.0401\n$$\n$$\n= \\lambda^4 + 4.0201\\lambda^2 + 0.0001\n$$\n逆矩阵是：\n$$\n(A^T A + \\lambda^2 I)^{-1} = \\frac{1}{\\lambda^4 + 4.0201\\lambda^2 + 0.0001} \\begin{pmatrix} 2.0201+\\lambda^2 & -2.01 \\\\ -2.01 & 2+\\lambda^2 \\end{pmatrix}\n$$\n现在我们可以写出 $x_\\lambda$ 的完整表达式：\n$$\nx_\\lambda = \\begin{pmatrix} x_1(\\lambda) \\\\ x_2(\\lambda) \\end{pmatrix} = \\frac{1}{\\lambda^4 + 4.0201\\lambda^2 + 0.0001} \\begin{pmatrix} 2.0201+\\lambda^2 & -2.01 \\\\ -2.01 & 2+\\lambda^2 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 3.02 \\end{pmatrix}\n$$\n让我们计算分子中的矩阵-向量乘积：\n$$\n\\begin{pmatrix} (2.0201+\\lambda^2) \\cdot 3 - 2.01 \\cdot 3.02 \\\\ -2.01 \\cdot 3 + (2+\\lambda^2) \\cdot 3.02 \\end{pmatrix} = \\begin{pmatrix} 6.0603 + 3\\lambda^2 - 6.0702 \\\\ -6.03 + 6.04 + 3.02\\lambda^2 \\end{pmatrix} = \\begin{pmatrix} 3\\lambda^2 - 0.0099 \\\\ 3.02\\lambda^2 + 0.01 \\end{pmatrix}\n$$\n所以，解向量为：\n$$\nx_\\lambda = \\begin{pmatrix} x_1(\\lambda) \\\\ x_2(\\lambda) \\end{pmatrix} = \\frac{1}{\\lambda^4 + 4.0201\\lambda^2 + 0.0001} \\begin{pmatrix} 3\\lambda^2 - 0.0099 \\\\ 3.02\\lambda^2 + 0.01 \\end{pmatrix}\n$$\n问题要求的是 $x_2(\\lambda^*)$ 的值，其中 $\\lambda^*$ 是使 $x_1(\\lambda) = 0$ 的 $\\lambda$ 正值。\n我们令第一个分量的分子为零，以求得 $(\\lambda^*)^2$：\n$$\n3(\\lambda^*)^2 - 0.0099 = 0\n$$\n$$\n(\\lambda^*)^2 = \\frac{0.0099}{3} = 0.0033\n$$\n该值为正，符合要求。现在我们将 $(\\lambda^*)^2=0.0033$ 代入 $x_2(\\lambda)$ 的表达式：\n$$\nx_2(\\lambda^*) = \\frac{3.02((\\lambda^*)^2) + 0.01}{((\\lambda^*)^2)^2 + 4.0201((\\lambda^*)^2) + 0.0001}\n$$\n$$\nx_2(\\lambda^*) = \\frac{3.02(0.0033) + 0.01}{(0.0033)^2 + 4.0201(0.0033) + 0.0001}\n$$\n计算分子：\n$$\n3.02 \\times 0.0033 + 0.01 = 0.009966 + 0.01 = 0.019966\n$$\n计算分母：\n$$\n(0.0033)^2 = 0.00001089\n$$\n$$\n4.0201 \\times 0.0033 = 0.01326633\n$$\n$$\n\\text{分母} = 0.00001089 + 0.01326633 + 0.0001 = 0.01337722\n$$\n最后，我们计算 $x_2(\\lambda^*)$ 的值：\n$$\nx_2(\\lambda^*) = \\frac{0.019966}{0.01337722} \\approx 1.4925343\n$$\n将结果四舍五入到四位有效数字，我们得到 $1.493$。", "answer": "$$\\boxed{1.493}$$", "id": "2223157"}, {"introduction": "在实际应用中，一个核心挑战是如何选择一个合适的 $\\lambda$ 值。本练习将介绍一种强大而直观的方法：差异原则 (discrepancy principle)。这个原则的核心思想是，正则化后的解所产生的残差范数 $\\|Ax_{\\lambda}-b\\|_2$ 应与数据 $b$ 中的噪声水平 $\\delta$ 相匹配。通过这个练习，你将学会如何利用已知的噪声信息来确定一个既能避免数据过拟合，又能充分尊重测量值的“最优”$\\lambda$。[@problem_id:2223147]", "problem": "在逆问题的研究中，人们经常遇到形如 $Ax=b$ 的不适定线性系统。一个常见的例子是当试图从一组观测效应 $b$ 中确定一组因果参数 $x$ 时。对于此类系统，矩阵 $A$ 通常是病态的或奇异的，这意味着测量向量 $b$ 中的微小噪声可能导致解向量 $x$ 出现巨大的、无物理意义的振荡。\n\nTikhonov 正则化是解决此问题的一种广泛使用的技术。它不是直接求解 $Ax=b$，而是寻求一个解 $x_{\\lambda}$，该解能最小化一个同时包含残差范数和解范数的复合目标函数：\n$$ \\min_{x} \\left( \\|Ax - b\\|_2^2 + \\lambda^2 \\|x\\|_2^2 \\right) $$\n其中，$\\lambda > 0$ 是正则化参数，它控制着拟合数据与惩罚解的范数之间的权衡。\n\n这个过程的一个关键部分是为 $\\lambda$ 选择一个合适的值。差异原则为此选择提供了一种启发式方法。它假定，如果数据向量 $b$ 中的噪声水平已知或可估计为 $\\delta = \\|b - b_{\\text{true}}\\|_2$，那么 $\\lambda$ 的一个好的选择是使正则化解的残差范数等于这个噪声水平。\n\n考虑一个由矩阵 $A$ 和测量数据向量 $b$ 描述的不适定系统：\n$$ A = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 5 \\\\ 3 \\end{pmatrix} $$\n测量值 $b$ 中的噪声水平估计为 $\\delta = 3\\sqrt{2}$。\n\n通过应用差异原则来确定正则化参数 $\\lambda$ 的值，在此案例中，这意味着找到满足方程 $\\|A x_{\\lambda} - b\\|_2 = \\delta$ 的 $\\lambda > 0$ 的值。请将您的最终答案表示为一个精确的、闭式解析表达式。", "solution": "我们寻求 Tikhonov 正则化解\n$$\nx_{\\lambda}=\\arg\\min_{x}\\left(\\|Ax-b\\|_{2}^{2}+\\lambda^{2}\\|x\\|_{2}^{2}\\right),\n$$\n它满足正规方程\n$$\n(A^{T}A+\\lambda^{2}I)x_{\\lambda}=A^{T}b.\n$$\n对于给定的矩阵和向量，\n$$\nA=\\begin{pmatrix}1&1\\\\1&1\\end{pmatrix},\\quad b=\\begin{pmatrix}5\\\\3\\end{pmatrix},\n$$\n我们计算\n$$\nA^{T}A=\\begin{pmatrix}2&2\\\\2&2\\end{pmatrix},\\quad A^{T}b=A^{T}\\begin{pmatrix}5\\\\3\\end{pmatrix}=\\begin{pmatrix}8\\\\8\\end{pmatrix}.\n$$\n令 $M= A^{T}A+\\lambda^{2}I=2J+\\lambda^{2}I$，其中 $J$ 是 $2\\times 2$ 的全1矩阵。向量 $u=(1,1)^{T}$ 是 $J$ 的一个特征向量，满足 $J u=2u$，因此 $M u=(4+\\lambda^{2})u$，而任何与 $u$ 正交的向量都是特征值为 $\\lambda^{2}$ 的特征向量。由于 $A^{T}b$ 与 $u$ 成正比，我们得到\n$$\nx_{\\lambda}=\\frac{8}{4+\\lambda^{2}}\\,u=\\frac{8}{4+\\lambda^{2}}\\begin{pmatrix}1\\\\1\\end{pmatrix}.\n$$\n残差为\n$$\nr_{\\lambda}=Ax_{\\lambda}-b=Jx_{\\lambda}-b=\\frac{16}{4+\\lambda^{2}}\\begin{pmatrix}1\\\\1\\end{pmatrix}-\\begin{pmatrix}5\\\\3\\end{pmatrix}.\n$$\n定义 $t=\\dfrac{16}{4+\\lambda^{2}}$。那么\n$$\nr_{\\lambda}=\\begin{pmatrix}t-5\\\\ t-3\\end{pmatrix},\\quad \\|r_{\\lambda}\\|_{2}^{2}=(t-5)^{2}+(t-3)^{2}=2t^{2}-16t+34.\n$$\n差异原则要求 $\\|r_{\\lambda}\\|_{2}=\\delta=3\\sqrt{2}$，即 $\\|r_{\\lambda}\\|_{2}^{2}=18$：\n$$\n2t^{2}-16t+34=18 \\quad\\Longrightarrow\\quad 2t^{2}-16t+16=0 \\quad\\Longrightarrow\\quad t^{2}-8t+8=0.\n$$\n解这个二次方程得到\n$$\nt=4\\pm 2\\sqrt{2}.\n$$\n由于 $t=\\dfrac{16}{4+\\lambda^{2}}$ 且 $\\lambda^2 > 0$，我们有 $0<t< 4$，因此可接受的根是 $t=4-2\\sqrt{2}$。因此\n$$\n\\frac{16}{4+\\lambda^{2}}=4-2\\sqrt{2}\\quad\\Longrightarrow\\quad 4+\\lambda^{2}=\\frac{16}{4-2\\sqrt{2}}.\n$$\n分母有理化，\n$$\n\\frac{16}{4-2\\sqrt{2}}=\\frac{8}{2-\\sqrt{2}}=\\frac{8(2+\\sqrt{2})}{(2-\\sqrt{2})(2+\\sqrt{2})}=\\frac{8(2+\\sqrt{2})}{2}=4(2+\\sqrt{2})=8+4\\sqrt{2}.\n$$\n因此，\n$$\n\\lambda^{2}=8+4\\sqrt{2}-4=4+4\\sqrt{2}=4(1+\\sqrt{2}),\n$$\n所以正则化参数是\n$$\n\\lambda=2\\sqrt{1+\\sqrt{2}}.\n$$", "answer": "$$\\boxed{2\\sqrt{1+\\sqrt{2}}}$$", "id": "2223147"}]}