{"hands_on_practices": [{"introduction": "要掌握 Lanczos 算法，最好的方法就是亲自动手计算。这个入门练习将引导你完成该算法的前两步，使用一个简单的对角矩阵。通过这个练习，你将熟悉构成该方法基础的核心计算步骤——向量归一化、矩阵向量乘积、点积和正交化，为理解更复杂的概念打下坚实的基础。[@problem_id:2184087]", "problem": "兰佐斯算法是一种数值方法，用于求解大型对称矩阵的特征值和特征向量。该算法通过迭代构建一个克雷洛夫子空间的标准正交基，从而生成一个三对角矩阵，该三对角矩阵的特征值近似于原矩阵的特征值。\n\n考虑一个对称矩阵 $A$ 和一个非零起始向量 $v$，定义如下：\n$$\nA = \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & 2 & 0 & 0 \\\\\n0 & 0 & 4 & 0 \\\\\n0 & 0 & 0 & 5\n\\end{pmatrix}, \\quad v = \\begin{pmatrix}\n1 \\\\\n1 \\\\\n1 \\\\\n1\n\\end{pmatrix}\n$$\n兰佐斯算法生成一个标准正交向量序列 $q_j$ 和一个大小为 $k \\times k$ 的对称三对角矩阵 $T_k$：\n$$\nT_k = \\begin{pmatrix}\n\\alpha_1 & \\beta_2 & & & \\\\\n\\beta_2 & \\alpha_2 & \\beta_3 & & \\\\\n& \\beta_3 & \\ddots & \\ddots & \\\\\n& & \\ddots & \\alpha_{k-1} & \\beta_k \\\\\n& & & \\beta_k & \\alpha_k\n\\end{pmatrix}\n$$\n系数 $\\alpha_j$ 和 $\\beta_j$ 通过以下迭代过程生成，初始条件为 $\\beta_1 = \\|v\\|_2$，$q_1 = v/\\beta_1$ 和 $q_0 = 0$：\n对于 $j=1, 2, \\dots, k$：\n1. $w_j = A q_j$\n2. $\\alpha_j = q_j^T w_j$\n3. $w_j' = w_j - \\alpha_j q_j - \\beta_j q_{j-1}$\n4. $\\beta_{j+1} = \\|w_j'\\|_2$\n5. $q_{j+1} = w_j' / \\beta_{j+1}$\n\n对给定的矩阵 $A$ 和起始向量 $v$ 执行两步（$k=2$）兰佐斯算法。确定定义了最终 $2 \\times 2$ 三对角矩阵 $T_2$ 的系数 $\\alpha_1$、$\\alpha_2$ 和 $\\beta_2$ 的值。\n\n按顺序给出 $\\alpha_1$、$\\alpha_2$ 和 $\\beta_2$ 的值。将最终答案保留四位有效数字。", "solution": "我们对给定的对称矩阵 $A$ 和起始向量 $v$ 应用兰佐斯算法。\n\n初始化：\n$v$ 的欧几里得范数是\n$$\n\\beta_{1}=\\|v\\|_{2}=\\sqrt{v^{T}v}=\\sqrt{1+1+1+1}=2,\n$$\n所以\n$$\nq_{1}=\\frac{v}{\\beta_{1}}=\\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix},\\quad q_{0}=0.\n$$\n\n步骤 $j=1$：\n计算\n$$\nw_{1}=Aq_{1}=\\begin{pmatrix}1&0&0&0\\\\0&2&0&0\\\\0&0&4&0\\\\0&0&0&5\\end{pmatrix}\\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix}\n=\\begin{pmatrix}\\frac{1}{2} \\\\ 1 \\\\ 2 \\\\ \\frac{5}{2}\\end{pmatrix}.\n$$\n然后\n$$\n\\alpha_{1}=q_{1}^{T}w_{1}=\\frac{1}{2}\\cdot\\frac{1}{2}+\\frac{1}{2}\\cdot 1+\\frac{1}{2}\\cdot 2+\\frac{1}{2}\\cdot\\frac{5}{2}\n=\\frac{1}{4}+\\frac{1}{2}+1+\\frac{5}{4}=3.\n$$\n接下来，\n$$\nw_{1}'=w_{1}-\\alpha_{1}q_{1}-\\beta_{1}q_{0}=\\begin{pmatrix}\\frac{1}{2} \\\\ 1 \\\\ 2 \\\\ \\frac{5}{2}\\end{pmatrix}-3\\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix}\n=\\begin{pmatrix}-1 \\\\ -\\frac{1}{2} \\\\ \\frac{1}{2} \\\\ 1\\end{pmatrix}.\n$$\n因此，\n$$\n\\beta_{2}=\\|w_{1}'\\|_{2}=\\sqrt{(-1)^{2}+\\left(-\\frac{1}{2}\\right)^{2}+\\left(\\frac{1}{2}\\right)^{2}+1^{2}}=\\sqrt{\\frac{5}{2}}=\\frac{\\sqrt{10}}{2}.\n$$\n下一个兰佐斯向量是\n$$\nq_{2}=\\frac{w_{1}'}{\\beta_{2}}=\\frac{2}{\\sqrt{10}}\\begin{pmatrix}-1 \\\\ -\\frac{1}{2} \\\\ \\frac{1}{2} \\\\ 1\\end{pmatrix}\n=\\frac{1}{\\sqrt{10}}\\begin{pmatrix}-2 \\\\ -1 \\\\ 1 \\\\ 2\\end{pmatrix}.\n$$\n\n步骤 $j=2$：\n计算\n$$\nw_{2}=Aq_{2}=\\frac{1}{\\sqrt{10}}\\begin{pmatrix}-2 \\\\ -2 \\\\ 4 \\\\ 10\\end{pmatrix},\n$$\n然后计算\n$$\n\\alpha_{2}=q_{2}^{T}w_{2}=\\frac{1}{10}\\left[(-2)(-2)+(-1)(-2)+(1)(4)+(2)(10)\\right]\n=\\frac{30}{10}=3.\n$$\n\n因此，$2\\times 2$ 的三对角矩阵 $T_{2}$ 具有 $\\alpha_{1}=3$，$\\alpha_{2}=3$ 和 $\\beta_{2}=\\frac{\\sqrt{10}}{2}$。保留四位有效数字得到 $\\alpha_{1}=3.000$，$\\alpha_{2}=3.000$ 和 $\\beta_{2}=1.581$。", "answer": "$$\\boxed{\\begin{pmatrix} 3.000 & 3.000 & 1.581 \\end{pmatrix}}$$", "id": "2184087"}, {"introduction": "这个练习探讨了一个非常有趣的特殊情况：如果我们的初始向量恰好是矩阵的一个特征向量，会发生什么？通过这个思想实验，我们将揭示 Lanczos 算法、Krylov 子空间以及特征值与特征向量基本性质之间的深刻联系。这个例子清晰地展示了该算法为何如此高效。[@problem_id:2184039]", "problem": "考虑由下式给出的实对称矩阵 $A$ 和起始向量 $b$：\n$$A = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$$\nLanczos 算法是一种用于寻找矩阵特征值近似值的数值方法。从向量 $b$ 开始，该算法生成一个标准正交向量序列 $q_1, q_2, \\ldots, q_k$ 和一个实对称三对角矩阵 $T_k$。该矩阵的元素由 Lanczos 递推关系确定。该标准正交序列中的第一个向量通过对起始向量进行归一化来定义，即 $q_1 = b / ||b||_2$，而 $T_k$ 的第一个对角元素计算为 $\\alpha_1 = q_1^T A q_1$。\n\n假设对给定的矩阵 $A$ 和起始向量 $b$ 应用 Lanczos 算法，那么第一个对角元素 $\\alpha_1$ 的值是多少？\n\nA. $0$\nB. $1$\nC. $2$\nD. $\\sqrt{2}$\nE. $2 + \\sqrt{2}$", "solution": "Lanczos 算法设定 $q_{1} = b / \\|b\\|_{2}$ 并计算 $\\alpha_{1} = q_{1}^{T} A q_{1}$。利用归一化的定义，上式可以写为\n$$\n\\alpha_{1} = \\frac{b^{T} A b}{b^{T} b}.\n$$\n首先计算 $b$ 的范数：\n$$\n\\|b\\|_{2} = \\sqrt{b^{T} b} = \\sqrt{1^{2} + 0^{2} + (-1)^{2}} = \\sqrt{2}.\n$$\n接下来计算 $A b$。对于\n$$\nA = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix},\n$$\n我们有\n$$\nA b = \\begin{pmatrix} 2\\cdot 1 + (-1)\\cdot 0 + 0\\cdot (-1) \\\\ (-1)\\cdot 1 + 2\\cdot 0 + (-1)\\cdot (-1) \\\\ 0\\cdot 1 + (-1)\\cdot 0 + 2\\cdot (-1) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 0 \\\\ -2 \\end{pmatrix} = 2 b.\n$$\n因此，\n$$\nb^{T} A b = b^{T} (2 b) = 2\\, b^{T} b.\n$$\n将其代入 $\\alpha_{1}$ 的表达式中，得到\n$$\n\\alpha_{1} = \\frac{2\\, b^{T} b}{b^{T} b} = 2.\n$$\n因此，正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "2184039"}, {"introduction": "Lanczos 算法并不总是需要对一个 $n \\times n$ 的矩阵执行 $n$ 次迭代。本练习将展示一个导致“提前终止”的场景，这是该算法的一个关键特性。通过分析算法停止的原因，我们将揭示不变子空间 (invariant subspace) 的概念，并了解 Lanczos 算法如何高效地找到与特定初始向量相关的特征值。[@problem_id:2184051]", "problem": "考虑对一个实对称矩阵 $A$ 和一个非零初始向量 $b$ 应用兰佐斯三对角化算法。该算法生成一个标准正交向量序列 $v_1, v_2, \\dots, v_m$ 和一个大小为 $m \\times m$ 的实对称三对角矩阵 $T_m$。该过程通过如下迭代方式定义：\n\n初始化 $\\beta_0 = 0$，$v_0 = 0$（零向量），并将初始向量单位化得到 $v_1 = b / \\|b\\|$。\n\n对于 $j = 1, 2, \\dots$：\n1. 计算向量 $w_j = Av_j - \\beta_{j-1} v_{j-1}$。\n2. 计算 $T_m$ 的第 $j$ 个对角元素 $\\alpha_j = v_j^T w_j$。\n3. 计算残差向量 $\\hat{w}_j = w_j - \\alpha_j v_j$。\n4. 计算 $T_m$ 的第 $j$ 个次对角元素 $\\beta_j = \\|\\hat{w}_j\\|$。\n5. 如果 $\\beta_j = 0$，则算法终止，三对角矩阵的大小为 $m=j$。否则，计算下一个标准正交向量 $v_{j+1} = \\hat{w}_j / \\beta_j$ 并进入下一次迭代。\n\n最终得到的三对角矩阵为：\n$$ T_m = \\begin{pmatrix} \\alpha_1 & \\beta_1 & & & \\\\ \\beta_1 & \\alpha_2 & \\beta_2 & & \\\\ & \\ddots & \\ddots & \\ddots & \\\\ & & \\beta_{m-2} & \\alpha_{m-1} & \\beta_{m-1} \\\\ & & & \\beta_{m-1} & \\alpha_m \\end{pmatrix} $$\n\n给定如下的 $3 \\times 3$ 对称矩阵 $A$ 和初始向量 $b$：\n$$ A = \\begin{pmatrix} 7 & -3 & 0 \\\\ -3 & 7 & 0 \\\\ 0 & 0 & 10 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} $$\n\n对此矩阵和初始向量应用兰佐斯算法。确定第二个对角元素 $\\alpha_2$ 的数值。", "solution": "题目要求计算由兰佐斯算法对给定的矩阵 $A$ 和向量 $b$ 所生成的三对角矩阵的第二个对角元素 $\\alpha_2$ 的值。我们将遵循所述算法的步骤进行。\n\n**初始化：**\n初始向量为 $b = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n首先，我们计算其范数：$\\|b\\| = \\sqrt{0^2 + 1^2 + 0^2} = 1$。\n第一个标准正交向量为 $v_1 = \\frac{b}{\\|b\\|} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n迭代的初始值为 $\\beta_0 = 0$ 和 $v_0 = 0$。\n\n**第一次迭代 (j=1)：**\n1.  计算 $w_1 = Av_1 - \\beta_0 v_0$。由于 $\\beta_0=0$，该式简化为 $w_1 = Av_1$。\n    $$ w_1 = \\begin{pmatrix} 7 & -3 & 0 \\\\ -3 & 7 & 0 \\\\ 0 & 0 & 10 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 7 \\\\ 0 \\end{pmatrix} $$\n2.  计算第一个对角元素 $\\alpha_1 = v_1^T w_1$。\n    $$ \\alpha_1 = \\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} -3 \\\\ 7 \\\\ 0 \\end{pmatrix} = (0)(-3) + (1)(7) + (0)(0) = 7 $$\n3.  计算残差向量 $\\hat{w}_1 = w_1 - \\alpha_1 v_1$。\n    $$ \\hat{w}_1 = \\begin{pmatrix} -3 \\\\ 7 \\\\ 0 \\end{pmatrix} - 7 \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 7-7 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n4.  计算第一个次对角元素 $\\beta_1 = \\|\\hat{w}_1\\|$。\n    $$ \\beta_1 = \\sqrt{(-3)^2 + 0^2 + 0^2} = \\sqrt{9} = 3 $$\n5.  由于 $\\beta_1 = 3 \\neq 0$，算法继续执行。我们计算下一个标准正交向量 $v_2$。\n    $$ v_2 = \\frac{\\hat{w}_1}{\\beta_1} = \\frac{1}{3} \\begin{pmatrix} -3 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n\n**第二次迭代 (j=2)：**\n1.  计算 $w_2 = Av_2 - \\beta_1 v_1$。我们使用 $\\beta_1=3$、$v_1=\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 和 $v_2=\\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n    $$ Av_2 = \\begin{pmatrix} 7 & -3 & 0 \\\\ -3 & 7 & 0 \\\\ 0 & 0 & 10 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -7 \\\\ 3 \\\\ 0 \\end{pmatrix} $$\n    $$ w_2 = \\begin{pmatrix} -7 \\\\ 3 \\\\ 0 \\end{pmatrix} - 3 \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -7 \\\\ 3-3 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -7 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n2.  计算第二个对角元素 $\\alpha_2 = v_2^T w_2$。这就是题目所求的值。\n    $$ \\alpha_2 = \\begin{pmatrix} -1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} -7 \\\\ 0 \\\\ 0 \\end{pmatrix} = (-1)(-7) + (0)(0) + (0)(0) = 7 $$\n\n第二个对角元素的值为 $\\alpha_2=7$。\n为了完整起见，我们可以检查算法是否在此处终止。\n3. 计算 $\\hat{w}_2 = w_2 - \\alpha_2 v_2$。\n   $$ \\hat{w}_2 = \\begin{pmatrix} -7 \\\\ 0 \\\\ 0 \\end{pmatrix} - 7 \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -7 - (-7) \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n4. 计算 $\\beta_2 = \\|\\hat{w}_2\\| = 0$。\n由于 $\\beta_2=0$，算法在这一步终止。最终得到的三对角矩阵是 $T_2 = \\begin{pmatrix} \\alpha_1 & \\beta_1 \\\\ \\beta_1 & \\alpha_2 \\end{pmatrix} = \\begin{pmatrix} 7 & 3 \\\\ 3 & 7 \\end{pmatrix}$。\n所求的值是 $\\alpha_2$。", "answer": "$$\\boxed{7}$$", "id": "2184051"}]}