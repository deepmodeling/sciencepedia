{"hands_on_practices": [{"introduction": "这项实践是一个基础练习，将引导你完成 Arnoldi 迭代的核心步骤。通过构建一个小的 $3 \\times 3$ 海森伯格矩阵，你将亲手操作该算法的每一个环节。掌握这些计算——向量归一化、矩阵向量乘积和 Gram-Schmidt 正交化——是理解 Arnoldi 迭代如何为原始大矩阵构建一个紧凑表示的关键[@problem_id:2154379]。", "problem": "Arnoldi 迭代是一种用于近似计算矩阵特征值的数值算法，对于大型稀疏矩阵尤其有效。该算法为与矩阵 $A$ 和向量 $b$ 相关联的 Krylov 子空间构造一个标准正交基。\n\n设矩阵 $A$ 和初始向量 $b$ 如下所示：\n$$\nA = \\begin{pmatrix}\n2 & 3 & 1 \\\\\n1 & 1 & 1 \\\\\n-1 & 0 & 2\n\\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nArnoldi 过程生成一个标准正交向量序列 $\\{q_1, q_2, \\dots, q_k\\}$，该序列构成 Krylov 子空间 $\\mathcal{K}_k(A, b)$ 的一个基，并生成一个 $k \\times k$ 的上 Hessenberg 矩阵 $H_k$。该过程通过设置 $q_1 = b / \\|b\\|$ 来初始化。在 Arnoldi 分解 $AQ_k = Q_kH_k + h_{k+1,k} q_{k+1} e_k^T$ 中，其中 $Q_k = [q_1, \\dots, q_k]$，Hessenberg 矩阵的元素由关系式 $h_{ij} = q_i^T A q_j$ 定义。\n\n执行三步 Arnoldi 迭代，求出所得到的 $3 \\times 3$ 上 Hessenberg 矩阵 $H_3$。", "solution": "我们从 $q_{1} = \\dfrac{b}{\\|b\\|} = \\begin{pmatrix}1 \\\\ 0 \\\\ 0\\end{pmatrix}$ 开始。\n\n第一步 Arnoldi 迭代 ($j=1$)：\n计算 $w = A q_{1} = \\begin{pmatrix}2 \\\\ 1 \\\\ -1\\end{pmatrix}$。然后\n$h_{11} = q_{1}^{T} A q_{1} = 2$，\n$w \\leftarrow w - h_{11} q_{1} = \\begin{pmatrix}0 \\\\ 1 \\\\ -1\\end{pmatrix}$。\n计算\n$h_{21} = \\|w\\| = \\sqrt{2}$，\n$q_{2} = \\frac{w}{h_{21}} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}0 \\\\ 1 \\\\ -1\\end{pmatrix}$。\n\n第二步 Arnoldi 迭代 ($j=2$)：\n计算\n$w = A q_{2} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}2 \\\\ 0 \\\\ -2\\end{pmatrix}$。\n然后\n$h_{12} = q_{1}^{T} A q_{2} = \\frac{2}{\\sqrt{2}} = \\sqrt{2}$，\n$w \\leftarrow w - h_{12} q_{1} = \\begin{pmatrix}0 \\\\ 0 \\\\ -\\sqrt{2}\\end{pmatrix}$。\n接下来\n$h_{22} = q_{2}^{T} A q_{2} = 1$，\n$w \\leftarrow w - h_{22} q_{2} = \\begin{pmatrix}0 \\\\ -\\frac{1}{\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}}\\end{pmatrix}$。\n然后\n$h_{32} = \\|w\\| = 1$，\n$q_{3} = \\frac{w}{h_{32}} = \\begin{pmatrix}0 \\\\ -\\frac{1}{\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}}\\end{pmatrix}$。\n\n第三步 Arnoldi 迭代 ($j=3$)：\n计算\n$A q_{3} = -\\frac{1}{\\sqrt{2}}\\begin{pmatrix}4 \\\\ 2 \\\\ 2\\end{pmatrix} = \\begin{pmatrix}-2\\sqrt{2} \\\\ -\\sqrt{2} \\\\ -\\sqrt{2}\\end{pmatrix}$。\n然后 Hessenberg 矩阵的元素为\n$h_{13} = q_{1}^{T} A q_{3} = -2\\sqrt{2}$，\n$h_{23} = q_{2}^{T} A q_{3} = 0$，\n$h_{33} = q_{3}^{T} A q_{3} = 2$。\n因为空间是三维的，并且我们已经构造了三个标准正交向量，所以减去这些分量后的残差为零，因此不会再产生新的向量。\n\n汇总所有元素，该 $3\\times 3$ 上 Hessenberg 矩阵为\n$$\nH_{3} = \\begin{pmatrix}\nh_{11} & h_{12} & h_{13} \\\\\nh_{21} & h_{22} & h_{23} \\\\\n0 & h_{32} & h_{33}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2 & \\sqrt{2} & -2\\sqrt{2} \\\\\n\\sqrt{2} & 1 & 0 \\\\\n0 & 1 & 2\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}2 & \\sqrt{2} & -2\\sqrt{2} \\\\ \\sqrt{2} & 1 & 0 \\\\ 0 & 1 & 2\\end{pmatrix}}$$", "id": "2154379"}, {"introduction": "如果我们巧妙地选择起始向量会发生什么？这项练习将探讨一个 Arnoldi 迭代立即终止的特殊情况。通过找出其背后的原因，你将揭示算法终止条件与特征向量和不变子空间之间的深刻联系[@problem_id:2154381]。这个思想实验有助于加深对算法行为的理解，而不仅仅是套用公式。", "problem": "阿诺尔迪迭代是一种用于近似计算特征值的数值算法。对于一个给定的方阵 $A$ 和一个初始向量 $v_1$，第一步包括将向量单位化为 $q_1 = v_1 / \\|v_1\\|_2$，计算 $w = A q_1$，然后计算残差向量 $r_1 = w - (q_1^T w) q_1$。如果残差向量 $r_1$ 是零向量，则算法在第一步后终止。\n\n考虑一个 $3 \\times 3$ 矩阵 $A$，其元素定义为 $A_{11}=1$, $A_{12}=0$, $A_{13}=1$, $A_{21}=1$, $A_{22}=1$, $A_{23}=1$, $A_{31}=1$, $A_{32}=1$, $A_{33}=-1$。当选择下列哪个列向量作为初始向量 $v_1$ 时，会使阿诺尔迪迭代仅在一步之后就终止？\n\nA. 分量为 (1, 1, 1) 的向量。\n\nB. 分量为 (1, 2, 1) 的向量。\n\nC. 分量为 (1, -1, 0) 的向量。\n\nD. 分量为 (0, 1, 1) 的向量。\n\nE. 分量为 (1, 0, -1) 的向量。", "solution": "问题要求确定哪个初始向量 $v_1$ 会导致阿诺尔迪迭代在第一步后终止。\n根据问题描述，如果残差向量 $r_1$ 是零向量，阿诺尔迪迭代的第一步就会终止。\n残差向量定义为 $r_1 = w - h_{11} q_1$，其中 $q_1 = v_1 / \\|v_1\\|_2$，$w = A q_1$，并且 $h_{11} = q_1^T w = q_1^T A q_1$。\n\n令 $r_1 = 0$，我们得到：\n$$\nw - h_{11} q_1 = 0 \\implies w = h_{11} q_1\n$$\n代入 $w$ 的表达式：\n$$\nA q_1 = h_{11} q_1\n$$\n这是特征向量和特征值的定义。该方程表明向量 $q_1$ 必须是矩阵 $A$ 的一个特征向量，而标量 $h_{11}$ 必须是对应的特征值。\n\n由于 $q_1$ 只是初始向量 $v_1$ 的单位化版本（即 $q_1$ 是 $v_1$ 乘以 $1/\\|v_1\\|_2$），如果 $q_1$ 是一个特征向量，那么 $v_1$ 也必须是 $A$ 的一个特征向量。具体来说，如果 $A q_1 = \\lambda q_1$，那么：\n$$\nA \\left(\\frac{v_1}{\\|v_1\\|_2}\\right) = \\lambda \\left(\\frac{v_1}{\\|v_1\\|_2}\\right)\n$$\n两边同乘以标量 $\\|v_1\\|_2$ 得到：\n$$\nA v_1 = \\lambda v_1\n$$\n因此，问题简化为找出给定的向量中哪一个是矩阵 $A$ 的特征向量。\n\n矩阵 $A$ 由其元素给出：\n$$\nA = \\begin{pmatrix} 1 & 0 & 1 \\\\ 1 & 1 & 1 \\\\ 1 & 1 & -1 \\end{pmatrix}\n$$\n我们现在通过将矩阵 $A$ 乘以每个选项中的向量 $v_1$ 来测试每个选项，并检查结果向量是否是原始向量的标量倍数。\n\nA. 对于 $v_1 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$：\n$$\nA v_1 = \\begin{pmatrix} 1 & 0 & 1 \\\\ 1 & 1 & 1 \\\\ 1 & 1 & -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1(1) + 0(1) + 1(1) \\\\ 1(1) + 1(1) + 1(1) \\\\ 1(1) + 1(1) - 1(1) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 3 \\\\ 1 \\end{pmatrix}\n$$\n是否存在某个标量 $\\lambda$ 使得 $\\begin{pmatrix} 2 \\\\ 3 \\\\ 1 \\end{pmatrix} = \\lambda \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$？不存在，因为 $2/1 \\neq 3/1$。\n\nB. 对于 $v_1 = \\begin{pmatrix} 1 \\\\ 2 \\\\ 1 \\end{pmatrix}$：\n$$\nA v_1 = \\begin{pmatrix} 1 & 0 & 1 \\\\ 1 & 1 & 1 \\\\ 1 & 1 & -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1(1) + 0(2) + 1(1) \\\\ 1(1) + 1(2) + 1(1) \\\\ 1(1) + 1(2) - 1(1) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 4 \\\\ 2 \\end{pmatrix}\n$$\n是否存在某个标量 $\\lambda$ 使得 $\\begin{pmatrix} 2 \\\\ 4 \\\\ 2 \\end{pmatrix} = \\lambda \\begin{pmatrix} 1 \\\\ 2 \\\\ 1 \\end{pmatrix}$？存在，如果我们令 $\\lambda=2$，我们有 $2 \\begin{pmatrix} 1 \\\\ 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 4 \\\\ 2 \\end{pmatrix}$。这个向量是 $A$ 的一个特征向量。\n\nC. 对于 $v_1 = \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\end{pmatrix}$：\n$$\nA v_1 = \\begin{pmatrix} 1 & 0 & 1 \\\\ 1 & 1 & 1 \\\\ 1 & 1 & -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1(1) + 0(-1) + 1(0) \\\\ 1(1) + 1(-1) + 1(0) \\\\ 1(1) + 1(-1) - 1(0) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n是否存在某个标量 $\\lambda$ 使得 $\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\lambda \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\end{pmatrix}$？不存在。例如，第二个分量是 $0 = \\lambda(-1)$，这意味着 $\\lambda=0$，但第一个分量是 $1 = \\lambda(1)$，这意味着 $\\lambda=1$。这是一个矛盾。\n\nD. 对于 $v_1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}$：\n$$\nA v_1 = \\begin{pmatrix} 1 & 0 & 1 \\\\ 1 & 1 & 1 \\\\ 1 & 1 & -1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1(0) + 0(1) + 1(1) \\\\ 1(0) + 1(1) + 1(1) \\\\ 1(0) + 1(1) - 1(1) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\end{pmatrix}\n$$\n是否存在某个标量 $\\lambda$ 使得 $\\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\end{pmatrix} = \\lambda \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}$？不存在。第一个分量要求 $1 = \\lambda(0)$，这是不可能的。\n\nE. 对于 $v_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$：\n$$\nA v_1 = \\begin{pmatrix} 1 & 0 & 1 \\\\ 1 & 1 & 1 \\\\ 1 & 1 & -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 1(1) + 0(0) + 1(-1) \\\\ 1(1) + 1(0) + 1(-1) \\\\ 1(1) + 1(0) - 1(-1) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 2 \\end{pmatrix}\n$$\n是否存在某个标量 $\\lambda$ 使得 $\\begin{pmatrix} 0 \\\\ 0 \\\\ 2 \\end{pmatrix} = \\lambda \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$？不存在。第一个分量要求 $0 = \\lambda(1)$，这意味着 $\\lambda=0$。但第三个分量要求 $2 = \\lambda(-1)$，这意味着 $\\lambda=-2$。这是一个矛盾。\n\n只有选项B中的向量是 $A$ 的一个特征向量。因此，选择这个向量作为初始向量 $v_1$ 将导致阿诺尔迪迭代在第一步后终止。", "answer": "$$\\boxed{B}$$", "id": "2154381"}, {"introduction": "Arnoldi 迭代并不总是需要运行很多步才能有效。这个问题探讨了当处理一个低秩矩阵时，为什么迭代会提前终止。这揭示了克雷洛夫子空间的一个强大特性，并暗示了为什么 Arnoldi 算法在处理特定类型问题（如模型降阶）时如此高效[@problem_id:2154383]。", "problem": "在分析大规模线性动力系统时，通常通过将系统动力投影到一个低维Krylov子空间来实现模型降阶。考虑一个离散时间线性系统，其状态演化由矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 控制。矩阵 $A$ 由两个外积之和构成：\n$$A = u_1 v_1^T + u_2 v_2^T$$\n其中 $u_1, u_2, v_1, v_2$ 是 $\\mathbb{R}^n$ 中的非零列向量。向量对 $\\{u_1, u_2\\}$ 和 $\\{v_1, v_2\\}$ 各自是线性无关的。\n\nArnoldi迭代是一种数值算法，用于从一个初始向量 $b$ 开始，为Krylov子空间 $\\mathcal{K}_m(A, b) = \\text{span}\\{b, Ab, A^2b, \\dots, A^{m-1}b\\}$ 生成一个标准正交基 $\\{q_1, q_2, \\dots, q_m\\}$。该算法流程如下：\n1. 初始化：$q_1 = b / \\|b\\|_2$。\n2. 对 $j = 1, 2, 3, \\dots, m-1$ 进行迭代：\n    a. 计算下一个Krylov向量：$w = A q_j$。\n    b. 将 $w$ 与之前的基向量进行正交化（Gram-Schmidt方法）：\n        i. 对于 $i=1, \\dots, j$，计算投影系数：$h_{i,j} = q_i^T w$。\n        ii. 减去投影：$w_{\\perp} = w - \\sum_{i=1}^{j} h_{i,j} q_i$。\n    c. 计算新正交向量的范数：$h_{j+1,j} = \\|w_{\\perp}\\|_2$。\n    d. 如果 $h_{j+1,j} = 0$，则迭代终止。否则，进行归一化以得到下一个基向量：$q_{j+1} = w_{\\perp} / h_{j+1,j}$。\n\n系数 $h_{i,j}$ 构成一个上Hessenberg矩阵 $H_m$。\n\n假设我们使用一个初始向量 $b \\in \\mathbb{R}^n$ 来应用Arnoldi迭代，该向量的选择使得前三个Krylov子空间的维度分别为 $\\dim(\\mathcal{K}_1(A,b))=1$、$\\dim(\\mathcal{K}_2(A,b))=2$ 和 $\\dim(\\mathcal{K}_3(A,b))=3$。\n\n矩阵元素 $h_{4,3}$ 的值是多少？\n\nA. 1\nB. 0\nC. 一个非零值，其大小取决于 $u_1, u_2, v_1, v_2$ 的范数。\nD. 一个非零值，其大小取决于 $u_i, v_i$ 和 $b$ 之间的内积。\nE. 在没有向量的明确数值的情况下，该值无法确定。", "solution": "将 $A$ 写为 $A = u_{1} v_{1}^{T} + u_{2} v_{2}^{T}$。对于任意 $x \\in \\mathbb{R}^{n}$，\n$$\nA x = u_{1}\\big(v_{1}^{T} x\\big) + u_{2}\\big(v_{2}^{T} x\\big) \\in \\operatorname{span}\\{u_{1},u_{2}\\}.\n$$\n因此 $\\operatorname{Im}(A) \\subseteq \\operatorname{span}\\{u_{1},u_{2}\\}$，并且对于所有 $k \\geq 1$，$A^{k} b \\in \\operatorname{span}\\{u_{1},u_{2}\\}$。\n\n因此，对于任意 $m \\geq 1$，\n$$\n\\mathcal{K}_{m}(A,b) = \\operatorname{span}\\{b,Ab,\\dots,A^{m-1}b\\} \\subseteq \\operatorname{span}\\{b\\} + \\operatorname{span}\\{u_{1},u_{2}\\}.\n$$\n特别地，$\\dim\\big(\\mathcal{K}_{m}(A,b)\\big) \\leq 3$。根据假设，$\\dim\\big(\\mathcal{K}_{1}(A,b)\\big)=1$、$\\dim\\big(\\mathcal{K}_{2}(A,b)\\big)=2$ 和 $\\dim\\big(\\mathcal{K}_{3}(A,b)\\big)=3$，这必然导致\n$$\n\\mathcal{K}_{3}(A,b) = \\operatorname{span}\\{b,Ab,A^{2}b\\} = \\operatorname{span}\\{b\\} \\oplus \\operatorname{span}\\{u_{1},u_{2}\\}.\n$$\n由于 $A b \\in \\operatorname{span}\\{u_{1},u_{2}\\}$ 且 $A$ 将 $\\operatorname{span}\\{u_{1},u_{2}\\}$ 映射到其自身，因此可以得出\n$$\nA\\big(\\mathcal{K}_{3}(A,b)\\big) \\subseteq \\operatorname{span}\\{u_{1},u_{2}\\} \\subseteq \\mathcal{K}_{3}(A,b).\n$$\n因此 $\\mathcal{K}_{3}(A,b)$ 是 $A$-不变的，并且对于 $\\mathcal{K}_{3}(A,b)$ 的任何 Arnoldi 标准正交基 $\\{q_{1},q_{2},q_{3}\\}$，都有 $A q_{3} \\in \\operatorname{span}\\{q_{1},q_{2},q_{3}\\}$。\n\n在Arnoldi迭代的第 $j=3$ 步，我们计算 $w = A q_{3}$ 并将其与 $q_{1},q_{2},q_{3}$ 正交化，得到 $w_{\\perp} = w - \\sum_{i=1}^{3} h_{i,3} q_{i}$。因为 $w \\in \\operatorname{span}\\{q_{1},q_{2},q_{3}\\}$，所以 $w_{\\perp} = 0$。因此\n$$\nh_{4,3} = \\|w_{\\perp}\\|_{2} = 0.\n$$\n因此，正确选项是B。", "answer": "$$\\boxed{B}$$", "id": "2154383"}]}