{"hands_on_practices": [{"introduction": "要真正掌握QR算法，最好的方法就是亲自动手。这个练习将带你完整地走一遍QR算法的核心迭代步骤：对一个简单的 $2 \\times 2$ 矩阵进行QR分解，然后通过逆序相乘得到下一个矩阵。这是一个巩固基本功、熟悉算法流程的绝佳起点。[@problem_id:2219215]", "problem": "无位移QR算法是一种用于计算矩阵特征值的迭代数值方法。该过程从矩阵 $A_0 = A$ 开始。在每次迭代 $k$（从 $k=0$ 开始）中，矩阵 $A_k$ 被分解为乘积 $A_k = Q_k R_k$，其中 $Q_k$ 是一个正交矩阵，$R_k$ 是一个上三角矩阵。然后，下一次迭代的矩阵计算为 $A_{k+1} = R_k Q_k$。\n\n考虑初始的实对称矩阵 $A_0$ 如下：\n$$A_0 = \\begin{pmatrix} 5 & 2 \\\\ 2 & 2 \\end{pmatrix}$$\n执行一次完整的无位移QR算法迭代，求出矩阵 $A_1$。你的最终答案应为矩阵 $A_1$，其元素以精确分数形式表示。", "solution": "我们对矩阵 $A_0 = \\begin{pmatrix} 5 & 2 \\\\ 2 & 2 \\end{pmatrix}$ 应用一步无位移QR算法。首先通过Gram–Schmidt过程计算QR分解 $A_0=Q_0 R_0$。设 $A_0$ 的列向量为 $a_1=\\begin{pmatrix} 5 \\\\ 2 \\end{pmatrix}$ 和 $a_2=\\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}$。计算 $r_{11}=\\|a_1\\|=\\sqrt{5^2+2^2}=\\sqrt{29}$ 和 $q_1=a_1/r_{11}=\\begin{pmatrix} \\frac{5}{\\sqrt{29}} \\\\ \\frac{2}{\\sqrt{29}} \\end{pmatrix}$。接着，$r_{12}=q_1^T a_2=\\frac{1}{\\sqrt{29}}(5\\cdot 2+2\\cdot 2)=\\frac{14}{\\sqrt{29}}$。构造 $u_2=a_2-r_{12}q_1=\\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}-\\frac{14}{29}\\begin{pmatrix} 5 \\\\ 2 \\end{pmatrix}=\\begin{pmatrix} -\\frac{12}{29} \\\\ \\frac{30}{29} \\end{pmatrix}$，所以 $r_{22}=\\|u_2\\|=\\frac{2\\sqrt{261}}{29}$ 且 $q_2=u_2/r_{22}=\\begin{pmatrix} -\\frac{6}{\\sqrt{261}} \\\\ \\frac{15}{\\sqrt{261}} \\end{pmatrix}$。因此，\n$$\nQ_0=\\begin{pmatrix}\n\\frac{5}{\\sqrt{29}} & -\\frac{6}{\\sqrt{261}} \\\\\n\\frac{2}{\\sqrt{29}} & \\frac{15}{\\sqrt{261}}\n\\end{pmatrix},\\quad\nR_0=\\begin{pmatrix}\n\\sqrt{29} & \\frac{14}{\\sqrt{29}} \\\\\n0 & \\frac{18}{\\sqrt{261}}\n\\end{pmatrix}.\n$$\n下一个迭代矩阵是 $A_1=R_0 Q_0$。计算其元素：\n$$\n(A_1)_{11}=\\sqrt{29}\\cdot\\frac{5}{\\sqrt{29}}+\\frac{14}{\\sqrt{29}}\\cdot\\frac{2}{\\sqrt{29}}=5+\\frac{28}{29}=\\frac{173}{29},\n$$\n$$\n(A_1)_{12}=\\sqrt{29}\\cdot\\left(-\\frac{6}{\\sqrt{261}}\\right)+\\frac{14}{\\sqrt{29}}\\cdot\\frac{15}{\\sqrt{261}}=-2+\\frac{70}{29}=\\frac{12}{29},\n$$\n$$\n(A_1)_{21}=0\\cdot\\frac{5}{\\sqrt{29}}+\\frac{18}{\\sqrt{261}}\\cdot\\frac{2}{\\sqrt{29}}=\\frac{36}{3\\cdot 29}=\\frac{12}{29},\n$$\n$$\n(A_1)_{22}=0\\cdot\\left(-\\frac{6}{\\sqrt{261}}\\right)+\\frac{18}{\\sqrt{261}}\\cdot\\frac{15}{\\sqrt{261}}=\\frac{270}{261}=\\frac{30}{29}.\n$$\n于是，\n$$\nA_1=\\begin{pmatrix}\n\\frac{173}{29} & \\frac{12}{29} \\\\\n\\frac{12}{29} & \\frac{30}{29}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{173}{29} & \\frac{12}{29} \\\\ \\frac{12}{29} & \\frac{30}{29}\\end{pmatrix}}$$", "id": "2219215"}, {"introduction": "在熟悉了QR迭代的机械步骤之后，我们来探讨一个更具概念性的问题：如果算法的输入已经是一个理想形式的矩阵（例如对角矩阵），会发生什么？这个练习揭示了QR算法的一个重要特性——它的“不动点”。通过这个例子，你可以更深刻地理解算法的收敛目标，即逐步将矩阵转化为特征值清晰可见的（上三角）形式。[@problem_id:2219204]", "problem": "基本QR算法是一种用于近似计算矩阵特征值的迭代方法。对于一个给定的方阵 $A_k$，该算法的一次迭代包含以下两个步骤：\n\n1.  求出矩阵的QR分解，即将其表示为乘积 $A_k = Q_k R_k$，其中 $Q_k$ 是一个正交矩阵，$R_k$ 是一个上三角矩阵。\n2.  通过反转乘法顺序计算序列中的下一个矩阵：$A_{k+1} = R_k Q_k$。\n\n考虑初始矩阵 $A_0 = \\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix}$。\n\n对 $A_0$ 应用完整一轮基本QR算法后，得到的矩阵 $A_1$ 是什么？\n\nA) $\\begin{pmatrix} 3 & 0 \\\\ 0 & 1 \\end{pmatrix}$\n\nB) $\\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$\n\nC) $\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$\n\nD) $\\begin{pmatrix} -1 & 0 \\\\ 0 & 3 \\end{pmatrix}$\n\nE) $\\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix}$", "solution": "我们对给定矩阵 $A_0 = \\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix}$ 应用一次基本QR算法的迭代。\n\n根据QR步骤的定义，我们首先计算一个QR分解 $A_0 = Q_0 R_0$，其中 $Q_0$ 是正交矩阵，$R_0$ 是上三角矩阵。一个标准的约定是选择对角线元素为正的 $R_0$，并将任何符号吸收到 $Q_0$ 中。由于 $A_0$ 是对角矩阵，其对角线元素为 $3$ 和 $-1$，我们可以选择\n$$\nQ_0 = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}, \\quad R_0 = Q_0^T A_0 = Q_0 A_0 = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix} = \\begin{pmatrix} 3 & 0 \\\\ 0 & 1 \\end{pmatrix},\n$$\n这满足了 $A_0 = Q_0 R_0$，并且 $R_0$ 的对角线元素为正。\n\nQR迭代的第二步定义了\n$$\nA_1 = R_0 Q_0 = \\begin{pmatrix} 3 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} = \\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix}.\n$$\n因此，$A_1 = A_0$，这对应于选项 E。", "answer": "$$\\boxed{E}$$", "id": "2219204"}, {"introduction": "基础QR算法的收敛速度并非总是很快，尤其是在处理特征值非常接近的矩阵时。本次实践将探讨一个具有挑战性的情况：一个接近“亏损”（不可对角化）的矩阵。通过分析一次迭代后次对角线元素的变化，我们可以定量地理解为何基础算法在这种情况下收敛缓慢，并体会到为何在实际应用中，如“位移QR算法”等改进策略至关重要。[@problem_id:2219199]", "problem": "无位移QR算法是计算矩阵特征值的一种基本方法。该算法从 $A_0 = A$ 开始，生成一个矩阵序列 $\\{A_k\\}$。每个步骤包括计算当前矩阵的QR分解 $A_k = Q_k R_k$，然后反向相乘因子以形成下一个矩阵 $A_{k+1} = R_k Q_k$。在这里，$Q_k$ 是一个正交矩阵，$R_k$ 是一个上三角矩阵。为使分解唯一，我们强制要求 $R_k$ 的对角线元素必须为正。\n\n已知对于具有幅值几乎相等的特征值的矩阵，该算法的收敛速度较慢。对于接近不可对角化（有缺陷的）矩阵，这种行为尤其明显。一个有缺陷矩阵的典型例子是Jordan块。\n\n考虑矩阵 $A$，它是一个Jordan块的微小扰动：\n$$\nA = \\begin{pmatrix} \\lambda & 1 \\\\ \\delta^2 & \\lambda \\end{pmatrix}\n$$\n其中 $\\lambda$ 是一个正实数，$\\delta$ 是一个实参数，满足 $0 < |\\delta| \\ll \\lambda$。当 $\\delta \\to 0$ 时，该矩阵趋近于一个在 $\\lambda$ 处具有二重特征值的有缺陷的Jordan块。\n\n令 $A_0 = A$。执行一次完整的无位移QR算法迭代，以获得矩阵 $A_1$。次对角线元素 $(A_1)_{2,1}$ 是该算法寻找特征值进展的关键指标。请确定该元素 $(A_1)_{2,1}$ 作为 $\\lambda$ 和 $\\delta$ 的函数的精确表达式。", "solution": "我们将 $A$ 按列写为 $A=[a_1\\; a_2]$，其中 $a_1=\\begin{pmatrix}\\lambda\\\\ \\delta^2\\end{pmatrix}$ 且 $a_2=\\begin{pmatrix}1\\\\ \\lambda\\end{pmatrix}$。通过 Gram–Schmidt 过程可获得 $R$ 中对角线元素为正的QR分解：\n1) 计算 $r_{11}=\\|a_1\\|_2=\\sqrt{\\lambda^2+\\delta^4}>0$ 和 $q_1=a_1/r_{11}=\\frac{1}{\\sqrt{\\lambda^2+\\delta^4}}\\begin{pmatrix}\\lambda\\\\ \\delta^2\\end{pmatrix}$。\n2) 计算 $r_{12}=q_1^\\top a_2=\\frac{1}{\\sqrt{\\lambda^2+\\delta^4}}\\left(\\lambda\\cdot 1+\\delta^2\\cdot \\lambda\\right)=\\frac{\\lambda(1+\\delta^2)}{\\sqrt{\\lambda^2+\\delta^4}}$。\n3) 构造 $u_2=a_2-r_{12}q_1$。使用 $r_{11}^2=\\lambda^2+\\delta^4$，\n$$\nu_2= \\begin{pmatrix}1\\\\ \\lambda\\end{pmatrix}-\\frac{\\lambda(1+\\delta^2)}{\\lambda^2+\\delta^4}\\begin{pmatrix}\\lambda\\\\ \\delta^2\\end{pmatrix}\n=\\frac{\\lambda^2-\\delta^2}{\\lambda^2+\\delta^4}\\begin{pmatrix}-\\delta^2\\\\ \\lambda\\end{pmatrix}.\n$$\n因此 $r_{22}=\\|u_2\\|_2=\\left|\\frac{\\lambda^2-\\delta^2}{\\lambda^2+\\delta^4}\\right|\\sqrt{\\lambda^2+\\delta^4}=\\frac{|\\lambda^2-\\delta^2|}{\\sqrt{\\lambda^2+\\delta^4}}>0$，且 $q_2=u_2/r_{22}$（其具体形式无需写出）。\n由于 $A=QR$ 且 $A_1=RQ$，次对角线元素为\n$$\n(A_1)_{2,1}=R_{21}Q_{11}+R_{22}Q_{21}=r_{22}Q_{21},\n$$\n因为 $R_{21}=0$。使用 $Q_{21}=\\delta^2/\\sqrt{\\lambda^2+\\delta^4}$ 和 $r_{22}$ 的表达式，\n$$\n(A_1)_{2,1}=\\frac{|\\lambda^2-\\delta^2|}{\\sqrt{\\lambda^2+\\delta^4}}\\cdot \\frac{\\delta^2}{\\sqrt{\\lambda^2+\\delta^4}}\n=\\frac{\\delta^2\\,|\\lambda^2-\\delta^2|}{\\lambda^2+\\delta^4}.\n$$\n在给定条件 $0<|\\delta|\\ll \\lambda$ 和 $\\lambda>0$ 下，我们有 $\\lambda^2-\\delta^2>0$，因此可以去掉绝对值，得到\n$$\n(A_1)_{2,1}=\\frac{\\delta^2\\left(\\lambda^2-\\delta^2\\right)}{\\lambda^2+\\delta^4}.\n$$", "answer": "$$\\boxed{\\frac{\\delta^{2}\\left(\\lambda^{2}-\\delta^{2}\\right)}{\\lambda^{2}+\\delta^{4}}}$$", "id": "2219199"}]}