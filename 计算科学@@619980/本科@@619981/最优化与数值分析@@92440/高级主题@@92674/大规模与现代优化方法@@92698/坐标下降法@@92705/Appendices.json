{"hands_on_practices": [{"introduction": "坐标下降法的核心在于其简单性：一次只沿着一个坐标轴方向进行优化。这个练习将带你完成坐标下降法最基本的一步，即固定其他所有变量，仅对单个变量求最小值。通过计算函数值的变化 [@problem_id:2164453]，你将亲手验证该方法的“下降”特性，为理解更复杂的迭代过程打下坚实的基础。", "problem": "一个优化算法正在二次目标函数 $f(x, y) = 3x^2 + 2y^2 - 2xy + x - 5y$ 上进行测试。所选择的算法是坐标下降法，该方法每次沿一个坐标方向迭代地最小化目标函数，同时保持其他坐标固定。\n\n考虑该算法从初始点 $(x_0, y_0) = (2, 3)$ 开始的单次迭代步骤。第一步是关于变量 $y$ 最小化该函数，而变量 $x$ 保持在其当前值 $x_0$ 不变。这次更新产生一个新点 $(x_1, y_1)$。\n\n确定新点 $(x_1, y_1)$ 的坐标，并计算由这单次迭代步骤引起的目标函数值的变化量 $\\Delta f = f(x_1, y_1) - f(x_0, y_0)$。请用精确分数表示你的答案。", "solution": "给定二次函数 $f(x,y)=3x^{2}+2y^{2}-2xy+x-5y$ 和初始点 $(x_{0},y_{0})=(2,3)$。在坐标下降法的一步中，我们相对于 $y$ 最小化 $f$，同时保持 $x$ 固定在 $x_{0}=2$。\n\n首先，将 $x=2$ 代入 $f$ 中，得到一个关于 $y$ 的一元二次函数：\n$$\nf(2,y)=3\\cdot (2)^{2}+2y^{2}-2\\cdot 2\\cdot y+2-5y\n=12+2y^{2}-4y+2-5y\n=2y^{2}-9y+14.\n$$\n为了最小化 $f(2,y)$，我们对其关于 $y$ 求导并令其等于零：\n$$\n\\frac{d}{dy}f(2,y)=4y-9=0 \\quad \\Longrightarrow \\quad y=\\frac{9}{4}.\n$$\n二阶导数为 $\\frac{d^{2}}{dy^{2}}f(2,y)=4>0$，这确认了存在唯一的极小值点。因此，更新后的点是\n$$\n(x_{1},y_{1})=\\left(2,\\frac{9}{4}\\right).\n$$\n接下来，计算目标值的变化量 $\\Delta f=f(x_{1},y_{1})-f(x_{0},y_{0})$。使用 $f(2,y)=2y^{2}-9y+14$，\n$$\nf\\!\\left(2,\\frac{9}{4}\\right)=2\\left(\\frac{9}{4}\\right)^{2}-9\\left(\\frac{9}{4}\\right)+14\n=\\frac{81}{8}-\\frac{81}{4}+14\n=\\frac{81}{8}-\\frac{162}{8}+\\frac{112}{8}\n=\\frac{31}{8}.\n$$\n计算 $f(2,3)$：\n$$\nf(2,3)=3\\cdot 4+2\\cdot 9-2\\cdot 2\\cdot 3+2-5\\cdot 3=12+18-12+2-15=5.\n$$\n因此，\n$$\n\\Delta f=f\\!\\left(2,\\frac{9}{4}\\right)-f(2,3)=\\frac{31}{8}-5=\\frac{31}{8}-\\frac{40}{8}=-\\frac{9}{8}.\n$$\n因此，$x_{1}=2$，$y_{1}=\\frac{9}{4}$，并且 $\\Delta f=-\\frac{9}{8}$。", "answer": "$$\\boxed{\\begin{pmatrix}2 & \\frac{9}{4} & -\\frac{9}{8}\\end{pmatrix}}$$", "id": "2164453"}, {"introduction": "在掌握了单步优化后，下一步自然是理解一个完整的坐标下降“周期”是如何运作的。本练习要求你从一个初始点出发，依次对每个坐标进行优化，完成一整轮迭代 [@problem_id:2164480]。这能帮助你形象地理解算法如何通过一系列轴向移动来逐步逼近多维函数的最优解。", "problem": "考虑二元函数 $f(x,y) = 2x^2 + y^2 + xy - 6x - 5y$。采用坐标下降算法的优化程序来寻找该函数的最小值。过程从初始点 $(x_0, y_0) = (0, 0)$ 开始。\n\n要求你执行恰好一轮完整的坐标下降。周期内的更新顺序如下：首先，关于 $x$ 坐标最小化函数，然后，使用新找到的 $x$ 坐标，关于 $y$ 坐标最小化函数。\n\n确定这一轮循环后点的坐标 $(x_1, y_1)$。你的答案应包含这两个坐标值，并以精确分数形式表示。", "solution": "我们对二次函数 $f(x,y) = 2x^{2} + y^{2} + xy - 6x - 5y$ 执行一轮完整的坐标下降，从 $(x_{0}, y_{0}) = (0, 0)$ 开始，先更新 $x$ 再更新 $y$。对于一个固定的坐标，最小化一个可微函数是将其对应的偏导数设为零来实现的；由于 $f$ 是二次函数且在每个坐标上都是严格凸的（这可通过二阶偏导数为正来验证），这将得到该坐标上的唯一最小化点。\n\n首先，固定 $y = y_{0} = 0$，对 $x$ 进行最小化。计算关于 $x$ 的偏导数：\n$$\n\\frac{\\partial f}{\\partial x} = 4x + y - 6.\n$$\n在 $y=0$ 处将其设为零：\n$$\n4x + 0 - 6 = 0 \\quad \\Longrightarrow \\quad 4x = 6 \\quad \\Longrightarrow \\quad x = \\frac{3}{2}.\n$$\n由于 $\\frac{\\partial^{2} f}{\\partial x^{2}} = 4 > 0$，这是在固定 $y=0$ 时 $x$ 的唯一最小化点。因此，在 $x$ 更新后，我们得到 $x_{1} = \\frac{3}{2}$，而 $y$ 保持为 $0$。\n\n接下来，固定 $x = x_{1} = \\frac{3}{2}$，对 $y$ 进行最小化。计算关于 $y$ 的偏导数：\n$$\n\\frac{\\partial f}{\\partial y} = 2y + x - 5.\n$$\n在 $x=\\frac{3}{2}$ 处将其设为零：\n$$\n2y + \\frac{3}{2} - 5 = 0 \\quad \\Longrightarrow \\quad 2y - \\frac{7}{2} = 0 \\quad \\Longrightarrow \\quad 2y = \\frac{7}{2} \\quad \\Longrightarrow \\quad y = \\frac{7}{4}.\n$$\n由于 $\\frac{\\partial^{2} f}{\\partial y^{2}} = 2 > 0$，这是在固定 $x=\\frac{3}{2}$ 时 $y$ 的唯一最小化点。因此，经过一轮完整的周期后，更新后的点是 $\\left(x_{1}, y_{1}\\right) = \\left(\\frac{3}{2}, \\frac{7}{4}\\right)$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{3}{2} & \\frac{7}{4}\\end{pmatrix}}$$", "id": "2164480"}, {"introduction": "为了更深刻地理解坐标下降法，将其与我们熟知的梯度下降法进行比较是一种非常有效的方法。在这个练习中，你将从同一起点出发，分别计算坐标下降一个周期和梯度下降一步后的新位置 [@problem_id:2164428]。通过对比两者产生的不同路径——一个是沿坐标轴的“之”字形移动，另一个是沿最陡峭方向的直线移动——你将对不同优化策略的几何直觉有更清晰的认识。", "problem": "考虑最小化函数 $f(x, y) = 2x^2 + y^2 - xy + x - 4y$ 的优化问题。我们将探讨两种不同的迭代优化算法的第一步，两种算法均从初始点 $(x_0, y_0) = (2, 3)$ 开始。\n\n1.  **坐标下降法 (CD):** 执行一轮完整的坐标下降，从更新 $x$ 坐标开始。这包括两个连续的步骤。首先，将 $y$ 固定为其初始值 $y_0 = 3$，找到最小化该函数的 $x$ 值；令其为更新后的 $x$ 坐标。其次，使用这个新的 $x$ 坐标，找到最小化该函数的 $y$ 值。设此轮迭代后得到的点为 $(x_{CD}, y_{CD})$。\n\n2.  **梯度下降法 (GD):** 使用固定的学习率 $\\alpha = 0.1$ 执行一步梯度下降。点 $\\mathbf{x}_k$ 的更新规则为 $\\mathbf{x}_{k+1} = \\mathbf{x}_k - \\alpha \\nabla f(\\mathbf{x}_k)$。设得到的点为 $(x_{GD}, y_{GD})$。\n\n确定这两个点的坐标。将您的答案表示为一个单行矩阵，其中包含按 $x_{CD}, y_{CD}, x_{GD}, y_{GD}$ 顺序排列的四个值。这些值应以精确的整数或分数形式给出。", "solution": "我们最小化二次函数 $f(x,y)=2x^{2}+y^{2}-xy+x-4y$。\n\n对于坐标下降法，我们从 $(x_{0},y_{0})=(2,3)$ 开始，首先在 $y$ 固定为 $y_{0}=3$ 的情况下对 $x$ 进行最小化。单变量函数为\n$$\nf(x,3)=2x^{2}+3^{2}-x\\cdot 3+x-4\\cdot 3=2x^{2}-2x-3.\n$$\n对 $x$ 求导并令其等于零：\n$$\n\\frac{\\partial}{\\partial x}f(x,3)=4x-2=0 \\quad\\Longrightarrow\\quad x=\\frac{1}{2},\n$$\n并且由于 $\\frac{\\partial^{2}}{\\partial x^{2}}f(x,3)=4>0$，该点是极小值点。接下来，在 $x=\\frac{1}{2}$ 固定的情况下，对 $y$ 进行最小化：\n$$\nf\\!\\left(\\frac{1}{2},y\\right)=2\\left(\\frac{1}{2}\\right)^{2}+y^{2}-\\frac{1}{2}y+\\frac{1}{2}-4y=y^{2}-\\frac{9}{2}y+1.\n$$\n对 $y$ 求导并令其等于零：\n$$\n\\frac{\\partial}{\\partial y}f\\!\\left(\\frac{1}{2},y\\right)=2y-\\frac{9}{2}=0 \\quad\\Longrightarrow\\quad y=\\frac{9}{4},\n$$\n由 $\\frac{\\partial^{2}}{\\partial y^{2}}f=2>0$ 可确认该点是一个极小值点。因此 $(x_{CD},y_{CD})=\\left(\\frac{1}{2},\\frac{9}{4}\\right)$。\n\n对于学习率为 $\\alpha=\\frac{1}{10}$ 的一步梯度下降，我们使用更新规则 $\\mathbf{x}_{k+1}=\\mathbf{x}_{k}-\\alpha\\nabla f(\\mathbf{x}_{k})$。梯度为\n$$\n\\nabla f(x,y)=\\bigl(4x-y+1,\\;2y-x-4\\bigr).\n$$\n在点 $(2,3)$ 处，\n$$\n\\nabla f(2,3)=\\bigl(4\\cdot 2-3+1,\\;2\\cdot 3-2-4\\bigr)=(6,0).\n$$\n因此\n$$\n(x_{GD},y_{GD})=(2,3)-\\frac{1}{10}(6,0)=\\left(2-\\frac{6}{10},\\,3\\right)=\\left(\\frac{7}{5},\\,3\\right).\n$$\n\n因此，所求的按 $x_{CD}, y_{CD}, x_{GD}, y_{GD}$ 顺序排列的行矩阵为 $\\begin{pmatrix}\\frac{1}{2} & \\frac{9}{4} & \\frac{7}{5} & 3\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2} & \\frac{9}{4} & \\frac{7}{5} & 3\\end{pmatrix}}$$", "id": "2164428"}]}