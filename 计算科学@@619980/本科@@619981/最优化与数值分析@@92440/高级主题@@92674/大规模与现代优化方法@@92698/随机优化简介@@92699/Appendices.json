{"hands_on_practices": [{"introduction": "在现实世界中，诸如路线规划之类的决策常常充满不确定性。本练习将引导你运用样本平均近似（SAA）方法，在一个模拟的城市交通网络中找出最快的路径。通过计算多组交通情景下的平均旅行时间，我们将一个随机优化问题转化为一个确定性的最短路径问题，这是处理不确定性时一种基础而强大的策略。[@problem_id:2182114]", "problem": "一家物流公司正在使用模拟来优化一个拥堵的小型城市区域的配送路线。该区域的道路网络可以建模为一组由四个交叉口（标记为1、2、3和4）以及连接它们的五条双向路段所组成的集合。这些路段是 (1,2)、(1,3)、(2,3)、(2,4) 和 (3,4)。\n\n为了考虑交通的可变性，该公司运行了五次模拟，每次模拟代表一种不同的可能交通情景。下表给出了在每种情景下，通过各路段所需的行程时间（单位：分钟）。\n\n| 路段    | 情景 1 | 情景 2 | 情景 3 | 情景 4 | 情景 5 |\n|--------------|------------|------------|------------|------------|------------|\n| (1,2)        | 15         | 25         | 18         | 22         | 20         |\n| (1,3)        | 30         | 12         | 15         | 18         | 25         |\n| (2,3)        | 10         | 8          | 12         | 15         | 5          |\n| (2,4)        | 35         | 40         | 28         | 30         | 32         |\n| (3,4)        | 20         | 25         | 35         | 30         | 20         |\n\n您的任务是找到从交叉口1到交叉口4的最佳路线。您需要使用样本均值近似（SAA）方法。在SAA方法中，每个路段的真实（但未知）期望行程时间由其样本均值来近似，该样本均值是根据模拟数据计算得出的。于是，问题就变成了找到总近似行程时间最短的路径。\n\n基于此SAA模型，从交叉口1到交叉口4的行程的估计最小平均行程时间是多少？请用分钟作答，并四舍五入到三位有效数字。", "solution": "我们应用样本均值近似（SAA）方法：对于每个路段 $e$，我们用5种情景下的样本均值来近似其期望行程时间，\n$$\n\\hat{t}_{e}=\\frac{1}{5}\\sum_{s=1}^{5}t_{e}^{(s)}.\n$$\n计算所有路段的样本均值：\n- 对于 $(1,2)$:\n$$\n\\hat{t}_{12}=\\frac{1}{5}(15+25+18+22+20)=\\frac{100}{5}=20.\n$$\n- 对于 $(1,3)$:\n$$\n\\hat{t}_{13}=\\frac{1}{5}(30+12+15+18+25)=\\frac{100}{5}=20.\n$$\n- 对于 $(2,3)$:\n$$\n\\hat{t}_{23}=\\frac{1}{5}(10+8+12+15+5)=\\frac{50}{5}=10.\n$$\n- 对于 $(2,4)$:\n$$\n\\hat{t}_{24}=\\frac{1}{5}(35+40+28+30+32)=\\frac{165}{5}=33.\n$$\n- 对于 $(3,4)$:\n$$\n\\hat{t}_{34}=\\frac{1}{5}(20+25+35+30+20)=\\frac{130}{5}=26.\n$$\n\n利用这些边权重，计算从1到4的简单路径的总时间：\n- 路径 $1\\to 2\\to 4$: $20+33=53$。\n- 路径 $1\\to 3\\to 4$: $20+26=46$。\n- 路径 $1\\to 2\\to 3\\to 4$: $20+10+26=56$。\n- 路径 $1\\to 3\\to 2\\to 4$: $20+10+33=63$。\n\n最小总时间为 $46$，通过路径 $1\\to 3\\to 4$。四舍五入到三位有效数字得到 $46.0$。", "answer": "$$\\boxed{46.0}$$", "id": "2182114"}, {"introduction": "当面临不确定的收益时，企业如何制定最佳的生产计划？此练习模拟了一个农场主的决策过程，你需要利用样本平均近似（SAA）来处理作物利润的随机性。更重要的是，通过将基于有限样本的决策与基于真实概率分布的理论最优决策进行比较，你将亲身体会到近似方法在实践中的价值与潜在偏差。[@problem_id:2182086]", "problem": "一位农场经理必须决定在即将到来的季节里种植多少英亩的玉米 ($x_1$) 和小麦 ($x_2$)。该经理总共有 100 英亩的可用土地。种植需要一种专门的肥料，总共有 240 个单位可用。每英亩玉米需要 4 个单位的肥料，而每英亩小麦需要 2 个单位。\n\n每英亩作物的利润是不确定的，取决于季节性降雨量，降雨量可以是“低”、“中”或“高”。下表给出了每种情景的概率以及相应的每英亩利润（以美元为单位）：\n\n| 降雨情景 | 概率 | 玉米利润 ($c_1$) | 小麦利润 ($c_2$) |\n|:---:|:---:|:---:|:---:|\n| 低 | 0.2 | 100 | 180 |\n| 中 | 0.5 | 200 | 150 |\n| 高 | 0.3 | 250 | 100 |\n\n经理希望确定能够最大化预期总利润的种植策略 $(x_1, x_2)$。这就是“真实”的随机问题。\n\n作为比较，另一种方法是使用有限的样本集来解决一个近似问题。这种方法被称为样本平均近似法（Sample Average Approximation, SAA）。经理可以获得一个预报，该预报提供了本季节 10 个预测降雨结果的特定序列：\n['低', '低', '中', '低', '中', '高', '低', '中', '低', '中']\n\n计算解决真实随机问题的最优种植策略 $(x_{1,\\text{true}}, x_{2,\\text{true}})$，以及解决 SAA 问题的最优策略 $(x_{1,\\text{SAA}}, x_{2,\\text{SAA}})$。您的最终答案应为一组代表 $(x_{1,\\text{true}}, x_{2,\\text{true}}, x_{1,\\text{SAA}}, x_{2,\\text{SAA}})$ 的四个数值，每个数值都以英亩为单位。", "solution": "设 $x_{1}$ 和 $x_{2}$ 分别表示玉米和小麦的种植面积（单位：英亩）。约束条件为：\n$$\nx_{1}+x_{2}\\leq 100,\\quad 4x_{1}+2x_{2}\\leq 240,\\quad x_{1}\\geq 0,\\ x_{2}\\geq 0.\n$$\n真实的随机问题目标是最大化预期利润。设 $c_{1}$ 和 $c_{2}$ 为玉米和小麦的每英亩利润。对于情景{低、中、高}及其相应概率{0.2、0.5、0.3}，预期的每英亩利润为\n$$\n\\mathbb{E}[c_{1}]=0.2\\cdot 100+0.5\\cdot 200+0.3\\cdot 250=195,\\quad\n\\mathbb{E}[c_{2}]=0.2\\cdot 180+0.5\\cdot 150+0.3\\cdot 100=141.\n$$\n因此，真实问题是\n$$\n\\max\\ 195\\,x_{1}+141\\,x_{2}\\quad\\text{s.t.}\\quad x_{1}+x_{2}\\leq 100,\\ 4x_{1}+2x_{2}\\leq 240,\\ x_{1},x_{2}\\geq 0.\n$$\n枚举可行域的顶点。约束 $x_{1}+x_{2}=100$ 和 $2x_{1}+x_{2}=120$（后者等价于 $4x_{1}+2x_{2}=240$）相交于 $x_{1}=20, x_{2}=80$。顶点集为 $(0,0)$, $(60,0)$, $(0,100)$ 和 $(20,80)$。目标函数值为：\n$$\n(60,0):\\ 195\\cdot 60=11700,\\quad (0,100):\\ 141\\cdot 100=14100,\\quad (20,80):\\ 195\\cdot 20+141\\cdot 80=15180.\n$$\n最大化解为 $(x_{1,\\text{true}},x_{2,\\text{true}})=(20,80)$。\n\n对于样本平均近似法（SAA），将期望值替换为给定10个结果的样本平均值。经验频率为{低:5/10, 中:4/10, 高:1/10}。样本平均的每英亩利润为\n$$\n\\bar{c}_{1}=\\frac{1}{10}\\left(5\\cdot 100+4\\cdot 200+1\\cdot 250\\right)=155,\\quad\n\\bar{c}_{2}=\\frac{1}{10}\\left(5\\cdot 180+4\\cdot 150+1\\cdot 100\\right)=160.\n$$\nSAA 问题为\n$$\n\\max\\ 155\\,x_{1}+160\\,x_{2}\\quad\\text{s.t.}\\quad x_{1}+x_{2}\\leq 100,\\ 4x_{1}+2x_{2}\\leq 240,\\ x_{1},x_{2}\\geq 0.\n$$\n在相同的顶点上求值：\n$$\n(60,0):\\ 155\\cdot 60=9300,\\quad (0,100):\\ 160\\cdot 100=16000,\\quad (20,80):\\ 155\\cdot 20+160\\cdot 80=15900.\n$$\n最大化解为 $(x_{1,\\text{SAA}},x_{2,\\text{SAA}})=(0,100)$。\n\n因此，所求的四元组是 $(20,80,0,100)$，单位为英亩。", "answer": "$$\\boxed{\\begin{pmatrix} 20 & 80 & 0 & 100 \\end{pmatrix}}$$", "id": "2182086"}, {"introduction": "在做出关键决策之前，我们愿意为获取更多信息付出多大代价？这个问题挑战你从一个更高的战略层面思考不确定性，你需要决定在进行生产前，投入多少资源用于市场调研以提高需求预测的准确性。这个两阶段随机规划练习将让你深入理解“信息价值”的概念，并学会如何在当前决策与未来不确定性之间寻求最佳平衡。[@problem_id:2182118]", "problem": "一家科技初创公司正准备推出其全新的、高度专业化的处理芯片。该公司面临着这款芯片市场需求的巨大不确定性。根据初步分析，管理团队认为在第一个生产周期存在两种可能性相同的需求情景：“低需求”情景为 $d_L = 5000$ 单位，“高需求”情景为 $d_H = 10000$ 单位。每种情景的先验概率均为 0.5。\n\n生产过程分为两个阶段。在第一阶段，实际市场需求未知之前，公司必须决定一个初始生产数量 $x$。在此阶段，每块芯片的生产成本为 $c = \\$80$。产品发布后，真实需求 $D$ 便会揭晓。如果初始产量 $x$ 小于需求 $D$，公司必须通过更昂贵的加急生产流程来满足短缺部分，其单位成本为 $c_e = \\$210$。如果初始产量 $x$ 超过需求 $D$，超出的部分必须被储存并最终折价处理，产生每单位 $h = \\$20$ 的有效持有成本。\n\n为降低风险，公司可以选择在投入初始生产前委托进行一项市场研究。该研究提供一个简单的预测： “乐观” ($S_O$) 或 “悲观” ($S_P$) 。研究的质量由一个准确度参数 $\\alpha$ 决定，公司可以在 $[0.5, 1]$ 范围内选择其值。准确度由条件概率 $P(S_O | D=d_H) = \\alpha$ 和 $P(S_P | D=d_L) = \\alpha$ 定义。根据对称性，这意味着 $P(S_O | D=d_L) = 1-\\alpha$ 和 $P(S_P | D=d_H) = 1-\\alpha$。准确度 $\\alpha=0.5$ 代表一个无用的预测（相当于抛硬币），而 $\\alpha=1$ 代表一个完美的预测。委托一项准确度为 $\\alpha$ 的研究所需的成本由函数 $C(\\alpha) = K(\\alpha - 0.5)^2$ 给出，其中成本系数 $K = \\$2,000,000$。\n\n公司的目标是选择预测准确度水平 $\\alpha$ 和相应的后续生产数量，以最小化总期望成本，该成本包括市场研究成本、第一阶段生产成本以及第二阶段的期望成本（用于弥补短缺或处理过剩库存）。\n\n确定公司应选择的最优市场研究准确度 $\\alpha^*$。将最终答案四舍五入至四位有效数字。", "solution": "设 $D \\in \\{d_{L}, d_{H}\\}$，其先验概率为 $\\mathbb{P}(D=d_{L})=\\mathbb{P}(D=d_{H})=\\frac{1}{2}$。如果公司在观察到需求 $D$ 之前生产 $x$ 单位，则实现的成本为\n$$\nC(x,D)=c\\,x+c_{e}(D-x)^{+}+h(x-D)^{+}.\n$$\n给定 $D$ 的一个预测分布，最优的基础库存 $x^{*}$ 满足报童模型的一阶条件（对于连续分布）或其离散形式。使用期望成本的导数，\n$$\n\\frac{d}{dx}\\mathbb{E}[C(x,D)]=c-c_{e}\\mathbb{P}(D>x)+h\\,\\mathbb{P}(D<x),\n$$\n连续情况下的临界分位数为\n$$\nF(x^{*})=\\frac{c_{e}-c}{c_{e}+h}.\n$$\n对于在 $d_{L}<d_{H}$ 处的两点支撑以及后验概率 $\\mathbb{P}(D=d_{L})=p_{L}$，在 $x\\in(d_{L},d_{H})$ 上，该导数等于 $c-c_{e}(1-p_{L})+h\\,p_{L}=c-c_{e}+(c_{e}+h)p_{L}$。因此，离散最优策略为\n- 如果 $p_{L}<\\frac{c_{e}-c}{c_{e}+h}$，选择 $x^{*}=d_{H}$，\n- 如果 $p_{L}>\\frac{c_{e}-c}{c_{e}+h}$，选择 $x^{*}=d_{L}$，\n- 如果等式成立，则可选择任意 $x\\in[d_{L},d_{H}]$。\n\n该研究产生信号 $S\\in\\{S_{O},S_{P}\\}$，其中 $P(S_{O}\\mid d_{H})=\\alpha$，$P(S_{O}\\mid d_{L})=1-\\alpha$，并且先验对称性意味着 $P(S_{O})=P(S_{P})=\\frac{1}{2}$。根据 Bayes’ 法则，\n$$\n\\mathbb{P}(d_{H}\\mid S_{O})=\\alpha,\\quad \\mathbb{P}(d_{L}\\mid S_{O})=1-\\alpha,\\qquad\n\\mathbb{P}(d_{H}\\mid S_{P})=1-\\alpha,\\quad \\mathbb{P}(d_{L}\\mid S_{P})=\\alpha.\n$$\n令 $\\Delta d:=d_{H}-d_{L}$。定义后验阈值为\n$$\np_{L}^{*}=\\frac{c_{e}-c}{c_{e}+h}.\n$$\n那么，依赖于信号的最优第一阶段决策如下：\n- 收到信号 $S_{O}$ 后：对于所有 $\\alpha\\in[0.5,1]$，都有 $p_{L}=1-\\alpha<p_{L}^{*}$，因此 $x_{O}^{*}=d_{H}$；\n- 收到信号 $S_{P}$ 后：$p_{L}=\\alpha$，因此如果 $\\alpha\\ge p_{L}^{*}$，则 $x_{P}^{*}=d_{L}$；如果 $\\alpha<p_{L}^{*}$，则 $x_{P}^{*}=d_{H}$。\n\n因此，存在两种情况：\n1) 如果 $\\alpha\\in[0.5,p_{L}^{*})$，两个信号都导向决策 $x^{*}=d_{H}$。期望运营成本（不包括研究费用）为\n$$\n\\mathbb{E}[\\text{ops}]=c\\,d_{H}+\\frac{1}{2}h\\,\\Delta d.\n$$\n总期望成本为\n$$\nJ_{1}(\\alpha)=K(\\alpha-0.5)^{2}+c\\,d_{H}+\\frac{1}{2}h\\,\\Delta d,\n$$\n在该区间上，当 $\\alpha=0.5$ 时成本最小。\n\n2) 如果 $\\alpha\\in[p_{L}^{*},1]$，最优行动为 $x_{O}^{*}=d_{H}$ 和 $x_{P}^{*}=d_{L}$。条件期望运营成本分别为\n$$\nC_{O}(\\alpha)=c\\,d_{H}+(1-\\alpha)h\\,\\Delta d,\\qquad C_{P}(\\alpha)=c\\,d_{L}+(1-\\alpha)c_{e}\\,\\Delta d,\n$$\n并且因为 $P(S_{O})=P(S_{P})=\\frac{1}{2}$，无条件期望运营成本是\n$$\n\\mathbb{E}[\\text{ops}]=\\frac{1}{2}\\big(C_{O}(\\alpha)+C_{P}(\\alpha)\\big)\n=\\frac{1}{2}c(d_{H}+d_{L})+\\frac{1}{2}(1-\\alpha)(h+c_{e})\\Delta d.\n$$\n总期望成本为\n$$\nJ_{2}(\\alpha)=K(\\alpha-0.5)^{2}+\\frac{1}{2}c(d_{H}+d_{L})+\\frac{1}{2}(1-\\alpha)(h+c_{e})\\Delta d.\n$$\n对 $J_{2}$ 求导并令其等于零：\n$$\n\\frac{dJ_{2}}{d\\alpha}=2K(\\alpha-0.5)-\\frac{1}{2}(h+c_{e})\\Delta d=0\n\\quad\\Rightarrow\\quad\n\\alpha_{\\text{int}}=0.5+\\frac{(h+c_{e})\\Delta d}{4K}.\n$$\n可行性要求 $\\alpha_{\\text{int}}\\in[p_{L}^{*},1]$，其中 $p_{L}^{*}=\\frac{c_{e}-c}{c_{e}+h}$。\n\n现在代入给定值 $c=80$, $c_{e}=210$, $h=20$, $d_{L}=5000$, $d_{H}=10000$, $K=2{,}000{,}000$，于是 $\\Delta d=5000$ 且\n$$\np_{L}^{*}=\\frac{c_{e}-c}{c_{e}+h}=\\frac{210-80}{210+20}=\\frac{130}{230}=\\frac{13}{23}\\approx 0.565217,\n$$\n$$\n\\alpha_{\\text{int}}=0.5+\\frac{(20+210)\\cdot 5000}{4\\cdot 2{,}000{,}000}\n=0.5+\\frac{230\\cdot 5000}{8{,}000{,}000}\n=0.5+\\frac{1{,}150{,}000}{8{,}000{,}000}\n=0.5+\\frac{23}{160}\n=\\frac{103}{160}=0.64375.\n$$\n由于 $\\alpha_{\\text{int}}\\approx 0.64375\\in[p_{L}^{*},1]$，全局最小值点为 $\\alpha^{*}=\\alpha_{\\text{int}}$。四舍五入到四位有效数字，得到 $0.6438$。", "answer": "$$\\boxed{0.6438}$$", "id": "2182118"}]}