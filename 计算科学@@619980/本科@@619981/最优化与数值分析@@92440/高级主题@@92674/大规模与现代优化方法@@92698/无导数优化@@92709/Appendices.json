{"hands_on_practices": [{"introduction": "Nelder-Mead 算法是一种经典的直接搜索方法，它通过在多维空间中移动一个单纯形（例如二维空间中的三角形）来寻找函数最小值。此练习将带你实践该算法最核心的步骤之一：反射操作 [@problem_id:2166464]。通过计算反射点，你将亲身体会算法如何根据函数值迭代地调整搜索区域，从而直观地理解其规避局部最差解并向更优区域探索的几何原理。", "problem": "Nelder-Mead 算法是一种流行的无导数优化方法，用于在多维空间中寻找函数的最小值。该算法在一个单纯形上运行，单纯形是一个在 $n$ 维空间中由 $n+1$ 个顶点组成的几何图形（例如，二维空间中的三角形）。\n\n考虑使用 Nelder-Mead 算法对一个双变量代价函数 $f(x, y)$ 进行最小化。在某次迭代中，单纯形由三个顶点定义：$v_A = (1, 2)$，$v_B = (5, 4)$ 和 $v_C = (3, 6)$。这些顶点上对应的代价函数值为 $f(v_A) = 10$，$f(v_B) = 25$ 和 $f(v_C) = 15$。\n\nNelder-Mead 迭代的第一步是确定最佳（函数值最低）、次差和最差（函数值最高）的顶点。然后，通过将最差顶点相对于其余顶点的质心进行“反射”，生成一个新的测试点。\n\n质心 $v_c$ 的计算方法是除最差顶点外所有顶点位置的平均值。然后使用公式 $v_r = v_c + \\alpha(v_c - v_{w})$ 计算反射点 $v_r$，其中 $v_{w}$ 是最差顶点，$\\alpha$ 是反射系数。对于本问题，使用标准反射系数 $\\alpha = 1$。\n\n计算反射点 $v_r$ 的坐标。将答案表示为包含两个坐标的行矩阵。", "solution": "我们正在使用 Nelder-Mead 算法对一个双变量函数进行最小化。在本次迭代中，单纯形的顶点为 $v_{A}=(1,2)$，$v_{B}=(5,4)$ 和 $v_{C}=(3,6)$，对应的函数值为 $f(v_{A})=10$，$f(v_{B})=25$ 和 $f(v_{C})=15$。根据定义，最佳顶点的函数值最低，最差顶点的函数值最高，次差顶点是剩余的一个。因此，最佳顶点是 $v_{A}$，次差顶点是 $v_{C}$，最差顶点是 $v_{B}$，因为 $25$ 是最大值。\n\n质心 $v_{c}$ 是通过对除最差顶点外的所有顶点求平均来计算的。利用剩下的两个顶点 $v_{A}$ 和 $v_{C}$，质心为\n$$\nv_{c}=\\frac{1}{2}\\left(v_{A}+v_{C}\\right)=\\frac{1}{2}\\left((1,2)+(3,6)\\right)=\\frac{1}{2}(4,8)=(2,4).\n$$\n\n反射点的定义为\n$$\nv_{r}=v_{c}+\\alpha\\left(v_{c}-v_{w}\\right),\n$$\n其中 $v_{w}$ 是最差顶点，$\\alpha$ 是反射系数。当 $\\alpha=1$ 且 $v_{w}=v_{B}=(5,4)$ 时，该式变为\n$$\nv_{r}=v_{c}+\\left(v_{c}-v_{w}\\right)=2v_{c}-v_{w}.\n$$\n代入 $v_{c}=(2,4)$ 和 $v_{w}=(5,4)$，\n$$\nv_{r}=2(2,4)-(5,4)=(4,8)-(5,4)=(-1,4).\n$$\n\n因此，表示为行矩阵的反射点是 $\\begin{pmatrix}-1 & 4\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix}-1 & 4\\end{pmatrix}}$$", "id": "2166464"}, {"introduction": "粒子群优化 (PSO) 是一种受鸟群觅食等群体行为启发的元启发式算法，它利用“粒子”群体的协作来寻找最优解。此练习的核心是 PSO 算法的“心脏”——速度更新方程 [@problem_id:2166499]。通过计算单个粒子（无人机）的新速度向量，你将学会如何量化惯性、个体认知 ($c_1$) 和社会学习 ($c_2$) 这三个关键因素，并理解它们如何共同引导粒子飞向搜索空间中更有希望的区域。", "problem": "一架自主无人机是一个蜂群的一部分，该蜂群在一个广阔的开放场地中搜索最大强度无线电信号的位置，该场地被建模为一个二维笛卡尔平面。搜索过程由粒子群优化（PSO）算法引导。在每个时间步，每架无人机根据其当前速度、自身找到的最佳位置以及整个蜂群中任何无人机找到的最佳位置来更新其速度。\n\n单个粒子（无人机）在时间步 $t+1$ 的速度更新由以下方程给出：\n$$ \\vec{v}(t+1) = \\omega \\vec{v}(t) + c_1 r_1 (\\vec{p} - \\vec{x}(t)) + c_2 r_2 (\\vec{g} - \\vec{x}(t)) $$\n其中：\n- $\\vec{v}(t)$ 是无人机当前的速​​度向量。\n- $\\vec{x}(t)$ 是无人机当前的位置向量。\n- $\\vec{p}$ 是无人机迄今为止找到的个体最佳位置。\n- $\\vec{g}$ 是整个蜂群迄今为止找到的全局最佳位置。\n- $\\omega$ 是惯性权重，控制先前速度的影响。\n- $c_1$ 和 $c_2$ 分别是认知系数和社会系数，它们衡量个体最佳位置和全局最佳位置的影响。\n- $r_1$ 和 $r_2$ 是在 $[0, 1]$ 上均匀分布的随机数。\n\n考虑在特定时间步 $t$ 的一架特定无人机。该无人机的状态和蜂群参数如下所示：\n- 当前位置：$\\vec{x}(t) = \\begin{pmatrix} 8.0 & 14.0 \\end{pmatrix}$\n- 当前速度：$\\vec{v}(t) = \\begin{pmatrix} -1.0 & 2.0 \\end{pmatrix}$\n- 个体最佳位置：$\\vec{p} = \\begin{pmatrix} 10.0 & 12.0 \\end{pmatrix}$\n- 全局最佳位置：$\\vec{g} = \\begin{pmatrix} 11.0 & 10.0 \\end{pmatrix}$\n- 惯性权重：$\\omega = 0.7$\n- 认知系数：$c_1 = 1.5$\n- 社会系数：$c_2 = 1.5$\n对于这个特定的更新步骤，生成的随机数为 $r_1 = 0.4$ 和 $r_2 = 0.9$。\n\n计算无人机的新速度向量 $\\vec{v}(t+1)$。所有位置以米为单位，速度以米每秒（m/s）为单位。将您的答案表示为一个双元素行矩阵 $[v_x, v_y]$，单位为 m/s。将向量的每个分量四舍五入到三位有效数字。", "solution": "我们应用PSO速度更新规则\n$$\\vec{v}(t+1)=\\omega \\vec{v}(t)+c_{1}r_{1}\\left(\\vec{p}-\\vec{x}(t)\\right)+c_{2}r_{2}\\left(\\vec{g}-\\vec{x}(t)\\right)。$$\n计算位移向量：\n$$\\vec{p}-\\vec{x}(t)=\\begin{pmatrix}10.0-8.0 \\\\ 12.0-14.0\\end{pmatrix}=\\begin{pmatrix}2 \\\\ -2\\end{pmatrix},\\quad \\vec{g}-\\vec{x}(t)=\\begin{pmatrix}11.0-8.0 \\\\ 10.0-14.0\\end{pmatrix}=\\begin{pmatrix}3 \\\\ -4\\end{pmatrix}。$$\n计算每一项：\n$$\\omega \\vec{v}(t)=0.7\\begin{pmatrix}-1.0 \\\\ 2.0\\end{pmatrix}=\\begin{pmatrix}-0.7 \\\\ 1.4\\end{pmatrix},$$\n$$c_{1}r_{1}\\left(\\vec{p}-\\vec{x}(t)\\right)=1.5\\cdot 0.4\\begin{pmatrix}2 \\\\ -2\\end{pmatrix}=0.6\\begin{pmatrix}2 \\\\ -2\\end{pmatrix}=\\begin{pmatrix}1.2 \\\\ -1.2\\end{pmatrix},$$\n$$c_{2}r_{2}\\left(\\vec{g}-\\vec{x}(t)\\right)=1.5\\cdot 0.9\\begin{pmatrix}3 \\\\ -4\\end{pmatrix}=1.35\\begin{pmatrix}3 \\\\ -4\\end{pmatrix}=\\begin{pmatrix}4.05 \\\\ -5.4\\end{pmatrix}。$$\n将各项贡献相加得到\n$$\\vec{v}(t+1)=\\begin{pmatrix}-0.7 \\\\ 1.4\\end{pmatrix}+\\begin{pmatrix}1.2 \\\\ -1.2\\end{pmatrix}+\\begin{pmatrix}4.05 \\\\ -5.4\\end{pmatrix}=\\begin{pmatrix}4.55 \\\\ -5.2\\end{pmatrix}。$$\n将每个分量四舍五入到三位有效数字，得到\n$$\\vec{v}(t+1)=\\begin{pmatrix}4.55 \\\\ -5.20\\end{pmatrix}。$$\n表示为行矩阵，结果为 $\\begin{pmatrix}4.55 & -5.20\\end{pmatrix}$，单位为米每秒。", "answer": "$$\\boxed{\\begin{pmatrix}4.55 & -5.20\\end{pmatrix}}$$", "id": "2166499"}, {"introduction": "信赖域方法是现代优化算法中的一类强大工具，它通过在局部构建一个简化的代理模型（如二次模型）来指导搜索方向。解决在“信赖域”约束下的模型优化子问题，是该方法的核心步骤 [@problem_id:2166495]。本练习要求你求解这样一个二次模型在圆形信赖域内的最小值，这不仅能锻炼你在约束优化问题上的分析能力，更能让你深入理解信赖域算法如何在保证模型精度的前提下，稳健地计算出下一步的迭代步长。", "problem": "在数值优化领域，一个常见的子问题是在一个“信赖域”内最小化目标函数的局部二次模型，在该信赖域中，该模型被认为是目标函数的一个良好近似。考虑一个关于两个变量的此类二次模型，它由一个步长向量 $s = [s_1, s_2]^T$ 表示。该模型由下式给出：\n$$m(s_1, s_2) = 10 - 2s_1 + 4s_2 + 3s_1^2 + 2s_1s_2 + \\frac{3}{2}s_2^2$$\n你的任务是求出最优步长向量 $s^* = [s_1^*, s_2^*]^T$，它在步长位于半径为 $\\Delta = 2$ 的圆形信赖域内的约束下，最小化此模型 $m(s_1, s_2)$。该区域由不等式 $\\sqrt{s_1^2 + s_2^2} \\le 2$ 定义。\n\n将最优步长向量 $s^*$ 的分量表示为精确的解析表达式。", "solution": "我们在信赖域约束下最小化这个二次模型。该模型为\n$$\nm(s_{1},s_{2})=10-2s_{1}+4s_{2}+3s_{1}^{2}+2s_{1}s_{2}+\\frac{3}{2}s_{2}^{2}.\n$$\n它的梯度和Hessian矩阵分别为\n$$\n\\nabla m(s)=\\begin{pmatrix}-2+6s_{1}+2s_{2} \\\\ 4+2s_{1}+3s_{2}\\end{pmatrix},\\qquad H=\\begin{pmatrix}6  2 \\\\ 2  3\\end{pmatrix},\\qquad g=\\begin{pmatrix}-2 \\\\ 4\\end{pmatrix}.\n$$\n无约束极小值点通过求解 $g+Hs=0$ 得到，即\n$$\n\\begin{cases}\n6s_{1}+2s_{2}=2,\\\\\n2s_{1}+3s_{2}=-4,\n\\end{cases}\n\\quad\\Rightarrow\\quad s_{\\text{unc}}=\\begin{pmatrix}1 \\\\ -2\\end{pmatrix},\\quad \\|s_{\\text{unc}}\\|=\\sqrt{1+4}=\\sqrt{5}2,\n$$\n因此它位于信赖域之外。所以，约束极小值点位于边界 $\\|s\\|=2$ 上，并满足信赖域KKT条件：存在 $\\lambda\\ge 0$ 使得\n$$\n(H+\\lambda I)s=-g,\\qquad \\|s\\|=2.\n$$\n令 $A(\\lambda)=H+\\lambda I=\\begin{pmatrix}6+\\lambda  2 \\\\ 2  3+\\lambda\\end{pmatrix}$。其行列式为\n$$\n\\det A(\\lambda)=(6+\\lambda)(3+\\lambda)-4=\\lambda^{2}+9\\lambda+14=(\\lambda+7)(\\lambda+2),\n$$\n其逆矩阵为\n$$\nA(\\lambda)^{-1}=\\frac{1}{(\\lambda+7)(\\lambda+2)}\\begin{pmatrix}3+\\lambda  -2 \\\\ -2  6+\\lambda\\end{pmatrix}.\n$$\n那么\n$$\ns(\\lambda)=-A(\\lambda)^{-1}g=-\\frac{1}{(\\lambda+7)(\\lambda+2)}\\begin{pmatrix}3+\\lambda  -2 \\\\ -2  6+\\lambda\\end{pmatrix}\\begin{pmatrix}-2 \\\\ 4\\end{pmatrix}.\n$$\n计算该矩阵-向量乘积：\n$$\n\\begin{pmatrix}3+\\lambda  -2 \\\\ -2  6+\\lambda\\end{pmatrix}\\begin{pmatrix}-2 \\\\ 4\\end{pmatrix}=\\begin{pmatrix}-14-2\\lambda \\\\ 28+4\\lambda\\end{pmatrix}=(\\lambda+7)\\begin{pmatrix}-2 \\\\ 4\\end{pmatrix}=(\\lambda+7)g.\n$$\n因此\n$$\ns(\\lambda)=-\\frac{(\\lambda+7)}{(\\lambda+7)(\\lambda+2)}\\,g=-\\frac{1}{\\lambda+2}\\,g=\\begin{pmatrix}\\dfrac{2}{\\lambda+2} \\\\ -\\dfrac{4}{\\lambda+2}\\end{pmatrix}.\n$$\n施加边界条件 $\\|s(\\lambda)\\|=2$ 得到\n$$\n\\left\\|\\begin{pmatrix}\\dfrac{2}{\\lambda+2} \\\\ -\\dfrac{4}{\\lambda+2}\\end{pmatrix}\\right\\|^{2}=\\frac{4+16}{(\\lambda+2)^{2}}=\\frac{20}{(\\lambda+2)^{2}}=4\n\\;\\Rightarrow\\;\n(\\lambda+2)^{2}=5.\n$$\n因此 $\\lambda+2=\\sqrt{5}$ 或 $\\lambda+2=-\\sqrt{5}$。因为 $\\lambda\\ge 0$，我们选择 $\\lambda=-2+\\sqrt{5}$。将此值代入 $s(\\lambda)$ 中得到\n$$\ns^{*}=\\begin{pmatrix}\\dfrac{2}{\\sqrt{5}} \\\\ -\\dfrac{4}{\\sqrt{5}}\\end{pmatrix}.\n$$\n因为 $H$ 是正定的（其特征值为正），所以该模型是严格凸的，且解是唯一的。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{2}{\\sqrt{5}}  -\\frac{4}{\\sqrt{5}}\\end{pmatrix}}$$", "id": "2166495"}]}