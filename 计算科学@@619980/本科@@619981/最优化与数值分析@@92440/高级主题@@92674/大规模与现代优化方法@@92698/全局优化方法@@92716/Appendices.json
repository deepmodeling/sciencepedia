{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。在全局优化中，理解算法参数如何影响其搜索行为至关重要。此练习通过一个思想实验来帮助您直观地理解粒子群优化（PSO）算法中探索（exploration）与利用（exploitation）之间的平衡。通过分析认知系数 $c_1$ 和社会系数 $c_2$ 的相对大小，您将能够预测群体是倾向于广泛搜索新区域，还是迅速收敛到已知的最优解 [@problem_id:2176755]。", "problem": "一位工程师正在使用粒子群优化 (PSO) 算法来寻找一个已知具有许多局部最小值的复杂、高维、非凸函数的最小值。群中每个粒子的运动由其在离散时间步长 $t$ 的位置 $x_i$ 和速度 $v_i$ 的以下标准更新规则决定：\n\n$$v_{i}(t+1) = w v_{i}(t) + c_1 r_1 (p_{i} - x_i(t)) + c_2 r_2 (p_{g} - x_i(t))$$\n$$x_{i}(t+1) = x_{i}(t) + v_{i}(t+1)$$\n\n此处，$w$ 是惯性权重，$p_i$ 是粒子 $i$ 迄今为止找到的最佳位置（其个体最佳位置），$p_g$ 是整个粒子群中任何粒子迄今为止找到的最佳位置（全局最佳位置）。参数 $c_1$ 和 $c_2$ 是正常数，分别称为认知系数和社会系数，它们控制着个体最佳位置和全局最佳位置的影响。项 $r_1$ 和 $r_2$ 是在每个粒子的每个更新步骤中从 $[0, 1]$ 上的均匀分布中独立抽取的随机数。\n\n该工程师试验了两种不同的参数配置，同时保持所有其他参数（$w$、粒子群大小、迭代次数）不变。\n\n*   **参数集 A：** $c_1 = 2.5$ 且 $c_2 = 0.1$。\n*   **参数集 B：** $c_1 = 0.1$ 且 $c_2 = 2.5$。\n\n根据 PSO 算法的原理，参数集 A 和参数集 B 分别最有可能观察到哪种搜索行为？\n\nA. 过早收敛到单个次优局部最小值；停滞，粒子在多个不同的局部最优点聚集。\n\nB. 停滞，粒子在多个不同的局部最优点聚集；过早收敛到单个次优局部最小值。\n\nC. 不可控的发散，粒子离开搜索空间边界；快速且高效地收敛到真实全局最小值。\n\nD. 粒子无目的地游荡，没有任何明确的收敛模式；停滞，粒子在多个不同的局部最优点聚集。\n\nE. 快速且高效地收敛到真实全局最小值；过早收敛到单个次优局部最小值。", "solution": "我们分析标准的 PSO 更新规则：\n$$v_{i}(t+1)=w\\,v_{i}(t)+c_{1}r_{1}\\big(p_{i}-x_{i}(t)\\big)+c_{2}r_{2}\\big(p_{g}-x_{i}(t)\\big),$$\n$$x_{i}(t+1)=x_{i}(t)+v_{i}(t+1).$$\n在每次更新时，$r_{1},r_{2}\\in[0,1]$。取范数并使用三角不等式可得\n$$\\|v_{i}(t+1)\\|\\leq w\\|v_{i}(t)\\|+c_{1}r_{1}\\|p_{i}-x_{i}(t)\\|+c_{2}r_{2}\\|p_{g}-x_{i}(t)\\|.$$\n由于 $r_{1},r_{2}\\in[0,1]$，认知贡献和社会贡献分别有上界 $c_{1}\\|p_{i}-x_{i}(t)\\|$ 和 $c_{2}\\|p_{g}-x_{i}(t)\\|$。因此，个体最佳吸引力与全局最佳吸引力的相对影响，由 $c_{1}$ 和 $c_{2}$ 的大小直接控制。\n\n对于参数集 A，$c_{1}\\gg c_{2}$。因此，对于每个粒子 $i$，速度更新中的主导拉力是朝向其自身的最佳位置 $p_{i}$，因为\n$$c_{1}r_{1}\\|p_{i}-x_{i}(t)\\|\\gg c_{2}r_{2}\\|p_{g}-x_{i}(t)\\|$$\n在距离可比的情况下，由于系数的差异，上述不等式成立。因此，粒子倾向于围绕其个体最佳位置进行开发，而与群体全局最佳位置的耦合相对较弱。这会促使形成多个分别围绕不同 $p_{i}$ 的集群，并限制了信息共享，这是导致停滞的一个已知原因，即粒子在没有协同收敛的情况下停留在各种局部最优点附近。\n\n对于参数集 B，$c_{2}\\gg c_{1}$。此时社会项占主导地位，对于每个粒子\n$$c_{2}r_{2}\\|p_{g}-x_{i}(t)\\|\\gg c_{1}r_{1}\\|p_{i}-x_{i}(t)\\|.$$\n朝向 $p_{g}$ 的强吸引力导致粒子群迅速向当前的全局最佳位置收缩。在具有许多局部最小值的非凸搜索空间中，这种强大的社会拉力常常导致整个粒子群过早地收敛到单个次优局部最小值（即“过早收敛”），因为由认知项驱动的探索能力很弱。\n\n因此，在参数集 A（高 $c_{1}$，低 $c_{2}$）下，可能的行为是停滞，粒子在多个不同的局部最优点聚集；在参数集 B（低 $c_{1}$，高 $c_{2}$）下，可能的行为是过早收敛到单个次优局部最小值。在所有选项中，这与选项 B 相符。\n\n其他列出的行为均不符合这些参数设置：在固定的 $w$ 下，单独增加 $c_1$ 或 $c_2$ 并不会导致不可控的发散（选项 C）；无目的的游荡（选项 D）与强吸引力项相矛盾；而在高维、多模态且系数如此不平衡的搜索空间中，通常无法保证能快速高效地收敛到真正的全局最小值（选项 E）。", "answer": "$$\\boxed{B}$$", "id": "2176755"}, {"introduction": "差分进化（DE）是一种强大而优雅的全局优化算法，其核心在于其多样的变异策略。本练习将引导您深入 DE 算法的内部机制，通过手动计算一个具体智能体在两种不同策略（`DE/rand/1/bin` 和 `DE/best/1/bin`）下的演化步骤。这一实践将清晰地揭示，基于随机选择的基向量（`rand`）如何促进种群多样性和探索，而基于当前最优解的基向量（`best`）如何加速收敛和利用 [@problem_id:2176774]。", "problem": "一位工程师正在使用差分进化（DE）算法来寻找一个一维目标函数的最小值。DE 是一种基于种群的元启发式算法，它通过多代进化一个候选解种群来寻找最优解。该算法的行为由其策略决定，通常表示为 `DE/x/y/z`。\n\n-   `x` 定义了用于变异的基向量（例如，`rand` 表示随机个体，`best` 表示当前种群中的最佳个体）。\n-   `y` 是所用差分向量的数量。\n-   `z` 指定了交叉方案（例如，`bin` 表示二项式交叉）。\n\n对于目标个体 $x_i$，DE 算法的一代包含三个步骤：\n1.  **变异**：生成一个变异向量 $v_i$。\n    -   对于 `DE/rand/1/bin` 策略：$v_i = x_{r1} + F \\cdot (x_{r2} - x_{r3})$，其中 $x_{r1}, x_{r2}, x_{r3}$ 是从种群中随机选择的三个不同个体，并且也不同于目标个体 $x_i$。\n    -   对于 `DE/best/1/bin` 策略：$v_i = x_{best} + F \\cdot (x_{r1} - x_{r2})$，其中 $x_{best}$ 是当前种群中目标函数值最低的个体，而 $x_{r1}, x_{r2}$ 是随机选择的两个不同个体，且不同于 $x_i$。\n    -   $F$ 是一个常数缩放因子。\n\n2.  **交叉**：创建一个试验向量 $u_i$。对于一维情况下的二项式交叉，试验向量 $u_i$ 的形成如下：\n    $$\n    u_i = \n    \\begin{cases} \n    v_i & \\text{if } p \\leq CR \\\\\n    x_i & \\text{if } p > CR \n    \\end{cases}\n    $$\n    其中 $p$ 是在 $[0,1]$ 区间内随机生成的一个数，$CR$ 是交叉率。\n\n3.  **选择**：当且仅当试验向量 $u_i$ 的目标函数值更优（即更低）时，它将在下一代替换目标向量 $x_i$。如果 $f(u_i) < f(x_i)$，则新位置为 $u_i$；否则，该个体保持其原始位置 $x_i$。\n\n该工程师正在最小化一维 Ackley 函数，其定义如下：\n$f(x) = -20 \\exp(-0.2 |x|) - \\exp(\\cos(2\\pi x)) + 20 + \\exp(1)$。\n假设三角函数的所有参数均以弧度为单位。\n\n初始种群由四个个体（$N_P=4$）组成，其位置如下：\n$x_1 = 2.5$, $x_2 = -2.9$, $x_3 = 0.1$, $x_4 = 1.2$。\n\nDE 参数设置为 $F=0.8$ 和 $CR=0.9$。\n\n考虑初始位置为 $x_4 = 1.2$ 的个体。计算在两种不同的 DE 策略下，经过一代后它的新位置。为了进行确定性计算，“随机”选择被固定如下：\n-   **策略 1 (`DE/rand/1/bin`)**：用于变异的随机索引为 $r1=1, r2=2, r3=3$。用于交叉检查的数为 $p=0.75$。\n-   **策略 2 (`DE/best/1/bin`)**：用于变异的随机索引为 $r1=1, r2=2$。用于交叉检查的数为 $p=0.75$。\n\n分别给出策略 1 和策略 2 下个体 $x_4$ 的最终位置。将您的答案表示为一个包含两个数值的行矩阵。将您的最终答案四舍五入到三位有效数字。", "solution": "我们需要最小化一维 Ackley 函数\n$$\nf(x)=-20\\exp(-0.2|x|)-\\exp(\\cos(2\\pi x))+20+\\exp(1),\n$$\n初始个体为 $x_{1}=2.5$, $x_{2}=-2.9$, $x_{3}=0.1$, $x_{4}=1.2$，参数为 $F=0.8$, $CR=0.9$。对于两种策略，交叉操作均使用 $p=0.75$，因此在一维情况下\n$$\nu_{4}=\n\\begin{cases}\nv_{4}, & p\\leq CR,\\\\\nx_{4}, & p>CR,\n\\end{cases}\n$$\n此处 $p\\leq CR$，因此两种情况下都有 $u_{4}=v_{4}$。随后，选择操作在当且仅当 $f(u_{4})<f(x_{4})$ 时，令 $x_{4}^{\\text{new}}=u_{4}$。\n\n策略 1 (DE/rand/1/bin)：使用 $r1=1$, $r2=2$, $r3=3$ 进行变异，得到\n$$\nv_{4}=x_{1}+F(x_{2}-x_{3})=2.5+0.8(-2.9-0.1)=2.5+0.8(-3.0)=0.1.\n$$\n交叉产生 $u_{4}=v_{4}=0.1$。为了进行选择，计算\n$$\nf(1.2)=-20\\exp(-0.2\\cdot 1.2)-\\exp(\\cos(2\\pi\\cdot 1.2))+20+\\exp(1)\n=-20\\exp(-0.24)-\\exp(\\cos(2.4\\pi))+20+\\exp(1).\n$$\n使用 $\\exp(-0.24)\\approx 0.7866279$ 和 $\\cos(2.4\\pi)=\\cos(0.4\\pi)\\approx 0.3090169$，\n$$\nf(1.2)\\approx -20(0.7866279)-\\exp(0.3090169)+20+\\exp(1)\\approx -15.7326-1.3621+22.7183\\approx 5.6236.\n$$\n类似地，\n$$\nf(0.1)=-20\\exp(-0.2\\cdot 0.1)-\\exp(\\cos(2\\pi\\cdot 0.1))+20+\\exp(1)\n=-20\\exp(-0.02)-\\exp(\\cos(0.2\\pi))+20+\\exp(1).\n$$\n使用 $\\exp(-0.02)\\approx 0.9801987$ 和 $\\cos(0.2\\pi)\\approx 0.8090169$，\n$$\nf(0.1)\\approx -20(0.9801987)-\\exp(0.8090169)+20+\\exp(1)\\approx -19.6040-2.2457+22.7183\\approx 0.8686.\n$$\n由于 $f(0.1)<f(1.2)$，选择操作接受 $u_{4}$，因此 $x_{4}^{\\text{new}}=0.1$。\n\n策略 2 (DE/best/1/bin)：首先通过计算所有个体的 $f$ 值来确定初始种群中的 $x_{\\text{best}}$。我们已经得到 $f(0.1)\\approx 0.8686$ 和 $f(1.2)\\approx 5.6236$。为了完整性，\n$$\nf(2.5)=-20\\exp(-0.5)-\\exp(\\cos(5\\pi))+20+\\exp(1)\\approx -12.1306-\\exp(-1)+22.7183\\approx 10.2198,\n$$\n因为 $\\exp(-0.5)\\approx 0.6065307$ 且 $\\cos(5\\pi)=-1$。另外，\n$$\nf(-2.9)=-20\\exp(-0.58)-\\exp(\\cos(-5.8\\pi))+20+\\exp(1)\n\\approx -20(0.559898)-\\exp(\\cos(0.2\\pi))+22.7183\\approx 9.2746.\n$$\n因此 $x_{\\text{best}}=0.1$。使用 $r1=1$, $r2=2$ 进行变异，得到\n$$\nv_{4}=x_{\\text{best}}+F(x_{1}-x_{2})=0.1+0.8(2.5-(-2.9))=0.1+0.8\\cdot 5.4=4.42.\n$$\n交叉产生 $u_{4}=v_{4}=4.42$。为了进行选择，计算\n$$\nf(4.42)=-20\\exp(-0.2\\cdot 4.42)-\\exp(\\cos(2\\pi\\cdot 4.42))+20+\\exp(1)\n=-20\\exp(-0.884)-\\exp(\\cos(0.84\\pi))+20+\\exp(1).\n$$\n使用 $\\exp(-0.884)\\approx 0.413133$ 和 $\\cos(0.84\\pi)=-\\cos(0.16\\pi)\\approx -0.8763075$，因此 $\\exp(\\cos(0.84\\pi))\\approx \\exp(-0.8763075)\\approx 0.416147$，我们得到\n$$\nf(4.42)\\approx -20(0.413133)-0.416147+22.7183\\approx 14.0395.\n$$\n由于 $f(4.42)>f(1.2)$，选择操作拒绝 $u_{4}$，因此 $x_{4}^{\\text{new}}=1.2$。\n\n因此，经过一代后，个体 $x_{4}$ 在策略 1 下的新位置为 $0.100$，在策略 2 下为 $1.20$，结果均四舍五入到三位有效数字。", "answer": "$$\\boxed{\\begin{pmatrix}0.100 & 1.20\\end{pmatrix}}$$", "id": "2176774"}, {"introduction": "在解决实际问题时，单一的优化算法可能并非总是最高效的。混合算法（Hybrid Algorithms）结合了不同方法的优点，是一种常见且强大的策略。本练习将带您体验一个两阶段混合优化过程：首先通过粗略的全局网格搜索来识别最有希望的区域，然后利用高效的局部搜索方法（Nelder-Mead）在该区域内进行精确优化。这种“先全局探索，后局部利用”的策略是解决复杂优化问题的实用典范 [@problem_id:2176757]。", "problem": "一位工程师正在开发一种混合优化算法，以寻找一个复杂的二维能量景观的最小值。该能量景观由需要最小化的目标函数 $f(x, y)$ 描述：\n$$f(x,y) = -20 \\cos(x) \\cos(y) \\exp(-((x-2.2)^2 + (y-3.3)^2))$$\n假设所有三角函数输入均为弧度。\n\n该优化过程包括两个阶段：\n\n**阶段 1：全局网格搜索**\n首先，执行一次粗略的网格搜索以确定一个有前景的区域。在网格点 $(x_i, y_j)$ 上评估函数 $f(x, y)$，其中 $x_i = i$ 且 $y_j = j$，对于所有在 $0 \\le i \\le 5$ 和 $0 \\le j \\le 5$ 范围内的整数 $i, j$。在所有评估过的网格点中，找出函数值最低的网格点 $(x^*, y^*)$。\n\n**阶段 2：使用 Nelder-Mead 算法的局部精化**\n接下来，从阶段 1 中找到的点 $(x^*, y^*)$ 开始，使用 Nelder-Mead 算法进行局部搜索。\nNelder-Mead 算法的初始单纯形由三个顶点组成：$V_0 = (x^*, y^*)$，$V_1 = (x^*+h, y^*)$ 和 $V_2 = (x^*, y^*+h)$，步长为 $h=0.1$。\n算法参数固定为：反射系数 $\\alpha=1$，扩张系数 $\\gamma=2$，收缩系数 $\\rho=0.5$，以及压缩系数 $\\sigma=0.5$。\n\n精确执行 Nelder-Mead 算法的**两次**完整迭代。一次迭代包括：按函数值对顶点排序，计算一个反射点，然后根据标准算法规则选择以下移动之一：接受反射、扩张、收缩（外部或内部）或压缩。\n\n完成两次迭代后，确定最终单纯形中函数值最低的顶点的坐标 $(x_f, y_f)$。报告坐标对 $(x_f, y_f)$，每个坐标值需四舍五入到四位有效数字。", "solution": "我们最小化函数\n$$f(x,y)=-20\\cos(x)\\cos(y)\\,\\exp\\!\\left(-\\left((x-2.2)^{2}+(y-3.3)^{2}\\right)\\right).$$\n阶段 1 (网格搜索)。在整数网格点上进行评估。指数因子在 $(2.2,3.3)$ 附近最大，因此最相关的整数点是 $(2,3)$、$(2,4)$、$(3,3)$、$(3,4)$，其平方偏移为\n$$(2,3):0.13,\\quad (2,4):0.53,\\quad (3,3):0.73,\\quad (3,4):1.13.$$\n计算代表性值：\n- 在 $(2,3)$ 点：$\\cos(2)\\cos(3)>0$，$\\exp(-0.13)$ 较大，得出 $f(2,3)\\approx -7.24$。\n- 在 $(2,4)$ 点：$\\cos(2)\\cos(4)>0$，$\\exp(-0.53)$，因此 $f(2,4)\\approx -3.20$。\n- 在 $(3,4)$ 点：$f(3,4)\\approx -4.18$。\n- 在 $(3,3)$ 点：两个余弦值都接近 $-1$，乘积 $\\cos^{2}(3)\\approx 0.9800666$，且 $\\exp(-0.73)\\approx 0.4819$，因此\n$$f(3,3)\\approx -20\\cdot 0.9800666\\cdot 0.4819\\approx -9.446.$$\n距离 $(2.2,3.3)$ 更远的点具有更小的 $\\exp(-r^{2})$；要超越 $-9.446$，它们的 $\\cos(x)\\cos(y)$ 需要非常接近 $1$，这在 $[0,5]$ 的整数网格上只在 $x=y=3$ 附近发生（已考虑过）。此外，一个坐标为 $0$ 另一个为 $3$ 的点会导致 $\\cos(x)\\cos(y)<0$，从而使 $f$ 为正值。因此，网格上的最小值点位于\n$$(x^{*},y^{*})=(3,3)。$$\n\n阶段 2 (Nelder–Mead 算法，参数为 $\\alpha=1$, $\\gamma=2$, $\\rho=0.5$, $\\sigma=0.5$, $h=0.1$) 。初始单纯形：\n$$V_{0}=(3,3),\\quad V_{1}=(3.1,3),\\quad V_{2}=(3,3.1)。$$\n评估函数值：\n- $f(V_{0})=f(3,3)\\approx -9.446$ 如上所述。\n- $f(V_{1})=-20\\cos(3.1)\\cos(3)\\exp(-0.90)\\approx -8.045$ (使用 $\\cos(3.1)\\approx -0.999134$, $\\cos(3)\\approx -0.989992$, $\\exp(-0.90)\\approx 0.40657$)。\n- $f(V_{2})=-20\\cos(3)\\cos(3.1)\\exp(-0.68)\\approx -10.022$ (使用 $\\exp(-0.68)\\approx 0.50662$)。\n为最小化进行排序：最佳点 $x_{l}=V_{2}$，次佳点 $x_{g}=V_{0}$，最差点 $x_{h}=V_{1}$。\n\n迭代 1。\n- 最佳两点（不含最差点）的质心：\n$$\\bar{x}=\\frac{V_{2}+V_{0}}{2}=(3,3.05)。$$\n- 反射：\n$$x_{r}=\\bar{x}+\\alpha(\\bar{x}-x_{h})=(3,3.05)+((3,3.05)-(3.1,3))=(2.9,3.10)。$$\n评估\n$$f(x_{r})=-20\\cos(2.9)\\cos(3.1)\\exp(-0.53)\\approx -11.431,$$\n(使用 $\\cos(2.9)\\approx -0.970959$, $\\cos(3.1)\\approx -0.999134$, $\\exp(-0.53)\\approx 0.58861$)。由于 $f(x_{r})<f(x_{l})$，尝试扩张：\n- 扩张：\n$$x_{e}=\\bar{x}+\\gamma(x_{r}-\\bar{x})=(3,3.05)+2\\cdot(-0.1,0.05)=(2.8,3.15)。$$\n评估\n$$f(x_{e})=-20\\cos(2.8)\\cos(3.15)\\exp(-0.3825)\\approx -12.848,$$\n(使用 $\\cos(2.8)\\approx -0.942222$, $\\cos(3.15)\\approx -0.999965$, $\\exp(-0.3825)\\approx 0.6823$)。由于 $f(x_{e})<f(x_{r})$，接受扩张，并用 $x_{e}$ 替换 $x_{h}$。新的单纯形为：$(3,3.1)$, $(3,3)$, $(2.8,3.15)$。\n\n迭代 2。\n评估并排序：$f(2.8,3.15)\\approx -12.848$ (最佳)，$f(3,3.1)\\approx -10.022$ (次佳)，$f(3,3)\\approx -9.446$ (最差)。\n- 最佳两点的质心：\n$$\\bar{x}=\\frac{(2.8,3.15)+(3,3.1)}{2}=(2.9,3.125)。$$\n- 对最差点 $(3,3)$ 进行反射：\n$$x_{r}=\\bar{x}+(\\bar{x}-x_{h})=(2.9,3.125)+(-0.1,0.125)=(2.8,3.25)。$$\n评估\n$$f(x_{r})=-20\\cos(2.8)\\cos(3.25)\\exp(-0.3625)\\approx -13.020,$$\n(使用 $\\cos(3.25)\\approx -0.994130$, $\\exp(-0.3625)\\approx 0.69594$)。由于 $f(x_{r})<f(x_{l})$，尝试扩张：\n- 扩张：\n$$x_{e}=\\bar{x}+\\gamma(x_{r}-\\bar{x})=(2.9,3.125)+2\\cdot(-0.1,0.125)=(2.7,3.375)。$$\n评估\n$$f(x_{e})=-20\\cos(2.7)\\cos(3.375)\\exp(-0.255625)\\approx -13.621,$$\n(使用 $\\cos(2.7)\\approx -0.904073$, $\\cos(3.375)\\approx -0.972884$, $\\exp(-0.255625)\\approx 0.7743$)。由于 $f(x_{e})<f(x_{r})$，接受扩张并用 $x_{e}$ 替换最差顶点。\n\n经过两次迭代后，最终的单纯形包含 $(3,3.1)$、$(2.8,3.15)$ 和 $(2.7,3.375)$。最低的函数值位于 $(2.7,3.375)$。将每个坐标四舍五入到四位有效数字，得到 $(2.700,\\,3.375)$。", "answer": "$$\\boxed{\\begin{pmatrix}2.700 & 3.375\\end{pmatrix}}$$", "id": "2176757"}]}