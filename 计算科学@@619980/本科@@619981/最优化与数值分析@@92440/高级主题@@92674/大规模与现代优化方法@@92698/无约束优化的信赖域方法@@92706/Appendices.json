{"hands_on_practices": [{"introduction": "信赖域方法的核心在于用一个简单的二次模型来近似复杂的真实目标函数。这个练习将指导你完成信赖域算法迭代中的第一步：在当前点附近构建二次近似模型。掌握这一步是理解和实施信赖域方法的基础，它将多变量微积分的知识（梯度和Hessian矩阵）直接应用到优化问题中。", "problem": "在无约束优化领域，信赖域方法是一类用于求解非线性规划问题的迭代算法。在每次迭代 $k$ 中，这些方法会构建一个更简单的模型函数 $m_k(p)$，该函数在当前点 $x_k$ 的一个邻域（“信赖域”）内逼近真实的目标函数 $f(x)$。然后通过在信赖域内最小化该模型来找到步长 $p$。一个常见的模型选择是基于 $f(x)$ 在 $x_k$ 处的二阶泰勒展开得到的二次函数。\n\n考虑目标函数 $f: \\mathbb{R}^2 \\to \\mathbb{R}$，其定义为：\n$$f(x_1, x_2) = \\sin(x_1) + x_2^2$$\n求该函数在点 $x_k = (0, 1)$ 处的二次模型 $m_k(p)$，其中 $p = (p_1, p_2)$ 是从 $x_k$ 开始的步长。将你的答案表示为关于 $p_1$ 和 $p_2$ 的多项式。", "solution": "基于 $f$ 在 $x_k$ 处的二阶泰勒展开的二次信赖域模型是\n$$m_{k}(p) = f(x_{k}) + \\nabla f(x_{k})^{\\top} p + \\frac{1}{2} p^{\\top} \\nabla^{2} f(x_{k}) p,$$\n其中 $p = (p_{1}, p_{2})$。\n\n已知 $f(x_{1}, x_{2}) = \\sin(x_{1}) + x_{2}^{2}$，计算其梯度和海森矩阵：\n$$\\nabla f(x_{1}, x_{2}) = \\begin{pmatrix} \\cos(x_{1}) \\\\ 2 x_{2} \\end{pmatrix}, \\quad \\nabla^{2} f(x_{1}, x_{2}) = \\begin{pmatrix} -\\sin(x_{1}) & 0 \\\\ 0 & 2 \\end{pmatrix}.$$\n\n在点 $x_{k} = (0, 1)$ 处计算这些值：\n$$f(x_{k}) = \\sin(0) + 1^{2} = 1,$$\n$$\\nabla f(x_{k}) = \\begin{pmatrix} \\cos(0) \\\\ 2 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}, \\quad \\nabla^{2} f(x_{k}) = \\begin{pmatrix} -\\sin(0) & 0 \\\\ 0 & 2 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 2 \\end{pmatrix}.$$\n\n当 $p = (p_{1}, p_{2})$ 时，计算线性和二次项：\n$$\\nabla f(x_{k})^{\\top} p = 1 \\cdot p_{1} + 2 \\cdot p_{2} = p_{1} + 2 p_{2},$$\n$$p^{\\top} \\nabla^{2} f(x_{k}) p = \\begin{pmatrix} p_{1} & p_{2} \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 0 & 2 \\end{pmatrix} \\begin{pmatrix} p_{1} \\\\ p_{2} \\end{pmatrix} = 2 p_{2}^{2}.$$\n\n因此，\n$$m_{k}(p) = 1 + \\left(p_{1} + 2 p_{2}\\right) + \\frac{1}{2} \\left(2 p_{2}^{2}\\right) = 1 + p_{1} + 2 p_{2} + p_{2}^{2}.$$", "answer": "$$\\boxed{1 + p_{1} + 2 p_{2} + p_{2}^{2}}$$", "id": "2224506"}, {"introduction": "构建了二次模型后，下一步是在“信赖域”这个约束球内求解该模型的最小值，这被称为信赖域子问题。这个练习聚焦于一个简单的一维凸模型场景，让你亲身体验如何通过比较无约束最优点和信赖域边界来找到最优步长。这个过程揭示了信赖域约束如何有效地平衡模型的预测最优性与局部近似的可靠性。", "problem": "在无约束优化的背景下，信赖域方法在当前点附近使用一个更简单的模型函数 $m(p)$ 来迭代地近似一个复杂函数。下一步的步长 $p$ 是通过求解信赖域子问题来确定的，该子问题涉及在一个半径为 $\\Delta > 0$ 的“信赖域”内最小化此模型，在该区域内，模型被认为是原函数的一个可靠近似。该子问题形式化地表述为：\n$$\n\\min_{p} m(p) \\quad \\text{subject to} \\quad \\|p\\| \\le \\Delta\n$$\n考虑一个一维优化场景，其中步长 $p \\in \\mathbb{R}$ 的模型函数是一个由下式给出的二次函数：\n$$\nm(p) = g p + \\frac{1}{2} H p^2 + c\n$$\n其中梯度项 $g = 2$，海森项 $H = 6$，以及一个任意常数 $c$。步长受信赖域半径 $\\Delta = 0.1$ 的约束。\n\n确定求解此一维信赖域子问题的最优步长 $p$。请以精确小数形式给出你的答案。", "solution": "我们必须在信赖域约束 $|p| \\le \\Delta$ 下最小化二次模型 $m(p) = g p + \\frac{1}{2} H p^{2} + c$，其中给定值为 $g=2$，$H=6$ 和 $\\Delta=0.1$。常数 $c$ 不影响最小化子，可以忽略。\n\n考虑该信赖域子问题的拉格朗日函数：\n$$\n\\mathcal{L}(p,\\lambda) = g p + \\frac{1}{2} H p^{2} + \\lambda \\left(p^{2} - \\Delta^{2}\\right),\n$$\n其中 $\\lambda \\ge 0$。Karush-Kuhn-Tucker (KKT) 条件如下：\n1. 平稳性：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p} = g + H p + 2 \\lambda p = 0.\n$$\n2. 原始可行性：$|p| \\le \\Delta$。\n3. 对偶可行性：$\\lambda \\ge 0$。\n4. 互补松弛性：$\\lambda \\left(p^{2} - \\Delta^{2}\\right) = 0$。\n\n情况1（内部解）：如果 $|p| < \\Delta$，则 $\\lambda = 0$，平稳性条件给出\n$$\ng + H p = 0 \\quad \\Rightarrow \\quad p_{u} = -\\frac{g}{H}.\n$$\n对于 $g=2$ 和 $H=6$，这得到 $p_{u} = -\\frac{2}{6} = -\\frac{1}{3}$。检查可行性：$|p_{u}| = \\frac{1}{3} > 0.1 = \\Delta$，因此该内部解不可行。\n\n情况2（边界解）：那么 $p^{2} = \\Delta^{2}$，所以 $p = \\pm \\Delta$。平稳性条件变为\n$$\ng + H p + 2 \\lambda p = 0 \\quad \\Rightarrow \\quad (H + 2 \\lambda) p = -g.\n$$\n由于 $H + 2 \\lambda \\ge 0$，$p$ 的符号必须与 $-g$ 的符号相同。因为 $g = 2 > 0$，所以我们必须取 $p = -\\Delta = -0.1$。为验证对偶可行性，我们求解 $\\lambda$：\n$$\n(H + 2 \\lambda)(-\\Delta) = -g \\quad \\Rightarrow \\quad (H + 2 \\lambda)\\Delta = g \\quad \\Rightarrow \\quad 2 \\lambda = \\frac{g}{\\Delta} - H.\n$$\n代入 $g=2$，$\\Delta=0.1$ 和 $H=6$ 可得\n$$\n2 \\lambda = \\frac{2}{0.1} - 6 = 20 - 6 = 14 \\quad \\Rightarrow \\quad \\lambda = 7 \\ge 0,\n$$\n这满足了对偶可行性和互补松弛性条件。\n\n因此，最优信赖域步长是在负梯度方向上的边界步长：\n$$\np^{\\star} = -\\Delta = -0.1.\n$$", "answer": "$$\\boxed{-0.1}$$", "id": "2224504"}, {"introduction": "信赖域方法的真正威力体现在处理非凸问题上，这是许多其他优化方法（如基本牛顿法）可能失效的地方。本练习将引导你分析一个二次模型为凹函数的情形，此时模型的无约束平稳点是一个最大值而非最小值。通过解决这个子问题，你将理解信赖域边界如何确保我们总能找到一个有效的下降方向，从而彰显了该方法的鲁棒性。", "problem": "在无约束优化的背景下，信赖域方法围绕当前迭代点 $x_k$ 迭代地构建目标函数 $f(x)$ 的一个二次模型 $m_k(p)$。下一步的步长 $p_k$ 是通过在半径为 $\\Delta_k$ 的“信赖域”内最小化该模型来找到的。在一维情况下，该模型定义为：\n$$m_k(p) = f(x_k) + f'(x_k)p + \\frac{1}{2}f''(x_k)p^2$$\n其中 $p$ 是从 $x_k$ 出发的步长。步长 $p_k$ 是以下子问题的解：\n$$\\min_{p} m_k(p) \\quad \\text{subject to} \\quad |p| \\le \\Delta_k$$\n\n考虑一维目标函数 $f(x) = -\\frac{1}{3}x^3 + 2x^2 - x$。假设我们处于迭代点 $x_k = 5$ 且信赖域半径为 $\\Delta_k = 2$。\n\n确定对于本次迭代，求解信赖域子问题的步长 $p_k$ 的值。", "solution": "我们在 $x_{k}=5$ 处构建一维二次模型：\n$$m_{k}(p)=f(x_{k})+f'(x_{k})p+\\frac{1}{2}f''(x_{k})p^{2}.$$\n给定 $f(x)=-\\frac{1}{3}x^{3}+2x^{2}-x$，其导数为\n$$f'(x)=-x^{2}+4x-1,\\qquad f''(x)=-2x+4.$$\n在 $x_{k}=5$ 处求值得\n$$g_{k}=f'(5)=-25+20-1=-6,\\qquad B_{k}=f''(5)=-10+4=-6.$$\n因此模型简化为\n$$m_{k}(p)=f(x_{k})-6p+\\frac{1}{2}(-6)p^{2}=f(x_{k})-6p-3p^{2}.$$\n信赖域子问题是\n$$\\min_{p} \\, m_{k}(p)\\quad \\text{subject to}\\quad |p|\\le \\Delta_{k}=2.$$\n由于 $B_{k}<0$，二次函数 $m_{k}(p)$ 是关于 $p$ 的凹函数。其驻点满足 $m_{k}'(p)=g_{k}+B_{k}p=0$，得到\n$$p^{\\ast}=-\\frac{g_{k}}{B_{k}}=-\\frac{-6}{-6}=-1,$$\n由于凹性，此点为极大值点。因此，在闭区间 $\\{|p|\\le 2\\}$ 上的最小值出现在边界点 $p=\\pm 2$ 之一。在端点处计算模型的值：\n$$m_{k}(2)=f(x_{k})-12-12=f(x_{k})-24,\\qquad m_{k}(-2)=f(x_{k})+12-12=f(x_{k}).$$\n因此 $m_{k}(2)<m_{k}(-2)$，所以使模型最小化的步长是\n$$p_{k}=2.$$", "answer": "$$\\boxed{2}$$", "id": "2224539"}]}