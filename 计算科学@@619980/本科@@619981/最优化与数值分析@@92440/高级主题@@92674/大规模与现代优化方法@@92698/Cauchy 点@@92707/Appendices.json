{"hands_on_practices": [{"introduction": "计算柯西点是信赖域方法中的一项基本技能。这个练习将带你走过一个标准流程：在最速下降方向上最小化二次模型，同时考虑信赖域边界的约束。通过这个具体的计算，你将掌握确定柯西点的核心步骤，为理解更复杂的优化情景打下坚实基础。[@problem_id:2209928]", "problem": "在用于无约束优化的信赖域方法中，目标函数在每次迭代 $k$ 时被一个二次模型 $m_k(p)$ 近似。下一步 $p$ 是通过在一个“信赖域”内最小化该模型来找到的，该信赖域通常是一个以当前点为中心、半径为 $\\Delta_k$ 的球体。在许多信赖域算法中，一个关键步骤是找到 Cauchy 点，它是沿最速下降方向，受信赖域约束的最小化问题的解。\n\n考虑一个二维优化问题，其中当前迭代点 $k$ 的二次模型由下式给出：\n$$m_k(p) = f_k + g_k^T p + \\frac{1}{2} p^T B_k p$$\n其中，$p \\in \\mathbb{R}^2$ 是从当前位置出发的步长，$f_k$ 是函数值，$g_k$ 是梯度向量，$B_k$ 是海森矩阵的一个对称近似。用于信赖域的范数是标准的欧几里得范数 $\\|p\\|_2$。\n\n在某次特定迭代中，已知以下值：\n- 梯度向量：$g_k = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$\n- 对称海森近似：$B_k = \\begin{pmatrix} 2 & 0 \\\\ 0 & 3 \\end{pmatrix}$\n- 信赖域半径：$\\Delta_k = 5$\n\n计算本次迭代的 Cauchy 点 $p_k^C$。将答案的分量表示为精确分数。", "solution": "在信赖域方法中，Cauchy 点是二次模型沿着最速下降方向，且在信赖域半径约束下的极小值点。将沿负梯度方向的步长参数化为 $p=-\\alpha g_{k}$，其中 $\\alpha \\geq 0$。代入模型中，\n$$\nm_{k}(-\\alpha g_{k})=f_{k}-\\alpha \\|g_{k}\\|_{2}^{2}+\\frac{1}{2}\\alpha^{2} g_{k}^{T} B_{k} g_{k}.\n$$\n定义 $\\phi(\\alpha)=m_{k}(-\\alpha g_{k})$。其导数为\n$$\n\\phi'(\\alpha)=-\\|g_{k}\\|_{2}^{2}+\\alpha\\, g_{k}^{T} B_{k} g_{k}.\n$$\n沿此射线的无约束极小值点满足 $\\phi'(\\alpha)=0$，可得\n$$\n\\alpha^{\\ast}=\\frac{\\|g_{k}\\|_{2}^{2}}{g_{k}^{T} B_{k} g_{k}},\n$$\n前提是 $g_{k}^{T} B_{k} g_{k}>0$。使用 $g_{k}=\\begin{pmatrix}1\\\\1\\end{pmatrix}$ 和 $B_{k}=\\begin{pmatrix}2&0\\\\0&3\\end{pmatrix}$，计算\n$$\n\\|g_{k}\\|_{2}^{2}=g_{k}^{T} g_{k}=1^{2}+1^{2}=2,\\qquad g_{k}^{T} B_{k} g_{k}=\\begin{pmatrix}1&1\\end{pmatrix}\\begin{pmatrix}2&0\\\\0&3\\end{pmatrix}\\begin{pmatrix}1\\\\1\\end{pmatrix}=2+3=5.\n$$\n因此\n$$\n\\alpha^{\\ast}=\\frac{2}{5}.\n$$\n信赖域约束要求 $\\alpha \\leq \\Delta_{k}/\\|g_{k}\\|_{2}$。此处，\n$$\n\\frac{\\Delta_{k}}{\\|g_{k}\\|_{2}}=\\frac{5}{\\sqrt{2}},\n$$\n由于 $\\frac{2}{5}<\\frac{5}{\\sqrt{2}}$，信赖域边界是不活跃的。因此，Cauchy 点等于沿 $-g_{k}$ 方向的无约束极小值点：\n$$\np_{k}^{C}=-\\alpha^{\\ast} g_{k}=-\\frac{2}{5}\\begin{pmatrix}1\\\\1\\end{pmatrix}=\\begin{pmatrix}-\\frac{2}{5}\\\\-\\frac{2}{5}\\end{pmatrix}.\n$$\n表示为精确分数，其分量为 $-\\frac{2}{5}$ 和 $-\\frac{2}{5}$。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{2}{5} & -\\frac{2}{5}\\end{pmatrix}}$$", "id": "2209928"}, {"introduction": "掌握了基本计算后，我们来探讨一个关键概念：曲率。二次模型在最速下降方向上的曲率（由 $g_k^T B_k g_k$ 给出）决定了算法的行为；当曲率为负时，模型会无限下降。这个练习将帮助你识别“负曲率”情况，并理解为何在这种情形下，柯西点必须位于信赖域的边界上。[@problem_id:2209930]", "problem": "在数值优化领域，信赖域方法是用于求解无约束优化问题的一类算法。在每一步中，该方法在当前点 $x_k$ 周围的一个“信赖域”内，用一个更简单的模型函数 $m_k(p)$ 来近似目标函数 $f(x)$。模型的常见选择是二次函数：\n$$m_k(p) = f(x_k) + g_k^T p + \\frac{1}{2} p^T B_k p$$\n其中，$p$ 是从 $x_k$ 开始的步长向量，$g_k = \\nabla f(x_k)$ 是目标函数在 $x_k$ 处的梯度，而 $B_k$ 是一个对称矩阵，用以近似 $f$ 在 $x_k$ 处的Hessian矩阵。\n\n模型 $m_k(p)$ 沿方向 $p$ 的曲率由值 $p^T B_k p$ 给出。如果该值为负，则表示“负曲率”，这是一种二次模型没有最小值点，并且沿该方向移动时函数值会减小的情况。\n\n考虑一个二维（$x \\in \\mathbb{R}^2$）的优化问题。在某次迭代 $k$ 中，梯度为 $g_k = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。Hessian近似矩阵是一个对角矩阵，形式为 $B_k = \\text{diag}(d_1, d_2)$。在信赖域算法中，一个常见的检查是检验沿最速下降方向（由 $-g_k$ 给出）的曲率。\n\n对于下列哪几对值 $(d_1, d_2)$，二次模型 $m_k(p)$ 会沿最速下降方向表现出负曲率？选择所有适用项。\n\nA. $(d_1, d_2) = (1.5, 0.5)$\n\nB. $(d_1, d_2) = (3.0, -2.5)$\n\nC. $(d_1, d_2) = (-4.0, 1.0)$\n\nD. $(d_1, d_2) = (-2.0, -1.5)$\n\nE. $(d_1, d_2) = (2.0, -3.0)", "solution": "二次模型 $m_{k}(p)$ 沿方向 $p$ 的曲率由 $p^{T} B_{k} p$ 给出。当 $p^{T} B_{k} p < 0$ 时，沿该方向出现负曲率。\n\n$x_k$ 处的最速下降方向是 $-g_k$。已知 $g_{k} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，则该方向为\n$$\np = -g_{k} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}.\n$$\n当 $B_{k} = \\mathrm{diag}(d_{1}, d_{2})$ 时，我们有\n$$\np^{T} B_{k} p = \\begin{pmatrix} -1 & -1 \\end{pmatrix} \\begin{pmatrix} d_{1} & 0 \\\\ 0 & d_{2} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} = d_{1}(-1)^{2} + d_{2}(-1)^{2} = d_{1} + d_{2}.\n$$\n因此，当且仅当以下条件成立时，模型会沿 $-g_{k}$ 方向表现出负曲率：\n$$\nd_{1} + d_{2} < 0.\n$$\n\n评估每个选项：\n- A: $1.5 + 0.5 = 2.0 > 0$；不是负曲率。\n- B: $3.0 + (-2.5) = 0.5 > 0$；不是负曲率。\n- C: $-4.0 + 1.0 = -3.0 < 0$；是负曲率。\n- D: $-2.0 + (-1.5) = -3.5 < 0$；是负曲率。\n- E: $2.0 + (-3.0) = -1.0 < 0$；是负曲率。\n\n因此，正确选项是 C、D 和 E。", "answer": "$$\\boxed{CDE}$$", "id": "2209930"}, {"introduction": "此练习旨在融合前两个实践的核心思想，让你深入探索模型几何特性与信赖域约束之间的动态关系。柯西点的位置取决于无约束最优点是否落在信赖域内，而这由信赖域半径 $\\Delta_k$ 的大小决定。通过反向求解这个临界半径，你将能精确地理解和量化决定柯西点是在信赖域内部还是在其边界上的条件。[@problem_id:2209918]", "problem": "在用于数值优化的信赖域方法中，一个函数 $f(x)$ 在迭代点 $x_k$ 处被一个二次模型 $m_k(p)$ 近似：\n$$m_k(p) = f(x_k) + g_k^T p + \\frac{1}{2} p^T B_k p$$\n此处，$p$ 是从 $x_k$ 出发的步长，$g_k$ 是 $f$ 在 $x_k$ 处的梯度，而 $B_k$ 是 $f$ 在 $x_k$ 处的 Hessian 矩阵的一个近似。步长 $p$ 是通过在由 $\\|p\\|_2 \\le \\Delta_k$ 定义的信赖域内最小化 $m_k(p)$ 来找到的，其中 $\\Delta_k > 0$ 是信赖域半径。\n\n该方法的一个基本组成部分是柯西点 $p_k^C$ 的计算。该点被定义为二次模型 $m_k(p)$ 沿着最速下降方向 $p(\\tau) = -\\tau g_k$（对于 $\\tau > 0$）在信赖域约束下的极小值点。\n\n考虑一个特定的迭代，其中梯度为 $g_k = \\begin{pmatrix} 3 \\\\ -4 \\end{pmatrix}$，Hessian 近似矩阵为 $B_k = \\begin{pmatrix} 2 & 1 \\\\ 1 & 3 \\end{pmatrix}$。\n\n确定信赖域半径 $\\Delta_k$ 的精确值，该值是区分以下两种情况的边界：柯西点通过沿最速下降方向的无约束极小化求得，以及柯西点受信赖域边界限制。请用精确分数表示你的答案。", "solution": "我们考虑二次模型 $m_{k}(p)=f(x_{k})+g_{k}^{T}p+\\frac{1}{2}p^{T}B_{k}p$ 并将其限制在最速下降射线 $p(\\tau)=-\\tau g_{k}$（其中 $\\tau>0$）上。沿着这条射线，\n$$\nm_{k}(-\\tau g_{k})=f(x_{k})-\\tau\\,g_{k}^{T}g_{k}+\\frac{1}{2}\\tau^{2}\\,g_{k}^{T}B_{k}g_{k}.\n$$\n沿该射线的无约束极小值点可通过将关于 $\\tau$ 的导数设为零来获得：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\tau}m_{k}(-\\tau g_{k})=-g_{k}^{T}g_{k}+\\tau\\,g_{k}^{T}B_{k}g_{k}=0,\n$$\n由此可得\n$$\n\\tau_{\\ast}=\\frac{g_{k}^{T}g_{k}}{g_{k}^{T}B_{k}g_{k}}.\n$$\n相应的无约束步长为 $p_{\\ast}=-\\tau_{\\ast}g_{k}$，其范数为\n$$\n\\|p_{\\ast}\\|_{2}=\\tau_{\\ast}\\|g_{k}\\|_{2}.\n$$\n信赖域柯西点等于沿射线的这个无约束极小值点，当且仅当 $\\|p_{\\ast}\\|_{2}\\leq\\Delta_{k}$。因此，无约束情况和受信赖域限制情况之间的边界是\n$$\n\\Delta_{k}^{\\text{boundary}}=\\|p_{\\ast}\\|_{2}=\\tau_{\\ast}\\|g_{k}\\|_{2}.\n$$\n给定 $g_{k}=\\begin{pmatrix}3\\\\-4\\end{pmatrix}$ 和 $B_{k}=\\begin{pmatrix}2&1\\\\1&3\\end{pmatrix}$，计算\n$$\ng_{k}^{T}g_{k}=3^{2}+(-4)^{2}=9+16=25,\n$$\n$$\nB_{k}g_{k}=\\begin{pmatrix}2&1\\\\1&3\\end{pmatrix}\\begin{pmatrix}3\\\\-4\\end{pmatrix}=\\begin{pmatrix}2\\cdot 3+1\\cdot(-4)\\\\1\\cdot 3+3\\cdot(-4)\\end{pmatrix}=\\begin{pmatrix}2\\\\-9\\end{pmatrix},\n$$\n$$\ng_{k}^{T}B_{k}g_{k}= \\begin{pmatrix}3&-4\\end{pmatrix}\\begin{pmatrix}2\\\\-9\\end{pmatrix}=3\\cdot 2+(-4)\\cdot(-9)=6+36=42,\n$$\n以及\n$$\n\\|g_{k}\\|_{2}=\\sqrt{25}=5.\n$$\n因此\n$$\n\\tau_{\\ast}=\\frac{25}{42},\\qquad \\Delta_{k}^{\\text{boundary}}=\\tau_{\\ast}\\|g_{k}\\|_{2}=\\frac{25}{42}\\cdot 5=\\frac{125}{42}.\n$$\n所以，两种情况边界处的精确信赖域半径为 $\\frac{125}{42}$。", "answer": "$$\\boxed{\\frac{125}{42}}$$", "id": "2209918"}]}