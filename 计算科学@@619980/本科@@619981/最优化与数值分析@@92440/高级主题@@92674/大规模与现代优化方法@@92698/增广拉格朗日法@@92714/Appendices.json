{"hands_on_practices": [{"introduction": "掌握增广拉格朗日方法最好的方式就是完整地执行一次迭代。这个练习提供了一个绝佳的机会，让你在一个简单的一维问题上练习该方法的两个核心步骤：首先，针对给定的拉格朗日乘子估计值，最小化增广拉格朗日函数以更新变量 $x$；然后，利用新的 $x$ 值来更新拉格朗日乘子 $\\lambda$。通过这个基础计算，你将牢牢掌握该算法的运作机制。[@problem_id:2208360]", "problem": "考虑在等式约束 $h(x) = x - 3 = 0$下，最小化目标函数 $f(x) = x^2$ 的约束优化问题。\n\n增广拉格朗日方法是解决此类问题的一种迭代算法。增广拉格朗日函数定义为：\n$$L_A(x, \\lambda; \\rho) = f(x) + \\lambda h(x) + \\frac{\\rho}{2} [h(x)]^2$$\n其中 $\\lambda$ 是拉格朗日乘子估计值，$\\rho > 0$ 是惩罚参数。\n\n从一个估计值 $\\lambda_k$ 开始，该方法的一次迭代包含以下两个主要步骤：\n1.  通过求解无约束最小化问题，找到下一个迭代点 $x_{k+1}$：\n    $$x_{k+1} = \\arg\\min_{x} L_A(x, \\lambda_k; \\rho)$$\n2.  使用以下公式更新拉格朗日乘子：\n    $$\\lambda_{k+1} = \\lambda_k + \\rho h(x_{k+1})$$\n\n从初始乘子估计值 $\\lambda_0 = 1$ 和惩罚参数 $\\rho = 2$ 开始，执行一次完整的增广拉格朗日方法迭代。确定得到的新迭代点 $x_1$ 和更新后的乘子 $\\lambda_1$ 的值。\n\n将您的答案表示为行矩阵 $\\begin{pmatrix} x_1 & \\lambda_1 \\end{pmatrix}$，并使用精确分数。", "solution": "给定 $f(x) = x^{2}$ 和 $h(x) = x - 3$，其增广拉格朗日函数为\n$$L_{A}(x,\\lambda;\\rho) = f(x) + \\lambda h(x) + \\frac{\\rho}{2}[h(x)]^{2}.$$\n当 $\\lambda_{0} = 1$ 且 $\\rho = 2$ 时，该函数变为\n$$L_{A}(x,1;2) = x^{2} + 1\\cdot(x-3) + \\frac{2}{2}(x-3)^{2} = x^{2} + x - 3 + (x-3)^{2} = 2x^2 - 5x + 6.$$\n为了得到 $x_{1}$，求解无约束最小化问题：\n$$x_{1} = \\arg\\min_{x} L_{A}(x,1;2).$$\n求导并令其等于零：\n$$\\frac{d}{dx}L_{A}(x,1;2) = 4x - 5,$$\n$$4x - 5 = 0 \\implies x_{1} = \\frac{5}{4}.$$\n二阶导数为\n$$\\frac{d^{2}}{dx^{2}}L_{A}(x,1;2) = 4 > 0,$$\n因此 $x_{1} = \\frac{5}{4}$ 是唯一的极小值点。\n\n使用 $\\lambda_{1} = \\lambda_{0} + \\rho h(x_{1})$ 更新乘子：\n$$h(x_{1}) = \\frac{5}{4} - 3 = -\\frac{7}{4},$$\n$$\\lambda_{1} = 1 + 2\\left(-\\frac{7}{4}\\right) = 1 - \\frac{7}{2} = -\\frac{5}{2}.$$\n\n因此，得到的值为 $x_{1} = \\frac{5}{4}$ 和 $\\lambda_{1} = -\\frac{5}{2}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{5}{4} & -\\frac{5}{2} \\end{pmatrix}}$$", "id": "2208360"}, {"introduction": "在掌握了单次迭代的计算之后，下一步自然是观察算法在多次迭代中的行为。这个练习将引导你对一个简单的二次规划问题执行前三次迭代 [@problem_id:2208359]。通过推导迭代序列 $\\{x_k\\}$ 的解析表达式，你将能清晰地看到，随着乘子 $\\lambda_k$ 的不断更新，解是如何一步步逼近真实可行解的，从而直观地理解算法的收敛过程。", "problem": "乘子法，也称为增广拉格朗日方法，是一种用于求解约束优化问题的迭代算法。考虑一个形式如下的一维优化问题：\n最小化 $f(x)$，约束条件为等式约束 $h(x) = 0$。\n\n增广拉格朗日函数 $L_\\rho(x, \\lambda)$ 定义为：\n$$L_\\rho(x, \\lambda) = f(x) + \\lambda h(x) + \\frac{\\rho}{2} (h(x))^2$$\n其中 $\\lambda$ 是拉格朗日乘子估计值，$\\rho > 0$ 是一个常数罚参数。\n\n乘子法从一个初始乘子 $\\lambda_0$ 开始，通过以下迭代方案进行：\n对于 $k = 0, 1, 2, \\dots$\n1. 通过使用当前乘子估计值 $\\lambda_k$ 最小化增广拉格朗日函数，来找到下一个迭代点 $x_{k+1}$：\n   $$x_{k+1} = \\arg\\min_x L_\\rho(x, \\lambda_k)$$\n2. 更新拉格朗日乘子：\n   $$\\lambda_{k+1} = \\lambda_k + \\rho h(x_{k+1})$$\n\n将此方法的前三次迭代应用于最小化函数 $f(x) = x^2$（约束条件为 $x - 1 = 0$）的问题。\n使用一个固定的罚参数 $\\rho > 0$，并从初始乘子估计值 $\\lambda_0 = 0$ 开始。\n\n求出前三个最小化点 $x_1, x_2$ 和 $x_3$ 关于罚参数 $\\rho$ 的解析表达式。请按顺序给出 $x_1, x_2,$ 和 $x_3$ 的答案。", "solution": "我们要求使用乘子法最小化 $f(x)=x^{2}$，约束为 $h(x)=x-1=0$，其增广拉格朗日函数为\n$$\nL_{\\rho}(x,\\lambda)=x^{2}+\\lambda(x-1)+\\frac{\\rho}{2}(x-1)^{2},\n$$\n其中 $\\rho>0$ 为固定值，初始乘子 $\\lambda_{0}=0$。迭代过程如下：\n$$\nx_{k+1}=\\arg\\min_{x}L_{\\rho}(x,\\lambda_{k}),\\quad \\lambda_{k+1}=\\lambda_{k}+\\rho\\,h(x_{k+1})=\\lambda_{k}+\\rho(x_{k+1}-1).\n$$\n为了求得 $x_{k+1}$，我们将 $L_{\\rho}(x,\\lambda_{k})$ 对 $x$ 求导，并令其导数为零：\n$$\n\\frac{\\partial L_{\\rho}}{\\partial x}=2x+\\lambda_{k}+\\rho(x-1)=0.\n$$\n这得到了一个关于 $x$ 的线性方程：\n$$\n(2+\\rho)x+\\lambda_{k}-\\rho=0 \\quad\\Longrightarrow\\quad x_{k+1}=\\frac{\\rho-\\lambda_{k}}{2+\\rho}.\n$$\n使用以下规则更新 $\\lambda$：\n$$\n\\lambda_{k+1}=\\lambda_{k}+\\rho\\left(\\frac{\\rho-\\lambda_{k}}{2+\\rho}-1\\right)=\\lambda_{k}-\\frac{\\rho(\\lambda_{k}+2)}{2+\\rho}.\n$$\n这可以简化为仿射递推关系\n$$\n\\lambda_{k+1}=\\frac{2}{2+\\rho}\\lambda_{k}-\\frac{2\\rho}{2+\\rho}.\n$$\n定义 $a=\\frac{2}{2+\\rho}$。当 $\\lambda_{0}=0$ 时，该递推关系的解为\n$$\n\\lambda_{k}=2a^{k}-2.\n$$\n代入 $x_{k+1}=\\frac{\\rho-\\lambda_{k}}{2+\\rho}$ 中可得\n$$\nx_{k+1}=\\frac{\\rho-(2a^{k}-2)}{2+\\rho}=\\frac{\\rho+2-2a^{k}}{2+\\rho}=1-\\frac{2a^{k}}{2+\\rho}\n=1-\\frac{2^{k+1}}{(2+\\rho)^{k+1}}.\n$$\n现在计算前三个最小化点：\n- 当 $k=0$ 时，\n$$\nx_{1}=1-\\frac{2}{2+\\rho}=\\frac{\\rho}{2+\\rho}.\n$$\n- 当 $k=1$ 时，\n$$\nx_{2}=1-\\frac{2^{2}}{(2+\\rho)^{2}}=\\frac{(2+\\rho)^{2}-4}{(2+\\rho)^{2}}=\\frac{\\rho(\\rho+4)}{(2+\\rho)^{2}}.\n$$\n- 当 $k=2$ 时，\n$$\nx_{3}=1-\\frac{2^{3}}{(2+\\rho)^{3}}=\\frac{(2+\\rho)^{3}-8}{(2+\\rho)^{3}}=\\frac{\\rho(\\rho^{2}+6\\rho+12)}{(2+\\rho)^{3}}.\n$$\n因此，所求的 $x_{1},x_{2},x_{3}$ 关于 $\\rho$ 的表达式如上所示。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\rho}{2+\\rho} & \\frac{\\rho(\\rho+4)}{(2+\\rho)^{2}} & \\frac{\\rho(\\rho^{2}+6\\rho+12)}{(2+\\rho)^{3}}\\end{pmatrix}}$$", "id": "2208359"}, {"introduction": "真正深入地理解一个算法，不仅在于会用它进行计算，更在于能分析其内在行为。这个练习旨在让你从计算转向分析，通过一个带有参数的设定来探索惩罚参数 $\\rho$ 的关键作用 [@problem_id:2208363]。你需要将初次迭代的结果表示为 $\\rho$ 的函数，这能让你洞察到惩罚项是如何“驱动”解朝向满足约束条件的方向移动的，并理解其在平衡目标函数最小化和约束满足度中的角色。", "problem": "一位工程师正在使用增广拉格朗日方法求解一个简单的一维约束优化问题。其目标是最小化目标函数 $f(x) = \\frac{1}{2} \\beta x^2$，并满足线性等式约束 $c(x) = x - a = 0$。在此，$\\beta$ 和 $a$ 是给定的正常数。\n\n该问题的增广拉格朗日函数定义为 $L_A(x, \\lambda; \\rho) = f(x) + \\lambda c(x) + \\frac{\\rho}{2} [c(x)]^2$，其中 $\\lambda$ 是拉格朗日乘子，$\\rho > 0$ 是罚参数。\n\n该算法的第一步是关于 $x$ 最小化 $L_A(x, \\lambda_0; \\rho)$，以求得第一个原始迭代变量 $x_0$。此步骤使用拉格朗日乘子的一个初始猜测值 $\\lambda_0$ 来执行。假设工程师使用的初始猜测值为 $\\lambda_0 = 0$ 和一个固定的罚参数 $\\rho$。\n\n确定最终得到的第一个原始迭代变量 $x_0$。请用一个包含 $a$、$\\beta$ 和 $\\rho$ 的封闭形式解析表达式来表示你的答案。", "solution": "我们已知目标函数为 $f(x) = \\frac{1}{2}\\beta x^{2}$，约束为 $c(x) = x - a = 0$。增广拉格朗日函数为\n$$\nL_{A}(x,\\lambda;\\rho) = f(x) + \\lambda c(x) + \\frac{\\rho}{2}[c(x)]^{2}。\n$$\n使用初始乘子 $\\lambda_{0} = 0$，我们对函数\n$$\nL_{A}(x,0;\\rho) = \\frac{1}{2}\\beta x^{2} + \\frac{\\rho}{2}(x - a)^{2}\n$$\n关于 $x$ 进行最小化。\n为求最小值点，我们对 $x$ 求导并令其为零：\n$$\n\\frac{d}{dx}L_{A}(x,0;\\rho) = \\beta x + \\rho(x - a) = (\\beta + \\rho)x - \\rho a = 0。\n$$\n求解 $x$ 可得\n$$\nx = \\frac{\\rho a}{\\beta + \\rho}。\n$$\n由于二阶导数为\n$$\n\\frac{d^{2}}{dx^{2}}L_{A}(x,0;\\rho) = \\beta + \\rho > 0，\n$$\n该临界点是唯一的最小值点。因此，第一个原始迭代变量为\n$$\nx_{0} = \\frac{\\rho a}{\\beta + \\rho}。\n$$", "answer": "$$\\boxed{\\frac{\\rho a}{\\beta + \\rho}}$$", "id": "2208363"}]}