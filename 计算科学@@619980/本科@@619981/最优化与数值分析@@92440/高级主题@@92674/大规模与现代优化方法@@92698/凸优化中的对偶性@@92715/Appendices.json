{"hands_on_practices": [{"introduction": "对偶理论的第一步是学习如何从一个给定的原始问题（primal problem）构建其对偶问题（dual problem）。这项练习将通过一个简单的二次函数优化问题，引导你实践构建拉格朗日函数（Lagrangian）的核心步骤，并通过最小化拉格朗日函数来推导对偶函数（dual function）。掌握这项基本功是深入探索对偶性理论及其应用的基石。[@problem_id:2167425]", "problem": "考虑关于实变量 $x$ 最小化函数 $f(x) = c x^2$ 的优化问题。该函数由一个正常数 $c$ 参数化。该优化的约束条件为 $x$ 必须位于闭区间 $[a, b]$ 内，其中 $a$ 和 $b$ 是满足 $a < b$ 的实常数。\n\n你的任务是构建该问题的拉格朗日对偶问题。具体来说，求出对偶函数 $g(\\lambda, \\mu)$，其中 $\\lambda$ 是与约束 $a \\le x$ 相关联的拉格朗日乘子，$\\mu$ 是与约束 $x \\le b$ 相关联的拉格朗日乘子。将 $g(\\lambda, \\mu)$ 的答案表示为参数 $a, b, c$ 以及对偶变量 $\\lambda, \\mu$ 的函数。", "solution": "我们将约束重写为标准不等式形式 $g_{1}(x) = a - x \\le 0$ 和 $g_{2}(x) = x - b \\le 0$。为 $g_{1}$ 关联拉格朗日乘子 $\\lambda \\ge 0$，为 $g_{2}$ 关联拉格朗日乘子 $\\mu \\ge 0$。拉格朗日函数为\n$$\nL(x,\\lambda,\\mu) = c x^{2} + \\lambda(a - x) + \\mu(x - b) = c x^{2} + (\\mu - \\lambda)x + \\lambda a - \\mu b.\n$$\n对偶函数为 $g(\\lambda,\\mu) = \\inf_{x \\in \\mathbb{R}} L(x,\\lambda,\\mu)$。因为 $c > 0$，$L$ 是关于 $x$ 的严格凸函数。其极小点满足一阶条件\n$$\n\\frac{\\partial L}{\\partial x} = 2 c x + (\\mu - \\lambda) = 0 \\quad \\Rightarrow \\quad x^{\\ast} = \\frac{\\lambda - \\mu}{2 c}.\n$$\n将 $x^{\\ast}$ 代入 $L$ 得到\n$$\ng(\\lambda,\\mu) = c \\left(\\frac{\\lambda - \\mu}{2 c}\\right)^{2} + (\\mu - \\lambda)\\left(\\frac{\\lambda - \\mu}{2 c}\\right) + \\lambda a - \\mu b = - \\frac{(\\mu - \\lambda)^{2}}{4 c} + \\lambda a - \\mu b,\n$$\n此式在 $\\lambda \\ge 0$ 且 $\\mu \\ge 0$ 时成立。", "answer": "$$\\boxed{-\\frac{(\\mu - \\lambda)^{2}}{4 c} + \\lambda a - \\mu b}$$", "id": "2167425"}, {"introduction": "在学会构建对偶问题之后，下一步自然是利用它来求解最优点。本练习将引入拉格朗日函数的“鞍点”（saddle point）概念，它恰好对应着原始问题和对偶问题的解。通过一个带约束的简单问题，你将练习运用卡罗需-库恩-塔克（Karush-Kuhn-Tucker, KKT）条件来寻找这个鞍点，从而将原始变量 $x^*$ 与其对应的对偶变量 $\\lambda^*$ 联系起来。[@problem_id:2167418]", "problem": "在一个简化的机器学习场景中，与模型参数 $x$ 相关的代价由二次函数 $f(x) = \\frac{1}{2}x^2$ 描述。为防止欠拟合并确保模型具有最低程度的复杂度，一位领域专家施加了约束，要求参数 $x$ 必须至少为 2。这导出了一个约束优化问题。\n\n该问题的拉格朗日函数定义为 $L(x, \\lambda) = f(x) + \\lambda g(x)$，其中 $g(x) \\le 0$ 表示不等式约束，$\\lambda \\ge 0$ 是拉格朗日乘子。\n\n你的任务是找到拉格朗日函数的鞍点 $(x^*, \\lambda^*)$。该点对应于在约束条件下最小化代价函数的最优参数值 $x^*$，以及相关的最优拉格朗日乘子 $\\lambda^*$。\n\n请将鞍点以有序对 $(x^*, \\lambda^*)$ 的形式报告。", "solution": "给定凸二次目标函数 $f(x) = \\frac{1}{2}x^{2}$ 和不等式约束 $x \\geq 2$。为将其表示为标准形式 $g(x) \\leq 0$，定义 $g(x) = 2 - x$，因此约束为 $g(x) \\leq 0$。拉格朗日函数为\n$$\nL(x, \\lambda) = \\frac{1}{2}x^{2} + \\lambda(2 - x),\n$$\n其中对偶可行性要求 $\\lambda \\geq 0$。\n\n对于具有仿射约束的凸问题，Karush–Kuhn–Tucker (KKT) 条件是确定最优性和刻画鞍点的充要条件。KKT 条件包括：\n- 原始可行性：$g(x^{*}) \\leq 0$，即 $x^{*} \\geq 2$。\n- 对偶可行性：$\\lambda^{*} \\geq 0$。\n- 驻点条件：$\\frac{\\partial L}{\\partial x}(x^{*}, \\lambda^{*}) = 0$。\n- 互补松弛性：$\\lambda^{*} g(x^{*}) = 0$。\n\n计算驻点条件：\n$$\n\\frac{\\partial L}{\\partial x} = x - \\lambda \\quad \\Rightarrow \\quad x^{*} - \\lambda^{*} = 0 \\quad \\Rightarrow \\quad x^{*} = \\lambda^{*}.\n$$\n应用互补松弛性：\n$$\n\\lambda^{*}(2 - x^{*}) = 0.\n$$\n分情况讨论：\n- 如果 $\\lambda^{*} = 0$，那么根据驻点条件有 $x^{*} = 0$，这违反了原始可行性 $x^{*} \\geq 2$；排除此情况。\n- 因此 $2 - x^{*} = 0 \\Rightarrow x^{*} = 2$。然后根据驻点条件有 $\\lambda^{*} = x^{*} = 2$，这满足 $\\lambda^{*} \\geq 0$ 和 $x^{*} \\geq 2$。\n\n因此，唯一的 KKT 点是 $(x^{*}, \\lambda^{*}) = (2, 2)$。因为该问题是具有仿射约束的凸问题，所以这个 KKT 点就是拉格朗日函数的鞍点。等价地，验证鞍点性质：$L(x, 2)$ 在 $x = 2$ 处取得最小值，并且对于所有 $\\lambda \\geq 0$ 都有 $L(2, \\lambda) = 2$，其对偶最大化点在 $\\lambda^{*} = 2$。", "answer": "$$\\boxed{\\begin{pmatrix} 2 & 2 \\end{pmatrix}}$$", "id": "2167418"}, {"introduction": "现在，是时候将你所学的知识应用到更真实、涉及多个变量和多种约束类型的场景中了。这个问题要求你在一个等式约束和一个不等式约束下，最小化一个成本函数，这在工程和资源分配问题中非常常见。解决这个问题将巩固你对如何运用拉格朗日框架和KKT条件来处理复杂优化问题的理解。[@problem_id:2167392]", "problem": "考虑一个由两个相互作用的组件组成的系统，其状态由变量 $x_1$ 和 $x_2$ 描述。系统的运行成本是这些状态的函数，由 $C(x_1, x_2) = (x_1 - 4)^2 + (x_2 - 3)^2$ 给出。该系统受两个运行约束的制约。首先，一个严格的资源共享协议要求状态之和等于一个常数值，即 $x_1 + x_2 = 5$。其次，一项安全规定对组合状态的大小施加了限制，要求状态的平方和不超过阈值 $M=13$，即 $x_1^2 + x_2^2 \\le 13$。\n\n你的任务是确定最优状态 $(x_1^*, x_2^*)$，使运行成本 $C(x_1, x_2)$ 在满足两个约束条件的情况下最小化。\n\n将你的答案表示为 $\\begin{pmatrix} x_1^* & x_2^* \\end{pmatrix}$ 形式的行矩阵。", "solution": "我们在凸约束条件下最小化凸二次成本函数。由于可行集是仿射集 $x_{1}+x_{2}=5$ 与圆盘 $x_{1}^{2}+x_{2}^{2}\\leq 13$ 的交集，因此它是凸且非空的。在仿射集上使成本最小且位于圆盘内的点，就是全局最小值点。\n\n首先，我们使用拉格朗日乘子 $\\lambda$ 来最小化 $C(x_{1},x_{2})=(x_{1}-4)^{2}+(x_{2}-3)^{2}$，约束条件为等式 $x_{1}+x_{2}=5$。定义\n$$\nL(x_{1},x_{2},\\lambda)=(x_{1}-4)^{2}+(x_{2}-3)^{2}+\\lambda(x_{1}+x_{2}-5).\n$$\n平稳性条件和可行性条件给出\n$$\n\\frac{\\partial L}{\\partial x_{1}}=2(x_{1}-4)+\\lambda=0,\\quad \\frac{\\partial L}{\\partial x_{2}}=2(x_{2}-3)+\\lambda=0,\\quad \\frac{\\partial L}{\\partial \\lambda}=x_{1}+x_{2}-5=0.\n$$\n将前两个方程相减可得\n$$\n2(x_{1}-4)-2(x_{2}-3)=0 \\;\\;\\Rightarrow\\;\\; x_{1}-x_{2}=1.\n$$\n结合 $x_{1}+x_{2}=5$，求解可得\n$$\nx_{1}=\\frac{(x_{1}+x_{2})+(x_{1}-x_{2})}{2}=\\frac{5+1}{2}=3,\\quad x_{2}=\\frac{(x_{1}+x_{2})-(x_{1}-x_{2})}{2}=\\frac{5-1}{2}=2.\n$$\n现在检验不等式约束：\n$$\nx_{1}^{2}+x_{2}^{2}=3^{2}+2^{2}=9+4=13\\leq 13,\n$$\n因此 $(3,2)$ 对两个约束都可行。\n\n由于目标函数是严格凸的，且可行集是凸的，KKT 条件是全局最优性的充分条件。点 $(3,2)$ 同样满足完整问题的 KKT 条件，例如当不等式乘子 $\\mu=0$ 时：\n- 完整拉格朗日函数 $L=(x_{1}-4)^{2}+(x_{2}-3)^{2}+\\lambda(x_{1}+x_{2}-5)+\\mu(x_{1}^{2}+x_{2}^{2}-13)$ 的平稳性条件：当 $\\mu=0$ 时，该条件化简为仅含等式约束的情况，并由点 $(3,2)$ 满足。\n- 原始可行性成立：$x_{1}+x_{2}=5$ 且 $x_{1}^{2}+x_{2}^{2}-13=0\\leq 0$。\n- 互补松弛性成立：$\\mu(x_{1}^{2}+x_{2}^{2}-13)=0$。\n- 对偶可行性成立：$\\mu=0\\geq 0$。\n\n因此，唯一的最优状态是 $(x_{1}^{*},x_{2}^{*})=(3,2)$。", "answer": "$$\\boxed{\\begin{pmatrix} 3 & 2 \\end{pmatrix}}$$", "id": "2167392"}]}