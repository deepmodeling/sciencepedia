{"hands_on_practices": [{"introduction": "狗腿法建立在两个关键步长的基础上。首先是牛顿步 $p_N$，它代表了目标函数局部二次模型的无约束最小点。本练习将让你实践计算这个基本向量，如果二次模型在任何距离上都完全准确，它将指向理想的最小值。掌握这一计算是理解完整狗腿路径的第一步。[@problem_id:2212755]", "problem": "在信赖域优化算法中，于当前迭代点，目标函数被一个形如 $m(p) = f + g^T p + \\frac{1}{2} p^T B p$ 的二次模型所近似。该模型描述了从当前点移动一个步长 $p$ 时目标函数的变化。在许多信赖域策略（例如狗腿法）中，一个关键组成部分是牛顿步，即该二次模型的无约束极小值点。\n\n给定梯度向量 $g = \\begin{pmatrix} -4 \\\\ 6 \\end{pmatrix}$ 和一个正定Hessian近似矩阵 $B = \\begin{pmatrix} 2  0 \\\\ 0  3 \\end{pmatrix}$，计算该二次模型的牛顿步 $p_N$。", "solution": "牛顿步是二次模型 $m(p) = f + g^{T} p + \\frac{1}{2} p^{T} B p$ 的无约束极小值点。对于一个对称正定的 $B$，通过将关于 $p$ 的梯度设为零，可得到一阶最优性条件：\n$$\n\\nabla m(p) = g + B p = 0.\n$$\n这导出了线性系统\n$$\nB p_{N} = -g,\n$$\n因此牛顿步为\n$$\np_{N} = -B^{-1} g.\n$$\n给定 $g = \\begin{pmatrix} -4 \\\\ 6 \\end{pmatrix}$ 和 $B = \\begin{pmatrix} 2  0 \\\\ 0  3 \\end{pmatrix}$，其逆矩阵为\n$$\nB^{-1} = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{3} \\end{pmatrix}.\n$$\n因此，\n$$\nB^{-1} g = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{3} \\end{pmatrix} \\begin{pmatrix} -4 \\\\ 6 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 2 \\end{pmatrix},\n$$\n且\n$$\np_{N} = - \\begin{pmatrix} -2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -2 \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 2 \\\\ -2 \\end{pmatrix}}$$", "id": "2212755"}, {"introduction": "虽然牛顿步指向理想的最小值，但在我们的信赖域内它并不总是一个有效的移动。柯西点 $p_U$ 通过在最速下降方向上寻找最小值，提供了一个有保障的安全步长。本练习将指导你计算柯西点，这是一项关键技能，它涉及考虑信赖域边界 $\\Delta$，并构成了狗腿路径的第一“段”。[@problem_id:2212704]", "problem": "在数值优化领域，信赖域方法是一类用于求解非线性规划问题的算法。这些方法通过在当前点 $x_k$ 周围半径为 $\\Delta$ 的“信赖域”内最小化真实目标函数的模型函数 $m(p)$，来迭代地寻找一个步长 $p$。该模型通常是一个二次近似：\n$$m(p) = f(x_k) + g^T p + \\frac{1}{2} p^T B p$$\n其中 $g$ 是目标函数在 $x_k$ 处的梯度，而 $B$ 是对Hessian矩阵的一个近似。\n\n许多信赖域算法（如狗腿法）的一个基本组成部分是计算柯西点 $p_U$。柯西点被定义为在最速下降方向上使二次模型 $m(p)$ 最小化的向量，同时受步长位于信赖域内（即 $\\|p\\| \\le \\Delta$）的约束。\n\n考虑一个优化问题，在当前迭代点，梯度为 $g = \\begin{pmatrix} 3 \\\\ -4 \\end{pmatrix}$，Hessian近似为单位矩阵 $B = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。信赖域半径设为 $\\Delta = 4$。\n\n为此场景计算柯西点 $p_U$。您的答案应该是一个包含精确分数的2x1列向量。", "solution": "问题要求计算柯西点 $p_U$，它是以下约束优化问题的解：\n$$ \\min_{p} \\quad m(p) = f(x_k) + g^T p + \\frac{1}{2} p^T B p $$\n$$ \\text{subject to} \\quad p = -\\tau g \\text{ for some } \\tau \\ge 0, \\quad \\text{and} \\quad \\|p\\| \\le \\Delta $$\n\n搜索方向是最速下降方向 $d = -g$。这个方向上的任意点都可以参数化为 $p(\\tau) = -\\tau g$，其中标量 $\\tau \\ge 0$。\n\n首先，我们将其代入二次模型 $m(p)$ 中，得到一个单变量 $\\tau$ 的函数：\n$$ \\phi(\\tau) = m(-\\tau g) = f(x_k) + g^T(-\\tau g) + \\frac{1}{2} (-\\tau g)^T B (-\\tau g) $$\n$$ \\phi(\\tau) = f(x_k) - \\tau (g^T g) + \\frac{1}{2} \\tau^2 (g^T B g) $$\n常数项 $f(x_k)$ 不影响最小化子，因此我们可以专注于最小化与 $\\tau$ 相关的部分。\n\n接下来，我们将信赖域约束 $\\|p\\| \\le \\Delta$ 转换为对 $\\tau$ 的约束：\n$$ \\|p(\\tau)\\| = \\|-\\tau g\\| = |\\tau| \\|g\\| = \\tau \\|g\\| \\le \\Delta $$\n因为我们在下降方向上寻找步长，所以 $\\tau \\ge 0$。因此，对 $\\tau$ 的约束是：\n$$ 0 \\le \\tau \\le \\frac{\\Delta}{\\|g\\|} $$\n\n现在，我们通过对 $\\phi(\\tau)$ 求关于 $\\tau$ 的导数并将其设为零，来找到该二次函数的无约束最小化子。这将为我们提供在没有信赖域约束情况下的最优步长 $\\tau^*$。\n$$ \\frac{d\\phi}{d\\tau} = -g^T g + \\tau (g^T B g) = 0 $$\n解出 $\\tau$，我们得到：\n$$ \\tau^* = \\frac{g^T g}{g^T B g} $$\n二阶导数为 $\\frac{d^2\\phi}{d\\tau^2} = g^T B g$。如果它为正，我们就找到了一个极小值。\n\n让我们使用给定值计算所需量：\n$g = \\begin{pmatrix} 3 \\\\ -4 \\end{pmatrix}$，$B = I = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$，以及 $\\Delta = 4$。\n\n1.  计算 $g^T g$：\n    $g^T g = (3)(3) + (-4)(-4) = 9 + 16 = 25$。\n\n2.  计算 $\\|g\\|$：\n    $\\|g\\| = \\sqrt{g^T g} = \\sqrt{25} = 5$。\n\n3.  计算 $g^T B g$：\n    由于 $B=I$，$g^T B g = g^T I g = g^T g = 25$。\n\n二阶导数 $g^T B g = 25  0$，所以 $\\phi(\\tau)$ 是一个凸抛物线，其无约束极小值确实在 $\\tau^*$ 处。\n\n4.  计算无约束最优步长 $\\tau^*$：\n    $$ \\tau^* = \\frac{g^T g}{g^T B g} = \\frac{25}{25} = 1 $$\n\n5.  确定 $\\tau$ 的可行区间：\n    约束为 $0 \\le \\tau \\le \\frac{\\Delta}{\\|g\\|}$。\n    $$ \\frac{\\Delta}{\\|g\\|} = \\frac{4}{5} = 0.8 $$\n    所以，$\\tau$ 的可行区间是 $[0, 0.8]$。\n\n6.  找到约束最优步长 $\\tau_U$。无约束最小化子 $\\tau^* = 1$ 位于可行区间 $[0, 0.8]$ 之外。由于 $\\phi(\\tau)$ 是一个在 $\\tau=1$ 处取得极小值的凸抛物线，因此在区间 $[0, 0.8]$ 上，$\\phi(\\tau)$ 的最小值必然出现在离 $\\tau=1$ 最近的边界点上。这个点是 $\\tau = 0.8$。\n    因此，柯西点的步长为 $\\tau_U = \\frac{\\Delta}{\\|g\\|} = \\frac{4}{5}$。\n\n7.  计算柯西点 $p_U$：\n    $$ p_U = -\\tau_U g = -\\frac{4}{5} \\begin{pmatrix} 3 \\\\ -4 \\end{pmatrix} = \\begin{pmatrix} -12/5 \\\\ 16/5 \\end{pmatrix} $$\n\n柯西点是 $p_U = \\begin{pmatrix} -12/5 \\\\ 16/5 \\end{pmatrix}$。我们来验证它的范数：$\\|p_U\\| = \\sqrt{(-12/5)^2 + (16/5)^2} = \\sqrt{\\frac{144+256}{25}} = \\sqrt{\\frac{400}{25}} = \\sqrt{16} = 4$，这与信赖域半径 $\\Delta$ 完全相等，符合预期。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} -\\frac{12}{5} \\\\ \\frac{16}{5} \\end{pmatrix}\n}\n$$", "id": "2212704"}, {"introduction": "狗腿法的威力在于它能够在安全的柯西点 $p_U$ 和最优的牛顿步 $p_N$ 之间进行插值。这个最后的练习将所有内容整合在一起，挑战你在牛顿步长超出信赖域时确定最终的试验步长。你将练习构建“狗腿”路径并找到其与信赖域边界的交点，这是实现此优化算法的核心技能。[@problem_id:2212758]", "problem": "在数值优化中求解信赖域子问题的背景下，狗腿法 (dogleg method) 是一种求解近似解的常用技术。该方法通过遵循一条由两个关键向量定义的路径来构造试验步 $p$：即 Cauchy 点 $p_U$（沿最速下降方向的极小化子）和 Newton 点 $p_N$（二次模型的无约束极小化子）。该路径由一条从原点到 $p_U$ 的线段，以及随后一条从 $p_U$ 到 $p_N$ 的线段组成。最终的狗腿步 $p$ 是该路径上距离原点最远，但仍位于信赖域（一个半径为 $\\Delta$ 的球体）内的点。\n\n考虑一个优化算法的某次特定迭代，其中 Cauchy 点和 Newton 点由向量 $p_U = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $p_N = \\begin{pmatrix} 4 \\\\ 4 \\end{pmatrix}$ 分别给出。本次迭代的信赖域半径为 $\\Delta = 3$。\n\n确定狗腿步向量 $p$。请以具有精确分量的列向量形式给出答案。", "solution": "给定 $p_{U}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$，$p_{N}=\\begin{pmatrix}4 \\\\ 4\\end{pmatrix}$，以及信赖域半径 $\\Delta=3$。计算范数：\n$$\n\\|p_{U}\\|=\\sqrt{1^{2}+1^{2}}=\\sqrt{2},\\quad \\|p_{N}\\|=\\sqrt{4^{2}+4^{2}}=4\\sqrt{2}.\n$$\n由于 $\\|p_{U}\\|\\Delta\\|p_{N}\\|$，狗腿步位于从 $p_{U}$ 到 $p_{N}$ 的线段上，且其范数恰好为 $\\Delta$。将第二段参数化为\n$$\np(\\tau)=p_{U}+\\tau\\,(p_{N}-p_{U}),\\quad \\tau\\in[0,1],\n$$\n其中 $p_{N}-p_{U}=\\begin{pmatrix}3 \\\\ 3\\end{pmatrix}$。则\n$$\np(\\tau)=\\begin{pmatrix}1+3\\tau \\\\ 1+3\\tau\\end{pmatrix},\\quad \\|p(\\tau)\\|^{2}=2\\,(1+3\\tau)^{2}.\n$$\n施加信赖域边界条件 $\\|p(\\tau)\\|=\\Delta$：\n$$\n2\\,(1+3\\tau)^{2}=9\\;\\Rightarrow\\;(1+3\\tau)^{2}=\\frac{9}{2}\\;\\Rightarrow\\;1+3\\tau=\\frac{3}{\\sqrt{2}},\n$$\n其中因为 $\\tau\\geq 0$ 所以取正根。因此\n$$\n3\\tau=\\frac{3}{\\sqrt{2}}-1\\;\\Rightarrow\\;\\tau=\\frac{1}{\\sqrt{2}}-\\frac{1}{3},\n$$\n该值在 $[0,1]$ 区间内。所以\n$$\np=p(\\tau)=\\begin{pmatrix}1+3\\tau \\\\ 1+3\\tau\\end{pmatrix}=\\begin{pmatrix}\\frac{3}{\\sqrt{2}} \\\\ \\frac{3}{\\sqrt{2}}\\end{pmatrix}.\n$$\n等价地，分母有理化后得到 $p=\\begin{pmatrix}\\frac{3\\sqrt{2}}{2} \\\\ \\frac{3\\sqrt{2}}{2}\\end{pmatrix}$。两种形式均为精确解。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{3\\sqrt{2}}{2} \\\\ \\frac{3\\sqrt{2}}{2}\\end{pmatrix}}$$", "id": "2212758"}]}