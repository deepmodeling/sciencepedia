{"hands_on_practices": [{"introduction": "在我们深入研究偏微分方程之前，让我们通过一个更简单的例子——常微分方程（ODE）——来热身。这个练习将向您展示后向欧拉法的核心思想，即如何在一个简单的物理模型（如牛顿冷却定律）中，通过求解一个代数方程来隐式地计算下一个时间步的状态。掌握这项基本技能对于理解更复杂的隐式格式至关重要。[@problem_id:2178879]", "problem": "计算机的中央处理器 (CPU) 在执行密集任务时会发热。任务完成后，它开始冷却。冷却过程遵循牛顿冷却定律。设 $T(t)$ 为 CPU 在时间 $t$ 的温度，设 $T_a$ 为恒定的室内环境温度。CPU 温度的变化率由以下微分方程描述：\n$$ \\frac{dT}{dt} = -k(T(t) - T_a) $$\n其中 $k$ 是一个由冷却系统效率决定的正常数。\n\n为了预测未来的温度，我们使用一个具有恒定时间步长 $\\Delta t$ 的数值近似方法。设 $T_n$ 表示在时间 $t_n = n \\Delta t$ 时温度的数值近似值。\n\n通过对给定的微分方程应用后向欧拉法，推导下一个时间步的温度 $T_{n+1}$ 关于当前温度 $T_n$、环境温度 $T_a$、冷却常数 $k$ 和时间步长 $\\Delta t$ 的显式表达式。", "solution": "我们从写成一阶常微分方程形式的牛顿冷却定律开始：\n$$\n\\frac{dT}{dt}=-k\\big(T(t)-T_{a}\\big)\n$$\n设 $t_{n}=n\\Delta t$ 且 $T_{n}$ 是 $T(t_{n})$ 的近似值。后向欧拉法使用隐式更新\n$$\nT_{n+1}=T_{n}+\\Delta t\\,f\\big(t_{n+1},T_{n+1}\\big)\n$$\n此处的右端函数为 $f(t,T)=-k\\big(T-T_{a}\\big)$。将其代入后向欧拉更新公式可得\n$$\nT_{n+1}=T_{n}+\\Delta t\\left[-k\\big(T_{n+1}-T_{a}\\big)\\right]\n$$\n展开并在左侧合并包含 $T_{n+1}$ 的项，得到\n$$\nT_{n+1}+k\\Delta t\\,T_{n+1}=T_{n}+k\\Delta t\\,T_{a}\n$$\n提取 $T_{n+1}$ 并求解其显式表达式，可得\n$$\n(1+k\\Delta t)\\,T_{n+1}=T_{n}+k\\Delta t\\,T_{a}\n\\quad\\Longrightarrow\\quad\nT_{n+1}=\\frac{T_{n}+k\\Delta t\\,T_{a}}{1+k\\Delta t}\n$$\n这就表示了下一个时间步的温度关于 $T_{n}$、$T_{a}$、$k$ 和 $\\Delta t$ 的表达式。", "answer": "$$\\boxed{\\frac{T_{n}+k\\Delta t\\,T_{a}}{1+k\\Delta t}}$$", "id": "2178879"}, {"introduction": "现在，我们将隐式方法的思想从常微分方程推广到本文的核心主题：抛物型偏微分方程（PDE）。通过对一维热传导方程应用后向欧拉法，您将学习如何将连续的 PDE 转化为一个离散的线性方程组。这个练习的重点是推导描述内部网格点关系的代数表达式，这是构建求解整个系统矩阵的第一步。[@problem_id:2178886]", "problem": "考虑一维热传导方程，这是一种偏微分方程 (PDE)，其形式为 $u_t = \\alpha u_{xx}$，其中 $u(x,t)$ 是温度，$t$ 是时间，$x$ 是空间坐标，$\\alpha$ 是热扩散系数。我们希望在一个空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上数值求解该方程。令 $U_j^n$ 表示 $u(j\\Delta x, n\\Delta t)$ 的数值近似值。\n\n后向欧拉法对时间导数使用前向差分，对空间导数使用中心差分，其关键特征是空间导数在未来的时间层 $n+1$ 上进行计算。这会得到一个隐式格式，该格式可以写成一个代数关系，联系了新时间层 $n+1$ 上三个相邻空间点 ($j-1, j, j+1$) 的温度值与旧时间层 $n$ 上单一点 $j$ 的温度。\n\n对于一个内部网格点 $j$，这个代数方程组可以表示为：\n$$A \\cdot U_{j-1}^{n+1} + B \\cdot U_j^{n+1} + C \\cdot U_{j+1}^{n+1} = U_j^n$$\n其中系数 $A$、$B$ 和 $C$ 取决于网格傅里叶数，其定义为 $\\mu = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。\n\n确定此格式的正确系数集 $(A, B, C)$。\n\nA. $(-\\mu, 1+2\\mu, -\\mu)$\n\nB. $(\\mu, 1-2\\mu, \\mu)$\n\nC. $(-\\mu, 1-2\\mu, -\\mu)$\n\nD. $(-\\mu, 2\\mu, -\\mu)$\n\nE. $(\\mu, 1+2\\mu, \\mu)$", "solution": "我们在均匀网格上离散化热传导方程 $u_{t}=\\alpha u_{xx}$，并有 $U_{j}^{n}\\approx u(j\\Delta x,n\\Delta t)$。在后向欧拉法中，我们使用以下公式来近似新时间层上的时间导数\n$$\nu_{t}(x_{j},t_{n+1})\\approx \\frac{U_{j}^{n+1}-U_{j}^{n}}{\\Delta t}\n$$\n并使用中心差分来近似同一新时间层上的空间二阶导数\n$$\nu_{xx}(x_{j},t_{n+1})\\approx \\frac{U_{j-1}^{n+1}-2U_{j}^{n+1}+U_{j+1}^{n+1}}{(\\Delta x)^{2}}\n$$\n将这些近似代入偏微分方程得到\n$$\n\\frac{U_{j}^{n+1}-U_{j}^{n}}{\\Delta t}=\\alpha\\,\\frac{U_{j-1}^{n+1}-2U_{j}^{n+1}+U_{j+1}^{n+1}}{(\\Delta x)^{2}}\n$$\n两边同乘以 $\\Delta t$ 并定义网格傅里叶数 $\\mu=\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}$，我们得到\n$$\nU_{j}^{n+1}-U_{j}^{n}=\\mu\\left(U_{j-1}^{n+1}-2U_{j}^{n+1}+U_{j+1}^{n+1}\\right)\n$$\n重新整理，将所有在时间层 $n+1$ 的未知数收集到左侧，可得\n$$\n-\\mu\\,U_{j-1}^{n+1}+\\left(1+2\\mu\\right)U_{j}^{n+1}-\\mu\\,U_{j+1}^{n+1}=U_{j}^{n}\n$$\n因此，在方程\n$$\nA\\cdot U_{j-1}^{n+1}+B\\cdot U_{j}^{n+1}+C\\cdot U_{j+1}^{n+1}=U_{j}^{n}\n$$\n中的系数为 $A=-\\mu$，$B=1+2\\mu$ 和 $C=-\\mu$，这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "2178886"}, {"introduction": "一个数值模拟的真正挑战往往在于如何正确处理边界条件。这个练习将带您超越理想化的内部点，处理更接近实际情况的混合边界条件，即一端绝热（Neumann 条件），另一端维持恒定温度（Dirichlet 条件）。您需要将边界条件整合到离散格式中，并构建描述整个系统未知数的线性系统矩阵，这是求解实际工程和物理问题的关键一步。[@problem_id:2178863]", "problem": "考虑一个模拟长度为 $L$ 的细杆中一维热扩散的问题。杆上的温度分布 $T(x, t)$ 由热传导方程控制，这是一种抛物线型偏微分方程 (PDE)：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} \\quad \\text{for } x \\in [0, L], t \\ge 0 $$\n其中 $\\alpha$ 是材料的热扩散系数。\n\n边界条件如下：\n- 在左端 ($x=0$)，杆是完全绝热的，意味着没有热通量：$\\frac{\\partial T}{\\partial x}(0, t) = 0$。\n- 在右端 ($x=L$)，温度保持恒定值 $T_L$：$T(L, t) = T_L$。\n\n为了对此问题进行数值求解，将区域离散化为 $N$ 个长度为 $\\Delta x = L/N$ 的相等线段，从而产生 $N+1$ 个网格点，索引从 $i=0$ 到 $i=N$，其中 $x_i = i \\Delta x$。在网格点 $i$ 和时间步长 $n$ 处的温度记为 $T_i^n$。\n\n系统的时间演化采用后向 Euler (完全隐式) 方法处理时间导数，并采用二阶中心差分格式处理空间导数。这种离散化在每个时间步将偏微分方程转换为一个线性方程组，可以表示为矩阵形式 $A \\mathbf{T}^{n+1} = \\mathbf{b}$，其中 $\\mathbf{T}^{n+1}$ 是下一个时间步的未知温度向量。\n\n对于 $N=4$ 的离散化，未知量向量为 $\\mathbf{T}^{n+1} = [T_0^{n+1}, T_1^{n+1}, T_2^{n+1}, T_3^{n+1}]^T$。设 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ 为无量纲扩散数，其中 $\\Delta t$ 是时间步长。\n\n下列哪个矩阵代表线性系统 $A \\mathbf{T}^{n+1} = \\mathbf{b}$ 中的矩阵 $A$？\n\nA.\n$$ \\begin{pmatrix} 1+2r & -2r & 0 & 0 \\\\ -r & 1+2r & -r & 0 \\\\ 0 & -r & 1+2r & -r \\\\ 0 & 0 & -r & 1+2r \\end{pmatrix} $$\n\nB.\n$$ \\begin{pmatrix} 1+2r & -2r & 0 & 0 \\\\ -r & 1+2r & -r & 0 \\\\ 0 & -r & 1+2r & -r \\\\ 0 & 0 & -2r & 1+2r \\end{pmatrix} $$\n\nC.\n$$ \\begin{pmatrix} 1+2r & -r & 0 & 0 \\\\ -r & 1+2r & -r & 0 \\\\ 0 & -r & 1+2r & -r \\\\ 0 & 0 & -r & 1+2r \\end{pmatrix} $$\n\nD.\n$$ \\begin{pmatrix} 1-2r & 2r & 0 & 0 \\\\ r & 1-2r & r & 0 \\\\ 0 & r & 1-2r & r \\\\ 0 & 0 & r & 1-2r \\end{pmatrix} $$\n\nE.\n$$ \\begin{pmatrix} 1+2r & -2r & 0 & 0 \\\\ -r & 1+r & -r & 0 \\\\ 0 & -r & 1+r & -r \\\\ 0 & 0 & -r & 1+r \\end{pmatrix} $$", "solution": "我们从热扩散系数为 $\\alpha$ 的一维热传导方程开始：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^{2} T}{\\partial x^{2}}\n$$\n用网格点 $x_{i} = i \\Delta x$（$i=0,1,2,3,4$）来离散化空间，其中 $\\Delta x = L/N$ 且 $N=4$。设 $T_{i}^{n}$ 表示在节点 $i$ 和时间层 $n$ 的温度。对时间采用后向 Euler 格式，对空间采用二阶中心差分，对于每个使用中心差分来近似拉普拉斯算子的节点，我们得到：\n$$\n\\frac{T_{i}^{n+1} - T_{i}^{n}}{\\Delta t} = \\alpha \\frac{T_{i+1}^{n+1} - 2 T_{i}^{n+1} + T_{i-1}^{n+1}}{(\\Delta x)^{2}}\n$$\n引入无量纲参数 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^{2}}$ 并整理，对内部节点可得：\n$$\n-r\\, T_{i-1}^{n+1} + (1+2r)\\, T_{i}^{n+1} - r\\, T_{i+1}^{n+1} = T_{i}^{n}\n$$\n边界条件：\n- 在 $x=0$ (节点 $i=0$) 处，Neumann 条件为 $\\frac{\\partial T}{\\partial x}(0,t)=0$。使用二阶虚拟点公式，\n$$\n\\frac{T_{1}^{n+1} - T_{-1}^{n+1}}{2\\Delta x} = 0 \\quad \\Rightarrow \\quad T_{-1}^{n+1} = T_{1}^{n+1}\n$$\n那么在 $i=0$ 处的二阶导数变为\n$$\n\\frac{T_{1}^{n+1} - 2 T_{0}^{n+1} + T_{-1}^{n+1}}{(\\Delta x)^{2}} = \\frac{2(T_{1}^{n+1} - T_{0}^{n+1})}{(\\Delta x)^{2}}\n$$\n在 $i=0$ 处应用后向 Euler 方法，得到\n$$\n\\frac{T_{0}^{n+1} - T_{0}^{n}}{\\Delta t} = \\alpha \\frac{2(T_{1}^{n+1} - T_{0}^{n+1})}{(\\Delta x)^{2}}\n\\;\\;\\Rightarrow\\;\\;\n(1+2r)\\, T_{0}^{n+1} - 2r\\, T_{1}^{n+1} = T_{0}^{n}\n$$\n- 在 $x=L$ (节点 $i=4$) 处，Dirichlet 条件为 $T_{4}^{n+1} = T_{L}$，所以 $T_{4}^{n+1}$ 是已知的，不属于未知向量的一部分。\n\n对于未知向量 $\\mathbf{T}^{n+1} = [T_{0}^{n+1}, T_{1}^{n+1}, T_{2}^{n+1}, T_{3}^{n+1}]^{T}$，当 $i=1,2$ 时，方程为\n$$\n-r\\, T_{0}^{n+1} + (1+2r)\\, T_{1}^{n+1} - r\\, T_{2}^{n+1} = T_{1}^{n}\n$$\n$$\n- r\\, T_{1}^{n+1} + (1+2r)\\, T_{2}^{n+1} - r\\, T_{3}^{n+1} = T_{2}^{n}\n$$\n对于 $i=3$ (与 Dirichlet 边界相邻)，\n$$\n- r\\, T_{2}^{n+1} + (1+2r)\\, T_{3}^{n+1} - r\\, T_{4}^{n+1} = T_{3}^{n}\n\\;\\;\\Rightarrow\\;\\;\n- r\\, T_{2}^{n+1} + (1+2r)\\, T_{3}^{n+1} = T_{3}^{n} + r\\, T_{L}\n$$\n因此，作用于 $\\mathbf{T}^{n+1}$ 的系数矩阵 $A$ 的各行对应这四个方程中 $[T_{0}^{n+1}, T_{1}^{n+1}, T_{2}^{n+1}, T_{3}^{n+1}]$ 的系数：\n$$\nA =\n\\begin{pmatrix}\n1+2r & -2r & 0 & 0 \\\\\n- r & 1+2r & - r & 0 \\\\\n0 & - r & 1+2r & - r \\\\\n0 & 0 & - r & 1+2r\n\\end{pmatrix}\n$$\n与选项比较，这与选项 A 匹配。", "answer": "$$\\boxed{A}$$", "id": "2178863"}]}