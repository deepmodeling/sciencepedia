{"hands_on_practices": [{"introduction": "在使用谱方法求解偏微分方程时，第一步通常是将问题中的函数（例如初始条件）表示为一系列基函数的和。这个过程将问题从物理空间转换到谱空间，从而极大地简化了计算。本练习将通过一个具体例子，带你实践如何为一个定义在 $[0, 1]$ 区间上的“帐篷”函数计算其傅里叶正弦级数的系数 [@problem_id:2204923]，这是掌握傅里叶谱方法基本技能的关键一步。", "problem": "在物理系统的分析中，例如弦的振动或杆中的热传导，将初始状态表示为一系列正弦函数通常很有用。这种方法是使用谱方法求解偏微分方程的基础。\n\n考虑一个定义在区间 $x \\in [0, 1]$ 上的函数 $f(x)$。该函数描述了一个初始剖面，其分段定义如下：\n$$\nf(x) = \\begin{cases} \n2x  \\text{for } 0 \\le x \\le 1/2 \\\\\n2(1-x)  \\text{for } 1/2  x \\le 1 \n\\end{cases}\n$$\n该函数可以用其在区间 $[0, 1]$ 上的傅里叶正弦级数表示，其形式如下：\n$$\nf(x) = \\sum_{n=1}^{\\infty} b_n \\sin(n\\pi x)\n$$\n求出该级数展开式中前三个非零系数 $b_n$ 的精确值。将答案表示为一个包含这三个系数的行矩阵，并按其索引 $n$ 的升序排列。", "solution": "对于 $[0,1]$ 上的傅里叶正弦级数，其系数由 $\\{\\sin(n\\pi x)\\}_{n\\ge 1}$ 的正交性给出：\n$$\nb_{n} = 2 \\int_{0}^{1} f(x)\\,\\sin(n\\pi x)\\,dx.\n$$\n根据给定的分段函数 $f(x)$，将积分拆分为：\n$$\nb_{n} = 2\\left[\\int_{0}^{1/2} 2x\\,\\sin(n\\pi x)\\,dx + \\int_{1/2}^{1} 2(1-x)\\,\\sin(n\\pi x)\\,dx\\right] = 4\\left[I_{1}+I_{2}\\right],\n$$\n其中\n$$\nI_{1} = \\int_{0}^{1/2} x\\,\\sin(n\\pi x)\\,dx,\\qquad I_{2} = \\int_{1/2}^{1} (1-x)\\,\\sin(n\\pi x)\\,dx.\n$$\n在 $I_{2}$ 中使用换元法 $u=1-x$，并利用恒等式 $\\sin(n\\pi(1-u)) = \\sin(n\\pi)\\cos(n\\pi u) - \\cos(n\\pi)\\sin(n\\pi u) = (-1)^{n+1}\\sin(n\\pi u)$，可得\n$$\nI_{2} = (-1)^{n+1}\\int_{0}^{1/2} u\\,\\sin(n\\pi u)\\,du = (-1)^{n+1} I_{1}.\n$$\n因此\n$$\nb_{n} = 4\\left[1 + (-1)^{n+1}\\right] I_{1}.\n$$\n所以当 $n$ 为偶数时，$b_{n}=0$；当 $n$ 为奇数时，我们有 $b_{n} = 8 I_{1}$。剩下的任务是计算 $I_{1}$：\n$$\nI_{1} = \\int_{0}^{1/2} x\\,\\sin(n\\pi x)\\,dx.\n$$\n使用分部积分法，设 $u=x$，$dv=\\sin(n\\pi x)\\,dx$，于是 $du=dx$ 且 $v=-\\cos(n\\pi x)/(n\\pi)$。那么\n$$\nI_{1} = \\left[-\\frac{x\\cos(n\\pi x)}{n\\pi} + \\frac{\\sin(n\\pi x)}{(n\\pi)^{2}}\\right]_{0}^{1/2}\n= -\\frac{1}{2n\\pi}\\cos\\!\\left(\\frac{n\\pi}{2}\\right) + \\frac{1}{(n\\pi)^{2}}\\sin\\!\\left(\\frac{n\\pi}{2}\\right).\n$$\n当 $n$ 为奇数时，$\\cos(n\\pi/2)=0$ 且 $\\sin(n\\pi/2)=(-1)^{(n-1)/2}$，所以\n$$\nb_{n} = 8 I_{1} = \\frac{8}{(n\\pi)^{2}} \\sin\\!\\left(\\frac{n\\pi}{2}\\right), \\quad \\text{其中 } n \\text{ 为奇数}。\n$$\n因此，前三个非零系数对应于 $n=1,3,5$：\n$$\nb_{1} = \\frac{8}{\\pi^{2}},\\qquad b_{3} = -\\frac{8}{9\\pi^{2}},\\qquad b_{5} = \\frac{8}{25\\pi^{2}}.\n$$\n按 $n$ 的增序排列成一个行矩阵，结果是\n$$\n\\begin{pmatrix}\n\\frac{8}{\\pi^{2}}  -\\frac{8}{9\\pi^{2}}  \\frac{8}{25\\pi^{2}}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{8}{\\pi^{2}}  -\\frac{8}{9\\pi^{2}}  \\frac{8}{25\\pi^{2}}\\end{pmatrix}}$$", "id": "2204923"}, {"introduction": "一旦我们将函数表示为谱级数，下一步就是将这种表示应用到偏微分方程本身，看看方程在谱空间中是如何演化的。这个练习将引导你为一个典型的一维热方程推导出一个全离散的更新格式 [@problem_id:2204882]。通过将空间上的谱方法与时间上的前向欧拉法相结合，你将亲身体验到谱方法如何将一个复杂的偏微分方程（PDE）转化为一组关于谱系数的简单常微分方程（ODEs）。", "problem": "考虑一个周长为 $L$ 的细绝热金属环中的热扩散过程。环上位置 $x$ 和时间 $t \\geq 0$ 的温度分布 $u(x, t)$ 由一维热方程控制，这是一种偏微分方程（PDE）：\n$$ \\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2} $$\n其中 $\\alpha$ 是金属的恒定热扩散系数。环的几何形状在定义域 $x \\in [0, L]$ 上施加了周期性边界条件。\n\n为了数值求解该偏微分方程，我们对空间维度采用傅里叶谱方法。温度函数表示为复傅里叶级数：\n$$ u(x, t) = \\sum_{k=-\\infty}^{\\infty} \\hat{u}_k(t) \\exp\\left(i \\frac{2\\pi k x}{L}\\right) $$\n这里，$i = \\sqrt{-1}$，$k$ 是表示波长的整数，$\\hat{u}_k(t)$ 是随时间变化的傅里叶系数。\n\n对于时间积分，我们使用时间步长恒为 $\\Delta t$ 的前向欧拉法。在时间 $t_n = n \\Delta t$ 时，系数 $\\hat{u}_k$ 的近似值表示为 $\\hat{u}_k^n$。时间导数的前向欧拉近似为 $\\frac{d\\hat{u}_k}{dt} \\approx \\frac{\\hat{u}_k^{n+1} - \\hat{u}_k^n}{\\Delta t}$。\n\n基于此数值格式，推导下一个时间步的傅里叶系数 $\\hat{u}_k^{n+1}$ 的全离散更新表达式，该表达式用当前时间步的值 $\\hat{u}_k^n$ 以及物理和数值参数 $\\alpha$、$L$、$k$ 和 $\\Delta t$ 表示。", "solution": "我们从在 $x \\in [0, L]$ 上具有周期性边界条件的热方程开始：\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^{2} u}{\\partial x^{2}}.\n$$\n将 $u(x,t)$ 用其复傅里叶级数表示：\n$$\nu(x,t) = \\sum_{k=-\\infty}^{\\infty} \\hat{u}_{k}(t) \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right).\n$$\n对时间进行逐项微分：\n$$\n\\frac{\\partial u}{\\partial t} = \\sum_{k=-\\infty}^{\\infty} \\frac{d \\hat{u}_{k}}{dt}(t) \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right).\n$$\n对空间进行两次微分。一阶导数为\n$$\n\\frac{\\partial u}{\\partial x} = \\sum_{k=-\\infty}^{\\infty} \\hat{u}_{k}(t)\\, i \\frac{2\\pi k}{L} \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right),\n$$\n二阶导数为\n$$\n\\frac{\\partial^{2} u}{\\partial x^{2}} = \\sum_{k=-\\infty}^{\\infty} \\hat{u}_{k}(t)\\, \\left(i \\frac{2\\pi k}{L}\\right)^{2} \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right) = - \\sum_{k=-\\infty}^{\\infty} \\hat{u}_{k}(t)\\, \\left(\\frac{2\\pi k}{L}\\right)^{2} \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right),\n$$\n因为 $i^{2} = -1$。代入偏微分方程，并令正交傅里叶模态的系数相等，对于每个整数 $k$，可得：\n$$\n\\frac{d \\hat{u}_{k}}{dt}(t) = - \\alpha \\left(\\frac{2\\pi k}{L}\\right)^{2} \\hat{u}_{k}(t).\n$$\n在时间 $t_{n} = n \\Delta t$ 上，使用时间步长 $\\Delta t$ 的前向欧拉法进行时间离散化：\n$$\n\\frac{\\hat{u}_{k}^{n+1} - \\hat{u}_{k}^{n}}{\\Delta t} = - \\alpha \\left(\\frac{2\\pi k}{L}\\right)^{2} \\hat{u}_{k}^{n}.\n$$\n求解 $\\hat{u}_{k}^{n+1}$，得到全离散更新式：\n$$\n\\hat{u}_{k}^{n+1} = \\left[1 - \\alpha \\Delta t \\left(\\frac{2\\pi k}{L}\\right)^{2}\\right] \\hat{u}_{k}^{n}.\n$$", "answer": "$$\\boxed{\\hat{u}_{k}^{n+1}=\\left[1-\\alpha\\,\\Delta t\\,\\left(\\frac{2\\pi k}{L}\\right)^{2}\\right]\\hat{u}_{k}^{n}}$$", "id": "2204882"}, {"introduction": "谱方法虽然强大，但其成功与否关键取决于基函数的选择。如果所选的基函数空间不能“看见”问题的某个关键部分（例如外力项），那么方法就可能得出完全错误的结论。本练习通过一个求解泊松方程失败的案例，迫使我们深入思考伽辽金方法的核心原理 [@problem_id:2204920]。理解这种失败的原因，对于培养在实际应用中正确选择和诊断谱方法的直觉至关重要。", "problem": "一位数值分析师的任务是求解一维泊松方程 $u_{xx}(x) = f(x)$，其定义域为 $x \\in [0, 1]$，并满足齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。该问题的特定强迫项由 $f(x) = \\sin(8\\pi x)$ 给出。\n\n该分析师选择使用谱伽辽金方法。他们提出了一个近似解 $u_N(x)$，作为基函数的有限线性组合：\n$$u_N(x) = \\sum_{k=1}^{N} c_k \\phi_k(x)$$\n所选的基函数是该定义域上拉普拉斯算子的正弦本征函数，$\\phi_k(x) = \\sin(k\\pi x)$，这些函数自动满足边界条件。在此次特定尝试中，分析师将基函数的数量设置为 $N=7$。\n\n伽辽金方法的核心原理是，要求方程的残差 $R(x) = u_{N,xx}(x) - f(x)$ 与所选集合中的每个基函数都正交。即，对于所有的 $j=1, 2, \\dots, N$，都有 $\\int_0^1 R(x) \\phi_j(x) dx = 0$。这个过程产生一个关于未知系数 $c_k$ 的线性方程组。\n\n当分析师使用 $N=7$ 实现此方法时，计算返回的解为对所有 $x$ 都有 $u_7(x) = 0$。这显然是错误的，因为将 $u(x)=0$ 代入原微分方程，得到 $0 = \\sin(8\\pi x)$，而这是不成立的。\n\n下列哪个陈述为此特定数值实现失败提供了正确的根本原因？\n\nA. 强迫项 $f(x)$ 与集合 $\\{\\sin(k\\pi x)\\}_{k=1}^{7}$ 中的每个基函数都正交。因此，$f(x)$ 在这些基函数所张成的空间上的投影为零，导致计算出平凡解 $u_7(x)=0$。\n\nB. 关于系数 $c_k$ 的线性方程组是奇异的，因为系数矩阵的行列式为零，这表明基函数不是线性无关的。\n\nC. 正弦基仅适用于具有偶数索引的强迫项，如 $\\sin(2n\\pi x)$。奇数索引的强迫项 $\\sin(8\\pi x)$（因为$k=8$不是2的幂）需要使用余弦基。\n\nD. 所选的基函数数量 $N=7$ 太少，无法解析强迫项的振荡。根据奈奎斯特-香农采样定理，为了得到稳定解，至少需要 $2 \\times 8 = 16$ 个基函数。\n\nE. 该方法失败是因为边界条件 $u(0)=u(1)=0$ 与一个在边界处也为零的强迫项不兼容。这造成了一个不适定问题。", "solution": "我们考虑使用基函数 $\\phi_{k}(x)=\\sin(k\\pi x)$（其中$k=1,\\dots,N$，$N=7$）的谱伽辽金近似。近似解为 $u_{N}(x)=\\sum_{k=1}^{N}c_{k}\\sin(k\\pi x)$，因此其二阶导数为\n$$\nu_{N,xx}(x)=\\sum_{k=1}^{N}c_{k}\\phi_{k}''(x)=\\sum_{k=1}^{N}c_{k}\\left(-k^{2}\\pi^{2}\\sin(k\\pi x)\\right).\n$$\n给定 $f(x)=\\sin(8\\pi x)$ 且残差为 $R(x)=u_{N,xx}(x)-f(x)$，伽辽金条件为\n$$\n\\int_{0}^{1}R(x)\\,\\sin(j\\pi x)\\,dx=0,\\quad j=1,\\dots,N.\n$$\n代入 $R$ 可得\n$$\n\\int_{0}^{1}\\left(\\sum_{k=1}^{N}c_{k}\\left(-k^{2}\\pi^{2}\\sin(k\\pi x)\\right)-\\sin(8\\pi x)\\right)\\sin(j\\pi x)\\,dx=0.\n$$\n利用正交关系\n$$\n\\int_{0}^{1}\\sin(k\\pi x)\\sin(j\\pi x)\\,dx=\\begin{cases}\n0, j\\neq k,\\\\\n\\frac{1}{2}, j=k,\n\\end{cases}\n$$\n每个伽辽金方程解耦为\n$$\n-\\,j^{2}\\pi^{2}c_{j}\\int_{0}^{1}\\sin^{2}(j\\pi x)\\,dx=\\int_{0}^{1}\\sin(8\\pi x)\\sin(j\\pi x)\\,dx,\\quad j=1,\\dots,7,\n$$\n即，\n$$\n-\\,j^{2}\\pi^{2}c_{j}\\left(\\frac{1}{2}\\right)=\\int_{0}^{1}\\sin(8\\pi x)\\sin(j\\pi x)\\,dx,\\quad j=1,\\dots,7.\n$$\n根据正交性，对于每一个 $j=1,\\dots,7$，等式右侧都为零，因为 $\\sin(8\\pi x)$ 与 $\\sin(j\\pi x)$ 正交，除非 $j=8$。因此，\n$$\n-\\,j^{2}\\pi^{2}c_{j}\\left(\\frac{1}{2}\\right)=0\\quad\\Rightarrow\\quad c_{j}=0,\\quad j=1,\\dots,7,\n$$\n从而得出 $u_{7}(x)=0$。\n\n这揭示了根本原因：强迫项完全位于模式 $k=8$，而该模式不包含在 $\\{\\sin(k\\pi x)\\}_{k=1}^{7}$ 所张成的空间中。因此，其在该子空间上的投影为零，伽辽金系统的右侧为零，而刚度矩阵是对角且可逆的：\n$$\na_{jk}=\\int_{0}^{1}\\phi_{k}''(x)\\phi_{j}(x)\\,dx=\\int_{0}^{1}\\left(-k^{2}\\pi^{2}\\sin(k\\pi x)\\right)\\sin(j\\pi x)\\,dx=-\\,\\frac{1}{2}k^{2}\\pi^{2}\\,\\delta_{jk},\n$$\n因此不存在奇异性。如果 $N$ 包含 $8$，则会得到 $c_{8}=-1/(8^{2}\\pi^{2})$ 并恢复精确解。对于此边值问题，引用余弦基、奈奎斯特-香农采样或与边界条件不兼容性的解释都是不正确的。正确的选择是强迫项与所选子空间正交。\n\n因此，正确选项是A。", "answer": "$$\\boxed{A}$$", "id": "2204920"}]}