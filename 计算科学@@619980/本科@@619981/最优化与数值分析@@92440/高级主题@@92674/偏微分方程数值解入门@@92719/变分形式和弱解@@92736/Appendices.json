{"hands_on_practices": [{"introduction": "变分法将求解微分方程重新定义为一个积分恒等式问题。第一个练习提供了一个直接的动手实践机会，来理解这一核心概念。通过为一个给定的候选解和检验函数计算积分方程的两边，你将具体地验证一个函数成为“弱解”的含义 [@problem_id:2225052]。", "problem": "在有限元方法中，一个微分方程通常被重构为一个积分形式，称为弱形式或变分形式。这允许我们考虑比经典（可微）解更广泛的一类解。\n\n考虑在区间 $(0, 1)$ 上的一个一维边值问题 (BVP)：\n$$\n-u''(x) = f(x), \\quad \\text{其中边界条件为} \\quad u(0) = 0 \\text{ 和 } u(1) = 0.\n$$\n该边值问题的弱形式表述为：一个函数 $u(x)$（必须满足边界条件）是弱解，如果对于每一个同样满足齐次边界条件（即 $v(0)=0$ 和 $v(1)=0$）的“检验函数”$v(x)$，以下积分恒等式都成立：\n$$\n\\int_{0}^{1} u'(x) v'(x) dx = \\int_{0}^{1} f(x) v(x) dx\n$$\n\n现在，考虑源函数为 $f(x) = 12x^2 - 2$ 的特定情况。弱解的一个候选解是函数 $u(x) = x^2(1 - x^2)$。为了检验这个论断，可以选择一个特定的检验函数，并验证该积分恒等式是否成立。\n\n令检验函数为 $v(x) = \\sin(\\pi x)$。如果候选解 $u(x)$ 确实是弱解，那么弱形式中的两个积分值必须相等。你的任务是计算这个共同的值。\n\n用一个关于 $\\pi$ 的单一闭式解析表达式来表示你的答案。", "solution": "给定边值问题，其中 $f(x)=12x^{2}-2$，候选解 $u(x)=x^{2}(1-x^{2})$，以及检验函数 $v(x)=\\sin(\\pi x)$。弱形式要求\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,dx=\\int_{0}^{1} f(x)\\,v(x)\\,dx.\n$$\n因为 $u''(x)=2-12x^{2}$，我们有 $-u''(x)=12x^{2}-2=f(x)$ 并且 $u(0)=u(1)=0$，所以 $u$ 是强解，该恒等式对所有允许的 $v$ 都成立。我们使用右边的积分来计算这个共同的值：\n$$\nI=\\int_{0}^{1} \\left(12x^{2}-2\\right)\\sin(\\pi x)\\,dx=12\\int_{0}^{1} x^{2}\\sin(a x)\\,dx-2\\int_{0}^{1}\\sin(a x)\\,dx,\n$$\n为清晰起见，我们设 $a=\\pi$。\n\n首先，计算 $S_{0}=\\int_{0}^{1}\\sin(a x)\\,dx$：\n$$\nS_{0}=\\left[-\\frac{\\cos(a x)}{a}\\right]_{0}^{1}=\\frac{1-\\cos a}{a}.\n$$\n接下来，通过分部积分计算 $S_{2}=\\int_{0}^{1}x^{2}\\sin(a x)\\,dx$，设 $u=x^{2}$ 和 $dv=\\sin(a x)\\,dx$，得到 $du=2x\\,dx$ 和 $v=-\\cos(a x)/a$：\n$$\nS_{2}=\\left[-\\frac{x^{2}\\cos(a x)}{a}\\right]_{0}^{1}+\\frac{2}{a}\\int_{0}^{1} x\\cos(a x)\\,dx= -\\frac{\\cos a}{a}+\\frac{2}{a}\\int_{0}^{1} x\\cos(a x)\\,dx.\n$$\n对于 $C_{1}=\\int_{0}^{1} x\\cos(a x)\\,dx$，使用分部积分，设 $u=x$, $dv=\\cos(a x)\\,dx$ 得到 $du=dx$ 和 $v=\\sin(a x)/a$：\n$$\nC_{1}=\\left[\\frac{x\\sin(a x)}{a}\\right]_{0}^{1}-\\frac{1}{a}\\int_{0}^{1}\\sin(a x)\\,dx=\\frac{\\sin a}{a}-\\frac{S_{0}}{a}=\\frac{\\sin a}{a}+\\frac{\\cos a-1}{a^{2}}.\n$$\n因此，\n$$\nS_{2}=-\\frac{\\cos a}{a}+\\frac{2}{a}\\left(\\frac{\\sin a}{a}+\\frac{\\cos a-1}{a^{2}}\\right)= -\\frac{\\cos a}{a}+\\frac{2\\sin a}{a^{2}}+\\frac{2(\\cos a-1)}{a^{3}}.\n$$\n组合 $I$，\n$$\nI=12S_{2}-2S_{0}=-\\frac{12\\cos a}{a}+\\frac{24\\sin a}{a^{2}}+\\frac{24(\\cos a-1)}{a^{3}}-\\frac{2(1-\\cos a)}{a}.\n$$\n合并 $1/a$ 项：\n$$\n-\\frac{12\\cos a}{a}-\\frac{2(1-\\cos a)}{a}=\\frac{-10\\cos a-2}{a},\n$$\n所以\n$$\nI=\\frac{-10\\cos a-2}{a}+\\frac{24\\sin a}{a^{2}}+\\frac{24(\\cos a-1)}{a^{3}}.\n$$\n现在代入 $a=\\pi$，使用 $\\cos \\pi=-1$ 和 $\\sin \\pi=0$：\n$$\nI=\\frac{-10(-1)-2}{\\pi}+\\frac{24\\cdot 0}{\\pi^{2}}+\\frac{24((-1)-1)}{\\pi^{3}}=\\frac{8}{\\pi}-\\frac{48}{\\pi^{3}}.\n$$\n因此，对于所选的检验函数，弱形式中的两个积分都等于 $8/\\pi-48/\\pi^{3}$。", "answer": "$$\\boxed{\\frac{8}{\\pi}-\\frac{48}{\\pi^{3}}}$$", "id": "2225052"}, {"introduction": "并非所有函数都拥有性质良好的弱导数。这个练习探讨了一个关键的边界情况：一个带有跳跃间断点的函数。通过分析为什么这样一个函数无法在平方可积函数空间 ($L^2$) 中拥有弱导数，你将对索博列夫空间和弱解背后的正则性要求有更深刻的理解 [@problem_id:2225059]。", "problem": "在偏微分方程和数值分析的研究中，弱导数的概念用于将微分的概念推广到非经典可微的函数，例如不连续的函数。我们考虑$L^2(0,1)$空间中的函数，该空间是定义在区间 $(0,1)$ 上的所有函数 $f(x)$ 的集合，其积分 $\\int_0^1 |f(x)|^2 \\,dx$ 是有限的。\n\n如果对于每一个“测试函数” $\\phi \\in C_c^\\infty(0,1)$，以下恒等式都成立，那么函数 $v \\in L^2(0,1)$ 就被定义为函数 $u \\in L^2(0,1)$ 的弱导数：\n$$ \\int_0^1 u(x) \\phi'(x) \\,dx = - \\int_0^1 v(x) \\phi(x) \\,dx $$\n这里，$C_c^\\infty(0,1)$ 表示在 $(0,1)$ 的某个闭子区间之外恒等于零的所有无穷可微函数的集合。这些测试函数的一个关键性质是它们在边界处为零，即 $\\phi(0) = \\phi(1) = 0$。\n\n现在，考虑在区间 $(0,1)$ 上定义的特定函数 $u(x)$ 如下：\n$$ u(x) = \\begin{cases} 0 & \\text{if } 0 < x < 1/2 \\\\ 1 & \\text{if } 1/2 \\le x < 1 \\end{cases} $$\n该函数在 $x = 1/2$ 处有一个跳跃间断点，并且是 $L^2(0,1)$ 中的一个元素。一个基本结论是，该函数 $u(x)$ 不存在同样属于 $L^2(0,1)$ 的弱导数。\n\n以下哪个陈述为这一事实提供了最准确的理由？\n\nA. 函数 $u(x)$ 由于其不连续性而不属于 $L^2(0,1)$，因此弱导数的概念不适用。\n\nB. 由于 $u(x)$ 不连续，积分 $\\int_0^1 u(x) \\phi'(x) \\,dx$ 在数学上是未定义的。\n\nC. 测试函数 $\\phi(x) \\in C_c^\\infty(0,1)$ 不保证属于 $L^2(0,1)$，这使得弱导数定义中的积分无效。\n\nD. 对 $\\int_0^1 u(x) \\phi'(x) \\,dx$ 项应用分部积分，揭示了其对测试函数在间断点处的值 $\\phi(1/2)$ 的依赖性，而这是任何单个函数 $v \\in L^2(0,1)$ 与 $\\phi(x)$ 的积分都无法产生的。\n\nE. $u(x)$ 的经典导数几乎处处为零，这意味着其弱导数必须是 $L^2(0,1)$ 中的零函数。这导致了一个矛盾，因为只有常数函数的弱导数才为零。", "solution": "我们首先验证 $u \\in L^{2}(0,1)$。由于函数 $u(x)$ 在 $(0,\\frac{1}{2})$ 上为0，在 $[\\frac{1}{2},1)$ 上为1，我们有\n$$\n\\int_{0}^{1} |u(x)|^{2}\\,dx=\\int_{0}^{1/2} 0\\,dx+\\int_{1/2}^{1} 1\\,dx=\\frac{1}{2}<\\infty,\n$$\n所以选项 A 是错误的。\n\n对于任何 $\\phi \\in C_{c}^{\\infty}(0,1)$，我们计算弱导数的定义积分：\n$$\n\\int_{0}^{1} u(x)\\,\\phi'(x)\\,dx=\\int_{0}^{1/2} 0\\cdot \\phi'(x)\\,dx+\\int_{1/2}^{1} 1\\cdot \\phi'(x)\\,dx=\\phi(1)-\\phi\\!\\left(\\tfrac{1}{2}\\right).\n$$\n由于对于 $\\phi \\in C_{c}^{\\infty}(0,1)$ 有 $\\phi(1)=0$，上式可化简为\n$$\n\\int_{0}^{1} u(x)\\,\\phi'(x)\\,dx=-\\phi\\!\\left(\\tfrac{1}{2}\\right).\n$$\n因此，如果存在弱导数 $v \\in L^{2}(0,1)$，根据定义，它将满足\n$$\n\\int_{0}^{1} u(x)\\,\\phi'(x)\\,dx=-\\int_{0}^{1} v(x)\\,\\phi(x)\\,dx \\quad \\text{for all } \\phi \\in C_{c}^{\\infty}(0,1),\n$$\n结合上式，可得\n$$\n\\int_{0}^{1} v(x)\\,\\phi(x)\\,dx=\\phi\\!\\left(\\tfrac{1}{2}\\right) \\quad \\text{for all } \\phi \\in C_{c}^{\\infty}(0,1).\n$$\n右端是在 $x=\\tfrac{1}{2}$ 处的点值泛函。下面我们证明，不存在 $v \\in L^{2}(0,1)$ 能通过 $L^2$ 配对产生这个泛函。\n\n反设存在这样的 $v \\in L^{2}(0,1)$。根据柯西-施瓦茨不等式，\n$$\n\\left|\\int_{0}^{1} v(x)\\,\\phi(x)\\,dx\\right| \\le \\|v\\|_{L^{2}(0,1)}\\,\\|\\phi\\|_{L^{2}(0,1)} \\quad \\text{for all } \\phi \\in L^{2}(0,1).\n$$\n因此，泛函 $\\phi \\mapsto \\int_{0}^{1} v\\phi$ 在 $L^{2}(0,1)$ 上关于 $L^2$ 范数是连续的。但是点值泛函 $\\phi \\mapsto \\phi\\!\\left(\\tfrac{1}{2}\\right)$ 在 $L^{2}(0,1)$ 上是不连续的。为说明这一点，选择一个固定的 $\\eta \\in C_{c}^{\\infty}((-1,1))$ 且满足 $\\eta(0)=1$，并定义\n$$\n\\phi_{n}(x)=\\eta\\!\\left(n\\left(x-\\tfrac{1}{2}\\right)\\right).\n$$\n那么，对于所有足够大的 $n$，有 $\\phi_{n} \\in C_{c}^{\\infty}(0,1)$，$\\phi_{n}\\!\\left(\\tfrac{1}{2}\\right)=\\eta(0)=1$，并且\n$$\n\\|\\phi_{n}\\|_{L^{2}(0,1)}^{2}=\\int_{0}^{1} \\left|\\eta\\!\\left(n\\left(x-\\tfrac{1}{2}\\right)\\right)\\right|^{2}\\,dx=\\frac{1}{n}\\int_{-1}^{1} |\\eta(y)|^{2}\\,dy \\to 0 \\quad \\text{as } n \\to \\infty.\n$$\n因此 $|\\phi_{n}\\!\\left(\\tfrac{1}{2}\\right)|=1$ 而 $\\|\\phi_{n}\\|_{2} \\to 0$，这与任何形式为 $|\\phi\\!\\left(\\tfrac{1}{2}\\right)| \\le C\\|\\phi\\|_{2}$ 的不等式相矛盾。因此，不存在 $v \\in L^{2}(0,1)$ 能对所有 $\\phi \\in C_{c}^{\\infty}(0,1)$ 满足 $\\int v\\phi=\\phi\\!\\left(\\tfrac{1}{2}\\right)$。\n\n这表明 $u$ 在 $L^{2}(0,1)$ 中没有弱导数。在分布意义下，其弱导数是在 $\\tfrac{1}{2}$ 处的狄拉克测度，而它不是一个 $L^{2}$ 函数。因此，在这些选项中，D 是准确的理由。\n\n为完整起见，我们指出：\n- B 是错误的，因为 $\\int_{0}^{1} u\\,\\phi'$ 是良定义的（实际上，上文已经计算过）。\n- C 是错误的，因为每个 $\\phi \\in C_{c}^{\\infty}(0,1)$ 都属于 $L^{2}(0,1)$。\n- E 是错误的：虽然 $u$ 的经典导数几乎处处为零，但弱导数通过一个分布项来解释这个跳跃；它不是 $L^2(0,1)$ 中的零函数。", "answer": "$$\\boxed{D}$$", "id": "2225059"}, {"introduction": "变分法的真正威力在于其在数值方法中的应用。这个实践问题将带你进入有限元方法（FEM）的核心，通过构建一个“刚度矩阵”。通过计算简单的“帽子”基函数导数的积分，你将迈出将连续微分方程转化为可解线性方程组的、最关键的第一步 [@problem_id:2225051]。", "problem": "考虑在区间 $[0, 1]$ 上定义的两个连续分段线性函数 $\\phi_1(x)$ 和 $\\phi_2(x)$。这些函数是基于将区间划分为三个等长子区间而构建的，节点位于 $x_0=0$、$x_1=1/3$、$x_2=2/3$ 和 $x_3=1$。\n\n函数 $\\phi_1(x)$ 定义如下：\n$$\n\\phi_1(x) =\n\\begin{cases}\n3x & \\text{当 } 0 \\le x \\le 1/3 \\text{ 时} \\\\\n-3x + 2 & \\text{当 } 1/3 < x \\le 2/3 \\text{ 时} \\\\\n0 & \\text{当 } 2/3 < x \\le 1 \\text{ 时}\n\\end{cases}\n$$\n\n函数 $\\phi_2(x)$ 定义如下：\n$$\n\\phi_2(x) =\n\\begin{cases}\n0 & \\text{当 } 0 \\le x \\le 1/3 \\text{ 时} \\\\\n3x - 1 & \\text{当 } 1/3 < x \\le 2/3 \\text{ 时} \\\\\n-3x + 3 & \\text{当 } 2/3 < x \\le 1 \\text{ 时}\n\\end{cases}\n$$\n\n您的任务是计算 $2 \\times 2$ 矩阵 $A$，其元素 $A_{ij}$ 由以下公式给出：\n$$\nA_{ij} = \\int_{0}^{1} \\frac{d\\phi_i}{dx}(x) \\frac{d\\phi_j}{dx}(x) \\,dx\n$$\n其中 $i, j \\in \\{1, 2\\}$。请将您的最终答案表示为一个 $2 \\times 2$ 矩阵。", "solution": "我们首先计算分段线性基函数的导数。由于孤立点上的导数不影响积分值，我们在开子区间上指定其导数，并注意节点上的值与积分无关。\n\n根据 $\\phi_{1}(x)$ 的定义，\n$$\n\\frac{d\\phi_{1}}{dx}(x)=\n\\begin{cases}\n3 & \\text{当 } 0<x<\\frac{1}{3} \\text{ 时},\\\\\n-3 & \\text{当 } \\frac{1}{3}<x<\\frac{2}{3} \\text{ 时},\\\\\n0 & \\text{当 } \\frac{2}{3}<x<1 \\text{ 时}.\n\\end{cases}\n$$\n根据 $\\phi_{2}(x)$ 的定义，\n$$\n\\frac{d\\phi_{2}}{dx}(x)=\n\\begin{cases}\n0 & \\text{当 } 0<x<\\frac{1}{3} \\text{ 时},\\\\\n3 & \\text{当 } \\frac{1}{3}<x<\\frac{2}{3} \\text{ 时},\\\\\n-3 & \\text{当 } \\frac{2}{3}<x<1 \\text{ 时}.\n\\end{cases}\n$$\n\n现在我们计算每个元素 $A_{ij}=\\int_{0}^{1}\\frac{d\\phi_{i}}{dx}(x)\\frac{d\\phi_{j}}{dx}(x)\\,dx$。\n\n对于 $A_{11}$，\n$$\nA_{11}=\\int_{0}^{\\frac{1}{3}}3^{2}\\,dx+\\int_{\\frac{1}{3}}^{\\frac{2}{3}}(-3)^{2}\\,dx+\\int_{\\frac{2}{3}}^{1}0\\,dx\n=9\\left(\\frac{1}{3}\\right)+9\\left(\\frac{1}{3}\\right)+0=3+3=6.\n$$\n\n对于 $A_{22}$，\n$$\nA_{22}=\\int_{0}^{\\frac{1}{3}}0\\,dx+\\int_{\\frac{1}{3}}^{\\frac{2}{3}}3^{2}\\,dx+\\int_{\\frac{2}{3}}^{1}(-3)^{2}\\,dx\n=0+9\\left(\\frac{1}{3}\\right)+9\\left(\\frac{1}{3}\\right)=3+3=6.\n$$\n\n对于 $A_{12}$（并根据对称性有 $A_{21}$），\n$$\nA_{12}=\\int_{0}^{\\frac{1}{3}}3\\cdot 0\\,dx+\\int_{\\frac{1}{3}}^{\\frac{2}{3}}(-3)\\cdot 3\\,dx+\\int_{\\frac{2}{3}}^{1}0\\cdot(-3)\\,dx\n=0+(-9)\\left(\\frac{1}{3}\\right)+0=-3.\n$$\n因此 $A_{21}=A_{12}=-3$。\n\n因此，该矩阵为\n$$\nA=\\begin{pmatrix}\n6 & -3\\\\\n-3 & 6\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}6 & -3 \\\\ -3 & 6\\end{pmatrix}}$$", "id": "2225051"}]}