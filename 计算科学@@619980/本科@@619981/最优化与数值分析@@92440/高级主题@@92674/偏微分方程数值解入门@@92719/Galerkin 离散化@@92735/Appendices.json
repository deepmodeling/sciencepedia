{"hands_on_practices": [{"introduction": "伽辽金方法的核心思想是将一个微分方程问题转化为一个代数方程组。这个入门练习将此过程简化到极致，通过使用单个基函数，将一个经典的二阶边值问题转化为一个只需求解一个未知系数的简单代数方程。通过完成这个练习，你将掌握伽辽金离散化的基本步骤，为解决更复杂的问题打下坚实的基础。", "problem": "考虑由微分方程 $-u''(x) = 1$（对于 $x \\in (0, 1)$）及齐次Dirichlet边界条件 $u(0) = 0$ 和 $u(1) = 0$ 定义的两点边值问题。该方程描述了（例如）一根拉紧的缆绳在均匀向下载荷作用下的微小垂直位移 $u(x)$。\n\n我们使用伽辽金方法来求解该问题的近似解。近似解记为 $u_h(x)$，它由单个基函数 $\\phi_1(x) = x(1-x)$ 构造成 $u_h(x) = c_1 \\phi_1(x)$。其中系数 $c_1$ 是一个待定常数。在伽辽金方法中，基函数也用作检验函数。\n\n确定通过正确应用此过程得到的系数 $c_1$ 的数值。将答案表示为分数形式。", "solution": "我们考虑该边值问题的弱形式：寻找 $u \\in V$（其中 $V = H_{0}^{1}(0,1)$），使得对于所有 $v \\in V$ 都满足，\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,dx = \\int_{0}^{1} 1 \\cdot v(x)\\,dx.\n$$\n使用伽辽金方法，其中试探空间和检验空间均由 $\\phi_{1}(x) = x(1-x)$ 张成。我们取 $u_{h}(x) = c_{1}\\phi_{1}(x)$ 并令 $v = \\phi_{1}$ 以施加伽辽金条件：\n$$\n\\int_{0}^{1} (u_{h})'(x)\\,\\phi_{1}'(x)\\,dx = \\int_{0}^{1} \\phi_{1}(x)\\,dx.\n$$\n由于 $u_{h}' = c_{1}\\phi_{1}'$，上式变为\n$$\nc_{1}\\int_{0}^{1} \\left(\\phi_{1}'(x)\\right)^{2}\\,dx = \\int_{0}^{1} \\phi_{1}(x)\\,dx,\n$$\n因此\n$$\nc_{1} = \\frac{\\int_{0}^{1} \\phi_{1}(x)\\,dx}{\\int_{0}^{1} \\left(\\phi_{1}'(x)\\right)^{2}\\,dx}.\n$$\n计算所需的积分。首先，对于 $\\phi_{1}(x) = x(1-x) = x - x^{2}$，\n$$\n\\int_{0}^{1} \\phi_{1}(x)\\,dx = \\int_{0}^{1} \\left(x - x^{2}\\right)\\,dx = \\left[\\frac{x^{2}}{2} - \\frac{x^{3}}{3}\\right]_{0}^{1} = \\frac{1}{2} - \\frac{1}{3} = \\frac{1}{6}.\n$$\n接下来，$\\phi_{1}'(x) = 1 - 2x$，因此\n$$\n\\int_{0}^{1} \\left(\\phi_{1}'(x)\\right)^{2}\\,dx = \\int_{0}^{1} \\left(1 - 4x + 4x^{2}\\right)\\,dx = \\left[x - 2x^{2} + \\frac{4}{3}x^{3}\\right]_{0}^{1} = 1 - 2 + \\frac{4}{3} = \\frac{1}{3}.\n$$\n所以，\n$$\nc_{1} = \\frac{\\frac{1}{6}}{\\frac{1}{3}} = \\frac{1}{2}.\n$$\n作为一致性检验，$-u''=1$ 在 $u(0)=u(1)=0$ 条件下的精确解是 $u(x) = \\frac{1}{2}x(1-x)$，这也证实了 $c_{1} = \\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2174720"}, {"introduction": "在实际应用中，我们通常使用多个基函数的线性组合来构造近似解，这自然会导出一个线性方程组 $Ac=b$。这个练习的核心任务是为二维函数空间构建 $2 \\times 2$ 的“刚度矩阵” $A$。通过亲手计算使用非正交基函数时的矩阵元素，你将深入理解刚度矩阵是如何捕捉微分算子以及基函数之间相互作用的，这是有限元方法计算中的关键一步。", "problem": "在使用伽辽金法求解域 $\\Omega$ 上的微分方程 $Lu = f$ 时，我们用一个来自有限维子空间的函数 $u_h$ 来近似解 $u$。该子空间由一组基函数 $\\{\\phi_i\\}_{i=1}^N$ 张成。这会导出一个线性系统 $Ac=b$，其中“刚度矩阵” $A$ 的元素由 $A_{ij} = (L\\phi_j, \\phi_i)$ 给出。\n\n考虑在区间 $[0, 1]$ 上与算子 $Lu = -u''$ 相关的一维边值问题。我们希望使用一个由非正交基函数 $\\phi_1(x) = \\sin(\\pi x)$ 和 $\\phi_2(x) = x(1-x)$ 张成的二维子空间来求得一个近似解。两个基函数都满足齐次狄利克雷边界条件，即对于 $i=1, 2$，有 $\\phi_i(0) = \\phi_i(1) = 0$。\n\n在区间 $[0, 1]$ 上，两个函数 $g(x)$ 和 $h(x)$ 的内积定义为 $(g, h) = \\int_0^1 g(x)h(x) dx$。\n\n确定与此基函数选择相对应的 $2 \\times 2$ 刚度矩阵 $A$，其元素定义为 $A_{ij} = (L\\phi_j, \\phi_i) = \\int_0^1 (-\\phi_j''(x)) \\phi_i(x) dx$。将答案表示为一个具有精确解析元素的矩阵。", "solution": "我们对算子 $L=-\\frac{d^{2}}{dx^{2}}$ 应用伽辽金刚度矩阵的定义：\n$$\nA_{ij}=(L\\phi_{j},\\phi_{i})=\\int_{0}^{1}\\left(-\\phi_{j}''(x)\\right)\\phi_{i}(x)\\,dx.\n$$\n基函数为 $\\phi_{1}(x)=\\sin(\\pi x)$ 和 $\\phi_{2}(x)=x(1-x)=x-x^{2}$。它们的导数如下：\n$$\n\\phi_{1}'(x)=\\pi\\cos(\\pi x),\\quad \\phi_{1}''(x)=-\\pi^{2}\\sin(\\pi x),\\quad -\\phi_{1}''(x)=\\pi^{2}\\sin(\\pi x),\n$$\n$$\n\\phi_{2}'(x)=1-2x,\\quad \\phi_{2}''(x)=-2,\\quad -\\phi_{2}''(x)=2.\n$$\n\n计算每个元素：\n1) 对于 $A_{11}$，\n$$\nA_{11}=\\int_{0}^{1}\\left(-\\phi_{1}''(x)\\right)\\phi_{1}(x)\\,dx=\\int_{0}^{1}\\pi^{2}\\sin(\\pi x)\\sin(\\pi x)\\,dx=\\pi^{2}\\int_{0}^{1}\\sin^{2}(\\pi x)\\,dx.\n$$\n使用 $\\sin^{2}(\\theta)=\\frac{1-\\cos(2\\theta)}{2}$，\n$$\n\\int_{0}^{1}\\sin^{2}(\\pi x)\\,dx=\\int_{0}^{1}\\frac{1-\\cos(2\\pi x)}{2}\\,dx=\\frac{1}{2}-\\frac{1}{2}\\int_{0}^{1}\\cos(2\\pi x)\\,dx=\\frac{1}{2},\n$$\n所以\n$$\nA_{11}=\\frac{\\pi^{2}}{2}.\n$$\n\n2) 对于 $A_{12}$，\n$$\nA_{12}=\\int_{0}^{1}\\left(-\\phi_{2}''(x)\\right)\\phi_{1}(x)\\,dx=\\int_{0}^{1}2\\sin(\\pi x)\\,dx=2\\left[-\\frac{\\cos(\\pi x)}{\\pi}\\right]_{0}^{1}=\\frac{4}{\\pi}.\n$$\n\n3) 对于 $A_{21}$，\n$$\nA_{21}=\\int_{0}^{1}\\left(-\\phi_{1}''(x)\\right)\\phi_{2}(x)\\,dx=\\pi^{2}\\int_{0}^{1}\\sin(\\pi x)\\left(x-x^{2}\\right)\\,dx.\n$$\n令 $J=\\int_{0}^{1}\\sin(\\pi x)\\left(x-x^{2}\\right)\\,dx=\\int_{0}^{1}x\\sin(\\pi x)\\,dx-\\int_{0}^{1}x^{2}\\sin(\\pi x)\\,dx$。\n计算\n$$\n\\int_{0}^{1}x\\sin(\\pi x)\\,dx=\\left[-\\frac{x\\cos(\\pi x)}{\\pi}+\\frac{\\sin(\\pi x)}{\\pi^{2}}\\right]_{0}^{1}=\\frac{1}{\\pi},\n$$\n和\n$$\n\\int_{0}^{1}x^{2}\\sin(\\pi x)\\,dx=\\left[-\\frac{x^{2}\\cos(\\pi x)}{\\pi}+\\frac{2x\\sin(\\pi x)}{\\pi^{2}}+\\frac{2\\cos(\\pi x)}{\\pi^{3}}\\right]_{0}^{1}=\\frac{1}{\\pi}-\\frac{4}{\\pi^{3}}.\n$$\n因此\n$$\nJ=\\frac{1}{\\pi}-\\left(\\frac{1}{\\pi}-\\frac{4}{\\pi^{3}}\\right)=\\frac{4}{\\pi^{3}},\\quad A_{21}=\\pi^{2}J=\\frac{4}{\\pi}.\n$$\n\n4) 对于 $A_{22}$，\n$$\nA_{22}=\\int_{0}^{1}\\left(-\\phi_{2}''(x)\\right)\\phi_{2}(x)\\,dx=\\int_{0}^{1}2\\left(x-x^{2}\\right)\\,dx=\\left[x^{2}-\\frac{2}{3}x^{3}\\right]_{0}^{1}=\\frac{1}{3}.\n$$\n\n因此，刚度矩阵为\n$$\nA=\\begin{pmatrix}\n\\frac{\\pi^{2}}{2} & \\frac{4}{\\pi} \\\\\n\\frac{4}{\\pi} & \\frac{1}{3}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\pi^{2}}{2} & \\frac{4}{\\pi} \\\\ \\frac{4}{\\pi} & \\frac{1}{3}\\end{pmatrix}}$$", "id": "2174708"}, {"introduction": "为什么求解二阶问题（如 $-u''=f$）时连续的分段线性函数（$C^0$）就足够，而对于四阶问题（如 $u''''=f$）则不行？本练习通过一个具体物理模型——梁的弯曲，给出了一个深刻的答案。你将计算一个在顶点附近被“平滑”处理的折线梁的弯曲能 $E_B = \\alpha \\int (u'')^2 dx$，并发现当平滑区域趋近于零时（即函数退化为 $C^0$ 函数），能量会趋于无穷大，这直观地揭示了高阶方程对基函数光滑度的内在要求。", "problem": "在使用有限元法（FEM）等数值方法分析偏微分方程时，基函数的选择至关重要。这些函数的正则性（即光滑性）决定了它们对于给定问题是否适用。本问题探讨了该要求对高阶方程的一个关键影响。\n\n考虑一根细弹性梁的弯曲，其储存的势能（称为弯曲能）与其挠度曲线的曲率有关。我们对定义域 $[0, 2L]$ 上的一个对称挠度曲线 $u_\\epsilon(x)$ 进行建模。该函数在两端点处为零，$u_\\epsilon(0) = u_\\epsilon(2L) = 0$，并在中点处有峰值高度 $H$，$u_\\epsilon(L) = H$。\n\n为了避免在峰值处出现会导致无限能量的尖锐“扭折”，我们定义了一个连续可微（$C^1$）的“平滑”曲线。该曲线的构造如下：\n- 形状关于 $x=L$ 对称。\n- 对于 $x \\in [0, L-\\epsilon]$，曲线 $u_\\epsilon(x)$ 是一条从原点出发的直线。\n- 对于 $x \\in [L-\\epsilon, L]$，曲线是一个二次多项式（抛物线），它将线性段与 $x=L$ 处的峰值连接起来。在连接点 $x=L-\\epsilon$ 处，函数值及其一阶导数均连续。在峰值点 $x=L$ 处，切线是水平的。\n此处，$\\epsilon$ 是一个满足 $0 < \\epsilon < L$ 的小参数，用于控制平滑区域的大小。\n\n该挠度曲线的弯曲能 $E_B$ 由以下积分给出：\n$$E_B = \\alpha \\int_0^{2L} \\left( \\frac{d^2 u_\\epsilon}{dx^2} \\right)^2 dx$$\n其中 $\\alpha$ 是一个代表梁的抗弯刚度的正常数。\n\n求解弯曲能 $E_B$ 关于给定参数 $\\alpha$、$H$、$L$ 和 $\\epsilon$ 的精确解析表达式。", "solution": "挠度 $u_{\\epsilon}(x)$ 关于 $x=L$ 对称。在 $[0,L-\\epsilon]$ 和 $[L+\\epsilon,2L]$ 上，它是线性的，因此在这些区间上 $u_{\\epsilon}''(x)=0$。弯曲能仅在两个平滑区间 $[L-\\epsilon,L]$ 和 $[L,L+\\epsilon]$ 上产生。\n\n在 $[L-\\epsilon,L]$ 上，设 $t=x-L$，并将二次函数写为 $q(t)=A t^{2}+B t+C$。在 $x=L$ 处的峰值和水平切线要求 $q(0)=C=H$ 和 $q'(0)=B=0$，所以\n$$\nq(t)=A t^{2}+H.\n$$\n在连接点 $x=L-\\epsilon$ (即 $t=-\\epsilon$) 处，与从原点出发的直线段的函数值和斜率的连续性要求存在一个斜率 $m$，使得\n$$\nq(-\\epsilon)=m(L-\\epsilon),\\quad q'(-\\epsilon)=m.\n$$\n计算\n$$\nq(-\\epsilon)=A\\epsilon^{2}+H,\\quad q'(-\\epsilon)=-2A\\epsilon.\n$$\n通过 $m=q'(-\\epsilon)$ 消去 $m$ 得到\n$$\nA\\epsilon^{2}+H = (-2A\\epsilon)(L-\\epsilon) = -2A\\epsilon L + 2A\\epsilon^{2},\n$$\n化简后得到\n$$\nH = -2A\\epsilon L + A\\epsilon^{2} = -A\\epsilon(2L-\\epsilon),\n$$\n因此\n$$\nA = -\\frac{H}{\\epsilon(2L-\\epsilon)}.\n$$\n因此，在二次函数区域内的二阶导数是常数：\n$$\nu_{\\epsilon}''(x)=q''(t)=2A=-\\frac{2H}{\\epsilon(2L-\\epsilon)}.\n$$\n根据对称性，在 $[L,L+\\epsilon]$ 上也适用相同的常数 $u_{\\epsilon}''$，而在其他地方 $u_{\\epsilon}''(x)=0$。因此，弯曲能为\n$$\nE_{B}=\\alpha\\int_{0}^{2L}\\left(u_{\\epsilon}''(x)\\right)^{2}\\,dx\n=\\alpha\\left[\\int_{L-\\epsilon}^{L}(2A)^{2}\\,dx+\\int_{L}^{L+\\epsilon}(2A)^{2}\\,dx\\right]\n=\\alpha\\left[4A^{2}\\epsilon+4A^{2}\\epsilon\\right]\n=8\\alpha A^{2}\\epsilon.\n$$\n将 $A=-H/[\\epsilon(2L-\\epsilon)]$ 代入可得\n$$\nE_{B}=8\\alpha\\epsilon\\frac{H^{2}}{\\epsilon^{2}(2L-\\epsilon)^{2}}\n=\\frac{8\\alpha H^{2}}{\\epsilon(2L-\\epsilon)^{2}}.\n$$", "answer": "$$\\boxed{\\frac{8\\alpha H^{2}}{\\epsilon\\left(2L-\\epsilon\\right)^{2}}}$$", "id": "2174683"}]}