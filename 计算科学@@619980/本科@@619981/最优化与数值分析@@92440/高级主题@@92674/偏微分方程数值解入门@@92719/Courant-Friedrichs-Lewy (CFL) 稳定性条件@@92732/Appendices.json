{"hands_on_practices": [{"introduction": "这个练习将带我们深入探讨显式差分格式的一个核心挑战：计算成本与分辨率之间的权衡。在模拟热传导等扩散过程时，我们使用的前向时间中心空间（FTCS）格式要求时间步长 $\\Delta t$ 与空间步长 $\\Delta x$ 的平方成正比，即 $\\Delta t \\propto (\\Delta x)^2$。通过这个实践，你将亲身体会到，为了追求更高的空间精度（即减小 $\\Delta x$），我们必须付出怎样的时间步长代价，这对于理解和规划计算资源至关重要。", "problem": "一位工程师正在为一种新型微电子器件开发热管理仿真。沿着一条薄的一维硅互连线的散热可以用一维热传导方程来建模：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中，$T$ 是温度，$t$ 是时间，$x$ 是沿互连线的位置，$\\alpha$ 是硅的热扩散率。\n\n为了对该方程进行数值求解，工程师使用了一种前向时间中心差分（FTCS）显式格式。位置索引为 $j$、时间步为 $n+1$ 处的温度，是根据上一个时间步 $n$ 的温度，按照以下离散化格式进行更新的：\n$$\nT_j^{n+1} = T_j^n + s (T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n其中，$\\Delta t$ 是时间步长，$\\Delta x$ 是空间步长，$s = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ 是无量纲稳定性参数。软件文档指出，为了使该仿真保持数值稳定并避免非物理振荡，稳定性参数必须满足条件 $s \\le \\frac{1}{2}$。\n\n工程师最初使用空间步长 $\\Delta x_{old}$ 和时间步长 $\\Delta t_{old}$ 运行了一个稳定的仿真，并选择了能保证稳定性的最大时间步长。为了提高温度分布的精度，工程师决定通过将空间步长减半（即新的空间步长 $\\Delta x_{new} = \\frac{1}{2}\\Delta x_{old}$）来细化仿真网格。\n\n在这个细化后的网格下，为了保持计算效率最高且稳定的仿真，新的允许的最大时间步长 $\\Delta t_{new}$ 和原始时间步长 $\\Delta t_{old}$ 之间必须满足什么关系？\n\nA. $\\Delta t_{new} = \\frac{1}{4} \\Delta t_{old}$\n\nB. $\\Delta t_{new} = \\frac{1}{2} \\Delta t_{old}$\n\nC. $\\Delta t_{new} = \\Delta t_{old}$\n\nD. $\\Delta t_{new} = 2 \\Delta t_{old}$\n\nE. $\\Delta t_{new} = 4 \\Delta t_{old}$", "solution": "FTCS 格式使用的稳定性参数 $s$ 定义为\n$$\ns=\\frac{\\alpha \\Delta t}{(\\Delta x)^{2}}, \\quad s \\le \\frac{1}{2}.\n$$\n对于原始网格，最大的稳定时间步长满足\n$$\ns_{old}=\\frac{\\alpha \\Delta t_{old}}{(\\Delta x_{old})^{2}}=\\frac{1}{2}.\n$$\n将网格细化使得 $\\Delta x_{new}=\\frac{1}{2}\\Delta x_{old}$ 后，最高效的稳定选择同样是设定\n$$\ns_{new}=\\frac{\\alpha \\Delta t_{new}}{(\\Delta x_{new})^{2}}=\\frac{1}{2}.\n$$\n将 $\\Delta x_{new}=\\frac{1}{2}\\Delta x_{old}$ 代入可得\n$$\n\\frac{\\alpha \\Delta t_{new}}{\\left(\\frac{1}{2}\\Delta x_{old}\\right)^{2}}=\\frac{1}{2}\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{4\\alpha \\Delta t_{new}}{(\\Delta x_{old})^{2}}=\\frac{1}{2}.\n$$\n与 $\\frac{\\alpha \\Delta t_{old}}{(\\Delta x_{old})^{2}}=\\frac{1}{2}$ 进行比较，我们得到\n$$\n4\\Delta t_{new}=\\Delta t_{old}\n\\;\\;\\Longrightarrow\\;\\;\n\\Delta t_{new}=\\frac{1}{4}\\Delta t_{old}.\n$$\n因此，正确的选项是 A。", "answer": "$$\\boxed{A}$$", "id": "2164681"}, {"introduction": "现实世界中的物理模型往往不是单一过程，而是多种物理现象的耦合，例如污染物在水中的输运同时涉及对流和扩散。这个练习将模拟这一场景，让你了解如何处理多重稳定性约束。当一个数值方案必须同时满足来自对流和扩散的两个不同条件时，你将学会如何确定最终允许的最大时间步长，这是一个在复杂多物理场仿真中必须掌握的关键技能。", "problem": "一位环境科学家正在创建一个数值模拟，用以模拟特定污染物在长直水道中的输运过程。该过程由一维平流-扩散方程控制，该方程描述了污染物浓度如何随空间和时间变化。这位科学家采用一种称为“前向时间中心空间”（Forward-Time Central-Space, FTCS）格式的特定数值算法来近似求解该方程。\n\n为了使此FTCS格式在数值上保持稳定并产生可靠的预测，所选的时间步长 $\\Delta t$ 和空间网格间距 $\\Delta x$ 必须满足基于系统物理特性的两个独立数学约束条件。污染物的特征是其输运速度（平流）$c$ 和扩散系数 $D$。两个稳定性条件是：\n\n1.  与扩散相关的条件：\n    $$ \\frac{2D \\Delta t}{(\\Delta x)^2} \\le 1 $$\n2.  防止由平流引起的非物理振荡的条件：\n    $$ \\frac{c^2 \\Delta t}{2D} \\le 1 $$\n\n模拟必须同时满足这两个条件。科学家使用以下参数设置了模型：\n-   输运速度，$c = 0.800 \\text{ m/s}$\n-   扩散系数，$D = 0.0500 \\text{ m}^2/\\text{s}$\n-   空间网格间距，$\\Delta x = 2.00 \\text{ m}$\n\n计算在此模拟中为保持数值稳定性可以使用的最大可能时间步长 $\\Delta t$。答案以秒 (s) 为单位，并四舍五入到三位有效数字。", "solution": "一维平流-扩散方程的FTCS稳定性约束条件由以下公式给出：\n$$\\frac{2D\\Delta t}{(\\Delta x)^{2}} \\le 1 \\quad \\Rightarrow \\quad \\Delta t \\le \\frac{(\\Delta x)^{2}}{2D}$$\n$$\\frac{c^{2}\\Delta t}{2D} \\le 1 \\quad \\Rightarrow \\quad \\Delta t \\le \\frac{2D}{c^{2}}$$\n为同时满足这两个条件，允许的最大时间步长是两个上界中的最小值：\n$$\\Delta t_{\\max}=\\min\\!\\left(\\frac{(\\Delta x)^{2}}{2D},\\,\\frac{2D}{c^{2}}\\right)$$\n代入给定值 $c=0.800\\,\\text{m/s}$，$D=0.0500\\,\\text{m}^{2}\\!/\\text{s}$ 和 $\\Delta x=2.00\\,\\text{m}$：\n$$\\frac{(\\Delta x)^{2}}{2D}=\\frac{(2.00)^{2}}{2(0.0500)}=\\frac{4.00}{0.100}=40.0\\,\\text{s}$$\n$$\\frac{2D}{c^{2}}=\\frac{2(0.0500)}{(0.800)^{2}}=\\frac{0.100}{0.640}=0.15625\\,\\text{s}$$\n因此，\n$$\\Delta t_{\\max}=\\min(40.0,\\,0.15625)=0.15625\\,\\text{s}$$\n四舍五入到三位有效数字，最大时间步长为 $0.156\\,\\text{s}$。", "answer": "$$\\boxed{0.156}$$", "id": "2164744"}, {"introduction": "为什么有些数值格式天生稳定，而另一些则不然？本练习将通过对流方程这个典型的双曲问题的研究，带你探索数值格式设计的核心。我们将直接比较两种广泛使用的空间离散格式——中心差分和迎风差分，并运用冯·诺伊曼稳定性分析来量化它们的表现。这个过程将揭示数值稳定性与信息传播方向之间的深刻联系，让你明白为何迎风格式在模拟波动现象中是如此关键。", "problem": "一位科学家正在使用线性平流方程对一维通道中示踪化学物质的输运进行数值模拟：\n$$ \\frac{\\partial \\phi}{\\partial t} + v \\frac{\\partial \\phi}{\\partial x} = 0 $$\n其中 $\\phi(x,t)$ 是示踪剂浓度，$v$ 是恒定的正向流速。该模拟使用间距为 $\\Delta x$ 的均匀空间网格和恒定的时间步长 $\\Delta t$。两种不同的数值算法正在被测试，两者均在时间上使用向前差分。\n- **算法 C (中心差分)：** 对空间导数 $\\frac{\\partial \\phi}{\\partial x}$ 使用中心差分近似。\n- **算法 U (迎风)：** 对空间导数 $\\frac{\\partial \\phi}{\\partial x}$ 使用一阶迎风（由于 $v>0$，即向后差分）近似。\n\n示踪剂浓度的初始状态是一个正弦波。为分析数值稳定性，该科学家关注解的单个傅里叶模态分量。在时间步 $n$ 和网格点 $j$ 上，该分量写作 $\\phi_j^n$。算法根据规则 $\\phi_j^{n+1} = G \\cdot \\phi_j^n$ 演化此模态，其中 $G$ 是复数放大因子，其值取决于所用算法、傅里叶模态的波数以及模拟参数。\n\n考虑一个特定的傅里叶模态，其波长为网格间距的四倍 ($\\lambda = 4 \\Delta x$)。模拟运行所使用的参数使得库朗数（定义为 $\\nu = \\frac{v \\Delta t}{\\Delta x}$）恰好为 $0.5$。\n\n设 $|G_C|$ 为算法 C 的放大因子的模，$|G_U|$ 为算法 U 的放大因子的模，两者均针对指定的傅里叶模态和库朗数计算。\n\n计算比率 $\\frac{|G_C|}{|G_U|}$。报告你的答案，结果应为实数并四舍五入到三位有效数字。", "solution": "我们对每种差分格式进行 von Neumann 分析。设库朗数为 $\\nu = \\frac{v \\Delta t}{\\Delta x}$，并考虑一个傅里叶模态 $\\phi_{j}^{n} = \\hat{\\phi}\\, G^{n} \\exp(i j \\theta)$，其中 $\\theta = k \\Delta x$ 且 $k = \\frac{2 \\pi}{\\lambda}$。\n\n对于算法 C（时间向前，空间中心），离散格式为\n$$\n\\frac{\\phi_{j}^{n+1} - \\phi_{j}^{n}}{\\Delta t} + v \\frac{\\phi_{j+1}^{n} - \\phi_{j-1}^{n}}{2 \\Delta x} = 0,\n$$\n可得\n$$\n\\phi_{j}^{n+1} = \\phi_{j}^{n} - \\nu \\frac{\\phi_{j+1}^{n} - \\phi_{j-1}^{n}}{2}.\n$$\n代入 $\\phi_{j\\pm 1}^{n} = \\phi_{j}^{n} \\exp(\\pm i \\theta)$ 以获得放大因子\n$$\nG_{C} = 1 - i \\nu \\sin \\theta.\n$$\n因此，\n$$\n|G_{C}| = \\sqrt{1 + \\nu^{2} \\sin^{2}\\theta}.\n$$\n\n对于算法 U（时间向前，对于$v>0$为迎风/后向空间差分），离散格式为\n$$\n\\frac{\\phi_{j}^{n+1} - \\phi_{j}^{n}}{\\Delta t} + v \\frac{\\phi_{j}^{n} - \\phi_{j-1}^{n}}{\\Delta x} = 0,\n$$\n可得\n$$\n\\phi_{j}^{n+1} = \\phi_{j}^{n} - \\nu \\left(\\phi_{j}^{n} - \\phi_{j-1}^{n}\\right).\n$$\n代入 $\\phi_{j-1}^{n} = \\phi_{j}^{n} \\exp(-i \\theta)$ 可得\n$$\nG_{U} = 1 - \\nu \\left(1 - \\exp(-i \\theta)\\right) = 1 - \\nu + \\nu \\exp(-i \\theta).\n$$\n因此，\n$$\n|G_{U}|^{2} = \\left[1 - \\nu \\left(1 - \\cos \\theta\\right)\\right]^{2} + \\left(\\nu \\sin \\theta\\right)^{2}.\n$$\n\n对于指定的模态，$\\lambda = 4 \\Delta x$ 给出 $k = \\frac{2 \\pi}{\\lambda} = \\frac{\\pi}{2 \\Delta x}$，因此 $\\theta = k \\Delta x = \\frac{\\pi}{2}$。当 $\\nu = 0.5$ 时，我们有 $\\sin \\theta = 1$ 和 $\\cos \\theta = 0$。因此，\n$$\n|G_{C}| = \\sqrt{1 + \\nu^{2} \\sin^{2}\\theta} = \\sqrt{1 + \\left(\\frac{1}{2}\\right)^{2}} = \\sqrt{\\frac{5}{4}} = \\frac{\\sqrt{5}}{2},\n$$\n$$\n|G_{U}|^{2} = \\left[1 - \\nu (1 - \\cos \\theta)\\right]^{2} + (\\nu \\sin \\theta)^{2} = \\left(1 - \\frac{1}{2}\\right)^{2} + \\left(\\frac{1}{2}\\right)^{2} = \\frac{1}{2},\n$$\n所以\n$$\n|G_{U}| = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}}.\n$$\n该比率为\n$$\n\\frac{|G_{C}|}{|G_{U}|} = \\frac{\\frac{\\sqrt{5}}{2}}{\\frac{1}{\\sqrt{2}}} = \\frac{\\sqrt{10}}{2} \\approx 1.58113883\\ldots\n$$\n四舍五入到三位有效数字，该比率为 $1.58$。", "answer": "$$\\boxed{1.58}$$", "id": "2164718"}]}