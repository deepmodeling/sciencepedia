{"hands_on_practices": [{"introduction": "在数值模拟中，我们常常希望通过加密网格（减小空间步长 $\\Delta x$）来提高计算精度。然而，对于显式格式，这一举动会带来一个必须正视的后果：为了维持数值稳定性，时间步长 $\\Delta t$ 必须被更大幅度地减小。这个练习将帮助你量化这种关系，揭示为何高分辨率模拟的计算成本会急剧增加。[@problem_id:2205166]", "problem": "一位数值分析师正在模拟一维均匀杆上的热扩散。温度的演化遵循热方程 $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$，其中 $u(x,t)$ 是温度，$t$ 是时间，$x$ 是沿杆的空间坐标，而 $\\alpha$ 是材料的恒定热扩散系数。\n\n该分析师使用前向时间中心空间（FTCS）方法进行模拟。在一次初始运行中，空间网格间距设置为 $\\Delta x_0$，时间步长设置为 $\\Delta t_0$。这些值的选择使得模拟在临界极限下运行，这意味着任何更大的时间步长都会导致数值解产生无界的非物理振荡。\n\n为了提高模拟的空间分辨率，该分析师决定进行一次新的运行，将空间网格间距减半，使得新的间距为 $\\Delta x_{new} = \\frac{1}{2}\\Delta x_0$。为确保这次新的、更高分辨率的模拟也在其相应的临界极限下运行以避免非物理振荡，必须将时间步长调整为一个新值 $\\Delta t_{new}$。\n\n确定要获得新的时间步长 $\\Delta t_{new}$，原始时间步长 $\\Delta t_0$ 必须乘以的数值因子。你的答案应该是一个单一的数值。", "solution": "对于在均匀网格上使用 FTCS 格式离散化的一维热方程，其更新公式为\n$$\nu_{j}^{n+1} = u_{j}^{n} + r\\left(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}\\right),\n$$\n其中无量纲参数为\n$$\nr = \\frac{\\alpha \\,\\Delta t}{\\Delta x^{2}}.\n$$\n对应用于热方程的 FTCS 进行的冯·诺依曼稳定性分析得出稳定性条件\n$$\nr \\leq \\frac{1}{2}.\n$$\n在临界极限下运行意味着等式成立。对于间距为 $\\Delta x_{0}$ 和 $\\Delta t_{0}$ 的初始运行，\n$$\n\\frac{\\alpha \\,\\Delta t_{0}}{\\Delta x_{0}^{2}} = \\frac{1}{2}\n\\quad \\Longrightarrow \\quad\n\\Delta t_{0} = \\frac{\\Delta x_{0}^{2}}{2\\alpha}.\n$$\n对于新的运行，空间步长减半，即 $\\Delta x_{\\text{new}} = \\frac{1}{2}\\Delta x_{0}$，为了保持在临界极限，我们要求\n$$\n\\frac{\\alpha \\,\\Delta t_{\\text{new}}}{\\Delta x_{\\text{new}}^{2}} = \\frac{1}{2}\n\\quad \\Longrightarrow \\quad\n\\Delta t_{\\text{new}} = \\frac{\\Delta x_{\\text{new}}^{2}}{2\\alpha}.\n$$\n代入 $\\Delta x_{\\text{new}} = \\frac{1}{2}\\Delta x_{0}$ 可得\n$$\n\\Delta t_{\\text{new}} = \\frac{\\left(\\frac{1}{2}\\Delta x_{0}\\right)^{2}}{2\\alpha} = \\frac{\\Delta x_{0}^{2}}{2\\alpha}\\cdot \\frac{1}{4} = \\Delta t_{0}\\cdot \\frac{1}{4}.\n$$\n因此，原始时间步长必须乘以因子 $\\frac{1}{4}$。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "2205166"}, {"introduction": "理解了稳定性的数学条件后，下一步是在实践中识别不稳定的迹象。当一个使用前向时间中心空间（FTCS）格式的模拟变得不稳定时，它通常不会随机地“爆炸”，而是会展现出一种特有的、高频振荡的“锯齿状”误差模式。这个练习将教你如何从模拟的视觉输出中诊断出这种不稳定现象，并将其与关键的稳定性参数 $r$ 直接联系起来，从而建立起理论与实践之间的直观联系。[@problem_id:2205209]", "problem": "一位初级工程师的任务是模拟一根细杆中的一维热传导。其控制方程为热方程 $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}$，其中 $T(x,t)$ 是温度，$\\alpha$ 是热扩散率。该工程师采用了前向时间中心空间 (Forward-Time Central-Space, FTCS) 数值格式，其离散形式为：\n$$T_j^{n+1} = T_j^n + r(T_{j+1}^n - 2T_j^n + T_{j-1}^n)$$\n此处，$T_j^n$ 代表在空间网格点 $j$ 和时间步长 $n$ 的温度。无量纲参数 $r$ 定义为 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$，其中 $\\Delta t$ 是时间步长，$\\Delta x$ 是空间网格间距。\n\n在使用一组特定参数运行模拟后，该工程师观察到数值解变得不符合物理规律。具体来说，一种高频的、正负误差交替出现的“锯齿状”模式出现在整个网格上，并且该模式的振幅随每个时间步呈指数增长，导致了数值溢出。\n\n根据观察到的数值解的这种行为，参数 $r$ 必须满足以下哪个条件？\n\nA. $r < 0$\n\nB. $0 < r \\le 0.25$\n\nC. $0.25 < r \\le 0.5$\n\nD. $r > 0.5$\n\nE. $r=1$", "solution": "我们通过冯·诺依曼 (傅里叶) 分析法来分析热方程的 FTCS 格式的稳定性。考虑一个形式为 $E_{j}^{n}=\\xi^{n}\\exp(i\\theta j)$ 的傅里叶误差单模，其中 $\\theta=k\\Delta x$，$\\xi$ 是每个时间步的放大因子。将 $T_{j}^{n}\\to E_{j}^{n}$ 代入更新方程：\n$$\nE_{j}^{n+1}=E_{j}^{n}+r\\left(E_{j+1}^{n}-2E_{j}^{n}+E_{j-1}^{n}\\right).\n$$\n两边除以 $E_{j}^{n}$ 并使用 $E_{j\\pm 1}^{n}/E_{j}^{n}=\\exp(\\pm i\\theta)$，得到\n$$\n\\xi=1+r\\left(\\exp(i\\theta)-2+\\exp(-i\\theta)\\right)=1+r\\left(2\\cos\\theta-2\\right).\n$$\n使用 $1-\\cos\\theta=2\\sin^{2}(\\theta/2)$，上式变为\n$$\n\\xi=1-2r\\left(1-\\cos\\theta\\right)=1-4r\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right).\n$$\n稳定性要求对于所有的 $\\theta\\in[0,\\pi]$，都有 $|\\xi|\\le 1$。最危险（最高频）的模式是 $\\theta=\\pi$，它对应于空间交替模式 $(-1)^{j}$；对于此模式，\n$$\n\\xi(\\pi)=1-4r.\n$$\n观察到的误差正是这种振幅随时间指数增长的空间交替“锯齿状”模式，这意味着 $|\\xi(\\pi)|>1$。因此，\n$$\n|1-4r|>1.\n$$\n求解此不等式得到两种情况：$1-4r>1\\Rightarrow r<0$，或者 $1-4r<-1\\Rightarrow r>\\frac{1}{2}$。由于 $r=\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}$，且 $\\alpha>0$、$\\Delta t>0$ 和 $\\Delta x>0$，因此物理上有意义的情况是 $r>\\frac{1}{2}$。因此，观察到的行为意味着 $r>\\frac{1}{2}$，这对应于选项 D。", "answer": "$$\\boxed{D}$$", "id": "2205209"}, {"introduction": "现实世界中的许多问题，如芯片散热或污染物扩散，都发生在二维或三维空间中。将我们对稳定性的理解从一维推广到多维至关重要。这个练习将带你进入一个更实际的二维热传导场景，你将发现，维数的增加使得稳定性条件变得更加严苛。通过计算，你将亲身体会到在多维问题中选择合适时间步长的重要性。[@problem_id:2205183]", "problem": "一位材料科学专业的学生正在进行一项数值模拟，以对一块薄矩形硅片上的热扩散进行建模。硅片上的温度分布 $u(x,y,t)$ 遵循二维热方程：\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\n该学生使用显式向前时间、中心空间 (FTCS) 有限差分法来实现数值解。对于模拟网格，采用以下参数：\n- 硅的热扩散系数，$\\alpha = 0.85 \\text{ cm}^2/\\text{s}$。\n- x方向的空间步长，$\\Delta x = 0.05 \\text{ cm}$。\n- y方向的空间步长，$\\Delta y = 0.12 \\text{ cm}$。\n\n为了防止数值解变得不稳定并产生无意义的结果，必须谨慎地选择时间步长 $\\Delta t$。计算可确保此次 FTCS 模拟稳定性的最大时间步长 $\\Delta t$。\n\n请以秒 (s) 为单位给出答案，并四舍五入至三位有效数字。", "solution": "该题目要求计算使得应用于二维热方程的向前时间、中心空间 (FTCS) 格式保持数值稳定的最大时间步长 $\\Delta t_{max}$。\n\n二维热方程如下所示：\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\n\nFTCS 格式将此方程离散化。时间导数使用向前差分进行近似，空间导数使用中心差分进行近似。令 $u_{i,j}^n$ 表示在空间网格点 $(i\\Delta x, j\\Delta y)$ 和时刻 $n\\Delta t$ 处的温度。离散化后的方程为：\n$$\n\\frac{u_{i,j}^{n+1} - u_{i,j}^{n}}{\\Delta t} = \\alpha \\left( \\frac{u_{i+1,j}^{n} - 2u_{i,j}^{n} + u_{i-1,j}^{n}}{(\\Delta x)^2} + \\frac{u_{i,j+1}^{n} - 2u_{i,j}^{n} + u_{i,j-1}^{n}}{(\\Delta y)^2} \\right)\n$$\n\n为使此显式格式保持稳定，用于更新 $u_{i,j}^{n+1}$ 的方程中的系数必须满足特定条件。冯·诺依曼稳定性分析表明，二维 FTCS 热方程的稳定性条件是：\n$$\n2 \\alpha \\Delta t \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right) \\le 1\n$$\n这也可以写成：\n$$\n\\Delta t \\le \\frac{1}{2\\alpha \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right)}\n$$\n\n最大允许时间步长 $\\Delta t_{max}$ 对应于上述不等式取等号的情况：\n$$\n\\Delta t_{max} = \\frac{1}{2\\alpha \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right)}\n$$\n\n现在，我们将给定值代入此表达式：\n- $\\alpha = 0.85 \\text{ cm}^2/\\text{s}$\n- $\\Delta x = 0.05 \\text{ cm}$\n- $\\Delta y = 0.12 \\text{ cm}$\n\n首先，我们计算涉及空间步长的各项：\n$$\n(\\Delta x)^2 = (0.05 \\text{ cm})^2 = 0.0025 \\text{ cm}^2\n$$\n$$\n(\\Delta y)^2 = (0.12 \\text{ cm})^2 = 0.0144 \\text{ cm}^2\n$$\n\n接下来，我们求其倒数：\n$$\n\\frac{1}{(\\Delta x)^2} = \\frac{1}{0.0025 \\text{ cm}^2} = 400 \\text{ cm}^{-2}\n$$\n$$\n\\frac{1}{(\\Delta y)^2} = \\frac{1}{0.0144 \\text{ cm}^2} \\approx 69.444... \\text{ cm}^{-2}\n$$\n\n现在，我们将这些值相加：\n$$\n\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} = 400 \\text{ cm}^{-2} + 69.444... \\text{ cm}^{-2} = 469.444... \\text{ cm}^{-2}\n$$\n\n最后，我们将这个和以及 $\\alpha$ 的值代入 $\\Delta t_{max}$ 的方程中：\n$$\n\\Delta t_{max} = \\frac{1}{2 \\cdot (0.85 \\text{ cm}^2/\\text{s}) \\cdot (469.444... \\text{ cm}^{-2})}\n$$\n$$\n\\Delta t_{max} = \\frac{1}{1.7 \\text{ cm}^2/\\text{s} \\cdot 469.444... \\text{ cm}^{-2}}\n$$\n$$\n\\Delta t_{max} = \\frac{1}{798.055... \\text{ s}^{-1}} \\approx 0.00125304 \\text{ s}\n$$\n\n题目要求答案四舍五入到三位有效数字。\n第一位有效数字是1，第二位是2，第三位是5。下一位数字是3，小于5，因此舍去。\n$$\n\\Delta t_{max} \\approx 0.00125 \\text{ s}\n$$", "answer": "$$\\boxed{0.00125}$$", "id": "2205183"}]}