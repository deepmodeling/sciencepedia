{"hands_on_practices": [{"introduction": "我们学习任何数值方法的最好方式都是从一个基础问题开始。这个练习将引导你完成有限差分法的核心过程：将一个带有狄利克雷边界条件的二阶常微分方程转化为一个线性代数方程组，并求解它[@problem_id:2173554]。通过手工解决一个 $2 \\times 2$ 的系统，你将对离散化、构建系数矩阵以及求解近似解的整个流程建立起直观的理解。", "problem": "考虑由常微分方程给出的二阶线性边值问题 (BVP)：\n$$ y'' + y = 0 $$\n该方程定义在区间 $x \\in [0, 1]$上，并服从边界条件 $y(0) = 0$ 和 $y(1) = 2$。\n\n您的任务是使用有限差分法求此边值问题的数值近似解。为此，将区间 $[0, 1]$ 以均匀步长 $h = 1/3$ 进行离散化。在任意内部网格点 $x_i$ 处的二阶导数 $y''$ 应使用二阶中心差分公式进行近似：\n$$ y''(x_i) \\approx \\frac{y_{i+1} - 2y_i + y_{i-1}}{h^2} $$\n其中 $y_i$ 表示真解 $y(x)$ 在网格点 $x_i$ 处的数值近似值。\n\n通过应用此方法，建立并求解关于内部网格点上解的未知值的线性代数方程组。\n\n请按顺序将您的最终答案表示为 $y(1/3)$ 和 $y(2/3)$ 的数值近似值。这些值必须以精确分数形式给出。", "solution": "我们将区间 $[0,1]$ 以均匀步长 $h=1/3$ 进行离散化，得到网格点 $x_{0}=0$，$x_{1}=1/3$，$x_{2}=2/3$，$x_{3}=1$。记 $y_{i}\\approx y(x_{i})$，边界值为 $y_{0}=0$ 和 $y_{3}=2$。内部的未知量是 $y_{1}$ 和 $y_{2}$。\n\n微分方程为 $y''+y=0$。在内部点 $x_{i}$ 处，对 $y''$ 使用二阶中心差分公式，\n$$\ny''(x_{i}) \\approx \\frac{y_{i+1}-2y_{i}+y_{i-1}}{h^{2}},\n$$\n我们得到，对于 $i=1,2$，\n$$\n\\frac{y_{i+1}-2y_{i}+y_{i-1}}{h^{2}}+y_{i}=0.\n$$\n两边乘以 $h^{2}$ 并代入 $h^{2}=1/9$ 得\n$$\ny_{i+1}-2y_{i}+y_{i-1}+\\frac{1}{9}y_{i}=0,\n$$\n化简为\n$$\ny_{i-1}-\\frac{17}{9}y_{i}+y_{i+1}=0.\n$$\n\n写出在 $i=1$ 和 $i=2$ 处的方程并代入边界值：\n- 对于 $i=1$：$y_{0}-\\frac{17}{9}y_{1}+y_{2}=0 \\implies -\\frac{17}{9}y_{1}+y_{2}=0$，因为 $y_{0}=0$。\n- 对于 $i=2$：$y_{1}-\\frac{17}{9}y_{2}+y_{3}=0 \\implies y_{1}-\\frac{17}{9}y_{2}=-y_{3}=-2$。\n\n因此，关于 $(y_{1},y_{2})^{T}$ 的线性系统为\n$$\n\\begin{pmatrix}\n-\\frac{17}{9} & 1 \\\\\n1 & -\\frac{17}{9}\n\\end{pmatrix}\n\\begin{pmatrix}\ny_{1} \\\\\ny_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n-2\n\\end{pmatrix}.\n$$\n由第一个方程，得 $y_{2}=\\frac{17}{9}y_{1}$。将其代入第二个方程：\n$$\ny_{1}-\\frac{17}{9}\\left(\\frac{17}{9}y_{1}\\right)=-2\n\\;\\;\\Longrightarrow\\;\\;\n\\left(1-\\frac{289}{81}\\right)y_{1}=-2\n\\;\\;\\Longrightarrow\\;\\;\n-\\frac{208}{81}y_{1}=-2.\n$$\n求解得\n$$\ny_{1}=\\frac{2\\cdot 81}{208}=\\frac{162}{208}=\\frac{81}{104}.\n$$\n然后\n$$\ny_{2}=\\frac{17}{9}y_{1}=\\frac{17}{9}\\cdot \\frac{81}{104}=\\frac{153}{104}.\n$$\n因此，所求的近似值为 $y(1/3)=\\frac{81}{104}$ 和 $y(2/3)=\\frac{153}{104}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{81}{104} & \\frac{153}{104} \\end{pmatrix}}$$", "id": "2173554"}, {"introduction": "真实世界的问题很少只涉及固定的边界值。这个练习引入了一个更常见的情况：诺伊曼（Neumann）边界条件，其中边界上的导数值是已知的[@problem_id:2171444]。你将学习如何使用有限差分来近似边界上的导数，并将其整合到你的线性方程组中，这是解决热通量、流体力学等应用问题的一项关键技能。", "problem": "考虑在区间 $x \\in [0, 1]$ 上定义的两点边值问题 (BVP)：\n$$\n-u''(x) = \\frac{\\pi^2}{4}\\sin\\left(\\frac{\\pi x}{2}\\right)\n$$\n其边界条件为：\n$$\nu(0) = 1 \\quad \\text{和} \\quad u'(1) = 1\n$$\n我们希望使用有限差分法求此边值问题的近似数值解。首先，将定义域 $[0, 1]$ 离散化为 $N=3$ 个相等的子区间，从而创建一个网格点 $x_i = ih$，$i=0, 1, 2, 3$，其中 $h=1/N$ 是步长。令 $U_i$ 为精确解 $u(x_i)$ 的数值近似。\n\n使用二阶精度中心差分公式近似二阶导数项 $u''(x_i)$：\n$$\nu''(x_i) \\approx \\frac{U_{i-1} - 2U_i + U_{i+1}}{h^2}\n$$\n对于在 $x_3 = 1$ 处的诺伊曼边界条件，使用一阶精度后向差分公式：\n$$\nu'(x_3) \\approx \\frac{U_3 - U_2}{h}\n$$\n通过建立并求解得到的关于未知值 $U_1$、$U_2$ 和 $U_3$ 的线性方程组，确定在 $x_2 = 2/3$ 处的数值解的值。\n\n计算 $U_2$ 的值，并将最终答案四舍五入到四位有效数字。", "solution": "我们将区间用 $N=3$ 进行离散化，因此步长 $h=1/3$，网格点为 $x_{i}=ih$，$i=0,1,2,3$。令 $U_{i}\\approx u(x_{i})$。边界数据为 $U_{0}=u(0)=1$，在 $x_3=1$ 处的诺伊曼条件通过后向差分近似为\n$$\nu'(x_{3}) \\approx \\frac{U_{3}-U_{2}}{h}=1 \\quad \\Rightarrow \\quad U_{3}=U_{2}+h=U_{2}+\\frac{1}{3}.\n$$\n对于内部节点 $i=1,2$，中心差分近似给出\n$$\n-\\frac{U_{i-1}-2U_{i}+U_{i+1}}{h^{2}}=\\frac{\\pi^{2}}{4}\\sin\\!\\left(\\frac{\\pi x_{i}}{2}\\right).\n$$\n当 $h^{2}=1/9$ 时，上式变为\n$$\nU_{i-1}-2U_{i}+U_{i+1}=-\\frac{1}{9}\\cdot\\frac{\\pi^{2}}{4}\\sin\\!\\left(\\frac{\\pi x_{i}}{2}\\right)=-\\frac{\\pi^{2}}{36}\\sin\\!\\left(\\frac{\\pi x_{i}}{2}\\right).\n$$\n在 $i=1$ 处，$x_{1}=1/3$，$\\sin(\\pi/6)=\\frac{1}{2}$，因此\n$$\nU_{0}-2U_{1}+U_{2}=-\\frac{\\pi^{2}}{36}\\cdot\\frac{1}{2}=-\\frac{\\pi^{2}}{72}.\n$$\n使用 $U_{0}=1$，\n$$\n-2U_{1}+U_{2}=-\\frac{\\pi^{2}}{72}-1.\n$$\n在 $i=2$ 处，$x_{2}=2/3$，$\\sin(\\pi/3)=\\frac{\\sqrt{3}}{2}$，因此\n$$\nU_{1}-2U_{2}+U_{3}=-\\frac{\\pi^{2}}{36}\\cdot\\frac{\\sqrt{3}}{2}=-\\frac{\\pi^{2}\\sqrt{3}}{72}.\n$$\n使用 $U_{3}=U_{2}+\\frac{1}{3}$，\n$$\nU_{1}-U_{2}+\\frac{1}{3}=-\\frac{\\pi^{2}\\sqrt{3}}{72}\\quad\\Rightarrow\\quad U_{1}-U_{2}=-\\frac{\\pi^{2}\\sqrt{3}}{72}-\\frac{1}{3}.\n$$\n因此，关于 $U_{1},U_{2}$ 的 $2\\times 2$ 方程组为\n$$\n\\begin{aligned}\n-2U_{1}+U_{2}&=-\\frac{\\pi^{2}}{72}-1,\\\\\nU_{1}-U_{2}&=-\\frac{\\pi^{2}\\sqrt{3}}{72}-\\frac{1}{3}.\n\\end{aligned}\n$$\n将第二个方程的两倍加到第一个方程上以消去 $U_{1}$，得到\n$$\n(-2U_{1}+U_{2})+2(U_{1}-U_{2})=-\\frac{\\pi^{2}}{72}-1-2\\left(\\frac{\\pi^{2}\\sqrt{3}}{72}+\\frac{1}{3}\\right),\n$$\n因此\n$$\n-U_{2}=-\\frac{5}{3}-\\frac{\\pi^{2}}{72}-\\frac{\\pi^{2}\\sqrt{3}}{36}\\quad\\Rightarrow\\quad U_{2}=\\frac{5}{3}+\\frac{\\pi^{2}}{72}+\\frac{\\pi^{2}\\sqrt{3}}{36}=\\frac{5}{3}+\\frac{\\pi^{2}}{72}\\left(1+2\\sqrt{3}\\right).\n$$\n为了求出所要求的数值，使用 $\\pi^{2}\\approx 9.869604401089358$ 和 $\\sqrt{3}\\approx 1.732050807568877$：\n$$\nU_{2}\\approx \\frac{5}{3}+\\frac{9.869604401089358}{72}\\left(1+2\\cdot 1.732050807568877\\right)\\approx 2.2785960874,\n$$\n四舍五入到四位有效数字为 $2.279$。", "answer": "$$\\boxed{2.279}$$", "id": "2171444"}, {"introduction": "获得数值解只是第一步，评估并提高其精度同样重要。这个练习介绍了一种强大的技术——理查森外推法（Richardson extrapolation），它利用从不同步长获得的数值解来构造一个更高阶的、更精确的近似值[@problem_id:2171447]。通过这个练习，你将了解到如何系统性地消除误差的主要部分，从而在不进行大量额外计算的情况下显著提升解的质量。", "problem": "一个用于描述长度为 $L=1$ 的薄散热片上稳态温度分布 $T(x)$ 的一维模型，由一个二阶常微分方程控制。对于两端温度固定的特定配置，其边值问题由以下公式给出：\n$$ \\frac{d^2T}{dx^2} + \\pi^2 \\sin(\\pi x) = 0, \\quad \\text{for } x \\in [0, 1] $$\n边界条件为 $T(0) = 0$ 和 $T(1) = 0$。\n\n一位分析师使用一种已知的二阶精度有限差分法对此问题进行数值求解，以求得散热片中点 $x=1/2$ 处的温度。这意味着数值近似值 $S(h)$ 的误差形式为 $Ch^2 + O(h^4)$，其中 $h$ 是均匀步长，$C$ 是一个常数。\n\n进行了两次独立的计算：\n1.  使用步长 $h_1 = 1/2$ 时，计算出的 $x=1/2$ 处的温度为 $S(h_1) = \\frac{\\pi^2}{8}$。\n2.  使用更精细的步长 $h_2 = 1/4$ 时，计算出的 $x=1/2$ 处的温度为 $S(h_2) = \\frac{\\pi^2(2+\\sqrt{2})}{32}$。\n\n使用这两次数值计算结果，应用理查森外推法来获得散热片中点温度的一个更精确的估计值。将最终答案表示为含 $\\pi$ 的符号表达式。", "solution": "我们已知中点温度的有限差分近似是二阶精度的，因此数值 $S(h)$ 满足\n$$\nS(h)=T+\\;C\\,h^{2}+O(h^{4}),\n$$\n其中 $T$ 是精确的中点值，$C$ 是一个与 $h$ 无关的常数，$O(h^{4})$ 表示高阶项。对于满足 $h_{2}=\\frac{h_{1}}{2}$ 的两个步长 $h_{1}$ 和 $h_{2}$，我们有\n$$\nS(h_{1})=T+C\\,h_{1}^{2}+O(h_{1}^{4}), \\qquad S\\!\\left(h_{2}\\right)=T+C\\,\\left(\\frac{h_{1}}{2}\\right)^{2}+O\\!\\left(h_{1}^{4}\\right)=T+\\frac{C\\,h_{1}^{2}}{4}+O\\!\\left(h_{1}^{4}\\right).\n$$\n将第二个方程乘以 $4$：\n$$\n4\\,S\\!\\left(h_{2}\\right)=4T+C\\,h_{1}^{2}+O\\!\\left(h_{1}^{4}\\right).\n$$\n减去 $S(h_{1})$:\n$$\n4\\,S\\!\\left(h_{2}\\right)-S(h_{1})=3T+O\\!\\left(h_{1}^{4}\\right).\n$$\n因此，消除了 $C\\,h^{2}$ 误差项的理查森外推估计值为\n$$\nT \\approx \\frac{4\\,S\\!\\left(h_{2}\\right)-S(h_{1})}{3}.\n$$\n代入给定值 $S(h_{1})=\\frac{\\pi^{2}}{8}$ 和 $S(h_{2})=\\frac{\\pi^{2}\\left(2+\\sqrt{2}\\right)}{32}$：\n$$\n4\\,S(h_{2})=\\frac{\\pi^{2}\\left(2+\\sqrt{2}\\right)}{8}, \\quad 4\\,S(h_{2})-S(h_{1})=\\frac{\\pi^{2}\\left(2+\\sqrt{2}\\right)}{8}-\\frac{\\pi^{2}}{8}=\\frac{\\pi^{2}\\left(1+\\sqrt{2}\\right)}{8}.\n$$\n因此，\n$$\nT \\approx \\frac{1}{3}\\,\\frac{\\pi^{2}\\left(1+\\sqrt{2}\\right)}{8}=\\frac{\\pi^{2}\\left(1+\\sqrt{2}\\right)}{24}.\n$$", "answer": "$$\\boxed{\\frac{\\pi^{2}\\left(1+\\sqrt{2}\\right)}{24}}$$", "id": "2171447"}]}