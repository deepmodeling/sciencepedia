{"hands_on_practices": [{"introduction": "将理论转化为代码的第一步是理解数值格式的代数结构。本练习旨在通过构建一个小型系统，将 Crank-Nicolson 方法从一个抽象的差分方程，具体化为一个矩阵方程 $A\\mathbf{u}^{n+1} = B\\mathbf{u}^{n}$ [@problem_id:2139888]。通过亲手构建这些矩阵，您将能清晰地看到该方法如何将下一时刻的解（$n+1$）与当前时刻的解（$n$）联系起来，并体会到其三对角矩阵结构的由来。", "problem": "考虑一维热传导方程，$u_t = \\alpha u_{xx}$，其中函数 $u(x, t)$ 定义在空间域 $x \\in [0, L]$ 和时间 $t \\geq 0$ 上。该方程满足齐次狄利克雷边界条件，$u(0, t) = u(L, t) = 0$。\n\n我们希望使用克兰克-尼科尔森（Crank-Nicolson）方法对该方程进行数值求解。空间域被离散化为一个均匀网格，其间距为 $\\Delta x$，且恰好有三个内部网格点。设 $\\Delta t$ 为时间步长。该方法得到一个形如 $A\\mathbf{u}^{n+1} = B\\mathbf{u}^{n}$ 的矩阵系统，其中 $\\mathbf{u}^{k}$ 是在时间步 $k$ 时三个内部网格点上数值解的列向量。\n\n定义参数 $\\lambda$ 为 $\\lambda = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。\n\n以下哪个选项正确地给出了 $3 \\times 3$ 矩阵 $A$ 和 $B$？\n\nA. $A = \\begin{pmatrix} 1+\\lambda & -\\frac{\\lambda}{2} & 0 \\\\ -\\frac{\\lambda}{2} & 1+\\lambda & -\\frac{\\lambda}{2} \\\\ 0 & -\\frac{\\lambda}{2} & 1+\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1-\\lambda & \\frac{\\lambda}{2} & 0 \\\\ \\frac{\\lambda}{2} & 1-\\lambda & \\frac{\\lambda}{2} \\\\ 0 & \\frac{\\lambda}{2} & 1-\\lambda \\end{pmatrix}$\n\nB. $A = \\begin{pmatrix} 1-\\lambda & \\frac{\\lambda}{2} & 0 \\\\ \\frac{\\lambda}{2} & 1-\\lambda & \\frac{\\lambda}{2} \\\\ 0 & \\frac{\\lambda}{2} & 1-\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1+\\lambda & -\\frac{\\lambda}{2} & 0 \\\\ -\\frac{\\lambda}{2} & 1+\\lambda & -\\frac{\\lambda}{2} \\\\ 0 & -\\frac{\\lambda}{2} & 1+\\lambda \\end{pmatrix}$\n\nC. $A = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$, $B = \\begin{pmatrix} 1-2\\lambda & \\lambda & 0 \\\\ \\lambda & 1-2\\lambda & \\lambda \\\\ 0 & \\lambda & 1-2\\lambda \\end{pmatrix}$\n\nD. $A = \\begin{pmatrix} 1+2\\lambda & -\\lambda & 0 \\\\ -\\lambda & 1+2\\lambda & -\\lambda \\\\ 0 & -\\lambda & 1+2\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$", "solution": "我们用均匀间距 $\\Delta x$ 离散化空间区间，并记内部索引为 $i=1,2,3$。齐次狄利克雷边界条件意味着对于所有的 $n$，都有 $u_{0}^{n}=0$ 和 $u_{4}^{n}=0$。\n\n设 $u_{i}^{n}$ 近似 $u(x_{i}, t^{n})$。$u_{t}=\\alpha u_{xx}$ 在内部点 $i$ 处的克兰克-尼科尔森（Crank–Nicolson）离散格式为\n$$\n\\frac{u_{i}^{n+1}-u_{i}^{n}}{\\Delta t}\n=\\frac{\\alpha}{2}\\left(\\frac{u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n}}{(\\Delta x)^{2}}+\\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{(\\Delta x)^{2}}\\right).\n$$\n设 $\\lambda=\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}$，方程两边同乘 $\\Delta t$ 得到\n$$\nu_{i}^{n+1}-u_{i}^{n}\n=\\frac{\\lambda}{2}\\left[(u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n})+(u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1})\\right].\n$$\n重新整理，将未知时间层 $n+1$ 的项收集到左边，时间层 $n$ 的项收集到右边，可得\n$$\n\\left(1+\\lambda\\right)u_{i}^{n+1}-\\frac{\\lambda}{2}u_{i+1}^{n+1}-\\frac{\\lambda}{2}u_{i-1}^{n+1}\n=\\left(1-\\lambda\\right)u_{i}^{n}+\\frac{\\lambda}{2}u_{i+1}^{n}+\\frac{\\lambda}{2}u_{i-1}^{n}.\n$$\n由于边界值为零，没有出现额外的边界项。将 $i=1,2,3$ 的该方程组写成矩阵形式 $A\\mathbf{u}^{n+1}=B\\mathbf{u}^{n}$，其中 $\\mathbf{u}^{k}=(u_{1}^{k},u_{2}^{k},u_{3}^{k})^{T}$，则矩阵为\n$$\nA=\\begin{pmatrix}\n1+\\lambda & -\\frac{\\lambda}{2} & 0 \\\\\n-\\frac{\\lambda}{2} & 1+\\lambda & -\\frac{\\lambda}{2} \\\\\n0 & -\\frac{\\lambda}{2} & 1+\\lambda\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix}\n1-\\lambda & \\frac{\\lambda}{2} & 0 \\\\\n\\frac{\\lambda}{2} & 1-\\lambda & \\frac{\\lambda}{2} \\\\\n0 & \\frac{\\lambda}{2} & 1-\\lambda\n\\end{pmatrix}.\n$$\n这与选项A一致。", "answer": "$$\\boxed{A}$$", "id": "2139888"}, {"introduction": "一个成功的模拟不仅依赖于准确的演化方程，还依赖于对初始条件的精确描述。本练习 [@problem_id:2139861] 探讨了一个实际应用中常见的问题：如何在离散的网格上表示一个理想化的初始脉冲，例如由狄拉克 $\\delta$ 函数描述的点源注入。这不仅是一个技术问题，更是一个关乎物理守恒定律的基本问题，它将帮助您理解连续模型与其离散近似之间的桥梁。", "problem": "一位计算物理学家正在建立一个模拟，以模拟一种化学染料在一根长度为 $L=5.0$ 米的长而细的一维管中的扩散。染料的浓度 $u(x,t)$ 由一维扩散偏微分方程(PDE) $u_t = D u_{xx}$ 控制，其中 $D$ 是扩散系数。管的两端连接到维持零浓度的大型蓄水池，从而得到边界条件 $u(0,t) = u(L,t) = 0$。\n\n在实验开始时，$t=0$，单位量的染料被精确注入到位置 $x_0 = 3.6$ 米处。这个初始状态在数学上被建模为一个狄拉克δ函数：$u(x,0) = \\delta(x-x_0)$。\n\n为了数值求解该偏微分方程，空间域 $[0, L]$ 被离散化为 $N=125$ 个相等的子区间。网格点由 $x_j = j \\Delta x$ 表示，其中 $j=0, 1, \\dots, N$。系统在任何时刻的状态由内部网格点上的浓度向量表示。因此，初始状态是一个向量 $\\mathbf{u}^0$，其中分量 $u_j^0$ 代表浓度 $u(x_j, 0)$。\n\n为了恰当地表示瞬时注入，该物理学家决定只在对应于注入位置 $x_0$ 的单个网格点上赋予一个非零浓度值，而将所有其他内部网格点的浓度设为零。这个非零浓度的值必须这样选择：使得离散系统中的染料总量与连续系统中的总量相同（根据δ函数的性质，该值为1）。\n\n确定初始状态向量 $\\mathbf{u}^0$ 中这个单一非零分量的数值。用 m$^{-1}$ 单位表示你的答案。", "solution": "我们将区间 $[0,L]$ 离散化为 $N$ 个相等的子区间，因此网格间距为 $\\Delta x = \\frac{L}{N}$，网格点为 $x_{j} = j \\Delta x$，其中 $j=0,1,\\dots,N$。染料总量的离散近似由内部节点上的黎曼和给出：\n$$\n\\sum_{j=1}^{N-1} u_{j}^{0}\\,\\Delta x \\approx \\int_{0}^{L} u(x,0)\\,dx.\n$$\n连续初始条件为 $u(x,0)=\\delta(x-x_{0})$，因此\n$$\n\\int_{0}^{L} u(x,0)\\,dx = \\int_{0}^{L} \\delta(x-x_{0})\\,dx = 1.\n$$\n物理学家只在网格索引 $k$ 处（使得 $x_{k}=x_{0}$）赋予一个非零值。通过这种选择，离散总量恰好为\n$$\n\\sum_{j=1}^{N-1} u_{j}^{0}\\,\\Delta x = u_{k}^{0}\\,\\Delta x.\n$$\n质量守恒要求 $u_{k}^{0}\\,\\Delta x = 1$，所以\n$$\nu_{k}^{0} = \\frac{1}{\\Delta x} = \\frac{N}{L}.\n$$\n根据给定的数据，$L=5.0$ 和 $N=125$，所以 $\\Delta x = \\frac{L}{N} = \\frac{5.0}{125}$ 且 $x_{0} = 3.6$ 满足 $x_{0}/\\Delta x = \\frac{3.6}{5.0/125} = 90$，这证实了 $x_{0}$ 恰好位于一个内部网格点上。因此，\n$$\nu_{k}^{0} = \\frac{N}{L} = \\frac{125}{5.0} = 25,\n$$\n其单位为 $\\text{m}^{-1}$，正如一维中δ函数归一化所要求的那样。", "answer": "$$\\boxed{25}$$", "id": "2139861"}, {"introduction": "Crank-Nicolson 方法因其无条件稳定性而备受青睐，但这并不意味着它在任何情况下都能产生物理上合理的结果。本练习 [@problem_id:2139894] 将作为一个“压力测试”，探索该方法在处理不光滑初始条件和大时间步长时的行为。通过计算，您将发现即使是稳定的数值格式也可能产生非物理的振荡，这强调了在选择离散化参数时进行批判性思考的重要性。", "problem": "考虑定义在空间域 $x \\in [0, L]$ 上的一维热传导方程 $u_t = \\alpha u_{xx}$。杆件受齐次狄利克雷边界条件约束，即对于所有时间 $t \\ge 0$，有 $u(0, t) = u(L, t) = 0$。\n\n该方程将使用 Crank-Nicolson 有限差分格式进行数值求解。空间域被离散化为 $N_x$ 个等大的区间，区间大小为 $\\Delta x = L/N_x$，网格点标记为 $x_j = j \\Delta x$，其中 $j=0, 1, \\dots, N_x$。时间以恒定的步长 $\\Delta t$ 进行离散化，时间层为 $t_n = n \\Delta t$。解 $u(x_j, t_n)$ 的数值近似值记为 $u_j^n$。\n\nCrank-Nicolson 格式由下式给出：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} + \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} \\right)\n$$\n\n对于此问题，使用以下参数：\n-   杆长，$L = 1.0$。\n-   热扩散系数，$\\alpha = 1.0$。\n-   空间区间数，$N_x = 4$。这导致了三个内部网格点。\n-   $t=0$ 时的初始条件是一个尖锐的局部脉冲，在网格上近似为：将中心内部点的温度设置为 $u_2^0 = 2.0$，并将所有其他内部点的温度设置为零。\n-   计算网格比设置为 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} = 10.0$。这对应于一个大的时间步长，选择该值是为了研究方法在这种条件下的行为。\n\n您的任务是计算第一个时间步长后，中心内部网格点处的解的值 $u_2^1$。请用最简分数表示您的答案。", "solution": "我们使用 Crank-Nicolson 格式对 $x\\in[0,L]$ 上的具有齐次狄利克雷边界条件的热传导方程 $u_{t}=\\alpha u_{xx}$ 进行离散化。设网格比为 $r=\\alpha \\Delta t/(\\Delta x)^{2}$，则内部节点的 Crank-Nicolson 更新公式为\n$$\nu_{j}^{n+1}-u_{j}^{n}=\\frac{r}{2}\\Big[(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n})+(u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1})\\Big].\n$$\n重新整理，将 $n+1$ 时间层的项移到左边，对于 $j=1,2,3$，我们得到\n$$\n-\\frac{r}{2}u_{j-1}^{n+1}+(1+r)u_{j}^{n+1}-\\frac{r}{2}u_{j+1}^{n+1}=(1-r)u_{j}^{n}+\\frac{r}{2}(u_{j-1}^{n}+u_{j+1}^{n}),\n$$\n其中 $u_{0}^{n}=u_{4}^{n}=0$。\n\n当 $N_{x}=4$ 时，第一步的内部未知量是 $u_{1}^{1},u_{2}^{1},u_{3}^{1}$，初始条件是 $u_{1}^{0}=0$, $u_{2}^{0}=2$, $u_{3}^{0}=0$。将这些值和边界值代入右侧，得到以下线性系统\n$$\n(1+r)u_{1}^{1}-\\frac{r}{2}u_{2}^{1}=r,\n$$\n$$\n-\\frac{r}{2}u_{1}^{1}+(1+r)u_{2}^{1}-\\frac{r}{2}u_{3}^{1}=2-2r,\n$$\n$$\n-\\frac{r}{2}u_{2}^{1}+(1+r)u_{3}^{1}=r.\n$$\n根据对称性，$u_{1}^{1}=u_{3}^{1}$；记 $a=u_{1}^{1}=u_{3}^{1}$ 且 $b=u_{2}^{1}$。系统简化为\n$$\n(1+r)a-\\frac{r}{2}b=r,\n$$\n$$\n-ra+(1+r)b=2-2r.\n$$\n由第一个方程可得 $a=\\big(r+\\frac{r}{2}b\\big)/(1+r)$。将其代入第二个方程得到\n$$\n-\\frac{r\\big(r+\\frac{r}{2}b\\big)}{1+r}+(1+r)b=2-2r.\n$$\n两边同乘以 $(1+r)$ 并合并含 $b$ 的项，\n$$\n-r^{2}-\\frac{r^{2}}{2}b+(1+2r+r^{2})b=2-2r^{2},\n$$\n$$\n\\Big(1+2r+\\frac{r^{2}}{2}\\Big)b=2-r^{2}.\n$$\n因此，\n$$\nb=\\frac{2-r^{2}}{1+2r+\\frac{r^{2}}{2}}=\\frac{4-2r^{2}}{r^{2}+4r+2}.\n$$\n给定网格比 $r=10$，可得\n$$\nu_{2}^{1}=b=\\frac{4-2\\cdot 100}{100+40+2}=\\frac{-196}{142}=-\\frac{98}{71}.\n$$\n因此，第一个时间步长后中心内部网格点的值为 $-\\frac{98}{71}$。", "answer": "$$\\boxed{-\\frac{98}{71}}$$", "id": "2139894"}]}