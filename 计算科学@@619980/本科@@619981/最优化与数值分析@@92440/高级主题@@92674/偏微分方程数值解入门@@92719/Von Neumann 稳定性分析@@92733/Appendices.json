{"hands_on_practices": [{"introduction": "冯·诺依曼稳定性分析不仅告诉我们一个数值格式是否稳定，更能揭示其背后的物理原理。平流方程是模拟物质输运的基本模型，其核心特征是信息沿特定方向传播。因此，一个稳健的数值格式必须尊重这种方向性。\n\n本练习 [@problem_id:2225619] 探讨了一个看似合理但实际上存在问题的场景：当平流速度为负时，采用“前向时间，后向空间”（FTBS）格式。通过分析，你将亲手揭示为何这种“逆风”的差分格式会导致无条件不稳定，从而深刻理解“迎风格式”（upwind scheme）在模拟平流现象时的至关重要性。", "problem": "一位气象学家正在开发一个用于模拟冷锋的一维数值模型。温度分布 $T(x,t)$ 由以下线性平流方程控制：\n$$\n\\frac{\\partial T}{\\partial t} + v \\frac{\\partial T}{\\partial x} = 0\n$$\n其中速度 $v$ 是一个负常数，表示锋面从右向左移动（沿 $x$ 轴负方向）。\n\n为了对该方程进行数值求解，定义了一个网格，其均匀空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。设 $T_j^n$ 表示在位置 $x_j = j\\Delta x$ 和时间 $t_n = n\\Delta t$ 时温度的数值近似。所提出的数值格式是一种时间向前、空间向后 (FTBS) 的方法，其离散形式为：\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} + v \\frac{T_j^n - T_{j-1}^n}{\\Delta x} = 0\n$$\n\n该格式的稳定性通过库朗数进行分析，对于本问题，我们将其定义为 $\\alpha = \\frac{v \\Delta t}{\\Delta x}$。注意，由于 $v  0$，库朗数 $\\alpha$ 也为负。\n\n使用 von Neumann 稳定性分析，确定在给定 $v  0$ 的平流问题中，此特定 FTBS 格式的稳定性。从以下选项中选择正确的结论。\n\nA) 该格式是稳定的，当且仅当 $-1 \\le \\alpha \\le 0$。\n\nB) 该格式是稳定的，当且仅当 $-2 \\le \\alpha \\le 0$。\n\nC) 该格式对于所有有效的 $\\alpha  0$ 都是无条件稳定的。\n\nD) 该格式对于任何 $\\alpha  0$ 都是无条件不稳定的。", "solution": "我们从 FTBS 离散化形式开始\n$$\n\\frac{T_{j}^{n+1}-T_{j}^{n}}{\\Delta t}+v\\frac{T_{j}^{n}-T_{j-1}^{n}}{\\Delta x}=0,\n$$\n它可以写成\n$$\nT_{j}^{n+1}=T_{j}^{n}-\\alpha\\left(T_{j}^{n}-T_{j-1}^{n}\\right),\n\\qquad \\alpha=\\frac{v\\Delta t}{\\Delta x}.\n$$\n通过代入傅里叶模 $T_{j}^{n}=\\hat{T}^{n}\\exp(i\\kappa j)$（其中 $\\kappa=k\\Delta x$）来进行 von Neumann 分析。这得出 $T_{j-1}^{n}=\\exp(-i\\kappa)T_{j}^{n}$，因此由 $T_{j}^{n+1}=G\\,T_{j}^{n}$ 定义的放大因子 $G$ 满足\n$$\nG=1-\\alpha\\left(1-\\exp(-i\\kappa)\\right).\n$$\n其模的平方为\n$$\n|G|^2=\\left[1-\\alpha\\left(1-\\cos\\kappa\\right)\\right]^{2}+\\left[\\alpha\\sin\\kappa\\right]^{2}.\n$$\n使用 $(1-\\cos\\kappa)^{2}+\\sin^{2}\\kappa=2-2\\cos\\kappa$ 展开并化简，可得\n$$\n|G|^2=1-2\\alpha(1-\\cos\\kappa)+\\alpha^{2}\\left(2-2\\cos\\kappa\\right)\n=1+2\\alpha(\\alpha-1)\\left(1-\\cos\\kappa\\right).\n$$\n为了保证稳定性，我们要求对于所有的 $\\kappa$，都有 $|G|\\leq 1$，即：\n$$\n|G|^2\\leq 1 \\quad \\text{for all } \\kappa.\n$$\n因为对于所有的 $\\kappa$，都有 $1-\\cos\\kappa\\geq 0$，所以条件 $|G|^2\\leq 1$ 对所有 $\\kappa$ 成立等价于\n$$\n\\alpha(\\alpha-1)\\leq 0 \\quad \\Longleftrightarrow \\quad 0\\leq \\alpha \\leq 1.\n$$\n在本问题中，$v0$ 意味着 $\\alpha=\\frac{v\\Delta t}{\\Delta x}0$，因此稳定区间 $0\\leq \\alpha \\leq 1$ 对于任何有效的负值 $\\alpha$ 都无法满足。因此，对于应用于向左平流（$v0$）的此 FTBS 格式，该方法对于任何 $\\alpha0$ 都是不稳定的。\n\n因此，正确的选项是该格式对于任何 $\\alpha0$ 都是无条件不稳定的。", "answer": "$$\\boxed{D}$$", "id": "2225619"}, {"introduction": "在现实世界中，物理系统往往涉及多种过程的相互作用，例如化学反应与物质扩散。当我们将这些复杂的系统转化为数值模型时，稳定性分析也需要考虑所有这些过程的综合影响。\n\n这个练习 [@problem_id:2225594] 将带领你分析一个包含扩散项和反应项的方程。通过推导其“前向时间，中心空间”（FTCS）格式的稳定性条件，你将具体看到来自扩散和反应的限制是如何共同决定最大允许时间步长 $\\Delta t$ 的。这有助于培养在处理多物理场耦合问题时进行综合分析的能力。", "problem": "考虑一个一维系统，其中衰变物质的浓度 $u(x,t)$ 由以下反应扩散方程所描述：\n$$ \\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} - \\lambda u $$\n在此，$D$ 是正常数扩散系数，$\\lambda$ 是正常数衰变率常数。\n\n为了数值求解该方程，我们采用前向时间中心空间（FTCS）有限差分格式。该区域使用均匀空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 进行离散化。在位置 $j\\Delta x$ 和时间 $n\\Delta t$ 的浓度记为 $u_j^n$。该方程的 FTCS 离散格式由下式给出：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} = D \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} - \\lambda u_j^n $$\n为使该数值格式能产生一个稳定的解，且不表现出非物理的、增长的振荡，时间步长 $\\Delta t$ 不得超过某个临界值 $\\Delta t_{crit}$。请找出该临界时间步长 $\\Delta t_{crit}$ 关于物理参数 $D$、$\\lambda$ 和空间步长 $\\Delta x$ 的闭式表达式。", "solution": "我们从离散偏微分方程（PDE）得到的 FTCS 更新格式开始，\n$$\n\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=D\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{(\\Delta x)^{2}}-\\lambda u_{j}^{n}.\n$$\n将其改写为显式格式，并引入扩散CFL数 $\\mu:=D\\Delta t/(\\Delta x)^{2}$，得到\n$$\nu_{j}^{n+1}=u_{j}^{n}+\\mu\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right)-\\lambda\\Delta t\\,u_{j}^{n}.\n$$\n为了分析稳定性，我们进行 von Neumann 分析。假设一个傅里叶模 $u_{j}^{n}=g^{n}\\exp(i k j \\Delta x)$，其中 $g$ 是放大因子， $k$ 是波数。则\n$$\nu_{j\\pm 1}^{n}=g^{n}\\exp\\!\\left(i k (j\\pm 1)\\Delta x\\right)=g^{n}\\exp(i k j \\Delta x)\\exp(\\pm i k \\Delta x).\n$$\n代入更新格式得到\n$$\ng\\,\\exp(i k j \\Delta x)=\\exp(i k j \\Delta x)\\left[1-\\lambda\\Delta t+\\mu\\left(\\exp(i k \\Delta x)-2+\\exp(-i k \\Delta x)\\right)\\right].\n$$\n消去公因子，并使用 $\\exp(i\\theta)+\\exp(-i\\theta)=2\\cos\\theta$（其中 $\\theta:=k\\Delta x$），我们得到\n$$\ng=1-\\lambda\\Delta t+\\mu\\left(2\\cos\\theta-2\\right)=1-\\lambda\\Delta t-2\\mu\\left(1-\\cos\\theta\\right).\n$$\n等价地，使用 $1-\\cos\\theta=2\\sin^2(\\theta/2)$，\n$$\ng=1-\\lambda\\Delta t-4\\mu\\sin^2\\!\\left(\\frac{\\theta}{2}\\right).\n$$\n为保证稳定性，我们需要对所有 $\\theta\\in[0,\\pi]$ 都有 $|g|\\leq 1$。由于 $g$ 是实数，并且随 $\\sin^2(\\theta/2)$ 单调递减，其最大值在 $\\theta=0$ 处取得，最小值在 $\\theta=\\pi$ 处取得：\n$$\ng_{\\max}=1-\\lambda\\Delta t,\\qquad g_{\\min}=1-\\lambda\\Delta t-4\\mu.\n$$\n对于 $\\Delta t\\geq 0$ ，上界 $g_{\\max}\\leq 1$ 自动成立。下界要求 $g_{\\min}\\geq -1$，即\n$$\n1-\\lambda\\Delta t-4\\mu\\geq -1 \\quad\\Longrightarrow\\quad \\lambda\\Delta t+4\\mu\\leq 2.\n$$\n代入 $\\mu=D\\Delta t/(\\Delta x)^{2}$ 得到\n$$\n\\lambda\\Delta t+4\\frac{D\\Delta t}{(\\Delta x)^{2}}\\leq 2 \\quad\\Longrightarrow\\quad \\Delta t\\left(\\lambda+\\frac{4D}{(\\Delta x)^{2}}\\right)\\leq 2.\n$$\n因此，临界时间步长为\n$$\n\\Delta t_{\\text{crit}}=\\frac{2}{\\lambda+\\frac{4D}{(\\Delta x)^{2}}}.\n$$\n当 $D=0$ （纯衰变）时，该结果正确地简化为 $\\Delta t_{\\text{crit}}=2/\\lambda$；当 $\\lambda=0$ 时，该结果正确地简化为标准的 FTCS 扩散界限 $\\Delta t_{\\text{crit}}=(\\Delta x)^{2}/(2D)$。", "answer": "$$\\boxed{\\frac{2}{\\lambda+\\frac{4D}{(\\Delta x)^{2}}}}$$", "id": "2225594"}, {"introduction": "从一维理论走向多维应用，是数值方法学习的关键一步。在计算机图形学或流体动力学等领域，我们常常需要在二维或三维空间中求解包含平流和扩散的复杂方程。\n\n本练习 [@problem_id:2449689] 提供了一个模拟二维烟雾流动的实际案例，其控制方程为平流扩散方程。你需要为一个混合格式（平流项使用迎风差分，扩散项使用中心差分）推导稳定性条件。这个综合性问题将前面学到的所有概念——迎风格式、扩散限制、多维分析——融为一体，是检验和巩固你冯·诺依曼分析技能的绝佳实践。", "problem": "考虑用于计算机图形学中模拟烟雾密度的无源标量场 $\\rho(x,y,t)$ 的二维输运，该过程由以下线性对流-扩散方程控制\n$$\n\\partial_t \\rho + u_x \\,\\partial_x \\rho + u_y \\,\\partial_y \\rho \\;=\\; \\kappa \\left(\\partial_{xx} \\rho + \\partial_{yy} \\rho\\right),\n$$\n其中，$u_x$ 和 $u_y$ 是恒定速度，单位为 $\\mathrm{m/s}$，$\\kappa$ 是恒定扩散系数，单位为 $\\mathrm{m^2/s}$。计算域在均匀笛卡尔网格上离散化，网格间距 $\\Delta x$ 和 $\\Delta y$ 的单位为 $\\mathrm{m}$，并且在两个空间方向上都施加周期性边界条件。\n\n定义一个全显式有限差分时间步进格式，其时间步长 $\\Delta t$ 的单位为 $\\mathrm{s}$，具体如下：\n- 时间导数采用时间前向差分进行近似。\n- x 和 y方向的对流项分别使用由 $u_x$ 和 $u_y$ 符号决定的一阶迎风差分。具体来说，对于网格索引 $(i,j)$ 处的x-导数，\n$$\n\\partial_x \\rho \\approx\n\\begin{cases}\n\\frac{\\rho_{i,j}^n - \\rho_{i-1,j}^n}{\\Delta x},  \\text{if } u_x \\ge 0 \\\\[1em]\n\\frac{\\rho_{i+1,j}^n - \\rho_{i,j}^n}{\\Delta x},  \\text{if } u_x  0\n\\end{cases}\n$$\ny-导数也使用 $\\Delta y$ 和 $u_y$ 的符号进行类似处理。\n- 扩散项在每个空间方向上使用标准的二阶中心差分，即5点拉普拉斯模板。\n\n假设采用周期性边界条件和空间无限傅里叶分解，因此可以通过要求所有离散傅里叶模态的放大因子模长不超过1来评估稳定性。请用 $u_x$、$u_y$、$\\kappa$、$\\Delta x$ 和 $\\Delta y$ 表示出最大时间步长 $\\Delta t_{\\max}$（单位为 $\\mathrm{s}$），使得该格式在上述意义下对所有傅里叶模态都是稳定的。然后，对于下面测试套件中的每一组参数，计算 $\\Delta t_{\\max}$，并通过检查 $\\Delta t \\le \\Delta t_{\\max}$ 是否成立来判断给定的 $\\Delta t$ 是否稳定。\n\n所有速度 $u_x$ 和 $u_y$ 的单位为 $\\mathrm{m/s}$，扩散系数 $\\kappa$ 的单位为 $\\mathrm{m^2/s}$，网格间距 $\\Delta x$ 和 $\\Delta y$ 的单位为 $\\mathrm{m}$，时间步长 $\\Delta t$ 和 $\\Delta t_{\\max}$ 的单位为 $\\mathrm{s}$。最终的 $\\Delta t_{\\max}$ 值以 $\\mathrm{s}$ 为单位，并四舍五入到6位小数。稳定性指标必须是一个布尔值，约定 $\\text{True}$ 表示稳定，$\\text{False}$ 表示不稳定。\n\n测试套件（每个案例的格式为 $(u_x,u_y,\\kappa,\\Delta x,\\Delta y,\\Delta t)$，单位如上所述）：\n- 案例1：$(+1.0,\\,-0.5,\\,0.01,\\,0.02,\\,0.02,\\,0.004)$\n- 案例2：$(+0.4,\\,+0.6,\\,0.0,\\,1.0,\\,1.0,\\,1.0)$\n- 案例3：$(0.0,\\,0.0,\\,0.2,\\,0.5,\\,0.25,\\,0.125)$\n- 案例4：$(-2.0,\\,0.0,\\,0.0,\\,0.01,\\,0.01,\\,0.006)$\n- 案例5：$(0.0,\\,0.0,\\,0.001,\\,0.005,\\,0.01,\\,0.02)$\n- 案例6：$(+3.0,\\,+1.0,\\,0.05,\\,0.1,\\,0.2,\\,0.05)$\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的每个条目都是一个二元列表 $[\\Delta t_{\\max},\\,\\text{is\\_stable}]$，按给定顺序对应各个案例。例如，输出格式必须类似于\n$[[\\Delta t_{\\max,1},\\text{is\\_stable}_1],[\\Delta t_{\\max,2},\\text{is\\_stable}_2],\\dots]$,\n其中每个 $\\Delta t_{\\max}$ 四舍五入到6位小数，每个 $\\text{is\\_stable}$ 为布尔值。", "solution": "所述问题是有效的。它基于计算流体力学的原理，特别是对流-扩散方程的数值解法，具有科学依据。该有限差分格式定义明确，通过 von Neumann 分析法确定其稳定性是数值分析中的一个标准的、适定的问题。所提供的参数是完整的且物理上一致。我们可以开始求解。\n\n标量场 $\\rho(x,y,t)$ 输运的控制偏微分方程 (PDE) 如下所示：\n$$\n\\partial_t \\rho + u_x \\,\\partial_x \\rho + u_y \\,\\partial_y \\rho \\;=\\; \\kappa \\left(\\partial_{xx} \\rho + \\partial_{yy} \\rho\\right)\n$$\n此处，$u_x$ 和 $u_y$ 是恒定的对流速度，$\\kappa$ 是恒定的扩散系数。计算域是一个均匀的笛卡尔网格，网格间距为 $\\Delta x$ 和 $\\Delta y$。\n\n问题指定了一个全显式有限差分格式。我们通过将每个导数替换为其有限差分近似来离散化该偏微分方程。设 $\\rho_{i,j}^n$ 表示在时间 $n\\Delta t$、网格点 $(i\\Delta x, j\\Delta y)$ 处 $\\rho$ 的值。\n\n1.  **时间导数**：使用时间前向差分（前向欧拉法）：\n    $$ \\partial_t \\rho \\approx \\frac{\\rho_{i,j}^{n+1} - \\rho_{i,j}^n}{\\Delta t} $$\n\n2.  **对流项**：使用一阶迎风差分法。模板点的选择取决于速度分量的符号。这可以使用记号 $u^+ = \\max(u, 0)$ 和 $u^- = \\min(u, 0)$（其中 $u = u^+ + u^-$）来紧凑地表示。空间导数 $\\partial_x \\rho$ 近似为：\n    $$ u_x \\partial_x \\rho \\approx u_x^+ \\frac{\\rho_{i,j}^n - \\rho_{i-1,j}^n}{\\Delta x} + u_x^- \\frac{\\rho_{i+1,j}^n - \\rho_{i,j}^n}{\\Delta x} $$\n    对于 $u_y \\partial_y \\rho$ 存在类似的表达式。注意 $u_x^+ - u_x^- = |u_x|$。\n\n3.  **扩散项**：对拉普拉斯算子 $\\nabla^2 \\rho = \\partial_{xx} \\rho + \\partial_{yy} \\rho$ 使用标准的二阶中心差分：\n    $$ \\kappa \\nabla^2 \\rho \\approx \\kappa \\left( \\frac{\\rho_{i+1,j}^n - 2\\rho_{i,j}^n + \\rho_{i-1,j}^n}{(\\Delta x)^2} + \\frac{\\rho_{i,j+1}^n - 2\\rho_{i,j}^n + \\rho_{i,j-1}^n}{(\\Delta y)^2} \\right) $$\n\n将这些近似代入偏微分方程并求解 $\\rho_{i,j}^{n+1}$，得到完整的更新规则：\n$$ \\frac{\\rho_{i,j}^{n+1} - \\rho_{i,j}^n}{\\Delta t} = - \\left( u_x^+ \\frac{\\rho_{i,j}^n - \\rho_{i-1,j}^n}{\\Delta x} + u_x^- \\frac{\\rho_{i+1,j}^n - \\rho_{i,j}^n}{\\Delta x} \\right) - \\left( u_y^+ \\frac{\\rho_{i,j}^n - \\rho_{i,j-1}^n}{\\Delta y} + u_y^- \\frac{\\rho_{i,j+1}^n - \\rho_{i,j}^n}{\\Delta y} \\right) + \\kappa \\left( \\frac{\\rho_{i+1,j}^n - 2\\rho_{i,j}^n + \\rho_{i-1,j}^n}{(\\Delta x)^2} + \\frac{\\rho_{i,j+1}^n - 2\\rho_{i,j}^n + \\rho_{i,j-1}^n}{(\\Delta y)^2} \\right) $$\n我们可以通过汇总不同模板点上 $\\rho^n$ 值的系数来重排该方程：\n$$\n\\begin{aligned}\n\\rho_{i,j}^{n+1} =  \\left(1 - \\frac{\\Delta t}{\\Delta x}(u_x^+ - u_x^-) - \\frac{\\Delta t}{\\Delta y}(u_y^+ - u_y^-) - 2\\kappa \\frac{\\Delta t}{(\\Delta x)^2} - 2\\kappa \\frac{\\Delta t}{(\\Delta y)^2}\\right) \\rho_{i,j}^n \\\\\n + \\left(\\frac{u_x^+ \\Delta t}{\\Delta x} + \\frac{\\kappa \\Delta t}{(\\Delta x)^2}\\right) \\rho_{i-1,j}^n + \\left(-\\frac{u_x^- \\Delta t}{\\Delta x} + \\frac{\\kappa \\Delta t}{(\\Delta x)^2}\\right) \\rho_{i+1,j}^n \\\\\n + \\left(\\frac{u_y^+ \\Delta t}{\\Delta y} + \\frac{\\kappa \\Delta t}{(\\Delta y)^2}\\right) \\rho_{i,j-1}^n + \\left(-\\frac{u_y^- \\Delta t}{\\Delta y} + \\frac{\\kappa \\Delta t}{(\\Delta y)^2}\\right) \\rho_{i,j+1}^n\n\\end{aligned}\n$$\n使用恒等式 $u_x^+ - u_x^- = |u_x|$ 和 $u_y^+ - u_y^- = |u_y|$，$\\rho_{i,j}^n$ 的系数简化为：\n$$ C_{i,j} = 1 - \\frac{|u_x|\\Delta t}{\\Delta x} - \\frac{|u_y|\\Delta t}{\\Delta y} - 2\\kappa\\Delta t \\left(\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right) $$\n对于 von Neumann 稳定性，我们要求对于任何傅里叶模态，放大因子 $|G|$ 的模长不超过1。一个稳定性的充分条件（对于此格式也是必要条件）是，$\\rho_{i,j}^{n+1}$ 的更新是前一时间步值的凸组合。这要求模板系数满足两个条件：\n1.  所有系数必须非负。\n2.  所有系数之和必须等于1。\n\n让我们验证系数之和。将所有系数相加得到：\n$$ C_{sum} = (C_{i,j}) + \\left(\\frac{u_x^+\\Delta t}{\\Delta x} + \\dots\\right) + \\left(\\frac{-u_x^-\\Delta t}{\\Delta x} + \\dots\\right) + \\dots = 1 $$\n这是因为包含 $\\Delta t$ 的项会相互抵消。例如，与x方向相关的项之和为：\n$$ \\left(1 - \\frac{|u_x|\\Delta t}{\\Delta x}\\right) + \\left(\\frac{u_x^+\\Delta t}{\\Delta x}\\right) + \\left(\\frac{-u_x^-\\Delta t}{\\Delta x}\\right) = 1 - \\frac{(u_x^+ - u_x^-)\\Delta t}{\\Delta x} + \\frac{(u_x^+ - u_x^-)\\Delta t}{\\Delta x} = 1 $$\n和确实为1。现在我们来强制非负性。\n-   $\\rho_{i-1,j}^n$ 的系数：$(\\frac{u_x^+ \\Delta t}{\\Delta x} + \\frac{\\kappa \\Delta t}{(\\Delta x)^2}) \\ge 0$。因为 $u_x^+ \\ge 0$ 和 $\\kappa \\ge 0$，此条件成立。\n-   $\\rho_{i+1,j}^n$ 的系数：$(-\\frac{u_x^- \\Delta t}{\\Delta x} + \\frac{\\kappa \\Delta t}{(\\Delta x)^2}) \\ge 0$。因为 $u_x^- \\le 0$ 和 $\\kappa \\ge 0$，此条件成立。\n-   类似地，$\\rho_{i,j-1}^n$ 和 $\\rho_{i,j+1}^n$ 的系数也是非负的。\n\n唯一剩下的约束来自于要求 $\\rho_{i,j}^n$ 的系数为非负：\n$$ 1 - \\frac{|u_x|\\Delta t}{\\Delta x} - \\frac{|u_y|\\Delta t}{\\Delta y} - 2\\kappa\\Delta t \\left(\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right) \\ge 0 $$\n求解 $\\Delta t$：\n$$ \\Delta t \\left(\\frac{|u_x|}{\\Delta x} + \\frac{|u_y|}{\\Delta y} + 2\\kappa \\left(\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right)\\right) \\le 1 $$\n这给出了时间步长 $\\Delta t$ 的稳定性极限 $\\Delta t_{\\max}$。如果分母为零（即 $u_x=u_y=0$ 且 $\\kappa=0$），则该格式是无条件稳定的，且 $\\Delta t_{\\max}$ 为无穷大。否则：\n$$ \\Delta t_{\\max} = \\frac{1}{\\frac{|u_x|}{\\Delta x} + \\frac{|u_y|}{\\Delta y} + 2\\kappa \\left(\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right)} $$\n当且仅当所选时间步长 $\\Delta t$ 满足 $\\Delta t \\le \\Delta t_{\\max}$ 时，该数值格式是稳定的。\n\n现在我们将此公式应用于每个测试案例。\n-   **案例1**：$\\Delta t_{\\max} = 1 / (|1.0|/0.02 + |-0.5|/0.02 + 2(0.01)(1/0.02^2 + 1/0.02^2)) = 1 / (50 + 25 + 100) = 1/175 \\approx 0.005714$。由于 $\\Delta t=0.004 \\le 0.005714$，格式是稳定的。\n-   **案例2**：$\\Delta t_{\\max} = 1 / (|0.4|/1.0 + |0.6|/1.0 + 0) = 1 / (0.4 + 0.6) = 1.0$。由于 $\\Delta t=1.0 \\le 1.0$，格式是稳定的。\n-   **案例3**：$\\Delta t_{\\max} = 1 / (0 + 0 + 2(0.2)(1/0.5^2 + 1/0.25^2)) = 1 / (0.4(4 + 16)) = 1/8 = 0.125$。由于 $\\Delta t=0.125 \\le 0.125$，格式是稳定的。\n-   **案例4**：$\\Delta t_{\\max} = 1 / (|-2.0|/0.01 + 0 + 0) = 1/200 = 0.005$。由于 $\\Delta t=0.006  0.005$，格式是不稳定的。\n-   **案例5**：$\\Delta t_{\\max} = 1 / (0 + 0 + 2(0.001)(1/0.005^2 + 1/0.01^2)) = 1 / (0.002(40000 + 10000)) = 1/100 = 0.01$。由于 $\\Delta t=0.02  0.01$，格式是不稳定的。\n-   **案例6**：$\\Delta t_{\\max} = 1 / (|3.0|/0.1 + |1.0|/0.2 + 2(0.05)(1/0.1^2 + 1/0.2^2)) = 1 / (30 + 5 + 0.1(100+25)) = 1/(35 + 12.5) = 1/47.5 \\approx 0.021053$。由于 $\\Delta t=0.05  0.021053$，格式是不稳定的。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the stability of a finite difference scheme for the 2D\n    advection-diffusion equation for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (ux, uy, kappa, dx, dy, dt)\n    test_cases = [\n        (1.0, -0.5, 0.01, 0.02, 0.02, 0.004),\n        (0.4, 0.6, 0.0, 1.0, 1.0, 1.0),\n        (0.0, 0.0, 0.2, 0.5, 0.25, 0.125),\n        (-2.0, 0.0, 0.0, 0.01, 0.01, 0.006),\n        (0.0, 0.0, 0.001, 0.005, 0.01, 0.02),\n        (3.0, 1.0, 0.05, 0.1, 0.2, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        ux, uy, kappa, dx, dy, dt = case\n\n        # The stability condition is derived from requiring the coefficients of the\n        # explicit stencil to be non-negative. This yields:\n        # dt_max * ( |ux|/dx + |uy|/dy + 2*kappa*(1/dx^2 + 1/dy^2) ) = 1\n        \n        # Calculate the terms in the denominator of the dt_max expression.\n        advection_term_x = abs(ux) / dx\n        advection_term_y = abs(uy) / dy\n        diffusion_term = 2 * kappa * (1 / dx**2 + 1 / dy**2)\n        \n        denominator = advection_term_x + advection_term_y + diffusion_term\n\n        # If the denominator is zero, the scheme is unconditionally stable.\n        if denominator == 0:\n            dt_max = float('inf')\n        else:\n            dt_max = 1 / denominator\n\n        # Check if the given time step dt is stable.\n        is_stable = dt = dt_max\n        \n        # Format the result for the current case.\n        # dt_max is rounded to 6 decimal places.\n        formatted_result = [round(dt_max, 6), is_stable]\n        results.append(formatted_result)\n\n    # Final print statement in the exact required format.\n    # Using str() on the list of lists produces the required output format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2449689"}]}