{"hands_on_practices": [{"introduction": "许多科学模型，特别是用于长期预测的模型（如气候或人口增长模型），其结果对输入参数的微小变化非常敏感。本练习将引导你探究一个模型参数（例如增长率 $k$）中的微小不确定性是如何在一个指数增长函数中传播并被放大的 [@problem_id:2169903]。通过这个实践，你将学会使用一阶近似（微积分）来量化这种误差放大效应，这是评估模型预测可靠性的一项基本技能。", "problem": "在一个简化的气候模型中，某种特定温室气体的大气浓度 $C$ 预计将随时间 $t$ 遵循指数增长模型增长：\n$$C(t) = C_0 \\exp(kt)$$\n其中 $C_0$ 是 $t=0$ 时的初始浓度，而 $k$ 是每年的净分数增长率。\n\n一个科学家团队已经以非常高的精度确定了初始浓度 $C_0$，因此其相关误差可以忽略不计。然而，增长率 $k$ 是根据复杂的地球物理数据估算得出的，并且存在已知的不确定性。$k$ 的这种不确定性会传播并影响浓度 $C(t)$ 的长期预测。\n\n设物理量 $X$ 的相对误差的一阶近似定义为 $\\epsilon_X = \\left|\\frac{\\Delta X}{X}\\right|$，其中 $\\Delta X$ 是 $X$ 中的小误差。模型预测对增长率不确定性的敏感度由误差放大因子 $A$ 来量化，其定义为预测浓度的相对误差与增长率的相对误差之比：\n$$A = \\frac{\\epsilon_C}{\\epsilon_k}$$\n假设增长率 $k$ 为正，计算在时间 $t = 50$ 年时所做预测的放大因子 $A$ 的值，已知估计的增长率为每年 $k = 0.035$。\n\n将您的最终答案四舍五入到三位有效数字。", "solution": "问题要求计算浓度模型 $C(t) = C_0 \\exp(kt)$ 的误差放大因子 $A = \\frac{\\epsilon_C}{\\epsilon_k}$。相对误差定义为 $\\epsilon_C = \\left|\\frac{\\Delta C}{C}\\right|$ 和 $\\epsilon_k = \\left|\\frac{\\Delta k}{k}\\right|$。我们需要找出增长率中的一个微小变化（误差）$\\Delta k$ 与预测浓度中由此产生的变化 $\\Delta C$ 之间的关系。\n\n我们可以使用微分学来找到这个关系。我们将浓度 $C$ 视为变量 $k$ 的函数，其中 $C_0$ 和 $t$ 是常数参数。对于一个微小的变化 $\\Delta k$，$C$ 的一阶变化由下式给出：\n$$\\Delta C \\approx \\frac{dC}{dk} \\Delta k$$\n首先，我们需要计算 $C(k) = C_0 \\exp(kt)$ 相对于 $k$ 的导数。使用链式法则进行微分：\n$$\\frac{dC}{dk} = \\frac{d}{dk} \\left( C_0 \\exp(kt) \\right) = C_0 \\cdot \\frac{d}{dk}(\\exp(kt))$$\n$$\\frac{dC}{dk} = C_0 \\cdot \\exp(kt) \\cdot \\frac{d}{dk}(kt) = C_0 \\exp(kt) \\cdot t$$\n请注意，项 $C_0 \\exp(kt)$ 正是原始函数 $C(t)$。所以，我们可以将导数写为：\n$$\\frac{dC}{dk} = C(t) \\cdot t$$\n现在我们将这个导数代回到 $\\Delta C$ 的表达式中：\n$$\\Delta C \\approx (C(t) \\cdot t) \\cdot \\Delta k$$\n为了求出 $C$ 的相对误差 $\\epsilon_C$，我们将两边都除以 $C = C(t)$：\n$$\\frac{\\Delta C}{C(t)} \\approx \\frac{C(t) \\cdot t \\cdot \\Delta k}{C(t)}$$\n$$\\frac{\\Delta C}{C(t)} \\approx t \\cdot \\Delta k$$\n我们关心的是相对误差之间的关系。$k$ 的相对误差是 $\\epsilon_k = \\left|\\frac{\\Delta k}{k}\\right|$。我们可以将 $\\Delta k$ 的表达式改写为 $\\Delta k = k \\cdot \\left(\\frac{\\Delta k}{k}\\right)$。将此代入我们的方程中：\n$$\\frac{\\Delta C}{C(t)} \\approx t \\cdot \\left(k \\cdot \\frac{\\Delta k}{k}\\right)$$\n$$\\frac{\\Delta C}{C(t)} \\approx (kt) \\cdot \\frac{\\Delta k}{k}$$\n现在我们对两边取绝对值，以获得相对误差大小之间的关系：\n$$\\left|\\frac{\\Delta C}{C(t)}\\right| \\approx \\left| (kt) \\cdot \\frac{\\Delta k}{k} \\right|$$\n因为给定的 $k$ 和 $t$ 都是正值，它们的乘积 $kt$ 也是正的，所以 $|kt| = kt$。\n$$\\left|\\frac{\\Delta C}{C(t)}\\right| \\approx kt \\cdot \\left|\\frac{\\Delta k}{k}\\right|$$\n使用相对误差的定义，$\\epsilon_C = \\left|\\frac{\\Delta C}{C}\\right|$ 和 $\\epsilon_k = \\left|\\frac{\\Delta k}{k}\\right|$，我们有：\n$$\\epsilon_C \\approx (kt) \\cdot \\epsilon_k$$\n误差放大因子 $A$ 定义为比率 $\\frac{\\epsilon_C}{\\epsilon_k}$。从上面的方程我们得到：\n$$A = \\frac{\\epsilon_C}{\\epsilon_k} \\approx kt$$\n这是该模型放大因子的一般表达式。现在我们可以代入给定的数值：$t = 50$ 年 和 $k = 0.035$ 年$^{-1}$。\n$$A \\approx (0.035 \\text{ year}^{-1}) \\cdot (50 \\text{ years})$$\n$$A \\approx 1.75$$\n问题要求将答案四舍五入到三位有效数字。计算出的值 $1.75$ 已经有三位有效数字。", "answer": "$$\\boxed{1.75}$$", "id": "2169903"}, {"introduction": "在数值计算中，一个常见的误区是认为只要无限缩小步长 $h$ 就能获得更高的精度。本练习将揭示一个更微妙的现实：总误差往往是两种误差来源之间权衡的结果 [@problem_id:2169892]。你将深入研究数值微分中的两个主要误差来源：截断误差（随步长 $h$ 减小而减小）和由计算机精度限制引起的舍入误差（随步长 $h$ 减小而增大），并学习如何通过平衡这两个相互竞争的因素，找到最小化总误差的最佳步长。", "problem": "一位工程师正在分析一个信号，该信号由一个至少三阶连续可微 ($C^3$) 的函数 $f(t)$ 表示。为估计信号在特定时间 $t_0$ 的瞬时变化率 $f'(t)$，该工程师使用对称差商：\n$$\nf'(t_0) \\approx \\frac{f(t_0+h) - f(t_0-h)}{2h}\n$$\n其中 $h > 0$ 是步长。\n\n此估计中的总误差来自两个不同的来源：\n1.  **逼近误差 (Approximation Error)**：这种误差是公式本身固有的，因为该公式是真实导数的一个近似。对于一个足够光滑的函数，该误差的量级以 $|E_A| \\le \\frac{M h^2}{6}$ 为界，其中 $M$ 是一个正常数，代表函数三阶导数的绝对值 $|f'''(t)|$ 在 $t_0$ 附近的最大值。\n2.  **计算精度误差 (Computational Precision Error)**：用于测量或计算函数值 $f(t)$ 的设备精度有限。$f(t)$ 的计算值（记为 $\\text{fl}(f(t))$）会受舍入误差的影响。任何单次函数求值的绝对误差以一个最大值 $\\varepsilon > 0$ 为界，即 $|\\text{fl}(f(t)) - f(t)| \\le \\varepsilon$。当使用这些不精确的值计算差商时，这种误差会传播。\n\n工程师希望选择一个能最小化总误差的步长 $h$。假设在最坏情况下各个误差相加，请确定使总误差界最小化的最优步长 $h_{opt}$。请将您的答案表示为关于 $M$ 和 $\\varepsilon$ 的符号表达式。", "solution": "我们将中心差分近似记为\n$$\nD(h) = \\frac{f(t_{0}+h)-f(t_{0}-h)}{2h}.\n$$\n根据带余项的泰勒定理，对于 $t_0-h$ 和 $t_0+h$ 之间的某些点，我们有\n$$\nf(t_{0}\\pm h) = f(t_{0}) \\pm h f'(t_{0}) + \\frac{h^{2}}{2} f''(t_{0}) \\pm \\frac{h^{3}}{6} f^{(3)}(\\xi_{\\pm}),\n$$\n这就得到了中心差分截断误差\n$$\nE_{A} = D(h) - f'(t_{0}) = \\frac{h^{2}}{6} f^{(3)}(\\xi),\n$$\n其中 $\\xi$ 在 $t_{0}-h$ 和 $t_{0}+h$ 之间。因此，利用在 $t_{0}$ 附近 $|f^{(3)}(t)| \\le M$ 的条件，逼近误差满足\n$$\n|E_{A}| \\le \\frac{M h^{2}}{6}.\n$$\n\n对于计算精度误差，设计算出的函数值为\n$$\n\\text{fl}(f(t_{0}\\pm h)) = f(t_{0}\\pm h) + \\delta_{\\pm}, \\quad |\\delta_{\\pm}| \\le \\varepsilon.\n$$\n那么，计算出的差商为\n$$\n\\frac{\\text{fl}(f(t_{0}+h)) - \\text{fl}(f(t_{0}-h))}{2h}\n= D(h) + \\frac{\\delta_{+} - \\delta_{-}}{2h},\n$$\n因此，其贡献的舍入误差满足\n$$\n|E_{R}| = \\left|\\frac{\\delta_{+} - \\delta_{-}}{2h}\\right|\n\\le \\frac{|\\delta_{+}| + |\\delta_{-}|}{2h}\n\\le \\frac{2 \\varepsilon}{2 h}\n= \\frac{\\varepsilon}{h}.\n$$\n\n假设在最坏情况下的误差加性累积，总误差界作为 $h>0$ 的函数为\n$$\nE(h) = \\frac{M h^{2}}{6} + \\frac{\\varepsilon}{h}.\n$$\n为了最小化 $E(h)$，我们求导并令其为零：\n$$\nE'(h) = \\frac{M}{3} h - \\varepsilon h^{-2} = 0\n\\quad \\Longrightarrow \\quad\n\\frac{M}{3} h^{3} = \\varepsilon\n\\quad \\Longrightarrow \\quad\nh = \\left(\\frac{3 \\varepsilon}{M}\\right)^{\\frac{1}{3}}.\n$$\n由于\n$$\nE''(h) = \\frac{M}{3} + 2 \\varepsilon h^{-3} > 0,\n$$\n所以该临界点是唯一的极小值点。因此，最优步长为\n$$\nh_{\\text{opt}} = \\left(\\frac{3 \\varepsilon}{M}\\right)^{\\frac{1}{3}}.\n$$", "answer": "$$\\boxed{\\left(\\frac{3 \\varepsilon}{M}\\right)^{\\frac{1}{3}}}$$", "id": "2169892"}, {"introduction": "在计算机上，即使是代数上完全等价的表达式 $f(x)$，其计算结果也可能因浮点数的有限精度而大相径庭。这个练习聚焦于一种被称为“灾难性抵消”的现象，即两个几乎相等的数相减时会导致有效数字的严重损失 [@problem_id:2375840]。你将学习一个关键的代数技巧——乘以其共轭表达式——来将一个数值上不稳定的表达式重构为稳定的形式，这凸显了算法选择对于在实践中获得准确计算结果的重要性。", "problem": "设 $f(x) = \\sqrt{x^{2}+1} - x$，其中实数 $x > 0$。在一个单位舍入为 $u$ 的标准浮点运算模型中，当 $x$ 非常大时，直接计算 $f(x)$ 会遭遇灾难性抵消。请从第一性原理出发，推导一个代数等价且数值稳定的 $f(x)$ 闭式表达式，该表达式能避免在 $x$ 非常大时两个相近数的减法运算。将你的最终答案表示为仅含 $x$ 的单个解析表达式。无需进行舍入。", "solution": "对于大的 $x > 0$，表达式 $f(x) = \\sqrt{x^{2}+1} - x$ 中数值不稳定性的来源是两个数量级相近的数相减。在浮点运算中，如果两个数 $a$和 $b$ 非常接近，它们的差 $a-b$ 的正确有效数字位数将显著少于 $a$ 或 $b$ 各自的有效数字位数。这种相对精度的损失被称为灾难性抵消。\n\n为了推导出一个数值稳定的表达式，我们必须消除这种减法运算。对于包含平方根的差值表达式，形如 $\\sqrt{A} - B$，一个标准的代数技巧是同乘以并除以其共轭表达式 $\\sqrt{A} + B$。这个技巧通常被称为“分子有理化”。\n\n给定函数为 $f(x) = \\sqrt{x^{2}+1} - x$。其共轭表达式是 $\\sqrt{x^{2}+1} + x$。我们将 $f(x)$ 同乘以并除以这个共轭表达式：\n\n$$ f(x) = (\\sqrt{x^{2}+1} - x) \\cdot \\frac{\\sqrt{x^{2}+1} + x}{\\sqrt{x^{2}+1} + x} $$\n\n分子现在的形式是 $(a-b)(a+b)$，可以简化为 $a^{2}-b^{2}$。这里，$a = \\sqrt{x^{2}+1}$ 且 $b = x$。\n\n$$ f(x) = \\frac{(\\sqrt{x^{2}+1})^{2} - x^{2}}{\\sqrt{x^{2}+1} + x} $$\n\n简化分子：\n\n$$ (\\sqrt{x^{2}+1})^{2} - x^{2} = (x^{2}+1) - x^{2} = 1 $$\n\n将此结果代回 $f(x)$ 的表达式中：\n\n$$ f(x) = \\frac{1}{\\sqrt{x^{2}+1} + x} $$\n\n对于定义域中的所有 $x$，这个新表达式与原表达式代数等价。现在我们必须验证其数值稳定性。分母由两个正数 $\\sqrt{x^{2}+1}$ 和 $x$ 相加组成。在浮点运算中，两个同号数相加是一种良性运算，不会导致灾难性抵消。随后除以这个和也是一个数值稳定的运算。\n\n对于大的 $x$，分母会变得很大，结果会正确地趋近于零，而不会有任何相对精度的损失。因此，这个转换后的表达式对于所有 $x > 0$ 都是数值稳定的，特别是对于原表达式失效的大 $x$ 值。", "answer": "$$ \\boxed{\\frac{1}{\\sqrt{x^{2}+1} + x}} $$", "id": "2375840"}]}