{"hands_on_practices": [{"introduction": "二次方程求根公式是代数中的一个基石，但在数值计算中，这个看似完美的公式可能会因为有限的计算精度而出乎意料地失效。当系数满足特定条件时，直接使用求根公式计算其中一个根会导致“灾难性抵消”，产生巨大的舍入误差 [@problem_id:2205401]。本练习将引导你发现这一缺陷，并运用韦达定理等技巧来获得一个数值上更稳健的解。", "problem": "在一个阻尼系统中，某个物理量的时间演化是通过求解二次方程 $at^2 + bt + c = 0$ 的根来确定的。对于一个具有非常强阻尼特性的特定实验装置，其系数确定为 $a = 1.00$，$b = 1.00 \\times 10^7$ 和 $c = 1.00$。该系统的长期行为由绝对值较小的根决定。\n\n确定方程 $t^2 + (1.00 \\times 10^7) t + 1.00 = 0$ 的幅值较小的根的值。\n\n以实数形式给出你的答案，并保留三位有效数字。", "solution": "问题要求解二次方程 $at^2 + bt + c = 0$ 的幅值较小的根，其中 $a=1.00$，$b=1.00 \\times 10^7$，$c=1.00$。\n\n该方程根的标准二次公式为：\n$$t = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$\n\n代入给定值，我们得到：\n$$t = \\frac{-1.00 \\times 10^7 \\pm \\sqrt{(1.00 \\times 10^7)^2 - 4(1.00)(1.00)}}{2(1.00)}$$\n$$t = \\frac{-10^7 \\pm \\sqrt{10^{14} - 4}}{2}$$\n\n这给出了两个根：\n$$t_1 = \\frac{-10^7 + \\sqrt{10^{14} - 4}}{2}$$\n$$t_2 = \\frac{-10^7 - \\sqrt{10^{14} - 4}}{2}$$\n\n我们需要确定幅值较小的根。\n对于 $t_2$，分子是两个大的负数之和。因此，$|t_2| \\approx \\frac{10^7 + 10^7}{2} = 10^7$。\n对于 $t_1$，项 $\\sqrt{10^{14} - 4}$ 极其接近 $\\sqrt{10^{14}} = 10^7$。因此，分子涉及两个几乎相等的数的减法：$-10^7$ 和一个略小于 $10^7$ 的数。这意味着 $t_1$ 的幅值将非常小。因此，$t_1$ 就是我们所寻找的根。\n\n然而，在有限精度运算中，直接使用该公式计算 $t_1$ 会产生问题。两个几乎相等的数相减，会导致有效数字的损失，这种效应被称为灾难性抵消。例如，如果一个计算器保留8位有效数字，$\\sqrt{10^{14}-4}$ 会被计算为 $10^7$，分子将变为 $-10^7 + 10^7 = 0$，从而导致根的错误值为 $0$。\n\n为了找到 $t_1$ 的精确值，我们必须使用一种数值稳定的方法。我们可以利用 Vieta 公式，它将多项式的系数与其根联系起来。对于一个二次方程，其根的乘积由 $t_1 t_2 = \\frac{c}{a}$ 给出。\n\n我们可以首先计算 $t_2$，因为它的公式涉及两个同号大数的相加，这在数值上是稳定的。\n$$t_2 = \\frac{-10^7 - \\sqrt{10^{14} - 4}}{2}$$\n由于 $10^{14} \\gg 4$，$\\sqrt{10^{14}-4}$ 非常接近 $10^7$。因此，$t_2 \\approx \\frac{-10^7 - 10^7}{2} = -10^7$。\n\n现在，我们可以使用关系式 $t_1 = \\frac{c/a}{t_2}$ 来求 $t_1$：\n$$t_1 = \\frac{1.00/1.00}{t_2} = \\frac{1}{t_2} = \\frac{1}{\\frac{-10^7 - \\sqrt{10^{14} - 4}}{2}} = \\frac{2}{-10^7 - \\sqrt{10^{14} - 4}}$$\n这个 $t_1$ 的表达式是数值稳定的，因为分母涉及两个大的负数相加。\n\n为了计算这个表达式，我们可以再次注意到分母约等于 $-10^7 - 10^7 = -2 \\times 10^7$。\n$$t_1 \\approx \\frac{2}{-2 \\times 10^7} = -1 \\times 10^{-7}$$\n\n为了确认这一点并获得所需的精度，我们可以使用二项式近似。设 $\\delta = \\frac{4ac}{b^2} = \\frac{4}{10^{14}} = 4 \\times 10^{-14}$。\n项 $\\sqrt{b^2 - 4ac}$ 可以写成 $|b|\\sqrt{1 - \\frac{4ac}{b^2}} = b\\sqrt{1-\\delta}$（因为 $b>0$）。\n对小的 $x$ 使用泰勒展开式 $(1-x)^{1/2} \\approx 1 - \\frac{1}{2}x$：\n$$ \\sqrt{b^2 - 4ac} \\approx b \\left(1 - \\frac{1}{2}\\frac{4ac}{b^2}\\right) = b - \\frac{2ac}{b} $$\n将此代入不稳定的 $t_1$ 公式中：\n$$ t_1 = \\frac{-b + \\sqrt{b^2-4ac}}{2a} \\approx \\frac{-b + (b - \\frac{2ac}{b})}{2a} = \\frac{-2ac/b}{2a} = -\\frac{c}{b} $$\n这为较小的根提供了一个非常精确的近似值：\n$$ t_1 \\approx -\\frac{c}{b} = -\\frac{1.00}{1.00 \\times 10^7} = -1.00 \\times 10^{-7} $$\n这个结果与使用稳定公式计算的结果一致。\n\n将结果四舍五入到三位有效数字，我们得到 $-1.00 \\times 10^{-7}$。", "answer": "$$\\boxed{-1.00 \\times 10^{-7}}$$", "id": "2205401"}, {"introduction": "在数据分析中，计算方差是评估数据离散程度的基础步骤。虽然单遍方差公式 $\\sigma^2 = \\langle V^2 \\rangle - \\langle V \\rangle^2$ 在计算上很高效，但当数据均值远大于其标准差时，它在数值上是极其不稳定的 [@problem_id:2205459]。通过模拟一个有限精度计算器的运算过程，本练习将具体展示“灾难性抵消”是如何在两个几乎相等的数相减时吞噬有效数字的，从而导致最终结果毫无意义。", "problem": "一位高精度计量实验室的分析员正负责评估一个电压基准源的稳定性。他们采集了以下三个电压测量值：\n$V_1 = 99.999999 \\text{ V}$\n$V_2 = 100.00000 \\text{ V}$\n$V_3 = 100.00001 \\text{ V}$\n\n分析在一台假设的计算器上进行，该计算器使用一种简化的十进制浮点运算法则。此系统用8位有效数字的尾数和适当的指数来表示每个数。每次算术运算（加、减、乘、除）后，结果会立即修约到8位有效数字，然后才用于任何后续计算。修约规则为“四舍六入五成双”（例如，2.5 修约为 2，3.5 修约为 4，而 2.51 修约为 3）。\n\n分析员使用通用的样本方差“单遍”公式，对于样本容量为 $N=3$ 的情况，该公式如下：\n$$ \\sigma^2 = \\left( \\frac{V_1^2 + V_2^2 + V_3^2}{3} \\right) - \\left( \\frac{V_1 + V_2 + V_3}{3} \\right)^2 $$\n这个公式通常写作 $\\sigma^2 = \\langle V^2 \\rangle - \\langle V \\rangle^2$。你的任务是模拟该计算器的运算过程来计算样本方差。\n\n请计算使用该特定计算器和公式所得到的样本方差 $\\sigma^2$ 的值。答案以 $\\text{V}^2$ 为单位，并修约至四位有效数字。", "solution": "我们模拟计算器的算术过程，该计算器使用具有8位尾数的十进制浮点运算，并遵循“四舍六入五成双”的修约规则，在每次算术运算后都进行修约。\n\n给定输入：\n$$V_{1}=99.999999,\\quad V_{2}=100.00000,\\quad V_{3}=100.00001.$$\n\n首先，计算各项的平方，每次乘法后进行修约：\n- $V_{1}^{2}=(99.999999)^{2}=9999.999800000001 \\to 9999.9998$（修约至8位有效数字）。\n- $V_{2}^{2}=(100.00000)^{2}=10000 \\to 10000$（可以用8位有效数字精确表示为 $1.0000000\\times 10^{4}$）。\n- $V_{3}^{2}=(100.00001)^{2}=10000.0020000001 \\to 10000.002$（修约至8位有效数字）。\n\n计算平方和 $V_{1}^{2}+V_{2}^{2}+V_{3}^{2}$，每次加法后进行修约：\n- $9999.9998+10000=19999.9998 \\to 19999.9998$（已经是8位有效数字）。\n- $19999.9998+10000.002=30000.0018 \\to 30000.002$（$3.00000018\\times 10^{4}$ 修约为 $3.0000002\\times 10^{4}$）。\n\n计算平方的均值 $\\langle V^2 \\rangle$，除法后进行修约：\n$$\\langle V^2 \\rangle = \\frac{V_{1}^{2}+V_{2}^{2}+V_{3}^{2}}{3}=\\frac{30000.002}{3}=10000.000666\\ldots \\to 10000.001$$\n\n接下来，计算均值 $\\langle V \\rangle$，每次加法后进行修约：\n- $V_{1}+V_{2}=99.999999+100.00000=199.999999$。该结果修约到8位有效数字后为 $200.00000$。\n- $(V_{1}+V_{2})+V_{3}=200.00000+100.00001=300.00001$。该结果已是8位有效数字。\n因此，三项之和为 $300.00001$。\n\n然后，计算均值，除法后进行修约：\n$$\\langle V \\rangle = \\frac{300.00001}{3}=100.000003333\\ldots \\to 100.00000$$\n\n将修约后的均值进行平方运算，乘法后进行修约：\n$$\\langle V \\rangle^{2}=(100.00000)^{2}=10000 \\to 10000$$\n\n最后，使用单遍公式计算方差，减法后进行修约：\n$$\\sigma^{2}=\\langle V^2 \\rangle - \\langle V \\rangle^{2}=10000.001-10000=0.001 \\to 0.0010000000$$\n\n将结果报告为四位有效数字：\n$$\\sigma^{2}=1.000\\times 10^{-3}$$", "answer": "$$\\boxed{1.000 \\times 10^{-3}}$$", "id": "2205459"}, {"introduction": "数值算法的稳定性不仅体现在代数表达式的求值中，在求解常微分方程 (ODE) 的迭代过程中也至关重要。显式欧拉法因其简单而广受欢迎，但它的稳定性受步长选择的严格限制 [@problem_id:2205446]。本练习将探讨当步长 $h$ 略微超出稳定区域时会发生什么，你将亲眼见证数值解如何产生剧烈振荡并与物理现实完全背离，从而深刻理解算法稳定性的重要性。", "problem": "一位科学家正在为一个简单的一级反应中的化学反应物浓度 $C(t)$ 建模。该反应物浓度的变化率与浓度本身成正比，遵循以下微分方程：\n$$\n\\frac{dC}{dt} = -k C(t)\n$$\n速率常数给定为 $k = 50.0 \\text{ s}^{-1}$，在时间 $t=0$ 时的初始浓度为 $C(0) = 100.0 \\text{ mol/L}$。\n\n为了预测未来时间的浓度，该科学家采用了一个使用固定时间步长 $h$ 的数值方案。该方法根据显式欧拉更新法则，使用前一个时间步长 $t_n = nh$ 时的值来近似时间 $t_{n+1} = (n+1)h$ 时的浓度：\n$$\nC_{n+1} = C_n + h \\left( \\frac{dC}{dt} \\right)_{t=t_n}\n$$\n科学家决定使用 $h = 0.0410 \\text{ s}$ 的时间步长。计算该方法在三个时间步长后预测的浓度数值 $C_3$。用 mol/L 作为单位，将您的答案四舍五入到三位有效数字。", "solution": "我们已知一阶线性常微分方程 $\\frac{dC}{dt}=-kC(t)$ 和显式欧拉更新式\n$$\nC_{n+1}=C_{n}+h\\left(\\frac{dC}{dt}\\right)_{t=t_{n}}=C_{n}+h(-kC_{n})=(1-kh)C_{n}.\n$$\n通过递归，这得到\n$$\nC_{n}=C_{0}(1-kh)^{n}.\n$$\n当 $C_{0}=100.0$，$k=50.0\\,\\text{s}^{-1}$ 且 $h=0.0410\\,\\text{s}$ 时，无量纲乘积为\n$$\nkh=(50.0)(0.0410)=2.05,\\quad 1-kh=1-2.05=-1.05.\n$$\n因此在三个步长后，\n$$\nC_{3}=100.0\\,(-1.05)^{3}.\n$$\n计算乘方：\n$$\n(-1.05)^{2}=1.1025,\\quad (-1.05)^{3}=1.1025\\times(-1.05)=-1.157625,\n$$\n所以\n$$\nC_{3}=100.0\\times(-1.157625)=-115.7625.\n$$\n四舍五入到三位有效数字得到 $-1.16\\times 10^{2}$，即 $-116$。请注意，显式欧拉因子满足 $|1-kh|=1.05>1$，表明对于这个步长是不稳定的，这解释了非物理的符号变化。", "answer": "$$\\boxed{-116}$$", "id": "2205446"}]}