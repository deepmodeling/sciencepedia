{"hands_on_practices": [{"introduction": "在科学和工程领域，测量永远无法做到完美精确。这个练习将探讨一个关键问题：输入数据中的微小数据误差如何通过数学模型传播并影响最终计算结果的准确性。通过分析一个药物胶囊的案例 [@problem_id:2187593]，你将学习如何运用多变量微积分来量化误差传播，从其基本尺寸的测量不确定性推导出其体积的总误差，这对于保证产品质量至关重要。", "problem": "一家制药公司正在设计一种新型的药物输送胶囊。该胶囊被建模为一个长度为 $L$ 的理想圆柱体，其两端由两个半径为 $r$ 的半球封盖。胶囊的总体积决定了剂量，因此其精度至关重要。\n\n制造过程涉及两种独立的测量设备。半径 $r$ 由一个设备测量，其已知的最大绝对误差为 $\\delta_r$。圆柱部分的长度 $L$ 由另一个设备测量，其已知的最大绝对误差为 $\\delta_L$。\n\n假设半径和长度的测量误差很小且相互独立，请推导一个关于胶囊计算体积中最大可能绝对误差 $\\delta_V$ 的符号表达式。您的表达式应以标称尺寸 $r$ 和 $L$ 以及测量误差 $\\delta_r$ 和 $\\delta_L$ 来表示。", "solution": "该问题要求计算胶囊体积的最大可能绝对误差，已知其构成尺寸——半径 $r$ 和长度 $L$ 的测量误差。这是一个误差传递问题。对于一个多变量函数 $V(r, L)$，其全微分提供了因变量微小变化而引起的函数变化的线性近似。最大绝对误差 $\\delta_V$ 可以通过将各个测量误差的贡献相加来近似计算：\n\n$$ \\delta_V \\approx \\left| \\frac{\\partial V}{\\partial r} \\right| \\delta_r + \\left| \\frac{\\partial V}{\\partial L} \\right| \\delta_L $$\n\n在这里，$\\delta_r$ 和 $\\delta_L$ 是给定的 $r$ 和 $L$ 测量的最大绝对误差。\n\n首先，我们必须建立胶囊总体积 $V$ 的公式。胶囊由一个中心圆柱体和两个半球形帽盖组成。\n圆柱部分的体积是 $V_{\\text{cylinder}} = \\pi r^2 L$。\n两个半球形帽盖合在一起形成一个半径为 $r$ 的完整球体。这个球体的体积是 $V_{\\text{sphere}} = \\frac{4}{3} \\pi r^3$。\n总体积 $V$ 是这两个体积之和：\n\n$$ V(r, L) = V_{\\text{cylinder}} + V_{\\text{sphere}} = \\pi r^2 L + \\frac{4}{3} \\pi r^3 $$\n\n接下来，我们计算体积 $V$ 关于半径 $r$ 和长度 $L$ 的偏导数。\n\n关于 $r$ 的偏导数是：\n$$ \\frac{\\partial V}{\\partial r} = \\frac{\\partial}{\\partial r} \\left( \\pi r^2 L + \\frac{4}{3} \\pi r^3 \\right) = 2 \\pi r L + \\frac{4}{3} \\pi (3r^2) = 2\\pi r L + 4\\pi r^2 $$\n\n关于 $L$ 的偏导数是：\n$$ \\frac{\\partial V}{\\partial L} = \\frac{\\partial}{\\partial L} \\left( \\pi r^2 L + \\frac{4}{3} \\pi r^3 \\right) = \\pi r^2 $$\n\n由于 $r$ 和 $L$ 代表物理尺寸，它们必须是正数（$r > 0$, $L > 0$）。因此，两个偏导数 $\\frac{\\partial V}{\\partial r} = 2\\pi r L + 4\\pi r^2$ 和 $\\frac{\\partial V}{\\partial L} = \\pi r^2$ 总是正的。因此，我们可以在误差传递公式中去掉偏导数周围的绝对值符号。\n\n将偏导数代入 $\\delta_V$ 的公式中：\n$$ \\delta_V = \\left( 2\\pi r L + 4\\pi r^2 \\right) \\delta_r + \\left( \\pi r^2 \\right) \\delta_L $$\n\n为了以更紧凑的形式呈现最终答案，我们可以提取公因式。我们可以从整个表达式中提取公因式 $\\pi r$。\n从第一项中提取 $\\pi r$ 得到：$\\pi r (2L + 4r)$。\n从第二项中提取 $\\pi r$ 得到：$\\pi r (r)$。\n\n将它们合并，我们得到：\n$$ \\delta_V = \\pi r (2L + 4r) \\delta_r + \\pi r^2 \\delta_L $$\n从整个表达式中提取 $\\pi r$ 得到：\n$$ \\delta_V = \\pi r \\left( (2L + 4r) \\delta_r + r \\delta_L \\right) $$\n\n这就是胶囊体积最大可能绝对误差的最终表达式。", "answer": "$$\\boxed{\\pi r \\left( (2L + 4r) \\delta_r + r \\delta_L \\right)}$$", "id": "2187593"}, {"introduction": "在理想的数学世界里完全等价的两个公式，在有限精度的计算机上可能产生截然不同的结果。本练习 [@problem_id:2187574] 通过计算统计学中常见的方差（$\\sigma^2$）来揭示这一现象。你将模拟一个有限精度计算环境，亲手体验数值计算中的一个主要陷阱——“灾难性抵消”（catastrophic cancellation），并理解为何选择正确的计算公式对于获得可靠结果至关重要。", "problem": "一位初级数据分析师的任务是计算从一台高精度仪器中获得的一个小数据集的总体方差 ($\\sigma^2$)。仪器读数如下：\n$x_1 = 100000001$\n$x_2 = 100000003$\n$x_3 = 100000000$\n$x_4 = 100000002$\n\n该分析师决定比较计算数据集 $\\{x_1, \\dots, x_N\\}$（其均值为 $\\mu = \\frac{1}{N}\\sum_{i=1}^{N} x_i$）的总体方差的两个数学等价公式：\n- 公式 A: $\\sigma_A^2 = \\frac{1}{N}\\sum_{i=1}^{N} (x_i - \\mu)^2$\n- 公式 B: $\\sigma_B^2 = \\left(\\frac{1}{N}\\sum_{i=1}^{N} x_i^2\\right) - \\mu^2$\n\n该分析师使用一个简化的计算模型进行计算，在该模型中，任何算术运算的结果都将立即四舍五入到9位有效十进制数字。例如，精确乘积 $(100000001) \\times (100000001) = 10000000200000001$ 在用于任何后续计算之前，将被四舍五入为 $10000000200000000$。\n\n你的任务是确定在此系统下，这两个公式之间的计算差异。使用公式 A ($\\sigma_A^2$) 和公式 B ($\\sigma_B^2$) 计算方差，并在每一步都遵循指定的四舍五入程序。然后，计算差值 $\\sigma_B^2 - \\sigma_A^2$。\n\n将你的最终答案表示为一个单一的数值，并四舍五入到四位有效数字。", "solution": "我们有 $N=4$ 以及读数 $x_{1}=100000001$, $x_{2}=100000003$, $x_{3}=100000000$, $x_{4}=100000002$。所有算术结果都立即四舍五入到9位有效数字。\n\n计算均值 $\\mu$（两个公式都用到），每一步都进行四舍五入：\n- 依次求和，每次加法后都进行四舍五入：\n$$100000001+100000003=200000004,$$\n$$200000004+100000000=300000004,$$\n$$300000004+100000002=400000006.$$\n所有这些和本身最多只有9位有效数字，因此保持不变。\n- 除以 $4$ 并四舍五入到9位有效数字：\n$$\\mu=\\frac{400000006}{4}=100000001.5 \\to 100000002 \\text{ (9 significant digits)}.$$\n\n公式 A：$\\sigma_{A}^{2}=\\frac{1}{N}\\sum_{i=1}^{N}(x_{i}-\\mu)^{2}$，每一步都进行四舍五入。\n- 偏差（每个都四舍五入到9位有效数字）：\n$$x_{1}-\\mu=100000001-100000002=-1,$$\n$$x_{2}-\\mu=100000003-100000002=1,$$\n$$x_{3}-\\mu=100000000-100000002=-2,$$\n$$x_{4}-\\mu=100000002-100000002=0.$$\n- 平方（每个都四舍五入到9位有效数字）：\n$$(-1)^{2}=1,\\quad 1^{2}=1,\\quad (-2)^{2}=4,\\quad 0^{2}=0.$$\n- 求和与平均（每次加法和除法后都进行四舍五入）：\n$$1+1=2,\\quad 2+4=6,\\quad 6+0=6,$$\n$$\\sigma_{A}^{2}=\\frac{6}{4}=1.5.$$\n\n公式 B：$\\sigma_{B}^{2}=\\left(\\frac{1}{N}\\sum_{i=1}^{N}x_{i}^{2}\\right)-\\mu^{2}$，每一步都进行四舍五入。\n- 将每个 $x_i$ 平方，并立即四舍五入到9位有效数字：\n$$x_{1}^{2}=100000001^{2}=10000000200000001 \\to 10000000200000000,$$\n$$x_{2}^{2}=100000003^{2}=10000000600000009 \\to 10000000600000000,$$\n$$x_{3}^{2}=100000000^{2}=10000000000000000 \\to 10000000000000000,$$\n$$x_{4}^{2}=100000002^{2}=10000000400000004 \\to 10000000400000000.$$\n- 求和，每次加法后都进行四舍五入：\n$$10000000200000000+10000000600000000=20000000800000000,$$\n$$20000000800000000+10000000000000000=30000000800000000,$$\n$$30000000800000000+10000000400000000=40000001200000000.$$\n- 除以 $4$ 并四舍五入：\n$$\\frac{1}{4}\\sum x_{i}^{2}=\\frac{40000001200000000}{4}=10000000300000000.$$\n- 使用四舍五入后的 $\\mu=100000002$ 计算 $\\mu^{2}$ 并四舍五入：\n$$\\mu^{2}=100000002^{2}=10000000400000004 \\to 10000000400000000.$$\n- 相减并四舍五入：\n$$\\sigma_{B}^{2}=10000000300000000-10000000400000000=-100000000.$$\n\n计算差异：\n$$\\sigma_{B}^{2}-\\sigma_{A}^{2}=-100000000-1.5=-100000001.5.$$\n\n将最终差异四舍五入到四位有效数字：\n$$-100000001.5 \\approx -1.000 \\times 10^{8}.$$", "answer": "$$\\boxed{-1.000 \\times 10^{8}}$$", "id": "2187574"}, {"introduction": "即使是最高效的数值算法也存在其局限性，理解这些局限是数值分析的核心。牛顿法以其快速收敛而闻名，但在特定条件下其性能会急剧下降。本练习 [@problem_id:2187568] 让你深入探究迭代算法的收敛特性，通过在一个具有高重数根的函数 $f(x) = (x-1)^{10}$ 上应用牛顿法，你将发现问题的内在结构如何影响算法的效率，并导致数值计算上的困难。", "problem": "牛顿法是一种流行的迭代算法，用于寻找可微函数的根。其迭代公式定义为 $x_{n+1} = x_n - \\frac{f(x_n)}{f'(x_n)}$，其中 $x_n$ 是第 $n$ 次迭代时根的估计值，$f'(x)$ 是函数 $f(x)$ 的一阶导数。\n\n虽然通常非常高效，但当应用于具有高重数根的函数时，牛顿法的性能可能会显著下降。考虑函数 $f(x) = (x - c)^{m}$，其中 $c$ 是一个常数，$m$ 是一个大的正整数。该函数在 $x=c$ 处有一个重数为 $m$ 的单根。\n\n我们来分析这种情况下的一个具体实例。考虑函数 $f(x) = (x-1)^{10}$。该函数在 $r=1$ 处有一个唯一的根。第 $n$ 次迭代的误差定义为 $e_n = x_n - r$。假设初始猜测值 $x_0$ 足够接近根 $r$ 但不等于它，那么当 $n$ 变得很大时，连续误差之比 $\\frac{|e_{n+1}|}{|e_n|}$ 将趋近于一个常数值。\n\n对于给定的函数 $f(x) = (x-1)^{10}$，求极限 $\\lim_{n \\to \\infty} \\frac{|e_{n+1}|}{|e_n|}$ 的精确值。请用小数表示你的答案。", "solution": "我们将牛顿法应用于 $f(x)=(x-1)^{10}$。其导数为\n$$\nf'(x)=10(x-1)^{9}.\n$$\n牛顿迭代公式为\n$$\nx_{n+1}=x_{n}-\\frac{f(x_{n})}{f'(x_{n})}=x_{n}-\\frac{(x_{n}-1)^{10}}{10(x_{n}-1)^{9}}=x_{n}-\\frac{1}{10}(x_{n}-1).\n$$\n定义误差 $e_{n}=x_{n}-1$。则\n$$\ne_{n+1}=x_{n+1}-1=\\left(x_{n}-\\frac{1}{10}(x_{n}-1)\\right)-1=(x_{n}-1)-\\frac{1}{10}(x_{n}-1)=\\frac{9}{10}e_{n}.\n$$\n因此，对于所有满足 $e_{n}\\neq 0$ 的 $n$，\n$$\n\\frac{|e_{n+1}|}{|e_{n}|}=\\frac{9}{10}.\n$$\n因此，该比值为常数，其极限为\n$$\n\\lim_{n\\to\\infty}\\frac{|e_{n+1}|}{|e_{n}|}=\\frac{9}{10}=0.9.\n$$", "answer": "$$\\boxed{0.9}$$", "id": "2187568"}]}