{"hands_on_practices": [{"introduction": "我们将通过一个非常直观的几何概念——旋转，来开始我们的实践。旋转在图形学和机器人学中无处不在，理解其数值稳定性至关重要。通过计算旋转矩阵的条件数，我们将揭示为什么旋转是一种“完美”的数值操作，它不会放大输入向量中的相对误差，从而建立对理想条件（“良态”）矩阵的直观感受。[@problem_id:2210793]", "problem": "一位机器人工程师正在模拟一个二维机械臂的运动。该模拟涉及到对位置向量施加一系列旋转。工程师担心在这些旋转变换过程中，向量分量中的微小数值误差的传播。为了分析这个问题，他们决定计算旋转操作的条件数。\n\n一个标准的二维旋转，旋转角度为 $\\theta$，由以下矩阵表示：\n$$\nR(\\theta) = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix}\n$$\n线性系统 $Ax=b$ 对 $b$ 中扰动的敏感性由矩阵 $A$ 的条件数来量化，该条件数是相对于给定范数定义的。对于向量2-范数（欧几里得范数），条件数由 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$ 给出，其中 $\\|A\\|_2$ 是由向量2-范数诱导的矩阵2-范数。矩阵2-范数，也称为谱范数，等于矩阵的最大奇异值 $\\sigma_{\\max}(A)$。\n\n计算任何非平凡旋转矩阵 $R(\\theta)$（即 $\\theta$ 不是 $2\\pi$ 的整数倍）的2-范数条件数 $\\kappa_2(R(\\theta))$。根据你的计算结果，选择下面正确陈述条件数值及其对应用旋转操作的数值稳定性的主要影响的选项。\n\nA. 条件数为0。这意味着旋转可能将向量压缩到原点，导致信息的完全丢失。\n\nB. 条件数为1。这意味着施加旋转不会放大输入向量中的相对误差，使得该操作在数值上是理想的或“完美条件的”。\n\nC. 条件数为 $\\sqrt{2}$。这表示在旋转过程中，相对误差可能被放大约41%。\n\nD. 条件数依赖于角度 $\\theta$，具体为 $|\\sec(\\theta)| + |\\csc(\\theta)|$。这意味着当旋转角度接近 $\\pi/2$ 或 $3\\pi/2$ 时，旋转是高度不稳定的。\n\nE. 条件数未定义，因为矩阵在某些角度下是奇异的。这意味着旋转不总是可逆的，从而导致灾难性的误差传播。", "solution": "设 $A=R(\\theta)=\\begin{pmatrix}\\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta\\end{pmatrix}$。计算其转置：\n$$\nA^{\\top}=\\begin{pmatrix}\\cos\\theta & \\sin\\theta \\\\ -\\sin\\theta & \\cos\\theta\\end{pmatrix}.\n$$\n则\n$$\nA^{\\top}A=\\begin{pmatrix}\\cos\\theta & \\sin\\theta \\\\ -\\sin\\theta & \\cos\\theta\\end{pmatrix}\\begin{pmatrix}\\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta\\end{pmatrix}=\\begin{pmatrix}\\cos^{2}\\theta+\\sin^{2}\\theta & 0 \\\\ 0 & \\cos^{2}\\theta+\\sin^{2}\\theta\\end{pmatrix}=I,\n$$\n使用 $\\cos^{2}\\theta+\\sin^{2}\\theta=1$ 以及交叉项相消。因此 $A$ 是正交矩阵，所以它的奇异值是 $A^{\\top}A=I$ 的特征值的平方根，所有这些值都等于 $1$。因此，\n$$\n\\|A\\|_{2}=\\sigma_{\\max}(A)=1.\n$$\n由于对于正交矩阵 $A$ 有 $A^{-1}=A^{\\top}$，因此可得 $\\|A^{-1}\\|_{2}=\\|A^{\\top}\\|_{2}=1$。2-范数条件数为\n$$\n\\kappa_{2}(A)=\\|A\\|_{2}\\,\\|A^{-1}\\|_{2}=1\\cdot 1=1.\n$$\n因为正交矩阵保持欧几里得范数不变，即对所有 $x$ 都有 $ \\|Ax\\|_{2}=\\|x\\|_{2}$，所以施加旋转不会放大相对误差；该操作是完美条件的。这对任何 $\\theta$ 都成立，包括非平凡旋转（甚至当 $\\theta$ 等于 $2\\pi$ 的整数倍时）。\n正确选项是 B。", "answer": "$$\\boxed{B}$$", "id": "2210793"}, {"introduction": "在掌握了理想情况后，让我们来挑战一个更具构造性的任务。这个练习要求您反向工程：给定一个目标条件数，您需要构建一个满足该条件的对角矩阵。这个过程能帮助您加深理解，即矩阵的元素（在此例中为其奇异值的绝对值）如何直接决定其对扰动的敏感度。[@problem_id:2210789]", "problem": "在数值线性代数中，可逆矩阵 $A$ 的2-范数条件数，记为 $\\kappa_2(A)$，衡量了线性系统 $A\\mathbf{x} = \\mathbf{b}$ 的解对向量 $\\mathbf{b}$ 中扰动的敏感程度。其定义为 $A$ 的最大奇异值与其最小奇异值之比。\n\n考虑一个由下式给出的2x2实对角矩阵 $D$\n$$D = \\begin{pmatrix} d_1 & 0 \\\\ 0 & d_2 \\end{pmatrix}$$\n如果第一个对角元素为 $d_1 = 10$，且该矩阵的2-范数条件数为 $\\kappa_2(D) = 50$，那么第二个对角元素 $d_2$ 的所有可能实数值是多少？请以单行矩阵的形式将答案按升序排列。", "solution": "可逆矩阵 $A$ 的2-范数条件数定义为\n$$\n\\kappa_{2}(A) = \\frac{\\sigma_{\\max}(A)}{\\sigma_{\\min}(A)},\n$$\n其中 $\\sigma_{\\max}(A)$ 和 $\\sigma_{\\min}(A)$ 分别表示 $A$ 的最大和最小奇异值。\n\n对于对角矩阵\n$$\nD = \\begin{pmatrix} d_{1} & 0 \\\\ 0 & d_{2} \\end{pmatrix},\n$$\n其奇异值为对角元素的绝对值，因为奇异值是 $D^{\\top}D$ 特征值的平方根，且\n$$\nD^{\\top}D = \\begin{pmatrix} d_{1}^{2} & 0 \\\\ 0 & d_{2}^{2} \\end{pmatrix},\n$$\n所以奇异值为 $|d_{1}|$ 和 $|d_{2}|$。\n\n已知 $d_{1} = 10$ 且 $\\kappa_{2}(D) = 50$，我们有\n$$\n\\kappa_{2}(D) = \\frac{\\max\\{|d_{1}|,|d_{2}|\\}}{\\min\\{|d_{1}|,|d_{2}|\\}} = 50,\n$$\n约束条件为 $d_{2} \\neq 0$（以确保可逆性）。\n\n考虑以下两种情况：\n1) 如果 $|d_{1}| \\geq |d_{2}|$，那么 $\\sigma_{\\max} = |d_{1}| = 10$ 且 $\\sigma_{\\min} = |d_{2}|$，因此\n$$\n\\frac{10}{|d_{2}|} = 50 \\quad \\Rightarrow \\quad |d_{2}| = \\frac{10}{50} = \\frac{1}{5},\n$$\n所以 $d_{2} = \\pm \\frac{1}{5}$。\n\n2) 如果 $|d_{2}| > |d_{1}|$，那么 $\\sigma_{\\max} = |d_{2}|$ 且 $\\sigma_{\\min} = |d_{1}| = 10$，因此\n$$\n\\frac{|d_{2}|}{10} = 50 \\quad \\Rightarrow \\quad |d_{2}| = 500,\n$$\n所以 $d_{2} = \\pm 500$。\n\n汇总所有可能的实数值并按升序排列，得到 $-500$, $-\\frac{1}{5}$, $\\frac{1}{5}$, $500$。", "answer": "$$\\boxed{\\begin{pmatrix}-500 & -\\frac{1}{5} & \\frac{1}{5} & 500\\end{pmatrix}}$$", "id": "2210789"}, {"introduction": "行列式为 $1$ 的矩阵听起来似乎很“稳定”，但这可能是一个误区。本练习旨在打破这一常见误解，通过分析一个剪切变换矩阵来展示这一点。您将发现，即使一个矩阵保持面积不变（行列式为 $1$），它仍然可能极度扭曲空间，导致其成为一个严重的“病态”矩阵，其条件数可以任意大。[@problem_id:1393610]", "problem": "在数值线性代数中，矩阵的条件数衡量了线性方程组的解对输入数据微小变化的敏感程度。条件数高的矩阵被认为是“病态的”(ill-conditioned)。\n\n考虑以下由实数 $k$ 参数化的 $2 \\times 2$ 矩阵族：\n$$\nM(k) = \\begin{pmatrix} 1 & k \\\\ 0 & 1 \\end{pmatrix}\n$$\n这些矩阵表示一个水平剪切变换。对于任何 $k$ 值，$M(k)$ 的行列式都恰好为 1。这可能让人天真地认为该矩阵总是表现良好。然而，其条件数可以变得非常大。\n\n可逆矩阵 $A$ 相对于矩阵 2-范数（也称为谱范数）的条件数定义为 $\\kappa_2(A) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}}$，其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别是 $A$ 的最大和最小奇异值。$A$ 的奇异值是矩阵 $A^T A$ 特征值的平方根。\n\n确定 $k$ 的精确正值，使得条件数 $\\kappa_2(M(k))$ 等于 50。请以单个封闭形式的解析表达式给出您的答案。", "solution": "给定 $M(k)=\\begin{pmatrix}1 & k \\\\ 0 & 1\\end{pmatrix}$，我们希望 2-范数下的条件数 $\\kappa_{2}(M(k))=\\sigma_{\\max}/\\sigma_{\\min}$ 等于 $50$，其中奇异值是 $M(k)^{T}M(k)$ 特征值的平方根。\n\n首先计算\n$$\nM(k)^{T}M(k)=\\begin{pmatrix}1 & 0 \\\\ k & 1\\end{pmatrix}\\begin{pmatrix}1 & k \\\\ 0 & 1\\end{pmatrix}\n=\\begin{pmatrix}1 & k \\\\ k & k^{2}+1\\end{pmatrix}.\n$$\n对于一个对称 $2\\times 2$ 矩阵 $\\begin{pmatrix}a & b \\\\ b & d\\end{pmatrix}$，其特征值为\n$$\n\\lambda_{\\pm}=\\frac{a+d\\pm\\sqrt{(a-d)^{2}+4b^{2}}}{2}.\n$$\n这里 $a=1$，$b=k$，$d=k^{2}+1$，所以\n$$\n\\lambda_{\\pm}=\\frac{k^{2}+2\\pm\\sqrt{k^{4}+4k^{2}}}{2}\n=\\frac{k^{2}+2\\pm |k|\\sqrt{k^{2}+4}}{2}.\n$$\n对于 $k>0$，这变为\n$$\n\\lambda_{\\max}=\\frac{k^{2}+2+k\\sqrt{k^{2}+4}}{2},\\quad\n\\lambda_{\\min}=\\frac{k^{2}+2-k\\sqrt{k^{2}+4}}{2}.\n$$\n因此条件数是\n$$\n\\kappa_{2}(M(k))=\\sqrt{\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}}\n=\\sqrt{\\frac{k^{2}+2+k\\sqrt{k^{2}+4}}{k^{2}+2-k\\sqrt{k^{2}+4}}}.\n$$\n令其等于 $50$ 并将两边平方：\n$$\n2500=\\frac{k^{2}+2+k\\sqrt{k^{2}+4}}{k^{2}+2-k\\sqrt{k^{2}+4}}.\n$$\n引入 $X=k^{2}+2$ 和 $Y=k\\sqrt{k^{2}+4}$（由于 $k>0$ 所以 $Y>0$）。那么\n$$\n2500=\\frac{X+Y}{X-Y}\\quad\\Longrightarrow\\quad X+Y=2500(X-Y).\n$$\n解出比值 $r=\\frac{Y}{X}$ 得\n$$\n\\frac{Y}{X}=\\frac{2500-1}{2500+1}=\\frac{2499}{2501}.\n$$\n因此\n$$\nk\\sqrt{k^{2}+4}=\\frac{2499}{2501}\\,(k^{2}+2).\n$$\n令 $t=k^{2}\\ge 0$。两边平方得\n$$\nt(t+4)=\\left(\\frac{2499}{2501}\\right)^{2}(t+2)^{2}.\n$$\n记 $c=\\left(\\frac{2499}{2501}\\right)^{2}$。展开并合并同类项，\n$$\nt^{2}+4t=c(t^{2}+4t+4)\n\\;\\Longrightarrow\\;\n(1-c)t^{2}+4(1-c)t-4c=0.\n$$\n因为 $c<1$，除以 $(1-c)$：\n$$\nt^{2}+4t-\\frac{4c}{1-c}=0.\n$$\n计算 $\\frac{4c}{1-c}$，利用 $1-c=\\frac{2501^{2}-2499^{2}}{2501^{2}}=\\frac{10000}{2501^{2}}$，所以\n$$\n\\frac{4c}{1-c}=\\frac{4\\cdot \\frac{2499^{2}}{2501^{2}}}{\\frac{10000}{2501^{2}}}=\\frac{2499^{2}}{2500}.\n$$\n因此\n$$\nt^{2}+4t-\\frac{2499^{2}}{2500}=0.\n$$\n判别式是\n$$\n\\Delta=16+4\\cdot\\frac{2499^{2}}{2500}=16+\\frac{2499^{2}}{625}\n=\\frac{10000+2499^{2}}{625}=\\frac{2501^{2}}{625},\n$$\n所以 $\\sqrt{\\Delta}=\\frac{2501}{25}$。因此\n$$\nt=\\frac{-4+\\frac{2501}{25}}{2}=\\frac{\\frac{-100+2501}{25}}{2}=\\frac{2401}{50}.\n$$\n因为 $t=k^{2}$ 且 $k>0$，我们得到\n$$\nk=\\sqrt{\\frac{2401}{50}}=\\frac{49}{\\sqrt{50}}=\\frac{49\\sqrt{2}}{10}.\n$$\n根据构造，这个 $k$ 值使得 $\\kappa_{2}(M(k))=50$。", "answer": "$$\\boxed{\\frac{49\\sqrt{2}}{10}}$$", "id": "1393610"}]}