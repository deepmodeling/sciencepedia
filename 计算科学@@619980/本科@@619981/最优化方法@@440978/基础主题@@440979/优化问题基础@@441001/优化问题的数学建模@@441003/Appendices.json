{"hands_on_practices": [{"introduction": "许多现实世界中的调度和分配问题，例如课程安排、员工排班或任务分配，都可以被精确地构建为整数线性规划（ILP）问题。这个练习 [@problem_id:3147876] 将指导你如何使用二元决策变量和线性约束来为这一经典的资源分配场景建模。通过将时间冲突、容量限制和个人偏好等逻辑规则转化为数学语言，你将掌握将复杂需求转化为可解优化模型的基本技能。", "problem": "一名教务员正在安排学生在一个上午的三个连续时间段内参加辅导课。有 $3$ 名学生，索引为 $i \\in \\{1,2,3\\}$，以及 $4$ 节辅导课，索引为 $j \\in \\{1,2,3,4\\}$。这些辅导课的时间安排如下：第 $1$ 节课从 $09:00$ 到 $09:50$，第 $2$ 节课从 $09:30$ 到 $10:20$，第 $3$ 节课从 $10:20$ 到 $11:10$，第 $4$ 节课从 $11:00$ 到 $11:50$。时间上重叠的两节课不能被同一名学生同时参加。根据给定的时间，重叠的课程对是 $(1,2)$、$(2,3)$ 和 $(3,4)$。\n\n每名学生 $i$ 在整个上午最多可以注册 $2$ 节课。每节课 $j$ 都有一个容量 $C_{j}$，表示允许的最大学生人数：$C_{1}=1$，$C_{2}=1$，$C_{3}=2$，$C_{4}=1$。\n\n对于每名学生 $i$ 和每节课 $j$，都有一个非负的偏好权重 $w_{ij}$，用来衡量学生 $i$ 对参加课程 $j$ 的重视程度。这些权重是：\n- 学生 $1$：$w_{11}=9$, $w_{12}=6$, $w_{13}=8$, $w_{14}=4$。\n- 学生 $2$：$w_{21}=3$, $w_{22}=9$, $w_{23}=5$, $w_{24}=7$。\n- 学生 $3$：$w_{31}=6$, $w_{32}=4$, $w_{33}=8$, $w_{34}=5$。\n\n设 $x_{ij}$ 为一个二元决策变量，如果学生 $i$ 被分配到课程 $j$，则其值为 $1$，否则为 $0$。请使用线性优化和整数决策变量的基本定义，构建一个整数线性规划（ILP）模型。该模型旨在最大化总偏好值，并施加冲突约束（没有学生参加时间重叠的课程）、容量约束（课程不超过其容量）以及每名学生最多参加 $2$ 节课的限制。\n\n然后，对于上面给出的具体数值实例，确定最优的总偏好值，即在所有规定约束条件下 $\\sum_{i=1}^{3} \\sum_{j=1}^{4} w_{ij} x_{ij}$ 的最大值。请将最终答案以单个整数形式给出，不带单位。无需四舍五入。", "solution": "这个问题要求分两部分作答：首先，为学生排课问题建立一个整数线性规划（ILP）模型；其次，求解所给出的具体实例，以找到最大的总偏好值。\n\n首先，我们建立ILP模型。设 $x_{ij}$ 为一个二元决策变量，使得当学生 $i$ 被分配到课程 $j$ 时 $x_{ij} = 1$，否则 $x_{ij} = 0$。学生索引为 $i \\in \\{1, 2, 3\\}$，课程索引为 $j \\in \\{1, 2, 3, 4\\}$。学生 $i$ 对课程 $j$ 的偏好权重用 $w_{ij}$ 表示。\n\n目标是最大化所有已做分配的偏好权重之和。这由目标函数 $Z$ 表示：\n$$ \\text{Maximize } Z = \\sum_{i=1}^{3} \\sum_{j=1}^{4} w_{ij} x_{ij} $$\n\n这个最大化过程受到基于问题描述的几个约束条件的限制。\n\n1.  **二元决策变量**：变量 $x_{ij}$ 必须是二元的，因为一个学生要么被分配到一节课，要么没有。\n    $$ x_{ij} \\in \\{0, 1\\} \\quad \\forall i \\in \\{1, 2, 3\\}, \\; \\forall j \\in \\{1, 2, 3, 4\\} $$\n\n2.  **学生选课数量限制**：每名学生最多可以注册 $2$ 节课。这转化为对每名学生 $i$ 的一个约束条件。\n    $$ \\sum_{j=1}^{4} x_{ij} \\le 2 \\quad \\text{for each } i \\in \\{1, 2, 3\\} $$\n\n3.  **课程容量约束**：任何课程 $j$ 的学生人数不能超过给定的容量 $C_j$。这对每节课 $j$ 产生一个约束条件。\n    $$ \\sum_{i=1}^{3} x_{ij} \\le C_j \\quad \\text{for each } j \\in \\{1, 2, 3, 4\\} $$\n    使用具体的容量值 $C_{1}=1$，$C_{2}=1$，$C_{3}=2$ 和 $C_{4}=1$，这些约束是：\n    $$ \\sum_{i=1}^{3} x_{i1} \\le 1 $$\n    $$ \\sum_{i=1}^{3} x_{i2} \\le 1 $$\n    $$ \\sum_{i=1}^{3} x_{i3} \\le 2 $$\n    $$ \\sum_{i=1}^{3} x_{i4} \\le 1 $$\n\n4.  **冲突约束**：一名学生不能同时参加时间重叠的两节课。问题中指出重叠的课程对是 $(1,2)$、$(2,3)$ 和 $(3,4)$。对于任何学生 $i$，他们从每一对课程中最多只能被分配到一节。这可以模型化为：\n    $$ x_{i1} + x_{i2} \\le 1 \\quad \\text{for each } i \\in \\{1, 2, 3\\} $$\n    $$ x_{i2} + x_{i3} \\le 1 \\quad \\text{for each } i \\in \\{1, 2, 3\\} $$\n    $$ x_{i3} + x_{i4} \\le 1 \\quad \\text{for each } i \\in \\{1, 2, 3\\} $$\n至此，ILP模型的建立完成。\n\n接下来，我们求解这个具体实例以找到最优的总偏好值。所有课程的可用位置总数是其容量之和：$C_1+C_2+C_3+C_4 = 1+1+2+1 = 5$。注册总数也受到学生数量及其个人限制的约束，最多为 $3 \\times 2 = 6$。更严格的限制是总容量，因此最多可以进行 $5$ 次分配（即有 5 个 $x_{ij}=1$）。\n\n可以通过将 $5$ 个最高的偏好权重相加来确定目标函数值的上界。给定的权重 $w_{ij}$ 如下：\n- 学生 $1$：$w_{11}=9$, $w_{12}=6$, $w_{13}=8$, $w_{14}=4$。\n- 学生 $2$：$w_{21}=3$, $w_{22}=9$, $w_{23}=5$, $w_{24}=7$。\n- 学生 $3$：$w_{31}=6$, $w_{32}=4$, $w_{33}=8$, $w_{34}=5$。\n\n将所有权重按降序排列：$9, 9, 8, 8, 7, 6, 6, 5, 5, 4, 4, 3$。\n前 $5$ 个最高的权重是 $w_{11}=9$、$w_{22}=9$、$w_{13}=8$、$w_{33}=8$ 和 $w_{24}=7$。它们的和给出了总偏好值的上界：\n$$ Z_{\\text{upper bound}} = 9 + 9 + 8 + 8 + 7 = 41 $$\n如果存在一个与这五个权重相对应的可行分配，那么它必然是最优解。我们来定义这个潜在的解：\n- $x_{11}=1$（学生 $1$ 参加课程 $1$）\n- $x_{22}=1$（学生 $2$ 参加课程 $2$）\n- $x_{13}=1$（学生 $1$ 参加课程 $3$）\n- $x_{33}=1$（学生 $3$ 参加课程 $3$）\n- $x_{24}=1$（学生 $2$ 参加课程 $4$）\n所有其他 $x_{ij}$ 变量均为 $0$。\n\n我们必须对照所有约束条件来验证这组分配：\n1.  **学生选课数量限制**：\n    - 学生 $1$：被分配到课程 $1$ 和 $3$，总共 $2$ 节课。这满足 $\\le 2$ 的限制。\n    - 学生 $2$：被分配到课程 $2$ 和 $4$，总共 $2$ 节课。这满足 $\\le 2$ 的限制。\n    - 学生 $3$：被分配到课程 $3$，总共 $1$ 节课。这满足 $\\le 2$ 的限制。\n\n2.  **课程容量约束**：\n    - 课程 $1$ ($C_1=1$)：分配了一名学生（学生 $1$）。满足容量限制。\n    - 课程 $2$ ($C_2=1$)：分配了一名学生（学生 $2$）。满足容量限制。\n    - 课程 $3$ ($C_3=2$)：分配了两名学生（学生 $1$ 和 $3$）。满足容量限制。\n    - 课程 $4$ ($C_4=1$)：分配了一名学生（学生 $2$）。满足容量限制。\n\n3.  **冲突约束**：\n    - 学生 $1$（课程 $1, 3$）：课程 $1$ 和 $3$ 不重叠。检查形式化约束：$x_{11}+x_{12} = 1+0 = 1 \\le 1$；$x_{12}+x_{13} = 0+1 = 1 \\le 1$；$x_{13}+x_{14} = 1+0 = 1 \\le 1$。全部满足。\n    - 学生 $2$（课程 $2, 4$）：课程 $2$ 和 $4$ 不重叠。检查形式化约束：$x_{21}+x_{22} = 0+1 = 1 \\le 1$；$x_{22}+x_{23} = 1+0 = 1 \\le 1$；$x_{23}+x_{24} = 0+1 = 1 \\le 1$。全部满足。\n    - 学生 $3$（课程 $3$）：只被分配到一节课，因此不可能有冲突。学生 $3$ 的所有冲突约束都自然满足。\n\n所提出的分配是可行的，因为它满足所有问题约束。此分配的目标函数值是前 $5$ 个最高权重的总和，即 $41$。由于我们找到了一个达到计算出的上界的可行解，因此该解是最优解。\n\n因此，最优的总偏好值为 $41$。", "answer": "$$\n\\boxed{41}\n$$", "id": "3147876"}, {"introduction": "优化不仅限于离散选择，它在处理连续变量和寻找最佳参数方面也同样强大。这个问题 [@problem_id:3147996] 将我们带入工程和数据科学领域的一个常见任务：如何以最佳方式组合来自多个独立传感器的测量值以获得最精确的估计。这个练习展示了凸优化如何为寻找可证明的最优解提供一个强大的框架，并介绍了卡罗需-库恩-塔克（KKT）条件，这是求解约束优化问题的基本分析工具。", "problem": "一位数据融合工程师正在组合来自$n$个独立传感器的读数，这些传感器测量一个共同的标量 $\\theta$。传感器 $i$ 产生一个无偏读数 $y_i$，其期望 $\\mathbb{E}[y_i]=\\theta$，方差 $\\operatorname{Var}(y_i)=\\sigma_i^2$，其中 $\\sigma_i^2>0$ 是已知的。融合估计量是一个凸组合 $\\hat{\\theta}=\\sum_{i=1}^{n} w_i y_i$，其权重 $w_i$ 满足无偏性约束 $\\sum_{i=1}^{n} w_i = 1$ 和对所有 $i$ 的非负性约束 $w_i \\ge 0$。该工程师旨在在这些约束条件下最小化估计量的方差 $\\operatorname{Var}(\\hat{\\theta})$。\n\n利用传感器是独立的、独立随机变量之和的方差等于其方差之和，以及 $\\hat{\\theta}$ 的无偏性要求 $\\sum_{i=1}^{n} w_i = 1$ 这些事实，将选择权重 $w_i$ 的问题建模为一个凸优化问题，并明确写出其目标函数和约束条件。然后，从凸优化的 Karush–Kuhn–Tucker (KKT) 最优性条件（平稳性、原始可行性、对偶可行性和互补松弛性）出发，推导出用 $\\sigma_i^2$ 表示的最优权重 $w_i$，并以闭合形式计算 $\\operatorname{Var}(\\hat{\\theta})$ 的最小值。\n\n你的最终答案只需提供融合估计量的最小化方差，该方差需表示为关于 $\\{\\sigma_i^2\\}_{i=1}^{n}$ 的单一简化解析表达式。", "solution": "所述问题在估计理论领域内构成了一个有效且适定的优化问题。它具有科学依据，内容自洽，并且没有任何逻辑矛盾或含糊不清之处。\n\n首先，我们建立优化问题模型。目标是最小化融合估计量的方差 $\\operatorname{Var}(\\hat{\\theta})$。该估计量由 $\\hat{\\theta} = \\sum_{i=1}^{n} w_i y_i$ 给出。利用方差的性质，我们有：\n$$\n\\operatorname{Var}(\\hat{\\theta}) = \\operatorname{Var}\\left(\\sum_{i=1}^{n} w_i y_i\\right)\n$$\n由于传感器读数 $y_i$ 是独立的，和的方差等于方差的和：\n$$\n\\operatorname{Var}(\\hat{\\theta}) = \\sum_{i=1}^{n} \\operatorname{Var}(w_i y_i)\n$$\n对于常数 $a$ 和随机变量 $X$，利用方差性质 $\\operatorname{Var}(aX) = a^2\\operatorname{Var}(X)$，我们得到：\n$$\n\\operatorname{Var}(\\hat{\\theta}) = \\sum_{i=1}^{n} w_i^2 \\operatorname{Var}(y_i) = \\sum_{i=1}^{n} w_i^2 \\sigma_i^2\n$$\n这个表达式是要最小化的目标函数。最小化过程受制于关于权重 $w_i$ 的两个约束：无偏性约束 $\\sum_{i=1}^{n} w_i = 1$ 和对所有 $i \\in \\{1, 2, \\dots, n\\}$ 的非负性约束 $w_i \\ge 0$。\n\n因此，完整的优化问题是：\n$$\n\\begin{array}{ll}\n\\underset{w_1, \\dots, w_n}{\\operatorname{minimize}}  f(w) = \\sum_{i=1}^{n} w_i^2 \\sigma_i^2 \\\\\n\\text{subject to}  \\sum_{i=1}^{n} w_i - 1 = 0 \\\\\n -w_i \\le 0, \\quad \\text{for } i=1, \\dots, n\n\\end{array}\n$$\n这是一个凸优化问题，因为目标函数是一个凸二次函数（因为所有 $\\sigma_i^2 > 0$），并且约束条件定义了一个凸集（一个单纯形）。\n\n为了找到最优权重，我们使用 Karush–Kuhn–Tucker (KKT) 条件。我们构建拉格朗日函数 $L(w, \\lambda, \\mu)$，其中 $\\lambda$ 是等式约束的拉格朗日乘子，$\\mu_i$ 是非负性约束的乘子：\n$$\nL(w, \\lambda, \\mu_1, \\dots, \\mu_n) = \\sum_{i=1}^{n} w_i^2 \\sigma_i^2 + \\lambda \\left(\\sum_{i=1}^{n} w_i - 1\\right) - \\sum_{i=1}^{n} \\mu_i w_i\n$$\nKKT 最优性条件如下：\n1.  **平稳性 (Stationarity)**：拉格朗日函数对每个 $w_i$ 的梯度必须为零。\n    $$ \\frac{\\partial L}{\\partial w_i} = 2 w_i \\sigma_i^2 + \\lambda - \\mu_i = 0 \\quad \\text{for } i=1, \\dots, n $$\n2.  **原始可行性 (Primal feasibility)**：必须满足原始约束。\n    $$ \\sum_{i=1}^{n} w_i = 1 \\quad \\text{and} \\quad w_i \\ge 0 \\quad \\text{for } i=1, \\dots, n $$\n3.  **对偶可行性 (Dual feasibility)**：不等式约束的拉格朗日乘子必须是非负的。\n    $$ \\mu_i \\ge 0 \\quad \\text{for } i=1, \\dots, n $$\n4.  **互补松弛性 (Complementary slackness)**：每个不等式乘子与其对应的约束函数之积必须为零。\n    $$ \\mu_i w_i = 0 \\quad \\text{for } i=1, \\dots, n $$\n\n从平稳性条件，我们可以将 $w_i$ 表示为：\n$$\nw_i = \\frac{\\mu_i - \\lambda}{2 \\sigma_i^2}\n$$\n互补松弛性条件 $\\mu_i w_i = 0$ 意味着对于任何给定的 $i$，要么 $w_i=0$，要么 $\\mu_i=0$。由于对所有 $i$ 都有 $\\sigma_i^2 > 0$，可以合理地预期所有传感器都对估计有贡献，这意味着对所有 $i$ 都有 $w_i > 0$。如果 $w_i > 0$，那么互补松弛性要求 $\\mu_i = 0$。这也满足了对偶可行性（$\\mu_i \\ge 0$）。\n\n在平稳性方程中对所有 $i$ 设置 $\\mu_i = 0$ 可得：\n$$\n2 w_i \\sigma_i^2 + \\lambda = 0 \\implies w_i = -\\frac{\\lambda}{2 \\sigma_i^2}\n$$\n为了使 $w_i$ 为正，$\\lambda$ 必须为负。我们将 $w_i$ 的这个表达式代入原始可行性约束 $\\sum_{i=1}^{n} w_i = 1$ 来确定 $\\lambda$：\n$$\n\\sum_{i=1}^{n} \\left(-\\frac{\\lambda}{2 \\sigma_i^2}\\right) = 1\n$$\n$$\n-\\frac{\\lambda}{2} \\sum_{i=1}^{n} \\frac{1}{\\sigma_i^2} = 1\n$$\n解出 $\\lambda$：\n$$\n\\lambda = \\frac{-2}{\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^2}} = -2 \\left(\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^2}\\right)^{-1}\n$$\n由于 $\\sigma_j^2 > 0$，该和为正，因此 $\\lambda  0$。这与 $w_i  0$ 的条件一致。现在我们将 $\\lambda$ 的表达式代回 $w_i$ 的方程中：\n$$\nw_i = -\\frac{1}{2 \\sigma_i^2} \\left(-2 \\left(\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^2}\\right)^{-1}\\right) = \\frac{1}{\\sigma_i^2} \\left(\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^2}\\right)^{-1} = \\frac{\\frac{1}{\\sigma_i^2}}{\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^2}}\n$$\n这个 $w_i$ 的解对所有 $i$ 都是正的，所以我们关于 $\\mu_i=0$ 的假设是一致的。所有 KKT 条件都已满足，因此我们找到了唯一的最优权重。传感器 $i$ 的最优权重与其方差的倒数（即其精度）成正比。\n\n最后，我们将最优权重 $w_i$ 代入目标函数，计算最小化方差 $\\operatorname{Var}(\\hat{\\theta})$：\n$$\n\\operatorname{Var}(\\hat{\\theta})_{\\text{min}} = \\sum_{i=1}^{n} w_i^2 \\sigma_i^2 = \\sum_{i=1}^{n} \\left(\\frac{\\frac{1}{\\sigma_i^2}}{\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^2}}\\right)^2 \\sigma_i^2\n$$\n分母相对于求和索引 $i$ 是常数，所以我们可以将其提取出来：\n$$\n\\operatorname{Var}(\\hat{\\theta})_{\\text{min}} = \\frac{1}{\\left(\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^2}\\right)^2} \\sum_{i=1}^{n} \\frac{1}{(\\sigma_i^2)^2} \\sigma_i^2\n$$\n$$\n\\operatorname{Var}(\\hat{\\theta})_{\\text{min}} = \\frac{1}{\\left(\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^2}\\right)^2} \\sum_{i=1}^{n} \\frac{1}{\\sigma_i^2}\n$$\n分子中的和与分母平方中的一个因子相同，从而可以消去一项：\n$$\n\\operatorname{Var}(\\hat{\\theta})_{\\text{min}} = \\frac{\\sum_{i=1}^{n} \\frac{1}{\\sigma_i^2}}{\\left(\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^2}\\right)^2} = \\frac{1}{\\sum_{i=1}^{n} \\frac{1}{\\sigma_i^2}}\n$$\n这就是融合估计量可达到的最小方差。它是各个传感器精度之和的倒数。", "answer": "$$\n\\boxed{\\left(\\sum_{i=1}^{n} \\frac{1}{\\sigma_i^{2}}\\right)^{-1}}\n$$", "id": "3147996"}, {"introduction": "在将真实世界问题建模时，一个核心挑战是处理数据中的不确定性。标准优化模型常常假设所有参数都是精确已知的，但这在实践中很少成立。这个练习 [@problem_id:3147927] 介绍了鲁棒优化的概念，它旨在创建能够抵御特定类型不确定性的模型。通过在一个经典的背包问题背景下，你将学习如何构建一个保证在“最坏情况”下仍然可行的解，并探索从保守模型到更精细的“预算不确定性”集的高级建模技术。", "problem": "一架小型送货无人机必须选择一部分包裹进行派送，以在重量不确定的情况下，最大化派送价值，同时满足有效载荷容量限制。有 $5$ 个包裹，索引为 $i \\in \\{1,2,3,4,5\\}$。选择包裹 $i$ 会产生价值 $v_i$ 并消耗重量 $w_i$，其中真实重量不确定，在区间 $w_i \\in [\\underline{w}_i,\\overline{w}_i]$ 内。无人机的容量为 $W$。决策变量为 $x_i \\in \\{0,1\\}$，表示是否选择包裹 $i$。\n\n数据：\n- 包裹 $1$：$v_1=12$，$\\underline{w}_1=3$，$\\overline{w}_1=5$。\n- 包裹 $2$：$v_2=10$，$\\underline{w}_2=4$，$\\overline{w}_2=4.5$。\n- 包裹 $3$：$v_3=14$，$\\underline{w}_3=2$，$\\overline{w}_3=6$。\n- 包裹 $4$：$v_4=16$，$\\underline{w}_4=5$，$\\overline{w}_4=7$。\n- 包裹 $5$：$v_5=7$，$\\underline{w}_5=1$，$\\overline{w}_5=3$。\n\n容量：$W=15$。\n\n任务：\n1. 使用鲁棒可行性的基本定义，编写保守的鲁棒背包模型，该模型通过在每个区间的“最不利”端点上强制执行容量约束，来保证对所有 $w_i \\in [\\underline{w}_i,\\overline{w}_i]$ 的实现都可行。\n2. 为了减少保守性，根据以下思想建立一个预算不确定性集模型：令每个物品的偏差为 $d_i=\\overline{w}_i-\\underline{w}_i$，并让对抗性偏差变量 $s_i \\in [0,1]$ 表示实现的 $d_i$ 的比例，总预算为 $\\sum_{i=1}^{5} s_i \\le \\Gamma$。对于 $\\Gamma=2$，从鲁棒可行性的定义“容量必须对所有满足 $s_i \\in [0,1]$ 和 $\\sum_i s_i \\le \\Gamma$ 的 $w_i=\\underline{w}_i+d_i s_i$ 成立”出发，推导出以 $\\{x_i\\}$ 和 $\\{d_i\\}$ 表示的鲁棒容量约束，不要使用任何预先给定的简化公式。\n3. 使用您为 $\\Gamma=2$ 推导出的鲁棒容量约束和给定数据，确定可获得的最大总价值 $\\sum_{i=1}^{5} v_i x_i$。请将最终答案以单个实数的形式给出。不需要四舍五入，也不需要单位。", "solution": "问题陈述已经过验证，是自洽、一致且科学合理的。这是一个鲁棒优化领域中适定的问题。\n\n### 任务1：保守的鲁棒背包模型\n\n该问题要求一个模型，能保证对所有可能的重量实现 $w_i \\in [\\underline{w}_i, \\overline{w}_i]$ 都是可行的。这被称为盒式不确定性模型。容量约束为 $\\sum_{i=1}^{5} w_i x_i \\le W$。为了保证在其区间内的任何 $w_i$ 实现都可行，该约束必须在最坏情况下成立。对于给定的包裹选择（一组固定的 $x_i = 1$），约束的左侧 $\\sum_{i=1}^{5} w_i x_i$ 在每个选定的包裹 $i$ 取其最大可能重量 $\\overline{w}_i$ 时达到最大值。\n\n因此，保守的鲁棒约束是：\n$$ \\sum_{i=1}^{5} \\overline{w}_i x_i \\le W $$\n完整的优化模型是在此约束和决策变量的二进制性质下，最大化总价值。\n\n模型是：\n$$ \\text{最大化} \\quad Z = \\sum_{i=1}^{5} v_i x_i $$\n$$ \\text{约束条件：} \\quad \\sum_{i=1}^{5} \\overline{w}_i x_i \\le W $$\n$$ x_i \\in \\{0, 1\\} \\quad \\forall i \\in \\{1, 2, 3, 4, 5\\} $$\n\n### 任务2：预算不确定性模型的推导\n\n预算不确定性集由权重 $w_i = \\underline{w}_i + d_i s_i$ 定义，其中 $d_i = \\overline{w}_i - \\underline{w}_i$ 是偏差，$s_i \\in [0, 1]$ 是对抗性变量，它们的总和受预算 $\\Gamma$ 限制，即 $\\sum_{i=1}^{5} s_i \\le \\Gamma$。\n\n鲁棒可行性条件要求容量约束 $\\sum_{i=1}^{5} w_i x_i \\le W$ 对所有允许的 $w_i$ 实现都成立。代入 $w_i$ 的表达式：\n$$ \\sum_{i=1}^{5} (\\underline{w}_i + d_i s_i) x_i \\le W \\quad \\forall s_i \\in [0, 1] \\text{ 使得 } \\sum_{i=1}^{5} s_i \\le \\Gamma $$\n这可以改写为：\n$$ \\sum_{i=1}^{5} \\underline{w}_i x_i + \\sum_{i=1}^{5} d_i s_i x_i \\le W $$\n为确保该不等式对所有有效的 $s_i$ 成立，它必须对使左侧最大化的 $s_i$ 选择成立。这导出了鲁棒对等约束：\n$$ \\sum_{i=1}^{5} \\underline{w}_i x_i + \\max_{\\substack{s_i \\in [0,1] \\forall i \\\\ \\sum_i s_i \\le \\Gamma}} \\left\\{ \\sum_{i=1}^{5} d_i x_i s_i \\right\\} \\le W $$\n对于一个固定的向量 $x \\in \\{0,1\\}^5$，内部的最大化问题是对抗方的一个线性规划问题：\n$$ \\begin{aligned}\n\\text{(P)} \\quad \\max_{s_1, \\dots, s_5}  \\sum_{i=1}^{5} (d_i x_i) s_i \\\\\n\\text{约束条件}  \\sum_{i=1}^{5} s_i \\le \\Gamma \\\\\n s_i \\le 1, \\quad \\forall i \\in \\{1, \\dots, 5\\} \\\\\n s_i \\ge 0, \\quad \\forall i \\in \\{1, \\dots, 5\\}\n\\end{aligned} $$\n这个最大值是“保护函数”。推导该函数关于 $x_i$ 的通用封闭形式会导致非线性约束。获得等价线性约束系统的一个标准方法是使用线性规划的强对偶性。对抗方问题(P)的对偶问题是：\n$$ \\begin{aligned}\n\\text{(D)} \\quad \\min_{\\lambda, \\mu_i}  \\quad \\Gamma \\lambda + \\sum_{i=1}^{5} \\mu_i \\\\\n\\text{约束条件}  \\quad \\lambda + \\mu_i \\ge d_i x_i, \\quad \\forall i \\in \\{1, \\dots, 5\\} \\\\\n \\quad \\lambda \\ge 0, \\mu_i \\ge 0, \\quad \\forall i \\in \\{1, \\dots, 5\\}\n\\end{aligned} $$\n根据强对偶性，$\\max(P) = \\min(D)$。我们可以将对偶问题代入鲁棒对等约束中。这会得到一个最小-最小问题，可以合并为单个最小化问题。此外，我们可以引入新变量 $z_i$ 来表示项 $\\mu_i$，这使我们能够线性化该公式。设 $z_i$ 是在目标函数中替代 $\\mu_i$ 的变量。从对偶约束可知，我们必须有 $\\mu_i \\ge d_i x_i - \\lambda$。由于我们是在最小化且 $\\mu_i$ 必须为非负，我们可以设置 $\\mu_i = \\max(0, d_i x_i - \\lambda)$。为了以线性方式对此建模，我们引入变量 $z_i$ 使得 $z_i \\ge 0$ 和 $z_i \\ge d_i x_i - \\lambda$。最小化过程将确保 $z_i$ 取值为 $\\max(0, d_i x_i - \\lambda)$。\n\n因此，鲁棒容量约束等价于以下包含原始变量 $x_i$ 和辅助连续变量 $\\lambda$ 和 $z_i$ 的线性不等式系统：\n$$ \\sum_{i=1}^{5} \\underline{w}_i x_i + \\Gamma \\lambda + \\sum_{i=1}^{5} z_i \\le W $$\n$$ z_i \\ge d_i x_i - \\lambda, \\quad \\forall i \\in \\{1, \\dots, 5\\} $$\n$$ z_i \\ge 0, \\quad \\forall i \\in \\{1, \\dots, 5\\} $$\n$$ \\lambda \\ge 0 $$\n这组约束是从第一性原理推导出的鲁棒容量约束。\n\n### 任务3：$\\Gamma=2$ 时的最优值\n\n我们需要求解以下混合整数线性规划 (MILP) 问题：\n$$ \\text{最大化} \\quad Z = 12x_1 + 10x_2 + 14x_3 + 16x_4 + 7x_5 $$\n约束条件：\n$$ x_i \\in \\{0, 1\\}, \\quad \\forall i \\in \\{1, \\dots, 5\\} $$\n以及任务2中的鲁棒容量约束，使用给定数据：\n- $v = (12, 10, 14, 16, 7)$\n- $\\underline{w} = (3, 4, 2, 5, 1)$\n- $\\overline{w} = (5, 4.5, 6, 7, 3)$\n- $d = \\overline{w} - \\underline{w} = (2, 0.5, 4, 2, 2)$\n- $W = 15$ 且 $\\Gamma = 2$\n\n对于一个只有 $2^5=32$ 种可能选择的小问题，我们可以通过评估最有希望的组合来找到最优解。对于任何给定的选择 $x$，鲁棒重量为 $\\sum_i \\underline{w}_i x_i + R(x)$，其中 $R(x)$ 是保护成本。由于 $\\Gamma=2$ 是一个整数，$R(x)$ 是使 $x_i=1$ 的两个最大偏差 $\\{d_i\\}$ 的和。如果选择了一个或零个包裹，它是它们所有偏差的总和。\n\n让我们测试一些关键组合：\n\n1.  **选择 {3, 4, 5}**: $x=(0,0,1,1,1)$\n    - 价值：$v_3+v_4+v_5 = 14+16+7 = 37$。\n    - 名义重量：$\\underline{w}_3+\\underline{w}_4+\\underline{w}_5 = 2+5+1 = 8$。\n    - 选定的偏差：$\\{d_3, d_4, d_5\\} = \\{4, 2, 2\\}$。\n    - 保护成本（最大的2个之和）：$4+2=6$。\n    - 鲁棒重量：$8+6 = 14$。\n    - 可行性：$14 \\le 15$。该解是可行的。\n\n2.  **选择 {1, 2, 3}**: $x=(1,1,1,0,0)$\n    - 价值：$v_1+v_2+v_3 = 12+10+14=36$。\n    - 名义重量：$\\underline{w}_1+\\underline{w}_2+\\underline{w}_3 = 3+4+2=9$。\n    - 选定的偏差：$\\{d_1, d_2, d_3\\} = \\{2, 0.5, 4\\}$。\n    - 保护成本（最大的2个之和）：$4+2=6$。\n    - 鲁棒重量：$9+6=15$。\n    - 可行性：$15 \\le 15$。该解是可行的。\n\n3.  **选择 {1, 4, 5}**: $x=(1,0,0,1,1)$\n    - 价值：$v_1+v_4+v_5 = 12+16+7=35$。\n    - 名义重量：$\\underline{w}_1+\\underline{w}_4+\\underline{w}_5 = 3+5+1=9$。\n    - 选定的偏差：$\\{d_1, d_4, d_5\\} = \\{2, 2, 2\\}$。\n    - 保护成本（最大的2个之和）：$2+2=4$。\n    - 鲁棒重量：$9+4=13$。\n    - 可行性：$13 \\le 15$。该解是可行的。\n\n4.  **选择 {1, 3, 4}**: $x=(1,0,1,1,0)$\n    - 价值：$v_1+v_3+v_4 = 12+14+16=42$。\n    - 名义重量：$\\underline{w}_1+\\underline{w}_3+\\underline{w}_4 = 3+2+5=10$。\n    - 选定的偏差：$\\{d_1, d_3, d_4\\} = \\{2, 4, 2\\}$。\n    - 保护成本（最大的2个之和）：$4+2=6$。\n    - 鲁棒重量：$10+6=16$。\n    - 可行性：$16 \\le 15$。该解是不可行的。\n\n系统性的探索表明，任何4个或5个包裹的组合都是不可行的。例如，在4个包裹的组合中，名义重量最低的组合是 {1, 2, 3, 5}，其名义重量为 $3+4+2+1=10$。偏差为 $\\{2, 0.5, 4, 2\\}$，因此保护成本为 $4+2=6$。鲁棒重量为 $10+6=16$，超过了15的容量。\n\n比较所有可行解的价值，从选择 {3, 4, 5} 中获得最大价值。\n\n可获得的最大总价值为 $37$。", "answer": "$$\\boxed{37}$$", "id": "3147927"}]}