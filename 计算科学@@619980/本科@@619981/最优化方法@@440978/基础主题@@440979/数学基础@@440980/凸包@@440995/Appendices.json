{"hands_on_practices": [{"introduction": "我们从一个基础的几何练习开始，来构建对凸包的直观理解。这个练习要求我们确定一个由特定规则定义的无限离散点集的凸包。通过这个例子 [@problem_id:2117958]，我们将看到，一个复杂点集的凸包可以是一个非常简洁的连续几何形状，这揭示了凸包作为一种简化和概括工具的强大能力。", "problem": "在一个用于固态物理学的简化模型中，局限于二维方格上的电子的可及量子态由具有整数坐标 $(x, y)$ 的点表示。位于 $(x, y)$ 的一个态的能量与其到原点的“曼哈顿距离”有关。对于一个具有最大能量约束 $N$ 的特定系统，一个态被认为是可及的，当且仅当其坐标满足不等式 $|x| + |y| \\leq N$，其中 $N$ 是一个给定的正整数。\n\n为了分析这些态的集体行为，确定包围所有可及态位置的几何边界是很有用的。这个边界在数学上被描述为所有可及点集合的凸包。\n\n确定这个凸包的顶点数和面积。以有序对 $(V, A)$ 的形式给出你的答案，其中 $V$ 是顶点数，$A$ 是凸包的面积，用 $N$ 来表示。", "solution": "令 $S=\\{(x,y)\\in \\mathbb{Z}^{2}: |x|+|y|\\leq N\\}$ 且令 $P=\\{(x,y)\\in \\mathbb{R}^{2}: |x|+|y|\\leq N\\}$。集合 $P$ 是一个凸多边形（一个菱形），其顶点是一个坐标为 $\\pm N$ 而另一个坐标为 $0$ 的点，即 $(N,0)$、$(0,N)$、$(-N,0)$ 和 $(0,-N)$。由于 $N$ 是一个正整数，这四个顶点都在 $S$ 中。\n\n因为 $S\\subseteq P$ 且 $P$ 是凸的，所以包含 $S$ 的最小凸集满足 $\\operatorname{conv}(S)\\subseteq P$。反之，由于 $P$ 的四个顶点都在 $S$ 中，我们有 $P=\\operatorname{conv}\\{(N,0),(0,N),(-N,0),(0,-N)\\}\\subseteq \\operatorname{conv}(S)$。因此，\n$$\n\\operatorname{conv}(S)=P=\\{(x,y)\\in \\mathbb{R}^{2}: |x|+|y|\\leq N\\}.\n$$\n因此，凸包恰好是以上述四个顶点构成的菱形，所以顶点数为 $V=4$。\n\n为了求出面积 $A$，注意到 $P$ 是一个菱形，其对角线是从 $(-N,0)$ 到 $(N,0)$ 以及从 $(0,-N)$ 到 $(0,N)$ 的线段，每条对角线的长度均为 $2N$。对角线长度为 $d_{1}$ 和 $d_{2}$ 的菱形的面积是 $A=\\frac{1}{2}d_{1}d_{2}$。因此，\n$$\nA=\\frac{1}{2}\\cdot (2N)\\cdot (2N)=2N^{2}.\n$$\n所以，有序对 $(V,A)$ 是 $(4,2N^{2})$。", "answer": "$$\\boxed{\\begin{pmatrix}4  2N^{2}\\end{pmatrix}}$$", "id": "2117958"}, {"introduction": "掌握了基本的几何概念后，我们现在将凸包应用到其核心领域：优化。许多优化问题因为包含像 $y=|x|$ 这样的非凸约束而变得难以求解。这个练习 [@problem_id:3114127] 将引导我们用描述非凸区域凸包的线性不等式组来替换这个非凸约束，从而将一个棘手的非凸问题转化为一个可以高效求解的线性规划“松弛”问题。这是全局优化中的一个基本且强大的策略。", "problem": "设 $S \\subset \\mathbb{R}^{2}$ 为集合 $S = \\{(x,y) \\in \\mathbb{R}^{2} : y = |x|,\\; x \\in [-1,1]\\}$。从集合的凸包定义（即包含该集合的所有凸集的交集）出发，并结合平面上任意凸多边形可表示为有限个闭半空间的交集这一事实。仅使用这些基本原则，确定所有能精确描述凸包 $\\operatorname{conv}(S)$ 的面定义线性不等式。\n\n然后考虑非凸优化问题\n$$\n\\min_{x,y} \\;\\; -y + 2x \\quad \\text{subject to} \\quad y = |x|,\\; x \\in [-1,1],\\; x + y \\ge \\tfrac{1}{2}.\n$$\n通过将非凸约束 $y = |x|$ 替换为您所推导出的 $\\operatorname{conv}(S)$ 的精确半空间描述，来构造一个线性规划松弛，并精确求解所得的线性规划。将此松弛问题的最优目标值作为一个实数报告。无需四舍五入。", "solution": "根据要求，本问题将先进行验证，然后分两部分求解。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- 集合为 $S = \\{(x,y) \\in \\mathbb{R}^{2} : y = |x|,\\; x \\in [-1,1]\\}$。\n- 凸包 $\\operatorname{conv}(S)$ 定义为包含 $S$ 的所有凸集的交集。\n- 平面上的任意凸多边形可以表示为有限多个闭半空间的交集。\n- 第一个任务是找出所有描述 $\\operatorname{conv}(S)$ 的面定义线性不等式。\n- 第二个任务是求解非凸问题的线性规划松弛：\n$$\n\\min_{x,y} \\;\\; -y + 2x \\quad \\text{subject to} \\quad y = |x|,\\; x \\in [-1,1],\\; x + y \\ge \\tfrac{1}{2}.\n$$\n- 该松弛是通过将非凸约束 $y = |x|$ 替换为推导出的 $\\operatorname{conv}(S)$ 的半空间描述来构造的。\n- 最终输出应为该松弛的最优目标值。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学性：** 该问题是凸分析和线性规划中的一个标准练习，这两个是成熟的数学学科。所涉及的概念是合理的。\n- **适定性：** 集合 $S$ 是良定义的。其凸包是唯一的集合。所得的线性规划有一个非空、紧致的可行域和一个线性目标函数，这保证了唯一最小值存在。\n- **客观性：** 问题使用精确的数学语言陈述，没有歧义或主观论断。\n- **完整性：** 提供了所有必要信息。不存在矛盾。\n\n**第3步：结论与行动**\n问题有效。将提供完整解答。\n\n### 解答\n\n**第1部分：确定S的凸包**\n\n集合 $S$ 是函数 $y = |x|$ 在 $x \\in [-1,1]$ 上的图像。这是 $\\mathbb{R}^2$ 中两条线段的并集：一条从 $(-1,1)$ 到 $(0,0)$，另一条从 $(0,0)$ 到 $(1,1)$。设顶点为 $A=(-1,1)$，$C=(0,0)$ 和 $B=(1,1)$。\n\n凸包 $\\operatorname{conv}(S)$ 是包含 $S$ 的最小凸集。任何包含 $S$ 的凸集都必须包含其极点 $A$、$B$ 和 $C$。因为一个凸集包含其内任意两点之间的线段，所以它必须包含由这三个顶点形成的三角形。这个三角形（我们称之为 $T$）本身就是一个凸集。由于 $T$ 包含 $S$ 且被任何包含 $S$ 的凸集所包含，因此 $T$ 必定是 $S$ 的凸包。所以，$\\operatorname{conv}(S)$ 是以 $A(-1,1)$、$B(1,1)$ 和 $C(0,0)$ 为顶点的闭合三角形。\n\n如问题所述，一个凸多边形可以表示为有限个闭半空间的交集。这些半空间的边界是包含该多边形的面（边）的直线。我们求出三角形 $ABC$ 三条边的（线性）不等式。\n\n1.  **边 AB**: 这条边连接 $A(-1,1)$ 和 $B(1,1)$。通过这两点的直线是 $y=1$。该三角形位于这条直线的下方或线上。因此，第一个不等式是 $y \\le 1$。对应的闭半空间是 $H_1 = \\{(x,y) \\in \\mathbb{R}^2 \\mid y \\le 1\\}$。\n\n2.  **边 CB**: 这条边连接 $C(0,0)$ 和 $B(1,1)$。通过这两点的直线的斜率为 $\\frac{1-0}{1-0} = 1$ 且通过原点，所以其方程为 $y=x$，或 $y-x=0$。为了确定不等式方向，我们测试三角形内部的一个点，例如 $(-0.5, 0.75)$。对于此点，$y-x = 0.75 - (-0.5) = 1.25$，结果为正。所以，不等式是 $y-x \\ge 0$。对应的闭半空间是 $H_2 = \\{(x,y) \\in \\mathbb{R}^2 \\mid y-x \\ge 0\\}$。\n\n3.  **边 AC**: 这条边连接 $A(-1,1)$ 和 $C(0,0)$。通过这两点的直线的斜率为 $\\frac{1-0}{-1-0} = -1$ 且通过原点，所以其方程为 $y=-x$，或 $y+x=0$。使用相同的测试点 $(-0.5, 0.75)$，我们有 $y+x = 0.75 + (-0.5) = 0.25$，结果为正。所以，不等式是 $y+x \\ge 0$。对应的闭半空间是 $H_3 = \\{(x,y) \\in \\mathbb{R}^2 \\mid y+x \\ge 0\\}$。\n\n描述 $\\operatorname{conv}(S)$ 的三个面定义线性不等式是：\n$$\ny \\le 1\n$$\n$$\ny-x \\ge 0\n$$\n$$\ny+x \\ge 0\n$$\n这三个不等式共同定义了凸包 $\\operatorname{conv}(S) = \\{(x,y) \\mid y \\le 1, y \\ge x, y \\ge -x\\}$。注意，这些约束隐含了 $-1 \\le x \\le 1$ 和 $0 \\le y \\le 1$。\n\n**第2部分：求解线性规划松弛**\n\n原始的非凸问题是：\n$$\n\\min_{x,y} \\;\\; -y + 2x \\quad \\text{subject to} \\quad (x,y) \\in S, \\; x + y \\ge \\tfrac{1}{2}.\n$$\n约束 $(x,y) \\in S$ 意味着 $y=|x|$ 和 $x \\in [-1,1]$。我们通过将非凸集 $S$ 替换为其凸包 $\\operatorname{conv}(S)$ 来创建线性规划（LP）松弛。约束 $x \\in [-1,1]$ 已被隐式地包含在 $\\operatorname{conv}(S)$ 的描述中。线性规划松弛问题是：\n$$\n\\min_{x,y} \\;\\; f(x,y) = 2x - y\n$$\n满足以下约束条件：\n1.  $y \\le 1$\n2.  $y - x \\ge 0$\n3.  $y + x \\ge 0$\n4.  $x + y \\ge \\frac{1}{2}$\n\n可行域是一个紧致的凸多边形。线性目标函数 $f(x,y)$ 的最小值将在该多边形的一个顶点上达到。通过将不等式的边界线两两配对，求解它们的交点，然后检查这些点是否满足所有四个不等式，可以找到顶点。\n\n边界线是：\n$L_1: y = 1$\n$L_2: y = x$\n$L_3: y = -x$\n$L_4: x + y = \\frac{1}{2}$\n\n我们来找出顶点：\n-   **$L_1$ 和 $L_2$ 的交点**: $y=1, y=x \\implies (x,y) = (1,1)$。\n    检查可行性：$1 \\le 1$ (成立)，$1-1 \\ge 0$ (成立)，$1+1 \\ge 0$ (成立)，$1+1 \\ge \\frac{1}{2}$ (成立)。这个点 $V_1=(1,1)$ 是一个顶点。目标函数值：$f(1,1) = 2(1)-1=1$。\n\n-   **$L_1$ 和 $L_4$ 的交点**: $y=1, x+y=\\frac{1}{2} \\implies x = \\frac{1}{2}-1 = -\\frac{1}{2}$。点是 $(-\\frac{1}{2},1)$。\n    检查可行性：$1 \\le 1$ (成立)，$1-(-\\frac{1}{2}) = \\frac{3}{2} \\ge 0$ (成立)，$1+(-\\frac{1}{2}) = \\frac{1}{2} \\ge 0$ (成立)，$-\\frac{1}{2}+1 \\ge \\frac{1}{2}$ (成立)。这个点 $V_2=(-\\frac{1}{2},1)$ 是一个顶点。目标函数值：$f(-\\frac{1}{2},1) = 2(-\\frac{1}{2})-1 = -1-1 = -2$。\n\n-   **$L_2$ 和 $L_4$ 的交点**: $y=x, x+y=\\frac{1}{2} \\implies x+x=\\frac{1}{2} \\implies 2x=\\frac{1}{2} \\implies x=\\frac{1}{4}$。点是 $(\\frac{1}{4},\\frac{1}{4})$。\n    检查可行性：$\\frac{1}{4} \\le 1$ (成立)，$\\frac{1}{4}-\\frac{1}{4} \\ge 0$ (成立)，$\\frac{1}{4}+\\frac{1}{4} \\ge 0$ (成立)，$\\frac{1}{4}+\\frac{1}{4} \\ge \\frac{1}{2}$ (成立)。这个点 $V_3=(\\frac{1}{4},\\frac{1}{4})$ 是一个顶点。目标函数值：$f(\\frac{1}{4},\\frac{1}{4}) = 2(\\frac{1}{4})-\\frac{1}{4} = \\frac{1}{2}-\\frac{1}{4} = \\frac{1}{4}$。\n\n-   其他可能的交点是不可行的。例如，$L_2 \\cap L_3$ 是 $(0,0)$，这违反了 $x+y \\ge \\frac{1}{2}$。$L_1 \\cap L_3$ 是 $(-1,1)$，这也违反了 $x+y \\ge \\frac{1}{2}$，因为 $-1+1=0 \\not\\ge \\frac{1}{2}$。$L_3$ 和 $L_4$ 的斜率相同（都为 $-1$），因此它们是平行的，没有交点。\n\n可行域的顶点是 $V_1(1,1)$、$V_2(-\\frac{1}{2},1)$ 和 $V_3(\\frac{1}{4},\\frac{1}{4})$。我们计算每个顶点的目标函数值：\n- $f(V_1) = 1$\n- $f(V_2) = -2$\n- $f(V_3) = \\frac{1}{4}$\n\n这些值中的最小值是 $-2$。因此，线性规划松弛的最优目标值是 $-2$。", "answer": "$$\n\\boxed{-2}\n$$", "id": "3114127"}, {"introduction": "在前一个练习的基础上，我们处理一个更复杂、但在实际应用中非常常见的非凸性来源：双线性项 $z=xy$。这个问题 [@problem_id:3114152] 将介绍一种标准技术，即麦考密克（McCormick）封套，来构建这种非凸曲面的凸包。此外，本练习还引入了“最优性间隙”的概念，用于衡量松弛问题的解与原问题最优解之间的差距，这是评估和改进优化算法性能的关键指标。", "problem": "考虑双线性集合 $S=\\{(x,y,z)\\in\\mathbb{R}^{3}: z=xy,\\; x\\in[\\ell_{x},u_{x}],\\; y\\in[\\ell_{y},u_{y}]\\}$，其中 $\\ell_{x}  u_x$ 和 $\\ell_y  u_y$ 是有限的界限。对于这个集合，它的凸包，即所谓的麦考密克(McCormick)封套，可以由四个线性不等式精确描述，这些不等式定义了 $z$ 在 $x$ 和 $y$ 上的上下界。\n\n考虑以下非凸优化问题：\n$$\n\\max\\; z \\quad \\text{约束条件} \\quad z=xy,\\; x+y=4,\\; x\\in[0,4],\\; y\\in[0,4]\n$$\n设 $z^{\\star}$ 是该问题的最优目标值。\n\n现在，通过用上述 $S$ 在其自己的界限（即 $x,y\\in[0,4]$）下的凸包来替换非凸约束 $z=xy$，来构造该问题的凸松弛。设 $z_{\\mathrm{MC}}$ 是这个松弛问题的最优目标值。\n\n计算乘性最优性间隙 $G = \\frac{z_{\\mathrm{MC}}}{z^{\\star}}$，并将其作为一个实数报告。无需四舍五入。", "solution": "该问题是有效的，因为它在优化领域有科学依据，是适定且客观的。我们分三部分进行求解：首先，推导凸包；其次，求解两个优化问题；第三，计算最优性间隙。\n\n首先，我们推导集合 $S = \\{(x, y, z) \\in \\mathbb{R}^{3} : z=xy, x \\in [\\ell_x, u_x], y \\in [\\ell_y, u_y]\\}$ 的凸包。这被称为 McCormick 凸包络。凸包是包含 $S$ 的最紧凸集，由 $x$ 和 $y$ 的原始箱式约束以及四个线性不等式描述。我们来推导这些不等式。\n\n双线性项 $z=xy$ 是非凸的。其凸包络由两个凸下估计量和两个凹上估计量定义。\n1. 考虑表达式 $(x-\\ell_x)(y-\\ell_y)$。由于 $x \\ge \\ell_x$ 和 $y \\ge \\ell_y$，该乘积是非负的：\n$$\n(x-\\ell_x)(y-\\ell_y) \\ge 0 \\implies xy - \\ell_x y - \\ell_y x + \\ell_x \\ell_y \\ge 0\n$$\n由于在集合 $S$ 上 $z=xy$，这意味着 $z \\ge \\ell_y x + \\ell_x y - \\ell_x \\ell_y$。这个不等式是关于 $x$, $y$ 和 $z$ 的线性不等式，定义了一个半空间。该半空间包含 $S$，并且是 $z$ 的一个凸下估计量。\n\n2. 类似地，考虑 $(u_x-x)(u_y-y)$。由于 $x \\le u_x$ 和 $y \\le u_y$，该乘积也是非负的：\n$$\n(u_x-x)(u_y-y) \\ge 0 \\implies u_x u_y - u_x y - u_y x + xy \\ge 0\n$$\n这意味着 $z \\ge u_y x + u_x y - u_x u_y$。这是第二个凸下估计量。\n\n3. 现在考虑 $(x-\\ell_x)(u_y-y)$。由于 $x \\ge \\ell_x$ 和 $y \\le u_y$，该乘积是非负的：\n$$\n(x-\\ell_x)(u_y-y) \\ge 0 \\implies u_y x - xy - \\ell_x u_y + \\ell_x y \\ge 0\n$$\n这意味着 $z \\le u_y x + \\ell_x y - \\ell_x u_y$。这是一个凹上估计量。\n\n4. 最后，考虑 $(u_x-x)(y-\\ell_y)$。由于 $x \\le u_x$ 和 $y \\ge \\ell_y$，该乘积是非负的：\n$$\n(u_x-x)(y-\\ell_y) \\ge 0 \\implies u_x y - u_x \\ell_y - xy + \\ell_y x \\ge 0\n$$\n这意味着 $z \\le \\ell_y x + u_x y - u_x \\ell_y$。这是第二个凹上估计量。\n\n$S$ 的凸包，记为 $\\text{conv}(S)$，是 $\\mathbb{R}^3$ 中由以下不等式定义的区域：\n$$\n\\begin{align*}\nx  \\in [\\ell_x, u_x] \\\\\ny  \\in [\\ell_y, u_y] \\\\\nz  \\ge \\ell_y x + \\ell_x y - \\ell_x \\ell_y \\\\\nz  \\ge u_y x + u_x y - u_x u_y \\\\\nz  \\le u_y x + \\ell_x y - \\ell_x u_y \\\\\nz  \\le \\ell_y x + u_x y - u_x \\ell_y\n\\end{align*}\n$\\text{conv}(S)$ 中的任意点都是 $S$ 中点的凸组合。由于 $S$ 中的每个点都满足这四个不等式，并且这些不等式本身定义了一个凸集（半空间的交集），因此 $S$ 中点的任何凸组合也将满足这些不等式。因此，这组不等式正确地描述了凸包。\n\n接下来，我们求解原始的非凸优化问题：\n$$\n\\max\\; z \\quad \\text{约束条件} \\quad z=xy,\\; x+y=4,\\; x\\in[0,4],\\; y\\in[0,4].\n$$\n我们将线性约束 $y=4-x$ 代入 $z$ 的方程中：\n$$\nz = x(4-x) = 4x - x^2\n$$\n问题变为在区间 $x \\in [0,4]$ 上最大化函数 $f(x) = 4x - x^2$。对 $y$ 的约束 $y \\in [0,4]$ 变为 $4-x \\in [0,4]$，这意味着 $x \\in [0,4]$，因此没有增加新的限制。\n为求凹二次函数 $f(x)$ 的最大值，我们对其求导并令其为零：\n$$\nf'(x) = 4 - 2x = 0 \\implies x = 2\n$$\n由于 $x=2$ 位于区间 $[0,4]$ 内，它是最大值的一个候选点。二阶导数为 $f''(x) = -2  0$，证实了这是一个最大值。在 $x=2$ 时，$z$ 的值为 $z = 4(2) - 2^2 = 8-4=4$。对应的 $y$ 值为 $y=4-2=2$。\n非凸问题的最优目标值为 $z^{\\star} = 4$。\n\n现在，我们构造凸松弛。我们将非凸约束 $z=xy$ 替换为其在界 $\\ell_x=0$, $u_x=4$, $\\ell_y=0$, $u_y=4$ 下的凸包络。问题变为：\n$$\n\\max\\; z\n$$\n约束条件为：\n$$\n\\begin{align*}\nz  \\ge 0 \\cdot x + 0 \\cdot y - 0 \\cdot 0 \\implies z \\ge 0 \\\\\nz  \\ge 4x + 4y - 4 \\cdot 4 \\implies z \\ge 4(x+y) - 16 \\\\\nz  \\le 4x + 0 \\cdot y - 0 \\cdot 4 \\implies z \\le 4x \\\\\nz  \\le 0 \\cdot x + 4y - 4 \\cdot 0 \\implies z \\le 4y \\\\\nx + y = 4 \\\\\nx  \\in [0,4], \\quad y \\in [0,4]\n\\end{align*}\n我们可以使用 $x+y=4$ 来化简这些约束。第二个不等式变为 $z \\ge 4(4) - 16 \\implies z \\ge 0$，这与第一个不等式相同。\n将 $y=4-x$ 代入上估计量，我们得到：\n$$\nz \\le 4x\n$$\n$$\nz \\le 4(4-x) = 16 - 4x\n$$\n松弛问题是一个线性规划：\n$$\n\\max\\; z \\quad \\text{约束条件} \\quad z \\le 4x, \\quad z \\le 16 - 4x, \\quad x \\in [0,4].\n$$\n为了最大化 $z$，对于任意给定的 $x$，我们必须有 $z \\le \\min(4x, 16-4x)$。因此，该问题等价于求解：\n$$\n\\max_{x \\in [0,4]} \\min(4x, 16-4x)\n$$\n$\\min(f_1(x), f_2(x))$ 的最大值通常出现在 $f_1(x) = f_2(x)$ 的地方。我们来找到这个点：\n$$\n4x = 16 - 4x \\implies 8x = 16 \\implies x = 2\n$$\n当 $x  2$ 时，$4x  16-4x$，所以函数是 $4x$（递增）。当 $x > 2$ 时，$16-4x  4x$，所以函数是 $16-4x$（递减）。因此，最大值在 $x=2$ 处取得。\n在 $x=2$ 时，$z$ 的最大值为 $4(2) = 8$。\n凸松弛的最优值为 $z_{\\mathrm{MC}} = 8$。\n\n最后，我们计算乘性最优性间隙 $G$：\n$$\nG = \\frac{z_{\\mathrm{MC}}}{z^{\\star}} = \\frac{8}{4} = 2\n$$", "answer": "$$\n\\boxed{2}\n$$", "id": "3114152"}]}