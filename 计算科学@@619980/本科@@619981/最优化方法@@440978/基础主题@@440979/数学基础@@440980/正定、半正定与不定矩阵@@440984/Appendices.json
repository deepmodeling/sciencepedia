{"hands_on_practices": [{"introduction": "精确线搜索是许多优化算法中的基本步骤。对于二次函数 $f(x) = \\tfrac{1}{2} x^{\\top} Q x$，这一步能否成功（即是否能找到一个最小值并降低目标函数值）完全取决于其 Hessian 矩阵 $Q$ 的正定性。本练习将通过一个正定（凸）情形和一个不定（非凸）情形的鲜明对比，揭示矩阵正定性如何决定了最速下降法的行为 [@problem_id:3163346]。", "problem": "考虑无约束二次目标函数 $f(x) = \\tfrac{1}{2} x^{\\top} Q x$，其中 $Q \\in \\mathbb{R}^{n \\times n}$ 为对称矩阵。如果对于所有非零 $x$，都有 $x^{\\top} Q x > 0$，则矩阵 $Q$ 称为正定（PD）矩阵；如果存在非零的 $x$ 和 $y$ 使得 $x^{\\top} Q x > 0$ 且 $y^{\\top} Q y  0$，则称其为不定矩阵。在基于梯度的优化中，从当前点 $x$ 沿搜索方向 $p$ 进行的精确线搜索定义为选择一个步长 $\\alpha$，通过求解 $\\frac{d}{d\\alpha}\\phi(\\alpha) = 0$ 来最小化一元函数 $\\phi(\\alpha) = f(x + \\alpha p)$。\n\n你的任务是，在选定的起始点，使用最速下降方向 $p = -\\nabla f(x)$，比较正定矩阵 $Q$ 和不定矩阵 $Q$ 的精确线搜索行为。请处理以下两种情况：\n\n- 正定情况：$Q_{\\text{PD}} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$ 和 $x_{\\text{PD}} = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$。\n- 不定情况：$Q_{\\text{indef}} = \\begin{pmatrix} 1  0 \\\\ 0  -3 \\end{pmatrix}$ 和 $x_{\\text{indef}} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n从梯度和精确线搜索的基本定义出发，不要使用预先记下的快捷公式，对每种情况执行以下操作：\n\n1. 在给定的 $x$ 处，计算最速下降方向 $p = -\\nabla f(x)$。\n2. 推导并计算满足 $\\frac{d}{d\\alpha} f(x + \\alpha p) = 0$ 的精确线搜索步长 $\\alpha^{\\star}$。\n3. 评估目标函数的变化量 $\\Delta f = f(x + \\alpha^{\\star} p) - f(x)$。\n\n以行矩阵 $\\begin{pmatrix} \\alpha^{\\star}_{\\text{PD}}  \\alpha^{\\star}_{\\text{indef}}  \\Delta f_{\\text{PD}}  \\Delta f_{\\text{indef}} \\end{pmatrix}$ 的精确形式返回你的最终答案。不需要四舍五入，也没有单位。", "solution": "该问题要求分析无约束二次目标函数 $f(x) = \\frac{1}{2} x^{\\top} Q x$ 在对称矩阵 $Q$ 的两种不同情况下的精确线搜索过程：一种是 $Q$ 为正定（PD）矩阵，另一种是 $Q$ 为不定矩阵。搜索方向指定为最速下降方向，$p = -\\nabla f(x)$。\n\n首先，我们为感兴趣的量建立通用公式。目标函数为 $f(x) = \\frac{1}{2} x^{\\top} Q x$。该函数关于 $x$ 的梯度由下式给出：\n$$ \\nabla f(x) = \\frac{1}{2} (Q + Q^{\\top}) x $$\n由于 $Q$ 是对称的，$Q = Q^{\\top}$，这可将梯度简化为：\n$$ \\nabla f(x) = Qx $$\n在点 $x$ 处的最速下降方向 $p$ 定义为梯度的负值：\n$$ p = -\\nabla f(x) = -Qx $$\n精确线搜索旨在找到一个步长 $\\alpha$，以最小化一元函数 $\\phi(\\alpha) = f(x + \\alpha p)$。我们首先构建这个函数：\n$$ \\phi(\\alpha) = f(x + \\alpha p) = \\frac{1}{2} (x + \\alpha p)^{\\top} Q (x + \\alpha p) $$\n展开此表达式，我们得到：\n$$ \\phi(\\alpha) = \\frac{1}{2} (x^{\\top} + \\alpha p^{\\top}) Q (x + \\alpha p) = \\frac{1}{2} (x^{\\top}Qx + \\alpha x^{\\top}Qp + \\alpha p^{\\top}Qx + \\alpha^2 p^{\\top}Qp) $$\n由于 $x^{\\top}Qp$ 是一个标量，它等于其转置，即 $(x^{\\top}Qp)^{\\top} = p^{\\top}Q^{\\top}x$。又因为 $Q=Q^{\\top}$，这可以简化为 $p^{\\top}Qx$。因此，中间两项是相同的。\n$$ \\phi(\\alpha) = \\frac{1}{2} x^{\\top}Qx + \\alpha p^{\\top}Qx + \\frac{1}{2} \\alpha^2 p^{\\top}Qp $$\n问题将寻找步长 $\\alpha^{\\star}$ 的过程定义为求解 $\\frac{d}{d\\alpha}\\phi(\\alpha) = 0$。我们计算关于 $\\alpha$ 的导数：\n$$ \\frac{d\\phi}{d\\alpha} = p^{\\top}Qx + \\alpha p^{\\top}Qp $$\n将导数设为零，得到驻点 $\\alpha^{\\star}$：\n$$ p^{\\top}Qx + \\alpha^{\\star} p^{\\top}Qp = 0 \\implies \\alpha^{\\star} = -\\frac{p^{\\top}Qx}{p^{\\top}Qp} $$\n我们可以通过代入 $Qx = -p$ 来简化这个表达式：\n$$ \\alpha^{\\star} = -\\frac{p^{\\top}(-p)}{p^{\\top}Qp} = \\frac{p^{\\top}p}{p^{\\top}Qp} $$\n只要 $p^{\\top}Qp \\neq 0$，这个 $\\alpha^{\\star}$ 的表达式就有效。\n\n目标函数的变化量是 $\\Delta f = f(x + \\alpha^{\\star} p) - f(x)$。使用 $\\phi(\\alpha)$ 的表达式，这等于 $\\phi(\\alpha^{\\star}) - \\phi(0)$。\n$$ \\Delta f = \\left( \\frac{1}{2} x^{\\top}Qx + \\alpha^{\\star} p^{\\top}Qx + \\frac{1}{2} (\\alpha^{\\star})^2 p^{\\top}Qp \\right) - \\frac{1}{2} x^{\\top}Qx $$\n$$ \\Delta f = \\alpha^{\\star} p^{\\top}Qx + \\frac{1}{2} (\\alpha^{\\star})^2 p^{\\top}Qp $$\n根据一阶条件 $p^{\\top}Qx + \\alpha^{\\star} p^{\\top}Qp = 0$，我们有 $p^{\\top}Qx = -\\alpha^{\\star} p^{\\top}Qp$。将此代入 $\\Delta f$ 的表达式中：\n$$ \\Delta f = \\alpha^{\\star} (-\\alpha^{\\star} p^{\\top}Qp) + \\frac{1}{2} (\\alpha^{\\star})^2 p^{\\top}Qp = -(\\alpha^{\\star})^2 p^{\\top}Qp + \\frac{1}{2} (\\alpha^{\\star})^2 p^{\\top}Qp = -\\frac{1}{2} (\\alpha^{\\star})^2 p^{\\top}Qp $$\n或者，代入 $p^{\\top}Qp = \\frac{p^{\\top}p}{\\alpha^{\\star}}$ 会得到另一个有用的形式：\n$$ \\Delta f = -\\frac{1}{2} (\\alpha^{\\star})^2 \\left( \\frac{p^{\\top}p}{\\alpha^{\\star}} \\right) = -\\frac{1}{2} \\alpha^{\\star} p^{\\top}p $$\n\n现在我们将这些通用公式应用于指定的两种情况。\n\n**情况 1：正定矩阵**\n给定的矩阵和起始点是：\n$Q_{\\text{PD}} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$ 和 $x_{\\text{PD}} = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$。\n\n1.  计算最速下降方向 $p_{\\text{PD}}$：\n    $\\nabla f(x_{\\text{PD}}) = Q_{\\text{PD}} x_{\\text{PD}} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} 4(1) + 1(-2) \\\\ 1(1) + 3(-2) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -5 \\end{pmatrix}$。\n    $p_{\\text{PD}} = -\\nabla f(x_{\\text{PD}}) = \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix}$。\n\n2.  使用 $\\alpha^{\\star} = \\frac{p^{\\top}p}{p^{\\top}Qp}$ 计算精确线搜索步长 $\\alpha^{\\star}_{\\text{PD}}$：\n    $p_{\\text{PD}}^{\\top} p_{\\text{PD}} = (-2)^2 + 5^2 = 4 + 25 = 29$。\n    $Q_{\\text{PD}} p_{\\text{PD}} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix} \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} 4(-2) + 1(5) \\\\ 1(-2) + 3(5) \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 13 \\end{pmatrix}$。\n    $p_{\\text{PD}}^{\\top} Q_{\\text{PD}} p_{\\text{PD}} = \\begin{pmatrix} -2  5 \\end{pmatrix} \\begin{pmatrix} -3 \\\\ 13 \\end{pmatrix} = (-2)(-3) + 5(13) = 6 + 65 = 71$。\n    $\\alpha^{\\star}_{\\text{PD}} = \\frac{29}{71}$。\n    $\\phi(\\alpha)$ 的二阶导数是 $\\frac{d^2\\phi}{d\\alpha^2} = p_{\\text{PD}}^{\\top} Q_{\\text{PD}} p_{\\text{PD}} = 71 > 0$。由于 $Q_{\\text{PD}}$ 是正定的，对于任何非零的 $p$ 这都是保证的。这个正的二阶导数证实了 $\\alpha^{\\star}_{\\text{PD}}$ 对应于一个最小值。\n\n3.  使用 $\\Delta f = -\\frac{1}{2} \\alpha^{\\star} p^{\\top}p$ 评估目标函数的变化量 $\\Delta f_{\\text{PD}}$：\n    $\\Delta f_{\\text{PD}} = -\\frac{1}{2} \\left( \\frac{29}{71} \\right) (29) = -\\frac{841}{142}$。目标函数值减小，这符合最小化步骤的预期。\n\n**情况 2：不定矩阵**\n给定的矩阵和起始点是：\n$Q_{\\text{indef}} = \\begin{pmatrix} 1  0 \\\\ 0  -3 \\end{pmatrix}$ 和 $x_{\\text{indef}} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n1.  计算最速下降方向 $p_{\\text{indef}}$：\n    $\\nabla f(x_{\\text{indef}}) = Q_{\\text{indef}} x_{\\text{indef}} = \\begin{pmatrix} 1  0 \\\\ 0  -3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1(1) + 0(1) \\\\ 0(1) + (-3)(1) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -3 \\end{pmatrix}$。\n    $p_{\\text{indef}} = -\\nabla f(x_{\\text{indef}}) = \\begin{pmatrix} -1 \\\\ 3 \\end{pmatrix}$。\n\n2.  计算精确线搜索步长 $\\alpha^{\\star}_{\\text{indef}}$：\n    $p_{\\text{indef}}^{\\top} p_{\\text{indef}} = (-1)^2 + 3^2 = 1 + 9 = 10$。\n    $Q_{\\text{indef}} p_{\\text{indef}} = \\begin{pmatrix} 1  0 \\\\ 0  -3 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 1(-1) + 0(3) \\\\ 0(-1) + (-3)(3) \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -9 \\end{pmatrix}$。\n    $p_{\\text{indef}}^{\\top} Q_{\\text{indef}} p_{\\text{indef}} = \\begin{pmatrix} -1  3 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -9 \\end{pmatrix} = (-1)(-1) + 3(-9) = 1 - 27 = -26$。\n    $\\alpha^{\\star}_{\\text{indef}} = \\frac{p_{\\text{indef}}^{\\top} p_{\\text{indef}}}{p_{\\text{indef}}^{\\top} Q_{\\text{indef}} p_{\\text{indef}}} = \\frac{10}{-26} = -\\frac{5}{13}$。\n    $\\phi(\\alpha)$ 的二阶导数是 $\\frac{d^2\\phi}{d\\alpha^2} = p_{\\text{indef}}^{\\top} Q_{\\text{indef}} p_{\\text{indef}} = -26  0$。这个负值表明找到的驻点是一个局部最大值，而不是最小值。函数 $\\phi(\\alpha)$ 是一个开口向下的抛物线，且下方无界，这意味着线搜索不存在真正的最小值。步长 $\\alpha^\\star$ 是应用指定程序得到的结果，该程序未能找到最小值。$\\alpha^\\star$ 的负号意味着步长是沿着梯度的方向而不是相反方向。\n\n3.  评估目标函数的变化量 $\\Delta f_{\\text{indef}}$：\n    $\\Delta f_{\\text{indef}} = -\\frac{1}{2} \\alpha^{\\star}_{\\text{indef}} p_{\\text{indef}}^{\\top} p_{\\text{indef}} = -\\frac{1}{2} \\left( -\\frac{5}{13} \\right) (10) = \\frac{50}{26} = \\frac{25}{13}$。\n    目标函数值增加，这与沿着搜索方向移动到局部最大值是一致的。\n\n最后，我们将计算出的四个值组合成所要求的行矩阵。\n$$ \\begin{pmatrix} \\alpha^{\\star}_{\\text{PD}}  \\alpha^{\\star}_{\\text{indef}}  \\Delta f_{\\text{PD}}  \\Delta f_{\\text{indef}} \\end{pmatrix} = \\begin{pmatrix} \\frac{29}{71}  -\\frac{5}{13}  -\\frac{841}{142}  \\frac{25}{13} \\end{pmatrix} $$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{29}{71}  -\\frac{5}{13}  -\\frac{841}{142}  \\frac{25}{13} \\end{pmatrix}}\n$$", "id": "3163346"}, {"introduction": "我们已经看到，对于不定 Hessian 矩阵，简单的线搜索可能会失败。现在我们来探讨一种处理这种“负曲率”的稳健方法。信赖域方法将搜索最小值的范围限制在一个小球内，从而防止算法走向目标函数无界的区域。本练习将引导你从第一性原理出发，通过特征分解来显式地求解一个经典的信赖域子问题，并观察其解是如何利用负曲率方向来达到最小值的 [@problem_id:3163285]。", "problem": "考虑无约束优化中的二次信赖域子问题：\n最小化 $q(\\mathbf{p}) = \\mathbf{g}^{\\top}\\mathbf{p} + \\tfrac{1}{2}\\mathbf{p}^{\\top}\\mathbf{H}\\mathbf{p}$，约束条件为 $\\|\\mathbf{p}\\|_{2} \\leq \\Delta$，其中 $\\|\\cdot\\|_{2}$ 表示欧几里得范数。设对称矩阵 $\\mathbf{H}$ 的特征分解为 $\\mathbf{H} = \\mathbf{Q}\\mathbf{\\Lambda}\\mathbf{Q}^{\\top}$，其中\n$$\\mathbf{Q} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ -1  1 \\end{pmatrix}, \\quad \\mathbf{\\Lambda} = \\begin{pmatrix} -2  0 \\\\ 0  1 \\end{pmatrix}.$$\n设梯度向量为 $\\mathbf{g} = \\mathbf{Q}\\begin{pmatrix} 0 \\\\ 3 \\end{pmatrix}$，信赖域半径为 $\\Delta = 2$。仅使用第一性原理（特征分解的定义、欧几里得范数以及约束最小化的必要最优性条件），通过特征分解显式地求解该信赖域子问题。识别负曲率方向并解释其对最优点的影响。然后计算精确的最小目标值 $q(\\mathbf{p}^{\\star})$。将你的最终答案表示为一个精确的数字（不要四舍五入）。", "solution": "问题是求解二次信赖域子问题：\n$$ \\text{minimize} \\quad q(\\mathbf{p}) = \\mathbf{g}^{\\top}\\mathbf{p} + \\tfrac{1}{2}\\mathbf{p}^{\\top}\\mathbf{H}\\mathbf{p} \\quad \\text{subject to} \\quad \\|\\mathbf{p}\\|_{2} \\leq \\Delta $$\n其中 Hessian 矩阵 $\\mathbf{H}$ 具有给定的特征分解 $\\mathbf{H} = \\mathbf{Q}\\mathbf{\\Lambda}\\mathbf{Q}^{\\top}$，梯度为 $\\mathbf{g}$，信赖域半径为 $\\Delta$。\n\n首先，我们展开给定的信息：\n$\\mathbf{Q} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ -1  1 \\end{pmatrix}$，$\\mathbf{\\Lambda} = \\begin{pmatrix} -2  0 \\\\ 0  1 \\end{pmatrix}$，$\\mathbf{g} = \\mathbf{Q}\\begin{pmatrix} 0 \\\\ 3 \\end{pmatrix}$，以及 $\\Delta = 2$。\n矩阵 $\\mathbf{Q}$ 是正交的 ($\\mathbf{Q}^{\\top}\\mathbf{Q} = \\mathbf{I}$)。$\\mathbf{H}$ 的特征值是 $\\lambda_1 = -2$ 和 $\\lambda_2 = 1$。由于存在负特征值，$\\mathbf{H}$ 是一个不定矩阵。\n\n为了利用特征分解简化问题，我们进行变量替换，令 $\\mathbf{p} = \\mathbf{Q}\\mathbf{s}$，其中 $\\mathbf{s} = \\begin{pmatrix} s_1 \\\\ s_2 \\end{pmatrix}$。由于 $\\mathbf{Q}$ 是正交的，这个变换是保范数的：$\\|\\mathbf{p}\\|_{2} = \\|\\mathbf{Q}\\mathbf{s}\\|_{2} = \\|\\mathbf{s}\\|_{2}$。因此，约束条件 $\\|\\mathbf{p}\\|_{2} \\leq \\Delta$ 变为 $\\|\\mathbf{s}\\|_{2} \\leq \\Delta$。\n\n我们用 $\\mathbf{s}$ 来重写目标函数 $q(\\mathbf{p})$。梯度项变为 $\\mathbf{g}^{\\top}\\mathbf{p} = (\\mathbf{Q}\\hat{\\mathbf{g}})^{\\top}(\\mathbf{Q}\\mathbf{s}) = \\hat{\\mathbf{g}}^{\\top}\\mathbf{Q}^{\\top}\\mathbf{Q}\\mathbf{s} = \\hat{\\mathbf{g}}^{\\top}\\mathbf{s}$，其中 $\\hat{\\mathbf{g}} = \\mathbf{Q}^{\\top}\\mathbf{g} = \\mathbf{Q}^{\\top}\\left(\\mathbf{Q}\\begin{pmatrix} 0 \\\\ 3 \\end{pmatrix}\\right) = \\begin{pmatrix} 0 \\\\ 3 \\end{pmatrix}$。\n二次型项变为 $\\tfrac{1}{2}\\mathbf{p}^{\\top}\\mathbf{H}\\mathbf{p} = \\tfrac{1}{2}(\\mathbf{Q}\\mathbf{s})^{\\top}(\\mathbf{Q}\\mathbf{\\Lambda}\\mathbf{Q}^{\\top})(\\mathbf{Q}\\mathbf{s}) = \\tfrac{1}{2}\\mathbf{s}^{\\top}\\mathbf{Q}^{\\top}\\mathbf{Q}\\mathbf{\\Lambda}\\mathbf{Q}^{\\top}\\mathbf{Q}\\mathbf{s} = \\tfrac{1}{2}\\mathbf{s}^{\\top}\\mathbf{\\Lambda}\\mathbf{s}$。\n因此，原问题在变量 $\\mathbf{s}$ 中等价于：\n$$ \\text{minimize} \\quad \\hat{q}(\\mathbf{s}) = \\hat{\\mathbf{g}}^{\\top}\\mathbf{s} + \\tfrac{1}{2}\\mathbf{s}^{\\top}\\mathbf{\\Lambda}\\mathbf{s} \\quad \\text{subject to} \\quad \\|\\mathbf{s}\\|_{2} \\leq \\Delta $$\n代入具体数值：\n$$ \\hat{q}(s_1, s_2) = \\begin{pmatrix} 0  3 \\end{pmatrix} \\begin{pmatrix} s_1 \\\\ s_2 \\end{pmatrix} + \\tfrac{1}{2} \\begin{pmatrix} s_1  s_2 \\end{pmatrix} \\begin{pmatrix} -2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} s_1 \\\\ s_2 \\end{pmatrix} = 3s_2 - s_1^2 + \\tfrac{1}{2}s_2^2 $$\n约束条件为 $s_1^2 + s_2^2 \\leq 2^2 = 4$。\n\n目标函数中的 $-s_1^2$ 项对应于负特征值 $\\lambda_1 = -2$。该项表明，随着 $|s_1|$ 的增加，目标函数值会减小。因此，$\\hat{q}(\\mathbf{s})$ 的无约束最小值不存在，其在信赖域内的最小值必然在边界上取得，即 $\\|\\mathbf{s}\\|_{2} = \\Delta = 2$。\n在边界上，我们有 $s_1^2 + s_2^2 = 4$，即 $s_1^2 = 4 - s_2^2$。我们将此代入目标函数，将问题转化为一个关于 $s_2$ 的一维最小化问题，其中 $s_2 \\in [-2, 2]$。\n$$ \\hat{q}(s_2) = 3s_2 - (4-s_2^2) + \\tfrac{1}{2}s_2^2 = \\tfrac{3}{2}s_2^2 + 3s_2 - 4 $$\n这是一个开口向上的关于 $s_2$ 的抛物线。其全局最小值出现在顶点处。我们通过求导并设为零来找到顶点：\n$$ \\frac{d\\hat{q}}{ds_2} = 3s_2 + 3 = 0 \\implies s_2 = -1 $$\n由于 $s_2 = -1$ 位于区间 $[-2, 2]$ 内，这确实是 $s_2$ 的最优解。\n对应的 $s_1$ 的值为：\n$$ s_1^2 = 4 - s_2^2 = 4 - (-1)^2 = 3 \\implies s_1 = \\pm\\sqrt{3} $$\n因此，在 $\\mathbf{s}$ 空间中存在两个最优解：$\\mathbf{s}^{\\star} = \\begin{pmatrix} \\sqrt{3} \\\\ -1 \\end{pmatrix}$ 和 $\\mathbf{s}^{\\star} = \\begin{pmatrix} -\\sqrt{3} \\\\ -1 \\end{pmatrix}$。\n\n负曲率方向是对应于负特征值 $\\lambda_1 = -2$ 的特征向量，即 $\\mathbf{q}_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。解在 $\\mathbf{s}$ 空间中的第一分量 $s_1$ 对应于沿该方向的步长。由于梯度在负曲率方向上的分量为零（$\\hat{g}_1 = 0$，这被称为“困难情况”），为了最小化目标函数，算法必须沿此方向移动，直到达到信赖域边界。解 $|s_1| = \\sqrt{3}$ 表明，最优解充分利用了负曲率来降低目标函数值。\n\n最后，我们计算精确的最小目标值 $q(\\mathbf{p}^{\\star})$，它等于 $\\hat{q}(\\mathbf{s}^{\\star})$。使用 $s_1 = \\sqrt{3}$ 和 $s_2 = -1$：\n$$ q(\\mathbf{p}^{\\star}) = \\hat{q}(\\sqrt{3}, -1) = 3(-1) - (\\sqrt{3})^2 + \\tfrac{1}{2}(-1)^2 = -3 - 3 + \\tfrac{1}{2} = -6 + \\tfrac{1}{2} = -\\frac{11}{2} $$\n或者，代入一维函数 $\\hat{q}(s_2)$：\n$$ q(\\mathbf{p}^{\\star}) = \\hat{q}(s_2=-1) = \\tfrac{3}{2}(-1)^2 + 3(-1) - 4 = \\tfrac{3}{2} - 3 - 4 = \\tfrac{3}{2} - 7 = \\tfrac{3-14}{2} = -\\tfrac{11}{2} $$\n最小目标值为 $-5.5$ 或 $-\\frac{11}{2}$。", "answer": "$$\\boxed{-\\frac{11}{2}}$$", "id": "3163285"}, {"introduction": "在约束优化中，正定性的概念变得更加微妙。一个函数可能在整个空间上不是凸的，但沿着约束允许的方向却是凸的。本练习将指导你构造一个特定的二次型，它在一个给定的子空间上是半正定的（凸的），但在其他地方是不定的（非凸的），从而阐释约束问题中二阶最优性条件背后的基本原理 [@problem_id:3163360]。", "problem": "考虑 $\\mathbb{R}^{3}$ 上的二次函数 $f(x) = \\frac{1}{2} x^{\\top} Q x$，其中 $Q$ 是一个实对称矩阵。在带等式约束的约束优化中，沿约束流形的凸性由二次型 $x^{\\top} Q x$ 在可行方向的切子空间上的符号决定。具体来说，如果一个约束流形是线性的，并由 $S = \\{x \\in \\mathbb{R}^{3} : u^{\\top} x = 0\\}$ 给出（对于一个非零向量 $u \\in \\mathbb{R}^{3}$），那么切子空间就是 $S$ 本身。一个基本的刻画是：函数 $f$ 沿该流形是凸的，当且仅当对于所有 $x \\in S$ 都有 $x^{\\top} Q x \\geq 0$；并且如果存在一个 $y \\notin S$ 使得 $y^{\\top} Q y  0$，则函数 $f$ 在流形之外是非凸的。\n\n令 $u = (1, 2, -1)^{\\top}$ 且 $S = \\{x \\in \\mathbb{R}^{3} : u^{\\top} x = 0\\}$。定义到 $S$ 上的正交投影算子为 $\\Pi_{S} = I - \\frac{u u^{\\top}}{\\|u\\|^{2}}$，其中 $I$ 是 $3 \\times 3$ 的单位矩阵，$\\|u\\|$ 是 $u$ 的欧几里得范数。考虑由标量参数 $\\gamma  0$ 定义的单参数对称矩阵族\n$$\nQ(\\gamma) = \\Pi_{S} - \\gamma \\, u u^{\\top}\n$$\n仅使用关于二次型、对称矩阵和正交投影算子的核心定义和熟知事实，从第一性原理推导出：对于所有 $x \\in S$，有 $x^{\\top} Q(\\gamma) x \\geq 0$；同时对于某个 $x \\notin S$，有 $x^{\\top} Q(\\gamma) x  0$。然后，将此结果解释为函数 $f$ 沿约束流形 $S$ 的凸性以及在流形之外的非凸性。最后，确定唯一的 $\\gamma$ 值，使得二次型在 $S$ 的法线方向上的单位向量（即 $x = \\frac{u}{\\|u\\|}$）处的值满足\n$$\nx^{\\top} Q(\\gamma) x = -1.\n$$\n\n你的最终答案应该是 $\\gamma$ 的精确值，表示为一个单独的数字。无需四舍五入。", "solution": "该问题要求我们分析一个特定构造的对称矩阵 $Q(\\gamma)$ 的定性，并确定参数 $\\gamma$ 的一个特定值。分析分为三个主要部分。\n\n**第一部分：二次型在子空间 $S$ 上的行为**\n\n我们首先需要证明对于所有 $x \\in S$，都有 $x^{\\top} Q(\\gamma) x \\geq 0$。子空间 $S$ 被定义为所有与向量 $u$ 正交的向量 $x$ 的集合，即满足 $u^{\\top} x = 0$。\n\n对于任意 $x \\in S$，我们计算二次型 $x^{\\top} Q(\\gamma) x$：\n$$\nx^{\\top} Q(\\gamma) x = x^{\\top} (\\Pi_{S} - \\gamma u u^{\\top}) x = x^{\\top} \\Pi_{S} x - \\gamma x^{\\top} (u u^{\\top}) x\n$$\n我们分别分析上式中的两项。\n对于第二项，由于 $x \\in S$，我们有 $u^{\\top} x = 0$。因此，$x^{\\top} u = (u^{\\top} x)^{\\top} = 0$。所以，该项为 $\\gamma (x^{\\top} u)(u^{\\top} x) = \\gamma (0)(0) = 0$。\n对于第一项，$\\Pi_S$ 是到子空间 $S$ 上的正交投影算子。对于任何已经在 $S$ 中的向量 $x$，其自身的投影就是它本身，即 $\\Pi_S x = x$。因此，第一项为 $x^{\\top} \\Pi_{S} x = x^{\\top} x = \\|x\\|^2$。\n\n结合两项结果，对于任何 $x \\in S$，我们得到：\n$$\nx^{\\top} Q(\\gamma) x = \\|x\\|^2 - 0 = \\|x\\|^2\n$$\n由于任意实向量的范数平方总是非负的（$\\|x\\|^2 \\geq 0$），这证实了 $x^{\\top} Q(\\gamma) x$ 在子空间 $S$ 上是半正定的。这在优化理论中意味着函数 $f(x)$ 在约束流形 $S$ 上是凸的。\n\n**第二部分：二次型在子空间 $S$ 之外的行为**\n\n接下来，我们要证明存在一个向量 $y \\notin S$，使得 $y^{\\top} Q(\\gamma) y  0$。一个不在 $S$ 中的自然选择是向量 $u$ 本身，因为它定义了 $S$ 的法线方向。由于 $u \\neq 0$，我们有 $u^{\\top} u = \\|u\\|^2 > 0$，因此 $u \\notin S$。\n\n我们计算 $y=u$ 时的二次型：\n$$\nu^{\\top} Q(\\gamma) u = u^{\\top} (\\Pi_{S} - \\gamma u u^{\\top}) u = u^{\\top} \\Pi_{S} u - \\gamma u^{\\top} (u u^{\\top}) u\n$$\n由于向量 $u$ 与其正交子空间 $S$ 中的所有向量都正交，它在 $S$ 上的投影为零向量，即 $\\Pi_S u = 0$。因此，第一项 $u^{\\top} \\Pi_S u = 0$。\n第二项为 $\\gamma (u^{\\top} u) (u^{\\top} u) = \\gamma \\|u\\|^4$。\n所以，二次型的值为：\n$$\nu^{\\top} Q(\\gamma) u = 0 - \\gamma \\|u\\|^4 = -\\gamma \\|u\\|^4\n$$\n因为题目给定 $\\gamma > 0$ 且 $\\|u\\|^4 > 0$，所以 $-\\gamma \\|u\\|^4  0$。这表明 $Q(\\gamma)$ 在整个 $\\mathbb{R}^3$ 空间上是不定的，对应于函数 $f(x)$ 在流形 $S$ 之外是非凸的。\n\n**第三部分：确定参数 $\\gamma$**\n\n最后，我们求解满足 $x^{\\top} Q(\\gamma) x = -1$ 的 $\\gamma$ 值，其中 $x = \\frac{u}{\\|u\\|}$ 是 $S$ 法线方向上的单位向量。\n我们将 $x = \\frac{u}{\\|u\\|}$ 代入二次型表达式中：\n$$\nx^{\\top} Q(\\gamma) x = \\left(\\frac{u}{\\|u\\|}\\right)^{\\top} Q(\\gamma) \\left(\\frac{u}{\\|u\\|}\\right)\n$$\n利用我们在第二部分为向量 $u$ 推导的结果，我们可以直接得到：\n$$\n\\left(\\frac{u}{\\|u\\|}\\right)^{\\top} Q(\\gamma) \\left(\\frac{u}{\\|u\\|}\\right) = \\frac{1}{\\|u\\|^2} u^{\\top} Q(\\gamma) u = \\frac{1}{\\|u\\|^2} (-\\gamma \\|u\\|^4) = -\\gamma \\|u\\|^2\n$$\n根据题目要求，我们设置这个表达式等于 -1：\n$$\n-\\gamma \\|u\\|^2 = -1 \\implies \\gamma = \\frac{1}{\\|u\\|^2}\n$$\n现在，我们计算给定向量 $u = (1, 2, -1)^{\\top}$ 的范数平方：\n$$\n\\|u\\|^2 = 1^2 + 2^2 + (-1)^2 = 1 + 4 + 1 = 6\n$$\n将这个值代入 $\\gamma$ 的表达式，我们得到：\n$$\n\\gamma = \\frac{1}{6}\n$$\n这是满足条件的唯一 $\\gamma$ 值。", "answer": "$$\n\\boxed{\\frac{1}{6}}\n$$", "id": "3163360"}]}