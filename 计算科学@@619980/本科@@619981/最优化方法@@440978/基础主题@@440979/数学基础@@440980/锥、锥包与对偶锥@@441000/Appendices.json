{"hands_on_practices": [{"introduction": "理论学习之后，一个自然而然的问题是：我们如何实际判断一个给定的向量是否属于由一组向量生成的锥包？这个基本问题不仅是检验理解的试金石，也构成了许多优化算法的核心。本练习 [@problem_id:3110862] 将引导你将锥包的定义转化为一个线性规划（LP）可行性问题，从而提供一种算法上的检验方法。更重要的是，它将揭示当一个向量不属于锥包时，线性规划的对偶性如何为我们提供一个无可辩驳的证明——一个分离超平面。", "problem": "给定实向量空间中的一个有限射线族，由向量 $\\{r_i\\}_{i=1}^m \\subset \\mathbb{R}^n$ 表示。这些射线的锥包（也称为有限生成锥）根据基本原理定义为集合\n$$\n\\operatorname{cone}(\\{r_i\\}_{i=1}^m) \\;=\\; \\left\\{ \\sum_{i=1}^m \\lambda_i r_i \\;:\\; \\lambda_i \\in \\mathbb{R}_{\\ge 0} \\right\\}.\n$$\n给定一个目标向量 $y \\in \\mathbb{R}^n$，您的任务是算法性地判断是否 $y \\in \\operatorname{cone}(\\{r_i\\})$，并在 $y \\notin \\operatorname{cone}(\\{r_i\\})$ 时解释一个对偶证书。\n\n基本依据和要求：\n- 使用锥包的核心定义和标准的线性规划可行性观点：成员关系 $y \\in \\operatorname{cone}(\\{r_i\\})$ 等价于存在非负系数 $\\lambda \\in \\mathbb{R}^m_{\\ge 0}$ 满足线性等式 $\\sum_{i=1}^m \\lambda_i r_i = y$。\n- 将此问题构建为一个以 $\\lambda \\in \\mathbb{R}^m$ 为决策变量的线性规划：最小化 $0$，约束条件为 $R \\lambda = y$，$\\lambda \\ge 0$，其中 $R \\in \\mathbb{R}^{n \\times m}$ 的列为 $r_1, \\dots, r_m$。\n- 如果上述问题不可行，则使用基于分离超平面定理或 Farkas 引理的对偶分离观点，找到一个分离向量 $w \\in \\mathbb{R}^n$ 满足对所有 $i$ 都有 $w^\\top r_i \\ge 0$ 且 $w^\\top y  0$。为了通过线性规划获得一个具体的证书，求解一个关于 $w$ 的可行性线性规划：\n  - 找到 $w \\in \\mathbb{R}^n$ 使得 $R^\\top w \\le 0$ 且 $y^\\top w \\ge 1$；然后令 $w_{\\mathrm{sep}} := -w$。这确保了对所有 $i$ 都有 $w_{\\mathrm{sep}}^\\top r_i \\ge 0$ 且 $w_{\\mathrm{sep}}^\\top y \\le -1  0$，这是一个严格分离超平面证书。\n\n您的程序必须使用线性规划实现此方法，并为每个测试用例产生以下输出：\n- 一个布尔值，指示 $y \\in \\operatorname{cone}(\\{r_i\\})$ 是否成立。\n- 如果答案为真，提供一个可行的系数向量 $\\lambda \\in \\mathbb{R}^m_{\\ge 0}$，并报告欧几里得残差范数 $\\lVert R \\lambda - y \\rVert_2$。\n- 如果答案为假，提供一个分离向量 $w_{\\mathrm{sep}} \\in \\mathbb{R}^n$，并报告在生成元上的最小间隔 $\\min_i \\{ w_{\\mathrm{sep}}^\\top r_i \\}$ 以及值 $w_{\\mathrm{sep}}^\\top y$。\n\n测试套件：\n在 $\\mathbb{R}^2$ 中进行操作，并使用以下五个测试用例。每个用例包含一个射线列表和一个目标向量 $y$。\n1. 射线 $\\{(1,0), (0,1)\\}$，目标 $y = (1,2)$。\n2. 射线 $\\{(1,0), (0,1)\\}$，目标 $y = (-1,1)$。\n3. 射线 $\\{(1,0), (0,1)\\}$，目标 $y = (0,0)$。\n4. 射线 $\\{(1,1), (1,-1)\\}$，目标 $y = (2,0)$。\n5. 射线 $\\{(1,1), (1,-1)\\}$，目标 $y = (1,1.2)$。\n\n所有向量都应被解释为 $\\mathbb{R}^2$ 中的元素，没有物理单位。不出现角度，也不使用百分比。\n\n程序输出规范：\n- 对于每个测试用例，输出一个具有以下结构的列表：\n  - 用例结果格式：$[\\text{is\\_member}, \\lambda\\_\\text{list}, w\\_\\text{sep\\_list}, \\text{verification\\_list}]$,\n    - 如果 $\\text{is\\_member}$ 为真，则 $\\lambda\\_\\text{list}$ 是系数 $\\lambda_i$ 的列表，$w\\_\\text{sep\\_list}$ 是空列表，而 $\\text{verification\\_list}$ 包含一个等于 $\\lVert R \\lambda - y \\rVert_2$ 的浮点数。\n    - 如果 $\\text{is\\_member}$ 为假，则 $\\lambda\\_\\text{list}$ 是空列表，$w\\_\\text{sep\\_list}$ 是一个分离向量 $w_{\\mathrm{sep}}$，而 $\\text{verification\\_list}$ 包含两个浮点数：$\\min_i \\{ w_{\\mathrm{sep}}^\\top r_i \\}$ 和 $w_{\\mathrm{sep}}^\\top y$。\n- 您的程序应生成单行输出，其中包含所有五个测试用例的结果，形式为用方括号括起来的逗号分隔列表。具体来说，输出必须是以下形式的单行：\n  $$\n  [\\text{case1\\_result},\\text{case2\\_result},\\text{case3\\_result},\\text{case4\\_result},\\text{case5\\_result}]\n  $$\n其中每个 $\\text{caseX\\_result}$ 本身就是如上所述的列表。\n\n覆盖和边界情况设计：\n- 用例1是一个典型的成员关系实例。\n- 用例2是一个典型的非成员关系实例，具有清晰的轴对齐分离器。\n- 用例3是一个边界情况（$y = 0$）。\n- 用例4是在一个非象限锥中的成员关系。\n- 用例5是在一个非象限锥中的非成员关系，具有一个非平凡的分离超平面。\n\n您的解决方案必须仅依赖于锥包的基本定义和带非负性约束的线性等式可行性，并且必须使用线性规划获得证书。不允许外部输入；所有数据都如上所示硬编码。最终的数值输出应四舍五入到合理的小数位数，以确保可读性，同时保持符号和零与非零区别的正确性。", "solution": "该问题要求一个算法程序，以确定给定向量 $y \\in \\mathbb{R}^n$ 是否位于有限向量集 $\\{r_i\\}_{i=1}^m \\subset \\mathbb{R}^n$ 的锥包内。锥包，记为 $\\operatorname{cone}(\\{r_i\\})$，是生成向量的所有非负线性组合的集合：\n$$\n\\operatorname{cone}(\\{r_i\\}_{i=1}^m) \\;=\\; \\left\\{ \\sum_{i=1}^m \\lambda_i r_i \\;:\\; \\lambda_i \\in \\mathbb{R}_{\\ge 0} \\right\\}\n$$\n一个向量 $y$ 在此锥中，当且仅当存在系数 $\\lambda = (\\lambda_1, \\dots, \\lambda_m)^\\top$ 使得：\n$$\n\\sum_{i=1}^m \\lambda_i r_i = y, \\quad \\text{对所有 } i=1, \\dots, m \\text{ 都有 } \\lambda_i \\ge 0\n$$\n这可以表示为矩阵形式 $R\\lambda = y$，其中 $R \\in \\mathbb{R}^{n \\times m}$ 是以向量 $r_i$ 为列的矩阵。因此，成员关系的条件是存在一个带有变量非负性约束的线性方程组的解。\n\n这个可行性问题可以表述为一个线性规划（LP）。具体来说，我们寻求找到一个满足约束条件的向量 $\\lambda \\in \\mathbb{R}^m$，对于可行性问题，目标函数的选择是无关紧要的。一个标准的选择是最小化一个零目标函数，$c^\\top \\lambda = 0^\\top \\lambda = 0$：\n\n**原始LP（成员关系问题）：**\n$$\n\\begin{aligned}\n\\text{最小化} \\quad  0 \\\\\n\\text{约束条件} \\quad  R \\lambda = y \\\\\n \\lambda \\ge 0\n\\end{aligned}\n$$\n如果这个LP有可行解，则存在这样的 $\\lambda$，并且 $y \\in \\operatorname{cone}(\\{r_i\\})$。向量 $\\lambda$ 本身可作为成员关系的证书。此证书的质量可以通过计算欧几里得残差范数 $\\lVert R \\lambda - y \\rVert_2$ 来检验，对于一个数值精确的解，该范数应接近于零。\n\n如果原始LP不可行，则不存在这样的非负 $\\lambda$，并且 $y \\notin \\operatorname{cone}(\\{r_i\\})$。根据线性规划的对偶性原理，特别是 Farkas 引理（一个择一定理），原始系统的不可行性意味着相关对偶系统的可行性。这引出了分离超平面的概念。由法向量 $w_{\\mathrm{sep}} \\in \\mathbb{R}^n$ 定义的超平面将 $y$ 与锥分离，如果 $w_{\\mathrm{sep}}^\\top y  0$ 且对所有 $z \\in \\operatorname{cone}(\\{r_i\\})$ 都有 $w_{\\mathrm{sep}}^\\top z \\ge 0$。为使后一个条件成立，只需对所有生成向量 $r_i$ 都有 $w_{\\mathrm{sep}}^\\top r_i \\ge 0$ 即可。\n\n问题陈述提供了一个特定的LP公式来找到这样一个分离向量。我们寻求一个中间向量 $w \\in \\mathbb{R}^n$ 满足一组不等式，并从中导出 $w_{\\mathrm{sep}}$。\n\n**分离LP（非成员关系证书）：**\n$$\n\\begin{aligned}\n\\text{找到} \\quad  w \\in \\mathbb{R}^n \\\\\n\\text{约束条件} \\quad  R^\\top w \\le 0 \\\\\n y^\\top w \\ge 1\n\\end{aligned}\n$$\n这也是一个可行性LP。我们可以将约束 $y^\\top w \\ge 1$ 重写为 $(-y)^\\top w \\le -1$ 以适应标准形式 $A_w w \\le b_w$。如果该系统存在解 $w$，我们定义分离向量为 $w_{\\mathrm{sep}} := -w$。让我们验证这个 $w_{\\mathrm{sep}}$ 是否具有所需的性质：\n1. 对于每个生成元 $r_i$，约束为 $r_i^\\top w \\le 0$。那么 $w_{\\mathrm{sep}}^\\top r_i = (-w)^\\top r_i = -(w^\\top r_i) \\ge 0$。这证实了 $w_{\\mathrm{sep}}$ 与所有生成元，从而与锥中的所有向量，形成非负内积。\n2. 约束 $y^\\top w \\ge 1$ 意味着 $w_{\\mathrm{sep}}^\\top y = (-w)^\\top y = -(y^\\top w) \\le -1$。这是一个严格的负值，证实了 $y$ 位于超平面相对于锥的另一侧。\n\n总体算法如下：\n1. 为系数 $\\lambda$ 构建并尝试求解原始LP。\n2. 如果原始LP可行（求解成功），则断定 $y$ 在锥内。解向量 $\\lambda$ 即为成员关系证书。\n3. 如果原始LP不可行，则断定 $y$ 不在锥内。为向量 $w$ 构建并求解分离LP。导出的向量 $w_{\\mathrm{sep}} = -w$ 即为非成员关系证书。\n\n此过程将使用数值线性规划求解器为每个测试用例实现。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve_case(rays, y):\n    \"\"\"\n    Determines if a vector y is in the conic hull of a set of rays.\n\n    Args:\n        rays (list of tuples): A list of vectors representing the rays.\n        y (np.ndarray): The target vector.\n\n    Returns:\n        list: A result list in the format specified by the problem.\n    \"\"\"\n    R = np.array(rays).T\n    if R.ndim == 1: # Handle case of a single ray (1D vector)\n        R = R.reshape(-1, 1)\n        \n    n_dim, m_rays = R.shape\n\n    # --- Primal LP (Membership Test) ---\n    # Try to find lambda = 0 such that R @ lambda = y.\n    # min 0 subject to R @ lambda = y, lambda = 0\n    c_primal = np.zeros(m_rays)\n    # The bounds argument enforces lambda = 0 by default when set to (0, None).\n    res_primal = linprog(\n        c=c_primal,\n        A_eq=R,\n        b_eq=y,\n        bounds=(0, None),\n        method='highs'\n    )\n\n    if res_primal.success:\n        # y is in the cone.\n        lambda_coeffs = res_primal.x\n        residual = np.linalg.norm(R @ lambda_coeffs - y)\n        return [\n            True,\n            list(np.round(lambda_coeffs, 5)),\n            [],\n            [round(residual, 5)]\n        ]\n    else:\n        # y is not in the cone. Find a separating hyperplane.\n        # --- Separation LP (Non-Membership Certificate) ---\n        # Find w such that R.T @ w = 0 and y.T @ w = 1.\n        # We rewrite y.T @ w = 1 as -y.T @ w = -1.\n        # This is equivalent to min 0 subject to A_ub @ w = b_ub.\n        c_dual = np.zeros(n_dim)\n        \n        # A_ub has shape (m_rays + 1, n_dim)\n        A_ub_dual = np.vstack([R.T, -y.reshape(1, -1)])\n        \n        # b_ub has shape (m_rays + 1,)\n        b_ub_dual = np.zeros(m_rays + 1)\n        b_ub_dual[-1] = -1.0\n        \n        res_dual = linprog(\n            c=c_dual,\n            A_ub=A_ub_dual,\n            b_ub=b_ub_dual,\n            bounds=(None, None), # w is unbounded\n            method='highs'\n        )\n\n        if res_dual.success:\n            w = res_dual.x\n            w_sep = -w\n            \n            # verification_list: [min_margin, w_sep_dot_y]\n            min_margin = np.min(w_sep @ R)\n            w_sep_dot_y = w_sep @ y\n            \n            return [\n                False,\n                [],\n                list(np.round(w_sep, 5)),\n                [round(min_margin, 5), round(w_sep_dot_y, 5)]\n            ]\n        else:\n            # According to Farkas' Lemma, this case should not be reached\n            # if the primal is infeasible. This indicates a numerical issue.\n            return [\"Error: Both primal and dual LPs are infeasible.\"]\n\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # 1. Rays {(1,0), (0,1)}, target y = (1,2) - In cone\n        ([(1, 0), (0, 1)], (1, 2)),\n        # 2. Rays {(1,0), (0,1)}, target y = (-1,1) - Not in cone\n        ([(1, 0), (0, 1)], (-1, 1)),\n        # 3. Rays {(1,0), (0,1)}, target y = (0,0) - In cone (boundary)\n        ([(1, 0), (0, 1)], (0, 0)),\n        # 4. Rays {(1,1), (1,-1)}, target y = (2,0) - In cone\n        ([(1, 1), (1, -1)], (2, 0)),\n        # 5. Rays {(1,1), (1,-1)}, target y = (1,1.2) - Not in cone\n        ([(1, 1), (1, -1)], (1, 1.2)),\n    ]\n\n    results = []\n    for rays, y in test_cases:\n        y_vec = np.array(y)\n        result = solve_case(rays, y_vec)\n        # The string representation of a Python list matches the required output format for a single case.\n        results.append(str(result))\n\n    # Join the string representations of each case result with commas and enclose in brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3110862"}, {"introduction": "上一个练习确立了分离超平面作为非成员资格证明的存在性。然而，对于一个给定的问题，可能存在无数个这样的分离超平面，我们能否找到一个“最好”的证明呢？本练习 [@problem_id:3110909] 探讨了这一深刻问题，引导我们去寻找具有最小欧几里得范数的“最有效”分离证书。这个过程巧妙地将问题从线性规划（LP）的可行性领域，提升到了更高级的二阶锥规划（SOCP），展示了优化理论中不同工具之间的优美联系。", "problem": "设 $a_{1} \\in \\mathbb{R}^{2}$ 和 $a_{2} \\in \\mathbb{R}^{2}$ 为生成元 $a_{1} = \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$ 和 $a_{2} = \\begin{pmatrix}2 \\\\ 1\\end{pmatrix}$，并设方向为 $d = \\begin{pmatrix}1 \\\\ -1\\end{pmatrix}$。仅从锥包和对偶锥的定义出发，通过构建一个线性规划 (LP) 可行性问题，推导一种方法来判断 $d$ 是否属于 $\\{a_{1}, a_{2}\\}$ 的锥包，并将对偶问题解释为一个分离超平面证书。然后，当 $d$ 不在锥包中时，通过构建一个在适当归一化下最小化证书欧几里得范数的二阶锥规划 (SOCP)，来获得一个具有最小欧几里得范数的非隶属证书。最后，对给定的数据求解得到的 SOCP，并以一个精确数值的形式报告证书的最小欧几里得范数值。如果需要任何数值近似，则四舍五入到四位有效数字；否则，提供精确表达式。", "solution": "该问题要求进行一个涉及锥包、线性规划、对偶性和二阶锥规划的多步分析。我们将从基本定义开始，依次处理每个部分。\n\n首先，我们验证向量 $d$ 是否属于集合 $\\{a_1, a_2\\}$ 的锥包。在 $\\mathbb{R}^n$ 中，一组向量 $\\{a_1, a_2, \\dots, a_k\\}$ 的锥包定义为这些向量的所有非负线性组合的集合：\n$$ \\text{cone}\\{a_1, \\dots, a_k\\} = \\left\\{ \\sum_{i=1}^k \\lambda_i a_i \\mid \\lambda_i \\ge 0 \\text{ for all } i=1, \\dots, k \\right\\} $$\n对于给定的向量 $a_1 = \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$ 和 $a_2 = \\begin{pmatrix}2 \\\\ 1\\end{pmatrix}$，向量 $d = \\begin{pmatrix}1 \\\\ -1\\end{pmatrix}$ 属于 $\\text{cone}\\{a_1, a_2\\}$ 当且仅当存在非负标量 $\\lambda_1 \\ge 0$ 和 $\\lambda_2 \\ge 0$ 使得：\n$$ \\lambda_1 a_1 + \\lambda_2 a_2 = d $$\n代入向量分量，我们得到一个线性方程组：\n$$ \\lambda_1 \\begin{pmatrix}1 \\\\ 1\\end{pmatrix} + \\lambda_2 \\begin{pmatrix}2 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}1 \\\\ -1\\end{pmatrix} $$\n这对应于以下方程组：\n\\begin{align*} 1\\lambda_1 + 2\\lambda_2 = 1 \\\\ 1\\lambda_1 + 1\\lambda_2 = -1 \\end{align*}\n这是一个标准的线性系统。用第一个方程减去第二个方程，得到 $\\lambda_2 = 1 - (-1) = 2$。将 $\\lambda_2 = 2$ 代入第二个方程，得到 $\\lambda_1 + 2 = -1$，这意味着 $\\lambda_1 = -3$。\n该线性系统的唯一解是 $(\\lambda_1, \\lambda_2) = (-3, 2)$。然而，要使 $d$ 处于锥包中，系数必须是非负的。由于 $\\lambda_1 = -3  0$，该条件不满足。因此，$d \\notin \\text{cone}\\{a_1, a_2\\}$。\n\n这个决策过程可以构建为一个线性规划 (LP) 可行性问题。设 $A = \\begin{pmatrix}a_1  a_2\\end{pmatrix} = \\begin{pmatrix}1  2 \\\\ 1  1\\end{pmatrix}$ 且 $\\lambda = \\begin{pmatrix}\\lambda_1 \\\\ \\lambda_2\\end{pmatrix}$。问题是判断以下系统是否有解：\n$$ A\\lambda = d, \\quad \\lambda \\ge 0 $$\n这是原始LP的可行性问题。该系统不可行的证书由对偶问题提供，这与分离超平面的概念有关。\n\n根据择一定理（法卡斯引理的一种形式），系统 $A\\lambda = d, \\lambda \\ge 0$ 不可行，当且仅当存在一个向量 $y \\in \\mathbb{R}^2$ 使得：\n$$ A^T y \\ge 0 \\quad \\text{and} \\quad d^T y  0 $$\n这样的向量 $y$ 定义了一个超平面 $\\{x \\in \\mathbb{R}^2 \\mid y^T x = 0\\}$，它将向量 $d$ 与锥包 $\\text{cone}\\{a_1, a_2\\}$ 分离开。条件 $A^T y \\ge 0$ 等价于不等式对 $a_1^T y \\ge 0$ 和 $a_2^T y \\ge 0$。这意味着锥的所有生成元，以及因此整个锥，都位于闭半空间 $\\{x \\mid y^T x \\ge 0\\}$ 中。条件 $d^T y  0$ 意味着 $d$ 严格位于相对的开半空间 $\\{x \\mid y^T x  0\\}$ 中。因此，向量 $y$ 是 $d$ 的一个非隶属证书。\n\n问题接着要求找到具有最小欧几里得范数 $\\|y\\|_2 = \\sqrt{y_1^2 + y_2^2}$ 的证书 $y$。我们需要求解以下优化问题：\n$$ \\min_{y \\in \\mathbb{R}^2} \\|y\\|_2 \\quad \\text{subject to} \\quad A^T y \\ge 0, \\ d^T y  0 $$\n目标函数是齐次的（即 $\\|\\alpha y\\|_2 = |\\alpha| \\|y\\|_2$），且约束集是一个锥。如果 $y$ 是一个可行解，那么对于任何 $\\alpha > 0$，$\\alpha y$ 也是可行解。通过取 $\\alpha \\to 0^+$，目标值可以任意接近于 $0$。然而，$y=0$ 不是一个可行点，因为 $d^T 0 = 0$，不满足 $d^T y  0$。为了得到一个具有唯一非零解的适定问题，我们必须引入一个归一化。一个标准的选择是通过设置 $d^T y = -1$ 来固定分离度。这将严格不等式转化为一个等式约束。优化问题变为：\n$$ \\min_{y \\in \\mathbb{R}^2} \\|y\\|_2 \\quad \\text{subject to} \\quad A^T y \\ge 0, \\ d^T y = -1 $$\n最小化 $\\|y\\|_2$ 等价于最小化 $\\|y\\|_2^2$。后者是一个二次规划 (QP)。为了将其构建为一个二阶锥规划 (SOCP)，我们引入一个辅助标量变量 $t$ 并将问题表述为：\n$$ \\min_{y \\in \\mathbb{R}^2, t \\in \\mathbb{R}} t \\quad \\text{subject to} \\quad \\|y\\|_2 \\le t, \\ A^T y \\ge 0, \\ d^T y = -1 $$\n这是一个标准的SOCP形式。我们现在对给定的数据求解此问题。约束条件是：\n1. $a_1^T y = y_1 + y_2 \\ge 0$\n2. $a_2^T y = 2y_1 + y_2 \\ge 0$\n3. $d^T y = y_1 - y_2 = -1$\n\n从等式约束 (3)，我们可以用 $y_1$ 表示 $y_2$：$y_2 = y_1 + 1$。我们将其代入不等式约束中：\n1. $y_1 + (y_1 + 1) \\ge 0 \\implies 2y_1 + 1 \\ge 0 \\implies y_1 \\ge -\\frac{1}{2}$\n2. $2y_1 + (y_1 + 1) \\ge 0 \\implies 3y_1 + 1 \\ge 0 \\implies y_1 \\ge -\\frac{1}{3}$\n两个不等式都必须成立，因此我们取更严格的那个：$y_1 \\ge -\\frac{1}{3}$。\n\n现在我们用 $y_1$ 来表示目标函数。我们想要最小化 $\\|y\\|_2^2 = y_1^2 + y_2^2$：\n$$ f(y_1) = y_1^2 + (y_1 + 1)^2 = y_1^2 + (y_1^2 + 2y_1 + 1) = 2y_1^2 + 2y_1 + 1 $$\n我们需要找到二次函数 $f(y_1)$ 在约束 $y_1 \\ge -\\frac{1}{3}$ 下的最小值。函数 $f(y_1)$ 是一个开口向上的抛物线。其无约束最小值出现在导数为零的顶点处：\n$$ f'(y_1) = 4y_1 + 2 = 0 \\implies y_1 = -\\frac{1}{2} $$\n抛物线的顶点在 $y_1 = -\\frac{1}{2}$。该点不在可行域 $[-\\frac{1}{3}, \\infty)$ 内。由于顶点位于可行区间的左侧，函数 $f(y_1)$ 在此区间上是严格递增的。因此，$f(y_1)$ 在可行集上的最小值出现在最左边的点，即 $y_1 = -\\frac{1}{3}$。\n\n$y_1$ 的最优值是 $y_1^* = -\\frac{1}{3}$。$y_2$ 相应的值是 $y_2^* = y_1^* + 1 = -\\frac{1}{3} + 1 = \\frac{2}{3}$。\n最优证书向量是 $y^* = \\begin{pmatrix}-1/3 \\\\ 2/3\\end{pmatrix}$。\n\n问题要求此证书的最小欧几里得范数。我们计算 $y^*$ 的范数：\n$$ \\|y^*\\|_2 = \\sqrt{\\left(-\\frac{1}{3}\\right)^2 + \\left(\\frac{2}{3}\\right)^2} = \\sqrt{\\frac{1}{9} + \\frac{4}{9}} = \\sqrt{\\frac{5}{9}} = \\frac{\\sqrt{5}}{3} $$\n这是一个精确值，所以不需要数值近似。", "answer": "$$ \\boxed{\\frac{\\sqrt{5}}{3}} $$", "id": "3110909"}, {"introduction": "到目前为止，我们的讨论主要集中在由有限个向量生成的多面体锥。然而，锥的概念远比这更广泛，它包含了像半正定矩阵锥这样具有“弯曲”边界的非多面体锥。本练习 [@problem_id:3110877] 将带领我们把成员资格检验的思想推广到这些更高级的锥上。通过对比简单的非负象限锥和更为复杂的半正定锥，你将发现，虽然分离的基本原理是普适的，但其具体实现却依赖于锥的独特几何结构，这突显了对偶锥概念的强大适应性与深度。", "problem": "考虑一个闭凸锥 $K \\subset \\mathbb{R}^{n}$，其对偶锥为 $K^{*} = \\{y \\in \\mathbb{R}^{n} \\mid \\langle y, x \\rangle \\ge 0 \\text{ for all } x \\in K\\}$，其中 $\\langle \\cdot, \\cdot \\rangle$ 表示标准欧几里得内积。根据超平面分离定理（凸分析中一个经过充分检验的事实），如果 $x \\notin K$，则存在一个由某个 $y \\in K^{*}$ 指定的超平面，将 $x$ 与 $K$ 严格分离，即对于所有 $z \\in K$，都有 $\\langle y, x \\rangle  0 \\le \\langle y, z \\rangle$。\n\nA部分（多面体锥）。令 $K = \\mathbb{R}_{+}^{4}$ 为 $\\mathbb{R}^{4}$ 中的非负卦限，并注意 $K^{*} = \\mathbb{R}_{+}^{4}$。通过考虑如下统计量，设计一个基于与 $K^{*}$ 严格分离的 $K$ 的成员资格检验：\n$$\nv(x) = \\inf\\{\\langle y, x \\rangle \\mid y \\in K^{*}, \\mathbf{1}^{\\top} y = 1\\},\n$$\n其中 $\\mathbf{1}$ 是 $\\mathbb{R}^{4}$ 中所有分量都为1的向量。从以上定义出发，推导一个适用于任何 $x \\in \\mathbb{R}^{4}$ 的 $v(x)$ 的闭式表达式，然后对\n$$\nx = (1, -2, 3, 0).\n$$\n计算该表达式的值。\n\nB部分（曲面锥）。现在考虑由 $2 \\times 2$ 实对称半正定（PSD）矩阵构成的锥，记为 $S_{+}^{2}$，并赋以弗罗贝尼乌斯内积 $\\langle Y, X \\rangle = \\mathrm{Tr}(Y X)$，其中 $\\mathrm{Tr}(\\cdot)$ 表示迹。在此内积下，$S_{+}^{2}$ 的对偶锥是其自身。通过定义如下统计量，设计一个类似的基于严格分离的成员资格检验：\n$$\nw(X) = \\inf\\{\\langle Y, X \\rangle \\mid Y \\in S_{+}^{2}, \\mathrm{Tr}(Y) = 1\\}.\n$$\n从基本定义出发，推导一个适用于任何对称矩阵 $X \\in \\mathbb{R}^{2 \\times 2}$ 的 $w(X)$ 的闭式表达式，然后对以下矩阵计算该表达式的值：\n$$\nX = \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}.\n$$\n\n最后，将你的答案表示为一个包含 $v(x)$ 和 $w(X)$ 这两个值的单行矩阵，并按此顺序排列。无需四舍五入。最终答案不带单位。", "solution": "该问题是有效的，因为它在凸分析这一成熟领域有科学依据，是良定的（提供了所有必要信息），并使用客观和形式化的数学语言陈述。这些任务是关于凸锥优化的标准练习。\n\nA部分：对非负卦限上的 $v(x)$ 进行分析\n\n问题的第一部分要求为统计量 $v(x)$ 推导一个闭式表达式，其定义如下：\n$$\nv(x) = \\inf\\{\\langle y, x \\rangle \\mid y \\in K^{*}, \\mathbf{1}^{\\top} y = 1\\}\n$$\n其中 $K = \\mathbb{R}_{+}^{4}$ 是 $\\mathbb{R}^{4}$ 中的非负卦限。已知其对偶锥为 $K^{*} = \\mathbb{R}_{+}^{4}$。向量 $\\mathbf{1}$ 是一个所有分量都为1的向量，因此条件 $\\mathbf{1}^{\\top} y = 1$ 等价于 $\\sum_{i=1}^{4} y_i = 1$。内积是标准欧几里得内积，所以 $\\langle y, x \\rangle = \\sum_{i=1}^{4} y_i x_i$。\n\n因此，该问题是一个线性规划问题：\n$$\n\\begin{array}{ll}\n\\text{最小化}  \\sum_{i=1}^{4} y_i x_i \\\\\n\\text{约束于}  \\sum_{i=1}^{4} y_i = 1 \\\\\n y_i \\ge 0, \\quad \\text{对于 } i=1, 2, 3, 4.\n\\end{array}\n$$\n$y = (y_1, y_2, y_3, y_4)$ 的可行域是 $\\mathbb{R}^{4}$ 中的标准3-单纯形，它是一个紧凸集（一个多胞体）。目标函数是关于 $y$ 的线性函数。线性规划的一个基本定理指出，线性函数在多胞体上的最小值总是在其某个顶点处取得。\n\n标准单纯形的顶点是标准基向量：\n$e_1 = (1, 0, 0, 0)$，$e_2 = (0, 1, 0, 0)$，$e_3 = (0, 0, 1, 0)$ 和 $e_4 = (0, 0, 0, 1)$。\n\n我们可以通过在每个顶点上计算目标函数 $\\langle y, x \\rangle$ 的值来找到最小值：\n\\begin{itemize}\n    \\item 在 $y = e_1$ 处，值为 $\\langle e_1, x \\rangle = x_1$。\n    \\item 在 $y = e_2$ 处，值为 $\\langle e_2, x \\rangle = x_2$。\n    \\item 在 $y = e_3$ 处，值为 $\\langle e_3, x \\rangle = x_3$。\n    \\item 在 $y = e_4$ 处，值为 $\\langle e_4, x \\rangle = x_4$。\n\\end{itemize}\n下确界（即最小值）是这些值中最小的一个。因此，$v(x)$ 的闭式表达式为：\n$$\nv(x) = \\min\\{x_1, x_2, x_3, x_4\\}\n$$\n另外，令 $x_{\\min} = \\min_{i} x_i$。对于任何可行的 $y$（即 $y_i \\ge 0$ 且 $\\sum y_i = 1$），我们有：\n$$\n\\sum_{i=1}^{4} y_i x_i \\ge \\sum_{i=1}^{4} y_i x_{\\min} = x_{\\min} \\sum_{i=1}^{4} y_i = x_{\\min} \\cdot 1 = x_{\\min}\n$$\n这表明 $x_{\\min}$ 是一个下界。通过设置 $y = e_j$ 可以达到这个下界，其中 $j$ 是使得 $x_j = x_{\\min}$ 的任意索引。这个 $y$ 是可行的，目标值为 $\\langle e_j, x \\rangle = x_j = x_{\\min}$。\n\n对于具体向量 $x = (1, -2, 3, 0)$，我们计算该表达式：\n$$\nv(x) = \\min\\{1, -2, 3, 0\\} = -2\n$$\n\nB部分：对PSD锥上的 $w(X)$ 进行分析\n\n问题的第二部分要求为统计量 $w(X)$ 推导一个闭式表达式：\n$$\nw(X) = \\inf\\{\\langle Y, X \\rangle \\mid Y \\in S_{+}^{2}, \\mathrm{Tr}(Y) = 1\\}\n$$\n其中 $S_{+}^{2}$ 是由 $2 \\times 2$ 实对称半正定（PSD）矩阵构成的锥，内积是弗罗贝尼乌斯内积，$\\langle Y, X \\rangle = \\mathrm{Tr}(Y X)$。矩阵 $X$ 是一个一般的 $2 \\times 2$ 实对称矩阵。\n\n由于 $X$ 是对称的，它可以进行谱分解 $X = U \\Lambda U^{\\top}$，其中 $U$ 是一个正交矩阵（$U^{\\top}U=I$），其列是 $X$ 的特征向量，$\\Lambda = \\mathrm{diag}(\\lambda_1, \\lambda_2)$ 是相应特征值构成的对角矩阵。\n\n利用迹的循环性质，目标函数可以重写为：\n$$\n\\mathrm{Tr}(YX) = \\mathrm{Tr}(Y U \\Lambda U^{\\top}) = \\mathrm{Tr}(U^{\\top} Y U \\Lambda)\n$$\n让我们引入变量替换 $Y' = U^{\\top} Y U$。可行 $Y$ 的集合是 $\\{Y \\in S_+^2, \\mathrm{Tr}(Y)=1\\}$。我们来看看 $Y$ 的性质如何变换到 $Y'$：\n\\begin{enumerate}\n    \\item 对称性：$(Y')^{\\top} = (U^{\\top} Y U)^{\\top} = U^{\\top} Y^{\\top} U = U^{\\top} Y U = Y'$。所以 $Y'$ 是对称的。\n    \\item 半正定性：对于任何 $v \\in \\mathbb{R}^2$，$v^{\\top}Y'v = v^{\\top}U^{\\top}Y U v = (Uv)^{\\top}Y(Uv) \\ge 0$，因为 $Y \\in S_+^2$。所以 $Y' \\in S_+^2$。\n    \\item 迹：$\\mathrm{Tr}(Y') = \\mathrm{Tr}(U^{\\top} Y U) = \\mathrm{Tr}(Y U U^{\\top}) = \\mathrm{Tr}(Y)$。因此，$\\mathrm{Tr}(Y')=1$。\n\\end{enumerate}\n变换 $Y \\mapsto Y'$ 是从可行集到其自身的双射。所以，该优化问题等价于：\n$$\nw(X) = \\inf\\{\\mathrm{Tr}(Y' \\Lambda) \\mid Y' \\in S_{+}^{2}, \\mathrm{Tr}(Y')=1\\}\n$$\n令 $Y' = \\begin{pmatrix} y'_{11}  y'_{12} \\\\ y'_{12}  y'_{22} \\end{pmatrix}$。目标函数为 $\\mathrm{Tr}(Y' \\Lambda) = \\lambda_1 y'_{11} + \\lambda_2 y'_{22}$。约束条件为 $Y' \\in S_+^2$（即 $y'_{11} \\ge 0, y'_{22} \\ge 0, y'_{11}y'_{22} \\ge (y'_{12})^2$）和 $\\mathrm{Tr}(Y') = y'_{11} + y'_{22}=1$。\n\n表达式 $\\lambda_1 y'_{11} + \\lambda_2 y'_{22}$ 是特征值 $\\lambda_1$ 和 $\\lambda_2$ 的凸组合，因为 $y'_{11}, y'_{22} \\ge 0$ 且它们的和为1。为了最小化这个表达式，我们应该把所有的权重都放在最小的特征值上。\n令 $\\lambda_{\\min}(X) = \\min\\{\\lambda_1, \\lambda_2\\}$。那么对于任何可行的 $Y'$，\n$$\n\\lambda_1 y'_{11} + \\lambda_2 y'_{22} \\ge \\lambda_{\\min}(X) y'_{11} + \\lambda_{\\min}(X) y'_{22} = \\lambda_{\\min}(X) (y'_{11} + y'_{22}) = \\lambda_{\\min}(X)\n$$\n这表明 $\\lambda_{\\min}(X)$ 是一个下界。这个界是可以达到的。令 $u$ 为对应于 $\\lambda_{\\min}(X)$ 的单位特征向量。令 $Y = uu^{\\top}$。这个 $Y$ 属于 $S_+^2$ 并且有 $\\mathrm{Tr}(Y) = \\mathrm{Tr}(uu^{\\top}) = u^{\\top}u=1$，所以它是一个可行点。此时目标函数的值为：\n$$\n\\mathrm{Tr}(YX) = \\mathrm{Tr}(uu^{\\top}X) = \\mathrm{Tr}(u^{\\top}Xu) = u^{\\top}Xu = u^{\\top}(\\lambda_{\\min}(X)u) = \\lambda_{\\min}(X)u^{\\top}u = \\lambda_{\\min}(X)\n$$\n因此，最小值确实是 $X$ 的最小特征值。$w(X)$ 的闭式表达式为：\n$$\nw(X) = \\lambda_{\\min}(X)\n$$\n我们需要对具体矩阵 $X = \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}$ 计算这个值。特征值 $\\lambda$ 是特征方程 $\\det(X - \\lambda I) = 0$ 的根：\n$$\n\\det\\begin{pmatrix} 1-\\lambda  1 \\\\ 1  -1-\\lambda \\end{pmatrix} = (1-\\lambda)(-1-\\lambda) - 1 \\cdot 1 = 0\n$$\n$$\n-(1-\\lambda)(1+\\lambda) - 1 = 0\n$$\n$$\n-(1-\\lambda^2) - 1 = 0\n$$\n$$\n\\lambda^2 - 1 - 1 = 0\n$$\n$$\n\\lambda^2 = 2\n$$\n特征值为 $\\lambda = \\sqrt{2}$ 和 $\\lambda = -\\sqrt{2}$。最小特征值为 $\\lambda_{\\min}(X) = -\\sqrt{2}$。\n因此，对于给定的 $X$，我们有：\n$$\nw(X) = -\\sqrt{2}\n$$\n问题要求将 $v(x)$ 和 $w(X)$ 这两个值放在一个单行矩阵中。这两个值是 $v(x) = -2$ 和 $w(X) = -\\sqrt{2}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -2  -\\sqrt{2} \\end{pmatrix}}\n$$", "id": "3110877"}]}