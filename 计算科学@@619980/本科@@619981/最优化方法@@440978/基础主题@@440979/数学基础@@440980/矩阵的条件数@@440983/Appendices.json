{"hands_on_practices": [{"introduction": "理解条件数最简单的情形莫过于对角矩阵。在这种情况下，矩阵的奇异值就是其对角元素的绝对值，这使得条件数的计算变得非常直观。这个练习 [@problem_id:2210789] 将通过一个简单的构建任务，帮助你巩固谱范数（2-范数）条件数 $ \\kappa_2(A) $ 的基本定义及其与奇异值的关系。", "problem": "在数值线性代数中，可逆矩阵 $A$ 的 2-范数条件数（记为 $\\kappa_2(A)$）提供了一个度量，用于衡量线性系统 $A\\mathbf{x} = \\mathbf{b}$ 的解对向量 $\\mathbf{b}$ 中扰动的敏感程度。它被定义为 $A$ 的最大奇异值与最小奇异值之比。\n\n考虑一个 2x2 的实对角矩阵 $D$，其形式为\n$$D = \\begin{pmatrix} d_1  0 \\\\ 0  d_2 \\end{pmatrix}$$\n如果第一个对角元素是 $d_1 = 10$，且矩阵的 2-范数条件数是 $\\kappa_2(D) = 50$，那么第二个对角元素 $d_2$ 的所有可能实数值是什么？请将您的答案以单行矩阵的形式按升序排列。", "solution": "可逆矩阵 $A$ 的 2-范数条件数定义为\n$$\n\\kappa_{2}(A) = \\frac{\\sigma_{\\max}(A)}{\\sigma_{\\min}(A)},\n$$\n其中 $\\sigma_{\\max}(A)$ 和 $\\sigma_{\\min}(A)$ 分别表示 $A$ 的最大和最小奇异值。\n\n对于对角矩阵\n$$\nD = \\begin{pmatrix} d_{1}  0 \\\\ 0  d_{2} \\end{pmatrix},\n$$\n其奇异值是对角元素的绝对值，因为奇异值是 $D^{\\top}D$ 特征值的平方根，而\n$$\nD^{\\top}D = \\begin{pmatrix} d_{1}^{2}  0 \\\\ 0  d_{2}^{2} \\end{pmatrix},\n$$\n所以奇异值为 $|d_{1}|$ 和 $|d_{2}|$。\n\n给定 $d_{1} = 10$ 且 $\\kappa_{2}(D) = 50$，我们有\n$$\n\\kappa_{2}(D) = \\frac{\\max\\{|d_{1}|,|d_{2}|\\}}{\\min\\{|d_{1}|,|d_{2}|\\}} = 50,\n$$\n其中有约束条件 $d_{2} \\neq 0$（保证可逆性）。\n\n考虑以下两种情况：\n1) 如果 $|d_{1}| \\geq |d_{2}|$，那么 $\\sigma_{\\max} = |d_{1}| = 10$ 且 $\\sigma_{\\min} = |d_{2}|$，因此\n$$\n\\frac{10}{|d_{2}|} = 50 \\quad \\Rightarrow \\quad |d_{2}| = \\frac{10}{50} = \\frac{1}{5},\n$$\n所以 $d_{2} = \\pm \\frac{1}{5}$。\n\n2) 如果 $|d_{2}| > |d_{1}|$，那么 $\\sigma_{\\max} = |d_{2}|$ 且 $\\sigma_{\\min} = |d_{1}| = 10$，因此\n$$\n\\frac{|d_{2}|}{10} = 50 \\quad \\Rightarrow \\quad |d_{2}| = 500,\n$$\n所以 $d_{2} = \\pm 500$。\n\n收集所有可能的实数值并按升序排列，得到 $-500$、$-\\frac{1}{5}$、$\\frac{1}{5}$、$500$。", "answer": "$$\\boxed{\\begin{pmatrix}-500  -\\frac{1}{5}  \\frac{1}{5}  500\\end{pmatrix}}$$", "id": "2210789"}, {"introduction": "一个高的条件数意味着什么？它意味着线性系统的解对输入的微小扰动异常敏感。这个练习 [@problem_id:1393603] 提供了一个具体的例证，让你亲身体验这种“病态”特性。通过对一个线性方程组的右侧向量引入一个微不足道的变化，你将观察到解向量发生了不成比例的巨大变化，从而将抽象的“病态”概念变得具体可感。", "problem": "考虑线性方程组 $Ax=b$，其中矩阵 $A$ 和向量 $b$ 由下式给出：\n$$\nA = \\begin{pmatrix} 1  1 \\\\ 1  1.01 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}\n$$\n现在，假设右端向量 $b$ 被扰动为一个新向量 $b'$，从而得到一个新的解 $x'$。扰动后的系统为 $Ax' = b'$，其中：\n$$\nb' = \\begin{pmatrix} 2 \\\\ 2.01 \\end{pmatrix}\n$$\n令 $\\delta x = x' - x$ 和 $\\delta b = b' - b$ 分别表示解和右端向量的变化。您的任务是量化系统对这个小扰动的敏感性。\n\n计算此扰动的放大因子，该因子定义为解的相对误差与右端向量的相对误差之比。该因子由以下表达式给出：\n$$\n\\frac{\\|\\delta x\\| / \\|x\\|}{\\|\\delta b\\| / \\|b\\|}\n$$\n对于所有的向量范数计算，使用标准的欧几里得范数（也称为 $L_2$ 范数），其定义为 $\\|v\\| = \\sqrt{v_1^2 + v_2^2 + \\dots + v_n^2}$，对于向量 $v = (v_1, v_2, \\dots, v_n)$。\n\n请以一个实数的形式给出您的答案。", "solution": "我们求解未扰动的系统 $Ax=b$，其中 $A=\\begin{pmatrix}1  1 \\\\ 1  1.01\\end{pmatrix}$ 且 $b=\\begin{pmatrix}2 \\\\ 2\\end{pmatrix}$。记 $x=\\begin{pmatrix}x_{1} \\\\ x_{2}\\end{pmatrix}$，方程组为\n$$\nx_{1}+x_{2}=2,\\quad x_{1}+1.01\\,x_{2}=2.\n$$\n第二个方程减去第一个方程，得到\n$$\n0.01\\,x_{2}=0 \\implies x_{2}=0,\n$$\n于是 $x_{1}=2$。因此\n$$\nx=\\begin{pmatrix}2 \\\\ 0\\end{pmatrix}.\n$$\n\n对于扰动后的系统 $Ax'=b'$，其中 $b'=\\begin{pmatrix}2 \\\\ 2.01\\end{pmatrix}$，记 $x'=\\begin{pmatrix}x_{1}' \\\\ x_{2}'\\end{pmatrix}$。方程组为\n$$\nx_{1}'+x_{2}'=2,\\quad x_{1}'+1.01\\,x_{2}'=2.01.\n$$\n第二个方程减去第一个方程，得到\n$$\n0.01\\,x_{2}'=0.01 \\implies x_{2}'=1,\n$$\n于是 $x_{1}'=1$。因此\n$$\nx'=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}.\n$$\n\n因此，变化量为\n$$\n\\delta x=x'-x=\\begin{pmatrix}-1 \\\\ 1\\end{pmatrix},\\quad \\delta b=b'-b=\\begin{pmatrix}0 \\\\ 0.01\\end{pmatrix}.\n$$\n\n使用欧几里得范数 $\\|v\\|=\\sqrt{\\sum_{i} v_{i}^{2}}$，我们计算\n$$\n\\|\\delta x\\|=\\sqrt{(-1)^{2}+1^{2}}=\\sqrt{2},\\quad \\|x\\|=\\sqrt{2^{2}+0^{2}}=2,\n$$\n$$\n\\|\\delta b\\|=\\sqrt{0^{2}+(0.01)^{2}}=0.01,\\quad \\|b\\|=\\sqrt{2^{2}+2^{2}}=\\sqrt{8}=2\\sqrt{2}.\n$$\n\n放大因子为\n$$\n\\frac{\\|\\delta x\\|/\\|x\\|}{\\|\\delta b\\|/\\|b\\|}=\\frac{\\frac{\\sqrt{2}}{2}}{\\frac{0.01}{2\\sqrt{2}}}=\\frac{1}{\\sqrt{2}}\\cdot\\frac{2\\sqrt{2}}{0.01}=\\frac{2}{0.01}=200.\n$$", "answer": "$$\\boxed{200}$$", "id": "1393603"}, {"introduction": "在体验了病态系统的敏感性之后，我们能否更进一步，主动地找出并利用系统的“弱点”？这个高级练习 [@problem_id:3110439] 挑战我们去设计一个特定的微小扰动，以引发理论上可能的最大误差放大效应。这个过程将揭示条件数、矩阵的逆以及其奇异向量之间的深刻联系，展示了如何精确地定位并量化一个数值系统最脆弱的方向。", "problem": "考虑线性系统 $A x = b$ 和谱（二）范数，其中\n$$\nA = \\begin{pmatrix}\n5  0  0 \\\\\n0  2  0 \\\\\n0  0  0.2\n\\end{pmatrix}, \\qquad\nb = \\begin{pmatrix}\n1 \\\\ 0 \\\\ 0\n\\end{pmatrix}.\n$$\n您将研究右端项 $b$ 中的扰动如何通过映射 $x = A^{-1} b$ 在解 $x$ 中被放大。仅使用以下基础事实和定义：\n- 对于任意矩阵 $M$，由欧几里得范数（谱范数）诱导的算子范数定义为 $\\|M\\|_{2} = \\max_{\\|v\\|_{2} = 1} \\|M v\\|_{2}$。\n- 可逆矩阵 $A$ 在谱范数下的条件数是 $\\kappa_{2}(A) = \\|A\\|_{2} \\,\\|A^{-1}\\|_{2}$。\n- $b$ 中的扰动 $\\delta b$ 引起解的变化 $\\delta x$ 满足 $A(x + \\delta x) = b + \\delta b$，因此 $\\delta x = A^{-1} \\delta b$。\n\n在相对扰动大小固定为 $\\|\\delta b\\|_{2} / \\|b\\|_{2} = 0.02$ 的约束下，设计一个扰动 $\\delta b$，使得由 $\\kappa_{2}(A)$ 预测的相对解变化 $\\|\\delta x\\|_{2} / \\|x\\|_{2}$ 最大化，并计算 $\\|\\delta x\\|_{2} / \\|x\\|_{2}$ 的最终最大值。您的最终答案必须是一个实数。不要对您的答案进行四舍五入。", "solution": "该问题要求我们，对于给定的右端项相对扰动 $\\|\\delta b\\|_{2} / \\|b\\|_{2} = 0.02$，求出线性系统 $A x = b$ 的解的最大相对变化量 $\\|\\delta x\\|_{2} / \\|x\\|_{2}$。我们必须设计扰动向量 $\\delta b$ 以达到此最大值。\n\n问题陈述了 $A(x + \\delta x) = b + \\delta b$。由于 $Ax = b$，根据线性性质，我们有 $A \\delta x = \\delta b$，这意味着 $\\delta x = A^{-1} \\delta b$。解 $x$ 由 $x = A^{-1} b$ 给出。\n\n我们想要最大化的量是解的相对变化，可以表示为：\n$$\n\\frac{\\|\\delta x\\|_{2}}{\\|x\\|_{2}} = \\frac{\\|A^{-1} \\delta b\\|_{2}}{\\|A^{-1} b\\|_{2}}\n$$\n矩阵 $A$ 和向量 $b$ 已给出：\n$$\nA = \\begin{pmatrix}\n5  0  0 \\\\\n0  2  0 \\\\\n0  0  0.2\n\\end{pmatrix}, \\qquad\nb = \\begin{pmatrix}\n1 \\\\ 0 \\\\ 0\n\\end{pmatrix}.\n$$\n由于 $A$ 和 $b$ 是固定的，分母 $\\|A^{-1} b\\|_{2}$ 是一个常数值。为了使整个分数最大化，我们必须在 $\\delta b$ 的给定约束下最大化分子 $\\|A^{-1} \\delta b\\|_{2}$。\n\n首先，我们计算分母的各部分。对角矩阵 $A$ 的逆矩阵通过取每个对角元素的倒数得到：\n$$\nA^{-1} = \\begin{pmatrix}\n5^{-1}  0  0 \\\\\n0  2^{-1}  0 \\\\\n0  0  0.2^{-1}\n\\end{pmatrix} = \\begin{pmatrix}\n0.2  0  0 \\\\\n0  0.5  0 \\\\\n0  0  5\n\\end{pmatrix}\n$$\n现在，我们计算解向量 $x = A^{-1}b$：\n$$\nx = A^{-1} b = \\begin{pmatrix}\n0.2  0  0 \\\\\n0  0.5  0 \\\\\n0  0  5\n\\end{pmatrix}\n\\begin{pmatrix}\n1 \\\\ 0 \\\\ 0\n\\end{pmatrix} = \\begin{pmatrix}\n0.2 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n$x$ 的欧几里得范数是：\n$$\n\\|x\\|_{2} = \\|A^{-1} b\\|_{2} = \\sqrt{0.2^2 + 0^2 + 0^2} = 0.2\n$$\n接下来，我们分析对扰动 $\\delta b$ 的约束。该约束以相对大小的形式给出：\n$$\n\\frac{\\|\\delta b\\|_{2}}{\\|b\\|_{2}} = 0.02\n$$\n给定向量 $b$ 的范数是：\n$$\n\\|b\\|_{2} = \\sqrt{1^2 + 0^2 + 0^2} = 1\n$$\n将此代入约束条件，得到扰动向量 $\\delta b$ 的大小：\n$$\n\\|\\delta b\\|_{2} = 0.02 \\times \\|b\\|_{2} = 0.02 \\times 1 = 0.02\n$$\n问题现在简化为在约束条件 $\\|\\delta b\\|_{2} = 0.02$ 下最大化分子 $\\|A^{-1} \\delta b\\|_{2}$。\n\n根据诱导矩阵范数（谱范数）的定义，对于范数为 $\\|v\\|_{2}=R$ 的任意向量 $v$，$\\|A^{-1}v\\|_{2}$ 的最大值由 $\\|A^{-1}\\|_{2} R$ 给出。当 $v$ 是 $A^{-1}$ 对应于其最大奇异值 $\\sigma_{max}(A^{-1})$ 的奇异向量时，达到此最大值。\n\n对于像 $A^{-1}$ 这样的对称矩阵，奇异值是其特征值的绝对值。对角矩阵的特征值是其对角线元素。因此，$A^{-1}$ 的特征值为 $\\lambda_1 = 0.2$，$\\lambda_2 = 0.5$ 和 $\\lambda_3 = 5$。\n\n最大奇异值为 $\\sigma_{max}(A^{-1}) = \\max(|0.2|, |0.5|, |5|) = 5$。此值为 $A^{-1}$ 的谱范数：\n$$\n\\|A^{-1}\\|_{2} = 5\n$$\n与此最大奇异值 $\\sigma_{max}(A^{-1})=5$ 对应的奇异向量（同时也是特征向量）是标准基向量 $e_3$：\n$$\ne_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n为了最大化 $\\|A^{-1} \\delta b\\|_{2}$，我们必须将 $\\delta b$ 与这个最大拉伸方向对齐。因此，$\\delta b$ 必须是 $e_3$ 的倍数。\n$$\n\\delta b = c \\cdot e_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ c \\end{pmatrix}\n$$\n应用约束条件 $\\|\\delta b\\|_2 = 0.02$：\n$$\n\\|\\delta b\\|_{2} = \\left\\| \\begin{pmatrix} 0 \\\\ 0 \\\\ c \\end{pmatrix} \\right\\|_{2} = \\sqrt{0^2 + 0^2 + c^2} = |c| = 0.02\n$$\n我们可以选择 $c=0.02$。因此，最优扰动为：\n$$\n\\delta b = \\begin{pmatrix}\n0 \\\\\n0 \\\\\n0.02\n\\end{pmatrix}\n$$\n通过此选择，分子 $\\|A^{-1} \\delta b\\|_{2}$ 的值变为：\n$$\n\\|A^{-1} \\delta b\\|_{2} = \\left\\| \\begin{pmatrix}\n0.2  0  0 \\\\\n0  0.5  0 \\\\\n0  0  5\n\\end{pmatrix}\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0.02\n\\end{pmatrix} \\right\\|_{2} = \\left\\| \\begin{pmatrix}\n0 \\\\\n0 \\\\\n5 \\times 0.02\n\\end{pmatrix} \\right\\|_{2} = \\left\\| \\begin{pmatrix}\n0 \\\\\n0 \\\\\n0.1\n\\end{pmatrix} \\right\\|_{2} = 0.1\n$$\n或者，使用范数性质：$\\|A^{-1} \\delta b\\|_{2} = \\|A^{-1}\\|_{2} \\|\\delta b\\|_{2} = 5 \\times 0.02 = 0.1$。\n\n最后，我们可以通过代入分子和分母的值来计算最大的相对解变化：\n$$\n\\frac{\\|\\delta x\\|_{2}}{\\|x\\|_{2}} = \\frac{\\|A^{-1}\\delta b\\|_{2}}{\\|A^{-1}b\\|_{2}} = \\frac{0.1}{0.2} = 0.5\n$$\n这个结果与条件数给出的上界一致。条件数是 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$。范数 $\\|A\\|_2$ 是 $A$ 的最大奇异值，即 $\\max(5, 2, 0.2) = 5$。因此，$\\kappa_2(A) = 5 \\times 5 = 25$。相对误差的一般上界是 $\\kappa_2(A) \\frac{\\|\\delta b\\|_2}{\\|b\\|_2} = 25 \\times 0.02 = 0.5$。该问题的构造方式使得对 $b$ 的特定选择和对 $\\delta b$ 的最优选择使得这个最坏情况的上界得以达到。", "answer": "$$\\boxed{0.5}$$", "id": "3110439"}]}