{"hands_on_practices": [{"introduction": "我们从一个基本但至关重要的问题开始：如何将一个点与一个凸集分离开来。这个练习将引导你通过一个具体的构造过程，展示如何利用点在凸集上的投影来找到一个分离超平面[@problem_id:3179785]。这不仅是分离超平面定理的一个建设性证明，也为理解更复杂的优化算法奠定了坚实的几何直觉。", "problem": "设 $C \\subset \\mathbb{R}^{3}$ 为一个非空、闭合的凸集，并设 $x_{0} \\in \\mathbb{R}^{3}$ 为一点，满足 $x_{0} \\notin C$。记 $p = \\operatorname{proj}_{C}(x_{0})$ 为 $x_{0}$ 到 $C$ 上的欧几里得投影，定义为 $C$ 中唯一一个使到 $x_{0}$ 的欧几里得距离平方最小的点。从凸优化的基本原理和投影的定义出发，推导出一个在点 $p$ 处支撑 $C$ 并且使用向量 $x_{0} - p$ 将 $x_{0}$ 与 $C$ 严格分离的超平面。你的推导必须从投影作为凸最小化问题的解的定义开始，并通过建立刻画 $p$ 的必要最优性条件来进行。\n\n然后，将你的构造实例化到具体的闭凸集\n$$\nC = \\{ x \\in \\mathbb{R}^{3} : 0 \\leq x_{1} \\leq 1,\\; 0 \\leq x_{2} \\leq 1,\\; 0 \\leq x_{3} \\leq 1 \\}\n$$\n和点\n$$\nx_{0} = \\begin{pmatrix} 2 \\\\ -1 \\\\ 3 \\end{pmatrix}.\n$$\n计算投影 $p = \\operatorname{proj}_{C}(x_{0})$，并根据你的推导，计算分离超平面的法向量 $w \\in \\mathbb{R}^{3}$ 和偏移量 $b \\in \\mathbb{R}$，该超平面形式为 $\\{ x \\in \\mathbb{R}^{3} : w^{\\top} x = b \\}$。\n\n使用 LaTeX 的 `pmatrix` 环境，将你的最终答案表示为一个行矩阵 $(w_{1}\\; w_{2}\\; w_{3}\\; b)$。无需四舍五入。", "solution": "该问题是有效的。这是一个凸分析中提法恰当的问题，具有科学依据且陈述客观。它要求推导一个关于凸集投影的标准结果，并将其应用于一个具体案例。所有必要的信息都已提供。\n\n**第一部分：一般性推导**\n\n设 $C \\subset \\mathbb{R}^{3}$ 为一个非空、闭合的凸集，并设 $x_{0} \\in \\mathbb{R}^{3}$ 为一点，满足 $x_{0} \\notin C$。$x_{0}$ 到 $C$ 上的欧几里得投影，记为 $p = \\operatorname{proj}_{C}(x_{0})$，定义为 $C$ 中唯一一个使到 $x_{0}$ 的欧几里得距离平方最小的点。这可以被表述为一个凸优化问题：\n$$\np = \\arg\\min_{z \\in C} f(z)\n$$\n其中目标函数为 $f(z) = \\frac{1}{2} \\|z - x_{0}\\|^{2}$。函数 $f(z)$ 是严格凸的，约束集 $C$ 是凸的。因此，存在唯一的最小化点 $p$。\n\n对于一个点 $p \\in C$ 是可微凸函数 $f(z)$ 在凸集 $C$ 上的最小化点的充分必要条件由以下变分不等式给出：\n$$\n\\nabla f(p)^{\\top} (z - p) \\geq 0, \\quad \\forall z \\in C\n$$\n该条件表明，在最优点 $p$ 处的负梯度 $-\\nabla f(p)$ 定义了可行集 $C$ 在点 $p$ 处的一个支撑超平面。\n\n对于我们特定的目标函数 $f(z) = \\frac{1}{2} \\|z - x_{0}\\|^{2} = \\frac{1}{2} (z - x_{0})^{\\top}(z - x_{0})$，其关于 $z$ 的梯度为：\n$$\n\\nabla f(z) = z - x_{0}\n$$\n在最优点 $p$ 处计算梯度，我们得到 $\\nabla f(p) = p - x_{0}$。将此代入最优性条件，得到：\n$$\n(p - x_{0})^{\\top} (z - p) \\geq 0, \\quad \\forall z \\in C\n$$\n这个不等式是投影 $p$ 的基本特征。我们可以通过乘以 $-1$ 来重新整理它：\n$$\n(x_{0} - p)^{\\top} (z - p) \\leq 0\n$$\n$$\n(x_{0} - p)^{\\top} z - (x_{0} - p)^{\\top} p \\leq 0\n$$\n$$\n(x_{0} - p)^{\\top} z \\leq (x_{0} - p)^{\\top} p, \\quad \\forall z \\in C\n$$\n现在，我们使用向量 $w = x_{0} - p$ 定义一个超平面。因为 $x_{0} \\notin C$ 且 $p \\in C$，我们有 $x_{0} \\neq p$，所以 $w \\neq 0$。设该超平面为 $\\{ x \\in \\mathbb{R}^{3} : w^{\\top} x = b \\}$。我们设置偏移量 $b$ 为 $b = w^{\\top} p$。\n根据这些定义，不等式变为：\n$$\nw^{\\top} z \\leq b, \\quad \\forall z \\in C\n$$\n这表明整个集合 $C$ 都包含在闭半空间 $\\{ x \\in \\mathbb{R}^{3} : w^{\\top} x \\leq b \\}$ 中。根据定义，$w^{\\top} p = b$，所以点 $p$ 位于该超平面上。因为 $p \\in C$，这证实了超平面 $\\{ x \\in \\mathbb{R}^{3} : w^{\\top} x = b \\}$ 在点 $p$ 处支撑集合 $C$。\n\n接下来，我们必须证明这个超平面将 $x_{0}$ 与 $C$ 严格分离。我们已经证明了对于所有 $z \\in C$，都有 $w^\\top z \\leq b$。我们需要证明 $w^\\top x_0 > b$。让我们计算 $w^{\\top} x_{0}$：\n$$\nw^{\\top} x_{0} = (x_{0} - p)^{\\top} x_{0}\n$$\n这个值与 $b$ 的差值为：\n$$\nw^{\\top} x_{0} - b = (x_{0} - p)^{\\top} x_{0} - (x_{0} - p)^{\\top} p = (x_{0} - p)^{\\top} (x_{0} - p) = \\|x_{0} - p\\|^{2}\n$$\n因为 $x_{0} \\notin C$，我们知道 $x_{0} \\neq p$，因此欧几里得距离的平方 $\\|x_{0} - p\\|^{2}$ 是严格为正的。因此：\n$$\nw^{\\top} x_{0} - b > 0 \\implies w^{\\top} x_{0} > b\n$$\n这证明了 $x_{0}$ 位于开半空间 $\\{ x \\in \\mathbb{R}^{3} : w^{\\top} x > b \\}$ 中，该开半空间与集合 $C$ 严格分离。\n\n**第二部分：具体实例**\n\n我们给定的闭凸集是\n$$\nC = \\{ x \\in \\mathbb{R}^{3} : 0 \\leq x_{1} \\leq 1,\\; 0 \\leq x_{2} \\leq 1,\\; 0 \\leq x_{3} \\leq 1 \\} = [0, 1]^{3}\n$$\n它是 $\\mathbb{R}^{3}$ 中的单位立方体。给定的点是\n$$\nx_{0} = \\begin{pmatrix} 2 \\\\ -1 \\\\ 3 \\end{pmatrix}.\n$$\n首先，我们计算投影 $p = \\operatorname{proj}_{C}(x_{0})$。对于像 $C$ 这样的箱型集合，投影是可分离的，并且可以按分量计算。对于每个分量 $i \\in \\{1, 2, 3\\}$，$(x_{0})_{i}$ 在区间 $[0, 1]$ 上的投影由下式给出：\n$$\np_{i} = \\operatorname{proj}_{[0,1]}((x_{0})_{i}) = \\max(0, \\min(1, (x_{0})_{i}))\n$$\n对于 $i=1$：$p_{1} = \\operatorname{proj}_{[0,1]}(2) = 1$。\n对于 $i=2$：$p_{2} = \\operatorname{proj}_{[0,1]}(-1) = 0$。\n对于 $i=3$：$p_{3} = \\operatorname{proj}_{[0,1]}(3) = 1$。\n因此，投影点是：\n$$\np = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n接下来，我们使用在一般性部分推导出的公式 $w = x_{0} - p$ 来计算分离超平面的法向量 $w$。\n$$\nw = x_{0} - p = \\begin{pmatrix} 2 \\\\ -1 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\\\ 2 \\end{pmatrix}\n$$\n所以，法向量的分量是 $w_{1} = 1$, $w_{2} = -1$ 和 $w_{3} = 2$。\n\n最后，我们使用公式 $b = w^{\\top} p$ 来计算超平面的偏移量 $b$。\n$$\nb = w^{\\top} p = \\begin{pmatrix} 1  -1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} = (1)(1) + (-1)(0) + (2)(1) = 1 + 0 + 2 = 3\n$$\n因此，该超平面由方程 $w^{\\top} x = b$ 描述，即 $x_{1} - x_{2} + 2x_{3} = 3$。\n\n最终答案由 $w$ 的分量和 $b$ 的值组成。\n$w_{1} = 1$, $w_{2} = -1$, $w_{3} = 2$, $b = 3$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  -1  2  3\n\\end{pmatrix}\n}\n$$", "id": "3179785"}, {"introduction": "支撑超平面与凸函数的分析性质密切相关，尤其是在函数不可微的点上。本练习探讨了在函数图像（具体来说是它的上镜图）的“尖点”处，如何通过次梯度的概念来刻画所有可能的支撑超平面[@problem_id:3179819]。通过这个例子，你将深入理解次梯度与支撑超平面法向量之间的对偶关系，这是非光滑凸优化的核心概念。", "problem": "考虑由 $f(x_{1},x_{2})=\\max\\{|x_{1}|,|x_{2}|\\}$ 定义的凸函数 $f:\\mathbb{R}^{2}\\to\\mathbb{R}$。令 $\\operatorname{epi}(f)=\\{(x_{1},x_{2},t)\\in\\mathbb{R}^{3}:t\\geq f(x_{1},x_{2})\\}$ 表示 $f$ 的上图。在点 $(x_{1},x_{2})=(0,0)$ 处，仅使用凸性、上图、次梯度和支撑超平面的定义，完成以下任务：\n- 证明 $f$ 在 $(0,0)$ 处不可微，并通过次梯度不等式刻画次梯度集合 $\\partial f(0,0)$。\n- 解释每个次梯度 $g\\in\\partial f(0,0)$ 如何在点 $(0,0,f(0,0))$ 处产生一个 $\\operatorname{epi}(f)$ 的支撑超平面，并描述所有这些支撑超平面的外法向量集合。\n- 在此集合中，找出与证明不可微性相关的不同次梯度所对应的两个极端外法向，并计算这两个极端外法射线之间的夹角。\n\n将最终的角度以弧度表示为一个精确值。你的最终答案必须是单个闭式解析表达式。", "solution": "该问题要求在点 $(x_{1},x_{2})=(0,0)$ 处分析凸函数 $f(x_{1},x_{2})=\\max\\{|x_{1}|,|x_{2}|\\}$，重点关注其不可微性、次梯度以及其上图的支撑超平面的几何性质。\n\n令 $x = (x_{1}, x_{2}) \\in \\mathbb{R}^{2}$。该函数为 $f(x) = \\max\\{|x_{1}|, |x_{2}|\\}$。分析点为 $x_0 = (0,0)$。在此点， $f(x_0) = f(0,0) = \\max\\{|0|,|0|\\} = 0$。\n\n**第一部分：不可微性与次梯度集**\n\n首先，我们证明 $f$ 在 $x_0 = (0,0)$ 处是不可微的。一个函数在某点可微，如果其方向导数存在且对方向向量是线性的。$f$ 在 $x_0$ 处沿方向 $v=(v_{1},v_{2})$ 的方向导数由下式给出：\n$$ f'(x_0; v) = \\lim_{h\\to 0^{+}} \\frac{f(x_0+hv) - f(x_0)}{h} $$\n代入 $x_0=(0,0)$ 和 $f(0,0)=0$：\n$$ f'(0; v) = \\lim_{h\\to 0^{+}} \\frac{f(hv) - 0}{h} = \\lim_{h\\to 0^{+}} \\frac{\\max\\{|hv_{1}|, |hv_{2}|\\}}{h} $$\n因为 $h>0$，我们有 $|h|=h$，所以可以将其从最大值函数中提出来：\n$$ f'(0; v) = \\lim_{h\\to 0^{+}} \\frac{h\\max\\{|v_{1}|, |v_{2}|\\}}{h} = \\max\\{|v_{1}|, |v_{2}|\\} $$\n为了使 $f$ 在 $(0,0)$ 处可微，必须存在一个梯度向量 $\\nabla f(0,0) = g \\in \\mathbb{R}^2$，使得对于所有 $v \\in \\mathbb{R}^2$ 都有 $f'(0; v) = g \\cdot v$。这将要求对所有的 $v_{1}, v_{2}$ 都有 $\\max\\{|v_{1}|, |v_{2}|\\} = g_{1}v_{1} + g_{2}v_{2}$。让我们测试两个不同的方向：\n- 对于 $v=(1,0)$，我们得到 $\\max\\{|1|,|0|\\} = 1 = g_1(1) + g_2(0)$，所以 $g_1 = 1$。\n- 对于 $v=(-1,0)$，我们得到 $\\max\\{|-1|,|0|\\} = 1 = g_1(-1) + g_2(0)$，所以 $g_1 = -1$。\n由于 $g_{1}$ 不能同时为 $1$ 和 $-1$，所以不存在这样的梯度向量 $g$。因此，$f$ 在 $(0,0)$ 处不可微。\n\n接下来，我们刻画次梯度集 $\\partial f(0,0)$。如果对于所有 $x=(x_1, x_2) \\in \\mathbb{R}^2$，以下次梯度不等式成立，则向量 $g=(g_1, g_2) \\in \\mathbb{R}^2$ 是 $f$ 在 $x_0=(0,0)$ 处的次梯度：\n$$ f(x) \\geq f(x_0) + g \\cdot (x - x_0) $$\n代入 $f(x)$, $x_0$ 和 $f(x_0)$:\n$$ \\max\\{|x_1|, |x_2|\\} \\geq g_1 x_1 + g_2 x_2 $$\n为了找到 $g$ 的条件，我们必须确保这个不等式对所有 $x$ 都成立。\n\n首先，我们证明条件 $|g_1| + |g_2| \\le 1$ 是充分的。对任意 $x=(x_1, x_2)$，我们有：\n$$ g_1 x_1 + g_2 x_2 \\le |g_1 x_1| + |g_2 x_2| = |g_1||x_1| + |g_2||x_2| $$\n令 $M = \\max\\{|x_1|, |x_2|\\}$。则 $|x_1| \\le M$ 且 $|x_2| \\le M$。\n$$ |g_1||x_1| + |g_2||x_2| \\le |g_1|M + |g_2|M = (|g_1| + |g_2|)M $$\n因为我们假设 $|g_1| + |g_2| \\le 1$，我们有 $(|g_1| + |g_2|)M \\le 1 \\cdot M = M = \\max\\{|x_1|, |x_2|\\}$。\n因此，$g_1 x_1 + g_2 x_2 \\le \\max\\{|x_1|, |x_2|\\}$，满足次梯度不等式。\n\n接着，我们证明该条件是必要的。次梯度不等式必须对所有 $x$ 成立。选择 $x_1 = \\text{sgn}(g_1)$ 和 $x_2 = \\text{sgn}(g_2)$。代入不等式中：\n$$ \\max\\{|\\text{sgn}(g_1)|, |\\text{sgn}(g_2)|\\} \\ge g_1 \\text{sgn}(g_1) + g_2 \\text{sgn}(g_2) = |g_1| + |g_2| $$\n由于 $|\\text{sgn}(\\cdot)|$ 的值是 0 或 1，不等式左边的最大值至多为 1。因此，我们必须有 $1 \\ge |g_1| + |g_2|$。\n\n所以，次梯度集为 $\\partial f(0,0) = \\{ g=(g_1,g_2) \\in \\mathbb{R}^2 : |g_1| + |g_2| \\le 1 \\}$。这个集合是一个旋转了 $45^\\circ$ 的正方形，其顶点位于 $(1,0)$, $(0,1)$, $(-1,0)$ 和 $(0,-1)$。由于这个集合不是单点集，这证实了 $f$ 在 $(0,0)$ 处不可微。\n\n**第二部分：上图的支撑超平面**\n\n$f$ 的上图是集合 $\\operatorname{epi}(f) = \\{ (x,t) \\in \\mathbb{R}^3 : t \\ge f(x) \\}$。与 $x_0=(0,0)$ 对应的上图边界上的点是 $(x_0, f(x_0)) = (0,0,0)$。\n在 $(0,0,0)$ 处对 $\\operatorname{epi}(f)$ 的一个支撑超平面是一个穿过该点的超平面，使得整个集合 $\\operatorname{epi}(f)$ 位于该超平面定义的一个闭半空间内。设超平面的法向量为 $a=(n_1, n_2, n_3) \\in \\mathbb{R}^3$，其中 $n=(n_1,n_2)$。超平面方程为 $n\\cdot x + n_3 t = 0$。支撑条件是，对于所有 $(x,t) \\in \\operatorname{epi}(f)$，必须有 $n\\cdot x + n_3 t \\le 0$（对于一个指向外的法线）。\n\n对于任何 $(x,t) \\in \\operatorname{epi}(f)$，我们有 $t \\ge f(x)$。考虑形如 $(0,0,t)$ 且 $t \\ge f(0,0)=0$ 的点。对于这些点，不等式变为 $n_3 t \\le 0$。由于这必须对所有 $t \\ge 0$ 成立，我们必须有 $n_3 \\le 0$。一个非平凡的超平面需要一个非零的法向量。如果 $n_3 = 0$，则对所有 $x \\in \\mathbb{R}^2$ 都有 $n \\cdot x \\le 0$，这意味着 $n=0$。因此，对于一个非平凡的支撑超平面，有 $n_3  0$。\n\n我们通过设置 $n_3 = -1$ 来归一化法向量。支撑条件变为 $n \\cdot x - t \\le 0$，即 $t \\ge n \\cdot x$。这必须对所有满足 $t \\ge f(x)$ 的 $(x,t)$ 成立。这当且仅当它对 $t$ 的最小值，即 $t=f(x)$ 成立。所以我们要求对所有 $x \\in \\mathbb{R}^2$ 都有 $f(x) \\ge n \\cdot x$。\n这恰好是在 $x_0=(0,0)$ 处的次梯度不等式，其中 $n=g$。\n因此，对于每个次梯度 $g \\in \\partial f(0,0)$，向量 $(g, -1)$ 是在 $(0,0,0)$ 处对 $\\operatorname{epi}(f)$ 的支撑超平面的一个外法向量。所有这些外法向量的集合是：\n$$ N = \\{ (g_1, g_2, -1) \\in \\mathbb{R}^3 : |g_1| + |g_2| \\le 1 \\} $$\n\n**第三部分：极端法向量与夹角**\n\n次梯度集 $\\partial f(0,0)$ 是一个凸多边形。其“极端”点是其顶点。这些顶点产生了极端的支撑超平面。次微分 $\\partial f(0,0)$ 的顶点是 $g_A=(1,0)$、$g_B=(0,1)$、$g_C=(-1,0)$ 和 $g_D=(0,-1)$。\n\n问题要求找出两个能证明不可微性的极端外法向。$f$ 在 $(0,0)$ 处的不可微性可以通过证明方向导数 $f'(0;v)$ 的线性性质不成立来证明。一个标准的证明使用了标准基向量 $v=e_1=(1,0)$ 和 $w=e_2=(0,1)$：\n$f'(0; e_1) = \\max\\{|1|,|0|\\} = 1$。\n$f'(0; e_2) = \\max\\{|0|,|1|\\} = 1$。\n$f'(0; e_1+e_2) = f'(0; (1,1)) = \\max\\{|1|,|1|\\} = 1$。\n如果 $f$ 可微，我们应有 $f'(0; e_1+e_2) = f'(0; e_1)+f'(0; e_2) = 1+1=2$。由于 $1 \\neq 2$，$f$ 不可微。\n方向导数也由 $f'(x; v) = \\max_{g \\in \\partial f(x)} g \\cdot v$ 给出。对于 $v=e_1$ 和 $v=e_2$，达到最大值的次梯度分别是 $g_A=(1,0)$ 和 $g_B=(0,1)$。因此，这两个极端次梯度是不可微性的自然“见证者”。\n\n因此，我们将这两个极端次梯度确定为 $g_A=(1,0)$ 和 $g_B=(0,1)$。相应的极端外法向量是：\n$n_A = (g_A, -1) = (1, 0, -1)$\n$n_B = (g_B, -1) = (0, 1, -1)$\n\n这两个向量之间的夹角 $\\theta$ 可以使用点积公式 $\\cos\\theta = \\frac{n_A \\cdot n_B}{\\|n_A\\| \\|n_B\\|}$ 求得。\n点积为：\n$$ n_A \\cdot n_B = (1)(0) + (0)(1) + (-1)(-1) = 0 + 0 + 1 = 1 $$\n向量的模为：\n$$ \\|n_A\\| = \\sqrt{1^2 + 0^2 + (-1)^2} = \\sqrt{2} $$\n$$ \\|n_B\\| = \\sqrt{0^2 + 1^2 + (-1)^2} = \\sqrt{2} $$\n夹角的余弦值为：\n$$ \\cos\\theta = \\frac{1}{\\sqrt{2} \\cdot \\sqrt{2}} = \\frac{1}{2} $$\n以弧度表示的夹角 $\\theta$ 为：\n$$ \\theta = \\arccos\\left(\\frac{1}{2}\\right) = \\frac{\\pi}{3} $$", "answer": "$$\\boxed{\\frac{\\pi}{3}}$$", "id": "3179819"}, {"introduction": "在实际应用中，我们不仅要找到一个分离超平面，还希望能找到“最好”的一个，比如间隔最大的那个。这个练习将挑战你对“距离”和“间隔”的直观理解，展示了如何根据不同的范数（如 $L_1$、$L_2$ 和 $L_\\infty$）来定义和计算最大间隔[@problem_id:3179789]。你将通过此过程接触到对偶范数这一重要概念，并理解它在确定最佳分离边界中的关键作用。", "problem": "考虑$\\mathbb{R}^{2}$中相对于某个选定范数定义的两个闭凸集。设其中心分别为 $\\mathbf{c}_{A} = (-2, 1)$ 和 $\\mathbf{c}_{B} = (3, -1)$，半径分别为 $r_{A} = 2$ 和 $r_{B} = 1$。对于一个范数 $\\|\\cdot\\|$，定义集合 $A = \\{\\mathbf{x} \\in \\mathbb{R}^{2} : \\|\\mathbf{x} - \\mathbf{c}_{A}\\| \\le r_{A}\\}$ 和 $B = \\{\\mathbf{x} \\in \\mathbb{R}^{2} : \\|\\mathbf{x} - \\mathbf{c}_{B}\\| \\le r_{B}\\}$。一个法向量为 $\\mathbf{s} \\neq \\mathbf{0}$、偏移量为 $t$ 的超平面是集合 $\\{\\mathbf{x} \\in \\mathbb{R}^{2} : \\mathbf{s}^{\\top} \\mathbf{x} = t\\}$。在所选范数下，两个平行超平面 $\\mathbf{s}^{\\top} \\mathbf{x} = \\alpha$ 和 $\\mathbf{s}^{\\top} \\mathbf{x} = \\beta$ 之间的间隔为 $\\dfrac{|\\beta - \\alpha|}{\\|\\mathbf{s}\\|_{*}}$，其中 $\\|\\cdot\\|_{*}$ 是由 $\\|\\mathbf{s}\\|_{*} = \\sup_{\\|\\mathbf{z}\\| \\le 1} \\mathbf{s}^{\\top} \\mathbf{z}$ 定义的对偶范数。\n\n仅使用范数、对偶范数、凸集支撑函数的基本定义，以及不相交闭凸集的分离超平面和支撑超平面存在性定理，对 $\\|\\cdot\\|_{1}$、$\\|\\cdot\\|_{2}$ 和 $\\|\\cdot\\|_{\\infty}$ 这三种范数中的每一种，执行以下操作：\n\n- 构造一个法向量 $\\mathbf{s}$ 满足 $\\|\\mathbf{s}\\|_{*} = 1$ 且能最大化 $A$ 和 $B$ 之间间隔的显式分离超平面。指明此法向量 $\\mathbf{s}$ 以及对应的中间超平面的偏移量 $t$。\n- 计算在所选范数下 $A$ 和 $B$ 之间的最大间隔 $m$。\n\n最后，设 $m_{1}$、$m_{2}$ 和 $m_{\\infty}$ 分别表示在 $\\|\\cdot\\|_{1}$、$\\|\\cdot\\|_{2}$ 和 $\\|\\cdot\\|_{\\infty}$ 范数下的最大间隔。计算总量 $S = m_{1} + m_{2} + m_{\\infty}$，并将你的最终答案表示为一个无单位的、简化的精确表达式。无需四舍五入。[@problem_id:543]", "solution": "问题要求在三种不同的范数（$\\|\\cdot\\|_{1}$、$\\|\\cdot\\|_{2}$ 和 $\\|\\cdot\\|_{\\infty}$）下，为两个闭凸集 $A$ 和 $B$ 构造最大分离超平面并求出相应的最大间隔。这些集合被定义为 $\\mathbb{R}^{2}$ 中的范数球。\n\n首先，我们建立一个通用框架来求解这两个集合之间的最大间隔。\n设 $A = \\{\\mathbf{x} \\in \\mathbb{R}^{n} : \\|\\mathbf{x} - \\mathbf{c}_{A}\\| \\le r_{A}\\}$ 和 $B = \\{\\mathbf{y} \\in \\mathbb{R}^{n} : \\|\\mathbf{y} - \\mathbf{c}_{B}\\| \\le r_{B}\\}$ 是两个闭凸集。已知它们不相交。一个法向量为 $\\mathbf{s} \\neq \\mathbf{0}$ 的超平面 $\\{\\mathbf{z} : \\mathbf{s}^{\\top}\\mathbf{z} = t\\}$ 分离 $A$ 和 $B$，如果（不失一般性地）对所有 $\\mathbf{x} \\in A$ 有 $\\mathbf{s}^{\\top}\\mathbf{x} \\le t$，且对所有 $\\mathbf{y} \\in B$ 有 $\\mathbf{s}^{\\top}\\mathbf{y} \\ge t$。这意味着存在两个平行的支撑超平面，每个集合一个，使得它们之间的带状区域为空。因此，可分离性的条件是 $\\sup_{\\mathbf{x} \\in A} \\mathbf{s}^{\\top}\\mathbf{x} \\le \\inf_{\\mathbf{y} \\in B} \\mathbf{s}^{\\top}\\mathbf{y}$。\n\n我们使用凸集 $C$ 的支撑函数来分析这两项，其定义为 $\\sigma_C(\\mathbf{s}) = \\sup_{\\mathbf{z} \\in C} \\mathbf{s}^{\\top}\\mathbf{z}$。\n对于集合 $A$，我们有：\n$$ \\sigma_A(\\mathbf{s}) = \\sup_{\\|\\mathbf{x} - \\mathbf{c}_{A}\\| \\le r_{A}} \\mathbf{s}^{\\top}\\mathbf{x} $$\n令 $\\mathbf{u} = \\mathbf{x} - \\mathbf{c}_{A}$，则 $\\mathbf{x} = \\mathbf{u} + \\mathbf{c}_{A}$ 且 $\\|\\mathbf{u}\\| \\le r_{A}$。\n$$ \\sigma_A(\\mathbf{s}) = \\sup_{\\|\\mathbf{u}\\| \\le r_{A}} \\mathbf{s}^{\\top}(\\mathbf{u} + \\mathbf{c}_{A}) = \\mathbf{s}^{\\top}\\mathbf{c}_{A} + \\sup_{\\|\\mathbf{u}\\| \\le r_{A}} \\mathbf{s}^{\\top}\\mathbf{u} $$\n上确界项可以与对偶范数 $\\|\\cdot\\|_{*}$ 相关联，其定义为 $\\|\\mathbf{s}\\|_{*} = \\sup_{\\|\\mathbf{z}\\| \\le 1} \\mathbf{s}^{\\top}\\mathbf{z}$。\n$$ \\sup_{\\|\\mathbf{u}\\| \\le r_{A}} \\mathbf{s}^{\\top}\\mathbf{u} = r_{A} \\sup_{\\|\\mathbf{u}/r_{A}\\| \\le 1} \\mathbf{s}^{\\top}(\\mathbf{u}/r_{A}) = r_{A} \\|\\mathbf{s}\\|_{*} $$\n因此，集合 $A$ 的支撑函数为 $\\sigma_A(\\mathbf{s}) = \\mathbf{s}^{\\top}\\mathbf{c}_{A} + r_{A}\\|\\mathbf{s}\\|_{*}$。\n\n类似地，对于集合 $B$ 上的下确界：\n$$ \\inf_{\\mathbf{y} \\in B} \\mathbf{s}^{\\top}\\mathbf{y} = -\\sup_{\\mathbf{y} \\in B} (-\\mathbf{s})^{\\top}\\mathbf{y} = -\\sigma_B(-\\mathbf{s}) $$\n使用支撑函数的公式，并将 $\\mathbf{s}$ 替换为 $-\\mathbf{s}$：\n$$ \\sigma_B(-\\mathbf{s}) = (-\\mathbf{s})^{\\top}\\mathbf{c}_{B} + r_{B}\\|-\\mathbf{s}\\|_{*} = -\\mathbf{s}^{\\top}\\mathbf{c}_{B} + r_{B}\\|\\mathbf{s}\\|_{*} $$\n因此，$\\inf_{\\mathbf{y} \\in B} \\mathbf{s}^{\\top}\\mathbf{y} = -(-\\mathbf{s}^{\\top}\\mathbf{c}_{B} + r_{B}\\|\\mathbf{s}\\|_{*}) = \\mathbf{s}^{\\top}\\mathbf{c}_{B} - r_{B}\\|\\mathbf{s}\\|_{*}$。\n\n界定分离带状区域的两个平行超平面是 $\\mathbf{s}^{\\top}\\mathbf{x} = \\alpha$ 和 $\\mathbf{s}^{\\top}\\mathbf{x} = \\beta$，其中 $\\alpha = \\sigma_A(\\mathbf{s})$ 且 $\\beta = \\inf_{\\mathbf{y} \\in B} \\mathbf{s}^{\\top}\\mathbf{y}$。对于给定的法向量 $\\mathbf{s}$，间隔为 $m(\\mathbf{s}) = \\frac{\\beta - \\alpha}{\\|\\mathbf{s}\\|_{*}}$，假设 $\\beta \\ge \\alpha$。\n$$ m(\\mathbf{s}) = \\frac{(\\mathbf{s}^{\\top}\\mathbf{c}_{B} - r_{B}\\|\\mathbf{s}\\|_{*}) - (\\mathbf{s}^{\\top}\\mathbf{c}_{A} + r_{A}\\|\\mathbf{s}\\|_{*})}{\\|\\mathbf{s}\\|_{*}} = \\frac{\\mathbf{s}^{\\top}(\\mathbf{c}_{B} - \\mathbf{c}_{A}) - (r_{A}+r_{B})\\|\\mathbf{s}\\|_{*}}{\\|\\mathbf{s}\\|_{*}} $$\n令 $\\mathbf{d} = \\mathbf{c}_{B} - \\mathbf{c}_{A}$。间隔为 $m(\\mathbf{s}) = \\frac{\\mathbf{s}^{\\top}\\mathbf{d}}{\\|\\mathbf{s}\\|_{*}} - (r_{A}+r_{B})$。为了最大化间隔，我们必须最大化项 $\\frac{\\mathbf{s}^{\\top}\\mathbf{d}}{\\|\\mathbf{s}\\|_{*}}$。根据 Hölder 不等式（或对偶范数的对偶范数的定义），该项的有界值为 $\\|\\mathbf{d}\\|$。当 $\\mathbf{s}$ 是 $\\mathbf{d}$ 的一个“对齐”向量时，达到最大值。所以，最大间隔为 $m = \\|\\mathbf{d}\\| - (r_{A}+r_{B})$。\n\n问题要求构造一个分离超平面，其法向量 $\\mathbf{s}$ 被归一化以满足 $\\|\\mathbf{s}\\|_{*} = 1$。最优的 $\\mathbf{s}$ 在约束 $\\|\\mathbf{s}\\|_{*} = 1$ 下最大化 $\\mathbf{s}^{\\top}\\mathbf{d}$。这意味着 $\\mathbf{s}^{\\top}\\mathbf{d} = \\|\\mathbf{d}\\|$，这刻画了 $\\mathbf{s}$ 作为范数函数 $\\|\\cdot\\|$ 在 $\\mathbf{d}$ 处的一个次梯度。所求的中间超平面是 $\\{\\mathbf{x} : \\mathbf{s}^{\\top}\\mathbf{x}=t\\}$，其中 $t$ 是两个支撑超平面偏移量的平均值：\n$$ t = \\frac{\\alpha+\\beta}{2} = \\frac{(\\mathbf{s}^{\\top}\\mathbf{c}_{A} + r_{A}\\|\\mathbf{s}\\|_{*}) + (\\mathbf{s}^{\\top}\\mathbf{c}_{B} - r_{B}\\|\\mathbf{s}\\|_{*})}{2} = \\frac{\\mathbf{s}^{\\top}(\\mathbf{c}_{A}+\\mathbf{c}_{B}) + (r_{A}-r_{B})\\|\\mathbf{s}\\|_{*}}{2} $$\n在 $\\|\\mathbf{s}\\|_{*}=1$ 的条件下，这简化为 $t = \\frac{1}{2}(\\mathbf{s}^{\\top}(\\mathbf{c}_{A}+\\mathbf{c}_{B}) + r_{A}-r_{B})$。\n\n问题提供以下数据：$\\mathbf{c}_{A} = \\begin{pmatrix} -2 \\\\ 1 \\end{pmatrix}$，$\\mathbf{c}_{B} = \\begin{pmatrix} 3 \\\\ -1 \\end{pmatrix}$，$r_{A} = 2$，以及 $r_{B} = 1$。\n由此，我们计算：\n$\\mathbf{d} = \\mathbf{c}_{B} - \\mathbf{c}_{A} = \\begin{pmatrix} 3 - (-2) \\\\ -1 - 1 \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ -2 \\end{pmatrix}$。\n$r_{A} + r_{B} = 2 + 1 = 3$。\n$\\mathbf{c}_{A} + \\mathbf{c}_{B} = \\begin{pmatrix} -2 + 3 \\\\ 1 - 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n$r_{A} - r_{B} = 2 - 1 = 1$。\n\n现在我们将此框架应用于每一种指定的范数。\n\n**1. 对于范数 $\\|\\cdot\\|_{2}$ (欧几里得范数):**\n其对偶范数为 $\\|\\cdot\\|_{*} = \\|\\cdot\\|_{2}$。\n最大间隔为 $m_{2} = \\|\\mathbf{d}\\|_{2} - (r_{A}+r_{B}) = \\sqrt{5^{2} + (-2)^{2}} - 3 = \\sqrt{29} - 3$。\n最优法向量 $\\mathbf{s}_{2}$ 在约束 $\\|\\mathbf{s}\\|_{2}=1$ 下最大化 $\\mathbf{s}^{\\top}\\mathbf{d}$。当 $\\mathbf{s}$ 与 $\\mathbf{d}$ 平行时达到最优值：\n$\\mathbf{s}_{2} = \\frac{\\mathbf{d}}{\\|\\mathbf{d}\\|_{2}} = \\frac{1}{\\sqrt{29}}\\begin{pmatrix} 5 \\\\ -2 \\end{pmatrix}$。\n我们验证 $\\|\\mathbf{s}_{2}\\|_{*} = \\|\\mathbf{s}_{2}\\|_{2} = 1$。\n中间超平面的偏移量 $t_{2}$ 为：\n$t_{2} = \\frac{1}{2}(\\mathbf{s}_{2}^{\\top}(\\mathbf{c}_{A}+\\mathbf{c}_{B}) + r_{A}-r_{B}) = \\frac{1}{2}\\left( \\frac{1}{\\sqrt{29}}\\begin{pmatrix} 5  -2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + 1 \\right) = \\frac{1}{2}\\left(\\frac{5}{\\sqrt{29}} + 1\\right) = \\frac{5+\\sqrt{29}}{2\\sqrt{29}}$。\n\n**2. 对于范数 $\\|\\cdot\\|_{1}$ (曼哈顿范数):**\n其对偶范数为 $\\|\\cdot\\|_{*} = \\|\\cdot\\|_{\\infty}$。\n最大间隔为 $m_{1} = \\|\\mathbf{d}\\|_{1} - (r_{A}+r_{B}) = (|5| + |-2|) - 3 = 7 - 3 = 4$。\n最优法向量 $\\mathbf{s}_{1}$ 在约束 $\\|\\mathbf{s}\\|_{\\infty}=\\max(|s_{1}|, |s_{2}|)=1$ 下最大化 $\\mathbf{s}^{\\top}\\mathbf{d} = 5s_{1} - 2s_{2}$。为最大化此表达式，我们选择 $s_{1}=1$ 和 $s_{2}=-1$。\n所以，$\\mathbf{s}_{1} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。该向量是 $\\|\\cdot\\|_1$ 范数在 $\\mathbf{d}$ 处的次梯度。\n我们验证 $\\|\\mathbf{s}_{1}\\|_{*} = \\|\\mathbf{s}_{1}\\|_{\\infty} = \\max(|1|,|-1|) = 1$。\n中间超平面的偏移量 $t_{1}$ 为：\n$t_{1} = \\frac{1}{2}(\\mathbf{s}_{1}^{\\top}(\\mathbf{c}_{A}+\\mathbf{c}_{B}) + r_{A}-r_{B}) = \\frac{1}{2}\\left( \\begin{pmatrix} 1  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + 1 \\right) = \\frac{1}{2}(1 + 1) = 1$。\n\n**3. 对于范数 $\\|\\cdot\\|_{\\infty}$ (切比雪夫/最大范数):**\n其对偶范数为 $\\|\\cdot\\|_{*} = \\|\\cdot\\|_{1}$。\n最大间隔为 $m_{\\infty} = \\|\\mathbf{d}\\|_{\\infty} - (r_{A}+r_{B}) = \\max(|5|, |-2|) - 3 = 5 - 3 = 2$。\n最优法向量 $\\mathbf{s}_{\\infty}$ 在约束 $\\|\\mathbf{s}\\|_{1}=|s_{1}|+|s_{2}|=1$ 下最大化 $\\mathbf{s}^{\\top}\\mathbf{d} = 5s_{1} - 2s_{2}$。为最大化此表达式，我们必须将最大权重赋予具有最大系数的分量，即 $s_{1}$。因此，我们设置 $s_{1}=1$ 和 $s_{2}=0$。\n所以，$\\mathbf{s}_{\\infty} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。该向量是 $\\|\\cdot\\|_\\infty$ 范数在 $\\mathbf{d}$ 处的次梯度。\n我们验证 $\\|\\mathbf{s}_{\\infty}\\|_{*} = \\|\\mathbf{s}_{\\infty}\\|_{1} = |1|+|0| = 1$。\n中间超平面的偏移量 $t_{\\infty}$ 为：\n$t_{\\infty} = \\frac{1}{2}(\\mathbf{s}_{\\infty}^{\\top}(\\mathbf{c}_{A}+\\mathbf{c}_{B}) + r_{A}-r_{B}) = \\frac{1}{2}\\left( \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + 1 \\right) = \\frac{1}{2}(1 + 1) = 1$。\n\n最后，我们计算最大间隔的总和 $S$：\n$S = m_{1} + m_{2} + m_{\\infty} = 4 + (\\sqrt{29} - 3) + 2 = 3 + \\sqrt{29}$。", "answer": "$$\n\\boxed{3 + \\sqrt{29}}\n$$", "id": "3179789"}]}