{"hands_on_practices": [{"introduction": "Nelder-Mead 算法的每一步都始于对当前单纯形（simplex）状态的评估。在尝试寻找更优解之前，算法必须首先识别出表现最好和最差的顶点。这个初始步骤至关重要，因为它决定了搜索的方向。本练习将带你实践这一基本操作：在一个二维单纯形中，根据函数值对顶点进行排序，并计算出用于后续步骤的关键几何中心——质心 ([@problem_id:2217758])。", "problem": "为了优化一个制造过程，一位工程师正在使用 Nelder-Mead 算法来寻找一组两个参数 $x$ 和 $y$，以最小化成本函数 $f(x,y)$。在一次迭代的开始，该算法在二维参数空间中的单纯形由三个顶点组成：$P_1$、$P_2$ 和 $P_3$。这些顶点的坐标及其对应的成本函数值如下：\n\n- 顶点 $P_1$：坐标为 $(\\frac{3}{2}, 2)$，函数值为 $f(P_1) = \\frac{25}{2}$。\n- 顶点 $P_2$：坐标为 $(3, \\frac{9}{2})$，函数值为 $f(P_2) = 25$。\n- 顶点 $P_3$：坐标为 $(\\frac{5}{2}, 1)$，函数值为 $f(P_3) = \\frac{17}{2}$。\n\n作为确定下一个测试点的预备步骤，您需要确定最差的顶点（函数值最高的那个）并计算其余顶点的质心。\n\n确定最差顶点的坐标 $(x_w, y_w)$ 和其他顶点质心的坐标 $(x_c, y_c)$。您的最终答案应该是一个行矩阵，按 $(x_w, y_w, x_c, y_c)$ 的顺序列出这四个值。请以精确分数或整数形式提供坐标。", "solution": "在 Nelder-Mead 算法中，最差的顶点是函数值最高的那个。给定函数值\n$$f(P_{1})=\\frac{25}{2}, \\quad f(P_{2})=25, \\quad f(P_{3})=\\frac{17}{2},$$\n我们注意到\n$$25 > \\frac{25}{2}, \\quad 25 > \\frac{17}{2},$$\n所以最差的顶点是 $P_2$，其坐标为 $(3, \\frac{9}{2})$。因此 $(x_{w}, y_{w})=(3, \\frac{9}{2})$。\n\n剩下的两个顶点 $P_{1}=(\\frac{3}{2},2)$ 和 $P_{3}=(\\frac{5}{2},1)$ 的质心是它们坐标的平均值。因此，\n$$x_{c}=\\frac{\\frac{3}{2}+\\frac{5}{2}}{2}=\\frac{\\frac{8}{2}}{2}=\\frac{4}{2}=2,$$\n$$y_{c}=\\frac{2+1}{2}=\\frac{3}{2}.$$\n因此 $(x_{c}, y_{c})=(2, \\frac{3}{2})$。\n\n所要求的按 $(x_{w}, y_{w}, x_{c}, y_{c})$ 顺序排列的行矩阵是 $\\begin{pmatrix}3 & \\frac{9}{2} & 2 & \\frac{3}{2}\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} 3 & \\frac{9}{2} & 2 & \\frac{3}{2} \\end{pmatrix}}$$", "id": "2217758"}, {"introduction": "在识别出最差顶点后，Nelder-Mead 算法的核心思想是通过一个称为“反射”的几何变换来生成一个新的测试点。这个操作旨在将最差的点翻转到单纯形的另一侧，期望在那里找到一个更优的位置。为了清晰地掌握反射操作的本质，本练习将问题简化到一维空间 ([@problem_id:2217764])，让你能够直观地理解反射点是如何根据最佳点和最差点计算出来的。", "problem": "Nelder-Mead 方法是一种流行的数值算法，用于在多维空间中寻找函数的最小值，而无需计算函数的导数。该方法通过迭代更新一个单纯形（一个在 $n$ 维空间中由 $n+1$ 个顶点组成的几何图形）来探索函数的景观。\n\n考虑将此方法应用于寻找一维函数 $f(x)$ 的最小值，其中 $n=1$。在这种情况下，单纯形只是一个由 $n+1=2$ 个不同点组成的集合。设待最小化的函数为：\n$$f(x) = (x - 2)^2 + 1$$\n假设初始单纯形由两个点 $x_1 = \\frac{5}{2}$ 和 $x_2 = \\frac{7}{2}$ 组成。\n\nNelder-Mead 算法的一次迭代始于在当前单纯形中确定“最佳”点 $x_b$（函数值最低的点）和“最差”点 $x_w$（函数值最高的点）。然后，通过将最差点相对于单纯形中所有其他点的质心进行反射，生成一个新的测试点。对于我们的一维、两点情况，“所有其他点的质心”就是最佳点 $x_b$。\n\n新的反射点 $x_r$ 使用以下公式计算：\n$$x_r = x_o + \\alpha(x_o - x_w)$$\n其中 $x_o$ 是除最差点之外的点的质心，$x_w$ 是最差点，$\\alpha$ 是一个称为反射系数的正常数。\n\n给定初始单纯形并使用反射系数 $\\alpha = 1$，计算算法第一步中将生成的反射点 $x_r$ 的值。将你的最终答案表示为精确分数。", "solution": "我们已知函数 $f(x)=(x-2)^{2}+1$ 和初始单纯形点 $x_{1}=\\frac{5}{2}$ 和 $x_{2}=\\frac{7}{2}$。为了确定最佳点和最差点，我们进行计算：\n$$f\\!\\left(\\frac{5}{2}\\right)=\\left(\\frac{5}{2}-2\\right)^{2}+1=\\left(\\frac{1}{2}\\right)^{2}+1=\\frac{1}{4}+1=\\frac{5}{4},$$\n$$f\\!\\left(\\frac{7}{2}\\right)=\\left(\\frac{7}{2}-2\\right)^{2}+1=\\left(\\frac{3}{2}\\right)^{2}+1=\\frac{9}{4}+1=\\frac{13}{4}.$$\n因此，最佳点是 $x_{b}=\\frac{5}{2}$，最差点是 $x_{w}=\\frac{7}{2}$。在一维两点的情况下，除最差点之外的点的质心是 $x_{o}=x_{b}=\\frac{5}{2}$。\n\n使用反射公式，其中 $\\alpha=1$，\n$$x_{r}=x_{o}+\\alpha(x_{o}-x_{w})=x_{o}+(x_{o}-x_{w})=2x_{o}-x_{w}.$$\n代入 $x_{o}=\\frac{5}{2}$ 和 $x_{w}=\\frac{7}{2}$ 得\n$$x_{r}=2\\cdot\\frac{5}{2}-\\frac{7}{2}=5-\\frac{7}{2}=\\frac{10}{2}-\\frac{7}{2}=\\frac{3}{2}.$$", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "2217764"}, {"introduction": "掌握了基本步骤后，是时候将它们组合起来，体验完整的 Nelder-Mead 算法流程了。在实际优化中，算法并非简单地接受每个反射点，而是会根据反射点的表现，动态地决定是进行“扩张”以加速探索，还是进行“压缩”以在有希望的区域内进行更精细的搜索。这个综合性练习 ([@problem_id:3155005]) 要求你完整地执行两轮迭代，包括反射、压缩等所有决策逻辑，从而真正掌握该算法的动态决策过程。", "problem": "考虑在$\\mathbb{R}^{2}$中进行无约束最小化的无导数Nelder-Mead (NM) 单纯形法，该方法通过反射、扩张、压缩和整体收缩移动来迭代更新一组3个顶点（一个单纯形）。设目标函数为\n$$\nf(x_{1},x_{2})=\\max\\big\\{(x_{1}-1)^{2},\\,10(x_{2}+1)^{2}\\big\\}.\n$$\n使用以下经典的NM系数：反射系数$\\alpha=1$，扩张系数$\\gamma=2$，压缩系数$\\rho=\\frac{1}{2}$，以及收缩系数$\\sigma=\\frac{1}{2}$。从具有以下顶点的初始单纯形开始\n$$\nx^{(1)}=(4,-2),\\quad x^{(2)}=(5,0),\\quad x^{(3)}=(2,-3).\n$$\n在每次迭代中，按目标函数值递增的顺序对顶点进行排序，使得$x^{(L)}$是最佳点（函数值最低），$x^{(H)}$是最差点（函数值最高），$x^{(G)}$是剩余的顶点。然后计算除$x^{(H)}$外所有点的质心$x^{(C)}$，通过$x^{(R)}=x^{(C)}+\\alpha\\big(x^{(C)}-x^{(H)}\\big)$将$x^{(H)}$相对于$x^{(C)}$进行反射，并应用标准的NM决策规则来选择反射、扩张、外压缩、内压缩或整体收缩。\n\n在这些规则下精确执行$2$次NM方法的迭代。预测每次迭代中哪个移动被接受。然后，在完成$2$次迭代后，报告最终单纯形中最佳顶点处的$f$值。提供这个最终目标函数的精确值。", "solution": "该问题要求对目标函数$f(x_{1},x_{2})=\\max\\big\\{(x_{1}-1)^{2},\\,10(x_{2}+1)^{2}\\big\\}$执行恰好2次Nelder-Mead (NM)单纯形法的迭代。给定的NM参数为：反射系数$\\alpha=1$，扩张系数$\\gamma=2$，压缩系数$\\rho=\\frac{1}{2}$，收缩系数$\\sigma=\\frac{1}{2}$。初始单纯形由顶点$x^{(1)}=(4,-2)$、$x^{(2)}=(5,0)$和$x^{(3)}=(2,-3)$定义。\n\n**迭代 1**\n\n首先，我们计算每个初始顶点的目标函数值。\n顶点$x^{(1)}=(4,-2)$的函数值为：\n$$f(x^{(1)}) = f(4,-2) = \\max\\big\\{(4-1)^{2}, 10(-2+1)^{2}\\big\\} = \\max\\{3^{2}, 10(-1)^{2}\\} = \\max\\{9, 10\\} = 10$$\n顶点$x^{(2)}=(5,0)$的函数值为：\n$$f(x^{(2)}) = f(5,0) = \\max\\big\\{(5-1)^{2}, 10(0+1)^{2}\\big\\} = \\max\\{4^{2}, 10(1)^{2}\\} = \\max\\{16, 10\\} = 16$$\n顶点$x^{(3)}=(2,-3)$的函数值为：\n$$f(x^{(3)}) = f(2,-3) = \\max\\big\\{(2-1)^{2}, 10(-3+1)^{2}\\big\\} = \\max\\{1^{2}, 10(-2)^{2}\\} = \\max\\{1, 40\\} = 40$$\n\n接下来，我们根据顶点的函数值，从最佳（最低）到最差（最高）进行排序。\n最佳顶点为 $x^{(L)} = x^{(1)} = (4,-2)$，其函数值为 $f_L = 10$。\n次佳顶点为 $x^{(G)} = x^{(2)} = (5,0)$，其函数值为 $f_G = 16$。\n最差顶点为 $x^{(H)} = x^{(3)} = (2,-3)$，其函数值为 $f_H = 40$。\n\n我们计算除最差顶点 $x^{(H)}$ 外所有顶点的质心 $x^{(C)}$：\n$$x^{(C)} = \\frac{1}{2}(x^{(L)} + x^{(G)}) = \\frac{1}{2}\\big((4,-2) + (5,0)\\big) = \\frac{1}{2}(9,-2) = \\left(\\frac{9}{2}, -1\\right)$$\n\n现在，我们执行反射步骤。使用$\\alpha=1$计算反射点$x^{(R)}$：\n$$x^{(R)} = x^{(C)} + \\alpha(x^{(C)} - x^{(H)}) = 2x^{(C)} - x^{(H)} = 2\\left(\\frac{9}{2}, -1\\right) - (2,-3) = (9,-2) - (2,-3) = (7,1)$$\n我们计算$x^{(R)}$处的目标函数值：\n$$f_R = f(7,1) = \\max\\big\\{(7-1)^{2}, 10(1+1)^{2}\\big\\} = \\max\\{6^{2}, 10(2)^{2}\\} = \\max\\{36, 40\\} = 40$$\n\n我们应用NM决策规则。我们将$f_R=40$与$f_L=10$，$f_G=16$和$f_H=40$进行比较。\n由于$f_R \\ge f_G$（因为$40 \\ge 16$），反射和扩张移动都不会被接受。我们进入压缩步骤。\n我们判断是执行外压缩还是内压缩。由于$f_R \\ge f_H$（因为$40 \\ge 40$），需要进行**内压缩**。\n第一次迭代接受的移动是内压缩。\n\n使用$\\rho=\\frac{1}{2}$计算内压缩点$x_{IC}$：\n$$x_{IC} = x^{(C)} + \\rho(x^{(H)} - x^{(C)}) = (1-\\rho)x^{(C)} + \\rho x^{(H)} = \\frac{1}{2}x^{(C)} + \\frac{1}{2}x^{(H)}$$\n$$x_{IC} = \\frac{1}{2}\\left(\\frac{9}{2}, -1\\right) + \\frac{1}{2}(2,-3) = \\left(\\frac{9}{4}, -\\frac{1}{2}\\right) + \\left(1, -\\frac{3}{2}\\right) = \\left(\\frac{13}{4}, -2\\right)$$\n我们计算$x_{IC}$处的目标函数值：\n$$f_{IC} = f\\left(\\frac{13}{4}, -2\\right) = \\max\\left\\{\\left(\\frac{13}{4}-1\\right)^{2}, 10(-2+1)^{2}\\right\\} = \\max\\left\\{\\left(\\frac{9}{4}\\right)^{2}, 10(-1)^{2}\\right\\} = \\max\\left\\{\\frac{81}{16}, 10\\right\\} = 10$$\n由于 $f_{IC}  f_H$（因为 $10  40$），压缩成功。我们接受新点$x_{IC}$，并用它替换最差顶点$x^{(H)}$。\n下一次迭代的新单纯形顶点为$\\{x^{(L)}, x^{(G)}, x_{IC}\\}$，即$\\left\\{(4,-2), (5,0), \\left(\\frac{13}{4}, -2\\right)\\right\\}$。\n\n**迭代 2**\n\n我们从新的单纯形及其对应的函数值开始：\n- $v_1 = (4,-2)$，其函数值为 $f(v_1) = 10$。\n- $v_2 = (5,0)$，其函数值为 $f(v_2) = 16$。\n- $v_3 = \\left(\\frac{13}{4}, -2\\right)$，其函数值为 $f(v_3) = 10$。\n\n我们对这些顶点进行排序：\n最差顶点是$x^{(H)} = v_2 = (5,0)$，其函数值为 $f_H = 16$。\n另外两个顶点具有相同的最佳值。我们可以任意分配它们。设$x^{(L)} = v_1 = (4,-2)$，其函数值为 $f_L=10$；$x^{(G)} = v_3 = \\left(\\frac{13}{4}, -2\\right)$，其函数值为 $f_G=10$。\n\n我们计算最佳点的质心：\n$$x^{(C)} = \\frac{1}{2}(x^{(L)} + x^{(G)}) = \\frac{1}{2}\\left((4,-2) + \\left(\\frac{13}{4}, -2\\right)\\right) = \\frac{1}{2}\\left(\\frac{16+13}{4}, -4\\right) = \\frac{1}{2}\\left(\\frac{29}{4}, -4\\right) = \\left(\\frac{29}{8}, -2\\right)$$\n\n我们使用$\\alpha=1$执行反射步骤：\n$$x^{(R)} = 2x^{(C)} - x^{(H)} = 2\\left(\\frac{29}{8}, -2\\right) - (5,0) = \\left(\\frac{29}{4}, -4\\right) - (5,0) = \\left(\\frac{29-20}{4}, -4\\right) = \\left(\\frac{9}{4}, -4\\right)$$\n我们计算$x^{(R)}$处的目标函数值：\n$$f_R = f\\left(\\frac{9}{4},-4\\right) = \\max\\left\\{\\left(\\frac{9}{4}-1\\right)^{2}, 10(-4+1)^{2}\\right\\} = \\max\\left\\{\\left(\\frac{5}{4}\\right)^{2}, 10(-3)^{2}\\right\\} = \\max\\left\\{\\frac{25}{16}, 90\\right\\} = 90$$\n\n我们应用NM规则，其中$f_R=90$，$f_L=10$，$f_G=10$，$f_H=16$。\n由于$f_R \\ge f_G$（因为$90 \\ge 10$），我们进行压缩。\n由于$f_R \\ge f_H$（因为$90 \\ge 16$），需要进行**内压缩**。\n第二次迭代接受的移动同样是内压缩。\n\n使用$\\rho=\\frac{1}{2}$计算内压缩点$x_{IC}$：\n$$x_{IC} = \\frac{1}{2}x^{(C)} + \\frac{1}{2}x^{(H)} = \\frac{1}{2}\\left(\\frac{29}{8}, -2\\right) + \\frac{1}{2}(5,0) = \\left(\\frac{29}{16}, -1\\right) + \\left(\\frac{5}{2}, 0\\right) = \\left(\\frac{29+40}{16}, -1\\right) = \\left(\\frac{69}{16}, -1\\right)$$\n我们计算$x_{IC}$处的目标函数值：\n$$f_{IC} = f\\left(\\frac{69}{16},-1\\right) = \\max\\left\\{\\left(\\frac{69}{16}-1\\right)^{2}, 10(-1+1)^{2}\\right\\} = \\max\\left\\{\\left(\\frac{53}{16}\\right)^{2}, 0\\right\\} = \\frac{2809}{256}$$\n为了检查是否接受，我们将$f_{IC}$与$f_H$进行比较。$f_{IC} = \\frac{2809}{256} \\approx 10.97$，$f_H=16$。\n由于 $f_{IC}  f_H$，压缩成功。我们用$x_{IC}$替换$x^{(H)}$。\n\n经过2次迭代后的最终单纯形由顶点$\\left\\{(4,-2), \\left(\\frac{13}{4}, -2\\right), \\left(\\frac{69}{16}, -1\\right)\\right\\}$组成。\n\n**最终结果**\n\n问题要求的是最终单纯形中最佳顶点处的$f$值。我们检查三个最终顶点的函数值：\n- $f(4,-2) = 10$\n- $f\\left(\\frac{13}{4}, -2\\right) = 10$\n- $f\\left(\\frac{69}{16}, -1\\right) = \\frac{2809}{256}$\n\n函数值为$\\{10, 10, \\frac{2809}{256}\\}$。由于$\\frac{2809}{256} \\approx 10.97$，其中的最小值（最佳值）是$10$。\n两次迭代中接受的移动分别是：内压缩和内压缩。\n最终单纯形中最佳顶点处的$f$值为$10$。", "answer": "$$\\boxed{10}$$", "id": "3155005"}]}