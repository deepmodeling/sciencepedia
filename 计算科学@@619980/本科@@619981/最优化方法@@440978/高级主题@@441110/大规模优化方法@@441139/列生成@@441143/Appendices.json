{"hands_on_practices": [{"introduction": "列生成的核心在于“定价”步骤，即识别能改进当前解的新列。这个判断是通过计算“检验成本”（reduced cost）来完成的。本练习将让你专注于这一关键计算，为后续掌握完整的算法机制打下坚实的基础。[@problem_id:3108996]", "problem": "考虑一个列生成设置，其线性限制主问题（Restricted Master Problem）写为原问题标准形式：最小化目标函数 $\\sum_{p} c_{p} x_{p}$，约束条件为两个等式约束 $A x = b$ 和非负性约束 $x \\ge 0$。与这两个等式约束相关联的对偶变量被收集在向量 $\\pi \\in \\mathbb{R}^{2}$ 中。在某次迭代中，当前的对偶价格向量为 $\\pi = (1,1)$。给你三个候选列及其相关的成本系数和约束列：列 $p=1$ 有 $a_{1} = (2,0)$ 和 $c_{1} = 3$，列 $p=2$ 有 $a_{2} = (1,1)$ 和 $c_{2} = 2$，列 $p=3$ 有 $a_{3} = (0,2)$ 和 $c_{3} = 3$。仅使用线性规划对偶性的基本原理和判别数的定义，计算在给定的对偶向量 $\\pi$ 下每个候选列的判别数，然后报告这三个候选列中的最小判别数。将你的最终答案表示为一个实数。无需四舍五入。", "solution": "我们从线性规划对偶性的基本原理开始。考虑一个具有等式约束和非负性约束的标准形式原问题，写作最小化 $\\sum_{p} c_{p} x_{p}$，约束条件为 $A x = b$, $x \\ge 0$，其中 $A \\in \\mathbb{R}^{m \\times n}$ 且 $b \\in \\mathbb{R}^{m}$。其与等式约束相关联的对偶向量 $\\pi \\in \\mathbb{R}^{m}$ 的拉格朗日函数为\n$$\n\\mathcal{L}(x,\\pi) = \\sum_{p} c_{p} x_{p} + \\pi^{\\top} (b - A x) = \\pi^{\\top} b + \\sum_{p} \\left(c_{p} - a_{p}^{\\top} \\pi\\right) x_{p},\n$$\n其中 $a_{p}$ 表示 $A$ 的第 $p$ 列。在拉格朗日函数中乘以 $x_{p}$ 的系数，即 $c_{p} - a_{p}^{\\top} \\pi$，就是变量 $x_{p}$ 相对于对偶向量 $\\pi$ 的判别数。这是因为，对于给定的 $\\pi$，拉格朗日函数提供了一个线性化的度量，衡量在通过 $\\pi$ 考虑了约束的价值后，引入一个小的正量 $x_{p}$ 会如何改变目标函数。在列生成中，定价子问题评估这个判别数，以决定增加相应的列是否能改进当前限制主问题的解（对于一个最小化问题，负的判别数表示有潜在的改进空间）。\n\n因此，对于每个候选列 $p$，其判别数为\n$$\nr_{p} = c_{p} - a_{p}^{\\top} \\pi.\n$$\n\n给定 $\\pi = (1,1)$ 和三个候选列：\n\n1. 对于 $p=1$，我们有 $a_{1} = (2,0)$ 和 $c_{1} = 3$。计算\n$$\na_{1}^{\\top} \\pi = (2,0) \\cdot (1,1) = 2 \\cdot 1 + 0 \\cdot 1 = 2,\n$$\n所以\n$$\nr_{1} = 3 - 2 = 1.\n$$\n\n2. 对于 $p=2$，我们有 $a_{2} = (1,1)$ 和 $c_{2} = 2$。计算\n$$\na_{2}^{\\top} \\pi = (1,1) \\cdot (1,1) = 1 \\cdot 1 + 1 \\cdot 1 = 2,\n$$\n所以\n$$\nr_{2} = 2 - 2 = 0.\n$$\n\n3. 对于 $p=3$，我们有 $a_{3} = (0,2)$ 和 $c_{3} = 3$。计算\n$$\na_{3}^{\\top} \\pi = (0,2) \\cdot (1,1) = 0 \\cdot 1 + 2 \\cdot 1 = 2,\n$$\n所以\n$$\nr_{3} = 3 - 2 = 1.\n$$\n\n这三个判别数分别是 $r_{1} = 1$，$r_{2} = 0$ 和 $r_{3} = 1$。因此，这三个候选列中的最小判别数是\n$$\n\\min\\{1, 0, 1\\} = 0.\n$$\n\n因为当前问题是最小化问题，最小判别数为 $0$ 这一事实表明，在此对偶向量下，没有一个候选列能提供严格的改进，尽管判别数为 $0$ 的列在最优性条件方面是临界的。", "answer": "$$\\boxed{0}$$", "id": "3108996"}, {"introduction": "我们已经知道如何计算检验成本，但定价所需的对偶价格（$ \\pi $）从何而来？本练习将揭示这一点，展示如何从当前受限主问题的解中导出对偶价格，并用其为新列定价。通过这个练习，你将亲手完成一次完整的列生成迭代。[@problem_id:3108999]", "problem": "考虑列生成形式的线性规划 (LP)，其中原始问题是一个带有等式约束和非负性约束的最小化问题：最小化 $c^{\\top}x$，约束条件为 $A x = b$ 和 $x \\ge 0$。设限制主问题 (RMP) 由两个约束定义，其中\n$$\nA=\\begin{pmatrix}1  1  0 \\\\ 0  1  1\\end{pmatrix},\\quad\nb=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix},\\quad\nc=\\begin{pmatrix}1 \\\\ 1 \\\\ 1\\end{pmatrix}.\n$$\n在列生成中，我们维持一个作为基的工作列集合。用 $A$ 的第 $1$ 列和第 $3$ 列初始化 RMP 的基，并将第 $2$ 列视为当前缺失的列。根据原始-对偶线性规划和检验数的首要原则，计算与当前基相关联的对偶向量 $\\pi \\in \\mathbb{R}^{2}$ 以及缺失的第 $2$ 列的检验数。使用这些量来决定第 $2$ 列是否应该进入基。\n\n将您的最终结果报告为一个单行矩阵，其前两个条目是 $\\pi$ 的分量，第三个条目是第 $2$ 列的检验数。无需四舍五入。", "solution": "该问题是线性规划，特别是列生成方法的一个有效应用。所有必要的数据和定义都已提供，问题是适定的且具有科学依据。我们着手求解。\n\n原始线性规划 (LP) 的一般形式如下：\n$$\n\\text{minimize } z = c^{\\top}x\n$$\n$$\n\\text{subject to } Ax = b\n$$\n$$\nx \\ge 0\n$$\n\n给定的完整问题矩阵和向量是：\n$$\nA = \\begin{pmatrix} 1  1  0 \\\\ 0  1  1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n\n列生成过程始于一个限制主问题 (RMP)，它包含 $A$ 的列的一个子集。我们被指示用第 $1$ 列和第 $3$ 列初始化基。设基列的索引集为 $\\mathcal{B} = \\{1, 3\\}$。基矩阵，记为 $A_B$，由这些列构成：\n$$\nA_B = \\begin{pmatrix} A_1  A_3 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n这是 $2 \\times 2$ 的单位矩阵 $I_2$。\n\n与基变量对应的成本向量是 $c_B$：\n$$\nc_B = \\begin{pmatrix} c_1 \\\\ c_3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n\n与 RMP 相关联的对偶问题涉及找到一个对偶变量向量 $\\pi \\in \\mathbb{R}^2$。对偶变量是使得基列的检验数为零的方程组的解。条件是 $c_B^{\\top} - \\pi^{\\top} A_B = 0^{\\top}$，这通常写作：\n$$\n\\pi^{\\top} A_B = c_B^{\\top}\n$$\n将两边转置，得到关于 $\\pi$ 的线性方程组：\n$$\nA_B^{\\top} \\pi = c_B\n$$\n代入矩阵 $A_B$ 和 $c_B$：\n$$\n\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}^{\\top} \\begin{pmatrix} \\pi_1 \\\\ \\pi_2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n由于单位矩阵的转置是其自身，该方程组为：\n$$\n\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} \\pi_1 \\\\ \\pi_2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n这得出了对偶向量 $\\pi$ 的解：\n$$\n\\pi_1 = 1\n$$\n$$\n\\pi_2 = 1\n$$\n因此，对偶向量是 $\\pi = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n接下来，我们必须确定是否应将任何非基列添加到 RMP 中。这通过计算每个非基列的检验数来完成。在这个问题中，唯一指定要评估的非基列是第 $2$ 列。\n\n第 $j$ 列的检验数 $\\bar{c}_j$ 定义为：\n$$\n\\bar{c}_j = c_j - \\pi^{\\top} A_j\n$$\n对于第 $j=2$ 列，我们有成本 $c_2 = 1$ 和列向量 $A_2 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n将 $\\pi$、$c_2$ 和 $A_2$ 的值代入公式：\n$$\n\\bar{c}_2 = c_2 - \\pi^{\\top} A_2 = 1 - \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\n\\bar{c}_2 = 1 - (1 \\cdot 1 + 1 \\cdot 1) = 1 - (1 + 1) = 1 - 2\n$$\n$$\n\\bar{c}_2 = -1\n$$\n第 $2$ 列的检验数是 $-1$。\n\n在最小化问题中，如果一个列的检验数为负，则它是进入基的候选列。由于 $\\bar{c}_2 = -1  0$，将第 $2$ 列引入基将导致目标函数值下降。因此，第 $2$ 列应该进入基。\n\n问题要求将最终结果报告为一个单行矩阵，包含 $\\pi$ 的分量和第 $2$ 列的检验数。\n$\\pi$ 的分量是 $\\pi_1 = 1$ 和 $\\pi_2 = 1$。\n第 $2$ 列的检验数是 $\\bar{c}_2 = -1$。\n得到的行矩阵是 $\\begin{pmatrix} 1  1  -1 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1  -1\n\\end{pmatrix}\n}\n$$", "id": "3108999"}, {"introduction": "现在，让我们将所学知识应用于一个经典问题：切削库存问题。这个例子完美地展示了列生成的威力，它将“寻找最佳新切削模式”这个看似复杂的任务，巧妙地转化为一个我们熟悉的整数规划问题——背包问题。通过这个练习，你将体会到分解思想如何将大规模问题简化为主问题和定价子问题的迭代过程。[@problem_id:3108997]", "problem": "给定一个一维切割下料问题，卷材长度为 $L=17$，物品尺寸为 $S=\\{3,4,7\\}$，对应尺寸 $3$、$4$ 和 $7$ 的需求量分别为 $d=(3,2,2)$。目标是最小化所用卷材的数量。一个切割模式 $p$ 是一个非负整数向量 $a_{\\cdot p}=(a_{1p},a_{2p},a_{3p})$，其中 $a_{ip}$ 是在模式 $p$ 中切割的尺寸为 $s_i$ 的物品数量，并且任何可行模式都必须满足长度可行性约束 $\\sum_{i=1}^{3} s_i a_{ip} \\le L$。考虑一个基于模式子集的线性规划 (LP) 松弛主问题公式，其决策变量 $x_p \\ge 0$ 表示模式 $p$ 被使用的次数。任何模式的目标系数均为 $c_p=1$（每使用一个卷材的成本为 1）。约束确保需求得到满足。\n\n从一个限制主问题开始，该问题仅包含三种“单尺寸最大填充”模式：\n- $p_1$ 只切割尺寸为 $3$ 的物品，数量为能容纳的最大量：$(a_{1p_1},a_{2p_1},a_{3p_1})=(5,0,0)$，\n- $p_2$ 只切割尺寸为 $4$ 的物品，数量为能容纳的最大量：$(0,4,0)$，\n- $p_3$ 只切割尺寸为 $7$ 的物品，数量为能容纳的最大量：$(0,0,2)$。\n\n任务：\n1.  使用这三种模式构建限制主问题并求解至最优。根据 LP 对偶性的基本原理，写出该限制主问题的对偶问题，并利用互补松弛性确定与尺寸 $3$、$4$ 和 $7$ 的需求约束相关的最优对偶价格 $\\pi_1,\\pi_2,\\pi_3$。\n2.  使用最优对偶价格，将定价子问题推导为一个整数背包问题，该问题通过选择满足 $\\sum_{i=1}^{3} s_i a_{ip} \\le L$ 的非负整数 $(a_{1p},a_{2p},a_{3p})$ 来选择一个新模式 $p$，以最小化简约成本。精确求解此定价问题，并计算此迭代中定价子问题返回的最小简约成本值。\n\n将最终答案表述为最小简约成本的单一数值，以精确有理数形式表示。", "solution": "该问题要求执行列生成算法处理一维切割下料问题的一次迭代。这包括两个主要任务：首先，求解一个限制主问题 (RMP) 并找到其对偶价格；其次，使用这些价格求解一个定价子问题，以找到具有最负简约成本的新切割模式。\n\n### 第 1 部分：限制主问题和对偶价格\n\n初始的限制主问题 (RMP) 是使用给定的可行切割模式子集来构建的。目标是在满足所有物品类型总需求的同时，最小化所用卷材的总数。\n\n给定的参数是：\n- 卷材长度：$L = 17$。\n- 物品尺寸：$s_1 = 3$，$s_2 = 4$，$s_3 = 7$。\n- 需求量：$d_1 = 3$，$d_2 = 2$，$d_3 = 2$。\n\n初始基本模式，表示为 $p_1, p_2, p_3$，是“单尺寸最大填充”模式。\n- 模式 $p_1$：只切割尺寸为 $s_1=3$ 的物品。物品数量为 $\\lfloor L/s_1 \\rfloor = \\lfloor 17/3 \\rfloor = 5$。模式向量为 $a_{\\cdot 1} = (5, 0, 0)$。\n- 模式 $p_2$：只切割尺寸为 $s_2=4$ 的物品。物品数量为 $\\lfloor L/s_2 \\rfloor = \\lfloor 17/4 \\rfloor = 4$。模式向量为 $a_{\\cdot 2} = (0, 4, 0)$。\n- 模式 $p_3$：只切割尺寸为 $s_3=7$ 的物品。物品数量为 $\\lfloor L/s_3 \\rfloor = \\lfloor 17/7 \\rfloor = 2$。模式向量为 $a_{\\cdot 3} = (0, 0, 2)$。\n\n令 $x_p \\ge 0$ 为表示模式 $p$ 使用次数的决策变量。LP 松弛的 RMP 为：\n$$\n\\begin{align*}\n\\text{最小化} \\quad Z =  x_1 + x_2 + x_3 \\\\\n\\text{约束于} \\quad  5x_1 \\ge 3  (\\text{尺寸 3 的需求}) \\\\\n 4x_2 \\ge 2  (\\text{尺寸 4 的需求}) \\\\\n 2x_3 \\ge 2  (\\text{尺寸 7 的需求}) \\\\\n x_1, x_2, x_3 \\ge 0\n\\end{align*}\n$$\n为了最小化总和 $x_1+x_2+x_3$，我们必须为每个变量选择满足约束的最小值。这得到了 RMP 的最优原始解：\n$x_1^* = \\frac{3}{5}$，$x_2^* = \\frac{2}{4} = \\frac{1}{2}$，$x_3^* = \\frac{2}{2} = 1$。\n最优目标值为 $Z^* = \\frac{3}{5} + \\frac{1}{2} + 1 = \\frac{6}{10} + \\frac{5}{10} + \\frac{10}{10} = \\frac{21}{10}$。\n\n接下来，我们构建此 RMP 的对偶问题。令 $\\pi_1, \\pi_2, \\pi_3$ 为与三个需求约束相关的对偶变量。对偶问题为：\n$$\n\\begin{align*}\n\\text{最大化} \\quad W =  3\\pi_1 + 2\\pi_2 + 2\\pi_3 \\\\\n\\text{约束于} \\quad  5\\pi_1 \\le 1  (\\text{对应 } x_1 \\text{ 的对偶约束}) \\\\\n 4\\pi_2 \\le 1  (\\text{对应 } x_2 \\text{ 的对偶约束}) \\\\\n 2\\pi_3 \\le 1  (\\text{对应 } x_3 \\text{ 的对偶约束}) \\\\\n \\pi_1, \\pi_2, \\pi_3 \\ge 0\n\\end{align*}\n$$\n为了找到最优对偶变量，我们应用互补松弛性原理。相关条件指出，对于任何最优原始解变量 $x_p^* > 0$，其对应的对偶约束必须是紧的（即等式成立）。在我们的例子中，$x_1^* = \\frac{3}{5} > 0$，$x_2^* = \\frac{1}{2} > 0$，$x_3^* = 1 > 0$。因此，所有三个对偶约束在最优解处都必须是紧的：\n- $5\\pi_1^* = 1 \\implies \\pi_1^* = \\frac{1}{5}$\n- $4\\pi_2^* = 1 \\implies \\pi_2^* = \\frac{1}{4}$\n- $2\\pi_3^* = 1 \\implies \\pi_3^* = \\frac{1}{2}$\n这些值满足非负约束 $\\pi_i^* \\ge 0$。最优对偶变量，通常称为单纯形乘子或影子价格，是 $\\pi^* = (\\frac{1}{5}, \\frac{1}{4}, \\frac{1}{2})$。\n\n### 第 2 部分：定价子问题和简约成本\n\n列生成的下一步是寻找一个新的模式，如果将其添加到 RMP 中，可能会得到更好的解。我们寻找一个具有负简约成本 $\\bar{c}_p$ 的模式 $p$。一个模式 $p$（其向量为 $a_{\\cdot p} = (a_{1p}, a_{2p}, a_{3p})$）的简约成本由以下公式给出：\n$$ \\bar{c}_p = c_p - \\sum_{i=1}^3 \\pi_i^* a_{ip} $$\n其中 $c_p=1$ 是使用该模式的成本（一个卷材）。使用最优对偶价格，我们有：\n$$ \\bar{c}_p = 1 - \\left( \\frac{1}{5}a_{1p} + \\frac{1}{4}a_{2p} + \\frac{1}{2}a_{3p} \\right) $$\n为了找到具有最小简约成本的模式，我们必须找到一个能最大化数量 $\\sum_{i=1}^3 \\pi_i^* a_{ip}$ 的可行模式。这就是定价子问题。它可以被构建为一个整数背包问题：\n$$\n\\begin{align*}\n\\text{最大化} \\quad Z_{sub} =  \\frac{1}{5}a_1 + \\frac{1}{4}a_2 + \\frac{1}{2}a_3 \\\\\n\\text{约束于} \\quad  3a_1 + 4a_2 + 7a_3 \\le 17 \\\\\n a_1, a_2, a_3 \\in \\mathbb{Z}_{\\ge 0}\n\\end{align*}\n$$\n在这里，物品尺寸 $s_i$ 是“重量”，对偶价格 $\\pi_i^*$ 是“价值”，卷材长度 $L$ 是“背包容量”。\n\n我们求解这个整数背包问题。这可以通过动态规划来完成。令 $f(w)$ 为容量为 $w$ 时可实现的最大价值。我们需要计算 $f(17)$。递推关系是：\n$$ f(w) = \\max \\left\\{ f(w-3) + \\frac{1}{5}, f(w-4) + \\frac{1}{4}, f(w-7) + \\frac{1}{2} \\right\\} $$\n系统地求解此问题，或者对于一个小问题，通过检验，我们测试满足容量约束 $3a_1 + 4a_2 + 7a_3 \\le 17$ 的物品组合 $(a_1, a_2, a_3)$。\n- 模式 $(5,0,0)$：重量 $15$，价值 $5 \\times \\frac{1}{5} = 1$。\n- 模式 $(0,4,0)$：重量 $16$，价值 $4 \\times \\frac{1}{4} = 1$。\n- 模式 $(0,0,2)$：重量 $14$，价值 $2 \\times \\frac{1}{2} = 1$。\n- 模式 $(1,0,2)$：重量 $3(1)+7(2) = 17$，价值 $1 \\times \\frac{1}{5} + 2 \\times \\frac{1}{2} = \\frac{1}{5} + 1 = \\frac{6}{5}$。\n- 模式 $(3,0,1)$：重量 $3(3)+7(1) = 16$，价值 $3 \\times \\frac{1}{5} + 1 \\times \\frac{1}{2} = \\frac{3}{5} + \\frac{1}{2} = \\frac{11}{10}$。\n- 模式 $(2,1,1)$：重量 $3(2)+4(1)+7(1) = 6+4+7=17$，价值 $2 \\times \\frac{1}{5} + 1 \\times \\frac{1}{4} + 1 \\times \\frac{1}{2} = \\frac{2}{5} + \\frac{1}{4} + \\frac{1}{2} = \\frac{8+5+10}{20} = \\frac{23}{20}$。\n- 模式 $(0,2,1)$：重量 $4(2)+7(1)=15$，价值 $2 \\times \\frac{1}{4} + 1 \\times \\frac{1}{2} = \\frac{1}{2}+\\frac{1}{2}=1$。\n\n比较这些价值：\n$\\frac{6}{5} = 1.2$\n$\\frac{11}{10} = 1.1$\n$\\frac{23}{20} = 1.15$\n$1$\n\n最大值为 $Z_{sub}^* = \\frac{6}{5}$，通过模式 $a^* = (1, 0, 2)$ 实现。\n\n最后，我们使用这个最大值计算最小简约成本：\n$$ \\bar{c}_{min} = 1 - Z_{sub}^* = 1 - \\frac{6}{5} = \\frac{5}{5} - \\frac{6}{5} = -\\frac{1}{5} $$\n由于最小简约成本为负，当前的 LP 解对于完整的（无限制的）主问题不是最优的。模式 $(1,0,2)$ 是在列生成算法的下一次迭代中进入基的候选模式。问题只要求这个最小简约成本的值。", "answer": "$$\\boxed{-\\frac{1}{5}}$$", "id": "3108997"}]}