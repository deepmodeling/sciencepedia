{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式莫过于亲手实践。本练习将通过一个经典的发电设施规划问题，带你一步步走完 Benders 分解的完整流程。这个练习的核心是体验算法的迭代本质：你将从一个初始的主问题解出发，求解子问题，生成一个“最优性割平面” (optimality cut)，然后用这个割平面来优化主问题，周而复始，直到找到全局最优解。通过这个练习 [@problem_id:3101899]，你将掌握 Benders 分解算法的核心机制。", "problem": "考虑以下两机组发电规划问题，该问题被建模为一个混合整数线性规划 (MILP)。有两个潜在的发电机组，索引为 $i \\in \\{1,2\\}$，以及一个索引为 $i=0$ 的外部市场。系统必须满足 $D = 7$ 个单位的固定需求。如果发电机组 $i \\in \\{1,2\\}$ 投入运行（开启），它能以每单位 $c_i$ 的可变成本生产最多 $K_i$ 的电量，并产生固定的启停成本 $F_i$。外部市场能以每单位 $c_0$ 的可变成本提供无限供应，且无固定成本。为保证可靠性，至少必须有一台发电机组投入运行。数据如下：$K_1 = 4$，$K_2 = 6$，$c_1 = 3$，$c_2 = 5$，$c_0 = 9$，$F_1 = 8$，$F_2 = 6$。\n\n该混合整数线性规划 (MILP) 为：\n最小化总成本\n$$\n\\min_{y_1,y_2 \\in \\{0,1\\},\\, x_0,x_1,x_2 \\ge 0} \\; F_1 y_1 + F_2 y_2 + c_0 x_0 + c_1 x_1 + c_2 x_2\n$$\n约束条件为\n$$\nx_0 + x_1 + x_2 = D,\\quad x_1 \\le K_1 y_1,\\quad x_2 \\le K_2 y_2,\\quad y_1 + y_2 \\ge 1.\n$$\n\n您将应用 Benders 分解，将关于 $(y_1,y_2)$ 的二元主问题与关于 $(x_0,x_1,x_2)$ 的线性规划 (LP) 子问题分离。引入 Benders 主问题近似变量 $\\theta$，它代表在给定 $(y_1,y_2)$ 时子问题的最优值；主问题的目标函数是 $F_1 y_1 + F_2 y_2 + \\theta$。对于固定的 $(y_1,y_2)$，子问题是如下的线性规划 (LP)：\n$$\n\\min_{x_0,x_1,x_2 \\ge 0} \\; c_0 x_0 + c_1 x_1 + c_2 x_2 \\quad \\text{subject to} \\quad x_0 + x_1 + x_2 = D,\\; x_1 \\le K_1 y_1,\\; x_2 \\le K_2 y_2.\n$$\n\n任务：\n1) 从基本原理出发，利用线性规划 (LP) 对偶性构建子问题的对偶问题。明确指出对偶变量、它们的符号以及对偶可行性约束。\n\n2) 仅用约束 $\\theta \\ge 0$ 和 $y_1 + y_2 \\ge 1$ 来初始化 Benders 主问题。求解这个初始主问题以获得第一个候选启停决策 $y^{(0)} = (y_1^{(0)}, y_2^{(0)})$。\n\n3) 对于 $y^{(0)}$，求解子问题及其对偶问题至最优。使用最优对偶解 $(\\pi^{(0)}, u_1^{(0)}, u_2^{(0)})$，推导形式如下的相应 Benders 最优性割平面\n$$\n\\theta \\ge D \\,\\pi^{(k)} - K_1 \\, u_1^{(k)} \\, y_1 - K_2 \\, u_2^{(k)} \\, y_2,\n$$\n并将其添加到主问题中。\n\n4) 重新优化主问题得到 $y^{(1)}$，在 $y^{(1)}$ 处重新求解子问题和对偶问题，推导并添加下一个最优性割平面，然后再次重新优化主问题。\n\n5) 重复此过程，直到在当前解 $(y_1,y_2)$ 处主问题的 $\\theta$ 值等于子问题的最优值，从而证明已收敛到真实的最优目标值。在整个过程中，确保您用来生成割平面的每个对偶解对于子问题 LP 都是对偶可行的，以使该割平面全局有效。\n\n在这些数据下，原始 MILP 的最优总成本 $F_1 y_1^{\\star} + F_2 y_2^{\\star} + \\theta^{\\star}$ 是多少？以单个实数的形式给出您的最终答案。无需四舍五入。", "solution": "该问题要求解一个使用 Benders 分解法的两设施发电规划问题的最优总成本。该问题是一个混合整数线性规划 (MILP) 问题，包含二元启停变量 $(y_1, y_2)$ 和连续生产变量 $(x_0, x_1, x_2)$。\n\n首先，我们验证问题陈述的有效性。\n提取所有给定数据：\n- 需求：$D = 7$\n- 发电机容量：$K_1 = 4$, $K_2 = 6$\n- 可变成本：$c_1 = 3$, $c_2 = 5$, $c_0 = 9$ (外部市场)\n- 固定成本：$F_1 = 8$, $F_2 = 6$\nMILP 模型、Benders 分解结构、子问题模型以及最优性割平面的形式都已给出，并且在优化领域是标准的。该问题在运筹学中有科学依据，提法得当、客观，并包含一套完整且一致的数据和约束。未发现任何缺陷。该问题是有效的。\n\n求解过程遵循 Benders 分解算法的指定步骤。\n\n**1. 构建子问题的 LP 对偶**\n对于一个固定的整数向量 $\\bar{y} = (\\bar{y}_1, \\bar{y}_2)$，子问题为：\n$$\nQ(\\bar{y}) = \\min_{x_0, x_1, x_2 \\ge 0} \\; c_0 x_0 + c_1 x_1 + c_2 x_2\n$$\n约束条件为：\n$$\n\\begin{align*} x_0 + x_1 + x_2 = D  (\\text{对偶变量：} \\pi) \\\\ x_1 \\le K_1 \\bar{y}_1  (\\text{对偶变量：} u_1) \\\\ x_2 \\le K_2 \\bar{y}_2  (\\text{对偶变量：} u_2) \\end{align*}\n$$\n为了构建对偶问题，我们可以构建拉格朗日函数。对于一个最小化问题，我们为形如 $g(x) \\le 0$ 的约束引入非负的对偶乘子。我们将约束重写为 $D - (x_0+x_1+x_2) = 0$、$x_1 - K_1 \\bar{y}_1 \\le 0$ 和 $x_2 - K_2 \\bar{y}_2 \\le 0$。对应的拉格朗日函数及其对偶乘子 $\\pi$ (无符号限制)、$u_1 \\ge 0$ 和 $u_2 \\ge 0$ 为：\n$$\nL(x, \\pi, u_1, u_2) = (c_0 x_0 + c_1 x_1 + c_2 x_2) + \\pi(D - x_0 - x_1 - x_2) + u_1(x_1 - K_1 \\bar{y}_1) + u_2(x_2 - K_2 \\bar{y}_2)\n$$\n重新整理各项：\n$$\nL = (c_0 - \\pi)x_0 + (c_1 - \\pi + u_1)x_1 + (c_2 - \\pi + u_2)x_2 + D\\pi - K_1 \\bar{y}_1 u_1 - K_2 \\bar{y}_2 u_2\n$$\n对偶问题是 $\\max_{\\pi, u_1 \\ge 0, u_2 \\ge 0} \\inf_{x_0, x_1, x_2 \\ge 0} L(x, \\pi, u_1, u_2)$。为了使关于 $x$ 的下确界有界，非负变量 $x_i$ 的系数必须为非负。这就得出了对偶可行性约束：\n$$\nc_0 - \\pi \\ge 0 \\implies \\pi \\le c_0 \\\\\nc_1 - \\pi + u_1 \\ge 0 \\implies \\pi - u_1 \\le c_1 \\\\\nc_2 - \\pi + u_2 \\ge 0 \\implies \\pi - u_2 \\le c_2\n$$\n子问题的 LP 对偶是：\n$$\n\\max_{\\pi, u_1, u_2} \\quad D\\pi - K_1 \\bar{y}_1 u_1 - K_2 \\bar{y}_2 u_2\n$$\n约束条件为：\n$$\n\\begin{align*} \\pi \\le c_0 \\\\ \\pi - u_1 \\le c_1 \\\\ \\pi - u_2 \\le c_2 \\\\ u_1, u_2 \\ge 0 \\\\ \\pi \\text{ 无符号限制。} \\end{align*}\n$$\n对偶变量 $\\pi$ 对应需求等式约束， $u_1$ 对应发电机1的容量约束， $u_2$ 对应发电机2的容量约束。$u_1$ 和 $u_2$ 必须为非负。\n\n**2. Benders 分解：迭代 $k=0$**\n初始的 Benders 主问题是：\n$$\n\\min_{y_1, y_2 \\in \\{0,1\\}, \\theta} \\quad F_1 y_1 + F_2 y_2 + \\theta = 8 y_1 + 6 y_2 + \\theta\n$$\n约束条件为：\n$$\n\\begin{align*} y_1 + y_2 \\ge 1 \\\\ \\theta \\ge 0 \\end{align*}\n$$\n为了最小化目标函数，我们将 $\\theta$ 设为其可能的最小值 $\\theta=0$。然后我们寻找满足 $y_1+y_2 \\ge 1$ 且能最小化 $8y_1+6y_2$ 的 $(y_1, y_2)$ 组合。\n- 如果 $(y_1, y_2)=(1,0)$，成本为 $8(1)+6(0)=8$。\n- 如果 $(y_1, y_2)=(0,1)$，成本为 $8(0)+6(1)=6$。\n- 如果 $(y_1, y_2)=(1,1)$，成本为 $8(1)+6(1)=14$。\n最小值为 $6$。因此，初始主问题的解是 $y^{(0)} = (0,1)$ 和 $\\theta^{(0)}=0$。这给出了 MILP 最优目标的一个下界 $6$。\n\n**3. 针对 $y^{(0)}$ 的子问题求解与割平面生成**\n我们求解 $y^{(0)} = (0,1)$ 对应的子问题。该子问题是：\n$$\n\\min_{x_0, x_1, x_2 \\ge 0} \\quad 9 x_0 + 3 x_1 + 5 x_2\n$$\n约束条件为 $x_0 + x_1 + x_2 = 7$，$x_1 \\le 4(0)=0 \\implies x_1=0$，以及 $x_2 \\le 6(1)=6$。\n在 $x_1=0$ 的情况下，问题变为在 $x_0+x_2=7$ 和 $x_2 \\le 6$ 的约束下最小化 $9x_0 + 5x_2$。\n为了满足 $7$ 个单位的需求，我们使用成本更低的来源，即发电机2（成本为5），直至其容量上限：$x_2 = \\min(7, 6) = 6$。剩余的需求 $7-6=1$ 由市场满足：$x_0=1$。原始解为 $x^{(0)}=(1, 0, 6)$。\n子问题的最优值为 $Q(y^{(0)}) = 9(1) + 3(0) + 5(6) = 9 + 30 = 39$。\n这个可行解的总成本是 $F_1(0) + F_2(1) + Q(y^{(0)}) = 6 + 39 = 45$。这是 MILP 最优成本的一个上界。\n\n现在，我们为该子问题寻找最优对偶变量。结合原始解 $x^{(0)}=(1,0,6)$ 和对偶约束，使用互补松弛性：\n- $x_0 = 1 > 0 \\implies$ 对应于 $x_0$ 的对偶约束是紧的：$\\pi = c_0 = 9$。\n- $x_2 = 6 > 0 \\implies$ 对应于 $x_2$ 的对偶约束是紧的：$\\pi - u_2 = c_2 \\implies 9 - u_2 = 5 \\implies u_2 = 4$。\n- 对应于 $x_1$ 的对偶约束不需要是紧的。从 $\\pi - u_1 \\le c_1$ 可得 $9 - u_1 \\le 3 \\implies u_1 \\ge 6$。由于对于 $y^{(0)}=(0,1)$，对偶变量 $u_1$ 没有出现在对偶目标函数中（因为它乘以了 $\\bar{y}_1=0$），任何可行值都可以。一个最优对偶解是 $(\\pi^{(0)}, u_1^{(0)}, u_2^{(0)}) = (9, 6, 4)$。\n对偶目标值为 $D\\pi - K_2 y_2 u_2=7(9) - 6(1)(4) = 63 - 24 = 39$，与 $Q(y^{(0)})$ 相匹配。\n第一个 Benders 最优性割平面是：\n$$\n\\theta \\ge D \\pi^{(0)} - K_1 u_1^{(0)} y_1 - K_2 u_2^{(0)} y_2 \\implies \\theta \\ge 7(9) - 4(6)y_1 - 6(4)y_2 \\implies \\theta \\ge 63 - 24y_1 - 24y_2\n$$\n\n**4. Benders 分解：迭代 $k=1$**\n我们将新的割平面添加到主问题中：\n$$\n\\min_{y_1, y_2 \\in \\{0,1\\}, \\theta} \\quad 8 y_1 + 6 y_2 + \\theta\n$$\n约束条件为：\n$$\n\\begin{align*} y_1 + y_2 \\ge 1 \\\\ \\theta \\ge 0 \\\\ \\theta \\ge 63 - 24y_1 - 24y_2 \\end{align*}\n$$\n我们为每个可行的 $(y_1, y_2)$ 计算总目标值 $8y_1+6y_2+\\theta$：\n- 对于 $(y_1, y_2)=(1,0)$：$\\theta \\ge 63-24 = 39$。成本 = $8(1)+6(0)+39 = 47$。\n- 对于 $(y_1, y_2)=(0,1)$：$\\theta \\ge 63-24 = 39$。成本 = $8(0)+6(1)+39 = 45$。\n- 对于 $(y_1, y_2)=(1,1)$：$\\theta \\ge 63-48 = 15$。成本 = $8(1)+6(1)+15 = 14+15 = 29$。\n最小值为 $29$。新的主问题解是 $y^{(1)}=(1,1)$，$\\theta^{(1)}=15$。下界增加到 $29$。\n\n我们求解 $y^{(1)}=(1,1)$ 对应的子问题：\n$$\n\\min_{x_0, x_1, x_2 \\ge 0} \\quad 9 x_0 + 3 x_1 + 5 x_2\n$$\n约束条件为 $x_0 + x_1 + x_2 = 7$，$x_1 \\le 4$，$x_2 \\le 6$。\n我们首先加载成本最低的发电机：\n1. 使用发电机1（成本3）至其容量上限：$x_1=4$。剩余需求：$7-4=3$。\n2. 使用发电机2（成本5）满足剩余需求：$x_2=3$。\n原始解为 $x^{(1)}=(0, 4, 3)$。\n子问题成本为 $Q(y^{(1)}) = 9(0) + 3(4) + 5(3) = 12 + 15 = 27$。\n总成本为 $F_1(1) + F_2(1) + Q(y^{(1)}) = 8+6+27 = 41$。这将上界更新为 $41$。\n由于 $\\theta^{(1)}=15  Q(y^{(1)})=27$，我们还没有完成。我们生成一个新的割平面。\n根据 $x^{(1)}=(0,4,3)$ 得到 $y^{(1)}=(1,1)$ 对应的对偶变量：\n- $x_2=3  6 \\implies$ 发电机2的容量约束不是紧的，所以 $u_2=0$。\n- $x_1=4>0 \\implies \\pi-u_1=c_1=3$。\n- $x_2=3>0 \\implies \\pi-u_2=c_2=5$。由于 $u_2=0$，这给出 $\\pi=5$。\n- 从 $\\pi-u_1=3$ 可得 $5-u_1=3 \\implies u_1=2$。\n对偶解为 $(\\pi^{(1)}, u_1^{(1)}, u_2^{(1)}) = (5, 2, 0)$。\n对偶目标值为 $7(5) - 4(1)(2) - 6(1)(0) = 35-8=27$，与 $Q(y^{(1)})$ 相匹配。\n新的 Benders 割平面是：\n$$\n\\theta \\ge D \\pi^{(1)} - K_1 u_1^{(1)} y_1 - K_2 u_2^{(1)} y_2 \\implies \\theta \\ge 7(5) - 4(2)y_1 - 6(0)y_2 \\implies \\theta \\ge 35 - 8y_1\n$$\n\n**5. Benders 分解：迭代 $k=2$ 与收敛**\n我们将第二个割平面添加到主问题中：\n$$\n\\min_{y_1, y_2 \\in \\{0,1\\}, \\theta} \\quad 8 y_1 + 6 y_2 + \\theta\n$$\n约束条件为：\n$$\n\\begin{align*} y_1 + y_2 \\ge 1 \\\\ \\theta \\ge 0 \\\\ \\theta \\ge 63 - 24y_1 - 24y_2  (\\text{割平面 1}) \\\\ \\theta \\ge 35 - 8y_1  (\\text{割平面 2}) \\end{align*}\n$$\n我们为每个可行的 $(y_1, y_2)$ 计算总目标值 $8y_1+6y_2+\\theta$：\n- 对于 $(y_1, y_2)=(1,0)$：$\\theta \\ge \\max(63-24, 35-8) = \\max(39, 27) = 39$。成本 = $8+0+39 = 47$。\n- 对于 $(y_1, y_2)=(0,1)$：$\\theta \\ge \\max(63-24, 35-0) = \\max(39, 35) = 39$。成本 = $0+6+39 = 45$。\n- 对于 $(y_1, y_2)=(1,1)$：$\\theta \\ge \\max(63-48, 35-8) = \\max(15, 27) = 27$。成本 = $8+6+27 = 41$。\n最小值为 $41$。新的主问题解是 $y^{(2)}=(1,1)$，$\\theta^{(2)}=27$。下界现在是 $41$。\n当前下界 ($41$) 等于当前最优上界（由解 $y=(1,1)$ 得到，成本为 $41$）。因此，算法已收敛。\n最优启停决策是 $y^{\\star}=(1,1)$。对应于此决策的子问题最优值是 $Q(y^{\\star})=27$。最优总成本是 $F_1 y^{\\star}_1 + F_2 y^{\\star}_2 + Q(y^{\\star}) = 8(1) + 6(1) + 27 = 41$。\n\n最后检查：在最后一次迭代中，主问题给出 $y^{(2)}=(1,1)$ 和 $\\theta^{(2)}=27$。我们检查收敛条件：$Q(y^{(2)}) \\le \\theta^{(2)}$ 是否成立？我们有 $Q(1,1)=27$ 和 $\\theta^{(2)}=27$。条件 $27 \\le 27$ 成立。过程终止。\n\n最优总成本为 $41$。", "answer": "$$\n\\boxed{41}\n$$", "id": "3101899"}, {"introduction": "在第一个练习中，我们遇到的子问题总是有解的。但如果主问题给出的决策导致子问题无解（即不可行）怎么办？这个练习 [@problem_id:3101858] 专门解决这个问题。我们将探讨一种“纯可行性”问题，其中子问题的唯一作用就是检验可行性。当子问题不可行时，我们会学习如何利用其对偶问题的极端射线 (extreme rays) 来生成“可行性割平面” (feasibility cut)，从而将不可行的决策区域从主问题中排除。", "problem": "考虑一个适用于Benders分解的两阶段纯可行性问题，其中主问题控制一个决策向量 $y \\in \\mathbb{R}^{2}$，子问题检查一个关于单一辅助变量 $x \\in \\mathbb{R}$ 的线性系统的可行性。主决策集为方盒区域 $Y = \\{ y \\in \\mathbb{R}^{2} \\mid 0 \\leq y_{1} \\leq 2,\\ 0 \\leq y_{2} \\leq 2 \\}$，主问题的目标是最小化线性函数 $y_{1} + y_{2}$。对于给定的 $y$，子问题是关于 $x$ 的一组线性约束：\n$$\nx \\geq 2 - y_{1},\\qquad x \\geq 2 - y_{2},\\qquad x \\leq 1,\\qquad x \\geq 0.\n$$\n该子问题仅强制可行性，没有目标函数。从初始主问题试探点 $y^{0} = (0, 0)$ 开始。\n\n仅使用由子问题对偶问题的极射线生成的可行性割，构建排除不可行 $y$ 的割平面，并求解主问题。从几何上将这些割平面解释为半空间，其外法线对应于对偶锥的极射线，并将得到的 $y$ 的更新视为 $y^{0}$ 在使子问题可行的 $y$ 的多面体区域上的欧几里得投影。计算初始点 $y^{0}$ 与仅使用可行性割找到的主问题解 $y^{\\star}$ 之间的欧几里得距离 $\\|y^{\\star} - y^{0}\\|_{2}$。\n\n将最终距离精确地表示为单个实数值或单个闭式解析表达式，不进行舍入且不带单位。", "solution": "该问题被认为是有效的，因为它具有科学依据、良定、客观且自洽。它展示了Benders分解在两阶段线性可行性问题中的一个标准应用。\n\n该问题要求我们使用Benders分解来求解一个两阶段优化问题。主问题涉及最小化向量 $y \\in \\mathbb{R}^2$ 的一个函数，而子问题则为给定的 $y$ 检查一个线性不等式系统的可行性。\n\n主问题是：\n$$\n\\min_{y \\in Y} y_{1} + y_{2}\n$$\n其中主决策集是 $Y = \\{ y \\in \\mathbb{R}^{2} \\mid 0 \\leq y_{1} \\leq 2,\\ 0 \\leq y_{2} \\leq 2 \\}$。\n\n对于一个固定的 $y$，子问题是找到一个满足以下约束的标量 $x \\in \\mathbb{R}$：\n1. $x \\geq 2 - y_{1}$\n2. $x \\geq 2 - y_{2}$\n3. $x \\leq 1$\n4. $x \\geq 0$\n\n这个不等式系统可以重写为找到一个 $x$ 使得 $\\max(2 - y_{1}, 2 - y_{2}, 0) \\leq x \\leq 1$。这样的 $x$ 存在的充要条件是下界小于或等于上界，即 $\\max(2 - y_{1}, 2 - y_{2}, 0) \\leq 1$。这个单一条件等价于以下条件集：\n- $2 - y_{1} \\leq 1 \\implies y_{1} \\geq 1$\n- $2 - y_{2} \\leq 1 \\implies y_{2} \\geq 1$\n- $0 \\leq 1$ （这总是成立的）\n\n因此，子问题是可行的当且仅当 $y_{1} \\geq 1$ 且 $y_{2} \\geq 1$。我们将使用Benders可行性割来正式推导这些条件。\n\nBenders分解算法从初始试探点 $y^{0} = (0, 0)$ 开始。我们将此点代入子问题约束中：\n$x \\geq 2 - 0 = 2$\n$x \\geq 2 - 0 = 2$\n$x \\leq 1$\n$x \\geq 0$\n这简化为 $2 \\leq x \\leq 1$，这是不可能的。子问题是不可行的。因此，我们必须生成一个或多个可行性割。\n\nBenders可行性割是从可行性子问题的对偶问题的一个极射线推导出来的。让我们将子问题写成标准形式 $Ax \\leq b(y)$：\n$-x \\leq y_{1} - 2$\n$-x \\leq y_{2} - 2$\n$x \\leq 1$\n$-x \\leq 0$\n这可以写成：\n$$\n\\begin{pmatrix} -1 \\\\ -1 \\\\ 1 \\\\ -1 \\end{pmatrix} x \\leq \\begin{pmatrix} y_{1} - 2 \\\\ y_{2} - 2 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n根据Farkas引理，该系统不可行的充要条件是存在一个向量 $u \\geq 0$ 使得 $u^T A = 0$ 且 $u^T b(y)  0$。一个Benders可行性割施加了可行性的必要条件，即对于对偶锥 $\\{u \\ge 0 \\mid u^T A=0\\}$ 的所有极射线 $u$，都有 $u^T b(y) \\geq 0$。\n\n设 $u = (u_{1}, u_{2}, u_{3}, u_{4})^T$。条件 $u \\ge 0$ 意味着对于 $i=1,2,3,4$ 有 $u_i \\ge 0$。条件 $u^T A = 0$ 是：\n$$\n\\begin{pmatrix} u_{1}  u_{2}  u_{3}  u_{4} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -1 \\\\ 1 \\\\ -1 \\end{pmatrix} = -u_{1} - u_{2} + u_{3} - u_{4} = 0\n$$\n这可以重排为 $u_{3} = u_{1} + u_{2} + u_{4}$。这个锥的极射线可以通过将独立变量（$u_{1}, u_{2}, u_{4}$）中除一个之外的所有变量都设为零来找到。\n1. 设 $u_{1}=1, u_{2}=0, u_{4}=0$：这得到 $u_{3}=1$。射线是 $u^{(1)} = (1, 0, 1, 0)^T$。\n2. 设 $u_{1}=0, u_{2}=1, u_{4}=0$：这得到 $u_{3}=1$。射线是 $u^{(2)} = (0, 1, 1, 0)^T$。\n3. 设 $u_{1}=0, u_{2}=0, u_{4}=1$：这得到 $u_{3}=1$。射线是 $u^{(3)} = (0, 0, 1, 1)^T$。\n\n这些射线生成了可行性割 $(u^{(i)})^T b(y) \\geq 0$。向量 $b(y)$ 是 $(y_{1} - 2, y_{2} - 2, 1, 0)^T$。\n\n来自 $u^{(1)}$ 的割：\n$$\n(u^{(1)})^T b(y) = 1(y_{1} - 2) + 0(y_{2} - 2) + 1(1) + 0(0) = y_{1} - 1 \\geq 0 \\implies y_{1} \\geq 1\n$$\n来自 $u^{(2)}$ 的割：\n$$\n(u^{(2)})^T b(y) = 0(y_{1} - 2) + 1(y_{2} - 2) + 1(1) + 0(0) = y_{2} - 1 \\geq 0 \\implies y_{2} \\geq 1\n$$\n来自 $u^{(3)}$ 的割：\n$$\n(u^{(3)})^T b(y) = 0(y_{1} - 2) + 0(y_{2} - 2) + 1(1) + 1(0) = 1 \\geq 0\n$$\n第三个割 $1 \\geq 0$ 是平凡的，不增加任何限制。两个非平凡的可行性割是 $y_{1} \\geq 1$ 和 $y_{2} \\geq 1$。\n\n我们现在将这些割添加到主问题中，以形成完整的主问题：\n$$\n\\min_{y} \\quad y_{1} + y_{2}\n$$\n约束条件为：\n$$\n0 \\leq y_{1} \\leq 2 \\\\\n0 \\leq y_{2} \\leq 2 \\\\\ny_{1} \\geq 1 \\\\\ny_{2} \\geq 1\n$$\n结合这些约束，$y$ 的可行域变为 $1 \\leq y_{1} \\leq 2$ 和 $1 \\leq y_{2} \\leq 2$。目标函数 $y_{1} + y_{2}$ 要在这个正方形区域上最小化。该线性函数的最小值将在可行域的角点处取得，即 $y_{1}$ 和 $y_{2}$ 最小的点。这个点是 $(y_{1}, y_{2}) = (1, 1)$。\n因此，最优解是 $y^{\\star} = (1, 1)$。\n\n从几何上看，割平面 $y_{1} \\geq 1$ 和 $y_{2} \\geq 1$ 定义了两个半空间。它们的交集构成了子问题的可行域。初始试探点 $y^0 = (0,0)$ 在此区域之外。问题中提到将解 $y^\\star$ 解释为 $y^0$ 在可行域上的欧几里得投影。$y$ 的可行域是正方形 $[1, 2] \\times [1, 2]$。点 $(0,0)$ 在这个正方形上的投影确实是 $(1,1)$，这与我们的解 $y^{\\star}$ 相符。发生这种情况是因为对于这个特定问题，目标函数和约束是以一种特殊的方式构造的。\n\n最后，我们计算初始点 $y^{0}=(0, 0)$ 和解 $y^{\\star}=(1, 1)$ 之间的欧几里得距离：\n$$\n\\| y^{\\star} - y^{0} \\|_{2} = \\| (1, 1) - (0, 0) \\|_{2} = \\| (1, 1) \\|_{2} = \\sqrt{1^{2} + 1^{2}} = \\sqrt{2}\n$$\n所求距离为 $\\sqrt{2}$。", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "3101858"}, {"introduction": "掌握了最优性割平面和可行性割平面的生成方法后，让我们通过一个特殊的例子来深化对 Benders 分解几何本质的理解。在这个练习 [@problem_id:3101945] 中，你将遇到一个算法仅需一步迭代即可收敛的“退化”情况。通过分析其背后的原因，你将直观地看到 Benders 割平面作为子问题值函数支撑超平面的本质，从而对整个算法的工作原理形成更深刻的几何直觉。", "problem": "考虑以下适用于 Benders 分解的两阶段可分线性优化模型。第一阶段（主问题）的决策变量为 $y \\in \\mathbb{R}$，可行集为 $0 \\le y \\le 2$，第一阶段成本为 $2y$。第二阶段（追索）问题，以 $y$ 为参数，具有单个决策变量 $x \\in \\mathbb{R}_{+}$，并由以下线性规划（LP）子问题定义\n$$\nQ(y) \\equiv \\min_{x \\ge 0} \\left\\{ x \\,\\middle|\\, x \\ge 3 - y \\right\\}.\n$$\n因此，完整问题是\n$$\n\\min_{0 \\le y \\le 2} \\left\\{ 2y + Q(y) \\right\\}.\n$$\n你的任务是：\n- 仅使用线性优化的基本事实，推导追索函数 $Q(y)$ 的对偶表示，并将其刻画为支撑超平面的逐点上确界。\n- 从几何第一性原理出发，构建并解释为何在此模型中，函数 $Q(y)$ 在 $y$ 的整个可行集上与单个支撑超平面重合，以及为何这意味着在任何初始 $y^{0} \\in [0,2]$ 处获得的第一个 Benders 切割已然是最优的（退化情况）。\n- 构建单一切割的 Benders 主问题并精确求解。\n- 计算原始两阶段问题的最优目标值。将此最终答案以单个实数形式提供。无需四舍五- 入。", "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤1：提取已知条件\n-   第一阶段决策变量：$y \\in \\mathbb{R}$\n-   第一阶段可行集：$0 \\le y \\le 2$\n-   第一阶段成本：$2y$\n-   第二阶段决策变量：$x \\in \\mathbb{R}_{+}$\n-   第二阶段子问题（追索函数）：$Q(y) \\equiv \\min_{x \\ge 0} \\{ x \\mid x \\ge 3 - y \\}$\n-   完整问题目标：$\\min_{0 \\le y \\le 2} \\{ 2y + Q(y) \\}$\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题是一个定义明确的两阶段线性优化问题。它是运筹学和优化理论领域的标准表述。所有概念在数学上和科学上都是合理的。\n-   **适定性：** 该问题是一个凸优化问题，因为目标函数 $2y + Q(y)$ 是一个线性函数（$2y$）和一个凸函数（$Q(y)$，它是一个线性规划的值函数）的和。$y$ 的可行集是一个紧区间 $[0, 2]$。紧集上的连续凸函数必达到其最小值。因此，存在唯一且有意义的解。\n-   **客观性：** 问题使用精确、无歧义的数学语言陈述。没有主观或基于观点的陈述。\n-   **其他缺陷：** 问题是自洽的，没有缺失或矛盾的信息。它与 Benders 分解的主题直接相关。问题并非微不足道，因为它需要该方法的专门知识。问题的设置并非不切实际或不适定。\n\n### 步骤3：结论与行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n### 解题推导\n\n#### 任务1：追索函数 $Q(y)$ 的对偶表示\n\n第二阶段（追索）问题由下式给出：\n$$\nQ(y) \\equiv \\min_{x} \\{ 1 \\cdot x \\mid x \\ge 3 - y, x \\ge 0 \\}\n$$\n这是一个关于变量 $x$ 的线性规划（LP）。为了找到其对偶表示，我们首先将其写成标准形式。我们为约束 $x \\ge 3 - y$ 引入对偶变量 $\\pi_1$，为非负约束 $x \\ge 0$ 引入对偶变量 $\\pi_2$。原线性规划是：\n$$\n\\text{(Primal)} \\quad \\min_{x} \\quad 1 \\cdot x\n$$\n$$\n\\text{subject to:} \\quad 1 \\cdot x \\ge 3 - y\n$$\n$$\n\\quad 1 \\cdot x \\ge 0\n$$\n对偶线性规划的构建方式是，最大化右侧项与对偶变量向量的内积，并服从对偶变量的约束。设 $\\pi = (\\pi_1, \\pi_2)$ 为对偶变量向量，由于原问题约束是 '$\\ge$' 类型，因此它们都是非负的。\n$$\n\\text{(Dual)} \\quad \\max_{\\pi_1, \\pi_2} \\quad (3-y)\\pi_1 + 0 \\cdot \\pi_2\n$$\n$$\n\\text{subject to:} \\quad 1 \\cdot \\pi_1 + 1 \\cdot \\pi_2 = 1\n$$\n$$\n\\quad \\pi_1 \\ge 0, \\pi_2 \\ge 0\n$$\n根据线性规划的强对偶性，原问题的最优值 $Q(y)$ 等于对偶问题的最优值。我们可以简化对偶问题。根据等式约束，有 $\\pi_2 = 1 - \\pi_1$。条件 $\\pi_2 \\ge 0$ 意味着 $1 - \\pi_1 \\ge 0$，因此 $\\pi_1 \\le 1$。条件 $\\pi_1 \\ge 0$ 已经给出。因此 $\\pi_1$ 的可行域为 $[0, 1]$。我们可以消去 $\\pi_2$，仅用 $\\pi_1$ 来写对偶问题（为简单起见，我们将其重命名为 $\\pi$）：\n$$\nQ(y) = \\max_{0 \\le \\pi \\le 1} \\{(3-y)\\pi\\}\n$$\n这就是追索函数 $Q(y)$ 的对偶表示。它将 $Q(y)$ 刻画为关于 $y$ 的一个无穷线性函数（支撑超平面）集合的逐点上确界，这些函数的形式为 $L_{\\pi}(y) = (3-y)\\pi$，其中每个 $\\pi \\in [0, 1]$。对偶变量 $\\pi$ 的可行集，记作 $\\Pi = [0, 1]$，是一个多面体（在本例中为一条线段）。该多面体的极点是 $\\pi=0$ 和 $\\pi=1$。对于线性规划，最优值在极点处达到。因此，我们可以将 $Q(y)$ 写为：\n$$\nQ(y) = \\max \\{ (3-y) \\cdot 0, (3-y) \\cdot 1 \\} = \\max \\{0, 3-y\\}\n$$\n\n#### 任务2：单一切割即为最优的 Benders 切割\n\nBenders 分解算法通过使用切割来迭代地构建 $Q(y)$ 的近似。在点 $y^k$ 处，利用子问题 $Q(y^k)$ 的一个最优对偶解 $\\pi^k$ 来生成一个最优性切割。该切割由支撑超平面 $\\theta \\ge (3-y)\\pi^k$ 给出，其中 $\\theta$ 是代表 $Q(y)$ 的上境图变量。\n\n我们来分析在可行域 $[0, 2]$ 中任意给定 $y$ 的最优对偶解 $\\pi^*$。对偶问题是 $\\max_{0 \\le \\pi \\le 1} \\{(3-y)\\pi\\}$。\n- $y$ 的可行集是 $[0, 2]$。\n- 对于任意 $y \\in [0, 2]$，项 $(3-y)$ 是严格为正的。具体来说，$3-y \\in [1, 3]$。\n- 为了最大化乘积 $(3-y)\\pi$，其中 $(3-y) > 0$ 且 $\\pi \\in [0, 1]$，我们必须选择 $\\pi$ 的最大可能值。\n- 因此，对于任意 $y \\in [0, 2]$，唯一的最优对偶解是 $\\pi^* = 1$。\n\n这对 Benders 分解有一个关键的启示。无论第一阶段问题选择何种初始 $y^0 \\in [0, 2]$，求解第二阶段子问题 $Q(y^0)$ 将总是得到相同的最优对偶解 $\\pi^0 = 1$。因此，生成的第一个 Benders 切割将总是：\n$$\n\\theta \\ge (3-y)\\pi^0 \\quad \\implies \\quad \\theta \\ge 3-y\n$$\n现在，我们来考察在定义域 $y \\in [0, 2]$ 上的实际函数 $Q(y)$。根据我们之前的推导，$Q(y) = \\max\\{0, 3-y\\}$。由于 $y \\in [0, 2]$，所以 $3-y \\ge 1 > 0$，因此最大值总是 $3-y$。因此，在 $y$ 的整个可行域上，追索函数恰好是 $Q(y) = 3-y$。\n\n从几何上看，函数 $Q(y)$ 是直线 $L_0(y) = 0$ 和 $L_1(y) = 3-y$ 的上包络线。这个分段线性函数的“拐点”出现在 $0 = 3-y$ 的地方，即 $y=3$。主问题的整个可行域 $y \\in [0, 2]$ 都位于这个拐点的左侧。在这个区域内，$Q(y)$ 不是分段线性的，而是纯线性的，与单个支撑超平面 $L_1(y) = 3-y$ 完全重合。\n\n因此，第一个 Benders 切割 $\\theta \\ge 3-y$ 不仅仅是 $Q(y)$ 的一个近似或下界，而是一个精确的表示：$\\theta \\ge Q(y)$。将这个切割添加到主问题中，就提供了关于第二阶段的所有必要信息。没有进一步的切割可以改进这一点，因此 Benders 算法在单次迭代中收敛。这是一个特殊情况（问题中称之为退化），算法的迭代特性坍缩为单个步骤。\n\n#### 任务3：单一切割的 Benders 主问题\n\n完整问题是 $\\min_{0 \\le y \\le 2} \\{2y + Q(y)\\}$。使用上境图变量 $\\theta$ 来代表 $Q(y)$，Benders 主问题初始为：\n$$\n\\min_{y, \\theta} \\quad 2y + \\theta\n$$\n$$\n\\text{subject to:} \\quad 0 \\le y \\le 2\n$$\n经过一次迭代，我们添加了单一切割，即最优切割 $\\theta \\ge 3-y$。主问题变为：\n$$\n\\min_{y, \\theta} \\quad 2y + \\theta\n$$\n$$\n\\text{subject to:} \\quad 0 \\le y \\le 2\n$$\n$$\n\\quad \\theta \\ge 3-y\n$$\n由于目标是最小化 $2y+\\theta$，而 $\\theta$ 只有一个下界，最优解将使切割约束取等号，即 $\\theta = 3-y$。我们可以将其代入目标函数以消去 $\\theta$：\n$$\n\\min_{0 \\le y \\le 2} \\{2y + (3-y)\\}\n$$\n这可以简化为：\n$$\n\\min_{0 \\le y \\le 2} \\{y + 3\\}\n$$\n目标函数 $f(y) = y+3$ 是关于 $y$ 的严格递增函数。为了在闭区间 $[0, 2]$ 上最小化该函数，我们必须选择 $y$ 的最小可能值，即 $y=0$。最优的第一阶段决策是 $y^* = 0$。\n\n#### 任务4：最优目标值\n\n原始两阶段问题的最优目标值可以通过将 $y^*=0$ 代回原始目标函数 $2y + Q(y)$ 来计算。\n首先，计算 $Q(y^*)$：\n$$\nQ(0) = \\max\\{0, 3-0\\} = 3\n$$\n然后，计算总成本：\n$$\n2y^* + Q(y^*) = 2(0) + 3 = 3\n$$\n或者，从单一切割主问题的解中，我们发现最小值为 $y^*+3 = 0+3=3$。\n原始问题的最优目标值为 $3$。", "answer": "$$\\boxed{3}$$", "id": "3101945"}]}