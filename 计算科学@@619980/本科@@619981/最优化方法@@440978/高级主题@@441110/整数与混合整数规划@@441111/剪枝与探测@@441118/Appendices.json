{"hands_on_practices": [{"introduction": "在分支定界法中，最直接的剪枝形式之一源于约束的逻辑推导。本练习将通过一个带有不相容约束的背包问题，向您展示分支决策（例如，将一个变量固定为1）如何通过约束传播立即确定另一个变量的值，从而在探索搜索树的早期就减少其分支。这个过程被称为逻辑剪枝或预处理，是现代求解器效率的关键。[@problem_id:3128341]", "problem": "考虑以下带有一个不相容约束的 0-1 二进制背包问题。现有 $5$ 个物品，每个物品有其利润 $p_i$ 和重量 $w_i$，以及一个背包容量 $C$。决策变量 $x_i \\in \\{0,1\\}$ 表示是否选择物品 $i$。数据如下：\n$$\nC = 10, \\quad (p_1, p_2, p_3, p_4, p_5) = (8, 12, 7, 14, 6), \\quad (w_1, w_2, w_3, w_4, w_5) = (4, 5, 3, 7, 2).\n$$\n优化模型为\n$$\n\\max \\ \\sum_{i=1}^{5} p_i x_i \\quad \\text{subject to} \\quad \\sum_{i=1}^{5} w_i x_i \\le C, \\quad x_i \\in \\{0,1\\} \\ \\text{for all} \\ i,\n$$\n以及不相容约束\n$$\nx_2 + x_3 \\le 1.\n$$\n一个分支定界 (B&B) 算法使用线性规划 (LP) 松弛（即将 $x_i \\in \\{0,1\\}$ 替换为 $0 \\le x_i \\le 1$）来计算节点界。在根节点处，对 $x_2$ 进行分支，并考虑 $x_2 = 1$ 的子节点。在此节点的 LP 松弛中使用不相容约束，推导出 $x_3$ 必须满足的收紧变量界，并解释为什么设置 $x_3 = 1$ 的直接子分支会被剪枝（fathomed）而无需进一步探索。\n\n以单个实数的形式报告在 $x_2 = 1$ 的节点处 $x_3$ 的收紧上界。无需四舍五入。", "solution": "该问题要求分析应用于带有一个额外不相容约束的 0-1 背包问题的分支定界 (B&B) 算法中的一个特定节点。目标是确定一个收紧的变量界，并基于约束传播解释一个剪枝步骤。\n\n优化问题公式化为：\n$$\n\\max \\ \\sum_{i=1}^{5} p_i x_i\n$$\n满足约束：\n$$\n\\sum_{i=1}^{5} w_i x_i \\le C \\quad (1)\n$$\n$$\nx_2 + x_3 \\le 1 \\quad (2)\n$$\n$$\nx_i \\in \\{0, 1\\} \\quad \\text{for } i = 1, \\dots, 5 \\quad (3)\n$$\n所提供的数据为 $C = 10$、$(p_1, p_2, p_3, p_4, p_5) = (8, 12, 7, 14, 6)$ 和 $(w_1, w_2, w_3, w_4, w_5) = (4, 5, 3, 7, 2)$。\n\nB&B 算法采用问题的线性规划 (LP) 松弛，其中二进制约束 $x_i \\in \\{0, 1\\}$ 被松弛为连续约束 $0 \\le x_i \\le 1$。\n\n题目要求我们分析从根节点通过对变量 $x_2$ 分支并将其值设为 $1$ 所创建的子节点。在此节点，约束 $x_2 = 1$ 被添加到 LP 松弛的约束集中。\n\n在此节点确定 $x_3$ 的界的相关约束集包括：\n1. 原始不相容约束：$x_2 + x_3 \\le 1$。\n2. 根节点 LP 松弛中 $x_3$ 的界：$0 \\le x_3 \\le 1$。\n3. 定义当前节点的新分支约束：$x_2 = 1$。\n\n为了推导出 $x_3$ 的收紧变量界，我们将分支约束 $x_2 = 1$ 代入不相容约束 $(2)$ 中：\n$$\n1 + x_3 \\le 1\n$$\n在该不等式两边减去 $1$，我们得到 $x_3$ 的一个新上界：\n$$\nx_3 \\le 0\n$$\n从基础 LP 松弛中，我们还有非负约束 $x_3 \\ge 0$。一个变量必须同时满足所有激活的约束。因此，$x_3$ 必须同时满足 $x_3 \\le 0$ 和 $x_3 \\ge 0$。唯一满足这两个条件的实数是 $x_3 = 0$。\n\n这意味着在 $x_2 = 1$ 的节点，变量 $x_3$ 被固定为值 $0$。原始界 $0 \\le x_3 \\le 1$ 被收紧为 $0 \\le x_3 \\le 0$。因此，在此节点 $x_3$ 的收紧上界是 $0$。\n\n问题的第二部分要求解释为什么设置 $x_3=1$ 的后续分支会被剪枝（fathomed）。如果我们从当前节点（$x_2 = 1$）通过添加约束 $x_3 = 1$ 来创建一个子节点，那么这个新节点的子问题将由包括以下内容的约束集定义：\n*   $x_2 = 1$（来自父节点的分支）\n*   $x_3 = 1$（来自新分支）\n*   $x_2 + x_3 \\le 1$（来自原始问题公式）\n\n将 $x_2$ 和 $x_3$ 的值代入不相容约束，得到：\n$$\n1 + 1 \\le 1\n$$\n$$\n2 \\le 1\n$$\n这个结果是一个矛盾，这意味着在这个假设节点上 LP 松弛的可行集是空的。子问题不可行的节点不能包含任何可行的整数解。在 B&B 算法中，这类节点会因不可行性而被剪枝。这是一种逻辑预处理或约束传播的形式，它阻止算法探索一个保证不会导向可行解的分支。\n\n在 $x_2=1$ 的节点上，$x_3$ 的收紧上界是 $0$。", "answer": "$$\\boxed{0}$$", "id": "3128341"}, {"introduction": "剪枝不仅发生在找到更优解时，当一个分支被证明不包含任何可行解时，也会发生剪枝。本练习演示了一种称为“域过滤”（domain filtering）的强大技术，在该技术中，我们利用现有约束和变量边界来收紧其他变量的取值范围。通过这种推理，我们可以提前证明某个分支是不可行的，从而避免了对整个子树的徒劳探索。[@problem_id:3128339]", "problem": "考虑一个分支定界（B&B）过程中的混合整数线性规划（MILP）子问题，其决策变量为 $x$，$y$ 和 $z$。变量 $x$ 是整数，变量 $y$ 和 $z$ 是连续的。当前节点的初始定义域界限为 $x \\in [0,10] \\cap \\mathbb{Z}$，$y \\in [0,4]$ 以及 $z \\in [0,5]$。该节点受以下线性约束的限制：\n$$3x + y \\geq 28,$$\n$$x + 2y + z \\leq 20,$$\n$$y + z \\leq 6.$$\n从线性不等式和可行集的基本性质出发，仅使用 $y$ 的界限和不等式 $3x + y \\geq 28$ 对 $x$ 应用定义域过滤，推导出一个对于该节点任何可行解都必须成立的 $x$ 的收紧界限。然后，假设求解器在当前节点上对 $x$ 使用二元分支，创建两个子节点，其析取条件分别为 $x \\leq 7$（左子节点）和 $x \\geq 8$（右子节点）。使用推导出的界限来确定左子节点的可行性状态。\n\n假设求解器对左子节点有一个固定的后续分支计划：如果左子节点没有被立即剪枝，它将在下一步对 $y$ 进行分支，使用析取条件 $y \\leq 2$ 和 $y \\geq 3$，然后在下一层对每个 $y$-子节点再对 $z$ 进行分支，使用析取条件 $z \\leq 1$ 和 $z \\geq 2$。通过计算因左子节点在创建时被定义域过滤证明为不可行而移除的节点总数，来量化剪枝级联效应。这个计数包括左子节点本身以及在此固定分支计划下本应创建的所有后代节点。将你的最终答案表示为一个实数。无需四舍五入。", "solution": "该问题要求对分支定界（B&B）框架内的一个混合整数线性规划（MILP）子问题进行三部分分析。首先，我们必须推导出整数变量 $x$ 的一个收紧界限。其次，我们使用这个界限来确定一个子节点的可行性。第三，我们量化因此可行性分析而被剪枝的节点数量。\n\n当前B&B节点给定的变量及其初始定义域为：\n- $x \\in [0, 10] \\cap \\mathbb{Z}$ (整数)\n- $y \\in [0, 4]$ (连续)\n- $z \\in [0, 5]$ (连续)\n\n线性约束为：\n$$3x + y \\geq 28$$\n$$x + 2y + z \\leq 20$$\n$$y + z \\leq 6$$\n\n第1部分：对$x$进行定义域过滤。\n问题要求仅使用不等式 $3x + y \\geq 28$ 和 $y$ 的定义域对 $x$ 应用定义域过滤。我们首先在此不等式中分离出 $x$：\n$$3x \\geq 28 - y$$\n$$x \\geq \\frac{28 - y}{3}$$\n对于任何可行解 $(x, y, z)$，此不等式都必须成立。为了找到对该节点任何可行点都普遍成立的关于 $x$ 的最紧可能下界，我们必须找到右侧表达式的最小值。项 $\\frac{28 - y}{3}$ 是 $y$ 的单调递减函数。因此，当 $y$ 取其最大值时，该项达到其最小值。\n$y$ 的定义域为区间 $[0, 4]$。因此 $y$ 的最大值为 $y_{\\text{max}} = 4$。\n将此值代入关于 $x$ 的不等式中：\n$$x \\geq \\frac{28 - y_{\\text{max}}}{3}$$\n$$x \\geq \\frac{28 - 4}{3}$$\n$$x \\geq \\frac{24}{3}$$\n$$x \\geq 8$$\n由于 $x$ 是一个整数变量，这意味着对于当前节点的任何可行解，$x$ 必须是大于或等于 $8$ 的整数。$x$ 的初始定义域为 $x \\in \\{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10\\}$。推导出的条件 $x \\geq 8$ 将此定义域收紧为 $x \\in [8, 10] \\cap \\mathbb{Z}$，即 $x \\in \\{8, 9, 10\\}$。\n\n第2部分：左子节点的可行性状态。\n求解器对变量 $x$ 进行分支，创建两个子节点。左子节点是通过在父节点的约束集中添加约束 $x \\leq 7$ 来定义的。右子节点是通过添加约束 $x \\geq 8$ 来定义的。\n为了确定左子节点的可行性，我们必须考虑其所有约束。这些约束包括从父节点继承的约束和新的分支约束。在第1部分中，我们确定了父节点问题的任何可行解都必须满足 $x \\geq 8$。左子节点施加了附加约束 $x \\leq 7$。\n因此，左子节点的可行解必须同时满足 $x \\geq 8$ 和 $x \\leq 7$。没有整数 $x$ 能够同时满足这两个相互矛盾的条件。整数集合 $\\{x \\in \\mathbb{Z} \\mid x \\geq 8\\}$ 和 $\\{x \\in \\mathbb{Z} \\mid x \\leq 7\\}$ 的交集是空集。\n因此，左子节点的可行域是空的。这意味着该节点不可行，可以在其创建时立即从B&B树中剪枝（探尽）。\n\n第3部分：量化剪枝级联效应。\n当一个节点被剪枝时，算法不会探索其任何潜在的后代节点。问题要求我们量化因左子节点被证明不可行而从搜索中移除的节点总数。这个计数包括左子节点本身，以及根据指定固定分支计划本应由它生成的所有后代节点。\n\n以左子节点为根的子树的分支计划如下：\n1.  左子节点本身构成了这个被剪枝子树的根。这是 $1$ 个节点。\n2.  如果没有被剪枝，下一级别的分支将对变量 $y$ 进行，创建 $2$ 个子节点（一个对应 $y \\leq 2$，另一个对应 $y \\geq 3$）。\n3.  如果这些节点没有被剪枝，下一级别的分支将对变量 $z$ 进行。对于上一级别的每个节点，此分支会创建 $2$ 个新子节点（一个对应 $z \\leq 1$，另一个对应 $z \\geq 2$）。这导致在这一级别产生 $2 \\times 2 = 4$ 个节点。\n\n整个被剪枝的子树由这三个级别的节点组成。被剪枝的节点总数是每个级别节点数的总和：\n- 第 $0$ 层（左子节点）：$1$ 个节点。\n- 第 $1$ 层（由 $y$-分支产生的子节点）：$2$ 个节点。\n- 第 $2$ 层（由 $z$-分支产生的子节点）：$4$ 个节点。\n\n移除的节点总数 = $1 + 2 + 4 = 7$。\n这就是剪枝级联的规模。在左子节点创建时证明其不可行性，节省了创建和处理所有这 $7$ 个节点的计算开销。", "answer": "$$\n\\boxed{7}\n$$", "id": "3128339"}, {"introduction": "分支定界法的威力在于其将定界（通过LP松弛）与分支和剪枝紧密结合。本练习将介绍一种更高级的剪枝技术，它利用LP松弛的对偶信息——即“判别数”（reduced costs）——来指导决策。您将学习如何通过比较判别数与当前最优解和LP界之间的差距，来证明某个分支不可能产生更优的解，从而在不重新求解LP的情况下固定变量并更新节点的下界。[@problem_id:3128375]", "problem": "考虑一个形式为 $\\min \\{ c^{\\top} x : A x \\ge b, \\ x \\in \\{0,1\\}^n \\}$ 的 $0$-$1$ 整数线性规划（ILP），该规划正在使用分支定界法（B&B）求解。在某个特定节点，求解了线性规划（LP）松弛问题，得到最优目标值为 $z^{*}_{\\mathrm{LP}} = 132.4$。一个当前最优的可行整数解的目标值为 $U = 140.6$。在此节点的当前最优LP基中，变量 $x_3$ 和 $x_7$ 是值为 $0$ 的非基变量，其判别数分别为 $\\bar{c}_3 = 9.1$ 和 $\\bar{c}_7 = 8.3$。该模型包含覆盖约束 $x_3 + x_7 \\ge 1$。\n\n使用通过高级判别数进行变量固定的原理，在节点上剪掉了分支 $x_3 = 1$ 并固定了 $x_3 = 0$。然后，根据覆盖约束的逻辑传播，可推断出 $x_7$ 必须为 $1$。仅基于LP判别数的推理（在固定变量后不重新优化LP），确定此次传播后该节点目标值的更新有效下界。\n\n将你的最终答案表示为一个实数，并四舍五入到四位有效数字。", "solution": "问题场景为：在一个分支定界（B&B）节点上，处理一个最小化 $0$-$1$ 整数线性规划（ILP）及其线性规划（LP）松弛。我们使用的基本概念如下：\n\n1. LP松弛的目标值 $z^{*}_{\\mathrm{LP}}$ 是该节点上最小化ILP问题的一个有效下界。\n2. 对于一个给定的最优LP基，其约束对应的对偶乘子为 $\\pi$，非基变量 $x_i$ 的判别数定义为\n$$\n\\bar{c}_i = c_i - a_i^{\\top} \\pi,\n$$\n其中 $c_i$ 是目标函数系数，$a_i$ 是矩阵 $A$ 中对应于 $x_i$ 的列。在一个最小化问题中，若 $x_i$ 是值为 $0$ 的非基变量，$\\bar{c}_i > 0$ 意味着将 $x_i$ 从 $0$ 增加，LP目标值会以至少每单位 $\\bar{c}_i$ 的速率增加，直到基发生变化。这得出了标准的判别数界：如果我们强制 $x_i = 1$，LP目标值不会减小；相反，对于此强制解，一个有效的界是\n$$\nz^{*}_{\\mathrm{LP}} + \\bar{c}_i.\n$$\n这可由对偶可行性和互补松弛性得出：任何违反判别数非负性的可行原始变量变动，都必须使目标值增加至少等于被违反的判别数之和。\n\n3. 在B&B中，用于最小化问题的高级判别数变量固定法，会将 $\\bar{c}_i$ 与到当前最优解的差距 $U - z^{*}_{\\mathrm{LP}}$ 进行比较。如果 $\\bar{c}_i \\ge U - z^{*}_{\\mathrm{LP}}$，那么分支 $x_i = 1$ 不可能产生一个严格小于 $U$ 的目标值，因此分支 $x_i = 1$ 被剪除。对称地，可以在该节点固定 $x_i = 0$。\n\n我们应用这些原理：\n\n- 计算与当前最优解的差距：\n$$\nU - z^{*}_{\\mathrm{LP}} = 140.6 - 132.4 = 8.2.\n$$\n- 由于 $\\bar{c}_3 = 9.1$ 且 $\\bar{c}_3 > 8.2$，设置 $x_3 = 1$ 无法改进当前最优解。因此，剪除分支 $x_3 = 1$ 是合理的，我们在该节点固定 $x_3 = 0$。\n\n- 覆盖约束 $x_3 + x_7 \\ge 1$ 意味着当 $x_3 = 0$ 时，我们必须有 $x_7 = 1$。\n\n- 在不重新优化的情况下，我们可以利用对强制变量 $x_7$ 的判别数推理来更新节点的下界。因为 $x_7$ 当前是值为 $0$ 的非基变量，其判别数为 $\\bar{c}_7 = 8.3$，强制 $x_7 = 1$ 会使LP目标值至少增加 $\\bar{c}_7$。因此，更新后的有效下界是\n$$\nz^{*}_{\\mathrm{LP}} + \\bar{c}_7 = 132.4 + 8.3 = 140.7.\n$$\n\n最后，四舍五入到四位有效数字。数值 $140.7$ 已经有四位有效数字，所以报告的界是 $140.7$。\n\n这个界也表明 $140.7 \\ge U = 140.6$，这说明在传播之后该节点可以被剪枝（fathomed）；然而，题目要求输出的是更新后的下界本身。", "answer": "$$\\boxed{140.7}$$", "id": "3128375"}]}