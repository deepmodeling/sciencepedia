{"hands_on_practices": [{"introduction": "在求解线性规划松弛问题并得到一个分数解后，下一步便是生成一个割平面来切掉这个非整数解。Gomory割是最初也是最基础的一类割平面。本练习将通过一个具体的单纯形表上最终行的数据，引导你动手推导多个Gomory分数割，并引入“几何效用”这一指标来量化比较它们的强度，为如何在多个候选割平面中进行选择提供了实践基础。[@problem_id:3115646]", "problem": "考虑一个纯整数线性规划（ILP）问题，其中所有决策变量都限制为非负整数。其线性规划（LP）松弛已通过单纯形法求解至最优，得到了一个分数基本可行解。在最终的单纯形表中，当前的非基本变量是 $x_{1}$、$x_{2}$、$x_{3}$ 和 $x_{4}$，并记录了以下三个基本变量行：\n$$\nx_{5} \\;=\\; 2.75 \\;+\\; 0.60\\,x_{1} \\;+\\; 1.20\\,x_{2} \\;+\\; 0.90\\,x_{3} \\;+\\; 0.30\\,x_{4},\n$$\n$$\nx_{6} \\;=\\; 1.30 \\;+\\; 0.10\\,x_{1} \\;+\\; 0.50\\,x_{2} \\;+\\; 1.70\\,x_{3} \\;+\\; 0.80\\,x_{4},\n$$\n$$\nx_{7} \\;=\\; 3.40 \\;+\\; 0.20\\,x_{1} \\;+\\; 2.30\\,x_{2} \\;+\\; 0.40\\,x_{3} \\;+\\; 0.60\\,x_{4}.\n$$\n在当前的 LP 最优解 $x^{*}$ 处，非基本变量满足 $x_{1}=x_{2}=x_{3}=x_{4}=0$，因此基本变量取分数值 $x_{5}=2.75$、$x_{6}=1.30$ 和 $x_{7}=3.40$。\n\n仅使用关于 ILP、LP 松弛和切割平面的核心定义和经过验证的事实，完成以下操作：\n1. 从每个表行中，推导出对 ILP 有效的相关 Gomory 分数切割。\n2. 对于每个导出的切割，确定其在点 $x^{*}$ 处的几何效能，该效能被理解为 $x^{*}$ 对切割的带符号违背量除以切割法向量的欧几里得范数。\n3. 找出具有最大几何效能的切割，并报告该最大效能的数值。\n\n将最终数值答案四舍五入到四位有效数字。", "solution": "### 1. 推导 Gomory 分数切割\n\nGomory 分数切割源于最优单纯形表中的某一行。对于一个基本变量 $x_B$ 和非基本变量集合 $N$，其标准行方程为 $x_B + \\sum_{j \\in N} \\bar{a}_{Bj} x_j = \\bar{b}_B$。由于任何可行的整数解都必须满足此方程，并且所有变量都必须取整数值，我们可以推导出一个新的约束。\n\n将系数和右侧项分解为整数和小数部分：$\\bar{a}_{Bj} = \\lfloor \\bar{a}_{Bj} \\rfloor + f_{Bj}$ 和 $\\bar{b}_B = \\lfloor \\bar{b}_B \\rfloor + f_B$，其中小数部分 $f$ 满足 $0 \\le f  1$。\n重新整理方程：\n$$x_B + \\sum_{j \\in N} \\lfloor \\bar{a}_{Bj} \\rfloor x_j - \\lfloor \\bar{b}_B \\rfloor = f_B - \\sum_{j \\in N} f_{Bj} x_j$$\n方程的左侧对于任何整数解都是整数，因此右侧也必须是整数。由于 $x_j \\ge 0$ 和 $f_{Bj} \\ge 0$，我们有 $\\sum_{j \\in N} f_{Bj} x_j \\ge 0$。此外，由于基本变量 $x_B$ 是分数的，我们有 $0  f_B  1$。因此，右侧 $f_B - \\sum f_{Bj} x_j \\le f_B  1$。一个严格小于1的整数必须小于或等于0。\n$$f_B - \\sum_{j \\in N} f_{Bj} x_j \\le 0 \\implies \\sum_{j \\in N} f_{Bj} x_j \\ge f_B$$\n这就是 Gomory 分数切割的公式。\n\n问题中的方程形式为 $x_B = b + \\sum c_j x_j$。这可以重写为标准形式 $x_B + \\sum (-c_j) x_j = b$。因此，我们有 $\\bar{a}_{Bj} = -c_j$ 和 $\\bar{b}_B = b$。我们需要计算 $f(-c_j)$ 和 $f(b)$。这里，$f(y) = y - \\lfloor y \\rfloor$。\n\n- **第 1 行 ($x_5$):** 方程为 $x_5 - 0.60x_1 - 1.20x_2 - 0.90x_3 - 0.30x_4 = 2.75$。\n  - $f(2.75) = 0.75$\n  - $f(-0.60) = -0.60 - \\lfloor-0.60\\rfloor = -0.60 - (-1) = 0.40$\n  - $f(-1.20) = -1.20 - (-2) = 0.80$\n  - $f(-0.90) = -0.90 - (-1) = 0.10$\n  - $f(-0.30) = -0.30 - (-1) = 0.70$\n  **切割 C1:** $0.40 x_1 + 0.80 x_2 + 0.10 x_3 + 0.70 x_4 \\ge 0.75$\n\n- **第 2 行 ($x_6$):** 方程为 $x_6 - 0.10x_1 - 0.50x_2 - 1.70x_3 - 0.80x_4 = 1.30$。\n  - $f(1.30) = 0.30$\n  - $f(-0.10) = 0.90$, $f(-0.50) = 0.50$, $f(-1.70) = 0.30$, $f(-0.80) = 0.20$\n  **切割 C2:** $0.90 x_1 + 0.50 x_2 + 0.30 x_3 + 0.20 x_4 \\ge 0.30$\n\n- **第 3 行 ($x_7$):** 方程为 $x_7 - 0.20x_1 - 2.30x_2 - 0.40x_3 - 0.60x_4 = 3.40$。\n  - $f(3.40) = 0.40$\n  - $f(-0.20) = 0.80$, $f(-2.30) = 0.70$, $f(-0.40) = 0.60$, $f(-0.60) = 0.40$\n  **切割 C3:** $0.80 x_1 + 0.70 x_2 + 0.60 x_3 + 0.40 x_4 \\ge 0.40$\n\n### 2. 计算几何效能\n\n几何效能被定义为“$x^*$ 对切割的带符号违背量除以切割法向量的欧几里得范数”。对于一个形式为 $\\sum a_j x_j \\ge b$ 的切割和一个点 $x^*$，违背量是指 $x^*$ 不满足该约束的程度，即 $b - \\sum a_j x_j^*$。在我们的案例中，$x^*$ 是非基本变量全为零的点，所以 $\\sum a_j x_j^* = 0$。违背量就是右侧项 $b$（即 $f_B$）。\n效能 $E$ 的公式为：$E = \\frac{f_B}{\\|a\\|_2}$，其中 $a$ 是切割不等式左侧的系数向量。\n\n- **C1 的效能:**\n  - $f_B = 0.75$\n  - $\\|a_1\\|_2 = \\sqrt{0.40^2 + 0.80^2 + 0.10^2 + 0.70^2} = \\sqrt{0.16 + 0.64 + 0.01 + 0.49} = \\sqrt{1.30}$\n  - $E_1 = \\frac{0.75}{\\sqrt{1.30}} \\approx 0.65778$\n\n- **C2 的效能:**\n  - $f_B = 0.30$\n  - $\\|a_2\\|_2 = \\sqrt{0.90^2 + 0.50^2 + 0.30^2 + 0.20^2} = \\sqrt{0.81 + 0.25 + 0.09 + 0.04} = \\sqrt{1.19}$\n  - $E_2 = \\frac{0.30}{\\sqrt{1.19}} \\approx 0.27500$\n\n- **C3 的效能:**\n  - $f_B = 0.40$\n  - $\\|a_3\\|_2 = \\sqrt{0.80^2 + 0.70^2 + 0.60^2 + 0.40^2} = \\sqrt{0.64 + 0.49 + 0.36 + 0.16} = \\sqrt{1.65}$\n  - $E_3 = \\frac{0.40}{\\sqrt{1.65}} \\approx 0.31139$\n\n### 3. 找出最大效能\n\n比较三个效能值：\n$E_1 \\approx 0.65778$\n$E_2 \\approx 0.27500$\n$E_3 \\approx 0.31139$\n\n具有最大几何效能的切割是 C1。其最大效能值为 $\\frac{0.75}{\\sqrt{1.30}} \\approx 0.6577808$。\n\n四舍五入到四位有效数字，最大效能为 $0.6578$。", "answer": "$$\\boxed{0.6578}$$", "id": "3115646"}, {"introduction": "割平面并不仅仅是抽象的数学对象，它们常常源于问题自身的内在结构。本练习将展示如何从一个常见的逻辑约束“big-M”范式出发，推导出一个强有效的混合整数舍入(MIR)型割平面。通过收紧 $M$ 的取值，我们将最终得到该约束下最强的线性不等式（即其凸包），这揭示了良好数学建模与强割平面之间的深刻联系。[@problem_id:3115608]", "problem": "一个二元决策变量 $x \\in \\{0,1\\}$ 和一个连续变量 $y \\in \\mathbb{R}$ 用于为一个逻辑蕴含建模，该蕴含要求每当 $x=1$ 成立时，连续变量必须满足 $y \\leq b$。给定数据 $b=7$ 以及 $y$ 的已知有效界限，即 $2 \\leq y \\leq 11$。一个朴素的大-$M$ 编码形式为 $y \\leq b + M(1 - x)$，其中 $M$ 是一个大常数，但选择过大的 $M$ 会导致一个弱的线性规划松弛。\n\n从第一性原理和核心定义出发，完成以下任务：\n\n1) 使用大-$M$ 不等式编码蕴含关系 $x=1 \\Rightarrow y \\leq b$。解释 $M$ 相对于 $y$ 的已知上界必须满足的有效性条件，以使得该编码在 $x=0$ 时不会切掉任何可行点。\n\n2) 仅使用 $y$ 的已知界限，推导 $M$ 的最小有效值，该值能对所有 $x \\in \\{0,1\\}$ 保持蕴含关系的正确性。\n\n3) 考虑线性规划松弛，其中 $x \\in [0,1]$。将混合整数舍入 (MIR) 原理应用于大-$M$ 不等式，并结合 $y$ 的界限信息，推导一个关于 $(x,y)$ 的单一有效线性不等式，该不等式满足：\n- 对所有 $x \\in \\{0,1\\}$ 的整数可行点都成立，\n- 切掉分数点 $(x,y)=(0.4,11)$，该点对于使用一个非常大的 $M$ 的朴素大-$M$ 编码是可行的，并且\n- 与 $x=0$ 和 $x=1$ 两种情况约束 $y$ 时所形成区域的凸包重合。\n\n将你的最终结果以 $y \\leq \\alpha + \\beta x$ 的形式表示，并提供显式表达式 $\\alpha + \\beta x$ 作为你的答案。无需舍入。", "solution": "1) **大-$M$ 公式与有效性条件**\n\n要编码的逻辑蕴含是 $x=1 \\Rightarrow y \\leq b$。我们使用大-$M$ 不等式 $y \\leq b + M(1 - x)$ 来实现此目的。\n\n- **当 $x=1$ 时:** 不等式变为 $y \\leq b + M(1-1)$，即 $y \\leq b$。这正确地强制执行了蕴含关系。\n- **当 $x=0$ 时:** 蕴含关系不施加任何约束。不等式变为 $y \\leq b + M$。为确保此约束不会错误地排除任何 $y$ 的可行值，这个上限必须是冗余的。我们知道 $y$ 的一个有效上界是 $y \\leq 11$（我们称之为 $U$）。因此，新的上限 $b+M$ 必须至少与已知上界一样大，即 $b+M \\geq U$。此条件确保了当 $x=0$ 时，该约束不会切掉 $y \\in [2, 11]$ 中的任何可行点。\n\n因此，$M$ 的有效性条件为 $M \\geq U - b$。\n\n2) **$M$ 的最小有效值**\n\n为了创建最紧的线性规划松弛，我们应选择满足有效性条件的最小 $M$ 值。\n来自第 1 部分的条件是 $M \\geq U - b$。\n$M$ 的最小值为 $M_{\\text{min}} = U - b$。\n使用给定的数据，$U=11$ 和 $b=7$：\n$$M_{\\text{min}} = 11 - 7 = 4$$\n\n3) **推导最强有效不等式**\n\n推导代表可行域凸包的单一有效线性不等式，相当于为该问题推导最紧的线性不等式。我们可以通过将第 2 部分中推导出的最小有效 $M$ 值代入通用的大-$M$ 不等式来实现。\n\n从大-$M$ 不等式开始：\n$$y \\leq b + M(1 - x)$$\n代入最紧的值 $M = U - b$：\n$$y \\leq b + (U-b)(1 - x)$$\n展开并简化不等式的右侧：\n$$y \\leq b + (U-b) - (U-b)x$$\n$$y \\leq U - (U-b)x$$\n这对于原始整数问题是在 $0 \\leq x \\leq 1$ 范围内的最强有效线性不等式。代入数值 $U=11$ 和 $b=7$：\n$$y \\leq 11 - (11-7)x$$\n$$y \\leq 11 - 4x$$\n我们验证这个不等式：\n- **整数可行性:**\n  - 当 $x=0$ 时，$y \\leq 11$（正确）。\n  - 当 $x=1$ 时，$y \\leq 11 - 4 = 7$（正确）。\n- **切掉点 $(0.4, 11)$:**\n  - 代入该点: $11 \\leq 11 - 4(0.4) \\implies 11 \\leq 11 - 1.6 \\implies 11 \\leq 9.4$。这是假的，所以该点被切掉。\n- **凸包:** 混合整数问题的可行集是两个线段 $\\{(0,y) | 2 \\leq y \\leq 11\\}$ 和 $\\{(1,y) | 2 \\leq y \\leq 7\\}$ 的并集。其凸包的上界是连接点 $(0,11)$ 和 $(1,7)$ 的线段。经过这两点的直线是 $y = \\frac{7-11}{1-0}x + 11$，即 $y = -4x + 11$。我们推导出的不等式 $y \\leq 11 - 4x$ 精确地定义了这个边界。\n\n最终的显式表达式为 $11 - 4x$。", "answer": "$$\\boxed{11 - 4x}$$", "id": "3115608"}, {"introduction": "一个“更深”的割平面一定是一个“更好”的割平面吗？本练习将挑战这一简单直觉，探讨割平面的违背度与其对目标函数界改进之间的关系。通过一个精心构造的0-1背包问题，我们将看到，即使一个割平面显著地切掉了当前的分数解，但如果其方向相对于优化目标不利，它也可能带不来任何实质性的界改进。[@problem_id:3115638] 这揭示了割平面与目标函数间的平行性这一关键概念，及其在实际割平面选择策略中的重要性。", "problem": "考虑以下$0$-$1$背包整数规划 (IP) 实例，该实例旨在说明割平面效力与目标函数平行性之间的相互作用：\n\n最大化线性目标函数\n$$c^{\\top}x = x_{1}$$\n服从背包约束\n$$x_{1} + 5x_{2} + 5x_{3} + 5x_{4} \\leq 14.9,$$\n以及整数性和边界约束\n$$x_{i} \\in \\{0,1\\} \\text{ for } i \\in \\{1,2,3,4\\}, \\quad 0 \\leq x_{i} \\leq 1.$$\n\n考虑通过将$x_{i} \\in \\{0,1\\}$替换为$0 \\leq x_{i} \\leq 1$得到的线性规划 (LP) 松弛。在此松弛中，定义权重向量$w = (1,5,5,5)$，容量$b = 14.9$，以及目标向量$c = (1,0,0,0)$。令$C = \\{2,3,4\\}$为一个覆盖，即$\\sum_{i \\in C} w_{i}  b$，并考虑相应的有效覆盖不等式（割平面）\n$$x_{2} + x_{3} + x_{4} \\leq 2.$$\n\n使用整数规划和线性规划的基本定义（可行域、LP松弛、$0$-$1$背包问题的覆盖不等式有效性），回答以下问题：\n\n1. 针对给定的目标函数和约束，推导LP松弛的最优极点$x^{\\star}$。\n2. 计算在$x^{\\star}$处覆盖割平面的违背量，以及从$x^{\\star}$到由该割平面定义的超平面的欧几里得垂直距离。使用标准欧几里得范数定义此垂直距离。\n3. 确定割平面超平面与目标方向之间的平行角。将平行角解释为目标向量与超平面之间的夹角，该夹角等于目标向量与割平面法向量之间夹角的余角。\n4. 计算因添加割平面而导致的目标函数值的LP界改进量，定义为添加割平面之前和之后的最优LP目标值之差。\n\n将LP界改进量作为你的最终答案。无需舍入。将最终答案表示为一个不带单位的实数。", "solution": "1. **推导LP松弛的最优极点 $x^{\\star}$**\n\nLP松弛问题是最大化 $z = x_1$，服从约束 $x_{1} + 5x_{2} + 5x_{3} + 5x_{4} \\leq 14.9$ 和 $0 \\leq x_i \\leq 1$。\n这是一个连续背包问题。我们可以通过基于目标与权重比 ($c_i/w_i$) 的贪心法来求解。\n- 物品1的比率：$c_1/w_1 = 1/1 = 1$。\n- 物品2, 3, 4的比率：$c_i/w_i = 0/5 = 0$。\n贪心算法优先选择物品1，因为它的比率最高。因此，设置 $x_1=1$。消耗了1单位的容量，剩余容量为 $14.9 - 1 = 13.9$。\n接下来，我们可以用物品2, 3, 4填充剩余容量以得到一个极点解。它们的顺序无关紧要，因为它们的权重相同且目标系数为零。\n- 设置 $x_2=1$。剩余容量为 $13.9 - 5 = 8.9$。\n- 设置 $x_3=1$。剩余容量为 $8.9 - 5 = 3.9$。\n- 物品4可以部分填充：$x_4 = 3.9 / 5 = 0.78$。\n这用尽了全部容量，得到的LP最优解（一个极点）为 $x^{\\star} = (1, 1, 1, 0.78)$。此时的目标值为 $z_{LP} = x_1^{\\star} = 1$。\n\n2. **计算违背量和距离**\n\n覆盖割平面为 $x_{2} + x_{3} + x_{4} \\leq 2$。\n在 $x^{\\star}$ 处，不等式左侧为 $1 + 1 + 0.78 = 2.78$。\n违背量为 $2.78 - 2 = 0.78$。\n该割平面定义的超平面为 $x_2+x_3+x_4 - 2 = 0$。其法向量为 $a = (0, 1, 1, 1)^{\\top}$。\n从 $x^{\\star}$ 到该超平面的欧几里得垂直距离为：\n$$ d = \\frac{|a^{\\top}x^{\\star} - 2|}{\\|a\\|_2} = \\frac{|(0)(1) + (1)(1) + (1)(1) + (1)(0.78) - 2|}{\\sqrt{0^2 + 1^2 + 1^2 + 1^2}} = \\frac{|2.78 - 2|}{\\sqrt{3}} = \\frac{0.78}{\\sqrt{3}} $$\n\n3. **确定平行角**\n\n平行角是目标向量 $c=(1, 0, 0, 0)^{\\top}$ 与割平面法向量 $a=(0, 1, 1, 1)^{\\top}$ 夹角的余角。我们首先计算这两个向量之间的夹角 $\\theta$。\n$$\\cos(\\theta) = \\frac{c \\cdot a}{\\|c\\|_2 \\|a\\|_2} = \\frac{(1)(0) + (0)(1) + (0)(1) + (0)(1)}{\\sqrt{1^2} \\sqrt{0^2+1^2+1^2+1^2}} = \\frac{0}{1 \\cdot \\sqrt{3}} = 0$$\n因此，$\\theta = \\arccos(0) = 90^{\\circ}$。\n平行角 $\\phi = 90^{\\circ} - \\theta = 90^{\\circ} - 90^{\\circ} = 0^{\\circ}$。\n这意味着目标向量与割平面超平面平行（或与法向量正交）。\n\n4. **计算LP界改进量**\n\n添加割平面之前，最优LP目标值为 $z_{LP} = 1$。\n添加割平面后，新LP问题为：\n最大化 $z' = x_1$\n约束条件：\n$x_{1} + 5(x_{2} + x_{3} + x_{4}) \\leq 14.9$\n$x_{2} + x_{3} + x_{4} \\leq 2$\n$0 \\leq x_i \\leq 1$\n\n目标是最大化 $x_1$。从边界约束可知 $x_1 \\leq 1$，因此新的最优目标值 $z'_{LP}$ 不可能大于1。\n我们检查是否仍然可以找到一个目标值为1的可行解。设置 $x_1=1$，约束变为：\n$1 + 5(x_2+x_3+x_4) \\leq 14.9 \\implies x_2+x_3+x_4 \\leq \\frac{13.9}{5} = 2.78$\n$x_2+x_3+x_4 \\leq 2$\n$0 \\leq x_i \\leq 1$ for $i \\in \\{2,3,4\\}$\n\n第二个约束 $x_2+x_3+x_4 \\leq 2$ 比第一个更严格。我们可以找到满足此条件的解，例如 $x_2=1, x_3=1, x_4=0$。\n因此，点 $(1, 1, 1, 0)$ 是新LP的一个可行解。在该点，目标值为 $x_1=1$。\n既然我们找到了一个目标值为1的可行解，并且已知最大可能值也为1，那么新的最优LP目标值 $z'_{LP} = 1$。\nLP界的改进量为 $z_{LP} - z'_{LP} = 1 - 1 = 0$。", "answer": "$$\\boxed{0}$$", "id": "3115638"}]}