{"hands_on_practices": [{"introduction": "这个练习将我们带回运输问题的本源。通过将一个简单的 $2 \\times 2$ 运输问题视为一个线性规划模型，我们可以直观地观察到运输成本的变化如何驱动最优决策的转换。这项实践将加深你对目标函数结构如何决定最优运输方案的理解，并锻炼你从基本原理出发进行参数分析的能力。[@problem_id:3193061]", "problem": "考虑一个具有 $m=2$ 个供应节点和 $n=2$ 个需求节点的平衡运输问题。设供应量为 $s_1=40$ 和 $s_2=60$，需求量为 $d_1=50$ 和 $d_2=50$，因此 $s_1+s_2=d_1+d_2=100$。单位成本矩阵取决于一个标量参数 $\\Delta c \\in \\mathbb{R}$，并由下式给出\n$$\n\\begin{pmatrix}\nc_{11}  c_{12} \\\\\nc_{21}  c_{22}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n4  1+\\Delta c \\\\\n5  3\n\\end{pmatrix}.\n$$\n你必须从运输问题作为线性规划 (LP) 模型的基本定义出发：决策变量 $x_{ij} \\ge 0$ 代表运输量，守恒约束强制要求从每个供应节点运出的总量等于其供应量，进入每个需求节点的总量等于其需求量，目标是最小化总运输成本。\n\n任务：\n1) 写出在满足供应和需求约束条件下最小化总成本的 LP 模型。\n2) 仅使用 LP 结构和 $2\\times 2$ 情况下的守恒约束，推导关于 $\\Delta c$ 的充要条件，在该条件下，最优解将运输量 $x_{11}$ 置于其最小可行值与最大可行值。你的推导必须从刻画可行集的约束和目标函数的定义开始。\n3) 确定阈值参数值 $\\Delta c^\\star$，在该值下，最优运输模式在两个极端的基可行解（就 $x_{11}$ 取其最小值与最大值而言）之间切换。将 $\\Delta c^\\star$ 的值作为你的最终答案报告。无需四舍五入，也无需单位。", "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n**第1步：提取已知条件**\n- 供应节点数：$m=2$。\n- 需求节点数：$n=2$。\n- 供应量：$s_1=40$，$s_2=60$。\n- 需求量：$d_1=50$，$d_2=50$。\n- 问题是平衡的：$s_1+s_2 = 40+60=100$ 且 $d_1+d_2=50+50=100$。\n- 单位成本矩阵：$C = \\begin{pmatrix} c_{11}  c_{12} \\\\ c_{21}  c_{22} \\end{pmatrix} = \\begin{pmatrix} 4  1+\\Delta c \\\\ 5  3 \\end{pmatrix}$，其中 $\\Delta c \\in \\mathbb{R}$。\n- 决策变量：$x_{ij} \\ge 0$，其中 $i \\in \\{1,2\\}, j \\in \\{1,2\\}$。\n- 目标：最小化总运输成本。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：**该问题是一个标准的、定义明确的运输问题，是线性规划和运筹学中的一个基本课题。它牢固地建立在已有的数学原理之上。\n- **适定性：**所有必要的数据（供应量、需求量、成本）都已提供。问题是平衡的，确保了可行解的存在。目标陈述清晰。问题要求一个参数的阈值，这是一个适定的任务。\n- **客观性：**该问题使用精确的数学语言表达，没有歧义或主观论断。\n\n**结论：**该问题是**有效的**。它是自洽的、一致的且科学上合理的。\n\n### 解题推导\n\n**1) LP 模型构建**\n运输问题可以构建为一个线性规划 (LP) 模型。设 $x_{ij}$ 为从供应节点 $i$ 运往需求节点 $j$ 的货物数量。\n\n目标是最小化总成本 $Z$：\n$$ \\text{Minimize } Z = \\sum_{i=1}^{2} \\sum_{j=1}^{2} c_{ij} x_{ij} $$\n$$ Z = 4x_{11} + (1+\\Delta c)x_{12} + 5x_{21} + 3x_{22} $$\n\n这需要满足以下约束条件：\n- 供应约束（从每个供应节点运出的总数量必须等于其供应量）：\n$$ x_{11} + x_{12} = s_1 = 40 $$\n$$ x_{21} + x_{22} = s_2 = 60 $$\n- 需求约束（每个需求节点接收的总数量必须等于其需求量）：\n$$ x_{11} + x_{21} = d_1 = 50 $$\n$$ x_{12} + x_{22} = d_2 = 50 $$\n- 非负约束：\n$$ x_{11} \\ge 0, \\quad x_{12} \\ge 0, \\quad x_{21} \\ge 0, \\quad x_{22} \\ge 0 $$\n\n**2) 关于 $\\Delta c$ 的条件推导**\n这四个等式约束不是独立的。由于问题是平衡的（$\\sum s_i = \\sum d_j$），其中一个约束是冗余的。这样四个变量就剩下三个独立约束，这意味着可行集有一个自由度。我们可以将所有决策变量用单个变量（例如 $x_{11}$）来表示。\n\n根据第一个供应约束：\n$$ x_{12} = 40 - x_{11} $$\n根据第一个需求约束：\n$$ x_{21} = 50 - x_{11} $$\n使用第二个供应约束和 $x_{21}$ 的表达式：\n$$ x_{22} = 60 - x_{21} = 60 - (50 - x_{11}) = 10 + x_{11} $$\n我们可以验证这些表达式满足第二个需求约束：$x_{12} + x_{22} = (40 - x_{11}) + (10 + x_{11}) = 50$，这是正确的。\n\n现在，我们对所有变量施加非负约束，以确定 $x_{11}$ 的可行范围：\n1.  $x_{11} \\ge 0$\n2.  $x_{12} = 40 - x_{11} \\ge 0 \\implies x_{11} \\le 40$\n3.  $x_{21} = 50 - x_{11} \\ge 0 \\implies x_{11} \\le 50$\n4.  $x_{22} = 10 + x_{11} \\ge 0 \\implies x_{11} \\ge -10$\n\n综合这些不等式，$x_{11}$ 的可行范围由 $\\max(0, -10) \\le x_{11} \\le \\min(40, 50)$ 给出，化简为：\n$$ 0 \\le x_{11} \\le 40 $$\n$x_{11}$ 的最小可行值为 $0$，最大可行值为 $40$。这对应于两个不同的基可行解 (BFS)。\n\n接下来，我们将目标函数 $Z$ 完全用 $x_{11}$ 表示：\n$$ Z(x_{11}) = 4x_{11} + (1+\\Delta c)(40 - x_{11}) + 5(50 - x_{11}) + 3(10 + x_{11}) $$\n展开并合并包含 $x_{11}$ 的项：\n$$ Z(x_{11}) = 4x_{11} + 40 - x_{11} + 40\\Delta c - x_{11}\\Delta c + 250 - 5x_{11} + 30 + 3x_{11} $$\n$$ Z(x_{11}) = (4 - 1 - \\Delta c - 5 + 3)x_{11} + (40 + 40\\Delta c + 250 + 30) $$\n$$ Z(x_{11}) = (1 - \\Delta c)x_{11} + (320 + 40\\Delta c) $$\n总成本 $Z$ 是 $x_{11}$ 在闭区间 $[0, 40]$ 上的线性函数。线性函数在区间上的最小值必然在其某个端点处取得。\n\n- 如果 $Z(x_{11})$ 的斜率为正，最优解将 $x_{11}$ 置于其最小可行值（$x_{11}=0$）。\n  条件：$1 - \\Delta c > 0 \\implies \\Delta c  1$。\n  在这种情况下，最优解是 $x_{11}=0, x_{12}=40, x_{21}=50, x_{22}=10$。\n\n- 如果 $Z(x_{11})$ 的斜率为负，最优解将 $x_{11}$ 置于其最大可行值（$x_{11}=40$）。\n  条件：$1 - \\Delta c  0 \\implies \\Delta c > 1$。\n  在这种情况下，最优解是 $x_{11}=40, x_{12}=0, x_{21}=10, x_{22}=50$。\n\n- 如果斜率为零，则在 $[0, 40]$ 范围内的任何 $x_{11}$ 的可行值都是最优的。\n  条件：$1 - \\Delta c = 0 \\implies \\Delta c = 1$。\n  在这种情况下，两个极端解以及它们的任意凸组合都是最优的。\n\n**3) 阈值参数 $\\Delta c^\\star$ 的确定**\n阈值 $\\Delta c^\\star$ 是最优运输模式在两个极端情况之间切换的点。这种情况发生在成本函数对其可行范围内的 $x_{11}$ 的选择无差异时，即目标函数 $Z(x_{11})$ 中 $x_{11}$ 的系数为零。该点代表了两个基可行解的两个最优区域之间的边界。\n\n将斜率设为零：\n$$ 1 - \\Delta c = 0 $$\n$$ \\Delta c^\\star = 1 $$\n当 $\\Delta c = 1$ 时，两个极端解的成本相等。\n$x_{11}=0$ 时的成本：$Z(0) = (1-1)(0) + (320 + 40(1)) = 360$。\n$x_{11}=40$ 时的成本：$Z(40) = (1-1)(40) + (320 + 40(1)) = 360$。\n\n对于 $\\Delta c  1$，$x_{11}=0$ 的解成本更低。对于 $\\Delta c > 1$，$x_{11}=40$ 的解成本更低。切换点发生在 $\\Delta c = 1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "3193061"}, {"introduction": "像西北角法则这样的启发式方法能快速找到一个初始可行解，但它们的效果总是好的吗？本练习将挑战你构建并分析一个特殊场景，其中这个简单的规则导致了成本极高的次优解。通过量化启发式解与真正最优解之间的差距，你将更深刻地体会到成本驱动的优化方法的价值所在。[@problem_id:3193108]", "problem": "考虑一个平衡运输问题，其决策变量为 $x_{ij}$，旨在最小化总运输成本 $\\sum_{i=1}^{m}\\sum_{j=1}^{n} c_{ij} x_{ij}$，并满足每个产地 $i$ 的供应约束 $\\sum_{j=1}^{n} x_{ij} = s_i$ 和每个销地 $j$ 的需求约束 $\\sum_{i=1}^{m} x_{ij} = d_j$，其中 $x_{ij} \\ge 0$ 且 $\\sum_{i=1}^{m} s_i = \\sum_{j=1}^{n} d_j$。构建一个显式的 $3 \\times 3$ 平衡实例，在该实例中，Northwest corner rule (NW) 方法产生一个高度次优的可行解。\n\n按如下方式构建实例。设 $m = n = 3$。设供应量为 $s_1 = s_2 = s_3 = S$，其中 $S > 0$。设需求量为 $d_1 = S - \\delta$，$d_2 = S$ 和 $d_3 = S + \\delta$，其中 $\\delta \\in (0,S)$。设运输成本满足\n$$\nc_{11} = c_{22} = c_{33} = M, \\quad c_{ij} = \\varepsilon \\text{ for all } (i,j) \\text{ with } i \\ne j,\n$$\n其中参数 $M$ 和 $\\varepsilon$ 满足 $M > \\varepsilon \\ge 0$。\n\n从上述基本模型定义出发，评估 NW 分配的总成本 $Z(x^{\\text{NW}})$，构建一个达到最优值 $Z(x^\\star)$ 的可行分配，从第一性原理出发论证其最优性，然后计算精确的加性次优差距\n$$\n\\Delta Z \\equiv Z(x^{\\text{NW}}) - Z(x^\\star)\n$$\n，并将其表示为关于 $S$、$\\delta$、$M$ 和 $\\varepsilon$ 的闭式解析表达式。请将答案表示为单个简化表达式。无需四舍五入。", "solution": "问题陈述已经过验证，是自洽的、一致的且有科学依据的。它提出了一个在优化方法领域中的适定问题。\n\n该问题要求分析一个特定的 $3 \\times 3$ 平衡运输问题。我们已知以下条件：\n- 产地数量 $m=3$，销地数量 $n=3$。\n- 供应量：$s_1 = S$，$s_2 = S$，$s_3 = S$，对于某个 $S > 0$。\n- 需求量：$d_1 = S - \\delta$，$d_2 = S$，$d_3 = S + \\delta$，其中 $0  \\delta  S$。\n- 该问题是平衡的，因为总供应量 $\\sum s_i = 3S$ 等于总需求量 $\\sum d_j = (S-\\delta) + S + (S+\\delta) = 3S$。\n- 成本：$c_{11} = c_{22} = c_{33} = M$，且对于所有 $i \\ne j$，$c_{ij} = \\varepsilon$，其中 $M > \\varepsilon \\ge 0$。\n\n运输表如下：\n$$\n\\begin{array}{c|ccc|c}\n              d_1=S-\\delta  d_2=S  d_3=S+\\delta  \\text{供应量} \\\\ \\hline\n\\text{产地 1}  c_{11}=M  c_{12}=\\varepsilon  c_{13}=\\varepsilon  s_1=S \\\\\n\\text{产地 2}  c_{21}=\\varepsilon  c_{22}=M  c_{23}=\\varepsilon  s_2=S \\\\\n\\text{产地 3}  c_{31}=\\varepsilon  c_{32}=\\varepsilon  c_{33}=M  s_3=S \\\\ \\hline\n\\text{需求量}  S-\\delta  S  S+\\delta  3S\n\\end{array}\n$$\n\n**1. Northwest Corner (NW) Rule 分配与成本**\n\nNorthwest Corner rule 通过从表的左上角单元格 $(1,1)$ 开始分配单位来确定一个初始基本可行解，而不考虑成本。\n\n- **单元格 (1,1):** 分配 $x_{11} = \\min(s_1, d_1) = \\min(S, S-\\delta) = S-\\delta$。\n  销地 1 的需求得到满足。产地 1 的剩余供应量为 $s'_1 = S - (S-\\delta) = \\delta$。\n\n- **单元格 (1,2):** 由于第 1 列已满足，向右移动。分配 $x_{12} = \\min(s'_1, d_2) = \\min(\\delta, S) = \\delta$。\n  产地 1 的供应已用尽。销地 2 的剩余需求量为 $d'_2 = S - \\delta$。\n\n- **单元格 (2,2):** 由于第 1 行已满足，向下移动。分配 $x_{22} = \\min(s_2, d'_2) = \\min(S, S-\\delta) = S-\\delta$。\n  销地 2 的需求得到满足。产地 2 的剩余供应量为 $s'_2 = S - (S-\\delta) = \\delta$。\n\n- **单元格 (2,3):** 由于第 2 列已满足，向右移动。分配 $x_{23} = \\min(s'_2, d_3) = \\min(\\delta, S+\\delta) = \\delta$。\n  产地 2 的供应已用尽。销地 3 的剩余需求量为 $d'_3 = (S+\\delta) - \\delta = S$。\n\n- **单元格 (3,3):** 由于第 2 行已满足，向下移动。分配 $x_{33} = \\min(s_3, d'_3) = \\min(S, S) = S$。\n  产地 3 的供应已用尽，销地 3 的需求得到满足。分配完成。\n\n最终的分配，记为 $x^{\\text{NW}}$，是：\n$x^{\\text{NW}}_{11} = S-\\delta$\n$x^{\\text{NW}}_{12} = \\delta$\n$x^{\\text{NW}}_{22} = S-\\delta$\n$x^{\\text{NW}}_{23} = \\delta$\n$x^{\\text{NW}}_{33} = S$\n所有其他的 $x^{\\text{NW}}_{ij} = 0$。\n\n该分配的总成本 $Z(x^{\\text{NW}})$ 为：\n$$\nZ(x^{\\text{NW}}) = \\sum_{i=1}^{3}\\sum_{j=1}^{3} c_{ij} x^{\\text{NW}}_{ij} = c_{11}x^{\\text{NW}}_{11} + c_{12}x^{\\text{NW}}_{12} + c_{22}x^{\\text{NW}}_{22} + c_{23}x^{\\text{NW}}_{23} + c_{33}x^{\\text{NW}}_{33}\n$$\n$$\nZ(x^{\\text{NW}}) = M(S-\\delta) + \\varepsilon(\\delta) + M(S-\\delta) + \\varepsilon(\\delta) + M(S)\n$$\n$$\nZ(x^{\\text{NW}}) = M(S-\\delta + S-\\delta + S) + \\varepsilon(\\delta + \\delta)\n$$\n$$\nZ(x^{\\text{NW}}) = M(3S - 2\\delta) + 2\\delta\\varepsilon\n$$\n\n**2. 最优分配与成本**\n\n为了找到最优解，我们分析成本函数的结构。令 $Q_D = x_{11} + x_{22} + x_{33}$ 为沿主对角线（高成本路线）运输的总量。总运输量为 $\\sum_{i,j} x_{ij} = 3S$。在非对角线路线上的运输量为 $3S - Q_D$。总成本可以写成：\n$$\nZ = M \\sum_{i=j} x_{ij} + \\varepsilon \\sum_{i \\ne j} x_{ij} = M Q_D + \\varepsilon (3S - Q_D)\n$$\n$$\nZ = (M - \\varepsilon) Q_D + 3S\\varepsilon\n$$\n由于 $M > \\varepsilon$，项 $(M-\\varepsilon)$ 是正的。因此，为了最小化总成本 $Z$，必须最小化 $Q_D$，即高成本对角线路线上的总流量。由于所有 $x_{ij} \\ge 0$，$Q_D$ 的最小可能值为 $0$。\n\n我们必须验证是否存在一个满足 $Q_D = x_{11} + x_{22} + x_{33} = 0$ 的可行分配。这需要仅使用非对角线单元格（其中成本为 $\\varepsilon$）找到一个可行解。让我们构建这样一个解, $x^\\star$。\n考虑以下分配：\n$x^\\star_{12} = S-\\delta$\n$x^\\star_{13} = \\delta$\n$x^\\star_{23} = S$\n$x^\\star_{31} = S-\\delta$\n$x^\\star_{32} = \\delta$\n所有其他的 $x^\\star_{ij}=0$，包括对角线元素 $x^\\star_{11}, x^\\star_{22}, x^\\star_{33}$。\n\n让我们检查该分配是否可行：\n- 非负性：由于 $0  \\delta  S$，所有分配量均为正。\n- 供应约束：\n  - 第 1 行：$x^\\star_{12} + x^\\star_{13} = (S-\\delta) + \\delta = S$。(正确)\n  - 第 2 行：$x^\\star_{23} = S$。(正确)\n  - 第 3 行：$x^\\star_{31} + x^\\star_{32} = (S-\\delta) + \\delta = S$。(正确)\n- 需求约束：\n  - 第 1 列：$x^\\star_{31} = S-\\delta$。(正确)\n  - 第 2 列：$x^\\star_{12} + x^\\star_{32} = (S-\\delta) + \\delta = S$。(正确)\n  - 第 3 列：$x^\\star_{13} + x^\\star_{23} = \\delta + S = S+\\delta$。(正确)\n\n分配 $x^\\star$ 是可行的且满足 $Q_D=0$。因此，它达到了可能的最小成本。这是一个最优解。最优成本 $Z(x^\\star)$ 为：\n$$\nZ(x^\\star) = (M - \\varepsilon) (0) + 3S\\varepsilon = 3S\\varepsilon\n$$\n\n**3. 次优差距**\n\n加性次优差距 $\\Delta Z$ 是 NW 分配的成本与最优成本之间的差值。\n$$\n\\Delta Z = Z(x^{\\text{NW}}) - Z(x^\\star)\n$$\n$$\n\\Delta Z = \\left( M(3S - 2\\delta) + 2\\delta\\varepsilon \\right) - (3S\\varepsilon)\n$$\n$$\n\\Delta Z = 3SM - 2\\delta M + 2\\delta\\varepsilon - 3S\\varepsilon\n$$\n为简化起见，我们将含有 $M$ 和 $\\varepsilon$ 的项分组：\n$$\n\\Delta Z = (3SM - 3S\\varepsilon) - (2\\delta M - 2\\delta\\varepsilon)\n$$\n$$\n\\Delta Z = 3S(M - \\varepsilon) - 2\\delta(M - \\varepsilon)\n$$\n提出公因式 $(M-\\varepsilon)$ 得到最终的简化表达式：\n$$\n\\Delta Z = (3S - 2\\delta)(M - \\varepsilon)\n$$\n该表达式表示对于给定的问题实例，Northwest corner rule 分配的精确加性次优差距。", "answer": "$$\n\\boxed{(3S - 2\\delta)(M - \\varepsilon)}\n$$", "id": "3193108"}, {"introduction": "运输问题的解不仅仅告诉我们最优的运输量，它还通过对偶变量揭示了宝贵的经济信息。本练习将引导你完成一个灵敏度分析实验，以验证优化理论中的一个核心原则。你将亲眼看到对偶变量（或称“位势”）如何精确地预测当资源（此处为需求）发生微小调整时，总成本的变化情况。[@problem_id:3193102]", "problem": "考虑以下线性规划 (LP) 框架下的运输问题。有两个供应节点（源点），索引为 $i \\in \\{1,2\\}$，供应量分别为 $s_{1}=4$ 和 $s_{2}=3$；以及三个需求节点（目的地），索引为 $j \\in \\{1,2,3\\}$，需求量分别为 $d_{1}=2$，$d_{2}=4$ 和 $d_{3}=1$。该问题是平衡的，即 $\\sum_{i=1}^{2} s_{i}=\\sum_{j=1}^{3} d_{j}=7$。单位运输成本由 $c_{11}=2$，$c_{12}=3$，$c_{13}=0$，$c_{21}=4$，$c_{22}=1$ 和 $c_{23}=0$ 给出。决策变量为 $x_{ij} \\ge 0$，表示从源点 $i$ 运往目的地 $j$ 的数量。原始问题是\n最小化 $\\sum_{i=1}^{2}\\sum_{j=1}^{3} c_{ij} x_{ij}$，约束条件为供应等式 $\\sum_{j=1}^{3} x_{ij} = s_{i}$（对于 $i=1,2$）和需求等式 $\\sum_{i=1}^{2} x_{ij} = d_{j}$（对于 $j=1,2,3$）。\n\na) 求解此运输问题至最优，并确定一个最优基本可行解及其关联的最优对偶解。对偶解用节点势能 $(u_{1},u_{2})$（对应供应）和 $(v_{1},v_{2},v_{3})$（对应需求）表示，满足在基本弧上 $u_{i}+v_{j}=c_{ij}$，在其他情况下 $u_{i}+v_{j} \\le c_{ij}$。\n\nb) 现在执行以下扰动实验以验证最优解处的包络原理：将单个需求 $d_{2}$ 增加一个微小量 $\\varepsilon=0.5$，同时将需求 $d_{3}$ 减少相同的量，即将 $(d_{1},d_{2},d_{3})=(2,4,1)$ 替换为 $(d_{1},d_{2}+\\varepsilon,d_{3}-\\varepsilon)=(2,4.5,0.5)$，同时保持供应量 $(s_{1},s_{2})=(4,3)$ 和所有成本 $c_{ij}$ 不变。假设在此扰动下，相同的基本变量集保持最优和可行，计算：\n- 单位有限差分边际成本 $\\Delta Z/\\varepsilon$，其中 $\\Delta Z$ 是由于扰动引起的最优目标值的变化，\n- 以及从 (a) 部分得到的需求侧对偶价格差 $v_{2}-v_{3}$。\n\nc) 报告这两个量之间的绝对差异，即 $|\\Delta Z/\\varepsilon - (v_{2}-v_{3})|$。将你的最终答案四舍五入到四位有效数字。最终答案必须是一个没有单位的实数。", "solution": "用户要求我解决一个运输问题，进行敏感性分析，并报告有限差分边际成本与对偶价格差之间的差异。\n\n### 问题验证\n\n首先，我必须验证问题陈述。\n\n**步骤 1：提取已知条件**\n- **源点**：$i \\in \\{1, 2\\}$\n- **目的地**：$j \\in \\{1, 2, 3\\}$\n- **供应量**：$s_1 = 4$，$s_2 = 3$。总供应量 $\\sum s_i = 7$。\n- **需求量**：$d_1 = 2$，$d_2 = 4$，$d_3 = 1$。总需求量 $\\sum d_j = 7$。\n- **成本**：$c_{11}=2$，$c_{12}=3$，$c_{13}=0$，$c_{21}=4$，$c_{22}=1$，$c_{23}=0$。\n- **决策变量**：$x_{ij} \\ge 0$。\n- **原始问题**：最小化 $Z = \\sum_{i=1}^{2}\\sum_{j=1}^{3} c_{ij} x_{ij}$，约束条件为 $\\sum_{j=1}^{3} x_{ij} = s_{i}$ (对 $i=1,2$) 和 $\\sum_{i=1}^{2} x_{ij} = d_{j}$ (对 $j=1,2,3$)。\n- **对偶问题条件**：找到对偶变量 $(u_1, u_2)$ 和 $(v_1, v_2, v_3)$，使得对于基变量 $u_i + v_j = c_{ij}$，对于非基变量 $u_i + v_j \\le c_{ij}$。\n- **扰动**：$\\varepsilon = 0.5$。新的需求量为 $(d_1, d_2+\\varepsilon, d_3-\\varepsilon) = (2, 4.5, 0.5)$。\n- **扰动假设**：(a) 部分最优解的基变量集合保持最优和可行。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题是一个标准的运输问题，是线性规划和优化方法中一个成熟的课题。它在数学上和逻辑上都是合理的。\n- **适定性**：问题是平衡的（$\\sum s_i = \\sum d_j$），确保存在可行解。由于可行域非空且有界（因为 $x_{ij} \\le \\min(s_i, d_j)$），因此保证存在最优解。目标明确定义。问题要求计算具体的、可计算的量。\n- **客观性**：问题陈述使用了精确的数学语言，并提供了所有必要的数值数据。它没有歧义和主观性。\n\n**步骤 3：结论和行动**\n问题是有效的。我将继续进行求解。\n\n---\n\n### (a) 部分：最优原始解和对偶解\n\n该运输问题可以用以下成本和需求表来表示：\n\n| | 目的地 1 | 目的地 2 | 目的地 3 | 供应量 |\n|---|---|---|---|---|\n| **源点 1** | $c_{11}=2$ | $c_{12}=3$ | $c_{13}=0$ | $s_1=4$ |\n| **源点 2** | $c_{21}=4$ | $c_{22}=1$ | $c_{23}=0$ | $s_2=3$ |\n| **需求量** | $d_1=2$ | $d_2=4$ | $d_3=1$ | 总计=7 |\n\n为了找到一个初始基本可行解 (BFS)，我将使用最小成本法。\n1. 最低成本是 $c_{13}=c_{23}=0$。我选择单元格 $(1,3)$。分配 $x_{13} = \\min(s_1, d_3) = \\min(4, 1) = 1$。目的地 $3$ 的需求得到满足。源点 $1$ 的剩余供应量为 $4-1=3$。\n2. 问题简化。下一个最低成本是 $c_{22}=1$。分配 $x_{22} = \\min(s_2, d_2) = \\min(3, 4) = 3$。源点 $2$ 的供应耗尽。目的地 $2$ 的剩余需求量为 $4-3=1$。\n3. 问题进一步简化。唯一剩下的供应者是源点 $1$。我们必须满足目的地 $1$ 和 $2$ 的剩余需求。源点 $1$ 的最低成本是 $c_{11}=2$。分配 $x_{11} = \\min(\\text{剩余 }s_1, d_1) = \\min(3, 2) = 2$。目的地 $1$ 的需求得到满足。源点 $1$ 的剩余供应量为 $3-2=1$。\n4. 唯一剩下的需求在目的地 $2$（$1$ 个单位），唯一剩下的供应在源点 $1$（$1$ 个单位）。分配 $x_{12} = 1$。\n\n初始 BFS 为：$x_{11}=2$，$x_{12}=1$，$x_{13}=1$，$x_{22}=3$，所有其他 $x_{ij}=0$。\n该解有 $m+n-1 = 2+3-1=4$ 个基变量，因此是非退化的。我们来检查可行性：\n- 源点 1：$x_{11}+x_{12}+x_{13} = 2+1+1=4=s_1$。（正确）\n- 源点 2：$x_{21}+x_{22}+x_{23} = 0+3+0=3=s_2$。（正确）\n- 目的地 1：$x_{11}+x_{21} = 2+0=2=d_1$。（正确）\n- 目的地 2：$x_{12}+x_{22} = 1+3=4=d_2$。（正确）\n- 目的地 3：$x_{13}+x_{23} = 1+0=1=d_3$。（正确）\n\n现在，我将通过计算对偶变量 $(u_i, v_j)$ 和非基变量的检验数来测试该解的最优性。基变量是 $x_{11}, x_{12}, x_{13}, x_{22}$。对于这些变量，$u_i + v_j = c_{ij}$。\n我们任意设定 $u_1 = 0$。\n- 基单元格 $(1,1)$：$u_1+v_1=c_{11} \\implies 0+v_1=2 \\implies v_1=2$。\n- 基单元格 $(1,2)$：$u_1+v_2=c_{12} \\implies 0+v_2=3 \\implies v_2=3$。\n- 基单元格 $(1,3)$：$u_1+v_3=c_{13} \\implies 0+v_3=0 \\implies v_3=0$。\n- 基单元格 $(2,2)$：$u_2+v_2=c_{22} \\implies u_2+3=1 \\implies u_2=-2$。\n因此，对偶变量为 $(u_1, u_2) = (0, -2)$ 和 $(v_1, v_2, v_3) = (2, 3, 0)$。\n\n现在，检查所有非基单元格的最优性条件 $u_i+v_j \\le c_{ij}$。非基单元格是 $(2,1)$ 和 $(2,3)$。\n- 非基单元格 $(2,1)$：检验数为 $\\bar{c}_{21} = c_{21} - (u_2+v_1) = 4 - (-2+2) = 4$。由于 $4 \\ge 0$，条件成立。\n- 非基单元格 $(2,3)$：检验数为 $\\bar{c}_{23} = c_{23} - (u_2+v_3) = 0 - (-2+0) = 2$。由于 $2 \\ge 0$，条件成立。\n\n由于所有检验数均为非负，当前的基本可行解是最优的。\n- **最优基本可行解**：$x_{11}=2$，$x_{12}=1$，$x_{13}=1$，$x_{22}=3$，$x_{21}=0$，$x_{23}=0$。\n- **关联的最优对偶解**：$(u_1, u_2) = (0, -2)$ 和 $(v_1, v_2, v_3) = (2, 3, 0)$。\n\n最优目标值为 $Z = \\sum c_{ij} x_{ij} = c_{11}x_{11} + c_{12}x_{12} + c_{13}x_{13} + c_{22}x_{22} = (2)(2) + (3)(1) + (0)(1) + (1)(3) = 4+3+0+3 = 10$。\n\n### (b) 部分：扰动分析\n\n需求量被扰动为 $d'_1=2$，$d'_2 = d_2+\\varepsilon = 4+0.5=4.5$，以及 $d'_3 = d_3-\\varepsilon = 1-0.5=0.5$。供应量保持为 $(s_1, s_2) = (4, 3)$。\n我们假设相同的基变量集合 $\\{x_{11}, x_{12}, x_{13}, x_{22}\\}$ 保持最优和可行。非基变量 $x_{21}$ 和 $x_{23}$ 保持为零。设新的流量为 $x'_{ij}$。\n\n我们使用供应和需求约束来求解新的流量：\n- $\\sum_j x'_{1j} = s_1 \\implies x'_{11}+x'_{12}+x'_{13} = 4$。\n- $\\sum_j x'_{2j} = s_2 \\implies x'_{21}+x'_{22}+x'_{23} = 3$。\n- $\\sum_i x'_{i1} = d'_1 \\implies x'_{11}+x'_{21} = 2$。\n- $\\sum_i x'_{i2} = d'_2 \\implies x'_{12}+x'_{22} = 4.5$。\n- $\\sum_i x'_{i3} = d'_3 \\implies x'_{13}+x'_{23} = 0.5$。\n\n利用非基变量为零的事实 ($x'_{21}=0, x'_{23}=0$)：\n- 从 $j=1$ 的需求约束：$x'_{11}+0 = 2 \\implies x'_{11}=2$。\n- 从 $j=3$ 的需求约束：$x'_{13}+0 = 0.5 \\implies x'_{13}=0.5$。\n- 从 $i=2$ 的供应约束：$0+x'_{22}+0 = 3 \\implies x'_{22}=3$。\n- 从 $j=2$ 的需求约束：$x'_{12}+x'_{22} = 4.5 \\implies x'_{12}+3 = 4.5 \\implies x'_{12}=1.5$。\n新的解为 $x'_{11}=2, x'_{12}=1.5, x'_{13}=0.5, x'_{22}=3$。\n我们检查 $i=1$ 的供应约束：$x'_{11}+x'_{12}+x'_{13} = 2+1.5+0.5=4$。这是一致的。\n由于所有 $x'_{ij} \\ge 0$，新的解是可行的，从而验证了假设。\n\n现在，计算新的目标值 $Z'$：\n$Z' = c_{11}x'_{11} + c_{12}x'_{12} + c_{13}x'_{13} + c_{22}x'_{22} = (2)(2) + (3)(1.5) + (0)(0.5) + (1)(3) = 4 + 4.5 + 0 + 3 = 11.5$。\n\n目标值的变化是 $\\Delta Z = Z' - Z = 11.5 - 10 = 1.5$。\n单位有限差分边际成本为 $\\frac{\\Delta Z}{\\varepsilon} = \\frac{1.5}{0.5} = 3$。\n\n接下来，我们计算 (a) 部分的需求侧对偶价格差 $v_2 - v_3$。\n使用 (a) 部分的对偶解 $(v_1, v_2, v_3) = (2, 3, 0)$。\n$v_2 - v_3 = 3 - 0 = 3$。\n\n### (c) 部分：绝对差异\n\n在 (b) 部分计算出的两个量之间的绝对差异是：\n$D = \\left| \\frac{\\Delta Z}{\\varepsilon} - (v_2 - v_3) \\right| = |3 - 3| = 0$。\n\n问题要求将最终答案四舍五入到四位有效数字。计算出的值恰好是零。用四位有效数字表示零可能会有歧义，但值本身就是精确的 $0$。因此，四舍五入并非严格必要。最准确的表示就是 $0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "3193102"}]}