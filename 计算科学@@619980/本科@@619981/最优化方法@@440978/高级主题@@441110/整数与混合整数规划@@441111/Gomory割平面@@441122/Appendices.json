{"hands_on_practices": [{"introduction": "Gomory 分割法的核心在于其巧妙的代数构造。本练习将引导你掌握从单纯形表中单个约束行生成一个有效割平面基本技巧 [@problem_id:3133803]。我们将专注于分数部分和模运算在此过程中的关键作用，通过一个具体的数值示例，让你从第一性原理出发，亲手推导出 Gomory 分割，从而为解决更复杂的问题打下坚实的基础。", "problem": "考虑一个标准形式的纯整数线性规划（ILP）问题，其中所有决策变量都要求为非负整数。假设其线性规划（LP）松弛问题已通过单纯形法求解，得到了一个当前基。关注一个基本变量的单纯形表中的某一行，其规范形式写作：\n$$\nx_{B} \\;=\\; b \\;-\\; a_{1}\\,x_{1} \\;-\\; a_{2}\\,x_{2} \\;-\\; a_{3}\\,x_{3},\n$$\n其中 $x_{1}, x_{2}, x_{3} \\ge 0$，并且在ILP问题中 $x_{1}, x_{2}, x_{3}$ 也要求是整数。构建Gomory分数割的基本依据是小数部分和模运算的定义：对于任意实数 $t$，其小数部分为 $\\{t\\} = t - \\lfloor t \\rfloor$，而模1同余满足 $u \\equiv v \\;(\\mathrm{mod}\\;1)$ 当且仅当 $u - v$ 是一个整数。对于右端项 $b$ 是分数的一行，变量 $x_{B}$ 的整数性意味着一个模关系，该关系可以转化为一个包含单纯形表系数小数部分的有效不等式（即Gomory分数割）。\n\n给定具体的行数据\n$$\nb \\;=\\; 5.75, \n\\qquad \n(a_{1}, a_{2}, a_{3}) \\;=\\; (0.25,\\, 1.5,\\, 2.75),\n$$\n执行以下操作：\n- 计算小数部分 $\\{b\\}$ 和 $\\{a_{j}\\}$，其中 $j \\in \\{1,2,3\\}$。\n- 基于 $x_{B}$ 的整数性和模运算的第一性原理，推导出以 $x_{1}, x_{2}, x_{3}$ 表示的相应Gomory分数割。\n- 使用模1同余简要解释割平面系数。\n最后，令 $S$ 表示推导出的Gomory分数割左侧系数之和。$S$ 的精确值是多少？请以单个实数形式提供最终答案，无需四舍五入。", "solution": "我们从规范的单纯形表行开始：\n$$\nx_{B} \\;=\\; b \\;-\\; a_{1}\\,x_{1} \\;-\\; a_{2}\\,x_{2} \\;-\\; a_{3}\\,x_{3},\n$$\n这等价于 $x_{B} + a_{1}\\,x_{1} + a_{2}\\,x_{2} + a_{3}\\,x_{3} = b$。在整数规划问题中，所有变量都必须是整数。Gomory分数割的构建基于以下思想：\n1.  对任意实数 $t$ 定义小数部分 $\\{t\\} = t - \\lfloor t \\rfloor$，其中 $\\lfloor t \\rfloor$ 是不大于 $t$ 的最大整数。\n2.  利用所有变量的整数性，将方程中的每一项都分解为整数部分和小数部分。\n\n**第1步：计算小数部分**\n\n根据所提供的数据，\n$$\nb \\;=\\; 5.75, \n\\qquad \n(a_{1}, a_{2}, a_{3}) \\;=\\; (0.25,\\, 1.5,\\, 2.75).\n$$\n我们计算各项的小数部分：\n$$\n\\{b\\} \\;=\\; \\{5.75\\} \\;=\\; 5.75 - 5 \\;=\\; 0.75,\n$$\n$$\n\\{a_{1}\\} \\;=\\; \\{0.25\\} \\;=\\; 0.25 - 0 \\;=\\; 0.25,\n$$\n$$\n\\{a_{2}\\} \\;=\\; \\{1.5\\} \\;=\\; 1.5 - 1 \\;=\\; 0.5,\n$$\n$$\n\\{a_{3}\\} \\;=\\; \\{2.75\\} \\;=\\; 2.75 - 2 \\;=\\; 0.75.\n$$\n\n**第2步：推导Gomory分数割**\n\n原始方程是 $x_{B} + a_{1}\\,x_{1} + a_{2}\\,x_{2} + a_{3}\\,x_{3} = b$。\n将所有系数和常数项分解为整数与小数部分：\n$$\nx_B + (\\lfloor a_1 \\rfloor + \\{a_1\\})x_1 + (\\lfloor a_2 \\rfloor + \\{a_2\\})x_2 + (\\lfloor a_3 \\rfloor + \\{a_3\\})x_3 = \\lfloor b \\rfloor + \\{b\\}\n$$\n将所有整数项移到等号右边：\n$$\n\\{a_1\\}x_1 + \\{a_2\\}x_2 + \\{a_3\\}x_3 = (\\lfloor b \\rfloor - x_B - \\lfloor a_1 \\rfloor x_1 - \\lfloor a_2 \\rfloor x_2 - \\lfloor a_3 \\rfloor x_3) + \\{b\\}\n$$\n由于所有变量 $x_B, x_1, x_2, x_3$ 和所有向下取整的项 $\\lfloor \\cdot \\rfloor$ 都是整数，所以上式右边括号里的表达式 $(\\lfloor b \\rfloor - x_B - \\dots)$ 必然是一个整数。\n因此，等式右边的值等于 $\\{b\\}$ 加上一个整数。我们将其记为 $\\{b\\} + N$，其中 $N$ 为整数。\n于是我们有：\n$$\n\\{a_1\\}x_1 + \\{a_2\\}x_2 + \\{a_3\\}x_3 = \\{b\\} + N\n$$\n因为 $x_j \\ge 0$ 且 $\\{a_j\\} \\ge 0$，所以等式左边 $\\sum \\{a_j\\}x_j$ 必然是非负的。\n这意味着 $\\{b\\} + N \\ge 0$。由于 $0 \\le \\{b\\}  1$，为了使该不等式对任意非负整数 $N$ 都成立，我们必须有 $N \\ge 0$。\n因此，$\\sum \\{a_j\\}x_j$ 的值可以是 $\\{b\\}, \\{b\\}+1, \\{b\\}+2, \\dots$。在所有情况下，都必须满足：\n$$\n\\sum_{j=1}^{3} \\{a_{j}\\}\\,x_{j} \\;\\ge\\; \\{b\\}\n$$\n这就是Gomory分数割。代入计算出的小数部分，我们得到：\n$$\n0.25\\,x_{1} \\;+\\; 0.5\\,x_{2} \\;+\\; 0.75\\,x_{3} \\;\\ge\\; 0.75.\n$$\n\n**第3步：计算系数之和**\n\n最后，令 $S$ 表示推导出的Gomory分数割左侧系数之和：\n$$\nS \\;=\\; \\{a_{1}\\} + \\{a_{2}\\} + \\{a_{3}\\} \\;=\\; 0.25 + 0.5 + 0.75 \\;=\\; 1.5.\n$$\n因此，$S$ 的精确值为 $1.5$。", "answer": "$$\\boxed{1.5}$$", "id": "3133803"}, {"introduction": "掌握了基本推导方法后，我们将在一个完整的整数规划问题中应用它。本练习将带你走过一个完整的解题流程：从求解一个整数线性规划问题的线性松弛，到识别非整数解，再到生成一个 Gomory 分割来切除这个非整数解 [@problem_id:3133812]。通过这个过程，你将直观地理解割平面法是如何逐步修正可行域，从而最终找到整数最优解的。", "problem": "考虑以下整数线性规划 (ILP) 问题：最大化线性目标函数 $z = 5 x_1 + 3 x_2 + 4 x_3$，约束条件为 $x_1 + 2 x_2 + 3 x_3 \\le 7$，$2 x_1 + x_2 + x_3 \\le 6$，以及 $x_1, x_2, x_3 \\ge 0$ 且 $x_1, x_2, x_3$ 必须为整数。通过去掉对 $x_1, x_2, x_3$ 的整数要求，得到该问题的线性规划 (LP) 松弛。引入松弛变量 $s_1$ 和 $s_2$ 将不等式改写为标准形式的等式：$x_1 + 2 x_2 + 3 x_3 + s_1 = 7$ 和 $2 x_1 + x_2 + x_3 + s_2 = 6$，其中 $s_1, s_2 \\ge 0$。\n\n从 LP 松弛、基本可行解 (BFS) 和单纯形表表示的基础定义出发，不使用任何快捷公式，执行以下步骤：\n\n- 确定 LP 松弛的最优 BFS。在最优解处，确定一个包含两个结构变量为基变量、一个结构变量为零的基，并写出与基结构变量相关的单纯形表行，用非基变量（包括松弛变量）表示。\n- 从一个在 BFS 处右端值为分数的基结构变量对应的单纯形表行中，仅使用 Gomory 割平面法背后的标准整数算术推理，推导出 Gomory 分数割平面。将此割平面简化为一个仅用原始结构变量 $x_1, x_2, x_3$ 表示的不等式（消去 $s_1$ 和 $s_2$）。\n- 在 LP 松弛的两个邻近 BFS 上对推导出的割平面进行数值检验：\n  1. 你找到的分数最优 BFS。\n  2. 通过设置 $x_3 = 0$ 并同时强制两个约束为等式得到的相邻 BFS。\n  对于这两个 BFS 中的每一个，计算违背量，定义为 $\\max\\{0,\\text{LHS} - \\text{RHS}\\}$，其中 LHS 和 RHS 分别表示推导出的割平面的左侧和右侧。\n\n你的最终答案必须是这两个 BFS 中最大违背量的单个实数，表示为精确分数。不需要四舍五入，也不涉及单位。", "solution": "该问题的求解步骤如下：\n\n**1. 确定 LP 松弛的最优 BFS**\n我们求解 LP 松弛问题：最大化 $z = 5x_1 + 3x_2 + 4x_3$ 受约束于 $x_1 + 2x_2 + 3x_3 \\le 7$ 和 $2x_1 + x_2 + x_3 \\le 6$。最优解通常在可行域的顶点。我们检查当两个约束都有效（即 $s_1=0, s_2=0$）且一个决策变量为0时的顶点。\n\n假设 $x_2=0$，我们求解方程组：\n$$x_1 + 3x_3 = 7$$\n$$2x_1 + x_3 = 6$$\n由第二个方程得 $x_3 = 6 - 2x_1$。代入第一个方程：\n$x_1 + 3(6 - 2x_1) = 7 \\implies x_1 + 18 - 6x_1 = 7 \\implies -5x_1 = -11 \\implies x_1 = \\frac{11}{5}$。\n则 $x_3 = 6 - 2(\\frac{11}{5}) = \\frac{30-22}{5} = \\frac{8}{5}$。\n得到基本可行解 (BFS) 为 $(x_1, x_2, x_3) = (\\frac{11}{5}, 0, \\frac{8}{5})$。目标值为 $z = 5(\\frac{11}{5}) + 3(0) + 4(\\frac{8}{5}) = 11 + \\frac{32}{5} = \\frac{87}{5}$。\n\n为了确认这是最优解，我们将目标函数用非基变量（$x_2, s_1, s_2$）表示。首先，将基变量（$x_1, x_3$）用非基变量表示。从标准形式方程组：\n$$x_1 + 2x_2 + 3x_3 + s_1 = 7 \\quad (1)$$\n$$2x_1 + x_2 + x_3 + s_2 = 6 \\quad (2)$$\n解出 $x_1$ 和 $x_3$ 可得：\n$$x_1 = \\frac{11}{5} - \\frac{1}{5}x_2 + \\frac{1}{5}s_1 - \\frac{3}{5}s_2 \\quad (x_1 \\text{ 所在的行})$$\n$$x_3 = \\frac{8}{5} - \\frac{3}{5}x_2 - \\frac{2}{5}s_1 + \\frac{1}{5}s_2 \\quad (x_3 \\text{ 所在的行})$$\n代入目标函数 $z$：\n$$z = \\frac{87}{5} - \\frac{2}{5}x_2 - \\frac{3}{5}s_1 - \\frac{11}{5}s_2$$\n由于所有非基变量的系数都为非正数，这个 BFS 是最优解。\n\n**2. 推导 Gomory 分数割平面**\n我们从 $x_1$ 所在的行生成割平面（也可以用 $x_3$ 行）：\n$$x_1 + \\frac{1}{5}x_2 - \\frac{1}{5}s_1 + \\frac{3}{5}s_2 = \\frac{11}{5}$$\n应用Gomory割平面推导法则 $\\sum_{j} \\{a_{j}\\}x_{j} \\ge \\{b\\}$，其中 $x_j$ 是非基变量：\n- 系数的小数部分：$\\{\\frac{1}{5}\\} = \\frac{1}{5}$，$\\{-\\frac{1}{5}\\} = \\frac{4}{5}$，$\\{\\frac{3}{5}\\} = \\frac{3}{5}$。\n- 右端项的小数部分：$\\{\\frac{11}{5}\\} = \\frac{1}{5}$。\n我们得到割平面：\n$$\\frac{1}{5}x_2 + \\frac{4}{5}s_1 + \\frac{3}{5}s_2 \\ge \\frac{1}{5}$$\n两边乘以 $5$ 得：$x_2 + 4s_1 + 3s_2 \\ge 1$。\n\n**3. 简化割平面**\n将松弛变量的定义 $s_1 = 7 - x_1 - 2x_2 - 3x_3$ 和 $s_2 = 6 - 2x_1 - x_2 - x_3$ 代入割平面：\n$$x_2 + 4(7 - x_1 - 2x_2 - 3x_3) + 3(6 - 2x_1 - x_2 - x_3) \\ge 1$$\n$$x_2 + 28 - 4x_1 - 8x_2 - 12x_3 + 18 - 6x_1 - 3x_2 - 3x_3 \\ge 1$$\n合并同类项：\n$$-10x_1 - 10x_2 - 15x_3 + 46 \\ge 1$$\n$$-10x_1 - 10x_2 - 15x_3 \\ge -45$$\n两边除以 $-5$ 并反转不等号：\n$$2x_1 + 2x_2 + 3x_3 \\le 9$$\n这就是用原始变量表示的简化后的 Gomory 割平面。\n\n**4. 在两个 BFS 上检验割平面**\n割平面是 $2x_1 + 2x_2 + 3x_3 \\le 9$。违背量定义为 $\\max\\{0, \\text{LHS} - 9\\}$。\n\n**测试案例 1**：分数最优 BFS，$(x_1, x_2, x_3) = (\\frac{11}{5}, 0, \\frac{8}{5})$。\nLHS = $2(\\frac{11}{5}) + 2(0) + 3(\\frac{8}{5}) = \\frac{22}{5} + \\frac{24}{5} = \\frac{46}{5}$。\n违背量 = $\\max\\{0, \\frac{46}{5} - 9\\} = \\max\\{0, \\frac{46}{5} - \\frac{45}{5}\\} = \\max\\{0, \\frac{1}{5}\\} = \\frac{1}{5}$。\n\n**测试案例 2**：相邻的 BFS，其中 $x_3=0$ 且两个约束都为等式。\n$$x_1 + 2x_2 = 7$$\n$$2x_1 + x_2 = 6$$\n解此方程组得 $x_1 = \\frac{5}{3}$ 和 $x_2 = \\frac{8}{3}$。此 BFS 为 $(x_1, x_2, x_3) = (\\frac{5}{3}, \\frac{8}{3}, 0)$。\nLHS = $2(\\frac{5}{3}) + 2(\\frac{8}{3}) + 3(0) = \\frac{10}{3} + \\frac{16}{3} = \\frac{26}{3}$。\n违背量 = $\\max\\{0, \\frac{26}{3} - 9\\} = \\max\\{0, \\frac{26}{3} - \\frac{27}{3}\\} = \\max\\{0, -\\frac{1}{3}\\} = 0$。\n\n两个违背量为 $\\frac{1}{5}$ 和 $0$。这两个值的最大值为 $\\frac{1}{5}$。", "answer": "$$\\boxed{\\frac{1}{5}}$$", "id": "3133812"}, {"introduction": "一个常见的问题是：“为什么不直接对小数解进行四舍五入？” 本练习将直面这个问题，通过对比启发式舍入策略和严谨的 Gomory 分割法的结果，来揭示简单舍入方法的陷阱（如产生不可行解或次优解）[@problem_id:3133755]。这个对比将凸显割平面法在保证解的有效性和最优性方面的优势，让你深刻理解其在精确求解整数规划问题中的价值。", "problem": "考虑以下整数线性规划（ILP）模型，该模型用于一个小型资源分配问题，其中包含两个必须取整数值的决策变量：\n最大化 $z = 3 x_1 + 2 x_2$\n约束条件为\n$2 x_1 + x_2 \\le 4$，\n$-x_1 + 2 x_2 \\le 2$，\n$x_1 \\ge 0$, $x_2 \\ge 0$, $x_1, x_2 \\in \\mathbb{Z}$。\n您将比较应用于线性规划（LP）松弛的简单启发式舍入策略与在LP最优解处推导的单个Gomory分数切割，然后提出一种混合方法来协调两者之间的差异。\n\n任务：\n- 放宽整数性约束以获得LP松弛，并求解以获得最优基本可行解。记录目标值以及解是否为分数。\n- 对 $x_1$ 和 $x_2$ 独立应用朴素的最近整数舍入法。检查可行性并计算目标值。同时考虑向下取整（将两个分量都向下舍入到最近的整数），并记录其可行性和目标值。\n- 从最优LP单纯形表中，考虑对应于分数基本变量的行，并推导单个Gomory分数切割（Gomory切割是从要求为整数的基本变量的单纯形表行中的分数部分推导出的有效不等式，旨在切除当前的分数解而不移除任何整数可行解）。用原始变量 $x_1$ 和 $x_2$ 表示该切割，并简要说明它如何收紧LP松弛。\n- 通过检查或枚举确定最优ILP解，并将其与启发式舍入结果和Gomory切割的效果进行比较。\n\n哪个选项最能描述结果并提出合理的混合方法来协调差异？\n\nA. 最近整数舍入产生 $(1, 2)$，这是不可行的；向下取整得到 $(1, 1)$，目标值为 $z = 5$。从LP最优解的 $x_2$ 行推导出的Gomory分数切割可简化为 $x_2 \\le 1$，它消除了分数LP最优解，并朝着真正的ILP最优解 $(2, 0)$（$z = 6$）收紧了松弛。一个合理的混合方法是：添加一个Gomory分数切割，重新求解LP松弛，然后应用受添加的切割限制的保持可行性的舍入或局部修复。\n\nB. 最近整数舍入产生 $(1, 2)$，这是可行的，并达到 $z = 7$。第一个Gomory切割是 $x_1 \\le 1.5$，它移除了真正的ILP最优解 $(2, 0)$；因此舍入法占优。一个好的混合方法是完全依赖最近整数舍入并丢弃切割。\n\nC. 在此实例中，从LP最优解进行向下取整总是能恢复ILP最优解，即 $(2, 0)$，目标值为 $z = 6$，因此切割是不必要的。一个好的混合方法是忽略切割并使用向下取整。\n\nD. 从 $x_2$ 行得到的Gomory切割是 $x_1 + x_2 \\le 3$，它使包括 $(2, 0)$ 在内的一些整数可行点失效，这表明切割可能会移除有效解；因此，舍入比切割更可靠。一个好的混合方法是首先应用舍入，从不添加切割。", "solution": "我们按照问题描述的步骤来分析这个问题。\n\n**1. 求解LP松弛问题**\n我们放宽整数约束，求解线性规划（LP）问题。其最优解通常出现在可行域的顶点。通过求解约束方程组 $2x_1 + x_2 = 4$ 和 $-x_1 + 2x_2 = 2$，我们找到交点 $(x_1, x_2) = (6/5, 8/5) = (1.2, 1.6)$。在此点，目标函数值为 $z = 3(1.2) + 2(1.6) = 3.6 + 3.2 = 6.8$。这是LP松弛问题的最优解，它是一个分数解。\n\n**2. 评估舍入策略**\n*   **最近整数舍入**：将LP最优解 $(1.2, 1.6)$ 舍入到最近的整数，得到 $(1, 2)$。我们检查这个解的可行性：\n    *   约束1: $2(1) + 2 = 4 \\le 4$ (满足)\n    *   约束2: $-(1) + 2(2) = 3 \\le 2$ (**不满足**)\n    因此，$(1, 2)$ 是一个不可行的解。\n*   **向下取整**：将LP最优解 $(1.2, 1.6)$ 的两个分量都向下取整，得到 $(1, 1)$。我们检查可行性：\n    *   约束1: $2(1) + 1 = 3 \\le 4$ (满足)\n    *   约束2: $-(1) + 2(1) = 1 \\le 2$ (满足)\n    因此，$(1, 1)$ 是一个可行的整数解，其目标值为 $z = 3(1) + 2(1) = 5$。\n\n**3. 推导Gomory割平面**\n我们需要从最优单纯形表中推导割平面。对应于基变量 $x_2 = 8/5$ 的行可以表示为 $x_2 + \\frac{1}{5}s_1 + \\frac{2}{5}s_2 = \\frac{8}{5}$。根据Gomory分数割的推导法则，我们得到 $\\frac{1}{5}s_1 + \\frac{2}{5}s_2 \\ge \\frac{3}{5}$。将松弛变量 $s_1 = 4 - 2x_1 - x_2$ 和 $s_2 = 2 + x_1 - 2x_2$ 代入并化简，可得到以 $x_1, x_2$ 表示的割平面：\n$$ \\frac{1}{5}(4 - 2x_1 - x_2) + \\frac{2}{5}(2 + x_1 - 2x_2) \\ge \\frac{3}{5} $$\n$$ 4 - 2x_1 - x_2 + 4 + 2x_1 - 4x_2 \\ge 3 $$\n$$ 8 - 5x_2 \\ge 3 \\implies 5x_2 \\le 5 \\implies x_2 \\le 1 $$\n这个新的约束 $x_2 \\le 1$ 是一个有效的Gomory割平面。它成功地“切除”了LP最优解 $(1.2, 1.6)$，因为 $1.6 \\not\\le 1$。\n\n**4. 确定ILP最优解并比较**\n通过检查可行域内的所有整数点，我们可以找到真正的整数最优解。可行整数点包括 $(0,0), (0,1), (1,0), (1,1), (2,0)$。计算它们的目标值：\n*   $z(0,0) = 0$\n*   $z(0,1) = 2$\n*   $z(1,0) = 3$\n*   $z(1,1) = 5$\n*   $z(2,0) = 6$\n真正的ILP最优解是 $(2,0)$，其目标值为 $z=6$。\n\n**结论**\n- 简单的启发式舍入方法在本例中效果不佳：最近整数舍入导致了不可行的解，而向下取整只得到了一个次优解（$z=5$，而不是最优的 $z=6$）。\n- Gomory割平面法提供了一个严谨的工具。推导出的割平面 $x_2 \\le 1$ 成功排除了非整数的LP最优解，同时保留了包括最优解 $(2,0)$ 在内的所有整数可行解，从而有效地收紧了可行域，引导求解过程朝向真正的最优解。\n- 选项 A 准确地总结了以上所有发现，并提出了一个结合割平面法和启发式方法的合理策略，这在实践中很常见。其他选项均包含事实错误。\n\n因此，选项A是描述结果并提出合理方法的最佳选项。", "answer": "$$\\boxed{A}$$", "id": "3133755"}]}