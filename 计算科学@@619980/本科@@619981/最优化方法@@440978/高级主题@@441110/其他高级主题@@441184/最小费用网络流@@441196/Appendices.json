{"hands_on_practices": [{"introduction": "在深入研究复杂算法之前，让我们先建立直观的理解。一个常见的误解是，最直接的路径总是成本最低的。这个练习 [@problem_id:3151104] 将挑战这一看法，促使我们思考单位成本和弧段容量之间的相互作用。通过比较不同的流动路径方案，你将发现指导最小成本流问题的基本原则：在容量允许的范围内，优先使用成本更低的路径。", "problem": "考虑一个有一个源节点和一个汇节点的有向网络流问题。设节点 $1$ 的供给为 $10$，节点 $4$ 的需求为 $10$，节点 $2$ 和 $3$ 是净供给为零的中转节点。所有弧都具有非负单位成本 $c_{ij} \\ge 0$ 和有限容量。最小成本网络流问题旨在寻求每条弧 $(i,j)$ 上的流量 $x_{ij} \\ge 0$，以满足所有节点的流量守恒、遵守弧容量限制，并最小化总成本 $\\sum_{(i,j)} c_{ij} x_{ij}$。这些弧及其容量和单位成本如下：\n- 弧 $(1,4)$ 的容量为 $10$，单位成本为 $5$。\n- 弧 $(1,2)$ 的容量为 $6$，单位成本为 $2$。\n- 弧 $(2,4)$ 的容量为 $6$，单位成本为 $2$。\n- 弧 $(1,3)$ 的容量为 $4$，单位成本为 $1$。\n- 弧 $(3,4)$ 的容量为 $4$，单位成本为 $3$。\n\n不存在其他弧。仅使用流量守恒、容量可行性和总成本最小化的基本定义，确定在这些数据下，以下哪个陈述正确描述了从节点 $1$ 到节点 $4$ 的最优流量路由。\n\nA. 在弧 $(1,4)$ 上直接发送 $10$ 个单位的流量。\n\nB. 在弧 $(1,4)$ 上发送 $2$ 个单位，沿路径 $(1,2,4)$ 发送 $6$ 个单位，沿路径 $(1,3,4)$ 发送 $2$ 个单位。\n\nC. 在弧 $(1,4)$ 上发送 $0$ 个单位，并沿路径 $(1,2,4)$ 输送 $6$ 个单位，沿路径 $(1,3,4)$ 输送 $4$ 个单位。\n\nD. 最优方案是将所有 $10$ 个单位都通过节点 $3$ 发送，即沿路径 $(1,3,4)$ 发送 $10$ 个单位，而在 $(1,4)$ 或 $(1,2)$ 和 $(2,4)$ 上没有流量。", "solution": "用户要求我解决一个最小成本网络流问题。\n\n我的计划如下：\n1.  **验证问题陈述**：\n    *   **步骤1：提取已知条件**：我将列出所有节点及其供给/需求、弧及其容量和成本。\n    *   **步骤2：验证**：我将检查该问题是否有科学依据、是否适定、客观和完整。这是一个标准的优化问题，因此应该是有效的。网络定义清晰。\n        *   节点：$1, 2, 3, 4$。\n        *   源节点：$1$，供给 $b_1 = 10$。\n        *   汇节点：$4$，需求 $10$，意味着供给 $b_4 = -10$。\n        *   中转节点：$2, 3$，供给 $b_2 = 0, b_3 = 0$。\n        *   总供给 = $10$。总需求 = $10$。问题是平衡的。\n        *   目标：最小化总成本 $\\sum_{(i,j)} c_{ij} x_{ij}$。\n        *   约束条件：\n            *   流量守恒：对于每个节点 $i$，$\\sum_{j} x_{ji} - \\sum_{j} x_{ij} = b_i$。\n            *   容量约束：对于每条弧 $(i,j)$，$0 \\le x_{ij} \\le u_{ij}$。\n        *   弧数据：\n            *   弧 $(1,4)$：$u_{14} = 10$, $c_{14} = 5$。\n            *   弧 $(1,2)$：$u_{12} = 6$, $c_{12} = 2$。\n            *   弧 $(2,4)$：$u_{24} = 6$, $c_{24} = 2$。\n            *   弧 $(1,3)$：$u_{13} = 4$, $c_{13} = 1$。\n            *   弧 $(3,4)$：$u_{34} = 4$, $c_{34} = 3$。\n        *   该问题是一个定义明确的最小成本网络流问题。它在科学上是合理的（在优化领域内），是适定的（因为存在可行流且成本为非负，所以存在解），客观且完整的。验证结论将是“有效”。\n\n2.  **解决问题**：\n    *   目标是找到从节点 $1$ 到节点 $4$ 的流量为 $10$ 个单位的最小成本方案。\n    *   我需要识别从源节点 (1) 到汇节点 (4) 的可能路径。\n        *   路径 1：$1 \\to 4$。单位成本 = $c_{14} = 5$。容量 = $u_{14} = 10$。\n        *   路径 2：$1 \\to 2 \\to 4$。单位成本 = $c_{12} + c_{24} = 2 + 2 = 4$。容量 = $\\min(u_{12}, u_{24}) = \\min(6, 6) = 6$。\n        *   路径 3：$1 \\to 3 \\to 4$。单位成本 = $c_{13} + c_{34} = 1 + 3 = 4$。容量 = $\\min(u_{13}, u_{34}) = \\min(4, 4) = 4$。\n    *   我需要发送总共 $10$ 个单位。我应该首先使用最便宜的路径。\n    *   路径 2 ($1 \\to 2 \\to 4$) 的成本为 $4$。\n    *   路径 3 ($1 \\to 3 \\to 4$) 的成本为 $4$。\n    *   路径 1 ($1 \\to 4$) 的成本为 $5$。\n    *   两条最便宜的路径是路径 2 和路径 3，单位成本均为 $4$。最昂贵的路径是路径 1，单位成本为 $5$。\n    *   为了最小化成本，我应该沿着最便宜的路径发送尽可能多的流量。\n    *   我们沿着路径 3 ($1 \\to 3 \\to 4$) 发送流量。其容量为 $4$。沿此路径发送 $4$ 个单位的成本为 $4 \\times 4 = 16$。\n    *   我们沿着路径 2 ($1 \\to 2 \\to 4$) 发送流量。其容量为 $6$。沿此路径发送 $6$ 个单位的成本为 $6 \\times 4 = 24$。\n    *   到目前为止，我已经发送了 $4 + 6 = 10$ 个单位。需求得到满足。\n    *   此流量的总成本为 $16 + 24 = 40$。\n    *   流量分配为：\n        *   $x_{13} = 4$\n        *   $x_{34} = 4$\n        *   $x_{12} = 6$\n        *   $x_{24} = 6$\n        *   $x_{14} = 0$\n    *   此流量是可行的：\n        *   容量约束：\n            *   $x_{14}=0 \\le u_{14}=10$ (满足)\n            *   $x_{12}=6 \\le u_{12}=6$ (满足)\n            *   $x_{24}=6 \\le u_{24}=6$ (满足)\n            *   $x_{13}=4 \\le u_{13}=4$ (满足)\n            *   $x_{34}=4 \\le u_{34}=4$ (满足)\n        *   流量守恒约束：\n            *   节点 1 (源)：流出量 = $x_{14} + x_{12} + x_{13} = 0 + 6 + 4 = 10$。流入量 = $0$。净流出量 = $10$。(正确，与供给匹配)\n            *   节点 2 (中转)：流入量 = $x_{12} = 6$。流出量 = $x_{24} = 6$。净流出量 = $0$。(正确)\n            *   节点 3 (中转)：流入量 = $x_{13} = 4$。流出量 = $x_{34} = 4$。净流出量 = $0$。(正确)\n            *   节点 4 (汇)：流入量 = $x_{14} + x_{24} + x_{34} = 0 + 6 + 4 = 10$。流出量 = $0$。净流出量 = $-10$。(正确，与需求匹配)\n    *   此流量是可行的。它是否最优？\n    *   这是一种基于路径成本的贪心方法。如果没有负成本（本例中就是这种情况），它通常被称为“连续最短路算法”。我们沿着最便宜的可用路径增加流量，直到满足总需求。\n    *   已识别的路径是：\n        *   $p_1 = (1,3,4)$，成本 $c(p_1)=4$，容量 $u(p_1)=4$。\n        *   $p_2 = (1,2,4)$，成本 $c(p_2)=4$，容量 $u(p_2)=6$。\n        *   $p_3 = (1,4)$，成本 $c(p_3)=5$，容量 $u(p_3)=10$。\n    *   算法过程如下：\n        1. 找到最便宜的路径。路径 $p_1$ 和 $p_2$ 并列最便宜，成本为 $4$。我们选择 $p_1$。\n        2. 沿 $p_1$ 发送尽可能多的流量：$\\min(\\text{需求}, u(p_1)) = \\min(10, 4) = 4$ 个单位。\n        3. 更新残余容量和剩余需求。剩余需求为 $10-4=6$。弧 $(1,3)$ 和 $(3,4)$ 上的容量现在为 $0$。\n        4. 在残余图中找到最便宜的路径。路径 $p_1$ 不再可用。下一条最便宜的路径是 $p_2$，成本为 $4$。\n        5. 沿 $p_2$ 发送尽可能多的流量：$\\min(\\text{需求}, u(p_2)) = \\min(6, 6) = 6$ 个单位。\n        6. 更新残余容量和剩余需求。剩余需求为 $6-6=0$。弧 $(1,2)$ 和 $(2,4)$ 上的容量现在为 $0$。\n        7. 需求已满足。发送的总流量为 $4+6=10$。\n    *   最终的流量为 $x_{13}=4$, $x_{34}=4$, $x_{12}=6$, $x_{24}=6$, $x_{14}=0$。\n    *   总成本 = $(4 \\times c_{13}) + (4 \\times c_{34}) + (6 \\times c_{12}) + (6 \\times c_{24}) = (4 \\times 1) + (4 \\times 3) + (6 \\times 2) + (6 \\times 2) = 4 + 12 + 12 + 12 = 40$。\n    *   这证实了我最初的计算。\n\n3.  **评估选项**：\n    *   **选项 A**：“在弧 $(1,4)$ 上直接发送 $10$ 个单位的流量。”\n        *   这对应于流量 $x_{14} = 10$，所有其他流量为 $0$。\n        *   此流量是否可行？$x_{14} = 10 \\le u_{14} = 10$。是的。流量守恒得到满足。这是一个有效的流。\n        *   成本是多少？成本 = $10 \\times c_{14} = 10 \\times 5 = 50$。\n        *   这是否最优？成本为 $50$。我计算出的最优成本是 $40$。因此，$50 > 40$。这不是一个最优流。\n        *   结论：**不正确**。\n\n    *   **选项 B**：“在弧 $(1,4)$ 上发送 $2$ 个单位，沿路径 $(1,2,4)$ 发送 $6$ 个单位，沿路径 $(1,3,4)$ 发送 $2$ 个单位。”\n        *   这对应于流量分配：\n            *   $x_{14} = 2$。\n            *   $x_{12} = 6$, $x_{24} = 6$。\n            *   $x_{13} = 2$, $x_{34} = 2$。\n        *   我们来检查可行性：\n            *   从源节点 1 的总流出量：$x_{14} + x_{12} + x_{13} = 2 + 6 + 2 = 10$。(正确)\n            *   到汇节点 4 的总流入量：$x_{14} + x_{24} + x_{34} = 2 + 6 + 2 = 10$。(正确)\n            *   节点 2：流入量 $x_{12} = 6$。流出量 $x_{24} = 6$。(平衡)\n            *   节点 3：流入量 $x_{13} = 2$。流出量 $x_{34} = 2$。(平衡)\n            *   检查容量：\n                *   $x_{14} = 2 \\le u_{14} = 10$ (满足)\n                *   $x_{12} = 6 \\le u_{12} = 6$ (满足)\n                *   $x_{24} = 6 \\le u_{24} = 6$ (满足)\n                *   $x_{13} = 2 \\le u_{13} = 4$ (满足)\n                *   $x_{34} = 2 \\le u_{34} = 4$ (满足)\n            *   该流量是可行的。\n        *   我们来计算成本：\n            *   成本 = $(2 \\times c_{14}) + (6 \\times c_{12}) + (6 \\times c_{24}) + (2 \\times c_{13}) + (2 \\times c_{34})$\n            *   成本 = $(2 \\times 5) + (6 \\times 2) + (6 \\times 2) + (2 \\times 1) + (2 \\times 3)$\n            *   成本 = $10 + 12 + 12 + 2 + 6 = 42$。\n        *   这是否最优？成本为 $42$。我计算出的最优成本是 $40$。因此，$42 > 40$。这不是一个最优流。\n        *   结论：**不正确**。\n\n    *   **选项 C**：“在弧 $(1,4)$ 上发送 $0$ 个单位，并沿路径 $(1,2,4)$ 输送 $6$ 个单位，沿路径 $(1,3,4)$ 输送 $4$ 个单位。”\n        *   这对应于流量分配：\n            *   $x_{14} = 0$。\n            *   $x_{12} = 6$, $x_{24} = 6$。\n            *   $x_{13} = 4$, $x_{34} = 4$。\n        *   这正是我推导出的最优流。\n        *   我们为这个选项重新验证所有内容。\n        *   可行性：\n            *   从源节点 1 的总流出量：$x_{14} + x_{12} + x_{13} = 0 + 6 + 4 = 10$。(正确)\n            *   到汇节点 4 的总流入量：$x_{14} + x_{24} + x_{34} = 0 + 6 + 4 = 10$。(正确)\n            *   节点 2：流入量 $x_{12} = 6$。流出量 $x_{24} = 6$。(平衡)\n            *   节点 3：流入量 $x_{13} = 4$。流出量 $x_{34} = 4$。(平衡)\n            *   容量：\n                *   $x_{14} = 0 \\le u_{14} = 10$ (满足)\n                *   $x_{12} = 6 \\le u_{12} = 6$ (满足)\n                *   $x_{24} = 6 \\le u_{24} = 6$ (满足)\n                *   $x_{13} = 4 \\le u_{13} = 4$ (满足)\n                *   $x_{34} = 4 \\le u_{34} = 4$ (满足)\n            *   该流量是可行的。\n        *   计算成本：\n            *   成本 = $(0 \\times c_{14}) + (6 \\times c_{12}) + (6 \\times c_{24}) + (4 \\times c_{13}) + (4 \\times c_{34})$\n            *   成本 = $(0 \\times 5) + (6 \\times 2) + (6 \\times 2) + (4 \\times 1) + (4 \\times 3)$\n            *   成本 = $0 + 12 + 12 + 4 + 12 = 40$。\n        *   这是否最优？是的，成本为 $40$，这是我计算出的最小可能成本。任何其他可行流的成本都会更高。例如，将路径 $(1,2,4)$ 或 $(1,3,4)$ 上的一个单位流量替换为路径 $(1,4)$ 上的一个单位流量，总成本将增加 $5 - 4 = 1$。由于路径 $(1,2,4)$ 和 $(1,3,4)$ 已完全饱和，不能再沿它们发送更多流量。所以这必须是最优解。\n        *   结论：**正确**。\n\n    *   **选项 D**：“最优方案是将所有 $10$ 个单位都通过节点 $3$ 发送，即沿路径 $(1,3,4)$ 发送 $10$ 个单位，而在 $(1,4)$ 或 $(1,2)$ 和 $(2,4)$ 上没有流量。”\n        *   这对应于流量分配：\n            *   $x_{13} = 10$, $x_{34} = 10$。\n            *   $x_{14} = 0, x_{12} = 0, x_{24} = 0$。\n        *   此流量是否可行？\n            *   检查容量：\n                *   $x_{13} = 10$。容量为 $u_{13} = 4$。因此 $x_{13} > u_{13}$。弧 $(1,3)$ 的容量被违反。\n                *   $x_{34} = 10$。容量为 $u_{34} = 4$。因此 $x_{34} > u_{34}$。弧 $(3,4)$ 的容量被违反。\n            *   路径 $(1,3,4)$ 的容量为 $\\min(u_{13}, u_{34}) = \\min(4,4) = 4$。不可能沿此路径发送 $10$ 个单位。\n        *   此流量是不可行的。一个不可行的流不可能是最优的。\n        *   结论：**不正确**。\n\n4.  **最终检查和格式化**：\n    *   问题是有效的。\n    *   最优解的推导过程看起来很可靠。我使用了连续最短路（贪心）方法，该方法适用于具有非负成本的最小成本流问题。\n    *   对每个选项的评估似乎是正确的。\n    *   选项A是可行的，但不是最优的。\n    *   选项B是可行的，但不是最优的。\n    *   选项C描述了最优可行流。\n    *   选项D描述了一个不可行流。\n    *   最终答案是C。", "answer": "$$\\boxed{C}$$", "id": "3151104"}, {"introduction": "前一个练习向我们揭示了最优流会优先选择成本更低的路径。连续最短路算法将这一直观认识形式化为一个强大的方法。在本练习 [@problem_id:3151081] 中，你将逐步应用该算法，在残差网络中迭代地寻找成本最低的路径并沿其发送流量。这个动手实践将展示这种贪婪的迭代方法如何保证能构建出总成本最小的流。", "problem": "考虑有向网络 $G=(V,E)$，其节点集为 $V=\\{s,a,b,c,t\\}$，弧集 $E$ 由以下弧容量和单位弧成本描述。对于每条弧 $(i,j)\\in E$，令 $u_{ij}$ 表示其容量，$c_{ij}$ 表示其单位成本：\n- 弧 $(s,b)$，其容量为 $u_{sb}=1$，单位成本为 $c_{sb}=0$，\n- 弧 $(b,t)$，其容量为 $u_{bt}=1$，单位成本为 $c_{bt}=2$，\n- 弧 $(s,a)$，其容量为 $u_{sa}=2$，单位成本为 $c_{sa}=1$，\n- 弧 $(a,b)$，其容量为 $u_{ab}=2$，单位成本为 $c_{ab}=1$，\n- 弧 $(a,t)$，其容量为 $u_{at}=2$，单位成本为 $c_{at}=4$，\n- 弧 $(b,c)$，其容量为 $u_{bc}=1$，单位成本为 $c_{bc}=2$，\n- 弧 $(c,t)$，其容量为 $u_{ct}=2$，单位成本为 $c_{ct}=1$，\n- 弧 $(s,c)$，其容量为 $u_{sc}=1$，单位成本为 $c_{sc}=3$。\n\n总共必须有 $k=3$ 个单位的流从节点 $s$（源点）发送到节点 $t$（汇点）。每条弧都具有给定的容量和线性的单位成本。没有其他供给或需求；所有中间节点的净供给均为 $0$。所有弧成本均为非负，且网络中不包含负成本圈。\n\n任务：\n1. 使用最小费用流的基本定义，计算在满足流量守恒和弧容量约束的条件下，从 $s$ 到 $t$ 发送 $k=3$ 个单位流量的最小总成本 $C^{*}$。\n2. 应用 $k=3$ 次单位增广版本的连续最短路算法：在每次迭代中，在当前残留网络中，选择一条成本最小的 $s$-$t$ 路径（相对于当前的弧成本和残留容量），并沿该路径精确增广 $1$ 个单位的流；更新残留网络并重复。计算所产生的 $3$ 单位流的总成本 $C^{\\mathrm{SSP}}$。\n3. 报告数值差异 $\\Delta=C^{\\mathrm{SSP}}-C^{*}$。\n\n将最终答案表示为单个实数。无需四舍五入，也无需报告物理单位。", "solution": "所给出的问题是一个最小费用流问题，这是优化方法领域中的一个典型主题。它要求通过一个弧上带有容量和成本约束的有向网络，将指定数量的流从源节点发送到汇节点，以使总成本最小化。该问题定义明确，为标准的网络流公式化提供了所有必要的参数。\n\n该问题要求进行三项计算：\n1. 从源点 $s$ 到汇点 $t$ 发送 $k=3$ 个单位流量的最小总成本 $C^{*}$。\n2. 应用 $k=3$ 次单位增广版本的连续最短路算法得到的总成本 $C^{\\mathrm{SSP}}$。\n3. 数值差异 $\\Delta = C^{\\mathrm{SSP}} - C^{*}$。\n\n连续最短路算法是解决最小费用流问题的一种标准的、可证明为最优的算法，尤其是在所有弧成本均为非负的情况下，如此处所示。该算法在残留网络中迭代地寻找成本最小的路径，并沿其推送流量。因此，由此算法得出的成本 $C^{\\mathrm{SSP}}$ 保证是真正的最小成本 $C^{*}$。因此，我们可以预期 $\\Delta = 0$。我们现在将通过执行该算法来证明这一点。\n\n设 $x_{ij}$ 是弧 $(i,j)$ 上的流量，$u_{ij}$ 是其容量，$c_{ij}$ 是其单位成本。我们需要从 $s$ 到 $t$ 发送总共 $k=3$ 个单位的流量。\n\n**初始状态：**\n初始流量对于所有弧 $(i,j) \\in E$ 均为 $x_{ij} = 0$。已发送的总流量为 $v=0$，总成本为 $C=0$。初始残留网络 $G_0$ 与原始网络 $G$ 相同。\n\n**迭代 1：增广 1 单位流量**\n我们在网络 $G_0$ 中根据成本 $c_{ij}$ 找到从 $s$ 到 $t$ 的最短路径。对于这个小图，我们可以使用 Dijkstra 算法或直接观察。\n可能的 $s-t$ 路径及其成本如下：\n- $P_A: s \\to b \\to t$。成本：$c_{sb} + c_{bt} = 0 + 2 = 2$。\n- $P_B: s \\to b \\to c \\to t$。成本：$c_{sb} + c_{bc} + c_{ct} = 0 + 2 + 1 = 3$。\n- $P_C: s \\to a \\to b \\to t$。成本：$c_{sa} + c_{ab} + c_{bt} = 1 + 1 + 2 = 4$。\n- $P_D: s \\to c \\to t$。成本：$c_{sc} + c_{ct} = 3 + 1 = 4$。\n- $P_E: s \\to a \\to t$。成本：$c_{sa} + c_{at} = 1 + 4 = 5$。\n- $P_F: s \\to a \\to b \\to c \\to t$。成本：$c_{sa} + c_{ab} + c_{bc} + c_{ct} = 1 + 1 + 2 + 1 = 5$。\n\n最短路径是 $P_1 = s \\to b \\to t$，成本为 $2$。该路径的容量为 $\\min(u_{sb}, u_{bt}) = \\min(1, 1) = 1$。\n我们沿 $P_1$ 增广 $\\delta_1 = 1$ 单位的流量。\n- 本次增广的成本：$\\delta_1 \\times 2 = 1 \\times 2 = 2$。\n- 总流量：$v = 1$。\n- 累计成本：$C_1 = 2$。\n- 更新流量变量：$x_{sb}=1$, $x_{bt}=1$。\n- 更新残留网络 ($G_1$)：前向弧的残留容量变为 $u^R_{sb} = 1-1=0$ 和 $u^R_{bt} = 1-1=0$。引入新的后向弧 $(b,s)$ 和 $(t,b)$，其成本为 $c_{bs} = -c_{sb} = 0$ 和 $c_{tb} = -c_{bt} = -2$，容量等于流量，即 $1$。\n\n**迭代 2：增广 1 单位流量**\n我们在残留网络 $G_1$ 中寻找最短路径。弧 $(s,b)$ 和 $(b,t)$ 在前向方向上已饱和。\n$G_1$ 中可用的 $s-t$ 路径及其成本如下：\n- $P_D: s \\to c \\to t$。成本：$c_{sc} + c_{ct} = 3 + 1 = 4$。路径容量为 $\\min(u_{sc}, u_{ct}) = \\min(1, 2)=1$。\n- $P_E: s \\to a \\to t$。成本：$c_{sa} + c_{at} = 1 + 4 = 5$。路径容量为 $\\min(u_{sa}, u_{at}) = \\min(2, 2)=2$。\n- $P_F: s \\to a \\to b \\to c \\to t$。成本：$c_{sa} + c_{ab} + c_{bc} + c_{ct} = 1+1+2+1=5$。路径容量为 $\\min(u_{sa}, u_{ab}, u_{bc}, u_{ct}) = \\min(2,2,1,2)=1$。\n（注意：由于迭代 1 中弧已饱和，路径 $P_B$ 和 $P_C$ 不再可用）。\n最短路径是 $P_2 = s \\to c \\to t$，成本为 $4$。\n我们沿 $P_2$ 增广 $\\delta_2 = 1$ 单位的流量。\n- 本次增广的成本：$\\delta_2 \\times 4 = 1 \\times 4 = 4$。\n- 总流量：$v = 1 + 1 = 2$。\n- 累计成本：$C_2 = 2 + 4 = 6$。\n- 更新流量变量：$x_{sc}=1$, $x_{ct}=1$。\n- 更新残留网络 ($G_2$)：$u^R_{sc} = 1-1=0$。$u^R_{ct}$ 减少到 $2-1=1$。引入后向弧 $(c,s)$ 和 $(t,c)$。\n\n**迭代 3：增广 1 单位流量**\n我们在残留网络 $G_2$ 中寻找最短路径。现在弧 $(s,b)$、$(b,t)$ 和 $(s,c)$ 在前向方向上已饱和。任何从 $s$ 出发的路径都必须以弧 $(s,a)$ 开始。\n以 $(s,a)$ 开始的可用路径如下：\n- $P_E: s \\to a \\to t$。成本：$c_{sa} + c_{at} = 1 + 4 = 5$。\n- $P_F: s \\to a \\to b \\to c \\to t$。成本：$c_{sa} + c_{ab} + c_{bc} + c_{ct} = 1+1+2+1=5$。\n两个剩余的路径选项成本均为 $5$。算法可以选择其中任意一条。我们选择 $P_3 = s \\to a \\to t$。\n我们沿 $P_3$ 增广 $\\delta_3 = 1$ 单位的流量。\n- 本次增广的成本：$\\delta_3 \\times 5 = 1 \\times 5 = 5$。\n- 总流量：$v = 2 + 1 = 3$。这满足了要求。\n- 累计成本：$C_3 = 6 + 5 = 11$。\n\n算法终止，因为已经发送了 $k=3$ 个单位的流量。总成本为 $C^{\\mathrm{SSP}} = 11$。\n最终的流量分配为：$x_{sb}=1, x_{bt}=1, x_{sc}=1, x_{ct}=1, x_{sa}=1, x_{at}=1$，所有其他流量均为 $0$。此流量是可行的，总成本为 $1(2) + 1(4) + 1(5) = 11$。\n\n**$C^{*}$ 和 $\\Delta$ 的计算**\n根据网络流的基本理论，连续最短路算法在成本非负的网络中能正确计算给定流量下的最小成本。\n1. 最小总成本：$C^{*} = C^{\\mathrm{SSP}} = 11$。\n2. 连续最短路算法得到的成本：$C^{\\mathrm{SSP}} = 11$。\n3. 数值差异 $\\Delta$ 为：\n$$\n\\Delta = C^{\\mathrm{SSP}} - C^{*} = 11 - 11 = 0\n$$\n\n最终答案是 $\\Delta$ 的值。", "answer": "$$\\boxed{0}$$", "id": "3151081"}, {"introduction": "解决最小成本流问题的另一项强大技术是网络单纯形法，它从线性规划的视角来审视问题。该方法并非从零开始构建流，而是从一个可行流出发，并对其进行迭代改进。本练习 [@problem_id:3151075] 聚焦于该过程中的一个关键步骤：利用节点势来计算判别数（reduced costs），这些判别数可以判断当前流是否最优，或者指出应该引入哪条弧来降低成本。", "problem": "考虑一个有向网络，其节点集为 $N=\\{1,2,3,4,5\\}$，弧集 $A$ 被划分为一个基树 $T$ 和非树弧 $A\\setminus T$。所有弧的下界均为 $0$，上容量为无穷大。节点供应量为 $b_1=5$，$b_2=0$，$b_3=-3$，$b_4=-2$，$b_5=0$，因此 $\\sum_{i\\in N} b_i=0$。弧成本 $c_{ij}$ 如下所示。\n\n- 基树 $T$（这些弧构成了 $N$ 的一个生成树，并且是网络单纯形法意义下的一个可行树基的基变量）：\n  - $(1,2)$，成本为 $c_{12}=3$，\n  - $(2,3)$，成本为 $c_{23}=-1$，\n  - $(2,4)$，成本为 $c_{24}=2$，\n  - $(4,5)$，成本为 $c_{45}=0$。\n\n- 非树弧 $A\\setminus T$：\n  - $(1,3)$，成本为 $c_{13}=6$，\n  - $(3,4)$，成本为 $c_{34}=-2$，\n  - $(5,3)$，成本为 $c_{53}=4$，\n  - $(1,4)$，成本为 $c_{14}=1$，\n  - $(2,5)$，成本为 $c_{25}=1$，\n  - $(5,1)$，成本为 $c_{51}=-3$。\n\n一个与 $T$ 和 $b$ 一致的基可行流由树弧上的流量 $x_{12}=5$，$x_{23}=3$，$x_{24}=2$，$x_{45}=0$ 给出，并且对于所有 $(i,j)\\in A\\setminus T$，有 $x_{ij}=0$。\n\n从最小成本网络流的线性规划公式及其对偶问题出发，推导在一个可行树基下节点势和简约成本的定义关系。然后：\n\n1. 计算所有节点 $i\\in N$ 的节点势 $\\pi_i$，使其满足沿基树 $T$ 的定义等式（通过设置 $\\pi_1=0$ 来固定加法自由度）。\n2. 对于每个非树弧 $(i,j)\\in A\\setminus T$，使用以 $c_{ij}$ 和节点势表示的适当定义来计算简约成本 $\\bar{c}_{ij}$。\n3. 识别所有简约成本为负的非树弧，作为可以获得最小成本改进的合格入基弧。\n4. 最后，将所有非树弧中的最小简约成本作为一个实数报告。提供精确值，无需四舍五入。", "solution": "该问题要求我们从一个给定的基可行解开始，对一个最小成本网络流问题执行一次网络单纯形法的迭代。这包括计算节点势，然后计算非基弧的简约成本，并识别潜在的改进。\n\n首先，我们建立理论框架。最小成本网络流问题可以被表述为一个线性规划（LP）问题。设 $x_{ij}$ 为弧 $(i,j) \\in A$ 上的流量，$c_{ij}$ 为弧 $(i,j)$ 上单位流量的成本，$b_i$ 为节点 $i \\in N$ 的供应量（对于供应节点 $b_i > 0$，对于需求节点 $b_i  0$）。问题是：\n\n最小化 $Z = \\sum_{(i,j) \\in A} c_{ij} x_{ij}$\n\n约束条件：\n$\\sum_{j \\text{ s.t. } (i,j) \\in A} x_{ij} - \\sum_{j \\text{ s.t. } (j,i) \\in A} x_{ji} = b_i \\quad \\forall i \\in N$ (流量守恒)\n$x_{ij} \\ge 0 \\quad \\forall (i,j) \\in A$ (非负性，因为下界为 $0$)\n\n该线性规划的对偶问题为每个流量守恒约束引入一个对偶变量，或称为节点势 $\\pi_i$。对偶问题是：\n\n最大化 $W = \\sum_{i \\in N} b_i \\pi_i$\n\n约束条件：\n$\\pi_i - \\pi_j \\le c_{ij} \\quad \\forall (i,j) \\in A$\n\n网络单纯形法使用一个基可行解，该解对应于网络的一个生成树 $T$。对于这样的解，非树弧 $(i,j) \\in A \\setminus T$ 上的流量被设置为其下界，在本问题中为 $0$。然后，树弧上的流量由流量守恒方程唯一确定。\n\n线性规划的互补松弛条件决定了原始变量 $x_{ij}$ 和对偶变量 $\\pi_i$ 之间的关系。对于一个最优解，如果 $x_{ij} > 0$，那么相应的对偶约束必须是紧的，即 $\\pi_i - \\pi_j = c_{ij}$。\n在网络单纯形算法中，我们通过对所有基弧强制执行此条件来定义给定基 $T$ 的节点势：\n$\\pi_i - \\pi_j = c_{ij} \\quad \\forall (i,j) \\in T$\n\n这给出了一个包含 $|N|$ 个变量的 $|N|-1$ 个方程组，其有一个自由度。按照题目要求，我们通过将一个势设置为任意值（例如 $\\pi_1=0$）来固定这个自由度。\n\n对于任何弧 $(i,j) \\in A$，其简约成本 $\\bar{c}_{ij}$ 定义为 $\\bar{c}_{ij} = c_{ij} - (\\pi_i - \\pi_j) = c_{ij} - \\pi_i + \\pi_j$。对于任何基弧 $(i,j) \\in T$，其简约成本为 $\\bar{c}_{ij} = c_{ij} - c_{ij} = 0$。对于一个非基弧 $(i,j) \\in A \\setminus T$，简约成本表示该弧上流量增加一个单位时总成本的变化。如果所有非基弧的 $\\bar{c}_{ij} \\ge 0$，则当前的基可行解是最优的。如果某个非基弧 $(i,j)$ 的 $\\bar{c}_{ij}  0$，则可以通过增加该弧上的流量来降低总成本。这样的弧是基的一个合格的“入基弧”。\n\n现在，我们将此框架应用于给定的问题。\n\n**1. 计算节点势 $\\pi_i$**\n\n基树是 $T = \\{(1,2), (2,3), (2,4), (4,5)\\}$。这些弧的成本是 $c_{12}=3$，$c_{23}=-1$，$c_{24}=2$ 和 $c_{45}=0$。我们设置 $\\pi_1=0$ 并求解方程组 $\\pi_i - \\pi_j = c_{ij}$ (对于 $(i,j) \\in T$）。\n\n- 对于弧 $(1,2) \\in T$：$\\pi_1 - \\pi_2 = c_{12} \\implies 0 - \\pi_2 = 3 \\implies \\pi_2 = -3$。\n- 对于弧 $(2,3) \\in T$：$\\pi_2 - \\pi_3 = c_{23} \\implies -3 - \\pi_3 = -1 \\implies \\pi_3 = -3 + 1 = -2$。\n- 对于弧 $(2,4) \\in T$：$\\pi_2 - \\pi_4 = c_{24} \\implies -3 - \\pi_4 = 2 \\implies \\pi_4 = -3 - 2 = -5$。\n- 对于弧 $(4,5) \\in T$：$\\pi_4 - \\pi_5 = c_{45} \\implies -5 - \\pi_5 = 0 \\implies \\pi_5 = -5$。\n\n节点势为：$\\pi_1=0$，$\\pi_2=-3$，$\\pi_3=-2$，$\\pi_4=-5$，$\\pi_5=-5$。\n\n**2. 计算非树弧的简约成本 $\\bar{c}_{ij}$**\n\n非树弧是 $(1,3)$，$(3,4)$，$(5,3)$，$(1,4)$，$(2,5)$ 和 $(5,1)$。我们使用公式 $\\bar{c}_{ij} = c_{ij} - \\pi_i + \\pi_j$。\n\n- 对于弧 $(1,3)$：$\\bar{c}_{13} = c_{13} - \\pi_1 + \\pi_3 = 6 - 0 + (-2) = 4$。\n- 对于弧 $(3,4)$：$\\bar{c}_{34} = c_{34} - \\pi_3 + \\pi_4 = -2 - (-2) + (-5) = -2 + 2 - 5 = -5$。\n- 对于弧 $(5,3)$：$\\bar{c}_{53} = c_{53} - \\pi_5 + \\pi_3 = 4 - (-5) + (-2) = 4 + 5 - 2 = 7$。\n- 对于弧 $(1,4)$：$\\bar{c}_{14} = c_{14} - \\pi_1 + \\pi_4 = 1 - 0 + (-5) = -4$。\n- 对于弧 $(2,5)$：$\\bar{c}_{25} = c_{25} - \\pi_2 + \\pi_5 = 1 - (-3) + (-5) = 1 + 3 - 5 = -1$。\n- 对于弧 $(5,1)$：$\\bar{c}_{51} = c_{51} - \\pi_5 + \\pi_1 = -3 - (-5) + 0 = -3 + 5 = 2$。\n\n非树弧的简约成本为 $\\bar{c}_{13}=4$，$\\bar{c}_{34}=-5$，$\\bar{c}_{53}=7$，$\\bar{c}_{14}=-4$，$\\bar{c}_{25}=-1$ 和 $\\bar{c}_{51}=2$。\n\n**3. 识别合格的入基弧**\n\n合格的入基弧是那些简约成本为负的非树弧。根据步骤2中的计算，这些弧是：\n- 弧 $(3,4)$，简约成本为 $\\bar{c}_{34}=-5$。\n- 弧 $(1,4)$，简约成本为 $\\bar{c}_{14}=-4$。\n- 弧 $(2,5)$，简约成本为 $\\bar{c}_{25}=-1$。\n\n当前的基可行解不是最优的，因为存在简约成本为负的非基弧。\n\n**4. 报告最小简约成本**\n\n最后一步是找到所有计算出的非树弧简约成本中的最小值。\n简约成本的集合是 $\\{4, -5, 7, -4, -1, 2\\}$。\n该集合中的最小值是 $\\min\\{4, -5, 7, -4, -1, 2\\} = -5$。这对应于弧 $(3,4)$。根据最负简约成本枢轴规则，在下一次迭代中将选择弧 $(3,4)$ 入基。\n\n所有非树弧的最小简约成本是 $-5$。", "answer": "$$\\boxed{-5}$$", "id": "3151075"}]}