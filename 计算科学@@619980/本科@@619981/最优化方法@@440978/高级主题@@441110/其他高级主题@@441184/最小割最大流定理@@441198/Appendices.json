{"hands_on_practices": [{"introduction": "最大流最小割定理的核心在于其优雅的对偶性：网络中从源点到汇点的最大流量精确等于分离源汇的最小割容量。为了真正掌握这一定理，亲手验证这种相等性是至关重要的第一步。本练习 [@problem_id:1408993] 提供了一个具体的网络，要求你分别计算最大流值和最小割容量，从而直接体验该定理的实际应用和其内在美。", "problem": "考虑一个由有向图表示的小型数据传输网络。该网络有一个源节点 `S`，一个汇点 `T`，以及四个中间路由节点 `A`、`B`、`C` 和 `D`。有向链路及其对应的最大数据承载容量（以任意流量单位计）如下：\n- 从 `S` 到 `A`，容量为 10。\n- 从 `S` 到 `C`，容量为 12。\n- 从 `A` 到 `B`，容量为 7。\n- 从 `A` 到 `D`，容量为 4。\n- 从 `B` 到 `T`，容量为 10。\n- 从 `C` 到 `D`，容量为 9。\n- 从 `D` 到 `B`，容量为 3。\n- 从 `D` 到 `T`，容量为 8。\n\n所有链路都是指定的单向链路。网络中没有其他链路。目标是确定该网络的吞吐量。\n\n计算从源点 `S` 到汇点 `T` 的最大流量值，并计算最小 `S-T` 割的容量。按指定顺序提供两个整数值：首先是最大流量值，然后是最小割容量。", "solution": "设 $G=(V,E)$ 为一个有向图，其中源点为 $S$，汇点为 $T$，中间节点为 $A、B、C、D$。对于每条有向边 $(u,v)\\in E$，设其容量为 $c_{uv}$，流量为 $f_{uv}$，满足 $0\\leq f_{uv}\\leq c_{uv}$。流量守恒在中间节点成立：对于每个 $v\\in\\{A,B,C,D\\}$，\n$$\n\\sum_{u:(u,v)\\in E} f_{uv}=\\sum_{w:(v,w)\\in E} f_{vw}.\n$$\n各边容量如下：\n$$\nc_{S,A}=10,\\quad c_{S,C}=12,\\quad c_{A,B}=7,\\quad c_{A,D}=4,\\quad c_{B,T}=10,\\quad c_{C,D}=9,\\quad c_{D,B}=3,\\quad c_{D,T}=8.\n$$\n\n应用 Ford–Fulkerson 方法，使用增广路径和残余容量。\n\n1) 沿路径 $S\\to A\\to B\\to T$ 进行增广。瓶颈容量是\n$$\n\\min\\{c_{S,A},c_{A,B},c_{B,T}\\}=\\min\\{10,7,10\\}=7.\n$$\n发送 $7$ 单位流量：设 $f_{S,A}=7$, $f_{A,B}=7$, $f_{B,T}=7$。\n\n2) 沿路径 $S\\to C\\to D\\to T$ 进行增广。瓶颈容量是\n$$\n\\min\\{c_{S,C},c_{C,D},c_{D,T}\\}=\\min\\{12,9,8\\}=8.\n$$\n发送 $8$ 单位流量：设 $f_{S,C}=8$, $f_{C,D}=8$, $f_{D,T}=8$。\n\n3) 在残余网络中考虑路径 $S\\to A\\to D\\to B\\to T$。这些弧上的当前正向残余容量为\n$$\nr_{S,A}=c_{S,A}-f_{S,A}=10-7=3,\\quad r_{A,D}=c_{A,D}-f_{A,D}=4-0=4,\n$$\n$$\nr_{D,B}=c_{D,B}-f_{D,B}=3-0=3,\\quad r_{B,T}=c_{B,T}-f_{B,T}=10-7=3.\n$$\n瓶颈容量是 $\\min\\{3,4,3,3\\}=3$。沿此路径增广 $3$ 单位流量：更新\n$$\nf_{S,A}=7+3=10,\\quad f_{A,D}=0+3=3,\\quad f_{D,B}=0+3=3,\\quad f_{B,T}=7+3=10.\n$$\n\n计算这些增广后的总流量值。在汇点处，\n$$\n|f|=f_{B,T}+f_{D,T}=10+8=18.\n$$\n或者，在源点处，\n$$\n|f|=f_{S,A}+f_{S,C}=10+8=18.\n$$\n\n验证不存在更多增广路径。在残余图中，到 $T$ 的正向残余容量为 $r_{B,T}=10-10=0$ 和 $r_{D,T}=8-8=0$。从 $S$ 出发，通过残余边可达的节点有 $S\\to C$（残余容量 $r_{S,C}=12-8=4$），然后是 $C\\to D$（残余容量 $r_{C,D}=9-8=1$），以及通过 $(A,D)$ 的反向边 $D\\to A$（残余容量为 $f_{A,D}=3$），因此 $A$ 是可达的。节点 $B$ 不可达，因为 $r_{A,B}=7-7=0$ 且 $r_{D,B}=3-3=0$；节点 $T$ 也不可达，因为 $r_{B,T}=0$ 且 $r_{D,T}=0$。因此，可达集为 $R=\\{S,A,C,D\\}$。\n\n割 $(R,\\overline{R})$ 的容量是从 $R$ 到 $\\overline{R}=\\{B,T\\}$ 的边的容量之和：\n$$\nc(R,\\overline{R})=c_{A,B}+c_{D,B}+c_{D,T}=7+3+8=18\n$$\n根据最大流最小割定理，最大流量等于最小割容量，这与我们构造的流量值相符。因此，最大 $S$–$T$ 流量为 $18$，最小割容量为 $18$。", "answer": "$$\\boxed{\\begin{pmatrix} 18  18 \\end{pmatrix}}$$", "id": "1408993"}, {"introduction": "在理解了最大流与最小割的数值相等性之后，我们来更深入地探讨最小割的本质。一个常见的误解是认为最小割必须由网络中容量最小的边构成。本练习 [@problem_id:1408947] 通过一个包含无限容量边的巧妙思想实验，挑战了这一直觉，它揭示了最小割是由网络节点的最佳“划分”决定的，而不仅仅是边容量的简单堆砌。", "problem": "一家技术咨询公司正在分析客户的数据流网络。该网络被建模为一个有向图，其中节点是数据中心，边的容量代表最大数据传输速率，单位为太比特/秒 (Tbps)。目标是确定从源数据中心 $s$ 到汇数据中心 $t$ 的最大可持续数据流。\n\n该网络由四个节点组成：源点 $s$、汇点 $t$、一个中间中心 $A$ 和另一个中间中心 $B$。有向边及其容量如下：\n- 从 $s$ 到 $A$ 的边，容量为 10 Tbps。\n- 从 $s$ 到 $B$ 的边，容量为 5 Tbps。\n- 从 $A$ 到 $t$ 的边，容量为 3 Tbps。\n- 从 $B$ 到 $t$ 的边，容量为 8 Tbps。\n- 从 $B$ 到 $A$ 的一条特殊高带宽链路，容量几乎为无穷大。\n\n根据最大流最小割定理，从源点 $s$ 到汇点 $t$ 的最大流等于 $s-t$ 割的最小容量。一个 $s-t$ 割是将顶点划分为两个不相交的集合 $S$ 和 $T$，使得 $s \\in S$ 且 $t \\in T$。如果一条边的端点位于划分的不同集合中，则该边被认为是割划分的一部分。割的容量定义为所有从 $S$ 中的起点 $u$ 到 $T$ 中的终点 $v$ 的边 $(u,v)$ 的容量之和。\n\n根据这些信息，下列关于此网络的陈述中哪一个是正确的？\n\nA. 最大流为 13 Tbps，且无限容量边 $(B, A)$ 不穿过最小割划分。\n\nB. 最大流为 8 Tbps，且无限容量边 $(B, A)$ 从 $T$ 中的节点穿过最小割划分到 $S$ 中的节点。\n\nC. 最大流为 8 Tbps，且无限容量边 $(B, A)$ 不穿过最小割划分。\n\nD. 最大流为 15 Tbps，且无限容量边 $(B, A)$ 从 $S$ 中的节点穿过最小割划分到 $T$ 中的节点。\n\nE. 具有无限容量的边不可能成为具有有限容量的最小割划分的一部分。", "solution": "我们将网络建模为一个有向图，其容量表示为 $c(u,v)$。给定的容量为：\n$$\nc(s,A)=10,\\quad c(s,B)=5,\\quad c(A,t)=3,\\quad c(B,t)=8,\\quad c(B,A)=+\\infty.\n$$\n根据最大流最小割定理，最大 $s-t$ 流等于所有 $s-t$ 割的最小容量。一个 $s-t$ 割是一个划分 $(S,T)$，其中 $s\\in S$ 且 $t\\in T$，其容量为\n$$\n\\operatorname{cap}(S,T)=\\sum_{u\\in S,\\,v\\in T} c(u,v).\n$$\n对于顶点 $\\{s,A,B,t\\}$，可能的集合 $S$ 有 $\\{s\\}$、$\\{s,A\\}$、$\\{s,B\\}$ 和 $\\{s,A,B\\}$。计算割的容量：\n\n1) 对于 $S=\\{s\\}$ 和 $T=\\{A,B,t\\}$，\n$$\n\\operatorname{cap}(S,T)=c(s,A)+c(s,B)=10+5=15.\n$$\n\n2) 对于 $S=\\{s,A\\}$ 和 $T=\\{B,t\\}$，\n$$\n\\operatorname{cap}(S,T)=c(s,B)+c(A,t)=5+3=8.\n$$\n边 $c(B,A)=+\\infty$ 是从 $T$ 到 $S$ 的，不计入割容量。\n\n3) 对于 $S=\\{s,B\\}$ 和 $T=\\{A,t\\}$，\n$$\n\\operatorname{cap}(S,T)=c(s,A)+c(B,t)+c(B,A)=10+8+(+\\infty)=+\\infty.\n$$\n\n4) 对于 $S=\\{s,A,B\\}$ 和 $T=\\{t\\}$，\n$$\n\\operatorname{cap}(S,T)=c(A,t)+c(B,t)=3+8=11.\n$$\n\n因此最小割容量是\n$$\n\\min\\{15,\\,8,\\,+\\infty,\\,11\\}=8,\n$$\n由割 $S=\\{s,A\\}$，$T=\\{B,t\\}$ 实现。因此，最大流为 $8$。在这个最小割中，无限容量边 $(B,A)$ 从 $B\\in T$ 穿过划分到 $A\\in S$，即从 $T$ 到 $S$，因此它对割容量没有贡献。这与陈述 B 相符。\n\n为了完整起见，一个值为 $8$ 的可行流如下：\n$$\nf(s,A)=3,\\quad f(s,B)=5,\\quad f(A,t)=3,\\quad f(B,t)=5,\\quad f(B,A)=0,\n$$\n这个流遵守所有容量限制并实现了值为 $8$ 的流，通过最小割值证实了其最优性。", "answer": "$$\\boxed{B}$$", "id": "1408947"}, {"introduction": "最大流最小割定理保证了最大流的存在及其数值，但寻找这个流的算法效率则另当别论。Ford-Fulkerson 算法是解决此问题的经典方法，但其效率高度依赖于增广路径的选择策略。本高级练习 [@problem_id:1408949] 构造了一个特殊的网络，它会使得朴素的增广路径选择策略导致算法性能急剧下降。通过分析这个“最坏情况”，你将深刻理解为何需要更智能的算法（如 Edmonds-Karp）来保证高效求解。", "problem": "考虑一个用于模拟源点 `S` 和汇点 `T` 之间数据传输的有向有容量网络。该网络包含四个中间数据枢纽：`U1`、`U2`、`V1` 和 `V2`。网络中的连接及其最大数据传输速率（容量）定义如下，其中 $K$ 是一个大的整数常量：\n- $(S, U1)$，容量为 $K$\n- $(S, U2)$，容量为 $K$\n- $(U1, V1)$，容量为 $K$\n- $(U2, V2)$，容量为 $K$\n- $(V1, T)$，容量为 $K$\n- $(V2, T)$，容量为 $K$\n- $(V1, V2)$，容量为 $1$\n\n一位分析师正在使用 Ford-Fulkerson 算法的一个特定实现来确定从 `S` 到 `T` 的最大流。该实现采用一种特定的、非最优的增广路径选择策略，我们称之为贪心过桥法（Greedy Bridge-Using, GBU）。GBU 方法遵循以下规则：\n\n*   如果当前残留图中存在包含边 $(V1, V2)$ 或 $(V2, V1)$ 的增广路径，则算法**必须**选择这样一条路径。\n\n假设算法从零流开始，并重复应用 GBU 方法来增加流量，直到达到最大流。当 $K = 1989$ 时，该算法将执行的总增广次数是多少？", "solution": "设所有初始流均为零。GBU 规则强制要求，只要存在包含单位容量桥边 $(V_{1},V_{2})$ 或其反向残留边 $(V_{2},V_{1})$ 的增广路径，所选的增广路径就必须包含它们。由于桥边的容量为 $1$，任何此类增广路径的瓶颈均为 $1$，因此每次增广都会使 $S–T$ 的总流量恰好增加 $1$。\n\n引入计数器：\n- 设 $a$ 为沿路径 $S \\to U_{1} \\to V_{1} \\to V_{2} \\to T$ 使用正向桥边 $(V_{1},V_{2})$ 的增广次数。\n- 设 $b$ 为沿路径 $S \\to U_{2} \\to V_{2} \\to V_{1} \\to T$ 使用反向残留边 $(V_{2},V_{1})$ 的增广次数。\n\n每次增广对流量的更新如下：\n- 使用 $(V_{1},V_{2})$ 会使 $f(S,U_{1})$、$f(U_{1},V_{1})$ 和 $f(V_{2},T)$ 增加 $1$，并使 $f(V_{1},V_{2})$ 增加 $1$。\n- 使用 $(V_{2},V_{1})$ 会使 $f(S,U_{2})$、$f(U_{2},V_{2})$ 和 $f(V_{1},T)$ 增加 $1$，并使 $f(V_{1},V_{2})$ 减少 $1$（因为它使用反向残留边来抵消 $(V_{1},V_{2})$ 上的一个单位流量）。\n\n因此，在 $a$ 次正向桥边增广和 $b$ 次反向桥边增广之后，\n$$\nf(S,U_{1})=a,\\quad f(U_{1},V_{1})=a,\\quad f(V_{2},T)=a,\n$$\n$$\nf(S,U_{2})=b,\\quad f(U_{2},V_{2})=b,\\quad f(V_{1},T)=b,\n$$\n以及\n$$\nf(V_{1},V_{2})=a-b,\\quad \\text{with } 0 \\leq f(V_{1},V_{2}) \\leq 1.\n$$\n总流量值为\n$$\n|f|=f(V_{1},T)+f(V_{2},T)=b+a.\n$$\n\n残留图中是否存在包含桥边的增广路径，取决于以下条件：\n- 如果 $f(V_{1},V_{2})=0$（即 $a=b$），那么残留边 $(V_{1},V_{2})$ 可用，容量为 $1$。路径 $S \\to U_{1} \\to V_{1} \\to V_{2} \\to T$ 存在的充要条件是边 $(S,U_{1})$、$(U_{1},V_{1})$ 和 $(V_{2},T)$ 的残留容量为正。这些残留容量分别为 $K-a$、$K-a$ 和 $K-a$，因此条件是 $a  K$。\n- 如果 $f(V_{1},V_{2})=1$（即 $a=b+1$），那么反向残留边 $(V_{2},V_{1})$ 可用，容量为 $1$。路径 $S \\to U_{2} \\to V_{2} \\to V_{1} \\to T$ 存在的充要条件是边 $(S,U_{2})$、$(U_{2},V_{2})$ 和 $(V_{1},T)$ 的残留容量为正。这些残留容量分别为 $K-b$、$K-b$ 和 $K-b$，因此条件是 $b  K$。\n\nGBU 策略强制算法在两种使用“桥”的路径之间交替进行增广，每次增广流量增加 $1$。算法会先选择前向路径（$a=1, b=0$），然后选择后向路径（$a=1, b=1$），再选择前向路径（$a=2, b=1$），以此类推。\n\n这个交替过程会持续进行，直到其中一种路径因为其非桥部分饱和而无法再使用。这发生在 $a=K$ 或 $b=K$ 时。由于是交替进行，算法将执行 $K$ 次前向增广和 $K$ 次后向增广。\n\n总共进行了 $K+K=2K$ 次增广。在这一点上，总流量为 $a+b=K+K=2K$，这等于网络的最大流（通过路径 $S \\to U_1 \\to V_1 \\to T$ 发送 $K$ 流量，通过路径 $S \\to U_2 \\to V_2 \\to T$ 发送 $K$ 流量）。由于已达到最大流，算法终止。\n\n当 $K=1989$ 时，总增广次数为 $2 \\times 1989 = 3978$。", "answer": "$$\\boxed{3978}$$", "id": "1408949"}]}