{"hands_on_practices": [{"introduction": "要真正理解一个算法，没有什么比亲手应用它更好的方法了。第一个练习将引导你对一个简单的线性规划问题，完整地执行两轮椭球法迭代。通过手动计算新的中心点和形状矩阵，你将对算法的迭代收缩机制获得具体的理解，并验证其核心属性。[@problem_id:3125375]", "problem": "考虑 $\\mathbb{R}^{3}$ 中的以下线性规划（LP）可行性实例：\n寻找 $x \\in \\mathbb{R}^{3}$ 使得\n- $x_{1} \\ge 0$, $x_{2} \\ge 0$, $x_{3} \\ge 0$,\n- $x_{1} + x_{2} + x_{3} \\le 1$.\n\n设初始椭球为\n$$\n\\mathcal{E}_{0} = \\{\\, x \\in \\mathbb{R}^{3} : (x - c_{0})^{\\mathsf{T}} P_{0}^{-1} (x - c_{0}) \\le 1 \\,\\},\n$$\n其中心为 $c_{0} = (1, 1, 1)^{\\mathsf{T}}$，形状矩阵为 $P_{0} = 4 I_{3}$，其中 $I_{3}$ 是 $3 \\times 3$ 单位矩阵。你将使用经典中心切割椭球法进行两次迭代，每次迭代都使用违反的不等式作为分离超平面。在每次迭代中，当在当前中心 $c$ 处发现一个违反的不等式 $a^{\\mathsf{T}} x \\le b$ 时，使用中心切割 $a^{\\mathsf{T}} x \\le a^{\\mathsf{T}} c$ 来更新椭球。\n\n任务：\n1. 在第 1 次迭代中，找出在 $c_{0}$ 处违反的一个约束，形成相应的中心切割，并计算下一个椭球 $\\mathcal{E}_{1}$ 的更新中心 $c_{1}$ 和形状矩阵 $P_{1}$。明确写出你的中间计算过程。\n2. 在第 2 次迭代中，重复相同的过程：使用 $c_{1}$ 和 $P_{1}$，找出在 $c_{1}$ 处违反的一个约束，形成中心切割，并计算 $\\mathcal{E}_{2}$ 的更新中心 $c_{2}$ 和形状矩阵 $P_{2}$。\n3. 每次迭代后，仅使用中心切割的定义和集合包含的推理来证明真实可行域仍然包含在更新后的椭球中。\n4. 最后，计算比值 $\\det(P_{2}) / \\det(P_{0})$ 的精确值。将你的最终答案表示为单个精确表达式。不要四舍五入。", "solution": "该问题是有效的，因为它是优化理论中椭球法的一个明确定义的应用，具有自洽和一致的设置。初始椭球保证包含可行域，这是该方法的必要前提条件。\n\n问题设置在维度 $n=3$。可行域 $S$ 由以下线性不等式定义：\n$$S = \\{ x \\in \\mathbb{R}^{3} \\mid x_1 \\ge 0, x_2 \\ge 0, x_3 \\ge 0, x_1+x_2+x_3 \\le 1 \\}$$\n这些可以写成矩阵形式 $a_i^{\\mathsf{T}}x \\le b_i$：\n1. $-x_1 \\le 0$\n2. $-x_2 \\le 0$\n3. $-x_3 \\le 0$\n4. $x_1+x_2+x_3 \\le 1$\n\n初始椭球为 $\\mathcal{E}_0 = \\{ x \\in \\mathbb{R}^{3} : (x - c_0)^{\\mathsf{T}} P_0^{-1} (x - c_0) \\le 1 \\}$，其中心为 $c_0 = (1, 1, 1)^{\\mathsf{T}}$，形状矩阵为 $P_0 = 4I_3$。\n\n对于维度 $n=3$，中心切割椭球法的更新公式为：\n下一个中心 $c_{k+1}$ 由下式给出：\n$$c_{k+1} = c_k - \\frac{1}{n+1} \\frac{P_k g_k}{\\sqrt{g_k^{\\mathsf{T}} P_k g_k}} = c_k - \\frac{1}{4} \\frac{P_k g_k}{\\sqrt{g_k^{\\mathsf{T}} P_k g_k}}$$\n下一个形状矩阵 $P_{k+1}$ 由下式给出：\n$$P_{k+1} = \\frac{n^2}{n^2-1} \\left( P_k - \\frac{2}{n+1} \\frac{(P_k g_k)(P_k g_k)^{\\mathsf{T}}}{g_k^{\\mathsf{T}} P_k g_k} \\right) = \\frac{9}{8} \\left( P_k - \\frac{1}{2} \\frac{(P_k g_k)(P_k g_k)^{\\mathsf{T}}}{g_k^{\\mathsf{T}} P_k g_k} \\right)$$\n其中 $g_k$ 是违反的约束 $a^{\\mathsf{T}}x \\le b$ 的法向量，因此 $g_k=a$。\n\n**任务 1：第 1 次迭代**\n\n首先，我们检查中心 $c_0 = (1, 1, 1)^{\\mathsf{T}}$ 违反了哪个约束。\n1. $x_1 \\ge 0 \\implies 1 \\ge 0$. (满足)\n2. $x_2 \\ge 0 \\implies 1 \\ge 0$. (满足)\n3. $x_3 \\ge 0 \\implies 1 \\ge 0$. (满足)\n4. $x_1+x_2+x_3 \\le 1 \\implies 1+1+1 = 3 \\le 1$. (违反)\n\n违反的约束是 $x_1+x_2+x_3 \\le 1$。法向量是 $g_0 = (1, 1, 1)^{\\mathsf{T}}$。\n现在我们计算更新所需的项。\n$$P_0 g_0 = (4I_3) g_0 = 4g_0 = \\begin{pmatrix} 4 \\\\ 4 \\\\ 4 \\end{pmatrix}$$\n$$g_0^{\\mathsf{T}} P_0 g_0 = g_0^{\\mathsf{T}} (4g_0) = 4 (g_0^{\\mathsf{T}} g_0) = 4(1^2+1^2+1^2) = 12$$\n$$\\sqrt{g_0^{\\mathsf{T}} P_0 g_0} = \\sqrt{12} = 2\\sqrt{3}$$\n\n现在，我们计算更新后的中心 $c_1$：\n$$c_1 = c_0 - \\frac{1}{4} \\frac{P_0 g_0}{\\sqrt{g_0^{\\mathsf{T}} P_0 g_0}} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\frac{1}{4} \\frac{\\begin{pmatrix} 4 \\\\ 4 \\\\ 4 \\end{pmatrix}}{2\\sqrt{3}} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\frac{1}{2\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\left(1 - \\frac{\\sqrt{3}}{6}\\right) \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n所以，$c_1 = \\left( \\frac{6-\\sqrt{3}}{6}, \\frac{6-\\sqrt{3}}{6}, \\frac{6-\\sqrt{3}}{6} \\right)^{\\mathsf{T}}$。\n\n接下来，我们计算更新后的形状矩阵 $P_1$：\n$$(P_0 g_0)(P_0 g_0)^{\\mathsf{T}} = \\begin{pmatrix} 4 \\\\ 4 \\\\ 4 \\end{pmatrix} \\begin{pmatrix} 4  4  4 \\end{pmatrix} = 16 \\begin{pmatrix} 1  1  1 \\\\ 1  1  1 \\\\ 1  1  1 \\end{pmatrix}$$\n$$P_1 = \\frac{9}{8} \\left( 4I_3 - \\frac{1}{2} \\frac{16 \\begin{pmatrix} 1  1  1 \\\\ 1  1  1 \\\\ 1  1  1 \\end{pmatrix}}{12} \\right) = \\frac{9}{8} \\left( 4I_3 - \\frac{2}{3} \\begin{pmatrix} 1  1  1 \\\\ 1  1  1 \\\\ 1  1  1 \\end{pmatrix} \\right)$$\n$$P_1 = \\frac{9}{8} \\begin{pmatrix} 4-\\frac{2}{3}   -\\frac{2}{3}   -\\frac{2}{3} \\\\ -\\frac{2}{3}   4-\\frac{2}{3}   -\\frac{2}{3} \\\\ -\\frac{2}{3}   -\\frac{2}{3}   4-\\frac{2}{3} \\end{pmatrix} = \\frac{9}{8} \\begin{pmatrix} \\frac{10}{3}   -\\frac{2}{3}   -\\frac{2}{3} \\\\ -\\frac{2}{3}   \\frac{10}{3}   -\\frac{2}{3} \\\\ -\\frac{2}{3}   -\\frac{2}{3}   \\frac{10}{3} \\end{pmatrix} = \\frac{9}{8} \\frac{2}{3} \\begin{pmatrix} 5   -1   -1 \\\\ -1   5   -1 \\\\ -1   -1   5 \\end{pmatrix}$$\n$$P_1 = \\frac{3}{4} \\begin{pmatrix} 5   -1   -1 \\\\ -1   5   -1 \\\\ -1   -1   5 \\end{pmatrix}$$\n\n**任务 2：第 2 次迭代**\n\n我们检查 $c_1 = (\\alpha, \\alpha, \\alpha)^{\\mathsf{T}}$ 违反了哪个约束，其中 $\\alpha = 1 - \\frac{\\sqrt{3}}{6}$。\n因为 $\\sqrt{3}  6$，所以 $\\alpha = 1 - \\frac{\\sqrt{3}}{6} > 0$。因此，$c_1$ 的所有分量均为正，满足约束 $x_1 \\ge 0$、$x_2 \\ge 0$ 和 $x_3 \\ge 0$。\n对于第四个约束：\n$$x_1+x_2+x_3 = 3\\alpha = 3\\left(1 - \\frac{\\sqrt{3}}{6}\\right) = 3 - \\frac{\\sqrt{3}}{2}$$\n我们检查 $3 - \\frac{\\sqrt{3}}{2} \\le 1$ 是否成立。这等价于 $2 \\le \\frac{\\sqrt{3}}{2}$，或 $4 \\le \\sqrt{3}$，这是错误的，因为 $16 \\le 3$ 是错误的。因此，约束 $x_1+x_2+x_3 \\le 1$ 被违反。\n法向量是 $g_1 = (1, 1, 1)^{\\mathsf{T}}$。\n我们计算更新所需的项：\n$$P_1 g_1 = \\frac{3}{4} \\begin{pmatrix} 5   -1   -1 \\\\ -1   5   -1 \\\\ -1   -1   5 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{3}{4} \\begin{pmatrix} 3 \\\\ 3 \\\\ 3 \\end{pmatrix} = \\frac{9}{4} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n$$g_1^{\\mathsf{T}} P_1 g_1 = g_1^{\\mathsf{T}} (P_1 g_1) = \\begin{pmatrix} 1   1   1 \\end{pmatrix} \\frac{9}{4} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{9}{4}(1+1+1) = \\frac{27}{4}$$\n$$\\sqrt{g_1^{\\mathsf{T}} P_1 g_1} = \\sqrt{\\frac{27}{4}} = \\frac{3\\sqrt{3}}{2}$$\n\n现在，我们计算更新后的中心 $c_2$：\n$$c_2 = c_1 - \\frac{1}{4} \\frac{P_1 g_1}{\\sqrt{g_1^{\\mathsf{T}} P_1 g_1}} = \\left(1 - \\frac{\\sqrt{3}}{6}\\right)\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\frac{1}{4} \\frac{\\frac{9}{4}\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}}{\\frac{3\\sqrt{3}}{2}}$$\n$$ \\frac{\\frac{9}{4}}{\\frac{3\\sqrt{3}}{2}} = \\frac{9}{4} \\cdot \\frac{2}{3\\sqrt{3}} = \\frac{3}{2\\sqrt{3}} = \\frac{\\sqrt{3}}{2} $$\n$$c_2 = \\left(1 - \\frac{\\sqrt{3}}{6}\\right)\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\frac{1}{4} \\left(\\frac{\\sqrt{3}}{2}\\right) \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\left(1 - \\frac{\\sqrt{3}}{6} - \\frac{\\sqrt{3}}{8}\\right) \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n$$c_2 = \\left(1 - \\left(\\frac{4\\sqrt{3}+3\\sqrt{3}}{24}\\right)\\right) \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\left(1 - \\frac{7\\sqrt{3}}{24}\\right) \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n\n最后，我们计算更新后的形状矩阵 $P_2$：\n$$(P_1 g_1)(P_1 g_1)^{\\mathsf{T}} = \\left(\\frac{9}{4}\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\\right) \\left(\\frac{9}{4}\\begin{pmatrix} 1   1   1 \\end{pmatrix}\\right) = \\frac{81}{16} \\begin{pmatrix} 1   1   1 \\\\ 1   1   1 \\\\ 1   1   1 \\end{pmatrix}$$\n$$P_2 = \\frac{9}{8} \\left( P_1 - \\frac{1}{2} \\frac{\\frac{81}{16} \\begin{pmatrix} 1   1   1 \\\\ 1   1   1 \\\\ 1   1   1 \\end{pmatrix}}{\\frac{27}{4}} \\right) = \\frac{9}{8} \\left( P_1 - \\frac{1}{2} \\left(\\frac{3}{4}\\right) \\begin{pmatrix} 1   1   1 \\\\ 1   1   1 \\\\ 1   1   1 \\end{pmatrix} \\right)$$\n$$P_2 = \\frac{9}{8} \\left( \\frac{3}{4} \\begin{pmatrix} 5   -1   -1 \\\\ -1   5   -1 \\\\ -1   -1   5 \\end{pmatrix} - \\frac{3}{8} \\begin{pmatrix} 1   1   1 \\\\ 1   1   1 \\\\ 1   1   1 \\end{pmatrix} \\right)$$\n$$P_2 = \\frac{9}{8} \\frac{3}{8} \\left( 2 \\begin{pmatrix} 5   -1   -1 \\\\ -1   5   -1 \\\\ -1   -1   5 \\end{pmatrix} - \\begin{pmatrix} 1   1   1 \\\\ 1   1   1 \\\\ 1   1   1 \\end{pmatrix} \\right) = \\frac{27}{64} \\begin{pmatrix} 9   -3   -3 \\\\ -3   9   -3 \\\\ -3   -3   9 \\end{pmatrix}$$\n$$P_2 = \\frac{81}{64} \\begin{pmatrix} 3   -1   -1 \\\\ -1   3   -1 \\\\ -1   -1   3 \\end{pmatrix}$$\n\n**任务 3：可行域包含性的证明**\n\n设 $S$ 为可行域，$\\mathcal{E}_k$ 为第 $k$ 次迭代时的椭球。根据假设，$S \\subseteq \\mathcal{E}_0$。椭球法在所有 $k \\ge 0$ 时都保持不变量 $S \\subseteq \\mathcal{E}_k$。\n在第 $k$ 次迭代中，我们有一个中心 $c_k$ 和一个椭球 $\\mathcal{E}_k$ 使得 $S \\subseteq \\mathcal{E}_k$。如果 $c_k \\notin S$，则会找到一个违反的约束 $a^{\\mathsf{T}}x \\le b$，这意味着 $a^{\\mathsf{T}}c_k > b$。\n对于任何点 $x \\in S$，它必须满足这个约束，所以 $a^{\\mathsf{T}}x \\le b$。\n结合这些，我们得到对于所有 $x \\in S$ 都有 $a^{\\mathsf{T}}x \\le b  a^{\\mathsf{T}}c_k$。这意味着整个可行域 $S$ 位于半空间 $\\{x \\in \\mathbb{R}^n : a^{\\mathsf{T}}x \\le a^{\\mathsf{T}}c_k \\}$ 中。\n下一个椭球 $\\mathcal{E}_{k+1}$ 被构造为包含半椭球 $\\mathcal{E}_k' = \\mathcal{E}_k \\cap \\{x \\in \\mathbb{R}^n : a^{\\mathsf{T}}x \\le a^{\\mathsf{T}}c_k \\}$。\n由于 $S \\subseteq \\mathcal{E}_k$ 并且 $S$ 也位于切割半空间中，我们有 $S \\subseteq \\mathcal{E}_k'$。\n根据该方法的构造，$\\mathcal{E}_k' \\subseteq \\mathcal{E}_{k+1}$。\n因此，根据集合包含的传递性，有 $S \\subseteq \\mathcal{E}_{k+1}$。\n这个逻辑对两次迭代（$k=0$ 和 $k=1$）都成立，确保了可行域始终保留在更新后的椭球 $\\mathcal{E}_1$ 和 $\\mathcal{E}_2$ 内。\n\n**任务 4：行列式的比值**\n\n在维度 $n$ 中，对于中心切割，连续形状矩阵的行列式之比由以下公式给出：\n$$\\frac{\\det(P_{k+1})}{\\det(P_k)} = \\left(\\frac{n^2}{n^2-1}\\right)^n \\left(\\frac{n-1}{n+1}\\right)$$\n对于 $n=3$，这个比值是：\n$$\\frac{\\det(P_{k+1})}{\\det(P_k)} = \\left(\\frac{3^2}{3^2-1}\\right)^3 \\left(\\frac{3-1}{3+1}\\right) = \\left(\\frac{9}{8}\\right)^3 \\left(\\frac{2}{4}\\right) = \\frac{729}{512} \\cdot \\frac{1}{2} = \\frac{729}{1024}$$\n由于两个步骤都使用中心切割，这个比值在每次迭代中是恒定的。我们需要找到比值 $\\frac{\\det(P_2)}{\\det(P_0)}$。\n$$\\frac{\\det(P_2)}{\\det(P_0)} = \\frac{\\det(P_2)}{\\det(P_1)} \\cdot \\frac{\\det(P_1)}{\\det(P_0)}$$\n由于两次迭代的比值都是 $\\frac{729}{1024}$，我们有：\n$$\\frac{\\det(P_2)}{\\det(P_0)} = \\left( \\frac{729}{1024} \\right)^2 = \\frac{729^2}{1024^2} = \\frac{531441}{1048576}$$\n这也可以用质因数分解表示：$729 = 3^6$ 和 $1024 = 2^{10}$。\n$$\\frac{\\det(P_2)}{\\det(P_0)} = \\left( \\frac{3^6}{2^{10}} \\right)^2 = \\frac{3^{12}}{2^{20}}$$\n我们也可以直接从我们计算出的矩阵来验证这一点。\n$\\det(P_0) = \\det(4I_3) = 4^3=64$。\n$\\det(P_2) = \\det\\left(\\frac{81}{64} \\begin{pmatrix} 3   -1   -1 \\\\ -1   3   -1 \\\\ -1   -1   3 \\end{pmatrix}\\right) = \\left(\\frac{81}{64}\\right)^3 \\det\\begin{pmatrix} 3   -1   -1 \\\\ -1   3   -1 \\\\ -1   -1   3 \\end{pmatrix}$。\n该矩阵的行列式是 $3(9-1) - (-1)(-3-1) + (-1)(1+3) = 24 - 4 - 4 = 16$。\n$\\det(P_2) = \\left(\\frac{81}{64}\\right)^3 \\cdot 16 = \\frac{(3^4)^3}{(2^6)^3} \\cdot 2^4 = \\frac{3^{12}}{2^{18}} \\cdot 2^4 = \\frac{3^{12}}{2^{14}}$。\n比值为 $\\frac{\\det(P_2)}{\\det(P_0)} = \\frac{3^{12}/2^{14}}{64} = \\frac{3^{12}/2^{14}}{2^6} = \\frac{3^{12}}{2^{20}}$。\n精确表达式为 $\\frac{531441}{1048576}$。", "answer": "$$\\boxed{\\frac{531441}{1048576}}$$", "id": "3125375"}, {"introduction": "椭球法的威力在于其“分离谕示” (separation oracle)，这是一个抽象的概念，用于找到一个将不可行点与目标集分离开来的超平面。本练习将通过一个由二次不等式定义的凸集，让你推导出一个分离超平面，从而揭开谕示的神秘面紗。你将利用一阶凸性原理，了解梯度如何为我们提供进行切割所需的精确信息。[@problem_id:3125337]", "problem": "考虑将椭球法应用于$\\mathbb{R}^{2}$中的一个可行性问题，其中可行域是由二次约束 $x^{\\top} Q x \\leq 1$ 定义的凸集。设对称正定矩阵为\n$$\nQ = \\begin{pmatrix}\n2  1 \\\\\n1  3\n\\end{pmatrix},\n$$\n并假设当前查询点为 $c = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，且发现该点违反了约束。\n\n从凸可微函数的基本定义和凸性的一阶特征（通过梯度和次梯度不等式得到支撑超平面）出发，推导在点 $c$ 处对可行集的一个有效分离半空间。具体来说：\n- 将 $f(x) = x^{\\top} Q x - 1$ 视为定义约束边界的凸函数。\n- 使用第一性原理得到形式为 $g^{\\top} x \\leq \\beta$ 的切割，该切割将可行域与点 $c$ 分离开，其中 $g$ 是由在点 $c$ 处的梯度导出的切割法向量。\n- 计算给定 $Q$ 和 $c$ 时 $g$ 和 $\\beta$ 的具体值。\n\n将切割法向量的分量和标量界 $\\beta$ 一起以单行向量 $\\begin{pmatrix} g_{1}  g_{2}  \\beta \\end{pmatrix}$ 的形式报告。无需四舍五入。", "solution": "我们从约束 $x^{\\top} Q x \\leq 1$ 开始，并定义函数\n$$\nf(x) = x^{\\top} Q x - 1.\n$$\n因为 $Q$ 是对称正定的，二次型 $x^{\\top} Q x$ 是严格凸的。因此，$f(x)$ 是一个凸可微函数，其梯度处处存在。凸可微函数的基本一阶特征表明，对于任意 $x, y \\in \\mathbb{R}^{n}$，\n$$\nf(y) \\geq f(x) + \\nabla f(x)^{\\top} (y - x).\n$$\n对于任意可行点 $y$（即，任意满足 $f(y) \\leq 0$ 的 $y$），代入 $x = c$ 可得\n$$\n0 \\geq f(y) \\geq f(c) + \\nabla f(c)^{\\top} (y - c).\n$$\n整理后得到分离不等式\n$$\n\\nabla f(c)^{\\top} y \\leq \\nabla f(c)^{\\top} c - f(c).\n$$\n因此，可行集的一个有效分离半空间是\n$$\ng^{\\top} x \\leq \\beta \\quad \\text{其中} \\quad g = \\nabla f(c), \\quad \\beta = g^{\\top} c - f(c).\n$$\n\n我们现在计算 $\\nabla f(x)$。由于 $f(x) = x^{\\top} Q x - 1$ 且 $Q$ 是对称的，\n$$\n\\nabla f(x) = (Q + Q^{\\top}) x = 2 Q x.\n$$\n在 $c = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 处求值，\n$$\nQ c = \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n= \\begin{pmatrix} 2 \\cdot 1 + 1 \\cdot 1 \\\\ 1 \\cdot 1 + 3 \\cdot 1 \\end{pmatrix}\n= \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}.\n$$\n因此，\n$$\ng = \\nabla f(c) = 2 Q c = 2 \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ 8 \\end{pmatrix}.\n$$\n\n接下来，计算 $f(c)$：\n$$\nf(c) = c^{\\top} Q c - 1 = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - 1.\n$$\n首先，计算 $Q c = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}$，然后\n$$\nc^{\\top} Q c = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix} = 1 \\cdot 3 + 1 \\cdot 4 = 7,\n$$\n所以\n$$\nf(c) = 7 - 1 = 6.\n$$\n\n最后，计算 $\\beta$：\n$$\n\\beta = g^{\\top} c - f(c) = \\begin{pmatrix} 6  8 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - 6 = (6 \\cdot 1 + 8 \\cdot 1) - 6 = 14 - 6 = 8.\n$$\n\n因此，分离半空间是\n$$\n\\begin{pmatrix} 6  8 \\end{pmatrix} x \\leq 8,\n$$\n所要求的切割参数行向量为\n$$\n\\begin{pmatrix} 6  8  8 \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 6  8  8 \\end{pmatrix}}$$", "id": "3125337"}, {"introduction": "尽管椭球法保证每一步都能缩小体积，但其实际性能在很大程度上取决于椭球的*形状*。本练习探讨了选择切割方向的策略性，分析了切割方向相对于椭球轴如何影响其几何形态。通过比较沿最长轴和最短轴的切割，你将对该方法的收敛行为及其对病态条件的敏感性建立更深刻的直觉。[@problem_id:3125298]", "problem": "考虑椭球方法对一个椭球 $E(P,c) = \\{x \\in \\mathbb{R}^n : (x-c)^\\top P^{-1} (x-c) \\le 1\\}$ 的中心切割迭代，其中 $P \\in \\mathbb{R}^{n \\times n}$ 是对称正定矩阵，且 $c \\in \\mathbb{R}^n$。一个分离超平面通过中心 $c$，其法向量为 $g \\in \\mathbb{R}^n$，即切割为 $\\{x : g^\\top (x-c) \\le 0\\}$。假设 $n \\ge 2$。设 $P$ 的谱分解为 $P = Q \\Lambda Q^\\top$，其中 $\\Lambda = \\mathrm{diag}(\\lambda_1,\\ldots,\\lambda_n)$，排序为 $\\lambda_1 \\ge \\cdots \\ge \\lambda_n  0$，并令 $v_i$ 表示对应于 $\\lambda_i$ 的特征向量。该方法将 $E(P,c)$ 替换为一个包含切割后半椭球的最小体积椭球 $E(P^+,c^+)$。你需要比较 $g$ 的两种各向异性选择：将 $g$ 与 $v_{\\min} = v_n$（最小特征值方向）对齐，以及将 $g$ 与 $v_{\\max} = v_1$（最大特征值方向）对齐。使用椭球法中心切割的核心事实和基础线性代数，确定哪个陈述最能描述这些选择对每次迭代的体积变化、最长半轴长度、条件数 $\\kappa(P) = \\lambda_{\\max}(P)/\\lambda_{\\min}(P)$ 以及实际收敛趋势的影响。\n\n只选择一个选项。\n\nA. 将 $g$ 与 $v_{\\min}$ 对齐会使最长半轴得到最大程度的减小，并使条件数得到最快的改善；与 $v_{\\max}$ 对齐则效果相反。\n\nB. 对于中心切割，每次迭代的体积减小因子与 $g$ 的方向无关。将 $g$ 与 $v_{\\max}$ 对齐会使最长半轴得到最大程度的减小，并将条件数改善一个因子 $(n-1)/(n+1)$；而将 $g$ 与 $v_{\\min}$ 对齐会增加最长半轴，并将条件数恶化一个因子 $(n+1)/(n-1)$，这通常会减慢实际收敛速度。\n\nC. 将 $g$ 与 $v_{\\min}$ 或 $v_{\\max}$ 对齐，对 $P$ 的特征值的更新在重新标记的意义下是相同的，因此两种情况下条件数和最长半轴的变化都相同；只有中心 $c$ 的更新不同。\n\nD. 对所有 $n$，将 $g$ 与 $v_{\\min}$ 对齐既能产生最大的体积减小，又能使最长半轴得到最大程度的减小，使其成为普遍最优的收敛选择。", "solution": "问题要求比较椭球法中中心切割的法向量 $g$ 的两种选择。椭球由 $E(P,c) = \\{x \\in \\mathbb{R}^n : (x-c)^\\top P^{-1} (x-c) \\le 1\\}$ 给出，其中 $P$ 是对称正定矩阵，其特征值为 $\\lambda_1 \\ge \\cdots \\ge \\lambda_n  0$，对应的特征向量为 $v_1, \\ldots, v_n$。$g$ 的两种选择是与 $v_{\\max} = v_1$（对应于最大特征值 $\\lambda_1$ 的特征向量）对齐，以及与 $v_{\\min} = v_n$（对应于最小特征值 $\\lambda_n$ 的特征向量）对齐。椭球的半轴与特征向量 $v_i$ 对齐，长度为 $\\sqrt{\\lambda_i}$。\n\n首先，我们陈述由超平面 $g^\\top (x-c) \\le 0$ 定义的中心切割后矩阵 $P$ 的更新公式。新的椭球 $E(P^+, c^+)$ 的矩阵 $P^+$ 由下式给出：\n$$\nP^+ = \\frac{n^2}{n^2-1} \\left( P - \\frac{2}{n+1} \\frac{(Pg)(Pg)^\\top}{g^\\top P g} \\right)\n$$\n其中 $n \\ge 2$ 是维度。\n\n我们来分析每次迭代的体积变化。椭球 $E(P,c)$ 的体积与 $\\sqrt{\\det(P)}$ 成正比。新体积与旧体积的比率为：\n$$\n\\frac{\\mathrm{vol}(E^+)}{\\mathrm{vol}(E)} = \\sqrt{\\frac{\\det(P^+)}{\\det(P)}}\n$$\n使用矩阵行列式引理 $\\det(A - uv^\\top) = (1 - v^\\top A^{-1}u)\\det(A)$，我们可以求出 $\\det(P^+)$。\n令 $A=P$， $u = \\frac{\\sqrt{2}}{\\sqrt{n+1}} \\frac{Pg}{\\sqrt{g^\\top P g}}$ 且 $v=u$。\n$$\n\\det\\left(P - \\frac{2}{n+1} \\frac{(Pg)(Pg)^\\top}{g^\\top P g}\\right) = \\det(P) \\left(1 - \\frac{2}{n+1} \\frac{g^\\top P P^{-1} Pg}{g^\\top P g}\\right) = \\det(P) \\left(1 - \\frac{2}{n+1}\\right) = \\det(P) \\frac{n-1}{n+1}\n$$\n因此，\n$$\n\\det(P^+) = \\left(\\frac{n^2}{n^2-1}\\right)^n \\det\\left(P - \\frac{2}{n+1} \\frac{(Pg)(Pg)^\\top}{g^\\top P g}\\right) = \\left(\\frac{n^2}{n^2-1}\\right)^n \\left(\\frac{n-1}{n+1}\\right) \\det(P)\n$$\n体积比为：\n$$\n\\frac{\\mathrm{vol}(E^+)}{\\mathrm{vol}(E)} = \\sqrt{\\left(\\frac{n^2}{n^2-1}\\right)^n \\left(\\frac{n-1}{n+1}\\right)} = \\frac{n}{n+1} \\left(\\frac{n^2}{n^2-1}\\right)^{(n-1)/2}\n$$\n这个表达式是一个常数，仅取决于维度 $n$，而不取决于切割方向 $g$。这是中心切割椭球法的一个基本性质。\n\n现在，我们分析 $g$ 的两种特定选择对 $P$ 的特征值的影响，这些特征值决定了半轴长度和条件数 $\\kappa(P) = \\lambda_1/\\lambda_n$。不失一般性，我们在特征向量基中进行分析，因此 $P = \\Lambda = \\mathrm{diag}(\\lambda_1, \\ldots, \\lambda_n)$，特征向量 $v_i$ 是标准基向量 $e_i$。\n\n**情况1：将 $g$ 与 $v_{\\min} = v_n$ 对齐**\n我们设 $g = v_n = e_n$。\n$g^\\top P g = e_n^\\top \\Lambda e_n = \\lambda_n$。\n$Pg = \\Lambda e_n = \\lambda_n e_n$。\n$P$ 的更新公式变为：\n$$\nP^+ = \\frac{n^2}{n^2-1} \\left( \\Lambda - \\frac{2}{n+1} \\frac{(\\lambda_n e_n)(\\lambda_n e_n)^\\top}{\\lambda_n} \\right) = \\frac{n^2}{n^2-1} \\left( \\Lambda - \\frac{2\\lambda_n}{n+1} e_n e_n^\\top \\right)\n$$\n因为 $\\Lambda$ 和 $e_n e_n^\\top$ 都是对角矩阵，所以 $P^+$ 也是对角矩阵。其对角元是新的特征值 $\\lambda_i^+$。\n对于 $i \\in \\{1, \\ldots, n-1\\}$，相应的对角元不受秩一项的影响：\n$\\lambda_i^+ = \\frac{n^2}{n^2-1} \\lambda_i$。\n对于 $i=n$：\n$\\lambda_n^+ = \\frac{n^2}{n^2-1} \\left( \\lambda_n - \\frac{2\\lambda_n}{n+1} \\right) = \\frac{n^2}{n^2-1} \\lambda_n \\left( \\frac{n-1}{n+1} \\right) = \\frac{n^2}{(n+1)^2} \\lambda_n$。\n\n我们来分析其影响：\n- **最长半轴**：原始长度为 $\\sqrt{\\lambda_1}$。新长度为 $\\sqrt{\\lambda_1^+} = \\sqrt{\\frac{n^2}{n^2-1} \\lambda_1}$。因为 $n \\ge 2$，所以 $\\frac{n^2}{n^2-1} > 1$。因此，最长半轴的长度*增加*了。\n- **条件数**：新的条件数是 $\\kappa(P^+) = \\lambda_{\\max}^+ / \\lambda_{\\min}^+$。新的最大特征值是 $\\lambda_1^+ = \\frac{n^2}{n^2-1} \\lambda_1$。新的最小特征值是 $\\lambda_n^+ = \\frac{n^2}{(n+1)^2} \\lambda_n$。\n$$\n\\kappa(P^+) = \\frac{\\lambda_1^+}{\\lambda_n^+} = \\frac{\\frac{n^2}{n^2-1} \\lambda_1}{\\frac{n^2}{(n+1)^2} \\lambda_n} = \\frac{(n+1)^2}{n^2-1} \\frac{\\lambda_1}{\\lambda_n} = \\frac{(n+1)^2}{(n-1)(n+1)} \\kappa(P) = \\frac{n+1}{n-1} \\kappa(P)\n$$\n因为 $\\frac{n+1}{n-1} > 1$，条件数*恶化*（增加）了。\n\n**情况2：将 $g$ 与 $v_{\\max} = v_1$ 对齐**\n我们设 $g = v_1 = e_1$。\n$g^\\top P g = e_1^\\top \\Lambda e_1 = \\lambda_1$。\n$Pg = \\Lambda e_1 = \\lambda_1 e_1$。\n更新变为：\n$$\nP^+ = \\frac{n^2}{n^2-1} \\left( \\Lambda - \\frac{2}{n+1} \\frac{(\\lambda_1 e_1)(\\lambda_1 e_1)^\\top}{\\lambda_1} \\right) = \\frac{n^2}{n^2-1} \\left( \\Lambda - \\frac{2\\lambda_1}{n+1} e_1 e_1^\\top \\right)\n$$\n这个 $P^+$ 也是对角矩阵。新的特征值是：\n对于 $i=1$：\n$\\lambda_1^+ = \\frac{n^2}{n^2-1} \\left( \\lambda_1 - \\frac{2\\lambda_1}{n+1} \\right) = \\frac{n^2}{(n+1)^2} \\lambda_1$。\n对于 $i \\in \\{2, \\ldots, n\\}$：\n$\\lambda_i^+ = \\frac{n^2}{n^2-1} \\lambda_i$。\n\n我们来分析其影响：\n- **最长半轴**：切割方向的半轴（原本是最长的）显著收缩：$\\sqrt{\\lambda_1} \\to \\sqrt{\\lambda_1^+} = \\frac{n}{n+1}\\sqrt{\\lambda_1}$。所有其他半轴都被拉伸一个因子 $\\sqrt{\\frac{n^2}{n^2-1}}$。新的最长半轴的长度为 $\\sqrt{\\lambda_{\\max}(P^+)} = \\sqrt{\\max(\\lambda_1^+, \\lambda_2^+)} = \\sqrt{\\max\\left(\\frac{n^2}{(n+1)^2}\\lambda_1, \\frac{n^2}{n^2-1}\\lambda_2\\right)}$。与情况1中最大半轴总是增加相比，这种选择提供了一种减小最长半轴的机制，因此在比较意义上提供了“最大程度的减小”。第一个半轴本身的长度减小了。\n- **条件数**：在病态（偏心）椭球的典型情况下，即 $\\lambda_1 \\gg \\lambda_2 \\ge \\cdots \\ge \\lambda_n$，最大特征值仍然是 $\\lambda_1^+$，最小特征值仍然是 $\\lambda_n^+$。\n$$\n\\kappa(P^+) = \\frac{\\lambda_1^+}{\\lambda_n^+} = \\frac{\\frac{n^2}{(n+1)^2} \\lambda_1}{\\frac{n^2}{n^2-1} \\lambda_n} = \\frac{n^2-1}{(n+1)^2} \\frac{\\lambda_1}{\\lambda_n} = \\frac{(n-1)(n+1)}{(n+1)^2} \\kappa(P) = \\frac{n-1}{n+1} \\kappa(P)\n$$\n因为 $\\frac{n-1}{n+1}  1$，条件数*改善*（减小）了。\n\n**实际收敛性**：使椭球更接近球形（改善条件数）通常会带来更好的实际收敛性，因为它减少了各向异性。恶化条件数会使椭球更“雪茄形”，这会减慢收敛速度，因为搜索区域变得高度扭曲。因此，将切割与 $v_{\\max}$ 对齐是获得更优实际性能的策略。\n\n现在，我们评估每个选项。\n\nA. 将 $g$ 与 $v_{\\min}$ 对齐会使最长半轴得到最大程度的减小，并使条件数得到最快的改善；与 $v_{\\max}$ 对齐则效果相反。\n这在事实上是错误的。与 $v_{\\min}$ 对齐会*增加*最长半轴并*恶化*条件数。\n结论：**错误**。\n\nB. 对于中心切割，每次迭代的体积减小因子与 $g$ 的方向无关。将 $g$ 与 $v_{\\max}$ 对齐会使最长半轴得到最大程度的减小，并将条件数改善一个因子 $(n-1)/(n+1)$；而将 $g$ 与 $v_{\\min}$ 对齐会增加最长半轴，并将条件数恶化一个因子 $(n+1)/(n-1)$，这通常会减慢实际收敛速度。\n这个陈述准确地总结了我们的发现。\n- 体积减小确实与 $g$ 无关。\n- 与 $v_{\\max}$ 对齐提供了两种策略中最好（也是唯一）的减小最长轴的方法，因此被描述为产生“最大程度的减小”。\n- 在典型情况下，它将条件数改善了指定的因子。\n- 与 $v_{\\min}$ 对齐确实增加了最长半轴，并按指定因子恶化了条件数。\n- 关于实际收敛性的结论是合理的。\n结论：**正确**。\n\nC. 将 $g$ 与 $v_{\\min}$ 或 $v_{\\max}$ 对齐，对 $P$ 的特征值的更新在重新标记的意义下是相同的，因此两种情况下条件数和最长半轴的变化都相同；只有中心 $c$ 的更新不同。\n这是错误的。情况1中的新特征值集合是 $\\{\\frac{n^2}{n^2-1}\\lambda_1, \\ldots, \\frac{n^2}{n^2-1}\\lambda_{n-1}, \\frac{n^2}{(n+1)^2}\\lambda_n\\}$。情况2中的新特征值集合是 $\\{\\frac{n^2}{(n+1)^2}\\lambda_1, \\frac{n^2}{n^2-1}\\lambda_2, \\ldots, \\frac{n^2}{n^2-1}\\lambda_n\\}$。这两组数是不同的（除非椭球是一个球体，即 $\\lambda_1=\\lambda_n$）。因此，条件数和最长半轴的变化是不同的。\n结论：**错误**。\n\nD. 对所有 $n$，将 $g$ 与 $v_{\\min}$ 对齐既能产生最大的体积减小，又能使最长半轴得到最大程度的减小，使其成为普遍最优的收敛选择。\n这在多个方面都是错误的。体积减小与 $g$ 无关。与 $v_{\\min}$ 对齐会*增加*而不是减小最长半轴。这对收敛来说是一个糟糕的选择。\n结论：**错误**。", "answer": "$$\\boxed{B}$$", "id": "3125298"}]}