{"hands_on_practices": [{"introduction": "互补问题的强大之处在于其能够为非光滑关系建模。本练习 ([@problem_id:3109507]) 将演示如何将一个含有绝对值项（一个典型的非光滑函数）的方程转化为标准的线性互补问题（LCP）格式。这项实践对于培养建模技巧和理解 LCP 框架的通用性至关重要。", "problem": "考虑在 $\\mathbb{R}^n$ 中形式为 $A x + |B x| = c$ 的绝对值方程 (AVE)，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是非奇异矩阵，$B \\in \\mathbb{R}^{n \\times n}$，且 $c \\in \\mathbb{R}^n$。线性互补问题 (LCP) 定义如下：给定 $M \\in \\mathbb{R}^{m \\times m}$ 和 $q \\in \\mathbb{R}^m$，找到 $w, z \\in \\mathbb{R}^m$ 使得 $w = M z + q$，$w \\ge 0$，$z \\ge 0$，且 $w^\\top z = 0$，其中不等式是按分量解释的。从这些定义出发，在不使用任何预先推导的变换公式的情况下，完成以下任务。\n\n1) 仅使用基本操作和定义，引入用于编码 $|B x|$ 的辅助非负变量，并证明 AVE 可以被重构为一个关于单一非负变量的 LCP。用 $A$、$B$ 和 $c$ 显式地表达 LCP 数据 $(M, q)$，并清楚地说明你为证明该重构而对 $A$ 和 $B$ 使用的所有条件。\n\n2) 将你的重构应用于以下具体实例：\n$$\nA = \\begin{pmatrix} 3  1 \\\\ 0  2 \\end{pmatrix},\\quad\nB = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix},\\quad\nc = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}.\n$$\n计算相应的 $(M, q)$，精确求解得到的 LCP，恢复 AVE 的唯一解 $x$，最后以精确形式报告标量 $s = x_1 + 2 x_2$。\n\n3) 根据你所构造的矩阵 $M$ 及相关矩阵的性质，简要解释该 AVE 何时有唯一解，以及如何使用 LCP 算法来计算它。至少说出一种算法的名称，并解释从 AVE 到 LCP 的重构如何使其得以应用。\n\n你最终报告的量必须是第 2 部分中的标量 $s = x_1 + 2 x_2$，且必须为精确形式（无四舍五入）。", "solution": "所述问题在形式上是合理的、自洽的，并且基于优化理论和线性代数的既定原则。它提出了一个适定的数学任务。我们将着手解决。\n\n该问题分为三个部分。我们将按顺序处理它们。\n\n第 1 部分：将绝对值方程 (AVE) 重构为线性互补问题 (LCP)。\n\n我们给定的绝对值方程 (AVE) 是：\n$$A x + |B x| = c$$\n其中 $A, B \\in \\mathbb{R}^{n \\times n}$，$c \\in \\mathbb{R}^n$，$x \\in \\mathbb{R}^n$。假设 $A$ 是非奇异的。向量的绝对值是按分量计算的。\n\n我们还给出了线性互补问题 (LCP) 的定义：对于给定的 $M \\in \\mathbb{R}^{m \\times m}$ 和 $q \\in \\mathbb{R}^m$，找到 $w, z \\in \\mathbb{R}^m$ 使得\n$$w = M z + q, \\quad w \\ge 0, \\quad z \\ge 0, \\quad w^\\top z = 0$$\n\n为了将 AVE 重构为 LCP，我们必须处理非线性项 $|Bx|$。令 $y = Bx$。我们需要使用适合 LCP 的变量来表达 $|y|$。对于任何标量 $y_i$，其绝对值 $|y_i|$ 可以通过一个互补关系来定义。考虑恒等式 $|y_i| = y_i + 2\\max(0, -y_i)$。令 $z_i = \\max(0, -y_i)$。根据定义，$z_i \\ge 0$。\n如果 $y_i \\ge 0$，那么 $z_i = 0$，恒等式给出 $|y_i| = y_i$。\n如果 $y_i  0$，那么 $z_i = -y_i  0$，恒等式给出 $|y_i| = y_i + 2(-y_i) = -y_i$。\n这是正确的。\n条件 $z_i = \\max(0, -y_i)$ 可以用互补性来表示。令 $w_i = y_i + z_i$。\n如果 $y_i \\ge 0$，那么 $z_i=0$，所以 $w_i = y_i \\ge 0$ 且 $w_i z_i = y_i \\cdot 0 = 0$。\n如果 $y_i  0$，那么 $z_i=-y_i$，所以 $w_i = y_i + (-y_i) = 0$ 且 $w_i z_i = 0 \\cdot (-y_i) = 0$。\n在这两种情况下，我们都有 $z_i \\ge 0$，$w_i \\ge 0$，且 $w_i z_i = 0$。\n所以，对于一个向量 $y$，我们可以写成 $|y| = y + 2z$，并满足条件 $z \\ge 0$，$w = y+z \\ge 0$ 和 $w^\\top z = 0$。\n\n让我们将此应用于 AVE。令 $y = Bx$。AVE 变为：\n$$A x + (Bx + 2z) = c$$\n其中 $z \\in \\mathbb{R}^n$ 是一个辅助变量向量，满足 LCP 条件，且 $w = Bx+z$。\n合并包含 $x$ 的项，我们得到：\n$$(A+B)x + 2z = c$$\n为了解出 $x$，我们必须假设矩阵 $(A+B)$ 是非奇异的。这是此重构的一个关键条件。在此假设下，我们有：\n$$x = (A+B)^{-1}(c - 2z)$$\n现在，我们必须用 $z$ 来表示松弛变量 $w$，以获得 LCP 的形式。\n$$w = Bx + z$$\n代入 $x$ 的表达式：\n$$w = B\\left((A+B)^{-1}(c - 2z)\\right) + z$$\n$$w = B(A+B)^{-1}c - 2B(A+B)^{-1}z + I z$$\n$$w = \\left(I - 2B(A+B)^{-1}\\right)z + B(A+B)^{-1}c$$\n这正是 LCP 的形式 $w = Mz+q$，其中变量向量是 $z \\in \\mathbb{R}^n$，LCP 数据 $(M, q)$ 由下式给出：\n$$M = I - 2B(A+B)^{-1} \\in \\mathbb{R}^{n \\times n}$$\n$$q = B(A+B)^{-1}c \\in \\mathbb{R}^{n}$$\nLCP 是要找到满足 $w = Mz+q$、$z \\ge 0$、$w \\ge 0$ 和 $w^\\top z = 0$ 的 $z \\in \\mathbb{R}^n$。一旦找到这样的 $z$，原始 AVE 的解 $x$ 可以通过 $x = (A+B)^{-1}(c - 2z)$ 来恢复。\n用于证明此重构合理性的关键条件是矩阵 $(A+B)$ 必须是非奇异的。\n\n第 2 部分：应用于一个具体实例。\n\n我们给定的数据是：\n$$A = \\begin{pmatrix} 3  1 \\\\ 0  2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$$\n首先，我们检查重构的条件。我们计算 $A+B$：\n$$A+B = \\begin{pmatrix} 3  1 \\\\ 0  2 \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$$\n行列式为 $\\det(A+B) = 4 \\cdot 3 - 1 \\cdot 1 = 11$，非零。因此，$(A+B)$ 是非奇异的，该重构有效。\n接下来，我们计算 $(A+B)$ 的逆矩阵：\n$$(A+B)^{-1} = \\frac{1}{11}\\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix}$$\n现在我们计算 LCP 矩阵 $M$ 和向量 $q$：\n$$q = B(A+B)^{-1}c = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} \\frac{1}{11}\\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$$\n$$q = \\frac{1}{11} \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 3(2) - 1(3) \\\\ -1(2) + 4(3) \\end{pmatrix} = \\frac{1}{11} \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 10 \\end{pmatrix} = \\frac{1}{11}\\begin{pmatrix} 3 \\\\ 13 \\end{pmatrix}$$\n\n$$M = I - 2B(A+B)^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - 2 \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} \\frac{1}{11}\\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix}$$\n$$M = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\frac{2}{11} \\begin{pmatrix} 1(3)+0(-1)  1(-1)+0(4) \\\\ 1(3)+1(-1)  1(-1)+1(4) \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\frac{2}{11} \\begin{pmatrix} 3  -1 \\\\ 2  3 \\end{pmatrix}$$\n$$M = \\begin{pmatrix} 1 - 6/11  2/11 \\\\ -4/11  1 - 6/11 \\end{pmatrix} = \\frac{1}{11}\\begin{pmatrix} 5  2 \\\\ -4  5 \\end{pmatrix}$$\nLCP 是要找到 $z=\\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix} \\ge 0$ 使得 $w = Mz+q \\ge 0$ 且 $w^\\top z = 0$。我们通过考虑四种可能的基本变量集来求解：\n1.  $z_1=0, z_2=0$：这意味着 $w = q = \\frac{1}{11}\\begin{pmatrix} 3 \\\\ 13 \\end{pmatrix}$。因为 $w_1 = 3/11 \\ge 0$ 且 $w_2 = 13/11 \\ge 0$，所以这是一个 LCP 的有效解。因此，$z = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 是一个解。\n2.  $w_1=0, z_2=0$：$w=Mz+q$ 的第一个方程变为 $0 = \\frac{1}{11}(5z_1 + 3)$，得到 $z_1 = -3/5$。这违反了 $z_1 \\ge 0$。在这种情况下无解。\n3.  $z_1=0, w_2=0$：第二个方程变为 $0 = \\frac{1}{11}(5z_2 + 13)$，得到 $z_2 = -13/5$。这违反了 $z_2 \\ge 0$。在这种情况下无解。\n4.  $w_1=0, w_2=0$：这需要求解 $Mz = -q$。$\\frac{1}{11}\\begin{pmatrix} 5  2 \\\\ -4  5 \\end{pmatrix}z = -\\frac{1}{11}\\begin{pmatrix} 3 \\\\ 13 \\end{pmatrix}$。该方程组为 $\\begin{cases} 5z_1 + 2z_2 = -3 \\\\ -4z_1 + 5z_2 = -13 \\end{cases}$。求解该方程组得到 $z_1 = 1/3$ 和 $z_2 = -7/3$。这违反了 $z_2 \\ge 0$。在这种情况下无解。\n\nLCP 的唯一解是 $z = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n现在我们恢复 AVE 的唯一解 $x$：\n$$x = (A+B)^{-1}(c - 2z) = (A+B)^{-1}c$$\n我们已经在求 $q$ 的过程中计算过这个向量：\n$$x = \\frac{1}{11}\\begin{pmatrix} 3 \\\\ 10 \\end{pmatrix}$$\n所以，$x_1 = 3/11$ 和 $x_2 = 10/11$。\n最后，我们计算标量 $s$：\n$$s = x_1 + 2x_2 = \\frac{3}{11} + 2\\left(\\frac{10}{11}\\right) = \\frac{3+20}{11} = \\frac{23}{11}$$\n\n第 3 部分：解的唯一性和算法方面的考虑。\n\n该重构在 AVE 的解与 LCP $(M, q)$ 的解之间建立了一一对应关系，前提是 $(A+B)$ 是非奇异的。因此，AVE 有唯一解当且仅当 LCP 有唯一解。\n\n对于任意向量 $q$，LCP $(M, q)$ 有唯一解的一个充分条件是矩阵 $M$ 是一个 P-矩阵。如果一个矩阵的所有主子式都为正，则该矩阵为 P-矩阵。对于第 2 部分中的具体情况，矩阵 $M = \\frac{1}{11}\\begin{pmatrix} 5  2 \\\\ -4  5 \\end{pmatrix}$ 的主子式为：\n- 一阶：$M_{11} = 5/11  0$ 和 $M_{22} = 5/11  0$。\n- 二阶：$\\det(M) = (\\frac{1}{11})^2(5 \\cdot 5 - 2(-4)) = \\frac{33}{121} = \\frac{3}{11}  0$。\n由于所有主子式都为正，所以 $M$ 是一个 P-矩阵，这保证了 LCP 的唯一解，从而也保证了这个具体实例的 AVE 的唯一解。一般来说，如果由 AVE 数据构造的矩阵 $M=I-2B(A+B)^{-1}$ 是一个 P-矩阵，则该 AVE 有唯一解。\n\n从 AVE到 LCP 的重构对于计算目的至关重要。原始问题 $Ax+|Bx|=c$ 涉及一个非线性和不可微函数（绝对值），这使得用标准的线性或光滑系统数值方法难以求解。而 LCP 虽然仍是一个专门的问题，但它拥有丰富的、被广泛研究的数学结构。这种结构允许开发专门的、有限步算法。\n\n求解 LCP 的最著名算法之一是 Lemke 算法，也称为互补主元算法。该算法在线性系统 $w=Mz+q$ 上操作，并系统地通过一系列基进行主元变换（类似于线性规划的单纯形法），以寻求满足互补条件 $w^\\top z=0$。该重构为 Lemke 算法提供了必要的输入 $(M,q)$。当矩阵 $M$ 是一个 P-矩阵时，Lemke 算法保证能在有限步内找到 LCP 的唯一解。因此，该重构使得应用强大的、经过验证的算法来求解一类非线性方程成为可能。", "answer": "$$\\boxed{\\frac{23}{11}}$$", "id": "3109507"}, {"introduction": "当一个问题被构建为 LCP 后，一个关键问题是解是否存在以及是否唯一。本练习 ([@problem_id:3109456]) 提出了一个关于斜对称矩阵的谜题，这种情况无法用 P 矩阵等简单判据来覆盖。通过从第一性原理出发分析这个问题，你将对控制 LCP 解的条件获得更深刻的几何直觉，而不仅仅是死记硬背定理。", "problem": "考虑二维空间中的线性互补问题 $\\mathrm{LCP}(M,q)$，其定义如下：给定 $M\\in\\mathbb{R}^{2\\times 2}$ 和 $q\\in\\mathbb{R}^{2}$，寻找向量 $z\\in\\mathbb{R}^{2}$ 和 $w\\in\\mathbb{R}^{2}$ 使得\n$w = q + M z$，$z \\ge 0$，$w \\ge 0$，以及 $z^\\top w = 0$，其中不等式是逐分量理解的。设\n$$\nM=\\begin{bmatrix}01\\\\-10\\end{bmatrix}.\n$$\n仅使用线性互补问题的定义和线性映射单调性的基本概念（映射 $F(z)=Mz$ 是单调的当且仅当其对称部分 $\\tfrac{1}{2}(M+M^\\top)$ 是半正定的），从第一性原理出发，对非负象限中的可行几何进行推理，并确定哪个陈述正确地描述了对于一般的 $q\\in\\mathbb{R}^2$（即，远离测度为零的退化情况）解的存在性和唯一性。\n\n只选择一个选项。\n\nA) 对于每一个 $q\\in\\mathbb{R}^2$，$\\mathrm{LCP}(M,q)$ 都是可解的并且有唯一解。\n\nB) 对于一般的 $q$（即，排除线 $q_1=0$ 或 $q_2=0$ 的情况），当 $q_2  0$ 时 $\\mathrm{LCP}(M,q)$ 无解，当 $q_20$ 时有唯一解。在坐标轴上（$q_1=0$ 或 $q_2=0$），解集可能为空集或无穷集，这取决于 $q$。\n\nC) 因为 $\\det(M)0$，$\\mathrm{LCP}(M,q)$ 是一个 $P$-矩阵线性互补问题，因此对于所有 $q\\in\\mathbb{R}^2$ 都有唯一解。\n\nD) 由于 $M$ 是斜对称的，$z^\\top M z0$ 对于所有非零 $z$ 成立，这意味着对于所有 $q\\in\\mathbb{R}^2$ 都存在唯一解。\n\nE) 对于一般的 $q$，解的存在性仅取决于 $q_1$ 的符号，当且仅当 $q_10$ 时有解。", "solution": "### 步骤1：问题验证\n\n**1.1. 提取给定条件**\n\n*   问题类型：线性互补问题，$\\mathrm{LCP}(M,q)$。\n*   维数：$2$。\n*   条件：寻找 $z \\in \\mathbb{R}^{2}$ 和 $w \\in \\mathbb{R}^{2}$ 使得：\n    1.  $w = q + M z$\n    2.  $z \\ge 0$ (逐分量)\n    3.  $w \\ge 0$ (逐分量)\n    4.  $z^\\top w = 0$\n*   矩阵 $M$：$$M=\\begin{bmatrix}01\\\\-10\\end{bmatrix}$$\n*   向量 $q$：$q \\in \\mathbb{R}^{2}$。\n*   问题：确定对于一个一般的 $q \\in \\mathbb{R}^2$ 解的存在性和唯一性。\n*   题目中提供的附加信息：\n    *   “其中不等式是逐分量理解的” - 这是标准的。\n    *   “仅使用线性互补问题的定义和线性映射单调性的基本概念（映射 $F(z)=Mz$ 是单调的当且仅当其对称部分 $\\tfrac{1}{2}(M+M^\\top)$ 是半正定的）” - 这是对预期方法的提示。\n    *   “从第一性原理出发，对非负象限中的可行几何进行推理” - 方法的另一个提示。\n    *   “确定哪个陈述正确地描述了对于一般的 $q\\in\\mathbb{R}^2$（即，远离测度为零的退化情况）解的存在性和唯一性” - 阐明了“一般的”的含义。\n\n**1.2. 使用提取的给定条件进行验证**\n\n1.  **科学或事实的健全性：** 该问题是线性互补问题的一个标准实例，这是数学优化中的一个成熟课题。定义是标准的。矩阵 $M$ 是一个有效的实矩阵。这些条件是典型的LCP条件。没有违反。\n2.  **不可形式化或不相关：** 该问题是一个形式化的数学问题，直接关系到优化中的互补问题。没有违反。\n3.  **不完整或矛盾的设置：** 问题被完全指定。$M$ 已给出，$q$ 是一个参数。LCP条件是清晰的。问题是关于解集作为 $q$ 的函数的性质。没有违反。\n4.  **不切实际或不可行：** 问题纯粹是数学问题。没有物理约束需要检查。没有违反。\n5.  **不适定或结构不良：** 问题是适定的，因为它提出了一个关于已定义数学系统解集的精确问题。术语“一般的”也得到了澄清。没有违反。\n6.  **伪深刻、平凡或同义反复：** 问题需要对互补条件进行逐案分析。它不是平凡的。矩阵 $M$ 是一个经典的例子（斜对称），它导致了有趣的行为，这不被像P-矩阵这样最简单的LCP类别所涵盖。没有违反。\n7.  **超出科学可验证性：** 问题是一个可以被证明或证伪的数学陈述。没有违反。\n\n**结论：** 问题陈述有效。\n\n### 步骤2：求解推导\n\n问题是寻找 $z = [z_1, z_2]^\\top$ 和 $w = [w_1, w_2]^\\top$ 使得：\n1.  $w = q + M z$\n2.  $z \\ge 0$ (即 $z_1 \\ge 0, z_2 \\ge 0$)\n3.  $w \\ge 0$ (即 $w_1 \\ge 0, w_2 \\ge 0$)\n4.  $z^\\top w = 0$\n\n代入给定的矩阵 $M=\\begin{bmatrix}01\\\\-10\\end{bmatrix}$ 和向量 $z=\\begin{bmatrix}z_1\\\\z_2\\end{bmatrix}$，$q=\\begin{bmatrix}q_1\\\\q_2\\end{bmatrix}$，第一个条件变为：\n$$\n\\begin{bmatrix}w_1\\\\w_2\\end{bmatrix} = \\begin{bmatrix}q_1\\\\q_2\\end{bmatrix} + \\begin{bmatrix}01\\\\-10\\end{bmatrix}\\begin{bmatrix}z_1\\\\z_2\\end{bmatrix} = \\begin{bmatrix}q_1+z_2\\\\q_2-z_1\\end{bmatrix}\n$$\n非负性条件是 $z_1 \\ge 0$，$z_2 \\ge 0$，$w_1 = q_1+z_2 \\ge 0$，以及 $w_2 = q_2-z_1 \\ge 0$。\n互补条件 $z^\\top w = z_1w_1+z_2w_2 = 0$，与非负性结合，等价于条件系统 $z_1w_1=0$ 和 $z_2w_2=0$。\n\n我们从第一性原理出发，通过考虑由互补条件产生的四个互斥且穷尽的案例来进行推理：\n1.  $z_1=0, z_2=0$\n2.  $z_10, z_2=0$\n3.  $z_1=0, z_20$\n4.  $z_10, z_20$\n\n**案例1：$z_1 = 0, z_2 = 0$**\n如果 $z=0$，那么 $w = q+M(0) = q$。要使其成为一个解，所有条件都必须满足。$z \\ge 0$ 被满足。我们只需要 $w \\ge 0$，即 $q \\ge 0$。所以，如果 $q_1 \\ge 0$ 且 $q_2 \\ge 0$，那么 $z=0$ 是一个解。\n\n**案例2：$z_1  0, z_2 = 0$**\n条件 $z_10$ 根据互补性 ($z_1w_1=0$) 意味着 $w_1=0$。\n$w_1 = q_1+z_2 = q_1+0=q_1$。因此，我们必须有 $q_1=0$。\n剩下的条件是 $z_1  0$ 和 $w_2 = q_2 - z_1 \\ge 0$，这意味着 $z_1 \\le q_2$。\n要存在这种形式的解，我们必须有 $q_1=0$ 并且必须存在一个 $z_1$ 使得 $0  z_1 \\le q_2$。这要求 $q_20$。\n这个案例只在退化线 $q_1=0$ 上可能（具体来说，对于 $q_1=0, q_20$）。对于一般的 $q$（其中 $q_1 \\neq 0$），这个案例不产生解。\n\n**案例3：$z_1 = 0, z_2  0$**\n条件 $z_20$ 根据互补性 ($z_2w_2=0$) 意味着 $w_2=0$。\n$w_2 = q_2 - z_1 = q_2-0=q_2$。因此，我们必须有 $q_2=0$。\n剩下的条件是 $z_2  0$ 和 $w_1 = q_1 + z_2 \\ge 0$，这意味着 $z_2 \\ge -q_1$。\n要存在这种形式的解，我们必须有 $q_2=0$ 并且必须存在一个 $z_2$ 使得 $z_2  0$ 且 $z_2 \\ge -q_1$。这对任何 $q_1$ 的值都是可能的。\n这个案例只在退化线 $q_2=0$ 上可能。对于一般的 $q$（其中 $q_2 \\neq 0$），这个案例不产生解。\n\n**案例4：$z_1  0, z_2  0$**\n这些条件意味着 $w_1=0$ 和 $w_2=0$。\n$w_1 = q_1+z_2=0 \\implies z_2=-q_1$。\n$w_2 = q_2-z_1=0 \\implies z_1=q_2$。\n要使其成为一个有效的解，我们必须满足假设 $z_1  0$ 和 $z_2  0$。\n$z_1 = q_2  0$。\n$z_2 = -q_1  0 \\implies q_1  0$。\n所以，当且仅当 $q_1  0$ 和 $q_2  0$ 时，存在这种形式的解。如果这些关于 $q$ 的条件成立，解是唯一的：$z = [q_2, -q_1]^\\top$。\n\n**对于一般的 $q$ 的总结**\n对于一般的 $q$，我们有 $q_1 \\neq 0$ 和 $q_2 \\neq 0$。这意味着我们只需要考虑案例1和4。\n*   **如果 $q_1  0$ 且 $q_2  0$ (第一象限):** 案例1适用，给出解 $z=0$。案例4要求 $q_1  0$，所以不适用。因此，存在唯一解 $z=0$。\n*   **如果 $q_1  0$ 且 $q_2  0$ (第二象限):** 案例1要求 $q_1 \\ge 0$，所以不适用。案例4适用，给出唯一解 $z=[q_2, -q_1]^\\top$。\n*   **如果 $q_1  0$ 且 $q_2  0$ (第三象限):** 案例1要求 $q_2 \\ge 0$，所以不适用。案例4要求 $q_2  0$，所以不适用。无解。\n*   **如果 $q_1  0$ 且 $q_2  0$ (第四象限):** 案例1要求 $q_2 \\ge 0$，所以不适用。案例4要求 $q_1  0$，所以不适用。无解。\n\n综合这些对于一般 $q$ 的发现：\n- 如果 $q_2  0$，总存在恰好一个解。\n- 如果 $q_2  0$，无解。\n\n**对于退化的 $q$ (在坐标轴上) 的总结**\n*   **$q_1=0, q_20$:** 案例1给出一个解 ($z=0$)。案例2也适用，给出解 $z=[z_1, 0]^\\top$ 对于任何 $z_1 \\in (0, q_2]$。与 $z=0$ 结合，解集是 $\\{[z_1,0]^\\top \\mid 0 \\le z_1 \\le q_2\\}$，这是一个无穷集。\n*   **$q_1 \\ne 0, q_2=0$:** 案例3适用。解为 $z=[0, z_2]^\\top$ 对于 $z_2  \\max(0,-q_1)$。这是一个无穷解集。\n*   **$q_1=0, q_2  0$:** 我们检查这四个案例。没有一个能产生解。例如，从基本不等式 $z_1 \\ge 0$ 和 $w_2=q_2-z_1 \\ge 0 \\implies z_1 \\le q_2$。由于 $q_20$，这意味着 $z_1 \\le q_2  0$，这与 $z_1 \\ge 0$ 矛盾。所以没有可行解，因此LCP无解。解集为空。\n*   **$q=(0,0)$:** 轴上情况的组合。无穷解。\n\n这证实了在坐标轴上，解集可能为空集或无穷集。\n\n**结论**\n对于一般的 $q$ (远离坐标轴)，当且仅当 $q_2  0$ 时存在解，且当解存在时是唯一的。在坐标轴上，解集可能为空集或无穷集。这与选项B中的陈述相符。\n\n### 选项评估\n\n**A) 对于每一个 $q\\in\\mathbb{R}^2$，$\\mathrm{LCP}(M,q)$ 都是可解的并且有唯一解。**\n**不正确。** 我们的分析表明，对于任何 $q_2  0$ 的 $q$，都没有解。例如，$q=[1, -1]^\\top$。\n\n**B) 对于一般的 $q$（即，排除线 $q_1=0$ 或 $q_2=0$ 的情况），当 $q_2  0$ 时 $\\mathrm{LCP}(M,q)$ 无解，当 $q_20$ 时有唯一解。在坐标轴上（$q_1=0$ 或 $q_2=0$），解集可能为空集或无穷集，这取决于 $q$。**\n**正确。** 这个陈述与我们详细的案例分析完全相符。对于一般的 $q$，解的存在性仅取决于 $q_2$ 的符号，当解存在时，唯一性成立。在坐标轴上，我们展示了无解的情况（例如，$q=[0, -1]^\\top$）和有无穷解的情况（例如，$q=[0, 1]^\\top$）。\n\n**C) 因为 $\\det(M)0$，$\\mathrm{LCP}(M,q)$ 是一个 $P$-矩阵线性互补问题，因此对于所有 $q\\in\\mathbb{R}^2$ 都有唯一解。**\n**不正确。** 如果一个矩阵的所有主子式都是正的，那么它就是$P$-矩阵。矩阵是 $M=\\begin{bmatrix}01\\\\-10\\end{bmatrix}$。$1 \\times 1$ 的主子式是对角元素 $M_{11}=0$ 和 $M_{22}=0$。由于这些不是正的，所以$M$不是$P$-矩阵。论证的前提是错误的。\n\n**D) 由于 $M$ 是斜对称的，$z^\\top M z0$ 对于所有非零 $z$ 成立，这意味着对于所有 $q\\in\\mathbb{R}^2$ 都存在唯一解。**\n**不正确。** 矩阵 $M$ 确实是斜对称的，因为 $M^\\top = \\begin{bmatrix}0-1\\\\10\\end{bmatrix} = -M$。然而，对于任何斜对称矩阵和任何向量 $z$，二次型 $z^\\top M z$ 恒为零。这可以通过 $z^\\top M z = (z^\\top M z)^\\top = z^\\top M^\\top z = z^\\top (-M) z = -z^\\top M z$ 看出，这意味着 $2 z^\\top M z = 0$，所以 $z^\\top M z = 0$。前提“$z^\\top M z  0$ 对于所有非零 $z$”是错误的。\n\n**E) 对于一般的 $q$，解的存在性仅取决于 $q_1$ 的符号，当且仅当 $q_10$ 时有解。**\n**不正确。** 我们的分析确凿地表明，对于一般的 $q$，当且仅当 $q_20$ 时存在解。例如，对于 $q=[-1, 1]^\\top$，我们有 $q_1  0$ 但存在唯一解。", "answer": "$$\\boxed{B}$$", "id": "3109456"}, {"introduction": "当一个 LCP 无解时，算法如何检测到这一点？本练习 ([@problem_id:3109485]) 将引导你处理一个实例，其中求解 LCP 的基本方法——Lemke 算法——并非终止于一个解，而是通过识别一条“次射线”来终止。理解这一机制有助于洞察可行性的构造性证明以及互补算法的稳健行为。", "problem": "给定一个由矩阵 $M \\in \\mathbb{R}^{2 \\times 2}$ 和向量 $q \\in \\mathbb{R}^{2}$ 定义的小规模线性互补问题（LCP），以及一个用于 Lemke 算法（含人工变量 $z_{0}$）的严格正覆盖向量 $d \\in \\mathbb{R}^{2}_{++}$。考虑\n$$\nM \\;=\\; \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}, \n\\quad\nq \\;=\\; \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix},\n\\quad\nd \\;=\\; \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\nLCP 寻求 $z \\in \\mathbb{R}^{2}$ 和 $w \\in \\mathbb{R}^{2}$ 使得\n$$\nz \\;\\ge\\; 0,\\quad w \\;=\\; q + M z \\;\\ge\\; 0, \\quad \\text{and} \\quad z^{\\top} w \\;=\\; 0.\n$$\nLemke 算法应用于增广系统\n$$\nw \\;=\\; q + M z + z_{0} d, \n\\quad z \\;\\ge\\; 0, \\quad w \\;\\ge\\; 0, \\quad z_{0} \\;\\ge\\; 0, \n\\quad \\text{and} \\quad z_{i} w_{i} \\;=\\; 0 \\;\\; \\text{for} \\; i \\in \\{1,2\\}.\n$$\n\n任务：\n1. 使用线性互补问题（LCP）的定义和线性不等式择一引理（作为一个经过充分检验的基础事实），直接验证对于给定的 $M$ 和 $q$，原始的 LCP 是否有解。通过在 $z \\;\\ge\\; 0$ 条件下检验 $w \\;=\\; q + M z$ 的可行性，从第一性原理出发证明你的结论。\n2. 使用覆盖向量 $d$，确定最小人工变量水平 $z_{0}^{\\ast}$，在该水平下，Lemke 算法的标准初始化从人工解 $z \\;=\\; 0$ 和 $w \\;=\\; q + z_{0} d \\;\\ge\\; 0$ 开始。\n3. 将 Lemke 算法的次射线理论（一个经过充分检验的事实：如果存在非零 $r \\;\\ge\\; 0$ 满足 $M r \\;\\ge\\; 0$ 和 $q^{\\top} r \\; \\; 0$，则 LCP 无解且 Lemke 路径必然终止于一条次射线上）应用于此实例。给出一个明确的满足 $r \\;\\ge\\; 0$ 和 $M r \\;\\ge\\; 0$ 的非零向量 $r$，计算 $q^{\\top} r$，并解释为什么这会迫使 Lemke 算法产生一条射线而不是一个解。\n4. 令 $\\Delta z$ 表示在 $z_{0} \\;=\\; 0$ 时增广系统中次射线方向的 $z$ 分量。计算标量比\n$$\n\\rho \\;=\\; \\frac{\\Delta z_{2}}{\\Delta z_{1}}.\n$$\n\n请将你的最终答案以单个实数的形式给出。无需四舍五入。", "solution": "用户提供的问题陈述已经过验证，被认为是自洽、一致且科学上合理的。这是一个数学优化领域内的适定问题，具体涉及线性互补问题（LCP）和 Lemke 算法。求解所需的所有数据和定义均已提供。我们接下来进行详细求解。\n\n问题由矩阵 $M$、向量 $q$ 和覆盖向量 $d$ 定义：\n$$\nM = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}, \\quad q = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}, \\quad d = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\nLCP 是寻找满足 $z \\ge 0, w = q + Mz \\ge 0, z^{\\top}w = 0$ 的 $z, w \\in \\mathbb{R}^2$。\n\n**1. LCP 解存在性的验证**\n\nLCP 的解至少必须满足可行性条件 $z \\ge 0$ 和 $w = q + Mz \\ge 0$。令 $z = \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix}$。条件 $z \\ge 0$ 意味着 $z_1 \\ge 0$ 和 $z_2 \\ge 0$。\n\n条件 $w \\ge 0$ 表示为：\n$$\nw = \\begin{pmatrix} w_1 \\\\ w_2 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix} = \\begin{pmatrix} -1 - z_2 \\\\ z_1 \\end{pmatrix} \\ge \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n这产生了两个分量不等式：\n1.  $w_1 = -1 - z_2 \\ge 0$，这意味着 $z_2 \\le -1$。\n2.  $w_2 = z_1 \\ge 0$。\n\n问题要求 $z \\ge 0$，即 $z_2 \\ge 0$。然而，$w$ 的可行性要求 $z_2 \\le -1$。这两个条件，$z_2 \\ge 0$ 和 $z_2 \\le -1$，是相互排斥的。不存在可以同时满足这两个条件的实数 $z_2$。因此，可行解集 $\\{z \\in \\mathbb{R}^2 \\mid z \\ge 0, q+Mz \\ge 0\\}$ 是空的。由于不存在可行解，LCP 无解。\n\n按照建议，我们可以使用择一引理（具体地说是 Farkas 引理的一种形式）来证实这一点。系统 $Mz \\ge -q, z \\ge 0$ 不可行，当且仅当存在一个向量 $y \\ge 0$ 使得 $M^{\\top}y \\le 0$ 且 $(-q)^{\\top}y  0$。\n我们来寻找这样一个向量 $y = \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} \\ge 0$。\n条件 $M^{\\top}y \\le 0$ 是：\n$$\nM^{\\top}y = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = \\begin{pmatrix} y_2 \\\\ -y_1 \\end{pmatrix} \\le \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n这给出 $y_2 \\le 0$ 和 $-y_1 \\le 0$（或 $y_1 \\ge 0$）。\n条件 $(-q)^{\\top}y  0$ 是：\n$$\n(-q)^{\\top}y = - \\begin{pmatrix} -1  0 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = y_1  0.\n$$\n我们需要找到满足 $y_1 \\ge 0, y_2 \\ge 0$（来自 $y \\ge 0$），$y_1 \\ge 0, y_2 \\le 0$（来自 $M^{\\top}y \\le 0$），以及 $y_1  0$（来自 $(-q)^{\\top}y  0$）的 $y_1, y_2$。\n综合这些条件，我们得到 $y_1  0$ 和 $y_2 = 0$。一个有效的选择是 $y = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。该向量满足所有条件：$y \\ge 0$，$M^{\\top}y = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} \\le 0$，以及 $(-q)^{\\top}y = 1  0$。这样一个 $y$ 的存在证实了原始 LCP 是不可行的。\n\n**2. 最小人工变量水平 $z_0^{\\ast}$**\n\nLemke 算法从一个 $z=0$ 的人工解开始。增广系统是 $w = q + Mz + z_0 d$。在初始化时，我们设置 $z=0$ 并找到最小的 $z_0 \\ge 0$ 使得 $w = q + z_0 d \\ge 0$。\n代入给定的向量 $q$ 和 $d$：\n$$\n\\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} + z_0 \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\ge \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} -1 + z_0 \\\\ z_0 \\end{pmatrix} \\ge \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这导致以下不等式：\n1.  $-1 + z_0 \\ge 0 \\implies z_0 \\ge 1$。\n2.  $z_0 \\ge 0$。\n为了同时满足两者，我们必须有 $z_0 \\ge 1$。因此，$z_0$ 的最小值是 $z_0^{\\ast} = 1$。\n\n**3. 次射线理论的应用**\n\n该理论指出，如果存在一个非零向量 $r \\ge 0$ 使得 $Mr \\ge 0$ 且 $q^{\\top}r  0$，那么 LCP 无解，且 Lemke 算法会终止于一条次射线上。\n令 $r = \\begin{pmatrix} r_1 \\\\ r_2 \\end{pmatrix}$。条件是：\n1.  $r \\ge 0 \\implies r_1 \\ge 0, r_2 \\ge 0$。并且，$r \\ne 0$。\n2.  $Mr \\ge 0$：\n    $$\n    Mr = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} r_1 \\\\ r_2 \\end{pmatrix} = \\begin{pmatrix} -r_2 \\\\ r_1 \\end{pmatrix} \\ge \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n    $$\n    这意味着 $-r_2 \\ge 0$（所以 $r_2 \\le 0$）和 $r_1 \\ge 0$。\n3.  $q^{\\top}r  0$：\n    $$\n    q^{\\top}r = \\begin{pmatrix} -1  0 \\end{pmatrix} \\begin{pmatrix} r_1 \\\\ r_2 \\end{pmatrix} = -r_1  0.\n    $$\n    这意味着 $r_1  0$。\n\n综合关于 $r$ 的条件：从 $r_2 \\ge 0$ 和 $r_2 \\le 0$，我们得到 $r_2 = 0$。从 $r_1  0$ 和 $r \\ne 0$，我们看到任何形式为 $r = \\begin{pmatrix} r_1 \\\\ 0 \\end{pmatrix}$ 且 $r_1  0$ 的向量都满足条件。\n我们通过选择 $r_1 = 1$ 来给出一个明确的向量。所以，$r = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n我们来验证这个 $r$ 的条件：\n-   $r = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\ge 0$ 并且是非零的。\n-   $Mr = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\ge 0$。\n-   $q^{\\top}r = \\begin{pmatrix} -1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = -1  0$。\n所有条件都满足。这样一个向量 $r$ 的存在证明了 LCP 无解，并迫使 Lemke 算法终止于一条次射线上，该射线是增广系统在 $z_0=0$ 时可行域的一个无界方向。\n\n**4. 比率 $\\rho$ 的计算**\n\n次射线对应于变量空间 $(z, w)$ 中的一个非零方向 $(\\Delta z, \\Delta w)$，使得从射线上的一个点开始，可以沿此方向无限移动，同时保持可行性（$z \\ge 0, w \\ge 0$）和互补性。对于次射线，$z_0=0$。方向向量 $(\\Delta z, \\Delta w)$ 必须满足齐次系统：\n1.  $\\Delta w = M \\Delta z$\n2.  $\\Delta z \\ge 0, \\Delta w \\ge 0$，且 $\\Delta z \\ne 0$（因为射线在 $z$ 空间中）。\n3.  方向本身必须是互补的：对于 $i \\in \\{1,2\\}$，有 $\\Delta z_i \\Delta w_i = 0$。\n\n令 $\\Delta z = \\begin{pmatrix} \\Delta z_1 \\\\ \\Delta z_2 \\end{pmatrix}$。从 $\\Delta w = M \\Delta z$，我们有：\n$$\n\\Delta w = \\begin{pmatrix} \\Delta w_1 \\\\ \\Delta w_2 \\end{pmatrix} = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} \\Delta z_1 \\\\ \\Delta z_2 \\end{pmatrix} = \\begin{pmatrix} -\\Delta z_2 \\\\ \\Delta z_1 \\end{pmatrix}.\n$$\n非负性条件 $\\Delta z \\ge 0$ 和 $\\Delta w \\ge 0$ 要求：\n-   $\\Delta z_1 \\ge 0$\n-   $\\Delta z_2 \\ge 0$\n-   $\\Delta w_1 = -\\Delta z_2 \\ge 0 \\implies \\Delta z_2 \\le 0$\n-   $\\Delta w_2 = \\Delta z_1 \\ge 0$\n\n从 $\\Delta z_2 \\ge 0$ 和 $\\Delta z_2 \\le 0$，我们必须有 $\\Delta z_2 = 0$。\n由于 $\\Delta z \\ne 0$，我们必须有 $\\Delta z_1  0$。\n因此，$z$ 变量中射线的方向是任何与 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 成比例的向量。我们设 $\\Delta z = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n那么 $\\Delta z_1 = 1$ 且 $\\Delta z_2 = 0$。对应的 $\\Delta w$ 是 $\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。我们来验证互补条件 $\\Delta z_i \\Delta w_i = 0$：\n-   对于 $i=1$：$\\Delta z_1 \\Delta w_1 = 1 \\cdot 0 = 0$。\n-   对于 $i=2$：$\\Delta z_2 \\Delta w_2 = 0 \\cdot 1 = 0$。\n条件得到满足。射线方向的 $z$ 分量是 $\\Delta z = \\begin{pmatrix} k \\\\ 0 \\end{pmatrix}$，对于任何 $k0$。\n问题要求计算比率 $\\rho = \\frac{\\Delta z_2}{\\Delta z_1}$。使用任何这样的方向向量，我们得到：\n$$\n\\rho = \\frac{0}{k} = 0.\n$$\n比率的值与正常数比例因子 $k$ 无关。\n最终答案是 $0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "3109485"}]}