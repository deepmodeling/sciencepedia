{"hands_on_practices": [{"introduction": "这个入门练习旨在通过一个经典的场景建立你对S引理的直观理解。我们将探讨一个二次函数，它本身并非全局非负，但在一个简单的紧集上却能保证非负性。本练习将帮助你通过寻找一个“修正因子” $\\lambda$ 来“修复”这个函数，使其在整个空间内都非负，从而直观地展示S引理的核心作用。[@problem_id:3174402]", "problem": "设 $\\mathbf{x} \\in \\mathbb{R}^{2}$，并考虑两个二次函数 $f(\\mathbf{x}) = \\mathbf{x}^{\\top} A \\mathbf{x} + a^{\\top} \\mathbf{x} + a_{0}$ 和 $g(\\mathbf{x}) = \\mathbf{x}^{\\top} B \\mathbf{x} + b^{\\top} \\mathbf{x} + b_{0}$，其中 $A$ 和 $B$ 是 $\\mathbb{R}^{2 \\times 2}$ 中的对称矩阵，$a,b \\in \\mathbb{R}^{2}$，以及 $a_{0},b_{0} \\in \\mathbb{R}$。优化方法中的科学引理（S-引理，也称为S-过程）断言，在 $g$ 的严格可行性条件下，一个在子水平集 $\\{\\mathbf{x} : g(\\mathbf{x}) \\le 0\\}$ 上非负的二次函数 $f$，可以通过一个施加于 $g$ 的合适的非负标量乘子，得到一个全局非负性的证明。\n\n通过取 $A = -I_{2}$，$a = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$，$a_{0} = 5$，$B = I_{2}$，$b = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$ 以及 $b_{0} = -4$ 来构造以下具体实例，其中 $I_{2}$ 表示 $2 \\times 2$ 单位矩阵。通过这些选择，函数变为 $f(\\mathbf{x}) = -\\|\\mathbf{x}\\|^{2} + 5$ 和 $g(\\mathbf{x}) = \\|\\mathbf{x}\\|^{2} - 4$。\n\n从二次型的基本定义和正半定性的概念出发，并且不使用任何快捷公式，完成以下任务：\n- 验证可行集 $\\{\\mathbf{x} : g(\\mathbf{x}) \\le 0\\}$ 是非空的且严格可行的，并证明在该集合上 $f(\\mathbf{x}) \\ge 0$ 成立。\n- 证明 $f(\\mathbf{x})$ 在 $g$ 的可行集之外会取到负值。\n- 使用S-引理来论证存在一个非负标量 $\\lambda$，使得对于所有 $\\mathbf{x} \\in \\mathbb{R}^{2}$ 都有 $f(\\mathbf{x}) + \\lambda g(\\mathbf{x}) \\ge 0$，然后确定实现全局非负性的最小的 $\\lambda$。\n\n你的最终答案必须是最小 $\\lambda$ 的单一值（无单位）。如果需要任何数值近似，你会被要求四舍五入到指定的有效数字位数；这里需要一个精确值。", "solution": "首先根据所需标准对问题进行验证。\n\n**第一步：提取已知条件**\n- 向量变量为 $\\mathbf{x} \\in \\mathbb{R}^{2}$。\n- 定义了两个二次函数 $f(\\mathbf{x}) = \\mathbf{x}^{\\top} A \\mathbf{x} + a^{\\top} \\mathbf{x} + a_{0}$ 和 $g(\\mathbf{x}) = \\mathbf{x}^{\\top} B \\mathbf{x} + b^{\\top} \\mathbf{x} + b_{0}$。\n- 参数指定为 $A, B$ 是 $\\mathbb{R}^{2 \\times 2}$ 中的对称矩阵，向量 $a,b \\in \\mathbb{R}^{2}$，以及标量 $a_{0},b_{0} \\in \\mathbb{R}$。\n- S-引理被描述为断言：如果对于 $g$ 严格可行性条件成立，那么在集合 $\\{\\mathbf{x} : g(\\mathbf{x}) \\le 0\\}$ 上 $f(\\mathbf{x}) \\ge 0$ 意味着存在一个非负标量 $\\lambda$ 使得对于所有 $\\mathbf{x}$ 都有 $f(\\mathbf{x}) + \\lambda g(\\mathbf{x}) \\ge 0$。\n- 一个具体的实例被构造如下：\n  - $A = -I_{2}$（其中 $I_{2}$ 是 $2 \\times 2$ 单位矩阵）\n  - $a = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$\n  - $a_{0} = 5$\n  - $B = I_{2}$\n  - $b = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$\n  - $b_{0} = -4$\n- 得到的函数为 $f(\\mathbf{x}) = -\\|\\mathbf{x}\\|^{2} + 5$ 和 $g(\\mathbf{x}) = \\|\\mathbf{x}\\|^{2} - 4$。\n- 任务是：\n  1. 验证可行集 $\\{\\mathbf{x} : g(\\mathbf{x}) \\le 0\\}$ 是非空的且严格可行的，并证明在该集合上 $f(\\mathbf{x}) \\ge 0$ 成立。\n  2. 证明 $f(\\mathbf{x})$ 在该集合之外可以为负。\n  3. 使用S-引理来论证存在一个 $\\lambda \\ge 0$ 使得对于所有 $\\mathbf{x} \\in \\mathbb{R}^{2}$ 都有 $f(\\mathbf{x}) + \\lambda g(\\mathbf{x}) \\ge 0$，并求出最小的这样的 $\\lambda$。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学性：**该问题基于S-引理，这是凸优化和控制理论中一个基础且成熟的定理。所有的数学对象（矩阵、向量、二次型）都是标准的和良定义的。该问题在数学上是合理的。\n- **适定性：**该问题提供了定义函数 $f(\\mathbf{x})$ 和 $g(\\mathbf{x})$ 的所有必要信息。任务是明确的，并且可以导出一个特定的、唯一的最小 $\\lambda$ 值。在问题要求验证的条件下，S-引理保证了解的存在性。\n- **客观性：**该问题使用精确、形式化的数学语言陈述。它没有任何模糊性、主观性或观点。\n- 该问题是自洽的、一致的，并符合所有有效性标准。\n\n**第三步：结论和行动**\n问题有效。将提供完整解答。\n\n**解答推导**\n\n给定的参数是 $A = -I_{2}$，$a = \\mathbf{0}$，$a_{0} = 5$，$B = I_{2}$，$b = \\mathbf{0}$ 以及 $b_{0} = -4$。对于 $\\mathbf{x} \\in \\mathbb{R}^{2}$，二次函数为：\n$f(\\mathbf{x}) = \\mathbf{x}^{\\top}(-I_{2})\\mathbf{x} + \\mathbf{0}^{\\top}\\mathbf{x} + 5 = -\\mathbf{x}^{\\top}\\mathbf{x} + 5 = -\\|\\mathbf{x}\\|^{2} + 5$\n$g(\\mathbf{x}) = \\mathbf{x}^{\\top}(I_{2})\\mathbf{x} + \\mathbf{0}^{\\top}\\mathbf{x} - 4 = \\mathbf{x}^{\\top}\\mathbf{x} - 4 = \\|\\mathbf{x}\\|^{2} - 4$\n这里，$\\|\\mathbf{x}\\|$ 表示向量 $\\mathbf{x}$ 的欧几里得范数。\n\n**第一部分：可行集的分析及 $f(\\mathbf{x})$ 的非负性**\n\n可行集由不等式 $g(\\mathbf{x}) \\le 0$ 定义。\n$g(\\mathbf{x}) \\le 0 \\implies \\|\\mathbf{x}\\|^{2} - 4 \\le 0 \\implies \\|\\mathbf{x}\\|^{2} \\le 4 \\implies \\|\\mathbf{x}\\| \\le 2$。\n可行集 $S = \\{\\mathbf{x} \\in \\mathbb{R}^{2} : g(\\mathbf{x}) \\le 0\\}$ 是以原点为中心、半径为 $2$ 的闭圆盘。\n\n为了验证该集合非空，我们可以观察到原点 $\\mathbf{x} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$ 满足该条件，因为 $\\|\\mathbf{0}\\| = 0 \\le 2$。因此，$S$ 是非空的。\n\n严格可行性条件要求存在一点 $\\mathbf{x}_{0}$ 使得 $g(\\mathbf{x}_{0})  0$。我们再次选择原点 $\\mathbf{x}_{0} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。我们计算 $g(\\mathbf{0}) = \\|\\mathbf{0}\\|^{2} - 4 = 0 - 4 = -4$。由于 $-4  0$，严格可行性条件（也称为Slater条件）得到满足。\n\n接下来，我们必须证明对于可行集 $S$ 中的所有 $\\mathbf{x}$，都有 $f(\\mathbf{x}) \\ge 0$。对于任意 $\\mathbf{x} \\in S$，我们有 $\\|\\mathbf{x}\\|^{2} \\le 4$。乘以 $-1$ 会反转不等号：$-\\|\\mathbf{x}\\|^{2} \\ge -4$。两边同时加上 $5$ 得到：\n$-\\|\\mathbf{x}\\|^{2} + 5 \\ge -4 + 5$\n$f(\\mathbf{x}) \\ge 1$\n因为 $1 > 0$，所以 $f(\\mathbf{x}) \\ge 0$ 在集合 $S$ 上必然成立。\n\n**第二部分：$f(\\mathbf{x})$ 在可行集外的行为**\n\n在可行集外，我们有 $\\|\\mathbf{x}\\| > 2$。我们需要证明 $f(\\mathbf{x})$ 在这个区域可以取到负值。\n$f(\\mathbf{x}) = -\\|\\mathbf{x}\\|^{2} + 5$。\n要使 $f(\\mathbf{x})$ 为负，我们需要：\n$-\\|\\mathbf{x}\\|^{2} + 5  0 \\implies 5  \\|\\mathbf{x}\\|^{2} \\implies \\|\\mathbf{x}\\| > \\sqrt{5}$。\n因为 $\\sqrt{5} \\approx 2.236$，所以条件 $\\|\\mathbf{x}\\| > \\sqrt{5}$ 是一个比 $\\|\\mathbf{x}\\| > 2$ 更强的条件。任何满足 $\\|\\mathbf{x}\\| > \\sqrt{5}$ 的点 $\\mathbf{x}$ 都位于可行集 $S$ 之外，并导致 $f(\\mathbf{x})  0$。\n例如，考虑点 $\\mathbf{x} = \\begin{pmatrix}3 \\\\ 0\\end{pmatrix}$。它的范数是 $\\|\\mathbf{x}\\| = 3$，大于2，所以它在S之外。\n函数在该点的值是 $f(\\begin{pmatrix}3 \\\\ 0\\end{pmatrix}) = -\\| \\begin{pmatrix}3 \\\\ 0\\end{pmatrix} \\|^{2} + 5 = -3^{2} + 5 = -9 + 5 = -4$。\n由于 $-4  0$，这表明 $f(\\mathbf{x})$ 在可行集外会取到负值。\n\n**第三部分：S-引理的应用及最小 $\\lambda$ 的确定**\n\n对于单个二次约束的S-引理指出，蕴含关系\n$(g(\\mathbf{x}) \\le 0 \\implies f(\\mathbf{x}) \\ge 0)$\n等价于存在一个标量 $\\lambda \\ge 0$ 使得函数 $f(\\mathbf{x}) + \\lambda g(\\mathbf{x})$ 全局非负，即对于所有 $\\mathbf{x} \\in \\mathbb{R}^{n}$ 都有 $f(\\mathbf{x}) + \\lambda g(\\mathbf{x}) \\ge 0$。这一等价关系成立的前提是满足严格可行性条件（存在 $\\mathbf{x}_0$ 使得 $g(\\mathbf{x}_0)  0$）。\n\n我们已经验证了前提 $(g(\\mathbf{x}) \\le 0 \\implies f(\\mathbf{x}) \\ge 0)$ 和严格可行性条件。因此，S-引理保证了至少存在一个 $\\lambda \\ge 0$ 满足全局非负性。我们现在要寻找最小的这样一个 $\\lambda$。\n\n我们构造组合二次函数 $H(\\mathbf{x}, \\lambda) = f(\\mathbf{x}) + \\lambda g(\\mathbf{x})$：\n$H(\\mathbf{x}, \\lambda) = (-\\|\\mathbf{x}\\|^{2} + 5) + \\lambda (\\|\\mathbf{x}\\|^{2} - 4)$\n合并同类项，我们得到：\n$H(\\mathbf{x}, \\lambda) = (\\lambda - 1)\\|\\mathbf{x}\\|^{2} + (5 - 4\\lambda)$\n\n这个表达式是关于 $\\mathbf{x}$ 的一个二次型。为了使 $H(\\mathbf{x}, \\lambda)$ 对所有 $\\mathbf{x} \\in \\mathbb{R}^{2}$ 都非负，我们必须分析其结构。\n该函数可以写成 $\\mathbf{x}^{\\top} Q \\mathbf{x} + c$ 的形式，其中二次型的矩阵是 $Q = (\\lambda - 1)I_{2}$，常数项是 $c = 5 - 4\\lambda$。\n\n要使 $H(\\mathbf{x}, \\lambda) \\ge 0$ 对所有 $\\mathbf{x}$ 成立，必须满足两个条件：\n1. 矩阵 $Q$ 必须是正半定的（$Q \\succeq 0$）。对于像 $Q = \\begin{pmatrix} \\lambda-1  0 \\\\ 0  \\lambda-1 \\end{pmatrix}$ 这样的对角矩阵，这意味着其对角线元素必须是非负的。这给出了条件 $\\lambda - 1 \\ge 0$，即 $\\lambda \\ge 1$。如果这个条件成立，项 $(\\lambda - 1)\\|\\mathbf{x}\\|^{2}$ 总是非负的，且该函数有下界。\n2. 函数的全局最小值必须是非负的。当 $\\lambda - 1 \\ge 0$ 时，二次项 $(\\lambda - 1)\\|\\mathbf{x}\\|^{2}$ 是一个凸函数，其最小值为0，在 $\\mathbf{x} = \\mathbf{0}$ 处取得。因此，$H(\\mathbf{x}, \\lambda)$ 的全局最小值是它在 $\\mathbf{x} = \\mathbf{0}$ 处的值：\n$\\min_{\\mathbf{x}} H(\\mathbf{x}, \\lambda) = H(\\mathbf{0}, \\lambda) = (\\lambda - 1)\\|\\mathbf{0}\\|^{2} + (5 - 4\\lambda) = 5 - 4\\lambda$。\n为了实现全局非负性，这个最小值必须大于或等于 $0$：\n$5 - 4\\lambda \\ge 0 \\implies 5 \\ge 4\\lambda \\implies \\lambda \\le \\frac{5}{4}$。\n\n我们必须同时满足这两个条件：$\\lambda \\ge 1$ 和 $\\lambda \\le \\frac{5}{4}$。使 $f(\\mathbf{x}) + \\lambda g(\\mathbf{x})$ 全局非负的所有 $\\lambda$ 值的集合是闭区间 $[1, \\frac{5}{4}]$。\n\n问题要求的是最小的这样一个非负标量 $\\lambda$。在区间 $[1, \\frac{5}{4}]$ 中的最小值是 $1$。这个值也满足S-引理中 $\\lambda \\ge 0$ 的要求。\n因此，$\\lambda$ 的最小值是 $1$。\n我们来检验一下 $\\lambda=1$ 的情况：\n$H(\\mathbf{x}, 1) = (1-1)\\|\\mathbf{x}\\|^2 + (5 - 4(1)) = 0 + 1 = 1$。\n函数对于所有 $\\mathbf{x}$ 都是 $H(\\mathbf{x},1)=1$，这确实是非负的。", "answer": "$$\\boxed{1}$$", "id": "3174402"}, {"introduction": "在建立了基本概念之后，本练习将深入探讨S引理的一个核心应用：求解二次约束二次规划（QCQP）问题。你将看到S引理如何构建起通往对偶问题的桥梁，并揭示优化问题的最优值与相关矩阵的广义特征值之间的深刻联系。这是优化理论中的一个关键结果。[@problem_id:3174413]", "problem": "考虑$\\mathbb{R}^{2}$上的两个齐次二次函数，定义为 $f(\\mathbf{x}) = \\mathbf{x}^{\\top} A \\mathbf{x}$ 和 $g(\\mathbf{x}) = \\mathbf{x}^{\\top} B \\mathbf{x}$，其中 $A$ 和 $B$ 是实对称矩阵\n$$\nA = \\begin{pmatrix}\n4  1 \\\\\n1  2\n\\end{pmatrix}, \\qquad\nB = \\begin{pmatrix}\n-3  0 \\\\\n0  -1\n\\end{pmatrix}.\n$$\n假设 Slater 条件成立，即存在 $\\bar{\\mathbf{x}}$ 使得 $g(\\bar{\\mathbf{x}})  0$。从二次型、齐次性和 S-引理的基本事实出发，完成以下任务：\n\n首先，分析在锥 $\\{\\mathbf{x} \\in \\mathbb{R}^{2} : g(\\mathbf{x}) \\le 0\\}$ 上寻找 $f(\\mathbf{x})$ 最小值的优化问题。使用齐次性和 S-引理来严格确定该最小值是否为有限值，如果是，其值是多少。\n\n其次，为了获得一个非平凡的有限值，通过限制在水平集 $g(\\mathbf{x}) = -1$ 上来将齐次不等式归一化。从第一性原理出发，并使用 S-引理作为核心等价工具，推导出在 $\\{\\mathbf{x} \\in \\mathbb{R}^{2} : g(\\mathbf{x}) = -1\\}$ 上 $f(\\mathbf{x})$ 最小值的闭式表达式，该表达式用矩阵束 $(A,-B)$ 的广义特征值表示。然后，对于给定的 $A$ 和 $B$ 矩阵，显式地计算这个值。\n\n你最终报告的量必须是在归一化约束 $g(\\mathbf{x}) = -1$ 下 $f(\\mathbf{x})$ 的精确最小值。无需四舍五入。请将你的最终答案表示为一个无单位的单个实数。", "solution": "首先验证问题，以确保其是良定的且科学上合理的。\n\n### 第1步：提取已知条件\n- 齐次二次函数：$f(\\mathbf{x}) = \\mathbf{x}^{\\top} A \\mathbf{x}$ 和 $g(\\mathbf{x}) = \\mathbf{x}^{\\top} B \\mathbf{x}$，其中 $\\mathbf{x} \\in \\mathbb{R}^{2}$。\n- 实对称矩阵：\n$$\nA = \\begin{pmatrix}\n4  1 \\\\\n1  2\n\\end{pmatrix}, \\qquad\nB = \\begin{pmatrix}\n-3  0 \\\\\n0  -1\n\\end{pmatrix}.\n$$\n- 假设 Slater 条件对不等式 $g(\\mathbf{x}) \\le 0$ 成立，即存在一点 $\\bar{\\mathbf{x}}$ 使得 $g(\\bar{\\mathbf{x}})  0$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题是二次约束二次规划 (QCQP) 和 S-引理理论中的一个标准练习。\n1.  **科学依据：** 该问题基于线性代数、矩阵分析和优化理论中已建立的数学原理。S-引理是该领域的一个基本结果。\n2.  **良定性：** 该问题定义清晰，包含所有必要数据。矩阵 $A$ 和 $B$ 已指定，目标函数和约束是明确的。Slater 条件被明确给出。我们可以验证它：$g(\\mathbf{x}) = -3x_1^2 - x_2^2$。对于任何非零的 $\\bar{\\mathbf{x}}$，例如 $\\bar{\\mathbf{x}} = (1, 0)^{\\top}$，我们有 $g(\\bar{\\mathbf{x}}) = -3  0$。该条件成立。\n3.  **客观性：** 该问题以精确和客观的数学语言陈述。\n4.  **完整性和一致性：** 该问题是自洽的，没有矛盾。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n\n问题分为两部分。我们依次解决它们。\n\n**第1部分：分析在锥 $\\{ \\mathbf{x} \\in \\mathbb{R}^2 : g(\\mathbf{x}) \\le 0 \\}$ 上的优化问题**\n\n第一个优化问题是\n$$\n\\min_{\\mathbf{x} \\in \\mathbb{R}^2} f(\\mathbf{x}) \\quad \\text{服从约束} \\quad g(\\mathbf{x}) \\le 0.\n$$\n约束为 $g(\\mathbf{x}) = \\mathbf{x}^{\\top} B \\mathbf{x} = -3x_1^2 - x_2^2 \\le 0$。矩阵 $B$ 是负定的，因为其特征值为 $-3$ 和 $-1$。因此，不等式 $g(\\mathbf{x}) \\le 0$ 对所有 $\\mathbf{x} \\in \\mathbb{R}^2$ 都成立。可行集是整个空间 $\\mathbb{R}^2$。因此，该问题等价于在 $\\mathbb{R}^2$ 上对 $f(\\mathbf{x})$ 进行无约束最小化。\n\n函数 $f(\\mathbf{x}) = \\mathbf{x}^{\\top} A \\mathbf{x}$ 是一个二次型。其性质由矩阵 $A$ 决定。$A$ 的特征值由特征方程 $\\det(A - \\lambda I) = 0$ 的根给出：\n$$\n\\det\\begin{pmatrix} 4-\\lambda  1 \\\\ 1  2-\\lambda \\end{pmatrix} = (4-\\lambda)(2-\\lambda)-1 = \\lambda^2 - 6\\lambda + 7 = 0.\n$$\n特征值为 $\\lambda = \\frac{6 \\pm \\sqrt{36 - 28}}{2} = 3 \\pm \\sqrt{2}$。两个特征值都是正的，所以矩阵 $A$ 是正定的 ($A \\succ 0$)。\n\n由于 $A$ 是正定的，对所有 $\\mathbf{x} \\neq \\mathbf{0}$ 都有 $f(\\mathbf{x}) = \\mathbf{x}^{\\top}A\\mathbf{x} > 0$，且 $f(\\mathbf{0}) = 0$。因此，$f(\\mathbf{x})$ 的全局最小值是 $0$，在 $\\mathbf{x} = \\mathbf{0}$ 处达到。点 $\\mathbf{x} = \\mathbf{0}$ 位于可行集中，因为 $g(\\mathbf{0}) = 0$。因此，最小值是有限的，等于 $0$。\n\n$f$ 和 $g$ 的齐次性意味着，如果存在一个可行点 $\\mathbf{x}_0$ 使得 $f(\\mathbf{x}_0)  0$，那么对于任意标量 $\\alpha > 0$，$\\alpha \\mathbf{x}_0$ 也将是可行的，并且 $f(\\alpha \\mathbf{x}_0) = \\alpha^2 f(\\mathbf{x}_0)$。当 $\\alpha \\to \\infty$ 时，目标函数将下无界（下确界为 $-\\infty$）。为了确定是否是这种情况，我们可以使用 S-引理。\n\nS-引理指出，对于两个二次型 $f(\\mathbf{x})$ 和 $g(\\mathbf{x})$，蕴含关系 $g(\\mathbf{x}) \\le 0 \\implies f(\\mathbf{x}) \\ge 0$ 成立，当且仅当存在一个标量 $\\tau \\ge 0$ 使得 $A - \\tau(-B) \\succeq 0$，即 $A+\\tau B \\succeq 0$，前提是 Slater 条件成立。在我们的记法中，这等价于 $\\exists \\tau \\ge 0$ 使得 $A - \\tau B \\succeq 0$。我们来检查这个条件：\n$$\nA - \\tau B = \\begin{pmatrix} 4  1 \\\\ 1  2 \\end{pmatrix} - \\tau \\begin{pmatrix} -3  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} 4+3\\tau  1 \\\\ 1  2+\\tau \\end{pmatrix}.\n$$\n为使该矩阵对于某个 $\\tau \\ge 0$ 是半正定的，其所有主子式必须为非负。\n1.  $4+3\\tau \\ge 0$ (对 $\\tau \\ge 0$ 成立)。\n2.  $\\det(A-\\tau B) = (4+3\\tau)(2+\\tau) - 1 = 3\\tau^2 + 10\\tau + 7 \\ge 0$。\n$3\\tau^2 + 10\\tau + 7 = 0$ 的根是 $\\tau = \\frac{-10 \\pm 4}{6}$，即 $\\tau_1 = -1$ 和 $\\tau_2 = -7/3$。由于这是一个开口向上的抛物线，当 $\\tau \\in (-\\infty, -7/3] \\cup [-1, \\infty)$ 时，该二次式为非负。\n我们需要找到是否存在一个 $\\tau \\ge 0$ 满足此条件。任何 $\\tau \\ge 0$ 都位于区间 $[-1, \\infty)$ 中。例如，$\\tau=0$ 是可行的，因为 $A$ 是正定的。\nS-引理证实了对于可行集中的所有 $\\mathbf{x}$，都有 $f(\\mathbf{x}) \\ge 0$。因此最小值为 $0$，在 $\\mathbf{x} = \\mathbf{0}$ 处取得。\n\n**第2部分：分析在水平集 $\\{ \\mathbf{x} \\in \\mathbb{R}^2 : g(\\mathbf{x}) = -1 \\}$ 上的优化问题**\n\n第二个优化问题是找到在等式约束 $g(\\mathbf{x}) = -1$ 下 $f(\\mathbf{x})$ 的最小值：\n$$\n\\gamma^* = \\min_{\\mathbf{x} \\in \\mathbb{R}^2} \\mathbf{x}^{\\top} A \\mathbf{x} \\quad \\text{服从约束} \\quad \\mathbf{x}^{\\top} B \\mathbf{x} = -1.\n$$\n约束 $\\mathbf{x}^{\\top} B \\mathbf{x} = -1$ 等价于 $-3x_1^2 - x_2^2 = -1$，即 $3x_1^2 + x_2^2 = 1$。这定义了一个紧集（一个椭圆），因此最小值保证存在。\n\n这是一个带有一个等式约束的 QCQP 问题。我们可以使用 S-引理框架来求解，对于此类问题，这等价于分析其拉格朗日对偶问题。最小值 $\\gamma^*$ 是所有满足“对于所有满足 $\\mathbf{x}^{\\top}B\\mathbf{x} = -1$ 的 $\\mathbf{x}$，都有 $\\mathbf{x}^{\\top}A\\mathbf{x} \\ge \\gamma$”这一陈述的 $\\gamma$ 的上确界。这可以重写为：对于所有满足 $\\mathbf{x}^{\\top}B\\mathbf{x} + 1 = 0$ 的 $\\mathbf{x}$，都有 $\\mathbf{x}^{\\top}A\\mathbf{x} - \\gamma \\ge 0$。\n\n我们通过引入一个变量 $t$ 来将问题齐次化，令 $\\mathbf{z} = (\\mathbf{x}^{\\top}, t)^{\\top}$。条件变为对于所有满足 $\\mathbf{x}^{\\top}B\\mathbf{x} + t^2 = 0$ 的 $(\\mathbf{x}, t)$，都有 $\\mathbf{x}^{\\top}A\\mathbf{x} - \\gamma t^2 \\ge 0$。这可以用关于 $\\mathbf{z}$ 的二次型来表示：\n$$\n\\mathbf{z}^{\\top} \\begin{pmatrix} A  \\mathbf{0} \\\\ \\mathbf{0}^{\\top}  -\\gamma \\end{pmatrix} \\mathbf{z} \\ge 0 \\quad \\text{对于所有 } \\mathbf{z} \\text{ 使得 } \\quad \\mathbf{z}^{\\top} \\begin{pmatrix} B  \\mathbf{0} \\\\ \\mathbf{0}^{\\top}  1 \\end{pmatrix} \\mathbf{z} = 0.\n$$\n根据等式约束的 S-引理（该结果也称为 Finsler's Lemma），该蕴含关系成立，当且仅当存在一个标量 $\\lambda \\in \\mathbb{R}$ 使得：\n$$\n\\begin{pmatrix} A  \\mathbf{0} \\\\ \\mathbf{0}^{\\top}  -\\gamma \\end{pmatrix} + \\lambda \\begin{pmatrix} B  \\mathbf{0} \\\\ \\mathbf{0}^{\\top}  1 \\end{pmatrix} \\succeq 0.\n$$\n这个块对角矩阵是半正定的，当且仅当两个对角块都是半正定的：\n1.  $A + \\lambda B \\succeq 0$。\n2.  $-\\gamma + \\lambda \\ge 0 \\implies \\gamma \\le \\lambda$。\n\n因此，要使 $\\gamma$ 成为目标函数的一个下界，必须存在一个 $\\lambda$ 使得 $A+\\lambda B \\succeq 0$ 并且 $\\gamma \\le \\lambda$。我们寻求最小值 $\\gamma^*$，它是最紧（最大）的此类下界。这由对偶问题的解给出：\n$$\n\\gamma^* = \\max \\{ \\gamma \\mid \\exists \\lambda \\text{ s.t. } A+\\lambda B \\succeq 0 \\text{ and } \\gamma \\le \\lambda \\}.\n$$\n这等价于在集合 $\\{ \\lambda \\mid A+\\lambda B \\succeq 0 \\}$ 上找到 $\\lambda$ 的最大值。\n$$\n\\gamma^* = \\max \\{ \\lambda \\mid A+\\lambda B \\succeq 0 \\}.\n$$\n我们来分析条件 $A+\\lambda B \\succeq 0$：\n$$\nA + \\lambda B = \\begin{pmatrix} 4  1 \\\\ 1  2 \\end{pmatrix} + \\lambda \\begin{pmatrix} -3  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} 4-3\\lambda  1 \\\\ 1  2-\\lambda \\end{pmatrix}.\n$$\n该矩阵是半正定的，当且仅当其主子式为非负：\n1.  $4-3\\lambda \\ge 0 \\implies \\lambda \\le 4/3$。\n2.  $\\det(A+\\lambda B) = (4-3\\lambda)(2-\\lambda) - 1 = 3\\lambda^2 - 10\\lambda + 7 \\ge 0$。\n$3\\lambda^2 - 10\\lambda + 7 = 0$ 的根是 $\\lambda = \\frac{10 \\pm \\sqrt{100-84}}{6} = \\frac{10 \\pm 4}{6}$，这给出 $\\lambda_1 = 1$ 和 $\\lambda_2 = 7/3$。当 $\\lambda \\in (-\\infty, 1] \\cup [7/3, \\infty)$ 时，该二次式为非负。\n\n我们必须同时满足 $\\lambda \\le 4/3$ 和 ($\\lambda \\le 1$ 或 $\\lambda \\ge 7/3$)。这些条件的交集是 $\\lambda \\le 1$。可行的 $\\lambda$ 集合是 $(-\\infty, 1]$。\n对偶问题是求解 $\\max\\{\\lambda \\mid \\lambda \\in (-\\infty, 1] \\}$。最大值是 $1$。\n根据强对偶性（该问题满足强对偶性），原问题的最优值等于对偶问题的最优值。因此，$\\gamma^* = 1$。\n\n这个结果可以用矩阵束 $(A, -B)$ 的广义特征值来表示。$(A, -B)$ 的一个广义特征值 $\\lambda$ 是 $\\det(A - \\lambda(-B)) = \\det(A+\\lambda B) = 0$ 的一个根。如上计算，这些特征值是 $\\lambda_1 = 1$ 和 $\\lambda_2 = 7/3$。\n条件 $A+\\lambda B \\succeq 0$ 等价于 $A-\\lambda(-B) \\succeq 0$。由于 $-B$ 是正定的，该条件成立当且仅当 $\\lambda$ 小于或等于矩阵对 $(A, -B)$ 的最小广义特征值。即 $\\lambda \\le \\lambda_{\\min}(A, -B)$。\n对偶问题寻求在该条件下最大化 $\\lambda$。因此最大值为 $\\lambda = \\lambda_{\\min}(A, -B)$。\n因此，$f(\\mathbf{x})$ 的最小值是矩阵束 $(A, -B)$ 的最小广义特征值。\n广义特征值是 $1$ 和 $7/3$。最小的是 $1$。\n\n在 $\\{\\mathbf{x} \\in \\mathbb{R}^{2} : g(\\mathbf{x}) = -1\\}$ 上 $f(\\mathbf{x})$ 的最小值是 $1$。", "answer": "$$\\boxed{1}$$", "id": "3174413"}, {"introduction": "理论是强大的，但对于复杂问题，我们如何在实践中找到S引理的证书 $\\lambda$ 呢？这最后一个练习将指导你开发一个数值算法。你将实现二分法来寻找保证矩阵半正定的最小非负 $\\lambda$，从而将抽象的存在性定理转化为具体的计算工具。[@problem_id:3174444]", "problem": "考虑对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和 $B \\in \\mathbb{R}^{n \\times n}$。假设 $A$ 是对称正定 (SPD) 矩阵，$B$ 是对称矩阵。定义二次型 $q_A(x) = x^\\top A x$ 和 $q_B(x) = x^\\top B x$。在 S-引理 (S-procedure) 的背景下，我们寻求一个非负标量 $\\lambda \\ge 0$，使得矩阵 $B + \\lambda A$ 是半正定 (PSD) 的，记作 $B + \\lambda A \\succeq 0$。在适当的正则性假设下，这样一个 $\\lambda$ 的存在性对于证明一个二次型在另一个二次型的子水平集上是非负的至关重要。\n\n仅从关于对称矩阵和二次型的基本事实出发，解决以下问题：\n\n1. 使用对称矩阵的标准谱性质和瑞利商表征，证明找到最小的 $\\lambda \\ge 0$ 使得 $B + \\lambda A \\succeq 0$ 等价于确定一个沿 $A$ 的平移，该平移将 $(B,A)$ 的最小广义瑞利商提升至零。建立最小此类平移与广义特征值表征之间的精确等价关系。\n\n2. 设计一个算法，在给定 SPD 矩阵 $A$ 和对称矩阵 $B$ 的情况下，找到最小的 $\\lambda \\ge 0$ 使得 $B + \\lambda A \\succeq 0$。您的算法必须是有原则的，依赖于关于标量 $\\lambda$ 的单调谱行为，并使用对合适的标量函数进行迭代二分法，以定位达到半正定性的阈值。使用 $\\lambda$ 的绝对容差 $10^{-8}$ 作为停止准则。\n\n3. 为了验证和测试，使用基于相似变换到标准对称特征值问题的广义特征值方法，计算最小 $\\lambda \\ge 0$ 的参考值。然后将二分法估计值与此参考值进行比较，以评估收敛性。\n\n将您的算法和测试实现为一个完整的、可运行的程序。该程序必须无需输入即可运行，并按指定格式生成单行输出。使用以下测试套件，其中包括五个 $(A,B)$ 对，用于探测不同情形：\n\n- 测试用例 1 (基准 $2 \\times 2$)：\n  $$\n  A_1 = \\begin{bmatrix} 2  0 \\\\ 0  1 \\end{bmatrix}, \\quad\n  B_1 = \\begin{bmatrix} 1  0.2 \\\\ 0.2  -1 \\end{bmatrix}.\n  $$\n- 测试用例 2 (基准 $3 \\times 3$)：\n  $$\n  A_2 = \\begin{bmatrix} 3  0.5  0 \\\\ 0.5  2  0.3 \\\\ 0  0.3  1.5 \\end{bmatrix}, \\quad\n  B_2 = \\begin{bmatrix} -1  0.4  0 \\\\ 0.4  0.5  0.2 \\\\ 0  0.2  -0.2 \\end{bmatrix}.\n  $$\n- 测试用例 3 (B 已经是 PSD)：\n  $$\n  A_3 = \\begin{bmatrix} 1  0.2 \\\\ 0.2  1 \\end{bmatrix}, \\quad\n  B_3 = \\begin{bmatrix} 0.5  0.1 \\\\ 0.1  0.3 \\end{bmatrix}.\n  $$\n- 测试用例 4 (病态的 A)：\n  $$\n  A_4 = \\begin{bmatrix} 10^{-4}  0  0 \\\\ 0  1  0 \\\\ 0  0  2 \\end{bmatrix}, \\quad\n  B_4 = \\begin{bmatrix} 0  0.01  0 \\\\ 0.01  -0.5  0.02 \\\\ 0  -0.02  0.1 \\end{bmatrix}.\n  $$\n- 测试用例 5 (近边界小位移)：\n  $$\n  A_5 = \\begin{bmatrix} 2  0.3 \\\\ 0.3  1 \\end{bmatrix}, \\quad\n  B_5 = -10^{-6} \\, A_5.\n  $$\n\n对于每个测试用例，计算：\n- 最小 $\\lambda \\ge 0$ 使得 $B + \\lambda A \\succeq 0$ 的二分法估计值 $\\hat{\\lambda}$，\n- 通过广义特征值方法获得的参考值 $\\lambda^\\star$。\n\n您的程序应生成一行输出，其中包含五个布尔结果，每个测试用例一个，表示 $|\\hat{\\lambda} - \\lambda^\\star| \\le 10^{-8}$ 是否成立。输出必须是方括号内以逗号分隔的列表，不含额外空格或文本，例如“[True,False,True,True,False]”。不涉及物理单位，也不需要角度单位。所有数值容差均按规定使用绝对值表示。", "solution": "我们从关于对称矩阵和二次型的基本事实出发。根据谱定理，对称矩阵可通过实特征值进行对角化。对于 $A \\succ 0$（对称正定），我们有对所有 $x \\neq 0$ 都有 $x^\\top A x > 0$。对于两个对称矩阵 $A \\succ 0$ 和 $B$，广义特征值问题 $B v = \\mu A v$ 具有实特征值和一组 A-正交的特征向量基。广义瑞利商定义为\n$$\n\\mu(x) = \\frac{x^\\top B x}{x^\\top A x}, \\quad x \\neq 0,\n$$\n其极值根据 Courant–Fischer 表征与最小和最大广义特征值重合。\n\n任务1：为了将最小的 $\\lambda \\ge 0$ 与 $B + \\lambda A$ 的半正定性联系起来，考虑在 $x \\neq 0$ 处对 $B + \\lambda A$ 的二次型求值：\n$$\nx^\\top (B + \\lambda A) x = x^\\top B x + \\lambda \\, x^\\top A x = x^\\top A x \\, \\big( \\mu(x) + \\lambda \\big).\n$$\n因为 $x^\\top A x > 0$，所以 $x^\\top (B + \\lambda A) x$ 的符号由 $\\mu(x) + \\lambda$ 决定。定义 $\\mu_{\\min}$ 为 $(B,A)$ 的最小广义特征值，等价于 $\\mu(x)$ 在 $x \\neq 0$ 上的最小值。那么\n$$\n\\min_{x \\neq 0} x^\\top (B + \\lambda A) x = \\min_{x \\neq 0} x^\\top A x \\, \\big( \\mu(x) + \\lambda \\big).\n$$\n由于对所有 $x \\neq 0$ 都有 $x^\\top A x > 0$，其最小值非负当且仅当 $\\mu_{\\min} + \\lambda \\ge 0$。因此，使 $B + \\lambda A \\succeq 0$ 的最小 $\\lambda$ 为\n$$\n\\lambda^\\star = \\max\\{0, -\\mu_{\\min}\\}.\n$$\n这表明，找到 $\\lambda$ 等价于沿 $A$ 平移 $B$ 直到最小广义瑞利商被提升到零，而该阈值由 $(B,A)$ 的最小广义特征值表征。\n\n一种计算上简便的获取广义特征值的方法是使用对称相似变换。设 $A = Q \\Lambda Q^\\top$ 是 $A$ 的特征分解，其中 $Q$ 是正交矩阵，$\\Lambda$ 是对角矩阵，其元素严格为正。定义 $A^{1/2} = Q \\Lambda^{1/2} Q^\\top$ 和 $A^{-1/2} = Q \\Lambda^{-1/2} Q^\\top$。那么\n$$\nC = A^{-1/2} B A^{-1/2}\n$$\n是对称的，并且 $(B,A)$ 的广义特征值等于 $C$ 的普通特征值。特别地，\n$$\n\\mu_{\\min} = \\lambda_{\\min}(C), \\quad \\lambda^\\star = \\max\\{0, -\\lambda_{\\min}(C)\\}.\n$$\n\n任务2：我们设计一个二分算法来定位阈值 $\\lambda^\\star$。定义标量函数\n$$\n\\phi(\\lambda) = \\lambda_{\\min}\\big( B + \\lambda A \\big),\n$$\n即对称矩阵 $B + \\lambda A$ 的最小特征值。函数 $\\phi(\\lambda)$ 在 $\\lambda$ 上是连续且单调不减的，因为加上 $\\lambda A \\succeq 0$ 会使所有瑞利商增加 $\\lambda$ 倍的 A-瑞利权重。阈值 $\\lambda^\\star$ 满足 $\\phi(\\lambda^\\star) = 0$，并且 $B + \\lambda A \\succeq 0$ 当且仅当 $\\phi(\\lambda) \\ge 0$。因此，我们可以通过对 $\\phi(\\lambda)$ 进行二分法来定位 $\\lambda^\\star$：\n\n- 如果 $\\phi(0) \\ge 0$，则 $\\lambda^\\star = 0$，我们终止。\n- 否则，通过加倍找到一个上界 $\\overline{\\lambda}$ 使得 $\\phi(\\overline{\\lambda}) \\ge 0$：从 $\\overline{\\lambda} = 1$ 开始，并重复设置 $\\overline{\\lambda} \\leftarrow 2 \\overline{\\lambda}$ 直到 $\\phi(\\overline{\\lambda}) \\ge 0$（由于 $A \\succ 0$，这一定能实现）。\n- 维持区间 $[\\, \\underline{\\lambda}, \\overline{\\lambda} \\,]$，其中 $\\underline{\\lambda} = 0$，并在每次迭代中计算中点 $m = (\\underline{\\lambda} + \\overline{\\lambda})/2$ 处的 $\\phi$ 值。如果 $\\phi(m)  0$，则设置 $\\underline{\\lambda} \\leftarrow m$；否则设置 $\\overline{\\lambda} \\leftarrow m$。\n- 当区间宽度满足 $\\overline{\\lambda} - \\underline{\\lambda} \\le 10^{-8}$ 时停止，并报告 $\\hat{\\lambda} = \\overline{\\lambda}$。\n\n该算法保证收敛，因为 $\\phi$ 是连续和单调的，初始区间包含符号变化，并且二分法每次迭代都会将区间宽度减半。从宽度为 $W$ 的初始区间达到绝对容差 $10^{-8}$ 所需的迭代次数最多为 $\\lceil \\log_2(W / 10^{-8}) \\rceil$。\n\n任务3：为进行验证，我们通过广义特征值方法计算参考值 $\\lambda^\\star$：\n- 计算对称特征分解 $A = Q \\Lambda Q^\\top$，\n- 构造 $A^{-1/2} = Q \\Lambda^{-1/2} Q^\\top$，\n- 计算 $C = A^{-1/2} B A^{-1/2}$，\n- 获取 $\\mu_{\\min} = \\lambda_{\\min}(C)$ 并设置 $\\lambda^\\star = \\max\\{0, -\\mu_{\\min}\\}$。\n\n然后，我们比较二分法估计值 $\\hat{\\lambda}$ 与 $\\lambda^\\star$ 的绝对误差，如果 $|\\hat{\\lambda} - \\lambda^\\star| \\le 10^{-8}$，则宣布收敛。\n\n实现细节：\n- 使用对称特征值计算（例如，通过利用对称性计算 $\\lambda_{\\min}$ 的算法）。\n- 确保 $A$ 是 SPD 矩阵，以便 $\\Lambda$ 具有严格正的元素并且 $A^{-1/2}$ 是良定义的。\n- 使用提供的五个测试用例。这些用例涵盖：一个基准 $2 \\times 2$ 不定矩阵 $B$（测试1），一个具有混合定性的基准 $3 \\times 3$ 情况（测试2），一个 $B$ 已经是 PSD 的情况，导致 $\\lambda^\\star = 0$（测试3），一个病态的 $A$ 用于测试数值稳定性（测试4），以及一个具有非常小正位移的近边界情况（测试5）。\n\n最终输出格式：\n- 程序必须生成一行输出，该输出是方括号内的一个逗号分隔列表，其中包含五个布尔值，按测试用例的顺序指示二分法估计值是否在绝对容差 $10^{-8}$ 内与参考值一致：$[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_i$ 是 $\\mathrm{True}$ 或 $\\mathrm{False}$。", "answer": "```python\nimport numpy as np\n\ndef min_eig_sym(M: np.ndarray) - float:\n    \"\"\"\n    Compute the smallest eigenvalue of a real symmetric matrix using\n    an algorithm that exploits symmetry.\n    \"\"\"\n    # np.linalg.eigvalsh is for Hermitian/symmetric matrices and returns sorted eigenvalues\n    vals = np.linalg.eigvalsh(M)\n    return float(vals[0])\n\ndef A_inv_sqrt(A: np.ndarray) - np.ndarray:\n    \"\"\"\n    Compute A^{-1/2} for SPD matrix A via eigen-decomposition.\n    \"\"\"\n    # Eigen-decomposition: A = Q diag(lam) Q^T\n    lam, Q = np.linalg.eigh(A)\n    # Ensure positive definiteness numerically\n    if np.any(lam = 0):\n        raise ValueError(\"Matrix A must be SPD to compute A^{-1/2}.\")\n    inv_sqrt_lam = np.diag(1.0 / np.sqrt(lam))\n    A_inv_sqrt_mat = Q @ inv_sqrt_lam @ Q.T\n    return A_inv_sqrt_mat\n\ndef generalized_lambda_star(A: np.ndarray, B: np.ndarray) - float:\n    \"\"\"\n    Compute the reference minimal lambda = 0 such that B + lambda A is PSD,\n    using generalized eigenvalue characterization via C = A^{-1/2} B A^{-1/2}.\n    \"\"\"\n    Ais = A_inv_sqrt(A)\n    C = Ais @ B @ Ais\n    mu_min = min_eig_sym(C)\n    lambda_star = max(0.0, -mu_min)\n    return float(lambda_star)\n\ndef bisection_lambda_psd(A: np.ndarray, B: np.ndarray, tol: float = 1e-8, max_iter: int = 200) - tuple[float, int]:\n    \"\"\"\n    Find the smallest lambda = 0 such that B + lambda A is PSD using bisection\n    on the minimal eigenvalue of B + lambda A.\n    Returns (lambda_hat, iterations).\n    \"\"\"\n    # Check trivial case: B already PSD\n    phi0 = min_eig_sym(B)\n    if phi0 = 0.0:\n        return 0.0, 0\n\n    # Bracket an upper bound where matrix becomes PSD\n    lower = 0.0\n    upper = 1.0\n    # Increase upper until B + upper A is PSD (phi(upper) = 0)\n    for _ in range(60):  # 2**60 is huge; this should be sufficient practically\n        phi_upper = min_eig_sym(B + upper * A)\n        if phi_upper = 0.0:\n            break\n        upper *= 2.0\n    else:\n        # If we cannot bracket, something is wrong (A likely not SPD)\n        raise RuntimeError(\"Failed to bracket lambda: check that A is SPD.\")\n\n    # Bisection loop\n    it = 0\n    while (upper - lower)  tol and it  max_iter:\n        mid = 0.5 * (lower + upper)\n        phi_mid = min_eig_sym(B + mid * A)\n        if phi_mid  0.0:\n            lower = mid\n        else:\n            upper = mid\n        it += 1\n\n    return float(upper), it\n\ndef solve():\n    # Define the test cases (A, B) from the problem statement.\n    test_cases = [\n        # Test case 1\n        (\n            np.array([[2.0, 0.0],\n                      [0.0, 1.0]]),\n            np.array([[1.0, 0.2],\n                      [0.2, -1.0]])\n        ),\n        # Test case 2\n        (\n            np.array([[3.0, 0.5, 0.0],\n                      [0.5, 2.0, 0.3],\n                      [0.0, 0.3, 1.5]]),\n            np.array([[-1.0, 0.4, 0.0],\n                      [0.4, 0.5, 0.2],\n                      [0.0, 0.2, -0.2]])\n        ),\n        # Test case 3\n        (\n            np.array([[1.0, 0.2],\n                      [0.2, 1.0]]),\n            np.array([[0.5, 0.1],\n                      [0.1, 0.3]])\n        ),\n        # Test case 4\n        (\n            np.array([[1e-4, 0.0, 0.0],\n                      [0.0, 1.0, 0.0],\n                      [0.0, 0.0, 2.0]]),\n            np.array([[0.0, 0.01, 0.0],\n                      [0.01, -0.5, 0.02],\n                      [0.0, -0.02, 0.1]])\n        ),\n        # Test case 5\n        (\n            np.array([[2.0, 0.3],\n                      [0.3, 1.0]]),\n            -1e-6 * np.array([[2.0, 0.3],\n                               [0.3, 1.0]])\n        ),\n    ]\n\n    tol = 1e-8\n    results = []\n    for A, B in test_cases:\n        # Compute bisection estimate\n        lambda_hat, _ = bisection_lambda_psd(A, B, tol=tol, max_iter=300)\n        # Compute reference via generalized eigenvalues\n        lambda_star = generalized_lambda_star(A, B)\n        # Convergence test\n        success = abs(lambda_hat - lambda_star) = tol\n        results.append(success)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r).capitalize() for r in results)}]\")\n\nsolve()\n```", "id": "3174444"}]}