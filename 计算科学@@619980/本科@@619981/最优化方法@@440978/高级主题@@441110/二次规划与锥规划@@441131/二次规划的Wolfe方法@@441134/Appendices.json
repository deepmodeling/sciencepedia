{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式莫过于动手实践。我们从沃尔夫方法的心脏——单次迭代——开始。这个练习 [@problem_id:3198861] 将一个迭代步骤分解为一个清晰的“调试清单”，引导你验证可行性、构造零空间、求解降维子问题，并计算步长。完成这个练习将为后续更复杂的求解过程打下坚实的基础。", "problem": "考虑一个凸二次规划问题，其目标函数为 $f(\\mathbf{x}) = \\frac{1}{2}\\,\\mathbf{x}^{\\top}\\mathbf{Q}\\,\\mathbf{x} + \\mathbf{c}^{\\top}\\mathbf{x}$，线性不等式约束为 $\\mathbf{A}\\mathbf{x} \\le \\mathbf{b}$，其中\n$$\n\\mathbf{Q} = \\begin{pmatrix}\n4   2 \\\\\n2   2\n\\end{pmatrix},\\quad\n\\mathbf{c} = \\begin{pmatrix}\n-2 \\\\\n-6\n\\end{pmatrix},\\quad\n\\mathbf{A} = \\begin{pmatrix}\n1   0 \\\\\n1   1 \\\\\n-1  2\n\\end{pmatrix},\\quad\n\\mathbf{b} = \\begin{pmatrix}\n2 \\\\\n2 \\\\\n2\n\\end{pmatrix}.\n$$\n您将应用用于二次规划的Wolfe方法的“调试”清单，从可行点 $\\mathbf{x}^{(0)} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 开始，初始工作集 $\\mathcal{W}^{(0)}$ 由$\\mathbf{A}$的第二行给出的单个积极约束组成，因此工作集等式为 $\\mathbf{a}_{2}^{\\top}\\mathbf{x} = b_{2}$。\n\n请遵循以下步骤，并根据优化方法的第一性原理对每一步进行论证：验证原始可行性 $\\mathbf{A}\\mathbf{x}^{(0)} \\le \\mathbf{b}$ 并计算残差 $r_{i} = b_{i} - \\mathbf{a}_{i}^{\\top}\\mathbf{x}^{(0)}$，为积极约束构建一个零空间基 $\\mathbf{Z}$ 以使得 $\\mathbf{A}_{\\mathcal{W}^{(0)}}\\mathbf{Z} = \\mathbf{0}$，构建并求解确定在可行域当前面上的搜索方向 $\\mathbf{p} = \\mathbf{Z}\\mathbf{d}$ 的缩减系统，然后计算沿 $\\mathbf{x}(\\alpha) = \\mathbf{x}^{(0)} + \\alpha\\,\\mathbf{p}$ 下一个约束变为积极约束时的交点步长 $\\alpha$。\n\n您的任务是根据给定数据执行这些步骤，并报告下一个约束进入工作集时的交点步长 $\\alpha$ 的精确值。请将最终答案表示为精确分数。无需四舍五入。", "solution": "首先验证问题，以确保其是适定的、有科学依据且客观的。\n\n### 步骤1：提取给定条件\n给定的凸二次规划数据如下：\n-   目标函数：$f(\\mathbf{x}) = \\frac{1}{2}\\,\\mathbf{x}^{\\top}\\mathbf{Q}\\,\\mathbf{x} + \\mathbf{c}^{\\top}\\mathbf{x}$\n-   二次项的Hessian矩阵：$\\mathbf{Q} = \\begin{pmatrix} 4   2 \\\\ 2   2 \\end{pmatrix}$\n-   一次项向量：$\\mathbf{c} = \\begin{pmatrix} -2 \\\\ -6 \\end{pmatrix}$\n-   约束矩阵：$\\mathbf{A} = \\begin{pmatrix} 1   0 \\\\ 1   1 \\\\ -1  2 \\end{pmatrix}$\n-   约束界限向量：$\\mathbf{b} = \\begin{pmatrix} 2 \\\\ 2 \\\\ 2 \\end{pmatrix}$\n-   约束类型：$\\mathbf{A}\\mathbf{x} \\le \\mathbf{b}$\n-   初始可行点：$\\mathbf{x}^{(0)} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$\n-   初始工作集：$\\mathcal{W}^{(0)}$，由$\\mathbf{A}$的第二行给出的单个积极约束组成，因此工作集等式为 $\\mathbf{a}_{2}^{\\top}\\mathbf{x} = b_{2}$。\n\n### 步骤2：使用提取的给定条件进行验证\n1.  **科学或事实的可靠性**：该问题描述了一个标准的二次规划（QP）。为确保凸性，Hessian矩阵 $\\mathbf{Q}$ 必须是半正定的。$\\mathbf{Q}$ 的主子式为 $\\det(Q_{11}) = 4  0$ 和 $\\det(\\mathbf{Q}) = 4 \\times 2 - 2 \\times 2 = 8 - 4 = 4  0$。由于所有顺序主子式都为正，$\\mathbf{Q}$ 是正定的，这是一个更强的条件。具有正定Hessian矩阵的二次规划是严格凸的，保证存在唯一最小值。因此，该问题在数学上是可靠的。\n2.  **适定性**：问题是适定的。它为积极集方法的第一步迭代提供了所有必要的数据和明确的指令。目标和约束都得到了明确的定义。\n3.  **客观性**：语言精确且无偏见。\n4.  **完整性**：所有必需的矩阵、向量和初始状态都已提供。\n该问题被认为是有效的。\n\n### 步骤3：结论与行动\n问题是有效的。将提供完整的解答。\n\n### 解答\n任务是针对给定的二次规划问题，从点 $\\mathbf{x}^{(0)}$ 和指定的工作集 $\\mathcal{W}^{(0)}$ 开始，执行积极集方法的一次迭代。\n\n**1. 验证原始可行性并计算残差**\n首先，我们通过检查起始点 $\\mathbf{x}^{(0)} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 是否满足 $\\mathbf{A}\\mathbf{x}^{(0)} \\le \\mathbf{b}$ 来验证其可行性。\n$$\n\\mathbf{A}\\mathbf{x}^{(0)} = \\begin{pmatrix} 1   0 \\\\ 1   1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 0 \\cdot 1 \\\\ 1 \\cdot 1 + 1 \\cdot 1 \\\\ -1 \\cdot 1 + 2 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 1 \\end{pmatrix}\n$$\n我们将此结果与 $\\mathbf{b} = \\begin{pmatrix} 2 \\\\ 2 \\\\ 2 \\end{pmatrix}$ 进行比较。\n-   约束 1：$1 \\le 2$ (满足，非积极)\n-   约束 2：$2 \\le 2$ (满足，积极)\n-   约束 3：$1 \\le 2$ (满足，非积极)\n点 $\\mathbf{x}^{(0)}$ 是可行的。第二个约束是积极的，这与问题陈述中 $\\mathcal{W}^{(0)} = \\{2\\}$ 一致。\n\n残差 $r_i = b_i - \\mathbf{a}_{i}^{\\top}\\mathbf{x}^{(0)}$ 如下：\n-   $r_1 = b_1 - \\mathbf{a}_{1}^{\\top}\\mathbf{x}^{(0)} = 2 - 1 = 1$\n-   $r_2 = b_2 - \\mathbf{a}_{2}^{\\top}\\mathbf{x}^{(0)} = 2 - 2 = 0$\n-   $r_3 = b_3 - \\mathbf{a}_{3}^{\\top}\\mathbf{x}^{(0)} = 2 - 1 = 1$\n\n**2. 构建零空间基 $\\mathbf{Z}$**\n工作集 $\\mathcal{W}^{(0)} = \\{2\\}$ 定义了积极约束矩阵 $\\mathbf{A}_{\\mathcal{W}^{(0)}}$。这只是$\\mathbf{A}$的第二行：\n$$\n\\mathbf{A}_{\\mathcal{W}^{(0)}} = \\mathbf{a}_{2}^{\\top} = \\begin{pmatrix} 1  1 \\end{pmatrix}\n$$\n零空间基 $\\mathbf{Z}$ 是一个矩阵，其列张成 $\\mathbf{A}_{\\mathcal{W}^{(0)}}$ 的零空间。我们需要找到向量 $\\mathbf{z}$ 使得 $\\mathbf{A}_{\\mathcal{W}^{(0)}} \\mathbf{z} = \\mathbf{0}$。\n$$\n\\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix} = z_1 + z_2 = 0\n$$\n这意味着 $z_1 = -z_2$。零空间是一维的。这个零空间的一个基可以选择为：\n$$\n\\mathbf{Z} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}\n$$\n\n**3. 构建并求解缩减系统**\n搜索方向 $\\mathbf{p}$ 位于积极约束的零空间中，因此我们写作 $\\mathbf{p} = \\mathbf{Z}\\mathbf{d}$。向量 $\\mathbf{d}$ 通过求解缩减系统得到。首先，我们计算目标函数在 $\\mathbf{x}^{(0)}$ 处的梯度：\n$$\n\\mathbf{g} = \\mathbf{g}(\\mathbf{x}^{(0)}) = \\mathbf{Q}\\mathbf{x}^{(0)} + \\mathbf{c} = \\begin{pmatrix} 4   2 \\\\ 2   2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ -6 \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ 4 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ -6 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ -2 \\end{pmatrix}\n$$\n缩减系统为 $(\\mathbf{Z}^{\\top}\\mathbf{Q}\\mathbf{Z})\\mathbf{d} = -\\mathbf{Z}^{\\top}\\mathbf{g}$。我们计算其组成部分：\n-   缩减Hessian矩阵：\n$$\n\\mathbf{Z}^{\\top}\\mathbf{Q}\\mathbf{Z} = \\begin{pmatrix} -1  1 \\end{pmatrix} \\begin{pmatrix} 4   2 \\\\ 2   2 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -2  0 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = 2\n$$\n-   缩减梯度：\n$$\n\\mathbf{Z}^{\\top}\\mathbf{g} = \\begin{pmatrix} -1  1 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ -2 \\end{pmatrix} = -4 - 2 = -6\n$$\n在这种情况下，缩减系统是一个标量方程：\n$$\n2\\mathbf{d} = -(-6) = 6\n$$\n求解 $\\mathbf{d}$ 得到 $\\mathbf{d} = 3$。那么搜索方向 $\\mathbf{p}$ 是：\n$$\n\\mathbf{p} = \\mathbf{Z}\\mathbf{d} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} (3) = \\begin{pmatrix} -3 \\\\ 3 \\end{pmatrix}\n$$\n\n**4. 计算交点步长 $\\alpha$**\n下一个点由 $\\mathbf{x}(\\alpha) = \\mathbf{x}^{(0)} + \\alpha\\mathbf{p}$ 给出。我们需要找到能为非积极约束（$i=1$ 和 $i=3$）保持可行性的最大步长 $\\alpha  0$。如果 $\\mathbf{a}_{i}^{\\top}\\mathbf{x}(\\alpha) \\le b_i$，则约束 $i$ 保持可行。\n$$\n\\mathbf{a}_{i}^{\\top}(\\mathbf{x}^{(0)} + \\alpha\\mathbf{p}) \\le b_i \\implies \\mathbf{a}_{i}^{\\top}\\mathbf{x}^{(0)} + \\alpha(\\mathbf{a}_{i}^{\\top}\\mathbf{p}) \\le b_i \\implies \\alpha(\\mathbf{a}_{i}^{\\top}\\mathbf{p}) \\le b_i - \\mathbf{a}_{i}^{\\top}\\mathbf{x}^{(0)}\n$$\n我们只需要考虑那些 $\\mathbf{a}_{i}^{\\top}\\mathbf{p}  0$ 的约束，因为随着 $\\alpha$ 的增加，这些约束可能会变为积极约束。\n\n-   对于非积极约束 $i=1$：\n$$\n\\mathbf{a}_{1}^{\\top}\\mathbf{p} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} -3 \\\\ 3 \\end{pmatrix} = -3\n$$\n由于 $\\mathbf{a}_{1}^{\\top}\\mathbf{p}  0$，对于 $\\alpha  0$，此约束不会阻碍步长。\n\n-   对于非积极约束 $i=3$：\n$$\n\\mathbf{a}_{3}^{\\top}\\mathbf{p} = \\begin{pmatrix} -1  2 \\end{pmatrix} \\begin{pmatrix} -3 \\\\ 3 \\end{pmatrix} = (-1)(-3) + (2)(3) = 3 + 6 = 9\n$$\n由于 $\\mathbf{a}_{3}^{\\top}\\mathbf{p}  0$，此约束限制了步长。当不等式变为等式时，可以找到最大的 $\\alpha$：\n$$\n\\alpha = \\frac{b_3 - \\mathbf{a}_{3}^{\\top}\\mathbf{x}^{(0)}}{\\mathbf{a}_{3}^{\\top}\\mathbf{p}} = \\frac{r_3}{\\mathbf{a}_{3}^{\\top}\\mathbf{p}} = \\frac{1}{9}\n$$\n这个步长 $\\alpha=\\frac{1}{9}$ 是使得一个非积极约束变为积极的最小正步长，即交点步长。因此，下一个约束进入工作集时的步长 $\\alpha$ 是 $\\frac{1}{9}$。", "answer": "$$\n\\boxed{\\frac{1}{9}}\n$$", "id": "3198861"}, {"introduction": "掌握了单次迭代的机制后，是时候将这些步骤串联起来，观察完整的算法如何运作了。本练习 [@problem_id:3198849] 要求你从一个可行点出发，通过多次迭代，动态地更新工作集，最终找到一个带盒式约束的二次规划问题的最优解。通过这个过程，你将直观地看到解是如何沿着可行域的边界“行走”以逼近最优点的。", "problem": "考虑一个带箱式约束的二次规划 (QP) 问题，目标是最小化二次目标函数。设目标函数为 $f(x) = \\frac{1}{2} x^{\\top} Q x + c^{\\top} x$，其中\n$$\nQ = \\begin{pmatrix}\n2   -1 \\\\\n-1  2\n\\end{pmatrix}, \\quad\nc = \\begin{pmatrix}\n-5 \\\\\n2\n\\end{pmatrix},\n$$\n箱式约束为 $l \\le x \\le u$，其中\n$$\nl = \\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}, \\quad\nu = \\begin{pmatrix}\n1 \\\\\n1\n\\end{pmatrix}.\n$$\n从可行点\n$$\nx^{(0)} = \\begin{pmatrix}\n\\frac{1}{5} \\\\\n\\frac{4}{5}\n\\end{pmatrix}\n$$\n开始。\n使用 Wolfe 方法，将工作集 $W$ 中的活动边界视为等式，并从对应于自由变量的列构建零空间基 $Z$，执行以下步骤：\n\n1. 叙述箱式约束下的最优性 Karush–Kuhn–Tucker (KKT) 条件，并解释 Wolfe 的工作集方法如何通过将活动边界视为等式来强制满足这些条件。\n\n2. 在 $x^{(0)}$ 处，根据自由变量列构建初始工作集 $W^{(0)}$ 和零空间基 $Z^{(0)}$。通过求解简化系统计算梯度 $g^{(0)} = Q x^{(0)} + c$ 和 Wolfe 搜索方向 $p^{(0)}$\n$$\nZ^{(0)\\top} Q Z^{(0)} d^{(0)} = - Z^{(0)\\top} g^{(0)}, \\quad p^{(0)} = Z^{(0)} d^{(0)}.\n$$\n确定在保持 $l \\le x \\le u$ 可行性下的最大步长 $\\alpha^{(0)}$，识别哪个边界变为活动边界，并更新至 $x^{(1)} = x^{(0)} + \\alpha^{(0)} p^{(0)}$。\n\n3. 在 $x^{(1)}$ 处，更新工作集 $W^{(1)}$ 以包含刚刚触及的边界，从剩余的自由变量列构建新的零空间基 $Z^{(1)}$，并根据下式计算简化梯度搜索方向 $p^{(1)}$\n$$\nZ^{(1)\\top} Q Z^{(1)} d^{(1)} = - Z^{(1)\\top} g^{(1)}, \\quad g^{(1)} = Q x^{(1)} + c, \\quad p^{(1)} = Z^{(1)} d^{(1)}.\n$$\n确定到达下一个边界的步长 $\\alpha^{(1)}$，更新至 $x^{(2)} = x^{(1)} + \\alpha^{(1)} p^{(1)}$，并报告观察到的交替触及边界的情况。\n\n4. 在 $x^{(2)}$ 处，验证活动边界的梯度分量的 KKT 符号条件，并论证该凸 QP 问题的最优性。\n\n最后，计算最优目标值 $f(x^{(2)})$ 的精确数值。仅提供此单个数字作为您的最终答案。", "solution": "该问题是一个二次规划 (QP) 练习，涉及在箱式约束下最小化一个凸二次函数。目标函数为 $f(x) = \\frac{1}{2} x^{\\top} Q x + c^{\\top} x$，其中 $x \\in \\mathbb{R}^2$。给定数据如下：\n$$\nQ = \\begin{pmatrix}\n2   -1 \\\\\n-1  2\n\\end{pmatrix}, \\quad\nc = \\begin{pmatrix}\n-5 \\\\\n2\n\\end{pmatrix}, \\quad\nl = \\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}, \\quad\nu = \\begin{pmatrix}\n1 \\\\\n1\n\\end{pmatrix}.\n$$\n起始点为 $x^{(0)} = \\begin{pmatrix} \\frac{1}{5} \\\\ \\frac{4}{5} \\end{pmatrix}$，该点是可行的，因为 $l \\le x^{(0)} \\le u$。矩阵 $Q$ 是对称正定的（其特征值为 1 和 3），因此该 QP 是严格凸的，并有唯一的全局最小值。我们将应用 Wolfe 的活动集方法来找到这个最小值。\n\n首先，我们陈述最优性的 Karush–Kuhn–Tucker (KKT) 条件。问题是 $\\min f(x)$，约束条件为 $l - x \\le 0$ 和 $x - u \\le 0$。拉格朗日函数为 $\\mathcal{L}(x, \\lambda, \\mu) = f(x) + \\lambda^{\\top}(l-x) + \\mu^{\\top}(x-u)$，其中 $\\lambda \\ge 0$ 和 $\\mu \\ge 0$ 是拉格朗日乘子。KKT 条件是：\n1. 稳定性条件：$\\nabla f(x) - \\lambda + \\mu = 0$，即 $g(x) = \\lambda - \\mu$，其中 $g(x) = Qx+c$ 是 $f(x)$ 的梯度。\n2. 原始可行性：$l \\le x \\le u$。\n3. 对偶可行性：$\\lambda \\ge 0, \\mu \\ge 0$。\n4. 互补松弛性：对于每个分量 $i$，有 $\\lambda_i(l_i - x_i) = 0$ 和 $\\mu_i(x_i - u_i) = 0$。\n\n这些条件在最优点 $x^*$ 处意味着以下特定关系：\n- 如果 $l_i  x_i^*  u_i$，则 $\\lambda_i=\\mu_i=0$，所以 $g_i(x^*) = 0$。\n- 如果 $x_i^* = l_i$，则 $\\mu_i=0$，所以 $g_i(x^*) = \\lambda_i \\ge 0$。\n- 如果 $x_i^* = u_i$，则 $\\lambda_i=0$，所以 $g_i(x^*) = -\\mu_i \\le 0$。\n\nWolfe 方法迭代地强制满足这些条件。它维护一个工作集 $W$，其中包含保持在其边界上的变量的索引。这些被视为等式约束。搜索方向 $p$ 在剩余自由变量的子空间中计算。\n搜索方向 $p$ 必须是活动约束的可行方向，即对于所有 $i \\in W$，有 $p_i = 0$。向量 $p$ 被划分为对应于固定变量和自由变量的分量。求解自由变量的子问题以找到下降方向。当沿着 $p$ 的一步导致新的约束变为活动约束时，该约束的索引被添加到 $W$ 中。如果无法进行移动（即子问题的解是零向量），则检查拉格朗日乘子的符号（从梯度推断）。如果它们不正确（例如，对于处于下界的变量，$g_i  0$），则从 $W$ 中移除相应的约束，然后继续该过程。当工作集中的所有变量的梯度分量都满足 KKT 符号条件，且自由变量的简化梯度为零时，即达到最优性。\n\n现在，我们从 $x^{(0)} = \\begin{pmatrix} \\frac{1}{5} \\\\ \\frac{4}{5} \\end{pmatrix}$ 开始进行第一次迭代。\n在 $x^{(0)}$ 处，没有变量处于其边界上。工作集为空：$W^{(0)} = \\emptyset$。两个变量都是自由的。跨越自由变量子空间的零空间基 $Z^{(0)}$ 是单位矩阵 $Z^{(0)} = I = \\begin{pmatrix} 1   0 \\\\ 0   1 \\end{pmatrix}$。\n在 $x^{(0)}$ 处的梯度是：\n$$\ng^{(0)} = Q x^{(0)} + c = \\begin{pmatrix} 2   -1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{5} \\\\ \\frac{4}{5} \\end{pmatrix} + \\begin{pmatrix} -5 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{5} - \\frac{4}{5} \\\\ -\\frac{1}{5} + \\frac{8}{5} \\end{pmatrix} + \\begin{pmatrix} -5 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -\\frac{2}{5} \\\\ \\frac{7}{5} \\end{pmatrix} + \\begin{pmatrix} -5 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -\\frac{27}{5} \\\\ \\frac{17}{5} \\end{pmatrix}.\n$$\n简化系统为 $Z^{(0)\\top} Q Z^{(0)} d^{(0)} = - Z^{(0)\\top} g^{(0)}$。由于 $Z^{(0)}=I$，这简化为 $Q d^{(0)} = -g^{(0)}$，搜索方向为 $p^{(0)} = Z^{(0)}d^{(0)} = d^{(0)}$。\n$Q$ 的逆是 $Q^{-1} = \\frac{1}{3} \\begin{pmatrix} 2   1 \\\\ 1   2 \\end{pmatrix}$。\n所以，$p^{(0)} = -Q^{-1}g^{(0)} = -\\frac{1}{3} \\begin{pmatrix} 2   1 \\\\ 1   2 \\end{pmatrix} \\begin{pmatrix} -\\frac{27}{5} \\\\ \\frac{17}{5} \\end{pmatrix} = -\\frac{1}{3} \\begin{pmatrix} -\\frac{54}{5} + \\frac{17}{5} \\\\ -\\frac{27}{5} + \\frac{34}{5} \\end{pmatrix} = -\\frac{1}{3} \\begin{pmatrix} -\\frac{37}{5} \\\\ \\frac{7}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{37}{15} \\\\ -\\frac{7}{15} \\end{pmatrix}$。\n我们寻找最大步长 $\\alpha^{(0)} \\ge 0$，使得 $l \\le x^{(0)} + \\alpha^{(0)} p^{(0)} \\le u$。\n$$\n\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\le \\begin{pmatrix} \\frac{1}{5} \\\\ \\frac{4}{5} \\end{pmatrix} + \\alpha^{(0)} \\begin{pmatrix} \\frac{37}{15} \\\\ -\\frac{7}{15} \\end{pmatrix} \\le \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\n对于 $x_1$：$\\frac{1}{5} + \\alpha^{(0)} \\frac{37}{15} \\le 1 \\implies \\alpha^{(0)} \\frac{37}{15} \\le \\frac{4}{5} \\implies \\alpha^{(0)} \\le \\frac{4}{5} \\cdot \\frac{15}{37} = \\frac{12}{37}$。\n对于 $x_2$：$0 \\le \\frac{4}{5} - \\alpha^{(0)} \\frac{7}{15} \\implies \\alpha^{(0)} \\frac{7}{15} \\le \\frac{4}{5} \\implies \\alpha^{(0)} \\le \\frac{4}{5} \\cdot \\frac{15}{7} = \\frac{12}{7}$。\n最大可行步长是 $\\alpha^{(0)} = \\min(\\frac{12}{37}, \\frac{12}{7}) = \\frac{12}{37}$。在这个步长下，第一个分量 $x_1$ 达到了其上界 1。\n下一个迭代点是 $x^{(1)} = x^{(0)} + \\alpha^{(0)} p^{(0)}$：\n$$\nx^{(1)} = \\begin{pmatrix} \\frac{1}{5} \\\\ \\frac{4}{5} \\end{pmatrix} + \\frac{12}{37} \\begin{pmatrix} \\frac{37}{15} \\\\ -\\frac{7}{15} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{5} + \\frac{12}{15} \\\\ \\frac{4}{5} - \\frac{12 \\cdot 7}{37 \\cdot 15} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{15} + \\frac{12}{15} \\\\ \\frac{4}{5} - \\frac{28}{185} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{148-28}{185} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{120}{185} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{24}{37} \\end{pmatrix}.\n$$\n\n对于第二次迭代，我们在 $x^{(1)} = \\begin{pmatrix} 1 \\\\ \\frac{24}{37} \\end{pmatrix}$。\n变量 $x_1$ 处于其上界，所以我们更新工作集为 $W^{(1)} = \\{1\\}$。自由变量是 $x_2$。零空间基 $Z^{(1)}$ 由一个单独的向量组成，该向量的第一个分量为零，第二个分量为一，对应于自由变量：$Z^{(1)} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n在 $x^{(1)}$ 处的梯度是：\n$$\ng^{(1)} = Q x^{(1)} + c = \\begin{pmatrix} 2   -1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\frac{24}{37} \\end{pmatrix} + \\begin{pmatrix} -5 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 2 - \\frac{24}{37} \\\\ -1 + \\frac{48}{37} \\end{pmatrix} + \\begin{pmatrix} -5 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{50}{37} \\\\ \\frac{11}{37} \\end{pmatrix} + \\begin{pmatrix} -\\frac{185}{37} \\\\ \\frac{74}{37} \\end{pmatrix} = \\begin{pmatrix} -\\frac{135}{37} \\\\ \\frac{85}{37} \\end{pmatrix}.\n$$\n简化系统是 $Z^{(1)\\top} Q Z^{(1)} d^{(1)} = - Z^{(1)\\top} g^{(1)}$。\n$Z^{(1)\\top} Q Z^{(1)} = \\begin{pmatrix} 0   1 \\end{pmatrix} \\begin{pmatrix} 2   -1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = 2$。\n$-Z^{(1)\\top} g^{(1)} = -\\begin{pmatrix} 0   1 \\end{pmatrix} \\begin{pmatrix} -\\frac{135}{37} \\\\ \\frac{85}{37} \\end{pmatrix} = -\\frac{85}{37}$。\n所以，$2 d^{(1)} = -\\frac{85}{37}$，这给出 $d^{(1)} = -\\frac{85}{74}$。\n搜索方向是 $p^{(1)} = Z^{(1)} d^{(1)} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} (-\\frac{85}{74}) = \\begin{pmatrix} 0 \\\\ -\\frac{85}{74} \\end{pmatrix}$。\n我们寻找最大步长 $\\alpha^{(1)} \\ge 0$。第一个分量不变。对于第二个分量：\n$$\n0 \\le x_2^{(1)} + \\alpha^{(1)} p_2^{(1)} \\le 1 \\implies 0 \\le \\frac{24}{37} + \\alpha^{(1)} (-\\frac{85}{74}) \\le 1.\n$$\n由于 $p_2^{(1)}  0$，上界没有限制。下界给出： $\\alpha^{(1)} \\frac{85}{74} \\le \\frac{24}{37} \\implies \\alpha^{(1)} \\le \\frac{24}{37} \\cdot \\frac{74}{85} = \\frac{24 \\cdot 2}{85} = \\frac{48}{85}$。\n最大步长是 $\\alpha^{(1)} = \\frac{48}{85}$。在这一步，$x_2$ 达到了其下界 0。更新为：\n$$\nx^{(2)} = x^{(1)} + \\alpha^{(1)} p^{(1)} = \\begin{pmatrix} 1 \\\\ \\frac{24}{37} \\end{pmatrix} + \\frac{48}{85} \\begin{pmatrix} 0 \\\\ -\\frac{85}{74} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{24}{37} - \\frac{48}{74} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{24}{37} - \\frac{24}{37} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n该过程展示了交替触及边界的情况：首先，$x_1$ 达到了其上界，然后 $x_2$ 达到了其下界。\n\n最后，我们在 $x^{(2)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 处验证最优性。\n两个变量现在都处于边界上：$x_1=1$（上界）和 $x_2=0$（下界）。工作集是 $W^{(2)} = \\{1, 2\\}$，没有自由变量。零空间是平凡的，所以不可能有进一步的移动。我们必须检查 KKT 符号条件。\n在 $x^{(2)}$ 处的梯度是：\n$$\ng^{(2)} = Q x^{(2)} + c = \\begin{pmatrix} 2   -1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} -5 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} + \\begin{pmatrix} -5 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 1 \\end{pmatrix}.\n$$\n对于 $x_1 = 1$（在其上界），KKT 条件是 $g_1(x^{(2)}) \\le 0$。我们有 $g_1^{(2)}=-3$，满足该条件。\n对于 $x_2 = 0$（在其下界），KKT 条件是 $g_2(x^{(2)}) \\ge 0$。我们有 $g_2^{(2)}=1$，满足该条件。\n所有 KKT 条件都已满足。由于问题是严格凸的，$x^{(2)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 是唯一的全局最优解。\n\n最优目标值为 $f(x^{(2)})$：\n$$\nf(x^{(2)}) = \\frac{1}{2} x^{(2)\\top} Q x^{(2)} + c^{\\top} x^{(2)} = \\frac{1}{2} \\begin{pmatrix} 1   0 \\end{pmatrix} \\begin{pmatrix} 2   -1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} -5   2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\nf(x^{(2)}) = \\frac{1}{2} \\begin{pmatrix} 1   0 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} + (-5) = \\frac{1}{2}(2) - 5 = 1 - 5 = -4.\n$$", "answer": "$$\\boxed{-4}$$", "id": "3198849"}, {"introduction": "理想化的练习是学习的起点，但实际问题往往更加复杂。这个练习 [@problem_id:3198856] 引入了一种在积极集方法中常见的“退化”情况：当工作集中的约束是线性相关时，KKT子问题将变得不适定。你将需要利用线性代数的基本原理来识别并“修剪”冗余的约束，以确保算法能够继续进行。这个练习将加深你对算法背后数学要求的理解。", "problem": "考虑一个二次规划（QP）问题，该问题在 Wolfe 方法（有效集法）的框架下，目标是最小化一个受线性不等式约束的二次目标函数。目标函数为\n$$\n\\min_{x \\in \\mathbb{R}^{2}} \\;\\; \\frac{1}{2}\\, x^{\\top} H x + c^{\\top} x,\n$$\n其中\n$$\nH = \\begin{pmatrix} 2   0 \\\\ 0   2 \\end{pmatrix}, \\qquad c = \\begin{pmatrix} -4 \\\\ -2 \\end{pmatrix}.\n$$\n不等式约束汇总如下\n$$\nA x \\ge b, \\quad \\text{其中} \\quad\nA = \\begin{pmatrix}\n1   1 \\\\\n1   -1 \\\\\n2   2\n\\end{pmatrix}, \\qquad\nb = \\begin{pmatrix}\n3 \\\\\n1 \\\\\n6\n\\end{pmatrix}.\n$$\n假设在某个可行迭代点 $x^{(k)}$，Wolfe 方法当前使用的有效集为 $W = \\{1,2,3\\}$，因此有效约束矩阵和右端项为\n$$\nA_{W} = \\begin{pmatrix}\n1   1 \\\\\n1   -1 \\\\\n2   2\n\\end{pmatrix}, \\qquad b_{W} = \\begin{pmatrix} 3 \\\\ 1 \\\\ 6 \\end{pmatrix}.\n$$\n从秩的基本定义和等式约束子问题的 Karush–Kuhn–Tucker (KKT) 一阶条件出发，完成以下任务：\n\n1. 判断 $A_{W}$ 是否秩亏。如果是，则从 $W$ 中删减约束，直到剩余的有效集满足 $\\operatorname{rank}(A_{W}) = |W|$，并利用行向量之间的线性相关性来解释你的选择。\n\n2. 使用删减后的有效集，建立并求解等式约束的 KKT 系统，以获得相应等式约束子问题的唯一最小化子。\n\n在该最小化子处，目标函数的精确值是多少？请提供精确值，不要四舍五入。", "solution": "该问题是有效的，因为它是自洽的，科学上基于二次规划理论，并且问题陈述清晰明确。\n\n我们被要求为一个给定的二次规划（QP）问题分析 Wolfe 方法中的一个特定状态。需要最小化的目标函数是 $f(x) = \\frac{1}{2} x^{\\top} H x + c^{\\top} x$，其中 $x \\in \\mathbb{R}^{2}$，矩阵给定如下：\n$$\nH = \\begin{pmatrix} 2   0 \\\\ 0   2 \\end{pmatrix}, \\qquad c = \\begin{pmatrix} -4 \\\\ -2 \\end{pmatrix}\n$$\n线性不等式约束为 $A x \\ge b$，其中：\n$$\nA = \\begin{pmatrix}\n1   1 \\\\\n1   -1 \\\\\n2   2\n\\end{pmatrix}, \\qquad\nb = \\begin{pmatrix}\n3 \\\\\n1 \\\\\n6\n\\end{pmatrix}\n$$\n在当前迭代点，有效约束集为 $W = \\{1, 2, 3\\}$。相应的有效约束矩阵和右端向量为：\n$$\nA_{W} = \\begin{pmatrix}\n1   1 \\\\\n1   -1 \\\\\n2   2\n\\end{pmatrix}, \\qquad b_{W} = \\begin{pmatrix} 3 \\\\ 1 \\\\ 6 \\end{pmatrix}\n$$\n有效集中的约束数量为 $|W|=3$。\n\n**第一部分：秩亏性和有效集的删减**\n\n首先，我们必须确定有效约束矩阵 $A_{W}$ 是否秩亏。在有效集法的背景下，这通常意味着检查 $A_{W}$ 的行向量是否线性无关。为了使 KKT 子问题良定义且具有唯一的拉格朗日乘子向量，要求有效约束矩阵的行向量是线性无关的。这等价于 $A_W^\\top$ 的列向量线性无关，意味着有效约束的数量不能超过变量的数量，即 $|W| \\le n$。当 $|W|  n$ 时，行向量必然线性相关。这里 $|W|=3$ 且 $n=2$，因此行向量必然是线性相关的。\n\n记 $A_W$ 的行向量为 $r_1, r_2, r_3$：\n$$\nr_1 = \\begin{pmatrix} 1  1 \\end{pmatrix} \\\\\nr_2 = \\begin{pmatrix} 1  -1 \\end{pmatrix} \\\\\nr_3 = \\begin{pmatrix} 2  2 \\end{pmatrix}\n$$\n我们可以观察到这些行向量之间存在线性相关性。具体来说，行向量 $r_3$ 是行向量 $r_1$ 的标量倍：\n$$\nr_3 = 2 \\cdot r_1 \\quad \\text{因为} \\quad \\begin{pmatrix} 2  2 \\end{pmatrix} = 2 \\cdot \\begin{pmatrix} 1  1 \\end{pmatrix}\n$$\n这证实了 $A_W$ 的行向量是线性相关的。$A_W$ 的秩是线性无关行向量的数量。由于 $r_1$ 和 $r_2$ 不平行（即，不是彼此的标量倍），它们是线性无关的。因此，$A_W$ 的秩为 2。\n我们有 $\\operatorname{rank}(A_{W}) = 2$ 且 $|W|=3$。条件 $\\operatorname{rank}(A_{W}) = |W|$ 未被满足。\n\n为了解决这个问题，我们必须通过移除约束来删减有效集 $W$，直到新的有效约束矩阵的行向量线性无关。线性相关关系是 $r_3 - 2r_1 = 0$，这涉及到约束 1 和 3。移除约束 1 或 3 都可以打破这种特定的相关性。我们选择从有效集 $W$ 中移除约束 3。新的、删减后的有效集是 $W' = \\{1, 2\\}$。\n\n相应的有效约束矩阵和右端项为：\n$$\nA_{W'} = \\begin{pmatrix}\n1   1 \\\\\n1   -1\n\\end{pmatrix}, \\qquad b_{W'} = \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}\n$$\n这个新有效集中的约束数量是 $|W'| = 2$。$A_{W'}$ 的行向量是 $r_1 = \\begin{pmatrix} 1   1 \\end{pmatrix}$ 和 $r_2 = \\begin{pmatrix} 1   -1 \\end{pmatrix}$。为了检查线性无关性，我们计算 $A_{W'}$ 的行列式：\n$$\n\\det(A_{W'}) = (1)(-1) - (1)(1) = -1 - 1 = -2\n$$\n由于 $\\det(A_{W'}) \\neq 0$，行向量是线性无关的。因此，$\\operatorname{rank}(A_{W'}) = 2$。\n条件 $\\operatorname{rank}(A_{W'}) = |W'|$ 现在得到满足，因为 $2=2$。\n\n**第二部分：求解等式约束的 KKT 子问题**\n\n利用删减后的有效集 $W'$，我们现在求解等式约束子问题：\n$$\n\\min_{x \\in \\mathbb{R}^{2}} \\;\\; \\frac{1}{2}\\, x^{\\top} H x + c^{\\top} x \\quad \\text{满足} \\quad A_{W'} x = b_{W'}\n$$\n该子问题的 Karush–Kuhn–Tucker (KKT) 条件表明，必须存在一个拉格朗日乘子向量 $\\lambda \\in \\mathbb{R}^{2}$，使得：\n$$\n\\nabla_x \\left(\\frac{1}{2}\\, x^{\\top} H x + c^{\\top} x - \\lambda^{\\top} (A_{W'}x - b_{W'}) \\right)= 0\n$$\n$$\nA_{W'} x = b_{W'}\n$$\n第一个条件简化为 $H x + c - A_{W'}^{\\top} \\lambda = 0$。由于在此情况下，有效约束的数量等于变量的数量（$|W'|=n=2$），点 $x$ 完全由等式约束 $A_{W'} x = b_{W'}$ 确定。因此，我们可以直接求解该线性系统来找到最小化子 $x$。\n\n求解最小化子 $x$ 的相关部分是等式约束本身：\n$$\nA_{W'} x = b_{W'} \\implies \\begin{pmatrix} 1   1 \\\\ 1   -1 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}\n$$\n这代表了方程组：\n1. $x_1 + x_2 = 3$\n2. $x_1 - x_2 = 1$\n\n将两个方程相加得到 $2x_1 = 4$，因此 $x_1 = 2$。\n将 $x_1=2$ 代入第一个方程得到 $2 + x_2 = 3$，因此 $x_2 = 1$。\n该等式约束子问题的唯一最小化子是 $x = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$。\n\n**最终计算：目标函数值**\n\n最后一步是计算目标函数 $f(x)$ 在这个最小化子 $x = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$ 处的值。\n目标函数为 $f(x) = \\frac{1}{2} x^{\\top} H x + c^{\\top} x$。我们来分别计算每一项：\n二次项为：\n$$\n\\frac{1}{2} x^{\\top} H x = \\frac{1}{2} \\begin{pmatrix} 2  1 \\end{pmatrix} \\begin{pmatrix} 2   0 \\\\ 0   2 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 4  2 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\frac{1}{2} ((4)(2) + (2)(1)) = \\frac{1}{2} (8 + 2) = \\frac{1}{2} (10) = 5\n$$\n线性项为：\n$$\nc^{\\top} x = \\begin{pmatrix} -4  -2 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = (-4)(2) + (-2)(1) = -8 - 2 = -10\n$$\n目标函数的总值是这两项之和：\n$$\nf\\left(\\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}\\right) = 5 + (-10) = -5\n$$\n在该最小化子处，目标函数的精确值为 $-5$。", "answer": "$$ \\boxed{-5} $$", "id": "3198856"}]}