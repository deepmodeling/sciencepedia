{"hands_on_practices": [{"introduction": "要掌握主动集方法，最好的起点是剖析其单次迭代的内部工作原理。本练习将引导你完成主动集方法的单个、完整的一步：从一个可行点出发，计算改进目标函数的搜索方向，确定在不违反任何约束条件下的最大步长，并更新工作集和相关的拉格朗日乘子。通过这个具体的计算过程 [@problem_id:3094761]，你将对算法的核心机制——如何在约束边界之间移动以寻找最优解——建立起坚实的直观理解。", "problem": "考虑一个包含两个变量的二次规划 (QP) 问题，其目标函数为 $f(x)=\\tfrac{1}{2} x^{\\top} Q x$，线性不等式约束为 $A x \\le b$，其中 $Q \\in \\mathbb{R}^{2 \\times 2}$，$A \\in \\mathbb{R}^{2 \\times 2}$，$b \\in \\mathbb{R}^{2}$。令 $Q=I_{2}$，$A=-I_{2}$，以及 $b=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。因此，可行域为 $\\{x \\in \\mathbb{R}^{2} : x \\ge 0\\}$，且 $f$ 的无约束最小化子是 $x=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。\n\n你将从可行点 $x^{0}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$ 和初始工作集 $W^{0}=\\varnothing$ 开始，执行一次主动集法的迭代。对于由 $W^{0}$ 定义的等式约束子问题，计算搜索方向 $p^{0}$，它在 $W^{0}$ 的约束下最小化 $f$。然后，沿射线 $x(\\alpha)=x^{0}+\\alpha p^{0}$ 应用标准的保持可行性的步长接受准则，以确定使 $A x(\\alpha) \\le b$ 成立的最大可接受步长 $\\alpha^{\\star}$。在采用可接受步长更新到 $x^{1}=x^{0}+\\alpha^{\\star} p^{0}$ 并通过包含在 $x^{1}$ 处变为主动的所有约束来更新工作集之后，使用约束二次最小化的最优性条件，计算与 $x^{1}$ 处的主动约束相关联的拉格朗日乘子。\n\n仅使用可行性、驻定性和互补性的基本定义，以及主动集法的逻辑，确定可接受的步长 $\\alpha^{\\star}$ 以及在所得点处与两个约束相关联的乘子 $\\lambda_{1}^{\\star}$ 和 $\\lambda_{2}^{\\star}$。将你的最终答案表示为一个行矩阵，其元素为 $\\alpha^{\\star}$、$\\lambda_{1}^{\\star}$ 和 $\\lambda_{2}^{\\star}$。无需四舍五入。", "solution": "该问题是一个二次规划 (QP) 问题，定义如下：\n$$\n\\text{minimize} \\quad f(x) = \\frac{1}{2} x^{\\top} Q x \\\\\n\\text{subject to} \\quad A x \\le b\n$$\n其中 $x \\in \\mathbb{R}^{2}$。给定的参数是海森矩阵 $Q = I_{2} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$，约束矩阵 $A = -I_{2} = \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix}$，以及向量 $b = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n目标函数可以写作 $f(x_1, x_2) = \\frac{1}{2} (x_1^2 + x_2^2)$。目标函数的梯度为 $\\nabla f(x) = Qx = I_{2}x = x$。\n约束 $A x \\le b$ 等价于 $-I_{2}x \\le 0$，可简化为 $-x \\le 0$ 或 $x \\ge 0$。这可以写成两个独立的线性不等式约束：\n$c_1(x): -x_1 \\le 0$\n$c_2(x): -x_2 \\le 0$\n矩阵 $A$ 的行是 $a_1^{\\top} = \\begin{pmatrix} -1  0 \\end{pmatrix}$ 和 $a_2^{\\top} = \\begin{pmatrix} 0  -1 \\end{pmatrix}$。\n\n我们从可行点 $x^{0}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$ 和初始工作集 $W^{0}=\\varnothing$ 开始，执行一次主动集法的迭代。在 $x^0$ 点，我们有 $c_1(x^0) = -1  0$ 和 $c_2(x^0) = -1  0$，这证实了没有约束是主动的，且 $W^0$ 的选择是一致的。\n\n首先，我们通过求解当前工作集 $W^0$ 定义的等式约束子问题来计算搜索方向 $p^0$。我们寻找一个步长 $p$，它在 $W^0$ 中的约束处于主动状态（即对所有 $i \\in W^0$ 都有 $a_i^{\\top} p = 0$）的条件下，最小化 $f(x^0+p)$。\n由于 $W^0 = \\varnothing$，因此对 $p$ 没有约束。该子问题是 $f(x^0+p) = \\frac{1}{2}(x^0+p)^{\\top}Q(x^0+p)$ 的无约束最小化。关于 $p$ 的目标函数是 $\\frac{1}{2}p^{\\top}Qp + (Qx^0)^{\\top}p + \\text{const}$。\n通过将关于 $p$ 的梯度设为零，可以找到最优步长 $p^0$：\n$$\n\\nabla_p f(x^0+p) \\Big|_{p=p^0} = Q p^0 + Q x^0 = 0\n$$\n这给出了线性系统 $Q p^0 = -Q x^0$。代入给定的矩阵 $Q=I_2$：\n$$\nI_2 p^0 = -I_2 x^0 \\implies p^0 = -x^0\n$$\n对于 $x^0 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，搜索方向为 $p^0 = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}$。\n\n接下来，我们确定保持可行性的最大步长 $\\alpha^{\\star}$。新的点是 $x(\\alpha) = x^0 + \\alpha p^0$。我们要求 $x(\\alpha)$ 满足所有不在工作集中的约束，即对于 $i \\in \\{1, 2\\}$，有 $a_i^{\\top}(x^0 + \\alpha p^0) \\le b_i$。由于两个约束的 $b_i$ 均为 0，所以这是 $a_i^{\\top}x^0 + \\alpha a_i^{\\top}p^0 \\le 0$。\n要使约束 $i$ 变为主动约束，我们必须朝其边界移动。当 $a_i^{\\top} p^0  0$ 时会发生这种情况。使约束 $i$ 变为主动的步长由 $\\alpha_i = \\frac{b_i-a_i^{\\top}x^0}{a_i^{\\top}p^0} = \\frac{-a_i^{\\top}x^0}{a_i^{\\top}p^0}$ 给出。\n\n对于约束 1：$a_1^{\\top} = \\begin{pmatrix} -1  0 \\end{pmatrix}$。\n$a_1^{\\top}p^0 = \\begin{pmatrix} -1  0 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} = 1  0$。\n到达此约束边界的步长是 $\\alpha_1 = \\frac{-a_1^{\\top}x^0}{a_1^{\\top}p^0} = \\frac{-(-1)}{1} = 1$。\n\n对于约束 2：$a_2^{\\top} = \\begin{pmatrix} 0  -1 \\end{pmatrix}$。\n$a_2^{\\top}p^0 = \\begin{pmatrix} 0  -1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} = 1  0$。\n到达此约束边界的步长是 $\\alpha_2 = \\frac{-a_2^{\\top}x^0}{a_2^{\\top}p^0} = \\frac{-(-1)}{1} = 1$。\n\n在违反任何约束之前的最大步长是 $\\alpha_{max} = \\min\\{\\alpha_1, \\alpha_2\\} = \\min\\{1, 1\\} = 1$。\n到达无约束子问题最小化子的步长为 $1$，因为 $x^0 + 1 \\cdot p^0 = x^0 - x^0 = 0$。\n可接受的步长 $\\alpha^{\\star}$ 是到达子问题最小化子的步长与最大可行步长中的较小者：$\\alpha^{\\star} = \\min(1, \\alpha_{max}) = \\min(1, 1) = 1$。\n\n新的迭代点是 $x^1 = x^0 + \\alpha^{\\star} p^0$：\n$$\nx^1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + 1 \\cdot \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n在 $x^1$ 点，两个约束都是主动的：\n$c_1(x^1) = -x_1^1 = 0$\n$c_2(x^1) = -x_2^1 = 0$\n由于步长受限于约束 1 和 2，新的工作集更新为包含它们的索引：$W^1 = \\{1, 2\\}$。\n\n最后，我们计算与 $x^1$ 处主动约束相关的拉格朗日乘子 $\\lambda^{\\star} = \\begin{pmatrix} \\lambda_1^{\\star} \\\\ \\lambda_2^{\\star} \\end{pmatrix}$。原始 QP 问题的一阶最优性（驻定性）条件指出，在约束最小化子处，目标函数的梯度必须是主动约束梯度的线性组合：\n$$\n\\nabla f(x^1) + \\sum_{i \\in W^1} \\lambda_i^{\\star} \\nabla c_i (x^1) = 0\n$$\n目标函数在 $x^1 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 处的梯度为 $\\nabla f(x^1) = x^1 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n约束的梯度是常数向量：$\\nabla c_1(x) = a_1 = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}$ 和 $\\nabla c_2(x) = a_2 = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}$。\n驻定性条件变为：\n$$\n\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\lambda_1^{\\star} \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} + \\lambda_2^{\\star} \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这等价于线性系统：\n$$\n\\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} \\lambda_1^{\\star} \\\\ \\lambda_2^{\\star} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n该系统有唯一解 $\\lambda_1^{\\star} = 0$ 和 $\\lambda_2^{\\star} = 0$。\n\n单次迭代的结果是：可接受的步长 $\\alpha^{\\star} = 1$，以及拉格朗日乘子 $\\lambda_1^{\\star} = 0$ 和 $\\lambda_2^{\\star} = 0$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  0  0 \\end{pmatrix}}\n$$", "id": "3094761"}, {"introduction": "主动集方法（或称“第二阶段”方法）的一个关键前提是需要从一个可行点开始。然而，在实际问题中，找到这样一个初始可行点本身就是一个挑战。本练习 [@problem_id:3094700] 聚焦于解决这一问题的“第一阶段”过程，它通过最小化约束的不可行性来系统地寻找一个可行解。通过一个初始工作集被特意设置为不可行的例子，你将实践如何应用主动集思想来达到可行性，而不是优化原始目标函数。", "problem": "考虑以下关于两个变量 $x \\in \\mathbb{R}^{2}$ 的二次规划 (QP) 问题：\n最小化二次目标\n$$\nq(x) \\;=\\; \\frac{1}{2}\\,x^{\\top}H\\,x \\;+\\; c^{\\top}x,\n$$\n其中 $H \\in \\mathbb{R}^{2 \\times 2}$ 和 $c \\in \\mathbb{R}^{2}$ 由下式给出\n$$\nH \\;=\\; \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}, \n\\qquad\nc \\;=\\; \\begin{pmatrix} -2 \\\\ -3 \\end{pmatrix},\n$$\n服从于由下式指定的多面体不等式约束 $A x \\leq b$\n$$\n\\begin{aligned}\n\\text{约束 } C_{1}:  -x_{1} \\;\\leq\\; 0 \\quad\\text{(等价于 $x_{1} \\geq 0$)}, \\\\\n\\text{约束 } C_{2}:  x_{1} \\;\\leq\\; 2, \\\\\n\\text{约束 } C_{3}:  x_{1} \\;\\leq\\; 1, \\\\\n\\text{约束 } C_{4}:  -x_{2} \\;\\leq\\; 0 \\quad\\text{(等价于 $x_{2} \\geq 0$)}, \\\\\n\\text{约束 } C_{5}:  x_{2} \\;\\leq\\; 3.\n\\end{aligned}\n$$\n这些约束的可行集非空。\n\n您将为二次规划 (QP) 运行主动集法的第一可行性阶段，初始工作集（当前强制作为等式处理的主动不等式集合）选为\n$$\nW_{0} \\;=\\; \\{\\, C_{1},\\, C_{2},\\, C_{3},\\, C_{4} \\,\\},\n$$\n该工作集是不可行的，因为它要求 $x_{1}$ 同时满足 $x_{1} = 0$、$x_{1} = 2$ 和 $x_{1} = 1$，以及 $x_{2} = 0$。\n\n对于第一阶段，使用标准的最小二乘辅助子问题，通过在迭代 $k$ 求解以下问题来减少当前工作集的不可行性\n$$\n\\min_{x \\in \\mathbb{R}^{2}} \\;\\frac{1}{2}\\,\\|A_{W_{k}}\\,x \\;-\\; b_{W_{k}}\\|^{2},\n$$\n其中 $A_{W_{k}}$ 和 $b_{W_{k}}$ 汇集了对应于 $W_{k}$ 中约束的 $A$ 的行和 $b$ 的条目，在步骤结束时解释为等式 $A_{W_{k}}x = b_{W_{k}}$。使用基于拉格朗日乘子符号的标准主动集交换规则：如果与 $W_{k}$ 中任何主动不等式相关的乘子为负，则从 $W_{k}$ 中移除具有最负乘子的约束；否则，如果不存在这样的负乘子，则继续添加一个变为主动的阻塞约束。\n\n执行第一阶段，直到找到对所有五个不等式都可行的点，并记录工作集序列和最小二乘解。您的最终答案必须是第一阶段执行的总交换次数。请以单个整数形式提供您的答案。无需四舍五入。", "solution": "### 问题验证\n\n**步骤1：提取已知条件**\n\n- **目标函数：** 最小化 $q(x) = \\frac{1}{2}x^{\\top}H x + c^{\\top}x$。\n- **Hessian 矩阵：** $H = \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}$。\n- **线性项向量：** $c = \\begin{pmatrix} -2 \\\\ -3 \\end{pmatrix}$。\n- **约束 ($Ax \\leq b$)：**\n    - $C_1: -x_1 \\leq 0$ (即 $x_1 \\geq 0$)。\n    - $C_2: x_1 \\leq 2$。\n    - $C_3: x_1 \\leq 1$。\n    - $C_4: -x_2 \\leq 0$ (即 $x_2 \\geq 0$)。\n    - $C_5: x_2 \\leq 3$。\n- **可行集：** 非空。\n- **方法：** 主动集法的第一阶段。\n- **初始工作集：** $W_0 = \\{C_1, C_2, C_3, C_4\\}$。\n- **$W_0$ 的不可行性：** 问题陈述 $W_0$ 是不可行的，因为它要求 $x_1=0$、$x_1=2$、$x_1=1$ 和 $x_2=0$ 同时成立。\n- **第一阶段子问题：** 在迭代 $k$ 时，求解 $\\min_{x \\in \\mathbb{R}^2} \\frac{1}{2} \\|A_{W_k}x - b_{W_k}\\|^2$。\n- **主动集交换规则：**\n    1. 检查 $W_k$ 中约束的拉格朗日乘子。\n    2. 如果任何乘子为负，则从 $W_k$ 中移除具有最负乘子的约束。\n    3. 如果所有乘子都为非负，则添加一个阻塞约束。\n- **终止条件：** 执行第一阶段，直到找到对所有五个不等式都可行的点。\n- **最终答案：** 第一阶段执行的总交换次数。\n\n**步骤2：使用提取的已知条件进行验证**\n\n- **科学基础：** 该问题是一个标准的优化问题（QP），所描述的方法（用于第一阶段的主动集法）是一种标准算法。它在数学上是合理的。\n- **良态性：**\n    - 该问题要求为一个给定的步数（直到找到一个可行点）执行一个特定算法（主动集法的第一阶段）。\n    - 初始工作集 $W_0$ 已明确给出。更新工作集的规则也已给出。\n    - 第一阶段子问题是一个线性最小二乘问题。如果约束是线性无关的，$A_{W_k}$ 矩阵将具有满列秩。让我们检查 $W_0$ 中的约束。\n        - $C_1: -x_1 \\leq 0 \\implies [-1, 0]x \\leq 0$。\n        - $C_2: x_1 \\leq 2 \\implies [1, 0]x \\leq 2$。\n        - $C_3: x_1 \\leq 1 \\implies [1, 0]x \\leq 1$。\n        - $C_4: -x_2 \\leq 0 \\implies [0, -1]x \\leq 0$。\n    - 对应于 $C_1, C_2, C_3$ 的 $A$ 的行是 $[-1, 0]$, $[1, 0]$, $[1, 0]$。这些是线性相关的。该问题在第一步为 $x_1$ 设立了一个超定系统。\n    - 问题陈述 $W_0$ 是不可行的，这是正确的：$x_1=0, x_1=2, x_1=1$ 是不可能的。\n    - 第一阶段子问题是 $\\min \\frac{1}{2}\\|A_{W_k}x - b_{W_k}\\|^2$。其解由正规方程给出：$A_{W_k}^{\\top}A_{W_k} x = A_{W_k}^{\\top}b_{W_k}$。\n    - 让我们检查 $A_{W_0}$。\n        $A_{W_0} = \\begin{pmatrix} -1  0 \\\\ 1  0 \\\\ 1  0 \\\\ 0  -1 \\end{pmatrix}$， $b_{W_0} = \\begin{pmatrix} 0 \\\\ 2 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n        $A_{W_0}^{\\top} A_{W_0} = \\begin{pmatrix} -1  1  1  0 \\\\ 0  0  0  -1 \\end{pmatrix} \\begin{pmatrix} -1  0 \\\\ 1  0 \\\\ 1  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} 1+1+1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 3  0 \\\\ 0  1 \\end{pmatrix}$。这是可逆的，所以存在唯一的最小二乘解。$A_{W_0}$ 行的线性相关性并未使子问题成为病态的。\n    - 主动集法的逻辑是找到一个满足约束子集（工作集）作为等式的点，然后朝着满足更多约束的点移动。所描述的第一阶段是通过最小化工作集的违背程度来找到第二阶段的可行起始点的一种方法。这是一个标准程序。\n- **目标：** 问题陈述清晰明确。规则是精确的。\n- **缺陷？**\n    1. **科学上不合理？** 否。\n    2. **无法形式化？** 否，这是一个标准算法的执行。主题正是*二次规划的主动集法*。\n    3. **不完整/矛盾？** 初始工作集 $W_0$ 是故意不可行的，这正是第一阶段的目的。问题明确指出了这一点。约束 $C_2: x_1 \\leq 2$ 和 $C_3: x_1 \\leq 1$ 在整个可行集中似乎是冗余的，因为 $x_1 \\leq 1$ 意味着 $x_1 \\leq 2$。然而，这本身并不是问题陈述的缺陷；它是给定约束集的一个特征。算法必须处理这种情况。\n    4. **不现实？** 否。\n    5. **病态？** 只要 $A_{W_k}^{\\top}A_{W_k}$ 是可逆的，最小二乘子问题在每一步都是良态的。对于单个变量的约束，通常情况如此，除非工作集只包含对一个变量的约束，而另一个变量无约束（这将使 $A_{W_k}$ 列秩亏缺）。让我们看看。$A_{W_0}$ 是满列秩的。如果我们去掉，比如说，$C_2$，$A_{W_k}$ 仍将是满列秩。问题似乎结构良好。\n    6. **伪深刻/琐碎？** 冗余（$x_1 \\leq 1$ 和 $x_1 \\leq 2$）可能看起来是刻意设计的，但对于一个优化问题来说，这是一个有效的情景。测试的是算法在这种情景下的行为。这并非琐碎。\n    7. **无法外部验证？** 否。\n\n**结论：** 问题是有效的。它描述了一个优化算法的标准教科书式执行。冗余约束的存在是问题设置的一部分，并不会使其无效。\n\n### 解题计划\n\n我需要逐步执行第一阶段主动集法。一次“交换”被定义为基于负乘子从工作集中移除一个约束。问题要求的是第一阶段中这种交换的总次数。\n\n**迭代 k=0:**\n1.  **工作集：** $W_0 = \\{C_1, C_2, C_3, C_4\\}$。\n2.  **构建最小二乘子问题：**\n    我们想要找到 $x^{(0)}$ 以最小化 $\\frac{1}{2}\\|A_{W_0}x - b_{W_0}\\|^2$。\n    $W_0$ 中的约束是：\n    $C_1: -x_1 = 0 \\implies x_1 = 0$\n    $C_2: x_1 = 2$\n    $C_3: x_1 = 1$\n    $C_4: -x_2 = 0 \\implies x_2 = 0$\n    所以，$A_{W_0} = \\begin{pmatrix} -1  0 \\\\ 1  0 \\\\ 1  0 \\\\ 0  -1 \\end{pmatrix}$ 和 $b_{W_0} = \\begin{pmatrix} 0 \\\\ 2 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n3.  **求解 $x^{(0)}$:**\n    正规方程是 $A_{W_0}^{\\top}A_{W_0} x^{(0)} = A_{W_0}^{\\top}b_{W_0}$。\n    $A_{W_0}^{\\top}A_{W_0} = \\begin{pmatrix} (-1)^2+1^2+1^2  0 \\\\ 0  (-1)^2 \\end{pmatrix} = \\begin{pmatrix} 3  0 \\\\ 0  1 \\end{pmatrix}$。\n    $A_{W_0}^{\\top}b_{W_0} = \\begin{pmatrix} -1  1  1  0 \\\\ 0  0  0  -1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 2 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (-1)(0) + (1)(2) + (1)(1) + (0)(0) \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$。\n    所以，$\\begin{pmatrix} 3  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} x_1^{(0)} \\\\ x_2^{(0)} \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$。\n    这得到 $3x_1^{(0)} = 3 \\implies x_1^{(0)} = 1$ 和 $x_2^{(0)} = 0$。\n    所以，最小二乘解是 $x^{(0)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n4.  **计算拉格朗日乘子：**\n    在这种情况下，拉格朗日乘子通常被定义为残差向量的组成部分，$\\lambda = A_{W_k}x^{(k)} - b_{W_k}$。我们来验证这个解释。$\\lambda$ 向量衡量在解点 $x^{(k)}$ 处工作集中每个约束的违背程度。对于约束 $a_i^\\top x \\leq b_i$，负的分量 $\\lambda_i = a_i^\\top x^{(k)} - b_i  0$ 意味着该约束被满足且有松弛 ($a_i^\\top x^{(k)}  b_i$)。正的分量意味着它被违背。第一阶段的目标是减少违背。问题说“移除...具有最负乘子的约束”。负乘子意味着 $a_i^\\top x^{(k)} - b_i  0$。如果我们将约束视为等式 $a_i^\\top x = b_i$，那么这个解位于由 $a_i^\\top x \\leq b_i$ 定义的半空间“内部”。从工作集中移除此等式约束，允许解移动，可能减少其他约束的违背，而不会立即违背这一个。这似乎是合乎逻辑的。让我们用这个定义继续：对于 $i \\in W_k$，$\\lambda_i = a_i^\\top x^{(k)} - b_i$。\n\n5.  **计算在 $x^{(0)} = (1, 0)$ 处 $W_0$ 的残差：**\n    残差向量是 $r = A_{W_0}x^{(0)} - b_{W_0}$。这些就是我们的乘子。\n    $r = \\begin{pmatrix} -1  0 \\\\ 1  0 \\\\ 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 2 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 2 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n    所以，乘子是：\n    $\\lambda_1 = -1$ (对应 $C_1$)\n    $\\lambda_2 = -1$ (对应 $C_2$)\n    $\\lambda_3 = 0$ (对应 $C_3$)\n    $\\lambda_4 = 0$ (对应 $C_4$)\n    最负的乘子是 $-1$，它对应于 $C_1$ 和 $C_2$。让我们假设一个平局打破规则（例如，最小索引）。我们移除 $C_1$。\n\n6.  **更新工作集：** 从 $W_0$ 中移除 $C_1$。这是第一次交换。**（交换次数 = 1）**\n    $W_1 = W_0 \\setminus \\{C_1\\} = \\{C_2, C_3, C_4\\}$。\n\n**迭代 k=1:**\n1.  **工作集：** $W_1 = \\{C_2, C_3, C_4\\}$。\n2.  **构建子问题：**\n    最小化 $\\frac{1}{2}\\|A_{W_1}x - b_{W_1}\\|^2$。\n    $W_1$ 中的约束是：\n    $C_2: x_1 = 2$\n    $C_3: x_1 = 1$\n    $C_4: -x_2 = 0 \\implies x_2 = 0$\n    $A_{W_1} = \\begin{pmatrix} 1  0 \\\\ 1  0 \\\\ 0  -1 \\end{pmatrix}$， $b_{W_1} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n3.  **求解 $x^{(1)}$:**\n    $A_{W_1}^{\\top}A_{W_1} x^{(1)} = A_{W_1}^{\\top}b_{W_1}$。\n    $A_{W_1}^{\\top}A_{W_1} = \\begin{pmatrix} 1  1  0 \\\\ 0  0  -1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} 1^2+1^2  0 \\\\ 0  (-1)^2 \\end{pmatrix} = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}$。\n    $A_{W_1}^{\\top}b_{W_1} = \\begin{pmatrix} 1  1  0 \\\\ 0  0  -1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (1)(2) + (1)(1) \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$。\n    所以，$\\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} x_1^{(1)} \\\\ x_2^{(1)} \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$。\n    这得到 $2x_1^{(1)} = 3 \\implies x_1^{(1)} = 1.5$ 和 $x_2^{(1)} = 0$。\n    所以，$x^{(1)} = \\begin{pmatrix} 1.5 \\\\ 0 \\end{pmatrix}$。\n4.  **计算在 $x^{(1)}$ 处 $W_1$ 的乘子（残差）：**\n    $r = A_{W_1}x^{(1)} - b_{W_1} = \\begin{pmatrix} 1  0 \\\\ 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1.5 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1.5 \\\\ 1.5 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -0.5 \\\\ 0.5 \\\\ 0 \\end{pmatrix}$。\n    乘子：\n    $\\lambda_2 = -0.5$ (对应 $C_2$)\n    $\\lambda_3 = 0.5$ (对应 $C_3$)\n    $\\lambda_4 = 0$ (对应 $C_4$)\n    唯一的负乘子是 $\\lambda_2 = -0.5$。\n5.  **更新工作集：** 从 $W_1$ 中移除 $C_2$。这是第二次交换。**（交换次数 = 2）**\n    $W_2 = W_1 \\setminus \\{C_2\\} = \\{C_3, C_4\\}$。\n\n**迭代 k=2:**\n1.  **工作集：** $W_2 = \\{C_3, C_4\\}$。\n2.  **构建子问题：**\n    最小化 $\\frac{1}{2}\\|A_{W_2}x - b_{W_2}\\|^2$。\n    $W_2$ 中的约束是：\n    $C_3: x_1 = 1$\n    $C_4: -x_2 = 0 \\implies x_2 = 0$\n    $A_{W_2} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$， $b_{W_2} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n3.  **求解 $x^{(2)}$:**\n    这个系统 $A_{W_2}x = b_{W_2}$ 现在是满秩且一致的。\n    $\\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} x_1^{(2)} \\\\ x_2^{(2)} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n    这得到 $x_1^{(2)} = 1$ 和 $-x_2^{(2)} = 0 \\implies x_2^{(2)} = 0$。\n    所以，$x^{(2)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n4.  **计算在 $x^{(2)}$ 处 $W_2$ 的乘子（残差）：**\n    $r = A_{W_2}x^{(2)} - b_{W_2} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n    乘子：\n    $\\lambda_3 = 0$\n    $\\lambda_4 = 0$\n    没有负乘子。所以，$x^{(2)} = (1, 0)$ 是工作集 $W_2$ 的“最佳”点。事实上，它精确地满足了 $W_2$ 中的约束。\n5.  **检查 $x^{(2)}$ 对所有约束的可行性：**\n    点是 $x^{(2)} = (1, 0)$。\n    原始约束是：\n    $C_1: x_1 \\geq 0 \\implies 1 \\geq 0$ (满足)\n    $C_2: x_1 \\leq 2 \\implies 1 \\leq 2$ (满足)\n    $C_3: x_1 \\leq 1 \\implies 1 \\leq 1$ (满足, 主动)\n    $C_4: x_2 \\geq 0 \\implies 0 \\geq 0$ (满足, 主动)\n    $C_5: x_2 \\leq 3 \\implies 0 \\leq 3$ (满足)\n\n    点 $x^{(2)} = (1, 0)$ 对所有五个约束都是可行的。\n    算法规定：“执行第一阶段，直到找到对所有五个不等式都可行的点”。\n    我们已经找到了一个可行点。所以第一阶段终止。\n\n**总交换次数：**\n共有两次交换：\n1.  从 $W_0$ 中移除了 $C_1$。\n2.  从 $W_1$ 中移除了 $C_2$。\n总交换次数为 2。\n\n无论平局打破规则如何，交换次数都是 2。平局打破的模糊性不影响所提问题的最终答案。\n\n我现在将写下解题步骤。\n该问题是良态的，并且涉及二次规划中主动集法的标准第一阶段程序。目标是为给定的约束集找到一个可行点，从一个不可行的工作集配置开始。在此背景下，“交换”指的是从工作集中移除一个约束的动作。当与该约束相关的“拉格朗日乘子”为负时，执行此操作。对于指定的最小二乘子问题，这些乘子被解释为残差。\n\n设变量向量为 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$。五个不等式约束可以写成 $Ax \\leq b$ 的形式，其中 $A$ 的行和 $b$ 的条目是：\n$a_1^\\top = \\begin{pmatrix} -1  0 \\end{pmatrix}, b_1 = 0$\n$a_2^\\top = \\begin{pmatrix} 1  0 \\end{pmatrix}, b_2 = 2$\n$a_3^\\top = \\begin{pmatrix} 1  0 \\end{pmatrix}, b_3 = 1$\n$a_4^\\top = \\begin{pmatrix} 0  -1 \\end{pmatrix}, b_4 = 0$\n$a_5^\\top = \\begin{pmatrix} 0  1 \\end{pmatrix}, b_5 = 3$\n\n第一阶段程序从迭代 $k=0$ 开始。\n\n**迭代 $k=0$：**\n初始工作集是 $W_0 = \\{C_1, C_2, C_3, C_4\\}$。我们求解最小二乘问题 $\\min \\frac{1}{2}\\|A_{W_0}x - b_{W_0}\\|^2$。该子问题的矩阵是：\n$$\nA_{W_0} = \\begin{pmatrix} a_1^\\top \\\\ a_2^\\top \\\\ a_3^\\top \\\\ a_4^\\top \\end{pmatrix} = \\begin{pmatrix} -1  0 \\\\ 1  0 \\\\ 1  0 \\\\ 0  -1 \\end{pmatrix}, \\quad b_{W_0} = \\begin{pmatrix} b_1 \\\\ b_2 \\\\ b_3 \\\\ b_4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 2 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n解 $x^{(0)}$ 通过正规方程 $A_{W_0}^{\\top}A_{W_0} x^{(0)} = A_{W_0}^{\\top}b_{W_0}$ 找到。\n$$\nA_{W_0}^{\\top}A_{W_0} = \\begin{pmatrix} (-1)^2 + 1^2 + 1^2  0 \\\\ 0  (-1)^2 \\end{pmatrix} = \\begin{pmatrix} 3  0 \\\\ 0  1 \\end{pmatrix}\n$$\n$$\nA_{W_0}^{\\top}b_{W_0} = \\begin{pmatrix} (-1)(0) + (1)(2) + (1)(1) \\\\ (-1)(0) \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}\n$$\n求解 $\\begin{pmatrix} 3  0 \\\\ 0  1 \\end{pmatrix} x^{(0)} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$ 得到 $x^{(0)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n乘子 $\\lambda^{(0)}$ 是残差 $A_{W_0}x^{(0)} - b_{W_0}$：\n$$\n\\lambda^{(0)} = \\begin{pmatrix} -1  0 \\\\ 1  0 \\\\ 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 2 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 2 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n约束 $C_1, C_2, C_3, C_4$ 的乘子分别是 $\\lambda_1 = -1$, $\\lambda_2 = -1$, $\\lambda_3 = 0$, 和 $\\lambda_4 = 0$。最负的乘子是 $-1$，对应于 $C_1$ 和 $C_2$。我们通过选择索引最小的约束 $C_1$ 来打破平局。我们从工作集中移除 $C_1$。这是第一次交换。\n$W_1 = W_0 \\setminus \\{C_1\\} = \\{C_2, C_3, C_4\\}$。\n\n**迭代 $k=1$：**\n工作集是 $W_1 = \\{C_2, C_3, C_4\\}$。子问题的矩阵是：\n$$\nA_{W_1} = \\begin{pmatrix} 1  0 \\\\ 1  0 \\\\ 0  -1 \\end{pmatrix}, \\quad b_{W_1} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n$x^{(1)}$ 的正规方程是 $A_{W_1}^{\\top}A_{W_1} x^{(1)} = A_{W_1}^{\\top}b_{W_1}$。\n$$\nA_{W_1}^{\\top}A_{W_1} = \\begin{pmatrix} 1^2 + 1^2  0 \\\\ 0  (-1)^2 \\end{pmatrix} = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}\n$$\n$$\nA_{W_1}^{\\top}b_{W_1} = \\begin{pmatrix} (1)(2) + (1)(1) \\\\ (-1)(0) \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}\n$$\n求解 $\\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} x^{(1)} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$ 得到 $x^{(1)} = \\begin{pmatrix} 3/2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1.5 \\\\ 0 \\end{pmatrix}$。\n\n乘子 $\\lambda^{(1)}$ 是这个工作集的残差：\n$$\n\\lambda^{(1)} = \\begin{pmatrix} 1  0 \\\\ 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1.5 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1.5 \\\\ 1.5 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -0.5 \\\\ 0.5 \\\\ 0 \\end{pmatrix}\n$$\n约束 $C_2, C_3, C_4$ 的乘子是 $\\lambda_2 = -0.5$, $\\lambda_3 = 0.5$, $\\lambda_4 = 0$。唯一的负乘子是 $\\lambda_2 = -0.5$。我们从工作集中移除 $C_2$。这是第二次交换。\n$W_2 = W_1 \\setminus \\{C_2\\} = \\{C_3, C_4\\}$。\n\n**迭代 $k=2$：**\n工作集是 $W_2 = \\{C_3, C_4\\}$。子问题的矩阵是：\n$$\nA_{W_2} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}, \\quad b_{W_2} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n矩阵 $A_{W_2}$ 是方阵且非奇异，所以最小二乘解是 $A_{W_2}x = b_{W_2}$ 的精确解。\n求解 $\\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} x^{(2)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 得到 $x^{(2)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n乘子 $\\lambda^{(2)}$ 是残差：\n$$\n\\lambda^{(2)} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n乘子 $\\lambda_3=0$ 和 $\\lambda_4=0$ 是非负的。我们现在检查当前点 $x^{(2)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 对所有原始约束是否可行。\n$C_1: -x_1 \\leq 0 \\implies -1 \\leq 0$ (满足)\n$C_2: x_1 \\leq 2 \\implies 1 \\leq 2$ (满足)\n$C_3: x_1 \\leq 1 \\implies 1 \\leq 1$ (满足)\n$C_4: -x_2 \\leq 0 \\implies 0 \\leq 0$ (满足)\n$C_5: x_2 \\leq 3 \\implies 0 \\leq 3$ (满足)\n由于 $x^{(2)}$ 对所有约束都是可行的，第一阶段终止。\n\n该过程涉及两次从工作集中移除约束。每次移除对应一次交换。因此，总交换次数为 $2$。", "answer": "$$\\boxed{2}$$", "id": "3094700"}, {"introduction": "理论上，当满足 KKT 条件时，算法就找到了最优解并终止。但在实践中，我们如何利用有限精度的浮点数来可靠地检查这些条件呢？本练习 [@problem_id:3094695] 探讨了在实现主动集方法时停止准则的微妙之处，这是一个至关重要的实际问题。通过分析一个参数化的二次规划问题，你将研究基于拉格朗日乘子和约束松紧度的不同停止准则，并量化不精确的容差如何在退化或接近退化的情形下导致对真实主动集的错误识别。", "problem": "考虑一个凸二次规划 (QP) 问题，其决策变量为 $x \\in \\mathbb{R}^2$，由以下目标和不等式约束定义\n$$\n\\min_{x \\in \\mathbb{R}^2} \\;\\; \\tfrac{1}{2} x^\\top H x + c^\\top x\n$$\n约束条件为\n$$\ng_1(x) = -x_1 \\le 0, \\quad g_2(x) = -x_2 \\le 0, \\quad g_3(x) = s - a^\\top x \\le 0,\n$$\n其中 $H \\in \\mathbb{R}^{2 \\times 2}$ 是单位矩阵 $I_2$， $c \\in \\mathbb{R}^2$ 是零向量，$a = (1,1)^\\top$， $s \\in \\mathbb{R}$ 是一个标量参数。可行集是非负象限与由 $a^\\top x \\ge s$ 定义的半空间的交集。\n\n使用的基本原理：\n- 凸性：$H = I_2$ 是正定的，因此该问题是严格凸的，并拥有唯一的极小值点。\n- Karush-Kuhn-Tucker (KKT) 条件：对于带不等式约束的凸 QP 问题，最优性由原始可行性 $g_i(x^\\star) \\le 0$、对偶可行性 $\\mu_i^\\star \\ge 0$、稳定性条件 $H x^\\star + c + \\sum_{i=1}^3 \\mu_i^\\star \\nabla g_i(x^\\star) = 0$ 以及对每个约束 $i$ 的互补松弛性 $\\mu_i^\\star g_i(x^\\star) = 0$ 共同刻画。\n\n你的任务：\n1) 基于上述基本原理并从第一性原理出发，推导该问题的最优解 $x^\\star$ 和相应的拉格朗日乘子 $\\mu^\\star \\in \\mathbb{R}^3$，将其表示为标量参数 $s$ 的函数。不要假设或引用现成的投影公式；而是使用稳定性条件、原始可行性、对偶可行性和互补松弛性来确定 $x^\\star$ 和 $\\mu^\\star$。\n\n2) 将解的真实主动集定义为\n$$\n\\mathcal{A}^\\star = \\{ i \\in \\{1,2,3\\} : g_i(x^\\star) = 0 \\}.\n$$\n定义一个主动集方法可能用来判断主动性的两个停止准则：\n- 基于乘子并在容差 $\\tau_\\mu$ 下的识别：如果 $\\mu_i^\\star \\ge \\tau_\\mu$，则宣布约束 $i$ 为主动约束。\n- 基于松弛变量并在容差 $\\tau_{\\text{slack}}$ 下的识别：如果 $|g_i(x^\\star)| \\le \\tau_{\\text{slack}}$，则宣布约束 $i$ 为主动约束。\n\n3) 对于每个测试用例，通过整数 $M$ 来量化在给定的一对容差下的错误识别\n$$\nM = \\left|\\mathcal{A}^\\star \\setminus \\widehat{\\mathcal{A}}_\\mu\\right| + \\left|\\widehat{\\mathcal{A}}_s \\setminus \\mathcal{A}^\\star\\right|,\n$$\n其中 $\\widehat{\\mathcal{A}}_\\mu = \\{ i : \\mu_i^\\star \\ge \\tau_\\mu \\}$ 且 $\\widehat{\\mathcal{A}}_s = \\{ i : |g_i(x^\\star)| \\le \\tau_{\\text{slack}} \\}$。第一项计算基于乘子规则的假阴性（漏报）；第二项计算基于松弛变量规则的假阳性（误报）。\n\n4) 实现一个程序，对于下面测试套件中的每个 $s$，计算 $x^\\star$、$g_i(x^\\star)$、$\\mu_i^\\star$，然后分别计算严格容差对和宽松（不精确）容差对下的 $M$：\n- 严格容差：$\\tilde{\\tau}_\\mu = 10^{-12}$ 和 $\\tilde{\\tau}_{\\text{slack}} = 10^{-12}$。\n- 宽松容差：$\\tau_\\mu = 10^{-3}$ 和 $\\tau_{\\text{slack}} = 10^{-3}$。\n\n测试套件（$s$ 的值）：\n- 理想情况：$s = 0.5$。\n- 边界/退化情况：$s = 0$。\n- 接近零的正数：$s = 10^{-8}$。\n- 接近阈值的正数：$s = 10^{-3}$。\n- 接近零的负数：$s = -10^{-8}$。\n\n最终输出规范：\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。\n- 对于上述五个按给定顺序排列的测试用例，输出扁平化列表 $[M_{\\text{strict}}(s_1), M_{\\text{loose}}(s_1), \\dots, M_{\\text{strict}}(s_5), M_{\\text{loose}}(s_5)]$。\n- 每个 $M$ 都必须是整数。", "solution": "用户提供的问题被评估为有效。\n\n### 步骤 1：提取已知信息\n- **目标函数**：$\\min_{x \\in \\mathbb{R}^2} \\;\\; \\frac{1}{2} x^\\top H x + c^\\top x$\n- **约束条件**：\n  - $g_1(x) = -x_1 \\le 0$\n  - $g_2(x) = -x_2 \\le 0$\n  - $g_3(x) = s - a^\\top x \\le 0$\n- **参数**：\n  - 决策变量：$x = (x_1, x_2)^\\top \\in \\mathbb{R}^2$\n  - Hessian 矩阵：$H = I_2 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$\n  - 线性项：$c = (0, 0)^\\top$\n  - 约束向量：$a = (1, 1)^\\top$\n  - 约束标量：$s \\in \\mathbb{R}$\n- **基本原理**：最优性的 Karush-Kuhn-Tucker (KKT) 条件。\n- **定义**：\n  - 真实主动集：$\\mathcal{A}^\\star = \\{ i \\in \\{1,2,3\\} : g_i(x^\\star) = 0 \\}$\n  - 基于乘子的主动集：$\\widehat{\\mathcal{A}}_\\mu = \\{ i : \\mu_i^\\star \\ge \\tau_\\mu \\}$\n  - 基于松弛变量的主动集：$\\widehat{\\mathcal{A}}_s = \\{ i : |g_i(x^\\star)| \\le \\tau_{\\text{slack}} \\}$\n  - 不匹配度量：$M = \\left|\\mathcal{A}^\\star \\setminus \\widehat{\\mathcal{A}}_\\mu\\right| + \\left|\\widehat{\\mathcal{A}}_s \\setminus \\mathcal{A}^\\star\\right|$\n- **容差**：\n  - 严格：$\\tilde{\\tau}_\\mu = 10^{-12}$，$\\tilde{\\tau}_{\\text{slack}} = 10^{-12}$\n  - 宽松：$\\tau_\\mu = 10^{-3}$，$\\tau_{\\text{slack}} = 10^{-3}$\n- **测试用例（$s$ 的值）**：$0.5$、$0$、$10^{-8}$、$10^{-3}$、$-10^{-8}$。\n\n### 步骤 2：使用提取的已知信息进行验证\n1.  **科学依据**：该问题是一个标准的凸二次规划 (QP)。Hessian 矩阵 $H = I_2$ 是正定的，确保了目标函数是严格凸的。约束是线性的，定义了一个凸可行集。使用 KKT 条件是解决此类问题的标准、正确方法。该问题在数学上和科学上都是合理的。\n2.  **适定性**：由于问题是严格凸的，且可行集是闭合的凸集，因此对于任何使可行集非空的值 $s$，都存在唯一的极小值点 $x^\\star$。对于所有 $s \\in \\mathbb{R}$，可行集都是非空的。因此，该问题是适定的。\n3.  **明确性**：问题的所有组成部分都以数学精度进行了定义。任务是具体的、可量化的。没有主观或模棱两可的语言。\n4.  **完整性**：所有必要的数据和定义（$H$、$c$、$a$、约束、KKT 条件、主动集和 $M$ 的定义）均已提供。该问题是自洽的。\n\n### 步骤 3：结论与行动\n问题有效。我们继续进行求解。\n\n### 第 1 部分：通过 KKT 条件求解解析解\n该问题旨在找到可行集中距离原点最近的点。\n$$ \\min_{x_1, x_2} \\;\\; \\frac{1}{2} (x_1^2 + x_2^2) $$\n约束条件为\n$$ x_1 \\ge 0, \\quad x_2 \\ge 0, \\quad x_1 + x_2 \\ge s $$\n对于约束为 $g_i(x) \\le 0$ 的问题，其拉格朗日函数 $L(x, \\mu)$ 为：\n$$ L(x, \\mu) = \\frac{1}{2}(x_1^2 + x_2^2) + \\mu_1(-x_1) + \\mu_2(-x_2) + \\mu_3(s - x_1 - x_2) $$\n最优解 $(x^\\star, \\mu^\\star)$ 的 KKT 条件是：\n1.  **稳定性条件**：$\\nabla_x L(x^\\star, \\mu^\\star) = 0$\n    $$ x_1^\\star - \\mu_1^\\star - \\mu_3^\\star = 0 \\implies x_1^\\star = \\mu_1^\\star + \\mu_3^\\star $$\n    $$ x_2^\\star - \\mu_2^\\star - \\mu_3^\\star = 0 \\implies x_2^\\star = \\mu_2^\\star + \\mu_3^\\star $$\n2.  **原始可行性**：\n    $$ -x_1^\\star \\le 0 \\implies x_1^\\star \\ge 0 $$\n    $$ -x_2^\\star \\le 0 \\implies x_2^\\star \\ge 0 $$\n    $$ s - x_1^\\star - x_2^\\star \\le 0 \\implies x_1^\\star + x_2^\\star \\ge s $$\n3.  **对偶可行性**：\n    $$ \\mu_1^\\star \\ge 0, \\quad \\mu_2^\\star \\ge 0, \\quad \\mu_3^\\star \\ge 0 $$\n4.  **互补松弛性**：\n    $$ \\mu_1^\\star (-x_1^\\star) = 0 \\implies \\mu_1^\\star x_1^\\star = 0 $$\n    $$ \\mu_2^\\star (-x_2^\\star) = 0 \\implies \\mu_2^\\star x_2^\\star = 0 $$\n    $$ \\mu_3^\\star (s - x_1^\\star - x_2^\\star) = 0 $$\n\n我们通过考虑参数 $s$ 的不同情况来分析解。\n\n**情况 1：$s  0$**\n可行域不包含原点。解预期位于边界 $x_1+x_2=s$ 上。我们假设约束 3 是主动的，即 $g_3(x^\\star)=0$，而约束 1 和 2 是非主动的，即 $g_1(x^\\star)  0$ 且 $g_2(x^\\star)  0$。\n- 非主动的约束 1、2 ($x_1^\\star  0, x_2^\\star  0$) 根据互补松弛性意味着 $\\mu_1^\\star = 0$ 和 $\\mu_2^\\star = 0$。\n- 稳定性条件变为：$x_1^\\star = \\mu_3^\\star$ 和 $x_2^\\star = \\mu_3^\\star$。这意味着 $x_1^\\star = x_2^\\star$。\n- 主动的约束 3 ($x_1^\\star + x_2^\\star = s$) 得到 $x_1^\\star + x_1^\\star = s \\implies 2x_1^\\star = s \\implies x_1^\\star = s/2$。\n- 所以，$x^\\star = (s/2, s/2)^\\top$。\n- 根据稳定性条件，$\\mu_3^\\star = x_1^\\star = s/2$。\n- 我们验证 KKT 条件：\n    - 原始可行性：对于 $s0$，$x_1^\\star=s/2  0$, $x_2^\\star=s/2  0$, $x_1^\\star+x_2^\\star=s \\ge s$。均成立。\n    - 对偶可行性：$\\mu_1^\\star=0 \\ge 0$, $\\mu_2^\\star=0 \\ge 0$, $\\mu_3^\\star=s/2  0$。均成立。\n    - 互补松弛性：$\\mu_1^\\star x_1^\\star = 0 \\cdot s/2 = 0$, $\\mu_2^\\star x_2^\\star = 0 \\cdot s/2 = 0$, $\\mu_3^\\star(s - s) = 0$。均成立。\n- 解为：\n  $x^\\star = (s/2, s/2)^\\top$，$\\mu^\\star = (0, 0, s/2)^\\top$。\n  约束值为 $g(x^\\star) = (-s/2, -s/2, 0)^\\top$。\n  真实主动集为 $\\mathcal{A}^\\star = \\{3\\}$。\n\n**情况 2：$s \\le 0$**\n可行域是第一象限 $\\{x | x_1\\ge0, x_2\\ge0\\}$，因为如果 $s \\le 0$，对于任何 $x_1, x_2 \\ge 0$，条件 $x_1+x_2 \\ge s$ 都会自动满足。第一象限中距离原点最近的点是原点本身。我们来验证 $x^\\star=(0,0)^\\top$。\n- 在 $x^\\star = (0,0)^\\top$ 处，我们有 $g_1(x^\\star)=0$ 和 $g_2(x^\\star)=0$。约束 1 和 2 是主动的。\n- 根据稳定性条件：$0 = \\mu_1^\\star + \\mu_3^\\star$ 和 $0 = \\mu_2^\\star + \\mu_3^\\star$。\n- 考虑到对偶可行性（$\\mu_i \\ge 0$），这些方程意味着 $\\mu_1^\\star=\\mu_2^\\star=\\mu_3^\\star=0$。\n- 我们验证 $\\mu^\\star = (0,0,0)^\\top$ 的 KKT 条件：\n    - 稳定性条件：$0 = 0+0$, $0=0+0$。成立。\n    - 原始可行性：$x_1^\\star=0 \\ge 0$, $x_2^\\star=0 \\ge 0$, $x_1^\\star+x_2^\\star=0 \\ge s$（因为 $s \\le 0$）。成立。\n    - 对偶可行性：$\\mu_1^\\star=\\mu_2^\\star=\\mu_3^\\star=0$。成立。\n    - 互补松弛性：所有乘子都为 0，所以所有条件都自然成立。\n- 解为 $x^\\star = (0,0)^\\top$，$\\mu^\\star = (0,0,0)^\\top$。\n- 约束值为 $g(x^\\star) = (0, 0, s)^\\top$。\n- 我们必须根据 $s$ 的确切值来区分真实主动集：\n    - 如果 $s  0$：$g_3(x^\\star) = s  0$。主动约束只有 1 和 2。$\\mathcal{A}^\\star = \\{1, 2\\}$。\n    - 如果 $s = 0$：$g_3(x^\\star) = 0$。所有三个约束都是主动的。$\\mathcal{A}^\\star = \\{1, 2, 3\\}$。这是一个退化情况，其中主动约束具有零乘子。\n\n### 第 2 和 3 部分：主动集识别与不匹配度量\n该问题定义了两种识别主动集的准则：\n- 基于乘子：$\\widehat{\\mathcal{A}}_\\mu = \\{ i : \\mu_i^\\star \\ge \\tau_\\mu \\}$\n- 基于松弛变量：$\\widehat{\\mathcal{A}}_s = \\{ i : |g_i(x^\\star)| \\le \\tau_{\\text{slack}} \\}$\n\n以及一个量化误差的不匹配度量：\n$M = \\left|\\mathcal{A}^\\star \\setminus \\widehat{\\mathcal{A}}_\\mu\\right| + \\left|\\widehat{\\mathcal{A}}_s \\setminus \\mathcal{A}^\\star\\right|$\n其中第一项计算基于乘子规则的假阴性（漏掉了真实的活动约束），第二项计算基于松弛变量规则的假阳性（将非活动约束错误识别为活动约束）。\n\n### 第 4 部分：测试用例评估\n我们应用推导出的解来为每个测试用例计算 $M$。\n\n**示例：$s=0$（退化情况）**\n- 解：$x^\\star=(0,0)^\\top$, $\\mu^\\star=(0,0,0)^\\top$, $g(x^\\star)=(0,0,0)^\\top$。\n- 真实主动集：$\\mathcal{A}^\\star=\\{1,2,3\\}$。\n- **严格容差（$\\tilde{\\tau}_\\mu = 10^{-12}, \\tilde{\\tau}_{\\text{slack}} = 10^{-12}$）**：\n  - $\\mu_1^\\star=\\mu_2^\\star=\\mu_3^\\star=0  10^{-12}$，所以 $\\widehat{\\mathcal{A}}_\\mu = \\emptyset$。\n  - $|g_1|=|g_2|=|g_3|=0 \\le 10^{-12}$，所以 $\\widehat{\\mathcal{A}}_s = \\{1,2,3\\}$。\n  - 假阴性（$|\\mathcal{A}^\\star \\setminus \\widehat{\\mathcal{A}}_\\mu|$）：$|\\{1,2,3\\} \\setminus \\emptyset| = 3$。由于退化，乘子规则完全失效。\n  - 假阳性（$|\\widehat{\\mathcal{A}}_s \\setminus \\mathcal{A}^\\star|$）：$|\\{1,2,3\\} \\setminus \\{1,2,3\\}| = 0$。\n  - $M_{\\text{strict}} = 3 + 0 = 3$。\n- 对于宽松容差的结果是相同的，因为值均为精确的 0。$M_{\\text{loose}} = 3$。\n\n**示例：$s=10^{-8}$（近退化情况）**\n- 解：$s  0$，所以 $x^\\star=(0.5\\times 10^{-8}, 0.5\\times 10^{-8})^\\top$, $\\mu^\\star=(0, 0, 0.5\\times 10^{-8})^\\top$, $g(x^\\star)=(-0.5\\times 10^{-8}, -0.5\\times 10^{-8}, 0)^\\top$。\n- 真实主动集：$\\mathcal{A}^\\star=\\{3\\}$。\n- **宽松容差（$\\tau_\\mu = 10^{-3}, \\tau_{\\text{slack}} = 10^{-3}$）**：\n  - $\\mu_1^\\star=0  10^{-3}$, $\\mu_2^\\star=0  10^{-3}$, $\\mu_3^\\star=0.5\\times 10^{-8}  10^{-3}$，所以 $\\widehat{\\mathcal{A}}_\\mu = \\emptyset$。\n  - $|g_1(x^\\star)|=0.5\\times 10^{-8} \\le 10^{-3}$, $|g_2(x^\\star)|=0.5\\times 10^{-8} \\le 10^{-3}$, $|g_3(x^\\star)|=0 \\le 10^{-3}$，所以 $\\widehat{\\mathcal{A}}_s = \\{1,2,3\\}$。\n  - 假阴性（$|\\mathcal{A}^\\star \\setminus \\widehat{\\mathcal{A}}_\\mu|$）：$|\\{3\\} \\setminus \\emptyset| = 1$。对乘子的宽松容差导致其漏掉了弱主动约束。\n  - 假阳性（$|\\widehat{\\mathcal{A}}_s \\setminus \\mathcal{A}^\\star|$）：$|\\{1,2,3\\} \\setminus \\{3\\}| = 2$。对松弛变量的宽松容差导致其错误地识别了接近主动的约束。\n  - $M_{\\text{loose}} = 1 + 2 = 3$。\n\n以下程序系统地计算所有测试用例的这些值。", "answer": "$$\\boxed{[0,0,3,3,0,3,0,3,2,3]}$$", "id": "3094695"}]}