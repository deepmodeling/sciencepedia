{"hands_on_practices": [{"introduction": "在求解约束优化问题时，满足 Karush-Kuhn-Tucker (KKT) 条件的点只是最优解的候选点。为了确认一个点是否为严格局部最小值点，我们必须检验二阶充分条件。这个练习将引导你通过计算既定约束条件下切空间上的既约 Hessian 矩阵，来验证一个 KKT 点的最优性，这是二次规划中一项核心的验证技能 [@problem_id:3166499]。", "problem": "考虑以下等式约束二次规划 (QP)：最小化二次目标函数\n$$f(x) \\;=\\; \\tfrac{1}{2}\\,x^{\\top} H x \\;+\\; q^{\\top} x,$$\n其中 $x \\in \\mathbb{R}^{3}$，Hessian矩阵为\n$$H \\;=\\; \\begin{pmatrix} 4  1  0 \\\\ 1  3  0 \\\\ 0  0  2 \\end{pmatrix},$$\n线性项为\n$$q \\;=\\; \\begin{pmatrix} -1 \\\\ 2 \\\\ 0 \\end{pmatrix}。$$\n约束条件为线性等式，形式如下\n$$A x \\;=\\; b, \\quad \\text{其中} \\quad A \\;=\\; \\begin{pmatrix} 1  1  0 \\\\ 0  0  1 \\end{pmatrix}, \\quad b \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}。$$\n\n从约束优化的基本原理出发，使用 Karush–Kuhn–Tucker (KKT) 条件来确定 KKT 点 $(x^{\\star},\\lambda^{\\star})$ 以及在 $x^{\\star}$ 处的可行方向切空间。构造一个矩阵 $Z \\in \\mathbb{R}^{3 \\times 1}$，其唯一的列是有效约束（即矩阵 $A$）的零空间的一组标准正交基向量。使用拉格朗日 Hessian 矩阵（对于 QP，它等于 $H$），构成简约 Hessian 矩阵\n$$R \\;=\\; Z^{\\top} H Z。$$\n\n然后，通过检验 $R$ 的定性，使用二阶充分条件来评估 $x^{\\star}$ 是否为一个严格局部极小值点。最后，计算与此问题相关的简约 Hessian 矩阵 $R$ 的唯一特征值。请给出该特征值的精确值作为最终答案，无需四舍五入。", "solution": "所给问题是一个有效的等式约束二次规划 (QP)。我们可以通过应用 Karush-Kuhn-Tucker (KKT) 条件来求解最优解。\n\n需要最小化的目标函数为 $f(x) = \\frac{1}{2}x^{\\top}Hx + q^{\\top}x$，约束条件为线性等式 $Ax = b$。给定的矩阵和向量如下：\n$$H = \\begin{pmatrix} 4  1  0 \\\\ 1  3  0 \\\\ 0  0  2 \\end{pmatrix}, \\quad q = \\begin{pmatrix} -1 \\\\ 2 \\\\ 0 \\end{pmatrix}, \\quad A = \\begin{pmatrix} 1  1  0 \\\\ 0  0  1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$$\n其中 $x \\in \\mathbb{R}^{3}$。\n\n该约束优化问题的拉格朗日函数为：\n$$L(x, \\lambda) = f(x) + \\lambda^{\\top}(Ax - b) = \\frac{1}{2}x^{\\top}Hx + q^{\\top}x + \\lambda^{\\top}(Ax - b)$$\n其中 $\\lambda \\in \\mathbb{R}^{2}$ 是拉格朗日乘子向量。\n\n最优性的一阶必要条件，即 KKT 条件，通过将拉格朗日函数对 $x$ 的梯度设为零，并确保满足约束条件来找到。\n1. 稳定性条件：$\\nabla_{x} L(x, \\lambda) = Hx + q + A^{\\top}\\lambda = 0$\n2. 原始可行性：$Ax = b$\n\n这两个条件构成了一个关于 $x$ 和 $\\lambda$ 的线性方程组。我们可以将其写成一个分块矩阵方程：\n$$ \\begin{pmatrix} H  A^{\\top} \\\\ A  0 \\end{pmatrix} \\begin{pmatrix} x \\\\ \\lambda \\end{pmatrix} = \\begin{pmatrix} -q \\\\ b \\end{pmatrix} $$\n代入给定的矩阵和向量，其中 $A^{\\top} = \\begin{pmatrix} 1  0 \\\\ 1  0 \\\\ 0  1 \\end{pmatrix}$ 且 $-q = \\begin{pmatrix} 1 \\\\ -2 \\\\ 0 \\end{pmatrix}$：\n$$ \\begin{pmatrix} 4  1  0  1  0 \\\\ 1  3  0  1  0 \\\\ 0  0  2  0  1 \\\\ 1  1  0  0  0 \\\\ 0  0  1  0  0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ \\lambda_1 \\\\ \\lambda_2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -2 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix} $$\n从最后两行（原始可行性约束）可知：\n- $x_1 + x_2 = 1$\n- $x_3 = 0$\n\n从方程组的第三行可知：\n$2x_3 + \\lambda_2 = 0$。代入 $x_3 = 0$，我们得到 $2(0) + \\lambda_2 = 0$，这意味着 $\\lambda_2 = 0$。\n\n现在我们使用前两行和约束条件 $x_1 + x_2 = 1$：\n1. $4x_1 + x_2 + \\lambda_1 = 1$\n2. $x_1 + 3x_2 + \\lambda_1 = -2$\n\n将 $x_2 = 1 - x_1$ 代入第一个方程：\n$4x_1 + (1 - x_1) + \\lambda_1 = 1 \\implies 3x_1 + 1 + \\lambda_1 = 1 \\implies 3x_1 + \\lambda_1 = 0$，所以 $\\lambda_1 = -3x_1$。\n\n将 $x_2 = 1 - x_1$ 和 $\\lambda_1 = -3x_1$ 代入第二个方程：\n$x_1 + 3(1 - x_1) + (-3x_1) = -2 \\implies x_1 + 3 - 3x_1 - 3x_1 = -2 \\implies -5x_1 + 3 = -2 \\implies -5x_1 = -5 \\implies x_1 = 1$。\n\n现在我们求解剩下的变量：\n$x_2 = 1 - x_1 = 1 - 1 = 0$。\n$\\lambda_1 = -3x_1 = -3(1) = -3$。\n\n因此，KKT 点 $(x^{\\star}, \\lambda^{\\star})$ 为：\n$$ x^{\\star} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad \\lambda^{\\star} = \\begin{pmatrix} -3 \\\\ 0 \\end{pmatrix} $$\n\n接下来，我们确定在 $x^{\\star}$ 处的可行方向切空间。对于线性等式约束，这就是矩阵 $A$ 的零空间，记为 $\\text{Null}(A)$。我们寻找向量 $z \\in \\mathbb{R}^{3}$ 使得 $Az = 0$。\n$$ \\begin{pmatrix} 1  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} z_1 \\\\ z_2 \\\\ z_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n这给出了以下方程组：\n$z_1 + z_2 = 0 \\implies z_1 = -z_2$\n$z_3 = 0$\n零空间中的任意向量可以写成 $z = \\begin{pmatrix} -t \\\\ t \\\\ 0 \\end{pmatrix} = t \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$，其中 $t \\in \\mathbb{R}$ 为某个标量。\n零空间是一维的，其一组基向量为 $v = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n\n问题要求构造一个矩阵 $Z \\in \\mathbb{R}^{3 \\times 1}$，其列是 $\\text{Null}(A)$ 的一组标准正交基。我们对基向量 $v$ 进行标准化：\n$\\|v\\| = \\sqrt{(-1)^2 + 1^2 + 0^2} = \\sqrt{2}$。\n标准正交基向量为 $\\frac{v}{\\|v\\|} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n所以，矩阵 $Z$ 为：\n$$ Z = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix} $$\n\n现在，我们构成简约 Hessian 矩阵 $R = Z^{\\top} H Z$。这是一个 $1 \\times 1$ 的矩阵。\n首先，我们计算乘积 $HZ$：\n$$ HZ = \\begin{pmatrix} 4  1  0 \\\\ 1  3  0 \\\\ 0  0  2 \\end{pmatrix} \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 4(-1) + 1(1) \\\\ 1(-1) + 3(1) \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -3 \\\\ 2 \\\\ 0 \\end{pmatrix} $$\n接下来，我们计算 $Z^{\\top} (HZ)$：\n$$ R = Z^{\\top}HZ = \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -1  1  0 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -3 \\\\ 2 \\\\ 0 \\end{pmatrix} \\right) = \\frac{1}{2} ((-1)(-3) + (1)(2) + (0)(0)) = \\frac{1}{2}(3+2) = \\frac{5}{2} $$\n简约 Hessian 矩阵是 $1 \\times 1$ 矩阵 $R = [\\frac{5}{2}]$。\n\n严格局部极小值点的二阶充分条件表明简约 Hessian 矩阵必须是正定的。由于 $R$ 的唯一元素是 $\\frac{5}{2}  0$，所以 $R$ 是正定的。这证实了 $x^{\\star}$ 是一个严格局部极小值点。\n\n最后，题目要求我们找到简约 Hessian 矩阵 $R$ 的唯一特征值。对于一个 $1 \\times 1$ 的矩阵 $[a]$，其特征值就是 $a$ 本身。\n因此， $R = [\\frac{5}{2}]$ 的特征值为 $\\frac{5}{2}$。", "answer": "$$\\boxed{\\frac{5}{2}}$$", "id": "3166499"}, {"introduction": "并非所有的优化问题都存在可行解；当约束条件相互矛盾时，可行集可能为空。这个练习探讨了对偶理论的强大应用，通过构建一个不可行二次规划的对偶问题，你将学习如何生成一个“Farkas 引理”类型的不可行性证书，从而为原始问题无解提供一个严格的数学证明 [@problem_id:3166488]。", "problem": "考虑以下凸二次规划（QP）问题，其目标函数是严格凸的，且线性不等式约束可能是矛盾的：\n在 $x \\in \\mathbb{R}^{2}$ 上最小化函数 $f(x) = \\tfrac{1}{2}\\|x\\|_{2}^{2}$，约束条件为两个线性不等式\n$x_{1} + x_{2} \\leq 0$ 和 $-x_{1} - x_{2} \\leq -1$。\n令 $A \\in \\mathbb{R}^{2 \\times 2}$ 和 $b \\in \\mathbb{R}^{2}$ 分别表示将约束收集为标准形式 $A x \\leq b$ 的矩阵和向量，其中第一行对应于 $x_{1} + x_{2} \\leq 0$，第二行对应于 $-x_{1} - x_{2} \\leq -1$。\n\n任务：\n1) 从拉格朗日函数和拉格朗日对偶函数的基本定义出发，推导此 QP 的对偶问题。利用弱对偶原理论证原问题的（不）可行性，并找出一个对偶变量的可行射线，在该射线上对偶目标函数无界增长。由此，提取一个 Farkas 型不可行性证书，即一个非零向量 $y \\in \\mathbb{R}^{2}$，满足 $y \\geq 0$，$A^{\\top} y = 0$ 和 $b^{\\top} y  0$。\n\n2) 为消除证书的尺度模糊性，施加归一化条件 $b^{\\top} y = -1$，并在所有此类证书上最小化 $\\|y\\|_{2}$。显式计算出唯一的结果向量 $y$。\n\n3) 从由约束定义的两个半空间以及它们的外法线向量的锥组合的角度，对该证书进行几何解释。\n\n答案规格：仅提供任务 2 中得到的向量作为最终答案，写成单个行向量。无需四舍五入。", "solution": "该问题要求分析一个不可行的凸二次规划（QP）。我们必须首先验证问题陈述，如果其有效，则继续执行任务。该问题在数学上是良定义的且内部一致；约束中的明显矛盾是故意的，也是问题的核心，其重点在于生成一个不可行性证书。因此，该问题是有效的。\n\n该 QP 问题如下：\n在 $x \\in \\mathbb{R}^{2}$ 上最小化 $f(x) = \\frac{1}{2}\\|x\\|_{2}^{2} = \\frac{1}{2}x^{\\top}x$，约束条件为：\n$1. \\quad x_{1} + x_{2} \\leq 0$\n$2. \\quad -x_{1} - x_{2} \\leq -1$\n\n这些约束可以写成标准形式 $Ax \\leq b$。$A$ 和 $b$ 的第一行对应第一个约束，第二行对应第二个约束。\n矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$ 和向量 $b \\in \\mathbb{R}^{2}$ 为：\n$$ A = \\begin{pmatrix} 1  1 \\\\ -1  -1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} $$\n第二个约束 $-x_{1} - x_{2} \\leq -1$ 等价于 $x_{1} + x_{2} \\geq 1$。可行集要求 $x_1+x_2$ 同时小于等于 $0$ 且大于等于 $1$，这是不可能的。因此，原问题是不可行的。\n\n**任务 1：对偶问题与不可行性证书**\n\n我们首先为此 QP 构建拉格朗日函数。设 $y = (y_1, y_2)^{\\top} \\in \\mathbb{R}^2$ 为拉格朗日乘子向量。拉格朗日函数为：\n$$ L(x, y) = f(x) + y^{\\top}(Ax - b) = \\frac{1}{2}x^{\\top}x + y^{\\top}Ax - y^{\\top}b $$\n拉格朗日函数的定义域为 $x \\in \\mathbb{R}^2$ 和 $y \\in \\mathbb{R}^2$，其中对于对偶问题，我们有一个隐含约束，即要求 $y \\geq 0$（分量级，即 $y_1 \\ge 0, y_2 \\ge 0$）。\n\n拉格朗日对偶函数 $g(y)$ 是 $L(x, y)$ 关于 $x$ 的下确界：\n$$ g(y) = \\inf_{x \\in \\mathbb{R}^2} L(x, y) $$\n由于 $L(x, y)$ 是关于 $x$ 的严格凸二次函数，其下确界在梯度关于 $x$ 为零处取得：\n$$ \\nabla_x L(x, y) = x + A^{\\top}y = 0 $$\n这给出了唯一的最小化点 $x^{*}(y) = -A^{\\top}y$。将其代回拉格朗日函数，得到对偶函数：\n$$ g(y) = \\frac{1}{2}(-A^{\\top}y)^{\\top}(-A^{\\top}y) + y^{\\top}A(-A^{\\top}y) - y^{\\top}b $$\n$$ g(y) = \\frac{1}{2}y^{\\top}A A^{\\top}y - y^{\\top}A A^{\\top}y - y^{\\top}b $$\n$$ g(y) = -\\frac{1}{2}y^{\\top}A A^{\\top}y - b^{\\top}y $$\n对偶问题是在乘子的非负约束下最大化 $g(y)$：\n$$ \\max_{y \\geq 0} \\left( -\\frac{1}{2}y^{\\top}A A^{\\top}y - b^{\\top}y \\right) $$\n我们来计算矩阵 $A A^{\\top}$：\n$$ A^{\\top} = \\begin{pmatrix} 1  -1 \\\\ 1  -1 \\end{pmatrix} $$\n$$ A A^{\\top} = \\begin{pmatrix} 1  1 \\\\ -1  -1 \\end{pmatrix} \\begin{pmatrix} 1  -1 \\\\ 1  -1 \\end{pmatrix} = \\begin{pmatrix} 2  -2 \\\\ -2  2 \\end{pmatrix} $$\n根据弱对偶原理，对偶问题的最优值是原问题最优值的一个下界。由于原问题不可行，其最优值形式上为 $+\\infty$。根据 QP 的强对偶定理，如果原问题不可行，则对偶问题要么不可行，要么无界。因为 $y=0$ 是对偶问题的一个可行点，所以对偶问题必然是无界的，即其最优值为 $+\\infty$。\n\n一个无界的对偶目标表明存在一个射线 $\\{y_0 + s d \\mid s \\to \\infty\\}$（其中 $d \\ge 0$），沿着该射线 $g(y)$ 无限增大。要使对偶目标无界，必须存在一个方向 $d \\neq 0$，使得 $d \\geq 0$，$A A^{\\top}d$ 以一种特殊方式与 $d$ 相关，并且 $-b^{\\top}d  0$。更确切地说，如果我们代入 $y=sd$（对于 $s0$），则 $g(sd) = -s^2 (\\frac{1}{2} d^\\top AA^\\top d) - s(b^\\top d)$。要使此表达式在 $s \\to \\infty$ 时趋于 $+\\infty$，二次项必须为非正，而线性项必须为正。这要求 $d^\\top A A^\\top d=0$ 且 $b^\\top d  0$。\n条件 $d^\\top A A^\\top d = \\|A^\\top d\\|_2^2 = 0$ 意味着 $A^\\top d = 0$。\n因此，我们寻求一个方向 $d$，它是一个 Farkas 型不可行性证书，满足：\n$1. \\quad d \\ge 0$\n$2. \\quad A^{\\top}d = 0$\n$3. \\quad b^{\\top}d  0$\n\n让我们找到这样一个向量，根据问题陈述我们称之为 $y$。从 $A^{\\top}y = 0$ 可得：\n$$ \\begin{pmatrix} 1  -1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = \\begin{pmatrix} y_1 - y_2 \\\\ y_1 - y_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n这意味着 $y_1 = y_2$。因此，任何这样的向量 $y$ 都必须具有形式 $y = (s, s)^{\\top}$，其中 $s$ 为某个标量。\n条件 $y \\geq 0$ 要求 $s \\ge 0$。由于我们寻找的是一个非零向量，我们需要 $s  0$。\n条件 $b^{\\top}y  0$ 变为：\n$$ b^{\\top}y = \\begin{pmatrix} 0  -1 \\end{pmatrix} \\begin{pmatrix} s \\\\ s \\end{pmatrix} = -s  0 $$\n这对任何 $s  0$ 都成立。\n因此，任何形式为 $y = (s, s)^{\\top}$ 且 $s  0$ 的向量都是一个 Farkas 型不可行性证书。对偶变量的射线是 $y = (s,s)^{\\top}$，其中 $s  0$。沿着这条射线，$A^\\top y = 0$，因此 $AA^\\top y = 0$，对偶目标函数为 $g(y) = -b^\\top y = s$，当 $s \\to \\infty$ 时，它增长到 $\\infty$。\n\n**任务 2：归一化证书**\n\n我们被要求通过施加归一化条件 $b^{\\top}y = -1$ 然后最小化 $\\|y\\|_2$ 来找到一个唯一的证书。\n证书集合由 $y \\ge 0$，$A^\\top y=0$ 描述。如前所述，这个集合是 $\\{ (s,s)^\\top \\mid s  0 \\}$。\n我们对向量 $y = (s, s)^{\\top}$ 施加归一化条件：\n$$ b^{\\top}y = -s = -1 \\implies s = 1 $$\n这个归一化从证书射线中选出了一个唯一的向量：$y = (1, 1)^{\\top}$。\n我们来验证这个向量：\n- $y = (1, 1)^{\\top} \\ge 0$: 成立。\n- $A^{\\top}y = \\begin{pmatrix} 1  -1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$: 成立。\n- $b^{\\top}y = \\begin{pmatrix} 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = -1$: 成立，且此值小于 $0$。\n\n问题接着要求在所有满足归一化条件的证书上最小化 $\\|y\\|_2$。由于满足 ($y \\ge 0, A^\\top y = 0, b^\\top y = -1$) 的向量集合是一个仅包含向量 $(1, 1)^{\\top}$ 的单点集，最小化是平凡的。得到的唯一向量是 $y = (1, 1)^{\\top}$。\n\n**任务 3：几何解释**\n\n这两个线性不等式在 $\\mathbb{R}^2$ 中定义了两个闭半空间：\n$H_1: \\{ x \\in \\mathbb{R}^2 \\mid x_1 + x_2 \\le 0 \\}$\n$H_2: \\{ x \\in \\mathbb{R}^2 \\mid -x_1 - x_2 \\le -1 \\} \\equiv \\{ x \\in \\mathbb{R}^2 \\mid x_1 + x_2 \\ge 1 \\}$\n$H_1$ 的边界是直线 $x_1+x_2 = 0$，而 $H_2$ 的边界是直线 $x_1+x_2 = 1$。它们是平行线。QP 的可行集是 $H_1 \\cap H_2$ 的交集，该交集为空。\n\n一个 Farkas 证书 $y=(y_1, y_2)^\\top$ 为不等式的线性组合提供了权重，从而证明了这种空集性。证书的条件是 $y \\ge 0$，$A^\\top y = \\sum_{i=1}^2 y_i a_i = 0$ 和 $b^\\top y = \\sum_{i=1}^2 y_i b_i  0$。这里，$a_1=(1,1)^\\top$ 和 $a_2=(-1,-1)^\\top$ 是约束边界的法向量。\n证书 $y=(1,1)^\\top$ 满足这些条件：\n- $y_1=1 \\ge 0, y_2=1 \\ge 0$。\n- $A^\\top y = 1 \\cdot \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + 1 \\cdot \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。这表明法向量（它们指向各自半空间的外部）的一个非负组合之和为零。几何上，这两个法向量大小相等，方向相反。\n- $b^\\top y = 1 \\cdot (0) + 1 \\cdot (-1) = -1  0$。\n\n如果我们假设存在一个可行点 $x$，那么 $a_1^\\top x \\le b_1$ 和 $a_2^\\top x \\le b_2$。分别乘以 $y_1=1$ 和 $y_2=1$ 并求和，得到：$y_1(a_1^\\top x) + y_2(a_2^\\top x) \\le y_1 b_1 + y_2 b_2$。这可以简化为 $(y_1 a_1 + y_2 a_2)^\\top x \\le b^\\top y$。利用证书的性质，这变为 $(0)^\\top x \\le -1$，即 $0 \\le -1$。这是一个矛盾，从而证明了原问题的不可行性。证书 $y = (1, 1)^{\\top}$ 对应于简单地将两个原始不等式相加，这直接得出了矛盾 $0 \\le -1$。\n\n最终答案是任务 2 中得到的显式向量。计算出的向量是 $y = (1, 1)^{\\top}$。要求的输出格式是行向量。", "answer": "$$ \\boxed{ \\begin{pmatrix} 1  1 \\end{pmatrix} } $$", "id": "3166488"}, {"introduction": "在实际应用中，优化问题的参数往往会发生变化。理解最优解如何响应这些数据扰动——即灵敏度分析——是至关重要的。本练习将向你展示如何从 KKT 条件出发，推导出一个二次规划问题的解对于约束右端项扰动的线性灵敏度，这对于评估解的鲁棒性和进行参数研究具有重要意义 [@problem_id:3179267]。", "problem": "考虑带有决策变量 $x \\in \\mathbb{R}^{3}$ 的等式约束二次规划问题：\n$$\\min_{x \\in \\mathbb{R}^{3}} \\ \\frac{1}{2} x^{\\top} Q x \\quad \\text{subject to} \\quad A x = b,$$\n其中 $Q \\in \\mathbb{R}^{3 \\times 3}$ 是对称正定矩阵，$A \\in \\mathbb{R}^{2 \\times 3}$ 是满行秩矩阵，$b \\in \\mathbb{R}^{2}$。设\n$$Q = \\begin{pmatrix} 2  0  0 \\\\ 0  3  0 \\\\ 0  0  5 \\end{pmatrix}, \\quad A = \\begin{pmatrix} 1  2  0 \\\\ 0  1  1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 3 \\\\ 2 \\end{pmatrix}.$$\n定义扰动路径为 $b(\\varepsilon) = b + \\varepsilon d$，方向为 $d = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$，标量参数为 $\\varepsilon \\in \\mathbb{R}$。\n\n从第一性原理出发——具体来说，利用严格凸二次函数的性质和等式约束凸规划的卡鲁什-库恩-塔克（Karush-Kuhn-Tucker, KKT）最优性条件——推导出最优解 $x^{\\star}(b)$ 作为右端项 $b$ 的函数。利用此推导来确定 $x^{\\star}(b(\\varepsilon))$ 在 $\\varepsilon = 0$ 处关于 $\\varepsilon$ 的线性灵敏度。\n\n计算方向导数 $\\frac{d}{d\\varepsilon} \\, x^{\\star}_{1}(b(\\varepsilon)) \\big|_{\\varepsilon=0}$，其中 $x^{\\star}_{1}$ 表示 $x^{\\star}$ 的第一个分量。以精确值（无四舍五入）表示您的最终答案。", "solution": "这是一个带有线性等式约束的凸优化问题。卡鲁什-库恩-塔克（KKT）条件是最优性的充要条件。我们首先构造拉格朗日函数，其中 $\\nu \\in \\mathbb{R}^2$ 是约束 $Ax=b$ 的拉格朗日乘子向量：\n$$ L(x, \\nu) = \\frac{1}{2} x^{\\top} Q x - \\nu^{\\top}(Ax - b) $$\n一阶KKT条件通过将拉格朗日函数对 $x$ 的梯度设为零（平稳性条件）和强制执行原始约束（原始可行性）得到：\n$$ \\nabla_x L(x^{\\star}, \\nu^{\\star}) = Qx^{\\star} - A^{\\top}\\nu^{\\star} = 0 $$\n$$ \\nabla_\\nu L(x^{\\star}, \\nu^{\\star}) = -(Ax^{\\star} - b) = 0 \\implies Ax^{\\star} = b $$\n这为最优原始-对偶对 $(x^{\\star}, \\nu^{\\star})$ 构成了一个线性方程组：\n$$ \\begin{pmatrix} Q  -A^{\\top} \\\\ A  0 \\end{pmatrix} \\begin{pmatrix} x^{\\star} \\\\ \\nu^{\\star} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ b \\end{pmatrix} $$\n从第一个方程 $Qx^{\\star} = A^{\\top}\\nu^{\\star}$，由于 $Q$ 是对称正定的，因此它是可逆的。于是，我们可以用 $\\nu^{\\star}$ 表示 $x^{\\star}$：\n$$ x^{\\star} = Q^{-1}A^{\\top}\\nu^{\\star} $$\n将此代入第二个方程 $Ax^{\\star}=b$：\n$$ A(Q^{-1}A^{\\top}\\nu^{\\star}) = b $$\n矩阵 $S = AQ^{-1}A^{\\top}$ 是 $Q$ 在KKT矩阵中的舒尔补。由于 $A$ 满行秩且 $Q^{-1}$ 是正定的，因此 $S$ 是对称正定的，故而是可逆的。我们可以解出 $\\nu^{\\star}$：\n$$ \\nu^{\\star}(b) = (AQ^{-1}A^{\\top})^{-1}b $$\n将此结果代回 $x^{\\star}$ 的表达式，我们得到最优解 $x^{\\star}$ 作为右端项 $b$ 的显式函数：\n$$ x^{\\star}(b) = Q^{-1}A^{\\top}(AQ^{-1}A^{\\top})^{-1}b $$\n$x^{\\star}(b)$ 的表达式是关于 $b$ 的线性函数。现在，我们引入扰动后的右端项 $b(\\varepsilon) = b + \\varepsilon d$。最优解作为 $\\varepsilon$ 的函数是：\n$$ x^{\\star}(b(\\varepsilon)) = Q^{-1}A^{\\top}(AQ^{-1}A^{\\top})^{-1}(b + \\varepsilon d) $$\n$$ x^{\\star}(b(\\varepsilon)) = Q^{-1}A^{\\top}(AQ^{-1}A^{\\top})^{-1}b + \\varepsilon \\left( Q^{-1}A^{\\top}(AQ^{-1}A^{\\top})^{-1}d \\right) $$\n为了找到线性灵敏度，我们对 $\\varepsilon$ 求导：\n$$ \\frac{d}{d\\varepsilon} x^{\\star}(b(\\varepsilon)) = Q^{-1}A^{\\top}(AQ^{-1}A^{\\top})^{-1}d $$\n该导数相对于 $\\varepsilon$ 是一个常数，因此它在 $\\varepsilon=0$ 处的值是相同的。我们将此导数向量记为 $\\dot{x}^{\\star}$。现在我们用给定的数值计算这个向量。\n\n首先，我们计算所需的矩阵：\n$Q = \\begin{pmatrix} 2  0  0 \\\\ 0  3  0 \\\\ 0  0  5 \\end{pmatrix} \\implies Q^{-1} = \\begin{pmatrix} 1/2  0  0 \\\\ 0  1/3  0 \\\\ 0  0  1/5 \\end{pmatrix}$\n$A = \\begin{pmatrix} 1  2  0 \\\\ 0  1  1 \\end{pmatrix} \\implies A^{\\top} = \\begin{pmatrix} 1  0 \\\\ 2  1 \\\\ 0  1 \\end{pmatrix}$\n$d = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$\n\n接下来，我们计算矩阵 $S = AQ^{-1}A^{\\top}$：\n$$ AQ^{-1}A^{\\top} = \\begin{pmatrix} 1  2  0 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 1/2  0  0 \\\\ 0  1/3  0 \\\\ 0  0  1/5 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 2  1 \\\\ 0  1 \\end{pmatrix} $$\n$$ = \\begin{pmatrix} 1/2  2/3  0 \\\\ 0  1/3  1/5 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 2  1 \\\\ 0  1 \\end{pmatrix} $$\n$$ = \\begin{pmatrix} \\frac{1}{2}(1) + \\frac{2}{3}(2)  \\frac{2}{3}(1) \\\\ \\frac{1}{3}(2)  \\frac{1}{3}(1) + \\frac{1}{5}(1) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} + \\frac{4}{3}  \\frac{2}{3} \\\\ \\frac{2}{3}  \\frac{1}{3} + \\frac{1}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{3+8}{6}  \\frac{2}{3} \\\\ \\frac{2}{3}  \\frac{5+3}{15} \\end{pmatrix} = \\begin{pmatrix} 11/6  2/3 \\\\ 2/3  8/15 \\end{pmatrix} $$\n现在，我们计算逆矩阵 $S^{-1} = (AQ^{-1}A^{\\top})^{-1}$。$S$ 的行列式是：\n$$ \\det(S) = \\left(\\frac{11}{6}\\right)\\left(\\frac{8}{15}\\right) - \\left(\\frac{2}{3}\\right)\\left(\\frac{2}{3}\\right) = \\frac{88}{90} - \\frac{4}{9} = \\frac{44}{45} - \\frac{20}{45} = \\frac{24}{45} = \\frac{8}{15} $$\n逆矩阵是：\n$$ S^{-1} = \\frac{1}{8/15} \\begin{pmatrix} 8/15  -2/3 \\\\ -2/3  11/6 \\end{pmatrix} = \\frac{15}{8} \\begin{pmatrix} 8/15  -2/3 \\\\ -2/3  11/6 \\end{pmatrix} = \\begin{pmatrix} 1  -\\frac{15 \\cdot 2}{8 \\cdot 3} \\\\ -\\frac{15 \\cdot 2}{8 \\cdot 3}  \\frac{15 \\cdot 11}{8 \\cdot 6} \\end{pmatrix} = \\begin{pmatrix} 1  -5/4 \\\\ -5/4  55/16 \\end{pmatrix} $$\n现在，我们可以计算拉格朗日乘子的灵敏度 $\\dot{\\nu}^{\\star} = S^{-1}d$：\n$$ \\dot{\\nu}^{\\star} = \\begin{pmatrix} 1  -5/4 \\\\ -5/4  55/16 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} 1(1) + (-\\frac{5}{4})(-2) \\\\ (-\\frac{5}{4})(1) + (\\frac{55}{16})(-2) \\end{pmatrix} = \\begin{pmatrix} 1 + \\frac{5}{2} \\\\ -\\frac{5}{4} - \\frac{55}{8} \\end{pmatrix} = \\begin{pmatrix} \\frac{7}{2} \\\\ -\\frac{10}{8} - \\frac{55}{8} \\end{pmatrix} = \\begin{pmatrix} 7/2 \\\\ -65/8 \\end{pmatrix} $$\n最后，我们计算原始变量的灵敏度 $\\dot{x}^{\\star} = Q^{-1}A^{\\top}\\dot{\\nu}^{\\star}$：\n$$ \\dot{x}^{\\star} = Q^{-1}A^{\\top}\\dot{\\nu}^{\\star} = \\begin{pmatrix} 1/2  0  0 \\\\ 0  1/3  0 \\\\ 0  0  1/5 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 2  1 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 7/2 \\\\ -65/8 \\end{pmatrix} = \\begin{pmatrix} 1/2  0 \\\\ 2/3  1/3 \\\\ 0  1/5 \\end{pmatrix} \\begin{pmatrix} 7/2 \\\\ -65/8 \\end{pmatrix} $$\n$$ = \\begin{pmatrix} (\\frac{1}{2})(\\frac{7}{2}) \\\\ (\\frac{2}{3})(\\frac{7}{2}) + (\\frac{1}{3})(-\\frac{65}{8}) \\\\ (\\frac{1}{5})(-\\frac{65}{8}) \\end{pmatrix} $$\n$$ = \\begin{pmatrix} \\frac{7}{4} \\\\ \\frac{7}{3} - \\frac{65}{24} \\\\ -\\frac{13}{8} \\end{pmatrix} = \\begin{pmatrix} \\frac{7}{4} \\\\ \\frac{56}{24} - \\frac{65}{24} \\\\ -\\frac{13}{8} \\end{pmatrix} = \\begin{pmatrix} 7/4 \\\\ -9/24 \\\\ -13/8 \\end{pmatrix} = \\begin{pmatrix} 7/4 \\\\ -3/8 \\\\ -13/8 \\end{pmatrix} $$\n灵敏度向量为 $\\frac{d}{d\\varepsilon} x^{\\star}(b(\\varepsilon)) \\big|_{\\varepsilon=0} = \\begin{pmatrix} 7/4 \\\\ -3/8 \\\\ -13/8 \\end{pmatrix}$。\n问题要求的是该向量的第一个分量，即 $\\frac{d}{d\\varepsilon} \\, x^{\\star}_{1}(b(\\varepsilon)) \\big|_{\\varepsilon=0}$。\n$$ \\frac{d}{d\\varepsilon} \\, x^{\\star}_{1}(b(\\varepsilon)) \\big|_{\\varepsilon=0} = \\frac{7}{4} $$", "answer": "$$\\boxed{\\frac{7}{4}}$$", "id": "3179267"}]}