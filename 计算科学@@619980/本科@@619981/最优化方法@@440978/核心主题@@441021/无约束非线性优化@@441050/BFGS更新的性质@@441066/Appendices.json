{"hands_on_practices": [{"introduction": "BFGS方法的核心是割线条件 $B_{k+1}s_k = y_k$，它将观察到的函数曲率信息融入到新的Hessian近似中。这个练习将向您展示如何巧妙地利用这一基本属性来推导结果，而不是仅仅进行繁琐的矩阵求逆计算。通过这个过程，您将体会到理解算法内在属性比单纯套用公式更为重要和高效。[@problem_id:3166921]", "problem": "考虑一个二次连续可微函数 $f:\\mathbb{R}^{2}\\to\\mathbb{R}$ 的无约束最小化问题，该函数由二次模型 $f(x)=\\frac{1}{2}x^{\\top}A x$ 给出，其中 $A\\in\\mathbb{R}^{2\\times 2}$ 是对称正定矩阵，具体为\n$$\nA=\\begin{pmatrix}4  1 \\\\ 1  3\\end{pmatrix}.\n$$\n设 $x_{k}\\in\\mathbb{R}^{2}$ 为当前迭代点，且 $x_{k+1}=x_{k}+s_{k}$，其中给定的步长 $s_{k}\\in\\mathbb{R}^{2}$ 等于\n$$\ns_{k}=\\begin{pmatrix}-2 \\\\ 1\\end{pmatrix}.\n$$\n定义梯度变化 $y_{k}=\\nabla f(x_{k+1})-\\nabla f(x_{k})$。对于这个二次函数 $f$，我们知道 $\\nabla f(x)=A x$，因此 $y_{k}=A s_{k}$。设 $B_{k}\\in\\mathbb{R}^{2\\times 2}$ 是第 $k$ 次迭代时海森矩阵的一个对称正定近似，并设 $B_{k}=I$，其中 $I$ 是单位矩阵。使用 Broyden–Fletcher–Goldfarb–Shanno (BFGS) 更新的定义原则——对称性、割线条件 $B_{k+1}s_{k}=y_{k}$、以及在由 $B_{k}^{-1}$ 诱导的度量下与 $B_{k}$ 的偏差最小以保持正定性——直接从 $B_{k}$、$s_{k}$ 和 $y_{k}$ 构造 $B_{k+1}$。然后，建立与逆近似 $H_{k+1}=B_{k+1}^{-1}$ 的联系，并利用此联系计算标量\n$$\ns_{k}^{\\top}H_{k+1}y_{k}.\n$$\n将你的最终答案表示为一个实数。无需四舍五入。", "solution": "该问题要求我们考虑一个二次最小化问题，并对海森矩阵的近似执行一步 Broyden–Fletcher–Goldfarb–Shanno (BFGS) 更新。然后，我们需要计算一个特定的标量值。\n\n问题提供了以下数据和定义：\n目标函数是一个二次型 $f(x)=\\frac{1}{2}x^{\\top}A x$，其中 $x \\in \\mathbb{R}^{2}$。\n海森矩阵 $A$ 给出为 $A=\\begin{pmatrix}4  1 \\\\ 1  3\\end{pmatrix}$。该矩阵是对称正定的，因为其行列式为 $4 \\times 3 - 1 \\times 1 = 11 > 0$，且其迹为 $4+3=7>0$。\n从迭代点 $x_k$ 到 $x_{k+1}$ 的步长为 $s_k = x_{k+1} - x_k = \\begin{pmatrix}-2 \\\\ 1\\end{pmatrix}$。\n梯度变化为 $y_k = \\nabla f(x_{k+1}) - \\nabla f(x_k)$。对于给定的二次函数，梯度为 $\\nabla f(x) = A x$。因此，$y_k = A x_{k+1} - A x_k = A(x_{k+1}-x_k) = A s_k$。\n初始海森矩阵近似是单位矩阵，$B_k = I = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix}$。\n\n首先，我们计算梯度变化向量 $y_k$：\n$$\ny_k = A s_k = \\begin{pmatrix}4  1 \\\\ 1  3\\end{pmatrix} \\begin{pmatrix}-2 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}4(-2) + 1(1) \\\\ 1(-2) + 3(1)\\end{pmatrix} = \\begin{pmatrix}-7 \\\\ 1\\end{pmatrix}.\n$$\nBFGS 更新要求满足条件 $s_k^{\\top}y_k > 0$，以确保更新后的矩阵 $B_{k+1}$ 保持正定（在 $B_k$ 是正定的前提下）。我们验证这个条件：\n$$\ns_k^{\\top}y_k = \\begin{pmatrix}-2  1\\end{pmatrix} \\begin{pmatrix}-7 \\\\ 1\\end{pmatrix} = (-2)(-7) + (1)(1) = 14 + 1 = 15.\n$$\n由于 $15 > 0$，该条件得到满足。\n\n问题要求构造下一个海森矩阵近似 $B_{k+1}$。BFGS 更新公式为：\n$$\nB_{k+1} = B_k + \\frac{y_k y_k^{\\top}}{y_k^{\\top} s_k} - \\frac{B_k s_k s_k^{\\top} B_k}{s_k^{\\top} B_k s_k}.\n$$\n我们计算该公式所需的各个部分。我们有 $B_k=I$。\n向量 $B_k s_k$ 是：\n$$\nB_k s_k = I s_k = s_k = \\begin{pmatrix}-2 \\\\ 1\\end{pmatrix}.\n$$\n标量 $s_k^{\\top} B_k s_k$ 是：\n$$\ns_k^{\\top} B_k s_k = s_k^{\\top} I s_k = s_k^{\\top} s_k = (-2)^2 + 1^2 = 5.\n$$\n项 $y_k^{\\top}s_k$ 已经计算过，等于 $15$。\n\n现在我们构造两个秩一更新矩阵。\n第一个更新项是：\n$$\n\\frac{y_k y_k^{\\top}}{y_k^{\\top} s_k} = \\frac{1}{15} \\begin{pmatrix}-7 \\\\ 1\\end{pmatrix} \\begin{pmatrix}-7  1\\end{pmatrix} = \\frac{1}{15} \\begin{pmatrix}49  -7 \\\\ -7  1\\end{pmatrix}.\n$$\n第二个更新项是：\n$$\n\\frac{B_k s_k s_k^{\\top} B_k}{s_k^{\\top} B_k s_k} = \\frac{s_k s_k^{\\top}}{s_k^{\\top} s_k} = \\frac{1}{5} \\begin{pmatrix}-2 \\\\ 1\\end{pmatrix} \\begin{pmatrix}-2  1\\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix}4  -2 \\\\ -2  1\\end{pmatrix}.\n$$\n将这些代入 $B_{k+1}$ 的 BFGS 公式中：\n$$\nB_{k+1} = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} + \\frac{1}{15} \\begin{pmatrix}49  -7 \\\\ -7  1\\end{pmatrix} - \\frac{1}{5} \\begin{pmatrix}4  -2 \\\\ -2  1\\end{pmatrix}\n$$\n为了合并这些矩阵，我们使用公分母 $15$：\n$$\nB_{k+1} = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} + \\begin{pmatrix}49/15  -7/15 \\\\ -7/15  1/15\\end{pmatrix} - \\begin{pmatrix}12/15  -6/15 \\\\ -6/15  3/15\\end{pmatrix}\n$$\n$$\nB_{k+1} = \\begin{pmatrix}1 + 49/15 - 12/15  0 - 7/15 + 6/15 \\\\ 0 - 7/15 + 6/15  1 + 1/15 - 3/15\\end{pmatrix} = \\begin{pmatrix}(15+49-12)/15  -1/15 \\\\ -1/15  (15+1-3)/15\\end{pmatrix}\n$$\n$$\nB_{k+1} = \\begin{pmatrix}52/15  -1/15 \\\\ -1/15  13/15\\end{pmatrix} = \\frac{1}{15}\\begin{pmatrix}52  -1 \\\\ -1  13\\end{pmatrix}.\n$$\n构造出 $B_{k+1}$ 后，接下来要求我们建立它与其逆矩阵 $H_{k+1} = B_{k+1}^{-1}$ 的联系，并用此联系来计算 $s_k^{\\top}H_{k+1}y_k$。\n\nBFGS 更新的一个基本定义性质是，新的海森矩阵近似 $B_{k+1}$ 必须满足割线条件：\n$$\nB_{k+1}s_k = y_k.\n$$\n此条件确保新的二次模型的梯度与沿步长 $s_k$ 方向上观察到的梯度变化相匹配。\n\n设 $H_{k+1}$ 是 $B_{k+1}$ 的逆矩阵，即 $H_{k+1} = B_{k+1}^{-1}$。由于 $B_{k+1}$ 是对称正定的，其逆矩阵存在且也是对称正定的。我们可以用 $H_{k+1}$ 左乘割线条件：\n$$\nH_{k+1}(B_{k+1}s_k) = H_{k+1}y_k.\n$$\n利用矩阵乘法的结合律和逆矩阵的定义 $H_{k+1}B_{k+1} = I$：\n$$\n(H_{k+1}B_{k+1})s_k = H_{k+1}y_k\n$$\n$$\nI s_k = H_{k+1}y_k\n$$\n$$\ns_k = H_{k+1}y_k.\n$$\n这个关系式，被称为逆割线条件，就是问题中所要求的“联系”。它是 BFGS 更新构造方式的直接结果。\n\n现在我们可以用这个结果来计算所要求的标量 $s_k^{\\top}H_{k+1}y_k$。我们将表达式 $s_k$ 代替 $H_{k+1}y_k$：\n$$\ns_k^{\\top}H_{k+1}y_k = s_k^{\\top}(H_{k+1}y_k) = s_k^{\\top}s_k.\n$$\n问题简化为计算向量 $s_k$ 的欧几里得范数的平方。\n$$\ns_k^{\\top}s_k = \\begin{pmatrix}-2  1\\end{pmatrix} \\begin{pmatrix}-2 \\\\ 1\\end{pmatrix} = (-2)^2 + (1)^2 = 4 + 1 = 5.\n$$\n因此，该标量表达式的值为 $5$。显式计算 $B_{k+1}$ 是一个中间步骤，用于展示对整个 BFGS 过程的理解，但最终答案可以通过利用更新的基本性质更巧妙地获得。", "answer": "$$\n\\boxed{5}\n$$", "id": "3166921"}, {"introduction": "分析算法的特殊或简化情况，往往能揭示其背后深刻的运行机制。本练习探讨了一个特殊场景：当梯度变化方向与位移方向平行时，BFGS更新会发生什么。通过解决这个问题，您将对Hessian逆矩阵的近似如何在特定子空间上进行缩放有一个清晰的几何直观认识。[@problem_id:3166918]", "problem": "考虑一个二次连续可微函数 $f:\\mathbb{R}^{n}\\to\\mathbb{R}$ 和一个拟牛顿迭代，该迭代形成步长 $s_{k}=x_{k+1}-x_{k}$ 和梯度差 $y_{k}=\\nabla f(x_{k+1})-\\nabla f(x_{k})$。假设使用 Broyden–Fletcher–Goldfarb–Shanno (BFGS) 逆方法将一个对称正定的逆海森矩阵近似 $H_{k}$ 更新为 $H_{k+1}$。假设曲率条件 $y_{k}^{\\top}s_{k}>0$ 成立，并且在这个特殊情况下，梯度差与步长平行，即对于某个标量 $c>0$，有 $y_{k}=c\\,s_{k}$。\n\n从 BFGS 逆更新的基本性质（割线条件 $H_{k+1}y_{k}=s_{k}$、对称性、在曲率条件下的正定性，以及编码了在割线条件下最小变化更新的标准 BFGS 逆公式）出发，分析 $H_{k+1}$ 如何作用于由 $s_{k}$ 张成的一维子空间中的向量。特别地，确定 $H_{k+1}$ 对任何与 $s_{k}$ 平行的向量进行重新缩放的确切标量。\n\n你的最终答案必须是关于 $c$ 的单个闭式解析表达式。无需数值近似。", "solution": "该问题要求在特定条件下，分析近似逆海森矩阵 $H_k$ 的 Broyden–Fletcher–Goldfarb–Shanno (BFGS) 逆更新。我们需要确定更新后的矩阵 $H_{k+1}$ 对平行于步长向量 $s_k$ 的向量进行重新缩放的缩放因子。\n\n首先，我们建立数学背景。给定一个二次连续可微函数 $f:\\mathbb{R}^{n}\\to\\mathbb{R}$。一次拟牛顿法的迭代产生步长 $s_{k} = x_{k+1} - x_{k}$ 和梯度差 $y_{k} = \\nabla f(x_{k+1}) - \\nabla f(x_{k})$。假设逆海森矩阵近似 $H_{k}$ 是对称正定的。从 $H_{k}$ 到 $H_{k+1}$ 的更新使用 BFGS 逆方法进行。我们已知曲率条件 $y_{k}^{\\top}s_{k}>0$ 成立。\n\n所给的特殊条件是梯度差向量 $y_k$ 与步长向量 $s_k$ 平行，这可以表示为 $y_{k}=c\\,s_{k}$，其中 $c>0$ 是一个标量。条件 $c>0$ 与曲率条件是一致的，因为 $y_{k}^{\\top}s_{k} = (c\\,s_{k})^{\\top}s_{k} = c\\,s_{k}^{\\top}s_{k} = c\\,\\|s_{k}\\|^{2}$，只要 $s_{k} \\neq 0$，该值就大于 0。\n\n我们的目标是找到一个标量 $\\lambda$，使得对于任何与 $s_k$ 平行的向量 $v$，方程 $H_{k+1}v = \\lambda v$ 成立。任何这样的向量 $v$ 都可以写成 $v = \\alpha s_{k}$，其中 $\\alpha \\in \\mathbb{R}$ 是一个标量。问题于是简化为求矩阵 $H_{k+1}$ 对应于特征向量 $s_k$ 的特征值 $\\lambda$，即找到满足 $H_{k+1}s_{k} = \\lambda s_{k}$ 的 $\\lambda$。\n\n问题陈述指导我们从 BFGS 逆更新的基本性质出发，其中之一就是割线条件。割线条件是施加在更新后的逆海森矩阵近似 $H_{k+1}$ 上的一个要求，以确保它恰当地包含了沿方向 $s_k$ 观察到的函数 $f$ 的曲率信息。该条件由下式给出：\n$$\nH_{k+1}y_{k} = s_{k}\n$$\n这个条件规定了 $H_{k+1}$ 在向量 $y_k$ 上的作用。我们可以直接利用这个性质以及特殊条件 $y_k = c s_k$ 来解决问题。\n\n将 $y_k = c s_k$ 代入割线方程，我们得到：\n$$\nH_{k+1}(c\\,s_{k}) = s_{k}\n$$\n根据矩阵-向量乘法的线性性质，标量 $c$ 可以被提出来：\n$$\nc\\,(H_{k+1}s_{k}) = s_{k}\n$$\n因为给定 $c>0$，我们可以用 $c$ 除以方程两边来分离出 $H_{k+1}s_{k}$ 项：\n$$\nH_{k+1}s_{k} = \\frac{1}{c}s_{k}\n$$\n这个方程表明 $s_{k}$ 是矩阵 $H_{k+1}$ 的一个特征向量，对应的特征值是 $\\frac{1}{c}$。\n\n现在，考虑由 $s_{k}$ 张成的一维子空间中的任何向量 $v$。这样的向量可以写成 $v = \\alpha s_{k}$，其中 $\\alpha$ 是某个标量。将 $H_{k+1}$ 应用于 $v$：\n$$\nH_{k+1}v = H_{k+1}(\\alpha s_{k}) = \\alpha (H_{k+1}s_{k}) = \\alpha \\left(\\frac{1}{c}s_{k}\\right) = \\frac{1}{c}(\\alpha s_{k}) = \\frac{1}{c}v\n$$\n这表明 $H_{k+1}$ 将任何与 $s_k$ 平行的向量按标量因子 $\\frac{1}{c}$ 进行重新缩放。\n\n为完整起见，并为确认此结果与完整的 BFGS 更新机制一致，我们可以分析标准的 BFGS 逆更新公式。正如问题所述，该公式编码了在割线条件约束下的最小变化性质。该公式为：\n$$\nH_{k+1} = \\left(I - \\frac{s_{k}y_{k}^{\\top}}{y_{k}^{\\top}s_{k}}\\right) H_{k} \\left(I - \\frac{y_{k}s_{k}^{\\top}}{y_{k}^{\\top}s_{k}}\\right) + \\frac{s_{k}s_{k}^{\\top}}{y_{k}^{\\top}s_{k}}\n$$\n其中 $I$ 是单位矩阵。我们将 $y_{k}=c\\,s_{k}$ 代入此公式。分母变为 $y_{k}^{\\top}s_{k} = c\\,s_{k}^{\\top}s_{k}$。括号中的项变为：\n$$\n\\frac{s_{k}y_{k}^{\\top}}{y_{k}^{\\top}s_{k}} = \\frac{s_{k}(c\\,s_{k})^{\\top}}{c\\,s_{k}^{\\top}s_{k}} = \\frac{c\\,s_{k}s_{k}^{\\top}}{c\\,s_{k}^{\\top}s_{k}} = \\frac{s_{k}s_{k}^{\\top}}{s_{k}^{\\top}s_{k}}\n$$\n我们定义投影矩阵 $P_{s_k} = \\frac{s_{k}s_{k}^{\\top}}{s_{k}^{\\top}s_{k}}$。更新公式简化为：\n$$\nH_{k+1} = (I - P_{s_k}) H_{k} (I - P_{s_k}) + \\frac{s_{k}s_{k}^{\\top}}{c\\,s_{k}^{\\top}s_{k}} = (I - P_{s_k}) H_{k} (I - P_{s_k}) + \\frac{1}{c}P_{s_k}\n$$\n现在，我们将这个算子 $H_{k+1}$ 应用到向量 $s_{k}$ 上：\n$$\nH_{k+1}s_{k} = \\left( (I - P_{s_k}) H_{k} (I - P_{s_k}) + \\frac{1}{c}P_{s_k} \\right) s_{k}\n$$\n我们将 $s_k$ 分配到各项中：\n$$\nH_{k+1}s_{k} = (I - P_{s_k}) H_{k} (I - P_{s_k})s_{k} + \\frac{1}{c}P_{s_k}s_{k}\n$$\n根据投影矩阵的定义， $P_{s_k}s_k = s_k$。因此，$(I - P_{s_k})s_k = s_k - P_{s_k}s_k = s_k - s_k = 0$。\n将此代入方程，第一项消失：\n$$\nH_{k+1}s_{k} = (I - P_{s_k}) H_{k} (0) + \\frac{1}{c}(s_{k})\n$$\n$$\nH_{k+1}s_{k} = 0 + \\frac{1}{c}s_{k} = \\frac{1}{c}s_{k}\n$$\n这证实了我们直接从割线条件得到的结果。$H_{k+1}$ 对任何与 $s_k$ 平行的向量进行重新缩放的标量是 $\\frac{1}{c}$。", "answer": "$$\\boxed{\\frac{1}{c}}$$", "id": "3166918"}, {"introduction": "BFGS方法的一个关键优势是它能够在迭代过程中保持Hessian近似矩阵的正定性，这对于生成有效的下降方向至关重要。然而，在非凸区域，当曲率条件 $y_k^\\top s_k \\gt 0$ 不被满足时，这一宝贵性质可能会丢失。本练习将引导您模拟这种失败情况，并动手实践一种被称为“阻尼”（damping）的强大技术，以恢复更新的稳定性和正定性。[@problem_id:3167001]", "problem": "考虑定义在 $\\mathbb{R}^{2}$ 上的二次目标函数 $f(x) = \\frac{1}{2} x^{\\top} A x$，其中 $A = \\begin{pmatrix}1  0 \\\\ 0  -1\\end{pmatrix}$。设当前迭代点为 $x_{k} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$，下一个迭代点为 $x_{k+1} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$，因此 $s_{k} = x_{k+1} - x_{k}$。设当前的逆Hessian近似矩阵为 $H_{k} = I$，并定义 $B_{k} = H_{k}^{-1}$。\n\n任务：\n1. 验证点 $x = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$ 是 $f$ 的一个鞍点，并计算 $s_{k}$ 和 $y_{k} = \\nabla f(x_{k+1}) - \\nabla f(x_{k})$。证明 $y_{k}^{\\top} s_{k} \\le 0$。\n2. 使用Broyden–Fletcher–Goldfarb–Shanno (BFGS) 方法的无阻尼逆更新公式，根据 $H_{k}$、$s_{k}$ 和 $y_{k}$ 计算 $H_{k+1}$，并证明 $H_{k+1}$ 不是正定的。\n3. 为了恢复正定性，考虑一种阻尼策略，用阻尼向量 $\\bar{y}_{k} = \\theta y_{k} + (1 - \\theta) B_{k} s_{k}$ 替换 $y_{k}$，其中参数 $\\theta \\in (0,1]$。施加曲率条件 $s_{k}^{\\top} \\bar{y}_{k} = \\delta \\, s_{k}^{\\top} B_{k} s_{k}$，其中 $\\delta = \\frac{1}{5}$。确定满足此等式的 $(0,1]$ 中的最大值 $\\theta$，然后计算相应的阻尼更新 $H_{k+1}$ 以验证其正定性。\n\n答案规格：将 $\\theta$ 的值报告为最简精确有理数。无需四舍五入。", "solution": "该问题提法明确，且基于数值优化的原理，特别是关于拟牛顿法中Broyden–Fletcher–Goldfarb–Shanno (BFGS) 更新的性质。我们将给出完整解法。\n\n目标函数为 $f(x) = \\frac{1}{2} x^{\\top} A x$，对于 $x \\in \\mathbb{R}^{2}$，其中 $A = \\begin{pmatrix}1  0 \\\\ 0  -1\\end{pmatrix}$。这可以写作 $f(x_1, x_2) = \\frac{1}{2}(x_1^2 - x_2^2)$。\n\n### 任务1：鞍点和曲率条件\n\n首先，我们计算目标函数的梯度 $\\nabla f(x)$ 和Hessian矩阵 $\\nabla^2 f(x)$。\n梯度由 $\\nabla f(x) = A x = \\begin{pmatrix}1  0 \\\\ 0  -1\\end{pmatrix} \\begin{pmatrix}x_1 \\\\ x_2\\end{pmatrix} = \\begin{pmatrix}x_1 \\\\ -x_2\\end{pmatrix}$ 给出。\nHessian矩阵是常数矩阵 $\\nabla^2 f(x) = A = \\begin{pmatrix}1  0 \\\\ 0  -1\\end{pmatrix}$。\n\n为验证 $x = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$ 是一个鞍点，我们检查一阶和二阶条件。\n1.  在 $x = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$ 处的梯度是 $\\nabla f(\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}) = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$，证实了它是一个临界点。\n2.  Hessian矩阵 $A$ 的特征值为 $\\lambda_1 = 1$ 和 $\\lambda_2 = -1$。由于特征值异号，该Hessian矩阵是不定的。具有不定Hessian矩阵的临界点是鞍点。\n\n接下来，我们计算向量 $s_k$ 和 $y_k$。\n迭代点给定为 $x_{k} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$ 和 $x_{k+1} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$。\n步长向量 $s_k$ 定义为 $s_{k} = x_{k+1} - x_{k}$：\n$$s_k = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} - \\begin{pmatrix}0 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$$\n向量 $y_k$ 定义为梯度的变化量，$y_{k} = \\nabla f(x_{k+1}) - \\nabla f(x_{k})$。\n$\\nabla f(x_{k}) = \\nabla f(\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}) = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。\n$\\nabla f(x_{k+1}) = \\nabla f(\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}) = \\begin{pmatrix}0 \\\\ -1\\end{pmatrix}$。\n因此，\n$$y_k = \\begin{pmatrix}0 \\\\ -1\\end{pmatrix} - \\begin{pmatrix}0 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}0 \\\\ -1\\end{pmatrix}$$\n现在我们检查曲率 $y_k^\\top s_k$ 的符号：\n$$y_k^\\top s_k = \\begin{pmatrix}0  -1\\end{pmatrix} \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} = (0)(0) + (-1)(1) = -1$$\n由于 $y_k^\\top s_k = -1 \\le 0$，BFGS方法的标准曲率条件（要求 $y_k^\\top s_k > 0$ 以保证更新后的Hessian近似矩阵的正定性）未被满足。\n\n### 任务2：无阻尼BFGS更新\n\nBFGS逆更新公式为：\n$$H_{k+1} = \\bigl(I - \\rho_k s_k y_k^{\\top}\\bigr)\\, H_k\\, \\bigl(I - \\rho_k y_k s_k^{\\top}\\bigr) + \\rho_k s_k s_k^{\\top}$$\n我们给定的初始逆Hessian近似矩阵为 $H_k = I = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix}$。我们有 $s_k^\\top y_k = -1$。设 $\\rho_k = 1/(s_k^\\top y_k) = -1$。我们计算更新所需的各个部分：\n$s_k s_k^\\top = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} \\begin{pmatrix}0  1\\end{pmatrix} = \\begin{pmatrix}0  0 \\\\ 0  1\\end{pmatrix}$。\n$s_k y_k^\\top = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} \\begin{pmatrix}0  -1\\end{pmatrix} = \\begin{pmatrix}0  0 \\\\ 0  -1\\end{pmatrix}$。\n$I - \\rho_k s_k y_k^\\top = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} - (-1)\\begin{pmatrix}0  0 \\\\ 0  -1\\end{pmatrix} = \\begin{pmatrix}1  0 \\\\ 0  0\\end{pmatrix}$。\n由于 $H_k=I$ 且更新公式对称，将各部分代入得到：\n$$H_{k+1} = \\begin{pmatrix}1  0 \\\\ 0  0\\end{pmatrix} \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} \\begin{pmatrix}1  0 \\\\ 0  0\\end{pmatrix} + (-1)\\begin{pmatrix}0  0 \\\\ 0  1\\end{pmatrix} = \\begin{pmatrix}1  0 \\\\ 0  0\\end{pmatrix} - \\begin{pmatrix}0  0 \\\\ 0  1\\end{pmatrix} = \\begin{pmatrix}1  0 \\\\ 0  -1\\end{pmatrix}$$\n为了检查 $H_{k+1}$ 是否为正定，我们使用Sylvester判据。所有主子式必须为正。\n一阶主子式为 $H_{11} = 1 > 0$。\n二阶主子式为 $\\det(H_{k+1}) = (1)(-1) - (0)(0) = -1$。\n由于行列式为负，$H_{k+1}$ 不是正定的。\n\n### 任务3：阻尼BFGS更新\n\n为了恢复正定性，我们使用阻尼策略。向量 $y_k$ 被 $\\bar{y}_k = \\theta y_k + (1-\\theta) B_k s_k$ 替换，其中 $\\theta \\in (0, 1]$。给定 $H_k = I$，所以它的逆，即直接Hessian近似矩阵，是 $B_k = H_k^{-1} = I$。\n阻尼向量变为 $\\bar{y}_k = \\theta y_k + (1-\\theta) s_k$。\n\n参数 $\\theta$ 通过施加修正的曲率条件 $s_k^\\top \\bar{y}_k = \\delta s_k^\\top B_k s_k$（其中 $\\delta = \\frac{1}{5}$）来确定。\n代入 $\\bar{y}_k$ 和 $B_k=I$ 的表达式：\n$$s_k^\\top (\\theta y_k + (1-\\theta) s_k) = \\frac{1}{5} s_k^\\top s_k$$\n展开左侧得到：\n$$\\theta (s_k^\\top y_k) + (1-\\theta) (s_k^\\top s_k) = \\frac{1}{5} (s_k^\\top s_k)$$\n我们有之前计算出的值 $s_k^\\top y_k = -1$ 和 $s_k^\\top s_k = \\begin{pmatrix}0  1\\end{pmatrix}\\begin{pmatrix}0 \\\\ 1\\end{pmatrix} = 1$。\n将这些值代入关于 $\\theta$ 的方程：\n$$\\theta(-1) + (1-\\theta)(1) = \\frac{1}{5}(1)$$\n$$-\\theta + 1 - \\theta = \\frac{1}{5}$$\n$$1 - 2\\theta = \\frac{1}{5}$$\n$$2\\theta = 1 - \\frac{1}{5} = \\frac{4}{5}$$\n$$\\theta = \\frac{2}{5}$$\n该值位于指定区间 $(0, 1]$ 内，因此是所要求的值。\n\n现在我们使用这个 $\\theta$ 计算 $H_{k+1}$ 的阻尼更新。\n首先，我们求出阻尼向量 $\\bar{y}_k$：\n$$\\bar{y}_k = \\frac{2}{5} y_k + \\left(1-\\frac{2}{5}\\right) s_k = \\frac{2}{5} \\begin{pmatrix}0 \\\\ -1\\end{pmatrix} + \\frac{3}{5} \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}0 \\\\ -2/5\\end{pmatrix} + \\begin{pmatrix}0 \\\\ 3/5\\end{pmatrix} = \\begin{pmatrix}0 \\\\ 1/5\\end{pmatrix}$$\n新的曲率项是 $s_k^\\top \\bar{y}_k = \\begin{pmatrix}0  1\\end{pmatrix} \\begin{pmatrix}0 \\\\ 1/5\\end{pmatrix} = \\frac{1}{5}$。这是正的，符合要求。\n\n我们应用带有 $\\bar{y}_k$ 的BFGS更新公式：\n$$H_{k+1} = \\bigl(I - \\bar{\\rho}_k s_k \\bar{y}_k^{\\top}\\bigr)\\, H_k\\, \\bigl(I - \\bar{\\rho}_k \\bar{y}_k s_k^{\\top}\\bigr) + \\bar{\\rho}_k s_k s_k^{\\top}$$\n我们有 $s_k^\\top \\bar{y}_k = 1/5$。设 $\\bar{\\rho}_k = 1/(s_k^\\top \\bar{y}_k) = 5$。我们计算更新所需的各个部分：\n$s_k s_k^\\top = \\begin{pmatrix}0  0 \\\\ 0  1\\end{pmatrix}$。\n$s_k \\bar{y}_k^\\top = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} \\begin{pmatrix}0  1/5\\end{pmatrix} = \\begin{pmatrix}0  0 \\\\ 0  1/5\\end{pmatrix}$。\n$I - \\bar{\\rho}_k s_k \\bar{y}_k^\\top = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} - 5\\begin{pmatrix}0  0 \\\\ 0  1/5\\end{pmatrix} = \\begin{pmatrix}1  0 \\\\ 0  0\\end{pmatrix}$。\n将各部分代入更新公式：\n$$H_{k+1} = \\begin{pmatrix}1  0 \\\\ 0  0\\end{pmatrix} \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} \\begin{pmatrix}1  0 \\\\ 0  0\\end{pmatrix} + 5 \\begin{pmatrix}0  0 \\\\ 0  1\\end{pmatrix} = \\begin{pmatrix}1  0 \\\\ 0  0\\end{pmatrix} + \\begin{pmatrix}0  0 \\\\ 0  5\\end{pmatrix} = \\begin{pmatrix}1  0 \\\\ 0  5\\end{pmatrix}$$\n为验证该矩阵是正定的，我们检查其特征值，即对角线元素 $1$ 和 $5$。由于两者均为正，该矩阵是正定的。或者，主子式为 $1>0$ 和 $\\det(H_{k+1}) = 5 > 0$，也证实了其正定性。\n\n确定的 $\\theta$ 的值为 $\\frac{2}{5}$。", "answer": "$$\\boxed{\\frac{2}{5}}$$", "id": "3167001"}]}