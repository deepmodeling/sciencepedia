{"hands_on_practices": [{"introduction": "对于光滑的等式约束，可行集在局部构成一个流形。任何有效的移动都必须与该流形“相切”，这在数学上由切空间来描述。本练习 [@problem_id:3128723] 提供了一个具体且可视化的例子，我们将亲手计算这个切空间，并在其中找到一个能够改进目标函数的方向。", "problem": "考虑一个等式约束优化问题，其目标函数为 $f(x) = x_{1}$，约束为 $h(x) = x_{1}^{2} + x_{2}^{2} - x_{1} = 0$。可行集是由 $h(x) = 0$ 定义的曲线，该曲线是非凸的。令 $x^{(0)} = \\left(\\frac{1}{2}, \\frac{1}{2}\\right)$，该点满足约束条件。\n\n利用 $h$ 的可微性以及等式约束的一阶可行性条件（即，与约束流形相切的方向必须满足线性化约束），计算点 $x^{(0)}$ 处的切空间，然后确定一个在 $x^{(0)}$ 处使 $f$ 一阶严格减小的可行下降方向。\n\n将最终答案以一个包含四个条目 $\\left(t_{1}, t_{2}, d_{1}, d_{2}\\right)$ 的行矩阵形式返回，其中 $(t_{1}, t_{2})$ 是点 $x^{(0)}$ 处的一个基切向量的分量，而 $(d_{1}, d_{2})$ 是在 $x^{(0)}$ 处 $f$ 的一个可行下降方向的分量。请提供精确值，不要四舍五入。", "solution": "用户希望我解决这个问题。\n\n### 步骤 1：问题验证\n\n我将首先验证问题陈述。\n\n#### 步骤 1.1：提取已知条件\n\n*   目标函数：$f(x) = x_{1}$\n*   等式约束：$h(x) = x_{1}^{2} + x_{2}^{2} - x_{1} = 0$\n*   评估点：$x^{(0)} = \\left(\\frac{1}{2}, \\frac{1}{2}\\right)$\n*   关于该点的条件：$x^{(0)}$ 满足约束 $h(x^{(0)}) = 0$。我们来验证一下：$h\\left(\\frac{1}{2}, \\frac{1}{2}\\right) = \\left(\\frac{1}{2}\\right)^{2} + \\left(\\frac{1}{2}\\right)^{2} - \\frac{1}{2} = \\frac{1}{4} + \\frac{1}{4} - \\frac{1}{2} = \\frac{1}{2} - \\frac{1}{2} = 0$。条件成立。\n*   任务 1：使用等式约束的一阶可行性条件 $\\nabla h(x^{(0)})^T d = 0$ 计算点 $x^{(0)}$ 处的切空间。\n*   任务 2：确定在点 $x^{(0)}$ 处 $f$ 的一个可行下降方向。这是一个位于切空间内且满足 $\\nabla f(x^{(0)})^T d  0$ 的方向 $d$。\n*   输出格式：一个行矩阵 $(t_1, t_2, d_1, d_2)$，其中 $(t_1, t_2)$ 是一个基切向量，而 $(d_1, d_2)$ 是一个可行下降方向。\n\n#### 步骤 1.2：使用提取的已知条件进行验证\n\n*   **科学或事实不健全性**：该问题是约束优化理论中的一个标准练习。目标函数、约束、切空间和下降方向等概念在数学上是合理的。无违反。\n*   **不可形式化或不相关**：该问题在多元微积分和优化方法的背景下是完全可以形式化的。它与可行方向和下降方向的主题直接相关。无违反。\n*   **设置不完整或矛盾**：所有必要的组成部分（函数 $f$ 和 $h$，以及点 $x^{(0)}$）都已提供并且是一致的。点 $x^{(0)}$ 已被确认在可行集内。无违反。\n*   **不切实际或不可行**：该问题纯属数学问题，不涉及物理量，因此此标准不适用。\n*   **不适定或结构不良**：该问题是适定的。正则点处的切空间是明确定义的。下降方向的存在性取决于可以计算的梯度。问题要求找到“一个”可行方向，这正确地暗示了可能存在的非唯一性。同样的情况也适用于切空间的基向量。无违反。\n*   **伪深刻、琐碎或同义反复**：该问题需要对优化理论中的定义和计算进行标准应用。这是一个不平凡但直接的问题。无违反。\n*   **超出科学可验证性**：该问题是数学问题，其解可通过逻辑推导和计算来验证。无违反。\n\n#### 步骤 1.3：结论与行动\n问题有效。我将继续进行解答。\n\n### 步骤 2：解答\n\n该问题要求两个主要部分：在约束流形上给定点处切空间的一个基向量，以及在该点处的一个可行下降方向。\n\n目标函数为 $f(x) = x_1$，其中 $x = (x_1, x_2)^T$。\n等式约束为 $h(x) = x_1^2 + x_2^2 - x_1 = 0$。\n我们关注的点是 $x^{(0)} = \\left(\\frac{1}{2}, \\frac{1}{2}\\right)$。\n\n**第 1 部分：计算点 $x^{(0)}$ 处的切空间**\n\n点 $x^{(0)}$ 处的切空间是所有与约束函数 $h(x)$ 在点 $x^{(0)}$ 处的梯度正交的方向 $d \\in \\mathbb{R}^2$ 的集合。它由方程 $\\nabla h(x^{(0)})^T d = 0$ 定义。\n\n首先，我们必须计算 $h(x)$ 的梯度：\n$$\n\\nabla h(x) = \\begin{pmatrix} \\frac{\\partial h}{\\partial x_1} \\\\ \\frac{\\partial h}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 2x_1 - 1 \\\\ 2x_2 \\end{pmatrix}\n$$\n接下来，我们在点 $x^{(0)} = \\left(\\frac{1}{2}, \\frac{1}{2}\\right)$ 处计算这个梯度：\n$$\n\\nabla h(x^{(0)}) = \\begin{pmatrix} 2\\left(\\frac{1}{2}\\right) - 1 \\\\ 2\\left(\\frac{1}{2}\\right) \\end{pmatrix} = \\begin{pmatrix} 1 - 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n切空间由所有满足以下条件的向量 $d=(d_1, d_2)^T$ 的集合定义：\n$$\n\\nabla h(x^{(0)})^T d = 0\n$$\n$$\n\\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = 0\n$$\n此矩阵乘法得出方程：\n$$\n0 \\cdot d_1 + 1 \\cdot d_2 = 0 \\implies d_2 = 0\n$$\n因此，切空间中的任何向量 $d$ 都必须是 $d = (d_1, 0)$ 的形式，其中 $d_1 \\in \\mathbb{R}$。切空间是 $\\mathbb{R}^2$ 的一个一维子空间。此空间的基可以是任何此种形式的非零向量。一个简单的基向量选择是令 $d_1=1$。\n令基切向量为 $t = (t_1, t_2) = (1, 0)$。\n\n**第 2 部分：确定点 $x^{(0)}$ 处的一个可行下降方向**\n\n一个方向 $d$ 是一个 *可行下降方向*，如果它满足两个条件：\n1. 它是一个可行方向，意味着它位于切空间内。根据第 1 部分，这表明 $d$ 必须是 $(d_1, 0)$ 的形式。\n2. 它是目标函数 $f$ 的一个下降方向，意味着 $f$ 沿 $d$ 的方向导数是负的。这表示为 $\\nabla f(x^{(0)})^T d  0$。\n\n首先，我们计算目标函数 $f(x) = x_1$ 的梯度：\n$$\n\\nabla f(x) = \\begin{pmatrix} \\frac{\\partial f}{\\partial x_1} \\\\ \\frac{\\partial f}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n$f$ 的梯度对于所有 $x$ 都是常数，因此 $\\nabla f(x^{(0)}) = (1, 0)^T$。\n\n现在，我们使用来自切空间的一般向量 $d = (d_1, 0)$ 应用下降条件：\n$$\n\\nabla f(x^{(0)})^T d  0\n$$\n$$\n\\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ 0 \\end{pmatrix}  0\n$$\n这给出了不等式：\n$$\n1 \\cdot d_1 + 0 \\cdot 0  0 \\implies d_1  0\n$$\n因此，任何满足 $d_1  0$ 的向量 $d = (d_1, 0)$ 都是点 $x^{(0)}$ 处的一个可行下降方向。问题要求找到一个这样的方向。一个简单的选择是令 $d_1 = -1$。\n一个有效的可行下降方向是 $d = (d_1, d_2) = (-1, 0)$。\n\n**结论**\n\n点 $x^{(0)}$ 处切空间的一个基向量是 $t = (t_1, t_2) = (1, 0)$。\n在点 $x^{(0)}$ 处 $f$ 的一个可行下降方向是 $d = (d_1, d_2) = (-1, 0)$。\n\n最终答案应以行矩阵 $(t_1, t_2, d_1, d_2)$ 的形式提供。\n代入我们找到的值：$(1, 0, -1, 0)$。\n\n从几何上看，约束 $h(x) = x_1^2 + x_2^2 - x_1 = 0$ 可以重写为 $(x_1 - 1/2)^2 + x_2^2 = (1/2)^2$，它描述了一个以 $(1/2, 0)$ 为中心、半径为 $1/2$ 的圆。点 $x^{(0)} = (1/2, 1/2)$ 是这个圆顶部的点。该点的切线是水平的，因此切向量的形式为 $(k, 0)$，这证实了我们的计算。目标函数是 $f(x)=x_1$，因此下降方向必须使 $x_1$ 减小。从点 $(1/2, 1/2)$ 出发，沿着水平切线移动以减小 $x_1$ 意味着向左移动。这对应于一个方向向量 $(d_1, 0)$，其中 $d_1  0$，这也证实了我们的结果。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  0  -1  0 \\end{pmatrix}}\n$$", "id": "3128723"}, {"introduction": "当处理不等式约束时，尤其是在可行域的边界点上，我们的移动自由度被限制在一个“可行方向锥”内。本练习 [@problem_id:3128694] 将挑战我们去精确定义这个锥，并在标准负梯度方向不可行时，找到锥内的最佳方向——最速可行下降方向。", "problem": "考虑 $\\mathbb{R}^{2}$ 中的约束优化问题：最小化 $f(x)$，约束条件为 $g_{i}(x) \\le 0$，其中 $i \\in \\{1,2,3\\}$，并且\n- $f(x) = x_{1} + x_{2}$,\n- $g_{1}(x) = x_{1} + x_{2} - 2 \\le 0$,\n- $g_{2}(x) = -x_{1} \\le 0$,\n- $g_{3}(x) = -x_{2} \\le 0$.\n\n令边界点为 $x^{\\ast} = (0,2)$。从约束优化的核心定义出发：\n- 如果对于在 $x^{\\ast}$ 处激活的每个约束，一阶变化满足 $\\nabla g_{i}(x^{\\ast})^{\\mathsf{T}} d \\le 0$，则方向 $d$ 是在 $x^{\\ast}$ 处的一个可行方向。\n- 如果 $\\nabla f(x^{\\ast})^{\\mathsf{T}} d  0$，则方向 $d$ 是函数 $f$ 在 $x^{\\ast}$ 处的一个下降方向。\n\n任务：\n- 识别在 $x^{\\ast}$ 处的激活约束集，并使用它们的梯度构建在 $x^{\\ast}$ 处的可行方向锥 $\\mathcal{C}(x^{\\ast})$。\n- 检验 $-\\nabla f(x^{\\ast})$ 是否位于 $\\mathcal{C}(x^{\\ast})$ 内。\n- 如果 $-\\nabla f(x^{\\ast}) \\notin \\mathcal{C}(x^{\\ast})$，通过求解以下小型二次规划（QP, Quadratic Program）问题来确定最陡可行下降方向：最小化 $\\nabla f(x^{\\ast})^{\\mathsf{T}} d$，约束条件为 $d \\in \\mathcal{C}(x^{\\ast})$ 且 $\\|d\\|_{2} \\le 1$。\n\n报告最优单位方向 $d^{\\ast}$ 相对于正 $x_{1}$ 轴的唯一角度 $\\theta$（以弧度为单位），取值 $\\theta \\in [-\\pi, \\pi)$。将您的最终答案表示为精确的实数（以弧度为单位）。无需四舍五入。最终的方框答案中不应出现单位。", "solution": "用户想要解决一个约束优化问题。\n\n这是我的计划：\n1.  **验证问题陈述。**\n    *   逐字提取所有给定信息。\n    *   检查科学合理性、自洽性和清晰度。该问题是一个标准的优化问题，因此应该是有效的。\n2.  **如果问题有效，则解决它。**\n    *   **步骤 1：识别激活约束。**\n        *   我有点 $x^{\\ast} = (0, 2)$。\n        *   我需要检查哪些约束 $g_i(x) \\le 0$ 是以等式形式满足的，即 $g_i(x^{\\ast}) = 0$。\n        *   $g_1(x) = x_1 + x_2 - 2$。在 $x^{\\ast}=(0,2)$ 处，$g_1(x^{\\ast}) = 0 + 2 - 2 = 0$。所以，$g_1$ 是激活的。\n        *   $g_2(x) = -x_1$。在 $x^{\\ast}=(0,2)$ 处，$g_2(x^{\\ast}) = -0 = 0$。所以，$g_2$ 是激活的。\n        *   $g_3(x) = -x_2$。在 $x^{\\ast}=(0,2)$ 处，$g_3(x^{\\ast}) = -2  0$。所以，$g_3$ 不是激活的。\n        *   在 $x^{\\ast}$ 处的激活约束集是 $I(x^{\\ast}) = \\{1, 2\\}$。\n\n    *   **步骤 2：构建可行方向锥。**\n        *   问题将 $x^{\\ast}$ 处的可行方向 $d$ 定义为对所有激活约束 $i \\in I(x^{\\ast})$ 都满足 $\\nabla g_i(x^{\\ast})^{\\mathsf{T}} d \\le 0$ 的方向。\n        *   我需要激活约束的梯度。\n        *   $f(x) = x_1 + x_2 \\implies \\nabla f(x) = (1, 1)^{\\mathsf{T}}$。所以，$\\nabla f(x^{\\ast}) = (1, 1)^{\\mathsf{T}}$。\n        *   $g_1(x) = x_1 + x_2 - 2 \\implies \\nabla g_1(x) = (1, 1)^{\\mathsf{T}}$。所以，$\\nabla g_1(x^{\\ast}) = (1, 1)^{\\mathsf{T}}$。\n        *   $g_2(x) = -x_1 \\implies \\nabla g_2(x) = (-1, 0)^{\\mathsf{T}}$。所以，$\\nabla g_2(x^{\\ast}) = (-1, 0)^{\\mathsf{T}}$。\n        *   令 $d = (d_1, d_2)^{\\mathsf{T}}$。$d$ 属于可行方向锥 $\\mathcal{C}(x^{\\ast})$ 的条件是：\n            *   $\\nabla g_1(x^{\\ast})^{\\mathsf{T}} d \\le 0 \\implies (1, 1) \\cdot (d_1, d_2) \\le 0 \\implies d_1 + d_2 \\le 0$。\n            *   $\\nabla g_2(x^{\\ast})^{\\mathsf{T}} d \\le 0 \\implies (-1, 0) \\cdot (d_1, d_2) \\le 0 \\implies -d_1 \\le 0 \\implies d_1 \\ge 0$。\n        *   所以，$\\mathcal{C}(x^{\\ast}) = \\{ d \\in \\mathbb{R}^2 \\mid d_1 + d_2 \\le 0 \\text{ 且 } d_1 \\ge 0 \\}$。\n\n    *   **步骤 3：检验 $-\\nabla f(x^{\\ast})$ 是否在 $\\mathcal{C}(x^{\\ast})$ 中。**\n        *   我们有 $\\nabla f(x^{\\ast}) = (1, 1)^{\\mathsf{T}}$。\n        *   令 $d_{SD} = -\\nabla f(x^{\\ast}) = (-1, -1)^{\\mathsf{T}}$。\n        *   检查 $d_{SD}$ 是否满足 $\\mathcal{C}(x^{\\ast})$ 的条件。\n            *   条件 1：$d_1 \\ge 0$。这里，$d_1 = -1$。这不满足。所以，$-1 \\ge 0$ 是假的。\n        *   因此，$-\\nabla f(x^{\\ast}) \\notin \\mathcal{C}(x^{\\ast})$。\n\n    *   **步骤 4：找到最陡可行下降方向。**\n        *   问题要求解这个 QP：\n            *   最小化 $\\nabla f(x^{\\ast})^{\\mathsf{T}} d$\n            *   约束条件为 $d \\in \\mathcal{C}(x^{\\ast})$ 且 $\\|d\\|_2 \\le 1$。\n        *   代入已知值：\n            *   最小化 $(1, 1)^{\\mathsf{T}} (d_1, d_2)^{\\mathsf{T}} = d_1 + d_2$\n            *   约束条件为：\n                1.  $d_1 + d_2 \\le 0$\n                2.  $d_1 \\ge 0$\n                3.  $d_1^2 + d_2^2 \\le 1$\n        *   我们希望使和 $d_1 + d_2$ 尽可能小（即，尽可能为负）。\n        *   根据条件 (1)，$d_1 + d_2$ 必须是非正的。\n        *   根据条件 (2)，$d_1$ 必须是非负的。\n        *   根据条件 (1)，$d_2 \\le -d_1$。因为 $d_1 \\ge 0$，这意味着 $d_2$ 必须是负数或零。\n        *   方向的可行集是锥 $\\mathcal{C}(x^{\\ast})$ 与以原点为中心的单位圆盘的交集。\n        *   锥 $\\mathcal{C}(x^{\\ast})$ 是 $d_1 \\ge 0$ 且 $d_2 \\le -d_1$ 的区域。这是第四象限中，介于负 $d_2$ 轴和直线 $d_1 + d_2 = 0$ 之间的楔形区域。边界射线沿着 $(0, -1)$ 和 $(1, -1)$。\n        *   向量 $(1, -1)$ 归一化后是 $\\frac{1}{\\sqrt{2}}(1, -1)$。我们称之为 $v_1$。其角度是 $-\\pi/4$。\n        *   向量 $(0, -1)$ 是一个单位向量。我们称之为 $v_2$。其角度是 $-\\pi/2$。\n        *   单位方向的可行集是单位圆上角度在 $-\\pi/2$ 和 $-\\pi/4$ 之间的圆弧。\n        *   我们需要找到这条圆弧上，使函数 $F(d_1, d_2) = d_1 + d_2$ 最小化的点 $(d_1, d_2)$。\n        *   令 $d_1 = \\cos\\phi$ 和 $d_2 = \\sin\\phi$。约束是 $d_1^2 + d_2^2 = 1$。\n        *   角度 $\\phi$ 的可行范围是 $[-\\pi/2, -\\pi/4]$。\n        *   我们需要最小化 $F(\\phi) = \\cos\\phi + \\sin\\phi$。\n        *   我们来检查导数：$F'(\\phi) = -\\sin\\phi + \\cos\\phi$。\n        *   我们令 $F'(\\phi) = 0 \\implies \\cos\\phi = \\sin\\phi \\implies \\tan\\phi = 1$。解是 $\\phi = \\pi/4 + k\\pi$。\n        *   解 $\\phi = \\pi/4$ 在我们的可行区间 $[-\\pi/2, -\\pi/4]$ 之外。下一个最接近的解是 $\\phi = -3\\pi/4$，也在区间之外。\n        *   由于导数在区间内部非零，最小值必定出现在端点之一。\n        *   我们来计算 $F(\\phi)$ 在端点 $\\phi = -\\pi/2$ 和 $\\phi = -\\pi/4$ 处的值。\n        *   在 $\\phi = -\\pi/2$ 处：$d = (0, -1)$。$F = 0 + (-1) = -1$。\n        *   在 $\\phi = -\\pi/4$ 处：$d = (\\frac{1}{\\sqrt{2}}, -\\frac{1}{\\sqrt{2}})$。$F = \\frac{1}{\\sqrt{2}} - \\frac{1}{\\sqrt{2}} = 0$。\n        *   最小值是 $-1$，在 $\\phi = -\\pi/2$ 处取得。\n        *   所以最优方向是 $d^{\\ast} = (0,-1)$。\n        *   我们来复核一下。问题是找到最小化 $\\nabla f^{\\mathsf{T}} d$ 的方向 $d$。这等价于在可行集中找到与 $\\nabla f$ 形成最大钝角的方向 $d$。\n        *   $\\nabla f = (1,1)$。$\\nabla f$ 的角度是 $\\pi/4$。\n        *   可行方向位于 $-\\pi/2$ 和 $-\\pi/4$ 之间的扇区。\n        *   我们要最小化 $\\nabla f^{\\mathsf{T}} d = \\|\\nabla f\\| \\|d\\| \\cos(\\alpha)$，其中 $\\alpha$ 是 $\\nabla f$ 和 $d$ 之间的夹角。\n        *   当 $\\|d\\|=1$ 时，我们要最小化 $\\sqrt{2} \\cos(\\alpha)$。这等价于最大化夹角 $\\alpha$。\n        *   $\\nabla f$ 的角度是 $\\pi/4$。可行方向 $d$ 的角度在 $[-\\pi/2, -\\pi/4]$ 内。\n        *   令 $\\theta_d$ 为 $d$ 的角度。它们之间的夹角是 $\\alpha = |\\theta_d - \\pi/4|$。\n        *   如果 $\\theta_d = -\\pi/4$，则 $\\alpha = |-\\pi/4 - \\pi/4| = |-\\pi/2| = \\pi/2$。$\\cos(\\pi/2)=0$。\n        *   如果 $\\theta_d = -\\pi/2$，则 $\\alpha = |-\\pi/2 - \\pi/4| = |-3\\pi/4| = 3\\pi/4$。$\\cos(3\\pi/4) = -1/\\sqrt{2}$。\n        *   目标函数的值是 $\\sqrt{2} \\cos(\\alpha)$。\n        *   在 $\\theta_d = -\\pi/4$ 时，目标值为 $\\sqrt{2}\\cos(\\pi/2) = 0$。\n        *   在 $\\theta_d = -\\pi/2$ 时，目标值为 $\\sqrt{2}\\cos(3\\pi/4) = \\sqrt{2}(-1/\\sqrt{2}) = -1$。\n        *   这证实了当方向 $d$ 的角度为 $-\\pi/2$ 时，达到最小值。\n        *   问题要求最优单位方向 $d^{\\ast}$ 的唯一角度 $\\theta$。\n        *   最优方向是 $d^{\\ast} = (0, -1)$。此向量相对于正 $x_1$ 轴的角度确实是 $-\\pi/2$。给定的 $\\theta$ 范围是 $[-\\pi, \\pi)$，而 $-\\pi/2$ 在此范围内。\n\n    *   **另一种解释**：寻找最陡下降方向的问题通常定义为将 $-\\nabla f$ 投影到可行方向锥上。\n        *   我们来求解 min $\\|d - (-\\nabla f)\\|^2$，约束条件为 $d \\in \\mathcal{C}(x^{\\ast})$。\n        *   最小化 $\\|(d_1, d_2) - (-1, -1)\\|^2 = \\|(d_1+1, d_2+1)\\|^2 = (d_1+1)^2 + (d_2+1)^2$。\n        *   约束条件为 $d_1 \\ge 0$ 和 $d_1+d_2 \\le 0$。\n        *   我们来找无约束最小值：$d_1 = -1, d_2 = -1$。这个点是 $( -1, -1)$，也就是 $-\\nabla f$。\n        *   这个点违反了 $d_1 \\ge 0$。所以最小值一定在可行域的边界上。\n        *   可行域是锥 $d_1 \\ge 0, d_2 \\le -d_1$。\n        *   边界是 $d_1=0, d_2 \\le 0$（负 $d_2$ 轴）和 $d_1+d_2=0, d_1 \\ge 0$（第四象限的直线）。\n        *   我们将 $( -1, -1)$ 投影到直线 $d_1=0$ 上。投影点是 $(0, -1)$。这个点在可行域内（$d_1=0 \\ge 0$，$d_1+d_2=0-1=-1 \\le 0$）。距离的平方是 $(0+1)^2 + (-1+1)^2 = 1$。\n        *   我们将 $( -1, -1)$ 投影到直线 $d_1+d_2=0$ 上。一个点 $q$ 到平面 $n^{\\mathsf{T}}x-c=0$ 的投影 $p$ 是 $p = q - \\frac{n^{\\mathsf{T}}q - c}{n^{\\mathsf{T}}n}n$。这里，$q=(-1,-1)$，$n=(1,1)$，$c=0$。\n        *   $p = (-1,-1) - \\frac{(1,1)^{\\mathsf{T}}(-1,-1) - 0}{(1,1)^{\\mathsf{T}}(1,1)}(1,1) = (-1,-1) - \\frac{-2}{2}(1,1) = (-1,-1) - (-1)(1,1) = (-1,-1) + (1,1) = (0,0)$。\n        *   点 $(0,0)$ 在可行域内。距离的平方是 $(0+1)^2+(0+1)^2 = 2$。\n        *   锥中离 $( -1, -1)$ 最近的点是 $(0, -1)$。\n        *   所以 $-\\nabla f$ 在 $\\mathcal{C}(x^{\\ast})$ 上的投影是向量 $(0, -1)$。\n        *   最陡下降方向 $d^{\\ast}$ 是这个投影的归一化版本。我们称这个投影为 $p^{\\ast}$。\n        *   $p^{\\ast} = (0,-1)$。它已经是一个单位向量。所以 $d^{\\ast} = (0, -1)$。\n        *   这证实了我之前的结果。\n\n    *   我们仔细重读问题陈述，以确保我遵循了给定的定义。\n        *   “...通过求解以下小型二次规划（QP, Quadratic Program）问题来确定最陡可行下降方向：最小化 $\\nabla f(x^{\\ast})^{\\mathsf{T}} d$，约束条件为 $d \\in \\mathcal{C}(x^{\\ast})$ 且 $\\|d\\|_{2} \\le 1$。”\n        *   我的公式是：\n            *   最小化 $d_1 + d_2$\n            *   约束条件为：\n                1.  $d_1 + d_2 \\le 0$\n                2.  $d_1 \\ge 0$\n                3.  $d_1^2 + d_2^2 \\le 1$\n        *   这个公式根据问题是正确的。最小值必须在可行集的极点上的分析也是合理的。可行集是一个锥和单位球的交集。目标函数是线性的。一个线性函数在一个紧凸集上的最小值是在该集的边界上达到的。\n        *   可行集 $\\mathcal{F} = \\{ d \\in \\mathbb{R}^2 \\mid d_1+d_2 \\le 0,\\ d_1\\ge 0,\\ d_1^2+d_2^2 \\le 1 \\}$。\n        *   这是一个单位圆盘的一部分。边界由三部分组成：\n            1.  从 $(0,0)$ 到 $(0,-1)$ 的线段。在这段上，$d_1=0$，$-1 \\le d_2 \\le 0$。目标函数是 $d_1+d_2 = d_2$。最小值在 $d_2=-1$ 处取得，所以 $d=(0, -1)$。值为 $-1$。\n            2.  从 $(0,0)$ 到 $(1/\\sqrt{2}, -1/\\sqrt{2})$ 的线段。在这段上，$d_1+d_2=0$。目标函数是 $d_1+d_2=0$。\n            3.  从 $(0,-1)$ 到 $(1/\\sqrt{2}, -1/\\sqrt{2})$ 的圆弧。在这段弧上，$d_1^2+d_2^2=1$，$d = (\\cos\\phi, \\sin\\phi)$，其中 $\\phi \\in [-\\pi/2, -\\pi/4]$。目标函数是 $\\cos\\phi+\\sin\\phi$。如前分析，导数是 $\\cos\\phi-\\sin\\phi$，在 $[-\\pi/2, -\\pi/4)$ 上为正。例如，在 $\\phi = -\\pi/3$ 时，$\\cos(-\\pi/3) - \\sin(-\\pi/3) = 1/2 - (-\\sqrt{3}/2) = (1+\\sqrt{3})/2 > 0$。所以函数在区间上是严格递增的。最小值在左端点 $\\phi=-\\pi/2$ 处。最小值为 $\\cos(-\\pi/2) + \\sin(-\\pi/2) = 0 - 1 = -1$。最大值在右端点 $\\phi=-\\pi/4$ 处。最大值为 $\\cos(-\\pi/4)+\\sin(-\\pi/4) = 1/\\sqrt{2} - 1/\\sqrt{2} = 0$。\n        *   比较所有边界部分的最小值：\n            *   在线段 1 上：最小值为 -1，在 $d=(0,-1)$ 处。\n            *   在线段 2 上：最小值为 0，在线段上处处如此。\n            *   在线段 3 (圆弧) 上：最小值为 -1，在 $d=(0,-1)$ 处。\n        *   在可行集 $\\mathcal{F}$ 上的全局最小值是 $-1$，并且在 $d^{\\ast} = (0,-1)$ 处唯一达到。\n        *   问题要求这个方向的唯一角度 $\\theta$。\n        *   向量 $d^{\\ast} = (0, -1)$ 对应于从正 $x_1$ 轴算起的 $-\\pi/2$ 弧度的角度。\n\n3.  **最终验证和格式化。**\n    *   问题是适定的，并且有唯一解。\n    *   步骤是合乎逻辑的，并基于所提供的定义。\n    *   计算是直接的。\n    *   最终答案是所要求的精确实数。\n    *   角度在指定的范围 $[-\\pi, \\pi)$ 内。\n    *   我必须对所有数学实体使用 LaTeX 书写整个解答。", "answer": "$$\n\\boxed{-\\frac{\\pi}{2}}\n$$", "id": "3128694"}, {"introduction": "在优化算法中，找到一个好的下降方向只是成功的一半；另一半是选择一个合适的步长。本练习 [@problem_id:3128719] 首先揭示了一个朴素算法因步长不当而无法收敛的典型陷阱，然后引入了 Armijo 线搜索准则，这是一个确保我们迈出的每一步都有意义的强大工具。", "problem": "考虑在闭凸多面体$\\mathcal{C} = \\{x \\in \\mathbb{R}^{2} \\,:\\, x_{1} \\geq 0,\\; x_{2} \\geq 0,\\; x_{1} + x_{2} \\leq 1\\}$上最小化光滑函数$f(x) = \\tfrac{1}{2}\\,(x_{1} - x_{2})^{2}$的约束优化问题。其梯度为$\\nabla f(x) = Qx,$ 其中$$Q = \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}.$$ 定义固定步长$\\alpha = 1$的朴素投影梯度迭代为$x^{+} = \\Pi_{\\mathcal{C}}\\big(x - \\alpha \\nabla f(x)\\big),$ 其中$\\Pi_{\\mathcal{C}}(\\cdot)$表示到$\\mathcal{C}$上的欧氏投影。从顶点$x^{(0)} = (1,0)^{\\top}$开始。仅使用可行方向、切锥和Armijo回溯条件的基本定义，完成以下操作：\n\n1. 证明朴素投影梯度迭代在顶点$x^{(0)} = (1,0)^{\\top}$和$x^{(1)} = (0,1)^{\\top}$之间循环，而$f$值不减小。\n\n2. 在$x^{(0)}$处沿可行下降方向施加一个带可行性的Armijo回溯规则。使用充分下降参数$\\sigma = \\tfrac{1}{4}$、回溯因子$\\beta = \\tfrac{1}{2}$和初始试探步长$\\alpha_{0} = 1$。选择可行下降方向$d^{(0)}$为负梯度在$x^{(0)}$处$\\mathcal{C}$的切锥上的投影（确保一阶可行性）。确定序列$\\{\\alpha_{0},\\, \\beta \\alpha_{0},\\, \\beta^{2} \\alpha_{0},\\, \\ldots\\}$中满足$x^{(0)}$处Armijo不等式的最大回溯步长，然后计算该接受步长下Armijo条件所规定的目标函数值的保证下降量$\\Delta$，即$\\Delta = \\sigma\\,\\alpha\\,||\\nabla f(x^{(0)})||^2.$\n\n你的最终答案必须是等于$\\Delta$的单个实数。无需四舍五入。", "solution": "用户提出了一个约束优化问题，并要求对两种不同的算法方法进行分析。\n\n### 问题验证\n首先根据所需标准对问题进行验证。\n\n**第1步：提取已知条件**\n- 目标函数：$f(x) = \\frac{1}{2}(x_{1} - x_{2})^{2}$\n- 约束集：$\\mathcal{C} = \\{x \\in \\mathbb{R}^{2} \\,:\\, x_{1} \\geq 0,\\; x_{2} \\geq 0,\\; x_{1} + x_{2} \\leq 1\\}$\n- 梯度：$\\nabla f(x) = Qx$，其中$Q = \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$\n- 朴素投影梯度迭代：$x^{+} = \\Pi_{\\mathcal{C}}(x - \\alpha \\nabla f(x))$，固定步长$\\alpha = 1$\n- 初始点：$x^{(0)} = (1,0)^{\\top}$\n- Armijo回溯参数：$\\sigma = \\frac{1}{4}$，$\\beta = \\frac{1}{2}$，初始试探步长$\\alpha_{0} = 1$\n- 可行下降方向：$d^{(0)} = \\Pi_{T_{\\mathcal{C}}(x^{(0)})}(-\\nabla f(x^{(0)}))$\n- 待计算量：$\\Delta = \\sigma\\,\\alpha\\,||\\nabla f(x^{(0)})||^2$，对于接受的步长$\\alpha$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定且客观的。这是数值优化领域的一个标准练习，特别是关于约束凸优化的投影梯度法。所有术语都是标准的且定义明确。数据一致且完整。未发现任何缺陷。\n\n**第3步：结论与行动**\n问题有效。将提供完整解答。\n\n### 解答\n\n应要求，解答分为两部分呈现。\n\n**第1部分：朴素投影梯度迭代的分析**\n\n我们从点$x^{(0)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$开始。\n在该点，目标函数的值为$f(x^{(0)}) = \\frac{1}{2}(1 - 0)^2 = \\frac{1}{2}$。\n$f$在$x^{(0)}$处的梯度是$\\nabla f(x^{(0)}) = \\begin{pmatrix} 1 - 0 \\\\ 0 - 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n步长为$\\alpha = 1$的朴素投影梯度迭代由$x^{+} = \\Pi_{\\mathcal{C}}(x - \\nabla f(x))$给出。\n对于第一次迭代，我们计算无约束步：\n$$y^{(0)} = x^{(0)} - \\alpha \\nabla f(x^{(0)}) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - 1 \\cdot \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}.$$\n下一个迭代点$x^{(1)}$是$y^{(0)}$在可行集$\\mathcal{C}$上的投影。\n点$y^{(0)} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$满足$\\mathcal{C}$的约束：$x_{1} = 0 \\geq 0$，$x_{2} = 1 \\geq 0$，以及$x_{1} + x_{2} = 0+1=1 \\leq 1$。\n由于$y^{(0)}$在$\\mathcal{C}$中，其在$\\mathcal{C}$上的投影就是该点本身。\n$$x^{(1)} = \\Pi_{\\mathcal{C}}(y^{(0)}) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}.$$\n在新迭代点处的目标函数值为$f(x^{(1)}) = \\frac{1}{2}(0 - 1)^2 = \\frac{1}{2}$。\n我们观察到$f(x^{(1)}) = f(x^{(0)})$，因此目标函数没有减小。\n\n现在我们从$x^{(1)} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$开始进行第二次迭代。\n在$x^{(1)}$处的梯度是$\\nabla f(x^{(1)}) = \\begin{pmatrix} 0 - 1 \\\\ 1 - 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$。\n无约束步为：\n$$y^{(1)} = x^{(1)} - \\alpha \\nabla f(x^{(1)}) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} - 1 \\cdot \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.$$\n下一个迭代点$x^{(2)}$是$y^{(1)}$在$\\mathcal{C}$上的投影。\n点$y^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$是起始点$x^{(0)}$，该点也在$\\mathcal{C}$中。\n$$x^{(2)} = \\Pi_{\\mathcal{C}}(y^{(1)}) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = x^{(0)}.$$\n迭代返回到起始点。因此，迭代序列是$x^{(0)}, x^{(1)}, x^{(0)}, x^{(1)}, \\ldots$，在顶点$\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$和$\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$之间循环，目标函数值没有任何减小，保持在$\\frac{1}{2}$不变。这证明了问题第一部分的论断。\n\n**第2部分：带可行下降方向的Armijo回溯**\n\n我们再次从$x^{(0)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$开始。\n首先，我们确定切锥$T_{\\mathcal{C}}(x^{(0)})$。可行集$\\mathcal{C}$由不等式$g_1(x) = -x_1 \\leq 0$，$g_2(x) = -x_2 \\leq 0$，和$g_3(x) = x_1+x_2-1 \\leq 0$定义。在$x^{(0)}$处，有效约束是$g_2(x^{(0)}) = 0$和$g_3(x^{(0)}) = 0$。\n有效约束的梯度为$\\nabla g_2(x) = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}$和$\\nabla g_3(x) = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n对于一个凸多面体，切锥是方向$d = \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix}$的集合，使得对于所有有效约束$i$，有$\\nabla g_i(x^{(0)})^\\top d \\leq 0$。\n$$ \\nabla g_2(x^{(0)})^\\top d = \\begin{pmatrix} 0  -1 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = -d_2 \\leq 0 \\implies d_2 \\geq 0.$$\n$$ \\nabla g_3(x^{(0)})^\\top d = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = d_1 + d_2 \\leq 0.$$\n所以，切锥是$T_{\\mathcal{C}}(x^{(0)}) = \\{d \\in \\mathbb{R}^2 \\,|\\, d_2 \\geq 0, d_1+d_2 \\leq 0\\}$。\n\n搜索方向$d^{(0)}$是负梯度在该锥上的投影。负梯度是$-\\nabla f(x^{(0)}) = -\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$。\n我们检查这个向量是否在切锥内。对于$d_1 = -1$和$d_2 = 1$：\n$d_2 = 1 \\geq 0$（满足）。\n$d_1+d_2 = -1+1=0 \\leq 0$（满足）。\n由于$-\\nabla f(x^{(0)})$在闭凸锥$T_{\\mathcal{C}}(x^{(0)})$中，其在该锥上的投影就是该向量本身。\n$$d^{(0)} = \\Pi_{T_{\\mathcal{C}}(x^{(0)})}(-\\nabla f(x^{(0)})) = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}.$$\n这是一个下降方向，因为$\\nabla f(x^{(0)})^\\top d^{(0)} = \\begin{pmatrix} 1  -1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = -1 - 1 = -2  0$。\n\n接下来，我们执行Armijo回溯线搜索，以从序列$\\{\\alpha_0, \\beta \\alpha_0, \\beta^2 \\alpha_0, \\ldots\\} = \\{1, \\frac{1}{2}, \\frac{1}{4}, \\ldots\\}$中找到一个可接受的步长$\\alpha$。\nArmijo条件是：$f(x^{(0)} + \\alpha d^{(0)}) \\leq f(x^{(0)}) + \\sigma \\alpha \\nabla f(x^{(0)})^\\top d^{(0)}$。\n我们有$f(x^{(0)}) = \\frac{1}{2}$，$\\sigma=\\frac{1}{4}$，和$\\nabla f(x^{(0)})^\\top d^{(0)} = -2$。条件变为：\n$$f\\left(\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\alpha \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}\\right) \\leq \\frac{1}{2} + \\frac{1}{4} \\alpha (-2) = \\frac{1}{2} - \\frac{\\alpha}{2}.$$\n新点是$x(\\alpha) = \\begin{pmatrix} 1-\\alpha \\\\ \\alpha \\end{pmatrix}$。函数值为$f(x(\\alpha)) = \\frac{1}{2}((1-\\alpha) - \\alpha)^2 = \\frac{1}{2}(1-2\\alpha)^2$。\n不等式为：\n$$\\frac{1}{2}(1-2\\alpha)^2 \\leq \\frac{1}{2} - \\frac{\\alpha}{2}.$$\n$$(1-2\\alpha)^2 \\leq 1 - \\alpha.$$\n$$1 - 4\\alpha + 4\\alpha^2 \\leq 1 - \\alpha.$$\n$$4\\alpha^2 - 3\\alpha \\leq 0.$$\n$$\\alpha(4\\alpha - 3) \\leq 0.$$\n由于我们在寻找$\\alpha > 0$，这可以简化为$4\\alpha - 3 \\leq 0$，或$\\alpha \\leq \\frac{3}{4}$。\n\n现在我们测试试探步长：\n- 对于$\\alpha_0 = 1$：$1 \\not\\leq \\frac{3}{4}$。条件不满足。\n- 对于$\\alpha_1 = \\beta \\alpha_0 = \\frac{1}{2}$：$\\frac{1}{2} \\leq \\frac{3}{4}$。条件满足。\n我们还检查步长是否可行。对于步长$\\alpha$，点$x(\\alpha) = (1-\\alpha, \\alpha)$必须在$\\mathcal{C}$内，这要求$1-\\alpha \\ge 0$，$\\alpha \\ge 0$，和$(1-\\alpha)+\\alpha \\le 1$。这些简化为$0 \\le \\alpha \\le 1$。所有试探步长都在这个范围内。\n序列中满足Armijo条件的最大步长是$\\alpha = \\frac{1}{2}$。\n\n最后，我们使用给定的公式$\\Delta = \\sigma\\,\\alpha\\,||\\nabla f(x^{(0)})||^2$，为这个接受的步长计算保证的下降量$\\Delta$。\n我们有$\\sigma = \\frac{1}{4}$且接受的步长是$\\alpha = \\frac{1}{2}$。\n梯度的范数平方是$||\\nabla f(x^{(0)})||^2 = \\left\\|\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\\right\\|^2 = 1^2 + (-1)^2 = 2$。\n代入这些值：\n$$\\Delta = \\left(\\frac{1}{4}\\right) \\left(\\frac{1}{2}\\right) (2) = \\frac{2}{8} = \\frac{1}{4}.$$\n保证的下降量是$\\frac{1}{4}$。\n注意，实际的下降量是$f(x^{(0)}) - f(x^{(0)} + \\frac{1}{2} d^{(0)}) = \\frac{1}{2} - f(\\frac{1}{2}, \\frac{1}{2}) = \\frac{1}{2} - 0 = \\frac{1}{2}$，它大于或等于保证的下降量$\\frac{1}{4}$。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "3128719"}]}