{"hands_on_practices": [{"introduction": "单纯形法的核心在于“轴转”操作，它驱动着算法从一个基本可行解移动到另一个。与其死记硬背单纯形表的更新规则，从可行性和检验数的基本定义出发推导这些规则，能让你更深刻地理解算法的内在逻辑。本练习将引导你从第一性原理出发，推导解向量和检验数的更新公式，并通过一个具体算例来巩固你的理解。[@problem_id:3164090]", "problem": "考虑一个最大化问题的标准等式形式线性规划（LP）的主单纯形法：在约束 $A x = b$, $x \\ge 0$下，最大化 $c^{\\top} x$。设当前基由一组基列 $B \\in \\mathbb{R}^{m \\times m}$ 和非基列 $N \\in \\mathbb{R}^{m \\times (n-m)}$ 定义，并带有相关联的子向量 $c_B \\in \\mathbb{R}^{m}$，$c_N \\in \\mathbb{R}^{n-m}$。当前基本可行解为 $x_B = B^{-1} b$, $x_N = 0$，检验数由基本定义 $\\bar c^{\\top} = c^{\\top} - c_B^{\\top} B^{-1} A$ 给出。假设一个非基变量 $x_j$ 通过一个选择严格为正检验数的定价规则（Dantzig 法则：选择具有最大正 $\\bar c_j$ 的 $j$）被选入基，并令 $u = B^{-1} a_j$，其中 $a_j$ 是 $A$ 的第 $j$ 列。主比率检验通过选择索引 $r$ 来确定出基变量，使得 $u_r > 0$ 且 $\\theta^{\\star} = \\min_{i : u_i > 0} \\frac{x_{B,i}}{u_i}$ 在 $i=r$ 处达到。\n\n任务：\n- 仅从核心定义 $x_B = B^{-1} b$, $\\bar c^{\\top} = c^{\\top} - c_B^{\\top} B^{-1} A$，以及沿方向 $u = B^{-1} a_j$ 移动所引起的可行性步骤方程出发，推导单次主元变换后新基本变量值和新检验数的精确代数更新公式。你的公式应以 $x_B$, $\\bar c$, $u$, 主元行索引 $r$ 以及主元变换前单纯形表中的量来表示 $x_{B}^{+}$ 和 $\\bar c^{+}$，而不调用任何非从这些定义推导出的简化公式。\n- 然后将你推导的公式应用于以下特定的LP问题：\n在约束\n$$\n\\begin{pmatrix}\n2  1 \\\\\n1  2\n\\end{pmatrix}\n\\begin{pmatrix}\nx_1 \\\\\nx_2\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n1  0 \\\\\n0  1\n\\end{pmatrix}\n\\begin{pmatrix}\ns_1 \\\\\ns_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n8 \\\\\n8\n\\end{pmatrix}, \\quad\nx_1, x_2, s_1, s_2 \\ge 0,\n$$\n下，最大化 $3 x_1 + 5 x_2$\n初始基由松弛变量 $s_1$ 和 $s_2$ 给出。使用 Dantzig 定价法则（选择具有最大严格正检验数的非基索引）和标准的原始最小比率检验，并在需要时使用确定性决胜规则“最小行索引”。从初始基本可行解开始，执行恰好两次主元变换。在每次主元变换时，验证所选的进基变量满足定价规则，所选的出基变量满足比率检验，并检查可行性是否得以保持。\n- 令 $z$ 表示完成第二次主元变换后的目标值。以单个精确的简化分数形式提供 $z$。\n\n将你的最终数值答案表示为精确分数。不要四舍五入。最终答案必须是单个实数。", "solution": "该问题要求完成两项主要任务：首先，从基本定义出发，推导单纯形法中基本变量值和检验数的更新公式；其次，应用这些公式对一个特定的线性规划（LP）问题进行两次主元变换，并求出最终的目标函数值。\n\n### 第一部分：更新公式的推导\n\n设LP问题为标准形式：在约束条件 $A x = b$, $x \\ge 0$ 下，最大化 $z = c^{\\top} x$。\n矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 被划分为一个基矩阵 $B \\in \\mathbb{R}^{m \\times m}$ 和一个非基矩阵 $N \\in \\mathbb{R}^{m \\times (n-m)}$。向量 $x$ 和 $c$ 也相应地划分为 $x_B, x_N$ 和 $c_B, c_N$。\n当前基本可行解（BFS）由 $x_N = 0$ 和 $x_B = B^{-1} b \\ge 0$ 给出。\n检验数为 $\\bar c^{\\top} = c^{\\top} - c_B^{\\top} B^{-1} A$。\n\n选择一个非基变量 $x_j$ 进基，其检验数 $\\bar{c}_j > 0$。我们试图通过将 $x_j$ 从 $0$ 增加到某个值 $\\theta > 0$ 来找到一个新解 $x^{\\text{new}}$，同时保持所有其他非基变量为 $0$。基本变量 $x_B$ 将被调整以保持可行性。\n\n#### 新基本变量值 ($x_B^{+}$) 的推导\n\n设新解为 $x^{\\text{new}}$。其非基部分为 $x_N^{\\text{new}} = \\theta e_k$，其中 $e_k$ 是对应于 $x_j$ 在非基变量中位置的标准基向量。可行性约束 $A x = b$ 必须保持：\n$$B x_B^{\\text{new}} + N x_N^{\\text{new}} = b$$\n$$B x_B^{\\text{new}} + a_j \\theta = b$$\n其中 $a_j$ 是 $A$（以及 $N$）中对应于 $x_j$ 的列。为求解 $x_B^{\\text{new}}$，我们左乘 $B^{-1}$：\n$$x_B^{\\text{new}} = B^{-1}(b - a_j \\theta) = B^{-1}b - \\theta (B^{-1}a_j)$$\n使用给定的定义 $x_B = B^{-1} b$ 和 $u = B^{-1} a_j$，我们得到：\n$$x_B^{\\text{new}}(\\theta) = x_B - \\theta u$$\n为了使新解保持可行，我们必须有 $x_B^{\\text{new}} \\ge 0$，这意味着对于所有基本索引 $i=1, \\dots, m$ 都有 $x_{B,i} - \\theta u_i \\ge 0$。\n如果 $u_i \\le 0$，该不等式对任何 $\\theta \\ge 0$ 均成立。\n如果 $u_i > 0$，我们必须有 $\\theta \\le \\frac{x_{B,i}}{u_i}$。\n为了最大化目标函数的增量，我们选择能使所有基本变量保持可行性的最大可能值 $\\theta$：\n$$\\theta^{\\star} = \\min_{i \\,:\\, u_i > 0} \\left\\{ \\frac{x_{B,i}}{u_i} \\right\\}$$\n这就是最小比值检验。设最小值在索引 $i=r$ 处达到。这意味着基本变量 $x_{B,r}$ 将变为 $0$ 并出基。\n$$x_{B,r}^{\\text{new}} = x_{B,r} - \\theta^{\\star} u_r = x_{B,r} - \\left(\\frac{x_{B,r}}{u_r}\\right) u_r = 0$$\n新的基本变量集合，记为 $x_B^{+}$，由进基变量 $x_j$ 和除了出基变量 $x_{B,r}$ 之外的旧基本变量组成。这些新基本变量的值为：\n- 进基变量 $x_j$ 的值为 $x_j^{+} = \\theta^{\\star} = \\frac{x_{B,r}}{u_r}$。\n- 仍在基中的基本变量 $x_{B,i}$ ($i \\neq r$) 的值更新为 $x_{B,i}^{+} = x_{B,i} - \\theta^{\\star} u_i = x_{B,i} - \\left(\\frac{x_{B,r}}{u_r}\\right) u_i$。\n\n#### 新检验数 ($\\bar{c}^{+}$) 的推导\n\n对于任意变量 $x_k$，其检验数为 $\\bar{c}_k = c_k - \\pi^{\\top} a_k$，其中 $\\pi^{\\top} = c_B^{\\top} B^{-1}$ 是单纯形乘子向量。主元变换后，基从 $B$ 变为 $B^{+}$，基成本向量从 $c_B$ 变为 $c_{B^{+}}$。新的乘子为 $(\\pi^{+})^{\\top} = c_{B^{+}}^{\\top} (B^{+})^{-1}$。\n对于新基中的所有变量 $x_k$，新的乘子必须满足 $(\\pi^{+})^{\\top} a_k = c_k$。\n我们将新的乘子表示为旧乘子的修正：$(\\pi^{+})^{\\top} = \\pi^{\\top} + \\delta^{\\top}$。\n\n新基由列 $\\{a_{B_i}\\}_{i \\neq r}$ 和新列 $a_j$ 组成。\n1. 对于现在是基变量的进基变量 $x_j$：\n$$(\\pi^{+})^{\\top} a_j = c_j \\implies (\\pi^{\\top} + \\delta^{\\top}) a_j = c_j$$\n由于 $\\pi^{\\top} a_j = c_j - \\bar{c}_j$，这给出 $(c_j - \\bar{c}_j) + \\delta^{\\top} a_j = c_j$，简化为 $\\delta^{\\top} a_j = \\bar{c}_j$。\n\n2. 对于仍为基变量的变量 $x_{B_i}$ ($i \\neq r$)：\n$$(\\pi^{+})^{\\top} a_{B_i} = c_{B_i} \\implies (\\pi^{\\top} + \\delta^{\\top}) a_{B_i} = c_{B_i}$$\n由于 $\\pi^{\\top} a_{B_i} = c_{B_i}$ (因为 $x_{B_i}$ 在旧基中)，这简化为对于所有 $i \\neq r$ 都有 $\\delta^{\\top} a_{B_i} = 0$。\n\n我们现在有一个关于 $\\delta$ 的方程组。我们使用关系式 $a_j = B u = \\sum_{i=1}^{m} u_i a_{B_i}$：\n$$\\bar{c}_j = \\delta^{\\top} a_j = \\delta^{\\top} \\left( \\sum_{i=1}^{m} u_i a_{B_i} \\right) = \\sum_{i=1}^{m} u_i (\\delta^{\\top} a_{B_i})$$\n使用对于 $i \\neq r$ 有 $\\delta^{\\top} a_{B_i}=0$，求和式简化为一项：\n$$\\bar{c}_j = u_r (\\delta^{\\top} a_{B_r})$$\n这意味着 $\\delta^{\\top} a_{B_r} = \\frac{\\bar{c}_j}{u_r}$。\n设 $v_r^{\\top}$ 是矩阵 $B^{-1}$ 的第 $r$ 行。那么 $v_r^{\\top} B = e_r^{\\top}$ (第 $r$ 个标准基向量)，这意味着 $v_r^{\\top} a_{B_i} = \\delta_{ir}$ (克罗内克 $\\delta$)。\n我们定义一个向量 $\\eta^{\\top} = \\frac{\\bar{c}_j}{u_r} v_r^{\\top}$。我们来检验它是否满足关于 $\\delta^{\\top}$ 的条件。\n$\\eta^{\\top} a_{B_i} = \\frac{\\bar{c}_j}{u_r} (v_r^{\\top} a_{B_i}) = \\frac{\\bar{c}_j}{u_r} \\delta_{ir}$。当 $i \\neq r$ 时，结果为 $0$；当 $i=r$ 时，结果为 $\\frac{\\bar{c}_j}{u_r}$。这与我们的发现相符。因此，我们找到了变化量 $\\delta^{\\top}$：\n$$\\delta^{\\top} = \\frac{\\bar{c}_j}{u_r} v_r^{\\top} = \\frac{\\bar{c}_j}{u_r} (B^{-1} \\text{的第 r 行})$$\n现在我们可以计算任意变量 $x_k$ 的新检验数 $\\bar{c}_k^{+}$：\n$$\\bar{c}_k^{+} = c_k - (\\pi^{+})^{\\top} a_k = c_k - (\\pi^{\\top} + \\delta^{\\top}) a_k = (c_k - \\pi^{\\top} a_k) - \\delta^{\\top} a_k = \\bar{c}_k - \\delta^{\\top} a_k$$\n代入 $\\delta^{\\top}$ 的表达式：\n$$\\bar{c}_k^{+} = \\bar{c}_k - \\left( \\frac{\\bar{c}_j}{u_r} (B^{-1} \\text{的第 r 行}) \\right) a_k$$\n项 $(B^{-1} \\text{的第 r 行}) a_k$ 是向量 $B^{-1}a_k$ 的第 $r$ 个分量，也就是当前单纯形表中对应于 $x_k$ 的列。我们用 $\\bar{a}_k = B^{-1}a_k$ 表示此列。那么主元是 $u_r = (\\bar{a}_j)_r = \\bar{a}_{rj}$。表达式变为：\n$$\\bar{c}_k^{+} = \\bar{c}_k - \\frac{\\bar{c}_j}{\\bar{a}_{rj}} \\bar{a}_{rk}$$\n\n### 第二部分：应用于特定LP问题\n\n问题是：在约束\n$$\n\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} s_1 \\\\ s_2 \\end{pmatrix} = \\begin{pmatrix} 8 \\\\ 8 \\end{pmatrix}, \\quad x_1, x_2, s_1, s_2 \\ge 0.\n$$\n下，最大化 $z = 3 x_1 + 5 x_2$。\n这里，$x = [x_1, x_2, s_1, s_2]^{\\top}$，$c = [3, 5, 0, 0]^{\\top}$，$A = \\begin{pmatrix} 2  1  1  0 \\\\ 1  2  0  1 \\end{pmatrix}$，$b = \\begin{pmatrix} 8 \\\\ 8 \\end{pmatrix}$。\n\n**初始状态（第0次主元变换）**\n初始基由松弛变量 $s_1$ 和 $s_2$ 给出。\n- 基变量: $x_B = [s_1, s_2]^{\\top}$。非基变量: $x_N = [x_1, x_2]^{\\top}$。\n- $B = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I$，所以 $B^{-1} = I$。\n- $c_B = [0, 0]^{\\top}$。\n- 初始基本可行解：$x_B = B^{-1}b = I \\begin{pmatrix} 8 \\\\ 8 \\end{pmatrix} = \\begin{pmatrix} 8 \\\\ 8 \\end{pmatrix}$。所以 $s_1=8, s_2=8$。完整解为 $(x_1, x_2, s_1, s_2) = (0, 0, 8, 8)$。由于所有变量都非负，所以该解是可行的。\n- 初始目标函数值：$z = c^{\\top}x = 3(0) + 5(0) + 0(8) + 0(8) = 0$。\n- 检验数：$\\bar{c}^{\\top} = c^{\\top} - c_B^{\\top} B^{-1} A = c^{\\top} - 0 \\cdot A = c^{\\top} = [3, 5, 0, 0]$。\n- 所以，$\\bar{c}_1=3, \\bar{c}_2=5, \\bar{c}_{s1}=0, \\bar{c}_{s2}=0$。\n\n**第1次主元变换**\n- **进基变量选择规则**：我们使用 Dantzig 法则选择进基变量：选择具有 $\\max_{k} \\{\\bar{c}_k\\} > 0$ 的 $j$。\n这里，$\\max\\{3, 5\\} = 5$，对应于 $x_2$。所以 $x_2$ 进基。该选择是有效的，因为 $\\bar{c}_2=5>0$。\n- **出基变量选择规则 (比率检验)**：我们找出基变量。进基列为 $a_2=[1, 2]^{\\top}$。方向向量为 $u = B^{-1}a_2 = I a_2 = [1, 2]^{\\top}$。\n当前基变量为 $x_B = [s_1, s_2]^{\\top}$，其值为 $[8, 8]^{\\top}$。\n比值为：\n  - 对于 $s_1$ (索引 $i=1$): $u_1 = 1 > 0$, 比值为 $x_{B,1}/u_1 = 8/1 = 8$。\n  - 对于 $s_2$ (索引 $i=2$): $u_2 = 2 > 0$, 比值为 $x_{B,2}/u_2 = 8/2 = 4$。\n最小比值为 $\\theta^{\\star} = \\min\\{8, 4\\} = 4$，对应于索引 $i=2$（变量 $s_2$）。所以 $s_2$ 出基。主元行为 $r=2$。主元为 $u_2=2$。\n- **更新**：\n  - 新的基变量为 $s_1, x_2$。\n  - 新值：\n    - 进基变量 $x_2$ 的值为 $\\theta^{\\star} = 4$。\n    - $s_1$ 更新为: $s_1^{+} = s_1 - u_1 \\theta^{\\star} = 8 - 1 \\cdot 4 = 4$。\n  - 新基本可行解：$(x_1, x_2, s_1, s_2) = (0, 4, 4, 0)$。该解是可行的。\n  - 新目标函数值：$z = 3(0) + 5(4) = 20$。\n  - 使用公式 $\\bar{c}_k^{+} = \\bar{c}_k - (\\bar{c}_j/\\bar{a}_{rj}) \\bar{a}_{rk}$ 计算新检验数。这里 $j=2$, $r=2$, $\\bar{c}_2=5$, 主元 $\\bar{a}_{22}=u_2=2$。乘数为 $5/2$。单纯形表的主元行 ($B^{-1}A = A$) 是 $A$ 的第 2 行，即 $[1, 2, 0, 1]$。\n    - $\\bar{c}_1^{+} = \\bar{c}_1 - (5/2) \\bar{a}_{21} = 3 - (5/2)(1) = 1/2$。\n    - $\\bar{c}_2^{+} = \\bar{c}_2 - (5/2) \\bar{a}_{22} = 5 - (5/2)(2) = 0$。\n    - $\\bar{c}_{s1}^{+} = \\bar{c}_{s1} - (5/2) \\bar{a}_{2,s1} = 0 - (5/2)(0) = 0$。\n    - $\\bar{c}_{s2}^{+} = \\bar{c}_{s2} - (5/2) \\bar{a}_{2,s2} = 0 - (5/2)(1) = -5/2$。\n  - 主元变换后的检验数：$\\bar{c}^{\\top} = [1/2, 0, 0, -5/2]$。\n\n**第2次主元变换**\n- **状态**：基由 $s_1, x_2$ 组成。$B = [a_{s1}, a_2] = \\begin{pmatrix} 1  1 \\\\ 0  2 \\end{pmatrix}$。$x_B = [s_1, x_2]^{\\top} = [4, 4]^{\\top}$。\n- **进基变量选择规则**：唯一的正检验数是 $\\bar{c}_1 = 1/2$。所以 $x_1$ 进基。这是有效的。\n- **出基变量选择规则 (比率检验)**：进基列为 $a_1=[2, 1]^{\\top}$。我们需要对应的单纯形表中的列 $u = B^{-1}a_1$。\n首先，求 $B^{-1}$：$B^{-1} = \\frac{1}{2-0} \\begin{pmatrix} 2  -1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  -1/2 \\\\ 0  1/2 \\end{pmatrix}$。\n现在，$u = \\begin{pmatrix} 1  -1/2 \\\\ 0  1/2 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2-1/2 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} 3/2 \\\\ 1/2 \\end{pmatrix}$。\n基变量为 $x_B = [s_1, x_2]^{\\top}$，其值为 $[4, 4]^{\\top}$。\n比值为：\n  - 对于 $s_1$ (索引 $i=1$): $u_1 = 3/2 > 0$, 比值为 $x_{B,1}/u_1 = 4/(3/2) = 8/3$。\n  - 对于 $x_2$ (索引 $i=2$): $u_2 = 1/2 > 0$, 比值为 $x_{B,2}/u_2 = 4/(1/2) = 8$。\n最小比值为 $\\theta^{\\star} = \\min\\{8/3, 8\\} = 8/3$，对应于索引 $i=1$（变量 $s_1$）。所以 $s_1$ 出基。主元行为 $r=1$。主元为 $u_1=3/2$。\n- **更新**：\n  - 新的基变量为 $x_1, x_2$。\n  - 新值：\n    - 进基变量 $x_1$ 的值为 $\\theta^{\\star} = 8/3$。\n    - $x_2$ 更新为: $x_2^{+} = x_2 - u_2 \\theta^{\\star} = 4 - (1/2)(8/3) = 4 - 4/3 = 8/3$。\n  - 新基本可行解：$(x_1, x_2, s_1, s_2) = (8/3, 8/3, 0, 0)$。该解是可行的。\n  - 两次主元变换后的最终目标函数值：$z = 3 x_1 + 5 x_2 = 3(8/3) + 5(8/3) = 8 + 40/3 = 24/3 + 40/3 = 64/3$。\n\n最终状态有基变量 $x_1=8/3, x_2=8/3$。目标函数值为 $z=64/3$。这对应于最优解。问题要求提供这个值。", "answer": "$$\\boxed{\\frac{64}{3}}$$", "id": "3164090"}, {"introduction": "在实际的线性规划问题中，我们常常会遇到“退化”现象，即某个基本变量的取值为零。退化可能导致单纯形法“停滞不前”：算法执行了轴转操作，更换了基变量，但目标函数值并未改善，甚至可能陷入无限循环。这个练习通过一个精心设计的假想情景，展示了朴素的比率检验在退化情况下如何失效，并引入了能够保证算法前进的字典序规则，以此揭示反循环策略的重要性。[@problem_id:3164060]", "problem": "考虑一个正在用单纯形法求解的标准型线性规划（LP）问题。您被给定一个当前的基本可行解（BFS），其基变量为 $s_{1}, s_{2}, s_{3}$，非基变量为 $x_{1}, x_{2}$，其中当前解满足 $x_{1}=0$, $x_{2}=0$, $s_{1}=0$, $s_{2}=0$, 以及 $s_{3}=1$。由于两个基变量为零，此基本可行解是退化的。非基变量 $x_{1}$ 的检验数为 $\\bar{c}_{1}=1$，并且通过定价（对于最大化问题，选择检验数为正的变量）已选择 $x_{1}$ 作为进基变量。\n\n您被提供了当前单纯形表中对应于三个基行的 $x_{1}$ 的进基列：\n$$\nA_{\\cdot 1}=\\begin{pmatrix}\na_{11} \\\\\na_{21} \\\\\na_{31}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\\n2 \\\\\n\\frac{1}{2}\n\\end{pmatrix},\n\\quad\nb=\n\\begin{pmatrix}\nb_{1} \\\\\nb_{2} \\\\\nb_{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n1\n\\end{pmatrix}.\n$$\n\n朴素比值检验使用规则 $\\theta=\\min\\{b_{i}/a_{i1}:a_{i1}>0\\}$ 来选择出基变量，并按最小行号打破僵局。相比之下，字典序比值检验对右端向量 $b$ 应用一个符号扰动，使得\n$$\nb^{(\\varepsilon)}=\n\\begin{pmatrix}\n\\varepsilon \\\\\n\\varepsilon^{2} \\\\\n1\n\\end{pmatrix},\n\\quad 0 < \\varepsilon \\ll 1,\n$$\n然后通过按字典序最小化 $b^{(\\varepsilon)}_{i}/a_{i1}$ 来选择出基变量。\n\n从单纯形法、退化、检验数和比值检验的基本定义出发，完成以下任务：\n- 使用朴素比值检验确定进基变量 $x_{1}$ 的步长 $\\theta_{\\text{naive}}$，并计算目标值的相应单步变化量 $\\Delta z_{\\text{naive}}$。\n- 使用带有扰动 $b^{(\\varepsilon)}$ 的字典序比值检验确定步长 $\\theta_{\\text{lex}}$，并计算目标值的相应单步变化量 $\\Delta z_{\\text{lex}}$。\n\n将您的最终答案表示为有序对 $\\left(\\Delta z_{\\text{naive}},\\ \\Delta z_{\\text{lex}}\\right)$，形式为关于 $\\varepsilon$ 的精确解析函数。无需四舍五入。", "solution": "问题要求计算一个正在用单纯形法求解的最大化线性规划问题中，目标函数值的单步变化量 $\\Delta z$。进基变量是 $x_1$，其检验数给定为 $\\bar{c}_1 = 1$。对于最大化问题，目标函数值的变化量等于进基变量的检验数乘以其步长 $\\theta$。因此，$\\Delta z = \\bar{c}_1 \\theta = 1 \\cdot \\theta = \\theta$。我们的任务是计算在两种不同的比值检验规则下所对应的步长 $\\theta$。\n\n当前的基本可行解由右端向量 $b$ 给出，它代表了基变量 $(s_1, s_2, s_3)$ 的值。$x_1$ 的进基列是 $A_{\\cdot 1}$。它们被给定为：\n$$\nb = \\begin{pmatrix} b_1 \\\\ b_2 \\\\ b_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad A_{\\cdot 1} = \\begin{pmatrix} a_{11} \\\\ a_{21} \\\\ a_{31} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ \\frac{1}{2} \\end{pmatrix}\n$$\n当前解是退化的，因为两个基变量 $s_1$ 和 $s_2$ 的值为 $0$。\n\n首先，我们分析朴素比值检验。步长 $\\theta$ 由最小比值规则确定：\n$$\n\\theta = \\min \\left\\{ \\frac{b_i}{a_{i1}} : a_{i1} > 0 \\right\\}\n$$\n其中 $i$ 的范围是基变量的索引。在这种情况下，索引是 $1$、$2$ 和 $3$。$A_{\\cdot 1}$ 列中的所有元素都为正（$a_{11}=1 > 0$，$a_{21}=2 > 0$，$a_{31}=1/2 > 0$），因此所有三行都参与比值检验。\n比值为：\n对于第 $1$ 行（对应基变量 $s_1$）：$\\frac{b_1}{a_{11}} = \\frac{0}{1} = 0$。\n对于第 $2$ 行（对应基变量 $s_2$）：$\\frac{b_2}{a_{21}} = \\frac{0}{2} = 0$。\n对于第 $3$ 行（对应基变量 $s_3$）：$\\frac{b_3}{a_{31}} = \\frac{1}{1/2} = 2$。\n\n最小比值为 $\\min\\{0, 0, 2\\} = 0$。第 $1$ 行和第 $2$ 行之间出现了僵局。问题规定，通过选择行号最小的行来打破僵局。因此，选择第 $1$ 行作为主元行，相应的基变量 $s_1$ 作为出基变量。\n朴素检验的步长是这个最小比值的值：\n$$\n\\theta_{\\text{naive}} = 0\n$$\n这是一个退化迭代，其中一个非基变量进入基，但解向量和目标值均不改变。目标值的变化量是：\n$$\n\\Delta z_{\\text{naive}} = \\bar{c}_1 \\theta_{\\text{naive}} = 1 \\cdot 0 = 0\n$$\n\n接下来，我们分析问题中描述的字典序比值检验。该检验通过使用一个符号扰动的右端向量 $b^{(\\varepsilon)}$ 来解决退化问题：\n$$\nb^{(\\varepsilon)} = \\begin{pmatrix} b_1^{(\\varepsilon)} \\\\ b_2^{(\\varepsilon)} \\\\ b_3^{(\\varepsilon)} \\end{pmatrix} = \\begin{pmatrix} \\varepsilon \\\\ \\varepsilon^2 \\\\ 1 \\end{pmatrix}\n$$\n其中 $\\varepsilon$ 是一个满足 $0 < \\varepsilon \\ll 1$ 的符号量。问题指出，通过最小化比值 $b_i^{(\\varepsilon)}/a_{i1}$ 来选择出基变量。这意味着我们要为这个扰动问题找到步长。设这个步长为 $\\theta_{\\text{lex}}$。\n$$\n\\theta_{\\text{lex}} = \\min \\left\\{ \\frac{b_i^{(\\varepsilon)}}{a_{i1}} : a_{i1} > 0 \\right\\}\n$$\n我们使用扰动后的值计算比值：\n对于第 $1$ 行：$\\frac{b_1^{(\\varepsilon)}}{a_{11}} = \\frac{\\varepsilon}{1} = \\varepsilon$。\n对于第 $2$ 行：$\\frac{b_2^{(\\varepsilon)}}{a_{21}} = \\frac{\\varepsilon^2}{2}$。\n对于第 $3$ 行：$\\frac{b_3^{(\\varepsilon)}}{a_{31}} = \\frac{1}{1/2} = 2$。\n\n我们必须找出这三个值的最小值：$\\min\\{\\varepsilon, \\frac{\\varepsilon^2}{2}, 2\\}$。由于 $\\varepsilon$ 是一个很小的正数（$0 < \\varepsilon \\ll 1$），我们知道 $\\varepsilon^2$ 的数量级小于 $\\varepsilon$。例如，如果 $\\varepsilon < 2$，那么 $\\varepsilon^2 < 2\\varepsilon$，这意味着 $\\frac{\\varepsilon^2}{2} < \\varepsilon$。同样，对于很小的 $\\varepsilon$，我们有 $\\varepsilon < 2$。因此，这些比值的排序是 $\\frac{\\varepsilon^2}{2} < \\varepsilon < 2$。\n最小的比值是 $\\frac{\\varepsilon^2}{2}$，对应于第 $2$ 行。因此，字典序规则选择第 $2$ 行作为主元行，$s_2$ 作为出基变量。此过程下的步长就是这个最小比值本身：\n$$\n\\theta_{\\text{lex}} = \\frac{\\varepsilon^2}{2}\n$$\n使用这个步长计算出的相应单步目标值变化量为：\n$$\n\\Delta z_{\\text{lex}} = \\bar{c}_1 \\theta_{\\text{lex}} = 1 \\cdot \\left( \\frac{\\varepsilon^2}{2} \\right) = \\frac{\\varepsilon^2}{2}\n$$\n对于任何 $\\varepsilon > 0$，扰动成功地打破了僵局，并在扰动空间中产生了一个非零步长，从而导致目标函数的严格改进。\n\n最终答案是有序对 $(\\Delta z_{\\text{naive}}, \\Delta z_{\\text{lex}})$。\n$$\n(\\Delta z_{\\text{naive}}, \\Delta z_{\\text{lex}}) = \\left(0, \\frac{\\varepsilon^2}{2}\\right)\n$$", "answer": "$$\n\\boxed{\\left(0, \\frac{\\varepsilon^2}{2}\\right)}\n$$", "id": "3164060"}, {"introduction": "定价规则的选择对单纯形法的性能有显著影响。一个好的定价规则应该是稳健的，其决策不应受到问题表述中的任意因素（例如变量的度量单位）的影响。本练习旨在探讨“尺度不变性”这一重要概念，它揭示了像丹齐格（Dantzig）规则这样的常用定价策略对于问题尺度变化的敏感性，并引出了为克服此缺陷而设计的更先进的规则，如最速下降边缘规则。通过分析列尺度变换带来的影响，你将对高级定价策略背后的设计原则有更深入的认识。[@problem_id:3164024]", "problem": "考虑一个标准形式的线性规划（LP）问题，目标函数为最大化 $c^{\\top} x$，约束条件为 $A x = b$, $x \\ge 0$。该问题正在通过原始单纯形法在一个非退化基本可行解处求解。\n\n设当前基矩阵为 $B$（$A$ 中对应于基变量的列的集合），并设 $c_B$ 为对应的基成本向量。对于一个下标为 $j$ 的非基列，将其在 $A$ 中的列记为 $a_j$，其目标系数记为 $c_j$。原始单纯形法为每个非基列计算检验数 $\\bar c_j$，并计算用于最小比值检验的主元方向向量 $d = B^{-1} a_j$。\n\n假设我们通过对变量 $x_j$ 的列和成本系数进行缩放（$a_j \\mapsto \\gamma a_j$ 和 $c_j \\mapsto \\gamma c_j$，其中标量 $\\gamma>0$）来改变它的物理单位，同时保持基 $B$ 和 $c_B$ 不变。检验此变换如何影响检验数和用于最小比值检验的主元方向，并判断哪些策略在这种列缩放变换下能保持决策不变。\n\n选择所有正确的陈述：\n\nA. 在 $a_j \\mapsto \\gamma a_j$, $c_j \\mapsto \\gamma c_j$（其中 $\\gamma>0$）的变换下，检验数变换为 $\\bar c_j^{\\prime} = \\gamma \\bar c_j$，主元方向变换为 $d^{\\prime} = \\gamma d$。因此，$\\bar c_j$ 的符号和标准最小比值检验选出的出基变量保持不变，尽管沿 $x_j$ 的步长按 $1/\\gamma$ 的因子进行了缩放。\n\nB. “最负检验数”定价规则（在所有负检验数中选择 $\\bar c_j$ 最小的 $j$）在对每个 $j$ 进行 $a_j \\mapsto \\gamma a_j$, $c_j \\mapsto \\gamma c_j$ 的变换下是不变的，因为检验数的绝对值排序得以保持。\n\nC. 一个尺度不变的定价分数是 $\\bar c_j / \\lVert a_j \\rVert_2$，因为在 $a_j \\mapsto \\gamma a_j$, $c_j \\mapsto \\gamma c_j$（其中 $\\gamma>0$）的变换下，分子和分母都按相同因子缩放，使得比值不变。\n\nD. 一个尺度不变的定价分数是 $\\bar c_j / \\lVert B^{-1} a_j \\rVert_2$，有时被称为“最陡边”风格的归一化，因为当 $a_j$ 和 $c_j$ 按相同的正数 $\\gamma$ 缩放时，$\\bar c_j$ 和 $B^{-1} a_j$ 都成比例地缩放。\n\nE. 在 $a_j \\mapsto \\gamma a_j$, $c_j \\mapsto \\gamma c_j$（其中 $\\gamma>0$）的变换下，由于单纯形表中主元列条目 $a_{ij}$ 的缩放，标准最小比值检验可能会选择一个不同的出基基本变量。\n\n选择所有适用的选项。", "solution": "该问题探讨线性规划中列缩放对单纯形法中不同量的影响。我们来逐一分析每个选项。\n给定变换 $c_j \\mapsto c_j' = \\gamma c_j$ 和 $a_j \\mapsto a_j' = \\gamma a_j$ (其中 $\\gamma > 0$) 。\n\n**变换对核心量的影响**\n\n1.  **检验数** ($\\bar{c}_j$)：\n    原始检验数为 $\\bar{c}_j = c_j - c_B^{\\top} B^{-1} a_j$。\n    变换后的检验数为 $\\bar{c}_j' = c_j' - c_B^{\\top} B^{-1} a_j' = \\gamma c_j - c_B^{\\top} B^{-1} (\\gamma a_j) = \\gamma (c_j - c_B^{\\top} B^{-1} a_j) = \\gamma \\bar{c}_j$。\n    检验数按 $\\gamma$ 因子缩放。因为 $\\gamma > 0$，所以 $\\bar{c}_j$ 的符号不变。\n\n2.  **主元方向** ($d = B^{-1} a_j$)：\n    原始主元方向为 $d = B^{-1} a_j$。\n    变换后的主元方向为 $d' = B^{-1} a_j' = B^{-1} (\\gamma a_j) = \\gamma (B^{-1} a_j) = \\gamma d$。\n    主元方向向量也按 $\\gamma$ 因子缩放。\n\n3.  **最小比值检验**：\n    原始最小比值检验计算步长 $\\theta = \\min_{i: d_i > 0} \\left\\{ \\frac{(x_B)_i}{d_i} \\right\\}$。\n    变换后的步长为 $\\theta' = \\min_{i: d'_i > 0} \\left\\{ \\frac{(x_B)_i}{d'_i} \\right\\} = \\min_{i: \\gamma d_i > 0} \\left\\{ \\frac{(x_B)_i}{\\gamma d_i} \\right\\}$。\n    因为 $\\gamma > 0$，条件 $\\gamma d_i > 0$ 等价于 $d_i > 0$。\n    $\\theta' = \\frac{1}{\\gamma} \\min_{i: d_i > 0} \\left\\{ \\frac{(x_B)_i}{d_i} \\right\\} = \\frac{\\theta}{\\gamma}$。\n    步长按 $1/\\gamma$ 因子缩放。\n    出基变量由达到最小比率的索引决定。由于 $1/\\gamma$ 是一个正的常数因子，它不改变哪个索引 $i$ 使比值最小。因此，出基变量保持不变。\n\n**评估选项**\n\n**A. 在 $a_j \\mapsto \\gamma a_j$, $c_j \\mapsto \\gamma c_j$（其中 $\\gamma>0$）的变换下，检验数变换为 $\\bar c_j^{\\prime} = \\gamma \\bar c_j$，主元方向变换为 $d^{\\prime} = \\gamma d$。因此，$\\bar c_j$ 的符号和标准最小比值检验选出的出基变量保持不变，尽管沿 $x_j$ 的步长按 $1/\\gamma$ 的因子进行了缩放。**\n根据我们的推导，这个陈述中的所有部分都是正确的。检验数和主元方向按 $\\gamma$ 缩放，符号和出基变量不变，步长按 $1/\\gamma$ 缩放。所以 A 是正确的。\n\n**B. “最负检验数”定价规则（在所有负检验数中选择 $\\bar c_j$ 最小的 $j$）在对每个 $j$ 进行 $a_j \\mapsto \\gamma a_j$, $c_j \\mapsto \\gamma c_j$ 的变换下是不变的，因为检验数的绝对值排序得以保持。**\n此规则（更确切地说是用于最大化问题的“最大正检验数”规则，即 Dantzig 规则）对列缩放不是不变的。如果不同的非基变量 $x_j$ 和 $x_k$ 被不同的因子 $\\gamma_j$ 和 $\\gamma_k$ 缩放，那么它们检验数的相对大小就会改变。例如，若 $\\bar{c}_j > \\bar{c}_k > 0$，我们选择 $x_j$。但如果我们用一个足够大的 $\\gamma_k$ 缩放 $x_k$ 的列，我们可能得到 $\\bar{c}_k' = \\gamma_k \\bar{c}_k > \\bar{c}_j' = \\bar{c}_j$，从而改变了选择。因此，该规则不是尺度不变的。所以 B 是不正确的。\n\n**C. 一个尺度不变的定价分数是 $\\bar c_j / \\lVert a_j \\rVert_2$，因为在 $a_j \\mapsto \\gamma a_j$, $c_j \\mapsto \\gamma c_j$（其中 $\\gamma>0$）的变换下，分子和分母都按相同因子缩放，使得比值不变。**\n让我们检验这个分数 $S_j = \\bar c_j / \\lVert a_j \\rVert_2$ 的变换。\n$S_j' = \\frac{\\bar{c}_j'}{\\lVert a_j' \\rVert_2} = \\frac{\\gamma \\bar{c}_j}{\\lVert \\gamma a_j \\rVert_2} = \\frac{\\gamma \\bar{c}_j}{|\\gamma| \\lVert a_j \\rVert_2}$。\n因为 $\\gamma > 0$，所以 $|\\gamma| = \\gamma$。\n$S_j' = \\frac{\\gamma \\bar{c}_j}{\\gamma \\lVert a_j \\rVert_2} = \\frac{\\bar{c}_j}{\\lVert a_j \\rVert_2} = S_j$。\n这个分数确实是尺度不变的。所以 C 是正确的。\n\n**D. 一个尺度不变的定价分数是 $\\bar c_j / \\lVert B^{-1} a_j \\rVert_2$，有时被称为“最陡边”风格的归一化，因为当 $a_j$ 和 $c_j$ 按相同的正数 $\\gamma$ 缩放时，$\\bar c_j$ 和 $B^{-1} a_j$ 都成比例地缩放。**\n让我们检验这个分数 $T_j = \\bar c_j / \\lVert B^{-1} a_j \\rVert_2$ 的变换。\n$T_j' = \\frac{\\bar{c}_j'}{\\lVert B^{-1} a_j' \\rVert_2} = \\frac{\\gamma \\bar{c}_j}{\\lVert B^{-1} (\\gamma a_j) \\rVert_2} = \\frac{\\gamma \\bar{c}_j}{\\lVert \\gamma (B^{-1} a_j) \\rVert_2} = \\frac{\\gamma \\bar{c}_j}{\\gamma \\lVert B^{-1} a_j \\rVert_2} = T_j$。\n这个分数也是尺度不变的，因为它将检验数的缩放与主元方向向量范数的缩放相抵消。这正是最速下降边缘（steepest-edge）定价规则背后的思想。所以 D 是正确的。\n\n**E. 在 $a_j \\mapsto \\gamma a_j$, $c_j \\mapsto \\gamma c_j$（其中 $\\gamma>0$）的变换下，由于单纯形表中主元列条目 $a_{ij}$ 的缩放，标准最小比值检验可能会选择一个不同的出基基本变量。**\n如上面第3点的分析所示，达到最小比率的索引不随公共正因子 $1/\\gamma$ 的变化而改变。因此，出基变量保持不变。这个陈述是错误的。所以 E 是不正确的。\n\n综上所述，正确的陈述是 A、C 和 D。", "answer": "$$\\boxed{ACD}$$", "id": "3164024"}]}