{"hands_on_practices": [{"introduction": "我们从一个实际场景开始：当一个优化模型已经找到最优解后，如果加入一个新的限制条件会发生什么？这个练习将指导你处理一个常见情况，即新约束使得当前最优解变得不可行。通过这个问题 ([@problem_id:3095270])，你将练习使用对偶单纯形法来恢复可行性并找到新的最优解，并学会将目标值的变化与影子价格联系起来，从而全面理解模型对新约束的敏感性。", "problem": "考虑一个具有松弛变量的不等式形式的线性规划问题：\n- 最大化目标函数 $z = 3 x_1 + 2 x_2$。\n- 满足约束条件\n  - $x_1 + x_2 \\leq 4$，\n  - $x_1 \\leq 2$，\n  - $x_2 \\leq 3$，\n  - $x_1 \\geq 0$, $x_2 \\geq 0$。\n引入松弛变量 $s_1$、$s_2$ 和 $s_3$，将约束条件写为 $x_1 + x_2 + s_1 = 4$，$x_1 + s_2 = 2$，$x_2 + s_3 = 3$，其中 $s_1, s_2, s_3 \\geq 0$。\n\n已知当前最优基由基变量 $\\{x_1, x_2, s_3\\}$ 组成，其基本可行解为 $(x_1, x_2, s_1, s_2, s_3) = (2, 2, 0, 0, 1)$，最优目标值为 $z^{\\star} = 10$。\n\n现在提出一个额外的线性约束，该约束会切除当前的最优顶点：\n- 新约束 $\\tilde{c}$：$x_1 + x_2 \\leq 3.9$，\n并添加一个松弛变量 $s_4 \\geq 0$，使得 $x_1 + x_2 + s_4 = 3.9$。\n\n仅从线性规划可行性和最优性的核心定义、以及原始-对偶关系和互补松弛性出发（不使用任何预先给定的捷径），完成以下任务：\n- 证明新约束 $\\tilde{c}$ 使得当前基本可行解变得不可行。\n- 设计一个从已知最优基到新的最优基本可行解的最小单纯形枢轴路径，以在添加 $\\tilde{c}$ 后恢复可行性和最优性。\n- 在 $b = 4$ 的邻域内，分析最优目标对形如 $x_1 + x_2 \\leq b$ 的约束右端项减小的局部灵敏度，并用此来验证添加 $\\tilde{c}$ 引起的最优目标值的变化。\n\n添加约束 $\\tilde{c}$ 后的新最优目标值是多少？将最终数值答案四舍五入到四位有效数字。", "solution": "用户提供了一个线性规划（LP）问题，并要求分析添加一个新约束的效果。任务包括证明在新约束下当前最优解的不可行性，使用单纯形枢轴找到新的最优解，并使用源自原始-对偶关系的灵敏度分析来验证结果。\n\n### 步骤 1：问题验证\n\n**1.1. 提取给定信息**\n- **目标函数（最大化）：** $z = 3 x_1 + 2 x_2$\n- **原始约束：**\n  - $x_1 + x_2 \\leq 4$\n  - $x_1 \\leq 2$\n  - $x_2 \\leq 3$\n  - $x_1 \\geq 0$, $x_2 \\geq 0$\n- **带松弛变量的标准形式（$s_1, s_2, s_3 \\geq 0$）：**\n  - $x_1 + x_2 + s_1 = 4$\n  - $x_1 + s_2 = 2$\n  - $x_2 + s_3 = 3$\n- **当前最优解信息：**\n  - **基变量：** $\\{x_1, x_2, s_3\\}$\n  - **基本可行解（BFS）：** $(x_1, x_2, s_1, s_2, s_3) = (2, 2, 0, 0, 1)$\n  - **最优目标值：** $z^{\\star} = 10$\n- **新提出的约束（$\\tilde{c}$）：**\n  - $x_1 + x_2 \\leq 3.9$\n  - **带松弛变量的标准形式（$s_4 \\geq 0$）：** $x_1 + x_2 + s_4 = 3.9$\n\n**1.2. 使用提取的给定信息进行验证**\n首先，我们验证所提供的原始问题的最优解。\n- **可行性：**\n  - $x_1 + x_2 = 2 + 2 = 4 \\leq 4$ (约束1成立, $s_1=0$)\n  - $x_1 = 2 \\leq 2$ (约束2成立, $s_2=0$)\n  - $x_2 = 2 \\leq 3$ (约束3成立, $s_3=1$)\n  - $x_1=2 \\geq 0$, $x_2=2 \\geq 0$ (非负性成立)\n该解是可行的。\n- **目标值：**\n  - $z = 3x_1 + 2x_2 = 3(2) + 2(2) = 6 + 4 = 10$。这与给定的 $z^\\star$ 相符。\n- **基：**\n  - 基变量为 $\\{x_1, x_2, s_3\\}$，其值为 $\\{2, 2, 1\\}$，均为非负。非基变量为 $\\{s_1, s_2\\}$，其值为 $\\{0, 0\\}$。这是一个有效的基本可行解。\n\n问题陈述是自洽的，科学上基于线性规划理论，并且内部一致。\n\n**1.3. 结论**\n问题是有效的。\n\n### 步骤 2：求解推导\n\n**2.1. 在新约束下当前解的不可行性**\n当前最优解为 $(x_1, x_2) = (2, 2)$。新约束为 $\\tilde{c}: x_1 + x_2 \\leq 3.9$。\n将 $x_1$ 和 $x_2$ 的值代入新约束：\n$$2 + 2 = 4$$\n值 $4$ 不小于或等于 $3.9$。因此，当前最优解 $(x_1, x_2) = (2, 2)$ 违反了新约束，对于修改后的问题不再可行。\n\n**2.2. 通过对偶单纯形法找到新最优解**\n我们首先构建原始问题的最终单纯形表。方程组为：\n$z - 3x_1 - 2x_2 = 0$\n$x_1 + x_2 + s_1 = 4$\n$x_1 + s_2 = 2$\n$x_2 + s_3 = 3$\n\n最优基为 $B=\\{x_1, x_2, s_3\\}$，非基变量为 $N=\\{s_1, s_2\\}$。我们需要用非基变量来表示基变量和目标函数。从第二个和第一个约束（$s_1=s_2=0$）：\n$x_1 = 2 - s_2$\n$x_2 = 4 - x_1 - s_1 = 4 - (2 - s_2) - s_1 = 2 - s_1 + s_2$\n再从第三个约束：\n$s_3 = 3 - x_2 = 3 - (2 - s_1 + s_2) = 1 + s_1 - s_2$\n\n将 $x_1$ 和 $x_2$ 代入目标函数：\n$z = 3(2-s_2) + 2(2-s_1+s_2) = 6 - 3s_2 + 4 - 2s_1 + 2s_2 = 10 - 2s_1 - s_2$\n这可以重写为 $z + 2s_1 + s_2 = 10$。\n\n原始问题的最终单纯形表代表了这个字典：\n$$\n\\begin{array}{c|c|ccccc|c}\n\\text{基}  z  x_1  x_2  s_1  s_2  s_3  \\text{RHS} \\\\\n\\hline\nz  1  0  0  2  1  0  10 \\\\\n\\hline\nx_1  0  1  0  0  1  0  2 \\\\\nx_2  0  0  1  1  -1  0  2 \\\\\ns_3  0  0  0  -1  1  1  1\n\\end{array}\n$$\nz-行中非基变量的系数都是非负的（$2$ 和 $1$），所以对于最大化问题，这确实是一个最优表。\n\n现在，我们添加新约束 $x_1 + x_2 + s_4 = 3.9$。我们必须用非基变量 $s_1, s_2$ 来表示这个约束：\n$$(2 - s_2) + (2 - s_1 + s_2) + s_4 = 3.9$$\n$$4 - s_1 + s_4 = 3.9$$\n$$s_4 = -0.1 + s_1$$\n这给出了新的约束行：$-s_1 + s_4 = -0.1$。我们将其添加到表中，并将 $s_4$ 作为该行的新基变量。\n\n$$\n\\begin{array}{c|c|cccccc|c}\n\\text{基}  z  x_1  x_2  s_1  s_2  s_3  s_4  \\text{RHS} \\\\\n\\hline\nz  1  0  0  2  1  0  0  10 \\\\\n\\hline\nx_1  0  1  0  0  1  0  0  2 \\\\\nx_2  0  0  1  1  -1  0  0  2 \\\\\ns_3  0  0  0  -1  1  1  0  1 \\\\\ns_4  0  0  0  -1  0  0  1  -0.1\n\\end{array}\n$$\nz-行仍然是最优的（所有系数 $\\ge 0$）。然而，解不是原始可行的，因为 $s_4 = -0.1$，这违反了非负性约束。这是对偶单纯形法的正确设置。\n\n**对偶单纯形枢轴变换：**\n1.  **选择枢轴行：** 选择 RHS 列中负值最大的行。这是 $s_4$ 行。变量 $s_4$ 将离开基。\n2.  **选择枢轴列：** 对于所有枢轴行条目 $a_{ij}$ 为负的 $j$，找到比率 $|\\frac{z_j-c_j}{a_{ij}}|$ 的最小值。枢轴行（$i=s_4$）只有一个负条目：$a_{s_4, s_1} = -1$。\n    比率为 $|\\frac{2}{-1}|=2$。因此，变量 $s_1$ 将进入基。枢轴元素是 $-1$。\n3.  **执行枢轴变换：**\n    - 将枢轴行（$s_4$ 行）除以枢轴元素（$-1$），使枢轴条目变为 $1$。新行成为下一个表中的 $s_1$ 行：\n    行 $s_1' = (0, 0, 0, 1, 0, 0, -1 | 0.1)$。\n    - 使用这个新行使枢轴列（$s_1$ 列）中的所有其他条目变为零。\n        - 新 z-行: 行 $z' = \\text{行 } z - 2 \\cdot \\text{行 } s_1' = (1, 0, 0, 0, 1, 0, 2 | 9.8)$。\n        - 新 $x_1$-行: 条目已经是 $0$，所以没有变化。行 $x_1'=$ 行 $x_1$。\n        - 新 $x_2$-行: 行 $x_2' = \\text{行 } x_2 - 1 \\cdot \\text{行 } s_1' = (0, 0, 1, 0, -1, 0, 1 | 1.9)$。\n        - 新 $s_3$-行: 行 $s_3' = \\text{行 } s_3 - (-1) \\cdot \\text{行 } s_1' = \\text{行 } s_3 + \\text{行 } s_1' = (0, 0, 0, 0, 1, 1, -1 | 1.1)$。\n\n新表为：\n$$\n\\begin{array}{c|c|cccccc|c}\n\\text{基}  z  x_1  x_2  s_1  s_2  s_3  s_4  \\text{RHS} \\\\\n\\hline\nz  1  0  0  0  1  0  2  9.8 \\\\\n\\hline\nx_1  0  1  0  0  1  0  0  2 \\\\\nx_2  0  0  1  0  -1  0  1  1.9 \\\\\ns_3  0  0  0  0  1  1  -1  1.1 \\\\\ns_1  0  0  0  1  0  0  -1  0.1\n\\end{array}\n$$\nRHS 列现在都是非负的，所以解是原始可行的。z-行系数都是非负的，所以它仍然是对偶可行的（最优的）。\n新的最优解是：一个 BFS，基变量为 $\\{x_1, x_2, s_3, s_1\\}$，非基变量为 $\\{s_2, s_4\\}$。\n- $x_1 = 2$\n- $x_2 = 1.9$\n- $s_3 = 1.1$\n- $s_1 = 0.1$\n- $s_2=0$, $s_4=0$\n新的最优目标值为 $z^{**} = 9.8$。\n\n**2.3. 使用灵敏度分析和原始-对偶理论进行验证**\n原始线性规划（P）及其对偶（D）为：\n(P) 最大化 $z = 3x_1 + 2x_2$ 满足\n$x_1 + x_2 \\leq 4$\n$x_1 \\leq 2$\n$x_2 \\leq 3$\n$x_1, x_2 \\geq 0$\n\n(D) 最小化 $w = 4y_1 + 2y_2 + 3y_3$ 满足\n$y_1 + y_2 \\geq 3$\n$y_1 + y_3 \\geq 2$\n$y_1, y_2, y_3 \\geq 0$\n\n原始最优解为 $(x_1, x_2) = (2, 2)$， $z^\\star=10$。\n根据互补松弛性：\n- $x_1=2 > 0 \\implies y_1 + y_2 = 3$。\n- $x_2=2 > 0 \\implies y_1 + y_3 = 2$。\n- 约束 $x_2 \\leq 3$ 不紧（$2  3$，所以松弛量 $s_3=1  0$） $\\implies y_3 = 0$。\n- 约束 $x_1+x_2 \\leq 4$ 和 $x_1 \\leq 2$ 是紧的（松弛量 $s_1=0, s_2=0$），所以它们的对偶变量 $y_1, y_2$ 可以非零。\n\n求解对偶变量：\n$y_3=0 \\implies y_1+0=2 \\implies y_1=2$。\n然后 $2+y_2=3 \\implies y_2=1$。\n最优对偶解是 $(y_1, y_2, y_3) = (2, 1, 0)$。这个解是对偶可行的。\n对偶变量 $y_1=2$ 是第一个约束 $x_1 + x_2 \\leq 4$ 的影子价格。它表示最优目标值相对于该约束右端项（RHS）变化的速率，即 $\\frac{\\partial z^\\star}{\\partial b_1} = y_1=2$。\n\n引入新约束 $x_1 + x_2 \\leq 3.9$ 使得原始约束 $x_1 + x_2 \\leq 4$ 变得多余。这等价于将第一个约束的右端项从 $b_1=4$ 变为 $b_1'=3.9$。变化量为 $\\Delta b_1 = 3.9 - 4 = -0.1$。\n这个变化很小，所以我们可以预测目标值的变化为：\n$$\\Delta z^\\star \\approx y_1 \\Delta b_1 = 2 \\times (-0.1) = -0.2$$\n预测的新最优值为 $z^\\star_{new} = z^\\star + \\Delta z^\\star = 10 - 0.2 = 9.8$。\n\n只要变化量 $\\Delta b_1$ 在最优基 $\\{x_1, x_2, s_3\\}$ 不变的范围内，这个预测就是精确的。这个范围由保持基本解 $x_B' = A_B^{-1}b'$ 非负来确定，其中 $b' = [4+\\Delta b_1, 2, 3]^T$。我们发现字典表达式为 $x_1=2$, $x_2=2+\\Delta b_1$, $s_3=1-\\Delta b_1$。可行性要求 $2 \\ge 0$, $2+\\Delta b_1 \\ge 0 \\implies \\Delta b_1 \\ge -2$，以及 $1-\\Delta b_1 \\ge 0 \\implies \\Delta b_1 \\le 1$。变化量 $\\Delta b_1 = -0.1$ 在区间 $[-2, 1]$ 内，所以基不改变，影子价格的计算是精确的。\n\n通过对偶单纯形法计算出的新最优值 $9.8$ 被灵敏度分析所证实。\n\n最后一个问题要求添加约束 $\\tilde{c}$ 后的新最优目标值，并四舍五入到四位有效数字。计算出的值恰好是 $9.8$。为了用四位有效数字表示，我们写成 $9.800$。", "answer": "$$\\boxed{9.800}$$", "id": "3095270"}, {"introduction": "在掌握了如何处理新约束后，我们转向另一个核心问题：如何评估引入一个新决策变量（例如一个新产品或新投资选项）的经济价值？这个练习 ([@problem_id:3095291]) 聚焦于折减成本 (reduced cost) 这一关键概念。你将通过计算来确定一个新变量在何种条件下才具有足够的吸引力，从而值得被纳入最优决策之中。", "problem": "考虑一个原始标准型的线性规划 (LP) 问题：最大化 $c^{\\top} x$，约束条件为 $A x = b$，$x \\ge 0$。当前的最优基使用了如下给出的 $2 \\times 2$ 基矩阵 $B$ 和基成本向量 $c_B$：\n$$\nB = \\begin{pmatrix} 2  1 \\\\ 1  1 \\end{pmatrix}, \\quad c_B = \\begin{pmatrix} 4 \\\\ 1 \\end{pmatrix}.\n$$\n提议在模型中加入一个新的决策变量 $x_{+}$。其约束列由一个非负参数 $\\alpha$ 进行缩放，即 $A_{+}(\\alpha) = \\alpha\\, a$，其中\n$$\na = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix},\n$$\n其目标系数为 $c_{+} = 5$。对于一个最大化问题，使用单纯形乘子 $y^{\\top} = c_B^{\\top} B^{-1}$ 和折减成本 $r_{+}(\\alpha) = c_{+} - y^{\\top} A_{+}(\\alpha)$ 的定义，确定临界值 $\\alpha^{\\star}$，在该值下折减成本 $r_{+}(\\alpha)$ 穿过零点，从而使得新变量 $x_{+}$ 恰好变得有吸引力可以进入基。\n\n请以最简精确形式提供一个实数作为最终答案。无需四舍五入。", "solution": "我们从线性规划 (LP) 的原始标准型开始：最大化 $c^{\\top} x$，约束条件为 $A x = b$，$x \\ge 0$。对于给定的基 $B$ 和基成本 $c_B$，单纯形乘子（也称为对偶价格）定义为\n$$\ny^{\\top} = c_B^{\\top} B^{-1}.\n$$\n对于任意非基列 $A_j$，在最大化问题中，折减成本定义为\n$$\nr_j = c_j - y^{\\top} A_j.\n$$\n当 $r_j  0$ 时，一个非基变量有吸引力可以进入基；其恰好变得有吸引力的阈值是 $r_j = 0$。\n\n这里，新变量 $x_{+}$ 的列为 $A_{+}(\\alpha) = \\alpha\\, a$，其中 $a = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$，目标系数为 $c_{+} = 5$。因此，其作为 $\\alpha$ 函数的折减成本为\n$$\nr_{+}(\\alpha) = c_{+} - y^{\\top} A_{+}(\\alpha) = c_{+} - \\alpha\\, y^{\\top} a.\n$$\n\n我们根据给定的 $B$ 和 $c_B$ 计算 $y^{\\top}$。首先求 $B^{-1}$。对于\n$$\nB = \\begin{pmatrix} 2  1 \\\\ 1  1 \\end{pmatrix},\n$$\n其行列式为 $\\det(B) = 2 \\cdot 1 - 1 \\cdot 1 = 1$，因此\n$$\nB^{-1} = \\begin{pmatrix} 1  -1 \\\\ -1  2 \\end{pmatrix}.\n$$\n于是，\n$$\ny^{\\top} = c_B^{\\top} B^{-1} = \\begin{pmatrix} 4  1 \\end{pmatrix} \\begin{pmatrix} 1  -1 \\\\ -1  2 \\end{pmatrix} = \\begin{pmatrix} 4 \\cdot 1 + 1 \\cdot (-1) \\quad,\\quad 4 \\cdot (-1) + 1 \\cdot 2 \\end{pmatrix} = \\begin{pmatrix} 3 \\quad,\\quad -2 \\end{pmatrix}.\n$$\n\n接下来计算 $y^{\\top} a$：\n$$\ny^{\\top} a = \\begin{pmatrix} 3  -2 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = 3 \\cdot 2 + (-2) \\cdot 1 = 6 - 2 = 4.\n$$\n\n因此，\n$$\nr_{+}(\\alpha) = c_{+} - \\alpha\\, (y^{\\top} a) = 5 - 4 \\alpha.\n$$\n临界值 $\\alpha^{\\star}$ 求解 $r_{+}(\\alpha^{\\star}) = 0$：\n$$\n5 - 4 \\alpha^{\\star} = 0 \\quad \\Longrightarrow \\quad \\alpha^{\\star} = \\frac{5}{4}.\n$$\n\n由于 $y^{\\top} a = 4  0$，对于最大化问题，当 $r_{+}(\\alpha)  0$ 时，即当 $\\alpha  \\alpha^{\\star}$ 时，新变量具有吸引力。所求的折减成本穿过零点的临界值为 $\\alpha^{\\star} = \\frac{5}{4}$。", "answer": "$$\\boxed{\\frac{5}{4}}$$", "id": "3095291"}, {"introduction": "在前一个练习的基础上，我们从具体计算转向更深刻的理论理解。如果一个新选项本质上是现有选项的某种“混合”，它能否改善我们的最优决策？这个问题 ([@problem_id:3095297]) 探讨了当一个新变量的约束列是现有列的凸组合时，其折减成本的结构性特点。这会促使你综合运用折减成本、对偶性和线性相关性的知识，来分析新变量进入最优基的条件，并理解其与多重最优解的关联。", "problem": "考虑不等式形式的线性规划\n$$\\min\\; c^\\top x \\quad \\text{subject to} \\quad A x \\le b,\\;\\; x \\ge 0,$$\n其中 $A \\in \\mathbb{R}^{m \\times n}$，$b \\in \\mathbb{R}^m$，$c \\in \\mathbb{R}^n$。假设该问题是可行的，具有由某个最优基本可行解达到的有限最优值，并且 $A$ 的任何列都不是零向量。引入松弛变量 $s \\in \\mathbb{R}^m_{\\ge 0}$ 以写出等价的等式形式\n$$\\min\\; c^\\top x + 0^\\top s \\quad \\text{subject to} \\quad A x + s = b,\\;\\; x \\ge 0,\\; s \\ge 0.$$\n令 $a_i$ 表示 $A$ 的第 $i$ 列，令 $r_i$ 表示 $x_i$ 关于某个最优对偶解的折减成本。\n\n现在考虑增加一个新的决策变量 $x_{n+1}$，其列向量为\n$$a_{n+1} \\;=\\; \\sum_{i=1}^n \\lambda_i\\, a_i,$$\n其中对于所有 $i$ 都有 $\\lambda_i \\ge 0$ 且 $\\sum_{i=1}^n \\lambda_i = 1$，并为其分配一个成本 $c_{n+1} \\in \\mathbb{R}$。换句话说，$a_{n+1}$ 是 $A$ 现有列向量的凸组合。\n\n下列哪个陈述是正确的？\n\nA. 如果 $c_{n+1} \\ge \\sum_{i=1}^n \\lambda_i c_i$，那么在添加 $x_{n+1}$ 后，原问题的当前最优基仍然是最优的。此外，如果 $c_{n+1}  \\sum_{i=1}^n \\lambda_i c_i$，那么 $x_{n+1}$ 在扩展后问题的任何最优基中都不能是基变量。\n\nB. 如果 $c_{n+1} = \\sum_{i=1}^n \\lambda_i c_i$，那么对于原问题的任何最优对偶解 $y^\\star$，$x_{n+1}$ 的折减成本等于 $\\sum_{i=1}^n \\lambda_i r_i(y^\\star)$；特别地，$x_{n+1}$ 在 $y^\\star$ 处的折减成本为零当且仅当每个具有 $\\lambda_i  0$ 的 $r_i(y^\\star)$ 都等于 $0$。\n\nC. 如果 $c_{n+1}  \\sum_{i=1}^n \\lambda_i c_i$，那么对于原问题的最优对偶解 $y^\\star$，$x_{n+1}$ 的折减成本必然为负；因此原最优解不能保持最优。\n\nD. 因为 $a_{n+1}$ 是现有列的凸组合，所以 $x_{n+1}$ 在等式形式线性规划的任何可行基中都永远不能是基变量。", "solution": "用户希望我验证并解决一个关于增加新变量的灵敏度分析的线性规划问题。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   一个不等式形式的线性规划 (LP)：$\\min\\; c^\\top x \\quad \\text{subject to} \\quad A x \\le b,\\;\\; x \\ge 0$，其中 $A \\in \\mathbb{R}^{m \\times n}$，$b \\in \\mathbb{R}^m$，$c \\in \\mathbb{R}^n$。\n-   该问题是可行的，并具有由一个最优基本可行解达到的有限最优值。\n-   $A$ 的任何列都不是零向量。\n-   一个带有松弛变量 $s \\in \\mathbb{R}^m_{\\ge 0}$ 的等价等式形式：$\\min\\; c^\\top x + 0^\\top s \\quad \\text{subject to} \\quad A x + s = b,\\;\\; x \\ge 0,\\; s \\ge 0.$\n-   $a_i$ 是 $A$ 的第 $i$ 列。\n-   $r_i$ 是 $x_i$ 关于某个最优对偶解的折减成本。\n-   增加了一个新的决策变量 $x_{n+1}$，其成本为 $c_{n+1} \\in \\mathbb{R}$。\n-   新变量的列向量是 $a_{n+1} = \\sum_{i=1}^n \\lambda_i a_i$，其中对于所有 $i=1, \\dots, n$ 都有 $\\lambda_i \\ge 0$ 且 $\\sum_{i=1}^n \\lambda_i = 1$。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n1.  **科学依据：** 该问题设置在线性规划和灵敏度分析的标准、完善的框架内。所有概念，如折减成本、对偶性和基本可行解，都是优化理论的基础。\n2.  **适定性：** 问题要求根据提供的设置评估几个陈述的真实性。该设置在数学上是精确的，允许对每个陈述进行严格、唯一的推导。\n3.  **客观性：** 问题使用形式化的数学语言陈述，不含任何主观或模糊的术语。\n4.  **完整性和一致性：** 问题提供了分析增加新变量影响所需的所有信息。存在最优基本可行解的假设确保了强对偶性成立且最优对偶解存在。已知条件中没有矛盾。\n5.  **其他缺陷：** 该问题并非微不足道、不切实际或无法验证。它是优化方法领域的标准理论问题。\n\n**步骤 3：结论与行动**\n\n问题陈述是有效的。我将继续推导解答。\n\n### 解的推导\n\n问题以不等式形式陈述，但为了进行基的分析，它被转换为等式形式。等式形式问题\n$$ \\min\\; \\begin{pmatrix} c \\\\ 0 \\end{pmatrix}^\\top \\begin{pmatrix} x \\\\ s \\end{pmatrix} \\quad \\text{subject to} \\quad \\begin{pmatrix} A  I \\end{pmatrix} \\begin{pmatrix} x \\\\ s \\end{pmatrix} = b, \\;\\; \\begin{pmatrix} x \\\\ s \\end{pmatrix} \\ge 0 $$\n的对偶问题由下式给出\n$$ \\max\\; b^\\top y \\quad \\text{subject to} \\quad A^\\top y \\le c, \\;\\; y \\le 0. $$\n这里，对偶变量 $y \\in \\mathbb{R}^m$ 与 $m$ 个等式约束相关联。原问题的一个最优基本可行解是最优的，当且仅当所有变量的折减成本都非负。对于成本系数为 $c_j$、约束列向量为 $a_j$ 的变量，其关于对偶解 $y$ 的折减成本定义为 $r_j(y) = c_j - y^\\top a_j$。\n\n令 $y^\\star$ 为对偶问题的一个最优解。原问题的最优性条件确保所有原始变量 $x_i$ 和松弛变量 $s_k$ 的折减成本都非负：\n1.  对于 $x_i$ ($i=1, \\dots, n$)：$r_i(y^\\star) = c_i - (y^\\star)^\\top a_i \\ge 0$。\n2.  对于 $s_k$ ($k=1, \\dots, m$)：$r_{s_k}(y^\\star) = 0 - (y^\\star)^\\top e_k = -y^\\star_k \\ge 0$，这与对偶约束 $y^\\star \\le 0$ 一致。\n\n现在，我们添加新变量 $x_{n+1}$，其成本为 $c_{n+1}$，列向量为 $a_{n+1} = \\sum_{i=1}^n \\lambda_i a_i$。当前的最优基（及其对应的最优对偶解 $y^\\star$）对于扩展后的问题保持最优，当且仅当新变量 $x_{n+1}$ 的折减成本也非负，即 $r_{n+1}(y^\\star) \\ge 0$。\n\n让我们计算 $x_{n+1}$ 关于 $y^\\star$ 的折减成本：\n$$ r_{n+1}(y^\\star) = c_{n+1} - (y^\\star)^\\top a_{n+1} $$\n代入 $a_{n+1} = \\sum_{i=1}^n \\lambda_i a_i$：\n$$ r_{n+1}(y^\\star) = c_{n+1} - (y^\\star)^\\top \\left( \\sum_{i=1}^n \\lambda_i a_i \\right) $$\n根据点积的线性性质：\n$$ r_{n+1}(y^\\star) = c_{n+1} - \\sum_{i=1}^n \\lambda_i (y^\\star)^\\top a_i $$\n根据 $x_i$ 的折减成本的定义，我们有 $(y^\\star)^\\top a_i = c_i - r_i(y^\\star)$。将此代入 $r_{n+1}(y^\\star)$ 的表达式中：\n$$ r_{n+1}(y^\\star) = c_{n+1} - \\sum_{i=1}^n \\lambda_i (c_i - r_i(y^\\star)) $$\n$$ r_{n+1}(y^\\star) = \\left( c_{n+1} - \\sum_{i=1}^n \\lambda_i c_i \\right) + \\sum_{i=1}^n \\lambda_i r_i(y^\\star) $$\n这个核心方程使我们能够评估给定的选项。\n\n### 逐项分析\n\n**A. 如果 $c_{n+1} \\ge \\sum_{i=1}^n \\lambda_i c_i$，那么在添加 $x_{n+1}$ 后，原问题的当前最优基仍然是最优的。此外，如果 $c_{n+1}  \\sum_{i=1}^n \\lambda_i c_i$，那么 $x_{n+1}$ 在扩展后问题的任何最优基中都不能是基变量。**\n\n*   **第一部分：** 假设 $c_{n+1} \\ge \\sum_{i=1}^n \\lambda_i c_i$。这意味着项 $\\left( c_{n+1} - \\sum_{i=1}^n \\lambda_i c_i \\right) \\ge 0$。由于 $y^\\star$ 是一个最优对偶解，所有折减成本 $r_i(y^\\star) \\ge 0$。我们还已知 $\\lambda_i \\ge 0$。因此，和 $\\sum_{i=1}^n \\lambda_i r_i(y^\\star) \\ge 0$。\n    新变量的折减成本是 $r_{n+1}(y^\\star) = (\\text{非负}) + (\\text{非负})$，这意味着 $r_{n+1}(y^\\star) \\ge 0$。由于所有原始变量的折减成本已经非负，而新变量的折减成本也是如此，因此满足最优性条件。当前的最优解仍然是最优的。该陈述的第一部分是正确的。\n\n*   **第二部分：** 假设 $c_{n+1}  \\sum_{i=1}^n \\lambda_i c_i$。项 $\\left( c_{n+1} - \\sum_{i=1}^n \\lambda_i c_i \\right)$ 严格为正。如前所述，$\\sum_{i=1}^n \\lambda_i r_i(y^\\star) \\ge 0$。因此，$r_{n+1}(y^\\star) = (\\text{严格为正}) + (\\text{非负})  0$。\n    扩展后问题的最优对偶解集是原问题最优对偶解集的子集。对于扩展后问题的任何最优对偶解 $y^{opt}$，它必须满足 $A^\\top y^{opt} \\le c$ 和 $y^{opt} \\le 0$，因此对于所有 $i=1, \\dots, n$ 都有 $r_i(y^{opt}) \\ge 0$。\n    因此，对于扩展后问题的任何最优对偶解 $y^{opt}$，其对 $x_{n+1}$ 的折减成本为 $r_{n+1}(y^{opt}) = (c_{n+1} - \\sum \\lambda_i c_i) + \\sum \\lambda_i r_i(y^{opt})  0$。\n    一个变量要被包含在最优基中，其关于与该基相关联的对偶解的折减成本必须为零。由于 $x_{n+1}$ 的折减成本对于*所有*最优对偶解都严格为正，所以它永远不可能为零。因此，$x_{n+1}$ 不能是扩展后问题任何最优基中的基变量。该陈述的第二部分是正确的。\n\n**结论：** 陈述 A **正确**。\n\n**B. 如果 $c_{n+1} = \\sum_{i=1}^n \\lambda_i c_i$，那么对于原问题的任何最优对偶解 $y^\\star$，$x_{n+1}$ 的折减成本等于 $\\sum_{i=1}^n \\lambda_i r_i(y^\\star)$；特别地，$x_{n+1}$ 在 $y^\\star$ 处的折减成本为零当且仅当每个具有 $\\lambda_i  0$ 的 $r_i(y^\\star)$ 都等于 $0$。**\n\n*   **第一部分：** 假设 $c_{n+1} = \\sum_{i=1}^n \\lambda_i c_i$。项 $\\left( c_{n+1} - \\sum_{i=1}^n \\lambda_i c_i \\right) = 0$。将此代入我们的核心方程：\n    $$ r_{n+1}(y^\\star) = 0 + \\sum_{i=1}^n \\lambda_i r_i(y^\\star) = \\sum_{i=1}^n \\lambda_i r_i(y^\\star) $$\n    这对任何对偶解 $y^\\star$ 都成立，无论其是否最优。所以第一部分是正确的。\n\n*   **第二部分：** 我们有 $r_{n+1}(y^\\star) = \\sum_{i=1}^n \\lambda_i r_i(y^\\star)$。\n    我们知道对于最优的 $y^\\star$，有 $\\lambda_i \\ge 0$ 和 $r_i(y^\\star) \\ge 0$。该和是非负项的和。这样的和为零，当且仅当和中的每一项都为零。也就是说，对于所有 $i=1, \\dots, n$，都有 $\\lambda_i r_i(y^\\star) = 0$。\n    这个条件满足的条件是，对于每个 $i$，要么 $\\lambda_i = 0$，要么 $r_i(y^\\star) = 0$。这等价于陈述：对于每个 $\\lambda_i  0$ 的索引 $i$，相应的折减成本 $r_i(y^\\star)$ 必须为 $0$。该陈述的第二部分是正确的。\n\n**结论：** 陈述 B **正确**。\n\n**C. 如果 $c_{n+1}  \\sum_{i=1}^n \\lambda_i c_i$，那么对于原问题的最优对偶解 $y^\\star$，$x_{n+1}$ 的折减成本必然为负；因此原最优解不能保持最优。**\n\n*   假设 $c_{n+1}  \\sum_{i=1}^n \\lambda_i c_i$。项 $\\left( c_{n+1} - \\sum_{i=1}^n \\lambda_i c_i \\right)$ 严格为负。\n    折减成本是 $r_{n+1}(y^\\star) = (\\text{严格为负}) + \\sum_{i=1}^n \\lambda_i r_i(y^\\star)$。\n    第二项 $\\sum_{i=1}^n \\lambda_i r_i(y^\\star)$ 是非负的。一个负数和一个非负数的和不一定为负。\n    举一个反例，考虑线性规划 $\\min\\; 10x_1$ subject to $x_1 \\le 1, x_1 \\ge 0$。最优解是 $x_1=0$，最优值为 $0$。等式形式的最优对偶解是 $y^\\star=0$。$x_1$ 的折减成本是 $r_1(y^\\star) = 10 - 0 \\cdot 1 = 10$。\n    现在增加一个新变量 $x_2$，其 $a_2 = a_1$ (因此 $\\lambda_1=1$)，成本为 $c_2 = 5$。\n    这满足条件 $c_2  \\sum\\lambda_i c_i$，因为 $5  10$。\n    $x_2$ 的折减成本是 $r_2(y^\\star) = (c_2 - c_1) + \\lambda_1 r_1(y^\\star) = (5 - 10) + 1 \\cdot 10 = -5 + 10 = 5$。\n    由于 $r_2(y^\\star)=5  0$，它不是负数。在这种情况下，原最优解仍然是最优的。“必然为负”的说法是错误的。\n\n**结论：** 陈述 C **不正确**。\n\n**D. 因为 $a_{n+1}$ 是现有列的凸组合，所以 $x_{n+1}$ 在等式形式线性规划的任何可行基中都永远不能是基变量。**\n\n*   这个陈述混淆了向量集的线性相关性与其中一个向量不能成为基的一部分。\n    等式形式线性规划的一个基是来自完整约束矩阵 $[A, a_{n+1}, I]$ 的 $m$ 个线性无关的列向量的集合。\n    关系 $a_{n+1} = \\sum_{i=1}^n \\lambda_i a_i$ 意味着列向量集合 $\\{a_{n+1}\\} \\cup \\{ a_i \\mid \\lambda_i  0 \\}$ 是线性相关的。这意味着这些特定的列向量不能同时全部在一个基中。但这并不妨碍 $a_{n+1}$ 与其他线性无关的列向量一起构成一个基。\n    举一个反例，令 $m=2, n=2$，且 $A = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}$。令 $\\lambda_1=0.5, \\lambda_2=0.5$。则 $a_1=\\begin{pmatrix}1\\\\0\\end{pmatrix}$，$a_2=\\begin{pmatrix}0\\\\2\\end{pmatrix}$，且 $a_{n+1}=a_3=0.5a_1+0.5a_2 = \\begin{pmatrix}0.5\\\\1\\end{pmatrix}$。\n    考虑列向量集合 $\\{a_1, a_3\\}$。由这些列向量构成的矩阵是 $\\begin{pmatrix} 1  0.5 \\\\ 0  1 \\end{pmatrix}$。其行列式为 $1 \\ne 0$。因此，$\\{a_1, a_3\\}$ 是 $\\mathbb{R}^2$ 中两个线性无关的向量集合，可以构成一个基。所以 $x_3$ (我们的 $x_{n+1}$) 可以是基变量。我们甚至可以选择一个向量 $b$ 使这个基可行。例如，如果 $b=\\begin{pmatrix}1.5 \\\\ 2\\end{pmatrix}$，那么基解为 $x_B = \\begin{pmatrix}x_1\\\\x_3\\end{pmatrix} = \\begin{pmatrix} 1  0.5 \\\\ 0  1 \\end{pmatrix}^{-1}\\begin{pmatrix}1.5 \\\\ 2\\end{pmatrix} = \\begin{pmatrix} 1  -0.5 \\\\ 0  1 \\end{pmatrix}\\begin{pmatrix}1.5 \\\\ 2\\end{pmatrix} = \\begin{pmatrix}0.5 \\\\ 2\\end{pmatrix} \\ge 0$。\n    该陈述的前提是错误的。\n\n**结论：** 陈述 D **不正确**。\n\n### 总结\n\n陈述 A 和 B 是正确的，而陈述 C 和 D 是错误的。", "answer": "$$\\boxed{AB}$$", "id": "3095297"}]}