{"hands_on_practices": [{"introduction": "本节练习将巩固您对偶理论的基础。我们将从第一性原理出发，利用拉格朗日对偶性推导一个标准形式线性规划的对偶问题。接着，通过一个具体的数值例子，我们将应用互补松弛性——KKT条件的一个直接推论——来揭示原始问题和对偶问题的解是如何紧密联系在一起的，并验证它们的对偶间隙为零。这个练习对于掌握对偶理论的内在机制至关重要。[@problem_id:3139594]", "problem": "考虑以下标准不等式形式的最小化线性规划（LP）问题：最小化线性目标函数，服从于线性不等式约束和非负性约束，\n$$\\min_{x \\in \\mathbb{R}^{n}} \\; c^{\\top} x \\quad \\text{subject to} \\quad A x \\ge b, \\; x \\ge 0,$$\n其中 $A \\in \\mathbb{R}^{m \\times n}$，$b \\in \\mathbb{R}^{m}$，且 $c \\in \\mathbb{R}^{n}$。使用基础的拉格朗日对偶框架以及弱对偶和强对偶的定义（不借用任何预先记忆的对偶公式），通过为每个不等式约束引入适当的非负拉格朗日乘子，推导出与上述原始问题相对应的对偶优化问题。清晰地陈述由此产生的对偶决策变量、约束和目标函数。\n\n接下来，具体到维度为 $m = 3$ 和 $n = 2$ 的实例，给定\n$$A = \\begin{pmatrix} 2  0 \\\\ 0  3 \\\\ 1  1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 4 \\\\ 3 \\\\ 5 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 5 \\\\ 4 \\end{pmatrix}.$$\n使用从LP的Karush-Kuhn-Tucker (KKT) 条件推导出的互补松弛性，确定在此实例中，哪些原始约束 $A x \\ge b$ 在最优解处是紧约束，哪些是松弛约束。然后，推断出一个对偶最优解，并通过强对偶验证其最优性。最后，计算此实例的最优原始目标值 $c^{\\top} x^{\\star}$，并将其表示为一个精确的实数。最终答案无需四舍五入。", "solution": "用户提供了一个关于线性规划（LP）对偶性的多部分问题。第一部分要求使用拉格朗日框架从第一性原理出发，对对偶问题进行形式化推导。第二部分涉及将此理论应用于一个具体的LP实例，以找到原始和对偶最优解，验证最优性，并确定最优目标值。\n\n### 问题验证\n\n**第一步：提取已知条件**\n\n问题提供了以下内容：\n1.  一个标准不等式形式的原始LP问题：\n    $$\\min_{x \\in \\mathbb{R}^{n}} \\; c^{\\top} x \\quad \\text{subject to} \\quad A x \\ge b, \\; x \\ge 0$$\n    其中 $A \\in \\mathbb{R}^{m \\times n}$，$b \\in \\mathbb{R}^{m}$，且 $c \\in \\mathbb{R}^{n}$。\n2.  一个任务，要求使用拉格朗日框架，引入非负拉格朗日乘子来推导对偶问题。\n3.  一个维度为 $m = 3$ 和 $n = 2$ 的具体实例：\n    $$A = \\begin{pmatrix} 2  0 \\\\ 0  3 \\\\ 1  1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 4 \\\\ 3 \\\\ 5 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 5 \\\\ 4 \\end{pmatrix}$$\n4.  一个任务，要求使用互补松弛性确定在此实例中哪些原始约束 $A x \\ge b$ 在最优解处是紧约束，推断一个对偶最优解，通过强对偶验证最优性，并计算最优原始目标值 $c^{\\top} x^{\\star}$。\n\n**第二步：使用提取的已知条件进行验证**\n\n该问题是数学优化领域中的一个标准、基础的练习，具体涉及线性规划中的对偶理论。\n-   **科学性**：该问题完全基于优化和线性代数中已建立的数学原理。它没有任何科学或事实上的不健全之处。\n-   **适定性**：该问题结构清晰。所要求的推导是一个标准程序，具体的LP实例定义明确且具有唯一的最优解，使其成为一个适定的问题。\n-   **客观性**：语言精确、数学化，没有任何主观性或模糊性。\n-   **完整性**：所有必要的数据（$A, b, c$）和理论背景（拉格朗日对偶、KKT条件、互补松弛性）都已提供，或是解决此类问题的标准先决条件。该问题是自包含的。\n\n**第三步：结论与行动**\n\n该问题是有效的。它是一个在数学优化领域中适定的、有科学依据的、客观的问题。我将继续提供完整解答。\n\n### 第一部分：对偶问题的推导\n\n原始问题给定为：\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\; c^{\\top} x \\quad \\text{subject to} \\quad A x \\ge b, \\; x \\ge 0\n$$\n为了应用拉格朗日框架，我们首先将不等式约束表示为 $f_i(x) \\le 0$ 的形式。这些约束是：\n1.  $A x \\ge b \\iff b - A x \\le 0$ （一组 $m$ 个不等式）\n2.  $x \\ge 0 \\iff -x \\le 0$ （一组 $n$ 个不等式）\n\n我们为这些约束中的每一个引入非负拉格朗日乘子。设 $\\lambda \\in \\mathbb{R}^m$ 是约束 $b - A x \\le 0$ 的乘子向量，因此 $\\lambda \\ge 0$。设 $\\mu \\in \\mathbb{R}^n$ 是约束 $-x \\le 0$ 的乘子向量，因此 $\\mu \\ge 0$。\n\n拉格朗日函数 $L(x, \\lambda, \\mu)$ 定义为目标函数加上乘子与其对应约束函数乘积的总和：\n$$\nL(x, \\lambda, \\mu) = c^{\\top} x + \\lambda^{\\top}(b - A x) + \\mu^{\\top}(-x)\n$$\n我们可以通过收集涉及原始变量 $x$ 的项来重新整理这些项：\n$$\nL(x, \\lambda, \\mu) = c^{\\top} x - \\lambda^{\\top} A x - \\mu^{\\top} x + \\lambda^{\\top} b\n$$\n$$\nL(x, \\lambda, \\mu) = (c^{\\top} - \\lambda^{\\top} A - \\mu^{\\top})x + b^{\\top} \\lambda\n$$\n使用转置可以更紧凑地写成：\n$$\nL(x, \\lambda, \\mu) = (c - A^{\\top} \\lambda - \\mu)^{\\top}x + b^{\\top} \\lambda\n$$\n拉格朗日对偶函数，记作 $g(\\lambda, \\mu)$，定义为拉格朗日函数对原始变量 $x$ 的下确界：\n$$\ng(\\lambda, \\mu) = \\inf_{x \\in \\mathbb{R}^n} L(x, \\lambda, \\mu) = \\inf_{x \\in \\mathbb{R}^n} \\left[ (c - A^{\\top} \\lambda - \\mu)^{\\top}x + b^{\\top} \\lambda \\right]\n$$\n下确界内的表达式是关于 $x$ 的一个仿射（线性加常数）函数。如果 $x$ 的系数向量非零，即 $c - A^{\\top} \\lambda - \\mu \\ne 0$，那么该函数下方无界，其下确界为 $-\\infty$。为了使对偶函数获得一个有限值， $x$ 的线性项必须消失。这对对偶变量 $\\lambda$ 和 $\\mu$ 施加了一个约束：\n$$\nc - A^{\\top} \\lambda - \\mu = 0\n$$\n当此条件成立时，拉格朗日函数变得与 $x$ 无关，其值即为 $b^{\\top} \\lambda$。因此，对偶函数为：\n$$\ng(\\lambda, \\mu) = \\begin{cases}\nb^{\\top}\\lambda  \\text{if } c - A^{\\top}\\lambda - \\mu = 0 \\\\\n-\\infty  \\text{otherwise}\n\\end{cases}\n$$\n对偶问题是在对偶变量的约束下最大化对偶函数：\n$$\n\\max_{\\lambda, \\mu} \\; g(\\lambda, \\mu) \\quad \\text{subject to} \\quad \\lambda \\ge 0, \\; \\mu \\ge 0\n$$\n最大化 $g(\\lambda, \\mu)$ 等价于在使 $g(\\lambda, \\mu)$ 有限的条件下最大化 $b^{\\top}\\lambda$。因此，对偶问题是：\n$$\n\\max_{\\lambda, \\mu} \\; b^{\\top}\\lambda \\quad \\text{subject to} \\quad c - A^{\\top}\\lambda - \\mu = 0, \\quad \\lambda \\ge 0, \\quad \\mu \\ge 0\n$$\n我们可以消去对偶变量 $\\mu$。约束 $c - A^{\\top}\\lambda - \\mu = 0$ 意味着 $\\mu = c - A^{\\top}\\lambda$。非负性约束 $\\mu \\ge 0$ 于是变为 $c - A^{\\top}\\lambda \\ge 0$，这等价于 $A^{\\top}\\lambda \\le c$。\n\n将此代回优化问题，我们得到仅用对偶变量 $\\lambda$ 表示的对偶问题：\n-   对偶决策变量： $\\lambda \\in \\mathbb{R}^m$。\n-   对偶目标函数：最大化 $b^{\\top}\\lambda$。\n-   对偶约束： $A^{\\top}\\lambda \\le c$ 和 $\\lambda \\ge 0$。\n\n最终得到的对偶问题是：\n$$\n\\max_{\\lambda \\in \\mathbb{R}^{m}} \\; b^{\\top} \\lambda \\quad \\text{subject to} \\quad A^{\\top}\\lambda \\le c, \\; \\lambda \\ge 0\n$$\n\n### 第二部分：具体实例分析\n\n问题给出了具体实例：\n$$A = \\begin{pmatrix} 2  0 \\\\ 0  3 \\\\ 1  1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 4 \\\\ 3 \\\\ 5 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 5 \\\\ 4 \\end{pmatrix}$$\n设 $x = (x_1, x_2)^{\\top}$。原始问题是：\n$$\n\\min_{x_1, x_2} \\; 5x_1 + 4x_2\n$$\n约束条件：\n$$\n\\begin{align*}\n2x_1 \\ge 4 \\\\\n3x_2 \\ge 3 \\\\\nx_1 + x_2 \\ge 5 \\\\\nx_1, x_2 \\ge 0\n\\end{align*}\n$$\n这些约束可简化为 $x_1 \\ge 2$，$x_2 \\ge 1$，以及 $x_1 + x_2 \\ge 5$。非负性约束 $x_1 \\ge 0, x_2 \\ge 0$ 是多余的。\n\n为找到最优原始解 $x^{\\star}$，我们可以考察可行域的顶点。边界是 $x_1=2$，$x_2=1$ 和 $x_1+x_2=5$。顶点是这些直线的可行交点。\n-   $x_1=2$ 和 $x_1+x_2=5$ 的交点：$2+x_2=5 \\implies x_2=3$。该点为 $(2, 3)$，是可行解。\n-   $x_2=1$ 和 $x_1+x_2=5$ 的交点：$x_1+1=5 \\implies x_1=4$。该点为 $(4, 1)$，是可行解。\n目标函数是 $z(x_1, x_2) = 5x_1 + 4x_2$。我们在各顶点处计算其值：\n-   在 $(2, 3)$ 处：$z = 5(2) + 4(3) = 10 + 12 = 22$。\n-   在 $(4, 1)$ 处：$z = 5(4) + 4(1) = 20 + 4 = 24$。\n最小目标值为 $22$，在最优原始解 $x^{\\star} = (2, 3)^{\\top}$ 处取得。\n\n现在我们确定在 $x^{\\star} = (2, 3)$ 处，$A x \\ge b$ 的哪些约束是紧约束：\n1.  $2x_1^{\\star} \\ge 4 \\implies 2(2) = 4$。这是**紧约束**。\n2.  $3x_2^{\\star} \\ge 3 \\implies 3(3) = 9 > 3$。这是**松弛约束**。\n3.  $x_1^{\\star} + x_2^{\\star} \\ge 5 \\implies 2+3 = 5$。这是**紧约束**。\n\nLP的Karush-Kuhn-Tucker (KKT) 条件蕴含了互补松弛性。设 $\\lambda = (\\lambda_1, \\lambda_2, \\lambda_3)^{\\top}$ 为对偶变量。互补松弛性条件是：\n-   $\\lambda_i ((Ax^{\\star})_i - b_i) = 0$ 对于 $i=1, 2, 3$。\n-   $(c - A^{\\top}\\lambda^{\\star})_j x_j^{\\star} = 0$ 对于 $j=1, 2$。\n\n根据第一组条件，由于第二个原始约束是松弛的，其对应的对偶变量必须为零：$\\lambda_2^{\\star} = 0$。\n\n根据第二组条件：\n-   对于 $j=1$：$x_1^{\\star} = 2 > 0$，所以第一个对偶约束必须是紧约束：$(A^{\\top}\\lambda^{\\star})_1 = c_1$。\n    使用 $A^{\\top} = \\begin{pmatrix} 2  0  1 \\\\ 0  3  1 \\end{pmatrix}$，这即是 $2\\lambda_1^{\\star} + 0\\lambda_2^{\\star} + 1\\lambda_3^{\\star} = 5 \\implies 2\\lambda_1^{\\star} + \\lambda_3^{\\star} = 5$。\n-   对于 $j=2$：$x_2^{\\star} = 3 > 0$，所以第二个对偶约束必须是紧约束：$(A^{\\top}\\lambda^{\\star})_2 = c_2$。\n    这即是 $0\\lambda_1^{\\star} + 3\\lambda_2^{\\star} + 1\\lambda_3^{\\star} = 4 \\implies 3\\lambda_2^{\\star} + \\lambda_3^{\\star} = 4$。\n\n我们现在有一个方程组来求解对偶最优解 $\\lambda^{\\star}$：\n1.  $\\lambda_2^{\\star} = 0$\n2.  $2\\lambda_1^{\\star} + \\lambda_3^{\\star} = 5$\n3.  $3\\lambda_2^{\\star} + \\lambda_3^{\\star} = 4$\n\n将 $\\lambda_2^{\\star}=0$ 代入第三个方程，得到 $3(0) + \\lambda_3^{\\star} = 4$，所以 $\\lambda_3^{\\star} = 4$。\n将 $\\lambda_3^{\\star}=4$ 代入第二个方程，得到 $2\\lambda_1^{\\star} + 4 = 5$，所以 $2\\lambda_1^{\\star} = 1$，即 $\\lambda_1^{\\star} = \\frac{1}{2}$。\n推断出的对偶最优解为 $\\lambda^{\\star} = (\\frac{1}{2}, 0, 4)^{\\top}$。\n\n为了验证最优性，我们使用强对偶。我们检查原始和对偶目标值是否相等。\n-   原始最优目标值：$p^{\\star} = c^{\\top}x^{\\star} = 5(2) + 4(3) = 22$。\n-   对偶最优目标值：$d^{\\star} = b^{\\top}\\lambda^{\\star} = 4\\lambda_1^{\\star} + 3\\lambda_2^{\\star} + 5\\lambda_3^{\\star} = 4(\\frac{1}{2}) + 3(0) + 5(4) = 2 + 0 + 20 = 22$。\n\n由于 $p^{\\star} = d^{\\star} = 22$，并且 $x^{\\star}$ 和 $\\lambda^{\\star}$ 对其各自的问题都是可行的（我们必须检查 $\\lambda^{\\star}$ 的对偶可行性：$\\lambda^{\\star} \\ge 0$ 为真，且 $A^{\\top}\\lambda^{\\star} \\le c$ 也为真，因为两个约束都以等式形式成立），我们验证了两个解的最优性。\n\n最后的要求是计算最优原始目标值 $c^{\\top}x^{\\star}$。如计算所示，该值为 $22$。", "answer": "$$\n\\boxed{22}\n$$", "id": "3139594"}, {"introduction": "在线性规划的基础上，本节练习将对偶性推广到更一般的凸优化问题中，具体来说是一个二次规划问题。我们会发现强对偶性在这种情况下依然成立，但其保证需要依赖于约束规范 (constraint qualification) ，例如斯莱特条件 (Slater's condition)。通过这个练习，您将学会如何验证这些条件，并运用完整的KKT条件来求解一个无约束最优解恰好满足所有约束的特殊情况。[@problem_id:3198146]", "problem": "考虑 $x \\in \\mathbb{R}^{2}$ 上的凸优化问题，其目标函数为 $f(x) = \\frac{1}{2} x^{\\top} Q x + c^{\\top} x$，并带有线性不等式约束和边界约束。令\n$$\nQ = \\begin{pmatrix}\n2  0 \\\\\n0  4\n\\end{pmatrix}, \\quad\nc = \\begin{pmatrix}\n-2 \\\\\n-6\n\\end{pmatrix}, \\quad\nA = \\begin{pmatrix}\n1  2 \\\\\n-1  1\n\\end{pmatrix}, \\quad\nb = \\begin{pmatrix}\n5 \\\\\n1\n\\end{pmatrix}, \\quad\nl = \\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}, \\quad\nu = \\begin{pmatrix}\n3 \\\\\n2\n\\end{pmatrix}.\n$$\n约束条件为 $A x \\le b$ 和 $l \\le x \\le u$，这些不等式是分量形式的。仅使用凸优化的基本定义——即拉格朗日函数、对偶函数、对偶问题、Karush–Kuhn–Tucker (KKT) 条件和 Slater 条件——执行以下操作：\n\n1. 为线性不等式 $A x \\le b$ 引入拉格朗日乘子 $\\lambda \\in \\mathbb{R}^{2}_{+}$，为上界不等式 $x - u \\le 0$ 引入 $\\mu \\in \\mathbb{R}^{2}_{+}$，为下界不等式 $l - x \\le 0$ 引入 $\\nu \\in \\mathbb{R}^{2}_{+}$，从而构造拉格朗日函数 $L(x, \\lambda, \\mu, \\nu)$。\n\n2. 通过在 $x \\in \\mathbb{R}^{2}$ 上最小化拉格朗日函数，推导出对偶函数 $g(\\lambda, \\mu, \\nu)$，并写出相应的对偶优化问题。\n\n3. 通过证明存在一个点 $x$ 满足 $Ax  b$ 和 $l  x  u$ 来确立 Slater 条件，从而证明该问题满足强对偶性。\n\n4. 使用 KKT 条件确定原始最优解和对偶最优解，并计算最优目标值 $p^{\\star}$。\n\n报告 $p^{\\star}$ 的精确值作为唯一的最终答案，无需四舍五入。不涉及物理单位。", "solution": "用户提供了一个凸优化问题，要求使用拉格朗日对偶和 Karush–Kuhn–Tucker (KKT) 条件的理论进行分析和求解。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**步骤1：提取已知条件**\n- 目标函数：$f(x) = \\frac{1}{2} x^{\\top} Q x + c^{\\top} x$，定义在 $x \\in \\mathbb{R}^{2}$ 上。\n- 矩阵和向量：\n$$\nQ = \\begin{pmatrix}\n2  0 \\\\\n0  4\n\\end{pmatrix}, \\quad\nc = \\begin{pmatrix}\n-2 \\\\\n-6\n\\end{pmatrix}, \\quad\nA = \\begin{pmatrix}\n1  2 \\\\\n-1  1\n\\end{pmatrix}, \\quad\nb = \\begin{pmatrix}\n5 \\\\\n1\n\\end{pmatrix}, \\quad\nl = \\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}, \\quad\nu = \\begin{pmatrix}\n3 \\\\\n2\n\\end{pmatrix}.\n$$\n- 约束条件：$A x \\le b$ 和 $l \\le x \\le u$，按分量解释。\n- 任务：\n  1. 构造拉格朗日函数 $L(x, \\lambda, \\mu, \\nu)$。\n  2. 推导对偶函数 $g(\\lambda, \\mu, \\nu)$ 和对偶问题。\n  3. 通过 Slater 条件证明强对偶性成立。\n  4. 使用 KKT 条件找到原始和对偶最优解以及最优值 $p^{\\star}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题是一个二次规划问题。目标函数 $f(x)$ 是凸函数，因为其海森矩阵 $Q$ 是正定的（其特征值为 2 和 4，均为正数）。约束条件是线性的，定义了一个凸可行集（一个多胞体）。在凸集上最小化凸函数是标准的凸优化问题。所要求的任务是凸优化理论中的标准程序。该问题是自洽的、数学上适定的，并在优化方法领域有科学依据。未检测到任何缺陷。\n\n**步骤3：结论和行动**\n问题有效。我将继续进行求解。\n\n### 求解\n\n原始优化问题为：\n$$\n\\begin{aligned}\n\\text{minimize} \\quad  f(x) = \\frac{1}{2} x^{\\top} Q x + c^{\\top} x \\\\\n\\text{subject to} \\quad  A x - b \\le 0 \\\\\n x - u \\le 0 \\\\\n l - x \\le 0\n\\end{aligned}\n$$\n其中 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} \\in \\mathbb{R}^2$。\n\n**1. 拉格朗日函数**\n\n我们为约束 $A x - b \\le 0$ 引入拉格朗日乘子 $\\lambda \\in \\mathbb{R}^{2}_{+}$，为 $x - u \\le 0$ 引入 $\\mu \\in \\mathbb{R}^{2}_{+}$，为 $l - x \\le 0$ 引入 $\\nu \\in \\mathbb{R}^{2}_{+}$。拉格朗日函数 $L(x, \\lambda, \\mu, \\nu)$ 定义为：\n$$\nL(x, \\lambda, \\mu, \\nu) = f(x) + \\lambda^{\\top}(A x - b) + \\mu^{\\top}(x - u) + \\nu^{\\top}(l - x)\n$$\n代入 $f(x)$ 的表达式并根据 $x$ 重新整理各项：\n$$\nL(x, \\lambda, \\mu, \\nu) = \\frac{1}{2} x^{\\top} Q x + c^{\\top} x + \\lambda^{\\top} A x - \\lambda^{\\top} b + \\mu^{\\top} x - \\mu^{\\top} u + \\nu^{\\top} l - \\nu^{\\top} x\n$$\n$$\nL(x, \\lambda, \\mu, \\nu) = \\frac{1}{2} x^{\\top} Q x + (c^{\\top} + \\lambda^{\\top} A + \\mu^{\\top} - \\nu^{\\top}) x - (\\lambda^{\\top} b + \\mu^{\\top} u - \\nu^{\\top} l)\n$$\n\n**2. 对偶函数和对偶问题**\n\n拉格朗日对偶函数 $g(\\lambda, \\mu, \\nu)$ 是拉格朗日函数关于 $x$ 的下确界：\n$$\ng(\\lambda, \\mu, \\nu) = \\inf_{x \\in \\mathbb{R}^{2}} L(x, \\lambda, \\mu, \\nu)\n$$\n由于 $L$ 是关于 $x$ 的凸二次函数（因为 $Q$ 是正定的），其下确界在它关于 $x$ 的梯度为零时取得：\n$$\n\\nabla_x L(x, \\lambda, \\mu, \\nu) = Q x + c + A^{\\top}\\lambda + \\mu - \\nu = 0\n$$\n求解 $x$，我们得到唯一的最小化点 $x^*(\\lambda, \\mu, \\nu)$：\n$$\nx^*(\\lambda, \\mu, \\nu) = -Q^{-1}(c + A^{\\top}\\lambda + \\mu - \\nu)\n$$\n将 $x^*$ 代回拉格朗日表达式，并利用 $(c + A^{\\top}\\lambda + \\mu - \\nu) = -Q x^*$ 这一事实：\n$$\ng(\\lambda, \\mu, \\nu) = \\frac{1}{2} (x^*)^{\\top} Q x^* + (c^{\\top} + \\lambda^{\\top} A + \\mu^{\\top} - \\nu^{\\top}) x^* - (b^{\\top}\\lambda + u^{\\top}\\mu - l^{\\top}\\nu)\n$$\n$$\ng(\\lambda, \\mu, \\nu) = \\frac{1}{2} (x^*)^{\\top} Q x^* - (x^*)^{\\top} Q x^* - (b^{\\top}\\lambda + u^{\\top}\\mu - l^{\\top}\\nu)\n$$\n$$\ng(\\lambda, \\mu, \\nu) = -\\frac{1}{2} (x^*)^{\\top} Q x^* - (b^{\\top}\\lambda + u^{\\top}\\mu - l^{\\top}\\nu)\n$$\n代入 $x^*$ 的表达式：\n$$\ng(\\lambda, \\mu, \\nu) = -\\frac{1}{2} (c + A^{\\top}\\lambda + \\mu - \\nu)^{\\top} Q^{-1} (c + A^{\\top}\\lambda + \\mu - \\nu) - b^{\\top}\\lambda - u^{\\top}\\mu + l^{\\top}\\nu\n$$\n对偶问题是在乘子非负的约束下最大化对偶函数：\n$$\n\\begin{aligned}\n\\text{maximize} \\quad  g(\\lambda, \\mu, \\nu) \\\\\n\\text{subject to} \\quad  \\lambda \\ge 0, \\mu \\ge 0, \\nu \\ge 0\n\\end{aligned}\n$$\n\n**3. 强对偶性与 Slater 条件**\n\n如果 Slater 条件满足，则强对偶性成立。由于所有约束都是线性的（仿射的），Slater 条件要求存在一个严格可行的点 $x$。也就是说，我们需要找到一个点 $x = (x_1, x_2)^{\\top}$ 使得 $Ax  b$ 和 $l  x  u$。\n严格不等式为：\n1. $x_1 + 2x_2  5$\n2. $-x_1 + x_2  1$\n3. $0  x_1  3$\n4. $0  x_2  2$\n\n我们来测试点 $x = \\begin{pmatrix} 1.5 \\\\ 1 \\end{pmatrix}$。\n1. $1.5 + 2(1) = 3.5  5$ (满足)。\n2. $-1.5 + 1 = -0.5  1$ (满足)。\n3. $0  1.5  3$ (满足)。\n4. $0  1  2$ (满足)。\n由于存在严格可行点，Slater 条件成立。这意味着强对偶性成立，即原始最优值 $p^{\\star}$ 等于对偶最优值 $d^{\\star}$，并且对偶最优值是可以达到的。\n\n**4. KKT 条件与最优解**\n\n因为问题是凸的且 Slater 条件成立，Karush–Kuhn–Tucker (KKT) 条件是最优性的充要条件。一个点 $x^*$ 是原始最优解且 $(\\lambda^*, \\mu^*, \\nu^*)$ 是对偶最优解，当且仅当它们满足 KKT 条件：\n\n1.  **平稳性 (Stationarity):** $\\nabla_x L(x^*, \\lambda^*, \\mu^*, \\nu^*) = 0 \\implies Qx^* + c + A^{\\top}\\lambda^* + \\mu^* - \\nu^* = 0$。\n2.  **原始可行性 (Primal Feasibility):** $Ax^* - b \\le 0$, $x^* - u \\le 0$, $l - x^* \\le 0$。\n3.  **对偶可行性 (Dual Feasibility):** $\\lambda^* \\ge 0$, $\\mu^* \\ge 0$, $\\nu^* \\ge 0$。\n4.  **互补松弛性 (Complementary Slackness):** $\\lambda_i^*(A_i x^* - b_i) = 0$, $\\mu_j^*(x_j^* - u_j) = 0$, $\\nu_j^*(l_j - x_j^*) = 0$ 对所有分量 $i,j$ 成立。\n\n我们首先通过将 $f(x)$ 的梯度设为零来找到其无约束最小值：\n$$\n\\nabla f(x) = Qx + c = \\begin{pmatrix} 2  0 \\\\ 0  4 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ -6 \\end{pmatrix} = \\begin{pmatrix} 2x_1 - 2 \\\\ 4x_2 - 6 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这得到 $x_1 = 1$ 和 $x_2 = 1.5$。我们来检验这个点 $x = \\begin{pmatrix} 1 \\\\ 1.5 \\end{pmatrix}$ 是否可行。\n-   **原始可行性检验：**\n    -   $Ax \\le b$:\n        $1 + 2(1.5) = 4 \\le 5$ (成立)\n        $-1 + 1.5 = 0.5 \\le 1$ (成立)\n    -   $l \\le x \\le u$:\n        $0 \\le 1 \\le 3$ (成立)\n        $0 \\le 1.5 \\le 2$ (成立)\n\n无约束最小化点是可行的。由于它在整个 $\\mathbb{R}^2$ 上最小化了目标函数，那么它也必定是在更小的可行集上的最小化点。因此，原始最优解是 $x^* = \\begin{pmatrix} 1 \\\\ 1.5 \\end{pmatrix}$。\n\n现在我们确定对偶最优变量。由于 $x^*$ 位于可行域的严格内部，所有不等式约束都是非激活的：\n-   $x_1^* + 2x_2^* - 5 = 4 - 5 = -1  0$\n-   $-x_1^* + x_2^* - 1 = 0.5 - 1 = -0.5  0$\n-   $x_1^* - 3 = 1 - 3 = -2  0$\n-   $x_2^* - 2 = 1.5 - 2 = -0.5  0$\n-   $0 - x_1^* = -1  0$\n-   $0 - x_2^* = -1.5  0$\n\n根据互补松弛性条件，由于没有任何不等式约束是激活的（即，以等式成立），所有拉格朗日乘子必须为零：\n$$\n\\lambda^* = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\quad \\mu^* = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\quad \\nu^* = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这满足对偶可行性（$\\lambda^*, \\mu^*, \\nu^* \\ge 0$）。\n最后，我们用这些值检查平稳性条件：\n$$\nQx^* + c + A^{\\top}\\lambda^* + \\mu^* - \\nu^* = Qx^* + c = \\begin{pmatrix} 2(1) - 2 \\\\ 4(1.5) - 6 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n平稳性条件得到满足。\n因此，原始-对偶解对 $(x^*, \\lambda^*, \\mu^*, \\nu^*)$，其中 $x^* = \\begin{pmatrix} 1 \\\\ 1.5 \\end{pmatrix}$ 且所有乘子都为零，满足所有 KKT 条件。\n\n最优目标值 $p^{\\star}$ 是通过在 $x^*$ 处计算 $f(x)$ 得到的：\n$$\np^{\\star} = f(x^*) = \\frac{1}{2} (x^*)^{\\top} Q x^* + c^{\\top} x^*\n$$\n$$\np^{\\star} = \\frac{1}{2} \\begin{pmatrix} 1  1.5 \\end{pmatrix} \\begin{pmatrix} 2  0 \\\\ 0  4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1.5 \\end{pmatrix} + \\begin{pmatrix} -2  -6 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1.5 \\end{pmatrix}\n$$\n$$\np^{\\star} = \\frac{1}{2} \\left( 2(1)^2 + 4(1.5)^2 \\right) + (-2(1) - 6(1.5))\n$$\n$$\np^{\\star} = \\frac{1}{2} \\left( 2 + 4(2.25) \\right) + (-2 - 9)\n$$\n$$\np^{\\star} = \\frac{1}{2} (2 + 9) - 11 = \\frac{11}{2} - 11 = -\\frac{11}{2}\n$$\n或者，使用分数表示：$x^* = \\begin{pmatrix} 1 \\\\ 3/2 \\end{pmatrix}$\n$$\np^{\\star} = \\frac{1}{2} \\left( 2(1)^2 + 4(\\frac{3}{2})^2 \\right) + (-2(1) - 6(\\frac{3}{2})) = \\frac{1}{2} \\left( 2 + 4(\\frac{9}{4}) \\right) + (-2 - 9) = \\frac{1}{2}(2+9) - 11 = \\frac{11}{2} - 11 = -\\frac{11}{2}\n$$\n\n最优目标值为 $-\\frac{11}{2}$。", "answer": "$$\n\\boxed{-\\frac{11}{2}}\n$$", "id": "3198146"}, {"introduction": "如果优化问题不是凸的，会发生什么呢？最后一个练习将通过一个简单的非凸问题来精确计算并理解对偶间隙。通过分别求解原始问题和对偶问题的最优值，我们将证明弱对偶性 ($p^* \\ge d^*$) 始终成立，而强对偶性失效，从而产生一个非零的间隙。这个练习对于理解凸性在优化理论中的核心作用至关重要。[@problem_id:3217490]", "problem": "考虑以下带决策变量 $x_{1}$ 和 $x_{2}$ 的约束最小化问题：\n最小化 $f(x_{1}, x_{2}) = x_{1} + x_{2}$，服从不等式约束 $x_{1} x_{2} \\geq 1$、$x_{1} \\geq 0$ 和 $x_{2} \\geq 0$。\n当写成标准不等式形式 $g_{i}(x_{1}, x_{2}) \\leq 0$ 时，该问题是非凸的，因为函数 $g(x_{1}, x_{2}) = 1 - x_{1} x_{2}$ 不是凸函数，尽管可行集是闭合且非空的。利用拉格朗日量的基本定义、对偶函数作为对原始变量的下确界以及弱对偶性，确定此问题的精确原始最优值和精确对偶最优值。然后计算对偶间隙，定义为 $p^{\\star} - d^{\\star}$，其中 $p^{\\star}$ 是原始最优值，$d^{\\star}$ 是对偶最优值。请提供您的最终答案，为一个无单位的精确数字。无需四舍五入。", "solution": "用户要求我解决以下问题：\n最小化 $f(x_{1}, x_{2}) = x_{1} + x_{2}$，服从不等式约束 $x_{1} x_{2} \\geq 1$、$x_{1} \\geq 0$ 和 $x_{2} \\geq 0$。\n\n### 步骤1：提取给定条件\n- 待最小化的目标函数：$f(x_{1}, x_{2}) = x_{1} + x_{2}$。\n- 决策变量：$x_{1}, x_{2}$。\n- 约束条件：\n  1. $g_1(x_1, x_2): x_{1} x_{2} \\geq 1$\n  2. $g_2(x_1, x_2): x_{1} \\geq 0$\n  3. $g_3(x_1, x_2): x_{2} \\geq 0$\n- 问题指出，将第一个约束表示为 $1 - x_1 x_2 \\leq 0$ 使其成为非凸的。\n\n### 步骤2：使用提取的给定条件进行验证\n该问题是数值方法和科学计算领域中一个定义明确的约束优化问题。\n- **科学依据**：该问题基于优化理论的数学原理。所有函数都是标准的代数函数。拉格朗日对偶性、原始/对偶问题和对偶间隙等概念是该领域的核心。声称 $g(x_1, x_2) = 1 - x_1 x_2$ 是非凸的是正确的；其海森矩阵为 $\\begin{pmatrix} 0  -1 \\\\ -1  0 \\end{pmatrix}$，其特征值为 $\\pm 1$，因此是不定的。\n- **适定的**：该问题是自洽的。它有明确的目标函数和非空的可行域。原始问题存在唯一的最优解。对偶问题也是定义明确的。\n- **客观性**：语言精确，没有歧义或主观论断。\n\n问题有效。\n\n### 步骤3：结论与行动\n问题有效。我现在将进行求解。\n\n### 原始问题\n原始问题是要求解在约束条件 $x_{1} x_{2} \\geq 1$、$x_{1} \\geq 0$ 和 $x_{2} \\geq 0$ 下 $f(x_{1}, x_{2}) = x_{1} + x_{2}$ 的最小值。令 $p^{\\star}$ 表示原始最优值。\n\n约束条件 $x_{1} \\geq 0$、$x_{2} \\geq 0$ 和 $x_{1}x_{2} \\geq 1$ 意味着我们必须有 $x_{1} > 0$ 和 $x_{2} > 0$。\n根据算术平均值-几何平均值（AM-GM）不等式，对于任何非负数 $x_{1}$ 和 $x_{2}$，我们有：\n$$ \\frac{x_{1} + x_{2}}{2} \\geq \\sqrt{x_{1}x_{2}} $$\n使用约束条件 $x_{1}x_{2} \\geq 1$，我们可以写出：\n$$ \\sqrt{x_{1}x_{2}} \\geq \\sqrt{1} = 1 $$\n结合这些不等式可得：\n$$ \\frac{x_{1} + x_{2}}{2} \\geq 1 $$\n$$ x_{1} + x_{2} \\geq 2 $$\n这表明目标函数 $f(x_{1}, x_{2})$ 的下界为 $2$。当且仅当 AM-GM 不等式中的等号成立时，可以达到最小值 $2$，这发生在 $x_{1} = x_{2}$ 的情况下。\n将 $x_{1} = x_{2}$ 代入约束条件 $x_{1}x_{2} \\geq 1$ 中，我们得到：\n$$ x_{1}^{2} \\geq 1 $$\n因为 $x_{1} > 0$，这意味着 $x_{1} \\geq 1$。为了达到和 $x_1+x_2 = 2x_1$ 的最小值，我们必须为 $x_1$ 选择可能的最小值，即 $x_{1} = 1$。\n这给出了最优点 $(x_{1}^{\\star}, x_{2}^{\\star}) = (1, 1)$。该点满足所有约束条件：$1 \\times 1 = 1 \\geq 1$、$1 \\geq 0$ 和 $1 \\geq 0$。\n原始最优值是目标函数在该点的值：\n$$ p^{\\star} = f(1, 1) = 1 + 1 = 2 $$\n\n### 对偶问题\n为了构建对偶问题，我们首先将约束条件写成标准形式 $g_{i}(x) \\leq 0$：\n1. $c_{1}(x_{1}, x_{2}) = 1 - x_{1}x_{2} \\leq 0$\n2. $c_{2}(x_{1}, x_{2}) = -x_{1} \\leq 0$\n3. $c_{3}(x_{1}, x_{2}) = -x_{2} \\leq 0$\n\n拉格朗日函数 $L(x_1, x_2, \\lambda_1, \\lambda_2, \\lambda_3)$ 定义为：\n$$ L(x_{1}, x_{2}, \\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = f(x_{1}, x_{2}) + \\lambda_{1} c_{1}(x_{1}, x_{2}) + \\lambda_{2} c_{2}(x_{1}, x_{2}) + \\lambda_{3} c_{3}(x_{1}, x_{2}) $$\n其中 $\\lambda_{1}, \\lambda_{2}, \\lambda_{3} \\geq 0$ 是拉格朗日乘子（对偶变量）。\n代入这些函数，我们得到：\n$$ L(x_{1}, x_{2}, \\lambda) = (x_{1} + x_{2}) + \\lambda_{1}(1 - x_{1}x_{2}) + \\lambda_{2}(-x_{1}) + \\lambda_{3}(-x_{2}) $$\n我们可以通过收集 $x_{1}$ 和 $x_{2}$ 的系数来重新排列各项：\n$$ L(x_{1}, x_{2}, \\lambda) = (1 - \\lambda_{2})x_{1} + (1 - \\lambda_{3})x_{2} - \\lambda_{1}x_{1}x_{2} + \\lambda_{1} $$\n拉格朗日对偶函数 $q(\\lambda)$ 是拉格朗日函数相对于原始变量 $x_{1}$ 和 $x_{2}$ 的下确界：\n$$ q(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = \\inf_{x_{1}, x_{2} \\in \\mathbb{R}} L(x_{1}, x_{2}, \\lambda_{1}, \\lambda_{2}, \\lambda_{3}) $$\n项 $L(x_{1}, x_{2}, \\lambda)$ 是一个关于 $x_1, x_2$ 的函数，包含一个双线性项 $- \\lambda_{1}x_{1}x_{2}$。\n如果 $\\lambda_{1} > 0$，此函数是一个双曲抛物面，其下方无界。对于任何 $\\lambda_1 > 0$，我们可以选择 $x_1=x_2=x$ 并让 $x \\to \\infty$，由于 $- \\lambda_1 x^2$ 项的存在，这将导致 $L \\to -\\infty$。因此，如果 $\\lambda_{1} > 0$，则下确界为 $-\\infty$。\n如果 $\\lambda_{1} = 0$，拉格朗日函数变为一个线性函数：\n$$ L(x_{1}, x_{2}, \\lambda) = (1 - \\lambda_{2})x_{1} + (1 - \\lambda_{3})x_{2} $$\n为了使这个线性函数在 $\\mathbb{R}^2$ 上的下确界是有限的（即不是 $-\\infty$），$x_{1}$ 和 $x_{2}$ 的系数必须为零。这要求：\n$$ 1 - \\lambda_{2} = 0 \\implies \\lambda_{2} = 1 $$\n$$ 1 - \\lambda_{3} = 0 \\implies \\lambda_{3} = 1 $$\n因此，为了使对偶函数不为 $-\\infty$，对偶变量必须满足 $\\lambda_{1} = 0$、$\\lambda_{2} = 1$ 和 $\\lambda_{3} = 1$。这些值也满足非负约束 $\\lambda_i \\ge 0$。\n在这个特定的点 $(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = (0, 1, 1)$，拉格朗日函数为：\n$$ L(x_{1}, x_{2}, 0, 1, 1) = (1-1)x_{1} + (1-1)x_{2} - 0 \\cdot x_{1}x_{2} + 0 = 0 $$\n对偶函数在该点的值为：\n$$ q(0, 1, 1) = \\inf_{x_{1}, x_{2} \\in \\mathbb{R}} 0 = 0 $$\n对于任何其他非负对偶变量集合，$q(\\lambda) = -\\infty$。\n\n对偶问题是在 $\\lambda_{i} \\geq 0$ 的约束下最大化对偶函数 $q(\\lambda)$：\n$$ d^{\\star} = \\sup_{\\lambda_{1},\\lambda_{2},\\lambda_{3} \\geq 0} q(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) $$\n由于 $q(\\lambda)$ 在一个特定点上为 $0$，而在其他所有地方都为 $-\\infty$，所以上确界是 $0$：\n$$ d^{\\star} = 0 $$\n\n### 对偶间隙\n对偶间隙是原始最优值 $p^{\\star}$ 和对偶最优值 $d^{\\star}$ 之间的差值：\n$$ \\text{对偶间隙} = p^{\\star} - d^{\\star} $$\n代入计算出的值：\n$$ \\text{对偶间隙} = 2 - 0 = 2 $$\n这个非零对偶间隙（$p^{\\star} > d^{\\star}$）的存在是由于问题不是凸的（具体来说，约束函数 $1-x_1x_2$ 不是凸函数），因此强对偶性不成立。弱对偶性，即 $p^{\\star} \\geq d^{\\star}$，总是成立的，并且在这里得到满足。", "answer": "$$\n\\boxed{2}\n$$", "id": "3217490"}]}