{"hands_on_practices": [{"introduction": "许多线性规划问题并非以方便求解的初始形式出现，尤其是当约束条件包含“大于等于”($\\ge$)或右侧项为负数时。本练习将指导你完成将这类问题转化为适用于两阶段单纯形法典范式的关键步骤[@problem_id:3106013]。你将通过引入松弛、剩余和人工变量，学会如何为任何线性规划问题构建一个初始的基本可行解，这是启动单纯形算法的第一步。", "problem": "考虑一个最小化形式的线性规划（LP）问题，其决策向量为 $x \\in \\mathbb{R}^{3}$，目标函数为 $c^{\\top}x$，约束条件为分量非负 $x \\ge 0$ 以及以下线性不等式组\n$$\n\\begin{aligned}\n2x_{1} - x_{2} + x_{3} \\le 3, \\\\\n- x_{1} + 4x_{2} + 2x_{3} \\le -5, \\\\\n3x_{1} + x_{2} - 2x_{3} \\le 7, \\\\\n- 2x_{1} + x_{2} + x_{3} \\le -1.\n\\end{aligned}\n$$\n从线性规划的典范等式形式的基本定义和单纯形法所需的基本可行解的构造出发，将该系统转换为适用于两阶段单纯形法（TPSM）的典范等式形式。具体而言，通过将每个右端项为负的不等式乘以 $-1$ 来进行符号归一化，这将翻转不等号的方向，然后为 $\\le$ 类型的约束引入松弛变量，为 $\\ge$ 类型的约束引入剩余变量和人工变量，从而获得一个所有变量均为非负的典范等式系统。\n\n将第一阶段的目标定义为所有引入的人工变量之和。如果在第一阶段中，原始决策变量在零向量 $x = 0$ 处初始化，那么对于您推导出的典范等式系统，第一阶段目标在此初始点的值是多少？请以单个精确实数的形式提供您的答案，不要四舍五入。", "solution": "**步骤1：符号归一化**\n给定的不等式组为：\n1.  $2x_{1} - x_{2} + x_{3} \\le 3$\n2.  $-x_{1} + 4x_{2} + 2x_{3} \\le -5$\n3.  $3x_{1} + x_{2} - 2x_{3} \\le 7$\n4.  $-2x_{1} + x_{2} + x_{3} \\le -1$\n\n我们找出右端项（RHS）为负的约束（约束2和约束4）。我们将它们乘以 $-1$，这将使不等号的方向从 $\\le$ 反转为 $\\ge$。\n\n-   约束2：$(-1)(-x_{1} + 4x_{2} + 2x_{3}) \\ge (-1)(-5) \\implies x_{1} - 4x_{2} - 2x_{3} \\ge 5$\n-   约束4：$(-1)(-2x_{1} + x_{2} + x_{3}) \\ge (-1)(-1) \\implies 2x_{1} - x_{2} - x_{3} \\ge 1$\n\n经过符号归一化后的不等式组为：\n1.  $2x_{1} - x_{2} + x_{3} \\le 3$\n2.  $x_{1} - 4x_{2} - 2x_{3} \\ge 5$\n3.  $3x_{1} + x_{2} - 2x_{3} \\le 7$\n4.  $2x_{1} - x_{2} - x_{3} \\ge 1$\n\n**步骤2：转换为典范等式形式**\n现在我们通过引入松弛变量、剩余变量和人工变量，将此系统转换为一组线性等式。所有引入的变量都必须是非负的。\n\n-   对于约束1（$2x_{1} - x_{2} + x_{3} \\le 3$）：这是一个“小于或等于”不等式。我们添加一个非负的**松弛变量** $s_1 \\ge 0$。\n    $$2x_{1} - x_{2} + x_{3} + s_1 = 3$$\n\n-   对于约束2（$x_{1} - 4x_{2} - 2x_{3} \\ge 5$）：这是一个“大于或等于”不等式。我们减去一个非负的**剩余变量** $s_2 \\ge 0$。\n    $$x_{1} - 4x_{2} - 2x_{3} - s_2 = 5$$\n    为了获得一个初始基本可行解（其中基构成一个单位矩阵），我们还必须添加一个非负的**人工变量** $a_1 \\ge 0$。\n    $$x_{1} - 4x_{2} - 2x_{3} - s_2 + a_1 = 5$$\n\n-   对于约束3（$3x_{1} + x_{2} - 2x_{3} \\le 7$）：这是一个“小于或等于”不等式。我们添加一个非负的**松弛变量** $s_3 \\ge 0$。\n    $$3x_{1} + x_{2} - 2x_{3} + s_3 = 7$$\n\n-   对于约束4（$2x_{1} - x_{2} - x_{3} \\ge 1$）：这是一个“大于或等于”不等式。我们减去一个非负的**剩余变量** $s_4 \\ge 0$并添加一个非负的**人工变量** $a_2 \\ge 0$。\n    $$2x_{1} - x_{2} - x_{3} - s_4 + a_2 = 1$$\n\n得到的典范等式系统是：\n$$\n\\begin{aligned}\n2x_{1} - x_{2} + x_{3} + s_1 \\phantom{-s_2+a_1} \\phantom{+s_3} \\phantom{-s_4+a_2} = 3 \\\\\nx_{1} - 4x_{2} - 2x_{3} \\phantom{+s_1} - s_2 + a_1 \\phantom{+s_3} \\phantom{-s_4+a_2} = 5 \\\\\n3x_{1} + x_{2} - 2x_{3} \\phantom{+s_1} \\phantom{-s_2+a_1} + s_3 \\phantom{-s_4+a_2} = 7 \\\\\n2x_{1} - x_{2} - x_{3} \\phantom{+s_1} \\phantom{-s_2+a_1} \\phantom{+s_3} - s_4 + a_2 = 1\n\\end{aligned}\n$$\n所有变量（$x_1, x_2, x_3, s_1, s_2, s_3, s_4, a_1, a_2$）均需满足非负约束。\n\n**步骤3：第一阶段目标和初始值计算**\n第一阶段的目标是最小化人工变量的总和。设此目标函数为 $w$。\n$$w = a_1 + a_2$$\n第一阶段单纯形法的初始点对应于该辅助系统的一个初始基本可行解。基被选为嵌入在约束条件中的单位矩阵，它对应于变量 $\\{s_1, a_1, s_3, a_2\\}$。这些是初始基变量。所有其他变量 $\\{x_1, x_2, x_3, s_2, s_4\\}$ 是初始非基变量，并被设置为0。\n\n根据题意，原始决策变量在 $x = 0$ 处初始化，这意味着 $x_1 = 0$，$x_2 = 0$ 和 $x_3 = 0$。这与它们作为非基变量是一致的。剩余变量 $s_2$ 和 $s_4$ 也是非基变量，因此也设置为0。\n\n我们将这些值为0的非基变量代入典范等式系统，以求出基变量的值：\n-   从等式1：$2(0) - (0) + (0) + s_1 = 3 \\implies s_1 = 3$\n-   从等式2：$(0) - 4(0) - 2(0) - (0) + a_1 = 5 \\implies a_1 = 5$\n-   从等式3：$3(0) + (0) - 2(0) + s_3 = 7 \\implies s_3 = 7$\n-   从等式4：$2(0) - (0) - (0) - (0) + a_2 = 1 \\implies a_2 = 1$\n\n初始基本可行解是 $(x_1, x_2, x_3, s_1, s_2, s_3, s_4, a_1, a_2) = (0, 0, 0, 3, 0, 7, 0, 5, 1)$。\n\n最后，我们计算第一阶段目标函数 $w$ 在此初始点的值：\n$$w = a_1 + a_2 = 5 + 1 = 6$$\n在指定的初始点，第一阶段目标的值是 $6$。", "answer": "$$\n\\boxed{6}\n$$", "id": "3106013"}, {"introduction": "一旦建立了初始典范式，单纯形法就通过一系列迭代步骤寻找最优解。这个练习让你亲手操作该算法的核心引擎——一次“基变换”（pivot）[@problem_id:3106043]。通过将一个基变量与一个非基变量进行交换，你将学会如何从一个基本可行解移动到另一个相邻解，并观察整个典范式（包括约束方程和目标函数）是如何随之更新的。", "problem": "考虑以下线性规划（LP）问题，它通过引入松弛变量从两个资源约束中导出，并以标准等式形式表示：\n$$\\text{maximize } z = 4 x_1 + 3 x_2 + 0 \\cdot s_1 + 0 \\cdot s_2,$$\n约束条件为\n$$x_1 + 2 x_2 + s_1 = 8,$$\n$$2 x_1 + x_2 + s_2 = 13,$$\n以及非负性约束\n$$x_1 \\ge 0,\\quad x_2 \\ge 0,\\quad s_1 \\ge 0,\\quad s_2 \\ge 0.$$\n从基本定义出发：基是构成一个可逆子矩阵的一组列，基本可行解是通过将所有非基变量设为零并求解基变量得到的，规范字典将基变量表示为非基变量的仿射函数，并将目标值表示为非基变量的仿射函数。仅使用这些定义，按以下步骤进行：\n- 为初始基构建规范字典，其中松弛变量 $s_1$ 和 $s_2$ 是基变量，决策变量 $x_1$ 和 $x_2$ 是非基变量。\n- 接下来，执行一次主元变换，交换一个基变量和一个非基变量，选择入基变量为 $x_1$，并通过最小比率规则强制执行可行性要求 $x \\ge 0$ 来确定出基变量。\n- 在这次主元变换之后，计算更新后的规范字典的右端向量 $b$（当新的非基变量设为零时，新的基变量的值）以及新的非基变量的更新后的检验数 $\\bar c$。\n\n将您的最终答案表示为一个单行矩阵，其中的条目按 $(b_{x_1}, b_{s_1}, \\bar c_{x_2}, \\bar c_{s_2})$ 的顺序列出。无需四舍五入。", "solution": "本题要求使用字典表示法，从给定的初始基开始，执行一次单纯形法的主元变换。\n\n**第1部分：构建初始规范字典**\n根据题意，初始基变量为 $s_1$ 和 $s_2$，非基变量为 $x_1$ 和 $x_2$。规范字典需要将基变量和目标函数表示为非基变量的函数。\n\n从第一个约束条件解出 $s_1$：\n$$x_1 + 2 x_2 + s_1 = 8 \\implies s_1 = 8 - x_1 - 2 x_2$$\n\n从第二个约束条件解出 $s_2$：\n$$2 x_1 + x_2 + s_2 = 13 \\implies s_2 = 13 - 2 x_1 - x_2$$\n\n目标函数已用非基变量表示：\n$$z = 4 x_1 + 3 x_2$$\n\n因此，初始规范字典为：\n$$s_1 = 8 - x_1 - 2 x_2$$\n$$s_2 = 13 - 2 x_1 - x_2$$\n$$z = 4 x_1 + 3 x_2$$\n\n**第2部分：执行一次主元变换**\n主元变换操作包括选择一个入基变量和一个出基变量，然后更新字典。\n\n- **入基变量**：问题明确指出入基变量是 $x_1$。\n- **出基变量**：我们应用最小比率规则来确定出基变量。我们需要找到在保持其他非基变量（即 $x_2$）为0的情况下，$x_1$ 可以增加的最大值，同时维持当前基变量 $s_1$ 和 $s_2$ 的非负性。\n  1.  对于 $s_1 \\ge 0$：$s_1 = 8 - x_1 \\ge 0 \\implies x_1 \\le 8$。\n  2.  对于 $s_2 \\ge 0$：$s_2 = 13 - 2 x_1 \\ge 0 \\implies x_1 \\le \\frac{13}{2} = 6.5$。\n\n$x_1$ 允许的最大值是这些上界中的最小值：$\\min(8, 6.5) = 6.5$。这个限制来自 $s_2$ 的约束，因此 $s_2$ 是出基变量。\n\n**第3部分：计算更新后的规范字典**\n主元变换交换 $x_1$（入基）和 $s_2$（出基）。新的基变量是 $\\{x_1, s_1\\}$，新的非基变量是 $\\{x_2, s_2\\}$。我们必须用新的非基变量来表示新的基变量和目标函数。\n\n主元方程是包含出基变量 $s_2$ 的那一行。我们从此方程中解出入基变量 $x_1$：\n$$s_2 = 13 - 2 x_1 - x_2 \\implies 2 x_1 = 13 - x_2 - s_2 \\implies x_1 = \\frac{13}{2} - \\frac{1}{2} x_2 - \\frac{1}{2} s_2$$\n\n然后，我们将这个 $x_1$ 的表达式代入旧字典的其他方程中：\n1.  对于 $s_1$：\n    $$s_1 = 8 - x_1 - 2 x_2 = 8 - \\left(\\frac{13}{2} - \\frac{1}{2} x_2 - \\frac{1}{2} s_2\\right) - 2 x_2 = \\frac{3}{2} - \\frac{3}{2} x_2 + \\frac{1}{2} s_2$$\n2.  对于目标函数 $z$：\n    $$z = 4 x_1 + 3 x_2 = 4 \\left(\\frac{13}{2} - \\frac{1}{2} x_2 - \\frac{1}{2} s_2\\right) + 3 x_2 = 26 + x_2 - 2 s_2$$\n\n更新后的规范字典是：\n$$x_1 = \\frac{13}{2} - \\frac{1}{2} x_2 - \\frac{1}{2} s_2$$\n$$s_1 = \\frac{3}{2} - \\frac{3}{2} x_2 + \\frac{1}{2} s_2$$\n$$z = 26 + x_2 - 2 s_2$$\n\n**第4部分：提取所需值**\n问题要求更新后的右端向量 $b$ 和更新后的检验数 $\\bar c$。\n\n-   **右端向量 $b$** 是新基变量方程中的常数项，即新基变量在新的基本可行解中的值。\n    -   $b_{x_1} = \\frac{13}{2}$\n    -   $b_{s_1} = \\frac{3}{2}$\n-   **检验数 $\\bar c$** 是目标函数方程中非基变量的系数。\n    -   $\\bar c_{x_2} = 1$\n    -   $\\bar c_{s_2} = -2$\n\n将这些值按 $(b_{x_1}, b_{s_1}, \\bar c_{x_2}, \\bar c_{s_2})$ 的顺序列出，得到：\n$$ \\left( \\frac{13}{2}, \\frac{3}{2}, 1, -2 \\right) $$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{13}{2} & \\frac{3}{2} & 1 & -2\n\\end{pmatrix}\n}\n$$", "id": "3106043"}, {"introduction": "通常由松弛变量或人工变量构成的初始基仅仅是一个起点。这个更深入的练习旨在加深你对典范式本质的理解[@problem_id:3106032]。它要求你为一个由原始决策变量构成的“非平凡”基构建典范式，这需要你直接运用矩阵运算来表达基变量与非基变量的关系，从而揭示任何单纯形字典背后的普适结构。", "problem": "考虑以下不等式形式的线性规划（LP）问题。决策变量为 $x_1, x_2, x_3, x_4$，均为非负约束：\n$$\n\\max \\ z \\ = \\ 5 x_1 + 3 x_2 + 4 x_3 + 2 x_4\n$$\n约束于\n$$\n2 x_1 + x_2 + x_4 \\ \\le \\ 6, \\\\\n- x_1 + 2 x_2 + x_3 \\ \\le \\ 8, \\\\\nx_1 + 3 x_3 + 2 x_4 \\ \\le \\ 10, \\\\\nx_1, x_2, x_3, x_4 \\ \\ge \\ 0.\n$$\n引入松弛变量 $s_1, s_2, s_3$ 以获得等式约束。然后，不选择松弛变量作为基变量集，而是特意选择非显然的基变量集 $\\{x_1, x_2, x_3\\}$，并将 $\\{x_4, s_1, s_2, s_3\\}$ 视为非基变量。为此基构建相应的规范单纯形字典，并通过检查当所有非基变量设为零时的基解来验证可行性，即验证所选基的 $x_B = b \\ge 0$。最后，计算此基可行解下的目标值。请用精确值表示最终答案（无需四舍五入）。", "solution": "第一步是通过引入非负松弛变量 $s_1, s_2, s_3$，将不等式约束转换为等式约束。\n线性规划问题变为：\n最大化 $z = 5 x_1 + 3 x_2 + 4 x_3 + 2 x_4$\n约束于：\n$$\n\\begin{aligned}\n2 x_1 + x_2 + x_4 + s_1 = 6 \\\\\n-x_1 + 2 x_2 + x_3 + s_2 = 8 \\\\\nx_1 + 3 x_3 + 2 x_4 + s_3 = 10\n\\end{aligned}\n$$\n以及 $x_1, x_2, x_3, x_4, s_1, s_2, s_3 \\ge 0$。\n\n问题指定基变量集为 $\\mathcal{B} = \\{x_1, x_2, x_3\\}$，非基变量集为 $\\mathcal{N} = \\{x_4, s_1, s_2, s_3\\}$。我们需要将基变量和目标函数仅用非基变量来表示。\n\n约束系统可以写成矩阵形式 $A \\mathbf{x} = \\mathbf{b}$，其中 $A$ 的列被划分为基矩阵 $B$ 和非基矩阵 $N$。\n$$\nB \\mathbf{x}_B + N \\mathbf{x}_N = \\mathbf{b}\n$$\n这里，$\\mathbf{x}_B = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$ 且 $\\mathbf{x}_N = \\begin{pmatrix} x_4 \\\\ s_1 \\\\ s_2 \\\\ s_3 \\end{pmatrix}$。右端向量为 $\\mathbf{b} = \\begin{pmatrix} 6 \\\\ 8 \\\\ 10 \\end{pmatrix}$。\n\n基矩阵 $B$ 由对应于 $x_1, x_2, x_3$ 的列构成：\n$$\nB = \\begin{pmatrix} 2   1  0 \\\\ -1  2  1 \\\\ 1  0  3 \\end{pmatrix}\n$$\n非基矩阵 $N$ 由对应于 $x_4, s_1, s_2, s_3$ 的列构成：\n$$\nN = \\begin{pmatrix} 1  1  0  0 \\\\ 0  0  1  0 \\\\ 2  0  0  1 \\end{pmatrix}\n$$\n为了构建字典，我们必须用 $\\mathbf{x}_N$ 来求解 $\\mathbf{x}_B$：\n$$\n\\mathbf{x}_B = B^{-1}(\\mathbf{b} - N \\mathbf{x}_N) = B^{-1}\\mathbf{b} - B^{-1}N \\mathbf{x}_N\n$$\n首先，我们计算基矩阵 $B$ 的逆。$B$ 的行列式为：\n$$\n\\det(B) = 2(2 \\cdot 3 - 1 \\cdot 0) - 1(-1 \\cdot 3 - 1 \\cdot 1) + 0 = 2(6) - 1(-4) = 12 + 4 = 16\n$$\n由于 $\\det(B) \\ne 0$，矩阵 $B$ 可逆，所选变量构成一个有效的基。逆矩阵为 $B^{-1} = \\frac{1}{\\det(B)} \\text{adj}(B)$。\n伴随矩阵 $\\text{adj}(B)$ 是代数余子式矩阵的转置：\n$$\n\\text{adj}(B) = \\begin{pmatrix} 6  -3  1 \\\\ 4  6  -2 \\\\ -2  1  5 \\end{pmatrix}\n$$\n所以，逆矩阵为：\n$$\nB^{-1} = \\frac{1}{16} \\begin{pmatrix} 6  -3  1 \\\\ 4  6  -2 \\\\ -2  1  5 \\end{pmatrix}\n$$\n现在，我们求解当非基变量设为零时基变量的值。这就是基解，$\\mathbf{\\bar{b}} = B^{-1}\\mathbf{b}$。\n$$\n\\mathbf{x}_B = \\mathbf{\\bar{b}} = \\frac{1}{16} \\begin{pmatrix} 6  -3  1 \\\\ 4  6  -2 \\\\ -2  1  5 \\end{pmatrix} \\begin{pmatrix} 6 \\\\ 8 \\\\ 10 \\end{pmatrix} = \\frac{1}{16} \\begin{pmatrix} 36 - 24 + 10 \\\\ 24 + 48 - 20 \\\\ -12 + 8 + 50 \\end{pmatrix} = \\frac{1}{16} \\begin{pmatrix} 22 \\\\ 52 \\\\ 46 \\end{pmatrix} = \\begin{pmatrix} 22/16 \\\\ 52/16 \\\\ 46/16 \\end{pmatrix} = \\begin{pmatrix} 11/8 \\\\ 13/4 \\\\ 23/8 \\end{pmatrix}\n$$\n所以，基解为 $(x_1, x_2, x_3) = (\\frac{11}{8}, \\frac{13}{4}, \\frac{23}{8})$。\n为了验证可行性，我们检查所有基变量是否非负。\n$$\nx_1 = \\frac{11}{8} \\ge 0, \\quad x_2 = \\frac{13}{4} \\ge 0, \\quad x_3 = \\frac{23}{8} \\ge 0\n$$\n由于所有值都是非负的，该基解是可行的。\n\n最后，我们计算此基可行解的目标值。设 $\\mathbf{c}_B^T = \\begin{pmatrix} 5  3  4 \\end{pmatrix}$。\n$$\nz_0 = \\mathbf{c}_B^T \\mathbf{x}_B = \\begin{pmatrix} 5  3  4 \\end{pmatrix} \\begin{pmatrix} 11/8 \\\\ 13/4 \\\\ 23/8 \\end{pmatrix} = 5\\left(\\frac{11}{8}\\right) + 3\\left(\\frac{13}{4}\\right) + 4\\left(\\frac{23}{8}\\right)\n$$\n$$\nz_0 = \\frac{55}{8} + \\frac{3 \\cdot 26}{8} + \\frac{92}{8} = \\frac{55 + 78 + 92}{8} = \\frac{225}{8}\n$$\n这就是所要求的目标值。为了教学目的，我们还可以计算完整的单纯形字典。目标函数行可以表示为 $z = z_0 + (\\mathbf{c}_N^T - \\mathbf{c}_B^T B^{-1}N) \\mathbf{x}_N$。经计算，检验数 $(\\mathbf{c}_N^T - \\mathbf{c}_B^T B^{-1}N)$ 的所有分量均非正，这意味着此基可行解不仅可行，而且是最优解。\n$$\nz = \\frac{225}{8} - \\frac{5}{2} x_4 - \\frac{17}{8} s_1 - \\frac{7}{16} s_2 - \\frac{19}{16} s_3\n$$", "answer": "$$\n\\boxed{\\frac{225}{8}}\n$$", "id": "3106032"}]}