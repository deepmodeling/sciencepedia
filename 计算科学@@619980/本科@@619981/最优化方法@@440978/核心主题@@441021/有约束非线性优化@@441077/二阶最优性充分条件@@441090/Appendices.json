{"hands_on_practices": [{"introduction": "本练习将引导你完成一个标准的等式约束优化流程。通过构建拉格朗日函数、求解KKT条件找到驻点，并计算在该点的约化Hessian矩阵，你将能够应用二阶充分条件来严格判断该驻点是否为局部极小值。这个基础问题是掌握在约束可行方向上检验曲率核心思想的完美起点。[@problem_id:3176409]", "problem": "考虑一个等式约束优化问题，其目标函数为 $f(x,y)=x^{2}y^{2}+x^{2}+y^{2}$，约束条件为 $g(x,y)=x+y=0$。从等式约束最优性的基本原理出发，首先通过拉格朗日函数的梯度来定义约束驻点，并要求约束雅可比矩阵具有满秩。然后，使用在约束雅可比矩阵零空间的标准正交基上构建的降阶 Hessian 矩阵的定义，来评估二阶充分条件。\n\n任务：\n1. 通过求解等式约束的 Karush-Kuhn-Tucker (KKT) 最优性一阶必要条件，确定约束驻点。\n2. 使用约束雅可比矩阵零空间的标准正交基向量 $z=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1\\\\-1\\end{pmatrix}$，构建在任务 $1$ 中找到的驻点处的拉格朗日函数的降阶 Hessian 矩阵。\n3. 使用等式约束问题的二阶充分条件，判断该驻点是否为严格局部最小值。\n\n最终答案只报告在任务 $2$ 中获得的降阶 Hessian 矩阵的标量值。无需四舍五入，请提供精确值。不要包含任何单位。", "solution": "该问题要求分析一个等式约束优化问题。给定目标函数 $f(x,y)=x^{2}y^{2}+x^{2}+y^{2}$ 和等式约束 $g(x,y)=x+y=0$。我们将按照指定的任务来寻找约束驻点并分析二阶条件。\n\n第一步是为此问题定义拉格朗日函数 $L(x, y, \\lambda)$。拉格朗日函数由 $L(x, y, \\lambda) = f(x, y) - \\lambda g(x, y)$ 给出。\n$$L(x,y,\\lambda) = x^{2}y^{2}+x^{2}+y^{2} - \\lambda(x+y)$$\n其中 $\\lambda$ 是与约束相关的拉格朗日乘子。\n\n**任务 1：确定约束驻点。**\n\n我们通过应用一阶必要条件来找到驻点，即拉格朗日函数对所有变量的梯度必须为零。这些是等式约束的 Karush-Kuhn-Tucker (KKT) 条件。\n\n拉格朗日函数的梯度是：\n$$ \\nabla L(x,y,\\lambda) = \\begin{pmatrix} \\frac{\\partial L}{\\partial x} \\\\ \\frac{\\partial L}{\\partial y} \\\\ \\frac{\\partial L}{\\partial \\lambda} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n\n这产生以下方程组：\n1. $\\frac{\\partial L}{\\partial x} = 2xy^{2} + 2x - \\lambda = 0$\n2. $\\frac{\\partial L}{\\partial y} = 2x^{2}y + 2y - \\lambda = 0$\n3. $\\frac{\\partial L}{\\partial \\lambda} = -(x+y) = 0 \\implies x+y=0$\n\n从纯数学的角度来看，关于 $\\lambda$ 的条件是梯度相对于原始变量为零，而最后一个方程是约束本身。设置 $\\frac{\\partial L}{\\partial \\lambda}=0$ 是恢复约束条件的一种便捷方式。\n\n由第三个方程，我们得到 $y = -x$。我们将其代入前两个方程。\n将 $y=-x$ 代入方程 (1)：\n$$ 2x(-x)^{2} + 2x - \\lambda = 0 \\implies 2x^{3} + 2x - \\lambda = 0 $$\n$$ \\lambda = 2x^{3} + 2x $$\n将 $y=-x$ 代入方程 (2)：\n$$ 2x^{2}(-x) + 2(-x) - \\lambda = 0 \\implies -2x^{3} - 2x - \\lambda = 0 $$\n$$ \\lambda = -2x^{3} - 2x $$\n\n令两个关于 $\\lambda$ 的表达式相等：\n$$ 2x^{3} + 2x = -2x^{3} - 2x $$\n$$ 4x^{3} + 4x = 0 $$\n$$ 4x(x^{2} + 1) = 0 $$\n\n对于任何实数 $x$，项 $x^{2}+1$ 总是正的。因此，唯一的实数解是 $x=0$。\n如果 $x=0$，则 $y = -x = 0$。\n我们可以使用任一表达式找到 $\\lambda$ 的对应值。例如，使用 $\\lambda = 2x^{3} + 2x$，我们得到 $\\lambda = 2(0)^{3} + 2(0) = 0$。\n\n因此，存在一个唯一的约束驻点 $(x^*, y^*) = (0,0)$，其相关的拉格朗日乘子为 $\\lambda^* = 0$。\n\n**任务 2：构建拉格朗日函数的降阶 Hessian 矩阵。**\n\n二阶条件涉及拉格朗日函数关于变量 $x$ 和 $y$ 的 Hessian 矩阵，记为 $\\nabla_{xx}^{2} L$。\n首先，我们计算 $L(x,y,\\lambda)$ 的二阶偏导数：\n$$ \\frac{\\partial^{2} L}{\\partial x^{2}} = \\frac{\\partial}{\\partial x}(2xy^{2} + 2x - \\lambda) = 2y^{2} + 2 $$\n$$ \\frac{\\partial^{2} L}{\\partial y^{2}} = \\frac{\\partial}{\\partial y}(2x^{2}y + 2y - \\lambda) = 2x^{2} + 2 $$\n$$ \\frac{\\partial^{2} L}{\\partial x \\partial y} = \\frac{\\partial}{\\partial y}(2xy^{2} + 2x - \\lambda) = 4xy $$\n\n拉格朗日函数的 Hessian 矩阵是：\n$$ \\nabla_{xx}^{2} L(x,y,\\lambda) = \\begin{pmatrix} 2y^{2}+2 & 4xy \\\\ 4xy & 2x^{2}+2 \\end{pmatrix} $$\n\n接下来，我们计算此 Hessian 矩阵在驻点 $(x^*, y^*, \\lambda^*) = (0,0,0)$ 处的值：\n$$ H_L = \\nabla_{xx}^{2} L(0,0,0) = \\begin{pmatrix} 2(0)^{2}+2 & 4(0)(0) \\\\ 4(0)(0) & 2(0)^{2}+2 \\end{pmatrix} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix} $$\n\n降阶 Hessian 矩阵是通过将此 Hessian 矩阵投影到约束雅可比矩阵的零空间上来构建的。约束雅可比矩阵 $A$ 是约束函数 $g(x,y)$ 的梯度的转置：\n$$ \\nabla g(x,y) = \\begin{pmatrix} \\frac{\\partial g}{\\partial x} \\\\ \\frac{\\partial g}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n$$ A(x,y) = \\nabla g(x,y)^{T} = \\begin{pmatrix} 1 & 1 \\end{pmatrix} $$\n$A$ 的零空间由所有满足 $Av=0$ 的向量 $v = \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix}$ 组成，这意味着 $1 \\cdot v_x + 1 \\cdot v_y = 0$，或 $v_y = -v_x$。零空间中的任何向量都是 $\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ 的倍数。\n\n问题为此零空间提供了一个标准正交基，我们用矩阵 $Z$ 表示。在这种情况下，零空间是一维的，所以 $Z$ 是一个列向量：\n$$ Z = z = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} $$\n\n降阶 Hessian 矩阵 $H_R$ 定义为 $H_R = Z^{T} H_L Z$。我们现在计算这个乘积：\n$$ H_R = \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & -1 \\end{pmatrix}\\right) \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix} \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\\right) $$\n$$ H_R = \\frac{1}{2} \\begin{pmatrix} 1 & -1 \\end{pmatrix} \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} $$\n首先，我们执行前两个矩阵的乘法：\n$$ \\begin{pmatrix} 1 & -1 \\end{pmatrix} \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix} = \\begin{pmatrix} (1)(2)+(-1)(0) & (1)(0)+(-1)(2) \\end{pmatrix} = \\begin{pmatrix} 2 & -2 \\end{pmatrix} $$\n现在，我们将此结果与最后一个向量相乘：\n$$ \\begin{pmatrix} 2 & -2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = (2)(1) + (-2)(-1) = 2 + 2 = 4 $$\n最后，我们乘以标量因子 $\\frac{1}{2}$：\n$$ H_R = \\frac{1}{2} (4) = 2 $$\n降阶 Hessian 矩阵是一个 $1 \\times 1$ 矩阵，即标量值 $2$。\n\n**任务 3：判断该驻点是否为严格局部最小值。**\n\n一个点 $x^*$ 是严格局部最小值的二阶充分条件是，降阶 Hessian 矩阵 $H_R = Z^{T}(\\nabla_{xx}^{2} L(x^*, \\lambda^*))Z$ 是正定的。\n在我们的例子中，降阶 Hessian 矩阵是标量 $2$。一个标量是正定的当且仅当它是一个正数。\n由于 $H_R = 2 > 0$，降阶 Hessian 矩阵是正定的。\n因此，驻点 $(x^*, y^*) = (0,0)$ 是该约束问题的一个严格局部最小值。\n\n最终要求的答案是在任务 2 中获得的降阶 Hessian 矩阵的标量值。", "answer": "$$\\boxed{2}$$", "id": "3176409"}, {"introduction": "这个练习旨在建立更深刻的直觉：一个非凸函数（其Hessian矩阵不定）在约束条件下也可能拥有严格局部极小值。约束的作用相当于在一个“切片”上考察函数，而在这个切片上函数可能是凸的。通过分析在约束切出的可行方向上（即切空间内）Hessian矩阵的正定性，你将亲自验证这一关键几何概念。[@problem_id:3176387]", "problem": "考虑一个三维等式约束二次规划问题，其目标函数 $f:\\mathbb{R}^{3}\\to\\mathbb{R}$ 由下式给出：\n$$\nf(x) \\;=\\; \\frac{1}{2}\\,x^{\\top}Qx \\;+\\; c^{\\top}x,\n$$\n其中\n$$\nQ \\;=\\; \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & 2 \\end{pmatrix}, \n\\qquad\nc \\;=\\; \\begin{pmatrix} 1 \\\\ -2 \\\\ 3 \\end{pmatrix}.\n$$\n施加单个线性等式约束\n$$\nA x \\;=\\; b, \n\\qquad \nA \\;=\\; \\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix}, \n\\qquad \nb \\;=\\; 1.\n$$\n仅使用基本定义——即约束局部极小值点的定义、可行方向和切空间的概念（此处由一阶约束线性化定义）、$f$ 的二阶泰勒展开以及 Karush-Kuhn-Tucker (KKT) 最优性条件——完成以下任务：\n\n1) 通过分析其特征值，确定对称矩阵 $Q$ 是不定的。\n\n2) 通过对约束进行线性化并刻画切空间 $\\{d \\in \\mathbb{R}^{3} : A d = 0\\}$，确定在任意可行点 $\\bar{x}$ 处的可行方向 $d$ 的集合。\n\n3) 证明对于你在第2部分中确定的所有非零可行方向 $d$，二次型 $d^{\\top}Qd$ 均严格为正，并解释尽管 $Q$ 在 $\\mathbb{R}^{3}$ 中是不定的，但这如何确保了在可行方向上的正曲率。\n\n4) 从约束局部极小值点的定义和拉格朗日函数出发，推导等式约束问题的一阶平稳性条件，并求解得到的线性系统以获得候选最优解 $x^{\\star}$。\n\n5) 使用 $f$ 沿可行方向的二阶泰勒展开以及你在第3部分中的结果，论证最优性的二阶充分条件在你的候选解处成立，从而证明 $x^{\\star}$ 是一个严格局部极小值点。\n\n你的最终答案必须是使用圆括号矩阵表示法写成的单个行向量形式的最优解 $x^{\\star}$。请精确表达你的答案，无需四舍五入。", "solution": "所述问题在数学上是适定的，内部一致，且没有任何科学或事实上的不健全之处。确定唯一解所需的所有信息均已提供。因此，我们可以按要求进行完整推导。解答将遵循指定的五个步骤。\n\n问题是为目标函数 $f:\\mathbb{R}^{3}\\to\\mathbb{R}$\n$$f(x) = \\frac{1}{2}x^{\\top}Qx + c^{\\top}x$$\n在服从线性等式约束 $Ax=b$ 的条件下，寻找一个严格局部极小值点，其中\n$$Q = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & 2 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 1 \\\\ -2 \\\\ 3 \\end{pmatrix}$$\n$$A = \\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix}, \\quad b = 1$$\n\n1) 我们首先确定对称矩阵 $Q$ 是不定的。如果一个对称矩阵至少有一个正特征值和至少一个负特征值，那么它就是不定的。矩阵 $Q$ 是一个对角矩阵，所以它的特征值就是其对角元。特征值为 $\\lambda_1 = 1$, $\\lambda_2 = -1$, 和 $\\lambda_3 = 2$。由于 $\\lambda_1$ 和 $\\lambda_3$ 为正，$\\lambda_2$ 为负，根据定义，矩阵 $Q$ 是不定的。这意味着二次函数 $f(x)$ 是非凸的，在 $\\mathbb{R}^{3}$ 中同时具有正曲率和负曲率。具体来说，二次型 $x^{\\top}Qx$ 是一个鞍形。\n\n2) 接下来，我们确定在任意可行点 $\\bar{x}$ 处的可行方向集合。如果一个点 $\\bar{x}$ 满足约束 $A\\bar{x} = b$，则该点是可行的。对于线性等式约束，任意可行点处的可行方向集合即为切空间，它对所有可行点都是恒定的。如果对于一个可行点 $\\bar{x}$，点 $\\bar{x}+\\alpha d$ 对所有足够小的标量 $\\alpha$ 也满足约束，则方向 $d \\in \\mathbb{R}^{3}$ 是一个可行方向。这要求 $A(\\bar{x}+\\alpha d) = b$。展开此式得到 $A\\bar{x} + \\alpha Ad = b$。由于 $\\bar{x}$ 是可行的，有 $A\\bar{x} = b$，该条件简化为 $\\alpha Ad = 0$。为使此式对任意非零 $\\alpha$ 成立，必须有 $Ad=0$。因此，可行方向的集合是矩阵 $A$ 的零空间。\n给定 $A = \\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix}$，我们通过求解 $Ad=0$ 来找到零空间：\n$$ \\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\\\ d_3 \\end{pmatrix} = 0 $$\n这个方程简化为 $d_2 = 0$。分量 $d_1$ 和 $d_3$ 可以是任意实数。因此，代表所有可行方向集合的切空间是\n$$ T = \\{ d \\in \\mathbb{R}^{3} \\mid Ad = 0 \\} = \\left\\{ \\begin{pmatrix} d_1 \\\\ 0 \\\\ d_3 \\end{pmatrix} \\mid d_1, d_3 \\in \\mathbb{R} \\right\\} $$\n这是 $\\mathbb{R}^{3}$ 的一个二维子空间，由基向量 $\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 和 $\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$ 张成。\n\n3) 现在我们考察目标函数沿着这些可行方向的曲率。这由二次型 $d^{\\top}Qd$ 对任意非零可行方向 $d \\in T$ 的符号决定。设 $d$ 是切空间中的一个非零向量，因此 $d = \\begin{pmatrix} d_1 \\\\ 0 \\\\ d_3 \\end{pmatrix}$，其中 $d_1$ 和 $d_3$ 不全为零。我们计算 $d^{\\top}Qd$：\n$$ d^{\\top}Qd = \\begin{pmatrix} d_1 & 0 & d_3 \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & 2 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ 0 \\\\ d_3 \\end{pmatrix} $$\n$$ = \\begin{pmatrix} d_1 & 0 & 2d_3 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ 0 \\\\ d_3 \\end{pmatrix} = d_1^2 + 2d_3^2 $$\n由于 $d_1, d_3 \\in \\mathbb{R}$，我们有 $d_1^2 \\ge 0$ 和 $2d_3^2 \\ge 0$。和 $d_1^2 + 2d_3^2$ 为零当且仅当 $d_1 = 0$ 且 $d_3 = 0$，这对应于零向量 $d=0$。由于我们考虑的是非零可行方向，我们有 $d_1^2 + 2d_3^2 > 0$。这表明二次型 $d^{\\top}Qd$ 对所有非零可行方向都是严格为正的。这意味着目标函数的黑塞矩阵 $Q$ 在切空间 $T$ 上是正定的。与特征值 $\\lambda_2 = -1$ 相关的负曲率对应于 $x_2$ 方向。然而，约束 $Ax=b$（即 $x_2=1$）将可行点限制在一个平面上，并将可行方向限制在第二个分量为零的子空间中。这有效地抵消了负曲率的方向，使得在所有允许的移动方向上只留下正曲率。\n\n4) 我们推导并求解最优性的一阶必要条件，即等式约束下的 Karush-Kuhn-Tucker (KKT) 条件。我们定义拉格朗日函数 $L(x, \\lambda) = f(x) - \\lambda (Ax - b)$，其中 $\\lambda$ 是标量拉格朗日乘子。\n$$ L(x, \\lambda) = \\frac{1}{2}x^{\\top}Qx + c^{\\top}x - \\lambda(A x - b) $$\n点 $x^{\\star}$ 成为局部极小值点的一阶必要条件是存在一个乘子 $\\lambda^{\\star}$，使得拉格朗日函数关于 $x$ 的梯度为零，并且该点是可行的：\n$$ \\nabla_x L(x^{\\star}, \\lambda^{\\star}) = Qx^{\\star} + c - A^{\\top}\\lambda^{\\star} = 0 $$\n$$ Ax^{\\star} - b = 0 $$\n代入给定的矩阵和向量，我们得到一个线性方程组：\n$$ \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & 2 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ -2 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} \\lambda = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n$$ \\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = 1 $$\n可行性约束 $Ax=b$ 给出 $x_2 = 1$。梯度方程产生一个包含三个标量方程的系统：\n1) $x_1 + 1 = 0 \\implies x_1 = -1$\n2) $-x_2 - 2 - \\lambda = 0$\n3) $2x_3 + 3 = 0 \\implies x_3 = -\\frac{3}{2}$\n将 $x_2=1$ 代入第二个方程，我们可以求出乘子 $\\lambda$：\n$-1 - 2 - \\lambda = 0 \\implies \\lambda = -3$。\n候选最优解是点 $x^{\\star}$，其分量为 $x_1 = -1$，$x_2 = 1$ 和 $x_3 = -\\frac{3}{2}$。\n$$ x^{\\star} = \\begin{pmatrix} -1 \\\\ 1 \\\\ -\\frac{3}{2} \\end{pmatrix} $$\n\n5) 最后，我们使用二阶充分条件 (SOSC) 来验证 $x^{\\star}$ 是一个严格局部极小值点。对于等式约束，如果在 KKT 点 $(x^{\\star}, \\lambda^{\\star})$，拉格朗日函数关于 $x$ 的黑塞矩阵（在 $x^{\\star}$ 处求值）在切空间 $T(x^{\\star})$ 上是正定的，则 SOSC 成立。也就是说，对于所有非零的 $d \\in T(x^{\\star})$，都有 $d^{\\top} \\nabla_{xx}^2 L(x^{\\star}, \\lambda^{\\star}) d > 0$。\n拉格朗日函数的黑塞矩阵是 $\\nabla_{xx}^2 L(x, \\lambda) = Q$。\n因此，SOSC 要求对于所有满足 $Ad=0$ 的非零 $d$，都有 $d^{\\top}Qd > 0$。这正是我们在第3部分中验证的条件。我们证明了对于任意 $d \\in T, d \\neq 0$，二次型的值为 $d^{\\top}Qd = d_1^2 + 2d_3^2 > 0$。\n为了理解这为何能保证一个严格局部最小值，我们考虑 $f(x)$ 在 $x^{\\star}$ 处沿可行方向 $d \\in T$ 的泰勒展开。对于一个点 $x = x^{\\star} + \\alpha d$，其中 $\\alpha \\in \\mathbb{R}$：\n$$ f(x^{\\star}+\\alpha d) - f(x^{\\star}) = \\alpha \\nabla f(x^{\\star})^{\\top}d + \\frac{1}{2}\\alpha^2 d^{\\top} \\nabla^2 f(x^{\\star}) d + o(\\alpha^2) $$\n从 KKT 条件 $\\nabla_x L(x^{\\star}, \\lambda^{\\star}) = 0$，我们有 $\\nabla f(x^{\\star}) = A^{\\top}\\lambda^{\\star}$。一阶项是 $\\alpha (A^{\\top}\\lambda^{\\star})^{\\top}d = \\alpha (\\lambda^{\\star})^{\\top} (Ad)$。因为 $d \\in T$，我们有 $Ad=0$，所以一阶项为零。展开式变为：\n$$ f(x^{\\star}+\\alpha d) - f(x^{\\star}) = \\frac{1}{2}\\alpha^2 d^{\\top} Q d + o(\\alpha^2) $$\n如前所述，对于任意非零 $d \\in T$，都有 $d^{\\top}Qd > 0$。因此，对于任意非零 $\\alpha$，项 $\\frac{1}{2}\\alpha^2 d^{\\top} Q d$ 严格为正。当 $\\alpha$ 足够小时，这个二阶项主导高阶项 $o(\\alpha^2)$，这意味着 $f(x^{\\star}+\\alpha d) - f(x^{\\star}) > 0$。这对任何可行方向 $d$ 都成立。因此，$x^{\\star}$ 是一个严格局部极小值点。候选点 $x^{\\star} = \\begin{pmatrix} -1 \\\\ 1 \\\\ -\\frac{3}{2} \\end{pmatrix}$ 被确认为该约束问题的一个严格局部极小值点。", "answer": "$$\\boxed{\\begin{pmatrix} -1 & 1 & -\\frac{3}{2} \\end{pmatrix}}$$", "id": "3176387"}, {"introduction": "将理论从等式约束扩展到更普遍的不等式约束是至关重要的一步。本练习引入了“临界锥”（critical cone）这一关键概念，它是在处理不等式约束时取代切空间的角色。你将学习如何确定临界锥，并检验拉格朗日Hessian矩阵在该锥上的曲率，从而判断二阶条件是否满足。[@problem_id:3176420]", "problem": "考虑非线性规划问题：最小化目标函数 $f(x) = x_1^2 + x_2^2$，约束条件为单个不等式约束 $h(x) = \\cos(x_1) - x_2 \\le 0$。设候选点为 $x^\\star = (0, 1)$。\n\n您的任务是：\n\n- 从拉格朗日函数 $L(x,\\lambda) = f(x) + \\lambda h(x)$ 和 Karush–Kuhn–Tucker (KKT) 条件（原始可行性、对偶可行性、互补松弛性和平稳性）的定义出发，验证 $x^\\star$ 在 Mangasarian–Fromovitz 约束规范 (MFCQ) 下满足一阶条件，并确定相关的拉格朗日乘子 $\\lambda^\\star$。\n\n- 使用活动约束的一阶（线性）近似和线性化可行性的定义，导出在 $x^\\star$ 处的线性可行方向锥。然后，利用临界方向是目标函数一阶变化为零的线性可行方向这一原理，导出临界锥 $C(x^\\star,\\lambda^\\star)$。\n\n- 计算拉格朗日函数关于 $x$ 的海森矩阵，即 $\\nabla_{xx}^2 L(x^\\star,\\lambda^\\star)$，并评估沿临界方向的最小曲率：\n$$\n\\alpha^\\star \\;=\\; \\min \\left\\{ d^\\top \\nabla_{xx}^2 L(x^\\star,\\lambda^\\star)\\, d \\;:\\; d \\in C(x^\\star,\\lambda^\\star),\\ \\|d\\|_2 = 1 \\right\\}.\n$$\n\n给出 $\\alpha^\\star$ 作为您的最终答案。不需要四舍五入，也不涉及单位。请将答案表示为单个实数。", "solution": "该问题要求分析非线性规划问题（最小化 $f(x) = x_1^2 + x_2^2$，约束条件为 $h(x) = \\cos(x_1) - x_2 \\le 0$）的候选点 $x^\\star = (0, 1)$。分析内容包括验证 Karush–Kuhn–Tucker (KKT) 条件、确定临界锥，以及计算拉格朗日函数的海森矩阵在该锥内归一化方向上的最小曲率。\n\n首先，我们定义该问题的拉格朗日函数 $L(x, \\lambda)$，其表达式为\n$$L(x, \\lambda) = f(x) + \\lambda h(x) = x_1^2 + x_2^2 + \\lambda (\\cos(x_1) - x_2).$$\n此处，$x = (x_1, x_2)^\\top$ 且 $\\lambda$ 是与不等式约束相关的拉格朗日乘子。\n\n我们首先在点 $x^\\star = (0, 1)^\\top$ 处验证一阶必要条件（KKT 条件）。\n\n目标函数 $f(x)$ 和约束函数 $h(x)$ 的梯度为：\n$$\\nabla f(x) = \\begin{pmatrix} 2x_1 \\\\ 2x_2 \\end{pmatrix}, \\quad \\nabla h(x) = \\begin{pmatrix} -\\sin(x_1) \\\\ -1 \\end{pmatrix}.$$\n在候选点 $x^\\star = (0, 1)^\\top$ 处，这些梯度变为：\n$$\\nabla f(x^\\star) = \\begin{pmatrix} 2(0) \\\\ 2(1) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 2 \\end{pmatrix}, \\quad \\nabla h(x^\\star) = \\begin{pmatrix} -\\sin(0) \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}.$$\n\nKKT 条件包括原始可行性、对偶可行性、互补松弛性和平稳性。\n$1$. **原始可行性**：我们检查 $x^\\star$ 是否满足约束 $h(x) \\le 0$。\n$$h(x^\\star) = \\cos(0) - 1 = 1 - 1 = 0.$$\n由于 $h(x^\\star) = 0$，该约束被满足，并且在 $x^\\star$ 处是活动约束。\n\n$2$. **Mangasarian–Fromovitz 约束规范 (MFCQ)**：对于活动不等式约束集，其梯度向量必须线性无关。此处只有一个活动约束。其梯度 $\\nabla h(x^\\star) = (0, -1)^\\top$ 是一个非零向量，因此它是线性无关的。故 MFCQ 在 $x^\\star$ 处成立，这保证了唯一的拉格朗日乘子 $\\lambda^\\star$ 的存在。\n\n$3$. **平稳性**：拉格朗日函数关于 $x$ 的梯度在 $(x^\\star, \\lambda^\\star)$ 处必须为零：\n$$\\nabla_x L(x^\\star, \\lambda^\\star) = \\nabla f(x^\\star) + \\lambda^\\star \\nabla h(x^\\star) = 0.$$\n代入我们计算出的梯度：\n$$\\begin{pmatrix} 0 \\\\ 2 \\end{pmatrix} + \\lambda^\\star \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.$$\n这个向量方程产生两个标量方程：\n\\begin{align*} 0 + \\lambda^\\star(0) = 0 \\quad \\implies \\quad 0 = 0 \\\\ 2 - \\lambda^\\star = 0 \\quad \\implies \\quad \\lambda^\\star = 2 \\end{align*}\n平稳性条件在唯一的拉格朗日乘子 $\\lambda^\\star = 2$ 下成立。\n\n$4$. **对偶可行性**：对于形式为 $h(x) \\le 0$ 的不等式约束，其乘子必须为非负。我们求得 $\\lambda^\\star = 2$，满足 $\\lambda^\\star \\ge 0$。\n\n$5$. **互补松弛性**：此条件要求 $\\lambda^\\star h(x^\\star) = 0$。我们有 $\\lambda^\\star = 2$ 和 $h(x^\\star) = 0$，所以 $2 \\cdot 0 = 0$。该条件得到满足。\n所有 KKT 条件在 $x^\\star = (0, 1)$ 处，当 $\\lambda^\\star = 2$ 时均得到满足。\n\n接下来，我们推导临界锥 $C(x^\\star, \\lambda^\\star)$。这需要首先找到线性可行方向锥 $LF(x^\\star)$。如果对于所有活动不等式约束 $h_i$，都有 $\\nabla h_i(x^\\star)^\\top d \\le 0$，则方向 $d = (d_1, d_2)^\\top$ 属于 $LF(x^\\star)$。此处只有 $h(x)$ 是活动约束。\n$$\\nabla h(x^\\star)^\\top d \\le 0 \\implies \\begin{pmatrix} 0 & -1 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} \\le 0 \\implies -d_2 \\le 0 \\implies d_2 \\ge 0.$$\n所以，线性可行方向锥为 $LF(x^\\star) = \\{d \\in \\mathbb{R}^2 \\mid d_2 \\ge 0\\}$。\n\n临界锥 $C(x^\\star, \\lambda^\\star)$ 由 $LF(x^\\star)$ 中满足目标函数一阶变化为非正的方向 $d$ 组成，即 $\\nabla f(x^\\star)^\\top d \\le 0$。注意，根据平稳性，有 $\\nabla f(x^\\star)^\\top d = -\\lambda^\\star \\nabla h(x^\\star)^\\top d$。由于 $\\lambda^\\star > 0$，条件 $\\nabla f(x^\\star)^\\top d \\le 0$ 等价于 $\\nabla h(x^\\star)^\\top d \\ge 0$。结合线性可行性条件 $\\nabla h(x^\\star)^\\top d \\le 0$，这便意味着 $\\nabla h(x^\\star)^\\top d = 0$。\n让我们用显式梯度来验证这一点：\n$$\\nabla f(x^\\star)^\\top d = \\begin{pmatrix} 0 & 2 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = 2d_2.$$\n条件 $\\nabla f(x^\\star)^\\top d \\le 0$ 意味着 $2d_2 \\le 0$，即 $d_2 \\le 0$。\n一个方向 $d$ 属于临界锥，如果它同时满足 $d \\in LF(x^\\star)$（即 $d_2 \\ge 0$）和 $\\nabla f(x^\\star)^\\top d \\le 0$（即 $d_2 \\le 0$）。同时满足这两个条件的唯一方法是 $d_2 = 0$。\n因此，临界锥为：\n$$C(x^\\star, \\lambda^\\star) = \\{d = (d_1, d_2)^\\top \\in \\mathbb{R}^2 \\mid d_2 = 0\\}.$$\n这代表 $x_1$ 轴。\n\n最后，我们计算 $\\alpha^\\star$，即拉格朗日函数的海森矩阵沿归一化临界方向的最小曲率。拉格朗日函数关于 $x$ 的海森矩阵是：\n$$\\nabla_{xx}^2 L(x, \\lambda) = \\nabla_{xx}^2 \\left( x_1^2 + x_2^2 + \\lambda (\\cos(x_1) - x_2) \\right) = \\begin{pmatrix} 2 - \\lambda \\cos(x_1) & 0 \\\\ 0 & 2 \\end{pmatrix}.$$\n在 $(x^\\star, \\lambda^\\star) = ((0, 1), 2)$ 处计算该矩阵：\n$$\\nabla_{xx}^2 L(x^\\star, \\lambda^\\star) = \\begin{pmatrix} 2 - 2 \\cos(0) & 0 \\\\ 0 & 2 \\end{pmatrix} = \\begin{pmatrix} 2 - 2(1) & 0 \\\\ 0 & 2 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 2 \\end{pmatrix}.$$\n设 $H = \\nabla_{xx}^2 L(x^\\star, \\lambda^\\star)$。我们要求解：\n$$\\alpha^\\star = \\min \\left\\{ d^\\top H d \\mid d \\in C(x^\\star,\\lambda^\\star),\\ \\|d\\|_2 = 1 \\right\\}.$$\n一个方向 $d \\in C(x^\\star, \\lambda^\\star)$ 必须具有形式 $d = (d_1, 0)^\\top$。归一化条件 $\\|d\\|_2 = 1$ 意味着 $\\sqrt{d_1^2 + 0^2} = 1$，所以 $|d_1| = 1$。这给出了 $d$ 的两种可能向量：$(1, 0)^\\top$ 和 $(-1, 0)^\\top$。\n让我们为一个通用的临界方向 $d = (d_1, 0)^\\top$ 计算二次型 $d^\\top H d$：\n$$d^\\top H d = \\begin{pmatrix} d_1 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 0 & 2 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} d_1 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = 0.$$\n对于临界锥中的任何向量，包括归一化的向量，该二次型的值均为 $0$。因此，最小值为 $0$。\n$$\\alpha^\\star = 0.$$\n这个结果表明，严格局部最小值的二阶充分条件不满足，因为它们要求在临界锥上的曲率为严格正值。", "answer": "$$\n\\boxed{0}\n$$", "id": "3176420"}]}