{"hands_on_practices": [{"introduction": "我们的第一个练习从一个简单的一维问题入手，为精确罚函数的学习奠定基础。通过应用基本的微积分原理，我们将直接观察到惩罚项如何重塑目标函数以强制执行约束。这个练习将帮助你理解寻找能使方法生效的最小惩罚参数阈值的过程 [@problem_id:3126699]。", "problem": "考虑一个一维约束优化问题，其目标函数为 $f(x) = (x-1)^{2}$，约束条件为 $x \\ge 0$。设精确罚函数定义为\n$$\nP_{\\mu}(x) \\;=\\; f(x) \\;+\\; \\mu\\,[-x]_{+},\n$$\n其中 $[-x]_{+} \\equiv \\max\\{-x,\\,0\\}$，罚参数满足 $\\mu \\ge 0$。仅使用约束优化和微积分的基本定义，确定最小的实数 $\\mu$，使得以下精确性性质成立：$P_{\\mu}(x)$ 在所有 $x \\in \\mathbb{R}$ 上的每个全局最小值点都是原约束问题的全局最小值点。请基于第一性原理提供严格的证明，包括确定约束问题的解，并仔细分析罚函数 $P_{\\mu}(x)$ 在区域 $x \\ge 0$ 和 $x  0$ 上的行为。你的最终答案必须是一个实数。不需要四舍五入。", "solution": "该问题要求找到最小的非负罚参数 $\\mu$，使得精确罚函数 $P_{\\mu}(x)$ 的全局最小值点与给定约束优化问题的全局最小值点重合。\n\n首先，我们分析原约束优化问题。目标函数为 $f(x) = (x-1)^{2}$，约束条件为 $x \\ge 0$。可行集为 $S = \\{x \\in \\mathbb{R} \\mid x \\ge 0\\}$。函数 $f(x)$ 是一个凸抛物线，其无约束全局最小值出现在其顶点 $x=1$。由于点 $x=1$ 满足约束条件 $x \\ge 0$，因此它在可行集 $S$ 中。对于一个凸优化问题，无约束最优点如果可行，则它也是约束问题的全局最优点。因此，该约束问题的唯一全局最小值点是 $x^* = 1$。\n\n接下来，我们分析无约束罚函数 $P_{\\mu}(x) = (x-1)^{2} + \\mu \\max\\{-x, 0\\}$，其中 $\\mu \\ge 0$。我们将分情况讨论。\n\n情况1：$x \\ge 0$ (可行域)。\n在此区域中，$-x \\le 0$，所以 $\\max\\{-x, 0\\} = 0$。罚函数简化为：\n$$\nP_{\\mu}(x) = (x-1)^{2}\n$$\n该函数在区间 $[0, \\infty)$ 上的最小值为 $0$，在 $x=1$ 处取得。\n\n情况2：$x  0$ (不可行域)。\n在此区域中，$-x > 0$，所以 $\\max\\{-x, 0\\} = -x$。罚函数变为：\n$$\nP_{\\mu}(x) = (x-1)^{2} + \\mu(-x) = x^{2} - 2x + 1 - \\mu x = x^{2} - (2+\\mu)x + 1\n$$\n这是一个开口向上的抛物线。其顶点（最小值点）位于 $x_c = \\frac{2+\\mu}{2}$。由于 $\\mu \\ge 0$，我们有 $x_c = \\frac{2+\\mu}{2} \\ge 1$。\n因为顶点 $x_c$ 始终在区间 $(-\\infty, 0)$ 之外，且抛物线开口向上，所以函数 $P_{\\mu}(x)$ 在整个区间 $(-\\infty, 0)$ 上是严格递减的。因此，$P_{\\mu}(x)$ 在 $(-\\infty, 0)$ 上的下确界是当 $x$ 从左侧趋近于 $0$ 时的极限：\n$$\n\\inf_{x  0} P_{\\mu}(x) = \\lim_{x \\to 0^{-}} \\left( x^{2} - (2+\\mu)x + 1 \\right) = 1\n$$\n对于任何 $x  0$，函数值都严格大于其下确界，即 $P_{\\mu}(x) > 1$。\n\n现在，我们综合这些结果来找到 $P_{\\mu}(x)$ 在 $\\mathbb{R}$ 上的全局最小值点。\n- 对于 $x \\ge 0$，$P_{\\mu}(x)$ 的最小值为 $0$，在 $x=1$ 处唯一取到。\n- 对于 $x  0$，$P_{\\mu}(x)$ 的值始终严格大于 $1$。\n\n比较整个实轴上的行为，$P_{\\mu}(x)$ 的全局最小值为 $0$，且仅在点 $x=1$ 处取得。这个结论对于罚参数 $\\mu \\ge 0$ 的任何值都成立。\n\n问题要求找到最小的实数 $\\mu$，使得 $P_{\\mu}(x)$ 的每个全局最小值点都是原约束问题的全局最小值点。我们已经证明，约束问题的唯一全局最小值点是 $x^*=1$。我们对 $P_{\\mu}(x)$ 的分析表明，对于任何 $\\mu \\ge 0$，$P_{\\mu}(x)$ 的唯一全局最小值点也是 $x=1$。\n因此，所要求的精确性性质对于区间 $[0, \\infty)$ 中的所有 $\\mu$ 都成立。这个集合中的最小实数是 $0$。", "answer": "$$\\boxed{0}$$", "id": "3126699"}, {"introduction": "在掌握了基础知识之后，这个练习将我们带入一个更真实的场景：一个带线性等式约束的多维二次规划问题。这里的核心目标是揭示罚参数与 Karush-Kuhn-Tucker (KKT) 条件中的拉格朗日乘子之间的深刻联系。通过求解这个问题，你会发现选择足够大的罚参数的理论依据——它的大小必须至少等于最优拉格朗日乘子的绝对值 [@problem_id:3261558]。", "problem": "考虑带有单线性等式约束的凸二次规划 (QP)：在约束 $g(x)=0$ 下最小化函数 $f(x)$，其中 $x \\in \\mathbb{R}^{2}$，\n$$\nf(x) \\equiv \\frac{1}{2} x_{1}^{2} + x_{2}^{2} - 4 x_{1} - 2 x_{2}, \\qquad g(x) \\equiv x_{1} + x_{2} - 1.\n$$\n由于 $f$ 的海森矩阵是正定的，该约束问题有唯一的最优解。定义 $\\ell_{1}$ 精确罚函数 $F_{\\rho}(x)$，其罚参数为 $\\rho \\ge 0$，由下式给出\n$$\nF_{\\rho}(x) \\equiv f(x) + \\rho \\, |g(x)|.\n$$\n从第一性原理出发，按如下步骤进行。首先，使用 Karush–Kuhn–Tucker (KKT) 条件确定约束 QP 的唯一最优解 $x^{\\star}$ 和相关的拉格朗日乘子 $\\lambda^{\\star}$。其次，使用针对凸（可能非光滑）函数的最优性次微分刻画，建立罚参数 $\\rho$ 需满足的充要条件，使得 $x^{\\star}$ 也是 $F_{\\rho}(x)$ 的全局最小化子。最后，确定 $\\rho$ 的最小值，该值保证最小化 $F_{\\rho}(x)$ 可以恢复出约束解 $x^{\\star}$。将您的最终答案表示为精确值（不要四舍五入）。最终答案必须是单个实数。", "solution": "该问题要求找到罚参数 $\\rho$ 的最小值，使得精确罚函数 $F_{\\rho}(x) \\equiv f(x) + \\rho |g(x)|$ 的无约束最小化子与等式约束 QP 的最优解重合。\n\n步骤1：求解约束 QP 并找到拉格朗日乘子。\n约束问题的拉格朗日函数是：\n$$\n\\mathcal{L}(x,\\lambda) \\equiv f(x) + \\lambda g(x) = \\frac{1}{2} x_{1}^{2} + x_{2}^{2} - 4 x_{1} - 2 x_{2} + \\lambda (x_{1} + x_{2} - 1).\n$$\nKKT 条件包括平稳性 ($\\nabla_{x} \\mathcal{L}(x,\\lambda) = 0$) 和原始可行性 ($g(x) = 0$)。\n$\\nabla_{x} \\mathcal{L}(x,\\lambda)$ 给出方程组：\n1. $x_{1} - 4 + \\lambda = 0$\n2. $2 x_{2} - 2 + \\lambda = 0$\n原始可行性条件为：\n3. $x_{1} + x_{2} = 1$\n从前两个方程解出 $x_1$ 和 $x_2$：\n$x_{1} = 4 - \\lambda$\n$x_{2} = \\frac{2 - \\lambda}{2} = 1 - \\frac{\\lambda}{2}$\n将它们代入第三个方程：\n$(4 - \\lambda) + (1 - \\frac{\\lambda}{2}) = 1 \\implies 5 - \\frac{3}{2}\\lambda = 1 \\implies \\frac{3}{2}\\lambda = 4 \\implies \\lambda^{\\star} = \\frac{8}{3}.$\n然后回代求得最优解 $x^{\\star}$：\n$x_{1}^{\\star} = 4 - \\frac{8}{3} = \\frac{4}{3}$\n$x_{2}^{\\star} = 1 - \\frac{4}{3} = -\\frac{1}{3}$\n因此，唯一最优解是 $x^{\\star} = (\\frac{4}{3}, -\\frac{1}{3})$，对应的拉格朗日乘子为 $\\lambda^{\\star} = \\frac{8}{3}$。\n\n步骤2：精确罚函数的次微分最优性。\n$F_{\\rho}(x) = f(x) + \\rho |g(x)|$ 是一个凸函数。对于一个凸函数，在点 $x^{\\star}$ 处的一阶最优性条件是 $\\mathbf{0} \\in \\partial F_{\\rho}(x^{\\star})$。\n$F_{\\rho}(x)$ 在 $x^{\\star}$ 处的次微分是：\n$$\n\\partial F_{\\rho}(x^{\\star}) = \\nabla f(x^{\\star}) + \\rho \\, \\partial|g(x^{\\star})|\n$$\n由于 $g(x^{\\star}) = 0$，次微分 $\\partial|g(x^{\\star})|$ 通过链式法则计算为 $\\partial|g(x^{\\star})| = \\partial|\\cdot|_{t=0} \\cdot \\nabla g(x^{\\star}) = [-1,1] \\nabla g(x^{\\star})$。\n因此，最优性条件变为：\n$$\n\\mathbf{0} \\in \\nabla f(x^{\\star}) + \\rho \\, s \\, \\nabla g(x^{\\star}) \\quad \\text{for some } s \\in [-1,1].\n$$\n从 KKT 条件的平稳性部分，我们知道 $\\nabla f(x^{\\star}) + \\lambda^{\\star} \\nabla g(x^{\\star}) = \\mathbf{0}$，即 $\\nabla f(x^{\\star}) = -\\lambda^{\\star} \\nabla g(x^{\\star})$。\n代入次梯度最优性条件：\n$$\n\\mathbf{0} \\in -\\lambda^{\\star} \\nabla g(x^{\\star}) + \\rho \\, s \\, \\nabla g(x^{\\star}) = (-\\lambda^{\\star} + \\rho s) \\nabla g(x^{\\star}).\n$$\n由于 $\\nabla g(x^{\\star}) = (1, 1)^T \\neq \\mathbf{0}$，这要求存在一个 $s \\in [-1,1]$ 使得 $-\\lambda^{\\star} + \\rho s = 0$，即 $\\lambda^{\\star} = \\rho s$。\n\n步骤3：最小罚参数。\n$\\lambda^{\\star} = \\rho s$ 对某个 $s \\in [-1,1]$ 成立的充要条件是 $|\\lambda^{\\star}| \\le \\rho$。由于 $f$ 是强凸的，$F_{\\rho}$ 也是强凸的，因此当此条件满足时，$x^{\\star}$ 是 $F_{\\rho}$ 的唯一全局最小化子。\n要保证通过最小化 $F_{\\rho}(x)$ 能恢复 $x^{\\star}$，我们需要的最小罚参数为：\n$$\n\\rho_{\\min} = |\\lambda^{\\star}| = \\left| \\frac{8}{3} \\right| = \\frac{8}{3}.\n$$", "answer": "$$\\boxed{\\frac{8}{3}}$$", "id": "3261558"}, {"introduction": "学会了如何设置罚参数后，理解设置得过低会带来什么后果也至关重要。这个练习通过一个精心设计的非凸函数场景，展示了不充分的惩罚如何在可行域之外产生“伪”局部最小值。这突显了一个关键的实践陷阱，并强调了为什么我们在前一个练习中推导出的条件对于保证得到正确解是如此重要 [@problem_id:3126635]。", "problem": "考虑一维约束优化问题：最小化成本函数 $f(x)$，满足单个不等式约束 $g(x) \\leq 0$。可行集为 $\\mathcal{F} = \\{x \\in \\mathbb{R} : x \\leq 0\\}$。定义成本函数 $f$ 在一个不可行区间上有一个平台，具体如下：\n$$\nf(x) =\n\\begin{cases}\n5,  x \\leq 0, \\\\\n11,  0  x  1, \\\\\n1,  1 \\leq x \\leq 2, \\\\\n10 + (x-2)^2,  x > 2,\n\\end{cases}\n$$\n并定义不等式约束为 $g(x) = x$，因此 $\\mathcal{F} = (-\\infty, 0]$。考虑标准的 $L^1$ 型精确罚函数 $P_\\mu(x) = f(x) + \\mu \\max\\{0, g(x)\\} = f(x) + \\mu \\max\\{0, x\\}$，其中罚参数 $\\mu > 0$。\n\n从可行性和精确惩罚的定义出发，分析当 $\\mu$ 不够大时，惩罚目标函数 $P_\\mu$ 是否会在可行集 $\\mathcal{F}$ 之外引入虚假的局部最小值，并确定在上述情况下发生此现象时 $\\mu$ 的条件。然后选择下面最准确的陈述。\n\nA. 在这种情况下，$x=1$ 是 $P_\\mu$ 的一个位于 $\\mathcal{F}$ 之外的严格局部最小化点。如果 $\\mu  4$，$x=1$ 也是 $P_\\mu$ 的一个全局最小化点，因此不足够大的 $\\mu$ 会引入一个不可行的最小化点；对于 $\\mu \\geq 4$，所有全局最小化点都是可行的，尽管在 $x=1$ 处的不可行局部最小值仍然高于或等于可行最小值。\n\nB. 对于任何 $\\mu > 0$，$P_\\mu$ 在 $\\mathcal{F}$ 之外不能有局部最小值，因为惩罚项总是将最小化点强制推入 $\\mathcal{F}$。\n\nC. 虚假的局部最小值只可能在 $f$ 在不可行区域上是严格凸函数时出现；$f$ 中的平台会阻止任何 $\\mu$ 的不可行局部最小值的出现。\n\nD. 精确罚函数对于所有 $\\mu > 0$ 都是精确的；因此，无论 $f$ 的形状如何，$P_\\mu$ 的最小化点集总是与约束问题的解集重合。", "solution": "该问题要求分析罚函数 $P_\\mu(x) = f(x) + \\mu \\max\\{0, x\\}$ 的行为，并确定何时会因罚参数 $\\mu$ 不够大而出现不可行的最小值。\n\n1.  **分析约束问题**\n    可行集为 $\\mathcal{F} = (-\\infty, 0]$。在该区域内，目标函数 $f(x)$ 恒为 5。因此，原约束问题的最优值为 5，解集为整个可行集 $(-\\infty, 0]$。\n\n2.  **分析罚函数 $P_\\mu(x)$**\n    我们分区域考察罚函数：\n    *   **可行区域 ($x \\leq 0$)**:\n        $P_\\mu(x) = f(x) + \\mu \\cdot 0 = 5$。\n    *   **不可行区域 ($x > 0$)**:\n        $P_\\mu(x) = f(x) + \\mu x$。\n        *   当 $0  x  1$ 时，$P_\\mu(x) = 11 + \\mu x$。\n        *   当 $1 \\leq x \\leq 2$ 时，$P_\\mu(x) = 1 + \\mu x$。\n        *   当 $x > 2$ 时，$P_\\mu(x) = 10 + (x-2)^2 + \\mu x$。\n\n3.  **寻找虚假的（不可行的）局部最小值**\n    在每个开区间 $(0,1)$ 和 $(2, \\infty)$，以及闭区间 $[1,2]$ 内，$P_\\mu(x)$ 都是严格单调递增的（因为 $\\mu>0$），因此内部没有局部最小值。局部最小值只可能出现在 $f(x)$ 不连续的点，即 $x=1$。\n    *   **在 $x=1$ 处**：\n        $P_\\mu(1) = f(1) + \\mu \\cdot 1 = 1 + \\mu$。\n        对于 $x$ 在 1 的一个小的左邻域内 (例如 $x \\in (1-\\epsilon, 1)$)，$P_\\mu(x) = 11 + \\mu x$。其左极限为 $\\lim_{x \\to 1^-} P_\\mu(x) = 11 + \\mu$。\n        对于 $x$ 在 1 的一个小的右邻域内 (例如 $x \\in (1, 1+\\epsilon)$)，$P_\\mu(x) = 1 + \\mu x$。\n        因为 $\\lim_{x \\to 1^-} P_\\mu(x) = 11 + \\mu > 1 + \\mu = P_\\mu(1)$，且对于 $x>1$，$P_\\mu(x) = 1 + \\mu x > 1 + \\mu = P_\\mu(1)$，所以 $x=1$ 是一个严格的局部最小值点。由于 $x=1$ 不可行，这是一个虚假的局部最小值。\n\n4.  **确定虚假全局最小值的条件**\n    这个虚假的局部最小值是否会成为全局最小值，取决于其值 $1+\\mu$ 与可行区域的最小值 5 的比较。\n    *   如果 $1 + \\mu  5$（即 $\\mu  4$），那么不可行点 $x=1$ 处的函数值 $1+\\mu$ 小于可行区域内的值 5。因此，$x=1$ 成为全局最小值点。这种情况下，精确罚函数方法失败。\n    *   如果 $1 + \\mu \\geq 5$（即 $\\mu \\geq 4$），那么不可行点 $x=1$ 处的函数值不小于可行区域内的最小值。\n        *   当 $\\mu > 4$ 时，全局最小值为 5，在可行集 $(-\\infty, 0]$ 上取得。\n        *   当 $\\mu = 4$ 时，全局最小值为 5，在集合 $(-\\infty, 0] \\cup \\{1\\}$ 上取得。此时，存在一个不可行的全局最小化点。\n\n5.  **评估选项**\n    *   **A**: 声明 $x=1$ 是一个虚假的严格局部最小化点（正确）。声明如果 $\\mu  4$，$x=1$ 是全局最小化点（正确）。声明对于 $\\mu \\geq 4$，所有全局最小化点都是可行的，这在 $\\mu=4$ 的边界情况下略有不准，但总体上是对行为最准确的描述。\n    *   **B**: 错误。我们找到了一个在 $x=1$ 处的虚假局部最小值。\n    *   **C**: 错误。恰恰是 $f$ 的非凸、平台结构导致了虚假最小值。\n    *   **D**: 错误。方法仅在 $\\mu$ 足够大时才精确（在此例中为 $\\mu \\geq 4$）。\n\n结论：选项 A 对该罚函数的行为提供了最准确和最全面的描述。", "answer": "$$\\boxed{A}$$", "id": "3126635"}]}