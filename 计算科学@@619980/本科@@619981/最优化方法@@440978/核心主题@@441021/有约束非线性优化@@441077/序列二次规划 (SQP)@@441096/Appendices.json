{"hands_on_practices": [{"introduction": "理论学习最好通过实践来巩固。本节将通过一系列精心设计的练习，帮助你掌握序列二次规划 (SQP) 的核心思想和技术。第一个练习将带你完成 SQP 算法最基本的一步：构建并求解二次规划 (QP) 子问题以确定搜索方向。通过从一个非可行点出发，你将亲身体验如何利用目标函数的二次近似和约束的线性近似，来计算出朝向最优解的最佳改进方向。[@problem_id:2201995]", "problem": "考虑一个优化问题，寻找离原点最近的点 $(x_1, x_2)$，该点必须满足约束条件，即位于由方程 $x_1 - x_2 + 1 = 0$ 定义的直线上。这个问题可以表述为最小化到原点的欧几里得距离的平方：\n$$\n\\begin{aligned}\n\\min_{x_1, x_2} \\quad  f(x_1, x_2) = x_1^2 + x_2^2 \\\\\n\\text{s.t.} \\quad  h(x_1, x_2) = x_1 - x_2 + 1 = 0\n\\end{aligned}\n$$\n你需要执行一次序列二次规划（SQP）方法的迭代来解决此问题。从初始的非可行点 $x_0 = (1, 1)^T$ 出发，确定在第一步中计算出的搜索方向 $p_0 = (p_1, p_2)^T$。\n\n你的最终答案应该是一个包含搜索方向向量分量 $p_1$ 和 $p_2$ 的行矩阵。", "solution": "我们要最小化 $f(x_{1},x_{2})=x_{1}^{2}+x_{2}^{2}$，并服从等式约束 $h(x_{1},x_{2})=x_{1}-x_{2}+1=0$。拉格朗日函数为 $L(x,\\lambda)=f(x)-\\lambda h(x)$。它关于 $x$ 的海森矩阵是 $\\nabla_{xx}^{2}L(x,\\lambda)=\\nabla^{2}f(x)-\\lambda\\nabla^{2}h(x)=2I$，因为 $h$ 是线性的。\n\n在初始点 $x_{0}=(1,1)^{T}$，我们有 $\\nabla f(x_{0})=2x_{0}=(2,2)^{T}$，$h(x_{0})=1$，以及 $\\nabla h(x_{0})=(1,-1)^{T}$。SQP 子问题是\n$$\n\\min_{p}\\; \\frac{1}{2}p^{T}(2I)p+\\nabla f(x_{0})^{T}p\n\\quad\\text{s.t.}\\quad h(x_{0})+\\nabla h(x_{0})^{T}p=0.\n$$\n这可以简化为\n$$\n\\min_{p_{1},p_{2}}\\; p_{1}^{2}+p_{2}^{2}+2p_{1}+2p_{2}\n\\quad\\text{s.t.}\\quad p_{1}-p_{2}=-1.\n$$\n构造子问题的拉格朗日函数 $Q(p,\\mu)=p_{1}^{2}+p_{2}^{2}+2p_{1}+2p_{2}+\\mu\\,(p_{1}-p_{2}+1)$ 并设平稳性条件为：\n$$\n\\frac{\\partial Q}{\\partial p_{1}}=2p_{1}+2+\\mu=0,\\qquad\n\\frac{\\partial Q}{\\partial p_{2}}=2p_{2}+2-\\mu=0,\n$$\n以及约束条件 $p_{1}-p_{2}+1=0$。由平稳性条件可知，$\\mu=-2p_{1}-2=2p_{2}+2$，因此 $p_{1}+p_{2}=-2$。结合 $p_{1}-p_{2}=-1$，求解得到 $p_{1}=-\\frac{3}{2}$ 和 $p_{2}=-\\frac{1}{2}$。\n\n因此，第一步的 SQP 搜索方向是 $p_{0}=\\left(-\\frac{3}{2},-\\frac{1}{2}\\right)$。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{3}{2}  -\\frac{1}{2}\\end{pmatrix}}$$", "id": "2201995"}, {"introduction": "找到了正确的搜索方向后，我们应该沿着这个方向走多远呢？这个练习探讨了 SQP 中的一个关键实际问题：步长选择。通过一个简单的一维问题，你将发现，直接采用从 QP 子问题中解出的“最优”完整步长，有时可能会“矫枉过正”，反而越过了原始问题的真正最优解。这个现象凸显了在 SQP 算法中引入线搜索和价值函数 (merit function) 以确保稳定收敛的必要性。[@problem_id:2202020]", "problem": "序列二次规划 (SQP) 是一种强大的迭代算法，用于求解带约束的非线性优化问题。在每次迭代中，该方法通过一个更简单的二次规划 (QP) 子问题来近似原问题，以找到一个搜索方向。然后，从当前估计值出发，沿着这个方向移动，从而找到解的新估计值。\n\n考虑以下一维非线性优化问题：\n最小化目标函数 $f(x) = (x - 2)^2$\n约束条件为不等式约束 $c(x) = 9 - x^2 \\le 0$。\n\n你的任务是执行一步完整的 SQP 算法。在迭代点 $x_k$ 和拉格朗日乘子估计值 $\\lambda_k$ 处的 QP 子问题定义如下：\n最小化 (关于步长 $p$) $\\quad Q(p) = \\frac{1}{2} p (\\nabla^2_{xx} L(x_k, \\lambda_k)) p + (\\nabla f(x_k)) p$\n约束条件为 $\\quad (\\nabla c(x_k)) p + c(x_k) \\le 0$\n这里，$L(x, \\lambda) = f(x) + \\lambda c(x)$ 是拉格朗日函数，$\\nabla$ 表示梯度（在一维情况下是导数），$\\nabla^2_{xx}$ 表示海森矩阵（在一维情况下是二阶导数）。\n\n从初始点 $x_0 = 2$ 和初始拉格朗日乘子估计值 $\\lambda_0 = 0$ 开始，确定下一个迭代点 $x_1$。$x_1$ 的计算方法是：求解 QP 子问题得到搜索方向 $p_0$，然后取一个完整步长，即 $x_1 = x_0 + p_0$。\n\n从以下选项中选择 $x_1$ 的正确值。\n\nA. 3.00\n\nB. 3.25\n\nC. 2.00\n\nD. 0.75\n\nE. 3.125", "solution": "给定目标函数为 $f(x)=(x-2)^{2}$ 且不等式约束为 $c(x)=9-x^{2}\\leq 0$ 的非线性规划问题。拉格朗日函数为 $L(x,\\lambda)=f(x)+\\lambda c(x)$。对于在点 $(x_{0},\\lambda_{0})=(2,0)$ 处的 SQP 子问题，我们需要计算 $\\nabla f(x_{0})$、$\\nabla c(x_{0})$、$c(x_{0})$ 以及 $\\nabla^{2}_{xx}L(x_{0},\\lambda_{0})$。\n\n计算导数：\n- $\\nabla f(x)=2(x-2)$，因此 $\\nabla f(2)=2(2-2)=0$。\n- $\\nabla^{2} f(x)=2$。\n- $\\nabla c(x)=-2x$，因此 $\\nabla c(2)=-4$。\n- $\\nabla^{2} c(x)=-2$。\n\n在点 $(x_{0},\\lambda_{0})$ 处拉格朗日函数的海森矩阵为\n$$\n\\nabla^{2}_{xx}L(x_{0},\\lambda_{0})=\\nabla^{2}f(x_{0})+\\lambda_{0}\\nabla^{2}c(x_{0})=2+0\\cdot(-2)=2.\n$$\n此外，$c(x_{0})=9-(2)^{2}=5$。\n\n关于步长 $p$ 的 QP 子问题是\n$$\n\\min_{p}\\; Q(p)=\\frac{1}{2}p\\left(\\nabla^{2}_{xx}L(x_{0},\\lambda_{0})\\right)p+\\left(\\nabla f(x_{0})\\right)p=\\frac{1}{2}p(2)p+0\\cdot p=p^{2},\n$$\n约束条件为线性化约束\n$$\n\\nabla c(x_{0})\\,p+c(x_{0})\\leq 0 \\;\\;\\Longleftrightarrow\\;\\; (-4)p+5\\leq 0 \\;\\;\\Longleftrightarrow\\;\\; p\\geq \\frac{5}{4}.\n$$\n由于 $Q(p)=p^{2}$ 是凸函数，且在 $p\\geq 0$ 上是增函数，因此在 $p\\geq \\frac{5}{4}$ 上的最小值点是\n$$\np_{0}=\\frac{5}{4}.\n$$\n取一个完整步长得到\n$$\nx_{1}=x_{0}+p_{0}=2+\\frac{5}{4}=\\frac{13}{4}=3.25,\n$$\n这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "2202020"}, {"introduction": "实际的优化问题并非总是“表现良好”的凸问题。当面对非凸问题时，基础的 SQP 方法可能会遇到困难。这个练习通过一个思想实验，揭示了一种典型的算法失效模式：当拉格朗日函数的 Hessian 矩阵不满足正定性时，构建的 QP 子问题可能无下界。理解这种失效情况对于领会为何强大的 SQP 求解器通常会采用诸如 BFGS 等拟牛顿法来修正 Hessian 矩阵至关重要。[@problem_id:2202011]", "problem": "序列二次规划 (SQP) 是一种用于求解带约束的非线性规划 (NLP) 问题的迭代方法。在每次迭代 `k` 中，给定当前点 `x_k` 和一个拉格朗日乘子估计值 `\\lambda_k`，通过求解一个二次规划 (QP) 子问题来找到一个搜索方向 `p`。\n\n考虑以下一维非线性规划问题：\n最小化 $f(x) = -x^3$，约束条件为 $x \\ge 0$。\n\n我们来分析 SQP 方法从可行点 $x_0 = 1$ 开始的第一步。寻找搜索方向 `p` 的 QP 子问题被表述为：\n$$\n\\begin{align*}\n\\min_{p} \\quad  \\nabla f(x_0)^T p + \\frac{1}{2} p^T (\\nabla_{xx}^2 L(x_0, \\lambda_0)) p \\\\\n\\text{s.t.} \\quad  \\nabla c(x_0)^T p + c(x_0) \\ge 0\n\\end{align*}\n$$\n其中 $L(x, \\lambda) = f(x) - \\lambda c(x)$ 是问题 $\\min f(x)$ s.t. $c(x) \\ge 0$ 的拉格朗日函数。对于此问题，我们使用拉格朗日函数的真实海森矩阵和一个初始拉格朗日乘子估计值 $\\lambda_0 = 0$。\n\n以下哪个陈述正确描述了这个 QP 子问题的解？\n\nA. QP 子问题是不可行的。\n\nB. QP 子问题在 $p = 0$ 处有唯一的极小值点。\n\nC. QP 子问题是下无界的。\n\nD. QP 子问题在 $p = -0.5$ 处有唯一的极小值点。\n\nE. QP 子问题在 $p = -1$ 处有唯一的极小值点。", "solution": "我们将不等式约束定义为 $c(x)=x$，因此问题是 $\\min f(x)$，约束条件为 $c(x)\\ge 0$。拉格朗日函数是 $L(x,\\lambda)=f(x)-\\lambda c(x)$。\n\n在起始点 $x_{0}=1$ 且 $\\lambda_{0}=0$ 时，我们计算 QP 子问题的各个组成部分：\n- 目标函数梯度：$\\nabla f(x)=f'(x)=-3x^{2}$，因此 $\\nabla f(x_{0})=-3$。\n- 约束及其梯度：$c(x)=x$，所以 $c(x_{0})=1$ 且 $\\nabla c(x_{0})=c'(x_{0})=1$。\n- 拉格朗日函数的海森矩阵：$\\nabla_{xx}^{2}L(x,\\lambda)=f''(x)-\\lambda c''(x)$。由于 $f''(x)=-6x$ 且 $c''(x)=0$，我们有 $\\nabla_{xx}^{2}L(x_{0},\\lambda_{0})=-6$。\n\n因此，关于步长方向 $p$ 的 QP 子问题是\n$$\n\\min_{p}\\;\\; \\nabla f(x_{0})\\,p+\\frac{1}{2}\\,p^{2}\\,\\nabla_{xx}^{2}L(x_{0},\\lambda_{0})\n=\\min_{p}\\;\\;(-3)p+\\frac{1}{2}(-6)p^{2}\n=\\min_{p}\\;\\; -3p-3p^{2}\n$$\n约束条件为线性化约束\n$$\n\\nabla c(x_{0})\\,p+c(x_{0})\\ge 0 \\;\\;\\Longleftrightarrow\\;\\; p+1\\ge 0 \\;\\;\\Longleftrightarrow\\;\\; p\\ge -1.\n$$\n\n可行集是半直线 $\\{p\\in\\mathbb{R}:p\\ge -1\\}$。目标函数是一个凹二次函数 $\\phi(p)=-3p-3p^{2}$，其首项系数为 -3。在可行集内，当 $p\\to +\\infty$ 时，$\\phi(p)=-3p^{2}-3p\\to -\\infty$。因此，该 QP 子问题是下无界的。\n\n因此，正确的陈述是该 QP 子问题是下无界的。", "answer": "$$\\boxed{C}$$", "id": "2202011"}]}