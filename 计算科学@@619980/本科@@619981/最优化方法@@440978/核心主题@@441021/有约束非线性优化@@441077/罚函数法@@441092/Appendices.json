{"hands_on_practices": [{"introduction": "本章的动手实践旨在将理论应用于具体情境，以加深你对罚函数法的理解。我们从一个思想实验开始，它揭示了不同优化算法所依赖的基本假设。通过分析一个可行域内部为空集的特例，我们将理解为何内点法（如障碍函数法）会失效，而外点法（如罚函数法）在这种情况下依然能够提供一个稳健的解决方案 [@problem_id:2423479]。这个练习是理解算法选择背后深刻原因的绝佳起点。", "problem": "考虑一维约束优化问题：\n- 最小化目标函数 $f(x) = (x - 1)^{2}$，\n- 受两个不等式约束 $g_{1}(x) \\le 0$ 和 $g_{2}(x) \\le 0$ 的限制，其中 $g_{1}(x) = x$ 且 $g_{2}(x) = -x$。\n\n该公式导出的可行集由 $x \\le 0$ 和 $x \\ge 0$ 同时定义。\n\n根据第一性原理：\n- 不等式约束问题的可行集是集合 $\\{x \\mid g_{i}(x) \\le 0 \\text{ for all } i\\}$，其内部由所有 $g_{i}(x)  0$ 严格成立的点组成。\n- 对数障碍法通过在可行集的严格内部定义一系列无约束子问题来替代约束问题，并使用仅在不等式严格成立处为有限值的障碍项。\n- 外点罚函数法和精确罚函数法通过在目标函数上增加对违反约束的惩罚项来允许不可行的迭代点。\n\n基于这些基本原理，关于将障碍法应用于此问题并确定适当补救措施的以下陈述中，哪些是正确的？\n\nA. 可行集为 $\\{x = 0\\}$，其在 $\\mathbb{R}$ 中没有内部；不存在同时满足 $x  0$ 和 $-x  0$ 的严格可行点。因此，对于任何障碍参数，对数障碍子问题的定义域为空集，中心路径不存在。\n\nB. 可以在边界点 $x = 0$ 初始化对数障碍法，并减小障碍参数以驱动迭代点沿边界趋向解，因为障碍项在边界上保持有限值。\n\nC. 这两个不等式可以被替换为单个等式 $h(x) = x = 0$，并且可以使用形式为 $-\\mu \\log(|h(x)|)$ 的障碍项来强制执行该等式，而不会引入可行性问题。\n\nD. 将约束重构为等式 $h(x) = x = 0$，并使用直接处理等式的方法——例如序列二次规划（SQP, Sequential Quadratic Programming）、增广拉格朗日方法或精确 $\\ell_{1}$ 罚函数法——来求解，可以避免空内部问题并能恢复约束解。\n\nE. 一种外点二次罚函数法，从任意初始点 $x$ 最小化 $f(x) + \\tfrac{\\rho}{2}\\,\\big(\\max\\{g_{1}(x), 0\\}\\big)^{2} + \\tfrac{\\rho}{2}\\,\\big(\\max\\{g_{2}(x), 0\\}\\big)^{2}$，当 $\\rho \\to \\infty$ 时，产生的迭代点会趋于可行，并且在此问题中，最小化点收敛到 $x = 0$。", "solution": "所呈现的是一个约束优化问题。在继续之前，必须确定其有效性。\n\n该问题要求最小化目标函数 $f(x) = (x - 1)^{2}$，同时满足两个不等式约束 $g_{1}(x) = x \\le 0$ 和 $g_{2}(x) = -x \\le 0$。给定的条件是形式化的且数学上合理的。函数定义良好。约束 $x \\le 0$ 和 $x \\ge 0$ 同时定义了一个只包含一个点 $\\mathcal{F} = \\{0\\}$ 的可行集。这是一个不寻常但有效的设置，旨在测试不同优化算法的适用性，特别是它们对可行集性质的依赖。该问题在数学优化领域具有科学依据，是适定的、客观的。它不包含任何不一致或模糊之处。因此，问题陈述是有效的。\n\n现在我们将基于优化理论的第一性原理来分析该问题和每个陈述。\n\n该优化问题是：\n$$\n\\begin{aligned}\n\\text{minimize} \\quad  f(x) = (x - 1)^{2} \\\\\n\\text{subject to} \\quad  g_{1}(x) = x \\le 0 \\\\\n g_{2}(x) = -x \\le 0\n\\end{aligned}\n$$\n可行集是所有满足 $x \\le 0$ 和 $x \\ge 0$ 的 $x \\in \\mathbb{R}$ 的集合。唯一满足这两个条件的点是 $x=0$。因此，可行集是 $\\mathcal{F} = \\{0\\}$。\n由于可行集只包含一个点，约束问题的解必然是该点：$x^{*} = 0$。对应的目标函数值为 $f(0) = (0 - 1)^{2} = 1$。$f(x)$ 的无约束最小化点在 $x=1$ 处，该点是不可行的。\n\n现在我们来评估每个陈述。\n\nA. 可行集为 $\\{x = 0\\}$，其在 $\\mathbb{R}$ 中没有内部；不存在同时满足 $x  0$ 和 $-x  0$ 的严格可行点。因此，对于任何障碍参数，对数障碍子问题的定义域为空集，中心路径不存在。\n\n标准的对数障碍法通过求解一系列形式如下的无约束子问题来处理不等式约束问题：\n$$ \\text{minimize} \\quad \\phi(x, \\mu) = f(x) - \\mu \\sum_{i} \\log(-g_{i}(x)) $$\n其中 $\\mu > 0$ 是障碍参数。对数障碍函数 $\\phi(x, \\mu)$ 的定义域是可行集的严格内部，定义为 $\\{x \\mid g_{i}(x)  0 \\text{ for all } i\\}$。\n对于本问题，严格内部要求 $g_{1}(x) = x  0$ 和 $g_{2}(x) = -x  0$。第二个不等式等价于 $x > 0$。同时满足 $x  0$ 和 $x > 0$ 的点的集合是空集 $\\emptyset$。\n因此，可行集 $\\mathcal{F} = \\{0\\}$ 的内部为空。对于任何 $\\mu > 0$ 的选择，对数障碍子问题的定义域都是空的。因此，该方法无法启动，因为不存在有效的起始点。中心路径被定义为对于变化的 $\\mu$ 的障碍子问题解的集合，它无法被定义。\n该陈述准确地描述了当标准对数障碍法应用于可行集内部为空的问题时出现的这种根本性失败。\n结论：**正确**。\n\nB. 可以在边界点 $x = 0$ 初始化对数障碍法，并减小障碍参数以驱动迭代点沿边界趋向解，因为障碍项在边界上保持有限值。\n\n该陈述包含关于障碍法的两个根本性错误。首先，内点法，包括对数障碍法，需要一个严格可行的起始点。根据定义，它们在可行集的内部运行，并非设计为在边界上初始化。其次，关于障碍项在边界上是有限的断言是错误的。对数项 $\\log(-g_{i}(x))$ 在 $g_{i}(x) \\to 0^{-}$ 时趋近于 $-\\infty$。因此，障碍项本身 $-\\mu \\log(-g_{i}(x))$ 趋近于 $+\\infty$。这种无限大的惩罚正是形成“障碍”并防止迭代点离开可行集内部的机制。在 $x=0$ 处，$\\log(-x)$ 和 $\\log(x)$ 均无定义，因此障碍函数不是有限的。\n结论：**不正确**。\n\nC. 这两个不等式可以被替换为单个等式 $h(x) = x = 0$，并且可以使用形式为 $-\\mu \\log(|h(x)|)$ 的障碍项来强制执行该等式，而不会引入可行性问题。\n\n两个不等式约束等价于单个等式约束 $h(x) = x = 0$ 是正确的。然而，提出的使用形式为 $-\\mu \\log(|h(x)|)$ 的项来强制执行此等式的函数并非有效方法。障碍法是为不等式约束设计的，这些约束定义了具有非空内部的可行域。等式约束定义了一个流形，在高维空间中，其内部为空。项 $-\\mu \\log(|x|)$ 在可行点 $x=0$ 处产生一个奇点。需要最小化的函数将是 $(x-1)^2 - \\mu \\log(|x|)$。当 $x \\to 0$ 时，此函数趋近于 $+\\infty$。因此，最小化算法将被驱离解 $x=0$，而不是趋向它。该项起到了从可行集“排斥”的作用，与要求相反。\n结论：**不正确**。\n\nD. 将约束重构为等式 $h(x) = x = 0$，并使用直接处理等式的方法——例如 SQP (Sequential Quadratic Programming)、增广拉格朗日方法或精确 $\\ell_{1}$ 罚函数法——来求解，可以避免空内部问题并能恢复约束解。\n\n该陈述提出了一种有效且可行的策略。约束 $x \\le 0$ 和 $x \\ge 0$ 被正确地重构为单个等式约束 $h(x) = x = 0$。问题于是变为：最小化 $f(x) = (x-1)^2$，约束条件为 $x=0$。\n像 SQP、增广拉格朗日方法和精确罚函数法这类方法是专门为处理等式约束而设计的。它们不依赖于可行内部的存在。\n-   对于此问题的**增广拉格朗日方法**是最小化 $L_{\\rho}(x, \\lambda) = (x-1)^2 + \\lambda x + \\frac{\\rho}{2} x^2$。该方法收敛到正确的解 $x^*=0$。\n-   **精确 $\\ell_1$ 罚函数法**最小化函数 $(x-1)^2 + \\rho |x|$。对于足够大的罚参数 $\\rho$（具体来说，当 $\\rho \\ge 2$，其中 2 是解处的拉格朗日乘子的大小），该罚函数的最小化点恰好是 $x^*=0$。\n-   **SQP** 求解一系列模拟原问题的二次规划问题。对于这个简单情况，它会轻易找到解 $x^*=0$。\n这些方法完全规避了困扰障碍法的空内部问题。\n结论：**正确**。\n\nE. 一种外点二次罚函数法，从任意初始点 $x$ 最小化 $f(x) + \\tfrac{\\rho}{2}\\,\\big(\\max\\{g_{1}(x), 0\\}\\big)^{2} + \\tfrac{\\rho}{2}\\,\\big(\\max\\{g_{2}(x), 0\\}\\big)^{2}$，当 $\\rho \\to \\infty$ 时，产生的迭代点会趋于可行，并且在此问题中，最小化点收敛到 $x = 0$。\n\n不等式约束 $g_i(x) \\le 0$ 的二次罚函数被正确给出。对于给定的罚参数 $\\rho > 0$，需要最小化的函数是：\n$$ P(x; \\rho) = (x-1)^2 + \\frac{\\rho}{2} \\left( (\\max\\{x, 0\\})^2 + (\\max\\{-x, 0\\})^2 \\right) $$\n我们可以分析惩罚项。如果 $x > 0$，惩罚是 $\\frac{\\rho}{2}(x^2 + 0) = \\frac{\\rho}{2}x^2$。如果 $x  0$，惩罚是 $\\frac{\\rho}{2}(0 + (-x)^2) = \\frac{\\rho}{2}x^2$。如果 $x=0$，惩罚是 $0$。因此，对于所有 $x \\in \\mathbb{R}$，惩罚项简化为 $\\frac{\\rho}{2}x^2$。\n子问题是最小化 $P(x; \\rho) = (x-1)^2 + \\frac{\\rho}{2}x^2$。这是一个严格凸函数，其最小化点 $x_\\rho$ 可以通过将其导数设为零来找到：\n$$ \\frac{d P}{dx} = 2(x-1) + \\rho x = (2+\\rho)x - 2 = 0 $$\n解出 $x$，我们得到 $x_{\\rho} = \\frac{2}{2+\\rho}$。\n在罚参数趋于无穷大的极限情况下，我们有：\n$$ \\lim_{\\rho \\to \\infty} x_{\\rho} = \\lim_{\\rho \\to \\infty} \\frac{2}{2+\\rho} = 0 $$\n最小化点序列 $\\{x_\\rho\\}$ 收敛到唯一的可行点 $x^*=0$。这是二次罚函数法的预期行为。该陈述完全正确。\n结论：**正确**。", "answer": "$$\\boxed{ADE}$$", "id": "2423479"}, {"introduction": "在理解了不同方法的基本适用边界后，我们转向一个更具体的计算问题。本练习将对一个二维凸优化问题，进行精确 $\\ell_{1}$ 罚函数法和对数障碍函数法的正面比较。你将运用 KKT 条件找到真实解，并推导出保证罚函数法收敛到该解所需的临界罚参数，从而深入理解罚参数与拉格朗日乘子之间的内在联系 [@problem_id:3162047]。", "problem": "考虑具有两个仿射不等式约束的凸二次规划问题：在 $x \\in \\mathbb{R}^{2}$ 上最小化目标函数 $f(x) = (x_1 - 1)^{2} + (x_2 + 2)^{2}$，约束条件为 $x_1 + x_2 \\ge 0$ 和 $x_1 - x_2 \\le 1$。通过 $g_1(x) := -(x_1 + x_2)$ 和 $g_2(x) := x_1 - x_2 - 1$ 将约束定义为标准形式 $g_1(x) \\le 0$ 和 $g_2(x) \\le 0$。可行集是两个半空间 $g_1(x) \\le 0$ 和 $g_2(x) \\le 0$ 的交集，该交集是非空且凸的。假设所有函数都是连续可微的。\n\n你将分析和比较在精确 $\\ell_{1}$ 罚函数方法和对数障碍函数方法下出现的激活集，并将你的推导建立在基本原理之上：凸性、Karush-Kuhn-Tucker (KKT) 条件以及罚函数和障碍函数公式的定义。\n\n任务：\n\n1. 使用凸优化的 Karush-Kuhn-Tucker (KKT) 条件，确定唯一的约束最小化点 $x^{\\star} = (x_1^{\\star}, x_2^{\\star})$，并识别在 $x^{\\star}$ 处哪些约束是激活的。\n\n2. 考虑带有罚参数 $\\gamma > 0$ 的精确 $\\ell_{1}$ 罚函数 $F_{\\gamma}(x) := f(x) + \\gamma \\left(\\max\\{0, g_1(x)\\} + \\max\\{0, g_2(x)\\}\\right)$。确定最小的罚参数 $\\gamma_{\\min}$，使得当 $\\gamma \\ge \\gamma_{\\min}$ 时，$F_{\\gamma}$ 的每个全局最小化点都与约束最小化点 $x^{\\star}$ 一致。你的推导必须从 $x^{\\star}$ 处的 KKT 驻定性和 $F_{\\gamma}$ 在 $x^{\\star}$ 附近的方向导数刻画开始。\n\n3. 对于障碍参数 $\\mu > 0$ 的对数障碍函数法，定义障碍目标函数 $\\phi_{\\mu}(x) := f(x) - \\mu \\left(\\ln(-g_1(x)) + \\ln(-g_2(x))\\right)$，该函数仅在严格可行集 $g_1(x)  0$ 且 $g_2(x)  0$ 上是有限的。令 $x(\\mu)$ 表示对于每个 $\\mu > 0$ 的 $\\phi_{\\mu}$ 的一个最小化点。令约束松弛量为 $s_i(\\mu) := -g_i(x(\\mu)) > 0$，$i \\in \\{1, 2\\}$。从 $\\phi_{\\mu}$ 的驻定性条件及其关于缩放乘子的解释出发，推导出极限\n$$\nL := \\lim_{\\mu \\to 0^{+}} \\frac{s_1(\\mu)}{s_2(\\mu)}\n$$\n作为一个明确的实数。\n\n你的最终答案必须以单行矩阵的形式提供，按顺序包含四个条目 $x_1^{\\star}$、$x_2^{\\star}$、$\\gamma_{\\min}$ 和 $L$。无需四舍五入；请提供精确值。本题不涉及角度。", "solution": "优化问题是在 $x = (x_1, x_2) \\in \\mathbb{R}^{2}$ 上最小化目标函数 $f(x) = (x_1 - 1)^{2} + (x_2 + 2)^{2}$，受限于不等式约束 $g_1(x) = -(x_1 + x_2) \\le 0$ 和 $g_2(x) = x_1 - x_2 - 1 \\le 0$。函数 $f(x)$ 是严格凸的，且可行集是一个闭凸多边形，因此存在唯一的约束最小化点 $x^{\\star}$。\n\n任务1：使用 KKT 条件确定约束最小化点。\n\n最小化点 $x^{\\star}$ 的 Karush-Kuhn-Tucker (KKT) 条件是：\n1. 驻定性：$\\nabla f(x^{\\star}) + \\lambda_1 \\nabla g_1(x^{\\star}) + \\lambda_2 \\nabla g_2(x^{\\star}) = 0$\n2. 原始可行性：$g_1(x^{\\star}) \\le 0$ 且 $g_2(x^{\\star}) \\le 0$\n3. 对偶可行性：$\\lambda_1 \\ge 0$ 且 $\\lambda_2 \\ge 0$\n4. 互补松弛性：$\\lambda_1 g_1(x^{\\star}) = 0$ 且 $\\lambda_2 g_2(x^{\\star}) = 0$\n\n各函数的梯度为：\n$\\nabla f(x) = \\begin{pmatrix} 2(x_1 - 1) \\\\ 2(x_2 + 2) \\end{pmatrix}$\n$\\nabla g_1(x) = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}$\n$\\nabla g_2(x) = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$\n\n驻定性条件为：\n$2(x_1^{\\star} - 1) - \\lambda_1 + \\lambda_2 = 0$\n$2(x_2^{\\star} + 2) - \\lambda_1 - \\lambda_2 = 0$\n\n我们根据约束的激活集分情况讨论。\n情况 A：没有激活约束。$g_1(x^{\\star})  0$, $g_2(x^{\\star})  0$。根据互补松弛性，$\\lambda_1 = 0$ 且 $\\lambda_2 = 0$。驻定性条件给出 $2(x_1^{\\star} - 1) = 0 \\implies x_1^{\\star} = 1$ 和 $2(x_2^{\\star} + 2) = 0 \\implies x_2^{\\star} = -2$。我们检查可行性：$g_1(1, -2) = -(1 - 2) = 1 > 0$，这违反了原始可行性。因此这种情况不是解。\n\n情况 B：$g_1$ 激活，$g_2$ 未激活。$g_1(x^{\\star}) = 0 \\implies -x_1^{\\star} - x_2^{\\star} = 0 \\implies x_2^{\\star} = -x_1^{\\star}$。互补松弛性给出 $\\lambda_2 = 0$。驻定性条件变为 $2(x_1^{\\star} - 1) - \\lambda_1 = 0$ 和 $2(x_2^{\\star} + 2) - \\lambda_1 = 0$。令二者相等得到 $x_1^{\\star} - 1 = x_2^{\\star} + 2 \\implies x_1^{\\star} - x_2^{\\star} = 3$。代入 $x_2^{\\star} = -x_1^{\\star}$ 得 $2x_1^{\\star} = 3 \\implies x_1^{\\star} = 3/2$，因此 $x_2^{\\star} = -3/2$。检查非激活约束：$g_2(3/2, -3/2) = 3/2 - (-3/2) - 1 = 3 - 1 = 2 > 0$，违反了原始可行性。\n\n情况 C：$g_2$ 激活，$g_1$ 未激活。$g_2(x^{\\star}) = 0 \\implies x_1^{\\star} - x_2^{\\star} - 1 = 0 \\implies x_2^{\\star} = x_1^{\\star} - 1$。互补松弛性给出 $\\lambda_1 = 0$。驻定性条件变为 $2(x_1^{\\star} - 1) + \\lambda_2 = 0$ 和 $2(x_2^{\\star} + 2) - \\lambda_2 = 0$。令二者相等得到 $x_1^{\\star} - 1 = -(x_2^{\\star} + 2) \\implies x_1^{\\star} + x_2^{\\star} = -1$。代入 $x_2^{\\star} = x_1^{\\star} - 1$ 得 $2x_1^{\\star} - 1 = -1 \\implies x_1^{\\star} = 0$，因此 $x_2^{\\star} = -1$。检查非激活约束：$g_1(0, -1) = -(0 - 1) = 1 > 0$，违反了原始可行性。\n\n情况 D：两个约束都激活。$g_1(x^{\\star}) = 0 \\implies -x_1^{\\star} - x_2^{\\star} = 0$ 且 $g_2(x^{\\star}) = 0 \\implies x_1^{\\star} - x_2^{\\star} - 1 = 0$。这是一个关于 $x^{\\star}$ 的线性系统。将两个方程相加得到 $-2x_2^{\\star} - 1 = 0 \\implies x_2^{\\star} = -1/2$。则 $x_1^{\\star} = -x_2^{\\star} = 1/2$。所以，$x^{\\star} = (1/2, -1/2)$。\n我们必须验证存在非负乘子。从驻定性条件：\n$2(1/2 - 1) - \\lambda_1 + \\lambda_2 = 0 \\implies -1 - \\lambda_1 + \\lambda_2 = 0 \\implies \\lambda_2 - \\lambda_1 = 1$。\n$2(-1/2 + 2) - \\lambda_1 - \\lambda_2 = 0 \\implies 3 - \\lambda_1 - \\lambda_2 = 0 \\implies \\lambda_1 + \\lambda_2 = 3$。\n将这两个方程相加得到 $2\\lambda_2 = 4 \\implies \\lambda_2 = 2$。代回原式，$\\lambda_1 = 3 - \\lambda_2 = 3 - 2 = 1$。\n由于 $\\lambda_1 = 1 \\ge 0$ 且 $\\lambda_2 = 2 \\ge 0$，所有 KKT 条件都满足。\n因此，唯一的约束最小化点是 $x^{\\star} = (1/2, -1/2)$，并且两个约束 $g_1(x) \\le 0$ 和 $g_2(x) \\le 0$ 在 $x^{\\star}$ 处都是激活的。\n\n任务2：确定最小罚参数 $\\gamma_{\\min}$。\n\n精确 $\\ell_1$ 罚函数是 $F_{\\gamma}(x) = f(x) + \\gamma (\\max\\{0, g_1(x)\\} + \\max\\{0, g_2(x)\\})$。对于一个凸问题，约束最小化点 $x^{\\star}$ 也是 $F_{\\gamma}(x)$ 的全局最小化点的充要条件是零向量在 $x^{\\star}$ 处位于 $F_{\\gamma}$ 的次微分中，即 $0 \\in \\partial F_{\\gamma}(x^{\\star})$。\n次微分由 $\\partial F_{\\gamma}(x) = \\nabla f(x) + \\gamma (\\partial\\max\\{0, g_1(x)\\} + \\partial\\max\\{0, g_2(x)\\})$ 给出。\n在 $x^{\\star}$ 处，$g_1(x^{\\star}) = 0$ 和 $g_2(x^{\\star}) = 0$ 都成立。max 函数在其参数为零的点的次微分为：\n$\\partial\\max\\{0, g_i(x^{\\star})\\} = \\{ \\alpha_i \\nabla g_i(x^{\\star}) \\mid \\alpha_i \\in [0, 1] \\}$。\n条件 $0 \\in \\partial F_{\\gamma}(x^{\\star})$ 变为：\n对于某些 $\\alpha_1 \\in [0, 1]$ 和 $\\alpha_2 \\in [0, 1]$，$0 = \\nabla f(x^{\\star}) + \\gamma \\alpha_1 \\nabla g_1(x^{\\star}) + \\gamma \\alpha_2 \\nabla g_2(x^{\\star})$。\n这个方程可以写成 $\\nabla f(x^{\\star}) + (\\gamma \\alpha_1) \\nabla g_1(x^{\\star}) + (\\gamma \\alpha_2) \\nabla g_2(x^{\\star}) = 0$。\n将其与任务1中的 KKT 驻定性条件 $\\nabla f(x^{\\star}) + \\lambda_1^{\\star} \\nabla g_1(x^{\\star}) + \\lambda_2^{\\star} \\nabla g_2(x^{\\star}) = 0$ 进行比较，我们可以将 KKT 乘子与罚函数公式中的项对应起来：\n$\\lambda_1^{\\star} = \\gamma \\alpha_1$\n$\\lambda_2^{\\star} = \\gamma \\alpha_2$\n从任务1中，我们得到 $\\lambda_1^{\\star} = 1$ 和 $\\lambda_2^{\\star} = 2$。所以我们有：\n$1 = \\gamma \\alpha_1 \\implies \\alpha_1 = 1/\\gamma$\n$2 = \\gamma \\alpha_2 \\implies \\alpha_2 = 2/\\gamma$\n此类 $\\alpha_1, \\alpha_2$ 的存在要求它们在区间 $[0, 1]$ 内。由于 $\\gamma > 0$，条件是：\n$1/\\gamma \\le 1 \\implies \\gamma \\ge 1$\n$2/\\gamma \\le 1 \\implies \\gamma \\ge 2$\n为了同时满足这两个条件，我们必须有 $\\gamma \\ge 2$。因此最小值为 $\\gamma_{\\min} = 2$。对于任何 $\\gamma \\ge \\gamma_{\\min}$，$x^{\\star}$ 是 $F_{\\gamma}(x)$ 的一个最小化点。由于 $f(x)$ 是严格凸的，且罚函数项是凸的，所以对于任何 $\\gamma>0$，$F_{\\gamma}(x)$ 都是严格凸的，这确保了 $x^{\\star}$ 是唯一的全局最小化点。\n\n任务3：确定极限 $L$。\n\n对数障碍目标函数为 $\\phi_{\\mu}(x) = f(x) - \\mu (\\ln(-g_1(x)) + \\ln(-g_2(x)))$，其中 $\\mu > 0$。令 $x(\\mu)$ 为 $\\phi_{\\mu}(x)$ 的一个最小化点，对于每个 $\\mu > 0$，该点存在于严格可行区域 $g_1(x)  0$ 和 $g_2(x)  0$ 中。$x(\\mu)$ 的一阶最优性条件是 $\\nabla \\phi_{\\mu}(x(\\mu)) = 0$。\n$\\nabla \\phi_{\\mu}(x) = \\nabla f(x) - \\mu \\left( \\frac{1}{-g_1(x)}\\nabla g_1(x) + \\frac{1}{-g_2(x)}\\nabla g_2(x) \\right)$。\n在 $x(\\mu)$ 处，这给出：\n$\\nabla f(x(\\mu)) + \\frac{\\mu}{-g_1(x(\\mu))} \\nabla g_1(x(\\mu)) + \\frac{\\mu}{-g_2(x(\\mu))} \\nabla g_2(x(\\mu)) = 0$。\n让我们将与障碍函数相关的乘子定义为 $\\lambda_1(\\mu) := \\frac{\\mu}{-g_1(x(\\mu))}$ 和 $\\lambda_2(\\mu) := \\frac{\\mu}{-g_2(x(\\mu))}$。驻定性条件变为：\n$\\nabla f(x(\\mu)) + \\lambda_1(\\mu) \\nabla g_1(x(\\mu)) + \\lambda_2(\\mu) \\nabla g_2(x(\\mu)) = 0$。\n在内点法的标准假设下（此问题满足这些假设，因为问题是凸的，解是唯一的，并且激活约束的梯度是线性无关的），当障碍参数 $\\mu \\to 0^{+}$ 时，最小化点路径 $x(\\mu)$ 收敛到真实解 $x^{\\star}$，并且乘子 $\\lambda_i(\\mu)$ 收敛到 KKT 乘子 $\\lambda_i^{\\star}$。\n$\\lim_{\\mu \\to 0^{+}} x(\\mu) = x^{\\star} = (1/2, -1/2)$\n$\\lim_{\\mu \\to 0^{+}} \\lambda_1(\\mu) = \\lambda_1^{\\star} = 1$\n$\\lim_{\\mu \\to 0^{+}} \\lambda_2(\\mu) = \\lambda_2^{\\star} = 2$\n约束松弛量定义为 $s_i(\\mu) = -g_i(x(\\mu))$。我们想要找到极限 $L := \\lim_{\\mu \\to 0^{+}} \\frac{s_1(\\mu)}{s_2(\\mu)}$。\n根据乘子的定义，我们可以将松弛量表示为：\n$s_1(\\mu) = -g_1(x(\\mu)) = \\frac{\\mu}{\\lambda_1(\\mu)}$\n$s_2(\\mu) = -g_2(x(\\mu)) = \\frac{\\mu}{\\lambda_2(\\mu)}$\n松弛量的比率为：\n$\\frac{s_1(\\mu)}{s_2(\\mu)} = \\frac{\\mu / \\lambda_1(\\mu)}{\\mu / \\lambda_2(\\mu)} = \\frac{\\lambda_2(\\mu)}{\\lambda_1(\\mu)}$。\n当 $\\mu \\to 0^{+}$ 时取极限：\n$L = \\lim_{\\mu \\to 0^{+}} \\frac{s_1(\\mu)}{s_2(\\mu)} = \\lim_{\\mu \\to 0^{+}} \\frac{\\lambda_2(\\mu)}{\\lambda_1(\\mu)} = \\frac{\\lim_{\\mu \\to 0^{+}} \\lambda_2(\\mu)}{\\lim_{\\mu \\to 0^{+}} \\lambda_1(\\mu)} = \\frac{\\lambda_2^{\\star}}{\\lambda_1^{\\star}}$。\n代入任务1中的 KKT 乘子值：\n$L = \\frac{2}{1} = 2$。\n\n最终结果是 $x_1^{\\star} = 1/2$，$x_2^{\\star} = -1/2$，$\\gamma_{\\min} = 2$，以及 $L = 2$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}  -\\frac{1}{2}  2  2 \\end{pmatrix}}\n$$", "id": "3162047"}, {"introduction": "最后的实践将理论与编程实现相结合，让你亲身体验算法的数值行为。你将把二次罚函数法应用于一个网络流问题，不仅需要推导必要的数学公式，还需编写代码来观察随着罚参数 $\\mu$ 的增大，解的轨迹如何变化。本练习将直观地展示算法在改善可行性与应对数值病态问题之间的权衡，这是在实践中应用罚函数法时必须考虑的关键问题 [@problem_id:3162033]。", "problem": "给定一个有向网络，其节点为 $\\{0,1,2,3\\}$，有向边为 $\\{e_0,e_1,e_2,e_3,e_4\\}$，定义如下：$e_0$ 从节点 $0$ 指向节点 $1$，$e_1$ 从节点 $0$ 指向节点 $2$，$e_2$ 从节点 $1$ 指向节点 $2$，$e_3$ 从节点 $1$ 指向节点 $3$，$e_4$ 从节点 $2$ 指向节点 $3$。设流量向量为 $x \\in \\mathbb{R}^5$，其分量顺序为 $(x_{e_0},x_{e_1},x_{e_2},x_{e_3},x_{e_4})$。考虑节点 $\\{0,1,2\\}$ 处的流量守恒等式（节点 $3$ 被省略），使用的约定是每个节点的净流出量等于其散度。根据此约定，表示节点 $\\{0,1,2\\}$ 处净流出约束的矩阵 $A \\in \\mathbb{R}^{3 \\times 5}$ 为\n$$\nA=\\begin{bmatrix}\n1  1  0  0  0\\\\\n-1  0  1  1  0\\\\\n0  -1  -1  0  1\n\\end{bmatrix},\n$$\n散度向量为 $b \\in \\mathbb{R}^3$，其中 $b=[1,0,0]^T$。其基础的凸二次成本函数为\n$$\nf(x)=\\tfrac{1}{2} x^T Q x + c^T x,\n$$\n其中 $Q \\in \\mathbb{R}^{5 \\times 5}$ 是一个对角矩阵，其对角线元素为 $\\{2,1,3,1,2\\}$，$c \\in \\mathbb{R}^5$ 等于 $[0.1,0.2,0.0,-0.1,0.1]^T$。考虑二次惩罚目标函数\n$$\nF_\\mu(x)=\\tfrac{1}{2} x^T Q x + c^T x + \\tfrac{\\mu}{2}\\lVert A x - b\\rVert_2^2,\n$$\n其中惩罚参数 $\\mu0$。\n\n从以下基本原理出发：(i) 无约束可微凸最小化问题的一阶最优性条件，即梯度为零；(ii) 到仿射集上的欧几里得投影是在线性等式约束下最小化平方欧几里得距离；以及 (iii) Karush–Kuhn–Tucker (KKT) 条件，它为具有线性等式约束的凸二次规划问题提供了必要且充分的最优性条件。请在不使用任何快捷公式的情况下完成以下任务。\n\n任务：\n- 推导 $F_\\mu(x)$ 的最小化子 $x(\\mu)$ 的平稳性条件，并将其表示为一个关于 $x(\\mu)$、$A$、$Q$、$b$、$c$ 和 $\\mu$ 的线性系统。\n- 推导到仿射集 $\\{y \\in \\mathbb{R}^5 \\mid A y = b\\}$ 上的欧几里得投影算子 $P(\\cdot)$，并用 $A$ 和 $b$ 表示 $P(x)$。\n- 推导等式约束问题 $\\min_x f(x)$ subject to $A x = b$ 的 KKT 条件，并写出关于原始变量 $x^\\star$ 和拉格朗日乘子 $\\lambda^\\star$ 的相应线性系统。\n- 实现一个程序，完全按照规定构造 $A$、$Q$、$c$ 和 $b$，然后对每个测试惩罚值 $\\mu$ 计算：\n  1. 通过求解您推导的平稳性线性系统，得到惩罚最小化子 $x(\\mu)$。\n  2. 可行性违反度 $v(\\mu)=\\lVert A x(\\mu)-b\\rVert_2$。\n  3. 欧几里得投影 $y(\\mu)=P\\big(x(\\mu)\\big)$。\n  4. 到投影的距离 $d(\\mu)=\\lVert x(\\mu)-y(\\mu)\\rVert_2$。\n  5. 通过求解您推导的 KKT 线性系统，得到等式约束优化器 $x^\\star$，以及目标差距 $g(\\mu)=f\\big(y(\\mu)\\big)-f\\big(x^\\star\\big)$。\n- 对惩罚参数 $\\mu$ 使用以下测试集：$\\{10^{-6},10^{-2},1,10,10^{4}\\}$。\n- 您的程序必须输出单行结果，其中包含一个结果列表，每个测试 $\\mu$ 对应一个结果。每个结果是一个包含三个浮点数的列表 $[v(\\mu),d(\\mu),g(\\mu)]$，每个浮点数四舍五入到 $6$ 位小数。最终输出格式必须是单行，形式为用方括号括起来的逗号分隔列表，例如 $[\\,[v(\\mu_1),d(\\mu_1),g(\\mu_1)],\\,[v(\\mu_2),d(\\mu_2),g(\\mu_2)],\\,\\dots\\,]$。\n\n科学真实性和推导要求：\n- 所有推导都必须从上面列出的三个基本要素开始，并逐步进行，不得引入任何未说明的快捷方式或引用目标公式。\n- 此处不涉及角度和物理单位。\n- 测试集的最终输出是浮点数列表，单行输出必须按规定将所有情况汇总到一个带括号的列表中。", "solution": "该问题是有效的。它提出了一个在凸优化领域内适定、自洽且具有科学依据的问题，具体涉及用于线性约束二次规划的二次惩罚方法。所有必需的数据、定义和矩阵均已提供，任务涉及该领域的标准推导和计算。\n\n### 推导\n\n解决方案需要基于问题陈述中指定的基本原理进行三个核心推导。\n\n**1. 惩罚目标函数 $F_\\mu(x)$ 的平稳性条件**\n\n惩罚目标函数由下式给出\n$$F_\\mu(x)=\\tfrac{1}{2} x^T Q x + c^T x + \\tfrac{\\mu}{2}\\lVert A x - b\\rVert_2^2$$\n矩阵 $Q$ 是对角矩阵，其正对角元素为 $\\{2,1,3,1,2\\}$，因此它是正定的。于是，函数 $f(x)=\\tfrac{1}{2} x^T Q x + c^T x$ 是严格凸的。对于任何 $\\mu > 0$，惩罚项 $\\tfrac{\\mu}{2}\\lVert A x - b\\rVert_2^2$ 也是凸的，因为它是仿射函数 $x \\mapsto Ax-b$ 和凸函数 $z \\mapsto \\tfrac{\\mu}{2}\\lVert z \\rVert_2^2$ 的复合。因此，对于 $\\mu>0$，$F_\\mu(x)$ 是一个严格凸且可微的函数。\n\n根据无约束凸最小化的一阶最优性条件，唯一的最小化子 $x(\\mu)$ 出现在 $F_\\mu(x)$ 关于 $x$ 的梯度为零向量的地方。\n梯度为：\n$$\\nabla F_\\mu(x) = \\nabla_x \\left( \\tfrac{1}{2} x^T Q x + c^T x \\right) + \\nabla_x \\left( \\tfrac{\\mu}{2}(A x - b)^T (A x - b) \\right)$$\n第一部分的梯度是 $\\nabla_x f(x) = Qx + c$。\n对于惩罚项，我们将其展开为 $\\tfrac{\\mu}{2}(x^T A^T A x - 2b^T A x + b^T b)$。这个二次型的梯度是 $\\tfrac{\\mu}{2}(2A^T A x - 2A^T b) = \\mu A^T(Ax-b)$。\n将这些结合起来，$F_\\mu(x)$ 的梯度是：\n$$\\nabla F_\\mu(x) = Qx + c + \\mu A^T(Ax-b)$$\n在优化器 $x(\\mu)$ 处将梯度设为零：\n$$\\nabla F_\\mu(x(\\mu)) = Qx(\\mu) + c + \\mu A^T(Ax(\\mu)-b) = 0$$\n重新整理各项，以形成一个关于 $x(\\mu)$ 的线性系统：\n$$Qx(\\mu) + \\mu A^T A x(\\mu) = \\mu A^T b - c$$\n$$(Q + \\mu A^T A) x(\\mu) = \\mu A^T b - c$$\n这就是表示为最小化子 $x(\\mu)$ 的线性系统的平稳性条件。矩阵 $(Q + \\mu A^T A)$ 是正定的，因为 $Q$ 是正定的，且对于 $\\mu > 0$，$\\mu A^T A$ 是半正定的，这保证了 $x(\\mu)$ 的唯一解。\n\n**2. 欧几里得投影算子 $P(x)$**\n\n点 $x(\\mu)$ 到仿射集 $S = \\{y \\in \\mathbb{R}^5 \\mid Ay = b\\}$ 上的欧几里得投影 $y(\\mu) = P(x(\\mu))$ 是 $S$ 中使得到 $x(\\mu)$ 的平方欧几里得距离最小化的点。该问题是：\n$$\\min_{y \\in \\mathbb{R}^5} \\tfrac{1}{2} \\lVert y - x(\\mu) \\rVert_2^2 \\quad \\text{subject to} \\quad Ay = b$$\n这是一个等式约束的凸二次规划问题。Karush-Kuhn-Tucker (KKT) 条件为最优性提供了必要且充分的条件。设 $x$ 为待投影的点。拉格朗日函数是：\n$$L(y, \\lambda) = \\tfrac{1}{2} (y-x)^T(y-x) + \\lambda^T(Ay-b)$$\n其中 $\\lambda \\in \\mathbb{R}^3$ 是拉格朗日乘子向量。KKT 条件是：\n1.  **平稳性 (Stationarity)：** $L$ 关于 $y$ 的梯度必须为零。\n    $$\\nabla_y L(y, \\lambda) = (y-x) + A^T \\lambda = 0 \\implies y = x - A^T \\lambda$$\n2.  **原始可行性 (Primal Feasibility)：** 约束必须被满足。\n    $$Ay = b$$\n将平稳性条件中 $y$ 的表达式代入可行性条件：\n$$A(x - A^T \\lambda) = b$$\n$$Ax - A A^T \\lambda = b$$\n$$A A^T \\lambda = Ax - b$$\n矩阵 $A \\in \\mathbb{R}^{3 \\times 5}$ 具有满行秩（秩为 $3$），这意味着 $3 \\times 3$ 矩阵 $A A^T$ 是可逆的。我们可以解出 $\\lambda$：\n$$\\lambda = (A A^T)^{-1} (Ax - b)$$\n将此 $\\lambda$ 代回到 $y$ 的表达式中，得到投影算子 $P(x)$：\n$$P(x) = y = x - A^T (A A^T)^{-1} (Ax - b)$$\n\n**3. 约束问题的 KKT 系统**\n\n原始的约束优化问题是：\n$$\\min_x f(x) = \\tfrac{1}{2} x^T Q x + c^T x \\quad \\text{subject to} \\quad Ax = b$$\n这是一个具有线性等式约束的凸二次规划问题。KKT 条件对于一个点 $x^\\star$ 成为唯一的全局最小化子是必要且充分的。该问题的拉格朗日函数是：\n$$L(x, \\lambda) = f(x) + \\lambda^T(Ax-b) = \\tfrac{1}{2} x^T Q x + c^T x + \\lambda^T(Ax-b)$$\n最优原始-对偶对 $(x^\\star, \\lambda^\\star)$ 的 KKT 条件是：\n1.  **平稳性 (Stationarity)：** $L$ 关于 $x$ 的梯度为零。\n    $$\\nabla_x L(x^\\star, \\lambda^\\star) = Qx^\\star + c + A^T \\lambda^\\star = 0$$\n2.  **原始可行性 (Primal Feasibility)：** 约束被满足。\n    $$Ax^\\star = b$$\n这两个条件可以合并成一个单一的线性分块系统：\n$$\\begin{bmatrix} Q  A^T \\\\ A  0 \\end{bmatrix} \\begin{bmatrix} x^\\star \\\\ \\lambda^\\star \\end{bmatrix} = \\begin{bmatrix} -c \\\\ b \\end{bmatrix}$$\n其中 $0$ 是一个 $3 \\times 3$ 的零矩阵。求解该系统可得到约束优化器 $x^\\star$ 和相关的拉格朗日乘子 $\\lambda^\\star$。\n\n### 计算步骤\n\n数值实现过程如下：\n1.  按照规定构造矩阵 $A$、$Q$ 和向量 $c$、$b$。\n2.  构建并求解一次约束问题的 KKT 系统，以找到最优解 $x^\\star$。此步骤与 $\\mu$ 无关。同时计算最优目标值 $f(x^\\star)$。\n3.  一个循环遍历测试集 $\\{10^{-6}, 10^{-2}, 1, 10, 10^{4}\\}$ 中的每个惩罚参数 $\\mu$。\n4.  在循环内部，对每个 $\\mu$：\n    a. 求解线性系统 $(Q + \\mu A^T A) x(\\mu) = \\mu A^T b - c$ 以找到惩罚最小化子 $x(\\mu)$。\n    b. 计算可行性违反度 $v(\\mu) = \\lVert A x(\\mu) - b \\rVert_2$。\n    c. 使用推导出的公式 $y(\\mu) = x(\\mu) - A^T (A A^T)^{-1} (A x(\\mu) - b)$ 计算投影 $y(\\mu)$。\n    d. 计算到投影的距离 $d(\\mu) = \\lVert x(\\mu) - y(\\mu) \\rVert_2$。\n    e. 计算投影点处的目标值 $f(y(\\mu))$，并确定目标差距 $g(\\mu) = f(y(\\mu)) - f(x^\\star)$。\n5.  将计算出的值 $[v(\\mu), d(\\mu), g(\\mu)]$ 四舍五入到 $6$ 位小数并存储。\n6.  最后，将所有 $\\mu$ 值的汇总结果格式化为指定的单行列表的列表的字符串表示形式。", "answer": "[[0.963473,0.485121,0.117172],[0.82528,0.41584,0.086392],[0.297906,0.149257,0.011082],[0.052733,0.026402,0.000347],[8e-05,4e-05,0.0]]", "id": "3162033"}]}