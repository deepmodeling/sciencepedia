{"hands_on_practices": [{"introduction": "掌握内点法的第一步是理解如何为一个简单问题构建并求解其障碍子问题。本练习将引导你为一个二维线性规划问题推导障碍函数最小点的精确解析解。通过计算当障碍参数$\\mu$趋近于零时的极限，你将亲眼验证中心路径确实收敛于原始约束问题的最优解 [@problem_id:3145963]，从而直观地理解中心路径的核心思想。", "problem": "考虑一个关于两个变量 $x$ 和 $y$ 的约束优化问题：\n最小化线性目标函数 $f(x,y) = x + y$，约束条件为 $x \\ge 0$，$y \\ge 0$ 和 $x + y \\le 1$。对数障碍法通过一个障碍项来取代不等式约束，并考虑对于参数 $\\mu  0$ 的障碍子问题\n$$\n\\min_{x,y} \\;\\; F_{\\mu}(x,y) := x + y - \\mu\\left(\\ln x + \\ln y + \\ln(1 - x - y)\\right)\n$$\n定义域为开集 $\\{(x,y) \\in \\mathbb{R}^{2} : x  0,\\; y  0,\\; x + y  1\\}$。\n\n仅使用多元微积分和凸分析的基本事实——即自然对数 $\\ln(\\cdot)$ 在 $(0,\\infty)$ 上是严格凹函数，严格凹函数的非负加权和是严格凹函数，以及在障碍函数中反转符号时，加上一个线性函数会保持严格凸性——完成以下任务：\n\n- 证明 $F_{\\mu}(x,y)$ 在其定义域上是严格凸函数，因此其唯一的最小值点由其梯度为零来刻画。\n- 以 $\\mu$ 的显式函数形式，推导出障碍子问题的唯一最小值点 $(x_{\\mu}, y_{\\mu})$ 的闭式解。\n- 确定原问题的约束最优解 $(x^{\\star}, y^{\\star})$，并通过取极限 $\\mu \\to 0$ 来验证 $(x_{\\mu}, y_{\\mu})$ 趋近于 $(x^{\\star}, y^{\\star})$。\n\n以 $\\mu$ 的单个表达式形式给出 $(x_{\\mu}, y_{\\mu})$ 的最终答案。无需四舍五入，不涉及单位。", "solution": "该问题在凸优化领域内是数学上适定的、自洽的且科学合理的。所有提供的信息都是一致的，足以推导出唯一解。因此，该问题是有效的。\n\n任务是为一个给定的线性规划问题分析一个对数障碍子问题。原始的约束问题是：\n$$\n\\text{最小化 } f(x,y) = x + y \\\\\n\\text{约束条件为 } x \\ge 0, y \\ge 0, x + y \\le 1\n$$\n对于参数 $\\mu  0$ 的障碍子问题是最小化以下函数：\n$$\nF_{\\mu}(x,y) = x + y - \\mu\\left(\\ln x + \\ln y + \\ln(1 - x - y)\\right)\n$$\n其定义域为开凸集 $\\mathcal{D} = \\{(x,y) \\in \\mathbb{R}^{2} : x  0, y  0, x + y  1\\}$。\n\n首先，我们证明 $F_{\\mu}(x,y)$ 在其定义域 $\\mathcal{D}$ 上是严格凸函数。函数 $F_{\\mu}(x,y)$ 是四个分量函数的和：$f_0(x,y) = x+y$，$f_1(x) = -\\mu \\ln x$，$f_2(y) = -\\mu \\ln y$，以及 $f_3(x,y) = -\\mu \\ln(1-x-y)$。\n1.  函数 $f_0(x,y) = x+y$ 是线性的，因此是凸函数。\n2.  函数 $f_1(x) = -\\mu \\ln x$ 仅是 $x$ 的函数。其二阶导数为 $f_1''(x) = \\frac{\\mu}{x^2}$。由于在 $\\mathcal{D}$ 上 $\\mu  0$ 且 $x  0$，我们有 $f_1''(x)  0$。因此，$f_1(x)$ 是 $x$ 的严格凸函数。作为 $(x,y)$ 的函数，它也是严格凸的。\n3.  类似地，$f_2(y) = -\\mu \\ln y$ 是 $y$ 的严格凸函数，因此也是 $(x,y)$ 的严格凸函数。\n4.  函数 $f_3(x,y) = -\\mu \\ln(1-x-y)$ 是凸函数 $h(z) = -\\mu \\ln z$ 和仿射映射 $g(x,y) = 1-x-y$ 的复合。一个凸函数与一个仿射映射的复合是凸函数。\n函数 $F_{\\mu}(x,y)$ 是这四个函数的和。几个凸函数与至少一个严格凸函数的和是严格凸的。由于 $F_{\\mu}(x,y)$ 包含严格凸函数 $f_1(x)$ 和 $f_2(y)$，因此它在凸定义域 $\\mathcal{D}$ 上是严格凸的。\n\n一个定义在凸集上的严格凸函数至多有一个最小值点。由于 $F_{\\mu}(x,y)$ 是可微的，其唯一的最小值点 $(x_{\\mu}, y_{\\mu})$ 必须满足一阶最优性条件，即梯度为零：$\\nabla F_{\\mu}(x,y) = 0$。\n$F_{\\mu}(x,y)$ 的偏导数是：\n$$\n\\frac{\\partial F_{\\mu}}{\\partial x} = 1 - \\frac{\\mu}{x} + \\frac{\\mu}{1 - x - y}\n$$\n$$\n\\frac{\\partial F_{\\mu}}{\\partial y} = 1 - \\frac{\\mu}{y} + \\frac{\\mu}{1 - x - y}\n$$\n令梯度为零，得到方程组：\n$$\n1 - \\frac{\\mu}{x} + \\frac{\\mu}{1 - x - y} = 0 \\quad (1)\n$$\n$$\n1 - \\frac{\\mu}{y} + \\frac{\\mu}{1 - x - y} = 0 \\quad (2)\n$$\n方程(1)减去方程(2)得到：\n$$\n\\left(1 - \\frac{\\mu}{x}\\right) - \\left(1 - \\frac{\\mu}{y}\\right) = 0 \\implies -\\frac{\\mu}{x} + \\frac{\\mu}{y} = 0\n$$\n由于 $\\mu  0$，这意味着 $\\frac{1}{x} = \\frac{1}{y}$，即 $x = y$。考虑到问题的对称性，这个结果是意料之中的。将 $y=x$ 代入方程(1)：\n$$\n1 - \\frac{\\mu}{x} + \\frac{\\mu}{1 - 2x} = 0\n$$\n为了解出 $x$，我们重排方程：\n$$\n1 = \\frac{\\mu}{x} - \\frac{\\mu}{1 - 2x} = \\frac{\\mu(1 - 2x) - \\mu x}{x(1 - 2x)} = \\frac{\\mu(1 - 3x)}{x(1 - 2x)}\n$$\n这导出了一个二次方程：\n$$\nx(1 - 2x) = \\mu(1 - 3x) \\implies x - 2x^2 = \\mu - 3\\mu x\n$$\n$$\n2x^2 - (1 + 3\\mu)x + \\mu = 0\n$$\n使用二次方程求根公式，$x$ 的解为：\n$$\nx = \\frac{(1 + 3\\mu) \\pm \\sqrt{(1 + 3\\mu)^2 - 4(2)\\mu}}{2(2)} = \\frac{1 + 3\\mu \\pm \\sqrt{1 + 6\\mu + 9\\mu^2 - 8\\mu}}{4} = \\frac{1 + 3\\mu \\pm \\sqrt{9\\mu^2 - 2\\mu + 1}}{4}\n$$\n定义域 $\\mathcal{D}$ 要求 $x  0$，$y  0$ 且 $x+y  1$。当 $x=y$ 时，这简化为 $x  0$ 和 $2x  1$，即 $0  x  \\frac{1}{2}$。我们必须选择位于此区间内的根。\n我们来分析这两个根。对于 $\\mu  0$，我们有 $\\sqrt{9\\mu^2 - 2\\mu + 1}  \\sqrt{9\\mu^2 - 6\\mu + 1} = \\sqrt{(3\\mu-1)^2} = |3\\mu-1|$。对于 $\\mu \\in (0, 1/3)$，这等于 $1-3\\mu$。\n带加号的根是 $x_+ = \\frac{1 + 3\\mu + \\sqrt{9\\mu^2 - 2\\mu + 1}}{4}$。对于 $\\mu \\in (0, 1/3)$，$x_+  \\frac{1+3\\mu + (1-3\\mu)}{4} = \\frac{2}{4} = \\frac{1}{2}$。这个根不在要求区间内。\n带减号的根是 $x_- = \\frac{1 + 3\\mu - \\sqrt{9\\mu^2 - 2\\mu + 1}}{4}$。我们检查它的界限。由于对于 $\\mu0$，$1+3\\mu  \\sqrt{(1+3\\mu)^2} = \\sqrt{9\\mu^2+6\\mu+1}  \\sqrt{9\\mu^2-2\\mu+1}$，分子为正，所以 $x_-0$。如上所述，$x_-$ 也小于 $1/2$。因此，这是正确的解。\n所以，唯一的最小值点是 $(x_{\\mu}, y_{\\mu})$，其中 $x_{\\mu} = y_{\\mu} = \\frac{1 + 3\\mu - \\sqrt{9\\mu^2 - 2\\mu + 1}}{4}$。\n为了得到一个更方便的形式，我们可以对分子进行有理化：\n$$\nx_{\\mu} = \\frac{(1 + 3\\mu - \\sqrt{9\\mu^2 - 2\\mu + 1})(1 + 3\\mu + \\sqrt{9\\mu^2 - 2\\mu + 1})}{4(1 + 3\\mu + \\sqrt{9\\mu^2 - 2\\mu + 1})}\n$$\n$$\nx_{\\mu} = \\frac{(1+3\\mu)^2 - (9\\mu^2 - 2\\mu + 1)}{4(1 + 3\\mu + \\sqrt{9\\mu^2 - 2\\mu + 1})} = \\frac{1+6\\mu+9\\mu^2 - 9\\mu^2 + 2\\mu - 1}{4(1 + 3\\mu + \\sqrt{9\\mu^2 - 2\\mu + 1})}\n$$\n$$\nx_{\\mu} = \\frac{8\\mu}{4(1 + 3\\mu + \\sqrt{9\\mu^2 - 2\\mu + 1})} = \\frac{2\\mu}{1 + 3\\mu + \\sqrt{9\\mu^2 - 2\\mu + 1}}\n$$\n因此，唯一的最小值点是 $(x_{\\mu}, y_{\\mu})$，其中 $x_{\\mu} = y_{\\mu} = \\frac{2\\mu}{1 + 3\\mu + \\sqrt{9\\mu^2 - 2\\mu + 1}}$。\n\n最后，我们找出原问题的最优解并验证极限。原问题是在可行集上最小化 $f(x,y)=x+y$，该可行集是一个顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$ 的三角形。由于 $x \\ge 0$ 且 $y \\ge 0$，$x+y$ 的最小值为 $0$，在点 $(x^{\\star}, y^{\\star}) = (0,0)$ 唯一达到。\n现在我们取解在 $\\mu \\to 0^+$ 时的极限：\n$$\n\\lim_{\\mu \\to 0^+} x_{\\mu} = \\lim_{\\mu \\to 0^+} \\frac{2\\mu}{1 + 3\\mu + \\sqrt{9\\mu^2 - 2\\mu + 1}} = \\frac{2(0)}{1 + 3(0) + \\sqrt{9(0)^2 - 2(0) + 1}} = \\frac{0}{1+1} = 0\n$$\n由于 $y_{\\mu} = x_{\\mu}$，我们也有 $\\lim_{\\mu \\to 0^+} y_{\\mu} = 0$。因此，$\\lim_{\\mu \\to 0^+} (x_{\\mu}, y_{\\mu}) = (0,0) = (x^{\\star}, y^{\\star})$，这验证了中心路径收敛到原问题的最优解。\n\n问题要求给出唯一最小值点 $(x_{\\mu}, y_{\\mu})$ 的闭式表达式。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2\\mu}{1 + 3\\mu + \\sqrt{9\\mu^2 - 2\\mu + 1}}  \\frac{2\\mu}{1 + 3\\mu + \\sqrt{9\\mu^2 - 2\\mu + 1}} \\end{pmatrix}}\n$$", "id": "3145963"}, {"introduction": "在实际应用中，障碍子问题通常使用牛顿法等数值方法求解。此过程中的一个关键挑战是确保每次迭代后的点都严格位于可行域内部。本练习聚焦于内点法算法中的一个核心环节：如何沿着给定的搜索方向，推导出一个能保证严格可行性的最大步长 $\\alpha^{\\star}$ [@problem_id:3145965]。这是构建一个稳健的内点法求解器的基本要素。", "problem": "考虑一个带不等式约束的优化问题，其约束为 $a_i^{\\top} x \\le b_i$，其中 $i \\in \\{1, \\dots, m\\}$，$a_i \\in \\mathbb{R}^{n}$ 且 $b_i \\in \\mathbb{R}$。对数障碍子问题引入了障碍项 $-\\mu \\sum_{i=1}^{m} \\ln\\!\\big(b_i - a_i^{\\top} x\\big)$，其中参数 $\\mu  0$。因此，障碍目标函数的定义域是严格可行域，在该域中，松弛量 $s_i(x) = b_i - a_i^{\\top} x$ 对所有 $i$ 都满足 $s_i(x)  0$。在内点法 (Interior-Point Method, IPM) 中，形式为 $x^{+} = x + \\alpha \\Delta x$ 的牛顿 (Newton) 更新必须保持严格可行性，即对所有 $i$ 都有 $b_i - a_i^{\\top} (x + \\alpha \\Delta x)  0$。\n\n从障碍函数定义域条件和不等式约束出发，通过刻画能使所有松弛量 $b_i - a_i^{\\top} (x + \\alpha \\Delta x)$ 保持正值的 $\\alpha  0$ 集合，推导出一个步长规则，以保证沿牛顿更新方向的严格可行性。然后，将最大可行步长界限 $\\alpha^{\\star}$ 定义为这些 $\\alpha$ 值的上确界，并用 $x$、$\\Delta x$、$\\{a_i\\}_{i=1}^{m}$ 和 $\\{b_i\\}_{i=1}^{m}$ 来表示 $\\alpha^{\\star}$。\n\n最后，根据以下具体数据计算 $\\alpha^{\\star}$：\n- $n = 2$, $m = 3$,\n- $a_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$, $a_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, $a_3 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$,\n- $b_1 = 4$, $b_2 = 3$, $b_3 = 5$,\n- 当前点 $x = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$,\n- 牛顿方向 $\\Delta x = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix}$.\n\n将最终答案以上确界 $\\alpha^{\\star}$ 的精确值（一个实数）形式给出。无需四舍五入。", "solution": "该问题要求推导在内点法中为保持严格可行性而设定的步长 $\\alpha$ 的规则，并针对一个具体实例计算最大可行步长界限 $\\alpha^{\\star}$。\n\n首先，我们对问题陈述进行形式化验证。\n\n**步骤 1：提取已知条件**\n- 不等式约束：$a_i^{\\top} x \\le b_i$，其中 $i \\in \\{1, \\dots, m\\}$，$a_i \\in \\mathbb{R}^{n}$ 且 $b_i \\in \\mathbb{R}$。\n- 障碍项：$-\\mu \\sum_{i=1}^{m} \\ln(b_i - a_i^{\\top} x)$，其中参数 $\\mu  0$。\n- 当前点 $x$ 的严格可行性：对所有 $i$ 都有 $b_i - a_i^{\\top} x  0$。\n- 牛顿更新：$x^{+} = x + \\alpha \\Delta x$。\n- 更新后点 $x^{+}$ 的严格可行性条件：给定 $\\alpha  0$，对所有 $i$ 都有 $b_i - a_i^{\\top} (x + \\alpha \\Delta x)  0$。\n- 目标：推导最大步长界限 $\\alpha^{\\star} = \\sup\\{\\alpha  0 \\mid b_i - a_i^{\\top}(x + \\alpha \\Delta x)  0, \\forall i \\in \\{1, \\dots, m\\}\\}$。\n- 用于计算的具体数据：$n = 2$, $m = 3$；$a_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$, $a_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, $a_3 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$；$b_1 = 4$, $b_2 = 3$, $b_3 = 5$；当前点 $x = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$；牛顿方向 $\\Delta x = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，植根于约束优化的标准内点法理论。问题提法恰当，为获得唯一解提供了所有必要信息。初始点 $x = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 是严格可行的：\n- $b_1 - a_1^{\\top}x = 4 - (1)(1) - (0)(1) = 3  0$。\n- $b_2 - a_2^{\\top}x = 3 - (0)(1) - (1)(1) = 2  0$。\n- $b_3 - a_3^{\\top}x = 5 - (1)(1) - (1)(1) = 3  0$。\n由于初始点满足障碍函数的定义域条件，因此问题设置是一致且完整的。它没有违反任何科学原理，是可数学形式化的，并且是客观的。\n\n**步骤 3：结论与行动**\n问题有效。我们继续求解。\n\n**最大可行步长界限 $\\alpha^{\\star}$ 的推导**\n\n为了使更新后的点 $x^{+} = x + \\alpha \\Delta x$ 保持严格可行，对于每个约束 $i \\in \\{1, \\dots, m\\}$，不等式 $b_i - a_i^{\\top} x^{+}  0$ 必须成立。对于 $\\alpha  0$，我们有：\n$$b_i - a_i^{\\top}(x + \\alpha \\Delta x)  0$$\n根据点积的线性性质，这可以展开为：\n$$b_i - a_i^{\\top}x - \\alpha (a_i^{\\top} \\Delta x)  0$$\n令 $s_i(x) = b_i - a_i^{\\top}x$ 表示在当前点 $x$ 处第 $i$ 个约束的松弛量。根据内点法迭代的前提，对所有 $i$ 都有 $s_i(x)  0$。代入此定义，不等式变为：\n$$s_i(x) - \\alpha (a_i^{\\top} \\Delta x)  0$$\n为了找到 $\\alpha$ 的有效范围，我们根据项 $a_i^{\\top} \\Delta x$ 的符号来分析这个不等式。\n\n情况 1：$a_i^{\\top} \\Delta x \\le 0$。\n在这种情况下，对于任何 $\\alpha  0$，项 $-\\alpha (a_i^{\\top} \\Delta x)$ 是非负的。由于假设 $s_i(x)  0$，不等式 $s_i(x) - \\alpha (a_i^{\\top} \\Delta x) \\ge s_i(x)  0$ 对所有 $\\alpha  0$ 都成立。这意味着如果搜索方向 $\\Delta x$ 平行于或远离第 $i$ 个约束边界，则对于任何正步长，该约束的严格可行性都能保持。因此，这样的约束对 $\\alpha$ 没有施加上界。\n\n情况 2：$a_i^{\\top} \\Delta x  0$。\n这种情况对应于搜索方向指向第 $i$ 个约束边界。我们可以重新整理不等式来求解 $\\alpha$：\n$$s_i(x)  \\alpha (a_i^{\\top} \\Delta x)$$\n$$\\alpha  \\frac{s_i(x)}{a_i^{\\top} \\Delta x}$$\n这对每个满足 $a_i^{\\top} \\Delta x  0$ 的约束 $i$ 确定了 $\\alpha$ 的一个上界。\n\n为确保更新后的点 $x^{+}$ 相对于*所有*约束同时保持严格可行，步长 $\\alpha$ 必须满足这些上界中最严格的一个。因此，$\\alpha$ 必须严格小于所有这些比率的最小值。有效的步长 $\\alpha  0$ 的集合由区间 $(0, \\alpha^{\\star})$ 描述，其中 $\\alpha^{\\star}$ 是该集合的上确界。该上确界由下式给出：\n$$\\alpha^{\\star} = \\min_{i \\,:\\, a_i^{\\top} \\Delta x  0} \\left\\{ \\frac{s_i(x)}{a_i^{\\top} \\Delta x} \\right\\} = \\min_{i \\,:\\, a_i^{\\top} \\Delta x  0} \\left\\{ \\frac{b_i - a_i^{\\top} x}{a_i^{\\top} \\Delta x} \\right\\}$$\n如果集合 $\\{i \\mid a_i^{\\top} \\Delta x  0\\}$ 为空，则没有约束对 $\\alpha$ 施加上界，我们定义 $\\alpha^{\\star} = +\\infty$。\n\n**针对具体数据的计算**\n\n我们现在将此公式应用于所提供的数据：\n- $x = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$, $\\Delta x = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix}$。\n- 约束：$a_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, b_1 = 4$；$a_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, b_2 = 3$；$a_3 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, b_3 = 5$。\n\n对于每个约束 $i \\in \\{1, 2, 3\\}$，我们计算分子 $b_i - a_i^{\\top}x$ 和分母 $a_i^{\\top} \\Delta x$。\n\n约束 $i=1$：\n- 分子：$b_1 - a_1^{\\top}x = 4 - \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = 4 - 1 = 3$。\n- 分母：$a_1^{\\top} \\Delta x = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix} = \\frac{1}{2}$。\n- 由于分母为正 ($a_1^{\\top} \\Delta x = \\frac{1}{2}  0$)，该约束施加了一个界限。比率为 $\\frac{3}{\\frac{1}{2}} = 6$。\n\n约束 $i=2$：\n- 分子：$b_2 - a_2^{\\top}x = 3 - \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = 3 - 1 = 2$。\n- 分母：$a_2^{\\top} \\Delta x = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix} = 1$。\n- 由于分母为正 ($a_2^{\\top} \\Delta x = 1  0$)，该约束施加了一个界限。比率为 $\\frac{2}{1} = 2$。\n\n约束 $i=3$：\n- 分子：$b_3 - a_3^{\\top}x = 5 - \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = 5 - (1+1) = 3$。\n- 分母：$a_3^{\\top} \\Delta x = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix} = \\frac{1}{2} + 1 = \\frac{3}{2}$。\n- 由于分母为正 ($a_3^{\\top} \\Delta x = \\frac{3}{2}  0$)，该约束施加了一个界限。比率为 $\\frac{3}{\\frac{3}{2}} = 2$。\n\n所有三个约束都满足 $a_i^{\\top} \\Delta x  0$。最大可行步长界限 $\\alpha^{\\star}$ 是所计算比率的最小值：\n$$\\alpha^{\\star} = \\min \\{6, 2, 2\\}$$\n$$\\alpha^{\\star} = 2$$\n因此，可行步长集合的上确界是 $2$。", "answer": "$$\\boxed{2}$$", "id": "3145965"}, {"introduction": "在掌握了基本概念和算法细节之后，我们可以探讨一个更深层次的理论问题。当一个线性规划问题的最优解不是单个顶点，而是一个完整的面或边时，中心路径会如何表现？本练习将挑战“最优点必然在角落”的直观感觉，并揭示中心路径会收敛到最优解集的“解析中心” [@problem_id:3145932]。这有助于你更深刻地理解内点法的内在行为。", "problem": "考虑一个双变量线性规划问题，其可行多胞体为盒式约束，且目标函数在多胞体的一个面上是常数。设可行集为\n$$\n\\mathcal{P} \\;=\\; \\{\\, x \\in \\mathbb{R}^2 \\,:\\, 0 \\le x_1 \\le 1,\\; 0 \\le x_2 \\le 1 \\,\\}.\n$$\n考虑最小化线性目标\n$$\n\\min_{x \\in \\mathcal{P}} \\; c^\\top x \\quad \\text{其中} \\quad c = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}.\n$$\n根据不等式约束的对数障碍函数的定义，对于参数 $\\mu  0$，相关的障碍子问题是\n$$\n\\min_{x \\in \\operatorname{int}(\\mathcal{P})} \\; \\varphi_\\mu(x) \\;\\;=\\;\\; c^\\top x \\;-\\; \\mu \\sum_{i=1}^{4} \\log s_i(x),\n$$\n其中不等式约束写作 $s_1(x) = x_1$, $s_2(x) = 1 - x_1$, $s_3(x) = x_2$, $s_4(x) = 1 - x_2$，而 $\\operatorname{int}(\\mathcal{P}) = \\{ x \\in \\mathbb{R}^2 : 0  x_1  1,\\; 0  x_2  1 \\}$ 是严格内部。中心路径是映射 $\\mu \\mapsto x(\\mu)$，其中对每个 $\\mu  0$，$x(\\mu)$ 是 $\\varphi_\\mu(x)$ 的唯一最小化子；中心路径极限是当 $\\mu \\downarrow 0$ 时 $x(\\mu)$ 的任意聚点。\n\n仅使用上述基本定义和平滑无约束最小化在开域 $\\operatorname{int}(\\mathcal{P})$ 上的一阶最优性条件，确定下列哪个陈述正确地指出了中心路径的极限，并解释了为什么它是一个非多胞体顶点的点。\n\nA. 中心路径满足对所有 $\\mu  0$ 都有 $x_2(\\mu) = \\tfrac{1}{2}$，且当 $\\mu \\downarrow 0$ 时 $x_1(\\mu) \\to 0$，因此 $x(\\mu) \\to (0,\\tfrac{1}{2})$，这是最优面 $\\{x \\in \\mathcal{P} : x_1 = 0\\}$ 的解析中心。出现这个非顶点极限的原因是最优集具有正维度（在多重最优解意义下的退化），而不是因为严格互补性失效；事实上，在极限情况下严格互补性是成立的。\n\nB. 中心路径收敛到顶点 $(0,0)$，因为障碍函数会促进角点解，并且严格互补性会迫使所有活动约束在顶点处相交。\n\nC. 当 $\\mu \\downarrow 0$ 时，中心路径没有极限，因为线性目标不是严格凸的，所以障碍子问题没有定义一个收敛的路径。\n\nD. 中心路径的极限点取决于数值算法使用的起始点；不同的初始化会在最优面上产生不同的点。\n\nE. 中心路径收敛到 $(0,1)$，因为沿着最优面，障碍函数会排斥内部，并将解推向与目标方向最一致的角点。", "solution": "用户希望我解决一个关于优化中对数障碍法的问题。\n\n这是一个计划：\n1.  **验证问题陈述**：\n    *   **步骤1：提取已知条件**：我将列出问题中提供的所有定义和方程。\n        *   可行集 $\\mathcal{P} = \\{\\, x \\in \\mathbb{R}^2 \\,:\\, 0 \\le x_1 \\le 1,\\; 0 \\le x_2 \\le 1 \\,\\}$。\n        *   目标函数：$\\min_{x \\in \\mathcal{P}} \\; c^\\top x$ 其中 $c = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n        *   对数障碍子问题：$\\min_{x \\in \\operatorname{int}(\\mathcal{P})} \\; \\varphi_\\mu(x) = c^\\top x - \\mu \\sum_{i=1}^{4} \\log s_i(x)$ 对于 $\\mu  0$。\n        *   不等式约束：$s_1(x) = x_1$, $s_2(x) = 1 - x_1$, $s_3(x) = x_2$, $s_4(x) = 1 - x_2$。\n        *   可行集的内部：$\\operatorname{int}(\\mathcal{P}) = \\{ x \\in \\mathbb{R}^2 : 0  x_1  1,\\; 0  x_2  1 \\}$。\n        *   中心路径：$\\mu \\mapsto x(\\mu)$，其中 $x(\\mu)$ 是 $\\varphi_\\mu(x)$ 的最小化子。\n        *   中心路径极限：当 $\\mu \\downarrow 0$ 时 $x(\\mu)$ 的聚点。\n        *   问题要求确定中心路径的极限并解释为何它是一个非顶点。\n\n    *   **步骤2：使用提取的已知条件进行验证**：\n        *   **科学上是否合理？**是的，这是线性规划内点法理论中的一个标准问题。这个设置是典型的。\n        *   **是否适定？**是的，该问题定义了一个标准的线性规划及其相关的障碍问题。对于 $\\mu  0$，目标函数 $\\varphi_\\mu(x)$ 在 $\\operatorname{int}(\\mathcal{P})$ 上是严格凸的，因此对每个 $\\mu  0$ 都存在一个唯一的最小化子 $x(\\mu)$。问题要求的是这个唯一路径的极限。\n        *   **是否客观？**是的，语言精确且数学化。\n        *   **未检测到缺陷**：该问题在科学上是合理的、适定的、客观的、完整的且非平凡的。这是一个用于说明中心路径行为的教科书式例子。\n    *   **步骤3：结论和行动**：问题是**有效的**。我将继续进行求解。\n\n2.  **解决问题**：\n    *   问题要求使用“光滑无约束最小化在开域 $\\operatorname{int}(\\mathcal{P})$ 上的一阶最优性条件”。这意味着我需要通过将其梯度设置为零来找到 $\\varphi_\\mu(x)$ 的最小化子 $x(\\mu)$。\n    *   首先，写出函数 $\\varphi_\\mu(x)$：\n        $$ \\varphi_\\mu(x) = c^\\top x - \\mu \\sum_{i=1}^{4} \\log s_i(x) $$\n        $$ \\varphi_\\mu(x) = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}^\\top \\begin{bmatrix} x_1 \\\\ x_2 \\end{bmatrix} - \\mu \\left( \\log(x_1) + \\log(1-x_1) + \\log(x_2) + \\log(1-x_2) \\right) $$\n        $$ \\varphi_\\mu(x) = x_1 - \\mu \\log(x_1) - \\mu \\log(1-x_1) - \\mu \\log(x_2) - \\mu \\log(1-x_2) $$\n    *   现在，计算 $\\varphi_\\mu(x)$ 关于 $x = (x_1, x_2)$ 的梯度：\n        $$ \\nabla \\varphi_\\mu(x) = \\begin{bmatrix} \\frac{\\partial \\varphi_\\mu}{\\partial x_1} \\\\ \\frac{\\partial \\varphi_\\mu}{\\partial x_2} \\end{bmatrix} $$\n        $$ \\frac{\\partial \\varphi_\\mu}{\\partial x_1} = 1 - \\mu \\frac{1}{x_1} - \\mu \\frac{-1}{1-x_1} = 1 - \\frac{\\mu}{x_1} + \\frac{\\mu}{1-x_1} $$\n        $$ \\frac{\\partial \\varphi_\\mu}{\\partial x_2} = 0 - \\mu \\frac{1}{x_2} - \\mu \\frac{-1}{1-x_2} = -\\frac{\\mu}{x_2} + \\frac{\\mu}{1-x_2} $$\n    *   将梯度设置为零，以找到 $x(\\mu)$ 的一阶最优性条件：\n        $$ \\nabla \\varphi_\\mu(x(\\mu)) = \\mathbf{0} $$\n        这给出了一个关于 $x_1(\\mu)$ 和 $x_2(\\mu)$ 的方程组：\n        1.  $1 - \\frac{\\mu}{x_1(\\mu)} + \\frac{\\mu}{1-x_1(\\mu)} = 0$\n        2.  $-\\frac{\\mu}{x_2(\\mu)} + \\frac{\\mu}{1-x_2(\\mu)} = 0$\n    *   解这个方程组。\n        *   让我们从方程(2)开始。因为 $\\mu  0$，我们可以除以 $-\\mu$：\n            $$ \\frac{1}{x_2(\\mu)} - \\frac{1}{1-x_2(\\mu)} = 0 $$\n            $$ \\frac{1}{x_2(\\mu)} = \\frac{1}{1-x_2(\\mu)} $$\n            $$ 1 - x_2(\\mu) = x_2(\\mu) $$\n            $$ 1 = 2 x_2(\\mu) $$\n            $$ x_2(\\mu) = \\frac{1}{2} $$\n            这对所有 $\\mu  0$ 都成立。中心路径的 $x_2$ 分量是常数。这在物理上是合理的：目标函数 $c^\\top x = x_1$ 与 $x_2$ 无关。$x_2$ 的障碍函数围绕 $x_2 = 1/2$ 是对称的，即 $-\\mu(\\log(x_2) + \\log(1-x_2))$。这个对称障碍项的最小值恰好在区间 $[0,1]$ 的中心，即 $1/2$。由于目标函数在 $x_2$ 方向上没有“拉力”，最小化子将位于 $x_2$ 区间的中心。\n\n        *   现在求解方程(1)以得到 $x_1(\\mu)$：\n            $$ 1 = \\frac{\\mu}{x_1(\\mu)} - \\frac{\\mu}{1-x_1(\\mu)} $$\n            $$ 1 = \\mu \\left( \\frac{(1-x_1(\\mu)) - x_1(\\mu)}{x_1(\\mu)(1-x_1(\\mu))} \\right) $$\n            $$ 1 = \\mu \\frac{1 - 2x_1(\\mu)}{x_1(\\mu) - x_1(\\mu)^2} $$\n            $$ x_1(\\mu) - x_1(\\mu)^2 = \\mu(1 - 2x_1(\\mu)) $$\n            $$ x_1(\\mu)^2 - x_1(\\mu) + \\mu(1 - 2x_1(\\mu)) = 0 $$\n            $$ x_1(\\mu)^2 - (1 + 2\\mu) x_1(\\mu) + \\mu = 0 $$\n            这是关于 $x_1(\\mu)$ 的一个二次方程。我们使用二次公式来求解 $x_1(\\mu)$：\n            $$ x_1(\\mu) = \\frac{-(-(1+2\\mu)) \\pm \\sqrt{(-(1+2\\mu))^2 - 4(1)(\\mu)}}{2(1)} $$\n            $$ x_1(\\mu) = \\frac{1+2\\mu \\pm \\sqrt{1 + 4\\mu + 4\\mu^2 - 4\\mu}}{2} $$\n            $$ x_1(\\mu) = \\frac{1+2\\mu \\pm \\sqrt{1 + 4\\mu^2}}{2} $$\n            由于 $x_1(\\mu)$ 必须在区间 $(0, 1)$ 内，我们需要选择正确的符号。\n            让我们分析两个可能的解：\n            *   $x_1^{(+)} = \\frac{1+2\\mu + \\sqrt{1 + 4\\mu^2}}{2}$。对于 $\\mu  0$，$\\sqrt{1+4\\mu^2}  \\sqrt{1} = 1$。所以，$1+2\\mu+\\sqrt{1+4\\mu^2}  1+2\\mu+1 = 2+2\\mu  2$。因此，$x_1^{(+)}  \\frac{2+2\\mu}{2} = 1+\\mu  1$。这个解在可行域 $\\operatorname{int}(\\mathcal{P})$ 之外。\n            *   $x_1^{(-)} = \\frac{1+2\\mu - \\sqrt{1 + 4\\mu^2}}{2}$。对于 $\\mu  0$，我们有 $1  \\sqrt{1+4\\mu^2}$。此外，$(1+2\\mu)^2 = 1+4\\mu+4\\mu^2  1+4\\mu^2$，这意味着 $\\sqrt{1+4\\mu^2}  1+2\\mu$。因此，$1+2\\mu - (1+2\\mu)  1+2\\mu - \\sqrt{1+4\\mu^2}  1+2\\mu - 1$，简化为 $0  1+2\\mu - \\sqrt{1+4\\mu^2}  2\\mu$。除以 $2$ 得，$0  x_1^{(-)}  \\mu$。由于 $\\mu$ 通常很小且我们关心的是 $\\mu \\to 0$，这个解是有效的，因为它位于 $(0,1)$ 内。因此，这是正确的根。\n            $$ x_1(\\mu) = \\frac{1+2\\mu - \\sqrt{1 + 4\\mu^2}}{2} $$\n\n    *   现在，我们确定当 $\\mu \\downarrow 0$ 时中心路径 $x(\\mu) = (x_1(\\mu), x_2(\\mu))$ 的极限。\n        *   我们已经确定对所有 $\\mu  0$ 都有 $x_2(\\mu) = 1/2$，所以 $\\lim_{\\mu \\downarrow 0} x_2(\\mu) = 1/2$。\n        *   对于 $x_1(\\mu)$，我们取极限：\n            $$ \\lim_{\\mu \\downarrow 0} x_1(\\mu) = \\lim_{\\mu \\downarrow 0} \\frac{1+2\\mu - \\sqrt{1 + 4\\mu^2}}{2} = \\frac{1+2(0) - \\sqrt{1 + 4(0)^2}}{2} = \\frac{1-1}{2} = 0 $$\n    *   综合结果，中心路径的极限是：\n        $$ x^* = \\lim_{\\mu \\downarrow 0} x(\\mu) = \\left( \\lim_{\\mu \\downarrow 0} x_1(\\mu), \\lim_{\\mu \\downarrow 0} x_2(\\mu) \\right) = \\left(0, \\frac{1}{2}\\right) $$\n    *   这个极限点 $x^* = (0, 1/2)$ 不是多胞体 $\\mathcal{P}$ 的顶点，其顶点为 $(0,0), (1,0), (1,1)$ 和 $(0,1)$。\n    *   原始线性规划 $\\min \\{x_1 : 0 \\le x_1 \\le 1, 0 \\le x_2 \\le 1\\}$ 的最优解集是 $x_1$ 达到其最小值0的点集。该集合是线段 $\\{x \\in \\mathbb{R}^2 : x_1 = 0, 0 \\le x_2 \\le 1\\}$，即单位正方形的左侧面。这个最优集维度为1，这是非唯一最优解的情况。\n    *   中心路径的极限点 $(0, 1/2)$ 是这个最优面的解析中心。一维多胞体 $\\{x_2 : 0 \\le x_2 \\le 1\\}$ 的解析中心是使 $-\\log(x_2)-\\log(1-x_2)$ 最小化的点，即 $x_2=1/2$。\n    *   现在我们检验极限处的严格互补性条件。极限点对 $(x^*, y^*)$ 必须满足Karush-Kuhn-Tucker (KKT) 条件。与中心路径相关的对偶变量是 $y_i(\\mu) = \\mu/s_i(x(\\mu))$。我们求它们在 $\\mu \\downarrow 0$ 时的极限。\n        *   $x(\\mu) = (x_1(\\mu), 1/2)$，其中对于小的 $\\mu$，$x_1(\\mu) \\approx \\mu$。\n        *   $s_1(x(\\mu)) = x_1(\\mu) \\approx \\mu$。\n        *   $s_2(x(\\mu)) = 1-x_1(\\mu) \\approx 1-\\mu$。\n        *   $s_3(x(\\mu)) = x_2(\\mu) = 1/2$。\n        *   $s_4(x(\\mu)) = 1-x_2(\\mu) = 1/2$。\n        对偶变量的极限是：\n        *   $y_1^* = \\lim_{\\mu \\downarrow 0} y_1(\\mu) = \\lim_{\\mu \\downarrow 0} \\frac{\\mu}{s_1(x(\\mu))} = \\lim_{\\mu \\downarrow 0} \\frac{\\mu}{\\mu - \\mu^2 + O(\\mu^3)} = 1$。\n        *   $y_2^* = \\lim_{\\mu \\downarrow 0} y_2(\\mu) = \\lim_{\\mu \\downarrow 0} \\frac{\\mu}{s_2(x(\\mu))} = \\lim_{\\mu \\downarrow 0} \\frac{\\mu}{1-\\mu} = 0$。\n        *   $y_3^* = \\lim_{\\mu \\downarrow 0} y_3(\\mu) = \\lim_{\\mu \\downarrow 0} \\frac{\\mu}{s_3(x(\\mu))} = \\lim_{\\mu \\downarrow 0} \\frac{\\mu}{1/2} = 0$。\n        *   $y_4^* = \\lim_{\\mu \\downarrow 0} y_4(\\mu) = \\lim_{\\mu \\downarrow 0} \\frac{\\mu}{s_4(x(\\mu))} = \\lim_{\\mu \\downarrow 0} \\frac{\\mu}{1/2} = 0$。\n        因此，极限对偶解是 $y^* = (1, 0, 0, 0)$。在原始极限 $x^*=(0,1/2)$ 处的松弛变量是 $s(x^*) = (0, 1, 1/2, 1/2)$。\n        严格互补性要求对每个 $i$，$y_i^* + s_i(x^*)  0$。\n        *   $i=1: y_1^*+s_1(x^*) = 1+0=1  0$。\n        *   $i=2: y_2^*+s_2(x^*) = 0+1=1  0$。\n        *   $i=3: y_3^*+s_3(x^*) = 0+1/2=1/2  0$。\n        *   $i=4: y_4^*+s_4(x^*) = 0+1/2=1/2  0$。\n        在极限情况下严格互补性成立。\n\n评估选项：\nA. 正确。我们的推导证实了这个陈述的每一部分。路径收敛到 $(0, 1/2)$，这是最优面的解析中心。原因是正维度的最优集。我们的分析也证明了严格互补性成立。\n\nB. 不正确。极限是 $(0, 1/2)$，不是 $(0,0)$。障碍函数将解保持在内部，它不“促进角点解”。如此问题所示，严格互补性并不要求解是顶点。\n\nC. 不正确。中心路径有一个明确的极限 $(0, 1/2)$。对于任何 $\\mu  0$，障碍子问题的目标函数 $\\varphi_\\mu(x)$ 都是严格凸的，因为对数障碍项的海森矩阵是正定的，确保了对每个 $\\mu  0$ 都有唯一的最小化子 $x(\\mu)$，从而有唯一的中心路径。\n\nD. 不正确。中心路径是一个理论构造，由 $\\varphi_\\mu(x)$ 的最小化子唯一确定。它不依赖于数值算法或起始点。这个陈述将理论路径与实际算法的轨迹混淆了。\n\nE. 不正确。极限是 $(0, 1/2)$，不是 $(0,1)$。$x_2$ 的障碍项，即 $-\\mu(\\log(x_2)+\\log(1-x_2))$，是对称的，其影响将解沿着最优面中心化在 $x_2=1/2$ 处，因为目标函数在 $x_2$ 方向上没有分量。没有向角点推动的力。", "answer": "$$\n\\boxed{A}\n$$", "id": "3145932"}]}