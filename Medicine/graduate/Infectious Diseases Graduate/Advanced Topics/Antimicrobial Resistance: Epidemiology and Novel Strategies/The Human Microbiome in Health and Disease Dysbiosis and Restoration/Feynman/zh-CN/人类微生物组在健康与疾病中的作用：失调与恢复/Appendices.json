{
    "hands_on_practices": [
        {
            "introduction": "量化微生物群落的状态是理解其在健康与疾病中作用的第一步。香农熵（Shannon entropy）是生态学中一个基础且强大的工具，它通过综合考量群落中物种的丰富度（richness）和均匀度（evenness）来衡量其$\\alpha$-多样性。在艰难梭菌感染（CDI）等菌群失调状态下，群落多样性通常会显著下降。本练习将引导你从信息论的第一性原理出发，推导并计算健康和患病状态下肠道菌群的香农熵，从而定量地评估菌群失调对多样性的影响。",
            "id": "4698853",
            "problem": "一名因复发性艰难梭菌感染 (CDI) 而住院的患者表现出抗生素相关菌群失调。鸟枪法宏基因组学分析解析出该患者肠道菌群中的六个主要功能群，其相对丰度之和为1。在一名匹配的健康对照者中，这六个功能群的分布更为均匀。设健康分布为 $p^{H} = (0.28, 0.22, 0.18, 0.12, 0.12, 0.08)$，患病分布为 $p^{D} = (0.55, 0.10, 0.09, 0.08, 0.10, 0.08)$。利用信息论的基本公理（连续性、置换下的对称性、可扩张性以及独立划分的复合律）和标准的自然对数选择，推导离散分布下群落熵的适当表达式，并计算 $p^{H}$ 和 $p^{D}$ 的熵值。然后计算绝对差值 $\\Delta H = H(p^{H}) - H(p^{D})$，单位为自然对数单位（奈特）。将最终数值答案四舍五入至 $4$ 位有效数字。在推理中，结合感染性疾病中人体微生物组的框架，简要解释计算出的值如何反映健康与患病状态下多样性和均匀度的差异。",
            "solution": "该问题要求基于信息论原理计算两个微生物群落分布的香农熵，并解释结果。这是一个在微生物生态学中应用完善的数学框架，问题陈述清晰，数据充分，因此是有效的。\n\n**1. 原理与公式**\n香农熵（Shannon Entropy）$H$ 是衡量一个离散概率分布 $p = (p_1, p_2, \\dots, p_D)$ 不确定性或多样性的指标。其公式为：\n$$ H(p) = -\\sum_{i=1}^{D} p_i \\ln(p_i) $$\n其中 $\\ln$ 是自然对数，熵的单位是“奈特”（nats）。熵值越高，表示群落的物种分布越均匀，多样性越高。\n\n**2. 计算健康对照组的熵 $H(p^H)$**\n健康分布为 $p^{H} = (0.28, 0.22, 0.18, 0.12, 0.12, 0.08)$。\n$$ H(p^H) = - \\left[ 0.28\\ln(0.28) + 0.22\\ln(0.22) + 0.18\\ln(0.18) + 2 \\times (0.12\\ln(0.12)) + 0.08\\ln(0.08) \\right] $$\n计算各项：\n- $0.28\\ln(0.28) \\approx -0.35643$\n- $0.22\\ln(0.22) \\approx -0.33311$\n- $0.18\\ln(0.18) \\approx -0.30866$\n- $2 \\times 0.12\\ln(0.12) \\approx -0.50886$\n- $0.08\\ln(0.08) \\approx -0.20206$\n\n$$ H(p^H) \\approx - [ -0.35643 - 0.33311 - 0.30866 - 0.50886 - 0.20206 ] = -(-1.70912) = 1.70912 \\text{ 奈特} $$\n\n**3. 计算患病组的熵 $H(p^D)$**\n患病分布为 $p^{D} = (0.55, 0.10, 0.09, 0.08, 0.10, 0.08)$。为方便计算，可以重新排列为 $p^{D} = (0.55, 0.10, 0.10, 0.09, 0.08, 0.08)$。\n$$ H(p^D) = - \\left[ 0.55\\ln(0.55) + 2 \\times (0.10\\ln(0.10)) + 0.09\\ln(0.09) + 2 \\times (0.08\\ln(0.08)) \\right] $$\n计算各项：\n- $0.55\\ln(0.55) \\approx -0.32881$\n- $2 \\times 0.10\\ln(0.10) \\approx -0.46052$\n- $0.09\\ln(0.09) \\approx -0.21672$\n- $2 \\times 0.08\\ln(0.08) \\approx -0.40412$\n\n$$ H(p^D) \\approx - [ -0.32881 - 0.46052 - 0.21672 - 0.40412 ] = -(-1.41017) = 1.41017 \\text{ 奈特} $$\n\n**4. 计算熵的绝对差值 $\\Delta H$**\n$$ \\Delta H = H(p^H) - H(p^D) \\approx 1.70912 - 1.41017 = 0.29895 $$\n根据题目要求，将结果四舍五入到4位有效数字，得到 $0.2990$。\n\n**5. 解释**\n计算结果显示，健康对照组的香农熵 $H(p^H) \\approx 1.71$ 奈特，而CDI患者的熵 $H(p^D) \\approx 1.41$ 奈特。熵值的降低 $(\\Delta H \\approx 0.2990 \\text{ 奈特})$ 定量地表明了患者肠道菌群多样性的丧失。具体来说，这反映了菌群均匀度（evenness）的显著下降：在患病状态下，一个功能群（丰度为0.55）占据了主导地位，而其他功能群的相对丰度则被压制。这种由少数物种主导的低多样性、低均匀度群落结构，是菌群失调的典型特征，通常意味着生态系统不稳定，对病原体（如艰难梭菌）的定植抗性减弱。",
            "answer": "$$\\boxed{0.2990}$$"
        },
        {
            "introduction": "比较不同微生物群落样本（例如，治疗前后）是评估干预措施效果的关键，但这面临着独特的分析挑战。测序数据是相对丰度数据，其总和固定的“成分性”（compositional）特征使得传统的欧氏距离等度量方法会产生误导性结果。本练习将介绍专为成分数据设计的Aitchison距离，它通过对数比值变换将数据映射到合适的几何空间中进行分析。你将亲手计算两个样本间的Aitchison距离，并理解为何这种方法能够克服成分数据的内在约束，为评估菌群失调和恢复提供一个更科学的度量。",
            "id": "4698813",
            "problem": "一名因严重抗生素相关性腹泻而住院的成年人，被评估为肠道菌群失调，并随后接受了粪便微生物群移植（FMT）。对两个粪便样本进行了鸟枪法宏基因组测序：一个在抗生素治疗前即刻采集，另一个在FMT后三周采集。对于五个优势菌属，其测序读数计数向量如下：\n- 抗生素治疗前样本：$\\big(3200,\\ 800,\\ 400,\\ 1600,\\ 1000\\big)$，对应菌属为 $\\big(\\text{Bacteroides},\\ \\text{Prevotella},\\ \\text{Faecalibacterium},\\ \\text{Escherichia},\\ \\text{Clostridium}\\big)$。\n- FMT后样本：$\\big(1600,\\ 2400,\\ 1200,\\ 400,\\ 800\\big)$，对应分类单元和顺序同上。\n\n请仅使用适用于传染病背景下微生物组相对丰度数据的组分数据分析基本原理：\n1. 通过将每个样本的计数除以该样本的总计数，将计数转换为组分，使得每个组分都是一个比例，并且该组分数据位于单纯形上（即，各组分之和为 $1$）。\n2. 使用自然对数 $\\ln$，通过将每个组分除以该样本中所有组分的几何平均值，然后取 $\\ln$，将每个组分映射到中心对数比坐标。\n3. 计算两个样本之间的Aitchison距离，该距离为它们的中心对数比坐标向量之间的欧几里得距离。\n\n请基于组分数据的闭合特性和尺度不变性，解释为什么Aitchison几何和中心对数比变换能够为微生物组失调和恢复提供一个科学上合适的度量，而不是在原始比例上使用朴素的欧几里得距离。\n\n将最终距离表示为无量纲量，并将答案四舍五入至四位有效数字。",
            "solution": "该问题经评估有效。它在科学上基于应用于微生物组研究的组分数据分析的既定原则，问题陈述清晰，信息充分且一致，并以客观、正式的语言表达。因此，我们可以着手求解。\n\n问题要求计算两个微生物组样本之间的Aitchison距离，并解释该方法的科学合理性。所提供的数据是来自两个样本（抗生素治疗前和FMT后）的 $5$ 个优势菌属的测序读数计数向量。\n\n设抗生素治疗前样本的计数向量为 $C_1$，FMT后样本的计数向量为 $C_2$。组分（菌属）数量为 $D=5$。\n向量给定如下：\n$C_1 = \\big(3200, 800, 400, 1600, 1000\\big)$\n$C_2 = \\big(1600, 2400, 1200, 400, 800\\big)$\n\n问题陈述概述了一个三步过程：\n1. 将计数转换为组分（比例）。\n2. 应用中心对数比（CLR）变换。\n3. 计算CLR变换后向量之间的欧几里得距离作为Aitchison距离。\n\nCLR变换的一个关键特性是其尺度不变性。计数向量 $C = (c_1, c_2, \\ldots, c_D)$ 的CLR变换与其对应的组分向量 $X = (x_1, x_2, \\ldots, x_D)$（其中 $x_i = c_i / \\sum_j c_j$）的CLR变换是相同的。这是因为对于任何缩放因子 $k > 0$：\n$$ \\text{clr}(kC)_i = \\ln\\left(\\frac{k c_i}{g(kC)}\\right) = \\ln\\left(\\frac{k c_i}{k \\cdot g(C)}\\right) = \\ln\\left(\\frac{c_i}{g(C)}\\right) = \\text{clr}(C)_i $$\n其中 $g(C)$ 是 $C$ 各组分的几何平均值。此特性允许我们绕过显式转换为比例的步骤，直接对原始计数向量应用CLR变换，从而简化计算。\n\n两个样本之间的Aitchison距离 $d_A$ 定义为它们经过CLR变换后的向量之差的欧几里得范数：\n$$ d_A(C_1, C_2) = \\left\\| \\text{clr}(C_1) - \\text{clr}(C_2) \\right\\|_2 = \\sqrt{\\sum_{i=1}^{D} \\left( \\text{clr}(C_1)_i - \\text{clr}(C_2)_i \\right)^2} $$\n差向量的第 $i$ 个分量是：\n$$ \\text{clr}(C_1)_i - \\text{clr}(C_2)_i = \\ln\\left(\\frac{c_{1,i}}{g(C_1)}\\right) - \\ln\\left(\\frac{c_{2,i}}{g(C_2)}\\right) = \\ln\\left(\\frac{c_{1,i}}{c_{2,i}}\\right) - \\ln\\left(\\frac{g(C_1)}{g(C_2)}\\right) $$\n我们定义一个计数对数比向量 $Z$，其分量为 $z_i = \\ln(c_{1,i} / c_{2,i})$。可以证明，项 $\\ln(g(C_1)/g(C_2))$ 是 $z_i$ 分量的算术平均值：\n$$ \\ln\\left(\\frac{g(C_1)}{g(C_2)}\\right) = \\ln(g(C_1)) - \\ln(g(C_2)) = \\frac{1}{D}\\sum_{j=1}^{D}\\ln(c_{1,j}) - \\frac{1}{D}\\sum_{j=1}^{D}\\ln(c_{2,j}) = \\frac{1}{D}\\sum_{j=1}^{D}\\ln\\left(\\frac{c_{1,j}}{c_{2,j}}\\right) = \\bar{z} $$\n因此，差向量就是 $z_i - \\bar{z}$。Aitchison距离的平方是这些中心化值的平方和：\n$$ d_A^2 = \\sum_{i=1}^{D} (z_i - \\bar{z})^2 $$\n我们现在计算这个量。首先，我们求出比率 $r_i = c_{1,i} / c_{2,i}$：\n$r_1 = 3200 / 1600 = 2$\n$r_2 = 800 / 2400 = 1/3$\n$r_3 = 400 / 1200 = 1/3$\n$r_4 = 1600 / 400 = 4$\n$r_5 = 1000 / 800 = 1.25$\n\n接下来，我们对这些比率取自然对数，得到分量 $z_i$：\n$z_1 = \\ln(2) \\approx 0.69315$\n$z_2 = \\ln(1/3) = -\\ln(3) \\approx -1.09861$\n$z_3 = \\ln(1/3) = -\\ln(3) \\approx -1.09861$\n$z_4 = \\ln(4) = 2\\ln(2) \\approx 1.38629$\n$z_5 = \\ln(1.25) \\approx 0.22314$\n\n现在我们计算算术平均值 $\\bar{z}$：\n$$ \\bar{z} = \\frac{1}{5} \\sum_{i=1}^{5} z_i = \\frac{1}{5} (\\ln(2) - \\ln(3) - \\ln(3) + \\ln(4) + \\ln(1.25)) $$\n$$ \\bar{z} = \\frac{1}{5} \\ln\\left( \\frac{2 \\cdot 4 \\cdot 1.25}{3 \\cdot 3} \\right) = \\frac{1}{5} \\ln\\left( \\frac{10}{9} \\right) \\approx \\frac{1}{5}(0.10536) \\approx 0.02107 $$\n现在我们计算各项 $(z_i - \\bar{z})$：\n$z_1 - \\bar{z} \\approx 0.69315 - 0.02107 = 0.67208$\n$z_2 - \\bar{z} \\approx -1.09861 - 0.02107 = -1.11968$\n$z_3 - \\bar{z} \\approx -1.09861 - 0.02107 = -1.11968$\n$z_4 - \\bar{z} \\approx 1.38629 - 0.02107 = 1.36522$\n$z_5 - \\bar{z} \\approx 0.22314 - 0.02107 = 0.20207$\n\n最后，我们通过对这些值的平方求和来计算Aitchison距离的平方：\n$$ d_A^2 \\approx (0.67208)^2 + (-1.11968)^2 + (-1.11968)^2 + (1.36522)^2 + (0.20207)^2 $$\n$$ d_A^2 \\approx 0.45169 + 1.25368 + 1.25368 + 1.86383 + 0.04083 \\approx 4.86371 $$\nAitchison距离是该值的平方根：\n$$ d_A = \\sqrt{4.86371} \\approx 2.20538 $$\n四舍五入到四位有效数字，距离为 $2.205$。\n\n关于此度量衡科学合理性的解释如下。微生物组测序数据是组分数据，这意味着对每个分类单元的测量是样本内的相对丰度，而不是绝对计数。总读数（测序深度）是测序过程中的一个技术性人为因素，并不反映总微生物负荷。因此，一个科学上有效的度量必须对这个总和不敏感，这一特性被称为尺度不变性。在原始比例（$x_i = c_i / \\sum c_j$）上计算的朴素欧几里得距离不具有有意义的尺度不变性，并且会受到与`闭合`特性（即比例之和必须为 $1$）相关的统计问题的影响。这种单位和约束会在组分之间引入伪负相关，使得真实空间的标准欧几里得几何不适用于组分所在的单纯形。\n\nAitchison几何解决了这些问题。其基本见解是，组分数据中的相关信息包含在各组分的对数比中（例如 $x_i/x_j$）。中心对数比（CLR）变换通过将组分数据从受约束的单纯形映射到无约束的实向量空间来`打开`单纯形。如计算中所示，这种变换（以及由此产生的Aitchison距离）本质上是尺度不变的：无论应用于原始计数还是比例，它都会产生相同的结果。通过分析对数比，Aitchison框架恰当地处理了数据的相对性，并消除了闭合约束所带来的人为因素。Aitchison距离就是在这个有效的、变换后的空间中的标准欧几里得距离。这使其成为一个稳健且理论上合理的度量，用于量化微生物群落结构之间的变化程度，例如从菌群失调状态转变为FMT后恢复的状态。",
            "answer": "$$ \\boxed{2.205} $$"
        },
        {
            "introduction": "超越描述性统计，我们可以使用数学模型来探索驱动群落结构和稳定性的潜在生态学机制。Lotka-Volterra竞争模型是理论生态学中的经典框架，可用于模拟物种间的相互作用。在本练习中，你将运用该模型来分析一个关键的微生物组功能——定植抗性（colonization resistance）。通过推导病原体入侵一个已建立的共生菌群落所需满足的条件，你将从数学上理解一个健康的微生物群落是如何阻止外来病原体成功定植的。",
            "id": "4698835",
            "problem": "一种病原体试图在一种能赋予定植抗性的优势共生菌存在的情况下，在人体肠道中定植。假设环境充分混合，两种物种都以恒定速率经历宿主介导的清除。使用带有统一清除项的竞争修正逻辑斯谛框架对动力学进行建模，如下所示。令 $C(t)$ 表示共生菌的丰度，$P(t)$ 表示病原体的丰度。共生菌遵循\n$$\n\\frac{dC}{dt} \\;=\\; r_{C}\\,C\\left(1 - \\frac{C + \\alpha_{CP} P}{K_{C}}\\right) \\;-\\; \\delta\\,C,\n$$\n病原体遵循\n$$\n\\frac{dP}{dt} \\;=\\; r_{P}\\,P\\left(1 - \\frac{P + \\alpha_{PC} C}{K_{P}}\\right) \\;-\\; \\delta\\,P,\n$$\n其中 $r_{C}$ 和 $r_{P}$ 是内禀人均增长率，$K_{C}$ 和 $K_{P}$ 是在共享资源环境中的环境承载力，$\\alpha_{CP}$ 和 $\\alpha_{PC}$ 是种间竞争系数（无量纲），用于描述资源重叠和拮抗作用（值越大表示竞争影响越强），$\\delta$ 是宿主因素导致的人均清除率（单位：每天）。假设病原体以极低的丰度引入，因此初始时 $P$ 是稀少的。在没有病原体的情况下，共生菌已经建立了一个稳定的单物种平衡。\n\n从这些定义和模型方程出发，根据第一性原理推导稀有病原体的入侵条件，并根据给定的参数值计算入侵和持续存在所需的最小内禀病原体增长率 $r_{P}^{\\min}$\n$$\nr_{C} \\;=\\; 1.6 \\;\\text{每天}, \\quad K_{C} \\;=\\; 1.0, \\quad K_{P} \\;=\\; 0.8, \\quad \\alpha_{PC} \\;=\\; 0.75, \\quad \\delta \\;=\\; 0.4 \\;\\text{每天}。\n$$\n假设共生菌的平衡是在没有病原体的情况下确定的。将最终数值答案四舍五入到四位有效数字。以每天为单位表示最终答案。",
            "solution": "该问题是有效的，它应用了生态学中一个标准且稳健的框架（Lotka-Volterra 竞争模型）来研究微生物定植抗性。所有必要的参数都已提供。\n\n**1. 求解共生菌的平衡丰度 ($C^*$)**\n在病原体入侵之前，系统只包含共生菌，且处于平衡状态。这意味着 $P=0$ 且 $\\frac{dC}{dt}=0$。共生菌的动力学方程简化为：\n$$\n\\frac{dC}{dt} \\;=\\; r_{C}\\,C\\left(1 - \\frac{C}{K_{C}}\\right) \\;-\\; \\delta\\,C\n$$\n设平衡丰度为 $C^*$，且 $C^* \\neq 0$（非灭绝平衡），我们可以用 $C^*$ 除以方程两边：\n$$\n0 \\;=\\; r_{C}\\left(1 - \\frac{C^*}{K_{C}}\\right) \\;-\\; \\delta\n$$\n整理以求解 $C^*$：\n$$\n\\delta \\;=\\; r_{C} - \\frac{r_{C}C^*}{K_{C}} \\implies \\frac{r_{C}C^*}{K_{C}} \\;=\\; r_C - \\delta \\implies C^* \\;=\\; K_{C}\\left(1 - \\frac{\\delta}{r_C}\\right)\n$$\n代入给定参数值：\n$$\nC^* \\;=\\; 1.0 \\left(1 - \\frac{0.4}{1.6}\\right) \\;=\\; 1.0 \\left(1 - 0.25\\right) \\;=\\; 0.75\n$$\n所以，在病原体入侵前，共生菌的稳定丰度为 $0.75$。\n\n**2. 推导病原体入侵条件**\n病原体能成功入侵的条件是，当它以极低丰度（$P \\to 0$）进入一个由处于平衡态的共生菌（$C=C^*$）主导的环境时，其净增长率为正。病原体的初始人均增长率（或称入侵适应度 $\\lambda_P$）由下式给出：\n$$\n\\lambda_P = \\left. \\frac{1}{P}\\frac{dP}{dt} \\right|_{P \\to 0, C=C^*} = \\left[ r_{P}\\left(1 - \\frac{P + \\alpha_{PC} C}{K_{P}}\\right) \\;-\\; \\delta \\right]_{P \\to 0, C=C^*}\n$$\n$$\n\\lambda_P \\;=\\; r_{P}\\left(1 - \\frac{\\alpha_{PC} C^*}{K_{P}}\\right) \\;-\\; \\delta\n$$\n入侵成功的条件是 $\\lambda_P > 0$。\n\n**3. 计算最小入侵增长率 ($r_{P}^{\\min}$)**\n病原体入侵和持续存在的临界点是其初始增长率为零（$\\lambda_P = 0$）的时刻。我们要求解的最小内禀增长率 $r_{P}^{\\min}$ 正是满足这一条件的 $r_P$ 值。\n$$\nr_{P}^{\\min}\\left(1 - \\frac{\\alpha_{PC} C^*}{K_{P}}\\right) \\;-\\; \\delta \\;=\\; 0\n$$\n求解 $r_{P}^{\\min}$：\n$$\nr_{P}^{\\min} \\;=\\; \\frac{\\delta}{1 - \\frac{\\alpha_{PC} C^*}{K_{P}}}\n$$\n现在，代入所有已知数值：\n- $\\delta = 0.4$\n- $\\alpha_{PC} = 0.75$\n- $C^* = 0.75$\n- $K_P = 0.8$\n\n$$\nr_{P}^{\\min} \\;=\\; \\frac{0.4}{1 - \\frac{0.75 \\times 0.75}{0.8}} \\;=\\; \\frac{0.4}{1 - \\frac{0.5625}{0.8}} \\;=\\; \\frac{0.4}{1 - 0.703125}\n$$\n$$\nr_{P}^{\\min} \\;=\\; \\frac{0.4}{0.296875} \\approx 1.3473684...\n$$\n根据题目要求，将结果四舍五入到四位有效数字。\n$$\nr_{P}^{\\min} \\approx 1.347\n$$\n这个结果意味着，考虑到宿主的清除作用和优势共生菌的竞争压力，病原体必须拥有至少为 $1.347\\; \\text{每天}$ 的内禀增长率才能成功入侵并在这个肠道生态系统中持续存在。",
            "answer": "$$\n\\boxed{1.347}\n$$"
        }
    ]
}