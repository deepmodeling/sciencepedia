{
    "hands_on_practices": [
        {
            "introduction": "Understanding the potential for an emerging pathogen like *Yersinia pestis* to cause a major epidemic is a central challenge in public health. This exercise introduces the Galton-Watson branching process, a powerful framework for modeling the early, stochastic phase of an outbreak. By engaging with this model , you will explore how parameters like the basic reproduction number ($R_0$) and the degree of superspreading determine the probability of outbreak extinction versus explosive growth.",
            "id": "4707305",
            "problem": "You are asked to construct a principled stochastic model of early human-to-human transmission of Yersinia pestis (plague) during a pneumonic outbreak using a Galton–Watson branching process. Work from foundational principles of stochastic processes and infectious disease transmission. Assume each infectious individual independently generates a random number of secondary infectious individuals according to a specified offspring distribution. Define the basic reproduction number ($R_0$) as the expected number of secondary cases generated by a single typical infectious case in a wholly susceptible population. Capture superspreading using an offspring distribution that can be either Poisson or Negative Binomial (NB), both parameterized to have mean $R_0$. Let $k$ denote the dispersion parameter for the Negative Binomial distribution. Assume that each secondary transmission independently involves a high-risk exposure (for example, an unprotected healthcare worker) with probability $f \\in [0,1]$, modeled by Bernoulli trials that are independent across transmissions and lineages.\n\nBase your derivations on the following core facts from the theory of branching processes and standard distributions:\n- In a Galton–Watson branching process with independent and identically distributed offspring, the probability generating function (PGF) $G(s)$ of the offspring distribution encodes the process. If $K$ is the number of offspring of a single individual, then $G(s) = \\mathbb{E}[s^{K}]$ for $s \\in [0,1]$.\n- The extinction probability $q$ for a process started by a single initial infectious case solves the fixed-point equation $q = G(q)$, which follows from independence of lineages.\n- If each offspring is independently “marked” (high-risk exposure) with probability $f$, then the probability $h$ that no marked individuals ever appear in the entire transmission tree started from one initial case solves $h = G((1 - f) \\, h)$, obtained by conditioning on the children and using independence and thinning.\n\nUse the following parameterizations of the offspring PGF:\n- Poisson offspring distribution with mean $R_0$: $G(s) = \\exp\\!\\left(R_0 (s - 1)\\right)$.\n- Negative Binomial offspring distribution with mean $R_0$ and dispersion $k$: $G(s) = \\left(1 + \\dfrac{R_0}{k} (1 - s)\\right)^{-k}$, which corresponds to the commonly used superspreading parameterization in infectious disease epidemiology.\n\nYour program must, for each provided test case, compute and return the following three quantities for an outbreak initiated by $n$ initial infectious individuals:\n1. The extinction probability $q$ for a single initial infectious case, computed as the smallest solution in $[0,1]$ to $q = G(q)$.\n2. The major-outbreak probability $1 - q$ for a single initial infectious case.\n3. The probability that at least one marked (high-risk) exposure occurs anywhere in the transmission trees arising from $n$ initial infectious cases, which equals $1 - h^{n}$, where $h$ solves $h = G((1 - f) \\, h)$.\n\nNumerically solve the fixed-point equations using reliable iterative methods on $[0,1]$ that converge to the appropriate solutions without relying on closed-form shortcuts. Use a convergence tolerance of at most $\\epsilon = 10^{-12}$ for the fixed-point solves and return results rounded to $6$ decimal places. All inputs are dimensionless. Express all probabilities as decimals in $[0,1]$.\n\nTest suite:\nProvide results for the following five test cases, each specified as a tuple $(\\text{dist}, R_0, k, n, f)$, where $\\text{dist} \\in \\{\\text{\"poisson\"}, \\text{\"nb\"}\\}$, $R_0 > 0$, $k > 0$ if applicable, $n \\in \\mathbb{N}$ with $n \\ge 1$, and $f \\in [0,1]$:\n- Case A: $\\text{\"nb\"}, R_0 = 0.7, k = 0.3, n = 1, f = 0.2$.\n- Case B: $\\text{\"nb\"}, R_0 = 1.6, k = 0.2, n = 1, f = 0.1$.\n- Case C: $\\text{\"poisson\"}, R_0 = 1.1, k$ ignored, $n = 3, f = 0.05$.\n- Case D: $\\text{\"nb\"}, R_0 = 3.0, k = 10.0, n = 5, f = 0.01$.\n- Case E: $\\text{\"nb\"}, R_0 = 1.2, k = 0.05, n = 2, f = 0.3$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists, one per test case, in the same order as above. Each inner list must contain the three floats $[q, 1 - q, 1 - h^{n}]$, each rounded to $6$ decimal places, with no extra spaces. For example, the printed output should look like:\n[[q_A,maj_A,mark_A],[q_B,maj_B,mark_B],[q_C,maj_C,mark_C],[q_D,maj_D,mark_D],[q_E,maj_E,mark_E]]\nwhere $q_{\\cdot}$, $\\text{maj}_{\\cdot}$, and $\\text{mark}_{\\cdot}$ are the computed values for the corresponding case.",
            "solution": "The problem requires the construction and analysis of a stochastic model for the early phase of a pneumonic plague outbreak. The chosen framework is the Galton-Watson branching process, a standard and powerful tool in mathematical epidemiology for modeling scenarios where the population of susceptibles is large enough to be considered effectively infinite.\n\nThe core of a Galton-Watson process is the offspring distribution, which describes the number of secondary infections caused by a single infectious individual. This distribution is concisely captured by its probability generating function (PGF). Let $K$ be a random variable representing the number of offspring from a single individual. The PGF, denoted $G(s)$, is defined as the expectation of $s^K$:\n$$G(s) = \\mathbb{E}[s^K] = \\sum_{j=0}^{\\infty} P(K=j) s^j$$\nfor a complex variable $s$ where the series converges, typically for $|s| \\le 1$. The mean of the distribution, which in this epidemiological context is the basic reproduction number $R_0$, can be recovered from the PGF as $R_0 = G'(1)$.\n\nThe problem specifies two possible offspring distributions:\n1.  **Poisson distribution:** This distribution assumes that secondary transmissions are independent events occurring at a constant average rate. Its PGF is given by:\n    $$G_{\\text{Poisson}}(s) = \\exp(R_0 (s - 1))$$\n    where $R_0$ is the mean number of offspring.\n\n2.  **Negative Binomial (NB) distribution:** This distribution is frequently used to model superspreading, as it allows for a higher variance than the Poisson distribution for the same mean. This property, known as overdispersion, is characteristic of many infectious diseases. The PGF is given by the parameterization:\n    $$G_{\\text{NB}}(s) = \\left(1 + \\frac{R_0}{k} (1 - s)\\right)^{-k}$$\n    Here, $R_0$ is the mean, and $k > 0$ is the dispersion parameter. Smaller values of $k$ correspond to greater overdispersion (i.e., a higher probability of superspreading events), while as $k \\to \\infty$, the NB distribution converges to the Poisson distribution with the same mean.\n\nThe first quantity to be computed is the **extinction probability**, $q$. This is the probability that a transmission chain initiated by a single infectious individual eventually dies out. By conditioning on the number of offspring in the first generation and invoking the independence of their subsequent lineages, we arrive at the fundamental self-consistency equation for $q$:\n$$q = \\sum_{j=0}^{\\infty} P(K=j) q^j = G(q)$$\nThe PGF $G(s)$ is a convex function on $[0,1]$ with $G(1) = 1$. If $R_0 = G'(1) \\le 1$, the only solution to $q = G(q)$ in the interval $[0,1]$ is $q=1$, signifying that extinction is certain. If $R_0 > 1$, there exists a unique solution $q \\in [0,1)$ which corresponds to the extinction probability. This solution is the smallest non-negative fixed point of $G(s)$. The complementary probability, $1-q$, represents the **major-outbreak probability** for a single infectious case.\n\nThe second part of the problem involves analyzing \"marked\" transmissions, which are high-risk exposures occurring with an independent probability $f$ for each secondary infection. We need to find the probability $h$ that no marked individuals ever appear in the transmission tree starting from a single case. We can derive an equation for $h$ by another conditioning argument. Consider a single potential offspring. For its lineage to be free of marked cases, two independent events must occur:\n1.  The transmission event itself must not be marked (probability $1-f$).\n2.  The entire subsequent transmission chain originating from this offspring must also be free of marked cases. By the recursive nature of the process, this probability is $h$.\nThus, for any given offspring, the probability that its entire lineage is \"clean\" (unmarked) is $(1-f)h$. To find the total probability $h$ for the initial case, we sum over all possibilities for the number of its offspring, $K=j$:\n$$h = \\sum_{j=0}^{\\infty} P(K=j) ((1-f)h)^j = G((1-f)h)$$\nThis gives us a new fixed-point equation for $h$. Similar to finding $q$, we seek the smallest non-negative solution.\n\nThe outbreak is started by $n$ initial infectious individuals. Since their transmission trees are assumed to evolve independently, the probability that none of the $n$ lineages produce any marked cases is $h^n$. The event of interest is its complement: the probability that at least one marked exposure occurs is $1 - h^n$.\n\nTo solve the fixed-point equations $x = F(x)$, we employ a numerical fixed-point iteration algorithm. Starting with an initial guess $x_0 = 0$, we iterate $x_{i+1} = F(x_i)$ until the change between successive iterations falls below a specified tolerance, $|x_{i+1} - x_i|  \\epsilon = 10^{-12}$. For the functions $F(s)=G(s)$ and $F(s)=G((1-f)s)$, which are PGFs or compositions involving PGFs, this iterative scheme started from $s=0$ is guaranteed to converge monotonically to the smallest non-negative fixed point.\n\nThe overall algorithm for each test case $(\\text{dist}, R_0, k, n, f)$ is as follows:\n1.  Select the appropriate PGF, $G(s)$, based on the distribution type $\\text{dist}$.\n2.  Define the function for the extinction probability, $F_q(s) = G(s)$. Solve $q = F_q(q)$ via fixed-point iteration starting from $s=0$.\n3.  Calculate the major-outbreak probability as $1 - q$.\n4.  Define the function for the no-marked-case probability, $F_h(s) = G((1-f)s)$. Solve $h = F_h(h)$ via fixed-point iteration starting from $s=0$.\n5.  Calculate the final probability of at least one marked transmission as $1 - h^n$.\n6.  Round the three resulting probabilities to $6$ decimal places.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for epidemiological quantities based on a Galton-Watson branching process model.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    # Each test case is a tuple: (distribution, R0, k, n, f)\n    # dist: 'poisson' or 'nb' (Negative Binomial)\n    # R0: Basic reproduction number\n    # k: Dispersion parameter for NB (ignored for Poisson)\n    # n: Number of initial infectious individuals\n    # f: Probability of a transmission being a \"marked\" high-risk exposure\n    test_cases = [\n        (\"nb\", 0.7, 0.3, 1, 0.2),\n        (\"nb\", 1.6, 0.2, 1, 0.1),\n        (\"poisson\", 1.1, None, 3, 0.05),\n        (\"nb\", 3.0, 10.0, 5, 0.01),\n        (\"nb\", 1.2, 0.05, 2, 0.3),\n    ]\n\n    TOLERANCE = 1e-12\n    MAX_ITER = 2000\n\n    def find_fixed_point(func, x0):\n        \"\"\"\n        Iteratively finds the fixed point of a function x = func(x).\n        \n        Args:\n            func: The function for which to find a fixed point.\n            x0: The initial guess.\n            \n        Returns:\n            The fixed point.\n        \"\"\"\n        x_prev = x0\n        for _ in range(MAX_ITER):\n            x_next = func(x_prev)\n            if abs(x_next - x_prev)  TOLERANCE:\n                return x_next\n            x_prev = x_next\n        # Return the last computed value if max iterations are reached without convergence\n        return x_next\n\n    def get_pgf(dist, R0, k):\n        \"\"\"\n        Returns the appropriate probability generating function (PGF).\n        \n        Args:\n            dist (str): 'poisson' or 'nb'.\n            R0 (float): Basic reproduction number.\n            k (float): Dispersion parameter for NB.\n            \n        Returns:\n            A function G(s) representing the PGF.\n        \"\"\"\n        if dist == \"poisson\":\n            return lambda s: np.exp(R0 * (s - 1.0))\n        elif dist == \"nb\":\n            if k is None or k = 0:\n                raise ValueError(\"Dispersion parameter k must be positive for NB distribution.\")\n            return lambda s: (1.0 + R0 / k * (1.0 - s))**(-k)\n        else:\n            raise ValueError(f\"Unknown distribution: {dist}\")\n\n    results_all_cases = []\n    \n    for dist, R0, k, n, f in test_cases:\n        # 1. Select the appropriate PGF G(s)\n        G = get_pgf(dist, R0, k)\n        \n        # 2. Compute extinction probability q\n        # q is the smallest non-negative root of q = G(q)\n        q_func = lambda s: G(s)\n        q = find_fixed_point(q_func, x0=0.0)\n        \n        # 3. Compute major-outbreak probability 1 - q\n        major_outbreak_prob = 1.0 - q\n        \n        # 4. Compute h, the probability of no marked cases from a single lineage\n        # h is the smallest non-negative root of h = G((1 - f) * h)\n        h_func = lambda s: G((1.0 - f) * s)\n        h = find_fixed_point(h_func, x0=0.0)\n        \n        # 5. Compute the probability of at least one marked case from n lineages\n        prob_at_least_one_marked = 1.0 - h**n\n        \n        # 6. Store and round results to 6 decimal places\n        case_results = [\n            round(q, 6),\n            round(major_outbreak_prob, 6),\n            round(prob_at_least_one_marked, 6)\n        ]\n        results_all_cases.append(case_results)\n\n    # Format the final output string as specified: [[q,maj,mark],[...],...]\n    output_parts = []\n    for res in results_all_cases:\n        # Format each inner list without spaces\n        inner_str = f\"[{res[0]},{res[1]},{res[2]}]\"\n        output_parts.append(inner_str)\n        \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\nsolve()\n\n```"
        },
        {
            "introduction": "Effective clinical management of plague relies on rapidly achieving bacterial suppression with appropriate antibiotic therapy. This practice delves into the principles of pharmacokinetic/pharmacodynamic (PK/PD) modeling to design a rational dosing regimen . By deriving a minimal effective dose from first principles, you will gain a quantitative understanding of how drug exposure over time translates into a desired therapeutic effect against a pathogen.",
            "id": "4707331",
            "problem": "A virulent strain of Yersinia pestis, the etiologic agent of plague, is being treated with a single intravenous bolus dose of a fluoroquinolone antibiotic. You will design the minimal loading dose that renders the net bacterial population change over the first $24$ h non-positive at the effect site. Use a pharmacokinetic/pharmacodynamic (PK/PD) framework grounded in first principles.\n\nAssume a one-compartment pharmacokinetic model with instantaneous intravenous bolus administration of dose $D$ and immediate effect-site equilibration so that the effect-site concentration equals the plasma concentration at all times. The plasma concentration is given by $C(t) = \\frac{D}{V}\\exp(-k_{e} t)$, where $V$ is the volume of distribution and $k_{e}$ is the first-order elimination rate constant. Bacterial population dynamics at the effect site follow $\\frac{db}{dt} = \\big(r_{g} - k(C(t))\\big) b(t)$, where $r_{g}$ is the first-order bacterial growth rate constant and $k(C)$ is the antibiotic kill rate. The kill rate follows a Hill-type maximal effect model with Hill coefficient $h=1$: $k(C) = \\frac{E_{\\max} C}{EC_{50} + C}$, where $E_{\\max}$ is the maximal kill rate and $EC_{50}$ is the concentration producing half-maximal kill.\n\nDefine \"bacterial suppression\" over an interval $[0,T]$ as non-positive net logarithmic change, i.e., $\\int_{0}^{T}\\big(r_{g} - k(C(t))\\big)\\,dt \\leq 0$. The minimal loading dose corresponds to the case where this integral equals $0$.\n\nUsing only the definitions above and the parameter values $E_{\\max} = 1.2$ h$^{-1}$, $EC_{50} = 2.0$ mg/L, $r_{g} = 0.35$ h$^{-1}$, $k_{e} = 0.10$ h$^{-1}$, $V = 120$ L, and $T = 24$ h, derive from first principles an analytic expression for the minimal $D$ that satisfies the suppression criterion, and then evaluate it numerically. Round your final numerical answer to three significant figures. Express the dose in mg.",
            "solution": "### Solution Derivation\n\nThe analysis begins with the condition for the minimal loading dose, which is defined as the dose that makes the net logarithmic change in the bacterial population exactly zero over the time interval $[0, T]$.\n$$ \\int_{0}^{T}\\big(r_{g} - k(C(t))\\big)\\,dt = 0 $$\nThis equation can be separated into two terms:\n$$ \\int_{0}^{T} r_{g}\\,dt - \\int_{0}^{T} k(C(t))\\,dt = 0 $$\n$$ r_{g}T = \\int_{0}^{T} k(C(t))\\,dt $$\nLet $C_0 = D/V$ be the initial concentration at time $t=0$. The concentration at any time $t$ is given by $C(t) = C_0 \\exp(-k_e t)$. Substituting this and the expression for the kill rate $k(C)$ gives:\n$$ r_{g}T = \\int_{0}^{T} \\frac{E_{\\max} C(t)}{EC_{50} + C(t)}\\,dt = \\int_{0}^{T} \\frac{E_{\\max} C_0 \\exp(-k_e t)}{EC_{50} + C_0 \\exp(-k_e t)}\\,dt $$\nTo solve this integral, we perform a change of variables. Let $u = EC_{50} + C_0 \\exp(-k_e t)$.\nThe differential $du$ is $du = -k_e C_0 \\exp(-k_e t)\\,dt$.\nRearranging for the numerator of the integrand gives $C_0 \\exp(-k_e t)\\,dt = -\\frac{1}{k_e}du$.\n\nWe must also change the limits of integration:\n- At $t=0$, the lower limit becomes $u(0) = EC_{50} + C_0 \\exp(0) = EC_{50} + C_0$.\n- At $t=T$, the upper limit becomes $u(T) = EC_{50} + C_0 \\exp(-k_e T)$.\n\nSubstituting these into the integral yields:\n$$ \\int_{u(0)}^{u(T)} \\frac{E_{\\max}}{u} \\left(-\\frac{1}{k_e}\\right)\\,du = -\\frac{E_{\\max}}{k_e} \\int_{EC_{50} + C_0}^{EC_{50} + C_0 \\exp(-k_e T)} \\frac{1}{u}\\,du $$\nThe integral of $1/u$ is $\\ln|u|$. Evaluating the definite integral:\n$$ -\\frac{E_{\\max}}{k_e} \\Big[\\ln|u|\\Big]_{EC_{50} + C_0}^{EC_{50} + C_0 \\exp(-k_e T)} = -\\frac{E_{\\max}}{k_e} \\left( \\ln(EC_{50} + C_0 \\exp(-k_e T)) - \\ln(EC_{50} + C_0) \\right) $$\nUsing the property of logarithms $\\ln(a) - \\ln(b) = \\ln(a/b)$ and absorbing the negative sign:\n$$ \\frac{E_{\\max}}{k_e} \\left( \\ln(EC_{50} + C_0) - \\ln(EC_{50} + C_0 \\exp(-k_e T)) \\right) = \\frac{E_{\\max}}{k_e} \\ln\\left(\\frac{EC_{50} + C_0}{EC_{50} + C_0 \\exp(-k_e T)}\\right) $$\nNow, we equate this result with the left side of our initial equation, $r_g T$:\n$$ r_g T = \\frac{E_{\\max}}{k_e} \\ln\\left(\\frac{EC_{50} + C_0}{EC_{50} + C_0 \\exp(-k_e T)}\\right) $$\nOur goal is to find the dose $D$. We first solve for the initial concentration $C_0$. Rearranging the equation:\n$$ \\frac{r_g T k_e}{E_{\\max}} = \\ln\\left(\\frac{EC_{50} + C_0}{EC_{50} + C_0 \\exp(-k_e T)}\\right) $$\nExponentiating both sides:\n$$ \\exp\\left(\\frac{r_g T k_e}{E_{\\max}}\\right) = \\frac{EC_{50} + C_0}{EC_{50} + C_0 \\exp(-k_e T)} $$\nTo simplify the algebra, let $A = \\exp\\left(\\frac{r_g T k_e}{E_{\\max}}\\right)$. The equation becomes:\n$$ A = \\frac{EC_{50} + C_0}{EC_{50} + C_0 \\exp(-k_e T)} $$\n$$ A(EC_{50} + C_0 \\exp(-k_e T)) = EC_{50} + C_0 $$\n$$ A \\cdot EC_{50} + A C_0 \\exp(-k_e T) = EC_{50} + C_0 $$\n$$ A \\cdot EC_{50} - EC_{50} = C_0 - A C_0 \\exp(-k_e T) $$\n$$ EC_{50}(A - 1) = C_0(1 - A \\exp(-k_e T)) $$\nThis gives the analytical expression for the required initial concentration $C_0$:\n$$ C_0 = EC_{50} \\frac{A - 1}{1 - A \\exp(-k_e T)} $$\nSubstituting the expression for $A$ back in:\n$$ C_0 = EC_{50} \\frac{\\exp\\left(\\frac{r_g T k_e}{E_{\\max}}\\right) - 1}{1 - \\exp\\left(\\frac{r_g T k_e}{E_{\\max}}\\right)\\exp(-k_e T)} = EC_{50} \\frac{\\exp\\left(\\frac{r_g T k_e}{E_{\\max}}\\right) - 1}{1 - \\exp\\left(\\frac{r_g T k_e}{E_{\\max}} - k_e T\\right)} $$\nThe minimal dose $D$ is related to the initial concentration by $D = C_0 V$. Thus, the analytical expression for the minimal dose is:\n$$ D = V \\cdot EC_{50} \\frac{\\exp\\left(\\frac{r_g T k_e}{E_{\\max}}\\right) - 1}{1 - \\exp\\left(k_e T \\left(\\frac{r_g}{E_{\\max}} - 1\\right)\\right)} $$\nNow, we substitute the provided parameter values:\n- $E_{\\max} = 1.2$ h$^{-1}$\n- $EC_{50} = 2.0$ mg/L\n- $r_{g} = 0.35$ h$^{-1}$\n- $k_{e} = 0.10$ h$^{-1}$\n- $V = 120$ L\n- $T = 24$ h\n\nFirst, calculate the dimensionless exponents:\n$$ \\frac{r_g T k_e}{E_{\\max}} = \\frac{(0.35)(24)(0.10)}{1.2} = \\frac{0.84}{1.2} = 0.7 $$\n$$ k_e T \\left(\\frac{r_g}{E_{\\max}} - 1\\right) = (0.10)(24) \\left(\\frac{0.35}{1.2} - 1\\right) = 2.4 \\left(\\frac{7}{24} - \\frac{24}{24}\\right) = 2.4 \\left(-\\frac{17}{24}\\right) = -1.7 $$\nSubstitute these values into the expression for $C_0$:\n$$ C_0 = (2.0) \\frac{\\exp(0.7) - 1}{1 - \\exp(-1.7)} \\text{ mg/L} $$\nUsing numerical values for the exponentials:\n$$ C_0 \\approx (2.0) \\frac{2.01375 - 1}{1 - 0.18268} = (2.0) \\frac{1.01375}{0.81732} \\approx 2.48066 \\text{ mg/L} $$\nFinally, calculate the dose $D$:\n$$ D = C_0 V \\approx (2.48066 \\text{ mg/L}) \\times (120 \\text{ L}) \\approx 297.679 \\text{ mg} $$\nRounding to three significant figures, the minimal dose is $298$ mg.",
            "answer": "$$\n\\boxed{298}\n$$"
        },
        {
            "introduction": "Accurately assessing the severity of an outbreak is critical for public health planning and evaluating interventions, yet surveillance data is often incomplete. This exercise tackles the real-world problem of estimating the Case Fatality Rate (CFR) when some patient outcomes are not yet known . You will apply principles of survival analysis and competing risks to derive a maximum likelihood estimator, a fundamental skill for any epidemiologist analyzing time-to-event data.",
            "id": "4707365",
            "problem": "An outbreak of primary pneumonic plague caused by the bacterium Yersinia pestis is investigated in a remote district. Investigators conduct prospective follow-up on incident laboratory-confirmed cases to estimate the Case Fatality Rate (CFR), defined as the probability that a case eventually dies before recovery. The analysis is performed at calendar time $T$ using the following foundational assumptions:\n\n- Conditional on confirmation, the time-to-death and the time-to-recovery are independent and follow exponential distributions with constant hazards $\\lambda_{d}$ and $\\lambda_{r}$, respectively, reflecting a memoryless, time-homogeneous approximation of clinical course under the prevailing standard of care.\n- Right-censoring at time $T$ (administrative end of follow-up) is independent of the event process.\n- Outcomes are mutually exclusive and exhaustive: each case eventually either dies or recovers, and after one event occurs, the other cannot occur.\n\nAt time $T$, the surveillance dataset contains the following sufficient summaries:\n\n- Total number of incident confirmed cases enrolled: $N = 90$.\n- Number of observed deaths by time $T$: $D = 41$.\n- Number of observed recoveries by time $T$: $R = 23$.\n- Number of cases still hospitalized without a recorded outcome at time $T$: $U = N - D - R = 26$.\n- Total accumulated follow-up time across all $N$ cases up to $T$: $\\sum_{i=1}^{N} t_{i} = 505$ case-days.\n\nStarting only from the definitions of hazard, survival, and the likelihood for right-censored time-to-event data under the exponential model, derive the Maximum Likelihood Estimator (MLE) for the CFR in terms of the observable counts and compute its value from the data above. Express the CFR as a decimal (not a percentage), and round your final numerical answer to four significant figures.",
            "solution": "The problem requires the derivation of the Maximum Likelihood Estimator (MLE) for the Case Fatality Rate (CFR) under a competing risks framework.\n\nLet $T_d$ be the random variable representing the time from case confirmation to death, and $T_r$ be the time from confirmation to recovery. According to the problem statement, these are independent and follow exponential distributions:\n$$T_d \\sim \\text{Exponential}(\\lambda_d)$$\n$$T_r \\sim \\text{Exponential}(\\lambda_r)$$\nThe probability density functions (PDFs) are $f_d(t) = \\lambda_d \\exp(-\\lambda_d t)$ and $f_r(t) = \\lambda_r \\exp(-\\lambda_r t)$ for $t \\ge 0$. The constant parameters $\\lambda_d$ and $\\lambda_r$ are the hazard rates for death and recovery, respectively.\n\nThe CFR is defined as the probability that a case dies before they recover, which is $P(T_d  T_r)$. We can derive this probability from the joint distribution of $T_d$ and $T_r$. Since they are independent, their joint PDF is $f(t_d, t_r) = f_d(t_d)f_r(t_r) = \\lambda_d \\lambda_r \\exp(-\\lambda_d t_d - \\lambda_r t_r)$.\nThe probability $P(T_d  T_r)$ is the integral of the joint PDF over the region where $t_d  t_r$:\n$$ \\text{CFR} = P(T_d  T_r) = \\int_0^\\infty \\int_0^{t_r} \\lambda_d \\lambda_r \\exp(-\\lambda_d t_d - \\lambda_r t_r) \\, dt_d \\, dt_r $$\nFirst, integrate with respect to $t_d$:\n$$ \\int_0^{t_r} \\lambda_d \\exp(-\\lambda_d t_d) \\, dt_d = [-\\exp(-\\lambda_d t_d)]_0^{t_r} = 1 - \\exp(-\\lambda_d t_r) $$\nNow, substitute this result into the outer integral:\n$$ \\text{CFR} = \\int_0^\\infty \\lambda_r \\exp(-\\lambda_r t_r) [1 - \\exp(-\\lambda_d t_r)] \\, dt_r $$\n$$ \\text{CFR} = \\int_0^\\infty (\\lambda_r \\exp(-\\lambda_r t_r) - \\lambda_r \\exp(-(\\lambda_d + \\lambda_r)t_r)) \\, dt_r $$\n$$ \\text{CFR} = \\left[ -\\exp(-\\lambda_r t_r) \\right]_0^\\infty - \\lambda_r \\left[ \\frac{-\\exp(-(\\lambda_d + \\lambda_r)t_r)}{\\lambda_d + \\lambda_r} \\right]_0^\\infty $$\n$$ \\text{CFR} = (0 - (-1)) - \\lambda_r \\left( 0 - \\frac{-1}{\\lambda_d + \\lambda_r} \\right) = 1 - \\frac{\\lambda_r}{\\lambda_d + \\lambda_r} = \\frac{(\\lambda_d + \\lambda_r) - \\lambda_r}{\\lambda_d + \\lambda_r} $$\n$$ \\text{CFR} = \\frac{\\lambda_d}{\\lambda_d + \\lambda_r} $$\nTo find the MLE for the CFR, we first need to find the MLEs for $\\lambda_d$ and $\\lambda_r$. We construct the likelihood function for the observed data, which consists of $D$ deaths, $R$ recoveries, and $U$ right-censored observations. The total person-time at risk is $T_{total} = \\sum_{i=1}^N t_i$.\n\nThe time to any event (death or recovery) is $T_{event} = \\min(T_d, T_r)$. The survival function for remaining event-free is $S(t) = P(T_{event} > t) = P(T_d > t \\text{ and } T_r > t)$. Due to independence, $S(t) = P(T_d > t)P(T_r > t) = \\exp(-\\lambda_d t) \\exp(-\\lambda_r t) = \\exp(-(\\lambda_d + \\lambda_r)t)$.\n\nThe likelihood contribution for an individual is determined by their outcome:\n1.  For a death observed at time $t_i$: The likelihood density is the cause-specific hazard for death, $\\lambda_d$, multiplied by the probability of surviving event-free up to time $t_i$, $S(t_i)$. The contribution is $\\lambda_d S(t_i) = \\lambda_d \\exp(-(\\lambda_d + \\lambda_r)t_i)$.\n2.  For a recovery observed at time $t_i$: Similarly, the contribution is $\\lambda_r S(t_i) = \\lambda_r \\exp(-(\\lambda_d + \\lambda_r)t_i)$.\n3.  For a case right-censored at time $t_i$: The individual was observed to be event-free at time $t_i$. The contribution is the survival probability, $S(t_i) = \\exp(-(\\lambda_d + \\lambda_r)t_i)$.\n\nThe total likelihood function, $L(\\lambda_d, \\lambda_r)$, is the product of the contributions from all $N$ individuals. We have $D$ deaths, $R$ recoveries, and $U$ censored individuals.\n$$ L(\\lambda_d, \\lambda_r) = \\left( \\prod_{i \\in \\text{deaths}} \\lambda_d \\exp(-(\\lambda_d + \\lambda_r)t_i) \\right) \\left( \\prod_{j \\in \\text{recoveries}} \\lambda_r \\exp(-(\\lambda_d + \\lambda_r)t_j) \\right) \\left( \\prod_{k \\in \\text{censored}} \\exp(-(\\lambda_d + \\lambda_r)t_k) \\right) $$\nCombining terms:\n$$ L(\\lambda_d, \\lambda_r) = \\lambda_d^D \\lambda_r^R \\exp\\left(-(\\lambda_d + \\lambda_r) \\sum_{i=1}^N t_i\\right) $$\nLet $T_{total} = \\sum_{i=1}^N t_i$. The log-likelihood function, $\\ell = \\ln(L)$, is:\n$$ \\ell(\\lambda_d, \\lambda_r) = D \\ln(\\lambda_d) + R \\ln(\\lambda_r) - (\\lambda_d + \\lambda_r) T_{total} $$\nTo find the MLEs, we take the partial derivatives of $\\ell$ with respect to $\\lambda_d$ and $\\lambda_r$ and set them to zero.\n$$ \\frac{\\partial \\ell}{\\partial \\lambda_d} = \\frac{D}{\\lambda_d} - T_{total} = 0 \\implies \\hat{\\lambda}_d = \\frac{D}{T_{total}} $$\n$$ \\frac{\\partial \\ell}{\\partial \\lambda_r} = \\frac{R}{\\lambda_r} - T_{total} = 0 \\implies \\hat{\\lambda}_r = \\frac{R}{T_{total}} $$\nThese are the MLEs for the individual hazard rates. By the invariance property of maximum likelihood estimators, the MLE for the CFR is obtained by substituting these estimators into the expression for CFR:\n$$ \\widehat{\\text{CFR}}_{\\text{MLE}} = \\frac{\\hat{\\lambda}_d}{\\hat{\\lambda}_d + \\hat{\\lambda}_r} = \\frac{D/T_{total}}{D/T_{total} + R/T_{total}} = \\frac{D/T_{total}}{(D+R)/T_{total}} $$\nThe term $T_{total}$ cancels, yielding a remarkably simple estimator:\n$$ \\widehat{\\text{CFR}}_{\\text{MLE}} = \\frac{D}{D+R} $$\nThis result is intuitive: under the assumption of constant hazards, the MLE for the probability of one event type occurring before another is the observed proportion of that event type among all observed events, disregarding the censored cases.\n\nNow, we compute the numerical value using the provided data:\n-   Number of deaths, $D = 41$.\n-   Number of recoveries, $R = 23$.\n\n$$ \\widehat{\\text{CFR}} = \\frac{41}{41 + 23} = \\frac{41}{64} $$\nAs a decimal, this is:\n$$ \\widehat{\\text{CFR}} = 0.640625 $$\nThe problem asks for the answer to be rounded to four significant figures.\n$$ \\widehat{\\text{CFR}} \\approx 0.6406 $$",
            "answer": "$$\n\\boxed{0.6406}\n$$"
        }
    ]
}