{
    "hands_on_practices": [
        {
            "introduction": "精确量化整合到宿主细胞中的HTLV-1前病毒是临床监测的基础。本练习将指导您如何从基本的分子生物学原理出发，将原始的定量PCR数据转化为临床上关键的指标——前病毒载量（Proviral Load, PVL）。通过这个实践，您将掌握解读病毒学报告和评估疾病风险的核心技能。",
            "id": "4652955",
            "problem": "一家临床病毒学实验室使用数字液滴聚合酶链式反应（ddPCR）来定量外周血单个核细胞（PBMC）中的人类T淋巴细胞病毒1型（HTLV-1）前病毒载量。该检测在同一个DNA样本中，同时靶向一个单拷贝的HTLV-1前病毒基因和一个常染色体单拷贝的人类参照基因（$\\beta$-globin基因座），以估计存在的二倍体基因组数量。“细胞当量”的概念被定义为待测DNA中二倍体基因组的数量，其生物学基础是：PBMC是二倍体，且常染色体单拷贝基因座在每个二倍体细胞中以两个拷贝的形式存在。\n\n从第一性原理出发，基于以下经过充分验证的事实：HTLV-1感染是通过宿主基因组中整合的前病毒DNA来测量的；PBMC是二倍体；一个常染色体单拷贝基因座在每个二倍体细胞中存在两个拷贝；ddPCR为每个靶标提供反应体系中模板的绝对拷贝数。请根据测得的常染色体单拷贝基因座来定义“细胞当量”，并推导出一个表达式，该表达式将每$100$个PBMC的HTLV-1前病毒载量表示为同一反应中测得的HTLV-1拷贝数和测得的常染色体单拷贝基因座拷贝数的函数。然后，将您推导出的表达式应用于从同一次ddPCR反应中获得的以下测量数据：\n\n- 测得的HTLV-1靶标拷贝数：$1{,}780$。\n- 测得的$\\beta$-globin拷贝数：$42{,}500$。\n\n以“拷贝数/每$100$个PBMC”为单位表示最终的HTLV-1前病毒载量。将最终数值答案四舍五入至四位有效数字。在最终的方框答案中不要包含单位。",
            "solution": "该问题陈述已经过验证，被确定为科学上合理、阐述清晰且完整。它描述了一种在临床环境中量化病毒载量的标准有效方法。我们可以进行推导和计算。\n\n目标有两方面：首先，从第一性原理出发，推导出每$100$个外周血单个核细胞（PBMC）中HTLV-1前病毒载量的表达式；其次，将此表达式应用于给定的数据集。\n\n让我们根据数字液滴聚合酶链式反应（ddPCR）测量的量来定义变量：\n- 设$N_{HTLV}$为检测到的HTLV-1前病毒基因的绝对拷贝数。\n- 设$N_{REF}$为检测到的参照基因（在此例中为$\\beta$-globin）的绝对拷贝数。\n\n第一个任务是根据测得的参照基因拷贝数来定义“细胞当量”。问题陈述中提到，PBMC是二倍体，并且参照基因是常染色体单拷贝基因座。根据定义，一个二倍体细胞包含两套完整的常染色体。因此，一个二倍体细胞精确地包含$2$个任何常染色体单拷贝基因的拷贝。\n\n设$N_{CE}$表示样本中的细胞当量数。一个细胞当量被定义为二倍体基因组的数量。由于每个二倍体基因组（也就是每个细胞）包含$2$个参照基因的拷贝，因此测得的参照基因总拷贝数$N_{REF}$与细胞当量数之间的关系可用以下方程表示：\n$$N_{REF} = 2 \\times N_{CE}$$\n根据这一关系，我们可以将细胞当量数表示为测得的参照基因拷贝数的函数：\n$$N_{CE} = \\frac{N_{REF}}{2}$$\n该方程提供了基于参照基因的ddPCR测量结果的“细胞当量”的正式定义。\n\n第二个任务是推导每$100$个PBMC中HTLV-1前病毒载量的表达式。前病毒载量是衡量每个细胞平均病毒拷贝数的指标。我们可以首先计算每个细胞的载量，记为$L_{cell}$。这是病毒总拷贝数与细胞当量总数的比值：\n$$L_{cell} = \\frac{N_{HTLV}}{N_{CE}}$$\n代入我们上面推导出的$N_{CE}$表达式：\n$$L_{cell} = \\frac{N_{HTLV}}{\\frac{N_{REF}}{2}} = 2 \\frac{N_{HTLV}}{N_{REF}}$$\n这个表达式给出了每个细胞中HTLV-1前病毒的平均拷贝数。临床报告标准通常要求将此值表示为每$100$个细胞的数值。我们将每$100$个PBMC的前病毒载量记为$L_{100}$。这很简单，就是每个细胞载量的$100$倍：\n$$L_{100} = 100 \\times L_{cell}$$\n代入$L_{cell}$的表达式：\n$$L_{100} = 100 \\times \\left( 2 \\frac{N_{HTLV}}{N_{REF}} \\right) = 200 \\frac{N_{HTLV}}{N_{REF}}$$\n这就是最终推导出的、将每$100$个PBMC的HTLV-1前病毒载量表示为测得的HTLV-1靶标拷贝数和常染色体参照基因拷贝数的函数的表达式。\n\n现在，我们将此表达式应用于所提供的数据：\n- 测得的HTLV-1靶标拷贝数，$N_{HTLV} = 1,780$。\n- 测得的$\\beta$-globin拷贝数，$N_{REF} = 42,500$。\n\n将这些值代入我们推导出的$L_{100}$公式中：\n$$L_{100} = 200 \\times \\frac{1,780}{42,500}$$\n在进行除法运算前，我们可以先简化表达式：\n$$L_{100} = \\frac{200 \\times 1,780}{42,500} = \\frac{2 \\times 17,800}{4,250} = \\frac{2 \\times 1,780}{425}$$\n$$L_{100} = \\frac{3,560}{425}$$\n进行除法运算得出：\n$$L_{100} \\approx 8.376470588...$$\n题目要求将最终答案四舍五入至四位有效数字。前四位有效数字是$8$、$3$、$7$和$6$。第五位有效数字是$4$。由于$4  5$，我们在第四位有效数字后截断，进行舍入。\n$$L_{100} \\approx 8.376$$\n因此，HTLV-1前病毒载量为每$100$个PBMC中$8.376$个拷贝。",
            "answer": "$$\\boxed{8.376}$$"
        },
        {
            "introduction": "HTLV-1的持续感染是由已感染细胞的克隆增殖和新生感染事件之间的动态平衡驱动的。本练习使用一个数学模型来剖析这两种病毒传播的基本机制。通过构建并分析这个动态模型，您将在细胞层面获得对HTLV-1发病机制的定量理解，并探索不同参数如何影响长期病毒载量。",
            "id": "4652936",
            "problem": "构建一个程序，该程序使用宿主-病原体动力学和种群守恒的第一性原理，定量地将人类T淋巴细胞病毒1型 (HTLV-1) 的前病毒载量随时间的增加分解为克隆增殖与新发感染两部分。使用以下基本原理：\n\n- T细胞总数守恒：假设T细胞总群保持恒定，因此受感染细胞比例的任何增加都是以未受感染细胞比例的减少为代价的。\n- 质量作用接触动力学：未受感染细胞因新发感染而被感染的速率与受感染细胞比例和未受感染细胞比例的乘积成正比。\n- 固定种群下的复制子样增殖：受感染细胞的克隆增殖会增加受感染细胞的比例，其增加量与受感染细胞比例和未受感染细胞比例的乘积成正比，因为在种群恒定的约束下，新的受感染细胞会取代未受感染的细胞。\n- 标记守恒：在受感染细胞比例中追踪两个带标记的亚群。一个亚群包含通过克隆增殖从初始受感染细胞繁衍而来的细胞，另一个亚群则包含由新发感染事件产生的细胞（及其后代）。这些标记是守恒的；增殖作用于每个带标记的亚群，其作用大小与其当前规模成正比。\n\n设 $i(t)$ 表示携带整合型前病毒的T细胞比例（即前病毒载量比例），$i_C(t)$ 表示可归因于初始受感染细胞克隆增殖的比例，$i_D(t)$ 表示可归因于新发感染事件（及其带标记后代）的比例，且 $i(t) = i_C(t) + i_D(t)$。设 $c$ 为克隆增殖系数（单位：/天），$k$ 为新发感染系数（单位：/天）。根据质量作用和守恒原理，该系统必须满足\n$$\n\\frac{d i_C}{d t} = c\\, i_C(t)\\,\\bigl(1 - i(t)\\bigr), \\qquad\n\\frac{d i_D}{d t} = c\\, i_D(t)\\,\\bigl(1 - i(t)\\bigr) + k\\, i(t)\\,\\bigl(1 - i(t)\\bigr),\n$$\n初始条件为 $i_C(0) = i_0$ 和 $i_D(0) = 0$，其中 $i_0 \\in [0,1]$ 是初始前病毒载量比例。\n\n你的程序必须：\n- 对上述系统进行数值积分，以计算在指定时间 $T$（单位：天）的 $i(T)$、$i_C(T)$ 和 $i_D(T)$。\n- 计算在时间 $T$ 时，新发感染对变化率的瞬时分数贡献 $f_{\\text{de}}(T)$，定义为\n$$\nf_{\\text{de}}(T) = \\begin{cases}\n\\dfrac{k\\, i(T)\\, \\bigl(1 - i(T)\\bigr)}{c\\, i(T)\\, \\bigl(1 - i(T)\\bigr) + k\\, i(T)\\, \\bigl(1 - i(T)\\bigr)},  \\text{若分母非零}, \\\\\n0.0,  \\text{若 } i(T) \\in \\{0,1\\} \\text{ 或 } c = k = 0 \\text{ 导致分母为零。}\n\\end{cases}\n$$\n\n所有速率必须以每天为单位表示，时间以天为单位，前病毒载量为无量纲比例。对于每个测试用例，报告一个包含四个浮点数的列表 $[i(T), i_C(T), i_D(T), f_{\\text{de}}(T)]$。在生成最终输出时，将每个浮点数四舍五入到六位小数。\n\n需要实现和评估的测试套件：\n- 案例 A (一般情况)：$i_0 = 0.01$，$c = 0.02$ /天，$k = 0.005$ /天，$T = 365$ 天。\n- 案例 B (仅新发感染)：$i_0 = 0.005$，$c = 0.0$ /天，$k = 0.05$ /天，$T = 100$ 天。\n- 案例 C (混合，快速增长)：$i_0 = 0.2$，$c = 0.05$ /天，$k = 0.2$ /天，$T = 60$ 天。\n- 案例 D (仅克隆增殖)：$i_0 = 0.005$，$c = 0.02$ /天，$k = 0.0$ /天，$T = 200$ 天。\n- 案例 E (无初始感染)：$i_0 = 0.0$，$c = 0.03$ /天，$k = 0.1$ /天，$T = 50$ 天。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含所有测试用例的结果，格式为由方括号括起来的逗号分隔列表，例如：\n- \"[[a11,a12,a13,a14],[a21,a22,a23,a24],...]\" 其中每个 \"aij\" 是一个四舍五入到六位小数的浮点数，按顺序代表给定案例的 $i(T)$、$i_C(T)$、$i_D(T)$ 和 $f_{\\text{de}}(T)$。",
            "solution": "所给问题在科学上是适定的，在数学上是一致的，并包含了推导唯一解所需的所有必要信息。该模型基于种群动力学的既定原则，特别是质量作用动力学和守恒定律，使其成为一个有效的数学生物学问题。因此，我们可以进行形式化求解。\n\n问题的核心是求解一个关于T细胞比例 $i_C(t)$ 和 $i_D(t)$ 的二元耦合常微分方程组 (ODEs)：\n$$\n\\frac{d i_C}{d t} = c\\, i_C(t)\\,\\bigl(1 - i(t)\\bigr) \\quad (1)\n$$\n$$\n\\frac{d i_D}{d t} = c\\, i_D(t)\\,\\bigl(1 - i(t)\\bigr) + k\\, i(t)\\,\\bigl(1 - i(t)\\bigr) \\quad (2)\n$$\n其中 $i(t) = i_C(t) + i_D(t)$ 是受感染细胞的总比例。初始条件为 $i_C(0) = i_0$ 和 $i_D(0) = 0$，这意味着 $i(0) = i_0$。\n\n虽然这些方程可以使用数值积分求解，但更严谨和准确的方法是寻找解析解。首先，我们通过将方程 $(1)$ 和 $(2)$ 相加来推导总受感染比例 $i(t)$ 的方程：\n$$\n\\frac{d i}{d t} = \\frac{d i_C}{d t} + \\frac{d i_D}{d t} = c\\, i_C(t)\\,(1 - i(t)) + c\\, i_D(t)\\,(1 - i(t)) + k\\, i(t)\\,(1 - i(t))\n$$\n因式分解并代入 $i(t) = i_C(t) + i_D(t)$：\n$$\n\\frac{d i}{d t} = c\\,\\bigl(i_C(t) + i_D(t)\\bigr)\\,(1 - i(t)) + k\\, i(t)\\,(1 - i(t))\n$$\n$$\n\\frac{d i}{d t} = c\\, i(t)\\,(1 - i(t)) + k\\, i(t)\\,(1 - i(t)) = (c+k)\\, i(t)\\,(1 - i(t))\n$$\n这是标准逻辑斯谛增长方程，其有效增长率为 $K_{eff} = c+k$。对于初始条件 $i(0) = i_0$，解析解为：\n$$\ni(t) = \\frac{i_0 e^{K_{eff} t}}{1 - i_0 + i_0 e^{K_{eff} t}} = \\frac{1}{1 + \\left(\\frac{1}{i_0} - 1\\right)e^{-K_{eff} t}}\n$$\n此解在 $i_0  0$ 和 $i_0  1$ 的条件下有效。如果 $i_0 = 0$，唯一解是对于所有 $t$ 都有 $i(t) = 0$。如果 $i_0 = 1$，解是对于所有 $t$ 都有 $i(t) = 1$。\n\n接下来，我们求解 $i_C(t)$。我们可以将方程 $(1)$ 重写为一个线性一阶常微分方程：\n$$\n\\frac{d i_C}{d t} - c\\,\\bigl(1 - i(t)\\bigr)\\,i_C(t) = 0\n$$\n为了求解，我们也可以观察 $i_C(t)$ 和 $i(t)$ 增长率的比值。将 $\\frac{1}{i_C}\\frac{di_C}{dt}$ 除以 $\\frac{1}{i}\\frac{di}{dt}$：\n$$\n\\frac{\\frac{d}{dt}\\ln(i_C)}{\\frac{d}{dt}\\ln(i)} = \\frac{c\\,(1-i(t))}{(c+k)\\,(1-i(t))} = \\frac{c}{c+k}\n$$\n这在 $1-i(t) \\neq 0$ 且 $c+k \\neq 0$ 的时间 $t$ 上成立。这意味着 $i_C$ 和 $i$ 之间存在幂律关系：\n$$\nd(\\ln i_C) = \\frac{c}{c+k} d(\\ln i)\n$$\n从 $t=0$ 积分到一个通用时间 $t$ 得出：\n$$\n\\ln(i_C(t)) - \\ln(i_C(0)) = \\frac{c}{c+k} \\bigl( \\ln(i(t)) - \\ln(i(0)) \\bigr)\n$$\n使用初始条件 $i_C(0) = i_0$ 和 $i(0) = i_0$：\n$$\n\\ln\\left(\\frac{i_C(t)}{i_0}\\right) = \\frac{c}{c+k} \\ln\\left(\\frac{i(t)}{i_0}\\right) = \\ln\\left(\\left(\\frac{i(t)}{i_0}\\right)^{\\frac{c}{c+k}}\\right)\n$$\n对两边取指数，得到 $i_C(t)$ 的解析解：\n$$\ni_C(t) = i_0 \\left(\\frac{i(t)}{i_0}\\right)^{\\frac{c}{c+k}}\n$$\n此解在 $i_0  0$ 且 $c+k \\neq 0$ 时有效。\n\n如果 $k=0$ 且 $c0$，指数为 $1$，所以 $i_C(t) = i(t)$。这是符合逻辑的，因为没有新发感染意味着所有受感染细胞都源自最初的克隆。\n如果 $c=0$ 且 $k0$，指数为 $0$，所以 $i_C(t) = i_0 (i(t)/i_0)^0 = i_0$。这也是符合逻辑的，因为没有克隆增殖意味着初始克隆群体的规模不会增加（其比例仅因父模型中捕捉到的种群级效应而改变，但在这里 $di_C/dt=0$）。\n\n比例 $i_D(t)$ 通过减法得出：$i_D(t) = i(t) - i_C(t)$。\n\n需要考虑的特殊情况：\n1.  如果 $i_0 = 0$：$i_C(0)=0$ 且 $i_D(0)=0$。关于 $i(t)$ 的常微分方程给出对于所有 $t$ 都有 $i(t)=0$。因此，$i_C(t)=0$ 且 $i_D(t)=0$。\n2.  如果 $c+k = 0$：$i(t)$ 的增长率为 $0$，所以对于所有 $t$ 都有 $i(t) = i_0$。关于 $i_C(t)$ 的方程变为 $\\frac{di_C}{dt} = c\\, i_C(t)\\,(1-i_0)$。其解为 $i_C(t) = i_0 e^{c(1-i_0)t}$。\n\n最后，我们必须计算新发感染的瞬时分数贡献 $f_{\\text{de}}(T)$。所提供的定义是：\n$$\nf_{\\text{de}}(T) = \\frac{\\text{源自新发感染的增长速率}}{\\text{总增长速率}} = \\frac{k\\, i(T)\\, \\bigl(1 - i(T)\\bigr)}{c\\, i(T)\\, \\bigl(1 - i(T)\\bigr) + k\\, i(T)\\, \\bigl(1 - i(T)\\bigr)}\n$$\n如果分母不为零，项 $i(T)(1-i(T))$ 会消去，得到：\n$$\nf_{\\text{de}}(T) = \\frac{k}{c+k}\n$$\n如果 $i(T) \\in \\{0, 1\\}$ 或 $c+k=0$，则分母为零。问题指出在这些情况下 $f_{\\text{de}}(T) = 0.0$。我们的算法将实现这一逻辑。如果 $c=k=0$，则 $c+k=0$，且 $f_{\\text{de}}(T) = 0.0$。\n\n每个测试用例的算法如下：\n1.  给定参数 $i_0$、$c$、$k$ 和 $T$。\n2.  处理边界情况 $i_0=0$。此时，$i(T)=0$，$i_C(T)=0$，$i_D(T)=0$，且 $f_{\\text{de}}(T)=0$。\n3.  如果 $i_0  0$，计算有效速率 $K_{eff} = c+k$。\n4.  如果 $K_{eff} = 0$，则 $i(T) = i_0$。根据测试用例，当 $c  0$ 或 $k  0$ 时不会出现这种情况。如果两者都为零，则 $i_C(T) = i_0$，$i_D(T) = 0$。\n5.  如果 $K_{eff} \\ne 0$，使用逻辑斯谛解的公式计算 $i(T)$。\n6.  使用推导出的幂律公式计算 $i_C(T)$。需要特别注意 $c=0$ 或 $k=0$ 的情况（只要 $c+k \\ne 0$，通用公式就能正确处理这些情况）。\n7.  计算 $i_D(T) = i(T) - i_C(T)$。\n8.  计算 $f_{\\text{de}}(T)$。如果 $c+k = 0$ 或 $i(T)$ 在数值上与 $0$ 或 $1$ 无法区分，则设 $f_{\\text{de}}(T)=0$。否则，计算 $f_{\\text{de}}(T) = k/(c+k)$。\n9.  返回四个值 $[i(T), i_C(T), i_D(T), f_{\\text{de}}(T)]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not needed due to the analytical solution.\n\ndef solve():\n    \"\"\"\n    Main function to solve the HTLV-1 dynamics problem for a suite of test cases.\n    \"\"\"\n    # Test suite from the problem statement.\n    # Each case is a tuple: (i0, c, k, T)\n    test_cases = [\n        # Case A (general)\n        (0.01, 0.02, 0.005, 365),\n        # Case B (de novo only)\n        (0.005, 0.0, 0.05, 100),\n        # Case C (mixed, faster growth)\n        (0.2, 0.05, 0.2, 60),\n        # Case D (clonal only)\n        (0.005, 0.02, 0.0, 200),\n        # Case E (no seed)\n        (0.0, 0.03, 0.1, 50),\n    ]\n\n    all_results = []\n    \n    # Set a small tolerance for floating point comparisons to 0 and 1.\n    TOLERANCE = 1e-9\n\n    for case in test_cases:\n        i0, c, k, T = case\n\n        # Handle the trivial case where there are no initial infected cells.\n        if i0 == 0.0:\n            i_T, iC_T, iD_T = 0.0, 0.0, 0.0\n        else:\n            K_eff = c + k\n\n            # Handle case where total growth rate is zero.\n            if abs(K_eff)  TOLERANCE:\n                i_T = i0\n                # In this case, diC/dt = 0 since c is also 0.\n                if abs(c)  TOLERANCE:\n                    iC_T = i0\n                # A more general case (c=-k!=0) would solve diC/dt = c*iC*(1-i0)\n                else:\n                    iC_T = i0 * np.exp(c * (1.0 - i0) * T)\n            else:\n                # Calculate total infected fraction i(T) using the logistic solution.\n                # Avoid division by zero if i0 is 1.0.\n                if abs(i0 - 1.0)  TOLERANCE:\n                    i_T = 1.0\n                else:\n                    denominator = 1.0 + (1.0 / i0 - 1.0) * np.exp(-K_eff * T)\n                    i_T = 1.0 / denominator\n\n                # Calculate clonal fraction i_C(T).\n                if abs(c)  TOLERANCE:\n                    # If c=0, diC/dt = 0, so iC is constant.\n                    iC_T = i0\n                else:\n                    # Power-law relationship between i_C and i.\n                    # This formula correctly handles the k=0 case (exponent becomes 1).\n                    ratio = i_T / i0\n                    # Handle potential negative base in power for unstable numerical cases\n                    if ratio  0: ratio = 0\n                    exponent = c / K_eff\n                    iC_T = i0 * (ratio ** exponent)\n            \n            # De novo fraction is the remainder.\n            iD_T = i_T - iC_T\n\n        # Calculate the instantaneous fractional contribution of de novo infection f_de(T).\n        # The denominator of the full expression is zero if i(T) is 0 or 1, or if c+k is 0.\n        denominator_is_zero = (abs(c + k)  TOLERANCE) or \\\n                              (abs(i_T)  TOLERANCE) or \\\n                              (abs(i_T - 1.0)  TOLERANCE)\n        \n        if denominator_is_zero:\n            f_de_T = 0.0\n        else:\n            # Simplified formula when the denominator is non-zero.\n            f_de_T = k / (c + k)\n\n        all_results.append([i_T, iC_T, iD_T, f_de_T])\n\n    # Format the final output string as specified.\n    # Each float must be rounded to six decimal places.\n    output_parts = []\n    for res_list in all_results:\n        # e.g., res_list = [i(T), iC(T), iD(T), f_de(T)]\n        formatted_list = [f\"{x:.6f}\" for x in res_list]\n        output_parts.append(f\"[{','.join(formatted_list)}]\")\n    \n    final_output_string = f\"[{','.join(output_parts)}]\"\n\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "治疗像成人T细胞白血病/淋巴瘤（ATL）这样的HTLV-1相关恶性肿瘤，需要在疗效、毒性和患者生活质量之间做出复杂的权衡。本练习使用一个正式的决策分析框架来模拟这一过程。这个实践将要求您综合临床数据、患者特征和如质量调整生命年（Quality-Adjusted Life Years, QALYs）等结果指标，来评估和比较不同的治疗策略，是循证临床医学中应用定量推理的综合性练习。",
            "id": "4652976",
            "problem": "成人T细胞白血病/淋巴瘤 (ATL) 是一种由人类T淋巴细胞病毒1型 (HTLV-1) 慢性感染驱动的恶性肿瘤。感染性疾病相关癌症的决策分析可以基于期望值和全概率定律的定义：对于任何以结果为值的随机变量 $X$，其期望值为 $E[X] = \\sum_{i} P(B_{i}) E[X \\mid B_{i}]$，其中 $\\{B_{i}\\}$ 是任意一个完备互斥划分。在固定时间范围内的质量调整生命年 (QALYs) 结合了生存概率和健康状态效用；对于一个固定的 $T$ 年时间范围，若在该时间范围内效用 $q$ 和生存概率 $p$ 均为常数，则期望QALY贡献为 $T \\times p \\times q$。基于这些基础，考虑以下关于HTLV-1相关ATL患者起始治疗是采用齐多夫定 (AZT) 和α-干扰素 (IFN) 还是化疗的科学现实决策问题。\n\n一个新诊断的ATL患者队列根据亚型、肿瘤负荷和合并症进行特征分类。亚型分布为：急性白血病型 ($0.5$)、淋巴瘤型 ($0.3$)、慢性/潜隐型 ($0.2$)。条件肿瘤负荷分布为：对于急性白血病型，高负荷 ($0.7$) 和低负荷 ($0.3$)；对于淋巴瘤型，高负荷 ($0.6$) 和低负荷 ($0.4$)；对于慢性/潜隐型，高负荷 ($0.1$) 和低负荷 ($0.9$)。合并症分为无 ($0.5$)、中度 ($0.3$) 或重度 ($0.2$)，并假设其与亚型和肿瘤负荷无关。\n\n对于治疗下两年的结局，基线（无合并症）状态下2年生存概率 ($p$) 如下：\n\n- 在AZT/IFN治疗下：急性低负荷 $0.40$，急性高负荷 $0.25$，淋巴瘤低负荷 $0.30$，淋巴瘤高负荷 $0.20$，慢性/潜隐型低负荷 $0.80$，慢性/潜隐型高负荷 $0.65$。\n\n- 在化疗下：急性低负荷 $0.45$，急性高负荷 $0.35$，淋巴瘤低负荷 $0.50$，淋巴瘤高负荷 $0.40$，慢性/潜隐型低负荷 $0.60$，慢性/潜隐型高负荷 $0.55$。\n\n合并症对生存概率和生命质量的调整如下。对于AZT/IFN治疗，中度合并症使 $p$ 降低 $0.02$，重度合并症使 $p$ 降低 $0.05$；无合并症时健康状态效用 $q$ 为 $0.85$，中度为 $0.80$，重度为 $0.75$。对于化疗，中度合并症使 $p$ 降低 $0.05$，重度合并症使 $p$ 降低 $0.10$；无合并症时 $q$ 为 $0.75$，中度为 $0.65$，重度为 $0.55$。\n\n考虑以下用于初始治疗选择的决策树策略 $T$：\n- 如果存在重度合并症，无论亚型和肿瘤负荷如何，均起始AZT/IFN治疗。\n- 否则，对于慢性/潜隐型ATL或低肿瘤负荷的急性白血病型，起始AZT/IFN治疗。\n- 否则，起始化疗（即，对于任何负荷的淋巴瘤型或高肿瘤负荷的急性白血病型）。\n\n对比策略 $C$ 是为所有患者起始化疗。\n\n使用 $2$ 年的时间范围 ($T = 2$)、独立性假设以及上述分布和各分支特定值，计算策略 $T$ 相对于策略 $C$ 的每位患者增量期望$2$年QALYs，即 $E[\\text{QALY}_{T}] - E[\\text{QALY}_{C}]$。将您的最终数值答案四舍五入到四位有效数字。以QALYs为单位表示最终结果。",
            "solution": "目标是计算测试策略 $T$ 相对于对比策略 $C$ 的增量期望$2$年质量调整生命年 (QALYs)，由表达式 $E[\\text{QALY}_{T}] - E[\\text{QALY}_{C}]$ 给出。该期望是针对整个患者群体计算的。\n\n患者群体按三个特征进行划分：亚型 ($S$)、肿瘤负荷 ($B$) 和合并症 ($C_m$)。设特定患者状态由三元组 $(s, b, c_m)$ 表示。问题陈述合并症与亚型和肿瘤负荷无关，因此特定患者状态的概率为 $P(s, b, c_m) = P(s) \\times P(b \\mid s) \\times P(c_m)$。\n\n给定患者状态在特定治疗下的期望QALY由 $T \\times p \\times q$ 给出，其中 $T=2$ 是时间范围，$p$ 是$2$年生存概率，$q$ 是健康状态效用。$p$ 和 $q$ 都取决于患者状态和所选治疗方法。\n\n设 $Q(s, b, c_m, \\text{Therapy})$ 表示状态为 $(s, b, c_m)$ 的患者接受特定治疗的期望QALYs。$Q(s, b, c_m, \\text{Therapy}) = 2 \\times p(s, b, c_m, \\text{Therapy}) \\times q(c_m, \\text{Therapy})$。生存概率 $p(s, b, c_m, \\text{Therapy})$ 是根据合并症 $c_m$ 调整后的基线概率 $p_0(s, b, \\text{Therapy})$。\n\n总增量期望QALY可通过应用全期望定律求得：\n$$ \\Delta E[\\text{QALY}] = E[\\text{QALY}_{T}] - E[\\text{QALY}_{C}] = \\sum_{s,b,c_m} P(s,b,c_m) \\left[ Q(s,b,c_m, \\text{Therapy}_T) - Q(s,b,c_m, \\text{Therapy}_C) \\right] $$\n其中 $\\text{Therapy}_T$ 和 $\\text{Therapy}_C$ 分别是策略 $T$ 和 $C$ 为状态 $(s, b, c_m)$ 指定的治疗方法。\n\n策略 $C$ 总是指定化疗 (Chemo)。策略 $T$ 根据患者的状态指定齐多夫定/α-干扰素 (AZT/IFN) 或化疗。求和中的差值项仅在 $\\text{Therapy}_T \\neq \\text{Therapy}_C$ 的状态下非零。这恰好发生在策略 $T$ 指定AZT/IFN时。\n\n根据策略 $T$ 的定义：\n\\begin{enumerate}\n    \\item 如果合并症为重度 ($c_m = S_c$)，则使用AZT/IFN。\n    \\item 如果合并症不为重度 ($c_m \\in \\{N, M\\}$) 且亚型为慢性/潜隐型 ($s=CS$) 或低负荷的急性白血病型 ($s=A, b=L$)，则使用AZT/IFN。\n\\end{enumerate}\n在所有其他情况下，策略 $T$ 指定化疗，因此差值项为零。我们只需要对策略 $T$ 中使用AZT/IFN的状态进行求和。\n\n首先，我们计算联合概率 $P(s,b) = P(s)P(b|s)$：\n\\begin{itemize}\n    \\item $P(A, H) = 0.5 \\times 0.7 = 0.35$\n    \\item $P(A, L) = 0.5 \\times 0.3 = 0.15$\n    \\item $P(L, H) = 0.3 \\times 0.6 = 0.18$\n    \\item $P(L, L) = 0.3 \\times 0.4 = 0.12$\n    \\item $P(CS, H) = 0.2 \\times 0.1 = 0.02$\n    \\item $P(CS, L) = 0.2 \\times 0.9 = 0.18$\n\\end{itemize}\n合并症的概率为 $P(N)=0.5$、$P(M)=0.3$、$P(S_c)=0.2$，其中 $N, M, S_c$ 分别表示无、中度、重度合并症。\n\n令 $\\Delta Q(s,b,c_m) = Q(s,b,c_m, \\text{AZT/IFN}) - Q(s,b,c_m, \\text{Chemo})$。计算根据合并症状态分为三部分。\n\n**第1部分：重度合并症 ($c_m = S_c$)**\n对于所有患有重度合并症的患者，策略 $T$ 是AZT/IFN。$P(c_m=S_c)=0.2$。\n对于AZT/IFN：$q=0.75$，生存概率降低 $0.05$。对于化疗：$q=0.55$，生存概率降低 $0.10$。\n$\\Delta Q(s,b,S_c) = 2 \\times \\left[ (p_{0,\\text{AZT}}(s,b) - 0.05) \\times 0.75 - (p_{0,\\text{Chemo}}(s,b) - 0.10) \\times 0.55 \\right]$。\n我们为每个 $(s,b)$ 状态计算该值，乘以 $P(s,b)$，求和，然后乘以 $P(c_m=S_c)$。\n\\begin{itemize}\n    \\item $(A, H)$: $\\Delta Q = 2[(0.25-0.05)0.75 - (0.35-0.10)0.55] = 2[0.15 - 0.1375] = 0.025$。贡献: $0.35 \\times 0.025 = 0.00875$。\n    \\item $(A, L)$: $\\Delta Q = 2[(0.40-0.05)0.75 - (0.45-0.10)0.55] = 2[0.2625 - 0.1925] = 0.14$。贡献: $0.15 \\times 0.14 = 0.021$。\n    \\item $(L, H)$: $\\Delta Q = 2[(0.20-0.05)0.75 - (0.40-0.10)0.55] = 2[0.1125 - 0.165] = -0.105$。贡献: $0.18 \\times (-0.105) = -0.0189$。\n    \\item $(L, L)$: $\\Delta Q = 2[(0.30-0.05)0.75 - (0.50-0.10)0.55] = 2[0.1875 - 0.22] = -0.065$。贡献: $0.12 \\times (-0.065) = -0.0078$。\n    \\item $(CS, H)$: $\\Delta Q = 2[(0.65-0.05)0.75 - (0.55-0.10)0.55] = 2[0.45 - 0.2475] = 0.405$。贡献: $0.02 \\times 0.405 = 0.0081$。\n    \\item $(CS, L)$: $\\Delta Q = 2[(0.80-0.05)0.75 - (0.60-0.10)0.55] = 2[0.5625 - 0.275] = 0.575$。贡献: $0.18 \\times 0.575 = 0.1035$。\n\\end{itemize}\n该组的总贡献：$\\Delta E_1 = 0.2 \\times (0.00875 + 0.021 - 0.0189 - 0.0078 + 0.0081 + 0.1035) = 0.2 \\times 0.11465 = 0.02293$。\n\n**第2部分：无合并症 ($c_m = N$)**\n对于该组 ($P(c_m=N)=0.5$)，AZT/IFN仅用于 $(A,L)$、$(CS,H)$ 和 $(CS,L)$。\n对于AZT/IFN：$q=0.85$，生存概率降低 $0$。对于化疗：$q=0.75$，生存概率降低 $0$。\n$\\Delta Q(s,b,N) = 2 \\times \\left[ p_{0,\\text{AZT}}(s,b) \\times 0.85 - p_{0,\\text{Chemo}}(s,b) \\times 0.75 \\right]$。\n该组的贡献为 $\\Delta E_2 = P(N) \\sum_{(s,b)} P(s,b) \\Delta Q(s,b,N)$，其中 $(s,b)$ 为相关状态。\n\\begin{itemize}\n    \\item $(A, L)$: $\\Delta Q = 2[0.40 \\times 0.85 - 0.45 \\times 0.75] = 2[0.34 - 0.3375] = 0.005$。贡献: $0.5 \\times 0.15 \\times 0.005 = 0.000375$。\n    \\item $(CS, H)$: $\\Delta Q = 2[0.65 \\times 0.85 - 0.55 \\times 0.75] = 2[0.5525 - 0.4125] = 0.28$。贡献: $0.5 \\times 0.02 \\times 0.28 = 0.0028$。\n    \\item $(CS, L)$: $\\Delta Q = 2[0.80 \\times 0.85 - 0.60 \\times 0.75] = 2[0.68 - 0.45] = 0.46$。贡献: $0.5 \\times 0.18 \\times 0.46 = 0.0414$。\n\\end{itemize}\n该组的总贡献：$\\Delta E_2 = 0.000375 + 0.0028 + 0.0414 = 0.044575$。\n\n**第3部分：中度合并症 ($c_m = M$)**\n对于该组 ($P(c_m=M)=0.3$)，AZT/IFN用于与第2部分相同的状态。\n对于AZT/IFN：$q=0.80$，生存概率降低 $0.02$。对于化疗：$q=0.65$，生存概率降低 $0.05$。\n$\\Delta Q(s,b,M) = 2 \\times \\left[ (p_{0,\\text{AZT}}(s,b) - 0.02) \\times 0.80 - (p_{0,\\text{Chemo}}(s,b) - 0.05) \\times 0.65 \\right]$。\n\\begin{itemize}\n    \\item $(A, L)$: $\\Delta Q = 2[(0.40-0.02)0.80 - (0.45-0.05)0.65] = 2[0.304 - 0.26] = 0.088$。贡献: $0.3 \\times 0.15 \\times 0.088 = 0.00396$。\n    \\item $(CS, H)$: $\\Delta Q = 2[(0.65-0.02)0.80 - (0.55-0.05)0.65] = 2[0.504 - 0.325] = 0.358$。贡献: $0.3 \\times 0.02 \\times 0.358 = 0.002148$。\n    \\item $(CS, L)$: $\\Delta Q = 2[(0.80-0.02)0.80 - (0.60-0.05)0.65] = 2[0.624 - 0.3575] = 0.533$。贡献: $0.3 \\times 0.18 \\times 0.533 = 0.028782$。\n\\end{itemize}\n该组的总贡献：$\\Delta E_3 = 0.00396 + 0.002148 + 0.028782 = 0.03489$。\n\n**最终计算**\n总增量期望QALY是所有组贡献的总和：\n$$ \\Delta E[\\text{QALY}] = \\Delta E_1 + \\Delta E_2 + \\Delta E_3 = 0.02293 + 0.044575 + 0.03489 = 0.102395 $$\n\n将结果四舍五入到四位有效数字，得到 $0.1024$。",
            "answer": "$$\\boxed{0.1024}$$"
        }
    ]
}