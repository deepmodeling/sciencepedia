{
    "hands_on_practices": [
        {
            "introduction": "数学模型是理解病毒感染如何在宿主体内建立的关键工具。靶细胞限制模型（target-cell limited model）是描述病毒与宿主细胞相互作用的基础框架。本练习将指导您推导“宿主内基本再生数”$R_{\\mathrm{intra}}$，这是一个决定感染能否成功建立的关键阈值，并分析病毒载量初始增长的条件。通过这个实践，您将锻炼将生物学原理转化为数学表达式并进行系统稳定性分析的核心技能。",
            "id": "4635803",
            "problem": "严重急性呼吸综合征冠状病毒2 (SARS-CoV-2) 在感染极早期阶段于上呼吸道的宿主内动力学可以通过一个基于质量作用感染和一级清除的靶细胞限制模型来表示。令 $T(t)$ 表示易感上皮靶细胞的分数（无量纲，$0 \\leq T \\leq 1$），$I(t)$ 表示受感染细胞的密度（无量纲），$V(t)$ 表示无量纲病毒载量（通过参考水平缩放的自由病毒粒子）。该模型为：\n$$\n\\frac{dT}{dt} = -\\beta\\,T\\,V,\\quad\n\\frac{dI}{dt} = \\beta\\,T\\,V - \\delta\\,I,\\quad\n\\frac{dV}{dt} = p\\,I - c\\,V,\n$$\n其中 $\\beta$ 是一个无量纲的感染混合系数，单位为 $\\text{day}^{-1}$，$\\delta$ 是受感染细胞的损失率，单位为 $\\text{day}^{-1}$，$p$ 是在所选缩放下每个受感染细胞的病毒粒子产生率，单位为 $\\text{day}^{-1}$，而 $c$ 是自由病毒粒子的清除率，单位为 $\\text{day}^{-1}$。假设在时间 $t=0$ 时，系统接近无感染状态，其中 $T(0) = T_0$，$T_0$ 接近于 $1$，$I(0) \\approx 0$ 且 $V(0) > 0$ 是一个小数。在极早期阶段，将 $T(t)$ 视为在 $T_0$ 处的准恒定值。\n\n从这些基本定律和定义出发，并且不借助任何预先给定的阈值公式，完成以下任务：\n- 从第一性原理出发，推导宿主内基本再生数 $R_{\\mathrm{intra}}$ 的解析表达式，其定义为在保持 $T(t) \\equiv T_0$ 恒定的宿主中，由单个受感染细胞引入所产生的预期新感染细胞数。\n- 推导病毒载量在初始阶段增长而非衰减的条件，用 $R_{\\mathrm{intra}}$ 表示。\n\n然后，使用参数值 $T_0 = 0.9$，$\\beta = 0.60\\,\\text{day}^{-1}$，$p = 50\\,\\text{day}^{-1}$，$\\delta = 1.0\\,\\text{day}^{-1}$ 以及 $c = 10.0\\,\\text{day}^{-1}$ 计算 $R_{\\mathrm{intra}}$。将 $R_{\\mathrm{intra}}$ 的最终数值答案四舍五入至三位有效数字。以纯数（无量纲）形式表示最终答案。",
            "solution": "该问题提出了一个标准的病毒动力学靶细胞限制模型，该模型科学合理、适定且内部一致。所有必需的参数和定义均已提供。所做的假设清晰陈述，并适用于感染早期的分析。该问题是有效的。\n\n推导过程按要求分三部分进行：首先，推导宿主内基本再生数 $R_{\\mathrm{intra}}$；其次，推导初始病毒增长的条件；第三，对 $R_{\\mathrm{intra}}$ 进行数值评估。\n\n**第一部分：宿主内基本再生数 $R_{\\mathrm{intra}}$ 的推导**\n\n宿主内基本再生数 $R_{\\mathrm{intra}}$ 定义为在完全易感的细胞群体中，由单个受感染细胞引入所产生的预期新感染细胞数。我们通过追踪源自单个受感染细胞的感染生命周期，从第一性原理推导这个数。\n\n1.  **受感染细胞的寿命：** 受感染细胞 $I$ 以一级速率 $\\delta$ 被清除。在没有新感染的情况下，一组受感染细胞的衰减方程为 $\\frac{dI}{dt} = -\\delta I$。这是一个一级衰减过程。一个受感染细胞的平均寿命是速率常数的倒数，即 $\\frac{1}{\\delta}$。\n\n2.  **单个受感染细胞产生的病毒粒子：** 单个受感染细胞以速率 $p$ 产生病毒粒子。在其平均寿命 $\\frac{1}{\\delta}$ 天内，单个受感染细胞预计产生的病毒粒子总数等于产生速率乘以平均寿命：\n    $$\n    \\text{每个受感染细胞产生的病毒粒子总数} = p \\times \\frac{1}{\\delta} = \\frac{p}{\\delta}\n    $$\n\n3.  **病毒粒子对新细胞的感染：** 自由病毒粒子 $V$ 以一级速率 $c$ 被清除。因此，一个自由病毒粒子的平均寿命是 $\\frac{1}{c}$。在其寿命期间，一个病毒粒子可以感染易感细胞 $T$。新细胞被感染的速率由 $\\beta T V$ 给出。在易感细胞分数恒定为 $T_0$ 的近似下，每个病毒粒子的新感染速率为 $\\beta T_0$。单个病毒粒子在其平均寿命内感染的新细胞总数是每个病毒粒子的感染速率乘以其平均寿命：\n    $$\n    \\text{每个病毒粒子感染的新细胞数} = \\beta T_0 \\times \\frac{1}{c} = \\frac{\\beta T_0}{c}\n    $$\n\n4.  **合并步骤：** $R_{\\mathrm{intra}}$ 是由一个原代受感染细胞产生的继代受感染细胞总数。这是一个细胞产生的病毒粒子总数与每个病毒粒子预期引起的新感染数之积。\n    $$\n    R_{\\mathrm{intra}} = (\\text{每个受感染细胞产生的病毒粒子总数}) \\times (\\text{每个病毒粒子感染的新细胞数})\n    $$\n    $$\n    R_{\\mathrm{intra}} = \\left( \\frac{p}{\\delta} \\right) \\times \\left( \\frac{\\beta T_0}{c} \\right) = \\frac{p \\beta T_0}{c \\delta}\n    $$\n这个表达式代表了宿主内的基本再生数。\n\n**第二部分：初始病毒增长条件的推导**\n\n为了确定感染初始增长的条件，我们分析在无感染状态（$I \\approx 0$, $V \\approx 0$）附近受感染细胞 $I(t)$ 和病毒载量 $V(t)$ 的动力学。我们使用靶细胞群体近似恒定 $T(t) \\approx T_0$ 的假设。这将 $I$ 和 $V$ 的微分方程组线性化：\n$$\n\\frac{dI}{dt} = \\beta T_0 V - \\delta I\n$$\n$$\n\\frac{dV}{dt} = p I - c V\n$$\n这是一个线性常微分方程组，可以写成矩阵形式：\n$$\n\\frac{d}{dt} \\begin{pmatrix} I \\\\ V \\end{pmatrix} = \\begin{pmatrix} -\\delta & \\beta T_0 \\\\ p & -c \\end{pmatrix} \\begin{pmatrix} I \\\\ V \\end{pmatrix}\n$$\n如果原点 $(I,V) = (0,0)$ 是一个不稳定的平衡点，感染将会增长。这种不稳定性由系统雅可比矩阵 $J$ 的特征值决定：\n$$\nJ = \\begin{pmatrix} -\\delta & \\beta T_0 \\\\ p & -c \\end{pmatrix}\n$$\n特征值 $\\lambda$ 是特征方程 $\\det(J - \\lambda \\mathcal{I}) = 0$ 的根，其中 $\\mathcal{I}$ 是单位矩阵。\n$$\n\\det \\begin{pmatrix} -\\delta - \\lambda & \\beta T_0 \\\\ p & -c - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-\\delta - \\lambda)(-c - \\lambda) - (p)(\\beta T_0) = 0\n$$\n$$\n\\lambda^2 + (c + \\delta)\\lambda + c\\delta - p\\beta T_0 = 0\n$$\n为了使感染增长，至少有一个特征值必须具有正实部。设两个特征值为 $\\lambda_1$ 和 $\\lambda_2$。根据二次方程的韦达定理，我们有：\n$$\n\\text{Trace}(J) = \\lambda_1 + \\lambda_2 = -(c + \\delta)\n$$\n$$\n\\det(J) = \\lambda_1 \\lambda_2 = c\\delta - p\\beta T_0\n$$\n由于参数 $c$ 和 $\\delta$ 是速率，它们是正的，所以 $c > 0$ 且 $\\delta > 0$。因此，矩阵的迹 $\\lambda_1 + \\lambda_2$ 总是负的。如果特征值是复共轭对，其实部将是 $-(c+\\delta)/2  0$，导致衰减。因此，要发生增长，特征值必须是实数，并且至少有一个是正数。如果 $\\lambda_1 + \\lambda_2  0$，要使其中一个特征值为正，另一个必须为负。这当且仅当它们的乘积为负时发生。\n因此，增长的条件是 $\\lambda_1 \\lambda_2  0$：\n$$\nc\\delta - p\\beta T_0  0\n$$\n$$\np\\beta T_0 > c\\delta\n$$\n两边同除以 $c\\delta$（为正值），我们得到：\n$$\n\\frac{p\\beta T_0}{c\\delta} > 1\n$$\n识别出第一部分推导出的 $R_{\\mathrm{intra}}$ 表达式，病毒载量初始增长的条件是：\n$$\nR_{\\mathrm{intra}} > 1\n$$\n\n**第三部分：$R_{\\mathrm{intra}}$ 的数值评估**\n\n最后一步是使用给定的参数值计算 $R_{\\mathrm{intra}}$ 的值：\n$T_0 = 0.9$\n$\\beta = 0.60\\,\\text{day}^{-1}$\n$p = 50\\,\\text{day}^{-1}$\n$\\delta = 1.0\\,\\text{day}^{-1}$\n$c = 10.0\\,\\text{day}^{-1}$\n\n使用推导出的公式：\n$$\nR_{\\mathrm{intra}} = \\frac{p \\beta T_0}{c \\delta} = \\frac{(50\\,\\text{day}^{-1}) (0.60\\,\\text{day}^{-1}) (0.9)}{(10.0\\,\\text{day}^{-1}) (1.0\\,\\text{day}^{-1})}\n$$\n单位相互抵消，证实了 $R_{\\mathrm{intra}}$ 是无量纲的。\n$$\nR_{\\mathrm{intra}} = \\frac{50 \\times 0.60 \\times 0.9}{10.0 \\times 1.0} = \\frac{27}{10} = 2.7\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\nR_{\\mathrm{intra}} = 2.70\n$$\n由于 $R_{\\mathrm{intra}} = 2.70 > 1$，模型预测具有这些参数的感染在初始阶段将会增长。",
            "answer": "$$\n\\boxed{2.70}\n$$"
        },
        {
            "introduction": "在病毒成功建立感染后，下一个关键问题是它如何与宿主的免疫系统相互作用。病毒的免疫逃逸，特别是下调主要组织相容性复合体I类（MHC-I）分子，是一个核心策略。然而，这带来了一个微妙的权衡：虽然可以逃避CD8+ T细胞的监视，但却会使受感染的细胞更容易被自然杀伤（NK）细胞通过“缺失自我”（missing-self）识别机制清除。本练习通过一个简洁的优化模型来探讨病毒在这种战略困境中的最佳选择，帮助您深入理解病毒与宿主之间共同进化的“军备竞赛”。",
            "id": "4635787",
            "problem": "在严重急性呼吸综合征冠状病毒2（SARS-CoV-2）感染气道上皮细胞的过程中，病毒蛋白（如开放阅读框8（ORF8））可以降低经典I类主要组织相容性复合体（MHC-I）分子（人类白细胞抗原A、B和C）的表面密度，从而减少向分化簇8（CD8）细胞毒性T淋巴细胞（CTLs）的肽呈递。相反，自然杀伤（NK）细胞执行“失我”识别：当来自经典MHC-I的抑制信号减弱时，它们会产生细胞毒性，此过程受到应激诱导的活化受体（如自然杀伤细胞受体2族D成员（NKG2D））的连接调控，以及通过非经典人类白细胞抗原E（HLA-E）与CD94/NKG2A结合所提供的抑制性输入的调控。\n\n考虑一个简单的决策模型，用于单个受感染的上皮细胞，该细胞可以调节其标准化的经典MHC-I水平 $m \\in [0,1]$。设瞬时CTL介导的杀伤风险与经典MHC-I的数量成正比，即 $h_{\\mathrm{CTL}}(m) = a\\,m$，其中 $a > 0$ 捕捉了效应CD8 T细胞的丰度和亲和力。设瞬时NK介导的杀伤风险与一个活化配体尺度 $g > 0$ 和“失我”程度 $(1 - m)$ 成正比，并与HLA-E–NKG2A抑制信号的强度成反比，该强度建模为 $(1 + \\gamma e)$，其中 $\\gamma > 0$ 且 $e \\ge 0$ 表示标准化的HLA-E表达；即 $h_{\\mathrm{NK}}(m,e) = \\dfrac{b\\,g\\,(1 - m)}{1 + \\gamma e}$，其中 $b > 0$ 反映了最大的NK细胞毒性潜力。假设这两个过程相互独立，因此总清除风险为 $h(m) = h_{\\mathrm{CTL}}(m) + h_{\\mathrm{NK}}(m,e)$。\n\n在这些假设下，下列哪个陈述正确地描述了最小化 $h(m)$ 的 $m$ 的最优选择？\n\nA. 使风险最小化的选择 $m^{\\ast}$ 为：如果 $a > \\dfrac{b\\,g}{1 + \\gamma e}$，则 $m^{\\ast} = 0$；如果 $a  \\dfrac{b\\,g}{1 + \\gamma e}$，则 $m^{\\ast} = 1$；当 $a = \\dfrac{b\\,g}{1 + \\gamma e}$ 时，风险函数对于 $m$ 是平坦的，因此任何 $m \\in [0,1]$ 都会产生相同的清除风险。\n\nB. 使风险最小化的选择 $m^{\\ast}$ 为：如果 $a  \\dfrac{b\\,g}{1 + \\gamma e}$，则 $m^{\\ast} = 0$；否则 $m^{\\ast} = 1$。\n\nC. 在呼吸道上皮细胞中，使风险最小化的选择总是 $m^{\\ast} = 0$，因为NK细胞的“失我”识别总是主导CD8 T细胞的监视。\n\nD. 使风险最小化的选择总是 $m^{\\ast} = 1$，因为非经典HLA-E完全抑制NK细胞，而与它的表达水平和活化配体无关。\n\nE. 当 $0  \\dfrac{a\\,(1 + \\gamma e)}{b\\,g}  1$ 时，存在一个内部最小值点 $m^{\\ast} = 1 - \\dfrac{a\\,(1 + \\gamma e)}{b\\,g}$；否则适用边界值。",
            "solution": "### 第1步：提取已知条件\n\n问题提供了以下定义和方程：\n-   **经典MHC-I水平**：$m \\in [0,1]$，一个标准化变量。\n-   **CTL介导的杀伤风险**：$h_{\\mathrm{CTL}}(m) = a\\,m$，其中 $a > 0$。\n-   **NK介导的杀伤风险**：$h_{\\mathrm{NK}}(m,e) = \\dfrac{b\\,g\\,(1 - m)}{1 + \\gamma e}$，其中 $b > 0$，$g > 0$，$\\gamma > 0$ 且 $e \\ge 0$。这里 $e$ 是标准化的HLA-E表达。\n-   **总清除风险**：$h(m) = h_{\\mathrm{CTL}}(m) + h_{\\mathrm{NK}}(m,e)$。\n-   **目标**：通过选择一个最优的经典MHC-I水平 $m^{\\ast}$ 来最小化总清除风险 $h(m)$。\n\n### 第2步：使用提取的已知条件进行验证\n\n问题陈述是一个基于已确立的免疫学原理（CTL与NK细胞对受感染细胞的识别）的数学建模练习。\n-   **科学依据**：该前提基于有充分记录的病毒MHC-I下调现象，以及CD8 T细胞和NK细胞在抗病毒免疫中的双重作用。该模型虽然简化，但抓住了本质的权衡关系：高MHC-I增加CTL杀伤，而低MHC-I增加NK杀伤。这是免疫病毒学中的一个标准概念。\n-   **适定性**：问题是在一个紧集 $[0,1]$ 上最小化函数 $h(m)$。该函数是良定义且连续的。问题要求找出最小化该函数的 $m$ 值。根据极值定理，解保证存在。该问题在数学上是明确的。\n-   **客观性**：语言精确且量化。所有变量和参数都有定义。问题设置中没有主观或基于观点的陈述。\n-   **一致性与完整性**：问题是自洽的。它提供了找到最优 $m$ 所需的所有方程和约束条件。没有矛盾之处。\n\n### 第3步：结论与行动\n\n该问题是**有效的**。它是一个适定的、有科学依据的、客观的优化问题。我现在将进行求解。\n\n### 最优MHC-I水平的推导\n\n目标是找到 $m^{\\ast} \\in [0,1]$，以最小化总清除风险 $h(m)$。\n总风险函数为：\n$$\nh(m) = h_{\\mathrm{CTL}}(m) + h_{\\mathrm{NK}}(m,e) = a\\,m + \\frac{b\\,g\\,(1 - m)}{1 + \\gamma e}\n$$\n\n我们可以重写 $h(m)$ 以分离出与 $m$ 相关的项：\n$$\nh(m) = a\\,m + \\frac{b\\,g}{1 + \\gamma e} - \\frac{b\\,g}{1 + \\gamma e} m\n$$\n合并含有 $m$ 的项，我们得到：\n$$\nh(m) = \\left(a - \\frac{b\\,g}{1 + \\gamma e}\\right) m + \\frac{b\\,g}{1 + \\gamma e}\n$$\n这是一个关于 $m$ 的线性函数，形式为 $h(m) = S \\cdot m + C$，其中斜率 $S$ 由下式给出：\n$$\nS = a - \\frac{b\\,g}{1 + \\gamma e}\n$$\n而常数项（y轴截距）是 $C = \\dfrac{b\\,g}{1 + \\gamma e}$。\n\n一个线性函数在闭区间（如 $[0,1]$）上的最小值必然出现在边界点之一。具体是哪个边界点取决于斜率 $S$ 的符号。\n\n1.  **情况1：斜率 $S$ 为正 ($S > 0$)。**\n    这种情况发生在 $a - \\dfrac{b\\,g}{1 + \\gamma e} > 0$ 时，等价于 $a > \\dfrac{b\\,g}{1 + \\gamma e}$。\n    如果斜率为正，函数 $h(m)$ 是严格递增的。因此，在 $m$ 的最小可能值处达到最小值，即 $m^{\\ast} = 0$。\n\n2.  **情况2：斜率 $S$ 为负 ($S  0$)。**\n    这种情况发生在 $a - \\dfrac{b\\,g}{1 + \\gamma e}  0$ 时，等价于 $a  \\dfrac{b\\,g}{1 + \\gamma e}$。\n    如果斜率为负，函数 $h(m)$ 是严格递减的。因此，在 $m$ 的最大可能值处达到最小值，即 $m^{\\ast} = 1$。\n\n3.  **情况3：斜率 $S$ 为零 ($S = 0$)。**\n    这种情况发生在 $a - \\dfrac{b\\,g}{1 + \\gamma e} = 0$ 时，等价于 $a = \\dfrac{b\\,g}{1 + \\gamma e}$。\n    如果斜率为零，函数 $h(m)$ 对所有 $m \\in [0,1]$ 都是常数。在这种情况下，区间 $[0,1]$ 中的任何 $m$ 值都会得到相同的最小风险。\n\n### 逐项分析\n\n现在我们基于此推导来评估每个选项。\n\n**A. 使风险最小化的选择 $m^{\\ast}$ 为：如果 $a > \\dfrac{b\\,g}{1 + \\gamma e}$，则 $m^{\\ast} = 0$；如果 $a  \\dfrac{b\\,g}{1 + \\gamma e}$，则 $m^{\\ast} = 1$；当 $a = \\dfrac{b\\,g}{1 + \\gamma e}$ 时，风险函数对于 $m$ 是平坦的，因此任何 $m \\in [0,1]$ 都会产生相同的清除风险。**\n这个陈述与我们推导出的三种情况完全匹配。\n-   当 $a > \\dfrac{b\\,g}{1 + \\gamma e}$ 时，$m^{\\ast} = 0$ (匹配情况1)。\n-   当 $a  \\dfrac{b\\,g}{1 + \\gamma e}$ 时，$m^{\\ast} = 1$ (匹配情况2)。\n-   当 $a = \\dfrac{b\\,g}{1 + \\gamma e}$ 时，任何 $m \\in [0,1]$ 都是最优的 (匹配情况3)。\n结论：**正确**。\n\n**B. 使风险最小化的选择 $m^{\\ast}$ 为：如果 $a  \\dfrac{b\\,g}{1 + \\gamma e}$，则 $m^{\\ast} = 0$；否则 $m^{\\ast} = 1$。**\n这个选项陈述当 $a  \\dfrac{b\\,g}{1 + \\gamma e}$ 时，$m^{\\ast}=0$。我们的分析表明，在这种情况下，斜率为负，最小值在 $m^{\\ast}=1$ 处。该选项颠倒了从模型推导出的条件。\n结论：**不正确**。\n\n**C. 在呼吸道上皮细胞中，使风险最小化的选择总是 $m^{\\ast} = 0$，因为NK细胞的“失我”识别总是主导CD8 T细胞的监视。**\n这是一个绝对的陈述（“总是 $m^{\\ast} = 0$”），与我们的分析相矛盾。模型显示，如果CTL反应足够弱（即，$a$ 足够小以至于 $a  \\dfrac{b\\,g}{1 + \\gamma e}$），受感染细胞的最优策略是设置 $m^{\\ast}=1$。该模型旨在探索这种权衡，而不是假设免疫系统的某一个分支总是占主导地位。\n结论：**不正确**。\n\n**D. 使风险最小化的选择总是 $m^{\\ast} = 1$，因为非经典HLA-E完全抑制NK细胞，而与它的表达水平和活化配体无关。**\n这是另一个绝对的陈述（“总是 $m^{\\ast} = 1$”），与我们的分析相矛盾。如果CTL反应足够强（$a > \\dfrac{b\\,g}{1 + \\gamma e}$），最优策略是 $m^{\\ast}=0$。此外，所提供的理由与模型的方程不一致。NK风险 $h_{\\mathrm{NK}}$ 与 $(1 + \\gamma e)$ 成反比，因此抑制作用*确实*取决于HLA-E表达水平 $e$。它也取决于活化配体尺度 $g$。\n结论：**不正确**。\n\n**E. 当 $0  \\dfrac{a\\,(1 + \\gamma e)}{b\\,g}  1$ 时，存在一个内部最小值点 $m^{\\ast} = 1 - \\dfrac{a\\,(1 + \\gamma e)}{b\\,g}$；否则适用边界值。**\n函数 $h(m)$ 是关于 $m$ 的线性函数。一个闭区间上的线性函数不可能有唯一的内部最小值。它的最小值必须位于边界上，除非函数是常数（斜率为零），在这种情况下所有点都是最小值点。$h(m)$ 对 $m$ 的导数是常数斜率 $S = a - \\dfrac{b\\,g}{1 + \\gamma e}$。将其设为零并不能得到 $m$ 的解，而是得到一个关于参数的条件。二阶导数是 $\\dfrac{d^2h}{dm^2} = 0$，不满足严格局部最小值的条件（$\\dfrac{d^2h}{dm^2} > 0$）。因此，不存在唯一的内部最小值点。\n结论：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "最后，我们将视角从细胞层面扩展到系统层面，探究COVID-19重症病理学的关键驱动因素——“细胞因子风暴”。细胞因子之间复杂的相互作用网络可以被视为一个动态系统，其行为决定了免疫反应的走向。本练习提供了一个从时间序列数据中进行系统辨识（system identification）的实践机会，这在系统生物学中是一项强大的技术。您将学习如何拟合一个线性常微分方程模型，并通过分析其特征值来判断细胞因子网络的动态行为是稳定的、单调增长的还是振荡的。",
            "id": "4635827",
            "problem": "一个基于2019冠状病毒病（COVID-19）发病机制的机理问题是，白细胞介素-6（IL-6）、白细胞介素-1β（IL-1β）和肿瘤坏死因子（TNF）的短期细胞因子网络是呈现振荡动力学还是单调动力学。已知严重急性呼吸综合征冠状病毒2（SARS-CoV-2）感染会诱导失调的细胞因子反应，而在准稳态附近的线性化提供了一个有原则的局部模型。假设细胞因子浓度构成一个状态向量 $\\mathbf{C}(t) = [C_{\\mathrm{IL6}}(t), C_{\\mathrm{IL1\\beta}}(t), C_{\\mathrm{TNF}}(t)]^\\top$，其局部由一个线性时不变（LTI）的常微分方程（ODE）控制：$$\\frac{d \\mathbf{C}(t)}{dt} = \\mathbf{K}\\,\\mathbf{C}(t) + \\mathbf{p},$$ 其中 $\\mathbf{K} \\in \\mathbb{R}^{3 \\times 3}$ 是相互作用与清除雅可比矩阵，$\\mathbf{p} \\in \\mathbb{R}^{3}$ 是一个代表基线来源的恒定净生产向量。在此表示下，$\\mathbf{K}$ 的复值特征值的存在表示振荡模式，而纯实数特征值则意味着单调动力学（无振荡的增长或衰减）。\n\n给定离散时间点 $t_k$（单位为小时）的时间序列测量值，细胞因子浓度单位为 $\\mathrm{pg}/\\mathrm{mL}$。请使用有限差分近似来估计在采样时间点的 $\\frac{d\\mathbf{C}}{dt}$，然后通过最小化所有时间点上估计导数与 $\\mathbf{K}\\mathbf{C} + \\mathbf{p}$ 之间残差平方和的普通最小二乘法来拟合 $\\mathbf{K}$ 和 $\\mathbf{p}$。在估计出 $\\mathbf{K}$ 后，计算其特征值，并使用以下规则判断是振荡动力学还是单调动力学：如果任何特征值的虚部绝对值超过数值容差 $\\epsilon = 10^{-6}$，则分类为振荡；否则分类为单调。每个测试用例的分类结果应以布尔值的形式返回。\n\n推导约束和数值程序：\n- 对于内部时间点 $t_k$（$k \\in \\{1,\\ldots,N-2\\}$），其有限差分导数必须使用中心差分 $$\\frac{d \\mathbf{C}}{dt}\\Big|_{t_k} \\approx \\frac{\\mathbf{C}(t_{k+1}) - \\mathbf{C}(t_{k-1})}{t_{k+1} - t_{k-1}}.$$ 对于端点，在 $t_0$ 处使用前向差分：$$\\frac{d \\mathbf{C}}{dt}\\Big|_{t_0} \\approx \\frac{\\mathbf{C}(t_{1}) - \\mathbf{C}(t_{0})}{t_{1} - t_{0}},$$ 在 $t_{N-1}$ 处使用后向差分：$$\\frac{d \\mathbf{C}}{dt}\\Big|_{t_{N-1}} \\approx \\frac{\\mathbf{C}(t_{N-1}) - \\mathbf{C}(t_{N-2})}{t_{N-1} - t_{N-2}}.$$\n- 逐行拟合 $\\mathbf{K}$：对于每种细胞因子 $i \\in \\{\\mathrm{IL6}, \\mathrm{IL1\\beta}, \\mathrm{TNF}\\}$，将导数分量 $y_i(t_k)$ 对预测变量 $[C_{\\mathrm{IL6}}(t_k), C_{\\mathrm{IL1\\beta}}(t_k), C_{\\mathrm{TNF}}(t_k), 1]$ 进行回归，以通过普通最小二乘法估计系数 $[K_{i1}, K_{i2}, K_{i3}, p_i]$。\n\n测试套件（时间单位为小时，浓度单位为 $\\mathrm{pg}/\\mathrm{mL}$）：\n- 案例1（预期耦合，可能振荡）：时间 $\\{\\,0,\\,2,\\,4,\\,6,\\,8,\\,10\\,\\}$；$C_{\\mathrm{IL6}}(t_k)$ 值 $\\{\\,40,\\,62,\\,48,\\,46,\\,55,\\,60\\,\\}$；$C_{\\mathrm{IL1\\beta}}(t_k)$ 值 $\\{\\,30,\\,14,\\,26,\\,32,\\,24,\\,18\\,\\}$；$C_{\\mathrm{TNF}}(t_k)$ 值 $\\{\\,15,\\,16.5,\\,16.8,\\,16.9,\\,17.0,\\,17.05\\,\\}$。\n- 案例2（预期单调趋向更高水平）：时间 $\\{\\,0,\\,2,\\,4,\\,6,\\,8,\\,10\\,\\}$；$C_{\\mathrm{IL6}}(t_k)$ 值 $\\{\\,30,\\,40,\\,47,\\,51,\\,53,\\,54\\,\\}$；$C_{\\mathrm{IL1\\beta}}(t_k)$ 值 $\\{\\,12,\\,16,\\,19,\\,21,\\,22.2,\\,22.8\\,\\}$；$C_{\\mathrm{TNF}}(t_k)$ 值 $\\{\\,8,\\,10,\\,12,\\,13,\\,13.5,\\,13.8\\,\\}$。\n- 案例3（边缘案例，信号接近常数且微弱漂移）：时间 $\\{\\,0,\\,2,\\,4,\\,6,\\,8,\\,10\\,\\}$；$C_{\\mathrm{IL6}}(t_k)$ 值 $\\{\\,50,\\,50.4,\\,50.8,\\,51.0,\\,51.1,\\,51.15\\,\\}$；$C_{\\mathrm{IL1\\beta}}(t_k)$ 值 $\\{\\,18,\\,18.05,\\,18.1,\\,18.15,\\,18.2,\\,18.25\\,\\}$；$C_{\\mathrm{TNF}}(t_k)$ 值 $\\{\\,12,\\,12.02,\\,12.03,\\,12.035,\\,12.04,\\,12.045\\,\\}$。\n\n你的程序必须为每个案例实现所述的估计和分类过程，并生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，`[result1,result2,result3]`），每个结果都是一个布尔值，指示动力学是振荡（$\\mathrm{True}$）还是单调（$\\mathrm{False}$）。输出中不需要单位。在判断振荡行为时，请使用指定的有限差分公式和虚部的容差 $\\epsilon = 10^{-6}$。",
            "solution": "该问题要求我们确定一个由白细胞介素-6（$C_{\\mathrm{IL6}}$）、白细胞介素-1β（$C_{\\mathrm{IL1\\beta}}$）和肿瘤坏死因子（$C_{\\mathrm{TNF}}$）组成的三方细胞因子网络的短期动力学是振荡的还是单调的。该动力学由一个线性时不变（LTI）的常微分方程（ODE）系统建模：\n$$\n\\frac{d \\mathbf{C}(t)}{dt} = \\mathbf{K}\\,\\mathbf{C}(t) + \\mathbf{p}\n$$\n其中 $\\mathbf{C}(t) = [C_{\\mathrm{IL6}}(t), C_{\\mathrm{IL1\\beta}}(t), C_{\\mathrm{TNF}}(t)]^\\top$ 是细胞因子浓度的状态向量，$\\mathbf{K} \\in \\mathbb{R}^{3 \\times 3}$ 是表示相互作用和清除率的雅可比矩阵，$\\mathbf{p} \\in \\mathbb{R}^{3}$ 是一个表示基线生产率的常数向量。\n\n动力学的性质（振荡 vs. 单调）由矩阵 $\\mathbf{K}$ 的特征值决定。共轭复数特征值对应于振荡模式，而纯实数特征值对应于单调的增长或衰减模式。我们的任务是从离散时间序列数据中估计 $\\mathbf{K}$ 和 $\\mathbf{p}$，然后根据估计的 $\\hat{\\mathbf{K}}$ 的特征值对动力学进行分类。该过程包括三个主要步骤：数值微分、通过普通最小二乘法（OLS）进行参数估计以及特征值分析。\n\n**步骤1：导数估计**\n\n给定每种细胞因子浓度 $C_i(t_k)$ 在 $N$ 个离散时间点 $t_0, t_1, \\ldots, t_{N-1}$ 的时间序列数据，我们必须首先估计每个点的时间导数 $\\frac{d\\mathbf{C}}{dt}$。问题指定使用有限差分公式。\n\n对于第一个时间点 $t_0$，使用一阶前向差分：\n$$\n\\frac{d \\mathbf{C}}{dt}\\Big|_{t_0} \\approx \\frac{\\mathbf{C}(t_{1}) - \\mathbf{C}(t_{0})}{t_{1} - t_{0}}\n$$\n\n对于所有内部时间点 $t_k$（$k \\in \\{1, \\ldots, N-2\\}$），使用二阶中心差分以提高精度：\n$$\n\\frac{d \\mathbf{C}}{dt}\\Big|_{t_k} \\approx \\frac{\\mathbf{C}(t_{k+1}) - \\mathbf{C}(t_{k-1})}{t_{k+1} - t_{k-1}}\n$$\n\n对于最后一个时间点 $t_{N-1}$，使用一阶后向差分：\n$$\n\\frac{d \\mathbf{C}}{dt}\\Big|_{t_{N-1}} \\approx \\frac{\\mathbf{C}(t_{N-1}) - \\mathbf{C}(t_{N-2})}{t_{N-1} - t_{N-2}}\n$$\n\n将这些公式应用于给定的三种细胞因子数据，可以在 $N$ 个时间点上得到导数向量 $\\frac{d\\mathbf{C}}{dt}$ 的数值估计。我们用 $\\dot{\\mathbf{C}}_{\\text{est}}$ 表示估计的导数矩阵，这是一个 $N \\times 3$ 矩阵，每列对应一种细胞因子。\n\n**步骤2：通过普通最小二乘法（OLS）进行系统辨识**\n\nLTI模型可以为每种细胞因子 $i \\in \\{\\mathrm{IL6}, \\mathrm{IL1\\beta}, \\mathrm{TNF}\\}$ 在每个时间点 $t_k$ 写成：\n$$\n\\frac{dC_i}{dt}\\Big|_{t_k} = K_{i1} C_{\\mathrm{IL6}}(t_k) + K_{i2} C_{\\mathrm{IL1\\beta}}(t_k) + K_{i3} C_{\\mathrm{TNF}}(t_k) + p_i\n$$\n这里，项 $[K_{i1}, K_{i2}, K_{i3}]$ 构成矩阵 $\\mathbf{K}$ 的第 $i$ 行，而 $p_i$ 是向量 $\\mathbf{p}$ 的第 $i$ 个分量。\n\n这是一个多元线性回归问题。我们可以为每种细胞因子独立求解未知参数。对于单个细胞因子 $i$，我们在所有 $N$ 个时间点上构建一个系统：\n$$\n\\begin{pmatrix}\n\\dot{C}_{i,\\text{est}}(t_0) \\\\\n\\dot{C}_{i,\\text{est}}(t_1) \\\\\n\\vdots \\\\\n\\dot{C}_{i,\\text{est}}(t_{N-1})\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nC_{\\mathrm{IL6}}(t_0)  C_{\\mathrm{IL1\\beta}}(t_0)  C_{\\mathrm{TNF}}(t_0)  1 \\\\\nC_{\\mathrm{IL6}}(t_1)  C_{\\mathrm{IL1\\beta}}(t_1)  C_{\\mathrm{TNF}}(t_1)  1 \\\\\n\\vdots  \\vdots  \\vdots  \\vdots \\\\\nC_{\\mathrm{IL6}}(t_{N-1})  C_{\\mathrm{IL1\\beta}}(t_{N-1})  C_{\\mathrm{TNF}}(t_{N-1})  1\n\\end{pmatrix}\n\\begin{pmatrix}\nK_{i1} \\\\\nK_{i2} \\\\\nK_{i3} \\\\\np_i\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n\\varepsilon_0 \\\\\n\\varepsilon_1 \\\\\n\\vdots \\\\\n\\varepsilon_{N-1}\n\\end{pmatrix}\n$$\n这可以写成紧凑的矩阵形式 $\\mathbf{y}_i = \\mathbf{X} \\mathbf{\\beta}_i + \\mathbf{\\varepsilon}_i$。设计矩阵 $\\mathbf{X}$ 是一个 $N \\times 4$ 矩阵，其前三列是浓度时间序列，最后一列是全为1的向量，以考虑截距项 $p_i$。向量 $\\mathbf{y}_i$ 是细胞因子 $i$ 的 $N \\times 1$ 估计导数向量。向量 $\\mathbf{\\beta}_i = [K_{i1}, K_{i2}, K_{i3}, p_i]^\\top$ 包含待估计的参数。\n\nOLS解 $\\hat{\\mathbf{\\beta}}_i$ 最小化残差平方和 $\\|\\mathbf{y}_i - \\mathbf{X} \\mathbf{\\beta}_i\\|^2$，由下式给出：\n$$\n\\hat{\\mathbf{\\beta}}_i = (\\mathbf{X}^\\top \\mathbf{X})^{-1} \\mathbf{X}^\\top \\mathbf{y}_i\n$$\n对三种细胞因子（$i = 1, 2, 3$）中的每一种都执行此计算，以获得 $\\mathbf{K}$ 和 $\\mathbf{p}$ 所有元素的估计值。得到的估计雅可比矩阵为 $\\hat{\\mathbf{K}} \\in \\mathbb{R}^{3 \\times 3}$。\n\n**步骤3：特征值分析与分类**\n\n一旦估计出矩阵 $\\hat{\\mathbf{K}}$，就计算其特征值 $\\lambda_j$（$j=1, 2, 3$）。特征值是特征方程 $\\det(\\hat{\\mathbf{K}} - \\lambda \\mathbf{I}) = 0$ 的根。这些特征值可以是实数或复数。\n\n分类规则如下：\n- 如果任何特征值 $\\lambda_j$ 具有非零虚部，则系统表现出振荡行为。为考虑数值精度，如果存在至少一个特征值 $\\lambda_j$ 使得 $|\\text{Im}(\\lambda_j)| > \\epsilon$，我们就将动力学分类为**振荡**，其中容差 $\\epsilon = 10^{-6}$。\n- 如果所有特征值的虚部都在此容差范围内，即对于所有 $j=1, 2, 3$ 都有 $|\\text{Im}(\\lambda_j)| \\leq \\epsilon$，则动力学被分类为**单调**。\n\n将此完整过程应用于提供的三个测试用例，以确定在给定条件下细胞因子网络动力学的性质。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef analyze_dynamics(times, c_il6, c_il1b, c_tnf, tolerance=1e-6):\n    \"\"\"\n    Analyzes cytokine time series data to classify dynamics as oscillatory or monotonic.\n\n    This function performs the following steps:\n    1.  Estimates the time derivatives of cytokine concentrations using finite differences.\n    2.  Constructs a design matrix from the concentration data.\n    3.  Uses ordinary least squares to fit the parameters of the LTI model dC/dt = K*C + p.\n    4.  Computes the eigenvalues of the estimated interaction matrix K.\n    5.  Classifies the dynamics as oscillatory if any eigenvalue has a significant imaginary part.\n\n    Args:\n        times (np.ndarray): Array of time points.\n        c_il6 (np.ndarray): Array of IL-6 concentrations.\n        c_il1b (np.ndarray): Array of IL-1beta concentrations.\n        c_tnf (np.ndarray): Array of TNF concentrations.\n        tolerance (float): Numerical tolerance for checking if an imaginary part is non-zero.\n\n    Returns:\n        bool: True for oscillatory dynamics, False for monotonic dynamics.\n    \"\"\"\n    # 1. Assemble concentration data into a single matrix C\n    # C is an N x 3 matrix where N is the number of time points.\n    C = np.vstack([c_il6, c_il1b, c_tnf]).T\n    n_points = len(times)\n    \n    # 2. Estimate derivatives using finite differences\n    dCdt = np.zeros_like(C)\n    \n    # Forward difference for the first point (t_0)\n    dCdt[0, :] = (C[1, :] - C[0, :]) / (times[1] - times[0])\n    \n    # Central difference for interior points (t_1 to t_{N-2})\n    for k in range(1, n_points - 1):\n        dCdt[k, :] = (C[k + 1, :] - C[k - 1, :]) / (times[k + 1] - times[k - 1])\n        \n    # Backward difference for the last point (t_{N-1})\n    dCdt[-1, :] = (C[-1, :] - C[-2, :]) / (times[-1] - times[-2])\n    \n    # 3. Perform Ordinary Least Squares (OLS) to find K and p\n    # The model is dC/dt = K*C + p, which can be expressed for regression as\n    # dCdt = [C, 1] * [K^T, p^T]^T\n    # We solve this row-wise for each cytokine.\n\n    # Design matrix X (N x 4) with concentrations and an intercept term\n    X = np.hstack([C, np.ones((n_points, 1))])\n    \n    # Estimated Jacobian matrix K\n    K_hat = np.zeros((3, 3))\n    \n    # For each cytokine, regress its derivative onto the concentrations\n    for i in range(3):\n        y_i = dCdt[:, i]\n        # lstsq solves X * beta = y_i for beta\n        # beta will contain [K_i1, K_i2, K_i3, p_i]\n        beta_i, _, _, _ = np.linalg.lstsq(X, y_i, rcond=None)\n        \n        # The first 3 elements of beta_i form the i-th row of K\n        K_hat[i, :] = beta_i[:3]\n        \n    # 4. Compute eigenvalues of the estimated matrix K\n    eigenvalues = np.linalg.eigvals(K_hat)\n    \n    # 5. Classify dynamics based on the imaginary part of the eigenvalues\n    is_oscillatory = np.any(np.abs(np.imag(eigenvalues)) > tolerance)\n    \n    return is_oscillatory\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        (\n            np.array([0, 2, 4, 6, 8, 10], dtype=float),\n            np.array([40, 62, 48, 46, 55, 60], dtype=float),\n            np.array([30, 14, 26, 32, 24, 18], dtype=float),\n            np.array([15, 16.5, 16.8, 16.9, 17.0, 17.05], dtype=float),\n        ),\n        # Case 2\n        (\n            np.array([0, 2, 4, 6, 8, 10], dtype=float),\n            np.array([30, 40, 47, 51, 53, 54], dtype=float),\n            np.array([12, 16, 19, 21, 22.2, 22.8], dtype=float),\n            np.array([8, 10, 12, 13, 13.5, 13.8], dtype=float),\n        ),\n        # Case 3\n        (\n            np.array([0, 2, 4, 6, 8, 10], dtype=float),\n            np.array([50, 50.4, 50.8, 51.0, 51.1, 51.15], dtype=float),\n            np.array([18, 18.05, 18.1, 18.15, 18.2, 18.25], dtype=float),\n            np.array([12, 12.02, 12.03, 12.035, 12.04, 12.045], dtype=float),\n        ),\n    ]\n\n    results = []\n    for case in test_cases:\n        times, c_il6, c_il1b, c_tnf = case\n        result = analyze_dynamics(times, c_il6, c_il1b, c_tnf)\n        results.append(str(result))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}