{
    "hands_on_practices": [
        {
            "introduction": "理解腹泻背后的具体机制对于胃肠炎的诊断和管理至关重要。粪便渗透压差（stool osmotic gap）是一种强大的定量工具，可以帮助临床医生区分渗透性腹泻和分泌性腹泻。在本练习中 ，您将从基本原理出发，推导这一重要的临床指标，并将其应用于假设的患者数据，从而推断出由诺如病毒感染驱动的主要病理生理过程。",
            "id": "4674305",
            "problem": "对因大量水样腹泻入院的成年人进行了一项急性诺如病毒性胃肠炎的队列研究。研究人员在一名典型患者发病后的最初24小时内获取其新鲜粪便样本，并测量了以下物理量：粪便渗透压浓度（单位：毫渗透摩尔/千克）、粪便钠离子浓度（单位：毫摩尔/升）和粪便钾离子浓度（单位：毫摩尔/升）。测量值如下：粪便渗透压浓度 $= 315$，粪便钠浓度 $= 25$，粪便钾浓度 $= 15$。\n\n请从适用于胃肠生理学和物理化学的第一性原理出发，并以如下基本事实为基础：\n- 依数性表明，溶液的渗透压浓度等于所有溶质贡献的有效渗透摩尔量之和。\n- 在生理温度下的水溶液中，诸如氯化钠和氯化钾之类的强电解质会解离成离子，其贡献的渗透摩尔量约与溶质颗粒的数量成正比。\n- 粪便液是电中性的，因此阳离子总浓度等于阴离子总浓度。\n\n在此基础上，请推导一个表达式，将可测量的粪便渗透压浓度与粪便中主要电解质的渗透贡献及非电解质（例如，未吸收的碳水化合物）的贡献联系起来。然后，应用您推导的表达式计算该患者的粪便渗透压差的定量值。使用这个计算出的量来判断该腹泻主要是分泌性还是渗透性，并推断诺如病毒感染的主要机制，同时提供植根于小肠病理生理学的生理学解释。\n\n请以毫渗透摩尔/千克为单位表示最终计算出的粪便渗透压差，并将您的答案四舍五入至三位有效数字。您报告的最终数值必须仅为粪便渗透压差；不要在最终的数值答案中包含任何分类性解释。",
            "solution": "该问题被评估为有效，因为它在科学上基于胃肠生理学和物理化学的既定原理，提法恰当，有足够的数据得出唯一解，并以客观、正式的语言表述。其中没有矛盾、歧义或事实不准确之处。\n\n该问题要求推导粪便渗透压差，为特定患者计算其值，并结合诺如病毒的病理生理学背景对结果进行解释。\n\n首先，我们根据给定的第一性原理推导粪便渗透压差的表达式。\n设 $O_{\\text{measured}}$ 为测得的总粪便渗透压浓度。根据提供的第一条原理（基于依数性），这个总渗透压浓度是粪便水中所有溶质贡献的总和。这些溶质可分为电解质和非电解质。\n$$O_{\\text{measured}} = O_{\\text{electrolytes}} + O_{\\text{non-electrolytes}}$$\n粪便渗透压差，我们记为 $O_{\\text{gap}}$，其定义为总渗透压浓度中，除主要电解质外其他渗透活性物质所占的部分。这些物质通常是未吸收的碳水化合物和其他有机分子。因此，渗透压差等同于非电解质组分的渗透压浓度。\n$$O_{\\text{gap}} \\equiv O_{\\text{non-electrolytes}}$$\n将此定义代入第一个方程，我们可以将渗透压差表示为测得的总渗透压浓度与电解质贡献的渗透压浓度之差：\n$$O_{\\text{gap}} = O_{\\text{measured}} - O_{\\text{electrolytes}}$$\n下一步是估算 $O_{\\text{electrolytes}}$。粪便中的主要电解质是阳离子钠 ($\\text{Na}^+$) 和钾 ($\\text{K}^+$)，以及它们对应的阴离子（主要为氯离子 $\\text{Cl}^-$ 和碳酸氢根离子 $\\text{HCO}_3^-$）。第三条原理指出粪便液是电中性的。这意味着正电荷（阳离子）的总浓度必须等于负电荷（阴离子）的总浓度。假设 $\\text{Na}^+$ 和 $\\text{K}^+$ 是主要阳离子，则阳离子总浓度约等于 $[\\text{Na}^+] + [\\text{K}^+]$。根据电中性原理，阴离子总浓度因此也必须约等于 $[\\text{Na}^+] + [\\text{K}^+]$。\n\n所有电解质离子的总浓度是阳离子和阴离子浓度之和：\n$$[\\text{Total Ions}] \\approx ([\\text{Na}^+] + [\\text{K}^+])_{\\text{cations}} + ([\\text{Na}^+] + [\\text{K}^+])_{\\text{anions}} = 2 \\times ([\\text{Na}^+] + [\\text{K}^+])$$\n第二条原理指出，强电解质贡献的渗透摩尔量与其溶质颗粒数量成正比。对于稀水溶液中的单价离子，其贡献的渗透压浓度约等于离子的总摩尔浓度。因此，我们可以将电解质的渗透压浓度近似为：\n$$O_{\\text{electrolytes}} \\approx 2 \\times ([\\text{Na}^+] + [\\text{K}^+])$$\n该表达式代表了由电解质计算或估算出的粪便渗透压浓度。\n\n将此 $O_{\\text{electrolytes}}$ 的表达式代回到我们的渗透压差方程中，我们便得到了标准的临床计算公式：\n$$O_{\\text{gap}} = O_{\\text{measured}} - 2 \\times ([\\text{Na}^+] + [\\text{K}^+])$$\n这就是推导出的，将可测量的渗透压浓度与电解质和非电解质（即压差）的贡献联系起来的表达式。\n\n现在，我们应用此表达式来计算该患者的粪便渗透压差。给定值为：\n粪便渗透压浓度, $O_{\\text{measured}} = 315 \\text{ mOsm/kg}$\n粪便钠浓度, $[\\text{Na}^+] = 25 \\text{ mmol/L}$\n粪便钾浓度, $[\\text{K}^+] = 15 \\text{ mmol/L}$\n在临床实践中，对于水样便，其液体密度假定约为 $1 \\text{ kg/L}$，这使得单位 $\\text{mOsm/kg}$ 和 $\\text{mmol/L}$ 可以作为 $\\text{mOsm/L}$ 互换使用。\n\n将给定值代入推导出的公式中：\n$$O_{\\text{gap}} = 315 - 2 \\times (25 + 15)$$\n$$O_{\\text{gap}} = 315 - 2 \\times (40)$$\n$$O_{\\text{gap}} = 315 - 80$$\n$$O_{\\text{gap}} = 235 \\text{ mOsm/kg}$$\n计算出的粪便渗透压差为 $235 \\text{ mOsm/kg}$。题目要求四舍五入到三位有效数字，此结果已满足要求。\n\n最后，我们解释这个结果。如果粪便渗透压差大于一个常规阈值（通常在 $75$ 至 $125 \\text{ mOsm/kg}$ 的范围内），则认为该压差较大。一个小的压差（例如，$50 \\text{ mOsm/kg}$）表明是分泌性腹泻，此时肠腔内主要含有肠道分泌的电解质。而如此处计算出的大压差（$235 \\text{ mOsm/kg}$）则意味着是渗透性腹泻。这表明肠腔内存在大量未测量的、具有渗透活性的溶质，这些溶质将水吸入肠道，从而引起腹泻。\n\n这一发现与已知的诺如病毒感染的病理生理学一致。诺如病毒靶向并破坏小肠绒毛上的成熟肠上皮细胞。这些细胞对于产生刷状缘酶（例如，像乳糖酶这样的双糖酶）和吸收营养物质至关重要。这些细胞的损伤会导致继发性的、短暂的消化和吸收不良，尤其是碳水化合物的消化吸收不良。未被吸收的膳食碳水化合物及其发酵产物留在肠腔内，产生显著的渗透负荷。这种高浓度的非电解质溶质将水保留在肠道内，并从循环系统中吸取额外的水分，导致大量、水样、渗透性腹泻。$235 \\text{ mOsm/kg}$ 的巨大渗透压差是这些未吸收溶质的定量特征，证实了这名诺如病毒性胃肠炎患者腹泻的主要机制是渗透性的。",
            "answer": "$$\\boxed{235}$$"
        },
        {
            "introduction": "除了个体病理生理学，理解诺如病毒在人群层面的传播还需要考察宿主的易感性因素。决定个体分泌者状态的 FUT2 基因是影响多种诺如病毒株易感性的关键遗传因素。本练习  深入探讨了一个暴发情景，指导您运用直接标准化等流行病学方法计算调整后的风险比，从而在控制暴露强度等混杂变量的同时，量化分泌者状态的影响。",
            "id": "4674287",
            "problem": "诺如病毒肠胃炎的易感性受岩藻糖转移酶2 (FUT2) 基因影响，该基因决定了控制组织血型抗原 (HBGA) 表达的分泌型表型。考虑在一个封闭的居住环境中，单个暴露期内爆发了一次GII.4型诺如病毒疫情。根据与呕吐物污染的媒介物直接接触的强度，先验地定义了两个暴露分层：高暴露 ($H$) 和低暴露 ($L$)。该队列由 $1000$ 名居民和工作人员组成，其基因型分为分泌型阳性（功能性FUT2）和分泌型阴性（非功能性FUT2）。人员和病例的分布如下：\n- 整个队列中的暴露分布：$H$：$400$ 人；$L$：$600$ 人。\n- 每个暴露分层内按基因型划分的构成：\n  - $H$：$340$ 名分泌型阳性者，$60$ 名分泌型阴性者。\n  - $L$：$460$ 名分泌型阳性者，$140$ 名分泌型阴性者。\n- 暴露期内的诺如病毒病例：\n  - 分泌型阳性者：$H$分层$170$例，$L$分层$92$例。\n  - 分泌型阴性者：$H$分层$3$例，$L$分层$2$例。\n\n使用侵袭率作为分层内累积发病率的基本原理和全概率法则来构建直接标准化风险，计算分泌型阳性者与分泌型阴性者的暴露标准化风险比，并以整个队列的暴露分布为标准。将最终调整后的风险比报告为一个无量纲的量，四舍五入到三位有效数字。\n\n在你的推理中，解释分泌型阴性个体的存在如何改变群体对该诺如病毒株的易感性，但仅提供调整后的风险比作为最终数值答案。",
            "solution": "目标是使用直接标准化方法，计算比较分泌型阳性个体与分泌型阴性个体的暴露标准化风险比 ($RR_{adj}$)。该方法允许在控制第三个变量（本例中为暴露强度）的混杂效应的同时，对两组间的风险进行比较。\n\n设下标 $pos$ 表示分泌型阳性组，下标 $neg$ 表示分泌型阴性组。设下标 $H$ 代表高暴露分层，下标 $L$ 代表低暴露分层。每个类别中的个体数用 $N$ 表示，病例数用 $C$ 表示。\n\n已知数据如下：\n- 高暴露分层总人数，$N_H = 400$。\n- 低暴露分层总人数，$N_L = 600$。\n- $H$分层中的分泌型阳性者：$N_{H, pos} = 340$，其中病例数 $C_{H, pos} = 170$。\n- $H$分层中的分泌型阴性者：$N_{H, neg} = 60$，其中病例数 $C_{H, neg} = 3$。\n- $L$分层中的分泌型阳性者：$N_{L, pos} = 460$，其中病例数 $C_{L, pos} = 92$。\n- $L$分层中的分泌型阴性者：$N_{L, neg} = 140$，其中病例数 $C_{L, neg} = 2$。\n\n第一步是计算分层特异性侵袭率，它代表了四个已定义亚组内各自的累积发病率或风险 ($R$)。风险定义为新增病例数除以风险人群数：$R_{i,j} = \\frac{C_{i,j}}{N_{i,j}}$。\n\n对于分泌型阳性组：\n- 高暴露分层的风险：$R_{H, pos} = \\frac{C_{H, pos}}{N_{H, pos}} = \\frac{170}{340} = 0.5$。\n- 低暴露分层的风险：$R_{L, pos} = \\frac{C_{L, pos}}{N_{L, pos}} = \\frac{92}{460} = 0.2$。\n\n对于分泌型阴性组：\n- 高暴露分层的风险：$R_{H, neg} = \\frac{C_{H, neg}}{N_{H, neg}} = \\frac{3}{60} = 0.05$。\n- 低暴露分层的风险：$R_{L, neg} = \\frac{C_{L, neg}}{N_{L, neg}} = \\frac{2}{140} = \\frac{1}{70}$。\n\n这些分层特异性风险表明，分泌型阴性个体对该诺如病毒株感染的抵抗力远强于分泌型阳性个体。无论是在高暴露还是低暴露水平下，他们的患病风险都要低一个数量级。这个抵抗力强的亚群（占 $1000$ 名个体中的 $60 + 140 = 200$ 人，即 $20\\%$）的存在，从本质上降低了整个队列的总体易感性。这一现象通过形成一个由免疫或有抵抗力的个体组成的天然缓冲带，从而阻碍病原体传播，进而影响了群体易感性。\n\n下一步是进行直接标准化。这需要定义一个标准人群来计算每个分层的权重。问题指定使用整个队列的暴露分布作为标准。队列总人数为 $N_{total} = N_H + N_L = 400 + 600 = 1000$。\n\n每个暴露分层的权重 ($w_i$) 是标准人群在该分层中所占的比例：\n- 高暴露分层的权重：$w_H = \\frac{N_H}{N_{total}} = \\frac{400}{1000} = 0.4$。\n- 低暴露分层的权重：$w_L = \\frac{N_L}{N_{total}} = \\frac{600}{1000} = 0.6$。\n\n每个基因型组的调整后风险 ($R_{adj}$) 是其分层特异性风险的加权平均值，权重来自标准人群。计算公式为 $R_{adj,j} = \\sum_{i} w_i R_{i,j}$。\n\n对于分泌型阳性组：\n$$R_{adj, pos} = (w_H \\times R_{H, pos}) + (w_L \\times R_{L, pos}) = (0.4 \\times 0.5) + (0.6 \\times 0.2) = 0.20 + 0.12 = 0.32$$\n\n对于分泌型阴性组：\n$$R_{adj, neg} = (w_H \\times R_{H, neg}) + (w_L \\times R_{L, neg}) = (0.4 \\times 0.05) + (0.6 \\times \\frac{1}{70}) = 0.02 + \\frac{0.6}{70} = \\frac{1}{50} + \\frac{6}{700}$$\n为了合并这些分数，我们找到公分母 $350$：\n$$R_{adj, neg} = \\frac{7}{350} + \\frac{3}{350} = \\frac{10}{350} = \\frac{1}{35}$$\n\n最后，暴露标准化的风险比 ($RR_{adj}$) 是这些调整后风险的比值：\n$$RR_{adj} = \\frac{R_{adj, pos}}{R_{adj, neg}}$$\n代入计算出的值：\n$$RR_{adj} = \\frac{0.32}{\\frac{1}{35}} = 0.32 \\times 35 = \\frac{32}{100} \\times 35 = \\frac{8}{25} \\times 35 = \\frac{8 \\times 7}{5} = \\frac{56}{5} = 11.2$$\n\n问题要求答案四舍五入到三位有效数字。计算出的值 $11.2$ 已经有三位有效数字。\n\n因此，在对暴露强度的混杂效应进行调整后，分泌型阳性个体患诺如病毒肠胃炎的风险是分泌型阴性个体的 $11.2$ 倍。",
            "answer": "$$\n\\boxed{11.2}\n$$"
        },
        {
            "introduction": "为了理解诺如病毒的大规模传播模式，例如其特有的冬季季节性，我们必须建立能将环境条件与传播动态联系起来的模型。有效再生数（$\\mathcal{R}_t$）是衡量这一动态的核心指标，其数值会随着温度和湿度等影响病毒在环境中存活能力的因素而波动。这项高级练习  要求您从第一性原理出发，构建一个 $\\mathcal{R}_t$ 的机理模型，将病毒衰变的生物物理原理与流行病学理论相结合，并应用该模型根据气候数据预测季节性传播模式。",
            "id": "4674293",
            "problem": "给定温度和绝对湿度的月度环境时间序列，要求您使用一种机理推导方法计算诺如病毒肠胃炎有效再生数（$\\mathcal{R}_t$）的预测季节性变化。该方法从标准的房室传染病模型框架和经过充分检验的生物物理学环境失活事实出发。目标是从第一性原理构建$\\mathcal{R}_t(t)$，然后将其应用于指定的测试用例，并报告每个用例的季节性变化的单一量化指标。\n\n使用的基本依据和假设：\n- 易感-感染-康复（SIR）框架意味着瞬时有效再生数满足$\\mathcal{R}_t(t) = \\beta(t)\\, D\\, \\frac{S}{N}$，其中$\\beta(t)$是有效传播率，$D$是平均感染持续时间（以天为单位），$S$是易感个体数量，$N$是总人口规模。在所关注的时间尺度内，将$\\frac{S}{N}$视为常数。\n- 有效传播率可以表示为$\\beta(t) = c\\, p(t)$，其中$c$是日均有效接触率，$p(t)$是在时间$t$一次接触导致传播的概率。\n- 对于通过受污染环境介导的诺如病毒传播，病毒颗粒在污染和接触之间的生存能力呈指数衰减，其失活率受环境条件调节。将生存能力建模为$s_{\\mathrm{env}}(T,H) = \\exp\\!\\left(-\\lambda(T,H)\\, \\tau\\right)$，其中$\\lambda(T,H)$是作为绝对温度$T$（单位：开尔文）和绝对湿度$H$（单位：克/立方米）函数的失活率，$\\tau$是平均污染到接触的延迟时间（以天为单位）。\n- 假设在参考环境附近，失活率随$T$和$H$单调增加。使用参数形式$\\lambda(T,H) = \\lambda_0 \\exp\\!\\left(\\eta_T \\left(T - T_{\\mathrm{ref}}\\right) + \\eta_H \\left(H - H_{\\mathrm{ref}}\\right)\\right)$，其中$\\lambda_0$是在参考温度$T_{\\mathrm{ref}}$和参考绝对湿度$H_{\\mathrm{ref}}$下的基准失活率，$\\eta_T$和$\\eta_H$是正的敏感度参数。\n- 单次接触传播概率与环境生存能力成正比：$p(T,H) = p_0\\, s_{\\mathrm{env}}(T,H)$，$p_0$是参考条件下的基准单次接触传播概率。等效地，定义$\\beta_0 = c\\, p_0$并写为$\\beta(T,H) = \\beta_0\\, s_{\\mathrm{env}}(T,H)$。\n\n所有计算中使用的参数值：\n- 感染期：$D = 2$ 天。\n- 易感比例：$\\frac{S}{N} = 0.6$（无量纲）。\n- 基准传播系数：$\\beta_0 = 1.2$ 天$^{-1}$。\n- 参考温度：$T_{\\mathrm{ref}} = 293$ 开尔文。\n- 参考绝对湿度：$H_{\\mathrm{ref}} = 7$ 克/立方米。\n- 基准失活率：$\\lambda_0 = 0.3$ 天$^{-1}$。\n- 温度敏感度：$\\eta_T = 0.05$ 开尔文$^{-1}$。\n- 湿度敏感度：$\\eta_H = 0.06$ (克/立方米)$^{-1}$。\n- 平均污染到接触的延迟时间：$\\tau = 0.5$ 天。\n\n您的任务：\n1. 从基本假设中推导出$\\mathcal{R}_t(t)$作为$T_t$和$H_t$函数的显式表达式。\n2. 实现一个程序，对于下面提供的每个测试用例，计算月度序列$\\{\\mathcal{R}_t(m)\\}_{m=1}^{12}$，然后计算定义为$\\max_m \\mathcal{R}_t(m) - \\min_m \\mathcal{R}_t(m)$的季节性振幅，单位为无量纲的再生数。\n3. 按照最终输出格式的要求，将每个测试用例的季节性振幅报告在单行上。\n\n测试套件（每个用例给出12个$T$（单位：开尔文）和$H$（单位：克/立方米）的月度值）：\n- 用例1（温带气候）：\n  - $T$: $[279, 281, 285, 289, 293, 297, 300, 299, 295, 289, 283, 280]$\n  - $H$: $[4.0, 4.5, 5.5, 7.0, 9.0, 12.0, 14.0, 13.0, 10.0, 7.0, 5.0, 4.5]$\n- 用例2（热带暖湿气候）：\n  - $T$: $[298, 299, 299, 300, 300, 301, 301, 301, 300, 299, 299, 298]$\n  - $H$: $[14.0, 15.0, 16.0, 17.0, 18.0, 18.0, 18.0, 17.0, 16.0, 15.0, 14.0, 14.0]$\n- 用例3（季节性强的干冷气候）：\n  - $T$: $[273, 274, 276, 280, 285, 290, 292, 290, 285, 278, 274, 272]$\n  - $H$: $[2.0, 2.2, 3.0, 4.0, 5.5, 6.5, 8.0, 7.0, 5.0, 3.5, 2.5, 2.0]$\n- 用例4（恒定参考环境；边界情况）：\n  - $T$: $[293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293]$\n  - $H$: $[7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0]$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按顺序排列的用例1到4的季节性振幅，四舍五入至6位小数，格式为方括号括起来的逗号分隔列表，例如$[\\alpha_1,\\alpha_2,\\alpha_3,\\alpha_4]$，其中每个$\\alpha_i$是一个浮点数，单位为再生数单位（无量纲）。",
            "solution": "用户提供的问题陈述已经过严格评估，并被确定为有效。该问题基于已确立的流行病学和生物物理学原理，具有科学依据；其表述清晰，给出的条件完整且一致；并以客观、正式的语言表达。因此，我们可以着手进行求解。\n\n主要任务是推导时间依赖的有效再生数 $\\mathcal{R}_t(t)$ 的显式表达式，并用它来计算几种气候情景下的季节性振幅。\n\n首先，我们将通过依次代入所提供的定义来进行推导。推导的起点是源于 SIR 框架的有效再生数表达式：\n$$\n\\mathcal{R}_t(t) = \\beta(t)\\, D\\, \\frac{S}{N}\n$$\n在此，$\\beta(t)$ 是随时间变化的有效传播率，$D$ 是平均感染持续时间，$\\frac{S}{N}$ 是易感人群在总人口中所占的比例。\n\n问题陈述指出，有效传播率与单次接触传播概率 $p(t)$ 成正比，比例常数为平均有效接触率 $c$。这表示为 $\\beta(t) = c\\, p(t)$。此外，单次接触传播概率本身又与病毒的环境生存能力 $s_{\\mathrm{env}}(T,H)$ 成正比，使得 $p(t) = p(T_t, H_t) = p_0\\, s_{\\mathrm{env}}(T_t, H_t)$，其中 $p_0$ 是基准概率。结合这些关系，我们可以定义一个基准传播系数 $\\beta_0 = c\\, p_0$，从而得到随时间变化的传播率表达式：\n$$\n\\beta(t) = \\beta(T_t, H_t) = \\beta_0\\, s_{\\mathrm{env}}(T_t, H_t)\n$$\n其中 $T_t$ 和 $H_t$ 分别是时间 $t$ 的绝对温度和绝对湿度。\n\n接下来，我们引入环境生存能力 $s_{\\mathrm{env}}$ 的模型。该项代表在平均污染到接触的延迟时间 $\\tau$ 内，保持活性的病毒颗粒的比例。其衰减是指数形式的，由依赖于环境的失活率 $\\lambda(T_t, H_t)$ 决定：\n$$\ns_{\\mathrm{env}}(T_t, H_t) = \\exp\\!\\left(-\\lambda(T_t, H_t)\\, \\tau\\right)\n$$\n失活率 $\\lambda$ 被建模为相对于参考环境 ($T_{\\mathrm{ref}}$, $H_{\\mathrm{ref}}$) 的温度 $T$ 和湿度 $H$ 的函数：\n$$\n\\lambda(T_t, H_t) = \\lambda_0 \\exp\\!\\left(\\eta_T \\left(T_t - T_{\\mathrm{ref}}\\right) + \\eta_H \\left(H_t - H_{\\mathrm{ref}}\\right)\\right)\n$$\n此处，$\\lambda_0$ 是基准失活率，$\\eta_T$ 和 $\\eta_H$ 分别是温度和湿度的敏感度参数。\n\n将 $\\lambda(T_t, H_t)$ 的表达式代入 $s_{\\mathrm{env}}(T_t, H_t)$ 的方程，我们得到：\n$$\ns_{\\mathrm{env}}(T_t, H_t) = \\exp\\!\\left(-\\left[ \\lambda_0 \\exp\\!\\left(\\eta_T \\left(T_t - T_{\\mathrm{ref}}\\right) + \\eta_H \\left(H_t - H_{\\mathrm{ref}}\\right)\\right) \\right] \\tau \\right)\n$$\n现在，我们将这个环境生存能力的表达式代入传播率 $\\beta(t)$ 的方程：\n$$\n\\beta(T_t, H_t) = \\beta_0 \\exp\\!\\left(-\\lambda_0 \\tau \\exp\\!\\left(\\eta_T \\left(T_t - T_{\\mathrm{ref}}\\right) + \\eta_H \\left(H_t - H_{\\mathrm{ref}}\\right)\\right)\\right)\n$$\n最后，将这个关于 $\\beta(T_t, H_t)$ 的完整表达式代入 $\\mathcal{R}_t(t)$ 的初始方程，即可得到有效再生数作为环境条件函数的完整、显式模型：\n$$\n\\mathcal{R}_t(T_t, H_t) = \\left( \\beta_0 D \\frac{S}{N} \\right) \\exp\\!\\left(-\\lambda_0 \\tau \\exp\\!\\left(\\eta_T \\left(T_t - T_{\\mathrm{ref}}\\right) + \\eta_H \\left(H_t - H_{\\mathrm{ref}}\\right)\\right)\\right)\n$$\n这是我们计算的核心方程。注意，项 $\\beta_0 D \\frac{S}{N}$ 是一个常数前置因子。\n\n计算过程如下。对于每个测试用例，我们都给定了12个月的温度和湿度对，$\\{ (T_m, H_m) \\}_{m=1}^{12}$。\n1.  对于每个月 $m$，我们将使用推导出的公式和提供的参数值计算相应的 $\\mathcal{R}_t(m)$值。\n参数为：\n- $D = 2$ 天\n- $\\frac{S}{N} = 0.6$\n- $\\beta_0 = 1.2$ 天$^{-1}$\n- $T_{\\mathrm{ref}} = 293$ K\n- $H_{\\mathrm{ref}} = 7$ g/m$^3$\n- $\\lambda_0 = 0.3$ 天$^{-1}$\n- $\\eta_T = 0.05$ K$^{-1}$\n- $\\eta_H = 0.06$ (g/m$^3$)$^{-1}$\n- $\\tau = 0.5$ 天\n\n可以预先计算常数前置因子：\n$$\n\\mathcal{R}_{\\text{base}} = \\beta_0 D \\frac{S}{N} = (1.2)(2)(0.6) = 1.44\n$$\n外层指数函数的参数包含常数乘积 $\\lambda_0\\tau$：\n$$\n\\lambda_0 \\tau = (0.3)(0.5) = 0.15\n$$\n因此，需要实现的最终方程是：\n$$\n\\mathcal{R}_t(T_m, H_m) = 1.44 \\cdot \\exp\\!\\left(-0.15 \\cdot \\exp\\!\\left(0.05 (T_m - 293) + 0.06 (H_m - 7)\\right)\\right)\n$$\n\n2.  此计算将为 $\\mathcal{R}_t$ 生成一个包含12个值的月度时间序列，即 $\\{\\mathcal{R}_t(m)\\}_{m=1}^{12}$。\n3.  然后，我们将找到该序列中的最大值和最小值：$\\mathcal{R}_{t, \\max} = \\max_m \\mathcal{R}_t(m)$ 和 $\\mathcal{R}_{t, \\min} = \\min_m \\mathcal{R}_t(m)$。\n4.  季节性振幅 $\\alpha$ 被定义并计算为这些极值之差：$\\alpha = \\mathcal{R}_{t, \\max} - \\mathcal{R}_{t, \\min}$。\n5.  对所有四个测试用例重复此过程，并按规定格式报告所得振幅。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the seasonal amplitude of the Effective Reproduction Number for norovirus\n    based on a mechanistic model and environmental time series.\n    \"\"\"\n\n    # Define the constant parameters based on the problem statement.\n    D = 2.0         # Mean duration of infectiousness in days\n    S_div_N = 0.6   # Susceptible fraction of the population (unitless)\n    beta_0 = 1.2    # Baseline transmission coefficient in day^-1\n    T_ref = 293.0   # Reference temperature in Kelvin\n    H_ref = 7.0     # Reference absolute humidity in g/m^3\n    lambda_0 = 0.3  # Baseline inactivation rate in day^-1\n    eta_T = 0.05    # Temperature sensitivity in Kelvin^-1\n    eta_H = 0.06    # Humidity sensitivity in (g/m^3)^-1\n    tau = 0.5       # Mean contamination-to-contact delay in days\n\n    # Pre-calculate the constant part of the Rt equation for efficiency.\n    # Rt = (beta_0 * D * S_div_N) * exp(...)\n    R_base = beta_0 * D * S_div_N\n\n    # Pre-calculate the constant part of the exponent for efficiency.\n    # exp(-lambda_0 * tau * exp(...))\n    lambda_tau = lambda_0 * tau\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (temperate climate)\n        (\n            [279, 281, 285, 289, 293, 297, 300, 299, 295, 289, 283, 280],\n            [4.0, 4.5, 5.5, 7.0, 9.0, 12.0, 14.0, 13.0, 10.0, 7.0, 5.0, 4.5]\n        ),\n        # Case 2 (tropical warm-humid)\n        (\n            [298, 299, 299, 300, 300, 301, 301, 301, 300, 299, 299, 298],\n            [14.0, 15.0, 16.0, 17.0, 18.0, 18.0, 18.0, 17.0, 16.0, 15.0, 14.0, 14.0]\n        ),\n        # Case 3 (cold-dry with strong seasonality)\n        (\n            [273, 274, 276, 280, 285, 290, 292, 290, 285, 278, 274, 272],\n            [2.0, 2.2, 3.0, 4.0, 5.5, 6.5, 8.0, 7.0, 5.0, 3.5, 2.5, 2.0]\n        ),\n        # Case 4 (constant reference environment; edge case)\n        (\n            [293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293],\n            [7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0]\n        )\n    ]\n\n    results = []\n    for T_monthly, H_monthly in test_cases:\n        # Convert lists to NumPy arrays for vectorized calculations.\n        T_arr = np.array(T_monthly, dtype=float)\n        H_arr = np.array(H_monthly, dtype=float)\n\n        # Calculate the derived expression for Rt(t) for all 12 months.\n        # Rt = R_base * exp(-lambda_tau * exp(eta_T * (T - T_ref) + eta_H * (H - H_ref)))\n        \n        # Step 1: Calculate the exponent term related to environmental deviation.\n        env_exponent = eta_T * (T_arr - T_ref) + eta_H * (H_arr - H_ref)\n        \n        # Step 2: Calculate the full argument of the outer exponential function.\n        full_exponent = -lambda_tau * np.exp(env_exponent)\n        \n        # Step 3: Calculate the monthly Rt values.\n        R_t_monthly = R_base * np.exp(full_exponent)\n\n        # Step 4: Calculate the seasonal amplitude.\n        amplitude = np.max(R_t_monthly) - np.min(R_t_monthly)\n        \n        # Step 5: Round the result to 6 decimal places and store it.\n        results.append(round(amplitude, 6))\n\n    # Format the final output as a comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}