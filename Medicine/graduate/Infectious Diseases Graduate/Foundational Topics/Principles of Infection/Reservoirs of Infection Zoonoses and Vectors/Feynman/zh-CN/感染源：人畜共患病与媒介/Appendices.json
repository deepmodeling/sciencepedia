{
    "hands_on_practices": [
        {
            "introduction": "从单个蚊子叮咬到最终的感染，这个过程是如何量化的？本练习将带领我们深入到这一基本传播事件的核心，从微观的病毒颗粒层面构建一个剂量-反应模型。通过应用泊松过程和“单次命中”等基本概率概念，我们将推导出从一次暴露中感染的概率，这构成了定量微生物风险评估（QMRA）的基石。这个实践旨在培养将复杂的生物过程转化为数学模型的能力，并理解感染本质上是一个随机过程 。",
            "id": "4686831",
            "problem": "一种人畜共患的虫媒病毒在禽类宿主中维持，并通过蚊媒传播给人类。考虑在蚊子吸食了受感染鸟类的血液后发生的一次叮咬。假设传递的剂量遵循以下具有生物学基础的链条：蚊子从鸟类的血餐中获得病毒粒子；这些病毒粒子的一部分在蚊媒体内一直存活到下一次叮咬；在叮咬瞬间，存活病毒粒子的一部分被接种到人类真皮中。设传递给人类的病毒粒子的期望数量（剂量）用 $D$ 表示。\n\n从以下基本假设出发，这些假设在定量微生物风险评估和媒介传播模型中被广泛使用：\n- 由于微观尺度上的随机分配和单个病毒粒子的独立性，在吸血过程中获得的病毒粒子数量以及随后接种到人体内的数量，可以很好地用泊松过程来近似。\n- 感染遵循“单次命中”机制：每个接种的病毒粒子在到达后独立地以一个恒定的概率引发感染，并且只要至少有一个病毒粒子成功引发感染，感染就会发生。\n\n使用这些假设，推导感染概率关于单个病毒粒子感染力参数 $k$ 和期望剂量 $D$ 的函数形式。然后，根据以下单次叮咬的科学合理参数计算感染概率：\n- 宿主体内病毒血症（病毒粒子/毫升）：$C_{r} = 2.0 \\times 10^{6}$。\n- 蚊子血餐体积：$V_{m} = 3.5 \\,\\mu\\text{L}$，其中 $1\\,\\mu\\text{L} = 10^{-3}\\,\\text{mL}$。\n- 获取效率（血餐中进入蚊子中肠的病毒粒子比例）：$\\alpha = 0.15$。\n- 从获取到叮咬期间在蚊媒内的存活率（存活比例）：$s = 0.50$。\n- 叮咬时的接种效率（存活病毒粒子中注入人体的比例）：$\\beta = 0.25$。\n- 单个病毒粒子感染力（在独立性假设下，一个接种的病毒粒子引发感染的概率）：$k = 8.0 \\times 10^{-3}$。\n\n将期望剂量定义为 $D = C_{r} \\times V_{m} \\times \\alpha \\times s \\times \\beta$（体积需转换为毫升），并使用推导出的表达式计算感染概率。将最终概率表示为小数，并将答案四舍五入到四位有效数字。",
            "solution": "所述问题具有科学依据、提法明确且客观。其基本假设——病毒粒子计数的泊松统计和独立的单次命中感染机制——是定量微生物风险评估（QMRA）和病毒学中的标准且严格定义的模型。所有必要的参数都以合理的值给出，并且所需的计算也明确规定。因此，该问题是有效的。\n\n解决过程包括两个主要部分：首先，根据给定假设推导感染概率的一般函数形式；其次，使用提供的参数计算该概率的具体数值。\n\n**第一部分：感染概率模型的推导**\n\n设 $N$ 为蚊子叮咬期间接种到人体内的病毒粒子数量的随机变量。问题陈述 $N$ 可以用泊松过程建模。接种的病毒粒子的期望数量是剂量，记为 $D$。因此，$N$ 服从均值为 $D$ 的泊松分布。$N$ 的概率质量函数（PMF）由下式给出：\n$$\nP(N=n) = \\frac{D^n \\exp(-D)}{n!} \\quad \\text{for } n = 0, 1, 2, \\dots\n$$\n\n问题假设了一个“单次命中”感染机制。这意味着 $n$ 个接种的病毒粒子中的每一个都独立地起作用以导致感染。设 $k$ 为单个病毒粒子成功引发感染的概率。因此，单个病毒粒子*未能*引发感染的概率是 $(1-k)$。\n\n在已接种 $N=n$ 个病毒粒子的条件下，它们中*没有一个*引发感染的概率是它们各自失败概率的乘积，这是由于它们的独立性。这个概率是 $(1-k)^n$。如果至少有一个病毒粒子成功，感染就会发生。因此，在接种了 $n$ 个病毒粒子的条件下，感染的概率是：\n$$\nP(\\text{Infection} | N=n) = 1 - P(\\text{No Infection} | N=n) = 1 - (1-k)^n\n$$\n此公式对任何 $n \\ge 0$ 都成立。如果 $n=0$，则 $P(\\text{Infection} | N=0) = 1 - (1-k)^0 = 1 - 1 = 0$，这是正确的。\n\n为了求出总感染概率 $P(\\text{Inf})$，我们必须将条件概率对所有可能的 $n$ 值进行求和，并按每个 $n$ 发生的概率进行加权。这是全概率定律的应用：\n$$\nP(\\text{Inf}) = \\sum_{n=0}^{\\infty} P(\\text{Infection} | N=n) P(N=n)\n$$\n代入条件概率和 $N$ 的概率质量函数的表达式：\n$$\nP(\\text{Inf}) = \\sum_{n=0}^{\\infty} [1 - (1-k)^n] \\frac{D^n \\exp(-D)}{n!}\n$$\n我们可以将求和分成两部分：\n$$\nP(\\text{Inf}) = \\sum_{n=0}^{\\infty} \\frac{D^n \\exp(-D)}{n!} - \\sum_{n=0}^{\\infty} (1-k)^n \\frac{D^n \\exp(-D)}{n!}\n$$\n第一项是均值为 $D$ 的泊松分布中所有概率的总和，等于 $1$：\n$$\n\\sum_{n=0}^{\\infty} \\frac{D^n \\exp(-D)}{n!} = \\exp(-D) \\sum_{n=0}^{\\infty} \\frac{D^n}{n!} = \\exp(-D) \\exp(D) = 1\n$$\n对于第二项，我们可以提出因子 $\\exp(-D)$ 并合并 $n$ 的幂：\n$$\n\\sum_{n=0}^{\\infty} (1-k)^n \\frac{D^n \\exp(-D)}{n!} = \\exp(-D) \\sum_{n=0}^{\\infty} \\frac{[D(1-k)]^n}{n!}\n$$\n该求和是指数函数 $\\exp(x)$ 在 $x=D(1-k)$ 处的泰勒级数展开。因此，第二项简化为：\n$$\n\\exp(-D) \\exp[D(1-k)] = \\exp[-D + D(1-k)] = \\exp(-D + D - Dk) = \\exp(-kD)\n$$\n将两个简化后的项合并，我们得到感染概率的函数形式，即著名的指数剂量-反应模型：\n$$\nP(\\text{Inf}) = 1 - \\exp(-kD)\n$$\n\n**第二部分：具体感染概率的计算**\n\n首先，我们必须使用提供的参数和公式 $D = C_{r} \\times V_{m} \\times \\alpha \\times s \\times \\beta$ 来计算期望剂量 $D$。\n参数如下：\n- 宿主体内病毒血症：$C_{r} = 2.0 \\times 10^{6} \\, \\text{virions/mL}$\n- 蚊子血餐体积：$V_{m} = 3.5 \\, \\mu\\text{L}$\n- 获取效率：$\\alpha = 0.15$\n- 蚊媒内存活率：$s = 0.50$\n- 接种效率：$\\beta = 0.25$\n\n我们必须首先确保单位一致。体积 $V_m$ 必须使用给定的转换因子 $1\\,\\mu\\text{L} = 10^{-3}\\,\\text{mL}$ 从微升（$\\mu\\text{L}$）转换为毫升（mL）：\n$$\nV_{m} = 3.5 \\, \\mu\\text{L} = 3.5 \\times 10^{-3} \\, \\text{mL}\n$$\n现在，我们可以计算 $D$：\n$$\nD = (2.0 \\times 10^{6}) \\times (3.5 \\times 10^{-3}) \\times 0.15 \\times 0.50 \\times 0.25\n$$\n让我们逐步计算这个乘积：\n$$\nD = (7.0 \\times 10^{3}) \\times (0.15 \\times 0.50 \\times 0.25)\n$$\n$$\nD = 7000 \\times (0.075 \\times 0.25)\n$$\n$$\nD = 7000 \\times 0.01875\n$$\n$$\nD = 131.25\n$$\n期望剂量是 $131.25$ 个病毒粒子。\n\n接下来，我们使用推导出的概率函数 $P(\\text{Inf}) = 1 - \\exp(-kD)$，以及计算出的 $D$ 值和给定的单个病毒粒子感染力 $k = 8.0 \\times 10^{-3}$。\n$$\nP(\\text{Inf}) = 1 - \\exp[-(8.0 \\times 10^{-3}) \\times 131.25]\n$$\n计算指数部分：\n$$\n-k D = -0.008 \\times 131.25 = -1.05\n$$\n现在将此值代回概率方程：\n$$\nP(\\text{Inf}) = 1 - \\exp(-1.05)\n$$\n计算数值：\n$$\n\\exp(-1.05) \\approx 0.34993802...\n$$\n$$\nP(\\text{Inf}) \\approx 1 - 0.34993802 = 0.65006197...\n$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $6$、$5$、$0$、$0$。第五位有效数字是 $6$，大于或等于 $5$，所以我们将最后一位有效数字向上取整。\n$$\nP(\\text{Inf}) \\approx 0.6501\n$$",
            "answer": "$$\n\\boxed{0.6501}\n$$"
        },
        {
            "introduction": "在理解了单个传播事件的概率后，我们如何评估一种疾病是否会在整个群体中蔓延？本练习引入了流行病学中最重要的阈值参数之一：基本再生数（$R_0$）。你将从第一性原理出发，为一种典型的蚊媒疾病推导$R_0$的表达式，从而将蚊子叮咬率、存活率和传播效率等具体参数与疾病的整体传播潜力联系起来。通过计算$R_0$及其对各参数的敏感性，你将掌握一个评估和比较不同干预措施（如减少蚊子数量或使用杀虫剂）有效性的强大工具 。",
            "id": "4686806",
            "problem": "一种人畜共通虫媒病毒在非人类宿主库中维持，但当媒介叮咬感染性人类时，病毒可在人类中扩增。在人类是有效的扩增宿主的条件下，人-媒介-人传播循环的基本再生数（$R_0$）可以从第一性原理推导得出。使用以下基本原理：基本再生数（$R_0$）是在一个其他方面完全易感的人群中，由单个感染性人类引入所产生的继发人类感染的期望数；人类所经历的总叮咬率是每个媒介的叮咬率与媒介与人比例的乘积；媒介和宿主具有恒定风险率的指数分布寿命；在固定的外源性潜伏期内的存活由指数存活函数给出；在指数分布的感染期内，感染性接触的期望数等于接触率乘以平均持续时间。\n\n假设：\n- 每个媒介以速率 $a$（叮咬次数/每个媒介/每天）叮咬人类。\n- 一次来自感染性媒介的叮咬感染一个易感人类的概率是 $b$。\n- 一次对感染性人类的叮咬感染一个易感媒介的概率是 $c$。\n- 媒介与人的比例是 $m$。\n- 媒介的死亡率为 $\\mu$（每天），外源性潜伏期（EIP）为 $n$（天），因此一个新感染的媒介存活过 EIP 的概率是 $\\exp(-\\mu n)$。\n- 人类的恢复率为 $r$（每天）。\n\n从上述基本定义和事实出发，推导出用 $a$、$b$、$c$、$m$、$\\mu$、$n$ 和 $r$ 表示的 $R_0$ 表达式。然后，在以下对于城郊环境中的蚊媒人畜共通病是合理的参数值下，计算 $R_0$ 和由偏导数 $\\frac{\\partial R_0}{\\partial a}$、$\\frac{\\partial R_0}{\\partial b}$、$\\frac{\\partial R_0}{\\partial c}$、$\\frac{\\partial R_0}{\\partial m}$、$\\frac{\\partial R_0}{\\partial \\mu}$ 和 $\\frac{\\partial R_0}{\\partial n}$ 给出的局部参数敏感性：\n- $a = 0.25$ 叮咬次数/每个媒介/每天，\n- $b = 0.40$，\n- $c = 0.50$，\n- $m = 5.0$ 媒介/人，\n- $\\mu = 0.10$ 天$^{-1}$，\n- $n = 10$ 天，\n- $r = 0.20$ 天$^{-1}$。\n\n将最终数值结果以单行矩阵的形式提供，其中按顺序包含 $R_0$、$\\frac{\\partial R_0}{\\partial a}$、$\\frac{\\partial R_0}{\\partial b}$、$\\frac{\\partial R_0}{\\partial c}$、$\\frac{\\partial R_0}{\\partial m}$、$\\frac{\\partial R_0}{\\partial \\mu}$ 和 $\\frac{\\partial R_0}{\\partial n}$。将所有数字四舍五入到四位有效数字。将所有量表示为无量纲数（无单位）。",
            "solution": "这个问题有科学依据，定义明确且客观。它提出了一个基于 Ross-Macdonald 媒介传播疾病模型框架的数学流行病学标准练习。所有参数和假设都定义清晰且一致。因此，这个问题是有效的，并将推导出解决方案。\n\n基本再生数 $R_0$ 定义为在一个完全易感的人群中，由单个感染性人类产生的继发人类感染的期望数。传播途径是从一个感染性人类到易感媒介，然后从该媒介（在其变得具有传染性后）到易感人类。我们可以将 $R_0$ 表示为两个量的乘积：\n$1$. 单个感染性人类感染的媒介平均数。\n$2$. 单个新感染的媒介在其整个生命周期内感染的人类平均数。\n\n让我们分别推导每个组成部分。\n\n组成部分 $1$：单个感染性人类感染的媒介平均数。\n- 人类恢复率为 $r$。假设感染期呈指数分布，单个人的平均感染持续时间为 $\\frac{1}{r}$ 天。\n- 媒介与人的比例为 $m$，每个媒介以每天 $a$ 次的速率叮咬人类。因此，单个人被叮咬的总速率为每天 $m \\times a$ 次。\n- 对感染性人类的一次叮咬成功感染易感媒介的概率是 $c$。\n一个感染性人类感染的媒介期望数是人类被叮咬的总速率、人类感染持续时间以及每次叮咬的传播概率的乘积。\n$$ \\text{每个感染性人类感染的媒介数} = (ma) \\times \\left(\\frac{1}{r}\\right) \\times c = \\frac{mac}{r} $$\n\n组成部分 $2$：单个新感染的媒介感染的人类平均数。\n- 媒介一旦被感染，必须存活过 $n$ 天的外源性潜伏期（EIP）才能变得具有传染性。\n- 在媒介死亡率恒为 $\\mu$ 的情况下，存活过这一时期的概率由指数存活函数 $\\exp(-\\mu n)$ 给出。\n- 如果媒介存活过 EIP，它将在其剩余的生命中具有传染性。\n- 由于媒介寿命呈指数分布，速率为 $\\mu$，因此期望的感染性寿命为 $\\frac{1}{\\mu}$ 天。\n- 在其感染性寿命期间，媒介以每天 $a$ 次的速率叮咬人类。因此，一个感染性媒介叮咬人类的总次数为 $a \\times \\frac{1}{\\mu}$。\n- 来自感染性媒介的一次叮咬成功感染易感人类的概率是 $b$。\n- 因此，一个*已经变得具有传染性*的媒介所感染的人类期望数是 $\\frac{ab}{\\mu}$。\n- 为了找到一个*新感染*的媒介所感染的人类期望数，我们必须将此数乘以媒介存活过 EIP 的概率。\n$$ \\text{每个新感染的媒介感染的人类数} = \\exp(-\\mu n) \\times \\frac{ab}{\\mu} $$\n\n结合这两个组成部分，$R_0$ 是它们的乘积：\n$$ R_0 = (\\text{每个感染性人类感染的媒介数}) \\times (\\text{每个新感染的媒介感染的人类数}) $$\n$$ R_0 = \\left(\\frac{mac}{r}\\right) \\times \\left(\\frac{ab}{\\mu} \\exp(-\\mu n)\\right) $$\n$$ R_0 = \\frac{a^2 b c m}{r \\mu} \\exp(-\\mu n) $$\n\n现在，我们使用给定的参数值计算 $R_0$：\n$a = 0.25$，$b = 0.40$，$c = 0.50$，$m = 5.0$，$\\mu = 0.10$，$n = 10$，$r = 0.20$。\n$$ R_0 = \\frac{(0.25)^2 (0.40) (0.50) (5.0)}{(0.20) (0.10)} \\exp(-(0.10)(10)) $$\n$$ R_0 = \\frac{(0.0625) (0.40) (0.50) (5.0)}{0.02} \\exp(-1) $$\n$$ R_0 = \\frac{0.0625}{0.02} \\exp(-1) = 3.125 \\exp(-1) \\approx 1.14966... $$\n四舍五入到四位有效数字，$R_0 = 1.150$。\n\n接下来，我们计算局部参数敏感性，即 $R_0$ 对每个参数的偏导数。\n\n$1$. 对 $a$ 的敏感性：\n$$ \\frac{\\partial R_0}{\\partial a} = \\frac{\\partial}{\\partial a} \\left(\\frac{a^2 b c m}{r \\mu} \\exp(-\\mu n)\\right) = \\frac{2a b c m}{r \\mu} \\exp(-\\mu n) = \\frac{2}{a} R_0 $$\n$$ \\frac{\\partial R_0}{\\partial a} = \\frac{2}{0.25} (1.14966...) = 8 \\times 1.14966... \\approx 9.1973... \\to 9.197 $$\n\n$2$. 对 $b$ 的敏感性：\n$$ \\frac{\\partial R_0}{\\partial b} = \\frac{\\partial}{\\partial b} \\left(\\frac{a^2 b c m}{r \\mu} \\exp(-\\mu n)\\right) = \\frac{a^2 c m}{r \\mu} \\exp(-\\mu n) = \\frac{R_0}{b} $$\n$$ \\frac{\\partial R_0}{\\partial b} = \\frac{1.14966...}{0.40} \\approx 2.8741... \\to 2.874 $$\n\n$3$. 对 $c$ 的敏感性：\n$$ \\frac{\\partial R_0}{\\partial c} = \\frac{\\partial}{\\partial c} \\left(\\frac{a^2 b c m}{r \\mu} \\exp(-\\mu n)\\right) = \\frac{a^2 b m}{r \\mu} \\exp(-\\mu n) = \\frac{R_0}{c} $$\n$$ \\frac{\\partial R_0}{\\partial c} = \\frac{1.14966...}{0.50} \\approx 2.2993... \\to 2.299 $$\n\n$4$. 对 $m$ 的敏感性：\n$$ \\frac{\\partial R_0}{\\partial m} = \\frac{\\partial}{\\partial m} \\left(\\frac{a^2 b c m}{r \\mu} \\exp(-\\mu n)\\right) = \\frac{a^2 b c}{r \\mu} \\exp(-\\mu n) = \\frac{R_0}{m} $$\n$$ \\frac{\\partial R_0}{\\partial m} = \\frac{1.14966...}{5.0} \\approx 0.22993... \\to 0.2299 $$\n\n$5$. 对 $\\mu$ 的敏感性：\n$$ \\frac{\\partial R_0}{\\partial \\mu} = \\frac{\\partial}{\\partial \\mu} \\left(\\frac{a^2 b c m}{r} \\mu^{-1} \\exp(-\\mu n)\\right) = \\frac{a^2 b c m}{r} \\left( (-\\mu^{-2})\\exp(-\\mu n) + \\mu^{-1}(-n)\\exp(-\\mu n) \\right) $$\n$$ \\frac{\\partial R_0}{\\partial \\mu} = \\frac{a^2 b c m}{r \\mu} \\exp(-\\mu n) \\left( -\\frac{1}{\\mu} - n \\right) = -R_0 \\left(\\frac{1}{\\mu} + n\\right) $$\n$$ \\frac{\\partial R_0}{\\partial \\mu} = -1.14966... \\left(\\frac{1}{0.10} + 10\\right) = -1.14966... (10 + 10) = -22.993... \\to -22.99 $$\n\n$6$. 对 $n$ 的敏感性：\n$$ \\frac{\\partial R_0}{\\partial n} = \\frac{\\partial}{\\partial n} \\left(\\frac{a^2 b c m}{r \\mu} \\exp(-\\mu n)\\right) = \\frac{a^2 b c m}{r \\mu} (-\\mu \\exp(-\\mu n)) = -\\mu R_0 $$\n$$ \\frac{\\partial R_0}{\\partial n} = -(0.10) (1.14966...) = -0.114966... \\to -0.1150 $$\n\n我们将七个数值结果组合成一个单行矩阵，每个值都四舍五入到四位有效数字。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.150  9.197  2.874  2.299  0.2299  -22.99  -0.1150 \\end{pmatrix} } $$"
        },
        {
            "introduction": "现实世界中的疾病传播并非均匀发生，而是常常通过复杂的网络结构进行，例如野生动物贸易网络。我们如何对这类系统中的溢出风险进行建模和预测？这项高级练习将我们从经典的群体模型带入现代的网络分析框架。你需要综合运用线性代数、网络理论和概率论的知识，构建一个计算模型，来模拟病原体如何在由养殖场和市场组成的网络中传播，并最终评估其向人类社会溢出的风险。这项计算实践旨在培养分析复杂异构系统的能力，这在全球健康（One Health）时代，对于理解动物、人类与环境健康之间的交互至关重要 。",
            "id": "4686782",
            "problem": "一个野生动物贸易系统通过动物的定向移动将动物养殖场与活体动物市场联系起来。养殖场作为源于野生动物的感染源，而市场是潜在的人畜共患病向人类溢出的点。考虑一个离散时间周期，在此期间发生贸易流动并评估溢出事件。该网络有两种节点类型：养殖场和市场。养殖场之间的移动混合了养殖场间的感染压力，而养殖场到市场的移动则将可能受感染的动物运送到市场。您必须推导一个程序，使用基于低流行率稀有事件理论的原则性近似方法，计算在单个周期内整个网络至少发生一次向人类溢出事件的概率。\n\n使用以下在传染病模型中广泛使用和测试的基础和假设：\n\n- 养殖场间的低流行率线性感染源混合：令 $A \\in \\mathbb{R}_{\\ge 0}^{F \\times F}$ 为有向的养殖场间移动矩阵，其条目 $A_{ij}$ 量化了从养殖场 $i$到养殖场 $j$ 的单位周期移动强度。令 $p^0 \\in [0,1]^F$ 为由非贸易来源（例如，本地野生动物感染源压力）引起的基础养殖场内感染流行率向量。假设感染是罕见的，因此一阶下一代近似成立：\n  $$p = p^0 + \\gamma A p,$$\n  其中 $p \\in [0,1]^F$ 是混合下的稳态期望流行率向量，$\\gamma \\in [0,\\infty)$ 是一个小的无量纲混合系数，捕捉了移动强度按比例转换为感染输入压力的过程。假设稳定性条件 $\\rho(\\gamma A)  1$ 成立，其中 $\\rho(\\cdot)$ 表示谱半径，因此\n  $$p = (I - \\gamma A)^{-1} p^0.$$\n\n- 从养殖场到市场的受感染运输的稀有事件近似：令 $W \\in \\mathbb{R}_{\\ge 0}^{F \\times M}$ 为养殖场到市场的运输矩阵，其条目 $W_{ij}$ 是每个周期从养殖场 $i$ 发送到市场 $j$ 的预期动物数量。对于稀有感染，根据小数定律，一个周期内从 $i$ 运输到 $j$ 的受感染动物数量可以建模为均值为 $p_i W_{ij}$ 的泊松随机变量。\n\n- 独立泊松过程的叠加：对于给定的市场 $j$，来自所有养殖场的总受感染到达数 $N_j$ 是泊松分布的，其均值为 $\\Lambda_j = \\sum_{i=1}^F p_i W_{ij}$。\n\n- 溢出事件的泊松稀疏化：在周期内，每次到达市场 $j$ 的受感染动物都会独立地以概率 $s_j \\in [0,1]$ 引发一次人类溢出事件，其中 $s \\in [0,1]^M$ 是市场上单个受感染动物引发溢出事件的概率向量。通过稀疏化，市场 $j$ 的人类溢出事件数量是均值为 $s_j \\Lambda_j$ 的泊松分布，并且各市场叠加产生整个网络的泊松溢出计数，其均值为 $\\sum_{j=1}^M s_j \\Lambda_j$。\n\n您的任务是：\n- 从以上各项出发，根据所述的稳定性和独立性假设，推导在单个周期内至少发生一次溢出的全网络概率的显式表达式，该表达式是关于 $A$、$\\gamma$、$p^0$、$W$ 和 $s$ 的函数。\n- 实现一个程序，为下面的每个测试用例计算此概率，并将最终概率四舍五入到六位小数。\n\n测试套件。对于每个案例，请使用指定的参数值。所有矩阵均以行主序给出。不需要物理单位；所有答案都是无量纲的概率，必须以 $[0,1]$ 范围内的十进制数报告。\n\n- 案例1（一般混合连接和贸易）：\n  - $F = 3$, $M = 2$。\n  - $A = \\begin{bmatrix} 0  0.6  0 \\\\ 0.2  0  0.3 \\\\ 0  0.1  0 \\end{bmatrix}$。\n  - $\\gamma = 0.3$。\n  - $p^0 = \\begin{bmatrix} 0.01 \\\\ 0.005 \\\\ 0.0 \\end{bmatrix}$。\n  - $W = \\begin{bmatrix} 50  20 \\\\ 40  10 \\\\ 0  30 \\end{bmatrix}$。\n  - $s = \\begin{bmatrix} 0.02 \\\\ 0.05 \\end{bmatrix}$。\n\n- 案例2（无感染源连接，贸易与案例1相同）：\n  - $F = 3$, $M = 2$。\n  - $A = \\begin{bmatrix} 0  0.6  0 \\\\ 0.2  0  0.3 \\\\ 0  0.1  0 \\end{bmatrix}$。\n  - $\\gamma = 0$。\n  - $p^0 = \\begin{bmatrix} 0.01 \\\\ 0.005 \\\\ 0.0 \\end{bmatrix}$。\n  - $W = \\begin{bmatrix} 50  20 \\\\ 40  10 \\\\ 0  30 \\end{bmatrix}$。\n  - $s = \\begin{bmatrix} 0.02 \\\\ 0.05 \\end{bmatrix}$。\n\n- 案例3（接近稳定性边界的高养殖场间连接性）：\n  - $F = 3$, $M = 2$。\n  - $A = \\begin{bmatrix} 0  4  0 \\\\ 4  0  0 \\\\ 0  0.5  0 \\end{bmatrix}$。\n  - $\\gamma = 0.24$。\n  - $p^0 = \\begin{bmatrix} 0.002 \\\\ 0.001 \\\\ 0.001 \\end{bmatrix}$。\n  - $W = \\begin{bmatrix} 200  0 \\\\ 200  50 \\\\ 0  100 \\end{bmatrix}$。\n  - $s = \\begin{bmatrix} 0.01 \\\\ 0.02 \\end{bmatrix}$。\n\n- 案例4（无到市场的贸易）：\n  - $F = 2$, $M = 2$。\n  - $A = \\begin{bmatrix} 0  0.1 \\\\ 0.05  0 \\end{bmatrix}$。\n  - $\\gamma = 0.1$。\n  - $p^0 = \\begin{bmatrix} 0.01 \\\\ 0.02 \\end{bmatrix}$。\n  - $W = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$。\n  - $s = \\begin{bmatrix} 0.05 \\\\ 0.1 \\end{bmatrix}$。\n\n- 案例5（大批量贸易和高单位感染溢出概率）：\n  - $F = 2$, $M = 1$。\n  - $A = \\begin{bmatrix} 0  1.0 \\\\ 0.5  0 \\end{bmatrix}$。\n  - $\\gamma = 0.2$。\n  - $p^0 = \\begin{bmatrix} 0.05 \\\\ 0.01 \\end{bmatrix}$。\n  - $W = \\begin{bmatrix} 1000 \\\\ 800 \\end{bmatrix}$。\n  - $s = \\begin{bmatrix} 0.3 \\end{bmatrix}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。该列表每个测试用例包含一个数字，每个数字是该案例中至少发生一次溢出的全网络概率，四舍五入到六位小数。例如，一个包含三个结果的输出应如下所示：$[\\text{r}_1,\\text{r}_2,\\text{r}_3]$，其中每个 $\\text{r}_k$ 是一个四舍五入到六位小数的十进制数。",
            "solution": "该问题被评估为有效，因为它科学地基于数学流行病学的既定原则，问题陈述清晰（well-posed），提供了所有必要信息，并以客观、正式的语言表述。稳定性条件 $\\rho(\\gamma A)  1$ 对所有测试用例均成立，确保了唯一且有意义的解的存在。\n\n目标是推导单个周期内至少发生一次溢出事件的全网络概率表达式，并为一组测试用例计算此值。推导过程从所提供的基本假设出发。\n\n### 步骤1：总溢出率的推导\n\n该模型定义了一系列从基础养殖场流行率到人畜共患病溢出的过程。我们首先推导整个网络总溢出的平均速率，记为 $\\Lambda_{\\text{total}}$。\n\n**1. 稳态养殖场流行率：**\n跨越 $F$ 个养殖场的稳态期望流行率向量 $p \\in [0,1]^F$ 由以下线性系统给出：\n$$p = p^0 + \\gamma A p$$\n其中 $p^0 \\in [0,1]^F$ 是基础流行率向量，$A \\in \\mathbb{R}_{\\ge 0}^{F \\times F}$ 是养殖场间移动矩阵，$\\gamma \\in [0,\\infty)$ 是混合系数。该方程可重排为：\n$$I p - \\gamma A p = p^0$$\n$$(I - \\gamma A) p = p^0$$\n这里，$I$ 是 $F \\times F$ 的单位矩阵。问题陈述指出稳定性条件 $\\rho(\\gamma A)  1$ 成立，其中 $\\rho(\\cdot)$ 是谱半径。这保证了矩阵 $(I - \\gamma A)$ 是可逆的，并且其逆矩阵具有非负项。因此我们可以解出 $p$：\n$$p = (I - \\gamma A)^{-1} p^0$$\n这个向量 $p$ 代表了在考虑了通过养殖场间贸易网络传播的感染后，每个养殖场的期望感染流行率。\n\n**2. 到达市场的受感染动物：**\n从养殖场 $i$ 到达市场 $j$ 的受感染动物的期望数量是 $p_i W_{ij}$，其中 $p_i$ 是养殖场 $i$ 的流行率，$W_{ij}$ 是养殖场到市场运输矩阵 $W \\in \\mathbb{R}_{\\ge 0}^{F \\times M}$ 中的条目。\n根据独立泊松过程叠加的假设，到达市场 $j$ 的总平均受感染动物数量，记为 $\\Lambda_j$，是来自所有养殖场的到达数量之和：\n$$\\Lambda_j = \\sum_{i=1}^F p_i W_{ij}$$\n我们可以将所有 $M$ 个市场的这些平均到达率集合表示为一个向量 $\\Lambda \\in \\mathbb{R}_{\\ge 0}^M$。这个向量可以使用矩阵-向量乘法写出：\n$$\\Lambda = W^T p$$\n其中 $W^T$ 是运输矩阵 $W$ 的转置。\n\n**3. 总溢出率：**\n在每个市场 $j$，每个受感染的动物以概率 $s_j$ 引发一次人类溢出事件。这些概率的向量是 $s \\in [0,1]^M$。根据泊松稀疏化的性质，市场 $j$ 的溢出事件数量是一个均值为 $s_j \\Lambda_j$ 的泊松过程。\n整个网络范围内的总溢出数量是所有市场溢出数量的总和。由于独立泊松随机变量之和也是一个泊松随机变量，总溢出数量遵循泊松分布，其均值 $\\Lambda_{\\text{total}}$ 等于各个市场均值之和：\n$$\\Lambda_{\\text{total}} = \\sum_{j=1}^M s_j \\Lambda_j$$\n这个和是向量 $s$ 和 $\\Lambda$ 的标量积：\n$$\\Lambda_{\\text{total}} = s^T \\Lambda$$\n代入 $\\Lambda$ 和 $p$ 的表达式，我们得到以输入参数表示的总溢出率的完整表达式：\n$$\\Lambda_{\\text{total}} = s^T (W^T p) = s^T W^T p$$\n$$\\Lambda_{\\text{total}} = s^T W^T (I - \\gamma A)^{-1} p^0$$\n\n### 步骤2：溢出概率的推导\n\n设 $Z$ 是表示一个周期内整个网络中溢出事件总数的随机变量。如上所述，$Z$ 服从均值为 $\\Lambda_{\\text{total}}$ 的泊松分布：\n$$Z \\sim \\text{Poisson}(\\Lambda_{\\text{total}})$$\n$Z$ 的概率质量函数由下式给出：\n$$P(Z=k) = \\frac{(\\Lambda_{\\text{total}})^k e^{-\\Lambda_{\\text{total}}}}{k!} \\quad \\text{for } k = 0, 1, 2, \\dots$$\n我们关心的是至少发生一次溢出事件的概率，即 $P(Z \\ge 1)$。最简单的计算方法是计算零次溢出事件概率 $P(Z=0)$ 的补集：\n$$P(Z \\ge 1) = 1 - P(Z=0)$$\n对于泊松分布，零事件的概率是：\n$$P(Z=0) = \\frac{(\\Lambda_{\\text{total}})^0 e^{-\\Lambda_{\\text{total}}}}{0!} = e^{-\\Lambda_{\\text{total}}}$$\n因此，整个网络至少发生一次溢出事件的概率是：\n$$P(Z \\ge 1) = 1 - e^{-\\Lambda_{\\text{total}}}$$\n代入 $\\Lambda_{\\text{total}}$ 的表达式，我们得到最终公式：\n$$P(\\text{spillover} \\ge 1) = 1 - \\exp\\left(-s^T W^T (I - \\gamma A)^{-1} p^0\\right)$$\n这个表达式允许根据给定的参数 $A$、$\\gamma$、$p^0$、$W$ 和 $s$ 直接计算所需的概率。\n\n### 步骤3：计算算法\n\n对每个测试用例，使用以下算法实现推导出的公式：\n1.  将输入参数 $A$、$p^0$、$W$ 和 $s$ 表示为 NumPy 数组，将 $\\gamma$ 表示为标量。\n2.  从矩阵 $A$ 的维度确定养殖场数量 $F$。\n3.  构建 $F \\times F$ 的单位矩阵 $I$。\n4.  计算矩阵 $M = I - \\gamma A$。\n5.  计算 $M$ 的逆矩阵，即 $M^{-1} = (I - \\gamma A)^{-1}$。\n6.  计算稳态流行率向量 $p = M^{-1} p^0$。\n7.  计算运输矩阵的转置 $W^T$。\n8.  计算总溢出率 $\\Lambda_{\\text{total}} = s^T W^T p$。在代码中，这可以计算为一系列点积。\n9.  计算最终概率 $P = 1 - \\exp(-\\Lambda_{\\text{total}})$。\n10. 按照规定将结果四舍五入到六位小数。\n\n将此过程应用于每个测试用例，以生成最终的概率列表。",
            "answer": "[0.129990,0.113063,0.999997,0.000000,1.000000]"
        }
    ]
}