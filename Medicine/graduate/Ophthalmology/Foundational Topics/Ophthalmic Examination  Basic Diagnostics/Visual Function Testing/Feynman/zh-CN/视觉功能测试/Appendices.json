{
    "hands_on_practices": [
        {
            "introduction": "视力是临床上最常测量的视觉功能，但不同的记录方法（如Snellen分数）在进行科学研究和统计分析时存在局限性。本练习旨在将临床常用的Snellen视力转换为在视觉心理物理学中更为标准和线性的logMAR单位。通过这个练习，你将巩固对不同视力标度之间换算关系及其背后几何光学原理的理解 。",
            "id": "4733066",
            "problem": "一名患者在标准测试距离下测得的远视力，使用斯内伦记法记录为 $20/40$。在临床视觉心理物理学中，小数视力定义为测试距离与“视标设计距离”（斯内伦分数的分母）之比；最小分辨角（MAR）定义为视标中可分辨的最小特征，以弧分为单位，是小数视力的倒数；最小分辨角对数（logMAR）定义为 $\\log_{10}(\\mathrm{MAR})$。另外，物理高度为 $H$ 的物体在视距 $d$ 处所对的几何视角 $\\theta$ 符合眼的小角度光学几何模型，该模型可从欧几里得几何的第一性原理推导得出：完整的所对角满足 $\\theta = 2 \\arctan\\!\\big(H/(2d)\\big)$，对于足够小的角度，在将 $\\theta$ 转换为弧度后，可以近似为 $\\theta \\approx H/d$。假设采用标准视标设计，其中字母的总高度对应 $5$ 弧分的视角。\n\n从这些核心定义和几何关系出发，针对给定的斯内伦视力 $20/40$ 和视距 $d = 4\\,\\mathrm{m}$，执行以下操作：\n\n1. 将斯内伦视力 $20/40$ 转换为 logMAR，其中 $\\log_{10}$ 表示以10为底的对数。\n2. 以弧分为单位，给出 MAR 的值。\n3. 计算在 $d=4\\,\\mathrm{m}$ 处，要使总视角达到 $5$ 弧分所需的物理字母高度 $H$（单位为毫米）（使用精确的几何关系 $\\theta = 2 \\arctan\\!\\big(H/(2d)\\big)$ 并将角度转换为弧度进行计算；在最终数值计算中不要使用小角度近似）。\n\n将 logMAR 和字母高度四舍五入到四位有效数字。将 MAR 表示为以弧分为单位的实数，不进行四舍五入。按以下顺序报告你的最终答案：logMAR（无量纲）、MAR（单位为弧分）和字母高度（单位为毫米）。",
            "solution": "斯内伦记法 $20/40$ 表示测试距离与视标行“设计距离”的比率。小数视力 $A_{\\mathrm{dec}}$ 定义为\n$$\nA_{\\mathrm{dec}} = \\frac{20}{40} = \\frac{1}{2} = 0.5.\n$$\n根据视觉心理物理学中的定义，最小分辨角（MAR）是最小可分辨特征的角尺寸（单位为弧分），并且是小数视力的倒数：\n$$\n\\mathrm{MAR} = \\frac{1}{A_{\\mathrm{dec}}} = \\frac{1}{0.5} = 2 \\text{ 弧分}。\n$$\n最小分辨角对数（logMAR）定义为\n$$\n\\mathrm{logMAR} = \\log_{10}(\\mathrm{MAR}) = \\log_{10}(2).\n$$\n符号上，$\\log_{10}(2)$ 是精确值；为了报告一个保留四位有效数字的数值，计算\n$$\n\\log_{10}(2) \\approx 0.3010 \\quad \\text{（四位有效数字）}。\n$$\n\n对于物理字母高度，使用高度 $H$、视距 $d$ 和完整所对角 $\\theta$ 之间的精确几何关系：\n$$\n\\theta = 2 \\arctan\\!\\left(\\frac{H}{2 d}\\right).\n$$\n我们已知标准字母总高度应对应 $\\theta = 5$ 弧分的视角。为了统一使用三角函数，将 $\\theta$ 转换为弧度。1度等于 $60$ 弧分，180度等于 $\\pi$ 弧度，所以\n$$\n\\theta_{\\mathrm{rad}} = 5 \\times \\frac{1}{60} \\times \\frac{\\pi}{180} = \\frac{5 \\pi}{10800} \\text{ 弧度}。\n$$\n求解 $H$ 的精确关系式可得\n$$\n\\theta = 2 \\arctan\\!\\left(\\frac{H}{2 d}\\right) \\;\\Rightarrow\\; \\arctan\\!\\left(\\frac{H}{2 d}\\right) = \\frac{\\theta}{2} \\;\\Rightarrow\\; \\frac{H}{2 d} = \\tan\\!\\left(\\frac{\\theta}{2}\\right) \\;\\Rightarrow\\; H = 2 d \\, \\tan\\!\\left(\\frac{\\theta}{2}\\right).\n$$\n代入 $d = 4\\,\\mathrm{m}$ 和 $\\theta_{\\mathrm{rad}} = \\frac{5 \\pi}{10800}$：\n$$\nH = 2 \\times 4 \\times \\tan\\!\\left(\\frac{1}{2} \\cdot \\frac{5 \\pi}{10800}\\right) \\,\\mathrm{m} = 8 \\, \\tan\\!\\left(\\frac{5 \\pi}{21600}\\right) \\,\\mathrm{m}.\n$$\n为了以毫米表示高度，乘以 $1000$：\n$$\nH_{\\mathrm{mm}} = 1000 \\times 8 \\, \\tan\\!\\left(\\frac{5 \\pi}{21600}\\right) = 8000 \\, \\tan\\!\\left(\\frac{5 \\pi}{21600}\\right) \\;\\mathrm{mm}.\n$$\n在数值上，由于 $\\frac{5 \\pi}{21600}$ 是一个小角度，我们仍然使用精确的 $\\tan$ 函数进行计算，然后进行四舍五入：\n$$\n\\frac{5 \\pi}{21600} \\approx 7.27220521664304 \\times 10^{-4} \\text{ 弧度}，\n$$\n所以\n$$\nH_{\\mathrm{mm}} = 8000 \\, \\tan\\!\\left(7.27220521664304 \\times 10^{-4}\\right) \\,\\mathrm{mm}.\n$$\n计算 $\\tan$ 值并相乘：\n$$\nH_{\\mathrm{mm}} \\approx 5.81776 \\,\\mathrm{mm}.\n$$\n四舍五入到四位有效数字：\n$$\nH_{\\mathrm{mm}} \\approx 5.818 \\,\\mathrm{mm}.\n$$\n\n按要求顺序汇总结果：\n- logMAR（无量纲）：$\\log_{10}(2) \\approx 0.3010$（四位有效数字），\n- MAR：$2$ 弧分（精确实数，不进行四舍五入），\n- 在 $d=4\\,\\mathrm{m}$ 处对应 $5$ 弧分视角的字母高度：$5.818$ 毫米（四位有效数字）。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.3010  2  5.818\\end{pmatrix}}$$"
        },
        {
            "introduction": "静态自动视野检查是青光眼等疾病诊断和监测的关键工具，但其结果的解读需要深刻理解刺激参数对阈值的影响。本练习将探讨视野检查中的一个核心概念——空间总和（spatial summation），并应用心理物理学定律来量化刺激大小变化对光敏感度阈值的影响。掌握这种定量分析能力对于高级临床解读和视觉科学研究至关重要 。",
            "id": "4733089",
            "problem": "一个实验室正在进行静态自动视野检查，以比较两种标准 Goldmann 视标大小在周边视网膜位置的检测阈值。在水平子午线离心率为 $30^\\circ$、稳定明视觉背景下，已知 Goldmann III 号和 Goldmann V 号视标都位于完全空间总和范围之外。实验者希望估计，在此离心率下假设存在空间部分总和的情况下，当从 Goldmann III 号视标切换到 Goldmann V 号视标时，差异亮度阈值（检测所需的背景之上的亮度增量）会改变多少。\n\n使用以下经过充分检验的事实作为基础：\n- 对于空间总和，差异亮度阈值 $T$ 取决于视标面积 $A$。在完全空间总和（Ricco 定律）下，$T \\propto A^{-1}$。超出临界面积（部分总和）时，周边位置的经验数据很好地符合幂律 $T \\propto A^{-\\beta}$，其中 $0  \\beta  1$（Piper 型行为）。在 $30^\\circ$ 离心率和明视觉背景下，一个被广泛观察到的斜率是 $\\beta = \\tfrac{1}{2}$。\n- Goldmann III 号和 Goldmann V 号视标的标准角直径分别为 $0.43^\\circ$ 和 $1.72^\\circ$。\n- 对于圆形视标，面积与角直径的平方成正比。\n- 以分贝 (dB) 表示的阈值变化定义为 $10 \\log_{10}\\!\\left(\\dfrac{T_{2}}{T_{1}}\\right)$，其中 $T_{1}$ 和 $T_{2}$ 是被比较的阈值。\n\n从这些基础出发，推导并计算从 Goldmann III 号视标转换到 Goldmann V 号视标时，在部分总和条件下，$30^\\circ$ 离心率处差异亮度阈值的预期带符号变化（以分贝为单位）。负值表示使用较大的视标进行检测需要较低的亮度增量。将您的最终答案四舍五入到四位有效数字，并以 dB（分贝）表示。",
            "solution": "### 解题推导\n设 $T_{III}$ 和 $T_V$ 分别为 Goldmann III 号和 Goldmann V 号视标的差异亮度阈值。设它们对应的面积为 $A_{III}$ 和 $A_V$，直径为 $d_{III}$ 和 $d_V$。\n\n问题指出，在部分总和条件下，阈值 $T$ 相对于视标面积 $A$ 遵循幂律：\n$$T \\propto A^{-\\beta}$$\n这可以写成一个方程 $T = k A^{-\\beta}$，其中 $k$ 是一个比例常数。\n\n因此，两种视标的阈值之比为：\n$$\\frac{T_V}{T_{III}} = \\frac{k A_V^{-\\beta}}{k A_{III}^{-\\beta}} = \\left(\\frac{A_V}{A_{III}}\\right)^{-\\beta}$$\n\n视标是圆形的，因此其面积 $A$ 与其直径 $d$ 的平方成正比：\n$$A \\propto d^2$$\n这意味着面积之比可以用直径之比来表示：\n$$\\frac{A_V}{A_{III}} = \\frac{c d_V^2}{c d_{III}^2} = \\left(\\frac{d_V}{d_{III}}\\right)^2$$\n其中 $c$ 是一个几何常数（具体来说，对于圆形面积，$c=\\frac{\\pi}{4}$，但其值无关紧要，因为它会消掉）。\n\n将此面积比代回阈值比方程可得：\n$$\\frac{T_V}{T_{III}} = \\left(\\left(\\frac{d_V}{d_{III}}\\right)^2\\right)^{-\\beta} = \\left(\\frac{d_V}{d_{III}}\\right)^{-2\\beta}$$\n\n问题指明，在给定的视网膜位置和背景下，指数为 $\\beta = \\frac{1}{2}$。代入此值：\n$$\\frac{T_V}{T_{III}} = \\left(\\frac{d_V}{d_{III}}\\right)^{-2\\left(\\frac{1}{2}\\right)} = \\left(\\frac{d_V}{d_{III}}\\right)^{-1} = \\frac{d_{III}}{d_V}$$\n\n给定的直径为 $d_{III} = 0.43^\\circ$ 和 $d_V = 1.72^\\circ$。我们现在可以计算直径之比。\n$$\\frac{d_V}{d_{III}} = \\frac{1.72}{0.43} = 4$$\n这意味着阈值比为：\n$$\\frac{T_V}{T_{III}} = \\frac{1}{4} = 0.25$$\n\n从 III 号视标（视标 1）变为 V 号视标（视标 2）时，阈值的变化量（以分贝为单位），$\\Delta_{\\text{dB}}$，定义为：\n$$\\Delta_{\\text{dB}} = 10 \\log_{10}\\left(\\frac{T_V}{T_{III}}\\right)$$\n代入阈值比的值：\n$$\\Delta_{\\text{dB}} = 10 \\log_{10}(0.25)$$\n\n为了计算数值：\n$$\\Delta_{\\text{dB}} = 10 \\log_{10}\\left(\\frac{1}{4}\\right) = 10 \\log_{10}(4^{-1}) = -10 \\log_{10}(4)$$\n使用对数性质 $\\log(x^y) = y \\log(x)$：\n$$\\Delta_{\\text{dB}} = -10 \\log_{10}(2^2) = -20 \\log_{10}(2)$$\n\n使用 $\\log_{10}(2) \\approx 0.30102999566$ 的高精度值：\n$$\\Delta_{\\text{dB}} \\approx -20 \\times 0.30102999566 = -6.0205999132$$\n问题要求答案四舍五入到四位有效数字。值为 $-6.02059...$。第四位有效数字是 $0$，其后的数字是 $5$，因此需要向上舍入。所以，该值四舍五入为 $-6.021$。\n\n负号表示 Goldmann V 号视标的阈值低于 III 号视标，这与较大视标更容易被检测到的原理相符。",
            "answer": "$$\n\\boxed{-6.021}\n$$"
        },
        {
            "introduction": "视觉功能评估不仅限于单一阈值测量，更全面地描述视觉系统特性通常需要构建功能模型。本练习将引导你对一个关键的视觉功能——对比敏感度函数（Contrast Sensitivity Function, CSF）进行建模，它比单一的视力值能更完整地评估空间视觉能力。通过将一个标准的非线性CSF模型线性化并进行数据拟合，你将获得视觉科学研究中一项核心的数据分析技能 。",
            "id": "4733125",
            "problem": "给定一个用于人眼对比敏感度函数（CSF）的参数模型，这是眼科视觉功能测试中使用的标准模型。该模型将敏感度描述为空间频率的函数，定义如下：对于空间频率 $f$（单位：周/度），敏感度 $S(f)$ 为\n$$\nS(f) = S_0 \\exp\\!\\left(-\\alpha \\ln^2\\!\\left(\\frac{f}{f_0}\\right)\\right),\n$$\n其中 $S_0$ 是峰值敏感度（无单位），$f_0$ 是峰值频率（单位：周/度），$\\alpha$ 是一个已知的正曲率参数。所有对数均为自然对数。\n\n您的任务是设计并实现一个程序，该程序针对每个数据集，通过基于第一性原理的原则性拟合来估计峰值敏感度 $S_0$ 和峰值频率 $f_0$。假设敏感度的测量噪声是乘性的（等价于在对数敏感度上是加性的）、在不同频率间是独立的，并且在对数域中近似服从高斯分布。在此假设下，通过最小化观测对数敏感度与模型预测对数敏感度之间的残差平方和来估计 $(S_0, f_0)$。将估计值约束为 $S_0 > 0$ 和 $f_0 > 0$。仅使用给定的数据和基本原理；不得假设或使用任何未从这些原理推导出的、预先派生的封闭形式“捷径”。\n\n重要要求：\n- 全程使用自然对数。\n- 以周/度（cpd）为单位报告 $f_0$。\n- 将 $S_0$ 报告为无单位量。\n- 在最终输出中，将 $S_0^{\\text{hat}}$ 四舍五入到两位小数，将 $f_0^{\\text{hat}}$ 四舍五入到三位小数。\n\n测试套件（每个测试用例提供 $\\alpha$、空间频率 $f_i$（单位：周/度）和观测到的敏感度 $S_i$）：\n- 测试用例1（无噪声，峰值周围对称采样）：\n  - $\\alpha = 0.4$\n  - $f = [0.5, 1, 2, 4, 8, 16]$ (单位：cpd)\n  - $S = [44.33, 115.89, 206.35, 250.00, 206.35, 115.89]$\n- 测试用例2（有噪声，峰值周围及尾部密集采样）：\n  - $\\alpha = 0.5$\n  - $f = [0.5, 1, 2, 3, 3.5, 5, 7, 10, 16]$ (单位：cpd)\n  - $S = [34.77, 95.41, 191.91, 210.88, 220.00, 214.71, 166.13, 114.18, 58.87]$\n- 测试用例3（稀疏采样，中等曲率）：\n  - $\\alpha = 0.6$\n  - $f = [0.75, 2, 6]$ (单位：cpd)\n  - $S = [84.23, 147.00, 74.15]$\n- 测试用例4（较平坦的CSF，较宽的峰值，中等噪声）：\n  - $\\alpha = 0.15$\n  - $f = [2, 4, 8, 10, 12, 16, 24]$ (单位：cpd)\n  - $S = [131.59, 181.63, 202.48, 200.00, 195.03, 185.75, 165.78]$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，列表中的每个元素本身都是一个双元素列表 [$S_0^{\\text{hat}}, f_0^{\\text{hat}}$]，按顺序对应于相应的测试用例。\n- 所需格式为：\n  - `[[$S_{0,1}^{\\text{hat}}, f_{0,1}^{\\text{hat}}$],[$S_{0,2}^{\\text{hat}}, f_{0,2}^{\\text{hat}}$],[$S_{0,3}^{\\text{hat}}, f_{0,3}^{\\text{hat}}$],[$S_{0,4}^{\\text{hat}}, f_{0,4}^{\\text{hat}}]$]`\n- 将 $S_0^{\\text{hat}}$ 四舍五入到两位小数，将 $f_0^{\\text{hat}}$ 四舍五入到三位小数，并以周/度（cpd）为单位报告 $f_0^{\\text{hat}}$。",
            "solution": "该问题被评估为有效，因为它在眼科领域具有科学依据，作为一个参数估计任务其提法是适定的，并且明确了所有必要的数据和客观约束。\n\n目标是为对比敏感度函数（CSF）模型估计峰值敏感度 $S_0$ 和峰值频率 $f_0$：\n$$\nS(f) = S_0 \\exp\\!\\left(-\\alpha \\ln^2\\!\\left(\\frac{f}{f_0}\\right)\\right)\n$$\n给定一组测量值 $(f_i, S_i)$ 和一个已知的曲率参数 $\\alpha$。估计必须基于在对数敏感度域中最小化残差平方和的原理。\n\n### 从第一性原理推导\n\n核心原理是将最小二乘估计应用于模型的变换形式。噪声在敏感度 $S$ 上被假设为乘性的，这等价于在对数敏感度 $\\ln(S)$ 上是加性的且服从高斯分布。这意味着需要最小化的适当目标函数是对数域中的误差平方和。\n\n1.  **模型的对数变换：**\n    我们首先对模型方程取自然对数以线性化其结构。令 $y = \\ln(S)$ 和 $x = \\ln(f)$。\n    $$\n    \\ln(S(f)) = \\ln\\left(S_0 \\exp\\left(-\\alpha \\ln^2\\left(\\frac{f}{f_0}\\right)\\right)\\right)\n    $$\n    使用对数性质 $\\ln(ab) = \\ln(a) + \\ln(b)$ 和 $\\ln(e^c) = c$：\n    $$\n    \\ln(S(f)) = \\ln(S_0) - \\alpha \\ln^2\\left(\\frac{f}{f_0}\\right)\n    $$\n    使用 $\\ln(a/b) = \\ln(a) - \\ln(b)$ 进一步展开平方项：\n    $$\n    \\ln(S) = \\ln(S_0) - \\alpha (\\ln(f) - \\ln(f_0))^2\n    $$\n    该方程描述了敏感度与频率的双对数图中的一条抛物线。\n\n2.  **通过变量替换进行线性化：**\n    为简化估计，我们可以将方程重排为适合线性回归的形式。令 $y_0 = \\ln(S_0)$ 和 $x_0 = \\ln(f_0)$ 为待估计的变换后参数。对于单个数据点 $(x_i, y_i)$，其中 $x_i = \\ln(f_i)$ 且 $y_i=\\ln(S_i)$，模型为：\n    $$\n    y_i \\approx y_0 - \\alpha(x_i - x_0)^2\n    $$\n    展开二次项：\n    $$\n    y_i \\approx y_0 - \\alpha(x_i^2 - 2x_i x_0 + x_0^2)\n    $$\n    重新排列各项以将未知数分组：\n    $$\n    y_i + \\alpha x_i^2 \\approx (y_0 - \\alpha x_0^2) + (2\\alpha x_0) x_i\n    $$\n    该方程现在是线性模型的形式。我们定义新的因变量 $z_i = y_i + \\alpha x_i^2$ 和新的系数 $c_0 = y_0 - \\alpha x_0^2$ 及 $c_1 = 2\\alpha x_0$。模型变为一个简单的线性回归：\n    $$\n    z_i \\approx c_0 + c_1 x_i\n    $$\n\n3.  **最小二乘最小化：**\n    我们需要找到使残差平方和 $Q$ 最小化的估计值 $\\hat{c_0}$ 和 $\\hat{c_1}$：\n    $$\n    Q(c_0, c_1) = \\sum_{i=1}^n (z_i - (c_0 + c_1 x_i))^2\n    $$\n    为求最小值，我们将 $Q$ 对 $c_0$ 和 $c_1$ 的偏导数设为零。\n    $$\n    \\frac{\\partial Q}{\\partial c_0} = \\sum_{i=1}^n 2(z_i - c_0 - c_1 x_i)(-1) = 0 \\implies \\sum_{i=1}^n (z_i - c_0 - c_1 x_i) = 0\n    $$\n    $$\n    \\frac{\\partial Q}{\\partial c_1} = \\sum_{i=1}^n 2(z_i - c_0 - c_1 x_i)(-x_i) = 0 \\implies \\sum_{i=1}^n (z_i x_i - c_0 x_i - c_1 x_i^2) = 0\n    $$\n    这导出了简单线性回归的正规方程组：\n    $$\n    \\begin{align*}\n    n c_0 + \\left(\\sum x_i\\right) c_1 = \\sum z_i \\\\\n    \\left(\\sum x_i\\right) c_0 + \\left(\\sum x_i^2\\right) c_1 = \\sum x_i z_i\n    \\end{align*}\n    $$\n    这是一个关于 $(c_0, c_1)$ 的 $2 \\times 2$ 线性方程组。解此方程组可得最小二乘估计值 $\\hat{c_0}$ 和 $\\hat{c_1}$：\n    $$\n    \\hat{c_1} = \\frac{n(\\sum x_i z_i) - (\\sum x_i)(\\sum z_i)}{n(\\sum x_i^2) - (\\sum x_i)^2}\n    $$\n    $$\n    \\hat{c_0} = \\bar{z} - \\hat{c_1} \\bar{x}\n    $$\n    其中 $\\bar{x} = \\frac{1}{n}\\sum x_i$ 且 $\\bar{z} = \\frac{1}{n}\\sum z_i$。\n\n4.  **反变换回原始参数：**\n    一旦计算出 $\\hat{c_0}$ 和 $\\hat{c_1}$，我们就可以恢复原始对数域参数的估计值 $\\hat{x_0}$ 和 $\\hat{y_0}$。\n    从 $c_1 = 2\\alpha x_0$ 可得：\n    $$\n    \\hat{x_0} = \\frac{\\hat{c_1}}{2\\alpha}\n    $$\n    从 $c_0 = y_0 - \\alpha x_0^2$ 可得：\n    $$\n    \\hat{y_0} = \\hat{c_0} + \\alpha \\hat{x_0}^2\n    $$\n\n5.  **最终参数估计：**\n    最后，我们通过应用指数函数获得 $S_0$ 和 $f_0$ 的估计值：\n    $$\n    \\hat{f_0} = \\exp(\\hat{x_0})\n    $$\n    $$\n    \\hat{S_0} = \\exp(\\hat{y_0})\n    $$\n    约束条件 $S_0 > 0$ 和 $f_0 > 0$ 在此过程中被自动满足，因为指数函数的取值范围是所有正实数。\n\n这个分步过程提供了从最小二乘最小化第一性原理推导出的 $S_0$ 和 $f_0$ 的估计值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_csf_params(alpha, f_data, s_data):\n    \"\"\"\n    Estimates the parameters S0 and f0 of the CSF model using linear least squares\n    on a transformed version of the model.\n\n    Args:\n        alpha (float): The known curvature parameter.\n        f_data (np.ndarray): Array of spatial frequencies in cycles per degree.\n        s_data (np.ndarray): Array of observed sensitivities.\n\n    Returns:\n        tuple[float, float]: A tuple containing the estimated (S0_hat, f0_hat).\n    \"\"\"\n    # Step 1: Log-transform the data.\n    # The model is S(f) = S0 * exp(-alpha * ln(f/f0)^2).\n    # In the log-log domain, this is ln(S) = ln(S0) - alpha * (ln(f) - ln(f0))^2.\n    # Let x = ln(f) and y = ln(S). The model becomes y = y0 - alpha * (x - x0)^2.\n    x = np.log(f_data)\n    y = np.log(s_data)\n    n = len(f_data)\n\n    # Step 2: Linearize the model.\n    # y = y0 - alpha * (x^2 - 2*x*x0 + x0^2)\n    # y + alpha*x^2 = (y0 - alpha*x0^2) + (2*alpha*x0)*x\n    # This is a linear model z = c0 + c1*x, where:\n    # z = y + alpha*x^2\n    # c1 = 2*alpha*x0\n    # c0 = y0 - alpha*x0^2\n    z = y + alpha * x**2\n\n    # Step 3: Perform linear regression of z on x to find c0 and c1.\n    # We solve the normal equations for simple linear regression.\n    sum_x = np.sum(x)\n    sum_z = np.sum(z)\n    sum_x_sq = np.sum(x**2)\n    sum_xz = np.sum(x * z)\n\n    # Denominator of the ordinary least squares (OLS) estimators\n    denom = n * sum_x_sq - sum_x**2\n\n    # Estimate c1 and c0\n    c1_hat = (n * sum_xz - sum_x * sum_z) / denom\n    c0_hat = np.mean(z) - c1_hat * np.mean(x)\n\n    # Step 4: Back-transform to get estimates for x0 and y0 (log-domain parameters).\n    # x0 = ln(f0), y0 = ln(S0)\n    x0_hat = c1_hat / (2 * alpha)\n    y0_hat = c0_hat + alpha * x0_hat**2\n\n    # Step 5: Transform back to the original parameter space (S0, f0).\n    s0_hat = np.exp(y0_hat)\n    f0_hat = np.exp(x0_hat)\n\n    return s0_hat, f0_hat\n\ndef solve():\n    \"\"\"\n    Main function to run the estimation on all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.4, np.array([0.5, 1, 2, 4, 8, 16]), np.array([44.33, 115.89, 206.35, 250.00, 206.35, 115.89])),\n        (0.5, np.array([0.5, 1, 2, 3, 3.5, 5, 7, 10, 16]), np.array([34.77, 95.41, 191.91, 210.88, 220.00, 214.71, 166.13, 114.18, 58.87])),\n        (0.6, np.array([0.75, 2, 6]), np.array([84.23, 147.00, 74.15])),\n        (0.15, np.array([2, 4, 8, 10, 12, 16, 24]), np.array([131.59, 181.63, 202.48, 200.00, 195.03, 185.75, 165.78]))\n    ]\n    \n    formatted_results = []\n    for alpha, f_data, s_data in test_cases:\n        # Calculate the estimates for the current test case\n        s0_hat, f0_hat = solve_csf_params(alpha, f_data, s_data)\n        \n        # Round the estimates to the specified decimal places\n        s0_rounded = round(s0_hat, 2)\n        f0_rounded = round(f0_hat, 3)\n        \n        # Format the result for this case as a string '[S0,f0]' ensuring trailing zeros\n        result_str = f\"[{s0_rounded:.2f},{f0_rounded:.3f}]\"\n        formatted_results.append(result_str)\n\n    # Final print statement in the exact required format: [[S_hat1, f_hat1],[S_hat2, f_hat2],...]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}