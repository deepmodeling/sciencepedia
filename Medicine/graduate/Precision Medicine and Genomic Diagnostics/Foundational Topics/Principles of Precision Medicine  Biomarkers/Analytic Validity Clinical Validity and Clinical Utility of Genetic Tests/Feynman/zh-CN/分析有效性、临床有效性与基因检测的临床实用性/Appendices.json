{
    "hands_on_practices": [
        {
            "introduction": "评估基因检测的第一步是验证其分析有效性——即确保检测能够准确、可靠地测量目标物质。本实践练习聚焦于量化精密度，这是分析有效性的基石。你将应用一个嵌套随机效应模型来剖析定量检测中的变异来源，从而区分重复性（相同条件下的检测一致性）和再现性（不同操作员和仪器间的检测一致性）。",
            "id": "4316319",
            "problem": "您的任务是为一项定量基因检测（例如，下一代测序（NGS）的变异等位基因频率）建立分析精密度的规范，并在一个嵌套测量系统下计算汇总精密度指标。目标是使用跨仪器和操作员的嵌套方差分量来定义和量化重复性和再现性。\n\n出发点与核心定义：\n- 分析有效性是指检测方法能够测量其声称要测量的目标物质的能力。对于一个建模为随机变量 $Y$ 的连续检测输出，精密度由 $Y$ 在受控条件下的变异性来表征。\n- 重复性是在相同条件下（相同仪器、相同操作员、相同试剂、相同环境）重复检测时观察到的变异性，并通过条件内误差方差进行量化。\n- 再现性是在常规使用中预期的变化条件下（例如，不同仪器、不同操作员）进行检测时观察到的变异性，并通过这些来源的总体变异性进行量化。\n- 变异系数（CV）是一个无标度精密度指标，定义为 $CV = \\frac{\\sqrt{\\mathrm{Var}(Y)}}{\\mu}$，其中 $\\mu$ 是 $Y$ 的平均水平。此处表示为小数，不带百分号。\n\n分层测量系统模型：\n- 考虑加性随机效应模型 $Y_{ijk} = \\mu + I_i + O_{j(i)} + \\epsilon_{ijk}$，其中 $I_i$ 是仪器 $i$ 的随机效应，$O_{j(i)}$ 是嵌套在仪器 $i$ 内的操作员 $j$ 的随机效应，$\\epsilon_{ijk}$ 是重复测量 $k$ 的残差重复性误差。假设 $I_i$、$O_{j(i)}$ 和 $\\epsilon_{ijk}$ 是相互独立的、均值为零的随机变量，其方差分别为 $\\sigma_I^2$、$\\sigma_{O(I)}^2$ 和 $\\sigma_e^2$。在独立性和加性假设下，归因于每组条件的方差由相关方差分量求和得出。\n\n任务：\n- 编写一个程序，为每个测试用例计算三个量：\n  1. 仅使用残差分量 $\\,\\sigma_e^2\\,$ 计算重复性 $CV$。\n  2. 使用 $\\,\\sigma_{O(I)}^2 + \\sigma_e^2\\,$ 计算仪器内操作员 $CV$。\n  3. 使用 $\\,\\sigma_I^2 + \\sigma_{O(I)}^2 + \\sigma_e^2\\,$ 计算跨仪器和操作员的再现性 $CV$。\n- 对上述每种情况，使用定义 $CV = \\frac{\\sqrt{\\mathrm{Var}}}{\\mu}$ 进行计算，并将 $\\,\\mu\\,$ 视为总平均水平。如果对于某个小阈值 $\\varepsilon = 10^{-12}$，有 $|\\mu|  \\varepsilon$，则为相应的 $CV$ 返回一个非数值指示符，以避免除法不稳定性。\n- 所有 $CV$ 值必须表示为小数（无单位），并四舍五入到六位小数。\n\n每个测试用例的输入规范：\n- 程序必须使用以下测试套件参数集，每个参数集指定为 $(\\mu, \\sigma_I^2, \\sigma_{O(I)}^2, \\sigma_e^2)$：\n  - 情况 A（一般情况）：$(\\mu = 0.25, \\sigma_I^2 = 0.0004, \\sigma_{O(I)}^2 = 0.0001, \\sigma_e^2 = 0.00005)$。\n  - 情况 B（无仪器变异性）：$(\\mu = 0.50, \\sigma_I^2 = 0, \\sigma_{O(I)}^2 = 0.0002, \\sigma_e^2 = 0.0001)$。\n  - 情况 C（均值接近零的边缘情况）：$(\\mu = 0.01, \\sigma_I^2 = 0.000001, \\sigma_{O(I)}^2 = 0.000002, \\sigma_e^2 = 0.000001)$。\n  - 情况 D（残差和操作员方差为零的边界情况）：$(\\mu = 0.30, \\sigma_I^2 = 0.0009, \\sigma_{O(I)}^2 = 0, \\sigma_e^2 = 0)$。\n  - 情况 E（高均值，小方差）：$(\\mu = 0.90, \\sigma_I^2 = 0.00005, \\sigma_{O(I)}^2 = 0.00005, \\sigma_e^2 = 0.00002)$。\n\n输出规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个测试用例（按 A 到 E 的顺序），其本身是一个包含三个四舍五入到六位小数的列表：$[CV_{\\text{repeatability}}, CV_{\\text{operator-within-instrument}}, CV_{\\text{reproducibility}}]$。\n- 例如，输出结构必须如下所示：$[[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots,[a_5,b_5,c_5]]$，其中每个 $a_i$、$b_i$、$c_i$ 都是一个浮点数。\n\n由于变异系数是无量纲的，因此不适用物理单位。不使用角度。所有小数必须以无单位分数形式呈现（不带百分号）。",
            "solution": "我们从精准医疗和基因组诊断中分析有效性的角度出发。定量检测输出，如来自下一代测序（NGS）的变异等位基因频率，被建模为一个随机变量 $Y$，其平均水平为 $\\mu$，变异性由多个来源驱动。重复性和再现性是分析精密度的不同方面。重复性是指在所有可控条件保持不变时的变异性，而再现性则汇总了在不同仪器和操作员之间变化时的变异性，代表了真实的条件间变异性。\n\n为了计算变异系数（CV），我们采用无标度精密度指标，定义为 $CV = \\frac{\\sqrt{\\mathrm{Var}(Y)}}{\\mu}$。该指标是合适的，因为它将离散度归一化到平均水平，使得在不同量级的 $\\mu$ 之间的比较更有意义。我们将 CV 表示为小数（而非百分比）以避免歧义。\n\n模型公式化与基本原理：\n- 我们为一个测量值 $Y_{ijk}$ 设定一个分层加性随机效应模型：\n  $$Y_{ijk} = \\mu + I_i + O_{j(i)} + \\epsilon_{ijk},$$\n  其中 $I_i$ 是仪器 $i$ 的仪器效应，$O_{j(i)}$ 是嵌套在仪器 $i$ 内的操作员 $j$ 的操作员效应，$\\epsilon_{ijk}$ 是在固定仪器和操作员下重复测量 $k$ 的残差（条件内）误差。假设这些随机效应是相互独立且中心化的：$\\mathbb{E}[I_i] = 0$，$\\mathbb{E}[O_{j(i)}] = 0$，$\\mathbb{E}[\\epsilon_{ijk}] = 0$，其方差分别为 $\\mathrm{Var}(I_i) = \\sigma_I^2$，$\\mathrm{Var}(O_{j(i)}) = \\sigma_{O(I)}^2$ 和 $\\mathrm{Var}(\\epsilon_{ijk}) = \\sigma_e^2$。\n\n- 利用加性随机效应的独立性以及方差的性质（对于独立变量 $X$ 和 $Z$，$\\mathrm{Var}(X+Z) = \\mathrm{Var}(X) + \\mathrm{Var}(Z)$），在给定条件集下的总方差是所包含效应的方差之和。\n\n根据第一性原理，我们为特定条件集构建 CV：\n1. 重复性 CV：\n   - 定义：相同仪器、相同操作员、相同环境。只有残差误差有贡献。\n   - 方差：$$\\mathrm{Var}_{\\text{repeat}}(Y) = \\sigma_e^2.$$\n   - CV：$$CV_{\\text{repeat}} = \\frac{\\sqrt{\\sigma_e^2}}{\\mu}.$$\n\n2. 仪器内操作员 CV：\n   - 定义：在固定仪器内嵌套的操作员间的变异，加上残差误差。这代表了在保持仪器不变的情况下，操作员间的中间精密度。\n   - 方差：$$\\mathrm{Var}_{\\text{operator}}(Y) = \\sigma_{O(I)}^2 + \\sigma_e^2.$$\n   - CV：$$CV_{\\text{operator}} = \\frac{\\sqrt{\\sigma_{O(I)}^2 + \\sigma_e^2}}{\\mu}.$$\n\n3. 再现性 CV（跨仪器和操作员）：\n   - 定义：跨仪器和操作员的变异，反映了常规实施下的真实条件间变异性。\n   - 方差：$$\\mathrm{Var}_{\\text{reprod}}(Y) = \\sigma_I^2 + \\sigma_{O(I)}^2 + \\sigma_e^2.$$\n   - CV：$$CV_{\\text{reprod}} = \\frac{\\sqrt{\\sigma_I^2 + \\sigma_{O(I)}^2 + \\sigma_e^2}}{\\mu}.$$\n\n数值稳定性：\n- 当 $|\\mu|$ 过小时，除以 $\\mu$ 会使 CV 的计算不稳定。我们引入一个阈值 $\\varepsilon = 10^{-12}$，如果 $|\\mu|  \\varepsilon$，则返回一个非数值指示符。\n\n算法设计：\n- 对于每个具有参数 $(\\mu, \\sigma_I^2, \\sigma_{O(I)}^2, \\sigma_e^2)$ 的情况：\n  - 计算 $v_{\\text{repeat}} = \\sigma_e^2$、$v_{\\text{operator}} = \\sigma_{O(I)}^2 + \\sigma_e^2$ 和 $v_{\\text{reprod}} = \\sigma_I^2 + \\sigma_{O(I)}^2 + \\sigma_e^2$。\n  - 如果 $|\\mu| \\ge \\varepsilon$，则计算每个 $CV$ 为 $\\frac{\\sqrt{v}}{\\mu}$；否则返回非数值。\n  - 将每个 $CV$ 四舍五入到六位小数。\n- 将每个情况的三个 $CV$ 值聚合到一个列表中，并输出所有情况的列表的列表。\n\n测试套件与预期行为：\n- 情况 A：$(\\mu = 0.25, \\sigma_I^2 = 0.0004, \\sigma_{O(I)}^2 = 0.0001, \\sigma_e^2 = 0.00005)$。\n  - $CV_{\\text{repeat}} \\approx 0.028284$，$CV_{\\text{operator}} \\approx 0.048990$，$CV_{\\text{reprod}} \\approx 0.093808$。\n- 情况 B：$(\\mu = 0.50, \\sigma_I^2 = 0, \\sigma_{O(I)}^2 = 0.0002, \\sigma_e^2 = 0.0001)$。\n  - $CV_{\\text{repeat}} \\approx 0.020000$，$CV_{\\text{operator}} \\approx 0.034641$，$CV_{\\text{reprod}} \\approx 0.034641$。\n- 情况 C：$(\\mu = 0.01, \\sigma_I^2 = 0.000001, \\sigma_{O(I)}^2 = 0.000002, \\sigma_e^2 = 0.000001)$。\n  - $CV_{\\text{repeat}} \\approx 0.100000$，$CV_{\\text{operator}} \\approx 0.173205$，$CV_{\\text{reprod}} \\approx 0.200000$。\n- 情况 D：$(\\mu = 0.30, \\sigma_I^2 = 0.0009, \\sigma_{O(I)}^2 = 0, \\sigma_e^2 = 0)$。\n  - $CV_{\\text{repeat}} \\approx 0.000000$，$CV_{\\text{operator}} \\approx 0.000000$，$CV_{\\text{reprod}} \\approx 0.100000$。\n- 情况 E：$(\\mu = 0.90, \\sigma_I^2 = 0.00005, \\sigma_{O(I)}^2 = 0.00005, \\sigma_e^2 = 0.00002)$。\n  - $CV_{\\text{repeat}} \\approx 0.004969$，$CV_{\\text{operator}} \\approx 0.009296$，$CV_{\\text{reprod}} \\approx 0.012172$。\n\n背景整合：\n- 这些 CV 量化了作为分析有效性核心的分析精密度分量。临床有效性将检测输出 $Y$ 与临床状况（例如，致病性变异）的存在或风险联系起来，而临床实用性则评估决策使用下的净患者获益。在重复性和再现性下稳健的分析精密度支持但不单独确立临床有效性或实用性；这些需要关于灵敏度、特异性、预测值和结局的独立证据。\n\n程序将按所述实现计算，并为所有情况生成一个单行嵌套的四舍五入小数值列表。",
            "answer": "```python\nimport numpy as np\n\ndef compute_cvs(mu, sigma2_instr, sigma2_oper_in_instr, sigma2_error, eps=1e-12):\n    \"\"\"\n    Compute repeatability, operator-within-instrument, and reproducibility CVs.\n    CV = sqrt(variance_component)/mu, returned as floats.\n    If |mu|  eps, return np.nan for the corresponding CV to avoid instability.\n    \"\"\"\n    # Variance components for each precision definition\n    var_repeat = sigma2_error\n    var_operator = sigma2_oper_in_instr + sigma2_error\n    var_reprod = sigma2_instr + sigma2_oper_in_instr + sigma2_error\n\n    if abs(mu)  eps:\n        return [float('nan'), float('nan'), float('nan')]\n\n    cv_repeat = np.sqrt(var_repeat) / mu\n    cv_operator = np.sqrt(var_operator) / mu\n    cv_reprod = np.sqrt(var_reprod) / mu\n\n    # Round to six decimal places\n    return [round(cv_repeat, 6), round(cv_operator, 6), round(cv_reprod, 6)]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (mu, sigma_I^2, sigma_{O(I)}^2, sigma_e^2)\n    test_cases = [\n        (0.25, 0.0004, 0.0001, 0.00005),    # Case A\n        (0.50, 0.0,    0.0002, 0.0001),     # Case B\n        (0.01, 0.000001, 0.000002, 0.000001),  # Case C\n        (0.30, 0.0009, 0.0,    0.0),        # Case D\n        (0.90, 0.00005, 0.00005, 0.00002),  # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        mu, sigma2_instr, sigma2_oper_in_instr, sigma2_error = case\n        cvs = compute_cvs(mu, sigma2_instr, sigma2_oper_in_instr, sigma2_error)\n        results.append(cvs)\n\n    # Final print statement in the exact required format.\n    # Nested list printed as a single line with comma-separated elements.\n    # Ensure standard Python list representation.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "当一个检测被证明具有分析上的精密性后，重点便转向其临床有效性：该检测在多大程度上能预测临床状况？本练习将揭示诊断测试中的一个关键原则：疾病患病率对检测预测价值的深远影响。通过计算阳性预测值（$PPV$）等指标，你将亲身体会到为何即使一个具有极高灵敏度和特异性的检测，在低患病率的筛查人群中也可能产生误导。",
            "id": "4316259",
            "problem": "一种用于检测与单基因疾病相关的高外显率致病性变异的实验室自建检测方法，正被考虑用于人群普筛。该检测方法的分析验证表明，在重复实验中，实验室测量误差可忽略不计。在一项于目标筛查人群中进行的前瞻性临床验证研究中，估计出以下操作特性：灵敏度 $Se = 0.98$，特异度 $Sp = 0.99$，以及筛查人群中的疾病患病率 $\\pi = 0.001$。仅从灵敏度、特异度、患病率、条件概率的贝叶斯定理以及似然比的定义出发，完成以下任务：\n\n1. 推导阳性预测值 $PPV = P(D \\mid +)$ 的表达式，用 $Se$、$Sp$ 和 $\\pi$ 表示，其中 $D$ 表示患病，$+$ 表示检测阳性。\n2. 推导阴性预测值 $NPV = P(\\overline{D} \\mid -)$ 的表达式，用 $Se$、$Sp$ 和 $\\pi$ 表示。\n3. 使用定义 $LR^{+} = \\dfrac{P(+ \\mid D)}{P(+ \\mid \\overline{D})}$ 和 $LR^{-} = \\dfrac{P(- \\mid D)}{P(- \\mid \\overline{D})}$，推导阳性似然比 $LR^{+}$ 和阴性似然比 $LR^{-}$ 的表达式。\n4. 计算当 $Se=0.98$、$Sp=0.99$ 和 $\\pi=0.001$ 时，$PPV$、$NPV$、$LR^{+}$ 和 $LR^{-}$ 的数值，将概率表示为小数（而非百分比）。\n5. 在精准医学和基因组诊断学的背景下，简要解释为何在此应用场景中，尽管分析性能优异且临床灵敏度和特异度很高，但 $PPV$ 仍然可能很低，并将你的解释与检验前概率联系起来。\n\n仅报告 $PPV$ 的数值作为最终答案。将最终答案四舍五入至四位有效数字。最终答案中不包含任何单位。",
            "solution": "该问题被评估为有效，因为它具有科学依据、问题明确且客观。它基于生物统计学和诊断测试评估的基本原则，为得出唯一且有意义的解提供了所有必要信息。问题陈述与精准医学和基因组诊断学领域直接相关。\n\n提供的参数如下：\n- 灵敏度, $Se = P(+ \\mid D) = 0.98$\n- 特异度, $Sp = P(- \\mid \\overline{D}) = 0.99$\n- 患病率, $\\pi = P(D) = 0.001$\n\n我们的任务是完成五项工作：推导阳性预测值 ($PPV$) 和阴性预测值 ($NPV$) 的表达式，推导似然比 ($LR^{+}$ 和 $LR^{-}$) 的表达式，计算它们的数值，并对所得的 $PPV$ 进行解释。\n\n**1. 阳性预测值 ($PPV$) 的推导**\n\n阳性预测值是指在检测结果为阳性的条件下，受试者确实患病的概率，记为 $PPV = P(D \\mid +)$。根据条件概率的贝叶斯定理，我们可以写出：\n$$ PPV = P(D \\mid +) = \\frac{P(+ \\mid D) P(D)}{P(+)} $$\n分子项是患病且检测结果为阳性的联合概率。分母 $P(+)$ 是检测结果为阳性的边际概率。我们可以使用全概率公式展开 $P(+)$，即对两种可能的疾病状态（患病 $D$ 或不患病 $\\overline{D}$）求和：\n$$ P(+) = P(+ \\mid D) P(D) + P(+ \\mid \\overline{D}) P(\\overline{D}) $$\n现在我们可以使用给定的灵敏度 ($Se$)、特异度 ($Sp$) 和患病率 ($\\pi$) 的定义来表示所有项：\n- $P(+ \\mid D) = Se$\n- $P(D) = \\pi$\n- $P(\\overline{D}) = 1 - P(D) = 1 - \\pi$\n- 在未患病的情况下检测结果为阳性的概率 $P(+ \\mid \\overline{D})$ 是假阳性率，等于 $1 - Sp$。即，$P(+ \\mid \\overline{D}) = 1 - P(- \\mid \\overline{D}) = 1 - Sp$。\n\n将这些代入 $P(+)$ 的表达式中：\n$$ P(+) = (Se)(\\pi) + (1 - Sp)(1 - \\pi) $$\n最后，将这个展开的 $P(+)$ 代回 $PPV$ 的贝叶斯定理公式，得到所需的表达式：\n$$ PPV = \\frac{Se \\cdot \\pi}{Se \\cdot \\pi + (1 - Sp)(1 - \\pi)} $$\n\n**2. 阴性预测值 ($NPV$) 的推导**\n\n阴性预测值是指在检测结果为阴性的条件下，受试者确实未患病的概率，记为 $NPV = P(\\overline{D} \\mid -)$。应用贝叶斯定理：\n$$ NPV = P(\\overline{D} \\mid -) = \\frac{P(- \\mid \\overline{D}) P(\\overline{D})}{P(-)} $$\n分母 $P(-)$ 是检测结果为阴性的边际概率。我们可以使用全概率公式将其展开：\n$$ P(-) = P(- \\mid D) P(D) + P(- \\mid \\overline{D}) P(\\overline{D}) $$\n我们使用给定的定义来表示这些项：\n- $P(- \\mid \\overline{D}) = Sp$\n- $P(\\overline{D}) = 1 - \\pi$\n- 在患病的情况下检测结果为阴性的概率 $P(- \\mid D)$ 是假阴性率，等于 $1 - Se$。即，$P(- \\mid D) = 1 - P(+ \\mid D) = 1 - Se$。\n- $P(D) = \\pi$\n\n将这些代入 $P(-)$ 的表达式中：\n$$ P(-) = (1 - Se)(\\pi) + (Sp)(1 - \\pi) $$\n将此代回 $NPV$ 的公式中：\n$$ NPV = \\frac{Sp \\cdot (1 - \\pi)}{(1 - Se) \\cdot \\pi + Sp \\cdot (1 - \\pi)} $$\n\n**3. 似然比 ($LR^{+}$ 和 $LR^{-}$) 的推导**\n\n阳性似然比 $LR^{+}$ 定义为患病个体中检测结果为阳性的概率与非患病个体中检测结果为阳性的概率之比。\n$$ LR^{+} = \\frac{P(+ \\mid D)}{P(+ \\mid \\overline{D})} $$\n使用所提供的定义：\n- 分子：$P(+ \\mid D) = Se$\n- 分母：$P(+ \\mid \\overline{D}) = 1 - Sp$\n因此，阳性似然比的表达式为：\n$$ LR^{+} = \\frac{Se}{1 - Sp} $$\n\n阴性似然比 $LR^{-}$ 定义为患病个体中检测结果为阴性的概率与非患病个体中检测结果为阴性的概率之比。\n$$ LR^{-} = \\frac{P(- \\mid D)}{P(- \\mid \\overline{D})} $$\n使用所提供的定义：\n- 分子：$P(- \\mid D) = 1 - Se$\n- 分母：$P(- \\mid \\overline{D}) = Sp$\n因此，阴性似然比的表达式为：\n$$ LR^{-} = \\frac{1 - Se}{Sp} $$\n\n**4. 数值计算**\n\n给定 $Se = 0.98$，$Sp = 0.99$ 和 $\\pi = 0.001$：\n\n- **$PPV$ 计算**：\n$$ PPV = \\frac{0.98 \\cdot 0.001}{0.98 \\cdot 0.001 + (1 - 0.99)(1 - 0.001)} = \\frac{0.00098}{0.00098 + (0.01)(0.999)} = \\frac{0.00098}{0.00098 + 0.00999} = \\frac{0.00098}{0.01097} \\approx 0.0893345... $$\n\n- **$NPV$ 计算**：\n$$ NPV = \\frac{0.99 \\cdot (1 - 0.001)}{(1 - 0.98) \\cdot 0.001 + 0.99 \\cdot (1 - 0.001)} = \\frac{0.99 \\cdot 0.999}{0.02 \\cdot 0.001 + 0.99 \\cdot 0.999} = \\frac{0.98901}{0.00002 + 0.98901} = \\frac{0.98901}{0.98903} \\approx 0.999979... $$\n\n- **$LR^{+}$ 计算**：\n$$ LR^{+} = \\frac{0.98}{1 - 0.99} = \\frac{0.98}{0.01} = 98 $$\n\n- **$LR^{-}$ 计算**：\n$$ LR^{-} = \\frac{1 - 0.98}{0.99} = \\frac{0.02}{0.99} \\approx 0.020202... $$\n\n**5. 在筛查背景下对低 $PPV$ 的解释**\n\n计算出的 $PPV$ 约为 $0.089$，这意味着在该筛查人群中，每 $100$ 个阳性检测结果中，只有不到 $9$ 个人真正患有该疾病。尽管分析性能优异（误差可忽略不计）且临床有效性指标很高（$Se = 0.98$，$Sp = 0.99$），但仍然出现了如此低的 $PPV$。原因在于检验前概率的深远影响，在人群筛查的背景下，检验前概率即为疾病患病率 ($\\pi$)。\n\n在这里，疾病的检验前概率极低，为 $\\pi = 0.001$，即千分之一。绝大多数被筛查的人群是未患病的。一个检测的特异度，即使很高，也永远不是完美的。$Sp = 0.99$ 的特异度对应于 $1 - Sp = 0.01$ (即 $1\\%$) 的假阳性率。当这个 $1\\%$ 的比率应用于大量未患病人群时，会产生大量的假阳性结果。\n\n用一个假设包含 $1,000,000$ 人的队列来说明：\n- 患病人数：$1,000,000 \\times 0.001 = 1000$\n- 未患病人数：$1,000,000 \\times 0.999 = 999,000$\n从这两个组中：\n- 真阳性 ($TP$) 人数：$1000 \\times Se = 1000 \\times 0.98 = 980$\n- 假阳性 ($FP$) 人数：$999,000 \\times (1 - Sp) = 999,000 \\times 0.01 = 9990$\n\n阳性检测总数为 $TP + FP = 980 + 9990 = 10970$。\n$PPV$ 是真阳性数与所有阳性检测数的比值：$PPV = \\frac{TP}{TP + FP} = \\frac{980}{10970} \\approx 0.08933$。\n\n如上所示，假阳性的人数 ($9990$) 远超真阳性的人数 ($980$)。低的检验前概率（患病率）设定了一个如此之低的基线，以至于即使是一个诊断能力很强的检测（由高 $LR^{+} = 98$ 表明），也无法产生高的检验后概率 ($PPV$)。这个原则在精准医学和基因组学中至关重要：对于罕见病筛查，一个阳性结果主要作用是将个体从一般风险人群重新分类到一个需要进行最终确证性诊断检测的、规模小得多高风险组中。它本身并不能确诊。临床效用取决于认识到这一局限性，并有明确的后续跟进路径。",
            "answer": "$$\n\\boxed{0.08933}\n$$"
        },
        {
            "introduction": "衡量一项检测价值的最终标准是其临床效用——使用该检测是否能带来更好的患者结局？最后一个实践练习将带你进入决策分析领域，你必须权衡检测带来的益处与其成本和风险。你将推导出一项检测为提供净积极效益所必须具备的最低性能特征（灵敏度和特异性），从而将风险、治疗效果和潜在伤害等概念整合到一个统一的效用框架中。",
            "id": "4316262",
            "problem": "提出一项基因组筛查检测，用于在一个固定时间范围内，为未经治疗的基线事件风险为 $\\pi \\in (0,1)$ 的人群中的二元疾病结局指导预防性治疗。该检测的临床有效性由相对于该时间范围内的未来疾病事件的灵敏度 ($Se$) 和特异度 ($Sp$) 来表征；即 $P(T=1 \\mid Y=1)=Se$ 和 $P(T=1 \\mid Y=0)=1-Sp$，其中 $T$ 表示检测结果，$Y$ 表示事件。\n\n采取“阳性即治”策略：$T=1$ 的个体接受预防性治疗；$T=0$ 的个体不接受治疗。在接受治疗的个体中，治疗通过一个相对风险因子 $RR \\in (0,1)$ 以乘法方式降低事件的绝对概率（即，如果一个未经治疗的个体的事件概率为 $p$，那么在治疗下它变为 $RR \\cdot p$）。每位接受治疗的个体都会产生一个预期的负效用 $h \\ge 0$，该负效用与事件的绝对风险使用相同的标度衡量（也就是说，$h$ 被解释为由于不良反应、负担或机会成本等伤害，每位治疗者事件的等效绝对风险增加量）。假设效用分量具有线性可加性，并具备应用 $Se$ 和 $Sp$ 标准频率定义所需的独立性。\n\n将检测指导策略的人均净效用定义为预防事件带来的预期绝对风险降低减去预期治疗伤害。仅使用灵敏度、特异度、相对风险和期望值的基本定义，推导一个阈值分析，得出在给定固定 $Sp$ 的情况下使净效用为正所需的最小 $Se$，以及在给定固定 $Se$ 的情况下使净效用为正所需的最小 $Sp$。将这两个阈值表示为 $\\pi$、$RR$、$h$ 和相应固定准确性参数的闭式函数。陈述阈值要成为有限且可解释所需参数的任何必要正则性条件。以单行矩阵的形式提供最终答案对 $\\left(Se_{\\min}, Sp_{\\min}\\right)$。不需要进行数值计算；答案必须是无单位的精确符号表达式。",
            "solution": "在尝试求解之前，对问题陈述进行了严格验证。\n\n### 步骤 1：提取给定条件\n-   人群基线事件风险：$\\pi = P(Y=1)$，其中 $Y=1$ 为事件，$Y=0$ 为无事件。$\\pi \\in (0,1)$。\n-   检测结果：$T=1$ 为阳性，$T=0$ 为阴性。\n-   检测临床有效性：\n    -   灵敏度：$Se = P(T=1 \\mid Y=1)$。\n    -   假阳性率：$1-Sp = P(T=1 \\mid Y=0)$，其中 $Sp$ 为特异度。\n-   治疗策略：$T=1$ 的个体接受治疗；$T=0$ 的个体不接受治疗。\n-   治疗效果：对于事件概率为 $p$ 的个体，治疗将其概率变为 $RR \\cdot p$，其中 $RR \\in (0,1)$ 是一个相对风险因子。\n-   治疗伤害：每位接受治疗的个体产生一个预期的负效用 $h \\ge 0$，以等效的绝对风险增加来衡量。\n-   效用模型：人均净效用 = (预期绝对风险降低) - (预期治疗伤害)。\n-   目标：推导在给定固定特异度 $Sp$ 的情况下使净效用为正所需的最小灵敏度 $Se_{\\min}$，以及在给定固定灵敏度 $Se$ 的情况下使净效用为正所需的最小特异度 $Sp_{\\min}$。\n\n### 步骤 2：使用提取的给定条件进行验证\n-   **科学依据：** 该问题基于流行病学、临床试验分析和决策理论（灵敏度、特异度、患病率、相对风险、效用理论）的基本原理。这些是精准医学和诊断学中的标准概念。\n-   **适定性：** 该问题是适定的。它要求基于一个明确定义的效用函数和一组明确定义的参数来推导阈值。在指定条件下，预期存在唯一的代数解。\n-   **客观性：** 问题以精确、定量和客观的语言陈述。\n-   **不完整或矛盾的设置：** 问题是自洽的。定义是标准且一致的。例如，通过假阳性率 $P(T=1 \\mid Y=0) = 1-Sp$ 来定义特异度 $Sp$ 是标准做法。\n-   **不切实际或不可行：** 该模型是一个简化模型，但代表了评估筛查检测的一个有效且常见的框架。所有参数在物理上和生物学上都是合理的。\n-   **不适定或结构不良：** 结构是合乎逻辑的，能够进行易于处理的代数推导。\n-   **伪深刻、琐碎或同义反复：** 该问题需要一个涉及条件概率和期望值的非平凡推导，这是一项实质性的练习。\n-   **超出科学可验证性：** 推导过程是数学性的，可以被严格验证。\n\n### 步骤 3：结论和行动\n问题是有效的。将推导解答。\n\n### 净效用推导\n\n人均净效用 $U$ 是预期绝对风险降低（收益）与预期治疗伤害（成本）之间的差值。\n$$U = E[\\text{Risk Reduction}] - E[\\text{Harm}]$$\n\n**1. 预期治疗伤害**\n每位接受治疗的个体都会产生大小为 $h$ 的伤害。治疗规则是如果检测为阳性（$T=1$）则进行治疗。因此，人均预期伤害是每人的伤害 $h$ 乘以接受治疗的概率 $P(T=1)$。\n我们使用全概率定律来计算 $P(T=1)$：\n$$P(T=1) = P(T=1 \\mid Y=1)P(Y=1) + P(T=1 \\mid Y=0)P(Y=0)$$\n代入给定定义：$P(Y=1) = \\pi$，$P(Y=0) = 1-\\pi$，$P(T=1 \\mid Y=1) = Se$ 和 $P(T=1 \\mid Y=0) = 1-Sp$。\n$$P(T=1) = Se \\cdot \\pi + (1-Sp) \\cdot (1-\\pi)$$\n预期伤害为：\n$$E[\\text{Harm}] = h \\cdot P(T=1) = h \\cdot [Se \\cdot \\pi + (1-Sp) \\cdot (1-\\pi)]$$\n\n**2. 预期绝对风险降低**\n风险降低仅发生在那些接受治疗且本会发病的个体中。这些是“真阳性”病例，其中 $T=1$ 且 $Y=1$。\n对于一个 $Y=1$ 的个体，事件的概率是 $1$。经过治疗，这个概率变为 $RR \\cdot 1 = RR$。这样一个个体的绝对风险降低为 $1 - RR$。\n收益仅对这个群体实现，因此人均预期风险降低是个体收益 $1-RR$ 乘以该群体在总人口中所占的比例 $P(T=1, Y=1)$。\n使用条件概率的定义：\n$$P(T=1, Y=1) = P(T=1 \\mid Y=1)P(Y=1) = Se \\cdot \\pi$$\n预期风险降低为：\n$$E[\\text{Risk Reduction}] = (1-RR) \\cdot P(T=1, Y=1) = (1-RR) \\cdot Se \\cdot \\pi$$\n\n**3. 净效用表达式**\n结合伤害和收益项，净效用 $U$ 为：\n$$U = (1-RR) \\cdot Se \\cdot \\pi - h \\cdot [Se \\cdot \\pi + (1-Sp) \\cdot (1-\\pi)]$$\n\n### 阈值分析\n\n检测指导策略具有正净效用的条件是 $U > 0$。\n$$(1-RR) \\cdot Se \\cdot \\pi - h \\cdot [Se \\cdot \\pi + (1-Sp) \\cdot (1-\\pi)] > 0$$\n$$(1-RR) \\cdot Se \\cdot \\pi > h \\cdot Se \\cdot \\pi + h \\cdot (1-Sp) \\cdot (1-\\pi)$$\n\n**最小灵敏度 ($Se_{\\min}$) 的推导**\n我们重排不等式以求解 $Se$，同时保持 $Sp$ 固定。\n$$(1-RR) \\cdot Se \\cdot \\pi - h \\cdot Se \\cdot \\pi > h \\cdot (1-Sp) \\cdot (1-\\pi)$$\n$$Se \\cdot \\pi \\cdot (1 - RR - h) > h \\cdot (1-Sp) \\cdot (1-\\pi)$$\n为了存在一个物理上有意义的阈值，$Se$ 的系数必须为正。即 $1-RR-h > 0$，或 $h  1-RR$。这是一个必要的正则性条件，意味着为已知注定会发生事件的人进行治疗的收益必须超过治疗本身的伤害。如果这个条件成立，我们可以将不等式两边除以 $\\pi \\cdot (1 - RR - h)$（因为 $\\pi \\in (0,1)$，所以该项为正），而不改变不等式的方向。\n$$Se > \\frac{h \\cdot (1-Sp) \\cdot (1-\\pi)}{\\pi \\cdot (1-RR-h)}$$\n因此，所需的最小灵敏度为：\n$$Se_{\\min} = \\frac{h \\cdot (1-Sp) \\cdot (1-\\pi)}{\\pi \\cdot (1-RR-h)}$$\n在条件 $h  1-RR$ 下，该阈值是可解释的（即有限且为正）。如果 $h \\ge 1-RR$，对于任何 $Se \\in [0,1]$，净效用都不能为正，因此不存在有意义的阈值。\n\n**最小特异度 ($Sp_{\\min}$) 的推导**\n我们重排不等式以求解 $Sp$，同时保持 $Se$ 固定。\n$$(1-RR) \\cdot Se \\cdot \\pi > h \\cdot Se \\cdot \\pi + h \\cdot (1-\\pi) - h \\cdot Sp \\cdot (1-\\pi)$$\n$$h \\cdot Sp \\cdot (1-\\pi) > h \\cdot Se \\cdot \\pi + h \\cdot (1-\\pi) - (1-RR) \\cdot Se \\cdot \\pi$$\n$$h \\cdot Sp \\cdot (1-\\pi) > h(1-\\pi) - Se \\cdot \\pi \\cdot (1-RR-h)$$\n对于此推导，我们假设 $h > 0$。如果 $h=0$，则伤害为零，效用 $U = (1-RR)Se\\pi$ 对于任何 $Se > 0$ 都为正，而与 $Sp$ 无关。在这种情况下，$Sp_{\\min}=0$。\n假设 $h > 0$ 并注意到 $1-\\pi > 0$，我们可以除以 $h \\cdot (1-\\pi)$：\n$$Sp > 1 - \\frac{Se \\cdot \\pi \\cdot (1-RR-h)}{h \\cdot (1-\\pi)}$$\n因此，所需的最小特异度为：\n$$Sp_{\\min} = 1 - \\frac{Se \\cdot \\pi \\cdot (1-RR-h)}{h \\cdot (1-\\pi)}$$\n在与之前相同的正则性条件 $h  1-RR$ 下，该阈值是可解释的（即 $Sp_{\\min}  1$）。如果 $h \\ge 1-RR$，从 1 中减去的项为负或零，意味着 $Sp_{\\min} \\ge 1$，这要求一个完美的或无法达到的特异度。因此，一个有用的、非平凡的阈值的必要条件是 $h>0$ 和 $h  1-RR$。\n\n最终答案是推导出的 $Se_{\\min}$ 和 $Sp_{\\min}$ 的表达式对。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{h(1-Sp)(1-\\pi)}{\\pi(1-RR-h)}  1 - \\frac{Se \\cdot \\pi (1-RR-h)}{h(1-\\pi)} \\end{pmatrix} } $$"
        }
    ]
}