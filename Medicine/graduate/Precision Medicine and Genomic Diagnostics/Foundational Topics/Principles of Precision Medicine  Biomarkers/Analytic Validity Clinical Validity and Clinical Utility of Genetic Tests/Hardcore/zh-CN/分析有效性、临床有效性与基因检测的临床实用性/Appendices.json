{
    "hands_on_practices": [
        {
            "introduction": "在评估任何基因检测时，首要步骤是确立其分析有效性，即检测方法能否准确、可靠地测量其目标分析物。本练习旨在量化基因检测的精密度，这是分析有效性的一个核心组成部分。通过一个嵌套的统计模型，您将学习如何将总变异分解为不同的来源——包括重复性（在相同条件下获得的精密度）和再现性（在不同条件下获得的精密度），并计算变异系数（CV），这对于实验室质量控制和检测验证至关重要。",
            "id": "4316319",
            "problem": "您的任务是为一项定量遗传学检测（例如，下一代测序（NGS）的变异等位基因频率）的分析精密度进行形式化，并在嵌套测量系统下计算汇总精密度指标。目标是使用跨仪器和操作员的嵌套方差分量来定义和量化重复性和再现性。\n\n出发点与核心定义：\n- 分析有效性是检测方法能够测量其声称要测量内容的能力。对于一个建模为随机变量 $Y$ 的连续检测输出，精密度由 $Y$ 在受控条件下的变异性来表征。\n- 重复性是在相同条件下（相同仪器、相同操作员、相同试剂、相同环境）重复检测时观察到的变异性，并通过条件内误差方差进行量化。\n- 再现性是在常规使用中预期的变化条件下（例如，不同仪器、不同操作员）进行检测时观察到的变异性，并通过这些来源的总变异性进行量化。\n- 变异系数 (CV) 是一种无标度的精密度指标，定义为 $CV = \\sqrt{\\mathrm{Var}(Y)} \\,/\\, \\mu$，其中 $\\mu$ 是 $Y$ 的平均水平。此处以小数形式表示，不带百分号。\n\n分层测量系统模型：\n- 考虑加性随机效应模型 $Y_{ijk} = \\mu + I_i + O_{j(i)} + \\epsilon_{ijk}$，其中 $I_i$ 是仪器 $i$ 的随机效应，$O_{j(i)}$ 是嵌套在仪器 $i$ 内的操作员 $j$ 的随机效应，$\\epsilon_{ijk}$ 是第 $k$ 次重复的残差重复性误差。假设 $I_i$、$O_{j(i)}$ 和 $\\epsilon_{ijk}$ 是相互独立的、均值为零的随机变量，其方差分别为 $\\sigma_I^2$、$\\sigma_{O(I)}^2$ 和 $\\sigma_e^2$。在独立性和可加性假设下，归因于每个条件集的方差由相关方差分量相加得出。\n\n任务：\n- 编写一个程序，为每个测试用例计算三个量：\n  1. 仅使用残差分量 $\\,\\sigma_e^2\\,$ 计算重复性 $CV$。\n  2. 使用 $\\,\\sigma_{O(I)}^2 + \\sigma_e^2\\,$ 计算仪器内操作员 $CV$。\n  3. 使用 $\\,\\sigma_I^2 + \\sigma_{O(I)}^2 + \\sigma_e^2\\,$ 计算跨仪器和操作员的再现性 $CV$。\n- 对上述每种情况均使用定义 $CV = \\sqrt{\\mathrm{Var}} \\,/\\, \\mu$，并将 $\\,\\mu\\,$ 视为总平均水平。如果对于某个小阈值 $\\,\\varepsilon = 10^{-12}\\,$，有 $|\\mu|  \\varepsilon\\,$，则为相应的 $CV$ 返回一个“非数值”(not-a-number) 指示符，以避免除法不稳定。\n- 所有 $CV$ 值必须表示为小数（无单位），并四舍五入到六位小数。\n\n每个测试用例的输入规范：\n- 程序必须使用以下测试套件参数集，每个参数集指定为 $(\\mu, \\sigma_I^2, \\sigma_{O(I)}^2, \\sigma_e^2)$：\n  - 案例 A（一般情景）：$(\\mu = 0.25, \\sigma_I^2 = 0.0004, \\sigma_{O(I)}^2 = 0.0001, \\sigma_e^2 = 0.00005)$。\n  - 案例 B（无仪器变异性）：$(\\mu = 0.50, \\sigma_I^2 = 0, \\sigma_{O(I)}^2 = 0.0002, \\sigma_e^2 = 0.0001)$。\n  - 案例 C（均值接近零的边缘情况）：$(\\mu = 0.01, \\sigma_I^2 = 0.000001, \\sigma_{O(I)}^2 = 0.000002, \\sigma_e^2 = 0.000001)$。\n  - 案例 D（残差和操作员方差为零的边界情况）：$(\\mu = 0.30, \\sigma_I^2 = 0.0009, \\sigma_{O(I)}^2 = 0, \\sigma_e^2 = 0)$。\n  - 案例 E（高均值，小方差）：$(\\mu = 0.90, \\sigma_I^2 = 0.00005, \\sigma_{O(I)}^2 = 0.00005, \\sigma_e^2 = 0.00002)$。\n\n输出规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素按顺序（A 到 E）对应一个测试用例，并且本身是一个包含三个四舍五入到六位小数的列表：$[CV_{\\text{重复性}}, CV_{\\text{仪器内操作员}}, CV_{\\text{再现性}}]$。\n- 例如，输出结构必须如下所示：$[[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots,[a_5,b_5,c_5]]$，其中每个 $a_i$、$b_i$、$c_i$ 都是一个浮点数。\n\n由于变异系数是无量纲的，因此不适用任何物理单位。不使用角度。所有小数必须以无单位分数（不带百分号）的形式呈现。",
            "solution": "我们从精准医疗和基因组诊断中分析有效性的角度出发。定量检测的输出，例如来自下一代测序（NGS）的变异等位基因频率，被建模为一个随机变量 $Y$，其平均水平为 $\\mu$，变异性由多个来源驱动。重复性和再现性是分析精密度的不同方面。重复性是在所有可控条件保持恒定时测得的变异性，而再现性则汇总了当条件（如仪器和操作员）变化时产生的变异性，代表了现实的条件间变异性。\n\n为了计算变异系数 (CV)，我们采用无标度的精密度指标，定义为 $CV = \\sqrt{\\mathrm{Var}(Y)} \\,/\\, \\mu$。该指标是合适的，因为它将离散度相对于平均水平进行了归一化，使得在不同数量级的 $\\mu$ 之间进行比较更有意义。我们以小数（而非百分比）形式表示 CV，以避免歧义。\n\n模型构建与基本原理：\n- 我们为一个测量值 $Y_{ijk}$ 提出一个分层的加性随机效应模型：\n  $$Y_{ijk} = \\mu + I_i + O_{j(i)} + \\epsilon_{ijk},$$\n  其中 $I_i$ 是仪器 $i$ 的仪器效应，$O_{j(i)}$ 是嵌套在仪器 $i$ 内的操作员 $j$ 的操作员效应，而 $\\epsilon_{ijk}$ 是在固定仪器和操作员下第 $k$ 次重复的残差（条件内）误差。假设这些随机效应是相互独立的且中心化的：$\\mathbb{E}[I_i] = 0$，$\\mathbb{E}[O_{j(i)}] = 0$，$\\mathbb{E}[\\epsilon_{ijk}] = 0$，其方差分别为 $\\mathrm{Var}(I_i) = \\sigma_I^2$，$\\mathrm{Var}(O_{j(i)}) = \\sigma_{O(I)}^2$ 和 $\\mathrm{Var}(\\epsilon_{ijk}) = \\sigma_e^2$。\n\n- 利用加性随机效应的独立性以及方差的性质（对于独立变量 $X$ 和 $Z$，$\\mathrm{Var}(X+Z) = \\mathrm{Var}(X) + \\mathrm{Var}(Z)$），在给定条件集下的总方差是所包含效应的方差之和。\n\n根据第一性原理，我们为特定条件集构建 CV：\n1. 重复性 CV：\n   - 定义：相同仪器、相同操作员、相同环境。只有残差误差有贡献。\n   - 方差：$$\\mathrm{Var}_{\\text{repeat}}(Y) = \\sigma_e^2.$$\n   - CV：$$CV_{\\text{repeat}} = \\frac{\\sqrt{\\sigma_e^2}}{\\mu}.$$\n\n2. 仪器内操作员 CV：\n   - 定义：固定仪器内不同操作员之间的变异，加上残差误差。这代表了在保持仪器不变的情况下，操作员之间的中间精密度。\n   - 方差：$$\\mathrm{Var}_{\\text{operator}}(Y) = \\sigma_{O(I)}^2 + \\sigma_e^2.$$\n   - CV：$$CV_{\\text{operator}} = \\frac{\\sqrt{\\sigma_{O(I)}^2 + \\sigma_e^2}}{\\mu}.$$\n\n3. 再现性 CV（跨仪器和操作员）：\n   - 定义：跨仪器和操作员的变异，反映了常规实施下现实的条件间变异性。\n   - 方差：$$\\mathrm{Var}_{\\text{reprod}}(Y) = \\sigma_I^2 + \\sigma_{O(I)}^2 + \\sigma_e^2.$$\n   - CV：$$CV_{\\text{reprod}} = \\frac{\\sqrt{\\sigma_I^2 + \\sigma_{O(I)}^2 + \\sigma_e^2}}{\\mu}.$$\n\n数值稳定性：\n- 当 $|\\mu|$ 过小时，除以 $\\mu$ 会导致 CV 不稳定。我们引入一个阈值 $\\varepsilon = 10^{-12}$，如果 $|\\mu|  \\varepsilon$，则返回一个“非数值”指示符。\n\n算法设计：\n- 对于每个具有参数 $(\\mu, \\sigma_I^2, \\sigma_{O(I)}^2, \\sigma_e^2)$ 的案例：\n  - 计算 $v_{\\text{repeat}} = \\sigma_e^2$，$v_{\\text{operator}} = \\sigma_{O(I)}^2 + \\sigma_e^2$，以及 $v_{\\text{reprod}} = \\sigma_I^2 + \\sigma_{O(I)}^2 + \\sigma_e^2$。\n  - 如果 $|\\mu| \\ge \\varepsilon$，则将每个 $CV$ 计算为 $\\sqrt{v}/\\mu$；否则返回“非数值”。\n  - 将每个 $CV$ 四舍五入到六位小数。\n- 将每个案例的三个 $CV$ 值聚合到一个列表中，并为所有案例输出列表的列表。\n\n测试套件与预期行为：\n- 案例 A：$(\\mu = 0.25, \\sigma_I^2 = 0.0004, \\sigma_{O(I)}^2 = 0.0001, \\sigma_e^2 = 0.00005)$。\n  - $CV_{\\text{repeat}} \\approx 0.028284$, $CV_{\\text{operator}} \\approx 0.048990$, $CV_{\\text{reprod}} \\approx 0.093808$。\n- 案例 B：$(\\mu = 0.50, \\sigma_I^2 = 0, \\sigma_{O(I)}^2 = 0.0002, \\sigma_e^2 = 0.0001)$。\n  - $CV_{\\text{repeat}} \\approx 0.020000$, $CV_{\\text{operator}} \\approx 0.034641$, $CV_{\\text{reprod}} \\approx 0.034641$。\n- 案例 C：$(\\mu = 0.01, \\sigma_I^2 = 0.000001, \\sigma_{O(I)}^2 = 0.000002, \\sigma_e^2 = 0.000001)$。\n  - $CV_{\\text{repeat}} \\approx 0.100000$, $CV_{\\text{operator}} \\approx 0.173205$, $CV_{\\text{reprod}} \\approx 0.200000$。\n- 案例 D：$(\\mu = 0.30, \\sigma_I^2 = 0.0009, \\sigma_{O(I)}^2 = 0, \\sigma_e^2 = 0)$。\n  - $CV_{\\text{repeat}} \\approx 0.000000$, $CV_{\\text{operator}} \\approx 0.000000$, $CV_{\\text{reprod}} \\approx 0.100000$。\n- 案例 E：$(\\mu = 0.90, \\sigma_I^2 = 0.00005, \\sigma_{O(I)}^2 = 0.00005, \\sigma_e^2 = 0.00002)$。\n  - $CV_{\\text{repeat}} \\approx 0.004969$, $CV_{\\text{operator}} \\approx 0.009296$, $CV_{\\text{reprod}} \\approx 0.012172$。\n\n情境整合：\n- 这些 CV 量化了分析精密度的组成部分，这些是分析有效性的核心。临床有效性将检测输出 $Y$ 与临床状况（例如，致病性变异）的存在或风险联系起来，而临床实用性则评估在决策使用下患者的净收益。在重复性和再现性下稳健的分析精密度支持但不单独确立临床有效性或实用性；这些需要关于灵敏度、特异性、预测值和结局的独立证据。\n\n程序将按照所述实现计算，并为所有案例生成一个包含四舍五入小数的单行嵌套列表。",
            "answer": "```python\nimport numpy as np\n\ndef compute_cvs(mu, sigma2_instr, sigma2_oper_in_instr, sigma2_error, eps=1e-12):\n    \"\"\"\n    Compute repeatability, operator-within-instrument, and reproducibility CVs.\n    CV = sqrt(variance_component)/mu, returned as floats.\n    If |mu|  eps, return np.nan for the corresponding CV to avoid instability.\n    \"\"\"\n    # Variance components for each precision definition\n    var_repeat = sigma2_error\n    var_operator = sigma2_oper_in_instr + sigma2_error\n    var_reprod = sigma2_instr + sigma2_oper_in_instr + sigma2_error\n\n    if abs(mu)  eps:\n        return [float('nan'), float('nan'), float('nan')]\n\n    cv_repeat = np.sqrt(var_repeat) / mu\n    cv_operator = np.sqrt(var_operator) / mu\n    cv_reprod = np.sqrt(var_reprod) / mu\n\n    # Round to six decimal places\n    return [round(cv_repeat, 6), round(cv_operator, 6), round(cv_reprod, 6)]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (mu, sigma_I^2, sigma_{O(I)}^2, sigma_e^2)\n    test_cases = [\n        (0.25, 0.0004, 0.0001, 0.00005),    # Case A\n        (0.50, 0.0,    0.0002, 0.0001),     # Case B\n        (0.01, 0.000001, 0.000002, 0.000001),  # Case C\n        (0.30, 0.0009, 0.0,    0.0),        # Case D\n        (0.90, 0.00005, 0.00005, 0.00002),  # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        mu, sigma2_instr, sigma2_oper_in_instr, sigma2_error = case\n        cvs = compute_cvs(mu, sigma2_instr, sigma2_oper_in_instr, sigma2_error)\n        results.append(cvs)\n\n    # Final print statement in the exact required format.\n    # Nested list printed as a single line with comma-separated elements.\n    # Ensure standard Python list representation.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "确立了分析有效性后，下一步是评估临床有效性——检测结果与特定临床状态或结局之间的关联程度。然而，在遗传学中，这种关联往往不是绝对的，一个关键概念是“不完全外显率”，即携带致病性基因变异的个体不一定会表现出相关疾病。本练习将引导您推导出一个公式，该公式整合了分析性能（灵敏度 $\\alpha$ 和特异性 $\\sigma$）、群体遗传学（携带者频率 $f$）和生物学因素（外显率 $\\pi$），以计算疾病风险的阳性预测值（PPV）。通过这个练习，您将深刻理解区分“预测携带状态”和“预测实际疾病风险”的重要性。",
            "id": "4316344",
            "problem": "根据先前的临床有效性研究，已知一种生殖系变异 $V$ 会增加患有不完全外显疾病 $D$ 的风险。设目标人群中该变异的携带者比例（携带 $V$ 的个体占比）为 $f \\in (0,1)$。外显率定义为条件概率 $\\pi = \\mathbb{P}(D \\mid V)$，其中 $0  \\pi  1$。假设在该人群中以及对于所考虑的适应症，疾病 $D$ 仅通过 $V$ 发生（即 $\\mathbb{P}(D \\mid \\neg V) = 0$），因此不完全外显是基因型与表型不一致的唯一来源。\n\n一项实验室检测 $T$ 用于检测变异 $V$，其分析灵敏度为 $\\alpha = \\mathbb{P}(T^{+} \\mid V)$，分析特异性为 $\\sigma = \\mathbb{P}(T^{-} \\mid \\neg V)$，其中 $0 \\le \\alpha \\le 1$ 且 $0 \\le \\sigma \\le 1$。假设当且仅当检测到 $V$ 时，检测结果为 $T^{+}$。\n\n仅使用条件概率的基本定义、全概率定律和 Bayes 定理，推导疾病风险阳性预测值 (PPV) 的一个显式表达式。此处 PPV 定义为 $\\mathbb{P}(D \\mid T^{+})$，表达式需用 $\\alpha$、$\\sigma$、$f$ 和 $\\pi$ 表示。你的最终答案必须是单一的封闭形式表达式。不要引入任何未提供的参数，也不要进行近似。请将最终答案表示为符号数学表达式；无需进行四舍五入。",
            "solution": "该问题是有效的。它在科学上基于医学遗传学和概率论的原理，问题表述清晰（适定），所有必要的参数都有定义，并且是客观的。问题没有矛盾之处，并且简化假设 $\\mathbb{P}(D \\mid \\neg V) = 0$ 对于理论推导来说是可接受的。我们可以开始解答。\n\n目标是推导疾病风险的阳性预测值 (PPV) 的表达式，其定义为条件概率 $\\mathbb{P}(D \\mid T^{+})$。我们已知以下量：\n-   携带者比例: $f = \\mathbb{P}(V)$\n-   携带者的疾病外显率: $\\pi = \\mathbb{P}(D \\mid V)$\n-   非携带者的疾病外显率: $\\mathbb{P}(D \\mid \\neg V) = 0$\n-   检测 $T$ 的分析灵敏度: $\\alpha = \\mathbb{P}(T^{+} \\mid V)$\n-   检测 $T$ 的分析特异性: $\\sigma = \\mathbb{P}(T^{-} \\mid \\neg V)$\n\n根据条件概率的定义，PPV 由下式给出：\n$$\n\\mathbb{P}(D \\mid T^{+}) = \\frac{\\mathbb{P}(D \\cap T^{+})}{\\mathbb{P}(T^{+})}\n$$\n我们将用给定参数推导分子 $\\mathbb{P}(D \\cap T^{+})$ 和分母 $\\mathbb{P}(T^{+})$ 的表达式。\n\n首先，我们分析分子，即联合概率 $\\mathbb{P}(D \\cap T^{+})$。我们可以通过对生殖系变异存在 ($V$) 或不存在 ($\\neg V$) 的情况进行条件化，使用全概率定律来表达它。\n$$\n\\mathbb{P}(D \\cap T^{+}) = \\mathbb{P}(D \\cap T^{+} \\mid V)\\mathbb{P}(V) + \\mathbb{P}(D \\cap T^{+} \\mid \\neg V)\\mathbb{P}(\\neg V)\n$$\n问题的结构意味着，在给定遗传状态（$V$ 的存在或不存在）的条件下，检测结果 ($T^{+}$) 和疾病状态 ($D$) 是相互独立的事件。这是因为检测结果取决于 $V$ 的存在，而疾病状态也取决于 $V$ 的存在。题目没有描述 $T$ 和 $D$ 之间存在其他影响路径。因此，我们可以写出：\n$$\n\\mathbb{P}(D \\cap T^{+} \\mid V) = \\mathbb{P}(D \\mid V) \\mathbb{P}(T^{+} \\mid V)\n$$\n和\n$$\n\\mathbb{P}(D \\cap T^{+} \\mid \\neg V) = \\mathbb{P}(D \\mid \\neg V) \\mathbb{P}(T^{+} \\mid \\neg V)\n$$\n已知 $\\mathbb{P}(D \\mid V) = \\pi$ 和 $\\mathbb{P}(T^{+} \\mid V) = \\alpha$。我们还已知一个关键条件，即疾病仅由该变异引起，$\\mathbb{P}(D \\mid \\neg V) = 0$。\n将这些代入分子的表达式中：\n$$\n\\mathbb{P}(D \\cap T^{+}) = (\\pi \\cdot \\alpha) \\mathbb{P}(V) + (0 \\cdot \\mathbb{P}(T^{+} \\mid \\neg V)) \\mathbb{P}(\\neg V)\n$$\n由于 $\\mathbb{P}(V) = f$，表达式简化为：\n$$\n\\mathbb{P}(D \\cap T^{+}) = \\pi \\alpha f\n$$\n\n接下来，我们分析分母，即阳性检测结果的全概率 $\\mathbb{P}(T^{+})$。我们再次使用全概率定律，对变异 $V$ 存在或不存在的情况进行条件化。\n$$\n\\mathbb{P}(T^{+}) = \\mathbb{P}(T^{+} \\mid V)\\mathbb{P}(V) + \\mathbb{P}(T^{+} \\mid \\neg V)\\mathbb{P}(\\neg V)\n$$\n我们代入已知量：\n-   $\\mathbb{P}(T^{+} \\mid V) = \\alpha$\n-   $\\mathbb{P}(V) = f$\n-   $\\mathbb{P}(\\neg V) = 1 - \\mathbb{P}(V) = 1 - f$\n项 $\\mathbb{P}(T^{+} \\mid \\neg V)$ 是假阳性率。它可以从分析特异性 $\\sigma = \\mathbb{P}(T^{-} \\mid \\neg V)$ 推导出来。由于只有两种检测结果，阳性 ($T^{+}$) 和阴性 ($T^{-}$)，因此有 $\\mathbb{P}(T^{+} \\mid \\neg V) = 1 - \\mathbb{P}(T^{-} \\mid \\neg V) = 1 - \\sigma$。\n\n将这些代入分母的表达式中：\n$$\n\\mathbb{P}(T^{+}) = \\alpha f + (1 - \\sigma)(1 - f)\n$$\n\n最后，我们合并分子和分母的表达式，得到 PPV, $\\mathbb{P}(D \\mid T^{+})$ 的最终表达式：\n$$\n\\mathbb{P}(D \\mid T^{+}) = \\frac{\\mathbb{P}(D \\cap T^{+})}{\\mathbb{P}(T^{+})} = \\frac{\\pi \\alpha f}{\\alpha f + (1 - \\sigma)(1 - f)}\n$$\n这个疾病风险阳性预测值的表达式完全由所提供的参数 $\\alpha$、$\\sigma$、$f$ 和 $\\pi$ 表示。",
            "answer": "$$\\boxed{\\frac{\\pi \\alpha f}{\\alpha f + (1 - \\sigma)(1 - f)}}$$"
        },
        {
            "introduction": "一个分析和临床上都有效的检测，并不一定具有临床实用性，即它不一定能为患者带来净收益。临床实用性要求我们权衡使用检测所带来的益处与成本和危害。本高级练习将指导您构建一个决策分析模型，以形式化这种权衡。您将量化由检测引导的预防性治疗所带来的益处（降低疾病风险）与治疗本身所带来的危害（例如副作用或成本），并最终推导出使检测策略优于不检测策略所需的最低性能标准（$Se_{\\min}$ 和 $Sp_{\\min}$）。",
            "id": "4316262",
            "problem": "提出一种基因组筛查测试，用于在一个固定时间范围内，为未经治疗的基线事件风险为 $\\pi \\in (0,1)$ 的人群指导针对二元疾病结局的预防性治疗。该测试的临床有效性由其相对于该时间范围内的未来疾病事件的灵敏度 (sensitivity, $Se$) 和特异度 (specificity, $Sp$) 来表征；即 $P(T=1 \\mid Y=1)=Se$ 和 $P(T=1 \\mid Y=0)=1-Sp$，其中 $T$ 表示测试结果，$Y$ 表示事件。\n\n采纳“阳性即治”策略：$T=1$ 的个体接受预防性治疗；$T=0$ 的个体则不接受治疗。在接受治疗的个体中，该治疗通过一个相对风险因子 $RR \\in (0,1)$ 以乘法方式降低事件的绝对概率（即，如果一个未经治疗的个体的事件概率为 $p$，那么在治疗下它会变为 $RR \\cdot p$）。每个接受治疗的个体都会产生一个期望负效用 $h \\ge 0$，该负效用以与事件绝对风险相同的标度来衡量（也就是说，$h$ 被解释为由于不良反应、负担或机会成本等损害，每个受治者事件的等效绝对风险增加值）。假设效用分量具有线性可加性，并假设应用 $Se$ 和 $Sp$ 的标准频率定义所需的独立性成立。\n\n将测试指导策略的人均净效用定义为因预防事件而带来的期望绝对风险降低值减去期望的治疗损害。仅使用灵敏度、特异度、相对风险和期望值的基本定义，推导一个阈值分析，该分析要得出在给定固定 $Sp$ 的情况下净效用为正所需的最小 $Se$，以及在给定固定 $Se$ 的情况下净效用为正所需的最小 $Sp$。将这两个阈值以 $\\pi$、$RR$、$h$ 和相应的固定准确性参数的闭式函数形式表示。陈述使阈值有限且可解释所需的任何参数上的必要正则性条件。以单行矩阵的形式提供最终答案对 $\\left(Se_{\\min}, Sp_{\\min}\\right)$。无需进行数值计算；答案必须是无单位的精确符号表达式。",
            "solution": "在尝试求解之前，对问题陈述进行严格验证。\n\n### 第 1 步：提取已知条件\n-   人群基线事件风险：$\\pi = P(Y=1)$，其中 $Y=1$ 表示事件发生，$Y=0$ 表示事件未发生。$\\pi \\in (0,1)$。\n-   测试结果：$T=1$ 为阳性，$T=0$ 为阴性。\n-   测试临床有效性：\n    -   灵敏度：$Se = P(T=1 \\mid Y=1)$。\n    -   假阳性率：$1-Sp = P(T=1 \\mid Y=0)$，其中 $Sp$ 是特异度。\n-   治疗策略：$T=1$ 的个体接受治疗；$T=0$ 的个体不接受治疗。\n-   治疗效果：对于事件概率为 $p$ 的个体，治疗将其概率变为 $RR \\cdot p$，其中 $RR \\in (0,1)$ 是相对风险因子。\n-   治疗损害：每个接受治疗的个体产生期望负效用 $h \\ge 0$，衡量为等效的绝对风险增加。\n-   效用模型：人均净效用 = (期望绝对风险降低值) - (期望治疗损害)。\n-   目标：推导在给定固定特异度 $Sp$ 时净效用为正所需的最小灵敏度 $Se_{\\min}$，以及在给定固定灵敏度 $Se$ 时净效用为正所需的最小特异度 $Sp_{\\min}$。\n\n### 第 2 步：使用提取的已知条件进行验证\n-   **科学依据充分：** 问题基于流行病学、临床试验分析和决策论（灵敏度、特异度、患病率、相对风险、效用理论）的基本原则。这些是精准医疗和诊断学中的标准概念。\n-   **适定性：** 问题是适定的。它要求基于一个明确定义的效用函数和一组明确定义的参数来推导阈值。在特定条件下，预期存在唯一的代数解。\n-   **客观性：** 问题以精确、定量和客观的语言陈述。\n-   **不完整或矛盾的设定：** 问题是自洽的。定义是标准且一致的。例如，通过假阳性率 $P(T=1 \\mid Y=0) = 1-Sp$ 来定义特异度 $Sp$ 是标准做法。\n-   **不切实际或不可行：** 该模型是一个简化模型，但代表了评估筛查测试的一个有效且常见的框架。所有参数在物理上和生物学上都是合理的。\n-   **不适定或结构不良：** 结构是合乎逻辑的，并能导出一个易于处理的代数推导。\n-   **伪深刻、琐碎或同义反复：** 问题需要一个涉及条件概率和期望值的非平凡推导，这是一项实质性的练习。\n-   **超出科学可验证性范围：** 推导过程是数学性的，可以被严格验证。\n\n### 第 3 步：结论和行动\n问题是有效的。将推导解答。\n\n### 净效用的推导\n\n人均净效用 $U$ 是期望绝对风险降低值（收益）与期望治疗损害（成本）之间的差值。\n$$U = E[\\text{Risk Reduction}] - E[\\text{Harm}]$$\n\n**1. 期望治疗损害**\n每个接受治疗的个体都会产生大小为 $h$ 的损害。治疗规则是如果测试为阳性（$T=1$）就进行治疗。因此，人均期望损害是每人损害 $h$ 乘以接受治疗的概率 $P(T=1)$。\n我们使用全概率定律来计算 $P(T=1)$：\n$$P(T=1) = P(T=1 \\mid Y=1)P(Y=1) + P(T=1 \\mid Y=0)P(Y=0)$$\n代入给定的定义：$P(Y=1) = \\pi$，$P(Y=0) = 1-\\pi$，$P(T=1 \\mid Y=1) = Se$ 以及 $P(T=1 \\mid Y=0) = 1-Sp$。\n$$P(T=1) = Se \\cdot \\pi + (1-Sp) \\cdot (1-\\pi)$$\n期望损害为：\n$$E[\\text{Harm}] = h \\cdot P(T=1) = h \\cdot [Se \\cdot \\pi + (1-Sp) \\cdot (1-\\pi)]$$\n\n**2. 期望绝对风险降低值**\n风险降低只发生在那些接受治疗且本会发病的个体中。这些是“真阳性”病例，即 $T=1$ 且 $Y=1$。\n对于 $Y=1$ 的个体，事件概率为 $1$。经过治疗，该概率变为 $RR \\cdot 1 = RR$。对此类个体的绝对风险降低值为 $1 - RR$。\n收益仅对该群体实现，因此人均期望风险降低值是此个体收益 $1-RR$ 乘以该类个体在人群中所占的比例 $P(T=1, Y=1)$。\n使用条件概率的定义：\n$$P(T=1, Y=1) = P(T=1 \\mid Y=1)P(Y=1) = Se \\cdot \\pi$$\n期望风险降低值为：\n$$E[\\text{Risk Reduction}] = (1-RR) \\cdot P(T=1, Y=1) = (1-RR) \\cdot Se \\cdot \\pi$$\n\n**3. 净效用表达式**\n结合损害和收益项，净效用 $U$ 为：\n$$U = (1-RR) \\cdot Se \\cdot \\pi - h \\cdot [Se \\cdot \\pi + (1-Sp) \\cdot (1-\\pi)]$$\n\n### 阈值分析\n\n测试指导策略具有正净效用的条件是 $U > 0$。\n$$(1-RR) \\cdot Se \\cdot \\pi - h \\cdot [Se \\cdot \\pi + (1-Sp) \\cdot (1-\\pi)] > 0$$\n$$(1-RR) \\cdot Se \\cdot \\pi > h \\cdot Se \\cdot \\pi + h \\cdot (1-Sp) \\cdot (1-\\pi)$$\n\n**最小灵敏度 ($Se_{\\min}$) 的推导**\n我们重排不等式以求解 $Se$，同时保持 $Sp$ 固定。\n$$(1-RR) \\cdot Se \\cdot \\pi - h \\cdot Se \\cdot \\pi > h \\cdot (1-Sp) \\cdot (1-\\pi)$$\n$$Se \\cdot \\pi \\cdot (1 - RR - h) > h \\cdot (1-Sp) \\cdot (1-\\pi)$$\n为了存在一个有物理意义的阈值，$Se$ 的系数必须为正。也就是说，$1-RR-h > 0$，或 $h  1-RR$。这是一个必要的正则性条件，意味着对已知将要发生事件的人进行治疗的收益必须超过治疗本身的损害。如果这个条件成立，我们可以用 $\\pi \\cdot (1 - RR - h)$（由于 $\\pi \\in (0,1)$，该项为正）来除不等式两边，而无需改变不等号的方向。\n$$Se > \\frac{h \\cdot (1-Sp) \\cdot (1-\\pi)}{\\pi \\cdot (1-RR-h)}$$\n因此，所需的最小灵敏度为：\n$$Se_{\\min} = \\frac{h \\cdot (1-Sp) \\cdot (1-\\pi)}{\\pi \\cdot (1-RR-h)}$$\n该阈值在 $h  1-RR$ 的条件下是可解释的（即有限且为正）。如果 $h \\ge 1-RR$，则对于任何 $Se \\in [0,1]$，净效用都不能为正，因此不存在有意义的阈值。\n\n**最小特异度 ($Sp_{\\min}$) 的推导**\n我们重排不等式以求解 $Sp$，同时保持 $Se$ 固定。\n$$(1-RR) \\cdot Se \\cdot \\pi > h \\cdot Se \\cdot \\pi + h \\cdot (1-\\pi) - h \\cdot Sp \\cdot (1-\\pi)$$\n$$h \\cdot Sp \\cdot (1-\\pi) > h \\cdot Se \\cdot \\pi + h \\cdot (1-\\pi) - (1-RR) \\cdot Se \\cdot \\pi$$\n$$h \\cdot Sp \\cdot (1-\\pi) > h(1-\\pi) - Se \\cdot \\pi \\cdot (1-RR-h)$$\n在此推导中，我们假设 $h > 0$。如果 $h=0$，则损害为零，效用 $U = (1-RR)Se\\pi$ 对于任何 $Se > 0$ 都是正的，而与 $Sp$ 无关。在这种情况下，$Sp_{\\min}=0$。\n假设 $h > 0$ 并且注意到 $1-\\pi > 0$，我们可以用 $h \\cdot (1-\\pi)$ 除不等式两边：\n$$Sp > 1 - \\frac{Se \\cdot \\pi \\cdot (1-RR-h)}{h \\cdot (1-\\pi)}$$\n因此，所需的最小特异度为：\n$$Sp_{\\min} = 1 - \\frac{Se \\cdot \\pi \\cdot (1-RR-h)}{h \\cdot (1-\\pi)}$$\n该阈值在与之前相同的正则性条件 $h  1-RR$ 下是可解释的（即 $Sp_{\\min}  1$）。如果 $h \\ge 1-RR$，则从 $1$ 中减去的项为负或零，意味着 $Sp_{\\min} \\ge 1$，这要求一个完美或无法达到的特异度。因此，一个有用的、非平凡阈值的必要条件是 $h>0$ 和 $h  1-RR$。\n\n最终答案是推导出的 $Se_{\\min}$ 和 $Sp_{\\min}$ 表达式对。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{h(1-Sp)(1-\\pi)}{\\pi(1-RR-h)}  1 - \\frac{Se \\cdot \\pi (1-RR-h)}{h(1-\\pi)} \\end{pmatrix} } $$"
        }
    ]
}