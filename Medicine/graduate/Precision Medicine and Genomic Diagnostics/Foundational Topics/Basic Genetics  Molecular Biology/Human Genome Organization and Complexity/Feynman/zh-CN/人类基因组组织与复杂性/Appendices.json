{
    "hands_on_practices": [
        {
            "introduction": "在人类基因组中，位于同一染色体上相近位置的等位基因往往会一起遗传，这种非随机关联被称为连锁不平衡（Linkage Disequilibrium, LD）。理解LD的模式及其在群体中的动态变化，对于疾病基因定位、群体历史推断和基因型填补等应用至关重要。本实践将引导你运用群体遗传学的基本公式，量化分析两个单核苷酸多态性（SNPs）之间的关联性在多代遗传后的预期变化，从而对遗传重组如何重塑单倍型有一个定量的认识。",
            "id": "4351819",
            "problem": "一个临床基因组学团队正在为一项精准肿瘤学基因检测组合设计主要组织相容性复合体 (MHC) 区域的单核苷酸多态性 (SNP) 标签策略。两个双等位基因的 SNP（其等位基因表示为 $A/a$ 和 $B/b$）在一个重组图谱中相隔 $25{,}000$ 个碱基对，该图谱的全基因组平均重组率约为每兆碱基 $1$ 厘摩。在一次基因混合事件（$t=0$）之后，混合群体中观测到的单倍型频率为：$f_{AB} = 0.25$，$f_{Ab} = 0.35$，$f_{aB} = 0.05$ 和 $f_{ab} = 0.35$。假设一个有效无限大的群体，满足随机交配、无突变、无基因转换和无选择的条件，因此只有重组随时间重塑单倍型，且等位基因频率保持不变。\n\n在这些假设下，仅使用群体遗传学的基本定义，确定在 $t=100$ 代后，这两个 SNP 之间等位基因的平方相关性（一种基于连锁不平衡的插补度量）$r^{2}$ 的期望值。将这两个 SNP 之间的每代重组分数视为 $c = 2.5 \\times 10^{-4}$。将 $r^{2}$ 表示为小数，并将最终答案四舍五入到四位有效数字。",
            "solution": "在尝试解答之前，将根据指定的协议对问题进行验证。\n\n### 第 1 步：提取已知条件\n- **位点和等位基因：** 两个双等位基因的单核苷酸多态性 (SNP)，其等位基因为 $A/a$ 和 $B/b$。\n- **物理距离：** SNP 之间相隔 $25,000$ 个碱基对。\n- **遗传图谱信息：** 全基因组平均重组率约为每兆碱基 $1$ 厘摩 ($1$ cM/Mb)。\n- **初始条件 ($t=0$):**\n    - 单倍型频率 $f_{AB} = 0.25$。\n    - 单倍型频率 $f_{Ab} = 0.35$。\n    - 单倍型频率 $f_{aB} = 0.05$。\n    - 单倍型频率 $f_{ab} = 0.35$。\n- **群体遗传学假设：**\n    - 有效无限大的群体。\n    - 随机交配。\n    - 无突变。\n    - 无基因转换。\n    - 无选择。\n- **经过时间：** $t = 100$ 代。\n- **重组分数：** 两个 SNP 之间的每代重组分数被视为 $c = 2.5 \\times 10^{-4}$。\n- **目标量：** 经过 $t = 100$ 代后等位基因的平方相关性 $r^2$ 的期望值。\n- **输出格式：** 将 $r^2$ 表示为小数，并四舍五入到四位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题陈述的有效性进行评估。\n\n1.  **科学或事实的合理性：** 该问题基于群体遗传学的基本原理，特别是连锁不平衡 (LD) 的概念及其因减数分裂重组而随时间衰减的现象。所提供的假设（无限群体、随机交配等）是 Wright-Fisher 模型中用于分离重组效应的标准理想化条件。\n2.  **一致性：** 所提供的信息在内部是一致的。在背景重组率为 $1$ cM/Mb 的情况下，对于 $25,000$ 个碱基对（$0.025$ Mb）的间隔，给定的重组分数 $c = 2.5 \\times 10^{-4}$ 是合理的。具体来说，$1 \\text{ cM/Mb} \\times 0.025 \\text{ Mb} = 0.025 \\text{ cM}$，这对应于 $0.00025$ 的重组分数，即 $2.5 \\times 10^{-4}$。明确指示使用 $c = 2.5 \\times 10^{-4}$ 消除了任何歧义。初始单倍型频率之和为 $1$（$0.25 + 0.35 + 0.05 + 0.35 = 1.0$），符合完整概率分布的要求。\n3.  **适定性：** 该问题是适定的。给定的条件和假设足以唯一确定在指定时间点的 $r^2$ 值。问题清晰，所需的计算遵循该领域已建立的、明确的公式。\n\n### 第 3 步：结论与行动\n该问题被判定为 **有效**。这是一个标准的、定义明确的群体遗传学练习。将提供完整的解答。\n\n### 解答\n\n目标是计算 $100$ 代后两个 SNP 位点之间等位基因的平方相关系数 $r^2$。$r^2$ 的演化由连锁不平衡 ($D$) 因重组而发生的衰减所决定。\n\n首先，我们根据初始单倍型频率计算每个位点的等位基因频率。在所述假设（无突变、选择或漂变）下，等位基因频率随时间保持不变。设 $p_A$、$p_a$、$p_B$ 和 $p_b$ 分别为等位基因 $A$、$a$、$B$ 和 $b$ 的频率。\n\n等位基因 $A$ 的频率是包含它的单倍型频率之和：\n$$p_A = f_{AB} + f_{Ab} = 0.25 + 0.35 = 0.60$$\n等位基因 $a$ 的频率是：\n$$p_a = f_{aB} + f_{ab} = 0.05 + 0.35 = 0.40$$\n检验一下，$p_A + p_a = 0.60 + 0.40 = 1.0$。\n\n同样，对于第二个位点：\n等位基因 $B$ 的频率是：\n$$p_B = f_{AB} + f_{aB} = 0.25 + 0.05 = 0.30$$\n等位基因 $b$ 的频率是：\n$$p_b = f_{Ab} + f_{ab} = 0.35 + 0.35 = 0.70$$\n检验一下，$p_B + p_b = 0.30 + 0.70 = 1.0$。\n\n接下来，我们计算在第 $t=0$ 代的初始连锁不平衡系数 $D_0$。$D$ 定义为观测到的单倍型频率（例如 $AB$）与两个位点上的等位基因独立关联时所期望的频率之差。\n$$D = f_{AB} - p_A p_B$$\n使用初始值：\n$$D_0 = 0.25 - (0.60)(0.30) = 0.25 - 0.18 = 0.07$$\n\n在没有除重组以外的其他力量作用下，连锁不平衡随世代呈几何级数衰减。第 $t$ 代的 $D$ 值，记为 $D_t$，通过以下方程与其初始值 $D_0$ 相关联：\n$$D_t = D_0 (1-c)^t$$\n其中 $c$ 是每代的重组分数。题目要求我们求出在 $t=100$ 代后，给定重组分数 $c = 2.5 \\times 10^{-4}$ 时群体的状态。\n$$D_{100} = D_0 (1 - 2.5 \\times 10^{-4})^{100} = 0.07 \\times (0.99975)^{100}$$\n\n现在我们可以定义等位基因的平方相关性 $r^2$。它是 LD 的一个归一化度量，由以下公式给出：\n$$r^2 = \\frac{D^2}{p_A p_a p_B p_b}$$\n第 $t=100$ 代的 $r^2$ 值，记为 $r^2_{100}$，是：\n$$r^2_{100} = \\frac{D_{100}^2}{p_A p_a p_B p_b}$$\n由于等位基因频率随时间恒定，分母保持不变。我们来计算它的值：\n$$p_A p_a p_B p_b = (0.60)(0.40)(0.30)(0.70) = (0.24)(0.21) = 0.0504$$\n现在我们可以代入 $D_{100}$ 的表达式：\n$$r^2_{100} = \\frac{\\left[0.07 \\times (0.99975)^{100}\\right]^2}{0.0504}$$\n$$r^2_{100} = \\frac{(0.07)^2 \\times \\left((0.99975)^{100}\\right)^2}{0.0504} = \\frac{0.0049 \\times (0.99975)^{200}}{0.0504}$$\n现在，我们进行数值计算：\n首先，计算衰减因子：\n$$(0.99975)^{200} \\approx 0.95122942$$\n然后，将此值代入 $r^2_{100}$ 的表达式中：\n$$r^2_{100} \\approx \\frac{0.0049 \\times 0.95122942}{0.0504} \\approx \\frac{0.004661024}{0.0504}$$\n$$r^2_{100} \\approx 0.09247944$$\n\n题目要求答案四舍五入到四位有效数字。\n$$r^2_{100} \\approx 0.09248$$\n这就是经过 $100$ 代随机交配和重组后，两个 SNP 上等位基因之间的平方相关性的期望值。",
            "answer": "$$\n\\boxed{0.09248}\n$$"
        },
        {
            "introduction": "基因组并非仅仅是一条线性序列，它在细胞核内被折叠成复杂的三维结构，例如拓扑关联结构域（Topologically Associating Domains, TADs）。TAD的边界通常作为“绝缘子”，能够阻止增强子与非目标启动子之间的不当相互作用，其完整性对正常的基因调控至关重要。本练习利用一个基于染色质聚合物物理学和基因表达动力学的定量模型，来预测一个破坏TAD边界的结构变异如何导致原癌基因的异常激活，从而将基因组三维结构与定量的功能性后果直接联系起来。",
            "id": "4351817",
            "problem": "在一名患者体内，一个删除了关键CCCTC结合因子（CTCF）位点的结构变异，导致一个分隔远端增强子和原癌基因的拓扑关联结构域（TAD）边界部分受损。在正常细胞中，该边界隔绝了跨结构域的增强子-启动子相互作用。在该患者中，通过高通量染色体构象捕获（Hi-C）技术检测到跨越受损边界的染色质泄漏增强。\n\n假设以下基本原理：\n- 分子生物学中心法则：基因的转录输出受增强子-启动子通讯的调控，并反映在信使核糖核酸（mRNA）的丰度上。\n- 染色质的聚合物物理学：两个相隔基因组距离 $d$（单位为千碱基）的位点之间的基线接触概率由幂律 $P_{\\mathrm{poly}}(d) = A d^{-\\alpha}$ 给出，其中 $A$ 和 $\\alpha$ 是正常数。\n- TAD边界的绝缘作用：跨越边界的有效接触概率为 $P = s \\, P_{\\mathrm{poly}}(d)$，其中 $s \\in (0,1)$ 是一个绝缘系数，较小的值反映更强的绝缘性。\n- 增强子驱动的转录激活可以用一个可饱和协同响应（希尔型）来描述：稳态mRNA丰度为 $E(P) = E_{0} + E_{\\max} \\dfrac{P^{n}}{K^{n} + P^{n}}$，其中 $E_{0}$ 是基础水平，$E_{\\max}$ 是增强子依赖的最大增量，$K$ 是半饱和接触概率，$n$ 是希尔系数。\n\n在本案例中：\n- 增强子与原癌基因之间的基因组距离为 $d = 150$ 千碱基。\n- 聚合物标度参数为 $A = 0.6$ 和 $\\alpha = 1.0$。\n- 绝缘系数分别为 $s_{\\mathrm{pre}} = 0.05$（完整边界）和 $s_{\\mathrm{post}} = 0.50$（受损边界）。\n- 转录激活参数为 $E_{0} = 10$，$E_{\\max} = 90$，$K = 0.0015$ 和 $n = 2$。\n\n仅使用上述基本原理，推导由于边界受损导致的患者mRNA丰度预测倍数变化，\n$$F = \\frac{E(P_{\\mathrm{post}})}{E(P_{\\mathrm{pre}})},$$\n其中 $P_{\\mathrm{pre}} = s_{\\mathrm{pre}} A d^{-\\alpha}$ 且 $P_{\\mathrm{post}} = s_{\\mathrm{post}} A d^{-\\alpha}$，并计算其数值。将最终的倍数变化表示为小数，并四舍五入至四位有效数字。最终答案无需单位。",
            "solution": "对用户提供的问题进行有效性评估。\n\n### 步骤1：提取已知条件\n- **原理1（中心法则）：** 基因的转录输出受增强子-启动子通讯的调控，并反映在信使核糖核酸（mRNA）的丰度上。\n- **原理2（聚合物物理学）：** 两个相隔基因组距离 $d$（单位为千碱基）的位点之间的基线接触概率由幂律 $P_{\\mathrm{poly}}(d) = A d^{-\\alpha}$ 给出，其中 $A$ 和 $\\alpha$ 是正常数。\n- **原理3（绝缘作用）：** 跨越边界的有效接触概率为 $P = s \\, P_{\\mathrm{poly}}(d)$，其中 $s \\in (0,1)$ 是一个绝缘系数。\n- **原理4（转录激活）：** 稳态mRNA丰度由一个希尔型方程给出：$E(P) = E_{0} + E_{\\max} \\dfrac{P^{n}}{K^{n} + P^{n}}$，其中 $E_{0}$ 是基础水平，$E_{\\max}$ 是增强子依赖的最大增量，$K$ 是半饱和接触概率，$n$ 是希尔系数。\n- **问题特定数据：**\n    - 基因组距离：$d = 150$ 千碱基。\n    - 聚合物标度参数：$A = 0.6$ 和 $\\alpha = 1.0$。\n    - 绝缘系数：$s_{\\mathrm{pre}} = 0.05$（完整边界）和 $s_{\\mathrm{post}} = 0.50$（受损边界）。\n    - 转录激活参数：$E_{0} = 10$，$E_{\\max} = 90$，$K = 0.0015$ 和 $n = 2$。\n- **目标：** 推导患者mRNA丰度的预测倍数变化 $F = \\frac{E(P_{\\mathrm{post}})}{E(P_{\\mathrm{pre}})}$，其中 $P_{\\mathrm{pre}} = s_{\\mathrm{pre}} A d^{-\\alpha}$ 且 $P_{\\mathrm{post}} = s_{\\mathrm{post}} A d^{-\\alpha}$，并计算其数值，四舍五入至四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n- **科学依据：** 该问题基于分子生物学和生物物理学的既定原理。使用幂律来描述染色质接触概率和使用希尔型方程来描述转录响应是该领域的标准（尽管是简化的）模型。所有概念（TAD、CTCF、增强子、Hi-C）在基因组学中都是标准的。该前提在科学上是合理的。\n- **良态问题：** 该问题提供了明确的目标以及所有必要的参数和方程，可以得出一个唯一的数值解。问题设置是自洽的。\n- **客观性：** 语言精确且定量。不存在主观或基于意见的陈述。\n- **完整性与一致性：** 问题没有欠定或超定。所有给定的数据都是一致的，并且足以进行计算。\n- **现实性：** 参数值在生物系统的合理范围内。\n- 该问题不是琐碎、不可形式化、不可验证或病态的。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将推导解答过程。\n\n目标是计算mRNA丰度的倍数变化 $F$，其定义为边界受损后的丰度 $E(P_{\\mathrm{post}})$ 与受损前的丰度 $E(P_{\\mathrm{pre}})$ 之比。\n\n首先，我们使用给定的聚合物标度模型 $P_{\\mathrm{poly}}(d) = A d^{-\\alpha}$，计算基因组距离为 $d = 150$ 千碱基时的基线接触概率 $P_{\\mathrm{poly}}(d)$。\n使用参数 $A = 0.6$ 和 $\\alpha = 1.0$：\n$$P_{\\mathrm{poly}}(d) = (0.6) \\times (150)^{-1.0} = \\frac{0.6}{150} = 0.004$$\n\n接下来，我们确定完整（受损前）和受损（受损后）状态下的有效接触概率。它们分别表示为 $P_{\\mathrm{pre}}$ 和 $P_{\\mathrm{post}}$，通过将基线概率与相应的绝缘系数 $s_{\\mathrm{pre}} = 0.05$ 和 $s_{\\mathrm{post}} = 0.50$ 相乘来计算。\n对于完整边界：\n$$P_{\\mathrm{pre}} = s_{\\mathrm{pre}} \\times P_{\\mathrm{poly}}(d) = 0.05 \\times 0.004 = 0.0002$$\n对于受损边界：\n$$P_{\\mathrm{post}} = s_{\\mathrm{post}} \\times P_{\\mathrm{poly}}(d) = 0.50 \\times 0.004 = 0.002$$\n\n现在，我们使用给定的转录激活希尔型方程计算相应的mRNA丰度水平 $E(P_{\\mathrm{pre}})$ 和 $E(P_{\\mathrm{post}})$：\n$E(P) = E_{0} + E_{\\max} \\dfrac{P^{n}}{K^{n} + P^{n}}$。\n此方程的参数给定为 $E_{0} = 10$，$E_{\\max} = 90$，$K = 0.0015$ 和 $n = 2$。\n\n对于受损前状态，当 $P_{\\mathrm{pre}} = 0.0002$ 时：\n$$E(P_{\\mathrm{pre}}) = 10 + 90 \\times \\frac{(0.0002)^{2}}{(0.0015)^{2} + (0.0002)^{2}}$$\n$$E(P_{\\mathrm{pre}}) = 10 + 90 \\times \\frac{4 \\times 10^{-8}}{2.25 \\times 10^{-6} + 4 \\times 10^{-8}}$$\n$$E(P_{\\mathrm{pre}}) = 10 + 90 \\times \\frac{4 \\times 10^{-8}}{225 \\times 10^{-8} + 4 \\times 10^{-8}}$$\n$$E(P_{\\mathrm{pre}}) = 10 + 90 \\times \\frac{4}{229} = 10 + \\frac{360}{229}$$\n$$E(P_{\\mathrm{pre}}) \\approx 10 + 1.571965 = 11.571965$$\n\n对于受损后状态，当 $P_{\\mathrm{post}} = 0.002$ 时：\n$$E(P_{\\mathrm{post}}) = 10 + 90 \\times \\frac{(0.002)^{2}}{(0.0015)^{2} + (0.002)^{2}}$$\n$$E(P_{\\mathrm{post}}) = 10 + 90 \\times \\frac{4 \\times 10^{-6}}{2.25 \\times 10^{-6} + 4 \\times 10^{-6}}$$\n$$E(P_{\\mathrm{post}}) = 10 + 90 \\times \\frac{4}{2.25 + 4} = 10 + 90 \\times \\frac{4}{6.25}$$\n$$E(P_{\\mathrm{post}}) = 10 + 90 \\times 0.64 = 10 + 57.6 = 67.6$$\n\n最后，我们通过计算 $E(P_{\\mathrm{post}})$ 与 $E(P_{\\mathrm{pre}})$ 的比值来计算倍数变化 $F$：\n$$F = \\frac{E(P_{\\mathrm{post}})}{E(P_{\\mathrm{pre}})} = \\frac{67.6}{11.571965} \\approx 5.841570...$$\n\n问题要求答案四舍五入至四位有效数字。\n$$F \\approx 5.842$$\n这一结果表明，TAD边界的受损预计会导致原癌基因的mRNA丰度增加约 $5.8$ 倍，突显了一种潜在的肿瘤发生机制。",
            "answer": "$$\\boxed{5.842}$$"
        },
        {
            "introduction": "在临床基因组学中，解释遗传变异的致病性是一项复杂的任务，常常需要综合多方面的证据。对于常染色体隐性遗传病，确定患者携带的两个变异是否分别位于两条同源染色体上（即处于反式构型，in trans），是判断其是否为复合杂合致病的关键。本练习将向你展示如何结合群体遗传学原理（等位基因频率、连锁不平衡）与变异特异性的致病概率，来推断一个双杂合子携带致病性复合杂合基因型的后验概率，这个过程是现代精准医学中进行变异解读的核心环节。",
            "id": "4351771",
            "problem": "一种常染色体隐性遗传病由基因 $G$ 中的双等位基因致病性变异引起。一名先证者被鉴定出在基因 $G$ 内有两个罕见变异：变异 $a$（一个位于受无义介导的 mRNA 降解影响的外显子中的预测性功能丧失性无义变异）和变异 $b$（一个位于催化结构域的错义变异）。其父母均无法进行检测，因此 $a$ 和 $b$ 的连锁相是未知的。假设以下条件，均在单个随机交配的群体中成立：\n\n- 罕见等位基因的次要等位基因频率分别为 $p_a = 1.0 \\times 10^{-4}$ 和 $p_b = 5.0 \\times 10^{-5}$。\n- 这两个基因座处于正连锁不平衡状态，系数为 $D = 1.0 \\times 10^{-8}$，其中 $D$ 的定义为 $D = P(ab) - p_a p_b$。\n- 哈迪-温伯格平衡成立，并且双基因座系统的四种单倍型频率由 $p_a$、$p_b$ 和 $D$ 决定。\n- 在一个随机选取的双基因座双杂合子中，连锁相必须是相引相 $(ab)/(AB)$ 或相斥相 $(aB)/(Ab)$，其中 $A$ 和 $B$ 表示这两个基因座的参考等位基因。\n- 当两个致病等位基因处于反式构型（trans）时，该疾病会表现出来，对于此类双等位基因致病性基因型，外显率为 $\\pi = 0.95$。\n- 变异 $a$ 确实是致病性的后验概率为 $q_a = 0.99$，变异 $b$ 确实是致病性的后验概率为 $q_b = 0.80$。\n\n假设变异的致病性与连锁相之间相互独立，并且 $a$ 和 $b$ 的致病性状态也相互独立。仅使用哈迪-温伯格平衡和连锁不平衡的定义，从第一性原理推导出一个随机双杂合子携带处于反式构型的 $a$ 和 $b$ 的条件概率，并将其与变异水平的后验概率和外显率相结合，计算该先证者在基因 $G$ 中携带一个致病性复合杂合基因型（定义为两个变异处于反式构型、两者都确实是致病性的、并且在给定 $\\pi$ 的情况下会表现出疾病的联合概率）的后验概率。将您的最终答案表示为小数，并四舍五入到四位有效数字。",
            "solution": "用户希望我以一位严谨的STEM教授的身份解决一个遗传学问题。我将首先验证该问题，如果问题有效，我将提供一个详细的、分步的解答。\n\n### **问题验证**\n\n**步骤1：提取已知条件**\n-   **疾病状况：**常染色体隐性遗传，由基因 $G$ 中的双等位基因致病性变异引起。\n-   **先证者：**携带两个罕见变异 $a$ 和 $b$。连锁相未知。\n-   **等位基因频率：**$a$ 的次要等位基因频率为 $p_a = 1.0 \\times 10^{-4}$。$b$ 的次要等位基因频率为 $p_b = 5.0 \\times 10^{-5}$。\n-   **连锁不平衡 (LD)：**正相关，系数为 $D = 1.0 \\times 10^{-8}$。\n-   **LD 定义：**$D = P(ab) - p_a p_b$，其中 $P(ab)$ 是携带两个次要等位基因的单倍型的频率。\n-   **群体假设：**单个随机交配群体，满足哈迪-温伯格平衡 (HWE)，四种单倍型频率由 $p_a$、$p_b$ 和 $D$ 决定。\n-   **双杂合子的连锁相：**一个随机双杂合子的基因型为 $(ab)/(AB)$（相引相）或 $(aB)/(Ab)$（相斥相/反式），其中 $A$ 和 $B$ 是参考（野生型）等位基因。\n-   **外显率：**对于携带两个处于反式构型的致病等位基因的基因型，外显率为 $\\pi = 0.95$。\n-   **致病性概率：**$a$ 是致病性的后验概率为 $q_a = 0.99$。$b$ 是致病性的后验概率为 $q_b = 0.80$。\n-   **独立性假设：**致病性与连锁相独立。$a$ 的致病性与 $b$ 的致病性独立。\n-   **目标：**计算先证者携带致病性复合杂合基因型的后验概率，该概率定义为变异处于反式构型、两者都致病且疾病表现出来的联合概率。\n-   **输出格式：**四舍五入到四位有效数字的小数。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：**该问题坚实地基于群体遗传学和医学遗传学的既定原则，包括哈迪-温伯格平衡、连锁不平衡、常染色体隐性遗传以及致病性和外显率的概率模型。术语和参数（$p_a, p_b, D, \\pi, q_a, q_b$）是标准的，其数值对于罕见遗传变异是现实的。\n-   **适定性：**该问题是适定的。它清楚地定义了要计算的量，并提供了所有必要的数值和假设以得出唯一解。\n-   **客观性：**该问题以客观、科学的语言陈述，没有歧义或主观论断。\n-   **完整性与一致性：**该问题是自洽的。提供的参数是一致的。连锁不平衡系数 $D$ 必须满足界限 $|D| \\le \\min(p_a p_B, p_b p_A)$。这里 $p_A = 1-p_a$ 且 $p_B = 1-p_b$。$D$ 的最大可能值为 $\\min(p_a(1-p_b), p_b(1-p_a)) \\approx \\min(10^{-4}, 5 \\times 10^{-5}) = 5 \\times 10^{-5}$。给定值 $D=10^{-8}$ 远在此界限内。可以证明所有单倍型频率均为正数，因此参数是一致的。\n\n**步骤3：结论与行动**\n该问题是有效的，因为它在科学上是合理的、适定的、客观的且内部一致的。我将继续进行解答。\n\n### **解答**\n\n目标是计算先证者携带致病性复合杂合基因型的后验概率。问题将其定义为以下四个事件的联合概率：\n1.  变异 $a$ 和 $b$ 处于*反式*构型（即，在同源染色体上，基因型为 $(aB)/(Ab)$）。\n2.  变异 $a$ 确实是致病性的。\n3.  变异 $b$ 确实是致病性的。\n4.  在给定致病性反式基因型的情况下，疾病表现出来。\n\n已知该先证者是一个双杂合子，即拥有一个等位基因 $a$ 的拷贝和一个等位基因 $b$ 的拷贝。因此，计算是在先证者是这两个基因座的双杂合子的条件下进行的。设 $DH$ 为随机选择一个个体是双杂合子的事件。\n\n我们需要计算 $P_{causal} = P(\\text{反式} \\cap a_{\\text{致病}} \\cap b_{\\text{致病}} \\cap \\text{表现} | DH)$。\n问题陈述了致病性与连锁相之间、以及 $a$ 和 $b$ 的致病性之间的独立性。这允许我们将概率分解为乘积：\n$$P_{causal} = P(\\text{反式} | DH) \\times P(a_{\\text{致病}}) \\times P(b_{\\text{致病}}) \\times P(\\text{表现} | \\text{反式}, a_{\\text{致病}}, b_{\\text{致病}})$$\n问题提供了以下数值：\n-   $P(a_{\\text{致病}}) = q_a = 0.99$\n-   $P(b_{\\text{致病}}) = q_b = 0.80$\n-   $P(\\text{表现} | \\dots) = \\pi = 0.95$\n\n核心任务是从第一性原理推导 $P(\\text{反式} | DH)$。\n\n**1. 单倍型频率**\n设 $p_a$ 和 $p_b$ 分别是次要等位基因 $a$ 和 $b$ 的频率，而 $p_A=1-p_a$ 和 $p_B=1-p_b$ 分别是参考等位基因 $A$ 和 $B$ 的频率。有四种可能的单倍型：$AB$、$Ab$、$aB$ 和 $ab$。它们的频率分别表示为 $P(AB)$、$P(Ab)$、$P(aB)$ 和 $P(ab)$。\n\n这些频率之间的关系如下：\n$$p_a = P(aB) + P(ab)$$\n$$p_b = P(Ab) + P(ab)$$\n$$p_A = P(AB) + P(Ab)$$\n$$p_B = P(AB) + P(aB)$$\n\n连锁不平衡系数 $D$ 由 $D = P(ab) - p_a p_b$ 给出。我们可以用 $p_a$、$p_b$ 和 $D$ 来表示所有的单倍型频率。\n-   $P(ab) = p_a p_b + D$\n-   $P(aB) = p_a - P(ab) = p_a - (p_a p_b + D) = p_a(1-p_b) - D$\n-   $P(Ab) = p_b - P(ab) = p_b - (p_a p_b + D) = p_b(1-p_a) - D$\n-   $P(AB) = 1 - P(ab) - P(aB) - P(Ab) = 1 - P(ab) - (p_a - P(ab)) - (p_b - P(ab)) = 1 - p_a - p_b + P(ab) = 1 - p_a - p_b + p_a p_b + D = (1-p_a)(1-p_b) + D$\n\n**2. 基因型频率和条件连锁相概率**\n一个双杂合子可以有两种基因型之一：\n-   相引相：$(ab)/(AB)$。个体从一个亲本遗传一个 $ab$ 单倍型，从另一个亲本遗传一个 $AB$ 单倍型。\n-   相斥相（反式）：$(aB)/(Ab)$。个体从一个亲本遗传一个 $aB$ 单倍型，从另一个亲本遗传一个 $Ab$ 单倍型。\n\n在双基因座系统的哈迪-温伯格平衡下，这些基因型在群体中的频率是：\n-   相引相双杂合子的频率：$f_{coup} = 2 \\times P(ab) \\times P(AB)$\n-   反式双杂合子的频率：$f_{trans} = 2 \\times P(aB) \\times P(Ab)$\n\n群体中双杂合子的总频率为 $f_{DH} = f_{coup} + f_{trans}$。一个双杂合子处于反式构型的条件概率是反式双杂合子频率与所有双杂合子总频率的比值。\n$$P(\\text{反式} | DH) = \\frac{f_{trans}}{f_{coup} + f_{trans}} = \\frac{2 P(aB) P(Ab)}{2 P(ab) P(AB) + 2 P(aB) P(Ab)} = \\frac{P(aB) P(Ab)}{P(ab) P(AB) + P(aB) P(Ab)}$$\n\n**3. 数值计算**\n首先，我们使用给定的值计算单倍型频率：\n-   $p_a = 1.0 \\times 10^{-4}$\n-   $p_b = 5.0 \\times 10^{-5}$\n-   $D = 1.0 \\times 10^{-8}$\n\n$P(ab) = (1.0 \\times 10^{-4})(5.0 \\times 10^{-5}) + 1.0 \\times 10^{-8} = 5.0 \\times 10^{-9} + 1.0 \\times 10^{-8} = 1.5 \\times 10^{-8}$\n$P(aB) = p_a - P(ab) = 1.0 \\times 10^{-4} - 1.5 \\times 10^{-8} = 100 \\times 10^{-6} - 0.015 \\times 10^{-6} = 99.985 \\times 10^{-6} = 9.9985 \\times 10^{-5}$\n$P(Ab) = p_b - P(ab) = 5.0 \\times 10^{-5} - 1.5 \\times 10^{-8} = 50 \\times 10^{-6} - 0.015 \\times 10^{-6} = 49.985 \\times 10^{-6} = 4.9985 \\times 10^{-5}$\n$P(AB) = 1 - p_a - p_b + P(ab) = 1 - 1.0 \\times 10^{-4} - 5.0 \\times 10^{-5} + 1.5 \\times 10^{-8} = 1 - 0.00015 + 0.000000015 = 0.999850015$\n\n接下来，我们计算条件概率公式所需的单倍型频率的乘积。\n设 $R = P(aB)P(Ab)$ 且 $C = P(ab)P(AB)$。\n$R = (9.9985 \\times 10^{-5}) \\times (4.9985 \\times 10^{-5}) = 4.997750225 \\times 10^{-9}$\n$C = (1.5 \\times 10^{-8}) \\times (0.999850015) = 1.4997750225 \\times 10^{-8}$\n\n现在，我们计算 $P(\\text{反式} | DH)$：\n$$P(\\text{反式} | DH) = \\frac{R}{C+R} = \\frac{4.997750225 \\times 10^{-9}}{1.4997750225 \\times 10^{-8} + 4.997750225 \\times 10^{-9}}$$\n$$P(\\text{反式} | DH) = \\frac{4.997750225 \\times 10^{-9}}{1.999550045 \\times 10^{-8}} = 0.24994624...$$\n\n**4. 最终概率计算**\n最后，我们将各部分组合起来，求得所需的后验概率 $P_{causal}$：\n$$P_{causal} = P(\\text{反式} | DH) \\times q_a \\times q_b \\times \\pi$$\n$$P_{causal} = (0.24994624...) \\times (0.99) \\times (0.80) \\times (0.95)$$\n首先，我们计算给定概率的乘积：\n$$q_a \\times q_b \\times \\pi = 0.99 \\times 0.80 \\times 0.95 = 0.7524$$\n然后，我们乘以连锁相概率：\n$$P_{causal} = 0.24994624... \\times 0.7524 = 0.18805957...$$\n\n**5. 四舍五入**\n问题要求答案四舍五入到四位有效数字。\n$$P_{causal} \\approx 0.1881$$\n先证者携带致病性复合杂合基因型的后验概率为 $0.1881$。",
            "answer": "$$\n\\boxed{0.1881}\n$$"
        }
    ]
}