{
    "hands_on_practices": [
        {
            "introduction": "连锁不平衡（Linkage Disequilibrium, LD）是基因组学的一个基石概念，为全基因组关联研究（GWAS）和基因型填充等技术提供了理论基础。本练习旨在模拟连锁不平衡因减数分裂中的重组而在代际间发生的衰减过程。通过计算等位基因间关联度平方（$r^2$）的变化，您将从数量上理解遗传重组是如何打破邻近变异之间的关联，这是群体遗传学中的一个核心动态 。",
            "id": "4351819",
            "problem": "一个临床基因组学团队正在为精准肿瘤学基因检测组合设计主要组织相容性复合体（MHC）区域的单核苷酸多态性（SNP）标记策略。两个双等位基因SNP（由等位基因 $A/a$ 和 $B/b$ 表示）在一个重组图谱中相隔 $25{,}000$ 个碱基对，该图谱中全基因组平均重组率约为每兆碱基 $1$ 厘摩。在一次混合事件（$t = 0$）之后，混合群体中观测到的单倍型频率为：$f_{AB} = 0.25$，$f_{Ab} = 0.35$，$f_{aB} = 0.05$ 和 $f_{ab} = 0.35$。假设群体有效无限大、随机交配、无突变、无基因转换、无选择，因此只有重组会随时间重塑单倍型，且等位基因频率保持不变。\n\n仅使用这些假设下群体遗传学的基本定义，确定在 $t = 100$ 代之后，这两个SNP之间等位基因相关性平方（一种基于连锁不平衡的插补度量）$r^{2}$ 的期望值。将这两个SNP之间每代的重组分数视为 $c = 2.5 \\times 10^{-4}$。将 $r^{2}$ 以小数形式表示，并将最终答案四舍五入至四位有效数字。",
            "solution": "### 解答\n\n目标是计算 $100$ 代后两个SNP基因座之间等位基因的相关系数平方 $r^2$。$r^2$ 的演变受重组引起的连锁不平衡（$D$）衰减的控制。\n\n首先，我们根据初始单倍型频率计算每个基因座的等位基因频率。在所述假设（无突变、选择或漂变）下，等位基因频率随时间保持不变。设 $p_A$、$p_a$、$p_B$ 和 $p_b$ 分别为等位基因 $A$、$a$、$B$ 和 $b$ 的频率。\n\n等位基因 $A$ 的频率是包含它的单倍型频率之和：\n$$p_A = f_{AB} + f_{Ab} = 0.25 + 0.35 = 0.60$$\n等位基因 $a$ 的频率是：\n$$p_a = f_{aB} + f_{ab} = 0.05 + 0.35 = 0.40$$\n作为检验，$p_A + p_a = 0.60 + 0.40 = 1.0$。\n\n同样，对于第二个基因座：\n等位基因 $B$ 的频率是：\n$$p_B = f_{AB} + f_{aB} = 0.25 + 0.05 = 0.30$$\n等位基因 $b$ 的频率是：\n$$p_b = f_{Ab} + f_{ab} = 0.35 + 0.35 = 0.70$$\n作为检验，$p_B + p_b = 0.30 + 0.70 = 1.0$。\n\n接下来，我们计算在第 $t=0$ 代的初始连锁不平衡系数 $D_0$。$D$ 定义为观测到的单倍型频率（例如 $AB$）与当两个基因座的等位基因独立关联时所期望的频率之间的差值。\n$$D = f_{AB} - p_A p_B$$\n使用初始值：\n$$D_0 = 0.25 - (0.60)(0.30) = 0.25 - 0.18 = 0.07$$\n\n在没有除重组以外其他力量的情况下，连锁不平衡随世代呈几何级数衰减。第 $t$ 代的 $D$ 值（记为 $D_t$）与其初始值 $D_0$ 通过以下方程相关联：\n$$D_t = D_0 (1-c)^t$$\n其中 $c$ 是每代的重组分数。我们需要找到在 $t=100$ 代后，给定重组分数为 $c = 2.5 \\times 10^{-4}$ 时群体的状态。\n$$D_{100} = D_0 (1 - 2.5 \\times 10^{-4})^{100} = 0.07 \\times (0.99975)^{100}$$\n\n现在我们可以定义等位基因相关性平方 $r^2$。它是LD的一个标准化度量，由以下公式给出：\n$$r^2 = \\frac{D^2}{p_A p_a p_B p_b}$$\n在第 $t=100$ 代的 $r^2$ 值，记为 $r^2_{100}$，是：\n$$r^2_{100} = \\frac{D_{100}^2}{p_A p_a p_B p_b}$$\n由于等位基因频率随时间恒定，分母保持不变。我们来计算它的值：\n$$p_A p_a p_B p_b = (0.60)(0.40)(0.30)(0.70) = (0.24)(0.21) = 0.0504$$\n现在我们可以代入 $D_{100}$ 的表达式：\n$$r^2_{100} = \\frac{\\left[0.07 \\times (0.99975)^{100}\\right]^2}{0.0504}$$\n$$r^2_{100} = \\frac{(0.07)^2 \\times \\left((0.99975)^{100}\\right)^2}{0.0504} = \\frac{0.0049 \\times (0.99975)^{200}}{0.0504}$$\n现在，我们进行数值计算：\n首先，计算衰减因子：\n$$(0.99975)^{200} \\approx 0.95122942$$\n然后，将此值代入 $r^2_{100}$ 的表达式中：\n$$r^2_{100} \\approx \\frac{0.0049 \\times 0.95122942}{0.0504} \\approx \\frac{0.004661024}{0.0504}$$\n$$r^2_{100} \\approx 0.09247944$$\n\n题目要求答案四舍五入到四位有效数字。\n$$r^2_{100} \\approx 0.09248$$\n这是在随机交配和重组作用下，经过 $100$ 代后，两个SNP上等位基因之间相关性平方的期望值。",
            "answer": "$$\n\\boxed{0.09248}\n$$"
        },
        {
            "introduction": "基因组在三维空间中折叠形成拓扑关联结构域（Topologically Associating Domains, TADs）等结构，这对精确的基因调控至关重要。本实践应用一个简化的生物物理模型，将一个结构性变化——TAD边界的减弱——与一个可量化的功能性后果联系起来。您将预测这一结构变异导致的邻近原癌基因表达量的倍数变化，从而阐明基因组结构破坏如何成为一种致病机制 。",
            "id": "4351817",
            "problem": "一名患者体内存在一种结构变异，该变异删除了一个关键的CCCTC结合因子（CTCF）位点，导致分隔一个远端增强子和一个原癌基因的拓扑关联结构域（TAD）边界被部分破坏。在正常细胞中，该边界隔离了跨结构域的增强子-启动子相互作用。在该患者中，通过高通量染色体构象捕获（Hi-C）技术检测到，跨越被削弱边界的染色质渗漏增强。\n\n假设以下基本原理：\n- 分子生物学中心法则：基因的转錄输出受增强子-启动子通讯的调控，并反映在信使核糖核酸（mRNA）的丰度上。\n- 染色质的聚合物物理学：两个相距基因组距离 $d$（单位为千碱基）的基因座之间的基线接触概率由幂律公式给出：$P_{\\mathrm{poly}}(d) = A d^{-\\alpha}$，其中 $A$ 和 $\\alpha$ 是正常数。\n- TAD边界的绝缘作用：跨越一个边界的有效接触概率为 $P = s \\, P_{\\mathrm{poly}}(d)$，其中 $s \\in (0,1)$ 是一个绝缘系数，数值越小表示绝緣作用越强。\n- 增强子驱动的转录激活可由一个饱和协同响应（Hill型）描述：稳态mRNA丰度为 $E(P) = E_{0} + E_{\\max} \\dfrac{P^{n}}{K^{n} + P^{n}}$，其中 $E_{0}$ 是基础水平，$E_{\\max}$ 是增强子依赖的最大增量，$K$ 是半饱和接触概率，$n$ 是Hill系数。\n\n在本案例中：\n- 增强子与原癌基因之间的基因组分离距离为 $d = 150$ 千碱基。\n- 聚合物缩放参数为 $A = 0.6$ 和 $\\alpha = 1.0$。\n- 绝緣系数分别为 $s_{\\mathrm{pre}} = 0.05$（完整边界）和 $s_{\\mathrm{post}} = 0.50$（被破坏的边界）。\n- 转录激活参数为 $E_{0} = 10$，$E_{\\max} = 90$，$K = 0.0015$ 和 $n = 2$。\n\n请仅使用上述基本原理，推导由于边界破坏导致的患者mRNA丰度的预测倍数变化，\n$$F = \\frac{E(P_{\\mathrm{post}})}{E(P_{\\mathrm{pre}})},$$\n其中 $P_{\\mathrm{pre}} = s_{\\mathrm{pre}} A d^{-\\alpha}$ 和 $P_{\\mathrm{post}} = s_{\\mathrm{post}} A d^{-\\alpha}$，并计算其数值。将最终的倍数变化表示为十进制数，并四舍五入至四位有效数字。最终答案无需单位。",
            "solution": "目标是计算mRNA丰度的倍数变化 $F$，其定义为边界破坏后的丰度 $E(P_{\\mathrm{post}})$ 与破坏前的丰度 $E(P_{\\mathrm{pre}})$ 之比。\n\n首先，我们使用给定的聚合物缩放模型 $P_{\\mathrm{poly}}(d) = A d^{-\\alpha}$ 计算基因组分离距离为 $d = 150$ 千碱基时的基线接触概率 $P_{\\mathrm{poly}}(d)$。\n使用参数 $A = 0.6$ 和 $\\alpha = 1.0$：\n$$P_{\\mathrm{poly}}(d) = (0.6) \\times (150)^{-1.0} = \\frac{0.6}{150} = 0.004$$\n\n接下来，我们确定完整（破坏前）和被破坏（破坏后）状态下的有效接触概率。它们分别表示为 $P_{\\mathrm{pre}}$ 和 $P_{\\mathrm{post}}$，通过将基线概率与相应的绝缘系数 $s_{\\mathrm{pre}} = 0.05$ 和 $s_{\\mathrm{post}} = 0.50$ 相乘来计算。\n对于完整边界：\n$$P_{\\mathrm{pre}} = s_{\\mathrm{pre}} \\times P_{\\mathrm{poly}}(d) = 0.05 \\times 0.004 = 0.0002$$\n对于被破坏的边界：\n$$P_{\\mathrm{post}} = s_{\\mathrm{post}} \\times P_{\\mathrm{poly}}(d) = 0.50 \\times 0.004 = 0.002$$\n\n现在，我们使用提供的Hill型转录激活方程计算相应的mRNA丰度水平 $E(P_{\\mathrm{pre}})$ 和 $E(P_{\\mathrm{post}})$：\n$E(P) = E_{0} + E_{\\max} \\dfrac{P^{n}}{K^{n} + P^{n}}$。\n该方程的参数为 $E_{0} = 10$，$E_{\\max} = 90$，$K = 0.0015$ 和 $n = 2$。\n\n对于破坏前状态，其中 $P_{\\mathrm{pre}} = 0.0002$：\n$$E(P_{\\mathrm{pre}}) = 10 + 90 \\times \\frac{(0.0002)^{2}}{(0.0015)^{2} + (0.0002)^{2}}$$\n$$E(P_{\\mathrm{pre}}) = 10 + 90 \\times \\frac{4 \\times 10^{-8}}{2.25 \\times 10^{-6} + 4 \\times 10^{-8}}$$\n$$E(P_{\\mathrm{pre}}) = 10 + 90 \\times \\frac{4 \\times 10^{-8}}{225 \\times 10^{-8} + 4 \\times 10^{-8}}$$\n$$E(P_{\\text{pre}}) = 10 + 90 \\times \\frac{4}{229} = 10 + \\frac{360}{229}$$\n$$E(P_{\\mathrm{pre}}) \\approx 10 + 1.571965 = 11.571965$$\n\n对于破坏后状态，其中 $P_{\\mathrm{post}} = 0.002$：\n$$E(P_{\\mathrm{post}}) = 10 + 90 \\times \\frac{(0.002)^{2}}{(0.0015)^{2} + (0.002)^{2}}$$\n$$E(P_{\\mathrm{post}}) = 10 + 90 \\times \\frac{4 \\times 10^{-6}}{2.25 \\times 10^{-6} + 4 \\times 10^{-6}}$$\n$$E(P_{\\mathrm{post}}) = 10 + 90 \\times \\frac{4}{2.25 + 4} = 10 + 90 \\times \\frac{4}{6.25}$$\n$$E(P_{\\mathrm{post}}) = 10 + 90 \\times 0.64 = 10 + 57.6 = 67.6$$\n\n最后，我们通过计算 $E(P_{\\mathrm{post}})$ 与 $E(P_{\\mathrm{pre}})$ 的比值来计算倍数变化 $F$：\n$$F = \\frac{E(P_{\\mathrm{post}})}{E(P_{\\mathrm{pre}})} = \\frac{67.6}{11.571965} \\approx 5.841570...$$\n\n问题要求答案四舍五入至四位有效数字。\n$$F \\approx 5.842$$\n这一结果表明，TAD边界的破坏预计会导致原癌基因的mRNA丰度增加约 $5.8$ 倍，突显了一种潜在的致癌机制。",
            "answer": "$$\\boxed{5.842}$$"
        },
        {
            "introduction": "在临床遗传学实践中，常会为常染色体隐性遗传病患者在同一基因上发现两个潜在的致病性变异，但确定它们是否位于不同染色体上（即反式构型）是诊断的关键挑战。这个问题要求您综合运用群体遗传学原理（如Hardy-Weinberg平衡和连锁不平衡）与变异特异性的致病证据。通过这个练习，您将学习如何计算一个复合杂合致病基因型的后验概率，这是在精准医疗中进行准确变异解读所必需的一项高级技能 。",
            "id": "4351771",
            "problem": "一种常染色体隐性遗传病是由基因 $G$ 中的双等位基因致病性变异引起的。一名先证者被鉴定出在基因 $G$ 内有两个罕见变异：变异 $a$（一个位于受无义介导的mRNA降解影响的外显子中的预测为功能丧失性的无义变异）和变异 $b$（一个位于催化域中的错义变异）。其双亲均无法进行检测，因此 $a$ 和 $b$ 的相位未知。假设在单个随机交配的群体中，以下条件成立：\n\n- 罕见等位基因的次要等位基因频率为 $p_a = 1.0 \\times 10^{-4}$ 和 $p_b = 5.0 \\times 10^{-5}$。\n- 这两个基因座处于正向连锁不平衡状态，系数为 $D = 1.0 \\times 10^{-8}$，其中 $D$ 的定义为 $D = P(ab) - p_a p_b$。\n- Hardy–Weinberg平衡成立，并且双基因座系统的四个单倍型频率由 $p_a$、$p_b$ 和 $D$ 决定。\n- 在两个基因座上随机选择的双杂合子中，其相位必定是顺式连锁相 $(ab)/(AB)$ 或反式连锁相 $(aB)/(Ab)$，其中 $A$ 和 $B$ 表示这两个基因座上的参考等位基因。\n- 当两个致病等位基因处于反式位置时，疾病会表现出来，对于此类双等位基因致病性基因型，外显率为 $\\pi = 0.95$。\n- 变异 $a$ 确实为致病性的后验概率为 $q_a = 0.99$，变异 $b$ 确实为致病性的后验概率为 $q_b = 0.80$。\n\n假设变异的致病性与相位之间相互独立，并且 $a$ 和 $b$ 的致病性状态也相互独立。仅使用 Hardy–Weinberg 平衡和连锁不平衡的定义，从第一性原理推导出一个随机双杂合子携带反式排列的 $a$ 和 $b$ 的条件概率，并将其与变异水平的后验概率和外显率相结合，计算该先证者在基因 $G$ 中携带致病性复合杂合基因型的后验概率（定义为两个变异处于反式、两者都确实为致病性，并且在给定 $\\pi$ 的情况下会表现出疾病的联合概率）。请用小数表示您的最终答案，并四舍五入到四位有效数字。",
            "solution": "### **解答**\n\n目标是计算先证者携带致病性复合杂合基因型的后验概率。问题将此定义为四个事件的联合概率：\n1.  变异 $a$ 和 $b$ 处于*反式*构型（即，位于同源染色体上，基因型为 $(aB)/(Ab)$）。\n2.  变异 $a$ 确实是致病的。\n3.  变异 $b$ 确实是致病的。\n4.  在给定致病性反式基因型的情况下，疾病表现出来。\n\n已知该先证者是双杂合子，拥有一个等位基因 $a$ 的拷贝和一个等位基因 $b$ 的拷贝。因此，计算是在该先证者是这两个基因座的双杂合子这一条件下进行的。设 $DH$ 为随机选择的个体是双杂合子的事件。\n\n我们需要计算 $P_{causal} = P(\\text{trans} \\cap a_{\\text{path}} \\cap b_{\\text{path}} \\cap \\text{manifests} | DH)$。\n问题陈述了致病性与相位之间、以及 $a$ 和 $b$ 的致病性之间的独立性。这使我们能够将概率分解为乘积形式：\n$$P_{causal} = P(\\text{trans} | DH) \\times P(a_{\\text{path}}) \\times P(b_{\\text{path}}) \\times P(\\text{manifests} | \\text{trans}, a_{\\text{path}}, b_{\\text{path}})$$\n问题提供了以下数值：\n-   $P(a_{\\text{path}}) = q_a = 0.99$\n-   $P(b_{\\text{path}}) = q_b = 0.80$\n-   $P(\\text{manifests} | \\dots) = \\pi = 0.95$\n\n核心任务是从第一性原理推导出 $P(\\text{trans} | DH)$。\n\n**1. 单倍型频率**\n设 $p_a$ 和 $p_b$ 为次要等位基因 $a$ 和 $b$ 的频率，$p_A=1-p_a$ 和 $p_B=1-p_b$ 为参考等位基因 $A$ 和 $B$ 的频率。存在四种可能的单倍型：$AB$、$Ab$、$aB$ 和 $ab$。它们的频率分别表示为 $P(AB)$、$P(Ab)$、$P(aB)$ 和 $P(ab)$。\n\n这些频率之间的关系如下：\n$$p_a = P(aB) + P(ab)$$\n$$p_b = P(Ab) + P(ab)$$\n$$p_A = P(AB) + P(Ab)$$\n$$p_B = P(AB) + P(aB)$$\n\n连锁不平衡系数 $D$ 由 $D = P(ab) - p_a p_b$ 给出。我们可以用 $p_a$、$p_b$ 和 $D$ 来表示所有的单倍型频率。\n-   $P(ab) = p_a p_b + D$\n-   $P(aB) = p_a - P(ab) = p_a(1-p_b) - D$\n-   $P(Ab) = p_b - P(ab) = p_b(1-p_a) - D$\n-   $P(AB) = 1 - P(ab) - P(aB) - P(Ab) = 1 - p_a - p_b + P(ab) = 1 - p_a - p_b + p_a p_b + D = (1-p_a)(1-p_b) + D$\n\n**2. 基因型频率和条件相位概率**\n双杂合子可以有两种基因型之一：\n-   顺式连锁相：$(ab)/(AB)$。个体从一个亲本遗传 $ab$ 单倍型，从另一个亲本遗传 $AB$ 单倍型。\n-   反式连锁相：$(aB)/(Ab)$。个体从一个亲本遗传 $aB$ 单倍型，从另一个亲本遗传 $Ab$ 单倍型。\n\n在双基因座系统的 Hardy-Weinberg 平衡下，这些基因型在群体中的频率为：\n-   顺式连锁双杂合子的频率：$f_{coup} = 2 \\times P(ab) \\times P(AB)$\n-   反式连锁双杂合子的频率：$f_{trans} = 2 \\times P(aB) \\times P(Ab)$\n\n群体中双杂合子的总频率为 $f_{DH} = f_{coup} + f_{trans}$。一个双杂合子处于反式构型的条件概率是反式双杂合子频率与所有双杂合子总频率之比。\n$$P(\\text{trans} | DH) = \\frac{f_{trans}}{f_{coup} + f_{trans}} = \\frac{2 P(aB) P(Ab)}{2 P(ab) P(AB) + 2 P(aB) P(Ab)} = \\frac{P(aB) P(Ab)}{P(ab) P(AB) + P(aB) P(Ab)}$$\n\n**3. 数值计算**\n首先，我们使用给定值计算单倍型频率：\n-   $p_a = 1.0 \\times 10^{-4}$\n-   $p_b = 5.0 \\times 10^{-5}$\n-   $D = 1.0 \\times 10^{-8}$\n\n$P(ab) = (1.0 \\times 10^{-4})(5.0 \\times 10^{-5}) + 1.0 \\times 10^{-8} = 5.0 \\times 10^{-9} + 1.0 \\times 10^{-8} = 1.5 \\times 10^{-8}$\n$P(aB) = p_a - P(ab) = 1.0 \\times 10^{-4} - 1.5 \\times 10^{-8} = 100 \\times 10^{-6} - 0.015 \\times 10^{-6} = 99.985 \\times 10^{-6} = 9.9985 \\times 10^{-5}$\n$P(Ab) = p_b - P(ab) = 5.0 \\times 10^{-5} - 1.5 \\times 10^{-8} = 50 \\times 10^{-6} - 0.015 \\times 10^{-6} = 49.985 \\times 10^{-6} = 4.9985 \\times 10^{-5}$\n$P(AB) = 1 - p_a - p_b + P(ab) = 1 - 1.0 \\times 10^{-4} - 5.0 \\times 10^{-5} + 1.5 \\times 10^{-8} = 1 - 0.00015 + 0.000000015 = 0.999850015$\n\n接下来，我们计算条件概率公式所需的单倍型频率的乘积。\n设 $R = P(aB)P(Ab)$ 且 $C = P(ab)P(AB)$。\n$R = (9.9985 \\times 10^{-5}) \\times (4.9985 \\times 10^{-5}) = 4.997750225 \\times 10^{-9}$\n$C = (1.5 \\times 10^{-8}) \\times (0.999850015) = 1.4997750225 \\times 10^{-8}$\n\n现在，我们计算 $P(\\text{trans} | DH)$：\n$$P(\\text{trans} | DH) = \\frac{R}{C+R} = \\frac{4.997750225 \\times 10^{-9}}{1.4997750225 \\times 10^{-8} + 4.997750225 \\times 10^{-9}}$$\n$$P(\\text{trans} | DH) = \\frac{4.997750225 \\times 10^{-9}}{1.999550045 \\times 10^{-8}} = 0.24994624...$$\n\n**4. 最终概率计算**\n最后，我们将各部分组合起来，以求得所需的后验概率 $P_{causal}$：\n$$P_{causal} = P(\\text{trans} | DH) \\times q_a \\times q_b \\times \\pi$$\n$$P_{causal} = (0.24994624...) \\times (0.99) \\times (0.80) \\times (0.95)$$\n首先，我们计算给定概率的乘积：\n$$q_a \\times q_b \\times \\pi = 0.99 \\times 0.80 \\times 0.95 = 0.7524$$\n然后，我们乘以相位概率：\n$$P_{causal} = 0.24994624... \\times 0.7524 = 0.18805957...$$\n\n**5. 四舍五入**\n问题要求答案四舍五入到四位有效数字。\n$$P_{causal} \\approx 0.1881$$\n该先证者携带致病性复合杂合基因型的后验概率为 $0.1881$。",
            "answer": "$$\n\\boxed{0.1881}\n$$"
        }
    ]
}