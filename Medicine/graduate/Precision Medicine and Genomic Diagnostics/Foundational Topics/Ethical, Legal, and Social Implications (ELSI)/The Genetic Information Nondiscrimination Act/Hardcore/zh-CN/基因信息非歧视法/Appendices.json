{
    "hands_on_practices": [
        {
            "introduction": "GINA合规的第一步是准确识别法律所定义的“遗传信息”。这并非总是直观的，尤其是在处理包含多种健康指标的混合数据集时。本练习提供了一个真实世界中的合规场景，要求您运用GINA的核心定义，从一组数据中区分受保护的遗传信息与其他健康数据，这是处理员工或患者数据时的一项关键技能。",
            "id": "4486137",
            "problem": "一家雇主的健康计划供应商提供了一份关于个体员工的混合数据集，其中包括：(i) 通过唾液脱氧核糖核酸 (DNA) 分析得出的直接面向消费者的血统百分比结果，(ii) 员工自我报告的一级亲属乳腺癌家族史，以及 (iii) 用于糖尿病筛查和监测的糖化血红蛋白 HbA1c (HbA1c) 值。该雇主的合规团队必须确定哪些内容构成《遗传信息非歧视法案》(GINA) 下的“遗传信息”，从基本原则出发证明该判断，并制定修订步骤以避免雇主不被允许地获取遗传信息。\n\n从本案分析所依据的法定核心定义（GINA 下“遗传信息”和“遗传测试”的定义）出发，选择最准确地指出哪些内容是“遗传信息”、根据这些定义解释原因，并提出针对雇佣情境的法律上合理的修订步骤的选项。\n\nA. 血统百分比结果和乳腺癌家族史都是“遗传信息”，而 HbA1c 值不是；血统结果是个体遗传测试的输出，而家族史是“家族成员中疾病或失调的显现”。HbA1c 虽然是与蛋白质相关的实验室值，但不检测基因型、突变或染色体变化，因此在 GINA 下不属于“遗传测试”。修订步骤：指示供应商及任何健康计划合作伙伴不要将血统百分比输出或家族病史传送给雇主；在所有请求中包含 GINA“安全港”条款；如果需要，仅要求汇总的、去身份化的非遗传性健康指标；隔离并清除任何无意中收到的遗传信息；培训员工并配置系统以阻止遗传信息的录入。\n\nB. 所有三项都是“遗传信息”，因为 GINA 包括对蛋白质或代谢物的分析，所以 HbA1c 与血统和家族史一同被计入；因此，雇主必须从任何传送给雇主的数据集中修订血统百分比、家族史和 HbA1c，并且只能接收完全去身份化的人群摘要，不包含任何个体层面的数值。\n\nC. 这些项目都不是“遗传信息”，因为血统百分比反映的是种族而非疾病风险，家族史是个人履历，而 HbA1c 是常规医疗值；因此，无需进行任何修订，雇主可以为了健康计划合规而请求、要求或购买所有三类信息。\n\nD. 只有乳腺癌家族史是“遗传信息”；血统百分比不被涵盖，因为它们不报告突变或疾病，而 HbA1c 是一项常规临床测试。修订步骤：仅阻止家族病史，允许雇主接收和使用血统百分比输出和 HbA1c。\n\nE. 血统百分比和 HbA1c 是“遗传信息”，而家族史仅受健康隐私规则管辖；修订步骤：移除血统信息和 HbA1c，保留家族史用于休假管理和健康计划资格确定，并通知员工家族史可能被用于雇佣决策。",
            "solution": "该问题要求分析三种类型的员工数据——(i) 直接面向消费者的血统百分比结果，(ii) 自我报告的乳腺癌家族史，以及 (iii) 糖化血红蛋白 (HbA1c) 值——以确定根据美国《遗传信息非歧视法案》(GINA)，哪些构成“遗传信息”，并为雇主提出适当的修订步骤。分析必须基于“遗传信息”和“遗传测试”的法定定义。\n\n### 步骤1：问题陈述的验证\n\n**已知条件：**\n1.  **数据项：** 一个混合数据集，包含：\n    *   (i) 通过唾液脱氧核糖核酸 (DNA) 分析得出的直接面向消费者的血统百分比结果。\n    *   (ii) 员工自我报告的一级亲属乳腺癌家族史。\n    *   (iii) 用于糖尿病筛查和监测的糖化血红蛋白 (HbA1c) 值。\n2.  **背景：** 数据由雇主的健康计划供应商持有。雇主的合规团队需要管理这些数据。\n3.  **任务：**\n    *   确定哪些数据项属于 GINA 下的“遗传信息”。\n    *   使用 GINA 的核心定义（“遗传信息”和“遗传测试”）来证明该判断。\n    *   提出修订步骤以确保雇主合规。\n\n**验证：**\n1.  **科学和法律依据：** 该问题基于一部具体的、现实世界中的美国联邦法规，即 2008 年的《遗传信息非歧视法案》。所描述的数据类型（基于 DNA 的血统、家族病史和 HbA1c）是健康和个人数据的常见形式。该情景提出了一个雇主面临的现实合规挑战。其法律和科学前提是合理的。\n2.  **问题定义良好：** 这个问题定义得很好。它要求将具体的法律定义应用于一组事实，以得出关于法律地位和所需行动的结论。这种结构允许基于已建立的法律原则得出一个唯一、正确且有意义的解决方案。\n3.  **客观性：** 问题以精确、客观和无偏见的语言陈述。它描述了一个事实情景，并要求进行基于原则的法律分析。\n\n**结论：** 问题陈述有效。它在科学和法律上是合理的，定义良好且客观。我将继续进行解答。\n\n### 步骤2：从基本原则推导\n\n要解决这个问题，我们必须将 GINA 及其执行法规（例如，29 C.F.R. Part 1635）中的核心定义应用于这三种数据元素中的每一种。\n\n**基本原则：GINA 定义**\n\n1.  **遗传信息 (29 C.F.R. § 1635.3(c))**：“遗传信息”一词指关于以下方面的信息：\n    *   个体的遗传测试。\n    *   该个体家族成员的遗传测试。\n    *   该个体家族成员中疾病或失调的显现（即家族病史）。\n\n2.  **遗传测试 (29 C.F.R. § 1635.3(f))**：“遗传测试”一词指对人类 DNA、RNA、染色体、蛋白质或代谢物进行的，用以检测基因型、遗传变异或染色体变化的分析。\n    *   **法规排除条款**：法规明确指出，“遗传测试”**不包括**“与已显现的疾病、失调或病理状况直接相关，并且可以被医疗保健专业人员合理检测到的蛋白质或代谢物分析”。\n\n**数据元素分析：**\n\n*   **(i) 通过 DNA 分析得出的直接面向消费者的血统百分比结果：**\n    *   这些结果是“人类 DNA 分析”的输出。该分析检测遗传变异（例如，单核苷酸多态性，即 SNPs）以推断血统。\n    *   这完全符合“遗传测试”的定义。测试的目的（血统 vs. 健康）与定义无关。\n    *   因此，血统百分比结果是个体“遗传测试”的输出，根据 GINA 构成**“遗传信息”**。\n\n*   **(ii) 自我报告的乳腺癌家族史：**\n    *   这是关于“家族成员中疾病或失调[乳腺癌]的显现”的信息。\n    *   这完全符合“遗传信息”定义的第三部分。\n    *   因此，乳腺癌家族史根据 GINA 是**“遗传信息”**。\n\n*   **(iii) 糖化血红蛋白 (HbA1c) 值：**\n    *   HbA1c 测试测量糖化血红蛋白的量，这是一种蛋白质。因此，它是一种“蛋白质分析”。\n    *   然而，该测试用于糖尿病的筛查和监测。糖尿病是一种“已显现的疾病、失调或病理状况”。测试结果（HbA1c 水平）与这种已显现的状况“直接相关”。\n    *   因此，HbA1c 测试属于法规排除条款的范围。就 GINA 而言，它**不被**视为“遗传测试”。\n    *   因此，HbA1c 值根据 GINA **不是“遗传信息”**。但是，根据其他法律（如 HIPAA），它属于受保护的健康信息 (PHI)。\n\n**总结与所需行动：**\n*   **遗传信息：** 血统结果和家族史。\n*   **非遗传信息：** HbA1c 值。\n\n根据 GINA 第二章，雇主被禁止索取、要求或购买有关员工或其家庭成员的遗传信息。为遵守规定，雇主必须确保不获取血统结果或家族史。\n\n**法律上合理的修订/合规步骤：**\n1.  **预防：** 主要策略是防止收到该信息。这涉及在合同上和操作上指示健康计划供应商不要将任何被识别为“遗传信息”的数据传送给雇主。\n2.  **安全港：** 所有对健康信息的请求（例如，来自健康计划的请求）都应包含 GINA“安全港”条款，该条款明确警告提供方不要共享遗传信息。\n3.  **数据最小化：** 如果收到任何个人数据，应严格限制为非遗传信息（例如，HbA1c 值，如果健康计划规则允许）。汇总和去身份化的数据是更安全的选择。\n4.  **补救措施：** 如果无意中收到遗传信息，必须将其隔离，如果可能则清除，并且不得用于任何与雇佣相关的目的。必须培训员工处理此类情况，并配置系统以防止录入。\n\n### 步骤3：逐项分析选项\n\n**A. 血统百分比结果和乳腺癌家族史都是“遗传信息”，而 HbA1c 值不是；血统结果是个体遗传测试的输出，而家族史是“家族成员中疾病或失调的显现”。HbA1c 虽然是与蛋白质相关的实验室值，但不检测基因型、突变或染色体变化，所以它在 GINA 下不属于“遗传测试”。修订步骤：指示供应商及任何健康计划合作伙伴不要将血统百分比输出或家族病史传送给雇主；在所有请求中包含 GINA“安全港”条款；如果需要，仅要求汇总的、去身份化的非遗传性健康指标；隔离并清除任何无意中收到的遗传信息；培训员工并配置系统以阻止遗传信息的录入。**\n*   **分析：** 该选项正确地指出血统结果和家族史是遗传信息，而 HbA1c 不是。其理由是正确的：血统结果来自遗传测试，家族史是家族成员中疾病的显现。关于 HbA1c 的推理在技术上也是正确的，因为该测试测量与代谢状态相关的蛋白质浓度，而非基因型。所提出的修订和合规步骤是全面且法律上合理的，涵盖了预防、安全港、数据最小化和补救措施。\n*   **结论：** 正确。\n\n**B. 所有三项都是“遗传信息”，因为 GINA 包括对蛋白质或代谢物的分析，所以 HbA1c 与血统和家族史一同被计入；因此，雇主必须从任何传送给雇主的数据集中修订血统百分比、家族史和 HbA1c，并且只能接收完全去身份化的人群摘要，不包含任何个体层面的数值。**\n*   **分析：** 该选项不正确，因为它错误地将 HbA1c 归类为遗传信息。它依赖于“蛋白质分析”的措辞，但未能应用针对与已显现疾病相关测试的关键法规排除条款。\n*   **结论：** 错误。\n\n**C. 这些项目都不是“遗传信息”，因为血统百分比反映的是种族而非疾病风险，家族史是个人履历，而 HbA1c 是常规医疗值；因此，无需进行任何修订，雇主可以为了健康计划合规而请求、要求或购买所有三类信息。**\n*   **分析：** 该选项存在根本性缺陷。它误解了 GINA 的范围。“遗传测试”的定义不受目的限制（例如，疾病风险）。“家族史”被明确定义为遗传信息。允许雇主“请求、要求或购买”这些信息将导致直接违反 GINA。\n*   **结论：** 错误。\n\n**D. 只有乳腺癌家族史是“遗传信息”；血统百分比不被涵盖，因为它们不报告突变或疾病，而 HbA1c 是一项常规临床测试。修订步骤：仅阻止家族病史，允许雇主接收和使用血统百分比输出和 HbA1c。**\n*   **分析：** 该选项错误地将血统结果排除在遗传信息的定义之外。无论其目的如何，对 DNA 的分析都是一种遗传测试。允许雇主接收血统输出将违反 GINA。\n*   **结论：** 错误。\n\n**E. 血统百分比和 HbA1c 是“遗传信息”，而家族史仅受健康隐私规则管辖；修订步骤：移除血统信息和 HbA1c，保留家族史用于休假管理和健康计划资格确定，并通知员工家族史可能被用于雇佣决策。**\n*   **分析：** 该选项在多个方面都是错误的。它错误地包含了 HbA1c，并错误地将家族史排除在 GINA 的定义之外。家族史是 GINA 下“遗传信息”的核心组成部分。提议“保留家族史”并将其“用于”雇佣决策的行为是对 GINA 非歧视条款的公然和严重违反。\n*   **结论：** 错误。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "理解了“什么”是受保护的信息之后，我们来探讨“为什么”需要GINA。该法案禁止健康保险公司和雇主利用遗传信息进行承保或招聘决策，即使这样做在精算学上是合理的。本练习通过一个简化的精算模型，量化了进行遗传歧视的经济动机。通过计算“预期损失差异”，您将具体地理解GINA通过法律禁令所要解决的现实经济张力。",
            "id": "4390608",
            "problem": "一个医疗保险计划考虑一个为期一年的灾难性临床事件，用事件 $E$ 表示。如果该事件发生，将产生 $C$ 美元的成本，否则成本为 $0$。该计划考虑使用基因型 $G \\in \\{1,0\\}$ 进行承保，其中 $G=1$ 表示携带一种与事件 $E$ 风险升高相关的遗传变异。假设从受保人群中独立同分布地抽取的个体满足以下条件：\n- 风险基因型的流行率为 $P(G=1)=q$ 且 $P(G=0)=1-q$。\n- 事件风险为 $P(E \\mid G=1)=p_{1}$ 和 $P(E \\mid G=0)=p_{0}$，且 $p_{1} > p_{0}$。\n- 如果事件 $E$ 发生，计划的成本为 $C$，否则为 $0$。\n\n为具体起见，取 $q=0.10$，$p_{1}=0.40$，$p_{0}=0.05$ 以及 $C=100{,}000$。\n\n将该计划的预期损失定义为从该人群中抽取的每位潜在申请人的预期理赔成本。根据《遗传信息非歧视法案》(GINA) 的规定，该计划在承保中不得使用遗传信息，因此会接收整个人群，而不以 $G$ 为条件。在一个假设的不合规场景中，该计划被允许使用 $P(E \\mid G)$ 基于遗传信息进行承保，假设它排除了所有 $G=1$ 的申请人（从而只接收 $G=0$ 的申请人）。\n\n仅使用基本概率定义（例如，期望和全概率定律），推导并计算每位潜在申请人的预期损失差异，定义为\n$$\\Delta L \\equiv \\text{(不使用遗传信息的预期损失)} - \\text{(基于 }G\\text{ 进行承保的预期损失)}$$\n请以美元表示最终的预期损失差异。请勿对您的答案进行四舍五入。\n\n然后，根据《遗传信息非歧视法案》(GINA) 的法定基准，简要解释为什么在健康保险承保中，利用任何此类基于 $P(E \\mid G)$ 的精算差异是被禁止的，即使这样做会减少 $\\Delta L$。",
            "solution": "所述问题具有科学依据、提法明确且客观。它提出了一个来自精算科学和群体遗传学的标准但简化的模型。所有必要的数据和定义都已提供，并且没有内部矛盾。因此，我们可以着手求解。\n\n设随机变量 $X$ 代表医疗保险计划为单个潜在申请人产生的成本。问题陈述 $X = C$ 如果灾难性事件 $E$ 发生，否则 $X = 0$。该计划每位潜在申请人的预期损失是此成本的期望值 $E[X]$。根据期望值的定义：\n$$E[X] = C \\cdot P(E) + 0 \\cdot P(\\text{not } E) = C \\cdot P(E)$$\n问题的核心是在两种不同的承保情景下计算 $P(E)$。\n\n我们已知以下数值：\n- 事件成本，$C = \\$100,000$。\n- 风险基因型的流行率，$P(G=1) = q = 0.10$。\n- 非风险基因型的流行率，$P(G=0) = 1-q = 0.90$。\n- 给定风险基因型下事件的条件概率，$P(E \\mid G=1) = p_{1} = 0.40$。\n- 给定非风险基因型下事件的条件概率，$P(E \\mid G=0) = p_{0} = 0.05$。\n\n首先，我们计算不使用遗传信息时的预期损失，这对应于遵守 GINA 的情景。在这种情况下，该计划接收所有潜在申请人。人群中事件 $E$ 的总概率必须使用全概率定律，以基因型 $G$ 为条件进行计算：\n$$P(E) = P(E \\mid G=1)P(G=1) + P(E \\mid G=0)P(G=0)$$\n代入符号变量：\n$$P(E) = p_{1}q + p_{0}(1-q)$$\n因此，这种情景下的预期损失，我们记为 $L_{\\text{GINA}}$，为：\n$$L_{\\text{GINA}} = C \\cdot P(E) = C(p_{1}q + p_{0}(1-q))$$\n使用给定的数值：\n$$L_{\\text{GINA}} = 100,000 \\cdot (0.40 \\cdot 0.10 + 0.05 \\cdot (1-0.10))$$\n$$L_{\\text{GINA}} = 100,000 \\cdot (0.04 + 0.05 \\cdot 0.90)$$\n$$L_{\\text{GINA}} = 100,000 \\cdot (0.04 + 0.045)$$\n$$L_{\\text{GINA}} = 100,000 \\cdot 0.085 = 8,500$$\n因此，在 GINA 规定下，每位潜在申请人的预期损失为 $8,500$ 美元。\n\n接下来，我们计算在假设的不合规情景下，即计划基于遗传信息进行承保时的预期损失。该计划排除了所有 $G=1$ 的申请人，只接收 $G=0$ 的申请人。预期损失被定义为“每位潜在申请人”的损失，这意味着总预期成本是在整个原始人群上取平均，而不仅仅是在被接收的子群体上。\n基因型为 $G=1$ 的个体占人群的比例为 $q$，他们不被接收。因此，他们对计划成本的贡献为 $0$ 美元。\n基因型为 $G=0$ 的个体占人群的比例为 $1-q$，他们被接收。对于这个子群体，事件 $E$ 的概率为 $p_0$。来自这个群体的预期成本，在整个人群上取平均，为 $C \\cdot p_{0} \\cdot P(G=0) = C p_{0} (1-q)$。\n在这种承保情景下的总预期损失，我们记为 $L_{\\text{underwriting}}$，是来自两个群体的预期成本之和：\n$$L_{\\text{underwriting}} = (\\text{来自 } G=1 \\text{ 组的成本}) + (\\text{来自 } G=0 \\text{ 组的成本})$$\n$$L_{\\text{underwriting}} = 0 + C \\cdot p_{0}(1-q) = C p_{0}(1-q)$$\n使用给定的数值：\n$$L_{\\text{underwriting}} = 100,000 \\cdot 0.05 \\cdot (1-0.10)$$\n$$L_{\\text{underwriting}} = 100,000 \\cdot 0.05 \\cdot 0.90$$\n$$L_{\\text{underwriting}} = 5,000 \\cdot 0.90 = 4,500$$\n因此，使用遗传信息承保时，每位潜在申请人的预期损失为 $4,500$ 美元。\n\n最后，我们计算预期损失差异 $\\Delta L$：\n$$\\Delta L = L_{\\text{GINA}} - L_{\\text{underwriting}}$$\n用符号表示：\n$$\\Delta L = C(p_{1}q + p_{0}(1-q)) - C p_{0}(1-q)$$\n$$\\Delta L = C p_{1}q$$\n这个结果是直观的：预期损失的减少正是来自于排除了高风险群体 ($G=1$)，因此该差异等于该群体的预期损失贡献 ($C \\cdot P(E \\text{ and } G=1) = C \\cdot P(E|G=1)P(G=1) = C p_1 q$)。\n使用数值计算：\n$$\\Delta L = 8,500 - 4,500 = 4,000$$\n或者，使用符号公式：\n$$\\Delta L = 100,000 \\cdot 0.40 \\cdot 0.10 = 100,000 \\cdot 0.04 = 4,000$$\n每位潜在申请人的预期损失差异为 $4,000$ 美元。\n\n问题的第二部分要求解释禁止这种做法的法律规定。2008年的《遗传信息非歧视法案》(GINA) 是一项美国联邦法律，它确立了防止基于遗传信息进行歧视的法律基准。GINA法案第一章专门适用于健康保险。它禁止团体健康计划和健康保险公司为了承保目的而使用个人的遗传信息（例如本问题中基因型 $G$ 的状态）。这包括有关资格、保险范围以及保费或缴费金额的决定。这个假设情景，即计划拒绝基因型为 $G=1$ 的个人投保，是对此项法律禁令的直接且明确的违反。该法律是作为一项公共政策而出台的，旨在促进人们在不担心受到保险公司或雇主报复的情况下，获得基因检测和个性化医疗服务。它反映了一项社会共识，即获得健康保险的权利不应取决于个人的遗传倾向，因此，它凌驾于任何可能促使计划进行歧视的纯粹精算或财务动机之上，例如此处计算出的 $\\Delta L$。",
            "answer": "$$\\boxed{4000}$$"
        },
        {
            "introduction": "最后，我们面临一个前瞻性的高级挑战。在人工智能时代，歧视可能是隐蔽的，通过与遗传信息高度相关的“代理变量”（proxies）发生。本练习介绍了一种基于信息论的复杂方法，用于审计预测模型中是否存在此类代理歧视。它为您提供了一种实践性的方法，以确保复杂诊断系统中的算法公平性和GINA合规性。",
            "id": "4390560",
            "problem": "你的任务是为精准医疗和基因组诊断领域的预测性诊断模型构建并实施一个有原则的审计框架，该框架以《遗传信息非歧视法案》(GINA)为基础。审计必须使用信息论度量和基于第一性原理的假設检验，来量化模型的输入特征是否充当了遗传信息的代理指标，然后根据数学定义的阈值判定其合规性。\n\n背景框架：《遗传信息非歧视法案》(GINA) 禁止在某些决策情境中使用遗传信息。为了审计模型特征中是否存在被禁止的对遗传信息的依赖性，你将使用信息论的核心定义和经典的独立性统计检验，来形式化一个信息量度量和合規性阈值。\n\n使用的基础定义：\n- 设遗传变量为一个离散随机变量 $G$，其取值于一个有限集合；设特征 $F$ 为一个离散随机变量，其取值于一个有限集合。审计将针对遗传变量 $G$ 评估每个特征 $F$。\n- $F$ 和 $G$ 之间的香农互信息 (MI) 定义为\n$$\nI(F;G) \\equiv \\sum_{f} \\sum_{g} p_{F,G}(f,g) \\log\\left(\\frac{p_{F,G}(f,g)}{p_{F}(f)\\,p_{G}(g)}\\right),\n$$\n其中 $p_{F,G}(f,g)$ 表示联合概率质量函数，$p_{F}(f)$ 和 $p_{G}(g)$ 表示边缘概率。所有对数均为自然对数，因此 $I(F;G)$ 的单位是奈特 (nats)。\n- 给定一个大小为 $n$ 的数据集，其中包含观测对 $(f_i,g_i)$，$i=1,\\dots,n$，你将使用从计数中获得的经验分布来计算插件估计量 $\\hat{I}(F;G)$。\n\n源自经过充分检验的统计事实的合规性阈值：\n- 为检验两个离散变量之间的独立性，似然比统计量渐近服从卡方随机变量分布。具体来说，在独立性零假设下，统计量 $2n\\,\\hat{I}(F;G)$ 在分布上收敛于一个卡方分布，其自由度等于 $(|\\mathcal{F}|-1)(|\\mathcal{G}|-1)$，其中 $|\\mathcal{F}|$ 是 $F$ 的不同类别数量，而 $|\\mathcal{G}|$ 是 $G$ 的不同类别数量。\n- 使用此渐近结果，在选定的显著性水平 $0 < \\alpha < 1$ 下定义一个合规性阈值。对于自由度 $d \\equiv (|\\mathcal{F}|-1)(|\\mathcal{G}|-1)$，令 $q_{1-\\alpha}(d)$ 表示自由度为 $d$ 的卡方分布的 $(1-\\alpha)$ 分位数。如果经验互信息满足 $\\hat{I}(F;G) \\le \\tau_{\\alpha}$，则审计判定特征 $F$ 为合规，否则为不合规，其中 $\\tau_{\\alpha}$ 是从显著性水平为 $\\alpha$ 的独立性检验导出的阈值。如果 $d=0$（例如，一个常数特征），则认定该特征为合规，因为它无法携带关于 $G$ 的信息。\n\n算法要求：\n- 对每个测试用例，使用经验计数为每个特征计算 $\\hat{I}(F;G)$。\n- 对每个特征，计算自由度 $d$ 和由显著性水平为 $\\alpha$ 的卡方独立性检验所隐含的阈值 $\\tau_{\\alpha}$。\n- 如果 $\\hat{I}(F;G) > \\tau_{\\alpha}$ 且 $d>0$，则特征为不合规，否则为合规。\n- 对每个测试用例，输出该用例中所有特征里不合规特征的整数总数。\n\n数据规格與測試套件：\n- 所有变量都是离散且无单位的。不涉及物理单位或角度单位。不应输出百分比；分数和概率已隐含在经验计算中。\n\n你必须完全按照下述规格实现以下四个测试用例。在每个用例中，构建 $G$ 和特征的数组，以使指定的联合结构成立。每个用例中的特征表示为 $F^{(1)},F^{(2)},F^{(3)}$，并且审计是针对每个 $F^{(j)}$ 相对于 $G$ 独立执行的。\n\n测试用例 1（理想路径；精确独立与常数特征）：\n- 样本量 $n=120$。\n- 遗传变量 $G$ 为二元的，包含 60 个 $0$ 实例，后跟 60 个 $1$ 实例。\n- 特征 $F^{(1)}$ 是二元的，且与 $G$ 精确独立，其联合计数为\n$$\n\\left[\\begin{array}{cc}\n30  & 30\\\\\n30  & 30\n\\end{array}\\right],\n$$\n意味着有 30 个 $(F^{(1)}=0,G=0)$ 实例、30 个 $(F^{(1)}=0,G=1)$ 实例、30 个 $(F^{(1)}=1,G=0)$ 实例和 30 个 $(F^{(1)}=1,G=1)$ 实例。\n- 特征 $F^{(2)}$ 是一个常数，对所有 120 个样本其值均为 $0$。\n- 特征 $F^{(3)}$ 是三元的，且与 $G$ 精确独立，其联合计数为\n$$\n\\left[\\begin{array}{cc}\n20  & 20\\\\\n20  & 20\\\\\n20  & 20\n\\end{array}\\right],\n$$\n遍布于 $(F^{(3)},G)$ 的 $3\\times 2$ 网格中。\n- 显著性水平 $\\alpha=0.05$。\n\n测试用例 2（强代理使用）：\n- 样本量 $n=100$。\n- 遗传变量 $G$ 为二元的，包含 50 个 $0$ 实例，后跟 50 个 $1$ 实例。\n- 特征 $F^{(1)}$ 是一个完美代理：对于所有 100 个样本，$F^{(1)}=G$。\n- 特征 $F^{(2)}$ 是一个近乎完美的代理：首先对于所有样本设置 $F^{(2)}=G$，然后翻转 $F^{(2)}$ 的前 5 个条目（将 $0$ 变为 $1$，将 $1$ 变为 $0$）。\n- 特征 $F^{(3)}$ 是二元的，且与 $G$ 精确独立，其联合计数为\n$$\n\\left[\\begin{array}{cc}\n25  & 25\\\\\n25  & 25\n\\end{array}\\right].\n$$\n- 显著性水平 $\\alpha=0.01$。\n\n测试用例 3（边缘弱相关；应为合规）：\n- 样本量 $n=50$。\n- 遗传变量 $G$ 为二元的，包含 25 个 $0$ 实例，后跟 25 个 $1$ 实例。\n- 特征 $F^{(1)}$ 是二元的，通过联合计数与 $G$ 存在轻微依赖性\n$$\n\\left[\\begin{array}{cc}\n15  & 11\\\\\n10  & 14\n\\end{array}\\right],\n$$\n在 50 个样本中，$F^{(1)}$ 与 $G$ 之间有 29 个匹配项。\n- 特征 $F^{(2)}$ 是二元的，且与 $G$ 近似独立，其联合计数为\n$$\n\\left[\\begin{array}{cc}\n13  & 12\\\\\n12  & 13\n\\end{array}\\right].\n$$\n- 特征 $F^{(3)}$ 是一个常数，对所有 50 个样本其值均为 $0$。\n- 显著性水平 $\\alpha=0.05$。\n\n测试用例 4（多类别遗传学；派生的二元指示器代理）：\n- 样本量 $n=90$。\n- 遗传变量 $G$ 是三元的，包含 $0$、$1$ 和 $2$ 各 30 个实例。\n- 特征 $F^{(1)}$ 是一个由 $F^{(1)}=\\mathbb{1}\\{G=2\\}$ 确定性定义的二元指示器代理，因此当且仅当 $G=2$ 时 $F^{(1)}=1$，否则 $F^{(1)}=0$。\n- 特征 $F^{(2)}$ 是三元的，且与 $G$ 精确独立，其联合计数为\n$$\n\\left[\\begin{array}{ccc}\n10  & 10  & 10\\\\\n10  & 10  & 10\\\\\n10  & 10  & 10\n\\end{array}\\right],\n$$\n遍布于 $(F^{(2)},G)$ 的 $3\\times 3$ 网格中。\n- 特征 $F^{(3)}$ 是一个常数，对所有 90 个样本其值均为 $0$。\n- 显著性水平 $\\alpha=0.05$。\n\n程序输出规格：\n- 实现该审计并按所列顺序将其应用于四个测试用例。\n- 对每个测试用例，生成一个等于在阈值规则下不合规的特征数量的单个整数。\n- 你的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4]$），$r_i$ 是测试用例 $i$ 的整数计数。\n\n程序必须是完整、自包含的，且不得需要任何用户输入、外部文件或网络访问。它必须严格遵守另外指定的执行环境和库约束。",
            "solution": "对预测模型是否符合《遗传信息非歧视法案》(GINA) 进行审计的问题，是一项定义明确且有科学依据的任务。它要求将信息论和统计假设检验的既定原则应用于一组明确定义的数据。该问题提供了推导唯一、可验证解所需的所有必要定义、常数和数据结构。其前提在事实上是合理的，术语是精确的，目标是明确的。因此，该问题是有效的。\n\n解决方案的步骤是首先建立理论框架，然后将其应用于指定的测试用例。\n\n**1. 理论框架**\n\n审计的核心是量化模型特征（由离散随机变量 $F$ 表示）与遗传信息（由离散随机变量 $G$ 表示）之间的统计依赖性。为此选择的度量是香Shannon互信息 (MI)，定义如下：\n\n$$I(F;G) \\equiv \\sum_{f \\in \\mathcal{F}} \\sum_{g \\in \\mathcal{G}} p_{F,G}(f,g) \\log\\left(\\frac{p_{F,G}(f,g)}{p_{F}(f)\\,p_{G}(g)}\\right)$$\n\n此处，$p_{F,G}(f,g)$ 是 $(F,G)$ 的联合概率质量函数 (PMF)，$p_F(f)$ 和 $p_G(g)$ 分别是边缘概率质量函数。所有对数均为自然对数，因此 MI 以奈特 (nats) 为单位。互信息是非负的，$I(F;G) \\ge 0$，且当且仅当 $F$ 和 $G$ 统计独立时等于零。\n\n给定一个包含 $n$ 个观测值的数据集，我们并不知道真实的 PMF。取而代之，我们使用从观测频率中导出的经验分布。设 $N(f,g)$ 为特征值为 $f$ 且遗传变量值为 $g$ 的观测计数。这些计数构成一个列联表。经验联合 PMF 为 $\\hat{p}_{F,G}(f,g) = N(f,g)/n$。经验边缘 PMF 分别为 $\\hat{p}_F(f) = \\sum_g \\hat{p}_{F,G}(f,g)$ 和 $\\hat{p}_G(g) = \\sum_f \\hat{p}_{F,G}(f,g)$。将这些代入 MI 公式，得到插件估计量 $\\hat{I}(F;G)$。\n\n观测到非零的经验 MI，即 $\\hat{I}(F;G) > 0$，并不足以断定存在依赖性，因为即使变量实际上是独立的，这也可能由随机抽样波动引起。需要进行统计检验来评估观测到的依赖性的显著性。问题指定使用似然比检验（G检验）来检验列联表中的独立性。统计学中的一个关键结果表明，在独立性零假设（$H_0$）下，检验统计量 $2n\\,\\hat{I}(F;G)$ 渐近服从卡方（$\\chi^2$）随机变量分布。\n\n该 $\\chi^2$ 分布的自由度 $d$ 由列联表的大小决定：\n\n$$d = (|\\mathcal{F}| - 1)(|\\mathcal{G}| - 1)$$\n\n其中 $|\\mathcal{F}|$ 和 $|\\mathcal{G}|$ 分别是特征 $F$ 和遗传变量 $G$ 的不同类别数。\n\n对于选定的显著性水平 $\\alpha$，我们可以从自由度为 $d$ 的 $\\chi^2$ 分布中找到一个临界值 $q_{1-\\alpha}(d)$，使得 $P(\\chi^2(d) > q_{1-\\alpha}(d)) = \\alpha$。如果观测到的检验统计量大于此临界值，我们将拒绝独立性零假设：\n\n$$2n\\,\\hat{I}(F;G) > q_{1-\\alpha}(d)$$\n\n这个框架被用来定义合规性规则。如果一个特征与 $G$ 相关的证据在 $\\alpha$ 水平上统计显著，则该特征被视为不合规。重新排列上述不等式，如果一个特征 $F$ 的经验互信息超过了导出的阈值 $\\tau_{\\alpha}$，则它是不合規的：\n\n$$\\hat{I}(F;G) > \\tau_{\\alpha} \\quad \\text{其中} \\quad \\tau_{\\alpha} = \\frac{q_{1-\\alpha}(d)}{2n}$$\n\n当 $d=0$ 时会出现一种特殊情况。这发生在 $|\\mathcal{F}|=1$ 或 $|\\mathcal{G}|=1$ 时，即其中一个变量是常数。常数特征不能携带任何关于另一个变量的信息，因此 $\\hat{I}(F;G)$ 必然为 $0$。在这种情况下，该特征被自动视为合规。\n\n**2. 算法步骤**\n\n对每个测试用例中的每个特征，执行以下算法：\n\n1.  构建特征 $F^{(j)}$ 和遗传变量 $G$ 的观测联合计数列联表。\n2.  从表中根据其维度确定类别数 $|\\mathcal{F}|$ 和 $|\\mathcal{G}|$。\n3.  计算自由度 $d = (|\\mathcal{F}|-1)(|\\mathcal{G}|-1)$。\n4.  如果 $d=0$，特征为合规。对此特征的审计结束。\n5.  如果 $d>0$，则继续。通过对表中所有计数求和来计算总样本量 $n$。\n6.  从列联表计算经验互信息 $\\hat{I}(F;G)$。计算必须处理计数为 $0$ 的情况，因为相应的项 $p\\log(p/p_1p_2)$ 为 $0$。\n7.  使用给定的显著性水平 $\\alpha$，从自由度为 $d$ 的 $\\chi^2$ 分布中找到临界值 $q_{1-\\alpha}(d)$。\n8.  计算合规性阈值 $\\tau_{\\alpha} = q_{1-\\alpha}(d) / (2n)$。\n9.  将经验 MI 与阈值进行比较。如果 $\\hat{I}(F;G) > \\tau_{\\alpha}$，则该特征被分类为不合规。否则，它是合规的。\n10. 每个测试用例的最终结果是其不合规特征的总数。\n\n此过程严格地实现了指定的 GINA 合规性审计，将信息论和假设检验的原理转化为一个具体的决策算法。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2\n\ndef solve():\n    \"\"\"\n    Constructs and implements a principled auditing framework for a predictive \n    diagnostic model based on the Genetic Information Nondiscrimination Act (GINA).\n    \"\"\"\n\n    def calculate_mi(contingency_table: np.ndarray) -> float:\n        \"\"\"\n        Calculates the empirical mutual information from a contingency table of counts.\n\n        Args:\n            contingency_table: A 2D numpy array of joint counts.\n\n        Returns:\n            The mutual information in nats.\n        \"\"\"\n        total_n = np.sum(contingency_table)\n        if total_n == 0:\n            return 0.0\n\n        joint_pmf = contingency_table / total_n\n        \n        # Calculate marginal probabilities\n        p_F = np.sum(joint_pmf, axis=1, keepdims=True)\n        p_G = np.sum(joint_pmf, axis=0, keepdims=True)\n\n        # To avoid division by zero or log(0), we only compute over non-zero joint probabilities.\n        # Where joint_pmf is 0, the term in the sum is 0, so we can ignore it.\n        non_zero_indices = joint_pmf > 0\n        \n        p = joint_pmf[non_zero_indices]\n        p_outer_product = (p_F @ p_G)[non_zero_indices]\n\n        # Mutual information I(F;G) = D_KL(P(F,G) || P(F)P(G))\n        mi = np.sum(p * np.log(p / p_outer_product))\n        \n        return mi\n\n    def audit_feature(feature_data, alpha: float) -> bool:\n        \"\"\"\n        Audits a single feature for compliance.\n\n        Args:\n            feature_data: A 2D list/numpy array representing the contingency table, \n                          or the string 'constant'.\n            alpha: The significance level for the test.\n\n        Returns:\n            True if the feature is non-compliant, False otherwise.\n        \"\"\"\n        # A constant feature is always compliant.\n        if isinstance(feature_data, str) and feature_data == 'constant':\n            return False\n\n        contingency_table = np.array(feature_data, dtype=float)\n        \n        num_f, num_g = contingency_table.shape\n        d = (num_f - 1) * (num_g - 1)\n\n        # If degrees of freedom is 0, the feature is compliant.\n        if d == 0:\n            return False\n            \n        n = np.sum(contingency_table)\n\n        # Compute empirical mutual information\n        mi_hat = calculate_mi(contingency_table)\n\n        # Compute the threshold tau_alpha\n        chi2_critical_value = chi2.ppf(1 - alpha, d)\n        tau_alpha = chi2_critical_value / (2 * n)\n        \n        # A feature is non-compliant if its empirical MI exceeds the threshold.\n        is_non_compliant = mi_hat > tau_alpha\n        \n        return is_non_compliant\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"alpha\": 0.05,\n            \"features\": [\n                [[30, 30], [30, 30]],\n                'constant',\n                [[20, 20], [20, 20], [20, 20]],\n            ]\n        },\n        {\n            \"alpha\": 0.01,\n            \"features\": [\n                [[50, 0], [0, 50]],\n                [[45, 5], [5, 45]],\n                [[25, 25], [25, 25]],\n            ]\n        },\n        {\n            \"alpha\": 0.05,\n            \"features\": [\n                [[15, 11], [10, 14]],\n                [[13, 12], [12, 13]],\n                'constant',\n            ]\n        },\n        {\n            \"alpha\": 0.05,\n            \"features\": [\n                [[30, 30, 0], [0, 0, 30]],\n                [[10, 10, 10], [10, 10, 10], [10, 10, 10]],\n                'constant',\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha = case[\"alpha\"]\n        features = case[\"features\"]\n        non_compliant_count = 0\n        for feature_data in features:\n            if audit_feature(feature_data, alpha):\n                non_compliant_count += 1\n        results.append(non_compliant_count)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}