{
    "hands_on_practices": [
        {
            "introduction": "新一代测序（NGS）数据的质量是所有下游分析的基石。为了量化测序仪在识别每个碱基时的置信度，生物信息学领域采用菲莱德（Phred）质量分数作为通用标准。这个练习将帮助你掌握碱基检出错误概率与其对应的 $Q$ 分数之间的对数关系，这是解读原始测序数据和评估数据质量的一项基本技能 。",
            "id": "2045406",
            "problem": "一名合成生物学实验室的学生正在分析来自下一代测序（NGS）运行的数据。该实验的目的是验证一个为人工代谢途径设计的新合成基因的序列。测序仪器报告了与每个核苷酸读段相关的碱基检出错误概率。对于一个特定的目标区域，原始数据显示平均错误率为每测序500个碱基中出现1个不正确的碱基检出。\n\n为了量化这一质量，生物信息学工具使用 Phred 质量分数，记作 $Q$。该分数由以下公式定义：\n$$Q = -10 \\log_{10}(P_e)$$\n其中 $P_e$ 是碱基检出错误的概率。\n\n计算该区域对应的 Phred 质量分数。请将您的答案以四舍五入到最接近的整数形式给出。",
            "solution": "平均错误率为每500个碱基中有1个不正确的碱基检出，这意味着每个碱基的错误概率为\n$$\nP_{e}=\\frac{1}{500}.\n$$\nPhred 质量分数的定义为\n$$\nQ=-10\\log_{10}(P_{e}).\n$$\n代入 $P_{e}=\\frac{1}{500}$，\n$$\nQ=-10\\log_{10}\\!\\left(\\frac{1}{500}\\right)=10\\log_{10}(500).\n$$\n将 $500$ 重写为 $5\\times 10^{2}$ 以使用对数性质：\n$$\n\\log_{10}(500)=\\log_{10}(5\\times 10^{2})=\\log_{10}5+\\log_{10}(10^{2})=\\log_{10}5+2.\n$$\n因此，\n$$\nQ=10\\bigl(\\log_{10}5+2\\bigr)=10\\log_{10}5+20.\n$$\n使用标准近似值 $\\log_{10}2\\approx 0.3010$，我们有 $\\log_{10}5=\\log_{10}\\!\\left(\\frac{10}{2}\\right)=1-\\log_{10}2\\approx 0.6990$。所以，\n$$\nQ\\approx 10(0.6990)+20=26.99,\n$$\n四舍五入到最接近的整数为 $27$。",
            "answer": "$$\\boxed{27}$$"
        },
        {
            "introduction": "在评估测序质量之后，下一个关键问题是测序数量。测序覆盖深度是衡量实验是否成功捕获目标基因组区域的关键指标，但随机测序过程决定了读段（reads）的分布并非完全均匀。本练习通过一个理想化的泊松分布模型，让你能够估算基因组中可能因随机性而未被测序覆盖的区域比例，从而培养你在规划测序实验时对覆盖深度需求的直觉理解 。",
            "id": "2045416",
            "problem": "一个合成生物学研究团队正在验证一个定制构建的细菌人工染色体（BAC）的序列。他们进行了一项新一代测序（NGS）实验，并获得了一组短DNA读段。他们的实验关键参数如下：\n\n- BAC基因组的总长度 $L$ 为200千碱基对（kbp）。\n- 生成的读段总数 $N$ 为9,200。\n- 每个读段的平均长度 $R$ 为100碱基对（bp）。\n\n假设读段在整个BAC基因组上随机且均匀分布，那么某个特定碱基被恰好 $k$ 个读段覆盖的概率 $P(k)$ 可以用泊松分布来建模：$P(k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$，其中 $\\lambda$ 是整个基因组的平均覆盖深度。\n\n根据这些信息，计算BAC基因组中期望覆盖度为零（即未被测序）的理论比例。将您的答案以小数形式表示，并四舍五入到三位有效数字。",
            "solution": "我们使用均值（平均深度）为 $\\lambda$ 的泊松分布来为每个碱基的覆盖度建模。在读段随机、均匀分布的情况下，平均深度等于测序的总碱基数除以基因组长度：\n$$\n\\lambda = \\frac{N R}{L}.\n$$\n当 $N=9200$，$R=100$ bp，以及 $L=200\\,\\text{kbp}=200000$ bp 时，\n$$\n\\lambda = \\frac{9200 \\cdot 100}{200000} = \\frac{920000}{200000} = 4.6.\n$$\n对于泊松模型，一个碱基覆盖度为零的概率是\n$$\nP(0) = \\exp(-\\lambda) = \\exp(-4.6).\n$$\n数值计算结果为：\n$$\n\\exp(-4.6) \\approx 0.0100518 \\approx 0.0101 \\text{（三位有效数字）}.\n$$\n因此，BAC基因组中期望覆盖度为零的理论比例是 $0.0101$。",
            "answer": "$$\\boxed{0.0101}$$"
        },
        {
            "introduction": "从理想化的模型转向真实世界中高通量实验的复杂性，尤其是在精准医疗的临床应用中，挑战也随之升级。样本混合测序（multiplexing）虽然极大地提高了效率，但也引入了新的技术风险，例如索引跳跃（index hopping）和交叉污染（carryover contamination），这些问题可能导致错误的诊断结果。这个高级案例分析将挑战你像一位基因组侦探一样，利用实验证据区分不同来源的污染，这项技能对于保障基因组诊断的准确性至关重要 。",
            "id": "4353892",
            "problem": "在一个用于精准肿瘤学的多重下一代测序（NGS）工作流程中，您被要求调查在不应包含某些变异的样本中出现的意外低水平变异信号。该设施使用带有排他性扩增（exclusion amplification）的图案化流通池（patterned flow cell），并通过合成法测序（sequencing-by-synthesis）及使用索引读数（index reads）进行样本解复用（demultiplexing）。多重化依赖于在文库制备过程中连接的合成索引寡核苷酸；每个文库被分配一个或多个索引序列，在解复用过程中通过精确或近乎精确的索引匹配来进行读数分配。从第一性原理出发，请注意，多重NGS中的样本身份取决于测序片段与其预定索引序列的准确关联，而这种关联中的错误可能源于测序前分子的混合，也可能源于簇生成或仪器操作过程中的错误分配过程。请考虑以下对照研究。\n\n一个包含肿瘤和匹配正常样本文库的队列在同一台仪器上进行了 $R=3$ 次测序运行。运行 $1$ 使用单索引（single indexing），运行 $2$ 使用唯一双索引（Unique Dual Indexing, UDI），运行 $3$ 使用UDI，但在一次简化的仪器清洗后进行。每次运行有 $L=4$ 个泳道（lane）。文库以等摩尔比混合，并掺入 $1$ 个PhiX（Population Reference In Error）对照用于校准。为简单起见，假设泳道上样是平衡的，即在某些泳道中存在样本 $B$，而在其他泳道中不存在样本 $B$。变异 $V_{B}$ 是一个仅存在于样本 $B$ 中的私有单核苷酸变异（SNV），在生物学水平上，其在样本 $B$ 中的真实克隆分数为 $100\\%$，在所有其他样本中为 $0\\%$。观察结果如下：\n\n- 在运行 $1$（单索引）中，当样本 $A$ 和 $B$ 共同加载到同一泳道时，样本 $A$ 中携带 $V_{B}$ 的读数比例为 $f_{1} \\approx 0.006$，但当泳道中不存在样本 $B$ 时，$f_{1} \\approx 0.000$。在同一次运行的不同泳道中，$f_{1}$ 仅在包含样本 $B$ 的泳道中为非零值。\n- 在运行 $2$（UDI）中，采用相同的混合设计，在包含样本 $B$ 的泳道中，样本 $A$ 中携带 $V_{B}$ 的读数比例为 $f_{2} \\approx 0.0002$，而在不含样本 $B$ 的泳道中，$f_{2} \\approx 0.000$。\n- 在运行 $3$（UDI，简化清洗）中，样本 $C$——该样本仅存在于运行 $2$ 中——产生了带有其独特索引对和多个私有变异的读数，这些读数出现在所有泳道中，尽管样本 $C$ 并未在运行 $3$ 中加载。在运行 $3$ 的每个泳道中，该比例约为 $f_{3} \\approx 0.0005$，且与这些泳道中存在哪些样本无关。\n- 另外，一个特定的文库 $D$（用新的索引寡核苷酸从同一样本独立制备了两次）在运行 $2$ 和运行 $3$ 中，在不同的仪器和泳道上，均显示变异 $V_{X}$ 的比例为 $f_{4} \\approx 0.05$，且不依赖于共同加载了哪些其他样本。\n\n假设在图案化流通池聚类过程中，由于游离接头（free adapters）的存在，一个索引在泳道内被重新分配的概率为 $p$，并且在UDI中，两个索引读数在独立性假设下共同产生一个分配给错误样本的有效索引对的概率约与 $p^{2}$ 成比例，而索引上游分子的物理混合则会导致一个在不同仪器和运行中持续存在的真实混合比例。利用这些前提和上述观察结果，选择能够正确定义这些现象并区分本研究中泳道内索引跳跃（index hopping）和跨运行残留污染（cross-run carryover contamination）的陈述。\n\nA. 仅在包含样本 $B$ 的泳道中出现非零的 $f_{1}$，以及通过使用唯一双索引（UDI）使其显著降低至 $f_{2}$，是泳道内索引跳跃（index hopping）导致的索引串扰（index cross-talk）的典型特征；缓解措施包括降低游离接头浓度和使用UDI，并且该效应不应出现在不含样本 $B$ 的泳道中。\n\nB. 尽管样本 $C$ 未在运行 $3$ 中加载，但其读数在运行 $3$ 的所有泳道中以大致均匀的比例 $f_{3}$ 出现，这是跨运行残留污染（仪器记忆效应）的典型特征，其与泳道内索引跳跃的区别在于跨运行的持续性和对泳道共载样本的独立性；缓解措施包括彻底的仪器清洗程序和更换流路系统。\n\nC. 在不同运行、泳道和仪器上，文库 $D$ 中变异 $V_{X}$ 持续存在的 $f_{4} \\approx 0.05$ 信号表明存在索引上游的样本污染（真实分子混合物），这无法通过改变索引设计或仪器清洗来解决；缓解措施需要重新提取样本并采取更严格的PCR前洁净室操作规范。\n\nD. 运行 $1$ 的模式更符合合成法测序过程中的相位超前（phasing）和相位滞后（pre-phasing）导致的碱基检出（base-calling）错误，因为此类错误会选择性地将来自特定共载样本的私有变异注入到同一泳道内的另一个样本中；缓解措施是增加针对特定测序循环的相位校正，而不是改变索引策略。\n\nE. 运行 $2$ 中 $f_{2}$ 的降低证明了UDI消除了跨运行残留污染，因此任何类似 $f_{3}$ 的信号必定完全由碱基检出错误引起；因此，增强的计算解复用足以在不进行仪器清洗的情况下防止此类污染。\n\n选择所有适用的选项。",
            "solution": "问题陈述在科学上是合理的、定义明确且客观的。所有提供的信息都是一致的，并描述了一个用于排查下一代测序（NGS）中常见污染源的真实实验设计。所述现象——索引跳跃、跨运行残留污染和分析前样本污染——在基因组学领域都是有据可查的问题。给出的数值是合理的，关于缓解策略的前提也是正确的。我将继续进行解答。\n\n该问题要求分析四个不同的观察结果（$f_1$, $f_2$, $f_3$, $f_4$），以确定多重NGS研究中异常变异信号的根本原因。所提供的第一性原理允许根据不同错误来源的特征信号来区分它们。\n\n**观察结果分析**\n\n1.  **$f_1$ 和 $f_2$ 的观察结果（泳道内索引跳跃）：**\n    - 在运行 $1$ 中，使用单索引（SI），来自样本 $A$ 的读数显示出私有变异 $V_B$ 的比例为 $f_1 \\approx 0.006$。关键在于，这只发生在样本 $B$ 被物理上共同加载的泳道中。这种对泳道级别共存的强烈依赖性指向一个在测序过程中发生在*泳道内部*的机制。\n    - 在运行 $2$ 中，切换到唯一双索引（UDI）将此错误分配比例显著降低至 $f_2 \\approx 0.0002$。问题陈述指出，使用SI时索引错误分配的概率为 $p$，而在UDI下此概率约与 $p^2$ 成比例。观测到的从 $f_1 \\approx 0.006$ 到 $f_2 \\approx 0.0002$ 的降低与此模型一致（例如，如果 $p \\approx 0.006$，则 $p^2 \\approx 3.6 \\times 10^{-5}$；观测到的 $f_2$ 处于预期的数量级）。\n    - 这种现象被称为**索引跳跃（index hopping）**或索引串扰（index cross-talk）。在采用排他性扩增的图案化流通池上，一种被提出的机制是，来自一个文库的游离索引接头可以为一个来自另一个文库的片段引发扩增，从而产生一个带有错误索引的嵌合分子。由于这发生在流通池上，因此是泳道特异性的。UDI是一种强有力的缓解措施，因为要使一个来自样本 $B$ 的读数被错误地分配给样本 $A$，其*两个*索引都必须被交换以形成一个有效的、不同的索引对（即样本 $A$ 的索引对），这是一个罕见得多的事件。\n\n2.  **$f_3$ 的观察结果（跨运行残留污染）：**\n    - 在运行 $3$ 中，尽管样本 $C$ 根本没有在运行 $3$ 中加载，但在*所有泳道*中都检测到了对应于样本 $C$ 的读数，比例为 $f_3 \\approx 0.0005$。\n    - 其关键特征是：（a）污染源来自*上一次运行*（运行 $2$），以及（b）污染散布在当前运行的*所有泳道*中，与每个泳道内的样本组成无关。\n    - 这一特征与索引跳跃不符，因为索引跳跃是泳道特异性的，并且需要共同加载。这是**跨运行残留污染**的决定性特征，通常被称为“仪器记忆效应”。来自上一次运行的残留文库分子留在仪器的流路系统（例如，管路、阀门）中，并在后续运行的上样过程中被冲洗到流通池上。问题明确指出，运行 $3$ 之前进行了一次“简化的仪器清洗”，这是未能清除系统的直接原因。样本 $C$ 文库分子上的UDI保持完整，使其能够被正确识别为属于 $C$，从而揭示了物理污染事件。\n\n3.  **$f_4$ 的观察结果（分析前污染）：**\n    - 文库 $D$ 持续显示变异 $V_X$ 的比例相对较高，为 $f_4 \\approx 0.05$。\n    - 该信号独立于测序运行、仪器、泳道或共同加载的样本。在从同一来源生物样本进行的独立文库制备中也观察到了这一点。\n    - 这些特征排除了索引跳跃（其依赖于泳道和共载样本）和跨运行残留（其依赖于运行和仪器）。信号在独立文库制备和不同仪器间的持续存在表明，污染是源材料本身的属性。这是一种**真实的分子混合物**，它发生在所述的任何测序工作流程步骤之前，很可能是在样本收集、处理或核酸提取过程中发生的。这是分析前或样本间的污染。$5\\%$的比例也显著高于索引跳跃或残留污染的典型比率。\n\n**选项评估**\n\n**A. 仅在包含样本 $B$ 的泳道中出现非零的 $f_{1}$，以及通过使用唯一双索引（UDI）使其显著降低至 $f_{2}$，是泳道内索引跳跃（index hopping）导致的索引串扰（index cross-talk）的典型特征；缓解措施包括降低游离接头浓度和使用UDI，并且该效应不应出现在不含样本 $B$ 的泳道中。**\n该陈述准确总结了对 $f_{1}$ 和 $f_{2}$ 的分析。对共载的依赖性指向一个泳道内现象。使用UDI带来的显著降低是缓解索引跳跃的预期行为。列出的缓解策略是正确的。该效应在源样本不存在于泳道中时消失的条件是一个决定性特征，并且已被观察到。\n**结论：正确**\n\n**B. 尽管样本 $C$ 未在运行 $3$ 中加载，但其读数在运行 $3$ 的所有泳道中以大致均匀的比例 $f_{3}$ 出现，这是跨运行残留污染（仪器记忆效应）的典型特征，其与泳道内索引跳跃的区别在于跨运行的持续性和对泳道共载样本的独立性；缓解措施包括彻底的仪器清洗程序和更换流路系统。**\n该陈述准确描述了为 $f_{3}$ 观察到的现象。污染源是上一次运行，其信号在当前运行中与泳道组成无关，这清楚地将其与索引跳跃区分开来。原因（残留污染）和缓解措施（彻底清洗）都被正确识别。\n**结论：正确**\n\n**C. 在不同运行、泳道和仪器上，文库 $D$ 中变异 $V_{X}$ 持续存在的 $f_{4} \\approx 0.05$ 信号表明存在索引上游的样本污染（真实分子混合物），这无法通过改变索引设计或仪器清洗来解决；缓解措施需要重新提取样本并采取更严格的PCR前洁净室操作规范。**\n该陈述正确解释了 $f_{4}$ 的证据。高比例（$\\approx 5\\%$）及其与所有测序相关变量（运行、泳道、仪器、共载样本）的独立性，指向一个在文库创建之前发生的污染事件。这种分析前污染无法通过下游方法（如UDI或仪器清洗）来解决；它需要解决上游的实验室工作流程问题。\n**结论：正确**\n\n**D. 运行 $1$ 的模式更符合合成法测序过程中的相位超前（phasing）和相位滞后（pre-phasing）导致的碱基检出（base-calling）错误，因为此类错误会选择性地将来自特定共载样本的私有变异注入到同一泳道内的另一个样本中；缓解措施是增加针对特定测序循环的相位校正，而不是改变索引策略。**\n这是一个不正确的解释。相位超前和相位滞后影响给定簇在后续测序循环中的信号，主要是在读数的后期涂抹碱基检出结果。它们通常不会导致一个读数的身份从一个样本完全错误地分配到另一个样本，因为身份是由单独的索引读数决定的。最重要的是，这一假设被观察到的事实所证伪：切换到UDI（一种索引策略的改变）显著缓解了该问题。如果相位问题是根本原因，索引策略的改变几乎不会有任何效果。\n**结论：不正确**\n\n**E. 运行 $2$ 中 $f_{2}$ 的降低证明了UDI消除了跨运行残留污染，因此任何类似 $f_{3}$ 的信号必定完全由碱基检出错误引起；因此，增强的计算解复用足以在不进行仪器清洗的情况下防止此类污染。**\n这个陈述建立在一系列逻辑错误之上。首先，$f_{2}$ 的降低证明了UDI对*泳道内索引跳跃*的有效性，而不是*跨运行残留污染*。这是两种不同的物理现象。其次，得出 $f_3$ 必定由碱基检出错误引起的结论是一个*不合逻辑的推论*，并且与指向残留污染的证据（来自前一次运行的污染源，简化的清洗）相矛盾。第三，残留污染涉及前一次运行分子的物理存在；任何计算解复用都无法抹去它们。解复用将正确地识别它们，从而揭示污染，而不是防止污染。这个问题是物理性的，需要物理性的解决方案（清洗）。\n**结论：不正确**",
            "answer": "$$\\boxed{ABC}$$"
        }
    ]
}