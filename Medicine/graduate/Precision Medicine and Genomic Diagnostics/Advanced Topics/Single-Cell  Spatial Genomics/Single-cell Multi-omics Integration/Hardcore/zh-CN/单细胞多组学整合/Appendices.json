{
    "hands_on_practices": [
        {
            "introduction": "任何单细胞分析的关键第一步都是数据标准化。由于测序深度等技术因素，原始的分子计数值在细胞间存在高度变异，这使得直接比较细胞具有误导性。本练习  将引导你完成对scRNA-seq数据进行对数归一化的基本过程，这是一个稳定方差并将数据准备好以进行有意义的下游整合分析的标准流程。",
            "id": "4607704",
            "problem": "一项临床研究旨在整合单细胞RNA测序（scRNA-seq）和单细胞转座酶可及性染色质测序（scATAC-seq）的数据，以发现在异质性肿瘤微环境中与治疗反应相关的基因调控程序。为构建一个联合潜空间，scRNA-seq模态必须首先被转换到一个稳定的、相对丰度的尺度，该尺度在不同测序深度的细胞间具有可比性。在scRNA-seq中，细胞 $i$ 中基因 $g$ 的独特分子标识（UMI）计数 $c_{ig}$ 与捕获的转录本分子数量成正比，而总和 $\\sum_{g} c_{ig}$ 则反映了细胞 $i$ 的文库大小。\n\n从以下基于单细胞转录本定量标准实践的、经过充分测试的处理步骤开始：\n- 通过将一个基因的原始计数除以细胞的总UMI计数来获得相对丰度，得到分数 $c_{ig} / \\sum_{g} c_{ig}$。\n- 为了使尺度具有可解释性，并减轻单细胞数据中典型的极端稀疏性，同时保持细胞间的可比性，将此分数乘以 $10^{4}$，重新缩放至“每 $10^{4}$ 个计数”。\n- 为了稳定方差并减弱高表达基因的影响，对重新缩放后的量应用以2为底的对数，在取对数前加上一个伪计数1，以避免对零取对数。\n\n使用这些定义，推导对数归一化表达量 $\\tilde{x}_{ig}$ 的符号表达式，然后计算当一个特定基因的原始UMI计数为 $c_{ig} = 50$、细胞总UMI计数为 $\\sum_{g} c_{ig} = 5000$ 时的值。将你的最终答案表示为一个无量纲值，并四舍五入到四位有效数字。",
            "solution": "问题陈述是生物信息学和计算生物学领域内一个有效且定义明确的请求。它描述了单细胞RNA测序（scRNA-seq）数据归一化的标准流程，这是多组学整合等下游分析的关键预处理步骤。所有提供的信息在科学上都是合理的、自洽的，并且足以推导出唯一的解。\n\n任务是首先推导出细胞 $i$ 中基因 $g$ 的对数归一化表达量（表示为 $\\tilde{x}_{ig}$）的符号表达式，然后根据给定的UMI计数计算其数值。我们将遵循规定的操作顺序。\n\n设 $c_{ig}$ 为细胞 $i$ 中基因 $g$ 的原始独特分子标识（UMI）计数。\n设 $C_i = \\sum_{g} c_{ig}$ 为细胞 $i$ 的总UMI计数，也称为细胞的文库大小。\n\n归一化过程包括三个定义的步骤：\n\n步骤1：计算细胞中该基因转录本的相对丰度。这通过将该基因的原始计数除以细胞的总UMI计数来实现。\n$$ \\text{相对丰度} = \\frac{c_{ig}}{C_i} = \\frac{c_{ig}}{\\sum_{g} c_{ig}} $$\n\n步骤2：将相对丰度重新缩放到一个通用尺度，通常是“每10,000个计数”（CP10k）或“每10,000个转录本”（TP10k），以方便在不同文库大小的细胞间进行比较。这通过将相对丰度乘以一个缩放因子 $10^4$ 来完成。\n$$ \\text{重新缩放后的值} = \\left( \\frac{c_{ig}}{\\sum_{g} c_{ig}} \\right) \\times 10^4 $$\n\n步骤3：对重新缩放后的值进行对数转换。这种转换有助于稳定不同表达水平基因的方差，并减少数据分布的偏度。在取对数之前加上一个伪计数1，以确保对数的参数始终为正，从而避免处理计数为零的基因时出现问题。对数的底数指定为2。\n因此，对数归一化表达量 $\\tilde{x}_{ig}$ 为：\n$$ \\tilde{x}_{ig} = \\log_{2}\\left( \\left( \\frac{c_{ig}}{\\sum_{g} c_{ig}} \\right) \\times 10^4 + 1 \\right) $$\n这就是所要求的符号表达式。\n\n现在，我们将为给定的数据计算 $\\tilde{x}_{ig}$ 的值：\n- 目标基因的原始UMI计数：$c_{ig} = 50$\n- 细胞的总UMI计数：$\\sum_{g} c_{ig} = 5000$\n\n将这些值代入符号表达式中：\n$$ \\tilde{x}_{ig} = \\log_{2}\\left( \\left( \\frac{50}{5000} \\right) \\times 10^4 + 1 \\right) $$\n\n首先，我们计算分数：\n$$ \\frac{50}{5000} = \\frac{5}{500} = \\frac{1}{100} = 0.01 $$\n\n接下来，我们进行重新缩放：\n$$ 0.01 \\times 10^4 = 0.01 \\times 10000 = 100 $$\n\n然后，我们加上伪计数1：\n$$ 100 + 1 = 101 $$\n\n最后，我们取以2为底的对数：\n$$ \\tilde{x}_{ig} = \\log_{2}(101) $$\n\n为了计算数值，我们可以使用对数的换底公式，$\\log_{b}(a) = \\frac{\\ln(a)}{\\ln(b)}$：\n$$ \\tilde{x}_{ig} = \\frac{\\ln(101)}{\\ln(2)} $$\n\n使用自然对数的标准值：\n$$ \\ln(101) \\approx 4.6151205168 $$\n$$ \\ln(2) \\approx 0.6931471806 $$\n\n$$ \\tilde{x}_{ig} \\approx \\frac{4.6151205168}{0.6931471806} \\approx 6.6582115934 $$\n\n题目要求答案四舍五入到四位有效数字。前四位有效数字是 $6$、$6$、$5$ 和 $8$。第五位有效数字是 $2$，小于 $5$，所以我们向下舍入（即，我们不改变最后一位数字）。\n\n因此，对数归一化表达量的值约为 $6.658$。这个值是无量纲的，因为初始分数中分子和分母的计数单位相互抵消了。",
            "answer": "$$\n\\boxed{6.658}\n$$"
        },
        {
            "introduction": "在对单个模态进行标准化之后，一个核心挑战是如何将它们组合成一个统一的细胞身份表征。加权最近邻（WNN）算法通过构建一个联合的细胞间相似性图谱，为此提供了一个优雅的解决方案。在此实践中 ，你将亲手实现WNN的逻辑，计算特定模态的权重并构建一个整合的邻居图，这是进行可视化和聚类的基础步骤。",
            "id": "4607733",
            "problem": "考虑五个单细胞，标记为 $C_{1}, C_{2}, C_{3}, C_{4}, C_{5}$。对于每对细胞，给定它们在核糖核酸（RNA）空间和转座酶可及染色质测序（ATAC-seq）空间中，经过标准归一化后测得的模态特异性相异度（以欧几里得距离衡量）。目标是使用加权最近邻（WNN）整合方法，为 $k=2$ 构建一个融合有向 $k$-近邻（kNN）图。\n\n基本原理：\n- 度量空间上的 $k$-近邻图为每个查询点分配在指定的查询-候选距离下，距离最小的 $k$ 个邻居点。\n- 加权最近邻整合为每个查询细胞定义一个整合的查询-候选相异度，该相异度是模态特异性相异度的凸组合，其中模态权重反映了查询细胞的模态特异性信号强度。权重是通过对提供的每个细胞的信噪比值进行归一化来确定的，以使它们为非负且对每个查询细胞的总和为 $1$。\n\n**数据**：\n- **成对 RNA 距离** $d_{\\mathrm{RNA}}(C_{i}, C_{j})$:\n  - $d_{\\mathrm{RNA}}(C_{1}, C_{2}) = 1.2$, $d_{\\mathrm{RNA}}(C_{1}, C_{3}) = 3.5$, $d_{\\mathrm{RNA}}(C_{1}, C_{4}) = 2.0$, $d_{\\mathrm{RNA}}(C_{1}, C_{5}) = 3.0$\n  - $d_{\\mathrm{RNA}}(C_{2}, C_{3}) = 2.8$, $d_{\\mathrm{RNA}}(C_{2}, C_{4}) = 1.5$, $d_{\\mathrm{RNA}}(C_{2}, C_{5}) = 2.7$\n  - $d_{\\mathrm{RNA}}(C_{3}, C_{4}) = 3.2$, $d_{\\mathrm{RNA}}(C_{3}, C_{5}) = 1.1$\n  - $d_{\\mathrm{RNA}}(C_{4}, C_{5}) = 2.9$\n- **成对 ATAC-seq 距离** $d_{\\mathrm{ATAC}}(C_{i}, C_{j})$:\n  - $d_{\\mathrm{ATAC}}(C_{1}, C_{2}) = 2.6$, $d_{\\mathrm{ATAC}}(C_{1}, C_{3}) = 2.9$, $d_{\\mathrm{ATAC}}(C_{1}, C_{4}) = 3.4$, $d_{\\mathrm{ATAC}}(C_{1}, C_{5}) = 1.3$\n  - $d_{\\mathrm{ATAC}}(C_{2}, C_{3}) = 1.0$, $d_{\\mathrm{ATAC}}(C_{2}, C_{4}) = 2.2$, $d_{\\mathrm{ATAC}}(C_{2}, C_{5}) = 2.5$\n  - $d_{\\mathrm{ATAC}}(C_{3}, C_{4}) = 2.4$, $d_{\\mathrm{ATAC}}(C_{3}, C_{5}) = 2.0$\n  - $d_{\\mathrm{ATAC}}(C_{4}, C_{5}) = 1.7$\n- **模态特异性信号强度** $s$:\n  - RNA: $s_{\\mathrm{RNA}}(C_{1}) = 4$, $s_{\\mathrm{RNA}}(C_{2}) = 6$, $s_{\\mathrm{RNA}}(C_{3}) = 3$, $s_{\\mathrm{RNA}}(C_{4}) = 9$, $s_{\\mathrm{RNA}}(C_{5}) = 2$\n  - ATAC-seq: $s_{\\mathrm{ATAC}}(C_{1}) = 1$, $s_{\\mathrm{ATAC}}(C_{2}) = 7$, $s_{\\mathrm{ATAC}}(C_{3}) = 8$, $s_{\\mathrm{ATAC}}(C_{4}) = 3$, $s_{\\mathrm{ATAC}}(C_{5}) = 3$\n\n**任务**：\n1. 推导每个细胞的模态权重并计算整合有向相异度。\n2. 确定融合有向 $2$-NN 图。\n3. 计算相互最近邻对的总数。\n\n将相互最近邻对的总数作为你的最终答案。",
            "solution": "### 解答\n解答过程遵循问题陈述中列出的三个任务。所提供的模态特异性距离是欧几里得距离，因此是对称的：$d(C_{i}, C_{j}) = d(C_{j}, C_{i})$。\n\n**任务1：推导每个细胞的模态权重并计算整合相异度。**\n\n首先，我们计算每个细胞 $C_{i}$ 的模态权重。对于给定的细胞 $C_i$，RNA 和 ATAC-seq 模态的权重（表示为 $w_{\\mathrm{RNA}}(C_{i})$ 和 $w_{\\mathrm{ATAC}}(C_{i})$）通过对各自的信号强度 $s_{\\mathrm{RNA}}(C_{i})$ 和 $s_{\\mathrm{ATAC}}(C_{i})$进行归一化，使其总和为 $1$ 来确定。\n权重的计算公式为：\n$$w_{\\mathrm{RNA}}(C_{i}) = \\frac{s_{\\mathrm{RNA}}(C_{i})}{s_{\\mathrm{RNA}}(C_{i}) + s_{\\mathrm{ATAC}}(C_{i})}, \\quad w_{\\mathrm{ATAC}}(C_{i}) = \\frac{s_{\\mathrm{ATAC}}(C_{i})}{s_{\\mathrm{RNA}}(C_{i}) + s_{\\mathrm{ATAC}}(C_{i})}$$\n\n- 对于 $C_{1}$：$s_{\\mathrm{RNA}}(C_{1}) = 4, s_{\\mathrm{ATAC}}(C_{1}) = 1$。\n  $w_{\\mathrm{RNA}}(C_{1}) = \\frac{4}{4+1} = \\frac{4}{5}$，$w_{\\mathrm{ATAC}}(C_{1}) = \\frac{1}{4+1} = \\frac{1}{5}$。\n- 对于 $C_{2}$：$s_{\\mathrm{RNA}}(C_{2}) = 6, s_{\\mathrm{ATAC}}(C_{2}) = 7$。\n  $w_{\\mathrm{RNA}}(C_{2}) = \\frac{6}{6+7} = \\frac{6}{13}$，$w_{\\mathrm{ATAC}}(C_{2}) = \\frac{7}{6+7} = \\frac{7}{13}$。\n- 对于 $C_{3}$：$s_{\\mathrm{RNA}}(C_{3}) = 3, s_{\\mathrm{ATAC}}(C_{3}) = 8$。\n  $w_{\\mathrm{RNA}}(C_{3}) = \\frac{3}{3+8} = \\frac{3}{11}$，$w_{\\mathrm{ATAC}}(C_{3}) = \\frac{8}{3+8} = \\frac{8}{11}$。\n- 对于 $C_{4}$：$s_{\\mathrm{RNA}}(C_{4}) = 9, s_{\\mathrm{ATAC}}(C_{4}) = 3$。\n  $w_{\\mathrm{RNA}}(C_{4}) = \\frac{9}{9+3} = \\frac{9}{12} = \\frac{3}{4}$，$w_{\\mathrm{ATAC}}(C_{4}) = \\frac{3}{9+3} = \\frac{3}{12} = \\frac{1}{4}$。\n- 对于 $C_{5}$：$s_{\\mathrm{RNA}}(C_{5}) = 2, s_{\\mathrm{ATAC}}(C_{5}) = 3$。\n  $w_{\\mathrm{RNA}}(C_{5}) = \\frac{2}{2+3} = \\frac{2}{5}$，$w_{\\mathrm{ATAC}}(C_{5}) = \\frac{3}{2+3} = \\frac{3}{5}$。\n\n接下来，我们使用以下公式计算从每个查询细胞 $C_{i}$ 到每个候选细胞 $C_{j}$ ($i \\neq j$) 的整合有向相异度 $d_{\\mathrm{WNN}}(C_{i}, C_{j})$：\n$$d_{\\mathrm{WNN}}(C_{i}, C_{j}) = w_{\\mathrm{RNA}}(C_{i}) \\cdot d_{\\mathrm{RNA}}(C_{i}, C_{j}) + w_{\\mathrm{ATAC}}(C_{i}) \\cdot d_{\\mathrm{ATAC}}(C_{i}, C_{j})$$\n由于距离是对称的，$d_{\\mathrm{RNA}}(C_{i}, C_{j}) = d_{\\mathrm{RNA}}(C_{j}, C_{i})$ 且 $d_{\\mathrm{ATAC}}(C_{i}, C_{j}) = d_{\\mathrm{ATAC}}(C_{j}, C_{i})$。\n\n对每个查询细胞 $C_{i}$ 的计算：\n\n- **查询 $C_{1}$** ($w_{\\mathrm{RNA}}=\\frac{4}{5}, w_{\\mathrm{ATAC}}=\\frac{1}{5}$):\n  - $d_{\\mathrm{WNN}}(C_{1}, C_{2}) = \\frac{4}{5}(1.2) + \\frac{1}{5}(2.6) = \\frac{4.8 + 2.6}{5} = \\frac{7.4}{5} = 1.48$\n  - $d_{\\mathrm{WNN}}(C_{1}, C_{3}) = \\frac{4}{5}(3.5) + \\frac{1}{5}(2.9) = \\frac{14.0 + 2.9}{5} = \\frac{16.9}{5} = 3.38$\n  - $d_{\\mathrm{WNN}}(C_{1}, C_{4}) = \\frac{4}{5}(2.0) + \\frac{1}{5}(3.4) = \\frac{8.0 + 3.4}{5} = \\frac{11.4}{5} = 2.28$\n  - $d_{\\mathrm{WNN}}(C_{1}, C_{5}) = \\frac{4}{5}(3.0) + \\frac{1}{5}(1.3) = \\frac{12.0 + 1.3}{5} = \\frac{13.3}{5} = 2.66$\n\n- **查询 $C_{2}$** ($w_{\\mathrm{RNA}}=\\frac{6}{13}, w_{\\mathrm{ATAC}}=\\frac{7}{13}$):\n  - $d_{\\mathrm{WNN}}(C_{2}, C_{1}) = \\frac{6}{13}(1.2) + \\frac{7}{13}(2.6) = \\frac{7.2 + 18.2}{13} = \\frac{25.4}{13}$\n  - $d_{\\mathrm{WNN}}(C_{2}, C_{3}) = \\frac{6}{13}(2.8) + \\frac{7}{13}(1.0) = \\frac{16.8 + 7.0}{13} = \\frac{23.8}{13}$\n  - $d_{\\mathrm{WNN}}(C_{2}, C_{4}) = \\frac{6}{13}(1.5) + \\frac{7}{13}(2.2) = \\frac{9.0 + 15.4}{13} = \\frac{24.4}{13}$\n  - $d_{\\mathrm{WNN}}(C_{2}, C_{5}) = \\frac{6}{13}(2.7) + \\frac{7}{13}(2.5) = \\frac{16.2 + 17.5}{13} = \\frac{33.7}{13}$\n\n- **查询 $C_{3}$** ($w_{\\mathrm{RNA}}=\\frac{3}{11}, w_{\\mathrm{ATAC}}=\\frac{8}{11}$):\n  - $d_{\\mathrm{WNN}}(C_{3}, C_{1}) = \\frac{3}{11}(3.5) + \\frac{8}{11}(2.9) = \\frac{10.5 + 23.2}{11} = \\frac{33.7}{11}$\n  - $d_{\\mathrm{WNN}}(C_{3}, C_{2}) = \\frac{3}{11}(2.8) + \\frac{8}{11}(1.0) = \\frac{8.4 + 8.0}{11} = \\frac{16.4}{11}$\n  - $d_{\\mathrm{WNN}}(C_{3}, C_{4}) = \\frac{3}{11}(3.2) + \\frac{8}{11}(2.4) = \\frac{9.6 + 19.2}{11} = \\frac{28.8}{11}$\n  - $d_{\\mathrm{WNN}}(C_{3}, C_{5}) = \\frac{3}{11}(1.1) + \\frac{8}{11}(2.0) = \\frac{3.3 + 16.0}{11} = \\frac{19.3}{11}$\n\n- **查询 $C_{4}$** ($w_{\\mathrm{RNA}}=\\frac{3}{4}, w_{\\mathrm{ATAC}}=\\frac{1}{4}$):\n  - $d_{\\mathrm{WNN}}(C_{4}, C_{1}) = \\frac{3}{4}(2.0) + \\frac{1}{4}(3.4) = \\frac{6.0 + 3.4}{4} = \\frac{9.4}{4} = 2.35$\n  - $d_{\\mathrm{WNN}}(C_{4}, C_{2}) = \\frac{3}{4}(1.5) + \\frac{1}{4}(2.2) = \\frac{4.5 + 2.2}{4} = \\frac{6.7}{4} = 1.675$\n  - $d_{\\mathrm{WNN}}(C_{4}, C_{3}) = \\frac{3}{4}(3.2) + \\frac{1}{4}(2.4) = \\frac{9.6 + 2.4}{4} = \\frac{12.0}{4} = 3.0$\n  - $d_{\\mathrm{WNN}}(C_{4}, C_{5}) = \\frac{3}{4}(2.9) + \\frac{1}{4}(1.7) = \\frac{8.7 + 1.7}{4} = \\frac{10.4}{4} = 2.6$\n\n- **查询 $C_{5}$** ($w_{\\mathrm{RNA}}=\\frac{2}{5}, w_{\\mathrm{ATAC}}=\\frac{3}{5}$):\n  - $d_{\\mathrm{WNN}}(C_{5}, C_{1}) = \\frac{2}{5}(3.0) + \\frac{3}{5}(1.3) = \\frac{6.0 + 3.9}{5} = \\frac{9.9}{5} = 1.98$\n  - $d_{\\mathrm{WNN}}(C_{5}, C_{2}) = \\frac{2}{5}(2.7) + \\frac{3}{5}(2.5) = \\frac{5.4 + 7.5}{5} = \\frac{12.9}{5} = 2.58$\n  - $d_{\\mathrm{WNN}}(C_{5}, C_{3}) = \\frac{2}{5}(1.1) + \\frac{3}{5}(2.0) = \\frac{2.2 + 6.0}{5} = \\frac{8.2}{5} = 1.64$\n  - $d_{\\mathrm{WNN}}(C_{5}, C_{4}) = \\frac{2}{5}(2.9) + \\frac{3}{5}(1.7) = \\frac{5.8 + 5.1}{5} = \\frac{10.9}{5} = 2.18$\n\n**任务2：确定 $k=2$ 的融合有向 $k$-近邻图。**\n\n对于每个细胞 $C_{i}$，我们找出具有最小 $d_{\\mathrm{WNN}}(C_{i}, C_{j})$ 值的两个细胞 $C_{j}$。\n\n- **$C_{1}$ 的邻居**：\n  - 距离：$d(C_{1}, C_{2})=1.48$，$d(C_{1}, C_{4})=2.28$，$d(C_{1}, C_{5})=2.66$，$d(C_{1}, C_{3})=3.38$。\n  - 两个最近的邻居是 $C_{2}$ 和 $C_{4}$。邻居集 $N(C_{1}) = \\{C_{2}, C_{4}\\}$。\n\n- **$C_{2}$ 的邻居**：\n  - 距离：$d(C_{2}, C_{3})=\\frac{23.8}{13} \\approx 1.831$，$d(C_{2}, C_{4})=\\frac{24.4}{13} \\approx 1.877$，$d(C_{2}, C_{1})=\\frac{25.4}{13} \\approx 1.954$，$d(C_{2}, C_{5})=\\frac{33.7}{13} \\approx 2.592$。\n  - 两个最近的邻居是 $C_{3}$ 和 $C_{4}$。邻居集 $N(C_{2}) = \\{C_{3}, C_{4}\\}$。\n\n- **$C_{3}$ 的邻居**：\n  - 距离：$d(C_{3}, C_{2})=\\frac{16.4}{11} \\approx 1.491$，$d(C_{3}, C_{5})=\\frac{19.3}{11} \\approx 1.755$，$d(C_{3}, C_{4})=\\frac{28.8}{11} \\approx 2.618$，$d(C_{3}, C_{1})=\\frac{33.7}{11} \\approx 3.064$。\n  - 两个最近的邻居是 $C_{2}$ 和 $C_{5}$。邻居集 $N(C_{3}) = \\{C_{2}, C_{5}\\}$。\n\n- **$C_{4}$ 的邻居**：\n  - 距离：$d(C_{4}, C_{2})=1.675$，$d(C_{4}, C_{1})=2.35$，$d(C_{4}, C_{5})=2.6$，$d(C_{4}, C_{3})=3.0$。\n  - 两个最近的邻居是 $C_{2}$ 和 $C_{1}$。邻居集 $N(C_{4}) = \\{C_{1}, C_{2}\\}$。\n\n- **$C_{5}$ 的邻居**：\n  - 距离：$d(C_{5}, C_{3})=1.64$，$d(C_{5}, C_{1})=1.98$，$d(C_{5}, C_{4})=2.18$，$d(C_{5}, C_{2})=2.58$。\n  - 两个最近的邻居是 $C_{3}$ 和 $C_{1}$。邻居集 $N(C_{5}) = \\{C_{1}, C_{3}\\}$。\n\n$2$-NN 集总结：\n- $N(C_{1}) = \\{C_{2}, C_{4}\\}$\n- $N(C_{2}) = \\{C_{3}, C_{4}\\}$\n- $N(C_{3}) = \\{C_{2}, C_{5}\\}$\n- $N(C_{4}) = \\{C_{1}, C_{2}\\}$\n- $N(C_{5}) = \\{C_{1}, C_{3}\\}$\n\n**任务3：计算相互最近邻对的总数。**\n\n如果 $C_{j}$ 在 $C_{i}$ 的 $2$-NN 集中（即 $C_{j} \\in N(C_i)$），并且 $C_{i}$ 在 $C_{j}$ 的 $2$-NN 集中（即 $C_{i} \\in N(C_j)$），则一个无序对 $\\{C_{i}, C_{j}\\}$ 是一个相互最近邻对。我们检查所有 $\\binom{5}{2}=10$ 个无序对。\n\n- $\\{C_{1}, C_{2}\\}$: $C_{2} \\in N(C_{1})$？是。$C_{1} \\in N(C_{2})$？否。不是相互对。\n- $\\{C_{1}, C_{3}\\}$: $C_{3} \\in N(C_{1})$？否。不是相互对。\n- $\\{C_{1}, C_{4}\\}$: $C_{4} \\in N(C_{1})$？是。$C_{1} \\in N(C_{4})$？是。**这是一个相互对。**\n- $\\{C_{1}, C_{5}\\}$: $C_{5} \\in N(C_{1})$？否。（尽管 $C_{1} \\in N(C_{5})$，但不是相互对）。\n- $\\{C_{2}, C_{3}\\}$: $C_{3} \\in N(C_{2})$？是。$C_{2} \\in N(C_{3})$？是。**这是一个相互对。**\n- $\\{C_{2}, C_{4}\\}$: $C_{4} \\in N(C_{2})$？是。$C_{2} \\in N(C_{4})$？是。**这是一个相互对。**\n- $\\{C_{2}, C_{5}\\}$: $C_{5} \\in N(C_{2})$？否。不是相互对。\n- $\\{C_{3}, C_{4}\\}$: $C_{4} \\in N(C_{3})$？否。不是相互对。\n- $\\{C_{3}, C_{5}\\}$: $C_{5} \\in N(C_{3})$？是。$C_{3} \\in N(C_{5})$？是。**这是一个相互对。**\n- $\\{C_{4}, C_{5}\\}$: $C_{5} \\in N(C_{4})$？否。不是相互对。\n\n相互最近邻对是 $\\{C_{1}, C_{4}\\}$、$\\{C_{2}, C_{3}\\}$、$\\{C_{2}, C_{4}\\}$ 和 $\\{C_{3}, C_{5}\\}$。\n相互最近邻对的总数是 $4$。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "除了创建统一的细胞图谱，多组学整合还使我们能够模拟不同分子层之间的调控关系，例如从基因表达到预测蛋白质丰度。本练习  应用岭回归（一种处理高维数据的强大技术）来从CITE-seq数据构建预测模型。你将拟合该模型并评估其性能，从而获得监督式整合和模型评估的实践技能。",
            "id": "4607720",
            "problem": "您正在整合单细胞多组学测量数据，使用线性模型根据信使核糖核酸（RNA）的表达来预测表面蛋白的丰度。考虑来自“通过测序进行转录组和表位的细胞索引技术”（Cellular Indexing of Transcriptomes and Epitopes by Sequencing, CITE-seq）的数据，其中RNA特征被标准化，蛋白质靶标被缩放到可比较的单位。假设以下关于蛋白质对RNA的联合线性模型成立：$y = X\\beta + \\varepsilon$，其中 $X \\in \\mathbb{R}^{n \\times p}$ 是 $n$ 个细胞和 $p$ 个基因的RNA表达特征矩阵，$y \\in \\mathbb{R}^{n}$ 是相应的蛋白质丰度，$\\beta \\in \\mathbb{R}^{p}$ 是系数，$\\varepsilon$ 是一个均值为零的噪声项。为了在共线性和高维性下防止过拟合，使用岭回归，它最小化基于 $\\beta$ 的欧几里得范数平方的惩罚最小二乘目标函数。\n\n给定一个包含 $n_{\\mathrm{train}} = 3$ 个细胞和 $p = 2$ 个RNA特征的训练集，\n$$\nX_{\\mathrm{train}} = \\begin{bmatrix}\n1  2 \\\\\n0  1 \\\\\n2  0\n\\end{bmatrix}, \\quad\ny_{\\mathrm{train}} = \\begin{bmatrix}\n3 \\\\\n1 \\\\\n4\n\\end{bmatrix},\n$$\n和一个包含 $n_{\\mathrm{test}} = 2$ 个细胞的测试集，\n$$\nX_{\\mathrm{test}} = \\begin{bmatrix}\n1  1 \\\\\n3  0\n\\end{bmatrix}, \\quad\ny_{\\mathrm{test}} = \\begin{bmatrix}\n2.0 \\\\\n5.2\n\\end{bmatrix}.\n$$\n使用岭惩罚参数 $\\lambda = 1$。\n\n任务：\n1. 从最小化带 $\\ell_{2}$ 惩罚的惩罚最小二乘目标的原理出发，推导出用 $X$、$y$ 和 $\\lambda$ 表示的 $\\beta$ 的估计量。\n2. 使用 $X_{\\mathrm{train}}$、$y_{\\mathrm{train}}$ 和 $\\lambda = 1$ 计算岭回归估计量 $\\beta$。\n3. 使用拟合的 $\\beta$ 计算测试集预测值 $\\hat{y}_{\\mathrm{test}} = X_{\\mathrm{test}}\\beta$。\n4. 使用定义为 $\\mathrm{RMSE} = \\sqrt{\\frac{1}{n_{\\mathrm{test}}}\\sum_{i=1}^{n_{\\mathrm{test}}}(y_{i} - \\hat{y}_{i})^{2}}$ 的均方根误差 (RMSE) 评估在测试集上的预测准确性。\n\n将最终的RMSE四舍五入到四位有效数字。最终答案以无单位的纯数字形式表示。",
            "solution": "该问题是有效的，因为它具有科学依据、提法得当且客观。它提供了一个应用于生物信息学的统计学习标准任务，并附有完整且一致的数据。我们将继续完成所列的四个任务。\n\n任务1：推导 $\\beta$ 的岭回归估计量。\n岭回归的目标函数 $L(\\beta)$ 是残差平方和 (RSS) 与系数向量 $\\beta$ 上的 $\\ell_2$ 惩罚项之和。RSS衡量观测值 $y$ 和预测值 $X\\beta$ 之间的平方差。惩罚项 $\\lambda \\left\\|\\beta\\right\\|_2^2$ 通过惩罚较大的系数来防止过拟合。\n\n目标函数由下式给出：\n$$\nL(\\beta) = (y - X\\beta)^T(y - X\\beta) + \\lambda \\beta^T\\beta\n$$\n此处，$y \\in \\mathbb{R}^{n}$，$X \\in \\mathbb{R}^{n \\times p}$，$\\beta \\in \\mathbb{R}^{p}$，且 $\\lambda \\geq 0$ 是正则化参数。\n\n为了找到最小化 $L(\\beta)$ 的估计量 $\\hat{\\beta}$，我们首先展开表达式：\n$$\nL(\\beta) = (y^T - \\beta^T X^T)(y - X\\beta) + \\lambda \\beta^T\\beta\n$$\n$$\nL(\\beta) = y^T y - y^T X\\beta - \\beta^T X^T y + \\beta^T X^T X \\beta + \\lambda \\beta^T\\beta\n$$\n由于 $y^T X\\beta$ 是一个标量（$1 \\times 1$ 矩阵），它等于其转置，即 $(y^T X\\beta)^T = \\beta^T X^T y$。因此，我们可以合并中间两项：\n$$\nL(\\beta) = y^T y - 2\\beta^T X^T y + \\beta^T X^T X \\beta + \\lambda \\beta^T\\beta\n$$\n为了找到最小值，我们计算 $L(\\beta)$ 关于 $\\beta$ 的梯度并将其设为零。使用矩阵微积分法则（对于对称矩阵 $\\mathbf{A}$，有 $\\frac{\\partial(\\mathbf{a}^T\\mathbf{x})}{\\partial\\mathbf{x}} = \\mathbf{a}$ 和 $\\frac{\\partial(\\mathbf{x}^T\\mathbf{A}\\mathbf{x})}{\\partial\\mathbf{x}} = 2\\mathbf{A}\\mathbf{x}$），我们得到：\n$$\n\\frac{\\partial L(\\beta)}{\\partial \\beta} = -2X^T y + 2X^T X \\beta + 2\\lambda I \\beta\n$$\n其中 $I$ 是 $p \\times p$ 的单位矩阵。将梯度设为零以找到临界点：\n$$\n-2X^T y + 2X^T X \\hat{\\beta} + 2\\lambda I \\hat{\\beta} = 0\n$$\n两边除以 2：\n$$\n-X^T y + (X^T X) \\hat{\\beta} + (\\lambda I) \\hat{\\beta} = 0\n$$\n整理各项以求解 $\\hat{\\beta}$：\n$$\n(X^T X + \\lambda I) \\hat{\\beta} = X^T y\n$$\n当 $\\lambda > 0$ 时，矩阵 $(X^T X + \\lambda I)$ 是可逆的。因此，我们可以通过左乘其逆矩阵来分离出 $\\hat{\\beta}$：\n$$\n\\hat{\\beta} = (X^T X + \\lambda I)^{-1} X^T y\n$$\n这就是 $\\beta$ 的岭回归估计量。\n\n任务2：计算岭回归估计量 $\\beta$。\n我们有给定的训练数据：\n$$\nX_{\\mathrm{train}} = \\begin{bmatrix}\n1  2 \\\\\n0  1 \\\\\n2  0\n\\end{bmatrix}, \\quad\ny_{\\mathrm{train}} = \\begin{bmatrix}\n3 \\\\\n1 \\\\\n4\n\\end{bmatrix}\n$$\n和岭惩罚参数 $\\lambda = 1$。在本部分中，我们记 $X = X_{\\mathrm{train}}$ 和 $y = y_{\\mathrm{train}}$。\n首先，我们计算 $X^T X$：\n$$\nX^T X = \\begin{bmatrix}\n1  0  2 \\\\\n2  1  0\n\\end{bmatrix}\n\\begin{bmatrix}\n1  2 \\\\\n0  1 \\\\\n2  0\n\\end{bmatrix}\n= \\begin{bmatrix}\n1^2 + 0^2 + 2^2  1 \\cdot 2 + 0 \\cdot 1 + 2 \\cdot 0 \\\\\n2 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 2  2^2 + 1^2 + 0^2\n\\end{bmatrix}\n= \\begin{bmatrix}\n5  2 \\\\\n2  5\n\\end{bmatrix}\n$$\n接下来，我们用 $\\lambda = 1$ 和 $2 \\times 2$ 的单位矩阵 $I$ 构建矩阵 $(X^T X + \\lambda I)$：\n$$\nX^T X + \\lambda I = \\begin{bmatrix}\n5  2 \\\\\n2  5\n\\end{bmatrix} + 1 \\begin{bmatrix}\n1  0 \\\\\n0  1\n\\end{bmatrix} = \\begin{bmatrix}\n6  2 \\\\\n2  6\n\\end{bmatrix}\n$$\n现在，我们求该矩阵的逆。其行列式为 $\\det(X^T X + \\lambda I) = (6)(6) - (2)(2) = 36 - 4 = 32$。\n逆矩阵是：\n$$\n(X^T X + \\lambda I)^{-1} = \\frac{1}{32} \\begin{bmatrix}\n6  -2 \\\\\n-2  6\n\\end{bmatrix} = \\begin{bmatrix}\n\\frac{6}{32}  \\frac{-2}{32} \\\\\n\\frac{-2}{32}  \\frac{6}{32}\n\\end{bmatrix} = \\begin{bmatrix}\n\\frac{3}{16}  -\\frac{1}{16} \\\\\n-\\frac{1}{16}  \\frac{3}{16}\n\\end{bmatrix}\n$$\n接下来，我们计算 $X^T y$：\n$$\nX^T y = \\begin{bmatrix}\n1  0  2 \\\\\n2  1  0\n\\end{bmatrix}\n\\begin{bmatrix}\n3 \\\\\n1 \\\\\n4\n\\end{bmatrix}\n= \\begin{bmatrix}\n1 \\cdot 3 + 0 \\cdot 1 + 2 \\cdot 4 \\\\\n2 \\cdot 3 + 1 \\cdot 1 + 0 \\cdot 4\n\\end{bmatrix}\n= \\begin{bmatrix}\n11 \\\\\n7\n\\end{bmatrix}\n$$\n最后，我们计算 $\\hat{\\beta}$：\n$$\n\\hat{\\beta} = (X^T X + \\lambda I)^{-1} X^T y = \\begin{bmatrix}\n\\frac{3}{16}  -\\frac{1}{16} \\\\\n-\\frac{1}{16}  \\frac{3}{16}\n\\end{bmatrix}\n\\begin{bmatrix}\n11 \\\\\n7\n\\end{bmatrix}\n= \\begin{bmatrix}\n\\frac{3 \\cdot 11 - 1 \\cdot 7}{16} \\\\\n\\frac{-1 \\cdot 11 + 3 \\cdot 7}{16}\n\\end{bmatrix}\n= \\begin{bmatrix}\n\\frac{33 - 7}{16} \\\\\n\\frac{-11 + 21}{16}\n\\end{bmatrix}\n= \\begin{bmatrix}\n\\frac{26}{16} \\\\\n\\frac{10}{16}\n\\end{bmatrix}\n= \\begin{bmatrix}\n\\frac{13}{8} \\\\\n\\frac{5}{8}\n\\end{bmatrix}\n$$\n估计的系数向量为 $\\hat{\\beta} = \\begin{bmatrix} 1.625 \\\\ 0.625 \\end{bmatrix}$。\n\n任务3：计算测试集预测值 $\\hat{y}_{\\mathrm{test}}$。\n使用拟合的 $\\hat{\\beta}$ 和测试集特征 $X_{\\mathrm{test}}$，我们计算预测的蛋白质丰度 $\\hat{y}_{\\mathrm{test}} = X_{\\mathrm{test}}\\hat{\\beta}$。\n$$\nX_{\\mathrm{test}} = \\begin{bmatrix}\n1  1 \\\\\n3  0\n\\end{bmatrix}\n$$\n$$\n\\hat{y}_{\\mathrm{test}} = \\begin{bmatrix}\n1  1 \\\\\n3  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\frac{13}{8} \\\\\n\\frac{5}{8}\n\\end{bmatrix}\n= \\begin{bmatrix}\n1 \\cdot \\frac{13}{8} + 1 \\cdot \\frac{5}{8} \\\\\n3 \\cdot \\frac{13}{8} + 0 \\cdot \\frac{5}{8}\n\\end{bmatrix}\n= \\begin{bmatrix}\n\\frac{13+5}{8} \\\\\n\\frac{39}{8}\n\\end{bmatrix}\n= \\begin{bmatrix}\n\\frac{18}{8} \\\\\n\\frac{39}{8}\n\\end{bmatrix}\n= \\begin{bmatrix}\n\\frac{9}{4} \\\\\n\\frac{39}{8}\n\\end{bmatrix}\n= \\begin{bmatrix}\n2.25 \\\\\n4.875\n\\end{bmatrix}\n$$\n\n任务4：使用RMSE评估预测准确性。\n均方根误差 (RMSE) 定义为 $\\mathrm{RMSE} = \\sqrt{\\frac{1}{n_{\\mathrm{test}}}\\sum_{i=1}^{n_{\\mathrm{test}}}(y_{i} - \\hat{y}_{i})^{2}}$。\n我们有 $n_{\\mathrm{test}} = 2$，观测的测试值为 $y_{\\mathrm{test}} = \\begin{bmatrix} 2.0 \\\\ 5.2 \\end{bmatrix}$，预测值为 $\\hat{y}_{\\mathrm{test}} = \\begin{bmatrix} 2.25 \\\\ 4.875 \\end{bmatrix}$。\n\n首先，我们计算残差 $(y_i - \\hat{y}_i)$：\n对于细胞 $i=1$：$y_1 - \\hat{y}_1 = 2.0 - 2.25 = -0.25$。\n对于细胞 $i=2$：$y_2 - \\hat{y}_2 = 5.2 - 4.875 = 0.325$。\n\n接下来，我们对残差求平方：\n$(y_1 - \\hat{y}_1)^2 = (-0.25)^2 = 0.0625$。\n$(y_2 - \\hat{y}_2)^2 = (0.325)^2 = 0.105625$。\n\n现在，我们计算均方误差 (MSE)：\n$$\n\\mathrm{MSE} = \\frac{1}{n_{\\mathrm{test}}}\\sum_{i=1}^{n_{\\mathrm{test}}}(y_{i} - \\hat{y}_{i})^{2} = \\frac{1}{2}(0.0625 + 0.105625) = \\frac{0.168125}{2} = 0.0840625\n$$\n最后，我们取平方根得到RMSE：\n$$\n\\mathrm{RMSE} = \\sqrt{0.0840625} \\approx 0.28993533...\n$$\n问题要求将最终答案四舍五入到四位有效数字。前四位有效数字是 $2$、$8$、$9$ 和 $9$。第五位有效数字是 $3$，小于 $5$，因此我们不向上舍入。\n$$\n\\mathrm{RMSE} \\approx 0.2899\n$$",
            "answer": "$$\\boxed{0.2899}$$"
        }
    ]
}