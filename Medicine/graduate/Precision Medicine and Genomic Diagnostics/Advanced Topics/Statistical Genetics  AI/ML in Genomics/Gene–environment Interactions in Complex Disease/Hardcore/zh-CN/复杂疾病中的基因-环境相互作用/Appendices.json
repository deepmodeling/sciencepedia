{
    "hands_on_practices": [
        {
            "introduction": "在病例-对照研究中，逻辑回归是评估疾病风险因素的标准工具，它自然地允许我们检验乘性尺度上的相互作用。通过在模型中包含基因（$G$）和环境（$E$）的乘积项（$G \\cdot E$），我们可以直接估计和检验相互作用效应。本练习模拟了一个真实世界的研究场景，要求你利用回归分析的输出（系数估计值和协方差矩阵）来进行Wald检验，以确定基因与环境之间是否存在显著的乘性相互作用。",
            "id": "4344975",
            "problem": "一项精准医疗领域的病例对照研究旨在探究一个转录因子基因中的常见风险等位基因是否与一种可改变的膳食暴露发生交互作用，从而影响患某种复杂代谢性疾病的几率。设 $Y \\in \\{0,1\\}$ 表示疾病状态，$G \\in \\{0,1,2\\}$ 表示风险等位基因的加性基因型计数，$E \\in \\{0,1\\}$ 表示高精制碳水化合物膳食摄入的指示变量。对数据拟合一个逻辑回归模型：\n$$\n\\log\\left(\\frac{\\Pr(Y=1 \\mid G,E)}{1-\\Pr(Y=1 \\mid G,E)}\\right) \\equiv \\text{logit}\\,\\Pr(Y=1 \\mid G,E) = \\beta_{0} + \\beta_{G}\\,G + \\beta_{E}\\,E + \\beta_{GE}\\,(G\\cdot E).\n$$\n假设在逻辑连接函数的广义线性模型 (GLM) 下，最大似然估计得到的估计系数向量，按 $(\\beta_{0},\\beta_{G},\\beta_{E},\\beta_{GE})$ 顺序排列为：\n$$\n\\hat{\\boldsymbol{\\beta}} = \\begin{pmatrix} -2.10 \\\\ 0.40 \\\\ 0.75 \\\\ 0.55 \\end{pmatrix},\n$$\n以及相应的估计协方差矩阵\n$$\n\\widehat{\\boldsymbol{\\Sigma}} = \\begin{pmatrix}\n0.0900  -0.0050  -0.0060  0.0040 \\\\\n-0.0050  0.0225  0.0030  0.0020 \\\\\n-0.0060  0.0030  0.0400  -0.0010 \\\\\n0.0040  0.0020  -0.0010  0.0324\n\\end{pmatrix}.\n$$\n仅使用模型定义、最大似然估计量的渐近性质以及所提供的输出，计算原假设 $H_{0}:\\beta_{GE}=0$ 的单自由度瓦尔德检验统计量。然后，根据几率比解释此模型中乘性几率尺度上交互作用的含义。仅报告瓦尔德卡方统计量的值作为最终数值答案，并四舍五入到三位有效数字。无需单位。",
            "solution": "用户希望我首先验证问题陈述，如果有效，则提供完整的解答。\n\n### 步骤1：提取已知信息\n- **疾病状态：** $Y \\in \\{0,1\\}$\n- **基因型：** $G \\in \\{0,1,2\\}$ (风险等位基因的加性计数)\n- **暴露：** $E \\in \\{0,1\\}$ (高精制碳水化合物膳食摄入的指示变量)\n- **逻辑回归模型：**\n$$\n\\log\\left(\\frac{\\Pr(Y=1 \\mid G,E)}{1-\\Pr(Y=1 \\mid G,E)}\\right) = \\beta_{0} + \\beta_{G}\\,G + \\beta_{E}\\,E + \\beta_{GE}\\,(G\\cdot E)\n$$\n- **估计的系数向量：** 向量 $\\hat{\\boldsymbol{\\beta}}$ 按 $(\\beta_{0},\\beta_{G},\\beta_{E},\\beta_{GE})$ 顺序排列：\n$$\n\\hat{\\boldsymbol{\\beta}} = \\begin{pmatrix} -2.10 \\\\ 0.40 \\\\ 0.75 \\\\ 0.55 \\end{pmatrix}\n$$\n- **估计的协方差矩阵：**\n$$\n\\widehat{\\boldsymbol{\\Sigma}} = \\begin{pmatrix}\n0.0900  -0.0050  -0.0060  0.0040 \\\\\n-0.0050  0.0225  0.0030  0.0020 \\\\\n-0.0060  0.0030  0.0400  -0.0010 \\\\\n0.0040  0.0020  -0.0010  0.0324\n\\end{pmatrix}\n$$\n- **原假设：** $H_{0}:\\beta_{GE}=0$\n- **任务：** 计算 $H_{0}$ 的单自由度瓦尔德检验统计量，并将值四舍五入到三位有效数字后报告。\n\n### 步骤2：使用提取的已知信息进行验证\n根据验证标准对问题进行评估。\n\n- **科学依据：** 该问题牢固地植根于生物统计学和流行病学的既定原则。逻辑回归是分析病例对照研究中二元结局的标准方法，而包含交互作用项 ($G \\cdot E$) 是检验基因-环境交互作用的经典方法。精准医疗和基因组诊断的背景是恰当的。\n- **定义良好：** 该问题提供了计算所需检验统计量的所有必要信息。给出了 $\\beta_{GE}$ 的参数估计值，其方差可以直接从所提供的协方差矩阵中提取。问题具体，且有唯一、稳定的解。\n- **客观性：** 问题以精确、客观和定量的术语陈述。没有主观或模糊的陈述。\n- **缺陷分析：**\n    - 问题没有违反任何科学原理或数学逻辑。\n    - 它不是隐喻性的，并且与指定的科学领域直接相关。\n    - 问题设置完整且内部一致。协方差矩阵是对称的，且对角线元素（方差）为正，符合要求。\n    - 数值对于一个真实世界的研究是合理的。\n    - 问题结构清晰，没有歧义。\n    - 问题要求基于基本理论进行标准的、非平凡的统计计算。\n\n### 步骤3：结论与行动\n此问题是**有效的**。将提供完整解答。\n\n### 解答\n目标是计算原假设 $H_{0}: \\beta_{GE} = 0$ 的瓦尔德检验统计量。瓦尔德检验是基于最大似然估计量 (MLEs) 的渐近正态性，用于检验统计模型中参数假设的一种通用方法。对于单个参数估计 $\\hat{\\theta}$，其原假设 $H_{0}: \\theta = \\theta_{0}$ 的瓦尔德统计量由下式给出：\n$$\nW = \\frac{(\\hat{\\theta} - \\theta_{0})^2}{\\widehat{\\text{Var}}(\\hat{\\theta})}\n$$\n其中 $\\widehat{\\text{Var}}(\\hat{\\theta})$ 是估计量 $\\hat{\\theta}$ 的估计方差。在原假设下，$W$ 服从自由度为1的卡方 ($\\chi^2$) 分布。\n\n在本题中，我们关心的参数是 $\\theta = \\beta_{GE}$，原假设将其值设为 $\\theta_{0} = 0$。该参数的最大似然估计量在系数向量 $\\hat{\\boldsymbol{\\beta}}$ 中作为第四个元素给出。\n根据给定信息，交互作用项的估计系数为：\n$$\n\\hat{\\beta}_{GE} = 0.55\n$$\n该估计量的方差 $\\widehat{\\text{Var}}(\\hat{\\beta}_{GE})$ 是估计协方差矩阵 $\\widehat{\\boldsymbol{\\Sigma}}$ 中对应于 $\\hat{\\beta}_{GE}$ 的对角线元素。由于参数向量的顺序是 $(\\beta_{0},\\beta_{G},\\beta_{E},\\beta_{GE})$，所需的方差是第四个对角线元素 $\\widehat{\\boldsymbol{\\Sigma}}_{44}$。\n$$\n\\widehat{\\text{Var}}(\\hat{\\beta}_{GE}) = \\widehat{\\boldsymbol{\\Sigma}}_{44} = 0.0324\n$$\n估计量的标准误 (SE) 是方差的平方根：\n$$\n\\text{SE}(\\hat{\\beta}_{GE}) = \\sqrt{\\widehat{\\text{Var}}(\\hat{\\beta}_{GE})} = \\sqrt{0.0324} = 0.18\n$$\n现在，我们可以计算 $H_{0}: \\beta_{GE}=0$ 的瓦尔德统计量：\n$$\nW = \\frac{(\\hat{\\beta}_{GE} - 0)^2}{\\widehat{\\text{Var}}(\\hat{\\beta}_{GE})} = \\frac{(0.55)^2}{0.0324}\n$$\n计算分子并进行除法运算：\n$$\nW = \\frac{0.3025}{0.0324} \\approx 9.33641975...\n$$\n题目要求答案四舍五入到三位有效数字。\n$$\nW \\approx 9.34\n$$\n题目还要求解释乘性几率尺度上交互作用项的含义。逻辑模型定义了疾病的对数几率。对模型方程取指数，得到几率：\n$$\n\\text{Odds}(Y=1 \\mid G,E) = \\frac{\\Pr(Y=1 \\mid G,E)}{1-\\Pr(Y=1 \\mid G,E)} = \\exp(\\beta_{0} + \\beta_{G}\\,G + \\beta_{E}\\,E + \\beta_{GE}\\,G E)\n$$\n乘性尺度上的交互作用意味着一个变量的几率比 (OR) 取决于另一个变量的水平。我们来考察基因型计数 $G$ 每增加一个单位时，按暴露状态 $E$ 分层的几率比。\n\n当没有暴露时 ($E=0$)：\n$$\n\\text{OR}_{G \\mid E=0} = \\frac{\\text{Odds}(Y=1 \\mid G=g+1, E=0)}{\\text{Odds}(Y=1 \\mid G=g, E=0)} = \\frac{\\exp(\\beta_{0} + \\beta_{G}(g+1))}{\\exp(\\beta_{0} + \\beta_{G}g)} = \\exp(\\beta_{G})\n$$\n当存在暴露时 ($E=1$)：\n$$\n\\text{OR}_{G \\mid E=1} = \\frac{\\text{Odds}(Y=1 \\mid G=g+1, E=1)}{\\text{Odds}(Y=1 \\mid G=g, E=1)} = \\frac{\\exp(\\beta_{0} + \\beta_{G}(g+1) + \\beta_{E} + \\beta_{GE}(g+1))}{\\exp(\\beta_{0} + \\beta_{G}g + \\beta_{E} + \\beta_{GE}g)} = \\exp(\\beta_{G} + \\beta_{GE})\n$$\n参数 $\\beta_{GE}$ 量化了交互作用。如果 $\\beta_{GE}=0$，则 $\\text{OR}_{G \\mid E=1} = \\text{OR}_{G \\mid E=0}$，意味着无论暴露与否，遗传效应对疾病几率的影响是相同的。如果 $\\beta_{GE} \\neq 0$，则基因型的效应会受到暴露的修正。项 $\\exp(\\beta_{GE})$ 是这两个几率比的比值：\n$$\n\\frac{\\text{OR}_{G \\mid E=1}}{\\text{OR}_{G \\mid E=0}} = \\frac{\\exp(\\beta_{G} + \\beta_{GE})}{\\exp(\\beta_{G})} = \\exp(\\beta_{GE})\n$$\n这表明，$\\exp(\\beta_{GE})$ 是指从无暴露组 ($E=0$) 变为有暴露组 ($E=1$) 时，遗传效应的几率比变化的乘性因子。检验 $H_0: \\beta_{GE}=0$ 等价于检验这个几率比的比值是否等于1，后者表示在乘性尺度上没有交互作用。计算出的瓦尔德统计量提供了反对该原假设的证据。",
            "answer": "$$\n\\boxed{9.34}\n$$"
        },
        {
            "introduction": "检测基因-环境相互作用通常需要大规模的样本，这在研究设计上构成了巨大挑战。为了提高统计效率，研究人员发展出了“唯病例（case-only）”设计，这种巧妙的方法仅通过分析病例样本中的基因-环境关联来估计乘性相互作用。这个练习旨在深化你对唯病例设计的理解，包括其基本原理、关键的独立性假设以及它在识别相互作用效应方面的优势与局限。",
            "id": "4345006",
            "problem": "一个精准医学研究团队试图采用一种仅抽样患病个体的方法，来高效地估计一种复杂疾病的基因-环境（GxE）交互作用。设 $D \\in \\{0,1\\}$ 表示疾病状态，$G \\in \\{0,1\\}$ 表示一个双等位基因的单核苷酸多态性（SNP；风险等位基因携带者编码为 $1$，否则为 $0$），$E \\in \\{0,1\\}$ 表示一个二元环境暴露。考虑一个基础设定，其中疾病优势（odds）通过一个允许 $G$ 和 $E$ 之间存在交互作用的逻辑斯蒂风险模型在乘法尺度上建模，即条件性疾病优势满足\n$$\\operatorname{odds}\\{D=1 \\mid G,E\\} = \\exp\\{\\alpha + \\beta_G G + \\beta_E E + \\beta_{GE} G E\\},$$\n因此，在疾病优势比（OR）尺度上的乘法交互作用为 $\\exp(\\beta_{GE})$。你可以只假设基本的概率定义、Bayes’ 定理、独立性定义和优势比定义。不应假设任何其他捷径。\n\n该团队正在考虑一种“唯病例”（case-only）方法。仅使用上述基本原理，推断唯病例设计必须做什么，以及它根本上需要什么假设才能识别乘法GxE交互作用。哪个选项最准确地定义了用于GxE估计的唯病例设计，并陈述了其所依赖的核心独立性假设，同时说明了在该设计下哪些是可识别的，哪些是不可识别的？\n\nA. 唯病例设计只招募 $D=1$ 的个体，并估计病例中 $G$ 和 $E$ 之间的关联（例如，通过在 $D=1$ 的个体中将 $G$ 对 $E$ 进行回归），以推断疾病OR尺度上的乘法GxE交互作用。其核心假设是，在产生病例的源人群中，$G$ 和 $E$ 是独立的，即 $P(G,E)=P(G)P(E)$。在此假设下，病例中 $G$–$E$ 的优势比可以识别 $\\exp(\\beta_{GE})$。$G$ 和 $E$ 对 $D$ 的主（边际）效应无法从唯病例数据中识别。\n\nB. 唯病例设计招募等量的 $D=1$ 和 $D=0$ 的个体，并拟合一个包含 $G E$ 乘积项的逻辑斯蒂模型 $\\operatorname{logit} P(D=1 \\mid G,E)$。其核心假设是 $G$ 和 $E$ 在病例中是独立的，即 $P(G,E \\mid D=1)=P(G \\mid D=1)P(E \\mid D=1)$。在此假设下，交互作用和主效应都是可一致估计的。\n\nC. 唯病例设计只招募 $D=1$ 的个体，并假设 $G$ 和 $E$ 在对照组中是独立的，即 $P(G,E \\mid D=0)=P(G \\mid D=0)P(E \\mid D=0)$，同时结合罕见病近似。在这些条件下，它可以识别风险差尺度上的加法交互作用。\n\nD. 唯病例设计只招募 $D=1$ 的个体，并要求 $G$ 满足Hardy–Weinberg平衡且与其他位点不存在连锁不平衡，以及 $E$ 的随机分配。在这些条件下，病例中 $G$–$E$ 的关联可以识别风险比尺度上的交互作用，并且主效应也是可无偏估计的。",
            "solution": "我们从第一性原理出发：（i）基本概率，（ii）Bayes’ 定理，（iii）独立性，以及（iv）优势比的定义。设 $D \\in \\{0,1\\}$，$G \\in \\{0,1\\}$，以及 $E \\in \\{0,1\\}$。逻辑斯蒂模型假定\n$$\\operatorname{odds}\\{D=1 \\mid G=g, E=e\\} = \\frac{P(D=1 \\mid g,e)}{P(D=0 \\mid g,e)} = \\exp\\{\\alpha + \\beta_G g + \\beta_E e + \\beta_{GE} g e\\}.$$\n根据构造，疾病优势比（OR）尺度上的乘法基因-环境（GxE）交互作用等于 $\\exp(\\beta_{GE})$；这是将 $G$ 和 $E$ 的联合效应与分别的优势比相乘所预期的效应进行比较时，疾病优势比的倍数变化。\n\n唯病例逻辑。唯病例设计仅从 $D=1$ 的个体中抽样，并检验病例中 $G$ 和 $E$ 的关联，其思路是，在源人群中核心独立性假设下，这种关联反映了交互作用参数。将病例子集中 $G$ 和 $E$ 之间关联的优势比定义为\n$$\\operatorname{OR}_{GE \\mid D=1} = \\frac{P(G=1,E=1 \\mid D=1)\\, P(G=0,E=0 \\mid D=1)}{P(G=1,E=0 \\mid D=1)\\, P(G=0,E=1 \\mid D=1)}.$$\n根据Bayes’ 定理，\n$$P(G=g,E=e \\mid D=1) = \\frac{P(D=1 \\mid g,e)\\, P(G=g, E=e)}{P(D=1)}.$$\n因此，\n\\begin{align*}\n\\operatorname{OR}_{GE \\mid D=1}\n= \\frac{\\big[P(D=1 \\mid 1,1)\\, P(G=1,E=1)\\big]\\big[P(D=1 \\mid 0,0)\\, P(G=0,E=0)\\big]}{\\big[P(D=1 \\mid 1,0)\\, P(G=1,E=0)\\big]\\big[P(D=1 \\mid 0,1)\\, P(G=0,E=1)\\big]}.\n\\end{align*}\n如果 $G$ 和 $E$ 在源人群（即产生病例的人群）中是独立的，那么 $P(G,E)=P(G)P(E)$，并且在交叉乘积中，$P(G)P(E)$ 项会相互抵消，得到\n$$\\operatorname{OR}_{GE \\mid D=1} = \\frac{P(D=1 \\mid 1,1)\\, P(D=1 \\mid 0,0)}{P(D=1 \\mid 1,0)\\, P(D=1 \\mid 0,1)}.$$\n通过逻辑斯蒂模型，将每个 $P(D=1 \\mid g,e)$ 以优势（odds）形式表示。由于\n$$\\frac{P(D=1 \\mid g,e)}{P(D=0 \\mid g,e)} = \\exp\\{\\alpha + \\beta_G g + \\beta_E e + \\beta_{GE} g e\\},$$\n可得\n\\begin{align*}\n\\frac{P(D=1 \\mid 1,1)\\, P(D=1 \\mid 0,0)}{P(D=1 \\mid 1,0)\\, P(D=1 \\mid 0,1)}\n= \\frac{\\frac{\\exp\\{\\alpha + \\beta_G + \\beta_E + \\beta_{GE}\\}}{1+\\exp\\{\\alpha + \\beta_G + \\beta_E + \\beta_{GE}\\}} \\cdot \\frac{\\exp\\{\\alpha\\}}{1+\\exp\\{\\alpha\\}}}{\\frac{\\exp\\{\\alpha + \\beta_G\\}}{1+\\exp\\{\\alpha + \\beta_G\\}} \\cdot \\frac{\\exp\\{\\alpha + \\beta_E\\}}{1+\\exp\\{\\alpha + \\beta_E\\}}}.\n\\end{align*}\n一条更清晰的路径是直接处理优势（odds），因为优势比会抵消掉讨厌因子（nuisance factors）。定义\n$$\\mathcal{O}(g,e) = \\frac{P(D=1 \\mid g,e)}{P(D=0 \\mid g,e)} = \\exp\\{\\alpha + \\beta_G g + \\beta_E e + \\beta_{GE} g e\\}.$$\n那么\n\\begin{align*}\n\\frac{P(D=1 \\mid 1,1)\\, P(D=1 \\mid 0,0)}{P(D=1 \\mid 1,0)\\, P(D=1 \\mid 0,1)}\n= \\frac{\\mathcal{O}(1,1)\\, P(D=0 \\mid 1,1)\\ \\cdot\\ \\mathcal{O}(0,0)\\, P(D=0 \\mid 0,0)}{\\mathcal{O}(1,0)\\, P(D=0 \\mid 1,0)\\ \\cdot\\ \\mathcal{O}(0,1)\\, P(D=0 \\mid 0,1)}.\n\\end{align*}\n由于在形成优势的优势比时，每个 $P(D=0 \\mid g,e)$ 都与交叉乘积比中的对应项相抵消，我们得到标准的简化式：\n\\begin{align*}\n\\operatorname{OR}_{GE \\mid D=1}\n= \\frac{\\mathcal{O}(1,1)\\, \\mathcal{O}(0,0)}{\\mathcal{O}(1,0)\\, \\mathcal{O}(0,1)} \\\\\n= \\frac{\\exp\\{\\alpha + \\beta_G + \\beta_E + \\beta_{GE}\\}\\, \\exp\\{\\alpha\\}}{\\exp\\{\\alpha + \\beta_G\\}\\, \\exp\\{\\alpha + \\beta_E\\}} \\\\\n= \\exp\\{\\beta_{GE}\\}.\n\\end{align*}\n因此，在 $G$ 和 $E$ 在源人群中独立（即 $P(G,E)=P(G)P(E)$）这一单一核心假设下，病例中 $G$–$E$ 关联的优势比可以识别疾病OR尺度上的乘法GxE交互作用 $\\exp(\\beta_{GE})$。此推导仅使用了Bayes’ 定理、独立性定义和逻辑斯蒂乘法优势模型。\n\n可识别性与局限性。因为唯病例设计以 $D=1$ 为条件，并利用病例中诱导出的 $G$–$E$ 关联，所以它不能识别主效应 $\\beta_G$ 或 $\\beta_E$；在独立性假设下，这些效应在交叉乘积比中被抵消了。因此，仅凭唯病例数据无法恢复 $G$ 和 $E$ 对 $D$ 的主（边际）遗传和环境效应。交互作用的估计效率得到了提高，但代价是依赖于独立性假设。如果 $G$ 和 $E$ 在源人群中是相关的（例如，通过人群分层或基因-环境相关），那么唯病例估计量是有偏的。值得注意的是，这个在优势比尺度上的结果并不需要罕见病假设，并且该假设涉及的是源人群中的独立性，而不是病例或对照子集内的独立性。\n\n逐项分析：\n- 选项 A：准确地定义了唯病例设计为仅抽样 $D=1$ 的个体并对病例中的 $G$–$E$ 关联进行建模；陈述了在源人群中 $P(G,E)=P(G)P(E)$ 的正确核心假设；指出了在该假设下 $\\operatorname{OR}_{GE \\mid D=1} = \\exp(\\beta_{GE})$；并正确地注意到主效应是不可识别的。结论 — 正确。\n- 选项 B：描述的是病例-对照设计，而非唯病例设计，因为它招募了 $D=1$ 和 $D=0$ 的个体。它还错误地将独立性假设置于病例中，即 $P(G,E \\mid D=1)=P(G \\mid D=1)P(E \\mid D=1)$，这既不是必需的，通常也不成立，并且错误地声称在该假设下，主效应在唯病例分析中是可一致估计的。结论 — 错误。\n- 选项 C：将独立性假设置于对照组中，即 $P(G,E \\mid D=0)$，并增加了罕见病近似，然后断言可以识别风险差尺度上的加法交互作用。唯病例的核心假设是源人群中的独立性，而非特指对照组中的独立性，并且该设计针对的是优势比尺度上的乘法交互作用，无需罕见病近似。结论 — 错误。\n- 选项 D：引用了Hardy–Weinberg平衡、无连锁不平衡以及 $E$ 的随机分配作为“核心”条件，并声称可以在风险比尺度上识别交互作用，且主效应也可估计。这些并非唯病例估计量用于乘法交互作用的定义性假设；$E$ 的随机分配通常不现实，且仅从病例中无法识别主效应。结论 — 错误。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}