## 引言
[基因剪接](@entry_id:271735)是基因表达的核心调控环节，其异常与众多[遗传性疾病](@entry_id:273195)和癌症密切相关。然而，决定剪接结果的“剪接密码”极其复杂，远超简单的序列基元。这种复杂性为我们理解基因调控、解读遗传变异的致病性带来了巨大挑战，尤其是在广阔的非编码基因组区域，存在大量“意义未明的变异”（VUS）亟待破译。

深度学习模型的出现为解决这一难题提供了革命性的工具。它们能够直接从海量的基因组[序列数据](@entry_id:636380)中，自动学习控制剪接的复杂语法规则，其能力远超传统方法。本文旨在系统性地介绍如何利用[深度学习](@entry_id:142022)来建模剪接与基因调控。我们将首先在**“原理与机制”**一章中，深入探讨剪接的分子生物学基础以及深度学习模型如何模拟这些过程。接着，在**“应用与交叉学科连接”**一章中，我们将展示这些模型如何在精准诊断和[RNA疗法](@entry_id:148273)设计等前沿领域发挥关键作用。最后，通过**“动手实践”**部分，您将有机会亲手构建和分析这些模型，将理论知识转化为实践技能。

## 原理与机制

在前一章中，我们介绍了[基因剪接](@entry_id:271735)作为基因表达调控核心环节的重要性，以及深度学习在破译其复杂规则方面的巨大潜力。本章将深入探讨剪接过程的“原理与机制”，从定义剪接密码的基本分子语言，到解释调控其多样性的复杂语法，最终阐明[深度学习模型](@entry_id:635298)如何学习并模拟这些生物学过程。我们将构建一个从生物学基本原理到高级计算概念的系统性框架。

### 剪接密码：定义内含子和外显子的序列信号

细胞如何精确识别需要从前体[信使RNA](@entry_id:262893)（pre-mRNA）中切除的内含子（intron）和需要保留并连接在一起的外显子（exon）？答案在于pre-mRNA序列本身编码的一组被称为“剪接密码”的保守信号。这些信号被一个名为[剪接体](@entry_id:138521)（spliceosome）的巨[大分子机器](@entry_id:196794)所识别。

#### 核心剪接信号

最基本的一组信号构成了几乎所有人类[内含子](@entry_id:144362)的边界。这些信号及其空间排布具有严格的约束，是剪接过程的基石 。

*   **$5'$ 剪接位点（供体位点）**：位于内含子的 $5'$ 端，即上游外显子与[内含子](@entry_id:144362)的交界处。在RNA水平上，该位点几乎总是以 $GU$ 二核苷酸开始。这个位点是剪接反应第一步的攻击目标。

*   **$3'$ 剪接位点（受体位点）**：位于内含子的 $3'$ 端，即内含子与下游外显子的交界处。该位点几乎总是以 $AG$ 二[核苷](@entry_id:195320)酸结束。这个位点是剪接反应第二步的连接点。

*   **[分支点](@entry_id:166575)（Branch Point）**：这是位于内含子内部的一个保守的腺嘌呤（$A$）[核苷](@entry_id:195320)酸。在人类基因中，它通常位于距离下游 $3'$ 剪接位点约 $18$ 到 $40$ 个[核苷](@entry_id:195320)酸的上游位置。这个腺嘌呤的 $2'$-羟基是发动剪接反应的关键亲核基团。

*   **多聚嘧啶区（Polypyrimidine Tract, PPT）**：这是一段富含胞嘧啶（$C$）和尿嘧啶（$U$）的序列，位于[分支点](@entry_id:166575)和 $3'$ 剪接位点之间。它在招募剪接体识别 $3'$ 剪接位点的过程中扮演重要角色。

这些元素共同构成了一个基本的识别框架：[内含子](@entry_id:144362)以 $GU$ 开始，包含一个上游的[分支点](@entry_id:166575)和紧邻其下游的多聚嘧啶区，最后以 $AG$ 结束。任何破坏这些核心信号的遗传变异都可能导致灾难性的剪接错误。

#### [剪接体](@entry_id:138521)：读取剪接密码的分子机器

如果说核心剪接信号是写在pre-mRNA上的“文字”，那么剪接体就是“阅读器”。剪接体并非一个静态实体，而是一个由五种小核RNA（snRNA）——U1、U2、U4、U5 和 U6——以及超过一百种[蛋白质组](@entry_id:150306)成的动态核糖核蛋白（RNP）复合体。snRNA是剪接体识别剪接位点的核心，其机制主要依赖于RNA-RNA碱基配对 。

剪接过程的早期关键步骤展示了这种基于互补配对的精确识别：

1.  **$5'$ 剪接位点的识别**：U1 [snRNP](@entry_id:153452)中的U1 snRNA含有一段与 $5'$ 剪接位点（包括 $GU$ 及其侧翼序列）互补的序列。通过沃森-克里克（A-U, G-C）和摆动（G-U）碱基配对，U1 [snRNP](@entry_id:153452)精确地结合到内含子的起始位置。

2.  **分支点的识别**：U2 [snRNP](@entry_id:153452)在辅助因子（如U2AF）的帮助下被招募到[分支点](@entry_id:166575)序列。U2 snRNA与分支点区域配对，但其配对方式非常特殊，它会使关键的分支点腺嘌呤“凸出”于双链结构之外，使其 $2'$-羟基暴露，为后续的催化反应做好准备。

随后，U4、U5和U6 [snRNP](@entry_id:153452)加入，经过一系列复杂的重构，U6取代U1与 $5'$ 剪接位点结合，并与U2相互作用形成[剪接体](@entry_id:138521)的催化核心。U5则负责将上游和下游的外显子末端固定在一起，以便最终连接。这一系列基于RNA互补配对的相互作用，确保了剪接反应的精确性和保真度。

### 替代剪接的复杂性

如果所有基因都只遵循上述基本规则进行“组成型剪接”（constitutive splicing），那么每个基因将只能产生一种mRNA。然而，在高等真核生物中，超过95%的多外显[子基](@entry_id:152709)因都会经历“替代剪接”（alternative splicing），即通过不同的剪接组合方式，从同一个基因产生多种不同的mRNA亚型。这极大地扩展了基因组编码的蛋白质多样性。

#### 替代剪接的模式

替代剪接可以产生多种多样的转录本结构。通过分析RNA测序（[RNA-seq](@entry_id:140811)）数据中跨越外显子-外显子连接处的“剪接读长”（junction reads），我们可以识别出这些不同的剪接模式 ：

*   **[盒式外显子](@entry_id:176629)（Cassette Exon）**：这是最常见的模式，一个外显子可以被完整地包含在mRNA中（包含 isoform），或者被完整地跳过（跳过 isoform）。其RNA-seq特征是同时存在连接上游-盒式-下游外显子的读长和直接连接上游-下游外显子的“跳跃”读长。

*   **相互排斥外显子（Mutually Exclusive Exons）**：一组两个或多个外显子中，只有一个能被包含在最终的mRNA中。

*   **替代性 $5'$ 或 $3'$ 剪接位点**：同一个外显子可以使用多个不同的供体位点或受体位点，导致外显子边界发生移动，长度发生改变。

*   **内含子滞留（Intron Retention）**：一个或多个[内含子](@entry_id:144362)没有被切除，而是被保留在成熟的mRNA中。

*   **替代性首尾外显子（Alternative First/Last Exon）**：由于使用了不同的[转录起始位点](@entry_id:263682)（启动子）或[转录终止](@entry_id:183504)位点（[多聚腺苷酸化](@entry_id:275325)信号），导致基因的首个或最后一个外显子不同。

#### 调控替代剪接的生化检查点

替代剪接的发生，源于细胞在一个基因的多个潜在剪接位点之间做出选择。这一选择过程受到多层次的精密调控，构成了复杂的[调控网络](@entry_id:754215) 。

1.  **核心剪接位点的竞争**：并非所有的 $GU$ 和 $AG$ 位点都具有同等的“强度”。当一个基因含有多个强度相近的竞争性剪接位点时，[剪接体](@entry_id:138521)可能会随机或在调控下选择不同的位点组合，从而产生不同的亚型。

2.  **[顺式调控元件](@entry_id:275840)与[反式作用因子](@entry_id:265500)**：除了核心信号，pre-mRNA上还散布着大量的短[序列模体](@entry_id:177422)（motifs），即“[顺式调控元件](@entry_id:275840)”。这些元件通过招募“[反式作用因子](@entry_id:265500)”（通常是[RNA结合蛋白](@entry_id:194730)，RBP）来调控附近剪接位点的使用。这些元件根据其位置和功能分为：
    *   **剪接增[强子](@entry_id:198809)（Splicing Enhancers）**：位于外显子（ESE）或[内含子](@entry_id:144362)（ISE）中，能促进附近剪接位点的识别。
    *   **剪接沉默子（Splicing Silencers）**：位于外显子（ESS）或[内含子](@entry_id:144362)（ISS）中，能抑制附近剪接位点的识别。
    这些元件的活性，以及它们所招募的RBP（如促进剪接的[SR蛋白](@entry_id:151919)家族和抑制剪接的hnRNP家族）的表达水平和活性，常常具有组织特异性，这是组织特异性剪接的主要原因。

3.  **转录与剪接的偶联**：剪接通常在pre-mRNA转录过程中“共转录”发生。RNA聚合酶II（Pol II）的延伸速率会影响剪接结果。例如，较慢的延伸速率为剪接体识别和加工一个较弱的剪接位点提供了更长的时间窗口，否则这个位点可能会在其下游更强的竞争位点被转录出来后被忽略。聚合酶的速率又受到[染色质状态](@entry_id:190061)（如[组蛋白修饰](@entry_id:183079)）的影响，从而将基因的[表观遗传](@entry_id:143805)状态与剪接结果联系起来。

4.  **[RNA二级结构](@entry_id:166947)**：pre-mRNA分子可以折叠成复杂的二级和[三级结构](@entry_id:138239)。这些结构可能将一个剪接位点或调控元件隐藏在[发夹环](@entry_id:198792)等结构中，使其无法被[剪接体](@entry_id:138521)或RBP接近。反之，结构也可能将原本距离很远的两个元件拉近，促进它们的功能。[RNA结构](@entry_id:144883)的变化可以作为一种[分子开关](@entry_id:154643)来调控剪接选择。

5.  **剪接与[多聚腺苷酸化](@entry_id:275325)的竞争**：在基因的末端，剪接过程与[转录终止](@entry_id:183504)过程（切割和[多聚腺苷酸化](@entry_id:275325)）之间存在竞争。当一个[内含子](@entry_id:144362)中存在一个潜在的[多聚腺苷酸化](@entry_id:275325)信号时，细胞必须在“切除[内含子](@entry_id:144362)”和“在此处终止转录”之间做出选择，这会导致产生具有不同 $3'$ 末端的mRNA亚型。

### 破译剪接的调控语法

上述调控机制共同构成了一套复杂的“调控语法”。正如自然语言中的语法规定了单词如何组合成有意义的句子，剪接的调控语法规定了各种顺式元件（模体）如何通过它们的组合、间距和方向来决定最终的剪接输出。

#### [剪接调控](@entry_id:146064)因子的位置依赖性效应

[SR蛋白](@entry_id:151919)和hnRNP等调控因子的作用不是全局性的，而是高度依赖于它们在pre-mRNA上的结合位置 。一般而言：

*   **[SR蛋白](@entry_id:151919)**作为剪接增强因子，当它们结合到外显子上的ESE时，能够通过蛋白-蛋白相互作用，在被调控的外显子两端同时招募U1和U2AF等[剪接体](@entry_id:138521)早期成分。这种“[外显子定义](@entry_id:152876)”机制显著增强了该外显子的识别和包含。

*   **hnRNP**通常作为剪接抑制因子。当它们结合到外显子上的ESS时，可能会阻碍[SR蛋白](@entry_id:151919)的结合，或通过诱导[RNA结构](@entry_id:144883)变化来隐藏剪接位点，从而导致外显子被跳过。

因此，一个调控模体的功能（增强或抑制）以及其效应的强度，都取决于它相对于邻近 $5'$ 和 $3'$ 剪接位点的精确位置。

#### 语法的非加性：组合效应的力量

剪接语法最有趣的特征之一是其**非加性**。这意味着两个调控元件共同存在时产生的效应，不等于它们各自单独存在时效应的简单相加。这种现象通常源于结合在这些元件上的RBP之间发生了协同或拮抗的相互作用 。

例如，在一个假设的实验中，一个外显子的基线包含水平（$\Psi$ 值）为 $0.20$。单独插入一个ES[E模](@entry_id:160271)体或一个ESS模体，$\Psi$ 值仅轻微变化至 $0.25$ 和 $0.26$。基于加性模型的预测是，两者同时存在时$\Psi$值应约为 $0.32$。然而，实验观察到的$\Psi$值却飙升至 $0.60$。这种巨大的协同增强效应只有在两个模体以特定的间距（例如，相隔 $8$ 个[核苷](@entry_id:195320)酸）和方向排列时才会出现。

这个例子生动地说明了“语法”的存在：模体的身份、组合、间距和方向共同构成了一套规则，只有当规则被满足时，才能触发特定的生物学功能。这揭示了[剪接调控](@entry_id:146064)的深刻复杂性，也对预测模型提出了挑战：模型不仅要能识别单个模体，还必须能理解它们之间的“句法关系”。

### 用[深度学习](@entry_id:142022)模拟剪接密码

深度学习，特别是卷积神经网络（CNN），为学习这种复杂的序列语法提供了强大的工具。

#### 用卷积神经网络检测模体

在将DNA或RNA序列输入模型前，我们通常使用“one-hot”编码将其转换为数值矩阵。例如，一个长度为 $L$ 的序列被表示为一个 $4 \times L$ 的矩阵，其中四行分别代表A, C, G, U(T)。在每个位置，对应核苷酸的行为 $1$，其余为 $0$。

CNN通过“卷积层”来处理这种[序列数据](@entry_id:636380)。每个卷积层包含一组“滤波器”（或称“核”）。每个滤波器本质上是一个小的权重矩阵，它在输入序列上滑动，在每个位置计算一个得分。这个过程在数学上等同于一个可学习的位置权重矩阵（PWM）扫描序列以寻找匹配的模体 。当序列的一个片段与滤波器的权重模式高度匹配时，它会产生一个高的激活值。通过在训练过程中自动优化滤波器权重，CNN的第一层能够学会识别对预测任务至关重要的基础[序列模体](@entry_id:177422)，如剪接位点共识序列、ESE或ESS等。

#### 学习语法和非加性

CNN的能力远不止于检测单个模体。通过堆叠多个卷积层，模型可以学习模体之间的等级关系和空间组合规则  。

*   **[感受野](@entry_id:636171)（Receptive Field）**：在一个多层CNN中，更深层次的神经元能够整合来自前面层次的多个神经元的信息。其在原始输入序列上所能“看到”的区域被称为感受野。对于一个由 $k$ 个卷积层堆叠而成、每层[卷积核](@entry_id:635097)大小为 $s$、步长为 $1$ 的网络，其第 $k$ 层神经元的感受野长度为 $L_k = k(s-1) + 1$。这意味着深层神经元可以同时“看到”由浅层滤波器检测到的、相隔一定距离的多个模体。

*   **[非线性激活函数](@entry_id:635291)**：在每个卷积层之后，都会应用一个[非线性激活函数](@entry_id:635291)（如ReLU）。这是模拟非加性效应的关键。没有非线性，整个[多层网络](@entry_id:270365)将退化为一个单一的线性模型，无法捕捉协同或拮抗作用。正是这些非线性函数使得深层神经元能够学习复杂的逻辑，例如“当且仅当模体A和模体B以距离X出现时，才产生强烈的信号”。这恰好是学习[剪接调控](@entry_id:146064)语法所需要的能力。

### 将剪接预测形式化为机器学习任务

为了构建和训练一个有效的模型，我们必须首先精确定义预测任务，并选择与数据生成过程相匹配的、有统计学依据的[损失函数](@entry_id:136784)。

#### 定义预测任务：从分类到回归

在剪接变异的临床解读中，我们关心两[类核](@entry_id:178267)心问题，它们对应着不同的机器学习任务和所需的序列上下文 [@problem_id:d:4330879]。

1.  **[剪接位点预测](@entry_id:177043)**：这是一个局部的**分类**任务。问题是“一个给定的短序列（例如，包含一个候选`GT`二[核苷](@entry_id:195320)酸的序列）是否是一个功能性的供体位点？”。由于剪接位点的功能主要由其核心序列和非常邻近的区域（如分支点）决定，这个任务通常只需要**较短的序列上下文**（几十到一百个核苷酸）。

2.  **$\Delta\Psi$ 预测**：这是一个定量的**回归**任务。问题是“一个遗传变异会导致一个外显子的包含水平（$\Psi$）发生多大变化？”。由于$\Psi$值是整个复杂调控语法（包括远端增[强子](@entry_id:198809)和[沉默子](@entry_id:169743)）的综合输出，准确预测它需要模型能够评估分布在广阔区域内的所有相关信号。因此，这个任务需要**非常长的序列上下文**（几百到几万个[核苷](@entry_id:195320)酸），覆盖被调控的外显子及其两侧大段的内含子区域。

#### 从第一性原理选择[损失函数](@entry_id:136784)

[损失函数](@entry_id:136784)指导模型的训练。选择不当的[损失函数](@entry_id:136784)可能导致模型学习错误的信号或产生有偏的预测。最佳实践是从数据的统计生成过程出发，选择能最大化数据似然性的[损失函数](@entry_id:136784)（即最小化[负对数似然](@entry_id:637801)） 。

*   **对于分类任务（如[剪接位点预测](@entry_id:177043)）**：数据标签是二元的（$0$或$1$）。其生成过程可以被建模为伯努利分布。对应的[负对数似然](@entry_id:637801)损失是**[二元交叉熵](@entry_id:636868)（Binary Cross-Entropy）**。考虑到剪接位点在基因组中是稀有的（即存在极端类别不平衡），必须使用**[类别加权](@entry_id:635159)的[交叉熵](@entry_id:269529)**，以增加正样本（真实位点）在损失计算中的权重。

*   **对于$\Psi$值回归**：$\Psi$值本身是一个比例，由[RNA-seq](@entry_id:140811)的包含读长数 $k_{\text{incl}}$ 和跳过读长数 $k_{\text{skip}}$ 计算得出。直接在$\Psi$值上使用均方误差（MSE）损失是次优的，因为它忽略了不同观测值的可信度（读长总数 $n=k_{\text{incl}}+k_{\text{skip}}$ 越高，估计越准）。更合理的方法是直接对读长计数进行建模。给定总读长数 $n$ 和真实的$\Psi$值，$k_{\text{incl}}$ 服从[二项分布](@entry_id:141181)。因此，最优的[损失函数](@entry_id:136784)是**二项分布的[负对数似然](@entry_id:637801)**。为了进一步捕捉样本间的生物学变异（过离散），可以使用**Beta-二项分布的[负对数似然](@entry_id:637801)**。

*   **对于序列到图谱的预测**：这是一个更复杂的任务，模型需要预测一个基因组区域内每个碱基位置的读长覆盖数 $c_i$。这里的输出是一个向量 $\mathbf{c}$。一个稳健的方法是将似然分解为两部分：一部分用于预测总读长数 $M = \sum c_i$（例如，在对数尺度上使用[均方误差](@entry_id:175403)），另一部分用于预测读长在各个位置的分布比例 $\mathbf{p}$（例如，使用**[多项分布](@entry_id:189072)的[负对数似然](@entry_id:637801)**，也称为Kullback-Leibler散度）。这种分解能有效地区分[测序深度](@entry_id:178191)变化和真实的信号形状变化。

### 现实世界的挑战：[分布偏移](@entry_id:638064)问题

尽管深度学习模型在剪接预测方面取得了巨大成功，但它们在实际应用中面临一个核心挑战：**[分布偏移](@entry_id:638064)（Distribution Shift）**。当模型的训练数据分布 $P_{\text{train}}(X,Y)$ 与其部署应用的测试数据分布 $P_{\text{test}}(X,Y)$ 不一致时，就会发生[分布偏移](@entry_id:638064)，导致模型性能显著下降 。

在剪接和基因调控的建模中，[分布偏移](@entry_id:638064)以多种形式出现：

*   **概念偏移（Concept Shift）**：$P(Y|X)$ 发生变化。一个典型的例子是将一个仅基于DNA序列（输入 $X$）训练的模型，从一个组织（如肝脏）应用到另一个组织（如大脑）。尽管DNA序列不变，但两个组织中不同的[反式作用因子](@entry_id:265500)环境改变了从序列到剪接结果（输出 $Y$）的生物学规则。模型在肝脏学到的“语法”可能不适用。

*   **[协变量偏移](@entry_id:636196)（Covariate Shift）**：$P(X)$ 发生变化。例如，一个模型在主要由欧洲人群数据构成的[训练集](@entry_id:636396)上训练，然后被用于预测非洲人群的变异效应。由于不同人群之间[等位基因频率](@entry_id:146872)和[连锁不平衡](@entry_id:146203)模式的差异，模型在测试时会遇到大量未曾在训练中见过的基因型组合（即输入 $X$ 的分布不同），即使底层的生物学规律 $P(Y|X)$ 是相同的。

*   **测量偏移（Measurement Shift）**：$P(\tilde{Y}|Y)$ 发生变化，其中 $\tilde{Y}$ 是观测到的标签。例如，模型使用通过poly-A筛选的短读长[RNA-seq](@entry_id:140811)数据训练，但被用于分析通过[核糖体RNA](@entry_id:149305)去除的长读长RNA-seq数据。这两种测序技术有不同的偏好和错误模式，导致从相同的真实剪接水平 $Y$ 中估计出的观测值 $\tilde{Y}$ 的方式不同。即使生物学本身和输入序列都未改变，测量过程的变化也可能误导模型。

理解并应对这些[分布偏移](@entry_id:638064)，是将在研究中表现出色的深度学习模型成功转化为可靠的临床诊断和治疗工具的关键一步。这要求我们在模型设计、训练策略和性能评估中都必须严谨地考虑数据的来源和应用场景的匹配性。