{
    "hands_on_practices": [
        {
            "introduction": "要理解复杂性状的遗传结构，我们首先需要量化单个遗传变异的贡献。本练习将引导您计算单个核苷酸多态性（SNP）对表型方差的解释比例（$R^2$），这是将群体遗传学原理（如哈迪-温伯格平衡）与数量性状分析联系起来的基础。通过这个实践，您将掌握评估单个遗传位点效应大小的核心技能。",
            "id": "4328538",
            "problem": "一项精准医学研究评估了单个核苷酸多态性 (SNP) 在与复杂疾病相关的数量性内表型中能够解释的变异。考虑一个处于哈代-温伯格平衡 (Hardy–Weinberg equilibrium) 状态下的大型随机交配群体。设 SNP 的次要等位基因频率为 $p$，个体的基因型编码为 $X \\in \\{0,1,2\\}$，代表次要等位基因的数量。假设观察到的数量性状表型遵循一个加性遗传模型，\n$$\nY \\;=\\; \\mu \\;+\\; \\beta X \\;+\\; \\varepsilon,\n$$\n其中 $\\mu$ 是一个常数，$\\beta$ 是每个等位基因在观察尺度上的效应，$\\varepsilon$ 是一个残差项，满足 $E[\\varepsilon]=0$ 且独立于 $X$。群体中的总表型方差为 $V_{P} = \\operatorname{Var}(Y)$，它包括遗传和非遗传的变异来源。\n\n仅从上述定义出发，推导出一个用 $p$、$\\beta$ 和 $V_{P}$ 表示的、由 SNP 解释的 $Y$ 的方差比例 $R^{2}$ 的表达式。然后在以下科学上现实的参数值下对其进行评估：\n- $p = 0.30$，\n- $\\beta = 0.10$，\n- $V_{P} = 1.00$。\n\n将您的数值答案四舍五入至四位有效数字，并以小数形式表示（不带百分号）。\n\n此外，同一个 SNP 后来在一个使用病例-对照设计的基因组范围关联研究 (Genome-Wide Association Study, GWAS) 中被分析，用于一个二元疾病结局。设疾病易感性 $L$ 服从标准正态分布，并假设当且仅当 $L$ 超过一个阈值 $t$ 时疾病发生，该阈值 $t$ 的选择使得群体患病率为 $K$，因此 $t = \\Phi^{-1}(1-K)$，其中 $\\Phi$ 是标准正态累积分布函数，$\\phi$ 是其概率密度函数。GWAS 使用了一个选样样本，其中病例比例 $s$ 与 $K$ 不同（为具体起见，假设 $K = 0.05$ 且 $s = 0.50$）。使用易感性-阈值框架以及方差和回归的第一性原理，解释为什么在选样的病例-对照样本中，在观察到的二元尺度上估计的每个等位基因的效应不能直接与群体在易感性尺度上的效应相比较，并展示出关联观察尺度上解释的方差与易感性尺度上解释的方差的比例因子的形式。不要提供比例因子的数值；而是用 $K$、$s$ 和 $t$ 以符号形式写出它。\n\n您最终提交的答案必须是在给定的 $p$、$\\beta$ 和 $V_{P}$ 下，数量性状表型的 $R^{2}$ 的单一数值，并四舍五入到四位有效数字。",
            "solution": "该问题要求进行两个不同的分析。首先，推导并计算在加性模型下，单个核苷酸多态性 (SNP) 对数量性状所能解释的表型方差比例 ($R^2$)。其次，解释在二元性状的病例-对照研究中，观察尺度和易感性尺度上效应量之间的关系。\n\n**第一部分：数量性状中解释的方差**\n\n由 SNP 解释的表型 $Y$ 的方差比例（表示为 $R^2$）是由于 SNP 引起的遗传方差 $V_G$ 与总表型方差 $V_P$ 的比值。\n$$\nR^2 = \\frac{V_G}{V_P}\n$$\n表型由加性模型 $Y = \\mu + \\beta X + \\varepsilon$ 给出，其中 $X$ 是编码为次要等位基因数量的基因型，$\\varepsilon$ 是一个独立的残差项。因此，总表型方差为：\n$$\nV_P = \\operatorname{Var}(Y) = \\operatorname{Var}(\\mu + \\beta X + \\varepsilon)\n$$\n由于 $\\mu$ 是一个常数，且 $X$ 和 $\\varepsilon$ 是独立的，所以和的方差是方差的和：\n$$\n\\operatorname{Var}(Y) = \\operatorname{Var}(\\beta X) + \\operatorname{Var}(\\varepsilon) = \\beta^2 \\operatorname{Var}(X) + \\operatorname{Var}(\\varepsilon)\n$$\n遗传方差分量 $V_G$ 是可归因于基因型 $X$ 的那部分方差，即 $\\operatorname{Var}(\\beta X)$。\n$$\nV_G = \\operatorname{Var}(\\beta X) = \\beta^2 \\operatorname{Var}(X)\n$$\n因此，$R^2$ 的表达式为：\n$$\nR^2 = \\frac{\\beta^2 \\operatorname{Var}(X)}{V_P}\n$$\n为了完成这个表达式，我们必须求出基因型变量的方差 $\\operatorname{Var}(X)$。该群体处于哈代-温伯格平衡 (HWE) 状态，次要等位基因频率为 $p$。基因型 $X=0$、$X=1$ 和 $X=2$ 的频率分别为：\n\\begin{itemize}\n    \\item $P(X=0) = (1-p)^2$\n    \\item $P(X=1) = 2p(1-p)$\n    \\item $P(X=2) = p^2$\n\\end{itemize}\n$X$ 的方差由 $\\operatorname{Var}(X) = E[X^2] - (E[X])^2$ 给出。首先，我们计算 $X$ 的期望值：\n$$\nE[X] = \\sum_{i=0}^{2} i \\cdot P(X=i) = (0)(1-p)^2 + (1)(2p(1-p)) + (2)(p^2)\n$$\n$$\nE[X] = 2p - 2p^2 + 2p^2 = 2p\n$$\n接下来，我们计算 $X^2$ 的期望值：\n$$\nE[X^2] = \\sum_{i=0}^{2} i^2 \\cdot P(X=i) = (0)^2(1-p)^2 + (1)^2(2p(1-p)) + (2)^2(p^2)\n$$\n$$\nE[X^2] = 2p(1-p) + 4p^2 = 2p - 2p^2 + 4p^2 = 2p + 2p^2\n$$\n现在，我们可以求出 $X$ 的方差：\n$$\n\\operatorname{Var}(X) = E[X^2] - (E[X])^2 = (2p + 2p^2) - (2p)^2 = 2p + 2p^2 - 4p^2 = 2p - 2p^2\n$$\n$$\n\\operatorname{Var}(X) = 2p(1-p)\n$$\n这是一个处于 HWE 状态下的二等位基因座上等位基因计数的方差的标准结果。将此结果代入 $R^2$ 的表达式，我们得到通用公式：\n$$\nR^2 = \\frac{2p(1-p)\\beta^2}{V_P}\n$$\n现在，我们使用给定的参数值来评估这个表达式：$p = 0.30$，$\\beta = 0.10$，以及 $V_P = 1.00$。\n$$\nR^2 = \\frac{2(0.30)(1-0.30)(0.10)^2}{1.00}\n$$\n$$\nR^2 = \\frac{2(0.30)(0.70)(0.01)}{1.00}\n$$\n$$\nR^2 = (0.60)(0.70)(0.01) = 0.42 \\times 0.01 = 0.0042\n$$\n四舍五入到四位有效数字，结果是 $0.004200$。\n\n**第二部分：病例-对照研究和易感性尺度**\n\n在针对二元疾病结局的基因组范围关联研究 (GWAS) 的背景下，SNP 的效应通常是在病例-对照状态的观察尺度上估计的（病例编码为 $1$，对照编码为 $0$）。由于两个主要原因——尺度变化和选样偏倚，这个估计出的效应不能直接与 SNP 在潜在的、未观察到的易感性尺度上的真实效应相比较。\n\n1.  **易感性-阈值模型和尺度变化**：该模型假设存在一个连续的易感性 $L$，它在群体中服从标准正态分布 ($L \\sim N(0,1)$)。如果一个人的易感性超过阈值 $t$，则其为病例。SNP 的真实效应，我们可称之为 $\\beta_{liability}$，是对 $L$ 的一个线性效应。然而，使用逻辑回归的 GWAS 估计的是一个比值比（或对数比值比 $\\beta_{observed}$），它描述的是对二元结局的效应。从连续的易感性尺度到二元疾病尺度的转换是非线性的，由阈值操作 $I(L>t)$ 定义。易感性尺度上的效应与结局概率（以及比值比）上的效应之间的关系，取决于标准正态概率密度函数 $\\phi(\\cdot)$ 在阈值 $t$ 处的值。\n\n2.  **选样偏倚**：病例-对照研究并非从群体中随机抽样。根据设计，病例（易感性高，$L>t$）和对照（易感性较低，$L \\le t$）相对于其在群体中的患病率被过采样。样本中的病例比例 $s$ 通常远大于群体疾病患病率 $K$（例如，$s=0.50$ 对比 $K=0.05$）。与普通人群相比，这种选样过程富集了病例组中的风险等位基因和对照组中的保护性等位基因，从而改变了样本内的等位基因频率和易感性分布。因此，在这个选样样本中估计的效应量若不进行校正，则无法反映其在普通人群中的效应量。\n\n由于这些因素，在病例-对照样本中，在观察到的 0/1 尺度上解释的方差 ($R^2_{obs}$) 不等于在群体中，在易感性尺度上解释的方差 ($R^2_{liab}$)。然而，可以从正态分布截断的原理推导出一个比例因子，用于在这两个量之间进行转换。其关系由下式给出：\n$$\nR^2_{liab} \\approx R^2_{obs} \\times C\n$$\n其中 C 是比例因子。这个因子的既定形式，用于将观察尺度上的方差比例转换为易感性尺度上的方差比例，是：\n$$\nC = \\frac{K^2(1-K)^2}{s(1-s)\\phi(t)^2}\n$$\n此处，$K$ 是群体患病率，$s$ 是样本中的病例比例，$\\phi(t)$ 是标准正态概率密度函数在易感性阈值 $t$ 处的高度，其中 $t=\\Phi^{-1}(1-K)$。该因子正确地考虑了尺度变化和病例-对照选样方案。\n\n最终需要的答案是第一部分的数值结果。",
            "answer": "$$\\boxed{0.004200}$$"
        },
        {
            "introduction": "在全基因组数据普及之前，遗传学家通过分析亲缘间的表型相似性来估算性状的遗传力。本练习回归经典的数量遗传学方法，通过亲代-子代回归来估算狭义遗传力（$h^2$）。此方法不仅揭示了遗传力的核心定义，还强调了在实际研究中必须考虑的现实因素，例如测量误差如何影响估算结果。",
            "id": "4328507",
            "problem": "在一项旨在实现精准医疗和基因组诊断的基于人群的生物样本库研究中，考虑一个复杂的数量性状，例如成人收缩压。假设存在加性多基因结构和随机交配，无选择性交配，并忽略显性、上位性、代际共享环境协方差以及基因-环境相关性。设狭义遗传力定义为 $h^{2} = V_{A} / V_{P}$，其中 $V_{A}$ 是加性遗传方差，$V_{P}$ 是总表型方差。\n\n使用观察到的亲代中值表型作为预测变量，子代表型作为响应变量，进行亲代中值-子代回归分析。设 $Y_{f}^{\\mathrm{true}}$ 和 $Y_{m}^{\\mathrm{true}}$ 表示真实的亲代表型，$Y_{f}^{\\mathrm{obs}} = Y_{f}^{\\mathrm{true}} + e_{f}$，$Y_{m}^{\\mathrm{obs}} = Y_{m}^{\\mathrm{true}} + e_{m}$ 为其观测值，其中 $e_{f}$ 和 $e_{m}$ 是独立的经典测量误差，均值为零，方差为 $\\sigma_{e}^{2}$，且与所有真实表型独立。真实亲代中值为 $M^{\\mathrm{true}} = \\frac{Y_{f}^{\\mathrm{true}} + Y_{m}^{\\mathrm{true}}}{2}$，观测亲代中值为 $M^{\\mathrm{obs}} = \\frac{Y_{f}^{\\mathrm{obs}} + Y_{m}^{\\mathrm{obs}}}{2} = M^{\\mathrm{true}} + \\varepsilon_{M}$，其中 $\\varepsilon_{M} = \\frac{e_{f} + e_{m}}{2}$。子代表型 $Y_{o}$ 的测量误差可忽略不计。在数据集中，子代对观测亲代中值的普通最小二乘法回归斜率为 $b = 0.45$。独立的重测信度研究表明，单个亲本的重测信度（定义为 $\\mathrm{Var}(Y^{\\mathrm{true}})/\\mathrm{Var}(Y^{\\mathrm{obs}})$）为 $r_{p} = 0.80$。\n\n从核心数量遗传学定义和谱系中协方差的性质出发，推导子代对真实亲代中值的回归斜率与 $h^{2}$ 之间的关系，然后推导亲本的经典测量误差如何削弱观测斜率。利用这些推导，计算该数据集经测量误差校正的狭义遗传力 $h^{2}$，并报告一个单一的数值。无需四舍五入。",
            "solution": "该问题要求计算经亲代表型测量误差校正后的狭义遗传力 $h^2$。解答将按照题目要求分三步进行：首先，推导真实亲代中值-子代回归斜率与 $h^2$ 之间的关系；其次，推导测量误差对该斜率的削弱作用；最后，应用这些推导，根据所提供的数据计算 $h^2$。\n\n如题所述，忽略显性和上位性，数量性状表型的基本模型为 $Y^{\\mathrm{true}} = A + E_{u}$，其中 $A$ 是加性遗传值，$E_{u}$ 是特殊环境因素。总表型方差为 $V_P = \\mathrm{Var}(Y^{\\mathrm{true}}) = \\mathrm{Var}(A) + \\mathrm{Var}(E_{u}) = V_A + V_E$。狭义遗传力定义为 $h^2 = V_A / V_P$。\n\n**1. 子代表型对真实亲代中值的回归**\n\n响应变量 $Y$ 对预测变量 $X$ 的简单线性回归斜率由 $\\beta_{Y|X} = \\frac{\\mathrm{Cov}(X, Y)}{\\mathrm{Var}(X)}$ 给出。在这里，响应变量是子代表型 $Y_o$，预测变量是真实亲代中值表型 $M^{\\mathrm{true}} = \\frac{Y_{f}^{\\mathrm{true}} + Y_{m}^{\\mathrm{true}}}{2}$。子代的表型测量误差可忽略不计，因此我们将其表示为 $Y_o$。该斜率，我们称之为 $\\beta^{\\mathrm{true}}$，是：\n$$\n\\beta^{\\mathrm{true}} = \\frac{\\mathrm{Cov}(Y_o, M^{\\mathrm{true}})}{\\mathrm{Var}(M^{\\mathrm{true}})}\n$$\n我们必须计算分子中的协方差和分母中的方差。\n\n分子：$\\mathrm{Cov}(Y_o, M^{\\mathrm{true}})$\n根据 $M^{\\mathrm{true}}$ 的定义和协方差的性质：\n$$\n\\mathrm{Cov}(Y_o, M^{\\mathrm{true}}) = \\mathrm{Cov}\\left(Y_o, \\frac{Y_{f}^{\\mathrm{true}} + Y_{m}^{\\mathrm{true}}}{2}\\right) = \\frac{1}{2} \\left[ \\mathrm{Cov}(Y_o, Y_{f}^{\\mathrm{true}}) + \\mathrm{Cov}(Y_o, Y_{m}^{\\mathrm{true}}) \\right]\n$$\n子代与单个亲本（例如，父亲）之间的协方差为 $\\mathrm{Cov}(Y_o, Y_{f}^{\\mathrm{true}})$。在问题的假设下（代际间无共享环境，纯加性遗传），该协方差等于它们加性遗传值之间的协方差：$\\mathrm{Cov}(Y_o, Y_{f}^{\\mathrm{true}}) = \\mathrm{Cov}(A_o, A_f)$。子女从每个亲本处随机获得一半的等位基因，因此亲子间加性遗传值的协方差为 $\\frac{1}{2}V_A$。因此：\n$$\n\\mathrm{Cov}(Y_o, Y_{f}^{\\mathrm{true}}) = \\mathrm{Cov}(Y_o, Y_{m}^{\\mathrm{true}}) = \\frac{1}{2}V_A\n$$\n将此代入与亲代中值协方差的表达式中：\n$$\n\\mathrm{Cov}(Y_o, M^{\\mathrm{true}}) = \\frac{1}{2} \\left( \\frac{1}{2}V_A + \\frac{1}{2}V_A \\right) = \\frac{1}{2}V_A\n$$\n\n分母：$\\mathrm{Var}(M^{\\mathrm{true}})$\n根据 $M^{\\mathrm{true}}$ 的定义和方差的性质：\n$$\n\\mathrm{Var}(M^{\\mathrm{true}}) = \\mathrm{Var}\\left(\\frac{Y_{f}^{\\mathrm{true}} + Y_{m}^{\\mathrm{true}}}{2}\\right) = \\frac{1}{4} \\mathrm{Var}(Y_{f}^{\\mathrm{true}} + Y_{m}^{\\mathrm{true}}) = \\frac{1}{4} \\left[ \\mathrm{Var}(Y_{f}^{\\mathrm{true}}) + \\mathrm{Var}(Y_{m}^{\\mathrm{true}}) + 2\\mathrm{Cov}(Y_{f}^{\\mathrm{true}}, Y_{m}^{\\mathrm{true}}) \\right]\n$$\n亲本来自同一群体，因此 $\\mathrm{Var}(Y_{f}^{\\mathrm{true}}) = \\mathrm{Var}(Y_{m}^{\\mathrm{true}}) = V_P$。问题指明了随机交配且无选择性交配，这意味着双亲的表型不相关：$\\mathrm{Cov}(Y_{f}^{\\mathrm{true}}, Y_{m}^{\\mathrm{true}}) = 0$。因此：\n$$\n\\mathrm{Var}(M^{\\mathrm{true}}) = \\frac{1}{4} (V_P + V_P + 0) = \\frac{2V_P}{4} = \\frac{1}{2}V_P\n$$\n\n结合分子和分母，真实的回归斜率为：\n$$\n\\beta^{\\mathrm{true}} = \\frac{\\frac{1}{2}V_A}{\\frac{1}{2}V_P} = \\frac{V_A}{V_P} = h^2\n$$\n这就得出了经典的数量遗传学结论：子代表型对真实亲代中值表型的回归斜率等于狭义遗传力。\n\n**2. 测量误差对斜率的削弱**\n\n观测回归是 $Y_o$ 对观测亲代中值表型 $M^{\\mathrm{obs}} = \\frac{Y_{f}^{\\mathrm{obs}} + Y_{m}^{\\mathrm{obs}}}{2}$ 的回归。观测斜率（给定为 $b=0.45$）是：\n$$\nb = \\frac{\\mathrm{Cov}(Y_o, M^{\\mathrm{obs}})}{\\mathrm{Var}(M^{\\mathrm{obs}})}\n$$\n我们分别分析测量误差对分子和分母的影响。观测表型为 $Y_{f}^{\\mathrm{obs}} = Y_{f}^{\\mathrm{true}} + e_{f}$ 和 $Y_{m}^{\\mathrm{obs}} = Y_{m}^{\\mathrm{true}} + e_{m}$。观测亲代中值为 $M^{\\mathrm{obs}} = M^{\\mathrm{true}} + \\varepsilon_M$，其中 $\\varepsilon_M = \\frac{e_f + e_m}{2}$。\n\n分子：$\\mathrm{Cov}(Y_o, M^{\\mathrm{obs}})$\n$$\n\\mathrm{Cov}(Y_o, M^{\\mathrm{obs}}) = \\mathrm{Cov}(Y_o, M^{\\mathrm{true}} + \\varepsilon_M) = \\mathrm{Cov}(Y_o, M^{\\mathrm{true}}) + \\mathrm{Cov}(Y_o, \\varepsilon_M)\n$$\n测量误差 $e_f$ 和 $e_m$ 与包括 $Y_o$ 在内的所有真实表型独立。因此，它们的平均值 $\\varepsilon_M$ 也与 $Y_o$ 独立，这意味着 $\\mathrm{Cov}(Y_o, \\varepsilon_M) = 0$。分子不受测量误差影响：\n$$\n\\mathrm{Cov}(Y_o, M^{\\mathrm{obs}}) = \\mathrm{Cov}(Y_o, M^{\\mathrm{true}}) = \\frac{1}{2}V_A\n$$\n\n分母：$\\mathrm{Var}(M^{\\mathrm{obs}})$\n$$\n\\mathrm{Var}(M^{\\mathrm{obs}}) = \\mathrm{Var}(M^{\\mathrm{true}} + \\varepsilon_M) = \\mathrm{Var}(M^{\\mathrm{true}}) + \\mathrm{Var}(\\varepsilon_M) + 2\\mathrm{Cov}(M^{\\mathrm{true}}, \\varepsilon_M)\n$$\n由于误差与真实表型独立，$\\mathrm{Cov}(M^{\\mathrm{true}}, \\varepsilon_M) = 0$。误差项 $\\varepsilon_M$ 的方差为：\n$$\n\\mathrm{Var}(\\varepsilon_M) = \\mathrm{Var}\\left(\\frac{e_f + e_m}{2}\\right) = \\frac{1}{4}\\mathrm{Var}(e_f + e_m)\n$$\n由于 $e_f$ 和 $e_m$ 是独立的，方差为 $\\sigma_e^2$，因此 $\\mathrm{Var}(e_f + e_m) = \\mathrm{Var}(e_f) + \\mathrm{Var}(e_m) = \\sigma_e^2 + \\sigma_e^2 = 2\\sigma_e^2$。\n$$\n\\mathrm{Var}(\\varepsilon_M) = \\frac{1}{4}(2\\sigma_e^2) = \\frac{1}{2}\\sigma_e^2\n$$\n观测亲代中值的总方差为：\n$$\n\\mathrm{Var}(M^{\\mathrm{obs}}) = \\mathrm{Var}(M^{\\mathrm{true}}) + \\mathrm{Var}(\\varepsilon_M) = \\frac{1}{2}V_P + \\frac{1}{2}\\sigma_e^2 = \\frac{1}{2}(V_P + \\sigma_e^2)\n$$\n因此，观测回归斜率 $b$ 为：\n$$\nb = \\frac{\\frac{1}{2}V_A}{\\frac{1}{2}(V_P + \\sigma_e^2)} = \\frac{V_A}{V_P + \\sigma_e^2}\n$$\n这可以改写为以 $h^2$ 表示的形式：\n$$\nb = \\frac{V_A/V_P}{(V_P + \\sigma_e^2)/V_P} = \\frac{h^2}{1 + \\sigma_e^2/V_P}\n$$\n这个表达式显示了真实斜率 $h^2$ 被一个与测量误差方差相关的因子所削弱。\n\n**3. 校正后遗传力的计算**\n\n为了求解 $h^2$，我们必须找到削弱因子的值。问题提供了单个亲本的重测信度 $r_p = 0.80$，定义为：\n$$\nr_p = \\frac{\\mathrm{Var}(Y^{\\mathrm{true}})}{\\mathrm{Var}(Y^{\\mathrm{obs}})}\n$$\n对于单个亲本，$\\mathrm{Var}(Y^{\\mathrm{true}}) = V_P$。观测方差为 $\\mathrm{Var}(Y^{\\mathrm{obs}}) = \\mathrm{Var}(Y^{\\mathrm{true}} + e) = \\mathrm{Var}(Y^{\\mathrm{true}}) + \\mathrm{Var}(e) = V_P + \\sigma_e^2$。因此，\n$$\nr_p = \\frac{V_P}{V_P + \\sigma_e^2}\n$$\n现在，我们来考察观测斜率 $b$ 表达式中的削弱因子：\n$$\nb = \\frac{V_A}{V_P + \\sigma_e^2} = \\left(\\frac{V_A}{V_P}\\right) \\left(\\frac{V_P}{V_P + \\sigma_e^2}\\right) = h^2 \\cdot r_p\n$$\n这个关系非常简单：观测斜率是狭义遗传力与单个亲本测量信度的乘积。这是因为计算亲代中值的过程将信号方差（$\\mathrm{Var}(M^{\\mathrm{true}}) = V_P/2$）和噪声方差（$\\mathrm{Var}(\\varepsilon_M) = \\sigma_e^2/2$）都按相同的因子 $1/2$ 进行了缩放，从而使其比率（即信度）保持不变。亲代中值预测变量的信度为 $r_M = \\frac{\\mathrm{Var}(M^{\\mathrm{true}})}{\\mathrm{Var}(M^{\\mathrm{obs}})} = \\frac{V_P/2}{(V_P + \\sigma_e^2)/2} = \\frac{V_P}{V_P + \\sigma_e^2} = r_p$。\n\n给定 $b = 0.45$ 和 $r_p = 0.80$。我们现在可以求解 $h^2$：\n$$\nh^2 = \\frac{b}{r_p} = \\frac{0.45}{0.80}\n$$\n$$\nh^2 = \\frac{45/100}{80/100} = \\frac{45}{80} = \\frac{9}{16}\n$$\n将此分数转换为小数即可得到最终的数值答案。\n$$\nh^2 = 0.5625\n$$",
            "answer": "$$\\boxed{0.5625}$$"
        },
        {
            "introduction": "随着全基因组关联研究（GWAS）的兴起，我们获得了从全基因组层面估算遗传力的新工具。本练习介绍连锁不平衡分数回归（LD Score Regression），这是一种仅利用GWAS摘要统计数据就能估算所有已测SNP解释的遗传力（$h^{2}_{\\text{SNP}}$）的强大技术。掌握此方法对于解读大规模遗传学研究的发现至关重要，它能有效地区分真实的多基因信号与潜在的混杂因素。",
            "id": "4328524",
            "problem": "一个研究团队在加性多基因模型下，对一个单位方差的连续性状进行大规模全基因组关联研究（GWAS）。基因型经过标准化，使得每个单核苷酸多态性（SNP）基因型的均值为零、方差为一；表型也经过标准化，使其均值为零、方差为一。该团队计划使用连锁不平衡（LD）得分回归（LDSC）来估计单核苷酸多态性遗传力（表示为 $h^{2}_{\\text{SNP}}$），其中SNP $j$ 的连锁不平衡（LD）得分 $\\ell_{j}$ 定义为该SNP与其他所有已分型SNP的平方相关系数之和。假设LD得分回归满足以下标准条件：加性遗传效应、全基因组范围内SNP效应量微小且近似独立、效应量与局部LD无关、混杂因素可忽略不计以使回归截距等于零期望，以及均质抽样以使抽样方差贡献其规范零项。\n\n从加性模型和 $h^{2}_{\\text{SNP}}$（定义为所有已分型SNP解释的表型方差比例）出发，推导一个表达式，将所有SNP的关联$\\chi^{2}$统计量的期望均值与 $h^{2}_{\\text{SNP}}$、样本量 $N$、SNP数量 $M$ 以及平均LD得分 $\\bar{\\ell}$ 联系起来。然后，使用GWAS荟萃分析提供的摘要统计数据——平均$\\chi^{2}$统计量 $\\overline{\\chi^{2}} = 1.30$、样本量 $N = 200{,}000$、平均LD得分 $\\bar{\\ell} = 100$ 和SNP数量 $M = 1{,}000{,}000$——在所述假设下计算 $h^{2}_{\\text{SNP}}$。\n\n请用小数表示最终答案。除精确计算外，无需进行四舍五入。",
            "solution": "任务分为两部分：首先，推导平均卡方（$\\chi^2$）统计量、SNP遗传力（$h^{2}_{\\text{SNP}}$）、样本量（$N$）、SNP数量（$M$）和平均LD得分（$\\bar{\\ell}$）之间的理论关系；其次，使用所提供的数据计算 $h^{2}_{\\text{SNP}}$。\n\n**第1部分：LD得分回归方程的推导**\n\n我们从一个包含 $N$ 个个体的样本中表型 $y$ 的标准加性线性模型开始。个体 $i$ 的表型由下式给出：\n$$\ny_i = \\sum_{j=1}^{M} X_{ij} \\beta_j + \\epsilon_i\n$$\n其中 $M$ 是已分型SNP的数量，$X_{ij}$ 是个体 $i$ 在SNP $j$ 处的标准化基因型，$\\beta_j$ 是SNP $j$ 的真实加性遗传效应，$\\epsilon_i$ 是个体 $i$ 的非遗传成分（环境效应和噪声）。\n\n问题陈述指出表型和基因型都经过了标准化。这意味着：\n- 表型：$\\mathbb{E}[y_i] = 0$ 且 $\\text{Var}(y) = 1$。\n- 基因型：对于每个SNP $j$，在 $N$ 个个体中，$\\mathbb{E}[X_{ij}] = 0$ 且 $\\text{Var}(X_j) = 1$。\n\nSNP遗传力 $h^{2}_{\\text{SNP}}$ 定义为所有已分型SNP解释的表型方差比例。由于 $\\text{Var}(y)=1$，我们有：\n$$\nh^{2}_{\\text{SNP}} = \\text{Var}\\left(\\sum_{j=1}^{M} X_{ij} \\beta_j\\right)\n$$\nLDSC中使用的多基因模型的核心假设是，效应量 $\\beta_j$ 是从一个均值为 $0$、方差为 $\\mathbb{E}[\\beta_j^2] = \\frac{h^{2}_{\\text{SNP}}}{M}$ 的分布中独立抽取的随机变量。这确保了如果所有SNP都处于连锁平衡状态（不相关），总遗传方差将为 $\\sum_{j=1}^{M} \\text{Var}(\\beta_j) \\text{Var}(X_j) = M \\times \\frac{h^{2}_{\\text{SNP}}}{M} \\times 1 = h^{2}_{\\text{SNP}}$。\n\n在GWAS中，我们使用简单线性回归来估计每个SNP $j$ 的边际效应。对于标准化变量，估计的效应量 $\\hat{\\beta}_j$ 是基因型 $X_j$ 和表型 $y$ 之间的样本相关性：\n$$\n\\hat{\\beta}_j = \\frac{1}{N} \\sum_{i=1}^{N} X_{ij} y_i\n$$\n将 $y_i$ 的真实模型代入：\n$$\n\\hat{\\beta}_j = \\frac{1}{N} \\sum_{i=1}^{N} X_{ij} \\left( \\sum_{k=1}^{M} X_{ik} \\beta_k + \\epsilon_i \\right) = \\sum_{k=1}^{M} \\left( \\frac{1}{N} \\sum_{i=1}^{N} X_{ij} X_{ik} \\right) \\beta_k + \\frac{1}{N} \\sum_{i=1}^{N} X_{ij} \\epsilon_i\n$$\n项 $\\frac{1}{N} \\sum_{i=1}^{N} X_{ij} X_{ik}$ 是SNP $j$ 和SNP $k$ 之间的样本相关性，记为 $r_{jk}$。第二项代表抽样噪声。因此，我们可以写成：\n$$\n\\hat{\\beta}_j = \\sum_{k=1}^{M} r_{jk} \\beta_k + e_j\n$$\n其中 $e_j = \\frac{1}{N} \\sum_{i=1}^{N} X_{ij} \\epsilon_i$。\n\nSNP $j$ 的关联检验统计量通常是一个z分数，$Z_j = \\frac{\\hat{\\beta}_j}{\\text{SE}(\\hat{\\beta}_j)}$。对于大样本量 $N$ 和标准化变量，效应估计的标准误约为 $\\text{SE}(\\hat{\\beta}_j) \\approx \\frac{1}{\\sqrt{N}}$。$\\chi^2$统计量是z分数的平方：$\\chi^2_j = Z_j^2 \\approx N \\hat{\\beta}_j^2$。\n$$\n\\chi^2_j \\approx N \\left( \\sum_{k=1}^{M} r_{jk} \\beta_k + e_j \\right)^2 = N \\left( \\sum_{k=1}^{M} r_{jk} \\beta_k \\right)^2 + 2N e_j \\left( \\sum_{k=1}^{M} r_{jk} \\beta_k \\right) + N e_j^2\n$$\n我们感兴趣的是该统计量的期望值 $\\mathbb{E}[\\chi^2_j]$，其中期望是针对真实效应 $\\beta_k$ 的分布和个体抽样（它决定了 $e_j$）来计算的。\n$$\n\\mathbb{E}[\\chi^2_j] = \\mathbb{E}\\left[N \\left( \\sum_{k=1}^{M} r_{jk} \\beta_k \\right)^2\\right] + 2N \\mathbb{E}\\left[e_j \\left( \\sum_{k=1}^{M} r_{jk} \\beta_k \\right)\\right] + \\mathbb{E}[N e_j^2]\n$$\n遗传效应 $\\beta_k$ 被假定与非遗传成分 $\\epsilon_i$ 独立，因此也与抽样噪声 $e_j$ 独立。所以，交叉项为零：$\\mathbb{E}[e_j (\\dots)] = \\mathbb{E}[e_j]\\mathbb{E}[(\\dots)] = 0$。\n\n让我们评估剩下的两项。\n第一项是来自遗传和LD的贡献：\n$$\n\\mathbb{E}\\left[N \\left( \\sum_{k=1}^{M} r_{jk} \\beta_k \\right)^2\\right] = N \\mathbb{E}\\left[ \\left(\\sum_k r_{jk} \\beta_k\\right) \\left(\\sum_m r_{jm} \\beta_m\\right) \\right] = N \\sum_{k,m} r_{jk} r_{jm} \\mathbb{E}[\\beta_k \\beta_m]\n$$\n由于不同SNP的效应量是独立的，对于 $k \\neq m$，有 $\\mathbb{E}[\\beta_k \\beta_m] = 0$。因此，我们只考虑 $k = m$ 的项。使用 $\\mathbb{E}[\\beta_k^2] = \\frac{h^{2}_{\\text{SNP}}}{M}$：\n$$\nN \\sum_{k=1}^{M} r_{jk}^2 \\mathbb{E}[\\beta_k^2] = N \\sum_{k=1}^{M} r_{jk}^2 \\left(\\frac{h^{2}_{\\text{SNP}}}{M}\\right) = N \\frac{h^{2}_{\\text{SNP}}}{M} \\sum_{k=1}^{M} r_{jk}^2\n$$\nSNP $j$ 的LD得分定义为 $\\ell_j = \\sum_{k=1}^{M} r_{jk}^2$。因此该项变为 $N \\frac{h^{2}_{\\text{SNP}}}{M} \\ell_j$。\n\n第二项是来自抽样方差的贡献，$\\mathbb{E}[N e_j^2]$。问题指明了“均质抽样以使抽样方差贡献其规范零项”。在无遗传效应的零假设下（所有 $j$ 的 $\\beta_j = 0$），单个检验的 $\\chi^2$ 统计量服从一个自由度为1的 $\\chi^2$ 分布，其期望值为 $1$。因此，由抽样噪声对期望$\\chi^2$统计量的贡献为 $1$。\n\n合并各项，单个SNP $j$ 的期望$\\chi^2$统计量为：\n$$\n\\mathbb{E}[\\chi^2_j] = N \\frac{h^{2}_{\\text{SNP}}}{M} \\ell_j + 1\n$$\n该方程构成了LD得分回归的基础，即观测到的$\\chi^2_j$统计量对其预先计算的LD得分$\\ell_j$进行回归。问题要求得到涉及*平均*$\\chi^2$统计量 $\\overline{\\chi^2}$ 的关系。我们通过对所有 $M$ 个SNP的上述表达式求平均来得到：\n$$\n\\mathbb{E}[\\overline{\\chi^2}] = \\mathbb{E}\\left[\\frac{1}{M}\\sum_{j=1}^{M} \\chi^2_j\\right] = \\frac{1}{M}\\sum_{j=1}^{M} \\mathbb{E}[\\chi^2_j] = \\frac{1}{M}\\sum_{j=1}^{M} \\left(N \\frac{h^{2}_{\\text{SNP}}}{M} \\ell_j + 1\\right)\n$$\n$$\n\\mathbb{E}[\\overline{\\chi^2}] = \\frac{N h^{2}_{\\text{SNP}}}{M^2} \\sum_{j=1}^{M} \\ell_j + \\frac{1}{M}\\sum_{j=1}^{M} 1 = \\frac{N h^{2}_{\\text{SNP}}}{M} \\left(\\frac{1}{M}\\sum_{j=1}^{M} \\ell_j\\right) + 1\n$$\n认识到 $\\bar{\\ell} = \\frac{1}{M}\\sum_{j=1}^{M} \\ell_j$ 是平均LD得分，我们得到最终的推导表达式：\n$$\n\\mathbb{E}[\\overline{\\chi^2}] = \\frac{N h^{2}_{\\text{SNP}}}{M} \\bar{\\ell} + 1\n$$\n\n**第2部分：$h^{2}_{\\text{SNP}}$的计算**\n\n我们使用观测到的平均$\\chi^2$统计量 $\\overline{\\chi^2} = 1.30$ 作为其期望 $\\mathbb{E}[\\overline{\\chi^2}]$ 的估计值。现在我们可以求解 $h^{2}_{\\text{SNP}}$：\n$$\n\\overline{\\chi^2} = \\frac{N \\bar{\\ell}}{M} h^{2}_{\\text{SNP}} + 1\n$$\n$$\n\\overline{\\chi^2} - 1 = \\frac{N \\bar{\\ell}}{M} h^{2}_{\\text{SNP}}\n$$\n$$\nh^{2}_{\\text{SNP}} = \\frac{M (\\overline{\\chi^2} - 1)}{N \\bar{\\ell}}\n$$\n提供的摘要统计数据是：\n- $\\overline{\\chi^2} = 1.30$\n- $N = 200{,}000 = 2 \\times 10^5$\n- $\\bar{\\ell} = 100 = 10^2$\n- $M = 1{,}000{,}000 = 10^6$\n\n将这些值代入 $h^{2}_{\\text{SNP}}$ 的表达式中：\n$$\nh^{2}_{\\text{SNP}} = \\frac{1{,}000{,}000 \\times (1.30 - 1)}{200{,}000 \\times 100}\n$$\n$$\nh^{2}_{\\text{SNP}} = \\frac{10^6 \\times 0.30}{(2 \\times 10^5) \\times 10^2}\n$$\n$$\nh^{2}_{\\text{SNP}} = \\frac{0.30 \\times 10^6}{2 \\times 10^7}\n$$\n$$\nh^{2}_{\\text{SNP}} = \\frac{0.30}{2 \\times 10^{7-6}} = \\frac{0.30}{2 \\times 10^1} = \\frac{0.30}{20}\n$$\n$$\nh^{2}_{\\text{SNP}} = 0.015\n$$\n估计的SNP遗传力为 $0.015$，即 $1.5\\%$。",
            "answer": "$$\n\\boxed{0.015}\n$$"
        }
    ]
}