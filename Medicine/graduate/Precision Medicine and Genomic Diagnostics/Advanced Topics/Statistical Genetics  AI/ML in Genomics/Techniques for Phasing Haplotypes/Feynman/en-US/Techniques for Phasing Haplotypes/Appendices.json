{
    "hands_on_practices": [
        {
            "introduction": "Haplotype phasing relies on interpreting noisy evidence from sequencing reads, where each read provides a clue about which variants co-occur on the same chromosome. This practice demonstrates how to formalize this process using Bayesian inference, integrating Phred quality scores from multiple long reads to calculate the posterior probability of a *cis* versus *trans* configuration. Mastering this allows you to quantify the confidence in a phase call based on the underlying quality of the sequencing data .",
            "id": "4388611",
            "problem": "Two Single-Nucleotide Variants (SNVs) within the same gene are separated by 2 kilobases (kb). Three independent long-read molecules span both SNVs and each provides a per-read phase assignment (concordant indicates the two variants are on the same haplotype, discordant indicates they are on opposite haplotypes). One read is discordant with Phred quality score $Q=20$, and two reads are concordant, each with Phred quality score $Q=30$. Assume that the per-read phasing error probability follows the Phred definition $p_{\\mathrm{err}}=10^{-Q/10}$, that read errors are independent across molecules, and that there is no within-read switch error over 2 kb for these molecules. Let the prior probabilities be $P(\\text{cis})=P(\\text{trans})=\\frac{1}{2}$. Using Bayes’ rule and these assumptions, compute the posterior probability that the two SNVs are in *cis* given these three reads. Express your final answer as a decimal and round to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- Two Single-Nucleotide Variants (SNVs) are separated by a distance of 2 kilobases (kb).\n- There are three independent long-read molecules spanning both SNVs.\n- Read 1 is discordant with a Phred quality score of $Q=20$.\n- Read 2 is concordant with a Phred quality score of $Q=30$.\n- Read 3 is concordant with a Phred quality score of $Q=30$.\n- A concordant read indicates the two variants are on the same haplotype. This corresponds to the *cis* configuration.\n- A discordant read indicates the two variants are on opposite haplotypes. This corresponds to the *trans* configuration.\n- The per-read phasing error probability is defined by the Phred score as $p_{\\mathrm{err}}=10^{-Q/10}$.\n- Read errors are independent across molecules.\n- There is no within-read switch error over the 2 kb distance.\n- The prior probabilities are given as $P(\\text{cis})=\\frac{1}{2}$ and $P(\\text{trans})=\\frac{1}{2}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, using standard concepts from genomics and bioinformatics like SNVs, haplotype phasing, long-read sequencing, and Phred quality scores. The application of Bayes' rule is a standard method for statistical inference in this field. The model for error probability is a direct and correct application of the Phred score definition. The assumptions, such as independent reads and no switch errors over the specified distance, are reasonable simplifications that make the problem well-posed. The problem is stated objectively with all necessary numerical values and definitions provided. There are no contradictions, ambiguities, or factual unsoundness.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution is warranted.\n\n### Solution Derivation\nThe objective is to compute the posterior probability that the two SNVs are in *cis* configuration, given the data from the three reads. Let $H_{\\text{cis}}$ be the hypothesis that the true configuration is *cis*, and $H_{\\text{trans}}$ be the hypothesis that it is *trans*. Let $D$ represent the observed data from the three reads. We want to find $P(H_{\\text{cis}} | D)$.\n\nAccording to Bayes' theorem:\n$$P(H_{\\text{cis}} | D) = \\frac{P(D | H_{\\text{cis}}) P(H_{\\text{cis}})}{P(D)}$$\nThe term $P(D)$ is the total probability of the evidence, given by the law of total probability:\n$$P(D) = P(D | H_{\\text{cis}}) P(H_{\\text{cis}}) + P(D | H_{\\text{trans}}) P(H_{\\text{trans}})$$\nSubstituting this into the Bayes' formula gives:\n$$P(H_{\\text{cis}} | D) = \\frac{P(D | H_{\\text{cis}}) P(H_{\\text{cis}})}{P(D | H_{\\text{cis}}) P(H_{\\text{cis}}) + P(D | H_{\\text{trans}}) P(H_{\\text{trans}})}$$\nThe problem states the prior probabilities are equal: $P(H_{\\text{cis}}) = P(H_{\\text{trans}}) = \\frac{1}{2}$. These terms cancel, simplifying the equation to a ratio of likelihoods:\n$$P(H_{\\text{cis}} | D) = \\frac{P(D | H_{\\text{cis}})}{P(D | H_{\\text{cis}}) + P(D | H_{\\text{trans}})}$$\nNext, we must calculate the likelihoods $P(D | H_{\\text{cis}})$ and $P(D | H_{\\text{trans}})$. The data $D$ consists of three independent read observations:\n- $R_1$: Discordant, $Q_1 = 20$\n- $R_2$: Concordant, $Q_2 = 30$\n- $R_3$: Concordant, $Q_3 = 30$\n\nThe phasing error probability for each read is given by $p_{\\mathrm{err}} = 10^{-Q/10}$.\n- For $R_1$: $p_{\\mathrm{err},1} = 10^{-20/10} = 10^{-2} = 0.01$. The probability of a correct phase call is $1 - p_{\\mathrm{err},1} = 0.99$.\n- For $R_2$ and $R_3$: $p_{\\mathrm{err},2} = p_{\\mathrm{err},3} = 10^{-30/10} = 10^{-3} = 0.001$. The probability of a correct phase call is $1 - p_{\\mathrm{err},2} = 1-p_{\\mathrm{err},3} = 0.999$.\n\nThe likelihood of the data given a hypothesis is the product of the probabilities of each independent observation.\n\n1.  **Likelihood for $H_{\\text{cis}}$:**\n    If the true configuration is *cis*, a concordant read is a correct observation, and a discordant read is an error.\n    - $P(R_1=\\text{discordant} | H_{\\text{cis}}) = p_{\\mathrm{err},1}$ (error)\n    - $P(R_2=\\text{concordant} | H_{\\text{cis}}) = 1 - p_{\\mathrm{err},2}$ (correct)\n    - $P(R_3=\\text{concordant} | H_{\\text{cis}}) = 1 - p_{\\mathrm{err},3}$ (correct)\n    Thus, the likelihood is:\n    $$P(D | H_{\\text{cis}}) = p_{\\mathrm{err},1} \\times (1 - p_{\\mathrm{err},2}) \\times (1 - p_{\\mathrm{err},3})$$\n    $$P(D | H_{\\text{cis}}) = 0.01 \\times (0.999) \\times (0.999) = 0.01 \\times (0.999)^2 = 0.01 \\times 0.998001 = 0.00998001$$\n\n2.  **Likelihood for $H_{\\text{trans}}$:**\n    If the true configuration is *trans*, a discordant read is a correct observation, and a concordant read is an error.\n    - $P(R_1=\\text{discordant} | H_{\\text{trans}}) = 1 - p_{\\mathrm{err},1}$ (correct)\n    - $P(R_2=\\text{concordant} | H_{\\text{trans}}) = p_{\\mathrm{err},2}$ (error)\n    - $P(R_3=\\text{concordant} | H_{\\text{trans}}) = p_{\\mathrm{err},3}$ (error)\n    Thus, the likelihood is:\n    $$P(D | H_{\\text{trans}}) = (1 - p_{\\mathrm{err},1}) \\times p_{\\mathrm{err},2} \\times p_{\\mathrm{err},3}$$\n    $$P(D | H_{\\text{trans}}) = (0.99) \\times 0.001 \\times 0.001 = 0.99 \\times (0.001)^2 = 0.99 \\times 0.000001 = 0.00000099$$\n\nNow, we substitute these likelihoods into the posterior probability formula:\n$$P(H_{\\text{cis}} | D) = \\frac{P(D | H_{\\text{cis}})}{P(D | H_{\\text{cis}}) + P(D | H_{\\text{trans}})} = \\frac{0.00998001}{0.00998001 + 0.00000099}$$\n$$P(H_{\\text{cis}} | D) = \\frac{0.00998001}{0.009981} \\approx 0.99990081154$$\n\nThe problem requires the answer to be rounded to four significant figures.\n$$P(H_{\\text{cis}} | D) \\approx 0.9999$$",
            "answer": "$$\\boxed{0.9999}$$"
        },
        {
            "introduction": "After generating a set of predicted haplotypes, we must evaluate their accuracy against a known standard. The switch error is the most fundamental metric for quantifying local phasing errors, representing points where the predicted assignment of alleles to a parental chromosome incorrectly flips. This exercise provides direct practice in calculating this crucial quality score by comparing a predicted haplotype to a known ground truth, a core skill in benchmarking phasing algorithms .",
            "id": "4388681",
            "problem": "A clinical research team is validating haplotype phasing within a pharmacogenomic gene region spanning a 10-Single Nucleotide Polymorphism (SNP) block. Each SNP is bi-allelic and heterozygous for the sample, and alleles are encoded as $0$ or $1$. Two haplotypes are defined at each position, corresponding to the two homologous chromosomes. The true haplotypes $H^{T}_{1}$ and $H^{T}_{2}$ for the block are known from a trio-based ground truth. An algorithm has predicted haplotypes $H^{P}_{1}$ and $H^{P}_{2}$ for the same block.\n\nUse the following data:\n- True haplotypes:\n$$H^{T}_{1} = (1, 0, 1, 1, 0, 0, 1, 0, 1, 0), \\quad H^{T}_{2} = (0, 1, 0, 0, 1, 1, 0, 1, 0, 1).$$\n- Predicted haplotypes:\n$$H^{P}_{1} = (1, 0, 0, 1, 1, 0, 1, 1, 0, 0), \\quad H^{P}_{2} = (0, 1, 1, 0, 0, 1, 0, 0, 1, 1).$$\n\nDefinitions to use:\n1. A haplotype phasing at SNP $i$ assigns the allele on each homologous chromosome; for bi-allelic heterozygous loci, $H^{T}_{1}[i] \\neq H^{T}_{2}[i]$ and $H^{P}_{1}[i] \\neq H^{P}_{2}[i]$ hold for all $i$.\n2. A switch error between adjacent SNPs $i$ and $i+1$ occurs if the mapping that aligns $H^{P}_{1}$ to one of $\\{H^{T}_{1}, H^{T}_{2}\\}$ at position $i$ differs from the mapping at position $i+1$. Formally, define a sequence $s_{i} \\in \\{+1,-1\\}$ by setting $s_{i} = +1$ if $H^{P}_{1}[i] = H^{T}_{1}[i]$ and $s_{i} = -1$ if $H^{P}_{1}[i] = H^{T}_{2}[i]$. A switch error is counted when $s_{i+1} \\neq s_{i}$.\n3. The switch error count is the total number of indices $i \\in \\{1,\\dots,9\\}$ for which $s_{i+1} \\neq s_{i}$ in this 10-SNP block.\n4. The switch error rate is the switch error count divided by the number of adjacent heterozygous SNP pairs, which for 10 heterozygous SNPs equals $9$. Express the rate as a decimal fraction.\n\nCompute the switch error count and the switch error rate for the predicted haplotypes relative to the true haplotypes. Round the switch error rate to 4 significant figures. Express the final rate as a decimal fraction (do not use a percent sign). Provide the final answer as two values: first the integer switch error count and second the rounded switch error rate.",
            "solution": "The user has requested the computation of the switch error count and switch error rate for a set of predicted haplotypes against a known true set.\n\nFirst, a validation of the problem statement is performed.\n\n**Step 1: Extract Givens**\n-   Number of SNPs in the block: $10$.\n-   All SNPs are bi-allelic and heterozygous.\n-   Allele encoding: $0$ or $1$.\n-   True haplotypes: $H^{T}_{1} = (1, 0, 1, 1, 0, 0, 1, 0, 1, 0)$ and $H^{T}_{2} = (0, 1, 0, 0, 1, 1, 0, 1, 0, 1)$.\n-   Predicted haplotypes: $H^{P}_{1} = (1, 0, 0, 1, 1, 0, 1, 1, 0, 0)$ and $H^{P}_{2} = (0, 1, 1, 0, 0, 1, 0, 0, 1, 1)$.\n-   Definition of heterozygous sites: For all SNP indices $i$, $H^{T}_{1}[i] \\neq H^{T}_{2}[i]$ and $H^{P}_{1}[i] \\neq H^{P}_{2}[i]$.\n-   Definition of alignment sequence $s_{i}$: $s_{i} = +1$ if $H^{P}_{1}[i] = H^{T}_{1}[i]$ and $s_{i} = -1$ if $H^{P}_{1}[i] = H^{T}_{2}[i]$.\n-   Definition of switch error: A switch error occurs between adjacent SNPs $i$ and $i+1$ if $s_{i+1} \\neq s_{i}$.\n-   Definition of switch error count: The total number of indices $i \\in \\{1,\\dots,9\\}$ for which $s_{i+1} \\neq s_{i}$.\n-   Definition of switch error rate: The switch error count divided by the number of adjacent heterozygous SNP pairs, which is $9$. The rate is to be expressed as a decimal rounded to $4$ significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it uses standard terminology and metrics (switch error rate) from the field of genomics and bioinformatics for evaluating haplotype phasing accuracy. The data provided are consistent with the definitions; for every SNP position $i$, the alleles on the two true haplotypes are different ($H^{T}_{1}[i] + H^{T}_{2}[i] = 1$), and the same holds for the predicted haplotypes ($H^{P}_{1}[i] + H^{P}_{2}[i] = 1$), fulfilling the condition of heterozygosity. The problem is well-posed, with all necessary data and unambiguous definitions provided to calculate a unique solution. The language is objective and formal. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\nThe core of the problem is to determine the alignment sequence $s_i$ and then count the number of times this alignment \"switches\" between adjacent positions. The sequence $s_i$ tracks whether the predicted haplotype $H^{P}_{1}$ matches the true haplotype $H^{T}_{1}$ (which we can arbitrarily label as the \"correct\" phase) or if it matches $H^{T}_{2}$ (the \"switched\" phase).\n\nThe alignment sequence $s = (s_1, s_2, \\dots, s_{10})$ is constructed by comparing the predicted haplotype $H^{P}_{1}$ to the true haplotype $H^{T}_{1}$ at each SNP position $i$ from $1$ to $10$.\nGiven:\n$$H^{T}_{1} = (1, 0, 1, 1, 0, 0, 1, 0, 1, 0)$$\n$$H^{P}_{1} = (1, 0, 0, 1, 1, 0, 1, 1, 0, 0)$$\n\nBy definition, $s_{i} = +1$ if $H^{P}_{1}[i] = H^{T}_{1}[i]$, and $s_{i} = -1$ otherwise (since heterozygosity implies that if $H^{P}_{1}[i] \\neq H^{T}_{1}[i]$, then it must be that $H^{P}_{1}[i] = H^{T}_{2}[i]$).\n\nLet's compute $s_i$ for each position $i$:\n-   For $i=1$: $H^{P}_{1}[1] = 1$ and $H^{T}_{1}[1] = 1$. They are equal, so $s_1 = +1$.\n-   For $i=2$: $H^{P}_{1}[2] = 0$ and $H^{T}_{1}[2] = 0$. They are equal, so $s_2 = +1$.\n-   For $i=3$: $H^{P}_{1}[3] = 0$ and $H^{T}_{1}[3] = 1$. They are not equal, so $s_3 = -1$.\n-   For $i=4$: $H^{P}_{1}[4] = 1$ and $H^{T}_{1}[4] = 1$. They are equal, so $s_4 = +1$.\n-   For $i=5$: $H^{P}_{1}[5] = 1$ and $H^{T}_{1}[5] = 0$. They are not equal, so $s_5 = -1$.\n-   For $i=6$: $H^{P}_{1}[6] = 0$ and $H^{T}_{1}[6] = 0$. They are equal, so $s_6 = +1$.\n-   For $i=7$: $H^{P}_{1}[7] = 1$ and $H^{T}_{1}[7] = 1$. They are equal, so $s_7 = +1$.\n-   For $i=8$: $H^{P}_{1}[8] = 1$ and $H^{T}_{1}[8] = 0$. They are not equal, so $s_8 = -1$.\n-   For $i=9$: $H^{P}_{1}[9] = 0$ and $H^{T}_{1}[9] = 1$. They are not equal, so $s_9 = -1$.\n-   For $i=10$: $H^{P}_{1}[10] = 0$ and $H^{T}_{1}[10] = 0$. They are equal, so $s_{10} = +1$.\n\nThe complete alignment sequence is $s = (+1, +1, -1, +1, -1, +1, +1, -1, -1, +1)$.\n\nNext, we calculate the switch error count. A switch error occurs at index $i$ if $s_{i+1} \\neq s_i$. We check this for $i=1, \\dots, 9$.\n-   $i=1$: $s_2 = +1$, $s_1 = +1$. $s_2 = s_1$. No switch.\n-   $i=2$: $s_3 = -1$, $s_2 = +1$. $s_3 \\neq s_2$. **Switch 1**.\n-   $i=3$: $s_4 = +1$, $s_3 = -1$. $s_4 \\neq s_3$. **Switch 2**.\n-   $i=4$: $s_5 = -1$, $s_4 = +1$. $s_5 \\neq s_4$. **Switch 3**.\n-   $i=5$: $s_6 = +1$, $s_5 = -1$. $s_6 \\neq s_5$. **Switch 4**.\n-   $i=6$: $s_7 = +1$, $s_6 = +1$. $s_7 = s_6$. No switch.\n-   $i=7$: $s_8 = -1$, $s_7 = +1$. $s_8 \\neq s_7$. **Switch 5**.\n-   $i=8$: $s_9 = -1$, $s_8 = -1$. $s_9 = s_8$. No switch.\n-   $i=9$: $s_{10} = +1$, $s_9 = -1$. $s_{10} \\neq s_9$. **Switch 6**.\n\nBy summing these occurrences, the total switch error count is $6$.\n\nFinally, we compute the switch error rate. It is the switch error count divided by the number of opportunities for a switch, which is the number of adjacent SNP pairs. For a block of $10$ SNPs, there are $10-1 = 9$ adjacent pairs.\n$$ \\text{Switch Error Rate} = \\frac{\\text{Switch Error Count}}{\\text{Number of adjacent pairs}} = \\frac{6}{9} $$\nSimplifying the fraction gives:\n$$ \\frac{6}{9} = \\frac{2}{3} $$\nAs a decimal, this is $0.6666\\overline{6}$. The problem requires this to be rounded to $4$ significant figures.\n$$ 0.6666\\overline{6} \\approx 0.6667 $$\n\nThe two required values are the switch error count ($6$) and the switch error rate ($0.6667$).",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6 & 0.6667\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Beyond local accuracy, the overall utility of a phased genome is determined by the length of its contiguous phase blocks. The N50 phase block length is a standard statistic used to summarize the scale of phasing contiguity, giving more weight to the longer blocks that are most informative for downstream analysis. This problem guides you through the calculation of N50, an essential skill for interpreting and comparing the quality of phasing results from different methods or datasets .",
            "id": "4388662",
            "problem": "In haplotype phasing for clinical genomics, contiguous segments of the genome in which heterozygous variants are assigned to the same parental chromosome are termed phase blocks. Consider a dataset from a targeted precision medicine panel in which read-backed phasing produced a finite set of phase blocks with measured lengths. A robust way to summarize the typical block scale is the statistic known as the N50 phase block length. Starting from the core definition that phase blocks partition the phased portion of the genome into contiguous intervals with positive lengths, and that a summary statistic should reflect the contribution of longer blocks to the total phased span, provide a formal mathematical definition of the N50 phase block length in terms of the multiset of block lengths. Then, compute the N50 phase block length for the set of phase block lengths $\\{100\\,\\mathrm{kb}, 250\\,\\mathrm{kb}, 1.2\\,\\mathrm{Mb}, 80\\,\\mathrm{kb}\\}$ obtained from an individual’s phasing. Express the final N50 in kilobases. No rounding is required. Do not include units in your final numerical answer box.",
            "solution": "Phase blocks arising from haplotype phasing are contiguous genomic intervals with positive lengths. Let the multiset of block lengths be denoted by $\\{l_{1}, l_{2}, \\dots, l_{n}\\}$ with each $l_{i} > 0$. To define a statistic that captures the typical block size while weighting blocks by their contribution to the total phased span, we sort the lengths in nonincreasing order, yielding a sequence $l_{(1)} \\geq l_{(2)} \\geq \\dots \\geq l_{(n)}$. Let the total phased span be $L_{\\mathrm{tot}} = \\sum_{i=1}^{n} l_{(i)}$. The N50 phase block length is then defined as the smallest length in this sorted sequence such that the cumulative sum from the largest down reaches at least half of the total. Formally,\n$$\n\\mathrm{N50} = \\min \\left\\{ l_{(k)} \\;:\\; \\sum_{i=1}^{k} l_{(i)} \\geq \\frac{1}{2} \\sum_{i=1}^{n} l_{(i)} \\right\\}.\n$$\n\nWe now compute this quantity for the given set $\\{100\\,\\mathrm{kb}, 250\\,\\mathrm{kb}, 1.2\\,\\mathrm{Mb}, 80\\,\\mathrm{kb}\\}$. First, convert all lengths to the same unit, kilobases (kb). Using $1\\,\\mathrm{Mb} = 1000\\,\\mathrm{kb}$, the set in kilobases is\n$$\n\\{100\\,\\mathrm{kb}, 250\\,\\mathrm{kb}, 1200\\,\\mathrm{kb}, 80\\,\\mathrm{kb}\\}.\n$$\nSort in nonincreasing order:\n$$\nl_{(1)} = 1200\\,\\mathrm{kb}, \\quad l_{(2)} = 250\\,\\mathrm{kb}, \\quad l_{(3)} = 100\\,\\mathrm{kb}, \\quad l_{(4)} = 80\\,\\mathrm{kb}.\n$$\nCompute the total phased span:\n$$\nL_{\\mathrm{tot}} = 1200 + 250 + 100 + 80 = 1630\\,\\mathrm{kb}.\n$$\nCompute half of the total:\n$$\n\\frac{1}{2} L_{\\mathrm{tot}} = \\frac{1}{2} \\times 1630 = 815\\,\\mathrm{kb}.\n$$\nCompute cumulative sums in the sorted order:\n- After the first block: $S_{1} = 1200\\,\\mathrm{kb}$.\n- After the second block: $S_{2} = 1200 + 250 = 1450\\,\\mathrm{kb}$.\n- After the third block: $S_{3} = 1450 + 100 = 1550\\,\\mathrm{kb}$.\n- After the fourth block: $S_{4} = 1550 + 80 = 1630\\,\\mathrm{kb}$.\n\nThe smallest $k$ for which $S_{k} \\geq 815\\,\\mathrm{kb}$ is $k=1$, since $S_{1} = 1200\\,\\mathrm{kb} \\geq 815\\,\\mathrm{kb}$. Therefore,\n$$\n\\mathrm{N50} = l_{(1)} = 1200\\,\\mathrm{kb}.\n$$\nExpressed in kilobases, the N50 phase block length is $1200$.",
            "answer": "$$\\boxed{1200}$$"
        }
    ]
}