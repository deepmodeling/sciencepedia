{
    "hands_on_practices": [
        {
            "introduction": "人类基因组计划（HGP）的核心遗产之一是确立了评估基因组组装质量的黄金标准。N50是衡量组装连续性的关键指标，理解它对于比较不同测序技术或组装算法的成果至关重要。本练习将通过一个简化的数据集，带你亲手计算 contig N50，并辨析 contig 与 scaffold 在提升组装质量中的不同作用。",
            "id": "4391378",
            "problem": "人类基因组计划（HGP）的一项核心遗产是定量组装指标的标准化，这些指标使得在精准医疗和基因组诊断中使用的基因组构建版本能够进行可重复的比较。考虑一个草图基因组组装，其重叠群（contig，每个重叠群是一段没有缺口的连续脱氧核糖核酸（DNA）序列）长度分别为 $1.2$ Mb、$0.9$ Mb、$0.7$ Mb、$0.4$ Mb 和 $0.3$ Mb。使用基因组组装评估中采用的重叠群N50的标准定义，计算该数据集的重叠群N50。然后，解释为什么使用全基因组长程图谱（如光学图谱或高通量染色体构象捕获技术 Hi-C）将这些重叠群排序和定向成支架（scaffold），可以增加支架N50，同时不改变重叠群的连续性。\n\n以兆碱基（Mb）为单位表示重叠群N50的最终数值答案，并将答案四舍五入至三位有效数字。从第一性原理出发，依据基因组组装指标和长程支架构建技术的核心定义和公认事实，提供你的推理过程。",
            "solution": "该问题是有效的，因为它在科学上植根于基因组学领域，问题提出得当且数据充分，表述客观。它要求计算一个标准的基因组组装指标，并基于已确立的基因组支架构建原则进行解释。\n\n该问题要求计算给定一组重叠群长度的重叠群N50，并解释支架构建如何影响组装指标。我们将依次处理这两个部分。\n\n首先，我们计算重叠群N50。N50指标是衡量基因组组装连续性的一个广泛使用的度量。它被定义为这样一个最小的重叠群长度：所有长度大于或等于该长度的重叠群的长度总和至少占总组装大小的$50\\%$。\n\n给定的重叠群长度为 $L_1 = 1.2$ Mb, $L_2 = 0.9$ Mb, $L_3 = 0.7$ Mb, $L_4 = 0.4$ Mb, 和 $L_5 = 0.3$ Mb。\n\n步骤 1：计算总组装大小，记为 $G$。\n总组装大小是所有重叠群长度的总和：\n$$G = \\sum_{i=1}^{5} L_i = 1.2 + 0.9 + 0.7 + 0.4 + 0.3 = 3.5 \\text{ Mb}$$\n\n步骤 2：确定总组装大小的$50\\%$阈值。\n这个阈值，我们可以称之为 $G_{50}$，是：\n$$G_{50} = 0.50 \\times G = 0.5 \\times 3.5 \\text{ Mb} = 1.75 \\text{ Mb}$$\n\n步骤 3：按长度降序排列重叠群。\n提供的列表已经是降序排列的：\n$1.2$ Mb, $0.9$ Mb, $0.7$ Mb, $0.4$ Mb, $0.3$ Mb。\n\n步骤 4：从最长的重叠群开始，计算重叠群长度的累积和，直到该和大于或等于 $G_{50}$。\n- 最长重叠群的长度是 $1.2$ Mb。累积和是 $1.2$ Mb。这小于 $1.75$ Mb。\n- 我们加上次长重叠群的长度 $0.9$ Mb。新的累积和是 $1.2 \\text{ Mb} + 0.9 \\text{ Mb} = 2.1$ Mb。\n\n这个 $2.1$ Mb的累积和大于目标阈值 $1.75$ Mb。N50值是为使总和超过阈值而加入的最后一个重叠群的长度。在这种情况下，该重叠群的长度为 $0.9$ Mb。问题要求答案四舍五入至三位有效数字，因此 $0.9$ Mb 表示为 $0.900$ Mb。\n\n因此，该组装的重叠群N50是 $0.900$ Mb。\n\n其次，我们解释为什么支架构建会增加支架N50，而不会改变重叠群的连续性。\n**重叠群（contig）**（源自“contiguous”）是由测序读长（reads）组装而成的连续DNA序列片段，其中没有未知序列的缺口。重叠群的长度是精确已知的。\n**支架（scaffold）**是通过将多个重叠群沿染色体进行排序和定向而创建的更高阶结构。支架内重叠群之间的缺口代表未知序列的区域，但其大小是估计的。这些缺口通常在序列文件中用特定数量的'N'字符表示。\n\n**支架构建（scaffolding）**过程利用光学图谱或Hi-C等技术提供的长程信息来确定在基因组中物理上邻近的重叠群的相对位置和方向。例如，如果Hi-C数据显示重叠群A和重叠群B是相邻的，它们可以被连接成一个单一的支架（例如，A-NNN...NNN-B）。\n\n这个过程不会改变底层的重叠群。重叠群A和重叠群B的序列保持不变；它们只是被置于一个更大的上下文中。因此，所有重叠群的集合及其各自的长度与支架构建前的集合保持一致。由于**重叠群N50**完全基于这组重叠群的长度计算，因此它在支架构建过程中保持不变。“重叠群连续性”没有改变，因为没有新的序列被添加到重叠群本身，它们也没有被断开或合并。\n\n然而，支架构建生成了一组新的序列用于分析：即支架。其中一些支架可能由多个连接在一起的重叠群组成，使得它们比任何单个源重叠群都要长得多。剩余的未被构建成支架的重叠群被视为长度等于其自身重叠群长度的支架。\n\n要计算**支架N50**，需要使用这些新支架的长度。例如，如果将我们数据集中的 $1.2$ Mb 和 $0.7$ Mb 重叠群连接起来，就会创建一个长度至少为 $1.2 + 0.7 = 1.9$ Mb（加上估计的缺口大小）的新支架。用于N50计算的新序列长度集将是（例如）{$1.9$ Mb, $0.9$ Mb, $0.4$ Mb, $0.3$ Mb}。总组装大小 $G$ 保持不变（$3.5$ Mb），50%的阈值 $G_{50}$ 也保持不变（$1.75$ Mb）。现在最长的序列是 $1.9$ Mb，它已经大于 $1.75$ Mb。因此，支架N50将是这个新的长支架的长度（在这个假设案例中为 $1.9$ Mb），这远大于原始的重叠群N50（$0.900$ Mb）。\n\n总之，支架构建通过将重叠群连接成更长的支架来增加N50值，从而改善了组装的长程连续性（由支架N50衡量），但没有改变基本的重叠群集合或其内部序列（因此不改变重叠群N50）。",
            "answer": "$$\n\\boxed{0.900}\n$$"
        },
        {
            "introduction": "拥有高质量的参考基因组后，重测序成为发现个体变异的标准方法，而测序深度（coverage）是决定变异检测能力的关键质量控制参数。在实际数据分析中，原始数据需要经过多步过滤，因此计算“有效”测序深度是一项核心技能。本练习模拟了一个典型的全基因组测序数据处理流程，让你从原始读数（reads）出发，逐步计算出最终的有效基因组覆盖度。",
            "id": "4391383",
            "problem": "人类基因组计划（HGP）在精准医疗中的一个核心操作意义是，短读长数据集可以比对到高质量的人类参考基因组上，以量化有效测序深度，而测序深度决定了变异发现的灵敏度。考虑一次在HGP历史成果中建立的人类参考基因组上进行的全基因组临床测序，其中单倍体有效基因组大小为 $G = 3.10 \\times 10^{9}$ 个碱基对。该测序仪产出 $N = 1.2 \\times 10^{9}$ 个双末端读长对，每个读长的长度为 $L = 150$ 个碱基对（因此每个读长对贡献 $2L$ 个碱基）。在质量控制过程中，比例为 $0.15$ 的读长对因质量低或接头污染而被丢弃。在剩余的读长对中，又有比例为 $0.20$ 的部分作为聚合酶链式反应（PCR）重复在读长对水平上被移除。假设所有保留的读长对都唯一比对到参考基因组上并贡献其全部长度，且忽略配对读长之间的任何重叠或软剪切。\n\n仅使用第一性原理以及测序和覆盖度的核心定义，计算这些数据所蕴含的单倍体基因组的有效平均测序深度（倍数覆盖度）。将最终答案表示为一个纯数（倍数覆盖度，无量纲），并四舍五入到四位有效数字。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n-   单倍体有效基因组大小：$G = 3.10 \\times 10^{9}$ 个碱基对\n-   初始双末端读长对总数：$N = 1.2 \\times 10^{9}$\n-   每个读长的长度：$L = 150$ 个碱基对\n-   每个读长对贡献的碱基数：$2L$\n-   因质量低而丢弃的读长对比例：$f_{qc} = 0.15$\n-   从*剩余*读长对中因PCR重复而移除的比例：$f_{dup} = 0.20$\n-   假设：所有保留的读长对都唯一比对并贡献其全部长度。\n-   目标：计算有效平均测序深度（倍数覆盖度），并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n-   **科学依据充分**：该问题在根本上是合理的。它描述了基因组学和生物信息学中一个标准且关键的计算，特别是在新一代测序（NGS）数据的质量评估方面。测序深度、读长长度、双末端读长、质量过滤和PCR重复去除等概念都是该领域的核心。所提供的人类基因组大小、读长数量和读长长度的值对于现代全基因组测序实验是切合实际的。\n-   **适定性良好**：该问题是适定的。它提供了所有必要的数值数据，并为数据过滤定义了一个清晰、有序的过程。目标明确且无歧义，可以导出一个唯一的、可计算的解。\n-   **客观性**：该问题以精确、客观和技术性的语言陈述。它没有主观性、歧义或观点。\n\n### 步骤 3：结论与行动\n该问题是**有效**的。这是一个在定量基因组学领域中科学上一致、适定性良好且客观的练习。可以开始求解过程。\n\n有效平均测序深度，或称倍数覆盖度，记作 $C$，其定义是比对到参考基因组上的测序碱基总数除以该参考基因组的大小。覆盖度的单位是“X”或“倍”，是无量纲的。\n\n$$C = \\frac{\\text{有效比对碱基总数}}{\\text{有效基因组大小}}$$\n\n已知条件如下：\n-   初始读长对数量，$N = 1.2 \\times 10^{9}$。\n-   单个读长的长度，$L = 150$ 个碱基对。因此每个读长对贡献的总长度为 $2L$。\n-   单倍体基因组大小，$G = 3.10 \\times 10^{9}$ 个碱基对。\n-   因质量控制而损失的读长对比例，$f_{qc} = 0.15$。\n-   从剩余读长对中因PCR重复去除而损失的比例，$f_{dup} = 0.20$。\n\n我们必须首先计算成功保留并比对到基因组上的读长对数量。\n\n1.  从初始读长对数量 $N = 1.2 \\times 10^{9}$ 开始。\n\n2.  比例为 $f_{qc} = 0.15$ 的读长对被丢弃。剩余的比例为 $(1 - f_{qc})$。质量控制后的读长对数量 $N_{qc}$ 为：\n    $$N_{qc} = N \\times (1 - f_{qc})$$\n\n3.  在这些剩余的 $N_{qc}$ 对中，又有比例为 $f_{dup} = 0.20$ 的部分作为PCR重复被移除。保留的比例为 $(1 - f_{dup})$。最终保留的读长对数量 $N_{retained}$ 为：\n    $$N_{retained} = N_{qc} \\times (1 - f_{dup}) = N \\times (1 - f_{qc}) \\times (1 - f_{dup})$$\n\n4.  问题陈述中说明，每个保留的读长对都贡献其全部长度 $2L$ 个碱基到有效比对数据中。因此，有效比对碱基的总数为：\n    $$\\text{Total Mapped Bases} = N_{retained} \\times 2L = N \\times (1 - f_{qc}) \\times (1 - f_{dup}) \\times 2L$$\n\n5.  现在，我们可以通过将总比对碱基数除以基因组大小 $G$ 来计算平均测序深度 $C$：\n    $$C = \\frac{N \\times (1 - f_{qc}) \\times (1 - f_{dup}) \\times 2L}{G}$$\n\n将已知值代入此表达式：\n-   $N = 1.2 \\times 10^{9}$\n-   $G = 3.10 \\times 10^{9}$\n-   $L = 150$\n-   $f_{qc} = 0.15$\n-   $f_{dup} = 0.20$\n\n计算过程如下：\n$$C = \\frac{(1.2 \\times 10^{9}) \\times (1 - 0.15) \\times (1 - 0.20) \\times (2 \\times 150)}{3.10 \\times 10^{9}}$$\n\n首先，计算分子中的各项：\n-   保留系数为 $(1 - 0.15) = 0.85$ 和 $(1 - 0.20) = 0.80$。\n-   每个读长对的长度为 $2L = 2 \\times 150 = 300$ 个碱基。\n\n将这些值代入 $C$ 的方程中：\n$$C = \\frac{(1.2 \\times 10^{9}) \\times 0.85 \\times 0.80 \\times 300}{3.10 \\times 10^{9}}$$\n\n分子和分母中的因子 $10^{9}$ 可以消掉：\n$$C = \\frac{1.2 \\times 0.85 \\times 0.80 \\times 300}{3.10}$$\n\n现在，计算分子的乘积：\n-   $1.2 \\times 0.85 = 1.02$\n-   $1.02 \\times 0.80 = 0.816$\n-   $0.816 \\times 300 = 244.8$\n\n所以，$C$ 的表达式简化为：\n$$C = \\frac{244.8}{3.10}$$\n\n执行最后的除法：\n$$C \\approx 78.9677419...$$\n\n题目要求最终答案四舍五入到四位有效数字。前四位有效数字是 $7$、$8$、$9$ 和 $6$。第五位数字是 $7$，大于等于 $5$，所以我们将第四位数字向上取整。\n$$C \\approx 78.97$$\n\n有效平均测序深度为 $78.97$X。",
            "answer": "$$\\boxed{78.97}$$"
        },
        {
            "introduction": "在精准医疗中，仅仅调用出基因变异是不够的，我们必须量化其准确性。借助HGP遗产中的基准数据集（如GIAB），我们可以像评估诊断测试一样，严格衡量变异调用流程的性能。本练习将经典的二元分类评估框架（包括灵敏度、特异性和$F_1$分数）应用于一个变异调用的场景，帮助你掌握评估生物信息学工具性能的基本方法。",
            "id": "4391334",
            "problem": "人类基因组计划 (Human Genome Project, HGP) 的一项核心遗产是建立了标准化的参考资源和高可信度的基准数据集（例如，瓶中基因组 (Genome in a Bottle, GIAB)），这些资源和数据集能够对用于精准医疗和基因组诊断的变异检出性能进行严格评估。考虑在一个已定义的可检出区域内，根据一个类似于GIAB的真实参考资源，对一个单核苷酸多态性 (single-nucleotide polymorphism, SNP) 检出工具进行评估。该真实参考资源在同一可检出区域内指定了 $50{,}000$ 个经审定的SNP阳性位点和 $5{,}000{,}000$ 个经审定的SNP阴性位点。该检出工具单次运行后，与该真实参考资源比对，产生以下裁定结果：真阳性 (True Positives, TP) $=49{,}000$，假阳性 (False Positives, FP) $=1{,}000$，以及假阴性 (False Negatives, FN) $=1,000$。假设在经审定的SNP阴性集合中，所有未被该检出工具识别为SNP的位点均为真阴性 (True Negatives, TN)，并且在基准测试区域内没有未解析或不可检出的位点。\n\n仅从应用于变异检出的二元分类混淆矩阵的诊断测试性能基本定义出发，推导并计算该检出工具在此数据集上的灵敏度、特异度以及$F_{1}$分数。将这三个量表示为区间$[0,1]$内的小数。将最终数值结果四舍五入至四位有效数字。以单行矩阵的形式提供您的最终答案，矩阵中依次包含灵敏度、特异度和$F_{1}$分数。",
            "solution": "该问题是有效的，因为它具有科学依据、定义明确且客观。它提供了一套完整且一致的数据，用于使用标准性能指标评估一个二元分类器——在本例中是一个基因组变异检出工具。其背景与基因组诊断和精准医疗领域直接相关，这是人类基因组计划的一项关键遗产。我们将继续推导并计算所要求的指标。\n\n问题提供了单核苷酸多态性 (SNP) 检出工具与高可信度真实参考资源进行比较的以下数据：\n\n1.  经审定的SNP阳性位点数（阳性样本, $P$）为 $P = 50,000$。\n2.  经审定的SNP阴性位点数（阴性样本, $N$）为 $N = 5,000,000$。\n3.  真阳性（$TP$）的数量，即检出工具正确识别出SNP的位点数，为 $TP = 49,000$。\n4.  假阳性（$FP$）的数量，即检出工具在阴性位点上错误识别出SNP的位点数，为 $FP = 1,000$。\n5.  假阴性（$FN$）的数量，即检出工具未能识别出真实SNP的位点数，为 $FN = 1,000$。\n\n根据这些给定值，我们必须首先确定真阴性（$TN$）的数量，即检出工具正确识别为阴性的经审定SNP阴性位点数。问题指出，在SNP阴性集合中所有未被识别为SNP的位点都是真阴性。SNP阴性位点的总数是 $N$，其中被错误识别为阳性的位点数是 $FP$。因此，真阴性的数量由下式给出：\n$$\nTN = N - FP\n$$\n代入给定值：\n$$\nTN = 5,000,000 - 1,000 = 4,999,000\n$$\n我们可以验证所提供数字的一致性。阳性样本总数必须等于真阳性与假阴性之和：\n$$\nP = TP + FN = 49,000 + 1,000 = 50,000\n$$\n这与给定的 $P$ 值相符。阴性样本总数必须等于假阳性与真阴性之和：\n$$\nN = FP + TN = 1,000 + 4,999,000 = 5,000,000\n$$\n这与给定的 $N$ 值相符。数据是内部一致的。\n\n现在，我们推导并计算三个所需的性能指标。\n\n**1. 灵敏度 (Sensitivity) (召回率或真阳性率)**\n\n灵敏度衡量分类器正确识别出的实际阳性实例所占的比例。其定义为真阳性数与总阳性样本数（$P = TP + FN$）的比率。\n\n基本定义为：\n$$\n\\text{灵敏度} = \\frac{TP}{P} = \\frac{TP}{TP + FN}\n$$\n代入给定值：\n$$\n\\text{灵敏度} = \\frac{49,000}{49,000 + 1,000} = \\frac{49,000}{50,000} = 0.98\n$$\n四舍五入至四位有效数字，灵敏度为 $0.9800$。\n\n**2. 特异度 (Specificity) (真阴性率)**\n\n特异度衡量分类器正确识别出的实际阴性实例所占的比例。其定义为真阴性数与总阴性样本数（$N = FP + TN$）的比率。\n\n基本定义为：\n$$\n\\text{特异度} = \\frac{TN}{N} = \\frac{TN}{FP + TN}\n$$\n使用我们计算出的 $TN$ 值：\n$$\n\\text{特异度} = \\frac{4,999,000}{1,000 + 4,999,000} = \\frac{4,999,000}{5,000,000} = 0.9998\n$$\n该值已经表示为四位有效数字。\n\n**3. $F_1$ 分数**\n\n$F_1$ 分数是精确率 (Precision) 和召回率 (Recall/灵敏度) 的调和平均数。它提供了一个单一指标，用以平衡精确率和召回率。\n\n首先，我们来定义精确率，也称为阳性预测值 (Positive Predictive Value, PPV)。精确率衡量预测为阳性的实例中实际为正确的比例。其定义为：\n$$\n\\text{精确率} = \\frac{TP}{\\text{预测阳性数}} = \\frac{TP}{TP + FP}\n$$\n对于此数据集，精确率为：\n$$\n\\text{精确率} = \\frac{49,000}{49,000 + 1,000} = \\frac{49,000}{50,000} = 0.98\n$$\n召回率是灵敏度的别称，我们已计算出其值为 $0.98$。\n\n$F_1$ 分数的定义为：\n$$\nF_1 = 2 \\cdot \\frac{\\text{精确率} \\cdot \\text{召回率}}{\\text{精确率} + \\text{召回率}}\n$$\n一个更直接的公式，由上式推导而来，并用基本计数（$TP, FP, FN$）表示，是：\n$$\nF_1 = \\frac{2 \\cdot TP}{2 \\cdot TP + FP + FN}\n$$\n使用此直接公式并代入给定值：\n$$\nF_1 = \\frac{2 \\cdot 49,000}{2 \\cdot 49,000 + 1,000 + 1,000} = \\frac{98,000}{98,000 + 2,000} = \\frac{98,000}{100,000} = 0.98\n$$\n四舍五入至四位有效数字，$F_1$ 分数为 $0.9800$。\n\n总结来说，该SNP检出工具计算出的性能指标（四舍五入至四位有效数字）如下：\n- 灵敏度: $0.9800$\n- 特异度: $0.9998$\n- $F_1$ 分数: $0.9800$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9800 & 0.9998 & 0.9800\n\\end{pmatrix}\n}\n$$"
        }
    ]
}