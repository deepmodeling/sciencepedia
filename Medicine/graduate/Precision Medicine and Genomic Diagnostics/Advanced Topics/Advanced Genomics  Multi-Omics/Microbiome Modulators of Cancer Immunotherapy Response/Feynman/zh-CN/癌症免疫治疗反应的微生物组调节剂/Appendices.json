{
    "hands_on_practices": [
        {
            "introduction": "在投入宝贵的资源进行临床前研究（如小鼠实验）之前，进行功效分析是至关重要的第一步。它能帮助我们确定需要多少样本，才能有足够大的把握检测到真实存在的效应。这项练习  将指导你为一个典型的临床前实验计算所需的样本量，该实验旨在比较来自应答者与无应答者患者的微生物群对肿瘤控制的影响。",
            "id": "4359715",
            "problem": "研究人员正在研究用响应者微生物群进行定植是否能调节免疫检查点抑制剂（ICI）的抗肿瘤功效。接受免疫治疗的小鼠被随机分配，用来自人类响应者或非响应者的微生物群进行定植。对每只索引为 $i$ 的小鼠，从第 $t=0$ 天到第 $t=T$ 天（$T=28$）定期测量其纵向肿瘤体积 $V_{i}(t)$。为了获得一个单一的小鼠水平的肿瘤控制测量指标，该指标既要考虑到小鼠内部的时间相关性，又要避免伪重复，研究人员将通过基线标准化的肿瘤体积曲线下面积来总结每条轨迹，即 $A_{i}=\\int_{0}^{T} \\frac{V_{i}(t)}{V_{i}(0)}\\,dt$。设 $R$ 组表示用响应者微生物群定植的小鼠， $N$ 组表示用非响应者微生物群定植的小鼠。假设每组中小鼠水平的汇总指标 $A_{i}$ 是独立的，并且近似服从具有共同标准差 $\\sigma$ 的高斯分布，并设 $\\mu_{R}$ 和 $\\mu_{N}$ 为相应的组均值。研究人员希望设计一个统计检验来检测肿瘤控制的差异，这种差异被形式化为两组之间平均 $A_{i}$ 的差异，并为该研究提供效能，以便在双侧显著性水平 $\\alpha=0.05$ 和目标效能 $1-\\beta=0.80$ 的条件下，使用每组相等的样本量，检测到标准化效应大小 $d=0.8$。\n\n从假设检验和标准化效应大小的核心定义出发，推导在正态近似下，基于 $A_{i}$ 汇总指标进行双样本均值比较所需的最小每组相等样本量 $n$。您可以假设标准化效应大小为 $d=\\frac{|\\mu_{R}-\\mu_{N}|}{\\sigma}$。使用双侧检验的标准正态分位数。对于任何所需的标准正态分位数的数值近似，请在继续计算前将每个分位数四舍五入到四位有效数字。计算出连续的 $n$ 后，将最终所需的每组样本量向上取整到下一个完整的小鼠数量。\n\n请提供最终答案，即为达到指定的 $\\alpha$ 和效能所需的最小整数 $n$（每组小鼠的数量），不带单位。",
            "solution": "问题要求在给定显著性水平 $\\alpha$、效能 $1-\\beta$ 和标准化效应大小 $d$ 的情况下，推导出一个双样本均值检验所需的最小每组样本量 $n$。该分析将基于汇总测量指标 $A_i$ 的样本均值的正态近似。\n\n设 $\\mu_R$ 和 $\\mu_N$ 分别为响应者（$R$）组和非响应者（$N$）组的汇总统计量 $A_i = \\int_{0}^{T} \\frac{V_{i}(t)}{V_{i}(0)}\\,dt$ 的真实均值。共同标准差为 $\\sigma$。我们要检验这些均值是否存在差异。\n\n双侧检验的原假设和备择假设是：\n$$ H_0: \\mu_R = \\mu_N \\quad \\text{或} \\quad \\mu_R - \\mu_N = 0 $$\n$$ H_A: \\mu_R \\neq \\mu_N \\quad \\text{或} \\quad \\mu_R - \\mu_N \\neq 0 $$\n\n设 $n_R = n_N = n$ 为每组相等的样本量。设 $\\bar{A}_R$ 和 $\\bar{A}_N$ 为样本均值。总体均值差异的估计量是 $\\bar{A}_R - \\bar{A}_N$。由于假设单个测量值 $A_i$ 是独立且服从正态分布的，因此均值差异 $\\bar{A}_R - \\bar{A}_N$ 的抽样分布也服从正态分布。\n\n该抽样分布的均值为 $E[\\bar{A}_R - \\bar{A}_N] = \\mu_R - \\mu_N$。\n方差为 $\\text{Var}(\\bar{A}_R - \\bar{A}_N) = \\text{Var}(\\bar{A}_R) + \\text{Var}(\\bar{A}_N) = \\frac{\\sigma^2}{n_R} + \\frac{\\sigma^2}{n_N} = \\frac{\\sigma^2}{n} + \\frac{\\sigma^2}{n} = \\frac{2\\sigma^2}{n}$。\n差异的标准误是 $SE = \\sqrt{\\frac{2\\sigma^2}{n}} = \\sigma\\sqrt{\\frac{2}{n}}$。\n\n在原假设 $H_0$ 下，均值差异为 0。检验统计量为：\n$$ Z = \\frac{(\\bar{A}_R - \\bar{A}_N) - 0}{SE} = \\frac{\\bar{A}_R - \\bar{A}_N}{\\sigma\\sqrt{\\frac{2}{n}}} $$\n在 $H_0$ 下，$Z$ 服从标准正态分布，$Z \\sim N(0, 1)$。\n\n对于显著性水平为 $\\alpha$ 的双侧检验，如果观测到的检验统计量 $|Z|$ 大于临界值 $z_{1-\\alpha/2}$，我们则拒绝 $H_0$。值 $z_{q}$ 表示标准正态分布的第 $q$ 个分位数。\n给定 $\\alpha=0.05$，我们有 $\\alpha/2 = 0.025$，临界值为 $z_{1-0.025} = z_{0.975}$。根据问题陈述，我们使用四舍五入到四位有效数字的近似值：\n$$ z_{0.975} \\approx 1.960 $$\n因此，拒绝域定义为 $|\\bar{A}_R - \\bar{A}_N| / (\\sigma\\sqrt{2/n}) > 1.960$。\n\n效能是在 $H_A$ 为真时正确拒绝 $H_0$ 的概率。设 $1-\\beta$ 为期望的效能。我们在一个特定的备择假设下评估效能，该假设下真实差异为 $|\\mu_R - \\mu_N| = \\delta$。标准化效应大小给定为 $d = \\frac{|\\mu_R - \\mu_N|}{\\sigma} = \\frac{\\delta}{\\sigma}$。\n根据问题，$d = 0.8$ 且 $1-\\beta = 0.80$，这意味着 $\\beta=0.20$。\n\n在此备择假设下，统计量 $\\bar{A}_R - \\bar{A}_N$ 服从均值为 $\\delta$、标准误为 $\\sigma\\sqrt{2/n}$ 的正态分布。\n效能是当真实差异为 $\\delta$ 时，检验统计量落入拒绝域的概率。\n$$ 1 - \\beta = P\\left( |Z| > z_{1-\\alpha/2} \\mid |\\mu_R - \\mu_N| = \\delta \\right) $$\n不失一般性地，假设 $\\mu_R - \\mu_N = \\delta > 0$。效能主要由拒绝域的上尾贡献，因为检验统计量落入下尾的概率可以忽略不计。\n$$ 1 - \\beta \\approx P\\left( \\frac{\\bar{A}_R - \\bar{A}_N}{\\sigma\\sqrt{\\frac{2}{n}}} > z_{1-\\alpha/2} \\bigg| \\mu_R - \\mu_N = \\delta \\right) $$\n为了评估此概率，我们在备择假设下对随机变量 $\\bar{A}_R - \\bar{A}_N$ 进行标准化，即减去其真实均值 $\\delta$ 并除以其标准误：\n$$ Z' = \\frac{(\\bar{A}_R - \\bar{A}_N) - \\delta}{\\sigma\\sqrt{\\frac{2}{n}}} \\sim N(0, 1) $$\n我们根据效能的定义，用 $Z'$ 重写不等式：\n$$ \\bar{A}_R - \\bar{A}_N > z_{1-\\alpha/2} \\cdot \\sigma\\sqrt{\\frac{2}{n}} $$\n$$ (\\bar{A}_R - \\bar{A}_N) - \\delta > z_{1-\\alpha/2} \\cdot \\sigma\\sqrt{\\frac{2}{n}} - \\delta $$\n$$ \\frac{(\\bar{A}_R - \\bar{A}_N) - \\delta}{\\sigma\\sqrt{\\frac{2}{n}}} > z_{1-\\alpha/2} - \\frac{\\delta}{\\sigma\\sqrt{\\frac{2}{n}}} $$\n$$ Z' > z_{1-\\alpha/2} - \\frac{d}{\\sqrt{\\frac{2}{n}}} $$\n此事件的概率即为效能 $1-\\beta$。根据分位数的定义，$P(Z' > z_{\\beta}) = 1-\\beta$。根据正态分布的对称性，$z_{\\beta} = -z_{1-\\beta}$。因此，$P(Z' > -z_{1-\\beta}) = 1-\\beta$。\n这意味着：\n$$ -z_{1-\\beta} = z_{1-\\alpha/2} - \\frac{d}{\\sqrt{\\frac{2}{n}}} $$\n重新整理以求解 $n$，我们得到样本量的一般公式：\n$$ \\frac{d}{\\sqrt{\\frac{2}{n}}} = z_{1-\\alpha/2} + z_{1-\\beta} $$\n$$ \\sqrt{n} = \\frac{\\sqrt{2}(z_{1-\\alpha/2} + z_{1-\\beta})}{d} $$\n$$ n = \\frac{2(z_{1-\\alpha/2} + z_{1-\\beta})^2}{d^2} $$\n现在我们代入给定的值。效能为 $1-\\beta = 0.80$，所以我们需要分位数 $z_{1-\\beta} = z_{0.80}$。四舍五入到四位有效数字，该值为：\n$$ z_{0.80} \\approx 0.8416 $$\n我们有以下值：\n$d = 0.8$\n$z_{1-\\alpha/2} = z_{0.975} \\approx 1.960$\n$z_{1-\\beta} = z_{0.80} \\approx 0.8416$\n\n将这些值代入 $n$ 的公式中：\n$$ n = \\frac{2(1.960 + 0.8416)^2}{(0.8)^2} $$\n$$ n = \\frac{2(2.8016)^2}{0.64} $$\n$$ n = \\frac{2 \\times 7.84896256}{0.64} $$\n$$ n = \\frac{15.69792512}{0.64} $$\n$$ n \\approx 24.528008 $$\n问题要求将最终所需的每组样本量向上取整到下一个完整的小鼠数量。样本量为 $24$ 会提供略低于目标效能的效能，因此我们必须向上取整以确保达到效能要求。\n$$ n = 25 $$\n因此，每组最少需要 $25$ 只小鼠。",
            "answer": "$$\\boxed{25}$$"
        },
        {
            "introduction": "实验设计完成后，下一步便是数据分析。微生物组数据是典型的“组分数据”，其相对丰度总和为一，这给直接进行统计分析带来了挑战。本练习  将介绍中心化对数比（CLR）变换来处理这类数据，并演示如何使用逻辑回归模型计算优势比（Odds Ratio），这是衡量单个微生物丰度与临床反应关联强度的关键指标。",
            "id": "4359730",
            "problem": "一个由$8$名接受抗程序性死亡蛋白$1$（PD-1）免疫疗法的患者组成的队列，接受了基线粪便微生物组组成的分析，该分析涵盖$4$个分类单元：Akkermansia、Bacteroides、Faecalibacterium和“其他”(Other)。对于每位患者$i$，其组成是一个严格为正的相对丰度向量$\\{a_{i,\\mathrm{Akk}}, a_{i,\\mathrm{Bac}}, a_{i,\\mathrm{Fae}}, a_{i,\\mathrm{Oth}}\\}$，其总和为$1$，这符合成分数据的特性。二元临床响应结果记为$Y_i \\in \\{0,1\\}$，其中$1$表示客观缓解，$0$表示无缓解。\n\n这$8$名患者的组成和响应结果如下：\n- 患者$1$–$4$（低Akkermansia组）：$a_{i,\\mathrm{Akk}}=0.05$，$a_{i,\\mathrm{Bac}}=0.45$，$a_{i,\\mathrm{Fae}}=0.30$，$a_{i,\\mathrm{Oth}}=0.20$；结果为$Y_1=0$，$Y_2=0$，$Y_3=0$，$Y_4=1$。\n- 患者$5$–$8$（高Akkermansia组）：$a_{i,\\mathrm{Akk}}=0.20$，$a_{i,\\mathrm{Bac}}=0.35$，$a_{i,\\mathrm{Fae}}=0.25$，$a_{i,\\mathrm{Oth}}=0.20$；结果为$Y_5=1$，$Y_6=1$，$Y_7=0$，$Y_8=1$。\n\n使用自然对数的中心对数比（CLR）变换，将每位患者的Akkermansia CLR坐标定义为\n$$\nz_{i,\\mathrm{Akk}} \\equiv \\ln(a_{i,\\mathrm{Akk}}) - \\frac{1}{4}\\Big(\\ln(a_{i,\\mathrm{Akk}})+\\ln(a_{i,\\mathrm{Bac}})+\\ln(a_{i,\\mathrm{Fae}})+\\ln(a_{i,\\mathrm{Oth}})\\Big).\n$$\n\n设四分位距（IQR）使用Tukey的定义计算为$\\mathrm{IQR} = Q_3 - Q_1$，其中数据为多重集$\\{z_{i,\\mathrm{Akk}}: i=1,\\dots,8\\}$。考虑一个关于响应概率$p_i \\equiv \\Pr(Y_i=1)$的单预测变量逻辑斯谛回归模型，\n$$\n\\ln\\left(\\frac{p_i}{1-p_i}\\right) = \\alpha + \\beta\\, z_{i,\\mathrm{Akk}},\n$$\n其中$\\alpha$和$\\beta$是参数。\n\n从二项式似然和logit链接函数的基本原理出发，并利用$z_{i,\\mathrm{Akk}}$在整个队列中只取两个不同值这一事实，通过将拟合对数几率与这两个不同预测变量值处的经验对数几率相等来推导$\\beta$。然后计算Akkermansia CLR每增加一个$\\mathrm{IQR}$的响应优势比，定义为\n$$\n\\mathrm{OR}_{\\mathrm{IQR}} \\equiv \\exp\\big(\\beta \\cdot \\mathrm{IQR}\\big).\n$$\n\n给出$\\mathrm{OR}_{\\mathrm{IQR}}$的最终数值，四舍五入到四位有效数字。最终答案中不要包含任何单位。",
            "solution": "该问题是有效的，因为它有科学依据，定义明确，客观，并且没有任何矛盾或歧义。将推导解答。\n\n问题要求计算Akkermansia CLR坐标每增加一个$\\mathrm{IQR}$时，响应的优势比。让我们逐步进行。\n\n首先，我们确定所有患者的预测变量值$z_{i,\\mathrm{Akk}}$。\n患者被分为两个具有不同组成的组。同一组内的所有患者具有相同的组成，因此他们将具有相同的Akkermansia CLR坐标。\n\n设$z_L$为低Akkermansia组（患者1–4）的CLR坐标，$z_H$为高Akkermansia组（患者5–8）的CLR坐标。\n整个8名患者队列的CLR坐标集为$\\{z_L, z_L, z_L, z_L, z_H, z_H, z_H, z_H\\}$。\n无需完成计算，很明显$z_L \\neq z_H$。数值上，$z_L \\approx -1.3438$且$z_H \\approx -0.1957$，所以$z_L < z_H$。\n\n接下来，我们计算$z_{i,\\mathrm{Akk}}$值集合的四分位距（IQR）。排序后的数据集是$\\{z_L, z_L, z_L, z_L, z_H, z_H, z_H, z_H\\}$。\n根据Tukey的定义，第一四分位数（$Q_1$）是数据下半部分的中位数，第三四分位数（$Q_3$）是数据上半部分的中位数。\n数据集有$N=8$个点。下半部分是前$4$个点$\\{z_L, z_L, z_L, z_L\\}$，上半部分是后$4$个点$\\{z_H, z_H, z_H, z_H\\}$。\n下半部分的中位数是$\\frac{z_L + z_L}{2} = z_L$。因此，$Q_1 = z_L$。\n上半部分的中位数是$\\frac{z_H + z_H}{2} = z_H$。因此，$Q_3 = z_H$。\n因此，四分位距为$\\mathrm{IQR} = Q_3 - Q_1 = z_H - z_L$。\n\n现在，我们通过将两个组的拟合对数几率与经验对数几率相等，从逻辑斯谛回归模型中推导出参数$\\beta$。\n一个组的经验对数几率由$\\ln(\\frac{k}{n-k})$给出，其中$k$是响应者数量，$n$是该组的总患者数。\n\n对于低Akkermansia组（预测变量值为$z_L$）：\n- 患者数量$n_L=4$。\n- 结果是$\\{0,0,0,1\\}$。\n- 响应者数量$k_L=1$。\n- 经验对数几率是$\\ln\\left(\\frac{1}{4-1}\\right) = \\ln\\left(\\frac{1}{3}\\right) = -\\ln(3)$。\n\n对于高Akkermansia组（预测变量值为$z_H$）：\n- 患者数量$n_H=4$。\n- 结果是$\\{1,1,0,1\\}$。\n- 响应者数量$k_H=3$。\n- 经验对数几率是$\\ln\\left(\\frac{3}{4-3}\\right) = \\ln\\left(\\frac{3}{1}\\right) = \\ln(3)$。\n\n逻辑斯谛回归模型为$\\ln\\left(\\frac{p_i}{1-p_i}\\right) = \\alpha + \\beta z_{i,\\mathrm{Akk}}$。将模型的拟合对数几率与每个组的经验对数几率相等，得到一个包含两个未知数$\\alpha$和$\\beta$的二元线性方程组：\n1. 对于低丰度组：$\\alpha + \\beta z_L = -\\ln(3)$\n2. 对于高丰度组：$\\alpha + \\beta z_H = \\ln(3)$\n\n为了求出$\\beta$，我们将第一个方程从第二个方程中减去：\n$(\\alpha + \\beta z_H) - (\\alpha + \\beta z_L) = \\ln(3) - (-\\ln(3))$\n$\\beta(z_H - z_L) = 2\\ln(3)$\n解出$\\beta$：\n$\\beta = \\frac{2\\ln(3)}{z_H - z_L}$\n\n最后，我们计算Akkermansia CLR每增加一个IQR的响应优势比，定义为$\\mathrm{OR}_{\\mathrm{IQR}} \\equiv \\exp(\\beta \\cdot \\mathrm{IQR})$。\n我们代入$\\beta$和$\\mathrm{IQR}$的表达式：\n$\\mathrm{OR}_{\\mathrm{IQR}} = \\exp\\left( \\left(\\frac{2\\ln(3)}{z_H - z_L}\\right) \\cdot (z_H - z_L) \\right)$\n\n由于$z_H \\neq z_L$，项$(z_H - z_L)$被消去：\n$\\mathrm{OR}_{\\mathrm{IQR}} = \\exp(2\\ln(3))$\n\n使用对数性质$\\exp(k\\ln x) = x^k$：\n$\\mathrm{OR}_{\\mathrm{IQR}} = 3^2 = 9$\n\n题目要求答案四舍五入到四位有效数字。精确值为$9$。用四位有效数字表示为$9.000$。",
            "answer": "$$\\boxed{9.000}$$"
        },
        {
            "introduction": "真实世界的宏基因组学研究通常会同时检测成百上千个微生物类群，这极大地增加了出现假阳性结果的风险。因此，控制统计错误是确保结论可靠性的关键。最后一个练习  将聚焦于此，通过应用Benjamini-Hochberg程序来控制错误发现率（FDR），让你掌握在高维数据分析中去伪存真的重要技能。",
            "id": "4359595",
            "problem": "在一项关于抗程序性死亡-1 (PD-1) 免疫疗法的精准肿瘤学研究中，通过宏基因组鸟枪法测序对基线肠道微生物组的分类谱进行了量化。针对 $m=200$ 个分类单元中的每一个，拟合了一个逻辑斯谛回归模型，以检验标准化基线相对丰度与客观缓解之间的关联，同时对测序深度和东部肿瘤协作组 (ECOG) 体能状态进行了调整。假设得出的原始 $p$ 值经过了适当校准，因此在真实零假设下，$p$ 值独立同分布于 Uniform$(0,1)$，而在备择假设下，它们随机更小。将原始 $p$ 值从小到大排序后得到：\n$$\np_{(i)} = \\frac{i}{2000}, \\quad i=1,2,\\dots,200.\n$$\n使用 Benjamini–Hochberg (BH) 程序将错误发现率 (FDR) 控制在 $q=0.1$ 的水平，确定被宣告为显著的分类单元总数。将最终答案以单个整数形式报告。无需四舍五入。",
            "solution": "该问题要求对一组给定的 $p$ 值应用 Benjamini–Hochberg (BH) 程序，以在控制错误发现率 (FDR) 的同时，确定显著发现的数量。\n\n首先，我们必须正式陈述 BH 程序。假设有 $m$ 个独立的假设检验，产生一组 $p$ 值 $\\{p_1, p_2, \\dots, p_m\\}$。将这些 $p$ 值从小到大排序：$p_{(1)} \\leq p_{(2)} \\leq \\dots \\leq p_{(m)}$。为了将 FDR 控制在水平 $q$，BH 程序如下：\n\n找到满足以下不等式的最大整数 $k \\in \\{1, 2, \\dots, m\\}$：\n$$\np_{(k)} \\leq \\frac{k}{m}q\n$$\n如果存在这样的 $k$，则所有对于 $i=1, 2, \\dots, k$ 的零假设 $H_{(i)}$ 都被拒绝。如果不存在这样的 $k$，则没有假设被拒绝。因此，被拒绝的假设数量，即显著发现的数量，就是这个值 $k$。\n\n从问题陈述中，我们提取必要的参数：\n1. 测试的分类单元总数，即假设的数量：$m = 200$。\n2. 期望的 FDR 控制水平：$q = 0.1$。\n3. 排序后的原始 $p$ 值由以下公式给出：\n$$\np_{(i)} = \\frac{i}{2000}, \\quad \\text{for } i=1, 2, \\dots, 200.\n$$\n\n我们需要在范围 $1 \\leq k \\leq 200$ 内找到满足 BH 不等式的最大整数 $k$：\n$$\np_{(k)} \\leq \\frac{k}{m}q\n$$\n我们将 $p_{(k)}$ 的给定公式以及 $m$ 和 $q$ 的值代入此不等式。对于任何索引 $i$（我们将作为 $k$ 的候选值进行检验），不等式为：\n$$\n\\frac{i}{2000} \\leq \\frac{i}{200} \\times 0.1\n$$\n让我们简化不等式的右边。值 $0.1$ 可以表示为分数 $\\frac{1}{10}$。\n$$\n\\frac{i}{2000} \\leq \\frac{i}{200} \\times \\frac{1}{10}\n$$\n$$\n\\frac{i}{2000} \\leq \\frac{i}{2000}\n$$\n这个不等式 $i/2000 \\leq i/2000$ 对任何正整数 $i$ 都成立。问题定义 $i$ 的范围是从 $1$ 到 $200$。因此，对于索引 $i$ 的所有可能值，该条件都满足。\n\nBH 程序要求我们找到满足条件 $p_{(k)} \\leq \\frac{k}{m}q$ 的索引的*最大*值，我们将其表示为 $k$。由于该条件对从 $i=1$ 到 $i=200$ 的所有整数都满足，因此最大的此类整数是该索引的最大可能值。\n这个集合中的最大索引是 $m=200$。所以，我们设 $k=200$。让我们验证 $k=200$ 的情况：\n$$\np_{(200)} = \\frac{200}{2000} = \\frac{1}{10} = 0.1\n$$\n$k=200$ 时的 BH 阈值为：\n$$\n\\frac{k}{m}q = \\frac{200}{200} \\times 0.1 = 1 \\times 0.1 = 0.1\n$$\n不等式为 $0.1 \\leq 0.1$，这是成立的。\n由于不等式对 $k = 200$ 成立，并且这是可能的最大索引，我们已经找到了 $k$ 的值。\n\n根据 BH 程序，所有对应于排序后 $p$ 值 $p_{(1)}, p_{(2)}, \\dots, p_{(k)}$ 的零假设都被拒绝。当 $k=200$ 时，这意味着所有 $200$ 个假设都被拒绝。\n\n因此，被宣告为显著的分类单元总数为 $200$。",
            "answer": "$$\\boxed{200}$$"
        }
    ]
}