{
    "hands_on_practices": [
        {
            "introduction": "设计任何宏基因组测序实验的一个基本方面是确定所需的测序深度。本练习从第一性原理出发，探讨了总测序读数 ($N$)、读长 ($L$)、病原体丰度 ($f$) 与最终获得的平均基因组覆盖度 ($C$) 之间的核心关系。通过推导覆盖度公式，你将对实验参数如何直接影响成功检测和组装病原体基因组的可能性建立起定量的直觉。",
            "id": "4358557",
            "problem": "一次使用下一代测序 (NGS) 的临床全宏基因组鸟枪法 (WMS) 测序运行从一个异构样本中产生 $N$ 个独立的固定长度为 $L$ 个碱基对的读段。假设测序读段中的一部分（比例为 $f$）来自一个单一病原体物种，其单倍体基因组长度为 $G$ 个碱基对。假设样本中分子的抽样是无偏且均匀的，读段的来源在适当时能被正确地分配给病原体，并且相对于 $L \\ll G$，末端效应可以忽略不计。仅使用测序产量和基因组覆盖度的基本定义，推导病原体的预期平均基因组覆盖度 $C$（无量纲的倍数值）关于 $N$、$L$、$f$ 和 $G$ 的闭式解析表达式。然后，计算当 $N = 5.0 \\times 10^{7}$ 个读段，$L = 150$ 个碱基对，$f = 10^{-3}$，以及 $G = 5$ 兆碱基时 $C$ 的数值，其中 1 兆碱基等于 $10^{6}$ 个碱基对。将最终数值答案表示为无量纲的覆盖倍数，并四舍五入到四位有效数字。",
            "solution": "用户提供了一个问题陈述。我现在将执行强制性验证程序。\n\n### 步骤 1：提取已知条件\n- $N$：独立读段的总数\n- $L$：每个读段的固定长度（以碱基对为单位）\n- $f$：源自单一病原体物种的读段比例\n- $G$：病原体的单倍体基因组长度（以碱基对为单位）\n- $C$：病原体的预期平均基因组覆盖度\n- 假设：分子的无偏、均匀抽样\n- 假设：读段来源被正确分配\n- 假设：末端效应可以忽略 ($L \\ll G$)\n- 用于计算的数值：\n  - $N = 5.0 \\times 10^{7}$ 个读段\n  - $L = 150$ 个碱基对\n  - $f = 10^{-3}$\n  - $G = 5$ 兆碱基，其中 1 兆碱基等于 $10^{6}$ 个碱基对\n- 任务 1：推导 $C$ 关于 $N$、$L$、$f$ 和 $G$ 的闭式解析表达式。\n- 任务 2：计算 $C$ 的数值并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n\n- **科学依据**：该问题基于基因组学和生物信息学的基本原理，特别是鸟枪法测序和基因组覆盖度的概念。该场景是宏基因组实验的标准表示。\n- **适定性**：该问题是适定的。它提供了所有必要的参数和简化假设（例如，均匀抽样、可忽略的末端效应），以推导出预期平均覆盖度的唯一、有意义的解。\n- **客观性**：该问题以精确、客观和定量的术语陈述。它不含任何主观或基于意见的内容。\n- **缺陷清单**：该问题未表现出任何列出的缺陷。\n  1. 它在科学上和事实上是合理的。\n  2. 它可以直接形式化，并且与指定主题高度相关。\n  3. 它是完整的且内部一致的。\n  4. 所提供的数值对于现代下一代测序 (NGS) 实验是现实的。\n  5. 它结构良好，并能导出一个唯一的解。\n  6. 这是生物信息学中一个基础但非平凡的概念性问题。\n  7. 推导和结果在数学上是可验证的。\n\n### 步骤 3：结论和行动\n该问题是**有效的**。将提供完整的解答。\n\n问题要求从宏基因组测序数据集中推导病原体的预期平均基因组覆盖度 $C$，然后进行数值计算。\n\n首先，我们定义实验中生成的测序数据总量。实验产生 $N$ 个读段，每个读段的长度为 $L$。因此，测序的总碱基对数（总产量）是读段数与每个读段长度的乘积。\n$$\n\\text{总产量} = N \\times L\n$$\n\n接下来，我们确定此总产量中对应于目标病原体的部分。问题指出，比例为 $f$ 的读段源自该病原体。由于抽样是无偏的，这个比例也代表了属于该病原体的总测序碱基的比例。因此，从病原体测序得到的总碱基对数，我们可以表示为 $B_{pathogen}$：\n$$\nB_{pathogen} = f \\times (\\text{总产量}) = f \\times N \\times L\n$$\n\n平均基因组覆盖度 $C$ 定义为为特定基因组测序的总碱基数除以该基因组的长度。这给出了一个无量纲的“倍数”值，表示平均而言，基因组中的每个碱基被测序了多少次。使用病原体的基因组长度 $G$，我们可以将覆盖度的定义写为：\n$$\nC = \\frac{B_{pathogen}}{G}\n$$\n\n将 $B_{pathogen}$ 的表达式代入 $C$ 的定义，我们得到病原体预期平均基因组覆盖度的闭式解析表达式：\n$$\nC = \\frac{f \\times N \\times L}{G}\n$$\n这就完成了任务的第一部分。\n\n对于第二部分，我们必须使用所提供的数据计算 $C$ 的数值。给定的值为：\n- $N = 5.0 \\times 10^{7}$ 个读段\n- $L = 150$ 个碱基对 (bp)\n- $f = 10^{-3}$\n- $G = 5$ 兆碱基。我们必须将其转换为碱基对。因为 1 兆碱基是 $10^{6}$ 个碱基对，所以 $G = 5 \\times 10^{6}$ bp。\n\n现在，我们将这些值代入我们推导出的公式：\n$$\nC = \\frac{(10^{-3}) \\times (5.0 \\times 10^{7}) \\times (150)}{5 \\times 10^{6}}\n$$\n\n让我们来简化这个表达式。\n首先，我们计算分子：\n$$\n\\text{分子} = 10^{-3} \\times 5.0 \\times 10^{7} \\times 150 = 5.0 \\times 10^{(7-3)} \\times 150 = 5.0 \\times 10^{4} \\times 150\n$$\n$$\n\\text{分子} = (5.0 \\times 150) \\times 10^{4} = 750 \\times 10^{4} = 7.5 \\times 10^{2} \\times 10^{4} = 7.5 \\times 10^{6}\n$$\n\n分母是：\n$$\n\\text{分母} = 5 \\times 10^{6}\n$$\n\n现在，我们计算 $C$ 的比率：\n$$\nC = \\frac{7.5 \\times 10^{6}}{5 \\times 10^{6}} = \\frac{7.5}{5} = 1.5\n$$\n\n结果是无量纲的覆盖倍数 $1.5$X。问题要求答案四舍五入到四位有效数字。为了用四位有效数字表示 $1.5$，我们添加后缀零。\n$$\nC = 1.500\n$$\n均匀抽样和正确读段分配的假设对此计算至关重要，因为它们允许我们直接使用比例 $f$ 来量化特定于病原体的测序产量。$L \\ll G$ ($150 \\ll 5 \\times 10^{6}$) 的假设证明了忽略边缘效应是合理的，例如可能延伸出线性染色体末端的读段，这是此类分析中的标准简化。",
            "answer": "$$\\boxed{1.500}$$"
        },
        {
            "introduction": "在宏转录组学研究中，样本中的绝大多数RNA通常是信息量较低的核糖体RNA (rRNA)，这会掩盖来自稀有病原体的信号。本练习旨在量化rRNA去除技术的效果，这是一种常用的实验室技术，可通过去除rRNA来富集病毒RNA等目标分子。你将学习如何计算病原体特异性读数的倍数增长，这是评估样本制备策略有效性和优化信噪比的一项关键技能。",
            "id": "4358568",
            "problem": "在一个用于病原体鉴定的宏转录组下一代测序 (mNGS) 工作流程中，一份来自临床样本的总RNA样本包含初始核糖体RNA (rRNA) 组分$0.85$和非核糖体RNA (non-rRNA) 组分$0.15$。该样本经过效率为$0.95$的酶促rRNA去除处理，其中效率定义为被去除的rRNA分子比例，而非rRNA物种（包括病毒RNA）不受影响。进行文库制备和测序，使得去除文库和未去除文库的最终测序深度经过标准化后相等。假设测序读数是根据输入文库的分子组成随机且成比例地抽样的，并且rRNA去除不会在非rRNA物种中引入脱靶损失或偏好。\n\n仅使用混合物组分、去除效率和比例抽样的第一性原理定义，推导去除文库中去除后非rRNA的组分，以及相对于在相同测序深度下其他方面相同的未去除文库，病毒读数的预期倍数增长。将非rRNA组分表示为$0$到$1$之间的小数，并将病毒读数增益表示为无单位的倍数变化。将这两个量均四舍五入至四位有效数字。",
            "solution": "该问题陈述经评估是有效的。它在科学上基于分子生物学和下一代测序的原理，特别是RNA-seq样本制备。所提供的数据内部一致，问题是良定的、客观的，并包含足够的信息以得到唯一解。该问题可以使用混合物组分和比例抽样的第一性原理进行形式化和求解。\n\n让我们定义总RNA样本的初始状态。RNA分子的总数为$N_{total}$。该样本是核糖体RNA (rRNA) 和非核糖体RNA (non-rRNA) 的双组分混合物。\n\nrRNA的初始组分给定为 $F_{rRNA, pre} = 0.85$。\nnon-rRNA的初始组分给定为 $F_{non-rRNA, pre} = 0.15$。\n这些组分之和为 $F_{rRNA, pre} + F_{non-rRNA, pre} = 0.85 + 0.15 = 1$，符合预期。\n\n每个组分的初始分子数可以表示为：\n初始rRNA分子数：$N_{rRNA, pre} = F_{rRNA, pre} \\times N_{total}$\n初始non-rRNA分子数：$N_{non-rRNA, pre} = F_{non-rRNA, pre} \\times N_{total}$\n\n样本经过效率为 $\\eta = 0.95$ 的酶促rRNA去除。效率定义为被去除的rRNA分子的比例。该过程被指定为不影响非rRNA物种。\n\n去除的rRNA分子数为 $\\eta \\times N_{rRNA, pre}$。\n去除后剩余的rRNA分子数为：\n$$N_{rRNA, post} = N_{rRNA, pre} - (\\eta \\times N_{rRNA, pre}) = (1 - \\eta) N_{rRNA, pre}$$\n代入初始组分定义：\n$$N_{rRNA, post} = (1 - \\eta) F_{rRNA, pre} N_{total}$$\n\n由于非rRNA物种不受影响，其数量保持不变：\n$$N_{non-rRNA, post} = N_{non-rRNA, pre} = F_{non-rRNA, pre} N_{total}$$\n\n去除后文库中的分子总数 $N_{total, post}$ 是剩余rRNA和non-rRNA分子的总和：\n$$N_{total, post} = N_{rRNA, post} + N_{non-rRNA, post}$$\n$$N_{total, post} = (1 - \\eta) F_{rRNA, pre} N_{total} + F_{non-rRNA, pre} N_{total}$$\n$$N_{total, post} = \\left[ (1 - \\eta) F_{rRNA, pre} + F_{non-rRNA, pre} \\right] N_{total}$$\n\n第一个要推导的量是去除后非rRNA的组分 $F_{non-rRNA, post}$。这是去除后非rRNA分子数与去除后分子总数的比率。\n$$F_{non-rRNA, post} = \\frac{N_{non-rRNA, post}}{N_{total, post}} = \\frac{F_{non-rRNA, pre} N_{total}}{\\left[ (1 - \\eta) F_{rRNA, pre} + F_{non-rRNA, pre} \\right] N_{total}}$$\n$N_{total}$ 项被消去，得到一个通用公式：\n$$F_{non-rRNA, post} = \\frac{F_{non-rRNA, pre}}{(1 - \\eta) F_{rRNA, pre} + F_{non-rRNA, pre}}$$\n代入给定的数值：$F_{rRNA, pre} = 0.85$， $F_{non-rRNA, pre} = 0.15$ 和 $\\eta = 0.95$。\n$$F_{non-rRNA, post} = \\frac{0.15}{(1 - 0.95) \\times 0.85 + 0.15}$$\n$$F_{non-rRNA, post} = \\frac{0.15}{0.05 \\times 0.85 + 0.15} = \\frac{0.15}{0.0425 + 0.15} = \\frac{0.15}{0.1925}$$\n$$F_{non-rRNA, post} \\approx 0.779220779...$$\n四舍五入至四位有效数字，去除后non-rRNA的组分为 $0.7792$。\n\n第二个要推导的量是病毒读数的预期倍数增长，我们将其记为$G$。病毒RNA是non-rRNA组分的一部分。问题陈述指出，测序读数是根据输入文库的分子组成随机且成比例地抽样的。这意味着对应于特定RNA物种的读数组分等于该物种在被测序文库中的分子组分。问题还指出，去除过程在非rRNA物种中没有引入脱靶损失或偏好，这意味着non-rRNA池的相对组成保持不变。\n\n设$c_{v}$为non-rRNA组分中病毒RNA的恒定比例。\n在未去除（去除前）文库中，病毒RNA的分子组分为：\n$$F_{viral, pre} = \\frac{N_{viral, pre}}{N_{total}} = \\frac{c_v \\times N_{non-rRNA, pre}}{N_{total}} = c_v \\times F_{non-rRNA, pre}$$\n在去除（去除后）文库中，病毒RNA的分子组分为：\n$$F_{viral, post} = \\frac{N_{viral, post}}{N_{total, post}} = \\frac{c_v \\times N_{non-rRNA, post}}{N_{total, post}} = c_v \\times F_{non-rRNA, post}$$\n病毒分子的数量不变，$N_{viral, post} = N_{viral, pre}$，因为它是未受影响的non-rRNA池的一部分。\n\n病毒读数的倍数增长$G$是去除文库中病毒读数组分与未去除文库中病毒读数组分的比率。由于读数组分与分子组分成正比，因此：\n$$G = \\frac{F_{viral, post}}{F_{viral, pre}} = \\frac{c_v \\times F_{non-rRNA, post}}{c_v \\times F_{non-rRNA, pre}}$$\n$c_v$项被消去，表明结果与病毒的初始丰度无关。因此，倍数增长是去除后non-rRNA组分与去除前non-rRNA组分的比率。\n$$G = \\frac{F_{non-rRNA, post}}{F_{non-rRNA, pre}}$$\n使用先前计算的$F_{non-rRNA, post}$的未四舍五入值和给定的$F_{non-rRNA, pre}$值：\n$$G = \\frac{0.779220779...}{0.15} \\approx 5.19480519...$$\n四舍五入至四位有效数字，倍数增长为$5.195$。\n\n其物理意义是，通过去除大部分非靶标rRNA分子，剩余的non-rRNA分子（包括病毒RNA）被富集，从而在最终文库中占据了更大的比例。因此，任何非rRNA物种的测序读数增益等于总non-rRNA池的富集因子。\n\n所要求的两个量是四舍五入至四位有效数字的去除后non-rRNA组分，以及四舍五入至四位有效数字的病毒读数增益。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7792 & 5.195\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "多重测序，即在单次测序运行中混合多个样本，是提高效率的标准做法，但它也引入了“索引跳跃”（index hopping）的风险，即测序读数被错误地分配到其他样本中。本练习运用基本概率和期望值的概念，来建模并量化从一个高丰度样本到低生物量样本的交叉污染水平。掌握这种计算对于设定合适的分析阈值、并自信地区分真实的低水平感染与由技术假象引起的背景噪音至关重要。",
            "id": "4358600",
            "problem": "一家临床实验室为了进行病原体鉴定，对疑似中枢神经系统感染的脑脊液样本进行宏基因组下一代测序(mNGS)多重处理。在一个测序批次中，共有 $N = 96$ 个文库：其中 $N_{\\text{high}} = 1$ 个是含有 Escherichia coli DNA 的高丰度阳性对照文库，另有 $N_{\\text{low}} = 95$ 个是低生物量临床文库。该高丰度文库产生了 $R_{\\text{high}} = 5.0 \\times 10^{6}$ 条映射到 Escherichia coli 的读数。在该测序批次中，有效的单条读数索引错配（包括索引跳跃及任何等效的条形码错配）率为 $r = 0.002$。假设当一条读数被错配时，它被分配到其真实来源以外的任何其他文库的概率是均等的，并且为了本次计算，可以忽略源自低生物量文库并错配到高丰度文库的读数。\n\n请仅使用应用于独立伯努利试验的期望值的基本概率定义，从第一性原理推导，在单个低生物量文库中，由源自高丰度文库的读数错配所导致的 Escherichia coli 污染读数的期望数量。陈述为使计算良定义所需的任何额外的最小假设。\n\n将最终结果四舍五入至四位有效数字。以读数(reads)为单位表示最终的期望数量。",
            "solution": "在尝试求解之前，首先对问题陈述的科学合理性、一致性和完整性进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n问题陈述中提供了以下量和条件：\n- 测序批次中的文库总数：$N = 96$。\n- 高丰度阳性对照文库的数量：$N_{\\text{high}} = 1$。\n- 低生物量临床文库的数量：$N_{\\text{low}} = 95$。\n- 源自高丰度文库且映射到 *Escherichia coli* 的读数数量：$R_{\\text{high}} = 5.0 \\times 10^{6}$。\n- 有效的单条读数索引错配率：$r = 0.002$。\n- 条件1：当一条读数被错配时，它被分配到其真实来源以外的任何其他文库的概率是均等的。\n- 条件2：源自低生物量文库并错配到高丰度文库的读数可以忽略不计。\n- 任务：从第一性原理推导单个低生物量文库中 *E. coli* 污染读数的期望数量。\n- 约束：推导过程必须使用应用于独立伯努利试验的期望值的基本概率定义。\n- 最终输出：结果必须四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n\n- **科学上合理**：该问题设定在宏基因组下一代测序（mNGS）的背景下，这是现代基因组诊断学中的一种标准技术。索引错配（或索引跳跃）是多重测序实验中一种有据可查的假象。给定的文库数量（$N=96$）、对照的读数数量（$R_{\\text{high}} = 5.0 \\times 10^{6}$）以及错配率（$r=0.002$）对于在诸如Illumina等平台上进行的典型测序批次是符合实际的。主题内容与指定的*用于病原体鉴定的宏基因组测序*主题直接相关。\n- **良定义的**：问题陈述清晰，包含足够的信息来推导出唯一解。数字是一致的（$N_{\\text{high}} + N_{\\text{low}} = 1 + 95 = 96 = N$）。条件提供了一个清晰的概率模型。\n- **客观的**：问题使用精确、客观的科学语言陈述，没有歧义或主观论断。\n\n**步骤3：结论与行动**\n\n该问题在科学上合理、自洽、良定义且客观。它没有违反任何无效标准。因此，该问题被判定为**有效**，并将推导求解。\n\n### 解题推导\n\n目标是计算由于索引错配，源自高丰度 *E. coli* 对照文库但被错误地分配到一个特定低生物量文库的读数的期望数量。我们将按要求从第一性原理进行推导。\n\n让我们考虑源自高丰度文库的 $R_{\\text{high}}$ 条读数中的任意一条。我们关心的事件是这条特定的读数被错配，并最终进入某一个特定的低生物量文库。我们将这个特定的文库称为“目标文库”。\n\n这个过程可以被建模为一系列 $R_{\\text{high}}$ 次独立的伯努利试验，其中每次试验对应一条读数。对于每次试验（即对于每一条读数），“成功”定义为该读数被错配到我们的特定目标文库。\n\n设 $p$ 为单次试验成功的概率。该事件的发生需要满足两个独立的条件：\n1.  该读数被错配。其概率即为索引错配率，$P(\\text{misassigned}) = r$。\n2.  在该读数被错配的条件下，它被分配到我们的特定目标文库。问题陈述指出，一条错配的读数被分配到其真实来源以外的任何其他文库的概率是均等的。总共有 $N$ 个文库，所以一条错配的读数有 $N-1$ 个可能的去向。因为有 $N_{\\text{low}} = 95$ 个低生物量文库，并且 $N-1 = 96-1 = 95$，所以可能的去向集合恰好是所有低生物量文库的集合。因此，该错配读数落入任何一个特定目标文库的概率为 $P(\\text{to target} | \\text{misassigned}) = \\frac{1}{N-1}$。\n\n来自高丰度文库的单条读数污染特定目标文库的概率 $p$ 是这两个事件概率的乘积：\n$$p = P(\\text{misassigned}) \\times P(\\text{to target} | \\text{misassigned}) = r \\cdot \\frac{1}{N-1}$$\n\n现在，令 $X$ 为代表目标文库中污染读数总数的随机变量。我们可以将 $X$ 表示为 $R_{\\text{high}}$ 个独立同分布 (i.i.d.) 的指示随机变量 $X_i$ 的和，其中 $i = 1, 2, \\dots, R_{\\text{high}}$：\n$$X = \\sum_{i=1}^{R_{\\text{high}}} X_i$$\n其中，如果第 $i$ 条读数是“成功”的（即污染了目标文库），则 $X_i=1$；否则 $X_i=0$。\n\n根据定义，单个指示随机变量 $X_i$ 的期望值为：\n$$E[X_i] = (1 \\cdot P(X_i=1)) + (0 \\cdot P(X_i=0)) = P(X_i=1) = p$$\n\n根据期望的线性性质，和的期望等于期望的和：\n$$E[X] = E\\left[\\sum_{i=1}^{R_{\\text{high}}} X_i\\right] = \\sum_{i=1}^{R_{\\text{high}}} E[X_i]$$\n由于所有的 $X_i$ 都是独立同分布的，因此对所有 $i$ 都有 $E[X_i] = p$。所以：\n$$E[X] = \\sum_{i=1}^{R_{\\text{high}}} p = R_{\\text{high}} \\cdot p$$\n\n代入 $p$ 的表达式，我们得到污染读数期望数量的最终公式：\n$$E[X] = R_{\\text{high}} \\cdot \\frac{r}{N-1}$$\n\n这个从第一性原理出发的推导遵循了问题的约束条件。所做的最小假设（在问题陈述中大部分是明确或隐含给出的）如下：\n1.  $R_{\\text{high}}$ 条读数中每一条的错配都是一个独立事件（如“独立伯努利试验”所规定）。\n2.  对于所有源自高丰度文库的读数，错配率 $r$ 是恒定的。\n3.  一条错配读数的去向遵循一个在 $N-1$ 个可能的备选文库上的离散均匀概率分布。\n\n现在我们可以将给定的数值代入推导出的公式中：\n- $R_{\\text{high}} = 5.0 \\times 10^{6}$\n- $r = 0.002$\n- $N = 96$，所以 $N-1 = 95$\n\n$$E[X] = (5.0 \\times 10^{6}) \\cdot \\frac{0.002}{95}$$\n$$E[X] = \\frac{5.0 \\times 10^{6} \\times 2 \\times 10^{-3}}{95} = \\frac{10 \\times 10^{3}}{95} = \\frac{10000}{95}$$\n$$E[X] \\approx 105.263157...$$\n\n问题要求将最终结果四舍五入至四位有效数字。\n$$E[X] \\approx 105.3$$\n\n在单个低生物量文库中，*Escherichia coli* 污染读数的期望数量为 $105.3$。",
            "answer": "$$\\boxed{105.3}$$"
        }
    ]
}