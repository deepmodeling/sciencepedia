{
    "hands_on_practices": [
        {
            "introduction": "在启动任何测序项目之前，关键的第一步是估算所需资源。本练习将演示如何计算达到目标覆盖度并具有所需置信水平所需的测序芯片数量，同时考虑数据质量和产量变异性等现实世界因素。此实践应用基本的统计学原理，确保您的实验从一开始就具有足够的统计功效。",
            "id": "4356388",
            "problem": "计划使用来自 Oxford Nanopore Technologies (ONT) 或 Pacific Biosciences (PacBio) 的长读长测序技术进行临床从头人类基因组组装。目标单倍体覆盖度为$c=30$，人类单倍体基因组大小为$G=3.1$十亿碱基。每个流通池的预计原始产出为$Y$十亿碱基。由于文库和读长质量的影响，只有一部分原始产出对有效组装覆盖度有贡献：有$q=0.85$比例的碱基通过组装流程中使用的质量阈值，在去除接头和污染物后有$m=0.98$比例的碱基源自人类 DNA，并且在长度筛选后保留了$r=0.95$比例的碱基以满足组装器的最低读长要求。由于孔间和运行间的差异，每个流通池的有效产出是可变的；假设每个流通池的有效产出是独立同分布的，其变异系数为$\\gamma=0.25$（定义为标准差除以平均值）。为确保临床应用，$n$个流通池的总有效产出必须以至少$0.95$的单侧概率达到或超过目标覆盖度。\n\n仅从覆盖度的定义（预期覆盖度等于测序总碱基数除以基因组大小）和适用于独立贡献总和的标准概率极限定理出发，推导出一个关于$Y$的最小整数$n$的闭式表达式，该表达式保证有效总产出以至少$0.95$的单侧概率达到或超过对$G$的$c$倍目标。最终答案请用仅含$Y$的单个解析表达式表示，使用向上取整函数表示流通池的最小整数数量。在您的最终表达式中不要包含单位。",
            "solution": "该问题被评估为有效，因为它具有科学依据、提法明确、客观，并包含足够的信息来推导唯一解。该场景是统计学原理在基因组学实际问题中的标准应用。\n\n目标是找到所需流通池的最小整数数量$n$，以便在指定单侧概率下，对大小为$G$的基因组实现目标单倍体覆盖度$c$。\n\n首先，我们定义问题陈述中提供的参数和变量。\n- 目标单倍体覆盖度：$c = 30$。\n- 单倍体基因组大小：$G = 3.1$十亿碱基。\n- 每个流通池的预计原始产出：$Y$十亿碱基。\n- 通过质量阈值的碱基比例：$q = 0.85$。\n- 来自人类 DNA（非污染物）的碱基比例：$m = 0.98$。\n- 长度筛选后保留的碱基比例：$r = 0.95$。\n- 每个流通池有效产出的变异系数：$\\gamma = 0.25$。\n- 流通池数量，待确定的整数：$n$。\n- 要求的单侧概率：$P \\ge 0.95$。\n\n在大小为$G$的基因组上实现覆盖度$c$所需的有效碱基总数为乘积$c \\times G$。我们将此目标产出表示为$B_{\\text{target}}$。\n$$B_{\\text{target}} = cG$$\n每个流通池的原始产出$Y$会因几个因素而减少。对有效组装覆盖度有贡献的原始产出比例，我们表示为$f$，是给定比例的乘积：\n$$f = q \\times m \\times r = 0.85 \\times 0.98 \\times 0.95 = 0.79135$$\n设$y_i$是表示第$i$个流通池有效产出的随机变量。问题陈述预计原始产出为$Y$，因此我们将每个流通池的平均有效产出$\\mu_y$定为：\n$$\\mu_y = Y \\times f = 0.79135 Y$$\n问题指明，每个流通池的有效产出是独立同分布的（i.i.d.），变异系数为$\\gamma = 0.25$。变异系数定义为标准差与平均值的比率。因此，每个流通池有效产出的标准差$\\sigma_y$为：\n$$\\sigma_y = \\gamma \\mu_y = 0.25 \\times (0.79135 Y) = 0.1978375 Y$$\n来自$n$个流通池的总有效产出$T_n$是各个产出的总和：\n$$T_n = \\sum_{i=1}^n y_i$$\n由于变量$y_i$的独立同分布特性，总产出的平均值$\\mu_{T_n}$和总产出的方差$\\sigma_{T_n}^2$分别是：\n$$\\mu_{T_n} = E[T_n] = n \\mu_y = n(0.79135 Y)$$\n$$\\sigma_{T_n}^2 = \\text{Var}(T_n) = n \\sigma_y^2 = n (\\gamma \\mu_y)^2 = n \\gamma^2 \\mu_y^2 = n(0.1978375 Y)^2$$\n总产出的标准差为：\n$$\\sigma_{T_n} = \\sqrt{n \\sigma_y^2} = \\sigma_y \\sqrt{n} = \\gamma \\mu_y \\sqrt{n} = 0.1978375 Y \\sqrt{n}$$\n问题要求总有效产出$T_n$以至少$0.95$的概率达到或超过目标产出$B_{\\text{target}}$：\n$$P(T_n \\ge cG) \\ge 0.95$$\n根据问题陈述的建议（“适用于独立贡献总和的标准概率极限定理”），我们应用中心极限定理（CLT）。对于足够大的$n$，总和$T_n$的分布可以近似为均值为$\\mu_{T_n}$、标准差为$\\sigma_{T_n}$的正态分布。\n$$T_n \\sim \\mathcal{N}(\\mu_{T_n}, \\sigma_{T_n}^2)$$\n为了使用此近似，我们将变量$T_n$标准化为标准正态变量$Z \\sim \\mathcal{N}(0, 1)$：\n$$Z = \\frac{T_n - \\mu_{T_n}}{\\sigma_{T_n}}$$\n该不等式可以改写为以$Z$表示：\n$$P\\left(\\frac{T_n - \\mu_{T_n}}{\\sigma_{T_n}} \\ge \\frac{cG - \\mu_{T_n}}{\\sigma_{T_n}}\\right) \\ge 0.95$$\n$$P\\left(Z \\ge \\frac{cG - n\\mu_y}{\\sigma_y \\sqrt{n}}\\right) \\ge 0.95$$\n设$z_{0.95}$是标准正态分布的临界值，使得$P(Z \\le z_{0.95}) = 0.95$。这对应于第$95$百分位数。从标准统计表中可知，$z_{0.95} \\approx 1.645$。条件$P(Z \\ge k) \\ge 0.95$等价于$P(Z  k) \\le 0.05$。这意味着参数$k$必须小于或等于第$5$百分位数，即$-z_{0.95}$。\n因此，我们必须有：\n$$\\frac{cG - n\\mu_y}{\\sigma_y \\sqrt{n}} \\le -z_{0.95}$$\n重新整理不等式以求解$n$：\n$$cG - n\\mu_y \\le -z_{0.95} \\sigma_y \\sqrt{n}$$\n$$n\\mu_y - z_{0.95} \\sigma_y \\sqrt{n} - cG \\ge 0$$\n代入$\\mu_y = Yf$和$\\sigma_y = \\gamma Yf$：\n$$n(Yf) - z_{0.95} (\\gamma Yf) \\sqrt{n} - cG \\ge 0$$\n这是一个关于$x = \\sqrt{n}$的二次不等式：\n$$(Yf)x^2 - (z_{0.95} \\gamma Yf)x - cG \\ge 0$$\n该二次表达式对应于一个开口向上的抛物线（因为$Yf > 0$）。当$x$的值大于或等于相应二次方程$(Yf)x^2 - (z_{0.95} \\gamma Yf)x - cG = 0$的较大根时，该不等式成立。根由二次公式给出：\n$$x = \\frac{z_{0.95} \\gamma Yf \\pm \\sqrt{(-z_{0.95} \\gamma Yf)^2 - 4(Yf)(-cG)}}{2(Yf)}$$\n由于$x = \\sqrt{n}$必须为正，我们取正根：\n$$\\sqrt{n} \\ge \\frac{z_{0.95} \\gamma Yf + \\sqrt{(z_{0.95} \\gamma Yf)^2 + 4(Yf)(cG)}}{2Yf}$$\n为简化起见，我们可以将分子和分母同时除以$Yf$：\n$$\\sqrt{n} \\ge \\frac{z_{0.95} \\gamma}{2} + \\sqrt{\\frac{(z_{0.95} \\gamma Yf)^2}{(2Yf)^2} + \\frac{4YfcG}{(2Yf)^2}}$$\n$$\\sqrt{n} \\ge \\frac{z_{0.95} \\gamma}{2} + \\sqrt{\\left(\\frac{z_{0.95} \\gamma}{2}\\right)^2 + \\frac{cG}{Yf}}$$\n两边平方得到关于$n$的条件：\n$$n \\ge \\left( \\frac{z_{0.95} \\gamma}{2} + \\sqrt{\\left(\\frac{z_{0.95} \\gamma}{2}\\right)^2 + \\frac{cG}{Yf}} \\right)^2$$\n由于$n$必须是整数，我们对此表达式向上取整，以找到满足条件的最小整数$n$。\n$$n = \\left\\lceil \\left( \\frac{z_{0.95} \\gamma}{2} + \\sqrt{\\left(\\frac{z_{0.95} \\gamma}{2}\\right)^2 + \\frac{cG}{Yf}} \\right)^2 \\right\\rceil$$\n现在，我们代入常数的数值：\n- $z_{0.95} \\approx 1.645$\n- $\\gamma = 0.25$\n- $c = 30$\n- $G = 3.1$\n- $f = 0.79135$\n我们来计算常数项：\n$$cG = 30 \\times 3.1 = 93$$\n$$\\frac{z_{0.95} \\gamma}{2} = \\frac{1.645 \\times 0.25}{2} = 0.205625$$\n$$\\left(\\frac{z_{0.95} \\gamma}{2}\\right)^2 = (0.205625)^2 = 0.042281640625$$\n$$\\frac{cG}{f} = \\frac{93}{0.79135}$$\n将这些值代入$n$的表达式中：\n$$n = \\left\\lceil \\left( 0.205625 + \\sqrt{0.042281640625 + \\frac{93}{0.79135 Y}} \\right)^2 \\right\\rceil$$\n这就是所要求的仅关于$Y$的最小整数$n$的闭式表达式。",
            "answer": "$$\\boxed{\\left\\lceil \\left( 0.205625 + \\sqrt{0.042281640625 + \\frac{93}{0.79135Y}} \\right)^2 \\right\\rceil}$$"
        },
        {
            "introduction": "基因组组装中最重大的挑战之一是正确解析如节段性重复（segmental duplications, SDs）之类的重复区域。本练习探讨了如何利用读段作图深度作为一种强大的诊断工具，来识别重复序列的塌缩——这是一种常见的组装错误。通过理解拷贝数与预期覆盖度之间的关系，您可以在这些复杂的基因组位点评估组装的结构完整性。",
            "id": "4356402",
            "problem": "一名研究人员利用长读长数据从头组装（de novo assemble）人类基因组，并评估组装结果中节段性重复（segmental duplication, SD）家族的塌缩与解析情况。测序读段（reads）从基因组中均匀且独立地抽样，唯一序列中的单碱基覆盖度遵循平均深度为$C$（覆盖倍数）的泊松过程（Poisson process）。使用一个比对软件将读段比对回组装序列，该软件为每个读段报告一个最佳比对结果，并在有多个同等好的比对结果时，均匀随机地选择一个。此组装是一个初级的单倍体表示：如果一个旁系同源家族被完全解析，则每个旁系同源拷贝都由其自己的contig表示；如果它是塌缩的，则由一个contig表示几个旁系同源拷贝的一致性序列。为解决此问题，假设在经过标准的鸟嘌呤-胞嘧啶（GC）校正后，不存在比对或碱基组成偏好，并且在一个家族内，所有旁系同源拷贝的长度$L$都相同。\n\n你观察到唯一区域的平均单碱基覆盖度为$C = 30$。考虑三个SD家族：\n- 家族 $\\mathrm{F1}$：真实基因组包含$k_1 = 3$个近乎相同的拷贝（每个长度为$L = 40\\,\\mathrm{kb}$），组装结果将它们表示为一个长度为$L$的塌缩contig。\n- 家族 $\\mathrm{F2}$：真实基因组包含$k_2 = 4$个拷贝（每个长度为$L$）；组装结果将$m_2 = 2$个拷贝解析成两个不同的contig（每个长度为$L$），并将其余的$k_2 - m_2 = 2$个拷贝塌缩成一个额外的长度为$L$的contig。\n- 家族 $\\mathrm{F3}$：真实基因组包含$k_3 = 2$个拷贝（每个长度为$L$），组装结果将两者完全解析成两个不同的contig（每个长度为$L$）。\n\n根据这些关于塌缩区域与解析区域中预期覆盖度乘数的假设，以及一种基于覆盖度检测拷贝数的方法，选择下面所有正确的陈述。\n\nA. 在 $\\mathrm{F1}$ 中，单个塌缩contig上的预期单碱基覆盖度约为 $3C$，因此当 $C = 30$ 时，观测到的深度集中在 $90$ 左右。\n\nB. 在 $\\mathrm{F2}$ 中，两个解析出的旁系同源contig各自的预期单碱基覆盖度为 $C$（约 $30$），而塌缩的contig的预期单碱基覆盖度为 $2C$（约 $60$）。\n\nC. 在 $\\mathrm{F3}$ 中，因为来自两个旁系同源拷贝的读段随机分配到两个解析出的contig上，所以每个contig的预期单碱基覆盖度是 $C/2$（约 $15$）。\n\nD. 一个基于覆盖度的拷贝数估计量，其设定为$\\hat{k} = \\mathrm{round}(\\bar{c}/C)$，其中$\\bar{c}$是在基于唯一区域进行GC校正后，家族内足够长的窗口中的平均单碱基覆盖度。在均匀抽样和所述的比对策略下，该估计量是泊松模型下的最大似然估计（MLE），并且对于真实拷贝数$k$是无偏的；塌缩区域将因此产生$\\hat{k} > 1$。\n\nE. 为避免假阳性，塌缩区域的预期覆盖度在与全基因组基线比较之前，必须除以其contig长度，因为单碱基覆盖度与contig长度成正比，即使拷贝数不变，较长的塌缩contig也会夸大表观深度。",
            "solution": "用户需要对所提供的问题陈述进行严谨的验证，然后对所有选项进行详细的解答和评估。\n\n### 步骤1：提取已知条件\n\n-   **测序模型：** 读段从基因组中均匀且独立地抽样。\n-   **覆盖度模型：** 在唯一的、单拷贝区域中，单碱基覆盖度遵循平均深度为$C$的泊松过程。\n-   **比对策略：** 一个比对软件将每个读段映射到其唯一的最佳比对位置。在同等好的比对结果中，均匀随机地选择一个。\n-   **组装结构：** 组装结果是一个初级的单倍体表示。\n    -   一个解析的节段性重复（SD）家族的每个旁系同源拷贝都由一个单独的contig表示。\n    -   一个塌缩的SD家族由一个contig表示多个旁系同源拷贝的一致性序列。\n-   **假设：** 在GC校正后，没有比对或碱基组成偏好。在一个SD家族内，所有旁系同源拷贝的长度均为$L$。\n-   **观测数据：** 唯一区域的平均覆盖度为$C = 30$。\n-   **家族 $\\mathrm{F1}$：**\n    -   真实基因组拷贝数：$k_1 = 3$。\n    -   拷贝长度：$L = 40\\,\\mathrm{kb}$。\n    -   组装表示：1个长度为$L$的塌缩contig。\n-   **家族 $\\mathrm{F2}$：**\n    -   真实基因组拷贝数：$k_2 = 4$。\n    -   组装表示：$m_2 = 2$个解析的contig（每个长度为$L$），以及1个塌缩的contig（长度为$L$），代表其余的$k_2 - m_2 = 2$个拷贝。\n-   **家族 $\\mathrm{F3}$：**\n    -   真实基因组拷贝数：$k_3 = 2$。\n    -   组装表示：2个完全解析的、不同的contig（每个长度为$L$）。\n\n### 步骤2：使用提取的已知条件进行验证\n\n-   **科学基础扎实：** 该问题牢固地植根于计算生物学和基因组学。使用泊松模型进行读段覆盖度分析、de novo组装、节段性重复、塌缩/解析区域以及基于覆盖度的拷贝数估计等概念，都是该领域的标准和基础内容。该模型是一种简化，但代表了一个有效且被广泛使用的一阶近似。\n-   **定义明确：** 该问题定义清晰。给定的条件和假设为计算每种情况下的预期覆盖度提供了清晰的框架。选项中提出的问题都可以在此框架内得到解答。\n-   **客观性：** 问题陈述是定量的、客观的，使用了精确的定义，避免了模糊或主观的说法。\n-   **缺陷清单：**\n    1.  **科学/事实不健全：** 无。该模型就其目的而言是科学合理的。\n    2.  **无法形式化/不相关：** 该问题是可形式化的，并且与指定主题直接相关。\n    3.  **不完整/矛盾的设置：** 设置是自洽和完整的。对于每个家族，真实基因组状态与组装表示之间的关系都得到了清晰的描述。\n    4.  **不切实际/不可行：** 参数（$C=30$, $k=2-4$）对于现代基因组学项目是现实的。比对模型是一种标准的简化。\n    5.  **不适定/结构不良：** 问题结构良好，根据给定模型可以得出唯一的预期覆盖度值。\n    6.  **伪深刻/琐碎：** 该问题需要正确应用测序覆盖度的基本原理，并非琐碎。\n    7.  **超出科学可验证性范围：** 陈述可以通过基于所提供模型的数学推导进行验证。\n\n### 步骤3：结论与行动\n\n问题陈述是**有效的**。我将继续推导解决方案并评估选项。\n\n### 基于原理的推导\n\n基本原理是，从任何区域生成的序列数据量与其在基因组中的总长度成正比。平均覆盖度$C$是为单拷贝（唯一）区域定义的。因此，从一个长度为$L$且存在$k$个拷贝的基因组元件中测序得到的总碱基数，预期与$k \\times L$成正比。覆盖度定义为（测序的总碱基数）/（序列长度），所以对于一个长度为$L$的单拷贝区域，预期覆盖度为$C \\times L / L = C$。\n\n让我们将此应用于一个组装好的contig。一个组装contig上的预期单碱基覆盖度$\\bar{c}$是比对到该contig上的所有读段的总碱基数除以该contig的长度。\n\n$$\n\\bar{c} = \\frac{E[\\text{比对到contig的读段总碱基数}]}{\\text{contig的长度}}\n$$\n\n让我们根据问题的比对策略分析每个家族的预期覆盖度。\n\n**家族F1的分析：**\n-   基因组包含$k_1 = 3$个长度为$L$的近乎相同的拷贝。\n-   从这3个拷贝中测序得到的预期总碱基数：$3 \\times L \\times C$。\n-   组装结果有一个长度为$L$的塌缩contig。因为真实拷贝是“近乎相同的”，所有3个拷贝的读段都将比对到这一个contig上。\n-   塌缩contig上的预期覆盖度：\n    $$\n    \\bar{c}_1 = \\frac{3LC}{L} = 3C\n    $$\n-   当$C = 30$时，预期覆盖度为$\\bar{c}_1 = 3 \\times 30 = 90$。\n\n**家族F2的分析：**\n-   基因组包含$k_2 = 4$个拷贝。\n-   组装结果有2个解析的contig和1个塌缩的contig。\n-   **解析的Contig：** 2个解析的contig中，每一个都代表一个单一、不同的基因组拷贝。“解析”意味着有足够的分化，使得比对软件能将来自特定基因组拷贝的读段唯一地映射到其对应的组装contig上。\n    -   对于每个解析的contig，它接收来自1个基因组拷贝的读段。\n    -   预期覆盖度：$\\bar{c}_{2, \\text{resolved}} = \\frac{1 \\times L \\times C}{L} = C$。当$C=30$时，此值为30。\n-   **塌缩的Contig：** 这个contig代表了剩余的$k_2 - m_2 = 2$个基因组拷贝。来自这2个拷贝的读段将比对到这一个contig上。\n    -   预期覆盖度：$\\bar{c}_{2, \\text{collapsed}} = \\frac{2 \\times L \\times C}{L} = 2C$。当$C=30$时，此值为60。\n\n**家族F3的分析：**\n-   基因组包含$k_3 = 2$个拷贝。\n-   组装结果有2个完全解析的contig。与F2中的解析contig一样，“解析”意味着读段从特定的基因组拷贝唯一地映射到其对应的组装contig。\n-   2个contig中的每一个都精确地接收来自1个基因组拷贝的读段。\n-   每个contig上的预期覆盖度：\n    $$\n    \\bar{c}_3 = \\frac{1 \\times L \\times C}{L} = C\n    $$\n-   当$C = 30$时，预期覆盖度为$30$。\n\n### 逐项分析选项\n\n**A. 在 $\\mathrm{F1}$ 中，单个塌缩contig上的预期单碱基覆盖度约为 $3C$，因此当 $C = 30$ 时，观测到的深度集中在 $90$ 左右。**\n-   我们对F1的推导表明，预期覆盖度为$\\bar{c}_1 = 3C$。\n-   代入$C = 30$，我们得到预期覆盖度为$90$。\n-   平均值为$90$的泊松分布的标准差为$\\sqrt{90} \\approx 9.49$。由于标准差相对于平均值较小，观测到的覆盖度确实会紧密地聚集或“集中”在$90$左右。\n-   该陈述是**正确的**。\n\n**B. 在 $\\mathrm{F2}$ 中，两个解析出的旁系同源contig各自的预期单碱基覆盖度为 $C$ (约 $30$)，而塌缩的contig的预期单碱基覆盖度为 $2C$ (约 $60$)。**\n-   我们对F2的推导表明，2个解析的contig各自的预期覆盖度为$C$（即$30$），而单个塌缩的contig（代表2个真实拷贝）的预期覆盖度为$2C$（即$60$）。\n-   该陈述与我们的分析完全匹配。\n-   该陈述是**正确的**。\n\n**C. 在 $\\mathrm{F3}$ 中，因为来自两个旁系同源拷贝的读段随机分配到两个解析出的contig上，所以每个contig的预期单碱基覆盖度是 $C/2$ (约 $15$)。**\n-   该陈述包含一个前提（“随机分配”）和一个结论（覆盖度为$C/2$）。让我们基于前提来分析结论。\n-   如果来自$k_3 = 2$个真实拷贝的读段随机分配到两个组装的contig上，那么总测序数据量（$2LC$）将被分配给它们。平均而言，每个contig将接收到总数据的一半：$\\frac{2LC}{2} = LC$。\n-   一个长度为$L$的contig上的预期覆盖度将是$\\frac{LC}{L} = C$。\n-   即使接受其前提，该陈述关于覆盖度为$C/2$的结论在算术上也是不正确的。此外，随机分配的前提与拷贝被“解析”的概念相矛盾，后者意味着它们可以被比对软件区分，从而导致唯一的而非随机的比对。在唯一比对的情况下，覆盖度也应为$C$。\n-   该陈述是**错误的**。\n\n**D. 一个基于覆盖度的拷贝数估计量，其设定为 $\\hat{k} = \\mathrm{round}(\\bar{c}/C)$，其中 $\\bar{c}$ 是在基于唯一区域进行GC校正后，家族内足够长的窗口中的平均单碱基覆盖度。在均匀抽样和所述的比对策略下，该估计量是泊松模型下的最大似然估计（MLE），并且对于真实拷贝数 $k$ 是无偏的；塌缩区域将因此产生 $\\hat{k} > 1$。**\n-   让我们为一个代表$k$个真实拷贝的塌缩区域检查该陈述的各个组成部分。\n    1.  **MLE：** 观测到的平均覆盖度为$\\bar{c}$。在泊松模型下，平均参数的MLE是$\\bar{c}$。模型均值为$\\lambda = kC$。我们想找到最大化观测到$\\bar{c}$的可能性的整数$k$。这可以通过选择使$kC$最接近$\\bar{c}$的整数$k$来实现，这等同于找到最接近$\\bar{c}/C$的整数$k$。这正是$\\hat{k} = \\mathrm{round}(\\bar{c}/C)$所计算的。因此，这是整数拷贝数$k$的MLE。\n    2.  **无偏性：** 对于连续拷贝数的估计量$\\bar{c}/C$是无偏的，因为$E[\\bar{c}/C] = E[\\bar{c}]/C = (kC)/C = k$。对于足够长的窗口，中心极限定理意味着$\\bar{c}$的分布近似为正态分布，因此是对称的。对一个对称分布的变量进行四舍五入得到的估计量也是（渐近）无偏的。\n    3.  **塌缩区域的结果：** 根据定义，一个塌缩区域代表$k > 1$个拷贝。其预期覆盖度为$\\bar{c} = kC$，因此估计的拷贝数为$\\hat{k} = \\mathrm{round}(kC/C) = k > 1$。\n-   该陈述准确地描述了在这种情况下基于覆盖度的拷贝数估计的统计基础和实际应用。\n-   该陈述是**正确的**。\n\n**E. 为避免假阳性，塌缩区域的预期覆盖度在与全基因组基线比较之前，必须除以其contig长度，因为单碱基覆盖度与contig长度成正比，即使拷贝数不变，较长的塌缩contig也会夸大表观深度。**\n-   该陈述从根本上误解了单碱基覆盖度的概念。单碱基覆盖度$\\bar{c}$是一个*强度量*，意味着它是一个平均值，不随区域的大小（长度）而变化。它的计算公式是$\\bar{c} = (\\sum_{\\text{碱基}} \\text{深度}) / \\text{长度}$。与contig长度成比例的量是比对上的读段总数，而不是单碱基覆盖度。\n-   将单碱基覆盖度$\\bar{c}$除以contig长度$L$在此上下文中是一个无意义的操作。人们应该将单碱基覆盖度$\\bar{c}$直接与基线单碱基覆盖度$C$进行比较。\n-   “单碱基覆盖度与contig长度成正比”的前提是错误的。\n-   该陈述是**错误的**。\n\n### 最终结论\n\n正确的陈述是 A、B 和 D。",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "从头组装的最终考验是其在下游生物学或临床分析中的实用性。这最后一个练习模拟了对一个组装的验证过程，通过与金标准基准比较，评估其在检测结构变异（SVs）方面的性能。您将计算灵敏度、精确度和特异性等关键指标，并学习特定的组装错误如何系统性地影响这些性能度量，这对于在诊断环境中解释结果至关重要。",
            "id": "4356396",
            "problem": "一个临床全基因组使用长读长测序进行了从头组装，并与人类参考基因组GRCh38进行比对，其结构变异根据Genome in a Bottle (GIAB)结构变异基准集进行了评估。评估仅限于GIAB高置信度区间以及一个包含$K = 20{,}000$个不同位点的经过整理的候选位点目录，其中每个位点在基准中被标记为结构变异阳性或结构变异阴性。在这些位点中，有$P = 2{,}400$个被标记为阳性，有$N = 17{,}600$个被标记为阴性。组装到参考的比对产生了一个结构变异的检出集，该检出集通过在每个事件的两个断点处使用$\\pm 50$个碱基对的断点容差与GIAB目录进行匹配。高置信度区间之外的检出被排除在评估之外。\n\n在高置信度目录内，对同一位点的重叠检出进行去重后，观察到以下结果：\n- $2{,}268$个阳性位点在断点容差窗口内有匹配的检出事件，被计为真阳性。\n- $132$个阳性位点在容差范围内没有匹配的检出，被计为假阴性。\n- $144$个阴性位点在容差范围内被错误地检出为结构变异，被计为假阳性。\n- 所有剩余的阴性位点被计为真阴性。\n\n独立的组装质量评估表明，嵌合重叠群连接影响了重复区域，导致了$90$个假阳性；而局部组装错误使断点偏移超出了匹配容差，导致了$80$个假阴性。\n\n请使用应用于此基于位点的评估的混淆矩阵标准定义（敏感性、特异性和精确率），计算这三个指标。然后，计算敏感性和精确率的调和平均数（$F_{1}$分数）。简要解释在组装到参考的比对和断点匹配方面，重叠群组装错误如何给这种基于位点的评估中获得的三个指标带来偏差。\n\n最终答案以$F_{1}$分数表示，四舍五入到四位有效数字，并以无量纲小数形式报告。最终答案中不需要其他四舍五入的值。",
            "solution": "首先验证问题陈述的科学合理性、完整性和客观性。\n\n### 步骤1：提取已知条件\n- 总候选位点数，$K = 20{,}000$。\n- 总阳性位点数（真实结构变异），$P = 2{,}400$。\n- 总阴性位点数（真实阴性），$N = 17{,}600$。\n- 断点匹配容差：在两个断点处各为$\\pm 50$个碱基对。\n- 真阳性 (TP)：具有匹配检出的阳性位点数 = $2{,}268$。\n- 假阴性 (FN)：没有匹配检出的阳性位点数 = $132$。\n- 假阳性 (FP)：被错误检出为结构变异的阴性位点数 = $144$。\n- 真阴性 (TN)：所有剩余的阴性位点。\n- 嵌合重叠群连接对假阳性的贡献：$90$例。\n- 局部组装错误对假阴性的贡献：$80$例。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在计算基因组学和生物信息学这一成熟领域具有科学依据，使用了标准术语（长读长测序、从头组装、结构变异、GIAB基准、混淆矩阵）。所提供的数据是自洽且完整的。真阳性和假阴性之和，$\\text{TP} + \\text{FN} = 2{,}268 + 132 = 2{,}400$，正确地等于总阳性位点数$P$。总阴性位点数给出为$N = 17{,}600$。真阴性数可以推导为$\\text{TN} = N - \\text{FP} = 17{,}600 - 144 = 17{,}456$，这是明确定义的。总位点数$K = P + N = 2{,}400 + 17{,}600 = 20{,}000$也是一致的。该问题定义良好、客观，并且不含科学或事实上的不合理之处。所描述的情景对于临床基因组学验证研究是现实的。\n\n### 步骤3：结论与行动\n该问题被认为是有效的。将提供解答。\n\n### 解题过程\n\n该问题要求根据所提供数据定义的混淆矩阵，计算三个标准性能指标（敏感性、特异性、精确率）和一个派生指标（$F_1$分数）。它还要求解释特定的组装错误如何给这些指标带来偏差。\n\n首先，我们根据已知条件形式化混淆矩阵的组成部分：\n- 真阳性 ($\\text{TP}$): 正确识别的阳性位点数。\n  $$ \\text{TP} = 2{,}268 $$\n- 假阴性 ($\\text{FN}$): 被组装/检出软件漏掉的阳性位点数。\n  $$ \\text{FN} = 132 $$\n- 假阳性 ($\\text{FP}$): 被错误识别为阳性的阴性位点数。\n  $$ \\text{FP} = 144 $$\n- 真阴性 ($\\text{TN}$): 正确识别的阴性位点数。这是由总阴性数$N$和假阳性数$\\text{FP}$计算得出的。\n  $$ \\text{TN} = N - \\text{FP} = 17{,}600 - 144 = 17{,}456 $$\n\n有了这些值，我们就可以计算所需的指标。\n\n**1. 敏感性（召回率或真阳性率）**\n敏感性衡量被正确识别的实际阳性位点的比例。\n$$ \\text{Sensitivity} = \\frac{\\text{TP}}{\\text{TP} + \\text{FN}} = \\frac{2{,}268}{2{,}268 + 132} = \\frac{2{,}268}{2{,}400} = 0.945 $$\n\n**2. 特异性（真阴性率）**\n特异性衡量被正确识别的实际阴性位点的比例。\n$$ \\text{Specificity} = \\frac{\\text{TN}}{\\text{TN} + \\text{FP}} = \\frac{17{,}456}{17{,}456 + 144} = \\frac{17{,}456}{17{,}600} \\approx 0.9918 $$\n\n**3. 精确率（阳性预测值）**\n精确率衡量阳性识别中实际正确的比例。\n$$ \\text{Precision} = \\frac{\\text{TP}}{\\text{TP} + \\text{FP}} = \\frac{2{,}268}{2{,}268 + 144} = \\frac{2{,}268}{2{,}412} \\approx 0.93997 $$\n\n**4. $F_1$ 分数**\n$F_1$分数是精确率和敏感性的调和平均数，提供了一个平衡两者的单一指标。\n通用公式为：\n$$ F_1 = 2 \\times \\frac{\\text{Precision} \\times \\text{Sensitivity}}{\\text{Precision} + \\text{Sensitivity}} $$\n使用混淆矩阵组件的更直接公式是：\n$$ F_1 = \\frac{2 \\times \\text{TP}}{2 \\times \\text{TP} + \\text{FP} + \\text{FN}} $$\n使用给定值代入此公式：\n$$ F_1 = \\frac{2 \\times 2{,}268}{2 \\times 2{,}268 + 144 + 132} = \\frac{4{,}536}{4{,}536 + 276} = \\frac{4{,}536}{4{,}812} $$\n计算小数值：\n$$ F_1 \\approx 0.9426433915... $$\n按问题要求四舍五入到四位有效数字，得到$0.9426$。\n\n**5. 关于重叠群组装错误如何引入偏差的解释**\n\n问题要求解释重叠群组装错误如何对三个主要指标（敏感性、特异性、精确率）产生偏差。提供的信息将$90$个假阳性归因于嵌合重叠群，将$80$个假阴性归因于局部组装错误。\n\n- **来自嵌合重叠群连接的偏差（假阳性）：**\n嵌合重叠群是组装过程中的人造产物，其中基因组中不连续的片段被错误地连接在一起。当这样的重叠群与参考基因组进行比对时，这种人为的连接可能被比对算法误解为实际基因组中不存在的结构变异（例如，大规模的易位、倒位或缺失）。这会导致在实际上是阴性的位点上出现假阳性检出。假阳性（$\\text{FP}$）数量的增加直接影响两个指标：\n1.  **特异性：** $\\text{Specificity} = \\frac{\\text{TN}}{\\text{TN} + \\text{FP}}$。增加的$\\text{FP}$计数会减少分子（因为$\\text{TN} = N - \\text{FP}$）并增加分母，从而对**特异性产生负向偏差（降低）**。这意味着组装结果在正确识别真阴性位点方面的能力较差。\n2.  **精确率：** $\\text{Precision} = \\frac{\\text{TP}}{\\text{TP} + \\text{FP}}$。增加的$\\text{FP}$计数会增加分母，从而对**精确率产生负向偏差（降低）**。这意味着“阳性”检出中有更高比例是错误的。\n敏感性不受此类错误的直接影响。\n\n- **来自局部组装错误的偏差（假阴性）：**\n局部组装错误涉及组装好的重叠群序列中的小规模错误，通常发生在复杂或重复的区域。当一个真实的结构变异存在时，其精确的断点在参考基因组中是确定的。覆盖此变异的重叠群中的局部组装错误可能会改变一个或两个断点周围的序列。这可能导致比对报告的变异断点位置落在指定的匹配容差窗口（此处为$\\pm 50$ bp）之外。因此，从组装中检出的变异无法与基准目录中的真实变异相匹配，导致未能检测到真实的变异。这被计为假阴性（$\\text{FN}$）。假阴性（$\\text{FN}$）数量的增加直接影响一个指标：\n1.  **敏感性：** $\\text{Sensitivity} = \\frac{\\text{TP}}{\\text{TP} + \\text{FN}}$。增加的$\\text{FN}$计数会增加分母，从而对**敏感性产生负向偏差（降低）**。这意味着基于组装的检出方法在检测存在的真实变异方面的能力较差。\n特异性和精确率不受此类错误的直接影响。\n\n总而言之，重叠群组装错误引入了系统性偏差，降低了性能评估。嵌合体人为地增加了结构变异的计数，降低了特异性和精确率，而局部组装错误则掩盖了真实变异的信号，降低了敏感性。",
            "answer": "$$\n\\boxed{0.9426}\n$$"
        }
    ]
}