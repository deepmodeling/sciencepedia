{
    "hands_on_practices": [
        {
            "introduction": "长读长测序技术首先捕获每个RNA分子通过纳米孔时产生的原始电信号，然后通过碱基识别（basecalling）过程将其转换为我们熟悉的碱基序列。本练习将通过计算原始信号和碱基识别后FASTQ文件之间的存储大小比例，帮助您直观地理解原始数据的庞大规模，并认识到碱基识别作为关键数据压缩步骤的重要性。这种从物理测量到生物信息学数据的转换是所有纳米孔测序分析的基础。",
            "id": "4355994",
            "problem": "一个精准医疗工作流程使用长读长天然核糖核酸（RNA）测序信号来检测异构体和RNA修饰。仪器为每个读长输出一个数字化的离子电流轨迹，随后生成带有每个碱基质量得分的碱基识别序列。假设以下科学上成立的条件：\n\n- 共有 $N$ 个读长，每个读长的平均持续时间为 $T$ 秒。\n- 原始信号以 $f_{s}$ 赫兹的频率均匀采样，每个样本量化为 $16$ 比特。\n- 对于天然RNA，在每个读长的持续时间 $T$ 内，碱基识别平均每秒产生 $v$ 个碱基。\n- 碱基识别后的序列以带有质量得分的FASTA（FASTQ）格式存储，每个读长使用四行：一个标题行，一个序列行，一个加号行和一个质量行。字符使用美国信息交换标准代码（ASCII）编码，因此每个字符（包括换行符）占用 $1$ 字节。\n- 对于每个读长，标题行包含 $h$ 个字符后跟一个换行符，序列行包含 $L$ 个字符（等于碱基数）后跟一个换行符，加号行包含 $p$ 个字符后跟一个换行符，质量行包含 $L$ 个字符后跟一个换行符。\n\n根据以下参数：$N = 3{,}000$，$T = 60$ 秒，$f_{s} = 4{,}000$ 赫兹，$16$ 比特样本，$v = 75$ 碱基/秒，$h = 100$ 字符，以及 $p = 1$ 字符，仅使用这些基本原理，计算所有读长的原始信号总存储量与FASTQ总存储量的比率。将最终结果表示为一个无量纲比率，并四舍五入到 $4$ 位有效数字。",
            "solution": "目标是根据数字采样和文本编码的第一性原理，推导出原始信号总存储量与FASTQ总存储量的比率。\n\n首先量化原始信号存储量。每个读长的信号以 $f_{s}$ 赫兹的频率采样 $T$ 秒，产生 $T f_{s}$ 个样本。每个样本量化为 $16$ 比特，即 $\\frac{16}{8} = 2$ 字节。因此，每个读长的原始字节数为\n$$\n\\text{每个读长的原始字节数} = T f_{s} \\times 2.\n$$\n对于 $N$ 个读长，原始总存储量为\n$$\nR_{\\text{raw}} = N \\times T f_{s} \\times 2.\n$$\n\n接下来，根据FASTQ结构的定义量化每个读长的FASTQ存储量。一个读长的序列长度（以碱基为单位）为\n$$\nL = v T,\n$$\n因为在 $T$ 秒内每秒产生 $v$ 个碱基。在FASTQ格式中，每个字符（包括换行符）在美国信息交换标准代码（ASCII）中为一个字节。每个读长的四行贡献如下：\n- 标题行：$h$ 个字符 + $1$ 个换行符 $\\Rightarrow h + 1$ 字节。\n- 序列行：$L$ 个字符 + $1$ 个换行符 $\\Rightarrow L + 1$ 字节。\n- 加号行：$p$ 个字符 + $1$ 个换行符 $\\Rightarrow p + 1$ 字节。\n- 质量行：$L$ 个字符 + $1$ 个换行符 $\\Rightarrow L + 1$ 字节。\n\n因此，每个读长的FASTQ字节数为\n$$\n\\text{每个读长的FASTQ字节数} = (h + 1) + (L + 1) + (p + 1) + (L + 1) = h + p + 4 + 2L.\n$$\n对于 $N$ 个读长，FASTQ总存储量为\n$$\nR_{\\text{fastq}} = N \\times \\left(h + p + 4 + 2L\\right) = N \\times \\left(h + p + 4 + 2 v T\\right).\n$$\n\n所求的原始信号总存储量与FASTQ总存储量的比率为\n$$\n\\frac{R_{\\text{raw}}}{R_{\\text{fastq}}}\n= \\frac{N \\times T f_{s} \\times 2}{N \\times \\left(h + p + 4 + 2 v T\\right)}\n= \\frac{2 T f_{s}}{h + p + 4 + 2 v T}.\n$$\n\n现在代入给定的数值：\n- $T = 60$,\n- $f_{s} = 4{,}000$,\n- $v = 75$,\n- $h = 100$,\n- $p = 1$.\n\n计算分子：\n$$\n2 T f_{s} = 2 \\times 60 \\times 4{,}000 = 480{,}000.\n$$\n\n计算分母：\n$$\nh + p + 4 + 2 v T = 100 + 1 + 4 + 2 \\times 75 \\times 60 = 105 + 9{,}000 = 9{,}105.\n$$\n\n因此，该比率为\n$$\n\\frac{R_{\\text{raw}}}{R_{\\text{fastq}}} = \\frac{480{,}000}{9{,}105} \\approx 52.71828\\ldots\n$$\n\n四舍五入到 $4$ 位有效数字，该无量纲比率为\n$$\n52.72.\n$$",
            "answer": "$$\\boxed{52.72}$$"
        },
        {
            "introduction": "在获得碱基序列后，评估其可靠性至关重要。本练习探讨了Phred质量分数（$Q$-score），这是基因组学中衡量碱基识别准确性的通用标准。通过将$Q$-score与每个碱基的错误概率联系起来，并计算不同质量分数下预期的错误碱基数量，您将深入理解$Q$-score的实际意义，并体会到碱基识别算法的改进如何直接提升数据质量。",
            "id": "4356052",
            "problem": "在一个使用 Oxford Nanopore Technologies (ONT) 的长读长天然核糖核酸（RNA）测序技术的精准肿瘤学检测中，一个实验室正在评估是否要升级其碱基识别模型。对于一个长度为 $L=10000$ 个核苷酸的代表性全长信使RNA（mRNA）靶标，当前的流程产生的平均单碱基质量分数（Q-score）为 $Q_{A}=10$。一个提议的模型升级预计会将平均单碱基Q-score提高到 $Q_{B}=15$。假设单个读长（read）内不同位置的碱基错误是相互独立的，并且单碱基错误概率在整个读长上是均匀的。\n\n从连接质量分数与单碱基错误概率的标准定义以及序列上独立错误的基本概率模型出发，计算从流程A转换到流程B时，每个读长中错配碱基数量的期望绝对减少量。将您的最终答案表示为每个读长的预期错配数，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求计算在升级测序流程时，每个读长中错配碱基数量的期望绝对减少量。为了解决这个问题，我们必须首先将给定的质量分数（$Q$-scores）与单碱基错误概率联系起来。\n\nPhred质量分数 $Q$ 是根据错误碱基检出（base call）的概率 $P_e$ 通过以下对数关系定义的：\n$$\nQ = -10 \\log_{10}(P_e)\n$$\n这个方程可以重新整理，以求解作为Q-score $Q$ 的函数的单碱基错误概率 $P_e$：\n$$\n-\\frac{Q}{10} = \\log_{10}(P_e)\n$$\n$$\nP_e = 10^{-Q/10}\n$$\n我们已知两个不同的流程，A（当前）和B（提议），其平均单碱基Q-score分别为 $Q_A = 10$ 和 $Q_B = 15$。我们可以为每个流程计算单碱基错误概率。\n\n对于流程A：\n$$\nP_{e,A} = 10^{-Q_A/10} = 10^{-10/10} = 10^{-1} = 0.1\n$$\n这意味着对于当前流程，在任何给定碱基处发生错误的概率是 $1/10$。\n\n对于流程B：\n$$\nP_{e,B} = 10^{-Q_B/10} = 10^{-15/10} = 10^{-1.5}\n$$\n这是提议的升级流程的单碱基错误概率。\n\n问题陈述了mRNA靶标的长度为 $L = 10000$ 个核苷酸，并且单碱基错误是独立且均匀分布的。一个读长中的错误数量可以被建模为一系列伯努利试验的总和，每个核苷酸位置对应一次试验。在长度为 $L$ 的读长中，错配碱基（错误）的期望数量 $E$ 是长度与单碱基错误概率 $P_e$ 的乘积：\n$$\nE = L \\times P_e\n$$\n使用这个公式，我们可以计算两个流程的期望错误数。\n\n流程A的期望错误数：\n$$\nE_A = L \\times P_{e,A} = 10000 \\times 0.1 = 1000\n$$\n因此，平均而言，由流程A生成的长度为 $10000$ 个核苷酸的读长预计包含 $1000$ 个错误。\n\n流程B的期望错误数：\n$$\nE_B = L \\times P_{e,B} = 10000 \\times 10^{-1.5}\n$$\n我们可以简化这个表达式：\n$$\nE_B = 10^4 \\times 10^{-1.5} = 10^{4 - 1.5} = 10^{2.5} = 10^2 \\times 10^{0.5} = 100 \\sqrt{10}\n$$\n数值上，$\\sqrt{10} \\approx 3.16227766$。因此：\n$$\nE_B \\approx 100 \\times 3.16227766 = 316.227766\n$$\n\n问题要求的是每个读长中错配碱基数量的期望绝对减少量，即流程A和流程B的期望错误数之差。\n$$\n\\Delta E = E_A - E_B\n$$\n代入计算出的值：\n$$\n\\Delta E = 1000 - 100 \\sqrt{10}\n$$\n现在，我们计算数值：\n$$\n\\Delta E \\approx 1000 - 316.227766 = 683.772234\n$$\n问题要求最终答案四舍五入到四位有效数字。前四位有效数字是 $6$、$8$、$3$ 和 $7$。第五位数字是 $7$，所以我们将第四位数字向上取整。\n$$\n\\Delta E \\approx 683.8\n$$\n因此，将碱基识别模型从流程A升级到流程B，预计每个长度为 $10000$ 的读长中的错配碱基数量将减少约 $683.8$ 个。",
            "answer": "$$\n\\boxed{683.8}\n$$"
        },
        {
            "introduction": "长读长测序的核心优势之一是其解析复杂转录本异构体的卓越能力，这对于理解基因功能至关重要。本练习构建了一个概率模型，用以量化长读长在跨越多个外显子-外显子连接点时的优势。通过对比短读长和长读长在该任务上的表现，您可以从数学上理解为何长读长技术能够解决短读长测序在转录组学中面临的根本性挑战。",
            "id": "4356011",
            "problem": "在用于精准医疗和基因组诊断的长读长天然核糖核酸（RNA）测序中，解析转录本异构体通常需要单个读长能够跨越所有具区分性的外显子-外显子连接点。考虑一个简单的外显子连接模型，其中一个局部转录本区域内恰好有 $3$ 个区分性连接点用于分隔不同的异构体。假设相邻区分性连接点之间的距离是独立同分布的指数随机变量，其均值为 $\\mu = 300$ 碱基对（bp），这反映了连接点密度沿转录本大致是平稳的。在此模型下，覆盖所有 $3$ 个连接点所需的总跨度 $D$（即从三个连接点中最 $5'$ 端的连接点到最 $3'$ 端的连接点）是 $2$ 个独立指数变量之和，因此服从形状参数为 $2$、率参数为 $\\lambda = 1/\\mu$ 的伽马分布。\n\n假设一个固定长度为 $L$ 的读长相对于该区分区域具有一个平移不变的均匀偏移，因此在 $D=d \\leq L$ 的条件下，该读长跨越所有连接点的概率等于能够完全包含宽度为 $d$ 的区间的可能偏移量的比例，即 $(L-d)/L$；否则概率为 $0$。令 $p_{\\mathrm{span}}(L)$ 表示此概率在 $D$ 的分布上的期望值。定义每个读长的异构体模糊度为 $A(L) = 1 - p_{\\mathrm{span}}(L)$。\n\n在上述假设下，并忽略转录本边界效应，计算当平均读长从 $L_{1} = 150$ bp（短读长范围）增加到 $L_{2} = 2000$ bp（长读长范围）时，异构体模糊度的预期降低值。将该降低值报告为单个实数\n$$\\Delta A \\equiv A(L_{1}) - A(L_{2}) = p_{\\mathrm{span}}(L_{2}) - p_{\\mathrm{span}}(L_{1}).$$\n使用 $\\mu = 300$ bp，并将 $L_{1}$ 和 $L_{2}$ 视为精确的固定长度。将最终答案四舍五入到四位有效数字，并以无单位的小数形式表示。",
            "solution": "用户希望计算当读长从 $L_1 = 150$ bp 增加到 $L_2 = 2000$ bp 时，异构体模糊度的降低值 $\\Delta A$。\n\n首先，我们根据提供的信息将问题形式化。模糊度的降低值定义为：\n$$ \\Delta A = A(L_1) - A(L_2) $$\n其中 $A(L) = 1 - p_{\\mathrm{span}}(L)$ 是长度为 $L$ 的读长的异构体模糊度。代入此定义，我们得到：\n$$ \\Delta A = (1 - p_{\\mathrm{span}}(L_1)) - (1 - p_{\\mathrm{span}}(L_2)) = p_{\\mathrm{span}}(L_2) - p_{\\mathrm{span}}(L_1) $$\n我们的主要任务是推导 $p_{\\mathrm{span}}(L)$ 的表达式，即长度为 $L$ 的读长跨越所有 $3$ 个区分性连接点的概率。\n\n覆盖所有 $3$ 个连接点所需的总跨度 $D$ 是它们之间 $2$ 个距离的总和。这些距离是均值为 $\\mu = 300$ bp 的独立同分布指数随机变量。$k$ 个速率为 $\\lambda$ 的独立同分布指数随机变量之和服从形状参数为 $k$、率参数为 $\\lambda$ 的伽马分布。在这里，$k=2$，率参数 $\\lambda$ 是均值 $\\mu$ 的倒数：\n$$ \\lambda = \\frac{1}{\\mu} = \\frac{1}{300} \\, \\text{bp}^{-1} $$\n总跨度 $D$ 的概率密度函数（PDF）由 $d \\ge 0$ 的伽马分布 PDF 给出：\n$$ f_D(d) = \\frac{\\lambda^k d^{k-1} \\exp(-\\lambda d)}{\\Gamma(k)} $$\n当 $k=2$ 且 $\\Gamma(2) = 1! = 1$ 时，PDF 简化为：\n$$ f_D(d) = \\lambda^2 d \\exp(-\\lambda d) $$\n\n题目指出，对于给定的跨度 $D=d$，长度为 $L$ 的读长完全包含此跨度的概率在 $d \\le L$ 时为 $(L-d)/L$，在 $d > L$ 时为 $0$。总跨越概率 $p_{\\mathrm{span}}(L)$ 是此条件概率在 $D$ 分布上的期望值：\n$$ p_{\\mathrm{span}}(L) = \\mathbb{E}[P(\\text{span} | D)] = \\int_{0}^{\\infty} P(\\text{span} | D=d) f_D(d) \\, \\mathrm{d}d $$\n考虑到条件概率，积分的上限为 $L$：\n$$ p_{\\mathrm{span}}(L) = \\int_{0}^{L} \\frac{L-d}{L} f_D(d) \\, \\mathrm{d}d $$\n代入 PDF $f_D(d)$：\n$$ p_{\\mathrm{span}}(L) = \\int_{0}^{L} \\left(1 - \\frac{d}{L}\\right) (\\lambda^2 d \\exp(-\\lambda d)) \\, \\mathrm{d}d $$\n我们可以将其分为两部分：\n$$ p_{\\mathrm{span}}(L) = \\lambda^2 \\int_{0}^{L} d \\exp(-\\lambda d) \\, \\mathrm{d}d - \\frac{\\lambda^2}{L} \\int_{0}^{L} d^2 \\exp(-\\lambda d) \\, \\mathrm{d}d $$\n这些积分可以用分部积分法求解。一个更直接的方法是将它们与伽马分布的累积分布函数（CDF）和部分期望联系起来。让我们定义 $p_{\\mathrm{span}}(L) = \\int_0^L f_D(d) \\, \\mathrm{d}d - \\frac{1}{L}\\int_0^L d f_D(d) \\, \\mathrm{d}d$。第一项是 Gamma($k=2, \\lambda$) 分布的 CDF，$F_D(L) = P(D \\le L)$。对于整数 $k$，CDF 为 $F_D(L; k, \\lambda) = 1 - \\exp(-\\lambda L) \\sum_{j=0}^{k-1} \\frac{(\\lambda L)^j}{j!}$。对于 $k=2$：\n$$ F_D(L) = 1 - \\exp(-\\lambda L) \\left( \\frac{(\\lambda L)^0}{0!} + \\frac{(\\lambda L)^1}{1!} \\right) = 1 - \\exp(-\\lambda L)(1 + \\lambda L) $$\n第二项涉及积分 $\\int_0^L d^2 \\exp(-\\lambda d) \\, \\mathrm{d}d$。使用分部积分法 $\\int u \\, \\mathrm{d}v = uv - \\int v \\, \\mathrm{d}u$：令 $u = d^n$ 且 $\\mathrm{d}v = \\exp(-\\lambda d)\\mathrm{d}d$。通用不定积分为：\n$$ \\int d^n \\exp(-\\lambda d) \\, \\mathrm{d}d = -\\frac{\\exp(-\\lambda d)}{\\lambda^{n+1}} \\sum_{i=0}^{n} \\frac{n!}{(n-i)!} (\\lambda d)^{n-i} $$\n对于 $n=1$：$\\int d \\exp(-\\lambda d) \\, \\mathrm{d}d = -\\frac{\\exp(-\\lambda d)}{\\lambda^2}(\\lambda d + 1)$。\n对于 $n=2$：$\\int d^2 \\exp(-\\lambda d) \\, \\mathrm{d}d = -\\frac{\\exp(-\\lambda d)}{\\lambda^3}(\\lambda^2 d^2 + 2\\lambda d + 2)$。\n\n计算从 $0$ 到 $L$ 的定积分：\n$$ \\int_{0}^{L} d \\exp(-\\lambda d) \\, \\mathrm{d}d = \\left[ -\\frac{\\exp(-\\lambda d)}{\\lambda^2}(\\lambda d + 1) \\right]_{0}^{L} = \\frac{1}{\\lambda^2} - \\frac{\\exp(-\\lambda L)}{\\lambda^2}(\\lambda L + 1) $$\n$$ \\int_{0}^{L} d^2 \\exp(-\\lambda d) \\, \\mathrm{d}d = \\left[ -\\frac{\\exp(-\\lambda d)}{\\lambda^3}(\\lambda^2 d^2 + 2\\lambda d + 2) \\right]_{0}^{L} = \\frac{2}{\\lambda^3} - \\frac{\\exp(-\\lambda L)}{\\lambda^3}(\\lambda^2 L^2 + 2\\lambda L + 2) $$\n将这些结果代回 $p_{\\mathrm{span}}(L)$ 的表达式中：\n$$ p_{\\mathrm{span}}(L) = \\lambda^2 \\left( \\frac{1}{\\lambda^2} - \\frac{\\exp(-\\lambda L)}{\\lambda^2}(\\lambda L + 1) \\right) - \\frac{\\lambda^2}{L} \\left( \\frac{2}{\\lambda^3} - \\frac{\\exp(-\\lambda L)}{\\lambda^3}(\\lambda^2 L^2 + 2\\lambda L + 2) \\right) $$\n$$ p_{\\mathrm{span}}(L) = \\left( 1 - \\exp(-\\lambda L)(\\lambda L + 1) \\right) - \\frac{2}{\\lambda L} \\left( 1 - \\exp(-\\lambda L)\\left(\\frac{\\lambda^2 L^2}{2} + \\lambda L + 1\\right) \\right) $$\n这可以简化为一个更简洁的形式。让我们重新组合展开积分后的各项：\n$$ p_{\\mathrm{span}}(L) = 1 - (\\lambda L+1)\\exp(-\\lambda L) - \\frac{2}{\\lambda L} + \\frac{\\exp(-\\lambda L)}{\\lambda L}(\\lambda^2 L^2 + 2\\lambda L + 2) $$\n$$ p_{\\mathrm{span}}(L) = 1 - (\\lambda L+1)\\exp(-\\lambda L) - \\frac{2}{\\lambda L} + \\exp(-\\lambda L)(\\lambda L + 2 + \\frac{2}{\\lambda L}) $$\n$$ p_{\\mathrm{span}}(L) = 1 - \\frac{2}{\\lambda L} - \\lambda L \\exp(-\\lambda L) - \\exp(-\\lambda L) + \\lambda L \\exp(-\\lambda L) + 2 \\exp(-\\lambda L) + \\frac{2}{\\lambda L} \\exp(-\\lambda L) $$\n$$ p_{\\mathrm{span}}(L) = 1 - \\frac{2}{\\lambda L} + \\exp(-\\lambda L) + \\frac{2}{\\lambda L} \\exp(-\\lambda L) $$\n$$ p_{\\mathrm{span}}(L) = 1 - \\frac{2}{\\lambda L}(1 - \\exp(-\\lambda L)) + \\exp(-\\lambda L) $$\n\n现在我们可以计算 $L_1=150$ bp 和 $L_2=2000$ bp 时的 $p_{\\mathrm{span}}(L)$。\n参数 $\\lambda = 1/300$ bp$^{-1}$。\n\n对于 $L_1 = 150$ bp：\n无量纲乘积为 $\\lambda L_1 = \\frac{1}{300} \\times 150 = 0.5$。\n$$ p_{\\mathrm{span}}(L_1) = 1 - \\frac{2}{0.5}(1 - \\exp(-0.5)) + \\exp(-0.5) $$\n$$ p_{\\mathrm{span}}(L_1) = 1 - 4(1 - \\exp(-0.5)) + \\exp(-0.5) = 1 - 4 + 4\\exp(-0.5) + \\exp(-0.5) $$\n$$ p_{\\mathrm{span}}(L_1) = 5\\exp(-0.5) - 3 $$\n\n对于 $L_2 = 2000$ bp：\n无量纲乘积为 $\\lambda L_2 = \\frac{1}{300} \\times 2000 = \\frac{20}{3}$。\n$$ p_{\\mathrm{span}}(L_2) = 1 - \\frac{2}{20/3}(1 - \\exp(-20/3)) + \\exp(-20/3) $$\n$$ p_{\\mathrm{span}}(L_2) = 1 - \\frac{6}{20}(1 - \\exp(-20/3)) + \\exp(-20/3) = 1 - 0.3 + 0.3\\exp(-20/3) + \\exp(-20/3) $$\n$$ p_{\\mathrm{span}}(L_2) = 0.7 + 1.3\\exp(-20/3) $$\n\n所求的量为 $\\Delta A = p_{\\mathrm{span}}(L_2) - p_{\\mathrm{span}}(L_1)$。\n$$ \\Delta A = (0.7 + 1.3\\exp(-20/3)) - (5\\exp(-0.5) - 3) $$\n$$ \\Delta A = 3.7 + 1.3\\exp(-20/3) - 5\\exp(-0.5) $$\n\n现在我们代入指数函数的数值：\n$\\exp(-0.5) \\approx 0.6065306597$\n$\\exp(-20/3) \\approx 0.0012712499$\n\n$$ p_{\\mathrm{span}}(L_1) \\approx 5 \\times 0.6065306597 - 3 = 3.0326532985 - 3 = 0.0326532985 $$\n$$ p_{\\mathrm{span}}(L_2) \\approx 0.7 + 1.3 \\times 0.0012712499 = 0.7 + 0.0016526249 = 0.7016526249 $$\n\n$$ \\Delta A \\approx 0.7016526249 - 0.0326532985 = 0.6689993264 $$\n\n将结果四舍五入到四位有效数字，我们得到 $0.6690$。",
            "answer": "$$\\boxed{0.6690}$$"
        }
    ]
}