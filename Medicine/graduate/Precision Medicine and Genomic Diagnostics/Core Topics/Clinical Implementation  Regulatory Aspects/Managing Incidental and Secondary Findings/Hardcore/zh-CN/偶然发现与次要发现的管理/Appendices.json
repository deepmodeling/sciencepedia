{
    "hands_on_practices": [
        {
            "introduction": "准确的疾病外显率估计是评估基因发现临床意义的基石。然而，来自专科诊所的数据常常因转诊偏倚而高估了真实的外显率，这种现象也被称为“确认偏倚”或“幸存者偏倚”。本练习将引导您从第一性原理出发，量化并校正这种偏倚，从而为偶见和继发性发现的管理提供更可靠的循证基础 。",
            "id": "4356973",
            "problem": "一家三级医疗基因组学诊所根据美国医学遗传学与基因组学学会 (American College of Medical Genetics and Genomics, ACMG) 的建议，返还可操作的次级发现。考虑一个与迟发性疾病相关的基因，其结果返还政策取决于对外显率的准确估计。将外显率定义为携带者在特定年龄阈值前发病的概率，记为 $p = P(D \\mid G)$，其中 $D$ 表示在阈值年龄前发病，而 $G$ 表示携带者状态。在一个通过诊断性测序识别的、基于诊所的转诊携带者队列中，600 名转诊携带者中有 240 人在阈值年龄前有疾病记录。因此，转诊队列中的观测外显率为 $p_{\\mathrm{obs}} = 240/600$。\n\n假设存在以下有科学依据的选择机制，该机制模拟了存活者偏倚和转诊偏倚：患病 ($D$) 的携带者被转诊至诊所的概率为 $P(R \\mid D, G)$，而未患病 ($\\neg D$) 的携带者被转诊的概率为 $P(R \\mid \\neg D, G)$。由于症状驱动的转诊和存活差异，$P(R \\mid D, G)$ 是 $P(R \\mid \\neg D, G)$ 的3倍，并假设除了这种乘性转诊富集之外，没有其他偏倚来源或差异性存活。将携带者视为可交换的，并假设在给定 $D$ 和 $G$ 的条件下，$R$ 与其他变量独立。\n\n仅从外显率、条件概率和贝叶斯定理的定义出发，在给定的3倍富集模型下，从 $p_{\\mathrm{obs}}$ 推导出校正后的群体外显率 $p$。然后计算定义为观测外显率与校正外显率之比的高估因子 $\\omega = \\frac{p_{\\mathrm{obs}}}{p}$，并报告 $\\omega$。将您的答案四舍五入至四位有效数字。将最终答案表示为无量綱标量。",
            "solution": "该问题要求推导对疾病外显率估计中确认偏倚的校正方法，并计算由此产生的高估因子。我们首先将问题陈述中给出的量进行形式化。\n\n设 $G$ 表示个体是致病性变异的携带者这一事件。\n设 $D$ 表示携带者在特定年龄阈值前发病这一事件。\n设 $R$ 表示携带者被转诊至诊所这一事件。\n\n我们旨在估计的真实群体外显率，定义为在携带者状态下发生疾病的概率：\n$$p = P(D \\mid G)$$\n因此，携带者在阈值年龄前未发病的概率为 $P(\\neg D \\mid G) = 1 - P(D \\mid G) = 1 - p$。\n\n问题提供了来自一个基于诊所的队列的数据。观测外显率 $p_{\\mathrm{obs}}$ 是指被转诊至诊所的携带者中患病个体的比例。这是一个条件概率：即在一个人是已被转诊的携带者的条件下，其患病的概率。\n$$p_{\\mathrm{obs}} = P(D \\mid R, G)$$\n根据所提供的数据，600 名转诊携带者中有 240 人患病，因此：\n$$p_{\\mathrm{obs}} = \\frac{240}{600} = \\frac{2}{5} = 0.4$$\n\n问题描述了一个转诊偏倚模型。患病携带者被转诊的概率为 $P(R \\mid D, G)$，而未患病携带者被转诊的概率为 $P(R \\mid \\neg D, G)$。该模型指出，症状驱动的转诊导致患病个体的富集程度为3倍。我们可以用数学方式表达这一关系。设 $P(R \\mid \\neg D, G) = k$，其中 $k  0$ 为某个基础转诊概率。那么，患病携带者的转诊概率为：\n$$P(R \\mid D, G) = 3 \\times P(R \\mid \\neg D, G) = 3k$$\n\n为了将观测外显率 $p_{\\mathrm{obs}}$ 与真实外显率 $p$ 联系起来，我们使用贝叶斯定理。$p_{\\mathrm{obs}} = P(D \\mid R, G)$ 的表达式可以写为：\n$$p_{\\mathrm{obs}} = \\frac{P(R \\mid D, G) P(D \\mid G)}{P(R \\mid G)}$$\n分母 $P(R \\mid G)$ 是携带者被转诊至诊所的总概率。我们可以使用全概率公式，以疾病状态（$D$ 或 $\\neg D$）为条件展开此项：\n$$P(R \\mid G) = P(R \\mid D, G) P(D \\mid G) + P(R \\mid \\neg D, G) P(\\neg D \\mid G)$$\n\n现在，我们将定义的术语和转诊偏倚模型代入此方程：\n- $P(D \\mid G) = p$\n- $P(\\neg D \\mid G) = 1 - p$\n- $P(R \\mid D, G) = 3k$\n- $P(R \\mid \\neg D, G) = k$\n\n将这些代入 $P(R \\mid G)$ 的表达式中：\n$$P(R \\mid G) = (3k)(p) + (k)(1 - p) = 3kp + k - kp = k(2p + 1)$$\n\n现在我们将此结果代回 $p_{\\mathrm{obs}}$ 的贝叶斯定理表达式中：\n$$p_{\\mathrm{obs}} = \\frac{P(R \\mid D, G) P(D \\mid G)}{P(R \\mid G)} = \\frac{(3k)(p)}{k(2p + 1)}$$\n未知的基础转诊率 $k$ 被消掉了，这是意料之中的，因为偏倚是由一个相对比率描述的：\n$$p_{\\mathrm{obs}} = \\frac{3p}{2p + 1}$$\n这个方程建立了有偏倚样本中的观测外显率与真实群体外显率之间的关系。\n\n我们的下一个任务是解此方程求真实外显率 $p$：\n$$p_{\\mathrm{obs}}(2p + 1) = 3p$$\n$$2p \\cdot p_{\\mathrm{obs}} + p_{\\mathrm{obs}} = 3p$$\n$$p_{\\mathrm{obs}} = 3p - 2p \\cdot p_{\\mathrm{obs}}$$\n$$p_{\\mathrm{obs}} = p(3 - 2 p_{\\mathrm{obs}})$$\n$$p = \\frac{p_{\\mathrm{obs}}}{3 - 2 p_{\\mathrm{obs}}}$$\n这就是基于观测值和给定的确认偏倚模型计算校正后群体外显率的公式。\n\n问题要求计算高估因子 $\\omega$，其定义为观测外显率与校正后外显率之比：\n$$\\omega = \\frac{p_{\\mathrm{obs}}}{p}$$\n使用我们刚才推导出的 $p$ 的表达式，我们可以得到一个关于 $\\omega$ 的简单表达式：\n$$\\omega = \\frac{p_{\\mathrm{obs}}}{\\left(\\frac{p_{\\mathrm{obs}}}{3 - 2 p_{\\mathrm{obs}}}\\right)} = 3 - 2 p_{\\mathrm{obs}}$$\n这个简洁的结果表明，高估因子是观测外显率和偏倚模型中乘性因子（该因子已隐含在此公式中）的直接函数。\n\n最后，我们使用给定的值 $p_{\\mathrm{obs}} = 0.4$ 来计算 $\\omega$ 的数值：\n$$\\omega = 3 - 2(0.4)$$\n$$\\omega = 3 - 0.8$$\n$$\\omega = 2.2$$\n问题要求答案四舍五入到四位有效数字。由于 $2.2$ 是一个精确结果，我们可以将其写为 $2.200$。这个因子表明，40% 的观测外显率比真实的、校正后的群体外显率高 2.2 倍。校正后的外显率为 $p = \\frac{0.4}{2.2} = \\frac{2}{11} \\approx 0.1818$，即 18.18%。",
            "answer": "$$\\boxed{2.200}$$"
        },
        {
            "introduction": "在基因组测序中发现新变异后，核心挑战在于准确评估其致病性。本练习将一个质性的临床指南（ACMG/AMP变异分类标准）转化为一个定量的贝叶斯框架。通过将不同的证据（如PVS1、PM2）校准为贝叶斯因子，您可以练习如何综合多源信息，从而计算出变异致病性的后验概率，这是决定是否报告一项继发性发现的关键一步 。",
            "id": "4356996",
            "problem": "一次因非相关适应症进行的临床外显子组测序，在美国医学遗传学与基因组学学会（ACMG）的次级发现列表中的一个基因上，产生了一个次级发现。该变异是BRCA1基因中的一个提前终止（无义）变异，在一名先前无症状的成年人中被识别出来。该实验室采用贝叶斯框架来管理偶然发现和次级发现，通过估计致病性的后验概率，并将其与一个结果返回策略阈值进行比较。对于在ACMG次级发现基因中偶然检测到的任何罕见的、改变蛋白质的变异，实验室采用的变异水平致病性先验概率为 $0.01$。\n\n对于此变异，以下ACMG证据代码得到了经过验证的数据的支持：\n- PVS1（非常强）：功能丧失是BRCA1中已知的致病机制，且该变异被预测为无效变异。\n- PM2_Supporting（支持性）：在具有足够覆盖度的人群数据库中未发现该变异。\n- PP3（支持性）：多个计算工具预测对基因产物有有害影响，且预测结果一致。\n\n使用以下广泛使用的ACMG证据强度校准值作为贝叶斯因子（贝叶斯证据权重）：非常强 $350$，强 $18.7$，中等 $4.3$，支持性 $2.08$。\n\n从贝叶斯定理和优势（odds）的定义出发，假设在给定真实状态的情况下这些证据项是条件独立的，并推导出此变异的致病性后验概率。将最终的后验概率报告为一个无单位的、四舍五入到四位有效数字的小数。",
            "solution": "任务是使用贝叶斯框架计算一个基因变异的致病性后验概率。我们将从贝叶斯定理、优势（odds）和贝叶斯因子的定义开始。\n\n设 $D$ 为变异确实是致病的事件。其互补事件 $D^c$ 为变异是良性的。问题提供了在ACMG次级发现基因中，一个罕见的、改变蛋白质的变异的致病性先验概率：\n$$\nP(D) = 0.01\n$$\n由此，变异为良性的先验概率是：\n$$\nP(D^c) = 1 - P(D) = 1 - 0.01 = 0.99\n$$\n通过使用贝叶斯定理的优势形式，分析得以简化。支持致病性的先验优势是先验概率的比值：\n$$\n\\text{Odds}(D) = \\frac{P(D)}{P(D^c)} = \\frac{0.01}{0.99}\n$$\n优势形式的贝叶斯定理表明，后验优势是先验优势与贝叶斯因子（BF）的乘积：\n$$\n\\text{Odds}(D|E) = \\text{Odds}(D) \\times \\text{BF}(E)\n$$\n其中 $E$ 代表收集到的证据，且 $\\text{Odds}(D|E) = \\frac{P(D|E)}{P(D^c|E)}$。贝叶斯因子 $\\text{BF}(E)$ 是指在变异为致病性的情况下观察到证据的似然与在变异为良性的情况下观察到证据的似然之比：\n$$\n\\text{BF}(E) = \\frac{P(E|D)}{P(E|D^c)}\n$$\n问题提供了三条证据：\n1.  $E_1$：PVS1（非常强证据）\n2.  $E_2$：PM2_Supporting（支持性证据）\n3.  $E_3$：PP3（支持性证据）\n\n问题给出了一个关键假设，即在给定真实疾病状态（$D$ 或 $D^c$）的情况下，这些证据项是条件独立的。这个假设允许将组合证据（$E = E_1, E_2, E_3$）的总贝叶斯因子计算为每条证据的独立贝叶斯因子的乘积：\n$$\n\\text{BF}(E) = \\text{BF}(E_1) \\times \\text{BF}(E_2) \\times \\text{BF}(E_3)\n$$\n问题提供了每个ACMG证据代码作为贝叶斯因子的校准强度：\n-   对于 $E_1$（PVS1, 非常强）：$\\text{BF}(E_1) = 350$\n-   对于 $E_2$（PM2_Supporting, 支持性）：$\\text{BF}(E_2) = 2.08$\n-   对于 $E_3$（PP3, 支持性）：$\\text{BF}(E_3) = 2.08$\n\n现在我们可以计算总贝叶斯因子：\n$$\n\\text{BF}(E) = 350 \\times 2.08 \\times 2.08 = 350 \\times (2.08)^2 = 350 \\times 4.3264 = 1514.24\n$$\n有了总贝叶斯因子，我们计算致病性的后验优势：\n$$\n\\text{Odds}(D|E) = \\text{Odds}(D) \\times \\text{BF}(E) = \\left(\\frac{0.01}{0.99}\\right) \\times 1514.24\n$$\n$$\n\\text{Odds}(D|E) \\approx 0.010101... \\times 1514.24 \\approx 15.295353...\n$$\n最后，我们必须将后验优势转换回后验概率。概率 $P$ 和优势 $O$ 之间的关系由 $P = \\frac{O}{1+O}$ 给出。因此，致病性的后验概率 $P(D|E)$ 为：\n$$\nP(D|E) = \\frac{\\text{Odds}(D|E)}{1 + \\text{Odds}(D|E)}\n$$\n代入计算出的后验优势值：\n$$\nP(D|E) = \\frac{15.295353...}{1 + 15.295353...} = \\frac{15.295353...}{16.295353...} \\approx 0.938633...\n$$\n或者，为了保持精度，我们可以使用精确的分数形式：\n$$\nP(D|E) = \\frac{\\frac{0.01 \\times 1514.24}{0.99}}{1 + \\frac{0.01 \\times 1514.24}{0.99}} = \\frac{0.01 \\times 1514.24}{0.99 + (0.01 \\times 1514.24)} = \\frac{15.1424}{0.99 + 15.1424} = \\frac{15.1424}{16.1324}\n$$\n$$\nP(D|E) \\approx 0.938633...\n$$\n问题要求将最终答案报告为一个无单位的、四舍五入到四位有效数字的小数。前四位有效数字是 $9, 3, 8, 6$。第五位数字是 $3$，所以我们向下舍入。\n$$\nP(D|E) \\approx 0.9386\n$$",
            "answer": "$$\n\\boxed{0.9386}\n$$"
        },
        {
            "introduction": "即使一个基因变异被确认为致病性，决定是否应在临床上报告该偶见发现，仍需仔细权衡。这个决策不仅取决于检测的准确性，还与疾病的罕见程度以及假阳性和假阴性结果的相对危害密切相关。本练习整合了先验概率（患病率）、灵敏度、特异性和决策理论，通过计算阳性预测值（$PPV$）和净效用，为“是否报告”这一复杂问题提供了一个定量的决策模型 。",
            "id": "4356938",
            "problem": "一家进行全面基因组测序的临床实验室，在一个与某种可预防的成人发病型疾病有明确关联的基因中发现了一个附带发现。为了管理此类附带或次级发现，实验室必须根据对结果采取行动的预期收益与损害，来决定是否报告该基因-疾病关联的阳性结果。\n\n假设以下条件在相关人群中已知且已得到验证：\n- 确实患有该可干预性疾病表型的检验前概率为 $\\pi = 0.005$。\n- 当分析流程将基因-疾病关联分类为存在时，检测报告为“阳性”，其灵敏度 $Se = 0.9$，特异度 $Sp = 0.995$。\n- 假阳性（FP）的成本，记作 $C_{FP}$，为 $C_{FP} = 1$ 标准化效用单位（无量纲）。\n- 假阴性（FN）的成本，记作 $C_{FN}$，为 $C_{FN} = 5$ 标准化效用单位（无量纲）。\n\n从灵敏度、特异度和条件概率的贝叶斯定理的基本定义出发，首先推导阳性检测结果的阳性预测值（PPV），即 $PPV = P(\\text{disease} \\mid \\text{positive})$。\n\n然后，运用决策理论的基本原理，将报告决策阈值定义为对阳性结果采取行动的期望损失与不采取行动的期望损失相等的点。根据此原理，确定在此情境下，采取行动与不采取行动之间的净效用差 $U$，并以单一数字表示。正的 $U$ 值意味着采取行动（报告并建议随访）的效用超过阈值；负的 $U$ 值则意味着未超过。\n\n将您的最终净效用差四舍五入至四位有效数字。将最终答案表示为一个无量纲数。",
            "solution": "设 $D$ 为某人患有该可干预性疾病表型的事件，设 $D^c$ 为该人未患病的事件。检验前概率，或称患病率，给定为 $P(D) = \\pi = 0.005$。因此，不患该病的概率为 $P(D^c) = 1 - \\pi = 1 - 0.005 = 0.995$。\n\n设 $T$ 为检测结果为阳性的事件，设 $T^c$ 为检测结果为阴性的事件。检测特性给定如下：\n- 灵敏度：$Se = P(T|D) = 0.9$。这是在患病条件下检测结果为阳性的概率。\n- 特异度：$Sp = P(T^c|D^c) = 0.995$。这是在未患病条件下检测结果为阴性的概率。\n\n根据特异度，我们可以求出假阳性率，即在未患病条件下检测结果为阳性的概率：\n$P(T|D^c) = 1 - Sp = 1 - 0.995 = 0.005$。\n\n**第一部分：阳性预测值 (PPV) 的推导**\n阳性预测值 $PPV$ 是指在某人收到阳性检测结果的条件下，他确实患有该疾病的概率，即 $P(D|T)$。我们使用贝叶斯定理来求这个值：\n$$PPV = P(D|T) = \\frac{P(T|D) P(D)}{P(T)}$$\n首先，我们必须使用全概率公式计算检测结果为阳性的总概率 $P(T)$：\n$$P(T) = P(T|D)P(D) + P(T|D^c)P(D^c)$$\n代入已知值：\n$$P(T) = (Se \\times \\pi) + ((1 - Sp) \\times (1 - \\pi))$$\n$$P(T) = (0.9 \\times 0.005) + (0.005 \\times 0.995)$$\n$$P(T) = 0.0045 + 0.004975 = 0.009475$$\n现在我们可以计算 $PPV$：\n$$PPV = \\frac{Se \\times \\pi}{P(T)} = \\frac{0.9 \\times 0.005}{0.009475} = \\frac{0.0045}{0.009475}$$\n精确的分数值是 $PPV = \\frac{4500}{9475} = \\frac{180}{379}$。在检测结果为阳性的条件下，发生假阳性的概率是 $P(D^c|T) = 1 - P(D|T) = 1 - PPV$。\n\n**第二部分：净效用差 (U) 的计算**\n采取行动或不采取行动的决策是在观察到阳性结果*之后*做出的。因此，所有计算都以事件 $T$ 为条件。效用是损失的负值（$U = -L$）。采取行动与不采取行动之间的净效用差 $U$ 定义为 $U = U_{\\text{act}} - U_{\\text{not act}} = (-L_{\\text{act}}) - (-L_{\\text{not act}}) = L_{\\text{not act}} - L_{\\text{act}}$，其中 $L$ 表示期望损失。\n\n1.  **对阳性结果采取行动的期望损失 ($L_{\\text{act}}$)：**\n    如果我们采取行动，我们就按照患者患有该病来处理。只有当这个判断是错误的，即检测结果为假阳性时，才会产生损失。这种情况的概率是 $P(D^c|T) = 1-PPV$。\n    假阳性的成本是 $C_{FP} = 1$。\n    真阳性（正确行动）的成本假定为 $0$。\n    $$L_{\\text{act}} = (C_{FP} \\times P(D^c|T)) + (0 \\times P(D|T)) = C_{FP} \\times (1 - PPV)$$\n\n2.  **不对阳性结果采取行动的期望损失 ($L_{\\text{not act}}$)：**\n    如果我们不采取行动，我们就按照患者没有患病来处理，实际上是忽略了阳性的检测结果。只有当患者确实患有该病时才会产生损失，这对应于一个假阴性*决策*。这种情况的概率是 $P(D|T) = PPV$。\n    假阴性的成本是 $C_{FN} = 5$。\n    真阴性（在患者未患病时不采取行动）的成本假定为 $0$。\n    $$L_{\\text{not act}} = (C_{FN} \\times P(D|T)) + (0 \\times P(D^c|T)) = C_{FN} \\times PPV$$\n\n净效用差 $U$ 为：\n$$U = L_{\\text{not act}} - L_{\\text{act}} = (C_{FN} \\times PPV) - (C_{FP} \\times (1 - PPV))$$\n代入数值和 PPV 的表达式：\n$$U = \\left(5 \\times \\frac{0.0045}{0.009475}\\right) - \\left(1 \\times \\left(1 - \\frac{0.0045}{0.009475}\\right)\\right)$$\n$$U = \\frac{5 \\times 0.0045}{0.009475} - \\frac{0.009475 - 0.0045}{0.009475}$$\n$$U = \\frac{0.0225}{0.009475} - \\frac{0.004975}{0.009475}$$\n$$U = \\frac{0.0225 - 0.004975}{0.009475} = \\frac{0.017525}{0.009475}$$\n计算数值：\n$$U \\approx 1.8496042216...$$\n问题要求将最终答案四舍五入至四位有效数字。\n$$U \\approx 1.850$$\n因为 $U > 0$，对阳性结果采取行动的效用大于不采取行动的效用，这表明在此模型下，预期收益超过了预期损害。",
            "answer": "$$\\boxed{1.850}$$"
        }
    ]
}