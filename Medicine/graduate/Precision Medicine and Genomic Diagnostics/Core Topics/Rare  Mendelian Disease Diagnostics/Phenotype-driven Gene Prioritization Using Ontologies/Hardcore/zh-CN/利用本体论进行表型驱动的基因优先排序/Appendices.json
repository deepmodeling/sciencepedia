{
    "hands_on_practices": [
        {
            "introduction": "为了根据表型对基因进行排序，我们首先需要一种数学方法来衡量单个表型概念之间的相似性。本练习将引导您从信息论的基本原理出发，推导出一个被广泛应用的语义相似度度量，这构成了后续更复杂基因排序算法的基石。通过这个过程，您将深入理解信息内容（Information Content）和最低共同祖先（Lowest Common Ancestor）在量化生物学概念相似性中的核心作用。",
            "id": "4368586",
            "problem": "在表型驱动的基因优先级排序中，人类表型本体论 (Human Phenotype Ontology, HPO) 术语用于量化患者与候选基因之间的表型相似性。设一个术语表示为 $t$，其信息内容定义为 $IC(t) := -\\ln p(t)$，其中 $p(t)$ 是在本体论的包容层次结构中（遵循“真实路径规则”）沿注释传播观察到 $t$ 的经验概率。对于两个 HPO 术语 $t_1$ 和 $t_2$，用 $LCA(t_1,t_2)$ 表示它们在本体论有向无环图中的最低共同祖先，并用 $IC(LCA)$ 表示该祖先的信息内容。\n\n任务 A（推导）：从以下基本依据出发：\n- 香农自信息定义 $IC(t) = -\\ln p(t)$，\n- 本体论的真实路径规则，确保注释会传播到祖先，以及\n- 设计原则，即语义相似度应是一个关于“共享信息”和各自信息内容的对称、无标度函数，其值界于 $[0,1]$ 之间，并且当且仅当 $t_1=t_2$ 时等于 $1$，\n\n推导一个对称相似度 $s(t_1,t_2)$ 的闭式表达式，该表达式仅依赖于 $IC(t_1)$、$IC(t_2)$ 和 $IC(LCA)$，其中 $t_1$ 和 $t_2$ 之间的“共享信息”被认为是 $IC(LCA)$（即它们信息量最大的共同祖先的信息内容）。您的推导必须从第一性原理出发，证明归一化选择的合理性，并给出一个明确的 $s(t_1,t_2)$ 公式。\n\n任务 B（求值）：对于 $IC(t_1)=7$、$IC(t_2)=4$ 和 $IC(LCA)=3$，计算相似度 $s(t_1,t_2)$。将最终数值结果表示为一个精确的最简分数。无需单位。",
            "solution": "该问题分为两个任务：(A) 基于一组公理化约束推导语义相似度度量 $s(t_1, t_2)$ 的闭式表达式，以及 (B) 对给定的一组信息内容值计算该度量。\n\n### 任务 A：相似度度量的推导\n\n目标是推导两个本体论术语 $t_1$ 和 $t_2$ 之间的对称相似度度量 $s(t_1, t_2)$ 的闭式表达式。推导必须基于第一性原理并遵循指定的约束。\n\n基本原理和约束如下：\n1.  相似度 $s(t_1, t_2)$ 是信息内容 $IC(t_1)$、$IC(t_2)$ 和 $IC(LCA)$ 的函数，其中 $LCA$ 是 $t_1$ 和 $t_2$ 的最低共同祖先。\n2.  术语 $t$ 的信息内容是 $IC(t) = -\\ln p(t)$，其中 $p(t)$ 是其概率。\n3.  $t_1$ 和 $t_2$ 之间的共享信息定义为其最低共同祖先的信息内容，即 $IC(LCA(t_1, t_2))$。\n4.  相似度度量必须满足以下性质：\n    a. 对称性：$s(t_1, t_2) = s(t_2, t_1)$。\n    b. 有界性：$0 \\le s(t_1, t_2) \\le 1$。\n    c. 同一性：$s(t_1, t_2) = 1$ 当且仅当 $t_1 = t_2$。\n\n构建相似度度量的一种广泛采用的方法是将其定义为两个实体共享的信息与它们所代表的总信息之比的归一化值。\n\n根据指定，我们将共享信息定义为 $I_{shared} = IC(LCA(t_1, t_2))$。\n我们将单个术语 $t_1$ 和 $t_2$ 的总信息内容表示为其各自信息内容之和：$I_{total} = IC(t_1) + IC(t_2)$。\n\n基于此原则，相似度度量的初步形式可以是共享信息与总信息之比。然而，这样一个简单的比率必须被正确归一化以满足同一性。让我们用一个归一化常数 $C$ 来构建相似度度量：\n$$s(t_1, t_2) = C \\cdot \\frac{I_{shared}}{I_{total}} = C \\cdot \\frac{IC(LCA(t_1, t_2))}{IC(t_1) + IC(t_2)}$$\n\n我们通过应用同一性 (4c)：$s(t, t) = 1$ 来确定归一化常数 $C$。\n如果 $t_1 = t_2 = t$，那么一个术语与自身的最低共同祖先就是该术语本身，即 $LCA(t, t) = t$。\n因此，$IC(LCA(t, t)) = IC(t)$。\n\n将这些代入相似度公式，我们得到：\n$$s(t, t) = C \\cdot \\frac{IC(t)}{IC(t) + IC(t)} = C \\cdot \\frac{IC(t)}{2 \\cdot IC(t)}$$\n对于任何具有非零信息内容（即 $p(t)  1$）的术语 $t$，这可以简化为：\n$$s(t, t) = C \\cdot \\frac{1}{2}$$\n为了满足同一性条件 $s(t, t) = 1$，我们必须有：\n$$C \\cdot \\frac{1}{2} = 1 \\implies C = 2$$\n\n这证明了选择该归一化常数的合理性。因此，推导出的相似度度量的闭式表达式为：\n$$s(t_1, t_2) = \\frac{2 \\cdot IC(LCA(t_1, t_2))}{IC(t_1) + IC(t_2)}$$\n这通常被称为 Lin 氏相似度度量。\n\n我们必须验证此表达式满足所有陈述的性质：\n- **对称性**：$LCA$ 算子是对称的，即 $LCA(t_1, t_2) = LCA(t_2, t_1)$，并且加法是可交换的。因此，$s(t_1, t_2) = \\frac{2 \\cdot IC(LCA(t_1, t_2))}{IC(t_1) + IC(t_2)} = \\frac{2 \\cdot IC(LCA(t_2, t_1))}{IC(t_2) + IC(t_1)} = s(t_2, t_1)$。该性质成立。\n- **有界性**：信息内容 $IC(t) = -\\ln p(t)$ 总是非负的，因为 $p(t) \\in (0, 1]$。因此，$s(t_1, t_2) \\ge 0$。“真实路径规则”意味着如果一个概念 $t_1$ 存在，其所有祖先，包括 $LCA(t_1, t_2)$，也必须存在于其注释路径中。这意味着子术语至少与其父术语一样具体，所以 $p(t_1) \\le p(LCA(t_1, t_2))$ 且 $p(t_2) \\le p(LCA(t_1, t_2))$。对这些不等式取 $-\\ln$ 会反转它们的方向：$IC(t_1) \\ge IC(LCA(t_1, t_2))$ 且 $IC(t_2) \\ge IC(LCA(t_1, t_2))$。将它们相加得到 $IC(t_1) + IC(t_2) \\ge 2 \\cdot IC(LCA(t_1, t_2))$。因此，$s(t_1, t_2) = \\frac{2 \\cdot IC(LCA(t_1, t_2))}{IC(t_1) + IC(t_2)} \\le 1$。性质 $0 \\le s(t_1, t_2) \\le 1$ 成立。\n- **同一性**：根据构造，$s(t, t) = 1$。反之，如果 $s(t_1, t_2) = 1$，则 $2 \\cdot IC(LCA) = IC(t_1) + IC(t_2)$。因为我们知道 $IC(t_1) \\ge IC(LCA)$ 且 $IC(t_2) \\ge IC(LCA)$，这个等式只有在 $IC(t_1) = IC(LCA)$ 且 $IC(t_2) = IC(LCA)$ 时才能成立。在一个标准的本体论中，子术语严格比其父术语更具体，这意味着 $t_1$ 和 $t_2$ 不是 $LCA$ 的后代，而是与 $LCA$ 是同一个节点，这又意味着 $t_1 = t_2 = LCA$。该性质成立。\n- **无标度性**：该度量是具有相同单位（信息比特或奈特）的项之比，使其成为一个无量纲、无标度的量。\n\n推导出的公式满足所有条件。\n\n### 任务 B：相似度度量的求值\n\n给定数值：\n- $IC(t_1) = 7$\n- $IC(t_2) = 4$\n- $IC(LCA) = 3$\n\n首先，我们检查其与本体论结构的一致性。我们必须有 $IC(t_1) \\ge IC(LCA)$ 和 $IC(t_2) \\ge IC(LCA)$。确实，$7 \\ge 3$ 和 $4 \\ge 3$，所以这些值是一致的。\n\n现在我们使用推导出的公式来计算相似度 $s(t_1, t_2)$：\n$$s(t_1, t_2) = \\frac{2 \\cdot IC(LCA)}{IC(t_1) + IC(t_2)}$$\n代入给定的值：\n$$s(t_1, t_2) = \\frac{2 \\cdot 3}{7 + 4}$$\n$$s(t_1, t_2) = \\frac{6}{11}$$\n数字 $6$ 和 $11$ 互质，所以该分数已经是其最简形式。",
            "answer": "$$\\boxed{\\frac{6}{11}}$$"
        },
        {
            "introduction": "我们使用的语义相似度度量依赖于信息内容（$IC$），而$IC$值本身是由术语在背景知识库中的频率计算得出的。这个练习将通过一个具体的反例，揭示一个关键问题：术语频率的不同计算方法会如何显著影响基因排序的结果。通过对比两种不同的概率模型，您将认识到在计算$IC$时遵循本体论“真路径规则”（true path rule）的重要性，以及忽略这一规则可能导致的与直觉相悖的排序错误。",
            "id": "4368546",
            "problem": "在使用人类表型本体 (HPO) 进行表型驱动的基因优先级排序时，该本体是一个具有“is-a”层次结构的有向无环图，并遵循真实路径规则：如果一个基因被注释到一个术语 $t$，那么它也被隐式地注释到 $t$ 的所有祖先。考虑一个包含 $N=1000$ 个基因的背景语料库，其直接术语注释构成了以下小型本体片段：一个根有两个子代 $t_{1}$ 和 $t_{2}$；$t_{1}$ 有子代 $t_{1a}$ 和 $t_{1b}$；$t_{2}$ 有子代 $t_{2a}$。语料库中直接分配的注释如下：\n- $300$ 个基因直接注释到 $t_{1a}$，\n- $300$ 个基因直接注释到 $t_{1b}$，\n- $5$ 个基因直接注释到 $t_{1}$，\n- $10$ 个基因直接注释到 $t_{2a}$，\n- $0$ 个基因直接注释到 $t_{2}$ 或此片段中的任何其他术语。\n\n您必须比较一个术语 $t$ 的两种背景术语概率估计值，记为 $p(t)$：\n- 原始术语频率：$p_{\\mathrm{raw}}(t)$ 等于直接注释到 $t$ 的基因比例。\n- 术语频率加后代（真实路径闭包）：$p_{\\mathrm{clo}}(t)$ 等于注释到 $t$ 或其任何后代的基因比例。\n\n假设一个患者有一个单一的 HPO 查询术语 $Q=\\{t_{1a}\\}$。给定两个候选基因：\n- 基因 $G_{A}$ 直接注释到 $t_{1}$。\n- 基因 $G_{B}$ 直接注释到 $t_{1a}$。\n\n通过对查询术语进行求和，来定义 $Q$ 和候选基因 $g$ 之间的相似度，求和项是查询术语和该基因注释的“信息量最丰富的共同祖先 (MICA)”的“信息含量 (IC)”。其中，IC 定义为 $\\mathrm{IC}(t)=-\\ln p(t)$（使用自然对数），而 $\\mathrm{MICA}(q,a)$ 是在所选 $p(t)$ 下， $q$ 和 $a$ 共享的具有最大 IC 的祖先。在此设置中，基因 $g$ 的相似度分数简化为 $\\mathrm{IC}(\\mathrm{MICA}(t_{1a},a_{g}))$，其中 $a_{g}$ 是 $g$ 的单一注释。\n\n使用上述语料库，计算在 $p_{\\mathrm{raw}}(t)$ 和 $p_{\\mathrm{clo}}(t)$ 下的分数，并确定在每种 $p(t)$ 定义下 $G_{A}$ 和 $G_{B}$ 之间的导出排序。哪个选项是正确的？\n\nA. 在 $p_{\\mathrm{raw}}(t)$ 下，$G_{A}$ 的排名高于 $G_{B}$；在 $p_{\\mathrm{clo}}(t)$ 下，$G_{B}$ 的排名高于 $G_{A}$。\n\nB. 在 $p_{\\mathrm{raw}}(t)$ 和 $p_{\\mathrm{clo}}(t)$ 下，$G_{B}$ 的排名都高于 $G_{A}$。\n\nC. 在 $p_{\\mathrm{raw}}(t)$ 和 $p_{\\mathrm{clo}}(t)$ 下，$G_{A}$ 的排名都高于 $G_{B}$。\n\nD. 在 $p_{\\mathrm{raw}}(t)$ 下，$G_{B}$ 的排名高于 $G_{A}$；在 $p_{\\mathrm{clo}}(t)$ 下，$G_{A}$ 的排名高于 $G_{B}$。",
            "solution": "用户提供了一个生物信息学领域的计算问题，要求使用人类表型本体 (HPO) 基于表型相似性对基因进行优先级排序。我将首先验证问题陈述，然后进行完整的推导和选项评估。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   **本体：** 具有“is-a”层次结构的有向无环图 (DAG)。\n-   **真实路径规则：** 如果一个基因被注释到一个术语 $t$，那么它也被隐式地注释到 $t$ 的所有祖先。\n-   **语料库大小：** $N=1000$ 个基因。\n-   **本体片段：** 一个根术语有两个子代 $t_1$ 和 $t_2$。$t_1$ 有子代 $t_{1a}$ 和 $t_{1b}$。$t_2$ 有子代 $t_{2a}$。\n-   **直接注释计数：**\n    -   $n_{\\mathrm{direct}}(t_{1a}) = 300$\n    -   $n_{\\mathrm{direct}}(t_{1b}) = 300$\n    -   $n_{\\mathrm{direct}}(t_1) = 5$\n    -   $n_{\\mathrm{direct}}(t_{2a}) = 10$\n    -   $n_{\\mathrm{direct}}(t_2) = 0$\n    -   $0$ 个基因直接注释到此片段中的任何其他术语。\n-   **概率定义：**\n    -   原始术语频率：$p_{\\mathrm{raw}}(t) = n_{\\mathrm{direct}}(t) / N$。\n    -   术语频率加后代（闭包）：$p_{\\mathrm{clo}}(t) = n_{\\mathrm{clo}}(t) / N$，其中 $n_{\\mathrm{clo}}(t)$ 是注释到 $t$ 或其任何后代的基因数量。\n-   **患者查询：** $Q = \\{t_{1a}\\}$。\n-   **候选基因：**\n    -   $G_A$ 直接注释到 $a_A = t_1$。\n    -   $G_B$ 直接注释到 $a_B = t_{1a}$。\n-   **相似度分数：**\n    -   信息含量 (IC)：$\\mathrm{IC}(t) = -\\ln p(t)$。\n    -   信息量最丰富的共同祖先 (MICA)：$\\mathrm{MICA}(q,a)$ 是 $q$ 和 $a$ 的共同祖先中具有最大 IC 的那个。\n    -   基因 $g$ 的分数：$\\mathrm{Score}(g) = \\mathrm{IC}(\\mathrm{MICA}(t_{1a}, a_g))$。分数越高，排名越高。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题使用了生物信息学中用于表型驱动基因优先级排序的标准、成熟概念，包括 HPO、真实路径规则、信息含量 (IC) 和信息量最丰富的共同祖先 (MICA)。这些是语义相似性度量的基础。\n-   **问题明确：** 提供了计算所需分数和确定排名的所有必要数据和定义。直接注释的基因总数为 $300+300+5+10 = 615$，小于语料库总大小 $N=1000$。这是现实的，因为并非背景集中的所有基因都必然被注释。设置是自洽和一致的。\n-   **客观性：** 问题以精确、定量的术语陈述，没有主观性或模糊性。\n\n**步骤 3：结论与行动**\n问题陈述是有效的。它在科学上是合理的、问题明确且客观的。我现在将继续进行解答。\n\n### 解答推导\n\n任务是在两种不同的概率模型 $p_{\\mathrm{raw}}(t)$ 和 $p_{\\mathrm{clo}}(t)$ 下，计算基因 $G_A$ 和 $G_B$ 相对于查询术语 $t_{1a}$ 的相似度分数，并确定最终的排名。\n\n带有注释 $a_g$ 的基因 $g$ 的分数为 $\\mathrm{Score}(g) = \\mathrm{IC}(\\mathrm{MICA}(t_{1a}, a_g))$。\n-   对于基因 $G_A$，其注释为 $a_A = t_1$。分数为 $\\mathrm{Score}(G_A) = \\mathrm{IC}(\\mathrm{MICA}(t_{1a}, t_1))$。\n-   对于基因 $G_B$，其注释为 $a_B = t_{1a}$。分数为 $\\mathrm{Score}(G_B) = \\mathrm{IC}(\\mathrm{MICA}(t_{1a}, t_{1a}))$。\n\n让我们分别分析每种概率模型。\n\n**1. 在原始术语频率 $p_{\\mathrm{raw}}(t)$ 下的分析**\n\n首先，我们计算相关术语的概率及其对应的信息含量 (IC) 值。基因总数为 $N=1000$。\n-   $p_{\\mathrm{raw}}(t_{1a}) = \\frac{n_{\\mathrm{direct}}(t_{1a})}{N} = \\frac{300}{1000} = 0.3$。\n-   $p_{\\mathrm{raw}}(t_1) = \\frac{n_{\\mathrm{direct}}(t_1)}{N} = \\frac{5}{1000} = 0.005$。\n\nIC 值为：\n-   $\\mathrm{IC}_{\\mathrm{raw}}(t_{1a}) = -\\ln(0.3) \\approx 1.204$。\n-   $\\mathrm{IC}_{\\mathrm{raw}}(t_1) = -\\ln(0.005) \\approx 5.298$。\n\n一个重要的观察是，$\\mathrm{IC}_{\\mathrm{raw}}(t_1)  \\mathrm{IC}_{\\mathrm{raw}}(t_{1a})$，尽管 $t_1$ 是 $t_{1a}$ 的祖先。这种信息量的倒置是使用原始直接注释频率时已知的一种人为现象。\n\n现在我们计算 $G_A$ 和 $G_B$ 的分数：\n\n**$G_A$ 的分数：**\n-   我们需要找到 $\\mathrm{MICA}(t_{1a}, t_1)$。$t_{1a}$ 和 $t_1$ 的共同祖先集合（包括术语本身）是 $\\{t_1, \\text{Root}\\}$。\n-   问题没有指定根的直接注释数量，通常假设 $n_{\\mathrm{direct}}(\\text{Root}) = 0$。这将导致 $p_{\\mathrm{raw}}(\\text{Root}) = 0$ 和 $\\mathrm{IC}_{\\mathrm{raw}}(\\text{Root}) = \\infty$。在实践中，这类术语会从 MICA 的考虑中排除，或者使用一个最低概率。我们将只考虑具有有限 IC 的祖先。\n-   唯一具有非零概率的共同祖先是 $t_1$。因此，$\\mathrm{MICA}_{\\mathrm{raw}}(t_{1a}, t_1) = t_1$。\n-   $\\mathrm{Score}_{\\mathrm{raw}}(G_A) = \\mathrm{IC}_{\\mathrm{raw}}(\\mathrm{MICA}_{\\mathrm{raw}}(t_{1a}, t_1)) = \\mathrm{IC}_{\\mathrm{raw}}(t_1) = -\\ln(0.005) \\approx 5.298$。\n\n**$G_B$ 的分数：**\n-   我们需要找到 $\\mathrm{MICA}(t_{1a}, t_{1a})$。问题中 MICA 的定义是“$q$ 和 $a$ 共享的具有最大 IC 的祖先”。\n-   如果我们字面应用这个定义，$t_{1a}$ 与自身的共同祖先集合是 $\\{t_{1a}, t_1, \\text{Root}\\}$。IC 值分别为 $\\mathrm{IC}_{\\mathrm{raw}}(t_{1a}) \\approx 1.204$ 和 $\\mathrm{IC}_{\\mathrm{raw}}(t_1) \\approx 5.298$。由于 IC 倒置，MICA 将是 $t_1$，而不是 $t_{1a}$，这导致其得分与 $G_A$ 相同。这是违反直觉的；一个完美的匹配应该具有最大的相似度。\n-   语义相似度的标准惯例是，一个术语与自身的相似度是其自身的信息含量，这意味着 $\\mathrm{MICA}(t, t) = t$。我们采用这个标准解释，因为它解决了模糊性，并且是唯一能得出选项所暗示的严格排序的途径。\n-   因此，$\\mathrm{MICA}_{\\mathrm{raw}}(t_{1a}, t_{1a}) = t_{1a}$。\n-   $\\mathrm{Score}_{\\mathrm{raw}}(G_B) = \\mathrm{IC}_{\\mathrm{raw}}(t_{1a}) = -\\ln(0.3) \\approx 1.204$。\n\n**在 $p_{\\mathrm{raw}}(t)$ 下的排名：**\n-   $\\mathrm{Score}_{\\mathrm{raw}}(G_A) \\approx 5.298$。\n-   $\\mathrm{Score}_{\\mathrm{raw}}(G_B) \\approx 1.204$。\n-   由于 $\\mathrm{Score}_{\\mathrm{raw}}(G_A)  \\mathrm{Score}_{\\mathrm{raw}}(G_B)$，因此 $G_A$ 的排名高于 $G_B$。\n\n**2. 在闭包术语频率 $p_{\\mathrm{clo}}(t)$ 下的分析**\n\n首先，我们根据真实路径规则，通过将一个术语及其所有后代的直接注释相加，来计算传播后的基因计数 $n_{\\mathrm{clo}}(t)$。\n-   $n_{\\mathrm{clo}}(t_{1a}) = n_{\\mathrm{direct}}(t_{1a}) = 300$。\n-   $n_{\\mathrm{clo}}(t_1) = n_{\\mathrm{direct}}(t_1) + n_{\\mathrm{direct}}(t_{1a}) + n_{\\mathrm{direct}}(t_{1b}) = 5 + 300 + 300 = 605$。\n-   （为完整起见，其他术语：$n_{\\mathrm{clo}}(t_{1b}) = 300$；$n_{\\mathrm{clo}}(t_{2a})=10$；$n_{\\mathrm{clo}}(t_2)=10$；$n_{\\mathrm{clo}}(\\text{Root})=615$）。\n\n现在，计算概率 $p_{\\mathrm{clo}}(t)$ 和 IC 值。\n-   $p_{\\mathrm{clo}}(t_{1a}) = \\frac{300}{1000} = 0.3$。\n-   $p_{\\mathrm{clo}}(t_1) = \\frac{605}{1000} = 0.605$。\n\nIC 值为：\n-   $\\mathrm{IC}_{\\mathrm{clo}}(t_{1a}) = -\\ln(0.3) \\approx 1.204$。\n-   $\\mathrm{IC}_{\\mathrm{clo}}(t_1) = -\\ln(0.605) \\approx 0.5025$。\n\n使用闭包频率恢复了 IC 的预期单调性：$p_{\\mathrm{clo}}(t_{1a})  p_{\\mathrm{clo}}(t_1)$，因此 $\\mathrm{IC}_{\\mathrm{clo}}(t_{1a})  \\mathrm{IC}_{\\mathrm{clo}}(t_1)$。子代术语比其父代术语信息量更大。\n\n现在我们计算 $G_A$ 和 $G_B$ 的分数：\n\n**$G_A$ 的分数：**\n-   我们需要 $\\mathrm{MICA}(t_{1a}, t_1)$。共同祖先是 $\\{t_1, \\text{Root}\\}$。\n-   $\\mathrm{IC}_{\\mathrm{clo}}(t_1) \\approx 0.5025$。根的 IC 会更低，因为其概率更高。\n-   $\\mathrm{MICA}_{\\mathrm{clo}}(t_{1a}, t_1) = t_1$。\n-   $\\mathrm{Score}_{\\mathrm{clo}}(G_A) = \\mathrm{IC}_{\\mathrm{clo}}(t_1) = -\\ln(0.605) \\approx 0.5025$。\n\n**$G_B$ 的分数：**\n-   我们需要 $\\mathrm{MICA}(t_{1a}, t_{1a})$。共同祖先是 $\\{t_{1a}, t_1, \\text{Root}\\}$。\n-   IC 值分别为 $\\mathrm{IC}_{\\mathrm{clo}}(t_{1a}) \\approx 1.204$ 和 $\\mathrm{IC}_{\\mathrm{clo}}(t_1) \\approx 0.5025$。\n-   MICA 是具有最大 IC 的那个，即 $t_{1a}$。$\\mathrm{MICA}_{\\mathrm{clo}}(t_{1a}, t_{1a}) = t_{1a}$。\n-   $\\mathrm{Score}_{\\mathrm{clo}}(G_B) = \\mathrm{IC}_{\\mathrm{clo}}(t_{1a}) = -\\ln(0.3) \\approx 1.204$。\n\n**在 $p_{\\mathrm{clo}}(t)$ 下的排名：**\n-   $\\mathrm{Score}_{\\mathrm{clo}}(G_A) \\approx 0.5025$。\n-   $\\mathrm{Score}_{\\mathrm{clo}}(G_B) \\approx 1.204$。\n-   由于 $\\mathrm{Score}_{\\mathrm{clo}}(G_B)  \\mathrm{Score}_{\\mathrm{clo}}(G_A)$，因此 $G_B$ 的排名高于 $G_A$。\n\n### 总结与选项评估\n\n-   在 $p_{\\mathrm{raw}}(t)$ 下，$G_A$ 的排名高于 $G_B$。\n-   在 $p_{\\mathrm{clo}}(t)$ 下，$G_B$ 的排名高于 $G_A$。\n\n这说明了背景概率模型的选择，特别是它如何处理本体结构，对基因优先级排序有关键影响。原始频率模型由于 IC 倒置可能会产生违反直觉的结果，而闭包模型则尊重本体的特异性层次结构。\n\n现在，我们评估所提供的选项：\n\n**A. 在 $p_{\\mathrm{raw}}(t)$ 下，$G_{A}$ 的排名高于 $G_{B}$；在 $p_{\\mathrm{clo}}(t)$ 下，$G_{B}$ 的排名高于 $G_{A}$。**\n这与我们推导出的结果相符。\n\n**B. 在 $p_{\\mathrm{raw}}(t)$ 和 $p_{\\mathrm{clo}}(t)$ 下，$G_{B}$ 的排名都高于 $G_{A}$。**\n这是不正确的。在 $p_{\\mathrm{raw}}(t)$ 下的排名是相反的。\n\n**C. 在 $p_{\\mathrm{raw}}(t)$ 和 $p_{\\mathrm{clo}}(t)$ 下，$G_{A}$ 的排名都高于 $G_{B}$。**\n这是不正确的。在 $p_{\\mathrm{clo}}(t)$ 下的排名是相反的。\n\n**D. 在 $p_{\\mathrm{raw}}(t)$ 下，$G_{B}$ 的排名高于 $G_{A}$；在 $p_{\\mathrm{clo}}(t)$ 下，$G_{A}$ 的排名高于 $G_{B}$。**\n这与我们推导出的结果相反，是不正确的。\n\n因此，选项 A 是唯一正确的陈述。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在根据表型相似性对基因进行评分后，下一步是将这些证据整合到一个正式的诊断概率框架中。本练习将应用贝叶斯定理，利用基于表型的似然（likelihoods）来更新我们对候选基因的先验信念。通过计算后验比（posterior odds），您将实践如何量化比较不同基因作为致病原因的相对可能性，这是将表型分析转化为临床决策的关键一步。",
            "id": "4368540",
            "problem": "在使用人类表型本体 (HPO) 进行孟德尔诊断的表型驱动基因优先排序中，候选基因会根据基因组证据被赋予先验概率，然后使用表型术语通过概率推断来更新这些先验概率。考虑一名仅表现出一种HPO术语（记为 $t_{1}$）的患者。您正在评估两个候选基因 $g_{1}$ 和 $g_{2}$，它们在该患者中作为致病基因的先验概率分别为 $P(g_{1})=0.01$ 和 $P(g_{2})=0.005$。表型术语 $t_{1}$ 具有基因特异性的类似外显率的似然 $P(t_{1}\\mid g_{1})=0.8$ 和 $P(t_{1}\\mid g_{2})=0.4$，这表示携带 $g_{1}$ 或 $g_{2}$ 致病性变异的患者表现出 $t_{1}$ 的概率。\n\n假设证据集为 $\\{t_{1}\\}$，并且所考虑的候选基因在该患者的致病假设中构成一个互斥集合。仅使用概率论的核心定义，以后验概率和似然的形式推导出后验比率 $\\dfrac{P(g_{1}\\mid \\{t_{1}\\})}{P(g_{2}\\mid \\{t_{1}\\})}$，然后根据所提供的值进行计算。以精确数值（无量纲）的形式给出您的最终结果。",
            "solution": "该问题被验证为具有科学依据、提法明确、客观且完整。所有必要数据均已提供，所要求的任务是贝叶斯概率论在基因组诊断领域的标准应用。没有可识别的缺陷。\n\n该问题的核心在于应用贝叶斯定理，根据表型证据更新关于基因致病性的先验信念。我们需要计算在观察到单个表型术语 $t_1$ 的情况下，两个候选基因 $g_1$ 和 $g_2$ 的后验比率。\n\n设 $g_i$ 代表基因 $g_i$ 是患者病情的致病基因这一假设。设 $t_1$ 为观察到的证据。我们已知以下先验概率和似然：\n- $g_1$ 是致病基因的先验概率：$P(g_1) = 0.01$\n- $g_2$ 是致病基因的先验概率：$P(g_2) = 0.005$\n- 在 $g_1$ 是致病基因的条件下观察到 $t_1$ 的似然：$P(t_1 \\mid g_1) = 0.8$\n- 在 $g_2$ 是致病基因的条件下观察到 $t_1$ 的似然：$P(t_1 \\mid g_2) = 0.4$\n\n需要推导的量是后验比率，即两个假设的后验概率之比：$\\dfrac{P(g_1 \\mid t_1)}{P(g_2 \\mid t_1)}$。\n\n贝叶斯定理指出，在给定证据 $E$ 的情况下，假设 $H$ 的后验概率由下式给出：\n$$ P(H \\mid E) = \\frac{P(E \\mid H) P(H)}{P(E)} $$\n其中 $P(H)$ 是假设的先验概率，$P(E \\mid H)$ 是在假设成立条件下证据的似然，而 $P(E)$ 是证据的边缘概率。\n\n将此定理应用于我们的特定假设 $g_1$ 和 $g_2$ 以及证据 $t_1$：\n基因 $g_1$ 的后验概率为：\n$$ P(g_1 \\mid t_1) = \\frac{P(t_1 \\mid g_1) P(g_1)}{P(t_1)} $$\n基因 $g_2$ 的后验概率为：\n$$ P(g_2 \\mid t_1) = \\frac{P(t_1 \\mid g_2) P(g_2)}{P(t_1)} $$\n\n后验比率是这两个表达式的比值：\n$$ \\frac{P(g_1 \\mid t_1)}{P(g_2 \\mid t_1)} = \\frac{\\left( \\frac{P(t_1 \\mid g_1) P(g_1)}{P(t_1)} \\right)}{\\left( \\frac{P(t_1 \\mid g_2) P(g_2)}{P(t_1)} \\right)} $$\n\n项 $P(t_1)$ 代表在所有可能的遗传原因中观察到表型 $t_1$ 的总概率，它同时出现在分子和分母中。因此，它可以被消去。这种消去是处理比率时的一个关键特征，因为它避免了计算通常难以求得的证据的边缘概率。问题陈述基因是互斥的，这是在一个完备的假设集上计算 $P(t_1)$ 所需的条件，但在这里没有必要进行计算。\n\n推导出的后验比率表达式简化为：\n$$ \\frac{P(g_1 \\mid t_1)}{P(g_2 \\mid t_1)} = \\frac{P(t_1 \\mid g_1) P(g_1)}{P(t_1 \\mid g_2) P(g_2)} $$\n这个关系表明，后验比率是先验比率 $\\frac{P(g_1)}{P(g_2)}$ 与似然比（也称为贝叶斯因子） $\\frac{P(t_1 \\mid g_1)}{P(t_1 \\mid g_2)}$ 的乘积。\n\n现在，我们将提供的数值代入这个推导出的公式中，以计算后验比率：\n$$ \\frac{P(g_1 \\mid t_1)}{P(g_2 \\mid t_1)} = \\frac{(0.8) \\times (0.01)}{(0.4) \\times (0.005)} $$\n让我们分别计算分子和分母。\n分子：\n$$ (0.8) \\times (0.01) = 0.008 $$\n分母：\n$$ (0.4) \\times (0.005) = 0.002 $$\n因此，比值为：\n$$ \\frac{0.008}{0.002} = 4 $$\n后验比率等于 $4$。这意味着，在考虑了患者的表型 $t_1$ 之后，基因 $g_1$ 是致病基因的可能性是基因 $g_2$ 的 $4$ 倍。结果是一个无量纲的量。",
            "answer": "$$\\boxed{4}$$"
        }
    ]
}