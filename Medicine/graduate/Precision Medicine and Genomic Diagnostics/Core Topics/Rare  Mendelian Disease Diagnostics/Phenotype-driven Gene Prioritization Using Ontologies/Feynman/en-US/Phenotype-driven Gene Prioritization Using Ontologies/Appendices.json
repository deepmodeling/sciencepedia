{
    "hands_on_practices": [
        {
            "introduction": "At its core, phenotype-driven gene prioritization is an exercise in updating our confidence in different genetic hypotheses based on clinical evidence. This practice grounds you in the fundamental probabilistic reasoning behind this process by applying Bayes' theorem. You will calculate the posterior odds for two candidate genes, a key technique for comparing the relative likelihood of competing hypotheses after observing a patient's phenotype .",
            "id": "4368540",
            "problem": "In phenotype-driven gene prioritization for Mendelian diagnostics using the Human Phenotype Ontology (HPO), gene candidates are assigned prior probabilities based on genomic evidence, and phenotype terms are used to update these priors via probabilistic inference. Consider a single patient presenting with one HPO term, denoted by $t_{1}$. You are evaluating two candidate genes, $g_{1}$ and $g_{2}$, whose prior probabilities of being the causal gene in this patient are $P(g_{1})=0.01$ and $P(g_{2})=0.005$, respectively. The phenotype term $t_{1}$ has gene-specific penetrance-like likelihoods $P(t_{1}\\mid g_{1})=0.8$ and $P(t_{1}\\mid g_{2})=0.4$, representing the probability that a patient carrying a pathogenic variant in $g_{1}$ or $g_{2}$ exhibits $t_{1}$.\n\nAssume that the evidence set is $\\{t_{1}\\}$ and that the candidate genes under consideration form a mutually exclusive set for the causal hypothesis in this patient. Using only core definitions from probability theory, derive the posterior odds $\\frac{P(g_{1}\\mid t_{1})}{P(g_{2}\\mid t_{1})}$ in terms of prior probabilities and likelihoods, and then evaluate it for the provided values. Provide your final value as an exact number (dimensionless).",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. All necessary data are provided, and the requested task is a standard application of Bayesian probability theory to the domain of genomic diagnostics. There are no identifiable flaws.\n\nThe core of this problem lies in the application of Bayes' theorem to update prior beliefs about the causality of genes based on phenotypic evidence. We are asked to compute the posterior odds for two candidate genes, $g_1$ and $g_2$, given the observation of a single phenotype term, $t_1$.\n\nLet $g_i$ represent the hypothesis that gene $g_i$ is the causal gene for the patient's condition. Let $t_1$ be the observed evidence. We are given the following prior probabilities and likelihoods:\n- Prior probability of $g_1$ being causal: $P(g_1) = 0.01$\n- Prior probability of $g_2$ being causal: $P(g_2) = 0.005$\n- Likelihood of observing $t_1$ given $g_1$ is causal: $P(t_1 \\mid g_1) = 0.8$\n- Likelihood of observing $t_1$ given $g_2$ is causal: $P(t_1 \\mid g_2) = 0.4$\n\nThe quantity to be derived is the posterior odds, which is the ratio of the posterior probabilities of the two hypotheses: $\\frac{P(g_1 \\mid t_1)}{P(g_2 \\mid t_1)}$.\n\nBayes' theorem states that the posterior probability of a hypothesis $H$ given evidence $E$ is given by:\n$$ P(H \\mid E) = \\frac{P(E \\mid H) P(H)}{P(E)} $$\nwhere $P(H)$ is the prior probability of the hypothesis, $P(E \\mid H)$ is the likelihood of the evidence given the hypothesis, and $P(E)$ is the marginal probability of the evidence.\n\nApplying this theorem to our specific hypotheses, $g_1$ and $g_2$, and the evidence $t_1$:\nThe posterior probability for gene $g_1$ is:\n$$ P(g_1 \\mid t_1) = \\frac{P(t_1 \\mid g_1) P(g_1)}{P(t_1)} $$\nThe posterior probability for gene $g_2$ is:\n$$ P(g_2 \\mid t_1) = \\frac{P(t_1 \\mid g_2) P(g_2)}{P(t_1)} $$\n\nThe posterior odds is the ratio of these two expressions:\n$$ \\frac{P(g_1 \\mid t_1)}{P(g_2 \\mid t_1)} = \\frac{\\left( \\frac{P(t_1 \\mid g_1) P(g_1)}{P(t_1)} \\right)}{\\left( \\frac{P(t_1 \\mid g_2) P(g_2)}{P(t_1)} \\right)} $$\n\nThe term $P(t_1)$, which represents the overall probability of observing the phenotype $t_1$ across all possible genetic causes, appears in both the numerator and the denominator. As such, it cancels out. This cancellation is a crucial feature of working with odds, as it removes the need to calculate the often-difficult marginal probability of the evidence. The problem states that the genes are mutually exclusive, a condition that would be required to compute $P(t_1)$ over a complete set of hypotheses, but its calculation is not necessary here.\n\nThe derived expression for the posterior odds simplifies to:\n$$ \\frac{P(g_1 \\mid t_1)}{P(g_2 \\mid t_1)} = \\frac{P(t_1 \\mid g_1) P(g_1)}{P(t_1 \\mid g_2) P(g_2)} $$\nThis relationship shows that the posterior odds are the product of the prior odds, $\\frac{P(g_1)}{P(g_2)}$, and the likelihood ratio (also known as the Bayes factor), $\\frac{P(t_1 \\mid g_1)}{P(t_1 \\mid g_2)}$.\n\nNow, we substitute the provided numerical values into this derived formula to evaluate the posterior odds:\n$$ \\frac{P(g_1 \\mid t_1)}{P(g_2 \\mid t_1)} = \\frac{(0.8) \\times (0.01)}{(0.4) \\times (0.005)} $$\nLet us compute the numerator and denominator separately.\nNumerator:\n$$ (0.8) \\times (0.01) = 0.008 $$\nDenominator:\n$$ (0.4) \\times (0.005) = 0.002 $$\nThe ratio is therefore:\n$$ \\frac{0.008}{0.002} = 4 $$\nThe posterior odds are equal to $4$. This implies that after accounting for the patient's phenotype $t_1$, gene $g_1$ is $4$ times more likely to be the causal gene than gene $g_2$. The result is a dimensionless quantity.",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "While a Bayesian framework tells us how to use evidence, we need a way to quantify the \"strength\" of that evidence, specifically the similarity between a patient's phenotype and a gene's known associations. This exercise explores how to derive a semantic similarity measure from first principles using the concept of Information Content ($IC$) and the Lowest Common Ancestor ($LCA$) in an ontology. By deriving and applying a measure like Lin's similarity, you will understand how abstract ontological relationships are translated into meaningful quantitative scores .",
            "id": "4368586",
            "problem": "In phenotype-driven gene prioritization, Human Phenotype Ontology (HPO) terms are used to quantify phenotypic similarity between a patient and candidate genes. Let a term be denoted by $t$, and define its information content as $IC(t) := -\\ln p(t)$, where $p(t)$ is the empirical probability of observing $t$ under annotation propagation along the ontology’s subsumption hierarchy (the “true path rule”). For two HPO terms $t_1$ and $t_2$, write $LCA(t_1,t_2)$ for their lowest common ancestor in the ontology’s directed acyclic graph, and let $IC(LCA)$ denote the information content of this ancestor.\n\nTask A (derivation): Starting from the following fundamental base:\n- the Shannon self-information definition $IC(t) = -\\ln p(t)$,\n- the true path rule for ontologies ensuring that annotations propagate to ancestors, and\n- the design principle that a semantic similarity should be a symmetric, scale-free function of the “shared information” and the individual information contents, bounded in $[0,1]$, and equal to $1$ if and only if $t_1=t_2$,\n\nderive a closed-form expression for a symmetric similarity $s(t_1,t_2)$ that depends only on $IC(t_1)$, $IC(t_2)$, and $IC(LCA)$, where the “shared information” between $t_1$ and $t_2$ is taken to be $IC(LCA)$ (the information content of their most informative common ancestor). Your derivation must justify the choice of normalization from first principles and produce a single explicit formula for $s(t_1,t_2)$.\n\nTask B (evaluation): For $IC(t_1)=7$, $IC(t_2)=4$, and $IC(LCA)=3$, compute the similarity $s(t_1,t_2)$. Express your final numerical result as an exact reduced fraction. No units are required.",
            "solution": "The problem is divided into two tasks: (A) deriving a closed-form expression for a semantic similarity measure $s(t_1, t_2)$ based on a set of axiomatic constraints, and (B) evaluating this measure for a given set of information content values.\n\n### Task A: Derivation of the Similarity Measure\n\nThe objective is to derive a closed-form expression for a symmetric similarity measure $s(t_1, t_2)$ between two ontology terms $t_1$ and $t_2$. The derivation must be based on first principles and adhere to the specified constraints.\n\nThe fundamental principles and constraints are:\n1.  The similarity $s(t_1, t_2)$ is a function of the information contents $IC(t_1)$, $IC(t_2)$, and $IC(LCA)$, where $LCA$ is the lowest common ancestor of $t_1$ and $t_2$.\n2.  The information content of a term $t$ is $IC(t) = -\\ln p(t)$, where $p(t)$ is its probability.\n3.  The shared information between $t_1$ and $t_2$ is defined as the information content of their lowest common ancestor, $IC(LCA(t_1, t_2))$.\n4.  The similarity measure must satisfy the following properties:\n    a. Symmetry: $s(t_1, t_2) = s(t_2, t_1)$.\n    b. Boundedness: $0 \\le s(t_1, t_2) \\le 1$.\n    c. Identity: $s(t_1, t_2) = 1$ if and only if $t_1 = t_2$.\n\nA widely adopted approach for constructing a similarity measure is to define it as a normalized ratio of the information shared by two entities to the total information they represent.\n\nLet us define the shared information, as specified, as $I_{shared} = IC(LCA(t_1, t_2))$.\nLet us represent the total information content of the individual terms, $t_1$ and $t_2$, by the sum of their individual information contents: $I_{total} = IC(t_1) + IC(t_2)$.\n\nBased on this principle, a preliminary form of the similarity measure could be a ratio of the shared information to the total information. However, such a simple ratio must be correctly normalized to satisfy the identity property. Let's formulate the similarity measure with a normalization constant $C$:\n$$s(t_1, t_2) = C \\cdot \\frac{I_{shared}}{I_{total}} = C \\cdot \\frac{IC(LCA(t_1, t_2))}{IC(t_1) + IC(t_2)}$$\n\nWe determine the normalization constant $C$ by applying the identity property (4c): $s(t, t) = 1$.\nIf $t_1 = t_2 = t$, then the lowest common ancestor of a term with itself is the term itself, i.e., $LCA(t, t) = t$.\nConsequently, $IC(LCA(t, t)) = IC(t)$.\n\nSubstituting these into the similarity formula, we get:\n$$s(t, t) = C \\cdot \\frac{IC(t)}{IC(t) + IC(t)} = C \\cdot \\frac{IC(t)}{2 \\cdot IC(t)}$$\nFor any term $t$ with non-zero information content (i.e., $p(t) < 1$), this simplifies to:\n$$s(t, t) = C \\cdot \\frac{1}{2}$$\nTo satisfy the identity condition $s(t, t) = 1$, we must have:\n$$C \\cdot \\frac{1}{2} = 1 \\implies C = 2$$\n\nThis justifies the choice of the normalization constant. The derived closed-form expression for the similarity measure is therefore:\n$$s(t_1, t_2) = \\frac{2 \\cdot IC(LCA(t_1, t_2))}{IC(t_1) + IC(t_2)}$$\nThis is commonly known as Lin's similarity measure.\n\nWe must verify that this expression satisfies all the stated properties:\n- **Symmetry**: The $LCA$ operator is symmetric, i.e., $LCA(t_1, t_2) = LCA(t_2, t_1)$, and addition is commutative. Thus, $s(t_1, t_2) = \\frac{2 \\cdot IC(LCA(t_1, t_2))}{IC(t_1) + IC(t_2)} = \\frac{2 \\cdot IC(LCA(t_2, t_1))}{IC(t_2) + IC(t_1)} = s(t_2, t_1)$. The property holds.\n- **Boundedness**: Information content $IC(t) = -\\ln p(t)$ is always non-negative, since $p(t) \\in (0, 1]$. Thus, $s(t_1, t_2) \\ge 0$. The \"true path rule\" implies that if a concept $t_1$ exists, all its ancestors, including $LCA(t_1, t_2)$, must also exist in its annotation path. This means a child term is at least as specific as its parent, so $p(t_1) \\le p(LCA(t_1, t_2))$ and $p(t_2) \\le p(LCA(t_1, t_2))$. Taking $-\\ln$ of these inequalities reverses their direction: $IC(t_1) \\ge IC(LCA(t_1, t_2))$ and $IC(t_2) \\ge IC(LCA(t_1, t_2))$. Summing these gives $IC(t_1) + IC(t_2) \\ge 2 \\cdot IC(LCA(t_1, t_2))$. Therefore, $s(t_1, t_2) = \\frac{2 \\cdot IC(LCA(t_1, t_2))}{IC(t_1) + IC(t_2)} \\le 1$. The property $0 \\le s(t_1, t_2) \\le 1$ holds.\n- **Identity**: By construction, $s(t, t) = 1$. Conversely, if $s(t_1, t_2) = 1$, then $2 \\cdot IC(LCA) = IC(t_1) + IC(t_2)$. Since we know $IC(t_1) \\ge IC(LCA)$ and $IC(t_2) \\ge IC(LCA)$, this equality can only hold if $IC(t_1) = IC(LCA)$ and $IC(t_2) = IC(LCA)$. Within a standard ontology where child terms are strictly more specific than their parents, this implies that $t_1$ and $t_2$ are not descendants of $LCA$ but are the same node as $LCA$, which in turn means $t_1 = t_2 = LCA$. The property holds.\n- **Scale-free**: The measure is a ratio of terms with the same units (bits or nats of information), making it a dimensionless, scale-free quantity.\n\nThe derived formula satisfies all conditions.\n\n### Task B: Evaluation of the Similarity Measure\n\nGiven the numerical values:\n- $IC(t_1) = 7$\n- $IC(t_2) = 4$\n- $IC(LCA) = 3$\n\nFirst, we check for consistency with the ontology structure. We must have $IC(t_1) \\ge IC(LCA)$ and $IC(t_2) \\ge IC(LCA)$. Indeed, $7 \\ge 3$ and $4 \\ge 3$, so the values are consistent.\n\nWe now use the derived formula to compute the similarity $s(t_1, t_2)$:\n$$s(t_1, t_2) = \\frac{2 \\cdot IC(LCA)}{IC(t_1) + IC(t_2)}$$\nSubstituting the given values:\n$$s(t_1, t_2) = \\frac{2 \\cdot 3}{7 + 4}$$\n$$s(t_1, t_2) = \\frac{6}{11}$$\nThe numbers $6$ and $11$ are coprime, so the fraction is already in its reduced form.",
            "answer": "$$\\boxed{\\frac{6}{11}}$$"
        },
        {
            "introduction": "The semantic similarity scores we use are only as reliable as the Information Content ($IC$) values they are built upon. This practice reveals a critical and common pitfall in calculating $IC$ by contrasting a naive frequency count with a method that respects the ontology's hierarchical \"true path rule.\" By working through this constructed scenario, you will see how an incorrect probability model can lead to inverted, counter-intuitive gene rankings, underscoring the necessity of proper ontological inference .",
            "id": "4368546",
            "problem": "In phenotype-driven gene prioritization using the Human Phenotype Ontology (HPO), the ontology is a directed acyclic graph with an “is-a” hierarchy that obeys the true path rule: if a gene is annotated to a term $t$, it is implicitly annotated to all ancestors of $t$. Consider a background corpus of $N=1000$ genes with direct term annotations forming the following small ontology fragment: a root has two children $t_{1}$ and $t_{2}$; $t_{1}$ has children $t_{1a}$ and $t_{1b}$; $t_{2}$ has child $t_{2a}$. The directly assigned annotations in the corpus are:\n- $300$ genes directly annotated to $t_{1a}$,\n- $300$ genes directly annotated to $t_{1b}$,\n- $5$ genes directly annotated to $t_{1}$,\n- $10$ genes directly annotated to $t_{2a}$,\n- $0$ genes directly annotated to $t_{2}$ or to any other term in this fragment.\n\nYou must compare two background term probability estimates for a term $t$, denoted $p(t)$:\n- Raw term frequency: $p_{\\mathrm{raw}}(t)$ equals the fraction of genes directly annotated to $t$.\n- Term frequency plus descendants (true-path closure): $p_{\\mathrm{clo}}(t)$ equals the fraction of genes annotated to $t$ or to any descendant of $t$.\n\nAssume a patient with a single HPO query term $Q=\\{t_{1a}\\}$. Two candidate genes are given:\n- Gene $G_{A}$ is directly annotated to $t_{1}$.\n- Gene $G_{B}$ is directly annotated to $t_{1a}$.\n\nDefine the similarity between $Q$ and a candidate gene $g$ by summing, over query terms, the Information Content (IC) of the Most Informative Common Ancestor (MICA) of the query term and the gene’s annotation, where IC is defined as $\\mathrm{IC}(t)=-\\ln p(t)$ using the natural logarithm, and $\\mathrm{MICA}(q,a)$ is the ancestor shared by $q$ and $a$ with the largest IC under the chosen $p(t)$. For this setup, the similarity score for $g$ reduces to $\\mathrm{IC}(\\mathrm{MICA}(t_{1a},a_{g}))$, where $a_{g}$ is the single annotation of $g$.\n\nUsing the corpus above, compute the scores under $p_{\\mathrm{raw}}(t)$ and $p_{\\mathrm{clo}}(t)$ and determine the induced ranking between $G_{A}$ and $G_{B}$ under each $p(t)$ definition. Which option is correct?\n\nA. Under $p_{\\mathrm{raw}}(t)$, $G_{A}$ ranks above $G_{B}$; under $p_{\\mathrm{clo}}(t)$, $G_{B}$ ranks above $G_{A}$.\n\nB. Under both $p_{\\mathrm{raw}}(t)$ and $p_{\\mathrm{clo}}(t)$, $G_{B}$ ranks above $G_{A}$.\n\nC. Under both $p_{\\mathrm{raw}}(t)$ and $p_{\\mathrm{clo}}(t)$, $G_{A}$ ranks above $G_{B}$.\n\nD. Under $p_{\\mathrm{raw}}(t)$, $G_{B}$ ranks above $G_{A}$; under $p_{\\mathrm{clo}}(t)$, $G_{A}$ ranks above $G_{B}$.",
            "solution": "The user has provided a computational problem in bioinformatics requiring the prioritization of genes based on phenotypic similarity using the Human Phenotype Ontology (HPO). I will first validate the problem statement and then proceed to a full derivation and evaluation of the options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Ontology:** A directed acyclic graph (DAG) with an \"is-a\" hierarchy.\n-   **True Path Rule:** If a gene is annotated to a term $t$, it is implicitly annotated to all ancestors of $t$.\n-   **Corpus Size:** $N=1000$ genes.\n-   **Ontology Fragment:** A root term has children $t_1$ and $t_2$. $t_1$ has children $t_{1a}$ and $t_{1b}$. $t_2$ has child $t_{2a}$.\n-   **Direct Annotation Counts:**\n    -   $n_{\\mathrm{direct}}(t_{1a}) = 300$\n    -   $n_{\\mathrm{direct}}(t_{1b}) = 300$\n    -   $n_{\\mathrm{direct}}(t_1) = 5$\n    -   $n_{\\mathrm{direct}}(t_{2a}) = 10$\n    -   $n_{\\mathrm{direct}}(t_2) = 0$\n    -   $0$ genes directly annotated to any other term in this fragment.\n-   **Probability Definitions:**\n    -   Raw term frequency: $p_{\\mathrm{raw}}(t) = n_{\\mathrm{direct}}(t) / N$.\n    -   Term frequency plus descendants (closure): $p_{\\mathrm{clo}}(t) = n_{\\mathrm{clo}}(t) / N$, where $n_{\\mathrm{clo}}(t)$ is the count of genes annotated to $t$ or any descendant of $t$.\n-   **Patient Query:** $Q = \\{t_{1a}\\}$.\n-   **Candidate Genes:**\n    -   $G_A$ is directly annotated to $a_A = t_1$.\n    -   $G_B$ is directly annotated to $a_B = t_{1a}$.\n-   **Similarity Score:**\n    -   Information Content (IC): $\\mathrm{IC}(t) = -\\ln p(t)$.\n    -   Most Informative Common Ancestor (MICA): $\\mathrm{MICA}(q,a)$ is the common ancestor of $q$ and $a$ with the largest IC.\n    -   Score for a gene $g$: $\\mathrm{Score}(g) = \\mathrm{IC}(\\mathrm{MICA}(t_{1a}, a_g))$. A higher score corresponds to a higher rank.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem uses standard, well-established concepts from bioinformatics for phenotype-driven gene prioritization, including HPO, the true path rule, Information Content (IC), and Most Informative Common Ancestor (MICA). These are fundamental to semantic similarity measures.\n-   **Well-Posed:** All necessary data and definitions are provided to compute the required scores and determine the rankings. The total count of directly annotated genes is $300+300+5+10 = 615$, which is less than the total corpus size of $N=1000$. This is realistic, as not all genes in a background set are necessarily annotated. The setup is self-contained and consistent.\n-   **Objective:** The problem is stated in precise, quantitative terms, free from subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is scientifically sound, well-posed, and objective. I will now proceed with the solution.\n\n### Derivation of the Solution\n\nThe task is to compute the similarity scores for genes $G_A$ and $G_B$ relative to the query term $t_{1a}$ under two different probability models, $p_{\\mathrm{raw}}(t)$ and $p_{\\mathrm{clo}}(t)$, and determine the resulting ranking.\n\nThe score for a gene $g$ with annotation $a_g$ is given by $\\mathrm{Score}(g) = \\mathrm{IC}(\\mathrm{MICA}(t_{1a}, a_g))$.\n-   For gene $G_A$, the annotation is $a_A = t_1$. The score is $\\mathrm{Score}(G_A) = \\mathrm{IC}(\\mathrm{MICA}(t_{1a}, t_1))$.\n-   For gene $G_B$, the annotation is $a_B = t_{1a}$. The score is $\\mathrm{Score}(G_B) = \\mathrm{IC}(\\mathrm{MICA}(t_{1a}, t_{1a}))$.\n\nLet's analyze each probability model separately.\n\n**1. Analysis under Raw Term Frequency, $p_{\\mathrm{raw}}(t)$**\n\nFirst, we calculate the probabilities and the corresponding Information Content (IC) values for the relevant terms. The total number of genes is $N=1000$.\n-   $p_{\\mathrm{raw}}(t_{1a}) = \\frac{n_{\\mathrm{direct}}(t_{1a})}{N} = \\frac{300}{1000} = 0.3$.\n-   $p_{\\mathrm{raw}}(t_1) = \\frac{n_{\\mathrm{direct}}(t_1)}{N} = \\frac{5}{1000} = 0.005$.\n\nThe IC values are:\n-   $\\mathrm{IC}_{\\mathrm{raw}}(t_{1a}) = -\\ln(0.3) \\approx 1.204$.\n-   $\\mathrm{IC}_{\\mathrm{raw}}(t_1) = -\\ln(0.005) \\approx 5.298$.\n\nAn important observation is that $\\mathrm{IC}_{\\mathrm{raw}}(t_1) > \\mathrm{IC}_{\\mathrm{raw}}(t_{1a})$, even though $t_1$ is an ancestor of $t_{1a}$. This inversion of informativeness is a known artifact of using raw direct-annotation frequencies.\n\nNow we compute the scores for $G_A$ and $G_B$:\n\n**Score for $G_A$:**\n-   We need to find $\\mathrm{MICA}(t_{1a}, t_1)$. The set of common ancestors of $t_{1a}$ and $t_1$ (inclusive of the terms themselves) is $\\{t_1, \\text{Root}\\}$.\n-   The problem does not specify the number of direct annotations for the root, and it is standard to assume $n_{\\mathrm{direct}}(\\text{Root}) = 0$. This would make $p_{\\mathrm{raw}}(\\text{Root}) = 0$ and $\\mathrm{IC}_{\\mathrm{raw}}(\\text{Root}) = \\infty$. In practice, such terms are excluded from MICA consideration, or a floor probability is used. We will consider only ancestors with finite IC.\n-   The only common ancestor with a non-zero probability is $t_1$. Thus, $\\mathrm{MICA}_{\\mathrm{raw}}(t_{1a}, t_1) = t_1$.\n-   $\\mathrm{Score}_{\\mathrm{raw}}(G_A) = \\mathrm{IC}_{\\mathrm{raw}}(\\mathrm{MICA}_{\\mathrm{raw}}(t_{1a}, t_1)) = \\mathrm{IC}_{\\mathrm{raw}}(t_1) = -\\ln(0.005) \\approx 5.298$.\n\n**Score for $G_B$:**\n-   We need to find $\\mathrm{MICA}(t_{1a}, t_{1a})$. The problem definition of MICA is \"the ancestor shared by $q$ and $a$ with the largest IC\".\n-   If we apply this definition literally, the set of common ancestors of $t_{1a}$ with itself is $\\{t_{1a}, t_1, \\text{Root}\\}$. The ICs are $\\mathrm{IC}_{\\mathrm{raw}}(t_{1a}) \\approx 1.204$ and $\\mathrm{IC}_{\\mathrm{raw}}(t_1) \\approx 5.298$. Due to the IC inversion, the MICA would be $t_1$, not $t_{1a}$, leading to the same score as $G_A$. This is counter-intuitive; a perfect match should be maximally similar.\n-   The standard convention for semantic similarity is that the similarity of a term with itself is its own information content, which implies that $\\mathrm{MICA}(t, t) = t$. We adopt this standard interpretation, as it resolves the ambiguity and is the only path that allows for a strict ranking as implied by the options.\n-   Therefore, $\\mathrm{MICA}_{\\mathrm{raw}}(t_{1a}, t_{1a}) = t_{1a}$.\n-   $\\mathrm{Score}_{\\mathrm{raw}}(G_B) = \\mathrm{IC}_{\\mathrm{raw}}(t_{1a}) = -\\ln(0.3) \\approx 1.204$.\n\n**Ranking under $p_{\\mathrm{raw}}(t)$:**\n-   $\\mathrm{Score}_{\\mathrm{raw}}(G_A) \\approx 5.298$.\n-   $\\mathrm{Score}_{\\mathrm{raw}}(G_B) \\approx 1.204$.\n-   Since $\\mathrm{Score}_{\\mathrm{raw}}(G_A) > \\mathrm{Score}_{\\mathrm{raw}}(G_B)$, $G_A$ ranks above $G_B$.\n\n**2. Analysis under Closure Term Frequency, $p_{\\mathrm{clo}}(t)$**\n\nFirst, we calculate the propagated gene counts, $n_{\\mathrm{clo}}(t)$, by summing direct annotations at a term and all its descendants according to the true path rule.\n-   $n_{\\mathrm{clo}}(t_{1a}) = n_{\\mathrm{direct}}(t_{1a}) = 300$.\n-   $n_{\\mathrm{clo}}(t_1) = n_{\\mathrm{direct}}(t_1) + n_{\\mathrm{direct}}(t_{1a}) + n_{\\mathrm{direct}}(t_{1b}) = 5 + 300 + 300 = 605$.\n-   (For completeness, other terms: $n_{\\mathrm{clo}}(t_{1b}) = 300$; $n_{\\mathrm{clo}}(t_{2a})=10$; $n_{\\mathrm{clo}}(t_2)=10$; $n_{\\mathrm{clo}}(\\text{Root})=615$).\n\nNow, calculate the probabilities $p_{\\mathrm{clo}}(t)$ and ICs.\n-   $p_{\\mathrm{clo}}(t_{1a}) = \\frac{300}{1000} = 0.3$.\n-   $p_{\\mathrm{clo}}(t_1) = \\frac{605}{1000} = 0.605$.\n\nThe IC values are:\n-   $\\mathrm{IC}_{\\mathrm{clo}}(t_{1a}) = -\\ln(0.3) \\approx 1.204$.\n-   $\\mathrm{IC}_{\\mathrm{clo}}(t_1) = -\\ln(0.605) \\approx 0.5025$.\n\nUsing the closure frequency restores the expected monotonicity of IC: $p_{\\mathrm{clo}}(t_{1a}) < p_{\\mathrm{clo}}(t_1)$, so $\\mathrm{IC}_{\\mathrm{clo}}(t_{1a}) > \\mathrm{IC}_{\\mathrm{clo}}(t_1)$. The child term is more informative than its parent.\n\nNow we compute the scores for $G_A$ and $G_B$:\n\n**Score for $G_A$:**\n-   We need $\\mathrm{MICA}(t_{1a}, t_1)$. The common ancestors are $\\{t_1, \\text{Root}\\}$.\n-   $\\mathrm{IC}_{\\mathrm{clo}}(t_1) \\approx 0.5025$. The IC of the root would be even lower, as its probability is higher.\n-   $\\mathrm{MICA}_{\\mathrm{clo}}(t_{1a}, t_1) = t_1$.\n-   $\\mathrm{Score}_{\\mathrm{clo}}(G_A) = \\mathrm{IC}_{\\mathrm{clo}}(t_1) = -\\ln(0.605) \\approx 0.5025$.\n\n**Score for $G_B$:**\n-   We need $\\mathrm{MICA}(t_{1a}, t_{1a})$. The common ancestors are $\\{t_{1a}, t_1, \\text{Root}\\}$.\n-   The ICs are $\\mathrm{IC}_{\\mathrm{clo}}(t_{1a}) \\approx 1.204$ and $\\mathrm{IC}_{\\mathrm{clo}}(t_1) \\approx 0.5025$.\n-   The MICA is the one with the largest IC, which is $t_{1a}$. $\\mathrm{MICA}_{\\mathrm{clo}}(t_{1a}, t_{1a}) = t_{1a}$.\n-   $\\mathrm{Score}_{\\mathrm{clo}}(G_B) = \\mathrm{IC}_{\\mathrm{clo}}(t_{1a}) = -\\ln(0.3) \\approx 1.204$.\n\n**Ranking under $p_{\\mathrm{clo}}(t)$:**\n-   $\\mathrm{Score}_{\\mathrm{clo}}(G_A) \\approx 0.5025$.\n-   $\\mathrm{Score}_{\\mathrm{clo}}(G_B) \\approx 1.204$.\n-   Since $\\mathrm{Score}_{\\mathrm{clo}}(G_B) > \\mathrm{Score}_{\\mathrm{clo}}(G_A)$, $G_B$ ranks above $G_A$.\n\n### Summary and Option Evaluation\n\n-   Under $p_{\\mathrm{raw}}(t)$, $G_A$ ranks above $G_B$.\n-   Under $p_{\\mathrm{clo}}(t)$, $G_B$ ranks above $G_A$.\n\nThis demonstrates how the choice of background probability model, particularly its handling of the ontology structure, critically impacts gene prioritization. The raw frequency model can produce counter-intuitive results due to IC inversion, while the closure model respects the specificity hierarchy of the ontology.\n\nNow, we evaluate the provided options:\n\n**A. Under $p_{\\mathrm{raw}}(t)$, $G_{A}$ ranks above $G_{B}$; under $p_{\\mathrm{clo}}(t)$, $G_{B}$ ranks above $G_{A}$.**\nThis matches our derived result.\n\n**B. Under both $p_{\\mathrm{raw}}(t)$ and $p_{\\mathrm{clo}}(t)$, $G_{B}$ ranks above $G_{A}$.**\nThis is incorrect. The ranking under $p_{\\mathrm{raw}}(t)$ is the opposite.\n\n**C. Under both $p_{\\mathrm{raw}}(t)$ and $p_{\\mathrm{clo}}(t)$, $G_{A}$ ranks above $G_{B}$.**\nThis is incorrect. The ranking under $p_{\\mathrm{clo}}(t)$ is the opposite.\n\n**D. Under $p_{\\mathrm{raw}}(t)$, $G_{B}$ ranks above $G_{A}$; under $p_{\\mathrm{clo}}(t)$, $G_{A}$ ranks above $G_{B}$.**\nThis is the reverse of our derived result and is incorrect.\n\nTherefore, option A is the only correct statement.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}