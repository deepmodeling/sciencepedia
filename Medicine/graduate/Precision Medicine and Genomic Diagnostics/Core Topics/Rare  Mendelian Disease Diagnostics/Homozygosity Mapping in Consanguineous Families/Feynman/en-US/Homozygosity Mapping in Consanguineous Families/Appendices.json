{
    "hands_on_practices": [
        {
            "introduction": "The foundation of homozygosity mapping is the inbreeding coefficient, $F$, which quantifies the expected proportion of an individual's genome that is autozygous. This exercise will guide you through deriving the general formula for $F$ from first principles, a classic method known as Wright's path analysis. By applying this formula to specific pedigrees, you will gain a deep, quantitative understanding of how different degrees of consanguinity translate into distinct probabilities of inheriting alleles that are identical by descent. ",
            "id": "4350488",
            "problem": "In precision medicine and genomic diagnostics, homozygosity mapping leverages expected autozygosity to localize recessive disease loci in consanguineous pedigrees. The inbreeding coefficient ($F$) of an individual is defined as the probability that the two alleles at a randomly chosen autosomal locus in that individual are identical by descent (IBD). Using only the core definitions of Mendelian transmission probabilities across meioses, the definition of IBD, and the principle that independent ancestral paths are summed while mutually exclusive transmissions are added, derive a general expression for the inbreeding coefficient $F$ of the offspring of a mating between two related but otherwise outbred parents in terms of paths from each parent to their shared ancestors. Your derivation should begin from first principles and arrive at a sum over all shared ancestors that depends on the number of meioses along each path and the inbreeding of the shared ancestor.\n\nThen, under the following assumptions, apply your general expression to compute the exact values of $F$ for offspring from:\n- an avuncular (uncle–niece) union, and\n- a second-cousin union.\n\nAssumptions:\n- All founders are non-inbred and mutually unrelated, i.e., any common ancestor outside the stated relationship has inbreeding coefficient $F_{A}=0$ and there are no additional shared ancestors beyond the specified relationship.\n- Transmission is autosomal with no selection, mutation, or segregation distortion.\n- The pedigree contains no loops other than those implied by the stated relationship, and sexes of ancestors do not affect the transmission probabilities.\n\nFor clarity, interpret the relationships as follows:\n- In an avuncular union, one parent is the sibling of the other parent’s parent; the two mating individuals share exactly two common ancestors (that parental pair).\n- In a second-cousin union, the two mating individuals share exactly two common ancestors (their great-grandparental pair).\n\nAfter deriving the general expression and calculating the two $F$ values under these assumptions, provide as your final numerical answer the ratio\n$$\n\\frac{F_{\\text{avuncular}}}{F_{\\text{second-cousin}}}.\n$$\nGive the exact value with no rounding. No units are required.",
            "solution": "The problem requires the derivation of a general expression for the inbreeding coefficient, $F$, and its application to two specific consanguineous unions to find the ratio of their respective inbreeding coefficients. The derivation will proceed from the first principles of Mendelian genetics and the definition of identity by descent (IBD).\n\n**Step 1: Derivation of the General Expression for the Inbreeding Coefficient ($F$)**\n\nThe inbreeding coefficient, $F$, of an individual, $I$, is the probability that the two alleles at any given autosomal locus are identical by descent. Let the parents of $I$ be the sire, $S$, and the dam, $D$. Individual $I$ receives a gamete from $S$ containing allele $g_S$ and a gamete from $D$ containing allele $g_D$. By definition, the inbreeding coefficient of $I$ is $F_I = P(g_S \\equiv g_D)$, where $\\equiv$ denotes IBD.\n\nThe alleles $g_S$ and $g_D$ can be IBD only if they are copies of a single allele from a common ancestor of both $S$ and $D$. Let us consider a single common ancestor, $A$, of $S$ and $D$. Let the two alleles of ancestor $A$ at the locus be $\\alpha_1$ and $\\alpha_2$.\n\nLet $n_S$ be the number of meiotic divisions in the line of descent from $A$ to $S$.\nLet $n_D$ be the number of meiotic divisions in the line of descent from $A$ to $D$.\n\nAt each meiosis, the probability that a specific parental allele is transmitted to the offspring is $\\frac{1}{2}$. The transmissions along different meiotic paths are independent events.\n\nThe allele $g_S$ in the gamete from $S$ is a copy of a specific allele of $A$, say $\\alpha_1$, with a probability of $(\\frac{1}{2})^{n_S+1}$. This is because there are $n_S$ meioses from $A$ to $S$, and one more meiosis from $S$ to form the gamete $g_S$.\nSimilarly, the probability that the allele $g_D$ from $D$ is a copy of $\\alpha_1$ is $(\\frac{1}{2})^{n_D+1}$.\n\nThe contribution to $F_I$ from the path through ancestor $A$ is the total probability that $g_S$ and $g_D$ are IBD through $A$. We can use the law of total probability, conditioning on whether ancestor $A$ is itself inbred. Let $F_A$ be the inbreeding coefficient of $A$, which is the probability $P(\\alpha_1 \\equiv \\alpha_2)$.\n\nThe contribution from ancestor $A$, which we can denote $C_A$, is:\n$$C_A = P(g_S \\equiv g_D \\text{ via } A) = P(g_S \\equiv g_D | \\alpha_1 \\equiv \\alpha_2)F_A + P(g_S \\equiv g_D | \\alpha_1 \\not\\equiv \\alpha_2)(1-F_A)$$\n\nCase 1: The ancestor $A$ is not inbred ($F_A=0$, so $\\alpha_1 \\not\\equiv \\alpha_2$).\nIn this case, $g_S$ and $g_D$ can be IBD only if they are copies of the *same* allele from $A$. The two mutually exclusive events are:\n1. Both $g_S$ and $g_D$ are copies of $\\alpha_1$. The probability is $P(g_S \\text{ from } \\alpha_1) \\times P(g_D \\text{ from } \\alpha_1) = (\\frac{1}{2})^{n_S+1} \\times (\\frac{1}{2})^{n_D+1} = (\\frac{1}{2})^{n_S+n_D+2}$.\n2. Both $g_S$ and $g_D$ are copies of $\\alpha_2$. The probability is likewise $(\\frac{1}{2})^{n_S+n_D+2}$.\n\nSo, $P(g_S \\equiv g_D | \\alpha_1 \\not\\equiv \\alpha_2) = (\\frac{1}{2})^{n_S+n_D+2} + (\\frac{1}{2})^{n_S+n_D+2} = 2 \\times (\\frac{1}{2})^{n_S+n_D+2} = (\\frac{1}{2})^{n_S+n_D+1}$.\n\nCase 2: The ancestor $A$ is inbred ($F_A > 0$, so $\\alpha_1$ and $\\alpha_2$ are IBD with probability $F_A$).\nIf $\\alpha_1 \\equiv \\alpha_2$, then any allele descended from $\\alpha_1$ is IBD with any allele descended from $\\alpha_2$. The alleles $g_S$ and $g_D$ will be IBD if they both descend from an allele in $A$. The possible origins for the pair $(g_S, g_D)$ from the alleles of $A$, $(\\alpha_1, \\alpha_2)$, are: $(\\alpha_1, \\alpha_1)$, $(\\alpha_1, \\alpha_2)$, $(\\alpha_2, \\alpha_1)$, and $(\\alpha_2, \\alpha_2)$. Each of these combinations has a probability of $(\\frac{1}{2})^{n_S+n_D+2}$. Since all these combinations lead to IBD when $\\alpha_1 \\equiv \\alpha_2$, we sum their probabilities:\n$P(g_S \\equiv g_D | \\alpha_1 \\equiv \\alpha_2) = 4 \\times (\\frac{1}{2})^{n_S+n_D+2} = (\\frac{1}{2})^{n_S+n_D}$.\n\nSubstituting these results into the expression for $C_A$:\n$$C_A = (\\frac{1}{2})^{n_S+n_D} F_A + (\\frac{1}{2})^{n_S+n_D+1} (1-F_A)$$\n$$C_A = (\\frac{1}{2})^{n_S+n_D} F_A + (\\frac{1}{2})^{n_S+n_D+1} - (\\frac{1}{2})^{n_S+n_D+1} F_A$$\n$$C_A = (\\frac{1}{2})^{n_S+n_D+1} + \\left( (\\frac{1}{2})^{n_S+n_D} - (\\frac{1}{2})^{n_S+n_D+1} \\right) F_A$$\n$$C_A = (\\frac{1}{2})^{n_S+n_D+1} + \\left( 2 \\cdot (\\frac{1}{2})^{n_S+n_D+1} - (\\frac{1}{2})^{n_S+n_D+1} \\right) F_A$$\n$$C_A = (\\frac{1}{2})^{n_S+n_D+1} + (\\frac{1}{2})^{n_S+n_D+1} F_A = (\\frac{1}{2})^{n_S+n_D+1} (1+F_A)$$\n\nThe total inbreeding coefficient $F$ for the individual $I$ is the sum of contributions from all distinct paths through all common ancestors. A path is defined by a common ancestor and the lines of descent to each parent. The problem's constraints simplify this to summing over common ancestors.\n$$F = \\sum_{A} \\left(\\frac{1}{2}\\right)^{n_S + n_D + 1} (1+F_A)$$\nThis is the general expression required.\n\n**Step 2: Application to Avuncular and Second-Cousin Unions**\nThe problem assumes that all founders are non-inbred and mutually unrelated, so for any ultimate common ancestor $A$ in the pedigree, we can set $F_A=0$. The formula simplifies to:\n$$F = \\sum_{A} \\left(\\frac{1}{2}\\right)^{n_S + n_D + 1}$$\n\n**Avuncular Union (Uncle-Niece)**\nLet the mating be between an uncle ($S$) and his niece ($D$). The niece's mother (or father) is the uncle's sibling. Let's assume the mother of $D$, call her $M_D$, is the sister of $S$. This means $S$ and $M_D$ share a parental pair, let's call them $A_1$ and $A_2$. These are the two common ancestors of $S$ and $D$.\n- The path from $S$ to his parents, $A_1$ and $A_2$, involves $1$ meiotic step for each. Thus, $n_S=1$ for both ancestors.\n- The path from $D$ to her maternal grandparents, $A_1$ and $A_2$, goes via her mother $M_D$. The path is $A \\to M_D \\to D$, which involves $2$ meiotic steps. Thus, $n_D=2$ for both ancestors.\n\nThe total inbreeding coefficient is the sum of contributions from $A_1$ and $A_2$:\n$$F_{\\text{avuncular}} = \\left(\\frac{1}{2}\\right)^{1+2+1} + \\left(\\frac{1}{2}\\right)^{1+2+1} = \\left(\\frac{1}{2}\\right)^4 + \\left(\\frac{1}{2}\\right)^4 = \\frac{1}{16} + \\frac{1}{16} = \\frac{2}{16} = \\frac{1}{8}$$\n\n**Second-Cousin Union**\nSecond cousins share a pair of great-grandparents. Let the mating individuals be $S$ and $D$. Their common ancestors, $A_1$ and $A_2$, are a great-grandparental couple.\n- The path from $S$ to a great-grandparent, say $A_1$, involves $3$ meiotic steps (from $S$ to parent, to grandparent, to great-grandparent). Thus, $n_S=3$.\n- Similarly, the path from $D$ to the same great-grandparent $A_1$ also involves $3$ meiotic steps. Thus, $n_D=3$.\n\nThe situation is identical for the other common ancestor, $A_2$. The total inbreeding coefficient is the sum of contributions from $A_1$ and $A_2$:\n$$F_{\\text{second-cousin}} = \\left(\\frac{1}{2}\\right)^{3+3+1} + \\left(\\frac{1}{2}\\right)^{3+3+1} = \\left(\\frac{1}{2}\\right)^7 + \\left(\\frac{1}{2}\\right)^7 = \\frac{1}{128} + \\frac{1}{128} = \\frac{2}{128} = \\frac{1}{64}$$\n\n**Step 3: Calculation of the Ratio**\nThe problem asks for the ratio $\\frac{F_{\\text{avuncular}}}{F_{\\text{second-cousin}}}$.\n$$\\frac{F_{\\text{avuncular}}}{F_{\\text{second-cousin}}} = \\frac{\\frac{1}{8}}{\\frac{1}{64}} = \\frac{1}{8} \\times \\frac{64}{1} = \\frac{64}{8} = 8$$",
            "answer": "$$\\boxed{8}$$"
        },
        {
            "introduction": "While the inbreeding coefficient provides a theoretical expectation, identifying autozygous regions in real genomic data presents a practical challenge: genotyping errors. A true run of homozygosity (ROH) may be interrupted by spurious heterozygous calls, complicating its detection. This practice tackles this issue head-on, requiring you to model genotyping error and use statistical principles to establish a robust criterion for calling an ROH, a crucial skill for any genomic data analyst. ",
            "id": "4350448",
            "problem": "A clinical laboratory is performing homozygosity mapping in a consanguineous family to localize a recessive disease locus. In a run of homozygosity (ROH), a truly autozygous region should be homozygous at every biallelic single-nucleotide polymorphism (SNP), but laboratory genotyping errors can produce spurious heterozygous genotype calls. Consider a candidate ROH in a proband that spans $3500$ informative biallelic SNP markers. Assume the following foundational model:\n\n- Each SNP is truly homozygous within the ROH.\n- Genotype calling errors arise as independent per-allele base-calling flips: each allele independently flips to the other allele with probability $\\epsilon$, and remains correct with probability $1 - \\epsilon$.\n- Across markers, errors are independent and identically distributed.\n- The laboratory sets a one-sided exceedance risk tolerance $\\alpha$ for the number of heterozygous calls observed within a true ROH: the maximum heterozygous allowance is the smallest integer $k$ such that the probability that the observed heterozygous count within a true ROH exceeds $k$ is at most $\\alpha$. To make this computable in routine diagnostics, the laboratory uses a normal approximation to the binomial distribution without continuity correction.\n\nGiven $\\epsilon = 1.5 \\times 10^{-3}$, $n = 3500$, and $\\alpha = 0.01$ (all probabilities expressed as decimals), do the following:\n\n1. From first principles of independent per-allele errors at a biallelic SNP, derive the per-marker probability that a truly homozygous SNP is called heterozygous, then compute the expected number $E$ of false heterozygous genotype calls within this ROH.\n2. Using a binomial model for the count of false heterozygous calls and the stated normal approximation, compute the integer maximum heterozygous allowance $H_{\\max}$ defined as the smallest integer $k$ for which the one-sided exceedance probability is at most $\\alpha$.\n\nRound $E$ to four significant figures. Report $H_{\\max}$ as an integer. Provide your final result as a row matrix $\\begin{pmatrix} E & H_{\\max} \\end{pmatrix}$ without units.",
            "solution": "### Part 1: Expected Number of False Heterozygous Calls\nLet us first derive the probability, $p_{\\text{het}}$, that a single, truly homozygous SNP marker is incorrectly called as heterozygous. Assume the true genotype is $A/A$. The two alleles are read independently. An incorrect call, or a \"flip\" to the alternative allele $B$, occurs with probability $\\epsilon$. A correct call occurs with a probability of $1 - \\epsilon$.\n\nA heterozygous call ($A/B$) is made if one of the two alleles is read correctly and the other is read incorrectly. There are two mutually exclusive ways for this to happen:\n1.  The first allele is read correctly ($A$) and the second is read incorrectly ($B$). The probability of this event is $(1 - \\epsilon) \\times \\epsilon$.\n2.  The first allele is read incorrectly ($B$) and the second is read correctly ($A$). The probability of this event is $\\epsilon \\times (1 - \\epsilon)$.\n\nThe total probability of a false heterozygous call for a single marker is the sum of these probabilities:\n$$p_{\\text{het}} = (1 - \\epsilon)\\epsilon + \\epsilon(1 - \\epsilon) = 2\\epsilon(1 - \\epsilon)$$\nGiven $\\epsilon = 1.5 \\times 10^{-3}$:\n$$p_{\\text{het}} = 2(1.5 \\times 10^{-3})(1 - 1.5 \\times 10^{-3}) = 2(0.0015)(0.9985) = 0.0029955$$\nLet $X$ be the random variable representing the total number of false heterozygous calls across the $n=3500$ markers. Since the errors at each marker are independent and identically distributed, $X$ follows a binomial distribution with parameters $n$ and $p_{\\text{het}}$:\n$$X \\sim \\text{Binomial}(n, p_{\\text{het}})$$\nThe expected number of false heterozygous calls, $E$, is the expectation of $X$:\n$$E = E[X] = n p_{\\text{het}}$$\nSubstituting the given values:\n$$E = 3500 \\times 0.0029955 = 10.48425$$\nThe problem requires this value to be rounded to four significant figures.\n$$E \\approx 10.48$$\n\n### Part 2: Maximum Heterozygous Allowance ($H_{\\max}$)\nThe maximum heterozygous allowance, $H_{\\max}$, is defined as the smallest integer $k$ such that the probability of observing more than $k$ false heterozygous calls is at most $\\alpha$. Mathematically:\n$$H_{\\max} = \\min \\{k \\in \\mathbb{Z} \\mid P(X > k) \\leq \\alpha\\}$$\nWe are instructed to use a normal approximation to the binomial distribution for $X$. Let $Y$ be a normal random variable approximating $X$, so $Y \\sim N(\\mu, \\sigma^2)$, where:\n-   Mean: $\\mu = n p_{\\text{het}} = 10.48425$\n-   Variance: $\\sigma^2 = n p_{\\text{het}}(1 - p_{\\text{het}})$\n\nFirst, we compute the variance and standard deviation:\n$$\\sigma^2 = 10.48425 \\times (1 - 0.0029955) = 10.48425 \\times 0.9970045 \\approx 10.45289$$\n$$\\sigma = \\sqrt{10.45289} \\approx 3.233093$$\nThe condition $P(X > k) \\leq \\alpha$ is approximated by $P(Y > k) \\leq \\alpha$, with $\\alpha = 0.01$. We standardize the normal variable $Y$ to a standard normal variable $Z \\sim N(0, 1)$ where $Z = (Y - \\mu)/\\sigma$.\n$$P\\left(Z > \\frac{k - \\mu}{\\sigma}\\right) \\leq \\alpha$$\nLet $z_{\\alpha}$ be the upper-tail critical value of the standard normal distribution such that $P(Z > z_{\\alpha}) = \\alpha$. This is equivalent to $P(Z \\leq z_{\\alpha}) = 1 - \\alpha$. For $\\alpha = 0.01$, we need the value $z_{0.01}$ corresponding to a cumulative probability of $0.99$. From standard normal tables or a calculator, this value is:\n$$z_{0.01} \\approx 2.3263$$\nFor the inequality $P(Z > (k - \\mu)/\\sigma) \\leq \\alpha$ to hold, we must have:\n$$\\frac{k - \\mu}{\\sigma} \\geq z_{\\alpha}$$\nSolving for $k$:\n$$k \\geq \\mu + z_{\\alpha}\\sigma$$\nSubstituting the computed values for $\\mu$, $\\sigma$, and $z_{0.01}$:\n$$k \\geq 10.48425 + (2.32634787 \\times 3.23309302)$$\n$$k \\geq 10.48425 + 7.5202633$$\n$$k \\geq 18.0045133$$\nSince $H_{\\max}$ is the smallest integer $k$ that satisfies this condition, we must round up to the next integer.\n$$H_{\\max} = 19$$\nThe final results are $E \\approx 10.48$ and $H_{\\max} = 19$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 10.48 & 19 \\end{pmatrix}}$$"
        },
        {
            "introduction": "This final practice synthesizes theory and practical data analysis into a complete workflow for homozygosity mapping. You are tasked with developing a computational approach to scan SNP data, identify runs of homozygosity based on specific rules, and calculate the total fraction of the genome contained within these regions. By comparing your observed results to the theoretical expectation derived from the inbreeding coefficient, you will close the loop between pedigree-based prediction and empirical genomic observation, simulating the core process of localizing a recessive disease gene. ",
            "id": "4350445",
            "problem": "You are given a synthetic Single Nucleotide Polymorphism (SNP) array dataset for one individual across multiple chromosomes, along with the individual's inbreeding coefficient $F$ and an exponential breakage rate parameter $\\lambda$ for autozygous tracts. You must compute the distribution of Runs of Homozygosity (ROH) lengths using a clearly defined detection rule, then summarize the observed fraction of the genome within ROH and compare it to an expected value derived from first principles.\n\nFundamental base and definitions to be used:\n- A Run of Homozygosity (ROH) is a contiguous genomic segment wherein all assayed loci are homozygous in the individual.\n- The inbreeding coefficient $F$ is defined as the probability that the two alleles at a locus are identical by descent in the individual; thus the expected fraction of the genome that is autozygous (disregarding detection constraints) is $F$.\n- Under the Poisson recombination model across the genetic map, the lengths of autozygous tracts arising from a specific consanguinity loop behave as independent exponential random variables in Morgans, with rate $\\lambda$ (per Morgan), where $\\lambda$ equals twice the number of meioses separating the two homologous paths to the shared ancestor. Thus the survival function for tract length $L$ is $\\Pr(L \\ge \\tau) = \\exp(-\\lambda \\tau)$ for threshold $\\tau$ in Morgans.\n- If ROH detection applies a minimum length threshold $L_{\\min}$ to reduce false positives from background linkage disequilibrium, then the expected fraction of the genome that will be captured by ROH detection is $F \\cdot \\Pr(L \\ge \\tau)$ with $\\tau = L_{\\min}$ in Morgans, i.e., $F \\cdot \\exp(-\\lambda \\cdot \\tau)$.\n\nDetection rule and required computations:\n- Consider a chromosome with SNP positions given in centiMorgans (cM) and genotypes coded as $0$, $1$, or $2$, representing $BB$, $AB$, and $AA$ respectively. A site is homozygous if its genotype equals $0$ or $2$, and heterozygous if it equals $1$.\n- A ROH on a chromosome is defined as a maximal contiguous block of consecutive SNPs with no heterozygous sites. The length of a ROH is the difference (in cM) between the last and first SNP positions in the block. Single-SNP blocks have length $0$ and do not pass any positive threshold.\n- Only ROH with length greater than or equal to a specified minimum length $L_{\\min}$ (in cM) are counted. The observed genome-wide ROH fraction is the sum of lengths (in cM) of all detected ROH divided by the sum of chromosome genetic lengths (in cM).\n- The expected captured ROH fraction, accounting for the detection threshold, is $F \\cdot \\exp(-\\lambda \\cdot \\tau)$ where $\\tau = L_{\\min}/100$ is the threshold in Morgans. This value must be bounded to the interval $\\left[0,1\\right]$.\n- You must also compute the number of detected ROH and the mean ROH length in cM (defined as $0$ if no ROH are detected).\n\nUnits and rounding:\n- All positions and lengths are in centiMorgans (cM). Convert $L_{\\min}$ to Morgans by dividing by $100$ when evaluating the exponential model.\n- Fractions must be reported as decimals (not percentages).\n- Round the observed fraction, expected fraction, and absolute difference to $6$ decimal places. Round the mean ROH length to $3$ decimals. The number of ROH is an integer.\n\nTest suite:\n- Use the following three chromosomes across all test cases:\n  - Chromosome $1$: length $100$ cM, positions $[0,10,20,30,40,50,60,70,80,90,100]$.\n  - Chromosome $2$: length $90$ cM, positions $[0,15,30,45,60,75,90]$.\n  - Chromosome $3$: length $110$ cM, positions $[0,10,20,30,40,50,65,80,95,110]$.\n- Test Case $1$ (happy path):\n  - $F = 0.0625$, $\\lambda = 8$, $L_{\\min} = 10$ cM.\n  - Genotypes:\n    - Chromosome $1$: $[1,1,1,0,2,0,1,1,1,1,1]$.\n    - Chromosome $2$: $[1,1,1,1,1,1,1]$.\n    - Chromosome $3$: $[1,1,1,1,1,1,1,1,1,1]$.\n- Test Case $2$ (boundary where no ROH meets a higher threshold):\n  - $F = 0.0625$, $\\lambda = 8$, $L_{\\min} = 25$ cM.\n  - Genotypes identical to Test Case $1$.\n- Test Case $3$ (edge case of near-complete homozygosity):\n  - $F = 0.98$, $\\lambda = 1$, $L_{\\min} = 5$ cM.\n  - Genotypes:\n    - Chromosome $1$: $[2,2,2,2,2,2,2,2,2,2,2]$.\n    - Chromosome $2$: $[2,2,2,2,2,2,2]$.\n    - Chromosome $3$: $[2,2,2,2,2,2,2,2,2,2]$.\n- Test Case $4$ (multiple ROH across chromosomes):\n  - $F = 0.125$, $\\lambda = 4$, $L_{\\min} = 10$ cM.\n  - Genotypes:\n    - Chromosome $1$: $[1,1,1,1,1,1,1,0,0,1,1]$.\n    - Chromosome $2$: $[1,1,1,1,0,0,1]$.\n    - Chromosome $3$: $[1,1,0,0,0,0,1,1,1,1]$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results for all test cases as a Python-style list of lists. For each test case, output a list with five values in the following order:\n  - Observed ROH fraction (rounded to $6$ decimals),\n  - Expected ROH fraction (rounded to $6$ decimals),\n  - Absolute difference (rounded to $6$ decimals),\n  - Number of detected ROH (integer),\n  - Mean ROH length in cM (rounded to $3$ decimals).\n- The overall output must be a single line like $[[a_1,b_1,c_1,d_1,e_1],[a_2,b_2,c_2,d_2,e_2],\\dots]$ with no additional text.",
            "solution": "The solution involves an algorithm to process the provided SNP data for each test case according to the specified rules. The overall process for each test case is as follows:\n\n1.  **Initialize**: The total genetic length of the genome is pre-calculated as the sum of all chromosome lengths (100 + 90 + 110 = 300 cM). The parameters $F$, $\\lambda$, and $L_{\\min}$ are read for the current test case.\n\n2.  **ROH Detection**: For each chromosome, the algorithm iterates through its list of SNP genotypes and their corresponding positions.\n    *   A run of homozygosity is identified by finding consecutive SNPs whose genotype is not 1 (i.e., is 0 or 2).\n    *   The algorithm records the start and end indices of each maximal contiguous homozygous segment.\n    *   The length of each run is calculated as the difference in genetic position (in cM) between the last SNP and the first SNP of the run. Single-SNP runs correctly result in a length of 0.\n\n3.  **Filtering and Observed Statistics Calculation**:\n    *   The list of all ROH lengths is filtered to keep only those with length greater than or equal to the case-specific $L_{\\min}$.\n    *   The total length of these detected ROHs is summed.\n    *   The *Observed ROH fraction* is this total detected length divided by the total genome length (300 cM).\n    *   The *Number of detected ROHs* is the count of runs that passed the length filter.\n    *   The *Mean ROH length* is the total detected length divided by the number of detected ROHs (or 0 if none were detected).\n\n4.  **Expected Statistics Calculation**:\n    *   The minimum length threshold $L_{\\min}$ is converted from cM to Morgans ($\\tau = L_{\\min} / 100$).\n    *   The *Expected ROH fraction* is calculated using the formula $F \\cdot \\exp(-\\lambda \\cdot \\tau)$.\n\n5.  **Final Results Assembly**: The observed fraction, expected fraction, their absolute difference, the number of ROHs, and the mean ROH length are calculated and rounded to the specified precision. These five values are assembled into a list for the test case. The final output is a list containing the result lists for all four test cases.",
            "answer": "[[0.066667, 0.028083, 0.038584, 1, 20.000], [0.000000, 0.008459, 0.008459, 0, 0.000], [1.000000, 0.932442, 0.067558, 3, 100.000], [0.183333, 0.083790, 0.099543, 3, 18.333]]"
        }
    ]
}