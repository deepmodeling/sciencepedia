{
    "hands_on_practices": [
        {
            "introduction": "在我们开始寻找致病的新生突变之前，一个基本问题是：在一个人的基因组中，我们预计会发现多少个新生突变？这个问题为我们的搜索设定了基准，并有助于评估分析结果。这个练习将引导你使用基本的概率论和期望线性性质，推导出基因组中新生突变数量的期望值，这是一个基因组学中的基础计算。",
            "id": "4393864",
            "problem": "在基于家系的全外显子组测序 (WES) 或全基因组测序 (WGS) 的背景下，新生突变 (DNM) 是一种存在于子代但其双亲均不携带的变异。考虑一项研究，其中子代基因组中可调用碱基位置的数量为 $G$，在每个可调用位点，子代在该特定位点携带新生突变的概率（综合来自双亲配子的贡献）为 $u$。假设在所有可调用位点上，这个单位点概率是均一的，并且这些事件足够罕见，以至于可以忽略同一位点在单代内发生多次突变的事件。对于每个可调用位点 $i \\in \\{1,\\dots,G\\}$，定义一个指示变量 $X_{i}$：如果子代在位点 $i$ 发生新生突变，则 $X_{i}$ 等于 $1$，否则等于 $0$。并将新生突变的总数定义为 $N=\\sum_{i=1}^{G} X_{i}$。\n\n仅从指示变量的定义、概率公理和期望的线性性出发，推导新生突变期望数量 $E[N]$ 关于 $u$ 和 $G$ 的解析表达式。然后，使用科学上合理的数值 $u = 1.2 \\times 10^{-8}$ 和 $G = 3.1 \\times 10^{9}$（这两个值都是在上述假设下，针对子代基因组可调用部分的），计算期望数量。将最终数值结果四舍五入至 $3$ 位有效数字。最终答案以无单位的纯数字表示。",
            "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于群体遗传学和生物信息学的原理，问题提出得很好，是客观的，并包含了推导唯一解所需的所有必要信息。\n\n目标是推导子代基因组中新生突变 (DNM) 的期望数量 $E[N]$，然后计算其数值。\n\n新生突变的总数 $N$ 定义为所有可调用基因组位点上指示变量的总和：\n$$N = \\sum_{i=1}^{G} X_{i}$$\n其中 $G$ 是可调用碱基位置的总数。对于位点 $i \\in \\{1, \\dots, G\\}$ 的每个指示变量 $X_i$ 定义如下：\n$$\nX_i =\n\\begin{cases}\n1  \\text{如果位点 } i \\text{ 发生新生突变} \\\\\n0  \\text{其他情况}\n\\end{cases}\n$$\n问题陈述指出，在任何给定位置 $i$ 发生新生突变的概率是 $u$。因此，$X_i$ 取值为 $1$ 的概率是：\n$$P(X_i = 1) = u$$\n因此，$X_i$ 取值为 $0$ 的概率是：\n$$P(X_i = 0) = 1 - u$$\n问题要求从指示变量的定义和概率公理出发进行推导。根据定义，指示变量的期望值 $E[X_i]$ 为：\n$$E[X_i] = \\sum_{k} k \\cdot P(X_i = k)$$\n对于 $X_i$ 的二元结果，这展开为：\n$$E[X_i] = (1 \\times P(X_i = 1)) + (0 \\times P(X_i = 0))$$\n代入概率值：\n$$E[X_i] = (1 \\times u) + (0 \\times (1 - u))$$\n$$E[X_i] = u$$\n问题陈述指出，单位点突变概率 $u$ 在所有 $G$ 个可调用位点上是均一的。这意味着对于任何位点 $i$，期望值 $E[X_i]$ 都是相同的，等于 $u$。\n\n为了求出新生突变总数的期望值 $E[N]$，我们使用期望的线性性。该性质指出，随机变量之和的期望等于它们各自期望之和，无论这些变量是否独立。\n$$E[N] = E\\left[\\sum_{i=1}^{G} X_{i}\\right]$$\n应用期望的线性性：\n$$E[N] = \\sum_{i=1}^{G} E[X_{i}]$$\n因为我们已经确定对于所有从 $1$ 到 $G$ 的 $i$，$E[X_i] = u$，所以我们将常数值 $u$ 相加 $G$ 次：\n$$E[N] = \\sum_{i=1}^{G} u = u + u + \\dots + u \\quad (G \\text{ 次})$$\n这可以简化为：\n$$E[N] = G \\cdot u$$\n这就是新生突变期望数量关于 $u$ 和 $G$ 的解析表达式。\n\n接下来，我们使用所提供的合理数值计算其具体值：\n单位点新生突变率为 $u = 1.2 \\times 10^{-8}$。\n可调用碱基位置的数量为 $G = 3.1 \\times 10^{9}$。\n\n将这些值代入我们推导出的表达式中：\n$$E[N] = (3.1 \\times 10^{9}) \\times (1.2 \\times 10^{-8})$$\n我们可以将系数和 $10$ 的幂分开计算：\n$$E[N] = (3.1 \\times 1.2) \\times (10^{9} \\times 10^{-8})$$\n首先，我们乘以系数：\n$$3.1 \\times 1.2 = 3.72$$\n接下来，我们乘以 $10$ 的幂：\n$$10^{9} \\times 10^{-8} = 10^{9-8} = 10^{1} = 10$$\n合并这些结果：\n$$E[N] = 3.72 \\times 10 = 37.2$$\n问题要求将最终数值结果四舍五入至 $3$ 位有效数字。计算出的值 $37.2$ 已经恰好有三位有效数字（$3$、$7$ 和 $2$）。因此，不需要进一步的四舍五入。\n\n子代中新生突变的期望数量是 $37.2$。",
            "answer": "$$\\boxed{37.2}$$"
        },
        {
            "introduction": "在三人组测序数据中观察到候选变异后，我们必须确定它是一个真实的生物学事件，还是仅仅是测序过程中的随机错误。本练习深入探讨了变异识别的统计核心，通过构建一个似然比检验来量化支持新生突变假说的证据。掌握这种方法对于批判性地评估和过滤变异检出至关重要，确保我们关注的是高质量的候选突变。",
            "id": "4393880",
            "problem": "在基于核心家庭（trio-based）的全外显子组测序 (WES) 或全基因组测序 (WGS) 分析中，考虑一个单核苷酸变异位点，其具有观测到的等位基因深度。等位基因深度 (AD) 表示支持参考等位基因和备选等位基因的测序读数计数。子代的观测等位基因深度为 $\\mathrm{AD}_{\\text{child}}=(18\\ \\text{ref},\\ 22\\ \\text{alt})$，母亲为 $\\mathrm{AD}_{\\text{mom}}=(40\\ \\text{ref},\\ 0\\ \\text{alt})$，父亲为 $\\mathrm{AD}_{\\text{dad}}=(41\\ \\text{ref},\\ 0\\ \\text{alt})$。假设每次读数的碱基检出错误率 $\\epsilon=0.001$ 是独立的，错检概率是对称的，并且读数抽样遵循以真实基因型为条件的二项过程。\n\n定义两个竞争性假设：\n- $\\mathcal{H}_{\\text{dn}}$：子代存在一个真正的新发杂合变异（父母为纯合参考型）。\n- $\\mathcal{H}_{\\text{err}}$：无突变；子代为纯合参考型，观测到的备选等位基因读数仅由测序错误引起（父母为纯合参考型）。\n\n在这些假设下，子代的一个读数被检出为备选等位基因的概率在假设 $\\mathcal{H}_{\\text{dn}}$ 下为 $p_{\\text{alt}}^{(\\text{dn})}$，在假设 $\\mathcal{H}_{\\text{err}}$ 下为 $p_{\\text{alt}}^{(\\text{err})}$。使用读数计数的二项似然来计算对数似然比\n$$\n\\mathrm{LLR} \\equiv \\ln\\!\\left(\\frac{L(\\mathcal{H}_{\\text{dn}})}{L(\\mathcal{H}_{\\text{err}})}\\right),\n$$\n其中 $L(\\cdot)$ 是在相应假设下观测到的三人组等位基因深度的似然。请将最终答案表示为一个实数，以自然对数单位（无量纲）给出，并四舍五入到四位有效数字。",
            "solution": "用户提供的问题具有科学依据、定义明确且客观。它是统计推断在基因组学中的一个标准应用，特别是用于鉴定新发突变。问题给出了所有必要的数据，并清晰地定义了竞争性假设和统计模型。该问题没有矛盾或含糊不清之处。因此，该问题被认为是有效的，下面提供了完整的解答。\n\n问题要求计算一个对数似然比 (LLR)，以比较关于在子代中观测到的一个遗传变异的两种假设，给定来自子代及其双亲（一个三人组）的测序数据。问题的核心在于使用二项分布为每种假设构建观测读数计数的似然。\n\n提供的数据如下：\n- 子代的等位基因深度：$\\mathrm{AD}_{\\text{child}}=(18\\ \\text{ref},\\ 22\\ \\text{alt})$。这给出了总共 $N_{\\text{child}} = 18 + 22 = 40$ 个读数，其中 $k_{\\text{child, ref}} = 18$ 个参考等位基因读数和 $k_{\\text{child, alt}} = 22$ 个备选等位基因读数。\n- 母亲的等位基因深度：$\\mathrm{AD}_{\\text{mom}}=(40\\ \\text{ref},\\ 0\\ \\text{alt})$。\n- 父亲的等位基因深度：$\\mathrm{AD}_{\\text{dad}}=(41\\ \\text{ref},\\ 0\\ \\text{alt})$。\n- 每次读数的碱基检出错误率：$\\epsilon = 0.001$。\n\n对于一个给定的假设 $\\mathcal{H}$，其似然函数 $L(\\mathcal{H})$ 是在该假设条件下观测到三人组等位基因深度的概率。假设个体间的测序是独立的，则有：\n$$\nL(\\mathcal{H}) = P(\\mathrm{AD}_{\\text{child}}|\\mathcal{H}) \\cdot P(\\mathrm{AD}_{\\text{mom}}|\\mathcal{H}) \\cdot P(\\mathrm{AD}_{\\text{dad}}|\\mathcal{H})\n$$\n两种假设 $\\mathcal{H}_{\\text{dn}}$ 和 $\\mathcal{H}_{\\text{err}}$ 都陈述了父母是纯合参考型 ($\\text{Ref/Ref}$)。因此，对于父母的似然项 $P(\\mathrm{AD}_{\\text{mom}}|\\mathcal{H})$ 和 $P(\\mathrm{AD}_{\\text{dad}}|\\mathcal{H})$ 在两种假设下是相同的。当我们计算似然比时，这些项会相互抵消：\n$$\n\\frac{L(\\mathcal{H}_{\\text{dn}})}{L(\\mathcal{H}_{\\text{err}})} = \\frac{P(\\mathrm{AD}_{\\text{child}}|\\mathcal{H}_{\\text{dn}}) \\cdot P(\\mathrm{AD}_{\\text{parents}}|\\mathcal{H}_{\\text{dn}})}{P(\\mathrm{AD}_{\\text{child}}|\\mathcal{H}_{\\text{err}}) \\cdot P(\\mathrm{AD}_{\\text{parents}}|\\mathcal{H}_{\\text{err}})} = \\frac{P(\\mathrm{AD}_{\\text{child}}|\\mathcal{H}_{\\text{dn}})}{P(\\mathrm{AD}_{\\text{child}}|\\mathcal{H}_{\\text{err}})}\n$$\n因此，我们只需要对每种假设下子代数据的似然进行建模。在总共 $N_{\\text{child}}$ 个读数中，备选等位基因读数的数量 $k_{\\text{child, alt}}$ 被假定遵循二项分布 $\\text{Binom}(N_{\\text{child}}, p_{\\text{alt}})$，其中 $p_{\\text{alt}}$ 是单个读数被检出为备选等位基因的概率。这个概率取决于具体的假设。\n\n设 $k = k_{\\text{child, alt}} = 22$ 且 $N = N_{\\text{child}} = 40$。在 $N$ 次试验中观测到 $k$ 个备选等位基因读数的似然函数由以下公式给出：\n$$\nL(k, N | p_{\\text{alt}}) = \\binom{N}{k} (p_{\\text{alt}})^{k} (1-p_{\\text{alt}})^{N-k}\n$$\n\n接下来，我们为每个假设定义 $p_{\\text{alt}}$。\n\n假设 $\\mathcal{H}_{\\text{dn}}$：子代有一个新发杂合变异 ($\\text{Ref/Alt}$)。\n在此假设下，子代的真实基因型为杂合型。假设读数从父源和母源染色体上以相等的概率进行抽样，那么一个读数来源于真实参考等位基因的概率为 $0.5$，来源于真实备选等位基因的概率为 $0.5$。\n观测到一个备选等位基因读数的概率 $p_{\\text{alt}}^{(\\text{dn})}$ 是两种情况的概率之和：\n1.  抽样到一个真实的参考等位基因，但被错误地检出为备选：$P(\\text{sample ref}) \\times P(\\text{call alt}|\\text{true ref}) = 0.5 \\times \\epsilon$。\n2.  抽样到一个真实的备选等位基因，并被正确地检出为备选：$P(\\text{sample alt}) \\times P(\\text{call alt}|\\text{true alt}) = 0.5 \\times (1-\\epsilon)$。\n将这些概率相加得到：\n$$\np_{\\text{alt}}^{(\\text{dn})} = (0.5 \\times \\epsilon) + (0.5 \\times (1-\\epsilon)) = 0.5\\epsilon + 0.5 - 0.5\\epsilon = 0.5\n$$\n在 $\\mathcal{H}_{\\text{dn}}$ 假设下，子代数据的似然为：\n$$\nL(\\mathcal{H}_{\\text{dn}}) \\propto L(\\mathrm{AD}_{\\text{child}} | \\mathcal{H}_{\\text{dn}}) = \\binom{40}{22} (0.5)^{22} (1-0.5)^{18} = \\binom{40}{22} (0.5)^{40}\n$$\n\n假设 $\\mathcal{H}_{\\text{err}}$：子代为纯合参考型 ($\\text{Ref/Ref}$)，备选等位基因读数是错误所致。\n在此假设下，子代的真实基因型为纯合参考型。每个读数都从一个真实的参考等位基因抽样而来。只有由于测序错误，才能观测到备选等位基因读数。\n$$\np_{\\text{alt}}^{(\\text{err})} = P(\\text{call alt}|\\text{true ref}) = \\epsilon\n$$\n在 $\\mathcal{H}_{\\text{err}}$ 假设下，子代数据的似然为：\n$$\nL(\\mathcal{H}_{\\text{err}}) \\propto L(\\mathrm{AD}_{\\text{child}} | \\mathcal{H}_{\\text{err}}) = \\binom{40}{22} (\\epsilon)^{22} (1-\\epsilon)^{18}\n$$\n\n现在，我们可以计算对数似然比 (LLR)：\n$$\n\\mathrm{LLR} \\equiv \\ln\\!\\left(\\frac{L(\\mathcal{H}_{\\text{dn}})}{L(\\mathcal{H}_{\\text{err}})}\\right) = \\ln\\!\\left(\\frac{\\binom{40}{22} (0.5)^{40}}{\\binom{40}{22} \\epsilon^{22} (1-\\epsilon)^{18}}\\right)\n$$\n二项式系数 $\\binom{40}{22}$ 被消去。\n$$\n\\mathrm{LLR} = \\ln\\!\\left(\\frac{(0.5)^{40}}{\\epsilon^{22} (1-\\epsilon)^{18}}\\right)\n$$\n使用对数的性质，$\\ln(a/b) = \\ln(a) - \\ln(b)$ 和 $\\ln(a^b) = b\\ln(a)$：\n$$\n\\mathrm{LLR} = \\ln((0.5)^{40}) - \\ln(\\epsilon^{22} (1-\\epsilon)^{18}) = 40\\ln(0.5) - \\left( 22\\ln(\\epsilon) + 18\\ln(1-\\epsilon) \\right)\n$$\n$$\n\\mathrm{LLR} = 40\\ln(0.5) - 22\\ln(\\epsilon) - 18\\ln(1-\\epsilon)\n$$\n我们已知 $\\epsilon = 0.001$。代入数值：\n$$\n\\mathrm{LLR} = 40\\ln(0.5) - 22\\ln(0.001) - 18\\ln(1-0.001)\n$$\n$$\n\\mathrm{LLR} = 40\\ln(0.5) - 22\\ln(0.001) - 18\\ln(0.999)\n$$\n现在，我们计算其数值：\n$$\n\\ln(0.5) \\approx -0.69314718\n$$\n$$\n\\ln(0.001) \\approx -6.90775528\n$$\n$$\n\\ln(0.999) \\approx -0.00100050\n$$\n将这些值代入 LLR 的表达式中：\n$$\n\\mathrm{LLR} \\approx 40(-0.69314718) - 22(-6.90775528) - 18(-0.00100050)\n$$\n$$\n\\mathrm{LLR} \\approx -27.7258872 + 151.9706162 + 0.0180090\n$$\n$$\n\\mathrm{LLR} \\approx 124.262738\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\n\\mathrm{LLR} \\approx 124.3\n$$\nLLR 的这个较大的正值表明，观测数据在新发突变假设 ($\\mathcal{H}_{\\text{dn}}$) 下的可能性远大于在测序错误假设 ($\\mathcal{H}_{\\text{err}}$) 下的可能性。",
            "answer": "$$\\boxed{124.3}$$"
        }
    ]
}