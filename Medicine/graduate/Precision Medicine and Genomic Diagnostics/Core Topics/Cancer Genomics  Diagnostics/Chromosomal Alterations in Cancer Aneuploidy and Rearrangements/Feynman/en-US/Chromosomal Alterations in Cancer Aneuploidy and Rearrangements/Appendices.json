{
    "hands_on_practices": [
        {
            "introduction": "This problem tackles a central challenge in cancer genomics: interpreting data from bulk tumor samples, which are mixtures of cancer and normal cells. To accurately quantify chromosomal alterations, we must first deconvolve these signals. This exercise provides hands-on practice with the fundamental linear mixture model used to calculate the true tumor-specific copy number from observed bulk sequencing data, a crucial first step in any copy number analysis workflow . You will apply this principle to compute key metrics like Somatic Copy Number Alteration (SCNA) burden and identify large-scale aneuploidy events, which are powerful biomarkers in oncology.",
            "id": "4322031",
            "problem": "A bulk whole-genome sequencing assay is performed on a single solid tumor sample within a precision oncology workflow. The tumor cell fraction (purity) is estimated to be $p = 0.7$. Assume the following foundational facts:\n- The observed absolute copy number per genomic segment in a bulk sample arises from a linear mixture of contributions from normal cells (diploid with copy number $2$) and tumor cells. The tumor contribution is captured by the tumor-average copy number for that segment, and the normal contribution is fixed at $2$.\n- Somatic Copy Number Alteration (SCNA) is defined as any deviation of the tumor-average copy number from the diploid state $2$.\n- Aneuploidy at the arm level refers to copy number imbalance affecting a substantial fraction of a chromosome arm with a consistent direction (gain or loss).\n\nTo focus the calculation, consider that the “genome under consideration” consists of exactly the following four chromosome arms, with their lengths and segmentation provided. Lengths are in megabase (Mb). For each segment, an absolute bulk copy number estimate is provided, which is the observable produced by the mixture of tumor and normal cells.\n\n- Chromosome arm $1\\mathrm{p}$ (length $120$ Mb):\n  - Segment $[0, 60)$ Mb: observed absolute copy number $2.7$.\n  - Segment $[60, 120)$ Mb: observed absolute copy number $2.0$.\n\n- Chromosome arm $1\\mathrm{q}$ (length $150$ Mb):\n  - Segment $[0, 120)$ Mb: observed absolute copy number $1.3$.\n  - Segment $[120, 150)$ Mb: observed absolute copy number $2.0$.\n\n- Chromosome arm $3\\mathrm{p}$ (length $100$ Mb):\n  - Segment $[0, 40)$ Mb: observed absolute copy number $2.35$.\n  - Segment $[40, 100)$ Mb: observed absolute copy number $2.0$.\n\n- Chromosome arm $7\\mathrm{q}$ (length $160$ Mb):\n  - Segment $[0, 160)$ Mb: observed absolute copy number $2.56$.\n\nUsing only the foundational mixture principle stated above, proceed as follows:\n\n1. For each segment, derive the tumor-average copy number from the observed absolute copy number and the purity $p$, and then compute the segment’s SCNA amplitude as the absolute deviation of the tumor-average copy number from $2$.\n\n2. Define an “arm-level aneuploidy event” as present on a chromosome arm if at least $0.6$ of the arm’s length shows SCNAs with a consistent direction (gain if tumor-average copy number $> 2$, loss if $< 2$), and the mean absolute deviation across that consistently directed portion is at least $0.5$ in copy units. Count the total number of arm-level aneuploidy events across the four arms to obtain $N$.\n\n3. Define the SCNA burden $B$ over the genome under consideration as the amplitude-weighted fraction of the genome altered:\n   $$B \\equiv \\frac{\\sum_{i} \\ell_{i} \\, |C_{i}^{(\\mathrm{tumor})} - 2|}{\\sum_{i} \\ell_{i}},$$\n   where $\\ell_{i}$ is the length of segment $i$ and $C_{i}^{(\\mathrm{tumor})}$ is the tumor-average copy number for segment $i$.\n\n4. Define a composite score $S \\equiv N + B$.\n\nCompute $S$ for the provided data. Express the final answer as a pure number (dimensionless). Round your answer to four significant figures.",
            "solution": "The solution proceeds in four steps as outlined in the problem statement.\n\n### Step 1: Derive Tumor-Average Copy Number and SCNA Amplitude\n\nThe observed absolute copy number, $C_{\\text{obs}}$, is given by the linear mixture model:\n$$C_{\\text{obs}} = p \\cdot C_{\\text{tumor}} + (1-p) \\cdot C_{\\text{normal}}$$\nGiven $p = 0.7$ and $C_{\\text{normal}} = 2$, the equation becomes:\n$$C_{\\text{obs}} = 0.7 \\cdot C_{\\text{tumor}} + (1-0.7) \\cdot 2 = 0.7 \\cdot C_{\\text{tumor}} + 0.6$$\nRearranging to solve for the tumor-average copy number, $C_{\\text{tumor}}$, we get:\n$$C_{\\text{tumor}} = \\frac{C_{\\text{obs}} - 0.6}{0.7}$$\nThe SCNA amplitude for each segment is defined as the absolute deviation from the diploid state, $|C_{\\text{tumor}} - 2|$. We compute these values for each segment.\n\n- **Arm $1\\mathrm{p}$, Segment $[0, 60)$ Mb**: $\\ell_1 = 60$ Mb, $C_{\\text{obs},1} = 2.7$.\n  $$C_{\\text{tumor},1} = \\frac{2.7 - 0.6}{0.7} = \\frac{2.1}{0.7} = 3$$\n  SCNA Amplitude: $|3 - 2| = 1$. This is a gain.\n\n- **Arm $1\\mathrm{p}$, Segment $[60, 120)$ Mb**: $\\ell_2 = 60$ Mb, $C_{\\text{obs},2} = 2.0$.\n  $$C_{\\text{tumor},2} = \\frac{2.0 - 0.6}{0.7} = \\frac{1.4}{0.7} = 2$$\n  SCNA Amplitude: $|2 - 2| = 0$. This is diploid.\n\n- **Arm $1\\mathrm{q}$, Segment $[0, 120)$ Mb**: $\\ell_3 = 120$ Mb, $C_{\\text{obs},3} = 1.3$.\n  $$C_{\\text{tumor},3} = \\frac{1.3 - 0.6}{0.7} = \\frac{0.7}{0.7} = 1$$\n  SCNA Amplitude: $|1 - 2| = 1$. This is a loss.\n\n- **Arm $1\\mathrm{q}$, Segment $[120, 150)$ Mb**: $\\ell_4 = 30$ Mb, $C_{\\text{obs},4} = 2.0$.\n  $$C_{\\text{tumor},4} = \\frac{2.0 - 0.6}{0.7} = \\frac{1.4}{0.7} = 2$$\n  SCNA Amplitude: $|2 - 2| = 0$. This is diploid.\n\n- **Arm $3\\mathrm{p}$, Segment $[0, 40)$ Mb**: $\\ell_5 = 40$ Mb, $C_{\\text{obs},5} = 2.35$.\n  $$C_{\\text{tumor},5} = \\frac{2.35 - 0.6}{0.7} = \\frac{1.75}{0.7} = 2.5$$\n  SCNA Amplitude: $|2.5 - 2| = 0.5$. This is a gain.\n\n- **Arm $3\\mathrm{p}$, Segment $[40, 100)$ Mb**: $\\ell_6 = 60$ Mb, $C_{\\text{obs},6} = 2.0$.\n  $$C_{\\text{tumor},6} = \\frac{2.0 - 0.6}{0.7} = \\frac{1.4}{0.7} = 2$$\n  SCNA Amplitude: $|2 - 2| = 0$. This is diploid.\n\n- **Arm $7\\mathrm{q}$, Segment $[0, 160)$ Mb**: $\\ell_7 = 160$ Mb, $C_{\\text{obs},7} = 2.56$.\n  $$C_{\\text{tumor},7} = \\frac{2.56 - 0.6}{0.7} = \\frac{1.96}{0.7} = 2.8$$\n  SCNA Amplitude: $|2.8 - 2| = 0.8$. This is a gain.\n\n### Step 2: Count Arm-Level Aneuploidy Events ($N$)\n\nAn arm-level aneuploidy event requires that at least $0.6$ of the arm's length has a consistent SCNA direction (gain or loss) and the mean absolute deviation in that region is at least $0.5$.\n\n- **Arm $1\\mathrm{p}$ (Total length $120$ Mb)**: There is a gain in a segment of length $60$ Mb. The fraction of the arm altered is $\\frac{60}{120} = 0.5$. Since $0.5 < 0.6$, arm $1\\mathrm{p}$ does not have an arm-level event.\n\n- **Arm $1\\mathrm{q}$ (Total length $150$ Mb)**: There is a loss in a segment of length $120$ Mb. The fraction of the arm altered is $\\frac{120}{150} = 0.8$. Since $0.8 \\ge 0.6$, the first condition is met. The mean absolute deviation across this portion is the amplitude of the single segment, which is $1$. Since $1 \\ge 0.5$, the second condition is met. Thus, arm $1\\mathrm{q}$ has an arm-level aneuploidy event.\n\n- **Arm $3\\mathrm{p}$ (Total length $100$ Mb)**: There is a gain in a segment of length $40$ Mb. The fraction of the arm altered is $\\frac{40}{100} = 0.4$. Since $0.4 < 0.6$, arm $3\\mathrm{p}$ does not have an arm-level event.\n\n- **Arm $7\\mathrm{q}$ (Total length $160$ Mb)**: There is a gain across the entire arm, length $160$ Mb. The fraction of the arm altered is $\\frac{160}{160} = 1.0$. Since $1.0 \\ge 0.6$, the first condition is met. The mean absolute deviation is the amplitude of the segment, which is $0.8$. Since $0.8 \\ge 0.5$, the second condition is met. Thus, arm $7\\mathrm{q}$ has an arm-level aneuploidy event.\n\nThe total number of arm-level aneuploidy events is the sum of events on arms $1\\mathrm{q}$ and $7\\mathrm{q}$.\n$$N = 1 + 1 = 2$$\n\n### Step 3: Calculate SCNA Burden ($B$)\n\nThe SCNA burden $B$ is the amplitude-weighted fraction of the genome altered:\n$$B = \\frac{\\sum_{i} \\ell_{i} \\, |C_{i}^{(\\mathrm{tumor})} - 2|}{\\sum_{i} \\ell_{i}}$$\nThe numerator is the sum of the products of each segment's length and its SCNA amplitude. We only need to sum over segments with non-zero amplitude.\n$$ \\text{Numerator} = (60 \\cdot 1) + (120 \\cdot 1) + (40 \\cdot 0.5) + (160 \\cdot 0.8) $$\n$$ \\text{Numerator} = 60 + 120 + 20 + 128 = 328 $$\nThe denominator is the total length of the genome under consideration.\n$$ \\text{Denominator} = \\ell_{1\\mathrm{p}} + \\ell_{1\\mathrm{q}} + \\ell_{3\\mathrm{p}} + \\ell_{7\\mathrm{q}} = 120 + 150 + 100 + 160 = 530 $$\nThe SCNA burden is:\n$$B = \\frac{328}{530} \\approx 0.6188679...$$\n\n### Step 4: Calculate Composite Score ($S$)\n\nThe composite score $S$ is defined as $N + B$.\n$$ S = 2 + \\frac{328}{530} \\approx 2 + 0.6188679... = 2.6188679... $$\nThe problem requires rounding the result to four significant figures. The first four significant figures are $2$, $6$, $1$, and $8$. The fifth digit is $8$, so we round up the fourth digit.\n$$ S \\approx 2.619 $$",
            "answer": "$$\n\\boxed{2.619}\n$$"
        },
        {
            "introduction": "Moving beyond total copy number, this practice delves into the analysis of allele-specific alterations, such as Loss of Heterozygosity (LOH). LOH is a common event in cancer that can unmask recessive mutations, and distinguishing it from a retained heterozygous state is critical for clinical interpretation. This problem guides you through a Bayesian approach to weigh the evidence for two competing biological scenarios—LOH versus heterozygosity—using allele-specific read counts from a heterozygous Single-Nucleotide Polymorphism (SNP) . By calculating a Bayes factor, you will gain experience in applying rigorous statistical model comparison to genomic data, a sophisticated skill essential for precision diagnostics.",
            "id": "4322015",
            "problem": "A tumor sample from a patient is analyzed by high-depth targeted sequencing at a germline heterozygous single-nucleotide polymorphism (SNP) with alleles denoted $A$ and $B$. The tumor purity, defined as the fraction of nucleated cells in the specimen that are cancer cells, is $p = 0.70$. Consider two competing models for the locus in the cancer cells:\n\n- Model $\\mathcal{M}_0$ (no loss of heterozygosity): The cancer cells are disomic and heterozygous $A/B$ at the locus. In the noncancer cells (fraction $1-p$), the genotype is also $A/B$.\n\n- Model $\\mathcal{M}_1$ (copy-neutral loss of heterozygosity via mitotic recombination): The cancer cells are disomic but homozygous at the locus due to mitotic recombination generating uniparental disomy; they are $A/A$ or $B/B$ with equal prior probability. The noncancer cells (fraction $1-p$) are $A/B$.\n\nAssume that sequencing reads are independent and identically distributed Bernoulli trials with success probability equal to the true underlying fraction of the $B$ allele in the cell mixture, and that there is no allelic mapping bias or overdispersion beyond binomial sampling. At the SNP, a total of $N = 100$ reads are obtained, of which $k = 20$ report the $B$ allele.\n\nUsing equal model priors for $\\mathcal{M}_0$ and $\\mathcal{M}_1$, compute the base-$10$ logarithm of the Bayes factor $K$ in favor of $\\mathcal{M}_1$ over $\\mathcal{M}_0$, where $K$ is defined as the ratio of marginal likelihoods of the observed data under $\\mathcal{M}_1$ and $\\mathcal{M}_0$. Round your answer to four significant figures. Express your answer as a pure number with no units.",
            "solution": "The problem requires the computation of the base-$10$ logarithm of the Bayes factor, $K$, which compares two models for the genetic state of a tumor at a specific locus. The Bayes factor is the ratio of the marginal likelihoods of the observed data under each model.\n\nFirst, we establish the framework for the likelihood calculation. The data, $D$, consists of observing $k=20$ reads for the $B$ allele out of a total of $N=100$ sequencing reads. The problem states that the reads are independent and identically distributed Bernoulli trials. This implies that the number of $B$ allele reads, $k$, follows a binomial distribution, conditional on the true fraction of the $B$ allele, $\\theta$, in the sequenced DNA pool. The probability mass function (PMF) for observing $k$ successes in $N$ trials is given by:\n$$P(k|\\theta, N) = \\binom{N}{k} \\theta^k (1-\\theta)^{N-k}$$\n\nThe expected fraction of the $B$ allele, $\\theta$, depends on the model under consideration. The total DNA in the sample is a mixture of DNA from cancer cells (with fraction $p$) and noncancer cells (with fraction $1-p$). The overall allele fraction $\\theta$ is the weighted average of the fractions in the two cell populations. All noncancer cells are germline heterozygous $A/B$, so the fraction of the $B$ allele in this population is $0.5$.\n\nLet's analyze each model separately.\n\n**Model $\\mathcal{M}_0$: No Loss of Heterozygosity**\nUnder this model, the cancer cells retain their heterozygous $A/B$ genotype.\n- Fraction of $B$ allele in cancer cells: $0.5$.\n- Fraction of $B$ allele in noncancer cells: $0.5$.\n\nThe overall fraction of the $B$ allele, $\\theta_0$, is:\n$$\\theta_0 = p \\times (0.5) + (1-p) \\times (0.5) = 0.5p + 0.5 - 0.5p = 0.5$$\nThe likelihood of the data under model $\\mathcal{M}_0$ is the probability of observing $k$ reads for the $B$ allele given $\\theta_0 = 0.5$:\n$$P(D|\\mathcal{M}_0) = P(k=20 | \\theta_0=0.5, N=100) = \\binom{100}{20} (0.5)^{20} (1-0.5)^{100-20} = \\binom{100}{20} (0.5)^{100}$$\n\n**Model $\\mathcal{M}_1$: Copy-Neutral Loss of Heterozygosity**\nThis model is a mixture of two sub-models, which we denote $\\mathcal{M}_{1,A/A}$ (cancer cells are homozygous $A/A$) and $\\mathcal{M}_{1,B/B}$ (cancer cells are homozygous $B/B$). The problem states these have equal prior probability, $P(\\mathcal{M}_{1,A/A}|\\mathcal{M}_1) = P(\\mathcal{M}_{1,B/B}|\\mathcal{M}_1) = 0.5$.\n\nThe marginal likelihood for $\\mathcal{M}_1$ is computed using the law of total probability:\n$$P(D|\\mathcal{M}_1) = P(D|\\mathcal{M}_{1,A/A})P(\\mathcal{M}_{1,A/A}|\\mathcal{M}_1) + P(D|\\mathcal{M}_{1,B/B})P(\\mathcal{M}_{1,B/B}|\\mathcal{M}_1)$$\n$$P(D|\\mathcal{M}_1) = 0.5 \\times P(D|\\mathcal{M}_{1,A/A}) + 0.5 \\times P(D|\\mathcal{M}_{1,B/B})$$\n\nWe need to calculate the likelihood for each sub-model.\n- **Sub-model $\\mathcal{M}_{1,A/A}$**: Cancer cells are $A/A$.\n  - Fraction of $B$ allele in cancer cells: $0$.\n  - Fraction of $B$ allele in noncancer cells: $0.5$.\n  - The overall fraction of the $B$ allele, $\\theta_{1,A/A}$, is:\n    $$\\theta_{1,A/A} = p \\times (0) + (1-p) \\times (0.5) = 0.5(1-p)$$\n  - The likelihood for this sub-model is:\n    $$P(D|\\mathcal{M}_{1,A/A}) = \\binom{N}{k} (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k}$$\n\n- **Sub-model $\\mathcal{M}_{1,B/B}$**: Cancer cells are $B/B$.\n  - Fraction of $B$ allele in cancer cells: $1$.\n  - Fraction of $B$ allele in noncancer cells: $0.5$.\n  - The overall fraction of the $B$ allele, $\\theta_{1,B/B}$, is:\n    $$\\theta_{1,B/B} = p \\times (1) + (1-p) \\times (0.5) = p + 0.5 - 0.5p = 0.5(1+p)$$\n  - The likelihood for this sub-model is:\n    $$P(D|\\mathcal{M}_{1,B/B}) = \\binom{N}{k} (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k}$$\n\nCombining these, the marginal likelihood for $\\mathcal{M}_1$ is:\n$$P(D|\\mathcal{M}_1) = 0.5 \\binom{N}{k} \\left[ (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k} + (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k} \\right]$$\n\nNow we can compute the Bayes factor, $K$, in favor of $\\mathcal{M}_1$ over $\\mathcal{M}_0$:\n$$K = \\frac{P(D|\\mathcal{M}_1)}{P(D|\\mathcal{M}_0)} = \\frac{0.5 \\binom{N}{k} \\left[ (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k} + (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k} \\right]}{\\binom{N}{k} (0.5)^N}$$\nThe combinatorial term $\\binom{N}{k}$ cancels out:\n$$K = \\frac{0.5 \\left[ (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k} + (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k} \\right]}{(0.5)^N} = 2^{N-1} \\left[ (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k} + (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k} \\right]$$\n\nWe substitute the given numerical values: $p = 0.70$, $N=100$, and $k=20$.\nFirst, calculate the allele fractions for model $\\mathcal{M}_1$:\n$$\\theta_{1,A/A} = 0.5(1-0.70) = 0.5(0.30) = 0.15$$\n$$1 - \\theta_{1,A/A} = 1 - 0.15 = 0.85$$\n$$\\theta_{1,B/B} = 0.5(1+0.70) = 0.5(1.70) = 0.85$$\n$$1 - \\theta_{1,B/B} = 1 - 0.85 = 0.15$$\nSubstituting these into the expression for $K$:\n$$K = 2^{100-1} \\left[ (0.15)^{20} (0.85)^{100-20} + (0.85)^{20} (0.15)^{100-20} \\right]$$\n$$K = 2^{99} \\left[ (0.15)^{20} (0.85)^{80} + (0.85)^{20} (0.15)^{80} \\right]$$\n\nThe final step is to compute the base-$10$ logarithm of $K$:\n$$\\log_{10}(K) = \\log_{10}\\left(2^{99} \\left[ (0.15)^{20} (0.85)^{80} + (0.85)^{20} (0.15)^{80} \\right]\\right)$$\nUsing the properties of logarithms:\n$$\\log_{10}(K) = 99 \\log_{10}(2) + \\log_{10}\\left( (0.15)^{20} (0.85)^{80} + (0.85)^{20} (0.15)^{80} \\right)$$\nLet's evaluate the two terms inside the sum separately.\nLet $T_1 = (0.15)^{20} (0.85)^{80}$ and $T_2 = (0.85)^{20} (0.15)^{80}$.\n$$\\log_{10}(T_1) = 20 \\log_{10}(0.15) + 80 \\log_{10}(0.85)$$\n$$\\log_{10}(T_2) = 20 \\log_{10}(0.85) + 80 \\log_{10}(0.15)$$\nUsing standard values $\\log_{10}(0.15) \\approx -0.8239$ and $\\log_{10}(0.85) \\approx -0.07058$:\n$$\\log_{10}(T_1) \\approx 20(-0.8239) + 80(-0.07058) = -16.478 - 5.6464 = -22.1244$$\n$$\\log_{10}(T_2) \\approx 20(-0.07058) + 80(-0.8239) = -1.4116 - 65.912 = -67.3236$$\nSince $\\log_{10}(T_2)$ is much more negative than $\\log_{10}(T_1)$, $T_2$ is many orders of magnitude smaller than $T_1$. Therefore, the sum $T_1 + T_2 \\approx T_1$. We can formalize this:\n$$T_1 + T_2 = T_1 \\left(1 + \\frac{T_2}{T_1}\\right)$$\n$$\\log_{10}(T_1 + T_2) = \\log_{10}(T_1) + \\log_{10}\\left(1 + \\frac{T_2}{T_1}\\right)$$\nThe ratio $\\frac{T_2}{T_1} = \\frac{10^{-67.3236}}{10^{-22.1244}} = 10^{-45.1992}$, which is a number extremely close to zero. The term $\\log_{10}(1 + 10^{-45.1992})$ is infinitesimally small and can be safely neglected.\nThus, $\\log_{10}(T_1+T_2) \\approx \\log_{10}(T_1)$.\n\nNow, we compute $\\log_{10}(K)$:\n$$\\log_{10}(K) \\approx 99 \\log_{10}(2) + \\log_{10}(T_1)$$\n$$\\log_{10}(K) \\approx 99 \\log_{10}(2) + 20 \\log_{10}(0.15) + 80 \\log_{10}(0.85)$$\nUsing higher precision values:\n$\\log_{10}(2) \\approx 0.3010300$\n$\\log_{10}(0.15) \\approx -0.8239087$\n$\\log_{10}(0.85) \\approx -0.0705811$\n$$\\log_{10}(K) \\approx 99(0.3010300) + 20(-0.8239087) + 80(-0.0705811)$$\n$$\\log_{10}(K) \\approx 29.80197 - 16.478174 - 5.646488$$\n$$\\log_{10}(K) \\approx 7.677308$$\nRounding the result to four significant figures gives $7.677$.",
            "answer": "$$\\boxed{7.677}$$"
        },
        {
            "introduction": "This practice shifts our focus from changes in copy number (aneuploidy) to changes in chromosomal structure (rearrangements). Reconstructing the complex history of inversions, translocations, and other events that scramble a cancer genome requires a powerful theoretical framework. This exercise introduces the breakpoint graph, a cornerstone of computational genomics, which elegantly represents the differences between two genomes . By building this graph and analyzing its structure, you will implement a classic algorithm to calculate the minimal number of rearrangement events separating two genomes, providing a quantitative measure of genomic instability.",
            "id": "4321983",
            "problem": "Consider two cancer genomes represented as collections of circular chromosomes composed of oriented gene segments. Each gene segment is represented by an integer label $g \\in \\{1,2,\\dots,n\\}$ with an orientation denoted by a sign: a positive orientation $+g$ means the segment runs from its tail extremity $g_t$ to its head extremity $g_h$ when read in the chromosome order, while a negative orientation $-g$ means the segment runs from its head extremity $g_h$ to its tail extremity $g_t$ when read in the chromosome order. A circular chromosome is a cyclic list of signed integers in which the adjacency between consecutive segments wraps around at the end back to the start.\n\nThe Breakpoint Graph is constructed as follows. Build a vertex set containing all gene extremities $\\{g_t,g_h\\}$ for all $g$ present in either genome. For each genome, add colored adjacency edges between extremities. For two consecutive signed segments $x$ and $y$ in a circular chromosome, define the adjacency edge as the unordered pair connecting the right extremity of $x$ to the left extremity of $y$, where the left and right extremities are given by:\n- If $x=+g$, then $\\text{left}(x)=g_t$ and $\\text{right}(x)=g_h$.\n- If $x=-g$, then $\\text{left}(x)=g_h$ and $\\text{right}(x)=g_t$.\nSimilarly for $y$. For circular chromosomes, also add the adjacency that connects the right extremity of the last segment to the left extremity of the first segment. Color the adjacency edges from the first genome black and those from the second genome gray. The resulting two-colored graph on extremities is the Breakpoint Graph. In this graph, each vertex has degree exactly $2$ (one black and one gray incident edge) if both genomes contain the same set of gene labels.\n\nUnder the double-cut-and-join (DCJ) model, which is a well-tested abstraction for genome rearrangements including inversions, translocations, and other 2-break events, the minimal number of 2-break operations needed to transform one circular genome into another can be derived from fundamental properties of the Breakpoint Graph. Specifically, for circular genomes with identical gene content, the minimal number of operations is a function of the number of cycles in the Breakpoint Graph formed by alternating black and gray edges.\n\nYour task is to implement a program that, for each of the provided test cases, constructs the Breakpoint Graph for the pair of cancer genomes and computes the minimal number of 2-break operations required to transform the first genome into the second. Assume both genomes in each test case have identical gene content and are composed solely of circular chromosomes.\n\nDefinitions and requirements:\n- Let $n$ denote the total number of distinct gene labels (absolute values) present in the pair of genomes for a given test case.\n- Construct the Breakpoint Graph using the rules above.\n- Decompose the graph into disjoint cycles by alternately traversing black and gray edges.\n- Let $c$ denote the number of cycles in the Breakpoint Graph for the test case.\n- Compute the minimal number of 2-break operations required as an integer using the cycle count and the total number of genes.\n\nTest suite:\nFor each test case, the two genomes are given as lists of circular chromosomes, where each chromosome is itself a list of signed integers. The four test cases are:\n\n1. Genome A: one circular chromosome $[1,-2,3,4]$; Genome B: one circular chromosome $[-2,1,4,3]$.\n2. Genome A: one circular chromosome $[1,2,3,4,5]$; Genome B: one circular chromosome $[1,2,3,4,5]$.\n3. Genome A: one circular chromosome $[1,2,3,4,5,6]$; Genome B: one circular chromosome $[4,-5,6,-1,2,-3]$.\n4. Genome A: one circular chromosome $[1,-2,-3,4,-5,6]$; Genome B: one circular chromosome $[-1,2,-3,-4,5,-6]$.\n\nAnswer specification:\n- For each test case, output a single integer equal to the minimal number of 2-break operations required.\n- Aggregate the results for all test cases into a single line containing a comma-separated list enclosed in square brackets, for example, $[a,b,c,d]$, where $a$, $b$, $c$, and $d$ are integers.\n\nNo physical units, angle units, or percentages are involved. The program must produce precisely one line of output in the specified format.",
            "solution": "The problem requires the calculation of the minimum number of double-cut-and-join (DCJ) operations to transform one cancer genome into another. Both genomes are composed of circular chromosomes with identical gene content. This distance can be calculated using a structure known as the Breakpoint Graph.\n\nFirst, we establish a formal representation for the components of the genomes. A gene with label $g$ has two extremities: a tail $g_t$ and a head $g_h$. We can map these extremities to a unique pair of integers. For a gene label $g \\in \\{1, 2, \\dots, n\\}$, we define the mapping:\n$$\ng_t \\mapsto 2g - 1\n$$\n$$\ng_h \\mapsto 2g\n$$\nThe set of all vertices in our graph will be the set of integers $\\{1, 2, \\dots, 2n\\}$. The orientation of a gene segment determines the order of its extremities. A segment $+g$ runs from $g_t$ to $g_h$, while a segment $-g$ runs from $g_h$ to $g_t$. We can define the left and right extremities of a signed gene segment $x$ as follows:\n- If $x = +g$, then $\\text{left}(x) = g_t \\mapsto 2g-1$ and $\\text{right}(x) = g_h \\mapsto 2g$.\n- If $x = -g$, then $\\text{left}(x) = g_h \\mapsto 2g$ and $\\text{right}(x) = g_t \\mapsto 2g-1$.\n\nThe Breakpoint Graph is constructed on this set of $2n$ vertices. For each genome, we add adjacency edges. In a circular chromosome, for any two consecutive gene segments $x$ and $y$, an adjacency is formed between the right extremity of $x$ and the left extremity of $y$. This also applies to the last and first segments, creating a cycle. The adjacencies from the first genome (Genome A) are colored black, and those from the second genome (Genome B) are colored gray.\n\nSince both genomes contain the same set of $n$ genes, each extremity vertex will have exactly one black edge and one gray edge incident upon it. Consequently, the entire Breakpoint Graph decomposes into a set of disjoint cycles where the edges alternate in color (black, gray, black, gray, ...).\n\nThe DCJ distance, denoted $d_{DCJ}(A, B)$, for two genomes A and B composed solely of circular chromosomes with identical gene content is given by the formula:\n$$\nd_{DCJ}(A, B) = n - c\n$$\nwhere $n$ is the number of genes and $c$ is the number of alternating black-gray cycles in the Breakpoint Graph.\n\nOur task is to compute $c$ for each test case. A robust method for counting these cycles involves defining a permutation on the set of vertices. Let $\\text{adj}_A(v)$ be the vertex connected to $v$ by a black edge, and $\\text{adj}_B(v)$ be the vertex connected to $v$ by a gray edge. A \"step\" in an alternating cycle from a vertex $v$ first traverses a black edge to $\\text{adj}_A(v)$ and then a gray edge to $\\text{adj}_B(\\text{adj}_A(v))$. We can define a permutation $p$ on the vertices $\\{1, 2, \\dots, 2n\\}$ as:\n$$\np(v) = \\text{adj}_B(\\text{adj}_A(v))\n$$\nThis permutation $p$ captures the transitions after a black-gray edge pair. An important structural property relates the cycles of the Breakpoint Graph to the cycles of this permutation. Each alternating black-gray cycle in the Breakpoint Graph, consisting of $2k$ vertices $\\{v_1, v_2, \\ldots, v_{2k}\\}$, is decomposed by the permutation $p$ into two disjoint permutation cycles of length $k$. One cycle involves the odd-indexed vertices $(v_1, v_3, \\ldots, v_{2k-1})$ and the other involves the even-indexed vertices $(v_2, v_4, \\ldots, v_{2k})$ (with indices reordered).\n\nTherefore, if $c_p$ is the number of cycles in the permutation $p$, the number of alternating cycles in the Breakpoint Graph is $c = c_p / 2$. The DCJ distance formula can then be written as:\n$$\nd_{DCJ}(A, B) = n - \\frac{c_p}{2}\n$$\n\nThe algorithm proceeds as follows:\n1.  For each pair of genomes, determine the total number of unique genes, $n$.\n2.  Construct the adjacency maps, $\\text{adj}_A$ and $\\text{adj}_B$, based on the given chromosome structures. This involves iterating through each chromosome, identifying consecutive gene segments, and adding edges between their corresponding extremity vertices according to the rules.\n3.  Count the number of cycles, $c_p$, in the permutation $p$ defined by the composition of $\\text{adj}_A$ and $\\text{adj}_B$. This is a standard algorithm: iterate through all vertices from $1$ to $2n$. If a vertex has not yet been visited, start a traversal from it, following the permutation map $v \\mapsto p(v)$ until returning to the start, marking all vertices in the discovered cycle as visited. Increment a cycle counter for each new cycle found.\n4.  Calculate the final distance using the formula $d = n - c_p / 2$.\n\nThis procedure is applied to each of the four test cases provided.",
            "answer": "[2,0,3,5]"
        }
    ]
}