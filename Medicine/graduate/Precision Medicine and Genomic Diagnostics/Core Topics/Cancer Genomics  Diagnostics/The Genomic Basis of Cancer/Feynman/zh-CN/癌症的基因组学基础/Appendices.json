{
    "hands_on_practices": [
        {
            "introduction": "肿瘤活检样本通常是癌细胞和正常细胞的混合物，这使得对测序数据的解读变得复杂。本练习将指导您如何通过数学方法校正这种混合效应，从而推断出突变在癌细胞群体中的真实频率。掌握这项技能对于理解获得性耐药等关键的肿瘤演化概念至关重要，例如在本例中分析的EGFR T790M耐药突变 。",
            "id": "4390906",
            "problem": "一名转移性非小细胞肺癌患者在治疗前被发现携带一个克隆性的表皮生长因子受体（EGFR）外显子19缺失。治疗后疾病进展，对肿瘤进行了再次活检。靶向二代测序报告显示EGFR T790M变异等位基因频率（VAF）为$0.2$，独立的病理学评估确定肿瘤纯度$p=0.5$。对EGFR位点的拷贝数分析显示，肿瘤总拷贝数$C_{t}=2$，且无杂合性缺失。假设如下：正常（非癌）细胞是二倍体，每个位点有$2$个拷贝；测序读数是等位基因的无偏样本；T790M替换在癌细胞中存在时，位于单个等位基因上（多重性$m=1$）；EGFR外显子19缺失保持克隆性，为T790M的出现提供了背景。令癌细胞分数（CCF）$f$表示携带T790M的癌细胞的比例。仅使用肿瘤-正常组织混合和等位基因计数的第一性原理，推导用观测到的VAF、$p$、$C_{t}$和$m$表示$f$的表达式，然后计算给定值下的$f$。说明推断出的$f$更符合克隆性出现（$f \\approx 1$）还是亚克隆性出现（$f  1$），并定性地论证你的推理。将$f$的数值报告为0到1之间的一个纯数。无需四舍五入；报告由给定数字得出的确切值。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它具有科学依据、问题良定且客观。它提出了一个肿瘤基因组学中的标准、现实的问题，可以使用第一性原理解决。所有必要的数据和假设都已提供，没有矛盾或模糊之处。\n\n该问题要求从测序数据中推导亚克隆突变的癌细胞分数（$f$）。我们已知以下参数：\n- EGFR T790M突变的观测变异等位基因频率，$\\text{VAF} = 0.2$。\n- 样本的肿瘤纯度，$p = 0.5$。这是样本中癌细胞的比例。\n- 肿瘤细胞中EGFR位点的总拷贝数，$C_{t} = 2$。\n- 突变癌细胞中T790M突变的多重性，$m = 1$。这意味着在携带该突变的细胞中，该突变是杂合的。\n\n我们还被给予以下假设，这些假设在这类分析中是标准的：\n- 正常、非癌细胞是二倍体，意味着它们在该位点的拷贝数为$C_{n} = 2$。\n- 测序提供了对组织样本中存在的所有等位基因的无偏抽样。\n\n变异等位基因频率（VAF）定义为映射到变异等位基因的测序读数数量与映射到该基因组位点的总读数数量之比。假设是无偏抽样，该比例反映了组织样本中该位点上变异等位基因与总等位基因的比例。\n\n让我们基于肿瘤和正常细胞的混合来构建VAF的表达式。总样本由比例为$p$的肿瘤细胞和比例为$1-p$的正常细胞组成。\n\nVAF的分子对应于变异等位基因（T790M）的贡献。变异等位基因仅存在于比例为$f$的癌细胞中。\n样本中变异等位基因的数量与以下各项成正比：\n（癌细胞比例） $\\times$ （携带突变的癌细胞比例） $\\times$ （每个突变癌细胞的变异等位基因数量）\n$$ \\text{变异等位基因数量} \\propto p \\cdot f \\cdot m $$\n\nVAF的分母对应于样本中所有细胞（包括肿瘤和正常细胞）在EGFR位点的总等位基因数量。\n来自肿瘤细胞群体的总等位基因数量与以下各项成正比：\n（癌细胞比例） $\\times$ （一个癌细胞中的总拷贝数）\n$$ \\text{来自肿瘤细胞的总等位基因} \\propto p \\cdot C_{t} $$\n来自正常细胞群体的总等位基因数量与以下各项成正比：\n（正常细胞比例） $\\times$ （一个正常细胞中的总拷贝数）\n$$ \\text{来自正常细胞的总等位基因} \\propto (1-p) \\cdot C_{n} $$\n整个样本中的总等位基因数量是这两部分贡献的总和：\n$$ \\text{样本中的总等位基因} \\propto p \\cdot C_{t} + (1-p) \\cdot C_{n} $$\n\nVAF是这些数量的比率：\n$$ \\text{VAF} = \\frac{p \\cdot f \\cdot m}{p \\cdot C_{t} + (1-p) \\cdot C_{n}} $$\n\n这是将VAF与肿瘤样本的生物学参数关联起来的通用表达式。问题要求我们推导癌细胞分数$f$的表达式。我们可以重新整理该方程来解出$f$：\n$$ f = \\frac{\\text{VAF} \\cdot (p \\cdot C_{t} + (1-p) \\cdot C_{n})}{p \\cdot m} $$\n\n现在，我们可以将给定的数值代入此表达式来计算$f$：\n$\\text{VAF} = 0.2$\n$p = 0.5$\n$C_{t} = 2$\n$m = 1$\n$C_{n} = 2$\n\n将这些值代入$f$的方程：\n$$ f = \\frac{0.2 \\cdot (0.5 \\cdot 2 + (1-0.5) \\cdot 2)}{0.5 \\cdot 1} $$\n首先，我们计算括号中的项，它代表了样本中该位点的平均细胞倍性：\n$$ p \\cdot C_{t} + (1-p) \\cdot C_{n} = 0.5 \\cdot 2 + 0.5 \\cdot 2 = 1 + 1 = 2 $$\n这个结果是预料之中的，因为肿瘤细胞和正常细胞在该位点都是二倍体，所以无论纯度如何，平均拷贝数都是2。\n\n现在，将这个结果代回$f$的表达式中：\n$$ f = \\frac{0.2 \\cdot 2}{0.5 \\cdot 1} $$\n$$ f = \\frac{0.4}{0.5} $$\n$$ f = 0.8 $$\n\n计算出的癌细胞分数为$f=0.8$。这意味着在活检的肿瘤群体中，T790M突变存在于$80\\%$的癌细胞中。\n\n问题要求判断这一发现更符合克隆性出现还是亚克隆性出现。\n- **克隆性突变**是指存在于所有或几乎所有癌细胞中的突变。在这个数学框架中，这对应于$f \\approx 1$。\n- **亚克隆突变**是指存在于癌细胞一个特定亚群中的突变。这对应于$f  1$。\n\n由于我们计算出的值为$f=0.8$，这明显小于$1$，因此T790M突变的出现是亚克隆性的。最初的EGFR外显子19缺失是克隆性的，意味着它存在于$100\\%$的肿瘤创始细胞中。治疗后，这些癌细胞的一个亚群（占当前癌细胞群体的$80\\%$）获得了继发的T790M突变，这是获得性耐药的典型模式。剩下的$20\\%$的癌细胞属于未获得此特定耐药突变的原始克隆。",
            "answer": "$$\\boxed{0.8}$$"
        },
        {
            "introduction": "CRISPR基因编辑技术已成为高通量探测基因功能的重要工具。本练习将带您分析一个模拟的CRISPR筛选实验数据，以识别“合成致死”的基因靶点，这一概念是开发靶向癌症疗法（尤其针对像BRCA1缺陷型癌症）的基石。通过这个练习，您将亲手实践如何分析筛选数据，并运用统计学标准来识别具有潜力的治疗靶点 。",
            "id": "4390888",
            "problem": "一项混合式 Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR) 负向选择筛选通过测量单导向RNA（single-guide RNA）丰度随时间变化的对数倍数变化（log-fold changes, LFCs）来评估基因破坏对细胞活力的影响。在此类筛选中，更负的对数倍数变化表示更强的细胞耗竭，因此基因具有更高的必需性。考虑两种同基因细胞背景：乳腺癌1号易感基因 (*BRCA1*) 缺陷型和 *BRCA1* 功能正常型。对于一组5个基因中的每个基因 $g$，该筛选在 *BRCA1* 缺陷型背景下产生3个 LFC 重复样本，在 *BRCA1* 功能正常型背景下也产生3个 LFC 重复样本。假设重复样本是独立的，近似服从正态分布，并且在两种背景下具有相同的基因内方差。\n\n给定每个基因的以下重复对数倍数变化 (LFCs)：\n- 基因 $1$ (*PARP1*)：*BRCA1* 缺陷型 $[-2.1, -2.0, -1.9]$；*BRCA1* 功能正常型 $[-0.6, -0.5, -0.4]$。\n- 基因 $2$ (*POLQ*)：*BRCA1* 缺陷型 $[-1.3, -1.2, -1.1]$；*BRCA1* 功能正常型 $[-0.4, -0.3, -0.2]$。\n- 基因 $3$ (*RAD52*)：*BRCA1* 缺陷型 $[-0.9, -0.8, -0.7]$；*BRCA1* 功能正常型 $[-0.30, -0.25, -0.20]$。\n- 基因 $4$ (*ATR*)：*BRCA1* 缺陷型 $[-1.2, -1.1, -1.0]$；*BRCA1* 功能正常型 $[-1.00, -0.95, -0.90]$。\n- 基因 $5$ (*RPL3*)：*BRCA1* 缺陷型 $[-1.10, -1.05, -1.00]$；*BRCA1* 功能正常型 $[-1.10, -1.05, -1.00]$。\n\n对于基因 $g$，定义 *BRCA1* 缺陷型背景下的平均对数倍数变化为 $\\bar{L}_{\\mathrm{def},g}$，*BRCA1* 功能正常型背景下的平均对数倍数变化为 $\\bar{L}_{\\mathrm{prof},g}$。差异必需性定义为\n$$\n\\Delta_g = \\bar{L}_{\\mathrm{def},g} - \\bar{L}_{\\mathrm{prof},g}.\n$$\n如果一个基因同时满足 $\\Delta_g \\leq -0.5$ 和双样本合并方差 $t$-统计量 $t_g \\leq -3$ 这两个条件，则被认为是合成致死候选基因，其中\n$$\nt_g = \\frac{\\bar{L}_{\\mathrm{def},g} - \\bar{L}_{\\mathrm{prof},g}}{\\sqrt{s_{p,g}^{2}\\left(\\frac{1}{n_{\\mathrm{def}}}+\\frac{1}{n_{\\mathrm{prof}}}\\right)}},\n\\quad\ns_{p,g}^{2} = \\frac{(n_{\\mathrm{def}}-1)s_{\\mathrm{def},g}^{2}+(n_{\\mathrm{prof}}-1)s_{\\mathrm{prof},g}^{2}}{n_{\\mathrm{def}}+n_{\\mathrm{prof}}-2},\n$$\n其中 $n_{\\mathrm{def}}=n_{\\mathrm{prof}}=3$，$s_{\\mathrm{def},g}^{2}$ 和 $s_{\\mathrm{prof},g}^{2}$ 分别是相应背景下 LFC 重复样本的样本方差。\n\n令 $\\mathcal{C}$ 为满足这两个标准的基因集合。计算\n$$\nS = \\sum_{g \\in \\mathcal{C}} |\\Delta_g|.\n$$\n将 $S$ 表示为一个无量纲数，并将答案四舍五入到四位有效数字。",
            "solution": "用户要求对一个涉及分析 CRISPR 筛选数据以识别合成致死候选基因的问题提供详细解答。根据说明，第一步是验证问题陈述。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- **实验类型**：混合式 CRISPR 负向选择筛选。\n- **细胞背景**：*BRCA1* 缺陷型和 *BRCA1* 功能正常型同基因细胞。\n- **基因**：一组5个基因，标记为 $g=1, \\dots, 5$。\n- **每个基因的数据**：在 *BRCA1* 缺陷型背景下有 $n_{\\mathrm{def}} = 3$ 个 LFC 重复样本，在 *BRCA1* 功能正常型背景下有 $n_{\\mathrm{prof}} = 3$ 个 LFC 重复样本。\n- **数据值**：\n  - 基因 $1$：def $[-2.1, -2.0, -1.9]$；prof $[-0.6, -0.5, -0.4]$。\n  - 基因 $2$：def $[-1.3, -1.2, -1.1]$；prof $[-0.4, -0.3, -0.2]$。\n  - 基因 $3$：def $[-0.9, -0.8, -0.7]$；prof $[-0.30, -0.25, -0.20]$。\n  - 基因 $4$：def $[-1.2, -1.1, -1.0]$；prof $[-1.00, -0.95, -0.90]$。\n  - 基因 $5$：def $[-1.10, -1.05, -1.00]$；prof $[-1.10, -1.05, -1.00]$。\n- **假设**：重复样本是独立的，近似服从正态分布，并且在两种背景下具有相同的基因内方差。\n- **定义**：\n  - 平均 LFC：$\\bar{L}_{\\mathrm{def},g}$ 和 $\\bar{L}_{\\mathrm{prof},g}$。\n  - 差异必需性：$\\Delta_g = \\bar{L}_{\\mathrm{def},g} - \\bar{L}_{\\mathrm{prof},g}$。\n- **候选标准**：如果一个基因 $g$ 属于集合 $\\mathcal{C}$，则其为合成致死候选基因，这需要满足两个条件：\n  1. $\\Delta_g \\leq -0.5$\n  2. $t_g \\leq -3$\n- **公式**：\n  - 合并方差：$s_{p,g}^{2} = \\frac{(n_{\\mathrm{def}}-1)s_{\\mathrm{def},g}^{2}+(n_{\\mathrm{prof}}-1)s_{\\mathrm{prof},g}^{2}}{n_{\\mathrm{def}}+n_{\\mathrm{prof}}-2}$。\n  - $t$-统计量：$t_g = \\frac{\\bar{L}_{\\mathrm{def},g} - \\bar{L}_{\\mathrm{prof},g}}{\\sqrt{s_{p,g}^{2}\\left(\\frac{1}{n_{\\mathrm{def}}}+\\frac{1}{n_{\\mathrm{prof}}}\\right)}}$。\n- **要求计算**：计算 $S = \\sum_{g \\in \\mathcal{C}} |\\Delta_g|$ 并四舍五入到四位有效数字。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题在功能基因组学和精准肿瘤学领域有充分的科学依据。CRISPR 筛选、合成致死的概念（尤其是在 BRCA 缺陷和 PARP 抑制剂如 *PARP1* 的背景下），以及统计方法（带合并方差的双样本 $t$-检验）都是标准且科学合理的。\n- **问题的适定性**：问题提供了所有必要的数据、明确的公式和无歧义的标准。可以确定性地计算出唯一解。\n- **客观性**：语言精确且量化，没有任何主观或推测性成分。\n- **缺陷分析**：该问题没有违反任何指定的无效标准。它是完整的、一致的、现实的，并且结构严谨。\n\n**第3步：结论和行动**\n- **结论**：问题有效。\n- **行动**：继续解答。\n\n### 解答\n\n目标是确定5个基因中哪些满足成为合成致死候选基因的两个给定标准，然后将它们的差异必需性得分 $\\Delta_g$ 的绝对值相加。\n\n对于一组包含 $n$ 个测量值 $\\{x_i\\}$ 且均值为 $\\bar{x}$ 的数据，其样本方差由 $s^2 = \\frac{1}{n-1}\\sum_{i=1}^n(x_i - \\bar{x})^2$ 给出。\n给定 $n_{\\mathrm{def}} = n_{\\mathrm{prof}} = 3$，合并方差和 $t$-统计量的公式简化为：\n合并方差为：\n$$\ns_{p,g}^{2} = \\frac{(3-1)s_{\\mathrm{def},g}^{2}+(3-1)s_{\\mathrm{prof},g}^{2}}{3+3-2} = \\frac{2s_{\\mathrm{def},g}^{2}+2s_{\\mathrm{prof},g}^{2}}{4} = \\frac{s_{\\mathrm{def},g}^{2}+s_{\\mathrm{prof},g}^{2}}{2}\n$$\n$t$-统计量为：\n$$\nt_g = \\frac{\\Delta_g}{\\sqrt{s_{p,g}^{2}\\left(\\frac{1}{3}+\\frac{1}{3}\\right)}} = \\frac{\\Delta_g}{\\sqrt{\\frac{2s_{p,g}^{2}}{3}}}\n$$\n\n我们现在逐个分析每个基因。\n\n**基因 1 (*PARP1*)**\n- 数据：def: $[-2.1, -2.0, -1.9]$；prof: $[-0.6, -0.5, -0.4]$。\n- 平均 LFC：\n  - $\\bar{L}_{\\mathrm{def},1} = \\frac{-2.1 - 2.0 - 1.9}{3} = -2.0$。\n  - $\\bar{L}_{\\mathrm{prof},1} = \\frac{-0.6 - 0.5 - 0.4}{3} = -0.5$。\n- 差异必需性：$\\Delta_1 = \\bar{L}_{\\mathrm{def},1} - \\bar{L}_{\\mathrm{prof},1} = -2.0 - (-0.5) = -1.5$。\n- 标准 1：$\\Delta_1 = -1.5 \\leq -0.5$。此条件满足。\n- 样本方差：\n  - $s_{\\mathrm{def},1}^{2} = \\frac{1}{2}[(-2.1 - (-2.0))^2 + (-2.0 - (-2.0))^2 + (-1.9 - (-2.0))^2] = \\frac{1}{2}[(-0.1)^2 + 0^2 + (0.1)^2] = \\frac{0.02}{2} = 0.01$。\n  - $s_{\\mathrm{prof},1}^{2} = \\frac{1}{2}[(-0.6 - (-0.5))^2 + (-0.5 - (-0.5))^2 + (-0.4 - (-0.5))^2] = \\frac{1}{2}[(-0.1)^2 + 0^2 + (0.1)^2] = \\frac{0.02}{2} = 0.01$。\n- 合并方差：$s_{p,1}^{2} = \\frac{0.01 + 0.01}{2} = 0.01$。\n- $t$-统计量：$t_1 = \\frac{-1.5}{\\sqrt{0.01 \\cdot (\\frac{2}{3})}} = \\frac{-1.5}{0.1\\sqrt{2/3}} = -15\\sqrt{\\frac{3}{2}} = -\\frac{15\\sqrt{6}}{2} \\approx -18.37$。\n- 标准 2：$t_1 \\approx -18.37 \\leq -3$。此条件满足。\n- 结论：基因1是候选基因。$|\\Delta_1| = 1.5$。\n\n**基因 2 (*POLQ*)**\n- 数据：def: $[-1.3, -1.2, -1.1]$；prof: $[-0.4, -0.3, -0.2]$。\n- 平均 LFC：\n  - $\\bar{L}_{\\mathrm{def},2} = \\frac{-1.3 - 1.2 - 1.1}{3} = -1.2$。\n  - $\\bar{L}_{\\mathrm{prof},2} = \\frac{-0.4 - 0.3 - 0.2}{3} = -0.3$。\n- 差异必需性：$\\Delta_2 = -1.2 - (-0.3) = -0.9$。\n- 标准 1：$\\Delta_2 = -0.9 \\leq -0.5$。此条件满足。\n- 样本方差：\n  - $s_{\\mathrm{def},2}^{2} = \\frac{1}{2}[(-1.3 - (-1.2))^2 + (-1.2 - (-1.2))^2 + (-1.1 - (-1.2))^2] = \\frac{1}{2}[(-0.1)^2 + 0^2 + (0.1)^2] = 0.01$。\n  - $s_{\\mathrm{prof},2}^{2} = \\frac{1}{2}[(-0.4 - (-0.3))^2 + (-0.3 - (-0.3))^2 + (-0.2 - (-0.3))^2] = \\frac{1}{2}[(-0.1)^2 + 0^2 + (0.1)^2] = 0.01$。\n- 合并方差：$s_{p,2}^{2} = \\frac{0.01 + 0.01}{2} = 0.01$。\n- $t$-统计量：$t_2 = \\frac{-0.9}{\\sqrt{0.01 \\cdot (\\frac{2}{3})}} = \\frac{-0.9}{0.1\\sqrt{2/3}} = -9\\sqrt{\\frac{3}{2}} = -\\frac{9\\sqrt{6}}{2} \\approx -11.02$。\n- 标准 2：$t_2 \\approx -11.02 \\leq -3$。此条件满足。\n- 结论：基因2是候选基因。$|\\Delta_2| = 0.9$。\n\n**基因 3 (*RAD52*)**\n- 数据：def: $[-0.9, -0.8, -0.7]$；prof: $[-0.30, -0.25, -0.20]$。\n- 平均 LFC：\n  - $\\bar{L}_{\\mathrm{def},3} = \\frac{-0.9 - 0.8 - 0.7}{3} = -0.8$。\n  - $\\bar{L}_{\\mathrm{prof},3} = \\frac{-0.30 - 0.25 - 0.20}{3} = -0.25$。\n- 差异必需性：$\\Delta_3 = -0.8 - (-0.25) = -0.55$。\n- 标准 1：$\\Delta_3 = -0.55 \\leq -0.5$。此条件满足。\n- 样本方差：\n  - $s_{\\mathrm{def},3}^{2} = \\frac{1}{2}[(-0.9 - (-0.8))^2 + (-0.8 - (-0.8))^2 + (-0.7 - (-0.8))^2] = \\frac{1}{2}[(-0.1)^2 + 0^2 + (0.1)^2] = 0.01$。\n  - $s_{\\mathrm{prof},3}^{2} = \\frac{1}{2}[(-0.30 - (-0.25))^2 + (-0.25 - (-0.25))^2 + (-0.20 - (-0.25))^2] = \\frac{1}{2}[(-0.05)^2 + 0^2 + (0.05)^2] = \\frac{0.005}{2} = 0.0025$。\n- 合并方差：$s_{p,3}^{2} = \\frac{0.01 + 0.0025}{2} = 0.00625$。\n- $t$-统计量：$t_3 = \\frac{-0.55}{\\sqrt{0.00625 \\cdot (\\frac{2}{3})}} = \\frac{-0.55}{\\sqrt{0.0125/3}} \\approx \\frac{-0.55}{0.06455} \\approx -8.52$。\n- 标准 2：$t_3 \\approx -8.52 \\leq -3$。此条件满足。\n- 结论：基因3是候选基因。$|\\Delta_3| = 0.55$。\n\n**基因 4 (*ATR*)**\n- 数据：def: $[-1.2, -1.1, -1.0]$；prof: $[-1.00, -0.95, -0.90]$。\n- 平均 LFC：\n  - $\\bar{L}_{\\mathrm{def},4} = \\frac{-1.2 - 1.1 - 1.0}{3} = -1.1$。\n  - $\\bar{L}_{\\mathrm{prof},4} = \\frac{-1.00 - 0.95 - 0.90}{3} = -0.95$。\n- 差异必需性：$\\Delta_4 = -1.1 - (-0.95) = -0.15$。\n- 标准 1：$\\Delta_4 = -0.15 \\leq -0.5$。此条件不满足。\n- 结论：基因4不是候选基因。\n\n**基因 5 (*RPL3*)**\n- 数据：def: $[-1.10, -1.05, -1.00]$；prof: $[-1.10, -1.05, -1.00]$。\n- 平均 LFC：\n  - $\\bar{L}_{\\mathrm{def},5} = \\frac{-1.10 - 1.05 - 1.00}{3} = -1.05$。\n  - $\\bar{L}_{\\mathrm{prof},5} = \\frac{-1.10 - 1.05 - 1.00}{3} = -1.05$。\n- 差异必需性：$\\Delta_5 = -1.05 - (-1.05) = 0$。\n- 标准 1：$\\Delta_5 = 0 \\leq -0.5$。此条件不满足。\n- 结论：基因5不是候选基因。\n\n**最终计算**\n候选基因集合为 $\\mathcal{C} = \\{\\text{基因 } 1, \\text{基因 } 2, \\text{基因 } 3\\}$。\n总和 $S$ 计算如下：\n$$\nS = \\sum_{g \\in \\mathcal{C}} |\\Delta_g| = |\\Delta_1| + |\\Delta_2| + |\\Delta_3|\n$$\n$$\nS = |-1.5| + |-0.9| + |-0.55| = 1.5 + 0.9 + 0.55 = 2.95\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nS = 2.950\n$$",
            "answer": "$$\\boxed{2.950}$$"
        },
        {
            "introduction": "每个癌症基因组都像一本历史书，记录了其形成过程中经历的各种突变过程（如吸烟、紫外线暴露等），这些过程会留下独特的“突变印记”。本练习是一个更高级的计算实践，您将学习如何应用非负最小二乘法（NNLS）等数学工具，对肿瘤的整体突变谱进行解码。通过分解不同突变印记的贡献，我们可以深入了解癌症的病因学，并为治疗提供新的线索 。",
            "id": "4390897",
            "problem": "您面临一项计算任务，其基础是分析癌症中的突变印记，这是精准医疗和基因组诊断的核心任务。其生物学前提是，癌症基因组中的体细胞突变由多种突变过程引起，每种过程在96个单碱基替换（SBS）通道上都留下了特征模式。SBS通道由六种可能的碱基替换定义，每种替换都在其紧邻的侧翼碱基上下文中，从而产生96个通道的分类。根据独立突变过程的效果会叠加的原理，观察到的总突变计数向量可以建模为已知印记的非负线性组合。\n\n基本基础和假设：分子生物学中心法则假定，脱氧核糖核酸（DNA）突变会改变基因组序列，而经过充分检验的癌症基因组学经验观察表明，突变过程在SBS通道上产生特征性的、近似可加的模式。令 $y \\in \\mathbb{R}^{96}_{\\ge 0}$ 表示每个SBS通道观察到的突变计数。令 $S_1 \\in \\mathbb{R}^{96}_{\\ge 0}$ 和 $S_2 \\in \\mathbb{R}^{96}_{\\ge 0}$ 表示两个已知的突变印记，每个都经过归一化，使得对于 $j \\in \\{1,2\\}$，$\\sum_{i=1}^{96} S_{j,i} = 1$。暴露度 $x_1 \\ge 0$ 和 $x_2 \\ge 0$ 量化了印记 $S_1$ 和 $S_2$ 对 $y$ 的贡献。线性模型为 $y \\approx x_1 S_1 + x_2 S_2$，其中未解释部分 $r = y - x_1 S_1 - x_2 S_2$ 捕捉了未被 $S_1$ 和 $S_2$ 代表的过程。为了估计 $(x_1, x_2)$，构建非负最小二乘（NNLS）问题：最小化平方欧几里得范数 $\\lVert y - A x \\rVert_2^2$，约束条件为 $x \\ge 0$，其中 $A \\in \\mathbb{R}^{96 \\times 2}$ 的列是 $S_1$ 和 $S_2$，且 $x = (x_1, x_2)^\\top$。将残差范数分数 $f = \\lVert r \\rVert_2 / \\lVert y \\rVert_2$ 解释为总信号中未被这两个印记解释的部分。所有计数都是无量纲数；不涉及物理单位。所有角度（如有）均不相关；未使用任何角度。\n\n您的任务是编写一个程序，为每个指定的测试用例构建 $S_1$、$S_2$、相应的 $y$，求解 $(x_1, x_2)$ 的NNLS问题，并计算 $f$。每个测试用例的最终输出必须是列表 $[x_1, x_2, f]$，其中每个值都四舍五入到六位小数。将所有测试用例的结果汇总到单行中，形式为一个用方括号括起来的逗号分隔列表，其中每个元素是对应一个测试用例的列表，例如 $[[x_{1,1}, x_{2,1}, f_1],[x_{1,2}, x_{2,2}, f_2],\\dots]$。\n\n按如下方式定义印记和测试用例，以确保可复现性和覆盖范围：\n\n- 印记构建：\n  - 对于 $i \\in \\{1,2,\\dots,96\\}$，定义未归一化的向量 $b_1(i) = i$ 和 $b_2(i) = 97 - i$。\n  - 归一化以获得印记 $S_1(i) = b_1(i) / \\sum_{k=1}^{96} b_1(k)$ 和 $S_2(i) = b_2(i) / \\sum_{k=1}^{96} b_2(k)$。\n  - 令 $A$ 为以 $S_1$ 和 $S_2$ 为列的矩阵。\n\n- 测试套件：\n  1. 理想路径精确混合：$y_1 = 50 \\, S_1 + 30 \\, S_2$。\n  2. 单一暴露度为零的边界条件：$y_2 = 100 \\, S_2$。\n  3. 偏向一个印记的含噪声测量：$y_3 = 60 \\, S_1 + n$，其中对于 $i \\in \\{1,\\dots,96\\}$，$n(i) = 0.1 \\times \\left( (i \\bmod 5) / 5.0 \\right)$。\n  4. 近共线性引起的重新分布：定义 $S_2'(i) = \\left( 0.8 \\, S_1(i) + 0.2 \\, S_2(i) \\right)$ 并通过除以其总和进行重新归一化，使得 $\\sum_{i=1}^{96} S_2'(i) = 1$；令 $y_4 = 40 \\, S_1 + 40 \\, S_2'$。针对列仍为 $S_1$ 和 $S_2$ 的矩阵 $A$ 求解暴露度。\n  5. 张成空间外的未解释过程：定义 $b_3(i) = 1 + 0.5 \\times ((i \\bmod 2))$ 和 $S_3(i) = b_3(i) / \\sum_{k=1}^{96} b_3(k)$；令 $y_5 = 80 \\, S_3$。针对列为 $S_1$ 和 $S_2$ 的矩阵 $A$ 求解暴露度。\n\n- 对于每个测试用例 $t \\in \\{1,2,3,4,5\\}$：\n  - 求解 $x_t = (x_{1,t}, x_{2,t})^\\top = \\arg\\min_{x \\ge 0} \\lVert y_t - A x \\rVert_2^2$。\n  - 计算 $f_t = \\lVert y_t - A x_t \\rVert_2 / \\lVert y_t \\rVert_2$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个条目是相应测试用例的列表 $[x_{1,t}, x_{2,t}, f_t]$。所有值必须四舍五入到六位小数，并表示为不带百分号的小数。不允许用户输入或外部文件。计算必须是纯数值的，并从非负约束下突变印记的线性混合模型的逻辑推导得出。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于癌症基因组学的原理，特别是突变印记分析。问题是适定的，提供了基于非负最小二乘（NNLS）框架的完整且一致的数学公式。语言客观而精确，所有参数和测试条件都已明确定义，从而可以得到唯一且可验证的数值解。该问题是数值优化的一个非平凡应用，正确地将一个真实的科学问题形式化。\n\n任务是求解两个突变印记 $S_1$ 和 $S_2$ 的暴露度 $x_1$ 和 $x_2$，以最佳方式解释观察到的突变计数向量 $y$。这被形式化为一个非负最小二乘（NNLS）优化问题：\n$$\n\\text{minimize } \\lVert y - Ax \\rVert_2^2 \\quad \\text{subject to} \\quad x \\ge 0\n$$\n其中矩阵 $A \\in \\mathbb{R}^{96 \\times 2}$ 以印记 $S_1$ 和 $S_2$ 为其列，$y \\in \\mathbb{R}^{96}$ 是观察到的突变计数向量，而 $x = [x_1, x_2]^\\top$ 是未知暴露度的向量。维度 $96$ 对应于单碱基替换（SBS）通道的数量。\n\n解决方案分两个主要阶段进行：首先，构建印记矩阵 $A$；其次，迭代处理每个测试用例。\n\n**1. 印记矩阵 $A$ 的构建**\n\n印记 $S_1$ 和 $S_2$ 源自未归一化的基向量 $b_1$ 和 $b_2$，定义在通道 $i \\in \\{1, 2, \\dots, 96\\}$ 上。\n- $b_1(i) = i$\n- $b_2(i) = 97 - i$\n\n这些向量必须被归一化，使其总和为 $1$。归一化常数是向量元素的总和。对于 $b_1$，这是一个等差数列的和：\n$$\n\\sum_{k=1}^{96} b_1(k) = \\sum_{k=1}^{96} k = \\frac{96 \\times (96 + 1)}{2} = \\frac{96 \\times 97}{2} = 4656\n$$\n根据对称性，$b_2$ 的总和是相同的：\n$$\n\\sum_{k=1}^{96} b_2(k) = \\sum_{k=1}^{96} (97 - k) = 96 \\times 97 - \\sum_{k=1}^{96} k = 9312 - 4656 = 4656\n$$\n因此，归一化后的印记是：\n$$\nS_1 = \\frac{b_1}{4656} \\quad \\text{和} \\quad S_2 = \\frac{b_2}{4656}\n$$\n然后通过将 $S_1$ 和 $S_2$ 作为其列来构建矩阵 $A$：$A = [S_1 | S_2]$。\n\n**2. 测试用例的处理**\n\n对于五个测试用例中的每一个，执行以下步骤：\na. **构建观测向量 $y_t$**：根据案例 $t \\in \\{1, \\dots, 5\\}$ 的具体规则构建。\nb. **解决NNLS问题**：我们通过求解 $x_t = \\arg\\min_{x \\ge 0} \\lVert y_t - A x \\rVert_2^2$ 来找到最优暴露度向量 $x_t = [x_{1,t}, x_{2,t}]^\\top$。这是一个标准的凸优化问题，可以使用数值算法高效解决，例如 SciPy 的 `scipy.optimize.nnls` 函数中实现的活动集方法。\nc. **计算残差分数 $f_t$**：找到 $x_t$ 后，残差向量为 $r_t = y_t - A x_t$。残差分数用于量化模型未能解释的信号比例，计算为欧几里得范数之比：\n$$\nf_t = \\frac{\\lVert r_t \\rVert_2}{\\lVert y_t \\rVert_2} = \\frac{\\lVert y_t - A x_t \\rVert_2}{\\lVert y_t \\rVert_2}\n$$\n如果 $\\lVert y_t \\rVert_2 = 0$，则 $f_t$ 定义为 $0$。\n\n这五个测试用例旨在探测模型的不同方面：\n- **案例1**：$y_1 = 50 \\, S_1 + 30 \\, S_2$。一个精确的混合。我们期望解为 $x_1 \\approx 50$，$x_2 \\approx 30$，且 $f_1 \\approx 0$。\n- **案例2**：$y_2 = 100 \\, S_2$。一个边界条件。我们期望 $x_1 \\approx 0$，$x_2 \\approx 100$，且 $f_2 \\approx 0$。\n- **案例3**：$y_3 = 60 \\, S_1 + n$，其中 $n$ 是一个小的、结构化的噪声向量。我们期望 $x_1$ 接近 $60$，$x_2$ 接近 $0$，且 $f_3$ 很小但非零。\n- **案例4**：一个近共线性的案例。信号是 $y_4 = 40 \\, S_1 + 40 \\, S_2'$，其中 $S_2'$ 是 $S_1$ 和 $S_2$ 的线性组合。具体来说，$S_2' = 0.8 S_1 + 0.2 S_2$（由于总和已为 $1$，无需重新归一化）。因此，$y_4 = 40 S_1 + 40(0.8 S_1 + 0.2 S_2) = 72 S_1 + 8 S_2$。我们期望求解器找到 $x_1 \\approx 72$，$x_2 \\approx 8$，且 $f_4 \\approx 0$。\n- **案例5**：一个张成空间外的信号，$y_5 = 80 \\, S_3$，其中 $S_3$ 是一个具有交替模式的印记，与 $S_1$ 和 $S_2$ 的线性趋势不同。我们期望拟合效果差，导致较大的残差分数 $f_5$。\n\n每个案例的最终输出是列表 $[x_{1,t}, x_{2,t}, f_t]$，其中每个值都四舍五入到六位小数。这些列表被汇总成一个最终的列表之列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Constructs mutational signatures, generates test case data, solves the\n    Nonnegative Least Squares (NNLS) problem for each case, and computes\n    the residual norm fraction.\n    \"\"\"\n\n    # 1. Construct the base signatures S1, S2, and the matrix A.\n    # The channels are indexed i from 1 to 96.\n    i = np.arange(1, 97, dtype=float)\n\n    # Define unnormalized vectors b1 and b2.\n    b1 = i\n    b2 = 97.0 - i\n\n    # Normalize to obtain signatures S1 and S2.\n    # The normalization constant is the sum of an arithmetic series.\n    norm_const = np.sum(b1)  # 96 * 97 / 2 = 4656.0\n    S1 = b1 / norm_const\n    S2 = b2 / norm_const\n\n    # Construct the signature matrix A.\n    A = np.stack([S1, S2], axis=1)\n\n    # List to store results from all test cases.\n    all_results = []\n\n    # --- Test Case Generation and Processing ---\n\n    # Case 1: Happy path exact mixture\n    y1 = 50.0 * S1 + 30.0 * S2\n    \n    # Case 2: Boundary condition with one exposure zero\n    y2 = 100.0 * S2\n    \n    # Case 3: Noisy measurement favoring one signature\n    # n(i) = 0.1 * ((i mod 5) / 5.0) for i in {1,...,96}\n    noise_indices = np.arange(1, 97)\n    n = 0.1 * ((noise_indices % 5) / 5.0)\n    y3 = 60.0 * S1 + n\n    \n    # Case 4: Near-collinearity-induced redistribution\n    # S2' = (0.8 * S1 + 0.2 * S2), renormalized.\n    # The sum of S2_prime_unnorm is already 1, so renormalization is trivial.\n    S2_prime_unnorm = 0.8 * S1 + 0.2 * S2\n    norm_s2p = np.sum(S2_prime_unnorm)\n    S2_prime = S2_prime_unnorm / norm_s2p\n    y4 = 40.0 * S1 + 40.0 * S2_prime\n    \n    # Case 5: Out-of-span unexplained process\n    # b3(i) = 1 + 0.5 * ((i mod 2))\n    b3_indices = np.arange(1, 97)\n    b3 = 1.0 + 0.5 * (b3_indices % 2)\n    S3 = b3 / np.sum(b3)\n    y5 = 80.0 * S3\n\n    test_cases_y = [y1, y2, y3, y4, y5]\n\n    for y in test_cases_y:\n        # Solve the NNLS problem: min ||Ax - y||_2^2 subject to x >= 0\n        x, residual_norm = nnls(A, y)\n        \n        # Compute the residual fraction f\n        y_norm = np.linalg.norm(y)\n        f = residual_norm / y_norm if y_norm > 0 else 0.0\n        \n        # Get exposures x1 and x2\n        x1 = x[0]\n        x2 = x[1]\n        \n        # Append the rounded results\n        result = [round(x1, 6), round(x2, 6), round(f, 6)]\n        all_results.append(result)\n\n    # Final print statement in the exact required format.\n    # The str() of a list gives the desired '[...]' format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}