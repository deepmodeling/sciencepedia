{
    "hands_on_practices": [
        {
            "introduction": "Interpreting sequencing data from tumor biopsies is complicated by the presence of normal cells. The observed variant allele fraction (VAF) of a mutation is not a direct measure of its prevalence in the cancer cell population. This exercise provides hands-on practice in calculating the true cancer cell fraction (CCF) by correcting for tumor purity and local copy number, a fundamental skill for distinguishing clonal from subclonal events and understanding tumor evolution, particularly in the context of acquired drug resistance. ",
            "id": "4390906",
            "problem": "A patient with metastatic non-small cell lung cancer is found pre-treatment to harbor a clonal epidermal growth factor receptor (EGFR) exon 19 deletion. After progression on therapy, a tumor re-biopsy is performed. Targeted next-generation sequencing reports an EGFR T790M variant allele fraction (VAF) of $0.2$, and independent pathology review establishes tumor purity $p=0.5$. Copy-number analysis at the EGFR locus shows total tumor copy number $C_{t}=2$ with no loss of heterozygosity. Assume the following: normal (non-cancer) cells are diploid with $2$ copies per locus; sequencing reads are an unbiased sample of alleles; the T790M substitution, when present in a cancer cell, is present on a single allele (multiplicity $m=1$); and the EGFR exon 19 deletion remains clonal, providing the background on which T790M emerges. Let the cancer cell fraction (CCF) $f$ denote the fraction of cancer cells carrying T790M. Using only first principles of tumor-normal admixture and allele counting, derive an expression for $f$ in terms of the observed VAF, $p$, $C_{t}$, and $m$, then compute $f$ for the given values. State whether the inferred $f$ is more consistent with clonal emergence ($f$ approximately $1$) or subclonal emergence ($f$ less than $1$), and justify your reasoning qualitatively. Report the numeric value of $f$ as a pure number between $0$ and $1$. No rounding instruction is required; report the exact value implied by the given numbers.",
            "solution": "The problem requires the derivation of the cancer cell fraction ($f$) of a subclonal mutation from sequencing data. We are given the following parameters:\n- The observed variant allele fraction of the EGFR T790M mutation, $\\text{VAF} = 0.2$.\n- The tumor purity of the sample, $p = 0.5$. This is the fraction of cells in the sample that are cancer cells.\n- The total copy number of the EGFR locus in tumor cells, $C_{t} = 2$.\n- The multiplicity of the T790M mutation in a mutated cancer cell, $m = 1$. This means the mutation is heterozygous in the cells that carry it.\n- The copy number in normal cells is $C_{n} = 2$.\n\nThe variant allele fraction (VAF) is the proportion of sequencing reads containing the variant allele relative to all reads at that locus. It can be modeled as the ratio of the total number of variant alleles to the total number of all alleles in the mixed sample.\n\nThe number of variant alleles comes only from the fraction $f$ of cancer cells that contain the mutation. Their contribution is proportional to the purity $p$, the cancer cell fraction $f$, and the mutation multiplicity $m$:\n$$ \\text{Variant Allele Contribution} \\propto p \\cdot f \\cdot m $$\nThe total number of alleles in the sample is the sum of alleles from the tumor cells and the normal cells:\n- Alleles from tumor cells $\\propto p \\cdot C_{t}$\n- Alleles from normal cells $\\propto (1-p) \\cdot C_{n}$\n$$ \\text{Total Alleles in Sample} \\propto p \\cdot C_{t} + (1-p) \\cdot C_{n} $$\nThe VAF is the ratio of these quantities:\n$$ \\text{VAF} = \\frac{p \\cdot f \\cdot m}{p \\cdot C_{t} + (1-p) \\cdot C_{n}} $$\nWe can rearrange this general expression to solve for the cancer cell fraction, $f$:\n$$ f = \\frac{\\text{VAF} \\cdot (p \\cdot C_{t} + (1-p) \\cdot C_{n})}{p \\cdot m} $$\nNow, we substitute the given numerical values:\n$\\text{VAF} = 0.2$\n$p = 0.5$\n$C_{t} = 2$\n$m = 1$\n$C_{n} = 2$\n\nPlugging these into the equation for $f$:\n$$ f = \\frac{0.2 \\cdot (0.5 \\cdot 2 + (1-0.5) \\cdot 2)}{0.5 \\cdot 1} $$\nFirst, we evaluate the term in the parentheses, which represents the average cellular ploidy of the locus in the sample:\n$$ 0.5 \\cdot 2 + 0.5 \\cdot 2 = 1 + 1 = 2 $$\nThis result is expected, as both tumor and normal cells are diploid at this locus.\n\nNow, substituting this back into the expression for $f$:\n$$ f = \\frac{0.2 \\cdot 2}{0.5 \\cdot 1} = \\frac{0.4}{0.5} = 0.8 $$\nThe calculated cancer cell fraction is $f=0.8$. This means the T790M mutation is present in $80\\%$ of the cancer cells in the biopsied tumor population.\n\nA **clonal mutation** is present in nearly all cancer cells ($f \\approx 1$), while a **subclonal mutation** is present in a subpopulation ($f  1$). Since our calculated value is $f=0.8$, the emergence of the T790M mutation is subclonal. This represents a classic pattern of acquired drug resistance, where a resistant subclone emerges from the original clonal population under the selective pressure of therapy.",
            "answer": "$$\\boxed{0.8}$$"
        },
        {
            "introduction": "A central goal of precision oncology is to exploit cancer-specific vulnerabilities. This exercise delves into the analysis of CRISPR screen data, a powerful functional genomics technique used to identify genes essential for cancer cell survival in a specific genetic context. You will apply statistical principles to real-world-style data to identify synthetic lethal interactions, where the loss of a gene is lethal only in the presence of another specific mutation (in this case, BRCA1 deficiency), a key strategy for developing targeted therapies. ",
            "id": "4390888",
            "problem": "A pooled Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR) negative-selection screen measures the impact of gene disruption on cell viability via log-fold changes (LFCs) in single-guide RNA abundance over time. In such screens, more negative log-fold changes indicate stronger depletion and thus greater essentiality. Consider two isogenic cell contexts: Breast Cancer Type 1 susceptibility gene (BRCA1)-deficient and BRCA1-proficient. For each gene $g$ in a set of $5$ genes, the screen yields $3$ LFC replicates in the BRCA1-deficient context and $3$ LFC replicates in the BRCA1-proficient context. Assume replicates are independent and approximately normally distributed with equal within-gene variance across the two contexts.\n\nYou are given the following replicate log-fold changes (LFCs) for each gene:\n- Gene $1$ (PARP1): BRCA1-deficient $[-2.1, -2.0, -1.9]$; BRCA1-proficient $[-0.6, -0.5, -0.4]$.\n- Gene $2$ (POLQ): BRCA1-deficient $[-1.3, -1.2, -1.1]$; BRCA1-proficient $[-0.4, -0.3, -0.2]$.\n- Gene $3$ (RAD52): BRCA1-deficient $[-0.9, -0.8, -0.7]$; BRCA1-proficient $[-0.30, -0.25, -0.20]$.\n- Gene $4$ (ATR): BRCA1-deficient $[-1.2, -1.1, -1.0]$; BRCA1-proficient $[-1.00, -0.95, -0.90]$.\n- Gene $5$ (RPL3): BRCA1-deficient $[-1.10, -1.05, -1.00]$; BRCA1-proficient $[-1.10, -1.05, -1.00]$.\n\nDefine, for gene $g$, the mean log-fold change in the BRCA1-deficient context as $\\bar{L}_{\\mathrm{def},g}$ and in the BRCA1-proficient context as $\\bar{L}_{\\mathrm{prof},g}$. The differential essentiality is defined as\n$$\n\\Delta_g = \\bar{L}_{\\mathrm{def},g} - \\bar{L}_{\\mathrm{prof},g}.\n$$\nA gene is considered a synthetic lethality candidate if it satisfies both $\\Delta_g \\leq -0.5$ and a two-sample pooled-variance $t$-statistic $t_g \\leq -3$, where\n$$\nt_g = \\frac{\\bar{L}_{\\mathrm{def},g} - \\bar{L}_{\\mathrm{prof},g}}{\\sqrt{s_{p,g}^{2}\\left(\\frac{1}{n_{\\mathrm{def}}}+\\frac{1}{n_{\\mathrm{prof}}}\\right)}},\n\\quad\ns_{p,g}^{2} = \\frac{(n_{\\mathrm{def}}-1)s_{\\mathrm{def},g}^{2}+(n_{\\mathrm{prof}}-1)s_{\\mathrm{prof},g}^{2}}{n_{\\mathrm{def}}+n_{\\mathrm{prof}}-2},\n$$\nwith $n_{\\mathrm{def}}=n_{\\mathrm{prof}}=3$, and $s_{\\mathrm{def},g}^{2}$ and $s_{\\mathrm{prof},g}^{2}$ the sample variances of the LFC replicates in the respective contexts.\n\nLet $\\mathcal{C}$ be the set of genes that meet both criteria. Compute\n$$\nS = \\sum_{g \\in \\mathcal{C}} |\\Delta_g|.\n$$\nExpress $S$ as a dimensionless number and round your answer to four significant figures.",
            "solution": "The objective is to identify which of the 5 genes are synthetic lethality candidates by applying two statistical criteria, and then to sum the absolute values of their differential essentiality scores, $|\\Delta_g|$. For each gene $g$, we must compute the mean log-fold changes ($\\bar{L}_{\\mathrm{def},g}$, $\\bar{L}_{\\mathrm{prof},g}$), the differential essentiality ($\\Delta_g$), the pooled variance ($s_{p,g}^2$), and the $t$-statistic ($t_g$). A gene is a candidate if it meets both conditions: $\\Delta_g \\leq -0.5$ and $t_g \\leq -3$.\n\nWith sample sizes $n_{\\mathrm{def}} = n_{\\mathrm{prof}} = 3$, the formulas simplify:\n- Pooled variance: $s_{p,g}^{2} = \\frac{(2)s_{\\mathrm{def},g}^{2} + (2)s_{\\mathrm{prof},g}^{2}}{4} = \\frac{s_{\\mathrm{def},g}^{2}+s_{\\mathrm{prof},g}^{2}}{2}$\n- $t$-statistic denominator: $\\sqrt{s_{p,g}^{2}\\left(\\frac{1}{3}+\\frac{1}{3}\\right)} = \\sqrt{\\frac{2s_{p,g}^{2}}{3}}$\n\nWe analyze each gene systematically.\n\n**Gene 1 (PARP1)**\n- Means: $\\bar{L}_{\\mathrm{def},1} = -2.0$; $\\bar{L}_{\\mathrm{prof},1} = -0.5$.\n- Differential essentiality: $\\Delta_1 = -2.0 - (-0.5) = -1.5$. Criterion 1 is met ($-1.5 \\leq -0.5$).\n- Variances: $s_{\\mathrm{def},1}^{2} = 0.01$; $s_{\\mathrm{prof},1}^{2} = 0.01$.\n- Pooled variance: $s_{p,1}^{2} = \\frac{0.01 + 0.01}{2} = 0.01$.\n- $t$-statistic: $t_1 = \\frac{-1.5}{\\sqrt{0.01 \\cdot (2/3)}} \\approx -18.37$. Criterion 2 is met ($-18.37 \\leq -3$).\n- **Conclusion**: Gene 1 is a candidate. $|\\Delta_1| = 1.5$.\n\n**Gene 2 (POLQ)**\n- Means: $\\bar{L}_{\\mathrm{def},2} = -1.2$; $\\bar{L}_{\\mathrm{prof},2} = -0.3$.\n- Differential essentiality: $\\Delta_2 = -1.2 - (-0.3) = -0.9$. Criterion 1 is met ($-0.9 \\leq -0.5$).\n- Variances: $s_{\\mathrm{def},2}^{2} = 0.01$; $s_{\\mathrm{prof},2}^{2} = 0.01$.\n- Pooled variance: $s_{p,2}^{2} = \\frac{0.01 + 0.01}{2} = 0.01$.\n- $t$-statistic: $t_2 = \\frac{-0.9}{\\sqrt{0.01 \\cdot (2/3)}} \\approx -11.02$. Criterion 2 is met ($-11.02 \\leq -3$).\n- **Conclusion**: Gene 2 is a candidate. $|\\Delta_2| = 0.9$.\n\n**Gene 3 (RAD52)**\n- Means: $\\bar{L}_{\\mathrm{def},3} = -0.8$; $\\bar{L}_{\\mathrm{prof},3} = -0.25$.\n- Differential essentiality: $\\Delta_3 = -0.8 - (-0.25) = -0.55$. Criterion 1 is met ($-0.55 \\leq -0.5$).\n- Variances: $s_{\\mathrm{def},3}^{2} = 0.01$; $s_{\\mathrm{prof},3}^{2} = 0.0025$.\n- Pooled variance: $s_{p,3}^{2} = \\frac{0.01 + 0.0025}{2} = 0.00625$.\n- $t$-statistic: $t_3 = \\frac{-0.55}{\\sqrt{0.00625 \\cdot (2/3)}} \\approx -8.52$. Criterion 2 is met ($-8.52 \\leq -3$).\n- **Conclusion**: Gene 3 is a candidate. $|\\Delta_3| = 0.55$.\n\n**Gene 4 (ATR)**\n- Means: $\\bar{L}_{\\mathrm{def},4} = -1.1$; $\\bar{L}_{\\mathrm{prof},4} = -0.95$.\n- Differential essentiality: $\\Delta_4 = -1.1 - (-0.95) = -0.15$.\n- Criterion 1 is not met ($-0.15 \\not\\leq -0.5$).\n- **Conclusion**: Gene 4 is not a candidate.\n\n**Gene 5 (RPL3)**\n- Means: $\\bar{L}_{\\mathrm{def},5} = -1.05$; $\\bar{L}_{\\mathrm{prof},5} = -1.05$.\n- Differential essentiality: $\\Delta_5 = -1.05 - (-1.05) = 0$.\n- Criterion 1 is not met ($0 \\not\\leq -0.5$). This gene is a pan-essential core fitness gene, not a synthetic lethal one.\n- **Conclusion**: Gene 5 is not a candidate.\n\n**Final Calculation**\nThe set of candidate genes is $\\mathcal{C} = \\{\\text{Gene } 1, \\text{Gene } 2, \\text{Gene } 3\\}$.\nThe sum $S$ is:\n$$\nS = \\sum_{g \\in \\mathcal{C}} |\\Delta_g| = |\\Delta_1| + |\\Delta_2| + |\\Delta_3| = 1.5 + 0.9 + 0.55 = 2.95\n$$\nRounding to four significant figures gives $2.950$.",
            "answer": "$$\\boxed{2.950}$$"
        },
        {
            "introduction": "A cancer genome is a historical record of the mutational processes that have shaped it. These processes leave characteristic footprints known as mutational signatures. This advanced computational practice introduces the powerful technique of signature deconvolution, where a tumor's complex mutational profile is broken down into the contributions of known underlying processes. By applying a Nonnegative Least Squares (NNLS) algorithm, you will learn how to quantify the activity of different mutational processes, offering insights into a tumor's etiology and potential therapeutic avenues. ",
            "id": "4390897",
            "problem": "You are given a computational task grounded in the analysis of mutational signatures in cancer, a central task in precision medicine and genomic diagnostics. The biological premise is that somatic mutations in cancer genomes arise from multiple mutational processes, each leaving a characteristic pattern across the 96 Single Base Substitution (SBS) channels. The SBS channels are defined by the six possible base substitutions, each in the context of the immediately flanking bases, yielding a 96-channel categorization. By the principle that independent mutational processes superimpose their effects, the total observed mutation count vector can be modeled as a nonnegative linear combination of known signatures.\n\nFundamental basis and assumptions: The Central Dogma of Molecular Biology posits that deoxyribonucleic acid (DNA) mutations alter genomic sequence, and well-tested empirical observations in cancer genomics show that mutational processes produce characteristic, approximately additive patterns across SBS channels. Let $y \\in \\mathbb{R}^{96}_{\\ge 0}$ denote the observed mutation counts per SBS channel. Let $S_1 \\in \\mathbb{R}^{96}_{\\ge 0}$ and $S_2 \\in \\mathbb{R}^{96}_{\\ge 0}$ denote two known mutational signatures, each normalized so that $\\sum_{i=1}^{96} S_{j,i} = 1$ for $j \\in \\{1,2\\}$. The exposures $x_1 \\ge 0$ and $x_2 \\ge 0$ quantify the contributions of signatures $S_1$ and $S_2$ to $y$. The linear model is $y \\approx x_1 S_1 + x_2 S_2$, with the unexplained component $r = y - x_1 S_1 + x_2 S_2$ capturing processes not represented by $S_1$ and $S_2$. To estimate $(x_1, x_2)$, formulate the Nonnegative Least Squares (NNLS) problem: minimize the squared Euclidean norm $\\lVert y - A x \\rVert_2^2$ subject to $x \\ge 0$, where $A \\in \\mathbb{R}^{96 \\times 2}$ has columns $S_1$ and $S_2$ and $x = (x_1, x_2)^\\top$. Interpret the residual norm fraction $f = \\lVert r \\rVert_2 / \\lVert y \\rVert_2$ as the fraction of the total signal unexplained by the two signatures. All counts are dimensionless numbers; no physical units are involved. All angles, if any, are irrelevant; none are used.\n\nYour task is to write a program that, for each specified test case, constructs $S_1$, $S_2$, the corresponding $y$, solves the NNLS problem for $(x_1, x_2)$, and computes $f$. The final output for each test case must be the list $[x_1, x_2, f]$ with each value rounded to six decimal places. Aggregate the results from all test cases into a single line as a comma-separated list enclosed in square brackets, where each element is the list for one test case, for example, $[[x_{1,1}, x_{2,1}, f_1],[x_{1,2}, x_{2,2}, f_2],\\dots]$.\n\nDefine signatures and test cases as follows to ensure reproducibility and coverage:\n\n- Signature construction:\n  - For $i \\in \\{1,2,\\dots,96\\}$, define the unnormalized vectors $b_1(i) = i$ and $b_2(i) = 97 - i$.\n  - Normalize to obtain signatures $S_1(i) = b_1(i) / \\sum_{k=1}^{96} b_1(k)$ and $S_2(i) = b_2(i) / \\sum_{k=1}^{96} b_2(k)$.\n  - Let $A$ be the matrix with columns $S_1$ and $S_2$.\n\n- Test suite:\n  1. Happy path exact mixture: $y_1 = 50 \\, S_1 + 30 \\, S_2$.\n  2. Boundary condition with one exposure zero: $y_2 = 100 \\, S_2$.\n  3. Noisy measurement favoring one signature: $y_3 = 60 \\, S_1 + n$, where $n(i) = 0.1 \\times \\left( (i \\bmod 5) / 5.0 \\right)$ for $i \\in \\{1,\\dots,96\\}$.\n  4. Near-collinearity-induced redistribution: define $S_2'(i) = \\left( 0.8 \\, S_1(i) + 0.2 \\, S_2(i) \\right)$ and renormalize so that $\\sum_{i=1}^{96} S_2'(i) = 1$ by dividing by its sum; let $y_4 = 40 \\, S_1 + 40 \\, S_2'$. Solve exposures against $A$ whose columns remain $S_1$ and $S_2$.\n  5. Out-of-span unexplained process: define $b_3(i) = 1 + 0.5 \\times ((i \\bmod 2))$ and $S_3(i) = b_3(i) / \\sum_{k=1}^{96} b_3(k)$; let $y_5 = 80 \\, S_3$. Solve exposures against $A$ whose columns are $S_1$ and $S_2$.\n\n- For each test case $t \\in \\{1,2,3,4,5\\}$:\n  - Solve $x_t = (x_{1,t}, x_{2,t})^\\top = \\arg\\min_{x \\ge 0} \\lVert y_t - A x \\rVert_2^2$.\n  - Compute $f_t = \\lVert y_t - A x_t \\rVert_2 / \\lVert y_t \\rVert_2$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is the list $[x_{1,t}, x_{2,t}, f_t]$ for the corresponding test case. All values must be rounded to six decimal places and expressed as decimal numbers without percentage signs. No user input or external files are allowed. The computation must be purely numerical and logically follows from the linear mixture model of mutational signatures under nonnegativity constraints.",
            "solution": "The problem requires solving a Nonnegative Least Squares (NNLS) optimization problem to determine the contributions (exposures) of two mutational signatures, $S_1$ and $S_2$, to an observed mutation count vector, $y$. The optimization is formulated as:\n$$\n\\text{minimize } \\lVert y - Ax \\rVert_2^2 \\quad \\text{subject to} \\quad x \\ge 0\n$$\nwhere the matrix $A \\in \\mathbb{R}^{96 \\times 2}$ has the signatures $S_1$ and $S_2$ as its columns, and $x = [x_1, x_2]^\\top$ is the vector of unknown exposures. The solution proceeds in two main stages: construction of the signature matrix $A$, and processing of the five test cases.\n\n**1. Construction of the Signature Matrix $A$**\n\nThe signatures $S_1$ and $S_2$ are derived from unnormalized vectors $b_1(i) = i$ and $b_2(i) = 97 - i$ for channels $i \\in \\{1, \\dots, 96\\}$. These are normalized by dividing by their sum. The sum of the arithmetic series is $\\sum_{k=1}^{96} k = \\frac{96 \\times (96 + 1)}{2} = 4656$.\nThus, the normalized signatures are $S_1 = b_1 / 4656$ and $S_2 = b_2 / 4656$. The matrix $A$ is formed with these signatures as its columns, $A = [S_1 | S_2]$.\n\n**2. Processing of Test Cases**\n\nFor each test case $t \\in \\{1, \\dots, 5\\}$, we construct the observation vector $y_t$, solve the NNLS problem for $x_t = [x_{1,t}, x_{2,t}]^\\top$, and compute the residual fraction $f_t = \\lVert y_t - A x_t \\rVert_2 / \\lVert y_t \\rVert_2$.\n\n- **Case 1**: $y_1 = 50 S_1 + 30 S_2$. An exact mixture. The expected solution is $x \\approx [50, 30]$ and $f_1 \\approx 0$.\n- **Case 2**: $y_2 = 100 S_2$. A boundary condition where one signature is absent. The expected solution is $x \\approx [0, 100]$ and $f_2 \\approx 0$.\n- **Case 3**: $y_3 = 60 S_1 + n$, where $n$ is a small, structured noise vector. The solution should find $x_1$ close to $60$, $x_2$ close to $0$, and a small, non-zero residual fraction $f_3$.\n- **Case 4**: A test of near-collinearity. The signal is $y_4 = 40 S_1 + 40 S_2'$, where $S_2'$ is a linear combination of the basis signatures: $S_2' = 0.8 S_1 + 0.2 S_2$. The full signal is thus $y_4 = 40 S_1 + 40(0.8 S_1 + 0.2 S_2) = 72 S_1 + 8 S_2$. The solver is expected to find these combined exposures, $x \\approx [72, 8]$, with $f_4 \\approx 0$.\n- **Case 5**: An out-of-span signal, $y_5 = 80 S_3$, where $S_3$ is a signature with a different pattern. The NNLS algorithm will find the best-fit combination of $S_1$ and $S_2$, but the fit will be poor, resulting in a large residual fraction $f_5$.\n\nThe final output aggregates the results $[x_{1,t}, x_{2,t}, f_t]$ for each case into a single list. The provided Python code implements these steps using NumPy for numerical operations and SciPy's `nnls` function for the optimization.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Constructs mutational signatures, generates test case data, solves the\n    Nonnegative Least Squares (NNLS) problem for each case, and computes\n    the residual norm fraction.\n    \"\"\"\n\n    # 1. Construct the base signatures S1, S2, and the matrix A.\n    # The channels are indexed i from 1 to 96.\n    i = np.arange(1, 97, dtype=float)\n\n    # Define unnormalized vectors b1 and b2.\n    b1 = i\n    b2 = 97.0 - i\n\n    # Normalize to obtain signatures S1 and S2.\n    # The normalization constant is the sum of an arithmetic series.\n    norm_const = np.sum(b1)  # 96 * 97 / 2 = 4656.0\n    S1 = b1 / norm_const\n    S2 = b2 / norm_const\n\n    # Construct the signature matrix A.\n    A = np.stack([S1, S2], axis=1)\n\n    # List to store results from all test cases.\n    all_results = []\n\n    # --- Test Case Generation and Processing ---\n\n    # Case 1: Happy path exact mixture\n    y1 = 50.0 * S1 + 30.0 * S2\n    \n    # Case 2: Boundary condition with one exposure zero\n    y2 = 100.0 * S2\n    \n    # Case 3: Noisy measurement favoring one signature\n    # n(i) = 0.1 * ((i mod 5) / 5.0) for i in {1,...,96}\n    noise_indices = np.arange(1, 97)\n    n = 0.1 * ((noise_indices % 5) / 5.0)\n    y3 = 60.0 * S1 + n\n    \n    # Case 4: Near-collinearity-induced redistribution\n    # S2' = (0.8 * S1 + 0.2 * S2), renormalized.\n    # The sum of S2_prime_unnorm is 1, so renormalization is trivial (dividing by 1).\n    S2_prime_unnorm = 0.8 * S1 + 0.2 * S2\n    norm_s2p = np.sum(S2_prime_unnorm)\n    S2_prime = S2_prime_unnorm / norm_s2p\n    y4 = 40.0 * S1 + 40.0 * S2_prime\n    \n    # Case 5: Out-of-span unexplained process\n    # b3(i) = 1 + 0.5 * ((i mod 2))\n    b3_indices = np.arange(1, 97)\n    b3 = 1.0 + 0.5 * (b3_indices % 2)\n    S3 = b3 / np.sum(b3)\n    y5 = 80.0 * S3\n\n    test_cases_y = [y1, y2, y3, y4, y5]\n\n    for y in test_cases_y:\n        # Solve the NNLS problem: min ||Ax - y||_2^2 subject to x >= 0\n        x, residual_norm = nnls(A, y)\n        \n        # Compute the residual fraction f\n        y_norm = np.linalg.norm(y)\n        f = residual_norm / y_norm if y_norm > 0 else 0.0\n        \n        # Get exposures x1 and x2\n        x1 = x[0]\n        x2 = x[1]\n        \n        # Append the rounded results\n        result = [round(x1, 6), round(x2, 6), round(f, 6)]\n        all_results.append(result)\n\n    # Final print statement in the exact required format.\n    # The str() of a list gives the desired '[...]' format.\n    # Using f-string to ensure consistent spacing.\n    print(f\"[{','.join(str(r) for r in all_results)}]\")\n\n# solve() is not called here as per the typical structure for this system,\n# but it is provided as a complete, runnable function. If this script\n# were to be run directly, one would call solve().\n# For this execution environment, the main logic is simply defined.\nsolve()\n```"
        }
    ]
}