{
    "hands_on_practices": [
        {
            "introduction": "在癌症基因组学中，我们测序得到的数据通常来自一个包含了癌细胞和正常细胞的混合样本。因此，我们直接观测到的变异等位基因频率（Variant Allele Fraction, VAF）并不能直接等同于该变异在癌细胞群体中的真实比例。本练习将指导您从基本原理出发，推导并计算癌症细胞分数（Cancer Cell Fraction, CCF），这是一个从混合信号中提炼出纯粹生物学信息的关键技能，能够帮助我们判断一个体细胞突变是克隆性的还是亚克隆性的。",
            "id": "4390912",
            "problem": "一份实体瘤活检样本通过短读长DNA测序和等位基因特异性拷贝数分析进行了检测。该样本的估计肿瘤纯度为 $p=0.6$（即测序混合物中癌细胞的比例），在感兴趣的基因座上，癌细胞的总拷贝数为 $C=2$，且在所有癌细胞中没有亚克隆拷贝数变化。在测序数据中观测到一个单核苷酸变异（SNV），其变异等位基因频率（VAF）为 $f=0.3$。假设正常（非癌）细胞是拷贝数为 $2$ 的二倍体，并且如果某个癌细胞中存在该SNV，则其为杂合状态（在该细胞的 $C$ 个总拷贝中有一个突变拷贝）。\n\n从以下核心定义出发：(i) 变异等位基因频率 (VAF) 是覆盖某基因座的所有测序读数中携带该变异的读数所占的比例；(ii) 测得的读数数量与癌细胞和正常细胞根据其混合比例贡献的DNA模板分子数量成正比；(iii) 癌细胞分数 (CCF) 是携带该SNV的癌细胞所占的比例。请推导一个用 $p$、$C$、每个癌细胞的突变拷贝数 $m$ 和 $\\text{CCF}$ 表示的预期 $f$ 的表达式。然后，在给定的假设（杂合状态 $m=1$ 和 $C=2$ 以及二倍体正常细胞）下，反转你的表达式，以计算与观测到的 $f=0.3$ 和 $p=0.6$ 一致的估计 $\\text{CCF}$。\n\n请提供你的最终答案，即 $\\text{CCF}$ 的单个实数值。",
            "solution": "该问题要求推导变异等位基因频率 ($f$) 的表达式，并随后计算癌细胞分数 ($\\text{CCF}$)。分析首先对测序样本中DNA的组成进行建模，该样本是正常细胞和癌细胞的混合物。\n\n设 $p$ 为肿瘤纯度，代表样本中癌细胞的比例。因此，正常细胞的比例为 $(1-p)$。\n设 $C_c$ 为癌细胞中感兴趣基因座上基因的总拷贝数，$C_n$ 为正常细胞中的总拷贝数。\n设 $m$ 为携带单核苷酸变异（SNV）的癌细胞中该基因的突变拷贝（等位基因）数。\n设 $\\text{CCF}$ 为癌细胞分数，即含有该SNV的癌细胞的比例。\n\n测序样本中该基因座的等位基因总数是来自正常细胞和癌细胞群体的等位基因的加权平均值。每单位组织中的等位基因总数与测序读数的总数成正比，可以表示为：\n$$\n\\text{Total Alleles} \\propto (1-p) C_n + p C_c\n$$\n问题陈述正常细胞是二倍体，所以 $C_n = 2$。癌细胞中的总拷贝数给定为 $C$，所以 $C_c = C$。代入这些值得到：\n$$\n\\text{Total Alleles} \\propto (1-p) \\cdot 2 + p \\cdot C\n$$\n样本中的变异（突变）等位基因仅来源于携带该SNV的癌细胞亚群。假设正常细胞为野生型。既是癌细胞又携带突变的细胞比例是 $p \\times \\text{CCF}$。这些细胞中的每一个都贡献 $m$ 个变异等位基因。因此，每单位组织中的变异等位基因总数为：\n$$\n\\text{Variant Alleles} \\propto (p \\cdot \\text{CCF}) \\cdot m\n$$\n变异等位基因频率（$f$）定义为变异等位基因读数数量与覆盖该基因座的总读数数量之比。假设读数数量与DNA模板分子数量成正比，我们得到：\n$$\nf = \\frac{\\text{Number of Variant Alleles}}{\\text{Total Number of Alleles}} = \\frac{p \\cdot \\text{CCF} \\cdot m}{(1-p) C_n + p C_c}\n$$\n代入 $C_n = 2$ 和 $C_c = C$，我们得到预期的变异等位基因频率的通用表达式：\n$$\nf = \\frac{p \\cdot \\text{CCF} \\cdot m}{2(1-p) + pC}\n$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们必须反转此表达式以解出 $\\text{CCF}$，然后代入给定的值。\n重新整理公式以解出 $\\text{CCF}$：\n$$\nf \\cdot (2(1-p) + pC) = p \\cdot \\text{CCF} \\cdot m\n$$\n$$\n\\text{CCF} = \\frac{f \\cdot (2(1-p) + pC)}{p \\cdot m}\n$$\n问题提供了以下值：\n- 肿瘤纯度，$p = 0.6$\n- 观测到的变异等位基因频率，$f = 0.3$\n- 癌细胞总拷贝数，$C = 2$\n- 在携带SNV的细胞中，该SNV是杂合的，意味着突变拷贝数为 $m = 1$。\n\n将这些值代入 $\\text{CCF}$ 的表达式中：\n$$\n\\text{CCF} = \\frac{0.3 \\cdot (2(1-0.6) + 0.6 \\cdot 2)}{0.6 \\cdot 1}\n$$\n首先，计算括号中的项：\n$$\n2(1-0.6) + 0.6 \\cdot 2 = 2(0.4) + 1.2 = 0.8 + 1.2 = 2.0\n$$\n现在，将此结果代回 $\\text{CCF}$ 的方程中：\n$$\n\\text{CCF} = \\frac{0.3 \\cdot 2.0}{0.6 \\cdot 1} = \\frac{0.6}{0.6} = 1\n$$\n计算出的癌细胞分数为 $1$。这表明该SNV是克隆性的，意味着它存在于肿瘤样本中 $100\\%$ 的癌细胞中。",
            "answer": "$$ \\boxed{1} $$"
        },
        {
            "introduction": "在掌握了如何估算CCF的基础上，我们可以进一步分析肿瘤的动态演化过程，尤其是在治疗压力下的演化。理解肿瘤如何产生耐药性是精准医疗的核心挑战之一。本练习模拟了一个经典的临床情景：在靶向治疗后，肿瘤样本中检测出了已知的耐药突变（EGFR T790M），您需要运用CCF的计算来推断该耐药性的出现是克隆性事件还是亚克隆性事件，从而深入理解肿瘤获得性耐药的机制。",
            "id": "4390906",
            "problem": "一名转移性非小细胞肺癌患者在治疗前被发现携带克隆性表皮生长因子受体（EGFR）外显子19缺失。在治疗后疾病进展，对肿瘤进行了再次活检。靶向二代测序报告EGFR T790M变异等位基因频率（VAF）为 $0.2$，独立的病理学评估确定肿瘤纯度 $p=0.5$。EGFR基因座的拷贝数分析显示肿瘤总拷贝数为 $C_{t}=2$，且无杂合性缺失。假设如下：正常（非癌）细胞为二倍体，每个基因座有 $2$ 个拷贝；测序读数是等位基因的无偏样本；T790M替换，当存在于癌细胞中时，存在于单个等位基因上（多重性 $m=1$）；并且EGFR外显子19缺失保持克隆性，为T790M的出现提供了背景。令癌细胞分数（CCF）$f$ 表示携带T790M的癌细胞的比例。仅使用肿瘤-正常组织混合和等位基因计数的首要原则，推导$f$关于观测VAF、$p$、$C_{t}$和$m$的表达式，然后计算给定值的$f$。陈述推断出的$f$更符合克隆性出现（$f$约等于$1$）还是亚克隆性出现（$f$小于$1$），并定性地证明你的推理。将$f$的数值报告为介于$0$和$1$之间的纯数字。无需四舍五入；报告由给定数字得出的确切值。",
            "solution": "该问题要求从测序数据中推导亚克隆突变的癌细胞分数（$f$）。我们得到以下参数：\n- 观测到的EGFR T790M突变的变异等位基因频率，$\\text{VAF} = 0.2$。\n- 样本的肿瘤纯度，$p = 0.5$。这是样本中癌细胞的比例。\n- 肿瘤细胞中EGFR基因座的总拷贝数，$C_{t} = 2$。\n- 在突变的癌细胞中，T790M突变的多重性，$m = 1$。这意味着携带该突变的细胞是杂合的。\n\n我们还得到以下假设，这些假设在此类分析中是标准的：\n- 正常（非癌）细胞是二倍体，意味着它们在该基因座的拷贝数为 $C_{n} = 2$。\n- 测序提供了组织样本中存在的所有等位基因的无偏抽样。\n\n变异等位基因频率（VAF）定义为映射到变异等位基因的测序读数数量与映射到该基因组基因座的总读数数量之比。假设无偏抽样，该比率反映了组织样本中该基因座上变异等位基因与总等位基因的比例。\n\n让我们基于肿瘤和正常细胞的混合来构建VAF的表达式。总样本由比例为$p$的肿瘤细胞和比例为$1-p$的正常细胞组成。\n\nVAF的分子对应于变异等位基因（T790M）的贡献。变异等位基因仅存在于比例为$f$的癌细胞中。\n样本中变异等位基因的数量与以下成正比：\n（癌细胞的比例） $\\times$ （携带突变的癌细胞的比例） $\\times$ （每个突变癌细胞的变异等位基因数）\n$$ \\text{变异等位基因数} \\propto p \\cdot f \\cdot m $$\n\nVAF的分母对应于样本中所有细胞（肿瘤和正常细胞）在EGFR基因座上的总等位基因数。\n来自肿瘤细胞群体的总等位基因数与以下成正比：\n（癌细胞的比例） $\\times$ （一个癌细胞中的总拷贝数）\n$$ \\text{来自肿瘤细胞的总等位基因数} \\propto p \\cdot C_{t} $$\n来自正常细胞群体的总等位基因数与以下成正比：\n（正常细胞的比例） $\\times$ （一个正常细胞中的总拷贝数）\n$$ \\text{来自正常细胞的总等位基因数} \\propto (1-p) \\cdot C_{n} $$\n整个样本中的总等位基因数是这两部分贡献的总和：\n$$ \\text{样本中的总等位基因数} \\propto p \\cdot C_{t} + (1-p) \\cdot C_{n} $$\n\nVAF是这些数量的比值：\n$$ \\text{VAF} = \\frac{p \\cdot f \\cdot m}{p \\cdot C_{t} + (1-p) \\cdot C_{n}} $$\n\n这是将VAF与肿瘤样本的生物学参数联系起来的通用表达式。问题要求我们推导癌细胞分数$f$的表达式。我们可以重新整理方程来解出$f$：\n$$ f = \\frac{\\text{VAF} \\cdot (p \\cdot C_{t} + (1-p) \\cdot C_{n})}{p \\cdot m} $$\n\n现在，我们可以将给定的数值代入这个表达式来计算$f$：\n$\\text{VAF} = 0.2$\n$p = 0.5$\n$C_{t} = 2$\n$m = 1$\n$C_{n} = 2$\n\n将这些值代入$f$的方程中：\n$$ f = \\frac{0.2 \\cdot (0.5 \\cdot 2 + (1-0.5) \\cdot 2)}{0.5 \\cdot 1} $$\n首先，我们计算括号中的项，它代表样本中该基因座的平均细胞倍性：\n$$ p \\cdot C_{t} + (1-p) \\cdot C_{n} = 0.5 \\cdot 2 + 0.5 \\cdot 2 = 1 + 1 = 2 $$\n这个结果是预料之中的，因为肿瘤细胞和正常细胞在该基因座都是二倍体，所以无论纯度如何，平均拷贝数都是2。\n\n现在，将此结果代回$f$的表达式中：\n$$ f = \\frac{0.2 \\cdot 2}{0.5 \\cdot 1} $$\n$$ f = \\frac{0.4}{0.5} $$\n$$ f = 0.8 $$\n\n计算出的癌细胞分数为$f=0.8$。这意味着在活检的肿瘤群体中，T790M突变存在于$80\\%$的癌细胞中。\n\n问题询问这一发现更符合克隆性出现还是亚克隆性出现。\n- **克隆性突变**是指存在于所有或几乎所有癌细胞中的突变。在这个数学框架中，这对应于$f \\approx 1$。\n- **亚克隆性突变**是指存在于癌细胞的一个独特亚群中的突变。这对应于 $f < 1$。\n\n由于我们计算出的值是$f=0.8$，这明显小于$1$，因此T790M突变的出现是亚克隆性的。最初的EGFR外显子19缺失是克隆性的，意味着它存在于构成肿瘤的$100\\%$的细胞中。治疗后，这些癌细胞的一个亚群（占当前癌细胞群体的$80\\%$）获得了继发性的T790M突变，这是获得性耐药的经典模式。剩下的$20\\%$的癌细胞属于未获得此特定耐药突变的原始克隆的一部分。",
            "answer": "$$\\boxed{0.8}$$"
        },
        {
            "introduction": "除了分析单个突变，我们还可以通过审视全基因组范围内的突变模式，来追溯导致癌症发生的根本原因。癌细胞中的大量突变并非随机产生，而是由特定的突变过程（如紫外线暴露、烟草烟雾或DNA修复缺陷）留下的“伤疤”。本练习将带您进入一个更高级的分析层面——突变印记（mutational signatures）分析，通过解决一个计算解卷积问题，来量化不同突变过程对特定肿瘤基因组的贡献。",
            "id": "4390897",
            "problem": "您将执行一项计算任务，该任务基于癌症突变印记分析，这是精准医疗和基因组诊断学中的一项核心任务。其生物学前提是，癌症基因组中的体细胞突变由多种突变过程引起，每种过程都会在96个单碱基替换（SBS）通道上留下独特的模式。SBS通道由六种可能的碱基替换定义，每种替换都在其紧邻的侧翼碱基背景下发生，从而形成了96个通道的分类。根据独立突变过程效应叠加的原理，观测到的总突变计数向量可以被建模为已知印记的非负线性组合。\n\n基本原理与假设：分子生物学中心法则指出，脱氧核糖核酸（DNA）突变会改变基因组序列。在癌症基因组学中，经过充分检验的经验观察表明，突变过程会在SBS通道上产生具有特征性的、近似可加的模式。设 $y \\in \\mathbb{R}^{96}_{\\ge 0}$ 表示每个SBS通道上观测到的突变计数。设 $S_1 \\in \\mathbb{R}^{96}_{\\ge 0}$ 和 $S_2 \\in \\mathbb{R}^{96}_{\\ge 0}$ 表示两个已知的突变印记，每个印记都经过归一化，使得对于 $j \\in \\{1,2\\}$，都有 $\\sum_{i=1}^{96} S_{j,i} = 1$。暴露度 $x_1 \\ge 0$ 和 $x_2 \\ge 0$ 量化了印记 $S_1$ 和 $S_2$ 对 $y$ 的贡献。线性模型为 $y \\approx x_1 S_1 + x_2 S_2$，其中未解释部分 $r = y - x_1 S_1 + x_2 S_2$ 捕捉了未被 $S_1$ 和 $S_2$ 代表的过程。为估计 $(x_1, x_2)$，构建非负最小二乘（NNLS）问题：在 $x \\ge 0$ 的约束下，最小化欧几里得范数的平方 $\\lVert y - A x \\rVert_2^2$，其中 $A \\in \\mathbb{R}^{96 \\times 2}$ 的列是 $S_1$ 和 $S_2$，$x = (x_1, x_2)^\\top$。将残差范数分数 $f = \\lVert r \\rVert_2 / \\lVert y \\rVert_2$ 解释为总信号中未被这两个印记解释的比例。所有计数均为无量纲数，不涉及物理单位。所有角度（若有）均不相关，未使用。\n\n您的任务是编写一个程序，对于每个指定的测试用例，构造 $S_1$、$S_2$ 和对应的 $y$，求解 $(x_1, x_2)$ 的NNLS问题，并计算 $f$。每个测试用例的最终输出必须是列表 $[x_1, x_2, f]$，其中每个值都四舍五入到六位小数。将所有测试用例的结果汇总到一行，形式为一个由方括号括起来的逗号分隔列表，其中每个元素是对应一个测试用例的列表，例如 $[[x_{1,1}, x_{2,1}, f_1],[x_{1,2}, x_{2,2}, f_2],\\dots]$。\n\n为确保可复现性和覆盖范围，按如下方式定义印记和测试用例：\n\n- 印记构建：\n  - 对于 $i \\in \\{1,2,\\dots,96\\}$，定义未归一化的向量 $b_1(i) = i$ 和 $b_2(i) = 97 - i$。\n  - 进行归一化以获得印记 $S_1(i) = b_1(i) / \\sum_{k=1}^{96} b_1(k)$ 和 $S_2(i) = b_2(i) / \\sum_{k=1}^{96} b_2(k)$。\n  - 设 $A$ 是以 $S_1$ 和 $S_2$ 为列的矩阵。\n\n- 测试套件：\n  1. 理想路径精确混合：$y_1 = 50 \\, S_1 + 30 \\, S_2$。\n  2. 单一暴露度为零的边界条件：$y_2 = 100 \\, S_2$。\n  3. 偏向一个印记的带噪声测量：$y_3 = 60 \\, S_1 + n$，其中对于 $i \\in \\{1,\\dots,96\\}$，$n(i) = 0.1 \\times \\left( (i \\bmod 5) / 5.0 \\right)$。\n  4. 近共线性引起的重新分布：定义 $S_2'(i) = \\left( 0.8 \\, S_1(i) + 0.2 \\, S_2(i) \\right)$，并通过除以其总和来进行重新归一化，以使 $\\sum_{i=1}^{96} S_2'(i) = 1$；设 $y_4 = 40 \\, S_1 + 40 \\, S_2'$。针对列仍为 $S_1$ 和 $S_2$ 的矩阵 $A$ 求解暴露度。\n  5. 跨度外的未解释过程：定义 $b_3(i) = 1 + 0.5 \\times ((i \\bmod 2))$ 和 $S_3(i) = b_3(i) / \\sum_{k=1}^{96} b_3(k)$；设 $y_5 = 80 \\, S_3$。针对列为 $S_1$ 和 $S_2$ 的矩阵 $A$ 求解暴露度。\n\n- 对于每个测试用例 $t \\in \\{1,2,3,4,5\\}$：\n  - 求解 $x_t = (x_{1,t}, x_{2,t})^\\top = \\arg\\min_{x \\ge 0} \\lVert y_t - A x \\rVert_2^2$。\n  - 计算 $f_t = \\lVert y_t - A x_t \\rVert_2 / \\lVert y_t \\rVert_2$。\n\n您的程序应生成一行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个条目是对应测试用例的列表 $[x_{1,t}, x_{2,t}, f_t]$。所有值必须四舍五入到六位小数，并以十进制数表示，不带百分号。不允许用户输入或使用外部文件。计算必须是纯数值的，并且逻辑上遵循非负约束下突变印记的线性混合模型。",
            "solution": "该问题要求求解一个基于癌症基因组学原理的非负最小二乘（NNLS）优化任务，特别是突变印记分析。问题形式化良好，提供了完整的数学框架、明确定义的参数和可验证的测试用例。语言客观精确，确保了数值解的唯一性和可复现性。这是一个真实的科学问题的非平凡应用，利用了数值优化技术。\n\n任务是求解两个突变印记 $S_1$ 和 $S_2$ 的暴露度 $x_1$ 和 $x_2$，以最佳地解释一个观测到的突变计数向量 $y$。这被形式化为一个非负最小二乘（NNLS）优化问题：\n$$\n\\text{minimize } \\lVert y - Ax \\rVert_2^2 \\quad \\text{subject to} \\quad x \\ge 0\n$$\n其中矩阵 $A \\in \\mathbb{R}^{96 \\times 2}$ 以印记 $S_1$ 和 $S_2$ 为其列，$y \\in \\mathbb{R}^{96}$ 是观测到的突变计数向量，而 $x = [x_1, x_2]^\\top$ 是未知暴露度向量。维度 $96$ 对应于单碱基替换（SBS）通道的数量。\n\n解决方案分为两个主要阶段：首先，构建印记矩阵 $A$；其次，迭代处理每个测试用例。\n\n**1. 构建印记矩阵 $A$**\n\n印记 $S_1$ 和 $S_2$ 源自从通道 $i \\in \\{1, 2, \\dots, 96\\}$ 上定义的未归一化基础向量 $b_1$ 和 $b_2$。\n- $b_1(i) = i$\n- $b_2(i) = 97 - i$\n\n这些向量必须归一化，使其总和为1。归一化常数是向量元素的总和。对于 $b_1$，这是一个等差数列的和：\n$$\n\\sum_{k=1}^{96} b_1(k) = \\sum_{k=1}^{96} k = \\frac{96 \\times (96 + 1)}{2} = \\frac{96 \\times 97}{2} = 4656\n$$\n根据对称性，$b_2$ 的和是相同的：\n$$\n\\sum_{k=1}^{96} b_2(k) = \\sum_{k=1}^{96} (97 - k) = 96 \\times 97 - \\sum_{k=1}^{96} k = 9312 - 4656 = 4656\n$$\n因此，归一化后的印记是：\n$$\nS_1 = \\frac{b_1}{4656} \\quad \\text{and} \\quad S_2 = \\frac{b_2}{4656}\n$$\n然后通过将 $S_1$ 和 $S_2$ 作为其列来构建矩阵 $A$：$A = [S_1 | S_2]$。\n\n**2. 处理测试用例**\n\n对于五个测试用例中的每一个，都执行以下步骤：\na. **构建观测向量 $y_t$**，根据用例 $t \\in \\{1, \\dots, 5\\}$ 的特定规则。\nb. **求解NNLS问题**：我们通过求解 $x_t = \\arg\\min_{x \\ge 0} \\lVert y_t - A x \\rVert_2^2$ 来找到最优暴露度向量 $x_t = [x_{1,t}, x_{2,t}]^\\top$。这是一个标准的凸优化问题，可以使用数值算法高效求解，例如SciPy的 `scipy.optimize.nnls` 函数中实现的活动集法。\nc. **计算残差分数 $f_t$**：找到 $x_t$ 后，残差向量为 $r_t = y_t - A x_t$。量化模型未能解释的信号比例的残差分数，通过计算欧几里得范数的比率得出：\n$$\nf_t = \\frac{\\lVert r_t \\rVert_2}{\\lVert y_t \\rVert_2} = \\frac{\\lVert y_t - A x_t \\rVert_2}{\\lVert y_t \\rVert_2}\n$$\n如果 $\\lVert y_t \\rVert_2 = 0$，则 $f_t$ 定义为 $0$。\n\n这五个测试用例旨在探究模型的不同方面：\n- **用例1**：$y_1 = 50 \\, S_1 + 30 \\, S_2$。一个精确混合。我们期望解为 $x_1 \\approx 50$，$x_2 \\approx 30$，以及 $f_1 \\approx 0$。\n- **用例2**：$y_2 = 100 \\, S_2$。一个边界条件。我们期望 $x_1 \\approx 0$，$x_2 \\approx 100$，以及 $f_2 \\approx 0$。\n- **用例3**：$y_3 = 60 \\, S_1 + n$，其中 $n$ 是一个小的、结构化的噪声向量。我们期望 $x_1$ 接近 $60$，$x_2$ 接近 $0$，而 $f_3$ 很小但非零。\n- **用例4**：一个近共线性的情况。信号为 $y_4 = 40 \\, S_1 + 40 \\, S_2'$，其中 $S_2'$ 是 $S_1$ 和 $S_2$ 的线性组合。具体来说，$S_2' = 0.8 S_1 + 0.2 S_2$（由于其和已为1，因此无需归一化）。因此，$y_4 = 40 S_1 + 40(0.8 S_1 + 0.2 S_2) = 72 S_1 + 8 S_2$。我们期望求解器能找到 $x_1 \\approx 72$，$x_2 \\approx 8$，以及 $f_4 \\approx 0$。\n- **用例5**：一个跨度外的信号，$y_5 = 80 \\, S_3$，其中 $S_3$ 是一个具有交替模式的印记，与 $S_1$ 和 $S_2$ 的线性趋势不同。我们预计拟合效果会很差，导致较大的残差分数 $f_5$。\n\n每个用例的最终输出是列表 $[x_{1,t}, x_{2,t}, f_t]$，其中每个值都四舍五入到六位小数。这些列表被聚合成一个最终的列表之列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Constructs mutational signatures, generates test case data, solves the\n    Nonnegative Least Squares (NNLS) problem for each case, and computes\n    the residual norm fraction.\n    \"\"\"\n\n    # 1. Construct the base signatures S1, S2, and the matrix A.\n    # The channels are indexed i from 1 to 96.\n    i = np.arange(1, 97, dtype=float)\n\n    # Define unnormalized vectors b1 and b2.\n    b1 = i\n    b2 = 97.0 - i\n\n    # Normalize to obtain signatures S1 and S2.\n    # The normalization constant is the sum of an arithmetic series.\n    norm_const = np.sum(b1)  # 96 * 97 / 2 = 4656.0\n    S1 = b1 / norm_const\n    S2 = b2 / norm_const\n\n    # Construct the signature matrix A.\n    A = np.stack([S1, S2], axis=1)\n\n    # List to store results from all test cases.\n    all_results = []\n\n    # --- Test Case Generation and Processing ---\n\n    # Case 1: Happy path exact mixture\n    y1 = 50.0 * S1 + 30.0 * S2\n    \n    # Case 2: Boundary condition with one exposure zero\n    y2 = 100.0 * S2\n    \n    # Case 3: Noisy measurement favoring one signature\n    # n(i) = 0.1 * ((i mod 5) / 5.0) for i in {1,...,96}\n    noise_indices = np.arange(1, 97)\n    n = 0.1 * ((noise_indices % 5) / 5.0)\n    y3 = 60.0 * S1 + n\n    \n    # Case 4: Near-collinearity-induced redistribution\n    # S2' = (0.8 * S1 + 0.2 * S2), renormalized.\n    # The sum of S2_prime_unnorm is already 1, so renormalization is trivial.\n    S2_prime_unnorm = 0.8 * S1 + 0.2 * S2\n    norm_s2p = np.sum(S2_prime_unnorm)\n    S2_prime = S2_prime_unnorm / norm_s2p\n    y4 = 40.0 * S1 + 40.0 * S2_prime\n    \n    # Case 5: Out-of-span unexplained process\n    # b3(i) = 1 + 0.5 * ((i mod 2))\n    b3_indices = np.arange(1, 97)\n    b3 = 1.0 + 0.5 * (b3_indices % 2)\n    S3 = b3 / np.sum(b3)\n    y5 = 80.0 * S3\n\n    test_cases_y = [y1, y2, y3, y4, y5]\n\n    for y in test_cases_y:\n        # Solve the NNLS problem: min ||Ax - y||_2^2 subject to x >= 0\n        x, residual_norm = nnls(A, y)\n        \n        # Compute the residual fraction f\n        y_norm = np.linalg.norm(y)\n        f = residual_norm / y_norm if y_norm > 0 else 0.0\n        \n        # Get exposures x1 and x2\n        x1 = x[0]\n        x2 = x[1]\n        \n        # Append the rounded results\n        result = [round(x1, 6), round(x2, 6), round(f, 6)]\n        all_results.append(result)\n\n    # Final print statement in the exact required format.\n    # The str() of a list gives the desired '[...]' format.\n    print(f\"[[{', '.join(map(str, result))}] for result in all_results]\".replace(\"'\", \"\"))\n\nsolve()\n```"
        }
    ]
}