{
    "hands_on_practices": [
        {
            "introduction": "理解基因型、药物清除率（$CL$）和全身暴露量之间的定量关系是药物基因组学的基石。本练习将指导您从基本原理出发，推导并应用核心的药代动力学公式，以量化遗传决定的代谢能力下降如何直接影响药物浓度-时间曲线下面积（$AUC$）和消除半衰期（$t_{1/2}$）等关键指标。这项实践旨在巩固基因型指导下剂量调整的理论基础。",
            "id": "4314309",
            "problem": "在精准医疗的药物基因组学 (PGx) 背景下，对一种小分子药物进行单次口服给药。假设药物遵循线性单室药代动力学模型和一级消除，且患者的生理状况满足吸收、分布、代谢和排泄 (ADME) 过程的基本质量平衡假设。给药剂量为 $D=100$ mg，表观系统清除率为 $CL=10$ L/h，绝对生物利用度为 $F=0.5$。表观分布容积为 $V=40$ L。后来发现该患者携带一种与肝酶活性降低相关的基因型，该基因型导致其代谢能力下降，使得 $CL$ 乘以因子 $0.5$（即降低了 $50\\%$），而 $V$ 和 $F$ 保持不变。\n\n从一级消除条件下清除率作为连接消除速率与浓度的比例常数的定义出发，利用单室模型和体内药物量的质量平衡，推导单次给药后血浆药物浓度-时间曲线下面积 (AUC) 关于 $F$、$D$ 和 $CL$ 的通用表达式。然后，推导消除半衰期 $t_{1/2}$ 关于 $CL$ 和 $V$ 的通用表达式。\n\n使用这些推导出的表达式：\n1. 计算未知基因型时的基线 AUC。\n2. 计算基因型使 $CL$ 降低因子 $0.5$ 后的 AUC。\n3. 计算未知基因型时的基线 $t_{1/2}$。\n4. 计算基因型使 $CL$ 降低因子 $0.5$ 后的 $t_{1/2}$。\n\n将 AUC 的单位表示为 mg·h/L，$t_{1/2}$ 的单位表示为小时。将所有数值结果四舍五入至四位有效数字。以行向量的形式提供最终结果，其中依次包含基线 AUC、基因型影响后的 AUC、基线 $t_{1/2}$ 和基因型影响后的 $t_{1/2}$。",
            "solution": "该问题是有效的，因为它科学地基于标准的药代动力学原理，内容自洽且提问明确。唯一解所需的所有必要数据和定义均已提供。我们首先按要求推导通用表达式。\n\n首先，我们推导血浆药物浓度-时间曲线下面积 ($AUC$) 的表达式。质量平衡的基本原理要求，从体内消除的药物总量必须等于进入体循环的药物总量。进入体循环的药物量是给药剂量 $D$ 和绝对生物利用度 $F$ 的乘积。\n$$\n\\text{吸收量} = F \\cdot D\n$$\n药物从体内的消除速率定义为系统清除率 $CL$ 与血浆药物浓度 $C(t)$ 的乘积。\n$$\n\\text{消除速率} = CL \\cdot C(t)\n$$\n在所有时间内消除的药物总量是消除速率从时间 $t=0$ 到 $t=\\infty$ 的积分。\n$$\n\\text{总消除量} = \\int_{0}^{\\infty} CL \\cdot C(t) \\, dt\n$$\n假设清除率 $CL$ 在测量期间是恒定的，可以将其从积分中提出。\n$$\n\\text{总消除量} = CL \\int_{0}^{\\infty} C(t) \\, dt\n$$\n$\\int_{0}^{\\infty} C(t) \\, dt$ 这一项是从零到无穷大的血浆药物浓度-时间曲线下面积的定义，记为 $AUC$。\n$$\n\\text{总消除量} = CL \\cdot AUC\n$$\n令吸收量等于消除量，可得：\n$$\nF \\cdot D = CL \\cdot AUC\n$$\n求解 $AUC$，我们得到通用表达式：\n$$\nAUC = \\frac{F \\cdot D}{CL}\n$$\n接下来，我们推导消除半衰期 $t_{1/2}$ 的通用表达式。对于一级消除的单室模型，吸收阶段完成后，体内药物量 $A(t)$ 的下降由以下微分方程描述：\n$$\n\\frac{dA(t)}{dt} = -k_e A(t)\n$$\n其中 $k_e$ 是一级消除速率常数。该方程的解是一个指数衰减函数：\n$$\nA(t) = A_0 \\exp(-k_e t)\n$$\n其中 $A_0$ 是消除阶段开始时的药物量。半衰期 $t_{1/2}$ 定义为药物量减少至其初始值一半所需的时间，即 $A(t_{1/2}) = A_0 / 2$。\n$$\n\\frac{A_0}{2} = A_0 \\exp(-k_e t_{1/2})\n$$\n$$\n\\frac{1}{2} = \\exp(-k_e t_{1/2})\n$$\n取两边的自然对数：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = -k_e t_{1/2} \\implies -\\ln(2) = -k_e t_{1/2}\n$$\n这给出了 $t_{1/2}$ 和 $k_e$ 之间的关系：\n$$\nt_{1/2} = \\frac{\\ln(2)}{k_e}\n$$\n为将 $t_{1/2}$ 与 $CL$ 和表观分布容积 $V$ 联系起来，我们使用消除速率的两个定义：消除速率 $= k_e A(t)$ 和消除速率 $= CL \\cdot C(t)$。\n我们还使用表观分布容积的定义：$A(t) = V \\cdot C(t)$。\n令两个消除速率的表达式相等：\n$$\nk_e A(t) = CL \\cdot C(t)\n$$\n代入 $A(t) = V \\cdot C(t)$：\n$$\nk_e V C(t) = CL \\cdot C(t)\n$$\n假设 $C(t) \\neq 0$，我们可以除以 $C(t)$ 来找到 $k_e$、$V$ 和 $CL$ 之间的关系：\n$$\nk_e = \\frac{CL}{V}\n$$\n将这个 $k_e$ 的表达式代入 $t_{1/2}$ 的方程中：\n$$\nt_{1/2} = \\frac{\\ln(2)}{CL/V} = \\frac{V \\ln(2)}{CL}\n$$\n现在，我们使用这些推导出的表达式来计算所需的值。\n\n给定的基线参数是：\n剂量，$D = 100$ mg\n生物利用度，$F = 0.5$\n基线清除率，$CL_{base} = 10$ L/h\n分布容积，$V = 40$ L\n\n1. 计算基线 AUC ($AUC_{base}$)。\n使用推导出的 $AUC$ 公式：\n$$\nAUC_{base} = \\frac{F \\cdot D}{CL_{base}} = \\frac{0.5 \\cdot 100 \\text{ mg}}{10 \\text{ L/h}} = \\frac{50}{10} \\frac{\\text{mg} \\cdot \\text{h}}{\\text{L}} = 5 \\frac{\\text{mg} \\cdot \\text{h}}{\\text{L}}\n$$\n四舍五入到四位有效数字，结果是 $5.000$ mg·h/L。\n\n2. 计算基因型影响后的 AUC ($AUC_{pgx}$)。\n该基因型使 $CL$ 乘以因子 $0.5$。新的清除率 $CL_{pgx}$ 为：\n$$\nCL_{pgx} = CL_{base} \\times 0.5 = 10 \\text{ L/h} \\times 0.5 = 5 \\text{ L/h}\n$$\n参数 $F$ 和 $D$ 保持不变。\n$$\nAUC_{pgx} = \\frac{F \\cdot D}{CL_{pgx}} = \\frac{0.5 \\cdot 100 \\text{ mg}}{5 \\text{ L/h}} = \\frac{50}{5} \\frac{\\text{mg} \\cdot \\text{h}}{\\text{L}} = 10 \\frac{\\text{mg} \\cdot \\text{h}}{\\text{L}}\n$$\n四舍五入到四位有效数字，结果是 $10.00$ mg·h/L。\n\n3. 计算基线 $t_{1/2}$ ($t_{1/2, base}$)。\n使用推导出的 $t_{1/2}$ 公式：\n$$\nt_{1/2, base} = \\frac{V \\ln(2)}{CL_{base}} = \\frac{40 \\text{ L} \\cdot \\ln(2)}{10 \\text{ L/h}} = 4 \\ln(2) \\text{ h}\n$$\n使用 $\\ln(2) \\approx 0.693147$，我们得到：\n$$\nt_{1/2, base} \\approx 4 \\times 0.693147 \\text{ h} \\approx 2.772588 \\text{ h}\n$$\n四舍五入到四位有效数字，结果是 $2.773$ h。\n\n4. 计算基因型影响后的 $t_{1/2}$ ($t_{1/2, pgx}$)。\n分布容积 $V$ 保持不变。清除率为 $CL_{pgx} = 5$ L/h。\n$$\nt_{1/2, pgx} = \\frac{V \\ln(2)}{CL_{pgx}} = \\frac{40 \\text{ L} \\cdot \\ln(2)}{5 \\text{ L/h}} = 8 \\ln(2) \\text{ h}\n$$\n使用 $\\ln(2) \\approx 0.693147$，我们得到：\n$$\nt_{1/2, pgx} \\approx 8 \\times 0.693147 \\text{ h} \\approx 5.545176 \\text{ h}\n$$\n四舍五入到四位有效数字，结果是 $5.545$ h。\n\n最终结果是：\n基线 AUC：$5.000$ mg·h/L\n基因型影响后的 AUC：$10.00$ mg·h/L\n基线 $t_{1/2}$：$2.773$ h\n基因型影响后的 $t_{1/2}$：$5.545$ h\n\n按要求以行向量的形式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 5.000  10.00  2.773  5.545 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "除了改变药物代谢，遗传变异还可以修饰药物作用的靶点，从而改变患者对治疗的敏感性。本练习将我们的焦点从药代动力学转向药效动力学，利用经典的 $E_{\\max}$ 模型来探讨由基因型驱动的半数效应浓度（$EC_{50}$）升高，如何在临床相关浓度下削弱药物效应。掌握这一概念对于预测药物靶蛋白本身存在变异时的疗效至关重要。",
            "id": "4314263",
            "problem": "一种小分子镇痛药通过在稳态下与组织房室中的单一受体类别可逆结合来发挥其药效学效应。患者的吸收、分布、代谢和排泄（ADME）过程在给药间隔内维持固定的细胞外药物浓度，分别为 $1\\,\\mathrm{mg/L}$ 和 $4\\,\\mathrm{mg/L}$。在参考基因型中，药物-受体系统遵循单调饱和响应，最大效应 $E_{\\max}=100\\,\\mathrm{units}$，Hill系数 $\\gamma=1$。在一个药物基因组学（PGx）变异体中，应用相同的组织和ADME条件，但靶点敏感性降低，使得半数有效浓度 $EC_{50}$ 从 $2\\,\\mathrm{mg/L}$ 增加到 $3\\,\\mathrm{mg/L}$，而 $\\gamma=1$ 保持不变。\n\n使用受体占有理论和针对 $\\gamma=1$ 的单一结合位点的稳态质量作用原理，推导效应与浓度之间的关系，计算在 $EC_{50}=2\\,\\mathrm{mg/L}$ 和 $EC_{50}=3\\,\\mathrm{mg/L}$ 两种情况下，当浓度 $C=1\\,\\mathrm{mg/L}$ 和 $C=4\\,\\mathrm{mg/L}$ 时的预期效应，然后，为总结在这两个临床相关浓度下药效学响应的总体变化，计算比率\n$$R=\\frac{E(1\\,\\mathrm{mg/L})+E(4\\,\\mathrm{mg/L})\\text{ 在 }EC_{50}=2\\,\\mathrm{mg/L}\\text{ 条件下}}{E(1\\,\\mathrm{mg/L})+E(4\\,\\mathrm{mg/L})\\text{ 在 }EC_{50}=3\\,\\mathrm{mg/L}\\text{ 条件下}}.$$\n将 $R$ 以最简精确分数形式报告。不要四舍五入。比率 $R$ 是无量纲的。",
            "solution": "首先验证问题，以确保其具有科学依据、提法恰当且客观。\n\n**步骤1：提取已知条件**\n- **系统**：一种小分子镇痛药通过在稳态下与单一受体类别可逆结合来发挥其效应。\n- **浓度**：固定的细胞外药物浓度为 $C_1 = 1\\,\\mathrm{mg/L}$ 和 $C_2 = 4\\,\\mathrm{mg/L}$。\n- **参考基因型参数**：\n  - 最大效应，$E_{\\max} = 100\\,\\mathrm{units}$。\n  - Hill系数，$\\gamma = 1$。\n  - 半数有效浓度，$EC_{50, \\text{ref}} = 2\\,\\mathrm{mg/L}$。\n- **PGx变异基因型参数**：\n  - 最大效应，$E_{\\max} = 100\\,\\mathrm{units}$（不变）。\n  - Hill系数，$\\gamma = 1$（不变）。\n  - 半数有效浓度，$EC_{50, \\text{var}} = 3\\,\\mathrm{mg/L}$。\n- **待求计算**：比率 $R$ 定义为：\n$$R=\\frac{E(1\\,\\mathrm{mg/L})+E(4\\,\\mathrm{mg/L})\\text{ 在 }EC_{50}=2\\,\\mathrm{mg/L}\\text{ 条件下}}{E(1\\,\\mathrm{mg/L})+E(4\\,\\mathrm{mg/L})\\text{ 在 }EC_{50}=3\\,\\mathrm{mg/L}\\text{ 条件下}}$$\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了一个经典的药效学场景，由Hill-Langmuir方程控制，这是受体理论和药理学的基础。药物基因组学变异体改变诸如 $EC_{50}$ 之类的动力学参数的概念是药物基因组学（PGx）的核心原则。该问题在科学上是合理的。\n- **提法恰当性**：所有必要的参数（$E_{\\max}$、$EC_{50}$、$\\gamma$）和条件（浓度 $C$）均已提供。目标明确，可以确定唯一、稳定的解。\n- **客观性**：问题以精确、定量的术语陈述，没有歧义或主观论断。\n\n**步骤3：结论与行动**\n问题被认定为有效。将推导解答。\n\n**解题推导**\n对于具有单调饱和响应的系统，药物浓度 $C$ 与产生的药效学效应 $E$ 之间的关系由Hill-Langmuir方程描述：\n$$E(C) = \\frac{E_{\\max} \\cdot C^{\\gamma}}{EC_{50}^{\\gamma} + C^{\\gamma}}$$\n问题指定Hill系数 $\\gamma = 1$。这个特例代表了遵循质量作用动力学的单一位点结合模型，方程简化为标准Emax模型：\n$$E(C) = \\frac{E_{\\max} \\cdot C}{EC_{50} + C}$$\n我们将使用此模型计算参考基因型和变异基因型在指定浓度下的效应。\n\n**1. 参考基因型的计算**\n参考情况的参数为 $E_{\\max} = 100$ 和 $EC_{50, \\text{ref}} = 2\\,\\mathrm{mg/L}$。\n\n- 在 $C = 1\\,\\mathrm{mg/L}$ 时的效应：\n$$E_{\\text{ref}}(1) = \\frac{100 \\cdot 1}{2 + 1} = \\frac{100}{3}$$\n\n- 在 $C = 4\\,\\mathrm{mg/L}$ 时的效应：\n$$E_{\\text{ref}}(4) = \\frac{100 \\cdot 4}{2 + 4} = \\frac{400}{6} = \\frac{200}{3}$$\n\n- 参考基因型的效应总和：\n$$S_{\\text{ref}} = E_{\\text{ref}}(1) + E_{\\text{ref}}(4) = \\frac{100}{3} + \\frac{200}{3} = \\frac{300}{3} = 100$$\n\n**2. PGx变异基因型的计算**\n变异情况的参数为 $E_{\\max} = 100$ 和 $EC_{50, \\text{var}} = 3\\,\\mathrm{mg/L}$。\n\n- 在 $C = 1\\,\\mathrm{mg/L}$ 时的效应：\n$$E_{\\text{var}}(1) = \\frac{100 \\cdot 1}{3 + 1} = \\frac{100}{4} = 25$$\n\n- 在 $C = 4\\,\\mathrm{mg/L}$ 时的效应：\n$$E_{\\text{var}}(4) = \\frac{100 \\cdot 4}{3 + 4} = \\frac{400}{7}$$\n\n- 变异基因型的效应总和：\n$$S_{\\text{var}} = E_{\\text{var}}(1) + E_{\\text{var}}(4) = 25 + \\frac{400}{7} = \\frac{25 \\cdot 7}{7} + \\frac{400}{7} = \\frac{175 + 400}{7} = \\frac{575}{7}$$\n\n**3. 比率 R 的计算**\n比率 $R$ 是参考基因型的效应总和与变异基因型的效应总和之商：\n$$R = \\frac{S_{\\text{ref}}}{S_{\\text{var}}} = \\frac{100}{\\frac{575}{7}}$$\n为简化，我们将分子乘以分母的倒数：\n$$R = 100 \\cdot \\frac{7}{575} = \\frac{700}{575}$$\n为将其表示为最简精确分数，我们找到分子和分母的最大公约数。$700$ 和 $575$ 均可被 $25$ 整除。\n$$700 = 25 \\times 28$$\n$$575 = 500 + 75 = 25 \\times 20 + 25 \\times 3 = 25 \\times 23$$\n将这些因子代回 $R$ 的表达式中：\n$$R = \\frac{25 \\times 28}{25 \\times 23} = \\frac{28}{23}$$\n因此，比率 $R$ 为 $\\frac{28}{23}$。",
            "answer": "$$\\boxed{\\frac{28}{23}}$$"
        },
        {
            "introduction": "在真实的药物基因组学研究中，药代动力学参数并非已知，而必须通过对实验数据的分析来估计。这项高级计算实践要求您扮演药物计量学家的角色，将单室模型拟合到来自不同基因型分组的浓度-时间数据。通过实现拟合算法并使用赤池信息准则（Akaike Information Criterion, AIC）进行模型选择，您将在数据驱动的基因型-表型关联发现方面获得动手实践经验。",
            "id": "4314265",
            "problem": "您必须实现一个程序，该程序针对两个具有单剂量口服浓度-时间观测数据的基因型组，在多种可能的误差结构下，拟合一个单室口服吸收药代动力学模型，使用赤池信息准则选择最合适的误差模型，并报告各组特定的参数估计值及其差异。背景是药物基因组学，其中遗传变异会影响吸收、分布、代谢和排泄 (ADME) 的参数，特别是在精准医疗和基因组诊断领域中影响清除率。程序必须完全自包含且具有确定性，仅使用本文提供的数据和标准的数值优化方法。\n\n使用以下科学标准的质量平衡描述来描述一个具有一级吸收的单室模型：\n- 设胃肠道中的药物量为 $A_g(t)$，中央室中的药物量为 $A_c(t)$。\n- 吸收速率常数 $k_a$ 的单位为 $\\mathrm{h}^{-1}$，清除率 $CL$ 的单位为 $\\mathrm{L}\\,\\mathrm{h}^{-1}$，分布容积 $V$ 的单位为 $\\mathrm{L}$。\n- 消除速率常数 $k_e = CL/V$ 的单位为 $\\mathrm{h}^{-1}$。\n- 口服剂量 $D$ 为 $\\mathrm{mg}$，生物利用度为 $F$（无单位）。\n- 初始条件为 $A_g(0) = F\\,D$ 和 $A_c(0) = 0$。\n- 常微分方程为\n$$\\frac{dA_g(t)}{dt} = -k_a\\,A_g(t),$$\n$$\\frac{dA_c(t)}{dt} = k_a\\,A_g(t) - k_e\\,A_c(t),$$\n血浆浓度为 $C(t) = \\frac{A_c(t)}{V}$，单位为 $\\mathrm{mg}\\,\\mathrm{L}^{-1}$。\n\n模型拟合必须通过最大化观测浓度的高斯似然来进行，这等同于最小化负对数似然。设在采样时间 $t_i$ 的观测浓度为 $y_i$，相应的模型预测值为 $\\hat{y}_i$。对于每次观测，根据误差模型定义一个特定于观测的标准差 $\\sigma_i$。负对数似然（不计加法常数）为\n$$\n\\mathrm{NLL}(k_a,CL,V) = \\frac{1}{2}\\sum_{i=1}^{n}\\left[\\ln\\left(2\\pi\\,\\sigma_i^2\\right) + \\frac{\\left(y_i - \\hat{y}_i\\right)^2}{\\sigma_i^2}\\right].\n$$\n您必须考虑三种候选误差模型：\n1. 加性误差: $\\sigma_i = \\sigma_a$。\n2. 比例误差: $\\sigma_i = \\sigma_p\\,\\hat{y}_i$。\n3. 组合加性与比例误差: $\\sigma_i = \\sqrt{\\sigma_a^2 + \\left(\\sigma_p\\,\\hat{y}_i\\right)^2}$。\n\n使用以下固定的误差幅值，其中 $\\sigma_a$ 的单位为 $\\mathrm{mg}\\,\\mathrm{L}^{-1}$，$\\sigma_p$ 无单位：\n- $\\sigma_a = 0.05$，\n- $\\sigma_p = 0.10$。\n\n模型选择必须对拟合参数使用赤池信息准则：\n$$\n\\mathrm{AIC} = 2k + 2\\,\\mathrm{NLL},\n$$\n其中 $k$ 是估计的自由参数数量，这里 $k=3$（即 $k_a$, $CL$, $V$）。对于每个基因型组，拟合所有三个误差模型，计算它们的赤池信息准则，并选择赤池信息准则最小的模型作为最合适的模型。报告每个组在所选模型下的参数估计值。\n\n使用以下给药和采样规格：\n- 剂量 $D = 100\\,\\mathrm{mg}$。\n- 生物利用度 $F = 1$。\n- 采样时间（小时）: $[0.25, 0.5, 1, 2, 4, 6, 8, 12, 24]$。\n\n观测到的浓度（单位为 $\\mathrm{mg}\\,\\mathrm{L}^{-1}$）是：\n- 基因型组 $G_1$: $[0.36, 0.62, 0.92, 1.08, 0.90, 0.69, 0.52, 0.29, 0.05]$。\n- 基因型组 $G_2$: $[0.31, 0.55, 0.86, 1.13, 1.12, 1.01, 0.88, 0.67, 0.29]$。\n\n必须对参数施加生理上和数值上合理的约束：\n- $k_a > 0$,\n- $CL > 0$,\n- $V > 0$。\n您必须通过使用适当的极限行为来确保在 $k_a$ 接近 $k_e$ 时的数值稳定性，以避免除以零。\n\n您的程序必须：\n- 为每个基因型组独立地实现上述模型和拟合过程。\n- 对每个基因型组，评估所有三个误差模型，选择赤池信息准则最小的一个，并返回相应的参数估计值。\n- 计算并报告基因型组之间的差异为 $(\\Delta k_a, \\Delta CL, \\Delta V) = (k_{a,G_2} - k_{a,G_1}, CL_{G_2} - CL_{G_1}, V_{G_2} - V_{G_1})$。\n\n最终答案的单位规格：\n- 报告 $k_a$ 的单位为 $\\mathrm{h}^{-1}$，$CL$ 的单位为 $\\mathrm{L}\\,\\mathrm{h}^{-1}$，$V$ 的单位为 $\\mathrm{L}$。\n- 将所有输出表示为四舍五入到三位小数的浮点数。不要打印单位；它们由位置隐含。\n\n测试套件和覆盖范围：\n- 测试用例 $T_1$：在两组上使用 $\\sigma_a = 0.05$ 和 $\\sigma_p = 0$ 的加性误差模型。\n- 测试用例 $T_2$：在两组上使用 $\\sigma_a = 0$ 和 $\\sigma_p = 0.10$ 的比例误差模型。\n- 测试用例 $T_3$：在两组上使用 $\\sigma_a = 0.05$ 和 $\\sigma_p = 0.10$ 的组合误差模型。\n对于每个组，通过赤池信息准则选择表现最佳的测试用例并使用其估计值。该集合探测了同方差和异方差假设，并提供了跨典型药代动力学误差结构的覆盖。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含九个结果，形式为逗号分隔的列表，并用方括号括起来：\n$[k_{a,G_1},CL_{G_1},V_{G_1},k_{a,G_2},CL_{G_2},V_{G_2},\\Delta k_a,\\Delta CL,\\Delta V]$,\n按照上述单位，四舍五入到三位小数，无多余字符或换行。",
            "solution": "该问题要求将一个单室口服吸收药代动力学模型拟合到来自两个不同基因型组 $G_1$ 和 $G_2$ 的浓度-时间数据。目标是估计每个组的关键药代动力学参数，使用赤池信息准则 (AIC) 为每个组选择最合适的误差模型，并报告参数估计值及其差异。这种方法是药物基因组学研究中的标准做法，用于量化遗传变异对药物处置的影响。\n\n该过程分几步执行：定义浓度模型，建立参数估计的统计框架，执行数值优化，以及应用模型选择准则。\n\n具有一级吸收的单室模型由一个线性常微分方程组描述，该方程组描述了药物在肠道 $A_g(t)$ 和中央室 $A_c(t)$ 中的量：\n$$\n\\frac{dA_g(t)}{dt} = -k_a\\,A_g(t)\n$$\n$$\n\\frac{dA_c(t)}{dt} = k_a\\,A_g(t) - k_e\\,A_c(t)\n$$\n初始条件为 $A_g(0) = F\\,D$ 和 $A_c(0) = 0$。参数包括吸收速率常数 $k_a$、消除速率常数 $k_e$、剂量 $D$ 和生物利用度 $F$。血浆浓度由 $C(t) = A_c(t)/V$ 给出，其中 $V$ 是分布容积。消除速率常数 $k_e$ 定义为清除率 $CL$ 与分布容积 $V$ 的比值，即 $k_e = CL/V$。\n\n该系统的解析解提供了模型预测的浓度 $\\hat{y}(t) = C(t)$，由 Bateman 函数给出。对于 $k_a \\neq k_e$ 的情况：\n$$\nC(t) = \\frac{F D k_a}{V(k_a - k_e)} \\left( e^{-k_e t} - e^{-k_a t} \\right)\n$$\n当 $k_a$ 接近 $k_e$ 时，该方程在数值上不稳定。在 $k_a = k_e$ 的特定情况下，解变为：\n$$\nC(t) = \\frac{F D k_a}{V} t\\,e^{-k_a t}\n$$\n为确保数值稳定性，当 $|k_a - k_e|$ 小于定义的容差时，实现会切换到此极限形式。每个基因型组要估计的参数是 $\\theta = (k_a, CL, V)$。\n\n参数估计通过最大化观测数据的高斯似然来进行，这等同于最小化负对数似然 (NLL)。NLL 由下式给出：\n$$\n\\mathrm{NLL}(\\theta) = \\frac{1}{2}\\sum_{i=1}^{n}\\left[\\ln\\left(2\\pi\\,\\sigma_i^2\\right) + \\frac{\\left(y_i - \\hat{y}_i\\right)^2}{\\sigma_i^2}\\right]\n$$\n其中 $y_i$ 是观测浓度，$\\hat{y}_i$ 是模型预测的浓度，$\\sigma_i$ 是第 $i$ 次测量的标准差，由一个误差模型定义。使用给定的固定常数 $\\sigma_a = 0.05$ 和 $\\sigma_p = 0.10$ 评估三个候选误差模型：\n1.  **加性误差:** $\\sigma_i = \\sigma_a$。该模型假设在所有浓度水平上误差方差恒定。\n2.  **比例误差:** $\\sigma_i = \\sigma_p\\,\\hat{y}_i$。该模型假设误差方差与浓度成比例增加。\n3.  **组合误差:** $\\sigma_i = \\sqrt{\\sigma_a^2 + (\\sigma_p\\,\\hat{y}_i)^2}$。该模型结合了加性和比例成分，能够适应低浓度时的恒定误差和高浓度时的比例误差。\n\n使用数值优化来寻找能使给定数据集和误差模型的 NLL 最小化的参数集 $\\theta$。为此任务，我们采用了 `scipy.optimize.minimize` 函数和 `Nelder-Mead` 算法。为了强制所有参数都为正的生理约束（即 $k_a > 0, CL > 0, V > 0$），优化在参数的自然对数上进行：$(\\ln(k_a), \\ln(CL), \\ln(V))$。这种变换将受约束的正数域映射到无约束的实数域，提高了优化的稳定性和效率。\n\n在为给定基因型组拟合所有三个误差模型后，使用赤池信息准则 (AIC) 进行模型选择。AIC 在模型的拟合优度（由 NLL 代表）和模型复杂度（由估计参数的数量代表）之间提供了一个有原则的权衡。其公式为：\n$$\n\\mathrm{AIC} = 2k + 2\\,\\mathrm{NLL}\n$$\n根据规定，所有模型估计的药代动力学参数数量为 $k=3$（$k_a, CL, V$），因为误差参数 $\\sigma_a$ 和 $\\sigma_p$ 是固定常数而非估计变量。对于每个基因型组，选择 AIC 值最小的模型作为对数据最合理的描述。\n\n总体工作流程如下：\n1.  对于每个基因型组（$G_1$ 和 $G_2$），通过最小化相应的 NLL 函数，将其各自的浓度-时间数据拟合到三个误差模型。\n2.  为三个拟合中的每一个计算 AIC。\n3.  选择产生最低 AIC 的模型作为该组的最佳拟合模型，并保留其估计参数（$k_a, CL, V$）。\n4.  最后，计算两组参数之间的差异：$(\\Delta k_a, \\Delta CL, \\Delta V) = (k_{a,G_2} - k_{a,G_1}, CL_{G_2} - CL_{G_1}, V_{G_2} - V_{G_1})$。\n5.  将九个结果值格式化并报告为单个逗号分隔的列表。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Fits a one-compartment oral absorption PK model to data from two genotype groups,\n    selects the best error model via AIC for each, and reports the final parameter estimates\n    and their differences.\n    \"\"\"\n    # --- Givens from the problem statement ---\n    D = 100.0  # Dose in mg\n    F = 1.0    # Bioavailability (unitless)\n    SIGMA_A = 0.05  # Additive error component in mg/L\n    SIGMA_P = 0.10  # Proportional error component (unitless)\n    K_PARAMS = 3  # Number of estimated parameters (ka, CL, V)\n\n    # Observation data\n    T_OBS = np.array([0.25, 0.5, 1.0, 2.0, 4.0, 6.0, 8.0, 12.0, 24.0])\n    Y_OBS_G1 = np.array([0.36, 0.62, 0.92, 1.08, 0.90, 0.69, 0.52, 0.29, 0.05])\n    Y_OBS_G2 = np.array([0.31, 0.55, 0.86, 1.13, 1.12, 1.01, 0.88, 0.67, 0.29])\n\n    def concentration_model(t, params):\n        \"\"\"\n        Calculates plasma concentration C(t) for a one-compartment oral model.\n        params: a tuple or list [ka, CL, V].\n        \"\"\"\n        ka, cl, v = params\n        \n        # This function should only be called with positive parameters from the optimizer\n        ke = cl / v\n        \n        # Use limiting form for numerical stability when ka is close to ke\n        if np.isclose(ka, ke, rtol=1e-5, atol=1e-8):\n            conc = (F * D / v) * ka * t * np.exp(-ka * t)\n        else:\n            # Standard Bateman function for one-compartment oral absorption\n            conc = (F * D * ka) / (v * (ka - ke)) * (np.exp(-ke * t) - np.exp(-ka * t))\n        \n        return conc\n\n    def nll_objective(log_params, t_obs, y_obs, error_model):\n        \"\"\"\n        Negative log-likelihood function to be minimized by the optimizer.\n        Uses log-transformed parameters to ensure positivity.\n        \"\"\"\n        params = np.exp(log_params)\n        \n        y_hat = concentration_model(t_obs, params)\n        \n        # Calculate squared standard deviation (variance) based on the error model\n        if error_model == 'additive':\n            sigma_sq = SIGMA_A**2\n        elif error_model == 'proportional':\n            # Clamp to a small positive value to avoid log(0) or division by zero\n            sigma_sq = np.maximum((SIGMA_P * y_hat)**2, 1e-12)\n        elif error_model == 'combined':\n            sigma_sq = SIGMA_A**2 + (SIGMA_P * y_hat)**2\n        else:\n            # This case should not be reached with the current implementation\n            raise ValueError(\"Invalid error model specified.\")\n\n        # Calculate negative log-likelihood\n        # NLL = 0.5 * sum(log(2*pi*sigma^2) + (y_obs - y_hat)^2 / sigma^2)\n        nll_val = 0.5 * np.sum(np.log(2 * np.pi * sigma_sq) + ((y_obs - y_hat)**2 / sigma_sq))\n        \n        # Return a large number if NLL is not finite, guiding the optimizer\n        if not np.isfinite(nll_val):\n            return np.inf\n\n        return nll_val\n\n    def fit_group_data(y_obs, t_obs):\n        \"\"\"\n        Fits the PK model to a single group's data across all three error models,\n        selects the best model using AIC, and returns the corresponding parameters.\n        \"\"\"\n        # Initial guess for log-transformed parameters: [log(ka), log(CL), log(V)]\n        initial_guess_log = np.log([1.0, 10.0, 65.0])\n        error_models = ['additive', 'proportional', 'combined']\n        \n        best_aic = np.inf\n        best_params = None\n        \n        for model in error_models:\n            res = minimize(\n                nll_objective,\n                initial_guess_log,\n                args=(t_obs, y_obs, model),\n                method='Nelder-Mead',\n                options={'xatol': 1e-8, 'disp': False}\n            )\n            \n            if res.success:\n                min_nll = res.fun\n                aic = 2 * K_PARAMS + 2 * min_nll\n                \n                if aic  best_aic:\n                    best_aic = aic\n                    best_params = np.exp(res.x) # Convert optimal log-params back to linear space\n    \n        return best_params\n\n    # --- Main Execution Logic ---\n    \n    # Fit data for Genotype Group 1\n    params_g1 = fit_group_data(Y_OBS_G1, T_OBS)\n    \n    # Fit data for Genotype Group 2\n    params_g2 = fit_group_data(Y_OBS_G2, T_OBS)\n    \n    # Calculate differences between group parameters\n    diffs = params_g2 - params_g1\n    \n    # Combine all results into a single array for printing\n    all_results = np.concatenate((params_g1, params_g2, diffs))\n\n    # Format results to three decimal places as specified\n    formatted_results = [f\"{x:.3f}\" for x in all_results]\n    \n    # Print the final output in the required single-line format\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}