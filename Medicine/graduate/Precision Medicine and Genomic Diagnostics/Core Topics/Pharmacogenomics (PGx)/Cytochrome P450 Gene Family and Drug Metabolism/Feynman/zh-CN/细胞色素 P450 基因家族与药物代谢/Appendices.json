{
    "hands_on_practices": [
        {
            "introduction": "这第一个练习旨在建立药物遗传学变异与其对药物暴露量影响之间的基本定量联系。通过计算一种主要由 CYP2D6 清除的药物在慢代谢者体内的血药浓度-时间曲线下面积（$AUC$）的增加倍数，您将掌握 $f_m$（药物经由特定途径代谢的比例）这一概念，并理解其在预测遗传效应强度中的关键作用。这项基础技能对于解读药物基因组学测试报告至关重要。",
            "id": "4329846",
            "problem": "一位临床医生正在精准医疗的背景下，根据药物基因组学结果为一名患者优化治疗方案。该患者的基因型表明其具有功能缺失的细胞色素P450 (CYP) 2D6等位基因，这与细胞色素P450 2D6慢代谢者 (PM) 表型一致。考虑一种通过单次静脉推注给药的药物，以避免吸收过程的干扰，其消除完全通过代谢清除途径。在快代谢者 (EM) 的基线条件下，总清除率是各特定途径清除率之和。对于该药物，经细胞色素P450 2D6代谢的分数定义为 $f_m^{\\mathrm{CYP2D6}} = \\frac{CL_{\\mathrm{CYP2D6}}}{CL_{\\mathrm{total}}}$，测得其值为 $f_m^{\\mathrm{CYP2D6}} = 0.9$。\n\n假设在线性药代动力学下存在以下基本前提：\n- 静脉推注剂量 $D$ 后，从时间零到无穷大的曲线下面积 (AUC) 为 $ \\mathrm{AUC} = \\frac{D}{CL_{\\mathrm{total}}}$。\n- 在细胞色素P450 2D6慢代谢者表型中，$CL_{\\mathrm{CYP2D6}} \\approx 0$。\n- 非细胞色素P450 2D6途径没有代偿性变化，且分布容积保持不变。\n\n使用这些假设和定义，从第一性原理推导细胞色素P450 2D6慢代谢者相对于快代谢者的 $ \\mathrm{AUC}$ 预期增加倍数。请以纯数字形式提供最终答案，不带单位。不要四舍五入，报告精确值。",
            "solution": "在尝试求解之前，对问题陈述的有效性进行评估。\n\n**步骤 1：提取已知条件**\n- 患者表型：细胞色素P450 2D6慢代谢者 (PM)。\n- 基线（对照）表型：快代谢者 (EM)。\n- 给药方式：单次静脉 (IV) 推注剂量 $D$。\n- 消除：完全通过代谢清除。\n- 总清除率 ($CL_{\\mathrm{total}}$)：各特定途径清除率之和。\n- 快代谢者中经细胞色素P450 2D6代谢的分数：$f_m^{\\mathrm{CYP2D6}} = \\frac{CL_{\\mathrm{CYP2D6}}}{CL_{\\mathrm{total}}} = 0.9$。\n- 从时间零到无穷大的曲线下面积 (AUC)：$\\mathrm{AUC} = \\frac{D}{CL_{\\mathrm{total}}}$。\n- 慢代谢者中经CYP2D6的清除率：$CL_{\\mathrm{CYP2D6}} \\approx 0$。\n- 辅助假设：非细胞色素P450 2D6途径无代偿性变化；分布容积保持不变。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上和数学上都是合理的。\n- **科学依据：** 该问题基于药代动力学和药物基因组学的核心既定原则。细胞色素P450酶（特别是CYP2D6）在药物代谢中的作用以及基因多态性（如PM表型）对药物暴露（通过AUC衡量）的影响是精准医疗中的基本概念。\n- **适定性：** 问题定义清晰，提供了推导唯一、有意义解所需的所有参数和关系。问题要求一个具体的、可计算的量（AUC的增加倍数）。\n- **客观性：** 语言正式、精确、客观，使用了标准的科学术语。\n- **完整性和一致性：** 所提供的假设（线性药代动力学，其他途径无变化）是明确的，并构成了一个自洽、无矛盾的可解系统。对于具有功能缺失等位基因的PM，假设 $CL_{\\mathrm{CYP2D6}} \\approx 0$ 在此背景下是一个标准且有效的近似。\n\n**步骤 3：结论与行动**\n该问题被认定为有效。将按要求从第一性原理推导解答。\n\n**推导**\n目标是确定慢代谢者 (PM) 相对于快代谢者 (EM) 的曲线下面积 ($\\mathrm{AUC}$) 的增加倍数。这个量是比率 $\\frac{\\mathrm{AUC}_{\\mathrm{PM}}}{\\mathrm{AUC}_{\\mathrm{EM}}}$。\n\n剂量 ($D$)、总清除率 ($CL_{\\mathrm{total}}$) 和 $\\mathrm{AUC}$ 之间的关系如下：\n$$ \\mathrm{AUC} = \\frac{D}{CL_{\\mathrm{total}}} $$\n\n由于剂量 $D$ 是以单次静脉推注方式给予，并且假设在两种表型情况下相同，因此AUC的比率可以表示为：\n$$ \\frac{\\mathrm{AUC}_{\\mathrm{PM}}}{\\mathrm{AUC}_{\\mathrm{EM}}} = \\frac{\\left(\\frac{D}{CL_{\\mathrm{total, PM}}}\\right)}{\\left(\\frac{D}{CL_{\\mathrm{total, EM}}}\\right)} = \\frac{CL_{\\mathrm{total, EM}}}{CL_{\\mathrm{total, PM}}} $$\n此处，$CL_{\\mathrm{total, EM}}$ 是快代谢者的总清除率，$CL_{\\mathrm{total, PM}}$ 是慢代谢者的总清除率。\n\n药物总清除率是所有代谢途径清除率的总和。我们可以将EM中的总清除率分解为由CYP2D6介导的组分 ($CL_{\\mathrm{CYP2D6, EM}}$) 和由所有其他途径介导的组分 ($CL_{\\mathrm{other}}$)：\n$$ CL_{\\mathrm{total, EM}} = CL_{\\mathrm{CYP2D6, EM}} + CL_{\\mathrm{other}} $$\n\n在EM中，经CYP2D6代谢的药物分数已知为 $f_m^{\\mathrm{CYP2D6}} = 0.9$。根据定义：\n$$ f_m^{\\mathrm{CYP2D6}} = \\frac{CL_{\\mathrm{CYP2D6, EM}}}{CL_{\\mathrm{total, EM}}} $$\n由此，我们可以将EM中由CYP2D6介导的清除率表示为：\n$$ CL_{\\mathrm{CYP2D6, EM}} = f_m^{\\mathrm{CYP2D6}} \\cdot CL_{\\mathrm{total, EM}} $$\n\n那么，通过其他途径的清除率 $CL_{\\mathrm{other}}$ 可以用总清除率和 $f_m^{\\mathrm{CYP2D6}}$ 来表示：\n$$ CL_{\\mathrm{other}} = CL_{\\mathrm{total, EM}} - CL_{\\mathrm{CYP2D6, EM}} = CL_{\\mathrm{total, EM}} - (f_m^{\\mathrm{CYP2D6}} \\cdot CL_{\\mathrm{total, EM}}) $$\n$$ CL_{\\mathrm{other}} = (1 - f_m^{\\mathrm{CYP2D6}}) \\cdot CL_{\\mathrm{total, EM}} $$\n\n现在，我们必须定义PM患者的总清除率。问题陈述，对于PM，CYP2D6途径无功能，因此 $CL_{\\mathrm{CYP2D6, PM}} \\approx 0$。同时假设其他消除途径没有代偿性变化。因此，PM中通过其他途径的清除率与EM中相同。PM中的总清除率为：\n$$ CL_{\\mathrm{total, PM}} = CL_{\\mathrm{CYP2D6, PM}} + CL_{\\mathrm{other}} \\approx 0 + CL_{\\mathrm{other}} = CL_{\\mathrm{other}} $$\n代入EM情况下的 $CL_{\\mathrm{other}}$ 表达式：\n$$ CL_{\\mathrm{total, PM}} = (1 - f_m^{\\mathrm{CYP2D6}}) \\cdot CL_{\\mathrm{total, EM}} $$\n\n最后，我们可以通过将 $CL_{\\mathrm{total, PM}}$ 的这个表达式代入我们的比率来计算AUC的增加倍数：\n$$ \\frac{\\mathrm{AUC}_{\\mathrm{PM}}}{\\mathrm{AUC}_{\\mathrm{EM}}} = \\frac{CL_{\\mathrm{total, EM}}}{CL_{\\mathrm{total, PM}}} = \\frac{CL_{\\mathrm{total, EM}}}{(1 - f_m^{\\mathrm{CYP2D6}}) \\cdot CL_{\\mathrm{total, EM}}} $$\n分子和分母中的 $CL_{\\mathrm{total, EM}}$ 项相互抵消，得到一般关系式：\n$$ \\frac{\\mathrm{AUC}_{\\mathrm{PM}}}{\\mathrm{AUC}_{\\mathrm{EM}}} = \\frac{1}{1 - f_m^{\\mathrm{CYP2D6}}} $$\n\n代入给定值 $f_m^{\\mathrm{CYP2D6}} = 0.9$：\n$$ \\frac{\\mathrm{AUC}_{\\mathrm{PM}}}{\\mathrm{AUC}_{\\mathrm{EM}}} = \\frac{1}{1 - 0.9} = \\frac{1}{0.1} = 10 $$\n\n因此，细胞色素P450 2D6慢代谢者相对于快代谢者的AUC预期增加倍数为$10$。",
            "answer": "$$\\boxed{10}$$"
        },
        {
            "introduction": "在掌握了基因型如何影响清除率的基础之上，本练习将探讨一个更复杂且更贴近临床现实的场景：患者基因型与药物-药物相互作用（DDI）之间的相互影响。您将计算一种强效 CYP2D6 抑制剂如何对慢代谢、正常代谢和超快代谢者等不同基因型个体的药物暴露量产生不同程度的影响。这个练习旨在阐明一个关键原则：药物-药物相互作用的强度并非一成不变，而是高度依赖于个体的药物基因组学特征。",
            "id": "4329774",
            "problem": "一个临床药理学团队正在预测一种受害抗抑郁药的药物-药物相互作用风险，该药物通过两条平行途径消除：细胞色素P450 (CYP) 2D6介导的肝脏代谢和非CYP途径（主要是肾脏排泄）。临床基因分型根据CYP2D6双倍体型将个体分为功能组：快代谢者 (EM)、慢代谢者 (PM)和超快代谢者 (UM)。假设以下信息通过体外-体内外推和临床表型分析已知：\n- 在EM中，基线CYP2D6介导的清除率为$14$ L/h，基线非CYP清除率为$6$ L/h。因此，EM的总基线清除率是这些平行途径的总和。\n- 基因型仅以乘法方式修改CYP2D6介导的组分：相对于EM，PM的活性标量为$0.1\\times$，UM的活性标量为$2.0\\times$。非CYP途径与基因型无关。\n- 一种强效、可逆的CYP2D6竞争性抑制剂被共同给药。其未结合的肝入口浓度为$I_u = 1.0\\,\\mu\\mathrm{M}$，其抑制常数为$K_i = 0.20\\,\\mu\\mathrm{M}$。对于低底物浓度下线性（一级）药代动力学中的可逆竞争性抑制，被抑制的酶所贡献的内源性清除率按因子$1/(1 + I_u/K_i)$进行缩放，而其他平行途径不受影响。\n- 对于此药物和剂量，口服生物利用度和剂量不受抑制剂影响而改变，蛋白质结合率也不变。在线性药代动力学下，血浆浓度-时间曲线下面积 (AUC) 满足$AUC = F \\cdot \\mathrm{Dose} / CL$。\n\n仅使用以下原理：(i) 总清除率是平行途径的总和，(ii) 可逆竞争性抑制将受抑制途径的清除率按$1/(1 + I_u/K_i)$因子进行缩放，以及 (iii) 当$F$和剂量恒定时，$AUC$与总清除率成反比，计算每个基因型组（EM、PM、UM）的AUC倍数变化$AUC'/AUC$（使用抑制剂除以不使用抑制剂）。选择报告了正确的有序三元组$\\left(\\text{EM}, \\text{PM}, \\text{UM}\\right)$（四舍五入到两位小数）的选项。\n\nA. $\\left(2.40,\\;1.19,\\;3.19\\right)$\n\nB. $\\left(2.40,\\;1.33,\\;3.00\\right)$\n\nC. $\\left(6.00,\\;1.20,\\;6.00\\right)$\n\nD. $\\left(2.00,\\;1.20,\\;4.00\\right)$",
            "solution": "评估问题陈述的有效性。\n\n**步骤1：提取已知条件**\n- 药物消除途径：细胞色素P450 (CYP) 2D6介导的肝脏代谢和非CYP途径。\n- 基于CYP2D6双倍体型的基因型组：快代谢者 (EM)、慢代谢者 (PM) 和超快代谢者 (UM)。\n- 对于EM，基线CYP2D6介导的清除率，$CL_{CYP,EM} = 14$ L/h。\n- 对于EM，基线非CYP清除率，$CL_{non-CYP} = 6$ L/h。\n- 总基线清除率是平行途径的总和。\n- 相对于EM，CYP2D6途径的基因型修饰标量：PM为 $S_{PM} = 0.1$，UM为 $S_{UM} = 2.0$。EM的标量默认为 $S_{EM} = 1.0$。\n- 非CYP途径与基因型无关。\n- 一种可逆的CYP2D6竞争性抑制剂被共同给药。\n- 抑制剂的未结合肝入口浓度，$I_u = 1.0\\,\\mu\\mathrm{M}$。\n- 抑制剂的抑制常数，$K_i = 0.20\\,\\mu\\mathrm{M}$。\n- 受抑制酶的内源性清除率的缩放因子：$1/(1 + I_u/K_i)$。\n- 平行途径（非CYP）不受抑制剂影响。\n- 口服生物利用度（$F$）和剂量是恒定的。\n- 蛋白结合率不变。\n- 曲线下面积 (AUC) 关系：$AUC = F \\cdot \\mathrm{Dose} / CL$。\n- 问题要求计算每个基因型组（EM、PM、UM）的AUC倍数变化，$AUC'/AUC$，以有序三元组 $(\\text{EM}, \\text{PM}, \\text{UM})$ 的形式呈现，并四舍五入到两位小数。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于药代动力学和药物基因组学的既定原理，包括平行清除途径、遗传多态性对酶活性的影响（CYP2D6表型）以及竞争性酶抑制的机制。所提供的数学模型是该领域的标准模型。\n- **定义明确：** 该问题提供了计算所要求的AUC倍数变化所需的所有必要数据，并定义了所有关系。目标清晰。\n- **客观性：** 语言技术性强且精确，没有主观或含糊的术语。\n\n该问题没有表现出任何缺陷，如科学上不健全、不完整、矛盾或含糊不清。这是一个结构良好的临床药理学定量问题。\n\n**步骤3：结论与行动**\n问题有效。将推导解答。\n\n**推导**\n分析基于问题中概述的三个核心原理：\n1.  总清除率（$CL_{tot}$）是平行清除途径的总和。对于任何基因型组 $g$，基线总清除率为 $CL_{tot,g} = CL_{CYP,g} + CL_{non-CYP}$。\n2.  可逆竞争性抑制剂对CYP2D6途径的影响是将其清除率按因子 $1/(1 + I_u/K_i)$ 进行缩放。存在抑制剂时的总清除率为 $CL'_{tot,g} = CL'_{CYP,g} + CL_{non-CYP}$，其中 $CL'_{CYP,g} = CL_{CYP,g} \\cdot \\frac{1}{1 + I_u/K_i}$。\n3.  当生物利用度（$F$）和剂量恒定时，曲线下面积（$AUC$）与总清除率（$CL_{tot}$）成反比。AUC倍数变化由比率 $\\frac{AUC'}{AUC} = \\frac{F \\cdot \\mathrm{Dose} / CL'_{tot,g}}{F \\cdot \\mathrm{Dose} / CL_{tot,g}} = \\frac{CL_{tot,g}}{CL'_{tot,g}}$ 给出。\n\n首先，我们计算每个基因型组在基线时和存在抑制剂时的清除率值。\n\n所有组的非CYP清除率是恒定的：$CL_{non-CYP} = 6$ L/h。\n\nCYP2D6途径的抑制缩放因子是：\n$$ \\text{抑制因子} = \\frac{1}{1 + I_u/K_i} = \\frac{1}{1 + (1.0\\,\\mu\\mathrm{M}) / (0.20\\,\\mu\\mathrm{M})} = \\frac{1}{1 + 5} = \\frac{1}{6} $$\n\n现在，我们计算每个基因型的AUC倍数变化。\n\n**1. 快代谢者 (EM)**\n- 基线CYP2D6清除率: $CL_{CYP,EM} = 14$ L/h。\n- 基线总清除率: $CL_{tot,EM} = CL_{CYP,EM} + CL_{non-CYP} = 14\\,\\text{L/h} + 6\\,\\text{L/h} = 20$ L/h。\n- 受抑制的CYP2D6清除率: $CL'_{CYP,EM} = CL_{CYP,EM} \\times \\frac{1}{6} = 14 \\times \\frac{1}{6} = \\frac{14}{6} = \\frac{7}{3}$ L/h。\n- 含抑制剂的总清除率: $CL'_{tot,EM} = CL'_{CYP,EM} + CL_{non-CYP} = \\frac{7}{3}\\,\\text{L/h} + 6\\,\\text{L/h} = \\frac{7}{3} + \\frac{18}{3} = \\frac{25}{3}$ L/h。\n- AUC倍数变化:\n$$ \\frac{AUC'_{EM}}{AUC_{EM}} = \\frac{CL_{tot,EM}}{CL'_{tot,EM}} = \\frac{20}{25/3} = \\frac{20 \\times 3}{25} = \\frac{60}{25} = 2.4 $$\n四舍五入到两位小数，值为 $2.40$。\n\n**2. 慢代谢者 (PM)**\n- 基线CYP2D6清除率: $CL_{CYP,PM} = S_{PM} \\times CL_{CYP,EM} = 0.1 \\times 14\\,\\text{L/h} = 1.4$ L/h。\n- 基线总清除率: $CL_{tot,PM} = CL_{CYP,PM} + CL_{non-CYP} = 1.4\\,\\text{L/h} + 6\\,\\text{L/h} = 7.4$ L/h。\n- 受抑制的CYP2D6清除率: $CL'_{CYP,PM} = CL_{CYP,PM} \\times \\frac{1}{6} = 1.4 \\times \\frac{1}{6} = \\frac{1.4}{6} = \\frac{7}{30}$ L/h。\n- 含抑制剂的总清除率: $CL'_{tot,PM} = CL'_{CYP,PM} + CL_{non-CYP} = \\frac{7}{30}\\,\\text{L/h} + 6\\,\\text{L/h} = \\frac{7}{30} + \\frac{180}{30} = \\frac{187}{30}$ L/h。\n- AUC倍数变化:\n$$ \\frac{AUC'_{PM}}{AUC_{PM}} = \\frac{CL_{tot,PM}}{CL'_{tot,PM}} = \\frac{7.4}{187/30} = \\frac{7.4 \\times 30}{187} = \\frac{222}{187} \\approx 1.187165... $$\n四舍五入到两位小数，值为 $1.19$。\n\n**3. 超快代谢者 (UM)**\n- 基线CYP2D6清除率: $CL_{CYP,UM} = S_{UM} \\times CL_{CYP,EM} = 2.0 \\times 14\\,\\text{L/h} = 28$ L/h。\n- 基线总清除率: $CL_{tot,UM} = CL_{CYP,UM} + CL_{non-CYP} = 28\\,\\text{L/h} + 6\\,\\text{L/h} = 34$ L/h。\n- 受抑制的CYP2D6清除率: $CL'_{CYP,UM} = CL_{CYP,UM} \\times \\frac{1}{6} = 28 \\times \\frac{1}{6} = \\frac{28}{6} = \\frac{14}{3}$ L/h。\n- 含抑制剂的总清除率: $CL'_{tot,UM} = CL'_{CYP,UM} + CL_{non-CYP} = \\frac{14}{3}\\,\\text{L/h} + 6\\,\\text{L/h} = \\frac{14}{3} + \\frac{18}{3} = \\frac{32}{3}$ L/h。\n- AUC倍数变化:\n$$ \\frac{AUC'_{UM}}{AUC_{UM}} = \\frac{CL_{tot,UM}}{CL'_{tot,UM}} = \\frac{34}{32/3} = \\frac{34 \\times 3}{32} = \\frac{102}{32} = \\frac{51}{16} = 3.1875 $$\n四舍五入到两位小数，值为 $3.19$。\n\n计算出的AUC倍数变化有序三元组 $(\\text{EM}, \\text{PM}, \\text{UM})$ 是 $(2.40, 1.19, 3.19)$。\n\n**逐项分析**\n\n- **A. $\\left(2.40,\\;1.19,\\;3.19\\right)$**: 此选项与分别为EM、PM和UM计算出的值完全匹配。\n  - EM: $2.40$ (正确)\n  - PM: $1.19$ (正确)\n  - UM: $3.19$ (正确)\n  **结论：正确**\n\n- **B. $\\left(2.40,\\;1.33,\\;3.00\\right)$**: EM的值是正确的，但PM和UM的值不正确。\n  - PM：计算值为 $1.19$，而不是 $1.33$。\n  - UM：计算值为 $3.19$，而不是 $3.00$。\n  **结论：不正确**\n\n- **C. $\\left(6.00,\\;1.20,\\;6.00\\right)$**: 所有值都不正确。值 $6.00$ 代表抑制因子的倒数 ($1 / (1/6) = 6$)，这仅在药物的*全部*清除都由CYP2D6介导且没有平行的非CYP途径时才是AUC的倍数变化。PM的值接近但并不精确（$1.20$ 对比 $1.19$）。\n  **结论：不正确**\n\n- **D. $\\left(2.00,\\;1.20,\\;4.00\\right)$**: 所有值都不正确。除了PM的值是正确答案的略微不同的四舍五入结果外，这些值似乎无法从对所提供原理的任何简单误解中推导出来。\n  **结论：不正确**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "这最后一个综合性练习旨在挑战您将多个原理融会贯通，构建一个实用的、基于模型的精准给药工具。您将为他克莫司开发一个给药算法，该算法不仅整合了 CYP3A5 基因型，还考虑了体重、血细胞比容以及代谢抑制剂或诱导剂的存在。这项顶石练习将引导您从简单的效应预测，迈向根据第一性原理创建个性化治疗方案的药物基因组学实际应用。",
            "id": "4329867",
            "problem": "开发一个独立的程序，用于计算他克莫司的初始日剂量，以达到指定的全血谷浓度目标。该程序需基于精准医疗框架内的第一性原理药代动力学推理和药物基因组学修正因子。使用具有一级吸收和一级消除的单室血管外给药模型。药物他克莫司主要由细胞色素P450（Cytochrome P450, CYP）同工酶代谢，其中细胞色素P450家族3亚家族A成员5（Cytochrome P450 family 3 subfamily A member 5, CYP3A5）的基因型修正因子会影响肝清除率。该算法必须整合体重、血细胞比容以及细胞色素P450（CYP）代谢的伴随抑制剂或诱导剂的存在。遵循以下核心定义和经过充分检验的基础原理，不得使用任何简化公式：\n- 具有吸收和消除过程的单室系统的质量平衡。\n- 由吸收速率常数 $k_a$ 表征的一级吸收。\n- 由消除速率常数 $k$ 表征的一级消除，其中 $k = CL / V$。\n- 清除率和分布容积相对于参考体重的异速生长标度。\n- 稳态下剂量、生物利用度和全身暴露量之间的关系。\n- 血细胞比容对全血分布容积的影响。\n- CYP3A5表达状态的药物基因组学变异。\n- 通过CYP介导代谢的抑制剂和诱导剂产生的药物-药物相互作用对清除率的调节。\n\n您的程序必须实现以下科学上真实的参数化和假设，所有参数均采用指定单位：\n- 参考体重 $W_{ref} = 70$ kg。\n- 参考血细胞比容 $Hct_{ref} = 0.45$（无单位分数）。\n- 在 $W_{ref}$ 下，一个细胞色素P450家族3亚家族A成员5（CYP3A5）非表达者的参考全血表观清除率：$CL_{ref} = 3.5$ L/h。\n- 在 $W_{ref}$ 下的参考全血表观分布容积：$V_{ref} = 60$ L。\n- 口服生物利用度 $F = 0.25$（无单位）。\n- 吸收速率常数 $k_a = 2.0$ h$^{-1}$。\n- 清除率异速标度：$CL = CL_{ref} \\cdot \\left(\\dfrac{W}{W_{ref}}\\right)^{0.75} \\cdot g \\cdot m$，其中 $W$ 是以kg为单位的体重，$g$ 是基因型因子，$m$ 是伴随用药相互作用乘数。\n- 带血细胞比容调整的容积异速标度：$V = V_{ref} \\cdot \\left(\\dfrac{W}{W_{ref}}\\right)^{1.0} \\cdot \\left(1 + \\beta \\cdot (Hct - Hct_{ref})\\right)$，其中 $\\beta = 1.0$。\n- 基因型因子 $g$：对于CYP3A5非表达者，使用 $g = 1.0$；对于CYP3A5表达者，使用 $g = 1.6$。\n- 伴随用药相互作用乘数 $m$ 类别：\"none\" $\\rightarrow m = 1.0$，\"moderate\\_inhibitor\" $\\rightarrow m = 0.7$，\"strong\\_inhibitor\" $\\rightarrow m = 0.5$，\"moderate\\_inducer\" $\\rightarrow m = 1.5$，\"strong\\_inducer\" $\\rightarrow m = 2.0$。\n- 给药间隔 $\\tau$，单位为小时。\n- 目标全血谷浓度 $C_{tr}$，单位为ng/mL。计算时通过 $1$ ng/mL $= 0.001$ mg/L 将ng/mL转换为mg/L。\n\n您的程序必须：\n- 根据上述基础原理，推导出在给药间隔 $\\tau$ 下达到指定稳态谷浓度 $C_{tr}$ 所需的单次给药剂量 $D$（单位mg）的表达式，然后计算日剂量（mg/day），其公式为 $D \\cdot \\dfrac{24}{\\tau}$。\n- 不接受用户输入；将以下测试套件硬编码到程序中。\n- 为每个测试用例生成最终的日剂量（mg/day），结果为浮点数并四舍五入到三位小数。\n- 使用以下涵盖一般、边界和边缘场景的测试套件：\n    1. CYP3A5非表达者，$W = 70$ kg，$Hct = 0.45$，相互作用为\"none\"，$C_{tr} = 6$ ng/mL，$\\tau = 12$ h。\n    2. CYP3A5表达者，$W = 70$ kg，$Hct = 0.45$，相互作用为\"none\"，$C_{tr} = 6$ ng/mL，$\\tau = 12$ h。\n    3. CYP3A5表达者，$W = 70$ kg，$Hct = 0.45$，相互作用为\"strong\\_inhibitor\"，$C_{tr} = 6$ ng/mL，$\\tau = 12$ h。\n    4. CYP3A5非表达者，$W = 90$ kg，$Hct = 0.40$，相互作用为\"strong\\_inducer\"，$C_{tr} = 8$ ng/mL，$\\tau = 12$ h。\n    5. CYP3A5表达者，$W = 50$ kg，$Hct = 0.25$，相互作用为\"moderate\\_inhibitor\"，$C_{tr} = 5$ ng/mL，$\\tau = 24$ h。\n    6. CYP3A5非表达者，$W = 120$ kg，$Hct = 0.55$，相互作用为\"none\"，$C_{tr} = 7$ ng/mL，$\\tau = 12$ h。\n\n要求的输出格式：\n- 您的程序应生成单行输出，其中包含六个测试用例的日剂量结果（单位mg/day），结果为一个用方括号括起来的逗号分隔列表，每个值都四舍五入到三位小数（例如，$\"[2.835,5.701,2.115,13.149,4.849,4.608]\"$）。所有剂量值均以mg/day为单位，并保留三位小数。",
            "solution": "经评估，用户提供的问题是**有效的**。它在科学上基于药代动力学和药物基因组学的既定原则，问题陈述清晰，定义和参数完整一致，并以客观、正式的语言表达。解决方案将按照规定，从第一性原理开始推导必要的方程。\n\n目标是计算达到目标稳态谷浓度（$C_{tr}$）所需的他克莫司初始日剂量。该计算基于一个包含一级吸收和一级消除的单室药代动力学（PK）模型，并整合了患者特异性协变量。\n\n单次口服剂量（$D$）后，药物在体内的浓度可以用Bateman函数描述，该函数是控制一级吸收单室模型微分方程的解。在时间 $t$ 时的浓度 $C(t)$ 由下式给出：\n$$ C(t) = \\frac{F \\cdot D \\cdot k_a}{V(k_a - k)} \\left( e^{-kt} - e^{-k_a t} \\right) $$\n其中 $F$ 是口服生物利用度，$D$ 是剂量，$k_a$ 是一级吸收速率常数，$V$ 是表观分布容积，$k$ 是一级消除速率常数。问题要求从基本原理进行推导，即吸收部位和中央室的质量平衡方程。上述方程是这些平衡方程的积分形式。\n\n对于按恒定间隔 $\\tau$ 进行多次给药的方案，药物在体内累积直至达到稳态。在稳态下，一个给药间隔内的浓度曲线是先前无限系列剂量浓度曲线的叠加。在稳态下，给药间隔内（$0 \\le t \\le \\tau$）时间 $t$ 时的浓度 $C_{ss}(t)$ 为：\n$$ C_{ss}(t) = \\sum_{n=0}^{\\infty} C_{single\\_dose}(t + n\\tau) = \\frac{F \\cdot D \\cdot k_a}{V(k_a - k)} \\left( \\frac{e^{-kt}}{1 - e^{-k\\tau}} - \\frac{e^{-k_a t}}{1 - e^{-k_a \\tau}} \\right) $$\n该表达式是通过将几何级数求和公式 $\\sum_{n=0}^{\\infty} r^n = (1-r)^{-1}$ 应用于叠加产生的项而推导出来的。\n\n谷浓度 $C_{tr}$（或 $C_{min,ss}$）是稳态时的最低浓度，出现在给药间隔的末尾，即下一次给药前，也就是 $t = \\tau$ 时。将 $t = \\tau$ 代入稳态浓度方程可得：\n$$ C_{tr} = C_{ss}(\\tau) = \\frac{F \\cdot D \\cdot k_a}{V(k_a - k)} \\left( \\frac{e^{-k\\tau}}{1 - e^{-k\\tau}} - \\frac{e^{-k_a \\tau}}{1 - e^{-k_a \\tau}} \\right) $$\n为了计算方便，将分数表示为 $(e^{x}-1)^{-1}$ 通常更稳定。谷浓度方程变为：\n$$ C_{tr} = \\frac{F \\cdot D \\cdot k_a}{V(k_a - k)} \\left( \\frac{1}{e^{k\\tau}-1} - \\frac{1}{e^{k_a\\tau}-1} \\right) $$\n\n为了计算达到目标 $C_{tr}$ 所需的剂量 $D$，我们重排上述方程求解 $D$：\n$$ D = \\frac{C_{tr} \\cdot V \\cdot (k_a - k)}{F \\cdot k_a \\left( \\frac{1}{e^{k\\tau}-1} - \\frac{1}{e^{k_a\\tau}-1} \\right)} $$\n这是每个给药间隔 $\\tau$ 的剂量。\n\n药代动力学参数 $V$ 和 $k$ 是患者特异性的。消除速率常数 $k$ 定义为表观清除率（$CL$）与表观分布容积（$V$）之比：\n$$ k = \\frac{CL}{V} $$\n$CL$ 和 $V$ 通过参考值的异速生长标度来确定，并根据遗传及其他因素进行调整：\n1.  **表观清除率 ($CL$)**：\n    $$ CL = CL_{ref} \\cdot \\left(\\frac{W}{W_{ref}}\\right)^{0.75} \\cdot g \\cdot m $$\n    其中 $W$ 是患者的体重，$W_{ref}$ 是参考体重（$70$ kg），$CL_{ref}$ 是参考清除率（$3.5$ L/h），$g$ 是CYP3A5表达的药物基因组学因子，$m$ 是伴随用药相互作用的乘数。\n\n2.  **表观分布容积 ($V$)**：\n    $$ V = V_{ref} \\cdot \\left(\\frac{W}{W_{ref}}\\right)^{1.0} \\cdot \\left(1 + \\beta \\cdot (Hct - Hct_{ref})\\right) $$\n    其中 $V_{ref}$ 是参考容积（$60$ L），$Hct$ 是患者的血细胞比容，$Hct_{ref}$ 是参考血细胞比容（$0.45$），$\\beta$ 是一个标度系数（$1.0$）。\n\n最后一步是计算每日总剂量。已知剂量 $D$ 每 $\\tau$ 小时给药一次，则每天的给药次数为 $24/\\tau$。因此，每日总剂量为：\n$$ D_{daily} = D \\cdot \\frac{24}{\\tau} $$\n\n每个测试用例的总体算法如下：\n1.  识别患者特异性输入：体重（$W$）、血细胞比容（$Hct$）、CYP3A5基因型和伴随用药状况。\n2.  确定相应的数值因子 $g$ 和 $m$。\n3.  使用提供的异速生长标度方程计算患者特异性的 $CL$ 和 $V$。\n4.  计算消除速率常数 $k = CL/V$。\n5.  使用给定的转换因子（$1$ ng/mL $= 0.001$ mg/L）将目标谷浓度 $C_{tr}$ 从 ng/mL 转换为 mg/L。\n6.  将所有参数（$C_{tr}$, $V$, $k$, $k_a$, $F$, $\\tau$）代入推导出的方程中，计算单次给药剂量 $D$。\n7.  计算每日总剂量 $D_{daily}$。\n8.  将最终结果四舍五入到三位小数。\n此流程提供了一个完整的、有原则的解决方案，完全基于问题的规范。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the initial daily tacrolimus dose to achieve a specified\n    whole-blood trough concentration target based on a one-compartment\n    pharmacokinetic model with pharmacogenomic and patient-specific modifiers.\n    \"\"\"\n\n    # --- Fixed Model Parameters ---\n    W_ref = 70.0       # Reference body weight (kg)\n    Hct_ref = 0.45     # Reference hematocrit (unitless fraction)\n    CL_ref = 3.5       # Reference whole-blood clearance for CYP3A5 nonexpresser (L/h)\n    V_ref = 60.0       # Reference whole-blood volume of distribution (L)\n    F = 0.25           # Oral bioavailability (unitless)\n    k_a = 2.0          # Absorption rate constant (h^-1)\n    beta = 1.0         # Hematocrit scaling coefficient\n\n    # --- Factor Mappings ---\n    genotype_factors = {\n        'CYP3A5 nonexpresser': 1.0,\n        'CYP3A5 expresser': 1.6\n    }\n    interaction_multipliers = {\n        'none': 1.0,\n        'moderate_inhibitor': 0.7,\n        'strong_inhibitor': 0.5,\n        'moderate_inducer': 1.5,\n        'strong_inducer': 2.0\n    }\n\n    # --- Test Suite ---\n    test_cases = [\n        # (genotype, W, Hct, interaction, C_tr, tau)\n        ('CYP3A5 nonexpresser', 70.0, 0.45, 'none', 6.0, 12.0),\n        ('CYP3A5 expresser', 70.0, 0.45, 'none', 6.0, 12.0),\n        ('CYP3A5 expresser', 70.0, 0.45, 'strong_inhibitor', 6.0, 12.0),\n        ('CYP3A5 nonexpresser', 90.0, 0.40, 'strong_inducer', 8.0, 12.0),\n        ('CYP3A5 expresser', 50.0, 0.25, 'moderate_inhibitor', 5.0, 24.0),\n        ('CYP3A5 nonexpresser', 120.0, 0.55, 'none', 7.0, 12.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        genotype, W, Hct, interaction, C_tr_ng_mL, tau = case\n\n        # 1. Determine numerical factors g and m\n        g = genotype_factors[genotype]\n        m = interaction_multipliers[interaction]\n\n        # 2. Calculate patient-specific CL and V\n        # Allometric scaling for Clearance (CL)\n        CL = CL_ref * ((W / W_ref) ** 0.75) * g * m\n        # Allometric scaling for Volume of Distribution (V) with Hct adjustment\n        V = V_ref * ((W / W_ref) ** 1.0) * (1 + beta * (Hct - Hct_ref))\n\n        # 3. Calculate elimination rate constant k\n        # Ensure V is not zero to avoid division errors, though a valid V should be positive.\n        if V == 0:\n            raise ValueError(\"Volume of distribution must be positive.\")\n        k = CL / V\n\n        # 4. Convert target concentration units\n        # 1 ng/mL = 0.001 mg/L\n        C_tr_mg_L = C_tr_ng_mL * 0.001\n\n        # 5. Calculate single dose D based on the derived formula\n        # D = (C_tr * V * (ka - k)) / (F * ka * ( (1/(e^(k*tau)-1)) - (1/(e^(ka*tau)-1)) ))\n        \n        # Check for k == k_a to avoid division by zero, although highly unlikely with given parameters.\n        if np.isclose(k, k_a):\n             # This case requires a different PK model solution, but it's not expected here.\n            raise ValueError(\"Elimination rate constant k cannot be equal to absorption rate constant k_a.\")\n\n        term1 = 1 / (np.exp(k * tau) - 1)\n        term2 = 1 / (np.exp(k_a * tau) - 1)\n        \n        denominator_bracket = term1 - term2\n        \n        # Ensure denominator is not zero\n        if np.isclose(denominator_bracket, 0):\n            # This would imply k is close to ka, already checked\n            raise ValueError(\"Denominator in dose calculation is zero.\")\n\n        numerator = C_tr_mg_L * V * (k_a - k)\n        denominator = F * k_a * denominator_bracket\n\n        Dose_per_interval = numerator / denominator\n\n        # 6. Calculate total daily dose\n        Daily_dose = Dose_per_interval * (24.0 / tau)\n\n        # 7. Append rounded result\n        results.append(round(Daily_dose, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}