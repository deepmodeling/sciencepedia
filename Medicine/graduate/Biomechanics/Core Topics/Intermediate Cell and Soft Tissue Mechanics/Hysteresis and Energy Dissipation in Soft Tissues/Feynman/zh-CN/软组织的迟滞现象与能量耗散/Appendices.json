{
    "hands_on_practices": [
        {
            "introduction": "复数模量 $E^*(\\omega)$ 是一个在频域中表征线性粘弹性材料响应的强大工具。本练习旨在通过将微分形式的本构方程转换为代数形式的频域关系，帮助您熟练掌握使用复数表示法分析粘弹性行为的核心技能。通过求解经典的麦克斯韦模型，您将推导出复数模量和损耗模量，这是理解材料能量耗散特性的基础。",
            "id": "4178846",
            "problem": "考虑一个线性粘弹性软组织，其模型为一个麦克斯韦单元，由一个模量为 $E$ 的弹簧与一个粘度为 $\\eta$ 的粘壶串联而成。其一维本构关系，用应变率和应力表示，由 $\\dot{\\varepsilon} = \\frac{\\sigma}{\\eta} + \\frac{1}{E}\\dot{\\sigma}$ 给出。该组织受到角频率为 $\\omega$ 的正弦应变输入 $\\varepsilon(t) = \\varepsilon_{0}\\sin(\\omega t)$，实验观察到产生的应力 $\\sigma(t)$ 也是同频率的正弦形式，但由于粘弹性而存在相位偏移。\n\n从给定的微分本构关系出发，并使用正弦信号的复数表示法，推导复模量 $E^{*}(\\omega)$（定义为复应力振幅与复应变振幅之比），并由此得到损耗模量 $E''(\\omega)$（定义为 $E^{*}(\\omega)$ 的虚部）。将 $E^{*}(\\omega)$ 和 $E''(\\omega)$ 仅用 $E$、$\\eta$ 和 $\\omega$ 表示。提供最终表达式，不进行数值近似。如果引入了任何辅助量，需在最终表达式中将其消去，以使答案仅依赖于 $E$、$\\eta$ 和 $\\omega$。",
            "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **模型**：由麦克斯韦单元建模的线性粘弹性软组织。\n- **组件**：一个模量为 $E$ 的弹簧与一个粘度为 $\\eta$ 的粘壶串联。\n- **本构关系**：$\\dot{\\varepsilon} = \\frac{\\sigma}{\\eta} + \\frac{1}{E}\\dot{\\sigma}$，其中 $\\varepsilon$ 是应变，$\\sigma$ 是应力，点号表示时间导数。\n- **输入信号**：角频率为 $\\omega$ 的正弦应变 $\\varepsilon(t) = \\varepsilon_{0}\\sin(\\omega t)$。\n- **定义1**：复模量 $E^{*}(\\omega)$ 定义为复应力振幅与复应变振幅之比。\n- **定义2**：损耗模量 $E''(\\omega)$ 定义为复模量 $E^{*}(\\omega)$ 的虚部。\n- **目标**：推导 $E^{*}(\\omega)$ 和 $E''(\\omega)$ 的表达式，使其仅包含 $E$、$\\eta$ 和 $\\omega$。\n\n### 步骤2：使用提取的已知条件进行验证\n根据所需标准对问题进行评估：\n- **科学基础**：该问题具有科学依据。麦克斯韦模型是材料科学和生物力学中线性粘弹性行为的一个基本和标准表示。所提供的本构方程正确地描述了一个麦克斯韦单元。使用复模量分析对正弦加载的响应是流变学和粘弹性领域中一种标准且强大的技术。\n- **适定性**：该问题是适定的。它提供了一个线性常微分方程、输入强迫函数的具体形式，以及待推导量的明确定义。所有必要的参数（$E$、$\\eta$、$\\omega$）都以符号形式给出，从而可以推导出唯一且有意义的解。\n- **客观性**：问题以精确、客观、无歧义的科学语言陈述。\n- **完整性与一致性**：问题是自洽且一致的。所提供的信息足以进行所需的推导，无需外部假设。\n- **现实性**：麦克斯韦模型代表了特定条件下（例如，小而快速的变形）某些软组织行为的一种简化但具有物理意义的近似。它是用于介绍粘弹性概念的标准教科书模型。\n\n### 步骤3：结论与行动\n该问题是**有效的**。它是线性粘弹性理论中的一个标准练习。现在可以开始求解过程。\n\n推导过程首先将时域本构关系通过正弦信号的复指数表示法转换到频域。角频率为 $\\omega$ 的一般正弦应变和应力可以用复数形式表示为：\n$$\n\\varepsilon(t) = \\hat{\\varepsilon}e^{i\\omega t}\n$$\n$$\n\\sigma(t) = \\hat{\\sigma}e^{i\\omega t}\n$$\n其中 $\\hat{\\varepsilon}$ 和 $\\hat{\\sigma}$ 分别是应变和应力的复振幅。物理量通常取这些复数表示的实部或虚部。复振幅 $\\hat{\\varepsilon}$ 和 $\\hat{\\sigma}$ 通常是复数，其辐角代表相移。\n\n这些信号的时间导数是：\n$$\n\\dot{\\varepsilon}(t) = \\frac{d}{dt}(\\hat{\\varepsilon}e^{i\\omega t}) = i\\omega \\hat{\\varepsilon}e^{i\\omega t} = i\\omega \\varepsilon(t)\n$$\n$$\n\\dot{\\sigma}(t) = \\frac{d}{dt}(\\hat{\\sigma}e^{i\\omega t}) = i\\omega \\hat{\\sigma}e^{i\\omega t} = i\\omega \\sigma(t)\n$$\n将这些复数形式代入给定的本构关系 $\\dot{\\varepsilon} = \\frac{\\sigma}{\\eta} + \\frac{1}{E}\\dot{\\sigma}$，得到：\n$$\ni\\omega \\hat{\\varepsilon}e^{i\\omega t} = \\frac{\\hat{\\sigma}e^{i\\omega t}}{\\eta} + \\frac{1}{E}(i\\omega \\hat{\\sigma}e^{i\\omega t})\n$$\n可以从每一项中消去公因子 $e^{i\\omega t}$，留下复振幅之间的关系：\n$$\ni\\omega \\hat{\\varepsilon} = \\frac{\\hat{\\sigma}}{\\eta} + \\frac{i\\omega}{E}\\hat{\\sigma}\n$$\n我们可以在右侧提出公因子 $\\hat{\\sigma}$：\n$$\ni\\omega \\hat{\\varepsilon} = \\hat{\\sigma} \\left( \\frac{1}{\\eta} + \\frac{i\\omega}{E} \\right)\n$$\n复模量 $E^{*}(\\omega)$ 定义为复应力振幅与复应变振幅之比，即 $E^{*}(\\omega) = \\frac{\\hat{\\sigma}}{\\hat{\\varepsilon}}$。我们重新整理方程以求解该比率：\n$$\nE^{*}(\\omega) = \\frac{\\hat{\\sigma}}{\\hat{\\varepsilon}} = \\frac{i\\omega}{\\frac{1}{\\eta} + \\frac{i\\omega}{E}}\n$$\n为了简化此表达式，我们为括号中的项找到一个公分母：\n$$\nE^{*}(\\omega) = \\frac{i\\omega}{\\frac{E + i\\omega\\eta}{E\\eta}}\n$$\n将分母取倒数并相乘，得到第一个所需的表达式：\n$$\nE^{*}(\\omega) = \\frac{i\\omega E\\eta}{E + i\\omega\\eta}\n$$\n这是复模量用 $E$、$\\eta$ 和 $\\omega$ 表示的表达式。\n\n第二个任务是求损耗模量 $E''(\\omega)$，它是 $E^{*}(\\omega)$ 的虚部。为此，我们必须将 $E^{*}(\\omega)$ 的表达式分离成实部和虚部。这通过将分子和分母同乘以分母的复共轭 $(E - i\\omega\\eta)$ 来实现：\n$$\nE^{*}(\\omega) = \\left( \\frac{i\\omega E\\eta}{E + i\\omega\\eta} \\right) \\left( \\frac{E - i\\omega\\eta}{E - i\\omega\\eta} \\right)\n$$\n分子变为：\n$$\n\\text{分子} = (i\\omega E\\eta)(E - i\\omega\\eta) = i\\omega E^2\\eta - i^2\\omega^2 E\\eta^2 = i\\omega E^2\\eta - (-1)\\omega^2 E\\eta^2 = \\omega^2 E\\eta^2 + i(\\omega E^2\\eta)\n$$\n分母是一个复数与其共轭的乘积，其结果是其实部和虚部平方的和：\n$$\n\\text{分母} = (E + i\\omega\\eta)(E - i\\omega\\eta) = E^2 - (i\\omega\\eta)^2 = E^2 - i^2\\omega^2\\eta^2 = E^2 + \\omega^2\\eta^2\n$$\n组合新的分子和分母，得到：\n$$\nE^{*}(\\omega) = \\frac{\\omega^2 E\\eta^2 + i(\\omega E^2\\eta)}{E^2 + \\omega^2\\eta^2}\n$$\n将其分离为实部和虚部，$E^{*}(\\omega) = E'(\\omega) + iE''(\\omega)$：\n$$\nE^{*}(\\omega) = \\frac{\\omega^2 E\\eta^2}{E^2 + \\omega^2\\eta^2} + i \\left( \\frac{\\omega E^2\\eta}{E^2 + \\omega^2\\eta^2} \\right)\n$$\n实部是储能模量 $E'(\\omega)$，虚部是损耗模量 $E''(\\omega)$。根据定义，损耗模量为：\n$$\nE''(\\omega) = \\frac{\\omega E^2\\eta}{E^2 + \\omega^2\\eta^2}\n$$\n这是第二个所需的表达式，仅用 $E$、$\\eta$ 和 $\\omega$ 表示。\n\n推导出的两个表达式是：\n1. 复模量：$E^{*}(\\omega) = \\frac{i\\omega E\\eta}{E + i\\omega\\eta}$\n2. 损耗模量：$E''(\\omega) = \\frac{\\omega E^2\\eta}{E^2 + \\omega^2\\eta^2}$\n这些构成了问题的完整解答。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{i\\omega E\\eta}{E + i\\omega\\eta}  \\frac{\\omega E^2\\eta}{E^2 + \\omega^2\\eta^2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论与实践在此交汇：材料的损耗模量与每个加载周期中耗散的能量直接相关。本练习将这一抽象概念具体化，要求您计算单位体积的循环耗散能 $W_{\\mathrm{d}}$。更进一步，您将应用这些知识解决一个实际的优化问题：确定使能量损失最大化的振动频率，这在设计生物材料或评估组织损伤风险时具有重要意义。",
            "id": "4178819",
            "problem": "对一个软组织样本进行小振幅单轴振荡测试，在所关注的频率范围内，该样本可以用线性麦克斯韦粘弹性模型很好地描述。麦克斯韦元件由一个弹性模量为 $E$ 的线性弹簧与一个粘度为 $\\eta$ 的线性阻尼器串联组成。假设应变很小，因此线性粘弹性适用。施加的应变为 $\\varepsilon(t)=\\varepsilon_{0}\\sin(\\omega t)$，其振幅为 $\\varepsilon_{0}$，角频率为 $\\omega$。忽略惯性及任何非线性效应。\n\n从麦克斯韦本构关系和单位体积循环耗散能的定义（即在一个振荡周期上的线积分 $W_{\\mathrm{d}}=\\oint \\sigma \\,\\mathrm{d}\\varepsilon$）出发，推导出一个用 $\\omega$、$E$、$\\eta$ 和 $\\varepsilon_{0}$ 表示的 $W_{\\mathrm{d}}$ 的解析表达式。然后，确定使 $W_{\\mathrm{d}}$ 最大化的角频率，并针对参数值 $E=5.0\\times 10^{4}$、$\\eta=1.0\\times 10^{4}$ 和 $\\varepsilon_{0}=0.050$ 计算该最大化角频率及相应的每个周期的最大耗散能。\n\n角频率以弧度/秒表示，单位体积能量以 $\\mathrm{J}/\\mathrm{m}^{3}$ 表示。将您的答案四舍五入到三位有效数字。",
            "solution": "该问题经核实具有科学依据、提法明确且客观。这是线性粘弹性应用于生物力学的一个标准问题，没有明显缺陷。\n\n麦克斯韦模型由一个弹性模量为 $E$ 的线性弹簧与一个粘度为 $\\eta$ 的线性阻尼器串联组成。总应变 $\\varepsilon$ 是弹簧应变 $\\varepsilon_s$ 和阻尼器应变 $\\varepsilon_d$ 的和，即 $\\varepsilon = \\varepsilon_s + \\varepsilon_d$。应力 $\\sigma$ 在两个元件上是相同的。元件的本构关系为：弹簧是 $\\sigma = E\\varepsilon_s$，阻尼器是 $\\sigma = \\eta \\dot{\\varepsilon}_d$，其中点号表示时间导数。\n\n将总应变对时间 $t$ 求导，我们得到 $\\dot{\\varepsilon} = \\dot{\\varepsilon}_s + \\dot{\\varepsilon}_d$。代入本构关系，得到麦克斯韦模型控制方程的微分形式：\n$$ \\dot{\\varepsilon} = \\frac{\\dot{\\sigma}}{E} + \\frac{\\sigma}{\\eta} $$\n整理后得到标准形式：\n$$ \\dot{\\sigma} + \\frac{E}{\\eta}\\sigma = E\\dot{\\varepsilon} $$\n给定施加的正弦应变 $\\varepsilon(t) = \\varepsilon_0 \\sin(\\omega t)$。因此，应变率为 $\\dot{\\varepsilon}(t) = \\varepsilon_0 \\omega \\cos(\\omega t)$。将其代入本构方程，得到一个关于应力 $\\sigma(t)$ 的一阶线性常微分方程：\n$$ \\dot{\\sigma} + \\frac{E}{\\eta}\\sigma(t) = E \\varepsilon_0 \\omega \\cos(\\omega t) $$\n对于振荡加载，我们寻求稳态解。使用复数表示法可以最有效地找到该解。令 $\\varepsilon^*(t) = \\varepsilon_0 \\exp(i\\omega t)$，使得物理应变为 $\\varepsilon(t) = \\Im(\\varepsilon^*(t))$。我们寻找形式为 $\\sigma^*(t) = E^* \\varepsilon^*(t)$ 的应力，其中 $E^*$ 是复数模量。将这些代入本构方程得到：\n$$ i\\omega E^* \\varepsilon^*(t) + \\frac{E}{\\eta} E^* \\varepsilon^*(t) = E (i\\omega \\varepsilon^*(t)) $$\n求解 $E^*$ 可得：\n$$ E^* \\left(i\\omega + \\frac{E}{\\eta}\\right) = i\\omega E \\implies E^* = \\frac{i\\omega E}{i\\omega + E/\\eta} = \\frac{i\\omega E \\eta}{i\\omega\\eta + E} $$\n为了找到 $E^*$ 的实部和虚部，我们将表达式有理化：\n$$ E^* = \\frac{i\\omega E\\eta}{E + i\\omega\\eta} \\times \\frac{E - i\\omega\\eta}{E - i\\omega\\eta} = \\frac{i\\omega E^2\\eta + \\omega^2 E\\eta^2}{E^2 + (\\omega\\eta)^2} $$\n复数模量定义为 $E^* = E' + iE''$，其中 $E'$ 是储能模量，$E''$ 是损耗模量。通过比较各项，我们确定：\n$$ E' = \\frac{E(\\omega\\eta)^2}{E^2 + (\\omega\\eta)^2} \\quad \\text{and} \\quad E'' = \\frac{\\omega E^2\\eta}{E^2 + (\\omega\\eta)^2} $$\n由于 $\\varepsilon(t) = \\Im(\\varepsilon^*(t))$，物理应力 $\\sigma(t)$ 是 $\\sigma^*(t) = E^*\\varepsilon_0\\exp(i\\omega t)$ 的虚部：\n$$ \\sigma^*(t) = (E' + iE'') \\varepsilon_0 (\\cos(\\omega t) + i\\sin(\\omega t)) $$\n$$ \\sigma(t) = \\Im(\\sigma^*(t)) = \\varepsilon_0(E'\\sin(\\omega t) + E''\\cos(\\omega t)) $$\n在一个周期内单位体积耗散的能量 $W_d$ 由积分 $W_d = \\oint \\sigma \\,\\mathrm{d}\\varepsilon$ 给出。由于 $\\mathrm{d}\\varepsilon = \\dot{\\varepsilon}(t)\\,\\mathrm{d}t = \\varepsilon_0\\omega\\cos(\\omega t)\\,\\mathrm{d}t$，我们可以将积分写成在一个周期 $T = 2\\pi/\\omega$ 上的形式：\n$$ W_d = \\int_0^{T} \\sigma(t)\\dot{\\varepsilon}(t)\\,\\mathrm{d}t = \\int_0^{2\\pi/\\omega} \\left[\\varepsilon_0(E'\\sin(\\omega t) + E''\\cos(\\omega t))\\right] \\left[\\varepsilon_0\\omega\\cos(\\omega t)\\right] \\,\\mathrm{d}t $$\n$$ W_d = \\varepsilon_0^2\\omega \\int_0^{2\\pi/\\omega} \\left(E'\\sin(\\omega t)\\cos(\\omega t) + E''\\cos^2(\\omega t)\\right) \\,\\mathrm{d}t $$\n在一个完整周期内，$\\sin(\\omega t)\\cos(\\omega t) = \\frac{1}{2}\\sin(2\\omega t)$ 的积分为零。$\\cos^2(\\omega t) = \\frac{1}{2}(1+\\cos(2\\omega t))$ 的积分为 $T/2 = \\pi/\\omega$。因此，$W_d$ 的表达式简化为：\n$$ W_d = \\varepsilon_0^2\\omega \\left(E' \\cdot 0 + E'' \\cdot \\frac{\\pi}{\\omega}\\right) = \\pi \\varepsilon_0^2 E'' $$\n代入损耗模量 $E''$ 的表达式，得到 $W_d$ 所需的解析表达式：\n$$ W_d(\\omega) = \\pi\\varepsilon_0^2 \\frac{\\omega E^2\\eta}{E^2 + (\\omega\\eta)^2} $$\n为了找到使 $W_d$ 最大化的角频率 $\\omega_{\\max}$，我们将 $W_d(\\omega)$ 对 $\\omega$ 求导，并令结果为零。项 $\\pi$、$\\varepsilon_0^2$、$E^2$ 和 $\\eta$ 相对于 $\\omega$ 是常数。令 $C = \\pi\\varepsilon_0^2 E^2\\eta$。我们需要最大化函数 $f(\\omega) = \\frac{\\omega}{E^2 + \\eta^2\\omega^2}$。\n$$ \\frac{\\mathrm{d}f}{\\mathrm{d}\\omega} = \\frac{(1)(E^2 + \\eta^2\\omega^2) - (\\omega)(2\\eta^2\\omega)}{(E^2 + \\eta^2\\omega^2)^2} = \\frac{E^2 - \\eta^2\\omega^2}{(E^2 + \\eta^2\\omega^2)^2} $$\n将导数设为零，我们发现分子必须为零：\n$$ E^2 - \\eta^2\\omega^2 = 0 \\implies \\omega^2 = \\frac{E^2}{\\eta^2} $$\n由于 $\\omega > 0$，最大化的角频率为：\n$$ \\omega_{\\max} = \\frac{E}{\\eta} $$\n现在，我们将 $\\omega_{\\max}$ 代入 $W_d(\\omega)$ 的表达式来计算最大耗散能 $W_{d,\\max}$：\n$$ W_{d,\\max} = W_d(\\omega_{\\max}) = \\pi\\varepsilon_0^2 \\frac{(E/\\eta) E^2\\eta}{E^2 + ((E/\\eta)\\eta)^2} = \\pi\\varepsilon_0^2 \\frac{E^3}{E^2 + E^2} = \\pi\\varepsilon_0^2 \\frac{E^3}{2E^2} $$\n$$ W_{d,\\max} = \\frac{1}{2}\\pi\\varepsilon_0^2 E $$\n最后，我们代入给定的参数值：$E = 5.0 \\times 10^4 \\, \\mathrm{Pa}$，$\\eta = 1.0 \\times 10^4 \\, \\mathrm{Pa} \\cdot \\mathrm{s}$ 和 $\\varepsilon_0 = 0.050$。\n最大化的角频率为：\n$$ \\omega_{\\max} = \\frac{5.0 \\times 10^4}{1.0 \\times 10^4} = 5.0 \\, \\mathrm{rad/s} $$\n四舍五入到三位有效数字，$\\omega_{\\max} = 5.00 \\, \\mathrm{rad/s}$。\n每个周期单位体积的最大耗散能为：\n$$ W_{d,\\max} = \\frac{1}{2}\\pi(0.050)^2 (5.0 \\times 10^4) = \\frac{1}{2}\\pi(0.0025)(5.0 \\times 10^4) = \\frac{1}{2}\\pi(125) = 62.5\\pi \\, \\mathrm{J/m^3} $$\n数值上，这是 $W_{d,\\max} \\approx 196.3495... \\, \\mathrm{J/m^3}$。四舍五入到三位有效数字， $W_{d,\\max} = 196 \\, \\mathrm{J/m^3}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.00  196\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从简单的解析模型到复杂的计算模拟是现代生物力学研究的常态。本练习将带您跨越这一鸿沟，通过编写一个后处理程序来计算模拟的应力-应变数据中的能量耗散。这模拟了有限元分析 (FEA) 的关键步骤，让您能够将滞后和能量耗散的理论应用于分析真实世界中具有复杂几何形状和异质性材料属性的生物结构。",
            "id": "4178799",
            "problem": "一个异质软组织使用有限元 (FE) 网格进行离散化。在每个材料点，单位体积的增量功由连续介质力学恒等式 $dW = \\boldsymbol{\\sigma} : d\\boldsymbol{\\varepsilon}$ 定义，其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\boldsymbol{\\varepsilon}$ 是小应变张量。在时间周期性激励的一个加载周期内，由滞后引起的能量耗散密度（记为 $W_{\\mathrm{d}}$）是闭路积分 $W_{\\mathrm{d}} = \\oint \\boldsymbol{\\sigma} : d\\boldsymbol{\\varepsilon}$。在有限元模拟的后处理中，必须通过对一个周期内采样的 $\\boldsymbol{\\sigma}(t)$ 和 $\\boldsymbol{\\varepsilon}(t)$ 的时间历程进行数值计算，从而在场点（例如，单元级或高斯点级）计算该闭路积分 $W_{\\mathrm{d}}$。\n\n您的任务是开发一个完整的、自包含的程序，该程序针对一组测试用例，构建代表循环加载下异质组织的有限元输出的合成单轴时间历程，然后执行后处理程序以计算单元级的 $W_{\\mathrm{d}}$ 场图。对于单轴加载，闭路积分简化为 $W_{\\mathrm{d}} = \\oint \\sigma \\, d\\varepsilon$，其中 $\\sigma$ 和 $\\varepsilon$ 分别是标量应力和应变。数值积分必须尊重积分的路径依赖性，并对离散化具有鲁棒性。使用的基本依据是根据应力和应变定义的机械功密度、小应变运动学以及滞回环的时间参数化。问题陈述中不允许使用任何其他简化公式。\n\n科学真实性要求：\n- 假设小应变运动学和时间周期性单轴激励 $\\varepsilon(t)$，其振幅为 $\\varepsilon_0$，频率为 $f$ (角参数以弧度为单位)。\n- 通过为每个单元分配不同的弹性模量 $E$ 和粘性系数 $\\eta$ 来模拟异质性，从而在相同激励下产生不同的相位滞后和环路面积。\n- 生成合成的有限元输出，作为恰好一个周期内的时间历程，包含 $N+1$ 个样本（包括两个端点），以确保环路闭合。\n- 使用与生物力学一致的单位：应力单位为帕斯卡 (Pa)，粘性系数单位为帕斯卡-秒 (Pa·s)，时间单位为秒 (s)。以帕斯卡 (Pa) 为单位报告 $W_{\\mathrm{d}}$，这等于焦耳/立方米/周期。\n\n算法要求（需在代码中实现，并在解决方案中从第一性原理进行论证）：\n- 通过时间 $t \\in [0, T]$ 对滞回环进行参数化，其中 $T = 1/f$，角频率为 $\\omega = 2\\pi f$。\n- 构建包含 $N+1$ 个样本的应变历史 $\\varepsilon(t)$，时间间隔相等，为 $\\Delta t = T/N$。\n- 对每个单元，在相同的 $\\varepsilon(t)$ 下生成与其粘弹性响应一致的应力历史 $\\sigma(t)$，使用不同的单元参数 $(E, \\eta)$ 来表示异质性。不需要进行逆解或本构识别；应力历史是综合生成的，然后进行后处理。\n- 使用梯形法则对参数曲线 $(\\varepsilon(t), \\sigma(t))$ 进行数值计算，以评估闭路积分 $W_{\\mathrm{d}} = \\oint \\sigma \\, d\\varepsilon$ 来计算 $W_{\\mathrm{d}}$。离散公式必须通过对连续样本之间的线段求和来近似该积分，包括从最后一个样本回到第一个样本的线段，以确保环路闭合。结果必须以帕斯卡 (Pa) 表示。\n\n测试套件：\n对于以下所有情况，使用 $\\varepsilon(t) = \\varepsilon_0 \\sin(\\omega t)$，其中 $\\omega = 2\\pi f$，时间 $t$ 采样为 $t_k = k \\Delta t$，对于 $k = 0, 1, \\dots, N$，其中 $\\Delta t = T/N$ 且 $T = 1/f$。程序必须根据 Kelvin-Voigt 型粘弹性响应 $\\sigma_i(t) = E_i \\varepsilon(t) + \\eta_i \\dot{\\varepsilon}(t)$ 为每个单元 $i$ 生成 $\\sigma(t)$，其中 $\\dot{\\varepsilon}(t) = \\omega \\varepsilon_0 \\cos(\\omega t)$ 是解析计算的，以确保受控、无噪声的合成数据。然后，在应变空间中使用规定的数值梯形法则计算单元级的 $W_{\\mathrm{d}}$。\n\n- 测试用例 1（理想情况，弹性且滞后可忽略）：\n  - 两个具有不同刚度但没有粘性的单元，以表示纯弹性行为。\n  - 参数：$E = [10000, 30000]$ (Pa)，$\\eta = [0, 0]$ (Pa·s)，$\\varepsilon_0 = 0.02$ (无量纲)，$f = 1.0$ (Hz)，$N = 1000$ (每周期样本数，通过 $N+1$ 个点包含端点)。\n  - 预期定性结果：两个单元的 $W_{\\mathrm{d}}$ 均约等于 $0$。\n\n- 测试用例 2（异质粘弹性组织，良好解析的周期）：\n  - 两个具有不同刚度和粘度的单元，以在相同激励下产生不同的滞回环面积。\n  - 参数：$E = [10000, 30000]$ (Pa)，$\\eta = [1000, 500]$ (Pa·s)，$\\varepsilon_0 = 0.02$，$f = 1.0$，$N = 4000$。\n\n- 测试用例 3（边界情况，采样不足的高频周期）：\n  - 材料参数与测试用例 2 相同，但频率更高，样本数量更少，以测试数值积分在粗糙离散化下的鲁棒性。\n  - 参数：$E = [10000, 30000]$ (Pa)，$\\eta = [1000, 500]$ (Pa·s)，$\\varepsilon_0 = 0.02$，$f = 5.0$，$N = 16$。\n\n您的程序必须：\n- 在每个测试用例中为每个单元实现合成时间历程的生成以及用于计算 $W_{\\mathrm{d}}$ 的后处理梯形积分。\n- 生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是单元级 $W_{\\mathrm{d}}$ 值的列表（单位为帕斯卡）。将每个 $W_{\\mathrm{d}}$ 值四舍五入到 6 位小数。例如，输出应类似于 $[[w_{11},w_{12}],[w_{21},w_{22}],[w_{31},w_{32}]]$，其中 $w_{ij}$ 是单位为帕斯卡的浮点数。\n\n以帕斯卡 (Pa) 为单位作答，并以确切指定的单行格式输出。",
            "solution": "在循环加载下计算软组织能量耗散密度的基本依据是来自连续介质力学的功密度恒等式。对于小应变运动学，单位体积的增量机械功由 $dW = \\boldsymbol{\\sigma} : d\\boldsymbol{\\varepsilon}$ 给出，其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\boldsymbol{\\varepsilon}$ 是小应变张量。在一个周期内，滞后能量耗散密度等于闭路积分\n$$\nW_{\\mathrm{d}} = \\oint \\boldsymbol{\\sigma} : d\\boldsymbol{\\varepsilon}.\n$$\n在单轴加载下，这简化为\n$$\nW_{\\mathrm{d}} = \\oint \\sigma \\, d\\varepsilon,\n$$\n也就是在 $\\sigma$–$\\varepsilon$ 平面中由应力-应变环路所包围的面积。该定义是路径参数化不变的：对于任何平滑参数 $\\lambda$，如果环路被遍历一次，积分 $\\oint \\sigma \\, d\\varepsilon$ 与沿环路的速度无关。\n\n对于一个周期为 $T = 1/f$、角频率为 $\\omega = 2\\pi f$ 的时间参数化周期，一个实用的有限元后处理程序必须通过一个周期内的 $\\sigma(t)$ 和 $\\varepsilon(t)$ 的离散样本来评估该积分。为确保环路在几何上闭合，必须包括两个端点 $t = 0$ 和 $t = T$，从而产生 $N+1$ 个样本和 $N$ 个线段。一种鲁棒的、与参考系无关的数值积分方法是直接应用于参数曲线的梯形法则：\n$$\nW_{\\mathrm{d}} \\approx \\sum_{k=0}^{N-1} \\frac{\\sigma(t_k) + \\sigma(t_{k+1})}{2} \\left[ \\varepsilon(t_{k+1}) - \\varepsilon(t_k) \\right],\n$$\n其中 $t_k = k \\Delta t$，$\\Delta t = T/N$，且 $k=0,1,\\dots,N$，因此 $t_0 = 0$ 且 $t_N = T$。这是一个沿环路的离散线积分，它近似了 $\\oint \\sigma \\, d\\varepsilon$，而无需对 $\\varepsilon(t)$ 进行显式微分或在时域中进行乘法。\n\n为了生成科学上真实的异质组织合成有限元输出，我们在单元级别采用 Kelvin-Voigt 型粘弹性应力响应：\n$$\n\\sigma_i(t) = E_i \\, \\varepsilon(t) + \\eta_i \\, \\dot{\\varepsilon}(t),\n$$\n使用单元特定的参数 $(E_i, \\eta_i)$ 来模拟异质性。应变激励被规定为正弦函数\n$$\n\\varepsilon(t) = \\varepsilon_0 \\sin(\\omega t),\n$$\n其解析时间导数为\n$$\n\\dot{\\varepsilon}(t) = \\omega \\varepsilon_0 \\cos(\\omega t),\n$$\n确保数据无噪声，适合用于基准测试后处理程序。利用这些定义和参数曲线 $(\\varepsilon(t), \\sigma_i(t))$ 上的梯形法则，我们为每个测试用例计算单元级的 $W_{\\mathrm{d}}$。\n\n基于原理的预期定性行为推导：\n- 对于 $\\eta_i = 0$ 的纯弹性单元，我们有 $\\sigma_i(t) = E_i \\varepsilon(t)$。保守弹性响应在一个周期内的积分得出\n$$\n\\oint \\sigma_i \\, d\\varepsilon = \\oint E_i \\varepsilon \\, d\\varepsilon = E_i \\oint d\\left( \\frac{1}{2} \\varepsilon^2 \\right) = 0,\n$$\n因为环路返回到初始状态。因此，$W_{\\mathrm{d}} \\approx 0$（误差取决于数值积分精度）。\n- 对于 $\\eta_i > 0$ 的粘弹性单元，滞后现象源于粘性项导致的应力与应变之间的相位滞后。从第一性原理出发，每个周期的耗散可以通过时间参数化表示为\n$$\nW_{\\mathrm{d}} = \\oint \\sigma_i \\, d\\varepsilon = \\int_0^T \\sigma_i(t) \\, \\dot{\\varepsilon}(t) \\, dt = \\int_0^T \\left[ E_i \\varepsilon(t) + \\eta_i \\dot{\\varepsilon}(t) \\right] \\dot{\\varepsilon}(t) \\, dt.\n$$\n弹性项在一个周期内的积分为零，因为 $\\int_0^T \\varepsilon(t) \\dot{\\varepsilon}(t) dt = \\frac{1}{2}\\left[ \\varepsilon(T)^2 - \\varepsilon(0)^2 \\right] = 0$。粘性部分的贡献得出\n$$\n\\int_0^T \\eta_i \\left[ \\dot{\\varepsilon}(t) \\right]^2 dt = \\eta_i \\omega^2 \\varepsilon_0^2 \\int_0^T \\cos^2(\\omega t) \\, dt = \\eta_i \\omega^2 \\varepsilon_0^2 \\frac{T}{2} = \\eta_i \\omega \\varepsilon_0^2 \\pi,\n$$\n这表明 $W_{\\mathrm{d}}$ 与 $\\eta_i$、$\\omega$ 和 $\\varepsilon_0^2$ 成比例。这个解析关系证实了代码中对 $(\\varepsilon, \\sigma)$ 进行梯形数值积分的正确性，同时实现中使用的是通用积分定义而非简化公式。\n\n代码中实现的数值算法细节：\n- 对每个测试用例，构建 $t_k = k \\Delta t$，$k = 0,\\dots,N$，其中 $\\Delta t = T/N$ 且 $T = 1/f$。\n- 对所有的 $k$，计算 $\\varepsilon_k = \\varepsilon_0 \\sin(\\omega t_k)$ 和 $\\dot{\\varepsilon}_k = \\omega \\varepsilon_0 \\cos(\\omega t_k)$。\n- 对每个单元 $i$，计算 $\\sigma_{i,k} = E_i \\varepsilon_k + \\eta_i \\dot{\\varepsilon}_k$。\n- 在应变空间中评估梯形线积分：\n$$\nW_{\\mathrm{d},i} \\approx \\sum_{k=0}^{N-1} \\frac{\\sigma_{i,k} + \\sigma_{i,k+1}}{2} \\left( \\varepsilon_{k+1} - \\varepsilon_k \\right).\n$$\n- 将每个 $W_{\\mathrm{d},i}$ 四舍五入到 6 位小数，并以帕斯卡 (Pa) 为单位报告。\n\n测试套件覆盖范围：\n- 测试用例 1 验证了纯弹性单元在不同刚度下均产生 $W_{\\mathrm{d}} \\approx 0$。\n- 测试用例 2 验证了粘弹性单元产生的正 $W_{\\mathrm{d}}$ 与 $\\eta_i$ 成正比，并通过高分辨率采样（$N = 4000$）确保了数值积分的收敛性。\n- 测试用例 3 在粗糙采样（$N = 16$）和较高频率（$f = 5.0$）下对数值程序进行压力测试，以确保其鲁棒性，并产生近似但物理上一致的 $W_{\\mathrm{d}}$。\n\n最终程序按要求打印单行输出，其中包含三个测试用例的 $W_{\\mathrm{d}}$ 值的嵌套列表，四舍五入到 6 位小数，单位为帕斯卡 (Pa)。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef generate_time_series(e0, f, N):\n    \"\"\"\n    Generate strain and strain-rate time series over one cycle with N+1 samples (closed loop).\n    Parameters:\n        e0 (float): strain amplitude (dimensionless)\n        f (float): frequency in Hz\n        N (int): number of segments per cycle; produces N+1 samples including endpoints\n    Returns:\n        t (ndarray): time samples (N+1,)\n        eps (ndarray): strain samples (N+1,)\n        deps_dt (ndarray): strain-rate samples (N+1,)\n    \"\"\"\n    T = 1.0 / f\n    omega = 2.0 * np.pi * f\n    t = np.linspace(0.0, T, N + 1, endpoint=True)\n    eps = e0 * np.sin(omega * t)\n    deps_dt = omega * e0 * np.cos(omega * t)\n    return t, eps, deps_dt\n\ndef compute_sigma(eps, deps_dt, E, eta):\n    \"\"\"\n    Compute stress time series for Kelvin-Voigt-type viscoelastic response:\n        sigma = E * eps + eta * deps_dt\n    Parameters:\n        eps (ndarray): strain samples\n        deps_dt (ndarray): strain-rate samples\n        E (float): elastic modulus in Pa\n        eta (float): viscosity in Pa*s\n    Returns:\n        sigma (ndarray): stress samples in Pa\n    \"\"\"\n    return E * eps + eta * deps_dt\n\ndef compute_Wd_from_loop(eps, sigma):\n    \"\"\"\n    Compute hysteretic energy dissipation per unit volume per cycle (Pa) via\n    trapezoidal line integral along the parametric loop (eps(t), sigma(t)):\n        Wd ≈ sum_k 0.5*(sigma_k + sigma_{k+1}) * (eps_{k+1} - eps_k)\n    This uses N+1 samples with endpoints included to close the loop.\n    Parameters:\n        eps (ndarray): strain samples (N+1,)\n        sigma (ndarray): stress samples (N+1,)\n    Returns:\n        Wd (float): energy dissipation density per cycle in Pa\n    \"\"\"\n    # Differences in strain between consecutive samples\n    delta_eps = np.diff(eps)\n    # Average stress on segments\n    sigma_avg = 0.5 * (sigma[:-1] + sigma[1:])\n    # Line integral sum\n    Wd = np.sum(sigma_avg * delta_eps)\n    return float(Wd)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (E_list, eta_list, e0, f, N)\n    test_cases = [\n        # Test Case 1: elastic (eta=0), two elements\n        ([10000.0, 30000.0], [0.0, 0.0], 0.02, 1.0, 1000),\n        # Test Case 2: viscoelastic heterogeneous, well-resolved\n        ([10000.0, 30000.0], [1000.0, 500.0], 0.02, 1.0, 4000),\n        # Test Case 3: viscoelastic heterogeneous, under-sampled high frequency\n        ([10000.0, 30000.0], [1000.0, 500.0], 0.02, 5.0, 16),\n    ]\n\n    results = []\n    for E_list, eta_list, e0, f, N in test_cases:\n        # Generate time series for one cycle\n        t, eps, deps_dt = generate_time_series(e0=e0, f=f, N=N)\n        # Compute Wd per element\n        case_Wd = []\n        for E, eta in zip(E_list, eta_list):\n            sigma = compute_sigma(eps=eps, deps_dt=deps_dt, E=E, eta=eta)\n            Wd = compute_Wd_from_loop(eps=eps, sigma=sigma)\n            # Round to 6 decimal places\n            case_Wd.append(Wd)\n        results.append(case_Wd)\n\n    # Format the nested list with each float rounded to 6 decimals.\n    def format_nested(res):\n        return \"[\" + \",\".join(\n            \"[\" + \",\".join(f\"{val:.6f}\" for val in case) + \"]\" for case in res\n        ) + \"]\"\n\n    print(format_nested(results))\n\nsolve()\n```"
        }
    ]
}