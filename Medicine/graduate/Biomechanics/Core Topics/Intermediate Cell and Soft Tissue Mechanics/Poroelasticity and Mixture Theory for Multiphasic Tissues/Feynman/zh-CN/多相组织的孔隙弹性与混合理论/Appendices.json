{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础但至关重要的场景开始：稳定的一维流动。这项练习将通过直接从流体动量平衡和质量守恒定律推导孔隙压力控制方程，来巩固您的基本技能。通过这个实践，您将看到这些基本物理定律在稳态条件下如何简化为一个熟悉的数学形式，从而清晰地揭示物理原理与最终压力分布之间的联系。",
            "id": "4199350",
            "problem": "考虑一维稳态间质流，该流体流经线性变形的饱和生物组织。该组织被建模为固相基质（上标 $s$）和流体（上标 $f$）的两相混合物。该组织占据区间 $x \\in [0,L]$，并被不可压缩的间质流体所饱和。假设以下符合混合物理论的物理现实条件：\n- 流动是准静态的，惯性可忽略不计。\n- 流体柯西应力为纯静水压力，因此 $\\boldsymbol{\\sigma}^{f} = -p\\,\\mathbf{I}$，其中 $p(x)$ 是孔隙压力，$\\mathbf{I}$ 是单位张量。\n- 体力可忽略不计。\n- 水力渗透张量为常数且各向同性，$\\mathbf{k} = k\\,\\mathbf{I}$，其中 $k>0$ 为常数。\n- 流体相和固相各自不可压缩，且流体体积分数 $n^{f}$ 在空间上是均匀的。\n- 固相基质速度场沿 $x$ 方向是均匀的，因此 $v^{s}$ 在空间上是常数；特别地，在推导压力时，可以不失一般性地取 $v^{s}=0$。\n\n从流体相的线性动量平衡出发，并使用与相间相对速度成正比的标准线性拖曳相互作用，推导在这些假设下孔隙压力 $p(x)$ 的控制微分方程。然后，在边界压力 $p(0)=p_{0}$ 和 $p(L)=p_{L}$ 的条件下，计算 $p(x)$ 在 $[0,L]$ 上的显式表达式。用 $p_{0}$、$p_{L}$、$L$ 和 $x$ 表示 $p(x)$ 的最终表达式。压力单位为帕斯卡 (Pa)，位置单位为米 (m)。最终答案必须是单一的封闭形式解析表达式。无需四舍五入。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **模型**：线性变形的饱和生物组织中的一维稳态间质流。\n- **区域**：$x \\in [0,L]$。\n- **组成**：固相基质（上标 $s$）和流体（上标 $f$）的两相混合物。\n- **饱和度**：组织被不可压缩的间质流体饱和。\n- **动力学**：流动是准静态的，惯性可忽略不计。\n- **流体应力**：流体柯西应力是静水压力，$\\boldsymbol{\\sigma}^{f} = -p\\,\\mathbf{I}$，其中 $p(x)$ 是孔隙压力。\n- **外力**：体力可忽略不计。\n- **渗透性**：水力渗透张量为常数且各向同性，$\\mathbf{k} = k\\,\\mathbf{I}$，其中 $k>0$ 为常数。\n- **组分性质**：流体相和固相各自不可压缩。流体体积分数 $n^{f}$ 在空间上是均匀的。\n- **固体运动学**：固相基质速度场 $v^{s}$ 在空间上是常数；具体为 $v^{s}=0$。\n- **相间相互作用**：假设存在与相对速度成正比的标准线性拖曳相互作用。\n- **边界条件**：$p(0)=p_{0}$ 和 $p(L)=p_{L}$。\n- **任务**：\n    1. 推导孔隙压力 $p(x)$ 的控制微分方程。\n    2. 计算 $p(x)$ 在 $[0,L]$ 上的显式表达式。\n- **输出要求**：用 $p_{0}$、$p_L$、$L$ 和 $x$ 表示 $p(x)$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题根植于已成熟的混合物理论和孔隙弹性力学领域，这是模拟如生物组织等流体饱和多孔介质的标准框架。所给出的假设（例如，准静态流动、达西型拖曳力、不可压缩性）是生物力学中常用且物理上合理的简化。该问题具有科学合理性。\n- **适定性**：从物理原理推导控制微分方程，然后用给定的边界条件求解，这是一个标准的数学物理问题。所得到的边值问题包含一个二阶线性常微分方程和两个狄利克雷条件，这保证了唯一且稳定的解。该问题是适定的。\n- **客观性**：问题陈述使用了精确、定量的语言和公认的科学术语。所有假设和条件都是明确的。该问题是客观的。\n- **完备性与一致性**：所提供的信息足以推导控制方程并找到其解。各项假设内部一致。例如，稳态、组分不可压缩和固相速度均匀的组合假设导致了一个无散度的渗流速度场，这与给定条件下的达西型动量平衡是一致的。“线性变形”的描述与问题的稳态性质一致，即任何变形都已发生，从而形成一个稳定构型，在该问题的约束下，该构型必须具有均匀的流体体积分数 $n^f$。\n\n**步骤3：结论与行动**\n该问题是有效的，因为它具有科学合理性、适定性、客观性和自洽性。可以进行求解过程。\n\n### 控制方程的推导与求解\n\n推导始于两相混合物中流体相的线性动量守恒。该平衡定律的一般形式为：\n$$\n\\rho^f \\frac{D^f \\mathbf{v}^f}{D t} = \\nabla \\cdot \\boldsymbol{\\sigma}^f + \\mathbf{\\pi}^f + \\rho^f \\mathbf{b}^f\n$$\n其中 $\\rho^f$ 是流体的表观密度，$\\mathbf{v}^f$ 是流体速度，$\\frac{D^f}{D t}$ 是跟随流体运动的物质时间导数，$\\boldsymbol{\\sigma}^f$ 是流体的分柯西应力张量，$\\mathbf{\\pi}^f$ 是表示来自固相的相互作用拖曳力的动量供给项，$\\mathbf{b}^f$ 是单位质量的体力。\n\n我们应用问题陈述中给出的假设来简化此方程：\n1.  **准静态流动，惯性可忽略不计**：左侧的加速度项为零。$\\rho^f \\frac{D^f \\mathbf{v}^f}{D t} = \\mathbf{0}$。\n2.  **体力可忽略不计**：$\\mathbf{b}^f = \\mathbf{0}$。\n3.  **静水流体应力**：$\\boldsymbol{\\sigma}^f = -p \\mathbf{I}$，其中 $p$ 是孔隙压力，$\\mathbf{I}$ 是单位张量。该应力的散度为 $\\nabla \\cdot (-p \\mathbf{I}) = - \\nabla p$。\n\n将这些代入动量平衡方程得到：\n$$\n\\mathbf{0} = -\\nabla p + \\mathbf{\\pi}^f\n$$\n这意味着压力梯度与来自固相的相互作用力相平衡：\n$$\n\\nabla p = \\mathbf{\\pi}^f\n$$\n问题指定了“标准线性拖曳相互作用”和“水力渗透张量”，这两者共同蕴含了达西定律。达西定律将渗流速度 $\\mathbf{w} = n^f(\\mathbf{v}^f - \\mathbf{v}^s)$ 与压力梯度联系起来。该定律表示为：\n$$\n\\mathbf{w} = -\\frac{\\mathbf{k}}{\\mu_f} \\nabla p\n$$\n其中 $\\mathbf{k}$ 是渗透张量，$\\mu_f$ 是流体的动力粘度，为一常数。鉴于渗透性是常数且各向同性，$\\mathbf{k} = k\\mathbf{I}$，方程简化为：\n$$\n\\mathbf{w} = -\\frac{k}{\\mu_f} \\nabla p\n$$\n接下来，我们应用质量守恒原理。对于由两种不可压缩相（固相和流体）组成的饱和混合物，体积平衡方程之和得出混合物连续性方程：\n$$\n\\nabla \\cdot (n^s \\mathbf{v}^s + n^f \\mathbf{v}^f) = 0\n$$\n散度中的项可以使用渗流速度 $\\mathbf{w}$ 重写：\n$$\nn^s \\mathbf{v}^s + n^f \\mathbf{v}^f = (1 - n^f)\\mathbf{v}^s + n^f \\mathbf{v}^f = \\mathbf{v}^s + n^f(\\mathbf{v}^f - \\mathbf{v}^s) = \\mathbf{v}^s + \\mathbf{w}\n$$\n因此连续性方程变为：\n$$\n\\nabla \\cdot (\\mathbf{v}^s + \\mathbf{w}) = \\nabla \\cdot \\mathbf{v}^s + \\nabla \\cdot \\mathbf{w} = 0\n$$\n问题陈述中指出，固相速度 $v^s$ 在空间上是均匀的（取为 $v^s=0$）。一个空间均匀的矢量场其散度为零，因此 $\\nabla \\cdot \\mathbf{v}^s = 0$。这将混合物连续性方程简化为：\n$$\n\\nabla \\cdot \\mathbf{w} = 0\n$$\n现在我们将动量（达西定律）和连续性方程结合起来。将 $\\mathbf{w}$ 的表达式代入连续性方程得到：\n$$\n\\nabla \\cdot \\left( -\\frac{k}{\\mu_f} \\nabla p \\right) = 0\n$$\n由于渗透率 $k$ 和粘度 $\\mu_f$ 是常数，它们可以从散度算子中提出：\n$$\n-\\frac{k}{\\mu_f} \\nabla^2 p = 0\n$$\n由于 $k>0$ 且 $\\mu_f>0$，这导出了孔隙压力的控制微分方程：\n$$\n\\nabla^2 p = 0\n$$\n这就是拉普拉斯方程。对于 $p$ 仅是 $x$ 的函数的一维情况，该方程简化为：\n$$\n\\frac{d^2 p}{dx^2} = 0\n$$\n这就是所求的孔隙压力 $p(x)$ 的控制常微分方程。\n\n为了找到 $p(x)$ 的显式表达式，我们求解这个二阶常微分方程并满足给定的边界条件。对 $x$ 积分一次得到：\n$$\n\\frac{dp}{dx} = C_1\n$$\n其中 $C_1$ 是一个积分常数。再次积分得到通解：\n$$\np(x) = C_1 x + C_2\n$$\n其中 $C_2$ 是第二个积分常数。我们使用边界条件 $p(0)=p_0$ 和 $p(L)=p_L$ 来确定这些常数。\n\n在 $x=0$ 处应用第一个边界条件：\n$$\np(0) = C_1(0) + C_2 = p_0 \\implies C_2 = p_0\n$$\n解变为 $p(x) = C_1 x + p_0$。现在，在 $x=L$ 处应用第二个边界条件：\n$$\np(L) = C_1 L + p_0 = p_L\n$$\n求解 $C_1$：\n$$\nC_1 L = p_L - p_0 \\implies C_1 = \\frac{p_L - p_0}{L}\n$$\n将 $C_1$ 和 $C_2$ 的表达式代回通解，得到孔隙压力分布的显式表达式：\n$$\np(x) = \\left( \\frac{p_L - p_0}{L} \\right) x + p_0\n$$\n这个表达式可以重新整理，以突显边界值之间的线性插值：\n$$\np(x) = p_0 - \\frac{p_0}{L}x + \\frac{p_L}{L}x = p_0 \\left(1 - \\frac{x}{L}\\right) + p_L \\frac{x}{L}\n$$\n这就是孔隙压力 $p(x)$ 作为位置 $x$ 和边界压力 $p_0$、$p_L$ 的函数的最终解析表达式。",
            "answer": "$$\n\\boxed{p_0 + \\left( \\frac{p_L - p_0}{L} \\right) x}\n$$"
        },
        {
            "introduction": "在掌握了稳态分析之后，我们引入时间维度来探索多孔弹性理论中的一个核心问题：一维固结。这项练习不仅涉及推导控制孔隙压力随时间消散的扩散型方程，这也是组织受压时力学响应的关键过程。更重要的是，它展示了理论的实际应用价值，即如何从实验测量的松弛数据中确定关键的材料属性——固结系数 $c_v$。",
            "id": "4199349",
            "problem": "对一个含水的纤维状生物组织进行一维（1D）约束压缩测试，以表征其孔隙弹性固结特性。该框架是用于多相组织的Biot型混合物理论，假设间质流体不可压缩，实体基质为线性弹性，应变为小应变，且材料参数恒定。流体相对于固体的通量由达西型流动控制，且在约束压缩下，固体的有效应力与轴向应变成正比。你将首先推导固结控制方程并确定固结系数，然后根据实验松弛数据计算其值。\n\n从适用于孔隙弹性混合物的基本平衡定律和定义出发，完成以下任务：\n\n1. 利用一维流固混合物的质量守恒、约束压缩下的线性弹性有效应力-应变关系以及达西流体通量定律，推导试样中超孔隙压力 $p(z,t)$ 的扩散型控制方程。定义一维固结的固结系数 $c_v$，并将其与组织渗透率 $k$ 和体积压缩系数 $m_v$ 明确关联。阐明在固结仪（约束压缩）条件下 $m_v$ 的含义。\n\n2. 考虑一个厚度为 $h$ 的双面排水（两面均可渗透）试样，在 $t=0$ 时刻受到一个阶跃轴向应变，此后该应变保持恒定。对于此边值问题，固结响应的主导（主）模式随时间近似呈指数衰减，其特征时间常数为 $\\tau$，该常数取决于 $c_v$ 和 $h$。建立主模式下 $\\tau$、$c_v$ 和 $h$ 之间的关系，并展示如何从实验测得的轴向力松弛半衰期 $t_{1/2}$（即力衰减到其初始值一半时所用的时间）中提取 $c_v$。\n\n3. 对一个厚度为 $h = 1.50 \\,\\mathrm{mm}$ 的试样进行约束压缩测试。归一化轴向力在 $t_{1/2} = 440 \\,\\mathrm{s}$ 时松弛至其初始值的一半。另外，独立测量了渗透率和压缩性：达西型渗透率为 $k = 3.00 \\times 10^{-16} \\,\\mathrm{m^4 \\, N^{-1} \\, s}$，在轴向应变 $\\epsilon_{z} = 0.05$ 时的平衡应力为 $\\sigma_{\\mathrm{eq}} = 60 \\,\\mathrm{kPa}$，由此可在固结仪条件下得到约束模量 $H$ 和体积压缩系数 $m_v$。\n\n根据第2部分的松弛数据，使用主模式近似和测得的 $t_{1/2}$，计算固结系数 $c_v$（单位为 $\\mathrm{m^2/s}$）。将最终数值答案四舍五入至三位有效数字，并以 $\\mathrm{m^2/s}$ 为单位表示。为了内部一致性，你可以使用在第1部分中推导的渗透率-压缩性关系来验证你的结果，但最终答案只报告一个 $c_v$ 值。",
            "solution": "问题陈述经评估具有科学依据、提法恰当、客观且内部一致。它代表了生物力学领域（特别是孔隙弹性力学）中的一个标准问题，并包含足够的信息以获得唯一解。因此，该问题被认为是有效的。\n\n解答遵循问题的指示，分为三个部分。\n\n**1. 控制方程与固结系数的推导**\n\n孔隙弹性介质的一维（1D）固结由三个基本原理控制：质量守恒、达西流体流动定律以及有效应力原理与实体基质本构律的结合。\n\n首先，我们考虑质量守恒。对于在小应变条件下，由不可压缩的流体和固体组分构成的饱和多孔介质，固体骨架代表性单元的体积变化率必须与流入或流出该单元的流体净速率相平衡。在一维情况下，唯一的非零应变分量是轴向应变 $\\epsilon_z$，该原理表示为：\n$$\n\\frac{\\partial \\epsilon_z}{\\partial t} = -\\frac{\\partial w_z}{\\partial z}\n$$\n其中 $\\epsilon_z(z,t)$ 是实体基质的轴向应变，而 $w_z(z,t)$ 是流体在 $z$ 方向上相对于实体基质的比流量（也称为渗流速度）。\n\n其次，达西定律将渗流速度与超孔隙流体压力 $p(z,t)$ 的梯度联系起来。在一维情况下，该定律为：\n$$\nw_z = -k \\frac{\\partial p}{\\partial z}\n$$\n其中 $k$ 是组织的达西渗透率。将达西定律代入质量守恒方程，得到：\n$$\n\\frac{\\partial \\epsilon_z}{\\partial t} = -\\frac{\\partial}{\\partial z} \\left(-k \\frac{\\partial p}{\\partial z}\\right) = k \\frac{\\partial^2 p}{\\partial z^2}\n$$\n假设渗透率 $k$ 是恒定的。\n\n第三，有效应力原理将总应力、有效应力和孔隙压力联系起来。在一维约束压缩下，实体基质的有效应力 $\\sigma'_z$ 与轴向应变 $\\epsilon_z$ 呈线性关系，$\\sigma'_z = H \\epsilon_z$，其中 $H$ 是约束模量。总应力为 $\\sigma_z = \\sigma'_z + p = H \\epsilon_z + p$。将此关系对时间求导，并将 $\\frac{\\partial \\epsilon_z}{\\partial t}$ 与我们从质量守恒和达西定律中得到的 $k \\frac{\\partial^2 p}{\\partial z^2}$ 联系起来，可以推导出孔隙压力 $p$ 的控制方程。在许多典型情况下（如恒定总应力下的蠕变或瞬时施加应变后的应力松弛），这个方程简化为经典的一维扩散方程：\n$$\n\\frac{\\partial p}{\\partial t} = c_v \\frac{\\partial^2 p}{\\partial z^2}\n$$\n其中 **固结系数** $c_v$ 定义为：\n$$\nc_v = kH\n$$\n体积压缩系数 $m_v$ 定义为单位有效应力变化引起的应变变化，在固结仪条件下，$m_v = \\frac{d\\epsilon_z}{d\\sigma'_z} = \\frac{1}{H}$。因此，固结系数也可以表示为：\n$$\nc_v = \\frac{k}{m_v}\n$$\n\n**2. $c_v$、$h$ 和 $t_{1/2}$ 之间的关系**\n\n我们分析一个厚度为 $h$ 的双面排水试样的边值问题。这对应于在定义域 $z \\in [0, h]$ 上的扩散方程 $\\frac{\\partial p}{\\partial t} = c_v \\frac{\\partial^2 p}{\\partial z^2}$，其边界条件为 $p(0,t)=0$ 和 $p(h,t)=0$。对于 $t=0$ 时的阶跃条件变化，解可以表示为傅里叶正弦级数：\n$$\np(z,t) = \\sum_{n=1}^{\\infty} B_n \\sin\\left(\\frac{n\\pi z}{h}\\right) \\exp\\left(-\\frac{n^2 \\pi^2 c_v t}{h^2}\\right)\n$$\n问题指出，固结响应由主模式主导，该模式对应于级数的第一项（$n=1$）。该模式的衰减由指数项 $\\exp\\left(-\\frac{\\pi^2 c_v t}{h^2}\\right)$ 控制。\n将其与标准指数衰减过程 $\\exp(-t/\\tau)$ 比较，主模式的特征时间常数 $\\tau$ 为：\n$$\n\\tau = \\frac{h^2}{\\pi^2 c_v}\n$$\n这就建立了 $\\tau$、$c_v$ 和 $h$ 之间的关系。\n\n在应力松弛测试（恒定应变）中，与平均超孔隙压力成正比的超轴向力也以相同的时间常数衰减。设归一化超额力为 $F_{norm}(t) = \\frac{F(t) - F_{eq}}{F_0 - F_{eq}}$，其中 $F_0$ 是初始力，$F_{eq}$ 是平衡力。这个归一化的力近似地按 $F_{norm}(t) \\approx \\exp(-t/\\tau)$ 衰减。松弛半衰期 $t_{1/2}$ 是这个归一化的力衰减到 $1/2$ 时的时间。\n$$\n\\frac{1}{2} = \\exp(-t_{1/2}/\\tau)\n$$\n对两边取自然对数，得到：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = -\\ln(2) = -\\frac{t_{1/2}}{\\tau} \\implies t_{1/2} = \\tau \\ln(2)\n$$\n代入 $\\tau$ 的表达式，得到 $t_{1/2}$、$c_v$ 和 $h$ 之间的关系：\n$$\nt_{1/2} = \\frac{h^2 \\ln(2)}{\\pi^2 c_v}\n$$\n这个式子可以重新整理，以求解固结系数 $c_v$：\n$$\nc_v = \\frac{h^2 \\ln(2)}{\\pi^2 t_{1/2}}\n$$\n\n**3. 固结系数的计算**\n\n问题提供了来自约束压缩松弛测试的以下实验数据：\n- 试样厚度：$h = 1.50$ mm\n- 松弛半衰期：$t_{1/2} = 440$ s\n\n首先，我们必须确保所有单位都采用国际单位制（SI）基本单位。厚度 $h$ 必须从毫米转换为米：\n$$\nh = 1.50 \\,\\text{mm} = 1.50 \\times 10^{-3} \\,\\text{m}\n$$\n现在，我们将 $h$ 和 $t_{1/2}$ 的值代入第2部分推导出的公式中：\n$$\nc_v = \\frac{(1.50 \\times 10^{-3} \\,\\text{m})^2 \\ln(2)}{\\pi^2 (440 \\,\\text{s})}\n$$\n让我们计算各项：\n$$\nh^2 = (1.50 \\times 10^{-3})^2 \\,\\text{m}^2 = 2.25 \\times 10^{-6} \\,\\text{m}^2\n$$\n使用常数值 $\\ln(2) \\approx 0.693147$ 和 $\\pi^2 \\approx 9.869604$：\n$$\nc_v = \\frac{(2.25 \\times 10^{-6}) \\times 0.693147}{9.869604 \\times 440} \\,\\frac{\\text{m}^2}{\\text{s}}\n$$\n$$\nc_v = \\frac{1.55958 \\times 10^{-6}}{4342.626} \\,\\frac{\\text{m}^2}{\\text{s}}\n$$\n$$\nc_v \\approx 3.5913 \\times 10^{-10} \\,\\frac{\\text{m}^2}{\\text{s}}\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\nc_v = 3.59 \\times 10^{-10} \\,\\frac{\\text{m}^2}{\\text{s}}\n$$\n这是使用主模式近似从松弛数据计算出的固结系数值。",
            "answer": "$$\\boxed{3.59 \\times 10^{-10}}$$"
        },
        {
            "introduction": "最后，我们将从“正问题”（已知属性计算响应）转向更具挑战性的“反问题”（根据测量的响应估计属性）。在实际的生物力学研究中，诸如渗透率之类的材料属性通常是未知的，必须通过充满噪声的实验数据来确定。这项高级实践将指导您构建一个反问题，使用线性最小二乘法来估计渗透率张量，并强调了为确保解的稳定性和物理合理性而引入正则化技术的重要性。",
            "id": "4199368",
            "problem": "在侧向约束下，对一个平面组织样本进行约束压缩试验。根据混合物理论，间质流体（液相）相对于固体基质（固相）运动。在忽略惯性的准静态状态下，流体动量平衡简化为一种由拖曳力驱动的关系，通常写为达西定律。令 $\\mathbf{q}^f(t) \\in \\mathbb{R}^d$ 表示时间 $t$ 时的流体通量矢量（$d$ 为维度，此处 $d=1$ 或 $d=2$），$\\nabla p(t) \\in \\mathbb{R}^d$ 表示压力梯度，$\\mu$ 表示流体的动力粘度，$\\mathbf{K} \\in \\mathbb{R}^{d \\times d}$ 表示多孔固体的内在渗透率张量。其本构关系为\n$$\n\\mathbf{q}^f(t) = -\\frac{1}{\\mu}\\,\\mathbf{K}\\,\\nabla p(t).\n$$\n在约束压缩试验中，$\\mu$ 是已知且恒定的（对于水，取 $\\mu = 1.0\\times 10^{-3}$ Pa·s），而 $\\mathbf{q}^f(t)$ 和 $\\nabla p(t)$ 是随时间测量的，并带有噪声。目标是通过构建一个反演问题，从这些测量值中估计 $\\mathbf{K}$。对于一维情况，$\\mathbf{K}$ 简化为标量 $k \\in \\mathbb{R}$；对于二维平面样本，$\\mathbf{K}$ 是一个对称正定（SPD）的 $2\\times 2$ 张量。\n\n从混合物理论中的基本平衡方程和上述通量-压力梯度关系定义出发，将此反演问题构建为对未知渗透率参数的线性最小二乘估计。引入正则化以确保可辨识性和物理合理性，包括：\n- Tikhonov 正则化（岭惩罚）以控制估计参数的大小。\n- 对称性惩罚，用于在数据不足以直接辨识非对角线不对称性时，从数据中估计一个完整的 $2\\times 2$ 张量时强制 $\\mathbf{K} \\approx \\mathbf{K}^\\top$。\n- 一个投影步骤，以强制最终的 $\\mathbf{K}$ 估计是对称正定的。\n\n您必须实现一个程序，该程序：\n- 为下面定义的三个测试案例构建与约束压缩设置（通量和压力梯度时间序列）一致的合成数据集。\n- 向 $\\mathbf{q}^f(t)$ 添加与实际幅度一致的测量噪声。\n- 求解正则化反演问题，以估计 $k$（对于 $d=1$）或 $\\mathbf{K}$（对于 $d=2$），单位为 $\\mathrm{m}^2$。\n- 使用 $\\mu = 1.0\\times 10^{-3}$ Pa·s 的显式值。\n- 按规定输出每个测试案例的估计渗透率值。\n\n推导和算法的基本依据：\n- 混合物理论中，在惯性可忽略的情况下，流体相的线性动量平衡产生一个由压力梯度驱动流动的拖曳定律。\n- 间质流体通量的类达西本构关系在 $\\nabla p$ 上是线性的，其比例性涉及 $\\mu$ 和 $\\mathbf{K}$。\n- 带 Tikhonov 正则化的线性最小二乘法为从带噪声的线性测量中估计参数提供了一种有原则的方法。\n\n反演问题模型和正则化设计：\n- 对于一维情况，样本索引为 $i=1,\\dots,N$，模型是 $q_i^f = -\\frac{k}{\\mu} g_i$，其中 $g_i$ 是标量压力梯度。通过最小化以下式子来估计 $k$\n$$\n\\min_{k} \\sum_{i=1}^N \\left(q_i^f + \\frac{k}{\\mu} g_i\\right)^2 + \\lambda\\, k^2,\n$$\n其中 $\\lambda > 0$ 是一个 Tikhonov 正则化参数。\n- 对于二维情况，样本索引为 $i=1,\\dots,N$，矢量 $\\mathbf{q}_i^f \\in \\mathbb{R}^2$，$\\mathbf{g}_i = \\nabla p_i \\in \\mathbb{R}^2$，将 $\\mathbf{K}$ 的元素写作 $K_{11}, K_{12}, K_{21}, K_{22}$，并将它们收集在一个矢量 $\\mathbf{s} = [K_{11}, K_{12}, K_{21}, K_{22}]^\\top$ 中。线性模型是\n$$\n\\mathbf{q}_i^f = -\\frac{1}{\\mu} \\mathbf{K} \\mathbf{g}_i,\n$$\n它为每个样本产生两个方程：\n$$\nq_{i,x}^f = -\\frac{1}{\\mu}\\left(K_{11} g_{i,x} + K_{12} g_{i,y}\\right), \\quad\nq_{i,y}^f = -\\frac{1}{\\mu}\\left(K_{21} g_{i,x} + K_{22} g_{i,y}\\right).\n$$\n将所有样本堆叠起来得到 $\\mathbf{A}\\mathbf{s} \\approx \\mathbf{b}$，其中 $\\mathbf{A} \\in \\mathbb{R}^{2N \\times 4}$ 且 $\\mathbf{b} \\in \\mathbb{R}^{2N}$，正则化问题是\n$$\n\\min_{\\mathbf{s}} \\|\\mathbf{A}\\mathbf{s} - \\mathbf{b}\\|_2^2 + \\lambda \\|\\mathbf{s}\\|_2^2 + \\gamma (K_{12} - K_{21})^2,\n$$\n其中 $\\lambda > 0$ 是 Tikhonov 参数，$\\gamma > 0$ 是对称性惩罚参数。求解后，通过设置 $K_{12} \\leftarrow \\frac{K_{12}+K_{21}}{2}$ 和 $K_{21} \\leftarrow K_{12}$ 来强制对称，然后通过将特征值裁剪到不小于一个小的正阈值来投影到最近的 SPD 张量。\n\n单位和输出规范：\n- 以 $\\mathrm{m}^2$ 为单位报告所有渗透率值。\n- 最终的程序输出必须是单一行：一个用方括号括起来的逗号分隔列表。该列表应包含：\n  1. 一维估计的标量 $k$（浮点数）。\n  2. 对于具有充分激励的二维各向异性情况，一个包含三个浮点数的列表 $[K_{11}, K_{12}, K_{22}]$。\n  3. 对于具有近乎共线梯度的二维退化情况，一个包含三个浮点数的列表 $[K_{11}, K_{12}, K_{22}]$。\n- 每个浮点数应以科学记数法表示，小数点后保留六位数字。不应打印任何单位文本；数值的单位被理解为 $\\mathrm{m}^2$。\n\n测试套件：\n- 案例 1（一维，良态）：\n  - 真实值 $k_{\\text{true}} = 1.5\\times 10^{-15}\\ \\mathrm{m}^2$。\n  - 时间 $t_i$（$i=0,\\dots,50$）在 $[0,10]$ 秒内均匀分布。\n  - 压力梯度样本 $g_i = 1.0\\times 10^{5} \\left(1 + 0.5 \\sin(t_i)\\right)\\ \\mathrm{Pa/m}$。\n  - 通量样本 $q_i^f = -\\frac{k_{\\text{true}}}{\\mu} g_i$，带有标准差为 $\\sigma_q = 1.0\\times 10^{-8}\\ \\mathrm{m/s}$ 的加性高斯噪声。\n  - 正则化参数 $\\lambda = 1.0\\times 10^{-20}$。\n- 案例 2（二维，各向异性，充分激励）：\n  - 真实值 $\\mathbf{K}_{\\text{true}} = \\begin{bmatrix} 3.0\\times 10^{-15} & 0.5\\times 10^{-15} \\\\ 0.5\\times 10^{-15} & 1.0\\times 10^{-15} \\end{bmatrix}\\ \\mathrm{m}^2$。\n  - $N=100$ 个样本，其压力梯度 $\\mathbf{g}_i$ 通过旋转和缩放一个基础量值构建：$\\|\\mathbf{g}_i\\| \\approx 1.0\\times 10^{5}\\ \\mathrm{Pa/m}$，方向跨越整个平面；精确值是确定性生成的。\n  - 通量样本 $\\mathbf{q}_i^f = -\\frac{1}{\\mu} \\mathbf{K}_{\\text{true}} \\mathbf{g}_i$，每个分量带有标准差为 $\\sigma_q = 2.0\\times 10^{-8}\\ \\mathrm{m/s}$ 的加性高斯噪声。\n  - 正则化参数 $\\lambda = 1.0\\times 10^{-20}$，$\\gamma = 1.0\\times 10^{-20}$；SPD 投影阈值 $\\epsilon = 1.0\\times 10^{-18}$。\n- 案例 3（二维，退化梯度，病态）：\n  - 真实值 $\\mathbf{K}_{\\text{true}} = \\begin{bmatrix} 2.0\\times 10^{-15} & 0.0 \\\\ 0.0 & 2.0\\times 10^{-15} \\end{bmatrix}\\ \\mathrm{m}^2$（各向同性基线）。\n  - $N=50$ 个样本，其压力梯度 $\\mathbf{g}_i$ 与 $x$ 轴近乎共线且量值较小：$\\|\\mathbf{g}_i\\| \\approx 1.0\\times 10^{2}\\ \\mathrm{Pa/m}$；精确值是确定性生成的。\n  - 通量样本 $\\mathbf{q}_i^f = -\\frac{1}{\\mu} \\mathbf{K}_{\\text{true}} \\mathbf{g}_i$，每个分量带有标准差为 $\\sigma_q = 2.0\\times 10^{-8}\\ \\mathrm{m/s}$ 的加性高斯噪声。\n  - 正则化参数 $\\lambda = 1.0\\times 10^{-16}$，$\\gamma = 1.0\\times 10^{-12}$；SPD 投影阈值 $\\epsilon = 1.0\\times 10^{-18}$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，顺序和格式如上所述。例如，输出必须类似于 $\\left[\\text{k1},[\\text{K11\\_2},\\text{K12\\_2},\\text{K22\\_2}],[\\text{K11\\_3},\\text{K12\\_3},\\text{K22\\_3}]\\right]$，其中每个数值条目的单位为 $\\mathrm{m}^2$，并以小数点后六位的科学记数法格式化。",
            "solution": "推导始于多相组织的混合物理论，其中不同的相（固体基质和间质流体）共存并通过动量交换相互作用。在约束压缩和准静态（惯性可忽略）条件下，流体相的线性动量平衡简化为压力梯度与因通过多孔固体的相对运动而产生的摩擦拖曳力之间的平衡。这导致了一个达西类型的本构关系：\n$$\n\\mathbf{q}^f(t) = -\\frac{1}{\\mu}\\,\\mathbf{K}\\,\\nabla p(t),\n$$\n其中 $\\mathbf{q}^f$ 是相对于固体骨架的流体通量，$\\mu$ 是动力粘度，$\\mathbf{K}$ 是固体的内在渗透率张量。渗透率 $\\mathbf{K}$ 概括了抵抗流动的微观结构特征。\n\n为了从时间序列测量 $\\{\\mathbf{q}_i^f, \\nabla p_i\\}_{i=1}^N$ 中估计 $\\mathbf{K}$，我们构建一个反演问题。从 $\\mathbf{K}$ 到 $\\mathbf{q}^f$ 的映射是线性的，因此在有噪声的情况下，反演问题自然地变成了一个带正则化的线性最小二乘估计。\n\n一维情况：\n对于 $d=1$，写作 $q_i^f = -\\frac{k}{\\mu} g_i$，其中 $g_i$ 是标量压力梯度。选择 Tikhonov 正则化（岭惩罚）得到\n$$\n\\min_{k} \\sum_{i=1}^N \\left(q_i^f + \\frac{k}{\\mu} g_i\\right)^2 + \\lambda\\, k^2.\n$$\n对于 $\\lambda>0$，该目标函数是严格凸的，确保了唯一解。对 $k$ 求导并令其为零，得到\n$$\n\\sum_{i=1}^N \\left(q_i^f + \\frac{k}{\\mu} g_i\\right)\\left(\\frac{g_i}{\\mu}\\right) + \\lambda k = 0,\n$$\n简化为\n$$\nk\\left(\\sum_{i=1}^N \\frac{g_i^2}{\\mu^2} + \\lambda\\right) = -\\sum_{i=1}^N \\frac{g_i q_i^f}{\\mu}.\n$$\n因此，\n$$\nk = -\\mu \\frac{\\sum_{i=1}^N g_i q_i^f}{\\sum_{i=1}^N g_i^2 + \\lambda \\mu^2}.\n$$\n这等价于一个岭回归，其预测变量为 $g_i/\\mu$，响应变量为 $q_i^f$。\n\n二维情况：\n对于 $d=2$，令 $\\mathbf{s} = [K_{11}, K_{12}, K_{21}, K_{22}]^\\top$ 收集 $\\mathbf{K}$ 的元素。模型\n$$\n\\mathbf{q}_i^f = -\\frac{1}{\\mu} \\mathbf{K} \\mathbf{g}_i\n$$\n导致每个样本有两个线性方程：\n$$\nq_{i,x}^f = -\\frac{1}{\\mu}\\left(K_{11} g_{i,x} + K_{12} g_{i,y}\\right), \\quad\nq_{i,y}^f = -\\frac{1}{\\mu}\\left(K_{21} g_{i,x} + K_{22} g_{i,y}\\right).\n$$\n将它们堆叠成一个系统 $\\mathbf{A} \\mathbf{s} \\approx \\mathbf{b}$，设计矩阵为\n$$\n\\mathbf{A}_i =\n\\begin{bmatrix}\n\\frac{g_{i,x}}{\\mu} & \\frac{g_{i,y}}{\\mu} & 0 & 0\\\\\n0 & 0 & \\frac{g_{i,x}}{\\mu} & \\frac{g_{i,y}}{\\mu}\n\\end{bmatrix}, \\quad\n\\mathbf{b}_i =\n\\begin{bmatrix}\n- q_{i,x}^f\\\\\n- q_{i,y}^f\n\\end{bmatrix},\n$$\n而 $\\mathbf{A}$ 和 $\\mathbf{b}$ 是通过在所有样本上堆叠 $\\mathbf{A}_i$ 和 $\\mathbf{b}_i$ 形成的。正则化目标函数包括 Tikhonov 和对称性惩罚：\n$$\n\\min_{\\mathbf{s}} \\|\\mathbf{A}\\mathbf{s} - \\mathbf{b}\\|_2^2 + \\lambda \\|\\mathbf{s}\\|_2^2 + \\gamma (K_{12} - K_{21})^2,\n$$\n其中 $\\lambda>0$ 和 $\\gamma>0$。对称性惩罚隔离了非对角线差异；它可以通过向系统增加一个额外的行来表示：\n$$\n\\sqrt{\\gamma}\\,[0,\\,1,\\,-1,\\,0]\\,\\mathbf{s} = 0.\n$$\n类似地，Tikhonov 惩罚可以通过增广 $\\sqrt{\\lambda}\\,\\mathbf{I}$ 和右侧的零来处理。增广系统变为\n$$\n\\min_{\\mathbf{s}} \\left\\|\\begin{bmatrix}\\mathbf{A}\\\\ \\sqrt{\\lambda}\\,\\mathbf{I}\\\\ \\sqrt{\\gamma}\\,\\mathbf{c}^\\top\\end{bmatrix}\\mathbf{s} - \\begin{bmatrix}\\mathbf{b}\\\\ \\mathbf{0}\\\\ 0\\end{bmatrix}\\right\\|_2^2,\\quad \\text{其中 } \\mathbf{c} = [0,\\,1,\\,-1,\\,0]^\\top,\n$$\n这可以通过最小二乘法求解（例如，使用奇异值分解解或正规方程）。获得 $\\mathbf{s}$ 后，通过用它们的平均值替换 $K_{12}$ 和 $K_{21}$ 来强制对称：\n$$\nK_{12} \\leftarrow \\frac{K_{12}+K_{21}}{2},\\quad K_{21}\\leftarrow K_{12}.\n$$\n最后，通过投影到 SPD 锥来确保渗透率张量是对称正定的。计算特征分解 $\\mathbf{K} = \\mathbf{V} \\mathbf{\\Lambda} \\mathbf{V}^\\top$，将特征值裁剪到不小于一个小的正阈值 $\\epsilon>0$：\n$$\n\\tilde{\\Lambda}_{jj} = \\max(\\Lambda_{jj}, \\epsilon),\n$$\n并重构 $\\mathbf{K} \\leftarrow \\mathbf{V} \\tilde{\\Lambda} \\mathbf{V}^\\top$。这保证了正定性。\n\n可辨识性考量：\n- 对于 $d=1$，可辨识性要求并非所有 $g_i$ 都为零；总和 $\\sum_i g_i^2$ 必须相对于噪声足够大，并且 Tikhonov 正则化 $\\lambda>0$ 在梯度较小时稳定了估计。\n- 对于 $d=2$，所有张量元素的可辨识性要求梯度方向 $\\mathbf{g}_i$ 跨越 $\\mathbb{R}^2$。如果所有梯度都共线或近乎共线，设计矩阵 $\\mathbf{A}$ 将变得秩亏，无法可靠地区分所有分量。对称性惩罚和 Tikhonov 正则化缓解了这个问题，而 SPD 投影则强制了物理合理性。然而，在严重病态的情况下，解将由正则化主导，反映了数据中信息的有限性。\n- 格拉姆矩阵 $\\mathbf{A}^\\top \\mathbf{A}$ 必须是良态的才能准确恢复；正则化有效地增加了 $\\lambda \\mathbf{I}$，改善了条件数。\n\n测试套件的算法设计：\n- 案例 1：生成 $N=51$ 个样本，其中 $t_i$ 在 $[0,10]$ 秒内均匀分布，压力梯度 $g_i = 1.0\\times 10^{5}(1+0.5\\sin t_i)$ Pa/m，真实值 $k_{\\text{true}} = 1.5\\times 10^{-15}\\ \\mathrm{m}^2$，通量 $q_i^f = -\\frac{k_{\\text{true}}}{\\mu} g_i$，添加标准差为 $\\sigma_q = 1.0\\times 10^{-8}\\ \\mathrm{m/s}$ 的高斯噪声，并使用带有 $\\lambda = 1.0\\times 10^{-20}$ 的闭式岭回归解来估计 $k$。\n- 案例 2：生成 $N=100$ 个跨越平面的梯度，通过使用在 $[0,2\\pi)$ 上分布的确定性角度 $\\theta_i$，其量值约为 $1.0\\times 10^{5}$ Pa/m，并带有轻微的各向异性缩放以避免病态对齐。使用 $\\mathbf{K}_{\\text{true}} = \\begin{bmatrix} 3.0\\times 10^{-15} & 0.5\\times 10^{-15} \\\\ 0.5\\times 10^{-15} & 1.0\\times 10^{-15}\\end{bmatrix}$ 计算通量，并添加标准差为 $\\sigma_q = 2.0\\times 10^{-8}\\ \\mathrm{m/s}$ 的高斯噪声。用 $\\lambda = 1.0\\times 10^{-20}$，$\\gamma = 1.0\\times 10^{-20}$ 求解增广最小二乘系统，然后用 $\\epsilon = 1.0\\times 10^{-18}$ 强制对称和 SPD。\n- 案例 3：生成 $N=50$ 个近乎共线且量值较小的梯度，中心在 $x$ 轴附近，$\\|\\mathbf{g}_i\\| \\approx 1.0\\times 10^{2}$ Pa/m。使用 $\\mathbf{K}_{\\text{true}} = 2.0\\times 10^{-15}\\,\\mathbf{I}$，添加标准差为 $\\sigma_q = 2.0\\times 10^{-8}\\ \\mathrm{m/s}$ 的高斯噪声，并用更强的正则化 $\\lambda = 1.0\\times 10^{-16}$ 和对称性惩罚 $\\gamma = 1.0\\times 10^{-12}$ 求解，然后用 $\\epsilon = 1.0\\times 10^{-18}$ 强制 SPD。由于激励不足，所得估计将由正则化主导，这说明了可辨识性的挑战。\n\n该程序实现了这些步骤，并以精确指定的格式打印单行：\n$$\n[\\text{k1},[\\text{K11\\_2},\\text{K12\\_2},\\text{K22\\_2}],[\\text{K11\\_3},\\text{K12\\_3},\\text{K22\\_3}]],\n$$\n每个数值条目的单位为 $\\mathrm{m}^2$，并以小数点后六位的科学记数法格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef estimate_scalar_k(g, q, mu, lam):\n    \"\"\"\n    Ridge regression estimate for scalar k in q = -(k/mu) * g.\n    \"\"\"\n    # Compute numerator and denominator for closed-form ridge solution.\n    num = np.sum(g * q)\n    den = np.sum(g * g) + lam * (mu ** 2)\n    # k = -mu * num / den\n    return float(-mu * num / den)\n\ndef estimate_tensor_K(gradients, fluxes, mu, lam, gamma, eps_spd):\n    \"\"\"\n    Estimate a 2x2 permeability tensor K from 2D gradients and fluxes\n    using Tikhonov regularization and a symmetry penalty, followed by SPD projection.\n    gradients: array of shape (N, 2)\n    fluxes: array of shape (N, 2)\n    Returns a symmetric positive-definite 2x2 numpy array K.\n    \"\"\"\n    N = gradients.shape[0]\n    # Build A and b for A s ≈ b, where s = [K11, K12, K21, K22]\n    A = np.zeros((2 * N, 4))\n    b = np.zeros(2 * N)\n    for i in range(N):\n        gx, gy = gradients[i]\n        qx, qy = fluxes[i]\n        row_x = 2 * i\n        row_y = 2 * i + 1\n        # qx = -(1/mu)*(K11*gx + K12*gy) => (gx/mu)*K11 + (gy/mu)*K12 = -qx\n        A[row_x, 0] = gx / mu\n        A[row_x, 1] = gy / mu\n        A[row_x, 2] = 0.0\n        A[row_x, 3] = 0.0\n        b[row_x] = -qx\n        # qy = -(1/mu)*(K21*gx + K22*gy) => (gx/mu)*K21 + (gy/mu)*K22 = -qy\n        A[row_y, 0] = 0.0\n        A[row_y, 1] = 0.0\n        A[row_y, 2] = gx / mu\n        A[row_y, 3] = gy / mu\n        b[row_y] = -qy\n\n    # Augment A and b for Tikhonov regularization: sqrt(lam) * I\n    A_tik = np.sqrt(lam) * np.eye(4)\n    b_tik = np.zeros(4)\n\n    # Symmetry penalty: sqrt(gamma) * [0, 1, -1, 0] s = 0\n    A_sym = np.sqrt(gamma) * np.array([[0.0, 1.0, -1.0, 0.0]])\n    b_sym = np.array([0.0])\n\n    # Stack augmented system\n    A_aug = np.vstack([A, A_tik, A_sym])\n    b_aug = np.concatenate([b, b_tik, b_sym])\n\n    # Solve least squares\n    s, *_ = np.linalg.lstsq(A_aug, b_aug, rcond=None)\n    K = np.array([[s[0], s[1]],\n                  [s[2], s[3]]], dtype=float)\n\n    # Enforce symmetry by averaging off-diagonal entries\n    K12 = 0.5 * (K[0, 1] + K[1, 0])\n    K[0, 1] = K12\n    K[1, 0] = K12\n\n    # Project to SPD: eigen-decomposition and eigenvalue clipping\n    # Ensure numerical symmetry before eig\n    K = 0.5 * (K + K.T)\n    eigvals, eigvecs = np.linalg.eigh(K)\n    eigvals_clipped = np.maximum(eigvals, eps_spd)\n    K_spd = (eigvecs @ np.diag(eigvals_clipped) @ eigvecs.T)\n\n    return K_spd\n\ndef format_float(f):\n    # Scientific notation with six digits after the decimal point, no spaces\n    return \"{:.6e}\".format(float(f))\n\ndef format_list_no_spaces(lst):\n    # Recursively format lists of floats into a string with no spaces\n    if isinstance(lst, (list, tuple, np.ndarray)):\n        inner = \",\".join(format_list_no_spaces(x) for x in lst)\n        return \"[\" + inner + \"]\"\n    else:\n        return format_float(lst)\n\ndef generate_case1():\n    # Case 1: 1D well-conditioned\n    mu = 1.0e-3  # Pa·s\n    k_true = 1.5e-15  # m^2\n    lam = 1.0e-20\n    # Time samples\n    t = np.linspace(0.0, 10.0, 51)\n    # Pressure gradient samples g_i [Pa/m]\n    g = 1.0e5 * (1.0 + 0.5 * np.sin(t))\n    # Flux q^f = -(k_true/mu) * g with noise [m/s]\n    rng = np.random.default_rng(42)\n    q = -(k_true / mu) * g + rng.normal(0.0, 1.0e-8, size=g.shape)\n    # Estimate k\n    k_est = estimate_scalar_k(g, q, mu, lam)\n    return k_est\n\ndef generate_case2():\n    # Case 2: 2D anisotropic, sufficiently excited\n    mu = 1.0e-3  # Pa·s\n    lam = 1.0e-20\n    gamma = 1.0e-20\n    eps_spd = 1.0e-18\n    K_true = np.array([[3.0e-15, 0.5e-15],\n                       [0.5e-15, 1.0e-15]], dtype=float)\n    N = 100\n    rng = np.random.default_rng(0)\n    # Generate gradients spanning the plane with slight anisotropy in magnitude\n    angles = np.linspace(0.0, 2.0 * np.pi, N, endpoint=False)\n    base_mag = 1.0e5\n    mags = base_mag * (1.0 + 0.1 * np.cos(3.0 * angles))\n    gx = mags * np.cos(angles)\n    gy = mags * np.sin(angles)\n    gradients = np.stack([gx, gy], axis=1)\n    # Flux generation with noise\n    fluxes_true = -(1.0 / mu) * (gradients @ K_true.T)\n    noise = rng.normal(0.0, 2.0e-8, size=fluxes_true.shape)\n    fluxes = fluxes_true + noise\n    # Estimate K\n    K_est = estimate_tensor_K(gradients, fluxes, mu, lam, gamma, eps_spd)\n    # Return [K11, K12, K22]\n    return [K_est[0, 0], K_est[0, 1], K_est[1, 1]]\n\ndef generate_case3():\n    # Case 3: 2D degenerate gradients, ill-conditioned\n    mu = 1.0e-3  # Pa·s\n    lam = 1.0e-16\n    gamma = 1.0e-12\n    eps_spd = 1.0e-18\n    K_true = np.array([[2.0e-15, 0.0],\n                       [0.0, 2.0e-15]], dtype=float)\n    N = 50\n    rng = np.random.default_rng(123)\n    # Generate nearly colinear gradients along x with small magnitude\n    base_mag = 1.0e2\n    angles = rng.normal(loc=0.0, scale=0.02, size=N)  # small deviations around 0 radians\n    mags = base_mag * (1.0 + 0.05 * rng.normal(size=N))\n    gx = mags * np.cos(angles)\n    gy = mags * np.sin(angles)\n    gradients = np.stack([gx, gy], axis=1)\n    # Flux generation with noise\n    fluxes_true = -(1.0 / mu) * (gradients @ K_true.T)\n    noise = rng.normal(0.0, 2.0e-8, size=fluxes_true.shape)\n    fluxes = fluxes_true + noise\n    # Estimate K with stronger regularization and symmetry penalty\n    K_est = estimate_tensor_K(gradients, fluxes, mu, lam, gamma, eps_spd)\n    # Return [K11, K12, K22]\n    return [K_est[0, 0], K_est[0, 1], K_est[1, 1]]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    k_case1 = generate_case1()\n    K_case2 = generate_case2()\n    K_case3 = generate_case3()\n\n    results = [k_case1, K_case2, K_case3]\n\n    # Final print statement in the exact required format: one single line, no spaces.\n    print(format_list_no_spaces(results))\n\nsolve()\n```"
        }
    ]
}