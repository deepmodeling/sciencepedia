{
    "hands_on_practices": [
        {
            "introduction": "Before tackling the complexities of inverse kinematics, it is essential to master the forward problem: computing an end-effector's pose from a given set of joint angles. This exercise provides hands-on practice in composing rigid-body rotations across a multi-joint upper-limb model, a foundational skill for both developing and validating kinematic simulations . By comparing the calculated orientation with hypothetical measured data, you will also apply a standard metric for quantifying model accuracy.",
            "id": "4181878",
            "problem": "A human upper-limb is modeled as a serial chain of rigid segments with ideal joints. The trunk (proximal) reference frame is defined according to the International Society of Biomechanics (ISB) convention: the $x$-axis points anteriorly, the $y$-axis points to the subject's left (laterally), and the $z$-axis points superiorly. The shoulder is modeled as a three-degree-of-freedom ball-and-socket joint parameterized by intrinsic yaw–pitch–roll (rotations about the current joint’s $z$-, then $y$-, then $x$-axes). The elbow provides flexion/extension modeled as a single-axis rotation about the forearm's local $y$-axis, and the wrist is neutral for the instant considered.\n\nAt a specific time instant, the joint angles are measured as follows (use radians):\n- Shoulder yaw $\\psi_{s} = \\pi/4$, shoulder pitch $\\theta_{s} = \\pi/4$, shoulder roll $\\phi_{s} = 0$.\n- Elbow flexion $\\theta_{e} = \\pi/2$ about the forearm’s local $y$-axis.\n- Wrist pronation–supination and flexion–extension are both $0$.\n\nAssume each joint rotation acts on the child segment's local frame and that the hand segment is aligned with the forearm.\n\n1. Using rigid-body rotation composition from the trunk frame through shoulder and elbow to the hand, compute the hand end-effector orientation matrix $R_{\\text{model}} \\in \\mathbb{R}^{3 \\times 3}$ with respect to the trunk frame.\n\n2. A motion-capture system reports the hand orientation (with respect to the same trunk frame) as the matrix\n$$\nR_{\\text{measured}} =\n\\begin{bmatrix}\n-0.5 & -0.609540151 & \\phantom{-}0.615191681 \\\\\n-0.5 & \\phantom{-}0.783188329 & \\phantom{-}0.369616073 \\\\\n-0.707106781 & -0.122787804 & -0.696364240\n\\end{bmatrix}.\n$$\n\nUsing the Frobenius norm consistency metric\n$$\n\\left\\| R_{\\text{model}}^{\\top} R_{\\text{measured}} - I \\right\\|_{F},\n$$\nwhere $I$ is the $3 \\times 3$ identity matrix, compute the numerical value of this metric. Round your final result to four significant figures. Express the final value as a dimensionless quantity (no units). The answer must be a single real number.",
            "solution": "The problem requires a two-part calculation. First, we compute the theoretical orientation matrix of the hand, $R_{\\text{model}}$, based on a kinematic model of the upper limb. Second, we quantify the discrepancy between this model and a given measured orientation, $R_{\\text{measured}}$, using the specified Frobenius norm metric.\n\n**Part 1: Computation of $R_{\\text{model}}$**\n\nThe orientation of the hand relative to the trunk is found by composing the rotations of the shoulder and elbow joints. The problem specifies an intrinsic yaw–pitch–roll ($z$-$y'$-$x''$) convention for the shoulder and a simple hinge rotation for the elbow.\n\nThe standard rotation matrices about the main axes are:\n$R_x(\\alpha) = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\cos\\alpha & -\\sin\\alpha \\\\ 0 & \\sin\\alpha & \\cos\\alpha \\end{pmatrix}$, $R_y(\\beta) = \\begin{pmatrix} \\cos\\beta & 0 & \\sin\\beta \\\\ 0 & 1 & 0 \\\\ -\\sin\\beta & 0 & \\cos\\beta \\end{pmatrix}$, $R_z(\\gamma) = \\begin{pmatrix} \\cos\\gamma & -\\sin\\gamma & 0 \\\\ \\sin\\gamma & \\cos\\gamma & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$.\n\nThe shoulder rotation is an intrinsic sequence of yaw ($\\psi_{s}$) about the $z$-axis, pitch ($\\theta_{s}$) about the new $y$-axis, and roll ($\\phi_{s}$) about the newest $x$-axis. This corresponds to the matrix product $R_{\\text{shoulder}} = R_z(\\psi_{s}) R_y(\\theta_{s}) R_x(\\phi_{s})$.\nWith shoulder angles $\\psi_{s} = \\pi/4$, $\\theta_{s} = \\pi/4$, and $\\phi_{s} = 0$, and noting $\\cos(\\pi/4) = \\sin(\\pi/4) = \\frac{1}{\\sqrt{2}}$:\n$$\nR_{\\text{shoulder}} = R_z(\\pi/4) R_y(\\pi/4) R_x(0) = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} & -\\frac{1}{\\sqrt{2}} & 0 \\\\ \\frac{1}{\\sqrt{2}} & \\frac{1}{\\sqrt{2}} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\sqrt{2}} & 0 & \\frac{1}{\\sqrt{2}} \\\\ 0 & 1 & 0 \\\\ -\\frac{1}{\\sqrt{2}} & 0 & \\frac{1}{\\sqrt{2}} \\end{pmatrix} I = \\begin{pmatrix} \\frac{1}{2} & -\\frac{1}{\\sqrt{2}} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{\\sqrt{2}} & \\frac{1}{2} \\\\ -\\frac{1}{\\sqrt{2}} & 0 & \\frac{1}{\\sqrt{2}} \\end{pmatrix}\n$$\nThe elbow joint provides flexion of $\\theta_{e} = \\pi/2$ about the local $y$-axis. The wrist is neutral, so the hand frame is aligned with the forearm frame.\n$$\nR_{\\text{elbow}} = R_y(\\theta_e) = R_y(\\pi/2) = \\begin{pmatrix} \\cos(\\pi/2) & 0 & \\sin(\\pi/2) \\\\ 0 & 1 & 0 \\\\ -\\sin(\\pi/2) & 0 & \\cos(\\pi/2) \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & 1 & 0 \\\\ -1 & 0 & 0 \\end{pmatrix}\n$$\nThe total orientation of the hand with respect to the trunk, $R_{\\text{model}}$, is the product of these matrices: $R_{\\text{model}} = R_{\\text{shoulder}} R_{\\text{elbow}}$.\n$$\nR_{\\text{model}} = \\begin{pmatrix} \\frac{1}{2} & -\\frac{1}{\\sqrt{2}} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{\\sqrt{2}} & \\frac{1}{2} \\\\ -\\frac{1}{\\sqrt{2}} & 0 & \\frac{1}{\\sqrt{2}} \\end{pmatrix} \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & 1 & 0 \\\\ -1 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2} & -\\frac{1}{\\sqrt{2}} & \\frac{1}{2} \\\\ -\\frac{1}{2} & \\frac{1}{\\sqrt{2}} & \\frac{1}{2} \\\\ -\\frac{1}{\\sqrt{2}} & 0 & -\\frac{1}{\\sqrt{2}} \\end{pmatrix}\n$$\n\n**Part 2: Computation of the Consistency Metric**\n\nThe consistency metric is $C = \\left\\| R_{\\text{model}}^{\\top} R_{\\text{measured}} - I \\right\\|_{F}$. Let $M = R_{\\text{model}}^{\\top} R_{\\text{measured}}$. The matrix $M$ represents the rotation error between the model and the measurement.\nBy inspection, the first column of $R_{\\text{measured}}$ is numerically identical to the first column of $R_{\\text{model}}$. Since both are rotation matrices, their columns are orthonormal. Therefore, the first column of $M$ will be $(1,0,0)^\\top$, and the first row will be $(1,0,0)$. This means $M$ is a rotation about the $x$-axis, i.e., $M=R_x(\\delta)$ for some small angle $\\delta$.\n\nThe calculation of $M$ using the provided $R_{\\text{measured}}$ confirms this structure, yielding $M \\approx R_x(\\pi/18)$, which is a rotation of $10^\\circ$. The error matrix is $E = M - I$.\n$$\nE = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\cos(\\pi/18) & -\\sin(\\pi/18) \\\\ 0 & \\sin(\\pi/18) & \\cos(\\pi/18) \\end{pmatrix} - I = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & \\cos(\\pi/18)-1 & -\\sin(\\pi/18) \\\\ 0 & \\sin(\\pi/18) & \\cos(\\pi/18)-1 \\end{pmatrix}\n$$\nThe Frobenius norm is $\\|E\\|_F = \\sqrt{\\sum_{i,j} |E_{ij}|^2}$.\n$$\n\\|E\\|_F^2 = 2\\left[ (\\cos(\\pi/18)-1)^2 + \\sin^2(\\pi/18) \\right]\n$$\n$$\n\\|E\\|_F^2 = 2\\left[ \\cos^2(\\pi/18) - 2\\cos(\\pi/18) + 1 + \\sin^2(\\pi/18) \\right] = 2\\left[ 2 - 2\\cos(\\pi/18) \\right] = 4(1 - \\cos(\\pi/18))\n$$\nThe metric is $C = \\|E\\|_F = 2\\sqrt{1 - \\cos(\\pi/18)}$.\nUsing $\\cos(\\pi/18) \\approx 0.984807753$:\n$$\nC = 2\\sqrt{1 - 0.984807753} = 2\\sqrt{0.015192247} \\approx 2(0.123256878) \\approx 0.246513756\n$$\nRounding to four significant figures, the result is $0.2465$.",
            "answer": "$$\\boxed{0.2465}$$"
        },
        {
            "introduction": "A central challenge in inverse kinematics is handling kinematic singularities, which are postures where the manipulator loses a degree of freedom and the standard Jacobian-based update can lead to excessively large joint motions. This practice explores this issue in the context of a planar arm and introduces Damped Least Squares (DLS), a powerful regularization technique that ensures stable and well-behaved solutions even near such configurations . You will directly compare the undamped and damped updates to appreciate the method's effectiveness in producing physically plausible joint movements.",
            "id": "4181916",
            "problem": "A planar two-degree-of-freedom human upper limb model has a shoulder joint at the origin and an elbow joint, with segment lengths $L_{1} = 0.3\\,\\text{m}$ and $L_{2} = 0.3\\,\\text{m}$. The end-effector (wrist) Cartesian position is described by standard forward kinematics in the plane with shoulder angle $\\theta_{1}$ and elbow angle $\\theta_{2}$: \n$$x(\\theta_{1},\\theta_{2}) = L_{1}\\cos\\theta_{1} + L_{2}\\cos(\\theta_{1}+\\theta_{2}), \\quad y(\\theta_{1},\\theta_{2}) = L_{1}\\sin\\theta_{1} + L_{2}\\sin(\\theta_{1}+\\theta_{2}).$$\nInverse Kinematics (IK) for small updates uses the first-order linearization \n$$\\Delta \\mathbf{p} \\approx J(\\theta_{1},\\theta_{2})\\,\\Delta \\mathbf{q},$$ \nwhere $J(\\theta_{1},\\theta_{2})$ is the $2\\times 2$ Jacobian of $(x,y)$ with respect to $\\mathbf{q} = [\\theta_{1},\\,\\theta_{2}]^{\\top}$ and $\\Delta \\mathbf{p}$ is the Cartesian task-space error. Consider the near-singular extended configuration $\\theta_{1} = 0$ and $\\theta_{2} = 0$, and a small desired end-effector correction \n$$\\mathbf{e} = \\begin{pmatrix} 0 \\\\ 0.01 \\end{pmatrix}\\,\\text{m}.$$\nConstruct the undamped IK update by posing the least-norm solution to the linearized consistency condition and derive the corresponding expression using the Moore–Penrose pseudoinverse. Next, construct a Damped Least Squares (DLS) IK update by posing a Tikhonov-regularized objective with a task-space damping factor $\\lambda = 0.3\\,\\text{m}$, and derive the corresponding expression for the damped pseudoinverse. Using these derived updates evaluated at the given configuration, compute the ratio $r$ of the Euclidean norms of the undamped joint update to the damped joint update,\n$$r \\;=\\; \\frac{\\|\\Delta \\mathbf{q}_{\\text{undamped}}\\|_{2}}{\\|\\Delta \\mathbf{q}_{\\text{damped}}\\|_{2}},$$\nand report the final value of $r$. Round your answer to four significant figures. The final answer is unitless and should be expressed as a single real number.",
            "solution": "This problem requires comparing the undamped and damped inverse kinematics updates for a planar 2-DOF arm near a singularity.\n\n**1. Jacobian Matrix**\nThe Jacobian matrix $J$ relates joint angle rates to end-effector velocity. It is found by taking partial derivatives of the forward kinematics equations:\n$$ J = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\theta_1} & \\frac{\\partial x}{\\partial \\theta_2} \\\\ \\frac{\\partial y}{\\partial \\theta_1} & \\frac{\\partial y}{\\partial \\theta_2} \\end{pmatrix} = \\begin{pmatrix} -L_1 \\sin\\theta_1 - L_2 \\sin(\\theta_1+\\theta_2) & -L_2 \\sin(\\theta_1+\\theta_2) \\\\ L_1 \\cos\\theta_1 + L_2 \\cos(\\theta_1+\\theta_2) & L_2 \\cos(\\theta_1+\\theta_2) \\end{pmatrix} $$\nAt the singular configuration $\\theta_1 = 0$, $\\theta_2 = 0$, and with $L_1 = L_2 = 0.3\\,\\text{m}$, the Jacobian is:\n$$ J = \\begin{pmatrix} 0 & 0 \\\\ 0.3+0.3 & 0.3 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0.6 & 0.3 \\end{pmatrix}\\,\\text{m} $$\nThe matrix is singular (determinant is 0), as expected for a fully extended arm.\n\n**2. Undamped IK Update**\nThe undamped least-norm update is $\\Delta \\mathbf{q}_{\\text{undamped}} = J^\\dagger \\mathbf{e}$, where $J^\\dagger$ is the Moore-Penrose pseudoinverse. For the computed singular Jacobian, the pseudoinverse is:\n$$ J^\\dagger = \\begin{pmatrix} 0 & 4/3 \\\\ 0 & 2/3 \\end{pmatrix}\\,\\text{m}^{-1} $$\nGiven the task-space error $\\mathbf{e} = [0, 0.01]^\\top\\,\\text{m}$, the joint update is:\n$$ \\Delta \\mathbf{q}_{\\text{undamped}} = \\begin{pmatrix} 0 & 4/3 \\\\ 0 & 2/3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0.01 \\end{pmatrix} = \\begin{pmatrix} 0.04/3 \\\\ 0.02/3 \\end{pmatrix}\\,\\text{rad} $$\nThe Euclidean norm of this update is:\n$$ \\|\\Delta \\mathbf{q}_{\\text{undamped}}\\|_{2} = \\sqrt{\\left(\\frac{0.04}{3}\\right)^2 + \\left(\\frac{0.02}{3}\\right)^2} = \\frac{\\sqrt{0.0016 + 0.0004}}{3} = \\frac{\\sqrt{0.002}}{3}\\,\\text{rad} $$\n\n**3. Damped Least Squares (DLS) IK Update**\nThe DLS update is given by $\\Delta \\mathbf{q}_{\\text{damped}} = J^T (J J^T + \\lambda^2 I)^{-1} \\mathbf{e}$. With damping factor $\\lambda = 0.3\\,\\text{m}$, we have $\\lambda^2 = 0.09\\,\\text{m}^2$.\nFirst, compute the required matrices:\n$$ JJ^T = \\begin{pmatrix} 0 & 0 \\\\ 0.6 & 0.3 \\end{pmatrix} \\begin{pmatrix} 0 & 0.6 \\\\ 0 & 0.3 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0.36 + 0.09 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0.45 \\end{pmatrix}\\,\\text{m}^2 $$\n$$ JJ^T + \\lambda^2 I = \\begin{pmatrix} 0.09 & 0 \\\\ 0 & 0.45+0.09 \\end{pmatrix} = \\begin{pmatrix} 0.09 & 0 \\\\ 0 & 0.54 \\end{pmatrix}\\,\\text{m}^2 $$\nThe damped update is:\n$$ \\Delta \\mathbf{q}_{\\text{damped}} = \\begin{pmatrix} 0 & 0.6 \\\\ 0 & 0.3 \\end{pmatrix} \\begin{pmatrix} 1/0.09 & 0 \\\\ 0 & 1/0.54 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0.01 \\end{pmatrix} $$\n$$ = \\begin{pmatrix} 0 & 0.6/0.54 \\\\ 0 & 0.3/0.54 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0.01 \\end{pmatrix} = \\begin{pmatrix} (10/9) \\times 0.01 \\\\ (5/9) \\times 0.01 \\end{pmatrix} = \\begin{pmatrix} 0.1/9 \\\\ 0.05/9 \\end{pmatrix}\\,\\text{rad} $$\nThe Euclidean norm of the damped update is:\n$$ \\|\\Delta \\mathbf{q}_{\\text{damped}}\\|_{2} = \\sqrt{\\left(\\frac{0.1}{9}\\right)^2 + \\left(\\frac{0.05}{9}\\right)^2} = \\frac{\\sqrt{0.01 + 0.0025}}{9} = \\frac{\\sqrt{0.0125}}{9}\\,\\text{rad} $$\n        \n**4. Ratio of Norms**\nFinally, we compute the ratio $r$:\n$$ r = \\frac{\\|\\Delta \\mathbf{q}_{\\text{undamped}}\\|_{2}}{\\|\\Delta \\mathbf{q}_{\\text{damped}}\\|_{2}} = \\frac{\\sqrt{0.002}/3}{\\sqrt{0.0125}/9} = 3 \\sqrt{\\frac{0.002}{0.0125}} = 3 \\sqrt{0.16} = 3(0.4) = 1.2 $$\nRounded to four significant figures, the ratio is $1.200$.",
            "answer": "$$\n\\boxed{1.200}\n$$"
        },
        {
            "introduction": "While methods like Damped Least Squares provide a numerical remedy for singularities, a deeper understanding requires analyzing their geometric origin. This exercise challenges you to derive the condition for a classic singularity—gimbal lock—from first principles for a 3-DOF shoulder model . By identifying the specific joint configuration that causes this issue, you will explore the fundamental limitations of Euler angle parameterizations and understand why alternative representations, such as quaternions or axis-angle, are often essential for robust motion analysis.",
            "id": "4181929",
            "problem": "Consider a simplified thoracohumeral model of the shoulder in which the glenohumeral joint is represented as a three Degrees of Freedom (DOF) ball-and-socket and the thoracohumeral orientation is parameterized by an intrinsic Euler angle sequence $Z$-$Y$-$X$, with angles $(\\psi, \\theta, \\phi)$ corresponding to heading (horizontal abduction/adduction) $\\psi$ about the superior-inferior axis of the thorax, elevation $\\theta$ about the lateral axis after the heading rotation, and axial rotation $\\phi$ about the long axis of the humerus after the elevation rotation. Let the thorax frame have axes $\\hat{\\boldsymbol{x}}$ anterior, $\\hat{\\boldsymbol{y}}$ to the subject's left, and $\\hat{\\boldsymbol{z}}$ superior. The orientation of the humerus relative to the thorax is\n$$\n\\boldsymbol{R}(\\psi,\\theta,\\phi) = \\boldsymbol{R}_{z}(\\psi)\\,\\boldsymbol{R}_{y}(\\theta)\\,\\boldsymbol{R}_{x}(\\phi),\n$$\nwhere $\\boldsymbol{R}_{z}$, $\\boldsymbol{R}_{y}$, and $\\boldsymbol{R}_{x}$ are the standard right-handed rotation matrices about the indicated axes. Assume physiologically plausible anatomical constraints\n$$\n\\theta \\in [0, 2\\pi/3], \\quad \\psi \\in [-\\pi/3, \\pi/3], \\quad \\phi \\in [-\\pi/2, \\pi/2].\n$$\nA posture is singular (gimbal-locked) when the instantaneous mapping from Euler angle rates $[\\dot{\\psi}, \\dot{\\theta}, \\dot{\\phi}]^{\\top}$ to angular velocity $\\boldsymbol{\\omega}$ loses rank. Starting from first principles of rigid body kinematics, use the definition of instantaneous angular velocity $\\boldsymbol{\\omega}$ via $\\dot{\\boldsymbol{R}} = \\boldsymbol{\\omega}^{\\wedge}\\boldsymbol{R}$ and the geometric meaning of the successive rotations to determine the condition under which the heading and axial rotation axes become collinear. Then, within the above anatomical range, compute the value of the elevation angle $\\theta$ in radians that produces this singular posture.\n\nAdditionally, the shoulder chain includes a scapulothoracic articulation that can be modeled as an additional, slower rotation $\\boldsymbol{S}$ that premultiplies $\\boldsymbol{R}$, i.e., the full chain orientation being $\\boldsymbol{S}\\boldsymbol{R}(\\psi,\\theta,\\phi)$. Explain whether this premultiplication affects the singularity condition derived for $\\theta$.\n\nFinally, identify a reparameterization that is locally nonsingular in a neighborhood of the singular posture you found and justify, from the definitions of the chosen parameters and their local Jacobian with respect to $\\boldsymbol{\\omega}$, why it circumvents the gimbal lock in that neighborhood. Your justification may be qualitative but must link directly to the local invertibility of the map to $\\boldsymbol{\\omega}$.\n\nCompute the requested elevation angle and express your final numerical answer in radians, rounded to four significant figures.",
            "solution": "The problem asks for an analysis of kinematic singularities in a simplified 3-DOF model of the shoulder joint, parameterized by a $Z$-$Y$-$X$ intrinsic Euler angle sequence $(\\psi, \\theta, \\phi)$.\n\nFirst, we must determine the condition for singularity. A kinematic singularity, or gimbal lock, occurs when the mapping from the rates of the configuration parameters to the instantaneous angular velocity loses rank. This means the Jacobian matrix of this transformation becomes singular.\n\nThe angular velocity vector $\\boldsymbol{\\omega}$ expressed in the thorax (space) frame is the sum of the angular velocity contributions from each rotation, expressed in that common frame:\n$$\n\\boldsymbol{\\omega} = \\dot{\\psi}\\hat{\\boldsymbol{z}} + \\dot{\\theta}\\hat{\\boldsymbol{y}}' + \\dot{\\phi}\\hat{\\boldsymbol{x}}''\n$$\nwhere $\\hat{\\boldsymbol{z}}$ is the axis of the first rotation, $\\hat{\\boldsymbol{y}}' = \\boldsymbol{R}_z(\\psi)\\hat{\\boldsymbol{y}}$ is the axis of the second rotation, and $\\hat{\\boldsymbol{x}}'' = \\boldsymbol{R}_z(\\psi)\\boldsymbol{R}_y(\\theta)\\hat{\\boldsymbol{x}}$ is the axis of the third rotation. Expressing these axes as column vectors:\n$\\hat{\\boldsymbol{u}}_{\\psi} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$\n$\\hat{\\boldsymbol{u}}_{\\theta} = \\boldsymbol{R}_z(\\psi)\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -\\sin\\psi \\\\ \\cos\\psi \\\\ 0 \\end{pmatrix}$\n$\\hat{\\boldsymbol{u}}_{\\phi} = \\boldsymbol{R}_z(\\psi)\\boldsymbol{R}_y(\\theta)\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\boldsymbol{R}_z(\\psi)\\begin{pmatrix} \\cos\\theta \\\\ 0 \\\\ -\\sin\\theta \\end{pmatrix} = \\begin{pmatrix} \\cos\\psi\\cos\\theta \\\\ \\sin\\psi\\cos\\theta \\\\ -\\sin\\theta \\end{pmatrix}$\n\nThe relationship is $\\boldsymbol{\\omega} = \\boldsymbol{J}\\begin{pmatrix} \\dot{\\psi} \\\\ \\dot{\\theta} \\\\ \\dot{\\phi} \\end{pmatrix}$, where $\\boldsymbol{J}$ is the Jacobian whose columns are the rotation axes:\n$$\n\\boldsymbol{J} = \\begin{bmatrix} \\hat{\\boldsymbol{u}}_{\\psi} & \\hat{\\boldsymbol{u}}_{\\theta} & \\hat{\\boldsymbol{u}}_{\\phi} \\end{bmatrix} = \\begin{pmatrix} 0 & -\\sin\\psi & \\cos\\psi\\cos\\theta \\\\ 0 & \\cos\\psi & \\sin\\psi\\cos\\theta \\\\ 1 & 0 & -\\sin\\theta \\end{pmatrix}\n$$\nA singularity occurs when $\\boldsymbol{J}$ is not invertible, i.e., when its determinant is zero.\n$$\n\\det(\\boldsymbol{J}) = 1 \\cdot \\det\\begin{pmatrix} -\\sin\\psi & \\cos\\psi\\cos\\theta \\\\ \\cos\\psi & \\sin\\psi\\cos\\theta \\end{pmatrix} = -(\\sin^2\\psi\\cos\\theta + \\cos^2\\psi\\cos\\theta) = -\\cos\\theta\n$$\nThe singularity condition $\\det(\\boldsymbol{J}) = 0$ simplifies to $\\cos\\theta = 0$. This is precisely the condition for which the first and third rotation axes, $\\hat{\\boldsymbol{u}}_{\\psi}$ and $\\hat{\\boldsymbol{u}}_{\\phi}$, become collinear.\n\nWithin the specified anatomical range $\\theta \\in [0, 2\\pi/3]$, the only solution to $\\cos\\theta = 0$ is $\\theta = \\pi/2$. At this posture, the arm is elevated by $90^\\circ$, causing the heading rotation axis (around $\\hat{\\boldsymbol{z}}$) and the axial rotation axis (the humerus long axis) to align, resulting in gimbal lock.\nThe numerical value is $\\theta = \\pi/2 \\approx 1.570796...$ radians. Rounded to four significant figures, this is $1.571$.\n\nSecond, we consider the effect of a premultiplying rotation $\\boldsymbol{S}$. The singularity is an intrinsic property of the $Z$-$Y$-$X$ Euler angle parameterization of the rotation $\\boldsymbol{R}$. It occurs when the Jacobian of the map from the parameter rates $(\\dot{\\psi}, \\dot{\\theta}, \\dot{\\phi})$ to the *relative* angular velocity of the humerus (with respect to the frame defined by $\\boldsymbol{S}$) loses rank. This condition depends only on the internal parameters of $\\boldsymbol{R}$, specifically $\\theta$. Therefore, the premultiplication by $\\boldsymbol{S}$ does not affect the singularity condition. The gimbal lock posture still occurs at $\\theta = \\pi/2$.\n\nFinally, we must identify a reparameterization that is locally nonsingular. A suitable choice is the axis-angle representation, also known as a rotation vector $\\boldsymbol{r} \\in \\mathbb{R}^3$. An orientation is described by a vector $\\boldsymbol{r} = \\alpha \\hat{\\boldsymbol{n}}$, where $\\hat{\\boldsymbol{n}}$ is a unit vector for the rotation axis and $\\alpha = \\|\\boldsymbol{r}\\|$ is the rotation angle. The mapping from $\\dot{\\boldsymbol{r}}$ to $\\boldsymbol{\\omega}$ is nonsingular everywhere except when the rotation angle $\\alpha$ is a multiple of $\\pi$. Our singular posture corresponds to a rotation of $\\theta = \\pi/2$ about an axis, so the total rotation angle is not a multiple of $\\pi$. Therefore, the axis-angle Jacobian is invertible at and near this posture, circumventing the gimbal lock problem. A unit quaternion representation is another common and globally nonsingular alternative.",
            "answer": "$$\n\\boxed{1.571}\n$$"
        }
    ]
}