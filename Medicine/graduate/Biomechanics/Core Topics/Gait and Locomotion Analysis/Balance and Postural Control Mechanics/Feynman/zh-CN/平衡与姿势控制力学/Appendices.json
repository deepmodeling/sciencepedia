{
    "hands_on_practices": [
        {
            "introduction": "静态平衡是姿势控制研究的起点。维持身体重心的地面投影（Center of Mass, COM）在支撑基础（Base of Support, BOS）之内，是保持静态平衡的必要条件。这个练习将静态平衡的概念从定性描述转化为定量计算，通过一个简化的足部放置场景，您将练习如何确定BOS的边界，并计算在特定方向上将COM移动到失稳边缘所需的最小位移，即稳定裕度（margin of stability）。这项技能对于评估姿势稳定性以及理解跌倒风险至关重要。",
            "id": "4156507",
            "problem": "一个人双脚接触水平地面安静站立，其支撑基底（BOS）可近似为水平面内的一个凸多边形。设水平坐标系定义为：横向（内外侧）轴为 $x$ 轴，前后向轴为 $y$ 轴。支撑基底多边形的顶点按逆时针顺序由以下坐标给出\n$$\n(x_1,y_1)=(-0.12,\\,0.10),\\quad (x_2,y_2)=(0.12,\\,0.10),\\quad (x_3,y_3)=(0.16,\\,-0.05),\n$$\n$$\n(x_4,y_4)=(0.10,\\,-0.20),\\quad (x_5,y_5)=(-0.10,\\,-0.20),\\quad (x_6,y_6)=(-0.16,\\,-0.05).\n$$\n全身质心（COM）在地面上的垂直投影位于 $(x_c,y_c)=(0.03,\\,-0.04)$。假设在准静态条件下，维持静力平衡要求质心投影位于支撑基底内部。\n\n仅从基本力学（静力平衡的牛顿定律）和几何推理出发，确定质心投影到达支撑基底边界所需的最小横向质心位移（即 $y$ 坐标保持在 $y_c$ 不变，仅沿 $x$ 轴的纯平移）。将“最小横向质心位移”解释为使点 $(x,\\,y_c)$ 位于多边形边界上的 $|x-x_c|$ 的最小非负值。使用给定的多边形和质心坐标计算该最小位移。\n\n用文字讨论您计算出的值对于受试者在给定的前后位置上的横向平衡裕度的意义，但最终答案只提供最小横向位移的数值。最终结果以米为单位表示，并四舍五入到四位有效数字。",
            "solution": "首先验证该问题，以确保其具有科学依据、提法恰当且客观。\n\n**步骤1：提取已知条件**\n- 坐标系定义为：横向轴为 $x$ 轴，前后向轴为 $y$ 轴。\n- 支撑基底（BOS）是一个凸多边形，其顶点坐标（单位：米）如下：\n  $P_1 = (x_1, y_1) = (-0.12, 0.10)$\n  $P_2 = (x_2, y_2) = (0.12, 0.10)$\n  $P_3 = (x_3, y_3) = (0.16, -0.05)$\n  $P_4 = (x_4, y_4) = (0.10, -0.20)$\n  $P_5 = (x_5, y_5) = (-0.10, -0.20)$\n  $P_6 = (x_6, y_6) = (-0.16, -0.05)$\n- 全身质心（COM）的垂直投影位于 $(x_c, y_c) = (0.03, -0.04)$。\n- 静力平衡的条件是质心投影必须位于支撑基底内部。\n- 任务是求最小横向质心位移，定义为使点 $(x, y_c)$ 位于支撑基底多边形边界上的 $|x-x_c|$ 的最小非负值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于静力平衡和生物力学的基本原理，其中质心投影与支撑基底之间的关系决定了姿势的稳定性。所提供的数据对于人体安静站立是符合实际的。该问题提法恰当，提供了所有必要的几何信息（多边形顶点、一个点、一条指定的运动线），足以确定唯一解。语言客观且精确。因此，该问题被认定为**有效**。\n\n**步骤3：进行求解**\n\n问题的核心是确定在质心投影所在特定前后水平上，支撑基底的边界。质心将进行纯粹的横向移动，这意味着其投影沿着由 $y = y_c = -0.04$ 定义的水平线移动。为了求得到达边界的最小位移，我们必须找到这条线与支撑基底多边形各边的交点。\n\n支撑基底的边界是由六个顶点定义的多边形。连接顶点 $(x_i, y_i)$ 和 $(x_j, y_j)$ 的多边形边只有在 $y_c$ 位于 $y_i$ 和 $y_j$ 之间时，即 $\\min(y_i, y_j) \\le y_c \\le \\max(y_i, y_j)$，才会与直线 $y = y_c$ 相交。我们检查各顶点的 $y$ 坐标：$y_1=0.10$, $y_2=0.10$, $y_3=-0.05$, $y_4=-0.20$, $y_5=-0.20$, $y_6=-0.05$。值 $y_c = -0.04$ 位于以下区间内：\n- 介于 $y_2=0.10$ 和 $y_3=-0.05$ 之间。因此，直线 $y=-0.04$ 与边 $P_2P_3$ 相交。\n- 介于 $y_1=0.10$ 和 $y_6=-0.05$ 之间。因此，直线 $y=-0.04$ 与边 $P_6P_1$ 相交。\n\n现在我们计算这两个交点的 $x$ 坐标。连接 $(x_a, y_a)$ 和 $(x_b, y_b)$ 的线段方程可以重新整理，以便在给定 $y$ 值的情况下求解 $x$：\n$$x = x_a + (y - y_a) \\frac{x_b - x_a}{y_b - y_a}$$\n\n首先，我们求与右侧边界边 $P_2P_3$ 的交点。设该交点的 $x$ 坐标为 $x_R$。使用公式，其中 $(x_a, y_a) = P_2 = (0.12, 0.10)$ 和 $(x_b, y_b) = P_3 = (0.16, -0.05)$，以及 $y=y_c=-0.04$：\n$$x_R = 0.12 + (-0.04 - 0.10) \\frac{0.16 - 0.12}{-0.05 - 0.10}$$\n$$x_R = 0.12 + (-0.14) \\frac{0.04}{-0.15}$$\n$$x_R = 0.12 + \\frac{0.0056}{0.15} = 0.12 + \\frac{56}{1500} = \\frac{12}{100} + \\frac{56}{1500} = \\frac{180}{1500} + \\frac{56}{1500} = \\frac{236}{1500} = \\frac{59}{375}$$\n在此水平上，右边界的 $x$ 坐标为 $x_R = \\frac{59}{375}$ 米。\n\n接下来，我们求与左侧边界边 $P_6P_1$ 的交点。设该交点的 $x$ 坐标为 $x_L$。使用 $(x_a, y_a) = P_6 = (-0.16, -0.05)$ 和 $(x_b, y_b) = P_1 = (-0.12, 0.10)$：\n$$x_L = -0.16 + (-0.04 - (-0.05)) \\frac{-0.12 - (-0.16)}{0.10 - (-0.05)}$$\n$$x_L = -0.16 + (0.01) \\frac{0.04}{0.15}$$\n$$x_L = -0.16 + \\frac{0.0004}{0.15} = -0.16 + \\frac{4}{1500} = -\\frac{16}{100} + \\frac{4}{1500} = -\\frac{240}{1500} + \\frac{4}{1500} = -\\frac{236}{1500} = -\\frac{59}{375}$$\n左边界的 $x$ 坐标为 $x_L = -\\frac{59}{375}$ 米。（注意：支撑基底多边形关于 $y$ 轴对称，其中 $P_1$ 与 $P_2$ 对称，$P_6$ 与 $P_3$ 对称，依此类推，这意味着 $x_L = -x_R$，我们的计算证实了这一点。）\n\n质心投影的初始横向位置是 $x_c = 0.03$。问题要求的是到达边界所需的最小位移。这意味着需要找到两个可能的位移大小中较小的一个：一个是到右边界的位移，另一个是到左边界的位移。\n到达右边界所需的位移是距离 $|x_R - x_c|$：\n$$\\left| \\frac{59}{375} - 0.03 \\right| = \\left| \\frac{59}{375} - \\frac{3}{100} \\right| = \\left| \\frac{236}{1500} - \\frac{45}{1500} \\right| = \\frac{191}{1500}$$\n到达左边界所需的位移是距离 $|x_L - x_c|$：\n$$\\left| -\\frac{59}{375} - 0.03 \\right| = \\left| -\\frac{236}{1500} - \\frac{45}{1500} \\right| = \\left| -\\frac{281}{1500} \\right| = \\frac{281}{1500}$$\n\n我们比较这两个可能的位移：\n向右移动：$\\frac{191}{1500} \\approx 0.127333...$ 米。\n向左移动：$\\frac{281}{1500} \\approx 0.187333...$ 米。\n\n这两个值中的最小值是 $\\frac{191}{1500}$ 米。\n将此结果四舍五入到四位有效数字，得到 $0.1273$ 米。\n\n该结果的解释与稳定裕度（margin of stability）的概念有关。这个裕度是指质心在特定方向上可以移动的最大距离，超过这个距离质心就会移出支撑基底，从而导致失去平衡。在本例中，受试者的质心投影位于 $(0.03, -0.04)$，该位置偏离支撑基底中心线（$y$ 轴）向右。因此，向右（$x$ 轴正方向）摇摆的稳定裕度（$0.1273$ 米）要小于向左（$x$ 轴负方向）摇摆的稳定裕度（$0.1873$ 米）。计算出的值 $0.1273$ 米代表了受试者在其质心初始位移方向上的横向平衡裕度。较小的裕度表明，受试者更容易因该方向上的扰动而失去平衡。",
            "answer": "$$\n\\boxed{0.1273}\n$$"
        },
        {
            "introduction": "当人体准备进行自主运动（如向前伸手）时，神经系统会预先产生一个姿势调整，以抵消即将到来的内部扰动，这就是预期性姿势调整（Anticipatory Postural Adjustments, APAs）。这个练习将带您从静态平衡进入动态控制的领域，您将应用逆动力学的基本原理——这是生物力学中的一个核心分析工具——来推导当手持不同负载时，APA的幅度（以压力中心COP的位移来衡量）如何变化。通过这个推导，您将深刻理解姿势控制系统的预测性及其对任务变化的适应能力。",
            "id": "4156467",
            "problem": "一名受试者静静地站在水平地面上，手持一个小的外部负载，在矢状面内开始向前伸手。将身体建模为以踝关节为枢轴的单连杆倒立摆，并作如下简化和定义：\n\n- 下躯干和腿部（不包括手臂-手-负载系统）的质量为 $m$。\n- 手臂-手系统（不含外部负载）被集总为一个点质量 $m_{u}$，位于踝关节上方固定的垂直高度 $z_{u}$ 处。\n- 抓住一个质量为 $L$ 的外部负载，使得手臂-手-负载系统的集总质量为 $(m_{u}+L)$，位于同样的高度 $z_{u}$ 处。\n- 在预期性姿势调整（APA）开始时，控制器对 手臂-手-负载 系统的质心产生一个预定的向前水平加速度 $a_{0}$。APA 定义为压力中心（COP）相对于静站姿势向后额外移动一段距离 $s$，从而使得在APA开始时，整个身体绕踝关节的净角加速度为零。\n- 假设摇摆角很小，垂直加速度可忽略不计，并且在APA期间地面反作用力的大小等于总重量 $W=(m+m_{u}+L)g$，其中 $g$ 是重力加速度。预先存在的重力力矩（在静站时存在）已被基线COP位置所平衡，对增量APA没有贡献。\n\n使用牛顿定律和逆动力学（即，对踝关节的力矩求和以强制APA开始时的净角加速度为零），推导APA幅度如何随手持附加质量而变化。令 $s(0)$ 表示当 $L=0$ 时的APA幅度，令 $s(L)$ 表示有附加负载 $L$ 时的APA幅度。计算无量纲比例因子\n$$k(L)=\\frac{s(L)}{s(0)}$$\n的精确闭式解析表达式，用 $m$、$m_{u}$、$z_{u}$、$a_{0}$、$g$ 和 $L$ 表示。将最终答案表示为单个闭式表达式。不需要数值计算，也不需要单位，因为 $k(L)$ 是无量纲的。不要提供近似值；请提供精确表达式。",
            "solution": "用户请求解决一个生物力学问题。我将首先验证问题陈述，如果有效，则提供完整的解决方案。\n\n## 问题验证\n\n### 步骤1：提取给定条件\n问题提供了以下信息：\n- **模型**：身体是以踝关节为枢轴的单连杆倒立摆。\n- **质量**：\n    - 下躯干和腿部的质量为 $m$。\n    - 手臂-手系统的有效点质量为 $m_{u}$。\n    - 外部负载的质量为 $L$。\n- **几何**：\n    - 质量 $m_{u}$ 位于踝关节上方固定的垂直高度 $z_{u}$ 处。\n    - 组合质量 $(m_{u}+L)$ 也位于高度 $z_{u}$ 处。\n- **动力学**：\n    - 在预期性姿势调整（APA）开始时，手臂-手-负载系统的质心经历一个预定的向前水平加速度 $a_0$。\n    - APA是压力中心（COP）相对于静站姿势向后移动的距离 $s$。\n    - 在APA开始时，绕踝关节的净全身角加速度为零。\n- **假设**：\n    - 摇摆角很小。\n    - 垂直加速度可忽略不计。\n    - 地面反作用力的大小等于总重量 $W=(m+m_{u}+L)g$。\n    - 来自静站的预先存在的重力力矩是平衡的，并且对增量APA动力学没有贡献。\n- **目标**：\n    - 令 $s(0)$ 为 $L=0$ 时的APA幅度。\n    - 令 $s(L)$ 为负载为 $L$ 时的APA幅度。\n    - 计算无量纲比例因子 $k(L)=\\frac{s(L)}{s(0)}$ 的闭式表达式，用 $m$、$m_{u}$、$z_{u}$、$a_{0}$、$g$ 和 $L$ 表示。\n\n### 步骤2：使用提取的给定条件进行验证\n该问题在科学上基于生物力学和经典力学的原理，特别是使用倒立摆模型进行姿势控制和预期性姿势调整的概念。使用牛顿定律（或以逆动力学形式出现的达朗贝尔原理）是标准的做法。\n该问题是适定的。它提供了足够的变量和一个明确的条件（净角加速度为零），以建立一个可解的方程。\n语言客观而精确。\n\n有一个潜在的模糊点：“零净全身角加速度”。如果身体是一个单一的刚性连杆，零角加速度将意味着所有点的线性加速度都为零，这与给定的手臂以 $a_0$ 加速相矛盾。然而，该问题区分了两个质量分量，$m$ 和 $(m_{u}+L)$，后者具有预定的加速度。这意味着这是一个多体系统。在这种情况下，“零净全身角加速度”最好被解释为APA的目标：产生一个姿势力矩，以精确抵消手臂运动产生的扰动力矩，从而使主要的姿势连杆（躯干和腿部，质量为 $m$）不经历角加速度。这种解释在物理上是有意义的，与APA的目的相符，并使问题可解。这是该研究领域中常见的简化方法。\n\n基于此分析，该问题被认为是有效的。\n\n### 步骤3：结论和行动\n该问题是 **有效的**。我将继续进行解答。\n\n## 解答\n\n正如问题陈述所建议的，该解答是使用逆动力学原理推导出来的。我们将对作为倒立摆枢轴的踝关节的力矩求和。一个质点系绕固定点（踝关节，记为A）的转动运动方程为 $\\sum \\vec{\\tau}_{\\text{ext,A}} = \\frac{d\\vec{H}_{\\text{A}}}{dt}$，其中 $\\sum \\vec{\\tau}_{\\text{ext,A}}$ 是外力矩的总和，$\\frac{d\\vec{H}_{\\text{A}}}{dt}$ 是系统绕A点的角动量变化率。\n\n让我们建立一个坐标系，其中踝关节位于原点 $(0, 0)$，x轴为水平方向（向前），y轴为垂直方向（向上）。所有力矩都将绕z轴（垂直于矢状面）计算。\n\n角动量的变化率由 $\\frac{d\\vec{H}_{\\text{A}}}{dt} = \\sum_i \\vec{r}_i \\times (m_i \\vec{a}_i)$ 给出，其中求和遍及系统的所有质点。我们需要考虑两个集总质量：\n1. 躯干和腿部，质量为 $m$。\n2. 手臂-手-负载系统，质量为 $(m_u+L)$。\n\n问题陈述要求强制执行“APA开始时净全身角加速度为零”。如前验证，我们将其解释为主要姿势连杆（质量为 $m$）的角加速度为零。由于系统从静止开始，这意味着质量 $m$ 的线性加速度也为零，$\\vec{a}_m = 0$。\n\n手臂-手-负载系统位于垂直高度 $z_u$ 处，因此在运动开始时（当身体仍然直立时）其位置矢量为 $\\vec{r}_{u+L} = (0, z_u)$。它被赋予一个水平加速度 $\\vec{a}_{u+L} = (a_0, 0)$。该质量对角动量变化率的贡献是：\n$$ \\left( \\frac{d\\vec{H}_{\\text{A}}}{dt} \\right)_{u+L} = \\vec{r}_{u+L} \\times ((m_u+L)\\vec{a}_{u+L}) = (0, z_u, 0) \\times ((m_u+L)a_0, 0, 0) $$\n所得矢量纯粹在z方向上：\n$$ \\left( \\frac{d\\vec{H}_{\\text{A}}}{dt} \\right)_{z} = -z_u (m_u+L) a_0 $$\n由于 $\\vec{a}_m=0$，系统的总角动量变化率仅由这一项给出。\n\n现在，我们计算绕踝关节的外力矩总和。外力是重力和地面反作用力（GRF）。\n- 总重量为 $W = (m+m_u+L)g$。预先存在的重力力矩被平衡的假设意味着，在静站姿势中，总质心（COM）垂直投影到静站压力中心（COP）上。APA涉及COP向后*额外*移动一段距离 $s$。我们分析由APA产生的增量力矩。\n- 由于垂直加速度可忽略不计，GRF的垂直分量大小为 $F_y = W$。该力作用于COP。APA将COP向后移动 $s$，因此其相对于静站COP的新位置为 $x_{\\text{COP}} = -s$。为简单起见，假设踝关节是坐标系的参考点，并与静站COP重合（这是一个不影响增量分析的常用惯例），则来自垂直GRF的力矩为：\n$$ \\vec{\\tau}_{\\text{GRF}} = \\vec{r}_{\\text{COP}} \\times \\vec{F}_{\\text{GRF}} = (-s, 0, 0) \\times (F_x, W, 0) $$\n其中 $F_x$ 是水平GRF。来自垂直分量的力矩为：\n$$ \\tau_z = -sW = -s(m+m_u+L)g $$\n来自水平GRF $F_x$ 绕踝关节的力矩为零，因为其力臂为零。\n- 在运动开始时，增量重力力矩为零，因为COM尚未水平位移。\n\n将净外力矩与角动量变化率相等：\n$$ \\sum \\tau_{\\text{ext,A},z} = \\frac{dH_{\\text{A},z}}{dt} $$\n$$ -s(m+m_u+L)g = -z_u(m_u+L)a_0 $$\n求解作为负载 $L$ 函数的APA幅度 $s$，我们将其表示为 $s(L)$：\n$$ s(L) = \\frac{z_u a_0 (m_u+L)}{g(m+m_u+L)} $$\n该表达式给出了所需的COP向后移动量，以抵消由手臂加速产生的前倾力矩，从而保持躯干静止。\n\n为了找到比例因子 $k(L)$，我们首先需要无负载情况下的APA幅度 $s(0)$。我们通过在 $s(L)$ 的表达式中设置 $L=0$ 来获得此值：\n$$ s(0) = \\frac{z_u a_0 (m_u+0)}{g(m+m_u+0)} = \\frac{z_u a_0 m_u}{g(m+m_u)} $$\n无量纲比例因子 $k(L)$ 是比率 $\\frac{s(L)}{s(0)}$：\n$$ k(L) = \\frac{s(L)}{s(0)} = \\frac{\\frac{z_u a_0 (m_u+L)}{g(m+m_u+L)}}{\\frac{z_u a_0 m_u}{g(m+m_u)}} $$\n项 $\\frac{z_u a_0}{g}$ 被消掉了：\n$$ k(L) = \\frac{m_u+L}{m+m_u+L} \\cdot \\frac{m+m_u}{m_u} $$\n这可以写成一个单独的分数：\n$$ k(L) = \\frac{(m+m_u)(m_u+L)}{m_u(m+m_u+L)} $$\n这就是比例因子的最终、精确的闭式解析表达式。",
            "answer": "$$ \\boxed{ \\frac{(m+m_u)(m_u+L)}{m_u(m+m_u+L)} } $$"
        },
        {
            "introduction": "在理解了APA的基本力学原理后，我们可以进一步探索如何“设计”一个最优的APA。现代生物力学研究常将姿势控制问题构建为最优控制问题，这个实践练习要求您编写程序，通过求解一个考虑了姿势偏差和控制努力的二次代价函数，来计算最优的APA踝关节力矩。此练习不仅能巩固您对倒立摆模型的动力学理解，还能让您掌握如何将理论力学与计算方法相结合，解决接近实际生理约束（如关节力矩限制）的复杂控制问题。",
            "id": "4156466",
            "problem": "您的任务是设计并实现一个程序，该程序使用关于质心位移和控制努力的二次成本函数，在关节力矩限制下，计算最优的预期性姿势调整 (APA) 踝关节力矩，以最小化质心 (COM) 偏差。目标受众是生物力学领域的高阶研究生，专注于平衡与姿势控制力学。\n\n使用关于踝关节的静立矢状面倒立摆模型。身体被建模为位于踝关节上方恒定高度的一个点质量。需要以下基本假设和定律：\n- 牛顿第二定律：$F = m a$，及其旋转形式 $I \\alpha = \\tau$。\n- 关于直立姿势的小角度线性化：质心水平位移 $x$ 和踝关节角度 $\\theta$ 满足 $x = l \\theta$，其中 $\\theta$ 以弧度为单位。\n- 对于高度为 $l$ 的点质量，其绕踝关节的转动惯量为 $I = m l^2$。\n- 重力加速度为 $g = 9.81 \\ \\mathrm{m/s^2}$。\n\n在这些假设下，质心水平位移 $x(t)$ 服从以下线性常微分方程\n$$\nx''(t) = \\frac{g}{l} x(t) + \\frac{1}{m l} u(t),\n$$\n其中 $m$ 是质量（单位为 $\\mathrm{kg}$），$l$ 是质心高度（单位为 $\\mathrm{m}$），$u(t)$ 是产生APA的矢状面踝关节力矩（单位为 $\\mathrm{N \\cdot m}$）。一个即将发生的外部扰动（例如，一次推力）被建模为在时间 $t=0$ 时的初始质心速度 $v_0$。初始质心位置为 $x(0) = 0$，且 $x'(0) = v_0$。\n\nAPA是在有限时间窗口 $[0, T]$（其中 $T \\le H$）内施加的恒定力矩 $u$，在此之后，对于 $t \\in (T, H]$，$u(t) = 0$。时域 $H$ 是评估质心偏差的时间。对称踝关节力矩限制为 $|u| \\le u_{\\max}$。\n\n定义性能成本为\n$$\nJ(u) = \\alpha \\, \\big(x(H)\\big)^2 + \\beta \\, u^2,\n$$\n其中 $\\alpha > 0$ 和 $\\beta > 0$ 分别是质心位移和控制努力的权重。\n\n您的任务：\n1. 仅从上述基本模型和定律出发，推导 $x(H)$ 作为恒定APA力矩 $u$、初始速度 $v_0$ 以及参数 $m, l, g, T, H$ 的函数表达式。除给定的基本原理外，不要假定任何简便公式。\n2. 建立标量优化问题 $\\min_{u} J(u)$，其约束条件为 $|u| \\le u_{\\max}$，并推导出在该边界下最小化 $J(u)$ 的闭式最优解 $u$。\n3. 实现一个程序，为下面的每个测试用例计算最优APA踝关节力矩 $u_{\\mathrm{opt}}$（单位为 $\\mathrm{N \\cdot m}$），并四舍五入到六位小数。负值表示力矩方向与正 $x$ 方向的运动相反，这与右手矢状面约定一致。当引用角度时，必须以弧度处理。\n\n使用 $g = 9.81 \\ \\mathrm{m/s^2}$ 和标准国际单位制 (SI)。最终程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $[u_1,u_2,\\dots]$，每个 $u_i$ 都是一个四舍五入到六位小数并以 $\\mathrm{N \\cdot m}$ 表示的浮点数。\n\n测试套件：\n- 用例 1 (典型人体，非零扰动，低控制努力惩罚): $m = 75.0 \\ \\mathrm{kg}$, $l = 1.0 \\ \\mathrm{m}$, $v_0 = 0.2 \\ \\mathrm{m/s}$, $T = 0.15 \\ \\mathrm{s}$, $H = 0.8 \\ \\mathrm{s}$, $\\alpha = 1.0$, $\\beta = 10^{-6}$, $u_{\\max} = 120.0 \\ \\mathrm{N \\cdot m}$。\n- 用例 2 (无扰动): $m = 75.0 \\ \\mathrm{kg}$, $l = 1.0 \\ \\mathrm{m}$, $v_0 = 0.0 \\ \\mathrm{m/s}$, $T = 0.15 \\ \\mathrm{s}$, $H = 0.8 \\ \\mathrm{s}$, $\\alpha = 1.0$, $\\beta = 10^{-6}$, $u_{\\max} = 120.0 \\ \\mathrm{N \\cdot m}$。\n- 用例 3 (导致饱和的大扰动): $m = 75.0 \\ \\mathrm{kg}$, $l = 1.0 \\ \\mathrm{m}$, $v_0 = 0.6 \\ \\mathrm{m/s}$, $T = 0.15 \\ \\mathrm{s}$, $H = 0.8 \\ \\mathrm{s}$, $\\alpha = 1.0$, $\\beta = 10^{-6}$, $u_{\\max} = 120.0 \\ \\mathrm{N \\cdot m}$。\n- 用例 4 (无APA窗口): $m = 75.0 \\ \\mathrm{kg}$, $l = 1.0 \\ \\mathrm{m}$, $v_0 = 0.2 \\ \\mathrm{m/s}$, $T = 0.0 \\ \\mathrm{s}$, $H = 0.8 \\ \\mathrm{s}$, $\\alpha = 1.0$, $\\beta = 10^{-6}$, $u_{\\max} = 120.0 \\ \\mathrm{N \\cdot m}$。\n- 用例 5 (APA施加于整个时域): $m = 75.0 \\ \\mathrm{kg}$, $l = 1.0 \\ \\mathrm{m}$, $v_0 = 0.2 \\ \\mathrm{m/s}$, $T = 0.8 \\ \\mathrm{s}$, $H = 0.8 \\ \\mathrm{s}$, $\\alpha = 1.0$, $\\beta = 10^{-6}$, $u_{\\max} = 120.0 \\ \\mathrm{N \\cdot m}$。\n- 用例 6 (不同的人体测量学参数和权重): $m = 65.0 \\ \\mathrm{kg}$, $l = 0.9 \\ \\mathrm{m}$, $v_0 = -0.2 \\ \\mathrm{m/s}$, $T = 0.1 \\ \\mathrm{s}$, $H = 0.6 \\ \\mathrm{s}$, $\\alpha = 0.8$, $\\beta = 10^{-3}$, $u_{\\max} = 100.0 \\ \\mathrm{N \\cdot m}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其顺序与测试用例相同，每个值都以 $\\mathrm{N \\cdot m}$ 为单位并四舍五入到六位小数。",
            "solution": "该问题要求确定一个最优的恒定预期性姿势调整 (APA) 踝关节力矩 $u$，该力矩能最小化一个二次成本函数，此函数涉及在未来时间 $H$ 的质心 (COM) 偏差与控制努力之间的权衡。分析基于人体站姿的线性化倒立摆模型。\n\n这个问题是有效的，因为它在科学上基于已建立的生物力学建模原理，在数学上是适定的，并且为获得唯一解提供了所有必要的参数和条件。\n\n推导和求解过程分两个主要阶段进行：首先，求解系统动力学，以将最终质心位置 $x(H)$ 表示为控制输入 $u$ 的函数；其次，解决约束优化问题，以找到最优力矩 $u_{\\mathrm{opt}}$。\n\n**1. 时域末端状态 $x(H)$ 的推导**\n\n质心水平位移 $x(t)$ 的动力学由以下二阶线性常微分方程 (ODE) 决定：\n$$\nx''(t) = \\frac{g}{l} x(t) + \\frac{1}{m l} u(t)\n$$\n让我们定义 $\\omega^2 = g/l$。方程变为：\n$$\nx''(t) - \\omega^2 x(t) = \\frac{u(t)}{ml}\n$$\n控制力矩 $u(t)$ 是一个分段常数函数：\n$$\nu(t) = \\begin{cases} u  \\text{for } t \\in [0, T] \\\\ 0  \\text{for } t \\in (T, H] \\end{cases}\n$$\n我们在两个区间上求解该ODE。\n\n**区间 1: $t \\in [0, T]$**\n该ODE为 $x''(t) - \\omega^2 x(t) = \\frac{u}{ml}$，初始条件为 $x(0) = 0$ 和 $x'(0) = v_0$。\n通解是齐次解 $x_h(t)$ 和一个特解 $x_p(t)$ 的和。\n齐次方程 $x_h''(t) - \\omega^2 x_h(t) = 0$ 的解为 $x_h(t) = A \\cosh(\\omega t) + B \\sinh(\\omega t)$。\n由于强迫项 $\\frac{u}{ml}$ 是常数，我们可以找到一个常数特解 $x_p(t) = C$。代入ODE得到 $0 - \\omega^2 C = \\frac{u}{ml}$，因此 $C = -\\frac{u}{ml\\omega^2} = -\\frac{u}{mg}$。\n该区间的通解为：\n$$\nx_1(t) = A_1 \\cosh(\\omega t) + B_1 \\sinh(\\omega t) - \\frac{u}{mg}\n$$\n其导数为：\n$$\nx_1'(t) = A_1 \\omega \\sinh(\\omega t) + B_1 \\omega \\cosh(\\omega t)\n$$\n应用 $t=0$ 时的初始条件：\n$x_1(0) = 0 \\implies A_1 \\cosh(0) + B_1 \\sinh(0) - \\frac{u}{mg} = 0 \\implies A_1 = \\frac{u}{mg}$。\n$x_1'(0) = v_0 \\implies A_1 \\omega \\sinh(0) + B_1 \\omega \\cosh(0) = v_0 \\implies B_1 \\omega = v_0 \\implies B_1 = \\frac{v_0}{\\omega}$。\n\n因此，对于 $t \\in [0, T]$，状态由以下公式给出：\n$$\nx_1(t) = \\frac{u}{mg} (\\cosh(\\omega t) - 1) + \\frac{v_0}{\\omega} \\sinh(\\omega t)\n$$\n$$\nx_1'(t) = \\frac{u\\omega}{mg} \\sinh(\\omega t) + v_0 \\cosh(\\omega t)\n$$\n在该区间结束时，即时间 $t=T$，状态为：\n$$\nx(T) = \\frac{u}{mg} (\\cosh(\\omega T) - 1) + \\frac{v_0}{\\omega} \\sinh(\\omega T)\n$$\n$$\nx'(T) = \\frac{u\\omega}{mg} \\sinh(\\omega T) + v_0 \\cosh(\\omega T)\n$$\n\n**区间 2: $t \\in (T, H]$**\n该ODE是齐次的，$x''(t) - \\omega^2 x(t) = 0$，因为 $u(t) = 0$。\n通解是 $x_2(t) = A_2 \\cosh(\\omega (t-T)) + B_2 \\sinh(\\omega (t-T))$。时间平移 $t-T$ 简化了该区间初始条件的应用，这些初始条件是前一个区间的最终条件 $x(T)$ 和 $x'(T)$。\n在 $t=T$ 时：\n$x_2(T) = A_2 \\cosh(0) + B_2 \\sinh(0) = A_2$。\n$x_2'(T) = A_2 \\omega \\sinh(0) + B_2 \\omega \\cosh(0) = B_2 \\omega$。\n通过确保状态轨迹的连续性，我们必须有 $A_2 = x(T)$ 和 $B_2 = x'(T)/\\omega$。\n因此，对于 $t \\in (T, H]$ 的解是：\n$$\nx_2(t) = x(T) \\cosh(\\omega(t-T)) + \\frac{x'(T)}{\\omega} \\sinh(\\omega(t-T))\n$$\n我们在 $t=H$ 处计算该解：\n$$\nx(H) = x(T) \\cosh(\\omega(H-T)) + \\frac{x'(T)}{\\omega} \\sinh(\\omega(H-T))\n$$\n代入 $x(T)$ 和 $x'(T)$ 的表达式：\n$$\nx(H) = \\left[ \\frac{u}{mg} (\\cosh(\\omega T) - 1) + \\frac{v_0}{\\omega} \\sinh(\\omega T) \\right] \\cosh(\\omega(H-T)) + \\left[ \\frac{u\\omega}{mg} \\sinh(\\omega T) + v_0 \\cosh(\\omega T) \\right] \\frac{\\sinh(\\omega(H-T))}{\\omega}\n$$\n按 $u$ 和 $v_0$ 对各项进行分组：\n$$\nx(H) = u \\left[ \\frac{\\cosh(\\omega T) - 1}{mg}\\cosh(\\omega(H-T)) + \\frac{\\sinh(\\omega T)}{mg}\\sinh(\\omega(H-T)) \\right] + v_0 \\left[ \\frac{\\sinh(\\omega T)}{\\omega}\\cosh(\\omega(H-T)) + \\frac{\\cosh(\\omega T)}{\\omega}\\sinh(\\omega(H-T)) \\right]\n$$\n使用双曲恒等式 $\\cosh(A+B) = \\cosh A \\cosh B + \\sinh A \\sinh B$ 和 $\\sinh(A+B) = \\sinh A \\cosh B + \\cosh A \\sinh B$：\n乘以 $v_0$ 的项简化为 $\\frac{1}{\\omega} \\sinh(\\omega T + \\omega(H-T)) = \\frac{1}{\\omega} \\sinh(\\omega H)$。\n乘以 $u$ 的项简化为 $\\frac{1}{mg} \\left[ \\cosh(\\omega T)\\cosh(\\omega(H-T)) + \\sinh(\\omega T)\\sinh(\\omega(H-T)) - \\cosh(\\omega(H-T)) \\right] = \\frac{1}{mg} \\left[ \\cosh(\\omega H) - \\cosh(\\omega(H-T)) \\right]$。\n\n因此，$x(H)$ 是 $u$ 的一个线性函数：\n$$\nx(H) = C_u u + C_{v_0} v_0\n$$\n其中\n$$\nC_u = \\frac{\\cosh(\\omega H) - \\cosh(\\omega(H-T))}{mg} \\quad \\text{和} \\quad C_{v_0} = \\frac{\\sinh(\\omega H)}{\\omega}\n$$\n\n**2. 约束优化**\n\n目标是在力矩限制 $|u| \\le u_{\\max}$ 的约束下最小化成本函数 $J(u)$：\n$$\n\\min_{|u| \\le u_{\\max}} J(u) = \\alpha (x(H))^2 + \\beta u^2\n$$\n代入 $x(H)$ 的表达式：\n$$\nJ(u) = \\alpha (C_u u + C_{v_0} v_0)^2 + \\beta u^2\n$$\n这是 $u$ 的一个二次函数。为了找到无约束最小值，我们计算其关于 $u$ 的导数并将其设为零。\n$$\n\\frac{dJ}{du} = 2 \\alpha (C_u u + C_{v_0} v_0) C_u + 2 \\beta u = 2(\\alpha C_u^2 + \\beta)u + 2\\alpha C_u C_{v_0} v_0\n$$\n令 $\\frac{dJ}{du} = 0$ 得到无约束最优力矩 $u_{\\mathrm{unconstrained}}$：\n$$\n(\\alpha C_u^2 + \\beta) u_{\\mathrm{unconstrained}} = -\\alpha C_u C_{v_0} v_0\n$$\n$$\nu_{\\mathrm{unconstrained}} = - \\frac{\\alpha C_u C_{v_0} v_0}{\\alpha C_u^2 + \\beta}\n$$\n其二阶导数为 $\\frac{d^2J}{du^2} = 2(\\alpha C_u^2 + \\beta)$。由于 $\\alpha > 0$ 和 $\\beta > 0$，该值恒为正，这证实了 $J(u)$ 是一个凸抛物线，且 $u_{\\mathrm{unconstrained}}$ 是一个全局最小值。\n\n最后，我们应用箱式约束 $|u| \\le u_{\\max}$。由于 $J(u)$ 是一个开口向上的抛物线，其在区间 $[-u_{\\max}, u_{\\max}]$ 上的最小值可以通过将无约束解进行钳位或饱和处理到可行范围来找到。\n因此，最优约束力矩 $u_{\\mathrm{opt}}$ 为：\n$$\nu_{\\mathrm{opt}} = \\max(-u_{\\max}, \\min(u_{\\max}, u_{\\mathrm{unconstrained}}))\n$$\n这可以用一个裁剪函数表示：\n$$\nu_{\\mathrm{opt}} = \\mathrm{clip}(u_{\\mathrm{unconstrained}}, -u_{\\max}, u_{\\max})\n$$\n推导到此完成。以下程序实现了这个闭式解。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the optimal APA ankle torque for a set of test cases based on a\n    linearized inverted pendulum model and a quadratic cost function.\n    \"\"\"\n\n    # Test suite from the problem statement.\n    # Each tuple contains: (m, l, v0, T, H, alpha, beta, u_max)\n    test_cases = [\n        (75.0, 1.0, 0.2, 0.15, 0.8, 1.0, 1e-6, 120.0),      # Case 1\n        (75.0, 1.0, 0.0, 0.15, 0.8, 1.0, 1e-6, 120.0),      # Case 2\n        (75.0, 1.0, 0.6, 0.15, 0.8, 1.0, 1e-6, 120.0),      # Case 3\n        (75.0, 1.0, 0.2, 0.0, 0.8, 1.0, 1e-6, 120.0),       # Case 4\n        (75.0, 1.0, 0.2, 0.8, 0.8, 1.0, 1e-6, 120.0),       # Case 5\n        (65.0, 0.9, -0.2, 0.1, 0.6, 0.8, 1e-3, 100.0)       # Case 6\n    ]\n\n    results = []\n    for params in test_cases:\n        u_opt = calculate_optimal_torque(*params)\n        results.append(u_opt)\n\n    # Format the results as a comma-separated list of floats rounded to six\n    # decimal places, enclosed in square brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_optimal_torque(m, l, v0, T, H, alpha, beta, u_max):\n    \"\"\"\n    Calculates the optimal APA torque for a single set of parameters.\n\n    Args:\n        m (float): Mass in kg.\n        l (float): COM height in m.\n        v0 (float): Initial COM velocity in m/s.\n        T (float): Duration of APA torque in s.\n        H (float): Evaluation horizon time in s.\n        alpha (float): Weighting on COM displacement cost.\n        beta (float): Weighting on control effort cost.\n        u_max (float): Maximum absolute ankle torque in N·m.\n    \n    Returns:\n        float: The optimal APA torque u_opt in N·m.\n    \"\"\"\n    g = 9.81  # Gravitational acceleration in m/s^2\n\n    # Natural frequency of the inverted pendulum model\n    omega = np.sqrt(g / l)\n\n    # Calculate coefficients C_u and C_v0 based on the derived solution\n    # x(H) = C_u * u + C_v0 * v0\n    C_u = (np.cosh(omega * H) - np.cosh(omega * (H - T))) / (m * g)\n    C_v0 = np.sinh(omega * H) / omega\n\n    # Calculate the unconstrained optimal torque that minimizes the cost function\n    # u_unconstrained = - (alpha * C_u * C_v0 * v0) / (alpha * C_u^2 + beta)\n    numerator = -alpha * C_u * C_v0 * v0\n    denominator = alpha * C_u**2 + beta\n\n    # The denominator is guaranteed to be positive since alpha > 0 and beta > 0.\n    # No risk of division by zero.\n    u_unconstrained = numerator / denominator\n    \n    # Apply the saturation constraint |u| = u_max\n    u_opt = np.clip(u_unconstrained, -u_max, u_max)\n\n    return u_opt\n\nsolve()\n```"
        }
    ]
}