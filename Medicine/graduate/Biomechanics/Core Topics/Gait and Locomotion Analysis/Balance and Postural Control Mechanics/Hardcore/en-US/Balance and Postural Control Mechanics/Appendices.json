{
    "hands_on_practices": [
        {
            "introduction": "The foundation of postural stability lies in the geometric relationship between the body's center of mass (COM) and its base of support (BOS). To maintain balance under quasi-static conditions, the vertical projection of the COM must remain within the boundaries of the BOS. This exercise moves beyond this qualitative rule to a quantitative assessment by having you calculate the 'margin of stability'—the precise distance the COM can be displaced before reaching the brink of imbalance, providing a tangible measure of postural robustness. ",
            "id": "4156507",
            "problem": "A human stands quietly on level ground with both feet in contact, producing a Base of Support (BOS) approximated by a convex polygon in the horizontal plane. Let the horizontal coordinate frame be defined such that the lateral (mediolateral) axis is the $x$-axis and the anterior-posterior axis is the $y$-axis. The BOS polygon vertices are given in counterclockwise order by\n$$\n(x_1,y_1)=(-0.12,\\,0.10),\\quad (x_2,y_2)=(0.12,\\,0.10),\\quad (x_3,y_3)=(0.16,\\,-0.05),\n$$\n$$\n(x_4,y_4)=(0.10,\\,-0.20),\\quad (x_5,y_5)=(-0.10,\\,-0.20),\\quad (x_6,y_6)=(-0.16,\\,-0.05).\n$$\nThe vertical projection of the whole-body Center of Mass (COM) onto the ground plane is at $(x_c,y_c)=(0.03,\\,-0.04)$. Assume quasi-static conditions and that static equilibrium requires the COM projection to lie within the BOS.\n\nStarting only from fundamental mechanics (Newton’s laws for static equilibrium) and geometric reasoning, determine the minimum lateral COM shift (pure translation along the $x$-axis with $y$ held fixed at $y_c$) required for the COM projection to reach the BOS boundary. Interpret “minimum lateral COM shift” as the smallest nonnegative value of $|x-x_c|$ such that the point $(x,\\,y_c)$ lies on the polygon boundary. Compute this minimum shift using the given polygon and COM coordinates.\n\nDiscuss, in words, the implications of your computed value for the subject’s lateral balance margin at the given anterior-posterior location, but provide only the numerical value of the minimum lateral shift as your final answer. Express your final result in meters and round your answer to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- The coordinate system is defined with the lateral axis as the $x$-axis and the anterior-posterior axis as the $y$-axis.\n- The Base of Support (BOS) is a convex polygon with vertices given in meters:\n  $P_1 = (x_1, y_1) = (-0.12, 0.10)$\n  $P_2 = (x_2, y_2) = (0.12, 0.10)$\n  $P_3 = (x_3, y_3) = (0.16, -0.05)$\n  $P_4 = (x_4, y_4) = (0.10, -0.20)$\n  $P_5 = (x_5, y_5) = (-0.10, -0.20)$\n  $P_6 = (x_6, y_6) = (-0.16, -0.05)$\n- The vertical projection of the whole-body Center of Mass (COM) is at $(x_c, y_c) = (0.03, -0.04)$.\n- The condition for static equilibrium is that the COM projection must lie within the BOS.\n- The task is to find the minimum lateral COM shift, defined as the smallest non-negative value of $|x-x_c|$ such that the point $(x, y_c)$ lies on the BOS polygon boundary.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the fundamental principles of static equilibrium and biomechanics, where the relationship between the COM projection and the BOS determines postural stability. The provided data are realistic for human quiet standing. The problem is well-posed, providing all necessary geometric information (polygon vertices, a point, a specified line of motion) to determine a unique solution. The language is objective and precise. The problem is therefore deemed **valid**.\n\n**Step 3: Proceed to Solution**\n\nThe core of the problem is to determine the boundaries of the BOS at the specific anterior-posterior level of the COM projection. The COM is to be shifted purely laterally, which means its projection moves along the horizontal line defined by $y = y_c = -0.04$. To find the minimum shift to reach the boundary, we must find the intersection points of this line with the edges of the BOS polygon.\n\nThe boundary of the BOS is a polygon defined by six vertices. An edge of the polygon connecting vertices $(x_i, y_i)$ and $(x_j, y_j)$ can intersect the line $y = y_c$ only if $y_c$ lies between $y_i$ and $y_j$, i.e., $\\min(y_i, y_j) \\le y_c \\le \\max(y_i, y_j)$. We examine the $y$-coordinates of the vertices: $y_1=0.10$, $y_2=0.10$, $y_3=-0.05$, $y_4=-0.20$, $y_5=-0.20$, $y_6=-0.05$. The value $y_c = -0.04$ lies in the following intervals:\n- Between $y_2=0.10$ and $y_3=-0.05$. Thus, the line $y=-0.04$ intersects the edge $P_2P_3$.\n- Between $y_1=0.10$ and $y_6=-0.05$. Thus, the line $y=-0.04$ intersects the edge $P_6P_1$.\n\nWe now compute the $x$-coordinates of these two intersection points. The equation for a line segment between $(x_a, y_a)$ and $(x_b, y_b)$ can be rearranged to solve for $x$ given a value of $y$:\n$$x = x_a + (y - y_a) \\frac{x_b - x_a}{y_b - y_a}$$\n\nFirst, let's find the intersection with the right-side boundary edge, $P_2P_3$. Let this intersection point have an $x$-coordinate of $x_R$. Using the formula with $(x_a, y_a) = P_2 = (0.12, 0.10)$ and $(x_b, y_b) = P_3 = (0.16, -0.05)$, and with $y=y_c=-0.04$:\n$$x_R = 0.12 + (-0.04 - 0.10) \\frac{0.16 - 0.12}{-0.05 - 0.10}$$\n$$x_R = 0.12 + (-0.14) \\frac{0.04}{-0.15}$$\n$$x_R = 0.12 + \\frac{0.0056}{0.15} = 0.12 + \\frac{56}{1500} = \\frac{12}{100} + \\frac{56}{1500} = \\frac{180}{1500} + \\frac{56}{1500} = \\frac{236}{1500} = \\frac{59}{375}$$\nThe $x$-coordinate of the right boundary at this level is $x_R = \\frac{59}{375}$ meters.\n\nNext, we find the intersection with the left-side boundary edge, $P_6P_1$. Let this intersection point have an $x$-coordinate of $x_L$. Using $(x_a, y_a) = P_6 = (-0.16, -0.05)$ and $(x_b, y_b) = P_1 = (-0.12, 0.10)$:\n$$x_L = -0.16 + (-0.04 - (-0.05)) \\frac{-0.12 - (-0.16)}{0.10 - (-0.05)}$$\n$$x_L = -0.16 + (0.01) \\frac{0.04}{0.15}$$\n$$x_L = -0.16 + \\frac{0.0004}{0.15} = -0.16 + \\frac{4}{1500} = -\\frac{16}{100} + \\frac{4}{1500} = -\\frac{240}{1500} + \\frac{4}{1500} = -\\frac{236}{1500} = -\\frac{59}{375}$$\nThe $x$-coordinate of the left boundary is $x_L = -\\frac{59}{375}$ meters. (Note: The symmetry of the BOS polygon, where $P_1$ is symmetric to $P_2$, $P_6$ to $P_3$, etc., with respect to the $y$-axis, implies that $x_L = -x_R$, which our calculation confirms.)\n\nThe initial lateral position of the COM projection is $x_c = 0.03$. The problem asks for the minimum shift required to reach the boundary. This means finding the smaller of the two possible displacement magnitudes: one to the right boundary and one to the left boundary.\nThe shift required to reach the right boundary is the distance $|x_R - x_c|$:\n$$\\left| \\frac{59}{375} - 0.03 \\right| = \\left| \\frac{59}{375} - \\frac{3}{100} \\right| = \\left| \\frac{236}{1500} - \\frac{45}{1500} \\right| = \\frac{191}{1500}$$\nThe shift required to reach the left boundary is the distance $|x_L - x_c|$:\n$$\\left| -\\frac{59}{375} - 0.03 \\right| = \\left| -\\frac{236}{1500} - \\frac{45}{1500} \\right| = \\left| -\\frac{281}{1500} \\right| = \\frac{281}{1500}$$\n\nWe compare these two possible shifts:\nShift to the right: $\\frac{191}{1500} \\approx 0.127333...$ meters.\nShift to the left: $\\frac{281}{1500} \\approx 0.187333...$ meters.\n\nThe minimum of these two values is $\\frac{191}{1500}$ meters.\nRounding this result to four significant figures gives $0.1273$ meters.\n\nThe interpretation of this result pertains to the concept of the margin of stability. This margin is the maximum distance the COM can be displaced in a given direction before it exits the BOS, leading to a loss of balance. In this case, the subject's COM projection is at $(0.03, -0.04)$, which is offset to the right from the BOS centerline (the $y$-axis). Consequently, the margin of stability for a rightward (positive $x$) sway is smaller ($0.1273$ m) than for a leftward (negative $x$) sway ($0.1873$ m). The computed value of $0.1273$ m represents the subject's lateral balance margin in the direction of their initial COM displacement. A smaller margin indicates a greater susceptibility to losing balance from a perturbation in that direction.",
            "answer": "$$\n\\boxed{0.1273}\n$$"
        },
        {
            "introduction": "Effective postural control is not merely reactive; it is proactive. When we anticipate performing a voluntary movement, such as reaching for an object, the central nervous system generates anticipatory postural adjustments (APAs) to counteract the predictable disturbance that the movement will create. This practice delves into the mechanics of this predictive control, using inverse dynamics to derive how the magnitude of an APA must scale with the physical demands of the task, such as the mass of a handheld load. ",
            "id": "4156467",
            "problem": "A human subject stands quietly on level ground and initiates a forward reach in the sagittal plane while holding a small external load in the hands. Model the body as a single-link inverted pendulum pivoting at the ankle, with the following simplifications and definitions:\n\n- The lower trunk and legs (exclusive of the arm–hand–load system) have mass $m$.\n- The arm–hand system (without the external load) is lumped into a point mass $m_{u}$ located at a fixed vertical height $z_{u}$ above the ankle joint.\n- An external load of mass $L$ is grasped so that the arm–hand–load system’s lumped mass is $(m_{u}+L)$ located at the same height $z_{u}$.\n- At the onset of the anticipatory postural adjustment (APA), the controller produces a prescribed forward horizontal acceleration $a_{0}$ of the arm–hand–load system’s center of mass. The APA is defined as the additional backward shift of the center-of-pressure (COP) by a distance $s$ relative to quiet stance, such that the net whole-body angular acceleration about the ankle is zero at APA onset.\n- Assume small sway angles, negligible vertical accelerations, and that the ground reaction force magnitude during the APA epoch equals the total weight $W=(m+m_{u}+L)g$, where $g$ is gravitational acceleration. Pre-existing gravitational torques (present at quiet stance) are already balanced by the baseline COP position and do not contribute to the incremental APA.\n\nUsing Newton’s laws and inverse dynamics (i.e., summing moments about the ankle to enforce zero net angular acceleration at APA onset), derive how the APA amplitude scales with the added hand-held mass. Let $s(0)$ denote the APA amplitude when $L=0$, and let $s(L)$ denote the APA amplitude with the added load $L$. Compute the exact closed-form analytic expression for the dimensionless scaling factor\n$$k(L)=\\frac{s(L)}{s(0)}$$\nin terms of $m$, $m_{u}$, $z_{u}$, $a_{0}$, $g$, and $L$. Express your final answer as a single closed-form expression. No numerical evaluation is required, and no units are needed because $k(L)$ is dimensionless. Do not provide an approximation; provide the exact expression.",
            "solution": "The user has requested a solution to a biomechanics problem. I will first validate the problem statement and then, if it is valid, provide a complete solution.\n\n## Problem Validation\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n- **Model**: The body is a single-link inverted pendulum pivoting at the ankle.\n- **Masses**:\n    - The lower trunk and legs have mass $m$.\n    - The arm–hand system has an effective point mass $m_{u}$.\n    - An external load has mass $L$.\n- **Geometry**:\n    - The mass $m_{u}$ is at a fixed vertical height $z_{u}$ above the ankle.\n    - The combined mass $(m_{u}+L)$ is also located at height $z_{u}$.\n- **Dynamics**:\n    - At the onset of the anticipatory postural adjustment (APA), the arm–hand–load system's center of mass undergoes a prescribed forward horizontal acceleration $a_0$.\n    - The APA is a backward shift of the center-of-pressure (COP) by a distance $s$ relative to quiet stance.\n    - At APA onset, the net whole-body angular acceleration about the ankle is zero.\n- **Assumptions**:\n    - Small sway angles.\n    - Negligible vertical accelerations.\n    - Ground reaction force magnitude equals total weight $W=(m+m_{u}+L)g$.\n    - Pre-existing gravitational torques from quiet stance are balanced and do not contribute to the incremental APA dynamics.\n- **Objective**:\n    - Let $s(0)$ be the APA amplitude for $L=0$.\n    - Let $s(L)$ be the APA amplitude for a load $L$.\n    - Compute the dimensionless scaling factor $k(L)=\\frac{s(L)}{s(0)}$ as a closed-form expression in terms of $m$, $m_{u}$, $z_{u}$, $a_{0}$, $g$, and $L$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the principles of biomechanics and classical mechanics, specifically using the inverted pendulum model for postural control and the concept of anticipatory postural adjustments. The use of Newton's laws (or D'Alembert's principle in the form of inverse dynamics) is standard.\nThe problem is well-posed. It provides sufficient variables and a clear condition (zero net angular acceleration) to establish a solvable equation.\nThe language is objective and precise.\n\nThere is a point of potential ambiguity: \"zero net whole-body angular acceleration\". If the body were a single rigid link, a zero angular acceleration would imply zero linear acceleration for all points, contradicting the given that the arm accelerates with $a_0$. However, the problem distinguishes two mass components, $m$ and $(m_{u}+L)$, with the latter having a prescribed acceleration. This implies a multi-body system. In this context, \"zero net whole-body angular acceleration\" is best interpreted as the goal of the APA: to generate a postural torque that exactly counteracts the disturbance torque from the arm movement, such that the primary postural link (the trunk and legs, mass $m$) experiences no angular acceleration. This interpretation is physically meaningful, consistent with the purpose of an APA, and renders the problem solvable. It is a common simplification in this domain of study.\n\nBased on this analysis, the problem is deemed valid.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. I will proceed to the solution.\n\n## Solution\n\nThe solution is derived using the principle of inverse dynamics, as suggested by the problem statement. We will sum the moments about the ankle joint, which acts as the pivot of the inverted pendulum. The rotational equation of motion for a system of particles about a fixed point (the ankle, denoted by A) is $\\sum \\vec{\\tau}_{\\text{ext,A}} = \\frac{d\\vec{H}_{\\text{A}}}{dt}$, where $\\sum \\vec{\\tau}_{\\text{ext,A}}$ is the sum of external torques and $\\frac{d\\vec{H}_{\\text{A}}}{dt}$ is the rate of change of the system's angular momentum about A.\n\nLet's establish a coordinate system where the ankle is at the origin $(0, 0)$, the x-axis is horizontal (forward), and the y-axis is vertical (upward). All moments will be calculated about the z-axis (out of the sagittal plane).\n\nThe rate of change of angular momentum is given by $\\frac{d\\vec{H}_{\\text{A}}}{dt} = \\sum_i \\vec{r}_i \\times (m_i \\vec{a}_i)$, where the sum is over the particles of the system. We have two lumped masses to consider:\n1. The trunk and legs, with mass $m$.\n2. The arm-hand-load system, with mass $(m_u+L)$.\n\nThe problem states to enforce \"zero net whole-body angular acceleration at APA onset\". As validated, we interpret this to mean the angular acceleration of the main postural link (mass $m$) is zero. Since the system starts from rest, this implies the linear acceleration of mass $m$ is also zero, $\\vec{a}_m = 0$.\n\nThe arm-hand-load system is at a vertical height $z_u$, so its position vector at the onset of movement (when the body is still upright) is $\\vec{r}_{u+L} = (0, z_u)$. It is given a horizontal acceleration $\\vec{a}_{u+L} = (a_0, 0)$. The contribution of this mass to the rate of change of angular momentum is:\n$$ \\left( \\frac{d\\vec{H}_{\\text{A}}}{dt} \\right)_{u+L} = \\vec{r}_{u+L} \\times ((m_u+L)\\vec{a}_{u+L}) = (0, z_u, 0) \\times ((m_u+L)a_0, 0, 0) $$\nThe resulting vector is purely in the z-direction:\n$$ \\left( \\frac{d\\vec{H}_{\\text{A}}}{dt} \\right)_{z} = -z_u (m_u+L) a_0 $$\nSince $\\vec{a}_m=0$, the total rate of change of angular momentum of the system is given by this term alone.\n\nNow, we evaluate the sum of external torques about the ankle. The external forces are gravity and the ground reaction force (GRF).\n- The total weight is $W = (m+m_u+L)g$. The assumption that pre-existing gravitational torques are balanced implies that in quiet stance, the total center of mass (COM) projetos vertically onto the quiet-stance center of pressure (COP). The APA involves an *additional* backward shift of the COP by a distance $s$. We analyze the incremental torques generated by the APA.\n- The vertical component of the GRF has magnitude $F_y = W$, as vertical accelerations are negligible. This force acts at the COP. The APA shifts the COP backward by $s$, so its new position relative to the quiet stance COP is $x_{\\text{COP}} = -s$. Assuming the ankle is the reference for the coordinate system and coincides with the quiet-stance COP for simplicity (a common convention that doesn't affect the incremental analysis), the torque from the vertical GRF is:\n$$ \\vec{\\tau}_{\\text{GRF}} = \\vec{r}_{\\text{COP}} \\times \\vec{F}_{\\text{GRF}} = (-s, 0, 0) \\times (F_x, W, 0) $$\nwhere $F_x$ is the horizontal GRF. The torque from the vertical component is:\n$$ \\tau_z = -sW = -s(m+m_u+L)g $$\nThe torque from the horizontal GRF $F_x$ about the ankle is zero since its lever arm is zero.\n- The incremental gravitational torque is zero at the onset of movement because the COM has not yet displaced horizontally.\n\nEquating the net external torque with the rate of change of angular momentum:\n$$ \\sum \\tau_{\\text{ext,A},z} = \\frac{dH_{\\text{A},z}}{dt} $$\n$$ -s(m+m_u+L)g = -z_u(m_u+L)a_0 $$\nSolving for the APA amplitude $s$ as a function of the load $L$, which we denote $s(L)$:\n$$ s(L) = \\frac{z_u a_0 (m_u+L)}{g(m+m_u+L)} $$\nThis expression gives the required backward COP shift to counteract the forward-tipping moment generated by the arm acceleration, thereby keeping the trunk stationary.\n\nTo find the scaling factor $k(L)$, we first need the APA amplitude for the no-load case, $s(0)$. We obtain this by setting $L=0$ in the expression for $s(L)$:\n$$ s(0) = \\frac{z_u a_0 (m_u+0)}{g(m+m_u+0)} = \\frac{z_u a_0 m_u}{g(m+m_u)} $$\nThe dimensionless scaling factor $k(L)$ is the ratio $\\frac{s(L)}{s(0)}$:\n$$ k(L) = \\frac{s(L)}{s(0)} = \\frac{\\frac{z_u a_0 (m_u+L)}{g(m+m_u+L)}}{\\frac{z_u a_0 m_u}{g(m+m_u)}} $$\nThe terms $\\frac{z_u a_0}{g}$ cancel out:\n$$ k(L) = \\frac{m_u+L}{m+m_u+L} \\cdot \\frac{m+m_u}{m_u} $$\nThis can be written as a single fraction:\n$$ k(L) = \\frac{(m+m_u)(m_u+L)}{m_u(m+m_u+L)} $$\nThis is the final, exact, closed-form analytic expression for the scaling factor.",
            "answer": "$$ \\boxed{ \\frac{(m+m_u)(m_u+L)}{m_u(m+m_u+L)} } $$"
        },
        {
            "introduction": "How does the nervous system select a specific motor strategy from a countless number of possibilities? This question brings us to the realm of optimal control, a powerful framework that posits motor behaviors arise from optimizing a performance objective under a set of constraints. This computational practice guides you through the design of an optimal APA by minimizing a cost function that balances the need for stability against the physiological cost of control effort, offering a glimpse into the principles that may govern neural decision-making in balance control. ",
            "id": "4156466",
            "problem": "You are to design and implement a program that computes the optimal Anticipatory Postural Adjustment (APA) ankle torque to minimize Center of Mass (COM) deviation, subject to joint torque limits, using a quadratic cost on COM displacement and control effort. The target audience is advanced graduate-level in biomechanics, with focus on balance and postural control mechanics.\n\nUse the sagittal-plane inverted pendulum model of quiet stance about the ankle joint. The body is modeled as a point mass at a constant height above the ankle. The following base assumptions and laws are required:\n- Newton's Second Law: $F = m a$, and rotational form $I \\alpha = \\tau$.\n- Small-angle linearization about upright: COM horizontal displacement $x$ and ankle angle $\\theta$ satisfy $x = l \\theta$ with $\\theta$ measured in radians.\n- For a point mass at height $l$, the moment of inertia about the ankle is $I = m l^2$.\n- Gravitational acceleration is $g = 9.81 \\ \\mathrm{m/s^2}$.\n\nUnder these assumptions, the COM horizontal displacement $x(t)$ obeys the linear ordinary differential equation\n$$\nx''(t) = \\frac{g}{l} x(t) + \\frac{1}{m l} u(t),\n$$\nwhere $m$ is mass in $\\mathrm{kg}$, $l$ is COM height in $\\mathrm{m}$, and $u(t)$ is the sagittal-plane ankle torque in $\\mathrm{N \\cdot m}$ producing the APA. An impending external perturbation (for example, a push) is modeled as an initial COM velocity $v_0$ at time $t=0$. The initial COM position is $x(0) = 0$, and $x'(0) = v_0$.\n\nThe APA is a constant torque $u$ applied over a finite window $[0, T]$ with $T \\le H$, after which $u(t) = 0$ for $t \\in (T, H]$. The horizon $H$ is the evaluation time for COM deviation. The symmetric ankle torque limit is $|u| \\le u_{\\max}$.\n\nDefine the performance cost to be\n$$\nJ(u) = \\alpha \\, \\big(x(H)\\big)^2 + \\beta \\, u^2,\n$$\nwhere $\\alpha > 0$ and $\\beta > 0$ are weightings on COM displacement and control effort, respectively.\n\nYour tasks:\n1. Starting only from the above base model and laws, derive the expression of $x(H)$ as a function of the constant APA torque $u$, the initial velocity $v_0$, and the parameters $m, l, g, T, H$. Do not assume any shortcut formulas beyond the given fundamentals.\n2. Formulate the scalar optimization problem $\\min_{u} J(u)$ subject to $|u| \\le u_{\\max}$ and derive the closed-form optimal $u$ that minimizes $J(u)$ under this bound.\n3. Implement a program that, for each test case below, computes the optimal APA ankle torque $u_{\\mathrm{opt}}$ in $\\mathrm{N \\cdot m}$, rounded to six decimal places. A negative value indicates a torque direction opposing positive $x$ motion, consistent with right-handed sagittal-plane convention. Angles, when referenced, must be treated in radians.\n\nUse $g = 9.81 \\ \\mathrm{m/s^2}$ and standard International System of Units (SI). The final program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[u_1,u_2,\\dots]$, with each $u_i$ a float rounded to six decimals and expressed in $\\mathrm{N \\cdot m}$.\n\nTest Suite:\n- Case 1 (typical human, nonzero perturbation, low effort penalty): $m = 75.0 \\ \\mathrm{kg}$, $l = 1.0 \\ \\mathrm{m}$, $v_0 = 0.2 \\ \\mathrm{m/s}$, $T = 0.15 \\ \\mathrm{s}$, $H = 0.8 \\ \\mathrm{s}$, $\\alpha = 1.0$, $\\beta = 10^{-6}$, $u_{\\max} = 120.0 \\ \\mathrm{N \\cdot m}$.\n- Case 2 (no perturbation): $m = 75.0 \\ \\mathrm{kg}$, $l = 1.0 \\ \\mathrm{m}$, $v_0 = 0.0 \\ \\mathrm{m/s}$, $T = 0.15 \\ \\mathrm{s}$, $H = 0.8 \\ \\mathrm{s}$, $\\alpha = 1.0$, $\\beta = 10^{-6}$, $u_{\\max} = 120.0 \\ \\mathrm{N \\cdot m}$.\n- Case 3 (large perturbation causing saturation): $m = 75.0 \\ \\mathrm{kg}$, $l = 1.0 \\ \\mathrm{m}$, $v_0 = 0.6 \\ \\mathrm{m/s}$, $T = 0.15 \\ \\mathrm{s}$, $H = 0.8 \\ \\mathrm{s}$, $\\alpha = 1.0$, $\\beta = 10^{-6}$, $u_{\\max} = 120.0 \\ \\mathrm{N \\cdot m}$.\n- Case 4 (no APA window): $m = 75.0 \\ \\mathrm{kg}$, $l = 1.0 \\ \\mathrm{m}$, $v_0 = 0.2 \\ \\mathrm{m/s}$, $T = 0.0 \\ \\mathrm{s}$, $H = 0.8 \\ \\mathrm{s}$, $\\alpha = 1.0$, $\\beta = 10^{-6}$, $u_{\\max} = 120.0 \\ \\mathrm{N \\cdot m}$.\n- Case 5 (APA applied over entire horizon): $m = 75.0 \\ \\mathrm{kg}$, $l = 1.0 \\ \\mathrm{m}$, $v_0 = 0.2 \\ \\mathrm{m/s}$, $T = 0.8 \\ \\mathrm{s}$, $H = 0.8 \\ \\mathrm{s}$, $\\alpha = 1.0$, $\\beta = 10^{-6}$, $u_{\\max} = 120.0 \\ \\mathrm{N \\cdot m}$.\n- Case 6 (different anthropometrics and weights): $m = 65.0 \\ \\mathrm{kg}$, $l = 0.9 \\ \\mathrm{m}$, $v_0 = -0.2 \\ \\mathrm{m/s}$, $T = 0.1 \\ \\mathrm{s}$, $H = 0.6 \\ \\mathrm{s}$, $\\alpha = 0.8$, $\\beta = 10^{-3}$, $u_{\\max} = 100.0 \\ \\mathrm{N \\cdot m}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test suite, each value rounded to six decimals in $\\mathrm{N \\cdot m}$.",
            "solution": "The problem requires the determination of an optimal constant anticipatory postural adjustment (APA) ankle torque, $u$, that minimizes a quadratic cost function involving a tradeoff between Center of Mass (COM) deviation at a future time $H$ and the control effort. The analysis is based on a linearized inverted pendulum model of human stance.\n\nThe problem is valid as it is scientifically grounded in established biomechanical modeling principles, is mathematically well-posed, and all necessary parameters and conditions are provided for a unique solution.\n\nThe derivation and solution proceed in two main stages: first, solving the system dynamics to express the final COM position $x(H)$ as a function of the control input $u$; second, solving the constrained optimization problem to find the optimal torque $u_{\\mathrm{opt}}$.\n\n**1. Derivation of the State at the Horizon Time, $x(H)$**\n\nThe dynamics of the COM horizontal displacement, $x(t)$, are governed by the second-order linear ordinary differential equation (ODE):\n$$\nx''(t) = \\frac{g}{l} x(t) + \\frac{1}{m l} u(t)\n$$\nLet us define $\\omega^2 = g/l$. The equation becomes:\n$$\nx''(t) - \\omega^2 x(t) = \\frac{u(t)}{ml}\n$$\nThe control torque $u(t)$ is a piecewise constant function:\n$$\nu(t) = \\begin{cases} u & \\text{for } t \\in [0, T] \\\\ 0 & \\text{for } t \\in (T, H] \\end{cases}\n$$\nWe solve the ODE over the two intervals.\n\n**Interval 1: $t \\in [0, T]$**\nThe ODE is $x''(t) - \\omega^2 x(t) = \\frac{u}{ml}$, with initial conditions $x(0) = 0$ and $x'(0) = v_0$.\nThe general solution is the sum of the homogeneous solution, $x_h(t)$, and a particular solution, $x_p(t)$.\nThe homogeneous equation $x_h''(t) - \\omega^2 x_h(t) = 0$ has the solution $x_h(t) = A \\cosh(\\omega t) + B \\sinh(\\omega t)$.\nSince the forcing term $\\frac{u}{ml}$ is constant, we can find a constant particular solution $x_p(t) = C$. Substituting into the ODE gives $0 - \\omega^2 C = \\frac{u}{ml}$, so $C = -\\frac{u}{ml\\omega^2} = -\\frac{u}{mg}$.\nThe general solution for this interval is:\n$$\nx_1(t) = A_1 \\cosh(\\omega t) + B_1 \\sinh(\\omega t) - \\frac{u}{mg}\n$$\nIts derivative is:\n$$\nx_1'(t) = A_1 \\omega \\sinh(\\omega t) + B_1 \\omega \\cosh(\\omega t)\n$$\nApplying the initial conditions at $t=0$:\n$x_1(0) = 0 \\implies A_1 \\cosh(0) + B_1 \\sinh(0) - \\frac{u}{mg} = 0 \\implies A_1 = \\frac{u}{mg}$.\n$x_1'(0) = v_0 \\implies A_1 \\omega \\sinh(0) + B_1 \\omega \\cosh(0) = v_0 \\implies B_1 \\omega = v_0 \\implies B_1 = \\frac{v_0}{\\omega}$.\n\nThus, for $t \\in [0, T]$, the state is given by:\n$$\nx_1(t) = \\frac{u}{mg} (\\cosh(\\omega t) - 1) + \\frac{v_0}{\\omega} \\sinh(\\omega t)\n$$\n$$\nx_1'(t) = \\frac{u\\omega}{mg} \\sinh(\\omega t) + v_0 \\cosh(\\omega t)\n$$\nAt the end of this interval, at time $t=T$, the state is:\n$$\nx(T) = \\frac{u}{mg} (\\cosh(\\omega T) - 1) + \\frac{v_0}{\\omega} \\sinh(\\omega T)\n$$\n$$\nx'(T) = \\frac{u\\omega}{mg} \\sinh(\\omega T) + v_0 \\cosh(\\omega T)\n$$\n\n**Interval 2: $t \\in (T, H]$**\nThe ODE is homogeneous, $x''(t) - \\omega^2 x(t) = 0$, since $u(t) = 0$.\nThe general solution is $x_2(t) = A_2 \\cosh(\\omega (t-T)) + B_2 \\sinh(\\omega (t-T))$. The time shift $t-T$ simplifies the application of initial conditions for this interval, which are the final conditions from the previous interval, $x(T)$ and $x'(T)$.\nAt $t=T$:\n$x_2(T) = A_2 \\cosh(0) + B_2 \\sinh(0) = A_2$.\n$x_2'(T) = A_2 \\omega \\sinh(0) + B_2 \\omega \\cosh(0) = B_2 \\omega$.\nBy ensuring continuity of the state trajectory, we must have $A_2 = x(T)$ and $B_2 = x'(T)/\\omega$.\nThe solution for $t \\in (T, H]$ is therefore:\n$$\nx_2(t) = x(T) \\cosh(\\omega(t-T)) + \\frac{x'(T)}{\\omega} \\sinh(\\omega(t-T))\n$$\nWe evaluate this at $t=H$:\n$$\nx(H) = x(T) \\cosh(\\omega(H-T)) + \\frac{x'(T)}{\\omega} \\sinh(\\omega(H-T))\n$$\nSubstituting the expressions for $x(T)$ and $x'(T)$:\n$$\nx(H) = \\left[ \\frac{u}{mg} (\\cosh(\\omega T) - 1) + \\frac{v_0}{\\omega} \\sinh(\\omega T) \\right] \\cosh(\\omega(H-T)) + \\left[ \\frac{u\\omega}{mg} \\sinh(\\omega T) + v_0 \\cosh(\\omega T) \\right] \\frac{\\sinh(\\omega(H-T))}{\\omega}\n$$\nGrouping terms by $u$ and $v_0$:\n$$\nx(H) = u \\left[ \\frac{\\cosh(\\omega T) - 1}{mg}\\cosh(\\omega(H-T)) + \\frac{\\sinh(\\omega T)}{mg}\\sinh(\\omega(H-T)) \\right] + v_0 \\left[ \\frac{\\sinh(\\omega T)}{\\omega}\\cosh(\\omega(H-T)) + \\frac{\\cosh(\\omega T)}{\\omega}\\sinh(\\omega(H-T)) \\right]\n$$\nUsing the hyperbolic identities $\\cosh(A+B) = \\cosh A \\cosh B + \\sinh A \\sinh B$ and $\\sinh(A+B) = \\sinh A \\cosh B + \\cosh A \\sinh B$:\nThe term multiplying $v_0$ simplifies to $\\frac{1}{\\omega} \\sinh(\\omega T + \\omega(H-T)) = \\frac{1}{\\omega} \\sinh(\\omega H)$.\nThe term multiplying $u$ simplifies to $\\frac{1}{mg} \\left[ \\cosh(\\omega T)\\cosh(\\omega(H-T)) + \\sinh(\\omega T)\\sinh(\\omega(H-T)) - \\cosh(\\omega(H-T)) \\right] = \\frac{1}{mg} \\left[ \\cosh(\\omega H) - \\cosh(\\omega(H-T)) \\right]$.\n\nThus, $x(H)$ is a linear function of $u$:\n$$\nx(H) = C_u u + C_{v_0} v_0\n$$\nwhere\n$$\nC_u = \\frac{\\cosh(\\omega H) - \\cosh(\\omega(H-T))}{mg} \\quad \\text{and} \\quad C_{v_0} = \\frac{\\sinh(\\omega H)}{\\omega}\n$$\n\n**2. Constrained Optimization**\n\nThe objective is to minimize the cost function $J(u)$ subject to the torque limit $|u| \\le u_{\\max}$:\n$$\n\\min_{|u| \\le u_{\\max}} J(u) = \\alpha (x(H))^2 + \\beta u^2\n$$\nSubstituting the expression for $x(H)$:\n$$\nJ(u) = \\alpha (C_u u + C_{v_0} v_0)^2 + \\beta u^2\n$$\nThis is a quadratic function of $u$. To find the unconstrained minimum, we compute the derivative with respect to $u$ and set it to zero.\n$$\n\\frac{dJ}{du} = 2 \\alpha (C_u u + C_{v_0} v_0) C_u + 2 \\beta u = 2(\\alpha C_u^2 + \\beta)u + 2\\alpha C_u C_{v_0} v_0\n$$\nSetting $\\frac{dJ}{du} = 0$ gives the unconstrained optimal torque, $u_{\\mathrm{unconstrained}}$:\n$$\n(\\alpha C_u^2 + \\beta) u_{\\mathrm{unconstrained}} = -\\alpha C_u C_{v_0} v_0\n$$\n$$\nu_{\\mathrm{unconstrained}} = - \\frac{\\alpha C_u C_{v_0} v_0}{\\alpha C_u^2 + \\beta}\n$$\nThe second derivative is $\\frac{d^2J}{du^2} = 2(\\alpha C_u^2 + \\beta)$. Since $\\alpha > 0$ and $\\beta > 0$, this is always positive, confirming that $J(u)$ is a convex parabola and $u_{\\mathrm{unconstrained}}$ is a global minimum.\n\nFinally, we apply the box constraint $|u| \\le u_{\\max}$. Since $J(u)$ is a parabola opening upwards, its minimum over the interval $[-u_{\\max}, u_{\\max}]$ is found by clamping or saturating the unconstrained solution to the feasible range.\nThe optimal constrained torque $u_{\\mathrm{opt}}$ is thus:\n$$\nu_{\\mathrm{opt}} = \\max(-u_{\\max}, \\min(u_{\\max}, u_{\\mathrm{unconstrained}}))\n$$\nThis can be expressed using a clipping function:\n$$\nu_{\\mathrm{opt}} = \\mathrm{clip}(u_{\\mathrm{unconstrained}}, -u_{\\max}, u_{\\max})\n$$\nThis completes the derivation. The following program implements this closed-form solution.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the optimal APA ankle torque for a set of test cases based on a\n    linearized inverted pendulum model and a quadratic cost function.\n    \"\"\"\n\n    # Test suite from the problem statement.\n    # Each tuple contains: (m, l, v0, T, H, alpha, beta, u_max)\n    test_cases = [\n        (75.0, 1.0, 0.2, 0.15, 0.8, 1.0, 1e-6, 120.0),      # Case 1\n        (75.0, 1.0, 0.0, 0.15, 0.8, 1.0, 1e-6, 120.0),      # Case 2\n        (75.0, 1.0, 0.6, 0.15, 0.8, 1.0, 1e-6, 120.0),      # Case 3\n        (75.0, 1.0, 0.2, 0.0, 0.8, 1.0, 1e-6, 120.0),       # Case 4\n        (75.0, 1.0, 0.2, 0.8, 0.8, 1.0, 1e-6, 120.0),       # Case 5\n        (65.0, 0.9, -0.2, 0.1, 0.6, 0.8, 1e-3, 100.0)       # Case 6\n    ]\n\n    results = []\n    for params in test_cases:\n        u_opt = calculate_optimal_torque(*params)\n        results.append(u_opt)\n\n    # Format the results as a comma-separated list of floats rounded to six\n    # decimal places, enclosed in square brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_optimal_torque(m, l, v0, T, H, alpha, beta, u_max):\n    \"\"\"\n    Calculates the optimal APA torque for a single set of parameters.\n\n    Args:\n        m (float): Mass in kg.\n        l (float): COM height in m.\n        v0 (float): Initial COM velocity in m/s.\n        T (float): Duration of APA torque in s.\n        H (float): Evaluation horizon time in s.\n        alpha (float): Weighting on COM displacement cost.\n        beta (float): Weighting on control effort cost.\n        u_max (float): Maximum absolute ankle torque in N·m.\n    \n    Returns:\n        float: The optimal APA torque u_opt in N·m.\n    \"\"\"\n    g = 9.81  # Gravitational acceleration in m/s^2\n\n    # Natural frequency of the inverted pendulum model\n    omega = np.sqrt(g / l)\n\n    # Calculate coefficients C_u and C_v0 based on the derived solution\n    # x(H) = C_u * u + C_v0 * v0\n    C_u = (np.cosh(omega * H) - np.cosh(omega * (H - T))) / (m * g)\n    C_v0 = np.sinh(omega * H) / omega\n\n    # Calculate the unconstrained optimal torque that minimizes the cost function\n    # u_unconstrained = - (alpha * C_u * C_v0 * v0) / (alpha * C_u^2 + beta)\n    numerator = -alpha * C_u * C_v0 * v0\n    denominator = alpha * C_u**2 + beta\n\n    # The denominator is guaranteed to be positive since alpha > 0 and beta > 0.\n    # No risk of division by zero.\n    u_unconstrained = numerator / denominator\n    \n    # Apply the saturation constraint |u| <= u_max\n    u_opt = np.clip(u_unconstrained, -u_max, u_max)\n\n    return u_opt\n\nsolve()\n```"
        }
    ]
}