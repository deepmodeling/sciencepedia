{
    "hands_on_practices": [
        {
            "introduction": "Before analyzing the quality of a joint's motion, we must first understand the quantity of motion possible. This exercise guides you through deriving the planar mobility formula, a fundamental tool for predicting a system's degrees of freedom based on its structure of links and joints. Mastering this concept allows you to determine if a biomechanical model is unconstrained, fully constrained, or overconstrained, which is the foundational step in any kinematic analysis .",
            "id": "4183327",
            "problem": "A rigid foot segment is analyzed in the sagittal plane during stance. Treat the ground as a rigid link. The foot–ground system is thus a planar mechanism composed of a single moving rigid body (the foot) and the fixed ground, so the total number of links is $N=2$ when counting the ground as a link. Start from the following fundamental bases: (i) a free planar rigid body has three degrees of freedom (two translations and one rotation), and (ii) a contact modeled as a lower (full) joint (for example, an idealized sticking point contact that forbids both tangential slip and normal separation) imposes two independent scalar constraints on the planar motion of the contacting bodies, whereas a higher (half) joint (for example, an idealized line contact that forbids normal separation but permits tangential sliding along the line) imposes one independent scalar constraint on the planar motion.\n\nLet the foot–ground contact be modeled by $J_{1}$ full joints and $J_{2}$ half joints, all constraints mutually independent and holonomic, and assume the contact constraints act without frictional indeterminacy beyond what is captured by the joint idealizations. Using only the above fundamental bases, derive the mobility $M$ (the number of degrees of freedom of the mechanism) as a function of $J_{1}$ and $J_{2}$ for this $N=2$ planar mechanism, and give the final expression for $M$. Then, interpret the physical meaning of the sign and magnitude of $M$ in terms of the existence and character of the instantaneous center of rotation (ICR) of the foot with respect to the ground. Your computed $M$ must be presented as a single closed-form expression. No numerical rounding is required and no units should be included in the expression.",
            "solution": "The problem asks for the derivation of the mobility, $M$, of a planar kinematic system and an interpretation of the result in the context of the instantaneous center of rotation (ICR). The validation of the problem statement is the mandatory first step.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- The system is a rigid foot segment in the sagittal plane, interacting with the ground.\n- The system is modeled as a planar mechanism with $N=2$ links (the moving foot and the fixed ground).\n- Fundamental Basis (i): A free planar rigid body has $3$ degrees of freedom (DOF).\n- Fundamental Basis (ii): A lower (full) joint imposes $2$ independent scalar constraints. A higher (half) joint imposes $1$ independent scalar constraint.\n- The foot-ground contact is modeled by $J_1$ full joints and $J_2$ half joints.\n- All constraints are mutually independent and holonomic.\n- The task is to derive the mobility $M$ as a function of $J_1$ and $J_2$ using only the provided bases, and then to interpret the physical meaning of $M$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is based on the fundamental principles of planar kinematics, specifically the concept of degrees of freedom as determined by the number of rigid bodies and the constraints imposed by joints. This is a classic application of kinematic analysis, often formalized by Gruebler's or Kutzbach's criterion. The problem provides a self-contained set of axioms (the \"fundamental bases\") from which to derive the result. There are no scientific or factual unsoundness, no missing information for the specified task, no contradictions, and no reliance on subjective claims. The terms are well-defined within the context of mechanics.\n\n**Step 3: Verdict and Action**\nThe problem is valid. The solution process will now proceed.\n\n**Derivation of Mobility ($M$)**\n\nThe mobility, $M$, of a mechanism is the number of its degrees of freedom. It is calculated by starting with the total degrees of freedom of all moving bodies considered as free and then subtracting the number of independent constraints imposed by the joints and contacts.\n\nThe system consists of $N=2$ links: the fixed ground and the single moving foot segment. We are concerned with the motion of the foot relative to the ground.\n\nAccording to the provided Fundamental Basis (i), a single free rigid body in a plane has $3$ degrees of freedom. These typically correspond to two independent translations (e.g., along $x$ and $y$ axes) and one rotation (e.g., about the $z$-axis). Let the total unconstrained degrees of freedom of the moving link be $D_{total}$. For our single moving body, the foot, we have:\n$$D_{total} = 3$$\n\nNext, we account for the constraints imposed by the contacts with the ground. According to Fundamental Basis (ii), the problem states there are $J_1$ full joints and $J_2$ half joints.\n- Each of the $J_1$ full joints imposes $2$ independent scalar constraints.\n- Each of the $J_2$ half joints imposes $1$ independent scalar constraint.\n\nSince all constraints are stipulated to be mutually independent, the total number of constraints, $C_{total}$, is the sum of all constraints from all joints:\n$$C_{total} = 2J_1 + 1J_2 = 2J_1 + J_2$$\n\nThe mobility $M$ is the number of remaining degrees of freedom after the constraints are imposed. It is the difference between the total unconstrained degrees of freedom and the total number of independent constraints:\n$$M = D_{total} - C_{total}$$\nSubstituting the expressions for $D_{total}$ and $C_{total}$:\n$$M = 3 - (2J_1 + J_2)$$\n\nThis is the required closed-form expression for the mobility $M$ of the foot segment. This formula is a specific application of the Kutzbach criterion for planar mechanisms, $M = 3(L-1) - 2J_1 - J_2$, where $L$ is the number of links. For this problem, $L=N=2$, so $M = 3(2-1) - 2J_1 - J_2 = 3 - 2J_1 - J_2$, which confirms our derivation from the given fundamental bases.\n\n**Interpretation of Mobility ($M$) and the Instantaneous Center of Rotation (ICR)**\n\nThe sign and magnitude of the mobility $M$ determine the kinematic nature of the foot-ground system and the character of its instantaneous center of rotation.\n\n1.  **Case $M = 1$**: This occurs when $2J_1 + J_2 = 2$ (e.g., one full joint, $J_1=1$, $J_2=0$; or two half joints, $J_1=0$, $J_2=2$).\n    The mechanism has exactly one degree of freedom. This means the motion of the foot is constrained to a unique, well-defined path at every instant. For any non-zero rate of motion, there exists a unique point on the planar body (or its extension) that has zero instantaneous velocity. This point is the instantaneous center of rotation (ICR). The motion of the foot at that instant is a pure rotation about this ICR. The location of the ICR is determined geometrically by the constraints. For example, with one full joint (a fixed pivot), the ICR is located at the center of the joint.\n\n2.  **Case $M = 0$**: This occurs when $2J_1 + J_2 = 3$ (e.g., one full joint and one half joint, $J_1=1$, $J_2=1$).\n    The mechanism has zero degrees of freedom. This means it is a statically determinate structure, or a \"just-rigid\" frame. The foot is kinematically locked to the ground at that instant; no motion is possible without violating the constraints or deforming the body (which is assumed rigid). Since all velocities must be zero, the concept of a unique center of *rotation* is not meaningful.\n\n3.  **Case $M < 0$**: This occurs when $2J_1 + J_2 > 3$ (e.g., two full joints, $J_1=2$, $J_2=0$).\n    The mechanism has negative degrees of freedom. This indicates that the system is overconstrained and statically indeterminate. Not only is motion impossible, but the constraints may be redundant or geometrically incompatible, potentially generating internal pre-stresses within the system. The magnitude $|M|$ represents the degree of statical indeterminacy. As with the $M=0$ case, no motion is possible, and the concept of an ICR is irrelevant.\n\n4.  **Case $M > 1$**: This occurs when $2J_1 + J_2 < 2$ (e.g., one half joint, $J_1=0$, $J_2=1$, giving $M=2$; or no joints, $J_1=0$, $J_2=0$, giving $M=3$).\n    The mechanism has multiple degrees of freedom. The motion of the foot is not restricted to a single, constraint-defined path. An ICR can still be defined for any specific instantaneous motion, but its location is not uniquely determined by the joint geometry alone. The ICR's position will depend on the particular combination of the independent motions occurring at that instant (i.e., the ratio of translational and rotational velocities). For example, with $M=2$, the foot can simultaneously translate and rotate independently, and the ICR's location will change depending on how these two motions are combined.",
            "answer": "$$\n\\boxed{M = 3 - (2J_1 + J_2)}\n$$"
        },
        {
            "introduction": "While the mobility formula tells us how many ways a body can move, the Instantaneous Center of Rotation (ICR) tells us *how* it is moving at a specific moment. Any complex planar motion can be described as a pure rotation about a single point, the ICR. This practice provides a concrete, hands-on calculation to locate the ICR using velocity data from two points on a rigid body, a common task in motion analysis, and asks you to interpret the physical meaning of a distant ICR .",
            "id": "4183357",
            "problem": "A planar rigid-body description of the forearm is considered during a horizontal reach task with slight elbow flexion and shoulder protraction, so that the motion stays within a single anatomical plane. Let the proximal point at the elbow be denoted by $E$ with planar coordinates $r_E = (0,\\,0)$ in meters, and the distal point at the wrist be denoted by $W$ with planar coordinates $r_W = (0.30,\\,0)$ in meters (forearm length $0.30\\,\\text{m}$). At a particular instant, the measured planar velocities of these points in the laboratory frame are\n$v_E = (0.40,\\,0.00)\\,\\text{m}\\,\\text{s}^{-1}$ and $v_W = (0.40,\\,0.04)\\,\\text{m}\\,\\text{s}^{-1}$. Assume the forearm behaves as a rigid body in the plane at this instant, and that the combined joint motions realize planar rigid-body motion with three degrees of freedom (two translations and one rotation).\n\nUse only core definitions of planar rigid-body kinematics and the definition of the Instantaneous Center of Rotation (ICR) — the ICR is the point in the plane whose instantaneous velocity is zero, and rigid-body planar velocity fields are perpendicular to the radius from the ICR and proportional to angular velocity — to determine the ICR location and interpret the physical meaning when the ICR lies outside the anatomical segment.\n\nWhich option correctly identifies the ICR location and gives the most accurate interpretation of its physical meaning for this task?\n\nA. The ICR is at $(0,\\,3.00)\\,\\text{m}$; this indicates instantaneous rotation about a distant center. The large distance implies a small instantaneous angular velocity relative to translational velocity, so the segment motion is near-translation dominated by shoulder-induced translation with slight elbow rotation, fully consistent with planar rigid-body motion and the available degrees of freedom.\n\nB. The ICR is at $(0,\\,-3.00)\\,\\text{m}$; the distant ICR location implies the forearm is deforming rather than moving rigidly, so the planar rigid-body assumption is invalid.\n\nC. The ICR is at $(0.30,\\,0)\\,\\text{m}$ (the wrist); this indicates pure rotation about the wrist, and the translational motion of the elbow is negligible.\n\nD. The ICR is at $(0,\\,0)\\,\\text{m}$ (the elbow); because elbow flexion is active, the motion is dominated by a single rotational degree of freedom, and the forearm cannot have an ICR outside the segment when the elbow is the primary driver.\n\nE. The ICR is at infinity; since the velocities of $E$ and $W$ are nearly equal, the motion is effectively pure translation, and any finite ICR estimate is an artifact of measurement noise.",
            "solution": "The user has requested a rigorous validation of the problem statement, followed by a detailed solution and evaluation of all options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **System**: A planar rigid-body description of a forearm.\n- **Points and Coordinates**:\n    - Proximal point (elbow), $E$: $r_E = (0,\\,0)\\,\\text{m}$.\n    - Distal point (wrist), $W$: $r_W = (0.30,\\,0)\\,\\text{m}$.\n- **Forearm Length**: The distance between $E$ and $W$ is $L = 0.30\\,\\text{m}$.\n- **Instantaneous Velocities**:\n    - $v_E = (0.40,\\,0.00)\\,\\text{m}\\,\\text{s}^{-1}$.\n    - $v_W = (0.40,\\,0.04)\\,\\text{m}\\,\\text{s}^{-1}$.\n- **Assumptions**:\n    1. The forearm is a rigid body in the plane at the considered instant.\n    2. The motion is a planar rigid-body motion with three degrees of freedom ($2$ translations, $1$ rotation).\n- **Definitions**:\n    - The Instantaneous Center of Rotation (ICR) is the point in the plane with zero instantaneous velocity.\n    - Velocity vectors of points on the rigid body are perpendicular to the radius from the ICR and proportional to the angular velocity.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement must be evaluated for scientific soundness, consistency, and well-posedness.\n\n1.  **Scientific Groundedness**: The problem is based on the principles of planar rigid-body kinematics, a fundamental topic in classical mechanics and biomechanics. The concept of the Instantaneous Center of Rotation (ICR) is a standard tool for analyzing such motion. The given values for forearm length and velocities are physiologically realistic for a human reaching task. The problem is scientifically sound.\n\n2.  **Consistency of the Rigid-Body Assumption**: For a rigid body, the distance between any two points must remain constant. This implies that the relative velocity vector of two points must be perpendicular to the position vector connecting them. Let's verify this for points $E$ and $W$.\n    - The position vector from $E$ to $W$ is $r_{W/E} = r_W - r_E = (0.30,\\,0)\\,\\text{m} - (0,\\,0)\\,\\text{m} = (0.30,\\,0)\\,\\text{m}$.\n    - The relative velocity of $W$ with respect to $E$ is $v_{W/E} = v_W - v_E = (0.40,\\,0.04)\\,\\text{m}\\,\\text{s}^{-1} - (0.40,\\,0.00)\\,\\text{m}\\,\\text{s}^{-1} = (0,\\,0.04)\\,\\text{m}\\,\\text{s}^{-1}$.\n    - To check for perpendicularity, their dot product must be zero:\n        $$r_{W/E} \\cdot v_{W/E} = (0.30, 0) \\cdot (0, 0.04) = (0.30)(0) + (0)(0.04) = 0$$\n    The condition is satisfied. The given velocity data is perfectly consistent with the rigid-body assumption.\n\n3.  **Well-Posedness**: The problem provides the velocities of two distinct points on a planar rigid body. This is sufficient information to uniquely determine the angular velocity $\\omega$ and the location of the ICR, provided the motion is not a pure translation. Since $v_E \\neq v_W$, the motion is not a pure translation, and a unique, finite ICR must exist. The problem is well-posed.\n\n4.  **Objectivity and Clarity**: The problem uses precise, quantitative language and avoids ambiguity or subjective statements.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically sound, internally consistent, and well-posed. It is a valid problem. The solution process may proceed.\n\n### Derivation of the Solution\n\nThe Instantaneous Center of Rotation (ICR) is a point $r_{ICR} = (x_{ICR},\\,y_{ICR})$ with an instantaneous velocity of zero. The velocity $v_P$ of any point $P$ on the rigid body is given by the relation $v_P = \\vec{\\omega} \\times (r_P - r_{ICR})$, where $\\vec{\\omega} = \\omega \\hat{k}$ is the angular velocity vector for planar motion in the $xy$-plane.\n\nIn component form, this relation is:\n$v_{P,x} = -\\omega (y_P - y_{ICR})$\n$v_{P,y} = \\omega (x_P - x_{ICR})$\n\nLet the ICR be at $(x, y)$. We apply this relationship to the given points $E$ and $W$.\n\nFor point $E$ at $r_E = (0,\\,0)$ with velocity $v_E = (0.40,\\,0.00)\\,\\text{m}\\,\\text{s}^{-1}$:\n$v_{E,x} = 0.40 = -\\omega (0 - y) \\implies 0.40 = \\omega y \\quad (1)$\n$v_{E,y} = 0.00 = \\omega (0 - x) \\implies 0 = -\\omega x \\quad (2)$\n\nFor point $W$ at $r_W = (0.30,\\,0)$ with velocity $v_W = (0.40,\\,0.04)\\,\\text{m}\\,\\text{s}^{-1}$:\n$v_{W,x} = 0.40 = -\\omega (0 - y) \\implies 0.40 = \\omega y \\quad (3)$\n$v_{W,y} = 0.04 = \\omega (0.30 - x) \\quad (4)$\n\nFrom equation $(2)$, since we know that $\\omega \\neq 0$ (because $v_E \\neq v_W$), it must be that $x=0$. The ICR lies on the $y$-axis.\n\nSubstituting $x=0$ into equation $(4)$:\n$0.04 = \\omega(0.30 - 0) = 0.30 \\omega$\nWe can now solve for the angular velocity $\\omega$:\n$$\\omega = \\frac{0.04}{0.30} = \\frac{4}{30} = \\frac{2}{15}\\,\\text{rad}\\,\\text{s}^{-1}$$\nThe positive sign indicates a counter-clockwise rotation.\n\nNow, we use equation $(1)$ to find the $y$-coordinate of the ICR:\n$0.40 = \\omega y \\implies y = \\frac{0.40}{\\omega} = \\frac{0.40}{2/15} = \\frac{4/10}{2/15} = \\frac{2}{5} \\times \\frac{15}{2} = 3$\n\nTherefore, the location of the ICR is $r_{ICR} = (0,\\,3.00)\\,\\text{m}$.\n\n**Interpretation**\nThe ICR is at $(0,\\,3.00)\\,\\text{m}$, which is located far from the anatomical segment of the forearm (which spans from $(0,\\,0)$ to $(0.30,\\,0)$). An ICR located outside the body segment is a common and expected result for general planar motion, which is a combination of translation and rotation.\n\nThe motion can be decomposed into a translation of the entire segment and a rotation about a point on the segment. For instance, we can consider the motion as a translation with velocity $v_E = (0.40,\\,0.00)\\,\\text{m}\\,\\text{s}^{-1}$ plus a rotation about the elbow $E$. The velocity component due to this rotation at the wrist $W$ is $v_{W/E} = v_W - v_E = (0,\\,0.04)\\,\\text{m}\\,\\text{s}^{-1}$.\n\nThe magnitude of the translational velocity is $|v_E| = 0.40\\,\\text{m}\\,\\text{s}^{-1}$, while the magnitude of the velocity difference across the segment due to rotation is $|v_{W/E}| = 0.04\\,\\text{m}\\,\\text{s}^{-1}$. The translational component is much larger, indicating that the motion is dominated by translation. A distant ICR is a kinematic signature of translation-dominated motion, as a large radius of rotation ($d=3.00\\,\\text{m}$) is required to produce a significant translational velocity ($v=0.40\\,\\text{m}\\,\\text{s}^{-1}$) with a small angular velocity ($\\omega = 2/15 \\approx 0.133\\,\\text{rad}\\,\\text{s}^{-1}$). This kinematic picture is consistent with the biomechanical description of a reaching task involving shoulder protraction (causing translation of the elbow) and only slight elbow flexion (causing a small rotation).\n\n### Option-by-Option Analysis\n\n**A. The ICR is at $(0,\\,3.00)\\,\\text{m}$; this indicates instantaneous rotation about a distant center. The large distance implies a small instantaneous angular velocity relative to translational velocity, so the segment motion is near-translation dominated by shoulder-induced translation with slight elbow rotation, fully consistent with planar rigid-body motion and the available degrees of freedom.**\n- **ICR Location**: $(0,\\,3.00)\\,\\text{m}$. This matches our calculation.\n- **Interpretation**: This interpretation is fully consistent with our analysis. The distant ICR correctly signifies a motion that is primarily translational, with a small rotational component. The biomechanical description provided is a plausible explanation for such kinematics. The statement correctly affirms consistency with the rigid-body model.\n- **Verdict**: **Correct**.\n\n**B. The ICR is at $(0,\\,-3.00)\\,\\text{m}$; the distant ICR location implies the forearm is deforming rather than moving rigidly, so the planar rigid-body assumption is invalid.**\n- **ICR Location**: $(0,\\,-3.00)\\,\\text{m}$. This location is incorrect; the sign of the $y$-coordinate is wrong.\n- **Interpretation**: The core assertion that a distant ICR implies non-rigid deformation is fundamentally false. A distant ICR is a characteristic feature of rigid-body motion that is nearly pure translation. Our validation step explicitly confirmed the data is consistent with the rigid-body assumption.\n- **Verdict**: **Incorrect**.\n\n**C. The ICR is at $(0.30,\\,0)\\,\\text{m}$ (the wrist); this indicates pure rotation about the wrist, and the translational motion of the elbow is negligible.**\n- **ICR Location**: $(0.30,\\,0)\\,\\text{m}$. This is the location of the wrist, $W$. This is incorrect.\n- **Interpretation**: If the ICR were at the wrist, the velocity of the wrist, $v_W$, would be zero. The problem states $v_W = (0.40,\\,0.04)\\,\\text{m}\\,\\text{s}^{-1}$, which is non-zero. The premise is false.\n- **Verdict**: **Incorrect**.\n\n**D. The ICR is at $(0,\\,0)\\,\\text{m}$ (the elbow); because elbow flexion is active, the motion is dominated by a single rotational degree of freedom, and the forearm cannot have an ICR outside the segment when the elbow is the primary driver.**\n- **ICR Location**: $(0,\\,0)\\,\\text{m}$. This is the location of the elbow, $E$. This is incorrect.\n- **Interpretation**: If the ICR were at the elbow, the velocity of the elbow, $v_E$, would be zero. The problem states $v_E = (0.40,\\,0.00)\\,\\text{m}\\,\\text{s}^{-1}$, which is non-zero. This corresponds to pure rotation about a fixed elbow joint, which is contradicted by the data. The claim that the ICR cannot be outside the segment is also false for general planar motion.\n- **Verdict**: **Incorrect**.\n\n**E. The ICR is at infinity; since the velocities of $E$ and $W$ are nearly equal, the motion is effectively pure translation, and any finite ICR estimate is an artifact of measurement noise.**\n- **ICR Location**: Infinity. This implies pure translation, i.e., $\\omega=0$ and $v_E = v_W$.\n- **Interpretation**: The given data specifies $v_E \\neq v_W$. For a formal mechanics problem, the given values must be treated as exact. Therefore, the motion is not pure translation, and the ICR is finite. While the motion is *close* to pure translation, this option incorrectly dismisses the rotational component as an artifact rather than analyzing its consequences, which is the point of the problem.\n- **Verdict**: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "This practice elevates the preceding concepts into a realistic, three-dimensional computational challenge that mirrors clinical biomechanics research. While the ICR elegantly describes 2D motion, its 3D counterpart is the Instantaneous Helical Axis (IHA), which characterizes spatial motion as a screw-like rotation and translation. You will implement a program to compute the IHA from synthetic motion capture data to assess changes in knee joint stability, bridging the gap between abstract kinematic theory and its powerful application in evaluating clinical outcomes .",
            "id": "4183349",
            "problem": "You are to implement a program that computes the gait phase–specific Instantaneous Helical Axis (IHA) of the shank segment relative to the thigh segment using synthetic motion capture data and assesses changes pre- and post–Anterior Cruciate Ligament (ACL) reconstruction to infer restored joint constraints. The fundamental biomechanical context is rigid body kinematics for the knee joint, focusing on joint degrees of freedom (DOF) and the instant center of rotation. The program must start from core definitions in rigid body motion and avoid any shortcut formulas provided directly in this prompt.\n\nFundamental base assumptions and definitions:\n- The shank and thigh are modeled as rigid bodies in three-dimensional space. The shank undergoes general spatial motion relative to the thigh.\n- The knee joint in healthy gait primarily constrains motion to flexion–extension around a approximately fixed axis, reducing out-of-plane rotations.\n- The Instantaneous Helical Axis (IHA) is defined from the instantaneous spatial velocity (twist) of a rigid body, comprising the instantaneous angular velocity and the linear velocity of a reference point.\n- The instantaneous angular velocity vector is computed from the time derivative of the relative rotation matrix, and the linear velocity is computed from the time derivative of the relative position vector.\n- Gait phases are defined over the stride fraction and evaluated independently.\n\nYour task:\n1. Generate synthetic motion capture data for the shank relative to the thigh across a full stride. The thigh coordinate frame is fixed and aligned with the laboratory frame, with the flexion–extension axis defined as the thigh’s unit vector along the $y$-axis. The shank has time-varying orientation and position relative to the thigh. The shank orientation is constructed by composing rotations about the $y$-axis (flexion–extension), $x$-axis (abduction–adduction), and $z$-axis (internal–external rotation). The shank relative position is time-varying with small translations, representing tibial displacement.\n2. Compute the instantaneous angular velocity $\\boldsymbol{\\omega}(t)$ from the rotation matrix derivative $\\dot{\\mathbf{R}}(t)$ via the relationship $\\boldsymbol{\\Omega}(t) = \\dot{\\mathbf{R}}(t)\\mathbf{R}(t)^{\\top}$, where $\\boldsymbol{\\Omega}(t)$ is a skew-symmetric matrix whose associated vector is $\\boldsymbol{\\omega}(t)$. Compute the linear velocity $\\mathbf{v}(t)$ as the time derivative of the shank origin position relative to the thigh.\n3. For each instant where $\\|\\boldsymbol{\\omega}(t)\\|$ exceeds a small threshold, define the IHA direction as the unit vector $\\mathbf{n}(t) = \\boldsymbol{\\omega}(t)/\\|\\boldsymbol{\\omega}(t)\\|$. The IHA location is the point on the axis closest to the thigh origin; however, for the purpose of assessing restored constraints in this problem, you will evaluate only the directional alignment of $\\mathbf{n}(t)$ relative to the thigh’s flexion–extension axis.\n4. Partition the stride into phases using stride fraction $\\phi \\in [0,1]$: loading response $[0,0.15]$, mid-stance $[0.15,0.5]$, terminal stance $[0.5,0.7]$, and swing $[0.7,1.0]$. For each phase, compute the root-mean-square (RMS) angular deviation between $\\mathbf{n}(t)$ and the flexion–extension axis $\\mathbf{e}_y$ (thigh $y$-axis). Use the angular deviation defined as $\\delta(t) = \\arccos(|\\mathbf{n}(t) \\cdot \\mathbf{e}_y|)$, measured in degrees.\n5. For each test case, compute the aggregated assessment metric defined as the average across phases of the difference between pre- and post-reconstruction RMS deviations: $\\Delta = \\text{mean}_{\\text{phases}} \\left( \\text{RMS}_{\\text{pre}} - \\text{RMS}_{\\text{post}} \\right)$, in degrees. Positive values indicate improved alignment and inference of restored constraints.\n\nUnits and numerical details:\n- Angles within computations must use radians. Report deviations and final outputs in degrees.\n- Positions must be in meters and time in seconds. Sampling frequency and duration will be specified.\n- An instantaneous angular velocity magnitude threshold of $10^{-3}$ radians per second must be used to filter ill-conditioned samples.\n\nTest suite specification:\nFor each test case, generate time series of $N$ samples over a stride duration $T$ seconds with stride fraction $\\phi = t/T$, $t \\in [0,T]$. Define the shank motion with:\n- Flexion–extension angle $\\theta(\\phi)$ in degrees: a smooth periodic function representative of gait.\n- Abduction–adduction angle $\\alpha(\\phi)$ in degrees: sinusoidal with specified amplitude.\n- Internal–external rotation angle $\\beta(\\phi)$ in degrees: sinusoidal with specified amplitude.\n- Translation $\\mathbf{p}(\\phi)$ in meters: small sinusoidal components.\n\nYou must implement three test cases:\n- Case 1 (happy path): $N = 501$, $T = 1.0$, $\\theta(\\phi) = 30 \\sin(2\\pi \\phi) + 20$, abduction–adduction amplitude pre $A_{\\text{pre}} = 5$ degrees, post $A_{\\text{post}} = 2$ degrees, internal–external amplitude $B = 3$ degrees, translation amplitudes $p_x(\\phi) = 0.005 \\sin(2\\pi \\phi)$, $p_y(\\phi) = 0$, $p_z(\\phi) = 0.010 \\cos(2\\pi \\phi)$.\n- Case 2 (boundary low angular rates in mid-stance): $N = 501$, $T = 1.0$, $\\theta(\\phi) = 10 \\sin(2\\pi \\phi)$, abduction–adduction amplitude pre $A_{\\text{pre}} = 4$ degrees, post $A_{\\text{post}} = 1$ degrees, internal–external amplitude $B = 2$ degrees, translation amplitudes $p_x(\\phi) = 0.003 \\sin(4\\pi \\phi)$, $p_y(\\phi) = 0$, $p_z(\\phi) = 0.008 \\cos(2\\pi \\phi)$.\n- Case 3 (no improvement): $N = 501$, $T = 1.0$, $\\theta(\\phi) = 25 \\sin(2\\pi \\phi) + 10$, abduction–adduction amplitude pre $A_{\\text{pre}} = 5$ degrees, post $A_{\\text{post}} = 5$ degrees, internal–external amplitude $B = 3$ degrees, translation amplitudes $p_x(\\phi) = 0.004 \\sin(2\\pi \\phi)$, $p_y(\\phi) = 0$, $p_z(\\phi) = 0.009 \\cos(2\\pi \\phi)$.\n\nComputational requirements:\n- Use central differences to approximate $\\dot{\\mathbf{R}}(t)$ and $\\dot{\\mathbf{p}}(t)$ at interior samples. Discard endpoints and any samples failing the angular velocity threshold.\n- Compose the shank rotation as $\\mathbf{R}(t) = \\mathbf{R}_y(\\theta(t))\\mathbf{R}_x(\\alpha(t))\\mathbf{R}_z(\\beta(t))$, where each rotation is about the corresponding axis by the specified angle in radians.\n\nOutput specification:\n- The program must produce a single line containing a comma-separated list of the aggregated assessment metric $\\Delta$ for each test case, in degrees, enclosed in square brackets, for example, \"[result1,result2,result3]\".\n- Each result must be a float. You may round to three decimal places to ensure concise reporting.\n\nNo external input is allowed. All data and parameters must be generated within the program.",
            "solution": "The problem has been validated and is deemed scientifically grounded, well-posed, and objective. It presents a clear task in computational biomechanics based on established principles of rigid body kinematics. All necessary data, functions, and constraints are provided to derive a unique, verifiable solution.\n\nThe objective is to quantify the change in knee joint stability after a simulated Anterior Cruciate Ligament (ACL) reconstruction. This is achieved by analyzing the orientation of the Instantaneous Helical Axis (IHA) of the shank relative to the thigh during a gait cycle. A healthy or successfully reconstructed knee joint is expected to exhibit motion primarily constrained to flexion-extension, resulting in an IHA that is closely aligned with the joint's flexion-extension axis.\n\nThe solution is developed algorithmically, following these principal steps:\n\n1.  **Modeling Rigid Body Motion:** The motion of the shank (rigid body $B$) relative to the thigh (rigid body $A$, with its coordinate frame considered fixed) is described by a time-dependent rotation matrix, $\\mathbf{R}(t)$, and a relative position vector, $\\mathbf{p}(t)$, of the shank's origin. The rotation is composed of three successive rotations: flexion-extension ($\\theta$) about the $y$-axis, abduction-adduction ($\\alpha$) about the $x$-axis, and internal-external rotation ($\\beta$) about the $z$-axis. The rotation matrix is therefore given by the product $\\mathbf{R}(t) = \\mathbf{R}_y(\\theta(t))\\mathbf{R}_x(\\alpha(t))\\mathbf{R}_z(\\beta(t))$. The angles $\\theta$, $\\alpha$, and $\\beta$ are provided as functions of the stride fraction $\\phi = t/T$, where $T$ is the stride duration. The functional form of the sinusoidal abduction-adduction and internal-external rotations is not explicitly defined in the problem statement. A standard and physically consistent choice for a periodic process synchronized with the gait stride is a sinusoid with the fundamental frequency of the stride. We adopt $\\alpha(\\phi) = A \\sin(2\\pi\\phi)$ and $\\beta(\\phi) = B \\sin(2\\pi\\phi)$, where $A$ and $B$ are the respective amplitudes. All angles defined in degrees are converted to radians for computation.\n\n2.  **Computing Instantaneous Angular Velocity:** The IHA is intrinsically linked to the instantaneous angular velocity vector $\\boldsymbol{\\omega}(t)$. This vector is extracted from the skew-symmetric matrix $\\boldsymbol{\\Omega}(t)$, which is defined by the fundamental kinematic relationship $\\boldsymbol{\\Omega}(t) = \\dot{\\mathbf{R}}(t)\\mathbf{R}(t)^{\\top}$. The time derivative of the rotation matrix, $\\dot{\\mathbf{R}}(t)$, is approximated numerically using a second-order central difference formula over the discrete time samples: $\\dot{\\mathbf{R}}(t_i) \\approx \\frac{\\mathbf{R}(t_{i+1}) - \\mathbf{R}(t_{i-1})}{2\\Delta t}$, where $\\Delta t$ is the sampling interval. Once $\\boldsymbol{\\Omega}(t)$ is computed at each time step $t_i$, the components of the angular velocity vector $\\boldsymbol{\\omega}(t_i) = [\\omega_x, \\omega_y, \\omega_z]^{\\top}$ are extracted using the relations $\\omega_x = \\Omega_{21}$, $\\omega_y = \\Omega_{02}$, and $\\omega_z = \\Omega_{10}$, where $\\Omega_{ij}$ are the elements of $\\boldsymbol{\\Omega}$.\n\n3.  **Determining IHA Direction and Deviation:** The direction of the IHA is given by the unit vector $\\mathbf{n}(t) = \\boldsymbol{\\omega}(t) / \\|\\boldsymbol{\\omega}(t)\\|$. This calculation is valid only when the magnitude of the angular velocity, $\\|\\boldsymbol{\\omega}(t)\\|$, is non-negligible. A threshold of $10^{-3} \\, \\text{rad/s}$ is applied to filter out instances where the axis is ill-defined. The thigh's flexion-extension axis is specified to be its local $y$-axis, represented by the unit vector $\\mathbf{e}_y = [0, 1, 0]^{\\top}$. The angular deviation $\\delta(t)$, which quantifies the misalignment of the IHA from this primary axis of rotation, is calculated as $\\delta(t) = \\arccos(|\\mathbf{n}(t) \\cdot \\mathbf{e}_y|)$. The absolute value of the dot product is used to measure the smaller angle between the two axes, disregarding their sense. The result is converted from radians to degrees for assessment.\n\n4.  **Phase-Based Aggregation:** Human gait is cyclic but non-uniform, consisting of distinct functional phases. The stride is partitioned into four phases: loading response ($\\phi \\in [0, 0.15]$), mid-stance ($\\phi \\in (0.15, 0.5]$), terminal stance ($\\phi \\in (0.5, 0.7]$), and swing ($\\phi \\in (0.7, 1.0]$). For each phase, the Root Mean Square (RMS) of the computed deviations, $\\text{RMS} = \\sqrt{\\frac{1}{M}\\sum_{i=1}^{M} \\delta_i^2}$, is calculated. This provides a single measure of IHA alignment stability for that phase. This entire process is performed for both pre-reconstruction (larger out-of-plane rotations) and post-reconstruction (smaller out-of-plane rotations) datasets.\n\n5.  **Calculating the Final Assessment Metric:** The final metric, $\\Delta$, provides an aggregate measure of improvement. It is the mean of the phase-specific differences between pre- and post-reconstruction RMS deviations:\n$$\n\\Delta = \\frac{1}{4} \\sum_{\\text{phases}} \\left( \\text{RMS}_{\\text{pre, phase}} - \\text{RMS}_{\\text{post, phase}} \\right)\n$$\nA positive value of $\\Delta$ indicates that, on average, the IHA is better aligned with the flexion-extension axis post-reconstruction, suggesting that the surgical intervention has successfully restored kinematic constraints to the knee joint. The final implementation will process each test case according to these steps to compute the corresponding $\\Delta$ value.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and assesses gait phase-specific Instantaneous Helical Axis (IHA)\n    of the shank relative to the thigh for pre- and post-ACL reconstruction scenarios.\n    \"\"\"\n    \n    # Test cases as specified in the problem statement.\n    test_cases = [\n        {\n            \"N\": 501, \"T\": 1.0, \n            \"theta_expr\": \"30 * np.sin(2 * np.pi * phi) + 20\",\n            \"A_pre\": 5.0, \"A_post\": 2.0, \"B\": 3.0,\n            \"p_exprs\": [\n                \"0.005 * np.sin(2 * np.pi * phi)\",\n                \"0.0\",\n                \"0.010 * np.cos(2 * np.pi * phi)\"\n            ]\n        },\n        {\n            \"N\": 501, \"T\": 1.0, \n            \"theta_expr\": \"10 * np.sin(2 * np.pi * phi)\",\n            \"A_pre\": 4.0, \"A_post\": 1.0, \"B\": 2.0,\n            \"p_exprs\": [\n                \"0.003 * np.sin(4 * np.pi * phi)\",\n                \"0.0\",\n                \"0.008 * np.cos(2 * np.pi * phi)\"\n            ]\n        },\n        {\n            \"N\": 501, \"T\": 1.0, \n            \"theta_expr\": \"25 * np.sin(2 * np.pi * phi) + 10\",\n            \"A_pre\": 5.0, \"A_post\": 5.0, \"B\": 3.0,\n            \"p_exprs\": [\n                \"0.004 * np.sin(2 * np.pi * phi)\",\n                \"0.0\",\n                \"0.009 * np.cos(2 * np.pi * phi)\"\n            ]\n        }\n    ]\n\n    results = []\n\n    def calculate_phase_rms_deviations(N, T, theta_expr, A_deg, B_deg, p_exprs):\n        \"\"\"\n        Calculates the RMS deviation for each gait phase for a single motion scenario.\n        \"\"\"\n        # 1. Generate Synthetic Data\n        t = np.linspace(0, T, N, endpoint=True)\n        dt = t[1] - t[0]\n        phi = t / T\n        \n        # Define angle time series in radians\n        theta = np.radians(eval(theta_expr, {\"np\": np, \"phi\": phi}))\n        alpha = np.radians(A_deg * np.sin(2 * np.pi * phi))\n        beta = np.radians(B_deg * np.sin(2 * np.pi * phi))\n\n        # 2. Compute Rotation Matrices\n        ct, st = np.cos(theta), np.sin(theta)\n        ca, sa = np.cos(alpha), np.sin(alpha)\n        cb, sb = np.cos(beta), np.sin(beta)\n        \n        R = np.zeros((N, 3, 3))\n        R[:, 0, 0] = ct * cb + st * sa * sb\n        R[:, 0, 1] = -ct * sb + st * sa * cb\n        R[:, 0, 2] = st * ca\n        R[:, 1, 0] = ca * sb\n        R[:, 1, 1] = ca * cb\n        R[:, 1, 2] = -sa\n        R[:, 2, 0] = -st * cb + ct * sa * sb\n        R[:, 2, 1] = st * sb + ct * sa * cb\n        R[:, 2, 2] = ct * ca\n        \n        # 3. Compute Angular Velocity and Deviations\n        # Use central differences, which is valid for indices 1 to N-2\n        R_dot = (R[2:] - R[:-2]) / (2 * dt)\n        R_center = R[1:-1]\n        phi_center = phi[1:-1]\n        \n        deviations = []\n        deviation_phis = []\n        omega_threshold = 1e-3\n        e_y = np.array([0., 1., 0.])\n\n        for i in range(len(R_dot)):\n            Omega = R_dot[i] @ R_center[i].T\n            omega = np.array([Omega[2, 1], Omega[0, 2], Omega[1, 0]])\n            omega_mag = np.linalg.norm(omega)\n\n            if omega_mag > omega_threshold:\n                n = omega / omega_mag\n                dot_product = np.abs(np.dot(n, e_y))\n                # Clip for numerical stability of arccos\n                deviation_rad = np.arccos(np.clip(dot_product, -1.0, 1.0))\n                deviations.append(np.rad2deg(deviation_rad))\n                deviation_phis.append(phi_center[i])\n        \n        deviations = np.array(deviations)\n        deviation_phis = np.array(deviation_phis)\n\n        # 4. Phase-based RMS calculation\n        phase_masks = [\n            (deviation_phis = 0.15),\n            (deviation_phis > 0.15)  (deviation_phis = 0.5),\n            (deviation_phis > 0.5)  (deviation_phis = 0.7),\n            (deviation_phis > 0.7)  (deviation_phis = 1.0)\n        ]\n        \n        phase_rms_list = []\n        for mask in phase_masks:\n            devs_in_phase = deviations[mask]\n            if len(devs_in_phase) > 0:\n                rms = np.sqrt(np.mean(devs_in_phase**2))\n                phase_rms_list.append(rms)\n            else:\n                phase_rms_list.append(0.0)\n        \n        return phase_rms_list\n\n    for case in test_cases:\n        # Unpack case parameters\n        N, T = case[\"N\"], case[\"T\"]\n        theta_expr = case[\"theta_expr\"]\n        A_pre, A_post = case[\"A_pre\"], case[\"A_post\"]\n        B = case[\"B\"]\n        p_exprs = case[\"p_exprs\"]\n\n        # Calculate RMS deviations for pre-reconstruction\n        rms_pre = calculate_phase_rms_deviations(N, T, theta_expr, A_pre, B, p_exprs)\n        \n        # Calculate RMS deviations for post-reconstruction\n        rms_post = calculate_phase_rms_deviations(N, T, theta_expr, A_post, B, p_exprs)\n        \n        # Compute the final aggregated metric Delta\n        rms_diffs = np.array(rms_pre) - np.array(rms_post)\n        delta = np.mean(rms_diffs)\n        \n        results.append(round(delta, 3))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}