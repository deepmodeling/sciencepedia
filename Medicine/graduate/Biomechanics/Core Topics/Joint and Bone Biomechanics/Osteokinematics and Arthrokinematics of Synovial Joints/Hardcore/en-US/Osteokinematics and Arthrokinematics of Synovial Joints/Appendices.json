{
    "hands_on_practices": [
        {
            "introduction": "Arthrokinematic motions like rolling and gliding are not arbitrary; they are directed by the interplay of joint surface geometry and the passive constraints of soft tissues. This first exercise provides a window into this relationship by modeling the joint as a simple mechanical system. By applying the principle of minimum potential energy, you will derive the equilibrium balance between roll and glide, demonstrating how properties like capsular stiffness dictate the kinematic signature of a joint .",
            "id": "4196753",
            "problem": "A synovial joint is idealized in the sagittal plane as a convex condyle of radius $R$ articulating with a congruent concavity. An imposed small osteokinematic rotation of the distal bone by angle $\\theta$ (assume $\\theta$ is measured in radians) about its own center is decomposed arthrokinematically into a surface roll of arc length $s_{r}$ and a tangential glide (translation along the contact tangent) of magnitude $g$. The joint capsule resists tangential glide with linear stiffness $K$ (modeled as a one-dimensional linear spring opposing $g$). Inter-surface tangential slip at the contact is penalized by an elastic conformity term with stiffness $E_{c}$, representing the resistance of the congruent articular surfaces to relative sliding. Assume small deformations and linear elasticity.\n\nUse the following modeling assumptions grounded in first principles:\n- The tangential slip at the contact equals the difference between the roll-induced arc length and the glide, so that the contact slip is $\\delta = s_{r} - g$.\n- The potential energy stored in the capsule due to glide is $\\frac{1}{2} K g^{2}$.\n- The penalty energy due to contact slip is $\\frac{1}{2} E_{c} \\delta^{2}$.\n- The roll arc length is $s_{r} = R \\theta$.\n\nBy invoking Hooke’s law and the principle of minimum potential energy, perform the following:\n- Derive the glide $g^{\\ast}$ that minimizes the total potential energy for a prescribed $\\theta$.\n- Define the roll–glide ratio as $\\rho = \\frac{s_{r}}{s_{g}}$, where $s_{g}$ is the magnitude of glide used by the system at equilibrium, and express $\\rho$ as a function of $K$ and $E_{c}$.\n- Suppose pathological stiffening scales the capsular stiffness from $K$ to $\\alpha K$, where $\\alpha > 1$ is dimensionless. Compute the change in roll–glide ratio $\\Delta \\rho = \\rho(\\alpha K) - \\rho(K)$ and express it in closed form in terms of $\\alpha$, $K$, and $E_{c}$.\n\nProvide your final answer as a single analytical expression for $\\Delta \\rho$. No numerical evaluation is required, and no units are needed in the final answer.",
            "solution": "The problem is first validated against the established criteria.\n\n**Step 1: Extract Givens**\n- A synovial joint is idealized as a convex condyle of radius $R$ articulating with a congruent concavity.\n- An imposed small osteokinematic rotation of the distal bone is by angle $\\theta$ (in radians).\n- Arthrokinematic decomposition involves a surface roll of arc length $s_{r}$ and a tangential glide of magnitude $g$.\n- The joint capsule has a linear stiffness $K$ opposing glide.\n- An elastic conformity term has stiffness $E_{c}$ penalizing tangential slip.\n- The contact slip is $\\delta = s_{r} - g$.\n- The potential energy stored in the capsule is $U_{K} = \\frac{1}{2} K g^{2}$.\n- The penalty energy due to contact slip is $U_{E} = \\frac{1}{2} E_{c} \\delta^{2}$.\n- The roll arc length is $s_{r} = R \\theta$.\n- The system seeks to minimize the total potential energy.\n- The roll–glide ratio is defined as $\\rho = \\frac{s_{r}}{s_{g}}$, where $s_{g}$ is the equilibrium glide magnitude.\n- A pathological change scales capsular stiffness from $K$ to $\\alpha K$, where $\\alpha > 1$.\n- The objective is to compute the change in the roll–glide ratio, $\\Delta \\rho = \\rho(\\alpha K) - \\rho(K)$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem uses a valid, though simplified, physical model based on linear elasticity and the principle of minimum potential energy. These are standard and accepted principles in physics and biomechanical modeling. The concepts of osteokinematics, arthrokinematics, roll, and glide are fundamental to joint biomechanics. The model is scientifically sound.\n- **Well-Posed:** The problem provides a clear objective and all necessary relationships and variables to achieve it. Minimizing a quadratic potential energy function ensures a unique and stable solution exists. The problem is self-contained and mathematically well-structured.\n- **Objective:** The problem is stated using precise, formal language without subjective or ambiguous terms.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a scientifically grounded, well-posed, and objective problem in biomechanics. The solution process may proceed.\n\nThe total potential energy of the system, $U_{total}$, is the sum of the energy stored in the capsule due to glide and the penalty energy from contact slip.\n$$\nU_{total} = U_{K} + U_{E} = \\frac{1}{2} K g^{2} + \\frac{1}{2} E_{c} \\delta^{2}\n$$\nThe contact slip $\\delta$ is given as the difference between the roll arc length $s_{r}$ and the glide $g$, so $\\delta = s_{r} - g$. Substituting this into the potential energy expression gives the total potential energy as a function of the glide $g$ for a given imposed roll $s_{r}$.\n$$\nU_{total}(g) = \\frac{1}{2} K g^{2} + \\frac{1}{2} E_{c} (s_{r} - g)^{2}\n$$\nAccording to the principle of minimum potential energy, the system will adopt the glide magnitude $g^{\\ast}$ that minimizes $U_{total}(g)$. To find this minimum, we compute the first derivative of $U_{total}$ with respect to $g$ and set it to zero.\n$$\n\\frac{dU_{total}}{dg} = \\frac{d}{dg} \\left( \\frac{1}{2} K g^{2} + \\frac{1}{2} E_{c} (s_{r} - g)^{2} \\right) = 0\n$$\nUsing the chain rule for differentiation, we get:\n$$\n\\frac{dU_{total}}{dg} = K g + E_{c} (s_{r} - g) \\cdot (-1) = K g - E_{c} s_{r} + E_{c} g\n$$\nSetting the derivative to zero to find the equilibrium glide $g^{\\ast}$:\n$$\nK g^{\\ast} + E_{c} g^{\\ast} - E_{c} s_{r} = 0\n$$\n$$\ng^{\\ast} (K + E_{c}) = E_{c} s_{r}\n$$\nSolving for $g^{\\ast}$:\n$$\ng^{\\ast} = \\frac{E_{c}}{K + E_{c}} s_{r}\n$$\nTo confirm this is a minimum, we check the second derivative:\n$$\n\\frac{d^{2}U_{total}}{dg^{2}} = \\frac{d}{dg} (K g + E_{c} g - E_{c} s_{r}) = K + E_{c}\n$$\nSince $K$ and $E_{c}$ are stiffness constants, they are inherently positive ($K > 0$, $E_{c} > 0$). Therefore, $K + E_{c} > 0$, confirming that $g^{\\ast}$ corresponds to a minimum of the potential energy.\n\nNext, we derive the roll–glide ratio $\\rho$. The problem defines $\\rho = \\frac{s_{r}}{s_{g}}$, where $s_{g}$ is the equilibrium glide, which we have found to be $g^{\\ast}$. Thus, $s_{g} = g^{\\ast}$.\n$$\n\\rho = \\frac{s_{r}}{g^{\\ast}} = \\frac{s_{r}}{\\frac{E_{c}}{K + E_{c}} s_{r}}\n$$\nAssuming a non-zero rotation ($s_{r} \\neq 0$), we can cancel $s_{r}$ from the numerator and denominator:\n$$\n\\rho(K) = \\frac{1}{\\frac{E_{c}}{K + E_{c}}} = \\frac{K + E_{c}}{E_{c}}\n$$\nThis can also be written as $\\rho(K) = \\frac{K}{E_{c}} + 1$. This is the roll-glide ratio as a function of the normal capsular stiffness $K$ and the conformity stiffness $E_{c}$.\n\nNow, we consider the pathological stiffening where the capsular stiffness becomes $\\alpha K$. To find the new roll-glide ratio, $\\rho(\\alpha K)$, we substitute $\\alpha K$ for $K$ in our expression for $\\rho$:\n$$\n\\rho(\\alpha K) = \\frac{(\\alpha K) + E_{c}}{E_{c}}\n$$\nThe change in the roll-glide ratio, $\\Delta \\rho$, is the difference between the new ratio and the original ratio:\n$$\n\\Delta \\rho = \\rho(\\alpha K) - \\rho(K)\n$$\nSubstituting the expressions we derived:\n$$\n\\Delta \\rho = \\left( \\frac{\\alpha K + E_{c}}{E_{c}} \\right) - \\left( \\frac{K + E_{c}}{E_{c}} \\right)\n$$\nSince the terms have a common denominator, we can combine them:\n$$\n\\Delta \\rho = \\frac{(\\alpha K + E_{c}) - (K + E_{c})}{E_{c}}\n$$\n$$\n\\Delta \\rho = \\frac{\\alpha K + E_{c} - K - E_{c}}{E_{c}}\n$$\nThe $E_{c}$ terms in the numerator cancel out:\n$$\n\\Delta \\rho = \\frac{\\alpha K - K}{E_{c}}\n$$\nFinally, we factor out $K$ to obtain the closed-form expression for $\\Delta \\rho$:\n$$\n\\Delta \\rho = \\frac{K(\\alpha - 1)}{E_{c}}\n$$\nThis is the final analytical expression for the change in the roll–glide ratio in terms of $\\alpha$, $K$, and $E_{c}$.",
            "answer": "$$\n\\boxed{\\frac{K(\\alpha - 1)}{E_{c}}}\n$$"
        },
        {
            "introduction": "Beyond the influence of soft tissues, the very geometry of articulating surfaces imposes fundamental constraints on joint motion. This practice explores glide as a geometric consequence of maintaining contact between two surfaces with mismatched curvature during rotation. You will first derive the mathematical relationship between surface curvature and glide, and then perform a first-order sensitivity analysis to quantify how measurement uncertainty, a common challenge when working with medical imaging data, propagates into your kinematic model .",
            "id": "4196713",
            "problem": "A planar convex-on-concave synovial joint is modeled locally at the contact by osculating circles whose radii are the reciprocals of the principal curvatures along the motion plane. Let the moving convex surface have principal curvature $\\kappa_{1}$ and the stationary concave surface have principal curvature $\\kappa_{2}$. During a small osteokinematic rotation of the moving segment by angle $\\theta$ about an axis orthogonal to the plane of motion, the joint maintains continuous contact without separation or penetration. The osteokinematic rotation angle is measured in radians. Assume that the arthrokinematic glide along the tangent direction arises from the geometric necessity to reconcile differences in surface arc-length traversal due to curvature mismatch.\n\nMagnetic Resonance Imaging (MRI)-based segmentation provides curvature estimates with small errors. Let the true curvatures be $\\kappa_{1} = 0.040\\ \\mathrm{mm}^{-1}$ and $\\kappa_{2} = 0.030\\ \\mathrm{mm}^{-1}$, and let the osteokinematic rotation be $\\theta = 0.25$ radians. Suppose the imaging-based estimation errors satisfy $|\\delta \\kappa_{1}| \\leq 2.0 \\times 10^{-3}\\ \\mathrm{mm}^{-1}$ and $|\\delta \\kappa_{2}| \\leq 1.5 \\times 10^{-3}\\ \\mathrm{mm}^{-1}$.\n\nStarting only from the arc-length relation $s = R \\theta$ and the definition of curvature $\\kappa = 1/R$, derive a first-order (linearized) expression for the sensitivity of the arthrokinematic glide magnitude to small errors $\\delta \\kappa_{1}$ and $\\delta \\kappa_{2}$. Using this expression, compute the worst-case absolute error in the predicted glide magnitude due to the curvature estimation errors, treating $\\delta \\kappa_{1}$ and $\\delta \\kappa_{2}$ as independent and choosing their signs to maximize the absolute glide error. Round your final answer to four significant figures. Express your final answer in millimeters.",
            "solution": "The problem is first validated and found to be scientifically grounded, well-posed, and internally consistent. We can therefore proceed with the derivation and calculation.\n\nThe problem models a planar convex-on-concave synovial joint using osculating circles. The moving convex surface has a principal curvature $\\kappa_{1}$ and the stationary concave surface has a principal curvature $\\kappa_{2}$. The corresponding radii of curvature are $R_{1} = 1/\\kappa_{1}$ and $R_{2} = 1/\\kappa_{2}$. For a convex surface to fit into a concave one, it is necessary that $R_{2} > R_{1}$, which implies $\\kappa_{1} > \\kappa_{2}$. The given values, $\\kappa_{1} = 0.040\\ \\mathrm{mm}^{-1}$ and $\\kappa_{2} = 0.030\\ \\mathrm{mm}^{-1}$, satisfy this condition.\n\nThe arthrokinematic glide is stated to arise from the geometric necessity to reconcile differences in surface arc-length traversal. During an osteokinematic rotation of angle $\\theta$, the arc length traced on the moving convex surface is $s_{1} = R_{1}\\theta$, and the arc length traced on the stationary concave surface is $s_{2} = R_{2}\\theta$. The arthrokinematic glide, $G$, is the difference between these two arc lengths.\n\n$$G = s_{2} - s_{1} = (R_{2} - R_{1})\\theta$$\n\nSubstituting the definitions of curvature, $R_{1} = 1/\\kappa_{1}$ and $R_{2} = 1/\\kappa_{2}$, we express the glide $G$ as a function of the curvatures $\\kappa_{1}$ and $\\kappa_{2}$:\n\n$$G(\\kappa_{1}, \\kappa_{2}) = \\left(\\frac{1}{\\kappa_{2}} - \\frac{1}{\\kappa_{1}}\\right)\\theta$$\n\nTo find the first-order sensitivity of the glide magnitude to small errors $\\delta\\kappa_{1}$ and $\\delta\\kappa_{2}$, we compute the total differential of $G$. The error in $G$, denoted $\\delta G$, is approximated by this differential:\n\n$$\\delta G \\approx dG = \\frac{\\partial G}{\\partial \\kappa_{1}} \\delta\\kappa_{1} + \\frac{\\partial G}{\\partial \\kappa_{2}} \\delta\\kappa_{2}$$\n\nFirst, we calculate the partial derivatives of $G$ with respect to $\\kappa_{1}$ and $\\kappa_{2}$. The angle $\\theta$ is treated as a constant.\n\n$$\\frac{\\partial G}{\\partial \\kappa_{1}} = \\frac{\\partial}{\\partial \\kappa_{1}} \\left[ \\left(\\frac{1}{\\kappa_{2}} - \\frac{1}{\\kappa_{1}}\\right)\\theta \\right] = \\theta \\frac{\\partial}{\\partial \\kappa_{1}} (-\\kappa_{1}^{-1}) = \\theta(-(-1)\\kappa_{1}^{-2}) = \\frac{\\theta}{\\kappa_{1}^{2}}$$\n\n$$\\frac{\\partial G}{\\partial \\kappa_{2}} = \\frac{\\partial}{\\partial \\kappa_{2}} \\left[ \\left(\\frac{1}{\\kappa_{2}} - \\frac{1}{\\kappa_{1}}\\right)\\theta \\right] = \\theta \\frac{\\partial}{\\partial \\kappa_{2}} (\\kappa_{2}^{-1}) = \\theta(-1\\cdot\\kappa_{2}^{-2}) = -\\frac{\\theta}{\\kappa_{2}^{2}}$$\n\nSubstituting these partial derivatives back into the expression for $\\delta G$ gives the linearized sensitivity expression:\n\n$$\\delta G = \\left(\\frac{\\theta}{\\kappa_{1}^{2}}\\right) \\delta\\kappa_{1} - \\left(\\frac{\\theta}{\\kappa_{2}^{2}}\\right) \\delta\\kappa_{2}$$\n\nThe problem asks for the worst-case absolute error in the predicted glide magnitude. This corresponds to the maximum possible value of $|\\delta G|$. We are given the bounds on the curvature errors: $|\\delta\\kappa_{1}| \\leq \\Delta\\kappa_{1}$ and $|\\delta\\kappa_{2}| \\leq \\Delta\\kappa_{2}$. Using the triangle inequality, we can establish an upper bound for $|\\delta G|$:\n\n$$|\\delta G| = \\left| \\left(\\frac{\\theta}{\\kappa_{1}^{2}}\\right) \\delta\\kappa_{1} - \\left(\\frac{\\theta}{\\kappa_{2}^{2}}\\right) \\delta\\kappa_{2} \\right| \\leq \\left| \\frac{\\theta}{\\kappa_{1}^{2}} \\delta\\kappa_{1} \\right| + \\left| -\\frac{\\theta}{\\kappa_{2}^{2}} \\delta\\kappa_{2} \\right| = \\frac{\\theta}{\\kappa_{1}^{2}}|\\delta\\kappa_{1}| + \\frac{\\theta}{\\kappa_{2}^{2}}|\\delta\\kappa_{2}|$$\n\nThe worst-case (maximum) absolute error, $|\\delta G|_{max}$, occurs when $|\\delta\\kappa_{1}|$ and $|\\delta\\kappa_{2}|$ are at their maximum values, $\\Delta\\kappa_{1}$ and $\\Delta\\kappa_{2}$ respectively. This scenario is realized by choosing the signs of $\\delta\\kappa_{1}$ and $\\delta\\kappa_{2}$ to be opposite, which makes the two terms in the expression for $\\delta G$ add constructively.\n\n$$|\\delta G|_{max} = \\frac{\\theta}{\\kappa_{1}^{2}}\\Delta\\kappa_{1} + \\frac{\\theta}{\\kappa_{2}^{2}}\\Delta\\kappa_{2} = \\theta \\left( \\frac{\\Delta\\kappa_{1}}{\\kappa_{1}^{2}} + \\frac{\\Delta\\kappa_{2}}{\\kappa_{2}^{2}} \\right)$$\n\nNow, we substitute the given numerical values:\n$\\theta = 0.25$\n$\\kappa_{1} = 0.040\\ \\mathrm{mm}^{-1}$\n$\\kappa_{2} = 0.030\\ \\mathrm{mm}^{-1}$\n$\\Delta\\kappa_{1} = 2.0 \\times 10^{-3}\\ \\mathrm{mm}^{-1}$\n$\\Delta\\kappa_{2} = 1.5 \\times 10^{-3}\\ \\mathrm{mm}^{-1}$\n\n$$|\\delta G|_{max} = 0.25 \\left( \\frac{2.0 \\times 10^{-3}}{(0.040)^{2}} + \\frac{1.5 \\times 10^{-3}}{(0.030)^{2}} \\right)$$\n\nLet's evaluate the terms inside the parentheses. The units will be $(\\mathrm{mm}^{-1}) / (\\mathrm{mm}^{-2}) = \\mathrm{mm}$.\n\n$$\\frac{2.0 \\times 10^{-3}}{ (4.0 \\times 10^{-2})^{2}} = \\frac{2.0 \\times 10^{-3}}{16.0 \\times 10^{-4}} = \\frac{2.0}{1.6} = 1.25\\ \\mathrm{mm}$$\n\n$$\\frac{1.5 \\times 10^{-3}}{(3.0 \\times 10^{-2})^{2}} = \\frac{1.5 \\times 10^{-3}}{9.0 \\times 10^{-4}} = \\frac{1.5}{0.9} = \\frac{15}{9} = \\frac{5}{3}\\ \\mathrm{mm}$$\n\nNow, we sum these terms and multiply by $\\theta$:\n\n$$|\\delta G|_{max} = 0.25 \\left( 1.25 + \\frac{5}{3} \\right) = \\frac{1}{4} \\left( \\frac{5}{4} + \\frac{5}{3} \\right)$$\n\nTo add the fractions, we find a common denominator:\n\n$$|\\delta G|_{max} = \\frac{1}{4} \\left( \\frac{5 \\times 3}{12} + \\frac{5 \\times 4}{12} \\right) = \\frac{1}{4} \\left( \\frac{15 + 20}{12} \\right) = \\frac{1}{4} \\left( \\frac{35}{12} \\right) = \\frac{35}{48}\\ \\mathrm{mm}$$\n\nFinally, we compute the decimal value and round to four significant figures:\n\n$$|\\delta G|_{max} = \\frac{35}{48} \\approx 0.7291666... \\mathrm{mm}$$\n\nRounding to four significant figures, we get $0.7292\\ \\mathrm{mm}$.",
            "answer": "$$\n\\boxed{0.7292}\n$$"
        },
        {
            "introduction": "Our final practice moves from analytical derivation to computational synthesis, a cornerstone of modern biomechanical modeling. Here, you will build and solve a constrained inverse kinematics problem for a multi-joint limb, integrating the principles of osteo- and arthrokinematics explored previously. The challenge is to find joint configurations that achieve a target end-effector pose while simultaneously respecting the physiological constraints of the system, such as roll-glide coupling and range of motion limits .",
            "id": "4196783",
            "problem": "Consider a planar two-segment limb whose joints are modeled as synovial joints exhibiting coupled osteokinematic rotation and arthrokinematic accessory translation. The limb is anchored at a fixed base at the origin of a two-dimensional Cartesian coordinate system. The proximal segment has length $L_1$ and the distal segment has length $L_2$. Each joint $i \\in \\{1,2\\}$ has an osteokinematic rotation angle $\\theta_i$ (in radians) and an arthrokinematic accessory translation $s_i$ (in meters) along the local tangential direction of the joint contact. The accessory translation is constrained by a linear roll-glide coupling derived from contact geometry: $s_i = \\sigma_i \\kappa_i R_i \\theta_i$, where $R_i$ is the effective joint surface radius (in meters), $\\kappa_i$ is a dimensionless roll-glide ratio, and $\\sigma_i \\in \\{-1,+1\\}$ encodes the convex-on-concave ($-1$) or concave-on-convex ($+1$) contact sign convention.\n\nThe limb kinematics are defined by rigid body transformations. Let $R(\\theta)$ denote the planar rotation matrix\n$$\nR(\\theta) = \\begin{bmatrix}\n\\cos\\theta & -\\sin\\theta \\\\\n\\sin\\theta & \\cos\\theta\n\\end{bmatrix}.\n$$\nUnder the assumption that accessory translation at each joint occurs along the local $x$-axis after rotation (tangential to the contact), the end-effector (hand) position $\\mathbf{p}(\\theta_1,\\theta_2,s_1,s_2) \\in \\mathbb{R}^2$ is given by\n$$\n\\mathbf{p}(\\theta_1,\\theta_2,s_1,s_2) = R(\\theta_1)\\left(\\begin{bmatrix}s_1 + L_1 \\\\ 0\\end{bmatrix} + R(\\theta_2)\\begin{bmatrix}s_2 + L_2 \\\\ 0\\end{bmatrix}\\right).\n$$\nThe end-effector orientation (in radians) is\n$$\n\\phi(\\theta_1,\\theta_2) = \\theta_1 + \\theta_2.\n$$\n\nGiven a target pose specified by a target position $\\mathbf{p}_{\\mathrm{t}} = \\begin{bmatrix}p_x \\\\ p_y\\end{bmatrix}$ (in meters) and target orientation $\\psi_{\\mathrm{t}}$ (in radians), formulate an inverse kinematics problem that minimizes the pose error while enforcing arthrokinematic feasibility via equality constraints. The error to be minimized is\n$$\nE(\\theta_1,\\theta_2,s_1,s_2) = w_{\\mathrm{pos}}\\left\\|\\mathbf{p}(\\theta_1,\\theta_2,s_1,s_2) - \\mathbf{p}_{\\mathrm{t}}\\right\\|_2^2 + w_{\\mathrm{ori}}\\left(\\ell_{\\mathrm{eq}}(\\phi(\\theta_1,\\theta_2) - \\psi_{\\mathrm{t}})\\right)^2,\n$$\nwhere $w_{\\mathrm{pos}}$ and $w_{\\mathrm{ori}}$ are nonnegative weights, and $\\ell_{\\mathrm{eq}}$ (in meters per radian) is a length scale used to map orientation error in radians to an equivalent arc-length scale so that the two error terms are commensurate in units.\n\nSubject to:\n- Equality constraints (arthrokinematic feasibility):\n$$\ng_1(\\theta_1,s_1) = s_1 - \\sigma_1 \\kappa_1 R_1 \\theta_1 = 0, \\quad g_2(\\theta_2,s_2) = s_2 - \\sigma_2 \\kappa_2 R_2 \\theta_2 = 0.\n$$\n- Joint angle bounds representing physiological range of motion:\n$$\n\\theta_1^{\\min} \\le \\theta_1 \\le \\theta_1^{\\max}, \\quad \\theta_2^{\\min} \\le \\theta_2 \\le \\theta_2^{\\max}.\n$$\n- Accessory translation bounds representing capsuloligamentous feasibility:\n$$\n|s_1| \\le s_1^{\\max}, \\quad |s_2| \\le s_2^{\\max}.\n$$\n\nUse the following parameter values for the limb and constraints:\n- Segment lengths: $L_1 = 0.30\\,\\mathrm{m}$, $L_2 = 0.25\\,\\mathrm{m}$.\n- Joint contact geometry and roll-glide parameters: $R_1 = 0.020\\,\\mathrm{m}$, $R_2 = 0.015\\,\\mathrm{m}$; $\\kappa_1 = 0.60$, $\\kappa_2 = 0.40$; $\\sigma_1 = -1$, $\\sigma_2 = -1$.\n- Range of motion bounds (radians): $\\theta_1^{\\min} = -\\frac{\\pi}{2}$, $\\theta_1^{\\max} = \\frac{\\pi}{2}$; $\\theta_2^{\\min} = 0$, $\\theta_2^{\\max} = \\frac{3\\pi}{4}$.\n- Accessory translation bounds: $s_1^{\\max} = 0.030\\,\\mathrm{m}$, $s_2^{\\max} = 0.030\\,\\mathrm{m}$.\n- Error weights and equivalent length scale: $w_{\\mathrm{pos}} = 1.0$, $w_{\\mathrm{ori}} = 1.0$, $\\ell_{\\mathrm{eq}} = 0.10\\,\\mathrm{m}/\\mathrm{rad}$.\n\nImplement a program that, for each test case below, solves the optimization problem, returns whether the solution is arthrokinematically feasible (i.e., the equality constraints are satisfied within a tolerance of $10^{-6}$ and all bounds are respected), and computes the final end-effector position error $\\left\\|\\mathbf{p} - \\mathbf{p}_{\\mathrm{t}}\\right\\|_2$ in meters.\n\nAngle units must be in radians throughout. All position results must be expressed in meters. The final error must be returned in meters as a floating-point number.\n\nTest suite (targets):\n1. Happy path: $\\mathbf{p}_{\\mathrm{t}} = \\begin{bmatrix}0.40 \\\\ 0.10\\end{bmatrix}\\,\\mathrm{m}$, $\\psi_{\\mathrm{t}} = 1.00\\,\\mathrm{rad}$.\n2. Boundary reach: $\\mathbf{p}_{\\mathrm{t}} = \\begin{bmatrix}0.55 \\\\ 0.00\\end{bmatrix}\\,\\mathrm{m}$, $\\psi_{\\mathrm{t}} = 0.00\\,\\mathrm{rad}$.\n3. Unreachable target: $\\mathbf{p}_{\\mathrm{t}} = \\begin{bmatrix}0.70 \\\\ 0.00\\end{bmatrix}\\,\\mathrm{m}$, $\\psi_{\\mathrm{t}} = 0.00\\,\\mathrm{rad}$.\n4. Orientation-challenging: $\\mathbf{p}_{\\mathrm{t}} = \\begin{bmatrix}0.20 \\\\ 0.35\\end{bmatrix}\\,\\mathrm{m}$, $\\psi_{\\mathrm{t}} = 2.00\\,\\mathrm{rad}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where results for each test case are output in sequence as a boolean followed by a float for the position error in meters. For the four test cases, the final output must be of the form\n$$\n[\\text{b}_1,\\text{e}_1,\\text{b}_2,\\text{e}_2,\\text{b}_3,\\text{e}_3,\\text{b}_4,\\text{e}_4],\n$$\nwhere each $\\text{b}_i$ is either $\\text{True}$ or $\\text{False}$, and each $\\text{e}_i$ is a floating-point number in meters.",
            "solution": "The problem is assessed to be **valid**. It presents a well-posed, scientifically grounded, and objective constrained optimization problem in the field of biomechanics. The formulation is self-contained, and the provided parameters are consistent and physically realistic.\n\nThe solution proceeds by first simplifying the problem, then applying a numerical optimization method.\n\n### 1. Problem Simplification and Reformulation\n\nThe initial problem involves four optimization variables, $(\\theta_1, \\theta_2, s_1, s_2)$, and two equality constraints which define the arthrokinematic coupling:\n$$g_1(\\theta_1,s_1) = s_1 - \\sigma_1 \\kappa_1 R_1 \\theta_1 = 0$$\n$$g_2(\\theta_2,s_2) = s_2 - \\sigma_2 \\kappa_2 R_2 \\theta_2 = 0$$\n\nThese constraints can be used to eliminate the accessory translation variables $s_1$ and $s_2$. Let us define the coupling coefficients $C_i = \\sigma_i \\kappa_i R_i$ for $i \\in \\{1, 2\\}$.\nUsing the given parameter values:\n- $L_1 = 0.30\\,\\mathrm{m}$, $L_2 = 0.25\\,\\mathrm{m}$\n- $R_1 = 0.020\\,\\mathrm{m}$, $R_2 = 0.015\\,\\mathrm{m}$\n- $\\kappa_1 = 0.60$, $\\kappa_2 = 0.40$\n- $\\sigma_1 = -1$, $\\sigma_2 = -1$\n\nThe coupling coefficients are calculated as:\n$$C_1 = \\sigma_1 \\kappa_1 R_1 = (-1)(0.60)(0.020\\,\\mathrm{m}) = -0.012\\,\\mathrm{m}/\\mathrm{rad}$$\n$$C_2 = \\sigma_2 \\kappa_2 R_2 = (-1)(0.40)(0.015\\,\\mathrm{m}) = -0.006\\,\\mathrm{m}/\\mathrm{rad}$$\n\nThus, the accessory translations are directly proportional to their corresponding joint angles:\n$$s_1 = C_1 \\theta_1$$\n$$s_2 = C_2 \\theta_2$$\n\nSubstituting these into the forward kinematics equation for the end-effector position $\\mathbf{p}$:\n$$ \\mathbf{p}(\\theta_1, \\theta_2) = R(\\theta_1)\\left(\\begin{bmatrix}C_1\\theta_1 + L_1 \\\\ 0\\end{bmatrix} + R(\\theta_2)\\begin{bmatrix}C_2\\theta_2 + L_2 \\\\ 0\\end{bmatrix}\\right) $$\nExpanding this expression, where $R(\\theta) = \\begin{bmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{bmatrix}$:\nFirst, the term in parentheses:\n$$ \\begin{bmatrix}C_1\\theta_1 + L_1 \\\\ 0\\end{bmatrix} + \\begin{bmatrix} \\cos\\theta_2 & -\\sin\\theta_2 \\\\ \\sin\\theta_2 & \\cos\\theta_2 \\end{bmatrix} \\begin{bmatrix}C_2\\theta_2 + L_2 \\\\ 0\\end{bmatrix} = \\begin{bmatrix}C_1\\theta_1 + L_1 \\\\ 0\\end{bmatrix} + \\begin{bmatrix}(C_2\\theta_2 + L_2)\\cos\\theta_2 \\\\ (C_2\\theta_2 + L_2)\\sin\\theta_2\\end{bmatrix} $$\n$$ = \\begin{bmatrix}C_1\\theta_1 + L_1 + (C_2\\theta_2 + L_2)\\cos\\theta_2 \\\\ (C_2\\theta_2 + L_2)\\sin\\theta_2\\end{bmatrix} $$\nNow, premultiplying by $R(\\theta_1)$:\n$$ \\mathbf{p}(\\theta_1, \\theta_2) = \\begin{bmatrix} \\cos\\theta_1 & -\\sin\\theta_1 \\\\ \\sin\\theta_1 & \\cos\\theta_1 \\end{bmatrix} \\begin{bmatrix}C_1\\theta_1 + L_1 + (C_2\\theta_2 + L_2)\\cos\\theta_2 \\\\ (C_2\\theta_2 + L_2)\\sin\\theta_2\\end{bmatrix} $$\nThe components of the position vector $\\mathbf{p} = \\begin{bmatrix}p_x \\\\ p_y\\end{bmatrix}$ are:\n$$ p_x(\\theta_1,\\theta_2) = \\cos\\theta_1(C_1\\theta_1 + L_1 + (C_2\\theta_2 + L_2)\\cos\\theta_2) - \\sin\\theta_1(C_2\\theta_2 + L_2)\\sin\\theta_2 $$\n$$ p_y(\\theta_1,\\theta_2) = \\sin\\theta_1(C_1\\theta_1 + L_1 + (C_2\\theta_2 + L_2)\\cos\\theta_2) + \\cos\\theta_1(C_2\\theta_2 + L_2)\\sin\\theta_2 $$\nUsing the angle sum identities, this simplifies to:\n$$ p_x(\\theta_1,\\theta_2) = (C_1\\theta_1 + L_1)\\cos\\theta_1 + (C_2\\theta_2 + L_2)\\cos(\\theta_1+\\theta_2) $$\n$$ p_y(\\theta_1,\\theta_2) = (C_1\\theta_1 + L_1)\\sin\\theta_1 + (C_2\\theta_2 + L_2)\\sin(\\theta_1+\\theta_2) $$\n\nThe problem is now reduced to an optimization over two variables, $\\theta_1$ and $\\theta_2$. The objective function $E(\\theta_1, \\theta_2)$ becomes:\n$$ E(\\theta_1, \\theta_2) = w_{\\mathrm{pos}}\\|\\mathbf{p}(\\theta_1,\\theta_2) - \\mathbf{p}_{\\mathrm{t}}\\|_2^2 + w_{\\mathrm{ori}}\\left(\\ell_{\\mathrm{eq}}(\\theta_1 + \\theta_2 - \\psi_{\\mathrm{t}})\\right)^2 $$\nwith $w_{\\mathrm{pos}} = 1.0$, $w_{\\mathrm{ori}} = 1.0$, and $\\ell_{\\mathrm{eq}} = 0.10\\,\\mathrm{m}/\\mathrm{rad}$.\n\n### 2. Constraint Analysis\n\nThe original constraints include bounds on both angles and translations. With the substitution, the translation bounds become bounds on the angles:\n- $|s_1| \\le s_1^{\\max} \\implies |C_1 \\theta_1| \\le s_1^{\\max} \\implies |\\theta_1| \\le \\frac{s_1^{\\max}}{|C_1|} = \\frac{0.030}{|-0.012|} = 2.5\\,\\mathrm{rad}$.\n- $|s_2| \\le s_2^{\\max} \\implies |C_2 \\theta_2| \\le s_2^{\\max} \\implies |\\theta_2| \\le \\frac{s_2^{\\max}}{|C_2|} = \\frac{0.030}{|-0.006|} = 5.0\\,\\mathrm{rad}$.\n\nWe must combine these with the physiological range of motion bounds:\n- For $\\theta_1$: The problem states $\\theta_1 \\in [-\\frac{\\pi}{2}, \\frac{\\pi}{2}] \\approx [-1.571, 1.571]\\,\\mathrm{rad}$. The translation-derived bound is $\\theta_1 \\in [-2.5, 2.5]\\,\\mathrm{rad}$. The intersection, and thus the effective bound, is $\\theta_1 \\in [-\\frac{\\pi}{2}, \\frac{\\pi}{2}]$.\n- For $\\theta_2$: The problem states $\\theta_2 \\in [0, \\frac{3\\pi}{4}] \\approx [0, 2.356]\\,\\mathrm{rad}$. The translation-derived bound is $\\theta_2 \\in [-5.0, 5.0]\\,\\mathrm{rad}$. The intersection gives the effective bound $\\theta_2 \\in [0, \\frac{3\\pi}{4}]$.\n\nTherefore, if the solution respects the original angle bounds, the translation bounds are automatically satisfied. The simplified optimization problem is to minimize $E(\\theta_1, \\theta_2)$ subject to the box constraints:\n$$ -\\frac{\\pi}{2} \\le \\theta_1 \\le \\frac{\\pi}{2} $$\n$$ 0 \\le \\theta_2 \\le \\frac{3\\pi}{4} $$\n\n### 3. Numerical Solution Strategy\n\nThis is a non-convex, constrained nonlinear optimization problem. We will use the `scipy.optimize.minimize` function with the Sequential Least Squares Programming (`SLSQP`) method, which handles box constraints efficiently. To enhance the likelihood of finding a good solution rather than a poor local minimum, a multi-start strategy is employed: the optimization is performed multiple times from different, randomly chosen initial points $(\\theta_1^{(0)}, \\theta_2^{(0)})$ within the valid domains. The solution yielding the lowest objective function value across all starts is selected as the final result.\n\n### 4. Feasibility and Error Calculation\n\nFor each test case, after finding the optimal angles $(\\theta_1^*, \\theta_2^*)$:\n1.  **Feasibility Check**: The solution is deemed \"arthrokinematically feasible\" if all original constraints are met.\n    - The equality constraints $s_i - C_i \\theta_i = 0$ are satisfied by construction (within floating-point precision). We verify this to a tolerance of $10^{-6}$.\n    - The angle bounds on $\\theta_1^*$ and $\\theta_2^*$ are checked to ensure they were respected by the optimizer.\n    - The accessory translation bounds $|s_i^*| \\le s_i^{\\max}$ (where $s_i^*=C_i\\theta_i^*$) are also checked. As analyzed above, this is implied by the angle bounds but verified for robustness.\n2.  **Position Error**: The final end-effector position error is calculated as $\\|\\mathbf{p}(\\theta_1^*,\\theta_2^*) - \\mathbf{p}_{\\mathrm{t}}\\|_2$.\n\nThis procedure is applied to each of the four target poses provided in the test suite.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves the inverse kinematics problem for a two-segment limb with\n    coupled arthrokinematics for a series of target poses.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    L1 = 0.30  # m\n    L2 = 0.25  # m\n    R1 = 0.020 # m\n    R2 = 0.015 # m\n    kappa1 = 0.60\n    kappa2 = 0.40\n    sigma1 = -1\n    sigma2 = -1\n    w_pos = 1.0\n    w_ori = 1.0\n    l_eq = 0.10  # m/rad\n\n    # Angle bounds (rad)\n    theta1_min, theta1_max = -np.pi / 2, np.pi / 2\n    theta2_min, theta2_max = 0, 3 * np.pi / 4\n    bounds = [(theta1_min, theta1_max), (theta2_min, theta2_max)]\n\n    # Accessory translation bounds (m)\n    s1_max = 0.030\n    s2_max = 0.030\n    \n    # Feasibility tolerance\n    tolerance = 1e-6\n\n    # Derived coupling constants (m/rad)\n    C1 = sigma1 * kappa1 * R1\n    C2 = sigma2 * kappa2 * R2\n\n    # --- Test Cases ---\n    test_cases = [\n        # (target_pos, target_ori)\n        (np.array([0.40, 0.10]), 1.00),  # Happy path\n        (np.array([0.55, 0.00]), 0.00),  # Boundary reach\n        (np.array([0.70, 0.00]), 0.00),  # Unreachable target\n        (np.array([0.20, 0.35]), 2.00),  # Orientation-challenging\n    ]\n\n    # --- Helper Functions ---\n    def forward_kinematics(theta):\n        \"\"\"Computes end-effector position and orientation.\"\"\"\n        theta1, theta2 = theta\n        \n        # Position\n        pos_x = (C1 * theta1 + L1) * np.cos(theta1) + (C2 * theta2 + L2) * np.cos(theta1 + theta2)\n        pos_y = (C1 * theta1 + L1) * np.sin(theta1) + (C2 * theta2 + L2) * np.sin(theta1 + theta2)\n        p = np.array([pos_x, pos_y])\n        \n        # Orientation\n        phi = theta1 + theta2\n        \n        return p, phi\n\n    def objective_function(theta, p_target, phi_target):\n        \"\"\"Computes the total weighted error.\"\"\"\n        p_current, phi_current = forward_kinematics(theta)\n        \n        pos_error_sq = np.sum((p_current - p_target)**2)\n        ori_error_sq = (l_eq * (phi_current - phi_target))**2\n        \n        total_error = w_pos * pos_error_sq + w_ori * ori_error_sq\n        return total_error\n\n    # --- Main Loop ---\n    final_results = []\n    num_starts = 20  # Number of random starts for optimization\n    np.random.seed(0) # For reproducibility\n\n    for p_t, phi_t in test_cases:\n        best_result = {'fun': np.inf}\n\n        for i in range(num_starts):\n            # Generate a random initial guess within the bounds\n            theta1_0 = np.random.uniform(theta1_min, theta1_max)\n            theta2_0 = np.random.uniform(theta2_min, theta2_max)\n            initial_guess = [theta1_0, theta2_0]\n\n            res = minimize(\n                objective_function,\n                initial_guess,\n                args=(p_t, phi_t),\n                method='SLSQP',\n                bounds=bounds,\n                tol=1e-9\n            )\n\n            if res.success and res.fun < best_result['fun']:\n                best_result = res\n        \n        # If no start was successful, use the one with the lowest error\n        if best_result['fun'] == np.inf:\n             # Fallback if no start succeeds (unlikely)\n             res = minimize(objective_function, [0,0], args=(p_t, phi_t), method='SLSQP', bounds=bounds)\n             theta_opt = res.x\n        else:\n            theta_opt = best_result.x\n        \n        theta1_opt, theta2_opt = theta_opt\n\n        # --- Feasibility Check ---\n        s1_opt = C1 * theta1_opt\n        s2_opt = C2 * theta2_opt\n\n        # Check equality constraints\n        g1_ok = abs(s1_opt - C1 * theta1_opt) < tolerance\n        g2_ok = abs(s2_opt - C2 * theta2_opt) < tolerance\n        \n        # Check all bounds with a small tolerance for numerical stability\n        theta1_ok = (theta1_min - tolerance) <= theta1_opt <= (theta1_max + tolerance)\n        theta2_ok = (theta2_min - tolerance) <= theta2_opt <= (theta2_max + tolerance)\n        s1_ok = abs(s1_opt) <= (s1_max + tolerance)\n        s2_ok = abs(s2_opt) <= (s2_max + tolerance)\n\n        is_feasible = g1_ok and g2_ok and theta1_ok and theta2_ok and s1_ok and s2_ok\n\n        # --- Calculate Final Position Error ---\n        p_final, _ = forward_kinematics(theta_opt)\n        pos_error = np.linalg.norm(p_final - p_t)\n\n        final_results.append(is_feasible)\n        final_results.append(pos_error)\n\n    # --- Format and Print Final Output ---\n    output_str = ','.join([str(r) for r in final_results])\n    print(f\"[{output_str}]\")\n\nsolve()\n```"
        }
    ]
}