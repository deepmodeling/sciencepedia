{
    "hands_on_practices": [
        {
            "introduction": "To effectively select the right tool for a biomechanical analysis, you must first understand how the tools are constructed. This practice guides you through the fundamental derivation of the stiffness matrix for an Euler–Bernoulli beam element, a cornerstone of structural analysis, starting from first principles of virtual work and shape functions. Mastering this process provides a deep appreciation for how an element's mathematical formulation dictates its physical behavior and inherent limitations.",
            "id": "4170882",
            "problem": "A straight, prismatic segment of an orthopedic fixation plate is modeled as a one-dimensional beam element under planar bending using the Euler–Bernoulli hypothesis (plane cross-sections remain plane and orthogonal to the neutral axis, and transverse shear strain is zero). Consider the local coordinate $x \\in [0,L]$, where $L$ is the element length, and assume linear elastic behavior with Young’s modulus $E$ and second moment of area $I$ about the out-of-plane axis. Using the Finite Element Method (FEM), take a two-node beam element with nodal degrees of freedom $\\{w_{1},\\theta_{1},w_{2},\\theta_{2}\\}$, where $w$ is the transverse displacement and $\\theta$ is the cross-section rotation about the neutral axis. Starting from the principle of virtual work and the strain energy in bending, derive the $4 \\times 4$ local bending stiffness matrix for this Euler–Bernoulli element by:\n- Constructing the cubic Hermite interpolation for $w(x)$ that is $C^{1}$-continuous and exactly interpolates $\\{w_{1},\\theta_{1},w_{2},\\theta_{2}\\}$.\n- Computing the curvature $\\kappa(x)$ from $w(x)$ consistent with the Euler–Bernoulli kinematics.\n- Forming the element stiffness matrix by integrating the bending energy density over the element.\n\nThen, based on your derived stiffness matrix, determine its determinant. Provide the determinant as your final answer in exact form; no rounding is required.\n\nFinally, discuss the limitations of the Euler–Bernoulli element for modeling thick or short beams in orthopedic devices (for example, intramedullary nails or plate segments with substantial thickness), and briefly justify when and why a shear-deformable Timoshenko beam element is preferred for accurate structural and continuum analysis in biomechanics. Your discussion will not be graded in the final numeric answer but should be included in your solution.",
            "solution": "The problem is assessed to be valid. It is a well-posed, scientifically grounded problem in the field of computational biomechanics and structural mechanics, based on established principles of the Finite Element Method and Euler–Bernoulli beam theory. All necessary information is provided, and the requested derivation and analysis are standard procedures in this discipline.\n\nThe derivation of the element stiffness matrix will proceed according to the steps outlined in the problem statement.\n\nFirst, the transverse displacement field $w(x)$ within the element (from $x=0$ to $x=L$) is interpolated using a cubic polynomial, which has four coefficients. This choice is necessary to match the four nodal degrees of freedom (two displacements and two rotations).\nThe displacement is given by:\n$$w(x) = a_0 + a_1x + a_2x^2 + a_3x^3$$\nThe rotation of the cross-section, $\\theta(x)$, is the first derivative of the displacement field:\n$$\\theta(x) = \\frac{dw}{dx} = a_1 + 2a_2x + 3a_3x^2$$\n\nThe nodal degrees of freedom are defined at the element's nodes.\nAt node $1$ (where $x=0$):\n$w(0) = w_1$\n$\\theta(0) = \\theta_1$\nApplying these conditions to the polynomial expressions:\n$w_1 = a_0$\n$\\theta_1 = a_1$\n\nAt node $2$ (where $x=L$):\n$w(L) = w_2$\n$\\theta(L) = \\theta_2$\nApplying these conditions:\n$w_2 = a_0 + a_1L + a_2L^2 + a_3L^3$\n$\\theta_2 = a_1 + 2a_2L + 3a_3L^2$\n\nSubstituting the known coefficients $a_0 = w_1$ and $a_1 = \\theta_1$ into the equations for node $2$ yields a system of two linear equations for the remaining coefficients, $a_2$ and $a_3$:\n$$w_2 = w_1 + \\theta_1L + a_2L^2 + a_3L^3$$\n$$\\theta_2 = \\theta_1 + 2a_2L + 3a_3L^2$$\nRearranging gives:\n$$L^2 a_2 + L^3 a_3 = w_2 - w_1 - \\theta_1L$$\n$$2L a_2 + 3L^2 a_3 = \\theta_2 - \\theta_1$$\nSolving this system for $a_2$ and $a_3$ in terms of the nodal DOFs $\\{w_1, \\theta_1, w_2, \\theta_2\\}$ yields:\n$$a_2 = \\frac{3}{L^2}(w_2 - w_1) - \\frac{1}{L}(2\\theta_1 + \\theta_2)$$\n$$a_3 = \\frac{2}{L^3}(w_1 - w_2) + \\frac{1}{L^2}(\\theta_1 + \\theta_2)$$\n\nBy substituting all four coefficients back into the expression for $w(x)$, we can express the displacement field as a linear combination of the nodal DOFs, where the coefficients are the Hermite shape functions $N_i(x)$:\n$$w(x) = N_1(x)w_1 + N_2(x)\\theta_1 + N_3(x)w_2 + N_4(x)\\theta_2$$\nThis can be written in matrix form as $w(x) = [N]\\{d\\}$, where $[N]$ is the row vector of shape functions and $\\{d\\} = \\{w_1, \\theta_1, w_2, \\theta_2\\}^T$ is the vector of nodal displacements. The shape functions are:\n$$N_1(x) = 1 - 3\\left(\\frac{x}{L}\\right)^2 + 2\\left(\\frac{x}{L}\\right)^3$$\n$$N_2(x) = x\\left(1 - \\frac{x}{L}\\right)^2 = x - \\frac{2x^2}{L} + \\frac{x^3}{L^2}$$\n$$N_3(x) = 3\\left(\\frac{x}{L}\\right)^2 - 2\\left(\\frac{x}{L}\\right)^3$$\n$$N_4(x) = \\frac{x^3}{L^2} - \\frac{x^2}{L}$$\nThese functions are $C^1$-continuous and satisfy the interpolation properties, e.g., $N_1(0)=1$, $N_1(L)=0$, $\\frac{dN_1}{dx}(0)=0$, etc.\n\nNext, we compute the curvature, $\\kappa(x)$. Under the Euler–Bernoulli hypothesis for small deflections, the curvature is approximated by the second derivative of the transverse displacement:\n$$\\kappa(x) \\approx \\frac{d^2w}{dx^2}$$\nWe can express the curvature in terms of the nodal DOFs using the matrix $[B]$, which contains the second derivatives of the shape functions:\n$$\\kappa(x) = \\frac{d^2}{dx^2}\\left([N]\\{d\\}\\right) = \\left[\\frac{d^2N_1}{dx^2} \\quad \\frac{d^2N_2}{dx^2} \\quad \\frac{d^2N_3}{dx^2} \\quad \\frac{d^2N_4}{dx^2}\\right]\\{d\\} = [B]\\{d\\}$$\nThe components of the $[B]$ matrix are:\n$$B_1(x) = \\frac{d^2N_1}{dx^2} = -\\frac{6}{L^2} + \\frac{12x}{L^3}$$\n$$B_2(x) = \\frac{d^2N_2}{dx^2} = -\\frac{4}{L} + \\frac{6x}{L^2}$$\n$$B_3(x) = \\frac{d^2N_3}{dx^2} = \\frac{6}{L^2} - \\frac{12x}{L^3}$$\n$$B_4(x) = \\frac{d^2N_4}{dx^2} = \\frac{6x}{L^2} - \\frac{2}{L}$$\n\nThe strain energy $U$ stored in the beam due to bending is given by:\n$$U = \\frac{1}{2}\\int_V \\sigma \\epsilon \\,dV = \\frac{1}{2}\\int_0^L EI(\\kappa(x))^2 \\,dx$$\nwhere $E$ is Young's modulus and $I$ is the second moment of area. Substituting the FEM approximation for curvature:\n$$U = \\frac{1}{2}\\int_0^L EI ( [B]\\{d\\} )^T ( [B]\\{d\\} ) \\,dx = \\frac{1}{2}\\{d\\}^T \\left( EI \\int_0^L [B]^T [B] \\,dx \\right) \\{d\\}$$\nThe expression in the parenthesis is the element stiffness matrix $[k]$:\n$$[k] = \\int_0^L EI [B]^T [B] \\,dx$$\nThe components of the stiffness matrix, $k_{ij}$, are computed by $k_{ij} = EI \\int_0^L B_i(x)B_j(x) \\,dx$. Performing these integrations for all $i,j \\in \\{1,2,3,4\\}$ yields the symmetric $4 \\times 4$ local bending stiffness matrix:\n$$[k] = \\frac{EI}{L^3} \\begin{pmatrix}\n12  6L  -12  6L \\\\\n6L  4L^2  -6L  2L^2 \\\\\n-12  -6L  12  -6L \\\\\n6L  2L^2  -6L  4L^2\n\\end{pmatrix}$$\n\nThe final task is to determine the determinant of this matrix. A fundamental property of the stiffness matrix for an unconstrained structural element is that it must be singular. This singularity arises from the existence of rigid-body modes, which are motions that produce no deformation and hence no strain energy. For a beam element in a plane, there are two such modes:\n$1$. Pure translation: A uniform displacement $w_0$, where $w(x) = w_0$. The corresponding nodal displacement vector is $\\{d_{trans}\\} = \\{w_0, 0, w_0, 0\\}^T$.\n$2$. Pure rotation: A small rotation $\\alpha$ about a point, leading to a linear displacement field $w(x) = \\alpha(x-x_0)$. If we rotate about $x=0$, then $w(x) = \\alpha x$. The corresponding nodal displacement vector is $\\{d_{rot}\\} = \\{0, \\alpha, \\alpha L, \\alpha\\}^T$.\n\nFor any rigid-body displacement vector $\\{d_{rbm}\\}$, the resulting nodal forces must be zero, i.e., $[k]\\{d_{rbm}\\} = \\{0\\}$. This means that the rigid-body modes are non-trivial vectors in the null space of $[k]$. For a matrix to have a non-trivial null space, it must be singular. A singular matrix has a determinant of zero.\n\nWe can verify this property mathematically. Let's perform a row operation on the matrix $[k]$. Let $R_i$ be the $i$-th row. If we perform the operation $R_3 \\rightarrow R_3 + R_1$, the new third row becomes:\n$R'_3 = [-12, -6L, 12, -6L] + [12, 6L, -12, 6L] = [0, 0, 0, 0]$\nSince one row of the matrix can be rendered a zero vector through elementary row operations, the rows are linearly dependent. A matrix with linearly dependent rows (or columns) has a determinant of zero. Therefore, the determinant of the Euler–Bernoulli beam element stiffness matrix is exactly zero.\n$$\\det([k]) = 0$$\n\nThe final part of the problem asks for a discussion on the limitations of this model. The Euler–Bernoulli beam element is formulated on the hypothesis that plane cross-sections remain plane and normal to the deformed neutral axis. This formulation inherently neglects transverse shear strain. This assumption is valid and highly accurate for slender beams, where the length $L$ is significantly greater than the beam's thickness $h$ (i.e., high aspect ratio $L/h$). In such cases, bending deformation dominates, and shear deformation is negligible.\n\nHowever, in many biomechanical applications, structural components are not slender. For example, segments of orthopedic bone plates or intramedullary nails can be relatively short and thick, possessing a low aspect ratio. For these \"thick\" or \"short\" beams, transverse shear deformation can contribute significantly to the total displacement and strain of the structure. The Euler–Bernoulli model, by ignoring this effect, overestimates the stiffness of the structure, leading to an underestimation of displacements and potentially inaccurate stress predictions.\n\nFor a more accurate structural and continuum analysis in such cases, a shear-deformable Timoshenko beam element is preferred. The Timoshenko beam theory relaxes the rigid normality constraint of Euler-Bernoulli theory. It allows cross-sections to remain plane but not necessarily normal to the neutral axis. This is achieved by treating the rotation of the cross-section as an independent kinematic variable, distinct from the slope of the neutral axis, $\\frac{dw}{dx}$. The difference between these two quantities is the average transverse shear strain. By incorporating shear deformation, the Timoshenko model provides a more physically realistic representation of the mechanics of thick beams. Consequently, Timoshenko beam elements are essential for obtaining accurate and reliable results when modeling stout biomechanical components where shear effects cannot be justifiably ignored.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Building on the classical beam model (), we often turn to Timoshenko beam theory to incorporate shear deformation, which is critical for analyzing the thicker structures common in biomechanics. However, a more sophisticated physical theory does not automatically yield a better finite element. This exercise analytically demonstrates \"shear locking,\" a notorious numerical pathology where a low-order Timoshenko element becomes artificially stiff, revealing how a naive numerical implementation can undermine a sound physical model.",
            "id": "4170873",
            "problem": "A slender cortical bone lamella segment of rectangular cross-section is to be modeled by a single, two-node Timoshenko beam finite element for structural analysis within biomechanics. The segment has length $L$, width $b$, and thickness $h$ (in the bending direction), with Young’s modulus $E$, shear modulus $G$, and shear correction factor $\\kappa$. The cross-sectional area is $A$, and the second moment of area about the bending axis is $I$. The element employs low-order interpolation: linear shape functions for the transverse displacement $w(x)$ and the cross-section rotation $\\beta(x)$.\n\nConsider a loading state of constant bending moment $M$ along the span, so that the exact Euler–Bernoulli solution has zero shear strain, constant bending curvature, and quadratic transverse displacement field. Starting only from fundamental beam kinematics and energy principles, do the following:\n\n- Use the Timoshenko beam kinematic relation $\\gamma(x) = w'(x) - \\beta(x)$ for shear strain and linear interpolation for both $w(x)$ and $\\beta(x)$ to obtain the shear strain field $\\gamma_{h}(x)$ predicted by the low-order element when the nodal values are sampled from the exact Euler–Bernoulli solution at $x=0$ and $x=L$.\n- Derive the parasitic shear strain energy $U_{\\text{shear}}(h)$ accumulated over the element due to this $\\gamma_{h}(x)$ under the given constant bending moment $M$.\n- Derive the exact bending strain energy $U_{\\text{bend}}$ over the element for the same loading.\n- Form the ratio $R(h) = U_{\\text{shear}}(h)/U_{\\text{bend}}$ and simplify it to a closed-form expression that explicitly highlights how it scales with the thickness $h$.\n\nAssume a rectangular cross-section so that $A = b h$ and $I = b h^{3}/12$. Provide the final expression for $R(h)$ in terms of the given parameters. The final expression is dimensionless; do not round and do not include units in the final expression.",
            "solution": "The problem requires an analysis of parasitic shear strain, a phenomenon known as shear locking, in a two-node Timoshenko beam element under a constant bending moment. The derivation will proceed by first establishing the exact solution under the specified loading, then determining the fields approximated by the low-order finite element, calculating the resulting spurious shear strain energy, and comparing it to the correct bending strain energy.\n\nStep 1: Determine the exact solution for pure bending.\nUnder a constant bending moment $M$, the governing equation for an Euler-Bernoulli beam is given by:\n$$\nE I \\frac{d^2w}{dx^2} = M\n$$\nThe rotation of the cross-section, $\\beta(x)$, in Euler-Bernoulli theory is the slope of the deflection curve, $\\beta(x) = w'(x)$. Integrating the governing equation once with respect to $x$ yields the rotation:\n$$\nE I \\frac{dw}{dx} = E I \\beta(x) = M x + C_1\n$$\nwhere $C_1$ is a constant of integration. Integrating a second time gives the transverse displacement $w(x)$:\n$$\nE I w(x) = \\frac{1}{2} M x^2 + C_1 x + C_2\n$$\nwhere $C_2$ is a second integration constant. These constants, $C_1$ and $C_2$, depend on the boundary conditions, which are not specified. However, as will be shown, they will cancel out of the final result. By definition, the Euler-Bernoulli solution has zero shear strain, $\\gamma(x) = w'(x) - \\beta(x) = 0$.\n\nStep 2: Define the finite element approximation.\nThe two-node element spans from $x=0$ to $x=L$. The transverse displacement $w(x)$ and the rotation $\\beta(x)$ are approximated using linear shape functions $N_1(x) = 1 - x/L$ and $N_2(x) = x/L$. The approximated fields, $w_h(x)$ and $\\beta_h(x)$, are:\n$$\nw_h(x) = N_1(x) w_1 + N_2(x) w_2 = \\left(1 - \\frac{x}{L}\\right) w_1 + \\frac{x}{L} w_2\n$$\n$$\n\\beta_h(x) = N_1(x) \\beta_1 + N_2(x) \\beta_2 = \\left(1 - \\frac{x}{L}\\right) \\beta_1 + \\frac{x}{L} \\beta_2\n$$\nwhere $w_1, w_2, \\beta_1, \\beta_2$ are the nodal values of displacement and rotation at $x=0$ and $x=L$, respectively.\n\nStep 3: Determine the parasitic shear strain field $\\gamma_h(x)$.\nThe shear strain in the Timoshenko beam element is given by $\\gamma_h(x) = w_h'(x) - \\beta_h(x)$. The derivative of the approximated displacement is:\n$$\nw_h'(x) = \\frac{d}{dx} \\left[ \\left(1 - \\frac{x}{L}\\right) w_1 + \\frac{x}{L} w_2 \\right] = \\frac{w_2 - w_1}{L}\n$$\nNote that the interpolated slope $w_h'(x)$ is constant over the element. The shear strain is then:\n$$\n\\gamma_h(x) = \\frac{w_2 - w_1}{L} - \\left[ \\left(1 - \\frac{x}{L}\\right) \\beta_1 + \\frac{x}{L} \\beta_2 \\right]\n$$\nTo evaluate this for the given loading, we sample the nodal values from the exact Euler-Bernoulli solution at $x=0$ and $x=L$:\n$$\nw_1 = w(0) = \\frac{C_2}{EI}\n$$\n$$\nw_2 = w(L) = \\frac{1}{EI} \\left( \\frac{1}{2} M L^2 + C_1 L + C_2 \\right)\n$$\n$$\n\\beta_1 = \\beta(0) = \\frac{C_1}{EI}\n$$\n$$\n\\beta_2 = \\beta(L) = \\frac{1}{EI} (M L + C_1)\n$$\nNow substitute these nodal values into the expression for $\\gamma_h(x)$. First, for the constant term:\n$$\n\\frac{w_2 - w_1}{L} = \\frac{1}{L} \\left[ \\frac{1}{EI} \\left( \\frac{1}{2} M L^2 + C_1 L + C_2 \\right) - \\frac{C_2}{EI} \\right] = \\frac{1}{LEI} \\left( \\frac{1}{2} M L^2 + C_1 L \\right) = \\frac{ML}{2EI} + \\frac{C_1}{EI}\n$$\nNext, for the interpolated rotation term $\\beta_h(x)$:\n$$\n\\beta_h(x) = \\left(1 - \\frac{x}{L}\\right) \\frac{C_1}{EI} + \\frac{x}{L} \\frac{ML+C_1}{EI} = \\frac{1}{EI} \\left[ C_1 - \\frac{C_1x}{L} + \\frac{MLx}{L} + \\frac{C_1x}{L} \\right] = \\frac{C_1 + Mx}{EI}\n$$\nCombining these to find the shear strain:\n$$\n\\gamma_h(x) = \\left(\\frac{ML}{2EI} + \\frac{C_1}{EI}\\right) - \\left(\\frac{C_1 + Mx}{EI}\\right) = \\frac{ML}{2EI} - \\frac{Mx}{EI}\n$$\nThis simplifies to the parasitic shear strain field:\n$$\n\\gamma_h(x) = \\frac{M}{EI} \\left( \\frac{L}{2} - x \\right)\n$$\nThis strain is non-zero, despite the exact solution having zero shear strain. This is a direct consequence of the low-order interpolation's inability to represent a pure bending state without introducing shear.\n\nStep 4: Derive the parasitic shear strain energy $U_{\\text{shear}}(h)$.\nThe strain energy stored due to shear is given by the integral over the volume of one-half the product of shear stress and shear strain. For a beam, this is:\n$$\nU_{\\text{shear}}(h) = \\int_0^L \\frac{1}{2} (\\kappa G A) [\\gamma_h(x)]^2 dx\n$$\nwhere $\\kappa$ is the shear correction factor, $G$ is the shear modulus, and $A$ is the cross-sectional area. Substituting the expression for $\\gamma_h(x)$:\n$$\nU_{\\text{shear}}(h) = \\frac{\\kappa G A}{2} \\int_0^L \\left[ \\frac{M}{EI} \\left( \\frac{L}{2} - x \\right) \\right]^2 dx = \\frac{\\kappa G A M^2}{2(EI)^2} \\int_0^L \\left( \\frac{L}{2} - x \\right)^2 dx\n$$\nThe integral evaluates to:\n$$\n\\int_0^L \\left( \\frac{L}{2} - x \\right)^2 dx = \\left[ -\\frac{1}{3} \\left( \\frac{L}{2} - x \\right)^3 \\right]_0^L = -\\frac{1}{3} \\left[ \\left( -\\frac{L}{2} \\right)^3 - \\left( \\frac{L}{2} \\right)^3 \\right] = -\\frac{1}{3} \\left( -\\frac{L^3}{8} - \\frac{L^3}{8} \\right) = \\frac{L^3}{12}\n$$\nThus, the parasitic shear strain energy is:\n$$\nU_{\\text{shear}}(h) = \\frac{\\kappa G A M^2}{2(EI)^2} \\frac{L^3}{12} = \\frac{\\kappa G A M^2 L^3}{24(EI)^2}\n$$\n\nStep 5: Derive the exact bending strain energy $U_{\\text{bend}}$.\nThe strain energy due to pure bending is given by:\n$$\nU_{\\text{bend}} = \\int_0^L \\frac{M^2}{2EI} dx\n$$\nSince $M$, $E$, and $I$ are constant along the length of the element:\n$$\nU_{\\text{bend}} = \\frac{M^2}{2EI} \\int_0^L dx = \\frac{M^2 L}{2EI}\n$$\n\nStep 6: Form the ratio $R(h)$ and simplify.\nThe ratio of parasitic shear energy to the exact bending energy is:\n$$\nR(h) = \\frac{U_{\\text{shear}}(h)}{U_{\\text{bend}}} = \\frac{\\frac{\\kappa G A M^2 L^3}{24(EI)^2}}{\\frac{M^2 L}{2EI}} = \\frac{\\kappa G A L^2}{12 EI}\n$$\nNow, substitute the expressions for the rectangular cross-section: $A = bh$ and $I = bh^3/12$.\n$$\nR(h) = \\frac{\\kappa G (bh) L^2}{12 E (bh^3/12)}\n$$\nSimplifying this expression by canceling terms:\n$$\nR(h) = \\frac{\\kappa G b h L^2}{E b h^3} = \\frac{\\kappa G L^2}{E h^2}\n$$\nThis expression can be written to explicitly show its dependence on the beam's aspect ratio $(L/h)$:\n$$\nR(h) = \\frac{\\kappa G}{E} \\left( \\frac{L}{h} \\right)^2\n$$\nThis final result shows that the ratio of spurious shear energy to correct bending energy is proportional to the square of the beam's length-to-thickness ratio. For slender beams where $L/h \\gg 1$, this ratio becomes very large, indicating that the element's response is dominated by the non-physical shear energy. This stiffening effect is known as shear locking. The expression scales with thickness as $h^{-2}$.",
            "answer": "$$\\boxed{\\frac{\\kappa G}{E} \\left(\\frac{L}{h}\\right)^2}$$"
        },
        {
            "introduction": "The theoretical foundations () and numerical pathologies () of beam elements directly inform the practical decision of element selection. This final practice bridges theory and application by tasking you to quantitatively compare the performance of Euler-Bernoulli and Timoshenko beam models for a common biomechanical scenario. By computing the deflection for both theories across a range of aspect ratios, you will develop a concrete, quantitative rationale for when shear deformation is significant and justify the choice of one element type over another.",
            "id": "4170860",
            "problem": "You are tasked with designing and implementing a program to quantitatively compare the suitability of Euler–Bernoulli beam elements versus Timoshenko beam elements for simulating a slender cortical bone plate subjected to a central point load, and to assess how the modeling error changes as the plate thickness increases. The plate is modeled as a prismatic, straight beam of rectangular cross-section with length $L$, width $b$, and thickness $h$, made of an isotropic linear elastic material with Young’s modulus $E$ and Poisson’s ratio $\\nu$. The central point load of magnitude $P$ produces small deformations under the assumptions of small strains and small rotations. The shear correction factor for the rectangular cross-section is $\\kappa$.\n\nStarting from first principles appropriate to biomechanics and structural analysis, derive the governing relations needed to compute the midspan deflection predicted by both Euler–Bernoulli and Timoshenko beam theories for a simply supported beam under a central point load. Your derivation must begin from:\n- The constitutive relation for small-strain linear elasticity, including $G = \\dfrac{E}{2(1+\\nu)}$.\n- The kinematics of beams, including the relationship between bending moment and curvature for slender beams and the role of transverse shear deformation for thick beams.\n- The definition of the area $A$ and second moment of area $I$ for a rectangular cross section ($A = b h$ and $I = \\dfrac{b h^3}{12}$).\n- Static equilibrium for a simply supported beam under a central point load $P$.\n\nYou must not assume or quote any shortcut formulas for deflection; instead, construct the expressions that a computational analyst would use for element selection in a finite element analysis context. The final goal is to obtain expressions for the midspan deflection under the central point load for both beam theories, and then to compute a relative modeling error that quantifies the difference as thickness increases.\n\nUse the following scientifically sound parameter values, expressed in the International System of Units:\n- Beam (plate) length: $L = 0.10$ meters.\n- Beam (plate) width: $b = 0.012$ meters.\n- Thickness values to test: $h \\in \\{0.001, 0.003, 0.006, 0.010, 0.015\\}$ meters.\n- Young’s modulus: $E = 18 \\times 10^9$ pascals.\n- Poisson’s ratio: $\\nu = 0.30$.\n- Shear correction factor: $\\kappa = \\dfrac{5}{6}$.\n- Central point load: $P = 1.0$ newtons.\n\nFor each test thickness $h$, compute:\n1. The midspan deflection predicted by Euler–Bernoulli beam theory in meters.\n2. The midspan deflection predicted by Timoshenko beam theory in meters.\n3. The relative modeling error, defined as the decimal value $\\dfrac{\\delta_{\\mathrm{EB}} - \\delta_{\\mathrm{T}}}{\\delta_{\\mathrm{T}}}$, where $\\delta_{\\mathrm{EB}}$ is the Euler–Bernoulli deflection and $\\delta_{\\mathrm{T}}$ is the Timoshenko deflection.\n4. A boolean recommendation for element selection, where the program returns $True$ if Euler–Bernoulli elements are acceptable (absolute value of the relative error less than a threshold $\\tau$) and $False$ otherwise. Use $\\tau = 0.05$.\n\nAll deflections must be expressed in meters. The relative error must be expressed as a decimal, not a percentage. The boolean recommendation must be strictly $True$ or $False$.\n\nYour program should produce a single line of output containing the results aggregated as a comma-separated list enclosed in square brackets, where each test case contributes a four-item list of the form $[\\delta_{\\mathrm{EB}}, \\delta_{\\mathrm{T}}, \\text{error}, \\text{recommendation}]$. For example:\n\"Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[[\\delta_{\\mathrm{EB}_1},\\delta_{\\mathrm{T}_1},\\text{error}_1,\\text{recommendation}_1],[\\delta_{\\mathrm{EB}_2},\\delta_{\\mathrm{T}_2},\\text{error}_2,\\text{recommendation}_2],\\dots]$).\"",
            "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in the principles of solid mechanics, specifically beam theory, and is well-posed, providing all necessary parameters and a clear objective. The provided values are physically realistic for the biomechanical context of cortical bone analysis. The problem is objective and free of ambiguity.\n\nThe task is to derive the expressions for midspan deflection of a simply supported beam under a central point load, according to both Euler-Bernoulli and Timoshenko beam theories, and then to implement a program to compute these deflections and a relative modeling error for a range of beam thicknesses.\n\n**1. Fundamental Principles and Given Parameters**\n\nThe analysis is based on linear elasticity and static equilibrium. The given parameters are:\n- Beam length: $L = 0.10$ m\n- Beam width: $b = 0.012$ m\n- Beam thicknesses: $h \\in \\{0.001, 0.003, 0.006, 0.010, 0.015\\}$ m\n- Young’s modulus: $E = 18 \\times 10^9$ Pa\n- Poisson’s ratio: $\\nu = 0.30$\n- Shear correction factor: $\\kappa = \\frac{5}{6}$\n- Central point load: $P = 1.0$ N\n- Error threshold: $\\tau = 0.05$\n\nFrom the material properties, the shear modulus $G$ is derived:\n$$G = \\frac{E}{2(1+\\nu)}$$\nThe cross-sectional properties for a rectangular section of width $b$ and thickness $h$ are:\n- Area: $A = bh$\n- Second moment of area (about the bending axis): $I = \\frac{bh^3}{12}$\n\n**2. Static Equilibrium Analysis**\n\nConsider a simply supported beam of length $L$ with supports at $x=0$ and $x=L$. A point load $P$ is applied at midspan, $x=L/2$. By static equilibrium, the vertical reaction forces at the supports are equal due to symmetry:\n$$R_A = R_B = \\frac{P}{2}$$\nFor the left half of the beam ($0 \\le x \\le L/2$), we can determine the internal shear force $V(x)$ and bending moment $M(x)$ by making a virtual cut at a distance $x$ from the left support.\n- The shear force is constant and equal to the reaction force:\n$$V(x) = R_A = \\frac{P}{2}$$\n- The bending moment increases linearly from the support:\n$$M(x) = R_A \\cdot x = \\frac{P}{2}x$$\n\n**3. Euler–Bernoulli Beam Theory (EB)**\n\nThis theory assumes that plane cross-sections remain plane and, critically, perpendicular to the neutral axis after deformation. This implies that transverse shear strain is negligible.\n\nThe governing relationship is the moment-curvature equation:\n$$EI \\frac{d^2v}{dx^2} = M(x)$$\nwhere $v(x)$ is the transverse deflection of the beam.\n\nSubstituting the expression for $M(x)$ for the region $0 \\le x \\le L/2$:\n$$EI \\frac{d^2v}{dx^2} = \\frac{P}{2}x$$\nIntegrating with respect to $x$ yields the slope, $\\frac{dv}{dx}$:\n$$EI \\frac{dv}{dx} = \\frac{P}{4}x^2 + C_1$$\nIntegrating again yields the deflection, $v(x)$:\n$$EI v(x) = \\frac{P}{12}x^3 + C_1x + C_2$$\nThe integration constants $C_1$ and $C_2$ are found using boundary and symmetry conditions.\n- **Boundary Condition:** The deflection at the simple support at $x=0$ is zero, thus $v(0)=0$.\n$$EI v(0) = \\frac{P}{12}(0)^3 + C_1(0) + C_2 = 0 \\implies C_2 = 0$$\n- **Symmetry Condition:** Due to the symmetric loading and supports, the slope of the beam at midspan ($x=L/2$) must be zero, thus $\\frac{dv}{dx}(L/2)=0$.\n$$EI \\frac{dv}{dx}\\bigg|_{x=L/2} = \\frac{P}{4}\\left(\\frac{L}{2}\\right)^2 + C_1 = 0 \\implies \\frac{PL^2}{16} + C_1 = 0 \\implies C_1 = -\\frac{PL^2}{16}$$\nSubstituting the constants back into the deflection equation gives:\n$$EI v(x) = \\frac{P}{12}x^3 - \\frac{PL^2}{16}x$$\nThe maximum deflection, $\\delta_{\\mathrm{EB}}$, occurs at midspan ($x=L/2$). Its magnitude is:\n$$\\delta_{\\mathrm{EB}} = |v(L/2)| = \\left| \\frac{1}{EI} \\left( \\frac{P}{12}\\left(\\frac{L}{2}\\right)^3 - \\frac{PL^2}{16}\\left(\\frac{L}{2}\\right) \\right) \\right|$$\n$$\\delta_{\\mathrm{EB}} = \\left| \\frac{1}{EI} \\left( \\frac{PL^3}{96} - \\frac{PL^3}{32} \\right) \\right| = \\left| \\frac{1}{EI} \\left( \\frac{PL^3 - 3PL^3}{96} \\right) \\right| = \\frac{PL^3}{48EI}$$\n\n**4. Timoshenko Beam Theory (T)**\n\nThis theory is more general and accounts for transverse shear deformation. It assumes that plane sections remain plane but do not necessarily remain perpendicular to the deformed neutral axis. The total slope of the neutral axis, $\\frac{dv}{dx}$, is composed of two parts: the rotation of the cross-section, $\\psi(x)$, and the average shear strain, $\\gamma_{\\text{avg}}$.\n$$\\frac{dv}{dx} = \\psi(x) + \\gamma_{\\text{avg}}$$\nThe governing equations are:\n1.  Moment-curvature relation: $M(x) = EI \\frac{d\\psi}{dx}$\n2.  Shear force-strain relation: $V(x) = \\kappa G A \\gamma_{\\text{avg}}$\n\nCombining these, we get the equation for the total slope:\n$$\\frac{dv}{dx} = \\psi(x) + \\frac{V(x)}{\\kappa G A}$$\nFor the region $0 \\le x \\le L/2$, we have $V(x) = P/2$ and $M(x) = Px/2$.\nFirst, integrate the moment-curvature relation to find the cross-section rotation $\\psi(x)$:\n$$EI \\frac{d\\psi}{dx} = \\frac{P}{2}x \\implies EI \\psi(x) = \\frac{P}{4}x^2 + C_3$$\nBy symmetry, the rotation of the cross-section at midspan must be zero, $\\psi(L/2)=0$:\n$$EI \\psi(L/2) = \\frac{P}{4}\\left(\\frac{L}{2}\\right)^2 + C_3 = 0 \\implies C_3 = -\\frac{PL^2}{16}$$\nSo, the rotation is $\\psi(x) = \\frac{1}{EI}\\left(\\frac{P}{4}x^2 - \\frac{PL^2}{16}\\right)$.\nNow, substitute this and $V(x)$ into the equation for the total slope:\n$$\\frac{dv}{dx} = \\frac{1}{EI}\\left(\\frac{P}{4}x^2 - \\frac{PL^2}{16}\\right) + \\frac{P}{2\\kappa G A}$$\nIntegrate with respect to $x$ to find the deflection $v(x)$:\n$$v(x) = \\frac{1}{EI}\\left(\\frac{P}{12}x^3 - \\frac{PL^2}{16}x\\right) + \\frac{P}{2\\kappa G A}x + C_4$$\nUsing the boundary condition $v(0)=0$:\n$$v(0) = 0 + 0 + C_4 = 0 \\implies C_4 = 0$$\nThe maximum deflection, $\\delta_{\\mathrm{T}}$, occurs at midspan ($x=L/2$). Its magnitude is:\n$$\\delta_{\\mathrm{T}} = |v(L/2)| = \\left| \\frac{1}{EI}\\left(\\frac{P}{12}\\left(\\frac{L}{2}\\right)^3 - \\frac{PL^2}{16}\\left(\\frac{L}{2}\\right)\\right) + \\frac{P}{2\\kappa G A}\\left(\\frac{L}{2}\\right) \\right|$$\n$$\\delta_{\\mathrm{T}} = \\left| -\\frac{PL^3}{48EI} + \\frac{PL}{4\\kappa G A} \\right|$$\nSince the bending and shear deflections are in the same direction, we sum their magnitudes:\n$$\\delta_{\\mathrm{T}} = \\underbrace{\\frac{PL^3}{48EI}}_{\\delta_{\\mathrm{EB}}} + \\underbrace{\\frac{PL}{4\\kappa G A}}_{\\delta_{\\text{shear}}}$$\nThe total deflection under Timoshenko theory is the sum of the Euler-Bernoulli bending deflection and an additional term representing deflection due to shear.\n\n**5. Error Analysis and Computational Strategy**\n\nThe relative modeling error of using the simpler Euler-Bernoulli theory compared to the more comprehensive Timoshenko theory is defined as:\n$$\\text{error} = \\frac{\\delta_{\\mathrm{EB}} - \\delta_{\\mathrm{T}}}{\\delta_{\\mathrm{T}}} = \\frac{\\delta_{\\mathrm{EB}} - (\\delta_{\\mathrm{EB}} + \\delta_{\\text{shear}})}{\\delta_{\\mathrm{T}}} = -\\frac{\\delta_{\\text{shear}}}{\\delta_{\\mathrm{T}}}$$\nA recommendation for using Euler-Bernoulli beam elements is made if the absolute value of this error is below a threshold $\\tau = 0.05$:\n$$\\text{recommendation} = (|\\text{error}|  \\tau)$$\nThe computational procedure for the program is:\n1.  Define all constant parameters ($L, b, E, \\nu, \\kappa, P, \\tau$).\n2.  Calculate the shear modulus $G$.\n3.  Iterate through the list of thicknesses $h$.\n4.  For each $h$, calculate the area $A$ and second moment of area $I$.\n5.  Calculate the Euler-Bernoulli deflection $\\delta_{\\mathrm{EB}}$ using its derived formula.\n6.  Calculate the additional shear deflection $\\delta_{\\text{shear}}$.\n7.  Calculate the Timoshenko deflection $\\delta_{\\mathrm{T}} = \\delta_{\\mathrm{EB}} + \\delta_{\\text{shear}}$.\n8.  Calculate the relative error.\n9.  Determine the boolean recommendation.\n10. Store the four computed values for each thickness and format the final output as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Compares Euler-Bernoulli and Timoshenko beam theories for a cortical bone plate.\n\n    This function calculates the midspan deflection for a simply supported beam under a \n    central point load using both theories. It then computes the relative modeling error \n    to assess the validity of the Euler-Bernoulli assumption for different beam thicknesses.\n    \"\"\"\n    # Define problem parameters in SI units\n    L = 0.10             # Beam length (m)\n    b = 0.012            # Beam width (m)\n    E = 18e9             # Young's modulus (Pa)\n    nu = 0.30            # Poisson's ratio\n    kappa = 5.0 / 6.0    # Shear correction factor for rectangular cross-section\n    P = 1.0              # Central point load (N)\n    tau = 0.05           # Relative error threshold\n\n    # Thickness values to test (m)\n    h_values = [0.001, 0.003, 0.006, 0.010, 0.015]\n\n    # Calculate derived material property: Shear Modulus (G)\n    G = E / (2 * (1 + nu))\n\n    results = []\n    \n    for h in h_values:\n        # Cross-sectional properties for the current thickness\n        # Area (A)\n        A = b * h\n        # Second moment of area (I)\n        I = (b * h**3) / 12.0\n\n        # 1. Calculate Euler-Bernoulli (EB) deflection\n        # This deflection is due to bending only.\n        delta_eb = (P * L**3) / (48.0 * E * I)\n\n        # 2. Calculate Timoshenko (T) deflection\n        # This includes both bending and shear deformation.\n        # The bending component is the same as the EB deflection.\n        delta_bending = delta_eb\n        # The shear component is calculated separately.\n        delta_shear = (P * L) / (4.0 * kappa * G * A)\n        # The total Timoshenko deflection is the sum of both components.\n        delta_t = delta_bending + delta_shear\n\n        # 3. Calculate relative modeling error\n        # Error = (approx_value - true_value) / true_value\n        # Here, EB is the approximation and T is the more accurate model.\n        if delta_t == 0:\n            error = 0.0\n        else:\n            error = (delta_eb - delta_t) / delta_t\n\n        # 4. Determine recommendation for element selection\n        # True if Euler-Bernoulli elements are acceptable (error  threshold)\n        recommendation = abs(error)  tau\n\n        # Store the results for this thickness\n        case_result = [delta_eb, delta_t, error, recommendation]\n        results.append(case_result)\n\n    # Format the output string as a list of lists, without extra spaces inside sublists.\n    # e.g., [[val1,val2,val3,True],[...]]\n    result_strings = []\n    for res in results:\n        # Manually format each sub-list to match the desired output style\n        # This avoids spaces from default str(list) and handles boolean case\n        formatted_res = f\"[{res[0]},{res[1]},{res[2]},{str(res[3])}]\"\n        result_strings.append(formatted_res)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        }
    ]
}