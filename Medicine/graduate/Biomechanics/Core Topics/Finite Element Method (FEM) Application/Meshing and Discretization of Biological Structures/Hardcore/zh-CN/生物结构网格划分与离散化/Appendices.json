{
    "hands_on_practices": [
        {
            "introduction": "在生物力学有限元分析中，一个基本步骤是将连续的物理载荷（如作用在器官表面的压力）转化为作用于网格节点的离散力。本练习将引导你应用虚功原理，通过在单元表面上对牵引力向量与形函数的乘积进行积分，来计算一个四节点四边形单元上的压力载荷所产生的节点力。通过这个实践()，你将加深对等参映射、表面积分变换和载荷向量组装的理解，这些都是进行任何有限元分析所必需的核心技能。",
            "id": "4190613",
            "problem": "一个受压器官被建模为一个具有向外边界牵引力的光滑体。在器官上靠近点 $(x=R,y=0,z=0)$ 的一个局部区域，表面网格使用单个四节点双线性四边形面元将一小块器官表面近似为一个平面。该面元的物理节点坐标为\n$$\n\\mathbf{x}_1 = (R,\\,-a,\\,-b),\\quad \\mathbf{x}_2 = (R,\\,a,\\,-b),\\quad \\mathbf{x}_3 = (R,\\,a,\\,b),\\quad \\mathbf{x}_4 = (R,\\,-a,\\,b),\n$$\n其中 $R0$，$a0$，$b0$。从参考正方形 $(\\xi,\\eta)\\in[-1,1]^2$ 到物理空间的等参映射是双线性的，使用标准的四节点双线性形函数 $N_1(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$，$N_2(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$，$N_3(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$，$N_4(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$，且节点顺序 $(\\mathbf{x}_1,\\mathbf{x}_2,\\mathbf{x}_3,\\mathbf{x}_4)$ 分别对应于 $(\\xi,\\eta)=(-1,-1),(1,-1),(1,1),(-1,1)$。该器官受到均匀的内部压力 $p$，在其表面上产生一个向外的牵引力，由 $\\mathbf{t}(\\mathbf{x})=p\\,\\mathbf{n}(\\mathbf{x})$ 给出，其中 $\\mathbf{n}(\\mathbf{x})$ 是面元上向外的单位法向量。在该器官区域，向外的法线方向是 $+x$ 方向。\n\n以连续介质力学虚功原理为基本依据，并采用标准的有限元方法 (FEM) 对牵引力载荷进行边界积分离散化，计算该面元对节点3处全局载荷向量的贡献，特别是其 $x$ 分量 $f_{3x}$，计算时需适当考虑方向和正确的曲面测度。使用几何参数 $R=0.08\\,\\text{m}$，$a=0.012\\,\\text{m}$，$b=0.020\\,\\text{m}$，以及压力 $p=9.5\\times 10^3\\,\\text{Pa}$。最终答案以牛顿为单位表示，并四舍五入到四位有效数字。",
            "solution": "该问题要求计算一个四节点四边形面元在节点3处的节点力 $x$ 分量 $f_{3x}$。该力由作用在面元表面的均匀压力载荷产生。计算基于有限元方法 (FEM) 对边界牵引力虚功原理的离散化。\n\n分布在面元表面 $\\Gamma_e$ 上的牵引力 $\\mathbf{t}(\\mathbf{x})$ 对该单元的一致节点力向量的贡献由以下积分给出：\n$$\n\\mathbf{f}_e = \\int_{\\Gamma_e} \\mathbf{N}^T(\\mathbf{x}) \\mathbf{t}(\\mathbf{x}) \\, dS\n$$\n其中 $\\mathbf{N}$ 是形函数矩阵。在特定节点 $i$ 上的力贡献是一个向量 $\\mathbf{f}_i$，由下式给出：\n$$\n\\mathbf{f}_i = \\int_{\\Gamma_e} N_i(\\mathbf{x}) \\mathbf{t}(\\mathbf{x}) \\, dS\n$$\n我们需要求解该向量在节点3处的 $x$ 分量，记为 $f_{3x}$。\n$$\nf_{3x} = \\int_{\\Gamma_e} N_3(\\mathbf{x}) t_x(\\mathbf{x}) \\, dS\n$$\n其中 $t_x$ 是牵引力向量 $\\mathbf{t}$ 的 $x$ 分量。\n\n问题陈述牵引力由 $\\mathbf{t}(\\mathbf{x}) = p\\,\\mathbf{n}(\\mathbf{x})$ 给出，其中 $p$ 是均匀压力，$\\mathbf{n}(\\mathbf{x})$ 是向外的单位法向量。节点坐标提供如下：\n$$\n\\mathbf{x}_1 = (R,\\,-a,\\,-b), \\quad \\mathbf{x}_2 = (R,\\,a,\\,-b), \\quad \\mathbf{x}_3 = (R,\\,a,\\,b), \\quad \\mathbf{x}_4 = (R,\\,-a,\\,b)\n$$\n所有四个节点都具有相同的 $x$ 坐标，$x=R$。这意味着该面元是一个位于由方程 $x=R$ 定义的平面内的平面矩形。问题还指出，向外的法线方向是 $+x$ 方向。因此，单位法向量 $\\mathbf{n}$ 在整个面元上是恒定的：\n$$\n\\mathbf{n}(\\mathbf{x}) = (1, 0, 0)\n$$\n因此，牵引力向量在整个面元上也是恒定的：\n$$\n\\mathbf{t}(\\mathbf{x}) = p(1, 0, 0) = (p, 0, 0)\n$$\n牵引力的 $x$ 分量是 $t_x(\\mathbf{x}) = p$。由于 $p$ 是一个常数，我们可以将 $f_{3x}$ 的积分写为：\n$$\nf_{3x} = p \\int_{\\Gamma_e} N_3(\\mathbf{x}) \\, dS\n$$\n为了计算这个积分，我们将其从物理坐标 $\\mathbf{x}$ 变换到等参参考坐标 $(\\xi, \\eta)$，其中 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$。曲面微元 $dS$ 通过变换的雅可比行列式 $J$ 与参考单元面积 $d\\xi d\\eta$ 相关联：\n$$\ndS = J(\\xi, \\eta) \\, d\\xi d\\eta\n$$\n从参考坐标到物理坐标的映射由 $\\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) \\mathbf{x}_i$ 给出。曲面单元的雅可比行列式 $J$ 是切向量 $\\mathbf{g}_\\xi = \\frac{\\partial\\mathbf{x}}{\\partial\\xi}$ 和 $\\mathbf{g}_\\eta = \\frac{\\partial\\mathbf{x}}{\\partial\\eta}$ 叉积的模：\n$$\nJ = ||\\mathbf{g}_\\xi \\times \\mathbf{g}_\\eta||\n$$\n让我们为给定的几何形状找到显式映射。位置向量为 $\\mathbf{x}(\\xi, \\eta) = (x(\\xi,\\eta), y(\\xi,\\eta), z(\\xi,\\eta))$。$x$ 分量是 $x(\\xi, \\eta) = \\sum_{i=1}^4 N_i R = R \\sum_{i=1}^4 N_i = R(1) = R$，因为形函数之和为一。\n$y$ 分量是：\n$$\ny(\\xi, \\eta) = N_1(-a) + N_2(a) + N_3(a) + N_4(-a) = a(-N_1 + N_2 + N_3 - N_4)\n$$\n使用形函数的定义：\n$$\n-N_1+N_2+N_3-N_4 = \\frac{1}{4}[-(1-\\xi)(1-\\eta)+(1+\\xi)(1-\\eta)+(1+\\xi)(1+\\eta)-(1-\\xi)(1+\\eta)] = \\xi\n$$\n所以，$y(\\xi, \\eta) = a\\xi$。\n$z$ 分量是：\n$$\nz(\\xi, \\eta) = N_1(-b) + N_2(-b) + N_3(b) + N_4(b) = b(-N_1 - N_2 + N_3 + N_4)\n$$\n使用形函数的定义：\n$$\n-N_1-N_2+N_3+N_4 = \\frac{1}{4}[-(1-\\xi)(1-\\eta)-(1+\\xi)(1-\\eta)+(1+\\xi)(1+\\eta)+(1-\\xi)(1+\\eta)] = \\eta\n$$\n所以，$z(\\xi, \\eta) = b\\eta$。\n映射为 $\\mathbf{x}(\\xi, \\eta) = (R, a\\xi, b\\eta)$。切向量是：\n$$\n\\mathbf{g}_\\xi = \\frac{\\partial\\mathbf{x}}{\\partial\\xi} = (0, a, 0)\n$$\n$$\n\\mathbf{g}_\\eta = \\frac{\\partial\\mathbf{x}}{\\partial\\eta} = (0, 0, b)\n$$\n它们的叉积是：\n$$\n\\mathbf{g}_\\xi \\times \\mathbf{g}_\\eta = \\det \\begin{pmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ 0  a  0 \\\\ 0  0  b \\end{pmatrix} = (ab, 0, 0)\n$$\n雅可比行列式是该向量的模：\n$$\nJ = ||(ab, 0, 0)|| = ab\n$$\n雅可比行列式是一个常数，这对于平面矩形单元是预期的。现在我们可以用参考坐标写出 $f_{3x}$ 的积分：\n$$\nf_{3x} = p \\int_{-1}^1 \\int_{-1}^1 N_3(\\xi, \\eta) J \\, d\\xi d\\eta\n$$\n代入 $N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$ 和 $J=ab$：\n$$\nf_{3x} = p \\int_{-1}^1 \\int_{-1}^1 \\left(\\frac{1}{4}(1+\\xi)(1+\\eta)\\right) (ab) \\, d\\xi d\\eta\n$$\n我们可以分离积分：\n$$\nf_{3x} = \\frac{pab}{4} \\left( \\int_{-1}^1 (1+\\xi) \\, d\\xi \\right) \\left( \\int_{-1}^1 (1+\\eta) \\, d\\eta \\right)\n$$\n让我们计算积分：\n$$\n\\int_{-1}^1 (1+\\xi) \\, d\\xi = \\left[ \\xi + \\frac{\\xi^2}{2} \\right]_{-1}^1 = \\left(1 + \\frac{1}{2}\\right) - \\left(-1 + \\frac{1}{2}\\right) = \\frac{3}{2} - \\left(-\\frac{1}{2}\\right) = 2\n$$\n根据对称性，关于 $\\eta$ 的积分也是 $2$：\n$$\n\\int_{-1}^1 (1+\\eta) \\, d\\eta = 2\n$$\n将这些结果代回 $f_{3x}$ 的表达式中：\n$$\nf_{3x} = \\frac{pab}{4} (2)(2) = \\frac{pab}{4} (4) = pab\n$$\n这个结果可以进行物理解释。面元上的总力是压力乘以面积：$F_{total} = p \\times A$。矩形面元的面积是 $(2a)(2b) = 4ab$。因此，$F_{total} = 4pab$。对于作用在双线性矩形单元上的均匀压力，这个总力被均等地分配到四个节点上。每个节点上的力是 $F_{total}/4 = (4pab)/4 = pab$。我们的计算证实了这一点。\n\n现在，我们代入给定的数值：\n$p = 9.5 \\times 10^3\\,\\text{Pa} = 9.5 \\times 10^3\\,\\text{N/m}^2$\n$a = 0.012\\,\\text{m}$\n$b = 0.020\\,\\text{m}$\n\n$$\nf_{3x} = (9.5 \\times 10^3) \\times (0.012) \\times (0.020) \\, \\text{N}\n$$\n$$\nf_{3x} = 9500 \\times 0.00024 \\, \\text{N}\n$$\n$$\nf_{3x} = 2.28 \\, \\text{N}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nf_{3x} = 2.280 \\, \\text{N}\n$$",
            "answer": "$$\\boxed{2.280}$$"
        },
        {
            "introduction": "现代计算方法，如等几何分析（IGA），使用平滑的样条函数（NURBS）来精确表示复杂的生物几何结构。然而，我们必须确保从简单的参数域到复杂物理形状的几何映射是有效的，即，它不会产生扭曲或翻转的“坏”单元。本练习将让你亲手实践如何通过计算雅可比矩阵及其行列式来检验一个NURBS体单元的有效性()。掌握这一基于雅可比矩阵的单元质量检查方法，是确保高级生物力学仿真物理可靠性的关键一步。",
            "id": "4190650",
            "problem": "一个小型组织块（例如，松质骨段）的生物力学模型被表示为一个三变量非均匀有理B样条（NURBS）体块，其多项式次数为 $p=q=r=1$，在每个参数方向 $\\xi$、$\\eta$ 和 $\\zeta$ 上具有开放均匀节点向量，均为 $[0,0,1,1]$。所有权重均为 $w=1$。参数域为 $[0,1] \\times [0,1] \\times [0,1]$。控制点网格 $\\{\\boldsymbol{P}_{i,j,k}\\}$（$i,j,k\\in\\{0,1\\}$）以毫米为单位给出，并排列形成一个由三个生成向量定义的平行六面体：\n- $\\boldsymbol{v}_{1} = (1.2,\\,0.3,\\,0.1)$，\n- $\\boldsymbol{v}_{2} = (0.2,\\,1.0,\\,0.4)$，\n- $\\boldsymbol{v}_{3} = (0.1,\\,0.2,\\,1.5)$，\n且 $\\boldsymbol{P}_{000}=(0,\\,0,\\,0)$。因此，八个控制点为\n$\\boldsymbol{P}_{000}=\\boldsymbol{P}_{000}$，$\\boldsymbol{P}_{100}=\\boldsymbol{P}_{000}+\\boldsymbol{v}_{1}$，$\\boldsymbol{P}_{010}=\\boldsymbol{P}_{000}+\\boldsymbol{v}_{2}$，$\\boldsymbol{P}_{110}=\\boldsymbol{P}_{000}+\\boldsymbol{v}_{1}+\\boldsymbol{v}_{2}$，$\\boldsymbol{P}_{001}=\\boldsymbol{P}_{000}+\\boldsymbol{v}_{3}$，$\\boldsymbol{P}_{101}=\\boldsymbol{P}_{000}+\\boldsymbol{v}_{1}+\\boldsymbol{v}_{3}$，$\\boldsymbol{P}_{011}=\\boldsymbol{P}_{000}+\\boldsymbol{v}_{2}+\\boldsymbol{v}_{3}$，以及 $\\boldsymbol{P}_{111}=\\boldsymbol{P}_{000}+\\boldsymbol{v}_{1}+\\boldsymbol{v}_{2}+\\boldsymbol{v}_{3}$。使用这些数据：\n\n- 从非均匀有理B样条（NURBS）和张量积B样条的定义出发，推导等参数映射 $\\boldsymbol{x}(\\xi,\\eta,\\zeta)$、雅可比矩阵 $J(\\xi,\\eta,\\zeta)=\\frac{\\partial \\boldsymbol{x}}{\\partial(\\xi,\\eta,\\zeta)}$ 及其行列式 $\\det(J)$。\n\n- 在每个参数上使用 $[0,1]$ 上的两点高斯求积，求积点为 $\\xi_{\\pm}=\\frac{1}{2}\\left(1\\pm\\frac{1}{\\sqrt{3}}\\right)$、$\\eta_{\\pm}=\\frac{1}{2}\\left(1\\pm\\frac{1}{\\sqrt{3}}\\right)$ 和 $\\zeta_{\\pm}=\\frac{1}{2}\\left(1\\pm\\frac{1}{\\sqrt{3}}\\right)$，计算单元所有八个高斯求积点上的 $J$ 和 $\\det(J)$，并用这些值来评估该单元对于等几何分析（IGA）是否有效。\n\n- 讨论在生物力学中用于拒绝无效参数单元的原则性准则，该准则基于几何映射必须是正则且保向的要求。\n\n报告所有高斯求积点上 $\\det(J)$ 的最小值。以 $\\mathrm{mm}^{3}$ 为单位表示您的最终答案，并将答案四舍五入到四位有效数字。",
            "solution": "该问题陈述被评估为具有科学依据、适定且客观。它为在等几何分析（IGA）背景下分析等参数映射提供了一套完整且一致的数据，这是计算生物力学中的一个标准且严谨的课题。所有提供的定义和数值都是标准的，不违反任何科学或数学原理。因此，该问题是有效的，下面给出完整解法。\n\n问题的核心是表征从参数域到物理域的几何映射。该映射由一个三变量非均匀有理B样条（NURBS）公式定义。NURBS体的一般形式为：\n$$\n\\boldsymbol{x}(\\xi, \\eta, \\zeta) = \\frac{\\sum_{i=0}^{n} \\sum_{j=0}^{m} \\sum_{k=0}^{l} N_{i,p}(\\xi) N_{j,q}(\\eta) N_{k,r}(\\zeta) w_{i,j,k} \\boldsymbol{P}_{i,j,k}}{\\sum_{i=0}^{n} \\sum_{j=0}^{m} \\sum_{k=0}^{l} N_{i,p}(\\xi) N_{j,q}(\\eta) N_{k,r}(\\zeta) w_{i,j,k}}\n$$\n其中 $N_{i,p}$、$N_{j,q}$ 和 $N_{k,r}$ 分别是次数为 $p$、$q$ 和 $r$ 的B样条基函数，$\\{\\boldsymbol{P}_{i,j,k}\\}$ 是控制点网格，$\\{w_{i,j,k}\\}$ 是相关权重。\n\n在这个具体问题中，所有权重都给定为 $w_{i,j,k} = 1$。当所有权重都一致时，分母，即所有基函数乘以其权重的总和，简化为 $\\sum N_{i,p}N_{j,q}N_{k,r} = (\\sum N_{i,p})(\\sum N_{j,q})(\\sum N_{k,r})$。由于B样条基函数构成单位分解，对于域中的任何 $\\xi$，都有 $\\sum_{i} N_{i,p}(\\xi) = 1$。因此，分母等于 $1$，NURBS映射简化为更简单的张量积B样条映射：\n$$\n\\boldsymbol{x}(\\xi, \\eta, \\zeta) = \\sum_{i=0}^{1} \\sum_{j=0}^{1} \\sum_{k=0}^{1} N_{i,1}(\\xi) N_{j,1}(\\eta) N_{k,1}(\\zeta) \\boldsymbol{P}_{i,j,k}\n$$\n问题指明了多项式次数为 $p=q=r=1$ 且在每个参数方向上都有开放均匀节点向量 $[0,0,1,1]$。对于次数 $p=1$ 和节点向量 $[0,0,1,1]$，存在两个基函数 $N_{0,1}$ 和 $N_{1,1}$，它们是区间 $[0,1]$ 上的标准线性拉格朗日多项式：\n$$\nN_{0,1}(\\xi) = 1-\\xi \\quad \\text{and} \\quad N_{1,1}(\\xi) = \\xi\n$$\n类似地，对于 $\\eta$ 和 $\\zeta$ 方向：\n$$\nN_{0,1}(\\eta) = 1-\\eta \\quad \\text{and} \\quad N_{1,1}(\\eta) = \\eta\n$$\n$$\nN_{0,1}(\\zeta) = 1-\\zeta \\quad \\text{and} \\quad N_{1,1}(\\zeta) = \\zeta\n$$\n将这些基函数代入B样条映射，得到标准的三线性插值公式：\n$$\n\\boldsymbol{x}(\\xi,\\eta,\\zeta) = \\sum_{i,j,k \\in \\{0,1\\}} N_{i,1}(\\xi)N_{j,1}(\\eta)N_{k,1}(\\zeta)\\boldsymbol{P}_{ijk}\n$$\n控制点被定义为形成一个平行六面体，其一个顶点位于原点 $\\boldsymbol{P}_{000} = (0,0,0) = \\boldsymbol{0}$，生成向量为 $\\boldsymbol{v}_{1}$、$\\boldsymbol{v}_{2}$ 和 $\\boldsymbol{v}_{3}$。明确的控制点位置为：\n$\\boldsymbol{P}_{000}=\\boldsymbol{0}$，$\\boldsymbol{P}_{100}=\\boldsymbol{v}_{1}$，$\\boldsymbol{P}_{010}=\\boldsymbol{v}_{2}$，$\\boldsymbol{P}_{110}=\\boldsymbol{v}_{1}+\\boldsymbol{v}_{2}$，$\\boldsymbol{P}_{001}=\\boldsymbol{v}_{3}$，$\\boldsymbol{P}_{101}=\\boldsymbol{v}_{1}+\\boldsymbol{v}_{3}$，$\\boldsymbol{P}_{011}=\\boldsymbol{v}_{2}+\\boldsymbol{v}_{3}$，以及 $\\boldsymbol{P}_{111}=\\boldsymbol{v}_{1}+\\boldsymbol{v}_{2}+\\boldsymbol{v}_{3}$。\n将这些代入展开的三线性公式，得到：\n$$\n\\begin{align*}\n\\boldsymbol{x}(\\xi,\\eta,\\zeta) = (1-\\xi)(1-\\eta)(1-\\zeta)\\boldsymbol{P}_{000} + \\xi(1-\\eta)(1-\\zeta)\\boldsymbol{P}_{100} + (1-\\xi)\\eta(1-\\zeta)\\boldsymbol{P}_{010} + (1-\\xi)(1-\\eta)\\zeta\\boldsymbol{P}_{001} \\\\\n+ \\xi\\eta(1-\\zeta)\\boldsymbol{P}_{110} + \\xi(1-\\eta)\\zeta\\boldsymbol{P}_{101} + (1-\\xi)\\eta\\zeta\\boldsymbol{P}_{011} + \\xi\\eta\\zeta\\boldsymbol{P}_{111}\n\\end{align*}\n$$\n代入控制点的向量定义，并合并 $\\boldsymbol{v}_{1}$、$\\boldsymbol{v}_{2}$ 和 $\\boldsymbol{v}_{3}$ 的项：\n$$\n\\begin{align*}\n\\boldsymbol{x}(\\xi,\\eta,\\zeta) = \\boldsymbol{v}_{1} [ \\xi(1-\\eta)(1-\\zeta) + \\xi\\eta(1-\\zeta) + \\xi(1-\\eta)\\zeta + \\xi\\eta\\zeta ] \\\\\n+ \\boldsymbol{v}_{2} [ (1-\\xi)\\eta(1-\\zeta) + \\xi\\eta(1-\\zeta) + (1-\\xi)\\eta\\zeta + \\xi\\eta\\zeta ] \\\\\n+ \\boldsymbol{v}_{3} [ (1-\\xi)(1-\\eta)\\zeta + \\xi(1-\\eta)\\zeta + (1-\\xi)\\eta\\zeta + \\xi\\eta\\zeta ]\n\\end{align*}\n$$\n系数大大简化。对于 $\\boldsymbol{v}_{1}$：$\\xi[(1-\\eta)(1-\\zeta) + \\eta(1-\\zeta) + (1-\\eta)\\zeta + \\eta\\zeta] = \\xi[(1-\\eta+\\eta)(1-\\zeta) + (1-\\eta+\\eta)\\zeta] = \\xi[1-\\zeta+\\zeta] = \\xi$。根据对称性，$\\boldsymbol{v}_{2}$ 和 $\\boldsymbol{v}_{3}$ 的系数分别为 $\\eta$ 和 $\\zeta$。因此，等参数映射简化为一个线性仿射变换：\n$$\n\\boldsymbol{x}(\\xi, \\eta, \\zeta) = \\xi \\boldsymbol{v}_{1} + \\eta \\boldsymbol{v}_{2} + \\zeta \\boldsymbol{v}_{3}\n$$\n映射的雅可比矩阵 $J(\\xi,\\eta,\\zeta) = \\frac{\\partial \\boldsymbol{x}}{\\partial(\\xi,\\eta,\\zeta)}$ 是一个矩阵，其列是 $\\boldsymbol{x}$ 关于参数坐标的偏导数：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial \\boldsymbol{x}}{\\partial \\xi}  \\frac{\\partial \\boldsymbol{x}}{\\partial \\eta}  \\frac{\\partial \\boldsymbol{x}}{\\partial \\zeta} \\end{pmatrix}\n$$\n从 $\\boldsymbol{x}$ 的表达式中，我们发现：\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial \\xi} = \\boldsymbol{v}_{1}, \\quad \\frac{\\partial \\boldsymbol{x}}{\\partial \\eta} = \\boldsymbol{v}_{2}, \\quad \\frac{\\partial \\boldsymbol{x}}{\\partial \\zeta} = \\boldsymbol{v}_{3}\n$$\n因此，雅可比矩阵由生成向量作为其列构成：\n$$\nJ = \\begin{pmatrix} \\boldsymbol{v}_{1}  \\boldsymbol{v}_{2}  \\boldsymbol{v}_{3} \\end{pmatrix} = \\begin{pmatrix} 1.2  0.2  0.1 \\\\ 0.3  1.0  0.2 \\\\ 0.1  0.4  1.5 \\end{pmatrix}\n$$\n一个关键的观察是，对于这种线性映射，雅可比矩阵 $J$ 在整个参数域 $[0,1] \\times [0,1] \\times [0,1]$ 上是恒定的。\n雅可比行列式 $\\det(J)$ 代表从参数空间到物理空间的体积缩放因子。它通过列向量的标量三重积计算：\n$$\n\\det(J) = \\boldsymbol{v}_{1} \\cdot (\\boldsymbol{v}_{2} \\times \\boldsymbol{v}_{3}) = \\det\\begin{pmatrix} 1.2  0.2  0.1 \\\\ 0.3  1.0  0.2 \\\\ 0.1  0.4  1.5 \\end{pmatrix}\n$$\n$$\n\\det(J) = 1.2(1.0 \\cdot 1.5 - 0.4 \\cdot 0.2) - 0.2(0.3 \\cdot 1.5 - 0.2 \\cdot 0.1) + 0.1(0.3 \\cdot 0.4 - 1.0 \\cdot 0.1)\n$$\n$$\n\\det(J) = 1.2(1.5 - 0.08) - 0.2(0.45 - 0.02) + 0.1(0.12 - 0.10)\n$$\n$$\n\\det(J) = 1.2(1.42) - 0.2(0.43) + 0.1(0.02) = 1.704 - 0.086 + 0.002 = 1.620\n$$\n雅可比行列式为 $\\det(J) = 1.620 \\, \\mathrm{mm}^3$。\n\n问题的第二部分要求在八个两点高斯求积点上计算 $J$ 和 $\\det(J)$，并评估单元的有效性。由于此单元的 $J$ 和 $\\det(J)$ 都是常数，它们在域中所有点的值都相同，包括所有八个高斯求积点。\n$$\nJ(\\xi, \\eta, \\zeta) = \\begin{pmatrix} 1.2  0.2  0.1 \\\\ 0.3  1.0  0.2 \\\\ 0.1  0.4  1.5 \\end{pmatrix} \\quad \\forall (\\xi, \\eta, \\zeta)\n$$\n$$\n\\det(J(\\xi, \\eta, \\zeta)) = 1.620 \\quad \\forall (\\xi, \\eta, \\zeta)\n$$\n在IGA（以及有限元分析）中，用于物理模拟的有效单元的主要准则是映射必须是正则且保向的。在数学上，这转化为雅可比行列式必须在单元的参数域内处处严格为正的条件，即 $\\det(J)  0$。正的行列式确保参数空间中的每个无穷小体积都映射到物理空间中一个正的、非反转的无穷小体积。行列式为零表示奇点，负行列式表示一个反转或“内外翻转”的单元，这两者都是非物理的，并且在计算上是灾难性的，因为它们会破坏物理量（如应力和应变）的计算，而这些物理量依赖于场变量的导数，从而依赖于 $J^{-1}$。\n在这种情况下，$\\det(J) = 1.620  0$。由于这是一个正常数，该条件处处满足。因此，该单元对于等几何分析是有效的。\n\n因此，在IGA中拒绝无效单元的原则性准则集中于雅可比行列式。如果单元参数域内的任何一点上 $\\det(J) \\le 0$，则该单元无效，必须被舍弃。对于 $J$ 不是常数的高阶单元，此检查通常在数值求积点进行。如果任何求积点得出 $\\det(J) \\le 0$，则该单元被标记为无效。此检查确保了计算模型的物理意义，这在像生物力学这样的应用中至关重要，因为在这些应用中，模拟必须精确反映真实世界材料在载荷下的行为。\n\n最后，问题要求报告所有高斯求积点上 $\\det(J)$ 的最小值。由于 $\\det(J)$ 是一个常数值 $1.620$，其最小值显然也是 $1.620$。按要求四舍五入到四位有效数字，该值为 $1.620$。",
            "answer": "$$\n\\boxed{1.620}\n$$"
        },
        {
            "introduction": "在模拟组织振动或冲击等动态事件时，我们如何离散化结构质量对仿真结果有显著影响。本练习将探讨两种常见的质量矩阵形式——一致质量矩阵和集总质量矩阵——以及它们如何影响动态分析的稳定性和效率。你将通过编程实践()，为一维生物纤维组装这两种质量矩阵，求解系统的最高固有频率，并计算显式时间积分方法的稳定时间步长上限($\\Delta t$)。这项练习将理论与实践相结合，帮助你深入理解在动态生物力学建模中，不同离散化选择对计算稳定性的直接影响。",
            "id": "4190632",
            "problem": "一根长度为 $L$、横截面积恒为 $A$ 的细长生物纤维（例如，肌腱束）的轴向振动采用有限元法（FEM）进行一维建模。杨氏模量 $E$ 是恒定的，但材料密度 $\\rho(x)$ 沿长度呈线性函数变化，其在 $x=0$ 处的值为 $\\rho_0$，在 $x=L$ 处的值为 $\\rho_1$。网格由 $N_e$ 个线性双节点杆单元组成。平面外厚度已包含在横截面积 $A$ 中，因此不单独使用厚度值。所有物理量均采用国际单位制（SI）：长度单位为米（$\\mathrm{m}$），面积单位为平方米（$\\mathrm{m}^2$），密度单位为千克每立方米（$\\mathrm{kg/m^3}$），杨氏模量单位为帕斯卡（$\\mathrm{Pa}$），时间单位为秒（$\\mathrm{s}$）。位于 $x=0$ 的左端是固定的（狄利克雷边界条件），右端是自由的。您必须构建并组装一致质量矩阵，并就使用中心差分法（CDM）进行显式时间积分时对时间步长 $\\Delta t$ 的稳定性约束，将其与集总质量近似进行比较。\n\n从动能原理和标准的 Galerkin 投影出发，考虑每个单元上的轴向位移场近似 $u(x,t)=\\sum_i N_i(x)\\,d_i(t)$，其中 $N_i(x)$ 是线性形函数，$d_i(t)$ 是节点位移。该一维杆的动能为\n$$\nT(t)=\\frac{1}{2}\\int_0^L \\rho(x)\\,A\\,\\dot{u}(x,t)^2\\,dx.\n$$\n利用此公式，将单元一致质量矩阵 $M_e$ 的各项推导为如下形式的积分\n$$\nM_e(i,j)=\\int_{x_e}^{x_{e+1}} \\rho(x)\\,A\\,N_i(x)\\,N_j(x)\\,dx,\n$$\n并通过将每个单元的贡献累加到相应的全局自由度中，来组装全局一致质量矩阵 $M$。通过一致质量矩阵的行和对角化来定义集总质量矩阵 $M^{\\ell}$，即将 $M$ 的行和移至其对角线上，以保持总质量。\n\n类似地，从使用线性形函数的内部应变能出发，利用公式\n$$\nK_e = \\int_{x_e}^{x_{e+1}} E\\,A\\,B^\\mathsf{T}B\\,dx,\n$$\n推导并组装用于轴向变形的全局刚度矩阵 $K$，其中 $B=\\frac{dN}{dx}$ 是线性单元上的常数应变-位移矩阵。\n\n对于无阻尼半离散系统 $M\\,\\ddot{d}(t)+K\\,d(t)=0$，通过移除受约束的自由度来应用左端固定边界条件，从而获得简化矩阵 $\\tilde{M}$ 和 $\\tilde{K}$。中心差分法（CDM）的更新可以为广义特征值问题\n$$\n\\tilde{K}\\,\\phi = \\lambda\\,\\tilde{M}\\,\\phi,\n$$\n的每个特征模态写成模态形式，其中模态圆频率为 $\\omega=\\sqrt{\\lambda}$。对于无阻尼线性系统，CDM 的稳定性要求为\n$$\n\\Delta t \\le \\frac{2}{\\omega_{\\max}},\n$$\n其中 $\\omega_{\\max}$ 是离散化系统所有模态中的最大模态圆频率。对每种情况，计算此约束两次：一次使用一致质量矩阵 $\\tilde{M}$，另一次使用集总质量矩阵 $\\tilde{M}^{\\ell}$。\n\n您的程序必须：\n- 对于线性单元和每个单元上线性变化的密度 $\\rho(x)$，使用精确或足够精确的求积法，构建并组装具有空间变化密度的全局一致质量矩阵。\n- 组装轴向线性单元的全局刚度矩阵。\n- 通过移除相应的自由度来应用左端的固定边界条件。\n- 对两种质量模型求解广义特征值问题，以获得 $\\omega_{\\max}$，并计算最大稳定时间步长 $\\Delta t_{\\max} = 2/\\omega_{\\max}$（单位为秒）。\n- 在每个线性单元上，使用对于线性密度乘以二次形函数乘积的积分是精确的数值求积法。\n- 报告所有 $\\Delta t_{\\max}$ 值（单位为秒），并四舍五入到六位有效数字。\n\n测试套件（四种情况，涵盖基准、梯度密度、高刚度和最小单元边缘情况）。对于每种情况，密度按 $\\rho(x)=\\rho_0 + (\\rho_1-\\rho_0)\\,x/L$ 线性变化：\n1. 基准软组织类：$E=5.0\\times 10^5\\,\\mathrm{Pa}$，$L=0.1\\,\\mathrm{m}$，$A=1.0\\times 10^{-4}\\,\\mathrm{m}^2$，$N_e=8$，$\\rho_0=1050\\,\\mathrm{kg/m^3}$，$\\rho_1=1050\\,\\mathrm{kg/m^3}$。\n2. 梯度密度：$E=8.0\\times 10^5\\,\\mathrm{Pa}$，$L=0.08\\,\\mathrm{m}$，$A=8.0\\times 10^{-5}\\,\\mathrm{m}^2$，$N_e=6$，$\\rho_0=900\\,\\mathrm{kg/m^3}$，$\\rho_1=1500\\,\\mathrm{kg/m^3}$。\n3. 高刚度段：$E=1.2\\times 10^9\\,\\mathrm{Pa}$，$L=0.05\\,\\mathrm{m}$，$A=2.0\\times 10^{-5}\\,\\mathrm{m}^2$，$N_e=12$，$\\rho_0=1800\\,\\mathrm{kg/m^3}$，$\\rho_1=1800\\,\\mathrm{kg/m^3}$。\n4. 最小网格边缘情况：$E=5.0\\times 10^7\\,\\mathrm{Pa}$，$L=0.02\\,\\mathrm{m}$，$A=1.0\\times 10^{-5}\\,\\mathrm{m}^2$，$N_e=1$，$\\rho_0=1200\\,\\mathrm{kg/m^3}$，$\\rho_1=1000\\,\\mathrm{kg/m^3}$。\n\n最终输出格式规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果以秒为单位，四舍五入到六位有效数字。\n- 该列表必须按以下顺序包含八个值：$[\\Delta t_{\\text{cons},1}, \\Delta t_{\\text{lump},1}, \\Delta t_{\\text{cons},2}, \\Delta t_{\\text{lump},2}, \\Delta t_{\\text{cons},3}, \\Delta t_{\\text{lump},3}, \\Delta t_{\\text{cons},4}, \\Delta t_{\\text{lump},4}]$，其中下标表示测试用例索引，“cons”/“lump” 分别表示一致质量或集总质量。",
            "solution": "问题要求确定在使用中心差分法（CDM）对一维杆的轴向振动进行显式时间积分时，所允许的最大稳定时间步长 $\\Delta t_{\\max}$。此计算需要针对两种不同的质量矩阵公式进行：一致质量矩阵和集总质量矩阵。该杆具有恒定的横截面积 $A$ 和杨氏模量 $E$，但其密度 $\\rho(x)$ 沿其长度 $L$ 线性变化。\n\n分析过程包括以下步骤：\n1.  使用有限元法（FEM）对连续域进行离散化。\n2.  推导和组装单元刚度矩阵和一致质量矩阵。\n3.  组装全局刚度矩阵（$K$）和全局一致质量矩阵（$M$）。\n4.  从一致质量矩阵构建全局集总质量矩阵（$M^{\\ell}$）。\n5.  应用固定边界条件以获得简化后的系统矩阵。\n6.  对两种质量模型求解广义特征值问题，以找到最大固有频率 $\\omega_{\\max}$。\n7.  计算临界时间步长限制 $\\Delta t_{\\max} = 2/\\omega_{\\max}$。\n\n**1. 离散化与形函数**\n长度为 $L$ 的一维域被离散为 $N_e$ 个线性双节点单元，每个单元的长度为 $h_e = L/N_e$。全局节点位于 $x_i = i \\cdot h_e$（$i \\in \\{0, 1, \\dots, N_e\\}$）的位置。对于连接全局节点 $i$ 和 $i+1$ 的一个通用单元，其轴向位移场 $u(x,t)$ 近似为：\n$$\nu(x,t) = N_1(x)d_i(t) + N_2(x)d_{i+1}(t)\n$$\n其中 $d_i(t)$ 和 $d_{i+1}(t)$ 是节点位移，$N_1(x)$ 和 $N_2(x)$ 是单元的线性拉格朗日形函数。在局部坐标系 $\\tilde{x} \\in [0, h_e]$ 中，它们表示为：\n$$\nN_1(\\tilde{x}) = 1 - \\frac{\\tilde{x}}{h_e} \\quad , \\quad N_2(\\tilde{x}) = \\frac{\\tilde{x}}{h_e}\n$$\n\n**2. 单元刚度矩阵 ($K_e$)**\n单元刚度矩阵由应变能推导而来。对于具有恒定 $E$ 和 $A$ 的杆单元，其表达式为：\n$$\nK_e = \\int_{0}^{h_e} E A B^\\mathsf{T}B \\,d\\tilde{x}\n$$\n其中 $B$ 是应变-位移矩阵，包含形函数的空间导数：\n$$\nB = \\begin{bmatrix} \\frac{dN_1}{d\\tilde{x}}  \\frac{dN_2}{d\\tilde{x}} \\end{bmatrix} = \\begin{bmatrix} -\\frac{1}{h_e}  \\frac{1}{h_e} \\end{bmatrix} = \\frac{1}{h_e}\\begin{bmatrix} -1  1 \\end{bmatrix}\n$$\n乘积 $B^\\mathsf{T}B$ 在单元内是常数：\n$$\nB^\\mathsf{T}B = \\frac{1}{h_e^2}\\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\n由于 $E$、$A$ 和 $B$ 在单元上是常数，积分变得很简单：\n$$\nK_e = E A (B^\\mathsf{T}B) \\int_{0}^{h_e} \\,d\\tilde{x} = E A (B^\\mathsf{T}B) h_e = \\frac{EA}{h_e} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\n这是 1D 线性杆单元的标准刚度矩阵。\n\n**3. 单元一致质量矩阵 ($M_e$)**\n单元一致质量矩阵源于动能表达式，定义为：\n$$\nM_e(i,j) = \\int_{x_e}^{x_{e+1}} \\rho(x) A N_i(x) N_j(x) \\,dx\n$$\n密度 $\\rho(x)$ 在整个杆上线性变化：$\\rho(x) = \\rho_0 + (\\rho_1 - \\rho_0) \\frac{x}{L}$。在位于位置 $x_e$ 和 $x_{e+1}$ 的节点 $e$ 和 $e+1$ 之间的单元内，密度分别为 $\\rho_e = \\rho(x_e)$ 和 $\\rho_{e+1} = \\rho(x_{e+1})$。单元内的密度可以使用相同的形函数进行线性插值：\n$$\n\\rho(\\tilde{x}) = N_1(\\tilde{x})\\rho_e + N_2(\\tilde{x})\\rho_{e+1}\n$$\n质量矩阵各项的积分涉及多项式的乘积。$M_e(i,j)$ 的被积函数是 $\\rho(x)N_i(x)N_j(x)$，它是一个最高 3 次的多项式。这些积分可以解析计算，这等效于使用对三次多项式精确的求积法则（例如，两点高斯求积）。对于局部坐标 $\\tilde{x} \\in [0, h_e]$，矩阵项为：\n$$\nM_{e,11} = A \\int_{0}^{h_e} (N_1\\rho_e + N_2\\rho_{e+1})N_1^2 \\,d\\tilde{x} = A h_e \\left( \\frac{\\rho_e}{4} + \\frac{\\rho_{e+1}}{12} \\right)\n$$\n$$\nM_{e,12} = M_{e,21} = A \\int_{0}^{h_e} (N_1\\rho_e + N_2\\rho_{e+1})N_1 N_2 \\,d\\tilde{x} = A h_e \\left( \\frac{\\rho_e}{12} + \\frac{\\rho_{e+1}}{12} \\right)\n$$\n$$\nM_{e,22} = A \\int_{0}^{h_e} (N_1\\rho_e + N_2\\rho_{e+1})N_2^2 \\,d\\tilde{x} = A h_e \\left( \\frac{\\rho_e}{12} + \\frac{\\rho_{e+1}}{4} \\right)\n$$\n组合这些项，单元一致质量矩阵为：\n$$\nM_e = \\frac{A h_e}{12} \\begin{bmatrix} 3\\rho_e + \\rho_{e+1}  \\rho_e + \\rho_{e+1} \\\\ \\rho_e + \\rho_{e+1}  \\rho_e + 3\\rho_{e+1} \\end{bmatrix}\n$$\n如果密度是恒定的，即 $\\rho_e = \\rho_{e+1} = \\rho$，则该矩阵正确地简化为标准形式 $M_e = \\frac{\\rho A h_e}{6}\\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix}$。\n\n**4. 全局矩阵和边界条件**\n全局刚度矩阵 $K$ 和一致质量矩阵 $M$ 的大小均为 $(N_e+1) \\times (N_e+1)$，它们通过遍历所有 $N_e$ 个单元，并将 $K_e$ 和 $M_e$ 的各项加到相应的全局位置来组装。\n集总质量矩阵 $M^{\\ell}$ 是一个对角矩阵，其中每个对角线元素 $M^{\\ell}_{ii}$ 是一致质量矩阵 $M$ 第 $i$ 行所有元素的和：\n$$\nM^{\\ell}_{ii} = \\sum_{j=0}^{N_e} M_{ij} \\quad, \\quad M^{\\ell}_{ij} = 0 \\text{ for } i \\neq j\n$$\n左端（$x=0$，节点 0）是固定的，意味着其位移 $d_0$ 为零。通过从全局矩阵 $K$、$M$ 和 $M^{\\ell}$ 中移除第一行和第一列来施加此边界条件，从而分别得到大小为 $N_e \\times N_e$ 的简化矩阵 $\\tilde{K}$、$\\tilde{M}$ 和 $\\tilde{M}^{\\ell}$。\n\n**5. 特征值问题和稳定性分析**\n离散化系统的无阻尼自由振动由方程 $M\\ddot{d} + Kd = 0$ 控制。施加边界条件后，自由度的方程为 $\\tilde{M}\\ddot{\\tilde{d}} + \\tilde{K}\\tilde{d} = 0$。通过求解广义特征值问题可以找到系统的固有频率：\n$$\n\\tilde{K}\\phi = \\lambda \\tilde{M}\\phi \\quad \\text{其中 } \\lambda = \\omega^2\n$$\n中心差分法的稳定性由离散系统的最高固有频率 $\\omega_{\\max} = \\sqrt{\\lambda_{\\max}}$ 决定。最大稳定时间步长为：\n$$\n\\Delta t_{\\max} \\le \\frac{2}{\\omega_{\\max}}\n$$\n此分析必须执行两次：一次使用简化后的一致质量矩阵 $\\tilde{M}$ 来求得 $\\Delta t_{\\text{cons}}$，另一次使用简化后的集总质量矩阵 $\\tilde{M}^{\\ell}$ 来求得 $\\Delta t_{\\text{lump}}$。通常，与一致质量公式相比，集总质量公式会产生更高的 $\\omega_{\\max}$，因此其稳定时间步长也更严格（更小）。\n\n计算实现涉及构建一个遍历所有测试用例的循环。对于每种情况，全局矩阵都是逐单元组装的。施加固定边界条件后，使用 `scipy.linalg.eigh` 函数来求解两个针对对称矩阵的广义特征值问题。所得特征值的最大值提供了 $\\lambda_{\\max}$，并由此计算出 $\\Delta t_{\\max}$。",
            "answer": "[0.000181818,0.000105,0.000140228,8.23932e-05,2.16942e-06,1.2524e-06,0.000282843,0.000182574]"
        }
    ]
}