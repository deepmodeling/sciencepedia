{
    "hands_on_practices": [
        {
            "introduction": "在有限元分析中，选择何种类型的单元是一项关键决策。与线性单元相比，诸如二次单元这样的高阶单元计算成本更高，那么，在何种情况下我们才应该付出这额外的成本呢？本练习  旨在通过深入探讨有限元收敛性的理论基础来解答这一问题。您将运用Céa引理和插值误差估计等基本原理，定量分析从线性单元升级到二次单元所带来的精度提升，从而为您在未来的模拟实践中，就如何选择单元阶数（即p-细化）提供坚实的理论依据。",
            "id": "4190625",
            "problem": "在小应变、各向同性、线弹性理论中，考虑一个光滑的生物组织样本，其占据一个直径为 $L$ 的有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{3}$。考虑位移场 $\\boldsymbol{u}:\\Omega \\to \\mathbb{R}^{3}$，它由以下标准弱形式控制：求 $\\boldsymbol{u} \\in \\boldsymbol{V}$ 使得\n$$\na(\\boldsymbol{u},\\boldsymbol{v}) = \\ell(\\boldsymbol{v}) \\quad \\text{对所有 } \\boldsymbol{v} \\in \\boldsymbol{V},\n$$\n其中 $\\boldsymbol{V} = [H_{0}^{1}(\\Omega)]^{3}$，$a(\\boldsymbol{u},\\boldsymbol{v}) = \\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\mathbb{C}:\\boldsymbol{\\varepsilon}(\\boldsymbol{v})\\,\\mathrm{d}x$，$\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = (\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top})/2$，并且 $\\mathbb{C}$ 是一个与该组织相关的、一致有界、一致正定的四阶弹性张量。假设体力项和边界数据足够光滑，使得精确解满足 $\\boldsymbol{u} \\in [H^{3}(\\Omega)]^{3}$。\n\n设 $\\{\\mathcal{T}_{h}\\}$ 为一族拟一致、形状规则的四面体网格，最大单元直径为 $h$。定义无量纲网格参数 $\\hat{h} = h/L$。考虑多项式次数为 $p=1$ (线性) 和 $p=2$ (二次) 的协调拉格朗日有限元方法 (FEM) 离散化，它们在 $\\boldsymbol{V}$ 相应的子空间中产生离散解 $\\boldsymbol{u}_{h}^{(1)}$ 和 $\\boldsymbol{u}_{h}^{(2)}$。定义能量范数 $\\|\\boldsymbol{w}\\|_{E} = \\sqrt{a(\\boldsymbol{w},\\boldsymbol{w})}$。\n\n仅从有限元方法的基本结果（具体来说，是 $a(\\cdot,\\cdot)$ 的矫顽性和连续性、Céa 引理、由 Bramble–Hilbert 引理推导的插值误差估计，以及由 Korn 不等式保证的范数等价性）出发，当 $\\hat{h} \\to 0$ 时，推导在固定 $\\hat{h}$ 的情况下，从线性单元升级到二次单元时能量范数下误差减小因子的主阶渐近表达式：\n$$\n\\rho(\\hat{h}) \\equiv \\frac{\\|\\boldsymbol{u} - \\boldsymbol{u}_{h}^{(2)}\\|_{E}}{\\|\\boldsymbol{u} - \\boldsymbol{u}_{h}^{(1)}\\|_{E}}.\n$$\n\n你的最终答案应仅用 $\\hat{h}$ 表示，为一个封闭形式的解析表达式，代表其主阶渐近行为（不考虑与 $\\hat{h}$ 无关的乘法常数）。无需进行数值四舍五入。答案必须是无单位的单一表达式。",
            "solution": "该问题要求推导从线性 ($p=1$) 有限元方法 (FEM) 离散化升级到二次 ($p=2$) 离散化时，误差减小因子 $\\rho(\\hat{h})$ 的主阶渐近表达式。推导将基于所指定的有限元方法的基本结果。\n\n该问题由线弹性的弱形式控制：求 $\\boldsymbol{u} \\in \\boldsymbol{V} = [H_{0}^{1}(\\Omega)]^{3}$ 使得\n$$a(\\boldsymbol{u},\\boldsymbol{v}) = \\ell(\\boldsymbol{v}) \\quad \\forall \\boldsymbol{v} \\in \\boldsymbol{V}。$$\n双线性形式 $a(\\boldsymbol{u},\\boldsymbol{v}) = \\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) : \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\, \\mathrm{d}x$ 定义了一个内积，相关的能量范数是 $\\|\\boldsymbol{w}\\|_{E} = \\sqrt{a(\\boldsymbol{w},\\boldsymbol{w})}$。\n\n分析从 Céa 引理开始。对于一个协调有限元空间 $\\boldsymbol{V}_{h} \\subset \\boldsymbol{V}$，离散解 $\\boldsymbol{u}_{h} \\in \\boldsymbol{V}_{h}$ 满足以下误差界：\n$$ \\|\\boldsymbol{u} - \\boldsymbol{u}_{h}\\|_{E} \\le C_{\\text{Céa}} \\inf_{\\boldsymbol{v}_{h} \\in \\boldsymbol{V}_{h}} \\|\\boldsymbol{u} - \\boldsymbol{v}_{h}\\|_{E}, $$\n其中常数 $C_{\\text{Céa}}$ 与网格尺寸 $h$ 无关。该引理表明，有限元解的误差在能量范数下，在相差一个常数的意义上，与精确解 $\\boldsymbol{u}$ 在离散空间 $\\boldsymbol{V}_{h}$ 中的最佳逼近一样好。\n\n接下来，我们将能量范数 $\\|\\cdot\\|_{E}$ 与一个标准的 Sobolev 空间范数联系起来。四阶弹性张量 $\\mathbb{C}$ 被给定为一致有界和一致正定的。这意味着存在常数 $c_{1}, c_{2} > 0$，使得对于任何对称二阶张量场 $\\boldsymbol{\\tau}$，\n$$ c_{1} \\int_{\\Omega} \\|\\boldsymbol{\\tau}\\|_{F}^{2} \\, \\mathrm{d}x \\le \\int_{\\Omega} \\boldsymbol{\\tau} : \\mathbb{C} : \\boldsymbol{\\tau} \\, \\mathrm{d}x \\le c_{2} \\int_{\\Omega} \\|\\boldsymbol{\\tau}\\|_{F}^{2} \\, \\mathrm{d}x, $$\n其中 $\\|\\cdot\\|_{F}$ 是 Frobenius 范数。令 $\\boldsymbol{\\tau} = \\boldsymbol{\\varepsilon}(\\boldsymbol{w})$，我们得到 $c_{1} \\|\\boldsymbol{\\varepsilon}(\\boldsymbol{w})\\|_{L^2(\\Omega)}^2 \\le \\|\\boldsymbol{w}\\|_{E}^{2} \\le c_{2} \\|\\boldsymbol{\\varepsilon}(\\boldsymbol{w})\\|_{L^2(\\Omega)}^2$。\n对于空间 $\\boldsymbol{V} = [H_{0}^{1}(\\Omega)]^{3}$ 的 Korn 不等式指出，$H^1$-半范数等价于梯度对称部分的 $L^2$-范数。也就是说，存在一个常数 $C_{K} > 0$ 使得\n$$ \\|\\boldsymbol{w}\\|_{H^1(\\Omega)} \\le C_{K} \\|\\boldsymbol{\\varepsilon}(\\boldsymbol{w})\\|_{L^2(\\Omega)}. $$\n同样，根据定义，$\\|\\boldsymbol{\\varepsilon}(\\boldsymbol{w})\\|_{L^2(\\Omega)} \\le \\|\\nabla \\boldsymbol{w}\\|_{L^2(\\Omega)} = |\\boldsymbol{w}|_{H^1(\\Omega)}$。结合这些不等式，我们确立了能量范数 $\\|\\cdot\\|_E$ 在 $\\boldsymbol{V}$ 上等价于 $H^1$-半范数 $|\\cdot|_{H^1(\\Omega)}$。因此，存在与 $h$ 无关的常数 $\\alpha, \\beta > 0$，使得对于任何 $\\boldsymbol{w} \\in \\boldsymbol{V}$：\n$$ \\alpha |\\boldsymbol{w}|_{H^1(\\Omega)} \\le \\|\\boldsymbol{w}\\|_{E} \\le \\beta |\\boldsymbol{w}|_{H^1(\\Omega)}. $$\n\n将此范数等价性应用于 Céa 引理，有限元解的误差由 $H^1$-半范数下的最佳逼近误差所界定。最佳逼近误差又可以由 $\\boldsymbol{V}_{h}$ 中某个特定函数的误差来界定，通常是精确解 $\\boldsymbol{u}$ 的拉格朗日插值 $\\mathcal{I}_{h}\\boldsymbol{u}$。\n$$ \\|\\boldsymbol{u} - \\boldsymbol{u}_{h}\\|_{E} \\le C_{\\text{Céa}} \\|\\boldsymbol{u} - \\mathcal{I}_{h}\\boldsymbol{u}\\|_{E} \\le C_{\\text{Céa}} \\beta |\\boldsymbol{u} - \\mathcal{I}_{h}\\boldsymbol{u}|_{H^1(\\Omega)}. $$\n\n渐近分析的核心在于多项式次数为 $p$ 的拉格朗日有限元的标准插值误差估计，这些估计是从 Bramble-Hilbert 引理推导出来的。对于一族拟一致、形状规则的网格，以及一个函数 $\\boldsymbol{w} \\in [H^s(\\Omega)]^3$，$H^m$-半范数下的插值误差由下式给出：\n$$ |\\boldsymbol{w} - \\mathcal{I}_{h}^{(p)}\\boldsymbol{w}|_{H^m(\\Omega)} \\le C h^{\\min(p+1, s) - m} |\\boldsymbol{w}|_{H^s(\\Omega)}. $$\n这里，我们关心的是 $H^1$-半范数下的误差，所以我们设 $m=1$。问题陈述精确解具有正则性 $\\boldsymbol{u} \\in [H^3(\\Omega)]^3$，所以我们有 $s=3$。估计式变为：\n$$ |\\boldsymbol{u} - \\mathcal{I}_{h}^{(p)}\\boldsymbol{u}|_{H^1(\\Omega)} \\le C h^{\\min(p+1, 3) - 1} |\\boldsymbol{u}|_{H^{\\min(p+1, 3)}(\\Omega)}. $$\n\n我们现在分析多项式次数 $p=1$ 和 $p=2$ 的两种情况。\n\n情况1：线性单元 ($p=1$)。\n离散解记为 $\\boldsymbol{u}_{h}^{(1)}$。在插值误差估计中设 $p=1$：\n$$ |\\boldsymbol{u} - \\mathcal{I}_{h}^{(1)}\\boldsymbol{u}|_{H^1(\\Omega)} \\le C_1 h^{\\min(1+1, 3) - 1} |\\boldsymbol{u}|_{H^{\\min(2,3)}(\\Omega)} = C_1 h^{\\min(2, 3) - 1} |\\boldsymbol{u}|_{H^2(\\Omega)} = C_1 h^{2-1} |\\boldsymbol{u}|_{H^2(\\Omega)} = C_1 h |\\boldsymbol{u}|_{H^2(\\Omega)}. $$\n因此，能量范数下的误差由以下不等式界定：\n$$ \\|\\boldsymbol{u} - \\boldsymbol{u}_{h}^{(1)}\\|_{E} \\le C_{\\text{Céa}}\\beta C_1 h |\\boldsymbol{u}|_{H^2(\\Omega)}. $$\n对于足够光滑的解，这些界是渐近最优的。因此，线性单元误差的主阶行为是：\n$$ \\|\\boldsymbol{u} - \\boldsymbol{u}_{h}^{(1)}\\|_{E} \\sim K_1 h \\quad \\text{当 } h \\to 0, $$\n其中 $K_1$ 是一个与 $h$ 无关的常数。\n\n情况2：二次单元 ($p=2$)。\n离散解记为 $\\boldsymbol{u}_{h}^{(2)}$。在插值误差估计中设 $p=2$：\n$$ |\\boldsymbol{u} - \\mathcal{I}_{h}^{(2)}\\boldsymbol{u}|_{H^1(\\Omega)} \\le C_2 h^{\\min(2+1, 3) - 1} |\\boldsymbol{u}|_{H^{\\min(3,3)}(\\Omega)} = C_2 h^{\\min(3, 3) - 1} |\\boldsymbol{u}|_{H^3(\\Omega)} = C_2 h^{3-1} |\\boldsymbol{u}|_{H^3(\\Omega)} = C_2 h^2 |\\boldsymbol{u}|_{H^3(\\Omega)}. $$\n能量范数下的误差由以下不等式界定：\n$$ \\|\\boldsymbol{u} - \\boldsymbol{u}_{h}^{(2)}\\|_{E} \\le C_{\\text{Céa}}\\beta C_2 h^2 |\\boldsymbol{u}|_{H^3(\\Omega)}. $$\n二次单元误差的主阶行为是：\n$$ \\|\\boldsymbol{u} - \\boldsymbol{u}_{h}^{(2)}\\|_{E} \\sim K_2 h^2 \\quad \\text{当 } h \\to 0, $$\n其中 $K_2$ 是一个与 $h$ 无关的常数。所需的正则性 $\\boldsymbol{u} \\in [H^3(\\Omega)]^3$ 正是为了在能量范数下达到这个最优的二次收敛率。\n\n最后，我们计算所需的误差减小因子 $\\rho(\\hat{h})$。根据定义：\n$$ \\rho(h) = \\frac{\\|\\boldsymbol{u} - \\boldsymbol{u}_{h}^{(2)}\\|_{E}}{\\|\\boldsymbol{u} - \\boldsymbol{u}_{h}^{(1)}\\|_{E}}. $$\n当 $h \\to 0$ 时，代入主阶渐近行为：\n$$ \\rho(h) \\sim \\frac{K_2 h^2}{K_1 h} = \\left(\\frac{K_2}{K_1}\\right) h. $$\n问题要求用无量纲网格参数 $\\hat{h} = h/L$ 来表示该表达式，其中 $L$ 是域 $\\Omega$ 的直径。代入 $h = L\\hat{h}$：\n$$ \\rho(\\hat{h}) \\sim \\left(\\frac{K_2}{K_1}\\right) (L\\hat{h}) = \\left(\\frac{K_2 L}{K_1}\\right) \\hat{h}. $$\n问题要求的是主阶渐近表达式，不考虑与 $\\hat{h}$ 无关的乘法常数。项 $\\left(\\frac{K_2 L}{K_1}\\right)$ 就是这样一个常数。对 $\\hat{h}$ 的函数依赖性是线性的。因此，主阶渐近表达式与 $\\hat{h}$ 成正比。表示这种行为的最简单形式就是 $\\hat{h}$ 本身。",
            "answer": "$$\\boxed{\\hat{h}}$$"
        },
        {
            "introduction": "生物组织的动态模拟（例如，冲击或振动分析）不仅需要刚度矩阵来描述弹性，还需要质量矩阵来刻画惯性效应。质量项的离散化方式对模拟的稳定性与准确性有着深远的影响。本实践  将引导您为一个具有非均匀材料属性的系统，分别构建其一致质量矩阵（consistent mass matrix）和集中质量矩阵（lumped mass matrix）。通过求解并比较两种质量模型下显式时间积分的稳定性极限，您将亲身体验计算动力学中的一个关键权衡：一致质量矩阵的更高精度与集中质量矩阵的计算优势（如对角化带来的便利）之间的博弈。",
            "id": "4190632",
            "problem": "一根细长的生物纤维（例如，肌腱束）长度为 $L$，横截面积恒为 $A$，使用有限元法（FEM）进行一维建模，以分析其轴向振动。其杨氏模量 $E$ 是恒定的，但材料密度沿其长度呈线性函数 $\\rho(x)$ 变化，两端的值分别为 $x=0$ 处的 $\\rho_0$ 和 $x=L$ 处的 $\\rho_1$。网格由 $N_e$ 个线性二节点杆单元组成。平面外厚度已包含在 $A$ 中，因此不使用单独的厚度值。所有物理量均采用国际单位制（SI）：长度单位为米（$\\mathrm{m}$），面积单位为平方米（$\\mathrm{m}^2$），密度单位为千克每立方米（$\\mathrm{kg/m^3}$），杨氏模量单位为帕斯卡（$\\mathrm{Pa}$），时间单位为秒（$\\mathrm{s}$）。$x=0$ 处的左端是固定的（狄利克雷边界条件），右端是自由的。您必须构建并组装一致质量矩阵，并将其与集总质量近似进行比较，比较的依据是使用中心差分法（CDM）进行显式时间积分时对时间步长 $\\Delta t$ 的稳定性约束。\n\n从动能原理和标准伽辽金投影出发，考虑每个单元上的轴向位移场近似 $u(x,t)=\\sum_i N_i(x)\\,d_i(t)$，其中 $N_i(x)$ 是线性形函数，$d_i(t)$ 是节点位移。一维杆的动能为\n$$\nT(t)=\\frac{1}{2}\\int_0^L \\rho(x)\\,A\\,\\dot{u}(x,t)^2\\,\\mathrm{d}x.\n$$\n使用此公式推导单元一致质量矩阵 $M_e$ 的各项，其形式为积分\n$$\nM_e(i,j)=\\int_{x_e}^{x_{e+1}} \\rho(x)\\,A\\,N_i(x)\\,N_j(x)\\,\\mathrm{d}x,\n$$\n并通过将每个单元的贡献累加到相应的全局自由度中，组装全局一致质量矩阵 $M$。通过一致质量矩阵的行和对角化来定义集总质量矩阵 $M^{\\ell}$，即将 $M$ 的行和移至其对角线上，以保持总质量不变。\n\n类似地，从内部应变能和线性形函数出发，使用以下公式推导并组装用于轴向变形的全局刚度矩阵 $K$：\n$$\nK_e = \\int_{x_e}^{x_{e+1}} E\\,A\\,B^\\mathsf{T}B\\,\\mathrm{d}x,\n$$\n其中 $B=\\frac{dN}{dx}$ 是线性单元上的常应变-位移矩阵。\n\n对于无阻尼半离散系统 $M\\,\\ddot{d}(t)+K\\,d(t)=0$，通过移除受约束的自由度来施加左端固定边界条件，以获得缩减矩阵 $\\tilde{M}$ 和 $\\tilde{K}$。中心差分法（CDM）的更新可以对广义特征值问题的每个特征模态以模态形式写出\n$$\n\\tilde{K}\\,\\phi = \\lambda\\,\\tilde{M}\\,\\phi,\n$$\n其中模态圆频率为 $\\omega=\\sqrt{\\lambda}$。无阻尼线性系统的 CDM 稳定性要求为\n$$\n\\Delta t \\le \\frac{2}{\\omega_{\\max}},\n$$\n其中 $\\omega_{\\max}$ 是离散系统所有模态中的最大模态圆频率。对每种情况计算此约束两次：一次使用一致质量矩阵 $\\tilde{M}$，另一次使用集总质量矩阵 $\\tilde{M}^{\\ell}$。\n\n您的程序必须：\n- 构建并组装具有空间变化密度的全局一致质量矩阵，对线性单元和每个单元上线性变化的 $\\rho(x)$ 使用精确或足够精确的数值积分。\n- 为轴向线性单元组装全局刚度矩阵。\n- 通过移除相应的自由度来施加左端的固定边界条件。\n- 对两种质量模型求解广义特征值问题，以获得 $\\omega_{\\max}$ 并计算最大稳定时间步长 $\\Delta t_{\\max} = 2/\\omega_{\\max}$（单位：秒）。\n- 使用数值积分，该积分对于每个线性单元上的线性密度乘以二次形函数乘积是精确的。\n- 以秒为单位报告所有 $\\Delta t_{\\max}$ 值，并四舍五入到六位有效数字。\n\n测试套件（四个案例，涵盖基准、梯度密度、高刚度和最小单元边缘情况）。对于每种情况，密度均按 $\\rho(x)=\\rho_0 + (\\rho_1-\\rho_0)\\,x/L$ 线性变化：\n1. 基准软组织样：$E=5.0\\times 10^5\\,\\mathrm{Pa}$，$L=0.1\\,\\mathrm{m}$，$A=1.0\\times 10^{-4}\\,\\mathrm{m}^2$，$N_e=8$，$\\rho_0=1050\\,\\mathrm{kg/m^3}$，$\\rho_1=1050\\,\\mathrm{kg/m^3}$。\n2. 梯度密度：$E=8.0\\times 10^5\\,\\mathrm{Pa}$，$L=0.08\\,\\mathrm{m}$，$A=8.0\\times 10^{-5}\\,\\mathrm{m}^2$，$N_e=6$，$\\rho_0=900\\,\\mathrm{kg/m^3}$，$\\rho_1=1500\\,\\mathrm{kg/m^3}$。\n3. 极硬节段：$E=1.2\\times 10^9\\,\\mathrm{Pa}$，$L=0.05\\,\\mathrm{m}$，$A=2.0\\times 10^{-5}\\,\\mathrm{m}^2$，$N_e=12$，$\\rho_0=1800\\,\\mathrm{kg/m^3}$，$\\rho_1=1800\\,\\mathrm{kg/m^3}$。\n4. 最小网格边缘情况：$E=5.0\\times 10^7\\,\\mathrm{Pa}$，$L=0.02\\,\\mathrm{m}$，$A=1.0\\times 10^{-5}\\,\\mathrm{m}^2$，$N_e=1$，$\\rho_0=1200\\,\\mathrm{kg/m^3}$，$\\rho_1=1000\\,\\mathrm{kg/m^3}$。\n\n最终输出格式规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容为结果，单位为秒，四舍五入到六位有效数字。\n- 该列表必须按以下顺序包含八个值：$[\\Delta t_{\\text{cons},1}, \\Delta t_{\\text{lump},1}, \\Delta t_{\\text{cons},2}, \\Delta t_{\\text{lump},2}, \\Delta t_{\\text{cons},3}, \\Delta t_{\\text{lump},3}, \\Delta t_{\\text{cons},4}, \\Delta t_{\\text{lump},4}]$，其中下标表示测试案例索引，“cons”/“lump” 分别表示一致质量或集总质量。",
            "solution": "该问题要求确定使用中心差分法（CDM）对一维杆的轴向振动进行显式时间积分时的最大稳定时间步长 $\\Delta t_{\\max}$。此计算需要针对两种不同的质量矩阵公式进行：一致质量矩阵和集总质量矩阵。该杆具有恒定的横截面积 $A$ 和杨氏模量 $E$，但其密度 $\\rho(x)$ 沿其长度 $L$ 线性变化。\n\n分析过程包括以下步骤：\n1.  使用有限元法（FEM）对连续域进行离散化。\n2.  推导和组装单元刚度矩阵和单元一致质量矩阵。\n3.  组装全局刚度矩阵（$K$）和全局一致质量矩阵（$M$）。\n4.  根据一致质量矩阵构建全局集总质量矩阵（$M^{\\ell}$）。\n5.  施加固定边界条件以获得缩减后的系统矩阵。\n6.  对两种质量模型求解广义特征值问题，以找到最大固有频率 $\\omega_{\\max}$。\n7.  计算临界时间步长限制 $\\Delta t_{\\max} = 2/\\omega_{\\max}$。\n\n**1. 离散化与形函数**\n长度为 $L$ 的一维域被离散为 $N_e$ 个线性二节点单元，每个单元的长度为 $h_e = L/N_e$。全局节点位于位置 $x_i = i \\cdot h_e$，其中 $i \\in \\{0, 1, \\dots, N_e\\}$。对于连接全局节点 $i$ 和 $i+1$ 的通用单元，其轴向位移场 $u(x,t)$ 可近似为：\n$$\nu(x,t) = N_1(x)d_i(t) + N_2(x)d_{i+1}(t)\n$$\n其中 $d_i(t)$ 和 $d_{i+1}(t)$ 是节点位移，$N_1(x)$ 和 $N_2(x)$ 是单元的线性拉格朗日形函数。在局部坐标系 $\\tilde{x} \\in [0, h_e]$ 中，它们是：\n$$\nN_1(\\tilde{x}) = 1 - \\frac{\\tilde{x}}{h_e} \\quad , \\quad N_2(\\tilde{x}) = \\frac{\\tilde{x}}{h_e}\n$$\n\n**2. 单元刚度矩阵 ($K_e$)**\n单元刚度矩阵由应变能推导得出。对于具有恒定 $E$ 和 $A$ 的杆单元，其表达式为：\n$$\nK_e = \\int_{0}^{h_e} E A B^\\mathsf{T}B \\,\\mathrm{d}\\tilde{x}\n$$\n其中 $B$ 是应变-位移矩阵，包含形函数的空间导数：\n$$\nB = \\begin{bmatrix} \\frac{dN_1}{d\\tilde{x}}  \\frac{dN_2}{d\\tilde{x}} \\end{bmatrix} = \\begin{bmatrix} -\\frac{1}{h_e}  \\frac{1}{h_e} \\end{bmatrix} = \\frac{1}{h_e}\\begin{bmatrix} -1  1 \\end{bmatrix}\n$$\n乘积 $B^\\mathsf{T}B$ 在单元内是常数：\n$$\nB^\\mathsf{T}B = \\frac{1}{h_e^2}\\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\n由于 $E$、$A$ 和 $B$ 在单元上是常数，积分很简单：\n$$\nK_e = E A (B^\\mathsf{T}B) \\int_{0}^{h_e} \\,\\mathrm{d}\\tilde{x} = E A (B^\\mathsf{T}B) h_e = \\frac{EA}{h_e} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\n这是一维线性杆单元的标准刚度矩阵。\n\n**3. 单元一致质量矩阵 ($M_e$)**\n单元一致质量矩阵源于动能表达式，定义为：\n$$\nM_e(i,j) = \\int_{x_e}^{x_{e+1}} \\rho(x) A N_i(x) N_j(x) \\,\\mathrm{d}x\n$$\n密度 $\\rho(x)$ 在整个杆上线性变化：$\\rho(x) = \\rho_0 + (\\rho_1 - \\rho_0) \\frac{x}{L}$。在位于位置 $x_e$ 和 $x_{e+1}$ 的节点 $e$ 和 $e+1$ 之间的单元内，密度分别为 $\\rho_e = \\rho(x_e)$ 和 $\\rho_{e+1} = \\rho(x_{e+1})$。单元内的密度可以使用相同的形函数进行线性插值：\n$$\n\\rho(\\tilde{x}) = N_1(\\tilde{x})\\rho_e + N_2(\\tilde{x})\\rho_{e+1}\n$$\n质量矩阵项的积分涉及多项式的乘积。$M_e(i,j)$ 的被积函数是 $\\rho(x)N_i(x)N_j(x)$，这是一个最高次数为 $1+1+1=3$ 的多项式。这些积分可以解析计算，这等效于使用对三次多项式精确的求积法则（例如，2 点高斯求积）。对于局部坐标 $\\tilde{x} \\in [0, h_e]$，矩阵项为：\n$$\nM_{e,11} = A \\int_{0}^{h_e} (N_1\\rho_e + N_2\\rho_{e+1})N_1^2 \\,\\mathrm{d}\\tilde{x} = A h_e \\left( \\frac{\\rho_e}{4} + \\frac{\\rho_{e+1}}{12} \\right)\n$$\n$$\nM_{e,12} = M_{e,21} = A \\int_{0}^{h_e} (N_1\\rho_e + N_2\\rho_{e+1})N_1 N_2 \\,\\mathrm{d}\\tilde{x} = A h_e \\left( \\frac{\\rho_e}{12} + \\frac{\\rho_{e+1}}{12} \\right)\n$$\n$$\nM_{e,22} = A \\int_{0}^{h_e} (N_1\\rho_e + N_2\\rho_{e+1})N_2^2 \\,\\mathrm{d}\\tilde{x} = A h_e \\left( \\frac{\\rho_e}{12} + \\frac{\\rho_{e+1}}{4} \\right)\n$$\n组合这些项，单元一致质量矩阵为：\n$$\nM_e = \\frac{A h_e}{12} \\begin{bmatrix} 3\\rho_e + \\rho_{e+1}  \\rho_e + \\rho_{e+1} \\\\ \\rho_e + \\rho_{e+1}  \\rho_e + 3\\rho_{e+1} \\end{bmatrix}\n$$\n如果密度是恒定的，即 $\\rho_e = \\rho_{e+1} = \\rho$，则该矩阵可正确简化为标准形式 $M_e = \\frac{\\rho A h_e}{6}\\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix}$。\n\n**4. 全局矩阵和边界条件**\n大小均为 $(N_e+1) \\times (N_e+1)$ 的全局刚度矩阵 $K$ 和全局一致质量矩阵 $M$ 是通过遍历所有 $N_e$ 个单元，并将 $K_e$ 和 $M_e$ 的项加到相应的全局位置来组装的。\n集总质量矩阵 $M^{\\ell}$ 是一个对角矩阵，其中每个对角项 $M^{\\ell}_{ii}$ 是一致质量矩阵 $M$ 第 $i$ 行所有元素的和：\n$$\nM^{\\ell}_{ii} = \\sum_{j=0}^{N_e} M_{ij} \\quad, \\quad M^{\\ell}_{ij} = 0 \\text{ for } i \\neq j\n$$\n左端（$x=0$，节点 0）是固定的，意味着其位移 $d_0$ 为零。通过从全局矩阵 $K$、$M$ 和 $M^{\\ell}$ 中移除第一行和第一列来施加此边界条件，从而得到大小为 $N_e \\times N_e$ 的缩减矩阵 $\\tilde{K}$、$\\tilde{M}$ 和 $\\tilde{M}^{\\ell}$。\n\n**5. 特征值问题和稳定性分析**\n离散系统的无阻尼自由振动由 $M\\ddot{d} + Kd = 0$ 控制。施加边界条件后，自由自由度的方程为 $\\tilde{M}\\ddot{\\tilde{d}} + \\tilde{K}\\tilde{d} = 0$。系统的固有频率通过求解广义特征值问题得到：\n$$\n\\tilde{K}\\phi = \\lambda \\tilde{M}\\phi \\quad \\text{where } \\lambda = \\omega^2\n$$\n中心差分法的稳定性由离散系统的最高固有频率 $\\omega_{\\max} = \\sqrt{\\lambda_{\\max}}$ 决定。最大稳定时间步长为：\n$$\n\\Delta t_{\\max} \\le \\frac{2}{\\omega_{\\max}}\n$$\n此分析必须执行两次：一次使用缩减后的一致质量矩阵 $\\tilde{M}$ 求得 $\\Delta t_{\\text{cons}}$，另一次使用缩减后的集总质量矩阵 $\\tilde{M}^{\\ell}$ 求得 $\\Delta t_{\\text{lump}}$。通常，与一致质量公式相比，集总质量公式会产生更高的 $\\omega_{\\max}$，因此稳定性时间步长更严格（更小）。\n\n计算实现涉及构建一个遍历测试用例的循环。对于每个用例，逐个单元地组装全局矩阵。在施加固定边界条件后，使用 `scipy.linalg.eigh` 函数求解两个对称矩阵的广义特征值问题。所得特征值的最大实部提供了 $\\lambda_{\\max}$，并由此计算出 $\\Delta t_{\\max}$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef calculate_dt_max(E, L, A, Ne, rho0, rho1):\n    \"\"\"\n    Calculates the maximum stable time step for both consistent and lumped mass\n    formulations for a 1D bar with linearly varying density.\n\n    Args:\n        E (float): Young's modulus (Pa)\n        L (float): Length of the bar (m)\n        A (float): Cross-sectional area (m^2)\n        Ne (int): Number of elements\n        rho0 (float): Density at x=0 (kg/m^3)\n        rho1 (float): Density at x=L (kg/m^3)\n\n    Returns:\n        tuple[float, float]: A tuple containing (dt_max_consistent, dt_max_lumped).\n    \"\"\"\n    num_nodes = Ne + 1\n    h = L / Ne\n\n    # Initialize global matrices\n    K_global = np.zeros((num_nodes, num_nodes))\n    M_consistent_global = np.zeros((num_nodes, num_nodes))\n\n    # Element stiffness matrix (constant for all elements)\n    K_element = (E * A / h) * np.array([[1, -1], [-1, 1]])\n\n    # Assemble global stiffness and consistent mass matrices\n    for e in range(Ne):\n        node1_idx, node2_idx = e, e + 1\n        \n        # Nodal positions\n        x1 = node1_idx * h\n        x2 = node2_idx * h\n        \n        # Nodal densities from global linear function\n        rho_node1 = rho0 + (rho1 - rho0) * x1 / L\n        rho_node2 = rho0 + (rho1 - rho0) * x2 / L\n\n        # Element consistent mass matrix (variable density)\n        M_element = (A * h / 12) * np.array([\n            [3 * rho_node1 + rho_node2, rho_node1 + rho_node2],\n            [rho_node1 + rho_node2, rho_node1 + 3 * rho_node2]\n        ])\n\n        # Assemble into global matrices\n        indices = np.ix_([node1_idx, node2_idx], [node1_idx, node2_idx])\n        K_global[indices] += K_element\n        M_consistent_global[indices] += M_element\n\n    # Create lumped mass matrix from consistent matrix\n    row_sums = np.sum(M_consistent_global, axis=1)\n    M_lumped_global = np.diag(row_sums)\n\n    # Apply fixed boundary condition at x=0 (node 0)\n    # This involves removing the first row and column.\n    dof_slice = slice(1, None)\n    K_reduced = K_global[dof_slice, dof_slice]\n    M_consistent_reduced = M_consistent_global[dof_slice, dof_slice]\n    M_lumped_reduced = M_lumped_global[dof_slice, dof_slice]\n\n    # Solve generalized eigenvalue problem: K*phi = lambda*M*phi\n    # We use eigh as K and M matrices are symmetric and real.\n    \n    # Consistent Mass\n    eigvals_cons = eigh(K_reduced, M_consistent_reduced, eigvals_only=True)\n    lambda_max_cons = np.max(eigvals_cons)\n    omega_max_cons = np.sqrt(lambda_max_cons)\n    dt_max_cons = 2.0 / omega_max_cons\n\n    # Lumped Mass\n    eigvals_lump = eigh(K_reduced, M_lumped_reduced, eigvals_only=True)\n    lambda_max_lump = np.max(eigvals_lump)\n    omega_max_lump = np.sqrt(lambda_max_lump)\n    dt_max_lump = 2.0 / omega_max_lump\n    \n    return dt_max_cons, dt_max_lump\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # (E, L, A, Ne, rho0, rho1)\n        (5.0e5, 0.1, 1.0e-4, 8, 1050, 1050),\n        (8.0e5, 0.08, 8.0e-5, 6, 900, 1500),\n        (1.2e9, 0.05, 2.0e-5, 12, 1800, 1800),\n        (5.0e7, 0.02, 1.0e-5, 1, 1200, 1000),\n    ]\n\n    results = []\n    for case in test_cases:\n        dt_cons, dt_lump = calculate_dt_max(*case)\n        # Format to 6 significant digits\n        results.append(\"{:.6g}\".format(dt_cons))\n        results.append(\"{:.6g}\".format(dt_lump))\n\n    # Print the final output in the required format\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "许多生物组织，如心肌、肌腱或木材，都表现出显著的各向异性，即其力学特性在不同方向上有所不同。对于这类材料，有限元网格的质量不仅取决于单元的几何形状，更关键地取决于网格方向与材料内部微观结构的对齐程度。这个高级问题  将挑战您超越常规的几何网格剖分，为一个各向异性材料设计最优的网格。您将通过构建一个量化错位的泛函，并求解其最小值，来确定能够最大程度减小心肌组织离散化误差的网格方向，从而掌握创建高保真生物力学模型的一项高级技巧。",
            "id": "4190594",
            "problem": "一个二维有限元网格被用于离散化一个扁平化的心肌组织透壁切片。该组织表现出与局部心肌纤维方向一致的强正交各向异性，在平面中由单位向量场 $\\hat{f}(x,y)$ 建模，其方向角 $\\theta(x,y)$ 是相对于 $x$ 轴的。网格是结构化的，其主边方向可由一个相对于 $x$ 轴成 $\\phi$ 角的全局单位向量 $\\hat{t}(\\phi)$ 表示。在各向异性扩散和弹性公式中，由方向错位引起的主阶离散化误差与边方向 $\\hat{t}(\\phi)$ 和纤维方向 $\\hat{f}(x,y)$ 之间的不匹配成正比。假设各向异性权重 $w$ 是均匀且为正的，其中 $w$ 捕获了纵向和横向材料响应之间的差异（例如，对于电导率或刚度特征值，$w=\\lambda_{\\parallel}-\\lambda_{\\perp}$）。\n\n定义域为单位正方形 $D=[0,1]\\times[0,1]$。心肌纤维方向场由一个平滑变化的角度指定\n$$\n\\theta(x,y)=\\theta_{0}+\\alpha x+\\beta y,\n$$\n其中 $\\theta_{0}=\\frac{\\pi}{6}$，$\\alpha=\\frac{\\pi}{2}$，$\\beta=\\frac{\\pi}{3}$。网格主边方向为 $\\hat{t}(\\phi)=\\big(\\cos\\phi,\\sin\\phi\\big)$，纤维方向为 $\\hat{f}(x,y)=\\big(\\cos\\theta(x,y),\\sin\\theta(x,y)\\big)$。\n\n从各向异性方向对齐的第一性原理出发，即边的方向对纤维对齐算子的贡献由 $\\hat{t}(\\phi)$ 在 $\\hat{f}(x,y)$ 上的投影决定，推导一个域积分的标量错位泛函，并确定能最小化在 $D$ 上的这个积分各向异性错位的全局网格旋转角 $\\phi$。假设网格边的方向被指定，因此方向角不取模 $\\pi$，并将报告的最优角限制在区间 $[0,\\pi)$ 内。\n\n计算最优的 $\\phi$ 值（以弧度为单位）。如果您选择对任何三角函数值进行数值近似，请将最终角度四舍五入到四位有效数字。",
            "solution": "首先必须验证问题的陈述在科学合理性、适定性和客观性方面是否有效。\n\n### 步骤 1：提取已知条件\n- **定义域**：一个二维单位正方形，$D=[0,1]\\times[0,1]$。\n- **组织模型**：正交各向异性的心肌组织。各向异性与局部纤维方向 $\\hat{f}(x,y)$ 对齐。\n- **纤维方向场**：一个单位向量场 $\\hat{f}(x,y)$，其相对于 $x$ 轴的方向角为 $\\theta(x,y)=\\theta_{0}+\\alpha x+\\beta y$。\n- **常数**：$\\theta_{0}=\\frac{\\pi}{6}$，$\\alpha=\\frac{\\pi}{2}$，$\\beta=\\frac{\\pi}{3}$。\n- **网格模型**：一个结构化网格，具有单一的全局主边方向，由单位向量 $\\hat{t}(\\phi)$ 给出，该向量与 $x$ 轴成 $\\phi$ 角。\n- **向量**：$\\hat{t}(\\phi)=\\big(\\cos\\phi,\\sin\\phi\\big)$ 和 $\\hat{f}(x,y)=\\big(\\cos\\theta(x,y),\\sin\\theta(x,y)\\big)$。\n- **误差原理**：主阶离散化误差与 $\\hat{t}(\\phi)$ 和 $\\hat{f}(x,y)$ 之间的不匹配成正比。边的方向对纤维对齐算子的贡献由 $\\hat{t}(\\phi)$ 在 $\\hat{f}(x,y)$ 上的投影决定。\n- **各向异性权重**：一个均匀正常数 $w$。\n- **任务**：推导一个域积分的标量错位泛函，并找到能最小化此泛函的全局网格旋转角 $\\phi \\in [0,\\pi)$。\n- **角度约定**：边方向不取模 $\\pi$。然而，这个细节不影响所选择的错位泛函，因为该泛函基于角度差的正弦函数平方，使其固有地对 $\\pi$ 旋转不敏感。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学或事实不健全性**：该问题是科学合理的。它模拟了计算生物力学中的一个标准问题：为各向异性材料优化网格对齐。其数学表述（向量场、角度、积分）与有限元分析和连续介质力学的既定原则一致。\n2.  **不可形式化或不相关**：该问题是高度可形式化的，并且与生物结构的网格划分和离散化主题直接相关，这是生物力学中的一个关键领域。\n3.  **不完整或矛盾的设置**：该问题是自洽的。所有必要的函数、常数和感兴趣的域都已明确定义。\n4.  **不切实际或不可行**：纤维角度的线性变化是模拟局部组织切片的有效且常见的简化方法。指定的常数在物理上和数学上都是合理的。\n5.  **病态或结构不良**：该问题是适定的。它要求在一个紧区间上最小化一个连续且可微的泛函，这保证了最小值的存在。从第一性原理推导泛函的指令是清晰的。\n6.  **伪深刻、琐碎或同义反复**：该问题并非微不足道，它需要多元微积分以及对优化原理和向量分析的理解。\n7.  **无法进行科学验证**：该问题是一个基于物理模型的数学优化任务，并且是完全可验证的。\n\n### 步骤 3：结论与行动\n该问题是有效的。将提供完整的解决方案。\n\n问题要求找到全局网格旋转角 $\\phi$，以最小化在定义域 $D = [0,1]\\times[0,1]$ 上的积分各向异性错位。\n\n错位原理指出，误差与网格边向量 $\\hat{t}(\\phi)$ 和局部纤维向量 $\\hat{f}(x,y)$ 之间的不匹配成正比。一个标准的、有物理动机的衡量两个单位向量之间错位的度量是它们之间夹角的正弦值的平方。这个量在完美对齐时为零，在向量正交时达到最大值。它可以从一个向量在另一个向量正交方向上的分量的平方模长推导出来：$||\\hat{t} - (\\hat{t}\\cdot\\hat{f})\\hat{f}||^2 = 1 - (\\hat{t}\\cdot\\hat{f})^2 = \\sin^2(\\theta(x,y)-\\phi)$。\n\n域积分的标量错位泛函 $J(\\phi)$ 是这个局部错位度量在定义域 $D$ 上的积分，并由常数各向异性因子 $w$ 加权：\n$$J(\\phi) = \\int_{D} w \\sin^2(\\theta(x,y) - \\phi) \\, \\mathrm{d}A$$\n因为 $w$ 是一个正常数，最小化 $J(\\phi)$ 等价于最小化积分部分。我们使用恒等式 $\\sin^2(z) = \\frac{1}{2}(1 - \\cos(2z))$ 来重写泛函：\n$$J(\\phi) = \\frac{w}{2} \\int_0^1 \\int_0^1 [1 - \\cos(2(\\theta(x,y) - \\phi))] \\, \\mathrm{d}x \\, \\mathrm{d}y$$\n$$J(\\phi) = \\frac{w}{2} \\left[ \\int_0^1 \\int_0^1 1 \\, \\mathrm{d}x \\, \\mathrm{d}y - \\int_0^1 \\int_0^1 \\cos(2\\theta(x,y) - 2\\phi) \\, \\mathrm{d}x \\, \\mathrm{d}y \\right]$$\n第一个积分的值是单位正方形的面积，即 $1$。\n$$J(\\phi) = \\frac{w}{2} \\left[ 1 - \\int_0^1 \\int_0^1 \\cos(2\\theta(x,y) - 2\\phi) \\, \\mathrm{d}x \\, \\mathrm{d}y \\right]$$\n为了最小化 $J(\\phi)$，我们必须最大化积分项，我们将其表示为 $I(\\phi)$：\n$$I(\\phi) = \\int_0^1 \\int_0^1 \\cos(2\\theta(x,y) - 2\\phi) \\, \\mathrm{d}x \\, \\mathrm{d}y$$\n使用余弦差角公式 $\\cos(A-B) = \\cos A \\cos B + \\sin A \\sin B$：\n$$I(\\phi) = \\int_0^1 \\int_0^1 [\\cos(2\\theta(x,y))\\cos(2\\phi) + \\sin(2\\theta(x,y))\\sin(2\\phi)] \\, \\mathrm{d}x \\, \\mathrm{d}y$$\n依赖于 $\\phi$ 的项可以从积分中提出：\n$$I(\\phi) = \\left(\\int_0^1 \\int_0^1 \\cos(2\\theta(x,y)) \\, \\mathrm{d}x \\, \\mathrm{d}y\\right)\\cos(2\\phi) + \\left(\\int_0^1 \\int_0^1 \\sin(2\\theta(x,y)) \\, \\mathrm{d}x \\, \\mathrm{d}y\\right)\\sin(2\\phi)$$\n让我们定义常数 $C$ 和 $S$ 为这些定积分的结果：\n$$C = \\int_0^1 \\int_0^1 \\cos(2\\theta(x,y)) \\, \\mathrm{d}x \\, \\mathrm{d}y \\quad \\text{和} \\quad S = \\int_0^1 \\int_0^1 \\sin(2\\theta(x,y)) \\, \\mathrm{d}x \\, \\mathrm{d}y$$\n需要最大化的表达式变为 $I(\\phi) = C \\cos(2\\phi) + S \\sin(2\\phi)$。这是常数向量 $(C, S)$ 和单位向量 $(\\cos(2\\phi), \\sin(2\\phi))$ 的点积。当这两个向量平行时，该点积最大化，这意味着它们的角度相等。$(\\cos(2\\phi), \\sin(2\\phi))$ 的角度是 $2\\phi$，而 $(C, S)$ 的角度是 $\\mathrm{atan2}(S, C)$。因此，为了获得最大值：\n$$2\\phi = \\mathrm{atan2}(S, C)$$\n现在我们用 $\\theta(x,y) = \\theta_0 + \\alpha x + \\beta y$ 和给定的常数 $\\theta_0=\\frac{\\pi}{6}$，$\\alpha=\\frac{\\pi}{2}$，$\\beta=\\frac{\\pi}{3}$ 来计算 $C$ 和 $S$。\n设 $I_c = \\int_0^1 \\int_0^1 \\cos(2\\alpha x + 2\\beta y) \\, \\mathrm{d}x \\, \\mathrm{d}y$ 和 $I_s = \\int_0^1 \\int_0^1 \\sin(2\\alpha x + 2\\beta y) \\, \\mathrm{d}x \\, \\mathrm{d}y$。然后，使用和角公式，我们将 $C$ 和 $S$ 表示为：\n$C = \\cos(2\\theta_0) I_c - \\sin(2\\theta_0) I_s$\n$S = \\sin(2\\theta_0) I_c + \\cos(2\\theta_0) I_s$\n\n我们用 $2\\alpha = \\pi$ 和 $2\\beta = \\frac{2\\pi}{3}$ 来计算 $I_c$ 和 $I_s$：\n$$I_c = \\int_0^1 \\left[ \\frac{\\sin(\\pi x + \\frac{2\\pi}{3} y)}{\\pi} \\right]_{x=0}^{x=1} \\, \\mathrm{d}y = \\frac{1}{\\pi}\\int_0^1 \\left(\\sin(\\pi + \\frac{2\\pi}{3} y) - \\sin(\\frac{2\\pi}{3} y)\\right) \\, \\mathrm{d}y$$\n使用 $\\sin(\\pi+z) = -\\sin(z)$：\n$$I_c = \\frac{1}{\\pi}\\int_0^1 (-2)\\sin(\\frac{2\\pi}{3} y) \\, \\mathrm{d}y = -\\frac{2}{\\pi} \\left[ \\frac{-\\cos(\\frac{2\\pi}{3}y)}{2\\pi/3} \\right]_0^1 = \\frac{3}{\\pi^2}\\left[\\cos(\\frac{2\\pi}{3}) - \\cos(0)\\right] = \\frac{3}{\\pi^2}(-\\frac{1}{2}-1) = -\\frac{9}{2\\pi^2}$$\n对于 $I_s$：\n$$I_s = \\int_0^1 \\left[ \\frac{-\\cos(\\pi x + \\frac{2\\pi}{3} y)}{\\pi} \\right]_{x=0}^{x=1} \\, \\mathrm{d}y = \\frac{1}{\\pi}\\int_0^1 \\left(-\\cos(\\pi + \\frac{2\\pi}{3} y) + \\cos(\\frac{2\\pi}{3} y)\\right) \\, \\mathrm{d}y$$\n使用 $\\cos(\\pi+z) = -\\cos(z)$：\n$$I_s = \\frac{1}{\\pi}\\int_0^1 2\\cos(\\frac{2\\pi}{3} y) \\, \\mathrm{d}y = \\frac{2}{\\pi} \\left[ \\frac{\\sin(\\frac{2\\pi}{3}y)}{2\\pi/3} \\right]_0^1 = \\frac{3}{\\pi^2}\\left[\\sin(\\frac{2\\pi}{3}) - \\sin(0)\\right] = \\frac{3}{\\pi^2}\\left(\\frac{\\sqrt{3}}{2}\\right) = \\frac{3\\sqrt{3}}{2\\pi^2}$$\n现在我们使用 $2\\theta_0 = \\frac{\\pi}{3}$ 来计算 $C$ 和 $S$，此时 $\\cos(\\frac{\\pi}{3}) = \\frac{1}{2}$ 且 $\\sin(\\frac{\\pi}{3}) = \\frac{\\sqrt{3}}{2}$：\n$$C = \\frac{1}{2} I_c - \\frac{\\sqrt{3}}{2} I_s = \\frac{1}{2}\\left(-\\frac{9}{2\\pi^2}\\right) - \\frac{\\sqrt{3}}{2}\\left(\\frac{3\\sqrt{3}}{2\\pi^2}\\right) = -\\frac{9}{4\\pi^2} - \\frac{9}{4\\pi^2} = -\\frac{18}{4\\pi^2} = -\\frac{9}{2\\pi^2}$$\n$$S = \\frac{\\sqrt{3}}{2} I_c + \\frac{1}{2} I_s = \\frac{\\sqrt{3}}{2}\\left(-\\frac{9}{2\\pi^2}\\right) + \\frac{1}{2}\\left(\\frac{3\\sqrt{3}}{2\\pi^2}\\right) = \\frac{-9\\sqrt{3} + 3\\sqrt{3}}{4\\pi^2} = -\\frac{6\\sqrt{3}}{4\\pi^2} = -\\frac{3\\sqrt{3}}{2\\pi^2}$$\n现在我们确定角度 $2\\phi = \\mathrm{atan2}(S, C)$。因为 $C$ 和 $S$ 都是负数，所以角度 $2\\phi$ 位于第三象限。\n该角度的正切值为：\n$$\\tan(2\\phi) = \\frac{S}{C} = \\frac{-3\\sqrt{3}/(2\\pi^2)}{-9/(2\\pi^2)} = \\frac{3\\sqrt{3}}{9} = \\frac{\\sqrt{3}}{3}$$\n正切值为 $\\frac{\\sqrt{3}}{3}$ 的参考角是 $\\frac{\\pi}{6}$。由于 $2\\phi$ 在第三象限，我们有：\n$$2\\phi = \\pi + \\frac{\\pi}{6} = \\frac{7\\pi}{6}$$\n求解 $\\phi$ 得到最优的网格旋转角：\n$$\\phi = \\frac{7\\pi}{12}$$\n此角度在所要求的区间 $[0,\\pi)$ 内。该解对应于 $J(\\phi)$ 的最小值，因为它最大化了项 $I(\\phi)$，这一点可以通过二阶导数检验来验证。",
            "answer": "$$\\boxed{\\frac{7\\pi}{12}}$$"
        }
    ]
}