{
    "hands_on_practices": [
        {
            "introduction": "Before any physical analysis can be performed, we must ensure our digital representation of the geometry is valid. This is especially true in Isogeometric Analysis (IGA), where complex shapes are defined by parametric mappings. This practice  provides a concrete exercise in evaluating the geometric mapping's validity by calculating the Jacobian determinant, a key metric that must remain positive to ensure the element is not unphysically distorted or inverted.",
            "id": "4190650",
            "problem": "A biomechanical model of a small tissue block (e.g., trabecular bone segment) is represented as a trivariate Non-Uniform Rational B-Splines (NURBS) volume patch of polynomial degree $p=q=r=1$ with open uniform knot vectors in each parametric direction $\\xi$, $\\eta$, and $\\zeta$ equal to $[0,0,1,1]$. All weights are $w=1$. The parametric domain is $[0,1] \\times [0,1] \\times [0,1]$. The control point grid $\\{\\boldsymbol{P}_{i,j,k}\\}$, $i,j,k\\in\\{0,1\\}$, is given in millimeters and arranged to form a parallelepiped defined by three spanning vectors:\n- $\\boldsymbol{v}_{1} = (1.2,\\,0.3,\\,0.1)$,\n- $\\boldsymbol{v}_{2} = (0.2,\\,1.0,\\,0.4)$,\n- $\\boldsymbol{v}_{3} = (0.1,\\,0.2,\\,1.5)$,\nwith $\\boldsymbol{P}_{000}=(0,\\,0,\\,0)$. The eight control points are thus\n$\\boldsymbol{P}_{000}=\\boldsymbol{P}_{000}$, $\\boldsymbol{P}_{100}=\\boldsymbol{P}_{000}+\\boldsymbol{v}_{1}$, $\\boldsymbol{P}_{010}=\\boldsymbol{P}_{000}+\\boldsymbol{v}_{2}$, $\\boldsymbol{P}_{110}=\\boldsymbol{P}_{000}+\\boldsymbol{v}_{1}+\\boldsymbol{v}_{2}$, $\\boldsymbol{P}_{001}=\\boldsymbol{P}_{000}+\\boldsymbol{v}_{3}$, $\\boldsymbol{P}_{101}=\\boldsymbol{P}_{000}+\\boldsymbol{v}_{1}+\\boldsymbol{v}_{3}$, $\\boldsymbol{P}_{011}=\\boldsymbol{P}_{000}+\\boldsymbol{v}_{2}+\\boldsymbol{v}_{3}$, and $\\boldsymbol{P}_{111}=\\boldsymbol{P}_{000}+\\boldsymbol{v}_{1}+\\boldsymbol{v}_{2}+\\boldsymbol{v}_{3}$. Using this data:\n\n- Starting from the definitions of Non-Uniform Rational B-Splines (NURBS) and tensor-product B-splines, derive the isoparametric mapping $\\boldsymbol{x}(\\xi,\\eta,\\zeta)$, the Jacobian matrix $J(\\xi,\\eta,\\zeta)=\\frac{\\partial \\boldsymbol{x}}{\\partial(\\xi,\\eta,\\zeta)}$, and its determinant $\\det(J)$.\n\n- Using two-point Gaussian quadrature in each parameter on $[0,1]$, with points at $\\xi_{\\pm}=\\frac{1}{2}\\left(1\\pm\\frac{1}{\\sqrt{3}}\\right)$, $\\eta_{\\pm}=\\frac{1}{2}\\left(1\\pm\\frac{1}{\\sqrt{3}}\\right)$, and $\\zeta_{\\pm}=\\frac{1}{2}\\left(1\\pm\\frac{1}{\\sqrt{3}}\\right)$, evaluate $J$ and $\\det(J)$ at all eight Gaussian quadrature points of the element and use these values to assess whether the element is valid for Isogeometric Analysis (IGA).\n\n- Discuss principled criteria for rejecting invalid parametric elements in isogeometric analysis for biomechanics, grounded in the requirement that the geometric mapping be regular and orientation-preserving.\n\nReport the minimum value of $\\det(J)$ across all Gaussian quadrature points. Express your final answer in $\\mathrm{mm}^{3}$ and round your answer to four significant figures.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. It provides a complete and consistent set of data for the analysis of an isoparametric mapping in the context of Isogeometric Analysis (IGA), which is a standard and rigorous topic in computational biomechanics. All provided definitions and values are standard and do not violate any scientific or mathematical principles. Therefore, the problem is valid, and a full solution is presented below.\n\nThe core of the problem is to characterize the geometric mapping from a parametric domain to a physical domain. The mapping is defined by a trivariate Non-Uniform Rational B-Splines (NURBS) formulation. The general form for a NURBS volume is given by:\n$$\n\\boldsymbol{x}(\\xi, \\eta, \\zeta) = \\frac{\\sum_{i=0}^{n} \\sum_{j=0}^{m} \\sum_{k=0}^{l} N_{i,p}(\\xi) N_{j,q}(\\eta) N_{k,r}(\\zeta) w_{i,j,k} \\boldsymbol{P}_{i,j,k}}{\\sum_{i=0}^{n} \\sum_{j=0}^{m} \\sum_{k=0}^{l} N_{i,p}(\\xi) N_{j,q}(\\eta) N_{k,r}(\\zeta) w_{i,j,k}}\n$$\nwhere $N_{i,p}$, $N_{j,q}$, and $N_{k,r}$ are the B-spline basis functions of degree $p$, $q$, and $r$ respectively, $\\{\\boldsymbol{P}_{i,j,k}\\}$ is the grid of control points, and $\\{w_{i,j,k}\\}$ are the associated weights.\n\nIn this specific problem, all weights are given as $w_{i,j,k} = 1$. When all weights are uniform, the denominator, which is the sum of all basis functions multiplied by their weights, simplifies to $\\sum N_{i,p}N_{j,q}N_{k,r} = (\\sum N_{i,p})(\\sum N_{j,q})(\\sum N_{k,r})$. Since B-spline basis functions form a partition of unity, $\\sum_{i} N_{i,p}(\\xi) = 1$ for any $\\xi$ in the domain. Thus, the denominator is equal to $1$, and the NURBS mapping reduces to a simpler tensor-product B-spline mapping:\n$$\n\\boldsymbol{x}(\\xi, \\eta, \\zeta) = \\sum_{i=0}^{1} \\sum_{j=0}^{1} \\sum_{k=0}^{1} N_{i,1}(\\xi) N_{j,1}(\\eta) N_{k,1}(\\zeta) \\boldsymbol{P}_{i,j,k}\n$$\nThe problem specifies polynomial degrees $p=q=r=1$ and open uniform knot vectors $[0,0,1,1]$ in each parametric direction. For a degree $p=1$ and knot vector $[0,0,1,1]$, there are two basis functions, $N_{0,1}$ and $N_{1,1}$, which are the standard linear Lagrange polynomials on the interval $[0,1]$:\n$$\nN_{0,1}(\\xi) = 1-\\xi \\quad \\text{and} \\quad N_{1,1}(\\xi) = \\xi\n$$\nSimilarly, for the $\\eta$ and $\\zeta$ directions:\n$$\nN_{0,1}(\\eta) = 1-\\eta \\quad \\text{and} \\quad N_{1,1}(\\eta) = \\eta\n$$\n$$\nN_{0,1}(\\zeta) = 1-\\zeta \\quad \\text{and} \\quad N_{1,1}(\\zeta) = \\zeta\n$$\nSubstituting these basis functions into the B-spline mapping gives the standard trilinear interpolation formula:\n$$\n\\boldsymbol{x}(\\xi,\\eta,\\zeta) = \\sum_{i,j,k \\in \\{0,1\\}} N_{i,1}(\\xi)N_{j,1}(\\eta)N_{k,1}(\\zeta)\\boldsymbol{P}_{ijk}\n$$\nThe control points are defined to form a parallelepiped with one vertex at the origin, $\\boldsymbol{P}_{000} = (0,0,0) = \\boldsymbol{0}$, and spanning vectors $\\boldsymbol{v}_{1}$, $\\boldsymbol{v}_{2}$, and $\\boldsymbol{v}_{3}$. The explicit control point positions are:\n$\\boldsymbol{P}_{000}=\\boldsymbol{0}$, $\\boldsymbol{P}_{100}=\\boldsymbol{v}_{1}$, $\\boldsymbol{P}_{010}=\\boldsymbol{v}_{2}$, $\\boldsymbol{P}_{110}=\\boldsymbol{v}_{1}+\\boldsymbol{v}_{2}$, $\\boldsymbol{P}_{001}=\\boldsymbol{v}_{3}$, $\\boldsymbol{P}_{101}=\\boldsymbol{v}_{1}+\\boldsymbol{v}_{3}$, $\\boldsymbol{P}_{011}=\\boldsymbol{v}_{2}+\\boldsymbol{v}_{3}$, and $\\boldsymbol{P}_{111}=\\boldsymbol{v}_{1}+\\boldsymbol{v}_{2}+\\boldsymbol{v}_{3}$.\nSubstituting these into the expanded trilinear formula yields:\n$$\n\\begin{align*}\n\\boldsymbol{x}(\\xi,\\eta,\\zeta) = (1-\\xi)(1-\\eta)(1-\\zeta)\\boldsymbol{P}_{000} + \\xi(1-\\eta)(1-\\zeta)\\boldsymbol{P}_{100} + (1-\\xi)\\eta(1-\\zeta)\\boldsymbol{P}_{010} + (1-\\xi)(1-\\eta)\\zeta\\boldsymbol{P}_{001} \\\\\n+ \\xi\\eta(1-\\zeta)\\boldsymbol{P}_{110} + \\xi(1-\\eta)\\zeta\\boldsymbol{P}_{101} + (1-\\xi)\\eta\\zeta\\boldsymbol{P}_{011} + \\xi\\eta\\zeta\\boldsymbol{P}_{111}\n\\end{align*}\n$$\nPlugging in the vector definitions of the control points and collecting terms for $\\boldsymbol{v}_{1}$, $\\boldsymbol{v}_{2}$, and $\\boldsymbol{v}_{3}$:\n$$\n\\begin{align*}\n\\boldsymbol{x}(\\xi,\\eta,\\zeta) = \\boldsymbol{v}_{1} [ \\xi(1-\\eta)(1-\\zeta) + \\xi\\eta(1-\\zeta) + \\xi(1-\\eta)\\zeta + \\xi\\eta\\zeta ] \\\\\n+ \\boldsymbol{v}_{2} [ (1-\\xi)\\eta(1-\\zeta) + \\xi\\eta(1-\\zeta) + (1-\\xi)\\eta\\zeta + \\xi\\eta\\zeta ] \\\\\n+ \\boldsymbol{v}_{3} [ (1-\\xi)(1-\\eta)\\zeta + \\xi(1-\\eta)\\zeta + (1-\\xi)\\eta\\zeta + \\xi\\eta\\zeta ]\n\\end{align*}\n$$\nThe coefficients simplify considerably. For $\\boldsymbol{v}_{1}$: $\\xi[(1-\\eta)(1-\\zeta) + \\eta(1-\\zeta) + (1-\\eta)\\zeta + \\eta\\zeta] = \\xi[(1-\\eta+\\eta)(1-\\zeta) + (1-\\eta+\\eta)\\zeta] = \\xi[1-\\zeta+\\zeta] = \\xi$. By symmetry, the coefficients for $\\boldsymbol{v}_{2}$ and $\\boldsymbol{v}_{3}$ are $\\eta$ and $\\zeta$, respectively. Thus, the isoparametric mapping simplifies to a linear affine transformation:\n$$\n\\boldsymbol{x}(\\xi, \\eta, \\zeta) = \\xi \\boldsymbol{v}_{1} + \\eta \\boldsymbol{v}_{2} + \\zeta \\boldsymbol{v}_{3}\n$$\nThe Jacobian matrix of the mapping, $J(\\xi,\\eta,\\zeta) = \\frac{\\partial \\boldsymbol{x}}{\\partial(\\xi,\\eta,\\zeta)}$, is a matrix whose columns are the partial derivatives of $\\boldsymbol{x}$ with respect to the parametric coordinates:\n$$\nJ = \\begin{pmatrix} \\frac{\\partial \\boldsymbol{x}}{\\partial \\xi}  \\frac{\\partial \\boldsymbol{x}}{\\partial \\eta}  \\frac{\\partial \\boldsymbol{x}}{\\partial \\zeta} \\end{pmatrix}\n$$\nFrom the expression for $\\boldsymbol{x}$, we find:\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial \\xi} = \\boldsymbol{v}_{1}, \\quad \\frac{\\partial \\boldsymbol{x}}{\\partial \\eta} = \\boldsymbol{v}_{2}, \\quad \\frac{\\partial \\boldsymbol{x}}{\\partial \\zeta} = \\boldsymbol{v}_{3}\n$$\nThus, the Jacobian matrix is formed by the spanning vectors as its columns:\n$$\nJ = \\begin{pmatrix} \\boldsymbol{v}_{1}  \\boldsymbol{v}_{2}  \\boldsymbol{v}_{3} \\end{pmatrix} = \\begin{pmatrix} 1.2  0.2  0.1 \\\\ 0.3  1.0  0.2 \\\\ 0.1  0.4  1.5 \\end{pmatrix}\n$$\nA crucial observation is that for this linear mapping, the Jacobian matrix $J$ is constant throughout the entire parametric domain $[0,1] \\times [0,1] \\times [0,1]$.\nThe determinant of the Jacobian, $\\det(J)$, represents the volume scaling factor from the parametric space to the physical space. It is calculated as the scalar triple product of the column vectors:\n$$\n\\det(J) = \\boldsymbol{v}_{1} \\cdot (\\boldsymbol{v}_{2} \\times \\boldsymbol{v}_{3}) = \\det\\begin{pmatrix} 1.2  0.2  0.1 \\\\ 0.3  1.0  0.2 \\\\ 0.1  0.4  1.5 \\end{pmatrix}\n$$\n$$\n\\det(J) = 1.2(1.0 \\cdot 1.5 - 0.4 \\cdot 0.2) - 0.2(0.3 \\cdot 1.5 - 0.2 \\cdot 0.1) + 0.1(0.3 \\cdot 0.4 - 1.0 \\cdot 0.1)\n$$\n$$\n\\det(J) = 1.2(1.5 - 0.08) - 0.2(0.45 - 0.02) + 0.1(0.12 - 0.10)\n$$\n$$\n\\det(J) = 1.2(1.42) - 0.2(0.43) + 0.1(0.02) = 1.704 - 0.086 + 0.002 = 1.620\n$$\nThe determinant of the Jacobian is $\\det(J) = 1.620 \\, \\mathrm{mm}^3$.\n\nThe second part of the problem asks to evaluate $J$ and $\\det(J)$ at the eight two-point Gaussian quadrature points and assess the element's validity. Since both $J$ and $\\det(J)$ are constant for this element, their values are the same at all points in the domain, including all eight Gaussian quadrature points.\n$$\nJ(\\xi, \\eta, \\zeta) = \\begin{pmatrix} 1.2  0.2  0.1 \\\\ 0.3  1.0  0.2 \\\\ 0.1  0.4  1.5 \\end{pmatrix} \\quad \\forall (\\xi, \\eta, \\zeta)\n$$\n$$\n\\det(J(\\xi, \\eta, \\zeta)) = 1.620 \\quad \\forall (\\xi, \\eta, \\zeta)\n$$\nThe primary criterion for a valid element in IGA (and finite element analysis) for physical simulations is that the mapping must be regular and orientation-preserving. This mathematically translates to the condition that the Jacobian determinant must be strictly positive, i.e., $\\det(J) > 0$, everywhere within the element's parametric domain. A positive determinant ensures that each infinitesimal volume in the parametric space maps to a positive, non-inverted infinitesimal volume in the physical space. A zero determinant indicates a singularity, and a negative determinant indicates an inverted or \"inside-out\" element, both of which are non-physical and computationally catastrophic, as they would corrupt the calculation of physical quantities like stress and strain which depend on derivatives of the field variables and thus on $J^{-1}$.\nIn this case, $\\det(J) = 1.620 > 0$. Since this value is a positive constant, the condition is satisfied everywhere. The element is therefore valid for Isogeometric Analysis.\n\nThe principled criteria for rejecting invalid elements in IGA are thus centered on the Jacobian determinant. An element is invalid and must be rejected if $\\det(J) \\le 0$ at any point within its parametric domain. For higher-order elements where $J$ is not constant, this check is typically performed at the numerical quadrature points. If any quadrature point yields $\\det(J) \\le 0$, the element is flagged as invalid. This check ensures the physical meaningfulness of the computational model, which is paramount in applications like biomechanics where simulations must accurately reflect real-world material behavior under load.\n\nFinally, the problem asks for the minimum value of $\\det(J)$ across all Gaussian quadrature points. Since $\\det(J)$ is a constant value of $1.620$, the minimum value is trivially $1.620$. Rounded to four significant figures as requested, the value is $1.620$.",
            "answer": "$$\n\\boxed{1.620}\n$$"
        },
        {
            "introduction": "Many biological systems, from the cardiovascular system to the lungs, are subjected to pressure loads. In a Finite Element Method (FEM) framework, these continuous surface tractions must be converted into discrete forces acting at the mesh nodes. This exercise  demonstrates the fundamental procedure for calculating the consistent nodal load vector, a crucial skill for accurately modeling boundary conditions in a vast range of biomechanical simulations.",
            "id": "4190613",
            "problem": "A pressurized organ is modeled as a smooth body with outward boundary traction. In a local region near the point $(x=R,y=0,z=0)$ on the organ, the surface mesh uses a single four-node bilinear quadrilateral facet to approximate a small patch of the organ surface as a plane. The facet has physical nodes at coordinates\n$$\n\\mathbf{x}_1 = (R,\\,-a,\\,-b),\\quad \\mathbf{x}_2 = (R,\\,a,\\,-b),\\quad \\mathbf{x}_3 = (R,\\,a,\\,b),\\quad \\mathbf{x}_4 = (R,\\,-a,\\,b),\n$$\nwith $R0$, $a0$, $b0$. The isoparametric mapping from the reference square $(\\xi,\\eta)\\in[-1,1]^2$ to physical space is bilinear with the standard four-node bilinear shape functions $N_1(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$, and the node ordering $(\\mathbf{x}_1,\\mathbf{x}_2,\\mathbf{x}_3,\\mathbf{x}_4)$ corresponds to $(\\xi,\\eta)=(-1,-1),(1,-1),(1,1),(-1,1)$, respectively. The organ is subjected to a uniform internal pressure $p$ that induces an outward traction on the surface given by $\\mathbf{t}(\\mathbf{x})=p\\,\\mathbf{n}(\\mathbf{x})$, where $\\mathbf{n}(\\mathbf{x})$ is the outward unit normal on the facet. The outward normal direction at this region of the organ is the $+x$-direction.\n\nUsing the continuum mechanics principle of virtual work as the fundamental basis and the standard Finite Element Method (FEM) boundary integral discretization for traction loading, compute the contribution of this facet to the global load vector at node $3$, specifically the $x$-component $f_{3x}$, taking proper account of orientation and the correct surface measure. Use the geometric parameters $R=0.08\\,\\text{m}$, $a=0.012\\,\\text{m}$, $b=0.020\\,\\text{m}$, and pressure $p=9.5\\times 10^3\\,\\text{Pa}$. Express your final answer in Newtons and round your answer to four significant figures.",
            "solution": "The problem requires the calculation of the $x$-component of the nodal force, $f_{3x}$, at node $3$ of a four-node quadrilateral facet. This force arises from a uniform pressure load on the surface of the facet. The calculation is based on the Finite Element Method (FEM) discretization of the principle of virtual work for boundary tractions.\n\nThe contribution of a distributed traction $\\mathbf{t}(\\mathbf{x})$ over a facet surface $\\Gamma_e$ to the consistent nodal force vector for that element is given by the integral:\n$$\n\\mathbf{f}_e = \\int_{\\Gamma_e} \\mathbf{N}^T(\\mathbf{x}) \\mathbf{t}(\\mathbf{x}) \\, dS\n$$\nwhere $\\mathbf{N}$ is the matrix of shape functions. The force contribution at a specific node $i$ is a vector $\\mathbf{f}_i$ given by:\n$$\n\\mathbf{f}_i = \\int_{\\Gamma_e} N_i(\\mathbf{x}) \\mathbf{t}(\\mathbf{x}) \\, dS\n$$\nWe are asked to find the $x$-component of this vector for node $3$, which we denote as $f_{3x}$.\n$$\nf_{3x} = \\int_{\\Gamma_e} N_3(\\mathbf{x}) t_x(\\mathbf{x}) \\, dS\n$$\nwhere $t_x$ is the $x$-component of the traction vector $\\mathbf{t}$.\n\nThe problem states that the traction is given by $\\mathbf{t}(\\mathbf{x}) = p\\,\\mathbf{n}(\\mathbf{x})$, where $p$ is a uniform pressure and $\\mathbf{n}(\\mathbf{x})$ is the outward unit normal vector. The nodal coordinates are provided as:\n$$\n\\mathbf{x}_1 = (R,\\,-a,\\,-b), \\quad \\mathbf{x}_2 = (R,\\,a,\\,-b), \\quad \\mathbf{x}_3 = (R,\\,a,\\,b), \\quad \\mathbf{x}_4 = (R,\\,-a,\\,b)\n$$\nAll four nodes have the same $x$-coordinate, $x=R$. This implies that the facet is a planar rectangle lying in the plane defined by the equation $x=R$. The problem also states that the outward normal direction is the $+x$-direction. Therefore, the unit normal vector $\\mathbf{n}$ is constant over the entire facet:\n$$\n\\mathbf{n}(\\mathbf{x}) = (1, 0, 0)\n$$\nConsequently, the traction vector is also constant over the facet:\n$$\n\\mathbf{t}(\\mathbf{x}) = p(1, 0, 0) = (p, 0, 0)\n$$\nThe $x$-component of the traction is $t_x(\\mathbf{x}) = p$. Since $p$ is a constant, we can write the integral for $f_{3x}$ as:\n$$\nf_{3x} = p \\int_{\\Gamma_e} N_3(\\mathbf{x}) \\, dS\n$$\nTo evaluate this integral, we transform it from physical coordinates $\\mathbf{x}$ to the isoparametric reference coordinates $(\\xi, \\eta)$, where $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$. The differential surface element $dS$ is related to the reference element area $d\\xi d\\eta$ by the Jacobian of the transformation, $J$:\n$$\ndS = J(\\xi, \\eta) \\, d\\xi d\\eta\n$$\nThe mapping from reference to physical coordinates is given by $\\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) \\mathbf{x}_i$. The Jacobian $J$ for a surface element is the magnitude of the cross product of the tangent vectors $\\mathbf{g}_\\xi = \\frac{\\partial\\mathbf{x}}{\\partial\\xi}$ and $\\mathbf{g}_\\eta = \\frac{\\partial\\mathbf{x}}{\\partial\\eta}$:\n$$\nJ = ||\\mathbf{g}_\\xi \\times \\mathbf{g}_\\eta||\n$$\nLet's find the explicit mapping for the given geometry. The position vector is $\\mathbf{x}(\\xi, \\eta) = (x(\\xi,\\eta), y(\\xi,\\eta), z(\\xi,\\eta))$.\nThe $x$-component is $x(\\xi, \\eta) = \\sum_{i=1}^4 N_i R = R \\sum_{i=1}^4 N_i = R(1) = R$, since the sum of shape functions is unity.\nThe $y$-component is:\n$$\ny(\\xi, \\eta) = N_1(-a) + N_2(a) + N_3(a) + N_4(-a) = a(-N_1 + N_2 + N_3 - N_4)\n$$\nUsing the definitions of the shape functions:\n$$\n-N_1+N_2+N_3-N_4 = \\frac{1}{4}[-(1-\\xi)(1-\\eta)+(1+\\xi)(1-\\eta)+(1+\\xi)(1+\\eta)-(1-\\xi)(1+\\eta)] = \\xi\n$$\nSo, $y(\\xi, \\eta) = a\\xi$.\nThe $z$-component is:\n$$\nz(\\xi, \\eta) = N_1(-b) + N_2(-b) + N_3(b) + N_4(b) = b(-N_1 - N_2 + N_3 + N_4)\n$$\nUsing the definitions of the shape functions:\n$$\n-N_1-N_2+N_3+N_4 = \\frac{1}{4}[-(1-\\xi)(1-\\eta)-(1+\\xi)(1-\\eta)+(1+\\xi)(1+\\eta)+(1-\\xi)(1+\\eta)] = \\eta\n$$\nSo, $z(\\xi, \\eta) = b\\eta$.\nThe mapping is $\\mathbf{x}(\\xi, \\eta) = (R, a\\xi, b\\eta)$. The tangent vectors are:\n$$\n\\mathbf{g}_\\xi = \\frac{\\partial\\mathbf{x}}{\\partial\\xi} = (0, a, 0)\n$$\n$$\n\\mathbf{g}_\\eta = \\frac{\\partial\\mathbf{x}}{\\partial\\eta} = (0, 0, b)\n$$\nTheir cross product is:\n$$\n\\mathbf{g}_\\xi \\times \\mathbf{g}_\\eta = \\det \\begin{pmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ 0  a  0 \\\\ 0  0  b \\end{pmatrix} = (ab, 0, 0)\n$$\nThe Jacobian is the magnitude of this vector:\n$$\nJ = ||(ab, 0, 0)|| = ab\n$$\nThe Jacobian is a constant, which is expected for a planar rectangular element. Now we can write the integral for $f_{3x}$ in reference coordinates:\n$$\nf_{3x} = p \\int_{-1}^1 \\int_{-1}^1 N_3(\\xi, \\eta) J \\, d\\xi d\\eta\n$$\nSubstituting $N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$ and $J=ab$:\n$$\nf_{3x} = p \\int_{-1}^1 \\int_{-1}^1 \\left(\\frac{1}{4}(1+\\xi)(1+\\eta)\\right) (ab) \\, d\\xi d\\eta\n$$\nWe can separate the integral:\n$$\nf_{3x} = \\frac{pab}{4} \\left( \\int_{-1}^1 (1+\\xi) \\, d\\xi \\right) \\left( \\int_{-1}^1 (1+\\eta) \\, d\\eta \\right)\n$$\nLet's evaluate the integrals:\n$$\n\\int_{-1}^1 (1+\\xi) \\, d\\xi = \\left[ \\xi + \\frac{\\xi^2}{2} \\right]_{-1}^1 = \\left(1 + \\frac{1}{2}\\right) - \\left(-1 + \\frac{1}{2}\\right) = \\frac{3}{2} - \\left(-\\frac{1}{2}\\right) = 2\n$$\nBy symmetry, the integral with respect to $\\eta$ is also $2$:\n$$\n\\int_{-1}^1 (1+\\eta) \\, d\\eta = 2\n$$\nSubstituting these results back into the expression for $f_{3x}$:\n$$\nf_{3x} = \\frac{pab}{4} (2)(2) = \\frac{pab}{4} (4) = pab\n$$\nThis result can be interpreted physically. The total force on the facet is the pressure times the area: $F_{total} = p \\times A$. The area of the rectangular facet is $(2a)(2b) = 4ab$. Thus, $F_{total} = 4pab$. For a uniform pressure on a bilinear rectangular element, this total force is distributed equally among the four nodes. The force at each node is $F_{total}/4 = (4pab)/4 = pab$. Our calculation confirms this.\n\nNow, we substitute the given numerical values:\n$p = 9.5 \\times 10^3\\,\\text{Pa} = 9.5 \\times 10^3\\,\\text{N/m}^2$\n$a = 0.012\\,\\text{m}$\n$b = 0.020\\,\\text{m}$\n\n$$\nf_{3x} = (9.5 \\times 10^3) \\times (0.012) \\times (0.020) \\, \\text{N}\n$$\n$$\nf_{3x} = 9500 \\times 0.00024 \\, \\text{N}\n$$\n$$\nf_{3x} = 2.28 \\, \\text{N}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nf_{3x} = 2.280 \\, \\text{N}\n$$",
            "answer": "$$\\boxed{2.280}$$"
        },
        {
            "introduction": "When simulating dynamic phenomena like tissue vibration or impact response, the discretization of mass is as critical as that of stiffness. This hands-on coding practice explores the formulation of mass matrices for a biological fiber with spatially varying density. By implementing and comparing the stability limits of the \"consistent\" and \"lumped\" mass approaches , you will gain direct insight into the profound impact that discretization choices have on the accuracy and computational stability of explicit dynamic analyses.",
            "id": "4190632",
            "problem": "A slender biological fiber (for example, a tendon fascicle) of length $L$ and constant cross-sectional area $A$ is modeled in one dimension for axial vibration using the Finite Element Method (FEM). The Young’s modulus $E$ is constant, but the material density varies along the length as a linear function $\\rho(x)$ between end values $\\rho_0$ at $x=0$ and $\\rho_1$ at $x=L$. The mesh consists of $N_e$ linear two-node bar elements. The out-of-plane thickness is incorporated into $A$, so no separate thickness is used. All quantities use the International System of Units (SI): length in meters $\\mathrm{m}$, area in square meters $\\mathrm{m}^2$, density in kilograms per cubic meter $\\mathrm{kg/m^3}$, Young’s modulus in Pascals $\\mathrm{Pa}$, time in seconds $\\mathrm{s}$. The left end at $x=0$ is fixed (Dirichlet boundary condition), and the right end is free. You must formulate and assemble the consistent mass matrix and compare it to a lumped mass approximation in terms of the stability constraint on the time step $\\Delta t$ for explicit time integration using the Central Difference Method (CDM).\n\nStarting from the principle of kinetic energy and standard Galerkin projection, consider the axial displacement field approximation $u(x,t)=\\sum_i N_i(x)\\,d_i(t)$ over each element, where $N_i(x)$ are the linear shape functions and $d_i(t)$ are nodal displacements. The kinetic energy for the one-dimensional bar is\n$$\nT(t)=\\frac{1}{2}\\int_0^L \\rho(x)\\,A\\,\\dot{u}(x,t)^2\\,dx.\n$$\nUse this to derive the element-consistent mass matrix $M_e$ entries as integrals of the form\n$$\nM_e(i,j)=\\int_{x_e}^{x_{e+1}} \\rho(x)\\,A\\,N_i(x)\\,N_j(x)\\,dx,\n$$\nand assemble the global consistent mass matrix $M$ by summing contributions from each element into the appropriate global degrees of freedom. Define the lumped mass matrix $M^{\\ell}$ by the row-sum diagonalization of the consistent mass matrix, i.e., move the row sums of $M$ onto its diagonal to preserve total mass.\n\nSimilarly, derive and assemble the global stiffness matrix $K$ for axial deformation starting from the internal strain energy with linear shape functions, using\n$$\nK_e = \\int_{x_e}^{x_{e+1}} E\\,A\\,B^\\mathsf{T}B\\,dx,\n$$\nwhere $B=\\frac{dN}{dx}$ is the constant strain-displacement matrix on a linear element.\n\nFor the undamped semi-discrete system $M\\,\\ddot{d}(t)+K\\,d(t)=0$, apply the left-end fixed boundary condition by removing the constrained degree of freedom to obtain reduced matrices $\\tilde{M}$ and $\\tilde{K}$. The Central Difference Method (CDM) update can be written in modal form for each eigenmode of the generalized eigenvalue problem\n$$\n\\tilde{K}\\,\\phi = \\lambda\\,\\tilde{M}\\,\\phi,\n$$\nwith modal circular frequency $\\omega=\\sqrt{\\lambda}$. The CDM stability requirement for the undamped linear system is\n$$\n\\Delta t \\le \\frac{2}{\\omega_{\\max}},\n$$\nwhere $\\omega_{\\max}$ is the largest modal circular frequency over all modes of the discretized system. Compute this constraint twice for each case: once using the consistent mass matrix $\\tilde{M}$ and once using the lumped mass matrix $\\tilde{M}^{\\ell}$.\n\nYour program must:\n- Formulate and assemble the global consistent mass matrix with spatially varying density, using exact or sufficiently accurate quadrature for linear elements and a linearly varying $\\rho(x)$ across each element.\n- Assemble the global stiffness matrix for axial linear elements.\n- Apply the fixed boundary condition at the left end by removing the corresponding degree of freedom.\n- Solve the generalized eigenvalue problem for both mass models to obtain $\\omega_{\\max}$ and compute the maximum stable time step $\\Delta t_{\\max} = 2/\\omega_{\\max}$, in seconds.\n- Use numerical quadrature that is exact for a linear density times quadratic shape function products on each linear element.\n- Report all $\\Delta t_{\\max}$ values in seconds, rounded to six significant digits.\n\nTest suite (four cases covering a baseline, graded density, high stiffness, and a minimal element edge case). For each case, the density varies linearly as $\\rho(x)=\\rho_0 + (\\rho_1-\\rho_0)\\,x/L$:\n1. Baseline soft tissue-like: $E=5.0\\times 10^5\\,\\mathrm{Pa}$, $L=0.1\\,\\mathrm{m}$, $A=1.0\\times 10^{-4}\\,\\mathrm{m}^2$, $N_e=8$, $\\rho_0=1050\\,\\mathrm{kg/m^3}$, $\\rho_1=1050\\,\\mathrm{kg/m^3}$.\n2. Graded density: $E=8.0\\times 10^5\\,\\mathrm{Pa}$, $L=0.08\\,\\mathrm{m}$, $A=8.0\\times 10^{-5}\\,\\mathrm{m}^2$, $N_e=6$, $\\rho_0=900\\,\\mathrm{kg/m^3}$, $\\rho_1=1500\\,\\mathrm{kg/m^3}$.\n3. Very stiff segment: $E=1.2\\times 10^9\\,\\mathrm{Pa}$, $L=0.05\\,\\mathrm{m}$, $A=2.0\\times 10^{-5}\\,\\mathrm{m}^2$, $N_e=12$, $\\rho_0=1800\\,\\mathrm{kg/m^3}$, $\\rho_1=1800\\,\\mathrm{kg/m^3}$.\n4. Minimal mesh edge case: $E=5.0\\times 10^7\\,\\mathrm{Pa}$, $L=0.02\\,\\mathrm{m}$, $A=1.0\\times 10^{-5}\\,\\mathrm{m}^2$, $N_e=1$, $\\rho_0=1200\\,\\mathrm{kg/m^3}$, $\\rho_1=1000\\,\\mathrm{kg/m^3}$.\n\nFinal output format specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in seconds, rounded to six significant digits.\n- The list must contain eight values in the following order: $[\\Delta t_{\\text{cons},1}, \\Delta t_{\\text{lump},1}, \\Delta t_{\\text{cons},2}, \\Delta t_{\\text{lump},2}, \\Delta t_{\\text{cons},3}, \\Delta t_{\\text{lump},3}, \\Delta t_{\\text{cons},4}, \\Delta t_{\\text{lump},4}]$, where the subscript indicates the test case index and “cons”/“lump” denote consistent or lumped mass, respectively.",
            "solution": "The problem requires the determination of the maximum stable time step, $\\Delta t_{\\max}$, for explicit time integration of a one-dimensional bar's axial vibration using the Central Difference Method (CDM). This is to be done for two different mass matrix formulations: the consistent mass matrix and the lumped mass matrix. The bar has a constant cross-sectional area $A$ and Young's modulus $E$, but its density $\\rho(x)$ varies linearly along its length $L$.\n\nThe analysis proceeds through the following steps:\n1.  Discretization of the continuous domain using the Finite Element Method (FEM).\n2.  Derivation and assembly of the element stiffness and consistent mass matrices.\n3.  Assembly of the global stiffness ($K$) and consistent mass ($M$) matrices.\n4.  Formulation of the global lumped mass matrix ($M^{\\ell}$) from the consistent one.\n5.  Application of the fixed boundary condition to obtain reduced system matrices.\n6.  Solution of the generalized eigenvalue problem for both mass models to find the maximum natural frequency $\\omega_{\\max}$.\n7.  Calculation of the critical time step limit $\\Delta t_{\\max} = 2/\\omega_{\\max}$.\n\n**1. Discretization and Shape Functions**\nThe one-dimensional domain of length $L$ is discretized into $N_e$ linear two-node elements, each of length $h_e = L/N_e$. The global nodes are located at positions $x_i = i \\cdot h_e$ for $i \\in \\{0, 1, \\dots, N_e\\}$. For a generic element connecting global nodes $i$ and $i+1$, the axial displacement field $u(x,t)$ is approximated as:\n$$\nu(x,t) = N_1(x)d_i(t) + N_2(x)d_{i+1}(t)\n$$\nwhere $d_i(t)$ and $d_{i+1}(t)$ are the nodal displacements and $N_1(x)$, $N_2(x)$ are the linear Lagrange shape functions for the element. In a local coordinate system $\\tilde{x} \\in [0, h_e]$, these are:\n$$\nN_1(\\tilde{x}) = 1 - \\frac{\\tilde{x}}{h_e} \\quad , \\quad N_2(\\tilde{x}) = \\frac{\\tilde{x}}{h_e}\n$$\n\n**2. Element Stiffness Matrix ($K_e$)**\nThe element stiffness matrix is derived from the strain energy. For a bar element with constant $E$ and $A$, it is given by:\n$$\nK_e = \\int_{0}^{h_e} E A B^\\mathsf{T}B \\,d\\tilde{x}\n$$\nwhere $B$ is the strain-displacement matrix, containing the spatial derivatives of the shape functions:\n$$\nB = \\begin{bmatrix} \\frac{dN_1}{d\\tilde{x}}  \\frac{dN_2}{d\\tilde{x}} \\end{bmatrix} = \\begin{bmatrix} -\\frac{1}{h_e}  \\frac{1}{h_e} \\end{bmatrix} = \\frac{1}{h_e}\\begin{bmatrix} -1  1 \\end{bmatrix}\n$$\nThe product $B^\\mathsf{T}B$ is constant within the element:\n$$\nB^\\mathsf{T}B = \\frac{1}{h_e^2}\\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\nSince $E$, $A$, and $B$ are constant over the element, the integration is trivial:\n$$\nK_e = E A (B^\\mathsf{T}B) \\int_{0}^{h_e} \\,d\\tilde{x} = E A (B^\\mathsf{T}B) h_e = \\frac{EA}{h_e} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\nThis is the standard stiffness matrix for a 1D linear bar element.\n\n**3. Element Consistent Mass Matrix ($M_e$)**\nThe element consistent mass matrix arises from the kinetic energy expression and is defined as:\n$$\nM_e(i,j) = \\int_{x_e}^{x_{e+1}} \\rho(x) A N_i(x) N_j(x) \\,dx\n$$\nThe density $\\rho(x)$ varies linearly over the entire bar: $\\rho(x) = \\rho_0 + (\\rho_1 - \\rho_0) \\frac{x}{L}$. Within an element between nodes $e$ and $e+1$ at positions $x_e$ and $x_{e+1}$, the densities are $\\rho_e = \\rho(x_e)$ and $\\rho_{e+1} = \\rho(x_{e+1})$. The density within the element can be interpolated linearly using the same shape functions:\n$$\n\\rho(\\tilde{x}) = N_1(\\tilde{x})\\rho_e + N_2(\\tilde{x})\\rho_{e+1}\n$$\nThe integral for the mass matrix entries involves products of polynomials. The integrand for $M_e(i,j)$ is $\\rho(x)N_i(x)N_j(x)$, which is a polynomial of degree up to $1+1+1=3$. These integrals can be computed analytically, which is equivalent to using a quadrature rule that is exact for cubic polynomials (e.g., 2-point Gaussian quadrature). For a local coordinate $\\tilde{x} \\in [0, h_e]$, the matrix entries are:\n$$\nM_{e,11} = A \\int_{0}^{h_e} (N_1\\rho_e + N_2\\rho_{e+1})N_1^2 \\,d\\tilde{x} = A h_e \\left( \\frac{\\rho_e}{4} + \\frac{\\rho_{e+1}}{12} \\right)\n$$\n$$\nM_{e,12} = M_{e,21} = A \\int_{0}^{h_e} (N_1\\rho_e + N_2\\rho_{e+1})N_1 N_2 \\,d\\tilde{x} = A h_e \\left( \\frac{\\rho_e}{12} + \\frac{\\rho_{e+1}}{12} \\right)\n$$\n$$\nM_{e,22} = A \\int_{0}^{h_e} (N_1\\rho_e + N_2\\rho_{e+1})N_2^2 \\,d\\tilde{x} = A h_e \\left( \\frac{\\rho_e}{12} + \\frac{\\rho_{e+1}}{4} \\right)\n$$\nAssembling these entries, the element consistent mass matrix is:\n$$\nM_e = \\frac{A h_e}{12} \\begin{bmatrix} 3\\rho_e + \\rho_{e+1}  \\rho_e + \\rho_{e+1} \\\\ \\rho_e + \\rho_{e+1}  \\rho_e + 3\\rho_{e+1} \\end{bmatrix}\n$$\nIf density is constant, $\\rho_e = \\rho_{e+1} = \\rho$, this correctly reduces to the standard form $M_e = \\frac{\\rho A h_e}{6}\\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix}$.\n\n**4. Global Matrices and Boundary Conditions**\nThe global stiffness matrix $K$ and consistent mass matrix $M$, both of size $(N_e+1) \\times (N_e+1)$, are assembled by iterating over all $N_e$ elements and adding the entries of $K_e$ and $M_e$ to the appropriate global locations.\nThe lumped mass matrix $M^{\\ell}$ is a diagonal matrix where each diagonal entry $M^{\\ell}_{ii}$ is the sum of all elements in the $i$-th row of the consistent mass matrix $M$:\n$$\nM^{\\ell}_{ii} = \\sum_{j=0}^{N_e} M_{ij} \\quad, \\quad M^{\\ell}_{ij} = 0 \\text{ for } i \\neq j\n$$\nThe left end ($x=0$, node $0$) is fixed, meaning its displacement $d_0$ is zero. This boundary condition is applied by removing the first row and first column from the global matrices $K$, $M$, and $M^{\\ell}$, resulting in the reduced matrices $\\tilde{K}$, $\\tilde{M}$, and $\\tilde{M}^{\\ell}$, respectively, of size $N_e \\times N_e$.\n\n**5. Eigenvalue Problem and Stability Analysis**\nThe undamped free vibration of the discretized system is governed by $M\\ddot{d} + Kd = 0$. After applying the boundary condition, the equation for the free degrees of freedom is $\\tilde{M}\\ddot{\\tilde{d}} + \\tilde{K}\\tilde{d} = 0$. The natural frequencies of the system are found by solving the generalized eigenvalue problem:\n$$\n\\tilde{K}\\phi = \\lambda \\tilde{M}\\phi \\quad \\text{where } \\lambda = \\omega^2\n$$\nThe stability of the Central Difference Method is governed by the highest natural frequency of the discrete system, $\\omega_{\\max} = \\sqrt{\\lambda_{\\max}}$. The maximum stable time step is:\n$$\n\\Delta t_{\\max} \\le \\frac{2}{\\omega_{\\max}}\n$$\nThis analysis must be performed twice: once using the reduced consistent mass matrix $\\tilde{M}$ to find $\\Delta t_{\\text{cons}}$, and once using the reduced lumped mass matrix $\\tilde{M}^{\\ell}$ to find $\\Delta t_{\\text{lump}}$. Typically, the lumped mass formulation yields a higher $\\omega_{\\max}$ and thus a more restrictive (smaller) stable time step compared to the consistent mass formulation.\n\nThe computational implementation involves building a loop over the test cases. For each case, the global matrices are assembled element by element. After applying the fixed boundary condition, the `scipy.linalg.eigh` function is used to solve the two generalized eigenvalue problems for symmetric matrices. The maximum real part of the resulting eigenvalues provides $\\lambda_{\\max}$, from which $\\Delta t_{\\max}$ is calculated.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef calculate_dt_max(E, L, A, Ne, rho0, rho1):\n    \"\"\"\n    Calculates the maximum stable time step for both consistent and lumped mass\n    formulations for a 1D bar with linearly varying density.\n\n    Args:\n        E (float): Young's modulus (Pa)\n        L (float): Length of the bar (m)\n        A (float): Cross-sectional area (m^2)\n        Ne (int): Number of elements\n        rho0 (float): Density at x=0 (kg/m^3)\n        rho1 (float): Density at x=L (kg/m^3)\n\n    Returns:\n        tuple[float, float]: A tuple containing (dt_max_consistent, dt_max_lumped).\n    \"\"\"\n    num_nodes = Ne + 1\n    h = L / Ne\n\n    # Initialize global matrices\n    K_global = np.zeros((num_nodes, num_nodes))\n    M_consistent_global = np.zeros((num_nodes, num_nodes))\n\n    # Element stiffness matrix (constant for all elements)\n    K_element = (E * A / h) * np.array([[1, -1], [-1, 1]])\n\n    # Assemble global stiffness and consistent mass matrices\n    for e in range(Ne):\n        node1_idx, node2_idx = e, e + 1\n        \n        # Nodal positions\n        x1 = node1_idx * h\n        x2 = node2_idx * h\n        \n        # Nodal densities from global linear function\n        rho_node1 = rho0 + (rho1 - rho0) * x1 / L\n        rho_node2 = rho0 + (rho1 - rho0) * x2 / L\n\n        # Element consistent mass matrix (variable density)\n        M_element = (A * h / 12) * np.array([\n            [3 * rho_node1 + rho_node2, rho_node1 + rho_node2],\n            [rho_node1 + rho_node2, rho_node1 + 3 * rho_node2]\n        ])\n\n        # Assemble into global matrices\n        indices = np.ix_([node1_idx, node2_idx], [node1_idx, node2_idx])\n        K_global[indices] += K_element\n        M_consistent_global[indices] += M_element\n\n    # Create lumped mass matrix from consistent matrix\n    row_sums = np.sum(M_consistent_global, axis=1)\n    M_lumped_global = np.diag(row_sums)\n\n    # Apply fixed boundary condition at x=0 (node 0)\n    # This involves removing the first row and column.\n    dof_slice = slice(1, None)\n    K_reduced = K_global[dof_slice, dof_slice]\n    M_consistent_reduced = M_consistent_global[dof_slice, dof_slice]\n    M_lumped_reduced = M_lumped_global[dof_slice, dof_slice]\n\n    # Solve generalized eigenvalue problem: K*phi = lambda*M*phi\n    # We use eigh as K and M matrices are symmetric and real.\n    \n    # Consistent Mass\n    eigvals_cons = eigh(K_reduced, M_consistent_reduced, eigvals_only=True)\n    lambda_max_cons = np.max(eigvals_cons)\n    omega_max_cons = np.sqrt(lambda_max_cons)\n    dt_max_cons = 2.0 / omega_max_cons\n\n    # Lumped Mass\n    eigvals_lump = eigh(K_reduced, M_lumped_reduced, eigvals_only=True)\n    lambda_max_lump = np.max(eigvals_lump)\n    omega_max_lump = np.sqrt(lambda_max_lump)\n    dt_max_lump = 2.0 / omega_max_lump\n    \n    return dt_max_cons, dt_max_lump\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # (E, L, A, Ne, rho0, rho1)\n        (5.0e5, 0.1, 1.0e-4, 8, 1050, 1050),\n        (8.0e5, 0.08, 8.0e-5, 6, 900, 1500),\n        (1.2e9, 0.05, 2.0e-5, 12, 1800, 1800),\n        (5.0e7, 0.02, 1.0e-5, 1, 1200, 1000),\n    ]\n\n    results = []\n    for case in test_cases:\n        dt_cons, dt_lump = calculate_dt_max(*case)\n        # Format to 6 significant digits\n        results.append(\"{:.6g}\".format(dt_cons))\n        results.append(\"{:.6g}\".format(dt_lump))\n\n    # Print the final output in the required format\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}