{
    "hands_on_practices": [
        {
            "introduction": "The characteristic J-shaped stress-strain curve of tendons and ligaments involves significant deformation, making it crucial to use appropriate mechanical measures. This exercise focuses on the fundamental distinction between engineering stress, based on the initial geometry, and Cauchy (or true) stress, which accounts for the changing cross-sectional area during loading . By deriving the relationship between these two quantities for an incompressible material, you will quantify the error that arises from using the simpler engineering stress, a critical skill for accurately interpreting experimental data.",
            "id": "4195172",
            "problem": "A tendon specimen is subjected to a homogeneous uniaxial tensile test. The initial cross-sectional area is $A_0=10\\ \\mathrm{mm}^2$, the measured axial force at a given stretch is $F=200\\ \\mathrm{N}$, and the axial stretch is $\\lambda=1.15$. Assume the specimen behaves as an incompressible soft tissue over the time scale of the measurement (volume conservation with determinant of the deformation gradient $J=1$), the deformation is homogeneous, and lateral contraction is uniform. Starting from the fundamental definitions of stretch, Cauchy (true) stress, and engineering (nominal) stress, and invoking volume conservation under uniaxial extension, derive the expression for the Cauchy stress at the given stretch and use it to quantify the error incurred if engineering stress is used in place of true stress. Specifically, compute the relative error $\\delta$ defined by $\\delta=(\\sigma - s_{\\mathrm{eng}})/\\sigma$, where $\\sigma$ is the Cauchy stress and $s_{\\mathrm{eng}}$ is the engineering stress, at the given values of $A_0$, $F$, and $\\lambda$. Report only the final value of $\\delta$ as a decimal number without units. Round your answer to four significant figures.",
            "solution": "The problem requires the calculation of the relative error between Cauchy (true) stress and engineering (nominal) stress for a tendon specimen under uniaxial tension, assuming the material is incompressible.\n\nFirst, we establish the fundamental definitions of the stress measures. The engineering stress, denoted by $s_{\\mathrm{eng}}$, is defined as the applied axial force $F$ divided by the initial, undeformed cross-sectional area $A_0$.\n$$s_{\\mathrm{eng}} = \\frac{F}{A_0}$$\nThe Cauchy stress, denoted by $\\sigma$, is defined as the same force $F$ divided by the current, deformed cross-sectional area $A$.\n$$\\sigma = \\frac{F}{A}$$\n\nThe problem states that the specimen is undergoing a homogeneous uniaxial tensile test. The axial stretch is given as $\\lambda$, which is the ratio of the current length $L$ to the initial length $L_0$.\n$$\\lambda = \\frac{L}{L_0}$$\n\nA critical assumption is that the material is incompressible, which means its volume remains constant during deformation. The initial volume is $V_0 = A_0 L_0$ and the current volume is $V = A L$. The incompressibility condition is $V = V_0$, or equivalently, the determinant of the deformation gradient is $J=1$.\n$$A L = A_0 L_0$$\nThis allows us to relate the current area $A$ to the initial area $A_0$. By rearranging the equation, we get:\n$$A = A_0 \\frac{L_0}{L}$$\nUsing the definition of stretch, $\\lambda = L/L_0$, we can write $L_0/L = 1/\\lambda$. Substituting this into the expression for $A$ yields:\n$$A = \\frac{A_0}{\\lambda}$$\nThis equation shows that for an incompressible material under uniaxial tension with $\\lambda > 1$, the cross-sectional area must decrease.\n\nNow we can express the Cauchy stress $\\sigma$ in terms of the initial area $A_0$ and the stretch $\\lambda$. Substituting the expression for $A$ into the definition of $\\sigma$:\n$$\\sigma = \\frac{F}{A} = \\frac{F}{A_0 / \\lambda} = \\lambda \\frac{F}{A_0}$$\nRecognizing that $s_{\\mathrm{eng}} = F/A_0$, we find the well-known relationship between Cauchy stress and engineering stress for an incompressible material under uniaxial load:\n$$\\sigma = \\lambda s_{\\mathrm{eng}}$$\n\nThe problem asks for the relative error $\\delta$ if engineering stress is used in place of true stress, defined as:\n$$\\delta = \\frac{\\sigma - s_{\\mathrm{eng}}}{\\sigma}$$\nWe can substitute the relationship $\\sigma = \\lambda s_{\\mathrm{eng}}$ into this expression. This allows us to express the error solely in terms of the stretch $\\lambda$.\n$$\\delta = \\frac{\\lambda s_{\\mathrm{eng}} - s_{\\mathrm{eng}}}{\\lambda s_{\\mathrm{eng}}}$$\nAssuming the force $F$ is non-zero, the engineering stress $s_{\\mathrm{eng}}$ is also non-zero, so it can be cancelled from the numerator and denominator:\n$$\\delta = \\frac{s_{\\mathrm{eng}}(\\lambda - 1)}{s_{\\mathrm{eng}}\\lambda} = \\frac{\\lambda - 1}{\\lambda} = 1 - \\frac{1}{\\lambda}$$\nThis elegant result shows that the relative error depends only on the axial stretch $\\lambda$. The given values for force $F = 200 \\text{ N}$ and initial area $A_0 = 10 \\text{ mm}^2$ are not required for the calculation of $\\delta$, but they are consistent with a standard biomechanics experiment and serve to confirm the physical context.\n\nWe are given the axial stretch $\\lambda = 1.15$. We can now compute the numerical value of the relative error $\\delta$.\n$$\\delta = 1 - \\frac{1}{1.15}$$\nCalculating the value:\n$$\\delta = 1 - 0.869565217...$$\n$$\\delta = 0.130434782...$$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $1$, $3$, $0$, and $4$. The fifth digit is $3$, which is less than $5$, so we round down (i.e., truncate).\n$$\\delta \\approx 0.1304$$\nThis indicates that using engineering stress instead of true stress at this level of stretch results in an underestimation of the stress by approximately $13.04\\%$.",
            "answer": "$$\\boxed{0.1304}$$"
        },
        {
            "introduction": "To quantitatively predict the nonlinear response of tendons, we employ constitutive models based on strain-energy functions. This practice explores a common approach that isolates the dominant contribution of aligned collagen fibers using a transversely isotropic hyperelastic model . You will derive the axial stress from a specific exponential strain-energy function, a foundational procedure in soft tissue mechanics that directly connects a material's energetic state to its mechanical response.",
            "id": "4195158",
            "problem": "Consider a collagen-dominated tendon modeled as an incompressible transversely isotropic hyperelastic solid with a single preferred fiber family aligned with the loading axis. The strain-energy density is split into an isotropic matrix contribution $W_{\\text{iso}}$ and a fiber contribution $W_{\\text{fib}}$, with $W_{\\text{iso}}$ negligible in tension for the present case. Adopt a standard exponential fiber strain-energy function of the form $W_{\\text{fib}}(I_{4})=\\frac{k_{1}}{2 k_{2}}\\left[\\exp\\!\\big(k_{2}(I_{4}-1)^{2}\\big)-1\\right]$ for $I_{4}>1$, where $I_{4}=\\boldsymbol{m}_{0}\\cdot\\boldsymbol{C}\\,\\boldsymbol{m}_{0}$ is the fiber stretch invariant, $\\boldsymbol{m}_{0}$ is the unit fiber direction in the reference configuration, and $\\boldsymbol{C}=\\boldsymbol{F}^{\\top}\\boldsymbol{F}$ is the right Cauchy–Green deformation tensor.\n\nUnder homogeneous uniaxial extension along the fiber direction with stretch $\\lambda>1$, assume traction-free lateral surfaces and incompressibility. Derive, from fundamental hyperelastic relations, the axial Cauchy stress $\\sigma_{11}(\\lambda)$ in terms of $\\lambda$, $k_{1}$, and $k_{2}$, and then compute its value at stretches $\\lambda=1.05$ and $\\lambda=1.15$ for $k_{1}=500$ kPa and $k_{2}=20$ (dimensionless). Round your numerical answers to four significant figures. Express the final stress values in kilopascals (kPa). Briefly comment, based on the two computed values, on the nonlinearity of the tendon’s tensile response.",
            "solution": "We begin by establishing the kinematics of the specified deformation. The problem describes a homogeneous uniaxial extension along the fiber direction, which we align with the $x_1$-axis. The unit vector representing the fiber direction in the reference configuration is therefore $\\boldsymbol{m}_{0} = \\boldsymbol{e}_{1}$. The deformation gradient tensor, $\\boldsymbol{F}$, for this loading case is given by:\n$$\n\\boldsymbol{F} = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  \\lambda_{2}  0 \\\\ 0  0  \\lambda_{3} \\end{pmatrix}\n$$\nwhere $\\lambda > 1$ is the prescribed axial stretch. The material is modeled as incompressible, which imposes the constraint $\\det(\\boldsymbol{F}) = 1$. This yields $\\lambda\\lambda_{2}\\lambda_{3} = 1$. The problem specifies traction-free lateral surfaces, and due to the transverse isotropy about the $\\boldsymbol{e}_{1}$ axis, the lateral stretches must be equal, i.e., $\\lambda_{2} = \\lambda_{3}$. Substituting this into the incompressibility constraint gives $\\lambda\\lambda_{2}^{2} = 1$, from which we solve for the lateral stretch: $\\lambda_{2} = \\lambda^{-1/2}$. Thus, the deformation gradient tensor is fully defined as:\n$$\n\\boldsymbol{F} = \\text{diag}(\\lambda, \\lambda^{-1/2}, \\lambda^{-1/2})\n$$\nThe right Cauchy–Green deformation tensor, $\\boldsymbol{C} = \\boldsymbol{F}^{\\top}\\boldsymbol{F}$, is then:\n$$\n\\boldsymbol{C} = \\text{diag}(\\lambda^{2}, \\lambda^{-1}, \\lambda^{-1})\n$$\nThe strain-energy function $W_{\\text{fib}}$ depends on the fiber stretch invariant $I_{4} = \\boldsymbol{m}_{0} \\cdot \\boldsymbol{C}\\,\\boldsymbol{m}_{0}$. With $\\boldsymbol{m}_{0} = \\boldsymbol{e}_{1} = (1, 0, 0)^{\\top}$, we compute $I_{4}$ as:\n$$\nI_{4} = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} \\lambda^{2}  0  0 \\\\ 0  \\lambda^{-1}  0 \\\\ 0  0  \\lambda^{-1} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\lambda^{2}\n$$\nThe condition $I_{4} > 1$ is satisfied since $\\lambda > 1$ is given.\n\nThe Cauchy stress tensor $\\boldsymbol{\\sigma}$ for an incompressible hyperelastic material is given by the constitutive relation:\n$$\n\\boldsymbol{\\sigma} = -p\\boldsymbol{I} + 2\\boldsymbol{F}\\frac{\\partial W}{\\partial\\boldsymbol{C}}\\boldsymbol{F}^{\\top}\n$$\nwhere $p$ is the indeterminate hydrostatic pressure and $\\boldsymbol{I}$ is the identity tensor. The problem states that the isotropic contribution $W_{\\text{iso}}$ is negligible, so we consider only $W = W_{\\text{fib}}(I_{4})$. The derivative of $W$ with respect to $\\boldsymbol{C}$ is found using the chain rule:\n$$\n\\frac{\\partial W}{\\partial\\boldsymbol{C}} = \\frac{\\mathrm{d}W_{\\text{fib}}}{\\mathrm{d}I_{4}}\\frac{\\partial I_{4}}{\\partial\\boldsymbol{C}}\n$$\nGiven $I_{4} = \\boldsymbol{m}_{0}\\cdot\\boldsymbol{C}\\boldsymbol{m}_{0}$, its derivative is $\\frac{\\partial I_{4}}{\\partial\\boldsymbol{C}} = \\boldsymbol{m}_{0}\\otimes\\boldsymbol{m}_{0}$. The derivative of the given strain-energy function $W_{\\text{fib}}(I_{4})=\\frac{k_{1}}{2 k_{2}}\\left[\\exp(k_{2}(I_{4}-1)^{2})-1\\right]$ with respect to $I_4$ is:\n$$\n\\frac{\\mathrm{d}W_{\\text{fib}}}{\\mathrm{d}I_{4}} = \\frac{k_{1}}{2k_{2}} \\left[ \\exp(k_{2}(I_{4}-1)^{2}) \\cdot (2k_{2}(I_{4}-1)) \\right] = k_{1}(I_{4}-1)\\exp(k_{2}(I_{4}-1)^{2})\n$$\nSubstituting $\\boldsymbol{S}=2\\frac{\\partial W}{\\partial \\boldsymbol{C}}$ into the Cauchy stress equation gives:\n$$\n\\boldsymbol{\\sigma} = -p\\boldsymbol{I} + 2\\frac{\\mathrm{d}W_{\\text{fib}}}{\\mathrm{d}I_{4}} \\boldsymbol{F}(\\boldsymbol{m}_{0}\\otimes\\boldsymbol{m}_{0})\\boldsymbol{F}^{\\top} = -p\\boldsymbol{I} + 2\\frac{\\mathrm{d}W_{\\text{fib}}}{\\mathrm{d}I_{4}} (\\boldsymbol{F}\\boldsymbol{m}_{0})\\otimes(\\boldsymbol{F}\\boldsymbol{m}_{0})\n$$\nThe vector $\\boldsymbol{F}\\boldsymbol{m}_{0}$ represents the fiber orientation in the deformed configuration. For $\\boldsymbol{m}_{0} = \\boldsymbol{e}_{1}$, we have $\\boldsymbol{F}\\boldsymbol{m}_{0} = \\lambda\\boldsymbol{e}_{1}$. The dyadic product is then $(\\boldsymbol{F}\\boldsymbol{m}_{0})\\otimes(\\boldsymbol{F}\\boldsymbol{m}_{0}) = \\lambda^{2}(\\boldsymbol{e}_{1}\\otimes\\boldsymbol{e}_{1})$.\nSubstituting $I_{4} = \\lambda^{2}$ and the derivative of $W$ into the stress equation, the stress tensor becomes:\n$$\n\\boldsymbol{\\sigma} = -p\\boldsymbol{I} + 2k_{1}(\\lambda^{2}-1)\\exp(k_{2}(\\lambda^{2}-1)^{2}) \\lambda^{2}(\\boldsymbol{e}_{1}\\otimes\\boldsymbol{e}_{1})\n$$\nIn component form, this is:\n$$\n\\sigma_{11} = -p + 2\\lambda^{2}k_{1}(\\lambda^{2}-1)\\exp(k_{2}(\\lambda^{2}-1)^{2})\n$$\n$$\n\\sigma_{22} = -p\n$$\n$$\n\\sigma_{33} = -p\n$$\nThe boundary condition of traction-free lateral surfaces requires $\\sigma_{22} = \\sigma_{33} = 0$. This immediately implies that the hydrostatic pressure $p=0$. This result is a direct consequence of neglecting the isotropic part of the strain energy, $W_{\\text{iso}}$.\nTherefore, the axial Cauchy stress $\\sigma_{11}$ is:\n$$\n\\sigma_{11}(\\lambda) = 2\\lambda^{2}k_{1}(\\lambda^{2}-1)\\exp(k_{2}(\\lambda^{2}-1)^{2})\n$$\nThis is the required analytical expression for the axial stress.\n\nWe now compute the numerical values using the given parameters $k_{1}=500$ kPa and $k_{2}=20$.\n\nFor a stretch of $\\lambda = 1.05$:\n$$\n\\sigma_{11}(1.05) = 2(1.05)^{2}(500)(\\text{kPa})(1.05^{2}-1)\\exp\\big(20(1.05^{2}-1)^{2}\\big)\n$$\n$$\n\\sigma_{11}(1.05) = 2(1.1025)(500)(1.1025-1)\\exp\\big(20(0.1025)^{2}\\big)\n$$\n$$\n\\sigma_{11}(1.05) = 1102.5(0.1025)\\exp(20 \\times 0.01050625)\n$$\n$$\n\\sigma_{11}(1.05) = 113.00625 \\exp(0.210125) \\approx 113.00625 \\times 1.233838 \\approx 139.4399 \\text{ kPa}\n$$\nRounding to four significant figures, we get $\\sigma_{11}(1.05) = 139.4$ kPa.\n\nFor a stretch of $\\lambda = 1.15$:\n$$\n\\sigma_{11}(1.15) = 2(1.15)^{2}(500)(\\text{kPa})(1.15^{2}-1)\\exp\\big(20(1.15^{2}-1)^{2}\\big)\n$$\n$$\n\\sigma_{11}(1.15) = 2(1.3225)(500)(1.3225-1)\\exp\\big(20(0.3225)^{2}\\big)\n$$\n$$\n\\sigma_{11}(1.15) = 1322.5(0.3225)\\exp(20 \\times 0.10400625)\n$$\n$$\n\\sigma_{11}(1.15) = 426.45625 \\exp(2.080125) \\approx 426.45625 \\times 8.00516 \\approx 3413.88 \\text{ kPa}\n$$\nRounding to four significant figures, we get $\\sigma_{11}(1.15) = 3414$ kPa.\n\nFinally, we comment on the nonlinearity of the tensile response. Let us consider the engineering strain $\\epsilon = \\lambda-1$. At $\\lambda=1.05$, the strain is $\\epsilon_A=0.05$ and the stress is $\\sigma_A=139.4$ kPa. At $\\lambda=1.15$, the strain is $\\epsilon_B=0.15$ and the stress is $\\sigma_B=3414$ kPa.\nA simple comparison reveals the pronounced nonlinearity: while the strain triples from $0.05$ to $0.15$ (a factor of $3$), the corresponding stress increases from $139.4$ kPa to $3414$ kPa, an increase by a factor of approximately $3414 / 139.4 \\approx 24.5$.\nThis disproportionate increase in stress relative to strain is characteristic of strain-stiffening behavior. The secant modulus, $E_{sec}=\\sigma/\\epsilon$, increases from $E_{sec,A} = 139.4/0.05 = 2788$ kPa to $E_{sec,B} = 3414/0.15 = 22760$ kPa. This dramatic stiffening is a hallmark of the nonlinear elastic response of collagenous tissues like tendons, which is captured effectively by the exponential form of the strain-energy function.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n139.4  3414\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While constitutive laws provide a theoretical framework, their practical power comes from fitting them to experimental data to determine specific material parameters. This computational practice guides you through the process of parameter estimation for a nonlinear stress-strain model using synthetic, noisy data that mimics a real experiment . By performing a nonlinear least squares fit and calculating confidence intervals, you will gain essential skills in data analysis and uncertainty quantification, closing the loop between theory and application.",
            "id": "4195146",
            "problem": "Consider a uniaxial tensile test of a collagenous tendon under small strain, modeled as a one-dimensional, isothermal, rate-independent material. Let the strain energy density per unit reference volume be a function of the small (engineering) strain $\\varepsilon$ and two positive material parameters $k_1$ (with units of Pascals) and $k_2$ (dimensionless), given by\n$$\nW(\\varepsilon;k_1,k_2) = \\frac{k_1}{k_2}\\left(\\exp(k_2 \\varepsilon) - 1 - k_2 \\varepsilon\\right).\n$$\nAssume the Cauchy stress $\\sigma$ in uniaxial small-strain mechanics is work-conjugate to $\\varepsilon$ so that under isothermal, rate-independent conditions it satisfies $\\sigma(\\varepsilon;k_1,k_2) = \\frac{\\partial W}{\\partial \\varepsilon}(\\varepsilon;k_1,k_2)$. You will generate synthetic stress-strain data and then estimate $k_1$ and $k_2$ by constrained nonlinear least squares, followed by approximate confidence intervals.\n\nYour program must:\n- Derive the model stress $\\sigma(\\varepsilon;k_1,k_2)$ from the provided $W(\\varepsilon;k_1,k_2)$ using the work-conjugacy relation.\n- For each test case in the suite below, generate $N$ synthetic data points $\\{(\\varepsilon_i,\\sigma_i^{\\text{obs}})\\}_{i=1}^N$ as follows. Define a linearly spaced strain grid from $\\varepsilon_{\\min}=0$ to a specified $\\varepsilon_{\\max}$. Compute the noise-free stress $\\sigma_i^{\\text{true}}=\\sigma(\\varepsilon_i;k_1^{\\text{true}},k_2^{\\text{true}})$. Add independent Gaussian noise with zero mean and standard deviation equal to $0.05\\,\\sigma_i^{\\text{true}}$ at each point to obtain $\\sigma_i^{\\text{obs}}=\\sigma_i^{\\text{true}}+\\eta_i$, where $\\eta_i\\sim\\mathcal{N}(0,(0.05\\,\\sigma_i^{\\text{true}})^2)$. Use a fixed random seed $s=12345$ so that the noise is reproducible. All stresses must be in Pascals (Pa), and strain is dimensionless.\n- Estimate $\\widehat{\\boldsymbol{\\theta}}=(\\widehat{k}_1,\\widehat{k}_2)$ by minimizing the sum of squared residuals $S(\\boldsymbol{\\theta})=\\sum_{i=1}^N r_i(\\boldsymbol{\\theta})^2$ with residuals $r_i(\\boldsymbol{\\theta})=\\sigma(\\varepsilon_i;\\boldsymbol{\\theta})-\\sigma_i^{\\text{obs}}$ subject to the bound constraints $k_1\\in[1,10^7]$ and $k_2\\in[0.1,200]$. Use a generic initial guess $\\boldsymbol{\\theta}_0=(10^4,10)$.\n- Compute an approximate $95\\%$ confidence interval for each parameter using the asymptotic covariance of the nonlinear least squares estimator. Let $\\mathbf{J}$ denote the Jacobian of the residual vector at the solution, $\\mathbf{J}_{ij}=\\frac{\\partial r_i}{\\partial \\theta_j}$, and let $\\widehat{\\sigma}^2=S(\\widehat{\\boldsymbol{\\theta}})/(N-p)$ with $p=2$. Approximate $\\mathrm{Cov}(\\widehat{\\boldsymbol{\\theta}})\\approx \\widehat{\\sigma}^2\\left(\\mathbf{J}^\\top\\mathbf{J}\\right)^{-1}$ (use the Moore–Penrose pseudoinverse if needed), and report intervals $\\widehat{\\theta}_j\\pm 1.96\\,\\sqrt{[\\mathrm{Cov}(\\widehat{\\boldsymbol{\\theta}})]_{jj}}$ for $j\\in\\{1,2\\}$. Express $k_1$ in Pascals (Pa) and $k_2$ as dimensionless.\n- Round all reported floating-point outputs to $3$ significant figures.\n\nTest suite:\n- Case A (toe-region dominated): $k_1^{\\text{true}}=60000\\,\\text{Pa}$, $k_2^{\\text{true}}=30$, $\\varepsilon_{\\max}=0.08$, $N=41$ equally spaced points from $0$ to $0.08$.\n- Case B (milder nonlinearity, wider range): $k_1^{\\text{true}}=20000\\,\\text{Pa}$, $k_2^{\\text{true}}=8$, $\\varepsilon_{\\max}=0.10$, $N=51$ equally spaced points from $0$ to $0.10$.\n- Case C (stiffer response, fewer points): $k_1^{\\text{true}}=120000\\,\\text{Pa}$, $k_2^{\\text{true}}=20$, $\\varepsilon_{\\max}=0.06$, $N=21$ equally spaced points from $0$ to $0.06$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each case, output the list $[\\widehat{k}_1,\\widehat{k}_2,\\text{CI}_{k_1}^{\\text{low}},\\text{CI}_{k_1}^{\\text{high}},\\text{CI}_{k_2}^{\\text{low}},\\text{CI}_{k_2}^{\\text{high}}]$ with all values rounded to $3$ significant figures and with $k_1$ in Pa. The final single line should therefore look like $[[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot]]$.",
            "solution": "First, the analytical form for the Cauchy stress $\\sigma$ as a function of the engineering strain $\\varepsilon$ and material parameters $\\boldsymbol{\\theta}=(k_1, k_2)$ must be derived from the given strain energy density function $W(\\varepsilon; k_1, k_2)$. The problem states that the stress is work-conjugate to the strain, which under the specified conditions implies the relation $\\sigma = \\frac{\\partial W}{\\partial \\varepsilon}$. The strain energy density is given as:\n$$\nW(\\varepsilon;k_1,k_2) = \\frac{k_1}{k_2}\\left(\\exp(k_2 \\varepsilon) - 1 - k_2 \\varepsilon\\right)\n$$\nwhere $k_1$ is a material parameter in units of Pascals and $k_2$ is a dimensionless material parameter.\n\nDifferentiating $W$ with respect to $\\varepsilon$ yields the stress function:\n$$\n\\sigma(\\varepsilon;k_1,k_2) = \\frac{\\partial}{\\partial \\varepsilon} \\left[ \\frac{k_1}{k_2}\\left(\\exp(k_2 \\varepsilon) - 1 - k_2 \\varepsilon\\right) \\right]\n$$\n$$\n\\sigma(\\varepsilon;k_1,k_2) = \\frac{k_1}{k_2} \\left( \\frac{\\partial}{\\partial \\varepsilon} \\exp(k_2 \\varepsilon) - \\frac{\\partial}{\\partial \\varepsilon}(1) - \\frac{\\partial}{\\partial \\varepsilon}(k_2 \\varepsilon) \\right)\n$$\n$$\n\\sigma(\\varepsilon;k_1,k_2) = \\frac{k_1}{k_2} \\left( k_2 \\exp(k_2 \\varepsilon) - 0 - k_2 \\right)\n$$\n$$\n\\sigma(\\varepsilon;k_1,k_2) = \\frac{k_1}{k_2} \\left( k_2 (\\exp(k_2 \\varepsilon) - 1) \\right)\n$$\n$$\n\\sigma(\\varepsilon;k_1,k_2) = k_1 \\left(\\exp(k_2 \\varepsilon) - 1\\right)\n$$\nThis derived expression for stress, $\\sigma(\\varepsilon; k_1, k_2)$, serves as the predictive model for the nonlinear regression.\n\nThe main program executes the following steps for each test case provided:\n$1$. **Data Generation**: Synthetic stress-strain data points $\\{(\\varepsilon_i, \\sigma_i^{\\text{obs}})\\}_{i=1}^N$ are generated. A grid of $N$ strain points $\\varepsilon_i$ is created from $\\varepsilon_{\\min}=0$ to the specified $\\varepsilon_{\\max}$. The \"true\" stress values $\\sigma_i^{\\text{true}}$ are computed using the derived model with the true parameters $k_1^{\\text{true}}$ and $k_2^{\\text{true}}$. Independent Gaussian noise $\\eta_i$ is added to each true stress value. The noise for each point $i$ is drawn from a normal distribution $\\mathcal{N}(0, (0.05\\,\\sigma_i^{\\text{true}})^2)$. A fixed random seed $s=12345$ is used to ensure the noise is reproducible.\n\n$2$. **Parameter Estimation**: The parameters $\\widehat{\\boldsymbol{\\theta}}=(\\widehat{k}_1, \\widehat{k}_2)$ are estimated by minimizing the sum of squared residuals, $S(\\boldsymbol{\\theta}) = \\sum_{i=1}^N r_i(\\boldsymbol{\\theta})^2$, where the residual for the $i$th point is $r_i(\\boldsymbol{\\theta}) = \\sigma(\\varepsilon_i; k_1, k_2) - \\sigma_i^{\\text{obs}}$. This constrained nonlinear least squares problem is solved using the `scipy.optimize.least_squares` function. The optimization is performed with the initial guess $\\boldsymbol{\\theta}_0=(10^4, 10)$ and subject to the bounds $k_1 \\in [1, 10^7]$ and $k_2 \\in [0.1, 200]$.\n\n$3$. **Confidence Interval Calculation**: Approximate $95\\%$ confidence intervals for the estimated parameters $\\widehat{k}_1$ and $\\widehat{k}_2$ are calculated based on the asymptotic theory of least squares estimators. The procedure is as follows:\n    a. The unbiased estimator of the error variance, $\\widehat{\\sigma}^2$, is computed as $\\widehat{\\sigma}^2 = S(\\widehat{\\boldsymbol{\\theta}})/(N-p)$, where $S(\\widehat{\\boldsymbol{\\theta}})$ is the sum of squared residuals at the optimal solution, $N$ is the number of data points, and $p=2$ is the number of parameters.\n    b. The Jacobian matrix of the residuals with respect to the parameters, $\\mathbf{J}$, is obtained from the `least_squares` output.\n    c. The approximate covariance matrix of the estimator is calculated as $\\mathrm{Cov}(\\widehat{\\boldsymbol{\\theta}}) \\approx \\widehat{\\sigma}^2(\\mathbf{J}^\\top\\mathbf{J})^{-1}$. The Moore-Penrose pseudoinverse is used for the matrix inversion to ensure numerical stability.\n    d. The standard error for each parameter estimate $\\widehat{\\theta}_j$ is the square root of the corresponding diagonal element of the covariance matrix, $\\text{se}(\\widehat{\\theta}_j) = \\sqrt{[\\mathrm{Cov}(\\widehat{\\boldsymbol{\\theta}})]_{jj}}$.\n    e. The $95\\%$ confidence interval for each parameter is constructed as $\\widehat{\\theta}_j \\pm 1.96 \\cdot \\text{se}(\\widehat{\\theta}_j)$, where $1.96$ is the critical value from the standard normal distribution for a $95\\%$ confidence level.\n\n$4$. **Output Formatting**: All resulting floating-point numbers (parameter estimates and confidence interval bounds) are formatted into strings with $3$ significant figures. These strings are assembled into a list for each test case, and the lists for all cases are then combined into a final list-of-lists structure, which is printed as a single line of text.\n\nThe implementation encapsulates this entire logic within a Python script adhering to the specified environment constraints.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Solves for the material parameters and their confidence intervals\n    for a nonlinear stress-strain model based on synthetic data.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: toe-region dominated\n        {'name': 'A', 'k1_true': 60000., 'k2_true': 30., 'eps_max': 0.08, 'N': 41},\n        # Case B: milder nonlinearity, wider range\n        {'name': 'B', 'k1_true': 20000., 'k2_true': 8., 'eps_max': 0.10, 'N': 51},\n        # Case C: stiffer response, fewer points\n        {'name': 'C', 'k1_true': 120000., 'k2_true': 20., 'eps_max': 0.06, 'N': 21},\n    ]\n\n    # Initialize the random number generator for reproducible noise\n    seed = 12345\n    rng = np.random.default_rng(seed)\n\n    # Initial guess and bounds for the optimization\n    theta0 = [1e4, 10.]\n    bounds = ([1, 0.1], [1e7, 200])\n\n    all_results = []\n    \n    # Define the stress model\n    def stress_model(theta, epsilon):\n        k1, k2 = theta\n        return k1 * (np.exp(k2 * epsilon) - 1)\n\n    # Define the residual function for least_squares\n    def residuals(theta, epsilon, sigma_obs):\n        return stress_model(theta, epsilon) - sigma_obs\n\n    # Helper function for formatting numbers to 3 significant figures\n    def format_to_3_sig_figs(num):\n        return f\"{num:.3g}\"\n\n    for case in test_cases:\n        N = case['N']\n        k1_true = case['k1_true']\n        k2_true = case['k2_true']\n        eps_max = case['eps_max']\n\n        # 1. Generate synthetic data\n        epsilon_data = np.linspace(0, eps_max, N)\n        sigma_true = stress_model([k1_true, k2_true], epsilon_data)\n        \n        # Add noise, ensuring sigma_true > 0 to avoid zero standard deviation\n        # For eps=0, sigma_true=0. Noise should also be 0.\n        noise_std_dev = 0.05 * sigma_true\n        noise = rng.normal(0, noise_std_dev)\n        sigma_observed = sigma_true + noise\n\n        # 2. Perform nonlinear least squares optimization\n        opt_result = least_squares(\n            residuals,\n            x0=theta0,\n            bounds=bounds,\n            args=(epsilon_data, sigma_observed)\n        )\n        k1_hat, k2_hat = opt_result.x\n\n        # 3. Compute confidence intervals\n        p = 2  # Number of parameters\n        \n        # Sum of squared residuals\n        S_theta_hat = 2 * opt_result.cost\n        \n        # Unbiased estimate of error variance\n        sigma_sq_hat = S_theta_hat / (N - p)\n        \n        # Jacobian matrix at the solution\n        J = opt_result.jac\n        \n        # Approximate covariance matrix\n        try:\n            # Use pseudoinverse as specified for robustness\n            cov_matrix = sigma_sq_hat * np.linalg.pinv(J.T @ J)\n            diag_valid = np.all(np.diag(cov_matrix) >= 0)\n            if not diag_valid:\n                # Fallback for ill-conditioned cases\n                raise np.linalg.LinAlgError(\"Negative diagonal in covariance matrix\")\n        except np.linalg.LinAlgError:\n            # If covariance calculation fails, use nan for CIs\n            se_k1, se_k2 = np.nan, np.nan\n        else:\n            se_k1 = np.sqrt(cov_matrix[0, 0])\n            se_k2 = np.sqrt(cov_matrix[1, 1])\n\n        # 95% confidence intervals (z_score = 1.96)\n        z_score = 1.96\n        ci_k1_low = k1_hat - z_score * se_k1\n        ci_k1_high = k1_hat + z_score * se_k1\n        ci_k2_low = k2_hat - z_score * se_k2\n        ci_k2_high = k2_hat + z_score * se_k2\n        \n        # 4. Format and store results\n        case_outputs = [\n            k1_hat, k2_hat,\n            ci_k1_low, ci_k1_high,\n            ci_k2_low, ci_k2_high\n        ]\n        \n        formatted_outputs = [format_to_3_sig_figs(v) for v in case_outputs]\n        all_results.append(f\"[{','.join(formatted_outputs)}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        }
    ]
}