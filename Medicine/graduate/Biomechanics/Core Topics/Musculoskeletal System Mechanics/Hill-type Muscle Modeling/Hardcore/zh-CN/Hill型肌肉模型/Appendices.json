{
    "hands_on_practices": [
        {
            "introduction": "在深入研究肌肉的力学特性之前，我们首先需要建立一个准确描述其结构的几何模型。许多骨骼肌并非简单的线性结构，而是呈现出羽状（pennate）构型，即肌纤维以一定角度附着于肌腱。这个练习将引导您通过基础的三角学原理，推导出羽状肌模型中的关键几何关系。掌握这些关系是连接肌肉内部状态（如肌纤维长度和羽状角）与整个肌肉肌腱复合体宏观长度变化的第一步，为构建更复杂的生物力学模型奠定基础。",
            "id": "4177952",
            "problem": "一个Hill型肌肉肌腱单元被建模为羽状肌纤维，这些纤维插入到两条平行的、不可伸展的腱膜之间。设肌肉肌腱复合体长度为$l_{m}$，游离肌腱长度为$l_{t}$，肌束（纤维）长度为$l_{f}$，羽状角为$\\alpha$（定义为纤维轴与肌腱作用线之间的夹角）。在此模型的标准几何假设下：(i) 纤维沿作用线的投影与肌腱串联相加，因此$l_{m} = l_{t} + l_{f}\\cos\\alpha$，以及 (ii) 两条腱膜之间的垂直距离是恒定的，等于$w$，因此纤维厚度约束为$w = l_{f}\\sin\\alpha$。假设$l_{m} > l_{t} \\geq 0$且$w > 0$，因此$0  \\alpha  \\pi/2$。\n\n从这些约束以及正弦、余弦和勾股定理的基本几何定义出发，推导$l_{f}$和$\\alpha$关于$l_{m}$、$l_{t}$和$w$的闭式表达式。角度$\\alpha$以弧度表示。你的最终答案必须是一个单一的闭式解析表达式，在一个单行矩阵中同时报告$l_{f}$和$\\alpha$，顺序为$\\left(l_{f},\\ \\alpha\\right)$。不需要进行数值计算或四舍五入。",
            "solution": "首先根据所需标准对问题进行验证。\n\n**步骤1：提取已知条件**\n- 变量：肌肉肌腱复合体长度$l_{m}$，游离肌腱长度$l_{t}$，肌束（纤维）长度$l_{f}$，羽状角$\\alpha$，以及腱膜间的垂直距离$w$。\n- 几何约束：\n    1. $l_{m} = l_{t} + l_{f}\\cos\\alpha$\n    2. $w = l_{f}\\sin\\alpha$\n- 条件：$l_{m} > l_{t} \\geq 0$，$w > 0$，以及$0  \\alpha  \\pi/2$。\n- 目标：推导$l_{f}$和$\\alpha$关于$l_{m}$、$l_{t}$和$w$的闭式表达式。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了一个标准的、简化的羽状肌纤维几何模型，这是生物力学中的一个基本概念。这些方程是三角学在这个广为接受的模型上的直接应用。\n- **适定性**：该问题提供了两个独立的方程，并寻求两个未知数$l_f$和$\\alpha$。给定条件$l_m > l_t$和$w > 0$确保了预期解中函数的分母和参数是良定义的且具有物理意义。存在唯一解。\n- **客观性**：问题使用精确的数学语言陈述，没有任何主观或模棱两可的术语。\n- **结论**：该问题在科学上是合理的，是适定的，也是客观的。它没有违反任何无效性标准。因此，该问题被视为**有效**。\n\n**步骤3：进行求解**\n\n问题是从给定的两个方程组中求解肌束长度$l_f$和羽状角$\\alpha$：\n$$l_{m} = l_{t} + l_{f}\\cos\\alpha \\quad (1)$$\n$$w = l_{f}\\sin\\alpha \\quad (2)$$\n\n参数$l_m$、$l_t$和$w$是已知常数。我们可以重新整理方程(1)，将包含未知数的项分离到一边：\n$$l_{f}\\cos\\alpha = l_{m} - l_{t} \\quad (3)$$\n\n我们现在有一个包含两个方程的方程组：\n$$l_{f}\\sin\\alpha = w \\quad (2)$$\n$$l_{f}\\cos\\alpha = l_{m} - l_{t} \\quad (3)$$\n\n这两个方程可以从几何上进行解释。它们表示一个长度为$l_f$、方向角为$\\alpha$的向量的分量。或者，它们描述了一个斜边为$l_f$的直角三角形。角$\\alpha$的对边长度为$w$，邻边长度为$l_m - l_t$。\n\n为了求$l_f$，我们可以使用勾股定理，该定理指出对于一个直角三角形，斜边的平方等于另外两条直角边的平方和。在我们的情境中，这对应于基本三角恒等式$\\sin^2\\alpha + \\cos^2\\alpha = 1$。让我们将方程(2)和(3)两边平方然后相加：\n$$(l_{f}\\sin\\alpha)^2 + (l_{f}\\cos\\alpha)^2 = w^2 + (l_{m} - l_{t})^2$$\n$$l_{f}^2\\sin^2\\alpha + l_{f}^2\\cos^2\\alpha = w^2 + (l_{m} - l_{t})^2$$\n提取公因式$l_{f}^2$：\n$$l_{f}^2(\\sin^2\\alpha + \\cos^2\\alpha) = w^2 + (l_{m} - l_{t})^2$$\n使用恒等式$\\sin^2\\alpha + \\cos^2\\alpha = 1$：\n$$l_{f}^2 = (l_{m} - l_{t})^2 + w^2$$\n因为$l_f$代表一个物理长度，它必须是非负的。我们对两边取主平方根：\n$$l_{f} = \\sqrt{(l_{m} - l_{t})^2 + w^2}$$\n平方根下的表达式是两个平方的和。给定$w > 0$，量$(l_{m} - l_{t})^2 + w^2$是严格为正的，因此$l_f$是一个良定义的正实数。\n\n为了求$\\alpha$，我们可以使用正切函数的定义，$\\tan\\alpha = \\frac{\\sin\\alpha}{\\cos\\alpha}$。我们可以通过将方程(2)除以方程(3)来得到这个比率：\n$$\\frac{l_{f}\\sin\\alpha}{l_{f}\\cos\\alpha} = \\frac{w}{l_{m} - l_{t}}$$\n假设$l_f \\neq 0$（我们已经证明这是正确的）且$\\cos\\alpha \\neq 0$（对于$0  \\alpha  \\pi/2$这是正确的），我们可以简化为：\n$$\\tan\\alpha = \\frac{w}{l_{m} - l_{t}}$$\n为了解出$\\alpha$，我们对两边取反正切：\n$$\\alpha = \\arctan\\left(\\frac{w}{l_{m} - l_{t}}\\right)$$\n我们必须验证这个$\\alpha$的表达式与给定的约束$0  \\alpha  \\pi/2$是一致的。问题陈述$w > 0$和$l_m > l_t$，这意味着$l_m - l_t > 0$。因此，反正切函数的参数$\\frac{w}{l_m - l_t}$是一个正实数。对于正参数，反正切函数主值的范围是$(0, \\pi/2)$。因此，推导出的$\\alpha$表达式完全符合问题的约束。\n\n$l_f$和$\\alpha$的闭式表达式是：\n$$l_{f} = \\sqrt{(l_m - l_t)^2 + w^2}$$\n$$\\alpha = \\arctan\\left(\\frac{w}{l_m - l_t}\\right)$$\n问题要求最终答案是一个单一的解析表达式，在一个行矩阵中报告$l_f$和$\\alpha$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{(l_{m} - l_{t})^{2} + w^{2}}  \\arctan\\left(\\frac{w}{l_{m} - l_{t}}\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "掌握了肌肉的几何构型后，我们转向其核心的力学特性——力-速度关系。经典的希尔（Hill）模型使用双曲线方程来描述肌肉收缩速度对其能产生的力的影响，这是肌肉动力学建模的基石。本练习将深入探究希尔力-速度曲线的一个关键数学特征：在接近等长收缩（速度为零）时，曲线的斜率非常陡峭。您将通过计算发现，这一物理特性对动态仿真有着深远的影响，它直接导致了所谓的“数值刚度”（numerical stiffness）问题，这对于选择稳定高效的数值积分方法至关重要。",
            "id": "4178028",
            "problem": "一个单纤维希尔型肌肉模型采用了由 A. V. Hill 引入的经典双曲线力-速关系。设 $F_{\\mathrm{ce}}$ 表示在纤维缩短速度为 $v$ 时的收缩单元力（$v$ 为正表示缩短），设 $F_{0}$ 为在完全激活和最佳纤维长度下的等长力。经典的希尔双曲线关系式为\n$$(F_{\\mathrm{ce}} + a)(v + b) = (F_{0} + a)\\,b,$$\n其中常数 $a > 0$（力的单位）和 $b > 0$（长度每时间的单位）。定义归一化力-速因子 $f_{v}(v) := F_{\\mathrm{ce}}/F_{0}$。假设肌肉处于完全激活状态和最佳纤维长度，因此本问题中可以忽略长度依赖效应和被动效应。\n\n1) 从牛顿第二定律和上述本构定义出发，以符号形式计算导数 $\\partial f_{v}/\\partial v$ 在 $v = 0$ 处的值。然后，对于参数 $F_{0} = 1500\\ \\mathrm{N}$，$a/F_{0} = 0.25$ 和 $b = 0.15\\ \\mathrm{m/s}$，报告 $\\left.\\dfrac{\\partial f_{v}}{\\partial v}\\right|_{v=0}$ 的数值。\n\n2) 考虑一个质量为 $m = 1.0\\ \\mathrm{kg}$ 的质点，通过一个非常刚、短的串联弹性元件连接到该肌肉，使得在等长条件附近的小扰动下，纤维速度约等于质点速度。设一个等于 $F_{0}$ 的外部载荷初始时使系统保持在等长平衡状态。将运动方程 $m\\,\\dfrac{dv}{dt} = F_{\\mathrm{ce}}(v) - F_{\\mathrm{ext}}$ 在 $v=0$ 附近进行线性化。使用第 (1) 部分得到的斜率，评估其对数值刚性以及对显式前向欧拉时间积分器时间步长选择的影响。特别地，评论时间步长 $\\Delta t = 1\\ \\mathrm{ms}$ 的稳定性，并说明是否建议使用隐式方法。\n\n选择一个选项，该选项正确陈述了符号导数、其在给定参数下的数值，以及对数值刚性和时间步长的正确影响。\n\nA. $\\left.\\dfrac{\\partial f_{v}}{\\partial v}\\right|_{v=0} = -\\dfrac{F_{0}+a}{F_{0}\\,b}$；在数值上，当 $a/F_{0}=0.25$ 和 $b=0.15\\ \\mathrm{m/s}$ 时，$\\left.\\dfrac{\\partial f_{v}}{\\partial v}\\right|_{0} \\approx -8.33\\ \\mathrm{s/m}$。导出的力-速斜率得出 $\\dfrac{\\partial F_{\\mathrm{ce}}}{\\partial v}\\big|_{0} = F_{0}\\,\\dfrac{\\partial f_{v}}{\\partial v}\\big|_{0} \\approx -1.25\\times 10^{4}\\ \\mathrm{N\\,s/m}$，因此线性化系统 $m\\,\\dfrac{dv}{dt} \\approx \\dfrac{\\partial F_{\\mathrm{ce}}}{\\partial v}\\,v$ 有一个快速衰减时间常数 $\\tau \\approx m/\\left|\\dfrac{\\partial F_{\\mathrm{ce}}}{\\partial v}\\right| \\approx 8\\times 10^{-5}\\ \\mathrm{s}$。因为 $\\Delta t = 1\\ \\mathrm{ms} \\gg \\tau$，该问题是数值刚性的；除非 $\\Delta t \\ll \\tau$，否则前向欧拉法会不稳定，因此建议使用隐式方法。\n\nB. $\\left.\\dfrac{\\partial f_{v}}{\\partial v}\\right|_{v=0} = -\\dfrac{1}{b}$；数值上 $\\left.\\dfrac{\\partial f_{v}}{\\partial v}\\right|_{0} \\approx -6.67\\ \\mathrm{s/m}$，与 $a$ 无关。相应的阻尼约为 $1.0\\times 10^{4}\\ \\mathrm{N\\,s/m}$，得到时间常数 $\\tau \\approx 10^{-4}\\ \\mathrm{s}$。由于 $\\Delta t = 1\\ \\mathrm{ms}$ 超过 $\\tau$，前向欧拉法会因为更强的阻尼而更稳定，因此不会出现刚性问题，隐式方法也是不必要的。\n\nC. $\\left.\\dfrac{\\partial f_{v}}{\\partial v}\\right|_{v=0} = 0$，根据在原点的平滑性，因此在等长条件附近速度不与力耦合。任何刚性都将仅来自于肌腱弹性，对于前向欧拉法，时间步长 $\\Delta t = 10^{-2}\\ \\mathrm{s}$ 是可接受的，无需借助隐式格式。\n\nD. $\\left.\\dfrac{\\partial f_{v}}{\\partial v}\\right|_{v=0} = +\\dfrac{1 - a/F_{0}}{b}$；数值为正。正斜率会注入能量并导致真实的不稳定性；补救措施是适度减小 $\\Delta t$，但隐式积分不是必需的，因为不稳定性是由时间离散化而非模型刚性引起的。",
            "solution": "问题陈述在科学上是合理的，提法恰当，并包含推导唯一解所需的所有信息。我们可以继续进行推导和评估。\n\n问题分为两部分。首先，我们必须求出归一化力-速因子的导数 $\\left.\\dfrac{\\partial f_{v}}{\\partial v}\\right|_{v=0}$。其次，我们必须分析一个质量-肌肉系统的数值模拟的稳定性。\n\n**第 1 部分：力-速因子的导数**\n\n经典的希尔型力-速关系表达式为：\n$$(F_{\\mathrm{ce}} + a)(v + b) = (F_{0} + a)b$$\n其中 $F_{\\mathrm{ce}}$ 是收缩单元力，$v$ 是缩短速度，$F_{0}$ 是等长力，$a$ 和 $b$ 是正常数。\n\n归一化力-速因子定义为 $f_{v}(v) := F_{\\mathrm{ce}}/F_{0}$。我们可以将 $F_{\\mathrm{ce}}$ 表示为 $F_{\\mathrm{ce}}(v) = F_{0} f_{v}(v)$。将此代入希尔方程得到：\n$$(F_{0} f_{v}(v) + a)(v + b) = (F_{0} + a)b$$\n为了求导数 $\\dfrac{\\partial f_{v}}{\\partial v}$，我们对该方程关于 $v$ 进行隐式微分。注意，由于 $v$ 是唯一的变量，$\\partial f_v / \\partial v$ 等价于 $df_v/dv$。对左侧应用乘法法则，我们得到：\n$$\\frac{d}{dv}\\left[(F_{0} f_{v}(v) + a)(v + b)\\right] = \\frac{d}{dv}\\left[(F_{0} + a)b\\right]$$\n$$\\left(\\frac{d}{dv}[F_{0} f_{v}(v) + a]\\right)(v + b) + (F_{0} f_{v}(v) + a)\\left(\\frac{d}{dv}[v + b]\\right) = 0$$\n$$\\left(F_{0} \\frac{df_{v}}{dv}\\right)(v + b) + (F_{0} f_{v}(v) + a)(1) = 0$$\n我们需要在 $v=0$ 处计算这个导数。首先，我们求出 $f_{v}(0)$ 的值。通过在原方程中令 $v=0$：\n$$(F_{0} f_{v}(0) + a)(0 + b) = (F_{0} + a)b$$\n由于 $b>0$，我们可以两边除以 $b$：\n$$F_{0} f_{v}(0) + a = F_{0} + a$$\n$$F_{0} f_{v}(0) = F_{0}$$\n这得到 $f_{v}(0) = 1$，这与完全激活下等长条件（$v=0$）的预期相符。\n\n现在，我们将 $v=0$ 和 $f_{v}(0)=1$ 代入微分后的方程：\n$$\\left(F_{0} \\left.\\frac{df_{v}}{dv}\\right|_{v=0}\\right)(0 + b) + (F_{0} f_{v}(0) + a) = 0$$\n$$\\left(F_{0} \\left.\\frac{df_{v}}{dv}\\right|_{v=0}\\right) b + (F_{0}(1) + a) = 0$$\n$$F_{0} b \\left.\\frac{df_{v}}{dv}\\right|_{v=0} = -(F_{0} + a)$$\n求解该导数：\n$$\\left.\\frac{\\partial f_{v}}{\\partial v}\\right|_{v=0} = -\\frac{F_{0} + a}{F_{0} b}$$\n这可以利用给定的参数 $a/F_{0}$ 改写为：\n$$\\left.\\frac{\\partial f_{v}}{\\partial v}\\right|_{v=0} = -\\frac{F_{0}(1 + a/F_{0})}{F_{0} b} = -\\frac{1 + a/F_{0}}{b}$$\n现在，我们代入数值：$a/F_{0} = 0.25$ 和 $b = 0.15\\ \\mathrm{m/s}$。\n$$\\left.\\frac{\\partial f_{v}}{\\partial v}\\right|_{v=0} = -\\frac{1 + 0.25}{0.15\\ \\mathrm{m/s}} = -\\frac{1.25}{0.15}\\ \\mathrm{s/m} = -\\frac{125}{15}\\ \\mathrm{s/m} = -\\frac{25}{3}\\ \\mathrm{s/m} \\approx -8.333\\ldots\\ \\mathrm{s/m}$$\n\n**第 2 部分：线性化与稳定性分析**\n\n质量为 $m$ 的质点的运动方程由牛顿第二定律给出：\n$$m\\,\\frac{dv}{dt} = F_{\\mathrm{ce}}(v) - F_{\\mathrm{ext}}$$\n系统初始处于平衡状态（$v=0$），外部载荷为 $F_{\\mathrm{ext}} = F_{0}$。在此平衡点，$\\frac{dv}{dt}=0$，因此 $F_{\\mathrm{ce}}(0) - F_{0} = 0$，这是自洽的，因为 $F_{\\mathrm{ce}}(0) = F_{0}$。\n\n我们在平衡点 $v=0$ 附近对运动方程进行线性化。这涉及到对 $F_{\\mathrm{ce}}(v)$ 在 $v=0$ 附近进行一阶泰勒展开：\n$$F_{\\mathrm{ce}}(v) \\approx F_{\\mathrm{ce}}(0) + \\left.\\frac{dF_{\\mathrm{ce}}}{dv}\\right|_{v=0} v$$\n由于 $F_{\\mathrm{ce}}(v) = F_{0} f_{v}(v)$，其导数为 $\\left.\\frac{dF_{\\mathrm{ce}}}{dv}\\right|_{v=0} = F_{0} \\left.\\frac{df_{v}}{dv}\\right|_{v=0}$。\n将展开式代入运动方程：\n$$m\\,\\frac{dv}{dt} \\approx \\left(F_{\\mathrm{ce}}(0) + \\left.\\frac{dF_{\\mathrm{ce}}}{dv}\\right|_{v=0} v\\right) - F_{0}$$\n由于 $F_{\\mathrm{ce}}(0) = F_0$，上式简化为：\n$$m\\,\\frac{dv}{dt} = \\left(\\left.\\frac{dF_{\\mathrm{ce}}}{dv}\\right|_{v=0}\\right) v$$\n让我们计算物理斜率 $\\left.\\frac{dF_{\\mathrm{ce}}}{dv}\\right|_{v=0}$：\n$$\\left.\\frac{dF_{\\mathrm{ce}}}{dv}\\right|_{v=0} = F_{0} \\left.\\frac{df_{v}}{dv}\\right|_{v=0} = (1500\\ \\mathrm{N}) \\left(-\\frac{25}{3}\\ \\mathrm{s/m}\\right) = -12500\\ \\mathrm{N\\,s/m} = -1.25 \\times 10^4\\ \\mathrm{N\\,s/m}$$\n线性化的常微分方程（ODE）为 $\\frac{dv}{dt} = \\lambda v$，其中 $\\lambda = \\frac{1}{m} \\left.\\frac{dF_{\\mathrm{ce}}}{dv}\\right|_{v=0}$。\n当 $m = 1.0\\ \\mathrm{kg}$ 时：\n$$\\lambda = \\frac{-1.25 \\times 10^4\\ \\mathrm{N\\,s/m}}{1.0\\ \\mathrm{kg}} = -1.25 \\times 10^4\\ \\mathrm{s}^{-1}$$\n该常微分方程的解为 $v(t) = v(0) e^{\\lambda t}$。系统以时间常数 $\\tau = -1/\\lambda$ 向平衡状态松弛。\n$$\\tau = -\\frac{1}{-1.25 \\times 10^4\\ \\mathrm{s}^{-1}} = \\frac{1}{12500}\\ \\mathrm{s} = 0.00008\\ \\mathrm{s} = 8 \\times 10^{-5}\\ \\mathrm{s}$$\n这个极小的时间常数意味着一个非常快速松弛的系统，这正是数值刚性问题的定义。\n\n对于应用于 $\\frac{dv}{dt} = \\lambda v$ 的显式前向欧拉积分器，其迭代公式为 $v_{k+1} = v_k + \\Delta t (\\lambda v_k) = (1 + \\lambda \\Delta t) v_k$。稳定性要求放大因子 $|1 + \\lambda \\Delta t| \\leq 1$。由于 $\\lambda$ 是实数且为负，这导致条件 $\\Delta t \\leq -2/\\lambda = 2\\tau$。\n$$2\\tau = 2 \\times (8 \\times 10^{-5}\\ \\mathrm{s}) = 1.6 \\times 10^{-4}\\ \\mathrm{s} = 0.16\\ \\mathrm{ms}$$\n时间步长的稳定性极限是 $\\Delta t \\leq 0.16\\ \\mathrm{ms}$。\n\n问题建议使用时间步长 $\\Delta t = 1\\ \\mathrm{ms}$。由于 $1\\ \\mathrm{ms} > 0.16\\ \\mathrm{ms}$，这个时间步长违反了稳定性条件。前向欧拉法将不稳定。该问题是数值刚性的，为使用显式方法保持稳定性，将需要一个非常小的时间步长（$\\Delta t \\ll 0.16\\ \\mathrm{ms}$），这使得模拟效率低下。因此，建议使用一种隐式积分方法，该方法在更大的时间步长下也能保持稳定。\n\n**选项评估**\n\n*   **A. $\\left.\\dfrac{\\partial f_{v}}{\\partial v}\\right|_{v=0} = -\\dfrac{F_{0}+a}{F_{0}\\,b}$；在数值上，当 $a/F_{0}=0.25$ 和 $b=0.15\\ \\mathrm{m/s}$ 时，$\\left.\\dfrac{\\partial f_{v}}{\\partial v}\\right|_{0} \\approx -8.33\\ \\mathrm{s/m}$。导出的力-速斜率得出 $\\dfrac{\\partial F_{\\mathrm{ce}}}{\\partial v}\\big|_{0} = F_{0}\\,\\dfrac{\\partial f_{v}}{\\partial v}\\big|_{0} \\approx -1.25\\times 10^{4}\\ \\mathrm{N\\,s/m}$，因此线性化系统 $m\\,\\dfrac{dv}{dt} \\approx \\dfrac{\\partial F_{\\mathrm{ce}}}{\\partial v}\\,v$ 有一个快速衰减时间常数 $\\tau \\approx m/\\left|\\dfrac{\\partial F_{\\mathrm{ce}}}{\\partial v}\\right| \\approx 8\\times 10^{-5}\\ \\mathrm{s}$。因为 $\\Delta t = 1\\ \\mathrm{ms} \\gg \\tau$，该问题是数值刚性的；除非 $\\Delta t \\ll \\tau$，否则前向欧拉法会不稳定，因此建议使用隐式方法。**\n    此选项正确地陈述了符号导数。数值是正确的。物理斜率 $\\frac{\\partial F_{\\mathrm{ce}}}{\\partial v}$ 是正确的。时间常数 $\\tau$ 是正确的。稳定性分析是正确的：问题是刚性的，$\\Delta t = 1\\ \\mathrm{ms}$ 对于前向欧拉法是不稳定的，建议使用隐式方法。\n    **正确。**\n\n*   **B. $\\left.\\dfrac{\\partial f_{v}}{\\partial v}\\right|_{v=0} = -\\dfrac{1}{b}$；数值上 $\\left.\\dfrac{\\partial f_{v}}{\\partial v}\\right|_{0} \\approx -6.67\\ \\mathrm{s/m}$，与 $a$ 无关。相应的阻尼约为 $1.0\\times 10^{4}\\ \\mathrm{N\\,s/m}$，得到时间常数 $\\tau \\approx 10^{-4}\\ \\mathrm{s}$。由于 $\\Delta t = 1\\ \\mathrm{ms}$ 超过 $\\tau$，前向欧拉法会因为更强的阻尼而更稳定，因此不会出现刚性问题，隐式方法也是不必要的。**\n    符号导数不正确；它缺少因子 $(1 + a/F_{0})$。因此数值也不正确。稳定性推理是有缺陷的；更强的阻尼（更大的 $|\\lambda|$）使显式方法*更不*稳定，而不是更稳定，并且是刚性的原因。关于没有刚性问题的结论是错误的。\n    **不正确。**\n\n*   **C. $\\left.\\dfrac{\\partial f_{v}}{\\partial v}\\right|_{v=0} = 0$，根据在原点的平滑性，因此在等长条件附近速度不与力耦合。任何刚性都将仅来自于肌腱弹性，对于前向欧拉法，时间步长 $\\Delta t = 10^{-2}\\ \\mathrm{s}$ 是可接受的，无需借助隐式格式。**\n    导数不为零。力-速曲线在 $v=0$ 处的斜率不为零。该选项的整个前提是错误的。\n    **不正确。**\n\n*   **D. $\\left.\\dfrac{\\partial f_{v}}{\\partial v}\\right|_{v=0} = +\\dfrac{1 - a/F_{0}}{b}$；数值为正。正斜率会注入能量并导致真实的不稳定性；补救措施是适度减小 $\\Delta t$，但隐式积分不是必需的，因为不稳定性是由时间离散化而非模型刚性引起的。**\n    符号导数的符号和形式都是错误的。对于向心收缩（$v>0$），斜率是负的。正斜率将意味着物理上的不稳定性，但希尔模型在该区域是物理稳定的。与该选项的说法相反，问题确实是数值刚性问题。\n    **不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "一个完整的希尔式肌肉肌腱模型通常包含三个核心元件：主动产生力的收缩元件（CE）、与收缩元件并联以模拟肌纤维被动弹性的平行弹性元件（PEE），以及代表肌腱弹性的串联弹性元件（SEE）。这个综合性练习将指导您将这些元件组装成一个功能完整的肌肉肌腱单元，并通过求解力学平衡方程来确定其内部状态。这个过程本质上是一个非线性方程求根问题，是几乎所有肌肉骨骼建模与仿真软件的核心计算任务。通过完成这个练习，您将获得从零开始构建一个希尔模型的宝贵实践经验，掌握解决肌肉模型中核心数值问题的关键技能。",
            "id": "4178024",
            "problem": "考虑一个一维 Hill 型肌腱模型，该模型由三个元件组成：一个收缩元件 (CE)、一个串联弹性元件 (SEE) 和一个并联弹性元件 (PEE)。CE (收缩元件) 根据纤维激活水平和运动学状态产生主动力，SEE (串联弹性元件) 代表肌腱的弹性，PEE (并联弹性元件) 代表与 CE并联的被动纤维弹性。假设肌纤维和肌腱是共线的（无羽状结构），因此总肌腱长度是纤维长度和肌腱长度之和。\n\n目标是给定总肌腱长度 $l_m$、纤维激活水平 $a$ 和纤维速度 $v_f$，计算纤维长度 $l_f$ 和肌腱长度 $l_t$。\n\n从以下原理和定义出发：\n\n1. 牛顿第二定律和准静态平衡：在每个瞬间，沿着肌腱作用线，串联力必须与净纤维力平衡。因此，在准静态条件下，\n$$\nF_{\\text{SEE}}(l_t) = F_{\\text{CE}}(l_f, v_f, a) + F_{\\text{PEE}}(l_f).\n$$\n\n2. 长度约束：对于共线元件，\n$$\nl_m = l_f + l_t.\n$$\n\n3. 主动力-长度关系：CE 的归一化主动力-长度曲线被建模为一个以最佳纤维长度 $l_0$ 为中心、宽度参数为 $w$ 的高斯函数，\n$$\nf_L(l_f) = \\exp\\left(-\\left(\\frac{l_f - l_0}{w \\cdot l_0}\\right)^2\\right).\n$$\n\n4. 主动力-速度关系：定义正纤维速度 $v_f$ 为缩短。使用连续分段归一化力-速度曲线，其中最大缩短速度为 $v_{\\max}$，缩短曲率参数为 $a_c$，拉长增益为 $c_{\\ell}$：\n对于缩短 ($v_f \\ge 0$)，\n$$\nf_V(v_f) = \\frac{1 - \\frac{v_f}{v_{\\max}}}{1 + \\frac{v_f}{a_c v_{\\max}}}.\n$$\n对于拉长 ($v_f  0$)，\n$$\nf_V(v_f) = 1 + c_{\\ell}\\,\\frac{-v_f}{v_{\\max} + (-v_f)}.\n$$\n\n5. 收缩元件力：CE 的力为\n$$\nF_{\\text{CE}}(l_f, v_f, a) = a \\, F_{\\max} \\, f_L(l_f) \\, f_V(v_f),\n$$\n其中 $F_{\\max}$ 是最大等长力。\n\n6. 串联弹性元件（肌腱）力-长度关系：SEE 具有松弛长度 $l_{t,s}$ 和指数刚度，其参数为 $k_{\\text{strain}}$ 和尺度 $k_t$，\n$$\nF_{\\text{SEE}}(l_t) =\n\\begin{cases}\n0,  l_t \\le l_{t,s},\\\\\nk_t\\left(\\exp\\left(k_{\\text{strain}}\\,\\frac{l_t - l_{t,s}}{l_{t,s}}\\right) - 1\\right),  l_t > l_{t,s}.\n\\end{cases}\n$$\n\n7. 并联弹性元件（被动纤维）力-长度关系：PEE 在 $l_0$ 或以下时处于松弛状态，超过该长度后呈二次方关系，其刚度为 $k_{pe}$，\n$$\nF_{\\text{PEE}}(l_f) =\n\\begin{cases}\n0,  l_f \\le l_0,\\\\\nk_{pe}\\left(\\frac{l_f - l_0}{l_0}\\right)^2,  l_f > l_0.\n\\end{cases}\n$$\n\n未知数是 $l_f$ 和 $l_t$。利用上述关系，通过 $l_t = l_m - l_f$ 消去 $l_t$，并求解标量非线性平衡方程\n$$\nG(l_f; l_m, a, v_f) = F_{\\text{SEE}}(l_m - l_f) - \\left(F_{\\text{CE}}(l_f, v_f, a) + F_{\\text{PEE}}(l_f)\\right) = 0\n$$\n以求解 $l_f$，约束条件为 $l_f \\ge 0$ 且 $l_t \\ge 0$。然后计算 $l_t = l_m - l_f$。\n\n模型参数（使用以下精确值）：\n- 最大等長力 $F_{\\max} = 1500 \\ \\text{N}$。\n- 最佳纤维长度 $l_0 = 0.10 \\ \\text{m}$。\n- 肌腱松弛长度 $l_{t,s} = 0.20 \\ \\text{m}$。\n- 最大缩短速度 $v_{\\max} = 1.0 \\, l_0 \\, \\text{s}^{-1} = 0.10 \\ \\text{m/s}$。\n- 缩短曲率 $a_c = 0.30$。\n- 拉长增益 $c_{\\ell} = 0.50$。\n- 力-长度宽度 $w = 0.25$。\n- 肌腱指数刚度尺度 $k_t = 2000 \\ \\text{N}$。\n- 肌腱应变指数参数 $k_{\\text{strain}} = 35$。\n- 并联弹性刚度 $k_{pe} = 2.0 \\, F_{\\max} = 3000 \\ \\text{N}$。\n\n数值要求：\n- 使用一个稳健的数值方法求解 $G(l_f) = 0$，该方法需遵守 $l_f \\in [l_{f,\\min}, l_{f,\\max}]$，其中 $l_{f,\\min} = 0.5\\,l_0$ 且 $l_{f,\\max} = \\min(1.8\\,l_0, l_m)$。\n- 如果区间求根器未能找到根（没有符号变化），则在相同区间内计算使 $\\left|G(l_f)\\right|$ 最小化的 $l_f$，并将其用作备用近似值。\n- 计算出 $l_f$ 后，设置 $l_t = l_m - l_f$。\n- 报告长度以米为单位，四舍五入到六位小数。\n\n测试套件：\n为以下四种情况提供结果，每个测试用例由 $(l_m, a, v_f)$ 定义，其中长度单位为米，速度单位为米/秒：\n1. 理想情况：$(0.32, 0.60, 0.02)$。\n2. 肌腱处于松弛状态且无激活：$(0.30, 0.00, 0.00)$。\n3. 高拉伸，拉长：$(0.36, 0.80, -0.03)$。\n4. 低激活，接近松弛，中度缩短：$(0.31, 0.10, 0.05)$。\n\n程序输出规范：\n您的程序应生成一行输出，其中包含一个方括号内的逗号分隔列表形式的结果，每个结果是对应测试用例的列表 $[l_f, l_t]$。例如，输出格式必须是：\n[[lf1,lt1],[lf2,lt2],[lf3,lt3],[lf4,lt4]]\n每个数值都四舍五入到六位小数，并以米表示。",
            "solution": "## 问题验证\n\n### 步骤1：提取给定条件\n\n该问题提供了一个一维 Hill 型肌腱模型的完整定义。\n\n**状态方程：**\n1.  **准静态平衡：**\n    $$\n    F_{\\text{SEE}}(l_t) = F_{\\text{CE}}(l_f, v_f, a) + F_{\\text{PEE}}(l_f)\n    $$\n2.  **长度约束：**\n    $$\n    l_m = l_f + l_t\n    $$\n3.  **主动力-长度关系, $f_L(l_f)$:**\n    $$\n    f_L(l_f) = \\exp\\left(-\\left(\\frac{l_f - l_0}{w \\cdot l_0}\\right)^2\\right)\n    $$\n4.  **主动力-速度关系, $f_V(v_f)$:**\n    对于缩短 ($v_f \\ge 0$):\n    $$\n    f_V(v_f) = \\frac{1 - \\frac{v_f}{v_{\\max}}}{1 + \\frac{v_f}{a_c v_{\\max}}}\n    $$\n    对于拉长 ($v_f  0$):\n    $$\n    f_V(v_f) = 1 + c_{\\ell}\\,\\frac{-v_f}{v_{\\max} + (-v_f)}\n    $$\n5.  **收缩元件力, $F_{\\text{CE}}$:**\n    $$\n    F_{\\text{CE}}(l_f, v_f, a) = a \\, F_{\\max} \\, f_L(l_f) \\, f_V(v_f)\n    $$\n6.  **串联弹性元件力, $F_{\\text{SEE}}(l_t)$:**\n    $$\n    F_{\\text{SEE}}(l_t) =\n    \\begin{cases}\n    0,  l_t \\le l_{t,s},\\\\\n    k_t\\left(\\exp\\left(k_{\\text{strain}}\\,\\frac{l_t - l_{t,s}}{l_{t,s}}\\right) - 1\\right),  l_t  l_{t,s}.\n    \\end{cases}\n    $$\n7.  **并联弹性元件力, $F_{\\text{PEE}}(l_f)$:**\n    $$\n    F_{\\text{PEE}}(l_f) =\n    \\begin{cases}\n    0,  l_f \\le l_0,\\\\\n    k_{pe}\\left(\\frac{l_f - l_0}{l_0}\\right)^2,  l_f  l_0.\n    \\end{cases}\n    $$\n\n**求根问题：**\n求解关于 $l_f$ 的标量非线性方程：\n$$\nG(l_f; l_m, a, v_f) = F_{\\text{SEE}}(l_m - l_f) - \\left(F_{\\text{CE}}(l_f, v_f, a) + F_{\\text{PEE}}(l_f)\\right) = 0\n$$\n\n**模型参数：**\n- $F_{\\max} = 1500 \\ \\text{N}$\n- $l_0 = 0.10 \\ \\text{m}$\n- $l_{t,s} = 0.20 \\ \\text{m}$\n- $v_{\\max} = 1.0 \\, l_0 \\, \\text{s}^{-1} = 0.10 \\ \\text{m/s}$\n- $a_c = 0.30$\n- $c_{\\ell} = 0.50$\n- $w = 0.25$\n- $k_t = 2000 \\ \\text{N}$\n- $k_{\\text{strain}} = 35$\n- $k_{pe} = 2.0 \\, F_{\\max} = 3000 \\ \\text{N}$\n\n**数值要求：**\n- 在区间 $[l_{f,\\min}, l_{f,\\max}]$ 中搜索 $l_f$，其中 $l_{f,\\min} = 0.5\\,l_0 = 0.05 \\ \\text{m}$ 且 $l_{f,\\max} = \\min(1.8\\,l_0, l_m) = \\min(0.18 \\ \\text{m}, l_m)$。\n- 使用区间求根器。\n- 备用方案：如果没有找到根的区间，则在该区间内找到使 $|G(l_f)|$ 最小化的 $l_f$。\n- 找到 $l_f$ 后，计算 $l_t = l_m - l_f$。\n- 报告长度以米为单位，四舍五入到六位小数。\n\n**测试套件：**\n输入以 $(l_m, a, v_f)$ 形式给出：\n1.  $(0.32, 0.60, 0.02)$\n2.  $(0.30, 0.00, 0.00)$\n3.  $(0.36, 0.80, -0.03)$\n4.  $(0.31, 0.10, 0.05)$\n\n**输出格式：**\n单行字符串：`[[lf1,lt1],[lf2,lt2],[lf3,lt3],[lf4,lt4]]`。\n\n### 步骤2：使用提取的给定条件进行验证\n根据验证标准对问题陈述进行审查。\n\n-   **科学基础（关键）**：该问题基于 Hill 型肌肉模型，这是生物力学中用于模拟肌腱动力学的一个经典的、经过广泛验证的框架。力-长度和力-速度关系是标准的、广为接受的公式。该问题是将基本原理（准静态假设下的牛顿定律）应用于生物力学系统的经典示例。它在科学上是合理的。\n-   **适定的**：该问题被构造为从一个单一的标量非线性方程 $G(l_f)=0$ 中寻找一个单一的标量未知数 $l_f$。所涉及的函数是连续的，并且在指定的定义域内表现良好，这表明存在唯一解。问题明确定义了 $l_f$ 的搜索区间，并提供了一个稳健的数值策略，包括一种备用方法，以确保找到一个唯一且稳定的解。它是适定的。\n-   **客观性（关键）**：该问题完全由数学方程、数值参数和客观的过程指令定义。语言精确，没有任何主观性、模糊性或观点。\n-   **不完整或矛盾的设置**：该问题是自洽的。它提供了所有必要的方程、参数、边界条件（以搜索区间的形式）以及测试用例的输入数据。给定条件中没有矛盾。\n-   **不切实际或不可行**：提供的模型参数在脊椎动物骨骼肌的生理合理范围内。测试用例的输入对于生理性肌肉功能也是现实的。所需的计算是一个标准的数值求根任务，这完全是可行的。\n-   **不适定或结构不良**：问题结构清晰。术语定义明確。目标 unambiguous（明确的）。\n-   **未触发其他无效性标志。**\n\n### 步骤3：结论与行动\n该问题是 **有效的**。将提供一个完整的、合理的解决方案。\n\n## 解决方案\n\n问题的核心是确定在给定的总肌腱长度 ($l_m$)、纤维激活度 ($a$) 和纤维速度 ($v_f$) 下，肌纤维 ($l_f$) 和肌腱 ($l_t$) 的平衡长度。这是通过求解一个代表产力纤维分量和串联弹性肌腱之间力平衡的非线性代数方程来实现的。\n\n控制方程是：\n$$\nG(l_f) = F_{\\text{SEE}}(l_m - l_f) - \\left(F_{\\text{CE}}(l_f, v_f, a) + F_{\\text{PEE}}(l_f)\\right) = 0\n$$\n我们的目标是在指定的生理界限内找到该方程的根 $l_f$，然后计算 $l_t = l_m - l_f$。\n\n解决方案包括三个主要步骤：\n1. 实现每个产力元件（$F_{\\text{CE}}$、$F_{\\text{PEE}}$、$F_{\\text{SEE}}$）的函数。\n2. 构建平衡方程 $G(l_f)$。\n3. 使用稳健的求根算法，并结合指定的备用程序，数值求解 $l_f$。\n\n**1. 力函数的实现**\n\n所有参数均按照问题陈述中的定义使用。\n\n**并联弹性元件力 ($F_{\\text{PEE}}$):**\n该函数模拟肌纤维拉伸时的被动阻力。在最佳纤维长度 $l_0$ 以下，其值为零；当长度大于 $l_0$ 时，呈二次方增长。\n$$\nF_{\\text{PEE}}(l_f) =\n\\begin{cases}\n0,  l_f \\le l_0 \\\\\nk_{pe}\\left(\\frac{l_f - l_0}{l_0}\\right)^2,  l_f  l_0\n\\end{cases}\n$$\n其中 $k_{pe} = 3000 \\ \\text{N}$，$l_0 = 0.1 \\ \\text{m}$。\n\n**串联弹性元件力 ($F_{\\text{SEE}}$):**\n该函数模拟肌腱的弹性。在长度达到 $l_{t,s}$ 之前，它是松弛的（不产生力），而在更长的长度下表现出指数刚度。输入是肌腱长度 $l_t$，可以用 $l_f$ 表示为 $l_t = l_m - l_f$。\n$$\nF_{\\text{SEE}}(l_t) =\n\\begin{cases}\n0,  l_t \\le l_{t,s} \\\\\nk_t\\left(\\exp\\left(k_{\\text{strain}}\\,\\frac{l_t - l_{t,s}}{l_{t,s}}\\right) - 1\\right),  l_t  l_{t,s}\n\\end{cases}\n$$\n其中 $l_{t,s} = 0.2 \\ \\text{m}$，$k_t = 2000 \\ \\text{N}$，$k_{\\text{strain}} = 35$。\n\n**收缩元件力 ($F_{\\text{CE}}$):**\n这是由肌肉产生的主动力，受激活度、纤维长度和纤维速度的调节。\n$$\nF_{\\text{CE}}(l_f, v_f, a) = a \\, F_{\\max} \\, f_L(l_f) \\, f_V(v_f)\n$$\n这个复合函数需要实现其归一化的依赖项 $f_L(l_f)$ 和 $f_V(v_f)$。\n\n- **主动力-长度乘子 ($f_L$):** 这是一个在 $l_f = l_0$ 处达到峰值的高斯函数。\n    $$\n    f_L(l_f) = \\exp\\left(-\\left(\\frac{l_f - l_0}{w \\cdot l_0}\\right)^2\\right)\n    $$\n    其中 $l_0=0.1 \\ \\text{m}$，$w=0.25$。\n\n- **主动力-速度乘子 ($f_V$):** 这是一个分段函数，描述了缩短时 ($v_f  0$) 的力减小和拉长时 ($v_f  0$) 的力增强。\n    对于缩短 ($v_f \\ge 0$):\n    $$\n    f_V(v_f) = \\frac{1 - v_f/v_{\\max}}{1 + v_f/(a_c v_{\\max})}\n    $$\n    对于拉长 ($v_f  0$):\n    $$\n    f_V(v_f) = 1 + c_{\\ell}\\,\\frac{-v_f}{v_{\\max} + (-v_f)}\n    $$\n    其中 $v_{\\max}=0.1 \\ \\text{m/s}$，$a_c=0.3$，$c_{\\ell}=0.5$。\n\n**2. 构建平衡方程**\n\n定义了分量函数后，可以为一组给定的输入 $(l_m, a, v_f)$ 构建平衡函数 $G(l_f)$。对于每个测试用例，这些输入是常数，使得 $G$ 仅为 $l_f$ 的函数。\n\n**3. 数值解法**\n\n对于每个测试用例 $(l_m, a, v_f)$，我们必须找到使 $G(l_f) = 0$ 的 $l_f$ 值。\n\n- **搜索区间：** 搜索被限制在生理上和运动学上合理的区间 $[l_{f,\\min}, l_{f,\\max}]$ 内，其中 $l_{f,\\min} = 0.5\\,l_0 = 0.05 \\ \\text{m}$，$l_{f,\\max} = \\min(1.8\\,l_0, l_m) = \\min(0.18 \\ \\text{m}, l_m)$。\n\n- **求根算法：**\n    -   首先，我们计算搜索区间边界处的 $G$ 值，即 $G(l_{f,\\min})$ 和 $G(l_{f,\\max})$。\n    -   如果 $G(l_{f,\\min}) \\cdot G(l_{f,\\max}) \\le 0$，则保证区间内存在一个根。我们使用稳健的区间法，`scipy.optimize.brentq`，以高精度找到这个根。\n    -   如果区间内没有符号变化（即 $G(l_{f,\\min}) \\cdot G(l_{f,\\max})  0$），这意味着区间内没有根或有偶数个根。按照问题规范，我们找到使绝对残差 $|G(l_f)|$ 最小化的 $l_f$ 值。这是一个优化问题，我们使用 `scipy.optimize.minimize_scalar` 的 `bounded` 方法在区间 $[l_{f,\\min}, l_{f,\\max}]$ 上对函数 $|G(l_f)|$ 求解。\n\n一旦通过任一方法找到最优的 $l_f$，相应的肌腱长度就计算为 $l_t = l_m - l_f$。结果按要求四舍五入到六位小数。对所有四个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq, minimize_scalar\n\ndef solve():\n    \"\"\"\n    Computes fiber and tendon lengths for a Hill-type muscle model.\n    \"\"\"\n    #\n    # 1. Define Model Parameters\n    #\n    params = {\n        'F_max': 1500.0,       # N\n        'l_0': 0.10,           # m\n        'l_ts': 0.20,          # m\n        'v_max': 0.10,         # m/s (as 1.0 * l_0 / s)\n        'a_c': 0.30,           # dimensionless\n        'c_l': 0.50,           # dimensionless\n        'w': 0.25,             # dimensionless\n        'k_t': 2000.0,         # N\n        'k_strain': 35.0,      # dimensionless\n        'k_pe': 2.0 * 1500.0,  # N (as 2.0 * F_max)\n    }\n\n    #\n    # 2. Define Constitutive Functions for the Model\n    #\n    \n    def f_L(lf, p):\n        \"\"\"Active force-length multiplier.\"\"\"\n        return np.exp(-((lf - p['l_0']) / (p['w'] * p['l_0']))**2)\n\n    def f_V(vf, p):\n        \"\"\"Active force-velocity multiplier.\"\"\"\n        if vf = 0:  # Shortening or isometric\n            # Ensure denominator is not zero. Given vf = 0 and ac, vmax  0, this holds.\n            return (1 - vf / p['v_max']) / (1 + vf / (p['a_c'] * p['v_max']))\n        else:  # Lengthening\n            # Ensure denominator is not zero. Given vf  0 and vmax  0, this holds.\n            return 1 + p['c_l'] * (-vf) / (p['v_max'] + (-vf))\n\n    def F_CE(lf, vf, a, p):\n        \"\"\"Contractile Element force.\"\"\"\n        return a * p['F_max'] * f_L(lf, p) * f_V(vf, p)\n\n    def F_PEE(lf, p):\n        \"\"\"Parallel Elastic Element force.\"\"\"\n        if lf = p['l_0']:\n            return 0.0\n        else:\n            return p['k_pe'] * ((lf - p['l_0']) / p['l_0'])**2\n\n    def F_SEE(lt, p):\n        \"\"\"Series Elastic Element (tendon) force.\"\"\"\n        if lt = p['l_ts']:\n            return 0.0\n        else:\n            strain = (lt - p['l_ts']) / p['l_ts']\n            return p['k_t'] * (np.exp(p['k_strain'] * strain) - 1.0)\n\n    def G(lf, lm, a, vf, p):\n        \"\"\"Equilibrium error function G(lf) = 0.\"\"\"\n        lt = lm - lf\n        \n        # Check for physical validity of lengths\n        if lf  0 or lt  0:\n            return 1e12 # Return a large penalty if lengths are non-physical\n\n        force_see = F_SEE(lt, p)\n        force_ce = F_CE(lf, vf, a, p)\n        force_pee = F_PEE(lf, p)\n        \n        return force_see - (force_ce + force_pee)\n\n    #\n    # 3. Define Test Cases and Main Solver Loop\n    #\n    test_cases = [\n        # (lm, a, vf)\n        (0.32, 0.60, 0.02),\n        (0.30, 0.00, 0.00),\n        (0.36, 0.80, -0.03),\n        (0.31, 0.10, 0.05),\n    ]\n\n    results = []\n    for lm, a, vf in test_cases:\n        # Define search bounds for fiber length lf\n        lf_min = 0.5 * params['l_0']\n        lf_max = min(1.8 * params['l_0'], lm)\n\n        # Create a lambda function for the specific state\n        g_func = lambda lf: G(lf, lm, a, vf, params)\n\n        try:\n            # Check if a root is bracketed\n            g_min = g_func(lf_min)\n            g_max = g_func(lf_max)\n\n            if np.sign(g_min) != np.sign(g_max):\n                # Use a robust bracketing root finder\n                lf_sol = brentq(g_func, lf_min, lf_max)\n            else:\n                # Fallback: minimize the absolute error |G(lf)|\n                res = minimize_scalar(lambda lf: abs(g_func(lf)), bounds=(lf_min, lf_max), method='bounded')\n                lf_sol = res.x\n        except ValueError:\n            # This case might happen if values are NaN or Inf at bounds, though unlikely with this model\n            # For robustness, default to minimization\n            res = minimize_scalar(lambda lf: abs(g_func(lf)), bounds=(lf_min, lf_max), method='bounded')\n            lf_sol = res.x\n\n        # Calculate tendon length and round\n        lt_sol = lm - lf_sol\n        \n        # Append the rounded result pair\n        results.append([round(lf_sol, 6), round(lt_sol, 6)])\n\n    #\n    # 4. Format and Print the Final Output\n    #\n    # The required format is [[lf1,lt1],[lf2,lt2],...], which requires\n    # converting each inner list to its string representation.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}