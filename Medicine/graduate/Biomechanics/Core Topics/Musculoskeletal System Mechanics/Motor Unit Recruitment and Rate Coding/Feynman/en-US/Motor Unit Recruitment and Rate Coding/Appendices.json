{
    "hands_on_practices": [
        {
            "introduction": "The nervous system's primary tool for adjusting the force from an already active motor unit is to vary its firing rate. This exercise delves into this principle of rate coding by modeling how successive muscle twitches summate in time. By simulating the motor unit's response to different firing frequencies, you will directly observe the transition from unfused twitches to a smooth, sustained tetanic contraction, providing a foundational understanding of the force-frequency relationship. ",
            "id": "4192798",
            "problem": "Consider a single motor unit modeled as a Linear Time-Invariant (LTI) system whose force response to an action potential is the twitch impulse response. Let the twitch impulse response be defined for time $t \\ge 0$ by $$h(t) = A \\left(e^{-t/\\tau_d} - e^{-t/\\tau_r}\\right),$$ with $h(t) = 0$ for $t < 0$, where $\\tau_r$ is the rise time constant and $\\tau_d$ is the decay time constant. The constants are known: $\\tau_r = 0.020$ s and $\\tau_d = 0.060$ s. The twitch amplitude is normalized such that the peak twitch force equals $F_{\\text{peak}} = 0.2$ N. Assume motor unit force generation obeys linear superposition of twitches, and the spike train is modeled as a sum of Dirac delta functions at spike times.\n\nYou must simulate the force output for a duration $T = 5$ s at a uniform time step $\\Delta t = 0.0005$ s by generating spike trains at constant firing rates and computing the resulting force via superposition of the twitch impulse response. The spike trains are strictly periodic with inter-spike interval $1/f$ for a firing rate $f$ in Hertz. Begin the spike train at time $t = 0$ and place spikes at multiples of $1/f$ that lie within the interval $[0, T)$.\n\nFor numerical implementation, you will discretize time in steps of size $\\Delta t$ and represent the spike train as a vector $s[n]$ of length $N = T/\\Delta t$, where $s[n] = 1$ if there is a spike at time index $n$ and $s[n] = 0$ otherwise. The discrete twitch impulse response $h[n]$ is obtained by sampling $h(t)$ at $t = n \\Delta t$ for $n \\ge 0$ and truncating to length $N$. The motor unit force $F[n]$ at discrete times is the discrete superposition of twitches induced by the spikes. Compute the average force over the final $1$ s of the simulation interval, that is, over the indices corresponding to times in $[T-1, T)$.\n\nThe required outputs are the average forces for the following test suite of firing rates:\n- Case $1$: $f = 8$ Hz (happy path, moderate summation).\n- Case $2$: $f = 20$ Hz (increased summation).\n- Case $3$: $f = 40$ Hz (strong summation approaching fusion).\n- Case $4$: $f = 0$ Hz (boundary case, no spikes).\n- Case $5$: $f = 100$ Hz (edge case, near-complete fusion).\n\nAll forces must be expressed in Newtons and reported as decimal floats rounded to four decimal places. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"), where each result is the average force for the corresponding case in the order listed above and in units of Newtons rounded to four decimal places.",
            "solution": "The user has provided a problem statement that requires validation before a solution can be attempted.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe givens are extracted verbatim from the problem statement:\n-   **System Model**: A single motor unit modeled as a Linear Time-Invariant (LTI) system.\n-   **Twitch Impulse Response**: $h(t) = A \\left(e^{-t/\\tau_d} - e^{-t/\\tau_r}\\right)$ for $t \\ge 0$, and $h(t) = 0$ for $t < 0$.\n-   **Rise Time Constant**: $\\tau_r = 0.020$ s.\n-   **Decay Time Constant**: $\\tau_d = 0.060$ s.\n-   **Peak Twitch Force**: $F_{\\text{peak}} = 0.2$ N. The twitch amplitude is normalized to achieve this peak.\n-   **Force Generation Principle**: Linear superposition of twitches.\n-   **Spike Train Model**: A sum of Dirac delta functions at spike times.\n-   **Simulation Duration**: $T = 5$ s.\n-   **Time Step**: $\\Delta t = 0.0005$ s.\n-   **Spike Train Characteristics**: Strictly periodic with inter-spike interval $1/f$ for a firing rate $f$.\n-   **Spike Train Timing**: Begins at $t = 0$, with spikes at multiples of $1/f$ within the interval $[0, T)$.\n-   **Numerical Discretization**:\n    -   Time is discretized in steps of $\\Delta t$.\n    -   Spike train is a vector $s[n]$ of length $N = T/\\Delta t$, where $s[n] = 1$ for a spike and $s[n] = 0$ otherwise.\n    -   Discrete twitch response $h[n]$ is sampled from $h(t)$ at $t = n \\Delta t$ and truncated to length $N$.\n    -   Discrete force $F[n]$ is the discrete superposition of twitches.\n-   **Required Calculation**: The average force over the final $1$ s of the simulation, corresponding to times in $[T-1, T)$.\n-   **Test Cases**: Firing rates $f$ of $8$ Hz, $20$ Hz, $40$ Hz, $0$ Hz, and $100$ Hz.\n-   **Output Format**: Results reported as decimal floats rounded to four decimal places, in a comma-separated list enclosed in square brackets.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded**: The problem is based on a standard and widely accepted simplified model of motor unit force production in biomechanics. The LTI system approach, the double-exponential twitch function $h(t)$, and the principle of linear superposition are cornerstone concepts in the field. The provided time constants are physiologically realistic for a muscle's contractile properties.\n-   **Well-Posed**: The problem is clearly defined with all necessary parameters and conditions provided. The objective—to compute the average force for several specified firing rates—is unambiguous. The constant $A$ is not given directly, but the problem states the twitch is normalized to a peak force $F_{\\text{peak}}$, providing a solvable constraint to determine $A$. This makes the problem self-contained. A unique, stable, and meaningful solution exists for each test case.\n-   **Objective**: The problem is stated in precise, quantitative, and objective language, free of any subjective or ambiguous terminology.\n\nA review against the list of invalidating flaws confirms the problem's validity:\n1.  **Scientific/Factual Unsoundness**: None. The model is a valid scientific abstraction.\n2.  **Non-Formalizable/Irrelevant**: None. The problem is a formal computational task directly relevant to motor unit mechanics.\n3.  **Incomplete/Contradictory Setup**: None. The setup is complete and internally consistent.\n4.  **Unrealistic/Infeasible**: None. All parameters are within physically realistic ranges.\n5.  **Ill-Posed/Poorly Structured**: None. The problem is well-structured and leads to a unique solution.\n6.  **Pseudo-Profound/Trivial**: None. The problem requires a standard but non-trivial numerical simulation (convolution).\n7.  **Outside Scientific Verifiability**: None. The results are computationally verifiable.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A solution will be provided.\n\n### Solution\n\nThe problem requires the simulation of a motor unit's force output by modeling it as a Linear Time-Invariant (LTI) system. The force output $F(t)$ is the convolution of the input spike train $s(t)$ with the motor unit's twitch impulse response $h(t)$. For a discrete-time simulation, this translates to a discrete convolution.\n\n**1. Normalization of the Twitch Impulse Response**\n\nThe twitch impulse response is given by $h(t) = A \\left(e^{-t/\\tau_d} - e^{-t/\\tau_r}\\right)$. The amplitude scalar $A$ must be determined from the condition that the peak force of a single twitch is $F_{\\text{peak}} = 0.2$ N.\n\nFirst, we find the time $t_{\\text{peak}}$ at which the peak of $h(t)$ occurs by setting its derivative to zero:\n$$ \\frac{dh}{dt} = A \\left(-\\frac{1}{\\tau_d}e^{-t/\\tau_d} + \\frac{1}{\\tau_r}e^{-t/\\tau_r}\\right) = 0 $$\n$$ \\frac{1}{\\tau_r}e^{-t/\\tau_r} = \\frac{1}{\\tau_d}e^{-t/\\tau_d} $$\nTaking the natural logarithm of both sides gives:\n$$ \\ln\\left(\\frac{\\tau_d}{\\tau_r}\\right) = t\\left(\\frac{1}{\\tau_r} - \\frac{1}{\\tau_d}\\right) = t\\left(\\frac{\\tau_d - \\tau_r}{\\tau_r\\tau_d}\\right) $$\nSolving for $t = t_{\\text{peak}}$:\n$$ t_{\\text{peak}} = \\frac{\\tau_r\\tau_d}{\\tau_d - \\tau_r}\\ln\\left(\\frac{\\tau_d}{\\tau_r}\\right) $$\nSubstituting the given values $\\tau_r = 0.020$ s and $\\tau_d = 0.060$ s:\n$$ t_{\\text{peak}} = \\frac{(0.020)(0.060)}{0.060 - 0.020}\\ln\\left(\\frac{0.060}{0.020}\\right) = \\frac{0.0012}{0.04}\\ln(3) = 0.03\\ln(3) \\approx 0.03296 \\text{ s} $$\nNow, we evaluate $h(t_{\\text{peak}})$ and set it equal to $F_{\\text{peak}}$ to find $A$:\n$$ F_{\\text{peak}} = h(t_{\\text{peak}}) = A \\left(e^{-t_{\\text{peak}}/\\tau_d} - e^{-t_{\\text{peak}}/\\tau_r}\\right) $$\n$$ A = \\frac{F_{\\text{peak}}}{e^{-t_{\\text{peak}}/\\tau_d} - e^{-t_{\\text{peak}}/\\tau_r}} $$\nWith $F_{\\text{peak}} = 0.2$ N, we can calculate the numerical value for $A$.\n\n**2. Discretization**\n\nThe simulation is performed over a duration $T=5$ s with a time step $\\Delta t = 0.0005$ s. The total number of discrete time points is $N = T/\\Delta t = 5/0.0005 = 10000$. The discrete time vector is $t_n = n\\Delta t$ for $n \\in \\{0, 1, ..., N-1\\}$.\n\nThe continuous twitch response $h(t)$ is sampled to create a discrete impulse response vector $h[n]$ of length $N$:\n$$ h[n] = h(t_n) = A \\left(e^{-n\\Delta t/\\tau_d} - e^{-n\\Delta t/\\tau_r}\\right) $$\n\n**3. Spike Train Generation**\n\nFor a given firing rate $f$ (in Hz), the inter-spike interval is $ISI = 1/f$. The spike times are $t_k = k \\cdot ISI$ for integers $k \\ge 0$ such that $t_k < T$. The discrete spike train $s[n]$ is a vector of length $N$ where $s[n]=1$ if a spike occurs at time $t_n$ and $s[n]=0$ otherwise. The time index $n_k$ corresponding to a spike time $t_k$ is found by $n_k = \\text{round}(t_k / \\Delta t)$. For $f=0$ Hz, the spike train is all zeros.\n\n**4. Force Calculation via Discrete Convolution**\n\nThe total force output $F[n]$ is the linear superposition of the twitch responses to each spike. This is calculated by the discrete convolution of the spike train $s[n]$ with the twitch response $h[n]$:\n$$ F[n] = (s * h)[n] = \\sum_{k=0}^{n} s[k]h[n-k] $$\nThe result of this convolution will be a vector representing the force at each time step. The output of a standard convolution algorithm has a length of $2N-1$; this must be truncated to the simulation length $N$.\n\n**5. Calculation of Average Force**\n\nThe final step is to compute the average force over the last $1$ second of the simulation, which corresponds to the time interval $[T-1, T) = [4, 5)$. The starting index for this interval is $n_{\\text{start}} = (T-1)/\\Delta t = 4/0.0005 = 8000$. The average force $\\bar{F}$ is the mean of the force values from index $n_{\\text{start}}$ to $N-1$:\n$$ \\bar{F} = \\frac{1}{N - n_{\\text{start}}} \\sum_{n=n_{\\text{start}}}^{N-1} F[n] $$\nThis procedure is repeated for each firing rate in the test suite.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates motor unit force output for various firing rates based on an LTI model.\n    \"\"\"\n    # Define constants from the problem statement\n    T = 5.0  # s, simulation duration\n    dt = 0.0005  # s, time step\n    tau_r = 0.020  # s, twitch rise time constant\n    tau_d = 0.060  # s, twitch decay time constant\n    F_peak = 0.2  # N, peak twitch force\n\n    # Test suite of firing rates\n    test_firing_rates = [8.0, 20.0, 40.0, 0.0, 100.0]  # Hz\n\n    # --- Pre-computation Steps ---\n\n    # 1. Calculate the normalization constant A for the twitch response function\n    # The peak of the twitch h(t) occurs at t_peak where the derivative h'(t) = 0.\n    # The analytical solution for t_peak is:\n    t_peak = (tau_r * tau_d) / (tau_d - tau_r) * np.log(tau_d / tau_r)\n    \n    # Evaluate the unscaled twitch response at its peak\n    h_peak_unscaled = np.exp(-t_peak / tau_d) - np.exp(-t_peak / tau_r)\n    \n    # Determine the scaling factor A to match the specified F_peak\n    A = F_peak / h_peak_unscaled\n\n    # 2. Set up discrete time vector and compute discrete twitch response\n    N = int(T / dt)\n    time_vector = np.arange(N) * dt\n    \n    # The discrete twitch impulse response h[n] is obtained by sampling h(t)\n    h_discrete = A * (np.exp(-time_vector / tau_d) - np.exp(-time_vector / tau_r))\n\n    # --- Simulation Loop ---\n    \n    results = []\n    for f in test_firing_rates:\n        # Handle the boundary case of zero firing rate\n        if f == 0.0:\n            results.append(0.0)\n            continue\n\n        # 1. Generate the discrete spike train s[n]\n        s_discrete = np.zeros(N)\n        isi = 1.0 / f  # Inter-spike interval\n        \n        # Calculate spike times, ensuring they are within the simulation interval [0, T)\n        spike_times = np.arange(0, T, isi)\n        \n        # Convert spike times to discrete time indices, rounding to the nearest index\n        spike_indices = np.round(spike_times / dt).astype(int)\n        \n        # Ensure indices are within the valid range [0, N-1]\n        spike_indices = spike_indices[spike_indices < N]\n        \n        # Populate the spike train vector\n        s_discrete[spike_indices] = 1.0\n\n        # 2. Compute the force output F[n] via discrete convolution\n        # Force F[n] is the convolution of the spike train s[n] with the twitch response h[n].\n        # The output is truncated to the simulation length N.\n        force_output = np.convolve(s_discrete, h_discrete)[:N]\n\n        # 3. Calculate the average force over the final 1 second of the simulation\n        # The time interval is [T-1, T), starting at index (T-1)/dt\n        start_index_avg = int((T - 1.0) / dt)\n        \n        # Compute the mean of the force values in the specified interval\n        average_force = np.mean(force_output[start_index_avg:])\n        \n        results.append(average_force)\n\n    # Format the final output as a comma-separated list of strings,\n    # with each number rounded to four decimal places.\n    formatted_results = [\"{:.4f}\".format(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While rate coding governs the output of a single motor unit, muscles grade force by coordinating a whole population of units according to Henneman's size principle. This practice asks you to build a computational model of a motor pool to explore how the dual strategies of orderly recruitment and rate modulation work together. Implementing this model will provide quantitative insight into how a simple, ramping neural drive can produce a smooth, non-linear increase in total muscle force. ",
            "id": "4192755",
            "problem": "You are tasked with implementing a mechanistic simulation of motor unit recruitment and rate coding during a ramp increase of synaptic drive, based on the size principle and well-established physiological relationships. The goal is to generate a recruitment curve and compute cumulative muscle force as a function of synaptic drive using a deterministic motor unit pool and specified parameter values.\n\nStart from the following fundamental and widely accepted bases: (i) Henneman’s size principle, which states that motor units with lower rheobase are recruited first; (ii) the definition of rheobase as the minimal synaptic drive required to generate sustained firing; (iii) the approximation that firing rate increases approximately linearly with net drive above threshold over a physiological range; and (iv) the observation that force summation from repeated twitches saturates with firing rate due to twitch fusion.\n\nUse the following model definitions and parameterization, which are consistent with these bases:\n\n- Motor unit pool and rheobase distribution:\n  - There are $N$ motor units indexed by $i \\in \\{1,\\dots,N\\}$.\n  - Synaptic drive is a scalar input $I$ in arbitrary units (a.u.).\n  - Each motor unit has a rheobase (threshold) $I_{\\mathrm{th},i}$, deterministically arranged on a geometric progression to reflect the broad, approximately log-spaced distribution observed physiologically:\n    $$I_{\\mathrm{th},i} \\;=\\; I_{\\min}\\,\\left(\\frac{I_{\\max}}{I_{\\min}}\\right)^{\\frac{i-1}{N-1}}.$$\n  - Recruitment rule (size principle): motor unit $i$ is recruited if and only if $I \\ge I_{\\mathrm{th},i}$.\n\n- Firing rate model (rate coding):\n  - For an unrecruited unit ($I < I_{\\mathrm{th},i}$), the firing rate is $f_i(I)=0$.\n  - For a recruited unit ($I \\ge I_{\\mathrm{th},i}$), the firing rate increases linearly with surplus drive above threshold with lower and upper bounds representing physiological discharge limits:\n    $$f_i(I) \\;=\\; \\min\\!\\left(f_{\\max},\\,\\max\\!\\left(f_{\\min},\\, f_{\\min} + k\\,[\\,I - I_{\\mathrm{th},i}\\,]\\right)\\right).$$\n  - Here, $f_{\\min}$ and $f_{\\max}$ are in Hertz (Hz), and $k$ is in Hertz per arbitrary unit (Hz/a.u.).\n\n- Motor unit force model:\n  - The maximal tetanic force of motor unit $i$ increases monotonically across the pool as rheobase increases (reflecting larger motor units with higher thresholds), using:\n    $$F_{0,i} \\;=\\; F_{\\min}\\,\\left(\\frac{I_{\\mathrm{th},i}}{I_{\\min}}\\right)^{\\gamma},$$\n    where $F_{\\min}$ is in Newtons (N) and $\\gamma > 0$ modulates the spread.\n  - The normalized force-frequency relation is modeled by a saturating Hill-type function:\n    $$\\phi(f) \\;=\\; \\frac{f}{f + f_{1/2}},$$\n    where $f$ is in Hertz (Hz) and $f_{1/2}$ is the half-fusion frequency in Hertz (Hz).\n  - The force of unit $i$ at drive $I$ is:\n    $$F_i(I) \\;=\\; F_{0,i}\\,\\phi\\!\\left(f_i(I)\\right).$$\n\n- Aggregate outputs:\n  - The recruitment fraction is:\n    $$r(I) \\;=\\; \\frac{1}{N}\\sum_{i=1}^{N}\\mathbf{1}\\!\\left[I \\ge I_{\\mathrm{th},i}\\right],$$\n    where $\\mathbf{1}[\\cdot]$ is the indicator function.\n  - The cumulative force is:\n    $$F_{\\mathrm{tot}}(I) \\;=\\; \\sum_{i=1}^{N} F_i(I),$$\n    in Newtons (N).\n\nImplement a program that, for the specified parameter values and synaptic drive test inputs below, computes $r(I)$ and $F_{\\mathrm{tot}}(I)$.\n\nParameters to use for all test cases:\n- $N = 10$\n- $I_{\\min} = 1.0$ a.u.\n- $I_{\\max} = 5.0$ a.u.\n- $F_{\\min} = 0.1$ N\n- $\\gamma = 2.0$\n- $f_{\\min} = 8.0$ Hz\n- $f_{\\max} = 35.0$ Hz\n- $k = 20.0$ Hz/a.u.\n- $f_{1/2} = 12.0$ Hz\n\nTest suite (synaptic drive inputs in arbitrary units):\n- Case A: $I = 0.8$\n- Case B: $I = 1.0$\n- Case C: $I = 3.0$\n- Case D: $I = 6.0$\n\nNumerical and output requirements:\n- Express force in Newtons (N).\n- For each case, return two values: $r(I)$ and $F_{\\mathrm{tot}}(I)$.\n- Round both $r(I)$ and $F_{\\mathrm{tot}}(I)$ to $3$ decimals.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order [Case A $r$, Case A $F_{\\mathrm{tot}}$, Case B $r$, Case B $F_{\\mathrm{tot}}$, Case C $r$, Case C $F_{\\mathrm{tot}}$, Case D $r$, Case D $F_{\\mathrm{tot}}$]. For example, the format must be exactly like:\n  $$[x_1,x_2,x_3,x_4,x_5,x_6,x_7,x_8]$$\nwhere each $x_j$ is a float rounded to $3$ decimals.",
            "solution": "The problem statement presents a deterministic, mechanistic model of motor unit recruitment and rate coding to simulate aggregate muscle force as a function of synaptic drive. The model is based on established neurophysiological principles, including Henneman's size principle, and is fully specified with a complete set of mathematical equations and parameter values. All components are clearly defined, scientifically grounded, and internally consistent. There are no ambiguities, contradictions, or missing information. Thus, the problem is deemed valid and well-posed. The solution proceeds by implementing the specified model and applying it to the given test cases.\n\nThe solution requires calculating the recruitment fraction, $r(I)$, and the cumulative muscle force, $F_{\\mathrm{tot}}(I)$, for four different levels of synaptic drive $I$. This is achieved through a three-step process for each value of $I$:\n1. Determine the properties of the motor unit pool.\n2. For each motor unit, calculate its recruitment status, firing rate, and individual force contribution.\n3. Aggregate the results across the entire pool to find the total recruitment fraction and force.\n\n**Step 1: Motor Unit Pool Parameterization**\n\nFirst, we define the intrinsic properties of the $N=10$ motor units. These properties are constant for all test cases.\n\nThe rheobase (recruitment threshold) for each motor unit $i \\in \\{1, \\dots, 10\\}$ is given by a geometric progression:\n$$I_{\\mathrm{th},i} \\;=\\; I_{\\min}\\,\\left(\\frac{I_{\\max}}{I_{\\min}}\\right)^{\\frac{i-1}{N-1}}$$\nUsing the provided parameters $N=10$, $I_{\\min}=1.0$ a.u., and $I_{\\max}=5.0$ a.u., the thresholds are:\n$$I_{\\mathrm{th},i} \\;=\\; 1.0 \\times \\left(\\frac{5.0}{1.0}\\right)^{\\frac{i-1}{9}} \\;=\\; 5^{\\frac{i-1}{9}}$$\nThis creates a set of thresholds ranging from $I_{\\mathrm{th},1} = 5^0 = 1.0$ a.u. to $I_{\\mathrm{th},10} = 5^1 = 5.0$ a.u.\n\nThe maximal tetanic force, $F_{0,i}$, for each motor unit is dependent on its rheobase:\n$$F_{0,i} \\;=\\; F_{\\min}\\,\\left(\\frac{I_{\\mathrm{th},i}}{I_{\\min}}\\right)^{\\gamma}$$\nWith $F_{\\min}=0.1$ N, $I_{\\min}=1.0$ a.u., and $\\gamma=2.0$, this simplifies to:\n$$F_{0,i} \\;=\\; 0.1 \\times \\left(\\frac{I_{\\mathrm{th},i}}{1.0}\\right)^{2.0} \\;=\\; 0.1\\,(I_{\\mathrm{th},i})^2$$\nThis establishes that motor units with higher recruitment thresholds are capable of generating greater maximal forces.\n\n**Step 2: Per-Unit Calculation for a given Synaptic Drive $I$**\n\nFor each motor unit $i$ and a given synaptic drive $I$, we sequentially determine its state.\n\n- **Recruitment:** Motor unit $i$ is active if and only if $I \\ge I_{\\mathrm{th},i}$.\n\n- **Firing Rate $f_i(I)$:** If the unit is not recruited ($I < I_{\\mathrm{th},i}$), its firing rate is $f_i(I)=0$ Hz. If it is recruited ($I \\ge I_{\\mathrm{th},i}$), its firing rate is determined by the linear rate-coding model, bounded by physiological limits $f_{\\min}$ and $f_{\\max}$:\n$$f_i(I) \\;=\\; \\min\\!\\left(f_{\\max},\\,\\max\\!\\left(f_{\\min},\\, f_{\\min} + k\\,[\\,I - I_{\\mathrm{th},i}\\,]\\right)\\right)$$\nSubstituting the given parameters $f_{\\min}=8.0$ Hz, $f_{\\max}=35.0$ Hz, and $k=20.0$ Hz/a.u., we get:\n$$f_i(I) \\;=\\; \\min\\!\\left(35.0,\\,\\max\\!\\left(8.0,\\, 8.0 + 20.0\\,[\\,I - I_{\\mathrm{th},i}\\,]\\right)\\right)$$\n\n- **Individual Force $F_i(I)$:** The force produced by motor unit $i$ is its maximal force $F_{0,i}$ modulated by its current firing rate $f_i(I)$. The force-frequency relationship is given by the Hill-type function $\\phi(f)$:\n$$F_i(I) \\;=\\; F_{0,i}\\,\\phi\\!\\left(f_i(I)\\right) \\;=\\; F_{0,i}\\,\\frac{f_i(I)}{f_i(I) + f_{1/2}}$$\nWith $f_{1/2}=12.0$ Hz, the equation becomes:\n$$F_i(I) \\;=\\; F_{0,i}\\,\\frac{f_i(I)}{f_i(I) + 12.0}$$\nIf a unit is not recruited, $f_i(I)=0$, and thus $F_i(I)=0$ N.\n\n**Step 3: Aggregation and Application to Test Cases**\n\nThe procedure from Step 2 is performed for all $N=10$ motor units. The aggregate outputs for a given $I$ are then calculated.\n\n- **Recruitment Fraction $r(I)$:** This is the fraction of motor units for which $I \\ge I_{\\mathrm{th},i}$.\n$$r(I) \\;=\\; \\frac{1}{N}\\sum_{i=1}^{N}\\mathbf{1}\\!\\left[I \\ge I_{\\mathrm{th},i}\\right]$$\nwhere $\\mathbf{1}[\\cdot]$ is the indicator function.\n\n- **Cumulative Force $F_{\\mathrm{tot}}(I)$:** This is the sum of the forces from all individual motor units.\n$$F_{\\mathrm{tot}}(I) \\;=\\; \\sum_{i=1}^{N} F_i(I)$$\n\nThis entire process is repeated for each of the four test cases: $I=0.8$, $I=1.0$, $I=3.0$, and $I=6.0$. The final numerical results are then rounded to $3$ decimal places as required. For instance:\n\n- **Case A ($I = 0.8$):** Since $I < I_{\\mathrm{th},1} = 1.0$, no units are recruited. Thus, $r(0.8) = 0.0$ and $F_{\\mathrm{tot}}(0.8) = 0.0$ N.\n- **Case B ($I = 1.0$):** Only motor unit $i=1$ is recruited, as $I = I_{\\mathrm{th},1}$. Thus, $r(1.0) = 1/10 = 0.1$. Its firing rate is $f_1(1.0) = \\max(8.0, 8.0 + 20(1.0-1.0)) = 8.0$ Hz. The force is $F_1(1.0) = F_{0,1} \\frac{8.0}{8.0+12.0} = 0.1\\cdot (1.0)^2 \\cdot 0.4 = 0.04$ N. Total force $F_{\\mathrm{tot}}(1.0) = 0.04$ N.\n- **Case C ($I = 3.0$):** All units with $I_{\\mathrm{th},i} \\le 3.0$ are recruited. The total force is the sum of their individual contributions.\n- **Case D ($I = 6.0$):** Since $I > I_{\\mathrm{th},10}=5.0$, all $10$ units are recruited. $r(6.0) = 1.0$. All units fire, many at the maximal rate $f_{\\max}$, and the total force is the sum of all their contributions.\n\nThe implementation automates these calculations for all cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates motor unit recruitment and rate coding to calculate recruitment\n    fraction and cumulative muscle force for a series of synaptic drive inputs.\n    \"\"\"\n    # Define the model parameters from the problem statement.\n    N = 10         # Number of motor units\n    I_min = 1.0    # Minimum rheobase (a.u.)\n    I_max = 5.0    # Maximum rheobase (a.u.)\n    F_min = 0.1    # Minimum maximal tetanic force (N)\n    gamma = 2.0    # Force-rheobase scaling exponent\n    f_min = 8.0    # Minimum firing rate (Hz)\n    f_max = 35.0   # Maximum firing rate (Hz)\n    k = 20.0       # Firing rate gain (Hz/a.u.)\n    f_half = 12.0  # Half-fusion frequency (Hz)\n\n    # Define the test cases for synaptic drive.\n    test_cases_I = [0.8, 1.0, 3.0, 6.0]\n\n    # --- Step 1: Motor Unit Pool Parameterization ---\n    # Create an array for motor unit indices from 1 to N.\n    i = np.arange(1, N + 1)\n    \n    # Calculate the rheobase (recruitment threshold) for each motor unit.\n    # I_th,i = I_min * (I_max / I_min)**((i - 1) / (N - 1))\n    I_th = I_min * (I_max / I_min)**((i - 1) / (N - 1))\n    \n    # Calculate the maximal tetanic force for each motor unit.\n    # F_0,i = F_min * (I_th,i / I_min)**gamma\n    F_0 = F_min * (I_th / I_min)**gamma\n\n    # List to store the results for all test cases.\n    results = []\n    \n    # --- Main Loop: Iterate through each test case ---\n    for I in test_cases_I:\n        # --- Step 2: Per-Unit Calculations ---\n        \n        # Determine which motor units are recruited.\n        # A boolean array where True means the unit is recruited.\n        is_recruited = I >= I_th\n\n        # Calculate firing rate f_i(I) for each motor unit.\n        f_i = np.zeros(N) # Initialize all rates to 0.\n        \n        # Only calculate firing rates for recruited units.\n        if np.any(is_recruited):\n            # Calculate surplus drive for recruited units.\n            surplus_drive = I - I_th[is_recruited]\n            \n            # Linear rate coding model for recruited units.\n            # f_i(I) = f_min + k * (I - I_th,i)\n            uncapped_rate = f_min + k * surplus_drive\n            \n            # Apply lower and upper bounds (clamping).\n            # f_i(I) = min(f_max, max(f_min, ...))\n            # The max(f_min, ...) is intrinsically handled because surplus_drive >= 0\n            # for recruited units, so uncapped_rate >= f_min. We only need to check f_max.\n            # However, for robustness, we implement the full logic.\n            recruited_rates = np.maximum(f_min, uncapped_rate)\n            recruited_rates = np.minimum(f_max, recruited_rates)\n            \n            # Update the firing rate array for the recruited units.\n            f_i[is_recruited] = recruited_rates\n\n        # Calculate force F_i(I) for each motor unit.\n        # phi(f) = f / (f + f_1/2)\n        # We add a small epsilon to the denominator to avoid division by zero\n        # in the theoretical case that f_half could be 0, though it's not here.\n        # For f_i=0, phi will correctly be 0.\n        phi = f_i / (f_i + f_half + 1e-9)\n        \n        # F_i(I) = F_0,i * phi(f_i(I))\n        F_i = F_0 * phi\n\n        # --- Step 3: Aggregation ---\n        \n        # Calculate recruitment fraction r(I).\n        r_I = np.sum(is_recruited) / N\n        \n        # Calculate cumulative force F_tot(I).\n        F_tot_I = np.sum(F_i)\n        \n        # Append the rounded results to the list.\n        results.append(round(r_I, 3))\n        results.append(round(F_tot_I, 3))\n\n    # Final print statement in the exact required format.\n    # Using f-strings with a format specifier ensures trailing zeros.\n    print(f\"[{','.join(f'{x:.3f}' for x in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Henneman's size principle provides an elegant and efficient rule for force gradation, but motor control is also remarkably flexible. This practice explores how the central nervous system can dynamically alter recruitment patterns for specific tasks by providing non-uniform synaptic drive to the motor pool. By analytically deriving the conditions for recruitment order reversal from a biophysical model, you will gain a deeper appreciation for the interplay between a motor neuron's intrinsic properties and extrinsic synaptic inputs, a key mechanism for adaptable motor behavior. ",
            "id": "4192813",
            "problem": "A motor pool consists of two representative spinal motor neurons, indexed by $i \\in \\{L,H\\}$ for a low-threshold (small) unit $L$ and a high-threshold (large) unit $H$. Each motor neuron’s somatic membrane is modeled by a parallel conductance equation with a passive leak conductance $g_{L,i}$ and an excitatory synaptic conductance $g_{\\mathrm{syn},i}$ driven by selective cortical input. Assume quasi-steady recruitment under a slowly ramped cortical drive $D$, so that capacitive dynamics satisfy $dV/dt \\approx 0$, and the steady-state current balance applies: the sum of ohmic currents to the leak reversal potential $E_L$ and to the excitatory synaptic reversal potential $E_e$ is zero.\n\nThe selective cortical drive produces an excitatory synaptic conductance according to $g_{\\mathrm{syn},i} = w_i D$, where $w_i$ is a dimensionless synaptic weight reflecting the strength of corticospinal projections to motor neuron $i$. Let the motor neuron fire when its steady-state membrane potential $V_i$ reaches its spike threshold $V_{\\mathrm{th},i}$. Under these assumptions, recruitment of unit $i$ occurs at the smallest $D$ for which the steady-state solution $V_i(D)$ equals $V_{\\mathrm{th},i}$.\n\nStarting from the ohmic current balance and the parallel conductance model, derive the condition on the synaptic weight ratio $w_H/w_L$ under which recruitment order reverses relative to the classic size principle (i.e., the high-threshold unit $H$ recruits before the low-threshold unit $L$ as $D$ is increased). Then, for the biophysically plausible parameter set\n- leak reversal potential $E_L = -65\\,\\mathrm{mV}$,\n- excitatory synaptic reversal potential $E_e = 0\\,\\mathrm{mV}$ (consistent with fast glutamatergic drive),\n- low-threshold unit leak conductance $g_{L,L} = 0.05\\,\\mu\\mathrm{S}$,\n- high-threshold unit leak conductance $g_{L,H} = 0.20\\,\\mu\\mathrm{S}$,\n- low-threshold unit spike threshold $V_{\\mathrm{th},L} = -50\\,\\mathrm{mV}$,\n- high-threshold unit spike threshold $V_{\\mathrm{th},H} = -45\\,\\mathrm{mV}$,\n\ncompute the minimal value of the synaptic weight ratio $w_H/w_L$ at which the recruitment thresholds are exactly equal (the crossover point), beyond which the high-threshold unit recruits first. Express your final answer as a dimensionless number. Round your answer to four significant figures.",
            "solution": "The problem requires us to derive the condition for an inversion of the motor unit recruitment order relative to the classic size principle and then to calculate the specific synaptic weight ratio at which the recruitment thresholds for a high-threshold and a low-threshold unit are equal.\n\nFirst, we must derive the expression for the recruitment threshold drive, $D_{\\mathrm{th},i}$, for a generic motor neuron $i$. The problem specifies a parallel-conductance model operating in a quasi-steady state ($dV/dt \\approx 0$). This implies that the sum of all currents across the membrane is zero, according to Kirchhoff's current law. The currents are the passive leak current, $I_{L,i}$, and the excitatory synaptic current, $I_{\\mathrm{syn},i}$.\n\nThe current balance equation is:\n$$I_{L,i} + I_{\\mathrm{syn},i} = 0$$\nUsing the ohmic formulation for each current, $I = g(V - E)$, where $g$ is the conductance, $V$ is the membrane potential, and $E$ is the reversal potential, we can write:\n$$g_{L,i}(V_i - E_L) + g_{\\mathrm{syn},i}(V_i - E_e) = 0$$\nHere, $V_i$ is the steady-state membrane potential of neuron $i$, $g_{L,i}$ is its leak conductance, $E_L$ is the leak reversal potential, $g_{\\mathrm{syn},i}$ is the synaptic conductance, and $E_e$ is the excitatory synaptic reversal potential.\n\nThe synaptic conductance is driven by the cortical input $D$ according to the relation $g_{\\mathrm{syn},i} = w_i D$, where $w_i$ is the synaptic weight. Substituting this into the current balance equation:\n$$g_{L,i}(V_i - E_L) + (w_i D)(V_i - E_e) = 0$$\nOur goal is to find the drive $D$ at which the neuron is recruited. Recruitment occurs when $V_i$ reaches the spike threshold, $V_{\\mathrm{th},i}$. Let's first solve for $V_i$ as a function of $D$:\n$$g_{L,i}V_i - g_{L,i}E_L + w_i D V_i - w_i D E_e = 0$$\n$$V_i(g_{L,i} + w_i D) = g_{L,i}E_L + w_i D E_e$$\n$$V_i(D) = \\frac{g_{L,i}E_L + w_i D E_e}{g_{L,i} + w_i D}$$\nRecruitment occurs at the threshold drive $D_{\\mathrm{th},i}$ where $V_i(D_{\\mathrm{th},i}) = V_{\\mathrm{th},i}$. We set $V_i = V_{\\mathrm{th},i}$ and $D = D_{\\mathrm{th},i}$ and solve for $D_{\\mathrm{th},i}$:\n$$V_{\\mathrm{th},i} = \\frac{g_{L,i}E_L + w_i D_{\\mathrm{th},i} E_e}{g_{L,i} + w_i D_{\\mathrm{th},i}}$$\n$$V_{\\mathrm{th},i}(g_{L,i} + w_i D_{\\mathrm{th},i}) = g_{L,i}E_L + w_i D_{\\mathrm{th},i} E_e$$\n$$V_{\\mathrm{th},i}g_{L,i} + V_{\\mathrm{th},i}w_i D_{\\mathrm{th},i} = g_{L,i}E_L + w_i D_{\\mathrm{th},i} E_e$$\nTo isolate $D_{\\mathrm{th},i}$, we group terms containing it:\n$$V_{\\mathrm{th},i}g_{L,i} - g_{L,i}E_L = w_i D_{\\mathrm{th},i}E_e - V_{\\mathrm{th},i}w_i D_{\\mathrm{th},i}$$\n$$g_{L,i}(V_{\\mathrm{th},i} - E_L) = w_i D_{\\mathrm{th},i}(E_e - V_{\\mathrm{th},i})$$\nSolving for $D_{\\mathrm{th},i}$ yields the general expression for the recruitment threshold:\n$$D_{\\mathrm{th},i} = \\frac{g_{L,i}}{w_i} \\frac{V_{\\mathrm{th},i} - E_L}{E_e - V_{\\mathrm{th},i}}$$\n\nThe classic size principle states that the low-threshold (small) unit $L$ is recruited before the high-threshold (large) unit $H$, meaning $D_{\\mathrm{th},L} < D_{\\mathrm{th},H}$. Recruitment order reversal occurs when $D_{\\mathrm{th},H} < D_{\\mathrm{th},L}$. Using our derived expression, this condition is:\n$$\\frac{g_{L,H}}{w_H} \\frac{V_{\\mathrm{th},H} - E_L}{E_e - V_{\\mathrm{th},H}} < \\frac{g_{L,L}}{w_L} \\frac{V_{\\mathrm{th},L} - E_L}{E_e - V_{\\mathrm{th},L}}$$\nTo find the condition on the synaptic weight ratio $w_H/w_L$, we rearrange this inequality. We first confirm that all factors are positive, which they are for the given biophysical parameters. Thus, the inequality direction is preserved.\n$$\\frac{w_H}{w_L} > \\frac{g_{L,H}}{g_{L,L}} \\left( \\frac{V_{\\mathrm{th},H} - E_L}{V_{\\mathrm{th},L} - E_L} \\right) \\left( \\frac{E_e - V_{\\mathrm{th},L}}{E_e - V_{\\mathrm{th},H}} \\right)$$\nThis is the general condition for reversal of the recruitment order.\n\nThe problem asks for the minimal value of $w_H/w_L$ at which reversal begins. This corresponds to the crossover point where the recruitment thresholds are identical, $D_{\\mathrm{th},L} = D_{\\mathrm{th},H}$. The condition becomes an equality:\n$$\\frac{w_H}{w_L} = \\frac{g_{L,H}}{g_{L,L}} \\left( \\frac{V_{\\mathrm{th},H} - E_L}{V_{\\mathrm{th},L} - E_L} \\right) \\left( \\frac{E_e - V_{\\mathrm{th},L}}{E_e - V_{\\mathrm{th},H}} \\right)$$\nWe now substitute the provided biophysically plausible parameters:\n- $E_L = -65\\,\\mathrm{mV}$\n- $E_e = 0\\,\\mathrm{mV}$\n- $g_{L,L} = 0.05\\,\\mu\\mathrm{S}$\n- $g_{L,H} = 0.20\\,\\mu\\mathrm{S}$\n- $V_{\\mathrm{th},L} = -50\\,\\mathrm{mV}$\n- $V_{\\mathrm{th},H} = -45\\,\\mathrm{mV}$\n\nFirst, we compute the ratios and differences:\nThe ratio of leak conductances:\n$$\\frac{g_{L,H}}{g_{L,L}} = \\frac{0.20\\,\\mu\\mathrm{S}}{0.05\\,\\mu\\mathrm{S}} = 4$$\nThe voltage differences required for the calculation:\n$$V_{\\mathrm{th},H} - E_L = -45\\,\\mathrm{mV} - (-65\\,\\mathrm{mV}) = 20\\,\\mathrm{mV}$$\n$$V_{\\mathrm{th},L} - E_L = -50\\,\\mathrm{mV} - (-65\\,\\mathrm{mV}) = 15\\,\\mathrm{mV}$$\n$$E_e - V_{\\mathrm{th},L} = 0\\,\\mathrm{mV} - (-50\\,\\mathrm{mV}) = 50\\,\\mathrm{mV}$$\n$$E_e - V_{\\mathrm{th},H} = 0\\,\\mathrm{mV} - (-45\\,\\mathrm{mV}) = 45\\,\\mathrm{mV}$$\nNow, we substitute these values into the expression for the weight ratio at crossover:\n$$\\frac{w_H}{w_L} = (4) \\times \\left( \\frac{20}{15} \\right) \\times \\left( \\frac{50}{45} \\right)$$\nSimplifying the fractions:\n$$\\frac{w_H}{w_L} = 4 \\times \\frac{4}{3} \\times \\frac{10}{9} = \\frac{4 \\times 4 \\times 10}{3 \\times 9} = \\frac{160}{27}$$\nFinally, we compute the numerical value of this fraction and round to four significant figures:\n$$\\frac{160}{27} \\approx 5.9259259...$$\nRounding to four significant figures, we get $5.926$. This is the minimal synaptic weight ratio for the high-threshold unit relative to the low-threshold unit that would cause them to be recruited at the exact same level of cortical drive, overcoming the effects of the size principle.",
            "answer": "$$\\boxed{5.926}$$"
        }
    ]
}