{
    "hands_on_practices": [
        {
            "introduction": "在研究血流从层流到湍流的转变之前，首先必须对稳定层流状态有深刻的理解。本练习旨在通过直接从纳维-斯托克斯方程（Navier–Stokes equations）出发，推导经典的哈根-泊肃叶（Hagen-Poiseuille）流动，来巩固您的基本功 。计算壁面剪切应力（$\\tau_w$）不仅是一项重要的流体力学计算，更因为它代表了血管内皮细胞所感受到的关键力学信号，这在生物力学中具有深远意义。",
            "id": "4185282",
            "problem": "在生物力学和动脉血流中层流-湍流转变开始的背景下，考虑一种不可压缩牛顿流体，用于模拟在足够高剪切率下的血液，该流体在半径为 $R$ 的刚性、笔直的圆管中稳定流动。该流动是轴对称且完全发展的，因此轴向速度 $u(r)$ 仅取决于径向坐标 $r$，而径向和方位角速度分量为零。从不可压缩 Navier–Stokes 方程和壁面上的无滑移边界条件出发，推导壁面剪切应力 $\\tau_{w}$ 关于体积流量 $Q$、管半径 $R$ 和动力黏度 $\\mu$ 的表达式。不要预先假设任何特定的速度剖面；应在所述条件下从控制方程中推导出来。获得表达式后，对 $Q=80\\,\\mathrm{mL\\,s^{-1}}$，$R=1.25\\,\\mathrm{cm}$ 和 $\\mu=3.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$ 的情况进行 $\\tau_{w}$ 的数值计算。最终值以 $\\mathrm{Pa}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导圆管中稳态、完全发展的不可压缩牛顿流动的壁面剪切应力 $\\tau_w$，并随后进行数值计算。推导必须从不可压缩 Navier–Stokes 方程开始。\n\n速度场由 $\\vec{v} = u(r)\\hat{z}$ 给出，这意味着径向速度分量 $u_r=0$ 和方位角速度分量 $u_\\theta=0$。轴向速度 $u_z=u$ 仅是径向坐标 $r$ 的函数。流动是稳态的（$\\frac{\\partial}{\\partial t} = 0$）和轴对称的（$\\frac{\\partial}{\\partial \\theta} = 0$）。\n\n我们从柱坐标系 $(r, \\theta, z)$ 下的不可压缩 Navier–Stokes 方程开始。\n\n连续性方程为：\n$$ \\frac{1}{r}\\frac{\\partial(r u_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial u_\\theta}{\\partial \\theta} + \\frac{\\partial u_z}{\\partial z} = 0 $$\n代入 $u_r=0$ 和 $u_\\theta=0$，我们得到 $\\frac{\\partial u_z}{\\partial z} = 0$。由于 $u_z=u(r)$，这与完全发展流的条件一致，即速度剖面沿轴向不发生变化。\n\n动量方程简化如下：\nr-动量方程简化为：\n$$ 0 = -\\frac{\\partial p}{\\partial r} $$\n这意味着压力 $p$ 不是径向坐标 $r$ 的函数。\n\n$\\theta$-动量方程简化为：\n$$ 0 = -\\frac{1}{r}\\frac{\\partial p}{\\partial \\theta} $$\n这意味着 $\\frac{\\partial p}{\\partial \\theta} = 0$，这与流动是轴对称的条件一致。\n从 r- 和 $\\theta$-动量方程，我们得出结论，压力 $p$ 只能是轴向坐标 $z$ 的函数，即 $p=p(z)$。\n\nz-动量方程为：\n$$ \\rho\\left(\\frac{\\partial u_z}{\\partial t} + u_r\\frac{\\partial u_z}{\\partial r} + \\frac{u_\\theta}{r}\\frac{\\partial u_z}{\\partial \\theta} + u_z\\frac{\\partial u_z}{\\partial z}\\right) = -\\frac{\\partial p}{\\partial z} + \\mu\\left[\\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial u_z}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 u_z}{\\partial \\theta^2} + \\frac{\\partial^2 u_z}{\\partial z^2}\\right] $$\n应用所述条件（$\\frac{\\partial}{\\partial t}=0$, $u_r=0$, $u_\\theta=0$, $\\frac{\\partial}{\\partial \\theta}=0$, $\\frac{\\partial u_z}{\\partial z}=0$），该方程显著简化为：\n$$ 0 = -\\frac{dp}{dz} + \\frac{\\mu}{r}\\frac{d}{dr}\\left(r\\frac{du}{dr}\\right) $$\n这里，由于 $p$ 仅依赖于 $z$ 而 $u$ 仅依赖于 $r$，我们已将偏导数替换为全导数。\n\n重排方程，我们得到：\n$$ \\frac{1}{r}\\frac{d}{dr}\\left(r\\frac{du}{dr}\\right) = \\frac{1}{\\mu}\\frac{dp}{dz} $$\n方程左边仅是 $r$ 的函数，而右边仅是 $z$ 的函数。这只有在两边都等于一个常数时才可能成立。我们称这个常数为 $K$。压力梯度 $\\frac{dp}{dz}$ 必须是一个常数。由于流动是由压降驱动的，$\\frac{dp}{dz}$ 是一个负的常数。\n$$ \\frac{d}{dr}\\left(r\\frac{du}{dr}\\right) = \\frac{1}{\\mu}\\frac{dp}{dz} r $$\n对 $r$ 积分：\n$$ r\\frac{du}{dr} = \\frac{1}{2\\mu}\\frac{dp}{dz} r^2 + C_1 $$\n两边除以 $r$：\n$$ \\frac{du}{dr} = \\frac{1}{2\\mu}\\frac{dp}{dz} r + \\frac{C_1}{r} $$\n为了使速度梯度（以及剪切应力）在中心线（$r=0$）处为有限值，积分常数 $C_1$ 必须为零。\n$$ \\frac{du}{dr} = \\frac{1}{2\\mu}\\frac{dp}{dz} r $$\n再次对 $r$ 积分：\n$$ u(r) = \\frac{1}{4\\mu}\\frac{dp}{dz} r^2 + C_2 $$\n我们在管壁处应用无滑移边界条件，$u(R)=0$：\n$$ 0 = \\frac{1}{4\\mu}\\frac{dp}{dz} R^2 + C_2 \\implies C_2 = -\\frac{1}{4\\mu}\\frac{dp}{dz} R^2 $$\n将 $C_2$ 代回速度剖面表达式：\n$$ u(r) = \\frac{1}{4\\mu}\\frac{dp}{dz} (r^2 - R^2) = -\\frac{1}{4\\mu}\\frac{dp}{dz} (R^2 - r^2) $$\n这就是 Hagen-Poiseuille 流特有的抛物线形速度剖面。\n\n接下来，我们将此剖面与体积流量 $Q$ 联系起来。\n$$ Q = \\int_{A} u(r) dA = \\int_0^R u(r) (2\\pi r) dr $$\n$$ Q = \\int_0^R \\frac{1}{4\\mu}\\left(-\\frac{dp}{dz}\\right)(R^2 - r^2) (2\\pi r) dr $$\n$$ Q = \\frac{2\\pi}{4\\mu}\\left(-\\frac{dp}{dz}\\right) \\int_0^R (R^2 r - r^3) dr = \\frac{\\pi}{2\\mu}\\left(-\\frac{dp}{dz}\\right) \\left[\\frac{R^2 r^2}{2} - \\frac{r^4}{4}\\right]_0^R $$\n$$ Q = \\frac{\\pi}{2\\mu}\\left(-\\frac{dp}{dz}\\right) \\left(\\frac{R^4}{2} - \\frac{R^4}{4}\\right) = \\frac{\\pi R^4}{8\\mu}\\left(-\\frac{dp}{dz}\\right) $$\n由此，我们可以用流量 $Q$ 表示压力梯度：\n$$ -\\frac{dp}{dz} = \\frac{8\\mu Q}{\\pi R^4} $$\n\n现在，我们推导壁面剪切应力 $\\tau_w$ 的表达式。对于此流动中的牛顿流体，剪切应力为 $\\tau_{rz} = \\mu \\frac{du}{dr}$。壁面剪切应力是在壁面 $r=R$ 处计算的该应力的大小。\n$$ \\tau_w = |\\tau_{rz}|_{r=R} = |\\mu \\left(\\frac{du}{dr}\\right)_{r=R}| $$\n我们之前已求得速度梯度：\n$$ \\frac{du}{dr} = \\frac{1}{2\\mu}\\frac{dp}{dz} r $$\n在 $r=R$ 处计算：\n$$ \\left(\\frac{du}{dr}\\right)_{r=R} = \\frac{R}{2\\mu}\\frac{dp}{dz} $$\n因此，壁面处的剪切应力为：\n$$ (\\tau_{rz})_{r=R} = \\mu \\left(\\frac{R}{2\\mu}\\frac{dp}{dz}\\right) = \\frac{R}{2}\\frac{dp}{dz} $$\n壁面剪切应力 $\\tau_w$ 是其大小：\n$$ \\tau_w = \\left|\\frac{R}{2}\\frac{dp}{dz}\\right| = \\frac{R}{2}\\left(-\\frac{dp}{dz}\\right) $$\n最后，我们代入用 $Q$ 表示的 $\\left(-\\frac{dp}{dz}\\right)$ 的表达式：\n$$ \\tau_w = \\frac{R}{2} \\left(\\frac{8\\mu Q}{\\pi R^4}\\right) = \\frac{4\\mu Q}{\\pi R^3} $$\n这就是所求的壁面剪切应力的解析表达式。\n\n现在我们进行数值计算。给定值为：\n$Q=80\\,\\mathrm{mL\\,s^{-1}}$\n$R=1.25\\,\\mathrm{cm}$\n$\\mu=3.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$\n\n首先，我们将所有值转换为 SI 基本单位：\n$Q = 80\\,\\mathrm{mL\\,s^{-1}} = 80 \\times 10^{-6}\\,\\mathrm{m^3\\,s^{-1}}$\n$R = 1.25\\,\\mathrm{cm} = 1.25 \\times 10^{-2}\\,\\mathrm{m}$\n$\\mu = 3.5 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$\n\n我们将这些值代入推导出的 $\\tau_w$ 表达式中：\n$$ \\tau_w = \\frac{4 (3.5 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}) (80 \\times 10^{-6}\\,\\mathrm{m^3\\,s^{-1}})}{\\pi (1.25 \\times 10^{-2}\\,\\mathrm{m})^3} $$\n$$ \\tau_w = \\frac{4 \\times 3.5 \\times 80 \\times 10^{-9}}{\\pi \\times (1.25)^3 \\times 10^{-6}} \\,\\mathrm{Pa} $$\n$$ \\tau_w = \\frac{1120 \\times 10^{-9}}{\\pi \\times 1.953125 \\times 10^{-6}} \\,\\mathrm{Pa} $$\n$$ \\tau_w = \\frac{1.12 \\times 10^{-6}}{6.1359218... \\times 10^{-6}} \\,\\mathrm{Pa} $$\n$$ \\tau_w \\approx 0.1825443... \\,\\mathrm{Pa} $$\n按要求将结果四舍五入到四位有效数字：\n$$ \\tau_w \\approx 0.1825\\,\\mathrm{Pa} $$",
            "answer": "$$\n\\boxed{0.1825}\n$$"
        },
        {
            "introduction": "在掌握了层流的精确推导之后，我们可以转向更高层次的标度分析，以获得对流动行为的直观理解。本练习将引导您探究为何在人体最微小的血管（如毛细血管）中，湍流通常不是一个需要担心的问题 。通过对控制方程进行无量纲化，我们将揭示一个关键的无量纲参数——雷诺数（$Re$），它决定了破坏流动稳定性的惯性力与维持稳定性的黏性力之间的平衡。",
            "id": "4185310",
            "problem": "一根直径为 $D=7\\,\\mu\\mathrm{m}$ 的直、刚性、圆形微血管中，血液以 $U=1\\,\\mathrm{mm/s}$ 的特征速度进行稳态、充分发展、轴对称的流动。将血液视为不可压缩的牛顿流体，其恒定动力黏度为 $\\mu=3.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$，密度为 $\\rho=1060\\,\\mathrm{kg/m^3}$。从不可压缩的纳维-斯托克斯方程出发，使用基于 $D$ 和 $U$ 的特征尺度，且不引用任何预先制定的无量纲数群，进行无量纲化，以确定此构型中惯性效应与黏性效应的无量纲比值。然后，根据给定的血管和性质评估该比值。最后，利用经过标度化的方程，构建一个关于此类微血管中是否会产生湍流的机理学论证。\n\n将该无量纲比值报告为单个无量纲数，并四舍五入至三位有效数字。最终报告值不需要单位。",
            "solution": "该问题要求对流体流动的控制方程进行无量纲化，以确定惯性效应与黏性效应的比值，根据给定参数评估该比值，并就湍流出现的可能性进行机理学论证。\n\n出发点是密度为常数 $\\rho$、动力黏度为常数 $\\mu$ 的流体的不可压缩纳维-斯托克斯方程：\n$$\n\\rho \\left( \\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{v} \\right) = -\\nabla p + \\mu \\nabla^2 \\mathbf{v}\n$$\n其中 $\\mathbf{v}$ 是速度矢量，$t$ 是时间，$p$ 是压力，$\\nabla$ 是 del 算子。与之相伴的是不可压缩流体的连续性方程：\n$$\n\\nabla \\cdot \\mathbf{v} = 0\n$$\n\n为了对这些方程进行无量纲化，我们引入无量纲变量，用上标 `*` 表示。问题指定特征长度尺度为血管直径 $D$，特征速度尺度为速度 $U$。我们定义以下无量纲变量：\n-   位置矢量：$\\mathbf{x}^* = \\frac{\\mathbf{x}}{D}$\n-   速度矢量：$\\mathbf{v}^* = \\frac{\\mathbf{v}}{U}$\n特征时间尺度由长度和速度尺度导出，表示流体质点行进特征长度所需的时间：$t_{char} = \\frac{D}{U}$。\n-   时间：$t^* = \\frac{t}{D/U} = \\frac{tU}{D}$\n特征压力尺度选自动压 $\\rho U^2$。\n-   压力：$p^* = \\frac{p}{\\rho U^2}$（假设参考压力为零）\n\n接下来，我们用这些无量纲变量来表示纳维-斯托克斯方程中的导数：\n-   时间导数：$\\frac{\\partial}{\\partial t} = \\frac{\\partial t^*}{\\partial t} \\frac{\\partial}{\\partial t^*} = \\frac{U}{D} \\frac{\\partial}{\\partial t^*}$\n-   梯度算子：$\\nabla = \\frac{1}{D} \\nabla^*$，其中 $\\nabla^*$ 是相对于 $\\mathbf{x}^*$ 的梯度。\n-   拉普拉斯算子：$\\nabla^2 = \\frac{1}{D^2} (\\nabla^*)^2$\n\n将这些代入矢量动量方程：\n$$\n\\rho \\left( \\frac{U}{D} \\frac{\\partial (U \\mathbf{v}^*)}{\\partial t^*} + (U \\mathbf{v}^* \\cdot \\frac{1}{D} \\nabla^*) (U \\mathbf{v}^*) \\right) = - \\frac{1}{D} \\nabla^* (\\rho U^2 p^*) + \\mu \\frac{1}{D^2} (\\nabla^*)^2 (U \\mathbf{v}^*)\n$$\n我们可以将常数尺度从导数中因子分解出来：\n$$\n\\rho \\frac{U^2}{D} \\left( \\frac{\\partial \\mathbf{v}^*}{\\partial t^*} + (\\mathbf{v}^* \\cdot \\nabla^*) \\mathbf{v}^* \\right) = - \\frac{\\rho U^2}{D} \\nabla^* p^* + \\frac{\\mu U}{D^2} (\\nabla^*)^2 \\mathbf{v}^*\n$$\n项 $\\rho \\frac{U^2}{D} (\\mathbf{v}^* \\cdot \\nabla^*) \\mathbf{v}^*$ 代表单位体积的惯性力。项 $\\frac{\\mu U}{D^2} (\\nabla^*)^2 \\mathbf{v}^*$ 代表单位体积的黏性力。\n\n为得到方程的无量纲形式，我们将所有项除以惯性项的系数 $\\frac{\\rho U^2}{D}$：\n$$\n\\frac{\\partial \\mathbf{v}^*}{\\partial t^*} + (\\mathbf{v}^* \\cdot \\nabla^*) \\mathbf{v}^* = - \\nabla^* p^* + \\left( \\frac{\\mu U / D^2}{\\rho U^2 / D} \\right) (\\nabla^*)^2 \\mathbf{v}^*\n$$\n作为黏性项系数出现的无量纲数群可简化为：\n$$\n\\frac{\\mu U / D^2}{\\rho U^2 / D} = \\frac{\\mu U}{D^2} \\frac{D}{\\rho U^2} = \\frac{\\mu}{\\rho U D}\n$$\n惯性效应与黏性效应的无量纲比值是该系数的倒数。如果我们考虑特征惯性力（其尺度为 $\\rho U^2 / D$）与特征黏性力（其尺度为 $\\mu U / D^2$）的比值，我们得到：\n$$\n\\frac{\\text{惯性力}}{\\text{黏性力}} \\sim \\frac{\\rho U^2 / D}{\\mu U / D^2} = \\frac{\\rho U D}{\\mu}\n$$\n这就是所求的无量纲比值。这个数群被称为雷诺数，$Re$。\n\n现在我们根据给定的血管和性质评估这个比值。\n给定值为：\n-   密度：$\\rho = 1060\\,\\mathrm{kg/m^3}$\n-   特征速度：$U = 1\\,\\mathrm{mm/s} = 1 \\times 10^{-3}\\,\\mathrm{m/s}$\n-   血管直径：$D = 7\\,\\mu\\mathrm{m} = 7 \\times 10^{-6}\\,\\mathrm{m}$\n-   动力黏度：$\\mu = 3.5 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s} = 3.5 \\times 10^{-3}\\,\\mathrm{kg/(m\\cdot s)}$\n\n该无量纲比值计算如下：\n$$\nRe = \\frac{\\rho U D}{\\mu} = \\frac{(1060\\,\\mathrm{kg/m^3}) (1 \\times 10^{-3}\\,\\mathrm{m/s}) (7 \\times 10^{-6}\\,\\mathrm{m})}{3.5 \\times 10^{-3}\\,\\mathrm{kg/(m\\cdot s)}}\n$$\n$$\nRe = \\frac{1060 \\times (1 \\times 10^{-3}) \\times (7 \\times 10^{-6})}{3.5 \\times 10^{-3}} = \\frac{1060 \\times 7 \\times 10^{-6}}{3.5} = 1060 \\times 2 \\times 10^{-6} = 2120 \\times 10^{-6}\n$$\n$$\nRe = 2.12 \\times 10^{-3}\n$$\n四舍五入到三位有效数字，该值为 $2.12 \\times 10^{-3}$。\n\n最后，我们构建一个关于湍流是否会产生的机理学论证。无量纲纳维-斯托克斯方程为：\n$$\n\\frac{\\partial \\mathbf{v}^*}{\\partial t^*} + \\underbrace{(\\mathbf{v}^* \\cdot \\nabla^*) \\mathbf{v}^*}_{\\text{惯性项}} = - \\nabla^* p^* + \\underbrace{\\frac{1}{Re} (\\nabla^*)^2 \\mathbf{v}^*}_{\\text{黏性项}}\n$$\n湍流是一种以混沌、非定常和涡旋运动为特征的流态。它由非线性惯性项 $(\\mathbf{v}^* \\cdot \\nabla^*) \\mathbf{v}^*$ 维持，该项可以放大流场中的微小扰动。相比之下，黏性项 $\\frac{1}{Re} (\\nabla^*)^2 \\mathbf{v}^*$ 的作用是耗散动能并抑制此类扰动。湍流的发生取决于这两种效应之间的竞争。\n\n在本问题中，计算出的雷诺数为 $Re = 2.12 \\times 10^{-3}$。这个值非常小（$Re \\ll 1$）。因此，黏性项的系数 $\\frac{1}{Re}$ 非常大：\n$$\n\\frac{1}{Re} = \\frac{1}{2.12 \\times 10^{-3}} \\approx 472\n$$\n标度化后的方程变为：\n$$\n\\frac{\\partial \\mathbf{v}^*}{\\partial t^*} + (\\mathbf{v}^* \\cdot \\nabla^*) \\mathbf{v}^* \\approx - \\nabla^* p^* + 472 \\cdot (\\nabla^*)^2 \\mathbf{v}^*\n$$\n该方程表明，黏性项比惯性项大几个数量级（假设所有无量纲导数的量级均为 $1$）。这表明黏性力相对于惯性力占有绝对主导地位。\n\n从机理上看，这意味着任何可能出现在流动中的新生不稳定性或扰动都会立即被黏性阻尼强力抑制。惯性效应太弱，无法在黏性阻力作用下放大扰动。流动被“困”在一种光滑、有序且可预测的状态中。要在管道中产生湍流，惯性力必须足够大以克服黏性阻尼，这通常发生在临界雷诺数约为 $Re_{crit} \\approx 2300$ 时。计算出的 $Re = 0.00212$ 值比该阈值低约六个数量级。\n\n因此，由于黏性效应的绝对主导地位，湍流自我维持所需的机制是不存在的。该微血管中的流动处于层流区的深处，湍流无法产生。",
            "answer": "$$\\boxed{2.12 \\times 10^{-3}}$$"
        },
        {
            "introduction": "理解了稳定的层流状态和决定其稳定性的参数后，我们将目光投向过渡过程本身的复杂动力学。本练习采用一种现代计算方法，来研究被称为“湍流泡芙”（turbulent puff）的过渡流动结构的行为 。您将构建一个模型，该模型结合了确定性的流体运动（平流）和描述“泡芙”寿命的随机过程，从而深入探究生理性脉动如何影响流动稳定性。",
            "id": "4185330",
            "problem": "一个直径为 $D$ 的圆形动脉段承载着一种剪切稀化流体，在高剪切率条件下可近似为牛顿流体，这是过渡状态的典型特征。在雷诺数 $Re=1900$ 的层流-湍流转捩附近，观察到一个局部湍流结构（“湍流泡”）。假设以下有物理依据的简化：动脉表现为一根笔直、刚性、轴对称的管道；血液密度恒定；由于高剪切率近似，动力黏度恒定；湍流泡是一个有限长度的亚稳态结构，在平均流作用下作为一个相干实体平流。为分析湍流泡的时空演化，从以下基本原理入手：雷诺数，定义为 $Re=\\rho U D / \\mu$，其中 $\\rho$ 是流体密度，$U$ 是平均轴向速度，$D$ 是管道直径，$\\mu$ 是动力黏度；以及平流的运动学表示 $dx/dt=v(t)$，其中 $x$ 是轴向位置，$v(t)$ 是湍流泡的瞬时漂移速度。为考虑临床相关性，考虑由 $U(t)=U_0\\left(1+A\\sin(2\\pi f t)\\right)$ 给出的平均速度的脉动强迫，其中 $U_0$ 是基准平均速度，$A \\in [0,1)$ 是无量纲振幅，$f$ 是频率（单位为 $\\mathrm{Hz}$），正弦函数的参数以弧度为单位。将湍流泡建模为以局部平均流的一部分速度平流，$v(t)=\\gamma U(t)$，其中 $0<\\gamma<1$ 是一个与过渡管流观测结果一致的恒定平流因子。过渡态湍流泡是亚稳态的：经验证据表明其寿命呈指数分布，其风险率取决于瞬时雷诺数。将这种依赖关系表示为时变风险 $\\lambda(t)=\\lambda_{\\mathrm{ref}} \\exp\\!\\left(-\\beta\\left(Re(t)-Re_{\\mathrm{ref}}\\right)\\right)$，其中 $Re(t)=\\rho U(t) D/\\mu$，$\\lambda_{\\mathrm{ref}}$ 是在 $Re_{\\mathrm{ref}}$ 处的参考风险，$\\beta>0$ 控制对 $Re$ 的敏感度。在此风险下，时间窗口 $[0,T]$ 内的生存概率为 $P_{\\mathrm{surv}}=\\exp\\!\\left(-\\int_0^T \\lambda(t)\\,dt\\right)$。在没有脉动的情况下，寿命分布是指数分布，其均值为 $1/\\lambda_0$，方差为 $1/\\lambda_0^2$，其中 $\\lambda_0=\\lambda_{\\mathrm{ref}}\\exp\\!\\left(-\\beta\\left(Re_0-Re_{\\mathrm{ref}}\\right)\\right)$ 且 $Re_0=\\rho U_0 D/\\mu$。\n\n您的程序必须实现这个基于原理的模型，以计算指定测试用例的以下数值：\n- 在持续时间为 $T$ 的窗口内湍流泡的平均漂移速度，定义为 $\\bar{v}=\\frac{1}{T}\\int_0^T v(t)\\,dt$，单位为 $\\mathrm{m/s}$。\n- 在 $Re_0$ 下的基准寿命统计数据（无脉动）：平均寿命 $1/\\lambda_0$（单位为 $\\mathrm{s}$）和寿命方差 $1/\\lambda_0^2$（单位为 $\\mathrm{s}^2$）。\n- 在指定脉动强迫下，时间窗口 $[0,T]$ 内的生存概率 $P_{\\mathrm{surv}}$。\n\n对所有测试用例使用以下常量：$\\rho=1060\\,\\mathrm{kg/m^3}$ 和 $\\mu=3.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$。直径为 $D=0.01\\,\\mathrm{m}$。基准雷诺数为 $Re_0=1900$。平流因子为 $\\gamma=0.95$。风险参数为 $\\lambda_{\\mathrm{ref}}=0.2\\,\\mathrm{s^{-1}}$，$Re_{\\mathrm{ref}}=1800$，以及 $\\beta=10^{-2}\\,\\mathrm{(Re)^{-1}}$。对于每个测试用例，根据 $Re_0=\\rho U_0 D/\\mu$ 确定 $U_0$，然后使用指定的 $A, f, 和 T$。\n\n测试套件（每个元组为 $(A,f,T)$）：\n1. $(0.0,\\,1.0,\\,5.0)$ 表示在 $5\\,\\mathrm{s}$ 内的非脉动基准情况。\n2. $(0.3,\\,1.0,\\,5.0)$ 表示在 $5\\,\\mathrm{s}$ 内的中等振幅、生理频率情况。\n3. $(0.3,\\,3.0,\\,5.0)$ 表示在 $5\\,\\mathrm{s}$ 内的中等振幅、更高频率情况。\n4. $(0.9,\\,1.0,\\,5.0)$ 表示在 $5\\,\\mathrm{s}$ 内无流动反转的近极限振幅情况。\n\n算法要求：\n- 根据 $Re_0$ 计算 $U_0$，然后通过在 $[0,T]$ 上进行数值时间积分来计算 $v(t)=\\gamma U(t)$ 和 $\\bar{v}$。\n- 使用在 $Re_0$ 处计算的 $\\lambda_0$ 来计算基准寿命统计数据。\n- 通过足够精细的时间离散化，在 $[0,T]$ 上对 $\\lambda(t)$ 进行数值积分，并应用生存公式来计算 $P_{\\mathrm{surv}}$。\n- 使用正弦函数，角度以弧度为单位。\n\n输出要求：\n- 对于每个测试用例，输出一个包含四个浮点数的列表：$[\\bar{v},\\,1/\\lambda_0,\\,1/\\lambda_0^2,\\,P_{\\mathrm{surv}}]$。\n- $\\bar{v}$ 以 $\\mathrm{m/s}$ 为单位，$1/\\lambda_0$ 以 $\\mathrm{s}$ 为单位，$1/\\lambda_0^2$ 以 $\\mathrm{s}^2$ 为单位，$P_{\\mathrm{surv}}$ 表示为 0 到 1 之间的无量纲小数。\n- 将每个浮点数四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表的每个元素是对应一个测试用例的列表，例如 $[[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$。",
            "solution": "该问题要求在一个简化的动脉脉动血流模型中，分析湍流泡的平流和存活情况。该模型基于流体动力学和统计寿命分析的基本原理。我们将首先验证问题的有效性，然后推导必要的方程，最后概述计算方法，以求解每个测试用例所需的量。\n\n该问题被认为是有效的，因为它在科学上基于过渡管流和生存分析的原理，问题设定良好且提供了所有必要信息，并以客观、正式的语言表述。所述参数和假设对于所描述的生物学背景是物理上合理的简化。\n\n我们首先陈述控制方程和常量。\n流体密度为 $\\rho=1060\\,\\mathrm{kg/m^3}$，动力黏度为 $\\mu=3.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$。动脉直径为 $D=0.01\\,\\mathrm{m}$。基准雷诺数为 $Re_0=1900$。平流因子为 $\\gamma=0.95$。风险模型参数为 $\\lambda_{\\mathrm{ref}}=0.2\\,\\mathrm{s^{-1}}$，$Re_{\\mathrm{ref}}=1800$，以及 $\\beta=10^{-2}\\,\\mathrm{(Re)^{-1}}$。\n\n随时间变化的平均轴向速度由脉动强迫给出：\n$$\nU(t) = U_0\\left(1 + A\\sin(2\\pi f t)\\right)\n$$\n其中 $U_0$ 是基准平均速度，$A$ 是脉动振幅，$f$ 是频率。湍流泡以速度 $v(t) = \\gamma U(t)$ 平流。\n\n瞬时雷诺数是时间的函数：\n$$\nRe(t) = \\frac{\\rho U(t) D}{\\mu} = \\frac{\\rho U_0 D}{\\mu} \\left(1 + A\\sin(2\\pi f t)\\right) = Re_0 \\left(1 + A\\sin(2\\pi f t)\\right)\n$$\n\n湍流泡的寿命由一个时变风险率 $\\lambda(t)$ 控制：\n$$\n\\lambda(t) = \\lambda_{\\mathrm{ref}} \\exp\\!\\left(-\\beta\\left(Re(t) - Re_{\\mathrm{ref}}\\right)\\right)\n$$\n\n在时间区间 $[0, T]$ 内的生存概率为：\n$$\nP_{\\mathrm{surv}} = \\exp\\!\\left(-\\int_0^T \\lambda(t)\\,dt\\right)\n$$\n\n首先，我们计算所有测试用例中都保持不变的基准参数。基准平均速度 $U_0$ 由给定的基准雷诺数 $Re_0$ 确定：\n$$\nU_0 = \\frac{Re_0 \\mu}{\\rho D} = \\frac{1900 \\times (3.5 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s})}{(1060\\,\\mathrm{kg/m^3}) \\times (0.01\\,\\mathrm{m})} = \\frac{6.65}{10.6}\\,\\mathrm{m/s} \\approx 0.627358\\,\\mathrm{m/s}\n$$\n\n基准风险率 $\\lambda_0$ 对应于恒定的雷诺数 $Re_0$：\n$$\n\\lambda_0 = \\lambda_{\\mathrm{ref}}\\exp(-\\beta(Re_0 - Re_{\\mathrm{ref}})) = 0.2 \\exp(-10^{-2}(1900 - 1800)) = 0.2 \\exp(-1)\\,\\mathrm{s^{-1}} \\approx 0.073576\\,\\mathrm{s^{-1}}\n$$\n对于一个具有恒定风险率 $\\lambda_0$ 的过程，其寿命遵循指数分布。所需的基准寿命统计数据是平均寿命 $1/\\lambda_0$ 和方差 $1/\\lambda_0^2$：\n$$\n\\text{平均寿命} = \\frac{1}{\\lambda_0} = \\frac{1}{0.2 e^{-1}}\\,\\mathrm{s} = 5e\\,\\mathrm{s} \\approx 13.591409\\,\\mathrm{s}\n$$\n$$\n\\text{寿命方差} = \\frac{1}{\\lambda_0^2} = (5e)^2\\,\\mathrm{s^2} = 25e^2\\,\\mathrm{s^2} \\approx 184.726401\\,\\mathrm{s^2}\n$$\n这两个值对于所有测试用例都将是相同的。\n\n接下来，我们确定在区间 $[0, T]$ 内湍流泡的平均漂移速度 $\\bar{v}$：\n$$\n\\bar{v} = \\frac{1}{T}\\int_0^T v(t)\\,dt = \\frac{1}{T}\\int_0^T \\gamma U_0\\left(1 + A\\sin(2\\pi f t)\\right)\\,dt\n$$\n$$\n\\bar{v} = \\frac{\\gamma U_0}{T} \\left[ \\int_0^T 1\\,dt + A\\int_0^T \\sin(2\\pi f t)\\,dt \\right] = \\frac{\\gamma U_0}{T} \\left[ T + A \\left( -\\frac{\\cos(2\\pi f t)}{2\\pi f} \\right)_0^T \\right]\n$$\n$$\n\\bar{v} = \\gamma U_0 \\left[ 1 - \\frac{A}{2\\pi f T} (\\cos(2\\pi f T) - 1) \\right]\n$$\n对于所有给定的测试用例，持续时间为 $T=5.0\\,\\mathrm{s}$，频率为 $f=1.0\\,\\mathrm{Hz}$ 或 $f=3.0\\,\\mathrm{Hz}$。在所有情况下，$fT$ 都是整数（$5$ 或 $15$）。因此，$2\\pi f T$ 是 $2\\pi$ 的整数倍，这意味着 $\\cos(2\\pi f T) = \\cos(0) = 1$。因此，项 $(\\cos(2\\pi f T) - 1)$ 为零。这极大地简化了 $\\bar{v}$ 的表达式：\n$$\n\\bar{v} = \\gamma U_0 = 0.95 \\times \\frac{6.65}{10.6}\\,\\mathrm{m/s} \\approx 0.595991\\,\\mathrm{m/s}\n$$\n对于所有指定的测试用例，该平均速度是恒定的。\n\n最后，我们来处理生存概率 $P_{\\mathrm{surv}}$。此计算的核心是风险率的时间积分，$I_{\\lambda} = \\int_0^T \\lambda(t)\\,dt$。代入 $\\lambda(t)$ 和 $Re(t)$ 的表达式：\n$$\nI_{\\lambda} = \\int_0^T \\lambda_{\\mathrm{ref}} \\exp\\left(-\\beta\\left[Re_0(1 + A\\sin(2\\pi f t)) - Re_{\\mathrm{ref}}\\right]\\right) dt\n$$\n我们可以分离指数并提出常数部分：\n$$\nI_{\\lambda} = \\int_0^T \\lambda_{\\mathrm{ref}} \\exp\\left(-\\beta(Re_0 - Re_{\\mathrm{ref}})\\right) \\exp\\left(-\\beta Re_0 A \\sin(2\\pi f t)\\right) dt\n$$\n认识到表达式的第一部分是 $\\lambda_0$：\n$$\nI_{\\lambda} = \\lambda_0 \\int_0^T \\exp\\left(-\\beta Re_0 A \\sin(2\\pi f t)\\right) dt\n$$\n这个积分没有简单的解析解，必须按照问题陈述的建议进行数值计算。我们将使用高精度的数值求积方法来完成此任务。\n\n每个测试用例 $(A, f, T)$ 的计算过程如下：\n1.  使用预先计算好的 $\\bar{v} \\approx 0.595991\\,\\mathrm{m/s}$、$1/\\lambda_0 \\approx 13.591409\\,\\mathrm{s}$ 和 $1/\\lambda_0^2 \\approx 184.726401\\,\\mathrm{s^2}$ 的值。\n2.  为风险积分定义被积函数：$g(t) = \\exp(-\\beta Re_0 A \\sin(2\\pi f t))$。\n3.  数值计算积分 $I_g = \\int_0^T g(t) dt$。\n4.  计算完整的风险积分 $I_{\\lambda} = \\lambda_0 I_g$。\n5.  计算生存概率 $P_{\\mathrm{surv}} = \\exp(-I_{\\lambda})$。\n6.  对于 $A=0$ 的特殊情况，被积函数为 $1$，因此 $I_{\\lambda} = \\lambda_0 T$ 且 $P_{\\mathrm{surv}} = \\exp(-\\lambda_0 T)$。\n7.  组合这四个值 $[\\bar{v}, 1/\\lambda_0, 1/\\lambda_0^2, P_{\\mathrm{surv}}]$，将每个值四舍五入到六位小数，并按要求格式化。\n\n这种结构化方法基于所提供的物理模型和数学定义，能够稳健、准确地计算所需量。实现将使用指定的 Python 库来执行数值积分。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes advection and survival statistics for a turbulent puff\n    in pulsatile arterial flow.\n    \"\"\"\n    # Physical and model constants\n    rho = 1060.0  # kg/m^3\n    mu = 3.5e-3   # Pa.s\n    D = 0.01      # m\n    Re0 = 1900.0  # Baseline Reynolds number (dimensionless)\n    gamma = 0.95  # Advection factor (dimensionless)\n    lambda_ref = 0.2  # s^-1\n    Re_ref = 1800.0 # (dimensionless)\n    beta = 1e-2     # (Re)^-1\n\n    # Test cases: tuples of (A, f, T)\n    # A: dimensionless amplitude\n    # f: frequency in Hz\n    # T: time duration in s\n    test_cases = [\n        (0.0, 1.0, 5.0),\n        (0.3, 1.0, 5.0),\n        (0.3, 3.0, 5.0),\n        (0.9, 1.0, 5.0),\n    ]\n\n    # --- Step 1: Calculate baseline parameters common to all cases ---\n\n    # Baseline mean velocity U0 from Re0\n    U0 = (Re0 * mu) / (rho * D)\n\n    # Baseline hazard rate lambda_0\n    lambda_0 = lambda_ref * np.exp(-beta * (Re0 - Re_ref))\n\n    # Baseline mean lifetime and variance\n    mean_lifetime = 1.0 / lambda_0\n    var_lifetime = 1.0 / (lambda_0**2)\n\n    # Average puff speed v_bar.\n    # As derived in the solution, for f*T being an integer, the integral of\n    # the sine term is zero, so v_bar is constant for all given test cases.\n    v_bar = gamma * U0\n\n    # --- Step 2: Process each test case ---\n\n    results = []\n    for A, f, T in test_cases:\n        # Define the integrand for the survival probability calculation\n        # I_lambda = lambda_0 * integral(exp(-beta * Re0 * A * sin(2*pi*f*t)) dt)\n        # We need to integrate the exponential part.\n        \n        # Coefficient in the exponent of the time-dependent part\n        C = beta * Re0 * A\n\n        if A == 0.0:\n            # For the non-pulsatile case, the integral is trivial\n            integral_val = T\n        else:\n            # Define the function to be integrated\n            def integrand(t, C_arg, f_arg):\n                return np.exp(-C_arg * np.sin(2 * np.pi * f_arg * t))\n            \n            # Perform numerical integration using scipy.integrate.quad\n            integral_val, _ = quad(integrand, 0, T, args=(C, f))\n\n        # Calculate the total hazard integral and the survival probability\n        I_lambda = lambda_0 * integral_val\n        p_surv = np.exp(-I_lambda)\n\n        # Append the formatted results for the current case\n        # Rounding to 6 decimal places as required for formatting\n        current_result = [\n            round(v_bar, 6),\n            round(mean_lifetime, 6),\n            round(var_lifetime, 6),\n            round(p_surv, 6)\n        ]\n        results.append(current_result)\n\n    # --- Step 3: Format and print the final output ---\n\n    # Manually format the string to avoid spaces which str(list) would add\n    result_strings = []\n    for res in results:\n        # res is a list of 4 floats, e.g., [0.595991, 13.591409, 184.726401, 0.69221]\n        # Format each float to 6 decimal places\n        formatted_nums = [f\"{num:.6f}\" for num in res]\n        result_strings.append(f\"[{','.join(formatted_nums)}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n\n```"
        }
    ]
}