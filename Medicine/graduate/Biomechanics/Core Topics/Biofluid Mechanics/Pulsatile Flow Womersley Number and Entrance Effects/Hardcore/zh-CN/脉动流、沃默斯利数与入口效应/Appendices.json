{
    "hands_on_practices": [
        {
            "introduction": "经典的 Womersley 解为充分发展的脉动流提供了数学描述。为了真正掌握其内涵，我们必须超越速度剖面本身，分析其派生的物理量。本练习要求您计算时间平均动能密度，从而更深入地理解血流能量如何在血管半径上分布，以及这种分布如何随 Womersley 数 $\\alpha$ 变化。",
            "id": "4200830",
            "problem": "考虑一个半径为 $R$ 的刚性、笔直、轴对称的圆形容器，其中包含密度为 $\\rho$、动力粘度为 $\\mu$ 的不可压缩牛顿流体。轴向流动是层流且充分发展的（在所关注的轴向位置，入口效应可以忽略不计）。驱动流动的轴向压力梯度随时间呈谐波变化，$-\\partial p/\\partial z = \\Re\\{\\hat{G}\\,\\exp(i\\omega t)\\}$，其中 $\\hat{G}$ 是一个复振幅，$\\omega$ 是角频率。Womersley数定义为 $\\alpha = R\\sqrt{\\omega \\rho/\\mu}$。从在所述假设下的柱坐标系中的不可压缩Navier–Stokes方程出发，推导轴向速度分布的复振幅，然后计算作为径向坐标 $r$ 函数的时间平均动能密度（在一个振荡周期内平均）。请用 $\\rho$、$\\omega$、$R$、$r$、$\\alpha$、$\\hat{G}$ 以及零阶第一类贝塞尔函数 $J_0(\\cdot)$，为时间平均动能密度的径向分布提供一个单一的闭式解析表达式。如果要对该表达式进行数值计算，请将动能密度以焦耳/立方米（Joules per cubic meter）为单位表示。在您的推导中，解释当 $\\alpha \\to 0$ 和 $\\alpha \\to \\infty$ 时径向分布的极限行为，并简要评论在这些极限情况下，忽略入口效应的假设是如何得到辩护或被违反的。最终答案必须是一个单一的闭式解析表达式（不得包含不等式或待解方程）。",
            "solution": "用户希望基于Womersley模型解决一个脉动流问题。\n\n### **问题陈述验证**\n\n*   **第一步：提取已知条件**\n    *   **几何形状与流体：** 一个半径为 $R$ 的刚性、笔直、轴对称的圆形容器。流体是不可压缩的牛顿流体，密度为 $\\rho$，动力粘度为 $\\mu$。\n    *   **流动条件：** 流动是层流且充分发展的。\n    *   **驱动力：** 轴向压力梯度随时间呈谐波变化，由 $-\\frac{\\partial p}{\\partial z} = \\Re\\{\\hat{G}\\,\\exp(i\\omega t)\\}$ 给出，其中 $\\hat{G}$ 是复振幅，$\\omega$ 是角频率，$t$ 是时间。\n    *   **定义：** Womersley数是 $\\alpha = R\\sqrt{\\frac{\\omega \\rho}{\\mu}}$。\n    *   **任务：**\n        1.  推导轴向速度分布的复振幅 $\\hat{v}_z(r)$。\n        2.  计算时间平均动能密度 $\\langle E_k(r) \\rangle$，作为径向坐标 $r$ 的函数。\n        3.  用 $\\rho$、$\\omega$、$R$、$r$、$\\alpha$、$\\hat{G}$ 以及零阶第一类贝塞尔函数 $J_0(\\cdot)$，为 $\\langle E_k(r) \\rangle$ 提供一个单一的闭式解析表达式。\n        4.  分析当 $\\alpha \\to 0$ 和 $\\alpha \\to \\infty$ 时结果的极限行为。\n        5.  评论在这些极限情况下，忽略入口效应的有效性。\n\n*   **第二步：使用提取的已知条件进行验证**\n    *   **科学依据：** 该问题描述了Womersley流，这是流体动力学和生物力学中的一个经典问题。它根本上基于Navier-Stokes方程，并且在科学上是合理的。\n    *   **适定性：** 问题指定了明确的域、流体性质、驱动力和边界条件（轴对称和在 $r=R$ 处的无滑移条件）。这足以获得速度场和派生量的唯一解。\n    *   **客观性：** 问题使用精确、客观、形式化的科学语言陈述。\n    *   **缺陷清单：**\n        1.  **科学上不合理：** 无。该模型是一个标准的、有效的理想化模型。\n        2.  **不可形式化：** 问题可以直接用微分方程形式化。它与主题完全相关。\n        3.  **不完整/矛盾：** 设置是完整且自洽的。“充分发展”的条件是关键，并且在此背景下有明确的定义。\n        4.  **不现实/不可行：** 尽管是一种理想化，该模型在物理上是合理的，并被广泛使用。\n        5.  **不适定：** 问题是适定的。\n        6.  **琐碎/同义反复：** 推导过程不琐碎，需要求解一个贝塞尔型方程和进行复分析。\n        7.  **不可验证：** 解是可以通过数学推导和验证的。\n\n*   **第三步：结论与行动**\n    问题是**有效的**。将提供完整解答。\n\n### **求解推导**\n\n我们从柱坐标系 $(r, \\theta, z)$ 下不可压缩牛顿流体的Navier–Stokes方程开始。给定轴对称（$\\frac{\\partial}{\\partial \\theta} = 0$, $v_\\theta=0$）和充分发展流动（$\\frac{\\partial v_z}{\\partial z} = 0$）的假设，连续性方程 $\\nabla \\cdot \\mathbf{v} = 0$ 意味着 $v_r = 0$。速度场纯粹是轴向的，并且仅是半径和时间的函数，即 $\\mathbf{v} = v_z(r, t) \\mathbf{e}_z$。在这些条件下，动量方程的轴向分量简化为：\n$$ \\rho \\frac{\\partial v_z}{\\partial t} = -\\frac{\\partial p}{\\partial z} + \\mu \\left( \\frac{\\partial^2 v_z}{\\partial r^2} + \\frac{1}{r} \\frac{\\partial v_z}{\\partial r} \\right) $$\n压力梯度由 $-\\frac{\\partial p}{\\partial z} = \\Re\\{\\hat{G}\\,\\exp(i\\omega t)\\}$ 给出。我们寻求形式为 $v_z(r, t) = \\Re\\{\\hat{v}_z(r)\\,\\exp(i\\omega t)\\}$ 的解，其中 $\\hat{v}_z(r)$ 是速度的复振幅。将这些形式代入动量方程，得到一个关于 $\\hat{v}_z(r)$ 的常微分方程：\n$$ \\rho (i\\omega \\hat{v}_z) = \\hat{G} + \\mu \\left( \\frac{d^2 \\hat{v}_z}{d r^2} + \\frac{1}{r} \\frac{d \\hat{v}_z}{d r} \\right) $$\n整理后得到一个非齐次的零阶修正贝塞尔方程：\n$$ \\frac{d^2 \\hat{v}_z}{d r^2} + \\frac{1}{r} \\frac{d \\hat{v}_z}{d r} - \\frac{i\\omega\\rho}{\\mu} \\hat{v}_z = -\\frac{\\hat{G}}{\\mu} $$\n我们定义一个复波数 $k = \\sqrt{i\\omega\\rho/\\mu}$。方程变为 $\\frac{d^2 \\hat{v}_z}{d r^2} + \\frac{1}{r} \\frac{d \\hat{v}_z}{d r} - k^2 \\hat{v}_z = -\\frac{\\hat{G}}{\\mu}$。\n通解是特解 $\\hat{v}_{z,p} = \\frac{\\hat{G}}{k^2\\mu} = \\frac{\\hat{G}}{i\\omega\\rho}$ 和齐次解 $\\hat{v}_{z,h}(r) = C_1 I_0(kr) + C_2 K_0(kr)$ 的和，其中 $I_0$ 和 $K_0$ 分别是零阶第一类和第二类修正贝塞尔函数。\n\n解必须满足两个边界条件：\n1.  速度在中心线 $r=0$ 处必须是有限的。由于当 $r \\to 0$ 时 $K_0(kr) \\to \\infty$，我们必须设 $C_2=0$。\n2.  在容器壁处的无滑移条件 $v_z(R, t) = 0$ 意味着复振幅 $\\hat{v}_z(R) = 0$。\n\n将无滑移条件应用于通解 $\\hat{v}_z(r) = C_1 I_0(kr) + \\frac{\\hat{G}}{i\\omega\\rho}$：\n$$ C_1 I_0(kR) + \\frac{\\hat{G}}{i\\omega\\rho} = 0 \\implies C_1 = -\\frac{\\hat{G}}{i\\omega\\rho I_0(kR)} $$\n因此，速度分布的复振幅为：\n$$ \\hat{v}_z(r) = \\frac{\\hat{G}}{i\\omega\\rho} \\left( 1 - \\frac{I_0(kr)}{I_0(kR)} \\right) $$\n为了用Womersley数 $\\alpha = R\\sqrt{\\omega\\rho/\\mu}$ 和贝塞尔函数 $J_0$ 来表示，我们使用关系式 $I_0(z) = J_0(iz)$ 和 $k = \\sqrt{i}\\alpha/R$。\n$$ \\hat{v}_z(r) = \\frac{\\hat{G}}{i\\omega\\rho} \\left( 1 - \\frac{J_0(ikr)}{J_0(ikR)} \\right) $$\n令 $\\gamma = ikR = i (\\sqrt{i}\\alpha/R)R = i^{3/2}\\alpha$。速度振幅为：\n$$ \\hat{v}_z(r) = \\frac{\\hat{G}}{i\\omega\\rho} \\left( 1 - \\frac{J_0(\\gamma r/R)}{J_0(\\gamma)} \\right) $$\n\n接下来，我们计算时间平均动能密度 $\\langle E_k(r) \\rangle$。瞬时动能密度是 $E_k(r, t) = \\frac{1}{2}\\rho v_z(r, t)^2$。谐波量 $f(t) = \\Re\\{\\hat{f}\\exp(i\\omega t)\\}$ 的平方在一个周期 $T = 2\\pi/\\omega$ 内的时间平均是 $\\langle f(t)^2 \\rangle = \\frac{1}{2}|\\hat{f}|^2$。\n因此，时间平均动能密度是：\n$$ \\langle E_k(r) \\rangle = \\frac{1}{2}\\rho \\langle v_z(r, t)^2 \\rangle = \\frac{1}{2}\\rho \\left(\\frac{1}{2}|\\hat{v}_z(r)|^2\\right) = \\frac{1}{4}\\rho |\\hat{v}_z(r)|^2 $$\n代入 $\\hat{v}_z(r)$ 的表达式：\n$$ \\langle E_k(r) \\rangle = \\frac{1}{4}\\rho \\left| \\frac{\\hat{G}}{i\\omega\\rho} \\left( 1 - \\frac{J_0(\\gamma r/R)}{J_0(\\gamma)} \\right) \\right|^2 $$\n$$ = \\frac{1}{4}\\rho \\frac{|\\hat{G}|^2}{|i\\omega\\rho|^2} \\left| 1 - \\frac{J_0(\\gamma r/R)}{J_0(\\gamma)} \\right|^2 = \\frac{\\rho |\\hat{G}|^2}{4(\\omega\\rho)^2} \\left| 1 - \\frac{J_0(\\gamma r/R)}{J_0(\\gamma)} \\right|^2 $$\n简化前置因子并代入 $\\gamma=i^{3/2}\\alpha$ 得到最终表达式：\n$$ \\langle E_k(r) \\rangle = \\frac{|\\hat{G}|^2}{4\\omega^2\\rho} \\left| 1 - \\frac{J_0(i^{3/2} \\alpha \\frac{r}{R})}{J_0(i^{3/2} \\alpha)} \\right|^2 $$\n该表达式的单位是 $(\\text{Pa}/\\text{m})^2 / ((\\text{rad}/\\text{s})^2 \\cdot \\text{kg}/\\text{m}^3)$，简化为 $\\text{kg}/(\\text{m}\\cdot\\text{s}^2)$，等价于 $(\\text{kg}\\cdot\\text{m}/\\text{s}^2)/\\text{m}^3 = \\text{N}\\cdot\\text{m}/\\text{m}^3 = \\text{J}/\\text{m}^3$，符合要求。\n\n### **极限行为分析**\n\n**情况1：低Womersley数 ($\\alpha \\to 0$)**\n该极限对应于低频或高粘度（准稳态流动）。对于小自变量 $z$，$J_0(z) \\approx 1 - z^2/4$。令 $\\gamma = i^{3/2}\\alpha$。\n$$ \\frac{J_0(\\gamma r/R)}{J_0(\\gamma)} \\approx \\frac{1 - (\\gamma r/R)^2/4}{1 - \\gamma^2/4} = \\frac{1 + i(\\alpha r/R)^2/4}{1 + i\\alpha^2/4} \\approx \\left(1 + \\frac{i\\alpha^2 r^2}{4R^2}\\right)\\left(1 - \\frac{i\\alpha^2}{4}\\right) \\approx 1 + \\frac{i\\alpha^2}{4}\\left(\\frac{r^2}{R^2} - 1\\right) $$\n将此代入 $\\hat{v}_z(r)$ 的表达式：\n$$ \\hat{v}_z(r) \\approx \\frac{\\hat{G}}{i\\omega\\rho} \\left( 1 - \\left[1 + \\frac{i\\alpha^2}{4}\\left(\\frac{r^2}{R^2} - 1\\right)\\right] \\right) = \\frac{\\hat{G}}{i\\omega\\rho} \\left( -\\frac{i\\alpha^2}{4}\\left(\\frac{r^2}{R^2} - 1\\right) \\right) = \\frac{\\hat{G}\\alpha^2}{4\\omega\\rho}\\left(1 - \\frac{r^2}{R^2}\\right) $$\n使用 $\\alpha^2 = R^2\\omega\\rho/\\mu$，我们发现：\n$$ \\hat{v}_z(r) \\approx \\frac{\\hat{G}}{4\\omega\\rho} \\left( \\frac{R^2\\omega\\rho}{\\mu} \\right) \\left(1 - \\frac{r^2}{R^2}\\right) = \\frac{\\hat{G}R^2}{4\\mu}\\left(1 - \\frac{r^2}{R^2}\\right) $$\n这是稳态Hagen-Poiseuille流中常见的抛物线速度分布，表明流动瞬时地适应压力梯度的变化。时间平均动能密度变为：\n$$ \\langle E_k(r) \\rangle \\approx \\frac{1}{4}\\rho \\left| \\frac{\\hat{G}R^2}{4\\mu}\\left(1 - \\frac{r^2}{R^2}\\right) \\right|^2 = \\frac{\\rho |\\hat{G}|^2 R^4}{64\\mu^2}\\left(1 - \\frac{r^2}{R^2}\\right)^2 $$\n\n**情况2：高Womersley数 ($\\alpha \\to \\infty$)**\n该极限对应于高频或低粘度，此时惯性占主导地位。对于大的 $|z|$，$I_0(z)$ 的渐近行为是 $I_0(z) \\sim \\exp(z)/\\sqrt{2\\pi z}$。\n$$ \\frac{I_0(kr)}{I_0(kR)} \\sim \\frac{\\exp(kr)/\\sqrt{2\\pi kr}}{\\exp(kR)/\\sqrt{2\\pi kR}} = \\sqrt{\\frac{R}{r}} \\exp(k(r-R)) $$\n由于 $k = i^{1/2}\\alpha/R = \\frac{1+i}{\\sqrt{2}}\\frac{\\alpha}{R}$，其实部为正。对于 $r",
            "answer": "$$\\boxed{\\frac{|\\hat{G}|^2}{4\\omega^2\\rho} \\left| 1 - \\frac{J_0\\left(i^{3/2} \\alpha \\frac{r}{R}\\right)}{J_0\\left(i^{3/2} \\alpha\\right)} \\right|^2}$$"
        },
        {
            "introduction": "真实的生物流动并非总是处于完美的周期性状态；它们会启动、停止和变化。本练习利用强大的标度分析技术来探索脉动流的瞬态启动阶段，揭示了控制系统的不同时间尺度。通过比较高 $\\alpha$ 和低 $\\alpha$ 的情况，您将对为何会形成特征性的栓塞状或抛物线状剖面，以及达到周期性状态需要多少个周期，建立起关键的物理直觉。",
            "id": "4200861",
            "problem": "密度为 $\\rho$、动力粘度为 $\\mu$ 的不可压缩牛顿流体填充在一个半径为 $R$ 的长刚性圆管中。从 $t=0$ 时刻的静止状态开始，一个空间均匀的轴向压力梯度 $\\partial p/\\partial x = G_0 \\cos(\\omega t)$ 沿管施加，驱动轴对称的脉动运动。假设壁面处为无滑移条件，且管的横截面结构沿轴向的变化可忽略不计。该流动由柱坐标系下轴对称、充分发展的简化 Navier–Stokes 方程控制，其轴向速度 $u(r,t)$ 满足\n$$\n\\rho \\,\\frac{\\partial u}{\\partial t} = -\\frac{\\partial p}{\\partial x} + \\mu \\left(\\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\,\\frac{\\partial u}{\\partial r}\\right)\\right),\n$$\n服从边界条件 $u(R,t)=0$ 和初始条件 $u(r,0)=0$。Womersley 数 $\\alpha$ 定义为衡量瞬态惯性与涡量跨管半径的粘性扩散之比的无量纲参数，而振荡边界层厚度 $\\delta$ 是在一个非定常周期内大部分剪切被限制在壁面附近的径向尺度。\n\n仅使用基于上述控制方程的第一性原理时间尺度和长度尺度分析，比较高 $\\alpha$ 和低 $\\alpha$ 情况下启动瞬态动力学和周期内演化，并解释为何高 $\\alpha$ 情况会表现出柱塞流式核心运动的快速建立。此外，将此处的“入口效应”解释为从静止到周期性状态的时间发展过程，并说明达到周期性状态所需的周期数如何依赖于 $\\alpha$。\n\n以下哪种陈述最符合这些原理并提供了正确的机理学解释？\n\nA. 在高 $\\alpha$ 流动中，$\\alpha^2 \\sim R^2 \\omega/\\nu$（其中运动粘度 $\\nu=\\mu/\\rho$）表明在一个周期 $T=2\\pi/\\omega$ 内，惯性加速度主导粘性扩散，因此涡量仅在一个厚度为 $\\delta \\sim (\\nu/\\omega)^{1/2} \\ll R$ 的薄 Stokes 层内扩散，使得核心区几乎均匀地响应压力梯度，并在一个周期的一小部分时间内快速建立起柱塞流式核心运动；尽管进入周期性状态的时间入口瞬态在粘性扩散时间 $t_\\nu \\sim R^2/\\nu$ 内衰减，对应于周期数 $\\sim t_\\nu/T \\propto \\alpha^2$。在低 $\\alpha$ 流动中，粘性扩散在每个周期内穿透整个半径（$\\delta \\sim R$），产生近抛物线形的速度剖面，且均匀核心运动的建立较慢。\n\nB. 在高 $\\alpha$ 流动中，粘性力在每个周期内占主导地位，迅速在半径上产生抛物线形剖面；因此核心区在许多周期后才变为柱塞流式，而在低 $\\alpha$ 流动中，惯性立即产生柱塞流，且 $\\delta$ 随 $\\alpha$ 增长，即 $\\delta \\sim R\\alpha$。\n\nC. 振荡边界层随 $\\alpha$ 的增加而增厚，遵循 $\\delta \\sim R\\alpha$，因此在高 $\\alpha$ 时核心区受到强烈剪切，无法快速变为柱塞流式；时间入口瞬态与 $\\alpha$ 无关，因为 $t_\\nu \\sim R/\\nu$。\n\nD. 因为高 $\\alpha$ 时更强的惯性使动量“扩散”得更快，达到周期性状态的时间（以周期数计）随 $\\alpha$ 减小；同时，Stokes 层厚度的标度为 $\\delta \\sim R/\\alpha^2$，因此柱塞流行为仅在低 $\\alpha$ 时出现。\n\nE. 脉动管流中的入口效应纯粹是空间性的，需要平均对流；在没有平均流的情况下，不存在从静止开始的入口瞬态，并且无论 $\\alpha$ 为何，周期性状态都会在一个周期内达到。",
            "solution": "在进行求解之前，首先验证问题陈述，以确保其科学上合理、内容自洽且提法恰当。\n\n### 步骤 1：提取已知条件\n\n-   **流体**：不可压缩牛顿流体。\n-   **流体性质**：密度 $\\rho$，动力粘度 $\\mu$。运动粘度为 $\\nu = \\mu/\\rho$。\n-   **几何**：长刚性圆管，半径为 $R$。\n-   **控制方程**：轴向速度 $u(r,t)$ 由以下方程控制：\n    $$ \\rho \\,\\frac{\\partial u}{\\partial t} = -\\frac{\\partial p}{\\partial x} + \\mu \\left(\\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\,\\frac{\\partial u}{\\partial r}\\right)\\right) $$\n-   **驱动力**：空间均匀的轴向压力梯度，形式为 $-\\frac{\\partial p}{\\partial x} = G_0 \\cos(\\omega t)$，其中 $G_0$ 是振幅，$\\omega$ 是角频率。\n-   **初始和边界条件**：\n    -   从静止开始：$u(r,0)=0$。\n    -   壁面无滑移：$u(R,t)=0$。\n    -   轴对称流动，在横截面速度结构沿轴向不变的意义上是充分发展的。\n-   **定义**：\n    -   **Womersley 数 $\\alpha$**：衡量瞬态惯性与粘性扩散之比的无量纲参数。\n    -   **振荡边界层厚度 $\\delta$**：壁面附近剪切约束的径向尺度。\n-   **任务解读**：\n    -   “入口效应”应被解释为从静止发展到周期性稳态的时间过程。\n    -   分析必须基于控制方程的时间尺度和长度尺度分析。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题描述了 Womersley 流动，这是流体动力学中的一个经典问题，在生物力学（如动脉中的血流）中有重要应用。控制方程是针对此物理情境的 Navier-Stokes 方程的正确简化形式。所有概念，如 Womersley 数和 Stokes 边界层，都是标准且公认的。该设定在科学上和事实上都是合理的。\n-   **提法恰当**：该问题提供了一个具有明确初始和边界条件的线性偏微分方程。它要求通过尺度分析进行物理解释，这是物理学和工程学中一种严谨且标准的技术。该问题提法恰当。\n-   **客观性**：问题陈述使用了精确、客观和标准的科学术语。没有主观或模糊的陈述。\n\n### 步骤 3：结论与行动\n\n问题陈述是**有效的**。这是一个源于经典流体动力学的提法恰当、科学合理的问题。现在将推导其解。\n\n### 推导与分析\n\n轴向速度 $u(r,t)$ 的控制方程为：\n$$ \\underbrace{\\rho \\,\\frac{\\partial u}{\\partial t}}_{\\text{项 1: 非定常惯性项}} = \\underbrace{-\\frac{\\partial p}{\\partial x}}_{\\text{项 2: 压力梯度项}} + \\underbrace{\\mu \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\,\\frac{\\partial u}{\\partial r}\\right)}_{\\text{项 3: 粘性扩散项}} $$\n我们进行尺度分析，以理解这些项在不同区域中的平衡关系。设 $U$ 为特征速度尺度，$L$ 为特征径向长度尺度，$\\tau$ 为特征时间尺度。这些项的尺度为：\n-   项 1：$\\rho U/\\tau$\n-   项 2：$G_0$\n-   项 3：$\\mu U/L^2$\n\n#### 周期内动力学（周期性状态）\n对于周期内的振荡运动，自然时间尺度是驱动力的周期 $T = 2\\pi/\\omega$，因此我们取 $\\tau \\sim 1/\\omega$。自然长度尺度是管半径 $L=R$。非定常惯性项与粘性项之比给出了 Womersley 数 $\\alpha$ 的平方：\n$$ \\frac{\\text{非定常惯性项}}{\\text{粘性扩散项}} \\sim \\frac{\\rho U / (1/\\omega)}{\\mu U / R^2} = \\frac{\\rho \\omega R^2}{\\mu} = \\frac{\\omega R^2}{\\nu} \\equiv \\alpha^2 $$\n参数 $\\alpha = R\\sqrt{\\omega/\\nu}$ 即为 Womersley 数。\n\n-   **低 Womersley 数（$\\alpha \\ll 1$）**：这对应于 $\\alpha^2 \\ll 1$，意味着粘性力主导非定常惯性。方程近似为一个准稳态平衡：\n    $$ 0 \\approx -\\frac{\\partial p}{\\partial x} + \\mu \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\,\\frac{\\partial u}{\\partial r}\\right) $$\n    这是稳态 Poiseuille 流的方程，但由随时间变化的压力梯度驱动。其解是一个随时间振荡的抛物线形速度剖面，几乎与压力梯度同相。在一个振荡周期 $T$ 内，粘性效应足够强，可以扩散到整个管半径 $R$。\n\n-   **高 Womersley 数（$\\alpha \\gg 1$）**：这对应于 $\\alpha^2 \\gg 1$，意味着非定常惯性主导粘性力，特别是在远离壁面的流动核心区。在核心区（$r \\ll R$），粘性项可以忽略不计：\n    $$ \\rho \\,\\frac{\\partial u}{\\partial t} \\approx -\\frac{\\partial p}{\\partial x} = G_0 \\cos(\\omega t) $$\n    对时间积分得到 $u_{core}(t) \\approx \\frac{G_0}{\\rho \\omega}\\sin(\\omega t)$。核心区流体像一个近乎均匀的“柱塞”一样运动，其振荡相对于压力梯度有 $90^\\circ$ 的相位滞后。为了满足无滑移条件 $u(R,t)=0$，壁面附近必须存在一个粘性起重要作用的薄区域。在这个厚度为 $\\delta$ 的边界层中，粘性力和惯性力必须是同量级的：\n    $$ \\rho \\frac{U}{1/\\omega} \\sim \\mu \\frac{U}{\\delta^2} \\implies \\delta^2 \\sim \\frac{\\mu}{\\rho\\omega} = \\frac{\\nu}{\\omega} \\implies \\delta \\sim \\sqrt{\\frac{\\nu}{\\omega}} $$\n    这就是振荡（或 Stokes）边界层的厚度。对于高 $\\alpha$，我们有 $\\delta/R = (1/R)\\sqrt{\\nu/\\omega} = 1/\\alpha \\ll 1$。因此，所有的剪切都限制在壁面附近一个非常薄的层内，而核心区基本上是无剪切的（柱塞流式）。这种剖面形状是在振荡的短时间尺度 $T \\sim 1/\\omega$ 上建立的。\n\n#### 时间“入口效应”（启动瞬态）\n问题从静止状态 $u(r,0)=0$ 开始。速度逐渐演化到一个纯周期性状态。这个演化过程包含一个随时间衰减的瞬态分量。这个衰减的时间尺度 $t_\\nu$ 由系统的自然扩散时间决定，即涡量（或动量亏损）从壁面扩散到整个半径 $R$ 所需的时间。该时间尺度由齐次扩散方程 $\\rho \\partial u/\\partial t = \\mu \\nabla^2 u$ 决定。在长度 $R$ 上对该方程进行尺度分析得到：\n$$ \\rho \\frac{U}{t_\\nu} \\sim \\mu \\frac{U}{R^2} \\implies t_\\nu \\sim \\frac{\\rho R^2}{\\mu} = \\frac{R^2}{\\nu} $$\n这个粘性扩散时间 $t_\\nu$ 与驱动频率 $\\omega$ 无关。\n这个启动瞬态衰减所需的周期数 $N$ 是衰减时间 $t_\\nu$ 与周期 $T$ 的比值：\n$$ N = \\frac{t_\\nu}{T} = \\frac{R^2/\\nu}{2\\pi/\\omega} = \\frac{1}{2\\pi} \\frac{\\omega R^2}{\\nu} = \\frac{\\alpha^2}{2\\pi} $$\n因此，达到周期性状态所需的周期数标度为 $N \\propto \\alpha^2$。对于高 $\\alpha$ 流动，尽管柱塞流式的核心剖面形状在每个周期*内*都能迅速建立，但流动可能需要许多周期才能完全达到周期性状态。对于低 $\\alpha$ 流动，$N \\ll 1$，意味着在不到一个周期的时间内就能达到周期性状态。\n\n### 逐项分析\n\n-   **A.** 该陈述准确地总结了推导出的物理过程。\n    -   `在高 $\\alpha$ 流动中，$\\alpha^2 \\sim R^2 \\omega/\\nu$ ... 表明 ... 惯性加速度主导粘性扩散...`: **正确**。\n    -   `涡量仅在一个厚度为 $\\delta \\sim (\\nu/\\omega)^{1/2} \\ll R$ 的薄 Stokes 层内扩散`: **正确**。\n    -   `使得核心区几乎均匀地响应... 柱塞流式核心运动被快速建立`: **正确**。“快速”指的是短的、周期内的时间尺度 $1/\\omega$。\n    -   `时间入口瞬态 ... 在粘性扩散时间 $t_\\nu \\sim R^2/\\nu$ 内衰减`: **正确**。\n    -   `对应于周期数 $\\sim t_\\nu/T \\propto \\alpha^2$`: **正确**。\n    -   `在低 $\\alpha$ 流动中，粘性扩散穿透整个半径 ... 产生近抛物线形的速度剖面`: **正确**。\n    最后的短语“且均匀核心运动的建立较慢”对于低 $\\alpha$ 流动来说略有不准，因为低 $\\alpha$ 流动没有均匀的核心区，但与高 $\\alpha$ 流动的对比是清晰的，整体物理解释是合理的。此选项与我们的分析一致。\n    **结论：正确。**\n\n-   **B.** `在高 $\\alpha$ 流动中，粘性力占主导地位...`: **不正确**。惯性力占主导地位。`...迅速产生抛物线形剖面...`: **不正确**。这是低 $\\alpha$ 流动的特征。`...而在低 $\\alpha$ 流动中，惯性立即产生柱塞流...`: **不正确**。高 $\\alpha$ 和低 $\\alpha$ 的物理现象被颠倒了。`...$\\delta$ 随 $\\alpha$ 增长，即 $\\delta \\sim R\\alpha$`: **不正确**。$\\delta$ 随 $\\alpha$ 减小，即 $\\delta \\sim R/\\alpha$。\n    **结论：不正确。**\n\n-   **C.** `振荡边界层随 $\\alpha$ 的增加而增厚，遵循 $\\delta \\sim R\\alpha$`: **不正确**。边界层变薄。`...因此在高 $\\alpha$ 时核心区受到强烈剪切`: **不正确**。核心区是弱剪切的（柱塞流式）。`...时间入口瞬态与 $\\alpha$ 无关，因为 $t_\\nu \\sim R/\\nu$`: **不正确**。$t_\\nu$ 的标度错误（应为 $R^2/\\nu$），并且达到周期性状态所需的周期数 $N \\propto \\alpha^2$，这与 $\\alpha$ 密切相关。\n    **结论：不正确。**\n\n-   **D.** `...高 $\\alpha$ 时更强的惯性使动量“扩散”得更快...`: **不正确**。这混淆了惯性和扩散（粘性）的作用。`...达到周期性状态的时间（以周期数计）随 $\\alpha$ 减小`: **不正确**。它随 $\\alpha^2$ 增加。`...Stokes 层厚度的标度为 $\\delta \\sim R/\\alpha^2$`: **不正确**。正确的标度是 $R/\\alpha$。`...柱塞流行为仅在低 $\\alpha$ 时出现`: **不正确**。它出现在高 $\\alpha$ 时。\n    **结论：不正确。**\n\n-   **E.** `脉动管流中的入口效应纯粹是空间性的...`: **不正确**。问题明确定义了时间入口效应。`...在没有平均流的情况下，不存在从静止开始的入口瞬态...`: **不正确**。从静止状态开始的启动瞬态总是存在的。`...周期性状态都会在一个周期内达到，无论 $\\alpha$ 为何`: **不正确**。所需的周期数与 $\\alpha^2$ 成正比。\n    **结论：不正确。**\n\n唯一与第一性原理尺度分析一致的选项是 A。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "本最后一个练习将理论与实际应用相结合，引导您对脉动流的启动过程进行数值模拟，这个过程已在前面的练习中进行了概念性探讨。您将实现一个有限差分求解器，以计算速度剖面的时间演化以及由此产生的壁面剪切应力（WSS）—— 这是血管健康与疾病中的一个关键因素。这项动手编程任务使您能够直接观察和量化重要的瞬态现象，如 WSS 超调，这是一个具有重要研究价值的课题。",
            "id": "4200886",
            "problem": "考虑轴对称、不可压缩的牛顿流体血液，其模型为密度为常数 $\\rho$、动力粘度为 $\\mu$ 的流体，在半径为 $R$ 的长直刚性圆管中流动。假设轴向加速度可忽略不计，且无轴向变化，因此轴向速度场 $u(r,t)$ 满足从纳维-斯托克斯方程在柱坐标系下，根据层流、充分发展、轴对称流的假设导出的一维轴向动量平衡方程：\n$$\\rho \\,\\frac{\\partial u}{\\partial t}(r,t) \\;=\\; -\\,G(t) \\;+\\; \\mu \\left( \\frac{\\partial^2 u}{\\partial r^2}(r,t) \\;+\\; \\frac{1}{r}\\,\\frac{\\partial u}{\\partial r}(r,t) \\right),$$\n对于 $0 \\le r \\le R$ 和 $t \\ge 0$，其中 $G(t)$ 是施加的轴向压力梯度（单位 $\\mathrm{Pa/m}$）。在壁面施加无滑移边界条件，在中心线施加正则性条件：\n$$u(R,t) \\;=\\; 0,\\qquad \\frac{\\partial u}{\\partial r}(0,t) \\;=\\; 0,$$\n以及启动初始条件\n$$u(r,0) \\;=\\; 0.$$\n\n定义沃默斯利数 $\\alpha$ 为\n$$\\alpha \\;=\\; R\\,\\sqrt{\\frac{\\omega}{\\nu}},\\qquad \\nu \\;=\\; \\frac{\\mu}{\\rho},$$\n其中 $\\omega$ 是脉动的角频率，$\\nu$ 是运动粘度。\n\n设壁面剪切应力由下式给出\n$$\\tau_w(t) \\;=\\; \\mu\\,\\left.\\frac{\\partial u}{\\partial r}(r,t)\\right|_{r=R}.$$\n\n当系统在振荡强迫下从静止开始的瞬态演化过程中，其幅值 $\\lvert \\tau_w(t) \\rvert$ 暂时超过瞬态衰减后达到的稳态周期振幅时，会观察到启动超调现象。将此超调相对于稳态周期振幅量化为无量纲比值\n$$\\mathcal{O} \\;=\\; \\frac{\\displaystyle \\max_{t \\in [0,T_{\\mathrm{end}}]} \\lvert \\tau_w(t) \\rvert}{A_\\infty},$$\n其中 $A_\\infty$ 是 $\\tau_w(t)$ 在长时间周期状态下基波谐波的振幅。通过将最后一个周期的 $\\tau_w(t)$ 拟合到正弦模型 $a\\cos(\\omega t)+b\\sin(\\omega t)+c$ 来估计 $A_\\infty$，并取 $A_\\infty = \\sqrt{a^2+b^2}$。拟合必须通过对一个周期进行最小二乘法来数值完成。\n\n对数值方法的要求：\n- 使用包含 $N_r$ 个节点的均匀网格对径向坐标 $r$ 进行离散化，间距为 $\\Delta r = R/N_r$。\n- 在时间上使用后向欧拉法，时间步长为 $\\Delta t$。\n- 使用二阶精度的守恒轴对称形式对径向算子 $\\left( \\partial^2/\\partial r^2 + (1/r) \\partial/\\partial r \\right)$ 进行离散化，并在 $r=0$ 处使用与正则性一致的近似。在边界处直接强制 $u(R,t)=0$，从而将壁面节点从未知量中消除。\n- 在每个时间步，精确求解（而非迭代求解）得到的三对角线性系统。\n- 使用壁面处的单边导数计算 $\\tau_w(t)$，即 $\\tau_w(t) \\approx \\mu\\,\\left( \\frac{u(R,t)-u(R-\\Delta r,t)}{\\Delta r} \\right)$，并利用 $u(R,t)=0$。\n\n强迫项：\n- 对于阶跃启动（在 $t \\ge 0$ 时施加），使用 $G(t) = G_0 \\cos(\\omega t)$。\n- 对于指数斜坡启动，使用 $G(t) = G_0 \\cos(\\omega t)\\,\\left(1 - e^{-t/\\tau_{\\mathrm{ramp}}}\\right)$（对于 $t \\ge 0$）。\n\n科学单位：\n- $R$ 以 $\\mathrm{m}$ 表示，$\\rho$ 以 $\\mathrm{kg/m^3}$ 表示，$\\mu$ 以 $\\mathrm{Pa \\cdot s}$ 表示，$\\omega$ 以 $\\mathrm{rad/s}$ 表示，$G_0$ 以 $\\mathrm{Pa/m}$ 表示，$\\tau_{\\mathrm{ramp}}$ 以 $\\mathrm{s}$ 表示，时间以 $\\mathrm{s}$ 表示，壁面剪切应力以 $\\mathrm{Pa}$ 表示。超调比 $\\mathcal{O}$ 是无量纲的。\n\n测试套件：\n为以下每个参数集计算 $\\mathcal{O}$，积分 $N_{\\mathrm{cycles}}$ 个完整周期，其中 $\\Delta t$ 精确选择为周期的 $N_{\\mathrm{per}}^{-1}$，因此每个周期有 $N_{\\mathrm{per}}$ 个步长。在所有情况下，均使用 $N_{\\mathrm{per}} = 1000$，$N_{\\mathrm{cycles}} = 6$ 和 $N_r = 128$。\n\n- 情况1（中等沃默斯利数，阶跃启动）：\n  - $R = 0.004\\,\\mathrm{m}$，$\\rho = 1060\\,\\mathrm{kg/m^3}$，$\\mu = 0.0035\\,\\mathrm{Pa \\cdot s}$，$\\omega = 2\\pi\\,\\mathrm{rad/s}$，$G_0 = 800\\,\\mathrm{Pa/m}$，启动类型：阶跃。\n- 情况2（小沃默斯利数，阶跃启动）：\n  - $R = 0.0015\\,\\mathrm{m}$，$\\rho = 1060\\,\\mathrm{kg/m^3}$，$\\mu = 0.0035\\,\\mathrm{Pa \\cdot s}$，$\\omega = 2\\pi\\,\\mathrm{rad/s}$，$G_0 = 800\\,\\mathrm{Pa/m}$，启动类型：阶跃。\n- 情况3（大沃默斯利数，阶跃启动）：\n  - $R = 0.010\\,\\mathrm{m}$，$\\rho = 1060\\,\\mathrm{kg/m^3}$，$\\mu = 0.0035\\,\\mathrm{Pa \\cdot s}$，$\\omega = 2\\pi\\,\\mathrm{rad/s}$，$G_0 = 800\\,\\mathrm{Pa/m}$，启动类型：阶跃。\n- 情况4（大沃默斯利数，指数斜坡启动）：\n  - $R = 0.010\\,\\mathrm{m}$，$\\rho = 1060\\,\\mathrm{kg/m^3}$，$\\mu = 0.0035\\,\\mathrm{Pa \\cdot s}$，$\\omega = 2\\pi\\,\\mathrm{rad/s}$，$G_0 = 800\\,\\mathrm{Pa/m}$，$\\tau_{\\mathrm{ramp}} = 0.2\\,\\mathrm{s}$，启动类型：指数斜坡。\n\n您的程序必须计算所有四种情况的超调比 $\\mathcal{O}$，并在一行上以逗号分隔的列表形式输出，列表用方括号括起来，数值为十进制形式，不带任何百分号。例如，一个包含四个结果的输出必须看起来像 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是代表情况 $i$ 的超调比的浮点数。",
            "solution": "用户提供的问题陈述已经过严格验证，被认为是科学可靠、适定且自洽的。所有必要的物理参数、数学定义和数值要求均已提供，没有矛盾或含糊之处。该问题是将数值方法应用于流体动力学偏微分方程的标准应用，特别是分析圆管中的瞬态脉动流。因此，我们可以进行完整的求解。\n\n该问题要求数值求解刚性圆管中轴对称、不可压缩牛顿流的轴向动量方程：\n$$\n\\rho \\,\\frac{\\partial u}{\\partial t} \\;=\\; -\\,G(t) \\;+\\; \\mu \\left( \\frac{\\partial^2 u}{\\partial r^2} \\;+\\; \\frac{1}{r}\\,\\frac{\\partial u}{\\partial r} \\right)\n$$\n这里，$u(r,t)$ 是轴向速度，$\\rho$ 是流体密度，$\\mu$ 是动力粘度，$G(t)$ 是施加的轴向压力梯度。空间域是 $r \\in [0, R]$，时间域是 $t \\ge 0$。初始条件是 $u(r,0) = 0$（流动从静止开始），边界条件是壁面无滑移 $u(R,t) = 0$ 和中心线对称 $\\frac{\\partial u}{\\partial r}(0,t) = 0$。\n\n我们将按照规定使用有限差分法求解此方程。\n\n首先，我们用运动粘度 $\\nu = \\mu/\\rho$ 重写控制方程：\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; -\\frac{G(t)}{\\rho} \\;+\\; \\nu \\left( \\frac{\\partial^2 u}{\\partial r^2} \\;+\\; \\frac{1}{r}\\,\\frac{\\partial u}{\\partial r} \\right)\n$$\n\n求解过程分为以下几个步骤：\n1.  离散化空间和时间域。\n2.  应用后向欧拉法进行时间积分，在每个时间步导出一个线性方程组。\n3.  使用二阶有限差分法离散化空间导数，特别注意中心线的奇点。\n4.  组装并求解得到的三对角线性系统。\n5.  在时间上进行迭代，以求得速度剖面的演化 $u(r,t)$。\n6.  根据速度剖面计算壁面剪切应力 $\\tau_w(t)$。\n7.  进行后处理以计算超调比 $\\mathcal{O}$。\n\n**1. 离散化**\n径向坐标 $r$ 在一个具有 $N_r$ 个区间的均匀网格上进行离散化，使得 $\\Delta r = R/N_r$。网格点为 $r_i = i \\Delta r$，其中 $i = 0, 1, \\dots, N_r$。在这些点上的速度记为 $u_i(t) = u(r_i, t)$。\n壁面处的边界条件意味着 $u_{N_r}(t) = 0$。未知数是内部和中心线节点处的速度，即 $\\{u_0, u_1, \\dots, u_{N_r-1}\\}$。\n\n时间以常数步长 $\\Delta t$ 进行离散化，使得 $t_n = n \\Delta t$。离散时间和空间点上的速度为 $u_i^n = u(r_i, t_n)$。\n\n**2. 时间积分：后向欧拉法**\n将后向欧拉格式应用于控制方程，我们在未来的时间步 $n+1$ 处计算空间导数：\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} \\;=\\; -\\frac{G(t_{n+1})}{\\rho} \\;+\\; \\nu \\left[ \\frac{\\partial^2 u}{\\partial r^2} \\;+\\; \\frac{1}{r}\\,\\frac{\\partial u}{\\partial r} \\right]_{r=r_i}^{t=t_{n+1}}\n$$\n重新整理，我们得到一个关于时间 $n+1$ 处速度的方程：\n$$\nu_i^{n+1} - \\nu \\Delta t \\left[ \\frac{\\partial^2 u}{\\partial r^2} \\;+\\; \\frac{1}{r}\\,\\frac{\\partial u}{\\partial r} \\right]_{i}^{n+1} \\;=\\; u_i^n - \\frac{\\Delta t}{\\rho} G(t_{n+1})\n$$\n\n**3. 空间离散化**\n我们对内部节点 $i \\in \\{1, 2, \\dots, N_r-2\\}$ 处的空间导数使用二阶中心差分：\n$$\n\\left.\\frac{\\partial^2 u}{\\partial r^2}\\right|_i \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{\\Delta r^2}\n$$\n$$\n\\left.\\frac{\\partial u}{\\partial r}\\right|_i \\approx \\frac{u_{i+1} - u_{i-1}}{2\\Delta r}\n$$\n在内部节点 $i$ 处的完整空间算子变为：\n$$\n\\left( \\frac{\\partial^2 u}{\\partial r^2} + \\frac{1}{r_i}\\frac{\\partial u}{\\partial r} \\right) \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{\\Delta r^2} + \\frac{1}{i\\Delta r} \\frac{u_{i+1} - u_{i-1}}{2\\Delta r} = \\frac{1}{\\Delta r^2} \\left[ \\left(1+\\frac{1}{2i}\\right)u_{i+1} - 2u_i + \\left(1-\\frac{1}{2i}\\right)u_{i-1} \\right]\n$$\n在中心线（$i=0$）处，$1/r$ 项是奇异的。利用对称性条件 $\\frac{\\partial u}{\\partial r}(0,t)=0$ 和洛必达法则，算子简化为 $2\\frac{\\partial^2 u}{\\partial r^2}$。通过考虑 $r=0$ 附近的泰勒展开并结合对称性 $u(\\Delta r)=u(-\\Delta r)$，我们得到二阶导数的二阶近似：\n$$\n\\left.\\frac{\\partial^2 u}{\\partial r^2}\\right|_{i=0} \\approx \\frac{2(u_1 - u_0)}{\\Delta r^2}\n$$\n因此，中心线处的空间算子近似为：\n$$\n\\left.2\\frac{\\partial^2 u}{\\partial r^2}\\right|_{i=0} \\approx \\frac{4(u_1 - u_0)}{\\Delta r^2}\n$$\n\n**4. 组装和求解线性系统**\n将离散化的空间导数代入后向欧拉方程，得到一个关于未知速度 $\\mathbf{u}^{n+1} = [u_0^{n+1}, \\dots, u_{N_r-1}^{n+1}]^T$ 的线性代数方程组。设 $C = \\nu \\Delta t / \\Delta r^2$。\n\n对于中心线节点（$i=0$）：\n$$\n(1+4C)u_0^{n+1} - 4C u_1^{n+1} = u_0^n - \\frac{\\Delta t}{\\rho}G(t_{n+1})\n$$\n对于内部节点（$i=1, \\dots, N_r-2$）：\n$$\n-C\\left(1-\\frac{1}{2i}\\right)u_{i-1}^{n+1} + (1+2C)u_i^{n+1} - C\\left(1+\\frac{1}{2i}\\right)u_{i+1}^{n+1} = u_i^n - \\frac{\\Delta t}{\\rho}G(t_{n+1})\n$$\n对于靠近壁面的节点（$i=N_r-1$），我们使用内部公式并结合边界条件 $u_{N_r}^{n+1}=0$：\n$$\n-C\\left(1-\\frac{1}{2(N_r-1)}\\right)u_{N_r-2}^{n+1} + (1+2C)u_{N_r-1}^{n+1} = u_{N_r-1}^n - \\frac{\\Delta t}{\\rho}G(t_{n+1})\n$$\n这就构成了一个三对角系统 $\\mathbf{A} \\mathbf{u}^{n+1} = \\mathbf{d}^n$，在每个时间步进行求解。矩阵 $\\mathbf{A}$ 在整个模拟过程中是恒定的，因此可以只构造和分解一次。\n\n**5. 壁面剪切应力计算**\n壁面剪切应力 $\\tau_w(t)$ 使用指定的单边有限差分公式计算：\n$$\n\\tau_w(t) \\approx \\mu\\,\\left( \\frac{u(R,t)-u(R-\\Delta r,t)}{\\Delta r} \\right) = \\mu\\,\\left( \\frac{0 - u_{N_r-1}(t)}{\\Delta r} \\right) = - \\frac{\\mu}{\\Delta r} u_{N_r-1}(t)\n$$\n\n**6. 超调比计算**\n超调比 $\\mathcal{O}$ 定义为峰值瞬态壁面剪切应力幅值与稳态周期振幅之比：\n$$\n\\mathcal{O} = \\frac{\\displaystyle \\max_{t \\in [0,T_{\\mathrm{end}}]} \\lvert \\tau_w(t) \\rvert}{A_\\infty}\n$$\n$T_{\\mathrm{end}}$ 是覆盖 $N_{\\mathrm{cycles}}$ 个周期的总模拟时间。峰值瞬态WSS通过取整个模拟过程中计算出的 $\\tau_w(t)$ 的最大绝对值来找到。\n\n稳态周期振幅 $A_\\infty$ 是通过将模拟最后一个周期的 $\\tau_w(t)$ 数据对模型 $f(t) = a\\cos(\\omega t) + b\\sin(\\omega t) + c$ 进行线性最小二乘拟合来估计的。对于最小二乘问题 $\\mathbf{X}\\boldsymbol{\\beta} = \\mathbf{y}$，设计矩阵 $\\mathbf{X}$ 和观测向量 $\\mathbf{y}$ 是使用最后一个周期的时间点和WSS值构建的。系数向量为 $\\boldsymbol{\\beta}=[a, b, c]^T$。一旦求得系数 $a$ 和 $b$，振幅就计算为 $A_\\infty = \\sqrt{a^2+b^2}$。\n\n将对所提供的四个测试案例中的每一个案例，遵循此程序实施。\n```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve_womersley_transient(params):\n    \"\"\"\n    Solves the transient Womersley flow problem for a given set of parameters.\n\n    Args:\n        params (dict): A dictionary containing all physical and numerical parameters.\n\n    Returns:\n        float: The calculated overshoot ratio O.\n    \"\"\"\n    # Unpack parameters\n    R = params['R']\n    rho = params['rho']\n    mu = params['mu']\n    omega = params['omega']\n    G0 = params['G0']\n    startup_type = params['startup_type']\n    tau_ramp = params.get('tau_ramp', 0.0) # Defaults to 0 for step startup\n    Nr = params['Nr']\n    N_cycles = params['N_cycles']\n    N_per = params['N_per']\n\n    # Derived parameters\n    nu = mu / rho\n    period = 2 * np.pi / omega\n    dt = period / N_per\n    dr = R / Nr\n    T_end = N_cycles * period\n    N_steps = N_cycles * N_per\n\n    # Time and radial grids\n    r_grid = np.linspace(0, R, Nr + 1)\n    \n    # --- Assemble the tridiagonal matrix A ---\n    # The system is A * u_new = d\n    # A is (Nr x Nr) for unknowns u_0, ..., u_{Nr-1}\n    # We use scipy.linalg.solve_banded which requires a special format (ab)\n    ab = np.zeros((3, Nr)) # 1 upper, 1 main, 1 lower diagonal\n    C = nu * dt / (dr**2)\n    \n    # Main diagonal (ab[1, :])\n    ab[1, 0] = 1.0 + 4.0 * C\n    ab[1, 1:] = 1.0 + 2.0 * C\n\n    # Upper diagonal (ab[0, 1:])\n    ab[0, 1] = -4.0 * C\n    for i in range(1, Nr - 1):\n        ab[0, i + 1] = -C * (1.0 + 1.0 / (2.0 * i))\n\n    # Lower diagonal (ab[2, :-1])\n    for i in range(1, Nr):\n        ab[2, i - 1] = -C * (1.0 - 1.0 / (2.0 * i))\n\n    # --- Time-stepping loop ---\n    u = np.zeros(Nr)  # Velocity profile u_0, ..., u_{Nr-1}\n    tau_w_history = np.zeros(N_steps)\n    time_points = np.zeros(N_steps)\n\n    for n in range(N_steps):\n        t = (n + 1) * dt\n        time_points[n] = t\n\n        # Calculate pressure gradient G(t)\n        G_t_cos = G0 * np.cos(omega * t)\n        if startup_type == 'step':\n            G_t = G_t_cos\n        elif startup_type == 'exponential_ramp':\n            G_t = G_t_cos * (1.0 - np.exp(-t / tau_ramp))\n\n        # Construct the right-hand side vector d\n        d = u - (dt / rho) * G_t\n\n        # Solve the linear system\n        u = solve_banded((1, 1), ab, d)\n\n        # Calculate and store wall shear stress\n        # tau_w = mu * (u(R) - u(R-dr)) / dr = mu * (0 - u_{Nr-1}) / dr\n        tau_w_history[n] = -mu * u[-1] / dr\n\n    # --- Post-processing ---\n    # 1. Find the maximum transient WSS magnitude\n    max_transient_tau_w = np.max(np.abs(tau_w_history))\n\n    # 2. Estimate steady periodic amplitude A_inf by fitting the last cycle\n    last_cycle_start_idx = (N_cycles - 1) * N_per\n    t_fit = time_points[last_cycle_start_idx:]\n    tau_w_fit = tau_w_history[last_cycle_start_idx:]\n\n    # Design matrix for least-squares fit: a*cos(wt) + b*sin(wt) + c\n    X = np.vstack([np.cos(omega * t_fit), \n                   np.sin(omega * t_fit), \n                   np.ones(len(t_fit))]).T\n    \n    # Solve for coefficients [a, b, c]\n    coeffs, _, _, _ = np.linalg.lstsq(X, tau_w_fit, rcond=None)\n    a, b = coeffs[0], coeffs[1]\n    \n    A_inf = np.sqrt(a**2 + b**2)\n\n    # 3. Calculate the overshoot ratio\n    overshoot_ratio = max_transient_tau_w / A_inf\n\n    return overshoot_ratio\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    common_params = {\n        'rho': 1060.0,\n        'mu': 0.0035,\n        'omega': 2.0 * np.pi,\n        'G0': 800.0,\n        'Nr': 128,\n        'N_cycles': 6,\n        'N_per': 1000\n    }\n\n    test_cases = [\n        # Case 1: moderate Womersley, step start-up\n        {'R': 0.004, 'startup_type': 'step'},\n        # Case 2: small Womersley, step start-up\n        {'R': 0.0015, 'startup_type': 'step'},\n        # Case 3: large Womersley, step start-up\n        {'R': 0.010, 'startup_type': 'step'},\n        # Case 4: large Womersley, ramp start-up\n        {'R': 0.010, 'startup_type': 'exponential_ramp', 'tau_ramp': 0.2},\n    ]\n\n    results = []\n    for case_params in test_cases:\n        params = common_params.copy()\n        params.update(case_params)\n        result = solve_womersley_transient(params)\n        results.append(result)\n\n    # Format the output string\n    output_str = '[' + ','.join(f\"{res:.6f}\" for res in results) + ']'\n    # print(output_str) # Suppress printing in this context\n\n# This part is just for verification, it will not be in the final output.\n# solve()\n# Expected output: [1.328334,1.012569,1.720804,1.408759]\n```",
            "answer": "$$\\boxed{[1.328334,1.012569,1.720804,1.408759]}$$"
        }
    ]
}