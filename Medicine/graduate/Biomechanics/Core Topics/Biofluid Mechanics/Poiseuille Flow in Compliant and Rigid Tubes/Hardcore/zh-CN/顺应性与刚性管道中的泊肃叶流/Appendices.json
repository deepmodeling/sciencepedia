{
    "hands_on_practices": [
        {
            "introduction": "在分析复杂的生物流动系统之前，我们必须掌握其基础模型。本练习将引导您从流体动力学的第一性原理出发，推导出刚性圆管中压力降与流量之间的关系，即泊肃叶定律（Hagen-Poiseuille equation）。掌握这一推导过程是任何生物力学工程师分析管道流动问题的基石 。",
            "id": "4199141",
            "problem": "考虑一种牛顿流体在机械刚性（半径不随压力变化）的长直圆管中进行稳态、不可压缩的层流流动。管的长度为 $L$，半径恒为 $R$。流体的动力粘度为 $\\mu$。假设流动为轴对称、在轴向充分发展，并且在管壁处满足无滑移边界条件。从圆柱坐标系下的动量守恒（纳维-斯托克斯方程）出发，在这些假设下，推导沿管的轴向压降 $\\Delta p$ 与体积流量 $Q$ 之间的线性关系。用一个完全由管的几何形状和流体粘度定义的液阻 $R_h$ 来表示这个关系。然后，使用您推导出的表达式，计算以下参数值对应的压降 $\\Delta p$：$\\mu = 3.5 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$，$L = 0.30\\ \\text{m}$，$R = 2.5 \\times 10^{-3}\\ \\text{m}$，以及 $Q = 3.0 \\times 10^{-6}\\ \\text{m}^{3}\\cdot\\text{s}^{-1}$。将您的最终数值结果四舍五入到四位有效数字，并以千帕为单位表示最终压降。",
            "solution": "用户希望我解决一个流体力学问题，因此我将首先验证问题陈述。\n\n### 步骤1：提取已知条件\n-   **流动条件**：稳态、不可压缩、层流。\n-   **流体**：牛顿流体，动力粘度为 $\\mu$。\n-   **管的几何形状**：长直圆管，机械刚性，长度为 $L$，半径恒为 $R$。\n-   **假设**：轴对称，轴向充分发展流动，管壁（$r=R$）处无滑移边界条件。\n-   **任务1**：推导轴向压降 $\\Delta p$ 与体积流量 $Q$ 之间的线性关系。\n-   **任务2**：使用由管的几何形状和流体粘度定义的液阻 $R_h$ 来表示此关系。\n-   **任务3**：对以下参数值计算 $\\Delta p$：\n    -   $\\mu = 3.5 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$\n    -   $L = 0.30\\ \\text{m}$\n    -   $R = 2.5 \\times 10^{-3}\\ \\text{m}$\n    -   $Q = 3.0 \\times 10^{-6}\\ \\text{m}^{3}\\cdot\\text{s}^{-1}$\n-   **输出要求**：将最终数值结果四舍五入到四位有效数字，并以千帕为单位表示。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了哈根-泊肃叶(Hagen-Poiseuille)流动，这是纳维-斯托克斯(Navier-Stokes)方程的一个经典且基本的解。所有假设和原理都是流体力学的标准内容。该问题在科学上是合理的。\n2.  **适定性**：该问题是适定的。推导过程是标准的教科书练习，并且给定输入，存在唯一的、稳定的压降解。\n3.  **客观性**：问题陈述使用了清晰、精确和标准的科学术语。没有歧义或主观性。\n4.  **完整性和一致性**：该问题提供了执行推导和计算所需的所有信息。没有矛盾之处。为了验证层流假设，我们可以估算雷诺数 $Re = \\frac{\\rho U D}{\\mu}$，其中 $U$ 是平均速度，$D=2R$ 是直径。平均速度为 $U = \\frac{Q}{A} = \\frac{Q}{\\pi R^2} = \\frac{3.0 \\times 10^{-6}\\ \\text{m}^3/\\text{s}}{\\pi (2.5 \\times 10^{-3}\\ \\text{m})^2} \\approx 0.153\\ \\text{m}/\\text{s}$。假设流体类似于血液，其密度约为 $\\rho \\approx 1060\\ \\text{kg}/\\text{m}^3$。那么雷诺数约为 $Re \\approx \\frac{(1060\\ \\text{kg}/\\text{m}^3)(0.153\\ \\text{m}/\\text{s})(2 \\times 2.5 \\times 10^{-3}\\ \\text{m})}{3.5 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}} \\approx 232$。由于 $232 \\ll 2300$（管流的典型临界值），层流假设与给定参数完全一致。\n5.  **合理性**：数值是物理上现实的，例如，对应于小动脉中的血流。\n\n### 步骤3：结论和行动\n问题是有效的，因为它在科学上是合理的、适定的，并且所有提供的数据都是一致和完整的。我将继续进行求解。\n\n推导始于不可压缩牛顿流体的动量守恒，由纳维-斯托克斯方程表示。在圆柱坐标系 $(r, \\theta, z)$ 中，轴向（$z$-）动量方程为：\n$$\n\\rho \\left( \\frac{\\partial v_z}{\\partial t} + v_r \\frac{\\partial v_z}{\\partial r} + \\frac{v_\\theta}{r} \\frac{\\partial v_z}{\\partial \\theta} + v_z \\frac{\\partial v_z}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial z} + \\mu \\left[ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial v_z}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2 v_z}{\\partial \\theta^2} + \\frac{\\partial^2 v_z}{\\partial z^2} \\right] + \\rho g_z\n$$\n我们应用给定的假设来简化此方程：\n1.  **稳态流动**：$\\frac{\\partial}{\\partial t} = 0$。\n2.  **轴对称**：$\\frac{\\partial}{\\partial \\theta} = 0$，这也意味着切向速度 $v_\\theta = 0$。\n3.  **径向无流动**：对于半径恒定的直管，$v_r = 0$。\n4.  **充分发展流动**：速度剖面沿轴向不变，所以 $\\frac{\\partial v_z}{\\partial z} = 0$。这也满足不可压缩流动的连续性方程 $\\frac{1}{r}\\frac{\\partial(r v_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial v_\\theta}{\\partial \\theta} + \\frac{\\partial v_z}{\\partial z} = 0$，该方程简化为 $\\frac{\\partial v_z}{\\partial z} = 0$。\n我们还忽略重力效应，设 $g_z=0$，或假设管道是水平的。\n\n应用这些简化后，左侧的所有项（对流加速度项）和右侧的几项都变为零。轴向动量方程简化为：\n$$\n0 = -\\frac{\\partial p}{\\partial z} + \\mu \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial v_z}{\\partial r} \\right)\n$$\n由于 $v_z$ 仅是 $r$ 的函数，即 $v_z = v_z(r)$，所以对 $r$ 的偏导数可以写成常导数。对于充分发展的流动，压力梯度 $\\frac{\\partial p}{\\partial z}$ 不能是 $r$ 的函数，并且由于流动是稳态的，它也不能是 $t$ 的函数。因此，$\\frac{\\partial p}{\\partial z}$ 只能是 $z$ 的函数或一个常数。然而，方程的右边仅是 $r$ 的函数。为了使等式对所有 $r$ 和 $z$ 都成立，两边必须等于同一个常数。我们记 $\\frac{dp}{dz} = \\text{constant}$。\n重排方程：\n$$\n\\frac{1}{\\mu} \\frac{dp}{dz} = \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dv_z}{dr} \\right)\n$$\n我们对该方程关于 $r$ 进行积分：\n$$\n\\int r \\frac{1}{\\mu} \\frac{dp}{dz} dr = \\int \\frac{d}{dr} \\left( r \\frac{dv_z}{dr} \\right) dr\n$$\n$$\n\\frac{r^2}{2\\mu} \\frac{dp}{dz} = r \\frac{dv_z}{dr} + C_1\n$$\n由于轴对称性，速度剖面在中心线（$r=0$）处必须是光滑的，这要求速度梯度为零：$\\left. \\frac{dv_z}{dr} \\right|_{r=0} = 0$。为了使项 $\\frac{C_1}{r}$（分离 $\\frac{dv_z}{dr}$ 后会产生此项）在 $r=0$ 处为有限值，积分常数 $C_1$ 必须为零。\n因此，方程变为：\n$$\n\\frac{dv_z}{dr} = \\frac{r}{2\\mu} \\frac{dp}{dz}\n$$\n第二次对 $r$ 积分：\n$$\nv_z(r) = \\int \\frac{r}{2\\mu} \\frac{dp}{dz} dr = \\frac{r^2}{4\\mu} \\frac{dp}{dz} + C_2\n$$\n我们通过应用管壁处的无滑移边界条件 $v_z(R) = 0$ 来求第二个积分常数 $C_2$。\n$$\n0 = \\frac{R^2}{4\\mu} \\frac{dp}{dz} + C_2 \\implies C_2 = -\\frac{R^2}{4\\mu} \\frac{dp}{dz}\n$$\n将 $C_2$ 代回，得到抛物线速度剖面：\n$$\nv_z(r) = \\frac{1}{4\\mu} \\frac{dp}{dz} (r^2 - R^2)\n$$\n由于流动在正 $z$ 方向（$v_z > 0$）且 $r^2 - R^2 \\le 0$，压力梯度 $\\frac{dp}{dz}$ 必须为负。\n\n接下来，我们通过在管的横截面积 $A$ 上对速度剖面进行积分来计算体积流量 $Q$：\n$$\nQ = \\int_A v_z(r) dA = \\int_0^R v_z(r) (2\\pi r) dr\n$$\n$$\nQ = \\int_0^R \\frac{1}{4\\mu} \\frac{dp}{dz} (r^2 - R^2) (2\\pi r) dr = \\frac{2\\pi}{4\\mu} \\frac{dp}{dz} \\int_0^R (r^3 - R^2 r) dr\n$$\n$$\nQ = \\frac{\\pi}{2\\mu} \\frac{dp}{dz} \\left[ \\frac{r^4}{4} - \\frac{R^2 r^2}{2} \\right]_0^R = \\frac{\\pi}{2\\mu} \\frac{dp}{dz} \\left( \\frac{R^4}{4} - \\frac{R^4}{2} \\right) = \\frac{\\pi}{2\\mu} \\frac{dp}{dz} \\left( -\\frac{R^4}{4} \\right)\n$$\n$$\nQ = -\\frac{\\pi R^4}{8\\mu} \\frac{dp}{dz}\n$$\n这就是哈根-泊肃叶方程。恒定的压力梯度可以用沿管长 $L$ 的压降 $\\Delta p = p_{inlet} - p_{outlet}$ 表示为 $\\frac{dp}{dz} = -\\frac{\\Delta p}{L}$。将此代入 $Q$ 的方程中：\n$$\nQ = -\\frac{\\pi R^4}{8\\mu} \\left( -\\frac{\\Delta p}{L} \\right) = \\frac{\\pi R^4}{8\\mu L} \\Delta p\n$$\n重排以显示 $\\Delta p$ 和 $Q$ 之间的线性关系：\n$$\n\\Delta p = \\left( \\frac{8\\mu L}{\\pi R^4} \\right) Q\n$$\n这是 $\\Delta p = R_h Q$ 的形式，其中液阻 $R_h$ 由下式给出：\n$$\nR_h = \\frac{8\\mu L}{\\pi R^4}\n$$\n此 $R_h$ 的表达式仅取决于流体粘度 $\\mu$ 和管的几何形状（$L$ 和 $R$），符合要求。\n\n最后，我们使用提供的参数计算压降 $\\Delta p$ 的数值：\n$\\mu = 3.5 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$\n$L = 0.30\\ \\text{m}$\n$R = 2.5 \\times 10^{-3}\\ \\text{m}$\n$Q = 3.0 \\times 10^{-6}\\ \\text{m}^{3}\\cdot\\text{s}^{-1}$\n\n使用推导出的公式 $\\Delta p = \\frac{8\\mu L Q}{\\pi R^4}$：\n$$\n\\Delta p = \\frac{8 (3.5 \\times 10^{-3}) (0.30) (3.0 \\times 10^{-6})}{\\pi (2.5 \\times 10^{-3})^4}\n$$\n$$\n\\Delta p = \\frac{2.52 \\times 10^{-8}}{\\pi (3.90625 \\times 10^{-11})} \\ \\text{Pa}\n$$\n$$\n\\Delta p = \\frac{2.52 \\times 10^{-8}}{1.2271846... \\times 10^{-10}} \\ \\text{Pa} \\approx 205.349\\ \\text{Pa}\n$$\n问题要求答案以千帕（kPa）为单位。由于 $1\\ \\text{kPa} = 1000\\ \\text{Pa}$，我们有：\n$$\n\\Delta p \\approx 0.205349\\ \\text{kPa}\n$$\n四舍五入到四位有效数字，压降为 $0.2053\\ \\text{kPa}$。",
            "answer": "$$\\boxed{0.2053}$$"
        },
        {
            "introduction": "真实的血管是具有顺应性的，而非完全刚性，这意味着血管半径会随着局部压力而改变。这种顺应性通常导致难以求得解析解的非线性问题。本练习将介绍一种强大的数值“打靶法”（shooting method），用以求解此类系统中的流量，从而搭建起简化模型与更真实的生理情景之间的桥梁 。",
            "id": "4199147",
            "problem": "考虑牛顿流体在长度为 $L$ 的长直圆管中的稳定、不可压缩、层流流动。设空间坐标为 $x \\in [0,L]$，轴向压力为 $p(x)$。设动力粘度为 $\\mu$，并假设壁面无滑移。在这些条件下，体积流量 $Q$ 在空间上是均匀的。管的半径通过一个柔性定律 $R(p)$ 依赖于局部压力，其中 $R(p)$ 是一个严格为正的可微函数。对于刚性管，$R(p)$ 是一个等于 $R_0$ 的常数。\n\n根据层流的轴向动量平衡和不可压缩性约束，经典的泊肃叶定律（Poiseuille law）将轴向压力梯度与体积流量和半径联系起来，这是一个经过充分检验的关系。当管是柔性的时，给定入口和出口压力 $p(0) = p_{\\text{in}}$ 和 $p(L) = p_{\\text{out}}$，压力的轴向常微分方程为\n$$\n\\frac{dp}{dx} = -\\frac{8\\,\\mu\\,Q}{\\pi\\,R(p)^4}.\n$$\n未知量是常数 $Q$，它要确保从 $x=0$ 处以 $p(0)=p_{\\text{in}}$ 开始积分时，在 $x=L$ 处的边界条件得到满足。\n\n您的任务是实现一个数值打靶法来确定 $Q$，使得在积分上述初值问题后，得到的 $p(L;Q)$ 在指定公差范围内满足 $p(L;Q) = p_{\\text{out}}$。使用四阶显式 Runge–Kutta 方法对 $p(x)$ 进行积分，并对标量失配函数\n$$\nF(Q) = p(L;Q) - p_{\\text{out}}.\n$$\n使用一个稳健的基于区间法的求根器（例如，二分法）。\n采用以下线性柔性定律来描述半径：\n$$\nR(p) = R_0 \\left[1 + c\\,\\left(p - p_0\\right)\\right],\n$$\n其中 $R_0$ 是在参考压力 $p_0$ 下的参考半径，而 $c$ 是一个正的柔性系数，其单位是压力的倒数。\n\n实现您的程序以完成以下任务：\n- 使用具有 $N$ 个步骤的均匀网格，通过 Runge–Kutta 方法对从 $x=0$ 到 $x=L$ 的压力常微分方程进行积分。\n- 对 $Q$ 使用二分法，以在 $\\varepsilon_p = 10^{-3}$ 帕斯卡的绝对压力公差内强制实现 $p(L;Q) = p_{\\text{out}}$。\n- 通过要求在所有遇到的压力下 $R(p) > 0$ 来确保科学真实性；下面选择的参数使得该条件无需特别处理即可成立。\n\n物理单位必须一致地处理：\n- 长度单位为米 ($\\text{m}$)。\n- 压力单位为帕斯卡 ($\\text{Pa}$)。\n- 动力粘度单位为帕斯卡-秒 ($\\text{Pa}\\cdot\\text{s}$)。\n- 体积流量单位为立方米/秒 ($\\text{m}^3/\\text{s}$)。\n\n您的程序必须为以下四个测试用例计算 $Q$，并生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个条目都需格式化为包含六位小数的科学记数法。每个 $Q$ 都以立方米/秒 ($\\text{m}^3/\\text{s}$) 为单位表示。\n\n测试套件：\n1. 一般柔性管（正常情况）：\n   - $L = 0.5$ $\\text{m}$，$R_0 = 2.5\\times 10^{-3}$ $\\text{m}$，$\\mu = 3.5\\times 10^{-3}$ $\\text{Pa}\\cdot\\text{s}$，\n     $p_0 = 1.0\\times 10^{4}$ $\\text{Pa}$，$p_{\\text{in}} = 1.33\\times 10^{4}$ $\\text{Pa}$，$p_{\\text{out}} = 1.0\\times 10^{4}$ $\\text{Pa}$，$c = 2.0\\times 10^{-5}$ $\\text{Pa}^{-1}$，$N = 2000$。\n2. 刚性管边界情况：\n   - 与情况1相同，但 $c = 0$。\n3. 高柔性管：\n   - 与情况1相同，但 $c = 8.0\\times 10^{-5}$ $\\text{Pa}^{-1}$。\n4. 压降小的短管：\n   - $L = 0.05$ $\\text{m}$，$R_0 = 1.5\\times 10^{-3}$ $\\text{m}$，$\\mu = 3.5\\times 10^{-3}$ $\\text{Pa}\\cdot\\text{s}$，\n     $p_0 = 1.0\\times 10^{4}$ $\\text{Pa}$，$p_{\\text{in}} = 1.05\\times 10^{4}$ $\\text{Pa}$，$p_{\\text{out}} = 1.0\\times 10^{4}$ $\\text{Pa}$，$c = 5.0\\times 10^{-5}$ $\\text{Pa}^{-1}$，$N = 1000$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含上述四个测试用例的 $Q$ 值，形式为用方括号括起来的逗号分隔列表，例如，\"[q1,q2,q3,q4]\"。每个 $q_i$ 必须以 $\\text{m}^3/\\text{s}$ 为单位，并格式化为包含六位小数的科学记数法。",
            "solution": "该问题要求确定柔性圆管中稳定、不可压缩、层流的体积流量 $Q$。这是一个关于轴向压力 $p(x)$ 的边值问题，使用打靶法进行建模。解决方案涉及将数值常微分方程（ODE）积分器与求根算法相结合。\n\n沿管轴 $x \\in [0,L]$ 的压力 $p(x)$ 的控制性常微分方程（ODE）源自哈根-泊肃叶定律（Hagen-Poiseuille law），该定律局部应用于半径为 $R(p)$ 的管段：\n$$\n\\frac{dp}{dx} = -\\frac{8\\,\\mu\\,Q}{\\pi\\,R(p)^4}\n$$\n这里，$\\mu$ 是流体的动力粘度，$Q$ 是恒定的体积流量。管半径 $R$ 不是常数，而是通过给定的线性柔性定律依赖于局部压力 $p$：\n$$\nR(p) = R_0 \\left[1 + c\\,\\left(p - p_0\\right)\\right]\n$$\n其中 $R_0$ 是在压力 $p_0$ 下的参考半径，$c$ 是柔性系数。该问题受边界条件 $p(0) = p_{\\text{in}}$ 和 $p(L) = p_{\\text{out}}$ 的约束。\n\n问题的核心是流量 $Q$ 是未知的。我们必须找到 $Q$ 的值，以确保具有初始条件 $p(0) = p_{\\text{in}}$ 的常微分方程的解也满足终端条件 $p(L) = p_{\\text{out}}$。这种结构适合采用打靶法。\n\n我们定义一个失配函数 $F(Q)$，它表示给定 $Q$ 计算出的出口压力与期望的出口压力 $p_{\\text{out}}$ 之间的差值：\n$$\nF(Q) = p(L;Q) - p_{\\text{out}}\n$$\n其中 $p(L;Q)$ 是将常微分方程作为初值问题（IVP），从 $p(0) = p_{\\text{in}}$ 开始并使用 $Q$ 的一个试验值求解所得到的在 $x=L$ 处的压力。因此，问题转化为求解标量方程 $F(Q)=0$ 的根。\n\n为了计算 $p(L;Q)$，我们对从 $x=0$ 到 $x=L$ 的常微分方程进行数值积分。问题指定使用四阶显式 Runge-Kutta (RK4) 方法，以及一个包含 $N$ 个步骤的均匀网格。步长为 $h = L/N$。对于从 $x_i$ 到 $x_{i+1} = x_i + h$ 的每一步，压力 $p_{i+1}$ 按如下方式从 $p_i$ 更新：\n$$\np_{i+1} = p_i + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n$$\n其中，各阶段 $k_j$ 由以下公式给出：\n$$\n\\begin{aligned}\nf(p, Q) = -\\frac{8\\,\\mu\\,Q}{\\pi\\,R(p)^4} \\\\\nk_1 = f(p_i, Q) \\\\\nk_2 = f(p_i + \\frac{h}{2}k_1, Q) \\\\\nk_3 = f(p_i + \\frac{h}{2}k_2, Q) \\\\\nk_4 = f(p_i + hk_3, Q)\n\\end{aligned}\n$$\n从 $p_0=p_{\\text{in}}$ 开始，我们执行 $N$ 次这样的步骤来找到 $p_N \\approx p(L;Q)$。\n\n为了找到 $F(Q)=0$ 的根，我们采用二分法，这是一种稳健的基于区间法的求根器。该方法是适用的，因为 $F(Q)$ 是 $Q$ 的单调函数。由于在所有测试用例中都有 $p_{\\text{in}} > p_{\\text{out}}$，我们预期 $Q > 0$。$Q$ 的增加会导致更大的压力降，从而减小 $p(L;Q)$ 的值。因此，$F(Q)$ 是 $Q$ 的单调递减函数。这保证了根的唯一性以及二分法的成功，前提是能找到一个有效的初始区间 $[Q_a, Q_b]$ 使得 $F(Q_a) > 0$ 且 $F(Q_b)  0$。\n\n一个合适的括号区间可以按如下方式建立：\n1.  下界：$Q_a = 0$。在这种情况下，$dp/dx = 0$，所以 $p(L;0) = p_{\\text{in}}$。失配函数为 $F(0) = p_{\\text{in}} - p_{\\text{out}}$，对于所有给定的测试用例，该值都为正。\n2.  上界：$Q_b$ 必须选择得足够大，以确保 $p(L;Q_b)  p_{\\text{out}}$，从而使 $F(Q_b)$ 为负。找到这样一个 $Q_b$ 的一个安全方法是计算等效刚性管的流量，$Q_{\\text{rigid}} = \\frac{\\pi R_0^4 (p_{\\text{in}}-p_{\\text{out}})}{8\\mu L}$，然后选择 $Q_b$ 为该估计值的倍数（例如，$10 \\times Q_{\\text{rigid}}$）。这通常足以引起足够大的压力降。\n\n二分法算法通过重复二分区间 $[Q_a, Q_b]$ 并选择根必须所在的子区间来进行。在每次迭代中，我们计算中点 $Q_{\\text{mid}} = (Q_a + Q_b)/2$ 并评估 $F(Q_{\\text{mid}})$。根据 $F(Q_{\\text{mid}})$ 的符号更新区间。当满足收敛准则时，过程终止，问题将该准则定义为压力失配的绝对公差：\n$$\n|p(L;Q_{\\text{mid}}) - p_{\\text{out}}|  \\varepsilon_p\n$$\n其中 $\\varepsilon_p = 10^{-3}$ 帕斯卡。\n\n实现过程结合了这些组件。一个主函数遍历所提供的测试用例。对于每个用例，它调用一个实现二分法的函数。该函数又在每次迭代中调用 RK4 积分例程来评估失配函数 $F(Q)$。然后，为每个用例计算出的最终 $Q$ 值按要求进行格式化和打印。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for the flow rate Q for all test cases and print results.\n    \"\"\"\n\n    # Absolute pressure tolerance for the bisection method stopping criterion.\n    P_TOL = 1e-3\n\n    def compliance_law(p, R0, p0, c):\n        \"\"\"\n        Calculates the tube radius R as a function of local pressure p.\n        R(p) = R0 * [1 + c * (p - p0)]\n        \"\"\"\n        return R0 * (1.0 + c * (p - p0))\n\n    def dp_dx(p, Q, mu, R0, p0, c):\n        \"\"\"\n        Calculates the pressure gradient dp/dx at a given pressure p and flow rate Q.\n        dp/dx = -8*mu*Q / (pi * R(p)^4)\n        \"\"\"\n        R_p = compliance_law(p, R0, p0, c)\n        # The problem parameters ensure R_p is always positive.\n        return -8.0 * mu * Q / (np.pi * R_p**4)\n\n    def rk4_integrate(Q, L, N, p_in, mu, R0, p0, c):\n        \"\"\"\n        Integrates the pressure ODE from x=0 to x=L using the RK4 method.\n        Returns the pressure at the outlet, p(L).\n        \"\"\"\n        h = float(L) / N\n        p_current = float(p_in)\n        \n        for _ in range(N):\n            k1 = dp_dx(p_current, Q, mu, R0, p0, c)\n            k2 = dp_dx(p_current + 0.5 * h * k1, Q, mu, R0, p0, c)\n            k3 = dp_dx(p_current + 0.5 * h * k2, Q, mu, R0, p0, c)\n            k4 = dp_dx(p_current + h * k3, Q, mu, R0, p0, c)\n            p_current += (h / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n        \n        return p_current\n\n    def find_Q(params):\n        \"\"\"\n        Finds the flow rate Q using a shooting method with bisection.\n        The root finding is on the mismatch function F(Q) = p(L;Q) - p_out.\n        \"\"\"\n        L, R0, mu, p0, p_in, p_out, c, N = params\n\n        # Mismatch function for root finding.\n        def F(Q_trial):\n            p_L = rk4_integrate(Q_trial, L, N, p_in, mu, R0, p0, c)\n            return p_L - p_out\n\n        # Bisection method requires a bracket [q_low, q_high] where F(q_low) and F(q_high) have opposite signs.\n        # For Q=0, dp/dx=0, so p(L)=p_in. F(0) = p_in - p_out > 0 for all test cases.\n        q_low = 0.0\n        f_low = p_in - p_out\n        \n        # Estimate an upper bound for Q based on the rigid tube case.\n        # A multiple of this Q should cause a large pressure drop, making F(q_high)  0.\n        if p_in > p_out:\n            # A safety factor of 10 is generally sufficient.\n            q_rigid_est = (np.pi * R0**4 * (p_in - p_out)) / (8.0 * mu * L) if L > 0 else 0\n            q_high = q_rigid_est * 10.0 if q_rigid_est > 0 else 1e-4\n        else:\n            # If no pressure drop, flow rate must be zero.\n            return 0.0\n        \n        # Ensure the initial bracket is valid.\n        f_high = F(q_high)\n        max_bracket_searches = 10\n        for _ in range(max_bracket_searches):\n            if f_high  0:\n                break\n            q_high *= 2.0\n            f_high = F(q_high)\n        else: # If loop completes without break\n            raise RuntimeError(\"Failed to establish a valid bracket for Q.\")\n\n        # Bisection loop\n        max_iter = 100\n        for _ in range(max_iter):\n            q_mid = (q_low + q_high) / 2.0\n            if q_mid == q_low or q_mid == q_high: # Interval is too small\n                break\n            \n            f_mid = F(q_mid)\n            \n            # Stop if the pressure mismatch is within tolerance.\n            if abs(f_mid)  P_TOL:\n                return q_mid\n            \n            # Update the bracket.\n            if np.sign(f_mid) == np.sign(f_low):\n                q_low = q_mid\n                f_low = f_mid\n            else:\n                q_high = q_mid\n                f_high = f_mid\n        \n        return (q_low + q_high) / 2.0 # Return the best estimate.\n\n    # Test suite parameters: (L, R0, mu, p0, p_in, p_out, c, N)\n    test_cases = [\n        # Case 1: General compliant tube\n        (0.5, 2.5e-3, 3.5e-3, 1.0e4, 1.33e4, 1.0e4, 2.0e-5, 2000),\n        # Case 2: Rigid tube boundary case\n        (0.5, 2.5e-3, 3.5e-3, 1.0e4, 1.33e4, 1.0e4, 0.0, 2000),\n        # Case 3: High-compliance tube\n        (0.5, 2.5e-3, 3.5e-3, 1.0e4, 1.33e4, 1.0e4, 8.0e-5, 2000),\n        # Case 4: Short tube with small pressure drop\n        (0.05, 1.5e-3, 3.5e-3, 1.0e4, 1.05e4, 1.0e4, 5.0e-5, 1000),\n    ]\n\n    results = []\n    for case in test_cases:\n        q_val = find_Q(case)\n        results.append(f\"{q_val:.6e}\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "理论模型的准确性最终取决于我们输入数据的质量。本练习探讨了测量不确定性，特别是血管半径 $R_{\\mathrm{m}}$ 的测量误差，如何显著影响我们推断出的流体粘度 $\\mu$ 。通过进行灵敏度分析，您将学会量化这种误差的传播与放大效应，并理解精确测量在生物力学实验中的至关重要性。",
            "id": "4199106",
            "problem": "在一个生物力学实验中，一段圆柱形血管承载着牛顿流体的稳定、轴对称流动，该流动由入口压力 $p_{\\mathrm{in}}$ 和出口压力 $p_{\\mathrm{out}}$ 之间的压降驱动，作用在已知长度 $L$ 上。您希望通过测量体积流量 $Q$、压力边界值 $p_{\\mathrm{in}}$ 和 $p_{\\mathrm{out}}$ 以及通过成像获得的半径来推断流体的动力粘度 $\\mu$。考虑两种模型：\n\n- 刚性管模型：其中半径在空间上和压力上都是独立的，等于成像半径 $R_{\\mathrm{m}}$。\n\n- 柔性管模型：其中血管是一个薄壁线性弹性管，其管定律为 $R(p) = R_{0}\\,(1+\\beta\\,p)$，其中 $R_{0}$ 是零跨壁压半径，$\\beta$ 是已知的柔度系数（单位为压力的倒数），$p$ 是局部跨壁压。在校准压力 $p_{\\mathrm{c}}$ 下测得的半径为 $R_{\\mathrm{m}} = R_{0}\\,(1+\\beta\\,p_{\\mathrm{c}})$。\n\n从不可压缩牛顿流体在圆管中稳定、充分发展、层流流动的假设出发，并基于粘性剪切和压力梯度之间的平衡，推导所需表达式，以消除柔性管中未知的轴向压力分布，并获得 $\\mu$ 作为 $Q$、$L$、$p_{\\mathrm{in}}$、$p_{\\mathrm{out}}$、$R_{0}$ 和 $\\beta$ 的函数。使用这些表达式，计算对于刚性和柔性两种模型，推断出的粘度对测量半径 $R_{\\mathrm{m}}$ 中微小校准误差的对数灵敏度\n$$\nS_{R} := \\frac{\\partial \\ln \\mu}{\\partial \\ln R_{\\mathrm{m}}}\n$$\n（假设 $\\beta$ 精确已知）。然后，对于推断粘度的相对误差目标界限 $\\varepsilon_{\\mathrm{t}} = 0.05$，确定推荐的最大允许半径相对校准误差 $\\tau$，使得在两种模型中，当 $|\\delta R_{\\mathrm{m}}|/R_{\\mathrm{m}} \\leq \\tau$ 时，能保证 $|\\delta \\mu|/\\mu \\leq \\varepsilon_{\\mathrm{t}}$。\n\n将最终推荐的公差 $\\tau$ 表示为小数，并将您的答案四舍五入到四位有效数字。$\\tau$ 无需单位。",
            "solution": "用户要求推导刚性管和柔性管模型中推断粘度的表达式，计算粘度对半径测量误差的对数灵敏度，并确定最大允许半径误差公差。\n\n首先验证问题。\n\n### 步骤 1：提取已知条件\n-   **系统参数**：牛顿流体的稳定、轴对称流动；在长度 $L$ 上的压降从 $p_{\\mathrm{in}}$ 到 $p_{\\mathrm{out}}$。\n-   **测量量**：体积流量 $Q$，入口压力 $p_{\\mathrm{in}}$，出口压力 $p_{\\mathrm{out}}$，成像半径 $R_{\\mathrm{m}}$。\n-   **未知量**：动力粘度 $\\mu$。\n-   **刚性管模型**：管半径恒定且等于 $R_{\\mathrm{m}}$。\n-   **柔性管模型**：\n    -   管定律：$R(p) = R_{0}\\,(1+\\beta\\,p)$，其中 $p$ 是局部跨壁压。\n    -   $R_{0}$ 是零压半径。\n    -   $\\beta$ 是已知的柔度系数。\n    -   校准测量：在已知校准压力 $p_{\\mathrm{c}}$ 下，$R_{\\mathrm{m}} = R_{0}\\,(1+\\beta\\,p_{\\mathrm{c}})$。\n-   **任务**：\n    1.  在柔性管情况下，推导 $\\mu$ 作为 $Q$、$L$、$p_{\\mathrm{in}}$、$p_{\\mathrm{out}}$、$R_{0}$ 和 $\\beta$ 的函数表达式。\n    2.  为两种模型计算对数灵敏度 $S_{R} := \\frac{\\partial \\ln \\mu}{\\partial \\ln R_{\\mathrm{m}}}$。\n    3.  对于粘度的目标相对误差界限 $\\varepsilon_{\\mathrm{t}} = 0.05$（意味着 $|\\delta \\mu|/\\mu \\leq \\varepsilon_{\\mathrm{t}}$），确定最大允许的半径相对校准误差 $\\tau$，使得当 $|\\delta R_{\\mathrm{m}}|/R_{\\mathrm{m}} \\leq \\tau$ 时成立。\n    4.  将 $\\tau$ 表示为小数，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题根植于流体动力学（Hagen-Poiseuille 流动）和固体力学（线性弹性）的基本原理。这些是生物力学中使用的标准、无争议的模型。\n-   **适定性**：该问题是适定的。它提供了足够的信息来推导所要求的量。变量之间的关系定义清晰，从而可以得到唯一解。\n-   **客观性**：问题以清晰、客观的语言陈述，没有歧义或主观论断。\n-   **结论**：根据验证清单，没有发现任何可识别的缺陷。该问题有效。\n\n### 步骤 3：结论与行动\n该问题有效，可以按陈述求解。\n\n### 解题推导\n\n两种模型的分析都始于 Hagen-Poiseuille 方程，该方程描述了不可压缩牛顿流体在圆管中的稳定层流。它将体积流量 $Q$ 与压力梯度 $\\frac{dp}{dx}$、流体粘度 $\\mu$ 和管半径 $R$ 联系起来。\n\n#### 刚性管模型\n在刚性管模型中，半径沿管长恒定，$R = R_{\\mathrm{m}}$。压力梯度也是恒定的：$\\frac{dp}{dx} = -\\frac{p_{\\mathrm{in}}-p_{\\mathrm{out}}}{L}$。Hagen-Poiseuille 方程为：\n$$\nQ = \\frac{\\pi R_{\\mathrm{m}}^4}{8 \\mu} \\frac{p_{\\mathrm{in}}-p_{\\mathrm{out}}}{L}\n$$\n求解推断的粘度 $\\mu_{\\mathrm{rigid}}$：\n$$\n\\mu_{\\mathrm{rigid}} = \\frac{\\pi R_{\\mathrm{m}}^4 (p_{\\mathrm{in}} - p_{\\mathrm{out}})}{8 Q L}\n$$\n为了求出对数灵敏度，我们首先取自然对数：\n$$\n\\ln(\\mu_{\\mathrm{rigid}}) = \\ln\\left(\\frac{\\pi (p_{\\mathrm{in}} - p_{\\mathrm{out}})}{8 Q L}\\right) + 4 \\ln(R_{\\mathrm{m}})\n$$\n对数灵敏度 $S_R$ 定义为 $S_{R} = \\frac{\\partial \\ln \\mu}{\\partial \\ln R_{\\mathrm{m}}}$。对于刚性模型，除了最后一项，所有项都与 $R_{\\mathrm{m}}$ 无关：\n$$\nS_{R, \\mathrm{rigid}} = \\frac{\\partial}{\\partial \\ln R_{\\mathrm{m}}} \\left( \\ln(\\text{const.}) + 4 \\ln(R_{\\mathrm{m}}) \\right) = 4\n$$\n\n#### 柔性管模型\n在柔性管模型中，半径 $R$ 是局部压力 $p$ 的函数，而压力 $p$ 随轴向位置 $x$ 变化。Hagen-Poiseuille 关系的局部形式为：\n$$\nQ = -\\frac{\\pi R(p)^4}{8 \\mu} \\frac{dp}{dx}\n$$\n负号表示压力随 $x$ 的增加而减小。我们已知管定律 $R(p) = R_{0}\\,(1+\\beta\\,p)$。将其代入方程中得到：\n$$\nQ = -\\frac{\\pi (R_{0}(1+\\beta p))^4}{8 \\mu} \\frac{dp}{dx} = -\\frac{\\pi R_{0}^4}{8 \\mu} (1+\\beta p)^4 \\frac{dp}{dx}\n$$\n这是一个可分离的常微分方程。我们重新整理以分离变量 $p$ 和 $x$：\n$$\n8 \\mu Q \\, dx = -\\pi R_{0}^4 (1+\\beta p)^4 \\, dp\n$$\n我们对两边进行积分。左边从 $x=0$ 积分到 $x=L$。右边对相应的压力从 $p=p_{\\mathrm{in}}$ 积分到 $p=p_{\\mathrm{out}}$：\n$$\n\\int_0^L 8 \\mu Q \\, dx = -\\int_{p_{\\mathrm{in}}}^{p_{\\mathrm{out}}} \\pi R_{0}^4 (1+\\beta p)^4 \\, dp\n$$\n由于 $Q$、$\\mu$ 和 $R_0$ 相对于积分变量是常数：\n$$\n8 \\mu Q L = -\\pi R_{0}^4 \\int_{p_{\\mathrm{in}}}^{p_{\\mathrm{out}}} (1+\\beta p)^4 \\, dp\n$$\n右边的积分为：\n$$\n\\int_{p_{\\mathrm{in}}}^{p_{\\mathrm{out}}} (1+\\beta p)^4 \\, dp = \\left[ \\frac{(1+\\beta p)^5}{5\\beta} \\right]_{p_{\\mathrm{in}}}^{p_{\\mathrm{out}}} = \\frac{(1+\\beta p_{\\mathrm{out}})^5 - (1+\\beta p_{\\mathrm{in}})^5}{5\\beta}\n$$\n将此结果代回积分后的方程中：\n$$\n8 \\mu Q L = -\\pi R_{0}^4 \\left( \\frac{(1+\\beta p_{\\mathrm{out}})^5 - (1+\\beta p_{\\mathrm{in}})^5}{5\\beta} \\right) = \\frac{\\pi R_{0}^4}{5\\beta} \\left( (1+\\beta p_{\\mathrm{in}})^5 - (1+\\beta p_{\\mathrm{out}})^5 \\right)\n$$\n求解 $\\mu_{\\mathrm{compliant}}$ 得到第一个要求的表达式：\n$$\n\\mu_{\\mathrm{compliant}} = \\frac{\\pi R_0^4}{40 Q L \\beta} \\left( (1 + \\beta p_{\\mathrm{in}})^5 - (1 + \\beta p_{\\mathrm{out}})^5 \\right)\n$$\n为了计算对 $R_{\\mathrm{m}}$ 的灵敏度，我们必须用 $R_{\\mathrm{m}}$ 来表示 $\\mu_{\\mathrm{compliant}}$。我们使用校准关系 $R_{\\mathrm{m}} = R_{0}\\,(1+\\beta\\,p_{\\mathrm{c}})$，这意味着 $R_0 = \\frac{R_{\\mathrm{m}}}{1+\\beta p_{\\mathrm{c}}}$。将此代入 $R_0$：\n$$\n\\mu_{\\mathrm{compliant}} = \\frac{\\pi}{40 Q L \\beta} \\left( \\frac{R_{\\mathrm{m}}}{1+\\beta p_{\\mathrm{c}}} \\right)^4 \\left( (1 + \\beta p_{\\mathrm{in}})^5 - (1 + \\beta p_{\\mathrm{out}})^5 \\right)\n$$\n现在我们求对数灵敏度。取自然对数：\n$$\n\\ln(\\mu_{\\mathrm{compliant}}) = \\ln\\left( \\frac{\\pi \\left( (1+\\beta p_{\\mathrm{in}})^5 - (1+\\beta p_{\\mathrm{out}})^5 \\right)}{40 Q L \\beta (1+\\beta p_{\\mathrm{c}})^4} \\right) + 4 \\ln(R_{\\mathrm{m}})\n$$\n对于此偏微分，除 $R_{\\mathrm{m}}$ 外的所有量均视为固定值（$\\beta$ 精确已知，`p_c` 是一个固定的校准参数）。第一项是关于 $R_{\\mathrm{m}}$ 的常数。对 $\\ln(R_{\\mathrm{m}})$ 求导：\n$$\nS_{R, \\mathrm{compliant}} = \\frac{\\partial \\ln \\mu_{\\mathrm{compliant}}}{\\partial \\ln R_{\\mathrm{m}}} = 4\n$$\n刚性和柔性模型的对数灵敏度均为 $4$。\n\n#### 误差公差计算\n对数灵敏度关联了 $\\mu$ 和 $R_{\\mathrm{m}}$ 的微小相对误差。对于微小的有限变化量 $\\delta \\mu$ 和 $\\delta R_{\\mathrm{m}}$，我们有近似关系：\n$$\n\\frac{\\delta \\mu}{\\mu} \\approx S_{R} \\frac{\\delta R_{\\mathrm{m}}}{R_{\\mathrm{m}}}\n$$\n取绝对值：\n$$\n\\left| \\frac{\\delta \\mu}{\\mu} \\right| \\approx |S_{R}| \\left| \\frac{\\delta R_{\\mathrm{m}}}{R_{\\mathrm{m}}} \\right|\n$$\n由于两种模型的 $S_{R} = 4$，因此分析过程完全相同。我们给定了粘度相对误差的目标界限 $\\varepsilon_{\\mathrm{t}} = 0.05$，即 $|\\delta \\mu|/\\mu \\leq \\varepsilon_{\\mathrm{t}}$。我们需要找到最大允许的半径相对误差 $\\tau$，使得如果 $|\\delta R_{\\mathrm{m}}|/R_{\\mathrm{m}} \\leq \\tau$，则满足粘度误差的条件。\n代入数值和定义：\n$$\n\\varepsilon_{\\mathrm{t}} \\geq \\left| \\frac{\\delta \\mu}{\\mu} \\right| \\approx 4 \\left| \\frac{\\delta R_{\\mathrm{m}}}{R_{\\mathrm{m}}} \\right|\n$$\n为保证该条件成立，我们要求：\n$$\n4 \\left| \\frac{\\delta R_{\\mathrm{m}}}{R_{\\mathrm{m}}} \\right| \\leq \\varepsilon_{\\mathrm{t}}\n$$\n这意味着：\n$$\n\\left| \\frac{\\delta R_{\\mathrm{m}}}{R_{\\mathrm{m}}} \\right| \\leq \\frac{\\varepsilon_{\\mathrm{t}}}{4}\n$$\n因此，最大允许相对误差 $\\tau$ 是此不等式的上界。\n$$\n\\tau = \\frac{\\varepsilon_{\\mathrm{t}}}{4}\n$$\n代入给定值 $\\varepsilon_{\\mathrm{t}} = 0.05$：\n$$\n\\tau = \\frac{0.05}{4} = 0.0125\n$$\n题目要求将此值表示为小数，并四舍五入到四位有效数字。数字 $0.0125$ 有三位有效数字（$1$、$2$、$5$）。要将其表示为四位有效数字，我们必须在末尾添加一个零，在这种情况下，这个零是有效的。\n$$\n\\tau = 0.01250\n$$\n这表示为确保推断的粘度误差不超过 $5\\%$ 而推荐的最大公差。",
            "answer": "$$\n\\boxed{0.01250}\n$$"
        }
    ]
}