{
    "hands_on_practices": [
        {
            "introduction": "To build a robust understanding of fluid flow in biological systems, we begin with the foundational case: steady, laminar flow through a rigid, circular tube. This exercise guides you through the derivation of the celebrated Hagen-Poiseuille equation directly from the Navier-Stokes equations, the fundamental law of fluid motion. By applying appropriate simplifying assumptions, you will reveal the elegant linear relationship between pressure drop $ \\Delta p $ and volumetric flow rate $ Q $, and in doing so, define the concept of hydraulic resistance $ R_h $ . This first-principles derivation is a cornerstone of fluid biomechanics, providing a baseline model upon which more complex scenarios are built.",
            "id": "4199141",
            "problem": "Consider steady, incompressible, laminar flow of a Newtonian fluid through a long, straight, circular tube that is mechanically rigid (radius does not depend on pressure). The tube has length $L$ and constant radius $R$. The fluid has dynamic viscosity $\\mu$. Assume axisymmetry, fully developed flow in the axial direction, and the no-slip boundary condition at the tube wall. Starting from the conservation of linear momentum (Navier–Stokes equations) in cylindrical coordinates under these assumptions, derive the linear relationship between the axial pressure drop $\\Delta p$ along the tube and the volumetric flow rate $Q$. Express this relationship in terms of a hydraulic resistance $R_h$ defined entirely by the tube geometry and fluid viscosity. Then, using your derived expressions, compute the pressure drop $\\Delta p$ for the following parameter values: $\\mu = 3.5 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$, $L = 0.30\\ \\text{m}$, $R = 2.5 \\times 10^{-3}\\ \\text{m}$, and $Q = 3.0 \\times 10^{-6}\\ \\text{m}^{3}\\cdot\\text{s}^{-1}$. Round your final numerical result to four significant figures and express the final pressure drop in kilopascals.",
            "solution": "The user wants me to solve a fluid mechanics problem, so I will start by validating the problem statement.\n\n### Step 1: Extract Givens\n-   **Flow conditions**: steady, incompressible, laminar.\n-   **Fluid**: Newtonian, with dynamic viscosity $\\mu$.\n-   **Tube geometry**: long, straight, circular, mechanically rigid, length $L$, constant radius $R$.\n-   **Assumptions**: axisymmetry, fully developed flow in the axial direction, no-slip boundary condition at the tube wall ($r=R$).\n-   **Task 1**: Derive the linear relationship between axial pressure drop $\\Delta p$ and volumetric flow rate $Q$.\n-   **Task 2**: Express this relationship using a hydraulic resistance $R_h$ defined by tube geometry and fluid viscosity.\n-   **Task 3**: Compute $\\Delta p$ for the following parameter values:\n    -   $\\mu = 3.5 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$\n    -   $L = 0.30\\ \\text{m}$\n    -   $R = 2.5 \\times 10^{-3}\\ \\text{m}$\n    -   $Q = 3.0 \\times 10^{-6}\\ \\text{m}^{3}\\cdot\\text{s}^{-1}$\n-   **Output requirements**: Round the final numerical result to four significant figures and express it in kilopascals.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific Grounding**: The problem describes Hagen-Poiseuille flow, a canonical and fundamental solution to the Navier-Stokes equations. All assumptions and principles are standard in fluid mechanics. The problem is scientifically sound.\n2.  **Well-Posedness**: The problem is well-posed. The derivation is a standard textbook exercise, and given the inputs, a unique, stable solution for the pressure drop exists.\n3.  **Objectivity**: The problem is stated using clear, precise, and standard scientific terminology. There is no ambiguity or subjectivity.\n4.  **Completeness and Consistency**: The problem provides all necessary information to perform the derivation and the calculation. There are no contradictions. To verify the laminar flow assumption, we can estimate the Reynolds number, $Re = \\frac{\\rho U D}{\\mu}$, where $U$ is the average velocity and $D=2R$ is the diameter. The average velocity is $U = \\frac{Q}{A} = \\frac{Q}{\\pi R^2} = \\frac{3.0 \\times 10^{-6}\\ \\text{m}^3/\\text{s}}{\\pi (2.5 \\times 10^{-3}\\ \\text{m})^2} \\approx 0.153\\ \\text{m}/\\text{s}$. Assuming the fluid is similar to blood, its density would be $\\rho \\approx 1060\\ \\text{kg}/\\text{m}^3$. The Reynolds number is then $Re \\approx \\frac{(1060\\ \\text{kg}/\\text{m}^3)(0.153\\ \\text{m}/\\text{s})(2 \\times 2.5 \\times 10^{-3}\\ \\text{m})}{3.5 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}} \\approx 232$. Since $232 \\ll 2300$ (the typical critical value for pipe flow), the laminar flow assumption is fully consistent with the given parameters.\n5.  **Plausibility**: The numerical values are physically realistic, corresponding to, for example, blood flow in a small artery.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, and all provided data are consistent and complete. I will proceed with the solution.\n\nThe derivation begins with the conservation of linear momentum for an incompressible Newtonian fluid, expressed by the Navier-Stokes equations. In cylindrical coordinates $(r, \\theta, z)$, the axial ($z$-) momentum equation is:\n$$\n\\rho \\left( \\frac{\\partial v_z}{\\partial t} + v_r \\frac{\\partial v_z}{\\partial r} + \\frac{v_\\theta}{r} \\frac{\\partial v_z}{\\partial \\theta} + v_z \\frac{\\partial v_z}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial z} + \\mu \\left[ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial v_z}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2 v_z}{\\partial \\theta^2} + \\frac{\\partial^2 v_z}{\\partial z^2} \\right] + \\rho g_z\n$$\nWe apply the given assumptions to simplify this equation:\n1.  **Steady flow**: $\\frac{\\partial}{\\partial t} = 0$.\n2.  **Axisymmetry**: $\\frac{\\partial}{\\partial \\theta} = 0$, which also implies the tangential velocity $v_\\theta = 0$.\n3.  **No flow in the radial direction**: For a straight pipe of constant radius, $v_r = 0$.\n4.  **Fully developed flow**: The velocity profile is constant along the axial direction, so $\\frac{\\partial v_z}{\\partial z} = 0$. This also satisfies the continuity equation for incompressible flow, $\\frac{1}{r}\\frac{\\partial(r v_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial v_\\theta}{\\partial \\theta} + \\frac{\\partial v_z}{\\partial z} = 0$, which simplifies to $\\frac{\\partial v_z}{\\partial z} = 0$.\nWe also neglect gravitational effects, setting $g_z=0$, or assume a horizontal tube.\n\nApplying these simplifications, all terms on the left-hand side (the convective acceleration terms) and several terms on the right-hand side become zero. The axial momentum equation reduces to:\n$$\n0 = -\\frac{\\partial p}{\\partial z} + \\mu \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial v_z}{\\partial r} \\right)\n$$\nSince $v_z$ is a function of $r$ only, $v_z = v_z(r)$, the partial derivatives with respect to $r$ can be written as ordinary derivatives. For fully developed flow, the pressure gradient $\\frac{\\partial p}{\\partial z}$ cannot be a function of $r$, and since the flow is steady, it cannot be a function of $t$. Thus, $\\frac{\\partial p}{\\partial z}$ can only be a function of $z$ or a constant. However, the right-hand side of the equation is a function of $r$ only. For the equality to hold for all $r$ and $z$, both sides must be equal to the same constant. Let's write $\\frac{dp}{dz} = \\text{constant}$.\nRearranging the equation:\n$$\n\\frac{1}{\\mu} \\frac{dp}{dz} = \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dv_z}{dr} \\right)\n$$\nWe integrate this equation with respect to $r$:\n$$\n\\int r \\frac{1}{\\mu} \\frac{dp}{dz} dr = \\int \\frac{d}{dr} \\left( r \\frac{dv_z}{dr} \\right) dr\n$$\n$$\n\\frac{r^2}{2\\mu} \\frac{dp}{dz} = r \\frac{dv_z}{dr} + C_1\n$$\nDue to axisymmetry, the velocity profile must be smooth at the centerline ($r=0$), which requires the velocity gradient to be zero: $\\left. \\frac{dv_z}{dr} \\right|_{r=0} = 0$. For the term $\\frac{C_1}{r}$ (which would arise from isolating $\\frac{dv_z}{dr}$) to be finite at $r=0$, the integration constant $C_1$ must be zero.\nSo, the equation becomes:\n$$\n\\frac{dv_z}{dr} = \\frac{r}{2\\mu} \\frac{dp}{dz}\n$$\nIntegrating a second time with respect to $r$:\n$$\nv_z(r) = \\int \\frac{r}{2\\mu} \\frac{dp}{dz} dr = \\frac{r^2}{4\\mu} \\frac{dp}{dz} + C_2\n$$\nWe find the second integration constant, $C_2$, by applying the no-slip boundary condition at the tube wall: $v_z(R) = 0$.\n$$\n0 = \\frac{R^2}{4\\mu} \\frac{dp}{dz} + C_2 \\implies C_2 = -\\frac{R^2}{4\\mu} \\frac{dp}{dz}\n$$\nSubstituting $C_2$ back gives the parabolic velocity profile:\n$$\nv_z(r) = \\frac{1}{4\\mu} \\frac{dp}{dz} (r^2 - R^2)\n$$\nSince flow is in the positive $z$-direction ($v_z > 0$) and $r^2 - R^2 \\le 0$, the pressure gradient $\\frac{dp}{dz}$ must be negative.\n\nNext, we calculate the volumetric flow rate $Q$ by integrating the velocity profile over the tube's cross-sectional area $A$:\n$$\nQ = \\int_A v_z(r) dA = \\int_0^R v_z(r) (2\\pi r) dr\n$$\n$$\nQ = \\int_0^R \\frac{1}{4\\mu} \\frac{dp}{dz} (r^2 - R^2) (2\\pi r) dr = \\frac{2\\pi}{4\\mu} \\frac{dp}{dz} \\int_0^R (r^3 - R^2 r) dr\n$$\n$$\nQ = \\frac{\\pi}{2\\mu} \\frac{dp}{dz} \\left[ \\frac{r^4}{4} - \\frac{R^2 r^2}{2} \\right]_0^R = \\frac{\\pi}{2\\mu} \\frac{dp}{dz} \\left( \\frac{R^4}{4} - \\frac{R^4}{2} \\right) = \\frac{\\pi}{2\\mu} \\frac{dp}{dz} \\left( -\\frac{R^4}{4} \\right)\n$$\n$$\nQ = -\\frac{\\pi R^4}{8\\mu} \\frac{dp}{dz}\n$$\nThis is the Hagen-Poiseuille equation. The constant pressure gradient can be expressed in terms of the pressure drop $\\Delta p = p_{inlet} - p_{outlet}$ over the tube length $L$ as $\\frac{dp}{dz} = -\\frac{\\Delta p}{L}$. Substituting this into the equation for $Q$:\n$$\nQ = -\\frac{\\pi R^4}{8\\mu} \\left( -\\frac{\\Delta p}{L} \\right) = \\frac{\\pi R^4}{8\\mu L} \\Delta p\n$$\nRearranging to show the linear relationship between $\\Delta p$ and $Q$:\n$$\n\\Delta p = \\left( \\frac{8\\mu L}{\\pi R^4} \\right) Q\n$$\nThis is of the form $\\Delta p = R_h Q$, where the hydraulic resistance $R_h$ is given by:\n$$\nR_h = \\frac{8\\mu L}{\\pi R^4}\n$$\nThis expression for $R_h$ depends only on the fluid viscosity $\\mu$ and the tube geometry ($L$ and $R$), as required.\n\nFinally, we compute the numerical value for the pressure drop $\\Delta p$ using the provided parameters:\n$\\mu = 3.5 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$\n$L = 0.30\\ \\text{m}$\n$R = 2.5 \\times 10^{-3}\\ \\text{m}$\n$Q = 3.0 \\times 10^{-6}\\ \\text{m}^{3}\\cdot\\text{s}^{-1}$\n\nUsing the derived formula $\\Delta p = \\frac{8\\mu L Q}{\\pi R^4}$:\n$$\n\\Delta p = \\frac{8 (3.5 \\times 10^{-3}) (0.30) (3.0 \\times 10^{-6})}{\\pi (2.5 \\times 10^{-3})^4}\n$$\n$$\n\\Delta p = \\frac{2.52 \\times 10^{-8}}{\\pi (3.90625 \\times 10^{-11})} \\ \\text{Pa}\n$$\n$$\n\\Delta p = \\frac{2.52 \\times 10^{-8}}{1.2271846... \\times 10^{-10}} \\ \\text{Pa} \\approx 205.349\\ \\text{Pa}\n$$\nThe problem requires the answer in kilopascals (kPa). Since $1\\ \\text{kPa} = 1000\\ \\text{Pa}$, we have:\n$$\n\\Delta p \\approx 0.205349\\ \\text{kPa}\n$$\nRounding to four significant figures, the pressure drop is $0.2053\\ \\text{kPa}$.",
            "answer": "$$\\boxed{0.2053}$$"
        },
        {
            "introduction": "Real biological vessels are compliant, not rigid; their dimensions change with pressure. This practice introduces this complexity by modeling a linearly elastic tube, a crucial step towards more realistic physiological models. More importantly, it delves into the practical reality of experimental work by asking you to perform a sensitivity analysis . You will determine how a small error in an experimental measurement, such as the vessel radius, propagates to affect the inferred value of a physical property like viscosity. This analysis reveals the profound impact of the radius, which scales with the fourth power in Poiseuille's law, and provides a quantitative basis for setting measurement tolerances in experimental design.",
            "id": "4199106",
            "problem": "A cylindrical vessel segment in a biomechanical experiment carries a steady, axisymmetric flow of a Newtonian fluid under a pressure drop between an inlet pressure $p_{\\mathrm{in}}$ and an outlet pressure $p_{\\mathrm{out}}$, over a known length $L$. You wish to infer the dynamic viscosity $\\mu$ from measurements of volumetric flow rate $Q$, pressure boundary values $p_{\\mathrm{in}}$ and $p_{\\mathrm{out}}$, and a radius measurement obtained by imaging. Consider two models:\n\n- A rigid-tube model in which the radius is spatially and pressure independent and equal to the imaged radius $R_{\\mathrm{m}}$.\n\n- A compliant-tube model in which the vessel is a thin-walled, linearly elastic tube with a tube law $R(p) = R_{0}\\,(1+\\beta\\,p)$, where $R_{0}$ is the zero-transmural-pressure radius, $\\beta$ is a known compliance coefficient (with units of inverse pressure), and $p$ is the local transmural pressure. The measured radius at a calibration pressure $p_{\\mathrm{c}}$ is $R_{\\mathrm{m}} = R_{0}\\,(1+\\beta\\,p_{\\mathrm{c}})$.\n\nStarting from the assumptions of steady, fully developed, laminar flow of an incompressible Newtonian fluid in a circular tube and the balance between viscous shear and pressure gradient, derive the expressions needed to eliminate the unknown axial pressure profile in the compliant tube and obtain $\\mu$ as a function of $Q$, $L$, $p_{\\mathrm{in}}$, $p_{\\mathrm{out}}$, $R_{0}$, and $\\beta$. Using these expressions, compute the logarithmic sensitivity\n$$\nS_{R} := \\frac{\\partial \\ln \\mu}{\\partial \\ln R_{\\mathrm{m}}}\n$$\nof the inferred viscosity to a small calibration error in the measured radius $R_{\\mathrm{m}}$ for both the rigid and compliant models (assume $\\beta$ is known exactly). Then, for a target bound on the relative error in the inferred viscosity of $\\varepsilon_{\\mathrm{t}} = 0.05$, determine the recommended maximum allowable relative calibration error in radius, denoted by $\\tau$, such that $|\\delta \\mu|/\\mu \\leq \\varepsilon_{\\mathrm{t}}$ is guaranteed when $|\\delta R_{\\mathrm{m}}|/R_{\\mathrm{m}} \\leq \\tau$ in both models.\n\nExpress the final recommended tolerance $\\tau$ as a decimal and round your answer to four significant figures. No units are required for $\\tau$.",
            "solution": "The user has requested the derivation of expressions for inferred viscosity in rigid and compliant tube models, the calculation of the logarithmic sensitivity of viscosity to radius measurement error, and the determination of a maximum allowable radius error tolerance.\n\nThe problem is first validated.\n\n### Step 1: Extract Givens\n-   **System parameters**: STEADY, axisymmetric flow of a Newtonian fluid; pressure drop from $p_{\\mathrm{in}}$ to $p_{\\mathrm{out}}$ over length $L$.\n-   **Measured quantities**: Volumetric flow rate $Q$, inlet pressure $p_{\\mathrm{in}}$, outlet pressure $p_{\\mathrm{out}}$, imaged radius $R_{\\mathrm{m}}$.\n-   **Unknown**: Dynamic viscosity $\\mu$.\n-   **Rigid-tube model**: Tube radius is constant and equal to $R_{\\mathrm{m}}$.\n-   **Compliant-tube model**:\n    -   Tube law: $R(p) = R_{0}\\,(1+\\beta\\,p)$, where $p$ is local transmural pressure.\n    -   $R_{0}$ is the zero-pressure radius.\n    -   $\\beta$ is a known compliance coefficient.\n    -   Calibration measurement: $R_{\\mathrm{m}} = R_{0}\\,(1+\\beta\\,p_{\\mathrm{c}})$ at a known calibration pressure $p_{\\mathrm{c}}$.\n-   **Tasks**:\n    1.  Derive an expression for $\\mu$ in the compliant case as a function of $Q$, $L$, $p_{\\mathrm{in}}$, $p_{\\mathrm{out}}$, $R_{0}$, and $\\beta$.\n    2.  Compute the logarithmic sensitivity $S_{R} := \\frac{\\partial \\ln \\mu}{\\partial \\ln R_{\\mathrm{m}}}$ for both models.\n    3.  For a target relative error bound on viscosity $\\varepsilon_{\\mathrm{t}} = 0.05$ (meaning $|\\delta \\mu|/\\mu \\leq \\varepsilon_{\\mathrm{t}}$), determine the maximum allowable relative calibration error in radius, $\\tau$, such that $|\\delta R_{\\mathrm{m}}|/R_{\\mathrm{m}} \\leq \\tau$.\n    4.  Express $\\tau$ as a decimal rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Grounding**: The problem is well-grounded in the fundamental principles of fluid dynamics (Hagen-Poiseuille flow) and solid mechanics (linear elasticity). These are standard, non-controversial models used in biomechanics.\n-   **Well-Posedness**: The problem is well-posed. It provides sufficient information to derive the requested quantities. The relationships between variables are clearly defined, leading to a unique solution.\n-   **Objectivity**: The problem is stated in clear, objective language, free of ambiguity or subjective claims.\n-   **Conclusion**: There are no identifiable flaws based on the validation checklist. The problem is valid.\n\n### Step 3: Verdict and Action\nThe problem is valid and can be solved as stated.\n\n### Solution Derivation\n\nThe analysis for both models begins with the Hagen-Poiseuille equation, which describes steady, laminar flow of an incompressible Newtonian fluid in a circular tube. It relates the volumetric flow rate $Q$ to the pressure gradient $\\frac{dp}{dx}$, fluid viscosity $\\mu$, and tube radius $R$.\n\n#### Rigid-Tube Model\nIn the rigid-tube model, the radius is constant along the length of the tube, $R = R_{\\mathrm{m}}$. The pressure gradient is also constant: $\\frac{dp}{dx} = -\\frac{p_{\\mathrm{in}}-p_{\\mathrm{out}}}{L}$. The Hagen-Poiseuille equation is:\n$$\nQ = \\frac{\\pi R_{\\mathrm{m}}^4}{8 \\mu} \\frac{p_{\\mathrm{in}}-p_{\\mathrm{out}}}{L}\n$$\nSolving for the inferred viscosity, $\\mu_{\\mathrm{rigid}}$:\n$$\n\\mu_{\\mathrm{rigid}} = \\frac{\\pi R_{\\mathrm{m}}^4 (p_{\\mathrm{in}} - p_{\\mathrm{out}})}{8 Q L}\n$$\nTo find the logarithmic sensitivity, we first take the natural logarithm:\n$$\n\\ln(\\mu_{\\mathrm{rigid}}) = \\ln\\left(\\frac{\\pi (p_{\\mathrm{in}} - p_{\\mathrm{out}})}{8 Q L}\\right) + 4 \\ln(R_{\\mathrm{m}})\n$$\nThe logarithmic sensitivity $S_R$ is defined as $S_{R} = \\frac{\\partial \\ln \\mu}{\\partial \\ln R_{\\mathrm{m}}}$. For the rigid model, all terms except the last are independent of $R_{\\mathrm{m}}$:\n$$\nS_{R, \\mathrm{rigid}} = \\frac{\\partial}{\\partial \\ln R_{\\mathrm{m}}} \\left( \\ln(\\text{const.}) + 4 \\ln(R_{\\mathrm{m}}) \\right) = 4\n$$\n\n#### Compliant-Tube Model\nIn the compliant-tube model, the radius $R$ is a function of the local pressure $p$, which varies with the axial position $x$. The local form of the Hagen-Poiseuille relation is:\n$$\nQ = -\\frac{\\pi R(p)^4}{8 \\mu} \\frac{dp}{dx}\n$$\nThe negative sign indicates that pressure decreases as $x$ increases. We are given the tube law $R(p) = R_{0}\\,(1+\\beta\\,p)$. Substituting this into the equation gives:\n$$\nQ = -\\frac{\\pi (R_{0}(1+\\beta p))^4}{8 \\mu} \\frac{dp}{dx} = -\\frac{\\pi R_{0}^4}{8 \\mu} (1+\\beta p)^4 \\frac{dp}{dx}\n$$\nThis is a separable ordinary differential equation. We rearrange to separate variables $p$ and $x$:\n$$\n8 \\mu Q \\, dx = -\\pi R_{0}^4 (1+\\beta p)^4 \\, dp\n$$\nWe integrate both sides. The left side integrates from $x=0$ to $x=L$. The right side integrates over the corresponding pressures from $p=p_{\\mathrm{in}}$ to $p=p_{\\mathrm{out}}$:\n$$\n\\int_0^L 8 \\mu Q \\, dx = -\\int_{p_{\\mathrm{in}}}^{p_{\\mathrm{out}}} \\pi R_{0}^4 (1+\\beta p)^4 \\, dp\n$$\nSince $Q$, $\\mu$, and $R_0$ are constant with respect to the integration variables:\n$$\n8 \\mu Q L = -\\pi R_{0}^4 \\int_{p_{\\mathrm{in}}}^{p_{\\mathrm{out}}} (1+\\beta p)^4 \\, dp\n$$\nThe integral on the right is:\n$$\n\\int_{p_{\\mathrm{in}}}^{p_{\\mathrm{out}}} (1+\\beta p)^4 \\, dp = \\left[ \\frac{(1+\\beta p)^5}{5\\beta} \\right]_{p_{\\mathrm{in}}}^{p_{\\mathrm{out}}} = \\frac{(1+\\beta p_{\\mathrm{out}})^5 - (1+\\beta p_{\\mathrm{in}})^5}{5\\beta}\n$$\nSubstituting this back into the integrated equation:\n$$\n8 \\mu Q L = -\\pi R_{0}^4 \\left( \\frac{(1+\\beta p_{\\mathrm{out}})^5 - (1+\\beta p_{\\mathrm{in}})^5}{5\\beta} \\right) = \\frac{\\pi R_{0}^4}{5\\beta} \\left( (1+\\beta p_{\\mathrm{in}})^5 - (1+\\beta p_{\\mathrm{out}})^5 \\right)\n$$\nSolving for $\\mu_{\\mathrm{compliant}}$ gives the first required expression:\n$$\n\\mu_{\\mathrm{compliant}} = \\frac{\\pi R_0^4}{40 Q L \\beta} \\left( (1 + \\beta p_{\\mathrm{in}})^5 - (1 + \\beta p_{\\mathrm{out}})^5 \\right)\n$$\nTo calculate the sensitivity to $R_{\\mathrm{m}}$, we must express $\\mu_{\\mathrm{compliant}}$ in terms of $R_{\\mathrm{m}}$. We use the calibration relation $R_{\\mathrm{m}} = R_{0}\\,(1+\\beta\\,p_{\\mathrm{c}})$, which implies $R_0 = \\frac{R_{\\mathrm{m}}}{1+\\beta p_{\\mathrm{c}}}$. Substituting this for $R_0$:\n$$\n\\mu_{\\mathrm{compliant}} = \\frac{\\pi}{40 Q L \\beta} \\left( \\frac{R_{\\mathrm{m}}}{1+\\beta p_{\\mathrm{c}}} \\right)^4 \\left( (1 + \\beta p_{\\mathrm{in}})^5 - (1 + \\beta p_{\\mathrm{out}})^5 \\right)\n$$\nNow we find the logarithmic sensitivity. Taking the natural logarithm:\n$$\n\\ln(\\mu_{\\mathrm{compliant}}) = \\ln\\left( \\frac{\\pi \\left( (1+\\beta p_{\\mathrm{in}})^5 - (1+\\beta p_{\\mathrm{out}})^5 \\right)}{40 Q L \\beta (1+\\beta p_{\\mathrm{c}})^4} \\right) + 4 \\ln(R_{\\mathrm{m}})\n$$\nAll quantities except $R_{\\mathrm{m}}$ are considered fixed for this partial differentiation ($\\beta$ is known exactly, $p_{\\mathrm{c}}$ is a fixed calibration parameter). The first term is a constant with respect to $R_{\\mathrm{m}}$. Differentiating with respect to $\\ln(R_{\\mathrm{m}})$:\n$$\nS_{R, \\mathrm{compliant}} = \\frac{\\partial \\ln \\mu_{\\mathrm{compliant}}}{\\partial \\ln R_{\\mathrm{m}}} = 4\n$$\nThe logarithmic sensitivity is $4$ for both the rigid and compliant models.\n\n#### Error Tolerance Calculation\nThe logarithmic sensitivity relates small relative errors in $\\mu$ and $R_{\\mathrm{m}}$. For small finite changes $\\delta \\mu$ and $\\delta R_{\\mathrm{m}}$, we have the approximation:\n$$\n\\frac{\\delta \\mu}{\\mu} \\approx S_{R} \\frac{\\delta R_{\\mathrm{m}}}{R_{\\mathrm{m}}}\n$$\nTaking the absolute value:\n$$\n\\left| \\frac{\\delta \\mu}{\\mu} \\right| \\approx |S_{R}| \\left| \\frac{\\delta R_{\\mathrm{m}}}{R_{\\mathrm{m}}} \\right|\n$$\nSince $S_{R} = 4$ for both models, the analysis is identical for each. We are given a target bound on the relative viscosity error, $\\varepsilon_{\\mathrm{t}} = 0.05$, such that $|\\delta \\mu|/\\mu \\leq \\varepsilon_{\\mathrm{t}}$. We need to find the maximum allowable relative error in radius, $\\tau$, such that if $|\\delta R_{\\mathrm{m}}|/R_{\\mathrm{m}} \\leq \\tau$, the condition on viscosity error is met.\nSubstituting the values and definitions:\n$$\n\\varepsilon_{\\mathrm{t}} \\geq \\left| \\frac{\\delta \\mu}{\\mu} \\right| \\approx 4 \\left| \\frac{\\delta R_{\\mathrm{m}}}{R_{\\mathrm{m}}} \\right|\n$$\nTo guarantee the condition, we require:\n$$\n4 \\left| \\frac{\\delta R_{\\mathrm{m}}}{R_{\\mathrm{m}}} \\right| \\leq \\varepsilon_{\\mathrm{t}}\n$$\nThis implies:\n$$\n\\left| \\frac{\\delta R_{\\mathrm{m}}}{R_{\\mathrm{m}}} \\right| \\leq \\frac{\\varepsilon_{\\mathrm{t}}}{4}\n$$\nThe maximum allowable relative error $\\tau$ is therefore the upper bound of this inequality.\n$$\n\\tau = \\frac{\\varepsilon_{\\mathrm{t}}}{4}\n$$\nSubstituting the given value $\\varepsilon_{\\mathrm{t}} = 0.05$:\n$$\n\\tau = \\frac{0.05}{4} = 0.0125\n$$\nThe problem asks for this value to be expressed as a decimal rounded to four significant figures. The number $0.0125$ has three significant figures ($1$, $2$, $5$). To express it with four, we must add a trailing zero, which is significant in this context.\n$$\n\\tau = 0.01250\n$$\nThis represents the recommended maximum tolerance to ensure the inferred viscosity error does not exceed $5\\%$.",
            "answer": "$$\n\\boxed{0.01250}\n$$"
        },
        {
            "introduction": "While the previous exercise explored a simplified analytical model of compliance, many real-world scenarios involve complex, nonlinear vessel properties that defy straightforward integration. This is where computational methods become indispensable. This capstone practice challenges you to solve the flow problem in a compliant tube by implementing a numerical \"shooting method\" . You will combine a Runge-Kutta integrator for the pressure ODE with a bisection root-finder to determine the unique flow rate $ Q $ that satisfies the pressure boundary conditions at both ends of the tube. This exercise provides invaluable hands-on experience in solving the kind of boundary value problems that are ubiquitous in advanced biomechanical modeling.",
            "id": "4199147",
            "problem": "Consider a steady, incompressible, laminar flow of a Newtonian fluid through a long straight circular tube of length $L$. Let the spatial coordinate be $x \\in [0,L]$ and the axial pressure be $p(x)$. Let the dynamic viscosity be $\\mu$ and assume no-slip at the wall. The volumetric flow rate $Q$ is spatially uniform under these conditions. The tube radius depends on the local pressure via a compliant law $R(p)$, where $R(p)$ is a strictly positive, differentiable function. For a rigid tube, $R(p)$ is a constant equal to $R_0$.\n\nFrom the axial momentum balance for laminar flow and the incompressibility constraints, the classical relation links the axial pressure gradient to the volumetric flow rate and radius through the well-tested Poiseuille law. When the tube is compliant, the axial ordinary differential equation for the pressure, with prescribed inlet and outlet pressures $p(0) = p_{\\text{in}}$ and $p(L) = p_{\\text{out}}$, is\n$$\n\\frac{dp}{dx} = -\\frac{8\\,\\mu\\,Q}{\\pi\\,R(p)^4}.\n$$\nThe unknown is the constant $Q$ that ensures the boundary condition at $x=L$ is satisfied when integrating from $x=0$ starting at $p(0)=p_{\\text{in}}$.\n\nYour task is to implement a numerical shooting method to determine $Q$ such that integrating the above initial value problem yields $p(L;Q) = p_{\\text{out}}$ within a specified tolerance. Use a fourth-order explicit Runge–Kutta method for the integration of $p(x)$ and a robust bracketing-based root solver (for example, bisection) on the scalar mismatch function\n$$\nF(Q) = p(L;Q) - p_{\\text{out}}.\n$$\nAdopt the following linear compliance law for the radius:\n$$\nR(p) = R_0 \\left[1 + c\\,\\left(p - p_0\\right)\\right],\n$$\nwhere $R_0$ is the reference radius at the reference pressure $p_0$, and $c$ is a positive compliance coefficient with units of reciprocal pressure.\n\nImplement your program to:\n- Integrate the pressure ordinary differential equation from $x=0$ to $x=L$ using the Runge–Kutta method with a uniform grid of $N$ steps.\n- Use bisection on $Q$ to enforce $p(L;Q) = p_{\\text{out}}$ to an absolute pressure tolerance of $\\varepsilon_p = 10^{-3}$ pascal.\n- Ensure scientific realism by requiring $R(p) > 0$ for all pressures encountered; parameters are chosen below so that this holds without ad hoc clipping.\n\nPhysical units must be handled consistently:\n- Lengths in meters ($\\text{m}$).\n- Pressures in pascal ($\\text{Pa}$).\n- Dynamic viscosity in pascal-second ($\\text{Pa}\\cdot\\text{s}$).\n- Volumetric flow rate in cubic meters per second ($\\text{m}^3/\\text{s}$).\n\nYour program must compute $Q$ for each of the following four test cases and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry formatted in scientific notation with six decimal places. Express each $Q$ in cubic meters per second ($\\text{m}^3/\\text{s}$).\n\nTest suite:\n1. General compliant tube (happy path):\n   - $L = 0.5$ $\\text{m}$, $R_0 = 2.5\\times 10^{-3}$ $\\text{m}$, $\\mu = 3.5\\times 10^{-3}$ $\\text{Pa}\\cdot\\text{s}$,\n     $p_0 = 1.0\\times 10^{4}$ $\\text{Pa}$, $p_{\\text{in}} = 1.33\\times 10^{4}$ $\\text{Pa}$, $p_{\\text{out}} = 1.0\\times 10^{4}$ $\\text{Pa}$, $c = 2.0\\times 10^{-5}$ $\\text{Pa}^{-1}$, $N = 2000$.\n2. Rigid tube boundary case:\n   - Same as case 1 but $c = 0$.\n3. High-compliance tube:\n   - Same as case 1 but $c = 8.0\\times 10^{-5}$ $\\text{Pa}^{-1}$.\n4. Short tube with small pressure drop:\n   - $L = 0.05$ $\\text{m}$, $R_0 = 1.5\\times 10^{-3}$ $\\text{m}$, $\\mu = 3.5\\times 10^{-3}$ $\\text{Pa}\\cdot\\text{s}$,\n     $p_0 = 1.0\\times 10^{4}$ $\\text{Pa}$, $p_{\\text{in}} = 1.05\\times 10^{4}$ $\\text{Pa}$, $p_{\\text{out}} = 1.0\\times 10^{4}$ $\\text{Pa}$, $c = 5.0\\times 10^{-5}$ $\\text{Pa}^{-1}$, $N = 1000$.\n\nFinal output format:\n- Your program should produce a single line of output containing the four $Q$ values for the above test cases, as a comma-separated list enclosed in square brackets, for example, \"[q1,q2,q3,q4]\". Each $q_i$ must be in $\\text{m}^3/\\text{s}$ and formatted in scientific notation with six decimal places.",
            "solution": "The problem requires the determination of the volumetric flow rate $Q$ for a steady, incompressible, laminar flow in a compliant circular tube. The problem is a boundary value problem for the axial pressure $p(x)$, which is modeled using a shooting method. The solution involves coupling a numerical ODE integrator with a root-finding algorithm.\n\nThe governing ordinary differential equation (ODE) for the pressure $p(x)$ along the tube axis $x \\in [0,L]$ is derived from the Hagen-Poiseuille law, applied locally to a tube segment of radius $R(p)$:\n$$\n\\frac{dp}{dx} = -\\frac{8\\,\\mu\\,Q}{\\pi\\,R(p)^4}\n$$\nHere, $\\mu$ is the dynamic viscosity of the fluid, and $Q$ is the constant volumetric flow rate. The tube radius $R$ is not constant but depends on the local pressure $p$ through a given linear compliance law:\n$$\nR(p) = R_0 \\left[1 + c\\,\\left(p - p_0\\right)\\right]\n$$\nwhere $R_0$ is the reference radius at pressure $p_0$, and $c$ is the compliance coefficient. The problem is subject to the boundary conditions $p(0) = p_{\\text{in}}$ and $p(L) = p_{\\text{out}}$.\n\nThe core of the problem is that the flow rate $Q$ is unknown. We must find the value of $Q$ that ensures the solution to the ODE with the initial condition $p(0) = p_{\\text{in}}$ also satisfies the terminal condition $p(L) = p_{\\text{out}}$. This structure lends itself to a shooting method.\n\nWe define a mismatch function, $F(Q)$, which represents the difference between the computed outlet pressure for a given $Q$ and the desired outlet pressure $p_{\\text{out}}$:\n$$\nF(Q) = p(L;Q) - p_{\\text{out}}\n$$\nwhere $p(L;Q)$ is the pressure at $x=L$ obtained by solving the ODE as an initial value problem (IVP) starting from $p(0) = p_{\\text{in}}$ with a trial value of $Q$. The problem is thus transformed into finding the root of the scalar equation $F(Q)=0$.\n\nTo compute $p(L;Q)$, we numerically integrate the ODE from $x=0$ to $x=L$. The problem specifies the use of the fourth-order explicit Runge-Kutta (RK4) method with a uniform grid of $N$ steps. The step size is $h = L/N$. For each step from $x_i$ to $x_{i+1} = x_i + h$, the pressure $p_{i+1}$ is updated from $p_i$ as follows:\n$$\np_{i+1} = p_i + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n$$\nwhere the stages $k_j$ are given by:\n$$\n\\begin{aligned}\nf(p, Q) &= -\\frac{8\\,\\mu\\,Q}{\\pi\\,R(p)^4} \\\\\nk_1 &= f(p_i, Q) \\\\\nk_2 &= f(p_i + \\frac{h}{2}k_1, Q) \\\\\nk_3 &= f(p_i + \\frac{h}{2}k_2, Q) \\\\\nk_4 &= f(p_i + hk_3, Q)\n\\end{aligned}\n$$\nStarting with $p_0=p_{\\text{in}}$, we perform $N$ such steps to find $p_N \\approx p(L;Q)$.\n\nTo find the root of $F(Q)=0$, we employ the bisection method, a robust bracketing-based root-finder. This method is suitable because $F(Q)$ is a monotonic function of $Q$. Since $p_{\\text{in}} > p_{\\text{out}}$ in all test cases, we expect $Q > 0$. An increase in $Q$ leads to a larger pressure drop, thus decreasing the value of $p(L;Q)$. Therefore, $F(Q)$ is a monotonically decreasing function of $Q$. This guarantees a unique root and the success of the bisection method, provided a valid initial bracket $[Q_a, Q_b]$ is found such that $F(Q_a) > 0$ and $F(Q_b)  0$.\n\nA suitable bracketing interval can be established as follows:\n1.  Lower bound: $Q_a = 0$. In this case, $dp/dx = 0$, so $p(L;0) = p_{\\text{in}}$. The mismatch function is $F(0) = p_{\\text{in}} - p_{\\text{out}}$, which is positive for all given test cases.\n2.  Upper bound: $Q_b$ must be chosen large enough to ensure $p(L;Q_b)  p_{\\text{out}}$, making $F(Q_b)$ negative. A safe way to find such a $Q_b$ is to calculate the flow rate for an equivalent rigid tube, $Q_{\\text{rigid}} = \\frac{\\pi R_0^4 (p_{\\text{in}}-p_{\\text{out}})}{8\\mu L}$, and choose $Q_b$ as a multiple of this estimate (e.g., $10 \\times Q_{\\text{rigid}}$). This is generally sufficient to cause a large enough pressure drop.\n\nThe bisection algorithm proceeds by repeatedly bisecting the interval $[Q_a, Q_b]$ and selecting the subinterval in which the root must lie. At each iteration, we compute the midpoint $Q_{\\text{mid}} = (Q_a + Q_b)/2$ and evaluate $F(Q_{\\text{mid}})$. The bracket is updated based on the sign of $F(Q_{\\text{mid}})$. The process terminates when the convergence criterion is met, which the problem defines as an absolute tolerance on the pressure mismatch:\n$$\n|F(Q_{\\text{mid}})| = |p(L;Q_{\\text{mid}}) - p_{\\text{out}}|  \\varepsilon_p\n$$\nwith $\\varepsilon_p = 10^{-3}$ Pa.\n\nThe implementation combines these components. A main function iterates through the provided test cases. For each case, it calls a function that implements the bisection method. This function, in turn, calls the RK4 integration routine at each iteration to evaluate the mismatch function $F(Q)$. The final computed $Q$ for each case is then formatted and printed as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for the flow rate Q for all test cases and print results.\n    \"\"\"\n\n    # Absolute pressure tolerance for the bisection method stopping criterion.\n    P_TOL = 1e-3\n\n    def compliance_law(p, R0, p0, c):\n        \"\"\"\n        Calculates the tube radius R as a function of local pressure p.\n        R(p) = R0 * [1 + c * (p - p0)]\n        \"\"\"\n        return R0 * (1.0 + c * (p - p0))\n\n    def dp_dx(p, Q, mu, R0, p0, c):\n        \"\"\"\n        Calculates the pressure gradient dp/dx at a given pressure p and flow rate Q.\n        dp/dx = -8*mu*Q / (pi * R(p)^4)\n        \"\"\"\n        R_p = compliance_law(p, R0, p0, c)\n        # The problem parameters ensure R_p is always positive.\n        return -8.0 * mu * Q / (np.pi * R_p**4)\n\n    def rk4_integrate(Q, L, N, p_in, mu, R0, p0, c):\n        \"\"\"\n        Integrates the pressure ODE from x=0 to x=L using the RK4 method.\n        Returns the pressure at the outlet, p(L).\n        \"\"\"\n        h = float(L) / N\n        p_current = float(p_in)\n        \n        for _ in range(N):\n            k1 = dp_dx(p_current, Q, mu, R0, p0, c)\n            k2 = dp_dx(p_current + 0.5 * h * k1, Q, mu, R0, p0, c)\n            k3 = dp_dx(p_current + 0.5 * h * k2, Q, mu, R0, p0, c)\n            k4 = dp_dx(p_current + h * k3, Q, mu, R0, p0, c)\n            p_current += (h / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + 2.0 * k4)\n        \n        return p_current\n\n    def find_Q(params):\n        \"\"\"\n        Finds the flow rate Q using a shooting method with bisection.\n        The root finding is on the mismatch function F(Q) = p(L;Q) - p_out.\n        \"\"\"\n        L, R0, mu, p0, p_in, p_out, c, N = params\n\n        # Mismatch function for root finding.\n        def F(Q_trial):\n            p_L = rk4_integrate(Q_trial, L, N, p_in, mu, R0, p0, c)\n            return p_L - p_out\n\n        # Bisection method requires a bracket [q_low, q_high] where F(q_low) and F(q_high) have opposite signs.\n        # For Q=0, dp/dx=0, so p(L)=p_in. F(0) = p_in - p_out  0 for all test cases.\n        q_low = 0.0\n        f_low = p_in - p_out\n        \n        # Estimate an upper bound for Q based on the rigid tube case.\n        # A multiple of this Q should cause a large pressure drop, making F(q_high)  0.\n        if p_in  p_out:\n            # A safety factor of 10 is generally sufficient.\n            q_rigid_est = (np.pi * R0**4 * (p_in - p_out)) / (8.0 * mu * L) if L  0 else 0\n            q_high = q_rigid_est * 10.0 if q_rigid_est  0 else 1e-4\n        else:\n            # If no pressure drop, flow rate must be zero.\n            return 0.0\n        \n        # Ensure the initial bracket is valid.\n        f_high = F(q_high)\n        max_bracket_searches = 10\n        for _ in range(max_bracket_searches):\n            if f_high  0:\n                break\n            q_high *= 2.0\n            f_high = F(q_high)\n        else: # If loop completes without break\n            raise RuntimeError(\"Failed to establish a valid bracket for Q.\")\n\n        # Bisection loop\n        max_iter = 100\n        for _ in range(max_iter):\n            q_mid = (q_low + q_high) / 2.0\n            if q_mid == q_low or q_mid == q_high: # Interval is too small\n                break\n            \n            f_mid = F(q_mid)\n            \n            # Stop if the pressure mismatch is within tolerance.\n            if abs(f_mid)  P_TOL:\n                return q_mid\n            \n            # Update the bracket.\n            if np.sign(f_mid) == np.sign(f_low):\n                q_low = q_mid\n                f_low = f_mid\n            else:\n                q_high = q_mid\n                f_high = f_mid\n        \n        return (q_low + q_high) / 2.0 # Return the best estimate.\n\n    # Test suite parameters: (L, R0, mu, p0, p_in, p_out, c, N)\n    test_cases = [\n        # Case 1: General compliant tube\n        (0.5, 2.5e-3, 3.5e-3, 1.0e4, 1.33e4, 1.0e4, 2.0e-5, 2000),\n        # Case 2: Rigid tube boundary case\n        (0.5, 2.5e-3, 3.5e-3, 1.0e4, 1.33e4, 1.0e4, 0.0, 2000),\n        # Case 3: High-compliance tube\n        (0.5, 2.5e-3, 3.5e-3, 1.0e4, 1.33e4, 1.0e4, 8.0e-5, 2000),\n        # Case 4: Short tube with small pressure drop\n        (0.05, 1.5e-3, 3.5e-3, 1.0e4, 1.05e4, 1.0e4, 5.0e-5, 1000),\n    ]\n\n    results = []\n    for case in test_cases:\n        q_val = find_Q(case)\n        results.append(f\"{q_val:.6e}\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}