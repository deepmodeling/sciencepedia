{
    "hands_on_practices": [
        {
            "introduction": "我们从一个最基础的案例开始：刚性圆管中的定常层流。这个练习旨在通过从Navier-Stokes方程出发，推导经典的Hagen-Poiseuille定律，来巩固对动量守恒基本原理的应用。掌握这一推导对于理解后续更复杂的生物力学系统中的流体阻力和压力-流量关系至关重要。",
            "id": "4199141",
            "problem": "考虑牛顿流体在长直圆形刚性管（半径不随压力变化）中的稳定、不可压缩层流。管长为 $L$，半径为常数 $R$。流体的动力粘度为 $\\mu$。假设流动是轴对称的，在轴向是充分发展的，并且在管壁处满足无滑移边界条件。从柱坐标系下的线性动量守恒（纳维-斯托克斯方程）出发，在上述假设下，推导管内轴向压降 $\\Delta p$ 与体积流量 $Q$ 之间的线性关系。用一个完全由管的几何形状和流体粘度定义的液压阻力 $R_h$ 来表示此关系。然后，使用您推导出的表达式，计算在以下参数值下的压降 $\\Delta p$：$\\mu = 3.5 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$，$L = 0.30\\ \\text{m}$，$R = 2.5 \\times 10^{-3}\\ \\text{m}$，以及 $Q = 3.0 \\times 10^{-6}\\ \\text{m}^{3}\\cdot\\text{s}^{-1}$。将您的最终数值结果四舍五入到四位有效数字，并以千帕为单位表示最终压降。",
            "solution": "用户要求我解决一个流体力学问题，因此我将首先验证问题的陈述。\n\n### 第1步：提取已知条件\n-   **流动条件**：稳定、不可压缩、层流。\n-   **流体**：牛顿流体，动力粘度为 $\\mu$。\n-   **管的几何形状**：长、直、圆形、机械刚性，长度 $L$，恒定半径 $R$。\n-   **假设**：轴对称、轴向充分发展的流动、在管壁处（$r=R$）的无滑移边界条件。\n-   **任务1**：推导轴向压降 $\\Delta p$ 和体积流量 $Q$ 之间的线性关系。\n-   **任务2**：使用由管的几何形状和流体粘度定义的液压阻力 $R_h$ 表示此关系。\n-   **任务3**：计算以下参数值下的 $\\Delta p$：\n    -   $\\mu = 3.5 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$\n    -   $L = 0.30\\ \\text{m}$\n    -   $R = 2.5 \\times 10^{-3}\\ \\text{m}$\n    -   $Q = 3.0 \\times 10^{-6}\\ \\text{m}^{3}\\cdot\\text{s}^{-1}$\n-   **输出要求**：将最终数值结果四舍五入到四位有效数字，并以千帕表示。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了哈根-泊肃叶流（Hagen-Poiseuille flow），这是纳维-斯托克斯方程的一个典型且基本的解。所有假设和原理都是流体力学中的标准内容。该问题在科学上是合理的。\n2.  **适定性**：该问题是适定的。其推导是标准的教科书练习，并且在给定的输入下，存在一个唯一的、稳定的压降解。\n3.  **客观性**：该问题使用清晰、精确和标准的科学术语进行陈述。没有歧义或主观性。\n4.  **完整性和一致性**：该问题提供了执行推导和计算所需的所有必要信息。没有矛盾之处。为验证层流假设，我们可以估算雷诺数，$Re = \\frac{\\rho U D}{\\mu}$，其中 $U$ 是平均速度，$D=2R$ 是直径。平均速度为 $U = \\frac{Q}{A} = \\frac{Q}{\\pi R^2} = \\frac{3.0 \\times 10^{-6}\\ \\text{m}^3/\\text{s}}{\\pi (2.5 \\times 10^{-3}\\ \\text{m})^2} \\approx 0.153\\ \\text{m}/\\text{s}$。假设流体与血液相似，其密度约为 $\\rho \\approx 1060\\ \\text{kg}/\\text{m}^3$。那么雷诺数约为 $Re \\approx \\frac{(1060\\ \\text{kg}/\\text{m}^3)(0.153\\ \\text{m}/\\text{s})(2 \\times 2.5 \\times 10^{-3}\\ \\text{m})}{3.5 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}} \\approx 232$。由于 $232 \\ll 2300$（管流的典型临界值），因此层流假设与给定参数完全一致。\n5.  **合理性**：数值是物理上现实的，例如，对应于小动脉中的血流。\n\n### 第3步：结论与行动\n该问题是有效的，因为它在科学上是合理的、适定的，并且所有提供的数据都是一致和完整的。我将继续进行求解。\n\n推导始于不可压缩牛顿流体的线性动量守恒，由纳维-斯托克斯方程表示。在柱坐标系 $(r, \\theta, z)$ 中，轴向（$z$-）动量方程为：\n$$\n\\rho \\left( \\frac{\\partial v_z}{\\partial t} + v_r \\frac{\\partial v_z}{\\partial r} + \\frac{v_\\theta}{r} \\frac{\\partial v_z}{\\partial \\theta} + v_z \\frac{\\partial v_z}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial z} + \\mu \\left[ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial v_z}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2 v_z}{\\partial \\theta^2} + \\frac{\\partial^2 v_z}{\\partial z^2} \\right] + \\rho g_z\n$$\n我们应用给定的假设来简化此方程：\n1.  **稳定流**：$\\frac{\\partial}{\\partial t} = 0$。\n2.  **轴对称**：$\\frac{\\partial}{\\partial \\theta} = 0$，这也意味着切向速度 $v_\\theta = 0$。\n3.  **径向无流动**：对于恒定半径的直管，$v_r = 0$。\n4.  **充分发展的流动**：速度剖面沿轴向恒定，因此 $\\frac{\\partial v_z}{\\partial z} = 0$。这也满足不可压缩流动的连续性方程 $\\frac{1}{r}\\frac{\\partial(r v_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial v_\\theta}{\\partial \\theta} + \\frac{\\partial v_z}{\\partial z} = 0$，该方程简化为 $\\frac{\\partial v_z}{\\partial z} = 0$。\n我们还忽略重力效应，设 $g_z=0$，或假设管道是水平的。\n\n应用这些简化后，左侧的所有项（对流加速度项）和右侧的几项都变为零。轴向动量方程简化为：\n$$\n0 = -\\frac{\\partial p}{\\partial z} + \\mu \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial v_z}{\\partial r} \\right)\n$$\n由于 $v_z$ 仅是 $r$ 的函数，即 $v_z = v_z(r)$，因此关于 $r$ 的偏导数可以写成常导数。对于充分发展的流动，压力梯度 $\\frac{\\partial p}{\\partial z}$ 不能是 $r$ 的函数，并且由于流动是稳定的，它也不能是 $t$ 的函数。因此，$\\frac{\\partial p}{\\partial z}$ 只能是 $z$ 的函数或一个常数。然而，方程的右侧仅是 $r$ 的函数。为了使等式对所有 $r$ 和 $z$ 都成立，两边必须等于同一个常数。我们写作 $\\frac{dp}{dz} = \\text{常数}$。\n重排方程：\n$$\n\\frac{1}{\\mu} \\frac{dp}{dz} = \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dv_z}{dr} \\right)\n$$\n我们对该方程关于 $r$ 进行积分：\n$$\n\\int r \\frac{1}{\\mu} \\frac{dp}{dz} dr = \\int \\frac{d}{dr} \\left( r \\frac{dv_z}{dr} \\right) dr\n$$\n$$\n\\frac{r^2}{2\\mu} \\frac{dp}{dz} = r \\frac{dv_z}{dr} + C_1\n$$\n由于轴对称性，速度剖面在中心线（$r=0$）处必须是平滑的，这要求速度梯度为零：$\\left. \\frac{dv_z}{dr} \\right|_{r=0} = 0$。为了使项 $\\frac{C_1}{r}$（分离 $\\frac{dv_z}{dr}$ 时会产生此项）在 $r=0$ 处为有限值，积分常数 $C_1$ 必须为零。\n所以，方程变为：\n$$\n\\frac{dv_z}{dr} = \\frac{r}{2\\mu} \\frac{dp}{dz}\n$$\n第二次关于 $r$ 积分：\n$$\nv_z(r) = \\int \\frac{r}{2\\mu} \\frac{dp}{dz} dr = \\frac{r^2}{4\\mu} \\frac{dp}{dz} + C_2\n$$\n我们通过应用管壁处的无滑移边界条件 $v_z(R) = 0$ 来求第二个积分常数 $C_2$。\n$$\n0 = \\frac{R^2}{4\\mu} \\frac{dp}{dz} + C_2 \\implies C_2 = -\\frac{R^2}{4\\mu} \\frac{dp}{dz}\n$$\n将 $C_2$ 代回，得到抛物线形的速度剖面：\n$$\nv_z(r) = \\frac{1}{4\\mu} \\frac{dp}{dz} (r^2 - R^2)\n$$\n由于流动在正 $z$ 方向（$v_z > 0$）且 $r^2 - R^2 \\le 0$，压力梯度 $\\frac{dp}{dz}$ 必须为负。\n\n接下来，我们通过在管的横截面积 $A$ 上对速度剖面进行积分来计算体积流量 $Q$：\n$$\nQ = \\int_A v_z(r) dA = \\int_0^R v_z(r) (2\\pi r) dr\n$$\n$$\nQ = \\int_0^R \\frac{1}{4\\mu} \\frac{dp}{dz} (r^2 - R^2) (2\\pi r) dr = \\frac{2\\pi}{4\\mu} \\frac{dp}{dz} \\int_0^R (r^3 - R^2 r) dr\n$$\n$$\nQ = \\frac{\\pi}{2\\mu} \\frac{dp}{dz} \\left[ \\frac{r^4}{4} - \\frac{R^2 r^2}{2} \\right]_0^R = \\frac{\\pi}{2\\mu} \\frac{dp}{dz} \\left( \\frac{R^4}{4} - \\frac{R^4}{2} \\right) = \\frac{\\pi}{2\\mu} \\frac{dp}{dz} \\left( -\\frac{R^4}{4} \\right)\n$$\n$$\nQ = -\\frac{\\pi R^4}{8\\mu} \\frac{dp}{dz}\n$$\n这就是哈根-泊肃叶方程。恒定的压力梯度可以用管长 $L$ 上的压降 $\\Delta p = p_{inlet} - p_{outlet}$ 表示为 $\\frac{dp}{dz} = -\\frac{\\Delta p}{L}$。将此代入 $Q$ 的方程中：\n$$\nQ = -\\frac{\\pi R^4}{8\\mu} \\left( -\\frac{\\Delta p}{L} \\right) = \\frac{\\pi R^4}{8\\mu L} \\Delta p\n$$\n重排以显示 $\\Delta p$ 和 $Q$ 之间的线性关系：\n$$\n\\Delta p = \\left( \\frac{8\\mu L}{\\pi R^4} \\right) Q\n$$\n这是 $\\Delta p = R_h Q$ 的形式，其中液压阻力 $R_h$ 由下式给出：\n$$\nR_h = \\frac{8\\mu L}{\\pi R^4}\n$$\n此 $R_h$ 的表达式仅取决于流体粘度 $\\mu$ 和管的几何形状（$L$ 和 $R$），符合要求。\n\n最后，我们使用提供的参数计算压降 $\\Delta p$ 的数值：\n$\\mu = 3.5 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$\n$L = 0.30\\ \\text{m}$\n$R = 2.5 \\times 10^{-3}\\ \\text{m}$\n$Q = 3.0 \\times 10^{-6}\\ \\text{m}^{3}\\cdot\\text{s}^{-1}$\n\n使用推导出的公式 $\\Delta p = \\frac{8\\mu L Q}{\\pi R^4}$：\n$$\n\\Delta p = \\frac{8 (3.5 \\times 10^{-3}) (0.30) (3.0 \\times 10^{-6})}{\\pi (2.5 \\times 10^{-3})^4}\n$$\n$$\n\\Delta p = \\frac{2.52 \\times 10^{-8}}{\\pi (3.90625 \\times 10^{-11})} \\ \\text{Pa}\n$$\n$$\n\\Delta p = \\frac{2.52 \\times 10^{-8}}{1.2271846... \\times 10^{-10}} \\ \\text{Pa} \\approx 205.349\\ \\text{Pa}\n$$\n问题要求答案以千帕（kPa）为单位。由于 $1\\ \\text{kPa} = 1000\\ \\text{Pa}$，我们有：\n$$\n\\Delta p \\approx 0.205349\\ \\text{kPa}\n$$\n四舍五入到四位有效数字，压降为 $0.2053\\ \\text{kPa}$。",
            "answer": "$$\\boxed{0.2053}$$"
        },
        {
            "introduction": "在掌握了刚性管中的牛顿流体模型后，我们来挑战其中一个关键假设：流体的牛顿特性。许多生物流体（如血液）表现出非牛顿行为，其粘度会随剪切率而变化。此练习引入了幂律流体模型，并要求您分析当使用简化的牛顿模型来解读实验数据时会产生多大的误差。这项实践对于培养模型假设的批判性思维至关重要，它教会我们如何量化模型简化所带来的偏差。",
            "id": "4199132",
            "problem": "一位研究人员在一个半径为 $R$、长度为 $L$ 的长直刚性圆管中进行经典的 Poiseuille 实验，在长度 $L$ 上测得的压降 $\\Delta p$ 作用下，驱动一个稳定的、层流的、不可压缩的、轴对称的流动，其体积流量为 $Q$。研究人员认为该流体是牛顿流体，使用刚性管的 Poiseuille 公式 $Q = \\pi R^{4} \\Delta p / (8 \\mu L)$ 估算其粘度，从而得到估计值 $\\mu_{\\mathrm{est}} = \\pi R^{4} \\Delta p / (8 L Q)$。实际上，该流体是一种广义牛顿幂律流体，其本构关系为 $\\tau_{rz} = K \\, |\\dot{\\gamma}|^{n-1} \\dot{\\gamma}$，其中 $K$ 是稠度系数，$n \\neq 1$ 是流动行为指数，$\\tau_{rz}$ 是剪切应力，$\\dot{\\gamma} = -\\mathrm{d}u/\\mathrm{d}r$ 是轴向速度 $u(r)$ 对应的剪切速率大小。\n\n请仅从柱坐标系中充分发展的动量平衡和幂律本构方程出发，推导 $\\Delta p$ 和 $Q$ 之间的关系，并用此关系表示壁面剪切应力 $\\tau_{w}$ 和壁面剪切速率 $\\dot{\\gamma}_{w}$。将“真实”参考粘度定义为壁面处的表观粘度 $\\mu_{\\mathrm{app}} \\equiv \\tau_{w}/\\dot{\\gamma}_{w}$，并通过分数误差\n$$\n\\varepsilon(n) \\equiv \\frac{\\mu_{\\mathrm{est}} - \\mu_{\\mathrm{app}}}{\\mu_{\\mathrm{app}}}\n$$\n来量化牛顿流体估计值相对于该参考值的乘性偏差。\n假设壁面处无滑移，且入口和出口效应可以忽略不计。将你的最终答案表示为一个仅含 $n$ 的 $\\varepsilon(n)$ 的单一闭式解析表达式。不需要进行数值近似，最终答案中不应包含单位。",
            "solution": "该问题要求推导在管道流动实验中，对于幂律流体，其估算的牛顿粘度与壁面表观粘度之间的分数误差。推导过程必须从基本的动量平衡和给定的本构方程出发。\n\n出发点是柱坐标系（$r, \\theta, z$）中稳态、充分发展、不可压缩和轴对称流动的微分动量平衡。轴向（$z$）方向的动量方程简化为：\n$$ \\frac{1}{r} \\frac{\\mathrm{d}}{\\mathrm{d}r}(r \\tau_{rz}) = \\frac{\\mathrm{d}p}{\\mathrm{d}z} $$\n对于在长度 $L$ 上压降为 $\\Delta p > 0$ 的充分发展流动，压力梯度 $\\mathrm{d}p/\\mathrm{d}z$ 是恒定的，等于 $-\\Delta p/L$。方程变为：\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}r}(r \\tau_{rz}) = -\\frac{\\Delta p}{L} r $$\n对 $r$ 积分得到：\n$$ r \\tau_{rz} = -\\frac{\\Delta p}{2L} r^2 + C_1 $$\n剪切应力 $\\tau_{rz}$ 在中心线（$r=0$）处必须是有限的，这要求积分常数 $C_1$ 为 $0$。因此，剪切应力分布与半径呈线性关系：\n$$ \\tau_{rz}(r) = -\\frac{\\Delta p}{2L} r $$\n负号约定通过考虑大小来处理。剪切应力的大小为 $\\tau(r) = \\frac{\\Delta p}{2L} r$。\n壁面剪切应力 $\\tau_w$ 是在管壁 $r=R$ 处的剪切应力：\n$$ \\tau_w = \\frac{\\Delta p R}{2L} $$\n这是第一个要求的表达式。\n\n流体由幂律本构关系 $\\tau_{rz} = K \\, |\\dot{\\gamma}|^{n-1} \\dot{\\gamma}$ 描述。对于管道流，速度梯度 $\\mathrm{d}u/\\mathrm{d}r$ 为负，因此剪切速率大小为 $\\dot{\\gamma} = -\\mathrm{d}u/\\mathrm{d}r > 0$。根据我们的压降定义，剪切应力 $\\tau_{rz}$ 为正。因此，本构方程简化为 $\\tau_{rz} = K \\dot{\\gamma}^n = K(-\\mathrm{d}u/\\mathrm{d}r)^n$。\n\n求解速度梯度：\n$$ -\\frac{\\mathrm{d}u}{\\mathrm{d}r} = \\left(\\frac{\\tau_{rz}}{K}\\right)^{1/n} = \\left(\\frac{\\Delta p}{2LK} r\\right)^{1/n} $$\n为了求得速度剖面 $u(r)$，我们对该表达式关于 $r$ 进行积分，并应用无滑移边界条件 $u(R)=0$：\n$$ u(r) = \\int_{r}^{R} \\left(\\frac{\\Delta p}{2LK} r'\\right)^{1/n} \\mathrm{d}r' = \\left(\\frac{\\Delta p}{2LK}\\right)^{1/n} \\int_{r}^{R} (r')^{1/n} \\mathrm{d}r' $$\n$$ u(r) = \\left(\\frac{\\Delta p}{2LK}\\right)^{1/n} \\left[\\frac{(r')^{1/n+1}}{1/n+1}\\right]_r^R = \\left(\\frac{\\Delta p}{2LK}\\right)^{1/n} \\frac{n}{n+1} \\left(R^{(n+1)/n} - r^{(n+1)/n}\\right) $$\n体积流量 $Q$ 通过将速度剖面在管道横截面积上积分得到：\n$$ Q = \\int_0^R u(r) 2\\pi r \\, \\mathrm{d}r $$\n$$ Q = 2\\pi \\left(\\frac{\\Delta p}{2LK}\\right)^{1/n} \\frac{n}{n+1} \\int_0^R \\left(R^{(n+1)/n} - r^{(n+1)/n}\\right) r \\, \\mathrm{d}r $$\n$$ Q = 2\\pi \\left(\\frac{\\Delta p}{2LK}\\right)^{1/n} \\frac{n}{n+1} \\left[ R^{(n+1)/n}\\frac{R^2}{2} - \\frac{R^{(3n+1)/n}}{(3n+1)/n} \\right] $$\n$$ Q = 2\\pi \\left(\\frac{\\Delta p}{2LK}\\right)^{1/n} \\frac{n}{n+1} R^{(3n+1)/n} \\left(\\frac{1}{2} - \\frac{n}{3n+1}\\right) $$\n$$ Q = 2\\pi \\left(\\frac{\\Delta p}{2LK}\\right)^{1/n} \\frac{n}{n+1} R^{(3n+1)/n} \\left(\\frac{n+1}{2(3n+1)}\\right) $$\n$$ Q = \\pi R^3 \\left(\\frac{n}{3n+1}\\right) \\left(\\frac{\\Delta p R}{2LK}\\right)^{1/n} $$\n认识到 $\\tau_w = \\frac{\\Delta p R}{2L}$ 且真实的壁面剪切速率为 $\\dot{\\gamma}_w = (-\\mathrm{d}u/\\mathrm{d}r)|_{r=R} = (\\tau_w/K)^{1/n}$，我们可以将流量写为：\n$$ Q = \\pi R^3 \\left(\\frac{n}{3n+1}\\right) \\dot{\\gamma}_w $$\n由此，我们可以用可测量的流量 $Q$ 来表示壁面剪切速率：\n$$ \\dot{\\gamma}_w = \\left(\\frac{3n+1}{n}\\right) \\frac{Q}{\\pi R^3} $$\n这是第二个要求的表达式。\n\n现在我们计算两种粘度。牛顿流体的估计值由 $\\mu_{\\mathrm{est}} = \\frac{\\pi R^4 \\Delta p}{8LQ}$ 给出。我们可以利用 $\\tau_w = \\Delta p R / (2L)$（即 $\\Delta p/L = 2\\tau_w/R$）来重写这个式子：\n$$ \\mu_{\\mathrm{est}} = \\frac{\\pi R^4}{8Q} \\left(\\frac{2\\tau_w}{R}\\right) = \\frac{\\tau_w}{4Q/(\\pi R^3)} $$\n量 $4Q/(\\pi R^3)$ 是当流体为牛顿流体时对应的壁面剪切速率，通常称为表观壁面剪切速率 $\\dot{\\gamma}_{\\mathrm{app}}$。所以，$\\mu_{\\mathrm{est}} = \\tau_w / \\dot{\\gamma}_{\\mathrm{app}}$。\n\n“真实”参考粘度是壁面处的表观粘度，$\\mu_{\\mathrm{app}} \\equiv \\tau_w / \\dot{\\gamma}_w$。\n\n使用我们用 $Q$ 表示 $\\dot{\\gamma}_w$ 的表达式，我们可以建立真实壁面剪切速率和表观壁面剪切速率之间的关系：\n$$ \\dot{\\gamma}_w = \\frac{3n+1}{n} \\frac{Q}{\\pi R^3} = \\frac{3n+1}{4n} \\left(\\frac{4Q}{\\pi R^3}\\right) = \\frac{3n+1}{4n} \\dot{\\gamma}_{\\mathrm{app}} $$\n现在我们可以关联 $\\mu_{\\mathrm{est}}$ 和 $\\mu_{\\mathrm{app}}$：\n$$ \\mu_{\\mathrm{est}} = \\frac{\\tau_w}{\\dot{\\gamma}_{\\mathrm{app}}} $$\n$$ \\mu_{\\mathrm{app}} = \\frac{\\tau_w}{\\dot{\\gamma}_w} = \\frac{\\tau_w}{\\frac{3n+1}{4n} \\dot{\\gamma}_{\\mathrm{app}}} = \\left(\\frac{4n}{3n+1}\\right) \\frac{\\tau_w}{\\dot{\\gamma}_{\\mathrm{app}}} = \\left(\\frac{4n}{3n+1}\\right) \\mu_{\\mathrm{est}} $$\n重新整理得到估计粘度和表观粘度之间的关系：\n$$ \\mu_{\\mathrm{est}} = \\left(\\frac{3n+1}{4n}\\right) \\mu_{\\mathrm{app}} $$\n分数误差 $\\varepsilon(n)$ 定义为 $\\varepsilon(n) = \\frac{\\mu_{\\mathrm{est}} - \\mu_{\\mathrm{app}}}{\\mu_{\\mathrm{app}}}$。代入我们找到的关系：\n$$ \\varepsilon(n) = \\frac{\\left(\\frac{3n+1}{4n}\\right) \\mu_{\\mathrm{app}} - \\mu_{\\mathrm{app}}}{\\mu_{\\mathrm{app}}} $$\n$$ \\varepsilon(n) = \\frac{3n+1}{4n} - 1 = \\frac{3n+1 - 4n}{4n} = \\frac{1-n}{4n} $$\n这个闭式解析表达式仅用流动行为指数 $n$ 来量化误差。对于牛顿流体（$n=1$），误差 $\\varepsilon(1)=0$，符合预期。对于剪切稀化流体（$n1$），误差为正，$\\varepsilon(n)>0$，意味着牛顿公式高估了壁面粘度。对于剪切增稠流体（$n>1$），误差为负，$\\varepsilon(n)0$，表明存在低估。",
            "answer": "$$\\boxed{\\frac{1-n}{4n}}$$"
        },
        {
            "introduction": "现在，我们来处理另一个主要的理想化假设：刚性管壁。大多数生物管道（如血管）都是柔顺的，其半径会随压力而变化，这引入了显著的非线性。在这种情况下，局部的泊肃叶关系依然成立，但由于半径随压力变化，导致压力梯度不再是常数，从而形成一个关于压力的非线性常微分方程。这个练习通过要求您编写一个数值程序来解决这个边界值问题，将理论与实践联系起来，这对于处理那些无法获得解析解的实际生物力学问题至关重要。",
            "id": "4199147",
            "problem": "考虑牛顿流体通过一根长度为 $L$ 的长直圆管的稳态、不可压缩、层流流动。设空间坐标为 $x \\in [0,L]$，轴向压力为 $p(x)$。设动力粘度为 $\\mu$，并假设壁面处为无滑移条件。在这些条件下，体积流量 $Q$ 在空间上是均一的。管半径通过一个柔性定律 $R(p)$ 依赖于局部压力，其中 $R(p)$ 是一个严格为正的可微函数。对于刚性管，$R(p)$ 是一个等于 $R_0$ 的常数。\n\n根据层流的轴向动量平衡和不可压缩性约束，经典的 Poiseuille 定律将轴向压力梯度与体积流量和半径联系起来，该定律已经过充分检验。当管是柔性时，压力的轴向常微分方程为，其入口和出口压力已给定，分别为 $p(0) = p_{\\text{in}}$ 和 $p(L) = p_{\\text{out}}$：\n$$\n\\frac{dp}{dx} = -\\frac{8\\,\\mu\\,Q}{\\pi\\,R(p)^4}.\n$$\n未知量是常数 $Q$，它需要确保当从 $p(0)=p_{\\text{in}}$ 开始，由 $x=0$ 积分时，在 $x=L$ 处的边界条件得到满足。\n\n您的任务是实现一个数值打靶法来确定 $Q$，使得在指定的容差范围内，积分上述初值问题能得到 $p(L;Q) = p_{\\text{out}}$。使用四阶显式 Runge–Kutta 方法对 $p(x)$ 进行积分，并对标量失配函数使用一个稳健的基于区间法的求根器（例如，二分法）。\n$$\nF(Q) = p(L;Q) - p_{\\text{out}}.\n$$\n采用以下线性柔性定律来表示半径：\n$$\nR(p) = R_0 \\left[1 + c\\,\\left(p - p_0\\right)\\right],\n$$\n其中 $R_0$ 是在参考压力 $p_0$ 下的参考半径，$c$ 是一个正的柔性系数，其单位为压力的倒数。\n\n实现您的程序以完成以下任务：\n- 使用具有 $N$ 个步长的均匀网格，通过 Runge–Kutta 方法对压力常微分方程从 $x=0$ 到 $x=L$ 进行积分。\n- 对 $Q$ 使用二分法，以在 $\\varepsilon_p = 10^{-3}$ 帕斯卡的绝对压力容差内强制满足 $p(L;Q) = p_{\\text{out}}$。\n- 通过要求遇到的所有压力都满足 $R(p) > 0$ 来确保科学真实性；下面选择的参数可以保证此条件成立，无需进行特殊的截断处理。\n\n物理单位必须一致地处理：\n- 长度单位为米 ($\\text{m}$)。\n- 压力单位为帕斯卡 ($\\text{Pa}$)。\n- 动力粘度单位为帕斯卡-秒 ($\\text{Pa}\\cdot\\text{s}$)。\n- 体积流量单位为立方米/秒 ($\\text{m}^3/\\text{s}$)。\n\n您的程序必须为以下四个测试用例中的每一个计算 $Q$，并生成单行输出。该输出包含一个用方括号括起来的逗号分隔列表，其中每个条目都采用科学记数法格式化，并保留六位小数。每个 $Q$ 的单位都应为立方米/秒 ($\\text{m}^3/\\text{s}$)。\n\n测试套件：\n1. 通用柔性管（正常路径）：\n   - $L = 0.5$ $\\text{m}$, $R_0 = 2.5\\times 10^{-3}$ $\\text{m}$, $\\mu = 3.5\\times 10^{-3}$ $\\text{Pa}\\cdot\\text{s}$,\n     $p_0 = 1.0\\times 10^{4}$ $\\text{Pa}$, $p_{\\text{in}} = 1.33\\times 10^{4}$ $\\text{Pa}$, $p_{\\text{out}} = 1.0\\times 10^{4}$ $\\text{Pa}$, $c = 2.0\\times 10^{-5}$ $\\text{Pa}^{-1}$, $N = 2000$。\n2. 刚性管边界情况：\n   - 与用例 1 相同，但 $c = 0$。\n3. 高柔性管：\n   - 与用例 1 相同，但 $c = 8.0\\times 10^{-5}$ $\\text{Pa}^{-1}$。\n4. 压降小的短管：\n   - $L = 0.05$ $\\text{m}$, $R_0 = 1.5\\times 10^{-3}$ $\\text{m}$, $\\mu = 3.5\\times 10^{-3}$ $\\text{Pa}\\cdot\\text{s}$,\n     $p_0 = 1.0\\times 10^{4}$ $\\text{Pa}$, $p_{\\text{in}} = 1.05\\times 10^{4}$ $\\text{Pa}$, $p_{\\text{out}} = 1.0\\times 10^{4}$ $\\text{Pa}$, $c = 5.0\\times 10^{-5}$ $\\text{Pa}^{-1}$, $N = 1000$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含上述四个测试用例的 $Q$ 值。这些值应以逗号分隔列表的形式呈现，并用方括号括起来，例如，“[q1,q2,q3,q4]”。每个 $q_i$ 的单位必须是 $\\text{m}^3/\\text{s}$，并采用科学记数法格式化，保留六位小数。",
            "solution": "该问题要求确定在柔性圆管中稳态、不可压缩、层流流动下的体积流量 $Q$。该问题是关于轴向压力 $p(x)$ 的一个边值问题，使用打靶法进行建模求解。解决方案涉及将一个数值 ODE 积分器与一个求根算法相结合。\n\n沿管轴 $x \\in [0,L]$ 的压力 $p(x)$ 的控制常微分方程 (ODE) 源自 Hagen-Poiseuille 定律，该定律被局部应用于半径为 $R(p)$ 的管段：\n$$\n\\frac{dp}{dx} = -\\frac{8\\,\\mu\\,Q}{\\pi\\,R(p)^4}\n$$\n此处，$\\mu$ 是流体的动力粘度，$Q$ 是恒定的体积流量。管半径 $R$ 不是常数，而是通过给定的线性柔性定律依赖于局部压力 $p$：\n$$\nR(p) = R_0 \\left[1 + c\\,\\left(p - p_0\\right)\\right]\n$$\n其中 $R_0$ 是在压力 $p_0$ 下的参考半径，$c$ 是柔性系数。该问题受边界条件 $p(0) = p_{\\text{in}}$ 和 $p(L) = p_{\\text{out}}$ 的约束。\n\n问题的核心在于流量 $Q$ 是未知的。我们必须找到 $Q$ 的值，以确保带有初始条件 $p(0) = p_{\\text{in}}$ 的 ODE 解也满足终端条件 $p(L) = p_{\\text{out}}$。这种结构非常适合使用打靶法。\n\n我们定义一个失配函数 $F(Q)$，它表示对于给定的 $Q$ 计算出的出口压力与期望的出口压力 $p_{\\text{out}}$ 之间的差异：\n$$\nF(Q) = p(L;Q) - p_{\\text{out}}\n$$\n其中 $p(L;Q)$ 是通过将 ODE 作为初值问题 (IVP) 求解得到 $x=L$ 处的压力，该求解从 $p(0) = p_{\\text{in}}$ 和一个试验值 $Q$ 开始。因此，问题被转化为寻找标量方程 $F(Q)=0$ 的根。\n\n为了计算 $p(L;Q)$，我们对 ODE 从 $x=0$ 到 $x=L$ 进行数值积分。问题指定使用四阶显式 Runge-Kutta (RK4) 方法，以及一个包含 $N$ 个步长的均匀网格。步长为 $h = L/N$。对于从 $x_i$ 到 $x_{i+1} = x_i + h$ 的每一步，压力 $p_{i+1}$ 根据 $p_i$ 按如下方式更新：\n$$\np_{i+1} = p_i + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n$$\n其中，阶段量 $k_j$ 由以下公式给出：\n$$\n\\begin{aligned}\nf(p, Q) = -\\frac{8\\,\\mu\\,Q}{\\pi\\,R(p)^4} \\\\\nk_1 = f(p_i, Q) \\\\\nk_2 = f(p_i + \\frac{h}{2}k_1, Q) \\\\\nk_3 = f(p_i + \\frac{h}{2}k_2, Q) \\\\\nk_4 = f(p_i + hk_3, Q)\n\\end{aligned}\n$$\n从 $p_0=p_{\\text{in}}$ 开始，我们执行 $N$ 次这样的步骤来找到 $p_N \\approx p(L;Q)$。\n\n为了找到 $F(Q)=0$ 的根，我们采用二分法，这是一种稳健的基于区间法的求根器。该方法是适用的，因为 $F(Q)$ 是 $Q$ 的一个单调函数。由于在所有测试用例中都有 $p_{\\text{in}} > p_{\\text{out}}$，我们预期 $Q > 0$。$Q$ 的增加会导致更大的压降，从而减小 $p(L;Q)$ 的值。因此，$F(Q)$ 是 $Q$ 的一个单调递减函数。这保证了根的唯一性以及二分法的成功，前提是能找到一个有效的初始区间 $[Q_a, Q_b]$ 使得 $F(Q_a) > 0$ 且 $F(Q_b)  0$。\n\n一个合适的搜索区间可以按如下方式建立：\n1.  下界：$Q_a = 0$。在这种情况下，$dp/dx = 0$，所以 $p(L;0) = p_{\\text{in}}$。失配函数为 $F(0) = p_{\\text{in}} - p_{\\text{out}}$，对于所有给定的测试用例，该值均为正。\n2.  上界：$Q_b$ 必须选择得足够大，以确保 $p(L;Q_b)  p_{\\text{out}}$，从而使 $F(Q_b)$ 为负。找到这样一个 $Q_b$ 的一个安全方法是，计算等效刚性管的流量，$Q_{\\text{rigid}} = \\frac{\\pi R_0^4 (p_{\\text{in}}-p_{\\text{out}})}{8\\mu L}$，然后选择 $Q_b$ 为该估计值的倍数（例如，$10 \\times Q_{\\text{rigid}}$）。这通常足以引起足够大的压降。\n\n二分法算法通过重复地将区间 $[Q_a, Q_b]$ 对半分割，并选择根必定所在的子区间来进行。在每次迭代中，我们计算中点 $Q_{\\text{mid}} = (Q_a + Q_b)/2$ 并计算 $F(Q_{\\text{mid}})$ 的值。然后根据 $F(Q_{\\text{mid}})$ 的符号更新区间。当满足收敛标准时，该过程终止。问题将收敛标准定义为压力失配的绝对容差：\n$$\n|F(Q_{\\text{mid}})| = |p(L;Q_{\\text{mid}}) - p_{\\text{out}}|  \\varepsilon_p\n$$\n其中 $\\varepsilon_p = 10^{-3}$ Pa。\n\n实现过程结合了这些组件。一个主函数遍历所提供的测试用例。对于每个用例，它调用一个实现二分法的函数。该函数又在每次迭代中调用 RK4 积分程序来计算失配函数 $F(Q)$ 的值。然后，为每个用例计算出的最终 $Q$ 值将按要求进行格式化和打印。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for the flow rate Q for all test cases and print results.\n    \"\"\"\n\n    # Absolute pressure tolerance for the bisection method stopping criterion.\n    P_TOL = 1e-3\n\n    def compliance_law(p, R0, p0, c):\n        \"\"\"\n        Calculates the tube radius R as a function of local pressure p.\n        R(p) = R0 * [1 + c * (p - p0)]\n        \"\"\"\n        return R0 * (1.0 + c * (p - p0))\n\n    def dp_dx(p, Q, mu, R0, p0, c):\n        \"\"\"\n        Calculates the pressure gradient dp/dx at a given pressure p and flow rate Q.\n        dp/dx = -8*mu*Q / (pi * R(p)^4)\n        \"\"\"\n        R_p = compliance_law(p, R0, p0, c)\n        # The problem parameters ensure R_p is always positive.\n        return -8.0 * mu * Q / (np.pi * R_p**4)\n\n    def rk4_integrate(Q, L, N, p_in, mu, R0, p0, c):\n        \"\"\"\n        Integrates the pressure ODE from x=0 to x=L using the RK4 method.\n        Returns the pressure at the outlet, p(L).\n        \"\"\"\n        h = float(L) / N\n        p_current = float(p_in)\n        \n        for _ in range(N):\n            k1 = dp_dx(p_current, Q, mu, R0, p0, c)\n            k2 = dp_dx(p_current + 0.5 * h * k1, Q, mu, R0, p0, c)\n            k3 = dp_dx(p_current + 0.5 * h * k2, Q, mu, R0, p0, c)\n            k4 = dp_dx(p_current + h * k3, Q, mu, R0, p0, c)\n            p_current += (h / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n        \n        return p_current\n\n    def find_Q(params):\n        \"\"\"\n        Finds the flow rate Q using a shooting method with bisection.\n        The root finding is on the mismatch function F(Q) = p(L;Q) - p_out.\n        \"\"\"\n        L, R0, mu, p0, p_in, p_out, c, N = params\n\n        # Mismatch function for root finding.\n        def F(Q_trial):\n            p_L = rk4_integrate(Q_trial, L, N, p_in, mu, R0, p0, c)\n            return p_L - p_out\n\n        # Bisection method requires a bracket [q_low, q_high] where F(q_low) and F(q_high) have opposite signs.\n        # For Q=0, dp/dx=0, so p(L)=p_in. F(0) = p_in - p_out > 0 for all test cases.\n        q_low = 0.0\n        f_low = p_in - p_out\n        \n        # Estimate an upper bound for Q based on the rigid tube case.\n        # A multiple of this Q should cause a large pressure drop, making F(q_high)  0.\n        if p_in > p_out:\n            # A safety factor of 10 is generally sufficient.\n            q_rigid_est = (np.pi * R0**4 * (p_in - p_out)) / (8.0 * mu * L) if L > 0 else 0\n            q_high = q_rigid_est * 10.0 if q_rigid_est > 0 else 1e-4\n        else:\n            # If no pressure drop, flow rate must be zero.\n            return 0.0\n        \n        # Ensure the initial bracket is valid.\n        f_high = F(q_high)\n        max_bracket_searches = 10\n        for _ in range(max_bracket_searches):\n            if f_high  0:\n                break\n            q_high *= 2.0\n            f_high = F(q_high)\n        else: # If loop completes without break\n            raise RuntimeError(\"Failed to establish a valid bracket for Q.\")\n\n        # Bisection loop\n        max_iter = 100\n        for _ in range(max_iter):\n            q_mid = (q_low + q_high) / 2.0\n            if q_mid == q_low or q_mid == q_high: # Interval is too small\n                break\n            \n            f_mid = F(q_mid)\n            \n            # Stop if the pressure mismatch is within tolerance.\n            if abs(f_mid)  P_TOL:\n                return q_mid\n            \n            # Update the bracket.\n            if np.sign(f_mid) == np.sign(f_low):\n                q_low = q_mid\n                f_low = f_mid\n            else:\n                q_high = q_mid\n                f_high = f_mid\n        \n        return (q_low + q_high) / 2.0 # Return the best estimate.\n\n    # Test suite parameters: (L, R0, mu, p0, p_in, p_out, c, N)\n    test_cases = [\n        # Case 1: General compliant tube\n        (0.5, 2.5e-3, 3.5e-3, 1.0e4, 1.33e4, 1.0e4, 2.0e-5, 2000),\n        # Case 2: Rigid tube boundary case\n        (0.5, 2.5e-3, 3.5e-3, 1.0e4, 1.33e4, 1.0e4, 0.0, 2000),\n        # Case 3: High-compliance tube\n        (0.5, 2.5e-3, 3.5e-3, 1.0e4, 1.33e4, 1.0e4, 8.0e-5, 2000),\n        # Case 4: Short tube with small pressure drop\n        (0.05, 1.5e-3, 3.5e-3, 1.0e4, 1.05e4, 1.0e4, 5.0e-5, 1000),\n    ]\n\n    results = []\n    for case in test_cases:\n        q_val = find_Q(case)\n        results.append(f\"{q_val:.6e}\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}