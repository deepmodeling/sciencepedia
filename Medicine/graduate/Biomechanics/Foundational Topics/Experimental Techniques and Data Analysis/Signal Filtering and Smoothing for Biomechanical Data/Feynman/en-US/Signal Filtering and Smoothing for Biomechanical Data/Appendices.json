{
    "hands_on_practices": [
        {
            "introduction": "Before we can filter data, we must understand the pitfalls of acquiring it digitally. This exercise explores aliasing, a fundamental concept where high-frequency content can masquerade as a lower-frequency signal if the sampling rate is insufficient. By deriving the aliased frequency from first principles, you will gain a crucial understanding of the Nyquist-Shannon sampling theorem and why anti-aliasing filters are essential for ensuring data integrity .",
            "id": "4202751",
            "problem": "You are analyzing motion-induced interference in a high-fidelity Electromyography (EMG) acquisition system used in biomechanics. The EMG preamplifier inadvertently passes a single-tone sinusoid at continuous-time frequency $f_0$ that is greater than the Nyquist frequency $f_N$, where the Nyquist frequency is defined as $f_N = \\frac{f_s}{2}$, and $f_s$ is the uniform sampling rate. There is no analog anti-aliasing filter prior to sampling. Starting from the definitions of sampling with period $T_s = \\frac{1}{f_s}$ and the discrete-time frequency of a sampled sinusoid, derive an analytic expression for the aliased frequency $f_{\\mathrm{alias}}$ that will be observed in the sampled EMG data within the baseband interval $[0, f_N]$ when a sinusoid at $f_0 > f_N$ is sampled at rate $f_s$. Then compute $f_{\\mathrm{alias}}$ for $f_0 = 80\\,\\text{Hz}$ and $f_s = 100\\,\\text{Hz}$. Express the final aliased frequency in Hz. No rounding is required.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It addresses the fundamental principle of aliasing in digital signal processing, which is a common and critical issue in the acquisition of biomechanical data. The problem provides all necessary parameters for a unique solution. Therefore, we proceed with the derivation and calculation.\n\nLet the continuous-time sinusoidal signal representing the interference be denoted by $x_c(t)$:\n$$x_c(t) = A \\cos(2\\pi f_0 t + \\phi)$$\nwhere $A$ is the amplitude, $f_0$ is the continuous-time frequency in Hertz, $t$ is time, and $\\phi$ is the phase.\n\nThis signal is sampled uniformly at a rate of $f_s$ samples per second, corresponding to a sampling period of $T_s = \\frac{1}{f_s}$. The discrete-time signal, $x[n]$, is obtained by evaluating $x_c(t)$ at the discrete time instants $t = nT_s$, where $n$ is an integer index.\n$$x[n] = x_c(nT_s) = A \\cos(2\\pi f_0 n T_s + \\phi)$$\nSubstituting $T_s = \\frac{1}{f_s}$ into the equation gives the expression for the sampled signal in terms of the sampling frequency:\n$$x[n] = A \\cos\\left(2\\pi \\frac{f_0}{f_s} n + \\phi\\right)$$\nThe term $2\\pi \\frac{f_0}{f_s}$ is the normalized discrete-time angular frequency, which can be denoted as $\\omega_0$.\n\nA cardinal property of discrete-time sinusoids is the periodicity of their frequency spectrum. The discrete-time Fourier transform is periodic with a period of $2\\pi$ in the normalized angular frequency domain. Consequently, any two angular frequencies $\\omega_1$ and $\\omega_2$ are indistinguishable if they are separated by an integer multiple of $2\\pi$. For a real-valued cosine signal, this is expressed by the identity:\n$$\\cos(\\omega n + \\phi) = \\cos(\\omega n \\pm 2\\pi k n + \\phi) = \\cos((\\omega \\pm 2\\pi k)n + \\phi)$$\nfor any integer $k$.\n\nThis property implies that after sampling, a continuous-time frequency $f_0$ is indistinguishable from any frequency in the set $\\{f_0 + k f_s \\mid k \\in \\mathbb{Z}\\}$. The process of sampling maps this infinite set of continuous-time frequencies onto a single discrete-time representation.\n\nThe problem requires finding the aliased frequency, $f_{\\mathrm{alias}}$, which is the unique representation of $f_0$ that falls within the baseband interval $[0, f_N]$. The Nyquist frequency $f_N$ is defined as $f_N = \\frac{f_s}{2}$. For real signals, this interval represents the range of unique frequencies that can be resolved without ambiguity.\n\nTo find $f_{\\mathrm{alias}}$, we must identify the frequency within the interval $[0, \\frac{f_s}{2}]$ that is equivalent to $f_0$ under the equivalence relation $f \\sim f + kf_s$. This can be visualized as \"folding\" the frequency axis at every integer multiple of the Nyquist frequency $f_N = f_s/2$. Analytically, this corresponds to finding the absolute distance from the original frequency $f_0$ to the nearest integer multiple of the sampling frequency $f_s$.\n\nLet the set of integer multiples of the sampling frequency be $M = \\{k f_s \\mid k \\in \\mathbb{Z}\\}$. We must find the member of this set, $k^* f_s$, that is closest to $f_0$. The integer $k^*$ that minimizes the distance $|f_0 - k f_s|$ is found by rounding the ratio $\\frac{f_0}{f_s}$ to the nearest integer:\n$$k^* = \\text{round}\\left(\\frac{f_0}{f_s}\\right)$$\nwhere $\\text{round}(x)$ is the function that rounds its argument $x$ to the nearest integer.\n\nThe aliased frequency, $f_{\\mathrm{alias}}$, is the absolute value of the difference between $f_0$ and this nearest multiple of $f_s$:\n$$f_{\\mathrm{alias}} = \\left|f_0 - k^* f_s\\right| = \\left|f_0 - \\text{round}\\left(\\frac{f_0}{f_s}\\right) f_s\\right|$$\nThis general expression yields the aliased frequency in the interval $[0, \\frac{f_s}{2}]$.\n\nWe now apply this derived formula to the specific values provided in the problem statement:\n- Original continuous-time frequency: $f_0 = 80\\,\\text{Hz}$\n- Uniform sampling rate: $f_s = 100\\,\\text{Hz}$\n\nFirst, we determine the Nyquist frequency to confirm that aliasing occurs:\n$$f_N = \\frac{f_s}{2} = \\frac{100}{2} = 50\\,\\text{Hz}$$\nSince $f_0 = 80\\,\\text{Hz}$ is greater than $f_N = 50\\,\\text{Hz}$, the signal is undersampled, and its frequency will be aliased into the baseband.\n\nNext, we calculate the ratio of the original frequency to the sampling frequency:\n$$\\frac{f_0}{f_s} = \\frac{80}{100} = 0.8$$\nWe round this ratio to the nearest integer to find $k^*$:\n$$k^* = \\text{round}(0.8) = 1$$\nFinally, we substitute these values into the expression for the aliased frequency:\n$$f_{\\mathrm{alias}} = |80 - (1) \\times 100| = |80 - 100| = |-20| = 20$$\nThe resulting aliased frequency is $20\\,\\text{Hz}$. This value lies within the required baseband interval $[0, 50\\,\\text{Hz}]$. Thus, the $80\\,\\text{Hz}$ sinusoidal interference will appear in the sampled EMG data as an artifact at a frequency of $20\\,\\text{Hz}$.",
            "answer": "$$\\boxed{20}$$"
        },
        {
            "introduction": "After ensuring proper data acquisition, the next step is often to design a filter to remove noise while preserving the true signal. This practice challenges you to design a digital low-pass filter based on common biomechanical requirements, translating specifications like passband ripple and stopband attenuation into a concrete filter order. This exercise bridges the gap between theoretical filter properties and practical application in cleaning kinematic data .",
            "id": "4202801",
            "problem": "A tibial Inertial Measurement Unit (IMU) records sagittal-plane knee joint angles during running at a sampling frequency of $f_{\\mathrm{samp}} = 200$ Hz. The physiologically meaningful motion content is concentrated below $f_{\\mathrm{p}} = 8$ Hz, whereas sensor microvibrations and soft tissue artifacts contribute energy above $f_{\\mathrm{sb}} = 35$ Hz. To attenuate these artifacts while preserving the kinematic signal, you will design a digital low-pass filter obtained from an analog Chebyshev Type I prototype via the bilinear transform. The design specifications are a passband ripple no greater than $0.5$ decibels (dB) and a stopband attenuation no less than $40$ dB. The passband edge is set at $f_{\\mathrm{p}}$ and the stopband edge at $f_{\\mathrm{sb}}$. Use frequency prewarping for the bilinear transform, with the analog prototype frequency variable defined by $\\Omega = 2 f_{\\mathrm{samp}} \\tan\\!\\left( \\pi f / f_{\\mathrm{samp}} \\right)$ for a digital frequency $f$ expressed in hertz.\n\nStarting from first principles—namely, the definition of the Chebyshev Type I magnitude-squared response in terms of the Chebyshev polynomials of the first kind, the decibel relationships for ripple and attenuation, and the bilinear transform mapping—derive the minimal filter order $N$ that simultaneously satisfies these passband and stopband specifications. Express your final answer as the smallest integer $N$ that meets both constraints. No rounding to a specified number of significant figures is required. Report the single integer value $N$ without units.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard task in digital signal processing: the design of an Infinite Impulse Response (IIR) filter based on an analog prototype to meet specific frequency-domain criteria. The application is in biomechanics, a field where such filtering is routine. All provided data ($f_{\\mathrm{samp}}$, $f_{\\mathrm{p}}$, $f_{\\mathrm{sb}}$, $A_{\\mathrm{p}}$, $A_{\\mathrm{s}}$), definitions (Chebyshev Type I filter), and methodologies (bilinear transform with prewarping) are standard, consistent, and sufficient to determine a unique, minimal filter order. The problem is therefore deemed valid and a solution can be formulated.\n\nThe task is to find the minimal integer order $N$ for a Chebyshev Type I low-pass filter that satisfies the given specifications. The design process involves mapping the digital filter specifications to an analog prototype domain, determining the required order for the analog filter, and then transforming it back to the digital domain. The filter order $N$ is invariant under the bilinear transform.\n\nThe magnitude-squared frequency response of an $N$-th order analog low-pass Chebyshev Type I filter is given by:\n$$ |H_a(j\\Omega)|^2 = \\frac{1}{1 + \\epsilon^2 T_N^2(\\frac{\\Omega}{\\Omega_{\\mathrm{p}}})} $$\nwhere $\\Omega$ is the analog frequency in radians per second, $\\Omega_{\\mathrm{p}}$ is the analog passband edge frequency, $T_N(x)$ is the Chebyshev polynomial of the first kind of order $N$, and $\\epsilon$ is a parameter that determines the passband ripple.\n\nFirst, we relate the design specifications, given in decibels (dB), to the parameters of the filter response.\n\nThe passband ripple specification is $A_{\\mathrm{p}} \\le 0.5$ dB. At the passband edge $\\Omega = \\Omega_{\\mathrm{p}}$, $T_N^2(1) = 1$, and the magnitude-squared response reaches its minimum in the passband, $|H_a(j\\Omega_{\\mathrm{p}})|^2 = \\frac{1}{1+\\epsilon^2}$. The passband ripple in dB is defined as $A_{\\mathrm{p}} = 10 \\log_{10}(1+\\epsilon^2)$. We use the maximum allowed ripple to find the required $\\epsilon$:\n$$ A_{\\mathrm{p}} = 0.5 \\, \\text{dB} $$\n$$ 10 \\log_{10}(1 + \\epsilon^2) = 0.5 $$\n$$ 1 + \\epsilon^2 = 10^{0.05} $$\n$$ \\epsilon^2 = 10^{0.05} - 1 $$\nThis gives $\\epsilon = \\sqrt{10^{0.05} - 1}$.\n\nThe stopband attenuation specification is $A_{\\mathrm{s}} \\ge 40$ dB at the stopband edge frequency $\\Omega_{\\mathrm{s}}$. The attenuation is the reciprocal of the magnitude response. In dB, this is written as $A_{\\mathrm{s}} \\le -20 \\log_{10}(|H_a(j\\Omega_{\\mathrm{s}})|)$. This is equivalent to $|H_a(j\\Omega_{\\mathrm{s}})|^2 \\le 10^{-A_{\\mathrm{s}}/10}$.\n$$ A_{\\mathrm{s}} = 40 \\, \\text{dB} $$\n$$ \\frac{1}{1 + \\epsilon^2 T_N^2(\\frac{\\Omega_{\\mathrm{s}}}{\\Omega_{\\mathrm{p}}})} \\le 10^{-40/10} = 10^{-4} $$\nRearranging this inequality to solve for $T_N$:\n$$ 1 + \\epsilon^2 T_N^2(\\frac{\\Omega_{\\mathrm{s}}}{\\Omega_{\\mathrm{p}}}) \\ge 10^4 $$\n$$ \\epsilon^2 T_N^2(\\frac{\\Omega_{\\mathrm{s}}}{\\Omega_{\\mathrm{p}}}) \\ge 10^4 - 1 $$\n$$ |T_N(\\frac{\\Omega_{\\mathrm{s}}}{\\Omega_{\\mathrm{p}}})| \\ge \\frac{\\sqrt{10^4 - 1}}{\\epsilon} $$\n\nNext, we must determine the analog frequencies $\\Omega_{\\mathrm{p}}$ and $\\Omega_{\\mathrm{s}}$ from the given digital frequencies $f_{\\mathrm{p}} = 8$ Hz and $f_{\\mathrm{sb}} = 35$ Hz using the specified prewarping formula: $\\Omega = 2 f_{\\mathrm{samp}} \\tan(\\pi f / f_{\\mathrm{samp}})$, with $f_{\\mathrm{samp}} = 200$ Hz.\nThe analog passband edge frequency is:\n$$ \\Omega_{\\mathrm{p}} = 2 f_{\\mathrm{samp}} \\tan\\left(\\frac{\\pi f_{\\mathrm{p}}}{f_{\\mathrm{samp}}}\\right) = 2(200) \\tan\\left(\\frac{\\pi \\cdot 8}{200}\\right) = 400 \\tan(0.04\\pi) \\, \\frac{\\text{rad}}{\\text{s}} $$\nThe analog stopband edge frequency is:\n$$ \\Omega_{\\mathrm{s}} = 2 f_{\\mathrm{samp}} \\tan\\left(\\frac{\\pi f_{\\mathrm{sb}}}{f_{\\mathrm{samp}}}\\right) = 2(200) \\tan\\left(\\frac{\\pi \\cdot 35}{200}\\right) = 400 \\tan(0.175\\pi) \\, \\frac{\\text{rad}}{\\text{s}} $$\nThe ratio $\\Omega_{\\mathrm{s}}/\\Omega_{\\mathrm{p}}$ is therefore:\n$$ \\frac{\\Omega_{\\mathrm{s}}}{\\Omega_{\\mathrm{p}}} = \\frac{400 \\tan(0.175\\pi)}{400 \\tan(0.04\\pi)} = \\frac{\\tan(0.175\\pi)}{\\tan(0.04\\pi)} $$\nSince $f_{\\mathrm{sb}} > f_{\\mathrm{p}}$, it follows that $\\Omega_{\\mathrm{s}} > \\Omega_{\\mathrm{p}}$, and the argument of the Chebyshev polynomial is greater than $1$. For $x > 1$, the Chebyshev polynomial can be expressed using the hyperbolic cosine: $T_N(x) = \\cosh(N \\operatorname{arccosh}(x))$.\nSubstituting this into our inequality:\n$$ \\cosh\\left(N \\operatorname{arccosh}\\left(\\frac{\\Omega_{\\mathrm{s}}}{\\Omega_{\\mathrm{p}}}\\right)\\right) \\ge \\frac{\\sqrt{10^4 - 1}}{\\epsilon} $$\nSince $\\operatorname{arccosh}(x)$ is a monotonically increasing function for $x \\ge 1$:\n$$ N \\operatorname{arccosh}\\left(\\frac{\\Omega_{\\mathrm{s}}}{\\Omega_{\\mathrm{p}}}\\right) \\ge \\operatorname{arccosh}\\left(\\frac{\\sqrt{10^4 - 1}}{\\epsilon}\\right) $$\nSolving for $N$:\n$$ N \\ge \\frac{\\operatorname{arccosh}\\left(\\frac{\\sqrt{10^4 - 1}}{\\epsilon}\\right)}{\\operatorname{arccosh}\\left(\\frac{\\Omega_{\\mathrm{s}}}{\\Omega_{\\mathrm{p}}}\\right)} $$\nNow, we substitute the expressions for $\\epsilon$ and the frequency ratio:\n$$ N \\ge \\frac{\\operatorname{arccosh}\\left(\\frac{\\sqrt{10^4 - 1}}{\\sqrt{10^{0.05} - 1}}\\right)}{\\operatorname{arccosh}\\left(\\frac{\\tan(0.175\\pi)}{\\tan(0.04\\pi)}\\right)} $$\nWe proceed to evaluate the terms numerically.\nThe argument of the numerator's $\\operatorname{arccosh}$ is:\n$$ \\frac{\\sqrt{10000 - 1}}{\\sqrt{10^{0.05} - 1}} \\approx \\frac{\\sqrt{9999}}{\\sqrt{1.122018 - 1}} \\approx \\frac{99.995}{\\sqrt{0.122018}} \\approx \\frac{99.995}{0.34931} \\approx 286.265 $$\nThe argument of the denominator's $\\operatorname{arccosh}$ is:\n$$ \\frac{\\tan(0.175\\pi)}{\\tan(0.04\\pi)} \\approx \\frac{\\tan(0.549779)}{\\tan(0.125664)} \\approx \\frac{0.62487}{0.12633} \\approx 4.94623 $$\nNow we evaluate the $\\operatorname{arccosh}$ functions. We can use the identity $\\operatorname{arccosh}(x) = \\ln(x + \\sqrt{x^2-1})$.\nNumerator:\n$$ \\operatorname{arccosh}(286.265) \\approx \\ln(286.265 + \\sqrt{286.265^2 - 1}) \\approx \\ln(572.528) \\approx 6.3500 $$\nDenominator:\n$$ \\operatorname{arccosh}(4.94623) \\approx \\ln(4.94623 + \\sqrt{4.94623^2 - 1}) \\approx \\ln(9.7903) \\approx 2.2814 $$\nFinally, we compute the lower bound for $N$:\n$$ N \\ge \\frac{6.3500}{2.2814} \\approx 2.7834 $$\nSince the filter order $N$ must be an integer, we must choose the smallest integer that satisfies this condition, which is the ceiling of the calculated value.\n$$ N = \\lceil 2.7834 \\rceil = 3 $$\nTherefore, the minimal filter order required to meet both passband and stopband specifications is $3$.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "Theoretical design must be paired with practical analysis to be effective. This hands-on coding exercise guides you through estimating the Power Spectral Density (PSD) of a biomechanical signal using Welch’s method, a robust technique to visualize how a signal's power is distributed across different frequencies. By identifying dominant frequency components in a simulated knee angle signal, you will develop the essential skill of characterizing signals and verifying the performance of your filtering techniques .",
            "id": "4202813",
            "problem": "A knee joint flexion-extension angle time series is a one-dimensional kinematic signal that can be modeled as a real-valued function $x(t)$ measured in degrees over time $t$ expressed in seconds. When discretely sampled at sampling frequency $f_{s}$ in Hertz, the series becomes $x[n]$ for integer sample index $n$ separated by sampling interval $\\Delta t = 1/f_{s}$. The goal is to estimate the Power Spectral Density (PSD) of this signal and interpret the dominant frequency components that reflect periodic biomechanical patterns such as gait cycles. The Power Spectral Density (PSD) quantifies how the power of a signal is distributed across frequency and, for discrete-time signals, is typically estimated by consistent methods that reduce variance and spectral leakage through windowing and averaging. In this problem, the PSD must be computed using Welch’s method with a Hanning window (also known as a Hann window) and $50\\%$ overlap between consecutive segments. Angles must be in degrees, and frequencies must be reported in Hertz.\n\nStarting from fundamentals, assume the signal $x[n]$ is wide-sense stationary within the analysis window and that the Discrete-Time Fourier Transform (DTFT) relates time-domain measurements to their frequency-domain representation. In finite-length, noisy data, variance reduction and leakage suppression motivate windowing and segment averaging. Welch’s method accomplishes this by partitioning $x[n]$ into segments of length $L$, applying a window $w[n]$ per segment, computing a segment periodogram, and averaging across segments. The Hanning window is a smooth, cosine-tapered window that reduces spectral leakage compared to a rectangular window. Overlapping segments by $50\\%$ increases the number of averages, thereby further reducing estimator variance.\n\nYou must implement the following tasks:\n- For each test case, synthesize a knee angle time series $x[n]$ in degrees as the sum of sinusoids of specified amplitudes and frequencies, optionally including a small linear drift term and additive zero-mean Gaussian noise with specified standard deviation in degrees.\n- Compute the PSD $S_{xx}(f)$ using Welch’s method with a Hanning window, segment length $L$ (in samples), and overlap $L/2$ (rounded down to an integer if necessary). Use density scaling so that the PSD has units of $\\text{degrees}^{2}/\\text{Hz}$.\n- Identify dominant frequency components within a specified biomechanically relevant band $[f_{\\min}, f_{\\max}]$ in Hertz, using a peak selection criterion that requires a peak to exceed a relative threshold $\\alpha$ times the maximum PSD within the band and also exceed a noise floor factor $\\beta$ times the median PSD within the band. Only frequencies that are local maxima under these thresholds should be returned as dominant. Report each dominant frequency rounded to two decimal places, in Hertz.\n- Angles must be in degrees. All frequency outputs must be in Hertz. The final output must be a single line that aggregates the results for all test cases into a single bracketed list, where each item is itself a bracketed list of floats representing the dominant frequencies discovered for that test case, with no spaces anywhere in the entire line. The final output must thus look like a bracketed list of bracketed lists of floats, with each float rounded to two decimal places.\n\nTest suite:\nProvide results for the following four cases; each case must be synthesized and analyzed independently using the exact parameters below. Use a fixed random seed per case for reproducibility.\n\n- Case $1$ (happy path, multi-component gait-like signal):\n  - Sampling frequency $f_{s} = 120$ Hz, duration $T = 12$ s, total samples $N = f_{s} \\cdot T$.\n  - Components: amplitudes and frequencies $(A_{1}, f_{1}) = (25, 1.80)$, $(A_{2}, f_{2}) = (8, 3.60)$, $(A_{3}, f_{3}) = (5, 3.20)$ in degrees and Hertz, with phases $(\\phi_{1}, \\phi_{2}, \\phi_{3}) = (0.00, 0.50, 1.00)$ radians.\n  - Additive noise: standard deviation $\\sigma = 1.50$ degrees, zero mean.\n  - Window length $L = 512$ samples, overlap $L/2$.\n  - Band limits $[f_{\\min}, f_{\\max}] = [0.50, 10.00]$ Hz.\n  - Relative threshold $\\alpha = 0.20$, noise floor factor $\\beta = 3.00$.\n  - Random seed $s = 12345$.\n\n- Case $2$ (boundary condition, single segment):\n  - Sampling frequency $f_{s} = 100$ Hz, duration $T = 2.56$ s, total samples $N = 256$.\n  - Components: $(A_{1}, f_{1}) = (30, 2.00)$ degrees and Hertz, with phase $\\phi_{1} = 0.00$ radians.\n  - Additive noise: $\\sigma = 0.50$ degrees.\n  - Window length $L = 256$ samples, overlap $L/2$.\n  - Band limits $[f_{\\min}, f_{\\max}] = [0.50, 10.00]$ Hz.\n  - Relative threshold $\\alpha = 0.30$, noise floor factor $\\beta = 3.00$.\n  - Random seed $s = 23456$.\n\n- Case $3$ (edge case, low-frequency trend outside gait band):\n  - Sampling frequency $f_{s} = 100$ Hz, duration $T = 15.00$ s, total samples $N = 1500$.\n  - Components: $(A_{1}, f_{1}) = (15, 0.20)$ degrees and Hertz, with phase $\\phi_{1} = 0.00$ radians.\n  - Linear drift: rate $d = 0.50$ degrees per second.\n  - Additive noise: $\\sigma = 1.00$ degrees.\n  - Window length $L = 512$ samples, overlap $L/2$.\n  - Band limits $[f_{\\min}, f_{\\max}] = [0.50, 10.00]$ Hz.\n  - Relative threshold $\\alpha = 0.40$, noise floor factor $\\beta = 3.00$.\n  - Random seed $s = 34567$.\n\n- Case $4$ (edge case, frequency near resolution limit):\n  - Sampling frequency $f_{s} = 90$ Hz, duration $T = 5.00$ s, total samples $N = 450$.\n  - Components: $(A_{1}, f_{1}) = (15, 1.95)$ degrees and Hertz, with phase $\\phi_{1} = 0.00$ radians.\n  - Additive noise: $\\sigma = 1.50$ degrees.\n  - Window length $L = 256$ samples, overlap $L/2$.\n  - Band limits $[f_{\\min}, f_{\\max}] = [0.50, 10.00]$ Hz.\n  - Relative threshold $\\alpha = 0.25$, noise floor factor $\\beta = 3.00$.\n  - Random seed $s = 45678$.\n\nYour program must:\n- Synthesize each signal $x[n]$ in degrees according to the provided parameters.\n- Compute the PSD using Welch’s method with a Hanning (Hann) window and $50\\%$ overlap.\n- Within the specified band for each case, find local maxima that exceed both thresholds defined above, and return their frequencies rounded to two decimal places.\n- Produce a single line of output containing the four results as a comma-separated list enclosed in square brackets. Each result is itself a bracketed list of floats, with no spaces anywhere. For example, the outer list has four items, and an inner list may be empty if no dominant components are detected under the specified criteria. The numerical frequencies must be in Hertz.\n\nThe final outputs for all test cases must be floats or lists of floats. No other text must be printed.",
            "solution": "The problem statement has been critically validated and is deemed to be valid. It is scientifically grounded in the principles of digital signal processing, specifically power spectral density (PSD) estimation, and applies these principles to a well-defined problem in biomechanics. The problem is self-contained, with all necessary parameters, conditions, and constraints explicitly provided for each test case. The language is objective and precise, and the structure is well-posed, leading to a unique and verifiable solution.\n\nThe task is to implement an algorithm for identifying dominant frequencies in a synthesized biomechanical signal, specifically a knee joint flexion-extension angle time series. The solution involves three primary stages: signal synthesis, PSD estimation using Welch's method, and a rule-based peak detection algorithm.\n\nFirst, the signal synthesis is performed based on a defined model. A discrete-time signal $x[n]$ is generated over a duration $T$ with a sampling frequency $f_s$. The total number of samples is $N = f_s T$. The time vector is $t_n = n/f_s$ for $n = 0, 1, \\dots, N-1$. The signal model is a superposition of sinusoids with a potential linear trend and additive noise:\n$$x[n] = \\sum_{i} A_i \\sin(2\\pi f_i t_n + \\phi_i) + d \\cdot t_n + \\epsilon[n]$$\nHere, $A_i$, $f_i$, and $\\phi_i$ are the amplitude, frequency, and phase of the $i$-th sinusoidal component, respectively. The term $d \\cdot t_n$ represents a linear drift with rate $d$ in degrees per second. The noise term, $\\epsilon[n]$, is modeled as an independent and identically distributed sequence drawn from a zero-mean Gaussian distribution with standard deviation $\\sigma$. For reproducibility, a specific random seed is used for each case when generating $\\epsilon[n]$.\n\nSecond, the Power Spectral Density (PSD) of the synthesized signal $x[n]$ is estimated using Welch's method. This technique is designed to reduce the variance of the PSD estimate compared to a simple periodogram of the entire signal. The method involves the following steps:\n1. The signal $x[n]$ of length $N$ is partitioned into $K$ potentially overlapping segments of length $L$. For this problem, the overlap is specified as $50\\%$ of the segment length, i.e., $L/2$ samples.\n2. Each segment is multiplied by a window function $w[n]$, here a Hanning window, to reduce spectral leakage that arises from the finite length of the data segments. The Hanning window is defined as:\n$$ w[n] = 0.5 \\left(1 - \\cos\\left(\\frac{2\\pi n}{L-1}\\right)\\right), \\quad 0 \\le n < L $$\n3. For each windowed segment, the periodogram is computed. With `density` scaling, the periodogram $I_k(f)$ for the $k$-th segment is normalized to have units of $\\text{power}/\\text{Hz}$ (here, $\\text{degrees}^2/\\text{Hz}$). This normalization is achieved by dividing by the sampling frequency $f_s$ and the sum of the squared window samples, $U = \\sum_{n=0}^{L-1} w[n]^2$.\n4. The final PSD estimate, $S_{xx}(f)$, is obtained by averaging the periodograms from all $K$ segments:\n$$ S_{xx}(f) = \\frac{1}{K} \\sum_{k=0}^{K-1} I_k(f) $$\nThis averaging process reduces the variance of the estimate. The frequency resolution of the resulting PSD is $\\Delta f = f_s/L$.\n\nThird, dominant frequencies are identified from the estimated PSD, $S_{xx}(f)$, within a specified biomechanically relevant frequency band $[f_{\\min}, f_{\\max}]$. A frequency bin is considered dominant if it meets a multi-condition criterion. A peak at frequency $f_p$ must be a local maximum and its magnitude $S_{xx}(f_p)$ must satisfy two thresholds simultaneously:\n1. A relative magnitude threshold, where the peak's power must exceed a fraction $\\alpha$ of the maximum power within the band:\n$$ S_{xx}(f_p) > \\alpha \\cdot \\max_{f \\in [f_{\\min}, f_{\\max}]} \\{S_{xx}(f)\\} $$\n2. A noise floor threshold, where the peak's power must be significantly greater than the background noise level, estimated by the median power within the band:\n$$ S_{xx}(f_p) > \\beta \\cdot \\text{median}_{f \\in [f_{\\min}, f_{\\max}]} \\{S_{xx}(f)\\} $$\nA peak is reported only if both conditions are met. This is equivalent to requiring that its magnitude be greater than the maximum of the two threshold values.\n\nThe implementation will proceed by iterating through the four specified test cases. For each case, the signal will be synthesized, and its PSD will be computed using `scipy.signal.welch`. Then, local maxima in the PSD within the specified band will be identified using `scipy.signal.find_peaks`, with its `height` parameter set to enforce both detection thresholds. The frequencies of the identified peaks are collected and formatted according to the specified output requirements.",
            "answer": "```python\nimport numpy as np\nfrom scipy import signal\n\ndef solve():\n    \"\"\"\n    Solves the problem by synthesizing signals, computing PSDs, \n    and identifying dominant frequencies for four test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"fs\": 120, \"T\": 12,\n            \"components\": [\n                {\"A\": 25, \"f\": 1.80, \"phi\": 0.00},\n                {\"A\": 8,  \"f\": 3.60, \"phi\": 0.50},\n                {\"A\": 5,  \"f\": 3.20, \"phi\": 1.00}\n            ],\n            \"drift\": 0.0,\n            \"noise_sigma\": 1.50,\n            \"L\": 512,\n            \"f_min\": 0.50, \"f_max\": 10.00,\n            \"alpha\": 0.20, \"beta\": 3.00,\n            \"seed\": 12345\n        },\n        {\n            \"fs\": 100, \"T\": 2.56,\n            \"components\": [\n                {\"A\": 30, \"f\": 2.00, \"phi\": 0.00}\n            ],\n            \"drift\": 0.0,\n            \"noise_sigma\": 0.50,\n            \"L\": 256,\n            \"f_min\": 0.50, \"f_max\": 10.00,\n            \"alpha\": 0.30, \"beta\": 3.00,\n            \"seed\": 23456\n        },\n        {\n            \"fs\": 100, \"T\": 15.00,\n            \"components\": [\n                {\"A\": 15, \"f\": 0.20, \"phi\": 0.00}\n            ],\n            \"drift\": 0.50,\n            \"noise_sigma\": 1.00,\n            \"L\": 512,\n            \"f_min\": 0.50, \"f_max\": 10.00,\n            \"alpha\": 0.40, \"beta\": 3.00,\n            \"seed\": 34567\n        },\n        {\n            \"fs\": 90, \"T\": 5.00,\n            \"components\": [\n                {\"A\": 15, \"f\": 1.95, \"phi\": 0.00}\n            ],\n            \"drift\": 0.0,\n            \"noise_sigma\": 1.50,\n            \"L\": 256,\n            \"f_min\": 0.50, \"f_max\": 10.00,\n            \"alpha\": 0.25, \"beta\": 3.00,\n            \"seed\": 45678\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Set seed for reproducibility\n        np.random.seed(case[\"seed\"])\n\n        # Signal Synthesis\n        fs = case[\"fs\"]\n        T = case[\"T\"]\n        N = int(fs * T)\n        t = np.arange(N) / fs\n        \n        x = np.zeros(N)\n\n        # Add sinusoidal components\n        for comp in case[\"components\"]:\n            x += comp[\"A\"] * np.sin(2 * np.pi * comp[\"f\"] * t + comp[\"phi\"])\n        \n        # Add linear drift\n        if case[\"drift\"] > 0:\n            x += case[\"drift\"] * t\n\n        # Add Gaussian noise\n        x += np.random.normal(0, case[\"noise_sigma\"], N)\n\n        # PSD Computation using Welch's method\n        L = case[\"L\"]\n        overlap = L // 2\n        f, Pxx = signal.welch(x, fs=fs, window='hann', nperseg=L, noverlap=overlap, scaling='density')\n\n        # Dominant Frequency Identification\n        f_min, f_max = case[\"f_min\"], case[\"f_max\"]\n        band_indices = np.where((f >= f_min) & (f <= f_max))\n        \n        f_band = f[band_indices]\n        Pxx_band = Pxx[band_indices]\n        \n        dominant_freqs = []\n        if len(f_band) > 0:\n            # Calculate thresholds\n            max_psd_in_band = np.max(Pxx_band)\n            rel_threshold = case[\"alpha\"] * max_psd_in_band\n            \n            median_psd_in_band = np.median(Pxx_band)\n            noise_floor_threshold = case[\"beta\"] * median_psd_in_band\n            \n            # Combined threshold for peak finding\n            min_height = max(rel_threshold, noise_floor_threshold)\n\n            # Find peaks that satisfy the height requirement\n            peak_indices, _ = signal.find_peaks(Pxx_band, height=min_height)\n            \n            dominant_freqs = [round(f_band[i], 2) for i in peak_indices]\n        \n        all_results.append(dominant_freqs)\n\n    # Format the final output string\n    # e.g., [[1.88,3.28,3.52],[2.00],[],[2.11]]\n    output_parts = []\n    for res_list in all_results:\n        inner_list_str = '[' + ','.join([f\"{freq:.2f}\" for freq in res_list]) + ']'\n        output_parts.append(inner_list_str)\n    \n    final_output_string = '[' + ','.join(output_parts) + ']'\n    print(final_output_string)\n\nsolve()\n\n```"
        }
    ]
}