{
    "hands_on_practices": [
        {
            "introduction": "本练习将指导您完成创建技术上可靠的解剖参考坐标系的基础过程。利用从假设的解剖标志点数据中得到的向量，您将应用格拉姆-施密特正交化方法和叉积来构建一个右手正交基，这是生物力学分析的一项核心技能 ()。",
            "id": "4163223",
            "problem": "一个实验室坐标测量系统在一个全局笛卡尔坐标系中采集了人体前臂节段上解剖学标志点的三维位置。根据这些标志点，形成了两个位移矢量：\n$$\\mathbf{u} = \\begin{pmatrix}36 \\\\ -12 \\\\ 48\\end{pmatrix}\\ \\text{mm}, \\quad \\mathbf{v} = \\begin{pmatrix}18 \\\\ 30 \\\\ -6\\end{pmatrix}\\ \\text{mm}.$$\n根据国际生物力学学会 (ISB) 推荐的常用实践，可以从基于标志点的方向构建一个固定于刚性节段上的解剖学参考坐标系。你需要仅使用以下核心定义来构建一个节段固定的标准正交右手基 $\\{\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}}\\}$：\n- 矢量 $\\mathbf{a}$ 和 $\\mathbf{b}$ 的点积为 $\\mathbf{a}\\cdot\\mathbf{b}$，欧几里得范数为 $\\|\\mathbf{a}\\| = \\sqrt{\\mathbf{a}\\cdot\\mathbf{a}}$。\n- 格拉姆-施密特过程使用由点积定义的投影和通过欧几里得范数进行的归一化，来对一组非共线矢量进行标准正交化。\n- 叉积 $\\mathbf{a}\\times\\mathbf{b}$ 返回一个与 $\\mathbf{a}$ 和 $\\mathbf{b}$ 都正交的矢量，并确定了右手法则。\n定义 $\\hat{\\mathbf{x}}$ 为沿 $\\mathbf{u}$（长轴近端到远端方向）的单位矢量，定义 $\\hat{\\mathbf{y}}$ 为将 $\\mathbf{v}$ 相对于 $\\hat{\\mathbf{x}}$ 进行标准正交化后得到的单位矢量，使得 $\\hat{\\mathbf{y}}$ 位于 $\\mathbf{u}$ 和 $\\mathbf{v}$ 的生成空间内但与 $\\hat{\\mathbf{x}}$ 正交，并定义 $\\hat{\\mathbf{z}} = \\hat{\\mathbf{x}} \\times \\hat{\\mathbf{y}}$ 来构成一个右手三元组。将得到的基写成 $3\\times 3$ 的方向矩阵\n$$B = [\\hat{\\mathbf{x}}\\ \\hat{\\mathbf{y}}\\ \\hat{\\mathbf{z}}],$$\n所有元素均使用根式精确表示。该方向矩阵是无量纲的。不需要进行数值舍入。",
            "solution": "用户要求从给定的两个矢量 $\\mathbf{u}$ 和 $\\mathbf{v}$ 构建一个右手标准正交基 $\\{\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}}\\}$，并将此基表示为一个 $3\\times 3$ 的方向矩阵 $B = [\\hat{\\mathbf{x}}\\ \\hat{\\mathbf{y}}\\ \\hat{\\mathbf{z}}]$。\n\n### 步骤 1：问题验证\n\n**提取的已知条件：**\n- 输入矢量为 $\\mathbf{u} = \\begin{pmatrix}36 \\\\ -12 \\\\ 48\\end{pmatrix}\\ \\text{mm}$ 和 $\\mathbf{v} = \\begin{pmatrix}18 \\\\ 30 \\\\ -6\\end{pmatrix}\\ \\text{mm}$。\n- 解剖学基 $\\{\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}}\\}$ 必须是标准正交和右手的。\n- 构建规则如下：\n    1. $\\hat{\\mathbf{x}}$ 是沿 $\\mathbf{u}$ 的单位矢量。\n    2. $\\hat{\\mathbf{y}}$ 是将 $\\mathbf{v}$ 相对于 $\\hat{\\mathbf{x}}$ 标准正交化后得到的单位矢量。\n    3. $\\hat{\\mathbf{z}} = \\hat{\\mathbf{x}} \\times \\hat{\\mathbf{y}}$。\n- 最终输出必须是矩阵 $B = [\\hat{\\mathbf{x}}\\ \\hat{\\mathbf{y}}\\ \\hat{\\mathbf{z}}]$，其元素使用根式精确表示。\n\n**使用提取的已知条件进行验证：**\n该问题具有科学依据，在生物力学参考坐标系这一背景下，运用了标准的矢量代数方法（归一化、格拉姆-施密特过程、叉积），这些方法在该领域是常规应用。这个问题是适定的；指令精确，并且由于输入矢量非零且非共线，将会导出一个唯一的标准正交基。这两个矢量不共线，因为不存在单一标量 $k$ 使得 $\\mathbf{v} = k\\mathbf{u}$（例如，$18/36 = 1/2$，但 $30/(-12) \\neq 1/2$）。语言客观，数据完整且一致。因此，该问题是有效的。\n\n### 步骤 2：求解推导\n\n按顺序执行构建基矢量的步骤。\n\n**1. 计算第一个基矢量 $\\hat{\\mathbf{x}}$：**\n矢量 $\\hat{\\mathbf{x}}$ 定义为 $\\mathbf{u}$ 方向上的单位矢量。通过将 $\\mathbf{u}$ 除以其欧几里得范数 $\\|\\mathbf{u}\\|$ 来计算。\n首先，计算 $\\mathbf{u}$ 的范数：\n$$ \\|\\mathbf{u}\\| = \\sqrt{36^2 + (-12)^2 + 48^2} $$\n为了简化计算，我们可以提出 $\\mathbf{u}$ 各分量的最大公约数，即 $12$。\n$$ \\mathbf{u} = 12 \\begin{pmatrix} 3 \\\\ -1 \\\\ 4 \\end{pmatrix} $$\n那么范数为：\n$$ \\|\\mathbf{u}\\| = |12| \\sqrt{3^2 + (-1)^2 + 4^2} = 12 \\sqrt{9 + 1 + 16} = 12\\sqrt{26} $$\n现在，我们求单位矢量 $\\hat{\\mathbf{x}}$：\n$$ \\hat{\\mathbf{x}} = \\frac{\\mathbf{u}}{\\|\\mathbf{u}\\|} = \\frac{12 \\begin{pmatrix} 3 \\\\ -1 \\\\ 4 \\end{pmatrix}}{12\\sqrt{26}} = \\frac{1}{\\sqrt{26}} \\begin{pmatrix} 3 \\\\ -1 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 3/\\sqrt{26} \\\\ -1/\\sqrt{26} \\\\ 4/\\sqrt{26} \\end{pmatrix} $$\n\n**2. 计算第二个基矢量 $\\hat{\\mathbf{y}}$：**\n矢量 $\\hat{\\mathbf{y}}$ 是通过应用格拉姆-施密特过程将 $\\mathbf{v}$ 相对于 $\\hat{\\mathbf{x}}$ 正交化，然后将结果归一化得到的。\n设 $\\mathbf{w}$ 是 $\\mathbf{v}$ 中与 $\\hat{\\mathbf{x}}$ 正交的分量。\n$$ \\mathbf{w} = \\mathbf{v} - (\\mathbf{v} \\cdot \\hat{\\mathbf{x}})\\hat{\\mathbf{x}} $$\n我们必须首先计算点积 $\\mathbf{v} \\cdot \\hat{\\mathbf{x}}$：\n$$ \\mathbf{v} \\cdot \\hat{\\mathbf{x}} = \\begin{pmatrix} 18 \\\\ 30 \\\\ -6 \\end{pmatrix} \\cdot \\frac{1}{\\sqrt{26}} \\begin{pmatrix} 3 \\\\ -1 \\\\ 4 \\end{pmatrix} = \\frac{1}{\\sqrt{26}} (18 \\cdot 3 + 30 \\cdot (-1) + (-6) \\cdot 4) $$\n$$ \\mathbf{v} \\cdot \\hat{\\mathbf{x}} = \\frac{1}{\\sqrt{26}} (54 - 30 - 24) = \\frac{1}{\\sqrt{26}}(0) = 0 $$\n点积为零，这意味着原始矢量 $\\mathbf{u}$ 和 $\\mathbf{v}$ 已经正交。因此，格拉姆-施密特正交化步骤被简化了，因为 $\\mathbf{v}$ 在 $\\hat{\\mathbf{x}}$ 上的投影为零。\n$$ \\mathbf{w} = \\mathbf{v} - (0)\\hat{\\mathbf{x}} = \\mathbf{v} $$\n为求得 $\\hat{\\mathbf{y}}$，我们只需将 $\\mathbf{w} = \\mathbf{v}$ 归一化。\n首先，计算 $\\mathbf{v}$ 的范数：\n$$ \\|\\mathbf{v}\\| = \\sqrt{18^2 + 30^2 + (-6)^2} $$\n我们提出最大公约数 $6$。\n$$ \\mathbf{v} = 6 \\begin{pmatrix} 3 \\\\ 5 \\\\ -1 \\end{pmatrix} $$\n范数为：\n$$ \\|\\mathbf{v}\\| = |6| \\sqrt{3^2 + 5^2 + (-1)^2} = 6 \\sqrt{9 + 25 + 1} = 6\\sqrt{35} $$\n现在，我们求单位矢量 $\\hat{\\mathbf{y}}$：\n$$ \\hat{\\mathbf{y}} = \\frac{\\mathbf{v}}{\\|\\mathbf{v}\\|} = \\frac{6 \\begin{pmatrix} 3 \\\\ 5 \\\\ -1 \\end{pmatrix}}{6\\sqrt{35}} = \\frac{1}{\\sqrt{35}} \\begin{pmatrix} 3 \\\\ 5 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 3/\\sqrt{35} \\\\ 5/\\sqrt{35} \\\\ -1/\\sqrt{35} \\end{pmatrix} $$\n\n**3. 计算第三个基矢量 $\\hat{\\mathbf{z}}$：**\n矢量 $\\hat{\\mathbf{z}}$ 由 $\\hat{\\mathbf{x}}$ 和 $\\hat{\\mathbf{y}}$ 的叉积定义，以形成一个右手系。\n$$ \\hat{\\mathbf{z}} = \\hat{\\mathbf{x}} \\times \\hat{\\mathbf{y}} = \\left( \\frac{1}{\\sqrt{26}} \\begin{pmatrix} 3 \\\\ -1 \\\\ 4 \\end{pmatrix} \\right) \\times \\left( \\frac{1}{\\sqrt{35}} \\begin{pmatrix} 3 \\\\ 5 \\\\ -1 \\end{pmatrix} \\right) $$\n$$ \\hat{\\mathbf{z}} = \\frac{1}{\\sqrt{26}\\sqrt{35}} \\begin{pmatrix} 3 \\\\ -1 \\\\ 4 \\end{pmatrix} \\times \\begin{pmatrix} 3 \\\\ 5 \\\\ -1 \\end{pmatrix} $$\n标量前置因子为 $1/\\sqrt{26 \\cdot 35} = 1/\\sqrt{910}$。\n整数矢量的叉积为：\n$$ \\begin{pmatrix} 3 \\\\ -1 \\\\ 4 \\end{pmatrix} \\times \\begin{pmatrix} 3 \\\\ 5 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} (-1)(-1) - (4)(5) \\\\ (4)(3) - (3)(-1) \\\\ (3)(5) - (-1)(3) \\end{pmatrix} = \\begin{pmatrix} 1 - 20 \\\\ 12 + 3 \\\\ 15 + 3 \\end{pmatrix} = \\begin{pmatrix} -19 \\\\ 15 \\\\ 18 \\end{pmatrix} $$\n因此，第三个基矢量为：\n$$ \\hat{\\mathbf{z}} = \\frac{1}{\\sqrt{910}} \\begin{pmatrix} -19 \\\\ 15 \\\\ 18 \\end{pmatrix} = \\begin{pmatrix} -19/\\sqrt{910} \\\\ 15/\\sqrt{910} \\\\ 18/\\sqrt{910} \\end{pmatrix} $$\n\n**4. 组装方向矩阵 $B$：**\n方向矩阵 $B$ 是通过将基矢量 $\\hat{\\mathbf{x}}$、$\\hat{\\mathbf{y}}$ 和 $\\hat{\\mathbf{z}}$ 作为其列来构成的。\n$$ B = [\\hat{\\mathbf{x}}\\ \\hat{\\mathbf{y}}\\ \\hat{\\mathbf{z}}] = \\begin{pmatrix} 3/\\sqrt{26}  3/\\sqrt{35}  -19/\\sqrt{910} \\\\ -1/\\sqrt{26}  5/\\sqrt{35}  15/\\sqrt{910} \\\\ 4/\\sqrt{26}  -1/\\sqrt{35}  18/\\sqrt{910} \\end{pmatrix} $$\n该矩阵按要求构建，所有元素都用根式精确表示。推导至此结束。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{\\sqrt{26}}  \\frac{3}{\\sqrt{35}}  -\\frac{19}{\\sqrt{910}} \\\\ -\\frac{1}{\\sqrt{26}}  \\frac{5}{\\sqrt{35}}  \\frac{15}{\\sqrt{910}} \\\\ \\frac{4}{\\sqrt{26}}  -\\frac{1}{\\sqrt{35}}  \\frac{18}{\\sqrt{910}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在合作研究中，处理来自不同坐标系约定的实验室数据是常见情况。本练习模拟了这样一个场景，教您如何利用方向余弦矩阵的行列式来检测不一致性（例如左手坐标系），以及如何应用变换来修正数据，从而确保数据的互操作性 ()。",
            "id": "4163226",
            "problem": "一个生物力学联合会试图合并来自 $2$ 个使用不同解剖参考坐标系的实验室的运动学数据。两个实验室都以方向余弦矩阵 (DCM) 的形式报告身体节段的方向，其中 DCM $R$ 通过 $v_{\\mathcal{G}} = R\\,v_{\\mathcal{S}}$ 将在节段解剖坐标系 $\\mathcal{S}$ 中表示的列向量映射到实验室的全局坐标系 $\\mathcal{G}$。实验室 $\\mathcal{A}$ 定义了一个右手全局坐标系 $\\mathcal{G}_{\\mathcal{A}}$，其坐标轴为：$x$ 轴向前，$y$ 轴向受试者左侧（额状轴），$z$ 轴向上。实验室 $\\mathcal{B}$ 与之相同，只是其额状轴定义相反：$\\hat{y}_{\\mathcal{B}} = -\\hat{y}_{\\mathcal{A}}$，同时 $\\hat{x}_{\\mathcal{B}} = \\hat{x}_{\\mathcal{A}}$ 且 $\\hat{z}_{\\mathcal{B}} = \\hat{z}_{\\mathcal{A}}$。两个实验室的节段坐标系 $\\mathcal{S}$ 是相同的。假设使用列向量约定和被动旋转（DCM 将节段坐标映射到全局坐标），并且任何从物理上有效的右手坐标变换中获得的 DCM 都必须是正交的，且其行列式为 $+1$。\n\n在实验室 $\\mathcal{B}$ 中记录了一次静态验证试验，其中一个节段绕向上轴进行纯轴向旋转，旋转角度为关于 $\\mathcal{G}_{\\mathcal{A}}$ 的 $z$ 轴的一个未知的带符号角度 $\\phi$。对于某个感兴趣的特定帧，实验室 $\\mathcal{B}$ 报告的 DCM 为\n$$\nR_{\\mathcal{B}} = \\begin{pmatrix}\n\\frac{\\sqrt{3}}{2}  -\\frac{1}{2}  0 \\\\\n-\\frac{1}{2}  -\\frac{\\sqrt{3}}{2}  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n\n仅使用笛卡尔坐标系中旋转和反射的基本定义与性质：\n- 仅基于 $R_{\\mathcal{B}}$ 论证一个用于检测符号约定不一致性的标准，并将其应用于给定的 $R_{\\mathcal{B}}$。\n- 推导将向量从 $\\mathcal{G}_{\\mathcal{A}}$ 映射到 $\\mathcal{G}_{\\mathcal{B}}$ 的轴翻转矩阵 $F_{y}$，并用它构建在相同物理方向下实验室 $\\mathcal{A}$ 本应报告的修正后 DCM $R_{\\mathcal{A}}$。\n- 从 $R_{\\mathcal{A}}$ 出发，根据 $z$-$y$-$x$ 内旋序列，从第一性原理确定绕向上轴的带符号偏航角 $\\phi$。\n\n将最终角度 $\\phi$ 以弧度表示为精确值，不要四舍五入。",
            "solution": "首先对问题进行验证。\n\n### 步骤1：提取已知条件\n- 来自两个实验室 $\\mathcal{A}$ 和 $\\mathcal{B}$ 的运动学数据。\n- 数据为方向余弦矩阵 (DCM)，记为 $R$。\n- DCM 将向量从节段坐标系 $\\mathcal{S}$ 映射到全局坐标系 $\\mathcal{G}$：$v_{\\mathcal{G}} = R\\,v_{\\mathcal{S}}$。\n- 全局坐标系 $\\mathcal{G}_{\\mathcal{A}}$：右手系，坐标轴为 $\\hat{x}_{\\mathcal{A}}$ (向前)、$\\hat{y}_{\\mathcal{A}}$ (受试者左侧) 和 $\\hat{z}_{\\mathcal{A}}$ (向上)。\n- 全局坐标系 $\\mathcal{G}_{\\mathcal{B}}$：$\\hat{x}_{\\mathcal{B}} = \\hat{x}_{\\mathcal{A}}$、$\\hat{y}_{\\mathcal{B}} = -\\hat{y}_{\\mathcal{A}}$ 和 $\\hat{z}_{\\mathcal{B}} = \\hat{z}_{\\mathcal{A}}$。\n- 节段坐标系 $\\mathcal{S}$ 对两个实验室都相同。\n- 约定：列向量，坐标变换。\n- 物理上有效的右手坐标变换的 DCM 属性：正交且行列式为 $+1$。\n- 实验室 $\\mathcal{B}$ 中的一次静态试验涉及绕向上轴（$\\mathcal{G}_{\\mathcal{A}}$ 的 $z$ 轴）以角度 $\\phi$ 进行的纯轴向旋转。\n- 实验室 $\\mathcal{B}$ 报告的 DCM 为：\n$$\nR_{\\mathcal{B}} = \\begin{pmatrix}\n\\frac{\\sqrt{3}}{2}  -\\frac{1}{2}  0 \\\\\n-\\frac{1}{2}  -\\frac{\\sqrt{3}}{2}  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n- 任务：\n  1. 使用 $R_{\\mathcal{B}}$ 论证并应用一个用于检测符号约定不一致性的标准。\n  2. 推导将向量从 $\\mathcal{G}_{\\mathcal{A}}$ 映射到 $\\mathcal{G}_{\\mathcal{B}}$ 的轴翻转矩阵 $F_{y}$。\n  3. 构建修正后的 DCM $R_{\\mathcal{A}}$。\n  4. 确定带符号的偏航角 $\\phi$（以弧度为单位）。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，其操作建立在运动学和线性代数的既定原理之上。它描述了生物力学中的一个现实场景，即必须协调不同实验室的坐标系标准。给定信息是自洽的，足以求解。坐标系定义是精确的：$\\mathcal{G}_{\\mathcal{A}}$ 是一个右手系。坐标系 $\\mathcal{G}_{\\mathcal{B}}$ 是通过翻转 $\\mathcal{G}_{\\mathcal{A}}$ 的一个轴（$\\hat{y}_{\\mathcal{B}} = -\\hat{y}_{\\mathcal{A}}$）构建的，这使得 $\\mathcal{G}_{\\mathcal{B}}$ 成为一个左手系，因为 $\\hat{x}_{\\mathcal{B}} \\times \\hat{y}_{\\mathcal{B}} = \\hat{x}_{\\mathcal{A}} \\times (-\\hat{y}_{\\mathcal{A}}) = -(\\hat{x}_{\\mathcal{A}} \\times \\hat{y}_{\\mathcal{A}}) = -\\hat{z}_{\\mathcal{A}} = -\\hat{z}_{\\mathcal{B}}$。该问题是适定的、客观的，并且没有违反任何验证标准。\n\n### 步骤3：结论与行动\n问题是**有效的**。将提供完整解答。\n\n### 解答\n解答过程将按问题陈述中指定的三个任务进行。\n\n**第1部分：不一致性检测标准及其应用**\n\n方向余弦矩阵 (DCM) 代表一个坐标变换。问题陈述中提到节段坐标系 $\\mathcal{S}$ 是标准的，这意味着它们是右手系。全局坐标系 $\\mathcal{G}_{\\mathcal{A}}$ 被明确定义为右手系。两个右手坐标系之间的变换是纯旋转，由一个正常正交矩阵表示，其行列式为 $+1$。\n\n全局坐标系 $\\mathcal{G}_{\\mathcal{B}}$ 的基向量与 $\\mathcal{G}_{\\mathcal{A}}$ 的关系为 $\\hat{x}_{\\mathcal{B}} = \\hat{x}_{\\mathcal{A}}$、$\\hat{y}_{\\mathcal{B}} = -\\hat{y}_{\\mathcal{A}}$、$\\hat{z}_{\\mathcal{B}} = \\hat{z}_{\\mathcal{A}}$。这构成了一个关于 $y$ 轴的反射，将坐标系的手性从右手系变为左手系。从一个右手系（$\\mathcal{S}$）到一个左手系（$\\mathcal{G}_{\\mathcal{B}}$）的变换是一个旋转反射（即旋转后跟一个反射）。这种变换由一个非正常正交矩阵表示，其行列式为 $-1$。\n\n因此，检测符号约定不一致性的标准是计算所报告的 DCM $R_{\\mathcal{B}}$ 的行列式。如果 $\\det(R_{\\mathcal{B}}) = -1$，则证实目标坐标系 $\\mathcal{G}_{\\mathcal{B}}$ 的手性与源坐标系 $\\mathcal{S}$ 的手性不同，这正是所描述的不一致性。\n\n将此标准应用于给定的 $R_{\\mathcal{B}}$：\n$$\n\\det(R_{\\mathcal{B}}) = \\det \\begin{pmatrix}\n\\frac{\\sqrt{3}}{2}  -\\frac{1}{2}  0 \\\\\n-\\frac{1}{2}  -\\frac{\\sqrt{3}}{2}  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n沿第三行进行代数余子式展开：\n$$\n\\det(R_{\\mathcal{B}}) = 1 \\cdot \\det \\begin{pmatrix} \\frac{\\sqrt{3}}{2}  -\\frac{1}{2} \\\\ -\\frac{1}{2}  -\\frac{\\sqrt{3}}{2} \\end{pmatrix} - 0 + 0 = \\left(\\frac{\\sqrt{3}}{2}\\right)\\left(-\\frac{\\sqrt{3}}{2}\\right) - \\left(-\\frac{1}{2}\\right)\\left(-\\frac{1}{2}\\right) = -\\frac{3}{4} - \\frac{1}{4} = -1.\n$$\n结果 $\\det(R_{\\mathcal{B}}) = -1$ 证实了如预测的那样，存在符号约定不一致性。\n\n**第2部分：轴翻转矩阵 $F_{y}$ 和 $R_{\\mathcal{A}}$ 的推导**\n\n矩阵 $F_{y}$ 将向量的坐标从坐标系 $\\mathcal{G}_{\\mathcal{A}}$ 变换到坐标系 $\\mathcal{G}_{\\mathcal{B}}$。设一个物理向量 $\\vec{v}$ 在坐标系 $\\mathcal{G}_{\\mathcal{A}}$ 中的坐标表示为 $v_{\\mathcal{A}} = (v_x, v_y, v_z)^T$，在坐标系 $\\mathcal{G}_{\\mathcal{B}}$ 中的坐标表示为 $v_{\\mathcal{B}}$，使得 $v_{\\mathcal{B}} = F_y v_{\\mathcal{A}}$。\n该向量由 $\\vec{v} = v_x \\hat{x}_{\\mathcal{A}} + v_y \\hat{y}_{\\mathcal{A}} + v_z \\hat{z}_{\\mathcal{A}}$ 给出。\n为了找到它在 $\\mathcal{G}_{\\mathcal{B}}$ 中的分量，我们代入基向量关系：$\\hat{x}_{\\mathcal{A}}=\\hat{x}_{\\mathcal{B}}$，$\\hat{y}_{\\mathcal{A}}=-\\hat{y}_{\\mathcal{B}}$，$\\hat{z}_{\\mathcal{A}}=\\hat{z}_{\\mathcal{B}}$。\n$$\n\\vec{v} = v_x \\hat{x}_{\\mathcal{B}} + v_y (-\\hat{y}_{\\mathcal{B}}) + v_z \\hat{z}_{\\mathcal{B}} = v_x \\hat{x}_{\\mathcal{B}} - v_y \\hat{y}_{\\mathcal{B}} + v_z \\hat{z}_{\\mathcal{B}}.\n$$\n因此，在坐标系 $\\mathcal{G}_{\\mathcal{B}}$ 中的坐标为 $(v_x, -v_y, v_z)^T$。执行此映射的矩阵 $F_y$ 是：\n$$\nF_y = \\begin{pmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  1 \\end{pmatrix}.\n$$\n这是一个关于 $xz$ 平面的反射矩阵。\n\n现在，我们构建修正后的 DCM $R_{\\mathcal{A}}$。我们有以下关系：\n1. $v_{\\mathcal{G}_{\\mathcal{B}}} = R_{\\mathcal{B}} v_{\\mathcal{S}}$ (来自实验室 $\\mathcal{B}$ 的测量)\n2. $v_{\\mathcal{G}_{\\mathcal{A}}} = R_{\\mathcal{A}} v_{\\mathcal{S}}$ (实验室 $\\mathcal{A}$ 所需的 DCM)\n3. $v_{\\mathcal{G}_{\\mathcal{B}}} = F_y v_{\\mathcal{G}_{\\mathcal{A}}}$ (坐标系转换)\n\n将(2)代入(3)：$v_{\\mathcal{G}_{\\mathcal{B}}} = F_y (R_{\\mathcal{A}} v_{\\mathcal{S}})$。\n将此与(1)相等，得到 $R_{\\mathcal{B}} v_{\\mathcal{S}} = (F_y R_{\\mathcal{A}}) v_{\\mathcal{S}}$。因为这对任何 $v_{\\mathcal{S}}$ 都成立，所以矩阵关系为 $R_{\\mathcal{B}} = F_y R_{\\mathcal{A}}$。\n为了找到 $R_{\\mathcal{A}}$，我们用 $F_y$ 的逆矩阵左乘。矩阵 $F_y$ 是自身的逆矩阵，因为 $F_y F_y = I$。因此，$F_y^{-1} = F_y$。\n$$\nR_{\\mathcal{A}} = F_y^{-1} R_{\\mathcal{B}} = F_y R_{\\mathcal{B}}\n$$\n$$\nR_{\\mathcal{A}} = \\begin{pmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix}\n\\frac{\\sqrt{3}}{2}  -\\frac{1}{2}  0 \\\\\n-\\frac{1}{2}  -\\frac{\\sqrt{3}}{2}  0 \\\\\n0  0  1\n\\end{pmatrix} = \\begin{pmatrix}\n\\frac{\\sqrt{3}}{2}  -\\frac{1}{2}  0 \\\\\n\\frac{1}{2}  \\frac{\\sqrt{3}}{2}  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n作为检验，$\\det(R_{\\mathcal{A}}) = (\\frac{\\sqrt{3}}{2})(\\frac{\\sqrt{3}}{2}) - (-\\frac{1}{2})(\\frac{1}{2}) = \\frac{3}{4} + \\frac{1}{4} = 1$。修正后的 DCM 是一个正常旋转矩阵。\n\n**第3部分：确定带符号的偏航角 $\\phi$**\n\n问题陈述，节段“绕向上轴进行纯轴向旋转，旋转角度为关于 $\\mathcal{G}_{\\mathcal{A}}$ 的 $z$ 轴的一个未知的带符号角度 $\\phi$”。这对应于一个偏航旋转。描述节段姿态的旋转矩阵（将节段坐标映射到全局坐标）即为绕 $z$ 轴的主动旋转矩阵：\n$$\nR_z(\\phi) = \\begin{pmatrix}\n\\cos(\\phi)  -\\sin(\\phi)  0 \\\\\n\\sin(\\phi)  \\cos(\\phi)  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n问题中提到的“$z$-$y$-$x$ 内旋序列”表明偏航是此序列中的第一个旋转。对于“纯轴向旋转”，随后的俯仰角和滚转角均为零，因此总旋转就是 $R_z(\\phi)$。\n通过将我们推导出的 $R_{\\mathcal{A}}$ 与 $R_z(\\phi)$ 的一般形式相等：\n$$\nR_{\\mathcal{A}} = \\begin{pmatrix}\n\\frac{\\sqrt{3}}{2}  -\\frac{1}{2}  0 \\\\\n\\frac{1}{2}  \\frac{\\sqrt{3}}{2}  0 \\\\\n0  0  1\n\\end{pmatrix} = \\begin{pmatrix}\n\\cos(\\phi)  -\\sin(\\phi)  0 \\\\\n\\sin(\\phi)  \\cos(\\phi)  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n比较对应元素，得到一个包含两个方程的方程组：\n1. $\\cos(\\phi) = \\frac{\\sqrt{3}}{2}$\n2. $\\sin(\\phi) = \\frac{1}{2}$\n\n两个方程同时被第一象限中的角度 $\\phi$ 满足。满足这些条件的唯一主值 $\\phi$ 是：\n$$\n\\phi = \\frac{\\pi}{6} \\text{ 弧度}.\n$$\n这就是带符号的偏航角。",
            "answer": "$$\\boxed{\\frac{\\pi}{6}}$$"
        },
        {
            "introduction": "实验数据很少是完美的；标记点交换或系统配置错误等问题可能会影响结果的可靠性。本练习要求您设计一个质量控制程序，该程序利用刚体运动的几何不变量——特别是标记点间距离的守恒性和坐标系的右手性——来稳健地识别并标记出受损的数据 ()。",
            "id": "4163241",
            "problem": "一个刚体节段上装有一个由4个非共线的皮肤标记点组成的非退化簇。设节段固定坐标系中已标记的标记点的模板构型为 $\\{\\mathbf{p}_i\\}_{i=1}^{4} \\subset \\mathbb{R}^3$，其质心为 $\\bar{\\mathbf{p}} = \\frac{1}{4}\\sum_{i=1}^{4}\\mathbf{p}_i$；并设在时间 $t$ 测量到的实验室坐标系位置为 $\\{\\mathbf{x}_i(t)\\}_{i=1}^{4} \\subset \\mathbb{R}^3$，其质心为 $\\bar{\\mathbf{x}}(t) = \\frac{1}{4}\\sum_{i=1}^{4}\\mathbf{x}_i(t)$。假设一个带有微小测量噪声的刚体模型，即存在一个旋转矩阵 $\\mathbf{R}(t)\\in \\mathbb{R}^{3\\times 3}$ 和一个平移向量 $\\mathbf{t}(t)\\in \\mathbb{R}^3$，使得\n$$\n\\mathbf{x}_i(t) \\approx \\mathbf{R}(t)\\,\\mathbf{p}_i + \\mathbf{t}(t), \\quad i=1,\\dots,4,\n$$\n在理想条件下，有 $\\mathbf{R}(t)^\\top \\mathbf{R}(t) = \\mathbf{I}$ 和 $\\det(\\mathbf{R}(t)) = +1$。在实践中，可能会发生标记点错标（标记点交换）或镜像错误，例如由于实验室坐标系中的左右翻转或使用了对应关系的奇置换。您需要设计一个检测程序，在每个时间点 $t$ 标记此类错误，同时能容忍微小的噪声。\n\n从基本原理出发，仅使用以下内容作为基础：(i) 刚体变换保持两点间的距离不变，即对于精确的刚体运动，所有 $i,j$ 都满足 $\\|\\mathbf{x}_i - \\mathbf{x}_j\\| = \\|\\mathbf{p}_i - \\mathbf{p}_j\\|$；(ii) 正交矩阵的行列式为 $\\pm 1$，其中 $\\det = +1$ 表示真旋转，$\\det = -1$ 表示反射；(iii) 叉积通过 $\\mathbf{a}\\times \\mathbf{b}$ 与右手定则对齐来编码右手性，而标量三重积 $\\det[\\mathbf{a}\\ \\mathbf{b}\\ \\mathbf{c}]$ 表示定向。\n\n在存在微小但非零噪声的情况下，下列哪个程序是充分且必要的，能够通过检查重建的节段坐标系是否保持右手性以及已标记的标记点之间的距离是否保持不变，来鲁棒地检测标记点交换或镜像错误？\n\nA. 通过减去质心来中心化两个点集，通过正交 Procrustes 步骤（例如，使用奇异值分解 (SVD)）估计已标记对应关系之间的最佳拟合正交变换，提取 $\\mathbf{R}(t)$，并计算 $\\det(\\mathbf{R}(t))$。如果 $\\det(\\mathbf{R}(t))  0$，则标记错误。独立地，计算已标记标记点之间的所有两两距离 $d_{ij}(t) = \\|\\mathbf{x}_i(t) - \\mathbf{x}_j(t)\\|$，并将其与模板距离 $d_{ij}^p = \\|\\mathbf{p}_i - \\mathbf{p}_j\\|$ 进行比较。如果任何一对 $(i,j)$ 的 $|d_{ij}(t) - d_{ij}^p|$ 超过噪声阈值，则标记错误。\n\nB. 仅计算已标记标记点之间的所有两两距离 $d_{ij}(t) = \\|\\mathbf{x}_i(t) - \\mathbf{x}_j(t)\\|$，并将其与模板距离 $d_{ij}^p = \\|\\mathbf{p}_i - \\mathbf{p}_j\\|$ 进行比较。如果任何一对 $(i,j)$ 的 $|d_{ij}(t) - d_{ij}^p|$ 超过噪声阈值，则标记错误。\n\nC. 仅通过正交 Procrustes 步骤估计最佳拟合正交变换 $\\mathbf{R}(t)$，并计算其行列式。如果 $\\det(\\mathbf{R}(t))  0$，则标记错误。\n\nD. 从测量点中定义一个三元组向量（例如，$\\mathbf{x}_2(t)-\\mathbf{x}_1(t)$, $\\mathbf{x}_3(t)-\\mathbf{x}_1(t)$, $\\mathbf{x}_4(t)-\\mathbf{x}_1(t)$），并计算其标量三重积的符号。将此符号与从模板点定义的相应三元组的标量三重积符号进行比较。如果符号不匹配，则标记错误。",
            "solution": "该问题要求设计一个既“充分又必要”的程序来检测标记点交换和镜像错误。这需要检查两个不同的属性：保持带标签的标记点间距离和保持坐标系的右手性。\n\n1.  **检测镜像错误（手性检查）**：镜像错误，或任何反转方向的变换，其特征是变换矩阵 $\\mathbf{R}$ 的行列式为-1。一个估计最佳旋转矩阵 $\\mathbf{R}(t)$ （例如，通过普罗克汝斯忒斯方法）然后检查 $\\det(\\mathbf{R}(t))$ 符号的程序，是直接且稳健地检查手性的方法。这项检查是必要的，因为一个变换可以保持所有距离不变但仍然是一个反射（非正常旋转），这种情况仅靠距离检查是无法发现的。\n\n2.  **检测标记点交换（带标签的距离检查）**：刚体变换（无论正常与否）都保持所有点对之间的距离。然而，标记点*交换*违反了*带标签*点之间的对应关系。例如，如果标记点 `k` 和 `l` 被交换，那么测量的距离 $\\|\\mathbf{x}_k(t) - \\mathbf{x}_j(t)\\|$ 将近似于模板距离 $\\|\\mathbf{p}_l - \\mathbf{p}_j\\|$，而不是 $\\|\\mathbf{p}_k - \\mathbf{p}_j\\|$。因此，将所有带标签的点对距离 $\\|\\mathbf{x}_i(t) - \\mathbf{x}_j(t)\\|$ 与其对应的模板距离 $\\|\\mathbf{p}_i - \\mathbf{p}_j\\|$进行比较，是检测交换的必要检查。这项检查之所以必要，还因为两个标记点的简单交换（一个偶置换）可以由一个正常旋转来表示，这意味着 $\\det(\\mathbf{R}(t))$ 将为+1，手性检查将无法发现此错误。\n\n一个充分且必要的程序必须同时执行这两项检查。\n\n**选项分析：**\n\n*   **A**: 此程序包含两项检查：(1) 检查 $\\det(\\mathbf{R}(t))$ 以判断手性，以及 (2) 检查所有带标签的点对距离。因此，它能够同时检测镜像错误和标记点交换。它是充分且必要的。\n*   **B**: 此程序仅检查距离。它将无法检测到对整个标记点集的纯反射，因为所有距离都保持不变。因此，它是不充分的。\n*   **C**: 此程序仅检查 $\\det(\\mathbf{R}(t))$。它将无法检测到两个标记点的交换，因为最佳拟合变换仍然是一个正常旋转，其 $\\det(\\mathbf{R}(t)) \\approx +1$。因此，它是不充分的。\n*   **D**: 此程序检查标量三重积的符号，这是另一种测试手性的方法。与选项C类似，它对反射和奇置换敏感，但无法检测到偶置换（如两个标记点的交换）。它不检查带标签的距离是否正确。因此，它是不充分的。\n\n综上所述，只有选项A提供了一个用于检测两种类型错误的完整且稳健的检查。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}