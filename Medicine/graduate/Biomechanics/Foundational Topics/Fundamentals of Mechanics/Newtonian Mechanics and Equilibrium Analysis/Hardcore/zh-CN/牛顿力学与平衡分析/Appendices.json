{
    "hands_on_practices": [
        {
            "introduction": "在生物力学中，将牛顿定律应用于人体关节是分析肌肉和关节力学的基础。这个练习将一个经典的肘关节模型作为起点，要求你计算在静态持重条件下维持平衡所需的肱二头肌肌力。通过策略性地选择力矩计算的参考点，你可以简化这个看似复杂的系统，从而直接求解未知的肌肉力，这是生物力学分析中的一项核心技能。",
            "id": "4194606",
            "problem": "一个刚性的前臂-手部段在矢状面内被建模为以肘部为铰链的单连杆。前臂保持静止且完全水平。一个人手中握着哑铃，产生一个已知的外部负载。唯一考虑的肌肉是肱二头肌，其被建模为施加在前臂附着点上的拉力。肘关节在其关节中心传递一个未知的合反作用力。忽略所有其他肌肉和韧带力，并忽略关节处的摩擦力。\n\n已知的几何和惯性数据：\n- 从肘关节中心到哑铃作用线的距离：$0.35\\,\\text{m}$。\n- 从肘关节中心到前臂-手部段质心（center of mass (COM)）的距离：$0.15\\,\\text{m}$。\n- 从肘关节中心到肱二头肌附着点的距离：$0.040\\,\\text{m}$。\n- 肱二头肌的作用线与前臂轴线成一个恒定的 $15^{\\circ}$ 角（在矢状面内测量）。\n- 哑铃的质量：$6.0\\,\\text{kg}$。\n- 前臂-手部段的质量：$1.8\\,\\text{kg}$。\n- 重力加速度：$9.81\\,\\text{m}\\,\\text{s}^{-2}$。\n\n假设：\n- 前臂-手部段是在矢状面内处于静态平衡的刚体。\n- 肘关节反作用力作用于关节中心，且不产生绕该点的力矩。\n- 肱二头肌力沿着其作用线作用；其大小未知。\n- 哑铃和该段的重量垂直向下作用。\n\n任务：\n- 从平面内刚体静态平衡的牛顿定律出发，选择一个点来写下标量力矩平衡方程以消除一个未知数，并说明理由。然后使用整套平衡方程求解未知的肱二头肌力的大小和肘关节反作用力（分量或大小）。\n\n仅报告维持指定的前臂-手部系统静态平衡所需的肱二头肌力的大小。用牛顿（N）表示最终答案，并四舍五入到四位有效数字。角度以度为单位测量。",
            "solution": "问题要求在特定负载条件下，求出保持前臂-手部段处于静态平衡所需的肱二头肌力的大小。该分析基于牛顿力学中关于二维平面内刚体的原理。如果作用在物体上的所有外力的矢量和为零，并且这些力绕任意点的力矩之和为零，则该物体处于静态平衡状态。\n\n平衡条件在数学上表示为：\n$$ \\sum \\vec{F} = \\vec{0} $$\n$$ \\sum \\vec{M} = \\vec{0} $$\n\n对于 $xy$ 平面内的平面问题，这些矢量方程可以分解为三个标量方程：\n$$ \\sum F_x = 0 $$\n$$ \\sum F_y = 0 $$\n$$ \\sum M_z = 0 $$\n\n让我们建立一个坐标系，原点位于肘关节中心。$x$ 轴与水平的前臂对齐，指向远离肘部的方向，$y$ 轴垂直向上。\n\n作用在前臂-手部段上的力有：\n1. 前臂-手部段的重量 $\\vec{W}_F$，作用在距离肘部 $d_F = 0.15\\,\\text{m}$ 处，垂直向下。其大小为 $W_F = m_F g$，其中 $m_F = 1.8\\,\\text{kg}$，$g = 9.81\\,\\text{m}\\,\\text{s}^{-2}$。\n2. 哑铃的重量 $\\vec{W}_D$，作用在距离肘部 $d_D = 0.35\\,\\text{m}$ 处，垂直向下。其大小为 $W_D = m_D g$，其中 $m_D = 6.0\\,\\text{kg}$。\n3. 肱二头肌的拉力 $\\vec{F}_B$，作用在附着点，距离肘部 $d_B = 0.040\\,\\text{m}$。此力的大小为 $F_B$，其作用线与前臂成 $\\theta = 15^{\\circ}$ 角。该力产生一个垂直（提升）分量和一个水平（压缩）分量。\n4. 肘关节反作用力 $\\vec{R}$，作用于关节中心（原点）。该力有两个未知分量，一个水平分量 $R_x$ 和一个垂直分量 $R_y$。\n\n问题要求说明选择一个点来写力矩平衡方程以消除一个未知数的理由。计算力矩最策略性的选择点是肘关节中心。理由是关节反作用力 $\\vec{R}$ 通过该点。根据定义，一个力绕其作用线上某一点的力矩为零，因为力臂为零。因此，选择肘关节作为支点，可以从力矩方程中消除反作用力的两个未知分量 $R_x$ 和 $R_y$。这样就留下了一个只有一个未知数（肱二头肌力的大小 $F_B$）的方程，可以直接求解。\n\n绕肘关节的标量力矩平衡方程是 $\\sum M_{\\text{elbow}} = 0$。按照惯例，逆时针力矩为正，顺时针力矩为负。\n\n肱二头肌力的垂直分量 $F_B \\sin\\theta$ 产生一个绕肘部的逆时针（正）力矩。力臂是从肘部到肱二头肌附着点的距离 $d_B$。\n肱二头肌产生的力矩：$M_B = (F_B \\sin\\theta) \\cdot d_B$。\n\n前臂-手部段和哑铃的重量向下作用，产生顺时针（负）力矩。\n前臂重量产生的力矩：$M_F = -W_F \\cdot d_F = -m_F g d_F$。\n哑铃重量产生的力矩：$M_D = -W_D \\cdot d_D = -m_D g d_D$。\n\n力矩平衡方程为：\n$$ \\sum M_{\\text{elbow}} = M_B + M_F + M_D = 0 $$\n$$ (F_B \\sin\\theta) d_B - m_F g d_F - m_D g d_D = 0 $$\n\n现在我们可以求解未知的肱二头肌力的大小 $F_B$：\n$$ (F_B \\sin\\theta) d_B = m_F g d_F + m_D g d_D $$\n$$ F_B = \\frac{g (m_F d_F + m_D d_D)}{d_B \\sin\\theta} $$\n\n现在，将给定的数值代入此表达式：\n- $g = 9.81\\,\\text{m}\\,\\text{s}^{-2}$\n- $m_F = 1.8\\,\\text{kg}$\n- $d_F = 0.15\\,\\text{m}$\n- $m_D = 6.0\\,\\text{kg}$\n- $d_D = 0.35\\,\\text{m}$\n- $d_B = 0.040\\,\\text{m}$\n- $\\theta = 15^{\\circ}$\n\n首先，计算分子项 $g (m_F d_F + m_D d_D)$：\n$$ m_F d_F = (1.8\\,\\text{kg})(0.15\\,\\text{m}) = 0.27\\,\\text{kg}\\cdot\\text{m} $$\n$$ m_D d_D = (6.0\\,\\text{kg})(0.35\\,\\text{m}) = 2.1\\,\\text{kg}\\cdot\\text{m} $$\n$$ \\text{Numerator} = (9.81\\,\\text{m}\\,\\text{s}^{-2}) (0.27\\,\\text{kg}\\cdot\\text{m} + 2.1\\,\\text{kg}\\cdot\\text{m}) = (9.81\\,\\text{m}\\,\\text{s}^{-2}) (2.37\\,\\text{kg}\\cdot\\text{m}) = 23.2497\\,\\text{N}\\cdot\\text{m} $$\n\n接下来，计算分母项 $d_B \\sin\\theta$：\n$$ \\text{Denominator} = (0.040\\,\\text{m}) \\sin(15^{\\circ}) \\approx (0.040\\,\\text{m})(0.258819) \\approx 0.01035276\\,\\text{m} $$\n\n最后，计算 $F_B$：\n$$ F_B = \\frac{23.2497\\,\\text{N}\\cdot\\text{m}}{0.01035276\\,\\text{m}} \\approx 2245.7405\\,\\text{N} $$\n\n问题要求答案四舍五入到四位有效数字。\n$$ F_B \\approx 2246\\,\\text{N} $$\n\n尽管最终答案不需要，但在已知 $F_B$ 的情况下，可以使用力平衡方程 $\\sum F_x = 0$ 和 $\\sum F_y = 0$ 来接着确定肘关节反作用力的分量。",
            "answer": "$$\\boxed{2246}$$"
        },
        {
            "introduction": "静态平衡分析是一个强大的工具，但它的应用有其边界。当系统并非完全静止时，我们必须评估忽略惯性效应是否合理。这个练习通过分析一个缓慢运动的肘关节，要求你量化惯性力矩相对于静态重力力矩的大小。这项实践将教会你如何运用转动动力学第二定律和平行轴定理，来批判性地评估准静态假设的有效性，这是严谨的生物力学建模中不可或缺的一步。",
            "id": "4194548",
            "problem": "一名健康的成年人坐着，在矢状面内进行受控的、缓慢的肘部屈曲。上臂保持静止和竖直，前臂-手部分绕肘关节旋转。在所研究的瞬间，前臂大致保持水平，从而使重力力臂达到最大。前臂和手被建模为两个刚性部分，具有以下人体测量学特性和几何形状：\n- 前臂质量 $m_{f} = 1.2\\,\\mathrm{kg}$，前臂长度 $L_{f} = 0.27\\,\\mathrm{m}$，前臂质心位于肘部远端 $0.43\\,L_{f}$ 处，前臂绕其自身质心的回转半径为 $k_{f} = 0.25\\,L_{f}$。\n- 手部质量 $m_{h} = 0.4\\,\\mathrm{kg}$，手部长度 $L_{h} = 0.18\\,\\mathrm{m}$，手部质心位于腕部远端 $0.44\\,L_{h}$ 处，手部绕其自身质心的回转半径为 $k_{h} = 0.30\\,L_{h}$。\n- 一个质量为 $m_{d} = 0.5\\,\\mathrm{kg}$ 的仪器盒绑在手背上，其质心约在腕关节远端 $0.08\\,\\mathrm{m}$ 处。\n\n假设在所研究的瞬间，前臂-手部分绕肘关节旋转，测得的角加速度大小为 $|\\alpha| = 0.05\\,\\mathrm{rad}\\,\\mathrm{s}^{-2}$。取重力加速度为 $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$。将每个部分视为刚体，并使用平行轴定理求得绕肘关节的总转动惯量。忽略关节摩擦和任何软组织变形力矩。\n\n从牛顿第二转动定律以及质心和转动惯量的标准定义出发，推导当前臂水平时，绕肘关节的惯性力矩大小 $|I \\alpha|$ 和静态重力力矩大小 $T_{\\text{static}}$。然后计算无量纲比值\n$$\\rho = \\frac{|I \\alpha|}{T_{\\text{static}}}.$$\n使用从肘部到各质心的距离如下：前臂质心距离 $r_{f} = 0.43\\,L_{f}$；手部质心距肘部的距离 $r_{h} = L_{f} + 0.44\\,L_{h}$；仪器盒距肘部的距离 $r_{d} = L_{f} + 0.08\\,\\mathrm{m}$。将 $\\rho$ 的最终答案表示为一个纯数，四舍五入到四位有效数字。在你的推导中，明确说明准静态平衡分析（忽略惯性力矩）在此时是否足够，并从第一性原理证明你的结论。",
            "solution": "适当的基本依据是牛顿第二转动定律，该定律指出，绕固定轴的力矩之和等于绕该轴的总转动惯量与角加速度的乘积。关于肘关节，有\n$$\\sum M_{\\text{elbow}} = I_{\\text{elbow}}\\,\\alpha.$$\n对于目前的分解，我们将惯性力矩 $I_{\\text{elbow}}\\,\\alpha$ 与由前臂、手和仪器盒的重量产生的静态重力力矩区分开来。在前臂水平的瞬间，重力力矩的大小是每个质量、重力加速度及其绕肘关节的垂直杠杆臂的乘积。静态重力力矩的大小为\n$$T_{\\text{static}} = m_{f}\\,g\\,r_{f} + m_{h}\\,g\\,r_{h} + m_{d}\\,g\\,r_{d},$$\n其中 $r_{f}$，$r_{h}$ 和 $r_{d}$ 分别是肘关节到前臂、手和仪器盒质心的距离。\n\n为了计算惯性力矩大小 $|I\\alpha|$，我们需要所有物体绕肘关节的总转动惯量 $I_{\\text{elbow}}$。根据平行轴定理，每个刚体绕肘关节的转动惯量等于其绕自身质心的转动惯量，加上其质量乘以肘关节到其质心距离的平方。因此，\n$$I_{\\text{elbow}} = \\underbrace{\\left(I_{f,\\text{com}} + m_{f}\\,r_{f}^{2}\\right)}_{\\text{前臂}} + \\underbrace{\\left(I_{h,\\text{com}} + m_{h}\\,r_{h}^{2}\\right)}_{\\text{手}} + \\underbrace{\\left(m_{d}\\,r_{d}^{2}\\right)}_{\\text{仪器盒 (质点)}},$$\n其中，对于前臂和手，分别有 $I_{f,\\text{com}} = m_{f}\\,k_{f}^{2}$ 和 $I_{h,\\text{com}} = m_{h}\\,k_{h}^{2}$，这里使用了它们绕各自质心的回转半径。\n\n我们首先用符号表示所有距离：\n- 前臂质心距离：$r_{f} = 0.43\\,L_{f}$。\n- 手部质心距肘部的距离：$r_{h} = L_{f} + 0.44\\,L_{h}$。\n- 仪器盒距肘部的距离：$r_{d} = L_{f} + 0.08\\,\\mathrm{m}$。\n\n总转动惯量变为\n\n$$\n\\begin{aligned}\nI_{\\text{elbow}} = m_{f}\\,k_{f}^{2} + m_{f}\\,r_{f}^{2} + m_{h}\\,k_{h}^{2} + m_{h}\\,r_{h}^{2} + m_{d}\\,r_{d}^{2}.\n\\end{aligned}\n$$\n\n惯性力矩的大小为\n$$|I\\alpha| = I_{\\text{elbow}}\\,|\\alpha|.$$\n所求的比值为\n$$\\rho = \\frac{|I\\alpha|}{T_{\\text{static}}} = \\frac{I_{\\text{elbow}}\\,|\\alpha|}{m_{f}\\,g\\,r_{f} + m_{h}\\,g\\,r_{h} + m_{d}\\,g\\,r_{d}}.$$\n\n我们现在代入给定的数值。给定的参数是\n\n$$\n\\begin{aligned}\nm_{f} = 1.2\\,\\mathrm{kg},\\quad L_{f} = 0.27\\,\\mathrm{m},\\quad k_{f} = 0.25\\,L_{f},\\quad r_{f} = 0.43\\,L_{f},\\\\\nm_{h} = 0.4\\,\\mathrm{kg},\\quad L_{h} = 0.18\\,\\mathrm{m},\\quad k_{h} = 0.30\\,L_{h},\\quad r_{h} = L_{f} + 0.44\\,L_{h},\\\\\nm_{d} = 0.5\\,\\mathrm{kg},\\quad r_{d} = L_{f} + 0.08\\,\\mathrm{m},\\\\\ng = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2},\\quad |\\alpha| = 0.05\\,\\mathrm{rad}\\,\\mathrm{s}^{-2}.\n\\end{aligned}\n$$\n\n计算所需的几何量：\n\n$$\n\\begin{aligned}\nr_{f} = 0.43\\,L_{f} = 0.43 \\times 0.27 = 0.1161\\,\\mathrm{m},\\\\\nk_{f} = 0.25\\,L_{f} = 0.25 \\times 0.27 = 0.0675\\,\\mathrm{m},\\\\\nr_{h} = L_{f} + 0.44\\,L_{h} = 0.27 + 0.44 \\times 0.18 = 0.27 + 0.0792 = 0.3492\\,\\mathrm{m},\\\\\nk_{h} = 0.30\\,L_{h} = 0.30 \\times 0.18 = 0.054\\,\\mathrm{m},\\\\\nr_{d} = L_{f} + 0.08 = 0.27 + 0.08 = 0.35\\,\\mathrm{m}.\n\\end{aligned}\n$$\n\n计算转动惯量项：\n\n$$\n\\begin{aligned}\nI_{f,\\text{com}} = m_{f}\\,k_{f}^{2} = 1.2 \\times (0.0675)^{2} = 1.2 \\times 0.00455625 = 0.0054675\\,\\mathrm{kg}\\,\\mathrm{m}^{2},\\\\\nm_{f}\\,r_{f}^{2} = 1.2 \\times (0.1161)^{2} = 1.2 \\times 0.01347921 = 0.016175052\\,\\mathrm{kg}\\,\\mathrm{m}^{2},\\\\\nI_{h,\\text{com}} = m_{h}\\,k_{h}^{2} = 0.4 \\times (0.054)^{2} = 0.4 \\times 0.002916 = 0.0011664\\,\\mathrm{kg}\\,\\mathrm{m}^{2},\\\\\nm_{h}\\,r_{h}^{2} = 0.4 \\times (0.3492)^{2} = 0.4 \\times 0.12194064 = 0.048776256\\,\\mathrm{kg}\\,\\mathrm{m}^{2},\\\\\nm_{d}\\,r_{d}^{2} = 0.5 \\times (0.35)^{2} = 0.5 \\times 0.1225 = 0.06125\\,\\mathrm{kg}\\,\\mathrm{m}^{2}.\n\\end{aligned}\n$$\n\n因此，\n\n$$\n\\begin{aligned}\nI_{\\text{elbow}} = (0.0054675 + 0.016175052) + (0.0011664 + 0.048776256) + 0.06125\\\\\n= 0.021642552 + 0.049942656 + 0.06125\\\\\n= 0.132835208\\,\\mathrm{kg}\\,\\mathrm{m}^{2}.\n\\end{aligned}\n$$\n\n惯性力矩的大小为\n\n$$\n|I\\alpha| = I_{\\text{elbow}}\\,|\\alpha| = 0.132835208 \\times 0.05 = 0.0066417604\\,\\mathrm{N}\\,\\mathrm{m}.\n$$\n\n接下来计算水平构型下的静态重力力矩大小：\n\n$$\n\\begin{aligned}\nT_{\\text{static}} = m_{f}\\,g\\,r_{f} + m_{h}\\,g\\,r_{h} + m_{d}\\,g\\,r_{d}\\\\\n= (1.2 \\times 9.81 \\times 0.1161) + (0.4 \\times 9.81 \\times 0.3492) + (0.5 \\times 9.81 \\times 0.35).\n\\end{aligned}\n$$\n\n计算每一项：\n\n$$\n\\begin{aligned}\n1.2 \\times 9.81 \\times 0.1161 = 1.3667292\\,\\mathrm{N}\\,\\mathrm{m},\\\\\n0.4 \\times 9.81 \\times 0.3492 = 1.3702608\\,\\mathrm{N}\\,\\mathrm{m},\\\\\n0.5 \\times 9.81 \\times 0.35 = 1.71675\\,\\mathrm{N}\\,\\mathrm{m}.\n\\end{aligned}\n$$\n\n因此，\n\n$$\nT_{\\text{static}} = 1.3667292 + 1.3702608 + 1.71675 = 4.45374\\,\\mathrm{N}\\,\\mathrm{m}.\n$$\n\n最后，无量纲比值为\n\n$$\n\\rho = \\frac{|I\\alpha|}{T_{\\text{static}}} = \\frac{0.0066417604}{4.45374} \\approx 1.49128 \\times 10^{-3}.\n$$\n\n四舍五入到四位有效数字，结果是 $1.491 \\times 10^{-3}$。\n\n平衡充分性评估：从第一性原理出发，转动平衡假设忽略了 $\\sum M = I\\,\\alpha$ 中的惯性项 $I\\,\\alpha$。计算出的比值 $\\rho \\approx 1.491 \\times 10^{-3}$ 表明，在这一瞬间，惯性力矩的大小大约比静态重力力矩小三个数量级。因此，对于在这种缓慢、小加速度条件下估算关节力矩，准静态平衡分析是足够的，因为忽略 $I\\,\\alpha$ 所引入的误差远低于该尺度下生物力学分析中典型的测量和建模不确定性。",
            "answer": "$$\\boxed{1.491 \\times 10^{-3}}$$"
        },
        {
            "introduction": "许多生物力学系统，尤其是人体关节，都是“静态不确定”的，意味着未知的肌肉力数量超过了可用的平衡方程数量。为了解决这种肌肉冗余问题，我们引入了优化理论。这个练习要求你使用约束静态优化方法，通过最小化一个生理学成本函数来求解一组唯一的肌肉力。掌握这种方法将使你能够分析更复杂、更符合生理现实的系统，这是高级生物力学研究的一个标志。",
            "id": "4194610",
            "problem": "下肢的一个平面关节在准静态条件下由三块主动肌静态保持，因此惯性效应可以忽略不计，角加速度为零。设关节绕旋转中心所需的净屈曲力矩为 $M_{\\mathrm{req}}$。每块肌肉 $i \\in \\{1,2,3\\}$ 沿其作用线施加一个拉力 $F_i \\ge 0$，产生一个屈曲力矩 $r_i F_i$，其中 $r_i$ 是恒定的正力臂。在静态平衡时，内部净屈曲力矩恰好平衡所需力矩，因此等式约束为 $\\sum_{i=1}^{3} r_i F_i = M_{\\mathrm{req}}$。\n\n肌肉具有生理界限 $0 \\le F_i \\le F_i^{\\max}$，需要最小化的神经肌肉成本是归一化力的平方和，\n$$\nJ(\\mathbf{F}) = \\sum_{i=1}^{3} \\left(\\frac{F_i}{F_i^{\\max}}\\right)^{2}.\n$$\n\n给定数据 $M_{\\mathrm{req}} = 60$ N·m，力臂 $r_1 = 0.03$ m, $r_2 = 0.02$ m, $r_3 = 0.01$ m，以及最大力 $F_1^{\\max} = 1500$ N, $F_2^{\\max} = 800$ N, $F_3^{\\max} = 400$ N，建立约束静态优化问题，并使用拉格朗日乘子法和卡鲁什-库恩-塔克（KKT）条件进行求解。确定在最优点处哪些边界约束是激活的。\n\n报告：\n- 以行矩阵 $[F_1\\;\\;F_2\\;\\;F_3]$ 的形式报告最优肌肉力，单位为牛顿（N）。\n- 以 $[I_1\\;\\;I_2\\;\\;I_3]$ 的形式报告激活约束指示向量，其中如果在最优点处 $F_i$ 的任一边界被激活，则 $I_i = 1$，否则 $I_i = 0$。\n\n将这些组合成一个单一的行矩阵 $[F_1\\;\\;F_2\\;\\;F_3\\;\\;I_1\\;\\;I_2\\;\\;I_3]$ 作为你的最终答案。将每个力四舍五入到四位有效数字。力以牛顿（N）表示。指示向量的条目是无量纲的。",
            "solution": "问题是要求解一组肌肉力 $\\mathbf{F} = [F_1, F_2, F_3]^T$，使其在满足生理界限和平衡约束的条件下，最小化神经肌肉成本函数。这是一个约束优化问题。\n\n首先，我们对问题进行形式化描述。\n需要最小化的目标函数是归一化力的平方和：\n$$\nJ(F_1, F_2, F_3) = \\left(\\frac{F_1}{F_1^{\\max}}\\right)^{2} + \\left(\\frac{F_2}{F_2^{\\max}}\\right)^{2} + \\left(\\frac{F_3}{F_3^{\\max}}\\right)^{2}\n$$\n问题受一个代表静态平衡条件的等式约束：\n$$\ng(F_1, F_2, F_3) = r_1 F_1 + r_2 F_2 + r_3 F_3 - M_{\\mathrm{req}} = 0\n$$\n以及每块肌肉的两个不等式约束，代表其生理界限：\n$$\n\\begin{align*}\n-F_i \\le 0 \\quad (\\text{对于 } i=1,2,3) \\\\\nF_i - F_i^{\\max} \\le 0 \\quad (\\text{对于 } i=1,2,3)\n\\end{align*}\n$$\n为了解决这个问题，我们采用拉格朗日乘子法，并针对不等式约束问题推广使用卡鲁什-库恩-塔克（KKT）条件。我们构建拉格朗日函数 $\\mathcal{L}$：\n$$\n\\mathcal{L}(\\mathbf{F}, \\lambda, \\boldsymbol{\\mu}, \\boldsymbol{\\nu}) = J(\\mathbf{F}) + \\lambda g(\\mathbf{F}) - \\sum_{i=1}^{3} \\mu_i F_i + \\sum_{i=1}^{3} \\nu_i (F_i - F_i^{\\max})\n$$\n在此，$\\lambda$ 是等式约束的拉格朗日乘子，而 $\\mu_i$ 和 $\\nu_i$ 分别是下界（$F_i \\ge 0$）和上界（$F_i \\le F_i^{\\max}$）约束的KKT乘子。\n\n最优解 $( \\mathbf{F}^*, \\lambda^*, \\boldsymbol{\\mu}^*, \\boldsymbol{\\nu}^* )$ 的KKT条件如下：\n1.  **稳定性条件 (Stationarity):** 拉格朗日函数相对于原始变量 $\\mathbf{F}$ 的梯度必须为零。对于每块肌肉 $i$：\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial F_i} = \\frac{2 F_i}{(F_i^{\\max})^2} + \\lambda r_i - \\mu_i + \\nu_i = 0\n    $$\n2.  **原始可行性 (Primal Feasibility):** 所有约束都必须满足。\n    $$\n    \\begin{align*}\n    r_1 F_1 + r_2 F_2 + r_3 F_3 - M_{\\mathrm{req}} = 0 \\\\\n    F_i \\ge 0 \\\\\n    F_i \\le F_i^{\\max}\n    \\end{align*}\n    $$\n3.  **对偶可行性 (Dual Feasibility):** 不等式约束的KKT乘子必须为非负。\n    $$\n    \\mu_i \\ge 0, \\quad \\nu_i \\ge 0\n    $$\n4.  **互补松弛性 (Complementary Slackness):** 每个KKT乘子与其对应的不等式约束的乘积必须为零。\n    $$\n    \\begin{align*}\n    \\mu_i F_i = 0 \\\\\n    \\nu_i (F_i - F_i^{\\max}) = 0\n    \\end{align*}\n    $$\n\n根据互补松弛性条件，我们分析每块肌肉力 $F_i$ 的状态：\n-   如果 $0  F_i  F_i^{\\max}$ (边界未激活)，则 $\\mu_i = 0$ 且 $\\nu_i = 0$。稳定性条件变为 $\\frac{2 F_i}{(F_i^{\\max})^2} + \\lambda r_i = 0$，这给出 $F_i = -\\frac{\\lambda r_i (F_i^{\\max})^2}{2}$。由于 $F_i  0$ (且已知 $r_i  0$)，我们必须有 $\\lambda  0$。\n-   如果 $F_i = 0$ (下界激活)，则 $\\nu_i = 0$ (因为 $F_i^{\\max}  0$) 。稳定性条件变为 $\\lambda r_i - \\mu_i = 0$。由于 $\\mu_i \\ge 0$ 且 $r_i  0$，这要求 $\\lambda \\ge 0$。\n-   如果 $F_i = F_i^{\\max}$ (上界激活)，则 $\\mu_i = 0$ (因为 $F_i  0$) 。稳定性条件变为 $\\frac{2 F_i^{\\max}}{(F_i^{\\max})^2} + \\lambda r_i + \\nu_i = 0 \\implies \\nu_i = -\\lambda r_i - \\frac{2}{F_i^{\\max}}$。由于 $\\nu_i \\ge 0$，我们要求 $\\lambda \\le -\\frac{2}{r_i F_i^{\\max}}  0$。\n\n由于 $M_{\\mathrm{req}} = 60 \\text{ N·m}  0$，至少有一个肌肉力必须为正值。这排除了所有 $F_i=0$ 的情况，该情况对应于 $\\lambda \\ge 0$。因此，我们必须有 $\\lambda  0$。这意味着没有肌肉力可以为零（对于所有活动肌肉，$F_i  0$）。因此，所有的 $\\mu_i = 0$。\n\n让我们检验所有肌肉力边界都未激活的假设（$0  F_i  F_i^{\\max}$）。在这种情况下，对所有 $i$ 都有 $\\mu_i=\\nu_i=0$。力由 $F_i = -\\frac{\\lambda}{2} r_i (F_i^{\\max})^2$ 给出。将这些代入等式约束中：\n$$\n\\sum_{i=1}^{3} r_i \\left( -\\frac{\\lambda}{2} r_i (F_i^{\\max})^2 \\right) = M_{\\mathrm{req}} \\implies -\\frac{\\lambda}{2} \\sum_{i=1}^{3} r_i^2 (F_i^{\\max})^2 = M_{\\mathrm{req}}\n$$\n让我们计算总和 $S = \\sum_{i=1}^3 r_i^2 (F_i^{\\max})^2$：\n$r_1^2 (F_1^{\\max})^2 = (0.03)^2 (1500)^2 = 2025 \\text{ N}^2\\text{m}^2$\n$r_2^2 (F_2^{\\max})^2 = (0.02)^2 (800)^2 = 256 \\text{ N}^2\\text{m}^2$\n$r_3^2 (F_3^{\\max})^2 = (0.01)^2 (400)^2 = 16 \\text{ N}^2\\text{m}^2$\n$S = 2025 + 256 + 16 = 2297 \\text{ N}^2\\text{m}^2$。\n\n由此，我们求解 $\\lambda$：\n$$\n\\lambda = -\\frac{2 M_{\\mathrm{req}}}{S} = -\\frac{2(60)}{2297} = -\\frac{120}{2297}\n$$\n现在我们根据这个 $\\lambda$ 计算力：\n$F_1 = -\\frac{(-120/2297)}{2} (0.03)(1500)^2 = \\frac{60}{2297}(67500) \\approx 1763.17 \\text{ N}$\n$F_2 = -\\frac{(-120/2297)}{2} (0.02)(800)^2 = \\frac{60}{2297}(12800) \\approx 334.35 \\text{ N}$\n$F_3 = -\\frac{(-120/2297)}{2} (0.01)(400)^2 = \\frac{60}{2297}(1600) \\approx 41.79 \\text{ N}$\n\n我们将这些力与其边界进行比较：$F_1^{\\max} = 1500 \\text{ N}$, $F_2^{\\max} = 800 \\text{ N}$, $F_3^{\\max} = 400 \\text{ N}$。\n计算出的力 $F_1 \\approx 1763.17 \\text{ N}$ 违反了其上界 $F_1 > F_1^{\\max}$。因此，我们的初始假设是错误的。肌肉 $F_1$ 必须在其最大力处饱和。\n\n让我们提出一个新的假设：肌肉1处于其上界（$F_1 = F_1^{\\max}$），而肌肉2和3的边界未激活（$0  F_2  F_2^{\\max}$ 和 $0  F_3  F_3^{\\max}$）。\n对于 $F_1 = F_1^{\\max} = 1500 \\text{ N}$，上界约束是激活的，所以 $\\nu_1 \\ge 0$。\n对于 $F_2$ 和 $F_3$，边界是未激活的，所以 $\\nu_2 = \\nu_3 = 0$。由于所有的力都将是正的，所以对所有 $i$ 都有 $\\mu_i=0$。\n\n等式约束为： $r_1 F_1^{\\max} + r_2 F_2 + r_3 F_3 = M_{\\mathrm{req}}$。\n对于未激活的肌肉，力仍然是 $F_i = -\\frac{\\lambda r_i (F_i^{\\max})^2}{2}$（对于 $i=2,3$）。\n将这些代入等式约束中：\n$$\nr_1 F_1^{\\max} + r_2 \\left(-\\frac{\\lambda r_2 (F_2^{\\max})^2}{2}\\right) + r_3 \\left(-\\frac{\\lambda r_3 (F_3^{\\max})^2}{2}\\right) = M_{\\mathrm{req}}\n$$\n$$\nr_1 F_1^{\\max} - \\frac{\\lambda}{2} \\left[ r_2^2 (F_2^{\\max})^2 + r_3^2 (F_3^{\\max})^2 \\right] = M_{\\mathrm{req}}\n$$\n求解 $\\lambda$：\n$$\n\\lambda = \\frac{2(r_1 F_1^{\\max} - M_{\\mathrm{req}})}{r_2^2 (F_2^{\\max})^2 + r_3^2 (F_3^{\\max})^2}\n$$\n代入数值：\n$r_1 F_1^{\\max} = 0.03 \\times 1500 = 45 \\text{ N·m}$。\n$M_{\\mathrm{req}} = 60 \\text{ N·m}$。\n$r_2^2 (F_2^{\\max})^2 + r_3^2 (F_3^{\\max})^2 = 256 + 16 = 272 \\text{ N}^2\\text{m}^2$。\n$$\n\\lambda = \\frac{2(45 - 60)}{272} = \\frac{2(-15)}{272} = -\\frac{30}{272} = -\\frac{15}{136}\n$$\n$\\lambda$ 的值约为 $-0.11029$。\n为使此假设有效，我们必须验证所有KKT条件。\n1. 检查 $F_2$ 和 $F_3$ 的未激活边界：\n$F_2 = -\\frac{\\lambda}{2} r_2 (F_2^{\\max})^2 = - \\left( -\\frac{15}{136} \\right) \\frac{(0.02)(800)^2}{2} = \\frac{15}{136} \\times 6400 = \\frac{96000}{136} = \\frac{12000}{17} \\approx 705.88 \\text{ N}$。\n$F_3 = -\\frac{\\lambda}{2} r_3 (F_3^{\\max})^2 = - \\left( -\\frac{15}{136} \\right) \\frac{(0.01)(400)^2}{2} = \\frac{15}{136} \\times 800 = \\frac{12000}{136} = \\frac{1500}{17} \\approx 88.24 \\text{ N}$。\n我们检查是否 $0  F_2  F_2^{\\max}$ 和 $0  F_3  F_3^{\\max}$：\n$0  705.88  800$ (真)。\n$0  88.24  400$ (真)。\n2. 检查 $F_1$ 的激活边界：我们必须验证 $\\nu_1 \\ge 0$。\n$\\nu_1 = -\\lambda r_1 - \\frac{2}{F_1^{\\max}} = - \\left(-\\frac{15}{136}\\right) (0.03) - \\frac{2}{1500} = \\frac{0.45}{136} - \\frac{2}{1500} \\approx 0.003308 - 0.001333 = 0.001975$。\n由于 $\\nu_1  0$，该条件得到满足。\n所有KKT条件均已满足。因此，这是最优解。\n\n将最优力四舍五入到四位有效数字为：\n$F_1 = 1500 \\text{ N}$\n$F_2 = \\frac{12000}{17} \\approx 705.9 \\text{ N}$\n$F_3 = \\frac{1500}{17} \\approx 88.24 \\text{ N}$\n\n激活约束指示向量 $[I_1, I_2, I_3]$ 的确定如下：\n-   对于 $F_1$，上界 $F_1 = F_1^{\\max}$ 被激活。所以 $I_1 = 1$。\n-   对于 $F_2$，两个边界都未激活（$0  F_2  F_2^{\\max}$）。所以 $I_2 = 0$。\n-   对于 $F_3$，两个边界都未激活（$0  F_3  F_3^{\\max}$）。所以 $I_3 = 0$。\n指示向量为 $[1, 0, 0]$。\n\n最终结果将这些组合成一个单一的行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1500  705.9  88.24  1  0  0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}