{
    "hands_on_practices": [
        {
            "introduction": "理解生物力学中常被理想化为刚体的生物分节的运动是至关重要的。本练习提供了一种从标记点数据中精确提取平移和旋转的实用方法，这在运动捕捉实验中很常见。通过实践该方法，您将亲身体验刚体运动的数学定义，并了解测量噪声和非理想标记点配置带来的挑战。",
            "id": "4202054",
            "problem": "考虑一个刚性肢体节段，其上安装了标记点，这些标记点在节段局部坐标系中的固定位置表示为 $\\{X_i\\}_{i=1}^n$，在时刻 $t$ 时于实验室坐标系中测得的位置表示为 $\\{x_i(t)\\}_{i=1}^n$。假设一个刚性运动模型 $x_i(t) = c(t) + Q(t) X_i + \\varepsilon_i(t)$，其中 $c(t) \\in \\mathbb{R}^3$ 是平移向量，$Q(t) \\in \\mathbb{R}^{3 \\times 3}$ 是满足正交性约束 $Q(t)^\\top Q(t) = I$ 的旋转矩阵，$\\varepsilon_i(t)$ 代表测量噪声。从刚体运动是保持成对距离的等距变换的定义以及标准最小二乘法原理出发，构建目标函数 \n$$\nJ(t) = \\sum_{i=1}^n \\left\\| x_i(t) - c(t) - Q(t) X_i \\right\\|_2^2\n$$\n在约束 $Q(t)^\\top Q(t) = I$ 下的最小化问题，并推导出一个有原则的方法，用于在每个固定时刻 $t$ 从测量数据中恢复 $c(t)$ 和 $Q(t)$。解释正交性约束 $Q(t)^\\top Q(t) = I$ 在生物力学和刚性运动的背景下的作用，包括其对距离保持的影响以及对非刚性变换（如剪切和各向同性缩放）的排除。讨论解在何种条件下是唯一的且条件良好的（就标记点配置而言）。\n\n您的程序必须实现所推导的方法，并将其应用于以下时间瞬态测试套件。在每个测试用例中，给定参考标记点 $\\{X_i\\}$、一个基准刚性运动 $(c(t), Q(t))$，以及在指定情况下的用于模拟非刚性效应或噪声的扰动。对于每种情况，计算以下四个量：\n- 均方根误差\n$$\n\\mathrm{RMS}(t) = \\sqrt{\\frac{1}{n}\\sum_{i=1}^n \\left\\| x_i(t) - c^\\star(t) - Q^\\star(t) X_i \\right\\|_2^2}\n$$\n其中 $(c^\\star(t), Q^\\star(t))$ 是最小二乘估计；将 $\\mathrm{RMS}(t)$ 表示为米，四舍五入到六位小数。\n- 正交性误差\n$$\ne_{\\mathrm{orth}}(t) = \\left\\| Q^\\star(t)^\\top Q^\\star(t) - I \\right\\|_F\n$$\n其中 $\\|\\cdot\\|_F$ 表示弗罗贝尼乌斯范数；将 $e_{\\mathrm{orth}}(t)$ 表示为无单位浮点数，四舍五入到六位小数。\n- 行列式 $\\det\\!\\left(Q^\\star(t)\\right)$；将 $\\det\\!\\left(Q^\\star(t)\\right)$ 表示为无单位浮点数，四舍五入到六位小数。\n- 条件数比率\n$$\n\\rho(t) = \\frac{\\sigma_{\\min}}{\\sigma_{\\max}}\n$$\n其中 $\\sigma_{\\min}$ 和 $\\sigma_{\\max}$ 是在时刻 $t$ 由中心化后的标记点集构建的 $3 \\times 3$ 互协方差矩阵的最小和最大奇异值；将 $\\rho(t)$ 表示为无单位浮点数，四舍五入到六位小数。一个接近于 $0$ 的 $\\rho(t)$ 值表示一个病态的几何构型（例如，共线性或共面性在某种程度上破坏了旋转的可识别性）。\n\n测试套件规范：\n- 情况 $1$（理想路径，无噪声，非退化）：\n  - 参考标记点（单位：米）：\n    $$\n    X_1 = \\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix},\\quad\n    X_2 = \\begin{bmatrix}0.10\\\\0\\\\0.05\\end{bmatrix},\\quad\n    X_3 = \\begin{bmatrix}0\\\\0.20\\\\0\\end{bmatrix},\\quad\n    X_4 = \\begin{bmatrix}0.05\\\\0.10\\\\0.15\\end{bmatrix},\\quad\n    X_5 = \\begin{bmatrix}-0.07\\\\0.08\\\\-0.02\\end{bmatrix}.\n    $$\n  - 旋转是复合 $Q(t) = R_z(\\theta_z) R_x(\\theta_x)$，角度（弧度）为 $\\theta_z = 0.5$，$\\theta_x = 0.2$，其中 $R_z(\\theta)$ 和 $R_x(\\theta)$ 分别表示绕 $z$ 轴和 $x$ 轴的标准旋转。\n  - 平移 $c(t) = \\begin{bmatrix}0.02\\\\-0.01\\\\0.03\\end{bmatrix}$ 米。\n  - 测量标记点 $x_i(t)$ 由 $x_i(t) = c(t) + Q(t) X_i$ 精确生成（无噪声）。\n- 情况 $2$（有噪声测量，非退化）：\n  - 与情况 $1$ 相同的 $\\{X_i\\}$、$Q(t)$ 和 $c(t)$。\n  - 测量标记点 $x_i(t)$ 由 $x_i(t) = c(t) + Q(t) X_i + \\eta_i$ 生成，其中 $\\eta_i \\sim \\mathcal{N}(0, \\sigma^2 I)$，$\\sigma = 0.001$ 米，对每个标记点和坐标独立。\n- 情况 $3$（退化几何构型：共线标记点）：\n  - 参考标记点（单位：米）：\n    $$\n    X_1 = \\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix},\\quad\n    X_2 = \\begin{bmatrix}0.10\\\\0\\\\0\\end{bmatrix},\\quad\n    X_3 = \\begin{bmatrix}0.20\\\\0\\\\0\\end{bmatrix},\\quad\n    X_4 = \\begin{bmatrix}0.30\\\\0\\\\0\\end{bmatrix}.\n    $$\n  - 旋转 $Q(t) = R_x(\\theta_x)$，其中 $\\theta_x = 0.7$ 弧度。\n  - 平移 $c(t) = \\begin{bmatrix}-0.03\\\\0.02\\\\0.01\\end{bmatrix}$ 米。\n  - 测量标记点 $x_i(t)$ 由 $x_i(t) = c(t) + Q(t) X_i$ 精确生成（无噪声）。\n- 情况 $4$（各向同性尺度不匹配，以说明约束的作用）：\n  - 参考标记点与情况 $1$ 相同。\n  - 旋转和平移与情况 $1$ 相同。\n  - 在测量模型中应用一个比例因子 $s = 1.02$：$x_i(t) = c(t) + Q(t) \\left( s X_i \\right)$（无噪声）。估计过程仍然强制 $Q(t)^\\top Q(t) = I$ 且不允许缩放。\n\n您的程序必须：\n1. 实现一个方法，该方法通过最小化目标函数 $J(t)$ 并满足约束 $Q(t)^\\top Q(t) = I$ 来计算 $(c^\\star(t), Q^\\star(t))$，使用基于基本原理且数学上合理的途径。\n2. 对于每个测试用例，按顺序计算 $\\mathrm{RMS}(t)$、$e_{\\mathrm{orth}}(t)$、$\\det\\!\\left(Q^\\star(t)\\right)$ 和 $\\rho(t)$，并按规定将每个值四舍五入到六位小数。\n3. 生成单行输出，其中包含四个测试用例的四元素列表的列表，格式完全如下\n$$\n\\text{[}[r_1,e_1,d_1,\\rho_1],[r_2,e_2,d_2,\\rho_2],[r_3,e_3,d_3,\\rho_3],[r_4,e_4,d_4,\\rho_4]\\text{]}\n$$\n其中每个 $r_k$ 的单位是米，其他是无单位浮点数，均四舍五入到六位小数，各项之间用逗号分隔，无附加文本。",
            "solution": "所给问题是生物力学和计算机视觉中的一个经典基础任务：从一组对应点估计刚体运动。这在形式上被称为正交普罗克汝斯忒斯问题（orthogonal Procrustes problem）。我们的任务是推导其解法，解释其理论基础，并予以实现。\n\n问题是找到平移向量 $c(t) \\in \\mathbb{R}^3$ 和旋转矩阵 $Q(t) \\in SO(3)$，使一组测量的标记点位置 $\\{x_i(t)\\}_{i=1}^n$ 与其变换后的参考位置 $\\{X_i\\}_{i=1}^n$ 之间的平方误差和最小。需要最小化的目标函数是：\n$$\nJ(t) = \\sum_{i=1}^n \\left\\| x_i(t) - c(t) - Q(t) X_i \\right\\|_2^2\n$$\n约束条件是 $Q(t)$ 为一个旋转矩阵，这意味着它满足正交性 $Q(t)^\\top Q(t) = I$ 和正确的方向 $\\det(Q(t)) = +1$。\n\n为简化符号，我们将在推导中省略显式的时间依赖 $(t)$，因为对每个固定时刻，该过程是相同的。\n\n**步骤1：最优平移 $c$ 的推导**\n\n目标函数 $J$ 是关于 $c$ 的二次函数。我们可以通过求 $J$ 对 $c$ 的梯度并将其置零来找到最优平移 $c^\\star$。\n$$\n\\frac{\\partial J}{\\partial c} = \\sum_{i=1}^n \\frac{\\partial}{\\partial c} \\left( x_i - c - Q X_i \\right)^\\top \\left( x_i - c - Q X_i \\right)\n$$\n$$\n\\frac{\\partial J}{\\partial c} = \\sum_{i=1}^n 2 \\left( x_i - c - Q X_i \\right) (-1) = -2 \\sum_{i=1}^n \\left( x_i - c - Q X_i \\right)\n$$\n将梯度置零：\n$$\n\\sum_{i=1}^n \\left( x_i - c^\\star - Q X_i \\right) = 0\n$$\n$$\n\\sum_{i=1}^n x_i - \\sum_{i=1}^n c^\\star - \\sum_{i=1}^n Q X_i = 0\n$$\n$$\n\\sum_{i=1}^n x_i - n c^\\star - Q \\sum_{i=1}^n X_i = 0\n$$\n解出 $c^\\star$：\n$$\nn c^\\star = \\sum_{i=1}^n x_i - Q \\sum_{i=1}^n X_i\n$$\n$$\nc^\\star = \\frac{1}{n} \\sum_{i=1}^n x_i - Q \\left( \\frac{1}{n} \\sum_{i=1}^n X_i \\right)\n$$\n我们定义标记点集的质心（平均位置）：\n$$\n\\bar{x} = \\frac{1}{n} \\sum_{i=1}^n x_i \\quad \\text{和} \\quad \\bar{X} = \\frac{1}{n} \\sum_{i=1}^n X_i\n$$\n最优平移则由下式给出：\n$$\nc^\\star = \\bar{x} - Q \\bar{X}\n$$\n这个优美的结果表明，最优平移将旋转后的参考标记点质心与测量标记点的质心对齐。\n\n**步骤2：最优旋转 $Q$ 的推导**\n\n我们将 $c^\\star$ 的表达式代回目标函数 $J$。这将 $Q$ 的优化问题与 $c$ 解耦。\n范数内的向量变为：\n$$\nx_i - c^\\star - Q X_i = x_i - (\\bar{x} - Q\\bar{X}) - Q X_i = (x_i - \\bar{x}) - Q(X_i - \\bar{X})\n$$\n我们定义中心化后的标记点坐标：\n$$\nx'_i = x_i - \\bar{x} \\quad \\text{和} \\quad X'_i = X_i - \\bar{X}\n$$\n目标函数简化为寻找能使下式最小化的旋转 $Q$：\n$$\nJ(Q) = \\sum_{i=1}^n \\| x'_i - Q X'_i \\|_2^2\n$$\n我们展开平方范数：\n$$\n\\| x'_i - Q X'_i \\|^2 = (x'_i - Q X'_i)^\\top (x'_i - Q X'_i) = {x'_i}^\\top x'_i - {x'_i}^\\top Q X'_i - (Q X'_i)^\\top x'_i + (Q X'_i)^\\top (Q X'_i)\n$$\n使用正交性约束 $Q^\\top Q = I$：\n$$\n\\| x'_i - Q X'_i \\|^2 = \\|x'_i\\|^2 - 2 {x'_i}^\\top Q X'_i + {X'_i}^\\top Q^\\top Q X'_i = \\|x'_i\\|^2 - 2 {x'_i}^\\top Q X'_i + \\|X'_i\\|^2\n$$\n对所有标记点求和，目标函数为：\n$$\nJ(Q) = \\sum_{i=1}^n (\\|x'_i\\|^2 + \\|X'_i\\|^2) - 2 \\sum_{i=1}^n {x'_i}^\\top Q X'_i\n$$\n项 $\\sum \\|x'_i\\|^2$ 和 $\\sum \\|X'_i\\|^2$ 相对于 $Q$ 是常数。因此，最小化 $J(Q)$ 等价于最大化以下项：\n$$\n\\sum_{i=1}^n {x'_i}^\\top Q X'_i\n$$\n利用标量 $a$ 具有 $a = \\text{tr}(a)$ 的性质，以及迹算子的循环性质 $\\text{tr}(ABC) = \\text{tr}(CAB)$，我们可以重写目标：\n$$\n\\sum_{i=1}^n \\text{tr}({x'_i}^\\top Q X'_i) = \\sum_{i=1}^n \\text{tr}(X'_i {x'_i}^\\top Q) = \\text{tr}\\left( \\left( \\sum_{i=1}^n X'_i {x'_i}^\\top \\right) Q \\right)\n$$\n我们定义 $3 \\times 3$ 的互协方差矩阵 $H$ 为：\n$$\nH = \\sum_{i=1}^n X'_i {x'_i}^\\top\n$$\n问题现在是找到使 $\\text{tr}(H^\\top Q)$ 最大化的旋转矩阵 $Q$。这是矩阵理论中的一个已知结果。解可通过对 $H$ 进行奇异值分解（SVD）得到。设 $H$ 的SVD为：\n$$\nH = U \\Sigma V^\\top\n$$\n其中 $U, V \\in \\mathbb{R}^{3 \\times 3}$ 是正交矩阵，$\\Sigma$ 是由非负奇异值 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3 \\ge 0$ 构成的对角矩阵。\n待最大化的迹变为 $\\text{tr}(H^\\top Q) = \\text{tr}(V \\Sigma U^\\top Q)$。令 $Z = U^\\top Q V$，它也是一个正交矩阵。则 $Q = UZV^\\top$。迹变为：\n$$\n\\text{tr}(V \\Sigma Z^\\top V^\\top UZV^\\top) = \\text{tr}(V \\Sigma Z^\\top U^\\top U Z V^\\top) = \\text{tr(V\\Sigma Z^\\top Z V^\\top)} = \\text{tr}(\\Sigma)\n$$\n这似乎是错误的。让我们仔细地重新开始迹的论证。我们想最大化 $\\text{tr}(Q H) = \\text{tr}(Q U \\Sigma V^\\top)$。\n令 $Z = V^\\top Q U$。$Z$ 是正交的。所以 $Q=VZU^\\top$。\n迹是 $\\text{tr}(V Z U^\\top U \\Sigma V^\\top) = \\text{tr}(V Z \\Sigma V^\\top) = \\text{tr}(Z \\Sigma V^\\top V) = \\text{tr}(Z \\Sigma)$。\n我们需要在 $Z$ 是正交矩阵的约束下最大化 $\\text{tr}(Z \\Sigma) = \\sum_{j=1}^3 Z_{jj} \\sigma_j$。由于 $\\sigma_j \\ge 0$ 且 $|Z_{jj}| \\le 1$，当 $Z = I$（单位矩阵）时达到最大值 $\\sum \\sigma_j$。\n如果 $Z=I$，那么 $V^\\top Q U = I$，这给出了最优正交矩阵为：\n$$\nQ^\\star = V U^\\top\n$$\n\n**步骤3：强制执行真旋转约束（$\\det(Q) = +1$）**\n\n约束 $Q^\\top Q=I$ 允许旋转（$\\det(Q)=+1$）和反射（$\\det(Q)=-1$）。物理上的刚体运动不可能是反射。我们必须强制 $\\det(Q)=+1$。\n我们解的行列式是 $\\det(Q^\\star) = \\det(V U^\\top) = \\det(V)\\det(U)$。这个乘积可能为 $-1$。如果最优正交变换是反射，就会发生这种情况，这在有噪声的数据中可能出现。\n如果 $\\det(Q^\\star)=-1$，我们必须找到最接近此反射的旋转矩阵。这通过找到一个满足 $\\det(Z)=\\det(V)\\det(U)= -1$ 且能最大化 $\\text{tr}(Z \\Sigma) = Z_{11}\\sigma_1 + Z_{22}\\sigma_2 + Z_{33}\\sigma_3$ 的正交矩阵 $Z$ 来实现。由于 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3 \\ge 0$，在此行列式约束下的最大值通过 $Z = \\text{diag}(1, 1, -1)$ 实现，其迹为 $\\sigma_1 + \\sigma_2 - \\sigma_3$。\n因此，如果 $\\det(V U^\\top) = -1$，最优旋转是：\n$$\nQ^\\star = V \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  -1 \\end{pmatrix} U^\\top\n$$\n这两种情况可以紧凑地写为 $Q^\\star = V S U^\\top$，其中 $S = \\text{diag}(1, 1, \\det(V U^\\top))$。\n\n**正交性约束 $Q^\\top Q=I$ 的作用**\n\n在生物力学中，肢体节段通常被建模为刚体。刚体被定义为一个粒子系统，其中任何两个粒子之间的距离随时间保持不变。描述这种物体运动的变换必须保持这些距离；这种变换称为等距变换。\n正交性约束 $Q^\\top Q=I$ 是这一物理原理的数学表达。对于任何向量 $v$，其长度在正交变换下保持不变：$\\|Qv\\|^2 = (Qv)^\\top(Qv) = v^\\top Q^\\top Q v = v^\\top I v = v^\\top v = \\|v\\|^2$。\n因此，任意两点 $X_i$ 和 $X_j$ 之间的距离得以保持：\n$$\n\\|Q X_i - Q X_j\\|^2 = \\|Q(X_i - X_j)\\|^2 = \\|X_i - X_j\\|^2\n$$\n不满足此约束的变换是非刚性的。例如：\n- **剪切**：像 $S = \\begin{pmatrix} 1  k \\\\ 0  1 \\end{pmatrix}$ 这样的变换矩阵，其 $S^\\top S \\neq I$，并且不保持角度或距离，会使物体变形。\n- **各向同性缩放**：变换 $T=sI$，$s \\neq \\pm 1$，其 $T^\\top T = s^2 I \\neq I$。它将所有距离改变一个因子 $|s|$。\n算法严格执行 $Q^\\top Q=I$ 确保了任何估计出的运动都与刚体模型在物理上一致，明确排除了非刚性形变（如剪切或缩放）在解之外。测试套件的情况4演示了这一点：即使输入数据包含缩放，算法也会找到最佳拟合的*旋转*，并将缩放量化为残余误差。\n\n**解的唯一性和条件良好性**\n\n解 $Q$ 的唯一性取决于互协方差矩阵 $H$ 的性质。如果SVD在相关意义上是唯一的，则解 $Q^\\star = VU^\\top$ 是唯一的。这与 $H$ 的奇异值有关。$H$的奇异值是 $H H^\\top$ 特征值的平方根。\n$H H^\\top = (\\sum X'_i {x'_i}^\\top)(\\sum {x_j' {X_j'}^\\top}) \\approx (\\sum X'_i (Q X'_i)^\\top)(\\sum Q X'_j {X_j'}^\\top) = ((\\sum X'_i {X'_i}^\\top)Q^\\top)(Q(\\sum X'_j {X_j'}^\\top)) = A^2$，其中 $A=\\sum X'_i {X'_i}^\\top$ 是中心化参考标记点的协方差矩阵。\n$H$ 的秩由 $A$ 的秩决定，而 $A$ 的秩又取决于参考标记点 $\\{X_i\\}$ 的几何构型。\n- **秩为1（共线标记点）**：如果标记点位于一条直线上，向量 $\\{X'_i\\}$ 张成一个一维空间。$A$ 的秩为1，$H$ 的秩也为1。$H$ 的两个奇异值为零（$\\sigma_2 = \\sigma_3 = 0$）。旋转是模糊的；围绕标记点定义的轴的任何旋转都是无法检测的。解不是唯一的。\n- **秩为2（共面，非共线标记点）**：如果标记点位于一个平面上，向量 $\\{X'_i\\}$ 张成一个二维空间。$A$ 的秩为2，$H$ 的秩也为2。最小的奇异值为零（$\\sigma_3 = 0$）。围绕平面法线的旋转分量是模糊的。\n- **秩为3（非共面标记点）**：这至少需要4个标记点。向量 $\\{X'_i\\}$ 张成一个三维空间。$A$ 和 $H$ 是满秩的，所有奇异值都为正。如果所有奇异值都是不同的（$\\sigma_1 > \\sigma_2 > \\sigma_3 > 0$），SVD是唯一的（除了U,V列的符号外），旋转Q是唯一确定的。\n\n问题的**条件**由 $H$ 的奇异值之比来描述。条件数比率 $\\rho(t) = \\sigma_{\\min} / \\sigma_{\\max} = \\sigma_3 / \\sigma_1$ 表示标记点的几何构型离退化有多近。一个接近于0的 $\\rho(t)$ 值意味着问题是病态的：几何构型接近共线或共面，并且解 $Q$ 对测量噪声会高度敏感。一个鲁棒的标记点配置会使该比率最大化，这意味着标记点在三维空间中分布得很好。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the test cases and print the final result.\n    \"\"\"\n\n    def get_rotation_matrices(theta_z=None, theta_x=None):\n        \"\"\"Helper to create canonical rotation matrices.\"\"\"\n        Q = np.identity(3)\n        if theta_z is not None:\n            cz, sz = np.cos(theta_z), np.sin(theta_z)\n            Rz = np.array([[cz, -sz, 0], [sz, cz, 0], [0, 0, 1]])\n            Q = Rz @ Q\n        if theta_x is not None:\n            cx, sx = np.cos(theta_x), np.sin(theta_x)\n            Rx = np.array([[1, 0, 0], [0, cx, -sx], [0, sx, cx]])\n            Q = Q @ Rx # In problem statement, Q = Rz Rx. This order is preserved here.\n        return Q\n\n    def solve_procrustes(X, x):\n        \"\"\"\n        Solves the orthogonal Procrustes problem to find the optimal rigid\n        transformation (c, Q) between two corresponding point sets X and x.\n\n        Args:\n            X (np.ndarray): n x 3 array of reference marker positions.\n            x (np.ndarray): n x 3 array of measured marker positions.\n\n        Returns:\n            tuple: A tuple containing the four required metrics:\n                   (RMS error, orthogonality error, determinant, conditioning ratio).\n        \"\"\"\n        n, dim = X.shape\n        if n  3:\n            raise ValueError(\"At least 3 markers are required.\")\n\n        # Step 1: Compute centroids and centered coordinates\n        X_bar = np.mean(X, axis=0)\n        x_bar = np.mean(x, axis=0)\n        X_prime = X - X_bar\n        x_prime = x - x_bar\n\n        # Step 2: Compute the cross-covariance matrix H\n        H = X_prime.T @ x_prime\n\n        # Step 3: Compute SVD of H\n        U, s, Vt = np.linalg.svd(H)\n\n        # Step 4: Compute the optimal rotation matrix Q\n        Q_star = Vt.T @ U.T\n\n        # Step 5: Correct for reflections\n        if np.linalg.det(Q_star)  0:\n            Vt_corr = Vt.copy()\n            Vt_corr[-1, :] *= -1\n            Q_star = Vt_corr.T @ U.T\n\n        # Step 6: Compute the optimal translation\n        c_star = x_bar - Q_star @ X_bar\n\n        # --- Compute Output Metrics ---\n\n        # 1. RMS error\n        sum_sq_err = 0.0\n        for i in range(n):\n            x_est_i = c_star + Q_star @ X[i]\n            error_i = x[i] - x_est_i\n            sum_sq_err += np.dot(error_i, error_i)\n        rms_error = np.sqrt(sum_sq_err / n)\n\n        # 2. Orthogonality error\n        I = np.identity(dim)\n        ortho_error = np.linalg.norm(Q_star.T @ Q_star - I, 'fro')\n\n        # 3. Determinant\n        det_Q = np.linalg.det(Q_star)\n\n        # 4. Conditioning ratio\n        # s is sorted in descending order. Condition ratio is min/max.\n        if s[0]  1e-12: # Check for division by zero if all singular values are zero\n            cond_ratio = 0.0\n        else:\n            cond_ratio = s[-1] / s[0]\n\n        return rms_error, ortho_error, det_Q, cond_ratio\n\n\n    # --- Test Suite ---\n    all_results = []\n    rng = np.random.default_rng(42) # For reproducible noise\n\n    # Case 1: Happy path, noise-free, non-degenerate\n    X1 = np.array([\n        [0.0, 0.0, 0.0], [0.10, 0.0, 0.05], [0.0, 0.20, 0.0],\n        [0.05, 0.10, 0.15], [-0.07, 0.08, -0.02]\n    ])\n    # The problem statement says Q(t) = R_z R_x, which is Rx applied first, then Rz.\n    # The helper function is Q = Rz @ Q_initial, then Q = Q @ Rx if Rx is not None.\n    # Let's trace it.\n    # Q = I; Q = Rz @ I = Rz; Q = Rz @ Rx. This matches the problem statement.\n    Q1 = get_rotation_matrices(theta_z=0.5, theta_x=0.2) \n    c1 = np.array([0.02, -0.01, 0.03])\n    x1 = (Q1 @ X1.T).T + c1\n    all_results.append(solve_procrustes(X1, x1))\n\n    # Case 2: Noisy measurements, non-degenerate\n    X2, Q2, c2 = X1, Q1, c1\n    sigma_noise = 0.001\n    noise = rng.normal(0, sigma_noise, size=X2.shape)\n    x2 = (Q2 @ X2.T).T + c2 + noise\n    all_results.append(solve_procrustes(X2, x2))\n\n    # Case 3: Degenerate geometry (collinear markers)\n    X3 = np.array([\n        [0.0, 0.0, 0.0], [0.10, 0.0, 0.0], [0.20, 0.0, 0.0], [0.30, 0.0, 0.0]\n    ])\n    Q3 = get_rotation_matrices(theta_x=0.7)\n    c3 = np.array([-0.03, 0.02, 0.01])\n    x3 = (Q3 @ X3.T).T + c3\n    all_results.append(solve_procrustes(X3, x3))\n\n    # Case 4: Isotropic scale mismatch\n    X4, Q4, c4 = X1, Q1, c1\n    scale_factor = 1.02\n    x4 = (Q4 @ (scale_factor * X4).T).T + c4\n    all_results.append(solve_procrustes(X4, x4))\n    \n    # Format the final output string\n    formatted_results = [f\"[{','.join(f'{val:.6f}' for val in res)}]\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "与刚体不同，软生物组织在负载下会表现出显著的变形。本练习通过要求您推导一个由超弹性应变能函数建模的组织的力学响应，从而深入探讨可变形体的力学原理。从连续介质力学的基本原理出发，您将把施加的拉伸与产生的应力联系起来，这是生物材料本构建模中的一项核心技能。",
            "id": "4202041",
            "problem": "一个软组织样本被建模为一个沿着第一主轴进行单轴拉伸的不可压缩、各向同性、超弹性固体。形变梯度是均匀的对角阵，由$F=\\mathrm{diag}(\\lambda,\\lambda_{t},\\lambda_{t})$给出，其中$\\lambda0$是施加的轴向拉伸，$\\lambda_{t}0$是由不可压缩约束引起的未知横向拉伸。侧面是无牵引力的。应变能密度由单项 Ogden 模型指定\n$$\nW(\\lambda_{1},\\lambda_{2},\\lambda_{3})=\\frac{\\mu}{\\alpha}\\left(\\lambda_{1}^{\\alpha}+\\lambda_{2}^{\\alpha}+\\lambda_{3}^{\\alpha}-3\\right),\n$$\n其中$\\mu0$是无穷小剪切模量，$\\alpha1$是一个给定的无量纲材料参数。假设没有体力，并通过一个 Lagrange 乘子来施加不可压缩性。\n\n仅从连续介质力学中的基本定义（形变梯度 $F$、雅可比行列式 $J=\\det F$、无体力情况下的线性动量平衡，以及用 Lagrange 乘子施加不可压缩性的超弹性本构关系）出发，推导：\n\n1) 使用不可压缩约束，推导作为 $\\lambda$ 函数的横向拉伸 $\\lambda_{t}$。\n\n2) 用 $\\lambda$、$\\lambda_{t}$ 和材料参数表示主 Cauchy 应力分量，并通过在侧面施加无牵引力边界条件来确定 Lagrange 乘子。\n\n3) 推导无量纲轴向 Cauchy 应力 $\\sigma_{11}/\\mu$ 作为 $\\lambda$ 和 $\\alpha$ 函数的封闭形式表达式。\n\n请提供 $\\sigma_{11}/\\mu$ 关于 $\\lambda$ 和 $\\alpha$ 的单一封闭形式解析表达式作为最终答案。由于所求量是无量纲的，您无需在最终表达式中表示任何单位。",
            "solution": "用户提供了一个问题陈述，在尝试求解之前，必须首先验证其科学合理性、自洽性和形式化可行性。\n\n### 第1步：提取已知条件\n- **物理模型**：该材料是一个软组织样本，被建模为不可压缩、各向同性、超弹性固体。\n- **加载条件**：样本在第一主轴方向上承受单轴拉伸。\n- **形变梯度**：形变梯度张量 $F$ 是均匀的对角阵，由 $F=\\mathrm{diag}(\\lambda, \\lambda_{t}, \\lambda_{t})$ 给出，其中 $\\lambda0$ 是轴向拉伸，$\\lambda_{t}0$ 是横向拉伸。\n- **运动学约束**：该材料是不可压缩的，这意味着 $J = \\det(F) = 1$。该约束使用一个 Lagrange 乘子来施加。\n- **边界条件**：侧面无牵引力。\n- **本构定律**：应变能密度函数 $W$ 是一个单项 Ogden 模型：$W(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = \\frac{\\mu}{\\alpha}(\\lambda_{1}^{\\alpha} + \\lambda_{2}^{\\alpha} + \\lambda_{3}^{\\alpha} - 3)$。\n- **材料参数**：$\\mu  0$ 是无穷小剪切模量，$\\alpha  1$ 是一个无量纲材料参数。\n- **其他假设**：不存在体力。\n\n### 第2步：使用提取的已知条件进行验证\n根据既定标准对问题进行评估：\n- **科学依据**：该问题基于非线性弹性和连续介质力学的成熟理论。Ogden 模型是一种标准的超弹性本构定律，形变梯度、不可压缩性和 Cauchy 应力的概念是基本原理。该问题是科学合理的。\n- **适定性**：该问题提供了一个特定的本构模型、一个确定的形变状态和清晰的边界条件。所要求的三个任务是具体的，并导向一个唯一的数学解。该问题是适定的。\n- **客观性**：该问题使用精确、正式且无偏见的技术语言陈述。没有主观或基于意见的元素。\n- **完整性和一致性**：提供了所有必要的信息（本构定律、形变、约束、边界条件）。设置中没有矛盾之处。\n- **现实性**：该设置模拟了对软质类橡胶材料的标准单轴拉伸试验，这是生物力学和材料科学中常见的实验程序。Ogden 模型常用于此类材料。该问题是物理上现实的。\n\n### 第3步：结论与行动\n该问题是有效的。这是非线性连续介质力学中的一个标准练习题，它科学合理、适定且自洽。因此，将推导其解。\n\n### 解的推导\n\n求解过程将遵循问题陈述中要求的三个步骤。\n\n**1) 横向拉伸 $\\lambda_t$ 的推导**\n\n材料被指定为不可压缩。这一运动学约束在数学上表示为要求形变梯度的行列式（即雅可比行列式 $J$）必须等于 $1$。\n$$J = \\det(F) = 1$$\n形变梯度 $F$ 是一个给定的对角矩阵：\n$$F = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  \\lambda_t  0 \\\\ 0  0  \\lambda_t \\end{pmatrix}$$\n对角矩阵的行列式是其对角元素的乘积。\n$$J = \\lambda \\cdot \\lambda_t \\cdot \\lambda_t = \\lambda \\lambda_t^2$$\n施加不可压缩约束 $J=1$：\n$$\\lambda \\lambda_t^2 = 1$$\n求解作为轴向拉伸 $\\lambda$ 函数的横向拉伸 $\\lambda_t$：\n$$\\lambda_t^2 = \\frac{1}{\\lambda} = \\lambda^{-1}$$\n由于拉伸必须为正（$\\lambda_t  0$），我们取正平方根：\n$$\\lambda_t = (\\lambda^{-1})^{1/2} = \\lambda^{-1/2}$$\n\n**2) 主 Cauchy 应力的推导和 Lagrange 乘子的确定**\n\n对于各向同性、不可压缩的超弹性材料，Cauchy 应力张量的主分量 $\\sigma_i$ 与主拉伸 $\\lambda_i$ 和应变能密度函数 $W$ 通过以下本构关系相关联：\n$$\\sigma_i = -p + \\lambda_i \\frac{\\partial W}{\\partial \\lambda_i}$$\n其中 $p$ 是施加不可压缩约束的任意静水压力（Lagrange 乘子）。主拉伸是给定形变梯度 $F$ 的对角分量：$\\lambda_1 = \\lambda$，$\\lambda_2 = \\lambda_t$ 和 $\\lambda_3 = \\lambda_t$。\n\n应变能密度函数由 Ogden 模型给出：\n$$W(\\lambda_1, \\lambda_2, \\lambda_3) = \\frac{\\mu}{\\alpha} \\left( \\lambda_1^{\\alpha} + \\lambda_2^{\\alpha} + \\lambda_3^{\\alpha} - 3 \\right)$$\n我们首先计算 $W$ 对每个主拉伸的偏导数：\n$$\\frac{\\partial W}{\\partial \\lambda_1} = \\frac{\\mu}{\\alpha} (\\alpha \\lambda_1^{\\alpha-1}) = \\mu \\lambda_1^{\\alpha-1}$$\n$$\\frac{\\partial W}{\\partial \\lambda_2} = \\frac{\\mu}{\\alpha} (\\alpha \\lambda_2^{\\alpha-1}) = \\mu \\lambda_2^{\\alpha-1}$$\n$$\\frac{\\partial W}{\\partial \\lambda_3} = \\frac{\\mu}{\\alpha} (\\alpha \\lambda_3^{\\alpha-1}) = \\mu \\lambda_3^{\\alpha-1}$$\n现在，我们将这些导数代入主 Cauchy 应力的表达式中：\n$$\\sigma_1 = -p + \\lambda_1 (\\mu \\lambda_1^{\\alpha-1}) = -p + \\mu \\lambda_1^{\\alpha}$$\n$$\\sigma_2 = -p + \\lambda_2 (\\mu \\lambda_2^{\\alpha-1}) = -p + \\mu \\lambda_2^{\\alpha}$$\n$$\\sigma_3 = -p + \\lambda_3 (\\mu \\lambda_3^{\\alpha-1}) = -p + \\mu \\lambda_3^{\\alpha}$$\n主方向与坐标轴对齐，因此 Cauchy 应力张量 $\\sigma$ 是对角阵，其分量为 $\\sigma_{11} = \\sigma_1$、$\\sigma_{22} = \\sigma_2$ 和 $\\sigma_{33} = \\sigma_3$。代入主拉伸 $\\lambda_1 = \\lambda$、$\\lambda_2 = \\lambda_t$ 和 $\\lambda_3 = \\lambda_t$：\n$$\\sigma_{11} = -p + \\mu \\lambda^{\\alpha}$$\n$$\\sigma_{22} = -p + \\mu \\lambda_t^{\\alpha}$$\n$$\\sigma_{33} = -p + \\mu \\lambda_t^{\\alpha}$$\n问题陈述侧面是无牵引力的。对于沿第一轴的单轴试验，侧面是法线方向为第二和第三方向的面。这些面上的无牵引力条件意味着垂直于这些面的应力分量为零。\n$$\\sigma_{22} = 0 \\quad \\text{and} \\quad \\sigma_{33} = 0$$\n使用条件 $\\sigma_{22}=0$（这也满足 $\\sigma_{33}=0$）：\n$$0 = -p + \\mu \\lambda_t^{\\alpha}$$\n我们现在可以解出 Lagrange 乘子 $p$：\n$$p = \\mu \\lambda_t^{\\alpha}$$\n代入第1部分得到的 $\\lambda_t$ 的表达式，$\\lambda_t = \\lambda^{-1/2}$：\n$$p = \\mu (\\lambda^{-1/2})^{\\alpha} = \\mu \\lambda^{-\\alpha/2}$$\n这就确定了 Lagrange 乘子，用施加的拉伸 $\\lambda$ 和材料参数来表示。\n\n**3) 无量纲轴向 Cauchy 应力的推导**\n\n最后一步是找到无量纲轴向 Cauchy 应力 $\\sigma_{11}/\\mu$ 的封闭形式表达式。轴向应力分量是 $\\sigma_{11}$：\n$$\\sigma_{11} = -p + \\mu \\lambda^{\\alpha}$$\n代入上一步推导出的 $p$ 的表达式：\n$$\\sigma_{11} = -(\\mu \\lambda^{-\\alpha/2}) + \\mu \\lambda^{\\alpha}$$\n提出剪切模量 $\\mu$：\n$$\\sigma_{11} = \\mu (\\lambda^{\\alpha} - \\lambda^{-\\alpha/2})$$\n为了得到无量纲轴向应力，我们除以 $\\mu$：\n$$\\frac{\\sigma_{11}}{\\mu} = \\lambda^{\\alpha} - \\lambda^{-\\alpha/2}$$\n这就是无量纲轴向 Cauchy 应力作为轴向拉伸 $\\lambda$ 和材料参数 $\\alpha$ 函数的最终封闭形式表达式。",
            "answer": "$$\\boxed{\\lambda^{\\alpha} - \\lambda^{-\\frac{\\alpha}{2}}}$$"
        },
        {
            "introduction": "对于一个既在变形又在经历大范围刚体运动的物体，我们应该如何描述其应力状态？本练习通过检验至关重要的材料客观性原理来应对这一高级问题。您将证明为什么简单的应力时间导数在刚体旋转时会失效，并学习客观应力率（如Jaumann率）如何通过保持对观察者参考系的不变性来正确捕捉物理现象。",
            "id": "4202062",
            "problem": "一个生物力学操纵器中的均匀、不可压缩的组织段，绕$z$轴以恒定角速度$\\omega$进行刚体旋转。其速度场为$\\mathbf{v}(\\mathbf{x},t) = \\boldsymbol{\\omega} \\times \\mathbf{x}$，其中$\\boldsymbol{\\omega} = \\omega\\,\\mathbf{e}_z$，因此空间速度梯度$\\mathbf{L} = \\nabla \\mathbf{v}$可分解为对称的变形率张量$\\mathbf{D} = \\tfrac{1}{2}(\\mathbf{L} + \\mathbf{L}^{\\top})$和反对称的自旋张量$\\mathbf{W} = \\tfrac{1}{2}(\\mathbf{L} - \\mathbf{L}^{\\top})$。该组织在$t=0$时带有一个均匀的初始Cauchy应力，在实验室坐标系中表示为$\\boldsymbol{\\sigma}(0) = \\sigma_0\\,\\mathbf{e}_x \\otimes \\mathbf{e}_x$，其中$\\sigma_0$表示由残余张力引起的单轴预应力大小。设$\\mathbf{Q}(t)$为描述物体刚体旋转的正交旋转张量，满足$\\mathbf{Q}(0)=\\mathbf{I}$和$\\dot{\\mathbf{Q}}(t) = \\mathbf{W}\\mathbf{Q}(t)$。\n\n考虑两种应力演化的本构公式：\n1. 使用物质时间导数的非客观次弹性率，$\\dot{\\boldsymbol{\\sigma}} = \\mathbb{C} : \\mathbf{D}$，其中$\\mathbb{C}$是四阶弹性模量张量。在刚体旋转下，$\\mathbf{D}=\\mathbf{0}$，因此该定律预测在实验室坐标系中$\\dot{\\boldsymbol{\\sigma}}=\\mathbf{0}$。\n2. 一种客观的同转率，具体为Jaumann率，$\\stackrel{\\triangle}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} - \\mathbf{W}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\mathbf{W}$，耦合到相同的弹性响应$\\stackrel{\\triangle}{\\boldsymbol{\\sigma}} = \\mathbb{C} : \\mathbf{D}$。在刚体旋转下，这得到$\\stackrel{\\triangle}{\\boldsymbol{\\sigma}}=\\mathbf{0}$，因此$\\dot{\\boldsymbol{\\sigma}} = \\mathbf{W}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\mathbf{W}$。\n\n仅使用基本运动学和上述模型形式，证明当应力在由$\\mathbf{Q}(t)$定义的随体坐标系中表示时，非客观公式会产生虚假的剪切应力，而Jaumann率公式消除了这种效应。具体来说，推导由非客观公式预测的人为剪切分量$\\sigma_{12}^{\\text{spurious}}(t)$的解析表达式，其中下标$1,2$表示在基为$\\{\\mathbf{Q}(t)\\mathbf{e}_x,\\mathbf{Q}(t)\\mathbf{e}_y,\\mathbf{Q}(t)\\mathbf{e}_z\\}$的瞬时随体坐标系中的分量。假设$\\omega$的单位是弧度/秒，$t$的单位是秒，并将三角函数参数解释为弧度。用$\\sigma_0$、$\\omega$和$t$符号化地表示您的最终答案，将$\\sigma_0$视为帕斯卡（Pa）。不需要数值代入，也不需要四舍五入。最终答案必须是单一的闭式解析表达式。",
            "solution": "该问题要求分析一个正在进行刚体旋转的组织段的两种次弹性本构模型。目标是证明非客观应力率在随体坐标系中引入了虚假的剪切应力，而客观（Jaumann）率则没有。我们必须推导出这个虚假剪切分量的解析表达式。\n\n首先，我们建立刚体旋转的运动学。速度场由$\\mathbf{v}(\\mathbf{x},t) = \\boldsymbol{\\omega} \\times \\mathbf{x}$给出，角速度矢量为$\\boldsymbol{\\omega} = \\omega\\,\\mathbf{e}_z$。位置矢量为$\\mathbf{x} = x_1\\mathbf{e}_x + x_2\\mathbf{e}_y + x_3\\mathbf{e}_z$。速度的分量为$v_1 = -\\omega x_2$，$v_2 = \\omega x_1$和$v_3 = 0$。\n\n空间速度梯度张量$\\mathbf{L}$的分量为$L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$。在实验室笛卡尔基$\\{\\mathbf{e}_x, \\mathbf{e}_y, \\mathbf{e}_z\\}$中，其矩阵表示为：\n$$ [L] = \\begin{pmatrix} 0  -\\omega  0 \\\\ \\omega  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n变形率张量$\\mathbf{D}$是$\\mathbf{L}$的对称部分：\n$$ [D] = \\frac{1}{2} ([L] + [L]^{\\top}) = \\frac{1}{2} \\left( \\begin{pmatrix} 0  -\\omega  0 \\\\ \\omega  0  0 \\\\ 0  0  0 \\end{pmatrix} + \\begin{pmatrix} 0  \\omega  0 \\\\ -\\omega  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right) = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n正如刚体运动所预期的那样，变形率为零，即$\\mathbf{D} = \\mathbf{0}$。\n\n自旋张量$\\mathbf{W}$是$\\mathbf{L}$的反对称部分：\n$$ [W] = \\frac{1}{2} ([L] - [L]^{\\top}) = \\frac{1}{2} \\left( \\begin{pmatrix} 0  -\\omega  0 \\\\ \\omega  0  0 \\\\ 0  0  0 \\end{pmatrix} - \\begin{pmatrix} 0  \\omega  0 \\\\ -\\omega  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right) = \\begin{pmatrix} 0  -\\omega  0 \\\\ \\omega  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n正交旋转张量$\\mathbf{Q}(t)$描述了物体的取向。它通过对$\\dot{\\mathbf{Q}}(t) = \\mathbf{W}\\mathbf{Q}(t)$在初始条件$\\mathbf{Q}(0)=\\mathbf{I}$下积分得到。解为$\\mathbf{Q}(t) = \\exp(\\mathbf{W}t)$。其矩阵表示是绕$z$轴旋转角度$\\theta(t) = \\omega t$的标准旋转矩阵：\n$$ [Q](t) = \\begin{pmatrix} \\cos(\\omega t)  -\\sin(\\omega t)  0 \\\\ \\sin(\\omega t)  \\cos(\\omega t)  0 \\\\ 0  0  1 \\end{pmatrix} $$\n随体坐标系的基矢量为$\\mathbf{g}_i(t) = \\mathbf{Q}(t)\\mathbf{e}_i$。\n\n现在，我们分析这两种本构模型。\n\n**1. 非客观次弹性公式**\n该模型直接使用物质时间导数：$\\dot{\\boldsymbol{\\sigma}} = \\mathbb{C} : \\mathbf{D}$。由于$\\mathbf{D}=\\mathbf{0}$，该模型预测$\\dot{\\boldsymbol{\\sigma}} = \\mathbf{0}$。对时间积分，固定实验室坐标系中的Cauchy应力张量$\\boldsymbol{\\sigma}(t)$是恒定的：$\\boldsymbol{\\sigma}(t) = \\boldsymbol{\\sigma}(0)$。\n初始应力给定为$\\boldsymbol{\\sigma}(0) = \\sigma_0\\,\\mathbf{e}_x \\otimes \\mathbf{e}_x$。在实验室坐标系中，其矩阵为：\n$$ [\\sigma](t) = [\\sigma](0) = \\begin{pmatrix} \\sigma_0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n为了求得随体坐标系中的应力，我们进行基变换。随体坐标系中的应力张量$\\boldsymbol{\\sigma}_B(t)$的分量由$[\\sigma_B](t) = [Q](t)^{\\top} [\\sigma](t) [Q](t)$给出。\n$$ [Q](t)^{\\top} = \\begin{pmatrix} \\cos(\\omega t)  \\sin(\\omega t)  0 \\\\ -\\sin(\\omega t)  \\cos(\\omega t)  0 \\\\ 0  0  1 \\end{pmatrix} $$\n执行矩阵乘法：\n$$ [\\sigma_B](t) = \\begin{pmatrix} \\cos(\\omega t)  \\sin(\\omega t)  0 \\\\ -\\sin(\\omega t)  \\cos(\\omega t)  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\sigma_0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} \\cos(\\omega t)  -\\sin(\\omega t)  0 \\\\ \\sin(\\omega t)  \\cos(\\omega t)  0 \\\\ 0  0  1 \\end{pmatrix} $$\n$$ [\\sigma_B](t) = \\begin{pmatrix} \\sigma_0 \\cos(\\omega t)  0  0 \\\\ -\\sigma_0 \\sin(\\omega t)  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} \\cos(\\omega t)  -\\sin(\\omega t)  0 \\\\ \\sin(\\omega t)  \\cos(\\omega t)  0 \\\\ 0  0  1 \\end{pmatrix} $$\n$$ [\\sigma_B](t) = \\begin{pmatrix} \\sigma_0 \\cos^2(\\omega t)  -\\sigma_0 \\cos(\\omega t)\\sin(\\omega t)  0 \\\\ -\\sigma_0 \\sin(\\omega t)\\cos(\\omega t)  \\sigma_0 \\sin^2(\\omega t)  0 \\\\ 0  0  0 \\end{pmatrix} $$\n使用恒等式$\\sin(2\\alpha) = 2\\sin(\\alpha)\\cos(\\alpha)$，非对角线剪切分量为：\n$$ \\sigma_{12}^{\\text{spurious}}(t) = \\sigma_{21}^{\\text{spurious}}(t) = -\\frac{\\sigma_0}{2} \\sin(2\\omega t) $$\n该模型错误地预测了仅由刚体旋转就会产生剪切应力。物理上，应力状态是沿材料的$\\mathbf{g}_1$轴的纯拉伸，应保持不变。$\\sigma_{12} \\neq 0$的出现是非客观公式产生的一个虚假的人为结果。\n\n**2. 客观（Jaumann）公式**\n该模型使用Jaumann率：$\\stackrel{\\triangle}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} - \\mathbf{W}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\mathbf{W}$。本构律为$\\stackrel{\\triangle}{\\boldsymbol{\\sigma}} = \\mathbb{C} : \\mathbf{D}$。由于$\\mathbf{D}=\\mathbf{0}$，我们有$\\stackrel{\\triangle}{\\boldsymbol{\\sigma}}=\\mathbf{0}$。\n我们来考察随体坐标系中应力张量的时间导数，$\\boldsymbol{\\sigma}_B(t) = \\mathbf{Q}(t)^{\\top} \\boldsymbol{\\sigma}(t) \\mathbf{Q}(t)$。\n$$ \\dot{\\boldsymbol{\\sigma}}_B = \\dot{\\mathbf{Q}}^{\\top}\\boldsymbol{\\sigma}\\mathbf{Q} + \\mathbf{Q}^{\\top}\\dot{\\boldsymbol{\\sigma}}\\mathbf{Q} + \\mathbf{Q}^{\\top}\\boldsymbol{\\sigma}\\dot{\\mathbf{Q}} $$\n使用$\\dot{\\mathbf{Q}} = \\mathbf{W}\\mathbf{Q}$和$\\dot{\\mathbf{Q}}^{\\top} = (\\mathbf{W}\\mathbf{Q})^{\\top} = \\mathbf{Q}^{\\top}\\mathbf{W}^{\\top} = -\\mathbf{Q}^{\\top}\\mathbf{W}$（因为$\\mathbf{W}$是反对称的），我们代入$\\dot{\\boldsymbol{\\sigma}}_B$的表达式中：\n$$ \\dot{\\boldsymbol{\\sigma}}_B = -\\mathbf{Q}^{\\top}\\mathbf{W}\\boldsymbol{\\sigma}\\mathbf{Q} + \\mathbf{Q}^{\\top}\\dot{\\boldsymbol{\\sigma}}\\mathbf{Q} + \\mathbf{Q}^{\\top}\\boldsymbol{\\sigma}\\mathbf{W}\\mathbf{Q} $$\n$$ \\dot{\\boldsymbol{\\sigma}}_B = \\mathbf{Q}^{\\top} (\\dot{\\boldsymbol{\\sigma}} - \\mathbf{W}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\mathbf{W}) \\mathbf{Q} = \\mathbf{Q}^{\\top} \\stackrel{\\triangle}{\\boldsymbol{\\sigma}} \\mathbf{Q} $$\n由于$\\stackrel{\\triangle}{\\boldsymbol{\\sigma}}=\\mathbf{0}$，我们发现$\\dot{\\boldsymbol{\\sigma}}_B = \\mathbf{0}$。这意味着在同转的随体坐标系中表示的应力张量是恒定的。\n$$ \\boldsymbol{\\sigma}_B(t) = \\boldsymbol{\\sigma}_B(0) $$\n在$t=0$时，$\\mathbf{Q}(0)=\\mathbf{I}$，所以随体坐标系与实验室坐标系重合。\n$$ \\boldsymbol{\\sigma}_B(0) = \\mathbf{Q}(0)^{\\top}\\boldsymbol{\\sigma}(0)\\mathbf{Q}(0) = \\mathbf{I}^{\\top}\\boldsymbol{\\sigma}(0)\\mathbf{I} = \\boldsymbol{\\sigma}(0) $$\n$\\boldsymbol{\\sigma}(0)$在实验室坐标系中的分量由其矩阵$[\\sigma](0)$给出。因此，$\\boldsymbol{\\sigma}_B(t)$在随体坐标系$\\{\\mathbf{g}_1(t), \\mathbf{g}_2(t), \\mathbf{g}_3(t)\\}$中的分量是恒定的，且与初始分量相同：\n$$ [\\sigma_B](t) = [\\sigma](0) = \\begin{pmatrix} \\sigma_0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n在这个公式中，剪切分量$\\sigma_{12}$和$\\sigma_{21}$始终为零。Jaumann率正确地预测了刚体旋转不会改变物体的内禀应力状态，从而满足了客观性原理，并消除了虚假的剪切应力。\n\n问题要求的是非客观公式产生的虚假剪切分量$\\sigma_{12}^{\\text{spurious}}(t)$的解析表达式。如上所述，其结果为$-\\frac{\\sigma_0}{2} \\sin(2\\omega t)$。",
            "answer": "$$\\boxed{-\\frac{\\sigma_0}{2}\\sin(2\\omega t)}$$"
        }
    ]
}