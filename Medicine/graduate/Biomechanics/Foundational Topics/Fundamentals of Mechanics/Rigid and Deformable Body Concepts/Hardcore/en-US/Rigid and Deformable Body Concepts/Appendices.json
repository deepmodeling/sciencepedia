{
    "hands_on_practices": [
        {
            "introduction": "In biomechanical analysis, we often treat bones and limb segments as rigid bodies to simplify the study of movement. This first practice provides a cornerstone technique for translating raw motion capture data into a precise mathematical description of rigid body motionâ€”a translation vector $\\mathbf{c}(t)$ and a rotation matrix $Q(t)$. By working through this exercise , you will connect experimental data with the theoretical principles of kinematics and see firsthand why the orthogonality constraint on the rotation matrix is the mathematical guarantee of an object's rigidity.",
            "id": "4202054",
            "problem": "Consider a rigid limb segment instrumented with markers whose fixed positions in the segment's local frame are denoted by $\\{\\mathbf{X}_i\\}_{i=1}^n$, and whose measured positions in the laboratory frame at time $t$ are denoted by $\\{\\mathbf{x}_i(t)\\}_{i=1}^n$. Assume a rigid motion model $\\mathbf{x}_i(t) = \\mathbf{c}(t) + Q(t) \\mathbf{X}_i + \\boldsymbol{\\varepsilon}_i(t)$, where $\\mathbf{c}(t) \\in \\mathbb{R}^3$ is the translation vector, $Q(t) \\in \\mathbb{R}^{3 \\times 3}$ is the rotation matrix satisfying the orthogonality constraint $Q(t)^\\top Q(t) = I$, and $\\boldsymbol{\\varepsilon}_i(t)$ represents measurement noise. Starting from the definition of a rigid body motion as an isometry that preserves pairwise distances, and standard least-squares principles, formulate the minimization of the objective \n$$\nJ(t) = \\sum_{i=1}^n \\left\\| \\mathbf{x}_i(t) - \\mathbf{c}(t) - Q(t) \\mathbf{X}_i \\right\\|_2^2\n$$\nwith the constraint $Q(t)^\\top Q(t) = I$, and derive a principled method to recover $\\mathbf{c}(t)$ and $Q(t)$ from measured data at each fixed time $t$. Explain the role of the orthogonality constraint $Q(t)^\\top Q(t) = I$ in the context of biomechanics and rigid motions, including its implications for distance preservation and the exclusion of non-rigid transformations such as shear and isotropic scaling. Discuss conditions under which the solution is unique and well-conditioned in terms of the marker configuration.\n\nYour program must implement the derived method and apply it to the following test suite of time-instants. In each test case, you are given reference markers $\\{\\mathbf{X}_i\\}$, a ground-truth rigid motion $(\\mathbf{c}(t), Q(t))$, and, where specified, a perturbation to simulate non-rigid effects or noise. For each case, compute the following four quantities:\n- The root-mean-square error \n$$\n\\mathrm{RMS}(t) = \\sqrt{\\frac{1}{n}\\sum_{i=1}^n \\left\\| \\mathbf{x}_i(t) - \\mathbf{c}^\\star(t) - Q^\\star(t) \\mathbf{X}_i \\right\\|_2^2}\n$$\nwhere $(\\mathbf{c}^\\star(t), Q^\\star(t))$ are the least-squares estimates; express $\\mathrm{RMS}(t)$ in meters, rounded to six decimal places.\n- The orthogonality error \n$$\ne_{\\mathrm{orth}}(t) = \\left\\| Q^\\star(t)^\\top Q^\\star(t) - I \\right\\|_F\n$$\nwhere $\\|\\cdot\\|_F$ denotes the Frobenius norm; express $e_{\\mathrm{orth}}(t)$ as a unitless float, rounded to six decimal places.\n- The determinant $\\det\\!\\left(Q^\\star(t)\\right)$; express $\\det\\!\\left(Q^\\star(t)\\right)$ as a unitless float, rounded to six decimal places.\n- The conditioning ratio \n$$\n\\rho(t) = \\frac{\\sigma_{\\min}}{\\sigma_{\\max}}\n$$\nwhere $\\sigma_{\\min}$ and $\\sigma_{\\max}$ are the smallest and largest singular values of the $3 \\times 3$ cross-covariance matrix constructed from the centered marker sets at time $t$; express $\\rho(t)$ as a unitless float, rounded to six decimal places. A value of $\\rho(t)$ close to $0$ indicates an ill-conditioned geometry (e.g., collinearity or coplanarity in a way that undermines rotational identifiability).\n\nTest suite specification:\n- Case $1$ (happy path, noise-free, non-degenerate):\n  - Reference markers in meters:\n    $$\n    \\mathbf{X}_1 = \\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix},\\quad\n    \\mathbf{X}_2 = \\begin{bmatrix}0.10\\\\0\\\\0.05\\end{bmatrix},\\quad\n    \\mathbf{X}_3 = \\begin{bmatrix}0\\\\0.20\\\\0\\end{bmatrix},\\quad\n    \\mathbf{X}_4 = \\begin{bmatrix}0.05\\\\0.10\\\\0.15\\end{bmatrix},\\quad\n    \\mathbf{X}_5 = \\begin{bmatrix}-0.07\\\\0.08\\\\-0.02\\end{bmatrix}.\n    $$\n  - Rotation is the composition $Q(t) = R_z(\\theta_z) R_x(\\theta_x)$ with angles in radians $\\theta_z = 0.5$, $\\theta_x = 0.2$, where $R_z(\\theta)$ and $R_x(\\theta)$ denote canonical rotations about the $z$- and $x$-axes, respectively.\n  - Translation $\\mathbf{c}(t) = \\begin{bmatrix}0.02\\\\-0.01\\\\0.03\\end{bmatrix}$ meters.\n  - Measured markers $\\mathbf{x}_i(t)$ are generated exactly by $\\mathbf{x}_i(t) = \\mathbf{c}(t) + Q(t) \\mathbf{X}_i$ (no noise).\n- Case $2$ (noisy measurements, non-degenerate):\n  - Same $\\{\\mathbf{X}_i\\}$, $Q(t)$, and $\\mathbf{c}(t)$ as in Case $1$.\n  - Measured markers $\\mathbf{x}_i(t)$ are generated by $\\mathbf{x}_i(t) = \\mathbf{c}(t) + Q(t) \\mathbf{X}_i + \\boldsymbol{\\eta}_i$, where $\\boldsymbol{\\eta}_i \\sim \\mathcal{N}(0, \\sigma^2 I)$ with $\\sigma = 0.001$ meters independently for each marker and coordinate.\n- Case $3$ (degenerate geometry: collinear markers):\n  - Reference markers in meters:\n    $$\n    \\mathbf{X}_1 = \\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix},\\quad\n    \\mathbf{X}_2 = \\begin{bmatrix}0.10\\\\0\\\\0\\end{bmatrix},\\quad\n    \\mathbf{X}_3 = \\begin{bmatrix}0.20\\\\0\\\\0\\end{bmatrix},\\quad\n    \\mathbf{X}_4 = \\begin{bmatrix}0.30\\\\0\\\\0\\end{bmatrix}.\n    $$\n  - Rotation $Q(t) = R_x(\\theta_x)$ with $\\theta_x = 0.7$ radians.\n  - Translation $\\mathbf{c}(t) = \\begin{bmatrix}-0.03\\\\0.02\\\\0.01\\end{bmatrix}$ meters.\n  - Measured markers $\\mathbf{x}_i(t)$ are generated exactly by $\\mathbf{x}_i(t) = \\mathbf{c}(t) + Q(t) \\mathbf{X}_i$ (no noise).\n- Case $4$ (isotropic scale mismatch illustrating the constraint's role):\n  - Reference markers identical to Case $1$.\n  - Rotation and translation identical to Case $1$.\n  - A scale factor $s = 1.02$ is applied in the measurement model: $\\mathbf{x}_i(t) = \\mathbf{c}(t) + Q(t) \\left( s \\mathbf{X}_i \\right)$ (no noise). The estimation still enforces $Q(t)^\\top Q(t) = I$ and does not allow scaling.\n\nYour program must:\n1. Implement a method that computes $(\\mathbf{c}^\\star(t), Q^\\star(t))$ by minimizing the objective $J(t)$ subject to $Q(t)^\\top Q(t) = I$, using a mathematically justified approach based on fundamental principles.\n2. For each test case, compute $\\mathrm{RMS}(t)$, $e_{\\mathrm{orth}}(t)$, $\\det\\!\\left(Q^\\star(t)\\right)$, and $\\rho(t)$, in that order, rounding each to six decimal places as specified.\n3. Produce a single line of output containing a list of the four-element lists for the four test cases, in the exact format\n$$\n\\text{[}[r_1,e_1,d_1,\\rho_1],[r_2,e_2,d_2,\\rho_2],[r_3,e_3,d_3,\\rho_3],[r_4,e_4,d_4,\\rho_4]\\text{]}\n$$\nwhere each $r_k$ is in meters and the others are unitless floats, all rounded to six decimal places, and the entries are comma-separated with no additional text.",
            "solution": "The provided problem is a classic and fundamental task in biomechanics and computer vision: the estimation of rigid body motion from a set of corresponding points. This is formally known as the orthogonal Procrustes problem. We are tasked with deriving the solution, explaining its theoretical underpinnings, and implementing it.\n\nThe problem is to find the translation vector $\\mathbf{c}(t) \\in \\mathbb{R}^3$ and the rotation matrix $Q(t) \\in SO(3)$ that minimize the sum of squared errors between a set of measured marker positions $\\{\\mathbf{x}_i(t)\\}_{i=1}^n$ and their transformed reference positions $\\{\\mathbf{X}_i\\}_{i=1}^n$. The objective function to be minimized is:\n$$\nJ(t) = \\sum_{i=1}^n \\left\\| \\mathbf{x}_i(t) - \\mathbf{c}(t) - Q(t) \\mathbf{X}_i \\right\\|_2^2\n$$\nsubject to the constraint that $Q(t)$ is a rotation matrix, which implies orthogonality $Q(t)^\\top Q(t) = I$ and proper orientation $\\det(Q(t)) = +1$.\n\nFor notational simplicity, we will drop the explicit time-dependence $(t)$ in the derivation, as the procedure is identical for each fixed time instant.\n\n**Step 1: Derivation of the Optimal Translation $\\mathbf{c}$**\n\nThe objective function $J$ is a quadratic function of $\\mathbf{c}$. We can find the optimal translation $\\mathbf{c}^\\star$ by taking the gradient of $J$ with respect to $\\mathbf{c}$ and setting it to zero.\n$$\n\\frac{\\partial J}{\\partial \\mathbf{c}} = \\sum_{i=1}^n \\frac{\\partial}{\\partial \\mathbf{c}} \\left( \\mathbf{x}_i - \\mathbf{c} - Q \\mathbf{X}_i \\right)^\\top \\left( \\mathbf{x}_i - \\mathbf{c} - Q \\mathbf{X}_i \\right)\n$$\n$$\n\\frac{\\partial J}{\\partial \\mathbf{c}} = \\sum_{i=1}^n 2 \\left( \\mathbf{x}_i - \\mathbf{c} - Q \\mathbf{X}_i \\right) (-1) = -2 \\sum_{i=1}^n \\left( \\mathbf{x}_i - \\mathbf{c} - Q \\mathbf{X}_i \\right)\n$$\nSetting the gradient to zero:\n$$\n\\sum_{i=1}^n \\left( \\mathbf{x}_i - \\mathbf{c}^\\star - Q \\mathbf{X}_i \\right) = 0\n$$\n$$\n\\sum_{i=1}^n \\mathbf{x}_i - \\sum_{i=1}^n \\mathbf{c}^\\star - \\sum_{i=1}^n Q \\mathbf{X}_i = 0\n$$\n$$\n\\sum_{i=1}^n \\mathbf{x}_i - n \\mathbf{c}^\\star - Q \\sum_{i=1}^n \\mathbf{X}_i = 0\n$$\nSolving for $\\mathbf{c}^\\star$:\n$$\nn \\mathbf{c}^\\star = \\sum_{i=1}^n \\mathbf{x}_i - Q \\sum_{i=1}^n \\mathbf{X}_i\n$$\n$$\n\\mathbf{c}^\\star = \\frac{1}{n} \\sum_{i=1}^n \\mathbf{x}_i - Q \\left( \\frac{1}{n} \\sum_{i=1}^n \\mathbf{X}_i \\right)\n$$\nLet us define the centroids (mean positions) of the marker sets:\n$$\n\\bar{\\mathbf{x}} = \\frac{1}{n} \\sum_{i=1}^n \\mathbf{x}_i \\quad \\text{and} \\quad \\bar{\\mathbf{X}} = \\frac{1}{n} \\sum_{i=1}^n \\mathbf{X}_i\n$$\nThe optimal translation is then given by:\n$$\n\\mathbf{c}^\\star = \\bar{\\mathbf{x}} - Q \\bar{\\mathbf{X}}\n$$\nThis elegant result shows that the optimal translation aligns the centroid of the rotated reference markers with the centroid of the measured markers.\n\n**Step 2: Derivation of the Optimal Rotation $Q$**\n\nWe substitute the expression for $\\mathbf{c}^\\star$ back into the objective function $J$. This decouples the optimization problem for $Q$ from $\\mathbf{c}$.\nThe vector inside the norm becomes:\n$$\n\\mathbf{x}_i - \\mathbf{c}^\\star - Q \\mathbf{X}_i = \\mathbf{x}_i - (\\bar{\\mathbf{x}} - Q\\bar{\\mathbf{X}}) - Q \\mathbf{X}_i = (\\mathbf{x}_i - \\bar{\\mathbf{x}}) - Q(\\mathbf{X}_i - \\bar{\\mathbf{X}})\n$$\nLet's define the centered marker coordinates:\n$$\n\\mathbf{x}'_i = \\mathbf{x}_i - \\bar{\\mathbf{x}} \\quad \\text{and} \\quad \\mathbf{X}'_i = \\mathbf{X}_i - \\bar{\\mathbf{X}}\n$$\nThe objective function simplifies to finding the rotation $Q$ that minimizes:\n$$\nJ(Q) = \\sum_{i=1}^n \\| \\mathbf{x}'_i - Q \\mathbf{X}'_i \\|_2^2\n$$\nWe expand the squared norm:\n$$\n\\| \\mathbf{x}'_i - Q \\mathbf{X}'_i \\|^2 = (\\mathbf{x}'_i - Q \\mathbf{X}'_i)^\\top (\\mathbf{x}'_i - Q \\mathbf{X}'_i) = {\\mathbf{x}'_i}^\\top \\mathbf{x}'_i - {\\mathbf{x}'_i}^\\top Q \\mathbf{X}'_i - (Q \\mathbf{X}'_i)^\\top \\mathbf{x}'_i + (Q \\mathbf{X}'_i)^\\top (Q \\mathbf{X}'_i)\n$$\nUsing the orthogonality constraint $Q^\\top Q = I$:\n$$\n\\| \\mathbf{x}'_i - Q \\mathbf{X}'_i \\|^2 = \\|\\mathbf{x}'_i\\|^2 - 2 {\\mathbf{x}'_i}^\\top Q \\mathbf{X}'_i + {\\mathbf{X}'_i}^\\top Q^\\top Q \\mathbf{X}'_i = \\|\\mathbf{x}'_i\\|^2 - 2 {\\mathbf{x}'_i}^\\top Q \\mathbf{X}'_i + \\|\\mathbf{X}'_i\\|^2\n$$\nSumming over all markers, the objective function is:\n$$\nJ(Q) = \\sum_{i=1}^n (\\|\\mathbf{x}'_i\\|^2 + \\|\\mathbf{X}'_i\\|^2) - 2 \\sum_{i=1}^n {\\mathbf{x}'_i}^\\top Q \\mathbf{X}'_i\n$$\nThe terms $\\sum \\|\\mathbf{x}'_i\\|^2$ and $\\sum \\|\\mathbf{X}'_i\\|^2$ are constant with respect to $Q$. Therefore, minimizing $J(Q)$ is equivalent to maximizing the term $\\sum_{i=1}^n {\\mathbf{x}'_i}^\\top Q \\mathbf{X}'_i$.\n\nUsing the cyclic property of the trace operator, we can rewrite the expression to be maximized:\n$$ \\sum_{i=1}^n {\\mathbf{x}'_i}^\\top Q \\mathbf{X}'_i = \\sum_{i=1}^n \\text{tr}({\\mathbf{x}'_i}^\\top Q \\mathbf{X}'_i) = \\sum_{i=1}^n \\text{tr}(Q \\mathbf{X}'_i {\\mathbf{x}'_i}^\\top) = \\text{tr}\\left( Q \\left( \\sum_{i=1}^n \\mathbf{X}'_i {\\mathbf{x}'_i}^\\top \\right) \\right) $$\nLet us define the $3 \\times 3$ cross-covariance matrix $H$ as:\n$$\nH = \\sum_{i=1}^n \\mathbf{X}'_i {\\mathbf{x}'_i}^\\top\n$$\nThe problem is now to find the rotation matrix $Q$ that maximizes $\\text{tr}(Q H)$. This is a known result from matrix theory. The solution is obtained via the Singular Value Decomposition (SVD) of $H$. Let the SVD of $H$ be:\n$$\nH = U \\Sigma V^\\top\n$$\nwhere $U, V \\in \\mathbb{R}^{3 \\times 3}$ are orthogonal matrices and $\\Sigma$ is a diagonal matrix of non-negative singular values $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3 \\ge 0$.\nThe trace to be maximized is $\\text{tr}(Q H) = \\text{tr}(Q U \\Sigma V^\\top)$. Let $Z = V^\\top Q U$. Since $U, Q, V$ are orthogonal, $Z$ is also orthogonal. Then $Q = V Z U^\\top$. Substituting this into the trace expression:\n$$ \\text{tr}( (V Z U^\\top) U \\Sigma V^\\top ) = \\text{tr}(V Z \\Sigma V^\\top) = \\text{tr}(Z \\Sigma V^\\top V) = \\text{tr}(Z \\Sigma) $$\nWe need to maximize $\\text{tr}(Z \\Sigma) = \\sum_{j=1}^3 Z_{jj} \\sigma_j$ subject to $Z$ being orthogonal. Since $\\sigma_j \\ge 0$ and $|Z_{jj}| \\le 1$, the maximum value is $\\sum \\sigma_j$, which is achieved when $Z = I$, the identity matrix.\nIf $Z=I$, then $V^\\top Q U = I$, which gives the optimal orthogonal matrix as:\n$$\nQ^\\star = V U^\\top\n$$\n\n**Step 3: Enforcing the Proper Rotation Constraint ($\\det(Q) = +1$)**\n\nThe constraint $Q^\\top Q=I$ allows for both rotations ($\\det(Q)=+1$) and reflections ($\\det(Q)=-1$). A physical rigid body motion cannot be a reflection. We must enforce $\\det(Q)=+1$.\nThe determinant of our solution is $\\det(Q^\\star) = \\det(V U^\\top) = \\det(V)\\det(U)$. This product can be $-1$. This occurs if the optimal orthogonal transformation is a reflection, which can happen with noisy data.\nIf $\\det(Q^\\star)=-1$, we must find the rotation matrix that is closest to this reflection. This is achieved by finding an orthogonal matrix $Z$ with $\\det(Z)=-1$ that maximizes $\\text{tr}(Z \\Sigma) = Z_{11}\\sigma_1 + Z_{22}\\sigma_2 + Z_{33}\\sigma_3$. Since $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3 \\ge 0$, the maximum under this determinant constraint is achieved by $Z = \\text{diag}(1, 1, -1)$, giving a trace of $\\sigma_1 + \\sigma_2 - \\sigma_3$.\nTherefore, if $\\det(V U^\\top) = -1$, the optimal rotation is:\n$$\nQ^\\star = V \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & -1 \\end{pmatrix} U^\\top\n$$\nThis can be written compactly for both cases as $Q^\\star = V S U^\\top$ where $S = \\text{diag}(1, 1, \\det(V U^\\top))$.\n\n**The Role of the Orthogonality Constraint $Q^\\top Q=I$**\n\nIn biomechanics, limb segments are often modeled as rigid bodies. A rigid body is defined as a system of particles where the distance between any two particles remains constant over time. A transformation describing the motion of such a body must preserve these distances; such a transformation is called an isometry.\nThe orthogonality constraint $Q^\\top Q=I$ is the mathematical expression of this physical principle. For any vector $\\mathbf{v}$, the length is preserved under an orthogonal transformation: $\\|Q\\mathbf{v}\\|^2 = (Q\\mathbf{v})^\\top(Q\\mathbf{v}) = \\mathbf{v}^\\top Q^\\top Q \\mathbf{v} = \\mathbf{v}^\\top I \\mathbf{v} = \\mathbf{v}^\\top \\mathbf{v} = \\|\\mathbf{v}\\|^2$.\nConsequently, the distance between any two points $\\mathbf{X}_i$ and $\\mathbf{X}_j$ is preserved:\n$$\n\\|Q \\mathbf{X}_i - Q \\mathbf{X}_j\\|^2 = \\|Q(\\mathbf{X}_i - \\mathbf{X}_j)\\|^2 = \\|\\mathbf{X}_i - \\mathbf{X}_j\\|^2\n$$\nTransformations that do not satisfy this constraint are non-rigid. For example:\n- **Shear**: A transformation matrix like $S = \\begin{pmatrix} 1 & k \\\\ 0 & 1 \\end{pmatrix}$ has $S^\\top S \\neq I$ and does not preserve angles or distances, deforming the body.\n- **Isotropic Scaling**: A transformation $T=sI$ with $s \\neq \\pm 1$ has $T^\\top T = s^2 I \\neq I$. It changes all distances by a factor of $|s|$.\nThe algorithm's strict enforcement of $Q^\\top Q=I$ ensures that any estimated motion is physically consistent with the rigid body model, explicitly excluding non-rigid deformations like shear or scaling from the solution. Case $4$ of the test suite demonstrates this: even when the input data contains scaling, the algorithm finds the best-fit *rotation*, quantifying the scaling as residual error.\n\n**Conditions for a Unique and Well-Conditioned Solution**\n\nThe uniqueness of the solution for $Q$ depends on the properties of the cross-covariance matrix $H$. The solution $Q^\\star = VU^\\top$ is unique if the SVD is unique in the relevant sense. This relates to the singular values of $H$. The singular values of $H$ are the square roots of the eigenvalues of $H H^\\top$.\n$H H^\\top = (\\sum \\mathbf{X}'_i {\\mathbf{x}'_i}^\\top)(\\sum {\\mathbf{x}_j' {\\mathbf{X}_j'}^\\top}) \\approx (\\sum \\mathbf{X}'_i (Q \\mathbf{X}'_i)^\\top)(\\sum Q \\mathbf{X}'_j {\\mathbf{X}_j'}^\\top) = ((\\sum \\mathbf{X}'_i {\\mathbf{X}'_i}^\\top)Q^\\top)(Q(\\sum \\mathbf{X}'_j {\\mathbf{X}_j'}^\\top)) = A^2$, where $A=\\sum \\mathbf{X}'_i {\\mathbf{X}'_i}^\\top$ is the covariance matrix of the centered reference markers.\nThe rank of $H$ is determined by the rank of $A$, which in turn depends on the geometric configuration of the reference markers $\\{\\mathbf{X}_i\\}$.\n- **Rank $1$ (Collinear Markers)**: If the markers lie on a line, the vectors $\\{\\mathbf{X}'_i\\}$ span a $1$-dimensional space. $A$ has rank $1$, and $H$ also has rank $1$. Two singular values of $H$ are zero ($\\sigma_2 = \\sigma_3 = 0$). The rotation is ambiguous; any rotation around the axis defined by the markers is undetectable. The solution is not unique.\n- **Rank $2$ (Coplanar, Non-collinear Markers)**: If the markers lie on a plane, the vectors $\\{\\mathbf{X}'_i\\}$ span a $2$-dimensional space. $A$ has rank $2$, and $H$ has rank $2$. The smallest singular value is zero ($\\sigma_3 = 0$). The rotation component about the normal to the plane is ambiguous.\n- **Rank $3$ (Non-coplanar Markers)**: This requires at least 4 markers. The vectors $\\{\\mathbf{X}'_i\\}$ span a $3$-dimensional space. $A$ and $H$ are full rank, and all singular values are positive. If all singular values are distinct ($\\sigma_1 > \\sigma_2 > \\sigma_3 > 0$), the SVD is unique (up to signs of columns of $U,V$), and the rotation $Q$ is uniquely determined.\n\nThe **conditioning** of the problem is described by the ratio of the singular values of $H$. The conditioning ratio $\\rho(t) = \\sigma_{\\min} / \\sigma_{\\max} = \\sigma_3 / \\sigma_1$ indicates how close the marker geometry is to being degenerate. A value of $\\rho(t)$ close to $0$ implies that the problem is ill-conditioned: the geometry is nearly collinear or coplanar, and the solution for $Q$ will be highly sensitive to measurement noise. A robust marker configuration maximizes this ratio, meaning the markers are spread out in $3$D space.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the test cases and print the final result.\n    \"\"\"\n\n    def get_rotation_matrices(theta_z=None, theta_x=None):\n        \"\"\"Helper to create canonical rotation matrices.\"\"\"\n        Q = np.identity(3)\n        if theta_z is not None:\n            cz, sz = np.cos(theta_z), np.sin(theta_z)\n            Rz = np.array([[cz, -sz, 0], [sz, cz, 0], [0, 0, 1]])\n            Q = Rz @ Q\n        if theta_x is not None:\n            cx, sx = np.cos(theta_x), np.sin(theta_x)\n            Rx = np.array([[1, 0, 0], [0, cx, -sx], [0, sx, cx]])\n            Q = Q @ Rx\n        return Q\n\n    def solve_procrustes(X, x):\n        \"\"\"\n        Solves the orthogonal Procrustes problem to find the optimal rigid\n        transformation (c, Q) between two corresponding point sets X and x.\n\n        Args:\n            X (np.ndarray): n x 3 array of reference marker positions.\n            x (np.ndarray): n x 3 array of measured marker positions.\n\n        Returns:\n            tuple: A tuple containing the four required metrics:\n                   (RMS error, orthogonality error, determinant, conditioning ratio).\n        \"\"\"\n        n, dim = X.shape\n        if n < 3:\n            raise ValueError(\"At least 3 markers are required.\")\n\n        # Step 1: Compute centroids and centered coordinates\n        X_bar = np.mean(X, axis=0)\n        x_bar = np.mean(x, axis=0)\n        X_prime = X - X_bar\n        x_prime = x - x_bar\n\n        # Step 2: Compute the cross-covariance matrix H\n        H = X_prime.T @ x_prime\n\n        # Step 3: Compute SVD of H\n        U, s, Vt = np.linalg.svd(H)\n\n        # Step 4: Compute the optimal rotation matrix Q\n        Q_star = Vt.T @ U.T\n\n        # Step 5: Correct for reflections\n        if np.linalg.det(Q_star) < 0:\n            Vt_corr = Vt.copy()\n            Vt_corr[-1, :] *= -1\n            Q_star = Vt_corr.T @ U.T\n\n        # Step 6: Compute the optimal translation\n        c_star = x_bar - Q_star @ X_bar\n\n        # --- Compute Output Metrics ---\n\n        # 1. RMS error\n        sum_sq_err = 0.0\n        for i in range(n):\n            x_est_i = c_star + Q_star @ X[i]\n            error_i = x[i] - x_est_i\n            sum_sq_err += np.dot(error_i, error_i)\n        rms_error = np.sqrt(sum_sq_err / n)\n\n        # 2. Orthogonality error\n        I = np.identity(dim)\n        ortho_error = np.linalg.norm(Q_star.T @ Q_star - I, 'fro')\n\n        # 3. Determinant\n        det_Q = np.linalg.det(Q_star)\n\n        # 4. Conditioning ratio\n        # s is sorted in descending order. Condition ratio is min/max.\n        if s[0] < 1e-12: # Check for division by zero if all singular values are zero\n            cond_ratio = 0.0\n        else:\n            cond_ratio = s[-1] / s[0]\n\n        return rms_error, ortho_error, det_Q, cond_ratio\n\n\n    # --- Test Suite ---\n    all_results = []\n    rng = np.random.default_rng(42) # For reproducible noise\n\n    # Case 1: Happy path, noise-free, non-degenerate\n    X1 = np.array([\n        [0.0, 0.0, 0.0], [0.10, 0.0, 0.05], [0.0, 0.20, 0.0],\n        [0.05, 0.10, 0.15], [-0.07, 0.08, -0.02]\n    ])\n    Q1 = get_rotation_matrices(theta_z=0.5, theta_x=0.2)\n    c1 = np.array([0.02, -0.01, 0.03])\n    x1 = (Q1 @ X1.T).T + c1\n    all_results.append(solve_procrustes(X1, x1))\n\n    # Case 2: Noisy measurements, non-degenerate\n    X2, Q2, c2 = X1, Q1, c1\n    sigma_noise = 0.001\n    noise = rng.normal(0, sigma_noise, size=X2.shape)\n    x2 = (Q2 @ X2.T).T + c2 + noise\n    all_results.append(solve_procrustes(X2, x2))\n\n    # Case 3: Degenerate geometry (collinear markers)\n    X3 = np.array([\n        [0.0, 0.0, 0.0], [0.10, 0.0, 0.0], [0.20, 0.0, 0.0], [0.30, 0.0, 0.0]\n    ])\n    Q3 = get_rotation_matrices(theta_x=0.7)\n    c3 = np.array([-0.03, 0.02, 0.01])\n    x3 = (Q3 @ X3.T).T + c3\n    all_results.append(solve_procrustes(X3, x3))\n\n    # Case 4: Isotropic scale mismatch\n    X4, Q4, c4 = X1, Q1, c1\n    scale_factor = 1.02\n    x4 = (Q4 @ (scale_factor * X4).T).T + c4\n    all_results.append(solve_procrustes(X4, x4))\n    \n    # Format the final output string\n    formatted_results = [f\"[{','.join(f'{val:.6f}' for val in res)}]\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While the rigid body model is a powerful approximation, biological tissues are fundamentally deformable, and understanding their mechanical behavior is crucial for modeling injury and disease. This next practice  delves into the mechanics of soft tissue by modeling its response to uniaxial tension, a common experimental scenario. Starting from first principles, you will derive the nonlinear stress-stretch relationship for an incompressible, hyperelastic material, a task that solidifies the connection between macroscopic deformation, internal stress, and constitutive laws.",
            "id": "4202041",
            "problem": "A soft tissue specimen is modeled as an incompressible, isotropic, hyperelastic solid undergoing uniaxial tension along the first principal axis. The deformation gradient is uniform and diagonal, given by $F=\\mathrm{diag}(\\lambda,\\lambda_{t},\\lambda_{t})$, where $\\lambda>0$ is the applied axial stretch and $\\lambda_{t}>0$ is the unknown lateral stretch due to the incompressibility constraint. The lateral faces are traction-free. The strain-energy density is specified by a one-term Ogden model\n$$\nW(\\lambda_{1},\\lambda_{2},\\lambda_{3})=\\frac{\\mu}{\\alpha}\\left(\\lambda_{1}^{\\alpha}+\\lambda_{2}^{\\alpha}+\\lambda_{3}^{\\alpha}-3\\right),\n$$\nwith $\\mu>0$ the infinitesimal shear modulus and $\\alpha>1$ a given dimensionless material parameter. Assume no body forces and enforce incompressibility via a Lagrange multiplier.\n\nStarting only from fundamental definitions in continuum mechanics (the deformation gradient $F$, the Jacobian $J=\\det F$, linear momentum balance in the absence of body forces, and the hyperelastic constitutive relation with a Lagrange multiplier enforcing incompressibility), derive:\n\n1) The lateral stretch $\\lambda_{t}$ as a function of $\\lambda$ using the incompressibility constraint.\n\n2) The principal Cauchy stress components in terms of $\\lambda$, $\\lambda_{t}$, and the material parameters, and determine the Lagrange multiplier by imposing traction-free boundary conditions on the lateral faces.\n\n3) A closed-form expression for the nondimensional axial Cauchy stress $\\sigma_{11}/\\mu$ as a function of $\\lambda$ and $\\alpha$.\n\nProvide your final answer as a single closed-form analytic expression for $\\sigma_{11}/\\mu$ in terms of $\\lambda$ and $\\alpha$. You do not need to express any units in your final expression, since the requested quantity is nondimensional.",
            "solution": "This problem requires the derivation of the stress-stretch relationship for an incompressible Ogden material under uniaxial tension.\n\n### Derivation of the Solution\n\nThe solution procedure will follow the three steps requested in the problem statement.\n\n**1) Derivation of the lateral stretch $\\lambda_t$**\n\nThe material is specified as incompressible. This kinematic constraint is expressed mathematically by requiring that the determinant of the deformation gradient, known as the Jacobian $J$, must be equal to $1$.\n$$J = \\det(F) = 1$$\nThe deformation gradient $F$ is given as a diagonal matrix:\n$$F = \\begin{pmatrix} \\lambda & 0 & 0 \\\\ 0 & \\lambda_t & 0 \\\\ 0 & 0 & \\lambda_t \\end{pmatrix}$$\nThe determinant of a diagonal matrix is the product of its diagonal elements.\n$$J = \\lambda \\cdot \\lambda_t \\cdot \\lambda_t = \\lambda \\lambda_t^2$$\nEnforcing the incompressibility constraint $J=1$:\n$$\\lambda \\lambda_t^2 = 1$$\nSolving for the lateral stretch $\\lambda_t$ as a function of the axial stretch $\\lambda$:\n$$\\lambda_t^2 = \\frac{1}{\\lambda} = \\lambda^{-1}$$\nSince stretches must be positive ($\\lambda_t > 0$), we take the positive square root:\n$$\\lambda_t = (\\lambda^{-1})^{1/2} = \\lambda^{-1/2}$$\n\n**2) Derivation of the principal Cauchy stresses and determination of the Lagrange multiplier**\n\nFor an isotropic, incompressible hyperelastic material, the principal components of the Cauchy stress tensor, $\\sigma_i$, are related to the principal stretches, $\\lambda_i$, and the strain-energy density function, $W$, by the constitutive relation:\n$$\\sigma_i = -p + \\lambda_i \\frac{\\partial W}{\\partial \\lambda_i}$$\nwhere $p$ is the arbitrary hydrostatic pressure (Lagrange multiplier) that enforces the incompressibility constraint. The principal stretches are the diagonal components of the given deformation gradient $F$: $\\lambda_1 = \\lambda$, $\\lambda_2 = \\lambda_t$, and $\\lambda_3 = \\lambda_t$.\n\nThe strain-energy density function is given by the Ogden model:\n$$W(\\lambda_1, \\lambda_2, \\lambda_3) = \\frac{\\mu}{\\alpha} \\left( \\lambda_1^{\\alpha} + \\lambda_2^{\\alpha} + \\lambda_3^{\\alpha} - 3 \\right)$$\nWe first compute the partial derivatives of $W$ with respect to each principal stretch:\n$$\\frac{\\partial W}{\\partial \\lambda_1} = \\frac{\\mu}{\\alpha} (\\alpha \\lambda_1^{\\alpha-1}) = \\mu \\lambda_1^{\\alpha-1}$$\n$$\\frac{\\partial W}{\\partial \\lambda_2} = \\frac{\\mu}{\\alpha} (\\alpha \\lambda_2^{\\alpha-1}) = \\mu \\lambda_2^{\\alpha-1}$$\n$$\\frac{\\partial W}{\\partial \\lambda_3} = \\frac{\\mu}{\\alpha} (\\alpha \\lambda_3^{\\alpha-1}) = \\mu \\lambda_3^{\\alpha-1}$$\nNow, we substitute these derivatives into the expression for the principal Cauchy stresses:\n$$\\sigma_1 = -p + \\lambda_1 (\\mu \\lambda_1^{\\alpha-1}) = -p + \\mu \\lambda_1^{\\alpha}$$\n$$\\sigma_2 = -p + \\lambda_2 (\\mu \\lambda_2^{\\alpha-1}) = -p + \\mu \\lambda_2^{\\alpha}$$\n$$\\sigma_3 = -p + \\lambda_3 (\\mu \\lambda_3^{\\alpha-1}) = -p + \\mu \\lambda_3^{\\alpha}$$\nThe principal directions align with the coordinate axes, so the Cauchy stress tensor $\\sigma$ is diagonal with components $\\sigma_{11} = \\sigma_1$, $\\sigma_{22} = \\sigma_2$, and $\\sigma_{33} = \\sigma_3$. Substituting the principal stretches $\\lambda_1 = \\lambda$, $\\lambda_2 = \\lambda_t$, and $\\lambda_3 = \\lambda_t$:\n$$\\sigma_{11} = -p + \\mu \\lambda^{\\alpha}$$\n$$\\sigma_{22} = -p + \\mu \\lambda_t^{\\alpha}$$\n$$\\sigma_{33} = -p + \\mu \\lambda_t^{\\alpha}$$\nThe problem states that the lateral faces are traction-free. For a uniaxial test along the first axis, the lateral faces are those with normals in the second and third directions. A traction-free condition on these faces means that the stress components normal to these faces are zero.\n$$\\sigma_{22} = 0 \\quad \\text{and} \\quad \\sigma_{33} = 0$$\nUsing the condition $\\sigma_{22}=0$ (which also satisfies $\\sigma_{33}=0$):\n$$0 = -p + \\mu \\lambda_t^{\\alpha}$$\nWe can now solve for the Lagrange multiplier $p$:\n$$p = \\mu \\lambda_t^{\\alpha}$$\nSubstituting the expression for $\\lambda_t$ from part 1, $\\lambda_t = \\lambda^{-1/2}$:\n$$p = \\mu (\\lambda^{-1/2})^{\\alpha} = \\mu \\lambda^{-\\alpha/2}$$\nThis determines the Lagrange multiplier in terms of the applied stretch $\\lambda$ and the material parameters.\n\n**3) Derivation of the nondimensional axial Cauchy stress**\n\nThe final step is to find a closed-form expression for the nondimensional axial Cauchy stress, $\\sigma_{11}/\\mu$. The axial stress component is $\\sigma_{11}$:\n$$\\sigma_{11} = -p + \\mu \\lambda^{\\alpha}$$\nSubstitute the expression for $p$ derived in the previous step:\n$$\\sigma_{11} = -(\\mu \\lambda^{-\\alpha/2}) + \\mu \\lambda^{\\alpha}$$\nFactoring out the shear modulus $\\mu$:\n$$\\sigma_{11} = \\mu (\\lambda^{\\alpha} - \\lambda^{-\\alpha/2})$$\nTo obtain the nondimensional axial stress, we divide by $\\mu$:\n$$\\frac{\\sigma_{11}}{\\mu} = \\lambda^{\\alpha} - \\lambda^{-\\alpha/2}$$\nThis is the final closed-form expression for the nondimensional axial Cauchy stress as a function of the axial stretch $\\lambda$ and the material parameter $\\alpha$.",
            "answer": "$$\\boxed{\\lambda^{\\alpha} - \\lambda^{-\\frac{\\alpha}{2}}}$$"
        },
        {
            "introduction": "A central challenge in continuum mechanics is describing the behavior of a deformable body that is also undergoing large-scale rigid motion, such as a rotating ligament. This final practice explores the critical and subtle principle of material frame-indifference, or objectivity . By analyzing a prestressed body in pure rotation, you will demonstrate how a naive constitutive model generates physically incorrect, \"spurious\" shear stresses and appreciate why objective stress rates are essential for formulating valid mechanical models.",
            "id": "4202062",
            "problem": "A homogeneous, incompressible tissue segment in a biomechanical manipulator is subjected to a rigid-body rotation about the $z$-axis with constant angular velocity $\\omega$. The velocity field is $\\mathbf{v}(\\mathbf{x},t) = \\boldsymbol{\\omega} \\times \\mathbf{x}$ with $\\boldsymbol{\\omega} = \\omega\\,\\mathbf{e}_z$, so that the spatial velocity gradient $L = \\nabla \\mathbf{v}$ decomposes into the symmetric rate-of-deformation tensor $D = \\tfrac{1}{2}(L + L^{\\top})$ and the skew-symmetric spin tensor $W = \\tfrac{1}{2}(L - L^{\\top})$. The tissue carries a uniform initial Cauchy stress at $t=0$ given in the laboratory frame by $\\sigma(0) = \\sigma_0\\,\\mathbf{e}_x \\otimes \\mathbf{e}_x$, where $\\sigma_0$ represents a uniaxial prestress magnitude arising from residual tensions. Let $Q(t)$ be the orthogonal rotation tensor describing the rigid rotation of the body, with $Q(0)=\\mathbf{I}$ and $\\dot{Q}(t) = WQ(t)$.\n\nConsider two constitutive formulations for stress evolution:\n1. A non-objective hypoelastic rate using the material time derivative, $\\dot{\\sigma} = \\mathbb{C} : D$, where $\\mathbb{C}$ is a fourth-order elastic modulus tensor. Under rigid-body rotation, $D=\\mathbf{0}$, so this law predicts $\\dot{\\sigma}=\\mathbf{0}$ in the laboratory frame.\n2. An objective corotational rate, specifically the Jaumann rate, $\\stackrel{\\triangle}{\\sigma} = \\dot{\\sigma} - W\\sigma + \\sigma W$, coupled to the same elastic response $\\stackrel{\\triangle}{\\sigma} = \\mathbb{C} : D$. Under rigid-body rotation, this gives $\\stackrel{\\triangle}{\\sigma}=\\mathbf{0}$ and hence $\\dot{\\sigma} = W\\sigma - \\sigma W$.\n\nUsing only fundamental kinematics and the above model forms, demonstrate that the non-objective formulation produces spurious shear stress when the stress is expressed in the body-attached frame defined by $Q(t)$, and that the Jaumann-rate formulation removes this effect. In particular, derive the analytical expression for the artificial shear component $\\sigma_{12}^{\\text{spurious}}(t)$ predicted by the non-objective formulation, where indices $1,2$ denote components in the instantaneous body-attached frame with basis $\\{\\mathbf{Q}(t)\\mathbf{e}_x,\\mathbf{Q}(t)\\mathbf{e}_y,\\mathbf{Q}(t)\\mathbf{e}_z\\}$. Assume $\\omega$ is in radians per second and $t$ is in seconds, and interpret trigonometric arguments in radians. Express your final answer symbolically in terms of $\\sigma_0$, $\\omega$, and $t$, treating $\\sigma_0$ in Pascals (Pa). No numerical substitution is required, and no rounding is necessary. The final answer must be a single closed-form analytic expression.",
            "solution": "The problem requires an analysis of two hypoelastic constitutive models for a tissue segment undergoing rigid-body rotation. The goal is to demonstrate that a non-objective stress rate introduces spurious shear stresses in a body-attached frame, while an objective (Jaumann) rate does not. We must derive the analytical expression for this spurious shear component.\n\nFirst, we establish the kinematics of the rigid-body rotation. The velocity field is given by $\\mathbf{v}(\\mathbf{x},t) = \\boldsymbol{\\omega} \\times \\mathbf{x}$, with the angular velocity vector $\\boldsymbol{\\omega} = \\omega\\,\\mathbf{e}_z$. The position vector is $\\mathbf{x} = x_1\\mathbf{e}_x + x_2\\mathbf{e}_y + x_3\\mathbf{e}_z$. The components of the velocity are $v_1 = -\\omega x_2$, $v_2 = \\omega x_1$, and $v_3 = 0$.\n\nThe spatial velocity gradient tensor $L$ has components $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$. In the laboratory Cartesian basis $\\{\\mathbf{e}_x, \\mathbf{e}_y, \\mathbf{e}_z\\}$, its matrix representation is:\n$$ [L] = \\begin{pmatrix} 0 & -\\omega & 0 \\\\ \\omega & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\nThe rate-of-deformation tensor $D$ is the symmetric part of $L$:\n$$ [D] = \\frac{1}{2} ([L] + [L]^{\\top}) = \\frac{1}{2} \\left( \\begin{pmatrix} 0 & -\\omega & 0 \\\\ \\omega & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & \\omega & 0 \\\\ -\\omega & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right) = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\nAs expected for a rigid motion, the rate-of-deformation is zero, i.e., $D = \\mathbf{0}$.\n\nThe spin tensor $W$ is the skew-symmetric part of $L$:\n$$ [W] = \\frac{1}{2} ([L] - [L]^{\\top}) = \\frac{1}{2} \\left( \\begin{pmatrix} 0 & -\\omega & 0 \\\\ \\omega & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} - \\begin{pmatrix} 0 & \\omega & 0 \\\\ -\\omega & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right) = \\begin{pmatrix} 0 & -\\omega & 0 \\\\ \\omega & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\nThe orthogonal rotation tensor $Q(t)$ describes the orientation of the body. It is found by integrating $\\dot{Q}(t) = WQ(t)$ with the initial condition $Q(0)=\\mathbf{I}$. The solution is $Q(t) = \\exp(Wt)$. The matrix representation is the standard rotation matrix for a rotation by an angle $\\theta(t) = \\omega t$ about the $z$-axis:\n$$ [Q](t) = \\begin{pmatrix} \\cos(\\omega t) & -\\sin(\\omega t) & 0 \\\\ \\sin(\\omega t) & \\cos(\\omega t) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\nThe body-attached frame has basis vectors $\\mathbf{g}_i(t) = Q(t)\\mathbf{e}_i$.\n\nNow, we analyze the two constitutive models.\n\n**1. Non-Objective Hypoelastic Formulation**\nThis model uses the material time derivative directly: $\\dot{\\sigma} = \\mathbb{C} : D$. Since $D=\\mathbf{0}$, this model predicts $\\dot{\\sigma} = \\mathbf{0}$. Integrating with respect to time, the Cauchy stress tensor $\\sigma(t)$ in the fixed laboratory frame is constant: $\\sigma(t) = \\sigma(0)$.\nThe initial stress is given as $\\sigma(0) = \\sigma_0\\,\\mathbf{e}_x \\otimes \\mathbf{e}_x$. In the laboratory frame, its matrix is:\n$$ [\\sigma](t) = [\\sigma](0) = \\begin{pmatrix} \\sigma_0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\nTo find the stress in the body-attached frame, we perform a basis transformation. The stress tensor in the body frame, $\\sigma_B(t)$, has components given by $[\\sigma_B](t) = [Q](t)^{\\top} [\\sigma](t) [Q](t)$.\n$$ [Q](t)^{\\top} = \\begin{pmatrix} \\cos(\\omega t) & \\sin(\\omega t) & 0 \\\\ -\\sin(\\omega t) & \\cos(\\omega t) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\nPerforming the matrix multiplication:\n$$ [\\sigma_B](t) = \\begin{pmatrix} \\cos(\\omega t) & \\sin(\\omega t) & 0 \\\\ -\\sin(\\omega t) & \\cos(\\omega t) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\sigma_0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} \\cos(\\omega t) & -\\sin(\\omega t) & 0 \\\\ \\sin(\\omega t) & \\cos(\\omega t) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\n$$ [\\sigma_B](t) = \\begin{pmatrix} \\sigma_0 \\cos(\\omega t) & 0 & 0 \\\\ -\\sigma_0 \\sin(\\omega t) & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} \\cos(\\omega t) & -\\sin(\\omega t) & 0 \\\\ \\sin(\\omega t) & \\cos(\\omega t) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\n$$ [\\sigma_B](t) = \\begin{pmatrix} \\sigma_0 \\cos^2(\\omega t) & -\\sigma_0 \\cos(\\omega t)\\sin(\\omega t) & 0 \\\\ -\\sigma_0 \\sin(\\omega t)\\cos(\\omega t) & \\sigma_0 \\sin^2(\\omega t) & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\nUsing the identity $\\sin(2\\alpha) = 2\\sin(\\alpha)\\cos(\\alpha)$, the off-diagonal shear components are:\n$$ \\sigma_{12}^{\\text{spurious}}(t) = \\sigma_{21}^{\\text{spurious}}(t) = -\\frac{\\sigma_0}{2} \\sin(2\\omega t) $$\nThis model incorrectly predicts the generation of shear stress solely due to a rigid rotation. Physically, the stress state, which is a pure tension along the material's $\\mathbf{g}_1$ axis, should remain so. The appearance of $\\sigma_{12} \\neq 0$ is a spurious artifact of the non-objective formulation.\n\n**2. Objective (Jaumann) Formulation**\nThis model uses the Jaumann rate: $\\stackrel{\\triangle}{\\sigma} = \\dot{\\sigma} - W\\sigma + \\sigma W$. The constitutive law is $\\stackrel{\\triangle}{\\sigma} = \\mathbb{C} : D$. With $D=\\mathbf{0}$, we have $\\stackrel{\\triangle}{\\sigma}=\\mathbf{0}$.\nLet us examine the time derivative of the stress tensor in the body-attached frame, $\\sigma_B(t) = Q(t)^{\\top} \\sigma(t) Q(t)$.\n$$ \\dot{\\sigma}_B = \\dot{Q}^{\\top}\\sigma Q + Q^{\\top}\\dot{\\sigma}Q + Q^{\\top}\\sigma\\dot{Q} $$\nUsing $\\dot{Q} = WQ$ and $\\dot{Q}^{\\top} = (WQ)^{\\top} = Q^{\\top}W^{\\top} = -Q^{\\top}W$ (since $W$ is skew-symmetric), we substitute into the expression for $\\dot{\\sigma}_B$:\n$$ \\dot{\\sigma}_B = -Q^{\\top}W\\sigma Q + Q^{\\top}\\dot{\\sigma}Q + Q^{\\top}\\sigma WQ $$\n$$ \\dot{\\sigma}_B = Q^{\\top} (\\dot{\\sigma} - W\\sigma + \\sigma W) Q = Q^{\\top} \\stackrel{\\triangle}{\\sigma} Q $$\nSince $\\stackrel{\\triangle}{\\sigma}=\\mathbf{0}$, we find that $\\dot{\\sigma}_B = \\mathbf{0}$. This means the stress tensor expressed in the corotating body-attached frame is constant.\n$$ \\sigma_B(t) = \\sigma_B(0) $$\nAt $t=0$, $Q(0)=\\mathbf{I}$, so the body frame coincides with the lab frame.\n$$ \\sigma_B(0) = Q(0)^{\\top}\\sigma(0)Q(0) = \\mathbf{I}^{\\top}\\sigma(0)\\mathbf{I} = \\sigma(0) $$\nThe components of $\\sigma(0)$ in the lab frame are given by its matrix $[\\sigma](0)$. Therefore, the components of $\\sigma_B(t)$ in the body frame $\\{\\mathbf{g}_1(t), \\mathbf{g}_2(t), \\mathbf{g}_3(t)\\}$ are constant and identical to the initial components:\n$$ [\\sigma_B](t) = [\\sigma](0) = \\begin{pmatrix} \\sigma_0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\nIn this formulation, the shear components $\\sigma_{12}$ and $\\sigma_{21}$ are always zero. The Jaumann rate correctly predicts that a rigid rotation does not alter the intrinsic stress state of the body, thus satisfying the principle of material frame-indifference and removing the spurious shear stress.\n\nThe problem asks for the analytical expression for the spurious shear component $\\sigma_{12}^{\\text{spurious}}(t)$ from the non-objective formulation. As derived above, this is $-\\frac{\\sigma_0}{2} \\sin(2\\omega t)$.",
            "answer": "$$\n\\boxed{-\\frac{\\sigma_0}{2}\\sin(2\\omega t)}\n$$"
        }
    ]
}