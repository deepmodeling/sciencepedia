{
    "hands_on_practices": [
        {
            "introduction": "在建立生物力学模型时，一个核心参数是肢体节段的转动惯量。虽然我们通常可以方便地查到或计算出节段绕其质心的转动惯量 $I_C$，但在实际运动分析中，我们更关心的是肢体绕关节（例如膝关节或肩关节）旋转的惯性。本练习将指导你从第一性原理出发，推导并应用平行轴定理，这是一个将转动惯量从质心轴转换到任意平行轴的基本工具。掌握这个转换对于准确模拟和分析人体运动至关重要。",
            "id": "4208918",
            "problem": "考虑在深蹲姿势下，对一个被建模为刚体的人类足部节段进行矢状面分析，其中，足部的质心(COM)与膝关节屈曲轴的垂直距离为 $d=0.12\\ \\text{m}$。该足部节段的质量为 $m_{f}=1.10\\ \\text{kg}$，其绕过质心且平行于膝关节屈曲轴的转动惯量为 $I_{C}=3.20\\times 10^{-3}\\ \\text{kg}\\cdot\\text{m}^{2}$。仅使用刚体的角动量、力矩和转动惯量的基本定义，推导出足部节段绕膝关节屈曲轴的转动惯量表达式（用 $I_{C}$、$m_{f}$ 和 $d$ 表示），然后根据给定数据进行数值计算。最终的转动惯量以 $\\text{kg}\\cdot\\text{m}^{2}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "该问题陈述具有科学依据、提法明确、客观，并为应用于生物力学的经典力学标准问题提供了一套完整且一致的数据。所有给定值在物理上都是现实的。该问题要求从基本原理推导一个已知的物理定理，这是一项有效且具有指导意义的任务。因此，该问题是有效的，我们将提供解答。\n\n目标是求出足部节段绕膝关节屈曲轴的转动惯量 $I_K$。题目要求我们使用基本定义，推导 $I_K$ 与绕足部质心的转动惯量 $I_C$ 之间的关系表达式。转动惯量 $I$ 是衡量物体对角加速度抵抗能力的物理量。对于绕固定轴转动的刚体，在转动动能 $K_{rot} = \\frac{1}{2}I\\omega^2$、角动量 $L=I\\omega$ 和力矩 $\\tau=I\\alpha$ 的关系式中，它是比例常数，其中 $\\omega$ 是角速度，$\\alpha$ 是角加速度。我们将使用能量原理来推导所需的关系。\n\n设膝关节屈曲轴为一个固定转动轴，我们将其指定为轴 $K$。足部节段是一个绕该轴以角速度 $\\omega$ 转动的刚体。足部节段的动能由下式给出：\n$$\nK = \\frac{1}{2}I_K \\omega^2\n$$\n其中 $I_K$ 是我们希望确定的绕膝关节屈曲轴的转动惯量。\n\n根据柯尼希定理（也称为动能的平行轴定理），刚体的总动能可以表示为其质心(COM)的平动动能与绕过其质心的轴的转动动能之和。\n$$\nK = K_{trans, COM} + K_{rot, COM}\n$$\n质心的平动动能由下式给出：\n$$\nK_{trans, COM} = \\frac{1}{2}m_f v_C^2\n$$\n其中 $m_f$ 是足部节段的质量，$v_C$ 是其质心的线速度。由于足部节段绕膝关节轴转动，其质心绕该轴以半径 $d$ 做圆周运动。质心的线速度与角速度 $\\omega$ 的关系为 $v_C = d\\omega$。将此代入平动动能的表达式，得到：\n$$\nK_{trans, COM} = \\frac{1}{2}m_f (d\\omega)^2 = \\frac{1}{2}m_f d^2 \\omega^2\n$$\n足部节段绕过其质心且与膝关节屈曲轴平行的轴的转动动能由下式给出：\n$$\nK_{rot, COM} = \\frac{1}{2}I_C \\omega^2\n$$\n其中 $I_C$ 是绕质心且平行于膝关节屈曲轴的转动惯量。对于平面运动中的刚体，绕质心转动的角速度 $\\omega$ 与绕膝关节轴转动的角速度相同。\n\n将这两个能量分量相加，得到总动能：\n$$\nK = \\frac{1}{2}m_f d^2 \\omega^2 + \\frac{1}{2}I_C \\omega^2\n$$\n提取公因式，我们得到：\n$$\nK = \\frac{1}{2}(I_C + m_f d^2)\\omega^2\n$$\n通过令总动能 $K$ 的两个表达式相等，我们有：\n$$\n\\frac{1}{2}I_K \\omega^2 = \\frac{1}{2}(I_C + m_f d^2)\\omega^2\n$$\n两边同除以 $\\frac{1}{2}\\omega^2$ (假设 $\\omega \\neq 0$)，得到绕膝关节轴的转动惯量的推导表达式，即平行轴定理：\n$$\nI_K = I_C + m_f d^2\n$$\n该表达式将绕膝关节轴的转动惯量 $I_K$ 与绕过质心的平行轴的转动惯量 $I_C$、节段质量 $m_f$ 以及两轴之间的垂直距离 $d$ 联系起来。\n\n现在，我们使用给定数据对该表达式进行数值计算：\n- 绕质心的转动惯量：$I_C = 3.20 \\times 10^{-3}\\ \\text{kg}\\cdot\\text{m}^{2}$\n- 足部节段的质量：$m_f = 1.10\\ \\text{kg}$\n- 质心到膝关节轴的垂直距离：$d = 0.12\\ \\text{m}$\n\n将这些值代入推导出的公式中：\n$$\nI_K = (3.20 \\times 10^{-3}) + (1.10) \\times (0.12)^2\n$$\n首先，计算 $m_f d^2$ 项：\n$$\nm_f d^2 = 1.10\\ \\text{kg} \\times (0.12\\ \\text{m})^2 = 1.10\\ \\text{kg} \\times 0.0144\\ \\text{m}^2 = 0.01584\\ \\text{kg}\\cdot\\text{m}^{2}\n$$\n现在，将其与 $I_C$ 相加：\n$$\nI_K = 0.00320\\ \\text{kg}\\cdot\\text{m}^{2} + 0.01584\\ \\text{kg}\\cdot\\text{m}^{2} = 0.01904\\ \\text{kg}\\cdot\\text{m}^{2}\n$$\n问题要求最终答案保留四位有效数字。计算值 $0.01904$ 已经有四位有效数字（数字 $1, 9, 0, 4$）。\n\n因此，足部节段绕膝关节屈曲轴的转动惯量为 $0.01904\\ \\text{kg}\\cdot\\text{m}^{2}$。",
            "answer": "$$\n\\boxed{0.01904}\n$$"
        },
        {
            "introduction": "虽然二维分析可以简化问题，但我们的大多数运动，如投掷、挥拍或转身，本质上都是三维的。要准确描述三维刚体旋转，我们必须使用欧拉动力学方程。这个练习将带你进入三维旋转的世界，计算在一个给定的角速度和角加速度下，肩关节所需的净力矩。通过这个计算，你将深入理解在旋转坐标系中产生的陀螺力矩项 ($\\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega})$)，这是理解复杂三维运动动力学的关键。",
            "id": "4208924",
            "problem": "一个关于盂肱 (GH) 关节的上臂（肱骨）简化生物力学模型将肱骨和一个手持器械视为一个单一刚体，其主轴与解剖轴对齐：前后轴（$x$）、上下轴（$y$）和长轴内外旋轴（$z$）。绕 GH 关节的惯性张量，在此主轴坐标系中表示，为常数且等于 $\\mathbf{I}=\\mathrm{diag}(0.8,\\,0.6,\\,0.5)\\ \\mathrm{kg\\ m}^{2}$。在某一特定时刻，该节段的角速度为 $\\boldsymbol{\\omega}=(0,\\,5,\\,0)\\ \\mathrm{rad/s}$，一个运动程序试图施加一个角加速度 $\\dot{\\boldsymbol{\\omega}}=(0,\\,0,\\,10)\\ \\mathrm{rad/s}^{2}$，所有这些量都在同一主轴坐标系中表示。忽略重力和任何外部接触力矩，因此净肩部力矩等于该节段绕 GH 关节的角动量对时间的变化率。\n\n仅使用刚体绕定点转动的角动量基本平衡定律以及刚体运动学，推导所需净肩部力矩矢量 $\\boldsymbol{\\tau}$ 的控制表达式，并根据上述数据计算其值。将弧度作为角度单位。用牛顿·米表示最终的力矩矢量。提供精确值，不要四舍五入。将最终答案表示为 $1\\times 3$ 的行向量。",
            "solution": "首先验证问题，以确保其具有科学依据、提法恰当且客观。\n\n### 第1步：提取已知条件\n- **参考坐标系**：一个附着于刚体（肱骨加器械）的主轴坐标系，坐标轴分别表示为 $x$（前后）、$y$（上下）和 $z$（长轴）。\n- **惯性张量**：在主轴坐标系中表示，$\\mathbf{I}=\\mathrm{diag}(I_{xx}, I_{yy}, I_{zz})$，其中 $I_{xx} = 0.8\\ \\mathrm{kg\\ m}^{2}$，$I_{yy} = 0.6\\ \\mathrm{kg\\ m}^{2}$，$I_{zz} = 0.5\\ \\mathrm{kg\\ m}^{2}$。\n- **角速度**：在主轴坐标系中表示，$\\boldsymbol{\\omega} = (\\omega_x, \\omega_y, \\omega_z) = (0, 5, 0)\\ \\mathrm{rad/s}$。\n- **角加速度**：在主轴坐标系中表示，$\\dot{\\boldsymbol{\\omega}} = (\\dot{\\omega}_x, \\dot{\\omega}_y, \\dot{\\omega}_z) = (0, 0, 10)\\ \\mathrm{rad/s}^{2}$。\n- **假设**：盂肱 (GH) 关节是一个定点。忽略重力和外部接触力矩。\n- **控制原理**：净肩部力矩 $\\boldsymbol{\\tau}$ 等于节段绕 GH 关节的角动量 $\\mathbf{L}$ 对时间的变化率。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于刚体运动的欧拉方程，这是经典力学的基石。将这些原理应用于生物力学是标准且有效的。对于人体肢体动力学的简化模型，这些数值是合理的。\n- **适定性**：问题提供了所有必要的数据（惯性张量、角速度、角加速度），以唯一确定所需的力矩矢量。\n- **客观性**：问题使用精确的、定量的语言陈述，没有歧义或主观论断。\n\n### 第3步：结论与行动\n问题是有效的。它是刚体动力学基本原理的直接应用。将提供完整的解。\n\n### 解题推导\n控制刚体绕定点转动动力学的基本原理是，在惯性参考系中测量的净外力矩 $\\boldsymbol{\\tau}$ 等于角动量 $\\mathbf{L}$ 对时间的变化率。\n$$\n\\boldsymbol{\\tau} = \\frac{d\\mathbf{L}}{dt}\n$$\n问题在固连于刚体的主轴坐标系（一个非惯性旋转坐标系）中给出了矢量和惯性张量。为了计算惯性系中角动量矢量 $\\mathbf{L}$ 的时间导数，我们必须使用输运定理，该定理将惯性（固定）坐标系中的导数与旋转坐标系中的导数联系起来：\n$$\n\\frac{d\\mathbf{L}}{dt} = \\left(\\frac{d\\mathbf{L}}{dt}\\right)_{\\text{body}} + \\boldsymbol{\\omega} \\times \\mathbf{L}\n$$\n此处，$\\boldsymbol{\\omega}$ 是刚体坐标系相对于惯性坐标系的角速度。\n\n在刚体坐标系中的角动量矢量 $\\mathbf{L}$ 由惯性张量 $\\mathbf{I}$ 和角速度矢量 $\\boldsymbol{\\omega}$ 的乘积给出：\n$$\n\\mathbf{L} = \\mathbf{I}\\boldsymbol{\\omega}\n$$\n将此代入 $\\boldsymbol{\\tau}$ 的输运方程：\n$$\n\\boldsymbol{\\tau} = \\left(\\frac{d(\\mathbf{I}\\boldsymbol{\\omega})}{dt}\\right)_{\\text{body}} + \\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega})\n$$\n由于惯性张量 $\\mathbf{I}$ 在固连于刚体的坐标系中是恒定的，它在此坐标系中的时间导数为零。因此，第一项简化为：\n$$\n\\left(\\frac{d(\\mathbf{I}\\boldsymbol{\\omega})}{dt}\\right)_{\\text{body}} = \\mathbf{I}\\left(\\frac{d\\boldsymbol{\\omega}}{dt}\\right)_{\\text{body}} + \\left(\\frac{d\\mathbf{I}}{dt}\\right)_{\\text{body}}\\boldsymbol{\\omega} = \\mathbf{I}\\dot{\\boldsymbol{\\omega}} + \\mathbf{0}\n$$\n其中 $\\dot{\\boldsymbol{\\omega}}$ 是刚体坐标系中的角加速度，这在问题中已给出。力矩的完整表达式，即著名的欧拉运动方程，为：\n$$\n\\boldsymbol{\\tau} = \\mathbf{I}\\dot{\\boldsymbol{\\omega}} + \\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega})\n$$\n我们现在将使用给定值分别计算每一项。\n\n惯性张量为 $\\mathbf{I} = \\begin{pmatrix} 0.8 & 0 & 0 \\\\ 0 & 0.6 & 0 \\\\ 0 & 0 & 0.5 \\end{pmatrix} \\ \\mathrm{kg\\ m^2}$。\n角速度为 $\\boldsymbol{\\omega} = \\begin{pmatrix} 0 \\\\ 5 \\\\ 0 \\end{pmatrix} \\ \\mathrm{rad/s}$。\n角加速度为 $\\dot{\\boldsymbol{\\omega}} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 10 \\end{pmatrix} \\ \\mathrm{rad/s^2}$。\n\n首先，我们计算 $\\mathbf{I}\\dot{\\boldsymbol{\\omega}}$ 项：\n$$\n\\mathbf{I}\\dot{\\boldsymbol{\\omega}} = \\begin{pmatrix} 0.8 & 0 & 0 \\\\ 0 & 0.6 & 0 \\\\ 0 & 0 & 0.5 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 10 \\end{pmatrix} = \\begin{pmatrix} (0.8)(0) \\\\ (0.6)(0) \\\\ (0.5)(10) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 5 \\end{pmatrix} \\ \\mathrm{N\\ m}\n$$\n接下来，我们计算陀螺力矩项 $\\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega})$。首先，求出 $\\mathbf{L} = \\mathbf{I}\\boldsymbol{\\omega}$：\n$$\n\\mathbf{L} = \\mathbf{I}\\boldsymbol{\\omega} = \\begin{pmatrix} 0.8 & 0 & 0 \\\\ 0 & 0.6 & 0 \\\\ 0 & 0 & 0.5 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 5 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (0.8)(0) \\\\ (0.6)(5) \\\\ (0.5)(0) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix} \\ \\mathrm{kg\\ m^2/s}\n$$\n现在，计算叉积 $\\boldsymbol{\\omega} \\times \\mathbf{L}$：\n$$\n\\boldsymbol{\\omega} \\times \\mathbf{L} = \\begin{pmatrix} 0 \\\\ 5 \\\\ 0 \\end{pmatrix} \\times \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix} = \\begin{vmatrix} \\mathbf{\\hat{i}} & \\mathbf{\\hat{j}} & \\mathbf{\\hat{k}} \\\\ 0 & 5 & 0 \\\\ 0 & 3 & 0 \\end{vmatrix}\n$$\n$$\n= \\mathbf{\\hat{i}}((5)(0) - (0)(3)) - \\mathbf{\\hat{j}}((0)(0) - (0)(0)) + \\mathbf{\\hat{k}}((0)(3) - (5)(0)) = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\ \\mathrm{N\\ m}\n$$\n陀螺项为零。这是一个特殊情况，因为角速度矢量 $\\boldsymbol{\\omega}$ 与刚体的一个主轴对齐。\n\n最后，总力矩 $\\boldsymbol{\\tau}$ 是这两项之和：\n$$\n\\boldsymbol{\\tau} = \\mathbf{I}\\dot{\\boldsymbol{\\omega}} + \\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega}) = \\begin{pmatrix} 0 \\\\ 0 \\\\ 5 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 5 \\end{pmatrix} \\ \\mathrm{N\\ m}\n$$\n所需的净肩部力矩矢量为 $\\boldsymbol{\\tau} = (0,\\, 0,\\, 5)\\ \\mathrm{N\\ m}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 & 5 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理解运动背后的力矩和力只是分析的第一步；生物力学家同样关心运动的能量学后果。关节是产生、吸收和传递机械能的关键部位。本练习将带你从动力学（力矩和角速度）过渡到能量学，通过处理模拟的实验数据来计算关节的瞬时功率和做的功。这是一个现代生物力学研究中的核心任务，它能帮助我们量化肌肉的向心做功（能量产生）和离心做功（能量吸收），从而更深入地评估运动表现和效率。",
            "id": "4208946",
            "problem": "一个下肢模型专注于水平行走过程中支撑后期和蹬伸阶段的踝关节。给定踝关节的关节力矩采样时间序列，记为 $\\tau(t)$，单位为牛顿米 (N·m)，以及绕同一轴线的关节角速度，记为 $\\omega(t)$，单位为弧度/秒 (rad/s)。采样间隔是恒定的，记为 $\\Delta t$，单位为秒 (s)。目标是根据第一性原理计算跨踝关节的瞬时机械能传递速率（机械功率），然后进行积分，以获得在该速率分别为正或负的阶段内产生和吸收的总能量。您还必须为每个测试案例确定一个分类整数，以表明在分析窗口内踝关节是净产生还是净吸收机械能。所有角度和角速度都必须以弧度处理。\n\n使用的基本原理：\n- 关于关节的机械功的定义是关节力矩沿角位移的线积分。\n- 机械功率是做机械功的时间速率。\n\n离散时间计算要求：\n- 使用采样间隔 $\\Delta t$，通过给定采样序列上的黎曼和来近似任何需要的时间积分。\n\n每个测试案例要计算的输出定义：\n- 令瞬时机械功率样本为 $\\{P(t_i)\\}$，由提供的 $\\tau(t_i)$ 和 $\\omega(t_i)$ 计算得出。\n- 计算 $\\{P(t_i)\\}$ 的最大值 $P_{\\max}$ 和最小值 $P_{\\min}$，以瓦特 (W) 为单位。\n- 计算总正功 $W^{+} = \\sum_{i: P(t_i) > 0} P(t_i)\\,\\Delta t$ 和总负功 $W^{-} = \\sum_{i: P(t_i) < 0} P(t_i)\\,\\Delta t$，以焦耳 (J) 为单位。请注意，当能量被吸收时，$W^{-}$ 将为负值。\n- 通过首先计算净功 $W_{\\text{net}} = W^{+} + W^{-}$ 并与容差 $\\varepsilon$ 进行比较来定义分类整数 $C$。使用 $\\varepsilon = 10^{-9}$ (J)。如果 $W_{\\text{net}} > \\varepsilon$，则设置 $C = +1$；如果 $W_{\\text{net}} < -\\varepsilon$，则设置 $C = -1$；否则设置 $C = 0$。\n\n测试套件规范：\n对于每个案例，构建时间向量 $t_i = i\\,\\Delta t$，其中 $i = 0, 1, \\dots, N-1$，$N$ 是由总时长 $T$ 和采样间隔 $\\Delta t$ 决定的样本数量。\n\n- 案例 A（具有后续吸收阶段的代表性蹬伸）：\n  - 采样间隔 $\\Delta t = 0.001$ (s)，总时长 $T = 0.600$ (s)。\n  - 关节力矩 $\\tau(t)$：\n    - 对于 $t \\in [0.120, 0.370]$，$\\tau(t)$ 是一个持续时间为 $0.250$ (s)、幅度为 $110$ (N·m) 的半正弦脉冲。\n    - 对于 $t \\in [0.370, 0.500]$，增加一个 $25$ (N·m) 的恒定力矩偏移量。\n    - 在其他情况下，$\\tau(t) = 0$ (N·m)。\n  - 关节角速度 $\\omega(t)$：\n    - 对于 $t \\in [0.120, 0.370]$，$\\omega(t)$ 是一个持续时间为 $0.250$ (s)、幅度为 $7$ (rad/s) 的半正弦脉冲。\n    - 对于 $t \\in [0.370, 0.500]$，$\\omega(t)$ 是一个持续时间为 $0.130$ (s)、幅度为 $3$ (rad/s) 的负半正弦脉冲。\n    - 在其他情况下，$\\omega(t) = 0$ (rad/s)。\n\n- 案例 B（具有净吸收的协同收缩）：\n  - 采样间隔 $\\Delta t = 0.001$ (s)，总时长 $T = 0.400$ (s)。\n  - 关节力矩 $\\tau(t)$：\n    - 对于 $t \\in [0.100, 0.350]$，$\\tau(t) = 80$ (N·m)。\n    - 在其他情况下，$\\tau(t) = 0$ (N·m)。\n  - 关节角速度 $\\omega(t)$：\n    - 对于 $t \\in [0.150, 0.350]$，$\\omega(t) = -6$ (rad/s)。\n    - 在其他情况下，$\\omega(t) = 0$ (rad/s)。\n\n- 案例 C（角速度为零的边界情况）：\n  - 采样间隔 $\\Delta t = 0.001$ (s)，总时长 $T = 0.300$ (s)。\n  - 关节力矩 $\\tau(t)$：\n    - 对于 $t \\in [0.050, 0.250]$，$\\tau(t)$ 是一个持续时间为 $0.200$ (s)、幅度为 $100$ (N·m) 的半正弦脉冲。\n    - 在其他情况下，$\\tau(t) = 0$ (N·m)。\n  - 关节角速度 $\\omega(t)$：\n    - 对于所有 $t$，$\\omega(t) = 0$ (rad/s)。\n\n- 案例 D（在正角速度阶段力矩符号反转）：\n  - 采样间隔 $\\Delta t = 0.001$ (s)，总时长 $T = 0.500$ (s)。\n  - 关节力矩 $\\tau(t)$：\n    - 对于 $t \\in [0.100, 0.250]$，$\\tau(t)$ 是一个持续时间为 $0.150$ (s)、幅度为 $100$ (N·m) 的半正弦脉冲。\n    - 对于 $t \\in [0.250, 0.400]$，$\\tau(t)$ 是一个持续时间为 $0.150$ (s)、幅度为 $90$ (N·m) 的负半正弦脉冲。\n    - 在其他情况下，$\\tau(t) = 0$ (N·m)。\n  - 关节角速度 $\\omega(t)$：\n    - 对于 $t \\in [0.100, 0.400]$，$\\omega(t)$ 是一个持续时间为 $0.300$ (s)、幅度为 $7$ (rad/s) 的半正弦脉冲。\n    - 在其他情况下，$\\omega(t) = 0$ (rad/s)。\n\n半正弦脉冲的实现细节：\n- 在 $[t_0, t_0 + D]$ 上幅度为 $A$ 的半正弦脉冲逐点定义为 $A \\sin\\!\\left(\\pi \\frac{t - t_0}{D}\\right)$（对于 $t \\in [t_0, t_0 + D]$），在其他情况下为 $0$。幅度为 $A$ 的负半正弦脉冲在相同区间上为 $-A \\sin\\!\\left(\\pi \\frac{t - t_0}{D}\\right)$。\n\n要求的输出和格式：\n- 对于每个测试案例，计算并返回列表 $[P_{\\max}, P_{\\min}, W^{+}, W^{-}, C]$。\n- 将 $P_{\\max}$ 和 $P_{\\min}$ 以瓦特 (W) 表示，将 $W^{+}$ 和 $W^{-}$ 以焦耳 (J) 表示。\n- 将所有浮点输出四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含四个测试案例的结果，格式为方括号内由逗号分隔的列表的列表，例如 $[[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$。",
            "solution": "问题陈述已经过严格验证，被认为是科学可靠、定义明确且内部一致的，可以进行严谨的求解。案例 A 的问题描述中存在一个微小的歧义——具体来说，是在一个与前一区间共享一个边界点的时间段内为 $\\tau(t)$ “增加一个恒定力矩偏移量”的指令——通过将“增加”解释为两个函数（每个指定区间一个）的叠加来解决。这意味着总力矩 $\\tau(t)$ 是一个半正弦函数（在 $[0.120, 0.370]$ s 上非零）和一个常数函数（在 $[0.370, 0.500]$ s 上非零）之和。在共享边界 $t=0.370$ s 处，半正弦分量的值为零，确保了函数的良定性。这种解释在物理上和数学上都是合理的，并将在后续分析中使用。\n\n该问题要求基于关节力矩 $\\tau(t)$ 和角速度 $\\omega(t)$ 的时间序列数据，计算踝关节的机械功率和功。旋转力学的基本原理是，由作用在以角速度 $\\omega(t)$ 旋转的物体上的力矩 $\\tau(t)$ 产生或吸收的瞬时机械功率 $P(t)$ 由它们的标量积给出。由于问题是一维的（围绕单一踝关节轴线旋转），这可以简化为：\n\n$$\nP(t) = \\tau(t) \\omega(t)\n$$\n\n单位是一致的：力矩单位为牛顿米 ($N \\cdot m$)，角速度单位为弧度/秒 ($rad/s$) ，功率单位为瓦特 ($W$)，其中 $1~W = 1~J/s = 1~N \\cdot m/s$。正功率 $P(t) > 0$ 表示关节正在产生能量（向心收缩），而负功率 $P(t) < 0$ 表示关节正在吸收能量（离心收缩）。\n\n问题提供了采样时间序列，因此这些连续函数由在时间点 $t_i = i \\Delta t$（其中 $i \\in \\{0, 1, \\dots, N-1\\}$）处的一组离散值表示，其中 $\\Delta t$ 是采样间隔，$N$ 是总样本数。每个采样点的瞬时功率为：\n\n$$\nP(t_i) = P_i = \\tau(t_i) \\omega(t_i)\n$$\n\n根据这个离散功率序列 $\\{P_i\\}$，我们计算瞬时功率的最大值和最小值：\n\n$$\nP_{\\max} = \\max_{i} \\{P_i\\}\n$$\n$$\nP_{\\min} = \\min_{i} \\{P_i\\}\n$$\n\n机械功 $W$ 是功率对时间的积分，$W = \\int P(t) dt$。问题指定使用黎曼和来近似这个积分。总正功 $W^{+}$（产生的能量）和总负功 $W^{-}$（吸收的能量）通过对相应正功率和负功率样本的贡献求和来计算：\n\n$$\nW^{+} = \\sum_{i \\text{ such that } P_i > 0} P_i \\Delta t\n$$\n$$\nW^{-} = \\sum_{i \\text{ such that } P_i < 0} P_i \\Delta t\n$$\n\n在时间窗口内所做的净机械功是正功和负功分量的总和：\n\n$$\nW_{\\text{net}} = W^{+} + W^{-} = \\left( \\sum_{i} P_i \\right) \\Delta t\n$$\n\n最后，确定一个分类整数 $C$ 来对关节的净能量行为进行分类。该分类取决于净功 $W_{\\text{net}}$ 是显著为正、为负还是接近于零，这是根据一个小的容差 $\\varepsilon = 10^{-9}$ 焦耳 ($J$) 来判断的：\n\n$$\nC = \\begin{cases}\n+1 & \\text{if } W_{\\text{net}} > \\varepsilon \\\\\n-1 & \\text{if } W_{\\text{net}} < -\\varepsilon \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\n\n求解过程是对四个测试案例中的每一个应用此框架。对于每个案例：\n1.  生成一个离散时间向量 $t$，从 $t_0=0$ 到 $t_{N-1}=T-\\Delta t$，步长为 $\\Delta t$，其中 $N=T/\\Delta t$。\n2.  根据其分段定义，构建力矩 $\\tau(t_i)$ 和角速度 $\\omega(t_i)$ 的向量表示，包括半正弦脉冲函数 $A \\sin(\\pi(t-t_0)/D)$。\n3.  瞬时功率向量 $P$ 计算为 $\\tau$ 和 $\\omega$ 向量的逐元素乘积。\n4.  从功率向量 $P$ 和采样间隔 $\\Delta t$ 计算 $P_{\\max}$、$P_{\\min}$、$W^{+}$ 和 $W^{-}$。\n5.  计算 $W_{\\text{net}}$ 并用它来确定分类整数 $C$。\n6.  将得到的浮点值（$P_{\\max}, P_{\\min}, W^{+}, W^{-}$）四舍五入到 $6$ 位小数。\n\n这个系统化的程序确保了为每个指定的测试案例提供准确且可验证的结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the biomechanics problem for four test cases.\n    For each case, it computes max/min power, positive/negative work, and a classification integer.\n    \"\"\"\n\n    # Tolerance for net work classification\n    EPSILON = 1e-9\n\n    def half_sine_pulse(t, t0, D, A):\n        \"\"\"Generates a half-sine pulse.\"\"\"\n        pulse = np.zeros_like(t)\n        mask = (t >= t0)  (t = t0 + D)\n        pulse[mask] = A * np.sin(np.pi * (t[mask] - t0) / D)\n        return pulse\n\n    def calculate_metrics(dt, T, tau_func, omega_func):\n        \"\"\"\n        Calculates all required metrics for a given set of torque and velocity functions.\n        \"\"\"\n        if dt = 0:\n            raise ValueError(\"Sampling interval dt must be positive.\")\n        if T = 0:\n            raise ValueError(\"Total duration T must be positive.\")\n            \n        num_samples = int(round(T / dt))\n        t = np.linspace(0, T, num_samples, endpoint=False)\n\n        tau = tau_func(t)\n        omega = omega_func(t)\n\n        power = tau * omega\n\n        p_max = np.max(power) if power.size > 0 else 0.0\n        p_min = np.min(power) if power.size > 0 else 0.0\n\n        positive_power_samples = power[power > 0]\n        w_pos = np.sum(positive_power_samples) * dt\n\n        negative_power_samples = power[power  0]\n        w_neg = np.sum(negative_power_samples) * dt\n\n        w_net = w_pos + w_neg\n\n        if w_net > EPSILON:\n            C = 1\n        elif w_net  -EPSILON:\n            C = -1\n        else:\n            C = 0\n        \n        return [\n            round(p_max, 6),\n            round(p_min, 6),\n            round(w_pos, 6),\n            round(w_neg, 6),\n            C\n        ]\n\n    # --- Test Case Definitions ---\n\n    # Case A\n    def tau_A(t):\n        tau = np.zeros_like(t)\n        # Half-sine pulse\n        tau += half_sine_pulse(t, t0=0.120, D=0.250, A=110.0)\n        # Constant offset added\n        mask_offset = (t >= 0.370)  (t = 0.500)\n        tau[mask_offset] += 25.0\n        return tau\n\n    def omega_A(t):\n        w = np.zeros_like(t)\n        # Positive half-sine pulse\n        w += half_sine_pulse(t, t0=0.120, D=0.250, A=7.0)\n        # Negative half-sine pulse\n        w += half_sine_pulse(t, t0=0.370, D=0.130, A=-3.0)\n        return w\n\n    # Case B\n    def tau_B(t):\n        tau = np.zeros_like(t)\n        mask = (t >= 0.100)  (t = 0.350)\n        tau[mask] = 80.0\n        return tau\n    \n    def omega_B(t):\n        omega = np.zeros_like(t)\n        mask = (t >= 0.150)  (t = 0.350)\n        omega[mask] = -6.0\n        return omega\n\n    # Case C\n    def tau_C(t):\n        return half_sine_pulse(t, t0=0.050, D=0.200, A=100.0)\n\n    def omega_C(t):\n        return np.zeros_like(t)\n\n    # Case D\n    def tau_D(t):\n        tau = np.zeros_like(t)\n        # Positive half-sine pulse\n        tau += half_sine_pulse(t, t0=0.100, D=0.150, A=100.0)\n        # Negative half-sine pulse\n        tau += half_sine_pulse(t, t0=0.250, D=0.150, A=-90.0)\n        return tau\n\n    def omega_D(t):\n        return half_sine_pulse(t, t0=0.100, D=0.300, A=7.0)\n\n    test_cases = [\n        {'dt': 0.001, 'T': 0.600, 'tau_func': tau_A, 'omega_func': omega_A},\n        {'dt': 0.001, 'T': 0.400, 'tau_func': tau_B, 'omega_func': omega_B},\n        {'dt': 0.001, 'T': 0.300, 'tau_func': tau_C, 'omega_func': omega_C},\n        {'dt': 0.001, 'T': 0.500, 'tau_func': tau_D, 'omega_func': omega_D},\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = calculate_metrics(case['dt'], case['T'], case['tau_func'], case['omega_func'])\n        all_results.append(result)\n\n    # Manual string formatting to match the required output format without spaces\n    case_strings = []\n    for res_list in all_results:\n        formatted_items = []\n        for item in res_list:\n            if isinstance(item, float):\n                formatted_items.append(f\"{item:.6f}\")\n            else:\n                formatted_items.append(str(item))\n        case_strings.append(f\"[{','.join(formatted_items)}]\")\n    \n    final_output_string = f\"[{','.join(case_strings)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}