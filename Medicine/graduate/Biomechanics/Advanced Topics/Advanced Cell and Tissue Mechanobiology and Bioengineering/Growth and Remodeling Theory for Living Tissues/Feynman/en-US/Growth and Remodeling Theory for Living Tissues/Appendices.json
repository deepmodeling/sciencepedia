{
    "hands_on_practices": [
        {
            "introduction": "The theory of morphoelasticity is built upon the kinematic concept of multiplicative decomposition, where the total deformation gradient $\\mathbf{F}$ is split into a growth part $\\mathbf{F}_\\mathrm{g}$ and an elastic part $\\mathbf{F}_\\mathrm{e}$. This first exercise  provides a fundamental illustration of this principle by examining a simple but powerful hypothetical scenario. By calculating the elastic deformation required to accommodate anisotropic growth within a rigidly clamped tissue, you will directly see how geometric constraints force the generation of an elastic response, which is the origin of residual stress.",
            "id": "4177017",
            "problem": "Consider a homogeneous, initially stress-free tissue occupying a reference configuration, with the identity deformation gradient $\\mathbf{F} = \\mathbf{I}$. Over a short remodeling interval (neglecting inertia and viscosity), an anisotropic growth process occurs that, in the local material frame, is represented by a uniform growth deformation tensor $\\mathbf{F}_\\mathrm{g} = \\mathrm{diag}(1+\\gamma,\\,1,\\,1)$, where $\\gamma > -1$ is a prescribed scalar growth parameter. The specimen is rigidly clamped on all external boundaries throughout the growth process so that macroscopic compatibility with the environment requires no net change of shape or size; in other words, the macroscopic deformation mapping of the boundary coincides with the identity mapping.\n\nUsing only fundamental kinematics of growth and remodeling and the standard multiplicative decomposition of the deformation gradient into elastic and growth parts, $\\mathbf{F} = \\mathbf{F}_\\mathrm{e} \\mathbf{F}_\\mathrm{g}$, determine the elastic deformation gradient $\\mathbf{F}_\\mathrm{e}$ that must develop to satisfy the imposed boundary constraints and maintain overall compatibility. State any necessary conditions for invertibility that your result requires. Express your final answer as a single $3 \\times 3$ matrix in analytic form in terms of $\\gamma$. No numerical evaluation is required.",
            "solution": "The problem is first validated against the established criteria.\n\n### Step 1: Extract Givens\n-   **Initial State**: The tissue is homogeneous and initially stress-free.\n-   **Reference Configuration**: The initial deformation gradient is the identity, $\\mathbf{F} = \\mathbf{I}$.\n-   **Process Conditions**: The remodeling occurs over a short interval, so inertia and viscosity are neglected.\n-   **Growth Tensor**: The growth process is described by a uniform growth deformation tensor in the local material frame, $\\mathbf{F}_\\mathrm{g} = \\mathrm{diag}(1+\\gamma,\\,1,\\,1)$.\n-   **Growth Parameter**: $\\gamma$ is a prescribed scalar parameter such that $\\gamma > -1$.\n-   **Boundary Conditions**: The specimen is rigidly clamped on all external boundaries.\n-   **Macroscopic Deformation**: The macroscopic deformation mapping of the boundary coincides with the identity mapping, implying no net change in the overall shape or size of the body.\n-   **Theoretical Framework**: The solution must use the multiplicative decomposition of the deformation gradient, $\\mathbf{F} = \\mathbf{F}_\\mathrm{e} \\mathbf{F}_\\mathrm{g}$, where $\\mathbf{F}$ is the total deformation gradient, $\\mathbf{F}_\\mathrm{e}$ is the elastic part, and $\\mathbf{F}_\\mathrm{g}$ is the growth part.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Groundedness**: The problem is well-grounded in the theory of continuum mechanics as applied to biomechanics. The multiplicative decomposition $\\mathbf{F} = \\mathbf{F}_\\mathrm{e} \\mathbf{F}_\\mathrm{g}$ is a standard and fundamental concept in modeling material growth and remodeling. The use of a simple anisotropic growth tensor is a common approach for illustrative and foundational problems. The condition $\\gamma > -1$ is physically necessary to ensure that the volume of the grown material remains positive, as $\\det(\\mathbf{F}_\\mathrm{g}) = 1+\\gamma > 0$.\n-   **Well-Posedness**: The problem is well-posed. It provides the total deformation (constrained by the boundary conditions) and the growth deformation, and asks for the remaining component, the elastic deformation. The relationship between these quantities is explicitly defined by the use of the multiplicative decomposition. A unique solution is expected.\n-   **Objectivity**: The problem is stated using precise, objective, and standard terminology from continuum mechanics. There are no subjective or ambiguous statements.\n-   **Completeness and Consistency**: The problem is self-contained. The boundary condition of the specimen being \"rigidly clamped\" and showing \"no net change of shape or size\" provides a clear constraint on the total deformation gradient, $\\mathbf{F}$. This information is sufficient to determine the unknown, $\\mathbf{F}_\\mathrm{e}$. There are no contradictions in the provided information.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard, well-posed problem in the biomechanics of growing tissues. A solution will be provided.\n\n### Solution Derivation\nThe theoretical framework for this problem is the multiplicative decomposition of the total deformation gradient, $\\mathbf{F}$, into an elastic part, $\\mathbf{F}_\\mathrm{e}$, and a growth part, $\\mathbf{F}_\\mathrm{g}$. This is expressed as:\n$$\\mathbf{F} = \\mathbf{F}_\\mathrm{e} \\mathbf{F}_\\mathrm{g}$$\nThe total deformation gradient, $\\mathbf{F}$, maps material points from the initial, stress-free reference configuration to the final, constrained current configuration. The problem states that the specimen is \"rigidly clamped on all external boundaries\" and the \"macroscopic deformation mapping of the boundary coincides with the identity mapping\". This implies that, on a macroscopic scale, there is no change in shape or size. For a homogeneous body undergoing uniform growth, this boundary condition dictates that the total deformation gradient throughout the body must be the identity tensor, $\\mathbf{I}$.\n$$\\mathbf{F} = \\mathbf{I} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\nThis means that despite the local material growth, the overall object does not deform. The internal growth must be accommodated by an elastic deformation.\n\nThe growth deformation tensor, $\\mathbf{F}_\\mathrm{g}$, is given as a uniform anisotropic growth process in the local material frame:\n$$\\mathbf{F}_\\mathrm{g} = \\begin{pmatrix} 1+\\gamma & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\nwhere $\\gamma > -1$.\n\nSubstituting the expressions for $\\mathbf{F}$ and $\\mathbf{F}_\\mathrm{g}$ into the multiplicative decomposition equation, we have:\n$$\\mathbf{I} = \\mathbf{F}_\\mathrm{e} \\mathbf{F}_\\mathrm{g}$$\nTo solve for the elastic deformation gradient, $\\mathbf{F}_\\mathrm{e}$, we can right-multiply both sides of the equation by the inverse of $\\mathbf{F}_\\mathrm{g}$, denoted as $\\mathbf{F}_\\mathrm{g}^{-1}$. This is permissible provided that $\\mathbf{F}_\\mathrm{g}$ is invertible.\n$$\\mathbf{I} \\mathbf{F}_\\mathrm{g}^{-1} = (\\mathbf{F}_\\mathrm{e} \\mathbf{F}_\\mathrm{g}) \\mathbf{F}_\\mathrm{g}^{-1}$$\n$$\\mathbf{F}_\\mathrm{g}^{-1} = \\mathbf{F}_\\mathrm{e} (\\mathbf{F}_\\mathrm{g} \\mathbf{F}_\\mathrm{g}^{-1})$$\n$$\\mathbf{F}_\\mathrm{e} = \\mathbf{F}_\\mathrm{g}^{-1}$$\nThe condition for the invertibility of $\\mathbf{F}_\\mathrm{g}$ is that its determinant must be non-zero.\n$$\\det(\\mathbf{F}_\\mathrm{g}) = \\det\\left(\\begin{pmatrix} 1+\\gamma & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\\right) = (1+\\gamma)(1)(1) = 1+\\gamma$$\nFor $\\det(\\mathbf{F}_\\mathrm{g}) \\neq 0$, we must have $1+\\gamma \\neq 0$, or $\\gamma \\neq -1$. The problem statement gives the condition $\\gamma > -1$, which not only satisfies the invertibility condition but also the physical requirement that the change in volume due to growth is positive ($J_\\mathrm{g} = \\det(\\mathbf{F}_\\mathrm{g}) > 0$).\n\nNow, we compute the inverse of $\\mathbf{F}_\\mathrm{g}$. Since $\\mathbf{F}_\\mathrm{g}$ is a diagonal matrix, its inverse is the diagonal matrix of the reciprocals of its diagonal elements:\n$$\\mathbf{F}_\\mathrm{g}^{-1} = \\begin{pmatrix} (1+\\gamma)^{-1} & 0 & 0 \\\\ 0 & 1^{-1} & 0 \\\\ 0 & 0 & 1^{-1} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{1+\\gamma} & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\nTherefore, the elastic deformation gradient $\\mathbf{F}_\\mathrm{e}$ that must develop to maintain compatibility is:\n$$\\mathbf{F}_\\mathrm{e} = \\begin{pmatrix} \\frac{1}{1+\\gamma} & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\nThis result indicates that to accommodate the growth of magnitude $1+\\gamma$ in the first direction while maintaining the overall dimensions of the body, the material must elastically compress in that same direction by a factor of $\\frac{1}{1+\\gamma}$. This elastic deformation generates residual stress within the tissue, even though the body is macroscopically undeformed. The necessary condition for the existence of this result is the invertibility of $\\mathbf{F}_\\mathrm{g}$, which is guaranteed by the given constraint $\\gamma > -1$.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{1+\\gamma} & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While uniform growth in a constrained body generates stress, differential growth can actively drive changes in shape. This next practice  explores this fundamental principle of morphogenesis by modeling a bilayer strip with a gradient in growth strain through its thickness. By applying principles from classic beam theory, you will derive the curvature that emerges from a mismatch in surface growth, providing a clear, analytical link between non-uniform growth and macroscopic bending.",
            "id": "4176975",
            "problem": "Consider a slender, initially flat, prismatic bilayer strip of biological tissue of width $b$ and total thickness $h$, parameterized through the thickness by $z \\in [-h/2, h/2]$ with $z=0$ at the mid-surface. The strip is long in the $x$-direction and is modeled as an Euler–Bernoulli beam (Kirchhoff–Love kinematics) under plane stress. The tissue is linearly elastic with Young’s modulus $E$ uniform across the thickness and along the length. The strip undergoes slow (quasi-static) growth and remodeling (G&R), so inertia can be neglected and there are no external tractions or body forces.\n\nAdopt the small-strain morphoelastic framework with an elastic strain that is the difference between the total strain and a prescribed growth strain field. Assume:\n- The total axial strain in the $x$-direction varies linearly through the thickness, $ \\varepsilon_{xx}(z) = \\varepsilon_{0} + \\kappa z $, where $ \\varepsilon_{0} $ is the mid-surface membrane strain and $ \\kappa $ is the curvature.\n- The in-plane growth strain in the $x$-direction has two contributions: a uniform volumetric growth contribution $ \\varepsilon_{v} $ and an additional contribution from surface accretion that produces a linear through-thickness gradient. Specifically, the homogenized growth strain profile is linear in $z$ and satisfies\n$$\n\\varepsilon_{g}(h/2) = \\varepsilon_{v} + \\eta_{t}, \n\\quad\n\\varepsilon_{g}(-h/2) = \\varepsilon_{v} + \\eta_{b},\n$$\nwhere $ \\eta_{t} $ and $ \\eta_{b} $ are prescribed surface accretion growth strains at the top and bottom faces, respectively. Assume no shear growth strain and no growth-induced change in $E$.\n\nUsing linear elasticity and the balance of linear and angular momentum for a free (traction-free) beam cross-section, show from first principles that a nonzero curvature can arise purely from the surface accretion mismatch even when the volumetric growth is uniform, and determine the curvature $ \\kappa $ induced by the accretion mismatch $ \\eta_{t} - \\eta_{b} $. Express your final answer for $ \\kappa $ symbolically in terms of $ h $, $ \\eta_{t} $, and $ \\eta_{b} $. Express $ \\kappa $ in inverse length units (for example, $\\mathrm{m}^{-1}$). The final answer must be a single closed-form analytic expression.",
            "solution": "The problem requires the determination of the curvature $\\kappa$ induced in a bilayer strip due to differential surface growth. The solution is derived from the principles of small-strain morphoelasticity and the mechanical equilibrium of a free beam.\n\nThe analysis begins with the fundamental kinematic decomposition in morphoelasticity. The total strain, $\\varepsilon_{xx}$, is the sum of an elastic strain, $\\varepsilon_{e}$, which generates stress, and a non-elastic growth strain, $\\varepsilon_{g}$. The elastic strain is thus given by:\n$$\n\\varepsilon_{e}(z) = \\varepsilon_{xx}(z) - \\varepsilon_{g}(z)\n$$\n\nThe problem statement provides the form of the total axial strain based on Euler-Bernoulli beam theory:\n$$\n\\varepsilon_{xx}(z) = \\varepsilon_{0} + \\kappa z\n$$\nwhere $\\varepsilon_{0}$ is the mid-surface membrane strain and $\\kappa$ is the curvature. Both $\\varepsilon_{0}$ and $\\kappa$ are unknowns to be determined.\n\nNext, we establish the through-thickness profile of the growth strain, $\\varepsilon_{g}(z)$. The problem states that this profile is linear in the thickness coordinate $z$. A general linear function of $z$ can be written as $\\varepsilon_{g}(z) = A + B z$. The constants $A$ and $B$ are determined from the given conditions at the top ($z=h/2$) and bottom ($z=-h/2$) surfaces:\n$$\n\\varepsilon_{g}(h/2) = \\varepsilon_{v} + \\eta_{t}\n$$\n$$\n\\varepsilon_{g}(-h/2) = \\varepsilon_{v} + \\eta_{b}\n$$\nSubstituting the linear form into these conditions gives a system of two equations:\n$$\nA + B \\frac{h}{2} = \\varepsilon_{v} + \\eta_{t}\n$$\n$$\nA - B \\frac{h}{2} = \\varepsilon_{v} + \\eta_{b}\n$$\nAdding these two equations yields $2A = 2\\varepsilon_{v} + \\eta_{t} + \\eta_{b}$, which gives the average growth strain at the mid-surface:\n$$\nA = \\varepsilon_{v} + \\frac{\\eta_{t} + \\eta_{b}}{2}\n$$\nSubtracting the second equation from the first yields $B h = \\eta_{t} - \\eta_{b}$, which gives the gradient of the growth strain:\n$$\nB = \\frac{\\eta_{t} - \\eta_{b}}{h}\n$$\nThus, the growth strain as a function of $z$ is:\n$$\n\\varepsilon_{g}(z) = \\left(\\varepsilon_{v} + \\frac{\\eta_{t} + \\eta_{b}}{2}\\right) + \\left(\\frac{\\eta_{t} - \\eta_{b}}{h}\\right) z\n$$\n\nNow, we can express the elastic strain $\\varepsilon_{e}(z)$ by substituting the expressions for $\\varepsilon_{xx}(z)$ and $\\varepsilon_{g}(z)$:\n$$\n\\varepsilon_{e}(z) = (\\varepsilon_{0} + \\kappa z) - \\left[ \\left(\\varepsilon_{v} + \\frac{\\eta_{t} + \\eta_{b}}{2}\\right) + \\left(\\frac{\\eta_{t} - \\eta_{b}}{h}\\right) z \\right]\n$$\nGrouping terms by powers of $z$:\n$$\n\\varepsilon_{e}(z) = \\left(\\varepsilon_{0} - \\varepsilon_{v} - \\frac{\\eta_{t} + \\eta_{b}}{2}\\right) + \\left(\\kappa - \\frac{\\eta_{t} - \\eta_{b}}{h}\\right) z\n$$\n\nThe axial stress, $\\sigma_{xx}$, is related to the elastic strain by the linear elastic constitutive law. For plane stress conditions, this is simply:\n$$\n\\sigma_{xx}(z) = E \\varepsilon_{e}(z) = E \\left[ \\left(\\varepsilon_{0} - \\varepsilon_{v} - \\frac{\\eta_{t} + \\eta_{b}}{2}\\right) + \\left(\\kappa - \\frac{\\eta_{t} - \\eta_{b}}{h}\\right) z \\right]\n$$\n\nThe strip is a \"free\" beam, meaning there are no external tractions. Mechanical equilibrium requires that the net axial force resultant, $N$, and the net bending moment resultant, $M$, on any cross-section must be zero.\n\nThe force resultant $N$ is the integral of the stress over the cross-sectional area $A$:\n$$\nN = \\int_{A} \\sigma_{xx} dA = b \\int_{-h/2}^{h/2} \\sigma_{xx}(z) dz = 0\n$$\nSubstituting the expression for $\\sigma_{xx}(z)$:\n$$\nb E \\int_{-h/2}^{h/2} \\left[ \\left(\\varepsilon_{0} - \\varepsilon_{v} - \\frac{\\eta_{t} + \\eta_{b}}{2}\\right) + \\left(\\kappa - \\frac{\\eta_{t} - \\eta_{b}}{h}\\right) z \\right] dz = 0\n$$\nSince $b$ and $E$ are non-zero constants, the integral must be zero. The integral of the term proportional to $z$ over the symmetric interval $[-h/2, h/2]$ is zero. This leaves:\n$$\n\\left(\\varepsilon_{0} - \\varepsilon_{v} - \\frac{\\eta_{t} + \\eta_{b}}{2}\\right) \\int_{-h/2}^{h/2} dz = \\left(\\varepsilon_{0} - \\varepsilon_{v} - \\frac{\\eta_{t} + \\eta_{b}}{2}\\right) h = 0\n$$\nAs $h \\neq 0$, this implies that the mid-surface strain is:\n$$\n\\varepsilon_{0} = \\varepsilon_{v} + \\frac{\\eta_{t} + \\eta_{b}}{2}\n$$\nThis result shows that the mid-surface membrane strain exactly accommodates the average growth strain across the thickness.\n\nThe moment resultant $M$ about the mid-axis ($z=0$) is the integral of the stress multiplied by the moment arm $z$:\n$$\nM = \\int_{A} \\sigma_{xx} z dA = b \\int_{-h/2}^{h/2} \\sigma_{xx}(z) z dz = 0\n$$\nSubstituting the expression for $\\sigma_{xx}(z)$ and the result for $\\varepsilon_0$:\n$$\nM = b E \\int_{-h/2}^{h/2} \\left[ \\left(\\left(\\varepsilon_{v} + \\frac{\\eta_{t} + \\eta_{b}}{2}\\right) - \\varepsilon_{v} - \\frac{\\eta_{t} + \\eta_{b}}{2}\\right) + \\left(\\kappa - \\frac{\\eta_{t} - \\eta_{b}}{h}\\right) z \\right] z dz = 0\n$$\nThe first term inside the brackets simplifies to zero. The equation reduces to:\n$$\nb E \\int_{-h/2}^{h/2} \\left(\\kappa - \\frac{\\eta_{t} - \\eta_{b}}{h}\\right) z^2 dz = 0\n$$\nThe term $\\left(\\kappa - \\frac{\\eta_{t} - \\eta_{b}}{h}\\right)$ is constant with respect to $z$ and can be factored out of the integral:\n$$\nb E \\left(\\kappa - \\frac{\\eta_{t} - \\eta_{b}}{h}\\right) \\int_{-h/2}^{h/2} z^2 dz = 0\n$$\nThe integral is the second moment of area of the rectangular cross-section (per unit width), which is non-zero for $h>0$:\n$$\n\\int_{-h/2}^{h/2} z^2 dz = \\left[ \\frac{z^3}{3} \\right]_{-h/2}^{h/2} = \\frac{(h/2)^3 - (-h/2)^3}{3} = \\frac{2h^3/8}{3} = \\frac{h^3}{12}\n$$\nSince $b$, $E$, and the integral are all non-zero, the equilibrium condition $M=0$ can only be satisfied if the term in the parenthesis is zero:\n$$\n\\kappa - \\frac{\\eta_{t} - \\eta_{b}}{h} = 0\n$$\nSolving for the curvature $\\kappa$ yields the final result:\n$$\n\\kappa = \\frac{\\eta_{t} - \\eta_{b}}{h}\n$$\nThis result shows that a non-zero curvature is generated by the mismatch in surface accretion strains, $\\eta_{t} - \\eta_{b}$, and is independent of the uniform volumetric growth $\\varepsilon_{v}$ and the Young's modulus $E$. This curvature corresponds to a stress-free configuration, as the specific choices of $\\varepsilon_0$ and $\\kappa$ make the elastic strain $\\varepsilon_\\mathrm{e}(z)$ identically zero.",
            "answer": "$$\n\\boxed{\\frac{\\eta_{t} - \\eta_{b}}{h}}\n$$"
        },
        {
            "introduction": "Analytical solutions provide deep insight but are often limited to simple geometries and growth patterns. To tackle realistic biological problems, we turn to computational tools like the Finite Element Method (FEM). This final hands-on practice  challenges you to implement a 2D FEM solver to simulate the mechanical response of a tissue patch to prescribed growth, which is modeled as an initial strain. Completing this exercise will solidify your understanding of the theory by translating it into a practical, working simulation, a crucial skill in modern biomechanics research.",
            "id": "4177012",
            "problem": "Consider a two-dimensional ($2\\text{D}$) rectangular tissue patch occupying the domain $\\Omega = [0,L_x] \\times [0,L_y]$ with $L_x > 0$ and $L_y > 0$. The patch is modeled as a thin membrane under plane stress with small strains. The kinematics follow the multiplicative decomposition of the deformation gradient $\\mathbf{F}$ into an elastic part $\\mathbf{F}_\\mathrm{e}$ and a growth part $\\mathbf{F}_\\mathrm{g}$, that is $\\mathbf{F} = \\mathbf{F}_\\mathrm{e} \\mathbf{F}_\\mathrm{g}$. In a small-time increment $\\Delta t$, assume a prescribed, spatially uniform growth rate tensor $\\dot{\\mathbf{F}}_\\mathrm{g}$ such that $\\mathbf{F}_\\mathrm{g} \\approx \\mathbf{I} + \\Delta t \\, \\dot{\\mathbf{F}}_\\mathrm{g}$, where $\\mathbf{I}$ is the identity tensor. Linearize the growth effect to an eigenstrain (initial strain) tensor $\\boldsymbol{\\varepsilon}_\\mathrm{g} \\approx \\mathrm{sym}(\\dot{\\mathbf{F}}_\\mathrm{g})\\,\\Delta t$, where $\\mathrm{sym}(A) = \\tfrac{1}{2}(A + A^\\top)$ is the symmetric part of a tensor.\n\nThe tissue is linear elastic and isotropic, with Young’s modulus $E$ and Poisson’s ratio $\\nu$, and obeys the plane-stress linear constitutive relation $\\boldsymbol{\\sigma} = \\mathbb{D} : (\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}_\\mathrm{g})$, where $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, $\\boldsymbol{\\varepsilon}$ is the small-strain tensor, and $\\mathbb{D}$ is the standard isotropic plane-stress stiffness tensor. Assume quasi-static equilibrium with no body forces and no external tractions on the free edges, so that $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$ in $\\Omega$. Impose essential constraints (Dirichlet boundary conditions) by clamping the left edge $\\{0\\} \\times [0,L_y]$ so that both displacement components vanish there, that is $u_x = 0$ and $u_y = 0$ on $x=0$, while all other edges are traction-free.\n\nDiscretize $\\Omega$ using the Finite Element Method (FEM) with bilinear four-node quadrilateral elements on a structured mesh of $N_x \\times N_y$ elements, and apply two-point Gaussian quadrature in each parametric direction to assemble the global stiffness matrix and the equivalent nodal load vector arising from the eigenstrain. Use the small-strain definition $\\boldsymbol{\\varepsilon} = \\mathrm{sym}(\\nabla u)$ and, in Voigt notation for plane stress, represent strains as the vector $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top$, where $\\gamma_{xy} = 2 \\varepsilon_{xy}$, and stresses as $[\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}]^\\top$, where $\\tau_{xy} = \\sigma_{xy}$. In equilibrium with zero external tractions, the discrete system to solve is $\\mathbf{K} \\, \\mathbf{u} = \\mathbf{f}_\\mathrm{g}$, where $\\mathbf{K}$ is the global stiffness matrix, $\\mathbf{u}$ is the nodal displacement vector, and $\\mathbf{f}_\\mathrm{g}$ is the equivalent nodal load vector induced by $\\boldsymbol{\\varepsilon}_\\mathrm{g}$ via the constitutive law and strain-displacement operator.\n\nYour task is to implement a single time step that:\n- computes $\\boldsymbol{\\varepsilon}_\\mathrm{g}$ from $\\dot{\\mathbf{F}}_\\mathrm{g}$ and $\\Delta t$,\n- assembles the global system,\n- applies the clamped-left-edge constraints,\n- solves for the displacement field,\n- computes the Cauchy stress distribution at the Gaussian points,\n- and reports summary quantities.\n\nReport, for each test case, the maximum nodal displacement magnitude in meters (m) and the average von Mises stress in Pascals (Pa) over all Gaussian points in the domain. The von Mises stress for plane stress is defined as $\\sigma_\\mathrm{vm} = \\sqrt{\\sigma_{xx}^2 - \\sigma_{xx}\\sigma_{yy} + \\sigma_{yy}^2 + 3 \\tau_{xy}^2}$.\n\nImplement your program to produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is a two-element list $[u_\\mathrm{max}, \\overline{\\sigma_\\mathrm{vm}}]$ with both entries as floats in SI units (meters for displacements and Pascals for stresses), for example, $[[a,b],[c,d],[e,f]]$.\n\nUse the following scientifically consistent test suite, covering a typical case, anisotropy, shear growth, and a no-growth edge case. In all cases, adopt plane stress, a rectangular domain, bilinear quadrilateral elements with two-by-two Gaussian quadrature, and clamped left edge as specified.\n\nTest case $1$ (uniform isotropic growth, happy path):\n- $L_x = 0.1$ $\\mathrm{m}$, $L_y = 0.1$ $\\mathrm{m}$,\n- $N_x = 2$, $N_y = 2$,\n- $E = 50000$ $\\mathrm{Pa}$, $\\nu = 0.3$,\n- $\\Delta t = 10$ $\\mathrm{s}$,\n- $\\dot{\\mathbf{F}}_\\mathrm{g} = 0.001 \\, \\mathbf{I}$ $\\mathrm{s}^{-1}$.\n\nTest case $2$ (anisotropic growth along $x$):\n- $L_x = 0.1$ $\\mathrm{m}$, $L_y = 0.1$ $\\mathrm{m}$,\n- $N_x = 2$, $N_y = 2$,\n- $E = 80000$ $\\mathrm{Pa}$, $\\nu = 0.45$,\n- $\\Delta t = 10$ $\\mathrm{s}$,\n- $\\dot{\\mathbf{F}}_\\mathrm{g} = \\mathrm{diag}(0.002, 0.0)$ $\\mathrm{s}^{-1}$.\n\nTest case $3$ (pure shear growth):\n- $L_x = 0.1$ $\\mathrm{m}$, $L_y = 0.1$ $\\mathrm{m}$,\n- $N_x = 2$, $N_y = 2$,\n- $E = 50000$ $\\mathrm{Pa}$, $\\nu = 0.3$,\n- $\\Delta t = 10$ $\\mathrm{s}$,\n- $\\dot{\\mathbf{F}}_\\mathrm{g} = \\begin{bmatrix} 0 & 0.001 \\\\ 0.001 & 0 \\end{bmatrix}$ $\\mathrm{s}^{-1}$.\n\nTest case $4$ (no growth, boundary condition consistency check):\n- $L_x = 0.1$ $\\mathrm{m}$, $L_y = 0.1$ $\\mathrm{m}$,\n- $N_x = 2$, $N_y = 2$,\n- $E = 50000$ $\\mathrm{Pa}$, $\\nu = 0.3$,\n- $\\Delta t = 0$ $\\mathrm{s}$,\n- $\\dot{\\mathbf{F}}_\\mathrm{g} = 0.001 \\, \\mathbf{I}$ $\\mathrm{s}^{-1}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order of the test cases, namely $[[u_\\mathrm{max}^{(1)}, \\overline{\\sigma_\\mathrm{vm}}^{(1)}],[u_\\mathrm{max}^{(2)}, \\overline{\\sigma_\\mathrm{vm}}^{(2)}],[u_\\mathrm{max}^{(3)}, \\overline{\\sigma_\\mathrm{vm}}^{(3)}],[u_\\mathrm{max}^{(4)}, \\overline{\\sigma_\\mathrm{vm}}^{(4)}]]$.",
            "solution": "The user-provided problem is a well-defined boundary value problem in continuum mechanics, specifically linear elasticity with eigenstrains, to be solved using the Finite Element Method (FEM). This problem models the mechanical response of a biological tissue patch to a prescribed growth process over a small time step.\n\n### Step 1: Extract Givens\n\n- **Domain**: 2D rectangular tissue patch $\\Omega = [0,L_x] \\times [0,L_y]$.\n- **Kinematics**: Multiplicative decomposition $\\mathbf{F} = \\mathbf{F}_\\mathrm{e} \\mathbf{F}_\\mathrm{g}$. Linearized growth effect leads to an eigenstrain $\\boldsymbol{\\varepsilon}_\\mathrm{g} \\approx \\mathrm{sym}(\\dot{\\mathbf{F}}_\\mathrm{g})\\,\\Delta t$.\n- **Constitutive Law**: Linear elastic, isotropic, plane stress: $\\boldsymbol{\\sigma} = \\mathbb{D} : (\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}_\\mathrm{g})$. $\\mathbb{D}$ is the isotropic plane-stress stiffness tensor dependent on Young's modulus $E$ and Poisson's ratio $\\nu$.\n- **Equilibrium**: Quasi-static, no body forces: $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$.\n- **Boundary Conditions (BCs)**:\n    - Clamped on the left edge ($x=0$): $u_x = 0, u_y = 0$.\n    - Traction-free on all other edges ($x=L_x, y=0, y=L_y$).\n- **Discretization**: Finite Element Method (FEM) with bilinear four-node quadrilateral (Q4) elements on a structured $N_x \\times N_y$ mesh.\n- **Numerical Integration**: Two-point Gaussian quadrature in each parametric direction ($2 \\times 2$ total).\n- **System to Solve**: $\\mathbf{K} \\, \\mathbf{u} = \\mathbf{f}_\\mathrm{g}$, where $\\mathbf{K}$ is the global stiffness matrix, $\\mathbf{u}$ is the nodal displacement vector, and $\\mathbf{f}_\\mathrm{g}$ is the equivalent nodal load vector from $\\boldsymbol{\\varepsilon}_\\mathrm{g}$.\n- **Outputs**: For each test case, report:\n    1. Maximum nodal displacement magnitude, $u_\\mathrm{max} = \\max_i \\sqrt{u_{x,i}^2 + u_{y,i}^2}$.\n    2. Average von Mises stress, $\\overline{\\sigma_\\mathrm{vm}}$, over all Gaussian points. $\\sigma_\\mathrm{vm} = \\sqrt{\\sigma_{xx}^2 - \\sigma_{xx}\\sigma_{yy} + \\sigma_{yy}^2 + 3 \\tau_{xy}^2}$.\n- **Test Cases**: Four specific sets of parameters ($L_x, L_y, N_x, N_y, E, \\nu, \\Delta t, \\dot{\\mathbf{F}}_\\mathrm{g}$) are provided.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem statement is critically evaluated against the established criteria:\n\n1.  **Scientifically Grounded**: The problem is firmly rooted in the principles of continuum mechanics and biomechanics. The concepts of multiplicative decomposition of the deformation gradient, eigenstrain, linear elasticity, plane stress, and the Finite Element Method are standard and well-established in these fields. The model of tissue growth as an eigenstrain is a common and valid approach in growth and remodeling theory.\n\n2.  **Well-Posed**: The problem is a standard linear elastostatic problem with inhomogeneous (due to eigenstrain) terms and mixed (Dirichlet and Neumann) boundary conditions. The presence of sufficient Dirichlet boundary conditions (a fully clamped edge) prevents rigid body motion and ensures that the stiffness matrix $\\mathbf{K}$ is non-singular after applying BCs, guaranteeing a unique solution for the displacement field $\\mathbf{u}$.\n\n3.  **Objective**: The problem is stated using precise, unambiguous mathematical and engineering terminology. All parameters and conditions are quantified, and the required outputs are explicitly defined. There are no subjective or opinion-based statements.\n\n4.  **Self-Contained and Consistent**: The problem provides all necessary information to construct a numerical solution. This includes the geometry, material properties, boundary conditions, growth law, discretization details (element type, quadrature rule), and specific test data. There are no internal contradictions.\n\n5.  **Realistic and Feasible**: The provided material properties ($E, \\nu$) and growth rates are within a plausible range for soft biological tissues. The problem setup is a standard benchmark-type problem that is computationally feasible.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. It is a clear, consistent, and scientifically sound problem in computational biomechanics. I will proceed to develop a complete solution.\n\n### FEM Implementation Strategy\n\nThe solution involves implementing a 2D FEM solver for plane stress. The key steps are:\n\n1.  **Mesh Generation**: A structured grid of $N_x \\times N_y$ bilinear quadrilateral elements is generated, defining nodal coordinates and element connectivity.\n2.  **Preprocessing**:\n    - The plane stress constitutive matrix $\\mathbb{D}$ is formulated from $E$ and $\\nu$.\n    - The eigenstrain tensor $\\boldsymbol{\\varepsilon}_\\mathrm{g}$ is computed from the given growth rate tensor $\\dot{\\mathbf{F}}_\\mathrm{g}$ and time step $\\Delta t$, and then converted to Voigt notation $[\\varepsilon_{\\mathrm{g},xx}, \\varepsilon_{\\mathrm{g},yy}, 2\\varepsilon_{\\mathrm{g},xy}]^\\top$.\n3.  **System Assembly**:\n    - The global stiffness matrix $\\mathbf{K}$ and force vector $\\mathbf{f}_\\mathrm{g}$ are initialized with zeros.\n    - Each element is visited. For each element, the element stiffness matrix $\\mathbf{K}_e$ and element force vector $\\mathbf{f}_{\\mathrm{g},e}$ are computed using $2 \\times 2$ Gaussian quadrature.\n    - The element stiffness matrix is given by $\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbb{D} \\mathbf{B} \\, d\\Omega$.\n    - The element force vector due to eigenstrain is $\\mathbf{f}_{\\mathrm{g},e} = \\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbb{D} \\boldsymbol{\\varepsilon}_\\mathrm{g} \\, d\\Omega$.\n    - $\\mathbf{B}$ is the discrete strain-displacement matrix, which depends on the derivatives of the shape functions. The integrals are evaluated numerically.\n    - $\\mathbf{K}_e$ and $\\mathbf{f}_{\\mathrm{g},e}$ are assembled into the global system $\\mathbf{K}$ and $\\mathbf{f}_\\mathrm{g}$.\n4.  **Application of Boundary Conditions**: The Dirichlet boundary conditions ($u_x=u_y=0$ on the left edge) are enforced by modifying the global system of equations. A standard method is to zero out the rows and columns corresponding to the constrained degrees of freedom (DOFs) in $\\mathbf{K}$, place a $1$ on the diagonal, and set the corresponding entry in $\\mathbf{f}_\\mathrm{g}$ to $0$.\n5.  **Solution**: The linear system $\\mathbf{K} \\mathbf{u} = \\mathbf{f}_\\mathrm{g}$ is solved for the vector of nodal displacements $\\mathbf{u}$.\n6.  **Post-processing**:\n    - The maximum displacement magnitude is found by iterating through all nodal displacements.\n    - Stresses are calculated at each Gauss point of every element using the formula $\\boldsymbol{\\sigma} = \\mathbb{D} (\\mathbf{B} \\mathbf{u}_e - \\boldsymbol{\\varepsilon}_\\mathrm{g})$, where $\\mathbf{u}_e$ is the vector of displacements for the element's nodes.\n    - The von Mises stress is then computed at each Gauss point.\n    - The final average von Mises stress is the arithmetic mean of all computed von Mises stress values, as the structured mesh and uniform quadrature result in equal weighting for all Gauss points.\n\nThis procedure is systematically applied to each of the four test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that processes all test cases.\n    \"\"\"\n\n    def fem_plane_stress_growth(Lx, Ly, Nx, Ny, E, nu, dt, Fg_dot):\n        \"\"\"\n        Performs a Finite Element analysis for a 2D plane stress problem\n        with eigenstrain due to growth.\n\n        Args:\n            Lx, Ly (float): Domain dimensions in meters.\n            Nx, Ny (int): Number of elements in each direction.\n            E (float): Young's modulus in Pascals.\n            nu (float): Poisson's ratio.\n            dt (float): Time step in seconds.\n            Fg_dot (np.ndarray): Growth rate tensor (2x2) in s^-1.\n\n        Returns:\n            list: [max_displacement_magnitude, average_von_mises_stress]\n        \"\"\"\n        # 1. Mesh Generation\n        num_nodes_x = Nx + 1\n        num_nodes_y = Ny + 1\n        num_nodes = num_nodes_x * num_nodes_y\n        num_elems = Nx * Ny\n\n        x_coords = np.linspace(0, Lx, num_nodes_x)\n        y_coords = np.linspace(0, Ly, num_nodes_y)\n        \n        node_coords = np.array([[xi, yi] for xi in x_coords for yi in y_coords])\n\n        elem_conn = []\n        for i in range(Nx):\n            for j in range(Ny):\n                n1 = i * num_nodes_y + j\n                n2 = (i + 1) * num_nodes_y + j\n                n3 = (i + 1) * num_nodes_y + (j + 1)\n                n4 = i * num_nodes_y + (j + 1)\n                elem_conn.append([n1, n2, n3, n4])\n        elem_conn = np.array(elem_conn, dtype=int)\n\n        # 2. Material and Growth Properties\n        D = (E / (1 - nu**2)) * np.array([\n            [1, nu, 0],\n            [nu, 1, 0],\n            [0, 0, (1 - nu) / 2]\n        ])\n        \n        eps_g_tensor = 0.5 * (Fg_dot + Fg_dot.T) * dt\n        eps_g_voigt = np.array([eps_g_tensor[0, 0], eps_g_tensor[1, 1], 2 * eps_g_tensor[0, 1]])\n\n        # 3. FEM Assembly\n        K = np.zeros((2 * num_nodes, 2 * num_nodes))\n        f_g = np.zeros(2 * num_nodes)\n        \n        gp_coord = 1.0 / np.sqrt(3)\n        gauss_points = [(-gp_coord, -gp_coord), (gp_coord, -gp_coord), (gp_coord, gp_coord), (-gp_coord, gp_coord)]\n        gauss_weights = [1.0, 1.0, 1.0, 1.0]\n\n        for e in range(num_elems):\n            node_indices = elem_conn[e, :]\n            el_node_coords = node_coords[node_indices, :]\n            \n            Ke = np.zeros((8, 8))\n            fe = np.zeros(8)\n            \n            dof_map = np.empty(8, dtype=int)\n            for i in range(4):\n                dof_map[2*i] = 2 * node_indices[i]\n                dof_map[2*i + 1] = 2 * node_indices[i] + 1\n            \n            for i, (xi, eta) in enumerate(gauss_points):\n                w = gauss_weights[i]\n                \n                N_d_xi = 0.25 * np.array([-(1 - eta), (1 - eta), (1 + eta), -(1 + eta)])\n                N_d_eta = 0.25 * np.array([-(1 - xi), -(1 + xi), (1 + xi), (1 - xi)])\n                \n                J = np.dot(np.vstack((N_d_xi, N_d_eta)), el_node_coords)\n                detJ = np.linalg.det(J)\n                invJ = np.linalg.inv(J)\n                \n                N_d_xy = np.dot(invJ, np.vstack((N_d_xi, N_d_eta)))\n                \n                B = np.zeros((3, 8))\n                for j in range(4):\n                    B[0, 2*j] = N_d_xy[0, j]\n                    B[1, 2*j + 1] = N_d_xy[1, j]\n                    B[2, 2*j] = N_d_xy[1, j]\n                    B[2, 2*j + 1] = N_d_xy[0, j]\n                \n                Ke += w * (B.T @ D @ B) * detJ\n                fe += w * (B.T @ D @ eps_g_voigt) * detJ\n            \n            K[np.ix_(dof_map, dof_map)] += Ke\n            f_g[np.ix_(dof_map)] += fe\n\n        # 4. Apply Boundary Conditions\n        constrained_dofs = []\n        for j in range(num_nodes_y):\n            # Nodes on the left edge (x=0) have indices 0, 1, ..., Ny\n            node_id = j\n            constrained_dofs.extend([2 * node_id, 2 * node_id + 1])\n        \n        for dof in constrained_dofs:\n            K[dof, :] = 0\n            K[:, dof] = 0\n            K[dof, dof] = 1.0\n            f_g[dof] = 0.0\n\n        # 5. Solve for nodal displacements\n        u = np.linalg.solve(K, f_g)\n\n        # 6. Post-processing\n        # Max displacement magnitude\n        u_reshaped = u.reshape((num_nodes, 2))\n        u_max = np.max(np.linalg.norm(u_reshaped, axis=1))\n\n        # Average von Mises stress\n        vm_stresses = []\n        for e in range(num_elems):\n            node_indices = elem_conn[e, :]\n            el_node_coords = node_coords[node_indices, :]\n            \n            dof_map = np.empty(8, dtype=int)\n            for i in range(4):\n                dof_map[2*i] = 2 * node_indices[i]\n                dof_map[2*i + 1] = 2 * node_indices[i] + 1\n            u_e = u[dof_map]\n\n            for xi, eta in gauss_points:\n                N_d_xi = 0.25 * np.array([-(1 - eta), (1 - eta), (1 + eta), -(1 + eta)])\n                N_d_eta = 0.25 * np.array([-(1 - xi), -(1 + xi), (1 + xi), (1 - xi)])\n                J = np.dot(np.vstack((N_d_xi, N_d_eta)), el_node_coords)\n                invJ = np.linalg.inv(J)\n                \n                N_d_xy = np.dot(invJ, np.vstack((N_d_xi, N_d_eta)))\n                \n                B = np.zeros((3, 8))\n                for j in range(4):\n                    B[0, 2*j] = N_d_xy[0, j]\n                    B[1, 2*j + 1] = N_d_xy[1, j]\n                    B[2, 2*j] = N_d_xy[1, j]\n                    B[2, 2*j + 1] = N_d_xy[0, j]\n\n                eps = B @ u_e\n                sigma_voigt = D @ (eps - eps_g_voigt)\n                \n                s_xx, s_yy, t_xy = sigma_voigt[0], sigma_voigt[1], sigma_voigt[2]\n                s_vm = np.sqrt(s_xx**2 - s_xx*s_yy + s_yy**2 + 3*t_xy**2)\n                vm_stresses.append(s_vm)\n        \n        avg_vm = np.mean(vm_stresses) if vm_stresses else 0.0\n        \n        return [float(u_max), float(avg_vm)]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: uniform isotropic growth\n        {'Lx': 0.1, 'Ly': 0.1, 'Nx': 2, 'Ny': 2, 'E': 50000, 'nu': 0.3, 'dt': 10, 'Fg_dot': 0.001 * np.eye(2)},\n        # Case 2: anisotropic growth along x\n        {'Lx': 0.1, 'Ly': 0.1, 'Nx': 2, 'Ny': 2, 'E': 80000, 'nu': 0.45, 'dt': 10, 'Fg_dot': np.diag([0.002, 0.0])},\n        # Case 3: pure shear growth\n        {'Lx': 0.1, 'Ly': 0.1, 'Nx': 2, 'Ny': 2, 'E': 50000, 'nu': 0.3, 'dt': 10, 'Fg_dot': np.array([[0, 0.001], [0.001, 0]])},\n        # Case 4: no growth (consistency check)\n        {'Lx': 0.1, 'Ly': 0.1, 'Nx': 2, 'Ny': 2, 'E': 50000, 'nu': 0.3, 'dt': 0, 'Fg_dot': 0.001 * np.eye(2)},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = fem_plane_stress_growth(**case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}