{
    "hands_on_practices": [
        {
            "introduction": "Before a cohesive food bolus can be transported, the propulsive forces from the tongue must overcome the material's internal resistance to flow. This practice explores the concept of yield stress, a critical property defining the threshold for motion in many foods. By modeling the bolus as a Herschel-Bulkley fluid, you will determine the minimum tongue pressure required to initiate transport, providing a foundational understanding of how material properties dictate the initial biomechanical challenge of a swallow .",
            "id": "4207371",
            "problem": "A cohesive food bolus residing between the anterior tongue surface and the hard palate is commonly modeled as a yield-stress fluid following the Herschel–Bulkley (HB) constitutive law. The HB relation for the shear stress is given by $\\tau=\\tau_{y}+K\\dot{\\gamma}^{n}$, where $\\tau$ is shear stress, $\\tau_{y}$ is the yield stress, $K$ is the consistency index, $\\dot{\\gamma}$ is the shear rate, and $n$ is the flow index. Consider the onset of bolus transport during the oral phase of swallowing, when the tongue generates a peak pressure $p$ over an effective anterior–posterior contact length $L$, with the bolus confined to a thin film of half-gap $h$ between the tongue and palate. Under thin-film lubrication conditions and static onset (negligible inertia), a commonly used local shear stress estimate relates the pressure field to shear stress by $\\tau \\approx ph/L$. Assume gravity is negligible relative to the tongue-generated pressure and that the bolus is initially at rest.\n\nStarting from fundamental definitions and the HB relation, derive the minimum required peak tongue pressure $p_{\\text{min}}$ that will initiate flow in the bolus. Express your final answer as a single closed-form analytic expression in terms of $\\tau_{y}$, $K$, $n$, $L$, and $h$. The expression should be valid at the instant of flow initiation under the stated assumptions. Express the minimum peak tongue pressure in Pascals. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of the minimum peak tongue pressure, $p_{\\text{min}}$, necessary to initiate flow in a cohesive food bolus. The bolus is modeled as a yield-stress fluid adhering to the Herschel–Bulkley (HB) constitutive law, confined between the tongue and the hard palate.\n\nFirst, we state the given Herschel–Bulkley relation for the shear stress $\\tau$:\n$$\n\\tau = \\tau_{y} + K\\dot{\\gamma}^{n}\n$$\nwhere $\\tau_{y}$ is the yield stress, $K$ is the consistency index, $\\dot{\\gamma}$ is the shear rate, and $n$ is the flow index. This equation describes the rheological behavior of the material. A key feature of a yield-stress fluid is that it behaves as a rigid solid when the applied shear stress is below the yield stress, and it flows like a fluid only when the shear stress exceeds this threshold.\n\nThe condition for the material to remain in a solid-like state (unyielded) is $\\tau  \\tau_{y}$. In this regime, there is no flow, which means the shear rate is zero: $\\dot{\\gamma}=0$.\n\nThe condition for the material to flow (yield) is $\\tau \\ge \\tau_{y}$. When this condition is met, the shear rate becomes non-zero, and its magnitude is determined by the HB equation, rearranged as $\\dot{\\gamma} = \\left(\\frac{\\tau - \\tau_{y}}{K}\\right)^{1/n}$.\n\nThe problem asks for the condition to *initiate* flow. Flow initiation is the transition point between the solid-like (static) state and the fluid-like (flowing) state. This transition occurs at the minimum stress required to cause yielding. Therefore, the onset of flow corresponds precisely to the moment the applied shear stress $\\tau$ reaches the yield stress $\\tau_{y}$. The minimum condition for flow is thus:\n$$\n\\tau = \\tau_{y}\n$$\nAt this exact threshold, the shear rate $\\dot{\\gamma}$ is effectively zero, as flow has not yet developed. Substituting $\\dot{\\gamma}=0$ into the full HB equation confirms this: $\\tau = \\tau_y + K(0)^n = \\tau_y$. This shows that the parameters $K$ and $n$, which characterize the fluid's viscosity after it has yielded, are not relevant for determining the pressure at the moment of flow initiation.\n\nNext, we use the relationship provided in the problem statement, which connects the shear stress $\\tau$ to the peak tongue pressure $p$, the effective contact length $L$, and the half-gap thickness $h$. This is given as a local shear stress estimate under thin-film lubrication conditions:\n$$\n\\tau = \\frac{ph}{L}\n$$\nTo find the minimum pressure, $p_{\\text{min}}$, required to initiate flow, we must apply a shear stress equal to the yield stress, $\\tau_y$. We substitute $\\tau = \\tau_y$ and $p = p_{\\text{min}}$ into the provided stress-pressure relation:\n$$\n\\tau_{y} = \\frac{p_{\\text{min}}h}{L}\n$$\nThe final step is to solve this equation for $p_{\\text{min}}$. Multiplying both sides by $L$ and dividing by $h$, we obtain the expression for the minimum required peak tongue pressure:\n$$\np_{\\text{min}} = \\frac{L\\tau_{y}}{h}\n$$\nThis is the closed-form analytic expression for the minimum pressure needed to make the bolus yield and begin to flow, expressed in terms of the material's yield stress $\\tau_y$ and the geometric parameters $h$ and $L$. Per the physical reasoning, this threshold pressure does not depend on the post-yield flow parameters $K$ and $n$. The units are consistent: if $\\tau_y$ is in Pascals ($Pa$), and $h$ and $L$ are in meters ($m$), then $p_{\\text{min}}$ will be in Pascals, as required.",
            "answer": "$$\\boxed{\\frac{L\\tau_{y}}{h}}$$"
        },
        {
            "introduction": "Once bolus flow begins, the pharyngeal constrictor muscles perform mechanical work to propel it towards the esophagus. This exercise provides a method to quantify this physiological effort by integrating the instantaneous power—the product of driving pressure $p(t)$ and volumetric flow rate $Q(t)$—over the duration of the swallow. By analyzing and comparing the work required for a thin liquid versus a viscous puree, you will connect bolus rheology to the metabolic cost of swallowing, a crucial concept for understanding swallowing efficiency and the physiological burden associated with dysphagia .",
            "id": "4207319",
            "problem": "A swallow is modeled as quasi-static propulsion of an incompressible bolus through the pharynx by pharyngeal constrictor muscles, where the mechanical work performed on the bolus is the pressure–volume work defined by the integral $$W=\\int p\\,dV$$ taken over the volume displaced during the swallow. Consider two bolus types with equal final displaced volume $V_{f}$: a thin liquid and a viscous puree. For each bolus type, the intrabolus driving pressure is represented by $$p(t)=p_{b}+A\\exp\\!\\left(-\\frac{t}{\\theta}\\right),$$ and the volumetric flow rate is modeled by $$Q(t)=\\frac{V_{f}}{\\tau}\\exp\\!\\left(-\\frac{t}{\\tau}\\right),$$ where $p_{b}$ is a baseline pharyngeal pressure, $A$ is the pressure pulse amplitude, $\\theta$ is the pressure decay time constant, and $\\tau$ is the flow decay time constant. The mechanical work of swallowing is $W=\\int_{0}^{\\infty}p(t)\\,Q(t)\\,dt$, and the metabolic energy expenditure is related to mechanical work by $$E_{\\text{met}}=\\frac{W}{\\eta},$$ where $\\eta$ is the net muscle mechanical efficiency. Assume the following parameter values, which are physiologically plausible and derived from manometry and flow tracking:\n\n- For both bolus types, the displaced volume is $V_{f}=20\\,\\mathrm{mL}$ and the baseline pressure is $p_{b}=10\\,\\text{millimeters of mercury (mmHg)}$.\n- Thin liquid: $A=90\\,\\text{mmHg}$, $\\theta=0.25\\,\\mathrm{s}$, $\\tau=0.20\\,\\mathrm{s}$, $\\eta=0.25$.\n- Viscous puree: $A=120\\,\\text{mmHg}$, $\\theta=0.30\\,\\mathrm{s}$, $\\tau=0.35\\,\\mathrm{s}$, $\\eta=0.18$.\n\nStarting from the definitions above and fundamental laws, derive the mechanical work for each bolus by integrating pressure over volume displacement, then compute the corresponding metabolic energy expenditures. Finally, compute the ratio of metabolic energy expenditure of the viscous puree to that of the thin liquid. Round your final ratio to four significant figures and express it as a decimal number with no units.",
            "solution": "The user has requested the derivation and computation of the ratio of metabolic energy expenditures for swallowing two different bolus types. The problem is scientifically grounded, well-posed, and all necessary parameters are provided.\n\nThe mechanical work $W$ performed during the swallow is given by the integral of power, $p(t)Q(t)$, over the duration of the swallow, which is modeled from $t=0$ to $t=\\infty$.\n$$W = \\int_{0}^{\\infty} p(t) Q(t) \\, dt$$\nThe pressure $p(t)$ and volumetric flow rate $Q(t)$ are given by the expressions:\n$$p(t) = p_{b} + A \\exp\\left(-\\frac{t}{\\theta}\\right)$$\n$$Q(t) = \\frac{V_{f}}{\\tau} \\exp\\left(-\\frac{t}{\\tau}\\right)$$\nSubstituting these expressions into the integral for work yields:\n$$W = \\int_{0}^{\\infty} \\left( p_{b} + A \\exp\\left(-\\frac{t}{\\theta}\\right) \\right) \\left( \\frac{V_{f}}{\\tau} \\exp\\left(-\\frac{t}{\\tau}\\right) \\right) \\, dt$$\nWe can expand the integrand and separate the integral into two parts:\n$$W = \\frac{V_{f}}{\\tau} \\int_{0}^{\\infty} \\left( p_{b} \\exp\\left(-\\frac{t}{\\tau}\\right) + A \\exp\\left(-\\frac{t}{\\theta}\\right) \\exp\\left(-\\frac{t}{\\tau}\\right) \\right) \\, dt$$\nUsing the property of exponents $\\exp(a)\\exp(b) = \\exp(a+b)$, we combine the exponential terms in the second part of the integrand:\n$$W = \\frac{V_{f}}{\\tau} \\left( \\int_{0}^{\\infty} p_{b} \\exp\\left(-\\frac{t}{\\tau}\\right) \\, dt + \\int_{0}^{\\infty} A \\exp\\left(-t\\left(\\frac{1}{\\theta} + \\frac{1}{\\tau}\\right)\\right) \\, dt \\right)$$\nWe evaluate the two definite integrals. The general form of the integral is $\\int_{0}^{\\infty} \\exp(-kt) \\, dt = \\frac{1}{k}$ for $k > 0$.\nFor the first integral, the rate constant is $k_1 = \\frac{1}{\\tau}$. The integral evaluates to:\n$$\\int_{0}^{\\infty} \\exp\\left(-\\frac{t}{\\tau}\\right) \\, dt = \\left[ -\\tau \\exp\\left(-\\frac{t}{\\tau}\\right) \\right]_{0}^{\\infty} = 0 - (-\\tau) = \\tau$$\nFor the second integral, the rate constant is $k_2 = \\frac{1}{\\theta} + \\frac{1}{\\tau} = \\frac{\\theta + \\tau}{\\theta \\tau}$. The integral evaluates to:\n$$\\int_{0}^{\\infty} \\exp\\left(-t\\left(\\frac{1}{\\theta} + \\frac{1}{\\tau}\\right)\\right) \\, dt = \\frac{1}{\\frac{1}{\\theta} + \\frac{1}{\\tau}} = \\frac{\\theta \\tau}{\\theta + \\tau}$$\nSubstituting these results back into the expression for $W$:\n$$W = \\frac{V_{f}}{\\tau} \\left( p_{b} (\\tau) + A \\left(\\frac{\\theta \\tau}{\\theta + \\tau}\\right) \\right)$$\nSimplifying by factoring out $\\tau$ from the parentheses:\n$$W = V_{f} \\left( p_{b} + A \\frac{\\theta}{\\theta + \\tau} \\right)$$\nThis is the general symbolic expression for the mechanical work.\n\nNext, we calculate the work for each bolus type using the provided parameters. Note that since we are calculating a ratio, the units of pressure (mmHg) and volume (mL) will cancel, so no conversion to SI units is necessary.\n\nFor the thin liquid:\n$V_{f} = 20\\,\\mathrm{mL}$, $p_{b} = 10\\,\\mathrm{mmHg}$, $A_{\\text{liquid}} = 90\\,\\mathrm{mmHg}$, $\\theta_{\\text{liquid}} = 0.25\\,\\mathrm{s}$, $\\tau_{\\text{liquid}} = 0.20\\,\\mathrm{s}$.\n$$W_{\\text{liquid}} = 20 \\left( 10 + 90 \\frac{0.25}{0.25 + 0.20} \\right) = 20 \\left( 10 + 90 \\frac{0.25}{0.45} \\right)$$\n$$W_{\\text{liquid}} = 20 \\left( 10 + 90 \\frac{5}{9} \\right) = 20 (10 + 50) = 20 \\times 60 = 1200 \\, \\text{mmHg} \\cdot \\text{mL}$$\n\nFor the viscous puree:\n$V_{f} = 20\\,\\mathrm{mL}$, $p_{b} = 10\\,\\mathrm{mmHg}$, $A_{\\text{puree}} = 120\\,\\mathrm{mmHg}$, $\\theta_{\\text{puree}} = 0.30\\,\\mathrm{s}$, $\\tau_{\\text{puree}} = 0.35\\,\\mathrm{s}$.\n$$W_{\\text{puree}} = 20 \\left( 10 + 120 \\frac{0.30}{0.30 + 0.35} \\right) = 20 \\left( 10 + 120 \\frac{0.30}{0.65} \\right)$$\n$$W_{\\text{puree}} = 20 \\left( 10 + 120 \\frac{30}{65} \\right) = 20 \\left( 10 + 120 \\frac{6}{13} \\right) = 20 \\left( \\frac{130}{13} + \\frac{720}{13} \\right)$$\n$$W_{\\text{puree}} = 20 \\left( \\frac{850}{13} \\right) = \\frac{17000}{13} \\, \\text{mmHg} \\cdot \\text{mL}$$\n\nThe metabolic energy expenditure $E_{\\text{met}}$ is related to the mechanical work $W$ by the muscle efficiency $\\eta$:\n$$E_{\\text{met}} = \\frac{W}{\\eta}$$\nWe are asked to find the ratio $R$ of the metabolic energy expenditure for the viscous puree to that of the thin liquid.\n$$R = \\frac{E_{\\text{met, puree}}}{E_{\\text{met, liquid}}} = \\frac{W_{\\text{puree}} / \\eta_{\\text{puree}}}{W_{\\text{liquid}} / \\eta_{\\text{liquid}}} = \\left( \\frac{W_{\\text{puree}}}{W_{\\text{liquid}}} \\right) \\left( \\frac{\\eta_{\\text{liquid}}}{\\eta_{\\text{puree}}} \\right)$$\nThe efficiencies are given as $\\eta_{\\text{liquid}} = 0.25$ and $\\eta_{\\text{puree}} = 0.18$.\nSubstituting the calculated values for work and the given efficiencies:\n$$R = \\left( \\frac{17000/13}{1200} \\right) \\left( \\frac{0.25}{0.18} \\right)$$\n$$R = \\frac{17000}{13 \\times 1200} \\times \\frac{25}{18} = \\frac{170}{13 \\times 12} \\times \\frac{25}{18}$$\n$$R = \\frac{85}{78} \\times \\frac{25}{18} = \\frac{2125}{1404}$$\nNow, we compute the numerical value and round to four significant figures.\n$$R \\approx 1.51353276...$$\nRounding to four significant figures gives $1.514$.",
            "answer": "$$ \\boxed{1.514} $$"
        },
        {
            "introduction": "Biomechanical analysis frequently involves estimating physiological parameters from experimental data, a process that can be challenging due to noise and data limitations. This computational exercise tackles a classic inverse problem: determining the compliance of the Upper Esophageal Sphincter (UES) from pressure-area measurements. You will investigate the concept of parameter identifiability and implement regularization techniques to derive stable and physically meaningful results from an ill-posed system, bridging the gap between theoretical models and real-world data analysis .",
            "id": "4207331",
            "problem": "Consider the Upper Esophageal Sphincter (UES) as a short, approximately axisymmetric segment whose cross-sectional area responds to intraluminal pressure during swallowing. Assume quasi-static equilibrium where inertial terms are negligible relative to tissue stiffness and viscous effects. The fundamental base is: tissue deformation at small strains relates approximately linearly to transmural pressure via a compliance parameter. Define compliance as $C = \\frac{dA}{dP_{\\mathrm{tm}}}$ where $A$ is cross-sectional area and $P_{\\mathrm{tm}}$ is transmural pressure; in the present setting use intraluminal pressure $P$ as a proxy for $P_{\\mathrm{tm}}$ under the assumption of approximately constant extraluminal pressure. For small excursions around a reference pressure $P_{\\mathrm{ref}}$, model the area as $A \\approx A_{0} + C (P - P_{\\mathrm{ref}})$, where $A_{0}$ is the area at $P_{\\mathrm{ref}}$, and $C$ is the (approximately constant) compliance in units of $\\mathrm{mm}^{2}/\\mathrm{kPa}$.\n\nYou are to analyze the identifiability of $C$ from paired pressure–area samples and to implement regularization strategies when the inverse problem is ill-posed. Identifiability in the sense of unique recoverability from linear measurements is determined by the rank of the design matrix and the conditioning of the normal equations. Specifically, if the design matrix $X$ samples both the offset and the pressure variation sufficiently, then $\\mathrm{rank}(X)$ is full and the condition number $\\kappa(X^{\\top} X)$ is moderate; otherwise the inverse problem is ill-posed. When ill-posed, use Tikhonov-type regularization to stabilize the inverse, either by penalizing parameter magnitude (ridge) or enforcing smoothness in time-varying compliance estimates.\n\nImplement the following tasks in a single program:\n\n- Task $1$ (constant compliance model and identifiability): Given paired samples $\\left(P_{i}, A_{i}\\right)$ for $i \\in \\left\\{1,\\dots,N\\right\\}$, set $P_{\\mathrm{ref}}$ equal to the mean of the sampled pressures. Form the linear system $A \\approx A_{0} + C (P - P_{\\mathrm{ref}})$ as a regression with design matrix $X \\in \\mathbb{R}^{N \\times 2}$ whose first column is $1$ and whose second column is $P - P_{\\mathrm{ref}}$. Declare $C$ identifiable if and only if $\\mathrm{rank}(X) = 2$ and $\\kappa(X^{\\top} X) \\le \\tau$, where the threshold is $\\tau = 10^{7}$. If identifiable, compute the least squares estimate; if not identifiable, compute a ridge-regularized estimate by minimizing $\\|X \\theta - A\\|_{2}^{2} + \\lambda_{\\mathrm{ridge}} \\|\\theta\\|_{2}^{2}$ with $\\lambda_{\\mathrm{ridge}} = 1.0$, where $\\theta = [A_{0}, C]^{\\top}$. Report the estimated $C$ in $\\mathrm{mm}^{2}/\\mathrm{kPa}$.\n\n- Task $2$ (time-varying compliance and smoothness regularization): For a sequence of samples $\\left(P_{i}, A_{i}\\right)$, $i \\in \\left\\{1,\\dots,N\\right\\}$, assume $A \\approx A_{0} + C_{i} (P_{i} - P_{\\mathrm{ref}})$ with a potentially time-varying compliance $C_{i}$. Construct the linear system with unknowns $\\theta = [A_{0}, C_{1}, \\dots, C_{N}]^{\\top}$ and design matrix $X \\in \\mathbb{R}^{N \\times (N+1)}$ having the first column equal to $1$ and the $(i+1)$-th column equal to a vector with a single nonzero entry at row $i$ of value $(P_{i} - P_{\\mathrm{ref}})$. Since this system is underdetermined, compute a Tikhonov-smooth estimate by minimizing $\\|X \\theta - A\\|_{2}^{2} + \\lambda_{\\mathrm{smooth}} \\|L C\\|_{2}^{2} + \\alpha A_{0}^{2}$, where $C = [C_{1},\\dots,C_{N}]^{\\top}$, $L \\in \\mathbb{R}^{(N-1) \\times N}$ is the first-order difference operator with rows implementing $C_{i+1} - C_{i}$, $\\lambda_{\\mathrm{smooth}} = 100.0$, and $\\alpha = 10^{-6}$. Report the estimated vector $\\hat{C} = [\\hat{C}_{1},\\dots,\\hat{C}_{N}]$ in $\\mathrm{mm}^{2}/\\mathrm{kPa}$.\n\nPhysical units: Pressure must be in $\\mathrm{kPa}$, area must be in $\\mathrm{mm}^{2}$, and compliance must be in $\\mathrm{mm}^{2}/\\mathrm{kPa}$. Angles are not used. All percentages, if any, must be represented as decimals or fractions; no percentage signs appear in this problem.\n\nTest suite and data to be used by your program:\n\n- Test case $1$ (happy path, identifiable constant compliance): $P = [\\,4,\\,6,\\,8,\\,10,\\,12\\,]$ in $\\mathrm{kPa}$ and $A = [\\,8,\\,24,\\,40,\\,56,\\,72\\,]$ in $\\mathrm{mm}^{2}$.\n\n- Test case $2$ (boundary case, zero variation in pressure, non-identifiable without regularization): $P = [\\,8,\\,8,\\,8,\\,8,\\,8\\,]$ in $\\mathrm{kPa}$ and $A = [\\,39,\\,40,\\,41,\\,38,\\,40\\,]$ in $\\mathrm{mm}^{2}$.\n\n- Test case $3$ (edge case, near-zero variation in pressure, ill-conditioned): $P = [\\,8.0,\\,8.0001,\\,7.9999,\\,8.0002,\\,7.9998\\,]$ in $\\mathrm{kPa}$ and $A = [\\,40.0,\\,40.0008,\\,39.9992,\\,40.0016,\\,39.9984\\,]$ in $\\mathrm{mm}^{2}$.\n\n- Test case $4$ (under-determined time-varying compliance requiring smoothness regularization): $P = [\\,3,\\,4,\\,5,\\,6,\\,7,\\,6,\\,5,\\,4,\\,3,\\,2\\,]$ in $\\mathrm{kPa}$ and $A = [\\,22.5,\\,27.5,\\,33.0,\\,39.0,\\,47.5,\\,40.5,\\,33.0,\\,27.0,\\,22.5,\\,17.5\\,]$ in $\\mathrm{mm}^{2}$.\n\nYour program must:\n\n- For test cases $1$–$3$, compute a boolean identifiability flag and a scalar compliance estimate $\\hat{C}$ in $\\mathrm{mm}^{2}/\\mathrm{kPa}$.\n\n- For test case $4$, compute a boolean identifiability flag (with respect to the unregularized system) and the vector of regularized compliance estimates $\\hat{C}_{i}$ in $\\mathrm{mm}^{2}/\\mathrm{kPa}$ for $i \\in \\left\\{1,\\dots,10\\right\\}$.\n\nFinal output format requirement: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list. The first three inner lists must be of the form $[\\mathrm{flag},\\,\\hat{C}]$, and the fourth inner list must be of the form $[\\mathrm{flag},\\,[\\hat{C}_{1},\\dots,\\hat{C}_{10}]]$. For example, an output meeting the format requirement has the structure $[[\\mathrm{flag}_{1},\\,c_{1}],[\\mathrm{flag}_{2},\\,c_{2}],[\\mathrm{flag}_{3},\\,c_{3}],[\\mathrm{flag}_{4},\\,[c_{4,1},\\dots,c_{4,10}]]]$.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of biomechanics and system identification, using a standard linear approximation for tissue compliance. The problem is well-posed, providing two distinct, mathematically formal tasks complete with all necessary data, parameters, and objective criteria for identifiability. The language is precise and objective, and the provided data are physically consistent and plausible. The problem addresses the concept of ill-posedness by prescribing specific, appropriate regularization techniques (ridge and Tikhonov smoothness), which is a standard approach in inverse problems. Therefore, a reasoned solution will be provided.\n\nThe solution is divided into two parts, corresponding to the two tasks defined in the problem.\n\n### Task 1: Constant Compliance Model\n\nThe underlying physical model assumes a linear relationship between the cross-sectional area $A$ and the intraluminal pressure $P$ for small deviations around a reference pressure $P_{\\mathrm{ref}}$:\n$$\nA \\approx A_{0} + C (P - P_{\\mathrm{ref}})\n$$\nwhere $A_{0}$ is the baseline area at $P_{\\mathrm{ref}}$ and $C$ is the constant compliance. Given $N$ paired measurements $(P_i, A_i)$, we set up a linear regression problem. Let $P_{\\mathrm{ref}}$ be the mean pressure, $P_{\\mathrm{ref}} = \\frac{1}{N} \\sum_{i=1}^{N} P_i$. The system of equations for all measurements can be written in matrix form as:\n$$\n\\mathbf{A} \\approx X \\theta\n$$\nwhere:\n- $\\mathbf{A} = [A_1, A_2, \\dots, A_N]^{\\top}$ is the vector of area measurements.\n- $\\theta = [A_0, C]^{\\top}$ is the vector of unknown parameters to be estimated.\n- $X$ is the $N \\times 2$ design matrix, with the first column consisting of ones to account for the offset $A_0$, and the second column containing the pressure deviations.\n$$\nX = \\begin{pmatrix} 1  P_1 - P_{\\mathrm{ref}} \\\\ 1  P_2 - P_{\\mathrm{ref}} \\\\ \\vdots  \\vdots \\\\ 1  P_N - P_{\\mathrm{ref}} \\end{pmatrix}\n$$\n\nThe identifiability of the parameter vector $\\theta$ (and thus the compliance $C$) is determined by the properties of the design matrix $X$.\n1.  **Rank Condition**: For a unique solution to exist in the least-squares sense, the columns of $X$ must be linearly independent, which means $\\mathrm{rank}(X)$ must equal the number of columns, i.e., $\\mathrm{rank}(X) = 2$. This condition fails if the second column is a multiple of the first, which occurs only if all $P_i$ are identical, making $P_i - P_{\\mathrm{ref}} = 0$ for all $i$.\n2.  **Condition Number**: For the solution to be stable with respect to small perturbations in the data $\\mathbf{A}$, the normal matrix $X^{\\top}X$ must be well-conditioned. The condition number, $\\kappa(X^{\\top}X)$, measures this stability. A large condition number signifies an ill-conditioned problem where the solution is highly sensitive to noise. The problem specifies a threshold $\\tau = 10^7$ for this assessment.\n\n**Solution Method**:\n- **If Identifiable** ($\\mathrm{rank}(X) = 2$ and $\\kappa(X^{\\top}X) \\le \\tau$): The parameters are found by solving the ordinary least squares (OLS) problem, which minimizes the sum of squared residuals $\\|X\\theta - \\mathbf{A}\\|_2^2$. The solution is given by the normal equations:\n$$\n\\hat{\\theta}_{\\mathrm{OLS}} = (X^{\\top}X)^{-1} X^{\\top}\\mathbf{A}\n$$\n- **If Not Identifiable**: The problem is ill-posed. To obtain a stable solution, ridge regression (a form of Tikhonov regularization) is employed. This method minimizes a penalized sum of squares: $\\|X\\theta - \\mathbf{A}\\|_2^2 + \\lambda_{\\mathrm{ridge}}\\|\\theta\\|_2^2$. The penalty term $\\|\\theta\\|_2^2$ discourages overly large parameter values. With $\\lambda_{\\mathrm{ridge}} = 1.0$, the solution is:\n$$\n\\hat{\\theta}_{\\mathrm{ridge}} = (X^{\\top}X + \\lambda_{\\mathrm{ridge}}I)^{-1} X^{\\top}\\mathbf{A}\n$$\nwhere $I$ is the $2 \\times 2$ identity matrix.\n\nIn both cases, the estimated compliance is the second element of the solution vector, $\\hat{C} = \\hat{\\theta}[1]$.\n\n### Task 2: Time-Varying Compliance Model\n\nThis task allows the compliance to vary at each measurement instant, $C_i$. The model is:\n$$\nA_i \\approx A_0 + C_i (P_i - P_{\\mathrm{ref}})\n$$\nThis leads to a system of $N$ linear equations with $N+1$ unknowns: the constant offset $A_0$ and the $N$ individual compliances $C_1, \\dots, C_N$. The parameter vector is $\\theta = [A_0, C_1, \\dots, C_N]^{\\top}$. The design matrix $X \\in \\mathbb{R}^{N \\times (N+1)}$ is constructed such that the $i$-th row of the equation $X\\theta = \\mathbf{A}$ corresponds to the model for the $i$-th measurement.\n- The first column of $X$ is a vector of ones, corresponding to the single parameter $A_0$.\n- For $i \\in \\{1,\\dots,N\\}$, the $(i+1)$-th column of $X$ corresponds to the parameter $C_i$ and contains a single non-zero entry, $P_i - P_{\\mathrm{ref}}$, at the $i$-th row.\n$$\nX = \\begin{pmatrix}\n1  P_1-P_{\\mathrm{ref}}  0  \\cdots  0 \\\\\n1  0  P_2-P_{\\mathrm{ref}}  \\cdots  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots \\\\\n1  0  0  \\cdots  P_N-P_{\\mathrm{ref}}\n\\end{pmatrix}\n$$\nThis linear system is underdetermined, as it has more unknowns ($N+1$) than independent equations ($N$). Consequently, the unregularized problem has no unique solution, and $\\mathrm{rank}(X) \\le N  N+1$. It is inherently non-identifiable.\n\n**Solution Method**:\nTikhonov regularization is used to select a meaningful solution from the infinite set of possibilities. The objective is to find a $\\theta$ that not only fits the data but also exhibits smoothness in the compliance sequence $C_i$. The cost function to be minimized is:\n$$\nJ(\\theta) = \\|X\\theta - \\mathbf{A}\\|_2^2 + \\lambda_{\\mathrm{smooth}}\\|LC\\|_2^2 + \\alpha A_0^2\n$$\n- The first term is the data fidelity term.\n- The second term, with $\\lambda_{\\mathrm{smooth}} = 100.0$, is a smoothness penalty. $C = [C_1, \\dots, C_N]^{\\top}$ is the vector of compliances, and $L \\in \\mathbb{R}^{(N-1) \\times N}$ is the first-order difference operator matrix. It penalizes large differences between successive compliance values, $C_{i+1} - C_i$.\n$$\nL = \\begin{pmatrix}\n-1  1  0  \\cdots  0 \\\\\n0  -1  1  \\cdots  0 \\\\\n\\vdots  \\vdots  \\ddots  \\ddots  \\vdots \\\\\n0  0  \\cdots  -1  1\n\\end{pmatrix}\n$$\n- The third term, with $\\alpha = 10^{-6}$, is a small ridge penalty on the estimate of $A_0$ to ensure the full problem is well-posed.\n\nTo minimize $J(\\theta)$, we set its gradient with respect to $\\theta$ to zero. This leads to the modified normal equations:\n$$\n(X^{\\top}X + R)\\hat{\\theta} = X^{\\top}\\mathbf{A}\n$$\nwhere $R$ is an $(N+1) \\times (N+1)$ regularization matrix constructed from the penalty terms:\n$$\nR = \\begin{pmatrix}\n\\alpha  \\mathbf{0}_{1 \\times N} \\\\\n\\mathbf{0}_{N \\times 1}  \\lambda_{\\mathrm{smooth}} L^{\\top}L\n\\end{pmatrix}\n$$\nThe solution vector is obtained by solving this linear system:\n$$\n\\hat{\\theta} = (X^{\\top}X + R)^{-1} X^{\\top}\\mathbf{A}\n$$\nThe resulting vector of estimated compliances is $\\hat{C} = [\\hat{\\theta}_1, \\dots, \\hat{\\theta}_N]^{\\top}$, which are the elements of $\\hat{\\theta}$ from the second to the last.",
            "answer": "```python\nimport numpy as np\n\ndef task1(P, A, tau=1e7, lambda_ridge=1.0):\n    \"\"\"\n    Solves for constant compliance C, checking for identifiability.\n    \"\"\"\n    N = len(P)\n    P_ref = np.mean(P)\n    \n    X = np.ones((N, 2))\n    X[:, 1] = P - P_ref\n    \n    # Check for singularity before calculating condition number\n    if np.linalg.matrix_rank(X)  2:\n        identifiable = False\n        cond_num = np.inf\n    else:\n        # Calculate condition number of the normal matrix X^T * X\n        XTX = X.T @ X\n        cond_num = np.linalg.cond(XTX)\n        identifiable = (cond_num = tau)\n\n    if identifiable:\n        # OLS solution: (X^T * X)^-1 * X^T * A\n        theta = np.linalg.solve(X.T @ X, X.T @ A)\n    else:\n        # Ridge regression solution: (X^T * X + lambda * I)^-1 * X^T * A\n        I = np.eye(2)\n        theta = np.linalg.solve(X.T @ X + lambda_ridge * I, X.T @ A)\n        \n    C_hat = theta[1]\n    \n    # The flag must be a standard boolean True/False for the final output format.\n    return bool(identifiable), C_hat\n\ndef task2(P, A, lambda_smooth=100.0, alpha=1e-6):\n    \"\"\"\n    Solves for time-varying compliance C using Tikhonov smoothness regularization.\n    \"\"\"\n    N = len(P)\n    P_ref = np.mean(P)\n    \n    # The unregularized system is N x (N+1), so it's underdetermined\n    # and thus non-identifiable. The flag is always False.\n    identifiable = False\n    \n    # Construct the design matrix X\n    X = np.zeros((N, N + 1))\n    X[:, 0] = 1.0\n    pressure_diff = P - P_ref\n    # Add diagonal entries for C_i terms\n    np.fill_diagonal(X[:, 1:], pressure_diff)\n    \n    # Construct the first-order difference operator L\n    L = np.zeros((N - 1, N))\n    np.fill_diagonal(L, -1.0)\n    np.fill_diagonal(L[:, 1:], 1.0)\n    \n    # Construct the regularization matrix R\n    R = np.zeros((N + 1, N + 1))\n    R[0, 0] = alpha\n    R[1:, 1:] = lambda_smooth * (L.T @ L)\n    \n    # Solve the regularized normal equations: (X^T*X + R) * theta = X^T * A\n    M = X.T @ X + R\n    b = X.T @ A\n    theta = np.linalg.solve(M, b)\n    \n    C_hat_vec = theta[1:]\n    \n    return identifiable, C_hat_vec\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Identifiable constant compliance\n        (np.array([4.0, 6.0, 8.0, 10.0, 12.0]), np.array([8.0, 24.0, 40.0, 56.0, 72.0])),\n        # Case 2: Non-identifiable (zero pressure variation)\n        (np.array([8.0, 8.0, 8.0, 8.0, 8.0]), np.array([39.0, 40.0, 41.0, 38.0, 40.0])),\n        # Case 3: Ill-conditioned (near-zero pressure variation)\n        (np.array([8.0, 8.0001, 7.9999, 8.0002, 7.9998]), np.array([40.0, 40.0008, 39.9992, 40.0016, 39.9984])),\n        # Case 4: Time-varying compliance\n        (np.array([3.0, 4.0, 5.0, 6.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0]),\n         np.array([22.5, 27.5, 33.0, 39.0, 47.5, 40.5, 33.0, 27.0, 22.5, 17.5]))\n    ]\n    \n    results = []\n    \n    # Process tasks 1-3\n    for i in range(3):\n        P, A = test_cases[i]\n        flag, C = task1(P, A, tau=1e7, lambda_ridge=1.0)\n        results.append([flag, C])\n        \n    # Process task 4\n    P4, A4 = test_cases[3]\n    flag4, C4_vec = task2(P4, A4, lambda_smooth=100.0, alpha=1e-6)\n    results.append([flag4, C4_vec.tolist()])\n    \n    # Format the final output string as required.\n    def format_result(item):\n        flag_str = str(item[0])\n        val = item[1]\n        if isinstance(val, list):\n            val_str = '[' + ','.join(f'{v:.10f}' for v in val) + ']'\n        else:\n            val_str = f'{val:.10f}'\n        return f'[{flag_str},{val_str}]'\n\n    # The flag needs to be lowercase 'true' or 'false'\n    # Python's str(bool) gives 'True'/'False'. So we need to convert.\n    def format_result_lowercase_bool(item):\n        flag_str = str(item[0]).lower()\n        val = item[1]\n        if isinstance(val, list):\n            # Format numbers to a reasonable precision to avoid excessive length\n            # and ensure consistency.\n            val_str = '[' + ','.join(f'{v:.8f}' for v in val) + ']'\n        else:\n            val_str = f'{val:.8f}'\n        return f'[{flag_str},{val_str}]'\n\n    # The problem example shows True/False (capitalized), so str(bool) is fine\n    # Let's check format again. The example has flag_1, c_1. These are variables, not literal strings.\n    # Python's bool will be represented as True/False by print(). This format is most common.\n    # Let's build the string manually to ensure total control.\n    \n    output_parts = []\n    # Test case 1\n    output_parts.append(f'[{str(results[0][0])},{results[0][1]:.8f}]')\n    # Test case 2\n    output_parts.append(f'[{str(results[1][0])},{results[1][1]:.8f}]')\n    # Test case 3\n    output_parts.append(f'[{str(results[2][0])},{results[2][1]:.8f}]')\n    # Test case 4\n    c4_list_str = '[' + ','.join(f'{c:.8f}' for c in results[3][1]) + ']'\n    output_parts.append(f'[{str(results[3][0])},{c4_list_str}]')\n    \n    final_output_str = '[' + ','.join(output_parts) + ']'\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}