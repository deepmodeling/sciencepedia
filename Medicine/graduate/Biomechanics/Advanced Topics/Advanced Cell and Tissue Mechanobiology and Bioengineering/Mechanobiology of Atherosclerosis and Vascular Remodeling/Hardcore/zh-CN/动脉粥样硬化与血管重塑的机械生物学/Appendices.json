{
    "hands_on_practices": [
        {
            "introduction": "壁面剪切应力（Wall Shear Stress, WSS）是内皮细胞感知的主要血流动力学力，在血管重塑和动脉粥样硬化中起着核心作用。要深入理解其生物学效应，首先必须掌握其物理根源。本练习将从基本的Navier-Stokes方程出发，引导您推导在理想化圆管（动脉）中稳层流条件下的壁面剪切应力，从而建立起宏观流动参数（如流量 $Q$ 和半径 $R$）与这一关键力学刺激之间的定量关系。",
            "id": "4189115",
            "problem": "考虑一根半径为$R$、长度为$L$的直的刚性圆柱形动脉，其中充满了密度为$\\rho$、动力粘度为$\\mu$的不可压缩牛顿流体。流动是稳态、层流、轴对称的，并沿轴向坐标$z$充分发展；重力及其他体力可忽略不计。设$u(r)$表示作为径向坐标$r$的函数的轴向速度，壁面处满足无滑移条件，中心线处满足对称条件。体积流量为$Q$，压力梯度$\\partial p / \\partial z$沿血管是均匀的。\n\n从柱坐标系下轴对称形式的纳维-斯托克斯方程和质量守恒定律出发，推导该流动的轴向速度剖面$u(r)$。然后，使用壁面剪切应力（WSS）$\\tau_w$的定义，即作用在$r=R$处动脉壁上的粘性剪切应力的大小，将$\\tau_w$仅用$Q$、$R$和$\\mu$表示。假设$Q$在压力减小的方向上为正。使用与所述假设一致的充分发展的轴对称解。假设使用国际单位制（SI），其中$\\mu$的单位是$\\mathrm{Pa \\cdot s}$，$Q$的单位是$\\mathrm{m^3 \\, s^{-1}}$，$R$的单位是$\\mathrm{m}$，请用帕斯卡表示最终答案。将最终答案表示为$\\tau_w$的单个闭式解析表达式；在最终的方框表达式中不要包含任何单位。",
            "solution": "该问题是经典的哈根-泊肃叶流（Hagen-Poiseuille flow）问题。所提供的条件完整、自洽且有科学依据，足以推导出唯一解。下面开始推导。\n\n不可压缩牛顿流体的运动由质量守恒（连续性方程）和纳维-斯托克斯方程（动量守恒）控制。在柱坐标系$(r, \\theta, z)$中，对应的速度分量为$(v_r, v_{\\theta}, u)$，这些方程如下：\n\n连续性方程：\n$$ \\frac{1}{r}\\frac{\\partial(r v_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial v_{\\theta}}{\\partial \\theta} + \\frac{\\partial u}{\\partial z} = 0 $$\n\n纳维-斯托克斯方程（动量）：\n$r$-分量：\n$$ \\rho \\left( \\frac{\\partial v_r}{\\partial t} + v_r \\frac{\\partial v_r}{\\partial r} + \\frac{v_{\\theta}}{r}\\frac{\\partial v_r}{\\partial \\theta} - \\frac{v_{\\theta}^2}{r} + u \\frac{\\partial v_r}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial r} + \\mu \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial v_r}{\\partial r}\\right) - \\frac{v_r}{r^2} + \\frac{1}{r^2}\\frac{\\partial^2 v_r}{\\partial \\theta^2} - \\frac{2}{r^2}\\frac{\\partial v_{\\theta}}{\\partial \\theta} + \\frac{\\partial^2 v_r}{\\partial z^2} \\right] $$\n$\\theta$-分量：\n$$ \\rho \\left( \\frac{\\partial v_{\\theta}}{\\partial t} + v_r \\frac{\\partial v_{\\theta}}{\\partial r} + \\frac{v_{\\theta}}{r}\\frac{\\partial v_{\\theta}}{\\partial \\theta} + \\frac{v_r v_{\\theta}}{r} + u \\frac{\\partial v_{\\theta}}{\\partial z} \\right) = -\\frac{1}{r}\\frac{\\partial p}{\\partial \\theta} + \\mu \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial v_{\\theta}}{\\partial r}\\right) - \\frac{v_{\\theta}}{r^2} + \\frac{1}{r^2}\\frac{\\partial^2 v_{\\theta}}{\\partial \\theta^2} + \\frac{2}{r^2}\\frac{\\partial v_r}{\\partial \\theta} + \\frac{\\partial^2 v_{\\theta}}{\\partial z^2} \\right] $$\n$z$-分量：\n$$ \\rho \\left( \\frac{\\partial u}{\\partial t} + v_r \\frac{\\partial u}{\\partial r} + \\frac{v_{\\theta}}{r}\\frac{\\partial u}{\\partial \\theta} + u \\frac{\\partial u}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial z} + \\mu \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial u}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 u}{\\partial \\theta^2} + \\frac{\\partial^2 u}{\\partial z^2} \\right] $$\n\n我们应用问题陈述中给出的简化假设：\n1.  稳态流：对所有量，$\\frac{\\partial}{\\partial t} = 0$。\n2.  轴对称流：对所有量，$\\frac{\\partial}{\\partial \\theta} = 0$。根据对称性，切向速度$v_{\\theta}$必须为零，$v_{\\theta} = 0$。\n3.  沿$z$轴充分发展的流：$\\frac{\\partial u}{\\partial z} = 0$。这意味着速度剖面$u(r)$不沿轴向变化。\n\n将这些假设应用于连续性方程：\n$$ \\frac{1}{r}\\frac{\\partial(r v_r)}{\\partial r} + 0 + 0 = 0 \\implies \\frac{d(r v_r)}{dr} = 0 $$\n对其积分得到 $r v_r = \\text{常数}$。在中心线（$r=0$）处，径向速度$v_r$必须是有限的。为了使乘积$r v_r$在$r \\to 0$时为常数且有限，该常数必须为零。因此，在整个流场中$v_r = 0$。\n\n现在我们简化动量方程：\n$r$-分量：由于$v_r=0$和$v_{\\theta}=0$，左侧所有项和右侧所有粘性项都变为零。方程简化为：\n$$ 0 = -\\frac{\\partial p}{\\partial r} \\implies \\frac{\\partial p}{\\partial r} = 0 $$\n这表明压力$p$不随径向坐标$r$变化。\n\n$\\theta$-分量：由于$v_r = 0$，$v_{\\theta}=0$以及轴对称性（$\\partial p/\\partial \\theta = 0$），方程变为$0=0$，这是自然满足的。\n\n$z$-分量：左侧的所有项（惯性项）都为零，因为$\\partial u/\\partial t=0$，$v_r=0$且$\\partial u/\\partial z=0$。由于轴对称性（$\\partial^2 u/\\partial \\theta^2 = 0$）和充分发展流（$\\partial^2 u/\\partial z^2 = 0$），粘性项得以简化。方程简化为：\n$$ 0 = -\\frac{\\partial p}{\\partial z} + \\mu \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial u}{\\partial r}\\right) \\right] $$\n由于$\\partial p/\\partial r = 0$且$\\partial p/\\partial \\theta=0$，压力$p$只能是$z$的函数，因此我们可以将偏导数$\\frac{\\partial p}{\\partial z}$写成全导数$\\frac{dp}{dz}$。问题陈述中说明该梯度是均匀的，所以它是一个常数。整理方程得：\n$$ \\frac{1}{\\mu} \\frac{dp}{dz} = \\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{du}{dr}\\right) $$\n由于$u$只是$r$的函数，我们使用全导数。设恒定的压力梯度为$G = \\frac{dp}{dz}$。\n$$ \\frac{d}{dr}\\left(r \\frac{du}{dr}\\right) = \\frac{G}{\\mu} r $$\n对$r$进行一次积分：\n$$ r \\frac{du}{dr} = \\frac{G}{2\\mu} r^2 + C_1 $$\n$$\\frac{du}{dr} = \\frac{G}{2\\mu} r + \\frac{C_1}{r} $$\n中心线（$r=0$）处的对称边界条件要求速度梯度$\\frac{du}{dr}$是有限的。为满足此条件，积分常数$C_1$必须为零。\n$$ \\frac{du}{dr} = \\frac{G}{2\\mu} r $$\n进行第二次积分：\n$$ u(r) = \\frac{G}{4\\mu} r^2 + C_2 $$\n我们使用壁面处的无滑移边界条件$u(R) = 0$来求解$C_2$：\n$$ 0 = \\frac{G}{4\\mu} R^2 + C_2 \\implies C_2 = -\\frac{G}{4\\mu} R^2 $$\n将$C_2$代回$u(r)$的表达式，我们得到轴向速度剖面：\n$$ u(r) = \\frac{G}{4\\mu} r^2 - \\frac{G}{4\\mu} R^2 = \\frac{G}{4\\mu} (r^2 - R^2) = -\\frac{G}{4\\mu}(R^2 - r^2) $$\n由于流动发生在压力减小的方向上，$\\frac{dp}{dz} = G  0$，这确保了对于$r  R$，$u(r)$为正，从而形成特征性的抛物线剖面。\n\n接下来，我们将体积流量$Q$与压力梯度$G$联系起来。$Q$是速度剖面在横截面积$A$上的积分：\n$$ Q = \\int_A u(r) dA $$\n面积微元为$dA = 2\\pi r dr$。\n$$ Q = \\int_{0}^{R} \\frac{G}{4\\mu}(r^2 - R^2) (2\\pi r) dr = \\frac{2\\pi G}{4\\mu} \\int_{0}^{R} (r^3 - R^2 r) dr $$\n$$ Q = \\frac{\\pi G}{2\\mu} \\left[ \\frac{r^4}{4} - \\frac{R^2 r^2}{2} \\right]_0^R = \\frac{\\pi G}{2\\mu} \\left( \\frac{R^4}{4} - \\frac{R^4}{2} \\right) = \\frac{\\pi G}{2\\mu} \\left( -\\frac{R^4}{4} \\right) = -\\frac{\\pi G R^4}{8\\mu} $$\n这就是哈根-泊肃叶定律。我们可以将其反转，用流量$Q$来表示压力梯度$G$：\n$$ G = -\\frac{8 \\mu Q}{\\pi R^4} $$\n\n最后，我们计算壁面剪切应力$\\tau_w$。在柱坐标系中，牛顿流体的剪切应力分量$\\tau_{rz}$为$\\tau_{rz} = \\mu \\left( \\frac{\\partial u}{\\partial r} + \\frac{\\partial v_r}{\\partial z} \\right)$。由于$v_r = 0$，该式简化为$\\tau_{rz} = \\mu \\frac{du}{dr}$。\n壁面剪切应力$\\tau_w$是在壁面$r=R$处计算的该应力的大小。\n$$ \\tau_w = |\\tau_{rz}|_{r=R} = \\left| \\mu \\frac{du}{dr} \\right|_{r=R} $$\n我们之前已经求得了速度梯度：\n$$ \\frac{du}{dr} = \\frac{G}{2\\mu} r $$\n在$r=R$处计算：\n$$ \\left. \\frac{du}{dr} \\right|_{r=R} = \\frac{G R}{2\\mu} $$\n将此代入$\\tau_w$的表达式中：\n$$ \\tau_w = \\left| \\mu \\left( \\frac{G R}{2\\mu} \\right) \\right| = \\left| \\frac{G R}{2} \\right| $$\n因为$G  0$且$R > 0$，所以绝对值内的量是负的。因此，我们取其相反数：\n$$ \\tau_w = -\\frac{G R}{2} $$\n现在，我们将用$Q$、$R$和$\\mu$表示的$G$的表达式代入：\n$$ \\tau_w = -\\left( -\\frac{8 \\mu Q}{\\pi R^4} \\right) \\frac{R}{2} = \\frac{8 \\mu Q R}{2 \\pi R^4} $$\n简化此表达式可得到壁面剪切应力的最终结果：\n$$ \\tau_w = \\frac{4 \\mu Q}{\\pi R^3} $$\n该表达式将壁面剪切应力与可测量的宏观量——流量$Q$、血管半径$R$和流体粘度$\\mu$——直接联系起来。",
            "answer": "$$\\boxed{\\frac{4 \\mu Q}{\\pi R^3}}$$"
        },
        {
            "introduction": "在理想化模型之外，实际的血流动力学分析必须考虑血液的非牛顿流体特性，其表观粘度会随剪切率而变化。本练习模拟了一个更接近真实研究的场景，要求您利用先进的血液本构模型（Carreau–Yasuda模型）和模拟的实验测量数据（粒子图像测速法得到的近壁速度梯度），计算内皮细胞所承受的瞬时壁面剪切应力 $\\tau_w$。通过这个练习，您将学会如何将复杂的流变学模型应用于实际数据的解读，并评估所得应力值的生理学意义。",
            "id": "4189055",
            "problem": "通过粒子图像测速技术（PIV）对脉动流条件下的一段人类颈总动脉进行探测。此处，PIV被定义为一种通过追踪示踪粒子来估算流体速度场的无创光学技术。在靠近内皮表面的区域，测得的轴向速度 $u(y)$ 在邻近管腔的前 $10\\,\\mu\\mathrm{m}$ 范围内与壁面法向坐标 $y$ 呈局部线性关系。在管腔-糖萼界面处的最佳拟合斜率给出的近壁面速度梯度为$\\left.\\frac{\\partial u}{\\partial y}\\right|_{\\text{interface}} = 8.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$。温度为 $37\\,^{\\circ}\\mathrm{C}$ 的血液被建模为一种广义牛顿流体，其表观粘度 $\\eta(\\dot{\\gamma})$ 由 Carreau–Yasuda 本构关系描述，\n\n$$\n\\eta(\\dot{\\gamma}) = \\eta_{\\infty} + \\left(\\eta_{0} - \\eta_{\\infty}\\right)\\left[1 + \\left(\\lambda\\,\\dot{\\gamma}\\right)^{a}\\right]^{\\frac{n - 1}{a}},\n$$\n\n其中 $\\eta_{0} = 5.6 \\times 10^{-2}\\ \\mathrm{Pa\\cdot s}$，$\\eta_{\\infty} = 3.5 \\times 10^{-3}\\ \\mathrm{Pa\\cdot s}$，$\\lambda = 3.313\\ \\mathrm{s}$，$a = 2$，$n = 0.3568$。这些参数代表了在生理温度下，红细胞压积 $H = 0.45$ 的情况。\n\n假设在内皮表面满足无滑移边界条件，近壁面流动是局部简单剪切流，并且粘性牵引力在管腔-糖萼界面上是连续的。使用这些假设和所提供的数据，计算与测量的梯度对应的瞬间的内皮壁面剪切应力$\\tau_{w}$。然后，基于已公认的、关于大动脉中壁面剪切应力范围与内皮细胞表型关系的力学生物学观察结果，简要评估推断出的$\\tau_{w}$值是否落在通常与内皮健康或功能障碍相关的范围内。\n\n最终的壁面剪切应力以帕斯卡（Pa）为单位表示，并将数值答案四舍五入至三位有效数字。",
            "solution": "壁面剪切应力 $\\tau_w$ 是指流动流体施加在内皮表面的单位面积上的摩擦力。对于广义牛顿流体，剪切应力 $\\tau$ 通过表观粘度 $\\eta(\\dot{\\gamma})$ 与剪切速率 $\\dot{\\gamma}$ 相关：\n$$\n\\tau = \\eta(\\dot{\\gamma})\\dot{\\gamma}\n$$\n问题陈述指出，近壁面流动可以局部近似为简单剪切流。在简单剪切流中，剪切速率 $\\dot{\\gamma}$ 是垂直于流动方向的速度梯度的绝对值。这里，轴向速度为 $u$，壁面法向坐标为 $y$，因此剪切速率由下式给出：\n$$\n\\dot{\\gamma} = \\left| \\frac{\\partial u}{\\partial y} \\right|\n$$\n问题提供了在管腔-糖萼界面处的速度梯度为 $\\left.\\frac{\\partial u}{\\partial y}\\right|_{\\text{interface}} = 8.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$。因此，此位置的剪切速率为：\n$$\n\\dot{\\gamma} = |8.0 \\times 10^{2}\\ \\mathrm{s}^{-1}| = 800\\ \\mathrm{s}^{-1}\n$$\n问题指明了在内皮表面（壁面）存在无滑移条件，并且粘性牵引力（剪切应力）在管腔-糖萼界面上是连续的。这意味着界面处的剪切应力等于壁面处的剪切应力。因此，我们可以通过使用给定的剪切速率来计算界面处的剪切应力，从而得到壁面剪切应力 $\\tau_w$。\n\n首先，我们必须使用 Carreau–Yasuda 模型计算在该剪切速率下的表观粘度 $\\eta$：\n$$\n\\eta(\\dot{\\gamma}) = \\eta_{\\infty} + \\left(\\eta_{0} - \\eta_{\\infty}\\right)\\left[1 + \\left(\\lambda\\,\\dot{\\gamma}\\right)^{a}\\right]^{\\frac{n - 1}{a}}\n$$\n我们代入给定的参数值和计算出的剪切速率 $\\dot{\\gamma} = 800\\ \\mathrm{s}^{-1}$：\n-   $\\eta_{0} = 5.6 \\times 10^{-2}\\ \\mathrm{Pa\\cdot s}$\n-   $\\eta_{\\infty} = 3.5 \\times 10^{-3}\\ \\mathrm{Pa\\cdot s}$\n-   $\\lambda = 3.313\\ \\mathrm{s}$\n-   $a = 2$\n-   $n = 0.3568$\n\n项 $\\lambda\\dot{\\gamma}$ 为：\n$$\n\\lambda\\dot{\\gamma} = (3.313\\ \\mathrm{s})(800\\ \\mathrm{s}^{-1}) = 2650.4\n$$\n项 $[1 + (\\lambda\\dot{\\gamma})^a]$ 变为：\n$$\n1 + (2650.4)^{2} = 1 + 7024620.16 = 7024621.16\n$$\n指数为：\n$$\n\\frac{n - 1}{a} = \\frac{0.3568 - 1}{2} = \\frac{-0.6432}{2} = -0.3216\n$$\n现在，我们计算括号项的该次幂：\n$$\n\\left[1 + \\left(\\lambda\\,\\dot{\\gamma}\\right)^{a}\\right]^{\\frac{n - 1}{a}} = (7024621.16)^{-0.3216} \\approx 0.0062824\n$$\n将此代回粘度方程：\n$$\n\\eta(800) = (3.5 \\times 10^{-3}) + (5.6 \\times 10^{-2} - 3.5 \\times 10^{-3})(0.0062824)\n$$\n$$\n\\eta(800) = 0.0035 + (0.0525)(0.0062824)\n$$\n$$\n\\eta(800) = 0.0035 + 0.000329826 \\approx 0.0038298\\ \\mathrm{Pa\\cdot s}\n$$\n这证明了血液的剪切稀化特性：在 $800\\ \\mathrm{s}^{-1}$ 的高剪切速率下，表观粘度（$ \\approx 3.8 \\times 10^{-3}\\ \\mathrm{Pa\\cdot s}$）远比零剪切粘度（$\\eta_{0} = 5.6 \\times 10^{-2}\\ \\mathrm{Pa\\cdot s}$）更接近无限剪切粘度（$\\eta_{\\infty} = 3.5 \\times 10^{-3}\\ \\mathrm{Pa\\cdot s}$）。\n\n最后，我们计算壁面剪切应力 $\\tau_w$：\n$$\n\\tau_w = \\eta(800) \\times \\dot{\\gamma} = (0.0038298\\ \\mathrm{Pa\\cdot s}) \\times (800\\ \\mathrm{s}^{-1})\n$$\n$$\n\\tau_w \\approx 3.0638\\ \\mathrm{Pa}\n$$\n四舍五入至三位有效数字，壁面剪切应力为 $3.06\\ \\mathrm{Pa}$。\n\n为了评估该值的生理相关性，我们将其与已公认的力学生物学范围进行比较。在像颈总动脉这样的大动脉中，当内皮细胞暴露于时间平均壁面剪切应力范围约为 $1.0 - 7.0\\ \\mathrm{Pa}$（或 $10 - 70\\ \\mathrm{dyn/cm^2}$）时，会维持健康、静止和抗动脉粥样硬化的表型，其最佳范围常被引述为 $1.5 - 3.0\\ \\mathrm{Pa}$。相反地，低壁面剪切应力（$  0.5\\ \\mathrm{Pa}$）或高度振荡/反向剪切的区域是易于发生动脉粥样硬化的，会促进内皮功能障碍、炎症和病变的发展。测得的 $\\tau_w = 3.06\\ \\mathrm{Pa}$ 值代表了脉动条件下的瞬时剪切应力，可能接近收缩期峰值。该值完全落在与内皮健康相关的生理范围内。假设血流主要是单向的，这种水平的瞬时剪切应力与抗动脉粥样硬化的血流动力学环境是一致的。",
            "answer": "$$\n\\boxed{3.06}\n$$"
        },
        {
            "introduction": "血管对血流动力学力的响应取决于剪切应力随时间和空间变化的复杂模式，而不仅仅是瞬时值。本练习将引导您通过编程实践，计算两个关键的临床相关指标：时间平均壁面剪切应力（TAWSS）和振荡剪切指数（OSI）。您将分析一个模拟的血管支架植入手术前后的血流动力学变化，并根据公认的“低TAWSS和高OSI”准则，预测术后再狭窄的高风险区域，从而将理论计算与临床问题直接联系起来。",
            "id": "4189036",
            "problem": "给定一个简化的、患者特异性的动脉段，该动脉段由一组一维轴向壁位置表示，每个位置都有一个局部半径。目标是，在反映动脉粥样硬化和血管重塑的力学生物学假设下，计算支架置入前后的时间平均壁面剪切应力 (TAWSS) 和振荡剪切指数 (OSI) 的变化。然后，使用组合剪切准则预测支架置入后存在再狭窄风险的区域。构建一个完整的、可运行的程序，对提供的测试套件执行这些计算，并以末尾指定的确切输出格式生成结果。\n\n假设与基本原理：\n- 血液被视为不可压缩的牛顿流体，具有动力粘度 $\\mu$ 和恒定密度；在一段直的短管段内，流动是层流、轴对称且充分发展的，并满足无滑移边界条件。\n- 控制定律是质量守恒和不可压缩的 Navier–Stokes 方程。在所述假设下，沿半径为 $R$ 的圆管，轴向速度仅是径向坐标的函数，且轴向压力梯度在整个横截面上是均匀的。壁面剪切应力通过 $\\tau_{w} = \\mu \\left.\\dfrac{\\partial u}{\\partial r}\\right|_{r=R}$ 与近壁速度梯度相关，体积流量为 $Q(t) = \\int_{A} u \\, dA$。\n- 在一个心动周期内，流量波形 $Q(t)$ 可能会振荡，并可能包括短暂的血流逆转。该周期被离散化为 $N$ 个等间距的时间点 $t_{k}$，时间步长均匀为 $\\Delta t$，因此时间平均值为简单的算术平均值。\n\n目标量：\n- 时间平均壁面剪切应力 (TAWSS)：瞬时壁面剪切应力大小的周期平均值，单位为帕斯卡 (Pa)。\n- 振荡剪切指数 (OSI)：一个无量纲指数，用于量化壁面剪切应力在一个周期内的方向性振荡，其值介于 $0$ 和 $0.5$ 之间。使用基于有符号的瞬时壁面剪切应力及其随时间变化的幅度的标准定义。\n- 对于每个轴向位置，从第一性原理计算支架置入前和置入后的 TAWSS 和 OSI 值，然后计算变化量 $\\Delta \\mathrm{TAWSS}$ 和 $\\Delta \\mathrm{OSI}$（置入后减去置入前）。\n- 根据应用于支架置入后的组合准则“低 TAWSS 和高 OSI”预测存在再狭窄风险的区域，具体而言：如果某个轴向位置满足$\\mathrm{TAWSS}_{\\text{post}}  \\tau_{\\text{low}}$ 且 $\\mathrm{OSI}_{\\text{post}} > \\mathrm{OSI}_{\\text{high}}$，则标记该位置。\n\n所需单位和输出：\n- $\\mathrm{TAWSS}$ 以帕斯卡 (Pa) 表示。$\\mathrm{OSI}$ 以无量纲数表示。所有报告的浮点输出均四舍五入到 $6$ 位小数。\n- 标记的轴向位置索引必须使用从零开始的索引。\n- 对于每个测试用例，生成一个包含三项的列表：段平均 $\\Delta \\mathrm{TAWSS}$、段平均 $\\Delta \\mathrm{OSI}$，以及被标记为支架置入后存在风险的轴向位置的排序后索引列表（从零开始）。将三个测试用例的结果汇总到单行输出中，该输出包含一个用方括号括起来的逗号分隔列表，列表内无空格，其中每个测试用例的结果本身也用方括号括起来。例如：$[\\,[\\dots],\\,[\\dots],\\,[\\dots]\\,]$。\n\n参数、数据和测试套件：\n- 动力粘度：$\\mu = 3.5\\times 10^{-3}\\ \\mathrm{Pa\\cdot s}$。\n- 再狭窄风险阈值：$\\tau_{\\text{low}} = 0.4\\ \\mathrm{Pa}$ 和 $\\mathrm{OSI}_{\\text{high}} = 0.2$。\n- 心动周期离散化：$N = 6$ 个等间距样本，$\\Delta t = T/N$，总周期时长 $T = 1.0\\ \\mathrm{s}$；所有时间平均值为这些样本的算术平均值。\n- 几何形状由 $M = 9$ 个轴向位置的局部半径数组指定。半径单位为米。\n\n测试用例 1（“理想情况”，伴有局灶性狭窄，支架置入后改善）：\n- 支架置入前半径 $R_{\\text{pre}}$：$[1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.3\\times 10^{-3},\\,1.2\\times 10^{-3},\\,1.3\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3}]$。\n- 支架置入后半径 $R_{\\text{post}}$：$[1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.45\\times 10^{-3},\\,1.4\\times 10^{-3},\\,1.45\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3}]$。\n- 流量波形 $Q(t_{k})$（单位 $\\mathrm{m^{3}/s}$）：$[1.1\\times 10^{-6},\\,1.4\\times 10^{-6},\\,1.6\\times 10^{-6},\\,1.2\\times 10^{-6},\\,8.0\\times 10^{-7},\\,-1.0\\times 10^{-7}]$。\n\n测试用例 2（“边界情况”，无狭窄且无逆转流）：\n- 支架置入前半径 $R_{\\text{pre}}$：$[1.6\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.6\\times 10^{-3}]$。\n- 支架置入后半径 $R_{\\text{post}}$：与置入前相同。\n- 流量波形 $Q(t_{k})$（单位 $\\mathrm{m^{3}/s}$）：$[1.0\\times 10^{-6},\\,1.1\\times 10^{-6},\\,1.0\\times 10^{-6},\\,9.0\\times 10^{-7},\\,8.0\\times 10^{-7},\\,7.0\\times 10^{-7}]$。\n\n测试用例 3（“边缘情况”，伴有严重的支架置入前狭窄和局部支架置入后过度扩张，有逆转流）：\n- 支架置入前半径 $R_{\\text{pre}}$：$[1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.1\\times 10^{-3},\\,1.1\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3}]$。\n- 支架置入后半径 $R_{\\text{post}}$：$[1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.9\\times 10^{-3},\\,1.9\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3}]$。\n- 流量波形 $Q(t_{k})$（单位 $\\mathrm{m^{3}/s}$）：$[1.5\\times 10^{-6},\\,1.2\\times 10^{-6},\\,9.0\\times 10^{-7},\\,5.0\\times 10^{-7},\\,-3.0\\times 10^{-7},\\,-1.0\\times 10^{-7}]$。\n\n计算要求：\n- 根据给定的假设，从所述基本定律推导出每个轴向位置的瞬时壁面剪切应力，并以 $\\mu$、$Q(t_{k})$ 和局部半径 $R$ 表示，明确指出与 $Q(t_{k})$ 符号一致的方向（符号）。\n- 使用基于离散周期样本时间平均的标准定义来计算 $\\mathrm{TAWSS}$ 和 $\\mathrm{OSI}$。\n- 对于每个测试用例，计算段平均 $\\Delta \\mathrm{TAWSS}$（单位 $\\mathrm{Pa}$）和段平均 $\\Delta \\mathrm{OSI}$（无量纲），均四舍五入到 $6$ 位小数，以及通过组合风险准则标记的从零开始的轴向索引的排序列表（支架置入后）。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，且无空格。每个测试用例的结果必须是格式为 $[\\text{avg\\_dTAWSS},\\text{avg\\_dOSI},[\\text{idx}_{1},\\dots]]$ 的列表。例如：$[[0.123456,0.012345,[1,4]], [\\dots], [\\dots]]$，但输出字符串中任何位置都不能有空格。",
            "solution": "首先，我们根据问题陈述的物理原理和假设，推导计算所需的公式。\n\n首先，我们推导瞬时壁面剪切应力 $\\tau_w$ 的公式。问题假设在直圆管中为层流、轴对称、充分发展的流动，圆管半径为 $R$。这是经典的 Hagen-Poiseuille 流动情景。速度剖面 $u(r)$ 是抛物线形的，其中 $r$ 是径向坐标。\n对于不可压缩的牛顿流体，体积流量 $Q$ 与速度剖面 $u(r)$ 的关系为：\n$$Q = \\int_{0}^{R} u(r) 2\\pi r \\, dr$$\nPoiseuille 流动的速度剖面由 $u(r) = u_{max} \\left(1 - \\frac{r^2}{R^2}\\right)$ 给出。对该剖面积分以找到其与 $Q$ 的关系，得到 $Q = \\frac{1}{2} \\pi R^2 u_{max}$，这使我们能够用可测量的流量 $Q$ 来表示速度剖面：\n$$u(r, t) = \\frac{2Q(t)}{\\pi R^2} \\left(1 - \\frac{r^2}{R^2}\\right)$$\n这里，我们采用准稳态假设，即任何瞬间 $t$ 的速度剖面由瞬时流量 $Q(t)$ 决定。\n\n壁面剪切应力 $\\tau_w$ 是流体施加在管壁上的单位面积摩擦力。它与动力粘度 $\\mu$ 以及壁面处（$r=R$）的轴向速度梯度有关。按照惯例，对于正向流动，$\\tau_w$ 为正，这意味着 $\\tau_w$ 与 $-\\mu \\frac{\\partial u}{\\partial r}$ 成正比：\n$$\\frac{\\partial u}{\\partial r} = \\frac{2Q(t)}{\\pi R^2} \\left(-\\frac{2r}{R^2}\\right) = -\\frac{4Q(t)r}{\\pi R^4}$$\n在壁面处求值，$r=R$：\n$$\\left.\\frac{\\partial u}{\\partial r}\\right|_{r=R} = -\\frac{4Q(t)}{\\pi R^3}$$\n因此，瞬时壁面剪切应力矢量（在此一维模型中纯为轴向）为：\n$$\\tau_w(t) = \\frac{4\\mu Q(t)}{\\pi R^3}$$\n$\\tau_w(t)$ 的符号与流量 $Q(t)$ 的符号直接相关，这与问题要求一致。\n\n接下来，我们为离散化为 $N$ 个时间点 $t_k$ 的心动周期定义目标量：时间平均壁面剪切应力 (TAWSS) 和振荡剪切指数 (OSI)。\n\nTAWSS 是壁面剪切应力大小的时间平均值。离散形式为：\n$$\\mathrm{TAWSS} = \\frac{1}{N} \\sum_{k=1}^{N} |\\tau_w(t_k)| = \\frac{1}{N} \\sum_{k=1}^{N} \\left| \\frac{4\\mu Q(t_k)}{\\pi R^3} \\right| = \\frac{4\\mu}{\\pi N R^3} \\sum_{k=1}^{N} |Q(t_k)|$$\n\nOSI 是剪切应力矢量振荡的无量纲度量。标准的离散定义是：\n$$\\mathrm{OSI} = \\frac{1}{2} \\left( 1 - \\frac{\\left| \\sum_{k=1}^{N} \\tau_w(t_k) \\right|}{\\sum_{k=1}^{N} |\\tau_w(t_k)|} \\right)$$\n代入 $\\tau_w(t_k)$ 的表达式：\n$$\\mathrm{OSI} = \\frac{1}{2} \\left( 1 - \\frac{\\left| \\sum_{k=1}^{N} \\frac{4\\mu Q(t_k)}{\\pi R^3} \\right|}{\\sum_{k=1}^{N} \\left| \\frac{4\\mu Q(t_k)}{\\pi R^3} \\right|} \\right) = \\frac{1}{2} \\left( 1 - \\frac{\\left| \\frac{4\\mu}{\\pi R^3} \\sum_{k=1}^{N} Q(t_k) \\right|}{\\frac{4\\mu}{\\pi R^3} \\sum_{k=1}^{N} |Q(t_k)|} \\right)$$\n常数项 $\\frac{4\\mu}{\\pi R^3}$ 被消去，表明 OSI 与局部半径 $R$ 和粘度 $\\mu$ 无关，仅取决于流量波形 $Q(t_k)$：\n$$\\mathrm{OSI} = \\frac{1}{2} \\left( 1 - \\frac{\\left| \\sum_{k=1}^{N} Q(t_k) \\right|}{\\sum_{k=1}^{N} |Q(t_k)|} \\right)$$\n由此得出的一个关键结论是，对于一个给定的测试用例，由于支架置入前后的流量波形 $Q(t_k)$ 相同，因此对于所有轴向位置以及支架置入前后的状态，OSI 值将是相同的。因此，对于所有位置，变化量 $\\Delta \\mathrm{OSI} = \\mathrm{OSI}_{\\text{post}} - \\mathrm{OSI}_{\\text{pre}}$ 均为零，段平均 $\\Delta \\mathrm{OSI}$ 也为零。\n\n每个测试用例的计算算法如下：\n1.  给定支架置入前半径数组 $R_{\\text{pre}}$、支架置入后半径数组 $R_{\\text{post}}$、流量波形 $Q(t_k)$，以及常数 $\\mu$、$N$、$\\tau_{\\text{low}}$、$\\mathrm{OSI}_{\\text{high}}$。轴向位置的数量为 $M=9$。\n2.  使用基于 $Q(t_k)$ 的推导公式计算该测试用例的单一 OSI 值。该值将作为所有位置的 $\\mathrm{OSI}_{\\text{pre}}$ 和 $\\mathrm{OSI}_{\\text{post}}$。段平均 $\\Delta \\mathrm{OSI}$ 为 $0.0$。\n3.  对于从 $0$ 到 $M-1$ 的每个轴向位置 $i$：\n    a. 使用其公式和半径 $R_{\\text{pre}, i}$ 计算 $\\mathrm{TAWSS}_{\\text{pre}, i}$。\n    b. 使用其公式和半径 $R_{\\text{post}, i}$ 计算 $\\mathrm{TAWSS}_{\\text{post}, i}$。\n    c. 计算变化量 $\\Delta \\mathrm{TAWSS}_i = \\mathrm{TAWSS}_{\\text{post}, i} - \\mathrm{TAWSS}_{\\text{pre}, i}$。\n4.  通过对所有 $M$ 个位置的 $\\Delta \\mathrm{TAWSS}_i$ 值求平均，计算段平均 $\\Delta \\mathrm{TAWSS}$。\n5.  识别高风险位置。对于每个轴向位置 $i$，检查支架置入后的值是否满足组合准则：$\\mathrm{TAWSS}_{\\text{post}, i}  \\tau_{\\text{low}}$ 且 $\\mathrm{OSI}_{\\text{post}} > \\mathrm{OSI}_{\\text{high}}$。\n6.  收集所有满足该准则的位置的从零开始的索引 $i$。将这些索引按升序排序。\n7.  为该测试用例组装最终结果：一个列表，包含四舍五入后的段平均 $\\Delta \\mathrm{TAWSS}$、四舍五入后的段平均 $\\Delta \\mathrm{OSI}$（$0.0$）以及排序后的高风险索引列表。\n\n此过程将应用于所提供的三个测试用例中的每一个。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes changes in TAWSS and OSI before and after stent deployment\n    and predicts regions at risk for restenosis.\n    \"\"\"\n    # Define constants and thresholds\n    mu = 3.5e-3  # Dynamic viscosity in Pa.s\n    tau_low = 0.4  # Low TAWSS threshold in Pa\n    osi_high = 0.2  # High OSI threshold (dimensionless)\n    N = 6  # Number of cardiac cycle samples\n\n    # Test suite data\n    test_cases = [\n        {\n            \"R_pre\": np.array([1.5e-3, 1.5e-3, 1.5e-3, 1.3e-3, 1.2e-3, 1.3e-3, 1.5e-3, 1.5e-3, 1.5e-3]),\n            \"R_post\": np.array([1.5e-3, 1.5e-3, 1.5e-3, 1.45e-3, 1.4e-3, 1.45e-3, 1.5e-3, 1.5e-3, 1.5e-3]),\n            \"Q\": np.array([1.1e-6, 1.4e-6, 1.6e-6, 1.2e-6, 8.0e-7, -1.0e-7]),\n        },\n        {\n            \"R_pre\": np.array([1.6e-3] * 9),\n            \"R_post\": np.array([1.6e-3] * 9),\n            \"Q\": np.array([1.0e-6, 1.1e-6, 1.0e-6, 9.0e-7, 8.0e-7, 7.0e-7]),\n        },\n        {\n            \"R_pre\": np.array([1.5e-3, 1.5e-3, 1.5e-3, 1.1e-3, 1.1e-3, 1.5e-3, 1.5e-3, 1.5e-3, 1.5e-3]),\n            \"R_post\": np.array([1.5e-3, 1.5e-3, 1.5e-3, 1.9e-3, 1.9e-3, 1.5e-3, 1.5e-3, 1.5e-3, 1.5e-3]),\n            \"Q\": np.array([1.5e-6, 1.2e-6, 9.0e-7, 5.0e-7, -3.0e-7, -1.0e-7]),\n        },\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        R_pre = case[\"R_pre\"]\n        R_post = case[\"R_post\"]\n        Q = case[\"Q\"]\n\n        # Calculate OSI\n        # OSI = 0.5 * (1 - |sum(Q_k)| / sum(|Q_k|))\n        # OSI is independent of radius, so it's the same for pre/post and all locations.\n        sum_Q = np.sum(Q)\n        sum_abs_Q = np.sum(np.abs(Q))\n        # Avoid division by zero if all Q values are zero\n        if sum_abs_Q == 0:\n            osi = 0.0\n        else:\n            osi = 0.5 * (1 - np.abs(sum_Q) / sum_abs_Q)\n        \n        # Since OSI_pre = OSI_post, delta_OSI is 0 for all locations.\n        avg_dOSI = 0.0\n\n        # Calculate TAWSS\n        # TAWSS = (4 * mu / (pi * N * R^3)) * sum(|Q_k|)\n        tawss_constant_factor = (4 * mu / (np.pi * N)) * sum_abs_Q\n        \n        tawss_pre = tawss_constant_factor / (R_pre**3)\n        tawss_post = tawss_constant_factor / (R_post**3)\n\n        # Calculate delta TAWSS and its segment average\n        delta_tawss = tawss_post - tawss_pre\n        avg_dTAWSS = np.mean(delta_tawss)\n\n        # Predict regions at risk for restenosis\n        # Criterion: TAWSS_post  tau_low AND OSI_post > osi_high\n        at_risk_indices = []\n        if osi > osi_high:\n            for i in range(len(tawss_post)):\n                if tawss_post[i]  tau_low:\n                    at_risk_indices.append(i)\n        \n        # Format results for the current test case\n        # Round floats to 6 decimal places\n        case_result = [\n            round(avg_dTAWSS, 6),\n            round(avg_dOSI, 6),\n            at_risk_indices\n        ]\n        all_results.append(case_result)\n\n    # Format the final output string to exactly match the requirements.\n    # Convert the list of lists to string and remove all spaces.\n    final_output_str = str(all_results).replace(\" \", \"\")\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}