{
    "hands_on_practices": [
        {
            "introduction": "Avascular tumors depend on the passive diffusion of nutrients from their surroundings, a process that becomes inefficient as the tumor grows. This practice explores this fundamental transport limitation using a classic reaction-diffusion model for a spherical tumor. By applying mass conservation principles and Fick's law, you will derive the nutrient concentration profile and determine the conditions under which a central necrotic core forms, providing a quantitative link between tumor size and cellular viability .",
            "id": "4209446",
            "problem": "Consider an avascular tumor spheroid of radius $R$ embedded in a well-mixed medium. Let $c(r)$ denote the steady-state concentration of a nutrient (for example, oxygen) at radial position $r \\in [0,R]$. Assume radial symmetry, no convection, and a uniform volumetric consumption rate $q$ (constant, independent of $c$) by the cells. The diffusion coefficient of the nutrient in the spheroid is $D$ (assumed constant), and the spheroid surface is maintained at a known concentration $c(R) = c_{s}$ by the surrounding medium. A necrotic core forms where the nutrient concentration falls below a viability threshold $c_{\\text{crit}}$, defining a necrotic-core radius $r_{n}$ by $c(r_{n}) = c_{\\text{crit}}$ with $0 \\leq r_{n} \\leq R$.\n\nStarting from mass conservation at steady state and Fick’s law of diffusion, derive the concentration profile $c(r)$ for $0 \\leq r \\leq R$ under uniform consumption. Then, define the parameter\n$$\\lambda \\equiv \\sqrt{\\frac{q}{6 D \\left(c_{s} - c_{\\text{crit}}\\right)}}$$\nand compute the necrotic core radius $r_{n}$ as a function of $\\lambda$ and the spheroid radius $R$. Express your final answer as a closed-form analytic expression in terms of $R$ and $\\lambda$. Do not substitute numerical values. The final answer must be a single symbolic expression; do not provide an equation or inequality as your answer. Interpret $R$ as a length and $\\lambda$ as having units of inverse length; you do not need to report units in the final answer.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n-   System: Avascular tumor spheroid of radius $R$.\n-   Variable: $c(r)$ is the steady-state nutrient concentration at radial position $r \\in [0,R]$.\n-   Assumptions: Radial symmetry, no convection, uniform volumetric consumption rate $q$, constant diffusion coefficient $D$.\n-   Boundary Condition: Spheroid surface concentration is $c(R) = c_{s}$.\n-   Definition 1: A necrotic core forms where the nutrient concentration is below a viability threshold, $c_{\\text{crit}}$.\n-   Definition 2: The necrotic core radius, $r_n$, is defined by the condition $c(r_{n}) = c_{\\text{crit}}$, with $0 \\leq r_{n} \\leq R$.\n-   Definition 3: A parameter $\\lambda$ is defined as $\\lambda \\equiv \\sqrt{\\frac{q}{6 D \\left(c_{s} - c_{\\text{crit}}\\right)}}$.\n-   Task: Derive the concentration profile $c(r)$ and then compute $r_n$ as a function of $R$ and $\\lambda$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem describes a standard reaction-diffusion model, a cornerstone of transport phenomena in biological systems, specifically used to model nutrient and drug delivery in tumors. The assumptions are common and appropriate for a first-order analytical model. All concepts (Fick's law, mass conservation, reaction-diffusion) are based on fundamental principles of physics and chemistry.\n-   **Well-Posed:** The problem is well-posed. It provides a second-order ordinary differential equation with two boundary conditions (one explicit at $r=R$, one implicit due to symmetry at $r=0$), which is sufficient to determine a unique solution for the concentration profile $c(r)$. The subsequent calculation of $r_n$ is a direct algebraic step.\n-   **Objective:** The language is precise and technical. All terms like \"steady-state\", \"radial symmetry\", \"uniform consumption\" are well-defined in the context of transport phenomena. There are no subjective or opinion-based statements.\n-   **Completeness:** The problem provides all necessary information (governing physics, geometry, boundary conditions, definitions) to derive the requested expression.\n-   **Dimensional Consistency:** The parameter $\\lambda$ is defined as $\\lambda \\equiv \\sqrt{\\frac{q}{6 D \\left(c_{s} - c_{\\text{crit}}\\right)}}$. Let's verify its units. The consumption rate $q$ has units of [substance][length]$^{-3}$[time]$^{-1}$. The diffusion coefficient $D$ has units of [length]$^2$[time]$^{-1}$. The concentrations $c_s$ and $c_{\\text{crit}}$ have units of [substance][length]$^{-3}$. The units of the expression inside the square root are:\n$$ \\frac{[\\text{substance}] \\cdot [\\text{length}]^{-3} \\cdot [\\text{time}]^{-1}}{([\\text{length}]^2 \\cdot [\\text{time}]^{-1}) \\cdot ([\\text{substance}] \\cdot [\\text{length}]^{-3})} = \\frac{[\\text{length}]^{-3}}{[\\text{length}]^2 \\cdot [\\text{length}]^{-3}} = \\frac{1}{[\\text{length}]^2} $$\nTaking the square root gives units of [length]$^{-1}$ for $\\lambda$, which is consistent with the problem statement's interpretation.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and self-contained. It is a valid problem. We may proceed with the solution.\n\n### Derivation of the Concentration Profile\nThe problem concerns steady-state diffusion with a reaction (consumption) in a spherically symmetric domain. The governing principle is mass conservation. For a differential spherical shell of radius $r$ and thickness $dr$, At steady state, the net rate of nutrient diffusion into the shell must equal the rate of nutrient consumption within the shell.\n\nThe mass conservation equation in spherical coordinates under these assumptions is:\n$$ \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 J_r \\right) = -q $$\nwhere $J_r$ is the radial nutrient flux and $-q$ is the sink term representing consumption.\n\nAccording to Fick’s first law of diffusion, the flux is proportional to the concentration gradient:\n$$ J_r = -D \\frac{dc}{dr} $$\nSubstituting Fick's law into the conservation equation, and assuming $D$ is constant, we get:\n$$ \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\left(-D \\frac{dc}{dr}\\right) \\right) = -q $$\n$$ \\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right) = \\frac{q}{D} r^2 $$\nThis is the governing ordinary differential equation for the concentration profile $c(r)$. We integrate it twice to find the general solution.\n\nIntegrating once with respect to $r$:\n$$ r^2 \\frac{dc}{dr} = \\frac{q}{3D} r^3 + C_1 $$\nwhere $C_1$ is an integration constant.\n\nTo solve for $C_1$, we apply a boundary condition at the center of the spheroid ($r=0$). Due to radial symmetry, the concentration gradient must be zero at the center to avoid an infinite flux source or sink, i.e., $\\left.\\frac{dc}{dr}\\right|_{r=0} = 0$. Rewriting the above equation as $\\frac{dc}{dr} = \\frac{q}{3D} r + \\frac{C_1}{r^2}$, we see that for the gradient to be finite (and zero) at $r=0$, we must have $C_1=0$.\n\nWith $C_1=0$, the equation simplifies to:\n$$ \\frac{dc}{dr} = \\frac{q}{3D} r $$\nIntegrating a second time:\n$$ c(r) = \\int \\frac{q}{3D} r \\, dr = \\frac{q}{6D} r^2 + C_2 $$\nwhere $C_2$ is the second integration constant.\n\nTo find $C_2$, we use the boundary condition at the spheroid surface, $c(R) = c_s$:\n$$ c(R) = c_s = \\frac{q}{6D} R^2 + C_2 $$\nSolving for $C_2$:\n$$ C_2 = c_s - \\frac{q}{6D} R^2 $$\nSubstituting $C_2$ back into the expression for $c(r)$, we obtain the nutrient concentration profile:\n$$ c(r) = \\frac{q}{6D} r^2 + c_s - \\frac{q}{6D} R^2 $$\nThis can be rewritten as:\n$$ c(r) = c_s - \\frac{q}{6D} (R^2 - r^2) $$\n\n### Calculation of the Necrotic Core Radius\nThe necrotic core radius, $r_n$, is defined by the condition $c(r_n) = c_{\\text{crit}}$. We substitute this into the derived concentration profile:\n$$ c_{\\text{crit}} = c_s - \\frac{q}{6D} (R^2 - r_n^2) $$\nNow, we solve this algebraic equation for $r_n$.\n$$ \\frac{q}{6D} (R^2 - r_n^2) = c_s - c_{\\text{crit}} $$\n$$ R^2 - r_n^2 = \\frac{6D(c_s - c_{\\text{crit}})}{q} $$\n$$ r_n^2 = R^2 - \\frac{6D(c_s - c_{\\text{crit}})}{q} $$\nThe problem defines the parameter $\\lambda$ as:\n$$ \\lambda = \\sqrt{\\frac{q}{6 D \\left(c_{s} - c_{\\text{crit}}\\right)}} $$\nSquaring this definition gives:\n$$ \\lambda^2 = \\frac{q}{6 D \\left(c_{s} - c_{\\text{crit}}\\right)} $$\nThe term in our expression for $r_n^2$ is the reciprocal of $\\lambda^2$:\n$$ \\frac{1}{\\lambda^2} = \\frac{6 D \\left(c_{s} - c_{\\text{crit}}\\right)}{q} $$\nSubstituting this into the equation for $r_n^2$:\n$$ r_n^2 = R^2 - \\frac{1}{\\lambda^2} $$\nFinally, taking the square root gives the expression for the necrotic core radius, $r_n$. We take the positive root since a radius must be non-negative.\n$$ r_n = \\sqrt{R^2 - \\frac{1}{\\lambda^2}} $$\nThis expression is the closed-form analytic solution for $r_n$ in terms of $R$ and $\\lambda$, valid for the case where a necrotic core exists ($R^2 > 1/\\lambda^2$).",
            "answer": "$$ \\boxed{\\sqrt{R^2 - \\frac{1}{\\lambda^2}}} $$"
        },
        {
            "introduction": "The tumor extracellular matrix (ECM) is a complex biomaterial whose mechanical response is time-dependent, influencing everything from cell migration to tissue-level stress. This exercise models the ECM as a linear viscoelastic material using a generalized Maxwell model, a common approach for soft biological tissues. You will analyze the phenomenon of stress relaxation following an applied strain, gaining insight into how the ECM dissipates mechanical energy over time .",
            "id": "4209418",
            "problem": "A collagen–hyaluronic acid (HA) gel is used to mimic the tumor extracellular matrix (ECM). Under small-strain torsional shear, assume the gel behaves as a linear viscoelastic material whose stress response to a step strain is governed by time-dependent relaxation arising from two distinct mechanisms: fast collagen fiber viscoelasticity and slower HA-mediated poroelastic fluid redistribution. A constant shear strain of amplitude $\\epsilon_{0}$ is applied at $t=0$ and held thereafter. The relaxation behavior can be represented by a generalized Maxwell spectrum with an equilibrium shear modulus $G_{\\infty}$ and two dissipative modes characterized by modal shear moduli $g_{1}$, $g_{2}$ and characteristic times $\\tau_{1}$, $\\tau_{2}$.\n\nThe following parameter values, representative of collagen–HA gels in physiologic buffer, are used: $G_{\\infty}=0.5\\,\\mathrm{kPa}$, $g_{1}=1.5\\,\\mathrm{kPa}$, $\\tau_{1}=600\\,\\mathrm{s}$, $g_{2}=1.0\\,\\mathrm{kPa}$, $\\tau_{2}=7200\\,\\mathrm{s}$. The initial strain amplitude is $\\epsilon_{0}=0.05$.\n\nDefine the “extent of stress relaxation at time $t$” as the unitless fraction\n$$\\phi(t)=\\frac{\\sigma(0^{+})-\\sigma(t)}{\\sigma(0^{+})},$$\nwhere $\\sigma(t)$ is the shear stress at time $t$ following the step in strain. Starting from fundamental linear viscoelastic principles and the definition of stress relaxation under a step strain, derive the appropriate expression for $\\phi(t)$ for the given model and parameters, and calculate $\\phi$ at $t=1\\,\\mathrm{hour}$.\n\nExpress your final answer as a unitless fraction and round to four significant figures. State the time in $\\mathrm{s}$ as needed and ensure that every step is scientifically justified from first principles.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained. The provided parameters and model are standard in the field of biomechanics and linear viscoelasticity. I will now proceed with the solution.\n\nThe problem asks for the derivation of the extent of stress relaxation, $\\phi(t)$, and its value at a specific time for a material described by a generalized Maxwell model. A generalized Maxwell model consists of an equilibrium spring in parallel with one or more Maxwell elements (each being a spring and dashpot in series). The stress relaxation modulus, $G(t)$, which is the stress response to a unit step strain, for such a model is given by the sum of the equilibrium modulus and a series of decaying exponential terms, one for each Maxwell element.\n\nFor a model with an equilibrium shear modulus $G_{\\infty}$ and $N$ dissipative modes, each with a modal shear modulus $g_i$ and a characteristic relaxation time $\\tau_i$, the relaxation modulus $G(t)$ is expressed as:\n$$G(t) = G_{\\infty} + \\sum_{i=1}^{N} g_i \\exp\\left(-\\frac{t}{\\tau_i}\\right)$$\nIn this specific problem, there are two dissipative modes ($N=2$), so the relaxation modulus is:\n$$G(t) = G_{\\infty} + g_1 \\exp\\left(-\\frac{t}{\\tau_1}\\right) + g_2 \\exp\\left(-\\frac{t}{\\tau_2}\\right)$$\nThe material is subjected to a constant shear strain of amplitude $\\epsilon_0$ for $t \\ge 0$. For a linear viscoelastic material, the shear stress $\\sigma(t)$ is given by the product of the relaxation modulus and the applied strain amplitude:\n$$\\sigma(t) = G(t) \\cdot \\epsilon_0$$\nSubstituting the expression for $G(t)$, the shear stress at time $t$ is:\n$$\\sigma(t) = \\left[G_{\\infty} + g_1 \\exp\\left(-\\frac{t}{\\tau_1}\\right) + g_2 \\exp\\left(-\\frac{t}{\\tau_2}\\right)\\right] \\epsilon_0$$\nTo calculate the extent of relaxation $\\phi(t)$, we need the instantaneous stress at $t=0^+$, denoted as $\\sigma(0^+)$. This is found by evaluating $\\sigma(t)$ at $t \\to 0^+$:\n$$\\sigma(0^+) = \\lim_{t\\to 0^+} \\sigma(t) = \\left[G_{\\infty} + g_1 \\exp(0) + g_2 \\exp(0)\\right] \\epsilon_0$$\n$$\\sigma(0^+) = (G_{\\infty} + g_1 + g_2) \\epsilon_0$$\nThe term $G_0 = G_{\\infty} + g_1 + g_2$ represents the instantaneous shear modulus.\n\nThe extent of stress relaxation $\\phi(t)$ is defined as:\n$$\\phi(t) = \\frac{\\sigma(0^+) - \\sigma(t)}{\\sigma(0^+)}$$\nSubstituting the expressions for $\\sigma(t)$ and $\\sigma(0^+)$:\n$$\\phi(t) = \\frac{(G_{\\infty} + g_1 + g_2)\\epsilon_0 - \\left[G_{\\infty} + g_1 \\exp\\left(-\\frac{t}{\\tau_1}\\right) + g_2 \\exp\\left(-\\frac{t}{\\tau_2}\\right)\\right]\\epsilon_0}{(G_{\\infty} + g_1 + g_2)\\epsilon_0}$$\nThe strain amplitude $\\epsilon_0$ is a common factor and cancels out from the numerator and denominator, confirming that $\\phi(t)$ is independent of the strain magnitude, as expected for a linear material.\n$$\\phi(t) = \\frac{(G_{\\infty} + g_1 + g_2) - \\left[G_{\\infty} + g_1 \\exp\\left(-\\frac{t}{\\tau_1}\\right) + g_2 \\exp\\left(-\\frac{t}{\\tau_2}\\right)\\right]}{G_{\\infty} + g_1 + g_2}$$\nSimplifying the numerator:\n$$\\phi(t) = \\frac{g_1 - g_1 \\exp\\left(-\\frac{t}{\\tau_1}\\right) + g_2 - g_2 \\exp\\left(-\\frac{t}{\\tau_2}\\right)}{G_{\\infty} + g_1 + g_2}$$\nThis can be written as:\n$$\\phi(t) = \\frac{g_1\\left(1 - \\exp\\left(-\\frac{t}{\\tau_1}\\right)\\right) + g_2\\left(1 - \\exp\\left(-\\frac{t}{\\tau_2}\\right)\\right)}{G_{\\infty} + g_1 + g_2}$$\nThis is the derived expression for the extent of stress relaxation for the given model.\n\nNow, we must calculate the value of $\\phi(t)$ at $t=1\\,\\mathrm{hour}$. First, we convert the time to the same units as the relaxation times ($\\mathrm{s}$):\n$$t = 1\\,\\mathrm{hour} \\times \\frac{60\\,\\mathrm{minutes}}{1\\,\\mathrm{hour}} \\times \\frac{60\\,\\mathrm{seconds}}{1\\,\\mathrm{minute}} = 3600\\,\\mathrm{s}$$\nThe given parameters are:\n$G_{\\infty} = 0.5\\,\\mathrm{kPa}$\n$g_{1} = 1.5\\,\\mathrm{kPa}$\n$\\tau_{1} = 600\\,\\mathrm{s}$\n$g_{2} = 1.0\\,\\mathrm{kPa}$\n$\\tau_{2} = 7200\\,\\mathrm{s}$\n\nFirst, we calculate the denominator, which is the instantaneous modulus $G_0$:\n$$G_0 = G_{\\infty} + g_1 + g_2 = 0.5 + 1.5 + 1.0 = 3.0\\,\\mathrm{kPa}$$\nNext, we evaluate the exponential terms at $t = 3600\\,\\mathrm{s}$:\n$$\\frac{t}{\\tau_1} = \\frac{3600\\,\\mathrm{s}}{600\\,\\mathrm{s}} = 6$$\n$$\\frac{t}{\\tau_2} = \\frac{3600\\,\\mathrm{s}}{7200\\,\\mathrm{s}} = 0.5$$\nNow, substitute these values into the expression for $\\phi(t)$:\n$$\\phi(3600) = \\frac{g_1\\left(1 - \\exp(-6)\\right) + g_2\\left(1 - \\exp(-0.5)\\right)}{3.0}$$\nSubstituting the values for $g_1$ and $g_2$:\n$$\\phi(3600) = \\frac{1.5\\left(1 - \\exp(-6)\\right) + 1.0\\left(1 - \\exp(-0.5)\\right)}{3.0}$$\nWe now compute the numerical value:\n$$\\exp(-6) \\approx 0.00247875$$\n$$\\exp(-0.5) \\approx 0.60653066$$\nNumerator term 1:\n$$1.5 \\times (1 - 0.00247875) = 1.5 \\times 0.99752125 \\approx 1.496281875$$\nNumerator term 2:\n$$1.0 \\times (1 - 0.60653066) = 1.0 \\times 0.39346934 \\approx 0.39346934$$\nSum of numerator terms:\n$$1.496281875 + 0.39346934 = 1.889751215$$\nFinally, we calculate $\\phi(3600)$:\n$$\\phi(3600) = \\frac{1.889751215}{3.0} \\approx 0.62991707$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\\phi(3600) \\approx 0.6299$$\nThis value represents the fraction of the initial stress that has relaxed after $1$ hour.",
            "answer": "$$\n\\boxed{0.6299}\n$$"
        },
        {
            "introduction": "The relentless growth of a tumor generates significant internal mechanical forces, or solid stress, which can compress blood vessels and impede the delivery of therapeutic agents. This capstone exercise integrates solid mechanics and transport phenomena to model this critical process computationally. By treating heterogeneous proliferation as a source of eigenstrain, you will solve for the resulting stress field and quantify its effect on vessel patency, demonstrating a powerful link between cellular growth dynamics and macroscopic transport barriers .",
            "id": "4209392",
            "problem": "Consider a spherical tumor spheroid of radius $R$ modeled as a quasistatic, isotropic, linearly elastic solid undergoing heterogeneous volumetric growth. Assume small strains and spherical symmetry. Let the displacement field be radial with magnitude $u(r)$, where $r \\in [0,R]$ is the radial coordinate. The material is characterized by Young's modulus $E$ (in pascals, $\\mathrm{Pa}$) and Poisson's ratio $\\nu$ (dimensionless), with the Lamé parameters given by $G = \\dfrac{E}{2(1+\\nu)}$ and $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$. Growth is represented by an isotropic eigenstrain field $\\varepsilon^{g}(r) = g(r)\\,\\mathbf{I}$, where $g(r)$ is a prescribed dimensionless function and $\\mathbf{I}$ is the identity tensor. The total strain is $\\varepsilon = \\dfrac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\top})$, and the Cauchy stress under small-strain linear elasticity with eigenstrain is $\\boldsymbol{\\sigma} = 2G\\left(\\varepsilon - \\varepsilon^{g}\\right) + \\lambda \\operatorname{tr}\\left(\\varepsilon - \\varepsilon^{g}\\right)\\mathbf{I}$. Assume quasistatic mechanical equilibrium, $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$, and a traction-free boundary condition at the spheroid surface, $\\sigma_{rr}(R) = 0$, where $\\sigma_{rr}$ is the radial normal stress. For spherical symmetry, the nonzero strain components are $\\varepsilon_{rr} = \\dfrac{du}{dr}$ and $\\varepsilon_{\\theta\\theta} = \\varepsilon_{\\phi\\phi} = \\dfrac{u}{r}$. The radial and circumferential stresses are then\n$$\n\\sigma_{rr}(r) = (2G+\\lambda)\\,\\dfrac{du}{dr} + 2\\lambda\\,\\dfrac{u}{r} - (2G+3\\lambda)\\,g(r),\n$$\n$$\n\\sigma_{\\theta}(r) = \\lambda\\,\\dfrac{du}{dr} + (2G+2\\lambda)\\,\\dfrac{u}{r} - (2G+3\\lambda)\\,g(r).\n$$\nMechanical equilibrium in spherical coordinates reduces to\n$$\n\\dfrac{d \\sigma_{rr}}{dr} + \\dfrac{2}{r}\\left(\\sigma_{rr} - \\sigma_{\\theta}\\right) = 0,\n$$\nwhich yields the ordinary differential equation for $u(r)$:\n$$\n(2G+\\lambda)\\,\\dfrac{d^{2}u}{dr^{2}} + \\dfrac{2\\lambda+4G}{r}\\,\\dfrac{du}{dr} - \\dfrac{2\\lambda+4G}{r^{2}}\\,u - (2G+3\\lambda)\\,\\dfrac{dg}{dr} = 0,\n$$\nsubject to regularity at the origin, $u(0) = 0$, and the traction-free boundary condition at $r=R$,\n$$\n\\sigma_{rr}(R) = (2G+\\lambda)\\,\\left.\\dfrac{du}{dr}\\right|_{r=R} + 2\\lambda\\,\\dfrac{u(R)}{R} - (2G+3\\lambda)\\,g(R) = 0.\n$$\nLet the growth profile be a smooth, radially varying function\n$$\ng(r) = g_{1} + (g_{0} - g_{1})\\,\\exp\\!\\left(-\\left(\\dfrac{r}{r_{c}}\\right)^{2}\\right),\n$$\nwith parameters $g_{0}$ and $g_{1}$ (dimensionless) and a characteristic length $r_{c}$ (in meters, $\\mathrm{m}$). A vessel-like channel embedded at radius $r_{V} \\in (0,R)$ experiences an external solid hydrostatic stress\n$$\n\\sigma_{h}(r_{V}) = \\dfrac{\\sigma_{rr}(r_{V}) + 2\\,\\sigma_{\\theta}(r_{V})}{3}.\n$$\nAssume the vessel has an internal fluid pressure $p_{\\mathrm{in}}$ (in pascals, $\\mathrm{Pa}$). Define the net compressive external stress relative to the internal pressure as\n$$\n\\sigma_{\\mathrm{ext}}^{+}(r_{V}) = \\max\\!\\left(0,\\,\\sigma_{h}(r_{V}) - p_{\\mathrm{in}}\\right).\n$$\nModel the vessel radius reduction by a linear compliance law with compliance parameter $\\beta$ (in reciprocal pascals, $\\mathrm{Pa}^{-1}$):\n$$\n\\dfrac{r_{\\mathrm{eff}}}{r_{0}} = \\max\\!\\left(0,\\,1 - \\beta\\,\\sigma_{\\mathrm{ext}}^{+}(r_{V})\\right),\n$$\nwhere $r_{0}$ is the baseline vessel radius (which cancels in the normalized flow below). Assuming laminar flow dominated by Poiseuille-like behavior, the normalized hydraulic conductance is\n$$\nq_{\\mathrm{rel}} = \\left(\\dfrac{r_{\\mathrm{eff}}}{r_{0}}\\right)^{4} = \\max\\!\\left(0,\\,1 - \\beta\\,\\sigma_{\\mathrm{ext}}^{+}(r_{V})\\right)^{4}.\n$$\nYour task is to implement a program that, for the specified test suite, numerically solves the above boundary value problem via superposition and shooting (using linearity): compute two solutions, $u_{1}(r)$ for the homogeneous equation with initial conditions $u_{1}(0) = 0$, $u_{1}'(0) = 1$, and $u_{0}(r)$ for the inhomogeneous equation with $u_{0}(0)=0$, $u_{0}'(0)=0$. Use superposition $u(r) = a\\,u_{1}(r) + u_{0}(r)$ and determine the scalar $a$ to satisfy $\\sigma_{rr}(R) = 0$. Then evaluate $\\sigma_{h}(r_{V})$ and $q_{\\mathrm{rel}}$ for each case.\n\nAll physical quantities must be used with the units indicated above; the final reported $q_{\\mathrm{rel}}$ values are dimensionless and must be output as decimal numbers. The angle unit does not apply. No percentages are used in the input; all growth parameters are dimensionless decimals.\n\nTest suite:\n- Case $1$ (moderate heterogeneity, \"happy path\"):\n  - $R = 5\\times 10^{-4}\\,\\mathrm{m}$, $E = 3000\\,\\mathrm{Pa}$, $\\nu = 0.45$, $g_{0} = 0.20$, $g_{1} = 0.05$, $r_{c} = 0.15\\,R$, $r_{V} = 0.50\\,R$, $p_{\\mathrm{in}} = 1200\\,\\mathrm{Pa}$, $\\beta = 3\\times 10^{-4}\\,\\mathrm{Pa}^{-1}$.\n- Case $2$ (uniform growth, boundary condition sanity check):\n  - $R = 5\\times 10^{-4}\\,\\mathrm{m}$, $E = 3000\\,\\mathrm{Pa}$, $\\nu = 0.45$, $g_{0} = 0.10$, $g_{1} = 0.10$, $r_{c} = R$ (effectively uniform), $r_{V} = 0.50\\,R$, $p_{\\mathrm{in}} = 1200\\,\\mathrm{Pa}$, $\\beta = 3\\times 10^{-4}\\,\\mathrm{Pa}^{-1}$.\n- Case $3$ (severe central growth, near-core vessel, edge case):\n  - $R = 5\\times 10^{-4}\\,\\mathrm{m}$, $E = 3000\\,\\mathrm{Pa}$, $\\nu = 0.45$, $g_{0} = 0.50$, $g_{1} = 0.00$, $r_{c} = 0.30\\,R$, $r_{V} = 0.10\\,R$, $p_{\\mathrm{in}} = 500\\,\\mathrm{Pa}$, $\\beta = 6\\times 10^{-4}\\,\\mathrm{Pa}^{-1}$.\n- Case $4$ (severe central growth, peripheral vessel):\n  - $R = 5\\times 10^{-4}\\,\\mathrm{m}$, $E = 3000\\,\\mathrm{Pa}$, $\\nu = 0.45$, $g_{0} = 0.50$, $g_{1} = 0.00$, $r_{c} = 0.30\\,R$, $r_{V} = 0.90\\,R$, $p_{\\mathrm{in}} = 500\\,\\mathrm{Pa}$, $\\beta = 6\\times 10^{-4}\\,\\mathrm{Pa}^{-1}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, namely the four $q_{\\mathrm{rel}}$ values for Cases $1$ through $4$ in order (e.g., $[q_{1},q_{2},q_{3},q_{4}]$).",
            "solution": "The user has provided a problem in the field of biomechanics, specifically concerning the mechanics of a growing tumor spheroid. The problem is to determine the reduction in hydraulic conductance of a blood vessel embedded within the tumor due to solid stress generated by heterogeneous growth. The problem is mathematically formulated as a second-order linear ordinary differential equation (ODE) for the radial displacement field, subject to a set of boundary conditions.\n\nThe problem statement is validated to be scientifically sound, well-posed, and complete. It is based on established principles of continuum mechanics, specifically linear elasticity with eigenstrains, applied to a spherically symmetric system. The governing equations are correctly derived, and all necessary material parameters, geometric values, and boundary conditions are provided. The proposed numerical method, employing superposition and a shooting technique, is a standard and appropriate approach for solving linear boundary value problems (BVPs). The special case of uniform growth, which admits a simple analytical solution, serves as a valuable internal consistency check. The problem is therefore deemed valid and a solution will be presented.\n\nThe core of the problem is to solve the following BVP for the radial displacement $u(r)$:\n$$\n(2G+\\lambda)\\,\\dfrac{d^{2}u}{dr^{2}} + \\dfrac{2\\lambda+4G}{r}\\,\\dfrac{du}{dr} - \\dfrac{2\\lambda+4G}{r^{2}}\\,u = (2G+3\\lambda)\\,\\dfrac{dg}{dr}\n$$\nsubject to the boundary conditions $u(0) = 0$ (regularity at the center) and $\\sigma_{rr}(R) = 0$ (traction-free surface). The radial stress $\\sigma_{rr}$ is given by:\n$$\n\\sigma_{rr}(r) = (2G+\\lambda)\\,\\dfrac{du}{dr} + 2\\lambda\\,\\dfrac{u}{r} - (2G+3\\lambda)\\,g(r)\n$$\nThe material's Lamé parameters, $G$ and $\\lambda$, are derived from the given Young's modulus $E$ and Poisson's ratio $\\nu$.\n\nThe ODE is linear, which permits the use of the principle of superposition. We can decompose the solution $u(r)$ into the sum of a homogeneous solution $u_h(r)$ and a particular solution $u_p(r)$. The problem statement guides us to a specific form of this approach, which is a shooting method based on superposition. We define two-component solutions, $u_1(r)$ and $u_0(r)$, and find the total solution $u(r) = a\\,u_1(r) + u_0(r)$, where $a$ is a constant determined by the boundary condition at $r=R$.\n\nLet's define the two subproblems:\n1.  **Homogeneous Problem:** We seek a solution $u_1(r)$ to the homogeneous ODE (where the right-hand side is zero) that satisfies the regularity condition at the origin.\n    $$\n    (2G+\\lambda)\\,\\dfrac{d^{2}u_{1}}{dr^{2}} + \\dfrac{2\\lambda+4G}{r}\\,\\dfrac{du_{1}}{dr} - \\dfrac{2\\lambda+4G}{r^{2}}\\,u_{1} = 0\n    $$\n    with $u_1(0)=0$. This is a Cauchy-Euler type equation, and its regular solution (finite at $r=0$) is of the form $u_1(r) = C r$ for some constant $C$. To define a specific basis solution, we impose an initial condition on its derivative, as suggested by the problem: $u_1'(0) = 1$. This yields $C=1$, so the analytical solution for this part is simply $u_1(r) = r$.\n\n2.  **Inhomogeneous Problem:** We seek a particular solution $u_0(r)$ to the full inhomogeneous ODE, subject to a convenient set of initial conditions that respect the regularity at the origin. The problem specifies $u_0(0)=0$ and $u_0'(0)=0$.\n    $$\n    (2G+\\lambda)\\,\\dfrac{d^{2}u_{0}}{dr^{2}} + \\dfrac{2\\lambda+4G}{r}\\,\\dfrac{du_{0}}{dr} - \\dfrac{2\\lambda+4G}{r^{2}}\\,u_{0} = (2G+3\\lambda)\\,\\dfrac{dg}{dr}\n    $$\n    This equation must be solved numerically.\n\nThe ODE is singular at $r=0$ due to the $1/r$ and $1/r^2$ terms. Standard numerical ODE solvers cannot start integration at $r=0$. We must use an asymptotic analysis to find the behavior of the solution near $r=0$ and start the integration at a small radius $\\epsilon > 0$.\nThe growth profile is $g(r) = g_{1} + (g_{0} - g_{1})\\,\\exp(-r^2/r_{c}^2)$. Its derivative is $g'(r) = -2r/r_c^2\\,(g_{0} - g_{1})\\,\\exp(-r^2/r_c^2)$. For small $r$, $g'(r) \\approx \\left( -2(g_0-g_1)/r_c^2 \\right) r$. The right-hand side of the ODE is proportional to $r$ near the origin.\nBy substituting a power series $u_0(r) = a_0 + a_1 r + a_2 r^2 + a_3 r^3 + \\dots$ into the ODE, and using the initial conditions $u_0(0)=0$ and $u_0'(0)=0$, we find that $a_0=a_1=a_2=0$, and the leading term is $u_0(r) \\approx a_3 r^3$. The coefficient $a_3$ is found to be:\n$$\na_3 = \\frac{1}{6+2k} \\left(\\frac{2G+3\\lambda}{2G+\\lambda}\\right) \\left(\\frac{-2(g_0-g_1)}{r_c^2}\\right) \\quad \\text{where} \\quad k = \\frac{2\\lambda+4G}{2G+\\lambda}\n$$\nThus, for the numerical integration of $u_0(r)$, we start at $r=\\epsilon$ with initial conditions $u_0(\\epsilon) = a_3 \\epsilon^3$ and $u_0'(\\epsilon) = 3a_3 \\epsilon^2$.\n\nWith the solutions $u_1(r)$ and $u_0(r)$ determined, we construct the full solution $u(r) = a\\,u_1(r) + u_0(r)$. The constant $a$ is found by imposing the traction-free boundary condition $\\sigma_{rr}(R) = 0$.\nThe stress $\\sigma_{rr}$ is a linear operator on $u$. We can write $\\sigma_{rr}[u] = \\sigma_{rr}[a\\,u_1 + u_0] = a\\,\\sigma_{rr}^{(1)}[u_1] + \\sigma_{rr}^{(0)}[u_0, g]$.\nLet us define the stress terms:\n$\\sigma_{rr}^{(1)}(r) = (2G+\\lambda)u_1' + \\frac{2\\lambda}{r}u_1$ (Note: the $g(r)$ term is not associated with the homogeneous solution).\n$\\sigma_{rr}^{(0)}(r) = (2G+\\lambda)u_0' + \\frac{2\\lambda}{r}u_0 - (2G+3\\lambda)g(r)$.\nThe boundary condition becomes $a\\,\\sigma_{rr}^{(1)}(R) + \\sigma_{rr}^{(0)}(R) = 0$, which gives:\n$$\na = -\\frac{\\sigma_{rr}^{(0)}(R)}{\\sigma_{rr}^{(1)}(R)}\n$$\nFor our choice $u_1(r)=r$, we have $u_1'(r)=1$, so $\\sigma_{rr}^{(1)}(R) = (2G+\\lambda) \\cdot 1 + 2\\lambda \\cdot \\frac{R}{R} = 2G+3\\lambda$, which is never zero for physically meaningful materials.\n\nOnce $a$ is known, we have the complete displacement solution $u(r)$ and its derivative $u'(r)$. We can then evaluate the stresses at the vessel location $r_V$. The hydrostatic stress is:\n$$\n\\sigma_{h}(r_{V}) = \\frac{\\sigma_{rr}(r_{V}) + 2\\,\\sigma_{\\theta}(r_{V})}{3} = \\frac{2G+3\\lambda}{3} \\left( \\left.\\frac{du}{dr}\\right|_{r_V} + 2 \\frac{u(r_V)}{r_V} - 3g(r_V) \\right)\n$$\nFrom this, we compute the net compressive stress $\\sigma_{\\mathrm{ext}}^{+}(r_V) = \\max(0, \\sigma_{h}(r_{V}) - p_{\\mathrm{in}})$, and finally the normalized hydraulic conductance:\n$$\nq_{\\mathrm{rel}} = \\max\\left(0,\\,1 - \\beta\\,\\sigma_{\\mathrm{ext}}^{+}(r_{V})\\right)^{4}\n$$\n\nThe procedure is implemented for each test case:\n1.  Set the parameters for the case.\n2.  Calculate material constants $G, \\lambda, k$.\n3.  Solve the inhomogeneous IVP for $u_0(r)$ from $r=\\epsilon$ to $r=R$ using `scipy.integrate.solve_ivp` with the derived small-radius initial conditions, requesting dense output.\n4.  Use the analytical solution for the homogeneous part: $u_1(r)=r$ and $u_1'(r)=1$.\n5.  Calculate the superposition constant $a$ using the solution values at $r=R$.\n6.  Construct the full solution $u(r_V)$ and $u'(r_V)$ at the vessel location $r_V$ using the dense output from the solver and the analytical form of $u_1$.\n7.  Calculate $\\sigma_h(r_V)$ and subsequently $q_{\\mathrm{rel}}$.\n8.  For Case 2, where growth is uniform ($g_0=g_1$), $g'(r)=0$. The analytical solution is $u(r)=g_0 r$, which leads to zero stress everywhere. This yields $q_{\\mathrm{rel}}=1$, providing a benchmark for the numerical code.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main solver function that iterates through test cases and prints the results.\n    \"\"\"\n    test_cases = [\n        # Case 1: Moderate heterogeneity\n        {'R': 5e-4, 'E': 3000, 'nu': 0.45, 'g0': 0.20, 'g1': 0.05, \n         'rc_factor': 0.15, 'rv_factor': 0.50, 'p_in': 1200, 'beta': 3e-4, 'case':1},\n        # Case 2: Uniform growth (sanity check)\n        {'R': 5e-4, 'E': 3000, 'nu': 0.45, 'g0': 0.10, 'g1': 0.10, \n         'rc_factor': 1.0, 'rv_factor': 0.50, 'p_in': 1200, 'beta': 3e-4, 'case':2},\n        # Case 3: Severe central growth, near-core vessel\n        {'R': 5e-4, 'E': 3000, 'nu': 0.45, 'g0': 0.50, 'g1': 0.00, \n         'rc_factor': 0.30, 'rv_factor': 0.10, 'p_in': 500, 'beta': 6e-4, 'case':3},\n        # Case 4: Severe central growth, peripheral vessel\n        {'R': 5e-4, 'E': 3000, 'nu': 0.45, 'g0': 0.50, 'g1': 0.00, \n         'rc_factor': 0.30, 'rv_factor': 0.90, 'p_in': 500, 'beta': 6e-4, 'case':4},\n    ]\n\n    results = []\n    for params in test_cases:\n        result = calculate_q_rel(params)\n        results.append(f\"{result:.7f}\") # Sufficient precision for output\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_q_rel(params):\n    \"\"\"\n    Calculates the normalized hydraulic conductance for a single set of parameters.\n    \"\"\"\n    # Unpack parameters\n    R, E, nu = params['R'], params['E'], params['nu']\n    g0, g1 = params['g0'], params['g1']\n    rc = params['rc_factor'] * R\n    r_V = params['rv_factor'] * R\n    p_in, beta = params['p_in'], params['beta']\n\n    # Material properties (Lamé parameters)\n    G = E / (2 * (1 + nu))\n    lam = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n    \n    # ODE coefficients and constants\n    C_2G_lam = 2 * G + lam\n    C_2lam_4G = 2 * lam + 4 * G\n    C_2G_3lam = 2 * G + 3 * lam\n\n    if C_2G_lam == 0: return np.nan\n    k = C_2lam_4G / C_2G_lam\n\n    # Define growth profile and its derivative\n    def g(r, g0_p, g1_p, rc_p):\n        return g1_p + (g0_p - g1_p) * np.exp(-(r / rc_p)**2)\n\n    def dg_dr(r, g0_p, g1_p, rc_p):\n        return (g0_p - g1_p) * np.exp(-(r / rc_p)**2) * (-2 * r / rc_p**2)\n\n    # Define the ODE system y' = f(r, y) where y = [u, du/dr]\n    def ode_system(r, y, ode_params):\n        u, du_dr = y\n        k_val, C1_lam_val, g_params = ode_params\n        g0_s, g1_s, rc_s = g_params\n        \n        # This check is mostly for safety, as r_span starts at epsilon > 0\n        if r == 0: return np.array([du_dr, 0.0])\n\n        dg_dr_val = dg_dr(r, g0_s, g1_s, rc_s)\n        d2u_dr2 = (-k_val / r) * du_dr + (k_val / r**2) * u + (C_2G_3lam / C_2G_lam) * dg_dr_val\n        \n        return np.array([du_dr, d2u_dr2])\n\n    # Small radius for starting integration to avoid singularity at r=0\n    epsilon = 1e-8 * R\n\n    # --- 1. Solve for the inhomogeneous part u_0(r) ---\n    \n    # Small-r asymptotic analysis for u_0(r) ~ a3 * r^3\n    a3 = 0.0\n    if abs(g0 - g1) > 1e-12 and rc > 0: # Avoid division by zero\n        # a_3 = 1/(6+2k) * (C_2G_3lam/C_2G_lam) * (g0-g1)*(-2/rc^2)\n        a3 = (1.0 / (6.0 + 2.0 * k)) * (C_2G_3lam / C_2G_lam) * (g0 - g1) * (-2.0 / rc**2)\n\n    # Initial conditions for u_0 at r = epsilon\n    u0_eps = a3 * epsilon**3\n    du0dr_eps = 3 * a3 * epsilon**2\n    y0_init = np.array([u0_eps, du0dr_eps])\n\n    r_span = [epsilon, R]\n    ode_params_inhom = (k, C_2G_3lam / C_2G_lam, (g0, g1, rc))\n    sol0 = solve_ivp(\n        ode_system, r_span, y0_init, args=(ode_params_inhom,), \n        dense_output=True, method='RK45', atol=1e-9, rtol=1e-9\n    )\n\n    u0_R, du0dr_R = sol0.y[0, -1], sol0.y[1, -1]\n    u0_rV, du0dr_rV = sol0.sol(r_V)\n\n    # --- 2. Homogeneous solution u_1(r) ---\n    # The regular homogeneous solution is u_1(r) = r\n    u1_rV = r_V\n    du1dr_rV = 1.0\n\n    # --- 3. Superposition to satisfy boundary condition sigma_rr(R) = 0 ---\n\n    # Stress from u_0 solution at r=R\n    sigma_rr_0_R = C_2G_lam * du0dr_R + 2 * lam * (u0_R / R) - C_2G_3lam * g(R, g0, g1, rc)\n\n    # Stress from u_1 solution at r=R. Analytically, u_1(r)=r, u_1'(r)=1.\n    # sigma_rr_1_R = C_2G_lam * 1 + 2 * lam * (R/R) = C_2G_3lam\n    sigma_rr_1_R = C_2G_3lam\n\n    # Superposition constant 'a'\n    if abs(sigma_rr_1_R) < 1e-12: a = 0.0\n    else: a = -sigma_rr_0_R / sigma_rr_1_R\n    \n    # --- 4. Calculate final solution and stresses at r_V ---\n    u_rV = a * u1_rV + u0_rV\n    du_dr_rV = a * du1dr_rV + du0dr_rV\n\n    # Hydrostatic stress at r_V\n    # sigma_h = (C_2G_3lam/3) * (du/dr + 2*u/r - 3*g)\n    tr_mech_strain_V = du_dr_rV + 2 * u_rV / r_V - 3 * g(r_V, g0, g1, rc)\n    sigma_h_rV = (C_2G_3lam / 3.0) * tr_mech_strain_V\n\n    # --- 5. Calculate hydraulic conductance ---\n    sigma_ext_plus = max(0, sigma_h_rV - p_in)\n    r_eff_ratio = max(0, 1 - beta * sigma_ext_plus)\n    q_rel = r_eff_ratio**4\n\n    return q_rel\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}