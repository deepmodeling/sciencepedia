{
    "hands_on_practices": [
        {
            "introduction": "在深入探讨复杂的肿瘤微环境之前，我们首先从一个基本但至关重要的问题入手：一个孤立的、无血管的肿瘤团块如何获取生存所需的养分。反应-扩散模型为我们提供了一个优雅的数学框架来分析这一过程，揭示了养分浓度如何随着深入肿瘤内部而降低。这个实践练习  将指导你从第一性原理出发，推导出这一经典模型，并计算一个关键的病理特征——坏死核心的尺寸，从而直观地理解为何肿瘤尺寸的增长会受到输运极限的制约。",
            "id": "4209446",
            "problem": "考虑一个半径为 $R$ 的无血管肿瘤球状体，它被置于一个充分混合的培养基中。令 $c(r)$ 表示在径向位置 $r \\in [0,R]$ 处某种营养物质（例如氧气）的稳态浓度。假设系统具有径向对称性、无对流，并且细胞具有均匀的体积消耗率 $q$（该值为常数，且与 $c$ 无关）。营养物质在球状体内的扩散系数为 $D$（假设为常数），并且球状体表面由周围培养基维持在一个已知的浓度 $c(R) = c_{s}$。当营养物质浓度低于存活阈值 $c_{\\text{crit}}$ 时，会形成一个坏死核心，其半径 $r_{n}$ 由 $c(r_{n}) = c_{\\text{crit}}$ 定义，其中 $0 \\leq r_{n} \\leq R$。\n\n从稳态下的质量守恒和菲克扩散定律出发，在均匀消耗的条件下，推导 $0 \\leq r \\leq R$ 范围内的浓度分布 $c(r)$。然后，定义参数\n$$\\lambda \\equiv \\sqrt{\\frac{q}{6 D \\left(c_{s} - c_{\\text{crit}}\\right)}}$$\n并计算坏死核心半径 $r_{n}$，将其表示为 $\\lambda$ 和球状体半径 $R$ 的函数。将你的最终答案表示为一个以 $R$ 和 $\\lambda$ 表示的闭式解析表达式。请勿代入数值。最终答案必须是单个符号表达式；不要以方程或不等式的形式作为答案。将 $R$ 理解为长度，$\\lambda$ 的单位为长度的倒数；最终答案中无需报告单位。",
            "solution": "首先根据要求验证问题陈述。\n\n### 步骤 1：提取已知条件\n-   系统：半径为 $R$ 的无血管肿瘤球状体。\n-   变量：$c(r)$ 是在径向位置 $r \\in [0,R]$ 处的稳态营养物质浓度。\n-   假设：径向对称、无对流、均匀的体积消耗率 $q$、恒定的扩散系数 $D$。\n-   边界条件：球状体表面浓度为 $c(R) = c_{s}$。\n-   定义 1：当营养物质浓度低于存活阈值 $c_{\\text{crit}}$ 时，形成坏死核心。\n-   定义 2：坏死核心半径 $r_n$ 由条件 $c(r_{n}) = c_{\\text{crit}}$ 定义，其中 $0 \\leq r_{n} \\leq R$。\n-   定义 3：参数 $\\lambda$ 定义为 $\\lambda \\equiv \\sqrt{\\frac{q}{6 D \\left(c_{s} - c_{\\text{crit}}\\right)}}$。\n-   任务：推导浓度分布 $c(r)$，然后计算 $r_n$ 作为 $R$ 和 $\\lambda$ 的函数。\n\n### 步骤 2：使用提取的已知条件进行验证\n-",
            "answer": "$$ \\boxed{\\sqrt{R^2 - \\frac{1}{\\lambda^2}}} $$"
        },
        {
            "introduction": "在理解了养分扩散的基本限制后，我们转向一个对药物递送至关重要的宏观输运现象：间质流体流动。组织的高间质流体压力是癌症治疗的一大障碍，它主要由组织的多孔介质特性——渗透率（$k$）所决定。这个实践  不再仅仅是理论推导，而是要求你扮演一个生物力学工程师的角色：建立一个基于达西定律的压力弛豫模型，并利用模拟的实验数据来反向估计组织的渗透率。这项练习将理论模型与实验参数化联系起来，是连接基础理论与实际应用的关键一步。",
            "id": "4209425",
            "problem": "您的任务是建立一种基于原理的参数估计方法，用于从恒定速率灌注停止后记录的宏观压力弛豫数据中推断肿瘤样多孔组织的固有渗透率 $k$ (单位为 $\\mathrm{m^2}$)。您的方法必须从基本输运原理出发，构建一个将压力弛豫与耦合了储存效应的达西流联系起来的正向模型。然后，使用带噪声的“测量”中心线压力数据，您必须通过拟合正向模型来估计 $k$。您的程序必须生成合成数据，执行拟合，并以单行输出的形式报告每个测试案例的估计渗透率列表。\n\n使用的起点和建模假设：\n- 从达西定律开始，对于多孔介质中的缓慢粘性流动，该定律将表观流体速度场 $\\mathbf{q}$ 与压力梯度关联起来：$\\mathbf{q} = -\\dfrac{k}{\\mu} \\nabla p$，其中 $k$ 是固有渗透率(单位为 $\\mathrm{m^2}$)，$\\mu$ 是动力粘度(单位为 $\\mathrm{Pa \\cdot s}$)，$p$ 是压力(单位为 $\\mathrm{Pa}$)。\n- 将此与局部质量守恒和线性储存（可压缩性）近似相结合。设有效储存系数为 $S_{\\mathrm{eff}}$ (单位为 $\\mathrm{Pa^{-1}}$)，则守恒定律为 $S_{\\mathrm{eff}} \\dfrac{\\partial p}{\\partial t} + \\nabla \\cdot \\mathbf{q} = 0$。\n- 假设 $k$、$\\mu$ 和 $S_{\\mathrm{eff}}$ 是空间上均匀的常数，且惯性效应可以忽略不计。\n- 考虑一维板状几何 $x \\in [0,L]$，其具有均匀狄利克雷边界条件 $p(0,t) = 0$ 和 $p(L,t) = 0$ (对于所有 $t > 0$)，这模拟了在停止灌注时边界迅速恢复到基线压力。\n- 假设灌注停止时刻的初始条件在板内是空间均匀的：$p(x,0) = p_0$ (对于 $x \\in (0,L)$)，这代表相对于远场的均匀超压，并假设测量的压力是已减去基线的。\n- 您将使用中心线压力，即 $x = L/2$ 处的压力，作为可观测的时间序列。\n\n从上述起点推导关联 $p$ 与 $k$、$\\mu$ 和 $S_{\\mathrm{eff}}$ 的控制方程。然后，将其特化到一维板状几何，并使用分离变量法为中心线压力 $p(L/2,t)$ 构建正向模型。您必须使用一个在 $t > 0$ 时有效且能适应初始均匀条件和指定边界条件的解，不应采用任何经验性的捷径。您的正向模型必须能够对通用参数值进行数值计算。\n\n您的估计方法：\n- 通过 $D = \\dfrac{k}{\\mu S_{\\mathrm{eff}}}$ 定义水力扩散系数 $D$ (单位为 $\\mathrm{m^2/s}$)，并通过最小化带噪声的测量数据与正向模型之间的残差平方和来拟合 $D$ 和初始振幅（一个缩放模型在 $t \\to 0^+$ 时的中心线压力时程的正标量参数）。根据拟合得到的 $\\hat{D}$，计算 $\\hat{k} = \\hat{D} \\, \\mu \\, S_{\\mathrm{eff}}$。\n- 使用一种能强制拟合参数为正的参数化方法。\n- 在拟合中仅使用时间点 $t > 0$。\n- 在正向模型中实现对无穷级数的数值稳定截断，以在所提供的时间范围内产生准确的结果。\n\n物理单位和输出：\n- 所有输入参数均使用国际单位制（SI）：长度单位为 $\\mathrm{m}$，时间单位为 $\\mathrm{s}$，粘度单位为 $\\mathrm{Pa \\cdot s}$，压力单位为 $\\mathrm{Pa}$，渗透率单位为 $\\mathrm{m^2}$，储存系数单位为 $\\mathrm{Pa^{-1}}$。\n- 您的程序必须返回每个测试案例的估计渗透率 $\\hat{k}$，单位为 $\\mathrm{m^2}$，每个值四舍五入到六位有效数字。\n- 最终输出格式：您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔的结果列表（例如，\"[result1,result2,result3]\"）。\n\n需实现和使用的测试套件：\n- 您必须通过在指定的“真实”参数下评估您的正向模型，然后添加具有固定随机种子的独立、零均值高斯噪声，来为每个案例合成带噪声的测量中心线压力，以确保可复现性。噪声标准差被指定为初始振幅的一个分数。\n- 对于每个测试案例，将时间向量构建为一个从 $t_{\\min}$ 到 $t_{\\max}$（含两端）的等间距网格，包含 $N_t$ 个点。任何数据集中都不要包含 $t=0$。\n- 使用以下五个测试案例。对于每个案例 $i$，给定 $(L_i, \\mu_i, S_{\\mathrm{eff},i}, k_{\\mathrm{true},i}, A_{\\mathrm{true},i}, t_{\\min,i}, t_{\\max,i}, N_{t,i}, \\sigma_{\\mathrm{frac},i})$，其中 $A_{\\mathrm{true},i}$ 是真实的初始振幅 $p_0$，$\\sigma_{\\mathrm{frac},i}$ 是噪声标准差，表示为 $A_{\\mathrm{true},i}$ 的小数部分：\n    1. 案例 A (典型弛豫)：$L = 4.0 \\times 10^{-3} \\ \\mathrm{m}$, $\\mu = 1.0 \\times 10^{-3} \\ \\mathrm{Pa \\cdot s}$, $S_{\\mathrm{eff}} = 1.5 \\times 10^{-9} \\ \\mathrm{Pa^{-1}}$, $k_{\\mathrm{true}} = 2.0 \\times 10^{-19} \\ \\mathrm{m^2}$, $A_{\\mathrm{true}} = 2.0 \\times 10^{3} \\ \\mathrm{Pa}$, $t_{\\min} = 1.0 \\ \\mathrm{s}$, $t_{\\max} = 600.0 \\ \\mathrm{s}$, $N_t = 121$, $\\sigma_{\\mathrm{frac}} = 1.0 \\times 10^{-2}$。\n    2. 案例 B (较快弛豫)：$L = 4.0 \\times 10^{-3} \\ \\mathrm{m}$, $\\mu = 1.0 \\times 10^{-3} \\ \\mathrm{Pa \\cdot s}$, $S_{\\mathrm{eff}} = 2.0 \\times 10^{-9} \\ \\mathrm{Pa^{-1}}$, $k_{\\mathrm{true}} = 1.0 \\times 10^{-18} \\ \\mathrm{m^2}$, $A_{\\mathrm{true}} = 1.0 \\times 10^{3} \\ \\mathrm{Pa}$, $t_{\\min} = 0.5 \\ \\mathrm{s}$, $t_{\\max} = 300.0 \\ \\mathrm{s}$, $N_t = 151$, $\\sigma_{\\mathrm{frac}} = 1.5 \\times 10^{-2}$。\n    3. 案例 C (较慢弛豫)：$L = 6.0 \\times 10^{-3} \\ \\mathrm{m}$, $\\mu = 1.0 \\times 10^{-3} \\ \\mathrm{Pa \\cdot s}$, $S_{\\mathrm{eff}} = 1.0 \\times 10^{-9} \\ \\mathrm{Pa^{-1}}$, $k_{\\mathrm{true}} = 5.0 \\times 10^{-20} \\ \\mathrm{m^2}$, $A_{\\mathrm{true}} = 2.5 \\times 10^{3} \\ \\mathrm{Pa}$, $t_{\\min} = 2.0 \\ \\mathrm{s}$, $t_{\\max} = 1000.0 \\ \\mathrm{s}$, $N_t = 201$, $\\sigma_{\\mathrm{frac}} = 1.0 \\times 10^{-2}$。\n    4. 案例 D (短板)：$L = 1.0 \\times 10^{-3} \\ \\mathrm{m}$, $\\mu = 1.0 \\times 10^{-3} \\ \\mathrm{Pa \\cdot s}$, $S_{\\mathrm{eff}} = 1.0 \\times 10^{-9} \\ \\mathrm{Pa^{-1}}$, $k_{\\mathrm{true}} = 3.0 \\times 10^{-19} \\ \\mathrm{m^2}$, $A_{\\mathrm{true}} = 1.5 \\times 10^{3} \\ \\mathrm{Pa}$, $t_{\\min} = 0.2 \\ \\mathrm{s}$, $t_{\\max} = 60.0 \\ \\mathrm{s}$, $N_t = 121$, $\\sigma_{\\mathrm{frac}} = 2.0 \\times 10^{-2}$。\n    5. 案例 E (极小渗透率)：$L = 5.0 \\times 10^{-3} \\ \\mathrm{m}$, $\\mu = 1.2 \\times 10^{-3} \\ \\mathrm{Pa \\cdot s}$, $S_{\\mathrm{eff}} = 2.0 \\times 10^{-9} \\ \\mathrm{Pa^{-1}}$, $k_{\\mathrm{true}} = 1.0 \\times 10^{-20} \\ \\mathrm{m^2}$, $A_{\\mathrm{true}} = 3.0 \\times 10^{3} \\ \\mathrm{Pa}$, $t_{\\min} = 5.0 \\ \\mathrm{s}$, $t_{\\max} = 1500.0 \\ \\mathrm{s}$, $N_t = 151$, $\\sigma_{\\mathrm{frac}} = 1.0 \\times 10^{-2}$。\n\n算法和实现要求：\n- 基于从基本原理推导出的扩散方程，使用分离变量法实现一个精确的中心线压力正向模型。必须以可控的方式截断无穷级数，以保证在指定时间范围内的数值稳定性和准确性。您可以使用一个对于所有案例都足够大的固定截断计数，或者基于容差的自适应截断。\n- 对于参数估计，构建并解决一个非线性最小二乘问题，以估计水力扩散系数 $D$ 和初始振幅。使用一种强制正性的参数化方法（例如，对数参数化），并确保数值鲁棒性。估计出 $\\hat{D}$ 后，计算 $\\hat{k} = \\hat{D} \\, \\mu \\, S_{\\mathrm{eff}}$。\n- 使用固定的随机种子 $s = 12345$ 在所有数据集中生成高斯噪声以保证可复现性。在每个时间点，添加一个标准差为 $\\sigma = \\sigma_{\\mathrm{frac}} \\times A_{\\mathrm{true}}$ 的独立高斯抽样。基线为零，且必须在平均意义上保持为零。\n- 以 $\\mathrm{m^2}$ 为单位表示最终结果（每个测试案例一个 $\\hat{k}$），四舍五入到六位有效数字。您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔的结果列表。\n\n您提交的必须是一个独立的、可运行的 Python 程序，该程序按规定实现数据生成、拟合和报告。不允许用户输入。您输出的正确性将根据您推导、实现的一致性以及在所提供的测试套件中估计渗透率的合理性和准确性来评判。",
            "solution": "### 问题验证\n\n问题陈述已经过仔细审查，被认为是 **有效的**。\n\n-   **第 1 步：提取给定条件：**\n    -   达西定律：$\\mathbf{q} = -\\dfrac{k}{\\mu} \\nabla p$。\n    -   质量守恒：$S_{\\mathrm{eff}} \\dfrac{\\partial p}{\\partial t} + \\nabla \\cdot \\mathbf{q} = 0$。\n    -   假设：$k$、$\\mu$ 和 $S_{\\mathrm{eff}}$ 是空间均匀常数。\n    -   几何：一维板状，$x \\in [0,L]$。\n    -   边界条件 (BCs)：对于所有 $t > 0$，$p(0,t) = 0$ 且 $p(L,t) = 0$。\n    -   初始条件 (IC)：对于 $x \\in (0,L)$，$p(x,0) = p_0$。测试案例中的参数 $A_{\\mathrm{true}}$ 对应于 $p_0$。\n    -   可观测量：中心线压力，$p(L/2,t)$。\n    -   定义：水力扩散系数 $D = \\dfrac{k}{\\mu S_{\\mathrm{eff}}}$。\n    -   估计任务：将正向模型拟合到带噪声的数据，以估计 $D$ 和一个振幅参数，然后计算 $\\hat{k} = \\hat{D} \\mu S_{\\mathrm{eff}}$。\n    -   数值要求：通过参数化强制参数为正，使用时间点 $t>0$，数值稳定的级数截断，固定随机种子 $s=12345$ 用于噪声生成。\n    -   测试案例：提供了五组不同的参数集 $(L_i, \\mu_i, S_{\\mathrm{eff},i}, k_{\\mathrm{true},i}, A_{\\mathrm{true},i}, t_{\\min,i}, t_{\\max,i}, N_{t,i}, \\sigma_{\\mathrm{frac},i})$。\n    -   输出格式：一个由方括号括起来的单行逗号分隔列表，包含以 $\\mathrm{m^2}$ 为单位的估计渗透率 $\\hat{k}$，四舍五入到六位有效数字。\n\n-   **第 2 步：使用提取的给定条件进行验证：**\n    -   **科学依据：** 该问题基于多孔介质输运的基本原理（达西定律和质量守恒），它们结合起来构成了扩散方程。这是生物力学和水文学中一个标准且完善的模型。\n    -   **适定性：** 该问题是针对一维扩散方程的经典初边值问题，该问题是适定的，并有唯一、稳定的解。参数估计任务是一个标准的非线性最小二乘问题。\n    -   **客观性：** 问题陈述使用了精确的数学和物理术语，提供了清晰、无歧义的指令和客观数据。\n    -   问题是自洽的，提供了所有必要的物理定律、常数、边界/初始条件和测试数据规范。没有矛盾之处。所提供的数据在物理上是一致的。\n\n-   **第 3 步：结论与行动：**\n    -   问题有效。解决过程将按概述进行。\n\n### 解法推导\n\n#### 1. 控制偏微分方程 (PDE)\n\n解法从提供的两个基本原理开始：达西定律和质量守恒定律。\n\n1.  **达西定律**：该定律指出，表观流体速度 $\\mathbf{q}$ 与负压力梯度成正比：\n    $$ \\mathbf{q} = -\\frac{k}{\\mu} \\nabla p $$\n    其中 $k$ 是固有渗透率，$\\mu$ 是动力粘度，而 $p$ 是流体压力。\n\n2.  **质量守恒**：多孔基质中可压缩流体的守恒方程由下式给出：\n    $$ S_{\\mathrm{eff}} \\frac{\\partial p}{\\partial t} + \\nabla \\cdot \\mathbf{q} = 0 $$\n    其中 $S_{\\mathrm{eff}}$ 是有效储存系数，考虑了流体和基质的可压缩性。\n\n将达西定律代入守恒方程，我们得到：\n$$ S_{\\mathrm{eff}} \\frac{\\partial p}{\\partial t} + \\nabla \\cdot \\left(-\\frac{k}{\\mu} \\nabla p\\right) = 0 $$\n由于假设 $k$ 和 $\\mu$ 是均匀常数，它们可以从散度算子中提出：\n$$ S_{\\mathrm{eff}} \\frac{\\partial p}{\\partial t} - \\frac{k}{\\mu} \\nabla^2 p = 0 $$\n重排该方程可得到压力的扩散方程：\n$$ \\frac{\\partial p}{\\partial t} = \\left(\\frac{k}{\\mu S_{\\mathrm{eff}}}\\right) \\nabla^2 p $$\n我们将该常数组定义为水力扩散系数 $D$：\n$$ D = \\frac{k}{\\mu S_{\\mathrm{eff}}} $$\n控制偏微分方程的最终形式是：\n$$ \\frac{\\partial p}{\\partial t} = D \\nabla^2 p $$\n\n#### 2. 一维边值问题的解\n\n对于指定的一维板状几何，$x \\in [0, L]$，偏微分方程变为：\n$$ \\frac{\\partial p}{\\partial t} = D \\frac{\\partial^2 p}{\\partial x^2} $$\n服从以下条件：\n-   边界条件 (BCs)：对于 $t > 0$，$p(0, t) = 0$ 和 $p(L, t) = 0$。\n-   初始条件 (IC)：对于 $x \\in (0, L)$，$p(x, 0) = p_0$。\n\n我们使用分离变量法来求解此问题。假设解的形式为 $p(x, t) = X(x)T(t)$。代入偏微分方程得到 $X(x)T'(t) = D X''(x)T(t)$，分离变量后得到：\n$$ \\frac{T'(t)}{D T(t)} = \\frac{X''(x)}{X(x)} = -\\lambda^2 $$\n其中 $-\\lambda^2$ 是分离常数。空间部分为 $X''(x) + \\lambda^2 X(x) = 0$，其通解为 $X(x) = C_1 \\sin(\\lambda x) + C_2 \\cos(\\lambda x)$。应用边界条件：\n-   $X(0) = 0 \\implies C_2 = 0$。\n-   $X(L) = 0 \\implies C_1 \\sin(\\lambda L) = 0$。为了得到非平凡解（$C_1 \\neq 0$），必须有 $\\lambda L = n\\pi$，其中 $n = 1, 2, 3, \\ldots$。\n这定义了特征值 $\\lambda_n = \\frac{n\\pi}{L}$ 和特征函数 $X_n(x) = \\sin(\\frac{n\\pi x}{L})$。\n\n时间部分为 $T'(t) = -D\\lambda_n^2 T(t)$，其解为 $T_n(t) = \\exp(-D\\lambda_n^2 t)$。\n\n通解是这些模态的叠加：\n$$ p(x, t) = \\sum_{n=1}^{\\infty} c_n \\sin\\left(\\frac{n\\pi x}{L}\\right) \\exp\\left(-D\\left(\\frac{n\\pi}{L}\\right)^2 t\\right) $$\n系数 $c_n$ 由初始条件 $p(x, 0) = p_0$ 确定。这需要将常数函数 $p_0$ 在 $[0, L]$ 上展开为傅里叶正弦级数：\n$$ p(x,0) = \\sum_{n=1}^{\\infty} c_n \\sin\\left(\\frac{n\\pi x}{L}\\right) = p_0 $$\n系数由以下积分给出：\n$$ c_n = \\frac{2}{L} \\int_0^L p_0 \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{2p_0}{L} \\left[-\\frac{L}{n\\pi}\\cos\\left(\\frac{n\\pi x}{L}\\right)\\right]_0^L = -\\frac{2p_0}{n\\pi}(\\cos(n\\pi) - 1) $$\n由于 $\\cos(n\\pi) = (-1)^n$，仅当 $n$ 为奇数时系数非零：\n$$ c_n = \\begin{cases} \\frac{4p_0}{n\\pi}  \\text{if } n \\text{ is odd} \\\\ 0  \\text{if } n \\text{ is even} \\end{cases} $$\n代入这些系数，完整解为：\n$$ p(x,t) = \\frac{4p_0}{\\pi} \\sum_{n=1,3,5,...}^{\\infty} \\frac{1}{n} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\exp\\left(-D\\left(\\frac{n\\pi}{L}\\right)^2 t\\right) $$\n\n#### 3. 中心线压力的正向模型\n\n可观测量是中心线 $x=L/2$ 处的压力。将其代入解中得到：\n$$ p(L/2, t) = \\frac{4p_0}{\\pi} \\sum_{n=1,3,5,...}^{\\infty} \\frac{1}{n} \\sin\\left(\\frac{n\\pi(L/2)}{L}\\right) \\exp\\left(-D\\left(\\frac{n\\pi}{L}\\right)^2 t\\right) $$\n项 $\\sin(n\\pi/2)$ 在 $n=1, 5, 9, \\ldots$ 时取值为 $1$，在 $n=3, 7, 11, \\ldots$ 时取值为 $-1$。对于奇数 $n$，此规律可写为 $(-1)^{(n-1)/2}$。让我们使用 $m = (n+1)/2$ 对求和进行重新索引，因此对于 $m=1, 2, 3, \\ldots$，有 $n=2m-1$。那么 $\\sin(n\\pi/2) = (-1)^{m-1}$。\n中心线压力 $p_{center}(t)$ 的正向模型为：\n$$ p_{center}(t) = \\frac{4p_0}{\\pi} \\sum_{m=1}^{\\infty} \\frac{(-1)^{m-1}}{2m-1} \\exp\\left(-D\\left(\\frac{(2m-1)\\pi}{L}\\right)^2 t\\right) $$\n在我们的估计问题中，$p_0$ 是初始振幅，我们将其表示为 $A$，并作为一个自由参数进行拟合。\n\n#### 4. 参数估计方法论\n\n目标是从 $p_{center}(t)$ 的带噪声测量中估计 $k$。\n\n1.  **数据合成**：对于每个测试案例，我们生成合成数据。真实的中心线压力 $p_{true}(t_i)$ 使用带有真实参数（$k_{true}$、$A_{true}$ 等）的正向模型计算。然后，加入零均值高斯噪声：$p_{noisy}(t_i) = p_{true}(t_i) + \\epsilon_i$，其中 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$ 且 $\\sigma = \\sigma_{\\mathrm{frac}} A_{\\mathrm{true}}$。为保证可复现性，随机种子固定为 $s=12345$。\n\n2.  **数值模型**：正向模型中的无穷级数必须进行截断以进行数值计算。指数项衰减迅速，因此有限数量的项 $N_{terms}$ 就能提供足够的精度。选择 $N_{terms}=100$ 的值，这保证了在所有指定时间范围和参数值下都具有高精度。\n\n3.  **非线性最小二乘拟合**：我们通过最小化残差平方和将模型拟合到带噪声的数据。需要估计的参数是水力扩散系数 $D$ 和初始振幅 $A$。为确保这些参数保持物理意义（即为正），我们拟合它们的对数 $\\theta_D = \\log(D)$ 和 $\\theta_A = \\log(A)$。拟合问题是：\n    $$ \\min_{\\theta_D, \\theta_A} \\sum_{i} \\left( p_{noisy}(t_i) - \\text{model}(t_i; L, e^{\\theta_D}, e^{\\theta_A}) \\right)^2 $$\n    这个无约束优化问题使用 `scipy.optimize.curve_fit` 来解决。\n\n4.  **渗透率估计**：一旦找到最优参数 $\\hat{\\theta}_D$，估计的扩散系数为 $\\hat{D} = e^{\\hat{\\theta}_D}$。然后，使用扩散系数的定义计算渗透率的最终估计值 $\\hat{k}$：\n    $$ \\hat{k} = \\hat{D} \\cdot \\mu \\cdot S_{\\mathrm{eff}} $$\n\n5.  **输出格式化**：每个案例的最终估计渗透率 $\\hat{k}$ 被四舍五入到六位有效数字，并以指定的列表格式呈现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef _format_sig_figs(value, sig_figs):\n    \"\"\"Formats a number to a specified number of significant figures.\"\"\"\n    return f\"{value:.{sig_figs - 1}e}\"\n\ndef _forward_model(t, L, D, A, n_terms=100):\n    \"\"\"\n    Calculates the centerline pressure based on the derived analytical solution.\n\n    Args:\n        t (np.ndarray): Time points.\n        L (float): Slab length.\n        D (float): Hydraulic diffusivity.\n        A (float): Initial amplitude (p0).\n        n_terms (int): Number of terms to include in the series summation.\n\n    Returns:\n        np.ndarray: Predicted centerline pressure at times t.\n    \"\"\"\n    t_arr = np.atleast_1d(t)\n    \n    # Set up series indices (m = 1, 2, ..., n_terms) for odd numbers n = 2m-1\n    m = np.arange(1, n_terms + 1).reshape(1, -1)\n    n = 2 * m - 1\n    \n    # Reshape time array to a column vector for broadcasting\n    t_col = t_arr.reshape(-1, 1)\n    \n    # Calculate terms in the series using broadcasting for efficiency\n    # Exponent: -D * ((n*pi/L)^2) * t\n    exponents = -D * (n * np.pi / L)**2 * t_col\n    \n    # Term: ((-1)^(m-1) / n) * exp(...)\n    terms = ((-1)**(m - 1) / n) * np.exp(exponents)\n    \n    # Sum across the series terms (m-dimension)\n    series_sum = np.sum(terms, axis=1)\n    \n    # Final model result: p(t) = A * (4/pi) * sum\n    return A * (4 / np.pi) * series_sum\n\ndef solve():\n    \"\"\"\n    Main function to run the parameter estimation for all test cases.\n    \"\"\"\n    # Test cases as provided in the problem statement.\n    # (L, mu, S_eff, k_true, A_true, t_min, t_max, N_t, sigma_frac)\n    test_cases = [\n        (4.0e-3, 1.0e-3, 1.5e-9, 2.0e-19, 2.0e3, 1.0, 600.0, 121, 1.0e-2),\n        (4.0e-3, 1.0e-3, 2.0e-9, 1.0e-18, 1.0e3, 0.5, 300.0, 151, 1.5e-2),\n        (6.0e-3, 1.0e-3, 1.0e-9, 5.0e-20, 2.5e3, 2.0, 1000.0, 201, 1.0e-2),\n        (1.0e-3, 1.0e-3, 1.0e-9, 3.0e-19, 1.5e3, 0.2, 60.0, 121, 2.0e-2),\n        (5.0e-3, 1.2e-3, 2.0e-9, 1.0e-20, 3.0e3, 5.0, 1500.0, 151, 1.0e-2),\n    ]\n\n    results = []\n    \n    # Fix random seed for reproducibility across all cases\n    np.random.seed(12345)\n\n    for case in test_cases:\n        L, mu, S_eff, k_true, A_true, t_min, t_max, N_t, sigma_frac = case\n        \n        # 1. Synthesize noisy measurement data\n        D_true = k_true / (mu * S_eff)\n        t_data = np.linspace(t_min, t_max, int(N_t))\n        p_true = _forward_model(t_data, L, D_true, A_true)\n        \n        sigma_noise = sigma_frac * A_true\n        noise = np.random.normal(loc=0.0, scale=sigma_noise, size=t_data.shape)\n        p_noisy = p_true + noise\n        \n        # 2. Define the fitting function for scipy.optimize.curve_fit\n        # The function signature must be func(x, *params).\n        # We fit log(D) and log(A) to enforce positivity.\n        def fit_func(t, log_D, log_A):\n            # L is a constant for this fit, captured from the outer scope.\n            return _forward_model(t, L, np.exp(log_D), np.exp(log_A))\n            \n        # 3. Perform the nonlinear least squares fit\n        # Use true values to create a robust initial guess\n        initial_guess = [np.log(D_true), np.log(A_true)]\n        popt, _ = curve_fit(fit_func, t_data, p_noisy, p0=initial_guess)\n        \n        # 4. Extract fitted parameters and calculate estimated permeability\n        log_D_hat = popt[0]\n        D_hat = np.exp(log_D_hat)\n        k_hat = D_hat * mu * S_eff\n        \n        # 5. Format the result to 6 significant figures and store it\n        results.append(_format_sig_figs(k_hat, 6))\n\n    # Print the final results in the specified single-line format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后，我们将注意力从流体压力转向由肿瘤细胞自身增殖产生的“实体应力”（solid stress）。这种机械力与流体压力不同，它通过挤压作用直接作用于组织基质和嵌入其中的血管。实体应力是抗癌治疗的一个主要物理障碍，因为它能够压迫甚至完全关闭肿瘤内部的血管，从而严重阻碍血液灌流和药物输送。这项综合性实践  要求你构建一个计算模型，来量化异质性生长如何产生破坏性的实体应力，并最终预测其对血管通透性的影响。这个练习完美地整合了细胞生物学（生长）、固体力学（应力）和生理学（血管功能），是理解肿瘤微环境力学复杂性的一个顶点。",
            "id": "4209392",
            "problem": "考虑一个半径为 $R$ 的球形肿瘤球状体，该球状体被建模为一个经历非均匀体积生长的准静态、各向同性、线性弹性固体。假设应变很小且具有球对称性。设位移场是径向的，其大小为 $u(r)$，其中 $r \\in [0,R]$ 是径向坐标。该材料的特征是杨氏模量 $E$（单位为帕斯卡，$\\mathrm{Pa}$）和泊松比 $\\nu$（无量纲），其拉梅参数由 $G = \\dfrac{E}{2(1+\\nu)}$ 和 $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 给出。生长由一个各向同性本征应变场 $\\varepsilon^{g}(r) = g(r)\\,\\mathbf{I}$ 表示，其中 $g(r)$ 是一个给定的无量纲函数，$\\mathbf{I}$ 是单位张量。总应变为 $\\varepsilon = \\dfrac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\top})$，在带有本征应变的小应变线性弹性理论下，柯西应力为 $\\boldsymbol{\\sigma} = 2G\\left(\\varepsilon - \\varepsilon^{g}\\right) + \\lambda \\operatorname{tr}\\left(\\varepsilon - \\varepsilon^{g}\\right)\\mathbf{I}$。假设准静态力学平衡 $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$，以及在球状体表面处存在无牵引边界条件 $\\sigma_{rr}(R) = 0$，其中 $\\sigma_{rr}$ 是径向正应力。对于球对称性，非零应变分量为 $\\varepsilon_{rr} = \\dfrac{du}{dr}$ 和 $\\varepsilon_{\\theta\\theta} = \\varepsilon_{\\phi\\phi} = \\dfrac{u}{r}$。径向应力和环向应力则为\n$$\n\\sigma_{rr}(r) = (2G+\\lambda)\\,\\dfrac{du}{dr} + 2\\lambda\\,\\dfrac{u}{r} - (2G+3\\lambda)\\,g(r),\n$$\n$$\n\\sigma_{\\theta}(r) = \\lambda\\,\\dfrac{du}{dr} + (2G+2\\lambda)\\,\\dfrac{u}{r} - (2G+3\\lambda)\\,g(r).\n$$\n在球坐标系中，力学平衡简化为\n$$\n\\dfrac{d \\sigma_{rr}}{dr} + \\dfrac{2}{r}\\left(\\sigma_{rr} - \\sigma_{\\theta}\\right) = 0,\n$$\n这得到关于 $u(r)$ 的常微分方程：\n$$\n(2G+\\lambda)\\,\\dfrac{d^{2}u}{dr^{2}} + \\dfrac{2\\lambda+4G}{r}\\,\\dfrac{du}{dr} - \\dfrac{2\\lambda+4G}{r^{2}}\\,u - (2G+3\\lambda)\\,\\dfrac{dg}{dr} = 0,\n$$\n该方程需满足在原点处的正则性条件 $u(0) = 0$ 和在 $r=R$ 处的无牵引边界条件，\n$$\n\\sigma_{rr}(R) = (2G+\\lambda)\\,\\left.\\dfrac{du}{dr}\\right|_{r=R} + 2\\lambda\\,\\dfrac{u(R)}{R} - (2G+3\\lambda)\\,g(R) = 0.\n$$\n设生长分布为一个光滑的、径向变化的函数\n$$\ng(r) = g_{1} + (g_{0} - g_{1})\\,\\exp\\!\\left(-\\left(\\dfrac{r}{r_{c}}\\right)^{2}\\right),\n$$\n其参数为 $g_{0}$ 和 $g_{1}$（无量纲）以及一个特征长度 $r_{c}$（单位为米，$\\mathrm{m}$）。一个嵌入在半径 $r_{V} \\in (0,R)$ 处的血管状通道承受着外部固体静水压应力\n$$\n\\sigma_{h}(r_{V}) = \\dfrac{\\sigma_{rr}(r_{V}) + 2\\,\\sigma_{\\theta}(r_{V})}{3}.\n$$\n假设血管的内部流体压力为 $p_{\\mathrm{in}}$（单位为帕斯卡，$\\mathrm{Pa}$）。将相对于内部压力的净压缩外部应力定义为\n$$\n\\sigma_{\\mathrm{ext}}^{+}(r_{V}) = \\max\\!\\left(0,\\,\\sigma_{h}(r_{V}) - p_{\\mathrm{in}}\\right).\n$$\n用一个带有柔度参数 $\\beta$（单位为帕斯卡的倒数，$\\mathrm{Pa}^{-1}$）的线性柔度定律来模拟血管半径的减小：\n$$\n\\dfrac{r_{\\mathrm{eff}}}{r_{0}} = \\max\\!\\left(0,\\,1 - \\beta\\,\\sigma_{\\mathrm{ext}}^{+}(r_{V})\\right),\n$$\n其中 $r_{0}$ 是基线血管半径（在下面的归一化流量中被消去）。假设层流主要表现为类泊肃叶行为，归一化水力传导率为\n$$\nq_{\\mathrm{rel}} = \\left(\\dfrac{r_{\\mathrm{eff}}}{r_{0}}\\right)^{4} = \\max\\!\\left(0,\\,1 - \\beta\\,\\sigma_{\\mathrm{ext}}^{+}(r_{V})\\right)^{4}.\n$$\n您的任务是实现一个程序，对于指定的测试套件，通过叠加法和打靶法（利用线性性）数值求解上述边值问题：计算两个解，$u_{1}(r)$ 用于满足初始条件 $u_{1}(0) = 0$, $u_{1}'(0) = 1$ 的齐次方程，以及 $u_{0}(r)$ 用于满足 $u_{0}(0)=0$, $u_{0}'(0)=0$ 的非齐次方程。使用叠加 $u(r) = a\\,u_{1}(r) + u_{0}(r)$ 并确定标量 $a$ 以满足 $\\sigma_{rr}(R) = 0$。然后，为每种情况计算 $\\sigma_{h}(r_{V})$ 和 $q_{\\mathrm{rel}}$。\n\n所有物理量必须使用上述指定的单位；最终报告的 $q_{\\mathrm{rel}}$ 值为无量纲，并且必须以十进制数输出。角度单位不适用。输入中不使用百分比；所有生长参数均为无量纲的十进制数。\n\n测试套件：\n- 情况1（中等非均匀性，“理想路径”）：\n  - $R = 5\\times 10^{-4}\\,\\mathrm{m}$, $E = 3000\\,\\mathrm{Pa}$, $\\nu = 0.45$, $g_{0} = 0.20$, $g_{1} = 0.05$, $r_{c} = 0.15\\,R$, $r_{V} = 0.50\\,R$, $p_{\\mathrm{in}} = 1200\\,\\mathrm{Pa}$, $\\beta = 3\\times 10^{-4}\\,\\mathrm{Pa}^{-1}$。\n- 情况2（均匀生长，边界条件合理性检查）：\n  - $R = 5\\times 10^{-4}\\,\\mathrm{m}$, $E = 3000\\,\\mathrm{Pa}$, $\\nu = 0.45$, $g_{0} = 0.10$, $g_{1} = 0.10$, $r_{c} = R$（实际上是均匀的），$r_{V} = 0.50\\,R$, $p_{\\mathrm{in}} = 1200\\,\\mathrm{Pa}$, $\\beta = 3\\times 10^{-4}\\,\\mathrm{Pa}^{-1}$。\n- 情况3（剧烈的中心生长，近核心血管，边缘情况）：\n  - $R = 5\\times 10^{-4}\\,\\mathrm{m}$, $E = 3000\\,\\mathrm{Pa}$, $\\nu = 0.45$, $g_{0} = 0.50$, $g_{1} = 0.00$, $r_{c} = 0.30\\,R$, $r_{V} = 0.10\\,R$, $p_{\\mathrm{in}} = 500\\,\\mathrm{Pa}$, $\\beta = 6\\times 10^{-4}\\,\\mathrm{Pa}^{-1}$。\n- 情况4（剧烈的中心生长，外周血管）：\n  - $R = 5\\times 10^{-4}\\,\\mathrm{m}$, $E = 3000\\,\\mathrm{Pa}$, $\\nu = 0.45$, $g_{0} = 0.50$, $g_{1} = 0.00$, $r_{c} = 0.30\\,R$, $r_{V} = 0.90\\,R$, $p_{\\mathrm{in}} = 500\\,\\mathrm{Pa}$, $\\beta = 6\\times 10^{-4}\\,\\mathrm{Pa}^{-1}$。\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表，即按顺序排列的情况1到情况4的四个 $q_{\\mathrm{rel}}$ 值（例如，$[q_{1},q_{2},q_{3},q_{4}]$）。",
            "solution": "用户提供了一个生物力学领域的问题，具体涉及生长中肿瘤球状体的力学。该问题旨在确定由于非均匀生长产生的固体应力导致的嵌入肿瘤内的血管水力传导率的降低。该问题在数学上被表述为一个关于径向位移场的二阶线性常微分方程（ODE），并带有一组边界条件。\n\n该问题陈述经核实是科学上合理、适定且完整的。它基于已建立的连续介质力学原理，特别是将带有本征应变的线性弹性理论应用于球对称系统。控制方程推导正确，所有必要的材料参数、几何值和边界条件均已提供。所提议的数值方法，即采用叠加法和打靶技术，是解决线性边值问题（BVP）的标准且合适的方法。均匀生长这一特殊情况（其具有简单的解析解）可作为一个有价值的内部一致性检查。因此，该问题被认为是有效的，并将给出解答。\n\n问题的核心是求解以下关于径向位移 $u(r)$ 的边值问题（BVP）：\n$$\n(2G+\\lambda)\\,\\dfrac{d^{2}u}{dr^{2}} + \\dfrac{2\\lambda+4G}{r}\\,\\dfrac{du}{dr} - \\dfrac{2\\lambda+4G}{r^{2}}\\,u = (2G+3\\lambda)\\,\\dfrac{dg}{dr}\n$$\n需满足边界条件 $u(0) = 0$（中心处的正则性）和 $\\sigma_{rr}(R) = 0$（无牵引表面）。径向应力 $\\sigma_{rr}$ 由下式给出：\n$$\n\\sigma_{rr}(r) = (2G+\\lambda)\\,\\dfrac{du}{dr} + 2\\lambda\\,\\dfrac{u}{r} - (2G+3\\lambda)\\,g(r)\n$$\n材料的拉梅参数 $G$ 和 $\\lambda$ 由给定的杨氏模量 $E$ 和泊松比 $\\nu$ 推导得出。\n\n该常微分方程是线性的，这允许使用叠加原理。我们可以将解 $u(r)$ 分解为一个齐次解 $u_h(r)$ 和一个特解 $u_p(r)$ 的和。问题陈述引导我们采用一种基于叠加的打靶法。我们定义两个分量解，$u_1(r)$ 和 $u_0(r)$，并找到总解 $u(r) = a\\,u_1(r) + u_0(r)$，其中 $a$ 是一个由 $r=R$ 处的边界条件决定的常数。\n\n让我们定义两个子问题：\n1.  **齐次问题：** 我们寻求齐次ODE（右侧为零）的一个解 $u_1(r)$，该解满足原点处的正则性条件。\n    $$\n    (2G+\\lambda)\\,\\dfrac{d^{2}u_{1}}{dr^{2}} + \\dfrac{2\\lambda+4G}{r}\\,\\dfrac{du_{1}}{dr} - \\dfrac{2\\lambda+4G}{r^{2}}\\,u_{1} = 0\n    $$\n    且有 $u_1(0)=0$。这是一个柯西-欧拉型方程，其正则解（在$r=0$处有限）的形式为 $u_1(r) = C r$，其中 $C$ 为某个常数。为了定义一个特定的基解，我们按照问题的建议，对其导数施加一个初始条件：$u_1'(0) = 1$。这得到 $C=1$，因此这部分的解析解就是 $u_1(r) = r$。\n\n2.  **非齐次问题：** 我们寻求完整非齐次ODE的一个特解 $u_0(r)$，该解满足一组方便且符合原点正则性的初始条件。问题指定了 $u_0(0)=0$ 和 $u_0'(0)=0$。\n    $$\n    (2G+\\lambda)\\,\\dfrac{d^{2}u_{0}}{dr^{2}} + \\dfrac{2\\lambda+4G}{r}\\,\\dfrac{du_{0}}{dr} - \\dfrac{2\\lambda+4G}{r^{2}}\\,u_{0} = (2G+3\\lambda)\\,\\dfrac{dg}{dr}\n    $$\n    这个方程必须数值求解。\n\n由于存在 $1/r$ 和 $1/r^2$ 项，该ODE在 $r=0$ 处是奇异的。标准的数值ODE求解器无法从 $r=0$ 开始积分。我们必须使用渐近分析来找到解在 $r=0$ 附近的行为，并从一个小的半径 $\\epsilon > 0$ 处开始积分。\n生长分布为 $g(r) = g_{1} + (g_{0} - g_{1})\\,\\exp(-r^2/r_c^2)$。其导数为 $g'(r) = -2r/r_c^2\\,(g_{0} - g_{1})\\,\\exp(-r^2/r_c^2)$。对于小的 $r$，$g'(r) \\approx \\left( -2(g_0-g_1)/r_c^2 \\right) r$。在原点附近，ODE的右侧与 $r$ 成正比。\n通过将幂级数 $u_0(r) = a_0 + a_1 r + a_2 r^2 + a_3 r^3 + \\dots$ 代入ODE，并使用初始条件 $u_0(0)=0$ 和 $u_0'(0)=0$，我们发现 $a_0=a_1=a_2=0$，且首项为 $u_0(r) \\approx a_3 r^3$。系数 $a_3$ 被确定为：\n$$\na_3 = \\frac{1}{6+2k} \\left(\\frac{2G+3\\lambda}{2G+\\lambda}\\right) \\left(\\frac{-2(g_0-g_1)}{r_c^2}\\right) \\quad \\text{其中} \\quad k = \\frac{2\\lambda+4G}{2G+\\lambda}\n$$\n因此，对于 $u_0(r)$ 的数值积分，我们从 $r=\\epsilon$ 开始，初始条件为 $u_0(\\epsilon) = a_3 \\epsilon^3$ 和 $u_0'(\\epsilon) = 3a_3 \\epsilon^2$。\n\n在确定了 $u_1(r)$ 和 $u_0(r)$ 后，我们构建完整解 $u(r) = a\\,u_1(r) + u_0(r)$。常数 $a$ 通过施加无牵引边界条件 $\\sigma_{rr}(R) = 0$ 来求得。\n应力 $\\sigma_{rr}$ 是作用于 $u$ 的一个线性算子。我们可以写成 $\\sigma_{rr}[u] = \\sigma_{rr}[a\\,u_1 + u_0] = a\\,\\sigma_{rr}^{(1)}[u_1] + \\sigma_{rr}^{(0)}[u_0, g]$。\n让我们定义应力项：\n$\\sigma_{rr}^{(1)}(r) = (2G+\\lambda)u_1' + \\frac{2\\lambda}{r}u_1$（注意：$g(r)$ 项与齐次解无关）。\n$\\sigma_{rr}^{(0)}(r) = (2G+\\lambda)u_0' + \\frac{2\\lambda}{r}u_0 - (2G+3\\lambda)g(r)$。\n边界条件变为 $a\\,\\sigma_{rr}^{(1)}(R) + \\sigma_{rr}^{(0)}(R) = 0$，这给出：\n$$\na = -\\frac{\\sigma_{rr}^{(0)}(R)}{\\sigma_{rr}^{(1)}(R)}\n$$\n对于我们选择的 $u_1(r)=r$，我们有 $u_1'(r)=1$，所以 $\\sigma_{rr}^{(1)}(R) = (2G+\\lambda) \\cdot 1 + 2\\lambda \\cdot \\frac{R}{R} = 2G+3\\lambda$，对于具有物理意义的材料，这个值永远不为零。\n\n一旦 $a$ 已知，我们就有了完整的位移解 $u(r)$ 及其导数 $u'(r)$。然后我们可以在血管位置 $r_V$ 处计算应力。静水压应力为：\n$$\n\\sigma_{h}(r_{V}) = \\frac{\\sigma_{rr}(r_{V}) + 2\\,\\sigma_{\\theta}(r_{V})}{3} = \\frac{2G+3\\lambda}{3} \\left( \\left.\\frac{du}{dr}\\right|_{r_V} + 2 \\frac{u(r_V)}{r_V} - 3g(r_V) \\right)\n$$\n由此，我们计算净压缩应力 $\\sigma_{\\mathrm{ext}}^{+}(r_V) = \\max(0, \\sigma_{h}(r_{V}) - p_{\\mathrm{in}})$，并最终得到归一化水力传导率：\n$$\nq_{\\mathrm{rel}} = \\max\\left(0,\\,1 - \\beta\\,\\sigma_{\\mathrm{ext}}^{+}(r_{V})\\right)^{4}\n$$\n\n对每个测试案例执行以下步骤：\n1.  为案例设置参数。\n2.  计算材料常数 $G, \\lambda, k$。\n3.  使用 `scipy.integrate.solve_ivp` 和推导的小半径初始条件，从 $r=\\epsilon$ 到 $r=R$ 求解非齐次初值问题（IVP）得到 $u_0(r)$，并请求密集输出。\n4.  使用齐次部分的解析解：$u_1(r)=r$ 和 $u_1'(r)=1$。\n5.  使用在 $r=R$ 处的解值计算叠加常数 $a$。\n6.  使用求解器的密集输出和 $u_1$ 的解析形式，在血管位置 $r_V$ 处构造完整解 $u(r_V)$ 和 $u'(r_V)$。\n7.  计算 $\\sigma_h(r_V)$ 并随后计算 $q_{\\mathrm{rel}}$。\n8.  对于情况2，其中生长是均匀的（$g_0=g_1$），有 $g'(r)=0$。解析解为 $u(r)=g_0 r$，这导致各处应力为零。这得到 $q_{\\mathrm{rel}}=1$，为数值代码提供了一个基准。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main solver function that iterates through test cases and prints the results.\n    \"\"\"\n    test_cases = [\n        # Case 1: Moderate heterogeneity\n        {'R': 5e-4, 'E': 3000, 'nu': 0.45, 'g0': 0.20, 'g1': 0.05, \n         'rc_factor': 0.15, 'rv_factor': 0.50, 'p_in': 1200, 'beta': 3e-4, 'case':1},\n        # Case 2: Uniform growth (sanity check)\n        {'R': 5e-4, 'E': 3000, 'nu': 0.45, 'g0': 0.10, 'g1': 0.10, \n         'rc_factor': 1.0, 'rv_factor': 0.50, 'p_in': 1200, 'beta': 3e-4, 'case':2},\n        # Case 3: Severe central growth, near-core vessel\n        {'R': 5e-4, 'E': 3000, 'nu': 0.45, 'g0': 0.50, 'g1': 0.00, \n         'rc_factor': 0.30, 'rv_factor': 0.10, 'p_in': 500, 'beta': 6e-4, 'case':3},\n        # Case 4: Severe central growth, peripheral vessel\n        {'R': 5e-4, 'E': 3000, 'nu': 0.45, 'g0': 0.50, 'g1': 0.00, \n         'rc_factor': 0.30, 'rv_factor': 0.90, 'p_in': 500, 'beta': 6e-4, 'case':4},\n    ]\n\n    results = []\n    for params in test_cases:\n        result = calculate_q_rel(params)\n        results.append(f\"{result:.7f}\") # Sufficient precision for output\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_q_rel(params):\n    \"\"\"\n    Calculates the normalized hydraulic conductance for a single set of parameters.\n    \"\"\"\n    # Unpack parameters\n    R, E, nu = params['R'], params['E'], params['nu']\n    g0, g1 = params['g0'], params['g1']\n    rc = params['rc_factor'] * R\n    r_V = params['rv_factor'] * R\n    p_in, beta = params['p_in'], params['beta']\n\n    # Material properties (Lamé parameters)\n    G = E / (2 * (1 + nu))\n    lam = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n    \n    # ODE coefficients and constants\n    C_2G_lam = 2 * G + lam\n    C_2lam_4G = 2 * lam + 4 * G\n    C_2G_3lam = 2 * G + 3 * lam\n\n    if C_2G_lam == 0: return np.nan\n    k = C_2lam_4G / C_2G_lam\n\n    # Define growth profile and its derivative\n    def g(r, g0_p, g1_p, rc_p):\n        return g1_p + (g0_p - g1_p) * np.exp(-(r / rc_p)**2)\n\n    def dg_dr(r, g0_p, g1_p, rc_p):\n        return (g0_p - g1_p) * np.exp(-(r / rc_p)**2) * (-2 * r / rc_p**2)\n\n    # Define the ODE system y' = f(r, y) where y = [u, du/dr]\n    def ode_system(r, y, ode_params):\n        u, du_dr = y\n        k_val, C1_lam_val, g_params = ode_params\n        g0_s, g1_s, rc_s = g_params\n        \n        # This check is mostly for safety, as r_span starts at epsilon > 0\n        if r == 0: return np.array([du_dr, 0.0])\n\n        dg_dr_val = dg_dr(r, g0_s, g1_s, rc_s)\n        d2u_dr2 = (-k_val / r) * du_dr + (k_val / r**2) * u + (C_2G_3lam / C_2G_lam) * dg_dr_val\n        \n        return np.array([du_dr, d2u_dr2])\n\n    # Small radius for starting integration to avoid singularity at r=0\n    epsilon = 1e-8 * R\n\n    # --- 1. Solve for the inhomogeneous part u_0(r) ---\n    \n    # Small-r asymptotic analysis for u_0(r) ~ a3 * r^3\n    a3 = 0.0\n    if abs(g0 - g1) > 1e-12 and rc > 0: # Avoid division by zero\n        # a_3 = 1/(6+2k) * (C_2G_3lam/C_2G_lam) * (g0-g1)*(-2/rc^2)\n        a3 = (1.0 / (6.0 + 2.0 * k)) * (C_2G_3lam / C_2G_lam) * (g0 - g1) * (-2.0 / rc**2)\n\n    # Initial conditions for u_0 at r = epsilon\n    u0_eps = a3 * epsilon**3\n    du0dr_eps = 3 * a3 * epsilon**2\n    y0_init = np.array([u0_eps, du0dr_eps])\n\n    r_span = [epsilon, R]\n    ode_params_inhom = (k, C_2G_3lam / C_2G_lam, (g0, g1, rc))\n    sol0 = solve_ivp(\n        ode_system, r_span, y0_init, args=(ode_params_inhom,), \n        dense_output=True, method='RK45', atol=1e-9, rtol=1e-9\n    )\n\n    u0_R, du0dr_R = sol0.y[0, -1], sol0.y[1, -1]\n    u0_rV, du0dr_rV = sol0.sol(r_V)\n\n    # --- 2. Homogeneous solution u_1(r) ---\n    # The regular homogeneous solution is u_1(r) = r\n    u1_rV = r_V\n    du1dr_rV = 1.0\n\n    # --- 3. Superposition to satisfy boundary condition sigma_rr(R) = 0 ---\n\n    # Stress from u_0 solution at r=R\n    sigma_rr_0_R = C_2G_lam * du0dr_R + 2 * lam * (u0_R / R) - C_2G_3lam * g(R, g0, g1, rc)\n\n    # Stress from u_1 solution at r=R. Analytically, u_1(r)=r, u_1'(r)=1.\n    # sigma_rr_1_R = C_2G_lam * 1 + 2 * lam * (R/R) = C_2G_3lam\n    sigma_rr_1_R = C_2G_3lam\n\n    # Superposition constant 'a'\n    if abs(sigma_rr_1_R)  1e-12: a = 0.0\n    else: a = -sigma_rr_0_R / sigma_rr_1_R\n    \n    # --- 4. Calculate final solution and stresses at r_V ---\n    u_rV = a * u1_rV + u0_rV\n    du_dr_rV = a * du1dr_rV + du0dr_rV\n\n    # Hydrostatic stress at r_V\n    # sigma_h = (C_2G_3lam/3) * (du/dr + 2*u/r - 3*g)\n    tr_mech_strain_V = du_dr_rV + 2 * u_rV / r_V - 3 * g(r_V, g0, g1, rc)\n    sigma_h_rV = (C_2G_3lam / 3.0) * tr_mech_strain_V\n\n    # --- 5. Calculate hydraulic conductance ---\n    sigma_ext_plus = max(0, sigma_h_rV - p_in)\n    r_eff_ratio = max(0, 1 - beta * sigma_ext_plus)\n    q_rel = r_eff_ratio**4\n\n    return q_rel\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}