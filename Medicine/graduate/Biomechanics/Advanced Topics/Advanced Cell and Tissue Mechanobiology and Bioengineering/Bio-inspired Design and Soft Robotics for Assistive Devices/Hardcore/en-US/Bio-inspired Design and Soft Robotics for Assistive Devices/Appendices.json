{
    "hands_on_practices": [
        {
            "introduction": "An essential first step in designing any soft robotic device is to accurately model its constituent materials. Unlike traditional rigid materials, the elastomers used in soft robotics exhibit large, nonlinear deformations. This practice  challenges you to work with the Mooney-Rivlin hyperelastic model, a foundational tool for capturing this behavior, and to derive the stress response under uniaxial tension, a common loading scenario for assistive straps and actuators.",
            "id": "4157768",
            "problem": "A bio-inspired soft robotic assistive strap made of a silicone-like elastomer is modeled as an incompressible isotropic hyperelastic material with Mooney–Rivlin strain-energy density function $W=C_1(I_1-3)+C_2(I_2-3)$, where $I_1$ and $I_2$ are the first and second invariants of the left Cauchy–Green deformation tensor, and $C_1$ and $C_2$ are material parameters. Under quasistatic uniaxial tension along the strap’s length, the lateral faces are traction-free, and the material response can be assumed to be homogeneous. Starting from fundamental continuum mechanics definitions of the deformation gradient, invariants, and the constitutive form for isotropic incompressible hyperelasticity, derive the Cauchy stress in the loading direction as a function of the uniaxial stretch $\\lambda$. Then, for a strap material characterized by $C_1=0.12$ MPa and $C_2=0.03$ MPa, compute the axial Cauchy stress at $\\lambda=1.3$. Express your final numerical answer in MPa and round your answer to four significant figures. The final answer must be a single real number.",
            "solution": "We are asked to derive the axial Cauchy stress for an incompressible isotropic hyperelastic material described by a Mooney-Rivlin model under uniaxial tension and then compute its value for a given stretch and material parameters.\n\nLet the coordinate system be aligned with the principal directions of stretch. The uniaxial tension is applied along the $x_1$ axis. The deformation gradient tensor, $\\mathbf{F}$, is given by:\n$$\n\\mathbf{F} = \\begin{pmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{pmatrix}\n$$\nIn this case of uniaxial tension, the stretch in the loading direction is $\\lambda_1 = \\lambda$. Due to the symmetry of the material and loading, the lateral stretches are equal, so $\\lambda_2 = \\lambda_3$.\n\nThe material is specified as incompressible, which imposes the kinematic constraint $\\det(\\mathbf{F}) = J = 1$. Therefore:\n$$\n\\lambda_1 \\lambda_2 \\lambda_3 = \\lambda \\lambda_2^2 = 1\n$$\nSolving for the lateral stretch $\\lambda_2$ gives:\n$$\n\\lambda_2 = \\lambda_3 = \\lambda^{-1/2}\n$$\nThe deformation gradient tensor can thus be written as:\n$$\n\\mathbf{F} = \\begin{pmatrix} \\lambda & 0 & 0 \\\\ 0 & \\lambda^{-1/2} & 0 \\\\ 0 & 0 & \\lambda^{-1/2} \\end{pmatrix}\n$$\nThe left Cauchy-Green deformation tensor, $\\mathbf{B}$, is defined as $\\mathbf{B} = \\mathbf{F}\\mathbf{F}^T$. For this diagonal $\\mathbf{F}$, we have:\n$$\n\\mathbf{B} = \\mathbf{F}^2 = \\begin{pmatrix} \\lambda^2 & 0 & 0 \\\\ 0 & \\lambda^{-1} & 0 \\\\ 0 & 0 & \\lambda^{-1} \\end{pmatrix}\n$$\nThe constitutive equation for the Cauchy stress tensor, $\\boldsymbol{\\sigma}$, for an incompressible isotropic hyperelastic material is given by:\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\frac{\\partial W}{\\partial I_1}\\mathbf{B} - 2\\frac{\\partial W}{\\partial I_2}\\mathbf{B}^{-1}\n$$\nwhere $p$ is an arbitrary hydrostatic pressure arising from the incompressibility constraint, $\\mathbf{I}$ is the identity tensor, and $W$ is the strain-energy density function dependent on the first and second invariants ($I_1$, $I_2$) of $\\mathbf{B}$.\n\nThe problem provides the Mooney-Rivlin strain-energy density function:\n$$\nW = C_1(I_1 - 3) + C_2(I_2 - 3)\n$$\nThe partial derivatives of $W$ with respect to the invariants are:\n$$\n\\frac{\\partial W}{\\partial I_1} = C_1 \\quad \\text{and} \\quad \\frac{\\partial W}{\\partial I_2} = C_2\n$$\nSubstituting these into the constitutive equation for stress yields the specific form for a Mooney-Rivlin material:\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2C_1\\mathbf{B} - 2C_2\\mathbf{B}^{-1}\n$$\nThe inverse of the left Cauchy-Green tensor, $\\mathbf{B}^{-1}$, is:\n$$\n\\mathbf{B}^{-1} = \\begin{pmatrix} \\lambda^{-2} & 0 & 0 \\\\ 0 & \\lambda & 0 \\\\ 0 & 0 & \\lambda \\end{pmatrix}\n$$\nWriting out the components of the stress tensor:\n$$\n\\sigma_{11} = -p + 2C_1(\\lambda^2) - 2C_2(\\lambda^{-2})\n$$\n$$\n\\sigma_{22} = -p + 2C_1(\\lambda^{-1}) - 2C_2(\\lambda)\n$$\n$$\n\\sigma_{33} = -p + 2C_1(\\lambda^{-1}) - 2C_2(\\lambda) = \\sigma_{22}\n$$\nThe problem states that the lateral faces are traction-free, which for uniaxial tension means the stress components normal to these faces are zero. We therefore set $\\sigma_{22} = \\sigma_{33} = 0$.\n$$\n0 = -p + 2C_1\\lambda^{-1} - 2C_2\\lambda\n$$\nFrom this condition, we solve for the hydrostatic pressure $p$:\n$$\np = 2C_1\\lambda^{-1} - 2C_2\\lambda\n$$\nNow, we substitute this expression for $p$ into the equation for the axial stress, $\\sigma_{11}$:\n$$\n\\sigma_{11} = -(2C_1\\lambda^{-1} - 2C_2\\lambda) + 2C_1\\lambda^2 - 2C_2\\lambda^{-2}\n$$\nRearranging the terms, we obtain the final expression for the Cauchy stress in the loading direction as a function of the stretch $\\lambda$:\n$$\n\\sigma_{11} = 2C_1\\lambda^2 - 2C_1\\lambda^{-1} + 2C_2\\lambda - 2C_2\\lambda^{-2}\n$$\n$$\n\\sigma_{11} = 2(\\lambda^2 - \\lambda^{-1})C_1 + 2(\\lambda - \\lambda^{-2})C_2\n$$\nThis completes the first part of the problem. For the second part, we must compute the numerical value of $\\sigma_{11}$ for the given parameters: $C_1 = 0.12$ MPa, $C_2 = 0.03$ MPa, and $\\lambda=1.3$. The units of the result will be in MPa as the parameters are given in MPa.\n\nSubstituting the values into the derived expression:\n$$\n\\sigma_{11} = 2((1.3)^2 - (1.3)^{-1})(0.12) + 2((1.3) - (1.3)^{-2})(0.03)\n$$\nFirst, we compute the powers of $\\lambda$:\n$$\n\\lambda^2 = (1.3)^2 = 1.69\n$$\n$$\n\\lambda^{-1} = \\frac{1}{1.3} \\approx 0.76923077\n$$\n$$\n\\lambda^{-2} = \\frac{1}{(1.3)^2} = \\frac{1}{1.69} \\approx 0.59171598\n$$\nNow, substitute these into the equation for $\\sigma_{11}$:\n$$\n\\sigma_{11} \\approx 2(1.69 - 0.76923077)(0.12) + 2(1.3 - 0.59171598)(0.03)\n$$\n$$\n\\sigma_{11} \\approx 2(0.92076923)(0.12) + 2(0.70828402)(0.03)\n$$\n$$\n\\sigma_{11} \\approx (1.84153846)(0.12) + (1.41656804)(0.03)\n$$\n$$\n\\sigma_{11} \\approx 0.22098462 + 0.04249704\n$$\n$$\n\\sigma_{11} \\approx 0.26348166 \\text{ MPa}\n$$\nRounding the result to four significant figures as requested:\n$$\n\\sigma_{11} \\approx 0.2635 \\text{ MPa}\n$$",
            "answer": "$$\n\\boxed{0.2635}\n$$"
        },
        {
            "introduction": "Many soft assistive devices are powered by fluidic actuation, where pressurized fluid creates motion. Understanding the relationship between pressure, geometry, and flow rate is therefore critical for designing and controlling these systems. In this exercise , you will derive the classic Hagen-Poiseuille relationship from the fundamental Navier-Stokes equations, providing a first-principles model for flow in the microchannels that drive a soft actuator.",
            "id": "4157778",
            "problem": "A wearable soft exosuit for hand assistance uses bio-inspired microhydraulic actuation to curl a finger segment, mimicking the distributed suction of an octopus arm. The actuator consists of a straight, circular microchannel embedded in Polydimethylsiloxane (PDMS). A syringe pump imposes a constant pressure drop across the channel. Assume steady, incompressible, axisymmetric flow of a Newtonian fluid, with no-slip at the channel wall, negligible entrance effects, and a fully developed axial velocity field.\n\n1) Starting from the balance of linear momentum for a Newtonian fluid, specifically the steady, incompressible Navier–Stokes equations in cylindrical coordinates, and enforcing the stated assumptions, derive a closed-form expression for the volumetric flow rate $Q$ through a straight circular tube in terms of the pressure drop $\\Delta p$, the fluid dynamic viscosity $\\mu$, the tube length $L$, and the tube radius $R$. You must begin from first principles (conservation of mass and momentum) and not use any pre-derived pipe-flow formulas.\n\n2) For a PDMS microchannel of length $L = 8.00 \\times 10^{-2}\\,\\mathrm{m}$ and radius $R = 2.50 \\times 10^{-4}\\,\\mathrm{m}$ conveying a Newtonian fluid of viscosity $\\mu = 5.00 \\times 10^{-2}\\,\\mathrm{Pa \\cdot s}$ under a static pressure drop $\\Delta p = 6.00 \\times 10^{4}\\,\\mathrm{Pa}$, compute the volumetric flow rate. Express the final flow rate in $\\mathrm{mL/min}$ and round your answer to three significant figures.",
            "solution": "### Part 1: Derivation of the Volumetric Flow Rate\n\nWe begin with the governing equations for a steady, incompressible, Newtonian fluid in cylindrical coordinates $(r, \\theta, z)$. The velocity vector is $\\vec{v} = v_r \\hat{e}_r + v_\\theta \\hat{e}_\\theta + v_z \\hat{e}_z$.\n\n**1. Conservation of Mass (Continuity Equation)**\nFor an incompressible fluid, the continuity equation is $\\nabla \\cdot \\vec{v} = 0$. In cylindrical coordinates, this is:\n$$\n\\frac{1}{r} \\frac{\\partial}{\\partial r}(r v_r) + \\frac{1}{r} \\frac{\\partial v_\\theta}{\\partial \\theta} + \\frac{\\partial v_z}{\\partial z} = 0\n$$\n\n**2. Conservation of Momentum (Navier-Stokes Equations)**\nThe steady-state Navier-Stokes equations are given by $\\rho (\\vec{v} \\cdot \\nabla)\\vec{v} = -\\nabla p + \\mu \\nabla^2 \\vec{v}$, assuming negligible body forces. The component forms are:\n$r$-momentum:\n$$\n\\rho \\left( v_r \\frac{\\partial v_r}{\\partial r} + \\frac{v_\\theta}{r} \\frac{\\partial v_r}{\\partial \\theta} - \\frac{v_\\theta^2}{r} + v_z \\frac{\\partial v_r}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial r} + \\mu \\left[ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial v_r}{\\partial r} \\right) - \\frac{v_r}{r^2} + \\frac{1}{r^2} \\frac{\\partial^2 v_r}{\\partial \\theta^2} - \\frac{2}{r^2} \\frac{\\partial v_\\theta}{\\partial \\theta} + \\frac{\\partial^2 v_r}{\\partial z^2} \\right]\n$$\n$\\theta$-momentum:\n$$\n\\rho \\left( v_r \\frac{\\partial v_\\theta}{\\partial r} + \\frac{v_\\theta}{r} \\frac{\\partial v_\\theta}{\\partial \\theta} + \\frac{v_r v_\\theta}{r} + v_z \\frac{\\partial v_\\theta}{\\partial z} \\right) = -\\frac{1}{r} \\frac{\\partial p}{\\partial \\theta} + \\mu \\left[ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial v_\\theta}{\\partial r} \\right) - \\frac{v_\\theta}{r^2} + \\frac{1}{r^2} \\frac{\\partial^2 v_\\theta}{\\partial \\theta^2} + \\frac{2}{r^2} \\frac{\\partial v_r}{\\partial \\theta} + \\frac{\\partial^2 v_\\theta}{\\partial z^2} \\right]\n$$\n$z$-momentum:\n$$\n\\rho \\left( v_r \\frac{\\partial v_z}{\\partial r} + \\frac{v_\\theta}{r} \\frac{\\partial v_z}{\\partial \\theta} + v_z \\frac{\\partial v_z}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial z} + \\mu \\left[ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial v_z}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2 v_z}{\\partial \\theta^2} + \\frac{\\partial^2 v_z}{\\partial z^2} \\right]\n$$\n\n**3. Application of Assumptions**\nWe apply the stated assumptions to simplify these equations:\n- **Axisymmetric flow:** There is no variation in the $\\theta$ direction, so $\\frac{\\partial}{\\partial \\theta}(\\text{any quantity}) = 0$. This also implies that there is no swirl, i.e., $v_\\theta = 0$.\n- **Fully developed flow:** The velocity profile does not change along the axial direction ($z$). This means $\\frac{\\partial v_z}{\\partial z} = 0$. For flow in a straight pipe of constant radius, there can be no radial velocity, so $v_r = 0$.\n- With $v_r=0$, $v_\\theta=0$, and $\\frac{\\partial v_z}{\\partial z}=0$, the continuity equation becomes $0+0+0 = 0$, which is satisfied.\n- The velocity vector simplifies to $\\vec{v} = v_z(r) \\hat{e}_z$. The axial velocity $v_z$ is a function only of the radial coordinate $r$.\n\n**4. Simplification of Momentum Equations**\nWith $v_r=0$ and $v_\\theta=0$, all convective acceleration terms (the left-hand side of the Navier-Stokes equations) become zero.\n- The $r$-momentum equation simplifies to:\n$$\n0 = -\\frac{\\partial p}{\\partial r} \\quad \\implies \\quad p \\text{ is not a function of } r.\n$$\n- The $\\theta$-momentum equation simplifies to:\n$$\n0 = -\\frac{1}{r} \\frac{\\partial p}{\\partial \\theta} \\quad \\implies \\quad p \\text{ is not a function of } \\theta.\n$$\nSince $p$ is not a function of $r$ or $\\theta$, the pressure $p$ can only be a function of the axial coordinate $z$, i.e., $p = p(z)$.\n- The $z$-momentum equation simplifies significantly. With $v_r=0$, $v_\\theta=0$, $\\frac{\\partial^2 v_z}{\\partial \\theta^2}=0$ (by axisymmetry), and $\\frac{\\partial^2 v_z}{\\partial z^2}=0$ (since $\\frac{\\partial v_z}{\\partial z}=0$ for fully developed flow), the equation becomes:\n$$\n0 = -\\frac{\\partial p}{\\partial z} + \\mu \\left[ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial v_z}{\\partial r} \\right) \\right]\n$$\nSince $p$ is only a function of $z$ and $v_z$ is only a function of $r$, we can replace the partial derivatives with ordinary derivatives:\n$$\n\\frac{dp}{dz} = \\mu \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dv_z}{dr} \\right)\n$$\nIn this equation, the left side is a function of $z$ only, and the right side is a function of $r$ only. This can only be true if both sides are equal to a constant. For a constant pressure drop $\\Delta p$ over a length $L$, the pressure gradient is constant: $\\frac{dp}{dz} = -\\frac{\\Delta p}{L}$, where $\\Delta p = p_{\\text{inlet}} - p_{\\text{outlet}} > 0$. The negative sign indicates that pressure decreases along the direction of flow.\n\n**5. Solving for the Velocity Profile**\nWe rearrange and solve the resulting ordinary differential equation:\n$$\n\\frac{d}{dr} \\left( r \\frac{dv_z}{dr} \\right) = \\frac{r}{\\mu} \\frac{dp}{dz}\n$$\nIntegrating once with respect to $r$:\n$$\nr \\frac{dv_z}{dr} = \\frac{r^2}{2\\mu} \\frac{dp}{dz} + C_1\n$$\nDividing by $r$ and integrating a second time:\n$$\n\\frac{dv_z}{dr} = \\frac{r}{2\\mu} \\frac{dp}{dz} + \\frac{C_1}{r}\n$$\n$$\nv_z(r) = \\frac{r^2}{4\\mu} \\frac{dp}{dz} + C_1 \\ln(r) + C_2\n$$\nWe apply two boundary conditions to determine the integration constants $C_1$ and $C_2$:\n- **B.C. 1:** The velocity must be finite at the centerline of the tube ($r=0$). The term $C_1 \\ln(r)$ approaches infinity as $r \\to 0$ unless $C_1=0$. Therefore, we must have $C_1=0$.\n- **B.C. 2:** The no-slip condition at the tube wall ($r=R$) requires the fluid velocity to be zero: $v_z(R)=0$.\nApplying the second boundary condition:\n$$\n0 = \\frac{R^2}{4\\mu} \\frac{dp}{dz} + C_2 \\quad \\implies \\quad C_2 = -\\frac{R^2}{4\\mu} \\frac{dp}{dz}\n$$\nSubstituting the constants back into the velocity equation gives the parabolic velocity profile:\n$$\nv_z(r) = \\frac{r^2}{4\\mu} \\frac{dp}{dz} - \\frac{R^2}{4\\mu} \\frac{dp}{dz} = \\frac{1}{4\\mu} \\frac{dp}{dz} (r^2 - R^2)\n$$\nSubstituting $\\frac{dp}{dz} = -\\frac{\\Delta p}{L}$:\n$$\nv_z(r) = \\frac{1}{4\\mu} \\left(-\\frac{\\Delta p}{L}\\right) (r^2 - R^2) = \\frac{\\Delta p}{4\\mu L} (R^2 - r^2)\n$$\n\n**6. Calculating the Volumetric Flow Rate**\nThe volumetric flow rate $Q$ is obtained by integrating the velocity profile over the tube's cross-sectional area. We consider a differential annular area $dA = 2\\pi r \\, dr$.\n$$\nQ = \\int_A v_z(r) \\, dA = \\int_{0}^{R} v_z(r) (2\\pi r) \\, dr\n$$\nSubstituting the expression for $v_z(r)$:\n$$\nQ = \\int_{0}^{R} \\frac{\\Delta p}{4\\mu L} (R^2 - r^2) (2\\pi r) \\, dr\n$$\nWe pull the constants out of the integral:\n$$\nQ = \\frac{2\\pi \\Delta p}{4\\mu L} \\int_{0}^{R} (R^2 r - r^3) \\, dr = \\frac{\\pi \\Delta p}{2\\mu L} \\int_{0}^{R} (R^2 r - r^3) \\, dr\n$$\nEvaluating the integral:\n$$\n\\int_{0}^{R} (R^2 r - r^3) \\, dr = \\left[ \\frac{R^2 r^2}{2} - \\frac{r^4}{4} \\right]_{0}^{R} = \\left( \\frac{R^4}{2} - \\frac{R^4}{4} \\right) - (0) = \\frac{R^4}{4}\n$$\nFinally, substituting this result back gives the Hagen-Poiseuille equation:\n$$\nQ = \\frac{\\pi \\Delta p}{2\\mu L} \\left( \\frac{R^4}{4} \\right) = \\frac{\\pi R^4 \\Delta p}{8\\mu L}\n$$\n\n### Part 2: Numerical Calculation\n\nWe use the derived formula to compute the volumetric flow rate $Q$ with the given values:\n- Length: $L = 8.00 \\times 10^{-2}\\,\\mathrm{m}$\n- Radius: $R = 2.50 \\times 10^{-4}\\,\\mathrm{m}$\n- Viscosity: $\\mu = 5.00 \\times 10^{-2}\\,\\mathrm{Pa \\cdot s}$\n- Pressure drop: $\\Delta p = 6.00 \\times 10^{4}\\,\\mathrm{Pa}$\n\nSubstituting these values into the equation for $Q$:\n$$\nQ = \\frac{\\pi (2.50 \\times 10^{-4}\\,\\mathrm{m})^4 (6.00 \\times 10^{4}\\,\\mathrm{Pa})}{8 (5.00 \\times 10^{-2}\\,\\mathrm{Pa \\cdot s}) (8.00 \\times 10^{-2}\\,\\mathrm{m})}\n$$\nFirst, let's evaluate the terms:\n- $R^4 = (2.50 \\times 10^{-4})^4 \\, \\mathrm{m}^4 = 39.0625 \\times 10^{-16} \\, \\mathrm{m}^4$\n- Numerator: $\\pi (39.0625 \\times 10^{-16} \\, \\mathrm{m}^4) (6.00 \\times 10^{4} \\, \\mathrm{Pa}) = \\pi (234.375 \\times 10^{-12} \\, \\mathrm{m^4 \\cdot Pa})$\n- Denominator: $8 (5.00 \\times 10^{-2} \\, \\mathrm{Pa \\cdot s}) (8.00 \\times 10^{-2} \\, \\mathrm{m}) = 3.20 \\times 10^{-2} \\, \\mathrm{Pa \\cdot s \\cdot m}$\n\nNow, we compute the value of $Q$ in SI units ($\\mathrm{m^3/s}$):\n$$\nQ = \\frac{\\pi \\times 234.375 \\times 10^{-12}}{3.20 \\times 10^{-2}} \\, \\frac{\\mathrm{m^3}}{\\mathrm{s}} \\approx 2.30093 \\times 10^{-8} \\, \\frac{\\mathrm{m^3}}{\\mathrm{s}}\n$$\nThe problem requires the answer in units of milliliters per minute ($\\mathrm{mL/min}$). We perform the unit conversion:\n- $1 \\, \\mathrm{m^3} = 10^6 \\, \\mathrm{mL}$\n- $1 \\, \\mathrm{min} = 60 \\, \\mathrm{s}$\n$$\nQ = \\left( 2.30093 \\times 10^{-8} \\, \\frac{\\mathrm{m^3}}{\\mathrm{s}} \\right) \\times \\left( \\frac{10^6 \\, \\mathrm{mL}}{1 \\, \\mathrm{m^3}} \\right) \\times \\left( \\frac{60 \\, \\mathrm{s}}{1 \\, \\mathrm{min}} \\right)\n$$\n$$\nQ = (2.30093 \\times 10^{-8}) \\times (60 \\times 10^6) \\, \\frac{\\mathrm{mL}}{\\mathrm{min}}\n$$\n$$\nQ = 2.30093 \\times 60 \\times 10^{-2} \\, \\frac{\\mathrm{mL}}{\\mathrm{min}} \\approx 1.38056 \\, \\frac{\\mathrm{mL}}{\\mathrm{min}}\n$$\nRounding the result to three significant figures, consistent with the given data:\n$$\nQ \\approx 1.38 \\, \\frac{\\mathrm{mL}}{\\mathrm{min}}\n$$",
            "answer": "$$\\boxed{1.38}$$"
        },
        {
            "introduction": "While simple models are useful, capturing the complex, large-scale bending and twisting of slender soft robots requires more advanced computational frameworks. The Cosserat rod theory provides a geometrically exact description of these continuum manipulators. This hands-on coding practice  guides you through implementing and verifying a numerical solver for the Cosserat rod equations, a core skill for simulating and designing sophisticated, bio-inspired robotic arms.",
            "id": "4157804",
            "problem": "A bio-inspired continuum manipulator for an assistive device can be idealized as a planar Cosserat rod. The rod’s centerline is parameterized by arc length $s \\in [0,L]$ with position vector $\\mathbf{r}(s) \\in \\mathbb{R}^2$ and plane orientation angle $\\theta(s)$ (in radians). Starting from balance of forces and moments under quasistatic equilibrium and the kinematic relation between orientation and tangent, the Cosserat rod equations for planar motion without distributed load can be stated in differential form, together with a linear elastic constitutive law for bending:\n\n- Force balance: $\\dfrac{d\\mathbf{n}}{ds} = \\mathbf{0}$, where $\\mathbf{n}(s)$ is the internal force.\n- Moment balance: $\\dfrac{dM}{ds} + \\mathbf{t}(s) \\times \\mathbf{n}(s) = 0$, where $M(s)$ is the bending moment and $\\mathbf{t}(s)$ is the unit tangent.\n- Constitutive relation: $M(s) = E I \\kappa(s)$, where $E$ is Young’s modulus, $I$ is the second moment of area, and $\\kappa(s)$ is the scalar curvature.\n- Kinematics: $\\dfrac{d\\mathbf{r}}{ds} = \\mathbf{t}(s)$ and $\\dfrac{d\\theta}{ds} = \\kappa(s)$, with $\\mathbf{t}(s) = [\\cos \\theta(s), \\sin \\theta(s)]^\\top$.\n\nIn the special case of pure bending with no shear or axial force ($\\mathbf{n}(s) = \\mathbf{0}$), the bending moment is constant along the rod, and when the curvature is prescribed as constant $\\kappa(s) \\equiv \\kappa$, the orientation angle varies linearly with arc length. This constant-curvature configuration serves as an analytical benchmark for soft robotic segments driven to a uniform bend, typical in assistive device applications.\n\nYour task is to implement a numerical discretization using Finite Difference (FD) for the kinematic equations in the planar constant-curvature case and to assess the numerical convergence rate against the analytical constant-curvature solution derived from these fundamentals. Use boundary conditions $\\mathbf{r}(0) = [0,0]^\\top$ (in meters) and $\\theta(0) = 0$ (in radians). Implement two FD schemes for the centerline integration:\n- A first-order explicit method (rectangle rule) for $\\dfrac{d\\mathbf{r}}{ds}$ using $\\mathbf{t}(s_i)$.\n- A second-order trapezoidal method for $\\dfrac{d\\mathbf{r}}{ds}$ using $\\dfrac{1}{2}(\\mathbf{t}(s_i) + \\mathbf{t}(s_{i+1}))$.\n\nFor both schemes, update the orientation by exact constant-curvature integration at the grid points so that $\\theta_{i+1} = \\theta_i + \\kappa \\Delta s$, where $\\Delta s = L/N$ and $N$ is the number of uniform segments.\n\nDefine the error for a given discretization as the Euclidean norm (in meters) of the difference between the numerically computed tip position $\\mathbf{r}(L)$ and the analytical constant-curvature tip position $\\mathbf{r}_{\\text{analytic}}(L)$ derived from the fundamental equations above. For each test case, estimate the empirical order of convergence $p$ by performing a linear regression of $\\log(e)$ versus $\\log(\\Delta s)$ across the provided $N$ values, where $e$ is the tip-position error, and report the slope $p$ as a dimensionless float.\n\nAngle units must be radians. Length units must be meters. All reported convergence rates $p$ must be dimensionless floats rounded to three decimal places.\n\nTest suite and required output format:\n- Use rod lengths and curvatures:\n  - Case $1$: $L = 0.5$ (meters), $\\kappa = 2.0$ (per meter), with segment counts $N \\in \\{4,8,16,32,64\\}$.\n  - Case $2$: $L = 0.5$ (meters), $\\kappa = 2.0$ (per meter), with segment counts $N \\in \\{1,2,4,8,16\\}$ to probe coarse-grid behavior.\n  - Case $3$: $L = 1.0$ (meters), $\\kappa = 0.001$ (per meter), with segment counts $N \\in \\{4,8,16,32,64\\}$ to probe near-straight configurations.\n  - Case $4$: $L = 0.3$ (meters), $\\kappa = 10.0$ (per meter), with segment counts $N \\in \\{4,8,16,32,64\\}$ to probe high-curvature configurations.\n- For each case, compute two convergence rates: $p_{\\text{FD1}}$ for the first-order explicit method and $p_{\\text{FD2}}$ for the second-order trapezoidal method.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[p_{\\text{FD1}}^{(1)}, p_{\\text{FD2}}^{(1)}, p_{\\text{FD1}}^{(2)}, p_{\\text{FD2}}^{(2)}, p_{\\text{FD1}}^{(3)}, p_{\\text{FD2}}^{(3)}, p_{\\text{FD1}}^{(4)}, p_{\\text{FD2}}^{(4)}]$, where superscripts denote the case index. Each entry must be rounded to three decimal places. The entries are dimensionless floats.",
            "solution": "First, we establish the analytical solution which serves as the ground truth for our error analysis. The kinematics of the rod are governed by the system of ordinary differential equations (ODEs):\n$$\n\\frac{d\\theta}{ds} = \\kappa\n$$\n$$\n\\frac{d\\mathbf{r}}{ds} = \\mathbf{t}(s) = \\begin{bmatrix} \\cos \\theta(s) \\\\ \\sin \\theta(s) \\end{bmatrix}\n$$\nwith initial conditions $\\theta(0) = 0$ and $\\mathbf{r}(0) = [0, 0]^\\top$. For a constant curvature $\\kappa$, the first equation is integrated directly:\n$$\n\\int_0^s \\frac{d\\theta}{d\\sigma} d\\sigma = \\int_0^s \\kappa d\\sigma \\implies \\theta(s) - \\theta(0) = \\kappa s\n$$\nGiven $\\theta(0) = 0$, the orientation angle is $\\theta(s) = \\kappa s$. Substituting this into the equation for the position vector $\\mathbf{r}(s) = [x(s), y(s)]^\\top$ and integrating from $s=0$ to $s=L$ yields the analytical tip position $\\mathbf{r}_{\\text{analytic}}(L)$:\n$$\nx(L) = \\int_0^L \\cos(\\kappa s) ds = \\left[ \\frac{\\sin(\\kappa s)}{\\kappa} \\right]_0^L = \\frac{\\sin(\\kappa L)}{\\kappa}\n$$\n$$\ny(L) = \\int_0^L \\sin(\\kappa s) ds = \\left[ -\\frac{\\cos(\\kappa s)}{\\kappa} \\right]_0^L = -\\frac{\\cos(\\kappa L)}{\\kappa} - \\left(-\\frac{\\cos(0)}{\\kappa}\\right) = \\frac{1 - \\cos(\\kappa L)}{\\kappa}\n$$\nThus, the analytical tip position is:\n$$\n\\mathbf{r}_{\\text{analytic}}(L) = \\begin{bmatrix} \\frac{\\sin(\\kappa L)}{\\kappa} \\\\ \\frac{1 - \\cos(\\kappa L)}{\\kappa} \\end{bmatrix}\n$$\nFor the special case where $\\kappa \\to 0$, this expression correctly limits to $\\mathbf{r}_{\\text{analytic}}(L) = [L, 0]^\\top$.\n\nNext, we discretize the domain $s \\in [0, L]$ into $N$ uniform segments of length $\\Delta s = L/N$. The grid points are $s_i = i \\Delta s$ for $i = 0, 1, \\dots, N$. The state at each grid point is $(\\mathbf{r}_i, \\theta_i)$. The orientation $\\theta_i$ at each grid point can be determined exactly as $\\theta_i = \\theta(s_i) = \\kappa s_i = i \\kappa \\Delta s$.\n\nWe implement two numerical schemes to integrate for the position $\\mathbf{r}(s)$.\n\nThe first scheme (FD1) is a first-order explicit method, equivalent to the forward Euler method. The update rule for the position from step $i$ to $i+1$ is:\n$$\n\\mathbf{r}_{i+1} = \\mathbf{r}_i + \\Delta s \\cdot \\mathbf{t}(s_i) = \\mathbf{r}_i + \\Delta s \\begin{bmatrix} \\cos \\theta_i \\\\ \\sin \\theta_i \\end{bmatrix}\n$$\nThis method uses the tangent at the beginning of the interval to approximate the displacement over the entire interval. The local truncation error is of order $O(\\Delta s^2)$, leading to a global error of order $O(\\Delta s)$. Therefore, the expected order of convergence is $p_{\\text{FD1}} = 1$.\n\nThe second scheme (FD2) is the second-order trapezoidal method. The update rule is:\n$$\n\\mathbf{r}_{i+1} = \\mathbf{r}_i + \\frac{\\Delta s}{2} \\left( \\mathbf{t}(s_i) + \\mathbf{t}(s_{i+1}) \\right) = \\mathbf{r}_i + \\frac{\\Delta s}{2} \\left( \\begin{bmatrix} \\cos \\theta_i \\\\ \\sin \\theta_i \\end{bmatrix} + \\begin{bmatrix} \\cos \\theta_{i+1} \\\\ \\sin \\theta_{i+1} \\end{bmatrix} \\right)\n$$\nThis method averages the tangents at the beginning and end of the interval, providing a more accurate approximation. Since we know the function $\\theta(s)$ exactly, we can compute $\\mathbf{t}(s_{i+1})$ without approximation. The local truncation error for the trapezoidal rule is $O(\\Delta s^3)$, resulting in a global error of order $O(\\Delta s^2)$. The expected order of convergence is $p_{\\text{FD2}} = 2$.\n\nTo estimate the empirical order of convergence $p$, we analyze the relationship between the numerical error $e$ and the step size $\\Delta s$. The error is defined as the Euclidean norm of the difference between the numerical and analytical final positions: $e = || \\mathbf{r}_{\\text{num}}(L) - \\mathbf{r}_{\\text{analytic}}(L) ||_2$. For a method of order $p$, the error behaves as $e \\approx C (\\Delta s)^p$ for some constant $C$, as $\\Delta s \\to 0$. By taking the natural logarithm of both sides, we obtain a linear relationship:\n$$\n\\log(e) \\approx \\log(C) + p \\log(\\Delta s)\n$$\nWe can, therefore, estimate $p$ as the slope of a linear regression line fitted to the data points $(\\log(\\Delta s_j), \\log(e_j))$ generated from the set of segment counts $N_j$.\n\nThe implementation will proceed by defining functions for the analytical solution and for each numerical simulation scheme. For each test case specified, the code will:\n1.  Calculate the single analytical tip position $\\mathbf{r}_{\\text{analytic}}(L)$.\n2.  Loop through the given set of segment counts $N$. For each $N$:\n    a. Compute $\\Delta s = L/N$.\n    b. Run both numerical schemes to get $\\mathbf{r}_{\\text{num,FD1}}(L)$ and $\\mathbf{r}_{\\text{num,FD2}}(L)$.\n    c. Calculate the errors $e_{\\text{FD1}}$ and $e_{\\text{FD2}}$.\n    d. Store the pairs $(\\log(\\Delta s), \\log(e_{\\text{FD1}}))$ and $(\\log(\\Delta s), \\log(e_{\\text{FD2}}))$.\n3.  Perform two separate linear regressions on the collected log-log data to find the slopes $p_{\\text{FD1}}$ and $p_{\\text{FD2}}$.\n4.  The final results are collected, rounded to three decimal places, and formatted as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating the convergence rate for two finite\n    difference schemes applied to a planar constant-curvature rod model.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: L=0.5, k=2.0, N in {4,8,16,32,64}\n        (0.5, 2.0, [4, 8, 16, 32, 64]),\n        # Case 2: L=0.5, k=2.0, N in {1,2,4,8,16}\n        (0.5, 2.0, [1, 2, 4, 8, 16]),\n        # Case 3: L=1.0, k=0.001, N in {4,8,16,32,64}\n        (1.0, 0.001, [4, 8, 16, 32, 64]),\n        # Case 4: L=0.3, k=10.0, N in {4,8,16,32,64}\n        (0.3, 10.0, [4, 8, 16, 32, 64]),\n    ]\n    \n    final_results = []\n\n    def get_analytical_solution(L, kappa):\n        \"\"\"Computes the analytical tip position for a constant curvature rod.\"\"\"\n        if abs(kappa)  1e-9: # Handle near-zero kappa to avoid division by zero\n            return np.array([L, 0.0])\n        \n        kl = kappa * L\n        x = np.sin(kl) / kappa\n        y = (1 - np.cos(kl)) / kappa\n        return np.array([x, y])\n\n    def simulate_fd1(L, kappa, N):\n        \"\"\"Simulates the rod shape using the first-order explicit method (FD1).\"\"\"\n        ds = L / N\n        r = np.array([0.0, 0.0])\n        theta = 0.0\n        for _ in range(N):\n            t = np.array([np.cos(theta), np.sin(theta)])\n            r += ds * t\n            theta += kappa * ds\n        return r\n\n    def simulate_fd2(L, kappa, N):\n        \"\"\"Simulates the rod shape using the second-order trapezoidal method (FD2).\"\"\"\n        ds = L / N\n        r = np.array([0.0, 0.0])\n        theta_i = 0.0\n        for _ in range(N):\n            t_i = np.array([np.cos(theta_i), np.sin(theta_i)])\n            theta_ip1 = theta_i + kappa * ds\n            t_ip1 = np.array([np.cos(theta_ip1), np.sin(theta_ip1)])\n            r += (ds / 2.0) * (t_i + t_ip1)\n            theta_i = theta_ip1 \n        return r\n\n    def compute_convergence_rate(L, kappa, N_values, sim_func):\n        \"\"\"Computes the empirical order of convergence p.\"\"\"\n        r_analytic = get_analytical_solution(L, kappa)\n        \n        log_ds_list = []\n        log_errors_list = []\n        \n        for N in N_values:\n            ds = L / N\n            r_numeric = sim_func(L, kappa, N)\n            error = np.linalg.norm(r_numeric - r_analytic)\n            \n            if error > 1e-15:  # Avoid log(0)\n                log_ds_list.append(np.log(ds))\n                log_errors_list.append(np.log(error))\n        \n        if len(log_ds_list)  2:\n            return np.nan\n\n        # Linear regression: log(error) = p * log(ds) + C\n        slope, _, _, _, _ = linregress(log_ds_list, log_errors_list)\n        return slope\n\n    for L, kappa, N_values in test_cases:\n        p_fd1 = compute_convergence_rate(L, kappa, N_values, simulate_fd1)\n        p_fd2 = compute_convergence_rate(L, kappa, N_values, simulate_fd2)\n        \n        final_results.append(round(p_fd1, 3))\n        final_results.append(round(p_fd2, 3))\n\n    # Format the output as specified\n    output_str = f\"[{','.join(map(str, final_results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}