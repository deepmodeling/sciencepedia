{
    "hands_on_practices": [
        {
            "introduction": "任何关于细胞运动的基于代理的模型 (agent-based model) 的基石是控制代理如何更新其位置的规则。本练习将指导您从第一性原理出发，应用低雷诺数环境下的物理学来推导此规则，在这种环境中，粘性力占主导地位。通过求解这种过阻尼状态下的运动方程，您将建立细胞内部牵引力、环境阻力与其最终速度之间的直接关系，从而为代理的行为提供物理基础。",
            "id": "4152154",
            "problem": "考虑一个在平面基底上迁移的单个贴壁细胞的基于智能体的模型 (ABM)。该细胞由其质心位置$\\mathbf{x}(t)$表示，并在时间间隔$[0,t]$内对基底施加一个恒定的牵引力矢量$\\mathbf{T}$。基底施加一个与细胞速度成正比的线性粘性阻力，阻力系数为$\\gamma$。假设雷诺数足够低，以至于惯性效应可以忽略不计，牵引力方向不随时间变化，并且细胞从原点开始，即$\\mathbf{x}(0)=\\mathbf{0}$。以牛顿第二定律$\\sum \\mathbf{F} = m \\mathbf{a}$和一个经过充分检验的观察结果为基础——即在低雷诺数下，细胞尺度的动力学是过阻尼的，且阻力可以很好地用一个与速度成正比的线性定律来近似——推导出位移$\\mathbf{x}(t)$（用$\\mathbf{T}$、$\\gamma$和$t$表示）。从第一性原理出发，简要解释该位移如何与细胞运动的 ABM 中的迁移速度相关联。用米来表示你的最终位移。不需要四舍五入。",
            "solution": "该问题要求在低雷诺数流体动力学框架下，推导一个在平面基底上的单个贴壁细胞的位移，并将其置于基于智能体的模型 (ABM) 的背景中进行解释。\n\n首先，对问题进行验证。\n\n**步骤1：提取已知条件**\n- 细胞位置：$\\mathbf{x}(t)$\n- 牵引力：恒定矢量 $\\mathbf{T}$\n- 时间间隔：$[0, t]$\n- 阻力模型：线性粘性阻力，与速度成正比\n- 阻力系数：$\\gamma$\n- 控制定律：牛顿第二定律，$\\sum \\mathbf{F} = m \\mathbf{a}$\n- 物理体系：低雷诺数，过阻尼动力学，可忽略的惯性效应 ($m \\mathbf{a} \\approx \\mathbf{0}$) 。\n- 初始条件：$\\mathbf{x}(0) = \\mathbf{0}$\n- 任务1：推导位移 $\\mathbf{x}(t)$（用 $\\mathbf{T}$、$\\gamma$ 和 $t$ 表示）。\n- 任务2：解释该位移与 ABM 中迁移速度的关系。\n- 任务3：用米表示最终位移。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了斯托克斯动力学的标准原理，这是适用于细胞运动的正确物理体系。该设置是一个力学中适定的初值问题。已知条件是自洽且一致的。“惯性效应可以忽略不计”这一条件明确了如何应用牛顿第二定律，即通过将质量-加速度项设为零，这是分析过阻尼系统的标准程序。要求用“米”来表示答案，应解释为要求最终的符号表达式具有长度单位，而不是提供一个数值答案，因为没有给出任何数值数据。该问题是有效的。\n\n**步骤3：结论与行动**\n问题被认为是有效的。将提供完整的解答。\n\n细胞质心的运动遵循牛顿第二定律，该定律指出，作用在物体上的所有力的总和等于其质量乘以其加速度：\n$$\n\\sum \\mathbf{F} = m \\mathbf{a} = m \\frac{d^2\\mathbf{x}}{dt^2}\n$$\n作用在细胞上的力包括细胞施加在基底上的牵引力 $\\mathbf{T}$（根据牛顿第三定律，基底对细胞施加一个大小相等、方向相反的力，这个力驱动运动），以及来自基底的粘性阻力 $\\mathbf{F}_{drag}$。问题指出，阻力是线性的，并与细胞速度 $\\mathbf{v}(t) = \\frac{d\\mathbf{x}}{dt}$ 成正比。这个力与运动方向相反，因此表示为：\n$$\n\\mathbf{F}_{drag} = -\\gamma \\mathbf{v}(t) = -\\gamma \\frac{d\\mathbf{x}}{dt}\n$$\n作用在细胞上的合力是这两个力的总和：\n$$\n\\sum \\mathbf{F} = \\mathbf{T} + \\mathbf{F}_{drag} = \\mathbf{T} - \\gamma \\frac{d\\mathbf{x}}{dt}\n$$\n将此代入牛顿第二定律，得到完整的运动方程：\n$$\n\\mathbf{T} - \\gamma \\frac{d\\mathbf{x}}{dt} = m \\frac{d^2\\mathbf{x}}{dt^2}\n$$\n问题明确指出，系统处于低雷诺数下，此时动力学是“过阻尼”的，并且“惯性效应可以忽略不计”。这是一个关键的物理简化。它意味着惯性项 $m \\mathbf{a} = m \\frac{d^2\\mathbf{x}}{dt^2}$ 与粘性力和牵引力相比小到可以忽略。因此，我们可以通过将惯性项设为零来近似运动方程：\n$$\nm \\frac{d^2\\mathbf{x}}{dt^2} \\approx \\mathbf{0}\n$$\n这将运动方程简化为一个力平衡方程：\n$$\n\\mathbf{T} - \\gamma \\frac{d\\mathbf{x}}{dt} = \\mathbf{0}\n$$\n这个一阶常微分方程描述了在过阻尼状态下的运动。我们可以求解细胞的速度 $\\mathbf{v}(t) = \\frac{d\\mathbf{x}}{dt}$：\n$$\n\\mathbf{v}(t) = \\frac{\\mathbf{T}}{\\gamma}\n$$\n由于牵引力矢量 $\\mathbf{T}$ 和阻力系数 $\\gamma$ 是给定的常数，细胞的速度 $\\mathbf{v}(t)$ 也是恒定的。为了求得位移 $\\mathbf{x}(t)$，我们将速度对时间从初始时刻 $t=0$ 积分到一个一般时刻 $t$：\n$$\n\\int_{\\mathbf{x}(0)}^{\\mathbf{x}(t)} d\\mathbf{x}' = \\int_{0}^{t} \\mathbf{v}(t') dt'\n$$\n代入恒定速度的表达式和初始条件 $\\mathbf{x}(0) = \\mathbf{0}$：\n$$\n\\mathbf{x}(t) - \\mathbf{x}(0) = \\int_{0}^{t} \\frac{\\mathbf{T}}{\\gamma} dt'\n$$\n$$\n\\mathbf{x}(t) - \\mathbf{0} = \\frac{\\mathbf{T}}{\\gamma} \\int_{0}^{t} dt'\n$$\n该积分的计算很简单：\n$$\n\\mathbf{x}(t) = \\frac{\\mathbf{T}}{\\gamma} [t']_{0}^{t} = \\frac{\\mathbf{T}}{\\gamma} (t - 0)\n$$\n因此，细胞的位移随时间变化的函数为：\n$$\n\\mathbf{x}(t) = \\frac{t}{\\gamma}\\mathbf{T}\n$$\n该表达式的单位是 $(\\text{时间}) \\times (\\text{力}) / (\\text{阻力系数})$。在国际单位制（SI）中，即为 $s \\cdot N / (N \\cdot s \\cdot m^{-1}) = m$，这是一个长度单位（米），符合要求。\n\n关于与细胞运动的基于智能体的模型 (ABM) 的关系，此推导提供了更新智能体位置的基本规则。在一个典型的 ABM 中，时间被离散化为大小为 $\\Delta t$ 的步长。智能体在第 $k+1$ 步的位置是基于其在第 $k$ 步的位置和速度来更新的：\n$$\n\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\mathbf{v}_k \\Delta t\n$$\n我们的推导表明，对于恒定的牵引力，细胞以恒定速度 $\\mathbf{v} = \\mathbf{T}/\\gamma$ 移动。这个恒定速度将用于 ABM 的更新规则中。迁移速率是该速度矢量的大小：\n$$\n\\text{speed} = \\|\\mathbf{v}\\| = \\left\\| \\frac{\\mathbf{T}}{\\gamma} \\right\\| = \\frac{\\|\\mathbf{T}\\|}{\\gamma}\n$$\n这个速率决定了细胞智能体在每个模拟时间步 $\\Delta t$ 内移动的距离。推导出的方程 $\\mathbf{x}(t) = \\mathbf{v}t$ 是连续时间的解析解，而离散时间的 ABM 模拟在这些简单条件下会逼近这个解。它为智能体的运动行为构成了生物物理学基础。",
            "answer": "$$\\boxed{\\frac{t}{\\gamma}\\mathbf{T}}$$"
        },
        {
            "introduction": "基于代理的模型的一个关键优势是它们能够揭示个体行为如何产生涌现的、群体水平的现象。本练习探讨了单个细胞分裂决策的可变性（建模为随机的尺寸阈值）如何影响整个细胞群体尺寸的统计分布。通过分析一个处于稳态的群体，您将推导出一个连接微观噪声和宏观可观测量的定量关系，这是系统生物学中的一个基本概念。",
            "id": "4152158",
            "problem": "考虑一个生物力学背景下的增殖细胞群体基于智能体的模型，其中每个单细胞都是一个自主智能体，其大小根据指数增长的确定性定律演化。具体来说，每个细胞的体积$V(t)$从出生开始以$dV/dt = \\alpha V$的方式演化，其中增长率$\\alpha > 0$为常数，直到达到一个内在的尺寸阈值，此时细胞分裂成两个子细胞。假设细胞周期具有以下规则和统计结构：\n- 分裂触发器是一个尺寸阈值$\\Theta$，在每个细胞周期中从对数正态分布中独立抽取，即$ \\ln \\Theta \\sim \\mathcal{N}(\\mu,\\sigma^{2}) $，参数为$\\mu \\in \\mathbb{R}$和$\\sigma^{2} > 0$。\n- 分裂在$V = \\Theta$时是对称且瞬时的，产生两个体积均为$\\Theta/2$的子细胞，没有分配噪声或其他随机性来源。\n- 在这些规则下，细胞群体足够大且处于稳态，因此新生细胞体积的分布在各代之间是不随时间变化的。\n- 没有细胞死亡或静止期，唯一的随机性来源于阈值$\\Theta$。\n\n仅使用这些规则和概率论的基本定义，推导群体中新生细胞体积分布的稳态变异系数的平方（定义为$ \\mathrm{CV}^{2} = \\mathrm{Var}(X)/[\\mathbb{E}(X)]^{2} $），记为$ \\mathrm{CV}_{b}^{2} $，并用对数阈值变异性参数$ \\sigma^{2} $表示。将您的最终答案表示为关于$ \\sigma^{2} $的闭式解析表达式。无需四舍五入，最终表达式中不包含任何物理单位。",
            "solution": "问题要求解新生细胞体积的稳态变异系数的平方，记为 $\\mathrm{CV}_{b}^{2}$。解法将通过分析在指定的稳态条件下，出生时体积和分裂时体积之间的统计关系来推导。\n\n设 $V_b$ 为新生细胞体积的随机变量。设 $\\Theta$ 为细胞分裂时尺寸的随机变量。问题指出 $\\Theta$ 来自对数正态分布，因此其对数 $\\ln \\Theta$ 服从正态分布 $\\mathcal{N}(\\mu, \\sigma^2)$。\n\n根据模型的规则：\n1. 细胞出生时体积为 $V_b$。\n2. 它指数增长，直到其体积 $V$ 达到分裂阈值 $\\Theta$。请注意，具体的增长定律对于确定尺寸关系并非至关重要，重要的是细胞从其出生尺寸增长到分裂尺寸。\n3. 达到体积 $\\Theta$ 后，细胞对称且瞬时地分裂成两个子细胞，每个子细胞的体积为 $\\Theta/2$。\n\n这些子细胞是下一代的新生细胞。我们将下一代新生细胞的体积记为 $V_b'$。根据分裂规则，我们有以下关系：\n$$V_b' = \\frac{\\Theta}{2}$$\n问题指出群体处于稳态，这意味着新生细胞体积的分布是不随时间变化的。因此，$V_b'$ 的统计分布必须与 $V_b$ 的分布相同。这是稳态的一个关键条件。我们将其表示为分布相等：\n$$V_b \\stackrel{d}{=} \\frac{\\Theta}{2}$$\n\n我们的目标是计算新生细胞体积的变异系数的平方，即 $\\mathrm{CV}_{b}^{2}$。根据定义：\n$$\\mathrm{CV}_{b}^{2} = \\frac{\\mathrm{Var}(V_b)}{[\\mathbb{E}(V_b)]^2}$$\n由于 $V_b$ 和 $\\Theta/2$ 具有相同的分布，它们必须具有相同的统计矩，因此具有相同的变异系数。\n$$\\mathrm{CV}_{b}^{2} = \\mathrm{CV}_{\\Theta/2}^{2} = \\frac{\\mathrm{Var}(\\Theta/2)}{[\\mathbb{E}(\\Theta/2)]^2}$$\n\n我们来分析恒定比例因子对变异系数的影响。对于任意随机变量 $X$ 和一个非零常数 $c$， $c X$ 的期望和方差为：\n$$\\mathbb{E}(c X) = c \\mathbb{E}(X)$$\n$$\\mathrm{Var}(c X) = c^2 \\mathrm{Var}(X)$$\n$c X$ 的变异系数的平方则为：\n$$\\mathrm{CV}_{c X}^{2} = \\frac{\\mathrm{Var}(c X)}{[\\mathbb{E}(c X)]^2} = \\frac{c^2 \\mathrm{Var}(X)}{[c \\mathbb{E}(X)]^2} = \\frac{c^2 \\mathrm{Var}(X)}{c^2 [\\mathbb{E}(X)]^2} = \\frac{\\mathrm{Var}(X)}{[\\mathbb{E}(X)]^2} = \\mathrm{CV}_{X}^{2}$$\n这表明变异系数（及其平方）是一个尺度不变的量。将此结果应用于我们的问题，其中 $X = \\Theta$ 且 $c = 1/2$，我们发现：\n$$\\mathrm{CV}_{b}^{2} = \\mathrm{CV}_{\\Theta/2}^{2} = \\mathrm{CV}_{\\Theta}^{2}$$\n因此，问题简化为求分裂阈值 $\\Theta$ 的变异系数的平方。\n\n分裂阈值 $\\Theta$ 是一个服从对数正态分布的随机变量，因为 $\\ln \\Theta \\sim \\mathcal{N}(\\mu, \\sigma^2)$。我们需要求出它的前两阶矩来计算其方差。一个对数正态随机变量 $X$（其中 $\\ln X \\sim \\mathcal{N}(\\mu_x, \\sigma_x^2)$）的 k 阶矩由公式 $\\mathbb{E}(X^k) = \\exp(k\\mu_x + \\frac{1}{2}k^2\\sigma_x^2)$ 给出。\n对于我们的变量 $\\Theta$，其参数为 $\\mu$ 和 $\\sigma^2$，我们有：\n\n均值（一阶矩, $k=1$）：\n$$\\mathbb{E}(\\Theta) = \\exp\\left(1 \\cdot \\mu + \\frac{1}{2} \\cdot 1^2 \\cdot \\sigma^2\\right) = \\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right)$$\n\n二阶矩（$k=2$）：\n$$\\mathbb{E}(\\Theta^2) = \\exp\\left(2 \\cdot \\mu + \\frac{1}{2} \\cdot 2^2 \\cdot \\sigma^2\\right) = \\exp(2\\mu + 2\\sigma^2)$$\n\n$\\Theta$ 的方差定义为 $\\mathrm{Var}(\\Theta) = \\mathbb{E}(\\Theta^2) - [\\mathbb{E}(\\Theta)]^2$。代入矩的表达式：\n$$\\mathrm{Var}(\\Theta) = \\exp(2\\mu + 2\\sigma^2) - \\left[\\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right)\\right]^2$$\n$$\\mathrm{Var}(\\Theta) = \\exp(2\\mu + 2\\sigma^2) - \\exp\\left(2\\mu + \\sigma^2\\right)$$\n我们可以提出一个公因子：\n$$\\mathrm{Var}(\\Theta) = \\exp(2\\mu + \\sigma^2) \\left(\\exp(\\sigma^2) - 1\\right)$$\n\n现在我们可以计算 $\\Theta$ 的变异系数的平方：\n$$\\mathrm{CV}_{\\Theta}^{2} = \\frac{\\mathrm{Var}(\\Theta)}{[\\mathbb{E}(\\Theta)]^2}$$\n代入方差和均值平方的表达式：\n$$[\\mathbb{E}(\\Theta)]^2 = \\left[\\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right)\\right]^2 = \\exp(2\\mu + \\sigma^2)$$\n$$\\mathrm{CV}_{\\Theta}^{2} = \\frac{\\exp(2\\mu + \\sigma^2) \\left(\\exp(\\sigma^2) - 1\\right)}{\\exp(2\\mu + \\sigma^2)}$$\n项 $\\exp(2\\mu + \\sigma^2)$ 被消去，得到：\n$$\\mathrm{CV}_{\\Theta}^{2} = \\exp(\\sigma^2) - 1$$\n如前所述，$\\mathrm{CV}_{b}^{2} = \\mathrm{CV}_{\\Theta}^{2}$。因此，新生细胞体积分布的稳态变异系数的平方为：\n$$\\mathrm{CV}_{b}^{2} = \\exp(\\sigma^2) - 1$$\n这个最终表达式仅依赖于 $\\sigma^2$，即分裂阈值对数的方差，正如问题所要求的。参数 $\\mu$（对数阈值均值）和 $\\alpha$（增长率）不影响这个无量纲的相对变异性度量。",
            "answer": "$$\\boxed{\\exp(\\sigma^{2}) - 1}$$"
        },
        {
            "introduction": "诸如趋化性之类的细胞过程通常涉及代理与连续环境场的相互作用，这需要一种混合建模方法。本练习解决了一个关键的技术挑战：如何将一个量（如分泌的化学物质）从一个离散的点状代理精确地传递到一个连续的网格上，同时避免引入数值伪影或违反质量守恒。掌握这种耦合技术对于构建稳定且真实的细胞-环境反馈回路模拟至关重要。",
            "id": "4152242",
            "problem": "考虑一个平面组织中由运动细胞分泌的扩散趋化剂的连续场。该浓度场由偏微分方程（PDE）建模：$$\\frac{\\partial c(\\mathbf{x},t)}{\\partial t} = D \\nabla^2 c(\\mathbf{x},t) + \\sum_{a=1}^{N_{\\text{agents}}} q_a(t) \\,\\delta\\big(\\mathbf{x}-\\mathbf{x}_a(t)\\big),$$ 其中 $c(\\mathbf{x},t)$ 是浓度，$D$ 是扩散系数，$q_a(t)$ 是智能体 $a$ 的分泌速率，$\\delta(\\cdot)$ 是狄拉克分布（Dirac distribution），$\\mathbf{x}_a(t)$ 是智能体 $a$ 的瞬时位置。您将域 $\\Omega \\subset \\mathbb{R}^2$ 离散化到一个间距为 $h$ 的均匀笛卡尔网格上，其节点为 $\\{(x_i,y_j)\\}$，并以固定的时间步长 $\\Delta t$ 进行时间推进。为了将智能体的分泌耦合到网格上，您用一个到相邻网格节点的光滑沉积来替换奇异源：在每个时间步，每个智能体 $a$ 在节点 $(i,j)$ 上增加一个离散源 $S_{i,j}^{(a)}(t)$，满足 $$\\sum_{i,j} S_{i,j}^{(a)}(t) = q_a(t)\\,\\Delta t,$$ 从而使得每一步分泌的总质量在离散情况下是守恒的。您需要寻找一个沉积规则，该规则能同时满足 (i) 对于任意的 $\\mathbf{x}_a(t)$，在离散格式中保持质量守恒，以及 (ii) 当智能体相对于网格移动时，避免数值奇异性和网格依赖的偏差。\n\n从质量守恒、狄拉克分布作为磨光函数极限的定义，以及有限差分扩散的标准稳定性考虑出发，选择能够提供一种基于核函数的、科学合理的网格沉积方法，该方法在离散意义上保持质量守恒并避免数值奇异性的选项。假设域足够大，任何非紧支集（non-compact support）的截断都是通过在以 $\\mathbf{x}_a(t)$ 为中心的有界模板（stencil）内的节点上进行有限求和来执行的。\n\nA. 使用一个固定的连续高斯核 $$K(\\mathbf{r}) = \\frac{1}{2\\pi \\sigma^2}\\exp\\!\\Big(-\\frac{\\|\\mathbf{r}\\|^2}{2\\sigma^2}\\Big),$$ 其中 $\\sigma$ 与 $h$ 无关，并将 $$S_{i,j}^{(a)}(t) = q_a(t)\\,\\Delta t \\, K\\!\\big((x_i-x_a(t),\\,y_j-y_a(t))\\big)$$ 沉积到所有网格节点上。不要通过对 $(i,j)$ 的离散求和进行重新归一化；依赖于连续归一化 $\\int_{\\mathbb{R}^2} K(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r} = 1$。\n\nB. 在每个维度上使用一个紧支集的张量积帐篷（帽状）核，\n$$\\phi(u) = \\max(1-|u|,0),\\quad W_{i,j}(\\mathbf{x}_a) = \\phi\\!\\Big(\\frac{x_i-x_a}{h}\\Big)\\,\\phi\\!\\Big(\\frac{y_j-y_a}{h}\\Big),$$\n并沉积\n$$S_{i,j}^{(a)}(t) = q_a(t)\\,\\Delta t \\,\\frac{W_{i,j}(\\mathbf{x}_a)}{\\sum_{p,q} W_{p,q}(\\mathbf{x}_a)}.$$\n该核在一维上最多有 $4$ 个节点的支集，在二维上最多有 $16$ 个节点的支集，并且是严格非负的。\n\nC. 将所有质量分配给最近的网格节点（最近网格点方案）：令 $(i^\\ast,j^\\ast)$ 为最小化 $\\|(x_i-x_a,\\,y_j-y_a)\\|$ 的索引，并沉积 $$S_{i,j}^{(a)}(t) = \\begin{cases} q_a(t)\\,\\Delta t  \\text{if } (i,j)=(i^\\ast,j^\\ast),\\\\ 0  \\text{otherwise.}\\end{cases}$$\n\nD. 在每个维度上使用一个宽度为 $4h$ 的紧支集张量积三次B样条核。在一维中，通过分段多项式定义三次B样条 $M_4(u)$\n$$M_4(u)=\\begin{cases}\\frac{1}{6}(4-6u^2+3|u|^3)  \\text{if } 0 \\le |u|  1,\\\\ \\frac{1}{6}(2-|u|)^3  \\text{if } 1 \\le |u|  2,\\\\ 0  \\text{if } |u| \\ge 2,\\end{cases}$$\n并设置\n$$W_{i,j}(\\mathbf{x}_a) = M_4\\!\\Big(\\frac{x_i-x_a}{h}\\Big)\\,M_4\\!\\Big(\\frac{y_j-y_a}{h}\\Big),\\quad S_{i,j}^{(a)}(t) = q_a(t)\\,\\Delta t \\,\\frac{W_{i,j}(\\mathbf{x}_a)}{\\sum_{p,q} W_{p,q}(\\mathbf{x}_a)}.$$\n对于任何 $\\mathbf{x}_a$，经过离散归一化后，权重在 $4\\times 4$ 的模板上是非负的，且总和为 $1$。\n\n选择所有满足上述标准 (i) 和 (ii) 的选项，并且这些选项适用于在基于智能体的细胞过程生物力学模拟中，将点智能体的分泌耦合到网格上。",
            "solution": "### 问题陈述验证\n\n根据指定标准对问题陈述进行评估。\n\n**步骤1：提取已知条件**\n-   控制偏微分方程：$$\\frac{\\partial c(\\mathbf{x},t)}{\\partial t} = D \\nabla^2 c(\\mathbf{x},t) + \\sum_{a=1}^{N_{\\text{agents}}} q_a(t) \\,\\delta\\big(\\mathbf{x}-\\mathbf{x}_a(t)\\big)$$\n-   离散化：间距为 $h$、时间步长为 $\\Delta t$ 的均匀笛卡尔网格。网格节点位置为 $(x_i, y_j)$。\n-   离散源沉积：智能体 $a$ 在每个时间步向节点 $(i,j)$ 贡献 $S_{i,j}^{(a)}(t)$。\n-   离散质量守恒约束：$$\\sum_{i,j} S_{i,j}^{(a)}(t) = q_a(t)\\,\\Delta t$$\n-   沉积规则的所需属性：\n    -   (i) 在离散格式中为任意智能体位置 $\\mathbf{x}_a(t)$ 保持质量守恒。\n    -   (ii) 当智能体相对于网格移动时，避免数值奇异性和网格依赖的偏差。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学基础：** 该问题是计算科学中的一个标准且关键的课题，尤其是在粒子-网格和基于智能体的模拟方法中。控制偏微分方程是一个基本的反应扩散方程，而将点源（智能体）耦合到连续网格上是一个公认的挑战。狄拉克分布、磨光函数、基于核的沉积和数值稳定性都是应用数学和物理学的基石。该问题在科学上是有效的。\n-   **适定性：** 问题提供了清晰、客观的标准——离散质量守恒和避免网格依赖的偏差——用于评估几个具体的建议方法（即选项）。其结构旨在基于已建立的数值分析原则得出一组确定的正确答案。\n-   **客观性：** 问题以精确、形式化的数学语言陈述，没有主观性或歧义。\n\n**步骤3：结论和行动**\n问题陈述具有科学依据、适定且客观。它不包含任何会妨碍进行严谨分析的矛盾或缺失信息。因此，该问题是**有效的**。我将继续进行解答推导。\n\n### 解答推导\n\n任务是确定所提出的沉积方案中，哪些满足将点智能体耦合到离散网格的两个关键标准：\n(i) **离散质量守恒**：在一个时间步内沉积在网格上的总质量 $\\sum_{i,j} S_{i,j}^{(a)}(t)$，必须精确等于智能体分泌的总质量 $M_a = q_a(t)\\,\\Delta t$，而不管智能体的子网格位置如何。\n(ii) **光滑性和偏差避免**：沉积必须是智能体位置的光滑函数，以防止当智能体穿过网格时离散源场发生不连续的跳跃。这种跳跃是显著数值误差和网格依赖偏差的来源。\n\n让我们根据这些标准分析每个选项。\n\n**选项A评估**\n提出的规则是 $S_{i,j}^{(a)}(t) = M_a K(\\mathbf{r}_{ij})$，其中 $K$ 是一个归一化的连续高斯核，$\\mathbf{r}_{ij} = (x_i-x_a(t), y_j-y_a(t))$。\n为检查质量守恒（i），我们将沉积的质量在所有网格节点上求和：\n$$ \\sum_{i,j} S_{i,j}^{(a)}(t) = M_a \\sum_{i,j} K(\\mathbf{r}_{ij}) $$\n要使质量守恒，对于任何智能体位置 $\\mathbf{x}_a(t)$，求和 $\\sum_{i,j} K(\\mathbf{r}_{ij})$ 必须等于 $1$。虽然高斯核的积分是归一化的，$\\int K(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r} = 1$，但在网格点上的离散求和是对该函数的采样。该总和不保证为 $1$。事实上，它的值取决于智能体相对于网格点阵的位置，这种现象称为混叠（aliasing）。当智能体移动时，该总和会波动，因此质量不守恒。该选项明确禁止通过离散求和进行重新归一化，而这是使用此类核函数强制守恒的唯一方法。因此，此选项违反了标准(i)。\n**对A的结论**：**不正确**。\n\n**选项C评估**\n这是最近网格点（NGP）方案。所有质量 $M_a$ 都沉积到离智能体位置 $\\mathbf{x}_a(t)$ 最近的单个网格节点 $(i^\\ast, j^\\ast)$ 上。\n对于质量守恒（i），求和是平凡的：$\\sum_{i,j} S_{i,j}^{(a)}(t) = S_{i^\\ast,j^\\ast}^{(a)}(t) = M_a$。此标准得到满足。\n对于标准（ii），我们考虑智能体移动时会发生什么。当 $\\mathbf{x}_a(t)$ 连续地穿过与两个网格节点等距的边界（即，穿过一个Voronoi单元的边缘）时，最近节点 $(i^\\ast, j^\\ast)$ 的身份会突然改变。全部质量 $M_a$ 会不连续地从一个网格点跳到另一个网格点。这是网格依赖偏差的典型例子，并会在任何使用它的模拟中引入大的、非物理的波动。对于平滑移动的智能体，这是一种时间上奇异性最大的沉积方式。因此，此选项不满足标准(ii)。\n**对C的结论**：**不正确**。\n\n**选项B评估**\n此选项提出了一个张量积线性B样条（或“帐篷”/“帽状”）核。沉积规则是 $S_{i,j}^{(a)}(t) = M_a \\frac{W_{i,j}(\\mathbf{x}_a)}{\\sum_{p,q} W_{p,q}(\\mathbf{x}_a)}$，其中 $W_{i,j}(\\mathbf{x}_a) = \\phi(\\frac{x_i-x_a}{h})\\phi(\\frac{y_j-y_a}{h})$ 且 $\\phi(u) = \\max(1-|u|,0)$。\n对于质量守恒（i），包含离散归一化因子 $\\frac{1}{\\sum_{p,q} W_{p,q}(\\mathbf{x}_a)}$ 明确地强制权重的总和为 $1$。\n$$ \\sum_{i,j} S_{i,j}^{(a)}(t) = M_a \\frac{\\sum_{i,j} W_{i,j}(\\mathbf{x}_a)}{\\sum_{p,q} W_{p,q}(\\mathbf{x}_a)} = M_a $$\n因此，标准（i）通过构造得到满足。B样条核的一个众所周知的性质是它们构成“单位分解”（partition of unity），意味着对于任何 $\\mathbf{x}_a$，都有 $\\sum_{p,q} W_{p,q}(\\mathbf{x}_a)=1$。因此，归一化因子实际上是1，但形式上包含它是正确的。\n对于标准（ii），核函数 $\\phi(u)$ 是连续的（$C^0$）。这意味着沉积的权重 $W_{i,j}$ 是智能体位置 $\\mathbf{x}_a$ 的连续函数。当智能体移动时，质量从一组节点平滑地转移到下一组节点，这相对于NGP方案是一个巨大的改进，避免了不连续的跳跃。这种方法被广泛称为Cloud-in-Cell（CIC），是减少网格依赖偏差的标准技术。\n对选项文本的仔细检查揭示了一个事实错误：“该核在一维上最多有 $4$ 个节点的支集，在二维上最多有 $16$ 个节点的支集”。对于给定的核 $\\phi(u)=\\max(1-|u|,0)$，其在一维的支集最多覆盖 $2$ 个节点，在二维最多覆盖 $2 \\times 2 = 4$ 个节点。这个描述是不正确的。然而，核函数和沉积规则的数学公式被明确无误地陈述，并描述了一种有效的、科学上合理的方法，该方法满足问题的要求。错误似乎在于描述性文本，而非方法本身。基于所定义公式的合理性，该选项是有效的。\n**对B的结论**：**正确**。\n\n**选项D评估**\n此选项提出了一个张量积三次B样条核 $M_4(u)$，其支集宽度为 $4h$ 并且是 $C^2$ 连续的（二阶导数连续），这可以通过在分段边界 $|u|=1$ 和 $|u|=2$ 处检查函数及其导数来验证。沉积规则是 $S_{i,j}^{(a)}(t) = M_a \\frac{W_{i,j}(\\mathbf{x}_a)}{\\sum_{p,q} W_{p,q}(\\mathbf{x}_a)}$，其中 $W_{i,j}$ 由 $M_4$ 构建。\n对于质量守恒（i），与选项B中相同的离散归一化保证了总沉积质量为 $M_a$。此标准得到满足。（同样，三次B样条构成单位分解，因此分母总是 $1$）。\n对于标准（ii），使用 $C^2$ 连续核提供了出色的光滑性。沉积的质量密度及其前两个空间导数（当从网格插值为连续场时）将是智能体位置的连续函数。这种高度的光滑性在最小化网格依赖偏差和在粒子-网格模拟中可能出现的非物理“自作用力”方面非常有效。这是一种更高阶、备受推崇的智能体-网格耦合方法。关于支集（在二维中为 $4 \\times 4 = 16$ 个节点）的描述性文本也是准确的。\n**对D的结论**：**正确**。\n\n### 总结\n选项B和D都描述了将智能体属性耦合到网格的标准、科学上合理的方法。两者都严格地在离散情况下保持质量守恒，并使用光滑核来避免数值奇异性和网格依赖的偏差，因此满足标准(i)和(ii)。选项D以更大的计算模板为代价，提供了更高程度的光滑性（$C^2$ 对比 $C^0$），并且通常被认为是保真度更高的方案。尽管如此，两者都是对所提出问题的有效且适当的解决方案。",
            "answer": "$$\\boxed{BD}$$"
        }
    ]
}