{
    "hands_on_practices": [
        {
            "introduction": "This first exercise grounds the abstract theory of quadratic programming in a simple, tangible biomechanical system . By deriving a closed-form solution for this two-muscle problem, you will gain direct insight into how an optimization criterion distributes load between redundant muscles and how the solution changes when a muscle reaches its maximum activation limit. This practice is invaluable for building a strong intuition for the principles that govern more complex, multi-muscle optimization models.",
            "id": "4196004",
            "problem": "Consider a single-degree-of-freedom joint with two agonist muscles, indexed by $i \\in \\{1,2\\}$. Let $F_{\\max,i} > 0$ denote the maximum isometric force of muscle $i$ and $r_i > 0$ its constant moment arm about the joint. The joint torque produced by muscle activations $a_1$ and $a_2$ (dimensionless, bounded by $0 \\le a_i \\le 1$) is given by the static equilibrium relation from rigid-body mechanics,\n$$\n\\tau = F_{\\max,1} r_1 a_1 + F_{\\max,2} r_2 a_2.\n$$\nYou are tasked with predicting the muscle activations by solving the convex quadratic optimization problem\n$$\n\\min_{a_1,a_2} \\;\\; a_1^2 + a_2^2\n$$\nsubject to the torque-matching equality and the activation bounds $0 \\le a_i \\le 1$. Assume $F_{\\max,i}$ and $r_i$ are known positive constants, define $c_i = F_{\\max,i} r_i$, and assume a feasible torque demand $0 \\le \\tau \\le c_1 + c_2$. Starting from first principles of static torque equilibrium and the Karush–Kuhn–Tucker (KKT) optimality conditions, derive a closed-form symbolic expression for the optimal activations $a_1^{\\star}$ and $a_2^{\\star}$ as functions of $\\tau$, $c_1$, and $c_2$, and characterize the parameter regions in which a bound $a_i=1$ becomes active.\n\nProvide your final answer as a single analytic expression for the optimal activation vector $\\big(a_1^{\\star},a_2^{\\star}\\big)$, using only $F_{\\max,i}$, $r_i$, and $\\tau$ as parameters. If you use any intermediate variables (e.g., $c_i$), define them explicitly within your derivation. Activation is dimensionless; no units are required. The final answer must be exact and must not be rounded.",
            "solution": "The problem as stated is a standard convex quadratic optimization problem, commonly encountered in biomechanics for resolving muscle redundancy. It is scientifically grounded, well-posed, objective, and self-contained. The objective function is strictly convex, and the constraints define a non-empty, closed, convex feasible set. Therefore, a unique optimal solution is guaranteed to exist. The problem is valid and a solution can be derived using the requested first-principles approach.\n\nThe task is to solve the following optimization problem:\n$$\n\\min_{a_1, a_2} \\;\\; f(a_1, a_2) = a_1^2 + a_2^2\n$$\nsubject to:\n$$\nh_1(a_1, a_2) = c_1 a_1 + c_2 a_2 - \\tau = 0\n$$\n$$\ng_1(a_1, a_2) = -a_1 \\le 0\n$$\n$$\ng_2(a_1, a_2) = -a_2 \\le 0\n$$\n$$\ng_3(a_1, a_2) = a_1 - 1 \\le 0\n$$\n$$\ng_4(a_1, a_2) = a_2 - 1 \\le 0\n$$\nwhere we have defined $c_i = F_{\\max,i} r_i > 0$ for $i \\in \\{1, 2\\}$. The problem specifies that a feasible solution exists, i.e., $0 \\le \\tau \\le c_1 + c_2$.\n\nSince this is a convex optimization problem with affine constraints, the Karush–Kuhn–Tucker (KKT) conditions are both necessary and sufficient for optimality. We form the Lagrangian function $\\mathcal{L}$ with a Lagrange multiplier $\\lambda$ for the equality constraint and non-negative multipliers $\\mu_1, \\mu_2, \\nu_1, \\nu_2$ for the four inequality constraints, respectively.\n$$\n\\mathcal{L}(a_1, a_2, \\lambda, \\mu_1, \\mu_2, \\nu_1, \\nu_2) = a_1^2 + a_2^2 + \\lambda(c_1 a_1 + c_2 a_2 - \\tau) - \\mu_1 a_1 - \\mu_2 a_2 + \\nu_1(a_1-1) + \\nu_2(a_2-1)\n$$\nThe KKT conditions for an optimal point $(a_1^{\\star}, a_2^{\\star})$ are:\n\n1.  **Stationarity:** The gradient of the Lagrangian with respect to the optimization variables must vanish.\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial a_1} = 2a_1^{\\star} + \\lambda c_1 - \\mu_1 + \\nu_1 = 0\n    $$\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial a_2} = 2a_2^{\\star} + \\lambda c_2 - \\mu_2 + \\nu_2 = 0\n    $$\n\n2.  **Primal Feasibility:** The optimal point must satisfy all constraints.\n    $$\n    c_1 a_1^{\\star} + c_2 a_2^{\\star} = \\tau\n    $$\n    $$\n    0 \\le a_1^{\\star} \\le 1, \\quad 0 \\le a_2^{\\star} \\le 1\n    $$\n\n3.  **Dual Feasibility:** The multipliers for the inequality constraints must be non-negative.\n    $$\n    \\mu_1, \\mu_2, \\nu_1, \\nu_2 \\ge 0\n    $$\n\n4.  **Complementary Slackness:** The product of an inequality multiplier and its corresponding constraint function must be zero.\n    $$\n    \\mu_1 a_1^{\\star} = 0\n    $$\n    $$\n    \\mu_2 a_2^{\\star} = 0\n    $$\n    $$\n    \\nu_1 (a_1^{\\star} - 1) = 0\n    $$\n    $$\n    \\nu_2 (a_2^{\\star} - 1) = 0\n    $$\n\nWe analyze the solution by considering cases based on which constraints are active. Since $\\tau \\ge 0$ and $c_i > 0$, and the objective function $a_1^2+a_2^2$ is minimized, the activations $a_i^{\\star}$ will be non-negative. If $\\tau=0$, the unique solution is $a_1^{\\star}=a_2^{\\star}=0$. For $\\tau>0$, at least one activation must be positive. This means that for $\\tau>0$, the lower bounds $a_i \\ge 0$ will not be active unless the muscle is not needed, which is not the case here as both muscles are agonists. Therefore, we can assume $\\mu_1=\\mu_2=0$ for $\\tau>0$.\n\n**Case 1: No upper bounds are active ($0 \\le a_1^{\\star} < 1$ and $0 \\le a_2^{\\star} < 1$).**\nFrom complementary slackness, since $a_1^{\\star} < 1$ and $a_2^{\\star} < 1$, we must have $\\nu_1 = \\nu_2 = 0$. The stationarity conditions simplify to:\n$$\n2a_1^{\\star} + \\lambda c_1 = 0 \\implies a_1^{\\star} = -\\frac{\\lambda c_1}{2}\n$$\n$$\n2a_2^{\\star} + \\lambda c_2 = 0 \\implies a_2^{\\star} = -\\frac{\\lambda c_2}{2}\n$$\nSubstituting these into the torque equilibrium equation:\n$$\nc_1 \\left(-\\frac{\\lambda c_1}{2}\\right) + c_2 \\left(-\\frac{\\lambda c_2}{2}\\right) = \\tau \\implies -\\frac{\\lambda}{2}(c_1^2 + c_2^2) = \\tau\n$$\nSolving for $\\lambda$ gives $\\lambda = -\\frac{2\\tau}{c_1^2 + c_2^2}$. Substituting this back into the expressions for the activations:\n$$\na_1^{\\star} = \\frac{c_1 \\tau}{c_1^2+c_2^2}\n$$\n$$\na_2^{\\star} = \\frac{c_2 \\tau}{c_1^2+c_2^2}\n$$\nThis solution is valid as long as the initial assumptions hold: $a_1^{\\star} < 1$ and $a_2^{\\star} < 1$.\n$a_1^{\\star} < 1 \\iff \\frac{c_1 \\tau}{c_1^2+c_2^2} < 1 \\iff \\tau < \\frac{c_1^2+c_2^2}{c_1}$.\n$a_2^{\\star} < 1 \\iff \\frac{c_2 \\tau}{c_1^2+c_2^2} < 1 \\iff \\tau < \\frac{c_1^2+c_2^2}{c_2}$.\nThus, this internal solution is valid for $0 \\le \\tau < \\min\\left(\\frac{c_1^2+c_2^2}{c_1}, \\frac{c_1^2+c_2^2}{c_2}\\right) = \\frac{c_1^2+c_2^2}{\\max(c_1, c_2)}$. Let's call this threshold $\\tau_{sat}$.\n\n**Case 2: Muscle 1 is saturated, Muscle 2 is not ($a_1^{\\star}=1, 0 \\le a_2^{\\star} < 1$).**\nThis case occurs when $\\tau$ exceeds the threshold where $a_1$ hits its bound first, which happens if $c_1 \\ge c_2$. From complementary slackness, we have $\\nu_2=0$ but $\\nu_1 \\ge 0$. With $a_1^{\\star}=1$, the torque constraint directly gives $a_2^{\\star}$:\n$$\nc_1(1) + c_2 a_2^{\\star} = \\tau \\implies a_2^{\\star} = \\frac{\\tau - c_1}{c_2}\n$$\nThis solution is valid if $0 \\le a_2^{\\star} \\le 1$.\n$a_2^{\\star} \\ge 0 \\implies \\tau - c_1 \\ge 0 \\implies \\tau \\ge c_1$.\n$a_2^{\\star} \\le 1 \\implies \\tau - c_1 \\le c_2 \\implies \\tau \\le c_1 + c_2$.\nThe transition from Case 1 to Case 2 occurs when the internal solution for $a_1^{\\star}$ reaches $1$, i.e., at $\\tau=\\frac{c_1^2+c_2^2}{c_1}$. Note that $\\frac{c_1^2+c_2^2}{c_1} = c_1 + \\frac{c_2^2}{c_1} \\ge c_1$. Thus, the region for this case is $\\frac{c_1^2+c_2^2}{c_1} \\le \\tau \\le c_1+c_2$. This region is only non-empty if $\\frac{c_1^2+c_2^2}{c_1} \\le c_1+c_2$, which simplifies to $c_1^2+c_2^2 \\le c_1^2+c_1c_2 \\iff c_2^2 \\le c_1c_2 \\iff c_2 \\le c_1$. This confirms our expectation that muscle $1$ (with the stronger moment-generating capacity) saturates first. If $c_1=c_2$, the interval collapses to a single point.\n\n**Case 3: Muscle 2 is saturated, Muscle 1 is not ($a_2^{\\star}=1, 0 \\le a_1^{\\star} < 1$).**\nBy symmetry with Case 2, this occurs if $c_2 > c_1$. The activations are:\n$$\na_2^{\\star} = 1\n$$\n$$\na_1^{\\star} = \\frac{\\tau - c_2}{c_1}\n$$\nThis is valid for the region $\\frac{c_1^2+c_2^2}{c_2} \\le \\tau \\le c_1+c_2$. This region is non-empty if $c_1 < c_2$.\n\n**Case 4: Both muscles are saturated ($a_1^{\\star}=1, a_2^{\\star}=1$).**\nThis occurs at the maximum possible torque value. The torque constraint becomes:\n$$\nc_1(1) + c_2(1) = \\tau \\implies \\tau = c_1+c_2\n$$\nThis is the upper limit of the feasible torque range and the endpoint for Case 2 and Case 3.\n\n**Summary of Optimal Activations and Saturation Regions**\nCombining these cases, the optimal activations $(a_1^{\\star}, a_2^{\\star})$ have a piecewise definition based on the torque demand $\\tau$. Let $c_1 = F_{\\max,1}r_1$ and $c_2 = F_{\\max,2}r_2$.\n\n1.  **Unsaturated Region**: For $0 \\le \\tau < \\frac{c_1^2+c_2^2}{\\max(c_1, c_2)}$, both muscle activations are below $1$. The optimal activations are distributed in proportion to their torque-generating capacity:\n    $$\n    a_1^{\\star} = \\frac{c_1 \\tau}{c_1^2+c_2^2}, \\quad a_2^{\\star} = \\frac{c_2 \\tau}{c_1^2+c_2^2}\n    $$\n\n2.  **Saturated Region**: When $\\tau$ is large enough, the muscle with the greater torque capacity, $\\max(c_1, c_2)$, saturates first.\n    *   If $c_1 \\ge c_2$, muscle $1$ saturates for $\\tau \\ge \\frac{c_1^2+c_2^2}{c_1}$. The activations are:\n        $$\n        a_1^{\\star} = 1, \\quad a_2^{\\star} = \\frac{\\tau-c_1}{c_2}\n        $$\n    *   If $c_2 > c_1$, muscle $2$ saturates for $\\tau \\ge \\frac{c_1^2+c_2^2}{c_2}$. The activations are:\n        $$\n        a_1^{\\star} = \\frac{\\tau-c_2}{c_1}, \\quad a_2^{\\star} = 1\n        $$\n    These relationships hold up to the maximum torque $\\tau = c_1+c_2$, at which point both activations become $1$.\n\nThis completes the characterization of the solution. The final answer is presented below as a single piecewise analytic expression for the activation vector $(a_1^{\\star}, a_2^{\\star})$ in terms of the original problem parameters.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} a_1^{\\star} & a_2^{\\star} \\end{pmatrix} =\n\\begin{cases}\n\\begin{pmatrix} \\frac{(F_{\\max,1}r_1)\\tau}{(F_{\\max,1}r_1)^2 + (F_{\\max,2}r_2)^2} & \\frac{(F_{\\max,2}r_2)\\tau}{(F_{\\max,1}r_1)^2 + (F_{\\max,2}r_2)^2} \\end{pmatrix} & \\text{if } 0 \\le \\tau < \\frac{(F_{\\max,1}r_1)^2 + (F_{\\max,2}r_2)^2}{\\max(F_{\\max,1}r_1, F_{\\max,2}r_2)} \\\\\n\\\\\n\\begin{pmatrix} 1 & \\frac{\\tau - F_{\\max,1}r_1}{F_{\\max,2}r_2} \\end{pmatrix} & \\text{if } F_{\\max,1}r_1 \\ge F_{\\max,2}r_2 \\text{ and } \\frac{(F_{\\max,1}r_1)^2 + (F_{\\max,2}r_2)^2}{F_{\\max,1}r_1} \\le \\tau \\le F_{\\max,1}r_1 + F_{\\max,2}r_2 \\\\\n\\\\\n\\begin{pmatrix} \\frac{\\tau - F_{\\max,2}r_2}{F_{\\max,1}r_1} & 1 \\end{pmatrix} & \\text{if } F_{\\max,1}r_1 < F_{\\max,2}r_2 \\text{ and } \\frac{(F_{\\max,1}r_1)^2 + (F_{\\max,2}r_2)^2}{F_{\\max,2}r_2} \\le \\tau \\le F_{\\max,1}r_1 + F_{\\max,2}r_2\n\\end{cases}\n}\n$$"
        },
        {
            "introduction": "Building on the specific two-muscle case, this practice generalizes the approach using the powerful Karush-Kuhn-Tucker (KKT) conditions, the cornerstone of constrained optimization theory . You will not only derive the formal conditions for a general static optimization problem but also delve into the economic interpretation of Lagrange multipliers as 'shadow prices'. This perspective reveals the marginal cost of enforcing torque demands and activation limits, providing a deeper understanding of the trade-offs inherent in the system.",
            "id": "4196012",
            "problem": "Consider a static optimization formulation for predicting muscle activations in an isometric task at a single joint. Let the vector of muscle activations be $\\mathbf{a} \\in \\mathbb{R}^{n}$ with components $a_{i}$ representing the fraction of maximal activation of muscle $i$, bounded by $0 \\leq a_{i} \\leq 1$. Let the joint torque equilibrium be represented by $\\boldsymbol{\\tau} = M \\mathbf{a}$, where $\\boldsymbol{\\tau} \\in \\mathbb{R}^{m}$ is the prescribed joint torque vector and $M \\in \\mathbb{R}^{m \\times n}$ maps activations to net joint torques, capturing moment arms and normalized muscle capacity under isometric conditions. Let the effort cost be $J(\\mathbf{a}) = \\frac{1}{2} \\mathbf{a}^{\\top} Q \\mathbf{a}$ with $Q \\in \\mathbb{R}^{n \\times n}$ symmetric positive definite, representing a convex quadratic penalty on activation.\n\nStarting from the fundamental static torque balance $\\boldsymbol{\\tau} = M \\mathbf{a}$ and the bounds $0 \\leq a_{i} \\leq 1$, and using the standard inequality constraint representation $-a_{i} \\leq 0$ and $a_{i} - 1 \\leq 0$, do the following:\n\n1. Construct the Lagrangian for the constrained optimization problem of minimizing $J(\\mathbf{a})$ subject to the torque equilibrium and activation bounds, and derive the full set of Karush–Kuhn–Tucker (KKT) conditions (stationarity, primal feasibility, dual feasibility, and complementary slackness). As part of your derivation, clearly identify the Lagrange multipliers associated with the equality constraints and the inequality bounds.\n2. Provide a principled interpretation of the Lagrange multipliers as shadow prices: describe how the multipliers associated with the torque equilibrium reflect the sensitivity of the optimal cost to changes in prescribed torque, and how the multipliers associated with the activation bounds reflect the marginal cost of tightening or relaxing those bounds.\n3. Evaluate the multipliers for a specific two-muscle, single-degree-of-freedom case with $n = 2$ and $m = 1$. Use\n   $$\n   Q = \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad M = \\begin{pmatrix} 0.5 & 1.0 \\end{pmatrix}, \\quad \\boldsymbol{\\tau} = \\begin{pmatrix} 0.6 \\end{pmatrix}.\n   $$\n   Compute the Lagrange multiplier associated with the torque equilibrium (the scalar multiplier for the single equality constraint) at the optimum. Assume the optimal solution lies strictly within the activation bounds if consistent with the KKT conditions you derive. Round your final numerical answer to four significant figures and express the value in units of reciprocal torque, specifically in $\\text{(N·m)}^{-1}$.",
            "solution": "The problem asks for the formulation and solution of a static optimization problem to predict muscle activations. This is a classic biomechanics problem, typically formulated as a convex Quadratic Program (QP). We will first construct the general Karush–Kuhn–Tucker (KKT) conditions, then interpret the resulting Lagrange multipliers, and finally solve for the specific numerical case provided.\n\nThe optimization problem is defined as:\nMinimize the effort cost $J(\\mathbf{a}) = \\frac{1}{2} \\mathbf{a}^{\\top} Q \\mathbf{a}$\nwith respect to the activation vector $\\mathbf{a} \\in \\mathbb{R}^{n}$.\nThe minimization is subject to three types of constraints:\n1.  Torque equilibrium (equality constraint): $\\boldsymbol{\\tau} - M \\mathbf{a} = \\mathbf{0}$\n2.  Lower activation bounds (inequality constraints): $-a_{i} \\leq 0$ for $i = 1, \\dots, n$\n3.  Upper activation bounds (inequality constraints): $a_{i} - 1 \\leq 0$ for $i = 1, \\dots, n$\n\nHere, $\\mathbf{a}$ is the vector of muscle activations, $Q$ is a symmetric positive definite matrix defining the quadratic cost, $\\boldsymbol{\\tau}$ is the vector of prescribed joint torques, and $M$ is the matrix mapping activations to torques. Since $Q$ is positive definite, the objective function $J(\\mathbf{a})$ is strictly convex. The constraints are linear, defining a convex feasible set. Therefore, this QP has a unique global minimum.\n\n### 1. Lagrangian and KKT Conditions\n\nTo solve this constrained optimization problem, we form the Lagrangian function, $\\mathcal{L}$, by augmenting the objective function with the constraints, weighted by their respective Lagrange multipliers. Let $\\boldsymbol{\\lambda} \\in \\mathbb{R}^{m}$ be the vector of multipliers for the equality constraints, $\\boldsymbol{\\mu} \\in \\mathbb{R}^{n}$ for the lower-bound inequality constraints, and $\\boldsymbol{\\nu} \\in \\mathbb{R}^{n}$ for the upper-bound inequality constraints.\n\nThe Lagrangian is:\n$$\n\\mathcal{L}(\\mathbf{a}, \\boldsymbol{\\lambda}, \\boldsymbol{\\mu}, \\boldsymbol{\\nu}) = J(\\mathbf{a}) + \\boldsymbol{\\lambda}^{\\top}(\\boldsymbol{\\tau} - M \\mathbf{a}) + \\boldsymbol{\\mu}^{\\top}(-\\mathbf{a}) + \\boldsymbol{\\nu}^{\\top}(\\mathbf{a} - \\mathbf{1})\n$$\nSubstituting the expression for $J(\\mathbf{a})$ and distributing the terms, we get:\n$$\n\\mathcal{L}(\\mathbf{a}, \\boldsymbol{\\lambda}, \\boldsymbol{\\mu}, \\boldsymbol{\\nu}) = \\frac{1}{2} \\mathbf{a}^{\\top} Q \\mathbf{a} - \\boldsymbol{\\lambda}^{\\top}M \\mathbf{a} - \\boldsymbol{\\mu}^{\\top}\\mathbf{a} + \\boldsymbol{\\nu}^{\\top}\\mathbf{a} + \\boldsymbol{\\lambda}^{\\top}\\boldsymbol{\\tau} - \\boldsymbol{\\nu}^{\\top}\\mathbf{1}\n$$\nThe Karush–Kuhn–Tucker (KKT) conditions provide the necessary and sufficient conditions for optimality for this convex problem. They are:\n\n1.  **Stationarity**: The gradient of the Lagrangian with respect to the primal variables $\\mathbf{a}$ must be zero at the optimum $(\\mathbf{a}^*, \\boldsymbol{\\lambda}^*, \\boldsymbol{\\mu}^*, \\boldsymbol{\\nu}^*)$.\n    $$\n    \\nabla_{\\mathbf{a}} \\mathcal{L} = Q \\mathbf{a}^* - M^{\\top}\\boldsymbol{\\lambda}^* - \\boldsymbol{\\mu}^* + \\boldsymbol{\\nu}^* = \\mathbf{0}\n    $$\n2.  **Primal Feasibility**: The solution $\\mathbf{a}^*$ must satisfy all original constraints.\n    $$\n    M \\mathbf{a}^* = \\boldsymbol{\\tau}\n    $$\n    $$\n    0 \\leq a_{i}^* \\leq 1 \\quad \\text{for } i = 1, \\dots, n\n    $$\n3.  **Dual Feasibility**: The Lagrange multipliers for the inequality constraints must be non-negative.\n    $$\n    \\mu_{i}^* \\geq 0 \\quad \\text{for } i = 1, \\dots, n\n    $$\n    $$\n    \\nu_{i}^* \\geq 0 \\quad \\text{for } i = 1, \\dots, n\n    $$\n4.  **Complementary Slackness**: The product of each inequality constraint multiplier and its corresponding slack value must be zero. This means a multiplier can only be non-zero if the corresponding constraint is active (i.e., holds with equality).\n    $$\n    \\mu_{i}^* a_{i}^* = 0 \\quad \\text{for } i = 1, \\dots, n\n    $$\n    $$\n    \\nu_{i}^* (a_{i}^* - 1) = 0 \\quad \\text{for } i = 1, \\dots, n\n    $$\n\n### 2. Interpretation of Lagrange Multipliers as Shadow Prices\n\nLagrange multipliers have a direct economic interpretation as shadow prices, representing the sensitivity of the optimal objective value, $J^* = J(\\mathbf{a}^*)$, to infinitesimal relaxation of the constraints.\n\n*   **Torque Equilibrium Multiplier ($\\boldsymbol{\\lambda}$)**: The multiplier $\\boldsymbol{\\lambda}^*$ quantifies the marginal change in the optimal cost $J^*$ with respect to a change in the prescribed torque $\\boldsymbol{\\tau}$. Specifically, $\\lambda_{j}^* = \\frac{\\partial J^*}{\\partial \\tau_j}$. Thus, $\\lambda_{j}^*$ represents the marginal cost of producing an additional unit of torque at joint $j$. A positive value indicates that increasing the required torque will increase the physiological effort cost.\n\n*   **Activation Bound Multipliers ($\\boldsymbol{\\mu}, \\boldsymbol{\\nu}$)**: The multipliers $\\boldsymbol{\\mu}^*$ and $\\boldsymbol{\\nu}^*$ quantify the marginal cost associated with the activation bounds.\n    *   The multiplier $\\mu_{i}^*$ corresponds to the lower bound $a_i \\ge 0$. If the optimal activation $a_{i}^* > 0$, the constraint is inactive, and complementary slackness dictates that $\\mu_{i}^* = 0$. If $a_{i}^* = 0$, the constraint is active, and $\\mu_{i}^*$ can be positive. It represents the rate at which the optimal cost $J^*$ would decrease if the lower bound were relaxed (e.g., if muscle $i$ were allowed to have negative activation).\n    *   The multiplier $\\nu_{i}^*$ corresponds to the upper bound $a_i \\le 1$. If $a_{i}^* < 1$, the constraint is inactive, and $\\nu_{i}^* = 0$. If $a_{i}^* = 1$ (the muscle is saturated), the constraint is active, and $\\nu_{i}^*$ can be positive. It represents the rate at which the optimal cost $J^*$ would decrease if the upper bound were relaxed (i.e., if the muscle's maximal activation capacity could be increased beyond $1$).\n\n### 3. Numerical Evaluation for a Specific Case\n\nWe are given a system with $n=2$ muscles and $m=1$ degree of freedom. The parameters are:\n$$\nQ = \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad M = \\begin{pmatrix} 0.5 & 1.0 \\end{pmatrix}, \\quad \\boldsymbol{\\tau} = \\tau = 0.6\n$$\nSince $m=1$, the torque $\\boldsymbol{\\tau}$ and its multiplier $\\boldsymbol{\\lambda}$ are scalars, denoted $\\tau$ and $\\lambda$. The problem directs us to assume that the optimal solution lies strictly within the activation bounds, i.e., $0 < a_{i}^* < 1$ for $i=1, 2$.\n\nUnder this assumption, the lower and upper bound constraints are inactive. By the complementary slackness conditions:\n*   $a_i^* > 0 \\implies \\mu_i^* = 0$\n*   $a_i^* < 1 \\implies a_i^* - 1 \\neq 0 \\implies \\nu_i^* = 0$\n\nThus, $\\boldsymbol{\\mu}^* = \\mathbf{0}$ and $\\boldsymbol{\\nu}^* = \\mathbf{0}$. The KKT conditions simplify to a system of linear equations:\n1.  Stationarity: $Q \\mathbf{a}^* - M^{\\top} \\lambda^* = \\mathbf{0}$\n2.  Primal Feasibility: $M \\mathbf{a}^* = \\tau$\n\nFrom the stationarity equation, we can express $\\mathbf{a}^*$ in terms of $\\lambda^*$:\n$$\n\\mathbf{a}^* = Q^{-1} M^{\\top} \\lambda^*\n$$\nSubstituting this into the primal feasibility equation gives:\n$$\nM (Q^{-1} M^{\\top} \\lambda^*) = \\tau \\implies (M Q^{-1} M^{\\top}) \\lambda^* = \\tau\n$$\nSolving for $\\lambda^*$, we get:\n$$\n\\lambda^* = (M Q^{-1} M^{\\top})^{-1} \\tau\n$$\nWe now compute the terms in this expression. The inverse of $Q$ is:\n$$\nQ^{-1} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}^{-1} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0.5 & 0 \\\\ 0 & 1.0 \\end{pmatrix}\n$$\nThe transpose of $M$ is:\n$$\nM^{\\top} = \\begin{pmatrix} 0.5 \\\\ 1.0 \\end{pmatrix}\n$$\nNow we compute the scalar term $M Q^{-1} M^{\\top}$:\n$$\nM Q^{-1} M^{\\top} = \\begin{pmatrix} 0.5 & 1.0 \\end{pmatrix} \\begin{pmatrix} 0.5 & 0 \\\\ 0 & 1.0 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 1.0 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 0.5 \\times 0.5 + 1.0 \\times 0 & 0.5 \\times 0 + 1.0 \\times 1.0 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 1.0 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 0.25 & 1.0 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 1.0 \\end{pmatrix} = (0.25 \\times 0.5) + (1.0 \\times 1.0) = 0.125 + 1.0 = 1.125\n$$\nNow we can compute $\\lambda^*$:\n$$\n\\lambda^* = (1.125)^{-1} \\times 0.6 = \\frac{0.6}{1.125} = \\frac{8}{15}\n$$\nAs a decimal, $\\lambda^* \\approx 0.53333...$. Rounding to four significant figures, we get $\\lambda^*=0.5333$. As per the interpretation, the units of $\\lambda^*$ are the units of cost (dimensionless) divided by the units of torque (e.g., $\\text{N·m}$), resulting in $(\\text{N·m})^{-1}$.\n\nTo complete the solution, we must verify that our initial assumption ($0 < a_{i}^* < 1$) is consistent. We calculate the optimal activation vector $\\mathbf{a}^*$:\n$$\n\\mathbf{a}^* = Q^{-1} M^{\\top} \\lambda^* = \\begin{pmatrix} 0.5 & 0 \\\\ 0 & 1.0 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 1.0 \\end{pmatrix} \\left(\\frac{8}{15}\\right) = \\begin{pmatrix} 0.25 \\\\ 1.0 \\end{pmatrix} \\frac{8}{15} = \\begin{pmatrix} 2/15 \\\\ 8/15 \\end{pmatrix}\n$$\nThe individual activations are:\n$$\na_1^* = \\frac{2}{15} \\approx 0.1333\n$$\n$$\na_2^* = \\frac{8}{15} \\approx 0.5333\n$$\nSince $0 < 2/15 < 1$ and $0 < 8/15 < 1$, our assumption that the solution is in the interior of the activation bounds is validated. Thus, the calculated value for $\\lambda^*$ is correct.",
            "answer": "$$\\boxed{0.5333}$$"
        },
        {
            "introduction": "Physiological control often involves balancing multiple, often competing, objectives. This final practice moves beyond minimizing a single effort metric to tackle a multi-objective optimization problem, exploring the trade-off between minimizing metabolic cost and maintaining joint stability . By implementing a computational model, you will generate a Pareto front of solutions, illustrating how different weighting strategies lead to distinct patterns of muscle co-contraction, a phenomenon critical to both performance and injury prevention.",
            "id": "4195942",
            "problem": "Consider a planar knee joint held quasi-statically in extension, so that rotational acceleration is negligible and the net torque equals the required extension torque by Newton's second law for rotation. The fundament is the rotational equilibrium condition, which in this quasi-static case requires that the sum of muscle torques equals the externally required joint torque. Two muscles act at the knee: a lumped quadriceps group (knee extensor) and a lumped hamstrings group (knee flexor). Let the quadriceps muscle force be $F_q$ and the hamstrings muscle force be $F_h$, with corresponding knee moment arms $r_q$ and $r_h$, where $r_q > 0$ and $r_h < 0$ when extension torque is defined positive. The quasi-static torque balance is\n$$\nr_q F_q + r_h F_h = T_{\\mathrm{req}},\n$$\nwhere $T_{\\mathrm{req}}$ is the required net extension torque at the knee. Muscle forces are modeled as $F_i = a_i F_{i,\\max}$ for $i \\in \\{q,h\\}$, where $a_i \\in [0,1]$ is the muscle activation and $F_{i,\\max} > 0$ is the maximum force capacity.\n\nWe consider Multi-Objective Optimization (MOO) of muscle activations that balances effort and anterior shear mitigation. The first objective $J_1$ represents metabolic effort, modeled as the sum of squared activations,\n$$\nJ_1(a_q,a_h) = w_q a_q^2 + w_h a_h^2,\n$$\nwith positive weights $w_q,w_h$. The second objective $J_2$ represents a surrogate for anterior tibial shear risk, modeled as the squared difference of shear contributions from the two muscles,\n$$\nJ_2(a_q,a_h) = \\left(c_q F_q - c_h F_h\\right)^2 = \\left(c_q F_{q,\\max} a_q - c_h F_{h,\\max} a_h\\right)^2,\n$$\nwhere $c_q>0$ and $c_h>0$ are geometry-dependent coefficients mapping muscle force to anterior shear contribution. The feasible set is defined by the equality torque constraint and the bound constraints $0 \\le a_q \\le 1$, $0 \\le a_h \\le 1$.\n\nA Pareto family of solutions is generated via the weighted-sum method: for a trade-off parameter $\\alpha \\in [0,1]$, minimize\n$$\nJ_\\alpha(a_q,a_h) = \\alpha J_1(a_q,a_h) + (1-\\alpha) J_2(a_q,a_h),\n$$\nsubject to the equality torque constraint and activation bounds. The trade-off parameter $\\alpha$ shifts the solution from prioritizing shear mitigation at $\\alpha = 0$ to prioritizing effort at $\\alpha = 1$.\n\nFrom first principles, reduce the problem to a single decision variable by substituting the torque balance. Define $A = r_q F_{q,\\max} > 0$ and $B = r_h F_{h,\\max} < 0$, and write\n$$\na_q = \\frac{T_{\\mathrm{req}} - B a_h}{A}.\n$$\nThe feasible interval for $a_h$ is the set of values that keep $a_q$ in $[0,1]$ and $a_h$ in $[0,1]$. For the knee extension cases specified below where $T_{\\mathrm{req}} \\ge 0$ and $A \\ge T_{\\mathrm{req}}$, this interval is\n$$\na_h \\in \\left[0, \\min\\left(1, \\frac{A - T_{\\mathrm{req}}}{-B}\\right)\\right],\n$$\nsince $-B>0$ and $A - T_{\\mathrm{req}} \\ge 0$. Within this interval, the one-dimensional objective $J_\\alpha(a_h)$ is quadratic in $a_h$, and the optimal $a_h^\\star$ is either the unique stationary point in the interval (if the curvature is positive) or an endpoint.\n\nDefine the co-contraction index for each solution as a unitless measure,\n$$\n\\mathrm{CCI} = \\begin{cases}\n\\dfrac{2 \\min(F_q,F_h)}{F_q + F_h},  \\text{if } F_q + F_h > 0 \\\\\n0,  \\text{if } F_q + F_h = 0\n\\end{cases}\n$$\nThis index is $0$ when only one muscle is active and approaches $1$ when both muscles contribute nearly equally.\n\nImplement a program that, for each test case listed in the test suite below, computes the optimal activations $(a_q,a_h)$ that minimize $J_\\alpha$ for $\\alpha \\in \\{0.0, 0.5, 1.0\\}$, and then outputs the corresponding $\\mathrm{CCI}$ values in a nested list. No angles are required; there are no angle units to specify. All physical quantities use the International System of Units (SI): torque in newton-meters (N·m), force in newtons (N), and moment arms in meters (m). Activations and the co-contraction index are unitless.\n\nTest suite:\n- Case $1$ (happy path, moderate torque, shear moderation relevant): $T_{\\mathrm{req}} = 40$ N·m, $r_q = 0.04$ m, $r_h = -0.03$ m, $F_{q,\\max} = 2000$ N, $F_{h,\\max} = 1500$ N, $w_q = 1$, $w_h = 1$, $c_q = 0.25$, $c_h = 0.20$.\n- Case $2$ (boundary feasibility, quadriceps near capacity): $T_{\\mathrm{req}} = 80$ N·m, $r_q = 0.04$ m, $r_h = -0.03$ m, $F_{q,\\max} = 2000$ N, $F_{h,\\max} = 1500$ N, $w_q = 1$, $w_h = 1$, $c_q = 0.25$, $c_h = 0.20$.\n- Case $3$ (low torque, stronger shear weighting, encourages co-contraction): $T_{\\mathrm{req}} = 10$ N·m, $r_q = 0.04$ m, $r_h = -0.03$ m, $F_{q,\\max} = 2000$ N, $F_{h,\\max} = 1500$ N, $w_q = 1$, $w_h = 1$, $c_q = 0.60$, $c_h = 0.40$.\n- Case $4$ (zero torque, trivial equilibrium): $T_{\\mathrm{req}} = 0$ N·m, $r_q = 0.04$ m, $r_h = -0.03$ m, $F_{q,\\max} = 2000$ N, $F_{h,\\max} = 1500$ N, $w_q = 1$, $w_h = 1$, $c_q = 0.25$, $c_h = 0.20$.\n\nYour program should produce a single line of output containing the results as a comma-separated nested list of the co-contraction index values for $\\alpha \\in \\{0.0, 0.5, 1.0\\}$ across the four test cases, in the order given above. The format must be exactly:\n$$\n[[\\mathrm{CCI}_{\\alpha=0.0}^{(1)}, \\mathrm{CCI}_{\\alpha=0.5}^{(1)}, \\mathrm{CCI}_{\\alpha=1.0}^{(1)}], [\\mathrm{CCI}_{\\alpha=0.0}^{(2)}, \\mathrm{CCI}_{\\alpha=0.5}^{(2)}, \\mathrm{CCI}_{\\alpha=1.0}^{(2)}], [\\mathrm{CCI}_{\\alpha=0.0}^{(3)}, \\mathrm{CCI}_{\\alpha=0.5}^{(3)}, \\mathrm{CCI}_{\\alpha=1.0}^{(3)}], [\\mathrm{CCI}_{\\alpha=0.0}^{(4)}, \\mathrm{CCI}_{\\alpha=0.5}^{(4)}, \\mathrm{CCI}_{\\alpha=1.0}^{(4)}]]\n$$\nwhere superscripts indicate the test case index and subscripts indicate the $\\alpha$ value. The printed output must be a valid Python list literal with numeric entries (floats).",
            "solution": "The problem is valid. It presents a scientifically grounded, well-posed optimization problem in biomechanics, with all necessary data and constraints provided. The variables, objectives, and constraints are clearly defined, allowing for a formal and unique solution.\n\nThe core of the problem is to find the muscle activations, $a_q$ and $a_h$, that minimize a weighted-sum objective function $J_\\alpha(a_q, a_h)$ for different trade-off parameters $\\alpha$. The optimization is subject to a linear equality constraint representing torque equilibrium and box constraints on the activations.\n\nThe solution proceeds in several steps:\n\n1.  **Dimensionality Reduction**: The problem is initially formulated with two decision variables, $a_q$ and $a_h$. The torque balance equation, $r_q F_q + r_h F_h = T_{\\mathrm{req}}$, provides a linear equality constraint. By defining constants $A = r_q F_{q,\\max}$ and $B = r_h F_{h,\\max}$, this constraint is expressed as $A a_q + B a_h = T_{\\mathrm{req}}$. We can solve this for $a_q$ (since $A \\ne 0$) and substitute it into the objective function, reducing the problem to a single decision variable, $a_h$.\n    $$\n    a_q = \\frac{T_{\\mathrm{req}} - B a_h}{A}\n    $$\n\n2.  **Objective Function Derivation**: The combined objective function is $J_\\alpha(a_q,a_h) = \\alpha J_1 + (1-\\alpha) J_2$, where $J_1 = w_q a_q^2 + w_h a_h^2$ and $J_2 = (c_q F_{q,\\max} a_q - c_h F_{h,\\max} a_h)^2$. Substituting the expression for $a_q$ into $J_\\alpha$ yields a one-dimensional objective function $J_\\alpha(a_h)$.\n    \n    Let's define additional constants for clarity: $C_q = c_q F_{q,\\max}$ and $C_h = c_h F_{h,\\max}$.\n    \n    The objective function becomes:\n    $$\n    J_\\alpha(a_h) = \\alpha \\left[ w_q \\left(\\frac{T_{\\mathrm{req}} - B a_h}{A}\\right)^2 + w_h a_h^2 \\right] + (1-\\alpha) \\left[ C_q \\left(\\frac{T_{\\mathrm{req}} - B a_h}{A}\\right) - C_h a_h \\right]^2\n    $$\n    Expanding this expression reveals that $J_\\alpha(a_h)$ is a quadratic function of $a_h$, which can be written in the standard form $J_\\alpha(a_h) = P a_h^2 + Q a_h + R$. The coefficients $P$ and $Q$ are:\n    $$\n    P = \\alpha \\left[ w_q \\left(\\frac{B}{A}\\right)^2 + w_h \\right] + (1-\\alpha) \\left[ \\frac{C_q B}{A} + C_h \\right]^2\n    $$\n    $$\n    Q = -2 \\left[ \\alpha w_q \\frac{T_{\\mathrm{req}} B}{A^2} + (1-\\alpha) \\frac{C_q T_{\\mathrm{req}}}{A} \\left( \\frac{C_q B}{A} + C_h \\right) \\right]\n    $$\n    The constant term $R$ does not affect the location of the minimum and is not required for the optimization. Since all weights ($w_i$), maximum forces ($F_{i,max}$), and coefficients ($c_i$) are positive, and from the definitions of $A$ and $B$, it can be shown that $P  0$ for $\\alpha \\in [0,1)$ and for $\\alpha=1$. If $\\alpha=0$, $P$ can be zero only under a specific geometric condition which is not met in the test cases. Thus, the objective function is a convex parabola, guaranteeing a unique global minimum.\n\n3.  **Feasibility Analysis**: The variable $a_h$ is bounded by $0 \\le a_h \\le 1$. The substituted variable $a_q$ must also be within its bounds, $0 \\le a_q \\le 1$. This imposes further constraints on $a_h$:\n    $$\n    0 \\le \\frac{T_{\\mathrm{req}} - B a_h}{A} \\le 1\n    $$\n    Given that $A  0$ and $-B  0$, and for the specified cases where $T_{\\mathrm{req}} \\ge 0$ and $A \\ge T_{\\mathrm{req}}$, this simplifies to a feasible interval for $a_h$:\n    $$\n    a_h \\in [a_{h,\\min}, a_{h,\\max}] = \\left[0, \\min\\left(1, \\frac{A - T_{\\mathrm{req}}}{-B}\\right)\\right]\n    $$\n\n4.  **Optimization**: The unconstrained minimum of the quadratic function $J_\\alpha(a_h)$ occurs at its vertex, where the derivative is zero: $2 P a_h + Q = 0$. The stationary point is therefore:\n    $$\n    a_h^{\\mathrm{unc}} = -\\frac{Q}{2P}\n    $$\n    The optimal solution $a_h^\\star$ within the feasible interval is found by clamping this unconstrained minimum to the interval $[a_{h,\\min}, a_{h,\\max}]$.\n    $$\n    a_h^\\star = \\max(a_{h,\\min}, \\min(a_h^{\\mathrm{unc}}, a_{h,\\max}))\n    $$\n    A special case where $P=0$ (linear objective) is handled by choosing the endpoint of the interval that minimizes the function, determined by the sign of $Q$.\n\n5.  **Solution Recovery and Final Calculation**: Once the optimal hamstring activation $a_h^\\star$ is found, the optimal quadriceps activation $a_q^\\star$ is calculated using the torque balance equation.\n    $$\n    a_q^\\star = \\frac{T_{\\mathrm{req}} - B a_h^\\star}{A}\n    $$\n    With the optimal activations $(a_q^\\star, a_h^\\star)$, the muscle forces are calculated as $F_q = a_q^\\star F_{q,\\max}$ and $F_h = a_h^\\star F_{h,\\max}$. Finally, the Co-Contraction Index (CCI) is computed using its definition:\n    $$\n    \\mathrm{CCI} = \\begin{cases}\n    \\dfrac{2 \\min(F_q,F_h)}{F_q + F_h},  \\text{if } F_q + F_h > 0 \\\\\n    0,  \\text{if } F_q + F_h = 0\n    \\end{cases}\n    $$\nThis procedure is applied for each specified test case and for each value of $\\alpha \\in \\{0.0, 0.5, 1.0\\}$ to generate the final results.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the muscle activation optimization problem for a series of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: T_req=40, r_q=0.04, r_h=-0.03, F_q_max=2000, F_h_max=1500, w_q=1, w_h=1, c_q=0.25, c_h=0.20\n        {\n            \"T_req\": 40.0, \"r_q\": 0.04, \"r_h\": -0.03, \"F_q_max\": 2000.0, \"F_h_max\": 1500.0,\n            \"w_q\": 1.0, \"w_h\": 1.0, \"c_q\": 0.25, \"c_h\": 0.20\n        },\n        # Case 2: T_req=80, r_q=0.04, r_h=-0.03, F_q_max=2000, F_h_max=1500, w_q=1, w_h=1, c_q=0.25, c_h=0.20\n        {\n            \"T_req\": 80.0, \"r_q\": 0.04, \"r_h\": -0.03, \"F_q_max\": 2000.0, \"F_h_max\": 1500.0,\n            \"w_q\": 1.0, \"w_h\": 1.0, \"c_q\": 0.25, \"c_h\": 0.20\n        },\n        # Case 3: T_req=10, r_q=0.04, r_h=-0.03, F_q_max=2000, F_h_max=1500, w_q=1, w_h=1, c_q=0.60, c_h=0.40\n        {\n            \"T_req\": 10.0, \"r_q\": 0.04, \"r_h\": -0.03, \"F_q_max\": 2000.0, \"F_h_max\": 1500.0,\n            \"w_q\": 1.0, \"w_h\": 1.0, \"c_q\": 0.60, \"c_h\": 0.40\n        },\n        # Case 4: T_req=0, r_q=0.04, r_h=-0.03, F_q_max=2000, F_h_max=1500, w_q=1, w_h=1, c_q=0.25, c_h=0.20\n        {\n            \"T_req\": 0.0, \"r_q\": 0.04, \"r_h\": -0.03, \"F_q_max\": 2000.0, \"F_h_max\": 1500.0,\n            \"w_q\": 1.0, \"w_h\": 1.0, \"c_q\": 0.25, \"c_h\": 0.20\n        }\n    ]\n\n    alpha_values = [0.0, 0.5, 1.0]\n    all_results = []\n\n    for params in test_cases:\n        case_results = []\n        for alpha in alpha_values:\n            cci = calculate_optimal_cci(params, alpha)\n            case_results.append(cci)\n        all_results.append(case_results)\n\n    # The required output format is a standard Python list representation.\n    # The default str() for a list of lists matches this format, including spaces.\n    print(all_results)\n\ndef calculate_optimal_cci(params, alpha):\n    \"\"\"\n    Calculates the Co-Contraction Index for a given set of parameters and alpha.\n    \"\"\"\n    # Extract parameters\n    T_req = params[\"T_req\"]\n    r_q, r_h = params[\"r_q\"], params[\"r_h\"]\n    F_q_max, F_h_max = params[\"F_q_max\"], params[\"F_h_max\"]\n    w_q, w_h = params[\"w_q\"], params[\"w_h\"]\n    c_q, c_h = params[\"c_q\"], params[\"c_h\"]\n    \n    # Pre-calculate constants\n    A = r_q * F_q_max\n    B = r_h * F_h_max\n    C_q = c_q * F_q_max\n    C_h = c_h * F_h_max\n\n    # Determine feasible interval for a_h\n    # The problem guarantees A  0, -B  0, and A = T_req.\n    a_h_min = 0.0\n    a_h_max = np.min([1.0, (A - T_req) / (-B)])\n\n    # If the feasible interval is a single point, that's the solution.\n    if np.isclose(a_h_min, a_h_max):\n        a_h_opt = a_h_min\n    else:\n        # Coefficients for J1 (effort) part of the quadratic objective\n        # J1_term = p1 * a_h^2 + q1 * a_h + r1\n        p1 = w_q * (B / A)**2 + w_h\n        q1 = -2 * w_q * T_req * B / (A**2)\n\n        # Coefficients for J2 (shear) part of the quadratic objective\n        # J2_term = p2 * a_h^2 + q2 * a_h + r2\n        shear_coeff_in_a_h = C_q * B / A + C_h\n        p2 = shear_coeff_in_a_h**2\n        q2 = -2 * (C_q * T_req / A) * shear_coeff_in_a_h\n\n        # Total quadratic coefficients for J_alpha\n        # J_alpha = P * a_h^2 + Q * a_h + R\n        P = alpha * p1 + (1 - alpha) * p2\n        Q = alpha * q1 + (1 - alpha) * q2\n        \n        # Find the optimal a_h\n        if P  1e-12: # Standard convex quadratic case\n            a_h_unc = -Q / (2 * P)\n            a_h_opt = np.clip(a_h_unc, a_h_min, a_h_max)\n        else: # Linear case (P is close to 0)\n            a_h_opt = a_h_min if Q = 0 else a_h_max\n\n    # Calculate corresponding optimal a_q\n    a_q_opt = (T_req - B * a_h_opt) / A\n\n    # Calculate muscle forces\n    F_q = a_q_opt * F_q_max\n    F_h = a_h_opt * F_h_max\n\n    # Calculate Co-Contraction Index (CCI)\n    if F_q + F_h = 1e-9:\n        cci = 0.0\n    else:\n        cci = 2.0 * np.min([F_q, F_h]) / (F_q + F_h)\n        \n    return cci\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}