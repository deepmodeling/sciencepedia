{
    "hands_on_practices": [
        {
            "introduction": "理解手部功能的基石在于掌握单个肌肉的力量生成特性。本练习将一个基本的肌肉模型——希尔（Hill）的力-速度关系——与关节层面的输出（力矩）联系起来，旨在通过微分方法分析关节力矩对肌肉收缩速度的敏感性 ()。这是一项关键实践，有助于深入理解肌肉动态特性如何影响关节的性能表现。",
            "id": "4177260",
            "problem": "在一个固定的关节姿势下执行一个单自由度的腕屈任务，其中主要起作用的是尺侧腕屈肌 (FCU)。关节力矩由肌-腱力通过一个力臂作用而产生。假设如下：\n\n- 在所考虑的姿势下，FCU 肌肉肌腱单元的肌纤维羽状角恒为 $\\alpha = 12^{\\circ}$。为进行三角函数计算，需将 $\\alpha$ 转换为弧度。\n- 肌腱力等于肌纤维力沿肌腱方向的投影，即 $F_{\\text{tendon}} = F_{\\text{muscle}} \\cos(\\alpha)$。\n- 绕关节的腕屈力矩由力的力矩给出，$\\tau = r F_{\\text{tendon}}$，其中 $r$ 是从肌腱作用线到关节轴线的垂直距离（即解剖学力臂）。\n- FCU 肌肉遵循向心（缩短）收缩的 Hill 力-速度关系：$(F + a)(v + b) = (F_{0} + a) b$，其中 $F$ 是肌纤维力，$v$ 是肌纤维缩短速度（对于缩短，取 $v  0$），$F_{0}$ 是最大等长力，$a$ 和 $b$ 是 Hill 常数。\n\n在所关注的姿势下，取参数值为 $F_{0} = 240\\,\\text{N}$，$a = 60\\,\\text{N}$，$b = 1.0\\,\\text{m}\\,\\text{s}^{-1}$，力臂 $r = 0.018\\,\\text{m}$，缩短速度 $v = 0.40\\,\\text{m}\\,\\text{s}^{-1}$。在此姿势下，将 $r$ 和 $\\alpha$ 视为相对于 $v$ 的常数。\n\n从上述关系式出发，推导腕屈力矩对 FCU 肌纤维缩短速度的灵敏度 $\\frac{d\\tau}{dv}$，并在给定的参数值下对其进行数值计算。以 $\\text{N}\\,\\text{m}\\,\\text{s}\\,\\text{m}^{-1}$ 为单位表示最终的灵敏度，并将您的答案四舍五入至四位有效数字。最终答案必须是单个实数。",
            "solution": "问题要求推导和计算腕屈力矩 $\\tau$ 相对于肌纤维缩短速度 $v$ 的灵敏度。该灵敏度表示为导数 $\\frac{d\\tau}{dv}$。\n\n首先，我们建立力矩 $\\tau$ 和肌纤维力 $F$（在问题中表示为 $F_{\\text{muscle}}$）之间的关系。问题提供了两个关键方程：\n1. 腕屈力矩由 $\\tau = r F_{\\text{tendon}}$ 给出。\n2. 肌腱力与肌纤维力相关，关系式为 $F_{\\text{tendon}} = F \\cos(\\alpha)$，其中 $\\alpha$ 是肌纤维羽状角。\n\n结合这两个方程，得到力矩作为肌纤维力的函数：\n$$\n\\tau = r (F \\cos(\\alpha)) = r \\cos(\\alpha) F\n$$\n问题指出，在所考虑的姿势下，力臂 $r$ 和羽状角 $\\alpha$ 被视为常数。因此，$\\tau$ 与肌纤维力 $F$ 成正比。\n\n接下来，我们使用向心收缩的 Hill 力-速度关系，将肌纤维力 $F$ 与肌纤维缩短速度 $v$ 联系起来：\n$$\n(F + a)(v + b) = (F_{0} + a) b\n$$\n此处，$F_{0}$ 是最大等长力，$a$ 和 $b$ 是 Hill 常数。我们可以重新整理该方程，将 $F$ 表示为 $v$ 的函数：\n$$\nF + a = \\frac{(F_{0} + a) b}{v + b}\n$$\n$$\nF(v) = \\frac{(F_{0} + a) b}{v + b} - a\n$$\n现在，将 $F(v)$ 的这个表达式代入我们的力矩方程，以获得 $\\tau$ 作为 $v$ 的显式函数：\n$$\n\\tau(v) = r \\cos(\\alpha) \\left[ \\frac{(F_{0} + a) b}{v + b} - a \\right]\n$$\n为了求得灵敏度 $\\frac{d\\tau}{dv}$，我们对 $\\tau(v)$ 关于 $v$ 求导。由于 $r, \\alpha, F_{0}, a, b$ 都是常数，我们可以应用标准微分法则。\n$$\n\\frac{d\\tau}{dv} = \\frac{d}{dv} \\left( r \\cos(\\alpha) \\left[ \\frac{(F_{0} + a) b}{v + b} - a \\right] \\right)\n$$\n项 $r \\cos(\\alpha)$ 是一个常数因子。常数项 $-a$ 的导数为 $0$。我们可以使用负指数重写该分数项，以便于求导：\n$$\n\\frac{d\\tau}{dv} = r \\cos(\\alpha) \\frac{d}{dv} \\left[ (F_{0} + a) b (v + b)^{-1} \\right]\n$$\n使用幂法则和链式法则，其中 $\\frac{d}{dv}(v+b) = 1$：\n$$\n\\frac{d\\tau}{dv} = r \\cos(\\alpha) (F_{0} + a) b \\left[ -1 \\cdot (v + b)^{-2} \\cdot 1 \\right]\n$$\n化简该表达式，得到灵敏度的最终符号形式：\n$$\n\\frac{d\\tau}{dv} = - \\frac{r \\cos(\\alpha) (F_{0} + a) b}{(v + b)^2}\n$$\n负号表示对于向心收缩，随着肌肉缩短得更快（$v$ 增大），其能产生的力会减小，因此力矩也会减小。这与 Hill 肌肉模型的已知特性是一致的。\n\n现在，我们使用给定的参数值对该表达式进行数值计算：\n- $r = 0.018\\,\\text{m}$\n- $\\alpha = 12^{\\circ}$\n- $F_{0} = 240\\,\\text{N}$\n- $a = 60\\,\\text{N}$\n- $b = 1.0\\,\\text{m}\\,\\text{s}^{-1}$\n- $v = 0.40\\,\\text{m}\\,\\text{s}^{-1}$\n\n问题说明，为进行三角函数计算，应将 $\\alpha$ 转换为弧度。但是，标准计算器可以直接计算以度为单位的角度的余弦值，我们在此处就直接使用度数。$\\cos(12^{\\circ}) \\approx 0.9781476$。\n\n将这些数值代入导数表达式：\n$$\n\\frac{d\\tau}{dv} = - \\frac{(0.018\\,\\text{m}) \\cos(12^{\\circ}) (240\\,\\text{N} + 60\\,\\text{N}) (1.0\\,\\text{m}\\,\\text{s}^{-1})}{(0.40\\,\\text{m}\\,\\text{s}^{-1} + 1.0\\,\\text{m}\\,\\text{s}^{-1})^2}\n$$\n首先，计算分子和分母中的各项：\n$$\nF_{0} + a = 240\\,\\text{N} + 60\\,\\text{N} = 300\\,\\text{N}\n$$\n$$\nv + b = 0.40\\,\\text{m}\\,\\text{s}^{-1} + 1.0\\,\\text{m}\\,\\text{s}^{-1} = 1.4\\,\\text{m}\\,\\text{s}^{-1}\n$$\n$$\n(v + b)^2 = (1.4\\,\\text{m}\\,\\text{s}^{-1})^2 = 1.96\\,\\text{m}^2\\,\\text{s}^{-2}\n$$\n现在，将这些结果代回灵敏度的表达式中：\n$$\n\\frac{d\\tau}{dv} = - \\frac{(0.018\\,\\text{m}) \\cos(12^{\\circ}) (300\\,\\text{N}) (1.0\\,\\text{m}\\,\\text{s}^{-1})}{1.96\\,\\text{m}^2\\,\\text{s}^{-2}}\n$$\n让我们先计算数值部分：\n$$\n\\frac{d\\tau}{dv} = - \\frac{0.018 \\times \\cos(12^{\\circ}) \\times 300 \\times 1.0}{1.96}\n$$\n$$\n\\frac{d\\tau}{dv} \\approx - \\frac{0.018 \\times 0.9781476 \\times 300}{1.96}\n$$\n$$\n\\frac{d\\tau}{dv} \\approx - \\frac{5.2820}{1.96}\n$$\n$$\n\\frac{d\\tau}{dv} \\approx -2.694897...\n$$\n单位是 $\\frac{\\text{m} \\cdot \\text{N} \\cdot \\text{m} \\cdot \\text{s}^{-1}}{\\text{m}^2 \\cdot \\text{s}^{-2}} = \\text{N} \\cdot \\text{s}$。这与所要求的单位 $\\text{N}\\,\\text{m}\\,\\text{s}\\,\\text{m}^{-1}$ 是一致的，后者也可以简化为 $\\text{N} \\cdot \\text{s}$。\n\n将结果四舍五入到四位有效数字，我们得到：\n$$\n\\frac{d\\tau}{dv} \\approx -2.695\\,\\text{N}\\cdot\\text{s}\n$$",
            "answer": "$$\n\\boxed{-2.695}\n$$"
        },
        {
            "introduction": "在肌肉产生力矩这一概念的基础上，本练习将分析尺度扩展到一个多关节、多肌肉的系统。通过应用静态平衡原理，我们可以计算出手部在抓握和操作等任务中能够产生的外部作用力 ()。这项练习要求你建立并求解一个包含拮抗肌的静态平衡方程组，以确定在给定的肌腱张力下指尖所能施加的力。",
            "id": "4177267",
            "problem": "在矢状面内，单根手指被建模为一个由三个旋转关节组成的串联链，分别代表掌指关节 (MCP)、近端指间关节 (PIP) 和远端指间关节 (DIP)。近节指骨、中节指骨和远节指骨的长度分别为 $l_{1} = 45\\,\\mathrm{mm}$、$l_{2} = 30\\,\\mathrm{mm}$ 和 $l_{3} = 20\\,\\mathrm{mm}$。关节角是相对于其中立位测量的屈曲角 $\\theta_{1}$、$\\theta_{2}$、$\\theta_{3}$，手指静态保持在 $\\theta_{2} = 30^\\circ$ 和 $\\theta_{3} = 60^\\circ$ 的位置（考虑到下面指定的方向，$\\theta_{1}$ 的值对于从指尖力传递力矩而言是任意的）。指尖在远端指腹处施加一个大小未知、在平面内的力 $F_{\\mathrm{tip}}$，其方向沿远节指骨的法线方向（垂直于其长轴）指向背侧。假设关节无摩擦，指尖接触是纯力作用而无外部力矩，且重力可忽略不计。\n\n指深屈肌 (FDP) 产生的肌腱力为 $F_{\\mathrm{FDP}} = 60\\,\\mathrm{N}$，其在矢状面内对各关节的力臂为恒定值，分别为 $r_{\\mathrm{FDP,MCP}} = 10\\,\\mathrm{mm}$、$r_{\\mathrm{FDP,PIP}} = 8\\,\\mathrm{mm}$ 和 $r_{\\mathrm{FDP,DIP}} = 6\\,\\mathrm{mm}$。拮抗的指总伸肌 (EDC) 产生的肌腱力为 $F_{\\mathrm{EDC}} = 20\\,\\mathrm{N}$，其在矢状面内的力臂分别为 $r_{\\mathrm{EDC,MCP}} = 12\\,\\mathrm{mm}$、$r_{\\mathrm{EDC,PIP}} = 6\\,\\mathrm{mm}$ 和 $r_{\\mathrm{EDC,DIP}} = 7.714285714\\,\\mathrm{mm}$。规定屈曲力矩为正，伸展力矩为负。\n\n使用多关节系统的静态平衡基本原理以及指尖力与关节力矩之间的运动学关系（不得假定使用任何快捷公式），建立并求解 MCP、PIP 和 DIP 关节处的力矩平衡方程，以确定与给定几何形状和肌腱力相符的指尖力大小 $F_{\\mathrm{tip}}$。最终答案 $F_{\\mathrm{tip}}$ 以 $\\mathrm{N}$ 为单位表示，并四舍五入到四位有效数字。根据需要统一使用弧度或度；上述指定的角度单位为度。",
            "solution": "静态平衡原理指出，为使手指保持在静态姿势，每个关节上的净力矩必须为零。我们需要在掌指关节 (MCP)、近端指间关节 (PIP) 和远端指间关节 (DIP) 处建立力矩平衡。\n\n任意关节 $J$ 上的净力矩 $\\tau_{\\text{net},J}$ 是由肌肉和外部指尖力产生的力矩之和。屈肌肌腱 (FDP) 产生屈曲力矩（正值），伸肌肌腱 (EDC) 产生伸展力矩（负值）。外力 $F_{\\mathrm{tip}}$ 作用于背侧方向，同样产生伸展力矩（负值）。每个关节 $J$ 的平衡方程为：\n$$\n\\tau_{\\text{net},J} = (F_{\\mathrm{FDP}} \\cdot r_{\\mathrm{FDP},J}) - (F_{\\mathrm{EDC}} \\cdot r_{\\mathrm{EDC},J}) + \\tau_{\\mathrm{tip},J} = 0\n$$\n其中，$\\tau_{\\mathrm{tip},J}$ 是指尖力 $F_{\\mathrm{tip}}$ 绕关节 $J$ 产生的力矩。该力矩为伸展力矩，因此为负值。它可以表示为 $\\tau_{\\mathrm{tip},J} = -F_{\\mathrm{tip}} \\cdot d_{J}$，其中 $d_{J}$ 是垂直力臂的大小。平衡方程变为：\n$$\nF_{\\mathrm{FDP}} \\cdot r_{\\mathrm{FDP},J} - F_{\\mathrm{EDC}} \\cdot r_{\\mathrm{EDC},J} - F_{\\mathrm{tip}} \\cdot d_{J} = 0\n$$\n该方程可以重新整理以求解 $F_{\\mathrm{tip}}$：\n$$\nF_{\\mathrm{tip}} = \\frac{F_{\\mathrm{FDP}} \\cdot r_{\\mathrm{FDP},J} - F_{\\mathrm{EDC}} \\cdot r_{\\mathrm{EDC},J}}{d_{J}}\n$$\n为了继续计算，我们必须首先根据给定的运动学信息计算出力臂 $d_{\\text{MCP}}$、$d_{\\text{PIP}}$ 和 $d_{\\text{DIP}}$。\n- **绕 DIP 关节的力臂 ($d_{\\text{DIP}}$):** 指尖力垂直作用于长度为 $l_3$ 的远节指骨。因此，其绕 DIP 关节的力臂就是远节指骨的长度：\n  $d_{\\text{DIP}} = l_3 = 20\\,\\mathrm{mm}$。\n\n- **绕 PIP 关节的力臂 ($d_{\\text{PIP}}$):** 通过几何分析，该力臂为 $d_{\\text{PIP}} = l_2 \\cos(\\theta_3) + l_3$。\n  $d_{\\text{PIP}} = 30 \\cos(60^\\circ) + 20 = 30(0.5) + 20 = 15 + 20 = 35\\,\\mathrm{mm}$。\n\n- **绕 MCP 关节的力臂 ($d_{\\text{MCP}}$):** 同样，几何分析表明 $d_{\\text{MCP}} = l_1 \\cos(\\theta_2+\\theta_3) + l_2 \\cos(\\theta_3) + l_3$。\n  $d_{\\text{MCP}} = 45 \\cos(30^\\circ+60^\\circ) + 30 \\cos(60^\\circ) + 20 = 45 \\cos(90^\\circ) + 15 + 20 = 35\\,\\mathrm{mm}$。\n\n现在，我们计算每个关节上的净主动肌力矩 $\\tau_{m,J} = F_{\\mathrm{FDP}} \\cdot r_{\\mathrm{FDP},J} - F_{\\mathrm{EDC}} \\cdot r_{\\mathrm{EDC},J}$。所有力的单位是牛顿（N），力臂单位是毫米（mm），因此力矩单位是 $N \\cdot mm$。\n- **在 DIP 关节处：**\n$\\tau_{m,\\text{DIP}} = (60)(6) - (20)(7.714285714) \\approx 360 - 154.286 = 205.714\\, \\mathrm{N \\cdot mm}$。使用精确分数 $\\frac{54}{7}$ 计算：$\\tau_{m,\\text{DIP}} = 360 - \\frac{1080}{7} = \\frac{1440}{7}\\,\\mathrm{N \\cdot mm}$。\n- **在 PIP 关节处：**\n$\\tau_{m,\\text{PIP}} = (60)(8) - (20)(6) = 480 - 120 = 360\\,\\mathrm{N \\cdot mm}$。\n- **在 MCP 关节处：**\n$\\tau_{m,\\text{MCP}} = (60)(10) - (20)(12) = 600 - 240 = 360\\,\\mathrm{N \\cdot mm}$。\n\n最后，我们使用每个关节的平衡方程计算 $F_{\\mathrm{tip}}$。一个正确的解应该在所有关节上都得到相同的值。\n- **根据 DIP 关节：**\n$F_{\\mathrm{tip}} = \\frac{\\tau_{m,\\text{DIP}}}{d_{\\text{DIP}}} = \\frac{1440/7\\,\\mathrm{N \\cdot mm}}{20\\,\\mathrm{mm}} = \\frac{1440}{140}\\,\\mathrm{N} = \\frac{72}{7}\\,\\mathrm{N}$。\n- **根据 PIP 关节：**\n$F_{\\mathrm{tip}} = \\frac{\\tau_{m,\\text{PIP}}}{d_{\\text{PIP}}} = \\frac{360\\,\\mathrm{N \\cdot mm}}{35\\,\\mathrm{mm}} = \\frac{72}{7}\\,\\mathrm{N}$。\n- **根据 MCP 关节：**\n$F_{\\mathrm{tip}} = \\frac{\\tau_{m,\\text{MCP}}}{d_{\\text{MCP}}} = \\frac{360\\,\\mathrm{N \\cdot mm}}{35\\,\\mathrm{mm}} = \\frac{72}{7}\\,\\mathrm{N}$。\n\n所有三个关节都得出了相同的 $F_{\\mathrm{tip}}$ 值，这证实了系统在给定的肌力和这个特定的指尖力作用下处于静态平衡状态。其数值为：\n$F_{\\mathrm{tip}} = \\frac{72}{7} \\approx 10.285714\\,\\mathrm{N}$。\n\n按要求四舍五入到四位有效数字，得到 $F_{\\mathrm{tip}} = 10.29\\,\\mathrm{N}$。",
            "answer": "$$\n\\boxed{10.29}\n$$"
        },
        {
            "introduction": "真实的生物系统通常是“冗余”的，即执行一项任务所涉及的肌肉数量超过了力学上的必需。本练习介绍了一种强大的计算方法来解决这种静力学不确定性问题 ()。通过将问题构建为一个非负最小二乘（Non-Negative Least Squares, NNLS）优化问题，即在约束条件 $\\mathbf{a} \\ge \\mathbf{0}$ 下最小化 $\\| \\mathbf{A}\\mathbf{a} - \\mathbf{b} \\|_2$，我们可以找到一种生理学上合理的肌肉激活模式来实现期望的关节力矩。",
            "id": "4177348",
            "problem": "考虑前臂有支撑、腕部处于中立位的等长姿势。假设腕部的屈伸自由度是唯一需要关注的力矩分量，并定义伸展方向为正。设有 $m$ 条肌肉跨过腕关节。对于肌肉 $i$，设其最大等长力为 $f_{\\max,i}$（单位：牛顿），其屈伸力臂为 $r_i$（单位：米，对伸展有贡献的为正，对屈曲有贡献的为负），其激活度为 $a_i \\ge 0$（无单位）。在等长条件下，肌肉力模型为 $f_i = f_{\\max,i} a_i$。根据力矩的定义，由肌肉产生的腕部伸展力矩为 $\\tau = \\sum_{i=1}^m r_i f_i$。以向量形式定义 $\\mathbf{r} \\in \\mathbb{R}^m$（其元素为 $r_i$），$\\mathbf{f}_{\\max} \\in \\mathbb{R}^m$（其元素为 $f_{\\max,i}$）以及 $\\mathbf{a} \\in \\mathbb{R}^m$（其元素为 $a_i$）。则力矩为 $\\tau = \\mathbf{r}^{\\top} \\operatorname{diag}(\\mathbf{f}_{\\max}) \\mathbf{a}$。给定一个期望的伸展力矩 $\\tau^\\star$（单位：牛顿-米），我们寻求一个非负激活向量 $\\mathbf{a}$，以在最小二乘意义上最佳地实现 $\\tau^\\star$。\n\n从 Newton 运动定律和力矩的定义出发，在所述的等长假设下，将从激活度到力矩的映射视为关于 $\\mathbf{a}$ 的线性映射。建立并求解非负最小二乘（NNLS）问题，该问题旨在最小化产生力矩与期望力矩之间的平方误差，约束条件为所有 $i$ 均满足 $a_i \\ge 0$。具体而言，设 $\\mathbf{A} \\in \\mathbb{R}^{1 \\times m}$ 的元素为 $A_{1,i} = r_i f_{\\max,i}$，且 $\\mathbf{b} = [\\tau^\\star] \\in \\mathbb{R}^{1}$。计算\n$$\n\\underset{\\mathbf{a} \\in \\mathbb{R}^m}{\\text{minimize}} \\;\\; \\|\\mathbf{A}\\mathbf{a} - \\mathbf{b}\\|_2 \\quad \\text{subject to} \\quad \\mathbf{a} \\ge \\mathbf{0}.\n$$\n返回结果激活向量的分量，四舍五入至六位小数。\n\n物理单位：以牛顿-米为单位提供力矩输入 $\\tau^\\star$，以米为单位提供力臂 $r_i$，以牛顿为单位提供最大力 $f_{\\max,i}$，并报告无单位的激活度输出 $a_i$，四舍五入至六位小数。本问题不使用角度。请勿转换单位。\n\n测试套件：\n对于每个测试用例，程序会接收到 $(\\mathbf{r}, \\mathbf{f}_{\\max}, \\tau^\\star)$，并且必须输出计算出的激活向量 $\\mathbf{a}$。\n\n- 测试用例 1（通用多肌肉，混合符号力臂）：\n  - $\\mathbf{r} = [0.018, 0.016, 0.014, -0.017, -0.015, -0.010, 0.001]$ 米\n  - $\\mathbf{f}_{\\max} = [450, 400, 350, 550, 500, 300, 200]$ 牛顿\n  - $\\tau^\\star = 9.0$ 牛顿-米\n\n- 测试用例 2（边界情况：期望力矩为零）：\n  - $\\mathbf{r} = [0.018, 0.016, 0.014, -0.017, -0.015, -0.010, 0.001]$ 米\n  - $\\mathbf{f}_{\\max} = [450, 400, 350, 550, 500, 300, 200]$ 牛顿\n  - $\\tau^\\star = 0.0$ 牛顿-米\n\n- 测试用例 3（高伸展力矩需求，存在负力臂）：\n  - $\\mathbf{r} = [0.018, 0.016, 0.014, -0.017, -0.015, -0.010, 0.001]$ 米\n  - $\\mathbf{f}_{\\max} = [450, 400, 350, 550, 500, 300, 200]$ 牛顿\n  - $\\tau^\\star = 25.0$ 牛顿-米\n\n- 测试用例 4（部分肌肉力臂为零）：\n  - $\\mathbf{r} = [0.020, 0.000, -0.018, 0.005]$ 米\n  - $\\mathbf{f}_{\\max} = [300, 400, 450, 150]$ 牛顿\n  - $\\tau^\\star = 2.0$ 牛顿-米\n\n- 测试用例 5（小力臂与中等力矩）：\n  - $\\mathbf{r} = [0.004, 0.003, -0.002]$ 米\n  - $\\mathbf{f}_{\\max} = [250, 200, 300]$ 牛顿\n  - $\\tau^\\star = 1.0$ 牛顿-米\n\n最终输出格式：您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。列表中的每个元素是对应测试用例的激活向量，该向量本身也表示为一个由方括号括起来的逗号分隔列表，每个激活度值四舍五入至六位小数。例如，输出应类似于“[[a11,a12,...],[a21,a22,...],...]”。",
            "solution": "该问题要求我们确定能够产生期望腕部伸展力矩 $\\tau^\\star$ 的肌肉激活模式 $\\mathbf{a}$。解决方案源于力学的基本原理，并被构建为一个非负最小二乘（NNLS）优化问题。\n\n#### 理论构建\n\n1.  **基本原理**：根据 Newton 的旋转运动定律，一个由 $m$ 条肌肉组成的系统围绕单一关节轴产生的总力矩，是每条肌肉产生的力矩的代数和。肌肉 $i$ 产生的力矩 $\\tau_i$ 是其力 $f_i$ 与其相对于关节旋转中心的力臂 $r_i$ 的乘积。\n    $$\n    \\tau = \\sum_{i=1}^{m} \\tau_i = \\sum_{i=1}^{m} r_i f_i\n    $$\n    $r_i$ 的符号，对于促进伸展的肌肉为正，对于促进屈曲的肌肉为负。\n\n2.  **生物力学模型**：问题陈述了肌肉激活度 $a_i$ 与其产生的等长力 $f_i$ 之间的线性关系：\n    $$\n    f_i = f_{\\max,i} a_i\n    $$\n    其中 $f_{\\max,i}$ 是肌肉 $i$ 的最大等长力容量。激活度 $a_i$ 是一个非负的无单位量，$a_i \\ge 0$。\n\n3.  **系统方程**：将肌肉力模型代入力矩求和方程，得到总力矩作为激活向量 $\\mathbf{a}$ 的函数：\n    $$\n    \\tau(\\mathbf{a}) = \\sum_{i=1}^{m} r_i (f_{\\max,i} a_i) = \\sum_{i=1}^{m} (r_i f_{\\max,i}) a_i\n    $$\n\n4.  **矩阵表述**：这种线性关系可以用矩阵形式表示。设 $\\mathbf{a} \\in \\mathbb{R}^m$ 为肌肉激活度的列向量。设 $\\mathbf{A}$ 是一个 $1 \\times m$ 的行矩阵（一个行向量），其元素是每块肌肉的最大潜在力矩贡献，$A_{1,i} = r_i f_{\\max,i}$。那么，产生的力矩由矩阵-向量乘积给出：\n    $$\n    \\tau(\\mathbf{a}) = \\mathbf{A}\\mathbf{a}\n    $$\n    问题在于找到一个激活向量 $\\mathbf{a}$，使得产生的力矩 $\\tau(\\mathbf{a})$ 尽可能接近期望力矩 $\\tau^\\star$。\n\n5.  **优化问题**：我们被要求找到一个非负激活向量 $\\mathbf{a}$，以最小化产生力矩与期望力矩之间的平方误差。设 $\\mathbf{b} = [\\tau^\\star]$ 为一个 $1 \\times 1$ 矩阵。目标是最小化残差向量 $\\mathbf{A}\\mathbf{a} - \\mathbf{b}$ 的 L2 范数。这引出了非负最小二乘（NNLS）问题的提法：\n    $$\n    \\underset{\\mathbf{a} \\in \\mathbb{R}^m}{\\text{minimize}} \\;\\; \\|\\mathbf{A}\\mathbf{a} - \\mathbf{b}\\|_2 \\quad \\text{subject to} \\quad \\mathbf{a} \\ge \\mathbf{0}\n    $$\n    这是一个凸优化问题，保证了唯一解的存在。\n\n#### 算法求解\n\n对于每个测试用例，NNLS 问题都通过计算求解。执行此任务的标准算法是主动集法，例如在 `scipy.optimize.nnls` 函数中实现的算法。每个测试用例的处理过程如下：\n\n1.  **构造输入**：给定力臂向量 $\\mathbf{r}$、最大力向量 $\\mathbf{f}_{\\max}$ 以及标量目标力矩 $\\tau^\\star$：\n    *   通过对 $\\mathbf{r}$ 和 $\\mathbf{f}_{\\max}$ 进行逐元素相乘，构造一个形状为 $(1, m)$ 的 NumPy 数组作为矩阵 $\\mathbf{A}$。\n    *   构造一个形状为 $(1,)$ 的 NumPy 数组作为向量 $\\mathbf{b}$，其中包含单个元素 $\\tau^\\star$。\n\n2.  **求解 NNLS**：使用构造的 $\\mathbf{A}$ 和 $\\mathbf{b}$ 调用 `scipy.optimize.nnls(A, b)` 函数。该函数返回解决该最小化问题的最优激活向量 $\\mathbf{a}$。\n\n3.  **格式化输出**：按要求将所得激活向量 $\\mathbf{a}$ 的分量四舍五入到六位小数，并准备用于最终的输出字符串。\n\n对于矩阵 $\\mathbf{A}$ 仅有一行的这种特定问题结构，解通常是稀疏的。算法会有效地选择最“高效”的肌肉（即在所需方向上具有最大力矩产生能力 $r_i f_{\\max,i}$ 的肌肉）来满足力矩需求。如果仅凭该单一肌肉的激活就足以精确产生 $\\tau^\\star$，则其激活度将被设为 $a_i = \\tau^\\star / (r_i f_{\\max,i})$，而所有其他肌肉的激活度将为零。如果 $\\tau^\\star$ 为零，则最优解是一个零激活向量。所提供的代码为所有给定的测试用例实现了这一过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Solves for the optimal muscle activation vector for a series of wrist\n    torque generation problems using Non-Negative Least Squares (NNLS).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1: general multi-muscle, mixed-sign moment arms\n        {'r': [0.018, 0.016, 0.014, -0.017, -0.015, -0.010, 0.001],\n         'f_max': [450, 400, 350, 550, 500, 300, 200],\n         'tau_star': 9.0},\n\n        # Test Case 2: boundary: zero desired torque\n        {'r': [0.018, 0.016, 0.014, -0.017, -0.015, -0.010, 0.001],\n         'f_max': [450, 400, 350, 550, 500, 300, 200],\n         'tau_star': 0.0},\n\n        # Test Case 3: large extension torque demand, negative moment arms present\n        {'r': [0.018, 0.016, 0.014, -0.017, -0.015, -0.010, 0.001],\n         'f_max': [450, 400, 350, 550, 500, 300, 200],\n         'tau_star': 25.0},\n\n        # Test Case 4: some muscles with zero moment arm\n        {'r': [0.020, 0.000, -0.018, 0.005],\n         'f_max': [300, 400, 450, 150],\n         'tau_star': 2.0},\n\n        # Test Case 5: small moment arms and moderate torque\n        {'r': [0.004, 0.003, -0.002],\n         'f_max': [250, 200, 300],\n         'tau_star': 1.0}\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract data for the current test case\n        r = np.array(case['r'])\n        f_max = np.array(case['f_max'])\n        tau_star = case['tau_star']\n        \n        # Number of muscles\n        m = len(r)\n\n        # Formulate the NNLS problem: minimize ||Aa - b||^2 subject to a = 0\n        # A is the matrix of torque contributions per unit activation\n        # A_i = r_i * f_max_i\n        A = (r * f_max).reshape(1, m)\n\n        # b is the target torque vector\n        b = np.array([tau_star])\n\n        # Solve the Non-Negative Least Squares problem\n        activation_vector, _ = nnls(A, b)\n        \n        results.append(activation_vector)\n    \n    # Format the results into the specified string format.\n    # Each activation value is formatted to six decimal places.\n    inner_strings = []\n    for vec in results:\n        vec_str = f\"[{','.join(f'{x:.6f}' for x in vec)}]\"\n        inner_strings.append(vec_str)\n    \n    final_output = f\"[{','.join(inner_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}