{
    "hands_on_practices": [
        {
            "introduction": "跑步生物力学研究的一个核心问题是运动效率。我们如何量化一名跑者将代谢能转化为前进运动的效率？本练习引入了“单位质量运输成本”（Cost of Transport, CoT）这一关键概念，它衡量了跑者每移动单位质量、单位距离所消耗的代谢能量。通过从功率和速度等基本物理量出发推导CoT的计算公式 ，您将掌握评估和比较不同跑者运动经济性的基本方法。",
            "id": "4158747",
            "problem": "一名训练有素的跑步者在平地上以 $v=3\\,\\mathrm{m/s}$ 的速度匀速奔跑，同时测得其全身代谢率为 $\\dot{E}_{met}=900\\,\\mathrm{W}$。该跑步者的体重为 $m=70\\,\\mathrm{kg}$。在跑步生物力学中，总单位体重运输成本 (CoT) 在概念上定义为每单位体重、每单位行进距离所消耗的代谢能。请从功率是单位时间的能量、速度是单位时间的距离这些基本定义出发，推导出匀速平地跑的总单位体重运输成本的表达式，并计算该跑步者的此数值。请以 $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}$ 为单位报告 CoT，并将答案四舍五入至四位有效数字。此外，在你的推理中，请评论计算出的值是否与训练有素的跑步者在此大致速度下的典型值（使用 $3.6$ 至 $4.5\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}$ 作为参考范围）一致，但不要将此评论包含在最终的数值答案中。",
            "solution": "问题要求推导总单位体重运输成本 (CoT) 的表达式，并计算其对于特定跑步者的数值。验证过程确认了该问题具有科学依据、提法明确，并且所有提供的数据都是一致且符合实际的。\n\n总单位体重运输成本 $\\mathrm{CoT}$ 的概念定义是消耗的代谢能 $E_{met}$ 除以单位体重 $m$ 和单位行进距离 $d$。我们可以将此定义形式化为数学表达式：\n$$\n\\mathrm{CoT} = \\frac{E_{met}}{m \\cdot d}\n$$\n在国际单位制（SI）中，这些量的单位分别是：能量为焦耳 ($J$)，质量为千克 ($kg$)，距离为米 ($m$)。因此，$\\mathrm{CoT}$ 的单位是 $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}$，正如问题所要求的。\n\n问题提供了跑步者的代谢率（功率）$\\dot{E}_{met}$ 和他们的匀速速度 $v$。我们必须将这些量与 $\\mathrm{CoT}$ 定义中的各项联系起来。\n\n代谢率，即功率，定义为单位时间 $t$ 内的能量消耗率。\n$$\n\\dot{E}_{met} = \\frac{dE_{met}}{dt}\n$$\n对于一个持续时间为 $t$ 的稳定过程，其中速率是恒定的，这可以简化为：\n$$\n\\dot{E}_{met} = \\frac{E_{met}}{t}\n$$\n由此，我们可以将总消耗的代谢能表示为代谢率与持续时间的乘积：\n$$\nE_{met} = \\dot{E}_{met} \\cdot t\n$$\n速度 $v$ 定义为位置的变化率，或单位时间内行进的距离。对于匀速运动，这表示为：\n$$\nv = \\frac{d}{t}\n$$\n由此，我们可以将总行进距离表示为速度与持续时间的乘积：\n$$\nd = v \\cdot t\n$$\n现在，我们将 $E_{met}$ 和 $d$ 的表达式代入我们对 $\\mathrm{CoT}$ 的形式化定义中：\n$$\n\\mathrm{CoT} = \\frac{E_{met}}{m \\cdot d} = \\frac{\\dot{E}_{met} \\cdot t}{m \\cdot (v \\cdot t)}\n$$\n持续时间 $t$ 同时出现在分子和分母中，这表明对于稳态跑步，$\\mathrm{CoT}$ 与跑步的持续时间无关。通过消去 $t$ 来简化表达式，得到 $\\mathrm{CoT}$ 的推导公式：\n$$\n\\mathrm{CoT} = \\frac{\\dot{E}_{met}}{m \\cdot v}\n$$\n这个表达式将运输成本与跑步者的代谢率、质量和速度联系起来。\n\n我们现在可以为给定的跑步者计算数值。提供的数据如下：\n- 代谢率：$\\dot{E}_{met} = 900\\,\\mathrm{W} = 900\\,\\mathrm{J/s}$\n- 体重：$m = 70\\,\\mathrm{kg}$\n- 速度：$v = 3\\,\\mathrm{m/s}$\n\n将这些值代入我们推导出的方程中：\n$$\n\\mathrm{CoT} = \\frac{900\\,\\mathrm{J/s}}{(70\\,\\mathrm{kg}) \\cdot (3\\,\\mathrm{m/s})}\n$$\n$$\n\\mathrm{CoT} = \\frac{900}{210} \\,\\frac{\\mathrm{J/s}}{\\mathrm{kg \\cdot m/s}}\n$$\n$$\n\\mathrm{CoT} = \\frac{90}{21} \\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}\n$$\n$$\n\\mathrm{CoT} = \\frac{30}{7} \\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}\n$$\n为了得到最终的数值答案，我们将分数转换为小数，并按要求四舍五入到四位有效数字。\n$$\n\\mathrm{CoT} \\approx 4.285714... \\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}\n$$\n四舍五入到四位有效数字得到：\n$$\n\\mathrm{CoT} \\approx 4.286 \\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}\n$$\n作为最后的检查，问题要求评论该值是否与训练有素的跑步者的典型范围（给定为 $3.6$ 至 $4.5\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}$）一致。我们计算出的值 $4.286\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}$ 恰好落在这个参考范围内，这表明初始数据是合理的，并且计算结果与生物力学中已有的研究发现相一致。",
            "answer": "$$ \\boxed{4.286} $$"
        },
        {
            "introduction": "为了深入理解跑步的力学原理，科学家们常使用简化的模型。其中最经典和富有洞察力的便是“弹簧-质量模型”，它将跑者在支撑相的复杂运动近似为一个弹簧支撑的质点运动。本练习  聚焦于该模型的关键参数——刚度，并引导您区分两个重要但常被混淆的概念：“腿部刚度” $k_{\\text{leg}}$ 和“垂直刚度” $k_{\\text{vert}}$。理解这两个刚度的区别，对于分析跑姿、能量存储与回馈以及损伤风险至关重要。",
            "id": "4158804",
            "problem": "将一位体重未知的跑步者在单足支撑相期间的运动建模为一个带柔性支撑的点质量模型，这与跑步的弹簧-质量模型一致。设地面反作用力（GRF）的垂直分量为 $F_{v}(t)$，并假设在支撑相期间 $F_{v}(t)$ 达到峰值的瞬间附近，质心（CoM）的垂直运动和腿轴压缩的力-位移关系是局部线性的。在这种小振幅线性化下，力遵循 $F \\approx k \\, \\Delta$ 的关系，其中 $k$ 是相关刚度，$\\Delta$ 是从初始接触时的未压缩状态测量的相应位移。\n\n定义了两种刚度度量：垂直刚度 $k_{\\text{vert}}$ 关联了峰值垂直GRF $F_{\\max}$ 与支撑相中质心的最大垂直位移 $\\Delta y$；腿部刚度 $k_{\\text{leg}}$ 关联了相同的峰值力 $F_{\\max}$ 与支撑相中腿轴的最大压缩量 $\\Delta L$。在线性弹簧近似下，这些度量被广泛用于量化跑步生物力学中的弹性响应。\n\n从牛顿第二定律和每个自由度的线性弹簧特性 $F \\approx k \\, \\Delta$ 出发，推导 $k_{\\text{vert}}$ 和 $k_{\\text{leg}}$ 关于 $F_{\\max}$ 和相应位移的表达式。然后，对于一个支撑相，测得的峰值垂直GRF为 $F_{\\max} = 2000\\,\\mathrm{N}$，质心垂直位移为 $\\Delta y = 0.05\\,\\mathrm{m}$，腿轴压缩量为 $\\Delta L = 0.03\\,\\mathrm{m}$，计算 $k_{\\text{vert}}$ 和 $k_{\\text{leg}}$ 的值（单位为 $\\mathrm{kN/m}$）。最后，通过报告比率 $k_{\\text{leg}}/k_{\\text{vert}}$ 来量化两种刚度之间的比较，并将其作为最终答案。将最终比率表示为一个无单位的纯数；如果可以精确地写成有理数，请给出简化的精确分数。最终答案无需四舍五入。",
            "solution": "该问题基于跑步生物力学中使用的标准弹簧-质量模型，问题陈述清晰且科学合理。我们将按要求进行推导和计算。\n\n基本前提是线性的力-位移关系，它将跑步者支撑腿结构的行为近似为一个简单的线性弹簧。该关系表示为 $F \\approx k \\, \\Delta$，其中 $F$ 是施加的力，$k$ 是刚度，$\\Delta$ 是从未压缩状态开始的位移。问题基于此原理定义了两种不同的刚度度量：垂直刚度（$k_{\\text{vert}}$）和腿部刚度（$k_{\\text{leg}}$）。\n\n首先，我们推导垂直刚度 $k_{\\text{vert}}$ 的表达式。问题陈述，$k_{\\text{vert}}$ 关联了峰值垂直地面反作用力（GRF）$F_{\\max}$ 与质心（CoM）的最大垂直位移 $\\Delta y$。应用通用的线性弹簧模型，我们代入相关的力和位移：\n$$F_{\\max} \\approx k_{\\text{vert}} \\cdot \\Delta y$$\n解出 $k_{\\text{vert}}$，我们得到表达式：\n$$k_{\\text{vert}} = \\frac{F_{\\max}}{\\Delta y}$$\n该方程将垂直刚度定义为质心所承受的峰值垂直力与其在支撑相期间的最大垂直位移之比。\n\n其次，我们推导腿部刚度 $k_{\\text{leg}}$ 的表达式。该刚度关联了相同的峰值力 $F_{\\max}$ 与腿轴的最大压缩量 $\\Delta L$。再次使用线性弹簧模型：\n$$F_{\\max} \\approx k_{\\text{leg}} \\cdot \\Delta L$$\n解出 $k_{\\text{leg}}$ 得：\n$$k_{\\text{leg}} = \\frac{F_{\\max}}{\\Delta L}$$\n该表达式将腿部刚度定义为沿腿轴传递的峰值力与腿长最大变化量之比。腿部刚度表征了腿部结构本身的固有弹性特性，在概念上与代表整个系统在垂直方向上刚度的垂直刚度有所区别。\n\n接下来，我们使用所提供的数据计算这些刚度的数值：$F_{\\max} = 2000\\,\\mathrm{N}$，$\\Delta y = 0.05\\,\\mathrm{m}$，以及 $\\Delta L = 0.03\\,\\mathrm{m}$。\n\n对于垂直刚度：\n$$k_{\\text{vert}} = \\frac{2000\\,\\mathrm{N}}{0.05\\,\\mathrm{m}} = 40000\\,\\mathrm{N/m}$$\n问题要求答案以千牛顿每米（$\\mathrm{kN/m}$）为单位。由于 $1\\,\\mathrm{kN} = 1000\\,\\mathrm{N}$，我们进行单位换算：\n$$k_{\\text{vert}} = 40000\\,\\mathrm{N/m} \\times \\frac{1\\,\\mathrm{kN}}{1000\\,\\mathrm{N}} = 40\\,\\mathrm{kN/m}$$\n\n对于腿部刚度：\n$$k_{\\text{leg}} = \\frac{2000\\,\\mathrm{N}}{0.03\\,\\mathrm{m}} = \\frac{200000}{3}\\,\\mathrm{N/m}$$\n换算成 $\\mathrm{kN/m}$：\n$$k_{\\text{leg}} = \\frac{200000}{3}\\,\\mathrm{N/m} \\times \\frac{1\\,\\mathrm{kN}}{1000\\,\\mathrm{N}} = \\frac{200}{3}\\,\\mathrm{kN/m}$$\n这约等于 $66.67\\,\\mathrm{kN/m}$。\n\n最后，我们计算比率 $k_{\\text{leg}}/k_{\\text{vert}}$ 以量化两种刚度之间的比较。使用推导出的符号表达式：\n$$\\frac{k_{\\text{leg}}}{k_{\\text{vert}}} = \\frac{\\left(\\frac{F_{\\max}}{\\Delta L}\\right)}{\\left(\\frac{F_{\\max}}{\\Delta y}\\right)}$$\n$F_{\\max}$ 项被消去，得到一个简单的几何比率：\n$$\\frac{k_{\\text{leg}}}{k_{\\text{vert}}} = \\frac{\\Delta y}{\\Delta L}$$\n代入给定的位移数值：\n$$\\frac{k_{\\text{leg}}}{k_{\\text{vert}}} = \\frac{0.05\\,\\mathrm{m}}{0.03\\,\\mathrm{m}} = \\frac{0.05}{0.03}$$\n为将其表示为简化的精确分数，我们可以将小数写成分数形式：\n$$\\frac{0.05}{0.03} = \\frac{5/100}{3/100} = \\frac{5}{3}$$\n这一结果证实了物理上的预期，即对于跑步者而言，腿部刚度（$k_{\\text{leg}}$）大于垂直刚度（$k_{\\text{vert}}$），因为在给定力的作用下，质心的垂直位移在几何上大于腿部的轴向压缩。比率 $\\frac{5}{3}$ 即为所要求的精确数值比较。",
            "answer": "$$ \\boxed{\\frac{5}{3}} $$"
        },
        {
            "introduction": "虽然弹簧-质量模型提供了系统层面的洞见，但要了解肌肉和关节的具体负荷，我们需要更精細的分析方法。逆向动力学分析是生物力学中的标准工具，它允许我们根据测量的运动学数据（如关节位置和加速度）和地面反作用力，反向推算出驱动运动的净关节力矩和关节反作用力。本练习  将指导您从第一性原理出发，为下肢的三段模型（足、小腿、大腿）构建并求解递归牛顿-欧拉方程，这是生物力学分析的一项核心技能。",
            "id": "4158785",
            "problem": "您的任务是设计并实现一个完整的、可运行的程序，该程序使用从第一性原理推导出的平面（矢状面）递归牛顿-欧拉公式，对跑步支撑期的三段式下肢（足、小腿、大腿）进行逆向动力学计算。目标是为一组指定的测试用例计算踝、膝、髋关节的净内关节力矩和关节反作用力。\n\n使用以下建模假设和基本定律：\n- 各分段是在矢状面内运动的刚体，其平面运动由平移加速度和旋转加速度定义。\n- 施加在系统远端的唯一外部载荷是地面反作用力（GRF），定义为施加在已知压力中心（COP）上的已知力矢量，以及一个可选的、围绕COP处垂直轴的自由外力矩。\n- 关节是理想的销钉关节，传递力但不传递外力矩。净内关节力矩由肌肉-肌腱和被动结构产生，必须计算出来以满足每个分段的旋转运动方程。\n- 牛顿第二运动定律适用于每个分段：外力之和等于质量乘以质心加速度，外力矩绕质心之和等于转动惯量乘以角加速度。\n- 重力加速度是恒定的，并向下作用于每个分段的质心。\n\n定义和符号约定：\n- 使用一个全局惯性坐标系，其中水平向前轴为$x$，垂直向上轴为$y$。\n- 平面中的矢量叉积简化为绕平面外轴的标量力矩：对于位置矢量$\\mathbf{r} = (r_x, r_y)$和力矢量$\\mathbf{F} = (F_x, F_y)$，定义标量力矩$\\tau = r_x F_y - r_y F_x$。\n- 所有力矩以逆时针旋转（绕平面外轴）为正。\n- 令$\\mathbf{F}_{\\mathrm{GRF}}$为地面反作用力（GRF），施加于COP位置$\\mathbf{r}_{\\mathrm{COP}}$，可选自由力矩为$M_{\\mathrm{GRF}}$（绕平面外轴）。令$\\mathbf{r}_{A}, \\mathbf{r}_{K}, \\mathbf{r}_{H}$分别为踝、膝、髋关节的位置，$\\mathbf{r}_{i}$为分段$i \\in \\{\\mathrm{foot}, \\mathrm{shank}, \\mathrm{thigh}\\}$的质心。令$\\mathbf{a}_{i}$为质心的线性加速度，$\\alpha_{i}$为角加速度，$m_{i}$为质量，$I_{i}$为绕质心的平面转动惯量。重力加速度为$g$。\n\n逐分段应用基本定律：\n- 足分段的外部力包括$\\mathbf{F}_{\\mathrm{GRF}}$、作用于质心的重力$\\mathbf{W}_{\\mathrm{foot}} = (0,-m_{\\mathrm{foot}} g)$，以及作用于足部的未知踝关节反作用力$\\mathbf{R}_{A}$。力平衡得出$\\mathbf{F}_{\\mathrm{GRF}} + \\mathbf{R}_{A} + \\mathbf{W}_{\\mathrm{foot}} = m_{\\mathrm{foot}} \\mathbf{a}_{\\mathrm{foot}}$。绕足质心的力矩平衡得出$M_{A} + \\left(\\mathbf{r}_{\\mathrm{COP}} - \\mathbf{r}_{\\mathrm{foot}}\\right) \\times \\mathbf{F}_{\\mathrm{GRF}} + M_{\\mathrm{GRF}} + \\left(\\mathbf{r}_{A} - \\mathbf{r}_{\\mathrm{foot}}\\right) \\times \\mathbf{R}_{A} = I_{\\mathrm{foot}} \\alpha_{\\mathrm{foot}}$，其中$M_{A}$是作用于足部的未知踝关节净内力矩（肌肉-肌腱合力）。\n- 小腿分段的外部力包括膝关节反作用力$\\mathbf{R}_{K}$、踝关节对小腿的作用力$-\\mathbf{R}_{A}$（与踝关节对足的反作用力大小相等，方向相反），以及重力$\\mathbf{W}_{\\mathrm{shank}} = (0,-m_{\\mathrm{shank}} g)$。力平衡为$\\mathbf{R}_{K} - \\mathbf{R}_{A} + \\mathbf{W}_{\\mathrm{shank}} = m_{\\mathrm{shank}} \\mathbf{a}_{\\mathrm{shank}}$，绕小腿质心的力矩平衡为$M_{K} + \\left(\\mathbf{r}_{A} - \\mathbf{r}_{\\mathrm{shank}}\\right) \\times (-\\mathbf{R}_{A}) + \\left(\\mathbf{r}_{K} - \\mathbf{r}_{\\mathrm{shank}}\\right) \\times \\mathbf{R}_{K} = I_{\\mathrm{shank}} \\alpha_{\\mathrm{shank}}$，其中$M_{K}$是作用于小腿的未知膝关节净内力矩。\n- 大腿分段的外部力包括髋关节反作用力$\\mathbf{R}_{H}$、膝关节对大腿的作用力$-\\mathbf{R}_{K}$，以及重力$\\mathbf{W}_{\\mathrm{thigh}} = (0,-m_{\\mathrm{thigh}} g)$。力平衡为$\\mathbf{R}_{H} - \\mathbf{R}_{K} + \\mathbf{W}_{\\mathrm{thigh}} = m_{\\mathrm{thigh}} \\mathbf{a}_{\\mathrm{thigh}}$，绕大腿质心的力矩平衡为$M_{H} + \\left(\\mathbf{r}_{K} - \\mathbf{r}_{\\mathrm{thigh}}\\right) \\times (-\\mathbf{R}_{K}) + \\left(\\mathbf{r}_{H} - \\mathbf{r}_{\\mathrm{thigh}}\\right) \\times \\mathbf{R}_{H} = I_{\\mathrm{thigh}} \\alpha_{\\mathrm{thigh}}$，其中$M_{H}$是作用于大腿的未知髋关节净内力矩。\n\n您的程序必须：\n- 使用标量平面叉积定义，精确地实现上述定律。\n- 使用以下四个测试用例。对于每个用例，将所有指定量视为已知输入，单位如下：位置（$\\mathrm{m}$），加速度（$\\mathrm{m/s^2}$），角加速度（$\\mathrm{rad/s^2}$），质量（$\\mathrm{kg}$），转动惯量（$\\mathrm{kg\\cdot m^2}$），力（$\\mathrm{N}$），力矩（$\\mathrm{N\\cdot m}$），以及重力加速度（$\\mathrm{m/s^2}$）。\n- 按以下顺序计算输出：踝关节净力矩$M_{A}$，膝关节净力矩$M_{K}$，髋关节净力矩$M_{H}$，踝关节反作用力分量$(R_{A,x}, R_{A,y})$，膝关节反作用力分量$(R_{K,x}, R_{K,y})$，以及髋关节反作用力分量$(R_{H,x}, R_{H,y})$。\n- 所有力以$\\mathrm{N}$表示，所有力矩以$\\mathrm{N\\cdot m}$表示，角度以弧度表示。\n\n测试套件（每个用例提供一个时间瞬间）：\n\n用例 1（支撑中期，带制动性GRF）：\n- $g = 9.81$ $\\mathrm{m/s^2}$。\n- $m_{\\mathrm{foot}} = 1.2$ $\\mathrm{kg}$, $m_{\\mathrm{shank}} = 3.6$ $\\mathrm{kg}$, $m_{\\mathrm{thigh}} = 8.5$ $\\mathrm{kg}$。\n- $I_{\\mathrm{foot}} = 0.006$ $\\mathrm{kg\\cdot m^2}$, $I_{\\mathrm{shank}} = 0.058$ $\\mathrm{kg\\cdot m^2}$, $I_{\\mathrm{thigh}} = 0.220$ $\\mathrm{kg\\cdot m^2}$。\n- $\\mathbf{r}_{A} = (0.10, 0.09)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{COP}} = (0.13, 0.00)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{foot}} = (0.14, 0.03)$ $\\mathrm{m}$。\n- $\\mathbf{a}_{\\mathrm{foot}} = (0.50, 0.20)$ $\\mathrm{m/s^2}$, $\\alpha_{\\mathrm{foot}} = -30.00$ $\\mathrm{rad/s^2}$。\n- $\\mathbf{r}_{K} = (0.10, 0.47)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{shank}} = (0.10, 0.30)$ $\\mathrm{m}$, $\\mathbf{a}_{\\mathrm{shank}} = (0.00, 2.00)$ $\\mathrm{m/s^2}$, $\\alpha_{\\mathrm{shank}} = 20.00$ $\\mathrm{rad/s^2}$。\n- $\\mathbf{r}_{H} = (0.08, 0.85)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{thigh}} = (0.09, 0.68)$ $\\mathrm{m}$, $\\mathbf{a}_{\\mathrm{thigh}} = (-0.50, 1.50)$ $\\mathrm{m/s^2}$, $\\alpha_{\\mathrm{thigh}} = 10.00$ $\\mathrm{rad/s^2}$。\n- $\\mathbf{F}_{\\mathrm{GRF}} = (-250.00, 1700.00)$ $\\mathrm{N}$, $M_{\\mathrm{GRF}} = 5.00$ $\\mathrm{N\\cdot m}$。\n\n用例 2（边界情况：COP在踝关节正下方，分段加速度可忽略不计）：\n- $g = 9.81$ $\\mathrm{m/s^2}$。\n- $m_{\\mathrm{foot}} = 1.2$ $\\mathrm{kg}$, $m_{\\mathrm{shank}} = 3.6$ $\\mathrm{kg}$, $m_{\\mathrm{thigh}} = 8.5$ $\\mathrm{kg}$。\n- $I_{\\mathrm{foot}} = 0.006$ $\\mathrm{kg\\cdot m^2}$, $I_{\\mathrm{shank}} = 0.058$ $\\mathrm{kg\\cdot m^2}$, $I_{\\mathrm{thigh}} = 0.220$ $\\mathrm{kg\\cdot m^2}$。\n- $\\mathbf{r}_{A} = (0.12, 0.09)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{COP}} = (0.12, 0.00)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{foot}} = (0.125, 0.03)$ $\\mathrm{m}$。\n- $\\mathbf{a}_{\\mathrm{foot}} = (0.00, 0.00)$ $\\mathrm{m/s^2}$, $\\alpha_{\\mathrm{foot}} = 0.00$ $\\mathrm{rad/s^2}$。\n- $\\mathbf{r}_{K} = (0.12, 0.47)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{shank}} = (0.12, 0.30)$ $\\mathrm{m}$, $\\mathbf{a}_{\\mathrm{shank}} = (0.00, 0.00)$ $\\mathrm{m/s^2}$, $\\alpha_{\\mathrm{shank}} = 0.00$ $\\mathrm{rad/s^2}$。\n- $\\mathbf{r}_{H} = (0.12, 0.85)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{thigh}} = (0.115, 0.68)$ $\\mathrm{m}$, $\\mathbf{a}_{\\mathrm{thigh}} = (0.00, 0.00)$ $\\mathrm{m/s^2}$, $\\alpha_{\\mathrm{thigh}} = 0.00$ $\\mathrm{rad/s^2}$。\n- $\\mathbf{F}_{\\mathrm{GRF}} = (0.00, 1200.00)$ $\\mathrm{N}$, $M_{\\mathrm{GRF}} = 0.00$ $\\mathrm{N\\cdot m}$。\n\n用例 3（推进期：前向GRF和正的分段角加速度）：\n- $g = 9.81$ $\\mathrm{m/s^2}$。\n- $m_{\\mathrm{foot}} = 1.2$ $\\mathrm{kg}$, $m_{\\mathrm{shank}} = 3.6$ $\\mathrm{kg}$, $m_{\\mathrm{thigh}} = 8.5$ $\\mathrm{kg}$。\n- $I_{\\mathrm{foot}} = 0.006$ $\\mathrm{kg\\cdot m^2}$, $I_{\\mathrm{shank}} = 0.058$ $\\mathrm{kg\\cdot m^2}$, $I_{\\mathrm{thigh}} = 0.220$ $\\mathrm{kg\\cdot m^2}$。\n- $\\mathbf{r}_{A} = (0.06, 0.09)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{COP}} = (0.08, 0.00)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{foot}} = (0.085, 0.03)$ $\\mathrm{m}$。\n- $\\mathbf{a}_{\\mathrm{foot}} = (0.20, 0.40)$ $\\mathrm{m/s^2}$, $\\alpha_{\\mathrm{foot}} = 15.00$ $\\mathrm{rad/s^2}$。\n- $\\mathbf{r}_{K} = (0.06, 0.47)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{shank}} = (0.06, 0.30)$ $\\mathrm{m}$, $\\mathbf{a}_{\\mathrm{shank}} = (0.50, 2.50)$ $\\mathrm{m/s^2}$, $\\alpha_{\\mathrm{shank}} = 25.00$ $\\mathrm{rad/s^2}$。\n- $\\mathbf{r}_{H} = (0.03, 0.85)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{thigh}} = (0.04, 0.68)$ $\\mathrm{m}$, $\\mathbf{a}_{\\mathrm{thigh}} = (0.30, 2.00)$ $\\mathrm{m/s^2}$, $\\alpha_{\\mathrm{thigh}} = 20.00$ $\\mathrm{rad/s^2}$。\n- $\\mathbf{F}_{\\mathrm{GRF}} = (150.00, 1800.00)$ $\\mathrm{N}$, $M_{\\mathrm{GRF}} = -3.00$ $\\mathrm{N\\cdot m}$。\n\n用例 4（边缘情况：仅有垂直GRF，加速度很小）：\n- $g = 9.81$ $\\mathrm{m/s^2}$。\n- $m_{\\mathrm{foot}} = 1.2$ $\\mathrm{kg}$, $m_{\\mathrm{shank}} = 3.6$ $\\mathrm{kg}$, $m_{\\mathrm{thigh}} = 8.5$ $\\mathrm{kg}$。\n- $I_{\\mathrm{foot}} = 0.006$ $\\mathrm{kg\\cdot m^2}$, $I_{\\mathrm{shank}} = 0.058$ $\\mathrm{kg\\cdot m^2}$, $I_{\\mathrm{thigh}} = 0.220$ $\\mathrm{kg\\cdot m^2}$。\n- $\\mathbf{r}_{A} = (0.10, 0.09)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{COP}} = (0.10, 0.00)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{foot}} = (0.10, 0.03)$ $\\mathrm{m}$。\n- $\\mathbf{a}_{\\mathrm{foot}} = (0.00, 0.10)$ $\\mathrm{m/s^2}$, $\\alpha_{\\mathrm{foot}} = 0.00$ $\\mathrm{rad/s^2}$。\n- $\\mathbf{r}_{K} = (0.10, 0.47)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{shank}} = (0.10, 0.30)$ $\\mathrm{m}$, $\\mathbf{a}_{\\mathrm{shank}} = (0.00, 0.10)$ $\\mathrm{m/s^2}$, $\\alpha_{\\mathrm{shank}} = 0.00$ $\\mathrm{rad/s^2}$。\n- $\\mathbf{r}_{H} = (0.10, 0.85)$ $\\mathrm{m}$, $\\mathbf{r}_{\\mathrm{thigh}} = (0.10, 0.68)$ $\\mathrm{m}$, $\\mathbf{a}_{\\mathrm{thigh}} = (0.00, 0.10)$ $\\mathrm{m/s^2}$, $\\alpha_{\\mathrm{thigh}} = 0.00$ $\\mathrm{rad/s^2}$。\n- $\\mathbf{F}_{\\mathrm{GRF}} = (0.00, 800.00)$ $\\mathrm{N}$, $M_{\\mathrm{GRF}} = 0.00$ $\\mathrm{N\\cdot m}$。\n\n最终输出规范：\n- 您的程序应生成单行输出，包含一个由逗号分隔的列表，用方括号括起来。其中每个元素对应一个测试用例，本身是一个包含九个浮点数的列表，顺序为 $[M_{A}, M_{K}, M_{H}, R_{A,x}, R_{A,y}, R_{K,x}, R_{K,y}, R_{H,x}, R_{H,y}]$。例如，格式应类似于 $[[\\ldots],[\\ldots],[\\ldots],[\\ldots]]$，不含任何附加文本。",
            "solution": "该问题陈述已被验证为具有科学依据、问题设定良好且客观。它为执行一个三段式下肢模型的平面逆向动力学分析提供了一套完整且一致的定义、物理定律和数据。该问题是递归牛顿-欧拉算法的直接且非平凡的应用，该算法是生物力学中的一种基本方法。解决方案通过系统地应用所提供的运动方程来推进。\n\n刚体 $i$ 的基本方程为：\n$$ \\sum \\mathbf{F}_{\\text{ext}} = m_i \\mathbf{a}_i $$\n$$ \\sum M_{\\text{ext, COM}} = I_i \\alpha_i $$\n其中 $\\sum \\mathbf{F}_{\\text{ext}}$ 是作用于物体的所有外力的矢量和，$m_i$ 是其质量，$\\mathbf{a}_i$ 是其质心（COM）的线性加速度，$\\sum M_{\\text{ext, COM}}$ 是所有外力绕质心的力矩的标量和，$I_i$ 是绕质心的转动惯量，$\\alpha_i$ 是角加速度。力矩以逆时针旋转为正。问题将位置矢量 $\\mathbf{r} = (r_x, r_y)$ 和力矢量 $\\mathbf{F} = (F_x, F_y)$ 的平面标量叉积定义为力矩 $\\tau = r_x F_y - r_y F_x$。\n\n**1. 足分段分析**\n\n未知量是小腿施加于足部的踝关节反作用力 $\\mathbf{R}_A = (R_{A,x}, R_{A,y})$ 和踝关节净内力矩 $M_A$。\n\n足部的线性运动方程为：\n$$ \\mathbf{F}_{\\mathrm{GRF}} + \\mathbf{R}_{A} + \\mathbf{W}_{\\mathrm{foot}} = m_{\\mathrm{foot}} \\mathbf{a}_{\\mathrm{foot}} $$\n其中 $\\mathbf{W}_{\\mathrm{foot}} = (0, -m_{\\mathrm{foot}} g)$ 是重力。\n此矢量方程可直接求解未知反作用力 $\\mathbf{R}_{A}$：\n$$ \\mathbf{R}_{A} = m_{\\mathrm{foot}} \\mathbf{a}_{\\mathrm{foot}} - \\mathbf{F}_{\\mathrm{GRF}} - \\mathbf{W}_{\\mathrm{foot}} $$\n以分量形式表示：\n$$ R_{A,x} = m_{\\mathrm{foot}} a_{\\mathrm{foot},x} - F_{\\mathrm{GRF},x} $$\n$$ R_{A,y} = m_{\\mathrm{foot}} a_{\\mathrm{foot},y} - F_{\\mathrm{GRF},y} + m_{\\mathrm{foot}} g $$\n\n绕足部质心 $\\mathbf{r}_{\\mathrm{foot}}$ 的角运动方程为：\n$$ M_{A} + (\\mathbf{r}_{\\mathrm{COP}} - \\mathbf{r}_{\\mathrm{foot}}) \\times \\mathbf{F}_{\\mathrm{GRF}} + M_{\\mathrm{GRF}} + (\\mathbf{r}_{A} - \\mathbf{r}_{\\mathrm{foot}}) \\times \\mathbf{R}_{A} = I_{\\mathrm{foot}} \\alpha_{\\mathrm{foot}} $$\n由于 $\\mathbf{R}_{A}$ 已通过力方程确定，除 $M_{A}$ 外的所有项都是已知的。我们可以求解 $M_A$：\n$$ M_{A} = I_{\\mathrm{foot}} \\alpha_{\\mathrm{foot}} - \\left( (\\mathbf{r}_{\\mathrm{COP}} - \\mathbf{r}_{\\mathrm{foot}}) \\times \\mathbf{F}_{\\mathrm{GRF}} + M_{\\mathrm{GRF}} + (\\mathbf{r}_{A} - \\mathbf{r}_{\\mathrm{foot}}) \\times \\mathbf{R}_{A} \\right) $$\n\n**2. 小腿分段分析**\n\n未知量是大腿施加于小腿的膝关节反作用力 $\\mathbf{R}_K = (R_{K,x}, R_{K,y})$ 和膝关节净内力矩 $M_K$。根据牛顿第三定律，足部施加于小腿的力为 $-\\mathbf{R}_A$。\n\n小腿的线性运动方程为：\n$$ \\mathbf{R}_{K} - \\mathbf{R}_{A} + \\mathbf{W}_{\\mathrm{shank}} = m_{\\mathrm{shank}} \\mathbf{a}_{\\mathrm{shank}} $$\n其中 $\\mathbf{W}_{\\mathrm{shank}} = (0, -m_{\\mathrm{shank}} g)$。\n使用已知的 $\\mathbf{R}_{A}$ 值，求解未知反作用力 $\\mathbf{R}_{K}$：\n$$ \\mathbf{R}_{K} = m_{\\mathrm{shank}} \\mathbf{a}_{\\mathrm{shank}} + \\mathbf{R}_{A} - \\mathbf{W}_{\\mathrm{shank}} $$\n以分量形式表示：\n$$ R_{K,x} = m_{\\mathrm{shank}} a_{\\mathrm{shank},x} + R_{A,x} $$\n$$ R_{K,y} = m_{\\mathrm{shank}} a_{\\mathrm{shank},y} + R_{A,y} + m_{\\mathrm{shank}} g $$\n\n绕小腿质心 $\\mathbf{r}_{\\mathrm{shank}}$ 的角运动方程为：\n$$ M_{K} + (\\mathbf{r}_{A} - \\mathbf{r}_{\\mathrm{shank}}) \\times (-\\mathbf{R}_{A}) + (\\mathbf{r}_{K} - \\mathbf{r}_{\\mathrm{shank}}) \\times \\mathbf{R}_{K} = I_{\\mathrm{shank}} \\alpha_{\\mathrm{shank}} $$\n由于 $\\mathbf{R}_{A}$ 和 $\\mathbf{R}_{K}$ 均已知，我们可以求解 $M_K$：\n$$ M_{K} = I_{\\mathrm{shank}} \\alpha_{\\mathrm{shank}} - \\left( (\\mathbf{r}_{A} - \\mathbf{r}_{\\mathrm{shank}}) \\times (-\\mathbf{R}_{A}) + (\\mathbf{r}_{K} - \\mathbf{r}_{\\mathrm{shank}}) \\times \\mathbf{R}_{K} \\right) $$\n\n**3. 大腿分段分析**\n\n未知量是骨盆施加于大腿的髋关节反作用力 $\\mathbf{R}_H = (R_{H,x}, R_{H,y})$ 和髋关节净内力矩 $M_H$。小腿施加于大腿的力为 $-\\mathbf{R}_K$。\n\n大腿的线性运动方程为：\n$$ \\mathbf{R}_{H} - \\mathbf{R}_{K} + \\mathbf{W}_{\\mathrm{thigh}} = m_{\\mathrm{thigh}} \\mathbf{a}_{\\mathrm{thigh}} $$\n其中 $\\mathbf{W}_{\\mathrm{thigh}} = (0, -m_{\\mathrm{thigh}} g)$。\n使用已知的 $\\mathbf{R}_{K}$ 值，求解未知反作用力 $\\mathbf{R}_{H}$：\n$$ \\mathbf{R}_{H} = m_{\\mathrm{thigh}} \\mathbf{a}_{\\mathrm{thigh}} + \\mathbf{R}_{K} - \\mathbf{W}_{\\mathrm{thigh}} $$\n以分量形式表示：\n$$ R_{H,x} = m_{\\mathrm{thigh}} a_{\\mathrm{thigh},x} + R_{K,x} $$\n$$ R_{H,y} = m_{\\mathrm{thigh}} a_{\\mathrm{thigh},y} + R_{K,y} + m_{\\mathrm{thigh}} g $$\n\n绕大腿质心 $\\mathbf{r}_{\\mathrm{thigh}}$ 的角运动方程为：\n$$ M_{H} + (\\mathbf{r}_{K} - \\mathbf{r}_{\\mathrm{thigh}}) \\times (-\\mathbf{R}_{K}) + (\\mathbf{r}_{H} - \\mathbf{r}_{\\mathrm{thigh}}) \\times \\mathbf{R}_{H} = I_{\\mathrm{thigh}} \\alpha_{\\mathrm{thigh}} $$\n由于 $\\mathbf{R}_{K}$ 和 $\\mathbf{R}_{H}$ 均已知，我们可以求解 $M_H$：\n$$ M_{H} = I_{\\mathrm{thigh}} \\alpha_{\\mathrm{thigh}} - \\left( (\\mathbf{r}_{K} - \\mathbf{r}_{\\mathrm{thigh}}) \\times (-\\mathbf{R}_{K}) + (\\mathbf{r}_{H} - \\mathbf{r}_{\\mathrm{thigh}}) \\times \\mathbf{R}_{H} \\right) $$\n\n这样就完成了递归过程。所有九个要求的量（$M_A, M_K, M_H, \\mathbf{R}_A, \\mathbf{R}_K, \\mathbf{R}_H$）都已确定。以下程序为指定的测试用例实现了该算法。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes net internal joint moments and reaction forces for a three-segment\n    lower limb model using a Recursive Newton-Euler formulation.\n    \"\"\"\n\n    test_cases = [\n        # Case 1\n        {\n            \"g\": 9.81,\n            \"m_foot\": 1.2, \"m_shank\": 3.6, \"m_thigh\": 8.5,\n            \"I_foot\": 0.006, \"I_shank\": 0.058, \"I_thigh\": 0.220,\n            \"r_A\": np.array([0.10, 0.09]), \"r_COP\": np.array([0.13, 0.00]),\n            \"r_foot\": np.array([0.14, 0.03]),\n            \"a_foot\": np.array([0.50, 0.20]), \"alpha_foot\": -30.00,\n            \"r_K\": np.array([0.10, 0.47]), \"r_shank\": np.array([0.10, 0.30]),\n            \"a_shank\": np.array([0.00, 2.00]), \"alpha_shank\": 20.00,\n            \"r_H\": np.array([0.08, 0.85]), \"r_thigh\": np.array([0.09, 0.68]),\n            \"a_thigh\": np.array([-0.50, 1.50]), \"alpha_thigh\": 10.00,\n            \"F_GRF\": np.array([-250.00, 1700.00]), \"M_GRF\": 5.00,\n        },\n        # Case 2\n        {\n            \"g\": 9.81,\n            \"m_foot\": 1.2, \"m_shank\": 3.6, \"m_thigh\": 8.5,\n            \"I_foot\": 0.006, \"I_shank\": 0.058, \"I_thigh\": 0.220,\n            \"r_A\": np.array([0.12, 0.09]), \"r_COP\": np.array([0.12, 0.00]),\n            \"r_foot\": np.array([0.125, 0.03]),\n            \"a_foot\": np.array([0.00, 0.00]), \"alpha_foot\": 0.00,\n            \"r_K\": np.array([0.12, 0.47]), \"r_shank\": np.array([0.12, 0.30]),\n            \"a_shank\": np.array([0.00, 0.00]), \"alpha_shank\": 0.00,\n            \"r_H\": np.array([0.12, 0.85]), \"r_thigh\": np.array([0.115, 0.68]),\n            \"a_thigh\": np.array([0.00, 0.00]), \"alpha_thigh\": 0.00,\n            \"F_GRF\": np.array([0.00, 1200.00]), \"M_GRF\": 0.00,\n        },\n        # Case 3\n        {\n            \"g\": 9.81,\n            \"m_foot\": 1.2, \"m_shank\": 3.6, \"m_thigh\": 8.5,\n            \"I_foot\": 0.006, \"I_shank\": 0.058, \"I_thigh\": 0.220,\n            \"r_A\": np.array([0.06, 0.09]), \"r_COP\": np.array([0.08, 0.00]),\n            \"r_foot\": np.array([0.085, 0.03]),\n            \"a_foot\": np.array([0.20, 0.40]), \"alpha_foot\": 15.00,\n            \"r_K\": np.array([0.06, 0.47]), \"r_shank\": np.array([0.06, 0.30]),\n            \"a_shank\": np.array([0.50, 2.50]), \"alpha_shank\": 25.00,\n            \"r_H\": np.array([0.03, 0.85]), \"r_thigh\": np.array([0.04, 0.68]),\n            \"a_thigh\": np.array([0.30, 2.00]), \"alpha_thigh\": 20.00,\n            \"F_GRF\": np.array([150.00, 1800.00]), \"M_GRF\": -3.00,\n        },\n        # Case 4\n        {\n            \"g\": 9.81,\n            \"m_foot\": 1.2, \"m_shank\": 3.6, \"m_thigh\": 8.5,\n            \"I_foot\": 0.006, \"I_shank\": 0.058, \"I_thigh\": 0.220,\n            \"r_A\": np.array([0.10, 0.09]), \"r_COP\": np.array([0.10, 0.00]),\n            \"r_foot\": np.array([0.10, 0.03]),\n            \"a_foot\": np.array([0.00, 0.10]), \"alpha_foot\": 0.00,\n            \"r_K\": np.array([0.10, 0.47]), \"r_shank\": np.array([0.10, 0.30]),\n            \"a_shank\": np.array([0.00, 0.10]), \"alpha_shank\": 0.00,\n            \"r_H\": np.array([0.10, 0.85]), \"r_thigh\": np.array([0.10, 0.68]),\n            \"a_thigh\": np.array([0.00, 0.10]), \"alpha_thigh\": 0.00,\n            \"F_GRF\": np.array([0.00, 800.00]), \"M_GRF\": 0.00,\n        }\n    ]\n\n    results = []\n    \n    def cross_2d(r, F):\n        \"\"\"Calculates the scalar 2D cross product for moment calculation.\"\"\"\n        return r[0] * F[1] - r[1] * F[0]\n\n    for case in test_cases:\n        # --- 1. Foot Segment ---\n        W_foot = np.array([0, -case[\"m_foot\"] * case[\"g\"]])\n        \n        # Calculate Ankle Reaction Force R_A\n        R_A = case[\"m_foot\"] * case[\"a_foot\"] - case[\"F_GRF\"] - W_foot\n        \n        # Calculate Ankle Moment M_A\n        r_cop_foot = case[\"r_COP\"] - case[\"r_foot\"]\n        r_a_foot = case[\"r_A\"] - case[\"r_foot\"]\n        \n        moment_from_grf = cross_2d(r_cop_foot, case[\"F_GRF\"])\n        moment_from_ra = cross_2d(r_a_foot, R_A)\n        \n        M_A = (case[\"I_foot\"] * case[\"alpha_foot\"] - \n               (moment_from_grf + case[\"M_GRF\"] + moment_from_ra))\n\n        # --- 2. Shank Segment ---\n        W_shank = np.array([0, -case[\"m_shank\"] * case[\"g\"]])\n        \n        # Calculate Knee Reaction Force R_K\n        R_K = case[\"m_shank\"] * case[\"a_shank\"] + R_A - W_shank\n        \n        # Calculate Knee Moment M_K\n        r_a_shank = case[\"r_A\"] - case[\"r_shank\"]\n        r_k_shank = case[\"r_K\"] - case[\"r_shank\"]\n        \n        moment_from_ankle_action = cross_2d(r_a_shank, -R_A)\n        moment_from_rk = cross_2d(r_k_shank, R_K)\n        \n        M_K = (case[\"I_shank\"] * case[\"alpha_shank\"] -\n               (moment_from_ankle_action + moment_from_rk))\n\n        # --- 3. Thigh Segment ---\n        W_thigh = np.array([0, -case[\"m_thigh\"] * case[\"g\"]])\n        \n        # Calculate Hip Reaction Force R_H\n        R_H = case[\"m_thigh\"] * case[\"a_thigh\"] + R_K - W_thigh\n        \n        # Calculate Hip Moment M_H\n        r_k_thigh = case[\"r_K\"] - case[\"r_thigh\"]\n        r_h_thigh = case[\"r_H\"] - case[\"r_thigh\"]\n        \n        moment_from_knee_action = cross_2d(r_k_thigh, -R_K)\n        moment_from_rh = cross_2d(r_h_thigh, R_H)\n        \n        M_H = (case[\"I_thigh\"] * case[\"alpha_thigh\"] -\n               (moment_from_knee_action + moment_from_rh))\n\n        # Collect results in specified order\n        case_results = [\n            M_A, M_K, M_H, \n            R_A[0], R_A[1], \n            R_K[0], R_K[1], \n            R_H[0], R_H[1]\n        ]\n        results.append(case_results)\n\n    # Format the final output string exactly as specified\n    inner_strings = []\n    for res_list in results:\n        inner_str = '[' + ','.join(map(str, res_list)) + ']'\n        inner_strings.append(inner_str)\n    final_output = '[' + ','.join(inner_strings) + ']'\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}