{
    "hands_on_practices": [
        {
            "introduction": "Understanding how muscles produce movement begins with the fundamental relationship between linear force and rotational moment. This exercise provides a concrete application of vector mechanics to calculate a single muscle's contribution to the net joint moment at the hip . By working through the calculation of a moment from a given force vector and position vector, you will reinforce your understanding of the cross product and the principles of static equilibrium in a biomechanical context.",
            "id": "4178161",
            "problem": "A subject is analyzed during the terminal stance phase of gait. Consider the pelvis segment coordinate system with origin at the hip joint center. The pelvis axes are defined as follows: the $x$-axis points anteriorly, the $y$-axis points superiorly, and the $z$-axis points to the subject’s right (mediolateral axis). Adopt the right-hand rule for moments, and define a positive hip flexion-extension moment as the component along the $+z$-axis that produces hip extension.\n\nAt a specific instant, a posterior hip extensor muscle has a measured muscle force vector in the pelvis frame given by components $\\mathbf{F} = (-1500, 600, -400)$ N. A position vector from the hip joint center to a point on the muscle’s line of action is measured as $\\mathbf{r} = (-0.03, 0.05, 0.04)$ m. The net hip flexion-extension moment from Inverse Dynamics (ID) at this instant, resolved about the $+z$-axis in the pelvis frame, is $+50$ N·m (positive extension).\n\nStarting only from Newton’s laws (including that internal forces generate moments about a reference point via their lines of action) and the definition of moment about an axis, perform the following:\n\n1. Derive the contribution of this muscle to the hip flexion-extension moment about the $+z$-axis at the specified instant.\n2. Using moment balance about the $+z$-axis, determine the magnitude of the antagonistic flexion moment that must be present from other structures so that the total flexion-extension moment equals the net ID moment at that instant.\n\nExpress the required antagonistic flexion moment magnitude in N·m. Round your final answer to four significant figures.",
            "solution": "The problem requires the calculation of a muscle's moment contribution and a subsequent antagonistic moment using the principles of static equilibrium. The solution proceeds from the fundamental definition of the moment of a force.\n\nAccording to Newton's laws, a force $\\mathbf{F}$ applied at a point defined by a position vector $\\mathbf{r}$ relative to a reference point creates a moment $\\mathbf{M}$ about that reference point. The moment vector is defined by the cross product of the position vector and the force vector:\n$$ \\mathbf{M} = \\mathbf{r} \\times \\mathbf{F} $$\nThe problem is set within a right-handed Cartesian coordinate system with basis vectors $\\{\\mathbf{i}, \\mathbf{j}, \\mathbf{k}\\}$ corresponding to the $\\{x, y, z\\}$ axes (anterior, superior, right). The vectors $\\mathbf{r}$ and $\\mathbf{F}$ are given in component form:\n$$ \\mathbf{r} = r_x \\mathbf{i} + r_y \\mathbf{j} + r_z \\mathbf{k} $$\n$$ \\mathbf{F} = F_x \\mathbf{i} + F_y \\mathbf{j} + F_z \\mathbf{k} $$\nThe cross product can be expanded to find the components of the moment vector $\\mathbf{M} = M_x \\mathbf{i} + M_y \\mathbf{j} + M_z \\mathbf{k}$:\n$$ \\mathbf{M} = (r_y F_z - r_z F_y)\\mathbf{i} + (r_z F_x - r_x F_z)\\mathbf{j} + (r_x F_y - r_y F_x)\\mathbf{k} $$\nThe component of the moment about the $z$-axis, which corresponds to the hip flexion-extension moment in this problem's convention, is therefore:\n$$ M_z = r_x F_y - r_y F_x $$\n\n**Part 1: Derive the contribution of the muscle to the hip flexion-extension moment.**\n\nThe problem provides the following data:\nThe force vector of the posterior hip extensor muscle is $\\mathbf{F} = (-1500, 600, -400) \\, \\text{N}$. Its components are:\n$F_x = -1500 \\, \\text{N}$\n$F_y = 600 \\, \\text{N}$\n$F_z = -400 \\, \\text{N}$\n\nThe position vector from the hip joint center to the muscle's line of action is $\\mathbf{r} = (-0.03, 0.05, 0.04) \\, \\text{m}$. Its components are:\n$r_x = -0.03 \\, \\text{m}$\n$r_y = 0.05 \\, \\text{m}$\n$r_z = 0.04 \\, \\text{m}$\n\nThe moment contribution from this muscle about the $z$-axis, denoted as $M_{musc, z}$, is calculated using the formula for $M_z$:\n$$ M_{musc, z} = r_x F_y - r_y F_x $$\nSubstituting the numerical values:\n$$ M_{musc, z} = (-0.03 \\, \\text{m}) \\times (600 \\, \\text{N}) - (0.05 \\, \\text{m}) \\times (-1500 \\, \\text{N}) $$\n$$ M_{musc, z} = -18 \\, \\text{N·m} - (-75 \\, \\text{N·m}) $$\n$$ M_{musc, z} = -18 \\, \\text{N·m} + 75 \\, \\text{N·m} $$\n$$ M_{musc, z} = 57 \\, \\text{N·m} $$\nThe problem defines a positive moment about the $+z$-axis as producing hip extension. The calculated moment $M_{musc, z}$ is positive, indicating that this muscle generates an extension moment of magnitude $57 \\, \\text{N·m}$.\n\n**Part 2: Determine the magnitude of the antagonistic flexion moment.**\n\nThe principle of moment balance dictates that the net moment about an axis is the algebraic sum of all individual moment contributions about that same axis. The net hip flexion-extension moment, $M_{net, z}$, is given as the sum of the moment from the specified extensor muscle, $M_{musc, z}$, and the moment from all other structures, which is described as an antagonistic flexion moment, $M_{antag, z}$.\nThe balance equation is:\n$$ M_{net, z} = M_{musc, z} + M_{antag, z} $$\nThe problem provides the net moment from an Inverse Dynamics (ID) analysis:\n$$ M_{net, z} = +50 \\, \\text{N·m} $$\nThe positive sign signifies a net extension moment. We can now solve for the antagonistic moment component, $M_{antag, z}$:\n$$ M_{antag, z} = M_{net, z} - M_{musc, z} $$\nSubstituting the known values for $M_{net, z}$ and the calculated value for $M_{musc, z}$:\n$$ M_{antag, z} = 50 \\, \\text{N·m} - 57 \\, \\text{N·m} $$\n$$ M_{antag, z} = -7 \\, \\text{N·m} $$\nThe negative sign of $M_{antag, z}$ indicates that this moment acts in the direction opposite to extension, which is flexion, as per the established convention. This confirms its description as an \"antagonistic flexion moment\". The question asks for the *magnitude* of this moment, which is the absolute value of $M_{antag, z}$:\n$$ |M_{antag, z}| = |-7 \\, \\text{N·m}| = 7 \\, \\text{N·m} $$\nThe problem requires the final answer to be rounded to four significant figures. Expressing $7$ with four significant figures gives $7.000$.\nThus, the magnitude of the required antagonistic flexion moment is $7.000 \\, \\text{N·m}$.",
            "answer": "$$\n\\boxed{7.000}\n$$"
        },
        {
            "introduction": "While individual muscles generate forces, biomechanical analysis often starts with the net joint moment calculated from inverse dynamics. This net moment represents the total rotational demand of a task, which must be met by an internal moment generated by muscles and ligaments. This practice challenges you to navigate the crucial, and often confusing, distinction between external and internal moments, emphasizing how different sign conventions can alter data interpretation . Mastering this translation is a vital skill for correctly identifying which muscle groups are active during a movement.",
            "id": "4178152",
            "problem": "A right-limb task is analyzed using inverse dynamics to obtain hip joint torque profiles resolved by anatomical plane: sagittal (flexion–extension), frontal (abduction–adduction), and transverse (internal–external rotation). The laboratory’s reporting convention for the net hip moment acting on the limb (call this the “external” moment in the sense that it is the net moment demanded by the motion and ground reaction force on the limb) uses per-plane sign labels as follows: in the sagittal plane, a positive number is labeled “extension”; in the frontal plane, a positive number is labeled “abduction”; in the transverse plane, a positive number is labeled “external rotation.” Two time instants are selected: $t_1$ during descent and $t_2$ near reversal of motion. At these instants, the laboratory-reported external hip moments are:\n- At $t_1$: sagittal $+40\\,\\mathrm{N\\cdot m}$ (labeled “extension”), frontal $-30\\,\\mathrm{N\\cdot m}$ (labeled “adduction”), transverse $+15\\,\\mathrm{N\\cdot m}$ (labeled “external rotation”).\n- At $t_2$: sagittal $-20\\,\\mathrm{N\\cdot m}$ (labeled “flexion”), frontal $+25\\,\\mathrm{N\\cdot m}$ (labeled “abduction”), transverse $-10\\,\\mathrm{N\\cdot m}$ (labeled “internal rotation”).\n\nAssume for these instants that hip angular accelerations are sufficiently small that inertial contributions about the hip are negligible relative to the magnitudes reported. Starting from first principles of rotational dynamics, use physically consistent sign conventions to determine how the sign mapping between “external” and “internal” hip moments should be handled, and then re-express the hip moments at $t_1$ and $t_2$ under a single consistent anatomical internal-moment convention in which positive values denote the net internal moment generated by flexors (sagittal), abductors (frontal), and internal rotators (transverse). Based on your mapping, identify which muscle groups are mechanically demanded (dominant) in each plane at $t_1$ and $t_2$ by the sign of the internal moment (positive implying the named agonists, negative implying the antagonists). Choose the option that correctly applies the transformation and interpretation consistently across all planes.\n\nA. Internal hip moments: $t_1$ sagittal $+40\\,\\mathrm{N\\cdot m}$ (flexion), frontal $+30\\,\\mathrm{N\\cdot m}$ (abduction), transverse $+15\\,\\mathrm{N\\cdot m}$ (internal rotation); $t_2$ sagittal $-20\\,\\mathrm{N\\cdot m}$ (flexion), frontal $-25\\,\\mathrm{N\\cdot m}$ (abduction), transverse $-10\\,\\mathrm{N\\cdot m}$ (internal rotation). Dominant demands: at $t_1$ flexors, abductors, and internal rotators; at $t_2$ extensors, adductors, and external rotators, with the largest magnitude at $t_2$ in the frontal plane ($25\\,\\mathrm{N\\cdot m}$ adduction).\n\nB. Internal hip moments: $t_1$ sagittal $-40\\,\\mathrm{N\\cdot m}$ (flexion), frontal $+30\\,\\mathrm{N\\cdot m}$ (abduction), transverse $+15\\,\\mathrm{N\\cdot m}$ (internal rotation); $t_2$ sagittal $+20\\,\\mathrm{N\\cdot m}$ (flexion), frontal $-25\\,\\mathrm{N\\cdot m}$ (abduction), transverse $-10\\,\\mathrm{N\\cdot m}$ (internal rotation). Dominant demands: at $t_1$ extensors in sagittal, abductors and internal rotators in the other planes; at $t_2$ flexors in sagittal, adductors and external rotators in the other planes.\n\nC. Internal hip moments: $t_1$ sagittal $-40\\,\\mathrm{N\\cdot m}$ (extension), frontal $-30\\,\\mathrm{N\\cdot m}$ (adduction), transverse $-15\\,\\mathrm{N\\cdot m}$ (external rotation); $t_2$ sagittal $+20\\,\\mathrm{N\\cdot m}$ (flexion), frontal $+25\\,\\mathrm{N\\cdot m}$ (abduction), transverse $+10\\,\\mathrm{N\\cdot m}$ (internal rotation). Dominant demands: at $t_1$ extensors, adductors, external rotators; at $t_2$ flexors, abductors, internal rotators.\n\nD. Internal hip moments: $t_1$ sagittal $+40\\,\\mathrm{N\\cdot m}$ (flexion), frontal $-30\\,\\mathrm{N\\cdot m}$ (abduction), transverse $-15\\,\\mathrm{N\\cdot m}$ (internal rotation); $t_2$ sagittal $-20\\,\\mathrm{N\\cdot m}$ (flexion), frontal $+25\\,\\mathrm{N\\cdot m}$ (abduction), transverse $+10\\,\\mathrm{N\\cdot m}$ (internal rotation). Dominant demands: at $t_1$ flexors in sagittal but adductors and external rotators in the other planes; at $t_2$ extensors in sagittal but abductors and internal rotators in the other planes.",
            "solution": "The problem statement will first be validated for scientific soundness, consistency, and completeness.\n\n**Step 1: Extract Givens**\n\n*   **System**: A right limb undergoing a task, analyzed using inverse dynamics.\n*   **Quantities of Interest**: Hip joint torque (moment) profiles resolved in three anatomical planes: sagittal (flexion–extension), frontal (abduction–adduction), and transverse (internal–external rotation).\n*   **Definition of \"External Moment\"**: The net hip moment acting on the limb, demanded by the motion and external forces (e.g., ground reaction force). Let this be denoted $M_{ext}$.\n*   **Laboratory's \"External Moment\" Convention**:\n    *   Sagittal plane: A positive number corresponds to an \"extension\" moment.\n    *   Frontal plane: A positive number corresponds to an \"abduction\" moment.\n    *   Transverse plane: A positive number corresponds to an \"external rotation\" moment.\n*   **Data at time $t_1$**:\n    *   Sagittal: $M_{ext} = +40\\,\\mathrm{N\\cdot m}$ (extension)\n    *   Frontal: $M_{ext} = -30\\,\\mathrm{N\\cdot m}$ (adduction)\n    *   Transverse: $M_{ext} = +15\\,\\mathrm{N\\cdot m}$ (external rotation)\n*   **Data at time $t_2$**:\n    *   Sagittal: $M_{ext} = -20\\,\\mathrm{N\\cdot m}$ (flexion)\n    *   Frontal: $M_{ext} = +25\\,\\mathrm{N\\cdot m}$ (abduction)\n    *   Transverse: $M_{ext} = -10\\,\\mathrm{N\\cdot m}$ (internal rotation)\n*   **Simplifying Assumption**: Hip angular accelerations ($\\alpha$) are negligible, thus inertial contributions ($I\\alpha$) are negligible.\n*   **Task**:\n    1.  Determine the mapping from \"external\" moments ($M_{ext}$) to \"internal\" moments ($M_{int}$).\n    2.  Re-express the moments at $t_1$ and $t_2$ using a new, consistent internal-moment convention.\n    3.  Interpret the muscle demand based on the signs of the calculated internal moments.\n*   **Target \"Internal Moment\" Convention**:\n    *   Sagittal plane: Positive value denotes a net internal moment from **flexors**.\n    *   Frontal plane: Positive value denotes a net internal moment from **abductors**.\n    *   Transverse plane: Positive value denotes a net internal moment from **internal rotators**.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is grounded in the established principles of rigid body dynamics and biomechanics, specifically inverse dynamics. The distinction between external moments (acting on a body segment) and internal moments (generated by muscles and ligaments to counteract external moments) is a fundamental concept. The problem provides two distinct, clearly defined sign conventions and asks for a transformation between them, which is a standard procedure in data analysis. The numerical values are physically plausible for human joint moments. The simplifying assumption of negligible angular acceleration is a valid quasi-static approximation often used in biomechanics for specific instances in a movement. The problem is self-contained, unambiguous, and scientifically sound.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. A solution will be derived.\n\n**Derivation of Solution**\n\nThe core of the problem lies in the relationship between the external moment acting on the limb, $M_{ext}$, and the internal moment, $M_{int}$, generated by the body's musculature to control the motion.\n\nFrom first principles, the rotational analogue of Newton's second law for a rigid body (the limb) about a point (the hip joint) is:\n$$ \\sum M = I \\alpha $$\nwhere $\\sum M$ is the sum of all moments, $I$ is the moment of inertia about the axis of rotation, and $\\alpha$ is the angular acceleration.\n\nThe total moment is the sum of the internal moment generated by muscles, $M_{int}$, and the net external moment, $M_{ext}$:\n$$ M_{int} + M_{ext} = I \\alpha $$\nThe problem states to assume that angular accelerations are negligible at the instants $t_1$ and $t_2$. Therefore, the $I\\alpha$ term is approximately zero:\n$$ M_{int} + M_{ext} \\approx 0 $$\nThis leads to the fundamental relationship for this problem:\n$$ M_{int} = -M_{ext} $$\nThis is a vector equation. It signifies that the internal moment must be equal in magnitude and opposite in direction to the external moment. To solve the problem, we must apply this relationship while carefully managing the two different sign conventions.\n\nLet's establish the transformation from the laboratory's external moment values (let's call the reported numbers $L_{sagittal}, L_{frontal}, L_{transverse}$) to the target internal moment values ($M_{int, sag}, M_{int, fro}, M_{int, tra}$).\n\n**Sagittal Plane:**\n*   Lab Convention (External): Positive = Extension.\n*   Target Convention (Internal): Positive = Flexion.\n*   An external extension moment ($L_{sagittal} > 0$) must be counteracted by an internal *flexion* moment. In the target convention, a flexion moment is positive. Thus, the internal moment value is positive. This means the sign change from $M_{int} = -M_{ext}$ is cancelled by the sign change in the convention's definition (Extension vs. Flexion).\n*   Transformation: $M_{int, sag} = L_{sagittal}$.\n\n**Frontal Plane:**\n*   Lab Convention (External): Positive = Abduction.\n*   Target Convention (Internal): Positive = Abduction.\n*   An external abduction moment ($L_{frontal} > 0$) must be counteracted by an internal *adduction* moment. In the target convention, abduction is positive, so an adduction moment must be negative.\n*   Transformation: $M_{int, fro} = -L_{frontal}$.\n\n**Transverse Plane:**\n*   Lab Convention (External): Positive = External Rotation.\n*   Target Convention (Internal): Positive = Internal Rotation.\n*   An external external rotation moment ($L_{transverse} > 0$) must be counteracted by an internal *internal rotation* moment. In the target convention, an internal rotation moment is positive. Similar to the sagittal plane, the two sign changes cancel.\n*   Transformation: $M_{int, tra} = L_{transverse}$.\n\n**Summary of Transformation Rules:**\n*   Sagittal: $M_{int, sag} = L_{sagittal}$\n*   Frontal: $M_{int, fro} = -L_{frontal}$\n*   Transverse: $M_{int, tra} = L_{transverse}$\n\n**Applying the Transformation to the Data**\n\n**At time $t_1$**:\n*   Lab Data: $L_{sagittal}=+40\\,\\mathrm{N\\cdot m}$, $L_{frontal}=-30\\,\\mathrm{N\\cdot m}$, $L_{transverse}=+15\\,\\mathrm{N\\cdot m}$.\n*   Internal Moments (Target Convention):\n    *   Sagittal: $M_{int, sag} = +40\\,\\mathrm{N\\cdot m}$. Positive sign implies a **flexion** moment (dominant demand on **flexors**).\n    *   Frontal: $M_{int, fro} = -(-30) = +30\\,\\mathrm{N\\cdot m}$. Positive sign implies an **abduction** moment (dominant demand on **abductors**).\n    *   Transverse: $M_{int, tra} = +15\\,\\mathrm{N\\cdot m}$. Positive sign implies an **internal rotation** moment (dominant demand on **internal rotators**).\n\n**At time $t_2$**:\n*   Lab Data: $L_{sagittal}=-20\\,\\mathrm{N\\cdot m}$, $L_{frontal}=+25\\,\\mathrm{N\\cdot m}$, $L_{transverse}=-10\\,\\mathrm{N\\cdot m}$.\n*   Internal Moments (Target Convention):\n    *   Sagittal: $M_{int, sag} = -20\\,\\mathrm{N\\cdot m}$. Negative sign implies an **extension** moment (dominant demand on **extensors**).\n    *   Frontal: $M_{int, fro} = -(+25) = -25\\,\\mathrm{N\\cdot m}$. Negative sign implies an **adduction** moment (dominant demand on **adductors**).\n    *   Transverse: $M_{int, tra} = -10\\,\\mathrm{N\\cdot m}$. Negative sign implies an **external rotation** moment (dominant demand on **external rotators**).\n\n**Evaluation of Options**\n\n*   **A. Internal hip moments: $t_1$ sagittal $+40\\,\\mathrm{N\\cdot m}$ (flexion), frontal $+30\\,\\mathrm{N\\cdot m}$ (abduction), transverse $+15\\,\\mathrm{N\\cdot m}$ (internal rotation); $t_2$ sagittal $-20\\,\\mathrm{N\\cdot m}$ (flexion), frontal $-25\\,\\mathrm{N\\cdot m}$ (abduction), transverse $-10\\,\\mathrm{N\\cdot m}$ (internal rotation). Dominant demands: at $t_1$ flexors, abductors, and internal rotators; at $t_2$ extensors, adductors, and external rotators, with the largest magnitude at $t_2$ in the frontal plane ($25\\,\\mathrm{N\\cdot m}$ adduction).**\n    *   The calculated internal moments for $t_1$ ($+40, +30, +15\\,\\mathrm{N\\cdot m}$) and $t_2$ ($-20, -25, -10\\,\\mathrm{N\\cdot m}$) are perfectly matched. The parenthetical labels correctly identify the positive axis of the target convention.\n    *   The interpretation of dominant demands at $t_1$ (flexors, abductors, internal rotators from the positive signs) and at $t_2$ (extensors, adductors, external rotators from the negative signs) is also correct.\n    *   The final statement about the largest magnitude at $t_2$ being $25\\,\\mathrm{N\\cdot m}$ (from $|-25|$) in the frontal plane, corresponding to adduction, is also correct.\n    *   **Verdict: Correct.**\n\n*   **B. Internal hip moments: $t_1$ sagittal $-40\\,\\mathrm{N\\cdot m}$ (flexion), frontal $+30\\,\\mathrm{N\\cdot m}$ (abduction), transverse $+15\\,\\mathrm{N\\cdot m}$ (internal rotation); ...**\n    *   The sagittal moment at $t_1$ is given as $-40\\,\\mathrm{N\\cdot m}$. Our calculation yielded $+40\\,\\mathrm{N\\cdot m}$. This option incorrectly applied a sign flip in the sagittal plane.\n    *   **Verdict: Incorrect.**\n\n*   **C. Internal hip moments: $t_1$ sagittal $-40\\,\\mathrm{N\\cdot m}$ (extension), frontal $-30\\,\\mathrm{N\\cdot m}$ (adduction), transverse $-15\\,\\mathrm{N\\cdot m}$ (external rotation); ...**\n    *   This option seems to have naively flipped the sign of every external moment ($M_{int} = -M_{ext}$) without accounting for the differences in convention definitions. For $t_1$, it reports $(-40, -30, -15)\\,\\mathrm{N\\cdot m}$, whereas our calculation gives $(+40, +30, +15)\\,\\mathrm{N\\cdot m}$. The values for Sagittal and Transverse are incorrect.\n    *   **Verdict: Incorrect.**\n\n*   **D. Internal hip moments: $t_1$ sagittal $+40\\,\\mathrm{N\\cdot m}$ (flexion), frontal $-30\\,\\mathrm{N\\cdot m}$ (abduction), transverse $-15\\,\\mathrm{N\\cdot m}$ (internal rotation); ...**\n    *   The frontal moment at $t_1$ is given as $-30\\,\\mathrm{N\\cdot m}$. Our calculation yielded $+30\\,\\mathrm{N\\cdot m}$. The transverse moment is given as $-15\\,\\mathrm{N\\cdot m}$. Our calculation yielded $+15\\,\\mathrm{N\\cdot m}$. This option uses an incorrect transformation rule for the frontal and transverse planes.\n    *   **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "To create accurate biomechanical models, we must move beyond simple straight-line representations of muscles. This advanced computational exercise guides you through the process of modeling a musculotendon path as it wraps around a spherical obstacle representing the hip joint . By implementing this geometric model, you will use the principle of virtual work—which states that a moment arm, $r$, is the derivative of musculotendon length, $L$, with respect to joint angle, $\\theta$, or $r(\\theta) = \\frac{dL(\\theta)}{d\\theta}$—to explore how moment arms dynamically change with joint position, a cornerstone concept in sophisticated musculoskeletal simulations.",
            "id": "4178199",
            "problem": "A single-degree-of-freedom hip joint is modeled as a perfect spherical joint with a spherical obstacle representing either the acetabular rim or the femoral head. A musculotendon path connects a fixed origin on the pelvis to a fixed insertion on the femur, which undergoes rigid-body rotation about the hip joint center. When the straight-line segment between the origin and the rotated insertion point would penetrate the spherical obstacle, the path wraps: it follows a straight segment from the origin to a tangent point on the sphere, a spherical geodesic arc on the obstacle surface between two tangent points, and a straight segment from the second tangent point to the insertion. When no penetration occurs, the path is the straight-line segment.\n\nUse the following foundational bases:\n- Newton’s laws of motion and the definition of work as force times displacement. Employ the principle of virtual work that relates the moment generated by a musculotendon to the derivative of musculotendon length with respect to the generalized coordinate.\n- Rigid-body kinematics: rotation of a point about a fixed axis is described by a rotation matrix.\n- Euclidean geometry: the minimal path avoiding a convex spherical obstacle lies in the plane spanned by the joint center and the two endpoints; tangent segments from an external point to a circle in that plane have equal lengths, and the geodesic on the sphere between tangent points projects to a circular arc within that plane.\n\nPrecisely define the geometry:\n- The hip joint center is at the origin, $\\mathbf{O} = (0,0,0)$ in meters.\n- The spherical obstacle has radius $R = 0.026$ meters centered at $\\mathbf{O}$.\n- The pelvis coordinate axes are orthonormal with $x$ anterior, $y$ superior, and $z$ lateral.\n- Hip flexion–extension is modeled as a pure rotation about the $y$-axis by angle $\\theta$ (in radians). The femoral insertion position in pelvis coordinates is $\\mathbf{p}_2(\\theta) = R_y(\\theta)\\,\\mathbf{p}_{2,b}$, where $\\mathbf{p}_{2,b}$ is the insertion point expressed in the femur local frame and\n$$\nR_y(\\theta) =\n\\begin{bmatrix}\n\\cos\\theta & 0 & \\sin\\theta \\\\\n0 & 1 & 0 \\\\\n-\\sin\\theta & 0 & \\cos\\theta\n\\end{bmatrix}.\n$$\n\nPath specification and computation requirements:\n- The straight segment $\\overline{\\mathbf{p}_1\\mathbf{p}_2(\\theta)}$ must be checked for intersection with the sphere of radius $R$. Intersection occurs if the minimal distance from $\\mathbf{O}$ to the segment is strictly less than $R$.\n- If intersection occurs (wrap case), construct the wrapped path within the plane spanned by $\\mathbf{O}$, $\\mathbf{p}_1$, and $\\mathbf{p}_2(\\theta)$. In that plane, treat the sphere as a circle of radius $R$. From $\\mathbf{p}_1$ and $\\mathbf{p}_2(\\theta)$, determine the two possible tangent directions to the circle for each external point and select the pair of tangent points that results in the minimal total path length, which is the sum of the two tangent segment lengths and the circle arc length connecting the tangent points. The tangent segment length from an external point at distance $d$ from the origin equals $\\sqrt{d^2 - R^2}$, and the arc length is $R$ times the minimal angular separation between the chosen tangent directions. Ensure the chosen arc is the shorter arc on the circle.\n- If no intersection occurs (no-wrap case), the path length is simply the Euclidean norm $\\|\\mathbf{p}_2(\\theta) - \\mathbf{p}_1\\|$.\n\nMoment arm specification:\n- Using first principles, relate the musculotendon moment about the hip flexion–extension axis to the change in musculotendon length under an infinitesimal rotation. You must compute the moment arm $r(\\theta)$ as the derivative of the musculotendon length $L(\\theta)$ with respect to $\\theta$ (in radians). Express the moment arm in meters. You may approximate the derivative numerically using a symmetric finite difference with a sufficiently small step in $\\theta$ to ensure accuracy and stability.\n\nUnits and outputs:\n- Express all musculotendon lengths in meters and moment arms in meters. Use angles in radians.\n- For numerical derivative, select a small step size $\\delta\\theta$ in radians. Use a symmetric difference formula to compute $r(\\theta)$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[L_1,r_1,L_2,r_2,\\dots]$ for the test suite below. Each floating-point number must be rounded to six decimal places.\n\nTest suite:\nFor each case, the origin $\\mathbf{p}_1$ and base insertion $\\mathbf{p}_{2,b}$ are given; compute $L(\\theta)$ and $r(\\theta)$ at the specified $\\theta$.\n\n- Case 1 (happy path, likely wrap for a lateral muscle at neutral):\n  - $\\mathbf{p}_1 = (-0.010,\\,0.080,\\,0.050)$ m\n  - $\\mathbf{p}_{2,b} = (0.005,\\,0.000,\\,0.040)$ m\n  - $\\theta = 0.0$ radians\n- Case 2 (variation in angle for the same muscle, increased flexion):\n  - $\\mathbf{p}_1 = (-0.010,\\,0.080,\\,0.050)$ m\n  - $\\mathbf{p}_{2,b} = (0.005,\\,0.000,\\,0.040)$ m\n  - $\\theta = 0.7$ radians\n- Case 3 (anterior muscle under extension, testing geometry on the anterior side):\n  - $\\mathbf{p}_1 = (0.030,\\,0.080,\\,-0.010)$ m\n  - $\\mathbf{p}_{2,b} = (0.010,\\,-0.010,\\,-0.030)$ m\n  - $\\theta = -0.5$ radians\n- Case 4 (boundary condition: straight line tangent to the sphere at neutral):\n  - $\\mathbf{p}_1 = (-0.100,\\,0.000,\\,R)$ m with $R = 0.026$ m\n  - $\\mathbf{p}_{2,b} = (0.100,\\,0.000,\\,R)$ m with $R = 0.026$ m\n  - $\\theta = 0.0$ radians\n- Case 5 (no-wrap case with a more medial–posterior line-of-sight):\n  - $\\mathbf{p}_1 = (0.010,\\,0.070,\\,-0.080)$ m\n  - $\\mathbf{p}_{2,b} = (0.020,\\,-0.020,\\,-0.060)$ m\n  - $\\theta = -0.3$ radians\n\nYour program must implement the geometry and kinematics described above, compute $L(\\theta)$ and $r(\\theta)$ for each case, and output a single line with the ten numbers $[L_1,r_1,L_2,r_2,L_3,r_3,L_4,r_4,L_5,r_5]$, rounded to six decimal places.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of biomechanics, kinematics, and Euclidean geometry. It is well-posed, with all necessary parameters and conditions defined, allowing for a unique and stable solution. The problem is objective, complete, and its components are internally consistent and physically plausible within the context of a simplified biomechanical model.\n\nThe solution is to compute the musculotendon length $L(\\theta)$ and its corresponding moment arm $r(\\theta)$ for a simplified hip joint model. The process involves determining the path of a musculotendon, which may either be a straight line or wrap around a spherical obstacle representing the joint. The moment arm is then calculated as the derivative of the path length with respect to the joint angle.\n\nThe core of the computation is a function that calculates the musculotendon length $L$ for a given joint angle $\\theta$. This function takes as input the muscle origin point $\\mathbf{p}_1$, the insertion point in the bone's local frame $\\mathbf{p}_{2,b}$, the joint angle $\\theta$, and the obstacle radius $R$.\n\n1.  **Rigid-Body Kinematics**:\n    The position of the muscle insertion on the femur, $\\mathbf{p}_2(\\theta)$, is found by rotating its position in the local femoral frame, $\\mathbf{p}_{2,b}$, about the flexion-extension axis (the $y$-axis) by the angle $\\theta$. The origin of the joint is at $\\mathbf{O} = (0,0,0)$. The transformation is given by:\n    $$\n    \\mathbf{p}_2(\\theta) = R_y(\\theta)\\,\\mathbf{p}_{2,b}\n    $$\n    where $R_y(\\theta)$ is the rotation matrix about the $y$-axis:\n    $$\n    R_y(\\theta) =\n    \\begin{bmatrix}\n    \\cos\\theta & 0 & \\sin\\theta \\\\\n    0 & 1 & 0 \\\\\n    -\\sin\\theta & 0 & \\cos\\theta\n    \\end{bmatrix}\n    $$\n\n2.  **Path Type Determination (Wrap vs. No-Wrap)**:\n    The path of the musculotendon is the shortest possible line between $\\mathbf{p}_1$ and $\\mathbf{p}_2(\\theta)$ that does not penetrate the spherical obstacle of radius $R$ centered at the origin. Both $\\mathbf{p}_1$ and $\\mathbf{p}_2(\\theta)$ are assumed to be outside the sphere, i.e., $\\|\\mathbf{p}_1\\| > R$ and $\\|\\mathbf{p}_2(\\theta)\\| > R$. The wrapping condition is determined by analyzing the geometry in the plane spanned by $\\mathbf{O}$, $\\mathbf{p}_1$, and $\\mathbf{p}_2(\\theta)$.\n\n    Let $d_1 = \\|\\mathbf{p}_1\\|$ and $d_2 = \\|\\mathbf{p}_2(\\theta)\\|$ be the distances of the origin and insertion points from the joint center. Let $\\alpha$ be the angle between the vectors $\\mathbf{p}_1$ and $\\mathbf{p}_2(\\theta)$, which is calculated as:\n    $$\n    \\alpha = \\arccos\\left(\\frac{\\mathbf{p}_1 \\cdot \\mathbf{p}_2(\\theta)}{d_1 d_2}\\right)\n    $$\n    The path wraps around the sphere if the straight line segment between $\\mathbf{p}_1$ and $\\mathbf{p}_2(\\theta)$ would intersect it. This condition is geometrically equivalent to the angle $\\alpha$ being greater than the sum of the angles formed by the tangent lines from each point to the sphere. Let these tangent angles be $\\beta_1$ and $\\beta_2$, given by:\n    $$\n    \\beta_1 = \\arccos\\left(\\frac{R}{d_1}\\right) \\quad \\text{and} \\quad \\beta_2 = \\arccos\\left(\\frac{R}{d_2}\\right)\n    $$\n    Wrapping occurs if and only if $\\alpha > \\beta_1 + \\beta_2$.\n\n3.  **Path Length Calculation, $L(\\theta)$**:\n    -   **No-Wrap Case**: If $\\alpha \\le \\beta_1 + \\beta_2$, the path is a straight line segment. Its length is the Euclidean distance between the points:\n        $$\n        L(\\theta) = \\|\\mathbf{p}_2(\\theta) - \\mathbf{p}_1\\|\n        $$\n    -   **Wrap Case**: If $\\alpha > \\beta_1 + \\beta_2$, the path consists of two straight segments tangent to the sphere and a geodesic arc on the sphere's surface connecting the two tangent points.\n        The length of the tangent segment from $\\mathbf{p}_1$ is $L_{t1} = \\sqrt{d_1^2 - R^2}$.\n        The length of the tangent segment from $\\mathbf{p}_2(\\theta)$ is $L_{t2} = \\sqrt{d_2^2 - R^2}$.\n        The angle of the wrapping arc, $\\gamma$, is the total angle minus the tangent angles: $\\gamma = \\alpha - (\\beta_1 + \\beta_2)$.\n        The length of the arc is $L_{arc} = R \\gamma$.\n        The total path length is the sum of these three components:\n        $$\n        L(\\theta) = L_{t1} + L_{t2} + L_{arc} = \\sqrt{d_1^2 - R^2} + \\sqrt{d_2^2 - R^2} + R\\left( \\arccos\\left(\\frac{\\mathbf{p}_1 \\cdot \\mathbf{p}_2(\\theta)}{d_1 d_2}\\right) - \\arccos\\left(\\frac{R}{d_1}\\right) - \\arccos\\left(\\frac{R}{d_2}\\right) \\right)\n        $$\n\n4.  **Moment Arm Calculation, $r(\\theta)$**:\n    The moment arm $r(\\theta)$ is defined by the principle of virtual work as the derivative of the musculotendon length with respect to the generalized coordinate $\\theta$:\n    $$\n    r(\\theta) = \\frac{dL(\\theta)}{d\\theta}\n    $$\n    This derivative is approximated numerically using a second-order accurate symmetric finite difference formula with a small step size $\\delta\\theta$:\n    $$\n    r(\\theta) \\approx \\frac{L(\\theta + \\delta\\theta) - L(\\theta - \\delta\\theta)}{2 \\delta\\theta}\n    $$\n    A sufficiently small step size, such as $\\delta\\theta = 10^{-7}$ radians, is chosen to ensure numerical accuracy and stability.\n\nFor each test case, the above steps are carried out. First, $L(\\theta)$ is computed for the specified angle $\\theta$. Then, the length function is evaluated at $\\theta + \\delta\\theta$ and $\\theta - \\delta\\theta$ to compute the moment arm $r(\\theta)$. The results are then collected and formatted as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the hip joint biomechanics problem for a suite of test cases.\n    \"\"\"\n    # Global constants defined in the problem\n    R = 0.026  # meters\n    DELTA_THETA = 1e-7  # radians, for finite difference\n\n    def get_rotation_matrix_y(theta):\n        \"\"\"\n        Computes the rotation matrix for a rotation about the y-axis.\n        \"\"\"\n        c, s = np.cos(theta), np.sin(theta)\n        return np.array([\n            [c, 0, s],\n            [0, 1, 0],\n            [-s, 0, c]\n        ], dtype=np.float64)\n\n    def compute_length(theta, p1, p2_b):\n        \"\"\"\n        Calculates the musculotendon path length for a given angle theta.\n\n        The function determines whether the path is a straight line or if it\n        wraps around the spherical obstacle, and computes the length accordingly.\n\n        Args:\n            theta (float): The joint angle in radians.\n            p1 (np.ndarray): The 3D vector of the muscle origin.\n            p2_b (np.ndarray): The 3D vector of the muscle insertion in the\n                               femur's local frame.\n\n        Returns:\n            float: The calculated musculotendon path length in meters.\n        \"\"\"\n        # Step 1: Calculate the rotated insertion point p2\n        rot_matrix = get_rotation_matrix_y(theta)\n        p2 = rot_matrix @ p2_b\n\n        # Step 2: Determine if wrapping occurs\n        d1 = np.linalg.norm(p1)\n        d2 = np.linalg.norm(p2)\n\n        # The problem setup ensures endpoints are outside the sphere.\n        # If an endpoint were inside or on the sphere, wrapping is ill-defined\n        # or defaults to straight line. We check just in case.\n        if d1 <= R or d2 <= R:\n            return np.linalg.norm(p2 - p1)\n\n        # Calculate angle alpha between p1 and p2 vectors from origin\n        dot_p1_p2 = np.dot(p1, p2)\n        # Clip for numerical stability of arccos\n        cos_alpha = np.clip(dot_p1_p2 / (d1 * d2), -1.0, 1.0)\n        alpha = np.arccos(cos_alpha)\n\n        # Calculate tangent angles beta1 and beta2\n        beta1 = np.arccos(np.clip(R / d1, -1.0, 1.0))\n        beta2 = np.arccos(np.clip(R / d2, -1.0, 1.0))\n\n        # Step 3: Calculate path length based on wrapping condition\n        if alpha > (beta1 + beta2):\n            # Wrap Case: path is tangent-arc-tangent\n            len_tangent1 = np.sqrt(d1**2 - R**2)\n            len_tangent2 = np.sqrt(d2**2 - R**2)\n            \n            arc_angle_gamma = alpha - beta1 - beta2\n            len_arc = R * arc_angle_gamma\n            \n            return len_tangent1 + len_tangent2 + len_arc\n        else:\n            # No-Wrap Case: path is a straight line\n            return np.linalg.norm(p2 - p1)\n\n    # Test suite provided in the problem statement\n    test_cases = [\n        # Case 1\n        {'p1': np.array([-0.010, 0.080, 0.050]), 'p2_b': np.array([0.005, 0.000, 0.040]), 'theta': 0.0},\n        # Case 2\n        {'p1': np.array([-0.010, 0.080, 0.050]), 'p2_b': np.array([0.005, 0.000, 0.040]), 'theta': 0.7},\n        # Case 3\n        {'p1': np.array([0.030, 0.080, -0.010]), 'p2_b': np.array([0.010, -0.010, -0.030]), 'theta': -0.5},\n        # Case 4\n        {'p1': np.array([-0.100, 0.000, R]), 'p2_b': np.array([0.100, 0.000, R]), 'theta': 0.0},\n        # Case 5\n        {'p1': np.array([0.010, 0.070, -0.080]), 'p2_b': np.array([0.020, -0.020, -0.060]), 'theta': -0.3}\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        p1 = case['p1']\n        p2_b = case['p2_b']\n        theta = case['theta']\n        \n        # Calculate musculotendon length L(theta)\n        L_theta = compute_length(theta, p1, p2_b)\n        \n        # Calculate L(theta + d_theta) and L(theta - d_theta) for finite difference\n        L_plus = compute_length(theta + DELTA_THETA, p1, p2_b)\n        L_minus = compute_length(theta - DELTA_THETA, p1, p2_b)\n        \n        # Calculate moment arm r(theta) using symmetric finite difference\n        r_theta = (L_plus - L_minus) / (2 * DELTA_THETA)\n        \n        all_results.append(L_theta)\n        all_results.append(r_theta)\n        \n    # Format the final output string as required, with rounding to six decimal places.\n    formatted_results = [f\"{val:.6f}\" for val in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}