{
    "hands_on_practices": [
        {
            "introduction": "生物力学的一项核心技能是确定单块肌肉的力如何对关节处的净力矩产生贡献。本练习将通过一个具体实例，运用矢量代数计算肌肉产生的力矩，并利用力矩平衡原理推断拮抗肌群的作用。这项实践对于理解和解释逆动力学（Inverse Dynamics）的计算结果至关重要 ()。",
            "id": "4178161",
            "problem": "在步态的站立末期对一名受试者进行分析。考虑以髋关节中心为原点的骨盆段坐标系。骨盆坐标轴定义如下：$x$轴指向前方，$y$轴指向上方，$z$轴指向受试者的右侧（内外侧轴）。力矩采用右手定则，并将沿$+z$轴产生髋关节伸展的分量定义为正的髋关节屈伸力矩。\n\n在某一特定瞬间，测得一块髋后部伸肌在骨盆坐标系中的肌肉力向量分量为 $\\mathbf{F} = (-1500, 600, -400)$ N。测得从髋关节中心到该肌肉作用线上一点的位置向量为 $\\mathbf{r} = (-0.03, 0.05, 0.04)$ m。此时，通过逆动力学（ID）计算得出的、在骨盆坐标系中绕$+z$轴分解的净髋关节屈伸力矩为$+50$ N·m（正值为伸展）。\n\n仅从牛顿定律（包括内力通过其作用线绕参考点产生力矩）和绕轴力矩的定义出发，完成以下任务：\n\n1. 推导在指定瞬间该肌肉对绕$+z$轴的髋关节屈伸力矩的贡献。\n2. 使用绕$+z$轴的力矩平衡，确定为使总屈伸力矩等于该瞬间的净ID力矩，其他结构必须产生的拮抗屈曲力矩的大小。\n\n以N·m为单位表示所需的拮抗屈曲力矩大小。将最终答案四舍五入至四位有效数字。",
            "solution": "该问题要求使用静力平衡原理计算肌肉的力矩贡献以及随后的拮抗力矩。解题过程从力的力矩的基本定义开始。\n\n根据牛顿定律，作用于由相对于参考点的位置向量 $\\mathbf{r}$ 定义的一点上的力 $\\mathbf{F}$，会围绕该参考点产生一个力矩 $\\mathbf{M}$。该力矩向量由位置向量和力向量的叉乘定义：\n$$ \\mathbf{M} = \\mathbf{r} \\times \\mathbf{F} $$\n该问题设定在一个右手笛卡尔坐标系中，其基向量 $\\{\\mathbf{i}, \\mathbf{j}, \\mathbf{k}\\}$ 对应于 $\\{x, y, z\\}$ 轴（前、上、右）。向量 $\\mathbf{r}$ 和 $\\mathbf{F}$ 以分量形式给出：\n$$ \\mathbf{r} = r_x \\mathbf{i} + r_y \\mathbf{j} + r_z \\mathbf{k} $$\n$$ \\mathbf{F} = F_x \\mathbf{i} + F_y \\mathbf{j} + F_z \\mathbf{k} $$\n叉乘可以展开以求出力矩向量 $\\mathbf{M} = M_x \\mathbf{i} + M_y \\mathbf{j} + M_z \\mathbf{k}$ 的分量：\n$$ \\mathbf{M} = (r_y F_z - r_z F_y)\\mathbf{i} + (r_z F_x - r_x F_z)\\mathbf{j} + (r_x F_y - r_y F_x)\\mathbf{k} $$\n因此，绕$z$轴的力矩分量（在本问题的约定中对应于髋关节屈伸力矩）为：\n$$ M_z = r_x F_y - r_y F_x $$\n\n**第一部分：推导该肌肉对髋关节屈伸力矩的贡献。**\n\n问题提供了以下数据：\n髋后部伸肌的力向量为 $\\mathbf{F} = (-1500, 600, -400) \\, \\text{N}$。其分量为：\n$F_x = -1500 \\, \\text{N}$\n$F_y = 600 \\, \\text{N}$\n$F_z = -400 \\, \\text{N}$\n\n从髋关节中心到肌肉作用线的位置向量为 $\\mathbf{r} = (-0.03, 0.05, 0.04) \\, \\text{m}$。其分量为：\n$r_x = -0.03 \\, \\text{m}$\n$r_y = 0.05 \\, \\text{m}$\n$r_z = 0.04 \\, \\text{m}$\n\n该肌肉绕$z$轴的力矩贡献，记为 $M_{musc, z}$，使用 $M_z$ 的公式计算：\n$$ M_{musc, z} = r_x F_y - r_y F_x $$\n代入数值：\n$$ M_{musc, z} = (-0.03 \\, \\text{m}) \\times (600 \\, \\text{N}) - (0.05 \\, \\text{m}) \\times (-1500 \\, \\text{N}) $$\n$$ M_{musc, z} = -18 \\, \\text{N·m} - (-75 \\, \\text{N·m}) $$\n$$ M_{musc, z} = -18 \\, \\text{N·m} + 75 \\, \\text{N·m} $$\n$$ M_{musc, z} = 57 \\, \\text{N·m} $$\n问题定义绕$+z$轴的正力矩产生髋关节伸展。计算出的力矩 $M_{musc, z}$ 为正值，表明该肌肉产生一个大小为 $57 \\, \\text{N·m}$ 的伸展力矩。\n\n**第二部分：确定拮抗屈曲力矩的大小。**\n\n力矩平衡原理指出，绕某一轴的净力矩是绕同一轴的所有单个力矩贡献的代数和。净髋关节屈伸力矩 $M_{net, z}$ 是指定伸肌产生的力矩 $M_{musc, z}$ 与所有其他结构产生的力矩（被描述为拮抗屈曲力矩 $M_{antag, z}$）之和。\n平衡方程为：\n$$ M_{net, z} = M_{musc, z} + M_{antag, z} $$\n问题提供了通过逆动力学（ID）分析得出的净力矩：\n$$ M_{net, z} = +50 \\, \\text{N·m} $$\n正号表示一个净伸展力矩。我们现在可以求解拮抗力矩分量 $M_{antag, z}$：\n$$ M_{antag, z} = M_{net, z} - M_{musc, z} $$\n代入 $M_{net, z}$ 的已知值和 $M_{musc, z}$ 的计算值：\n$$ M_{antag, z} = 50 \\, \\text{N·m} - 57 \\, \\text{N·m} $$\n$$ M_{antag, z} = -7 \\, \\text{N·m} $$\n$M_{antag, z}$ 的负号表明该力矩的作用方向与伸展相反，即屈曲方向，这与已建立的约定一致。这证实了其“拮抗屈曲力矩”的描述。问题要求的是该力矩的*大小*，即 $M_{antag, z}$ 的绝对值：\n$$ |M_{antag, z}| = |-7 \\, \\text{N·m}| = 7 \\, \\text{N·m} $$\n问题要求将最终答案四舍五入至四位有效数字。将 $7$ 表示为四位有效数字即为 $7.000$。\n因此，所需的拮抗屈曲力矩的大小为 $7.000 \\, \\text{N·m}$。",
            "answer": "$$\n\\boxed{7.000}\n$$"
        },
        {
            "introduction": "在关节力矩概念的基础上，我们进一步探讨肌肉产生力矩的能力并非恒定，而是随关节角度变化。本练习要求建立一个考虑骨骼几何约束的肌腱路径计算模型，模拟其“包裹”关节的现象 ()。然后，你将运用虚功原理，通过计算肌肉长度对关节角度的导数来确定力臂，这是高级肌肉骨骼建模的基石。",
            "id": "4178199",
            "problem": "一个单自由度髋关节被建模为一个理想的球形关节，带有一个球形障碍物，该障碍物代表髋臼缘或股骨头。一条肌腱路径连接骨盆上的一个固定起点和股骨上的一个固定附着点，股骨围绕髋关节中心进行刚体旋转。当起点和旋转后的附着点之间的直线段穿透球形障碍物时，该路径会发生缠绕：它沿着从起点到球体上一个切点的直线段，再沿着障碍物表面上两个切点之间的一段球面测地线弧，最后是从第二个切点到附着点的另一条直线段。当没有穿透发生时，该路径就是一条直线段。\n\n使用以下基本原理：\n- 牛顿运动定律以及功作为力乘以位移的定义。运用虚功原理，该原理将肌腱产生的力矩与肌腱长度相对于广义坐标的导数联系起来。\n- 刚体运动学：一个点围绕固定轴的旋转由一个旋转矩阵描述。\n- 欧几里得几何：避开凸球形障碍物的最短路径位于由关节中心和两个端点张成的平面内；在该平面内，从外部点到圆的切线段长度相等，并且球面上切点之间的测地线在该平面内投影为一段圆弧。\n\n精确定义几何形状：\n- 髋关节中心位于原点，$\\mathbf{O} = (0,0,0)$，单位为米。\n- 球形障碍物的半径为 $R = 0.026$ 米，中心位于 $\\mathbf{O}$。\n- 骨盆坐标轴是标准正交的，$x$轴指向前，$y$轴指向上，$z$轴指向外侧。\n- 髋关节屈伸被建模为围绕$y$轴的纯旋转，角度为 $\\theta$（以弧度为单位）。股骨附着点在骨盆坐标系中的位置是 $\\mathbf{p}_2(\\theta) = R_y(\\theta)\\,\\mathbf{p}_{2,b}$，其中 $\\mathbf{p}_{2,b}$ 是在股骨局部坐标系中表示的附着点，且\n$$\nR_y(\\theta) =\n\\begin{bmatrix}\n\\cos\\theta  0  \\sin\\theta \\\\\n0  1  0 \\\\\n-\\sin\\theta  0  \\cos\\theta\n\\end{bmatrix}.\n$$\n\n路径规范和计算要求：\n- 必须检查直线段 $\\overline{\\mathbf{p}_1\\mathbf{p}_2(\\theta)}$ 是否与半径为 $R$ 的球体相交。如果从 $\\mathbf{O}$ 到该线段的最小距离严格小于 $R$，则发生相交。\n- 如果发生相交（缠绕情况），则在由 $\\mathbf{O}$、$\\mathbf{p}_1$ 和 $\\mathbf{p}_2(\\theta)$ 张成的平面内构建缠绕路径。在该平面内，将球体视为半径为 $R$ 的圆。从 $\\mathbf{p}_1$ 和 $\\mathbf{p}_2(\\theta)$ 出发，确定每个外部点到圆的两种可能的切线方向，并选择能得到最小总路径长度的那对切点。总路径长度是两个切线段长度与连接切点的圆弧长度之和。从距离原点为 $d$ 的外部点出发的切线段长度等于 $\\sqrt{d^2 - R^2}$，弧长是 $R$ 乘以所选切线方向之间的最小角分离。确保所选的弧是圆上较短的弧。\n- 如果没有发生相交（非缠绕情况），路径长度就是欧几里得范数 $\\|\\mathbf{p}_2(\\theta) - \\mathbf{p}_1\\|$。\n\n力臂规范：\n- 使用第一性原理，将肌腱围绕髋关节屈伸轴的力矩与在无穷小旋转下肌腱长度的变化联系起来。您必须计算力臂 $r(\\theta)$，即肌腱长度 $L(\\theta)$ 相对于 $\\theta$（以弧度为单位）的导数。力臂以米为单位表示。您可以使用对称有限差分法，并选择一个足够小的 $\\theta$ 步长进行数值逼近，以确保准确性和稳定性。\n\n单位和输出：\n- 所有肌腱长度以米表示，力臂以米表示。角度使用弧度。\n- 对于数值求导，选择一个小的步长 $\\delta\\theta$（以弧度为单位）。使用对称差分公式计算 $r(\\theta)$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，顺序为 $[L_1,r_1,L_2,r_2,\\dots]$，对应下面的测试套件。每个浮点数必须四舍五入到六位小数。\n\n测试套件：\n对于每种情况，给定起点 $\\mathbf{p}_1$ 和基础附着点 $\\mathbf{p}_{2,b}$；在指定的 $\\theta$ 处计算 $L(\\theta)$ 和 $r(\\theta)$。\n\n- 情况1（典型路径，外侧肌肉在中立位可能发生缠绕）：\n  - $\\mathbf{p}_1 = (-0.010,\\,0.080,\\,0.050)$ 米\n  - $\\mathbf{p}_{2,b} = (0.005,\\,0.000,\\,0.040)$ 米\n  - $\\theta = 0.0$ 弧度\n- 情况2（同一肌肉的角度变化，屈曲增加）：\n  - $\\mathbf{p}_1 = (-0.010,\\,0.080,\\,0.050)$ 米\n  - $\\mathbf{p}_{2,b} = (0.005,\\,0.000,\\,0.040)$ 米\n  - $\\theta = 0.7$ 弧度\n- 情况3（前侧肌肉在伸展状态下，测试前侧的几何形状）：\n  - $\\mathbf{p}_1 = (0.030,\\,0.080,\\,-0.010)$ 米\n  - $\\mathbf{p}_{2,b} = (0.010,\\,-0.010,\\,-0.030)$ 米\n  - $\\theta = -0.5$ 弧度\n- 情况4（边界条件：直线在中立位与球体相切）：\n  - $\\mathbf{p}_1 = (-0.100,\\,0.000,\\,R)$ 米，其中 $R = 0.026$ 米\n  - $\\mathbf{p}_{2,b} = (0.100,\\,0.000,\\,R)$ 米，其中 $R = 0.026$ 米\n  - $\\theta = 0.0$ 弧度\n- 情况5（非缠绕情况，具有更靠内侧-后侧的直线路径）：\n  - $\\mathbf{p}_1 = (0.010,\\,0.070,\\,-0.080)$ 米\n  - $\\mathbf{p}_{2,b} = (0.020,\\,-0.020,\\,-0.060)$ 米\n  - $\\theta = -0.3$ 弧度\n\n您的程序必须实现上述几何和运动学描述，为每种情况计算 $L(\\theta)$ 和 $r(\\theta)$，并输出一行包含十个数字 $[L_1,r_1,L_2,r_2,L_3,r_3,L_4,r_4,L_5,r_5]$ 的结果，四舍五入到六位小数。",
            "solution": "该问题被认为是有效的，因为它在科学上基于生物力学、运动学和欧几里得几何的原理。它的设定是适定的（well-posed），所有必要的参数和条件都已定义，从而可以得到唯一且稳定的解。该问题是客观、完整的，其组成部分在一个简化的生物力学模型背景下是内部一致且物理上合理的。\n\n解决方案是为一个简化的髋关节模型计算肌腱长度 $L(\\theta)$ 及其对应的力臂 $r(\\theta)$。该过程涉及确定肌腱的路径，该路径可能是一条直线，也可能缠绕代表关节的球形障碍物。然后，力臂被计算为路径长度相对于关节角度的导数。\n\n计算的核心是一个函数，该函数为给定的关节角度 $\\theta$ 计算肌腱长度 $L$。此函数接收肌肉起点 $\\mathbf{p}_1$、骨骼局部坐标系中的附着点 $\\mathbf{p}_{2,b}$、关节角度 $\\theta$ 和障碍物半径 $R$ 作为输入。\n\n1.  **刚体运动学**：\n    股骨上肌肉附着点的位置 $\\mathbf{p}_2(\\theta)$ 是通过将其在股骨局部坐标系中的位置 $\\mathbf{p}_{2,b}$ 围绕屈伸轴（$y$轴）旋转角度 $\\theta$ 得到的。关节的原点位于 $\\mathbf{O} = (0,0,0)$。变换由以下公式给出：\n    $$\n    \\mathbf{p}_2(\\theta) = R_y(\\theta)\\,\\mathbf{p}_{2,b}\n    $$\n    其中 $R_y(\\theta)$ 是围绕$y$轴的旋转矩阵：\n    $$\n    R_y(\\theta) =\n    \\begin{bmatrix}\n    \\cos\\theta  0  \\sin\\theta \\\\\n    0  1  0 \\\\\n    -\\sin\\theta  0  \\cos\\theta\n    \\end{bmatrix}\n    $$\n\n2.  **路径类型确定（缠绕 vs. 非缠绕）**：\n    肌腱的路径是 $\\mathbf{p}_1$ 和 $\\mathbf{p}_2(\\theta)$ 之间不穿透以原点为中心、半径为 $R$ 的球形障碍物的最短可能路径。假定 $\\mathbf{p}_1$ 和 $\\mathbf{p}_2(\\theta)$ 都在球体外部，即 $\\|\\mathbf{p}_1\\| > R$ 和 $\\|\\mathbf{p}_2(\\theta)\\| > R$。缠绕条件通过分析由 $\\mathbf{O}$、$\\mathbf{p}_1$ 和 $\\mathbf{p}_2(\\theta)$ 张成的平面内的几何形状来确定。\n\n    令 $d_1 = \\|\\mathbf{p}_1\\|$ 和 $d_2 = \\|\\mathbf{p}_2(\\theta)\\|$ 为起点和附着点到关节中心的距离。令 $\\alpha$ 为向量 $\\mathbf{p}_1$ 和 $\\mathbf{p}_2(\\theta)$ 之间的夹角，计算如下：\n    $$\n    \\alpha = \\arccos\\left(\\frac{\\mathbf{p}_1 \\cdot \\mathbf{p}_2(\\theta)}{d_1 d_2}\\right)\n    $$\n    如果 $\\mathbf{p}_1$ 和 $\\mathbf{p}_2(\\theta)$ 之间的直线段会与球体相交，则路径会缠绕球体。这个条件在几何上等价于角度 $\\alpha$ 大于从每个点到球体的切线所形成的角度之和。设这些切线角为 $\\beta_1$ 和 $\\beta_2$，由以下公式给出：\n    $$\n    \\beta_1 = \\arccos\\left(\\frac{R}{d_1}\\right) \\quad \\text{和} \\quad \\beta_2 = \\arccos\\left(\\frac{R}{d_2}\\right)\n    $$\n    当且仅当 $\\alpha > \\beta_1 + \\beta_2$ 时，发生缠绕。\n\n3.  **路径长度计算, $L(\\theta)$**：\n    -   **非缠绕情况**：如果 $\\alpha \\le \\beta_1 + \\beta_2$，路径是一条直线段。其长度是两点之间的欧几里得距离：\n        $$\n        L(\\theta) = \\|\\mathbf{p}_2(\\theta) - \\mathbf{p}_1\\|\n        $$\n    -   **缠绕情况**：如果 $\\alpha > \\beta_1 + \\beta_2$，路径由两条与球体相切的直线段和连接两个切点的球体表面上的一段测地线弧组成。\n        从 $\\mathbf{p}_1$ 出发的切线段长度为 $L_{t1} = \\sqrt{d_1^2 - R^2}$。\n        从 $\\mathbf{p}_2(\\theta)$ 出发的切线段长度为 $L_{t2} = \\sqrt{d_2^2 - R^2}$。\n        缠绕弧的角度 $\\gamma$ 是总角度减去切线角：$\\gamma = \\alpha - (\\beta_1 + \\beta_2)$。\n        弧的长度为 $L_{arc} = R \\gamma$。\n        总路径长度是这三部分之和：\n        $$\n        L(\\theta) = L_{t1} + L_{t2} + L_{arc} = \\sqrt{d_1^2 - R^2} + \\sqrt{d_2^2 - R^2} + R\\left( \\arccos\\left(\\frac{\\mathbf{p}_1 \\cdot \\mathbf{p}_2(\\theta)}{d_1 d_2}\\right) - \\arccos\\left(\\frac{R}{d_1}\\right) - \\arccos\\left(\\frac{R}{d_2}\\right) \\right)\n        $$\n\n4.  **力臂计算, $r(\\theta)$**：\n    力臂 $r(\\theta)$ 根据虚功原理定义为肌腱长度相对于广义坐标 $\\theta$ 的导数：\n    $$\n    r(\\theta) = \\frac{dL(\\theta)}{d\\theta}\n    $$\n    该导数使用二阶精度的对称有限差分公式和一个小步长 $\\delta\\theta$ 进行数值逼近：\n    $$\n    r(\\theta) \\approx \\frac{L(\\theta + \\delta\\theta) - L(\\theta - \\delta\\theta)}{2 \\delta\\theta}\n    $$\n    选择一个足够小的步长，如 $\\delta\\theta = 10^{-7}$ 弧度，以确保数值的准确性和稳定性。\n\n对于每个测试用例，都执行上述步骤。首先，为指定的角度 $\\theta$ 计算 $L(\\theta)$。然后，在 $\\theta + \\delta\\theta$ 和 $\\theta - \\delta\\theta$ 处计算长度函数的值，以计算力臂 $r(\\theta)$。最后，收集结果并按规定格式化。",
            "answer": "$$\n\\boxed{[0.096503,0.011883,0.117188,0.035985,0.098864,0.023249,0.200000,0.000000,0.092650,0.009852]}\n$$"
        },
        {
            "introduction": "本章的最后一个练习将探讨运动分析中的一个关键实际问题：实验误差。生物力学计算所依赖的数据通常来自粘贴在皮肤上的标记点，而这些标记点会相对于下面的骨骼移动。本练习将介绍一种系统的方法，即使用一阶误差传播理论来估算由皮肤运动伪影（skin motion artifact）引起的关节角度计算不确定性，这是实验研究者必须掌握的一项重要技能 ()。",
            "id": "4178180",
            "problem": "考虑一个在准静态站立期间的髋关节生物力学的平面矢状面模型，其中骨盆局部坐标系的误差可忽略不计，并定义了前 ($x$) 轴和上 ($y$) 轴。大腿节段的长轴是通过位于大腿外侧的两个皮肤标记点来估计的：一个近端标记点 $M_{1}$ 和一个远端标记点 $M_{2}$。大腿轴向量定义为 $\\mathbf{v} = \\mathbf{M}_{2} - \\mathbf{M}_{1}$，髋关节屈曲角 $\\theta$ 由此轴计算得出，即 $\\theta = \\arctan2(v_{y}, v_{x})$，其中 $\\mathbf{v} = (v_{x}, v_{y})$ 是在骨盆坐标系中表示的。假设真实的大腿轴长度为 $L$，真实的屈曲角为 $\\theta_{0}$，因此有 $v_{x} = L \\cos(\\theta_{0})$ 和 $v_{y} = L \\sin(\\theta_{0})$。\n\n皮肤运动伪影被建模为附加的标记点位移噪声。设观察到的标记点位置为 $\\tilde{\\mathbf{M}}_{i} = \\mathbf{M}_{i} + \\boldsymbol{\\epsilon}_{i}$（对于 $i \\in \\{1,2\\}$），其中每个 $\\boldsymbol{\\epsilon}_{i}$ 是一个零均值高斯随机向量，具有各向异性、轴对齐的协方差。具体来说，对于每个标记点，$\\boldsymbol{\\epsilon}_{i} \\sim \\mathcal{N}\\!\\left(\\mathbf{0}, \\boldsymbol{\\Sigma}_{m}\\right)$，其中 $\\boldsymbol{\\Sigma}_{m} = \\mathrm{diag}\\!\\left(\\sigma_{x}^{2}, \\sigma_{y}^{2}\\right)$，并且每个轴上存在标记点间的相关性，使得 $\\mathrm{corr}\\!\\left(\\epsilon_{1x}, \\epsilon_{2x}\\right) = \\mathrm{corr}\\!\\left(\\epsilon_{1y}, \\epsilon_{2y}\\right) = \\rho$。假设没有跨轴耦合，即对于所有的 $i,j$，$\\mathrm{cov}\\!\\left(\\epsilon_{ix}, \\epsilon_{jy}\\right) = 0$。\n\n使用第一性原理（运动学定义和 $\\arctan2$ 的一阶线性化），将标记点位移噪声传播到髋关节角度的计算中，以获得仅由皮肤运动伪影引起的预期均方根 (RMS) 髋关节角度误差。将骨盆坐标系视为精确的。使用以下数值：\n- $L = 0.40$ m，\n- $\\theta_{0} = 30^{\\circ}$，\n- $\\sigma_{x} = 0.008$ m，\n- $\\sigma_{y} = 0.012$ m，\n- $\\rho = 0.60$。\n\n以度为单位表示最终的预期 RMS 髋关节角度误差。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求计算由标记点放置噪声引起的预期均方根 (RMS) 髋关节角度误差。髋关节屈曲角 $\\theta$ 定义为大腿轴向量 $\\mathbf{v} = (v_x, v_y)$ 各分量的函数，其中 $\\theta = \\arctan2(v_y, v_x)$。$\\theta$ 的误差是由 $v_x$ 和 $v_y$ 的误差引起的，而后者又是由标记点位置的噪声引起的。我们可以使用一阶误差传播来量化这一点。\n\n设 $\\theta_0$ 为真实髋关节角度，$\\theta$ 为测量角度。角度误差为 $\\Delta\\theta = \\theta - \\theta_0$。使用 $\\theta(v_x, v_y)$ 在真实向量分量 $(v_{x0}, v_{y0})$ 附近的一阶泰勒级数展开，角度误差可以近似为：\n$$\n\\Delta\\theta \\approx \\left. \\frac{\\partial \\theta}{\\partial v_x} \\right|_{0} \\Delta v_x + \\left. \\frac{\\partial \\theta}{\\partial v_y} \\right|_{0} \\Delta v_y\n$$\n其中 $\\Delta v_x = v_x - v_{x0}$ 和 $\\Delta v_y = v_y - v_{y0}$ 是向量分量的误差，偏导数在真实值处求得。\n\n预期的 RMS 误差定义为 $\\sqrt{\\mathrm{E}[(\\Delta\\theta)^2]}$。由于噪声源是零均值的，预期的误差 $\\mathrm{E}[\\Delta v_x]$ 和 $\\mathrm{E}[\\Delta v_y]$ 均为零。因此，预期的角度误差 $\\mathrm{E}[\\Delta\\theta]$ 近似为零。所以，$\\mathrm{E}[(\\Delta\\theta)^2] \\approx \\mathrm{var}(\\Delta\\theta)$，并且 RMS 误差是角度误差的标准差 $\\sigma_{\\theta}$。\n\n角度误差的方差 $\\mathrm{var}(\\Delta\\theta)$ 由不确定性传播的一般公式给出：\n$$\n\\sigma_{\\theta}^2 = \\mathrm{var}(\\Delta\\theta) \\approx \\left(\\frac{\\partial \\theta}{\\partial v_x}\\right)^2 \\mathrm{var}(\\Delta v_x) + \\left(\\frac{\\partial \\theta}{\\partial v_y}\\right)^2 \\mathrm{var}(\\Delta v_y) + 2 \\left(\\frac{\\partial \\theta}{\\partial v_x}\\right) \\left(\\frac{\\partial \\theta}{\\partial v_y}\\right) \\mathrm{cov}(\\Delta v_x, \\Delta v_y)\n$$\n\n首先，我们求 $\\theta = \\arctan(v_y / v_x)$ 的偏导数：\n$$\n\\frac{\\partial \\theta}{\\partial v_x} = \\frac{1}{1 + (v_y/v_x)^2} \\left(-\\frac{v_y}{v_x^2}\\right) = \\frac{-v_y}{v_x^2 + v_y^2}\n$$\n$$\n\\frac{\\partial \\theta}{\\partial v_y} = \\frac{1}{1 + (v_y/v_x)^2} \\left(\\frac{1}{v_x}\\right) = \\frac{v_x}{v_x^2 + v_y^2}\n$$\n真实的向量分量是 $v_{x0} = L \\cos(\\theta_0)$ 和 $v_{y0} = L \\sin(\\theta_0)$。模长的平方是 $v_{x0}^2 + v_{y0}^2 = L^2$。在真实值处计算导数：\n$$\n\\left. \\frac{\\partial \\theta}{\\partial v_x} \\right|_{0} = \\frac{-L \\sin(\\theta_0)}{L^2} = -\\frac{\\sin(\\theta_0)}{L}\n$$\n$$\n\\left. \\frac{\\partial \\theta}{\\partial v_y} \\right|_{0} = \\frac{L \\cos(\\theta_0)}{L^2} = \\frac{\\cos(\\theta_0)}{L}\n$$\n\n接下来，我们确定向量分量误差 $\\Delta v_x$ 和 $\\Delta v_y$ 的统计特性。观察到的大腿向量是 $\\tilde{\\mathbf{v}} = \\tilde{\\mathbf{M}}_2 - \\tilde{\\mathbf{M}}_1 = (\\mathbf{M}_2 + \\boldsymbol{\\epsilon}_2) - (\\mathbf{M}_1 + \\boldsymbol{\\epsilon}_1) = (\\mathbf{M}_2 - \\mathbf{M}_1) + (\\boldsymbol{\\epsilon}_2 - \\boldsymbol{\\epsilon}_1) = \\mathbf{v}_0 + \\Delta\\mathbf{v}$。\n误差向量是 $\\Delta\\mathbf{v} = \\boldsymbol{\\epsilon}_2 - \\boldsymbol{\\epsilon}_1$。误差向量的分量是：\n$$\n\\Delta v_x = \\epsilon_{2x} - \\epsilon_{1x}\n$$\n$$\n\\Delta v_y = \\epsilon_{2y} - \\epsilon_{1y}\n$$\n这些分量的方差是：\n$$\n\\mathrm{var}(\\Delta v_x) = \\mathrm{var}(\\epsilon_{2x} - \\epsilon_{1x}) = \\mathrm{var}(\\epsilon_{2x}) + \\mathrm{var}(\\epsilon_{1x}) - 2\\mathrm{cov}(\\epsilon_{1x}, \\epsilon_{2x})\n$$\n给定 $\\mathrm{var}(\\epsilon_{1x}) = \\mathrm{var}(\\epsilon_{2x}) = \\sigma_x^2$ 和 $\\mathrm{corr}(\\epsilon_{1x}, \\epsilon_{2x}) = \\rho$，我们有 $\\mathrm{cov}(\\epsilon_{1x}, \\epsilon_{2x}) = \\rho\\sigma_x^2$。因此：\n$$\n\\mathrm{var}(\\Delta v_x) = \\sigma_x^2 + \\sigma_x^2 - 2\\rho\\sigma_x^2 = 2\\sigma_x^2(1-\\rho)\n$$\n类似地，对于 $y$ 分量：\n$$\n\\mathrm{var}(\\Delta v_y) = \\mathrm{var}(\\epsilon_{2y}) + \\mathrm{var}(\\epsilon_{1y}) - 2\\mathrm{cov}(\\epsilon_{1y}, \\epsilon_{2y}) = \\sigma_y^2 + \\sigma_y^2 - 2\\rho\\sigma_y^2 = 2\\sigma_y^2(1-\\rho)\n$$\n协方差项是：\n$$\n\\mathrm{cov}(\\Delta v_x, \\Delta v_y) = \\mathrm{cov}(\\epsilon_{2x} - \\epsilon_{1x}, \\epsilon_{2y} - \\epsilon_{1y}) = \\mathrm{cov}(\\epsilon_{2x},\\epsilon_{2y}) - \\mathrm{cov}(\\epsilon_{2x},\\epsilon_{1y}) - \\mathrm{cov}(\\epsilon_{1x},\\epsilon_{2y}) + \\mathrm{cov}(\\epsilon_{1x},\\epsilon_{1y})\n$$\n问题陈述没有跨轴耦合，即对于所有 $i,j \\in \\{1,2\\}$，$\\mathrm{cov}(\\epsilon_{ix}, \\epsilon_{jy}) = 0$。因此，协方差展开中的所有项都为零，且 $\\mathrm{cov}(\\Delta v_x, \\Delta v_y) = 0$。\n\n将导数和方差代入 $\\sigma_{\\theta}^2$ 的公式中：\n$$\n\\sigma_{\\theta}^2 \\approx \\left(-\\frac{\\sin(\\theta_0)}{L}\\right)^2 [2\\sigma_x^2(1-\\rho)] + \\left(\\frac{\\cos(\\theta_0)}{L}\\right)^2 [2\\sigma_y^2(1-\\rho)]\n$$\n$$\n\\sigma_{\\theta}^2 \\approx \\frac{2(1-\\rho)}{L^2} \\left[ \\sigma_x^2\\sin^2(\\theta_0) + \\sigma_y^2\\cos^2(\\theta_0) \\right]\n$$\n现在，我们代入给定的数值：\n$L = 0.40$ m\n$\\theta_0 = 30^{\\circ}$\n$\\sigma_x = 0.008$ m\n$\\sigma_y = 0.012$ m\n$\\rho = 0.60$\n\n我们有 $\\sin(30^{\\circ}) = 0.5$ 和 $\\cos(30^{\\circ}) = \\frac{\\sqrt{3}}{2}$。因此，$\\sin^2(30^{\\circ}) = 0.25$ 且 $\\cos^2(30^{\\circ}) = 0.75$。\n标记点误差的方差为 $\\sigma_x^2 = (0.008)^2 = 6.4 \\times 10^{-5}$ m$^2$ 和 $\\sigma_y^2 = (0.012)^2 = 1.44 \\times 10^{-4}$ m$^2$。\n节段长度的平方是 $L^2 = (0.40)^2 = 0.16$ m$^2$。\n相关性因子为 $1-\\rho = 1-0.60 = 0.40$。\n\n让我们计算角度的方差（单位为弧度的平方）：\n$$\n\\sigma_{\\theta}^2 \\approx \\frac{2(0.40)}{0.16} \\left[ (6.4 \\times 10^{-5})(0.25) + (1.44 \\times 10^{-4})(0.75) \\right]\n$$\n$$\n\\sigma_{\\theta}^2 \\approx 5 \\left[ 1.6 \\times 10^{-5} + 1.08 \\times 10^{-4} \\right] = 5 \\left[ 0.16 \\times 10^{-4} + 1.08 \\times 10^{-4} \\right]\n$$\n$$\n\\sigma_{\\theta}^2 \\approx 5 [1.24 \\times 10^{-4}] = 6.2 \\times 10^{-4} \\text{ rad}^2\n$$\nRMS 误差是标准差 $\\sigma_{\\theta}$：\n$$\n\\sigma_{\\theta} = \\sqrt{6.2 \\times 10^{-4}} \\approx 0.0248998 \\text{ rad}\n$$\n最后，我们将这个结果从弧度转换为度：\n$$\n\\sigma_{\\theta, \\text{deg}} = \\sigma_{\\theta} \\times \\frac{180^{\\circ}}{\\pi} \\approx 0.0248998 \\times \\frac{180}{\\pi} \\approx 1.42668^{\\circ}\n$$\n四舍五入到四位有效数字，预期的 RMS 髋关节角度误差为 $1.427^{\\circ}$。",
            "answer": "$$\n\\boxed{1.427}\n$$"
        }
    ]
}