{
    "hands_on_practices": [
        {
            "introduction": "生物力学实验通常使用带有自身坐标系的仪器，如测力台。为了分析运动，我们必须将这些数据转换到一个统一的实验室坐标系中。该练习利用刚体运动学原理，特别是旋转矩阵，来执行这一至关重要的坐标变换。掌握这项技能对于准确处理和解读任何三维运动分析系统的实验数据都至关重要。",
            "id": "4205409",
            "problem": "考虑上楼梯的场景，其中一个刚性测力台与单级楼梯的踏板表面平齐嵌入。设全局实验室坐标系 (GLF) 由标准正交基向量 $\\hat{\\mathbf{X}}, \\hat{\\mathbf{Y}}, \\hat{\\mathbf{Z}}$ 表示，其中 $\\hat{\\mathbf{Z}}$ 垂直并指向上方。设测力台坐标系 (FPF) 由 $\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}}$ 表示，其中 $\\hat{\\mathbf{z}}$ 是踏板的表面法线，$\\hat{\\mathbf{x}}$ 沿着楼梯的行进方向（前后方向），$\\hat{\\mathbf{y}}$ 为侧向。FPF 相对于 GLF 的安装方式为：绕 $\\hat{\\mathbf{Y}}$ 进行右手旋转，形成一个俯仰角 $\\alpha$；以及绕 $\\hat{\\mathbf{Z}}$ 进行右手旋转，形成一个偏航角 $\\psi$。角度 $\\alpha$ 和 $\\psi$ 以弧度为单位。\n\n测力台输出一个力向量 $\\mathbf{F}_{L}$ 和一个自由力矩向量 $\\mathbf{M}_{L}$，两者都在 FPF 中表示，并以测力台的原点为参考点。使用 Newton 定律和刚体运动学（包括标准正交基的定义和方向余弦关系），执行以下操作：\n\n1. 推导 $3 \\times 3$ 旋转矩阵 $C(\\alpha,\\psi)$，该矩阵将 FPF 中表示的任何向量映射到 GLF，即 $\\mathbf{v}_{G} = C(\\alpha,\\psi)\\,\\mathbf{v}_{L}$。您的推导必须明确说明，将 FPF 与 GLF 相关联时，绕 $\\hat{\\mathbf{Z}}$ 的偏航和绕 $\\hat{\\mathbf{Y}}$ 的俯仰是如何复合的。\n\n2. 使用推导出的 $C(\\alpha,\\psi)$，陈述从 FPF 到 GLF 的力和自由力矩的变换。假设力矩参考点重合（原点之间没有平移），并将全局自由力矩表示为 $\\mathbf{M}_{L}$、$\\mathbf{F}_{L}$ 和 $C(\\alpha,\\psi)$ 的函数。\n\n3. 使用已知的静态载荷情况进行验证：一个质量为 $m = 83.4$ 的受试者安静站立，其垂直地面反作用力 (GRF) 的大小等于其重量 $W = m\\,g$（其中 $g = 9.81$）。GRF 作用于测力台中心，因此在原点处没有因力的平移产生的净力矩。使用您的 $C(\\alpha,\\psi)$，对于全局垂直 GRF $\\mathbf{F}_{G} = \\begin{pmatrix}0 \\\\ 0 \\\\ W\\end{pmatrix}$，预测将被测量的局部力 $\\mathbf{F}_{L}$，然后将其变换回 GLF 以恢复垂直分量。将恢复的全局垂直力分量报告为单个标量。将您的答案四舍五入到四位有效数字。以牛顿 (N) 为单位表示最终的力。角度以弧度为单位；验证步骤不需要 $\\alpha$ 和 $\\psi$ 的数值。\n\n最终答案必须是单个实数值。",
            "solution": "在尝试提供解答之前，我们根据既定标准对用户提供的问题进行了严格评估。\n\n### 问题验证\n\n#### 步骤 1：提取已知条件\n-   **全局实验室坐标系 (GLF)**：标准正交基向量 $\\hat{\\mathbf{X}}, \\hat{\\mathbf{Y}}, \\hat{\\mathbf{Z}}$，其中 $\\hat{\\mathbf{Z}}$ 垂直并指向上方。\n-   **测力台坐标系 (FPF)**：标准正交基向量 $\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}}$，其中 $\\hat{\\mathbf{z}}$ 为踏板的表面法线，$\\hat{\\mathbf{x}}$ 沿着楼梯的行进方向，$\\hat{\\mathbf{y}}$ 为侧向。\n-   **方向**：FPF 相对于 GLF 的安装方式为：俯仰角 $\\alpha$（绕 $\\hat{\\mathbf{Y}}$ 的右手旋转）和偏航角 $\\psi$（绕 $\\hat{\\mathbf{Z}}$ 的右手旋转）。角度以弧度为单位。\n-   **测力台输出**：在 FPF 中表示的力向量 $\\mathbf{F}_{L}$ 和自由力矩向量 $\\mathbf{M}_{L}$。\n-   **任务 1**：推导将向量从 FPF 映射到 GLF 的 $3 \\times 3$ 旋转矩阵 $C(\\alpha,\\psi)$：$\\mathbf{v}_{G} = C(\\alpha,\\psi)\\,\\mathbf{v}_{L}$。推导过程必须使用指定的偏航和俯仰复合方式。\n-   **任务 2**：陈述在原点重合的假设下，从 FPF 到 GLF 的力和自由力矩的变换规则。\n-   **任务 3**：使用静态案例进行验证：质量 $m = 83.4$。重力加速度 $g = 9.81$。全局地面反作用力 (GRF) $\\mathbf{F}_{G} = \\begin{pmatrix}0 \\\\ 0 \\\\ W\\end{pmatrix}$，其中 $W = m\\,g$。任务是使用推导出的 $C(\\alpha,\\psi)$ 预测局部力 $\\mathbf{F}_{L}$，然后将 $\\mathbf{F}_{L}$ 变换回 GLF，并报告恢复的全局垂直力分量，结果四舍五入到四位有效数字。\n\n#### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n-   **科学依据**：该问题植根于经典力学，特别是刚体运动学和动力学（欧拉角、坐标变换）。其应用领域是生物力学，这是一个合法的科学学科。所引用的原理是基础且公认的。该问题在科学上是合理的。\n-   **适定性**：问题的任务定义清晰。1. 旋转矩阵的推导基于指定的旋转序列（“偏航...和俯仰的复合”）。使用 GLF 轴（$\\hat{\\mathbf{Y}}$, $\\hat{\\mathbf{Z}}$）进行旋转指定了一个外旋序列，这是明确无歧义的。2. 力和力矩的变换是所推导旋转矩阵的标准应用。明确说明了原点重合的简化条件。3. 验证计算是一个具体且可解的练习，提供了所有必要的数据（$m$、$g$ 和目标精度）。角度 $\\alpha$ 和 $\\psi$ 是符号这一事实是一个特点，而非缺陷，旨在测试变换的代数一致性。\n-   **客观性**：语言技术性强且精确。不存在主观或基于观点的陈述。\n-   **未检测到其他缺陷**：该问题是完整的、一致的、对于实验室环境是现实的，并且并非微不足道，因为它需要矩阵代数的正确推导和应用。\n\n#### 步骤 3：结论和行动\n该问题是**有效的**。将提供完整的解答。\n\n### 解答\n\n#### 1. 旋转矩阵 $C(\\alpha,\\psi)$ 的推导\n\n旋转矩阵 $C(\\alpha,\\psi)$ 将向量的坐标从测力台坐标系（FPF，或局部坐标系 $L$）变换到全局实验室坐标系（GLF，或全局坐标系 $G$），即 $\\mathbf{v}_{G} = C(\\alpha,\\psi)\\,\\mathbf{v}_{L}$。\n\nFPF 的方向是通过对 GLF 应用一系列旋转得到的。问题指定了绕 GLF 轴 $\\hat{\\mathbf{Z}}$ 的偏航角 $\\psi$ 和绕 GLF 轴 $\\hat{\\mathbf{Y}}$ 的俯仰角 $\\alpha$。由于旋转轴属于固定的全局坐标系，这描述了一个外旋（空间固定）序列。问题陈述“偏航...和俯仰的复合”，意味着先执行偏航旋转，再执行俯仰旋转。\n\n绕 Z 轴进行角度为 $\\theta$ 的右手旋转的旋转矩阵为：\n$$C_Z(\\theta) = \\begin{pmatrix} \\cos\\theta  -\\sin\\theta  0 \\\\ \\sin\\theta  \\cos\\theta  0 \\\\ 0  0  1 \\end{pmatrix}$$\n绕 Y 轴进行角度为 $\\phi$ 的右手旋转的旋转矩阵为：\n$$C_Y(\\phi) = \\begin{pmatrix} \\cos\\phi  0  \\sin\\phi \\\\ 0  1  0 \\\\ -\\sin\\phi  0  \\cos\\phi \\end{pmatrix}$$\n\n对于外旋序列，复合旋转矩阵是通过按应用顺序前乘旋转矩阵形成的。在这里，序列是先偏航($\\psi$)后俯仰($\\alpha$)。得到的变换矩阵 $C$ 是：\n$$C(\\alpha,\\psi) = C_Y(\\alpha) C_Z(\\psi)$$\n\n执行矩阵乘法：\n$$C(\\alpha,\\psi) = \\begin{pmatrix} \\cos\\alpha  0  \\sin\\alpha \\\\ 0  1  0 \\\\ -\\sin\\alpha  0  \\cos\\alpha \\end{pmatrix} \\begin{pmatrix} \\cos\\psi  -\\sin\\psi  0 \\\\ \\sin\\psi  \\cos\\psi  0 \\\\ 0  0  1 \\end{pmatrix}$$\n$$C(\\alpha,\\psi) = \\begin{pmatrix}\n(\\cos\\alpha)(\\cos\\psi) + (0)(\\sin\\psi) + (\\sin\\alpha)(0)  (\\cos\\alpha)(-\\sin\\psi) + (0)(\\cos\\psi) + (\\sin\\alpha)(0)  (\\cos\\alpha)(0) + (0)(0) + (\\sin\\alpha)(1) \\\\\n(0)(\\cos\\psi) + (1)(\\sin\\psi) + (0)(0)  (0)(-\\sin\\psi) + (1)(\\cos\\psi) + (0)(0)  (0)(0) + (1)(0) + (0)(1) \\\\\n(-\\sin\\alpha)(\\cos\\psi) + (0)(\\sin\\psi) + (\\cos\\alpha)(0)  (-\\sin\\alpha)(-\\sin\\psi) + (0)(\\cos\\psi) + (\\cos\\alpha)(0)  (-\\sin\\alpha)(0) + (0)(0) + (\\cos\\alpha)(1)\n\\end{pmatrix}$$\n$$C(\\alpha,\\psi) = \\begin{pmatrix}\n\\cos\\alpha\\cos\\psi  -\\cos\\alpha\\sin\\psi  \\sin\\alpha \\\\\n\\sin\\psi  \\cos\\psi  0 \\\\\n-\\sin\\alpha\\cos\\psi  \\sin\\alpha\\sin\\psi  \\cos\\alpha\n\\end{pmatrix}$$\n这就是所要求的 $3 \\times 3$ 旋转矩阵。\n\n#### 2. 力和自由力矩的变换\n\n力是一个矢量。因此，在 FPF 中测量的力向量 $\\mathbf{F}_{L}$ 使用旋转矩阵 $C(\\alpha, \\psi)$ 变换为 GLF 中的力向量 $\\mathbf{F}_{G}$：\n$$\\mathbf{F}_{G} = C(\\alpha,\\psi)\\,\\mathbf{F}_{L}$$\n\n问题指定了一个“自由力矩向量” $\\mathbf{M}_{L}$。只要力矩是围绕一个共同的参考点计算的，自由力矩在旋转下就会像一个真向量一样变换。问题明确指出“力矩参考点重合”。在此条件下，FPF 中的力矩向量 $\\mathbf{M}_{L}$ 根据相同的旋转规则变换为 GLF 中的力矩向量 $\\mathbf{M}_{G}$：\n$$\\mathbf{M}_{G} = C(\\alpha,\\psi)\\,\\mathbf{M}_{L}$$\n由于原点重合，没有由力的力矩产生的附加项（即 $\\mathbf{r} \\times \\mathbf{F}$，其中 $\\mathbf{r} = \\mathbf{0}$）。因此，全局自由力矩 $\\mathbf{M}_{G}$ 仅取决于 $\\mathbf{M}_{L}$ 和 $C(\\alpha,\\psi)$，而与 $\\mathbf{F}_{L}$ 无关。\n\n#### 3. 使用静态载荷案例进行验证\n\n受试者的质量为 $m = 83.4$ kg，并受到重力 $g = 9.81 \\, \\text{m}/\\text{s}^2$ 的作用。其重量为 $W = m g$。\n$$W = 83.4 \\times 9.81 = 818.154 \\, \\text{N}$$\n全局地面反作用力是纯垂直的：\n$$\\mathbf{F}_{G} = \\begin{pmatrix} 0 \\\\ 0 \\\\ W \\end{pmatrix}$$\n\n首先，我们预测测力台将测量的局部力 $\\mathbf{F}_{L}$。变换关系为 $\\mathbf{F}_{G} = C \\mathbf{F}_{L}$，因此逆变换为 $\\mathbf{F}_{L} = C^{-1} \\mathbf{F}_{G}$。由于 $C$ 是一个旋转矩阵，它是正交的，这意味着 $C^{-1} = C^T$。\n$$C^T(\\alpha,\\psi) = \\begin{pmatrix}\n\\cos\\alpha\\cos\\psi  \\sin\\psi  -\\sin\\alpha\\cos\\psi \\\\\n-\\cos\\alpha\\sin\\psi  \\cos\\psi  \\sin\\alpha\\sin\\psi \\\\\n\\sin\\alpha  0  \\cos\\alpha\n\\end{pmatrix}$$\n现在我们计算 $\\mathbf{F}_{L}$：\n$$\\mathbf{F}_{L} = C^T \\mathbf{F}_{G} = \\begin{pmatrix}\n\\cos\\alpha\\cos\\psi  \\sin\\psi  -\\sin\\alpha\\cos\\psi \\\\\n-\\cos\\alpha\\sin\\psi  \\cos\\psi  \\sin\\alpha\\sin\\psi \\\\\n\\sin\\alpha  0  \\cos\\alpha\n\\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ W \\end{pmatrix} = W \\begin{pmatrix} -\\sin\\alpha\\cos\\psi \\\\ \\sin\\alpha\\sin\\psi \\\\ \\cos\\alpha \\end{pmatrix}$$\n这是将在 FPF 中测量的力向量。\n\n接下来，我们将这个局部力 $\\mathbf{F}_{L}$ 变换回 GLF 以恢复全局力，我们称之为 $\\mathbf{F}_{G,\\text{rec}}$。\n$$\\mathbf{F}_{G,\\text{rec}} = C \\mathbf{F}_{L}$$\n根据构造，$\\mathbf{F}_{G,\\text{rec}} = C (C^T \\mathbf{F}_{G}) = (C C^T) \\mathbf{F}_{G} = I \\mathbf{F}_{G} = \\mathbf{F}_{G}$，其中 $I$ 是 $3 \\times 3$ 单位矩阵。\n这证实了往返变换恢复了原始的全局力向量，且与角度 $\\alpha$ 和 $\\psi$ 无关。\n$$\\mathbf{F}_{G,\\text{rec}} = \\mathbf{F}_{G} = \\begin{pmatrix} 0 \\\\ 0 \\\\ W \\end{pmatrix}$$\n问题要求的是恢复的全局垂直力分量，即 $\\mathbf{F}_{G,\\text{rec}}$ 的 Z 分量。\n$$(F_{G,\\text{rec}})_Z = W = 818.154 \\, \\text{N}$$\n问题要求将答案四舍五入到四位有效数字。\n$$818.154 \\to 818.2$$\n恢复的全局垂直力分量是 $818.2$ N。",
            "answer": "$$\\boxed{818.2}$$"
        },
        {
            "introduction": "在确定了外部作用力（如地面反作用力）之后，下一步是理解关节处由肌肉和韧带产生的内力和内力矩。本练习将牛顿-欧拉方程应用于小腿-足复合体的自由体图，这是一种经典的逆动力学分析方法。该方法使我们能够估算驱动所观察到运动的净关节力矩，为我们深入了解爬楼梯等活动中的神经肌肉控制和关节负荷提供了关键信息。",
            "id": "4205379",
            "problem": "在上楼梯的提拉阶段，将小腿-足部组合体建模为在矢状面内运动的单个刚体。使用一个右手实验室坐标系，其中 $x$ 轴指向前方（向前），$y$ 轴指向上方（向上），$z$ 轴指向侧方，垂直于矢状面。设膝关节中心为近端参考点，位置为 $\\mathbf{r}_k = (0,0)$，并定义绕 $z$ 轴的逆时针力矩为正。\n\n在某一特定时刻，测量或估计了以下量值：\n- 在鞋-地压力中心（COP）处的地面反作用力（GRF）向量为 $\\mathbf{R} = (80,\\,850)$ 牛顿。COP 相对于膝关节的位置为 $\\mathbf{r}_{\\mathrm{cop}/k} = (0.07,\\,-0.46)$ 米。GRF 作用于 COP。\n- 小腿-足部组合节段的质量为 $m = 4.5$ 千克，其质心（COM）相对于膝关节的位置为 $\\mathbf{r}_{g/k} = (0.10,\\,-0.32)$ 米。该节段质心的线加速度为 $\\mathbf{a}_g = (0.40,\\,1.00)$ 米/秒平方。该节段绕其质心的质量转动惯量为 $I_g = 0.12$ 千克·米平方，其绕 $z$ 轴的角加速度为 $\\alpha_z = 2.5$ 弧度/秒平方。\n- 重力加速度为 $g = 9.81$ 米/秒平方，作用于 $y$ 轴负方向。\n\n假设作用在小腿-足部组合节段上的唯一外载荷是作用于 COP 的 GRF、作用于其 COM 的节段重量，以及膝关节合力（作用于膝关节的力和膝关节净内力矩 $M_k$）。利用小腿-足部组合节段的牛顿-欧拉自由体图和基本定律，计算此时刻绕 $z$ 轴的膝关节净内力矩 $M_k$。以牛顿·米为单位表示你的最终结果。将你的答案四舍五入到三位有效数字。根据指定的符号约定（逆时针为正）陈述你的答案。",
            "solution": "该问题是有效的，因为它科学地基于刚体动力学原理，给出的数据充分且一致，问题阐述清晰，并且可以确定唯一解。\n\n求解需要应用刚体平面运动的牛顿-欧拉方程。我们的目标是计算作用在小腿-足部组合节段上的膝关节净内力矩 $M_k$。最直接的方法是计算绕膝关节中心 $K$ 的力矩之和，该点在指定的实验室坐标系中是一个固定点（$\\mathbf{r}_k = (0,0)$）。\n\n对于平面运动中的刚体，欧拉第二定律指出，绕固定点 $O$ 的外力矩之和等于绕该点 $O$ 的角动量的时间变化率。这可以表示为：\n$$ \\sum \\mathbf{M}_O = \\mathbf{r}_{g/O} \\times (m\\mathbf{a}_g) + I_g \\alpha_z \\hat{\\mathbf{k}} $$\n其中 $\\mathbf{r}_{g/O}$ 是质心（$G$）相对于点 $O$ 的位置向量，$m$ 是物体的质量，$\\mathbf{a}_g$ 是质心的线加速度，$I_g$ 是绕质心的质量转动惯量，$\\alpha_z$ 是绕 $z$ 轴的角加速度，$\\hat{\\mathbf{k}}$ 是 $z$ 方向的单位向量。\n\n在这个问题中，我们计算绕膝关节中心 $K$ 的力矩之和，它是我们坐标系的原点。所以，点 $O$ 就是 $K$。方程变为：\n$$ \\sum \\mathbf{M}_K = \\mathbf{r}_{g/K} \\times (m\\mathbf{a}_g) + I_g \\alpha_z \\hat{\\mathbf{k}} $$\n作用在小腿-足部节段上的外载荷是作用在压力中心（COP）的地面反作用力（$\\mathbf{R}$）、作用在质心（$G$）的节段重量（$\\mathbf{W}$），以及膝关节的合力。膝关节合力包括作用于膝关节中心 $K$ 的力 $\\mathbf{F}_k$ 和一个纯力矩（力偶）$M_k$。\n\n因此，绕膝关节的外力矩之和 $\\sum \\mathbf{M}_K$ 为：\n$$ \\sum \\mathbf{M}_K = (\\mathbf{r}_{\\mathrm{cop}/K} \\times \\mathbf{R}) + (\\mathbf{r}_{g/K} \\times \\mathbf{W}) + (\\mathbf{r}_{k/K} \\times \\mathbf{F}_k) + M_k \\hat{\\mathbf{k}} $$\n由于膝关节力 $\\mathbf{F}_k$ 作用于点 $K$，其相对于 $K$ 的位置向量为 $\\mathbf{r}_{k/K} = \\mathbf{0}$。因此，$\\mathbf{F}_k$ 绕 $K$ 产生的力矩为零。外力矩之和的方程简化为：\n$$ \\sum \\mathbf{M}_K = (\\mathbf{r}_{\\mathrm{cop}/K} \\times \\mathbf{R}) + (\\mathbf{r}_{g/K} \\times \\mathbf{W}) + M_k \\hat{\\mathbf{k}} $$\n令 $\\sum \\mathbf{M}_K$ 的两个表达式相等：\n$$ (\\mathbf{r}_{\\mathrm{cop}/K} \\times \\mathbf{R}) + (\\mathbf{r}_{g/K} \\times \\mathbf{W}) + M_k \\hat{\\mathbf{k}} = \\mathbf{r}_{g/K} \\times (m\\mathbf{a}_g) + I_g \\alpha_z \\hat{\\mathbf{k}} $$\n我们可以重新整理这个方程来求解未知的膝关节力矩 $M_k$：\n$$ M_k \\hat{\\mathbf{k}} = \\left( \\mathbf{r}_{g/K} \\times m\\mathbf{a}_g \\right) - \\left( \\mathbf{r}_{\\mathrm{cop}/K} \\times \\mathbf{R} \\right) - \\left( \\mathbf{r}_{g/K} \\times \\mathbf{W} \\right) + I_g \\alpha_z \\hat{\\mathbf{k}} $$\n由于所有向量都位于 $xy$ 平面内，叉积的结果是沿 $z$ 轴的向量。我们可以为 $z$ 分量写一个标量方程。对于平面内的任意两个向量 $\\mathbf{u} = (u_x, u_y)$ 和 $\\mathbf{v} = (v_x, v_y)$，其叉积的 $z$ 分量为 $(\\mathbf{u} \\times \\mathbf{v})_z = u_x v_y - u_y v_x$。\n$M_k$ 的标量方程是：\n$$ M_k = (\\mathbf{r}_{g/K} \\times m\\mathbf{a}_g)_z - (\\mathbf{r}_{\\mathrm{cop}/K} \\times \\mathbf{R})_z - (\\mathbf{r}_{g/K} \\times \\mathbf{W})_z + I_g \\alpha_z $$\n现在，我们代入给定的数值：\n- 质量: $m = 4.5$ kg\n- 相对于膝关节（$K$）的位置向量：\n  - $\\mathbf{r}_{g/K} = (0.10, -0.32)$ m\n  - $\\mathbf{r}_{\\mathrm{cop}/K} = (0.07, -0.46)$ m\n- 力和加速度向量：\n  - $\\mathbf{R} = (80, 850)$ N\n  - $\\mathbf{a}_g = (0.40, 1.00)$ m/s$^2$\n  - 重量向量为 $\\mathbf{W} = m\\mathbf{g} = (4.5 \\text{ kg}) \\times (0, -9.81 \\text{ m/s}^2) = (0, -44.145)$ N。\n- 惯性特性：\n  - $I_g = 0.12$ kg⋅m$^2$\n  - $\\alpha_z = 2.5$ rad/s$^2$\n\n我们计算 $M_k$ 方程中的每一项：\n$1$. 与节段线加速度相关的项：\n$$ (\\mathbf{r}_{g/K} \\times m\\mathbf{a}_g)_z = m(x_{g/k} a_{gy} - y_{g/k} a_{gx}) $$\n$$ = (4.5) \\times ((0.10)(1.00) - (-0.32)(0.40)) = (4.5) \\times (0.10 + 0.128) = (4.5)(0.228) = 1.026 \\text{ N}\\cdot\\text{m} $$\n$2$. 由 GRF 产生的力矩：\n$$ (\\mathbf{r}_{\\mathrm{cop}/K} \\times \\mathbf{R})_z = x_{\\mathrm{cop}/k} R_y - y_{\\mathrm{cop}/k} R_x $$\n$$ = (0.07)(850) - (-0.46)(80) = 59.5 - (-36.8) = 59.5 + 36.8 = 96.3 \\text{ N}\\cdot\\text{m} $$\n$3$. 由节段重量产生的力矩：\n$$ (\\mathbf{r}_{g/K} \\times \\mathbf{W})_z = x_{g/k} W_y - y_{g/k} W_x $$\n$$ = (0.10)(-44.145) - (-0.32)(0) = -4.4145 \\text{ N}\\cdot\\text{m} $$\n$4$. 与节段角加速度相关的项：\n$$ I_g \\alpha_z = (0.12)(2.5) = 0.3 \\text{ N}\\cdot\\text{m} $$\n\n最后，我们将这些值代回 $M_k$ 的方程中：\n$$ M_k = (1.026) - (96.3) - (-4.4145) + (0.3) $$\n$$ M_k = 1.026 - 96.3 + 4.4145 + 0.3 $$\n$$ M_k = 5.7405 - 96.3 = -90.5595 \\text{ N}\\cdot\\text{m} $$\n问题要求将答案四舍五入到三位有效数字。\n$$ M_k \\approx -90.6 \\text{ N}\\cdot\\text{m} $$\n负号表示，根据指定的符号约定（逆时针为正），膝关节净内力矩是顺时针方向的。这是一个屈肌力矩。",
            "answer": "$$\\boxed{-90.6}$$"
        },
        {
            "introduction": "人类运动不仅是连续的，还包含离散的逻辑切换，例如足部与地面的接触和分离。这项高级练习介绍了混合自动机的概念，它是一种强大的建模工具，适用于同时展现连续动态和基于事件的离散逻辑的系统。通过定义接触模式以及触发模式间转换的“护卫条件”，你将学习如何构建一个能够捕捉运动基本控制逻辑的计算模型，这是机器人学和高级生物力学仿真中的一个核心概念。",
            "id": "4205415",
            "problem": "您的任务是推导并实现一个用于单肢上楼的混合自动机，重点关注基于接触力学和动力学第一性原理的离散接触模式和守卫条件。该设置模拟了单只脚在上楼过程中与一级台阶的交互。使用牛顿第二定律和单边接触互补性作为基本依据。将连续变量定义如下：足部相对于下一个着地面的高度 $h$（单位：米），足部垂直速度 $\\dot{z}_f$（单位：米/秒），地面法向反作用力 $N$（单位：牛顿），及其时间导数 $\\dot{N}$（单位：牛顿/秒）。该混合自动机具有代表接触阶段的离散模式（编码为整数）：摆动（$0$）、足跟着地（$1$）、支撑（$2$）和足尖离地（$3$）。为鲁棒地检测接触的开始和消失，假设一个小的非负接触间隙容差 $\\epsilon$（单位：米）和一个小的正法向力阈值 $N_{\\min}$（单位：牛顿）。\n\n任务1（推导）：从牛顿第二定律和单边接触互补性出发，仅使用变量 $h$、$\\dot{z}_f$、$N$ 和 $\\dot{N}$ 以及阈值 $\\epsilon$ 和 $N_{\\min}$，推导模式之间转换的离散守卫条件。守卫条件必须仅能通过这些量之间的不等式来表示。支撑和摆动阶段必须遵守非穿透间隙与法向接触力之间的互补性原理。您的推导必须确保仅使用上述可测量变量，在支撑阶段之前触发足跟着地，在摆动阶段之前触发足尖离地。\n\n任务2（实现）：将推导出的守卫条件实现为一个确定性状态转移函数，该函数将当前模式和测量变量映射到下一个模式。您必须一致且鲁棒地解决等式处的边界模糊性，为转换选择合理的不等式。\n\n测试套件：在以下测试用例集上评估您的状态转移函数。每个测试用例是一个列表 $[M, h, \\dot{z}_f, N, \\dot{N}, \\epsilon, N_{\\min}]$，其中 $M$ 是当前模式，编码为 $0$ 代表摆动，$1$ 代表足跟着地，$2$ 代表支撑，或 $3$ 代表足尖离地。请完全按照指定的值和单位使用。\n\n-   用例 A: $[0, 0.005, -0.3, 0.0, 0.0, 0.01, 50.0]$\n-   用例 B: $[1, 0.000, -0.1, 350.0, 1000.0, 0.01, 50.0]$\n-   用例 C: $[2, 0.000, 0.0, 20.0, -200.0, 0.01, 50.0]$\n-   用例 D: $[3, 0.030, 0.2, 0.0, 0.0, 0.01, 50.0]$\n-   用例 E: $[0, 0.012, -0.5, 0.0, 0.0, 0.01, 50.0]$\n-   用例 F: $[2, 0.000, 0.0, 50.0, 10.0, 0.01, 50.0]$\n-   用例 G: $[0, 0.000, 0.1, 0.0, 0.0, 0.01, 50.0]$\n-   用例 H: $[1, 0.020, 0.1, 0.0, 0.0, 0.01, 50.0]$\n-   用例 I: $[0, 0.010, -0.01, 0.0, 0.0, 0.01, 50.0]$\n-   用例 J: $[2, 0.000, 0.0, 49.999, -0.001, 0.01, 50.0]$\n\n所有高度 $h$ 和容差 $\\epsilon$ 必须以米为单位解释，速度 $\\dot{z}_f$ 以米/秒为单位，力 $N$ 和阈值 $N_{\\min}$ 以牛顿为单位，力变化率 $\\dot{N}$ 以牛顿/秒为单位。如果出现任何角度，您必须使用弧度，尽管本任务中不需要角度。每个测试用例的最终输出必须是您的转移函数返回的整数下一模式。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,\\dots,r_{10}]$），其中每个 $r_i$ 是按上述顺序列出的相应测试用例的整数下一模式。",
            "solution": "该问题要求为模拟单肢上楼的混合自动机推导并实现一个确定性状态转移函数。推导必须基于牛顿第二定律和单边接触互补性原理。\n\n### 1. 基本原理与状态定义\n\n足部与楼梯的相互作用动力学由单边接触决定。这施加了两个基本约束：\n1.  **非穿透性：** 足部不能穿过楼梯表面。如果 $h$ 是足部相对于表面的高度，则 $h \\ge 0$。\n2.  **单边力：** 接触力 $N$ 只能是排斥力（推力），而不能是粘附力（拉力）。因此，$N \\ge 0$。\n\n这两个约束通过**互补性原理**联系在一起，该原理指出，只有在没有间隙时才能存在接触力，而只有在没有接触力时才能存在间隙。在数学上，这表示为 $h \\cdot N = 0$。\n\n在实际实现中，传感器噪声和模型简化使得有必要使用阈值：一个小的非负间隙容差 $\\epsilon$ 用于高度，以及一个小的正法向力阈值 $N_{\\min}$ 用于力。混合自动机的主要模式，摆动（Swing）和支撑（Stance），是通过使用这些阈值放宽互补性条件来定义的：\n\n*   **模式 0：摆动 (Swing)：** 足部在空中，未与楼梯接触。这对应于存在可辨别的间隙且无显著接触力的状态。\n    -   条件：$h > \\epsilon$ 且 $N  N_{\\min}$。\n\n*   **模式 2：支撑 (Stance)：** 足部与楼梯牢固、稳定地接触，并支撑重量。这对应于没有可辨别的间隙且存在显著接触力的状态。\n    -   条件：$h \\le \\epsilon$ 且 $N \\ge N_{\\min}$。\n\n问题引入了另外两种模式，足跟着地（Heel-strike）和足尖离地（Toe-off），作为连接摆动和支撑之间转换的瞬态阶段。\n\n*   **模式 1：足跟着地 (Heel-strike)：** 代表接触开始的瞬态阶段。它在撞击时开始，在实现稳定接触（支撑）时结束。\n\n*   **模式 3：足尖离地 (Toe-off)：** 代表接触终止的瞬态阶段。它在足部卸载时开始，在实现分离（摆动）时结束。\n\n变量 $\\dot{z}_f$ 代表足部的垂直速度，其中 $\\dot{z}_f  0$ 表示向下运动（接近表面），$\\dot{z}_f > 0$ 表示向上运动（远离表面）。力变化率 $\\dot{N}$ 表示接触力是增加（$\\dot{N} > 0$）还是减少（$\\dot{N}  0$）。尽管 $\\dot{N}$ 可用，但为接触开始和终止引入显式的瞬态模式，使得系统状态可通过 $h$ 和 $N$ 直接观测，从而使 $\\dot{N}$ 对于一个鲁棒的状态机而言并非必不可少，因此最终的逻辑中将不使用它。\n\n### 2. 守卫条件的推导\n\n守卫条件是一个逻辑表达式，当其为真时，会触发从一个离散模式到另一个离散模式的转换。状态转移函数必须是确定性的，这意味着对于任何给定的状态，下一个模式都是唯一确定的。我们现在推导运动周期中每个可能转换的守卫条件。\n\n**从模式 0 (摆动) 到模式 1 (足跟着地)：**\n从摆动到足跟着地的转换标志着撞击的瞬间。该事件由两个同时发生的条件来表征：\n1.  足部高度 $h$ 已减小到等于或低于间隙容差 $\\epsilon$ 的值，即 $h \\le \\epsilon$。\n2.  足部具有向下的速度，表明它正在向表面移动，而不是远离它，即 $\\dot{z}_f  0$。\n\n因此，$0 \\to 1$ 转换的守卫条件是：\n$$ (h \\le \\epsilon) \\land (\\dot{z}_f  0) $$\n如果此条件不满足，系统将保持在摆动模式。\n\n**从模式 1 (足跟着地) 到模式 2 (支撑)：**\n足跟着地是瞬态加载阶段。一旦接触牢固建立，就会转换到支撑模式，其标志是法向力 $N$ 上升到最小力阈值 $N_{\\min}$ 之上。\n\n$1 \\to 2$ 转换的守卫条件是：\n$$ N \\ge N_{\\min} $$\n\n**从模式 2 (支撑) 到模式 3 (足尖离地)：**\n从支撑到足尖离地的转换标志着为离地做准备的卸载阶段的开始。当先前高于 $N_{\\min}$ 的法向力 $N$ 下降到此阈值以下时，检测到该转换。\n\n$2 \\to 3$ 转换的守卫条件是：\n$$ N  N_{\\min} $$\n如果此条件为假（即 $N \\ge N_{\\min}$），足部将保持在支撑模式。\n\n**从模式 3 (足尖离地) 到模式 0 (摆动)：**\n足尖离地是瞬态卸载阶段。当足部物理上与表面分离时，完成向摆动模式的转换。当足部高度 $h$ 再次超过间隙容差 $\\epsilon$ 时，检测到该转换。\n\n$3 \\to 0$ 转换的守卫条件是：\n$$ h > \\epsilon $$\n\n### 3. 为实现鲁棒性处理非标称转换\n\n一个鲁棒的自动机还必须考虑偏离标准周期的可能事件。\n\n**从模式 1 (足跟着地) 到模式 0 (摆动)：**\n此转换代表着陆中止或反弹。如果足部进入足跟着地阶段但未能形成稳定的接触力，并且随后足部远离表面，则应返回摆动模式。如果在仍处于模式 $1$ 时，高度 $h$ 变得大于 $\\epsilon$，则满足此条件。\n\n$1 \\to 0$ 转换的守卫条件是：\n$$ h > \\epsilon $$\n\n**从模式 3 (足尖离地) 到模式 2 (支撑)：**\n此转换代表足部在卸载开始后发生“卡顿”或重新加载。如果足部进入足尖离地阶段，但在实现离地之前力被重新施加，则应返回支撑模式。如果在仍处于模式 $3$ 时，法向力 $N$ 增加回等于或高于 $N_{\\min}$，则检测到此情况。\n\n$3 \\to 2$ 转换的守卫条件是：\n$$ N \\ge N_{\\min} $$\n\n### 4. 最终状态转移逻辑\n\n该逻辑实现为一个确定性函数，按特定顺序评估守卫条件。对于给定的模式 $M$，如果没有满足任何转换守卫条件，则模式保持不变。对于具有多个退出路径的模式（$1$ 和 $3$），评估顺序对于确定性很重要。\n\n设 $M$ 为当前模式，$M'$ 为下一个模式。\n\n-   如果 $M = 0$ (摆动):\n    -   如果 $(h \\le \\epsilon) \\land (\\dot{z}_f  0)$，则 $M' = 1$。\n    -   否则，$M' = 0$。\n\n-   如果 $M = 1$ (足跟着地):\n    -   如果 $N \\ge N_{\\min}$，则 $M' = 2$。\n    -   否则如果 $h > \\epsilon$，则 $M' = 0$。\n    -   否则，$M' = 1$。\n\n-   如果 $M = 2$ (支撑):\n    -   如果 $N  N_{\\min}$，则 $M' = 3$。\n    -   否则，$M' = 2$。\n\n-   如果 $M = 3$ (足尖离地):\n    -   如果 $h > \\epsilon$，则 $M' = 0$。\n    -   否则如果 $N \\ge N_{\\min}$，则 $M' = 2$。\n    -   否则，$M' = 3$。\n\n至此，完成了为指定的混合自动机推导一套完整且鲁棒的守卫条件。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_next_mode(M, h, dot_z_f, N, dot_N, epsilon, N_min):\n    \"\"\"\n    Calculates the next mode of a hybrid automaton for stair ascent.\n\n    The automaton models four discrete modes of a single foot:\n    0: Swing - Foot is in the air.\n    1: Heel-strike - Transient phase, contact is initiated.\n    2: Stance - Foot is in firm contact with the ground.\n    3: Toe-off - Transient phase, contact is terminated.\n\n    Args:\n        M (int): The current mode (0, 1, 2, or 3).\n        h (float): Foot height relative to the landing surface [meters].\n        dot_z_f (float): Vertical foot velocity [m/s].\n        N (float): Normal ground reaction force [Newtons].\n        dot_N (float): Time derivative of normal force [N/s].\n        epsilon (float): Small non-negative contact clearance tolerance [meters].\n        N_min (float): Small positive normal force threshold [Newtons].\n\n    Returns:\n        int: The next mode of the automaton.\n    \"\"\"\n    \n    # Mode 0: Swing\n    # The foot is in the air. Transition to Heel-strike upon impact.\n    if M == 0:\n        # Guard (0 -> 1): Impact condition met if height is within tolerance\n        # and velocity is negative (approaching).\n        if h = epsilon and dot_z_f  0:\n            return 1  # Transition to Heel-strike\n        else:\n            return 0  # Remain in Swing\n\n    # Mode 1: Heel-strike\n    # Transient phase for contact establishment. Can lead to Stance or back to Swing.\n    elif M == 1:\n        # Guard (1 -> 2): Transition to Stance when force threshold is met.\n        if N >= N_min:\n            return 2  # Transition to Stance\n        # Guard (1 -> 0): Represents a bounce or aborted landing.\n        elif h > epsilon:\n            return 0  # Transition back to Swing\n        else:\n            return 1  # Remain in Heel-strike\n\n    # Mode 2: Stance\n    # The foot is firmly on the ground. Transition to Toe-off upon unloading.\n    elif M == 2:\n        # Guard (2 -> 3): Transition to Toe-off when force drops below threshold.\n        if N  N_min:\n            return 3  # Transition to Toe-off\n        else:\n            return 2  # Remain in Stance\n\n    # Mode 3: Toe-off\n    # Transient phase for contact termination. Can lead to Swing or back to Stance.\n    elif M == 3:\n        # Guard (3 -> 0): Transition to Swing when separation is confirmed.\n        if h > epsilon:\n            return 0  # Transition to Swing\n        # Guard (3 -> 2): Represents a \"stutter\" or re-loading.\n        elif N >= N_min:\n            return 2  # Transition back to Stance\n        else:\n            return 3  # Remain in Toe-off\n            \n    # Should not be reached with valid inputs\n    return M\n\ndef solve():\n    \"\"\"\n    Defines and evaluates the test suite for the state transition function.\n    \"\"\"\n    # Test cases: [M, h, dot_z_f, N, dot_N, epsilon, N_min]\n    test_cases = [\n        # Case A: Swing, foot near ground and moving down -> Heel-strike\n        [0, 0.005, -0.3, 0.0, 0.0, 0.01, 50.0],\n        # Case B: Heel-strike, force is established -> Stance\n        [1, 0.000, -0.1, 350.0, 1000.0, 0.01, 50.0],\n        # Case C: Stance, force drops below threshold -> Toe-off\n        [2, 0.000, 0.0, 20.0, -200.0, 0.01, 50.0],\n        # Case D: Toe-off, foot has separated from ground -> Swing\n        [3, 0.030, 0.2, 0.0, 0.0, 0.01, 50.0],\n        # Case E: Swing, but still above tolerance height -> Swing\n        [0, 0.012, -0.5, 0.0, 0.0, 0.01, 50.0],\n        # Case F: Stance, force is exactly at threshold -> Stance\n        [2, 0.000, 0.0, 50.0, 10.0, 0.01, 50.0],\n        # Case G: Swing, foot at ground but moving up (no impact) -> Swing\n        [0, 0.000, 0.1, 0.0, 0.0, 0.01, 50.0],\n        # Case H: Heel-strike, but separation occurs (bounce) -> Swing\n        [1, 0.020, 0.1, 0.0, 0.0, 0.01, 50.0],\n        # Case I: Swing, foot at tolerance boundary and moving down -> Heel-strike\n        [0, 0.010, -0.01, 0.0, 0.0, 0.01, 50.0],\n        # Case J: Stance, force just below threshold -> Toe-off\n        [2, 0.000, 0.0, 49.999, -0.001, 0.01, 50.0],\n    ]\n\n    results = []\n    for case in test_cases:\n        M, h, dot_z_f, N, dot_N, epsilon, N_min = case\n        next_m = get_next_mode(M, h, dot_z_f, N, dot_N, epsilon, N_min)\n        results.append(next_m)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}