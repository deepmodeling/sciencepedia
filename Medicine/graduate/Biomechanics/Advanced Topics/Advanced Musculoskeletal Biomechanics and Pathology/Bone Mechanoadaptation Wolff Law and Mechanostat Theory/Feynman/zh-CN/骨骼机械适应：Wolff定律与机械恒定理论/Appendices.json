{
    "hands_on_practices": [
        {
            "introduction": "尽管瞬时刺激很重要，但骨骼的适应是一个反映日常负荷累积效应的长期过程。本练习通过模拟包含不同活动水平的每日应变历史，将 Frost 力学阈值理论的核心原则付诸实践。您将构建一个受生物学启发的激活函数，并将其在24小时内进行积分以确定净重塑信号，从而阐明骨骼如何根据其整体力学环境来维持、增加或减少骨量 ()。",
            "id": "4161488",
            "problem": "骨骼在一天内的承重环境可以用一个随时间变化的应变大小函数 $ \\varepsilon(t) $ 来描述，其单位为微应变（$\\mu\\varepsilon$）。根据沃尔夫定律和力学稳态理论，骨细胞信号传导驱动骨骼的净重塑，以将应变恢复到一个稳态的“懒惰区”（lazy zone），其中废用会引发净吸收，而过度使用会引发净形成。为了将此过程形式化，我们考虑一个标量激活函数 $ a(\\varepsilon) $，该函数根据从力学稳态理论推导出的以下力学生物学约束来编码净重塑驱动：\n1. 在懒惰区内，$ \\varepsilon \\in [\\varepsilon_{\\mathrm{lazy}}^{-}, \\varepsilon_{\\mathrm{lazy}}^{+}] $，净驱动为零：骨骼以维持现状为目标，此时 $ a(\\varepsilon) = 0 $。\n2. 对于低应变（低于 $ \\varepsilon_{\\mathrm{lazy}}^{-} $），驱动为负，其绝对值随着 $ \\varepsilon $ 的减小而增大，并在废用阈值 $ \\varepsilon_{\\mathrm{dis}} $ 处达到一个负平台期。假设对于 $ \\varepsilon \\le \\varepsilon_{\\mathrm{dis}} $，有 $ a(\\varepsilon) = -1 $，并且 $ a(\\varepsilon) $ 在区间 $ (\\varepsilon_{\\mathrm{dis}}, \\varepsilon_{\\mathrm{lazy}}^{-}) $ 上呈线性变化且在端点处连续。\n3. 对于高应变（高于 $ \\varepsilon_{\\mathrm{lazy}}^{+} $），驱动为正，并线性增加直至过载阈值 $ \\varepsilon_{\\mathrm{over}} $，超过该阈值后达到一个正平台期。假设对于 $ \\varepsilon \\ge \\varepsilon_{\\mathrm{over}} $，有 $ a(\\varepsilon) = +1 $，并且 $ a(\\varepsilon) $ 在区间 $ (\\varepsilon_{\\mathrm{lazy}}^{+}, \\varepsilon_{\\mathrm{over}}) $ 上呈线性变化且在端点处连续。\n\n给定阈值为\n$ \\varepsilon_{\\mathrm{dis}} = 500\\,\\mu\\varepsilon $，$ \\varepsilon_{\\mathrm{lazy}}^{-} = 800\\,\\mu\\varepsilon $，$ \\varepsilon_{\\mathrm{lazy}}^{+} = 1500\\,\\mu\\varepsilon $，以及 $ \\varepsilon_{\\mathrm{over}} = 4000\\,\\mu\\varepsilon $。\n\n每日应变计划在 $ T = 24\\,\\mathrm{h} $ 的周期内是分段恒定的：\n- 睡眠：$ t \\in [0, 8]\\,\\mathrm{h} $，$ \\varepsilon(t) = 300\\,\\mu\\varepsilon $。\n- 久坐工作：$ t \\in [8, 18]\\,\\mathrm{h} $，$ \\varepsilon(t) = 1000\\,\\mu\\varepsilon $。\n- 剧烈运动：$ t \\in [18, 20]\\,\\mathrm{h} $，$ \\varepsilon(t) = 4500\\,\\mu\\varepsilon $。\n- 晚间散步：$ t \\in [20, 24]\\,\\mathrm{h} $，$ \\varepsilon(t) = 2000\\,\\mu\\varepsilon $。\n\n定义每日净重塑信号为一天内激活函数的时间平均值，\n$$\n\\bar{a} = \\frac{1}{T}\\int_{0}^{T} a(\\varepsilon(t))\\,dt,\n$$\n该值为无量纲。利用上述约束条件，构建一个在所有阈值处连续的分段线性函数 $ a(\\varepsilon) $，并根据给定的时间表计算 $ \\bar{a} $。将最终数值结果四舍五入至四位有效数字。将最终量表示为一个无量纲数。",
            "solution": "力学稳态理论的约束指定了一个激活值为零的“懒惰区”，在该区域之外是线性斜坡，并在废用和过载阈值处达到平台期。我们分段构建 $ a(\\varepsilon) $ 以满足连续性和规定的平台期要求。\n\n对于低应变，我们设定\n$$\na(\\varepsilon) = -1 \\quad \\text{for} \\quad \\varepsilon \\le \\varepsilon_{\\mathrm{dis}}.\n$$\n在区间 $ (\\varepsilon_{\\mathrm{dis}}, \\varepsilon_{\\mathrm{lazy}}^{-}) $ 上，我们要求 $ a(\\varepsilon) $ 是线性和连续的，满足 $ a(\\varepsilon_{\\mathrm{dis}}) = -1 $ 和 $ a(\\varepsilon_{\\mathrm{lazy}}^{-}) = 0 $。一个合适的形式是\n$$\na(\\varepsilon) = -\\alpha\\left(\\varepsilon_{\\mathrm{lazy}}^{-} - \\varepsilon\\right), \\quad \\varepsilon \\in (\\varepsilon_{\\mathrm{dis}}, \\varepsilon_{\\mathrm{lazy}}^{-}),\n$$\n在 $ \\varepsilon_{\\mathrm{dis}} $ 处的连续性意味着\n$$\n- \\alpha\\left(\\varepsilon_{\\mathrm{lazy}}^{-} - \\varepsilon_{\\mathrm{dis}}\\right) = -1 \\quad \\Rightarrow \\quad \\alpha = \\frac{1}{\\varepsilon_{\\mathrm{lazy}}^{-} - \\varepsilon_{\\mathrm{dis}}}.\n$$\n\n对于懒惰区，\n$$\na(\\varepsilon) = 0 \\quad \\text{for} \\quad \\varepsilon \\in [\\varepsilon_{\\mathrm{lazy}}^{-}, \\varepsilon_{\\mathrm{lazy}}^{+}].\n$$\n\n对于高应变，我们设定\n$$\na(\\varepsilon) = +1 \\quad \\text{for} \\quad \\varepsilon \\ge \\varepsilon_{\\mathrm{over}}.\n$$\n在区间 $ (\\varepsilon_{\\mathrm{lazy}}^{+}, \\varepsilon_{\\mathrm{over}}) $ 上，我们要求 $ a(\\varepsilon) $ 是线性和连续的，满足 $ a(\\varepsilon_{\\mathrm{lazy}}^{+}) = 0 $ 和 $ a(\\varepsilon_{\\mathrm{over}}) = +1 $。一个合适的形式是\n$$\na(\\varepsilon) = \\beta\\left(\\varepsilon - \\varepsilon_{\\mathrm{lazy}}^{+}\\right), \\quad \\varepsilon \\in (\\varepsilon_{\\mathrm{lazy}}^{+}, \\varepsilon_{\\mathrm{over}}),\n$$\n在 $ \\varepsilon_{\\mathrm{over}} $ 处的连续性意味着\n$$\n\\beta\\left(\\varepsilon_{\\mathrm{over}} - \\varepsilon_{\\mathrm{lazy}}^{+}\\right) = 1 \\quad \\Rightarrow \\quad \\beta = \\frac{1}{\\varepsilon_{\\mathrm{over}} - \\varepsilon_{\\mathrm{lazy}}^{+}}.\n$$\n\n因此，激活函数在所有阈值处被完全确定且连续，其中\n$$\n\\alpha = \\frac{1}{\\varepsilon_{\\mathrm{lazy}}^{-} - \\varepsilon_{\\mathrm{dis}}} = \\frac{1}{800 - 500} = \\frac{1}{300}, \\qquad\n\\beta = \\frac{1}{\\varepsilon_{\\mathrm{over}} - \\varepsilon_{\\mathrm{lazy}}^{+}} = \\frac{1}{4000 - 1500} = \\frac{1}{2500}.\n$$\n\n现在我们为每个每日活动段计算 $ a(\\varepsilon(t)) $：\n\n1. 睡眠，$ t \\in [0, 8]\\,\\mathrm{h} $，$ \\varepsilon(t) = 300\\,\\mu\\varepsilon $。由于 $ \\varepsilon(t) \\le \\varepsilon_{\\mathrm{dis}} $，我们有\n$$\na(\\varepsilon(t)) = -1.\n$$\n\n2. 久坐工作，$ t \\in [8, 18]\\,\\mathrm{h} $，$ \\varepsilon(t) = 1000\\,\\mu\\varepsilon $。由于 $ \\varepsilon(t) \\in [\\varepsilon_{\\mathrm{lazy}}^{-}, \\varepsilon_{\\mathrm{lazy}}^{+}] $，我们有\n$$\na(\\varepsilon(t)) = 0.\n$$\n\n3. 剧烈运动，$ t \\in [18, 20]\\,\\mathrm{h} $，$ \\varepsilon(t) = 4500\\,\\mu\\varepsilon $。由于 $ \\varepsilon(t) \\ge \\varepsilon_{\\mathrm{over}} $，我们有\n$$\na(\\varepsilon(t)) = +1.\n$$\n\n4. 晚间散步，$ t \\in [20, 24]\\,\\mathrm{h} $，$ \\varepsilon(t) = 2000\\,\\mu\\varepsilon $。由于 $ \\varepsilon(t) \\in (\\varepsilon_{\\mathrm{lazy}}^{+}, \\varepsilon_{\\mathrm{over}}) $，我们有\n$$\na(\\varepsilon(t)) = \\beta\\left(\\varepsilon(t) - \\varepsilon_{\\mathrm{lazy}}^{+}\\right) = \\frac{1}{2500}\\left(2000 - 1500\\right) = \\frac{500}{2500} = 0.2.\n$$\n\n每日净重塑信号是时间平均值\n$$\n\\bar{a} = \\frac{1}{T}\\int_{0}^{T} a(\\varepsilon(t))\\,dt,\n$$\n对于分段恒定的 $ a(\\varepsilon(t)) $，这简化为按持续时间加权的平均值：\n$$\n\\bar{a} = \\frac{1}{24}\\Big[(-1)\\cdot 8 + 0 \\cdot 10 + (+1)\\cdot 2 + (0.2)\\cdot 4\\Big].\n$$\n计算括号内的和：\n$$\n(-1)\\cdot 8 = -8, \\quad 0 \\cdot 10 = 0, \\quad (+1)\\cdot 2 = 2, \\quad (0.2)\\cdot 4 = 0.8,\n$$\n所以\n$$\n\\bar{a} = \\frac{-8 + 0 + 2 + 0.8}{24} = \\frac{-5.2}{24} = -0.216\\overline{6}.\n$$\n\n四舍五入到四位有效数字，得到\n$$\n\\bar{a} \\approx -0.2167.\n$$\n\n根据定义，$ \\bar{a} $ 是一个无量纲的量。",
            "answer": "$$\\boxed{-0.2167}$$"
        },
        {
            "introduction": "应用力学适应理论的最后一步，通常是创建能够预测骨骼结构随时间变化的计算模型。这项练习将带您从理论走向实践，要求您基于力学阈值模型，实现一个基本的骨密度更新算法。通过编写代码执行单时间步更新并检查其物理合理性，您将亲身体验计算生物力学中的一项核心任务，并理解将生物学定律转化为稳定数值模拟时所面临的挑战 ()。",
            "id": "4161426",
            "problem": "考虑一个基于线性化力学稳定器公式的骨表观密度的力学生物学更新。设表观密度用 $\\rho$ 表示，单位为 $\\mathrm{kg/m^3}$。假设一个标量力学刺激 $S$，它是一个无量纲的应变度量，以及一个目标设定点 $S_0$（无量纲），使得重塑旨在减少偏差 $S - S_0$。设适应速率常数为 $\\kappa$，单位为 $\\mathrm{kg/(m^3 \\cdot s)}$，并设 $\\Delta t$ 为以秒为单位的时间步长。表观密度的物理边界指定为 $\\rho_{\\min}$ 和 $\\rho_{\\max}$，单位均为 $\\mathrm{kg/m^3}$，代表骨表观密度的实际下限和上限。\n\n从广为接受的力学稳定器理论出发，即骨重塑速率与力学刺激偏离稳态设定点的程度成正比（线性力学稳定器所描述的 Wolff 定律），通常用一个常微分方程（ODE）来模拟表观密度随时间的演化：$\\dfrac{d \\rho}{dt} \\propto S - S_0$。前向欧拉单步显式时间离散化导致以下形式的密度更新\n$$\n\\rho^{n+1} = \\rho^n + \\Delta t \\, \\kappa \\, (S^n - S_0).\n$$\n在此公式中，$\\rho^n$ 和 $S^n$ 分别表示时间步 $n$ 时的表观密度和刺激，而 $\\rho^{n+1}$ 表示下一步更新后的密度。\n\n你的任务是编写一个程序，对于一组给定的参数 $(\\rho^n, \\Delta t, \\kappa, S^n, S_0, \\rho_{\\min}, \\rho_{\\max})$，使用上述方程计算单步更新后的 $\\rho^{n+1}$，并评估更新后的密度是否违反物理边界，即 $\\rho^{n+1}  \\rho_{\\min}$ 或 $\\rho^{n+1} > \\rho_{\\max}$。将边界视为包含性的；因此，如果 $\\rho^{n+1}$ 恰好等于 $\\rho_{\\min}$ 或 $\\rho_{\\max}$，则不发生违规。程序不应限制或以其他方式更改 $\\rho^{n+1}$；它只应计算更新并报告是否违反了边界。\n\n所有密度均以 $\\mathrm{kg/m^3}$ 表示，时间步长以秒表示。力学刺激 $S$ 和设定点 $S_0$ 是无量纲应变。每个测试用例的最终更新密度值必须报告为四舍五入到三位小数的浮点数，违规评估报告为布尔值。\n\n实现你的程序以处理以下测试套件，这些测试套件旨在涵盖典型行为、边界交互、零步长行为和边缘条件：\n- 案例 1（在边界内的普遍稳定增长）：$\\rho^n = 1000.0\\,\\mathrm{kg/m^3}$, $\\Delta t = 86400\\,\\mathrm{s}$, $\\kappa = 0.02\\,\\mathrm{kg/(m^3 \\cdot s)}$, $S^n = 0.0020$, $S_0 = 0.0018$, $\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$, $\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$。\n- 案例 2（增长超过上限）：$\\rho^n = 1199.9\\,\\mathrm{kg/m^3}$, $\\Delta t = 86400\\,\\mathrm{s}$, $\\kappa = 0.05\\,\\mathrm{kg/(m^3 \\cdot s)}$, $S^n = 0.0022$, $S_0 = 0.0018$, $\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$, $\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$。\n- 案例 3（减少低于下限）：$\\rho^n = 300.5\\,\\mathrm{kg/m^3}$, $\\Delta t = 86400\\,\\mathrm{s}$, $\\kappa = 0.03\\,\\mathrm{kg/(m^3 \\cdot s)}$, $S^n = 0.0012$, $S_0 = 0.0018$, $\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$, $\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$。\n- 案例 4（零时间步长）：$\\rho^n = 800.0\\,\\mathrm{kg/m^3}$, $\\Delta t = 0\\,\\mathrm{s}$, $\\kappa = 0.02\\,\\mathrm{kg/(m^3 \\cdot s)}$, $S^n = 0.0030$, $S_0 = 0.0020$, $\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$, $\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$。\n- 案例 5（精确设定点，无变化）：$\\rho^n = 500.0\\,\\mathrm{kg/m^3}$, $\\Delta t = 86400\\,\\mathrm{s}$, $\\kappa = 0.10\\,\\mathrm{kg/(m^3 \\cdot s)}$, $S^n = 0.0020$, $S_0 = 0.0020$, $\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$, $\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$。\n- 案例 6（在下限附近适度减少但在限度内）：$\\rho^n = 305.0\\,\\mathrm{kg/m^3}$, $\\Delta t = 86400\\,\\mathrm{s}$, $\\kappa = 0.01\\,\\mathrm{kg/(m^3 \\cdot s)}$, $S^n = 0.0010$, $S_0 = 0.0018$, $\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$, $\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$。\n- 案例 7（达到上限精确值并有增加趋势）：$\\rho^n = 1200.0\\,\\mathrm{kg/m^3}$, $\\Delta t = 86400\\,\\mathrm{s}$, $\\kappa = 0.01\\,\\mathrm{kg/(m^3 \\cdot s)}$, $S^n = 0.0025$, $S_0 = 0.0020$, $\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$, $\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，并且本身是一个包含两个元素的列表：更新后的密度 $\\rho^{n+1}$（单位 $\\mathrm{kg/m^3}$，四舍五入到三位小数）和一个指示是否违反边界的布尔值。例如，最终输出格式应如下所示\n$$\n[\\,[\\rho^{n+1}_{\\text{case 1}}, \\text{violation}_{\\text{case 1}}], [\\rho^{n+1}_{\\text{case 2}}, \\text{violation}_{\\text{case 2}}], \\dots ].\n$$",
            "solution": "该问题已经过验证，被认为是合理的。它科学地基于骨力学生物学原理，特别是力学稳定器理论，并且信息完备、问题定义明确。\n\n任务是基于简化的线性力学稳定器模型，计算骨表观密度 $\\rho$ 在单个时间步长 $\\Delta t$ 内的变化。该模型形式化了 Wolff 定律的核心概念，该定律假定骨骼会根据其承受的机械载荷来调整其结构。\n\n其支配原则是骨密度变化率 $\\dfrac{d \\rho}{dt}$ 与当前力学刺激 $S$ 和稳态平衡刺激 $S_0$ 之间的差异成正比。正偏差 $S > S_0$ 表示超负荷状态，促使骨形成（$\\rho$ 增加）。相反，负偏差 $S  S_0$ 表示欠负荷，导致骨吸收（$\\rho$ 减少）。这种关系表示为一个简单的常微分方程（ODE）：\n$$\n\\frac{d \\rho}{dt} = \\kappa (S - S_0)\n$$\n其中 $\\kappa$ 是适应速率常数，决定了重塑反应的速度。$\\kappa$ 的单位是 $\\mathrm{kg/(m^3 \\cdot s)}$，确保了量纲的一致性，因为等式右边的量纲变为 $(\\mathrm{kg/(m^3 \\cdot s)}) \\cdot (\\text{无量纲}) = \\mathrm{kg/(m^3 \\cdot s)}$，这与 $\\dfrac{d \\rho}{dt}$ 的单位相匹配。\n\n为了数值求解这个常微分方程，我们采用前向欧拉法，这是一种单步显式时间积分方案。给定时间步 $n$ 的密度 $\\rho^n$ 和刺激 $S^n$，下一个时间步 $n+1$ 的密度 $\\rho^{n+1}$ 可近似为：\n$$\n\\rho^{n+1} \\approx \\rho^n + \\Delta t \\left. \\frac{d \\rho}{dt} \\right|_{t=t^n}\n$$\n代入模型的常微分方程，得到问题描述中提供的更新方程：\n$$\n\\rho^{n+1} = \\rho^n + \\Delta t \\, \\kappa \\, (S^n - S_0)\n$$\n\n分配任务的核心对每组给定的参数集包含两个部分：\n1.  **计算**：使用上述公式计算更新后的密度 $\\rho^{n+1}$。密度的结果需要四舍五入到三位小数。\n2.  **验证**：评估计算出的 $\\rho^{n+1}$ 是否落在指定的生理边界 $[\\rho_{\\min}, \\rho_{\\max}]$ 之外。当且仅当 $\\rho^{n+1}  \\rho_{\\min}$ 或 $\\rho^{n+1} > \\rho_{\\max}$ 时，发生违规。边界本身是包含性的。\n\n我们将通过应用此两步过程来处理每个测试用例。\n\n**案例 1**：$(\\rho^n = 1000.0, \\Delta t = 86400, \\kappa = 0.02, S^n = 0.0020, S_0 = 0.0018, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 1000.0 + 86400 \\cdot 0.02 \\cdot (0.0020 - 0.0018) = 1000.0 + 0.3456 = 1000.3456$。\n-   四舍五入后的 $\\rho^{n+1} = 1000.346$。\n-   违规检查：$300.0 \\le 1000.3456 \\le 1200.0$。这是真的。没有违规。\n\n**案例 2**：$(\\rho^n = 1199.9, \\Delta t = 86400, \\kappa = 0.05, S^n = 0.0022, S_0 = 0.0018, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 1199.9 + 86400 \\cdot 0.05 \\cdot (0.0022 - 0.0018) = 1199.9 + 1.728 = 1201.628$。\n-   四舍五入后的 $\\rho^{n+1} = 1201.628$。\n-   违规检查：$1201.628 > 1200.0$。因此发生违规。\n\n**案例 3**：$(\\rho^n = 300.5, \\Delta t = 86400, \\kappa = 0.03, S^n = 0.0012, S_0 = 0.0018, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 300.5 + 86400 \\cdot 0.03 \\cdot (0.0012 - 0.0018) = 300.5 - 1.5552 = 298.9448$。\n-   四舍五入后的 $\\rho^{n+1} = 298.945$。\n-   违规检查：$298.9448  300.0$。因此发生违规。\n\n**案例 4**：$(\\rho^n = 800.0, \\Delta t = 0, \\kappa = 0.02, S^n = 0.0030, S_0 = 0.0020, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 800.0 + 0 \\cdot 0.02 \\cdot (0.0030 - 0.0020) = 800.0$。\n-   四舍五入后的 $\\rho^{n+1} = 800.000$。\n-   违规检查：$300.0 \\le 800.0 \\le 1200.0$。这是真的。没有违规。\n\n**案例 5**：$(\\rho^n = 500.0, \\Delta t = 86400, \\kappa = 0.10, S^n = 0.0020, S_0 = 0.0020, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 500.0 + 86400 \\cdot 0.10 \\cdot (0.0020 - 0.0020) = 500.0$。\n-   四舍五入后的 $\\rho^{n+1} = 500.000$。\n-   违规检查：$300.0 \\le 500.0 \\le 1200.0$。这是真的。没有违规。\n\n**案例 6**：$(\\rho^n = 305.0, \\Delta t = 86400, \\kappa = 0.01, S^n = 0.0010, S_0 = 0.0018, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 305.0 + 86400 \\cdot 0.01 \\cdot (0.0010 - 0.0018) = 305.0 - 0.6912 = 304.3088$。\n-   四舍五入后的 $\\rho^{n+1} = 304.309$。\n-   违规检查：$300.0 \\le 304.3088 \\le 1200.0$。这是真的。没有违规。\n\n**案例 7**：$(\\rho^n = 1200.0, \\Delta t = 86400, \\kappa = 0.01, S^n = 0.0025, S_0 = 0.0020, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 1200.0 + 86400 \\cdot 0.01 \\cdot (0.0025 - 0.0020) = 1200.0 + 0.432 = 1200.432$。\n-   四舍五入后的 $\\rho^{n+1} = 1200.432$。\n-   违规检查：$1200.432 > 1200.0$。因此发生违规。\n\n这些计算将在提供的 Python 环境中实现，以生成最终输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes single-step updates of bone apparent density using a linearized\n    mechanostat model and checks for physical bound violations.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (rho_n, dt, kappa, S_n, S_0, rho_min, rho_max)\n    test_cases = [\n        (1000.0, 86400.0, 0.02, 0.0020, 0.0018, 300.0, 1200.0), # Case 1\n        (1199.9, 86400.0, 0.05, 0.0022, 0.0018, 300.0, 1200.0), # Case 2\n        (300.5, 86400.0, 0.03, 0.0012, 0.0018, 300.0, 1200.0), # Case 3\n        (800.0, 0.0, 0.02, 0.0030, 0.0020, 300.0, 1200.0),     # Case 4\n        (500.0, 86400.0, 0.10, 0.0020, 0.0020, 300.0, 1200.0), # Case 5\n        (305.0, 86400.0, 0.01, 0.0010, 0.0018, 300.0, 1200.0), # Case 6\n        (1200.0, 86400.0, 0.01, 0.0025, 0.0020, 300.0, 1200.0)  # Case 7\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        rho_n, dt, kappa, S_n, S_0, rho_min, rho_max = case\n\n        # Compute the updated density using the forward Euler update rule\n        # rho_{n+1} = rho_n + dt * kappa * (S_n - S_0)\n        rho_np1_raw = rho_n + dt * kappa * (S_n - S_0)\n\n        # Check for violation of physical bounds.\n        # Violation occurs if rho_{n+1} is strictly outside the [rho_min, rho_max] range.\n        violation = (rho_np1_raw  rho_min) or (rho_np1_raw  rho_max)\n\n        # Round the resulting density to three decimal places, as specified.\n        rho_np1_rounded = round(rho_np1_raw, 3)\n        \n        # Store the result pair (rounded density, violation status)\n        result = [rho_np1_rounded, violation]\n        results.append(result)\n\n    # The final print statement must follow the exact specified format.\n    # The template produces a string representation of a list of lists,\n    # e.g., \"[[val1, bool1],[val2, bool2]]\"\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}