{
    "hands_on_practices": [
        {
            "introduction": "要应用力学适应原理，我们首先需要一种量化力学刺激的方法。应变能密度代表了储存在变形材料中的能量，是该刺激的一个强大且物理基础坚实的候选指标。本练习将指导您根据给定的应力张量 ($\\boldsymbol{\\sigma}$) 和应变张量 ($\\boldsymbol{\\varepsilon}$) 计算应变能密度，这是一项将抽象的机械载荷转化为具体生物信号的基础技能。",
            "id": "4161422",
            "problem": "考虑一个正在经历无穷小变形的皮质骨小体积元。设对称柯西应力张量用 $\\boldsymbol{\\sigma}$ 表示，对称小应变张量用 $\\boldsymbol{\\varepsilon}$ 表示。在线性弹性的小应变框架下，内功率密度由应力与应变率的功共轭对给出，而储存在材料中的应变能密度 $U$ 是通过将内功率密度从参考状态到当前状态沿可逆加载路径积分得到的。该能量密度可作为骨力学适应中一种有物理基础的力学传感信号，这与 Wolff 定律和力学稳态理论一致，在这些理论中，通常使用经质量密度归一化的类能量刺激信号来比较不同组织区域。\n\n从单位体积内功率密度的基本定义 $p_{\\text{int}}=\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\varepsilon}}$ 和具有恒定四阶刚度张量的线性弹性假设出发，推导在当前状态 $(\\boldsymbol{\\sigma},\\boldsymbol{\\varepsilon})$ 下储存的应变能密度 $U$ 的表达式。然后，使用下面的数值张量，计算 $U$ 和经质量归一化的重塑信号 $S=U/\\rho$。\n\n当前状态的应力张量和应变张量为\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n60  12  0 \\\\\n12  45  5 \\\\\n0  5  30\n\\end{pmatrix}\\ \\text{MPa},\\qquad\n\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\n900  300  0 \\\\\n300  600  150 \\\\\n0  150  400\n\\end{pmatrix}\\ \\mu\\text{strain},\n$$\n其中 $\\boldsymbol{\\varepsilon}$ 的分量是小应变张量的真实分量（无量纲），以微应变（$1\\ \\mu\\text{strain}=10^{-6}$）表示，而非工程剪切应变。取质量密度为\n$$\n\\rho=1900\\ \\text{kg}\\,\\text{m}^{-3}.\n$$\n使用标准的双点积 $\\,\\boldsymbol{A}:\\boldsymbol{B}=\\sum_{i=1}^{3}\\sum_{j=1}^{3}A_{ij}B_{ij}\\,$ 并仔细处理单位换算。以焦耳每千克（J kg$^{-1}$）为单位报告最终的归一化刺激信号 $S$。将 $S$ 的最终值四舍五入至四位有效数字。",
            "solution": "任务的第一部分是推导线性弹性材料储存的应变能密度 $U$ 的表达式。应变能密度是将材料从无应力、无应变的参考状态变形到应变为 $\\boldsymbol{\\varepsilon}$、应力为 $\\boldsymbol{\\sigma}$ 的最终状态所做的单位体积功。在无穷小应变增量 $d\\boldsymbol{\\varepsilon}'$ 上，由应力张量 $\\boldsymbol{\\sigma}'$ 所做的单位体积功增量 $dU$ 由 $dU = \\boldsymbol{\\sigma}':d\\boldsymbol{\\varepsilon}'$ 给出。将其从参考状态 $(\\boldsymbol{\\sigma}'=\\mathbf{0}, \\boldsymbol{\\varepsilon}'=\\mathbf{0})$ 积分到最终状态 $(\\boldsymbol{\\sigma}, \\boldsymbol{\\varepsilon})$，即可得到总应变能密度：\n$$\nU = \\int_{\\mathbf{0}}^{\\boldsymbol{\\varepsilon}} \\boldsymbol{\\sigma}':d\\boldsymbol{\\varepsilon}'\n$$\n对于线性弹性材料，应力与应变成线性比例关系，由关系式 $\\boldsymbol{\\sigma} = \\boldsymbol{C}:\\boldsymbol{\\varepsilon}$ 描述，其中 $\\boldsymbol{C}$ 是恒定的四阶刚度张量。对于此类材料，应变能密度是一个状态函数，仅取决于最终的应变状态，而与所采取的加载路径无关。因此，我们可以选择一个简单的比例加载路径来计算该积分。设路径由一个从 $0$ 变化到 $1$ 的标量 $\\lambda$ 参数化。\n$$\n\\boldsymbol{\\varepsilon}'(\\lambda) = \\lambda\\boldsymbol{\\varepsilon} \\quad \\text{for } \\lambda \\in [0, 1]\n$$\n由于线性弹性，沿此路径对应的应力为：\n$$\n\\boldsymbol{\\sigma}'(\\lambda) = \\boldsymbol{C}:\\boldsymbol{\\varepsilon}'(\\lambda) = \\boldsymbol{C}:(\\lambda\\boldsymbol{\\varepsilon}) = \\lambda(\\boldsymbol{C}:\\boldsymbol{\\varepsilon}) = \\lambda\\boldsymbol{\\sigma}\n$$\n其中 $\\boldsymbol{\\sigma}$ 是最终状态的应力。沿此路径的应变微分为 $d\\boldsymbol{\\varepsilon}'(\\lambda) = \\boldsymbol{\\varepsilon}\\,d\\lambda$。将这些表达式代入 $U$ 的积分中：\n$$\nU = \\int_{0}^{1} \\boldsymbol{\\sigma}'(\\lambda):d\\boldsymbol{\\varepsilon}'(\\lambda) = \\int_{0}^{1} (\\lambda\\boldsymbol{\\sigma}):(\\boldsymbol{\\varepsilon}\\,d\\lambda)\n$$\n由于双点积是线性运算，且 $\\boldsymbol{\\sigma}$ 和 $\\boldsymbol{\\varepsilon}$ 相对于积分变量 $\\lambda$ 是常数，我们可以写出：\n$$\nU = (\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}) \\int_{0}^{1} \\lambda\\,d\\lambda\n$$\n计算这个简单的积分得到：\n$$\nU = (\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}) \\left[ \\frac{\\lambda^2}{2} \\right]_{0}^{1} = (\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}) \\left( \\frac{1^2}{2} - \\frac{0^2}{2} \\right) = \\frac{1}{2}\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\n$$\n这就是线性弹性材料中应变能密度的推导表达式。\n\n任务的第二部分是使用提供的数值数据计算 $U$ 和归一化重塑信号 $S = U/\\rho$。\n$U$ 的公式为 $U = \\frac{1}{2}\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\sum_{i=1}^{3}\\sum_{j=1}^{3}\\sigma_{ij}\\varepsilon_{ij}$。\n应力张量的单位是兆帕（MPa），应变张量的单位是微应变（$\\mu$strain）。我们必须确保计算中单位的一致性。\n$1\\ \\text{MPa} = 10^{6}\\ \\text{Pa} = 10^{6}\\ \\text{N}\\,\\text{m}^{-2}$。\n$1\\ \\mu\\text{strain} = 10^{-6}$。应变是无量纲量。\n应力与应变的乘积 $\\sigma_{ij}\\varepsilon_{ij}$ 的单位将是帕斯卡（$\\text{N}\\,\\text{m}^{-2}$），这等同于焦耳每立方米（$\\text{J}\\,\\text{m}^{-3}$），是能量密度的正确单位。\n设 $\\sigma_{ij}^{\\text{num}}$ 和 $\\varepsilon_{ij}^{\\text{num}}$ 为矩阵中提供的数值。\n$$\n\\sigma_{ij}\\varepsilon_{ij} = (\\sigma_{ij}^{\\text{num}} \\times 10^{6}\\ \\text{Pa}) \\times (\\varepsilon_{ij}^{\\text{num}} \\times 10^{-6}) = \\sigma_{ij}^{\\text{num}}\\varepsilon_{ij}^{\\text{num}}\\ \\text{Pa} = \\sigma_{ij}^{\\text{num}}\\varepsilon_{ij}^{\\text{num}}\\ \\text{J}\\,\\text{m}^{-3}\n$$\n$10^{6}$ 和 $10^{-6}$ 的因子相互抵消，因此我们可以直接将给定的数值分量相乘，$\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}$ 的结果单位将是 $\\text{J}\\,\\text{m}^{-3}$。\n\n给定的张量是：\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n60  12  0 \\\\\n12  45  5 \\\\\n0  5  30\n\\end{pmatrix},\\qquad\n\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\n900  300  0 \\\\\n300  600  150 \\\\\n0  150  400\n\\end{pmatrix}\n$$\n双点积计算如下：\n$$\n\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = \\sigma_{11}\\varepsilon_{11} + \\sigma_{12}\\varepsilon_{12} + \\sigma_{13}\\varepsilon_{13} + \\sigma_{21}\\varepsilon_{21} + \\sigma_{22}\\varepsilon_{22} + \\sigma_{23}\\varepsilon_{23} + \\sigma_{31}\\varepsilon_{31} + \\sigma_{32}\\varepsilon_{32} + \\sigma_{33}\\varepsilon_{33}\n$$\n代入数值（结果的单位将是 $\\text{J}\\,\\text{m}^{-3}$）：\n$$\n\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = (60)(900) + (12)(300) + (0)(0) + (12)(300) + (45)(600) + (5)(150) + (0)(0) + (5)(150) + (30)(400)\n$$\n$$\n\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = 54000 + 3600 + 0 + 3600 + 27000 + 750 + 0 + 750 + 12000\n$$\n$$\n\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = 101700\\ \\text{J}\\,\\text{m}^{-3}\n$$\n现在我们可以计算应变能密度 $U$：\n$$\nU = \\frac{1}{2}\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = \\frac{1}{2} (101700\\ \\text{J}\\,\\text{m}^{-3}) = 50850\\ \\text{J}\\,\\text{m}^{-3}\n$$\n最后，我们计算经质量归一化的重塑信号 $S = U/\\rho$。给定的质量密度为 $\\rho=1900\\ \\text{kg}\\,\\text{m}^{-3}$。\n$$\nS = \\frac{U}{\\rho} = \\frac{50850\\ \\text{J}\\,\\text{m}^{-3}}{1900\\ \\text{kg}\\,\\text{m}^{-3}} = \\frac{5085}{190}\\ \\text{J}\\,\\text{kg}^{-1} \\approx 26.763157...\\ \\text{J}\\,\\textkg^{-1}\n$$\n题目要求将最终答案四舍五入到四位有效数字。\n第五位有效数字是 $3$，因此我们向下舍入。\n$$\nS \\approx 26.76\\ \\text{J}\\,\\text{kg}^{-1}\n$$",
            "answer": "$$\n\\boxed{26.76}\n$$"
        },
        {
            "introduction": "单一的刺激值只能说明部分问题。力学稳态理论假定，骨细胞会对全天的载荷谱作出反应，忽略“惰性区”($lazy\\,zone$)内的微小波动，但对废用或过载反应强烈。本练习将挑战您通过构建一个激活函数并将其在一个假设的每日应变计划上进行积分来模拟这种复杂的逻辑，从而揭示24小时周期内的净重塑信号。",
            "id": "4161488",
            "problem": "骨骼在一天内的承重环境可以用一个随时间变化的应变幅值函数 $ \\varepsilon(t) $ 来描述，单位为微应变（$\\mu\\varepsilon$）。根据沃尔夫定律（Wolff's Law）和力学稳态理论（mechanostat theory），骨细胞信号传导驱动净重塑，以将应变恢复到稳态的“懒区”（lazy zone），其中废用会引起净吸收，而过用会引起净形成。为将其形式化，我们考虑一个标量激活函数 $ a(\\varepsilon) $，它根据源自力学稳态理论的以下力学生物学约束来编码净重塑驱动：\n1. 在懒区内，$ \\varepsilon \\in [\\varepsilon_{\\mathrm{lazy}}^{-}, \\varepsilon_{\\mathrm{lazy}}^{+}] $，净驱动为零：骨骼目标是维持现状，此时 $ a(\\varepsilon) = 0 $。\n2. 对于低应变（低于 $ \\varepsilon_{\\mathrm{lazy}}^{-} $），驱动为负，其绝对值随 $ \\varepsilon $ 的减小而增大，并在废用阈值 $ \\varepsilon_{\\mathrm{dis}} $ 处达到一个负平台。假设当 $ \\varepsilon \\le \\varepsilon_{\\mathrm{dis}} $ 时 $ a(\\varepsilon) = -1 $，并且 $ a(\\varepsilon) $ 在区间 $ (\\varepsilon_{\\mathrm{dis}}, \\varepsilon_{\\mathrm{lazy}}^{-}) $ 上线性变化，且在端点处连续。\n3. 对于高应变（高于 $ \\varepsilon_{\\mathrm{lazy}}^{+} $），驱动为正，线性增加至过载阈值 $ \\varepsilon_{\\mathrm{over}} $，超过该阈值后达到一个正平台。假设当 $ \\varepsilon \\ge \\varepsilon_{\\mathrm{over}} $ 时 $ a(\\varepsilon) = +1 $，并且 $ a(\\varepsilon) $ 在区间 $ (\\varepsilon_{\\mathrm{lazy}}^{+}, \\varepsilon_{\\mathrm{over}}) $ 上线性变化，且在端点处连续。\n\n给定阈值为\n$ \\varepsilon_{\\mathrm{dis}} = 500\\,\\mu\\varepsilon $，$ \\varepsilon_{\\mathrm{lazy}}^{-} = 800\\,\\mu\\varepsilon $，$ \\varepsilon_{\\mathrm{lazy}}^{+} = 1500\\,\\mu\\varepsilon $，以及 $ \\varepsilon_{\\mathrm{over}} = 4000\\,\\mu\\varepsilon $。\n\n每日应变计划在 $ T = 24\\,\\mathrm{h} $ 内是分段常数：\n- 睡眠：$ t \\in [0, 8]\\,\\mathrm{h} $，$ \\varepsilon(t) = 300\\,\\mu\\varepsilon $。\n- 久坐工作：$ t \\in [8, 18]\\,\\mathrm{h} $，$ \\varepsilon(t) = 1000\\,\\mu\\varepsilon $。\n- 剧烈运动：$ t \\in [18, 20]\\,\\mathrm{h} $，$ \\varepsilon(t) = 4500\\,\\mu\\varepsilon $。\n- 晚间散步：$ t \\in [20, 24]\\,\\mathrm{h} $，$ \\varepsilon(t) = 2000\\,\\mu\\varepsilon $。\n\n定义每日净重塑信号为一天内激活函数的时间平均值，\n$$\n\\bar{a} = \\frac{1}{T}\\int_{0}^{T} a(\\varepsilon(t))\\,dt,\n$$\n该值为无量纲。使用以上约束，构建一个在所有阈值处都连续的分段线性函数 $ a(\\varepsilon) $，并计算给定计划下的 $ \\bar{a} $。将最终数值答案四舍五入到四位有效数字。将最终量表示为无量纲数。",
            "solution": "力学稳态理论的约束指定了一个激活为零的“懒区”，在该区域之外是线性斜坡，并在废用和过载阈值处达到平台。我们分段构建 $ a(\\varepsilon) $ 以满足连续性和指定的平台。\n\n对于低应变，我们施加\n$$\na(\\varepsilon) = -1 \\quad \\text{当} \\quad \\varepsilon \\le \\varepsilon_{\\mathrm{dis}} \\text{时}.\n$$\n在区间 $ (\\varepsilon_{\\mathrm{dis}}, \\varepsilon_{\\mathrm{lazy}}^{-}) $ 上，我们要求 $ a(\\varepsilon) $ 是线性和连续的，且 $ a(\\varepsilon_{\\mathrm{dis}}) = -1 $ 和 $ a(\\varepsilon_{\\mathrm{lazy}}^{-}) = 0 $。一个合适的形式是\n$$\na(\\varepsilon) = -\\alpha\\left(\\varepsilon_{\\mathrm{lazy}}^{-} - \\varepsilon\\right), \\quad \\varepsilon \\in (\\varepsilon_{\\mathrm{dis}}, \\varepsilon_{\\mathrm{lazy}}^{-}),\n$$\n在 $ \\varepsilon_{\\mathrm{dis}} $ 处的连续性意味着\n$$\n- \\alpha\\left(\\varepsilon_{\\mathrm{lazy}}^{-} - \\varepsilon_{\\mathrm{dis}}\\right) = -1 \\quad \\Rightarrow \\quad \\alpha = \\frac{1}{\\varepsilon_{\\mathrm{lazy}}^{-} - \\varepsilon_{\\mathrm{dis}}}.\n$$\n\n对于懒区，\n$$\na(\\varepsilon) = 0 \\quad \\text{当} \\quad \\varepsilon \\in [\\varepsilon_{\\mathrm{lazy}}^{-}, \\varepsilon_{\\mathrm{lazy}}^{+}] \\text{时}.\n$$\n\n对于高应变，我们施加\n$$\na(\\varepsilon) = +1 \\quad \\text{当} \\quad \\varepsilon \\ge \\varepsilon_{\\mathrm{over}} \\text{时}.\n$$\n在区间 $ (\\varepsilon_{\\mathrm{lazy}}^{+}, \\varepsilon_{\\mathrm{over}}) $ 上，我们要求 $ a(\\varepsilon) $ 是线性和连续的，且 $ a(\\varepsilon_{\\mathrm{lazy}}^{+}) = 0 $ 和 $ a(\\varepsilon_{\\mathrm{over}}) = +1 $。一个合适的形式是\n$$\na(\\varepsilon) = \\beta\\left(\\varepsilon - \\varepsilon_{\\mathrm{lazy}}^{+}\\right), \\quad \\varepsilon \\in (\\varepsilon_{\\mathrm{lazy}}^{+}, \\varepsilon_{\\mathrm{over}}),\n$$\n在 $ \\varepsilon_{\\mathrm{over}} $ 处的连续性意味着\n$$\n\\beta\\left(\\varepsilon_{\\mathrm{over}} - \\varepsilon_{\\mathrm{lazy}}^{+}\\right) = 1 \\quad \\Rightarrow \\quad \\beta = \\frac{1}{\\varepsilon_{\\mathrm{over}} - \\varepsilon_{\\mathrm{lazy}}^{+}}.\n$$\n\n因此，激活函数在所有阈值处都是完全确定和连续的，其中\n$$\n\\alpha = \\frac{1}{\\varepsilon_{\\mathrm{lazy}}^{-} - \\varepsilon_{\\mathrm{dis}}} = \\frac{1}{800 - 500} = \\frac{1}{300}, \\qquad\n\\beta = \\frac{1}{\\varepsilon_{\\mathrm{over}} - \\varepsilon_{\\mathrm{lazy}}^{+}} = \\frac{1}{4000 - 1500} = \\frac{1}{2500}.\n$$\n\n我们现在为每个每日活动分段评估 $ a(\\varepsilon(t)) $：\n\n1. 睡眠，$ t \\in [0, 8]\\,\\mathrm{h} $，$ \\varepsilon(t) = 300\\,\\mu\\varepsilon $。由于 $ \\varepsilon(t) \\le \\varepsilon_{\\mathrm{dis}} $，我们有\n$$\na(\\varepsilon(t)) = -1.\n$$\n\n2. 久坐工作，$ t \\in [8, 18]\\,\\mathrm{h} $，$ \\varepsilon(t) = 1000\\,\\mu\\varepsilon $。由于 $ \\varepsilon(t) \\in [\\varepsilon_{\\mathrm{lazy}}^{-}, \\varepsilon_{\\mathrm{lazy}}^{+}] $，我们有\n$$\na(\\varepsilon(t)) = 0.\n$$\n\n3. 剧烈运动，$ t \\in [18, 20]\\,\\mathrm{h} $，$ \\varepsilon(t) = 4500\\,\\mu\\varepsilon $。由于 $ \\varepsilon(t) \\ge \\varepsilon_{\\mathrm{over}} $，我们有\n$$\na(\\varepsilon(t)) = +1.\n$$\n\n4. 晚间散步，$ t \\in [20, 24]\\,\\mathrm{h} $，$ \\varepsilon(t) = 2000\\,\\mu\\varepsilon $。由于 $ \\varepsilon(t) \\in (\\varepsilon_{\\mathrm{lazy}}^{+}, \\varepsilon_{\\mathrm{over}}) $，我们有\n$$\na(\\varepsilon(t)) = \\beta\\left(\\varepsilon(t) - \\varepsilon_{\\mathrm{lazy}}^{+}\\right) = \\frac{1}{2500}\\left(2000 - 1500\\right) = \\frac{500}{2500} = 0.2.\n$$\n\n每日净重塑信号是时间平均值\n$$\n\\bar{a} = \\frac{1}{T}\\int_{0}^{T} a(\\varepsilon(t))\\,dt,\n$$\n对于分段常数的 $ a(\\varepsilon(t)) $，这简化为时长加权平均：\n$$\n\\bar{a} = \\frac{1}{24}\\Big[(-1)\\cdot 8 + 0 \\cdot 10 + (+1)\\cdot 2 + (0.2)\\cdot 4\\Big].\n$$\n计算方括号内的总和：\n$$\n(-1)\\cdot 8 = -8, \\quad 0 \\cdot 10 = 0, \\quad (+1)\\cdot 2 = 2, \\quad (0.2)\\cdot 4 = 0.8,\n$$\n所以\n$$\n\\bar{a} = \\frac{-8 + 0 + 2 + 0.8}{24} = \\frac{-5.2}{24} = -0.216\\overline{6}.\n$$\n\n四舍五入到四位有效数字，得到\n$$\n\\bar{a} \\approx -0.2167.\n$$\n\n如定义所示，量 $ \\bar{a} $ 是无量纲的。",
            "answer": "$$\\boxed{-0.2167}$$"
        },
        {
            "introduction": "骨骼适应的理论模型，如 $\\frac{d\\rho}{dt} = \\kappa(S - S_0)$，在计算机模拟中实现时才获得其预测能力。这最后一个练习将引导您从理论走向计算，要求您基于线性力学稳态模型，实现一个单时间步的密度更新。通过应用前向欧拉格式，您不仅将预测骨密度的变化，还将直面数值模拟的一个关键问题：确保计算结果保持在物理现实的范围内。",
            "id": "4161426",
            "problem": "考虑一个基于线性化力学稳态 (mechanostat) 公式的骨表观密度力学生物学更新。设表观密度用 $\\rho$ 表示，单位为 $\\mathrm{kg/m^3}$。假设一个标量机械刺激 $S$ 是一个无量纲的应变度量，以及一个目标设定点 $S_0$（无量纲），重塑的目标是减少偏差 $S - S_0$。设适应速率常数为 $\\kappa$，单位为 $\\mathrm{kg/(m^3 \\cdot s)}$，并设 $\\Delta t$ 是以秒为单位的时间步长。表观密度的物理界限指定为 $\\rho_{\\min}$ 和 $\\rho_{\\max}$，单位均为 $\\mathrm{kg/m^3}$，代表骨表观密度的实际下限和上限。\n\n从广为接受的力学稳态理论出发，骨重塑速率与机械刺激偏离稳态设定点的程度成正比（由线性力学稳态所捕捉的 Wolff 定律），通常通过一个常微分方程 (ODE) 来模拟表观密度的时间演化：$\\dfrac{d \\rho}{dt} \\propto S - S_0$。前向欧拉单步显式时间离散化导出了以下形式的密度更新：\n$$\n\\rho^{n+1} = \\rho^n + \\Delta t \\, \\kappa \\, (S^n - S_0).\n$$\n在此公式中，$\\rho^n$ 和 $S^n$ 分别表示时间步 $n$ 处的表观密度和刺激，而 $\\rho^{n+1}$ 表示下一步更新后的密度。\n\n您的任务是编写一个程序，对于一组给定的参数 $(\\rho^n, \\Delta t, \\kappa, S^n, S_0, \\rho_{\\min}, \\rho_{\\max})$，使用上述方程计算单步更新 $\\rho^{n+1}$，并评估更新后的密度是否违反物理界限，即 $\\rho^{n+1}  \\rho_{\\min}$ 或 $\\rho^{n+1} > \\rho_{\\max}$。将界限视为包含性的；因此，如果 $\\rho^{n+1}$ 恰好等于 $\\rho_{\\min}$ 或 $\\rho_{\\max}$，则不发生违反。程序不应限制或以其他方式更改 $\\rho^{n+1}$；它只应计算更新并报告是否违反了界限。\n\n所有密度以 $\\mathrm{kg/m^3}$ 表示，时间步以秒表示。机械刺激 $S$ 和设定点 $S_0$ 是无量纲应变。每个测试用例的最终更新密度值必须报告为四舍五入到三位小数的浮点数，而违反评估则报告为布尔值。\n\n实现您的程序以处理以下测试套件，该套件旨在覆盖典型行为、边界交互、零步长行为和边缘条件：\n- 案例1（界限内的一般稳定增加）：$\\rho^n = 1000.0\\,\\mathrm{kg/m^3}$，$\\Delta t = 86400\\,\\mathrm{s}$，$\\kappa = 0.02\\,\\mathrm{kg/(m^3 \\cdot s)}$，$S^n = 0.0020$，$S_0 = 0.0018$，$\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$，$\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$。\n- 案例2（增加导致超过上限）：$\\rho^n = 1199.9\\,\\mathrm{kg/m^3}$，$\\Delta t = 86400\\,\\mathrm{s}$，$\\kappa = 0.05\\,\\mathrm{kg/(m^3 \\cdot s)}$，$S^n = 0.0022$，$S_0 = 0.0018$，$\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$，$\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$。\n- 案例3（减少导致低于下限）：$\\rho^n = 300.5\\,\\mathrm{kg/m^3}$，$\\Delta t = 86400\\,\\mathrm{s}$，$\\kappa = 0.03\\,\\mathrm{kg/(m^3 \\cdot s)}$，$S^n = 0.0012$，$S_0 = 0.0018$，$\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$，$\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$。\n- 案例4（零时间步长）：$\\rho^n = 800.0\\,\\mathrm{kg/m^3}$，$\\Delta t = 0\\,\\mathrm{s}$，$\\kappa = 0.02\\,\\mathrm{kg/(m^3 \\cdot s)}$，$S^n = 0.0030$，$S_0 = 0.0020$，$\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$，$\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$。\n- 案例5（精确设定点，无变化）：$\\rho^n = 500.0\\,\\mathrm{kg/m^3}$，$\\Delta t = 86400\\,\\mathrm{s}$，$\\kappa = 0.10\\,\\mathrm{kg/(m^3 \\cdot s)}$，$S^n = 0.0020$，$S_0 = 0.0020$，$\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$，$\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$。\n- 案例6（接近下限但仍在限制内的适度减少）：$\\rho^n = 305.0\\,\\mathrm{kg/m^3}$，$\\Delta t = 86400\\,\\mathrm{s}$，$\\kappa = 0.01\\,\\mathrm{kg/(m^3 \\cdot s)}$，$S^n = 0.0010$，$S_0 = 0.0018$，$\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$，$\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$。\n- 案例7（达到上限精确值且有增加趋势）：$\\rho^n = 1200.0\\,\\mathrm{kg/m^3}$，$\\Delta t = 86400\\,\\mathrm{s}$，$\\kappa = 0.01\\,\\mathrm{kg/(m^3 \\cdot s)}$，$S^n = 0.0025$，$S_0 = 0.0020$，$\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$，$\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个测试用例，并且本身是一个包含两个元素的列表：更新后的密度 $\\rho^{n+1}$（单位为 $\\mathrm{kg/m^3}$，四舍五入到三位小数）和一个指示是否违反界限的布尔值。例如，最终输出格式应如下所示\n$$\n[\\,[\\rho^{n+1}_{\\text{case 1}}, \\text{violation}_{\\text{case 1}}], [\\rho^{n+1}_{\\text{case 2}}, \\text{violation}_{\\text{case 2}}], \\dots ].\n$$",
            "solution": "该问题已经过验证，被认为是合理的。它科学地植根于骨生物力学的原理，特别是力学稳态理论，并且定义明确，提供了所有必要的信息。\n\n任务是基于一个简化的线性力学稳态模型，计算骨表观密度 $\\rho$ 在单个时间步长 $\\Delta t$ 内的变化。该模型形式化了 Wolff 定律的核心概念，该定律假定骨骼会根据其承受的机械载荷来调整其结构。\n\n其支配原则是骨密度变化率 $\\dfrac{d \\rho}{dt}$ 与当前机械刺激 $S$ 和稳态平衡刺激 $S_0$ 之间的差异成正比。正偏差 $S > S_0$ 表示超载状态，促使骨生成（$\\rho$ 增加）。相反，负偏差 $S  S_0$ 表示欠载，导致骨吸收（$\\rho$ 减少）。这种关系表示为一个简单的常微分方程 (ODE)：\n$$\n\\frac{d \\rho}{dt} = \\kappa (S - S_0)\n$$\n其中 $\\kappa$ 是适应速率常数，决定了重塑响应的速度。$\\kappa$ 的单位是 $\\mathrm{kg/(m^3 \\cdot s)}$，确保了量纲一致性，因为右侧变为 $(\\mathrm{kg/(m^3 \\cdot s)}) \\cdot (\\text{无量纲}) = \\mathrm{kg/(m^3 \\cdot s)}$，这与 $\\dfrac{d \\rho}{dt}$ 的单位相匹配。\n\n为了数值求解这个常微分方程，我们采用前向欧拉法，这是一种单步显式时间积分方案。给定时间步 $n$ 的密度 $\\rho^n$ 和刺激 $S^n$，下一个时间步的密度 $\\rho^{n+1}$ 可近似为：\n$$\n\\rho^{n+1} \\approx \\rho^n + \\Delta t \\left. \\frac{d \\rho}{dt} \\right|_{t=t^n}\n$$\n代入模型的常微分方程，得到问题陈述中提供的更新方程：\n$$\n\\rho^{n+1} = \\rho^n + \\Delta t \\, \\kappa \\, (S^n - S_0)\n$$\n\n所分配任务的核心对于每组给定的参数集都包含两个部分：\n1.  **计算**：使用上述公式计算更新后的密度 $\\rho^{n+1}$。密度的结果需要四舍五入到三位小数。\n2.  **验证**：评估计算出的 $\\rho^{n+1}$ 是否落在指定的生理界限 $[\\rho_{\\min}, \\rho_{\\max}]$ 之外。当且仅当 $\\rho^{n+1}  \\rho_{\\min}$ 或 $\\rho^{n+1} > \\rho_{\\max}$ 时，发生违反。界限本身是包含性的。\n\n我们将通过应用此两步过程来处理每个测试用例。\n\n**案例1**：$(\\rho^n = 1000.0, \\Delta t = 86400, \\kappa = 0.02, S^n = 0.0020, S_0 = 0.0018, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 1000.0 + 86400 \\cdot 0.02 \\cdot (0.0020 - 0.0018) = 1000.0 + 0.3456 = 1000.3456$。\n-   四舍五入后的 $\\rho^{n+1} = 1000.346$。\n-   违反检查：$300.0 \\le 1000.3456 \\le 1200.0$。此为真。没有违反。\n\n**案例2**：$(\\rho^n = 1199.9, \\Delta t = 86400, \\kappa = 0.05, S^n = 0.0022, S_0 = 0.0018, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 1199.9 + 86400 \\cdot 0.05 \\cdot (0.0022 - 0.0018) = 1199.9 + 1.728 = 1201.628$。\n-   四舍五入后的 $\\rho^{n+1} = 1201.628$。\n-   违反检查：$1201.628 > 1200.0$。此为假。发生违反。\n\n**案例3**：$(\\rho^n = 300.5, \\Delta t = 86400, \\kappa = 0.03, S^n = 0.0012, S_0 = 0.0018, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 300.5 + 86400 \\cdot 0.03 \\cdot (0.0012 - 0.0018) = 300.5 - 1.5552 = 298.9448$。\n-   四舍五入后的 $\\rho^{n+1} = 298.945$。\n-   违反检查：$298.9448  300.0$。此为假。发生违反。\n\n**案例4**：$(\\rho^n = 800.0, \\Delta t = 0, \\kappa = 0.02, S^n = 0.0030, S_0 = 0.0020, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 800.0 + 0 \\cdot 0.02 \\cdot (0.0030 - 0.0020) = 800.0$。\n-   四舍五入后的 $\\rho^{n+1} = 800.000$。\n-   违反检查：$300.0 \\le 800.0 \\le 1200.0$。此为真。没有违反。\n\n**案例5**：$(\\rho^n = 500.0, \\Delta t = 86400, \\kappa = 0.10, S^n = 0.0020, S_0 = 0.0020, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 500.0 + 86400 \\cdot 0.10 \\cdot (0.0020 - 0.0020) = 500.0$。\n-   四舍五入后的 $\\rho^{n+1} = 500.000$。\n-   违反检查：$300.0 \\le 500.0 \\le 1200.0$。此为真。没有违反。\n\n**案例6**：$(\\rho^n = 305.0, \\Delta t = 86400, \\kappa = 0.01, S^n = 0.0010, S_0 = 0.0018, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 305.0 + 86400 \\cdot 0.01 \\cdot (0.0010 - 0.0018) = 305.0 - 0.6912 = 304.3088$。\n-   四舍五入后的 $\\rho^{n+1} = 304.309$。\n-   违反检查：$300.0 \\le 304.3088 \\le 1200.0$。此为真。没有违反。\n\n**案例7**：$(\\rho^n = 1200.0, \\Delta t = 86400, \\kappa = 0.01, S^n = 0.0025, S_0 = 0.0020, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 1200.0 + 86400 \\cdot 0.01 \\cdot (0.0025 - 0.0020) = 1200.0 + 0.432 = 1200.432$。\n-   四舍五入后的 $\\rho^{n+1} = 1200.432$。\n-   违反检查：$1200.432 > 1200.0$。此为假。发生违反。\n\n这些计算将被用于生成最终输出。",
            "answer": "$$\n[ [1000.346, \\text{False}], [1201.628, \\text{True}], [298.945, \\text{True}], [800.000, \\text{False}], [500.000, \\text{False}], [304.309, \\text{False}], [1200.432, \\text{True}] ]\n$$"
        }
    ]
}