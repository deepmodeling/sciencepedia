{
    "hands_on_practices": [
        {
            "introduction": "理解脊髓损伤（SCI）的核心在于将压缩等力学事件与缺血等生理后果联系起来。本练习提供了一个基础的定量视角，探讨椎管内压力升高如何直接影响血流量和氧气输送，这是继发性损伤的一个关键机制 。通过这个简化的液压模型，我们可以掌握评估脊髓灌注压和预测缺血风险的基本原理。",
            "id": "4204704",
            "problem": "一名急性脊髓损伤患者出现肿胀，导致脑脊液压力 (CSFP) 升高。考虑将脊髓微循环建模为一个液压回路，其中血流由压力梯度驱动，并受到恒定的液压阻力阻碍。驱动血流的压力是上游动脉压与微血管系统周围的有效下游/血管周围压力之间的差值。假设以下基线值：平均动脉压 (MAP) $MAP = 85$ mmHg，脑脊液压力 (CSFP) $CSFP = 12$ mmHg，微血管液压阻力 $R = 1.2$ mmHg$\\cdot$min/mL，以及动脉血氧含量 $C_{aO_2} = 0.20$ mL O$_2$/mL 血液。肿胀使 $CSFP$ 增加了 $10$ mmHg，而 $MAP$、$R$ 和 $C_{aO_2}$ 保持不变。使用流体输运和氧气输送的基本原理，确定：\n- 在 $CSFP$ 上升后的新脊髓灌注压 (SCPP)，以及\n- 氧气输送的下降分数（相对于基线值，以小数表示）。\n将两个结果四舍五入至四位有效数字。以 mmHg 为单位表示灌注压。按顺序 $\\big[$新的 $SCPP$ (mmHg)，氧气输送下降分数$\\big]$ 以行向量形式提供最终答案。",
            "solution": "首先验证问题以确保其自洽、一致且科学合理。\n\n**步骤1：提取已知条件**\n- 平均动脉压：$MAP = 85$ mmHg\n- 基线脑脊液压力：$CSFP_{base} = 12$ mmHg\n- 微血管液压阻力：$R = 1.2$ mmHg$\\cdot$min/mL\n- 动脉血氧含量：$C_{aO_2} = 0.20$ mL O$_2$/mL 血液\n- 脑脊液压力增量：$\\Delta CSFP = 10$ mmHg\n- 条件：$MAP$，$R$ 和 $C_{aO_2}$ 保持不变。\n- 要求输出：\n    1. $CSFP$ 升高后的新脊髓灌注压 ($SCPP_{new}$)。\n    2. 氧气输送的下降分数。\n- 精度：将两个结果四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，利用了灌注压的标准生理模型 ($SCPP = MAP - CSFP$) 和血流的液压类比 ($Q = \\Delta P / R$)，这些是循环生理学和生物力学中的基本原理。给定值处于经历病理性肿胀患者的实际生理范围内。问题是适定的，提供了计算唯一解所需的所有信息。语言客观，要求明确。该问题不违反任何无效标准。\n\n**步骤3：结论与行动**\n问题有效。有必要给出完整解答。\n\n**解题推导**\n\n问题要求计算两个量：新的脊髓灌注压 ($SCPP_{new}$) 和氧气输送的下降分数。\n\n**第1部分：计算新的脊髓灌注压 ($SCPP_{new}$)**\n\n脊髓灌注压 ($SCPP$) 定义为驱动血液流经脊髓的压力梯度。它是平均动脉压 ($MAP$) 和作为血管周围压力的脑脊液压力 ($CSFP$) 之间的差值。\n$$SCPP = MAP - CSFP$$\n问题提供了基线 $CSFP_{base} = 12$ mmHg，并指出肿胀导致 $\\Delta CSFP = 10$ mmHg 的增加。因此，新的 $CSFP$ 值，记为 $CSFP_{new}$，是：\n$$CSFP_{new} = CSFP_{base} + \\Delta CSFP = 12 \\text{ mmHg} + 10 \\text{ mmHg} = 22 \\text{ mmHg}$$\n平均动脉压 ($MAP$) 给定为恒定的 $85$ mmHg。新的脊髓灌注压 $SCPP_{new}$ 计算如下：\n$$SCPP_{new} = MAP - CSFP_{new} = 85 \\text{ mmHg} - 22 \\text{ mmHg} = 63 \\text{ mmHg}$$\n四舍五入至四位有效数字，我们得到 $SCPP_{new} = 63.00$ mmHg。\n\n**第2部分：计算氧气输送的下降分数**\n\n输送至脊髓的氧气量 ($DO_2$) 是脊髓血流量 ($SCBF$) 和动脉血氧含量 ($C_{aO_2}$) 的乘积。\n$$DO_2 = SCBF \\times C_{aO_2}$$\n脊髓微循环被建模为一个液压回路，其中血流量 ($SCBF$) 类似于电流，灌注压 ($SCPP$) 类似于电压降，液压阻力 ($R$) 类似于电阻。这种关系描述为：\n$$SCBF = \\frac{SCPP}{R}$$\n将此代入氧气输送方程，得到：\n$$DO_2 = \\frac{SCPP}{R} \\times C_{aO_2}$$\n氧气输送的下降分数定义为输送量的变化量除以基线输送量：\n$$\\text{下降分数} = \\frac{DO_{2, base} - DO_{2, new}}{DO_{2, base}} = 1 - \\frac{DO_{2, new}}{DO_{2, base}}$$\n这里，$DO_{2, base}$ 是基线条件下的氧气输送量，$DO_{2, new}$ 是 $CSFP$ 增加后的输送量。\n\n使用 $DO_2$ 的表达式，我们可以将比率 $\\frac{DO_{2, new}}{DO_{2, base}}$ 写为：\n$$\\frac{DO_{2, new}}{DO_{2, base}} = \\frac{\\frac{SCPP_{new}}{R} \\times C_{aO_2}}{\\frac{SCPP_{base}}{R} \\times C_{aO_2}}$$\n由于问题说明阻力 $R$ 和动脉血氧含量 $C_{aO_2}$ 保持不变，这些项可以消去，表达式简化为：\n$$\\frac{DO_{2, new}}{DO_{2, base}} = \\frac{SCPP_{new}}{SCPP_{base}}$$\n首先，我们必须计算基线灌注压 $SCPP_{base}$：\n$$SCPP_{base} = MAP - CSFP_{base} = 85 \\text{ mmHg} - 12 \\text{ mmHg} = 73 \\text{ mmHg}$$\n我们已经计算出 $SCPP_{new} = 63$ mmHg。\n\n现在，我们可以将这些值代回下降分数的方程中：\n$$\\text{下降分数} = 1 - \\frac{SCPP_{new}}{SCPP_{base}} = 1 - \\frac{63}{73}$$\n进行除法运算：\n$$\\frac{63}{73} \\approx 0.86301369...$$\n从 $1$ 中减去：\n$$\\text{下降分数} = 1 - 0.86301369... = 0.13698630...$$\n将结果四舍五入至四位有效数字，得到 $0.1370$。\n\n所需的两个结果是新的 $SCPP$ 为 $63.00$ mmHg 和氧气输送的下降分数为 $0.1370$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 63.00 & 0.1370 \\end{pmatrix}}$$"
        },
        {
            "introduction": "为了建立精确的脊髓生物力学模型，我们首先需要准确测量其材料特性，例如弹性模量。本练习探讨了实验生物力学中的一个典型问题：在约束压缩测试中，由于样本与压头之间的摩擦和侧向约束，测得的表观刚度并不能直接反映材料的真实杨氏模量 $E$ 。通过应用连续介质力学原理对这些边界效应进行校正，我们可以从实验数据中提炼出更准确的材料本构参数。",
            "id": "4204720",
            "problem": "一个离体脊髓实质的圆柱形样本被放置在两个刚性、抛光的玻璃压板之间进行小应变轴向压缩，以表征其与脊髓损伤生物力学相关的压缩刚度。样本的初始直径为 $d = 10\\,\\mathrm{mm}$，初始高度为 $h_{0} = 4\\,\\mathrm{mm}$。在高达 $12.5\\%$ 轴向应变（位移 $\\delta$ 高达 $0.5\\,\\mathrm{mm}$）的应变范围内，测得的力-位移响应是线性的，斜率为 $k = \\mathrm{d}F/\\mathrm{d}\\delta = 0.52\\,\\mathrm{N/mm}$。测得的组织与玻璃之间的静摩擦系数很高，$\\mu_{s} \\approx 0.9$，且高径比 $h_{0}/d = 0.4$ 足够小，以至于横向膨胀受到界面剪切的强烈约束，在加载的小应变阶段，在样本主体中产生近似平面应变条件。假设在此范围内，组织是均匀、各向同性且线弹性，其泊松比为 $ \\nu = 0.49$。\n\n仅使用线性各向同性弹性的基本连续介质力学以及工程应力和应变的定义，根据在所述横向约束和摩擦条件下测得的力-位移斜率，确定组织的校正有效杨氏模量 $E$。您的推理应明确说明由约束引起的轴向应力-应变关系相对于单轴应力的变化。将最终的 $E$ 值四舍五入至三位有效数字，并以 $\\mathrm{kPa}$ 为单位表示。",
            "solution": "用户要求根据在特定边界条件下进行的压缩试验，确定脊髓组织样本的杨氏模量 $E$。\n\n首先，我们必须验证问题陈述。\n\n### 步骤1：提取已知条件\n-   样本几何形状：圆柱形，初始直径 $d = 10\\,\\mathrm{mm}$，初始高度 $h_{0} = 4\\,\\mathrm{mm}$。\n-   加载条件：小应变轴向压缩。\n-   力-位移响应：线性，斜率为 $k = 0.52\\,\\mathrm{N/mm}$。\n-   界面条件：刚性、抛光的玻璃压板，静摩擦系数高，$\\mu_{s} \\approx 0.9$。\n-   几何约束：高径比 $h_{0}/d = 0.4$ 很小。\n-   运动学假设：横向膨胀受到强烈约束，在主体中产生“近似平面应变条件”。\n-   材料假设：均匀、各向同性、线弹性。\n-   材料属性：泊松比 $\\nu = 0.49$。\n-   目标：确定杨氏模量 $E$，单位为 $\\mathrm{kPa}$，并四舍五入至三位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题描述了一种用于软组织的标准化生物力学测试（约束压缩）。给定的尺寸、刚度和泊松比（$\\nu \\approx 0.5$ 表示近乎不可压缩）对于像脊髓实质这样的生物软组织是符合实际的。高摩擦和低高径比导致类似平面应变条件的假设是材料力学中一个公认的概念。该问题基于线性弹性的基本原理。\n-   **良态性：** 问题提供了所有必要的数据和明确的目标。可以从给定信息中推导出杨氏模量 $E$ 的唯一解。\n-   **客观性：** 问题以精确、定量和客观的术语陈述。\n\n### 步骤3：结论与行动\n该问题在科学上是合理的、良态的且客观的。因此被判定为 **有效**。我们继续进行求解。\n\n目标是求出组织的杨氏模量 $E$。由于组织与压板界面存在摩擦约束，该实验装置并非简单的单轴压缩试验。问题陈述指出，这种约束导致了“近似平面应变条件”。对于一个在轴向（$z$轴方向）受压的轴对称圆柱形样本，该条件意味着径向应变 $\\epsilon_r$ 在材料主体中近似为零。\n\n我们来定义工程轴向应力 $\\sigma_z$ 和轴向应变 $\\epsilon_z$。对于施加的力 $F$ 和产生的轴向位移 $\\delta$，它们由以下公式给出：\n$$ \\sigma_z = \\frac{F}{A_0} $$\n$$ \\epsilon_z = \\frac{\\delta}{h_0} $$\n其中 $A_0$ 是样本的初始横截面积，$h_0$ 是样本的初始高度。面积为 $A_0 = \\pi (d/2)^2 = \\pi d^2 / 4$。\n\n问题给出了测得的刚度，$k = \\mathrm{d}F/\\mathrm{d}\\delta$。由于响应是线性的，我们可以写成 $k = F/\\delta$。我们可以用这个测得的刚度来表示应力与应变之比：\n$$ \\frac{\\sigma_z}{\\epsilon_z} = \\frac{F/A_0}{\\delta/h_0} = \\frac{F}{\\delta} \\frac{h_0}{A_0} = k \\frac{h_0}{A_0} $$\n这个比值 $\\sigma_z/\\epsilon_z$ 代表了在特定实验约束条件下材料的表观模量。我们称之为约束压缩模量 $M_{app}$。\n$$ M_{app} = k \\frac{h_0}{A_0} $$\n\n为了求得真实的杨氏模量 $E$，我们必须使用线弹性本构方程和给定的运动学约束，将其与 $M_{app}$ 联系起来。对于均匀、各向同性的线弹性材料，在圆柱坐标系 $(r, \\theta, z)$ 中的广义胡克定律为：\n$$ \\epsilon_z = \\frac{1}{E} \\left[ \\sigma_z - \\nu(\\sigma_r + \\sigma_\\theta) \\right] $$\n$$ \\epsilon_r = \\frac{1}{E} \\left[ \\sigma_r - \\nu(\\sigma_\\theta + \\sigma_z) \\right] $$\n$$ \\epsilon_\\theta = \\frac{1}{E} \\left[ \\sigma_\\theta - \\nu(\\sigma_r + \\sigma_z) \\right] $$\n由于加载和几何形状的轴对称性，径向和周向的应力与应变分量相等：$\\sigma_r = \\sigma_\\theta$ 且 $\\epsilon_r = \\epsilon_\\theta$。平面应变假设意味着 $\\epsilon_r = 0$。\n\n将 $\\epsilon_r = 0$ 和 $\\sigma_r = \\sigma_\\theta$ 代入径向应变方程：\n$$ 0 = \\frac{1}{E} \\left[ \\sigma_r - \\nu(\\sigma_r + \\sigma_z) \\right] $$\n$$ \\sigma_r(1-\\nu) = \\nu\\sigma_z $$\n这就得到了由约束引起的径向应力：\n$$ \\sigma_r = \\frac{\\nu}{1-\\nu}\\sigma_z $$\n现在我们将这个 $\\sigma_r$（以及 $\\sigma_\\theta$）的表达式代入轴向应变 $\\epsilon_z$ 的方程中：\n$$ \\epsilon_z = \\frac{1}{E} \\left[ \\sigma_z - \\nu(\\sigma_r + \\sigma_r) \\right] = \\frac{1}{E} (\\sigma_z - 2\\nu\\sigma_r) $$\n$$ \\epsilon_z = \\frac{1}{E} \\left[ \\sigma_z - 2\\nu \\left( \\frac{\\nu}{1-\\nu}\\sigma_z \\right) \\right] $$\n$$ \\epsilon_z = \\frac{\\sigma_z}{E} \\left[ 1 - \\frac{2\\nu^2}{1-\\nu} \\right] = \\frac{\\sigma_z}{E} \\left[ \\frac{1-\\nu - 2\\nu^2}{1-\\nu} \\right] $$\n分子中的项可以因式分解为 $1-\\nu-2\\nu^2 = (1+\\nu)(1-2\\nu)$。\n$$ \\epsilon_z = \\frac{\\sigma_z}{E} \\frac{(1+\\nu)(1-2\\nu)}{1-\\nu} $$\n约束压缩模量 $M_{app}$ 是从此方程导出的比值 $\\sigma_z/\\epsilon_z$：\n$$ M_{app} = \\frac{\\sigma_z}{\\epsilon_z} = E \\frac{1-\\nu}{(1+\\nu)(1-2\\nu)} $$\n我们现在有两个关于 $M_{app}$ 的表达式。将它们相等，我们就可以解出 $E$：\n$$ k \\frac{h_0}{A_0} = E \\frac{1-\\nu}{(1+\\nu)(1-2\\nu)} $$\n$$ E = \\left( k \\frac{h_0}{A_0} \\right) \\frac{(1+\\nu)(1-2\\nu)}{1-\\nu} $$\n现在我们代入给定的数值。\n初始面积为 $A_0 = \\frac{\\pi d^2}{4} = \\frac{\\pi (10\\,\\mathrm{mm})^2}{4} = 25\\pi\\,\\mathrm{mm}^2$。\n给定的参数是：\n- $k = 0.52\\,\\mathrm{N/mm}$\n- $h_0 = 4\\,\\mathrm{mm}$\n- $A_0 = 25\\pi\\,\\mathrm{mm}^2$\n- $\\nu = 0.49$\n\n我们计算 $E$：\n$$ E = \\left( (0.52\\,\\mathrm{N/mm}) \\frac{4\\,\\mathrm{mm}}{25\\pi\\,\\mathrm{mm}^2} \\right) \\frac{(1+0.49)(1-2 \\times 0.49)}{1-0.49} $$\n$$ E = \\left( \\frac{2.08}{25\\pi}\\,\\mathrm{N/mm^2} \\right) \\frac{(1.49)(1-0.98)}{0.51} $$\n$$ E = \\left( \\frac{2.08}{25\\pi}\\,\\mathrm{N/mm^2} \\right) \\frac{(1.49)(0.02)}{0.51} $$\n$$ E = \\left( \\frac{2.08}{25\\pi} \\right) \\frac{0.0298}{0.51}\\,\\mathrm{N/mm^2} $$\n单位 $\\mathrm{N/mm^2}$ 等效于兆帕斯卡（$\\mathrm{MPa}$）。\n$$ E \\approx (0.0264845\\,\\mathrm{MPa}) \\times (0.0584314) $$\n$$ E \\approx 0.0015476\\,\\mathrm{MPa} $$\n问题要求答案以千帕斯卡（$\\mathrm{kPa}$）为单位。由于 $1\\,\\mathrm{MPa} = 1000\\,\\mathrm{kPa}$：\n$$ E \\approx 0.0015476 \\times 1000\\,\\mathrm{kPa} = 1.5476\\,\\mathrm{kPa} $$\n四舍五入到三位有效数字，我们得到：\n$$ E \\approx 1.55\\,\\mathrm{kPa} $$\n这个结果表明，真实的杨氏模量显著低于在约束压缩试验中测得的表观刚度，这是近乎不可压缩材料的一个典型特征。",
            "answer": "$$ \\boxed{1.55} $$"
        },
        {
            "introduction": "有限元方法（FEM）是将材料特性、几何形状和边界条件融为一体，以模拟复杂损伤情景的强大工具。本练习将引导你从零开始构建一个简化的脊髓受压有限元模型，这是一个综合性的实践 。通过这个过程，你将学会如何应用罚函数法处理接触和摩擦，并能预测在直接测量几乎不可能的组织内部的应力分布，从而深入理解损伤的力学机制。",
            "id": "4204689",
            "problem": "将椎管内脊髓的三维力学模型理想化为单个八节点三线性六面体单元，该单元占据一个矩形区域，其背腹侧厚度为 $H$（沿 $x$ 轴），内外侧宽度为 $W$（沿 $y$ 轴），纵向长度为 $L$（沿 $z$ 轴）。脊髓被建模为各向同性线性弹性实体，其杨氏模量为 $E$，泊松比为 $\\nu$。椎管腹侧壁被理想化为一个与 $x=0$ 重合的刚性平面，该平面沿 $+x$ 方向经历一个大小为 $\\delta$ 的指定后向平移，代表腹侧受压。脊髓腹侧表面与刚性壁之间的法向接触通过每个节点的罚刚度 $k_n$ 来施加，切向摩擦通过每个节点的切向罚刚度 $k_t$ 结合 Coulomb 摩擦系数 $\\mu$ 以及向摩擦锥上的投影进行正则化。位于 $x=H$ 的背侧表面是固定的（零位移边界条件），代表一个受约束的后侧边界。椎管壁在切向方向上没有平移。接触罚项通过与腹侧面面积成比例缩放的方式分配给四个腹侧节点，即 $k_{n,\\text{node}}=\\alpha_n \\, E \\, \\frac{A_{\\text{ventral}}/4}{H}$ 和 $k_{t,\\text{node}}=\\alpha_t \\, E \\, \\frac{A_{\\text{ventral}}/4}{H}$，其中 $A_{\\text{ventral}}=W L$，$\\alpha_n, \\alpha_t$ 是无量纲的罚参数。\n\n从无体力情况下的线性动量平衡和小应变运动学出发，使用虚功原理和各向同性线性弹性本构关系，为具有节点位移向量 $\\mathbf{u}\\in\\mathbb{R}^{24}$ 的单个单元推导离散平衡方程。本构关系为 $\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{\\varepsilon}=\\mathbf{B}\\mathbf{u}$ 是应变向量，$\\mathbf{D}$ 是由 Lamé 参数 $\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu_s=\\frac{E}{2(1+\\nu)}$ 构成的弹性矩阵。弱形式导出单元刚度矩阵 $\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbf{D} \\mathbf{B} \\, dV$，该矩阵需在每个参数方向上使用两点 Gaussian 求积法进行计算。通过在法向使用罚函数法和在切向使用正则化 Coulomb 摩擦定律来实现接触条件：对每个腹侧节点，通过将 $k_{n,\\text{node}}$ 加到全局刚度矩阵中对应法向自由度的对角线元上，并将 $k_{n,\\text{node}}\\delta$ 加到对应的右端项中，来施加对平面 $x=\\delta$ 的法向约束。对于每个腹侧节点的切向方向，将 $k_{t,\\text{node}}$ 加到对应的切向自由度的对角线元上。在求解出 $\\mathbf{u}$ 后，计算每个腹侧节点的接触反力，其残差向量为 $\\mathbf{r}_i = \\big(k_{n,\\text{node}}(u_{x,i}-\\delta), \\, k_{t,\\text{node}} u_{y,i}, \\, k_{t,\\text{node}} u_{z,i}\\big)$，然后通过将切向分量投影到摩擦锥上来应用 Coulomb 摩擦：如果 $\\|\\mathbf{r}_{t,i}\\| > \\mu |r_{n,i}|$，则设 $\\mathbf{r}_{t,i} \\leftarrow \\mathbf{r}_{t,i} \\frac{\\mu |r_{n,i}|}{\\|\\mathbf{r}_{t,i}\\|}$，否则保持 $\\mathbf{r}_{t,i}$ 不变。将节点反力向量求和，得到腹侧平面上的总反力，并报告其大小。在每个 Gaussian 求积点计算 Cauchy 应力 $\\boldsymbol{\\sigma}$，并报告由下式定义的最大 von Mises 应力：\n$$\n\\sigma_\\text{vm} = \\sqrt{\\frac{1}{2}\\left[(\\sigma_{xx}-\\sigma_{yy})^2 + (\\sigma_{yy}-\\sigma_{zz})^2 + (\\sigma_{zz}-\\sigma_{xx})^2\\right] + 3\\left(\\tau_{xy}^2 + \\tau_{yz}^2 + \\tau_{zx}^2\\right)}.\n$$\n\n您的程序必须：\n- 在母空间中沿每个方向执行两点 Gaussian 求积，通过矩形块的常数 Jacobian 矩阵映射到物理单元，以构建单元刚度矩阵 $\\mathbf{K}_e$。\n- 为单个单元组集全局系统，对背侧节点施加指定的边界条件（所有三个方向的位移均为零），并计入罚接触的贡献。\n- 求解 $\\mathbf{u}$，计算带有摩擦投影的接触反力，计算 Gaussian 求积点处的应力，并为每个测试案例返回两个量：以牛顿为单位的总腹侧反力大小和以帕斯卡为单位的最大 von Mises 应力。\n- 所有答案均以国际单位制（SI）表示。反力必须以牛顿为单位，von Mises 应力必须以帕斯卡为单位。以浮点数形式提供数值输出。\n\n使用以下测试套件参数集 $(E,\\nu,H,W,L,\\delta,\\mu,\\alpha_n,\\alpha_t)$:\n1. $(6.0\\times 10^5, \\, 0.45, \\, 0.01, \\, 0.012, \\, 0.02, \\, 0.001, \\, 0.30, \\, 20, \\, 5)$\n2. $(6.0\\times 10^5, \\, 0.45, \\, 0.01, \\, 0.012, \\, 0.02, \\, 0.001, \\, 0.00, \\, 20, \\, 5)$\n3. $(1.0\\times 10^6, \\, 0.40, \\, 0.01, \\, 0.012, \\, 0.02, \\, 0.0001, \\, 0.30, \\, 20, \\, 5)$\n4. $(6.0\\times 10^5, \\, 0.45, \\, 0.01, \\, 0.012, \\, 0.02, \\, 0.001, \\, 1.00, \\, 20, \\, 50)$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含结果，形式为逗号分隔的配对列表，每个测试案例一对，每对以 $[\\text{reaction\\_magnitude\\_N}, \\, \\text{max\\_von\\_Mises\\_Pa}]$ 的顺序列出，并用方括号括起来。例如，输出应如下所示\n$[[r_1,s_1],[r_2,s_2],[r_3,s_3],[r_4,s_4]]$，\n其中每个 $r_i$ 和 $s_i$ 是国际单位制下的浮点数。",
            "solution": "首先对用户提供的问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **模型：** 代表一段脊髓的单个八节点三线性六面体单元。\n- **区域：** 一个矩形区域，尺寸为 $H$（x 轴）、$W$（y 轴）和 $L$（z 轴）。\n- **材料属性：** 各向同性线性弹性固体，杨氏模量为 $E$，泊松比为 $\\nu$。\n- **本构律：** $\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\varepsilon}$，Lamé 参数为 $\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu_s=\\frac{E}{2(1+\\nu)}$。\n- **运动学：** 小应变，$\\boldsymbol{\\varepsilon}=\\mathbf{B}\\mathbf{u}$。\n- **边界条件：**\n    - 背侧表面 ($x=H$)：固定（零位移）。\n    - 腹侧表面 ($x=0$)：与移动到 $x=\\delta$ 的刚性平面接触。\n- **接触模型（罚函数法）：**\n    - 每个节点的法向罚刚度：$k_{n,\\text{node}}=\\alpha_n \\, E \\, \\frac{A_{\\text{ventral}}/4}{H}$，其中 $A_{\\text{ventral}}=W L$。\n    - 每个节点的切向罚刚度：$k_{t,\\text{node}}=\\alpha_t \\, E \\, \\frac{A_{\\text{ventral}}/4}{H}$。\n    - Coulomb 摩擦系数：$\\mu$。\n- **数值积分：** 单元刚度矩阵 $\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbf{D} \\mathbf{B} \\, dV$ 在每个参数方向上使用两点 Gaussian 求积法计算。\n- **系统组集与求解：**\n    - 通过将 $k_{n,\\text{node}}$ 加到每个腹侧节点的法向（$x$）自由度对应的对角线元上，以及将 $k_{t,\\text{node}}$ 加到切向（$y, z$）自由度对应的对角线元上，来修改全局刚度矩阵。\n    - 通过将 $k_{n,\\text{node}}\\delta$ 加到每个腹侧节点的法向（$x$）自由度对应的项中，来修改全局力向量。\n- **后处理：**\n    - 求解节点位移向量 $\\mathbf{u}$。\n    - 计算每个腹侧节点 $i$ 的反力向量：$\\mathbf{r}_i = \\big(k_{n,\\text{node}}(u_{x,i}-\\delta), \\, k_{t,\\text{node}} u_{y,i}, \\, k_{t,\\text{node}} u_{z,i}\\big)$。\n    - 应用 Coulomb 摩擦投影：如果 $\\|\\mathbf{r}_{t,i}\\| > \\mu |r_{n,i}|$，则设 $\\mathbf{r}_{t,i} \\leftarrow \\mathbf{r}_{t,i} \\frac{\\mu |r_{n,i}|}{\\|\\mathbf{r}_{t,i}\\|}$。\n    - 将节点反力向量求和，计算其大小作为总腹侧反力。\n    - 在每个 Gaussian 求积点计算 Cauchy 应力 $\\boldsymbol{\\sigma}$。\n    - 计算最大 von Mises 应力 $\\sigma_\\text{vm} = \\sqrt{\\frac{1}{2}\\left[(\\sigma_{xx}-\\sigma_{yy})^2 + (\\sigma_{yy}-\\sigma_{zz})^2 + (\\sigma_{zz}-\\sigma_{xx})^2\\right] + 3\\left(\\tau_{xy}^2 + \\tau_{yz}^2 + \\tau_{zx}^2\\right)}$。\n- **测试案例：** 提供了四组参数 $(E,\\nu,H,W,L,\\delta,\\mu,\\alpha_n,\\alpha_t)$。\n- **要求输出：** 对于每个测试案例，输出总腹侧反力的大小（单位：牛顿）和最大 von Mises 应力（单位：帕斯卡）。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础：** 该问题牢固地植根于连续介质力学和有限元方法（FEM）的原理。三线性六面体单元、线性弹性、Gaussian 求积和用于接触的罚函数法的使用是计算固体力学中标准且成熟的技术。\n- **适定性：** 该问题是适定的。边界条件（一个面固定，另一个面通过罚函数法施加指定位移）足以防止刚体运动并确保存在唯一解。处理摩擦的程序是一个非迭代的、显式的投影，这是对更复杂摩擦模型的简化，但在算法上是清晰的，并能导出一个唯一的、明确定义的结果。\n- **客观性：** 该问题以精确、客观的数学和工程术语陈述，没有任何主观性或模糊性。\n- **完整性与一致性：** 该问题提供了所有必要信息，包括几何形状、材料属性、边界条件、数值方法（求积、罚参数）和后处理步骤。设置中没有矛盾之处。\n- **现实性与可行性：** 所选模型（单单元理想化）虽然是一种简化，却是初步分析或教学环境中的一种常用方法。参数值对于生物力学应用是物理上合理的。\n- **结构与清晰度：** 问题结构清晰，引导用户完成有限元方法的步骤：公式化、组集、求解和后处理。术语定义明确。\n\n### 步骤 3：结论与行动\n该问题是 **有效的**。这是一个标准的、尽管全面的计算力学问题，可以按照描述通过算法求解。解决方案将通过实施指定的有限元公式来进行。\n\n### 解决方案\n\n该问题要求对一个承受特定边界和接触条件的八节点六面体单元进行有限元分析。解决方案通过系统地构建有限元系统的各个组件、求解节点位移，然后对结果进行后处理以找到所需的反作用力和应力来进行。\n\n**1. 单元定义与坐标系**\n\n该单元是一个 8 节点三线性六面体。我们定义一个从参数坐标 $(\\xi, \\eta, \\zeta) \\in [-1, 1]^3$ 的母单元到物理坐标 $(x, y, z)$ 中物理单元的映射。物理域是由 $[0, H] \\times [0, W] \\times [0, L]$ 定义的矩形棱柱。我们将参数轴和物理轴对齐，使得 $\\xi$ 映射到 $x$，$\\eta$ 映射到 $y$，$\\zeta$ 映射到 $z$。等参映射为：\n$$\nx(\\xi) = \\frac{H}{2}(1+\\xi), \\quad y(\\eta) = \\frac{W}{2}(1+\\eta), \\quad z(\\zeta) = \\frac{L}{2}(1+\\zeta)\n$$\n母单元 $(\\xi_i, \\eta_i, \\zeta_i)$ 的标准节点排序为：\n1: $(-1,-1,-1)$, 2: $(1,-1,-1)$, 3: $(1,1,-1)$, 4: $(-1,1,-1)$\n5: $(-1,-1,1)$, 6: $(1,-1,1)$, 7: $(1,1,1)$, 8: $(-1,1,1)$\n\n通过此映射，$\\xi=-1$ 处的面对应物理平面 $x=0$（腹侧表面），而 $\\xi=1$ 处的面对应 $x=H$（背侧表面）。\n- 腹侧节点 (在 $x=0$上): 节点 1, 4, 8, 5。注意非连续顺序。让我们使用标准编号：节点 1(-1,-1,-1), 节点 4(-1,1,-1), 节点 5(-1,-1,1), 节点 8(-1,1,1)。\n- 背侧节点 (在 $x=H$上): 节点 2, 3, 7, 6。使用标准编号：节点 2(1,-1,-1), 节点 3(1,1,-1), 节点 6(1,-1,1), 节点 7(1,1,1)。\n\n**2. 形函数与应变-位移矩阵 ($\\mathbf{B}$)**\n\n位移场由节点位移 $\\mathbf{u}_i$ 使用三线性形函数 $N_i(\\xi, \\eta, \\zeta)$ 插值得到：\n$N_i(\\xi, \\eta, \\zeta) = \\frac{1}{8}(1+\\xi_i\\xi)(1+\\eta_i\\eta)(1+\\zeta_i\\zeta)$\n应变向量由 $\\boldsymbol{\\varepsilon} = \\mathbf{B}\\mathbf{u}$ 给出，其中 $\\mathbf{u}$ 是所有节点位移的 $24 \\times 1$ 向量。矩阵 $\\mathbf{B}$ 被划分为 $\\mathbf{B} = [\\mathbf{B}_1, \\mathbf{B}_2, \\ldots, \\mathbf{B}_8]$，其中每个 $\\mathbf{B}_i$ 是一个 $6 \\times 3$ 的矩阵：\n$$\n\\mathbf{B}_i =\n\\begin{bmatrix}\n\\partial N_i / \\partial x & 0 & 0 \\\\\n0 & \\partial N_i / \\partial y & 0 \\\\\n0 & 0 & \\partial N_i / \\partial z \\\\\n\\partial N_i / \\partial y & \\partial N_i / \\partial x & 0 \\\\\n0 & \\partial N_i / \\partial z & \\partial N_i / \\partial y \\\\\n\\partial N_i / \\partial z & 0 & \\partial N_i / \\partial x\n\\end{bmatrix}\n$$\n相对于物理坐标的导数通过链式法则获得，这需要坐标变换的 Jacobian 矩阵 $\\mathbf{J}$。对于我们的矩形单元，$\\mathbf{J}$ 是对角的并且是常数：\n$$\n\\mathbf{J} = \\begin{bmatrix} \\partial x/\\partial\\xi & 0 & 0 \\\\ 0 & \\partial y/\\partial\\eta & 0 \\\\ 0 & 0 & \\partial z/\\partial\\zeta \\end{bmatrix} = \\text{diag}\\left(\\frac{H}{2}, \\frac{W}{2}, \\frac{L}{2}\\right)\n$$\n其逆矩阵为 $\\mathbf{J}^{-1} = \\text{diag}\\left(\\frac{2}{H}, \\frac{2}{W}, \\frac{2}{L}\\right)$。形函数的空间导数为：\n$\\frac{\\partial N_i}{\\partial x} = \\frac{2}{H}\\frac{\\partial N_i}{\\partial \\xi}$, $\\frac{\\partial N_i}{\\partial y} = \\frac{2}{W}\\frac{\\partial N_i}{\\partial \\eta}$, $\\frac{\\partial N_i}{\\partial z} = \\frac{2}{L}\\frac{\\partial N_i}{\\partial \\zeta}$。\n\n**3. 本构矩阵 ($\\mathbf{D}$)**\n\n对于线性各向同性材料，本构矩阵 $\\mathbf{D}$ 将应力向量 $\\boldsymbol{\\sigma} = [\\sigma_{xx}, \\sigma_{yy}, \\sigma_{zz}, \\tau_{xy}, \\tau_{yz}, \\tau_{zx}]^\\top$ 与工程应变向量 $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{zz}, \\gamma_{xy}, \\gamma_{yz}, \\gamma_{zx}]^\\top$ 关联起来。使用 Lamé 参数 $\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu_s = G = \\frac{E}{2(1+\\nu)}$，该矩阵为：\n$$\n\\mathbf{D} = \\begin{bmatrix}\n\\lambda+2\\mu_s & \\lambda & \\lambda & 0 & 0 & 0 \\\\\n\\lambda & \\lambda+2\\mu_s & \\lambda & 0 & 0 & 0 \\\\\n\\lambda & \\lambda & \\lambda+2\\mu_s & 0 & 0 & 0 \\\\\n0 & 0 & 0 & \\mu_s & 0 & 0 \\\\\n0 & 0 & 0 & 0 & \\mu_s & 0 \\\\\n0 & 0 & 0 & 0 & 0 & \\mu_s\n\\end{bmatrix}\n$$\n\n**4. 单元刚度矩阵 ($\\mathbf{K}_e$)**\n\n单元刚度矩阵通过在单元体积上积分来计算：\n$$\n\\mathbf{K}_e = \\int_{V_e} \\mathbf{B}^\\top \\mathbf{D} \\mathbf{B} \\, dV = \\int_{-1}^1\\int_{-1}^1\\int_{-1}^1 \\mathbf{B}^\\top(\\xi,\\eta,\\zeta) \\mathbf{D} \\mathbf{B}(\\xi,\\eta,\\zeta) \\det(\\mathbf{J}) \\,d\\xi d\\eta d\\zeta\n$$\n其中 $\\det(\\mathbf{J}) = \\frac{HWL}{8}$。我们在每个方向上使用两点 Gaussian 求积法。求积点位于 $\\pm 1/\\sqrt{3}$，所有权重均为 $1$。该积分通过对在 $2 \\times 2 \\times 2 = 8$ 个 Gauss 点处计算的被积函数求和来近似，再乘以权重（均为 $1$）和 $\\det(\\mathbf{J})$。\n$$\n\\mathbf{K}_e \\approx \\sum_{p=1}^2\\sum_{q=1}^2\\sum_{r=1}^2 \\mathbf{B}^\\top(\\xi_p,\\eta_q,\\zeta_r) \\mathbf{D} \\mathbf{B}(\\xi_p,\\eta_q,\\zeta_r) \\det(\\mathbf{J})\n$$\n\n**5. 组集与边界条件**\n\n对于单个单元，全局刚度矩阵为 $\\mathbf{K}_e$。系统为 $\\mathbf{K}_e \\mathbf{u} = \\mathbf{f}$。\n- **固定边界条件：** 背侧节点 (2, 3, 6, 7) 是固定的，意味着它们的每个节点的 3 个自由度均为零。这总共涉及 12 个自由度。我们将系统划分为活动（未知）自由度和固定（已知）自由度。活动自由度是对应于腹侧节点 (1, 4, 5, 8) 的 12 个自由度。我们求解一个简化的 $12 \\times 12$ 系统。\n- **接触边界条件：** 罚函数法应用于活动自由度。令 $\\mathbf{K}_{red}$ 为 $\\mathbf{K}_e$ 中对应于活动自由度的 $12 \\times 12$ 子矩阵，$\\mathbf{f}_{red}$ 为相应的力向量（初始为零）。\n    - 罚刚度值为 $k_{n,\\text{node}} = \\alpha_n E \\frac{WL/4}{H}$ 和 $k_{t,\\text{node}} = \\alpha_t E \\frac{WL/4}{H}$。\n    - 对于四个腹侧节点中的每一个：\n        1. 将 $k_{n,\\text{node}}$ 加到 $\\mathbf{K}_{red}$ 中对应其 $x$-位移的对角元上。\n        2. 将 $k_{t,\\text{node}}$ 加到 $\\mathbf{K}_{red}$ 中对应其 $y$-和 $z$-位移的对角元上。\n        3. 将力项 $k_{n,\\text{node}}\\delta$ 加到 $\\mathbf{f}_{red}$ 中对应其 $x$-位移的元素上。\n然后求解修改后的简化系统 $\\mathbf{K}'_{red}\\mathbf{u}_{red} = \\mathbf{f}'_{red}$ 以获得未知位移 $\\mathbf{u}_{red}$。\n\n**6. 后处理**\n\n- **位移：** 完整的 $24 \\times 1$ 位移向量 $\\mathbf{u}$ 通过将求解得到的 $\\mathbf{u}_{red}$ 与固定节点的零位移组合而成。\n- **接触反力：** 对于每个腹侧节点 $i$，首先根据求解出的位移 $u_{x,i}, u_{y,i}, u_{z,i}$ 计算反力 $\\mathbf{r}_i$：\n    $r_{n,i} = k_{n,\\text{node}}(u_{x,i} - \\delta)$\n    $\\mathbf{r}_{t,i} = (k_{t,\\text{node}}u_{y,i}, k_{t,\\text{node}}u_{z,i})$\n    然后应用 Coulomb 摩擦条件。如果切向反力的大小 $\\|\\mathbf{r}_{t,i}\\|$ 超过摩擦极限 $\\mu |r_{n,i}|$，则将切向反力向量投影回摩擦锥上：\n    $\\mathbf{r}_{t,i} \\leftarrow \\mathbf{r}_{t,i} \\frac{\\mu |r_{n,i}|}{\\|\\mathbf{r}_{t,i}\\|}$\n    腹侧平面上的总反力是这些最终节点反力的向量和，$\\mathbf{R} = \\sum_i \\mathbf{r}_i$。要求的输出是其大小 $\\|\\mathbf{R}\\|$。\n- **应力：** 在 8 个 Gaussian 求积点中的每一个点上使用 $\\boldsymbol{\\sigma} = \\mathbf{D} \\mathbf{B} \\mathbf{u}$ 计算应力张量。然后使用提供的公式在每个点计算 von Mises 等效应力 $\\sigma_{\\text{vm}}$。报告 8 个点中的最大值。\n\n此详细过程构成了计算实现的基础。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a single-element finite element problem for spinal cord compression.\n    \"\"\"\n\n    test_cases = [\n        # (E, nu, H, W, L, delta, mu, alpha_n, alpha_t)\n        (6.0e5, 0.45, 0.01, 0.012, 0.02, 0.001, 0.30, 20, 5),\n        (6.0e5, 0.45, 0.01, 0.012, 0.02, 0.001, 0.00, 20, 5),\n        (1.0e6, 0.40, 0.01, 0.012, 0.02, 0.0001, 0.30, 20, 5),\n        (6.0e5, 0.45, 0.01, 0.012, 0.02, 0.001, 1.00, 20, 50),\n    ]\n\n    results = []\n    for params in test_cases:\n        E, nu, H, W, L, delta, mu_friction, alpha_n, alpha_t = params\n        \n        # 1. Constitutive Matrix (D-matrix)\n        lmbda = E * nu / ((1 + nu) * (1 - 2 * nu))\n        mu_s = E / (2 * (1 + nu)) # Shear modulus, often G\n        \n        D = np.zeros((6, 6))\n        D[0,0] = D[1,1] = D[2,2] = lmbda + 2 * mu_s\n        D[0,1] = D[1,0] = D[0,2] = D[2,0] = D[1,2] = D[2,1] = lmbda\n        D[3,3] = D[4,4] = D[5,5] = mu_s\n\n        # 2. Element Geometry and Numerical Integration Setup\n        # Node coordinates in parent element space [-1, 1]^3\n        node_coords_parent = np.array([\n            [-1, -1, -1], [ 1, -1, -1], [ 1,  1, -1], [-1,  1, -1],\n            [-1, -1,  1], [ 1, -1,  1], [ 1,  1,  1], [-1,  1,  1]\n        ])\n        \n        # Gaussian quadrature points and weights (2-point)\n        gp_loc = 1.0 / np.sqrt(3.0)\n        gauss_points = [-gp_loc, gp_loc]\n        gauss_weights = [1.0, 1.0]\n\n        detJ = (H / 2.0) * (W / 2.0) * (L / 2.0)\n        \n        Ke = np.zeros((24, 24))\n\n        # 3. Assemble Element Stiffness Matrix (Ke)\n        for w_xi, xi in zip(gauss_weights, gauss_points):\n            for w_eta, eta in zip(gauss_weights, gauss_points):\n                for w_zeta, zeta in zip(gauss_weights, gauss_points):\n                    \n                    B = np.zeros((6, 24))\n                    \n                    for i in range(8):\n                        xi_i, eta_i, zeta_i = node_coords_parent[i]\n                        \n                        # Derivatives of shape functions w.r.t. parent coords\n                        dNi_dxi = 0.125 * xi_i * (1 + eta_i * eta) * (1 + zeta_i * zeta)\n                        dNi_deta = 0.125 * eta_i * (1 + xi_i * xi) * (1 + zeta_i * zeta)\n                        dNi_dzeta = 0.125 * zeta_i * (1 + xi_i * xi) * (1 + eta_i * eta)\n\n                        # Derivatives w.r.t. physical coords using Jacobian\n                        dNi_dx = dNi_dxi * 2.0 / H\n                        dNi_dy = dNi_deta * 2.0 / W\n                        dNi_dz = dNi_dzeta * 2.0 / L\n\n                        # Assemble B_i into global B\n                        B[0, 3 * i]     = dNi_dx\n                        B[1, 3 * i + 1] = dNi_dy\n                        B[2, 3 * i + 2] = dNi_dz\n                        B[3, 3 * i]     = dNi_dy\n                        B[3, 3 * i + 1] = dNi_dx\n                        B[4, 3 * i + 1] = dNi_dz\n                        B[4, 3 * i + 2] = dNi_dy\n                        B[5, 3 * i]     = dNi_dz\n                        B[5, 3 * i + 2] = dNi_dx\n                        \n                    Ke += B.T @ D @ B * (w_xi * w_eta * w_zeta) * detJ\n\n        # 4. Apply Boundary Conditions\n        # Ventral nodes (x=0, xi=-1): 1, 4, 5, 8\n        ventral_node_indices = [0, 3, 4, 7]\n        # Dorsal nodes (x=H, xi=1): 2, 3, 6, 7\n        dorsal_node_indices = [1, 2, 5, 6]\n\n        active_dofs = []\n        for i in ventral_node_indices:\n            active_dofs.extend([3 * i, 3 * i + 1, 3 * i + 2])\n        \n        K_red = Ke[np.ix_(active_dofs, active_dofs)]\n        f_red = np.zeros(len(active_dofs))\n\n        # 5. Apply Penalty Contact\n        A_ventral = W * L\n        k_n_node = alpha_n * E * (A_ventral / 4.0) / H\n        k_t_node = alpha_t * E * (A_ventral / 4.0) / H\n        \n        for i in range(len(ventral_node_indices)):\n            # Indices in the reduced 12x12 system\n            idx_x = 3 * i\n            idx_y = 3 * i + 1\n            idx_z = 3 * i + 2\n            \n            K_red[idx_x, idx_x] += k_n_node\n            K_red[idx_y, idx_y] += k_t_node\n            K_red[idx_z, idx_z] += k_t_node\n            \n            f_red[idx_x] += k_n_node * delta\n            \n        # 6. Solve for Displacements\n        u_red = np.linalg.solve(K_red, f_red)\n        \n        u = np.zeros(24)\n        u[active_dofs] = u_red\n\n        # 7. Post-Processing: Reaction Force\n        total_reaction = np.zeros(3)\n        for i_node, node_idx in enumerate(ventral_node_indices):\n            u_node = u_red[3*i_node : 3*i_node+3]\n            u_x, u_y, u_z = u_node\n\n            r_n = k_n_node * (u_x - delta)\n            r_ty = k_t_node * u_y\n            r_tz = k_t_node * u_z\n\n            r_t_mag = np.sqrt(r_ty**2 + r_tz**2)\n            f_lim = mu_friction * abs(r_n)\n            \n            if r_t_mag > f_lim and r_t_mag > 1e-12: # Avoid division by zero\n                scale = f_lim / r_t_mag\n                r_ty *= scale\n                r_tz *= scale\n\n            total_reaction += [r_n, r_ty, r_tz]\n        \n        reaction_magnitude = np.linalg.norm(total_reaction)\n\n        # 8. Post-Processing: Stress\n        max_vm_stress = 0.0\n        for xi in gauss_points:\n            for eta in gauss_points:\n                for zeta in gauss_points:\n                    \n                    B = np.zeros((6, 24))\n                    for i in range(8):\n                        xi_i, eta_i, zeta_i = node_coords_parent[i]\n                        dNi_dxi = 0.125 * xi_i * (1 + eta_i * eta) * (1 + zeta_i * zeta)\n                        dNi_deta = 0.125 * eta_i * (1 + xi_i * xi) * (1 + zeta_i * zeta)\n                        dNi_dzeta = 0.125 * zeta_i * (1 + xi_i * xi) * (1 + eta_i * eta)\n                        dNi_dx = dNi_dxi * 2.0 / H\n                        dNi_dy = dNi_deta * 2.0 / W\n                        dNi_dz = dNi_dzeta * 2.0 / L\n                        B[0, 3 * i] = dNi_dx; B[1, 3 * i + 1] = dNi_dy; B[2, 3 * i + 2] = dNi_dz\n                        B[3, 3 * i] = dNi_dy; B[3, 3 * i + 1] = dNi_dx\n                        B[4, 3 * i + 1] = dNi_dz; B[4, 3 * i + 2] = dNi_dy\n                        B[5, 3 * i] = dNi_dz; B[5, 3 * i + 2] = dNi_dx\n                        \n                    strain = B @ u\n                    stress = D @ strain\n                    \n                    s_xx, s_yy, s_zz = stress[0], stress[1], stress[2]\n                    t_xy, t_yz, t_zx = stress[3], stress[4], stress[5] # tau in Voigt\n                    \n                    vm_stress = np.sqrt(\n                        0.5 * ((s_xx - s_yy)**2 + (s_yy - s_zz)**2 + (s_zz - s_xx)**2) +\n                        3.0 * (t_xy**2 + t_yz**2 + t_zx**2)\n                    )\n                    if vm_stress > max_vm_stress:\n                        max_vm_stress = vm_stress\n\n        results.append([reaction_magnitude, max_vm_stress])\n    \n    # Final print statement in the exact required format.\n    print(f\"[[{results[0][0]},{results[0][1]}],[{results[1][0]},{results[1][1]}],[{results[2][0]},{results[2][1]}],[{results[3][0]},{results[3][1]}]]\")\n\nsolve()\n```"
        }
    ]
}