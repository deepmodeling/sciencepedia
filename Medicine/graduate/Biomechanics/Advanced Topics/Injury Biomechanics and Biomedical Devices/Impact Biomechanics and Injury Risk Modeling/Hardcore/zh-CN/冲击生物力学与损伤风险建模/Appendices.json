{
    "hands_on_practices": [
        {
            "introduction": "要深刻理解损伤生物力学中的损伤准则，仅仅会应用是远远不够的，还必须掌握其数学根源。本练习将通过一个理想化的冲击场景来剖析应用广泛的头部损伤指数（$HIC$）。通过为简单的矩形加速度脉冲推导 $HIC$ 的解析表达式，我们将揭示该准则如何随冲击强度和持续时间变化，从而深入理解其内在的物理和数学原理。",
            "id": "4179087",
            "problem": "在一次短时冲击中，一个人头替代物进行纯平移运动。头部质心的加速度时程，经标准重力加速度的量值归一化（因此是无量纲的），由一个矩形脉冲表示：\n$$\na(t)=\\begin{cases}\na_0,  0 \\leq t \\leq \\Delta t,\\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n其中 $a_0>0$ 是常数，$\\Delta t>0$ 是脉冲持续时间。头部伤害标准（HIC）是冲击生物力学和汽车安全领域广泛使用的一种伤害风险度量指标。它被定义为，在所有长度不超过允许时间窗口 $T^{\\ast}$ 的时间区间上，区间长度与该区间平均加速度的 $2.5$ 次方之乘积的最大值：\n$$\n\\mathrm{HIC} \\equiv \\max_{t_1,t_2}\\left\\{\\,(t_2-t_1)\\left[\\frac{1}{t_2 - t_1}\\int_{t_1}^{t_2} a(t)\\, dt\\right]^{2.5}\\,\\right\\}, \\quad \\text{subject to } t_2 - t_1 \\leq T^{\\ast}.\n$$\n假设规范窗口 $T^{\\ast}$ 满足 $\\Delta t \\leq T^{\\ast}$（例如，$T^{\\ast}=36\\,\\mathrm{ms}$ 且 $\\Delta t \\leq 36\\,\\mathrm{ms}$）。从这个定义和运动学的基本原理（例如，平均加速度作为时间积分的定义）出发，为上述矩形脉冲推导出一个用 $a_0$ 和 $\\Delta t$ 表示的 HIC 闭式表达式，并确定在这种理想化情况下 HIC 如何随 $a_0$ 和 $\\Delta t$ 变化。\n\n你的最终答案应以秒为单位表示。你的最终答案必须是一个用 $a_0$ 和 $\\Delta t$ 表示的单一解析表达式。",
            "solution": "头部伤害标准（HIC）是通过在窗口 $[t_1,t_2]$ 上的时间平均加速度以及在持续时间不超过指定限制 $T^{\\ast}$ 的可行窗口上进行最大化来定义的。对于一个一般的加速度时程 $a(t)$，需要最大化的泛函是：\n$$\nH(t_1,t_2) = (t_2 - t_1)\\left[\\frac{1}{t_2 - t_1}\\int_{t_1}^{t_2} a(t)\\, dt\\right]^{2.5}, \\quad \\text{with } t_2 - t_1 \\leq T^{\\ast}.\n$$\n我们通过分析矩形脉冲的 $H(t_1,t_2)$ 来进行推导。\n$$\na(t)=\\begin{cases}\na_0,  0 \\leq t \\leq \\Delta t,\\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n其中 $a_0$ 是一个恒定的无量纲加速度（由重力加速度归一化），且 $\\Delta t \\leq T^{\\ast}$。\n\n首先，考虑任何完全位于脉冲内部的窗口 $[t_1,t_2]$，即 $0 \\leq t_1  t_2 \\leq \\Delta t$。对于这样的窗口，加速度是恒定的，所以其时间平均值等于该恒定值：\n$$\n\\frac{1}{t_2 - t_1}\\int_{t_1}^{t_2} a(t)\\, dt = \\frac{1}{t_2 - t_1}\\int_{t_1}^{t_2} a_0\\, dt = \\frac{1}{t_2 - t_1}\\, a_0 (t_2 - t_1) = a_0.\n$$\n因此，对于完全在矩形脉冲内部的窗口，\n$$\nH(t_1,t_2) = (t_2 - t_1)\\left[a_0\\right]^{2.5} = a_0^{2.5}(t_2 - t_1).\n$$\n该表达式关于窗口持续时间 $(t_2 - t_1)$ 是线性的，这意味着在脉冲内部，$H(t_1,t_2)$ 随窗口长度单调递增。因此，在完全位于脉冲内部的窗口上的最大值，是通过选择最长的此类窗口来达到的。根据假设 $\\Delta t \\leq T^{\\ast}$，完全在脉冲内部的最长窗口就是整个脉冲本身，即 $t_1=0$ 和 $t_2=\\Delta t$。因此，\n$$\nH_{\\text{inside,max}} = a_0^{2.5}\\Delta t.\n$$\n\n接下来，考虑延伸到脉冲之外并包含 $a(t)=0$ 的时间段的窗口。假设一个持续时间为 $\\tau \\equiv t_2 - t_1$ 的窗口 $[t_1,t_2]$ 与脉冲重叠的部分长度为 $\\ell \\leq \\min\\{\\tau,\\Delta t\\}$，并包含 $(\\tau - \\ell)$ 持续时间的零加速度。那么 $a(t)$ 在该窗口上的积分为\n$$\n\\int_{t_1}^{t_2} a(t)\\, dt = a_0 \\, \\ell + 0 \\cdot (\\tau - \\ell) = a_0 \\ell,\n$$\n所以该窗口上的平均加速度为\n$$\n\\bar{a} = \\frac{1}{\\tau}\\int_{t_1}^{t_2} a(t)\\, dt = \\frac{a_0 \\ell}{\\tau}.\n$$\n相应的 HIC 泛函值为\n$$\nH(t_1,t_2) = \\tau \\left(\\frac{a_0 \\ell}{\\tau}\\right)^{2.5} = a_0^{2.5} \\, \\tau \\left(\\frac{\\ell}{\\tau}\\right)^{2.5} = a_0^{2.5} \\, \\frac{\\ell^{2.5}}{\\tau^{1.5}}.\n$$\n对于固定的重叠长度 $\\ell$，由于因子 $\\tau^{-1.5}$ 减小，该表达式随着 $\\tau$ 的增加而减小。在固定 $\\ell$ 的情况下，关于 $\\tau$ 的最大值在 $\\tau$ 取可能最小值时出现，即 $\\tau=\\ell$（即窗口完全位于脉冲内部）。代入 $\\tau=\\ell$ 可得：\n$$\nH_{\\text{overlap,max at fixed } \\ell} = a_0^{2.5}\\, \\ell.\n$$\n通过选择可能的最大重叠长度 $\\ell$（即 $\\ell=\\Delta t$，整个脉冲），该表达式可达到最大值。因此，在所有包含脉冲外任何时间的窗口中，其最大值不会超过由恰好跨越整个脉冲且不包含零加速度时间的窗口所获得的值。这证明了，在 $\\Delta t \\leq T^{\\ast}$ 的条件下，所有允许窗口上的全局最大值由窗口 $[0,\\Delta t]$ 达到。\n\n综合这些结果，头部伤害标准为：\n$$\n\\mathrm{HIC} = a_0^{2.5}\\Delta t.\n$$\n由于 $a_0$ 是无量纲的（由重力加速度归一化），HIC 的单位是秒，该单位继承自因子 $\\Delta t$。因此，HIC 与矩形脉冲参数的标度关系是：与持续时间成线性关系，且与幅值的 $2.5$ 次方成正比：\n$$\n\\mathrm{HIC} \\propto a_0^{2.5} \\quad \\text{and} \\quad \\mathrm{HIC} \\propto \\Delta t.\n$$\n在所述假设 $\\Delta t \\leq T^{\\ast}$ 下，闭式表达式为 $\\mathrm{HIC} = a_0^{2.5}\\Delta t$。",
            "answer": "$$\\boxed{a_0^{2.5}\\,\\Delta t}$$"
        },
        {
            "introduction": "有效的伤害防护通常依赖于能够吸收冲击能量的材料和结构。本练习通过一个简化的头盔-颅骨力学模型来探究这一核心原理，将颅骨和頭盔衬垫视为串联的弹簧系统。通过分析应变能在两个层级之间的分配，您将能够量化衬垫的保护作用，并学会区分材料的固有柔度与结构的整体柔度这两个重要概念。",
            "id": "4179151",
            "problem": "一个佩戴头盔的人类头部法向冲击被建模为串联加载的两个均匀、各向同性、线弹性层：一个颅骨层（头骨）和一个柔性衬垫层（头盔内衬），两者共享相同的圆形接触区域。接触区域面积为 $A = 0.006\\,\\mathrm{m}^2$。头骨层的厚度为 $t_{s} = 0.007\\,\\mathrm{m}$，弹性模量为 $E_{s} = 15 \\times 10^{9}\\,\\mathrm{Pa}$。衬垫层的厚度为 $t_{p} = 0.020\\,\\mathrm{m}$，弹性模量为 $E_{p} = 40 \\times 10^{6}\\,\\mathrm{Pa}$。一个随时间变化的法向接触力 $F(t)$ 作用于接触区域，其峰值为 $F_{\\max} = 3000\\,\\mathrm{N}$。假设在峰值载荷瞬间，响应是准静态的，两层都保持在其线弹性范围内，且载荷均匀分布在接触区域上。\n\n仅从应力 $\\sigma$、应变 $\\epsilon$、胡克定律 $\\sigma = E\\,\\epsilon$ 的定义，每层的应变与位移之间的几何关系，以及串联弹性元件的平衡（相同的轴向力传递通过每一层）出发，推导区分此双层系统的局部材料柔度和整体结构柔度的表达式。然后，使用这些表达式，在 $F(t) = F_{\\max}$ 的瞬间，推导头骨和衬垫之间总弹性应变能的能量划分，并计算存储在头骨中的总弹性应变能的分数。\n\n将头骨能量分数报告为一个小数，四舍五入到 $4$ 位有效数字。该分数为无量纲；在最终报告的值中不要包含任何单位。",
            "solution": "该问题被评估为有效，具有科学依据、提法明确且客观。它提出了一个生物力学中的标准（尽管简化了）模型，可以使用固体力学的基本原理解答。所有必要的数据都已提供，假设陈述清晰，并且对于问题的范围来说在物理上是合理的。\n\n该模型由两个串联的弹性层组成：头骨（$s$）和衬垫（$p$）。这意味着它们共享相同的接触面积 $A$，并承受相同的法向力 $F(t)$。在准静态峰值载荷的瞬间，此力为 $F = F_{\\max}$。\n\n单轴应力 $\\sigma$ 的定义是单位面积上的力。由于力 $F_{\\max}$ 和面积 $A$ 对两层都是共同的，所以每层中的应力是相同的：\n$$\n\\sigma_s = \\sigma_p = \\sigma = \\frac{F_{\\max}}{A}\n$$\n\n单轴应变 $\\epsilon$ 的定义是长度变化量与原始长度之比。对于厚度为 $t$ 的每一层，其压缩量（位移） $\\delta$ 与应变的关系为 $\\epsilon = \\delta/t$。\n\n线性弹性材料的胡克定律通过弹性模量 $E$ 将应力和应变联系起来：\n$$\n\\sigma = E \\epsilon\n$$\n将此定律应用于每一层，我们得到头骨和衬垫中的应变：\n$$\n\\epsilon_s = \\frac{\\sigma}{E_s} \\quad \\text{和} \\quad \\epsilon_p = \\frac{\\sigma}{E_p}\n$$\n\n每层的压缩量 $\\delta_s$ 和 $\\delta_p$ 可以用施加的力来表示：\n$$\n\\delta_s = \\epsilon_s t_s = \\frac{\\sigma}{E_s} t_s = \\left(\\frac{F_{\\max}}{A}\\right) \\frac{t_s}{E_s}\n$$\n$$\n\\delta_p = \\epsilon_p t_p = \\frac{\\sigma}{E_p} t_p = \\left(\\frac{F_{\\max}}{A}\\right) \\frac{t_p}{E_p}\n$$\n\n一个元件的结构刚度 $k$ 由关系式 $F = k\\delta$ 定义。对于每一层，刚度为：\n$$\nk_s = \\frac{F_{\\max}}{\\delta_s} = \\frac{F_{\\max}}{\\left(\\frac{F_{\\max}}{A}\\right) \\frac{t_s}{E_s}} = \\frac{A E_s}{t_s}\n$$\n$$\nk_p = \\frac{F_{\\max}}{\\delta_p} = \\frac{F_{\\max}}{\\left(\\frac{F_{\\max}}{A}\\right) \\frac{t_p}{E_p}} = \\frac{A E_p}{t_p}\n$$\n\n这些表达式使我们能够区分局部材料柔度和整体结构柔度。\n- **局部材料柔度**是一种内在的材料属性，定义为弹性模量的倒数 $1/E$。它量化了材料在应力下固有的可变形性，与其尺寸或形状无关。$1/E$ 值高（或 $E$ 值低）的材料具有高柔度。\n- **整体结构柔度** $C_{struct}$ 是组件的一个外在属性，定义为其刚度的倒数 $C_{struct} = 1/k$。对于我们的分层，这是 $C_{struct} = t/(AE)$。这个表达式明确显示，结构的整体可变形性不仅取决于材料的属性（$E$），还取决于其几何形状（厚度 $t$ 和面积 $A$）。\n\n储存在线性弹性体中的弹性应变能 $U$ 可以用几种等效形式表示。对于这个问题，一个方便的形式是 $U = \\frac{1}{2} \\frac{F^2}{k}$。在峰值力 $F_{\\max}$ 的瞬间，将此应用于头骨和衬垫层：\n$$\nU_s = \\frac{1}{2} \\frac{F_{\\max}^2}{k_s} = \\frac{1}{2} F_{\\max}^2 \\left(\\frac{t_s}{A E_s}\\right)\n$$\n$$\nU_p = \\frac{1}{2} \\frac{F_{\\max}^2}{k_p} = \\frac{1}{2} F_{\\max}^2 \\left(\\frac{t_p}{A E_p}\\right)\n$$\n\n存储在双层系统中的总弹性应变能是每层能量的总和：\n$$\nU_{total} = U_s + U_p\n$$\n\n我们需要求出存储在头骨中的总能量的分数。即比率 $\\frac{U_s}{U_{total}}$：\n$$\n\\frac{U_s}{U_{total}} = \\frac{U_s}{U_s + U_p} = \\frac{\\frac{1}{2} F_{\\max}^2 \\left(\\frac{t_s}{A E_s}\\right)}{\\frac{1}{2} F_{\\max}^2 \\left(\\frac{t_s}{A E_s}\\right) + \\frac{1}{2} F_{\\max}^2 \\left(\\frac{t_p}{A E_p}\\right)}\n$$\n分子和分母中的公因子 $\\frac{1}{2} \\frac{F_{\\max}^2}{A}$ 相互抵消，得到所需的能量划分表达式：\n$$\n\\frac{U_s}{U_{total}} = \\frac{\\frac{t_s}{E_s}}{\\frac{t_s}{E_s} + \\frac{t_p}{E_p}}\n$$\n这个结果表明，串联加载系统中应变能的划分与施加的力和接触面积无关，仅由每层单位面积的结构柔度之比 $t/E$ 决定。\n\n现在，我们代入给定的数值来计算这个分数：\n- 头骨厚度，$t_s = 0.007\\,\\mathrm{m}$\n- 头骨弹性模量，$E_s = 15 \\times 10^{9}\\,\\mathrm{Pa}$\n- 衬垫厚度，$t_p = 0.020\\,\\mathrm{m}$\n- 衬垫弹性模量，$E_p = 40 \\times 10^{6}\\,\\mathrm{Pa}$\n\n首先，我们计算每层的柔度-厚度项：\n$$\n\\frac{t_s}{E_s} = \\frac{0.007}{15 \\times 10^{9}} = \\frac{7 \\times 10^{-3}}{15 \\times 10^{9}} = \\frac{7}{15} \\times 10^{-12}\\,\\mathrm{m/Pa} \\approx 4.6667 \\times 10^{-13}\\,\\mathrm{m/Pa}\n$$\n$$\n\\frac{t_p}{E_p} = \\frac{0.020}{40 \\times 10^{6}} = \\frac{2 \\times 10^{-2}}{4 \\times 10^{7}} = 0.5 \\times 10^{-9}\\,\\mathrm{m/Pa} = 500 \\times 10^{-12}\\,\\mathrm{m/Pa}\n$$\n\n现在，我们将这些代入分数表达式中：\n$$\n\\frac{U_s}{U_{total}} = \\frac{\\frac{7}{15} \\times 10^{-12}}{\\frac{7}{15} \\times 10^{-12} + 500 \\times 10^{-12}} = \\frac{\\frac{7}{15}}{\\frac{7}{15} + 500}\n$$\n为了合并分母中的项：$500 = \\frac{7500}{15}$。\n$$\n\\frac{U_s}{U_{total}} = \\frac{\\frac{7}{15}}{\\frac{7}{15} + \\frac{7500}{15}} = \\frac{\\frac{7}{15}}{\\frac{7507}{15}} = \\frac{7}{7507}\n$$\n进行最后的除法运算：\n$$\n\\frac{7}{7507} \\approx 0.0009324629...\n$$\n四舍五入到 $4$ 位有效数字，存储在头骨中的总弹性应变能的分数为 $0.0009325$。",
            "answer": "$$\n\\boxed{0.0009325}\n$$"
        },
        {
            "introduction": "现代冲击生物力学在很大程度上依赖于有限元（FE）等计算方法来预测组织层面的损伤。本练习旨在弥合原始模拟输出与临床相关损伤指标之间的鸿沟。您将亲手实现累积应变损伤度量（$CSDM$），这是一种通过对经历高应变组织的体积进行时间积分来量化脑损伤风险的指标，从而掌握后处理复杂模拟数据的关键技术。",
            "id": "4179186",
            "problem": "给定一个来自有限元头部撞击模拟的、随时间变化的、体素化的应变场。设有 $N$ 个体素，索引为 $i \\in \\{1,\\dots,N\\}$，其应变时间历史 $\\varepsilon_i(t)$ 在离散时间点 $t_0  t_1  \\dots  t_{M-1}$ 进行采样，总时长为 $T = t_{M-1} - t_0$，单位为 $\\mathrm{s}$。考虑一个固定的应变阈值 $\\varepsilon_{\\text{th}}$（无量纲）。定义瞬时超阈值指示函数 $\\mathbb{1}[\\varepsilon_i(t)  \\varepsilon_{\\text{th}}]$，如果 $\\varepsilon_i(t)$ 严格超过该阈值，其值为 $1$，否则为 $0$。在时间 $t$ 超过阈值的体素瞬时分数是\n$$\nf(t) = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbb{1}\\big[\\varepsilon_i(t)  \\varepsilon_{\\text{th}}\\big].\n$$\n在区间 $[t_0,t_{M-1}]$ 上的累积应变损伤度量（Cumulative Strain Damage Measure, CSDM）是 $f(t)$ 的时间平均值：\n$$\n\\mathrm{CSDM} = \\frac{1}{T} \\int_{t_0}^{t_{M-1}} f(t)\\, dt,\n$$\n它通过对超过阈值的体素分数进行时间积分来捕捉重复的超阈值事件。在使用离散且可能非均匀的采样时间进行计算时，使用梯形法则来近似该积分，\n$$\n\\mathrm{CSDM} \\approx \\frac{1}{T} \\sum_{k=0}^{M-2} \\frac{f(t_k) + f(t_{k+1})}{2}\\, \\Delta t_k,\\quad \\Delta t_k = t_{k+1} - t_k.\n$$\n所有应变和阈值均为无量纲；时间单位必须是 $\\mathrm{s}$。您的程序必须为以下 $6$ 个测试用例计算 $\\mathrm{CSDM}$，并将结果打印为单行，形式为方括号内包含的逗号分隔列表。每个结果必须四舍五入到 $6$ 位小数。阈值比较必须是严格的（$\\varepsilon_i(t)  \\varepsilon_{\\text{th}}$），而非包含性的。\n\n测试用例（每个用例包含时间样本、一个应变矩阵（行对应时间，列对应体素）和一个阈值）：\n\n- 用例 1：$t^{(1)} = [0, 1, 2]\\,\\mathrm{s}$，$N^{(1)} = 4$，阈值 $\\varepsilon_{\\text{th}}^{(1)} = 0.15$，应变\n$$\n\\boldsymbol{\\varepsilon}^{(1)} =\n\\begin{bmatrix}\n0.10  0.20  0.00  0.15 \\\\\n0.20  0.20  0.16  0.14 \\\\\n0.10  0.10  0.10  0.14\n\\end{bmatrix}.\n$$\n\n- 用例 2：$t^{(2)} = [0.0, 0.5, 1.5, 2.0]\\,\\mathrm{s}$，$N^{(2)} = 5$，阈值 $\\varepsilon_{\\text{th}}^{(2)} = 0.15$，应变\n$$\n\\boldsymbol{\\varepsilon}^{(2)} =\n\\begin{bmatrix}\n0.00  0.16  0.14  0.20  0.20 \\\\\n0.00  0.10  0.14  0.20  0.20 \\\\\n0.16  0.16  0.14  0.14  0.20 \\\\\n0.00  0.00  0.00  0.00  0.14\n\\end{bmatrix}.\n$$\n\n- 用例 3：$t^{(3)} = [0, 1]\\,\\mathrm{s}$，$N^{(3)} = 3$，阈值 $\\varepsilon_{\\text{th}}^{(3)} = 0.50$，应变\n$$\n\\boldsymbol{\\varepsilon}^{(3)} =\n\\begin{bmatrix}\n0.10  0.20  0.30 \\\\\n0.05  0.10  0.15\n\\end{bmatrix}.\n$$\n\n- 用例 4：$t^{(4)} = [0, 2]\\,\\mathrm{s}$，$N^{(4)} = 2$，阈值 $\\varepsilon_{\\text{th}}^{(4)} = 0.05$，应变\n$$\n\\boldsymbol{\\varepsilon}^{(4)} =\n\\begin{bmatrix}\n0.10  0.20 \\\\\n0.10  0.20\n\\end{bmatrix}.\n$$\n\n- 用例 5：$t^{(5)} = [0, 1, 2]\\,\\mathrm{s}$，$N^{(5)} = 4$，阈值 $\\varepsilon_{\\text{th}}^{(5)} = 0.15$，应变\n$$\n\\boldsymbol{\\varepsilon}^{(5)} =\n\\begin{bmatrix}\n0.15  0.15  0.15  0.15 \\\\\n0.15  0.16  0.15  0.14 \\\\\n0.15  0.15  0.15  0.15\n\\end{bmatrix}.\n$$\n\n- 用例 6：$t^{(6)} = [0, 0.25, 0.5, 0.75, 1.0]\\,\\mathrm{s}$，$N^{(6)} = 4$，阈值 $\\varepsilon_{\\text{th}}^{(6)} = 0.20$，应变\n$$\n\\boldsymbol{\\varepsilon}^{(6)} =\n\\begin{bmatrix}\n0.00  0.00  0.00  0.00 \\\\\n0.00  0.21  0.00  0.00 \\\\\n0.00  0.22  0.00  0.00 \\\\\n0.00  0.19  0.00  0.00 \\\\\n0.00  0.00  0.00  0.00\n\\end{bmatrix}.\n$$\n\n要求：\n- 根据上述第一性原理实现构建过程：从体素的超阈值情况计算 $f(t_k)$，然后使用给定的 $t_k$ 应用梯形法则来近似积分，最后除以 $T$。\n- 输出单行，其中包含 $6$ 个 CSDM 值，格式为方括号内的逗号分隔列表，例如 $[x_1,x_2,\\dots,x_6]$，其中每个 $x_j$ 是四舍五入到 $6$ 位小数的十进制数。\n- 结果是无量纲的。",
            "solution": "所述问题在形式上和科学上是有效的。它是自洽的，提供了所有必要的数据和定义。其概念植根于冲击生物力学领域，特别是在根据有限元模拟数据构建损伤风险度量方面。关于超阈值体素的瞬时分数 $f(t)$ 和累积应变损伤度量（CSDM）的定义在数学上是精确的。对于离散采样数据，使用梯形法则进行数值积分是一种标准且合适的技术。问题陈述中没有矛盾、歧义或事实不准确之处。因此，我们可以着手求解。\n\n核心任务是为六个不同的测试用例计算累积应变损伤度量（$\\mathrm{CSDM}$）。该过程包括三个主要阶段：\n1.  对于每个离散时间点 $t_k$，确定其应变 $\\varepsilon_i(t_k)$ 严格超过给定阈值 $\\varepsilon_{\\text{th}}$ 的体素分数 $f(t_k)$。\n2.  使用梯形法则近似计算 $f(t)$ 在模拟持续时间内的定积分。\n3.  将此积分值除以总模拟时长 $T$ 进行归一化，以获得 $\\mathrm{CSDM}$。\n\n设每个用例的给定数据为时间样本集 $\\{t_k\\}_{k=0}^{M-1}$、大小为 $M \\times N$ 的应变矩阵 $\\boldsymbol{\\varepsilon}$（其中 $\\varepsilon_{ki} = \\varepsilon_i(t_k)$）、体素数量 $N$ 以及应变阈值 $\\varepsilon_{\\text{th}}$。\n\n在时间 $t_k$ 超过阈值的体素瞬时分数由下式给出：\n$$f(t_k) = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbb{1}\\big[\\varepsilon_i(t_k)  \\varepsilon_{\\text{th}}\\big]$$\n其中 $\\mathbb{1}[\\cdot]$ 是指示函数。\n\n模拟的总时长为 $T = t_{M-1} - t_0$。\n\n$\\mathrm{CSDM}$ 的近似计算公式为：\n$$\\mathrm{CSDM} \\approx \\frac{1}{T} \\sum_{k=0}^{M-2} \\frac{f(t_k) + f(t_{k+1})}{2}\\, (t_{k+1} - t_k)$$\n这等同于使用梯形法计算由点 $(t_k, f(t_k))$ 定义的曲线下的面积，然后除以总时间跨度 $T$。\n\n现在我们将此计算过程应用于每个测试用例。\n\n**用例 1：**\n- $t^{(1)} = [0, 1, 2]\\,\\mathrm{s}$，所以 $M=3$, $t_0=0, t_1=1, t_2=2$。\n- $N^{(1)} = 4$。\n- $\\varepsilon_{\\text{th}}^{(1)} = 0.15$。\n- 在 $t_0=0$ 时：应变为 $[0.10, 0.20, 0.00, 0.15]$。一个体素（$0.20$）超过 $0.15$。因此，$f(t_0) = 1/4 = 0.25$。\n- 在 $t_1=1$ 时：应变为 $[0.20, 0.20, 0.16, 0.14]$。三个体素（$0.20, 0.20, 0.16$）超过 $0.15$。因此，$f(t_1) = 3/4 = 0.75$。\n- 在 $t_2=2$ 时：应变为 $[0.10, 0.10, 0.10, 0.14]$。零个体素超过 $0.15$。因此，$f(t_2) = 0/4 = 0.0$。\n- 分数序列为 $f(t) = [0.25, 0.75, 0.0]$。\n- 总时长 $T = t_2-t_0 = 2-0=2\\,\\mathrm{s}$。\n- 积分近似值：$\\frac{f(t_0)+f(t_1)}{2}(t_1-t_0) + \\frac{f(t_1)+f(t_2)}{2}(t_2-t_1) = \\frac{0.25+0.75}{2}(1) + \\frac{0.75+0.0}{2}(1) = 0.5 + 0.375 = 0.875$。\n- $\\mathrm{CSDM}^{(1)} = \\frac{1}{T} \\times 0.875 = \\frac{1}{2} \\times 0.875 = 0.4375$。\n\n**用例 2：**\n- $t^{(2)} = [0.0, 0.5, 1.5, 2.0]\\,\\mathrm{s}$，所以 $M=4$。\n- $N^{(2)} = 5$。\n- $\\varepsilon_{\\text{th}}^{(2)} = 0.15$。\n- 在 $t_0=0.0$ 时：应变为 $[0.00, 0.16, 0.14, 0.20, 0.20]$。三个超过 $0.15$。$f(t_0) = 3/5 = 0.6$。\n- 在 $t_1=0.5$ 时：应变为 $[0.00, 0.10, 0.14, 0.20, 0.20]$。两个超过 $0.15$。$f(t_1) = 2/5 = 0.4$。\n- 在 $t_2=1.5$ 时：应变为 $[0.16, 0.16, 0.14, 0.14, 0.20]$。三个超过 $0.15$。$f(t_2) = 3/5 = 0.6$。\n- 在 $t_3=2.0$ 时：应变为 $[0.00, 0.00, 0.00, 0.00, 0.14]$。零个超过 $0.15$。$f(t_3) = 0/5 = 0.0$。\n- 分数序列为 $f(t) = [0.6, 0.4, 0.6, 0.0]$。\n- 总时长 $T = 2.0 - 0.0 = 2.0\\,\\mathrm{s}$。\n- 积分：$\\frac{0.6+0.4}{2}(0.5) + \\frac{0.4+0.6}{2}(1.0) + \\frac{0.6+0.0}{2}(0.5) = 0.5(0.5) + 0.5(1.0) + 0.3(0.5) = 0.25 + 0.5 + 0.15 = 0.9$。\n- $\\mathrm{CSDM}^{(2)} = \\frac{1}{2.0} \\times 0.9 = 0.45$。\n\n**用例 3：**\n- $t^{(3)} = [0, 1]\\,\\mathrm{s}$，所以 $M=2$。\n- $N^{(3)} = 3$。\n- $\\varepsilon_{\\text{th}}^{(3)} = 0.50$。\n- 在 $t_0=0$ 时：应变为 $[0.10, 0.20, 0.30]$。零个超过 $0.50$。$f(t_0) = 0/3 = 0.0$。\n- 在 $t_1=1$ 时：应变为 $[0.05, 0.10, 0.15]$。零个超过 $0.50$。$f(t_1) = 0/3 = 0.0$。\n- 分数序列为 $f(t) = [0.0, 0.0]$。\n- 总时长 $T = 1-0 = 1\\,\\mathrm{s}$。\n- 积分：$\\frac{0.0+0.0}{2}(1) = 0$。\n- $\\mathrm{CSDM}^{(3)} = \\frac{1}{1} \\times 0 = 0.0$。\n\n**用例 4：**\n- $t^{(4)} = [0, 2]\\,\\mathrm{s}$，所以 $M=2$。\n- $N^{(4)} = 2$。\n- $\\varepsilon_{\\text{th}}^{(4)} = 0.05$。\n- 在 $t_0=0$ 时：应变为 $[0.10, 0.20]$。两个都超过 $0.05$。$f(t_0) = 2/2 = 1.0$。\n- 在 $t_1=2$ 时：应变为 $[0.10, 0.20]$。两个都超过 $0.05$。$f(t_1) = 2/2 = 1.0$。\n- 分数序列为 $f(t) = [1.0, 1.0]$。\n- 总时长 $T = 2-0 = 2\\,\\mathrm{s}$。\n- 积分：$\\frac{1.0+1.0}{2}(2) = 2.0$。\n- $\\mathrm{CSDM}^{(4)} = \\frac{1}{2} \\times 2.0 = 1.0$。\n\n**用例 5：**\n- $t^{(5)} = [0, 1, 2]\\,\\mathrm{s}$，所以 $M=3$。\n- $N^{(5)} = 4$。\n- $\\varepsilon_{\\text{th}}^{(5)} = 0.15$。\n- 在 $t_0=0$ 时：应变为 $[0.15, 0.15, 0.15, 0.15]$。零个体素超过 $0.15$（严格不等式）。$f(t_0) = 0/4 = 0.0$。\n- 在 $t_1=1$ 时：应变为 $[0.15, 0.16, 0.15, 0.14]$。一个体素（$0.16$）超过 $0.15$。$f(t_1) = 1/4 = 0.25$。\n- 在 $t_2=2$ 时：应变为 $[0.15, 0.15, 0.15, 0.15]$。零个体素超过 $0.15$。$f(t_2) = 0/4 = 0.0$。\n- 分数序列为 $f(t) = [0.0, 0.25, 0.0]$。\n- 总时长 $T = 2-0 = 2\\,\\mathrm{s}$。\n- 积分：$\\frac{0.0+0.25}{2}(1) + \\frac{0.25+0.0}{2}(1) = 0.125 + 0.125 = 0.25$。\n- $\\mathrm{CSDM}^{(5)} = \\frac{1}{2} \\times 0.25 = 0.125$。\n\n**用例 6：**\n- $t^{(6)} = [0, 0.25, 0.5, 0.75, 1.0]\\,\\mathrm{s}$，所以 $M=5$。\n- $N^{(6)} = 4$。\n- $\\varepsilon_{\\text{th}}^{(6)} = 0.20$。\n- 在 $t_0=0.00$ 时：应变为 $[0,0,0,0]$。零个超过 $0.20$。$f(t_0) = 0/4 = 0.0$。\n- 在 $t_1=0.25$ 时：应变为 $[0.00, 0.21, 0.00, 0.00]$。一个体素（$0.21$）超过 $0.20$。$f(t_1) = 1/4 = 0.25$。\n- 在 $t_2=0.50$ 时：应变为 $[0.00, 0.22, 0.00, 0.00]$。一个体素（$0.22$）超过 $0.20$。$f(t_2) = 1/4 = 0.25$。\n- 在 $t_3=0.75$ 时：应变为 $[0.00, 0.19, 0.00, 0.00]$。零个超过 $0.20$。$f(t_3) = 0/4 = 0.0$。\n- 在 $t_4=1.00$ 时：应变为 $[0,0,0,0]$。零个超过 $0.20$。$f(t_4) = 0/4 = 0.0$。\n- 分数序列为 $f(t) = [0.0, 0.25, 0.25, 0.0, 0.0]$。\n- 总时长 $T = 1.0 - 0.0 = 1.0\\,\\mathrm{s}$。\n- 积分：$\\frac{0.0+0.25}{2}(0.25) + \\frac{0.25+0.25}{2}(0.25) + \\frac{0.25+0.0}{2}(0.25) + \\frac{0.0+0.0}{2}(0.25) = 0.03125 + 0.0625 + 0.03125 + 0 = 0.125$。\n- $\\mathrm{CSDM}^{(6)} = \\frac{1}{1.0} \\times 0.125 = 0.125$。\n\n最终结果，四舍五入到 $6$ 位小数：\n- $\\mathrm{CSDM}^{(1)} = 0.437500$\n- $\\mathrm{CSDM}^{(2)} = 0.450000$\n- $\\mathrm{CSDM}^{(3)} = 0.000000$\n- $\\mathrm{CSDM}^{(4)} = 1.000000$\n- $\\mathrm{CSDM}^{(5)} = 0.125000$\n- $\\mathrm{CSDM}^{(6)} = 0.125000$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Cumulative Strain Damage Measure (CSDM) for a series of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"t\": np.array([0, 1, 2]),\n            \"strains\": np.array([\n                [0.10, 0.20, 0.00, 0.15],\n                [0.20, 0.20, 0.16, 0.14],\n                [0.10, 0.10, 0.10, 0.14]\n            ]),\n            \"threshold\": 0.15\n        },\n        {\n            \"t\": np.array([0.0, 0.5, 1.5, 2.0]),\n            \"strains\": np.array([\n                [0.00, 0.16, 0.14, 0.20, 0.20],\n                [0.00, 0.10, 0.14, 0.20, 0.20],\n                [0.16, 0.16, 0.14, 0.14, 0.20],\n                [0.00, 0.00, 0.00, 0.00, 0.14]\n            ]),\n            \"threshold\": 0.15\n        },\n        {\n            \"t\": np.array([0, 1]),\n            \"strains\": np.array([\n                [0.10, 0.20, 0.30],\n                [0.05, 0.10, 0.15]\n            ]),\n            \"threshold\": 0.50\n        },\n        {\n            \"t\": np.array([0, 2]),\n            \"strains\": np.array([\n                [0.10, 0.20],\n                [0.10, 0.20]\n            ]),\n            \"threshold\": 0.05\n        },\n        {\n            \"t\": np.array([0, 1, 2]),\n            \"strains\": np.array([\n                [0.15, 0.15, 0.15, 0.15],\n                [0.15, 0.16, 0.15, 0.14],\n                [0.15, 0.15, 0.15, 0.15]\n            ]),\n            \"threshold\": 0.15\n        },\n        {\n            \"t\": np.array([0, 0.25, 0.5, 0.75, 1.0]),\n            \"strains\": np.array([\n                [0.00, 0.00, 0.00, 0.00],\n                [0.00, 0.21, 0.00, 0.00],\n                [0.00, 0.22, 0.00, 0.00],\n                [0.00, 0.19, 0.00, 0.00],\n                [0.00, 0.00, 0.00, 0.00]\n            ]),\n            \"threshold\": 0.20\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        time_samples = case[\"t\"]\n        strain_matrix = case[\"strains\"]\n        strain_threshold = case[\"threshold\"]\n\n        # Number of voxels (columns in the strain matrix)\n        num_voxels = strain_matrix.shape[1]\n\n        # Step 1: Compute the number of voxels exceeding the threshold at each time step.\n        # The comparison must be strict ('>').\n        exceedance_matrix = strain_matrix > strain_threshold\n        \n        # Sum along axis 1 (voxels) to get the count of exceeding voxels per time step.\n        exceedance_counts = np.sum(exceedance_matrix, axis=1)\n\n        # Step 2: Compute the instantaneous fraction of voxels f(t_k).\n        f_t = exceedance_counts / num_voxels\n\n        # Step 3: Compute the total duration T.\n        total_duration = time_samples[-1] - time_samples[0]\n        \n        if total_duration == 0:\n            # If total duration is zero, the integral is zero, so CSDM is 0.\n            csdm = 0.0\n        else:\n            # Step 4: Approximate the integral of f(t) using the trapezoidal rule.\n            # np.trapz(y, x) computes the integral of y(x) dx.\n            integral_f_t = np.trapz(f_t, x=time_samples)\n            \n            # Step 5: Compute CSDM by dividing the integral by the total duration.\n            csdm = integral_f_t / total_duration\n\n        # Round the result to 6 decimal places.\n        results.append(round(csdm, 6))\n\n    # Format the results into the required string format \"x.xxxxxx\"\n    formatted_results = [\"{:.6f}\".format(res) for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}