{
    "hands_on_practices": [
        {
            "introduction": "在头部撞击的实验研究中，传感器（如加速度计）通常无法精确地放置在头部的质心（CG）位置。本练习将引导您运用刚体运动学原理，将从传感器位置测得的运动学数据转换到质心处，这是几乎所有撞击生物力学分析中的一个基本步骤。通过这个实践，您将掌握从离体测量点推导质心加速度的核心计算技能，这对准确评估头部伤害风险至关重要。",
            "id": "4165895",
            "problem": "将人头建模为一个刚体，其上附有一个头固定坐标系，该坐标系的原点与头的重心 (CG) 重合。一个三轴加速度计安装在距离重心 (CG) 一个已知杠杆臂矢量 $\\boldsymbol{r}$ 的点上，该矢量在头固定坐标系中表示。在脑震荡事件中的特定时刻 $t^{\\ast}$，加速度计经处理后输出其感应点的惯性线性加速度（已去除重力加速度），在头固定坐标系中表示为 $\\boldsymbol{a}_{P}(t^{\\ast})$。同一时刻，头部的全局角速度和角加速度也同样在头固定坐标系中表示，分别为 $\\boldsymbol{\\omega}(t^{\\ast})$ 和 $\\boldsymbol{\\alpha}(t^{\\ast})$。假设刚体运动学有效，并且杠杆臂 $\\boldsymbol{r}$ 在头固定坐标系中是固定的。\n\n仅从牛顿定律和刚体运动学出发（不使用快捷公式），推导根据给定测量值计算头部重心 (CG) 惯性线性加速度矢量 $\\boldsymbol{a}_{\\mathrm{CG}}(t^{\\ast})$所需的关系式。然后，使用下面的数值，计算 $\\boldsymbol{a}_{\\mathrm{CG}}(t^{\\ast})$ 的大小，该值常用于脑震荡耐受标准。\n\n给定时刻 $t^{\\ast}$ 的值：\n- 从重心到传感器的杠杆臂：$\\boldsymbol{r} = \\begin{pmatrix} 0.06 \\\\ 0.05 \\\\ -0.08 \\end{pmatrix}\\ \\text{m}$。\n- 传感器惯性加速度（已去除重力）：$\\boldsymbol{a}_{P}(t^{\\ast}) = \\begin{pmatrix} 20 \\\\ -15 \\\\ 12 \\end{pmatrix}\\ \\text{m}\\,\\text{s}^{-2}$。\n- 头部角速度：$\\boldsymbol{\\omega}(t^{\\ast}) = \\begin{pmatrix} 18 \\\\ -22 \\\\ 15 \\end{pmatrix}\\ \\text{rad}\\,\\text{s}^{-1}$。\n- 头部角加速度：$\\boldsymbol{\\alpha}(t^{\\ast}) = \\begin{pmatrix} 250 \\\\ -180 \\\\ 210 \\end{pmatrix}\\ \\text{rad}\\,\\text{s}^{-2}$。\n\n计算大小 $\\left\\|\\boldsymbol{a}_{\\mathrm{CG}}(t^{\\ast})\\right\\|$，并以 $\\text{m}\\,\\text{s}^{-2}$ 为单位表示最终答案。将您的答案四舍五入到四位有效数字。",
            "solution": "在进行求解之前，先对问题陈述的有效性进行评估。\n\n### 步骤1：提取已知条件\n- 人头被建模为一个刚体。\n- 一个头固定坐标系的原点位于头的重心 (CG)。\n- 一个加速度计位于点 $P$，与重心 (CG) 相隔一个杠杆臂矢量 $\\boldsymbol{r}$。\n- 杠杆臂矢量在头固定坐标系中表示为：$\\boldsymbol{r} = \\begin{pmatrix} 0.06 \\\\ 0.05 \\\\ -0.08 \\end{pmatrix}\\ \\text{m}$。\n- 传感器在时刻 $t^{\\ast}$ 的惯性线性加速度（已去除重力），在头固定坐标系中表示为 $\\boldsymbol{a}_{P}(t^{\\ast}) = \\begin{pmatrix} 20 \\\\ -15 \\\\ 12 \\end{pmatrix}\\ \\text{m}\\,\\text{s}^{-2}$。\n- 头部在时刻 $t^{\\ast}$ 的全局角速度，在头固定坐标系中表示为 $\\boldsymbol{\\omega}(t^{\\ast}) = \\begin{pmatrix} 18 \\\\ -22 \\\\ 15 \\end{pmatrix}\\ \\text{rad}\\,\\text{s}^{-1}$。\n- 头部在时刻 $t^{\\ast}$ 的全局角加速度，在头固定坐标系中表示为 $\\boldsymbol{\\alpha}(t^{\\ast}) = \\begin{pmatrix} 250 \\\\ -180 \\\\ 210 \\end{pmatrix}\\ \\text{rad}\\,\\text{s}^{-2}$。\n- 假设刚体运动学有效。\n- 杠杆臂 $\\boldsymbol{r}$ 在头固定坐标系中是固定的。\n- 任务是推导头部重心 (CG) 惯性线性加速度 $\\boldsymbol{a}_{\\mathrm{CG}}(t^{\\ast})$ 的表达式，然后计算其大小 $\\left\\|\\boldsymbol{a}_{\\mathrm{CG}}(t^{\\ast})\\right\\|$，并四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题坚实地基于经典力学原理，特别是刚体运动学。所描述的场景——将加速度从传感器位置转换到物体重心——是实验生物力学、车辆动力学和机器人学中的一个标准和基本程序。所提供的数值在脑震荡头部撞击的合理范围内。\n- **适定性：** 这是一个适定问题。它提供了确定未知量 $\\boldsymbol{a}_{\\mathrm{CG}}$ 唯一解所需的完整初始数据集（$\\boldsymbol{r}$、$\\boldsymbol{a}_{P}$、$\\boldsymbol{\\omega}$、$\\boldsymbol{\\alpha}$）。所有矢量都在同一个头固定坐标系中表示这一关键信息确保了一致性和可解性。\n- **客观性：** 问题以精确、客观和定量的术语陈述。它没有歧义、主观看法或意见。\n\n### 步骤3：结论与行动\n该问题是有效的。这是一个刚体动力学中的标准问题，具有科学性、适定性和客观性。我现在将进行推导和求解。\n\n推导从运动参考系中位置、速度和加速度的基本定义开始。设 $N$ 为一个固定的惯性参考系，$B$ 为随头部旋转的头固定（物体）参考系。参考系 $B$ 的原点是头部的重心 (CG)。\n\n传感器点 $P$ 在惯性系中的位置 $\\boldsymbol{R}_{P}$，可以表示为重心 (CG) 在惯性系中的位置 $\\boldsymbol{R}_{\\mathrm{CG}}$ 与点 $P$ 相对于重心的位置（即杠杆臂矢量 $\\boldsymbol{r}$）之和。\n$$ \\boldsymbol{R}_{P} = \\boldsymbol{R}_{\\mathrm{CG}} + \\boldsymbol{r} $$\n为了找到加速度之间的关系，我们必须从惯性系 $N$ 的角度对该方程关于时间求导。点 $P$ 的惯性速度为 $\\boldsymbol{v}_{P} = \\frac{d}{dt}\\big|_{N} \\boldsymbol{R}_{P}$。\n$$ \\boldsymbol{v}_{P} = \\frac{d}{dt}\\bigg|_{N} \\boldsymbol{R}_{P} = \\frac{d}{dt}\\bigg|_{N} \\boldsymbol{R}_{\\mathrm{CG}} + \\frac{d}{dt}\\bigg|_{N} \\boldsymbol{r} $$\n右边的第一项是重心的惯性速度 $\\boldsymbol{v}_{\\mathrm{CG}}$。第二项 $\\frac{d}{dt}\\big|_{N} \\boldsymbol{r}$ 是一个在旋转坐标系 $B$ 中固定的矢量 $\\boldsymbol{r}$ 的时间导数。我们使用输运定理（或通用导数公式），该定理将矢量在惯性系 $N$ 中的时间导数与其在旋转坐标系 $B$ 中的导数联系起来：\n$$ \\frac{d}{dt}\\bigg|_{N} \\boldsymbol{q} = \\frac{d}{dt}\\bigg|_{B} \\boldsymbol{q} + \\boldsymbol{\\omega} \\times \\boldsymbol{q} $$\n其中 $\\boldsymbol{\\omega}$ 是坐标系 $B$ 相对于坐标系 $N$ 的角速度。\n将此应用于矢量 $\\boldsymbol{r}$：\n$$ \\frac{d}{dt}\\bigg|_{N} \\boldsymbol{r} = \\frac{d}{dt}\\bigg|_{B} \\boldsymbol{r} + \\boldsymbol{\\omega} \\times \\boldsymbol{r} $$\n由于 $\\boldsymbol{r}$ 是头固定坐标系 $B$ 中的一个固定矢量，其相对于坐标系 $B$ 中观察者的时间导数为零：$\\frac{d}{dt}\\big|_{B} \\boldsymbol{r} = \\boldsymbol{0}$。因此，方程简化为：\n$$ \\frac{d}{dt}\\bigg|_{N} \\boldsymbol{r} = \\boldsymbol{\\omega} \\times \\boldsymbol{r} $$\n将此代回速度方程，得到刚体上速度的著名关系式：\n$$ \\boldsymbol{v}_{P} = \\boldsymbol{v}_{\\mathrm{CG}} + \\boldsymbol{\\omega} \\times \\boldsymbol{r} $$\n为了求得加速度，我们在惯性系 $N$ 中再次对该速度方程关于时间求导：\n$$ \\boldsymbol{a}_{P} = \\frac{d}{dt}\\bigg|_{N} \\boldsymbol{v}_{P} = \\frac{d}{dt}\\bigg|_{N} \\boldsymbol{v}_{\\mathrm{CG}} + \\frac{d}{dt}\\bigg|_{N} (\\boldsymbol{\\omega} \\times \\boldsymbol{r}) $$\n项 $\\frac{d}{dt}\\big|_{N} \\boldsymbol{v}_{\\mathrm{CG}}$ 是重心的惯性加速度 $\\boldsymbol{a}_{\\mathrm{CG}}$。对于叉乘项，我们使用乘法法则求导：\n$$ \\frac{d}{dt}\\bigg|_{N} (\\boldsymbol{\\omega} \\times \\boldsymbol{r}) = \\left(\\frac{d}{dt}\\bigg|_{N} \\boldsymbol{\\omega}\\right) \\times \\boldsymbol{r} + \\boldsymbol{\\omega} \\times \\left(\\frac{d}{dt}\\bigg|_{N} \\boldsymbol{r}\\right) $$\n第一项 $\\frac{d}{dt}\\big|_{N} \\boldsymbol{\\omega}$ 是惯性角加速度 $\\boldsymbol{\\alpha}$ 的定义。在第二项中，我们代入先前推导出的结果 $\\frac{d}{dt}\\big|_{N} \\boldsymbol{r} = \\boldsymbol{\\omega} \\times \\boldsymbol{r}$。\n$$ \\frac{d}{dt}\\bigg|_{N} (\\boldsymbol{\\omega} \\times \\boldsymbol{r}) = \\boldsymbol{\\alpha} \\times \\boldsymbol{r} + \\boldsymbol{\\omega} \\times (\\boldsymbol{\\omega} \\times \\boldsymbol{r}) $$\n合并所有项，我们得到完整的加速度运动学关系式，通常称为三项加速度方程：\n$$ \\boldsymbol{a}_{P} = \\boldsymbol{a}_{\\mathrm{CG}} + \\boldsymbol{\\alpha} \\times \\boldsymbol{r} + \\boldsymbol{\\omega} \\times (\\boldsymbol{\\omega} \\times \\boldsymbol{r}) $$\n这就是问题所要求推导的关系式。项 $\\boldsymbol{\\alpha} \\times \\boldsymbol{r}$ 是切向加速度分量，而 $\\boldsymbol{\\omega} \\times (\\boldsymbol{\\omega} \\times \\boldsymbol{r})$ 是向心加速度分量。\n\n问题要求我们计算 $\\boldsymbol{a}_{\\mathrm{CG}}$。我们重新整理方程：\n$$ \\boldsymbol{a}_{\\mathrm{CG}} = \\boldsymbol{a}_{P} - (\\boldsymbol{\\alpha} \\times \\boldsymbol{r}) - \\boldsymbol{\\omega} \\times (\\boldsymbol{\\omega} \\times \\boldsymbol{r}) $$\n所有矢量都在头固定坐标系中给出，因此我们可以使用它们给定的分量进行矢量运算。让我们计算时刻 $t^{\\ast}$ 的各项。\n\n首先，我们计算切向加速度分量 $\\boldsymbol{\\alpha} \\times \\boldsymbol{r}$：\n$$ \\boldsymbol{\\alpha} \\times \\boldsymbol{r} = \\begin{pmatrix} 250 \\\\ -180 \\\\ 210 \\end{pmatrix} \\times \\begin{pmatrix} 0.06 \\\\ 0.05 \\\\ -0.08 \\end{pmatrix} = \\begin{pmatrix} (-180)(-0.08) - (210)(0.05) \\\\ (210)(0.06) - (250)(-0.08) \\\\ (250)(0.05) - (-180)(0.06) \\end{pmatrix} = \\begin{pmatrix} 14.4 - 10.5 \\\\ 12.6 + 20 \\\\ 12.5 + 10.8 \\end{pmatrix} = \\begin{pmatrix} 3.9 \\\\ 32.6 \\\\ 23.3 \\end{pmatrix} $$\n接下来，我们计算向心加速度分量 $\\boldsymbol{\\omega} \\times (\\boldsymbol{\\omega} \\times \\boldsymbol{r})$。我们首先求中间项 $\\boldsymbol{\\omega} \\times \\boldsymbol{r}$：\n$$ \\boldsymbol{\\omega} \\times \\boldsymbol{r} = \\begin{pmatrix} 18 \\\\ -22 \\\\ 15 \\end{pmatrix} \\times \\begin{pmatrix} 0.06 \\\\ 0.05 \\\\ -0.08 \\end{pmatrix} = \\begin{pmatrix} (-22)(-0.08) - (15)(0.05) \\\\ (15)(0.06) - (18)(-0.08) \\\\ (18)(0.05) - (-22)(0.06) \\end{pmatrix} = \\begin{pmatrix} 1.76 - 0.75 \\\\ 0.9 + 1.44 \\\\ 0.9 + 1.32 \\end{pmatrix} = \\begin{pmatrix} 1.01 \\\\ 2.34 \\\\ 2.22 \\end{pmatrix} $$\n现在我们为向心项计算最终的叉积：\n$$ \\boldsymbol{\\omega} \\times (\\boldsymbol{\\omega} \\times \\boldsymbol{r}) = \\begin{pmatrix} 18 \\\\ -22 \\\\ 15 \\end{pmatrix} \\times \\begin{pmatrix} 1.01 \\\\ 2.34 \\\\ 2.22 \\end{pmatrix} = \\begin{pmatrix} (-22)(2.22) - (15)(2.34) \\\\ (15)(1.01) - (18)(2.22) \\\\ (18)(2.34) - (-22)(1.01) \\end{pmatrix} = \\begin{pmatrix} -48.84 - 35.1 \\\\ 15.15 - 39.96 \\\\ 42.12 + 22.22 \\end{pmatrix} = \\begin{pmatrix} -83.94 \\\\ -24.81 \\\\ 64.34 \\end{pmatrix} $$\n现在我们将这些结果代入 $\\boldsymbol{a}_{\\mathrm{CG}}$ 的方程中：\n$$ \\boldsymbol{a}_{\\mathrm{CG}} = \\begin{pmatrix} 20 \\\\ -15 \\\\ 12 \\end{pmatrix} - \\begin{pmatrix} 3.9 \\\\ 32.6 \\\\ 23.3 \\end{pmatrix} - \\begin{pmatrix} -83.94 \\\\ -24.81 \\\\ 64.34 \\end{pmatrix} $$\n$$ \\boldsymbol{a}_{\\mathrm{CG}} = \\begin{pmatrix} 20 - 3.9 - (-83.94) \\\\ -15 - 32.6 - (-24.81) \\\\ 12 - 23.3 - 64.34 \\end{pmatrix} = \\begin{pmatrix} 20 - 3.9 + 83.94 \\\\ -15 - 32.6 + 24.81 \\\\ 12 - 23.3 - 64.34 \\end{pmatrix} = \\begin{pmatrix} 100.04 \\\\ -22.79 \\\\ -75.64 \\end{pmatrix}\\ \\text{m}\\,\\text{s}^{-2} $$\n最后，我们计算重心惯性加速度矢量的大小 $\\left\\|\\boldsymbol{a}_{\\mathrm{CG}}\\right\\|$：\n$$ \\left\\|\\boldsymbol{a}_{\\mathrm{CG}}\\right\\| = \\sqrt{(100.04)^{2} + (-22.79)^{2} + (-75.64)^{2}} $$\n$$ \\left\\|\\boldsymbol{a}_{\\mathrm{CG}}\\right\\| = \\sqrt{10008.0016 + 519.3841 + 5721.4096} $$\n$$ \\left\\|\\boldsymbol{a}_{\\mathrm{CG}}\\right\\| = \\sqrt{16248.7953} \\approx 127.47076\\ \\text{m}\\,\\text{s}^{-2} $$\n将结果四舍五入到四位有效数字，得到 $127.5\\ \\text{m}\\,\\text{s}^{-2}$。",
            "answer": "$$\\boxed{127.5}$$"
        },
        {
            "introduction": "现代脑损伤生物力学严重依赖有限元（FEM）等计算模型来预测组织层面的响应，例如应变。然而，这些模型的准确性取决于其数值的可靠性，其中网格收敛性分析是关键的验证环节。本练习将指导您完成一个实际的网格收敛性研究，通过评估峰值应变如何随网格细化而变化，来确保模拟结果的准确性和可靠性，这是将计算结果用于损伤容忍度标准评估的必要前提。",
            "id": "4165867",
            "problem": "考虑一个使用有限元方法（FEM）模拟的旋转性头部撞击，其中组织层面的响应指标是最大主应变（MPS）。目标是评估峰值MPS的网格收敛性，以便为与脑震荡生物力学相关的容差比较建立置信度。峰值MPS是在整个大脑体积和事件持续时间内主应变的最大值；应变是无量纲的，必须以小数形式给出。网格细化由单元尺寸 $h$（单位为 $\\mathrm{mm}$）来表征。假设渐近离散化误差表现为特征网格尺寸的幂函数。您必须根据最后三次细化来估算观测到的收敛阶，用它来对峰值MPS进行连续介质极限外推，量化最细网格相对于此外推值的相对误差，并决定网格是否可接受。接受准则由相对误差的阈值定义。\n\n使用的基本原理和定义：\n- Newton第二定律关联了头部加速过程中脑组织的运动学和动力学，为形变的连续介质力学描述提供了依据。\n- 在小应变极限下，应变张量是位移的对称梯度，主应变是该张量的特征值。\n- 最大主应变（MPS）是某一点上最大的主应变；峰值MPS是MPS在空间和时间上的最大值。\n- 在FEM中，在充分细化的区域，离散化误差通常随着网格尺寸 $h$ 呈幂律下降。\n- 网格细化序列在连续级别之间具有恒定的细化因子 $r$，定义为 $r = h_{i}/h_{i+1}$。\n\n任务规范：\n1. 对于每个测试用例，使用具有恒定 $r$ 的细化序列中的最后三个网格级别，通过峰值MPS在各次细化中的变化来估算观测到的收敛阶。然后将峰值MPS外推至连续介质极限。接下来，计算最细网格结果相对于外推极限的相对误差，定义为绝对差值除以外推极限的绝对值。最后，通过将此相对误差与给定阈值进行比较来确定是否接受。\n2. 如果最后两个峰值MPS值相同，则将相对误差定义为零。如果观测到的行为意味着没有渐近收敛（例如，由于观测阶为非正数或细化因子效应导致外推分母崩溃），则将相对误差视为 $1.0$ 并报告拒绝。\n3. 将所有应变量表示为小数（无量纲）。网格尺寸必须以 $\\mathrm{mm}$ 为单位处理。不涉及角度，因此不需要角度单位。\n4. 您的程序应生成单行输出，其中包含所有给定测试用例的接受结果，形式为一个由方括号括起来的逗号分隔列表（例如，$\\left[\\text{True},\\text{False}\\right]$）。\n\n测试套件：\n- 案例A（理想路径）：$h = [4.0, 2.0, 1.0, 0.5]$ $\\mathrm{mm}$，峰值 MPS $= [0.26, 0.23, 0.213, 0.205]$（小数），接受阈值 $\\epsilon = 0.04$（小数）。此案例代表了一致的细化，具有预期的递减峰值MPS和中等大小的观测阶。\n- 案例B（边界情况）：$h = [3.0, 1.5, 0.75]$ $\\mathrm{mm}$，峰值 MPS $= [0.21, 0.195, 0.188]$（小数），接受阈值 $\\epsilon = 0.033685$（小数）。此案例设计为位于接受边界附近。\n- 案例C（观测阶较低的边缘情况）：$h = [4.0, 2.0, 1.0, 0.5]$ $\\mathrm{mm}$，峰值 MPS $= [0.272, 0.261, 0.25, 0.24]$（小数），接受阈值 $\\epsilon = 0.05$（小数）。此案例在各次细化中变化缓慢，导致观测阶较小，外推校正较大。\n- 案例D（平台期边缘情况）：$h = [8.0, 4.0, 2.0, 1.0]$ $\\mathrm{mm}$，峰值 MPS $= [0.22, 0.205, 0.198, 0.198]$（小数），接受阈值 $\\epsilon = 0.02$（小数）。此案例最后两个峰值MPS值相同，意味着相对误差为零。\n\n输出格式：\n- 您的程序必须输出一行，将案例 $\\text{A}$、$\\text{B}$、$\\text{C}$ 和 $\\text{D}$ 的接受结果汇总为一个由方括号括起来的逗号分隔列表，且仅包含布尔值（例如，$\\left[\\text{True},\\text{False},\\text{True},\\text{True}\\right]$）。不得打印任何额外文本。",
            "solution": "我们从支撑生物力学中网格收敛性的连续介质力学和数值分析原理出发。在旋转载荷下，脑组织变形遵循Newton第二定律，运动学在连续介质中由位移场表示。在小应变极限下，应变张量是位移的对称梯度，其主值量化了沿主方向的法向应变。某一点的最大主应变（MPS）是最大的主应变，而峰值MPS是其在整个大脑区域和时间持续期间的最大值，作为脑震荡生物力学中常用的组织层面度量。\n\n有限元方法（FEM）离散化引入了一个以 $\\mathrm{mm}$ 为单位的特征网格尺寸 $h$，在渐近细化区域，目标量的离散化误差通常遵循 $h$ 的幂律。设在网格尺寸 $h_i$ 上计算的峰值MPS为 $S(h_i)$，并假设\n$$\nS(h) = S^\\ast + C h^p,\n$$\n其中 $S^\\ast$ 是连续介质极限下的峰值MPS，$C$ 是一个常数，$p$ 是观测到的收敛阶。对于具有恒定细化因子 $r = h_i/h_{i+1}$ 的均匀细化序列，峰值MPS值之间的连续差异携带着关于 $p$ 的信息。使用最后三个级别，记 $S_{k-2} = S(h_{k-2})$，$S_{k-1} = S(h_{k-1})$，$S_k = S(h_k)$，并定义连续差异\n$$\n\\Delta_{\\text{prev}} = S_{k-2} - S_{k-1}, \\quad \\Delta_{\\text{last}} = S_{k-1} - S_k.\n$$\n假设渐近行为，这些差异的比值与细化因子和观测阶相关：\n$$\n\\frac{\\Delta_{\\text{prev}}}{\\Delta_{\\text{last}}} \\approx r^p,\n$$\n由此得出的估计值为\n$$\np \\approx \\frac{\\ln\\left|\\Delta_{\\text{prev}} / \\Delta_{\\text{last}}\\right|}{\\ln r}.\n$$\n当 $r > 1$ 且 $\\Delta_{\\text{last}} \\neq 0$ 时，此表达式有明确定义。如果 $\\Delta_{\\text{last}} = 0$，则最细的两个网格产生相同的峰值MPS，意味着在最细尺度上没有可观察到的离散化误差，我们将相对误差设为零。\n\n有了估计的 $p$，基于最后两个级别对连续介质极限峰值MPS进行Richardson外推，得到\n$$\nS^\\ast \\approx S_k + \\frac{S_k - S_{k-1}}{r^p - 1}.\n$$\n此公式要求 $r^p \\neq 1$ 且观测阶 $p > 0$ 为正。如果 $p \\leq 0$ 或者 $r^p$ 与 $1$ 的差值在数值上导致分母崩溃，则数据不反映渐近收敛；在这种情况下，我们保守地将相对误差设为 $1.0$ 并拒绝该网格。否则，最细网格峰值MPS相对于外推极限的相对误差为\n$$\n\\text{rel\\_err} = \\frac{\\left|S^\\ast - S_k\\right|}{\\left|S^\\ast\\right|}.\n$$\n如果 $\\text{rel\\_err} \\le \\epsilon$，我们宣布接受，其中 $\\epsilon$ 是指定的阈值（小数）。该准则将容差操作化：要使用峰值MPS进行损伤风险比较，由离散化产生的数值误差必须相对于外推值足够小。\n\n现在我们将上述方法应用于测试案例，使用每个序列的最后三个级别：\n\n案例 A：$h = [4.0, 2.0, 1.0, 0.5]$ $\\mathrm{mm}$，$S = [0.26, 0.23, 0.213, 0.205]$，$\\epsilon = 0.04$。最后三个 $S$ 值为 $S_{k-2} = 0.23$，$S_{k-1} = 0.213$，$S_k = 0.205$。当 $r = 2$ 时，我们计算 $\\Delta_{\\text{prev}} = 0.23 - 0.213 = 0.017$，$\\Delta_{\\text{last}} = 0.213 - 0.205 = 0.008$。观测阶为\n$$\np \\approx \\frac{\\ln(0.017/0.008)}{\\ln 2} = \\frac{\\ln(2.125)}{\\ln 2} \\approx 1.087.\n$$\n外推极限为\n$$\nS^\\ast \\approx 0.205 + \\frac{0.205 - 0.213}{2^{1.087} - 1} = 0.205 + \\frac{-0.008}{2.125 - 1} = 0.205 - \\frac{0.008}{1.125} \\approx 0.1978889.\n$$\n相对误差为\n$$\n\\text{rel\\_err} \\approx \\frac{0.205 - 0.1978889}{0.1978889} \\approx \\frac{0.0071111}{0.1978889} \\approx 0.035939 \\le 0.04,\n$$\n因此接受结果为 $\\text{True}$。\n\n案例 B：$h = [3.0, 1.5, 0.75]$ $\\mathrm{mm}$，$S = [0.21, 0.195, 0.188]$，$\\epsilon = 0.033685$。最后三个值为 $S_{k-2} = 0.21$，$S_{k-1} = 0.195$，$S_k = 0.188$，且 $r = 2$。差异为 $\\Delta_{\\text{prev}} = 0.015$，$\\Delta_{\\text{last}} = 0.007$。观测阶为\n$$\np \\approx \\frac{\\ln(0.015/0.007)}{\\ln 2} = \\frac{\\ln(2.142857)}{\\ln 2} \\approx 1.098,\n$$\n且 $r^p \\approx 2.142857$。则\n$$\nS^\\ast \\approx 0.188 + \\frac{-0.007}{2.142857 - 1} = 0.188 - \\frac{0.007}{1.142857} \\approx 0.181875,\n$$\n所以\n$$\n\\text{rel\\_err} \\approx \\frac{0.006125}{0.181875} \\approx 0.033685 \\le 0.033685,\n$$\n得出接受结果为 $\\text{True}$。\n\n案例 C：$h = [4.0, 2.0, 1.0, 0.5]$ $\\mathrm{mm}$，$S = [0.272, 0.261, 0.25, 0.24]$，$\\epsilon = 0.05$。最后三个值为 $S_{k-2} = 0.261$，$S_{k-1} = 0.25$，$S_k = 0.24$，且 $r = 2$。差异为 $\\Delta_{\\text{prev}} = 0.011$，$\\Delta_{\\text{last}} = 0.01$，得到\n$$\np \\approx \\frac{\\ln(0.011/0.01)}{\\ln 2} = \\frac{\\ln(1.1)}{\\ln 2} \\approx 0.137,\n$$\n且 $r^p \\approx 1.1$。则\n$$\nS^\\ast \\approx 0.24 + \\frac{-0.01}{1.1 - 1} = 0.24 - \\frac{0.01}{0.1} = 0.24 - 0.1 = 0.14,\n$$\n相对误差为\n$$\n\\text{rel\\_err} = \\frac{0.1}{0.14} \\approx 0.7142857 > 0.05,\n$$\n因此接受结果为 $\\text{False}$。\n\n案例 D：$h = [8.0, 4.0, 2.0, 1.0]$ $\\mathrm{mm}$，$S = [0.22, 0.205, 0.198, 0.198]$，$\\epsilon = 0.02$。最后两个值相等，$S_{k-1} = S_k = 0.198$，所以我们设 $\\text{rel\\_err} = 0$，得出接受结果为 $\\text{True}$。\n\n因此，接受结果为 $[\\text{True}, \\text{True}, \\text{False}, \\text{True}]$。所要求的程序通过实现上述收敛性估计和外推逻辑来计算这些结果，并将其作为单行列表打印出来。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef relative_error_acceptance(h_list, s_list, epsilon, tol=1e-12):\n    \"\"\"\n    Compute convergence-based relative error for peak MPS and decide acceptance.\n    - h_list: list of mesh sizes (mm), refined with constant factor r between successive levels.\n    - s_list: list of peak MPS values (dimensionless decimal).\n    - epsilon: acceptance threshold for relative error (decimal).\n    - tol: numerical tolerance for degeneracy checks.\n    Returns: boolean acceptance (True if rel_err = epsilon).\n    \"\"\"\n    # Use the last three mesh levels\n    if len(h_list)  3 or len(s_list)  3:\n        # Not enough data to assess convergence; reject conservatively\n        return False\n\n    # Refinement factor from the last two levels\n    r_last = h_list[-2] / h_list[-1]\n    if r_last = 1.0 + tol:\n        # Non-refining or invalid refinement factor; reject\n        return False\n\n    # Successive differences in peak MPS\n    delta_prev = s_list[-3] - s_list[-2]\n    delta_last = s_list[-2] - s_list[-1]\n\n    # If the last two are identical, relative error is zero\n    if abs(delta_last) = tol:\n        rel_err = 0.0\n        return rel_err = epsilon\n\n    # Estimate observed order p\n    try:\n        p = np.log(abs(delta_prev / delta_last)) / np.log(r_last)\n    except FloatingPointError:\n        # Any numerical failure yields conservative rejection\n        return False\n\n    # Compute r**p\n    r_to_p = r_last ** p\n\n    # Guard against non-asymptotic behavior: p = 0 or r_to_p ~ 1\n    if (p = 0.0) or (abs(r_to_p - 1.0) = 1e-12):\n        rel_err = 1.0\n        return rel_err = epsilon\n\n    # Richardson extrapolation for continuum-limit peak MPS\n    s_fine = s_list[-1]\n    s_prev = s_list[-2]\n    s_star = s_fine + (s_fine - s_prev) / (r_to_p - 1.0)\n\n    # Relative error of finest mesh vs extrapolated limit\n    rel_err = abs(s_star - s_fine) / abs(s_star)\n\n    return rel_err = epsilon\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        ([4.0, 2.0, 1.0, 0.5], [0.26, 0.23, 0.213, 0.205], 0.04),\n        # Case B (boundary case)\n        ([3.0, 1.5, 0.75], [0.21, 0.195, 0.188], 0.033685),\n        # Case C (edge case with low observed order)\n        ([4.0, 2.0, 1.0, 0.5], [0.272, 0.261, 0.25, 0.24], 0.05),\n        # Case D (edge case with plateau)\n        ([8.0, 4.0, 2.0, 1.0], [0.22, 0.205, 0.198, 0.198], 0.02),\n    ]\n\n    results = []\n    for h_list, s_list, epsilon in test_cases:\n        result = relative_error_acceptance(h_list, s_list, epsilon)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}