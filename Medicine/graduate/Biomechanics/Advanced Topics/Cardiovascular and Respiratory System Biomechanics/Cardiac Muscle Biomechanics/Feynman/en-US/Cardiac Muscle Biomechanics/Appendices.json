{
    "hands_on_practices": [
        {
            "introduction": "The ability of muscle to generate force is fundamentally rooted in its microscopic architecture. This exercise invites you to explore the geometric heart of the sliding filament theory by deriving the relationship between sarcomere length and the potential for cross-bridge formation . By modeling the overlap between actin and myosin filaments, you will build from first principles one of the most foundational concepts in muscle mechanics: the length-tension relationship.",
            "id": "4162667",
            "problem": "A fundamental quantitative feature of the sliding filament model of striated muscle is that active force is generated by cross-bridges only where thin filaments (actin) overlap the head-bearing portions of thick filaments (myosin). In the sarcomere, the thick filament has a central bare zone with no myosin heads. Consider a symmetric half-sarcomere description along a one-dimensional coordinate from the sarcomere center (the M-line) to the Z-line. The thin filament of length $L_a$ extends inward from the Z-line, and the thick filament of total length $L_m$ extends outward from the M-line; within the thick filament, a central bare zone of length $z_b$ contains no heads. Assume a uniform density of myosin heads along the head-bearing regions and a uniform actin binding site distribution along the thin filament. Under these assumptions, the number of potential cross-bridges scales linearly with the length of geometric overlap between actin and the myosin head region.\n\nStarting from this geometric picture and the definitions above, derive from first principles an analytic expression for the fraction $f(\\ell_s)$ of overlap between actin and the myosin head-bearing region as a function of the sarcomere length $\\ell_s$. Define the fraction $f(\\ell_s)$ as the total overlapped head-region length in the entire sarcomere divided by the total available head-region length in the entire sarcomere. Then, using your derived expression, compute the numerical value of $f(\\ell_s)$ and the corresponding active tension $\\sigma_{\\mathrm{act}}$ under the following physiologically plausible parameters:\n- Actin length $L_a = 1.05\\,\\mu\\mathrm{m}$,\n- Myosin length $L_m = 1.60\\,\\mu\\mathrm{m}$,\n- Bare zone length $z_b = 0.20\\,\\mu\\mathrm{m}$,\n- Sarcomere length $\\ell_s = 2.50\\,\\mu\\mathrm{m}$,\n- Maximum active stress (the stress at full overlap) $\\sigma_{\\max} = 120\\,\\mathrm{kPa}$.\n\nAssume linear proportionality of active tension to overlap fraction, that is $\\sigma_{\\mathrm{act}} = \\sigma_{\\max}\\, f(\\ell_s)$. Round both $f(\\ell_s)$ and $\\sigma_{\\mathrm{act}}$ to four significant figures. Express the active tension in kilopascals (kPa). Your final answer must report two quantities in the following order: first $f(\\ell_s)$ (dimensionless), then $\\sigma_{\\mathrm{act}}$ (in $\\mathrm{kPa}$).",
            "solution": "The problem requires the derivation of an analytical expression for the fractional overlap, $f(\\ell_s)$, in a sarcomere and its subsequent numerical calculation, along with the corresponding active tension, $\\sigma_{\\mathrm{act}}$. The derivation must be based on the geometric principles of the sliding filament model.\n\nFirst, we establish a coordinate system to formalize the geometry. We consider a symmetric half-sarcomere, with the M-line at the origin, $x=0$. The Z-line is then located at $x = \\frac{\\ell_s}{2}$, where $\\ell_s$ is the total sarcomere length.\n\nThe thick (myosin) filament has a total length of $L_m$ and is centered at the M-line. In our half-sarcomere model, it extends from $x=0$ to $x=\\frac{L_m}{2}$. The thick filament has a central bare zone of total length $z_b$, which is devoid of myosin heads. In the half-sarcomere, this bare zone occupies the interval $[0, \\frac{z_b}{2}]$. Consequently, the head-bearing region of the myosin filament in this half-sarcomere spans the interval $[\\frac{z_b}{2}, \\frac{L_m}{2}]$. The length of this head-bearing region in one half-sarcomere is $L_{h, \\text{half}} = \\frac{L_m}{2} - \\frac{z_b}{2} = \\frac{L_m - z_b}{2}$.\n\nThe thin (actin) filament has a length $L_a$ and extends inward from the Z-line. Its position in the half-sarcomere is therefore the interval $[\\frac{\\ell_s}{2} - L_a, \\frac{\\ell_s}{2}]$.\n\nActive force generation is proportional to the length of the region where the actin filament overlaps with the myosin head-bearing region. Let this overlap length in the half-sarcomere be $L_{ov, \\text{half}}$. This length is the measure of the intersection of the two intervals: the myosin head-bearing region $[\\frac{z_b}{2}, \\frac{L_m}{2}]$ and the actin filament region $[\\frac{\\ell_s}{2} - L_a, \\frac{\\ell_s}{2}]$.\n\nThe length of the intersection of two closed intervals $[a, b]$ and $[c, d]$ is given by the general formula $\\max(0, \\min(b, d) - \\max(a, c))$. Applying this to our intervals:\n$L_{ov, \\text{half}} = \\max\\left(0, \\min\\left(\\frac{L_m}{2}, \\frac{\\ell_s}{2}\\right) - \\max\\left(\\frac{z_b}{2}, \\frac{\\ell_s}{2} - L_a\\right)\\right)$\n\nFor physiologically relevant sarcomere lengths, the sarcomere is longer than the thick filament, i.e., $\\ell_s > L_m$. The given parameters, $\\ell_s = 2.50\\,\\mu\\mathrm{m}$ and $L_m = 1.60\\,\\mu\\mathrm{m}$, satisfy this condition. Therefore, $\\frac{\\ell_s}{2} > \\frac{L_m}{2}$, which simplifies the $\\min$ term to $\\min(\\frac{L_m}{2}, \\frac{\\ell_s}{2}) = \\frac{L_m}{2}$. The expression for the overlap length becomes:\n$L_{ov, \\text{half}} = \\max\\left(0, \\frac{L_m}{2} - \\max\\left(\\frac{z_b}{2}, \\frac{\\ell_s}{2} - L_a\\right)\\right)$\n\nThe problem defines the fractional overlap $f(\\ell_s)$ as the total overlapped head-region length in the entire sarcomere divided by the total available head-region length in the entire sarcomere.\nThe total overlapped length is $2 \\times L_{ov, \\text{half}}$ due to symmetry.\nThe total available head-region length is the total myosin length minus the bare zone length, which is $L_m - z_b$. This is also equal to $2 \\times L_{h, \\text{half}}$.\nSo, the fraction $f(\\ell_s)$ is:\n$$f(\\ell_s) = \\frac{2 \\cdot L_{ov, \\text{half}}}{L_m - z_b} = \\frac{2 \\cdot \\max\\left(0, \\frac{L_m}{2} - \\max\\left(\\frac{z_b}{2}, \\frac{\\ell_s - 2L_a}{2}\\right)\\right)}{L_m - z_b}$$\nSimplifying this expression, we get:\n$$f(\\ell_s) = \\frac{\\max\\left(0, L_m - 2\\max\\left(\\frac{z_b}{2}, \\frac{\\ell_s - 2L_a}{2}\\right)\\right)}{L_m - z_b} = \\frac{\\max\\left(0, L_m - \\max(z_b, \\ell_s - 2L_a)\\right)}{L_m - z_b}$$\nThis is the general analytical expression for the fractional overlap, valid for $\\ell_s > L_m$.\n\nNow, we will compute the numerical value for $f(\\ell_s)$ using the provided parameters:\n$L_a = 1.05\\,\\mu\\mathrm{m}$\n$L_m = 1.60\\,\\mu\\mathrm{m}$\n$z_b = 0.20\\,\\mu\\mathrm{m}$\n$\\ell_s = 2.50\\,\\mu\\mathrm{m}$\n$\\sigma_{\\max} = 120\\,\\mathrm{kPa}$\n\nWe need to evaluate the term $\\max(z_b, \\ell_s - 2L_a)$.\n$\\ell_s - 2L_a = 2.50 - 2(1.05) = 2.50 - 2.10 = 0.40\\,\\mu\\mathrm{m}$.\nThe value of $z_b$ is $0.20\\,\\mu\\mathrm{m}$.\nSince $0.40 > 0.20$, we have $\\ell_s - 2L_a > z_b$. This physical situation corresponds to the 'descending limb' of the length-tension curve, where the thin filaments have been pulled past the bare zone, reducing the number of available cross-bridges.\nIn this case, $\\max(z_b, \\ell_s - 2L_a) = \\ell_s - 2L_a$.\nThe expression for $f(\\ell_s)$ simplifies to:\n$$f(\\ell_s) = \\frac{L_m - (\\ell_s - 2L_a)}{L_m - z_b} = \\frac{L_m + 2L_a - \\ell_s}{L_m - z_b}$$\nAlso, we must ensure the overlap is positive, which requires $L_m + 2L_a - \\ell_s > 0$.\n$1.60 + 2(1.05) - 2.50 = 1.60 + 2.10 - 2.50 = 3.70 - 2.50 = 1.20 > 0$. The overlap is indeed positive.\n\nSubstituting the numerical values into the formula for $f(\\ell_s)$:\n$$f(2.50) = \\frac{1.60 + 2(1.05) - 2.50}{1.60 - 0.20} = \\frac{1.20}{1.40} = \\frac{12}{14} = \\frac{6}{7}$$\nAs a decimal, $f(2.50) \\approx 0.8571428...$. Rounding to four significant figures gives $f(2.50) = 0.8571$.\n\nNext, we compute the active tension $\\sigma_{\\mathrm{act}}$ using the linear proportionality relation $\\sigma_{\\mathrm{act}} = \\sigma_{\\max}\\, f(\\ell_s)$.\n$$\\sigma_{\\mathrm{act}} = 120\\,\\mathrm{kPa} \\times \\frac{6}{7} = \\frac{720}{7}\\,\\mathrm{kPa} \\approx 102.85714...\\,\\mathrm{kPa}$$\nRounding to four significant figures, we get $\\sigma_{\\mathrm{act}} = 102.9\\,\\mathrm{kPa}$.\nThe two requested quantities are the dimensionless fraction $f(\\ell_s)$ and the active tension $\\sigma_{\\mathrm{act}}$ in kilopascals.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8571 & 102.9\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The collective action of billions of sarcomeres generates the pressure needed to pump blood, but this process also creates mechanical stress within the heart wall itself. This practice bridges the gap between cellular function and organ-level biomechanics by asking you to calculate the hoop stress in a simplified model of the left ventricle . By comparing the results from the simple Law of Laplace with a more rigorous thick-wall solution, you will gain critical insight into the validity and limitations of common biomechanical approximations.",
            "id": "4162666",
            "problem": "A pressurized Left Ventricle (LV), approximated as a thick-walled spherical shell, is modeled to evaluate circumferential (hoop) Cauchy stress at the endocardial (inner) surface under end-systolic conditions. Assume static equilibrium, no body forces, and an incompressible blood load. The inner radius is $a = 0.020$ m, the outer radius is $b = 0.035$ m, and the internal cavity pressure is $p = 16$ kPa. The wall thickness is $h = b - a$, and the midwall radius is $r_{m} = (a + b)/2$. \n\nTasks:\n- Using the thin-wall approximation derived from force balance on a hemispherical free-body at radius $r_{m}$, compute the hoop stress at the inner wall under the thin-wall assumption. Begin from Newton’s Second Law for static equilibrium applied to a membrane and do not invoke any pre-given formulas.\n- Using the thick-wall model derived from the spherically symmetric Cauchy momentum equation in static equilibrium and appropriate boundary conditions at $r = a$ and $r = b$, compute the hoop stress at the inner wall without using pre-given formulae. \n\nThen, define the relative difference as \n$$\\delta = \\frac{|\\sigma_{\\text{Laplace}} - \\sigma_{\\text{thick}}|}{\\sigma_{\\text{thick}}},$$\nand report only $\\delta$ as your final answer, expressed as a decimal (for example, $0.12$ for $12\\%$). \n\nExpress any intermediate stresses in kilopascals (kPa). Round your final answer for $\\delta$ to four significant figures.",
            "solution": "The solution proceeds in three parts: first, the calculation of hoop stress using the thin-wall approximation; second, the calculation of hoop stress using the thick-wall model; and third, the computation of the relative difference between the two results.\n\n**Part 1: Thin-Wall Approximation (Law of Laplace)**\n\nThe thin-wall approximation for a spherical pressure vessel, also known as the Law of Laplace, is derived from a force balance on a hemispherical section of the structure. The problem specifies using the midwall radius, $r_m = (a+b)/2$, and wall thickness, $h = b-a$.\n\nAccording to Newton's Second Law for static equilibrium, the sum of forces must be zero. We consider a hemispherical free-body diagram. The force $F_p$ exerted by the internal pressure $p$ on the circular cross-section of area $\\pi r_m^2$ must be balanced by the tensile force $F_\\sigma$ due to the hoop stress $\\sigma_{\\text{Laplace}}$ acting on the cut surface of the wall, which has an area of approximately $2\\pi r_m h$.\n\nThe force from the pressure is:\n$$F_p = p \\cdot (\\pi r_m^2)$$\n\nThe resisting force from the wall stress is:\n$$F_\\sigma = \\sigma_{\\text{Laplace}} \\cdot (2\\pi r_m h)$$\n\nFor static equilibrium, $F_p = F_\\sigma$:\n$$p \\pi r_m^2 = \\sigma_{\\text{Laplace}} (2\\pi r_m h)$$\n\nSolving for the hoop stress $\\sigma_{\\text{Laplace}}$:\n$$\\sigma_{\\text{Laplace}} = \\frac{p \\pi r_m^2}{2\\pi r_m h} = \\frac{p r_m}{2h}$$\n\nThe given values are:\n- Inner radius: $a = 0.020\\,\\text{m}$\n- Outer radius: $b = 0.035\\,\\text{m}$\n- Internal pressure: $p = 16\\,\\text{kPa}$\n\nFirst, we calculate $h$ and $r_m$:\n$$h = b - a = 0.035\\,\\text{m} - 0.020\\,\\text{m} = 0.015\\,\\text{m}$$\n$$r_m = \\frac{a+b}{2} = \\frac{0.020\\,\\text{m} + 0.035\\,\\text{m}}{2} = \\frac{0.055\\,\\text{m}}{2} = 0.0275\\,\\text{m}$$\n\nNow, we compute $\\sigma_{\\text{Laplace}}$:\n$$\\sigma_{\\text{Laplace}} = \\frac{(16\\,\\text{kPa})(0.0275\\,\\text{m})}{2(0.015\\,\\text{m})} = \\frac{0.44}{0.03}\\,\\text{kPa} = \\frac{44}{3}\\,\\text{kPa}$$\nSo, $\\sigma_{\\text{Laplace}} \\approx 14.67\\,\\text{kPa}$.\n\n**Part 2: Thick-Wall Model (Lamé's Solution)**\n\nFor a thick-walled sphere under internal pressure, we start from the Cauchy momentum equation for static equilibrium in spherical coordinates, assuming spherical symmetry and no body forces. The equation in the radial direction is:\n$$\\frac{d\\sigma_{rr}}{dr} + \\frac{2}{r}(\\sigma_{rr} - \\sigma_{\\theta\\theta}) = 0$$\nwhere $\\sigma_{rr}$ is the radial stress and $\\sigma_{\\theta\\theta} = \\sigma_{\\phi\\phi}$ is the circumferential (hoop) stress.\n\nFor a linear elastic, isotropic material, the general solution for the stresses that satisfies both the equilibrium and compatibility equations is of the form:\n$$\\sigma_{rr}(r) = A - \\frac{2B}{r^3}$$\n$$\\sigma_{\\theta\\theta}(r) = A + \\frac{B}{r^3}$$\nwhere $A$ and $B$ are constants determined by the boundary conditions.\n\nThe boundary conditions are:\n1.  At the inner surface ($r=a$), the radial stress equals the negative of the applied pressure: $\\sigma_{rr}(a) = -p$.\n2.  At the outer surface ($r=b$), which is assumed to be free of external pressure, the radial stress is zero: $\\sigma_{rr}(b) = 0$.\n\nUsing the second boundary condition:\n$$\\sigma_{rr}(b) = A - \\frac{2B}{b^3} = 0 \\implies A = \\frac{2B}{b^3}$$\n\nUsing the first boundary condition:\n$$\\sigma_{rr}(a) = A - \\frac{2B}{a^3} = -p$$\n\nSubstitute the expression for $A$ into the second equation:\n$$\\frac{2B}{b^3} - \\frac{2B}{a^3} = -p$$\n$$2B \\left( \\frac{1}{b^3} - \\frac{1}{a^3} \\right) = -p$$\n$$2B \\left( \\frac{a^3 - b^3}{a^3 b^3} \\right) = -p$$\n$$B = \\frac{-p a^3 b^3}{2(a^3 - b^3)} = \\frac{p a^3 b^3}{2(b^3 - a^3)}$$\n\nNow, solve for $A$:\n$$A = \\frac{2}{b^3} \\cdot B = \\frac{2}{b^3} \\left( \\frac{p a^3 b^3}{2(b^3 - a^3)} \\right) = \\frac{p a^3}{b^3 - a^3}$$\n\nThe hoop stress $\\sigma_{\\theta\\theta}(r)$ is given by $A + B/r^3$. We need to find the hoop stress at the inner wall ($r=a$), which we denote $\\sigma_{\\text{thick}}$:\n$$\\sigma_{\\text{thick}} = \\sigma_{\\theta\\theta}(a) = A + \\frac{B}{a^3}$$\n$$\\sigma_{\\text{thick}} = \\left( \\frac{p a^3}{b^3 - a^3} \\right) + \\frac{1}{a^3} \\left( \\frac{p a^3 b^3}{2(b^3 - a^3)} \\right)$$\n$$\\sigma_{\\text{thick}} = \\frac{p a^3}{b^3 - a^3} + \\frac{p b^3}{2(b^3 - a^3)}$$\n$$\\sigma_{\\text{thick}} = \\frac{p}{b^3 - a^3} \\left( a^3 + \\frac{b^3}{2} \\right) = \\frac{p(2a^3 + b^3)}{2(b^3 - a^3)}$$\n\nNow, we substitute the numerical values:\n$$a^3 = (0.020\\,\\text{m})^3 = 8 \\times 10^{-6}\\,\\text{m}^3$$\n$$b^3 = (0.035\\,\\text{m})^3 = 42.875 \\times 10^{-6}\\,\\text{m}^3$$\n\n$$\\sigma_{\\text{thick}} = \\frac{16\\,\\text{kPa} \\cdot (2(8 \\times 10^{-6}) + 42.875 \\times 10^{-6})\\,\\text{m}^3}{2 \\cdot (42.875 \\times 10^{-6} - 8 \\times 10^{-6})\\,\\text{m}^3}$$\n$$\\sigma_{\\text{thick}} = \\frac{16 \\cdot (16 + 42.875)}{2 \\cdot (34.875)}\\,\\text{kPa} = \\frac{8 \\cdot (58.875)}{34.875}\\,\\text{kPa}$$\n$$\\sigma_{\\text{thick}} = \\frac{471}{34.875}\\,\\text{kPa} = \\frac{1256}{93}\\,\\text{kPa}$$\nSo, $\\sigma_{\\text{thick}} \\approx 13.51\\,\\text{kPa}$.\n\n**Part 3: Relative Difference ($\\delta$)**\n\nThe relative difference $\\delta$ is defined as:\n$$\\delta = \\frac{|\\sigma_{\\text{Laplace}} - \\sigma_{\\text{thick}}|}{\\sigma_{\\text{thick}}}$$\n\nUsing the exact fractional values for the stresses:\n$$\\sigma_{\\text{Laplace}} = \\frac{44}{3}\\,\\text{kPa} = \\frac{44 \\times 31}{3 \\times 31}\\,\\text{kPa} = \\frac{1364}{93}\\,\\text{kPa}$$\n$$\\sigma_{\\text{thick}} = \\frac{1256}{93}\\,\\text{kPa}$$\n\n$$\\delta = \\frac{\\left| \\frac{1364}{93} - \\frac{1256}{93} \\right|}{\\frac{1256}{93}} = \\frac{\\frac{1364 - 1256}{93}}{\\frac{1256}{93}} = \\frac{108}{1256}$$\n\nTo simplify the fraction, we can divide the numerator and denominator by their greatest common divisor, which is $4$:\n$$\\delta = \\frac{108 \\div 4}{1256 \\div 4} = \\frac{27}{314}$$\n\nFinally, we compute the decimal value and round to four significant figures as required:\n$$\\delta = \\frac{27}{314} \\approx 0.08598726...$$\nRounding to four significant figures gives:\n$$\\delta \\approx 0.08599$$",
            "answer": "$$\\boxed{0.08599}$$"
        },
        {
            "introduction": "Cardiac function is a profoundly dynamic process, where force rises and falls with each heartbeat in response to a transient influx of calcium. This exercise moves beyond static analysis and into the realm of computational biomechanics, tasking you with simulating the entire time course of an isometric twitch . By numerically integrating a model of cross-bridge kinetics driven by a realistic calcium transient, you will directly observe how cellular-level parameters govern the shape, magnitude, and duration of the muscle's mechanical output.",
            "id": "4162691",
            "problem": "You are tasked with computing the isometric twitch active stress time course of cardiac muscle by integrating a time-dependent cross-bridge attachment rate driven by the intracellular calcium transient. The computation must start from first principles appropriate to biomechanics and must use a forward Euler numerical time integration scheme over a prescribed time grid. The system is isometric, so sarcomere length is fixed and force changes arise solely from attachment and detachment kinetics.\n\nFundamental base and definitions:\n1. Let $[\\mathrm{Ca}^{2+}](t)$ denote the free cytosolic calcium concentration in micromolar, defined by a physiologically realistic difference-of-exponentials transient with a finite resting baseline:\n$$\n[\\mathrm{Ca}^{2+}](t) = [\\mathrm{Ca}^{2+}]_{\\text{rest}} + C_{\\text{amp}} \\left(e^{-\\frac{(t - t_0)}{\\tau_d}} - e^{-\\frac{(t - t_0)}{\\tau_r}}\\right) H(t - t_0),\n$$\nwhere $[\\mathrm{Ca}^{2+}]_{\\text{rest}}$ is the resting calcium concentration in $\\mu\\mathrm{M}$, $C_{\\text{amp}}$ is the amplitude in $\\mu\\mathrm{M}$, $\\tau_r$ is the rise time constant in $\\mathrm{s}$, $\\tau_d$ is the decay time constant in $\\mathrm{s}$, $t_0$ is the activation onset time in $\\mathrm{s}$, and $H(\\cdot)$ is the Heaviside step function with $H(x)=0$ for $x<0$ and $H(x)=1$ for $x \\ge 0$.\n\n2. The biochemical cross-bridge attachment rate $f(t)$ depends on calcium via a Hill relation:\n$$\nf(t) = k \\cdot \\frac{([\\mathrm{Ca}^{2+}](t))^{n}}{([\\mathrm{Ca}^{2+}](t))^{n} + \\rho^{n}},\n$$\nwhere $k$ is the maximal attachment rate in $\\mathrm{s}^{-1}$, $\\rho$ is the half-activation calcium in $\\mu\\mathrm{M}$, and $n$ is the Hill coefficient (dimensionless). Use $n=3$.\n\n3. The detachment rate $g$ is constant with units $\\mathrm{s}^{-1}$.\n\n4. The fraction of attached cross-bridges $A(t)$ follows mass-action kinetics:\n$$\n\\frac{dA}{dt} = f(t)\\big(1 - A(t)\\big) - g\\,A(t),\n$$\nwith the physically consistent initial condition at $t=0$ taken to be the resting steady state under $[\\mathrm{Ca}^{2+}]_{\\text{rest}}$:\n$$\nA(0) = \\frac{f(0)}{f(0) + g}, \\quad \\text{where } f(0) = k \\cdot \\frac{([\\mathrm{Ca}^{2+}]_{\\text{rest}})^{n}}{([\\mathrm{Ca}^{2+}]_{\\text{rest}})^{n} + \\rho^{n}}.\n$$\n\n5. The isometric active stress $\\sigma(t)$ in $\\mathrm{kPa}$ is proportional to the attached fraction:\n$$\n\\sigma(t) = \\sigma_0 \\, A(t),\n$$\nwhere $\\sigma_0$ is the maximal active stress in $\\mathrm{kPa}$ achieved as $A(t) \\to 1$ under saturating calcium.\n\nNumerical integration requirements:\n- Integrate $\\frac{dA}{dt}$ using a forward Euler scheme with a fixed time step $\\Delta t$, updating $A$ as\n$$\nA_{i+1} = A_i + \\Delta t \\cdot \\left( f(t_i)\\big(1 - A_i\\big) - g\\,A_i \\right),\n$$\nwhere $t_i = i \\cdot \\Delta t$ and $A_i \\approx A(t_i)$.\n- Enforce the physical constraint $0 \\le A(t) \\le 1$ at every step by clipping to the interval $[0,1]$.\n- Compute the active stress $\\sigma_i = \\sigma_0 A_i$ at each time point.\n\nOutputs to compute for each test case:\n- The peak active stress $\\sigma_{\\text{peak}}$ in $\\mathrm{kPa}$.\n- The time to peak $t_{\\text{peak}}$ in $\\mathrm{ms}$ defined as the earliest simulation time at which $\\sigma(t)$ attains its maximum value.\n- The stress-time integral $I = \\int_{0}^{T} \\sigma(t) \\, dt$ in $\\mathrm{kPa}\\cdot\\mathrm{s}$ computed using the trapezoidal rule over the simulation duration.\n\nAnswer unit specifications:\n- Express $\\sigma_{\\text{peak}}$ in $\\mathrm{kPa}$.\n- Express $t_{\\text{peak}}$ in $\\mathrm{ms}$.\n- Express $I$ in $\\mathrm{kPa}\\cdot\\mathrm{s}$.\n\nTime discretization and integration window:\n- Use total simulation time $T$ and time step $\\Delta t$ as specified in each test case; all times are in $\\mathrm{s}$ and time steps are in $\\mathrm{s}$.\n\nTest suite:\nProvide results for the following four parameter sets. All calcium concentrations are in $\\mu\\mathrm{M}$, rates in $\\mathrm{s}^{-1}$, times in $\\mathrm{s}$, and stress in $\\mathrm{kPa}$.\n\n- Test case $1$ (baseline human-like twitch):\n  - $k = 200$\n  - $\\rho = 0.5$\n  - $g = 50$\n  - $n = 3$\n  - $[\\mathrm{Ca}^{2+}]_{\\text{rest}} = 0.05$\n  - $C_{\\text{amp}} = 0.9$\n  - $\\tau_r = 0.03$\n  - $\\tau_d = 0.2$\n  - $t_0 = 0$\n  - $\\sigma_0 = 80$\n  - $T = 0.8$\n  - $\\Delta t = 1\\times 10^{-4}$\n\n- Test case $2$ (reduced calcium availability):\n  - $k = 200$\n  - $\\rho = 0.5$\n  - $g = 50$\n  - $n = 3$\n  - $[\\mathrm{Ca}^{2+}]_{\\text{rest}} = 0.05$\n  - $C_{\\text{amp}} = 0.3$\n  - $\\tau_r = 0.03$\n  - $\\tau_d = 0.2$\n  - $t_0 = 0$\n  - $\\sigma_0 = 80$\n  - $T = 0.8$\n  - $\\Delta t = 1\\times 10^{-4}$\n\n- Test case $3$ (faster detachment):\n  - $k = 200$\n  - $\\rho = 0.5$\n  - $g = 120$\n  - $n = 3$\n  - $[\\mathrm{Ca}^{2+}]_{\\text{rest}} = 0.05$\n  - $C_{\\text{amp}} = 0.9$\n  - $\\tau_r = 0.03$\n  - $\\tau_d = 0.2$\n  - $t_0 = 0$\n  - $\\sigma_0 = 80$\n  - $T = 0.8$\n  - $\\Delta t = 1\\times 10^{-4}$\n\n- Test case $4$ (boundary case, no twitch):\n  - $k = 200$\n  - $\\rho = 0.5$\n  - $g = 50$\n  - $n = 3$\n  - $[\\mathrm{Ca}^{2+}]_{\\text{rest}} = 0.05$\n  - $C_{\\text{amp}} = 0$\n  - $\\tau_r = 0.03$\n  - $\\tau_d = 0.2$\n  - $t_0 = 0$\n  - $\\sigma_0 = 80$\n  - $T = 0.8$\n  - $\\Delta t = 1\\times 10^{-4}$\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case contributes a triplet formatted as $[\\sigma_{\\text{peak}},t_{\\text{peak}},I]$, so the overall output is a list of triplets, for example:\n$$\n[[\\sigma_{\\text{peak},1}, t_{\\text{peak},1}, I_1],[\\sigma_{\\text{peak},2}, t_{\\text{peak},2}, I_2],[\\sigma_{\\text{peak},3}, t_{\\text{peak},3}, I_3],[\\sigma_{\\text{peak},4}, t_{\\text{peak},4}, I_4]]\n$$\nAll numerical values must be floats.",
            "solution": "The user has provided a problem that is scientifically grounded, well-posed, and objective. It describes a standard, albeit simplified, model of cardiac muscle excitation-contraction coupling and asks for a numerical solution. All parameters, equations, initial conditions, and numerical methods are clearly defined. The requested outputs are unambiguous. The problem is therefore deemed **valid**.\n\nThe problem requires the computation of the isometric active stress time course in cardiac muscle, $\\sigma(t)$, by numerically solving a system of equations that model the underlying biomechanical and biochemical processes. The solution involves several steps, grounded in established principles of muscle physiology and numerical analysis.\n\n### 1. Modeling the Physiological Cascade\n\nThe model establishes a causal chain from cellular electrophysiology (represented by the calcium transient) to macroscopic mechanics (active stress generation).\n\n**a. Intracellular Calcium Transient, $[\\mathrm{Ca}^{2+}](t)$:**\nThe trigger for muscle contraction is a transient rise in the intracellular free calcium concentration, $[\\mathrm{Ca}^{2+}](t)$. The problem defines this using a phenomenological model, a difference-of-exponentials function superimposed on a resting baseline concentration, $[\\mathrm{Ca}^{2+}]_{\\text{rest}}$. This is a common and physiologically realistic representation. The equation is:\n$$\n[\\mathrm{Ca}^{2+}](t) = [\\mathrm{Ca}^{2+}]_{\\text{rest}} + C_{\\text{amp}} \\left(e^{-\\frac{(t - t_0)}{\\tau_d}} - e^{-\\frac{(t - t_0)}{\\tau_r}}\\right) H(t - t_0)\n$$\nHere, $t$ is time in seconds ($\\mathrm{s}$), $C_{\\text{amp}}$ is the transient amplitude in micromolar ($\\mu\\mathrm{M}$), $\\tau_r$ and $\\tau_d$ are the rise and decay time constants in $\\mathrm{s}$ respectively, $t_0$ is the onset time of the stimulus in $\\mathrm{s}$, and $H(\\cdot)$ is the Heaviside step function, ensuring the transient begins at $t=t_0$.\n\n**b. Calcium-Dependent Cross-Bridge Attachment Rate, $f(t)$:**\nCalcium ions bind to regulatory proteins (troponin C in cardiac muscle), which in turn permits the formation of force-generating cross-bridges between actin and myosin filaments. This cooperative binding process is modeled using a Hill equation, which relates the calcium concentration to the rate of cross-bridge attachment, $f(t)$:\n$$\nf(t) = k \\cdot \\frac{([\\mathrm{Ca}^{2+}](t))^{n}}{([\\mathrm{Ca}^{2+}](t))^{n} + \\rho^{n}}\n$$\nwhere $k$ is the maximal attachment rate in $\\mathrm{s}^{-1}$ at saturating calcium levels, $\\rho$ is the calcium concentration for half-maximal activation in $\\mu\\mathrm{M}$, and $n$ is the Hill coefficient, which describes the steepness (cooperativity) of the response. The problem specifies $n=3$.\n\n**c. Cross-Bridge Kinetics and the Fraction of Attached Bridges, $A(t)$:**\nThe dynamics of the population of cross-bridges are described by first-order mass-action kinetics. The rate of change of the fraction of attached cross-bridges, $A(t)$, depends on the attachment rate $f(t)$ acting on the population of available (unattached) bridges, $(1-A(t))$, and a constant detachment rate, $g$ in $\\mathrm{s}^{-1}$, acting on the population of attached bridges, $A(t)$. This leads to the ordinary differential equation (ODE):\n$$\n\\frac{dA}{dt} = f(t)\\big(1 - A(t)\\big) - g\\,A(t)\n$$\nThe system is assumed to be in a resting steady state at time $t=0$, determined by the resting calcium concentration, $[\\mathrm{Ca}^{2+}]_{\\text{rest}}$. The initial condition $A(0)$ is found by setting $\\frac{dA}{dt} = 0$ with the resting attachment rate $f(0)$:\n$$\nf(0)\\big(1 - A(0)\\big) - g\\,A(0) = 0 \\implies A(0) = \\frac{f(0)}{f(0) + g}\n$$\nwhere $f(0)$ is calculated using $[\\mathrm{Ca}^{2+}]_{\\text{rest}}$ in the Hill equation.\n\n**d. Isometric Active Stress, $\\sigma(t)$:**\nThe macroscopic active stress, $\\sigma(t)$, generated by the muscle is assumed to be directly proportional to the fraction of attached, force-generating cross-bridges, $A(t)$. The constant of proportionality, $\\sigma_0$ in kilopascals ($\\mathrm{kPa}$), represents the maximal stress that would be generated if all possible cross-bridges were attached ($A(t)=1$).\n$$\n\\sigma(t) = \\sigma_0 \\, A(t)\n$$\n\n### 2. Numerical Implementation\n\nThe ODE for $A(t)$ does not have a simple analytical solution when driven by the time-varying $f(t)$, necessitating a numerical approach.\n\n**a. Time Discretization:**\nThe simulation time window from $t=0$ to $t=T$ is discretized into a sequence of points $t_i = i \\cdot \\Delta t$, where $\\Delta t$ is the fixed time step and $i$ is an integer index from $0$ to $N = T/\\Delta t$.\n\n**b. Forward Euler Integration:**\nThe problem specifies the forward Euler method to integrate the ODE for $A(t)$. The derivative $\\frac{dA}{dt}$ at time $t_i$ is approximated as $\\frac{A_{i+1} - A_i}{\\Delta t}$. Substituting this into the ODE gives the update rule for finding the state $A_{i+1} \\approx A(t_{i+1})$ from the known state $A_i \\approx A(t_i)$:\n$$\n\\frac{A_{i+1} - A_i}{\\Delta t} = f(t_i)\\big(1 - A_i\\big) - g\\,A_i\n$$\n$$\nA_{i+1} = A_i + \\Delta t \\cdot \\left( f(t_i)\\big(1 - A_i\\big) - g\\,A_i \\right)\n$$\nThis calculation is performed iteratively for each time step from $i=0$ to $N-1$. To ensure physical realism, the value of $A_{i+1}$ is constrained to the interval $[0,1]$ at each step. This clipping prevents the numerical solution from violating the definition of $A(t)$ as a fraction.\n\n**c. Computation of Outputs:**\nOnce the time series for the attached fraction, $A_i$, is computed, the stress time series, $\\sigma_i = \\sigma_0 A_i$, is obtained. From this series, the required output metrics are calculated:\n- **Peak Active Stress ($\\sigma_{\\text{peak}}$):** The maximum value in the computed stress array, $\\sigma_{\\text{peak}} = \\max_i(\\sigma_i)$.\n- **Time to Peak ($t_{\\text{peak}}$):** The earliest time $t_j$ at which the stress reaches its peak value. This is found by identifying the index $j$ of the first occurrence of the maximum value in the stress array and then finding the corresponding time $t_j = j \\cdot \\Delta t$. The result is converted to milliseconds ($\\mathrm{ms}$).\n- **Stress-Time Integral ($I$):** The total mechanical impulse over the simulation duration is calculated by integrating the stress curve. The problem specifies the trapezoidal rule for this numerical integration:\n$$\nI = \\int_{0}^{T} \\sigma(t) \\, dt \\approx \\sum_{i=0}^{N-1} \\frac{\\sigma_i + \\sigma_{i+1}}{2} \\Delta t\n$$\nThis is efficiently computed using standard numerical library functions.\n\nThe overall algorithm consists of setting up the time grid, calculating the initial condition $A(0)$, pre-calculating the time-dependent calcium concentration $[\\mathrm{Ca}^{2+}](t_i)$ and attachment rate $f(t_i)$ for all time points, iterating the forward Euler step to find $A(t_i)$, calculating $\\sigma(t_i)$, and finally extracting the three specified metrics from the resulting stress curve. This process is repeated for each of the four test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the cardiac muscle biomechanics problem for all test cases.\n    \"\"\"\n    \n    # Define the test cases as a list of dictionaries.\n    test_cases = [\n        # Test case 1 (baseline human-like twitch)\n        {\n            \"k\": 200.0, \"rho\": 0.5, \"g\": 50.0, \"n\": 3.0, \"Ca_rest\": 0.05,\n            \"C_amp\": 0.9, \"tau_r\": 0.03, \"tau_d\": 0.2, \"t0\": 0.0,\n            \"sigma0\": 80.0, \"T\": 0.8, \"dt\": 1e-4\n        },\n        # Test case 2 (reduced calcium availability)\n        {\n            \"k\": 200.0, \"rho\": 0.5, \"g\": 50.0, \"n\": 3.0, \"Ca_rest\": 0.05,\n            \"C_amp\": 0.3, \"tau_r\": 0.03, \"tau_d\": 0.2, \"t0\": 0.0,\n            \"sigma0\": 80.0, \"T\": 0.8, \"dt\": 1e-4\n        },\n        # Test case 3 (faster detachment)\n        {\n            \"k\": 200.0, \"rho\": 0.5, \"g\": 120.0, \"n\": 3.0, \"Ca_rest\": 0.05,\n            \"C_amp\": 0.9, \"tau_r\": 0.03, \"tau_d\": 0.2, \"t0\": 0.0,\n            \"sigma0\": 80.0, \"T\": 0.8, \"dt\": 1e-4\n        },\n        # Test case 4 (boundary case, no twitch)\n        {\n            \"k\": 200.0, \"rho\": 0.5, \"g\": 50.0, \"n\": 3.0, \"Ca_rest\": 0.05,\n            \"C_amp\": 0.0, \"tau_r\": 0.03, \"tau_d\": 0.2, \"t0\": 0.0,\n            \"sigma0\": 80.0, \"T\": 0.8, \"dt\": 1e-4\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        result_triplet = compute_twitch_dynamics(params)\n        results.append(result_triplet)\n\n    # Format the final output string as a list of lists.\n    # The map(str, results) correctly converts each inner list to its string representation.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\ndef compute_twitch_dynamics(params):\n    \"\"\"\n    Computes the isometric twitch dynamics for a single set of parameters.\n\n    Args:\n        params (dict): A dictionary containing all model and simulation parameters.\n\n    Returns:\n        list: A list containing [sigma_peak, t_peak_ms, integral_I].\n    \"\"\"\n    # Unpack parameters\n    k, rho, g, n, Ca_rest = params[\"k\"], params[\"rho\"], params[\"g\"], params[\"n\"], params[\"Ca_rest\"]\n    C_amp, tau_r, tau_d, t0 = params[\"C_amp\"], params[\"tau_r\"], params[\"tau_d\"], params[\"t0\"]\n    sigma0, T, dt = params[\"sigma0\"], params[\"T\"], params[\"dt\"]\n\n    # 1. Time Discretization\n    # Add a small epsilon to T to ensure the last point is included by linspace/arange\n    num_steps = int(round(T / dt)) \n    t = np.linspace(0.0, T, num_steps + 1)\n    \n    # 2. Calcium Transient Calculation\n    # Heaviside function is implicitly handled by the time mask\n    time_mask = t >= t0\n    transient_term = np.zeros_like(t)\n    t_active = t[time_mask]\n    \n    # Avoid division by zero if tau_r equals tau_d (not in test cases, but good practice)\n    if tau_r != tau_d:\n        transient_term[time_mask] = C_amp * (np.exp(-(t_active - t0) / tau_d) - np.exp(-(t_active - t0) / tau_r))\n    \n    Ca_t = Ca_rest + transient_term\n    \n    # 3. Attachment Rate Calculation\n    f_t = k * (Ca_t**n) / (Ca_t**n + rho**n)\n\n    # 4. Initial Condition for Attached Fraction A(t)\n    A = np.zeros_like(t)\n    f0 = f_t[0] \n    A[0] = f0 / (f0 + g)\n\n    # 5. Forward Euler Integration\n    for i in range(num_steps):\n        A_i = A[i]\n        f_i = f_t[i]\n        \n        # ODE: dA/dt = f(t)(1-A) - gA\n        dA_dt = f_i * (1 - A_i) - g * A_i\n        \n        # Update step\n        A_next = A_i + dt * dA_dt\n        \n        # Clip to maintain physical bounds 0 = A = 1\n        A[i+1] = max(0.0, min(1.0, A_next))\n        \n    # 6. Active Stress Calculation\n    sigma_t = sigma0 * A\n\n    # 7. Compute Output Metrics\n    # Peak active stress (kPa)\n    sigma_peak = np.max(sigma_t)\n    \n    # Time to peak (ms)\n    # np.argmax() returns the index of the first occurrence of the maximum value\n    peak_index = np.argmax(sigma_t)\n    t_peak_ms = t[peak_index] * 1000.0\n    \n    # Stress-time integral (kPa*s) using the trapezoidal rule\n    integral_I = np.trapz(sigma_t, t)\n    \n    return [sigma_peak, t_peak_ms, integral_I]\n\nsolve()\n```"
        }
    ]
}