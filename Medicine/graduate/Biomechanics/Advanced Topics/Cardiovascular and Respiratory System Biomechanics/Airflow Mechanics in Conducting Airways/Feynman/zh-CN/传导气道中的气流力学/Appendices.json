{
    "hands_on_practices": [
        {
            "introduction": "我们对传导气道中气流力学的探索始于最基本的构建单元：单个气道段。理想情况下，我们可以将气道段模拟为直圆管中的层流。这个练习  将指导您使用哈根-泊肃叶定律 (Hagen-Poiseuille law) 来量化气道阻力，并分析该阻力对气道半径微小变化的极端敏感性。掌握这种敏感性分析对于理解哮喘等阻塞性肺病的发病机制至关重要。",
            "id": "4152629",
            "problem": "考虑一个理想化的单一传导气道，其形态为一个长为 $L$、半径为 $r$ 的刚性直圆柱管。管中输运的是不可压缩的牛顿流体（空气），流动状态为稳定、轴对称、充分发展的层流，并满足无滑移边界条件，且入口/出口效应可忽略不计。流体阻力 $R$ 定义为 $R = \\Delta P/Q$，其中 $\\Delta P$ 是管段两端的压力降，$Q$ 是体积流率。在这些条件下，请基于一个有效的基础原理，推导 $R$ 对半径 $r$ 微小相对变化的一阶灵敏度，并以微分形式表示为 $dR/R$ 和 $dr/r$ 之间的关系。然后，当半径均匀减小 $10\\%$（即 $r \\to 0.9\\,r$），而长度 $L$ 和动力黏度 $\\mu$ 保持不变时，计算 $R$ 的精确相对增量，定义为 $(R_{\\text{new}} - R_{\\text{old}})/R_{\\text{old}}$，并以无量纲的小数形式报告结果。将最终数值四舍五入至四位有效数字。最终答案以无量纲数（无单位）的形式表示。",
            "solution": "经评估，该问题陈述在科学上是合理的、提法恰当、客观、完整且一致的。它描述了一个流体动力学中的经典问题——哈根-泊肃叶流，并要求进行标准的灵敏度分析和基于所推导原理的计算。因此，该问题是有效的，有必要提供解答。\n\n控制不可压缩牛顿流体在直圆管中进行稳定、充分发展的层流的基本关系是哈根-泊肃叶方程。该方程给出了体积流率 $Q$ 与长度为 $L$ 的管段上的压力降 $\\Delta P$、管的半径 $r$ 以及流体的动力黏度 $\\mu$ 之间的函数关系：\n$$\nQ = \\frac{\\pi r^4}{8 \\mu L} \\Delta P\n$$\n流体阻力 $R$ 定义为压力降与体积流率之比：\n$$\nR = \\frac{\\Delta P}{Q}\n$$\n将哈根-泊肃叶方程中 $Q$ 的表达式代入 $R$ 的定义，我们可以用几何和流体属性来表示阻力：\n$$\nR = \\frac{\\Delta P}{\\frac{\\pi r^4}{8 \\mu L} \\Delta P} = \\frac{8 \\mu L}{\\pi r^4}\n$$\n这个 $R$ 的表达式构成了问题两个部分的基础。\n\n首先，我们推导 $R$ 对半径 $r$ 微小相对变化的一阶灵敏度。我们寻求阻力的相对微分变化 $dR/R$ 与半径的相对微分变化 $dr/r$ 之间的关系。最直接的方法是对数微分法。对 $R$ 的表达式取自然对数：\n$$\n\\ln(R) = \\ln\\left(\\frac{8 \\mu L}{\\pi r^4}\\right)\n$$\n利用对数的性质，上式可以展开为：\n$$\n\\ln(R) = \\ln(8) + \\ln(\\mu) + \\ln(L) - \\ln(\\pi) - \\ln(r^4)\n$$\n$$\n\\ln(R) = \\ln\\left(\\frac{8 \\mu L}{\\pi}\\right) - 4 \\ln(r)\n$$\n现在，我们对这个方程取全微分。由于 $L$ 和 $\\mu$ 保持不变，项 $\\ln(8 \\mu L / \\pi)$ 是一个常数，其微分为零。\n$$\nd(\\ln(R)) = d\\left(\\ln\\left(\\frac{8 \\mu L}{\\pi}\\right)\\right) - d(4 \\ln(r))\n$$\n$$\n\\frac{dR}{R} = 0 - 4 \\frac{dr}{r}\n$$\n这就得到了所需的一阶灵敏度关系：\n$$\n\\frac{dR}{R} = -4 \\frac{dr}{r}\n$$\n这个结果表明，半径的微小相对增加会导致流体阻力四倍的相对减小，这是 $r^4$ 依赖关系的结果。\n\n其次，我们计算当半径均匀减小 $10\\%$ 时 $R$ 的精确相对增量。设原始半径为 $r_{\\text{old}}$，原始阻力为 $R_{\\text{old}}$。新半径 $r_{\\text{new}}$ 比原始半径小 $10\\%$：\n$$\nr_{\\text{new}} = r_{\\text{old}} - 0.10 r_{\\text{old}} = 0.9 r_{\\text{old}}\n$$\n原始阻力由下式给出：\n$$\nR_{\\text{old}} = \\frac{8 \\mu L}{\\pi r_{\\text{old}}^4}\n$$\n对应于新半径 $r_{\\text{new}}$ 的新阻力 $R_{\\text{new}}$ 是：\n$$\nR_{\\text{new}} = \\frac{8 \\mu L}{\\pi r_{\\text{new}}^4} = \\frac{8 \\mu L}{\\pi (0.9 r_{\\text{old}})^4}\n$$\n$R$ 的相对增量定义为 $\\frac{R_{\\text{new}} - R_{\\text{old}}}{R_{\\text{old}}}$。我们可以通过先计算比值 $\\frac{R_{\\text{new}}}{R_{\\text{old}}}$ 来求解：\n$$\n\\frac{R_{\\text{new}}}{R_{\\text{old}}} = \\frac{\\frac{8 \\mu L}{\\pi (0.9 r_{\\text{old}})^4}}{\\frac{8 \\mu L}{\\pi r_{\\text{old}}^4}} = \\frac{r_{\\text{old}}^4}{(0.9 r_{\\text{old}})^4} = \\frac{1}{(0.9)^4}\n$$\n现在，我们计算 $(0.9)^4$ 的值：\n$$\n(0.9)^4 = 0.81^2 = 0.6561\n$$\n因此，阻力之比为：\n$$\n\\frac{R_{\\text{new}}}{R_{\\text{old}}} = \\frac{1}{0.6561}\n$$\n那么相对增量为：\n$$\n\\frac{R_{\\text{new}} - R_{\\text{old}}}{R_{\\text{old}}} = \\frac{R_{\\text{new}}}{R_{\\text{old}}} - 1 = \\frac{1}{0.6561} - 1\n$$\n进行计算：\n$$\n\\frac{1}{0.6561} - 1 \\approx 1.5241579027... - 1 = 0.5241579027...\n$$\n问题要求将结果四舍五入到四位有效数字。\n$$\n0.5242\n$$\n因此，气道半径减小 $10\\%$ 会导致流体阻力增加约 $52.42\\%$，这凸显了气道口径对呼吸功的至关重要的影响。",
            "answer": "$$\n\\boxed{0.5242}\n$$"
        },
        {
            "introduction": "虽然哈根-泊肃叶模型是理解气道阻力的基石，但它假设气流是完全发展的。在现实中，当空气进入一个新的支气管段时，速度剖面需要一段距离才能形成，这个入口区域的流动发展会产生额外的压降。本练习  引入了动能修正系数的概念来量化入口效应，让您能够修正经典泊肃叶流的预测，从而更精确地评估总压降。",
            "id": "4152689",
            "problem": "考虑进入一段直径为$D$、长度等于入口长度$L_e$的笔直、刚性、圆形支气管的稳态、不可压缩、轴对称层流空气流。流体为体温条件下的空气，其动力粘度为$\\mu$，质量密度为$\\rho$。平均轴向速度为$V_{m}$，入口速度剖面的动能修正系数（科里奥利系数）为$\\alpha_{\\text{in}}$，而充分发展的层流剖面的动能修正系数为$\\alpha_{\\text{fd}}$。从包含动能修正系数的内部流动机械能平衡方程以及圆形管道中层流压力梯度的定义出发，推导一个由流动发展引起的、在区域$x \\in [0,L_{e}]$上对充分发展摩擦因子的修正表达式，该表达式用$\\alpha_{\\text{in}}$、$\\alpha_{\\text{fd}}$、$D$、$L_{e}$和雷诺数$Re$表示。然后，对于参数值$D=0.004\\,\\text{m}$、$\\mu=1.9\\times 10^{-5}\\,\\text{Pa}\\cdot\\text{s}$、$\\rho=1.2\\,\\text{kg}\\cdot\\text{m}^{-3}$、$V_{m}=0.5\\,\\text{m}\\cdot\\text{s}^{-1}$、$\\alpha_{\\text{in}}=1.0$和$\\alpha_{\\text{fd}}=2.0$，取层流入口长度为$L_{e}=0.05\\,Re\\,D$，其中$Re=\\rho V_{m}D/\\mu$，并估算在$L_e$上的压降相对于仅假设在$L_e$上为充分发展（泊肃叶）流动所得预测值的百分比增量。将百分比增量表示为小数形式，并将最终答案四舍五入至三位有效数字。如果需要，在中间压降计算中使用帕斯卡作为单位，但最终的小数形式必须是无量纲的。",
            "solution": "问题陈述已经过验证，被认为是科学上合理的、提法得当且客观的。它包含了推导所要求的表达式和计算最终数值答案所需的所有信息。因此，我们可以开始解题。\n\n问题分为两部分。首先，我们必须推导一个因入口区流动发展而对充分发展摩擦因子产生的修正表达式。其次，我们必须使用这个框架来估算在一组特定参数下，入口长度上的压降百分比增量。\n\n首先，让我们验证流动状态是否与问题中层流的假设一致。雷诺数$Re$定义为：\n$$ Re = \\frac{\\rho V_{m} D}{\\mu} $$\n使用提供的数值：\n$$ Re = \\frac{(1.2\\,\\text{kg}\\cdot\\text{m}^{-3}) (0.5\\,\\text{m}\\cdot\\text{s}^{-1}) (0.004\\,\\text{m})}{1.9 \\times 10^{-5}\\,\\text{Pa}\\cdot\\text{s}} = \\frac{0.0024}{1.9 \\times 10^{-5}} \\approx 126.3 $$\n由于$Re \\approx 126.3$远低于圆形管道中向湍流过渡的临界值（通常$Re_{crit} \\approx 2300$），因此流动确实是层流。\n\n**第一部分：摩擦因子修正的推导**\n\n我们从稳态、不可压缩流在等直径水平管道中两点（入口1和出口2）之间的机械能平衡方程开始。该方程包含动能修正系数$\\alpha$，以解释非均匀的速度剖面。\n$$ \\frac{p_1}{\\rho} + \\alpha_1 \\frac{V_{m1}^2}{2} + gz_1 = \\frac{p_2}{\\rho} + \\alpha_2 \\frac{V_{m2}^2}{2} + gz_2 + h_L $$\n对于水平管道（$z_1 = z_2$）和恒定直径（$V_{m1} = V_{m2} = V_m$），方程简化为：\n$$ \\frac{p_1 - p_2}{\\rho} = (\\alpha_2 - \\alpha_1) \\frac{V_m^2}{2} + h_L $$\n这里，$p_1 - p_2 = \\Delta p$是压降，$h_L$是由摩擦效应引起的水头损失。本问题考虑的是从入口$x=0$到入口区末端$x=L_e$的流动。在入口（1），我们有一个均匀的速度剖面，所以$\\alpha_1 = \\alpha_{\\text{in}}$。在出口（2），流动是充分发展的，所以$\\alpha_2 = \\alpha_{\\text{fd}}$。在长度$L_e$上的总压降，记为$\\Delta p_{L_e}$，是：\n$$ \\Delta p_{L_e} = \\frac{1}{2}\\rho V_m^2 (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) + \\rho h_L $$\n项$\\rho h_L$表示由管壁粘性摩擦引起的压降，$\\Delta p_{f}$。右边的第一项表示当速度剖面从入口形状发展到充分发展的抛物线形状时，改变流动动量通量所需的压降。我们称这一项为$\\Delta p_{\\text{mom}}$：\n$$ \\Delta p_{\\text{mom}} = \\frac{1}{2}\\rho V_m^2 (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) $$\n因此，总压降为 $\\Delta p_{L_e} = \\Delta p_{\\text{mom}} + \\Delta p_{f}$。\n\n问题暗示了一个简化模型，其中入口长度上的摩擦压降$\\Delta p_f$近似于假设流动在相同长度上完全充分发展时会发生的压降。这个压降$\\Delta p_{\\text{fd}}$由Hagen-Poiseuille方程给出，或等效地，使用充分发展的达西摩擦因子$f_{\\text{fd}}$。对于层流，$f_{\\text{fd}} = 64/Re$。\n$$ \\Delta p_f \\approx \\Delta p_{\\text{fd}} = f_{\\text{fd}} \\frac{L_e}{D} \\frac{\\rho V_m^2}{2} $$\n在此近似下，入口长度上的总压降为：\n$$ \\Delta p_{L_e} \\approx \\left( f_{\\text{fd}} \\frac{L_e}{D} \\right) \\frac{\\rho V_m^2}{2} + (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) \\frac{\\rho V_m^2}{2} $$\n为了找到“对摩擦因子的修正”，我们定义一个表观摩擦因子$f_{\\text{app}}$，它解释了长度$L_e$上的总压降：\n$$ \\Delta p_{L_e} = f_{\\text{app}} \\frac{L_e}{D} \\frac{\\rho V_m^2}{2} $$\n将$\\Delta p_{L_e}$的两个表达式相等：\n$$ f_{\\text{app}} \\frac{L_e}{D} \\frac{\\rho V_m^2}{2} = \\left( f_{\\text{fd}} \\frac{L_e}{D} \\right) \\frac{\\rho V_m^2}{2} + (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) \\frac{\\rho V_m^2}{2} $$\n所有项都除以$\\frac{\\rho V_m^2}{2}$：\n$$ f_{\\text{app}} \\frac{L_e}{D} = f_{\\text{fd}} \\frac{L_e}{D} + (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) $$\n解出$f_{\\text{app}}$：\n$$ f_{\\text{app}} = f_{\\text{fd}} + \\frac{D}{L_e} (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) $$\n对充分发展摩擦因子的修正，我们可以记作$\\Delta f$，是由流动发展引起的附加项：\n$$ \\Delta f = \\frac{D}{L_e} (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) $$\n这个表达式依赖于$\\alpha_{\\text{in}}$、$\\alpha_{\\text{fd}}$、$D$、$L_e$，并通过$L_e$的定义隐式地依赖于$Re$。\n\n**第二部分：压降的百分比增量**\n\n压降的百分比增量是相对于假设在整个长度$L_e$上流动是充分发展的预测来计算的。\n“实际”压降（在我们的模型中）是$\\Delta p_{L_e}$。\n$$ \\Delta p_{L_e} = \\Delta p_{\\text{fd}} + \\Delta p_{\\text{mom}} $$\n假设充分发展流动的“朴素”预测就是$\\Delta p_{\\text{fd}}$。\n分数增量由下式给出：\n$$ \\text{Fractional Increase} = \\frac{\\Delta p_{L_e} - \\Delta p_{\\text{fd}}}{\\Delta p_{\\text{fd}}} = \\frac{(\\Delta p_{\\text{fd}} + \\Delta p_{\\text{mom}}) - \\Delta p_{\\text{fd}}}{\\Delta p_{\\text{fd}}} = \\frac{\\Delta p_{\\text{mom}}}{\\Delta p_{\\text{fd}}} $$\n现在，我们代入$\\Delta p_{\\text{mom}}$和$\\Delta p_{\\text{fd}}$的表达式：\n$$ \\Delta p_{\\text{mom}} = \\frac{1}{2}\\rho V_m^2 (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) $$\n$$ \\Delta p_{\\text{fd}} = f_{\\text{fd}} \\frac{L_e}{D} \\frac{\\rho V_m^2}{2} $$\n该比率变为：\n$$ \\text{Fractional Increase} = \\frac{\\frac{1}{2}\\rho V_m^2 (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}})}{f_{\\text{fd}} \\frac{L_e}{D} \\frac{\\rho V_m^2}{2}} = \\frac{\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}}{f_{\\text{fd}} \\frac{L_e}{D}} $$\n问题提供了具体的关系：\n$f_{\\text{fd}} = \\frac{64}{Re}$\n$L_e = 0.05 \\, Re \\, D$\n将这些代入分数增量的表达式中：\n$$ \\text{Fractional Increase} = \\frac{\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}}{\\left(\\frac{64}{Re}\\right) \\frac{(0.05 \\, Re \\, D)}{D}} $$\n项$Re$和$D$相互抵消，得到一个非常简单的结果，只要流动是层流，这个结果就与具体的流动条件无关。\n$$ \\text{Fractional Increase} = \\frac{\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}}{64 \\times 0.05} $$\n现在我们代入动能修正系数的给定数值：$\\alpha_{\\text{in}} = 1.0$（对于指定的均匀入口剖面）和$\\alpha_{\\text{fd}} = 2.0$（对于充分发展的层流剖面）。\n$$ \\text{Fractional Increase} = \\frac{2.0 - 1.0}{64 \\times 0.05} = \\frac{1.0}{3.2} = 0.3125 $$\n问题要求答案四舍五入到三位有效数字。\n$$ \\text{Fractional Increase} \\approx 0.313 $$\n这意味着对于给定的模型和参数，入口区域的压降比假设在相同长度上为充分发展的泊肃叶流所预测的值高出约$31.3\\%$。这种增加完全是由于将流体加速成抛物线速度剖面所需的压力变化。",
            "answer": "$$\\boxed{0.313}$$"
        },
        {
            "introduction": "在掌握了单个气道的流动特性后，我们可以将这些独立的单元组合成一个网络来模拟整个传导气道树。这种方法使我们能够研究局部变化（如因疾病引起的单个气道狭窄）如何影响整个肺部的通气分布。本练习  是一个计算实践，您将构建一个基于阻力网络的模型，求解系统中的压力和流量，并量化局部收缩对肺泡通气均匀性的影响。",
            "id": "4152642",
            "problem": "您的任务是在稳定、层流、不可压缩的条件下，将传导气道中的气流建模为一个阻力网络，以评估当单个分支发生局部收缩时，肺泡通气分布如何变化。传导气道网络表示为一个有向二叉树，其中口腔为根节点，肺泡为叶节点。气流由口腔处的固定压力驱动，该压力是相对于设为零的肺泡压力而言的。目标是通过求解收缩前后的网络流方程，计算肺泡分数通气分布对指定分支半径减少 $30\\%$ 的敏感度。\n\n基础原理：\n- 质量守恒：在每个内部节点，流入量之和等于流出量之和。\n- 在低雷诺数（Reynolds number (Re)）范围内，将牛顿定律应用于圆柱体中的粘性流动，可得出哈根-泊肃叶（Hagen–Poiseuille）关系。该关系控制着通过圆柱形气道段（建模为流体阻力器）的体积流量。对于一个半径为 $r$、长度为 $L$、动力粘度为 $\\mu$、上游压力为 $p_u$、下游压力为 $p_v$ 的分支，其体积流量为\n$$\nQ = \\frac{p_u - p_v}{R}, \\quad R = \\frac{8 \\mu L}{\\pi r^4}.\n$$\n这些关系被用来构建阻力网络中节点压力的线性系统。\n\n网络表示：\n- 节点由整数索引。节点 $0$ 是口腔（源），具有固定压力 $p_{\\mathrm{in}}$。节点 $7$ 到 $14$ 是肺泡（汇），具有固定压力 $p_{\\mathrm{alv}} = 0\\,\\mathrm{Pa}$。所有其他节点都是压力未知的内部节点。\n- 边（气道段）从父节点指向子节点。每条边 $e$ 由 $(u_e, v_e, L_e, r_e)$ 表示，其中 $u_e$ 是上游节点索引，$v_e$ 是下游节点索引，$L_e$ 是长度（单位 $\\mathrm{m}$），$r_e$ 是半径（单位 $\\mathrm{m}$）。该网络包含 $14$ 条边和 $15$ 个节点，结构如下：\n1. 第 1 代：边 $e_0: (0 \\rightarrow 1)$，$e_1: (0 \\rightarrow 2)$，每个的 $L = 0.06$ $\\mathrm{m}$，$r = 0.006$ $\\mathrm{m}$。\n2. 第 2 代：边 $e_2: (1 \\rightarrow 3)$，$e_3: (1 \\rightarrow 4)$，$e_4: (2 \\rightarrow 5)$，$e_5: (2 \\rightarrow 6)$，每个的 $L = 0.03$ $\\mathrm{m}$，$r = 0.0035$ $\\mathrm{m}$。\n3. 第 3 代：边 $e_6: (3 \\rightarrow 7)$，$e_7: (3 \\rightarrow 8)$，$e_8: (4 \\rightarrow 9)$，$e_9: (4 \\rightarrow 10)$，$e_{10}: (5 \\rightarrow 11)$，$e_{11}: (5 \\rightarrow 12)$，$e_{12}: (6 \\rightarrow 13)$，$e_{13}: (6 \\rightarrow 14)$，每个的 $L = 0.02$ $\\mathrm{m}$，$r = 0.0020$ $\\mathrm{m}$。\n- 空气粘度为 $\\mu = 1.9 \\times 10^{-5}$ $\\mathrm{Pa \\cdot s}$。\n\n数学公式：\n- 设 $E$ 为边的数量，$N$ 为节点的数量。定义一个边-节点关联矩阵 $B \\in \\mathbb{R}^{E \\times N}$，其行由边索引，列由节点索引，元素为 $B_{e,u_e} = +1$，$B_{e,v_e} = -1$，其他情况为 $0$。设 $K \\in \\mathbb{R}^{E \\times E}$ 为对角矩阵，其对角元素为 $K_{e,e} = 1/R_e$。\n- 边流量满足\n$$\nQ = K \\, B \\, p,\n$$\n其中 $p \\in \\mathbb{R}^{N}$ 是节点压力的向量。\n- 内部（压力未知）节点的质量守恒导致\n$$\nB^\\top Q = 0 \\quad \\Rightarrow \\quad B^\\top K B \\, p = 0.\n$$\n将节点划分为未知压力集 $U$ 和已知（给定压力）集 $K$，并写出简化的线性系统\n$$\nL_{UU} \\, p_U = - L_{UK} \\, p_K,\n$$\n其中 $L = B^\\top K B$ 是加权图拉普拉斯矩阵。求解 $p_U$，然后计算边流量 $Q$ 和流入每个肺泡叶节点 $i \\in \\{7,\\dots,14\\}$ 的末端流量 $q_i$。\n\n肺泡通气分布：\n- 总入口流量为 $Q_{\\mathrm{tot}} = \\sum_{e \\in \\{e_0,e_1\\}} Q_e$，单位为 $\\mathrm{m^3/s}$。流入叶节点 $i$ 的肺泡流量是进入节点 $i$ 的单边流量的大小，记为 $q_i$，单位为 $\\mathrm{m^3/s}$。肺泡分数通气为\n$$\nf_i = \\frac{q_i}{\\sum_{j=7}^{14} q_j},\n$$\n它是无量纲的。\n\n对局部收缩的敏感度：\n- 选择一条边 $j$ 并将其半径减少 $30\\%$，即 $r_j' = 0.7 \\, r_j$。重新计算流量以获得 $f_i'$。将测试用例的敏感度指标定义为所有肺泡的分数通气的最大绝对变化：\n$$\nS = \\max_{i \\in \\{7,\\dots,14\\}} \\left| f_i' - f_i \\right|.\n$$\n将 $S$ 报告为一个无量纲浮点数。\n\n单位和数值输出：\n- 压力使用 $\\mathrm{Pa}$，长度使用 $\\mathrm{m}$，体积流量使用 $\\mathrm{m^3/s}$。程序的最终输出必须是包含一个浮点数列表 $[S_1,S_2,S_3,S_4]$ 的单行，其中每个 $S$ 都四舍五入到 $6$ 位小数。\n\n测试套件：\n- 所有案例均使用上述指定的网络结构和粘度。每个案例设置 $p_{\\mathrm{in}}$ 并指定要收缩 $30\\%$ 的边的索引。某些案例会修改基线半径以引入异质性。所有叶节点的已知肺泡压力均固定为 $0\\,\\mathrm{Pa}$。\n1. 案例 1（对称树，中代收缩）：$p_{\\mathrm{in}} = 200\\,\\mathrm{Pa}$，收缩边 $e_3$。\n2. 案例 2（对称树，近端收缩）：$p_{\\mathrm{in}} = 200\\,\\mathrm{Pa}$，收缩边 $e_0$。\n3. 案例 3（异质性右子树，远端收缩）：$p_{\\mathrm{in}} = 200\\,\\mathrm{Pa}$。将右子树（边 $e_4$、$e_5$、$e_{10}$、$e_{11}$、$e_{12}$、$e_{13}$）中的半径修改为其基线半径的 $0.85$ 倍；然后收缩边 $e_{11}$。\n4. 案例 4（较低驱动压力，远端收缩）：$p_{\\mathrm{in}} = 50\\,\\mathrm{Pa}$，收缩边 $e_{12}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[0.123456,0.234567,0.345678,0.456789]$）。每个条目必须是相应案例的敏感度 $S$，并四舍五入到 $6$ 位小数。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它以流体动力学原理（哈根-泊肃叶流）为科学基础，作为一个从守恒定律推导出的线性系统，在数学上是适定的，并提供了一套完整、明确的参数和目标。该模型虽然是对复杂的人类呼吸系统的简化，但它是分析阻力网络中气流分布基本力学的标准且恰当的表示方法。\n\n解决方案首先构建气道网络的数学模型，然后实现一个算法来求解气流分布及其对局部收缩的敏感度。\n\n**1. 控制原理和数学公式**\n\n该模型基于两个核心原理：\n\n- **哈根-泊肃叶定律（Hagen-Poiseuille Law）**：对于通过圆柱形管的稳定、层流、不可压缩流动，体积流量 $Q$ 与管两端的压降 $\\Delta p = p_u - p_v$ 成正比。这种关系类似于欧姆定律，流体阻力 $R$ 定义为：\n$$\nQ = \\frac{\\Delta p}{R} \\quad \\text{其中} \\quad R = \\frac{8 \\mu L}{\\pi r^4}\n$$\n此处，$\\mu$ 是空气的动力粘度，而 $L$ 和 $r$ 分别是气道段的长度和半径。该段的导纳为 $G = 1/R$。\n\n- **质量守恒**：在气道网络中的任何内部连接点（节点），进入该连接点的总质量流量必须等于离开该连接点的总质量流量。对于不可压缩流体，这简化为体积流量守恒：\n$$\n\\sum Q_{\\text{in}} = \\sum Q_{\\text{out}}\n$$\n\n**2. 作为线性方程组的网络模型**\n\n气道树表示为一个有 $N=15$ 个节点和 $E=14$ 条边的有向图。系统的状态由每个节点 $j$ 处的静水压力 $p_j$ 定义。\n\n- **关联矩阵（$B$）**：网络拓扑被编码在一个边-节点关联矩阵 $B \\in \\mathbb{R}^{E \\times N}$ 中。对于每条从节点 $u_e$ 指向节点 $v_e$ 的边 $e$，矩阵元素为 $B_{e, u_e} = +1$，$B_{e, v_e} = -1$，其他情况为零。这种表示方法使得所有边上的压降可以紧凑地写成向量 $\\Delta p = B p$，其中 $p \\in \\mathbb{R}^N$ 是所有节点压力的向量。\n\n- **导纳矩阵（$K$）**：气道的几何特性体现在一个对角导纳矩阵 $K \\in \\mathbb{R}^{E \\times E}$ 中，其中每个对角元素 $K_{e,e} = 1/R_e$ 是边 $e$ 的导纳。\n\n- **流量向量（$Q$）**：使用这些矩阵，通过所有边的流量向量 $Q \\in \\mathbb{R}^E$ 由哈根-泊肃叶定律的矩阵形式给出：\n$$\nQ = K (B p)\n$$\n\n- **系统组装**：每个节点的质量守恒表示为 $B^\\top Q = 0$（对于内部节点，即没有外部流量供给或移除的节点）。代入 $Q$ 的表达式可得：\n$$\nB^\\top K B p = L p = 0\n$$\n矩阵 $L = B^\\top K B$ 是加权图拉普拉斯矩阵，它描述了整个网络的连通性和导纳。\n\n**3. 求解节点压力**\n\n所有节点的集合被划分为一个压力未知的节点集 $U$（内部节点 $1$ 到 $6$）和一个压力已知、给定的节点集 $K$（口腔，即节点 $0$，以及肺泡叶节点，即节点 $7$ 到 $14$）。压力向量 $p$ 和拉普拉斯矩阵 $L$ 也相应地进行分块：\n$$\np = \\begin{pmatrix} p_U \\\\ p_K \\end{pmatrix}, \\quad L = \\begin{pmatrix} L_{UU}  L_{UK} \\\\ L_{KU}  L_{KK} \\end{pmatrix}\n$$\n守恒定律适用于内部节点 $U$，因此我们考虑分块矩阵方程 $Lp=J$ 的顶部块，其中 $J$ 是外部流量向量。对于内部节点，外部流量为零（$J_U = 0$）。这得到：\n$$\nL_{UU} p_U + L_{UK} p_K = 0\n$$\n由于压力 $p_K$ 是已知的边界条件（$p_0 = p_{\\mathrm{in}}$ 和 $p_{7..14} = 0$），我们可以求解未知的内部压力 $p_U$：\n$$\nL_{UU} p_U = -L_{UK} p_K\n$$\n矩阵 $L_{UU}$ 是一个对称正定矩阵，因此是可逆的，从而保证了 $p_U$ 的唯一解。这个线性系统将进行数值求解。\n\n**4. 通气分布与敏感度的计算**\n\n一旦计算出未知压力 $p_U$，完整的压力向量 $p$ 就是已知的。算法按以下步骤进行：\n\n1.  **计算边流量**：使用 $Q = K(Bp)$ 计算每条边中的流量 $Q_e$。\n2.  **确定肺泡流量**：流入肺泡叶节点 $i \\in \\{7, \\dots, 14\\}$ 的流量是末端边（$e_6$ 到 $e_{13}$）中的流量，记为 $q_i$。\n3.  **计算分数通气**：进入系统的总流量 $Q_{\\mathrm{tot}}$ 是所有肺泡流量的总和，$Q_{\\mathrm{tot}} = \\sum_{i=7}^{14} q_i$。根据线性关系，这个总和也等于口腔处的总流入量。每个肺泡单元的分数通气是其接收到的总流量的比例：\n    $$\n    f_i = \\frac{q_i}{Q_{\\mathrm{tot}}}\n    $$\n    值得注意的是，由于所有流量都与驱动压力 $p_{\\mathrm{in}}$ 线性成正比，因此分数通气 $f_i$ 与 $p_{\\mathrm{in}}$ 无关。\n4.  **执行敏感度分析**：整个计算过程执行两次：一次针对基线配置，一次针对收缩配置。在收缩配置中，指定边 $j$ 的半径减小为 $r_j' = 0.7 r_j$。这个变化只影响导纳矩阵 $K$ 的第 $j$ 个对角元素。设基线和收缩配置下的分数通气分别为 $f_i$ 和 $f_i'$。\n5.  **计算敏感度指标（$S$）**：对收缩的敏感度被量化为在所有肺泡分数通气中观察到的最大绝对变化：\n    $$\n    S = \\max_{i \\in \\{7, \\dots, 14\\}} |f_i' - f_i|\n    $$\n\n这个过程被系统地应用于问题陈述中定义的每个测试案例。实现将使用 `numpy` 进行高效的矩阵和向量操作，并使用 `numpy.linalg.solve` 进行核心线性系统的求解。每个案例都将被独立求解，以获得敏感度值列表 $[S_1, S_2, S_3, S_4]$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the sensitivity of alveolar ventilation distribution to localized\n    airway constrictions in a resistive network model of the lungs.\n    \"\"\"\n\n    # --- Define constants and base network structure ---\n    MU = 1.9e-5  # Dynamic viscosity of air in Pa.s\n    NUM_NODES = 15\n    NUM_EDGES = 14\n\n    # Edges are defined by (upstream_node, downstream_node)\n    edges = np.array([\n        [0, 1], [0, 2],  # Generation 1\n        [1, 3], [1, 4], [2, 5], [2, 6],  # Generation 2\n        [3, 7], [3, 8], [4, 9], [4, 10],  # Generation 3 (left subtree)\n        [5, 11], [5, 12], [6, 13], [6, 14]  # Generation 3 (right subtree)\n    ])\n\n    # Baseline geometric properties of the edges (airways)\n    L_base = np.array(\n        [0.06] * 2 +    # Gen 1 lengths\n        [0.03] * 4 +    # Gen 2 lengths\n        [0.02] * 8      # Gen 3 lengths\n    )\n    r_base = np.array(\n        [0.006] * 2 +   # Gen 1 radii\n        [0.0035] * 4 +  # Gen 2 radii\n        [0.0020] * 8    # Gen 3 radii\n    )\n\n    # Node partitioning\n    unknown_nodes = list(range(1, 7))\n    known_nodes = [0] + list(range(7, 15))\n\n    # --- Helper function to compute fractional ventilation ---\n    def calculate_fractional_ventilation(p_in, radii):\n        \"\"\"\n        Solves the network for given parameters and returns fractional ventilations.\n        \"\"\"\n        # 1. Calculate resistances and conductances\n        resistances = (8 * MU * L_base) / (np.pi * radii**4)\n        K_diag = 1.0 / resistances\n        \n        # 2. Construct incidence matrix B\n        B = np.zeros((NUM_EDGES, NUM_NODES))\n        for i, (u, v) in enumerate(edges):\n            B[i, u] = 1\n            B[i, v] = -1\n\n        # 3. Construct the weighted graph Laplacian L = B^T * K * B\n        K = np.diag(K_diag)\n        L = B.T @ K @ B\n\n        # 4. Partition matrices for the linear system L_UU * p_U = -L_UK * p_K\n        L_UU = L[np.ix_(unknown_nodes, unknown_nodes)]\n        L_UK = L[np.ix_(unknown_nodes, known_nodes)]\n        \n        p_K = np.zeros(len(known_nodes))\n        # The first element of known_nodes is node 0 (mouth)\n        p_K[0] = p_in\n\n        # 5. Solve for unknown node pressures p_U\n        rhs = -L_UK @ p_K\n        p_U = np.linalg.solve(L_UU, rhs)\n\n        # 6. Reconstruct full pressure vector and calculate flows\n        p = np.zeros(NUM_NODES)\n        p[unknown_nodes] = p_U\n        p[known_nodes] = p_K\n        \n        # Edge flows Q = K * (B * p)\n        Q = K_diag * (B @ p)\n\n        # 7. Calculate fractional ventilation\n        terminal_flow_indices = range(6, 14) # Edges e6 to e13\n        alveolar_flows = Q[terminal_flow_indices]\n        \n        total_flow = np.sum(alveolar_flows)\n        # Avoid division by zero if there's no flow, though not expected here\n        if total_flow == 0:\n            return np.zeros_like(alveolar_flows)\n\n        fractional_ventilation = alveolar_flows / total_flow\n        return fractional_ventilation\n\n    # --- Define and process test cases ---\n    test_cases = [\n        # Case 1: p_in=200 Pa, symmetric, constrict e3\n        {'p_in': 200.0, 'constricted_idx': 3, 'radius_mods': {}},\n        # Case 2: p_in=200 Pa, symmetric, constrict e0\n        {'p_in': 200.0, 'constricted_idx': 0, 'radius_mods': {}},\n        # Case 3: p_in=200 Pa, heterogeneous, constrict e11\n        {'p_in': 200.0, 'constricted_idx': 11, 'radius_mods': \n            {idx: 0.85 for idx in [4, 5, 10, 11, 12, 13]}},\n        # Case 4: p_in=50 Pa, symmetric, constrict e12\n        {'p_in': 50.0, 'constricted_idx': 12, 'radius_mods': {}},\n    ]\n\n    results = []\n    for case in test_cases:\n        p_in = case['p_in']\n        constricted_idx = case['constricted_idx']\n        \n        # --- Baseline Calculation ---\n        r_baseline_case = r_base.copy()\n        if case['radius_mods']:\n            for idx, factor in case['radius_mods'].items():\n                r_baseline_case[idx] *= factor\n        \n        f_baseline = calculate_fractional_ventilation(p_in, r_baseline_case)\n\n        # --- Constricted Calculation ---\n        r_constricted = r_baseline_case.copy()\n        r_constricted[constricted_idx] *= 0.7\n        \n        f_constricted = calculate_fractional_ventilation(p_in, r_constricted)\n        \n        # --- Sensitivity Calculation ---\n        sensitivity = np.max(np.abs(f_constricted - f_baseline))\n        results.append(sensitivity)\n\n    # Final print statement in the exact required format\n    formatted_results = [f\"{round(s, 6):.6f}\" for s in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}