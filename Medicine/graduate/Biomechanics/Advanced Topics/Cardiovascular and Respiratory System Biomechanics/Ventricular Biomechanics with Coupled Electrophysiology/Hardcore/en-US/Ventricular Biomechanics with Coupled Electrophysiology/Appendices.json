{
    "hands_on_practices": [
        {
            "introduction": "The propagation of the electrical action potential is the initial event that orchestrates the heart's coordinated contraction. This process is commonly modeled using reaction-diffusion equations, with the monodomain or bidomain models being the most prevalent. A key feature of the myocardium is its fibrous structure, which causes the electrical signal to travel much faster along the muscle fibers than across them, a property known as anisotropy.\n\nThis first practice focuses on the computational implementation of this anisotropic diffusion, which forms the spatial component of the full electrophysiology model . By deriving the element stiffness matrix for the monodomain equation, you will gain hands-on experience in how the physics of anisotropic conductivity, represented by the tensor $\\mathbf{D}$, is translated into the numerical language of the finite element method. This is a foundational skill for building and understanding simulations of cardiac electrical activity.",
            "id": "4210032",
            "problem": "A two-dimensional ventricular slice is modeled using the monodomain partial differential equation (PDE) for the transmembrane potential $V$, written in the spatial (current) configuration and neglecting capacitive and reaction terms for the purpose of focusing on the diffusion operator. The conservation of charge combined with a generalized Ohm’s law for anisotropic conduction yields the diffusion term $-\\nabla \\cdot (\\mathbf{D} \\nabla V)$, where the conductivity tensor $\\mathbf{D}$ is aligned with the local myofiber direction $\\mathbf{f}$, assumed to be a unit vector. The myocardium is electromechanically coupled, but at the instant of interest the deformation is negligible so that the fiber direction is unchanged and constant over the element. The anisotropic conductivity tensor is assumed of the standard transversely isotropic form\n$$\n\\mathbf{D} = g_{t} \\mathbf{I} + \\bigl(g_{l} - g_{t}\\bigr) \\, \\mathbf{f} \\mathbf{f}^{\\mathsf{T}},\n$$\nwhere $g_{l}$ and $g_{t}$ are the longitudinal and transverse conductivities, respectively, and $\\mathbf{I}$ is the identity tensor.\n\nUsing the Galerkin finite element method (FEM) with linear shape functions on a single three-node triangular element $\\Omega_{e}$, derive from first principles the symmetric element stiffness matrix $\\mathbf{K}_{e}$ associated with the diffusion operator. Then, for the specific element with nodal coordinates $\\bigl(x_{1},y_{1}\\bigr) = (0,0)$, $\\bigl(x_{2},y_{2}\\bigr) = (1,0)$, and $\\bigl(x_{3},y_{3}\\bigr) = (0,1)$ (all coordinates in $\\text{mm}$), take the conductivity parameters $g_{l} = 0.6\\,\\text{S}/\\text{m}$ and $g_{t} = 0.06\\,\\text{S}/\\text{m}$, and a constant in-plane fiber direction $\\mathbf{f} = \\bigl(\\cos \\theta, \\sin \\theta\\bigr)$ with $\\theta = 30$ degrees. Assume that $\\mathbf{D}$ is constant over $\\Omega_{e}$.\n\nCompute the $(1,1)$ entry of the element stiffness matrix $\\mathbf{K}_{e}$, denoted $K_{11}$, for this element. Express your final numerical answer in $\\text{S}/\\text{mm}$ and round to six significant figures. State all steps used to obtain $\\mathbf{K}_{e}$ from the governing diffusion operator, including the construction of $\\mathbf{D}$ from $\\mathbf{f}$ and the gradients of the shape functions over $\\Omega_{e}$. Angles must be treated in degrees as given.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard problem in the computational modeling of cardiac electrophysiology using the Finite Element Method (FEM). All necessary data and conditions are provided, and there are no internal contradictions or violations of physical principles. Thus, the problem is valid, and a solution can be constructed.\n\nThe starting point for the derivation of the element stiffness matrix is the weak formulation of the governing diffusion equation. The strong form of the steady-state diffusion problem over an element domain $\\Omega_e$ is given by the operator $-\\nabla \\cdot (\\mathbf{D} \\nabla V) = 0$. To derive the weak form, we multiply by an arbitrary test function $w$ and integrate over $\\Omega_e$:\n$$\n-\\int_{\\Omega_e} w \\, \\nabla \\cdot (\\mathbf{D} \\nabla V) \\, d\\Omega = 0\n$$\nApplying the divergence theorem (or Green's first identity) allows us to move the spatial derivative from the primary variable $V$ to the test function $w$:\n$$\n\\int_{\\Omega_e} (\\nabla w)^{\\mathsf{T}} \\mathbf{D} (\\nabla V) \\, d\\Omega - \\int_{\\partial\\Omega_e} w (\\mathbf{D} \\nabla V) \\cdot \\mathbf{n} \\, d\\Gamma = 0\n$$\nHere, $\\partial\\Omega_e$ is the boundary of the element and $\\mathbf{n}$ is the outward unit normal vector. The stiffness matrix arises from the domain integral. Within the Galerkin FEM framework, the potential field $V$ is approximated within the element as a linear combination of nodal values $V_j$ and basis functions, known as shape functions $N_j(x,y)$:\n$$\nV(x,y) \\approx V_h(x,y) = \\sum_{j=1}^{3} N_j(x,y) V_j\n$$\nThe test functions $w$ are chosen from the same set of functions as the basis functions, i.e., $w = N_i$ for $i=1, 2, 3$. Substituting the approximation for $V$ and setting $w = N_i$ into the domain integral part of the weak form yields a system of linear algebraic equations:\n$$\n\\sum_{j=1}^{3} \\left( \\int_{\\Omega_e} (\\nabla N_i)^{\\mathsf{T}} \\mathbf{D} (\\nabla N_j) \\, d\\Omega \\right) V_j = \\text{boundary terms}\n$$\nThe element stiffness matrix $\\mathbf{K}_e$ is defined by its components $K_{ij}$:\n$$\nK_{ij} = \\int_{\\Omega_e} (\\nabla N_i)^{\\mathsf{T}} \\mathbf{D} (\\nabla N_j) \\, d\\Omega\n$$\nFor a linear triangular element, the shape functions $N_j$ are linear in the spatial coordinates, which implies their gradients $\\nabla N_j$ are constant over the element. The problem states that the conductivity tensor $\\mathbf{D}$ is also constant over the element. Therefore, the integrand is constant and can be moved outside the integral:\n$$\nK_{ij} = (\\nabla N_i)^{\\mathsf{T}} \\mathbf{D} (\\nabla N_j) \\int_{\\Omega_e} d\\Omega = A_e (\\nabla N_i)^{\\mathsf{T}} \\mathbf{D} (\\nabla N_j)\n$$\nwhere $A_e$ is the area of the element. This can be written in matrix form as $\\mathbf{K}_e = A_e \\mathbf{B}^{\\mathsf{T}} \\mathbf{D} \\mathbf{B}$, where the matrix $\\mathbf{B}$ contains the gradients of the shape functions as its columns: $\\mathbf{B} = \\begin{pmatrix} \\nabla N_1  \\nabla N_2  \\nabla N_3 \\end{pmatrix}$.\n\nWe now compute the specific quantities for the given element.\nFirst, we address the units. The nodal coordinates are in $\\text{mm}$, while the conductivities are in $\\text{S}/\\text{m}$. To maintain consistency, we convert the conductivities to $\\text{S}/\\text{mm}$:\n$$\ng_l = 0.6 \\, \\frac{\\text{S}}{\\text{m}} = 0.6 \\, \\frac{\\text{S}}{1000 \\, \\text{mm}} = 0.0006 \\, \\frac{\\text{S}}{\\text{mm}}\n$$\n$$\ng_t = 0.06 \\, \\frac{\\text{S}}{\\text{m}} = 0.06 \\, \\frac{\\text{S}}{1000 \\, \\text{mm}} = 0.00006 \\, \\frac{\\text{S}}{\\text{mm}}\n$$\nThe element nodes are $(x_1, y_1) = (0, 0)$, $(x_2, y_2) = (1, 0)$, and $(x_3, y_3) = (0, 1)$. This is a right-angled triangle with base $1 \\, \\text{mm}$ and height $1 \\, \\text{mm}$. The area $A_e$ is:\n$$\nA_e = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} (1 \\, \\text{mm})(1 \\, \\text{mm}) = 0.5 \\, \\text{mm}^2\n$$\nFor a linear triangular element, the gradient of a shape function $N_i$ is given by $\\nabla N_i = \\frac{1}{2A_e} \\begin{pmatrix} y_{j}-y_{k} \\\\ x_{k}-x_{j} \\end{pmatrix}$, where $(i,j,k)$ is a cyclic permutation of $(1,2,3)$. We need $\\nabla N_1$:\n$$\n\\nabla N_1 = \\frac{1}{2 A_e} \\begin{pmatrix} y_2 - y_3 \\\\ x_3 - x_2 \\end{pmatrix} = \\frac{1}{2(0.5)} \\begin{pmatrix} 0 - 1 \\\\ 0 - 1 \\end{pmatrix} = \\frac{1}{1} \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} \\, \\text{mm}^{-1}\n$$\nNext, we construct the conductivity tensor $\\mathbf{D}$. The fiber direction vector $\\mathbf{f}$ for $\\theta = 30^\\circ$ is:\n$$\n\\mathbf{f} = \\begin{pmatrix} \\cos(30^\\circ) \\\\ \\sin(30^\\circ) \\end{pmatrix} = \\begin{pmatrix} \\frac{\\sqrt{3}}{2} \\\\ \\frac{1}{2} \\end{pmatrix}\n$$\nThe dyadic product $\\mathbf{f} \\mathbf{f}^{\\mathsf{T}}$ is:\n$$\n\\mathbf{f} \\mathbf{f}^{\\mathsf{T}} = \\begin{pmatrix} \\frac{\\sqrt{3}}{2} \\\\ \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} \\frac{\\sqrt{3}}{2}  \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{4}  \\frac{\\sqrt{3}}{4} \\\\ \\frac{\\sqrt{3}}{4}  \\frac{1}{4} \\end{pmatrix}\n$$\nThe conductivity tensor is $\\mathbf{D} = g_{t} \\mathbf{I} + \\bigl(g_{l} - g_{t}\\bigr) \\, \\mathbf{f} \\mathbf{f}^{\\mathsf{T}}$. The difference in conductivities is $g_{l} - g_{t} = 0.0006 - 0.00006 = 0.00054 \\, \\text{S}/\\text{mm}$.\n$$\n\\mathbf{D} = 0.00006 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + 0.00054 \\begin{pmatrix} \\frac{3}{4}  \\frac{\\sqrt{3}}{4} \\\\ \\frac{\\sqrt{3}}{4}  \\frac{1}{4} \\end{pmatrix}\n$$\n$$\n\\mathbf{D} = \\begin{pmatrix} 0.00006  0 \\\\ 0  0.00006 \\end{pmatrix} + \\begin{pmatrix} 0.000405  0.000135\\sqrt{3} \\\\ 0.000135\\sqrt{3}  0.000135 \\end{pmatrix}\n$$\n$$\n\\mathbf{D} = \\begin{pmatrix} 0.000465  0.000135\\sqrt{3} \\\\ 0.000135\\sqrt{3}  0.000195 \\end{pmatrix} \\, \\frac{\\text{S}}{\\text{mm}}\n$$\nWe can now compute the $(1,1)$ entry of the stiffness matrix, $K_{11}$:\n$$\nK_{11} = A_e (\\nabla N_1)^{\\mathsf{T}} \\mathbf{D} (\\nabla N_1)\n$$\n$$\nK_{11} = 0.5 \\begin{pmatrix} -1  -1 \\end{pmatrix} \\begin{pmatrix} 0.000465  0.000135\\sqrt{3} \\\\ 0.000135\\sqrt{3}  0.000195 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}\n$$\nThe quadratic form $(\\nabla N_1)^{\\mathsf{T}} \\mathbf{D} (\\nabla N_1)$ expands to $D_{11} + D_{22} + 2D_{12}$:\n$$\nK_{11} = 0.5 \\left( 0.000465 + 0.000195 + 2(0.000135\\sqrt{3}) \\right)\n$$\n$$\nK_{11} = 0.5 \\left( 0.00066 + 0.00027\\sqrt{3} \\right)\n$$\n$$\nK_{11} = 0.00033 + 0.000135\\sqrt{3}\n$$\nWe compute the numerical value:\n$$\nK_{11} \\approx 0.00033 + 0.000135 \\times 1.7320508075...\n$$\n$$\nK_{11} \\approx 0.00033 + 0.000233826859...\n$$\n$$\nK_{11} \\approx 0.000563826859... \\, \\frac{\\text{S}}{\\text{mm}}\n$$\nRounding this to six significant figures gives $0.000563827$.",
            "answer": "$$\n\\boxed{0.000563827}\n$$"
        },
        {
            "introduction": "Once an electrical signal has activated a myocardial cell, it initiates a complex cascade leading to force generation and contraction. To model this mechanical behavior, we must describe both the underlying passive stiffness of the tissue and the active force produced by the contractile machinery. This is achieved through constitutive models that define the material's stress-strain relationship.\n\nThis exercise  provides a practical application of these principles by asking you to compute the total stress in a piece of activated myocardium. You will work with a widely used type of hyperelastic strain-energy function, $\\Psi$, to capture the nonlinear passive mechanics, and combine it with an additive active stress term, $\\boldsymbol{\\sigma}^{\\text{act}}$, that represents contraction. This problem will solidify your understanding of how to apply continuum mechanics to calculate the stress state in an incompressible, anisotropic, and active biological material.",
            "id": "4209991",
            "problem": "Consider a simplified electromechanical model of ventricular myocardium treated as an incompressible, transversely isotropic hyperelastic material with a single dominant fiber family. The strain-energy density per unit reference volume is postulated as\n$$\n\\Psi(I_{1},I_{4f}) \\;=\\; \\frac{a}{2b}\\left(\\exp\\!\\big(b\\,(I_{1}-3)\\big)-1\\right) \\;+\\; \\frac{a_{f}}{2b_{f}}\\left(\\exp\\!\\big(b_{f}\\,(I_{4f}-1)^{2}\\big)-1\\right),\n$$\nwhere $I_{1}=\\operatorname{tr}(\\mathbf{C})$ is the first invariant of the right Cauchy–Green tensor $\\mathbf{C}$, and $I_{4f}=\\mathbf{f}_{0}\\cdot\\mathbf{C}\\,\\mathbf{f}_{0}$ is the fiber invariant associated with the reference fiber direction $\\mathbf{f}_{0}$. Assume fibers are aligned with the $x_{1}$ direction in the reference configuration, i.e., $\\mathbf{f}_{0}=\\mathbf{e}_{1}$.\n\nElectrophysiological activation is incorporated via an additive active Cauchy stress in the current fiber direction $\\mathbf{f}$ of the form\n$$\n\\boldsymbol{\\sigma}^{\\text{act}} \\;=\\; T_{a}(V)\\,\\mathbf{f}\\otimes\\mathbf{f},\\quad T_{a}(V) \\;=\\; T_{\\max}\\,A(V),\\quad A(V)\\;=\\;\\frac{1}{1+\\exp\\!\\left(-\\frac{V - V_{0}}{k_{V}}\\right)},\n$$\nwhere $V$ is the transmembrane potential, $T_{\\max}$ is the peak active stress, $V_{0}$ is an activation midpoint, and $k_{V}$ is a slope parameter. The current fiber direction $\\mathbf{f}$ is the push-forward of $\\mathbf{f}_{0}$ and aligns with the $x_{1}$ axis under the loading considered.\n\nThe specimen is subjected to incompressible uniaxial extension along the fiber direction with fiber stretch $\\lambda_{f}=\\lambda1$, traction-free lateral surfaces, and no body forces. Under this state, incompressibility implies the lateral stretches satisfy $\\lambda_{2}=\\lambda_{3}=\\lambda^{-1/2}$, and the invariants reduce to $I_{1}=\\lambda^{2}+2\\lambda^{-1}$ and $I_{4f}=\\lambda^{2}$.\n\nUsing standard continuum mechanics for incompressible hyperelastic materials and the above activation model, compute the fiber-direction Cauchy stress component $\\sigma_{11}$ that results from the sum of passive matrix, passive fiber, and active fiber contributions. Take the parameter values\n$$\na=0.5\\ \\text{kPa},\\quad b=8,\\quad a_{f}=5.0\\ \\text{kPa},\\quad b_{f}=15,\\quad \\lambda=1.1,\n$$\nand for the activation,\n$$\nT_{\\max}=60\\ \\text{kPa},\\quad V=0\\ \\text{mV},\\quad V_{0}=-30\\ \\text{mV},\\quad k_{V}=10\\ \\text{mV}.\n$$\nAssume the lateral Cauchy stresses vanish and determine the Lagrange multiplier accordingly. Express the final answer for $\\sigma_{11}$ in kilopascals (kPa). Round your result to four significant figures. Briefly interpret how the model’s exponential terms embody mechanical nonlinearity in the fiber response under the given extension and activation.",
            "solution": "The problem requires the computation of the fiber-direction Cauchy stress component, $\\sigma_{11}$, in a simplified electromechanical model of ventricular myocardium. The total Cauchy stress, $\\boldsymbol{\\sigma}$, is the sum of the passive stress, $\\boldsymbol{\\sigma}^{\\text{pas}}$, derived from the strain-energy function, and the active stress, $\\boldsymbol{\\sigma}^{\\text{act}}$, which is prescribed.\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\text{pas}} + \\boldsymbol{\\sigma}^{\\text{act}}\n$$\nThe material is modeled as incompressible and hyperelastic. For an incompressible material, the passive Cauchy stress is given by\n$$\n\\boldsymbol{\\sigma}^{\\text{pas}} = -p\\mathbf{I} + 2\\mathbf{F} \\frac{\\partial \\Psi}{\\partial \\mathbf{C}} \\mathbf{F}^T\n$$\nwhere $p$ is the hydrostatic pressure (a Lagrange multiplier enforcing the incompressibility constraint $\\det(\\mathbf{F})=1$), $\\mathbf{I}$ is the second-order identity tensor, $\\mathbf{F}$ is the deformation gradient, and $\\mathbf{C}=\\mathbf{F}^T\\mathbf{F}$ is the right Cauchy-Green tensor. The strain-energy function $\\Psi$ is given as\n$$\n\\Psi(I_{1},I_{4f}) = \\Psi_{\\text{iso}}(I_1) + \\Psi_{\\text{aniso}}(I_{4f})\n$$\nwhere the isotropic (matrix) part is $\\Psi_{\\text{iso}}(I_1) = \\frac{a}{2b}(\\exp(b(I_{1}-3))-1)$ and the anisotropic (fiber) part is $\\Psi_{\\text{aniso}}(I_{4f}) = \\frac{a_{f}}{2b_{f}}(\\exp(b_{f}(I_{4f}-1)^{2})-1)$.\n\nFirst, we compute the derivative of $\\Psi$ with respect to $\\mathbf{C}$ using the chain rule:\n$$\n\\frac{\\partial \\Psi}{\\partial \\mathbf{C}} = \\frac{\\partial \\Psi}{\\partial I_1} \\frac{\\partial I_1}{\\partial \\mathbf{C}} + \\frac{\\partial \\Psi}{\\partial I_{4f}} \\frac{\\partial I_{4f}}{\\partial \\mathbf{C}}\n$$\nThe derivatives of the invariants are $\\frac{\\partial I_1}{\\partial \\mathbf{C}} = \\mathbf{I}$ and $\\frac{\\partial I_{4f}}{\\partial \\mathbf{C}} = \\mathbf{f}_0 \\otimes \\mathbf{f}_0$. The derivatives of the strain-energy function with respect to the invariants are:\n$$\n\\frac{\\partial \\Psi}{\\partial I_1} = \\frac{\\partial \\Psi_{\\text{iso}}}{\\partial I_1} = \\frac{a}{2b} \\cdot b \\exp(b(I_1-3)) = \\frac{a}{2} \\exp(b(I_1-3))\n$$\n$$\n\\frac{\\partial \\Psi}{\\partial I_{4f}} = \\frac{\\partial \\Psi_{\\text{aniso}}}{\\partial I_{4f}} = \\frac{a_f}{2b_f} \\cdot b_f \\cdot 2(I_{4f}-1) \\exp(b_f(I_{4f}-1)^2) = a_f (I_{4f}-1) \\exp(b_f(I_{4f}-1)^2)\n$$\nSubstituting these into the stress equation, and using the relations $\\mathbf{F}\\mathbf{I}\\mathbf{F}^T = \\mathbf{B}$ (left Cauchy-Green tensor) and $\\mathbf{F}(\\mathbf{f}_0 \\otimes \\mathbf{f}_0)\\mathbf{F}^T = (\\mathbf{F}\\mathbf{f}_0) \\otimes (\\mathbf{F}\\mathbf{f}_0)$, we get:\n$$\n\\boldsymbol{\\sigma}^{\\text{pas}} = -p\\mathbf{I} + 2 \\frac{\\partial \\Psi}{\\partial I_1} \\mathbf{B} + 2 \\frac{\\partial \\Psi}{\\partial I_{4f}} (\\mathbf{F}\\mathbf{f}_0 \\otimes \\mathbf{F}\\mathbf{f}_0)\n$$\nThe vector $\\mathbf{F}\\mathbf{f}_0$ is the fiber vector in the deformed configuration. Its squared length is $I_{4f}$. The unit vector in the current fiber direction is $\\mathbf{f} = (\\mathbf{F}\\mathbf{f}_0)/\\sqrt{I_{4f}}$. Thus, $(\\mathbf{F}\\mathbf{f}_0 \\otimes \\mathbf{F}\\mathbf{f}_0) = I_{4f} (\\mathbf{f} \\otimes \\mathbf{f})$.\n$$\n\\boldsymbol{\\sigma}^{\\text{pas}} = -p\\mathbf{I} + 2 \\frac{\\partial \\Psi}{\\partial I_1} \\mathbf{B} + 2 I_{4f} \\frac{\\partial \\Psi}{\\partial I_{4f}} (\\mathbf{f} \\otimes \\mathbf{f})\n$$\nThe problem specifies incompressible uniaxial extension along the fiber direction $\\mathbf{f}_0 = \\mathbf{e}_1$. The deformation gradient tensor $\\mathbf{F}$ and the left Cauchy-Green tensor $\\mathbf{B}=\\mathbf{F}\\mathbf{F}^T$ are diagonal:\n$$\n\\mathbf{F} = \\text{diag}(\\lambda, \\lambda^{-1/2}, \\lambda^{-1/2}) \\quad \\implies \\quad \\mathbf{B} = \\text{diag}(\\lambda^2, \\lambda^{-1}, \\lambda^{-1})\n$$\nThe current fiber direction is $\\mathbf{f}=\\mathbf{e}_1$, so $\\mathbf{f}\\otimes\\mathbf{f} = \\text{diag}(1, 0, 0)$. The invariants are $I_1 = \\lambda^2 + 2\\lambda^{-1}$ and $I_{4f} = \\lambda^2$.\n\nThe components of the passive Cauchy stress are:\n$$\n\\sigma^{\\text{pas}}_{11} = -p + 2\\lambda^2 \\frac{\\partial \\Psi}{\\partial I_1} + 2\\lambda^2 \\frac{\\partial \\Psi}{\\partial I_{4f}}\n$$\n$$\n\\sigma^{\\text{pas}}_{22} = \\sigma^{\\text{pas}}_{33} = -p + 2\\lambda^{-1} \\frac{\\partial \\Psi}{\\partial I_1}\n$$\nThe total stress has contributions from the active stress $\\boldsymbol{\\sigma}^{\\text{act}} = T_a (\\mathbf{f} \\otimes \\mathbf{f}) = T_a \\text{diag}(1,0,0)$.\n$$\n\\sigma_{11} = \\sigma^{\\text{pas}}_{11} + T_a \\quad \\text{and} \\quad \\sigma_{22} = \\sigma^{\\text{pas}}_{22}, \\quad \\sigma_{33} = \\sigma^{\\text{pas}}_{33}\n$$\nThe problem states that lateral stresses vanish, $\\sigma_{22} = \\sigma_{33} = 0$. Using this condition, we determine the Lagrange multiplier $p$:\n$$\n0 = -p + 2\\lambda^{-1} \\frac{\\partial \\Psi}{\\partial I_1} \\quad \\implies \\quad p = 2\\lambda^{-1} \\frac{\\partial \\Psi}{\\partial I_1}\n$$\nNote that $\\frac{\\partial\\Psi}{\\partial I_{4f}}$ does not appear here because the fibers are only aligned in the $x_1$ direction. Substituting $p$ into the expression for $\\sigma_{11}$:\n$$\n\\sigma_{11} = \\left(-2\\lambda^{-1} \\frac{\\partial \\Psi}{\\partial I_1}\\right) + 2\\lambda^2 \\frac{\\partial \\Psi}{\\partial I_1} + 2\\lambda^2 \\frac{\\partial \\Psi}{\\partial I_{4f}} + T_a\n$$\n$$\n\\sigma_{11} = 2(\\lambda^2 - \\lambda^{-1}) \\frac{\\partial \\Psi}{\\partial I_1} + 2\\lambda^2 \\frac{\\partial \\Psi}{\\partial I_{4f}} + T_a\n$$\nThis expression separates the total fiber-direction stress into three components: passive matrix, passive fiber, and active fiber contributions.\n$$\n\\sigma_{11} = \\underbrace{a(\\lambda^2 - \\lambda^{-1}) \\exp(b(I_1 - 3))}_{\\sigma^{\\text{pas, matrix}}_{11}} + \\underbrace{2\\lambda^2 a_f (I_{4f}-1) \\exp(b_f(I_{4f}-1)^2)}_{\\sigma^{\\text{pas, fiber}}_{11}} + \\underbrace{T_{\\max} A(V)}_{\\sigma^{\\text{act}}_{11}}\n$$\nNow, we substitute the given parameter values:\n$a=0.5\\ \\text{kPa}, b=8, a_{f}=5.0\\ \\text{kPa}, b_{f}=15, \\lambda=1.1$.\n$T_{\\max}=60\\ \\text{kPa}, V=0\\ \\text{mV}, V_{0}=-30\\ \\text{mV}, k_{V}=10\\ \\text{mV}$.\n\nFirst, calculate the invariants:\n$I_1 = \\lambda^2 + 2\\lambda^{-1} = (1.1)^2 + 2(1.1)^{-1} = 1.21 + \\frac{2}{1.1} \\approx 1.21 + 1.81818 = 3.02818$\n$I_{4f} = \\lambda^2 = (1.1)^2 = 1.21$\n\nNext, calculate the three stress components:\n1.  Passive matrix contribution:\n    $$\n    \\sigma^{\\text{pas, matrix}}_{11} = 0.5 \\left( (1.1)^2 - \\frac{1}{1.1} \\right) \\exp\\left(8 \\left( (1.1)^2 + \\frac{2}{1.1} - 3 \\right)\\right)\n    $$\n    $$\n    \\sigma^{\\text{pas, matrix}}_{11} \\approx 0.5 (1.21 - 0.90909) \\exp(8(3.02818 - 3)) = 0.5(0.30091) \\exp(8(0.02818))\n    $$\n    $$\n    \\sigma^{\\text{pas, matrix}}_{11} \\approx 0.150455 \\exp(0.22544) \\approx 0.150455(1.25287) \\approx 0.18851\\ \\text{kPa}\n    $$\n2.  Passive fiber contribution:\n    $$\n    \\sigma^{\\text{pas, fiber}}_{11} = 2(1.1)^2 (5.0) ((1.1)^2-1) \\exp\\left(15((1.1)^2-1)^2\\right)\n    $$\n    $$\n    \\sigma^{\\text{pas, fiber}}_{11} = 2(1.21)(5.0)(1.21-1) \\exp(15(1.21-1)^2) = 12.1(0.21) \\exp(15(0.21)^2)\n    $$\n    $$\n    \\sigma^{\\text{pas, fiber}}_{11} = 2.541 \\exp(15(0.0441)) = 2.541 \\exp(0.6615) \\approx 2.541(1.93774) \\approx 4.92370\\ \\text{kPa}\n    $$\n3.  Active fiber contribution:\n    The activation level $A(V)$ is:\n    $$\n    A(V) = \\frac{1}{1+\\exp\\left(-\\frac{V - V_{0}}{k_{V}}\\right)} = \\frac{1}{1+\\exp\\left(-\\frac{0 - (-30)}{10}\\right)} = \\frac{1}{1+\\exp(-3)}\n    $$\n    $$\n    A(V) \\approx \\frac{1}{1+0.049787} \\approx 0.952574\n    $$\n    The active stress is:\n    $$\n    \\sigma^{\\text{act}}_{11} = T_a = T_{\\max} A(V) \\approx 60 \\times 0.952574 \\approx 57.15444\\ \\text{kPa}\n    $$\nFinally, summing the three components for the total stress $\\sigma_{11}$:\n$$\n\\sigma_{11} = \\sigma^{\\text{pas, matrix}}_{11} + \\sigma^{\\text{pas, fiber}}_{11} + \\sigma^{\\text{act}}_{11}\n$$\n$$\n\\sigma_{11} \\approx 0.18851 + 4.92370 + 57.15444 \\approx 62.26665\\ \\text{kPa}\n$$\nRounding to four significant figures, the result is $62.27\\ \\text{kPa}$.\n\nInterpretation of nonlinearity:\nThe exponential terms in the constitutive model are fundamental to capturing the nonlinear mechanical behavior of the tissue.\nThe term $\\exp(b(I_{1}-3))$ in the matrix response and more significantly the term $\\exp(b_{f}(I_{4f}-1)^{2})$ in the fiber response cause a 'stiffening' effect. At small strains (i.e., when $I_1 \\approx 3$ and $I_{4f} \\approx 1$), the exponentials are close to $1$, their arguments are close to $0$, and the stress increases slowly with strain. As the stretch $\\lambda$ increases, the invariants $I_1$ and particularly $I_{4f}$ grow, causing the arguments of the exponentials to increase quadratically for the fiber term. This leads to a rapid, nonlinear increase in passive stress. This behavior models the uncrimping and subsequent stretching of collagen fibers, which provide minimal resistance when slack but become very stiff once taut.\nThe term $\\exp(-\\frac{V - V_{0}}{k_{V}})$ in the activation function $A(V)$ creates a sigmoidal (S-shaped) relationship between transmembrane potential $V$ and active stress. This represents a highly nonlinear, switch-like activation mechanism. The active stress is negligible for $V \\ll V_0$, transitions sharply around $V=V_0$, and saturates at a maximum value $T_{\\max}$ for $V \\gg V_0$. This captures the all-or-none nature of cellular calcium release and myofilament activation that drives muscle contraction.",
            "answer": "$$\\boxed{62.27}$$"
        },
        {
            "introduction": "The heart's function is not uniform; physiological properties like ion channel expression vary across the ventricular wall, from the inner endocardium to the outer epicardium. These transmural heterogeneities are crucial for efficient pumping and can be implicated in disease. Coupled electromechanical models provide a powerful tool to investigate how differences at the cellular level translate into function and dysfunction at the organ level.\n\nThis final practice is a hands-on coding exercise that bridges the gap between theory and computational investigation . You will implement a simplified, yet complete, electromechanical model to explore how a known physiological gradient in the transient outward potassium current, $I_{\\text{to}}$, creates a functional gradient in contraction timing and regional strain. This task demonstrates the power of simulation in forming and testing hypotheses about complex biological systems, a core skill for any modern researcher in biomechanics.",
            "id": "4210008",
            "problem": "Consider a minimal two-layer transmural model of ventricular tissue consisting of an epicardial layer and an endocardial layer, each represented by a single myocyte-scale unit coupled to a one-dimensional linear elastic element. The electrophysiology and mechanics are coupled phenomenologically to assess how a transmural gradient in the transient outward potassium current (denoted as $I_{\\text{to}}$) modulates activation–contraction timing and regional strain. Your task is to implement a program that computes, for a specified set of parameter values, the difference in time-to-peak active tension between layers and the difference in mid-systolic strain between layers, as a function of an epicardial-to-endocardial gradient in $I_{\\text{to}}$.\n\nFundamental base and modeling assumptions:\n- Charge conservation provides that the membrane voltage dynamics reflect the balance of inward and outward currents and any external stimulation. We use a phenomenological, normalized membrane voltage $v(t)$ in $[0,1]$ with a stimulus pulse to trigger depolarization and a repolarization time constant that depends monotonically on the transient outward conductance $g_{\\text{to}}$ to reflect the empirical role of $I_{\\text{to}}$ in shortening the action potential in the epicardium.\n- Excitation–contraction coupling is represented by a first-order calcium activation variable $c(t)$ driven by $v(t)$, with a sensitivity factor that decreases with $g_{\\text{to}}$ to capture the reduction in calcium influx with stronger $I_{\\text{to}}$.\n- Mechanics is represented by a one-dimensional linear elastic element in parallel with the active contractile element. Total stress equilibrium against a prescribed external loading yields the fiber strain $\\varepsilon(t)$ through a linear stress–strain relation for the passive element added to the active tension.\n\nElectrophysiology:\n- Let $v(t)$ be a dimensionless normalized membrane voltage, with $v(t)=0$ at rest and $v(t)\\approx 1$ during the excited state. A rectangular stimulus $S(t)$ drives depolarization:\n  - $S(t)=1$ for $t\\in [1\\,\\mathrm{ms}, 3\\,\\mathrm{ms}]$, and $S(t)=0$ otherwise.\n- The dynamics of $v(t)$ are\n$$\n\\frac{dv}{dt} =\nS(t)\\,\\frac{1 - v}{\\tau_{\\text{dep}}}\n+\n\\bigl(1 - S(t)\\bigr)\\times\n\\begin{cases}\n-\\dfrac{v}{\\tau_{\\text{rep}}(g_{\\text{to}})},  \\text{if } v  v_{\\text{th}},\\\n$$6pt]\n-\\dfrac{v}{\\tau_{\\text{rest}}},  \\text{if } v \\le v_{\\text{th}},\n\\end{cases}\n$$\nwith $v_{\\text{th}} = 0.2$, $\\tau_{\\text{dep}} = 1\\,\\mathrm{ms}$, $\\tau_{\\text{rest}} = 20\\,\\mathrm{ms}$, and a repolarization time constant that shortens with increasing $g_{\\text{to}}$:\n$$\n\\tau_{\\text{rep}}(g_{\\text{to}}) = \\frac{\\tau_{\\text{rep},0}}{1 + a\\,g_{\\text{to}}},\\quad \\tau_{\\text{rep},0} = 120\\,\\mathrm{ms},\\ a=5.\n$$\n\nExcitation–contraction coupling:\n- The intracellular calcium activation variable $c(t)$ follows\n$$\n\\frac{dc}{dt} = k_{\\text{on},0}\\,s(g_{\\text{to}})\\,v(t) - \\frac{c}{\\tau_{\\text{Ca}}},\n$$\nwith $k_{\\text{on},0} = 0.06\\,\\mathrm{ms}^{-1}$, $\\tau_{\\text{Ca}} = 60\\,\\mathrm{ms}$, and a sensitivity $s(g_{\\text{to}})$ that decreases with $g_{\\text{to}}$:\n$$\ns(g_{\\text{to}}) = \\frac{1}{1 + b\\,g_{\\text{to}}},\\quad b=2.\n$$\n- Active tension (in $\\mathrm{kPa}$) is $T_{\\text{act}}(t) = T_{\\max}\\,c(t)$, with $T_{\\max} = 20\\,\\mathrm{kPa}$.\n\nMechanics:\n- Total fiber stress equilibrium against an imposed external stress $\\sigma_{\\text{ext}}(t)$ yields a passive elastic strain $\\varepsilon(t)$ via a linear elastic relation in parallel with the active tension:\n$$\n\\sigma_{\\text{ext}}(t) = E_{\\text{pass}}\\,\\varepsilon(t) + T_{\\text{act}}(t),\n$$\nwith $E_{\\text{pass}} = 80\\,\\mathrm{kPa}$ and a constant external stress $\\sigma_{\\text{ext}}(t) \\equiv \\sigma_{\\text{ext}} = 12\\,\\mathrm{kPa}$. Hence,\n$$\n\\varepsilon(t) = \\frac{\\sigma_{\\text{ext}} - T_{\\text{act}}(t)}{E_{\\text{pass}}}.\n$$\n\nComputational tasks:\n- For each layer $\\ell \\in \\{\\text{epi}, \\text{endo}\\}$, integrate the coupled ordinary differential equations for $v_{\\ell}(t)$ and $c_{\\ell}(t)$ from $t=0\\,\\mathrm{ms}$ to $t=300\\,\\mathrm{ms}$ with initial conditions $v_{\\ell}(0)=0$ and $c_{\\ell}(0)=0$.\n- Compute $T_{\\text{act},\\ell}(t)$ and $\\varepsilon_{\\ell}(t)$ using the relations above.\n- Define $t_{\\text{peak},\\ell}$ as the time at which $T_{\\text{act},\\ell}(t)$ attains its maximum over the simulation window. Define $\\Delta t_{\\text{peak}} = t_{\\text{peak},\\text{endo}} - t_{\\text{peak},\\text{epi}}$ in $\\mathrm{ms}$.\n- Define a mid-systolic evaluation time $t_{\\text{eval}} = 120\\,\\mathrm{ms}$. Compute $\\Delta \\varepsilon = \\varepsilon_{\\text{endo}}(t_{\\text{eval}}) - \\varepsilon_{\\text{epi}}(t_{\\text{eval}})$ (dimensionless).\n\nNumerical instructions:\n- Use a uniform evaluation grid with step $\\Delta t = 0.1\\,\\mathrm{ms}$ over $[0\\,\\mathrm{ms}, 300\\,\\mathrm{ms}]$ and a standard ordinary differential equation solver with absolute tolerance $10^{-9}$ and relative tolerance $10^{-6}$.\n- Express $\\Delta t_{\\text{peak}}$ in $\\mathrm{ms}$ and $\\Delta \\varepsilon$ as a dimensionless number. Round both to $3$ decimal places in the final output.\n\nTest suite:\n- For each test case, the parameters are the epicardial and endocardial transient outward conductances $(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}})$, in consistent arbitrary conductance units used in the formulas above.\n  1. Case A (moderate physiological gradient): $(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.3, 0.1)$.\n  2. Case B (no gradient): $(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.1, 0.1)$.\n  3. Case C (reversed gradient): $(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.05, 0.3)$.\n  4. Case D (uniformly high $I_{\\text{to}}$): $(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.5, 0.5)$.\n  5. Case E (extreme physiological gradient): $(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.6, 0.05)$.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of results, one per test case, where each result is a two-element list $[\\Delta t_{\\text{peak}}, \\Delta \\varepsilon]$ with both values rounded to $3$ decimal places. The overall output must be a single line in the exact format\n$$\n\\bigl[[\\Delta t_{\\text{peak}}^{(A)}, \\Delta \\varepsilon^{(A)}],[\\Delta t_{\\text{peak}}^{(B)}, \\Delta \\varepsilon^{(B)}],\\dots,[\\Delta t_{\\text{peak}}^{(E)}, \\Delta \\varepsilon^{(E)}]\\bigr].\n$$\nNo additional text should be printed.",
            "solution": "The problem is subjected to validation against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Model**: A two-layer transmural model of ventricular tissue (epicardial and endocardial layers), with each layer represented as a single unit.\n- **Electrophysiology**:\n    - State variable: Normalized membrane voltage $v(t)$, $v \\in [0, 1]$.\n    - Stimulus: $S(t)=1$ for $t \\in [1\\,\\mathrm{ms}, 3\\,\\mathrm{ms}]$; $S(t)=0$ otherwise.\n    - Governing ODE for $v(t)$:\n      $$\n      \\frac{dv}{dt} = S(t)\\,\\frac{1 - v}{\\tau_{\\text{dep}}} + \\bigl(1 - S(t)\\bigr)\\times\n      \\begin{cases}\n      -\\dfrac{v}{\\tau_{\\text{rep}}(g_{\\text{to}})},  \\text{if } v  v_{\\text{th}},\\\\\n      -\\dfrac{v}{\\tau_{\\text{rest}}},  \\text{if } v \\le v_{\\text{th}},\n      \\end{cases}\n      $$\n    - Parameters: $v_{\\text{th}} = 0.2$, $\\tau_{\\text{dep}} = 1\\,\\mathrm{ms}$, $\\tau_{\\text{rest}} = 20\\,\\mathrm{ms}$.\n    - Repolarization time constant: $\\tau_{\\text{rep}}(g_{\\text{to}}) = \\frac{\\tau_{\\text{rep},0}}{1 + a\\,g_{\\text{to}}}$, with $\\tau_{\\text{rep},0} = 120\\,\\mathrm{ms}$, $a=5$.\n- **Excitation–Contraction Coupling**:\n    - State variable: Calcium activation $c(t)$.\n    - Governing ODE for $c(t)$: $\\frac{dc}{dt} = k_{\\text{on},0}\\,s(g_{\\text{to}})\\,v(t) - \\frac{c}{\\tau_{\\text{Ca}}}$.\n    - Parameters: $k_{\\text{on},0} = 0.06\\,\\mathrm{ms}^{-1}$, $\\tau_{\\text{Ca}} = 60\\,\\mathrm{ms}$.\n    - Sensitivity: $s(g_{\\text{to}}) = \\frac{1}{1 + b\\,g_{\\text{to}}}$, with $b=2$.\n    - Active tension: $T_{\\text{act}}(t) = T_{\\max}\\,c(t)$, with $T_{\\max} = 20\\,\\mathrm{kPa}$.\n- **Mechanics**:\n    - Stress equilibrium: $\\sigma_{\\text{ext}}(t) = E_{\\text{pass}}\\,\\varepsilon(t) + T_{\\text{act}}(t)$.\n    - Parameters: $E_{\\text{pass}} = 80\\,\\mathrm{kPa}$, $\\sigma_{\\text{ext}}(t) \\equiv \\sigma_{\\text{ext}} = 12\\,\\mathrm{kPa}$.\n    - Strain calculation: $\\varepsilon(t) = \\frac{\\sigma_{\\text{ext}} - T_{\\text{act}}(t)}{E_{\\text{pass}}}$.\n- **Computational Tasks**:\n    - Integrate the ODEs for $v_{\\ell}(t)$ and $c_{\\ell}(t)$ for each layer $\\ell \\in \\{\\text{epi}, \\text{endo}\\}$ from $t=0\\,\\mathrm{ms}$ to $t=300\\,\\mathrm{ms}$.\n    - Initial conditions: $v_{\\ell}(0)=0$, $c_{\\ell}(0)=0$.\n    - Time to peak tension: $t_{\\text{peak},\\ell}$ is the time of maximum $T_{\\text{act},\\ell}(t)$.\n    - Output 1: $\\Delta t_{\\text{peak}} = t_{\\text{peak},\\text{endo}} - t_{\\text{peak},\\text{epi}}$.\n    - Mid-systolic evaluation time: $t_{\\text{eval}} = 120\\,\\mathrm{ms}$.\n    - Output 2: $\\Delta \\varepsilon = \\varepsilon_{\\text{endo}}(t_{\\text{eval}}) - \\varepsilon_{\\text{epi}}(t_{\\text{eval}})$.\n- **Numerical Instructions**:\n    - Time grid: $[0\\,\\mathrm{ms}, 300\\,\\mathrm{ms}]$ with step $\\Delta t = 0.1\\,\\mathrm{ms}$.\n    - ODE solver tolerances: `atol` = $10^{-9}$, `rtol` = $10^{-6}$.\n    - Output rounding: 3 decimal places.\n- **Test Suite**:\n    - Case A: $(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.3, 0.1)$.\n    - Case B: $(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.1, 0.1)$.\n    - Case C: $(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.05, 0.3)$.\n    - Case D: $(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.5, 0.5)$.\n    - Case E: $(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.6, 0.05)$.\n- **Output Format**: A single line string representing a list of two-element lists, e.g., $\\bigl[[\\Delta t_{\\text{peak}}^{(A)}, \\Delta \\varepsilon^{(A)}], \\dots \\bigr]$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded**: The problem presents a phenomenological model of cardiac electro-mechanics. While simplified, the model's components are based on established physiological principles: the role of the transient outward potassium current ($I_{\\text{to}}$) in action potential repolarization, the sequence of electrical activation leading to calcium release and mechanical contraction, and a basic representation of myocardial mechanics. The model is a valid, albeit minimal, representation used in computational cardiology. It is firmly situated within the topic of *ventricular biomechanics with coupled electrophysiology*.\n- **Well-Posed**: The problem is formulated as an initial value problem for a system of ordinary differential equations (ODEs). The right-hand side of the ODEs is piecewise but is Lipschitz continuous in the state variables within each piece, ensuring the existence and uniqueness of a solution given the initial conditions. All necessary parameters and initial conditions are provided.\n- **Objective**: The problem is stated using precise, quantitative, and unambiguous language.\n- **Flaw Check**: The problem does not violate any of the listed invalidity criteria. It is scientifically sound, formalizable, complete, and internally consistent. The parameters are within plausible, if simplified, ranges for such a model. The problem is well-structured and non-trivial.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A solution will be provided.\n\n### Solution Derivation\n\nThe solution requires simulating the coupled electro-mechanical model for an epicardial and an endocardial cell, each defined by a specific value of the transient outward conductance, $g_{\\text{to}}$. For each of the five test cases, this simulation is performed for both layers, and the specified outputs, $\\Delta t_{\\text{peak}}$ and $\\Delta \\varepsilon$, are computed.\n\n**1. System of Ordinary Differential Equations (ODEs)**\nFor each layer, we must solve a system of two coupled first-order ODEs for the state vector $\\mathbf{y}(t) = [v(t), c(t)]^T$:\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y}, g_{\\text{to}})\n$$\nwhere the function $\\mathbf{f}$ is defined by the problem statement:\n$$\n\\frac{dv}{dt} = S(t)\\,\\frac{1 - v}{\\tau_{\\text{dep}}} + \\bigl(1 - S(t)\\bigr)\\times\n\\begin{cases}\n-\\dfrac{v}{\\tau_{\\text{rep}}(g_{\\text{to}})},  \\text{if } v  v_{\\text{th}},\\\\\n-\\dfrac{v}{\\tau_{\\text{rest}}},  \\text{if } v \\le v_{\\text{th}},\n\\end{cases}\n$$\n$$\n\\frac{dc}{dt} = k_{\\text{on},0}\\,s(g_{\\text{to}})\\,v(t) - \\frac{c}{\\tau_{\\text{Ca}}}\n$$\nThe terms $\\tau_{\\text{rep}}(g_{\\text{to}})$ and $s(g_{\\text{to}})$ are computed based on the input parameter $g_{\\text{to}}$ for the specific layer. The initial conditions are $\\mathbf{y}(0) = [v(0), c(0)]^T = [0, 0]^T$.\n\n**2. Numerical Integration**\nThe system of ODEs will be solved numerically. The `scipy.integrate.solve_ivp` function is a suitable tool for this task. It implements robust, adaptive step-size algorithms (such as `RK45`, the default) capable of handling the specified accuracy tolerances ($rtol=10^{-6}, atol=10^{-9}$) and the mild non-smoothness in the derivative of $v(t)$ at the threshold $v_{\\text{th}}$. We will integrate over the time interval $t \\in [0, 300]\\,\\mathrm{ms}$ and request the solution to be evaluated on a uniform grid with a step size of $\\Delta t = 0.1\\,\\mathrm{ms}$.\n\n**3. Algorithmic Procedure**\nFor each test case $(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}})$:\n\na. **Define the ODE system function**: A Python function will be implemented that takes time $t$, state vector $\\mathbf{y}=[v, c]$, and the parameter $g_{\\text{to}}$ as input and returns the derivatives $[dv/dt, dc/dt]$ according to the model equations.\n\nb. **Simulate Epicardial Layer**:\n   - Call `solve_ivp` with the initial conditions $[0, 0]$, the time interval $[0, 300]$, the evaluation time points, the specified tolerances, and the parameter $g_{\\text{to}} = g_{\\text{to},\\text{epi}}$.\n   - The solver returns the time series for $v_{\\text{epi}}(t)$ and $c_{\\text{epi}}(t)$.\n\nc. **Simulate Endocardial Layer**:\n   - Repeat the process, calling `solve_ivp` with $g_{\\text{to}} = g_{\\text{to},\\text{endo}}$.\n   - This yields the time series for $v_{\\text{endo}}(t)$ and $c_{\\text{endo}}(t)$.\n\nd. **Post-Processing and Output Calculation**:\n   - For each layer $\\ell \\in \\{\\text{epi}, \\text{endo}\\}$, calculate the active tension time series:\n     $T_{\\text{act},\\ell}(t) = T_{\\max} \\cdot c_{\\ell}(t)$.\n   - Find the time to peak tension, $t_{\\text{peak},\\ell}$, by finding the time corresponding to the maximum value in the $T_{\\text{act},\\ell}(t)$ array. This is done using `numpy.argmax`.\n   - Compute the difference in peak times: $\\Delta t_{\\text{peak}} = t_{\\text{peak},\\text{endo}} - t_{\\text{peak},\\text{epi}}$.\n   - Locate the value of the active tension for each layer at the mid-systolic evaluation time, $t_{\\text{eval}} = 120\\,\\mathrm{ms}$. This corresponds to a specific index in the output arrays.\n   - Calculate the strain at this time point for each layer:\n     $\\varepsilon_{\\ell}(t_{\\text{eval}}) = (\\sigma_{\\text{ext}} - T_{\\text{act},\\ell}(t_{\\text{eval}})) / E_{\\text{pass}}$.\n   - Compute the difference in strain: $\\Delta \\varepsilon = \\varepsilon_{\\text{endo}}(t_{\\text{eval}}) - \\varepsilon_{\\text{epi}}(t_{\\text{eval}})$.\n   - Round both $\\Delta t_{\\text{peak}}$ and $\\Delta \\varepsilon$ to $3$ decimal places.\n\ne. **Store Results**: Store the computed pair $[\\Delta t_{\\text{peak}}, \\Delta \\varepsilon]$ for the current test case.\n\n**4. Final Output Generation**\nAfter iterating through all five test cases, the collected list of result pairs will be formatted into the specified single-line string format: $\\bigl[[\\dots],[\\dots],\\dots\\bigr]$. This is achieved by converting each inner list to its string representation and joining them with commas, then enclosing the entire sequence in brackets.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the difference in time-to-peak active tension and mid-systolic strain\n    between epicardial and endocardial layers for several test cases of I_to gradient.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.3, 0.1),   # Case A: moderate physiological gradient\n        (0.1, 0.1),   # Case B: no gradient\n        (0.05, 0.3),  # Case C: reversed gradient\n        (0.5, 0.5),   # Case D: uniformly high I_to\n        (0.6, 0.05)   # Case E: extreme physiological gradient\n    ]\n    \n    # Model parameters\n    # Electrophysiology\n    v_th = 0.2\n    tau_dep = 1.0  # ms\n    tau_rest = 20.0  # ms\n    tau_rep_0 = 120.0  # ms\n    a = 5.0\n    \n    # Excitation-contraction coupling\n    k_on_0 = 0.06  # ms^-1\n    tau_Ca = 60.0  # ms\n    b = 2.0\n    T_max = 20.0  # kPa\n    \n    # Mechanics\n    E_pass = 80.0  # kPa\n    sigma_ext = 12.0  # kPa\n    \n    # Simulation parameters\n    t_start = 0.0\n    t_end = 300.0\n    dt = 0.1\n    t_eval_points = np.arange(t_start, t_end + dt, dt)\n    t_eval_mid_systole = 120.0 # ms\n\n    # ODE system definition\n    def odes(t, y, g_to):\n        \"\"\"\n        Defines the system of ODEs for voltage v and calcium c.\n        y = [v, c]\n        \"\"\"\n        v, c = y\n        \n        # Stimulus S(t)\n        S = 1.0 if 1.0 = t = 3.0 else 0.0\n        \n        # Repolarization time constant\n        tau_rep = tau_rep_0 / (1.0 + a * g_to)\n        \n        # dv/dt\n        if S > 0:\n            dv_dt = S * (1.0 - v) / tau_dep\n        else:\n            if v > v_th:\n                dv_dt = -v / tau_rep\n            else:\n                dv_dt = -v / tau_rest\n        \n        # Calcium sensitivity\n        s_g_to = 1.0 / (1.0 + b * g_to)\n        \n        # dc/dt\n        dc_dt = k_on_0 * s_g_to * v - c / tau_Ca\n        \n        return [dv_dt, dc_dt]\n\n    results = []\n    \n    # Find the index for mid-systolic evaluation\n    t_eval_index = np.where(np.isclose(t_eval_points, t_eval_mid_systole))[0][0]\n\n    for g_to_epi, g_to_endo in test_cases:\n        # --- Simulate Epicardial Layer ---\n        sol_epi = solve_ivp(\n            odes, \n            [t_start, t_end], \n            [0, 0], \n            args=(g_to_epi,),\n            t_eval=t_eval_points, \n            rtol=1e-6, \n            atol=1e-9,\n            method='RK45'\n        )\n        c_epi = sol_epi.y[1]\n        \n        # --- Simulate Endocardial Layer ---\n        sol_endo = solve_ivp(\n            odes, \n            [t_start, t_end], \n            [0, 0], \n            args=(g_to_endo,),\n            t_eval=t_eval_points, \n            rtol=1e-6, \n            atol=1e-9,\n            method='RK45'\n        )\n        c_endo = sol_endo.y[1]\n        \n        # --- Post-processing ---\n        \n        # Active tension\n        T_act_epi = T_max * c_epi\n        T_act_endo = T_max * c_endo\n        \n        # Time to peak tension\n        t_peak_epi = t_eval_points[np.argmax(T_act_epi)]\n        t_peak_endo = t_eval_points[np.argmax(T_act_endo)]\n        delta_t_peak = t_peak_endo - t_peak_epi\n        \n        # Strain at mid-systole\n        T_act_epi_eval = T_act_epi[t_eval_index]\n        T_act_endo_eval = T_act_endo[t_eval_index]\n        \n        eps_epi_eval = (sigma_ext - T_act_epi_eval) / E_pass\n        eps_endo_eval = (sigma_ext - T_act_endo_eval) / E_pass\n        delta_eps = eps_endo_eval - eps_epi_eval\n        \n        # Store rounded results\n        case_result = [round(delta_t_peak, 3), round(delta_eps, 3)]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[[{results[0][0]}, {results[0][1]}],[{results[1][0]}, {results[1][1]}],[{results[2][0]}, {results[2][1]}],[{results[3][0]}, {results[3][1]}],[{results[4][0]}, {results[4][1]}]]\")\n\nsolve()\n```"
        }
    ]
}