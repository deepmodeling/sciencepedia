{
    "hands_on_practices": [
        {
            "introduction": "在概率生物力学中，最基础的实践之一是直接从实验数据中量化不确定性。本练习将探讨如何利用一组有限的韧带失效载荷测量值来估计其在特定阈值下载荷下失效的概率。这个过程阐明了经验累积分布函数（ECDF）作为真实但未知概率分布的非参数估计的基本思想，将抽象的概率论概念与实际的工程风险评估联系起来。",
            "id": "4200159",
            "problem": "在受控的生物力学实验室中，对一根韧带进行准静态拉伸加载直至其破坏。每个样本产生一个破坏载荷测量值。将样本空间建模为 $\\Omega = \\mathbb{R}_{>0}$，表示所有可能的以牛顿为单位的正破坏载荷，其中sigma-代数 $\\mathcal{F}$ 取为由区间生成的 $\\mathbb{R}_{>0}$ 上的 Borel sigma-代数。在 $(\\Omega,\\mathcal{F})$ 上的一个未知概率测度 $P$ 描述了在固定测试条件下，名义上相同的样本之间破坏载荷的变异性。该测度通过重复试验，基于独立同分布的样本，估计为经验概率测度。\n\n您进行了 $n = 10$ 次重复的破坏性试验，并记录了破坏载荷（单位：牛顿）如下：\n$$\nx_1 = 1500,\\quad x_2 = 1700,\\quad x_3 = 1850,\\quad x_4 = 1950,\\quad x_5 = 2050,\\quad x_6 = 2200,\\quad x_7 = 2350,\\quad x_8 = 2500,\\quad x_9 = 2600,\\quad x_{10} = 2800.\n$$\n从sigma-代数、概率测度以及从重复独立试验中导出的经验概率测度的定义出发，阐述如何仅使用观测数据来计算给定阈值 $x$ 下的概率 $P(\\text{破坏载荷} \\leq x)$。然后，对阈值 $x = 2000$ 牛顿计算此概率。在指定的测试条件下，解释此概率在韧带破坏背景下的物理意义。将最终概率表示为小数，并四舍五入到四位有效数字。最终数值不包含单位。",
            "solution": "该问题经验证是自洽的，在概率论和生物力学方面具有科学依据，并且是适定的。我们着手进行解答。\n\n该问题要求根据一组实验观测值，估计韧带的破坏载荷小于或等于一个指定阈值的概率。这需要理解测度论概率中的基本概念及其在统计学中的应用，特别是经验概率测度。\n\n首先，我们来正式定义概率空间 $(\\Omega, \\mathcal{F}, P)$ 的组成部分。\n样本空间 $\\Omega$ 是所有可能结果的集合。在本问题中，一个结果是一个破坏载荷，它是一个正实数。因此，样本空间给定为 $\\Omega = \\mathbb{R}_{>0}$，即所有正实数的集合。\n\nsigma-代数 $\\mathcal{F}$ 是 $\\Omega$ 的子集的一个集合，我们可以为这些子集分配概率。它必须满足三个性质：\n$1.$ $\\Omega \\in \\mathcal{F}$。\n$2.$ 如果 $A \\in \\mathcal{F}$，那么它的补集 $A^c = \\Omega \\setminus A$ 也在 $\\mathcal{F}$ 中。\n$3.$ 如果 $A_1, A_2, \\dots$ 是 $\\mathcal{F}$ 中一个可数集合序列，那么它们的并集 $\\cup_{i=1}^{\\infty} A_i$ 也在 $\\mathcal{F}$ 中。\n问题指出 $\\mathcal{F}$ 是 $\\mathbb{R}_{>0}$ 上的 Borel sigma-代数，这是连续样本空间中的标准选择。它是包含 $\\mathbb{R}_{>0}$ 中所有开区间的最小 sigma-代数。\n\n概率测度 $P$ 是一个函数 $P: \\mathcal{F} \\to [0, 1]$，它为每个事件（$\\mathcal{F}$ 中的一个集合）分配一个概率。它必须满足：\n$1.$ $P(\\Omega) = 1$。\n$2.$ 对于 $\\mathcal{F}$ 中任意可数的两两不交的事件序列 $A_1, A_2, \\dots$，$P(\\cup_{i=1}^{\\infty} A_i) = \\sum_{i=1}^{\\infty} P(A_i)$。\n这个测度 $P$ 描述了韧带破坏载荷的真实但未知的分布。\n\n我们给定了一组从分布 $P$ 中抽取的 $n = 10$ 个独立同分布 (i.i.d.) 的观测值 $\\{x_1, x_2, \\dots, x_{10}\\}$。\n数据如下：\n$$\nx_1 = 1500, \\quad x_2 = 1700, \\quad x_3 = 1850, \\quad x_4 = 1950, \\quad x_5 = 2050, \\\\\nx_6 = 2200, \\quad x_7 = 2350, \\quad x_8 = 2500, \\quad x_9 = 2600, \\quad x_{10} = 2800.\n$$\n由于真实测度 $P$ 未知，我们使用经验概率测度 $\\hat{P}_n$ 来估计它。经验概率测度是根据观测数据构建的。对于任何事件 $A \\in \\mathcal{F}$，经验概率 $\\hat{P}_n(A)$ 定义为落入集合 $A$ 中的观测值占总观测值 $n$ 的比例。\n\n在数学上，这使用指示函数 $I_A(x)$ 来表示，如果 $x \\in A$，则其值为 $1$，否则为 $0$。事件 $A$ 的经验概率为：\n$$\n\\hat{P}_n(A) = \\frac{1}{n} \\sum_{i=1}^{n} I_A(x_i)\n$$\n该公式提供了一种仅基于观测数据来计算任何事件概率的系统方法。根据 Glivenko-Cantelli 定理，随着样本数量 $n$ 的增加，经验分布函数会一致收敛于真实的累积分布函数。\n\n问题要求计算概率 $P(\\text{破坏载荷} \\leq x)$，这对应于事件 $A = \\{\\omega \\in \\Omega \\mid \\omega \\leq x\\}$。对于给定的阈值 $x = 2000$ 牛顿，该事件为 $A = \\{\\omega \\in \\mathbb{R}_{>0} \\mid \\omega \\leq 2000\\}$，或者更简单地说是区间 $(0, 2000]$。我们使用经验测度 $\\hat{P}_{10}$ 来估计该事件的概率：\n$$\n\\hat{P}_{10}(\\text{破坏载荷} \\leq 2000) = \\frac{1}{10} \\sum_{i=1}^{10} I_{(0, 2000]}(x_i)\n$$\n项 $\\sum_{i=1}^{10} I_{(0, 2000]}(x_i)$ 就是满足 $x_i \\leq 2000$ 的数据点 $x_i$ 的数量。让我们检查给定的数据：\n- $x_1 = 1500 \\leq 2000$ (真)\n- $x_2 = 1700 \\leq 2000$ (真)\n- $x_3 = 1850 \\leq 2000$ (真)\n- $x_4 = 1950 \\leq 2000$ (真)\n- $x_5 = 2050 > 2000$ (假)\n- $x_6 = 2200 > 2000$ (假)\n- $x_7 = 2350 > 2000$ (假)\n- $x_8 = 2500 > 2000$ (假)\n- $x_9 = 2600 > 2000$ (假)\n- $x_{10} = 2800 > 2000$ (假)\n\n小于或等于 $2000$ 的观测值数量为 $4$。设这个计数为 $k$。所以，$k=4$。\n总观测值数量为 $n=10$。\n因此，估计的概率为：\n$$\n\\hat{P}_{10}(\\text{破坏载荷} \\leq 2000) = \\frac{k}{n} = \\frac{4}{10} = 0.4\n$$\n问题要求答案四舍五入到四位有效数字。因此，$0.4$ 变为 $0.4000$。\n\n该概率的物理诠释是，基于收集的实验数据，从同一总体中随机抽取并在相同的准静态拉伸加载条件下测试的韧带样本，有估计为 $40\\%$ 的几率会在 $2000$ 牛顿或以下的载荷下发生破坏。这个值 $\\hat{P}_{10}(\\text{破坏载荷} \\leq 2000)$ 是破坏载荷的真实累积分布函数 (CDF) $F(x) = P(\\text{破坏载荷} \\leq x)$ 在点 $x=2000$ 处的值的估计。在生物力学工程和临床实践中，这样的概率对于风险评估至关重要。例如，如果预计韧带上的体内载荷将达到 $2000$ 牛顿，这个结果为组织破坏的风险提供了一个初步的、由数据驱动的估计。",
            "answer": "$$\n\\boxed{0.4000}\n$$"
        },
        {
            "introduction": "生物力学结构的寿命，如肌腱在循环载荷下的疲劳寿命，是设计和评估中的一个关键随机变量。本练习构建了一个参数化生存模型，用于处理包含“右删失”数据的实验结果，即某些样本在实验结束时仍未失效。通过推导考虑了删失数据的Weibull模型的似然函数，我们为后续的参数估计（如最大似然估计）和建立应力-寿命关系奠定了数学基础。",
            "id": "4200142",
            "problem": "一个生物力学实验室对 $N$ 个独立的肌腱束样本进行恒定振幅循环疲劳试验。对于样本 $i$，施加的名义应力幅为 $s_i$，实验记录了样本在试验期间失效的失效时间 $t_i$（单位为循环次数），或者如果样本在观察窗口结束时仍未失效，则记录其右删失时间 $t_i$。令 $\\delta_i$ 为事件指示符，当在时间 $t_i$ 观测到失效时，$\\delta_i = 1$；当在时间 $t_i$ 观测到右删失时，$\\delta_i = 0$。假设右删失为非信息性的，且各样本之间相互独立。\n\n使用威布尔（Weibull）参数化生存模型对随机失效时间 $T_i$ 进行建模，该模型具有形状参数 $k>0$ 和一个依赖于应力的尺度参数 $\\lambda_i>0$。该尺度参数遵循加速寿命形式，$\\lambda_i = \\lambda \\exp(-\\beta s_i)$，其中 $\\lambda>0$ 是基线尺度，$\\beta$ 是应力敏感性参数。从生存函数 $S_i(t) = \\mathbb{P}(T_i > t)$ 和风险函数 $h_i(t) = f_i(t)/S_i(t)$（其中 $f_i(t)$ 为概率密度函数）的核心定义出发，推导在右删失情况下观测数据 $\\{(t_i,s_i,\\delta_i)\\}_{i=1}^{N}$ 的全似然函数 $L(k,\\lambda,\\beta \\mid \\{(t_i,s_i,\\delta_i)\\}_{i=1}^{N})$。\n\n最终答案必须是似然函数关于 $k$、$\\lambda$、$\\beta$ 和数据 $\\{(t_i,s_i,\\delta_i)\\}_{i=1}^{N}$ 的单个闭式解析表达式。无需四舍五入。最终表达式中不要包含单位。",
            "solution": "该问题陈述经评估有效。其科学基础扎实，问题设定良好，客观，并包含推导所需似然函数的全部必要信息。该问题是参数化生存分析中的一个标准练习，这是概率生物力学和可靠性理论中的一个核心课题。因此，我们可以着手进行推导。\n\n目标是为给定的数据和模型推导全似然函数 $L(k,\\lambda,\\beta \\mid \\{(t_i,s_i,\\delta_i)\\}_{i=1}^{N})$。$N$ 个独立样本中，每个样本的数据包括一个时间 $t_i$、一个应力水平 $s_i$ 和一个事件指示符 $\\delta_i$。如果样本在时间 $t_i$ 失效，则指示符 $\\delta_i=1$；如果观测在时间 $t_i$ 被右删失，则指示符 $\\delta_i=0$。\n\n单个观测值 $i$ 对总似然函数的贡献取决于它对应的是失效事件还是删失事件。\n- 如果样本在时间 $t_i$ 失效（即 $\\delta_i=1$），其贡献是在该特定时间的失效概率密度，由概率密度函数（PDF）$f_i(t_i)$ 给出。\n- 如果观测在时间 $t_i$ 被右删失（即 $\\delta_i=0$），这意味着样本至少存活到时间 $t_i$。此事件的概率由生存函数 $S_i(t_i) = \\mathbb{P}(T_i > t_i)$ 给出。\n\n我们可以使用事件指示符 $\\delta_i$ 将单个样本 $i$ 的似然贡献（记为 $L_i$）写成一个紧凑的形式：\n$$L_i(k, \\lambda, \\beta \\mid t_i, s_i, \\delta_i) = [f_i(t_i)]^{\\delta_i} [S_i(t_i)]^{1-\\delta_i}$$\n由于假设样本是独立的，总似然函数 $L$ 是各个贡献的乘积：\n$$L = \\prod_{i=1}^{N} L_i = \\prod_{i=1}^{N} [f_i(t_i)]^{\\delta_i} [S_i(t_i)]^{1-\\delta_i}$$\n问题给出了风险函数 $h_i(t) = f_i(t)/S_i(t)$ 的定义。我们可以重新整理这个式子，将 PDF 表示为 $f_i(t) = h_i(t)S_i(t)$。将此代入似然表达式中，可以得到一个替代的、通常更方便的形式：\n$$L = \\prod_{i=1}^{N} [h_i(t_i)S_i(t_i)]^{\\delta_i} [S_i(t_i)]^{1-\\delta_i} = \\prod_{i=1}^{N} [h_i(t_i)]^{\\delta_i} [S_i(t_i)]^{\\delta_i + 1 - \\delta_i} = \\prod_{i=1}^{N} [h_i(t_i)]^{\\delta_i} S_i(t_i)$$\n问题指出，失效时间 $T_i$ 服从威布尔（Weibull）分布，其形状参数为常数 $k > 0$，尺度参数 $\\lambda_i > 0$ 依赖于应力。对于形状参数为 $k$、尺度参数为 $\\lambda_i$ 的威布尔分布，其生存函数 $S_i(t)$ 和风险函数 $h_i(t)$ 由以下公式给出：\n$$S_i(t) = \\exp\\left(-\\left(\\frac{t}{\\lambda_i}\\right)^k\\right)$$\n$$h_i(t) = \\frac{k}{\\lambda_i} \\left(\\frac{t}{\\lambda_i}\\right)^{k-1}$$\n我们将 $S_i(t_i)$ 和 $h_i(t_i)$ 的这些具体形式代入我们的一般似然表达式中：\n$$L = \\prod_{i=1}^{N} \\left[ \\left( \\frac{k}{\\lambda_i} \\left(\\frac{t_i}{\\lambda_i}\\right)^{k-1} \\right)^{\\delta_i} \\exp\\left(-\\left(\\frac{t_i}{\\lambda_i}\\right)^k\\right) \\right]$$\n这可以通过合并风险函数中包含 $\\lambda_i$ 的项来简化：\n$$h_i(t_i) = \\frac{k t_i^{k-1}}{\\lambda_i^k}$$\n似然函数变为：\n$$L = \\prod_{i=1}^{N} \\left[ \\left( \\frac{k t_i^{k-1}}{\\lambda_i^k} \\right)^{\\delta_i} \\exp\\left(-\\frac{t_i^k}{\\lambda_i^k}\\right) \\right]$$\n最后一步是引入加速寿命模型，该模型定义了尺度参数 $\\lambda_i$ 和施加应力 $s_i$ 之间的关系：\n$$\\lambda_i = \\lambda \\exp(-\\beta s_i)$$\n其中 $\\lambda>0$ 是一个基线尺度参数，$\\beta$ 是一个应力敏感性参数。我们需要将此式代入似然表达式中。最方便的做法是替换项 $\\lambda_i^k$：\n$$\\lambda_i^k = (\\lambda \\exp(-\\beta s_i))^k = \\lambda^k \\exp(-k \\beta s_i)$$\n将此代入似然函数，得到关于参数 $k$、$\\lambda$ 和 $\\beta$ 的最终表达式：\n$$L(k, \\lambda, \\beta) = \\prod_{i=1}^{N} \\left\\{ \\left( \\frac{k t_i^{k-1}}{\\lambda^k \\exp(-k \\beta s_i)} \\right)^{\\delta_i} \\exp\\left(-\\frac{t_i^k}{\\lambda^k \\exp(-k \\beta s_i)}\\right) \\right\\}$$\n简化乘积内部的项可得：\n$$L(k, \\lambda, \\beta) = \\prod_{i=1}^{N} \\left\\{ \\left( \\frac{k}{\\lambda^k} t_i^{k-1} \\exp(k \\beta s_i) \\right)^{\\delta_i} \\exp\\left(-\\frac{t_i^k}{\\lambda^k} \\exp(k \\beta s_i)\\right) \\right\\}$$\n这就是在给定观测数据 $\\{(t_i, s_i, \\delta_i)\\}_{i=1}^{N}$ 的情况下，关于参数 $(k, \\lambda, \\beta)$ 的似然函数的闭式解析表达式。",
            "answer": "$$\n\\boxed{ \\prod_{i=1}^{N} \\left\\{ \\left( \\frac{k}{\\lambda^k} t_i^{k-1} \\exp(k \\beta s_i) \\right)^{\\delta_i} \\exp\\left(-\\frac{t_i^k}{\\lambda^k} \\exp(k \\beta s_i)\\right) \\right\\} }\n$$"
        },
        {
            "introduction": "在建立了生物力学模型之后，我们通常需要从实验数据中推断其关键参数（例如组织刚度）并量化我们对这些参数的不确定性。本练习将引导您应用一种强大的计算方法——马尔可夫链蒙特卡洛（MCMC）——来解决这个问题。您将为一个简单的线弹性模型推导Metropolis–Hastings算法的接受率，这是一种核心的MCMC技术，它结合了数据的似然性和参数的先验知识，以获得参数的完整后验概率分布。",
            "id": "4200122",
            "problem": "一个单自由度肌腱段被建模为一个线性弹性元件，其刚度为 $k>0$，通过本构关系 $F = k x$ 将力 $F$ 与伸长量 $x$ 联系起来。在一个实验中，在准静态条件下收集了 $n$ 组独立测量值 $\\{(x_i, F_i)\\}_{i=1}^{n}$，其中伸长量 $x_i$ 是受控的，而力 $F_i$ 是观测值。力的测量噪声被建模为独立同分布的高斯噪声：对于每个 $i \\in \\{1,\\dots,n\\}$，\n$$\nF_i = k x_i + \\varepsilon_i,\\quad \\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2),\n$$\n其中噪声标准差 $\\sigma>0$ 是已知的。刚度的先验分布是对数正态分布：$\\ln k \\sim \\mathcal{N}(\\mu_0,\\sigma_0^2)$，其中超参数 $\\mu_0 \\in \\mathbb{R}$ 和 $\\sigma_0>0$ 是已知的。考虑一个梅特罗波利斯-哈斯廷斯算法，该算法通过高斯随机游走提议来更新变换后的参数 $\\theta = \\ln k$，\n$$\n\\theta' = \\theta + \\eta,\\quad \\eta \\sim \\mathcal{N}(0, s^2),\n$$\n其中提议尺度 $s>0$，提议密度在 $\\theta$ 上是对称的。\n\n从贝叶斯定理和上述定义出发，推导从当前状态 $\\theta$ 移动到提议状态 $\\theta'$ 的梅特罗波利斯-哈斯廷斯接受率（即 $\\min(1,\\cdot)$ 中的参数）的精确闭式表达式。您的推导必须正确考虑参数变换和任何雅可比因子。仅使用初等函数，用 $(x_i,F_i)_{i=1}^{n}$、$\\sigma$、$\\mu_0$、$\\sigma_0$、$\\theta$ 和 $\\theta'$ 表示您的最终答案。\n\n然后，讨论为提高效率而进行的提议缩放：假设 $\\theta$ 的后验分布在其最大值点 $\\theta^\\ast$ 附近可以很好地被高斯分布局部近似，通过计算对数后验在 $\\theta^\\ast$ 处的负二阶导数，推导 $\\theta$ 的后验方差 $V$ 的拉普拉斯近似。利用此近似和针对高斯目标的一维随机游走梅特罗波利斯理论，陈述一个形式为 $s \\approx c^\\ast \\sqrt{V}$ 的有原则的缩放规则，其中 $c^\\ast$ 是一个为平衡探索和接受而选择的常数。用一个优化条件来表示 $c^\\ast$，该条件刻画了一维高斯目标的期望平方跳跃距离的最大化者。不要对 $c^\\ast$ 使用任何数值。\n\n您最终报告的答案必须是第一部分推导出的梅特罗波利斯-哈斯廷斯接受率的唯一、精确的解析表达式。该表达式不需要单位。不要提供任何数值近似。",
            "solution": "该问题具有科学依据，是适定的，并且为其求解提供了所有必要信息。它代表了贝叶斯推断和马尔可夫链蒙特卡洛（MCMC）方法在生物力学中一个常见问题上的标准应用。因此，我们可以进行推导。\n\n第一个任务是推导梅特罗波利斯-哈斯廷斯算法的接受率。从状态 $\\theta$ 移动到提议状态 $\\theta'$ 的接受概率的一般形式为\n$$\n\\alpha(\\theta, \\theta') = \\min\\left(1, \\frac{\\pi(\\theta'|D) q(\\theta|\\theta')}{\\pi(\\theta|D) q(\\theta'|\\theta)}\\right)\n$$\n其中 $\\pi(\\cdot|D)$ 是给定数据 $D = \\{(x_i, F_i)\\}_{i=1}^{n}$ 的后验分布，而 $q(\\theta'|\\theta)$ 是提议分布。问题指定了一个高斯随机游走提议，$\\theta' = \\theta + \\eta$，其中 $\\eta \\sim \\mathcal{N}(0, s^2)$。$\\eta$ 的密度关于 $0$ 是对称的，这意味着提议是对称的，即 $q(\\theta'|\\theta) = q(\\theta|\\theta')$。于是接受概率简化为\n$$\n\\alpha(\\theta, \\theta') = \\min\\left(1, \\frac{\\pi(\\theta'|D)}{\\pi(\\theta|D)}\\right)\n$$\n$\\min(1, \\cdot)$ 内部的项就是我们被要求推导的接受率。\n\n根据贝叶斯定理，后验分布与似然和先验的乘积成正比：$\\pi(\\theta|D) \\propto p(D|\\theta)p(\\theta)$。因此，接受率为\n$$\n\\frac{\\pi(\\theta'|D)}{\\pi(\\theta|D)} = \\frac{p(D|\\theta')p(\\theta')}{p(D|\\theta)p(\\theta)}\n$$\n我们推导似然 $p(D|\\theta)$ 和先验 $p(\\theta)$ 的表达式。\n\n似然模型由 $F_i = k x_i + \\varepsilon_i$ 给出，其中 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。这意味着每次力的测量值 $F_i$ 都是从以 $k x_i$ 为中心、方差为 $\\sigma^2$ 的正态分布中抽取的：$F_i \\sim \\mathcal{N}(k x_i, \\sigma^2)$。由于测量是独立的，数据 $D$ 的总似然是各个似然的乘积：\n$$\np(D|k) = \\prod_{i=1}^n p(F_i|x_i, k) = \\prod_{i=1}^n \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(F_i - k x_i)^2}{2\\sigma^2}\\right)\n$$\nMCMC算法对变换后的参数 $\\theta = \\ln k$ 进行采样，因此我们必须将似然表示为 $\\theta$ 的函数。通过代入 $k = e^\\theta$，我们得到\n$$\np(D|\\theta) = \\prod_{i=1}^n \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(F_i - e^\\theta x_i)^2}{2\\sigma^2}\\right)\n$$\n先验分布是直接为变换后的参数 $\\theta = \\ln k$ 指定的，它服从正态分布：$\\theta \\sim \\mathcal{N}(\\mu_0, \\sigma_0^2)$。$\\theta$ 的先验概率密度函数是\n$$\np(\\theta) = \\frac{1}{\\sqrt{2\\pi\\sigma_0^2}} \\exp\\left(-\\frac{(\\theta - \\mu_0)^2}{2\\sigma_0^2}\\right)\n$$\n问题陈述要求考虑参数变换和雅可比行列式。我们来明确一下。$k$ 的后验是 $\\pi_K(k|D) \\propto p(D|k)\\pi_K(k)$。$k$ 的先验是对数正态分布，所以其密度为 $\\pi_K(k) = p(\\ln k)|\\frac{d(\\ln k)}{dk}| = p(\\ln k) \\frac{1}{k}$。$\\theta$ 的后验密度通过变量替换法则找到：$\\pi_\\Theta(\\theta|D) = \\pi_K(k(\\theta)|D) |\\frac{dk}{d\\theta}|$。由于 $k=e^\\theta$，雅可比行列式为 $|\\frac{dk}{d\\theta}| = e^\\theta = k$。因此，$\\pi_\\Theta(\\theta|D) \\propto p(D|k=e^\\theta) \\pi_K(k=e^\\theta) \\cdot k = p(D|e^\\theta) (p(\\theta)\\frac{1}{k}) \\cdot k = p(D|e^\\theta)p(\\theta)$。雅可比行列式相互抵消，这证实了我们关于 $\\theta$ 的后验确实与以 $\\theta$ 重新表示的似然乘以 $\\theta$ 上的先验成正比。\n\n现在我们通过取在 $\\theta'$ 和 $\\theta$ 处评估的后验之比来构建接受率。设 $R$ 为接受率。\n$$\nR = \\frac{p(D|\\theta')p(\\theta')}{p(D|\\theta)p(\\theta)} = \\frac{\\left(\\prod_{i=1}^n \\exp\\left(-\\frac{(F_i - e^{\\theta'} x_i)^2}{2\\sigma^2}\\right)\\right) \\exp\\left(-\\frac{(\\theta' - \\mu_0)^2}{2\\sigma_0^2}\\right)}{\\left(\\prod_{i=1}^n \\exp\\left(-\\frac{(F_i - e^\\theta x_i)^2}{2\\sigma^2}\\right)\\right) \\exp\\left(-\\frac{(\\theta - \\mu_0)^2}{2\\sigma_0^2}\\right)}\n$$\n常数因子被消掉。通过取对数来处理指数项会更容易。对数后验 $L(\\theta)$（不计加法常数）为\n$$\nL(\\theta) = \\ln(\\pi(\\theta|D)) \\propto -\\frac{1}{2\\sigma^2} \\sum_{i=1}^n (F_i - e^\\theta x_i)^2 - \\frac{1}{2\\sigma_0^2} (\\theta - \\mu_0)^2\n$$\n接受率的对数是 $\\ln(R) = L(\\theta') - L(\\theta)$。\n$$\n\\ln(R) = \\left[-\\frac{1}{2\\sigma^2} \\sum_{i=1}^n (F_i - e^{\\theta'} x_i)^2 - \\frac{1}{2\\sigma_0^2} (\\theta' - \\mu_0)^2\\right] - \\left[-\\frac{1}{2\\sigma^2} \\sum_{i=1}^n (F_i - e^\\theta x_i)^2 - \\frac{1}{2\\sigma_0^2} (\\theta - \\mu_0)^2 \\right]\n$$\n重新整理这些项可得\n$$\n\\ln(R) = \\frac{1}{2\\sigma^2} \\sum_{i=1}^n \\left( (F_i - e^\\theta x_i)^2 - (F_i - e^{\\theta'} x_i)^2 \\right) + \\frac{1}{2\\sigma_0^2} \\left( (\\theta - \\mu_0)^2 - (\\theta' - \\mu_0)^2 \\right)\n$$\n对两边取指数，得到接受率的最终表达式：\n$$\nR = \\exp\\left[ \\frac{1}{2\\sigma^2} \\sum_{i=1}^n \\left( (F_i - e^\\theta x_i)^2 - (F_i - e^{\\theta'} x_i)^2 \\right) + \\frac{1}{2\\sigma_0^2} \\left( (\\theta - \\mu_0)^2 - (\\theta' - \\mu_0)^2 \\right) \\right]\n$$\n此表达式仅依赖于指定的变量并使用初等函数，符合要求。\n\n任务的第二部分涉及讨论提议缩放。我们使用拉普拉斯近似来计算 $\\theta$ 的后验方差。高斯近似的方差 $V$ 是 $L(\\theta)$ 在后验众数 $\\theta^\\ast$ 处的二阶导数的负倒数。一阶导数是\n$$\n\\frac{dL}{d\\theta} = -\\frac{1}{2\\sigma^2} \\sum_{i=1}^n 2(F_i - e^\\theta x_i)(-e^\\theta x_i) - \\frac{1}{2\\sigma_0^2} 2(\\theta - \\mu_0) = \\frac{e^\\theta}{\\sigma^2}\\sum_{i=1}^n (F_i x_i - e^\\theta x_i^2) - \\frac{\\theta - \\mu_0}{\\sigma_0^2}\n$$\n二阶导数是\n$$\n\\frac{d^2L}{d\\theta^2} = \\frac{d}{d\\theta} \\left[ \\frac{1}{\\sigma^2}\\sum_{i=1}^n (F_i x_i e^\\theta - x_i^2 e^{2\\theta}) - \\frac{\\theta - \\mu_0}{\\sigma_0^2} \\right] = \\frac{1}{\\sigma^2}\\sum_{i=1}^n (F_i x_i e^\\theta - 2x_i^2 e^{2\\theta}) - \\frac{1}{\\sigma_0^2}\n$$\n众数 $\\theta^\\ast$ 位于 $dL/d\\theta = 0$ 处。后验方差的倒数，或称为精度，是 $-d^2L/d\\theta^2$ 在 $\\theta^\\ast$ 处的值：\n$$\nV^{-1} = -\\frac{d^2L}{d\\theta^2}\\bigg|_{\\theta=\\theta^\\ast} = \\frac{1}{\\sigma_0^2} - \\frac{1}{\\sigma^2}\\sum_{i=1}^n (F_i x_i e^{\\theta^\\ast} - 2x_i^2 e^{2\\theta^\\ast}) = \\frac{1}{\\sigma_0^2} + \\frac{e^{\\theta^\\ast}}{\\sigma^2}\\sum_{i=1}^n (2x_i^2 e^{\\theta^\\ast} - F_i x_i)\n$$\n后验方差的拉普拉斯近似为 $V = (V^{-1})^{-1}$。\n\n为了实现高效采样，应当调整提议尺度 $s$。对于目标为高斯分布的一维随机游走梅特罗波利斯算法，理论建议了一个形式为 $s \\approx c^\\ast \\sqrt{V}$ 的缩放规则，其中 $V$ 是目标方差。常数 $c^\\ast$ 的选择是为了优化采样器效率的度量，通常是期望平方跳跃距离（ESJD）。对于标准高斯目标 $\\Phi \\sim \\mathcal{N}(0,1)$ 和一个与 $\\Phi$ 无关的提议步长 $\\lambda Z$（其中 $Z \\sim \\mathcal{N}(0,1)$），期望平方跳跃距离为 $E[\\alpha(\\Phi, \\lambda Z) (\\lambda Z)^2]$。常数 $c^\\ast$ 是最大化此量的 $\\lambda=s/\\sqrt{V}$ 的值。因此，定义 $c^\\ast$ 的优化条件是：\n$$\nc^\\ast = \\underset{\\lambda > 0}{\\arg\\max} \\left( \\lambda^2 E_{\\Phi,Z \\sim i.i.d.\\mathcal{N}(0,1)}\\left[\\min\\left(1, \\exp\\left(-\\lambda \\Phi Z - \\frac{(\\lambda Z)^2}{2}\\right)\\right)\\right] \\right)\n$$\n这为基于拉普拉斯近似的后验方差 $V$ 设置提议尺度 $s$ 提供了一个有原则的规则。",
            "answer": "$$\n\\boxed{\\exp\\left[ \\frac{1}{2\\sigma^2} \\sum_{i=1}^n \\left( (F_i - e^\\theta x_i)^2 - (F_i - e^{\\theta'} x_i)^2 \\right) + \\frac{1}{2\\sigma_0^2} \\left( (\\theta - \\mu_0)^2 - (\\theta' - \\mu_0)^2 \\right) \\right]}\n$$"
        }
    ]
}