{
    "hands_on_practices": [
        {
            "introduction": "在生物力学中，我们经常通过实验来评估组织或结构的强度。这个练习将带你回到不确定性量化的最基本层面：如何直接从一组实验测量值中估算失效概率。通过构建经验累积分布函数，你可以将离散的实验数据点转化为一个连续的概率评估，这是进行风险分析和可靠性设计的基础。",
            "id": "4200159",
            "problem": "在受控的生物力学实验室中，对一根韧带进行准静态拉伸加载直至失效的测试。每个样本产生一个失效载荷测量值。将样本空间建模为$\\,\\Omega = \\mathbb{R}_{>0}\\,$，代表所有可能的正失效载荷（单位：牛顿），其σ-代数$\\,\\mathcal{F}\\,$取为由区间生成的$\\,\\mathbb{R}_{>0}\\,$上的Borel σ-代数。一个定义在$(\\Omega,\\mathcal{F})$上的未知概率测度$\\,P\\,$描述了在固定测试条件下，名义上相同的样本之间失效载荷的变异性。该测度通过基于独立同分布样本的经验概率测度，从重复测试中进行估计。\n\n您进行了$\\,n = 10\\,$次重复的破坏性测试，并记录了失效载荷（单位：牛顿）如下\n$$\nx_1 = 1500,\\quad x_2 = 1700,\\quad x_3 = 1850,\\quad x_4 = 1950,\\quad x_5 = 2050,\\quad x_6 = 2200,\\quad x_7 = 2350,\\quad x_8 = 2500,\\quad x_9 = 2600,\\quad x_{10} = 2800.\n$$\n从σ-代数、概率测度和从重复独立测试中导出的经验概率测度的定义出发，阐述如何仅使用观测数据计算给定阈值$\\,x\\,$下的概率$\\,P(\\text{失效载荷} \\leq x)\\,$。然后，评估在阈值$\\,x = 2000\\,$牛顿时该概率的值。解释在指定的测试条件下，此概率在韧带失效背景下的物理意义。将最终概率表示为小数，并四舍五入到四位有效数字。最终数值不包含单位。",
            "solution": "该问题经验证是自洽的，在概率论和生物力学方面有科学依据，且提法明确。我们开始解答。\n\n问题要求根据一组实验观测值，估计韧带的失效载荷小于或等于一个指定阈值的概率。这需要理解测度论概率中的基本概念及其在统计学中的应用，特别是经验概率测度。\n\n首先，我们正式定义概率空间$(\\Omega, \\mathcal{F}, P)$的组成部分。\n样本空间$\\Omega$是所有可能结果的集合。在此问题中，一个结果是一个失效载荷，它是一个正实数。因此，样本空间给定为$\\Omega = \\mathbb{R}_{>0}$，即所有正实数的集合。\n\nσ-代数$\\mathcal{F}$是$\\Omega$的一个子集集合，我们可以为其中的每个子集分配一个概率。它必须满足三个性质：\n$1.$ $\\Omega \\in \\mathcal{F}$。\n$2.$ 如果$A \\in \\mathcal{F}$，那么它的补集$A^c = \\Omega \\setminus A$也在$\\mathcal{F}$中。\n$3.$ 如果$A_1, A_2, \\dots$是$\\mathcal{F}$中一个可数的集合序列，那么它们的并集$\\cup_{i=1}^{\\infty} A_i$也在$\\mathcal{F}$中。\n问题指出$\\mathcal{F}$是$\\mathbb{R}_{>0}$上的Borel σ-代数，这是连续样本空间中的标准选择。它是包含$\\mathbb{R}_{>0}$中所有开区间的最小σ-代数。\n\n概率测度$P$是一个函数$P: \\mathcal{F} \\to [0, 1]$，它为每个事件（$\\mathcal{F}$中的一个集合）分配一个概率。它必须满足：\n$1.$ $P(\\Omega) = 1$。\n$2.$ 对于$\\mathcal{F}$中任意可数序列的两两不交的事件$A_1, A_2, \\dots$，$P(\\cup_{i=1}^{\\infty} A_i) = \\sum_{i=1}^{\\infty} P(A_i)$。\n这个测度$P$描述了韧带失效载荷的真实但未知的分布。\n\n我们给定一组从分布$P$中抽取的$n = 10$个独立同分布 (i.i.d.) 的观测值$\\{x_1, x_2, \\dots, x_{10}\\}$。\n数据如下：\n$$\nx_1 = 1500, \\quad x_2 = 1700, \\quad x_3 = 1850, \\quad x_4 = 1950, \\quad x_5 = 2050, \\\\\nx_6 = 2200, \\quad x_7 = 2350, \\quad x_8 = 2500, \\quad x_9 = 2600, \\quad x_{10} = 2800.\n$$\n由于真实的测度$P$未知，我们使用经验概率测度$\\hat{P}_n$来估计它。经验概率测度是根据观测数据构建的。对于任何事件$A \\in \\mathcal{F}$，经验概率$\\hat{P}_n(A)$定义为$n$个观测值中落入集合$A$的比例。\n\n在数学上，这可以用指示函数$I_A(x)$来表示，如果$x \\in A$，则其值为$1$，否则为$0$。一个事件$A$的经验概率是：\n$$\n\\hat{P}_n(A) = \\frac{1}{n} \\sum_{i=1}^{n} I_A(x_i)\n$$\n该公式提供了一种仅基于观测数据计算任何事件概率的系统方法。根据Glivenko-Cantelli定理，随着样本数量$n$的增加，经验分布函数会一致收敛于真实的累积分布函数。\n\n问题要求计算概率$P(\\text{失效载荷} \\leq x)$，这对应于事件$A = \\{\\omega \\in \\Omega \\mid \\omega \\leq x\\}$。对于给定的阈值$x = 2000$牛顿，事件为$A = \\{\\omega \\in \\mathbb{R}_{>0} \\mid \\omega \\leq 2000\\}$，或者更简单地说是区间$(0, 2000]$。我们使用经验测度$\\hat{P}_{10}$来估计这个事件的概率：\n$$\n\\hat{P}_{10}(\\text{失效载荷} \\leq 2000) = \\frac{1}{10} \\sum_{i=1}^{10} I_{(0, 2000]}(x_i)\n$$\n项$\\sum_{i=1}^{10} I_{(0, 2000]}(x_i)$就是满足$x_i \\leq 2000$的数据点$x_i$的数量。我们来检查给定的数据：\n- $x_1 = 1500 \\leq 2000$ (真)\n- $x_2 = 1700 \\leq 2000$ (真)\n- $x_3 = 1850 \\leq 2000$ (真)\n- $x_4 = 1950 \\leq 2000$ (真)\n- $x_5 = 2050 > 2000$ (假)\n- $x_6 = 2200 > 2000$ (假)\n- $x_7 = 2350 > 2000$ (假)\n- $x_8 = 2500 > 2000$ (假)\n- $x_9 = 2600 > 2000$ (假)\n- $x_{10} = 2800 > 2000$ (假)\n\n小于或等于$2000$的观测值数量为$4$。设这个计数为$k$。所以，$k=4$。\n总观测次数为$n=10$。\n因此，估计的概率为：\n$$\n\\hat{P}_{10}(\\text{失效载荷} \\leq 2000) = \\frac{k}{n} = \\frac{4}{10} = 0.4\n$$\n问题要求答案四舍五入到四位有效数字。因此，$0.4$变为$0.4000$。\n\n这个概率的物理意义是，根据收集的实验数据，从同一总体中随机抽取一个韧带样本，在相同的准静态拉伸加载条件下进行测试，其在载荷小于或等于$2000$牛顿时发生失效的估计概率为$40\\%$。这个值$\\hat{P}_{10}(\\text{失效载荷} \\leq 2000)$是失效载荷的真实累积分布函数（CDF）$F(x) = P(\\text{失效载荷} \\leq x)$在点$x=2000$处的估计值。在生物力学工程和临床实践中，这样的概率对于风险评估至关重要。例如，如果韧带上的体内载荷预计达到$2000$ N，这个结果提供了一个初步的、由数据驱动的组织失效风险估计。",
            "answer": "$$\n\\boxed{0.4000}\n$$"
        },
        {
            "introduction": "当处理像材料疲劳这样的随时间变化的失效过程时，我们不仅关心“是否”失效，还关心“何时”失效。这个实践将介绍一种更复杂的建模方法——参数化生存模型——它特别适用于包含“右删失”数据（即在实验结束时仍未失效的样本）的场景。你将推导在生物力学中广泛应用的威布尔 (Weibull) 模型的似然函数，这是进行参数估计和寿命预测的关键一步。",
            "id": "4200142",
            "problem": "一个生物力学实验室对 $N$ 个独立的肌腱束样本进行恒幅循环疲劳试验。对于样本 $i$，施加的名义应力幅值为 $s_i$，实验记录了样本在测试期间失效的失效时间 $t_i$（单位为循环次数），或者在观测窗口结束时样本仍未失效的右删失时间 $t_i$。令 $\\delta_i$ 为事件指示符，当在时间 $t_i$ 观测到失效时，$\\delta_i = 1$；当在时间 $t_i$ 为右删失观测时，$\\delta_i = 0$。假设为非信息性右删失，且各样本之间相互独立。\n\n使用威布尔参数生存模型对随机失效时间 $T_i$ 进行建模，该模型具有形状参数 $k>0$ 和一个与应力相关的尺度参数 $\\lambda_i>0$。该尺度参数遵循加速寿命形式，$\\lambda_i = \\lambda \\exp(-\\beta s_i)$，其中 $\\lambda>0$ 是一个基准尺度，$\\beta$ 是一个应力敏感性参数。从生存函数 $S_i(t) = \\mathbb{P}(T_i > t)$ 和风险函数 $h_i(t) = f_i(t)/S_i(t)$（其中 $f_i(t)$ 是概率密度函数）的核心定义出发，推导在右删失情况下观测数据 $\\{(t_i,s_i,\\delta_i)\\}_{i=1}^{N}$ 的全似然函数 $L(k,\\lambda,\\beta \\mid \\{(t_i,s_i,\\delta_i)\\}_{i=1}^{N})$。\n\n你的最终答案必须是似然函数关于 $k$、$\\lambda$、$\\beta$ 和数据 $\\{(t_i,s_i,\\delta_i)\\}_{i=1}^{N}$ 的单个闭式解析表达式。无需四舍五入。最终表达式中不要包含单位。",
            "solution": "该问题陈述经评估有效。它具有科学依据，提法恰当，客观，并包含推导所需似然函数的全部必要信息。该问题是参数生存分析中的一个标准练习，这是概率生物力学和可靠性理论中的一个核心课题。因此，我们可以开始进行推导。\n\n目标是为给定的数据和模型推导全似然函数 $L(k,\\lambda,\\beta \\mid \\{(t_i,s_i,\\delta_i)\\}_{i=1}^{N})$。$N$ 个独立样本中每个样本的数据都包含一个时间 $t_i$、一个应力水平 $s_i$ 和一个事件指示符 $\\delta_i$。如果样本在时间 $t_i$ 失效，则指示符 $\\delta_i=1$；如果观测在时间 $t_i$ 被右删失，则 $\\delta_i=0$。\n\n单个观测 $i$ 对总似然函数的贡献取决于它对应的是失效事件还是删失事件。\n- 如果样本在时间 $t_i$ 失效（即 $\\delta_i=1$），其贡献是在该特定时间的失效概率密度，由概率密度函数 (PDF) $f_i(t_i)$ 给出。\n- 如果观测在时间 $t_i$ 被右删失（即 $\\delta_i=0$），这意味着样本至少存活到时间 $t_i$。此事件的概率由生存函数 $S_i(t_i) = \\mathbb{P}(T_i > t_i)$ 给出。\n\n我们可以使用事件指示符 $\\delta_i$ 以紧凑的形式写出单个样本 $i$ 的似然贡献，记为 $L_i$：\n$$L_i(k, \\lambda, \\beta \\mid t_i, s_i, \\delta_i) = [f_i(t_i)]^{\\delta_i} [S_i(t_i)]^{1-\\delta_i}$$\n由于假设样本是独立的，总似然函数 $L$ 是各个贡献的乘积：\n$$L = \\prod_{i=1}^{N} L_i = \\prod_{i=1}^{N} [f_i(t_i)]^{\\delta_i} [S_i(t_i)]^{1-\\delta_i}$$\n问题给出了风险函数的定义，$h_i(t) = f_i(t)/S_i(t)$。我们可以重新整理这个表达式，将 PDF 表示为 $f_i(t) = h_i(t)S_i(t)$。将此代入似然表达式中，可以得到一个等价且通常更方便的形式：\n$$L = \\prod_{i=1}^{N} [h_i(t_i)S_i(t_i)]^{\\delta_i} [S_i(t_i)]^{1-\\delta_i} = \\prod_{i=1}^{N} [h_i(t_i)]^{\\delta_i} [S_i(t_i)]^{\\delta_i + 1 - \\delta_i} = \\prod_{i=1}^{N} [h_i(t_i)]^{\\delta_i} S_i(t_i)$$\n问题陈述了失效时间 $T_i$ 服从威布尔分布，其具有一个恒定的形状参数 $k > 0$ 和一个与应力相关的尺度参数 $\\lambda_i > 0$。对于形状为 $k$、尺度为 $\\lambda_i$ 的威布尔分布，其生存函数 $S_i(t)$ 和风险函数 $h_i(t)$ 由以下公式给出：\n$$S_i(t) = \\exp\\left(-\\left(\\frac{t}{\\lambda_i}\\right)^k\\right)$$\n$$h_i(t) = \\frac{k}{\\lambda_i} \\left(\\frac{t}{\\lambda_i}\\right)^{k-1}$$\n我们将 $S_i(t_i)$ 和 $h_i(t_i)$ 的这些具体形式代入我们的一般似然表达式中：\n$$L = \\prod_{i=1}^{N} \\left[ \\left( \\frac{k}{\\lambda_i} \\left(\\frac{t_i}{\\lambda_i}\\right)^{k-1} \\right)^{\\delta_i} \\exp\\left(-\\left(\\frac{t_i}{\\lambda_i}\\right)^k\\right) \\right]$$\n这可以通过合并风险函数中包含 $\\lambda_i$ 的项来简化：\n$$h_i(t_i) = \\frac{k t_i^{k-1}}{\\lambda_i^k}$$\n似然函数变为：\n$$L = \\prod_{i=1}^{N} \\left[ \\left( \\frac{k t_i^{k-1}}{\\lambda_i^k} \\right)^{\\delta_i} \\exp\\left(-\\frac{t_i^k}{\\lambda_i^k}\\right) \\right]$$\n最后一步是引入加速寿命模型，该模型定义了尺度参数 $\\lambda_i$ 与所施加应力 $s_i$ 之间的关系：\n$$\\lambda_i = \\lambda \\exp(-\\beta s_i)$$\n其中 $\\lambda>0$ 是基准尺度参数，$\\beta$ 是应力敏感性参数。我们需要将其代入似然表达式中。最方便的是代入项 $\\lambda_i^k$：\n$$\\lambda_i^k = (\\lambda \\exp(-\\beta s_i))^k = \\lambda^k \\exp(-k \\beta s_i)$$\n将其代入似然函数，得到关于参数 $k$、$\\lambda$ 和 $\\beta$ 的最终表达式：\n$$L(k, \\lambda, \\beta) = \\prod_{i=1}^{N} \\left\\{ \\left( \\frac{k t_i^{k-1}}{\\lambda^k \\exp(-k \\beta s_i)} \\right)^{\\delta_i} \\exp\\left(-\\frac{t_i^k}{\\lambda^k \\exp(-k \\beta s_i)}\\right) \\right\\}$$\n简化乘积内的各项可得：\n$$L(k, \\lambda, \\beta) = \\prod_{i=1}^{N} \\left\\{ \\left( \\frac{k}{\\lambda^k} t_i^{k-1} \\exp(k \\beta s_i) \\right)^{\\delta_i} \\exp\\left(-\\frac{t_i^k}{\\lambda^k} \\exp(k \\beta s_i)\\right) \\right\\}$$\n这就是在给定观测数据 $\\{(t_i, s_i, \\delta_i)\\}_{i=1}^{N}$ 的情况下，参数 $(k, \\lambda, \\beta)$ 的似然函数的闭式解析表达式。",
            "answer": "$$ \\boxed{ \\prod_{i=1}^{N} \\left\\{ \\left( \\frac{k}{\\lambda^k} t_i^{k-1} \\exp(k \\beta s_i) \\right)^{\\delta_i} \\exp\\left(-\\frac{t_i^k}{\\lambda^k} \\exp(k \\beta s_i)\\right) \\right\\} } $$"
        },
        {
            "introduction": "贝叶斯推断为在不确定性下进行参数估计提供了一个强大的框架，它能够系统地将先验知识与实验数据相结合。本练习将让你深入了解贝叶斯工作流程的核心——马尔可夫链蒙特卡洛 (MCMC) 方法，特别是 Metropolis-Hastings 算法。你将推导决定 MCMC 采样器效率的关键部分——接受率，从而理解如何从后验分布中有效地进行抽样以量化模型参数的不确定性。",
            "id": "4200122",
            "problem": "一个单自由度肌腱段被建模为一个线性弹性元件，其刚度 $k>0$ 通过本构关系 $F = k x$ 将力 $F$ 与伸长量 $x$ 关联起来。在一项实验中，在准静态条件下收集了 $n$ 组独立测量数据 $\\{(x_i, F_i)\\}_{i=1}^{n}$，其中伸长量 $x_i$ 是受控的，而力 $F_i$ 是观测到的。力的测量噪声被建模为独立同分布的高斯噪声：对于每个 $i \\in \\{1,\\dots,n\\}$，\n$$\nF_i = k x_i + \\varepsilon_i,\\quad \\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2),\n$$\n其中噪声标准差 $\\sigma>0$ 已知。刚度的先验分布是对数正态分布：$\\ln k \\sim \\mathcal{N}(\\mu_0,\\sigma_0^2)$，其中超参数 $\\mu_0 \\in \\mathbb{R}$ 和 $\\sigma_0>0$ 已知。考虑一个 Metropolis–Hastings 算法，该算法通过高斯随机游走提议来更新变换后的参数 $\\theta = \\ln k$，\n$$\n\\theta' = \\theta + \\eta,\\quad \\eta \\sim \\mathcal{N}(0, s^2),\n$$\n其中提议尺度 $s>0$，且提议密度在 $\\theta$ 上是对称的。\n\n从 Bayes 定理和上述定义出发，推导从当前状态 $\\theta$ 转移到提议状态 $\\theta'$ 的 Metropolis–Hastings 接受率（即 $\\min(1,\\cdot)$ 中的参数）的精确闭式表达式。你的推导必须正确地考虑参数变换和任何雅可比因子。你的最终答案必须仅用 $(x_i,F_i)_{i=1}^{n}$、$\\sigma$、$\\mu_0$、$\\sigma_0$、$\\theta$ 和 $\\theta'$ 以初等函数形式表示。\n\n然后，讨论为提高效率而进行的提议缩放：在 $\\theta$ 的后验分布在其最大化子 $\\theta^\\ast$ 周圍可以被高斯分布局部地很好近似的假设下，通过计算对数后验在 $\\theta^\\ast$ 处的负二阶导数，推导 $\\theta$ 的后验方差 $V$ 的 Laplace 近似。利用此近似和针对高斯目标的一维随机游走 Metropolis 理论，阐述一个形式为 $s \\approx c^\\ast \\sqrt{V}$ 的有原则的缩放规则，其中 $c^\\ast$ 是一个为平衡探索和接受而选择的常数。用一个刻画了一维高斯目标的期望平方跳跃距离最大化子的优化条件来表示 $c^\\ast$。不要使用任何 $c^\\ast$ 的数值。\n\n你最终报告的答案必须是第一部分中推导出的 Metropolis–Hastings 接受率的单一、精确的解析表达式。该表达式不需要单位。不要提供任何数值近似。",
            "solution": "该问题具有科学依据，是良定的，并提供了求解所需的所有必要信息。它代表了贝叶斯推断和马尔可夫链蒙特卡洛（MCMC）方法在生物力学中一个常见问题上的标准应用。因此，我们可以着手进行推导。\n\n第一个任务是推导 Metropolis-Hastings 算法的接受率。从状态 $\\theta$ 转移到提议状态 $\\theta'$ 的接受概率的一般形式是\n$$\n\\alpha(\\theta, \\theta') = \\min\\left(1, \\frac{\\pi(\\theta'|D) q(\\theta|\\theta')}{\\pi(\\theta|D) q(\\theta'|\\theta)}\\right)\n$$\n其中 $\\pi(\\cdot|D)$ 是给定数据 $D = \\{(x_i, F_i)\\}_{i=1}^{n}$ 的后验分布，而 $q(\\theta'|\\theta)$ 是提议分布。问题指定了一个高斯随机游走提议，$\\theta' = \\theta + \\eta$，其中 $\\eta \\sim \\mathcal{N}(0, s^2)$。$\\eta$ 的密度关于 $0$ 对称，这意味着提议是对称的，即 $q(\\theta'|\\theta) = q(\\theta|\\theta')$。于是接受概率简化为\n$$\n\\alpha(\\theta, \\theta') = \\min\\left(1, \\frac{\\pi(\\theta'|D)}{\\pi(\\theta|D)}\\right)\n$$\n$\\min(1, \\cdot)$ 中的项就是我们要推导的接受率。\n\n根据 Bayes 定理，后验分布正比于似然与先验的乘积：$\\pi(\\theta|D) \\propto p(D|\\theta)p(\\theta)$。因此，接受率为\n$$\n\\frac{\\pi(\\theta'|D)}{\\pi(\\theta|D)} = \\frac{p(D|\\theta')p(\\theta')}{p(D|\\theta)p(\\theta)}\n$$\n我们推导似然 $p(D|\\theta)$ 和先验 $p(\\theta)$ 的表达式。\n\n似然模型由 $F_i = k x_i + \\varepsilon_i$ 给出，其中 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。这意味着每次力的测量值 $F_i$ 都从一个以 $k x_i$ 为中心、方差为 $\\sigma^2$ 的正态分布中抽取：$F_i \\sim \\mathcal{N}(k x_i, \\sigma^2)$。由于测量是独立的，数据 $D$ 的总似然是各个似然的乘积：\n$$\np(D|k) = \\prod_{i=1}^n p(F_i|x_i, k) = \\prod_{i=1}^n \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(F_i - k x_i)^2}{2\\sigma^2}\\right)\n$$\nMCMC 算法对变换后的参数 $\\theta = \\ln k$进行抽样，因此我们必须将似然表示为 $\\theta$ 的函数。通过代入 $k = e^\\theta$，我们得到\n$$\np(D|\\theta) = \\prod_{i=1}^n \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(F_i - e^\\theta x_i)^2}{2\\sigma^2}\\right)\n$$\n先验分布是直接为变换后的参数 $\\theta = \\ln k$指定的，它服从一个正态分布：$\\theta \\sim \\mathcal{N}(\\mu_0, \\sigma_0^2)$。$\\theta$ 的先验概率密度函数是\n$$\np(\\theta) = \\frac{1}{\\sqrt{2\\pi\\sigma_0^2}} \\exp\\left(-\\frac{(\\theta - \\mu_0)^2}{2\\sigma_0^2}\\right)\n$$\n问题陈述要求考虑参数变换和雅可比因子。让我们明确一下。$k$ 的后验是 $\\pi_K(k|D) \\propto p(D|k)\\pi_K(k)$。$k$ 的先验是对数正态分布，所以它的密度是 $\\pi_K(k) = p(\\ln k)|\\frac{d(\\ln k)}{dk}| = p(\\ln k) \\frac{1}{k}$。$\\theta$ 的后验密度可以通过变量替换法则求得：$\\pi_\\Theta(\\theta|D) = \\pi_K(k(\\theta)|D) |\\frac{dk}{d\\theta}|$。由于 $k=e^\\theta$，雅可比因子为 $|\\frac{dk}{d\\theta}| = e^\\theta = k$。因此，$\\pi_\\Theta(\\theta|D) \\propto p(D|k=e^\\theta) \\pi_K(k=e^\\theta) \\cdot k = p(D|e^\\theta) (p(\\theta)\\frac{1}{k}) \\cdot k = p(D|e^\\theta)p(\\theta)$。雅可比因子相互抵消，这证实了我们的 $\\theta$ 的后验分布确实正比于用 $\\theta$ 表示的似然乘以 $\\theta$ 的先验。\n\n现在我们通过取在 $\\theta'$ 和 $\\theta$ 处求值的后验的比值来构建接受率：\n$$\n\\frac{p(D|\\theta')p(\\theta')}{p(D|\\theta)p(\\theta)} = \\frac{\\left(\\prod_{i=1}^n \\exp\\left(-\\frac{(F_i - e^{\\theta'} x_i)^2}{2\\sigma^2}\\right)\\right) \\exp\\left(-\\frac{(\\theta' - \\mu_0)^2}{2\\sigma_0^2}\\right)}{\\left(\\prod_{i=1}^n \\exp\\left(-\\frac{(F_i - e^\\theta x_i)^2}{2\\sigma^2}\\right)\\right) \\exp\\left(-\\frac{(\\theta - \\mu_0)^2}{2\\sigma_0^2}\\right)}\n$$\n常数因子被约去。通过取对数来处理指数部分会更容易。设 $R$ 为接受率。\n$$\n\\ln(R) = \\sum_{i=1}^n \\left(-\\frac{(F_i - e^{\\theta'} x_i)^2}{2\\sigma^2}\\right) - \\frac{(\\theta' - \\mu_0)^2}{2\\sigma_0^2} - \\left[ \\sum_{i=1}^n \\left(-\\frac{(F_i - e^\\theta x_i)^2}{2\\sigma^2}\\right) - \\frac{(\\theta - \\mu_0)^2}{2\\sigma_0^2} \\right]\n$$\n整理各项得到\n$$\n\\ln(R) = \\frac{1}{2\\sigma^2} \\sum_{i=1}^n \\left( (F_i - e^\\theta x_i)^2 - (F_i - e^{\\theta'} x_i)^2 \\right) + \\frac{1}{2\\sigma_0^2} \\left( (\\theta - \\mu_0)^2 - (\\theta' - \\mu_0)^2 \\right)\n$$\n对两边取指数得到接受率的最终表达式：\n$$\nR = \\exp\\left[ \\frac{1}{2\\sigma^2} \\sum_{i=1}^n \\left( (F_i - e^\\theta x_i)^2 - (F_i - e^{\\theta'} x_i)^2 \\right) + \\frac{1}{2\\sigma_0^2} \\left( (\\theta - \\mu_0)^2 - (\\theta' - \\mu_0)^2 \\right) \\right]\n$$\n该表达式仅依赖于指定的变量，并按要求使用初等函数。\n\n任务的第二部分涉及讨论提议缩放。我们使用 Laplace 近似来计算 $\\theta$ 的后验方差。对数后验（忽略一个加性常数）是\n$$\nL(\\theta) = \\ln(\\pi(\\theta|D)) \\propto -\\frac{1}{2\\sigma^2} \\sum_{i=1}^n (F_i - e^\\theta x_i)^2 - \\frac{1}{2\\sigma_0^2} (\\theta - \\mu_0)^2\n$$\n高斯近似的方差 $V$ 是 $L(\\theta)$ 在后验众数 $\\theta^\\ast$ 处的二阶导数的负倒数。一阶导数是\n$$\n\\frac{dL}{d\\theta} = -\\frac{1}{2\\sigma^2} \\sum_{i=1}^n 2(F_i - e^\\theta x_i)(-e^\\theta x_i) - \\frac{1}{2\\sigma_0^2} 2(\\theta - \\mu_0) = \\frac{e^\\theta}{\\sigma^2}\\sum_{i=1}^n (F_i x_i - e^\\theta x_i^2) - \\frac{\\theta - \\mu_0}{\\sigma_0^2}\n$$\n二阶导数是\n$$\n\\frac{d^2L}{d\\theta^2} = \\frac{d}{d\\theta} \\left[ \\frac{1}{\\sigma^2}\\sum_{i=1}^n (F_i x_i e^\\theta - x_i^2 e^{2\\theta}) - \\frac{\\theta - \\mu_0}{\\sigma_0^2} \\right] = \\frac{1}{\\sigma^2}\\sum_{i=1}^n (F_i x_i e^\\theta - 2x_i^2 e^{2\\theta}) - \\frac{1}{\\sigma_0^2}\n$$\n众数 $\\theta^\\ast$ 位于 $dL/d\\theta = 0$ 处。后验方差的倒数，或称精度，是在 $\\theta^\\ast$ 处求值的 $V^{-1} = -d^2L/d\\theta^2$：\n$$\nV^{-1} = -\\frac{d^2L}{d\\theta^2}\\bigg|_{\\theta=\\theta^\\ast} = \\frac{1}{\\sigma_0^2} - \\frac{1}{\\sigma^2}\\sum_{i=1}^n (F_i x_i e^{\\theta^\\ast} - 2x_i^2 e^{2\\theta^\\ast}) = \\frac{1}{\\sigma_0^2} + \\frac{e^{\\theta^\\ast}}{\\sigma^2}\\sum_{i=1}^n (2x_i^2 e^{\\theta^\\ast} - F_i x_i)\n$$\n后验方差的 Laplace 近似为 $V = (V^{-1})^{-1}$。\n\n为了实现高效抽样，应调整提议尺度 $s$。对于目标为高斯分布的一维随机游走 Metropolis 算法，理论建议了一个形式为 $s \\approx c^\\ast \\sqrt{V}$ 的缩放规则，其中 $V$ 是目标方差。常数 $c^\\ast$ 的选择是为了优化抽样器效率的某个度量，通常是期望平方跳跃距离（ESJD）。对于一个标准高斯目标 $\\Phi \\sim \\mathcal{N}(0,1)$ 和一个提议步长 $\\lambda Z$（其中 $Z \\sim \\mathcal{N}(0,1)$ 且独立于 $\\Phi$），ESJD 是 $E[\\alpha(\\Phi, \\lambda Z) (\\lambda Z)^2]$。常数 $c^\\ast$ 是使该量最大化的 $\\lambda=s/\\sqrt{V}$ 的值。因此，定义 $c^\\ast$ 的优化条件是：\n$$\nc^\\ast = \\underset{\\lambda > 0}{\\arg\\max} \\left( \\lambda^2 E_{\\Phi,Z \\sim i.i.d.\\mathcal{N}(0,1)}\\left[\\min\\left(1, \\exp\\left(-\\lambda \\Phi Z - \\frac{(\\lambda Z)^2}{2}\\right)\\right)\\right] \\right)\n$$\n这为基于 Laplace 近似的后验方差 $V$ 来设置提议尺度 $s$ 提供了一个有原则的规则。",
            "answer": "$$\n\\boxed{\\exp\\left[ \\frac{1}{2\\sigma^2} \\sum_{i=1}^n \\left( (F_i - e^\\theta x_i)^2 - (F_i - e^{\\theta'} x_i)^2 \\right) + \\frac{1}{2\\sigma_0^2} \\left( (\\theta - \\mu_0)^2 - (\\theta' - \\mu_0)^2 \\right) \\right]}\n$$"
        }
    ]
}