{
    "hands_on_practices": [
        {
            "introduction": "要理解骨折愈合的计算模型，我们必须首先掌握其核心的生物力学原理。骨折间隙的运动（即应变）是驱动组织分化的关键物理刺激。本练习将指导您通过一个经典且简化的力学模型，来量化由外固定器稳定下的骨折间隙运动，这是构建任何力学生物学模型的基础。",
            "id": "4165501",
            "problem": "考虑一个由外固定器固定的骨干骨折，其被理想化为一个跨越骨折平面的线性弹性载荷分担系统。外固定器被建模为一个梁状结构元件，其沿着近端和远端夹具之间的载荷路径具有等效轴向刚度 $K_f$。骨折断端和早期骨痂提供了一个跨越骨折的残余轴向载荷路径，其等效轴向刚度为 $K_b$。在部分承重期间，通过肢体传递的轴向载荷 $F$ 的作用下，骨折间隙运动被定义为跨越骨折平面的相对轴向位移，记为 $\\delta$。\n\n假设小变形、两条载荷路径均为线性弹性，且处于准静态平衡状态。仅使用基本的生物力学和力学原理，包括静力平衡、运动协调性和线性本构行为，推导一个用 $F$、$K_f$ 和 $K_b$ 表示的 $\\delta$ 的闭式表达式。然后，对于参数 $K_f = 2.5 \\times 10^{6}$、$K_b = 0.8 \\times 10^{6}$ 和 $F = 600$，对 $\\delta$ 进行数值计算。将最终数值结果四舍五入至四位有效数字。以毫米为单位表示最终位移。",
            "solution": "该问题要求推导一个由外固定器固定的骨折中骨折间隙运动 $\\delta$ 的表达式，并对其进行数值计算。该系统被理想化为一个在准静态轴向载荷 $F$ 作用下的线性弹性载荷分担系统。这种力学结构可以建模为两个并联的线性弹簧。一个弹簧代表刚度为 $K_f$ 的外固定器，另一个代表骨折部位的骨和早期骨痂，其刚度为 $K_b$。总施加载荷 $F$ 分配在这两个并联的部件之间。\n\n推导将基于三个基本的力学原理：\n$1$. 运动协调性：两个部件跨越相同的两点（近端和远端骨段）这一几何约束要求它们承受相同的轴向位移。\n$2$. 本构行为：假设每个部件的力与位移之间的关系是线性弹性的。\n$3$. 静力平衡：各部件内力之和必须与外部施加的总载荷相平衡。\n\n设 $F_f$ 是通过外固定器传递的力，$F_b$ 是通过骨/骨痂传递的力。设 $\\delta_f$ 和 $\\delta_b$ 分别是固定器和骨/骨痂的轴向位移。总的骨折间隙运动记为 $\\delta$。\n\n首先，我们应用运动协调性原理。由于固定器和骨骼跨越了相同的骨折间隙，它们的轴向位移必须等于总的骨折间隙运动 $\\delta$。\n$$\n\\delta_f = \\delta_b = \\delta\n$$\n\n接着，我们对每个部件应用线性弹性本构定律（胡克定律）。每个类弹簧元件中的力是其刚度乘以其位移。\n对于外固定器：\n$$\nF_f = K_f \\delta_f = K_f \\delta\n$$\n对于骨和骨痂：\n$$\nF_b = K_b \\delta_b = K_b \\delta\n$$\n\n最后，我们应用静力平衡原理。两条并联路径所承载的力之和必须等于总施加的轴向载荷 $F$。\n$$\nF = F_f + F_b\n$$\n\n将本构关系代入平衡方程，得到：\n$$\nF = K_f \\delta + K_b \\delta\n$$\n\n我们可以提出公共位移项 $\\delta$：\n$$\nF = (K_f + K_b) \\delta\n$$\n\n此方程表明，整个系统的等效刚度 $K_{total}$ 是各部分刚度之和，即 $K_{total} = K_f + K_b$，这是弹簧并联的法则。\n\n求解骨折间隙运动 $\\delta$，我们得到所需的闭式表达式：\n$$\n\\delta = \\frac{F}{K_f + K_b}\n$$\n\n现在，我们进行数值计算。给定的参数是：\n- 施加的轴向载荷, $F = 600$ N。\n- 固定器刚度, $K_f = 2.5 \\times 10^{6}$ N/m。\n- 骨/骨痂刚度, $K_b = 0.8 \\times 10^{6}$ N/m。\n\n我们假设所提供的刚度值单位为国际单位制中的牛顿/米 (N/m)，力单位为牛顿 (N)。计算得到的位移 $\\delta$ 的单位将是米 (m)。\n\n首先，计算系统的总刚度：\n$$\nK_{total} = K_f + K_b = (2.5 \\times 10^{6} + 0.8 \\times 10^{6}) \\, \\text{N/m} = 3.3 \\times 10^{6} \\, \\text{N/m}\n$$\n\n现在，将 $F$ 和 $K_{total}$ 的值代入 $\\delta$ 的表达式中：\n$$\n\\delta = \\frac{600 \\, \\text{N}}{3.3 \\times 10^{6} \\, \\text{N/m}} = \\frac{6}{3.3 \\times 10^{4}} \\, \\text{m}\n$$\n$$\n\\delta = \\frac{6}{33000} \\, \\text{m} = \\frac{2}{11000} \\, \\text{m} \\approx 1.818181... \\times 10^{-4} \\, \\text{m}\n$$\n\n题目要求最终答案以毫米 (mm) 为单位。我们进行单位换算，注意到 $1 \\text{ m} = 1000 \\text{ mm}$：\n$$\n\\delta (\\text{mm}) = \\delta (\\text{m}) \\times 1000 = (1.818181... \\times 10^{-4}) \\times 10^{3} \\, \\text{mm} = 0.1818181... \\, \\text{mm}\n$$\n\n最后，按照指示将数值结果四舍五入到四位有效数字。前四位有效数字是 $1$、$8$、$1$ 和 $8$。第五位有效数字是 $1$，小于 $5$，因此我们向下舍入（即截断）。\n$$\n\\delta \\approx 0.1818 \\, \\text{mm}\n$$",
            "answer": "$$\\boxed{0.1818}$$"
        },
        {
            "introduction": "在确定了力学刺激之后，下一步是模拟组织如何响应并改变其自身属性。骨痂的矿化是愈合过程中的一个关键环节，它显著增加了组织的刚度。本练习将重点关注如何量化这一过程，通过一个公认的幂律关系，将生物学变化（组织密度增加）与力学属性（杨氏模量）联系起来，这展示了在模拟中如何动态更新材料属性。",
            "id": "4165480",
            "problem": "一个关于愈合骨痂的计算模型将局部矿化区域表示为一根在小应变线性弹性条件下的、具有固定横截面积 $A$ 和固定长度 $L$ 的一维均质杆。该杆的轴向刚度 $k$ 由本构关系 $k = E A / L$ 定义，其中 $E$ 是组织的杨氏模量。对于矿化骨组织，源于多孔固体理论且经过充分检验的模量-密度关系表明，$E(\\rho)$ 与相对于完全矿化最大密度 $\\rho_{\\max}$ 的表观密度 $\\rho$ 遵循幂律关系，即 $E(\\rho) = E_{\\max} \\left( \\rho / \\rho_{\\max} \\right)^{n}$，其中 $E_{\\max}$ 是当 $\\rho = \\rho_{\\max}$ 时的杨氏模量， $n$ 是材料指数。假设 $n = 2$，此值适用于多孔矿化骨痂。\n\n在愈合过程中，由于矿物质沉积，建模区域的表观密度在 $4$ 周内从 $\\rho = 0.3 \\rho_{\\max}$ 单调增加到 $\\rho = 0.7 \\rho_{\\max}$。假设轴向刚度以一个恒定的周增长因子 $g$ 呈乘法关系变化，使得 $4$ 周后轴向刚度等于最终密度所对应的值，即 $k_{\\text{final}} = k_{\\text{initial}} \\, g^{4}$。\n\n从这些定义和关系出发，推导 $g$ 的表达式，并根据给定的密度和 $n = 2$ 计算其值。将最终答案表示为一个无量纲的精确值（无需四舍五入）。",
            "solution": "问题要求推导并计算愈合骨痂轴向刚度的恒定周增长因子 $g$。求解过程首先建立轴向刚度 $k$ 和表观密度 $\\rho$ 之间的关系，然后利用给定的初始状态和最终状态来求解 $g$。\n\n轴向刚度 $k$ 由均质杆在轴向载荷下的本构关系定义：\n$$k = \\frac{EA}{L}$$\n其中 $E$ 是杨氏模量，$A$ 是横截面积，$L$ 是长度。\n\n杨氏模量 $E$ 作为表观密度 $\\rho$ 的函数由幂律给出：\n$$E(\\rho) = E_{\\max} \\left( \\frac{\\rho}{\\rho_{\\max}} \\right)^{n}$$\n其中 $E_{\\max}$ 是在最大密度 $\\rho_{\\max}$ 时的模量，$n$ 是材料指数。\n\n通过将 $E(\\rho)$ 的表达式代入 $k$ 的方程中，我们可以将刚度表示为密度的函数：\n$$k(\\rho) = \\frac{A}{L} E(\\rho) = \\frac{A}{L} E_{\\max} \\left( \\frac{\\rho}{\\rho_{\\max}} \\right)^{n}$$\n由于 $A$、$L$、$E_{\\max}$ 和 $\\rho_{\\max}$ 都是常数，我们可以观察到刚度 $k$ 与密度 $\\rho$ 的 $n$ 次方成正比。我们将比例常数表示为 $C = \\frac{A E_{\\max}}{L \\rho_{\\max}^n}$，因此 $k(\\rho) = C \\rho^n$。\n\n问题陈述了密度从初始值 $\\rho_{\\text{initial}} = 0.3 \\rho_{\\max}$ 增加到最终值 $\\rho_{\\text{final}} = 0.7 \\rho_{\\max}$。我们可以使用 $k(\\rho)$ 的关系式来表示初始刚度 $k_{\\text{initial}}$ 和最终刚度 $k_{\\text{final}}$：\n\n对于初始状态：\n$$k_{\\text{initial}} = k(\\rho_{\\text{initial}}) = \\frac{A E_{\\max}}{L} \\left( \\frac{0.3 \\rho_{\\max}}{\\rho_{\\max}} \\right)^{n} = \\frac{A E_{\\max}}{L} (0.3)^{n}$$\n\n对于最终状态：\n$$k_{\\text{final}} = k(\\rho_{\\text{final}}) = \\frac{A E_{\\max}}{L} \\left( \\frac{0.7 \\rho_{\\max}}{\\rho_{\\max}} \\right)^{n} = \\frac{A E_{\\max}}{L} (0.7)^{n}$$\n\n问题还提供了 $4$ 周内刚度增长的模型：\n$$k_{\\text{final}} = k_{\\text{initial}} \\, g^{4}$$\n其中 $g$ 是恒定的周增长因子。\n\n现在我们可以将 $k_{\\text{initial}}$ 和 $k_{\\text{final}}$ 的表达式代入此模型中：\n$$\\frac{A E_{\\max}}{L} (0.7)^{n} = \\left( \\frac{A E_{\\max}}{L} (0.3)^{n} \\right) g^{4}$$\n\n常数项 $\\frac{A E_{\\max}}{L}$ 出现在等式两侧，可以消掉（只要它不为零，这对于杆具有刚度在物理上是必要的）。消掉后得到：\n$$(0.7)^{n} = (0.3)^{n} g^{4}$$\n\n现在我们可以解出 $g$。重新整理方程以分离出 $g^4$：\n$$g^{4} = \\frac{(0.7)^{n}}{(0.3)^{n}} = \\left( \\frac{0.7}{0.3} \\right)^{n} = \\left( \\frac{7}{3} \\right)^{n}$$\n\n为求得 $g$，我们对等式两边取四次方根。由于 $g$ 代表一个增长因子，它必须是一个正实数。\n$$g = \\left( \\left( \\frac{7}{3} \\right)^{n} \\right)^{1/4} = \\left( \\frac{7}{3} \\right)^{n/4}$$\n这个表达式给出了对于任意材料指数 $n$ 的周增长因子 $g$。\n\n问题指明，多孔矿化骨痂的材料指数为 $n = 2$。将此值代入推导出的 $g$ 的表达式中：\n$$g = \\left( \\frac{7}{3} \\right)^{2/4} = \\left( \\frac{7}{3} \\right)^{1/2}$$\n\n因此，周增长因子 $g$ 的最终表达式是比值 $\\frac{7}{3}$ 的平方根。\n$$g = \\sqrt{\\frac{7}{3}}$$",
            "answer": "$$\\boxed{\\sqrt{\\frac{7}{3}}}$$"
        },
        {
            "introduction": "现在，我们将前面练习中的概念整合起来，构建一个完整的骨折愈合计算模型。本练习将指导您从零开始，实现一个二维的迭代算法。您将计算模拟骨痂上的力学刺激场，应用力学调控规则来决定组织分化，并更新模型以反映组织形成与局部力学环境之间的反馈（应力屏蔽），这个综合性练习涵盖了典型计算愈合研究的完整工作流程。",
            "id": "4165532",
            "problem": "您的任务是实现并应用一个机械调节算法到合成的二维骨痂图上，以计算组织表型在 $10$ 次迭代中的演化，并报告最终的骨面积分数。该问题设置在生物力学和骨折愈合的计算建模领域。该算法必须基于连续介质力学和力学生物学的基本原理来构建。\n\n一个二维骨痂域表示为一个 $N_x \\times N_y$ 节点的规则网格，其无量纲坐标为 $(x,y) \\in [0,1]^2$，其中网格节点中心位于 $x_i = \\frac{i + 0.5}{N_x}$ 和 $y_j = \\frac{j + 0.5}{N_y}$，对于 $i \\in \\{0,\\ldots,N_x-1\\}$ 和 $j \\in \\{0,\\ldots,N_y-1\\}$。在每个节点，局部力学状态由偏应变 $e(x,y)$（无量纲）和间质液流速大小 $v(x,y)$（单位为毫米/秒，mm/s）来表征。这些合成场被定义为物理上合理且空间变化的，以模拟愈合中骨痂的承重和灌注模式：\n- 应变场：$e(x,y) = e_{\\text{const}} + e_{\\text{amp}} \\cdot \\max\\left(0, \\sin(\\pi x) \\sin(\\pi y)\\right)$，其中正弦函数的参数以弧度为单位。\n- 流场：$v(x,y) = v_{\\text{const}} + v_{\\text{amp}} \\cdot \\left( \\frac{1 + \\cos(2\\pi x)}{2} \\right) \\left( \\frac{1 + \\cos(2\\pi y)}{2} \\right)$，其中余弦函数的参数以弧度为单位。\n\n力学生物学刺激 $S$ 通过在正交能量等效假设下结合 $e$ 和 $v$ 来定义，这产生一个均方根复合度量：\n$$\nS(x,y) = \\sqrt{\\left(\\frac{e(x,y)}{e_0}\\right)^2 + \\left(\\frac{v(x,y)}{v_0}\\right)^2},\n$$\n其中 $e_0$ 是一个无量纲的参考偏应变，$v_0$ 是一个参考间质液流速大小，单位为毫米/秒（mm/s）。根据阈值 $S_b$ 和 $S_c$，每个节点的组织表型按以下规则分类：\n- 骨表型，如果 $S \\le S_b$，\n- 软骨表型，如果 $S_b  S \\le S_c$，\n- 纤维表型，如果 $S > S_c$。\n\n为了捕捉力学生物学反馈（屏蔽效应），骨的存在会减少后续迭代中的局部力学场。设 $b^{(t)}(x,y) \\in \\{0,1\\}$ 为迭代 $t$ 时的局部骨占据情况，其中 $b^{(t)}(x,y) = 1$ 表示有骨，否则为 $b^{(t)}(x,y) = 0$。在迭代 $t$ 时的有效力学场通过以下方式更新：\n$$\ne^{(t)}(x,y) = e(x,y) \\left(1 - \\alpha\\, b^{(t)}(x,y)\\right), \\quad\nv^{(t)}(x,y) = v(x,y) \\left(1 - \\beta\\, b^{(t)}(x,y)\\right),\n$$\n其中 $\\alpha \\in [0,1]$ 和 $\\beta \\in [0,1]$ 是屏蔽系数，分别在有骨存在时减少局部偏应变和间质液流速。在每次迭代 $t$ 时，使用 $e^{(t)}$ 和 $v^{(t)}$ 在上述定义中计算 $S^{(t)}(x,y)$，对表型进行分类，如果表型是骨，则设置 $b^{(t+1)}(x,y) = 1$，否则设置 $b^{(t+1)}(x,y) = 0$。初始条件 $b^{(0)}(x,y)$ 是一个以 $(0.5,0.5)$ 为中心、半径为 $r_{\\text{seed}}$ 的圆形骨种子，即如果 $\\sqrt{(x - 0.5)^2 + (y - 0.5)^2} \\le r_{\\text{seed}}$，则 $b^{(0)}(x,y) = 1$，否则 $b^{(0)}(x,y) = 0$。\n\n经过 $10$ 次迭代后，计算骨面积分数，即 $b^{(10)}(x,y) = 1$ 的节点数占总节点数的比例。将最终的骨面积分数表示为 $0$ 到 $1$ 之间的小数（浮点数），四舍五入到四位小数。\n\n测试套件和参数集：\n为以下四个测试用例实现算法。对于每个用例，使用指定的参数并返回四舍五入到四位小数的最终骨面积分数。间质液流速参数的单位是毫米/秒（mm/s），而所有应变都是无量纲的。\n\n- 用例 $1$（一般情况）：\n  - $N_x = 64$, $N_y = 64$\n  - $e_{\\text{const}} = 0$, $e_{\\text{amp}} = 0.25$\n  - $v_{\\text{const}} = 0$, $v_{\\text{amp}} = 4.0$\n  - $e_0 = 0.10$, $v_0 = 3.0$\n  - $S_b = 0.30$, $S_c = 0.60$\n  - $\\alpha = 0.40$, $\\beta = 0.20$\n  - $r_{\\text{seed}} = 0.00$\n\n- 用例 $2$（低刺激边界类情况）：\n  - $N_x = 32$, $N_y = 32$\n  - $e_{\\text{const}} = 0$, $e_{\\text{amp}} = 0.05$\n  - $v_{\\text{const}} = 0$, $v_{\\text{amp}} = 1.0$\n  - $e_0 = 0.10$, $v_0 = 3.0$\n  - $S_b = 0.30$, $S_c = 0.60$\n  - $\\alpha = 0.00$, $\\beta = 0.00$\n  - $r_{\\text{seed}} = 0.00$\n\n- 用例 $3$（零流速和强屏蔽的边缘情况）：\n  - $N_x = 64$, $N_y = 64$\n  - $e_{\\text{const}} = 0$, $e_{\\text{amp}} = 0.35$\n  - $v_{\\text{const}} = 0$, $v_{\\text{amp}} = 0.00$\n  - $e_0 = 0.10$, $v_0 = 3.0$\n  - $S_b = 0.30$, $S_c = 0.60$\n  - $\\alpha = 0.70$, $\\beta = 0.50$\n  - $r_{\\text{seed}} = 0.25$\n\n- 用例 $4$（精确阈值测试）：\n  - $N_x = 40$, $N_y = 40$\n  - $e_{\\text{const}} = 0$, $e_{\\text{amp}} = 0.00$\n  - $v_{\\text{const}} = 0.30 \\cdot v_0$, $v_{\\text{amp}} = 0.00$\n  - $e_0 = 0.10$, $v_0 = 3.0$\n  - $S_b = 0.30$, $S_c = 0.60$\n  - $\\alpha = 0.00$, $\\beta = 0.00$\n  - $r_{\\text{seed}} = 0.00$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[0.1234,0.5678,0.0000,1.0000]$），其中每个条目是对应测试用例的最终骨面积分数，四舍五入到四位小数。三角函数的角度必须以弧度处理。骨面积分数必须是无单位的，并表示为小数点后有四位数字的小数。",
            "solution": "该问题要求实现一个用于骨折愈合中机械调节的计算模型。该解决方案建立在生物力学的既定原则之上，即间充质干细胞分化为各种组织表型（骨、软骨、纤维组织）受局部力学环境的支配。该算法在一个代表骨痂的二维网格上，通过离散的迭代次数来模拟组织表型的演化。\n\n**1. 模型构建与离散化**\n\n问题域是一个单位正方形，$(x,y) \\in [0,1]^2$，被离散化为一个 $N_x \\times N_y$ 个节点的规则网格。每个网格单元 $(i,j)$ 的中心位于坐标 $(x_i, y_j)$，其中 $x_i = \\frac{i + 0.5}{N_x}$（对于 $i \\in \\{0, \\dots, N_x-1\\}$）以及 $y_j = \\frac{j + 0.5}{N_y}$（对于 $j \\in \\{0, \\dots, N_y-1\\}$）。这些坐标通过 `numpy.linspace` 和 `numpy.meshgrid` 以编程方式生成二维坐标数组，从而可以对所有空间变化的量进行高效的向量化计算。\n\n**2. 力学刺激场**\n\n每个节点的局部力学环境由两个关键物理量定义：偏（剪切）应变 $e(x,y)$ 和间质液流速 $v(x,y)$。问题提供了合成的、空间变化的场来模拟愈合骨折内复杂的力学行为：\n- 基础偏应变场由以下公式给出：\n$$e(x,y) = e_{\\text{const}} + e_{\\text{amp}} \\cdot \\max\\left(0, \\sin(\\pi x) \\sin(\\pi y)\\right)$$\n该函数模拟了骨痂中心区域（远离刚性边界）的较高应变。\n- 基础间质液流速场为：\n$$v(x,y) = v_{\\text{const}} + v_{\\text{amp}} \\cdot \\left( \\frac{1 + \\cos(2\\pi x)}{2} \\right) \\left( \\frac{1 + \\cos(2\\pi y)}{2} \\right)$$\n使用恒等式 $\\cos^2(\\theta) = \\frac{1+\\cos(2\\theta)}{2}$，该公式可重写为 $v(x,y) = v_{\\text{const}} + v_{\\text{amp}} \\cos^2(\\pi x) \\cos^2(\\pi y)$。该场模拟了在域边界 $(x,y) \\in \\{0,1\\}^2$ 附近有较高流速，而在中心区域流速较低的情况。\n\n这些基础场 $e(x,y)$ 和 $v(x,y)$ 代表了假设骨痂由均一、新生的肉芽组织构成时的力学状态。它们在模拟开始时计算一次，并存储为 $N_x \\times N_y$ 的矩阵。\n\n**3. 机械调节算法**\n\n模型的核心是机械调节规则，它将力学刺激与组织表型联系起来。\n\n- **复合刺激 ($S$)：** 通过结合应变和流体流动来计算单一的力学生物学刺激 $S(x,y)$。该公式假设每个力学因素在通过参考值 $e_0$ 和 $v_0$ 进行归一化后，贡献是正交且能量等效的：\n$$\nS(x,y) = \\sqrt{\\left(\\frac{e(x,y)}{e_0}\\right)^2 + \\left(\\frac{v(x,y)}{v_0}\\right)^2}\n$$\n- **表型分类：** 每个节点的组织表型通过将局部刺激 $S$ 与两个阈值 $S_b$ 和 $S_c$ 进行比较来确定：\n  - 骨：$S \\le S_b$（低刺激有利于稳定、坚硬的骨形成）。\n  - 软骨：$S_b  S \\le S_c$（中等刺激有利于软骨形成）。\n  - 纤维组织：$S > S_c$（高刺激导致纤维组织，可能抑制愈合）。\n\n**4. 带有力学生物学反馈的迭代模拟**\n\n组织演化是一个动态过程。随着骨的形成，它比周围的软组织要硬得多，导致它承受更多的载荷，并“屏蔽”邻近区域免受力学刺激。这种反馈对于愈合模式至关重要，例如从外骨痂到最终重塑的进展。该算法通过一个包含 $10$ 个离散时间步的迭代方案来捕捉这一点。\n\n- **状态变量：** 骨的存在由一个二值图 $b^{(t)}(x,y)$ 跟踪，其中 $b^{(t)}=1$ 表示在迭代 $t$ 时有骨，而 $b^{(t)}=0$ 表示其他组织。\n- **初始条件 ($t=0$)：** 模拟从一个初始的骨分布 $b^{(0)}(x,y)$ 开始。这被定义为一个以 $(0.5, 0.5)$ 为中心、半径为 $r_{\\text{seed}}$ 的圆形种子：\n$$b^{(0)}(x,y) = 1 \\quad \\text{if} \\quad \\sqrt{(x - 0.5)^2 + (y - 0.5)^2} \\le r_{\\text{seed}}$$\n- **迭代更新循环 (对于 $t = 0, \\dots, 9$):**\n  1. **刺激屏蔽：** 当前迭代的有效力学场 $e^{(t)}$ 和 $v^{(t)}$ 是通过在有骨存在的位置（即 $b^{(t)}(x,y)=1$ 的位置）减小基础场来计算的。减小的程度由屏蔽系数 $\\alpha, \\beta \\in [0,1]$ 控制：\n     $$e^{(t)}(x,y) = e(x,y) \\left(1 - \\alpha\\, b^{(t)}(x,y)\\right)$$\n     $$v^{(t)}(x,y) = v(x,y) \\left(1 - \\beta\\, b^{(t)}(x,y)\\right)$$\n     在实现中，这是基础场矩阵与从 $b^{(t)}$ 导出的屏蔽因子矩阵之间的向量化逐元素相乘。\n  2. **刺激计算：** 使用有效场 $e^{(t)}$ 和 $v^{(t)}$ 计算当前迭代的刺激 $S^{(t)}(x,y)$。\n  3. **表型更新：** 将骨形成规则应用于当前刺激图 $S^{(t)}$，以确定下一次迭代的骨图 $b^{(t+1)}(x,y)$：\n     $$b^{(t+1)}(x,y) = 1 \\quad \\text{if} \\quad S^{(t)}(x,y) \\le S_b, \\quad \\text{else} \\quad 0$$\n     这通过布尔比较 `S_t = Sb` 来实现，它产生一个布尔数组，然后将其转换为由 $0.0$ 和 $1.0$ 组成的浮点数组，用于下一次迭代。\n\n**5. 最终输出计算**\n\n经过 $10$ 次完整迭代后，模拟终止。骨图的最终状态是 $b^{(10)}(x,y)$。所需的输出指标是骨面积分数，即被分类为骨的节点数与网格中总节点数的比率。这被计算为最终骨图矩阵 $b^{(10)}$ 的平均值：\n$$ \\text{骨面积分数} = \\frac{\\sum_{i,j} b^{(10)}(x_i, y_j)}{N_x N_y} = \\text{mean}(b^{(10)}) $$\n整个过程被封装在一个函数中，并针对问题陈述中指定的四个参数集中的每一个运行。最终结果被收集并格式化为四位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(Nx, Ny, e_const, e_amp, v_const, v_amp, e0, v0, Sb, alpha, beta, r_seed):\n    \"\"\"\n    Runs a single mechanoregulation simulation for the given parameters.\n    \"\"\"\n    num_iterations = 10\n\n    # 1. Initialize Grid\n    # Create 1D coordinate arrays for node centers\n    x_coords = (np.arange(Nx) + 0.5) / Nx\n    y_coords = (np.arange(Ny) + 0.5) / Ny\n    # Create 2D coordinate matrices\n    X, Y = np.meshgrid(x_coords, y_coords, indexing='ij')\n\n    # 2. Calculate Base Mechanical Fields\n    # Base strain field\n    e_base = e_const + e_amp * np.maximum(0, np.sin(np.pi * X) * np.sin(np.pi * Y))\n    \n    # Base fluid velocity field\n    # Using the identity (1 + cos(2t))/2 = cos(t)^2\n    v_base = v_const + v_amp * (np.cos(np.pi * X)**2) * (np.cos(np.pi * Y)**2)\n\n    # 3. Initialize Bone Occupancy Map b^(0)\n    if r_seed > 0.0:\n        # Distance squared from the center (0.5, 0.5)\n        dist_sq = (X - 0.5)**2 + (Y - 0.5)**2\n        b = (dist_sq = r_seed**2).astype(float)\n    else:\n        b = np.zeros((Nx, Ny), dtype=float)\n\n    # 4. Iterative Loop for num_iterations\n    for _ in range(num_iterations):\n        # a. Update effective fields based on bone shielding from previous step\n        e_t = e_base * (1.0 - alpha * b)\n        v_t = v_base * (1.0 - beta * b)\n\n        # b. Calculate the mechanobiological stimulus S^(t)\n        # We can safely assume e0 and v0 are non-zero based on the problem.\n        S_t = np.sqrt(np.square(e_t / e0) + np.square(v_t / v0))\n        \n        # c. Update bone map for the next iteration b^(t+1)\n        # Bone forms where stimulus is less than or equal to the bone threshold Sb.\n        b = (S_t = Sb).astype(float)\n\n    # 5. Final Calculation\n    # The loop has run 10 times, so 'b' now represents b^(10).\n    # Bone area fraction is the mean of the final 0/1 bone map.\n    bone_area_fraction = np.mean(b)\n    \n    return bone_area_fraction\n\ndef solve():\n    \"\"\"\n    Defines the test cases and computes the result for each.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: general case\n        {\"Nx\": 64, \"Ny\": 64, \"e_const\": 0.0, \"e_amp\": 0.25, \"v_const\": 0.0, \"v_amp\": 4.0, \n         \"e0\": 0.10, \"v0\": 3.0, \"Sb\": 0.30, \"alpha\": 0.40, \"beta\": 0.20, \"r_seed\": 0.00},\n        \n        # Case 2: low-stimulus boundary-like case\n        {\"Nx\": 32, \"Ny\": 32, \"e_const\": 0.0, \"e_amp\": 0.05, \"v_const\": 0.0, \"v_amp\": 1.0, \n         \"e0\": 0.10, \"v0\": 3.0, \"Sb\": 0.30, \"alpha\": 0.00, \"beta\": 0.00, \"r_seed\": 0.00},\n        \n        # Case 3: edge case with zero flow and strong shielding\n        {\"Nx\": 64, \"Ny\": 64, \"e_const\": 0.0, \"e_amp\": 0.35, \"v_const\": 0.0, \"v_amp\": 0.00, \n         \"e0\": 0.10, \"v0\": 3.0, \"Sb\": 0.30, \"alpha\": 0.70, \"beta\": 0.50, \"r_seed\": 0.25},\n        \n        # Case 4: exact-threshold test\n        {\"Nx\": 40, \"Ny\": 40, \"e_const\": 0.0, \"e_amp\": 0.00, \"v_const\": 0.30 * 3.0, \"v_amp\": 0.00, \n         \"e0\": 0.10, \"v0\": 3.0, \"Sb\": 0.30, \"alpha\": 0.00, \"beta\": 0.00, \"r_seed\": 0.00},\n    ]\n\n    results = []\n    for params in test_cases:\n        # The 'Sc' parameter is not used in the bone formation calculation, so it's omitted from the call.\n        result = run_simulation(\n            Nx=params[\"Nx\"], Ny=params[\"Ny\"], e_const=params[\"e_const\"], e_amp=params[\"e_amp\"],\n            v_const=params[\"v_const\"], v_amp=params[\"v_amp\"], e0=params[\"e0\"], v0=params[\"v0\"],\n            Sb=params[\"Sb\"], alpha=params[\"alpha\"], beta=params[\"beta\"], r_seed=params[\"r_seed\"]\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.4f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}