{
    "hands_on_practices": [
        {
            "introduction": "个体化模型的准确性在很大程度上取决于医学影像等输入数据的质量。本练习将通过一个具体案例，向您展示动脉半径分割中的一个微小系统性误差，如何导致血流预测出现巨大的、具有临床意义的偏差。通过运用经典的哈根-泊肃叶方程 (Hagen-Poiseuille equation)，您将亲身体会到模型对输入数据的敏感性，并理解精确几何重建在血管生物力学中的关键作用 ``。",
            "id": "4198129",
            "problem": "一个用于血管生物力学的患者特异性计算流程被用来为一位外周动脉疾病患者规划治疗方案。通过血管内超声测量的一段笔直、刚性的动脉段的真实管腔半径为 $r_{\\mathrm{true}}=4.0~\\mathrm{mm}$。然而，由于系统性的成像分割偏差，模型中重建的管腔边界在整个横截面上均勻地向外径向偏移了 $b=1.0~\\mathrm{mm}$，因此模型使用的半径为 $r_{\\mathrm{seg}}=r_{\\mathrm{true}}+b$。血液被建模为不可压缩的牛顿流体，其动力粘度为 $\\mu=3.5\\times 10^{-3}~\\mathrm{Pa}\\cdot\\mathrm{s}$。血液在两端施加的固定压降 $\\Delta P$ 下，稳态且轴对称地流过长度为 $L=0.20~\\mathrm{m}$ 的圆柱形管段。\n\n从直圆管中粘性流的控制平衡定律和横截面积的几何定义出发，推导液阻如何依赖于半径，并量化当施加均匀径向偏移 $b$ 时，横截面积和液阻的倍数变化。然后，利用推导出的关系，计算在固定压降 $\\Delta P$ 的情况下，由于使用 $r_{\\mathrm{seg}}$ 代替 $r_{\\mathrm{true}}$ 所导致的体积流量的百分比变化。\n\n将百分比变化表示为小数（例如，百分之五表示为 $0.05$），并将最终答案四舍五入到四位有效数字。最终答案中不包含任何单位。",
            "solution": "该问题在科学上是适定的，并包含足够的信息以获得唯一解。对动脉段中流动的分析基于不可压缩牛顿流体在刚性圆管中进行稳态、轴对称、充分发展的层流的流体动力学原理。这由哈根-泊肃叶方程所描述。\n\n首先，我们建立体积流量 $Q$、压降 $\\Delta P$ 与管道几何形状之间的关系。此类流动的速度分布是抛物线形的，由 $u(r) = \\frac{\\Delta P}{4\\mu L}(R^{2} - r^{2})$ 给出，其中 $R$ 是管道的内半径， $L$ 是其长度，$\\mu$ 是流体的动力粘度， $r$ 是径向坐标。体积流量 $Q$ 通过将此速度分布在横截面积 $A$ 上积分得到：\n$$Q = \\int_{A} u(r) dA = \\int_{0}^{R} \\frac{\\Delta P}{4\\mu L}(R^{2} - r^{2}) (2\\pi r) dr$$\n$$Q = \\frac{2\\pi \\Delta P}{4\\mu L} \\int_{0}^{R} (R^{2}r - r^{3}) dr = \\frac{\\pi \\Delta P}{2\\mu L} \\left[ \\frac{R^{2}r^{2}}{2} - \\frac{r^{4}}{4} \\right]_{0}^{R}$$\n这就得到了哈根-泊肃叶方程：\n$$Q = \\frac{\\pi R^{4} \\Delta P}{8\\mu L}$$\n液阻 $R_h$ 通过类比欧姆定律 $\\Delta P = Q R_h$ 来定义。从哈根-泊肃叶方程，我们可以推导出 $R_h$ 的表达式：\n$$R_h = \\frac{\\Delta P}{Q} = \\frac{8\\mu L}{\\pi R^{4}}$$\n这个推导表明，液阻与半径的四次方成反比，即 $R_h \\propto R^{-4}$。\n\n问题描述了这样一个场景：真实半径 $r_{\\mathrm{true}} = 4.0~\\mathrm{mm}$ 由于系统性的向外偏差 $b = 1.0~\\mathrm{mm}$ 而被错误测量，导致分割后的半径为 $r_{\\mathrm{seg}} = r_{\\mathrm{true}} + b$。我们被要求量化这个误差的影响。\n\n我们首先确定横截面积的倍数变化。面积 $A$ 由 $A = \\pi r^{2}$ 给出。\n真实面积为 $A_{\\mathrm{true}} = \\pi r_{\\mathrm{true}}^{2}$。\n分割后的面积为 $A_{\\mathrm{seg}} = \\pi r_{\\mathrm{seg}}^{2} = \\pi (r_{\\mathrm{true}} + b)^{2}$。\n面积的倍数变化是比率 $\\frac{A_{\\mathrm{seg}}}{A_{\\mathrm{true}}}$：\n$$\\frac{A_{\\mathrm{seg}}}{A_{\\mathrm{true}}} = \\frac{\\pi (r_{\\mathrm{true}} + b)^{2}}{\\pi r_{\\mathrm{true}}^{2}} = \\left(\\frac{r_{\\mathrm{true}} + b}{r_{\\mathrm{true}}}\\right)^{2} = \\left(1 + \\frac{b}{r_{\\mathrm{true}}}\\right)^{2}$$\n\n接下来，我们确定液阻的倍数变化。根据推导出的公式，$R_h \\propto r^{-4}$。\n真实阻力为 $R_{h, \\mathrm{true}} = \\frac{8\\mu L}{\\pi r_{\\mathrm{true}}^{4}}$。\n从分割模型计算出的阻力为 $R_{h, \\mathrm{seg}} = \\frac{8\\mu L}{\\pi r_{\\mathrm{seg}}^{4}} = \\frac{8\\mu L}{\\pi (r_{\\mathrm{true}} + b)^{4}}$。\n阻力的倍数变化是比率 $\\frac{R_{h, \\mathrm{seg}}}{R_{h, \\mathrm{true}}}$：\n$$\\frac{R_{h, \\mathrm{seg}}}{R_{h, \\mathrm{true}}} = \\frac{8\\mu L / (\\pi (r_{\\mathrm{true}} + b)^{4})}{8\\mu L / (\\pi r_{\\mathrm{true}}^{4})} = \\frac{r_{\\mathrm{true}}^{4}}{(r_{\\mathrm{true}} + b)^{4}} = \\left(\\frac{r_{\\mathrm{true}}}{r_{\\mathrm{true}} + b}\\right)^{4} = \\left(1 + \\frac{b}{r_{\\mathrm{true}}}\\right)^{-4}$$\n\n最后，我们计算在固定压降 $\\Delta P$ 下，体积流量 $Q$ 的最终百分比变化。基于真实半径的流量为 $Q_{\\mathrm{true}} = \\frac{\\Delta P}{R_{h, \\mathrm{true}}}$，而使用分割半径的模型预测的流量为 $Q_{\\mathrm{seg}} = \\frac{\\Delta P}{R_{h, \\mathrm{seg}}}$。百分比变化定义为 $\\frac{Q_{\\mathrm{seg}} - Q_{\\mathrm{true}}}{Q_{\\mathrm{true}}}$。\n这可以表示为：\n$$\\frac{Q_{\\mathrm{seg}} - Q_{\\mathrm{true}}}{Q_{\\mathrm{true}}} = \\frac{Q_{\\mathrm{seg}}}{Q_{\\mathrm{true}}} - 1$$\n由于 $Q = \\Delta P / R_h$ 且 $\\Delta P$ 是恒定的，流量之比是阻力之比的倒数：\n$$\\frac{Q_{\\mathrm{seg}}}{Q_{\\mathrm{true}}} = \\frac{\\Delta P / R_{h, \\mathrm{seg}}}{\\Delta P / R_{h, \\mathrm{true}}} = \\frac{R_{h, \\mathrm{true}}}{R_{h, \\mathrm{seg}}} = \\frac{1}{(1 + \\frac{b}{r_{\\mathrm{true}}})^{-4}} = \\left(1 + \\frac{b}{r_{\\mathrm{true}}}\\right)^{4}$$\n因此，流量的百分比变化是：\n$$\\text{百分比变化} = \\left(1 + \\frac{b}{r_{\\mathrm{true}}}\\right)^{4} - 1$$\n现在，我们代入给定的数值：$r_{\\mathrm{true}} = 4.0~\\mathrm{mm}$ 和 $b = 1.0~\\mathrm{mm}$。在这个比率中，单位相互抵消。\n$$\\text{百分比变化} = \\left(1 + \\frac{1.0}{4.0}\\right)^{4} - 1 = (1 + 0.25)^{4} - 1 = (1.25)^{4} - 1$$\n计算该值：\n$$(1.25)^{2} = 1.5625$$\n$$(1.25)^{4} = (1.5625)^{2} = 2.44140625$$\n$$\\text{百分比变化} = 2.44140625 - 1 = 1.44140625$$\n问题要求答案以小数形式表示，并四舍五入到四位有效数字。\n$$\\text{百分比变化} \\approx 1.441$$\n这表明，半径的 $1.0~\\mathrm{mm}$ 系统性高估导致体积流量被高估了大约 $144.1\\%$。",
            "answer": "$$\\boxed{1.441}$$"
        },
        {
            "introduction": "除了几何形状，生物组织的力学行为是构建预测模型的另一个关键。本练习要求您从第一性原理出发，为一种常见的软组织模型推导其应力-应变关系。这项实践将巩固您对非线性连续介质力学和超弹性理论的理解，这些是大多数固体生物力学模拟的理论基石，对于为动脉壁或心脏组织等开发或定制本构模型至关重要 ``。",
            "id": "4198117",
            "problem": "考虑一个针对横观各向同性软组织的患者特异性超弹性模型，该组织具有单一纤维族，其中参考构型中的纤维方向 $\\boldsymbol{a}_0$ 通过成像（例如，扩散张量磁共振成像）获得，并作为个性化输入。令变形梯度为 $\\boldsymbol{F}$，右 Cauchy-Green 张量为 $\\boldsymbol{C} = \\boldsymbol{F}^{\\top}\\boldsymbol{F}$，左 Cauchy-Green 张量为 $\\boldsymbol{B} = \\boldsymbol{F}\\boldsymbol{F}^{\\top}$，当前纤维方向为 $\\boldsymbol{m} = \\boldsymbol{F}\\boldsymbol{a}_0$。假设组织是不可压缩的，因此 $J = \\det(\\boldsymbol{F}) = 1$，且等容纤维不变量等于结构不变量 $\\,\\bar{I}_4 = I_4 = \\boldsymbol{a}_0 \\cdot \\boldsymbol{C}\\boldsymbol{a}_0 = \\boldsymbol{m} \\cdot \\boldsymbol{m}\\,$。令应变能密度为\n$$\nW = C_{10}\\,(I_1 - 3) + \\frac{k_1}{2k_2}\\left(\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right] - 1\\right),\n$$\n其中 $I_1 = \\operatorname{tr}(\\boldsymbol{C})$，$C_{10}  0$ 表征各向同性基质的响应，$k_1  0$ 和 $k_2  0$ 表征纤维增强效果，所有这些参数都需要进行患者特异性校准。\n\n从超弹性和不可压缩性的第一性原理出发，推导 Cauchy 应力张量 $\\boldsymbol{\\sigma}$，使其表示为不变量和纤维方向的闭式表达式。您的推导必须从基本定义和能量函数 $W$ 开始，并且不得假定任何预先推导出的应力公式。最终结果仅用符号 $C_{10}$、$k_1$、$k_2$、$\\bar{I}_4$、$\\boldsymbol{B}$、$\\boldsymbol{m}$、$\\boldsymbol{I}$ 以及用于强制实施不可压缩性的拉格朗日乘子 $p$ 来表示。最终答案必须是单一的解析表达式。不需要进行数值计算。",
            "solution": "合适的出发点是超弹性原理，该原理指出应力源于应变能密度对应变度量的变化。对于不可压缩的超弹性材料，右 Cauchy-Green 张量 $\\boldsymbol{C}$ 是一个合适的应变度量，而第二 Piola-Kirchhoff 应力 $\\boldsymbol{S}$ 可通过使用拉格朗日乘子 $p$ 强制实施不可压缩性的约束能量泛函得到。具体来说，本构关系为\n$$\n\\boldsymbol{S} = -p\\,\\boldsymbol{C}^{-1} + 2\\,\\frac{\\partial W}{\\partial \\boldsymbol{C}}.\n$$\n然后通过前推 $\\boldsymbol{S}$ 得到 Cauchy 应力 $\\boldsymbol{\\sigma}$：\n$$\n\\boldsymbol{\\sigma} = \\frac{1}{J}\\,\\boldsymbol{F}\\,\\boldsymbol{S}\\,\\boldsymbol{F}^{\\top}.\n$$\n在不可压缩假设 $J=1$ 下，该式简化为\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{F}\\,\\boldsymbol{S}\\,\\boldsymbol{F}^{\\top}.\n$$\n\n接下来，我们根据 $W$ 所依赖的不变量，通过链式法则计算 $\\partial W/\\partial \\boldsymbol{C}$。给定的应变能密度为\n$$\nW(I_1,\\bar{I}_4) = C_{10}\\,(I_1 - 3) + \\frac{k_1}{2k_2}\\left(\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right] - 1\\right),\n$$\n其中 $I_1 = \\operatorname{tr}(\\boldsymbol{C})$，并且在不可压缩条件下，$\\bar{I}_4 = I_4 = \\boldsymbol{a}_0 \\cdot \\boldsymbol{C}\\boldsymbol{a}_0$。$W$ 对 $\\boldsymbol{C}$ 的微分为\n$$\n\\frac{\\partial W}{\\partial \\boldsymbol{C}} = \\frac{\\partial W}{\\partial I_1}\\,\\frac{\\partial I_1}{\\partial \\boldsymbol{C}} + \\frac{\\partial W}{\\partial \\bar{I}_4}\\,\\frac{\\partial \\bar{I}_4}{\\partial \\boldsymbol{C}}.\n$$\n我们分别计算各项：\n\n1. 对于第一不变量，\n$$\n\\frac{\\partial I_1}{\\partial \\boldsymbol{C}} = \\boldsymbol{I},\n$$\n其中 $\\boldsymbol{I}$ 是单位张量，且\n$$\n\\frac{\\partial W}{\\partial I_1} = C_{10}.\n$$\n\n2. 对于不可压缩条件下的纤维不变量，\n$$\n\\bar{I}_4 = I_4 = \\boldsymbol{a}_0 \\cdot \\boldsymbol{C}\\boldsymbol{a}_0,\n$$\n其张量导数为\n$$\n\\frac{\\partial \\bar{I}_4}{\\partial \\boldsymbol{C}} = \\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0.\n$$\n$W$ 对 $\\bar{I}_4$ 的标量导数为\n$$\n\\frac{\\partial W}{\\partial \\bar{I}_4} = \\frac{k_1}{2k_2}\\,\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right] \\cdot \\frac{d}{d\\bar{I}_4}\\left(k_2(\\bar{I}_4 - 1)^2\\right) = k_1\\,(\\bar{I}_4 - 1)\\,\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right].\n$$\n\n将这些项组合起来，\n$$\n\\frac{\\partial W}{\\partial \\boldsymbol{C}} = C_{10}\\,\\boldsymbol{I} + k_1\\,(\\bar{I}_4 - 1)\\,\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right]\\,(\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0).\n$$\n因此，第二 Piola-Kirchhoff 应力为\n$$\n\\boldsymbol{S} = -p\\,\\boldsymbol{C}^{-1} + 2\\,C_{10}\\,\\boldsymbol{I} + 2\\,k_1\\,(\\bar{I}_4 - 1)\\,\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right]\\,(\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0).\n$$\n\n现在我们前推 $\\boldsymbol{S}$ 以获得 Cauchy 应力。使用 $\\boldsymbol{\\sigma} = \\boldsymbol{F}\\,\\boldsymbol{S}\\,\\boldsymbol{F}^{\\top}$ 并回顾恒等式 $\\boldsymbol{F}\\,\\boldsymbol{C}^{-1}\\,\\boldsymbol{F}^{\\top} = \\boldsymbol{I}$ (因为 $\\boldsymbol{C} = \\boldsymbol{F}^{\\top}\\boldsymbol{F}$)、$\\boldsymbol{F}\\,\\boldsymbol{I}\\,\\boldsymbol{F}^{\\top} = \\boldsymbol{B}$ 以及 $\\boldsymbol{F}\\,(\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0)\\,\\boldsymbol{F}^{\\top} = (\\boldsymbol{F}\\boldsymbol{a}_0)\\otimes(\\boldsymbol{F}\\boldsymbol{a}_0) = \\boldsymbol{m} \\otimes \\boldsymbol{m}$，我们得到\n$$\n\\boldsymbol{\\sigma} = -p\\,\\boldsymbol{I} + 2\\,C_{10}\\,\\boldsymbol{B} + 2\\,k_1\\,(\\bar{I}_4 - 1)\\,\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right]\\,(\\boldsymbol{m} \\otimes \\boldsymbol{m}).\n$$\n\n该表达式以不变量 $I_1$ 和 $\\bar{I}_4$（通过它们在系数中的出现）和结构张量 $\\boldsymbol{B}$ 与 $\\boldsymbol{m}\\otimes\\boldsymbol{m}$ 的形式给出了 Cauchy 应力，其中 $p$ 强制实施不可压缩性。该表达式可直接应用于患者特异性建模，因为纤维方向 $\\boldsymbol{a}_0$（以及因此的 $\\boldsymbol{m}$ 和 $\\bar{I}_4$）和材料参数 $C_{10}$、$k_1$、$k_2$ 都是使用患者特异性数据进行校准的。",
            "answer": "$$\\boxed{-p\\,\\boldsymbol{I} + 2\\,C_{10}\\,\\boldsymbol{B} + 2\\,k_1\\,(\\bar{I}_4 - 1)\\,\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right]\\,(\\boldsymbol{m} \\otimes \\boldsymbol{m})}$$"
        },
        {
            "introduction": "一个真正意义上的个体化模型，其参数必须根据患者的个体数据进行校准。这最后一个练习模拟了一个真实场景：您不仅需要从带噪声的测量数据中估计材料参数，更关键的是，您还需要评估这些估计值的可信度。通过实施剖面似然分析 (profile likelihood analysis)，您将学习一种强大的技术来量化模型参数的“实际可识别性”，从而将数据质量与预测置信度直接联系起来。这项练习弥合了理论模型与个性化医疗实践应用之间的鸿沟，在个性化医疗中，理解不确定性至关重要 ``。",
            "id": "4198157",
            "problem": "您的任务是利用带有加性噪声的压力-直径测量数据，为个性化医疗构建患者特异性动脉壁模型。您必须从生物力学第一性原理出发，利用薄壁平衡和指数型本构关系，推导出从直径到压力的映射关系，然后实现一个剖面似然分析，以评估两个刚度参数的实际可辨识性。您的最终程序必须为三个测试用例模拟数据、拟合模型、计算每个参数的剖面似然，并报告量化可辨识性的置信区间宽度。\n\n从以下基本原理开始：\n\n- 薄壁环向平衡（Laplace 定律）：环向 Cauchy 应力与血压之间的关系为 $$\\sigma_{\\theta} = \\frac{P R}{h},$$ 其中 $P$ 是血压，$R$ 是变形后血管的半径，$h$ 是管壁厚度。该平衡适用于管壁厚度相对于半径较小的动脉。\n\n- Green-Lagrange 环向应变定义： $$E_{\\theta} = \\frac{1}{2}(\\lambda_{\\theta}^2 - 1), \\quad \\lambda_{\\theta} = \\frac{D}{D_0},$$ 其中 $D$ 是变形后的直径，$D_0$ 是参考直径。\n\n- 具有两个未知刚度参数的指数型应力-应变关系（Fung 型）： $$\\sigma_{\\theta}(E_{\\theta}; a,b) = a \\, \\exp(b \\, E_{\\theta}),$$ 其中 $a$ 的单位是应力，$b$ 是无量纲的。\n\n假设观测到的压力是由正向模型加上方差未知的独立同分布加性高斯噪声生成的。给定测量值 $\\{(D_i, P_i^{\\text{obs}})\\}_{i=1}^{n}$，观测模型为 $$P_i^{\\text{obs}} = P(D_i; a,b) + \\varepsilon_i, \\quad \\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2),$$ 其中 $\\sigma^2$ 是（未知的）噪声方差，$P(D_i; a,b)$ 是从推导出的平衡关系得到的、在直径 $D_i$ 时模型所蕴含的压力。\n\n您必须：\n1. 从给定的基本原理出发，不走捷径，推导出 $P(D;a,b)$ 作为 $D$、$a$、$b$、$D_0$ 和 $h$ 的函数表达式。\n2. 使用浓缩掉方差的高斯似然来定义每个参数的剖面似然。令残差平方和为 $$\\mathrm{SSE}(a,b) = \\sum_{i=1}^{n} \\left(P_i^{\\text{obs}} - P(D_i; a,b)\\right)^2.$$ 最大似然估计（maximum likelihood estimate, MLE）$(\\hat{a},\\hat{b})$ 使 $\\mathrm{SSE}(a,b)$ 最小化。对于一个固定的 $a$ 值（或 $b$ 值），定义剖面残差平方和 $$\\mathrm{SSE}_a(a) = \\min_{b0} \\mathrm{SSE}(a,b), \\quad \\mathrm{SSE}_b(b) = \\min_{a0} \\mathrm{SSE}(a,b).$$ 使用浓缩高斯似然，单个剖面参数的似然比统计量为 $$\\Delta_a(a) = n \\, \\ln\\!\\left(\\frac{\\mathrm{SSE}_a(a)}{\\mathrm{SSE}(\\hat{a},\\hat{b})}\\right), \\quad \\Delta_b(b) = n \\, \\ln\\!\\left(\\frac{\\mathrm{SSE}_b(b)}{\\mathrm{SSE}(\\hat{a},\\hat{b})}\\right).$$ 在正则性条件下，$\\Delta_a$ 和 $\\Delta_b$ 近似服从自由度为 1 的卡方（chi-square）分布的随机变量。将每个参数的置信区间定义为剖面统计量不超过自由度为 1、置信水平为 $0.95$ 的卡方分位数的值的集合。\n3. 实现一个程序，在指定的网格上计算剖面似然和相应的置信区间，并报告每个参数的置信区间宽度。在每个测试用例中，将 $D_0$ 和 $h$ 视为已知的患者特异性常数，并在优化过程中强制施加正值约束 $a0$ 和 $b0$。\n\n物理和数值单位：\n- 压力 $P$ 必须以千帕（kPa）为单位。\n- 直径 $D$ 和厚度 $h$ 必须以毫米（mm）为单位。\n- 报告 $a$ 的置信区间宽度（单位：千帕，kPa）和 $b$ 的置信区间宽度（无量纲数），均四舍五入到六位小数。\n\n测试套件规范：\n- 测试用例 1（信息充分，低噪声）：\n  - 参考直径 $D_0 = 10$ mm，壁厚 $h = 1$ mm。\n  - 真实参数 $a_{\\text{true}} = 120$ kPa, $b_{\\text{true}} = 6$。\n  - 直径 $D_i$ 在 $8$ mm 到 $12$ mm 之间均匀分布，共 $n = 30$ 个点。\n  - 噪声标准差 $\\sigma = 2$ kPa。\n  - 随机种子为 $123$ 以确保可复现性。\n- 测试用例 2（直径范围窄，高噪声）：\n  - 参考直径 $D_0 = 10$ mm，壁厚 $h = 1$ mm。\n  - 真实参数 $a_{\\text{true}} = 120$ kPa, $b_{\\text{true}} = 6$。\n  - 直径 $D_i$ 在 $9.8$ mm 到 $10.5$ mm 之间均匀分布，共 $n = 20$ 个点。\n  - 噪声标准差 $\\sigma = 8$ kPa。\n  - 随机种子为 $456$ 以确保可复现性。\n- 测试用例 3（近线性响应，中等噪声）：\n  - 参考直径 $D_0 = 10$ mm，壁厚 $h = 1$ mm。\n  - 真实参数 $a_{\\text{true}} = 120$ kPa, $b_{\\text{true}} = 1$。\n  - 直径 $D_i$ 在 $8.5$ mm 到 $11.5$ mm 之间均匀分布，共 $n = 30$ 个点。\n  - 噪声标准差 $\\sigma = 3$ kPa。\n  - 随机种子为 $789$ 以确保可复现性。\n\n剖面网格和置信区间构建：\n- 对于 $a$，在从 $20$ kPa 到 $300$ kPa 的 $201$ 个点的网格上评估剖面。\n- 对于 $b$，在从 $0.5$ 到 $12$ 的 $201$ 个点的网格上评估剖面。\n- 使用自由度为 1、置信水平为 $0.95$ 的卡方分位数来确定每个参数的置信区间。如果整个网格都满足不等式，或者没有网格点满足不等式，则报告整个网格的宽度作为置信区间宽度，以表明在探测范围内实际不可辨识。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三个测试用例的 $a$ 和 $b$ 的置信区间宽度，按顺序排列，形式为用方括号括起来的逗号分隔列表。这六个值必须按 $[w_a^{(1)}, w_b^{(1)}, w_a^{(2)}, w_b^{(2)}, w_a^{(3)}, w_b^{(3)}]$ 的顺序排列，其中 $w_a^{(j)}$ 是测试用例 $j$ 中 $a$ 的置信区间宽度（单位：kPa），$w_b^{(j)}$ 是测试用例 $j$ 中 $b$ 的置信区间宽度（无量纲），均四舍五入到六位小数。例如，输出必须具有以下形式 $$[w_a^{(1)},w_b^{(1)},w_a^{(2)},w_b^{(2)},w_a^{(3)},w_b^{(3)}].$$",
            "solution": "该问题已经过验证，被认为是可靠的。它在科学上基于生物力学和统计学的既定原则，问题阐述清晰，目标明确，并包含了进行求解所需的所有信息。\n\n该任务要求推导患者特异性动脉壁模型，然后通过实现剖面似然分析，来评估从模拟的含噪声数据中辨识参数的可能性。\n\n**1. 压力-直径关系的推导**\n\n目标是推导出内压 $P$ 作为血管直径 $D$ 和一组模型参数的函数表达式。这可以通过结合所提供的力学平衡、应变运动学和本构行为方程来实现。\n\n首先，环向 Green-Lagrange 应变 $E_{\\theta}$ 由环向拉伸比 $\\lambda_{\\theta}$ 定义：\n$$E_{\\theta} = \\frac{1}{2}(\\lambda_{\\theta}^2 - 1)$$\n拉伸比 $\\lambda_{\\theta}$ 是变形后直径 $D$ 与参考（零应力）直径 $D_0$ 的比值：\n$$\\lambda_{\\theta} = \\frac{D}{D_0}$$\n将 $\\lambda_{\\theta}$ 的表达式代入应变定义，得到 $E_{\\theta}$ 作为 $D$ 的函数：\n$$E_{\\theta} = \\frac{1}{2}\\left(\\left(\\frac{D}{D_0}\\right)^2 - 1\\right)$$\n\n接下来，Fung 型指数本构关系通过两个材料参数 $a$ 和 $b$ 将环向 Cauchy 应力 $\\sigma_{\\theta}$ 与应变 $E_{\\theta}$ 联系起来：\n$$\\sigma_{\\theta} = a \\exp(b E_{\\theta})$$\n将推导出的 $E_{\\theta}$ 表达式代入该定律，得到应力作为直径的函数：\n$$\\sigma_{\\theta} = a \\exp\\left(b \\left[\\frac{1}{2}\\left(\\frac{D}{D_0}\\right)^2 - \\frac{1}{2}\\right]\\right) = a \\exp\\left(\\frac{b}{2}\\left[\\left(\\frac{D}{D_0}\\right)^2 - 1\\right]\\right)$$\n\n最后，薄壁平衡方程（Laplace 定律）将应力 $\\sigma_{\\theta}$ 与内压 $P$、变形后半径 $R$ 和壁厚 $h$ 联系起来：\n$$\\sigma_{\\theta} = \\frac{P R}{h}$$\n由于半径是直径的一半，即 $R = D/2$，平衡方程变为：\n$$\\sigma_{\\theta} = \\frac{P (D/2)}{h} = \\frac{P D}{2h}$$\n\n为了找到压力-直径关系，我们将应力的本构表达式与应力的平衡表达式相等：\n$$\\frac{P D}{2h} = a \\exp\\left(\\frac{b}{2}\\left[\\left(\\frac{D}{D_0}\\right)^2 - 1\\right]\\right)$$\n求解 $P$ 得到最终的正向模型，我们将其表示为 $P(D; a, b)$：\n$$P(D; a,b) = \\frac{2ha}{D} \\exp\\left(\\frac{b}{2}\\left[\\left(\\frac{D}{D_0}\\right)^2 - 1\\right]\\right)$$\n该方程描述了在给定材料特性（$a$、$b$）和患者特异性几何形状（$D_0$、$h$）的情况下，将血管维持在直径 $D$ 所需的压力。\n\n**2. 统计框架和数值实现**\n\n从含噪声的测量值 $\\{(D_i, P_i^{\\text{obs}})\\}$ 中估计参数 $a$ 和 $b$ 的问题被构建为一个非线性最小二乘问题。在加性、独立同分布高斯噪声的假设下，最小化残差平方和（SSE）等同于最大化似然函数。\n\nSSE 由下式给出：\n$$\\mathrm{SSE}(a,b) = \\sum_{i=1}^{n} \\left(P_i^{\\text{obs}} - P(D_i; a,b)\\right)^2$$\n最大似然估计（MLEs）$(\\hat{a}, \\hat{b})$ 是在满足物理约束 $a0$ 和 $b0$ 的条件下，使该函数最小化的 $a$ 和 $b$ 的值。\n$$(\\hat{a}, \\hat{b}) = \\arg\\min_{a0, b0} \\mathrm{SSE}(a,b)$$\nSSE 的最小值表示为 $\\mathrm{SSE}_{\\text{min}} = \\mathrm{SSE}(\\hat{a}, \\hat{b})$。这是一个二维数值优化问题。\n\n剖面似然分析用于单独评估每个参数的可辨识性。对于一个感兴趣的参数（例如 $a$），对于其每个固定值，都会将无关参数（例如 $b$）优化掉。\n\n通过在预定义网格上为每个 $a$ 值计算剖面残差平方和 $\\mathrm{SSE}_a(a)$ 来构建 $a$ 的剖面：\n$$\\mathrm{SSE}_a(a^*) = \\min_{b0} \\mathrm{SSE}(a^*, b)$$\n这要求对每个固定的 $a^*$ 求解一个关于 $b$ 的一维优化问题。\n\n类似地，$b$ 的剖面为：\n$$\\mathrm{SSE}_b(b^*) = \\min_{a0} \\mathrm{SSE}(a, b^*)$$\n\n然后计算通用参数 $p$ 的似然比统计量 $\\Delta(p)$。对于参数 $a$，它是：\n$$\\Delta_a(a) = n \\cdot \\ln\\left(\\frac{\\mathrm{SSE}_a(a)}{\\mathrm{SSE}_{\\text{min}}}\\right)$$\n对于参数 $b$：\n$$\\Delta_b(b) = n \\cdot \\ln\\left(\\frac{\\mathrm{SSE}_b(b)}{\\mathrm{SSE}_{\\text{min}}}\\right)$$\n\n每个参数的逐点 $95\\%$ 置信区间被定义为参数值的集合，对于这些值，似然比统计量不超过一个临界阈值。这个阈值是自由度为 1、置信水平为 $1-\\alpha = 0.95$ 的卡方分布的分位数。\n$$\\text{CI}_{95\\%} = \\{ p \\mid \\Delta(p) \\le \\chi^2_{1, 0.95} \\}$$\n在数值上，对于每个剖面（例如 $a$），我们找到网格上所有满足 $\\Delta_a(a) \\le \\chi^2_{1, 0.95} \\approx 3.841$ 的值 $a_{\\text{grid}}$。置信区间的宽度是该集合中最大值和最小值之间的差。\n\n对于每个测试用例，实现将按以下步骤进行：\n1.  通过向真实模型输出添加高斯噪声来生成合成压力数据 $P_i^{\\text{obs}}$，并使用指定的随机种子以确保可复现性。\n2.  使用 `scipy.optimize.minimize` 执行二维优化，以找到最大似然估计 $(\\hat{a}, \\hat{b})$ 和最小残差平方和 $\\mathrm{SSE}_{\\text{min}}$。将使用边界来强制施加正值约束。\n3.  对于每个参数（$a$ 和 $b$），遍历其预定义的网格。在每个网格点上，对无关参数执行一维优化，以找到剖面 SSE。\n4.  计算似然比统计量向量 $\\Delta_a$ 和 $\\Delta_b$。\n5.  通过将统计量与 $\\chi^2$ 临界值进行比较，确定在 $95\\%$ 置信区间内的参数值集合。\n6.  计算并存储该区间的宽度。问题规定，如果区间覆盖整个网格或为空，则应报告完整的网格宽度，这标志着实际不可辨识。\n7.  最后，收集所有计算出的宽度并将其格式化为单个输出字符串。",
            "answer": "[54.600000,2.127500,280.000000,11.500000,280.000000,11.500000]"
        }
    ]
}