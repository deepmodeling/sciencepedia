{
    "hands_on_practices": [
        {
            "introduction": "在生物力学系统辨识中，一个基本任务是量化我们对模型参数估计的信心。本练习将引导您从一个描述关节动态的线性粘弹性模型入手，推导其费雪信息矩阵 (Fisher Information Matrix) 和克拉美-罗下限 (Cramér–Rao Lower Bound)，这是评估参数辨识精度的核心工具。通过这个练习，您将掌握如何将实验输入（如此处的多正弦激励）与参数估计的理论最佳方差联系起来，为设计信息丰富的实验奠定数学基础。",
            "id": "4207891",
            "problem": "研究一个单自由度 (SDOF) 人体关节在其平衡角附近的小扰动情况，此时线性粘弹性行为是有效的。关于平衡位置的旋转动力学由一个带有转动惯量的开尔文-沃伊特 (Kelvin–Voigt) 元件建模，因此外加扭矩 $\\,\\tau_{\\text{ext}}(t)\\,$ 遵循以下公式\n$$\n\\tau_{\\text{ext}}(t) \\;=\\; J\\,\\ddot{q}(t) \\;+\\; b\\,\\dot{q}(t) \\;+\\; k\\,q(t),\n$$\n其中 $\\,q(t)\\,$ 是微小的角位移，$\\,k\\,$ 是线性刚度，$\\,b\\,$ 是线性粘性阻尼系数，$\\,J\\,$ 是转动惯量。在一个辨识实验中，您将角位移作为确定性输入施加\n$$\nq(t) \\;=\\; A_{1}\\,\\sin(\\omega_{1} t) \\;+\\; A_{2}\\,\\sin(\\omega_{2} t),\n$$\n其中振幅 $\\,A_{1},A_{2} > 0\\,$ 均为严格正值，角频率 $\\,\\omega_{1} \\neq \\omega_{2}\\,$ 均为严格正值且不相等。实验时长 $\\,T\\,$ 的选择使得 $\\,\\omega_{1} T/(2\\pi)\\,$ 和 $\\,\\omega_{2} T/(2\\pi)\\,$ 均为整数，这确保了 $\\,q(0) = q(T) = 0\\,$ 和 $\\,\\dot{q}(0) = \\dot{q}(T) = 0\\,$。测量的扭矩受到加性、独立、零均值高斯噪声的干扰，\n$$\ny(t) \\;=\\; \\tau_{\\text{ext}}(t) \\;+\\; \\varepsilon(t),\n$$\n其中 $\\,\\varepsilon(t)\\,$ 是时间上的白噪声，单位时间方差为 $\\,\\sigma_{\\tau}^{2}\\,$。假设输入 $\\,q(t)\\,$ 是精确已知的，并且 $\\,\\dot{q}(t)\\,$ 和 $\\,\\ddot{q}(t)\\,$ 可以从施加的 $\\,q(t)\\,$ 精确计算得出。\n\n使用牛顿旋转动力学的第一性原理和高斯测量的似然性，推导参数矢量 $\\,\\boldsymbol{\\theta} = [k,\\,b,\\,J]^{\\top}\\,$ 的连续时间费雪信息矩阵 (FIM)，并计算克拉默-拉奥下界 (CRLB) 方差 $\\,\\operatorname{Var}(\\hat{k}),\\,\\operatorname{Var}(\\hat{b}),\\,\\operatorname{Var}(\\hat{J})\\,$，即 $\\,I(\\boldsymbol{\\theta})^{-1}\\,$ 的对角线元素。将您的最终结果表示为包含 $\\,A_{1},\\,A_{2},\\,\\omega_{1},\\,\\omega_{2},\\,T\\,$ 和 $\\,\\sigma_{\\tau}^{2}\\,$ 的封闭形式解析表达式。\n\n为确保科学真实性，请证明您选择的实验设计能够导出一个可逆的 FIM 和持续激励。未提供数值；您的最终答案必须是单个解析表达式。将 $\\,\\hat{k}\\,$ 的方差以 $(\\text{N}\\cdot\\text{m}/\\text{rad})^2$ 为单位表示，$\\,\\hat{b}\\,$ 的方差以 $(\\text{N}\\cdot\\text{m}\\cdot\\text{s}/\\text{rad})^2$ 为单位表示，$\\,\\hat{J}\\,$ 的方差以 $(\\text{kg}\\cdot\\text{m}^2)^2$ 为单位表示。无需四舍五入。",
            "solution": "该问题被评估为有效。它具有科学依据，提法恰当，客观，并包含获得唯一、有意义解所需的所有信息。它代表了系统辨识理论在生物力学中应用的一个标准问题。\n\n系统动力学由一个线性常微分方程给出，该方程对于未知参数 $\\boldsymbol{\\theta} = [k, b, J]^{\\top}$ 是线性的。\n$$\n\\tau_{\\text{ext}}(t) = k\\,q(t) + b\\,\\dot{q}(t) + J\\,\\ddot{q}(t)\n$$\n这可以写成线性回归格式：\n$$\n\\tau_{\\text{ext}}(t) = \\boldsymbol{\\phi}(t)^{\\top} \\boldsymbol{\\theta}\n$$\n其中回归量向量 $\\boldsymbol{\\phi}(t)$ 由已知信号组成：\n$$\n\\boldsymbol{\\phi}(t) = \\begin{pmatrix} q(t) \\\\ \\dot{q}(t) \\\\ \\ddot{q}(t) \\end{pmatrix}\n$$\n测量的扭矩为 $y(t) = \\boldsymbol{\\phi}(t)^{\\top} \\boldsymbol{\\theta} + \\varepsilon(t)$，其中 $\\varepsilon(t)$ 是加性、零均值、白高斯噪声，其恒定功率谱密度为 $\\sigma_{\\tau}^2$。对于在区间 $[0, T]$ 上观测的这样一个连续时间系统，费雪信息矩阵 (FIM) 由以下公式给出：\n$$\nI(\\boldsymbol{\\theta}) = \\frac{1}{\\sigma_{\\tau}^2} \\int_{0}^{T} \\boldsymbol{\\phi}(t) \\boldsymbol{\\phi}(t)^{\\top} dt\n$$\n因此，$3 \\times 3$ FIM 的元素 $(I)_{ij}$ 为：\n$$\n(I)_{ij} = \\frac{1}{\\sigma_{\\tau}^2} \\int_{0}^{T} \\phi_i(t) \\phi_j(t) dt\n$$\n其中 $\\phi_1(t) = q(t)$，$\\phi_2(t) = \\dot{q}(t)$，以及 $\\phi_3(t) = \\ddot{q}(t)$。\n\n首先，我们通过对输入信号 $q(t) = A_{1}\\,\\sin(\\omega_{1} t) + A_{2}\\,\\sin(\\omega_{2} t)$ 求导来计算回归量：\n$$\nq(t) = A_{1}\\,\\sin(\\omega_{1} t) + A_{2}\\,\\sin(\\omega_{2} t)\n$$\n$$\n\\dot{q}(t) = A_{1}\\,\\omega_{1}\\,\\cos(\\omega_{1} t) + A_{2}\\,\\omega_{2}\\,\\cos(\\omega_{2} t)\n$$\n$$\n\\ddot{q}(t) = -A_{1}\\,\\omega_{1}^{2}\\,\\sin(\\omega_{1} t) - A_{2}\\,\\omega_{2}^{2}\\,\\sin(\\omega_{2} t)\n$$\n问题陈述，实验时长 $T$ 的选择使得 $n_1 = \\omega_{1} T/(2\\pi)$ 和 $n_2 = \\omega_{2} T/(2\\pi)$ 均为整数。这确保了函数 $\\sin(\\omega_i t)$ 和 $\\cos(\\omega_i t)$ 在区间 $[0, T]$ 上完成整数个周期。这导致了对于 $i, j \\in \\{1, 2\\}$ 且给定 $\\omega_1 \\neq \\omega_2$ 的以下正交关系：\n$$\n\\int_{0}^{T} \\sin(\\omega_i t)\\sin(\\omega_j t) dt = \\frac{T}{2}\\delta_{ij}\n$$\n$$\n\\int_{0}^{T} \\cos(\\omega_i t)\\cos(\\omega_j t) dt = \\frac{T}{2}\\delta_{ij}\n$$\n$$\n\\int_{0}^{T} \\sin(\\omega_i t)\\cos(\\omega_j t) dt = 0 \\quad (\\text{for all } i, j)\n$$\n利用这些性质，我们计算 FIM 的元素。\n\n$I_{11} = \\frac{1}{\\sigma_{\\tau}^2} \\int_{0}^{T} q(t)^2 dt = \\frac{1}{\\sigma_{\\tau}^2} \\int_{0}^{T} (A_1 \\sin(\\omega_1 t) + A_2 \\sin(\\omega_2 t))^2 dt = \\frac{1}{\\sigma_{\\tau}^2} \\left( A_1^2 \\frac{T}{2} + A_2^2 \\frac{T}{2} \\right) = \\frac{T}{2\\sigma_{\\tau}^2}(A_1^2 + A_2^2)$。\n\n$I_{22} = \\frac{1}{\\sigma_{\\tau}^2} \\int_{0}^{T} \\dot{q}(t)^2 dt = \\frac{1}{\\sigma_{\\tau}^2} \\int_{0}^{T} (A_1 \\omega_1 \\cos(\\omega_1 t) + A_2 \\omega_2 \\cos(\\omega_2 t))^2 dt = \\frac{T}{2\\sigma_{\\tau}^2}(A_1^2 \\omega_1^2 + A_2^2 \\omega_2^2)$。\n\n$I_{33} = \\frac{1}{\\sigma_{\\tau}^2} \\int_{0}^{T} \\ddot{q}(t)^2 dt = \\frac{1}{\\sigma_{\\tau}^2} \\int_{0}^{T} (-A_1 \\omega_1^2 \\sin(\\omega_1 t) - A_2 \\omega_2^2 \\sin(\\omega_2 t))^2 dt = \\frac{T}{2\\sigma_{\\tau}^2}(A_1^2 \\omega_1^4 + A_2^2 \\omega_2^4)$。\n\n$I_{12} = \\frac{1}{\\sigma_{\\tau}^2} \\int_{0}^{T} q(t)\\dot{q}(t) dt$。被积函数是形如 $\\sin(\\omega_i t)\\cos(\\omega_j t)$ 的项之和，这些项的积分都为零。所以 $I_{12} = 0$。\n\n$I_{23} = \\frac{1}{\\sigma_{\\tau}^2} \\int_{0}^{T} \\dot{q}(t)\\ddot{q}(t) dt$。被积函数同样是形如 $\\sin(\\omega_i t)\\cos(\\omega_j t)$ 的项之和，其积分也为零。所以 $I_{23} = 0$。\n\n$I_{13} = \\frac{1}{\\sigma_{\\tau}^2} \\int_{0}^{T} q(t)\\ddot{q}(t) dt = \\frac{1}{\\sigma_{\\tau}^2} \\int_{0}^{T} (A_1 \\sin(\\omega_1 t) + A_2 \\sin(\\omega_2 t))(-A_1 \\omega_1^2 \\sin(\\omega_1 t) - A_2 \\omega_2^2 \\sin(\\omega_2 t)) dt$。\n利用正交性，只有 $\\sin^2$ 项保留下来：$I_{13} = \\frac{1}{\\sigma_{\\tau}^2} \\left( -A_1^2 \\omega_1^2 \\frac{T}{2} - A_2^2 \\omega_2^2 \\frac{T}{2} \\right) = -\\frac{T}{2\\sigma_{\\tau}^2}(A_1^2 \\omega_1^2 + A_2^2 \\omega_2^2)$。\n\n我们定义常数 $C = \\frac{T}{2\\sigma_{\\tau}^2}$ 和谱矩 $S_p = A_1^2 \\omega_1^p + A_2^2 \\omega_2^p$。FIM 为：\n$$\nI(\\boldsymbol{\\theta}) = C \\begin{pmatrix} S_0  0  -S_2 \\\\ 0  S_2  0 \\\\ -S_2  0  S_4 \\end{pmatrix}\n$$\n如果 FIM 的行列式非零，则它是可逆的。\n$\\det(I) = C^3 [S_0(S_2 S_4 - 0) - S_2(-S_2 S_2)] = C^3 S_2(S_0 S_4 - S_2^2)$。\n项 $S_0 S_4 - S_2^2$ 是：\n$S_0 S_4 - S_2^2 = (A_1^2 + A_2^2)(A_1^2 \\omega_1^4 + A_2^2 \\omega_2^4) - (A_1^2 \\omega_1^2 + A_2^2 \\omega_2^2)^2$\n$= (A_1^4 \\omega_1^4 + A_1^2 A_2^2 \\omega_2^4 + A_2^2 A_1^2 \\omega_1^4 + A_2^4 \\omega_2^4) - (A_1^4 \\omega_1^4 + 2A_1^2 A_2^2 \\omega_1^2 \\omega_2^2 + A_2^4 \\omega_2^4)$\n$= A_1^2 A_2^2 (\\omega_1^4 + \\omega_2^4 - 2\\omega_1^2 \\omega_2^2) = A_1^2 A_2^2 (\\omega_1^2 - \\omega_2^2)^2$。\n由于 $A_1, A_2 > 0$ 且 $\\omega_1 \\neq \\omega_2$，我们有 $\\det(I) > 0$。FIM 是可逆的。这是“持续激励”的直接结果：输入信号是两个不同频率正弦波的和，其信息足够丰富，可以确保回归量 $q(t)$、$\\dot{q}(t)$ 和 $\\ddot{q}(t)$ 的线性无关性，从而能够唯一地辨识这三个参数。如果只使用一个正弦波（例如，$A_2=0$），那么 $\\ddot{q}(t) = -\\omega_1^2 q(t)$，回归量将线性相关，FIM 将是奇异的。\n\n克拉默-拉奥下界 (CRLB) 矩阵是 FIM 的逆：$I(\\boldsymbol{\\theta})^{-1}$。该矩阵的对角线元素给出了任何无偏估计器可达到的最小方差。\n由于 $I(\\boldsymbol{\\theta})$ 的块对角结构，其逆矩阵为：\n$$\nI(\\boldsymbol{\\theta})^{-1} = \\frac{1}{C(S_0 S_4 - S_2^2)} \\begin{pmatrix} S_4  0  S_2 \\\\ 0  \\frac{S_0 S_4 - S_2^2}{S_2}  0 \\\\ S_2  0  S_0 \\end{pmatrix}\n$$\nCRLB 方差是对角线元素：\n$\\operatorname{Var}(\\hat{k}) \\ge (I^{-1})_{11} = \\frac{S_4}{C(S_0 S_4 - S_2^2)}$\n$\\operatorname{Var}(\\hat{b}) \\ge (I^{-1})_{22} = \\frac{1}{C S_2}$\n$\\operatorname{Var}(\\hat{J}) \\ge (I^{-1})_{33} = \\frac{S_0}{C(S_0 S_4 - S_2^2)}$\n\n将 $C$、$S_p$ 和 $S_0 S_4 - S_2^2 = A_1^2 A_2^2 (\\omega_1^2 - \\omega_2^2)^2$ 的表达式代回：\n\n$\\operatorname{Var}(\\hat{k}) \\ge \\frac{A_1^2 \\omega_1^4 + A_2^2 \\omega_2^4}{\\frac{T}{2\\sigma_{\\tau}^2} A_1^2 A_2^2 (\\omega_1^2 - \\omega_2^2)^2} = \\frac{2\\sigma_{\\tau}^2}{T} \\frac{A_1^2 \\omega_1^4 + A_2^2 \\omega_2^4}{A_1^2 A_2^2 (\\omega_1^2 - \\omega_2^2)^2}$\n\n$\\operatorname{Var}(\\hat{b}) \\ge \\frac{1}{\\frac{T}{2\\sigma_{\\tau}^2} (A_1^2 \\omega_1^2 + A_2^2 \\omega_2^2)} = \\frac{2\\sigma_{\\tau}^2}{T(A_1^2 \\omega_1^2 + A_2^2 \\omega_2^2)}$\n\n$\\operatorname{Var}(\\hat{J}) \\ge \\frac{A_1^2 + A_2^2}{\\frac{T}{2\\sigma_{\\tau}^2} A_1^2 A_2^2 (\\omega_1^2 - \\omega_2^2)^2} = \\frac{2\\sigma_{\\tau}^2}{T} \\frac{A_1^2 + A_2^2}{A_1^2 A_2^2 (\\omega_1^2 - \\omega_2^2)^2}$\n\n这些就是 CRLB 方差。问题要求的是这些值，它们是任何无偏估计器方差的下界。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2\\sigma_{\\tau}^2(A_1^2 \\omega_1^4 + A_2^2 \\omega_2^4)}{T A_1^2 A_2^2 (\\omega_1^2 - \\omega_2^2)^2}  \\frac{2\\sigma_{\\tau}^2}{T(A_1^2 \\omega_1^2 + A_2^2 \\omega_2^2)}  \\frac{2\\sigma_{\\tau}^2(A_1^2 + A_2^2)}{T A_1^2 A_2^2 (\\omega_1^2 - \\omega_2^2)^2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理解了如何量化参数不确定性之后，下一步自然是设计能最小化这种不确定性的实验。本练习要求您对几种标准激励信号——阶跃、线性扫频（Chirp）和伪随机二进制序列（PRBS）——进行概念性比较，以判断哪种最适合同时辨识关节的刚度与阻尼。这项练习旨在培养您对“持续激励”原则的直观理解，并揭示输入信号的频谱特性如何直接影响模型参数的可分离性和辨识鲁棒性。",
            "id": "4207813",
            "problem": "在小幅度的矢状面运动中，人类踝关节可以被建模为一个遵循旋转运动牛顿第二定律的线性旋转质量-弹簧-阻尼系统。关节角度为 $\\,\\theta(t)\\,$，施加的净扭矩为 $\\,\\tau(t)\\,$，转动惯量为 $\\,J\\,$（假设已知），粘性阻尼系数为 $\\,c\\,$，线性刚度系数为 $\\,k\\,$。其控制动力学方程为 $\\,J\\,\\ddot{\\theta}(t)+c\\,\\dot{\\theta}(t)+k\\,\\theta(t)=\\tau(t)\\,$。你需要设计一个在固定时长 $\\,T\\,$ 内的输入扭矩 $\\,\\tau(t)\\,$，该扭矩需要满足幅值限制 $\\,|\\tau(t)|\\leq A_{\\max}\\,$，并且所有候选输入的能量约束 $\\,\\int_{0}^{T}\\tau^{2}(t)\\,dt=E\\,$ 相同。\n\n假设踝关节保持在线性范围内，取决于构型的 $\\,J\\,$ 是已知且恒定的，并且扭矩和运动学上的测量噪声是零均值、独立、方差有限的近似白噪声。目标是使用标准线性系统辨识方法，以最小的不确定性同时辨识 $\\,c\\,$ 和 $\\,k\\,$。其中，激励质量的评判标准是实验能在多大程度上覆盖由 $\\,c\\,$ 和 $\\,k\\,$ 构成的二维参数子空间。具体来说，你应该从第一性原理出发，分析输入扭矩 $\\,\\tau(t)\\,$ 中的频率成分分布、由此产生的运动学响应 $\\,\\theta(t)\\,$ 和 $\\,\\dot{\\theta}(t)\\,$，以及这些因素如何影响在控制动力学中区分 $\\,c\\,$ 和 $\\,k\\,$ 各自贡献的能力。\n\n考虑以下输入类别：\n- $\\,\\textbf{阶跃 (Step):}\\,$ $\\,\\tau(t)=\\tau_{0}\\,u(t)\\,$，其中 $\\,|\\tau_{0}|\\leq A_{\\max}\\,$ 且 $\\,u(t)\\,$ 为单位阶跃函数。\n- $\\,\\textbf{线性扫频 (Chirp):}\\,$ $\\,\\tau(t)=A\\,\\sin\\big(2\\pi\\,(f_{0}\\,t+\\tfrac{\\beta}{2}\\,t^{2})\\big)\\,$，其中 $\\,|A|\\leq A_{\\max}\\,$，起始频率 $\\,f_{0}>0\\,$，扫频速率 $\\,\\beta>0\\,$ 的选择应使瞬时频率在 $\\,[0,T]\\,$ 期间扫过一个宽频带。\n- $\\,\\textbf{伪随机二进制序列 (PRBS):}\\,$ 一种在固定的比特间隔 $\\,T_{b}\\,$ 内于 $\\,\\pm A\\,$ 之间切换的平衡序列，其中 $\\,|A|\\leq A_{\\max}\\,$，序列长度的选择应使其频谱在大致到 $\\,\\omega_{b}\\approx\\pi/T_{b}\\,$ 的转角频率为止的范围内是平坦的，且总时长为 $\\,T\\,$。\n\n所有输入在 $\\,[0,T]\\,$ 内都被约束为具有相同的能量 $\\,E\\,$。在所述约束下，哪一类输入能最鲁棒地激励刚度-阻尼参数子空间，即能产生用于同时估计 $\\,c\\,$ 和 $\\,k\\,$ 的良态且相关性最小的运动学回归量？\n\nA. 阶跃输入，因为它最大化了低频成分并分离了 $\\,k\\,$ 的贡献。\n\nB. 线性扫频输入，因为它扫过多个频率，从而依次强调了 $\\,c\\,$ 和 $\\,k\\,$ 的影响。\n\nC. 伪随机二进制序列输入，因为其在 $\\,[0,\\omega_{b}]\\,$ 上的近白频谱能产生持续激励的运动学，并改善用于辨识 $\\,c\\,$ 和 $\\,k\\,$ 的条件数。\n\nD. 以上都不是；在能量和幅值约束相同的情况下，所有三种输入对参数子空间的激励效果一样好。",
            "solution": "用户希望我解决并分析一个与踝关节生物力学模型相关的系统辨识问题。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**步骤1：提取已知条件**\n\n- **模型：** 线性旋转质量-弹簧-阻尼系统。\n- **控制方程：** $J\\,\\ddot{\\theta}(t)+c\\,\\dot{\\theta}(t)+k\\,\\theta(t)=\\tau(t)$。\n- **变量：** $\\theta(t)$ 是关节角度，$\\tau(t)$ 是施加的净扭矩。\n- **参数：** $J$ 是转动惯量（已知，恒定），$c$ 是粘性阻尼系数（未知），$k$ 是线性刚度系数（未知）。\n- **输入约束：**\n    - 时长：$[0, T]$。\n    - 幅值：$|\\tau(t)|\\leq A_{\\max}$。\n    - 能量：$\\int_{0}^{T}\\tau^{2}(t)\\,dt=E$。\n- **假设：**\n    - 踝关节运动是小幅度的，并保持在线性范围内。\n    - $J$ 是已知且恒定的。\n    - 测量噪声是零均值、独立、方差有限的近似白噪声。\n- **目标：** 以最小不确定性同时辨识 $c$ 和 $k$。\n- **标准：** 激励质量的评判标准是实验产生的运动学回归量（$\\theta(t)$, $\\dot{\\theta}(t)$）的良态性和相关性程度。\n- **输入类别：**\n    - **阶跃：** $\\tau(t)=\\tau_{0}\\,u(t)\\,$，其中 $|\\tau_{0}|\\leq A_{\\max}$。\n    - **线性扫频：** $\\tau(t)=A\\,\\sin\\big(2\\pi\\,(f_{0}\\,t+\\tfrac{\\beta}{2}\\,t^{2})\\big)\\,$，其中 $|A|\\leq A_{\\max}$，$f_{0}>0\\,$，$\\beta>0$。\n    - **伪随机二进制序列 (PRBS):** 在固定的比特间隔 $T_{b}$ 内于 $\\pm A\\,$ 之间切换的平衡序列，其中 $|A|\\leq A_{\\max}$，且其频谱在高达 $\\omega_{b}\\approx\\pi/T_{b}$ 的频率范围内近似平坦。\n\n**步骤2：使用提取的已知条件进行验证**\n\n- **科学性：** 是。该问题使用了一个标准的二阶线性时不变（LTI）模型，这是力学和控制理论的基石。将其应用于小幅度的生物力学关节运动是一种常见且有效的简化。系统辨识、持续激励、输入设计以及信息矩阵的条件数等概念都是工程学和应用数学中公认的原理。\n- **适定性：** 是。该问题定义明确。它要求对三种标准输入信号进行定性比较，以实现一个明确阐述的具体目标（以最小不确定性同时辨识两个参数）。其成功标准——良态且相关性最小的回归量——是系统辨识中一个精确的技术概念。\n- **客观性：** 是。其语言技术性强、精确，没有主观或含糊的术语。所有约束和假设都已明确说明。\n\n**步骤3：结论与行动**\n\n问题陈述在科学上是合理的，具有适定性、客观性和完整性。它提出了一个系统辨识实验设计中经典的、非平凡的问题。因此，该问题是**有效的**。我将继续进行解答。\n\n### 推导与分析\n\n目标是同时估计控制方程中的参数 $c$ 和 $k$：\n$$J\\,\\ddot{\\theta}(t)+c\\,\\dot{\\theta}(t)+k\\,\\theta(t)=\\tau(t)$$\n由于惯量 $J$ 已知，我们可以重排该方程以建立一个线性回归问题。测量的量是扭矩 $\\tau(t)$ 和运动学量 $\\theta(t)$、$\\dot{\\theta}(t)$ 和 $\\ddot{\\theta}(t)$（可以通过对 $\\theta(t)$ 的测量值求导得到）。我们定义一个方程误差 $e(t)$：\n$$e(t) = c\\,\\dot{\\theta}(t) + k\\,\\theta(t) - (\\tau(t) - J\\,\\ddot{\\theta}(t))$$\n最小二乘辨识的目标是找到参数 $\\hat{c}$ 和 $\\hat{k}$，使得误差平方的积分 $\\int_{0}^{T} e(t)^2 dt$ 最小化。这可以写成标准线性回归形式 $y(t) = \\mathbf{\\phi}^T \\mathbf{x}(t)$，其中：\n- $\\mathbf{\\phi} = \\begin{bmatrix} c \\\\ k \\end{bmatrix}$ 是未知参数的向量。\n- $\\mathbf{x}(t) = \\begin{bmatrix} \\dot{\\theta}(t) \\\\ \\theta(t) \\end{bmatrix}$ 是回归量（运动学测量值）的向量。\n- $y(t) = \\tau(t) - J\\,\\ddot{\\theta}(t)$ 是计算出的“输出”。\n\n最小二乘估计 $\\hat{\\mathbf{\\phi}}$ 由下式给出：\n$$\\hat{\\mathbf{\\phi}} = \\left( \\int_{0}^{T} \\mathbf{x}(t) \\mathbf{x}(t)^T dt \\right)^{-1} \\left( \\int_{0}^{T} \\mathbf{x}(t) y(t) dt \\right)$$\n在白噪声存在的情况下，该估计的不确定性（协方差）与“信息矩阵” $\\mathbf{M}$ 的逆成正比：\n$$\\mathbf{M} = \\int_{0}^{T} \\mathbf{x}(t) \\mathbf{x}(t)^T dt = \\int_{0}^{T} \\begin{bmatrix} \\dot{\\theta}(t)^2  \\dot{\\theta}(t)\\theta(t) \\\\ \\dot{\\theta}(t)\\theta(t)  \\theta(t)^2 \\end{bmatrix} dt$$\n为了在 $c$ 和 $k$ 的估计中实现“最小不确定性”，矩阵 $\\mathbf{M}$ 必须在某种意义上被“最大化”，具体来说，它必须是良态的。一个良态的矩阵 $\\mathbf{M}$ 具有两个关键特性：\n1.  **它必须是可逆的。** 这要求其行列式不为零，意味着回归量 $\\dot{\\theta}(t)$ 和 $\\theta(t)$ 不是线性相关的。这就是**持续激励**的条件。输入 $\\tau(t)$ 必须足够丰富，以激励系统的所有模式。\n2.  **其条件数应该很小。** 这通常意味着非对角线项（$\\int \\dot{\\theta}\\theta dt$）相对于对角线项（$\\int \\dot{\\theta}^2 dt$ 和 $\\int \\theta^2 dt$）要小。这确保了对 $c$ 和 $k$ 的估计是解耦和鲁棒的。\n\n回归量 $\\dot{\\theta}(t)$ 和 $\\theta(t)$ 的特性由通过系统动力学滤波后的输入 $\\tau(t)$ 决定。该系统的传递函数为 $H(s) = \\frac{\\Theta(s)}{\\Tau(s)} = \\frac{1}{Js^2 + cs + k}$。这是一个二阶低通滤波器。为了区分 $c$ 和 $k$ 的影响，我们必须用能够突出它们各自贡献的频率来激励系统。\n- 刚度 $k$ 主导低频和静态响应（$\\tau \\approx k\\theta$）。\n- 阻尼 $c$ 在系统固有频率附近影响最显著，此时速度相对于位移和力较大。\n\n现在，我们根据每种输入类别产生良态回归量的能力来对其进行评估。\n\n- **阶跃输入：** $\\tau(t) = \\tau_0 u(t)$。阶跃函数的傅里叶变换集中在零频率处，其功率以 $1/f^2$ 的速率衰减。它能强烈激励静态响应，从而可以根据稳态偏转 $\\theta_{ss} = \\tau_0/k$ 很好地估计 $k$。然而，在初始瞬态之后，$\\dot{\\theta}(t) \\to 0$，不再提供关于阻尼 $c$ 的进一步信息。激励不是持续的。虽然它会产生一个 $c$ 和 $k$ 都起作用的瞬态响应，但这个信息丰富阶段的有限持续时间导致了用于同时估计的信息矩阵是病态的。\n\n- **线性扫频输入：** $\\tau(t) = A\\sin(\\dots)$。线性扫频输入会扫过一个频带。这是一种持续激励的形式。通过设计扫描范围以覆盖系统的特征频率，可以确保刚度主导（低频）和阻尼主导（中频）的状态都被激励到。这比阶跃输入有了显著的改进，因为它在整个实验过程中持续产生关于 $c$ 和 $k$ 的信息。\n\n- **伪随机二进制序列 (PRBS):** 该信号在一个宽频率范围内（从直流到与比特间隔 $T_b$ 相关的转角频率）具有近似平坦（“白色”）的功率谱。同时在宽频带上均匀注入能量是激励线性系统所有动态特性的标准方法。这种持续的宽带激励确保了回归量 $\\theta(t)$ 和 $\\dot{\\theta}(t)$ 都具有显著的功率。信号的随机性倾向于在积分时间 $T$ 内使响应与其导数去相关，从而最小化信息矩阵 $\\mathbf{M}$ 的非对角线项。这会产生一个良态矩阵，而这正是获得鲁棒、最小方差且解耦的 $c$ 和 $k$ 估计值的直接数学要求。与依次激励各个频率的线性扫频信号相比，PRBS 同时激励所有频率，其更平坦的功率谱使其在系统精确动态特性未知时，成为系统辨识中一个更具普适鲁棒性的选择。\n\n**结论：** PRBS 是更优的选择，因为其近白频谱在所有相关频率上提供了最均匀和持续的激励，这反过来又为同时估计多个参数产生了条件数最佳的信息矩阵。\n\n### 逐项分析\n\n**A. 阶跃输入，因为它最大化了低频成分并分离了 $\\,k\\,$ 的贡献。**\n这个说法部分正确，因为阶跃输入对于从静态响应中辨识 $k$ 很有用。然而，它对于辨识 $c$ 很差，而且关键是，对于以最小不确定性*同时*辨识 $c$ 和 $k$ 很差。它不满足“持续激励”准则，导致用于实现所述目标的信息矩阵是病态的。\n**结论：不正确。**\n\n**B. 线性扫频输入，因为它扫过多个频率，从而依次强调了 $\\,c\\,$ 和 $\\,k\\,$ 的影响。**\n这个说法正确地描述了线性扫频输入的好处。它是一种很好的持续激励方法，远优于阶跃输入。它确实激励了与 $c$ 和 $k$ 相关的动力学。然而，必须相对于其他选项来评估这一说法。\n**结论：不正确。** 虽然它是一个好的输入，但基于上述原因，与 PRBS 相比，它不是*最鲁棒*的。PRBS 更平坦、更宽的频谱提供了更均匀的激励。\n\n**C. 伪随机二进制序列输入，因为其在 $\\,[0,\\omega_{b}]\\,$ 上的近白频谱能产生持续激励的运动学，并改善用于辨识 $\\,c\\,$ 和 $\\,k\\,$ 的条件数。**\n这个说法准确地抓住了 PRBS 用于线性系统辨识的关键优势。“近白频谱”导致“持续激励的运动学”，这反过来又“改善了条件数”。这直接满足了为实现同时估计而产生良态且相关性最小的回归量的标准，从而带来最小的不确定性。这是给定选项中理论上的最优选择。\n**结论：正确。**\n\n**D. 以上都不是；在能量和幅值约束相同的情况下，所有三种输入对参数子空间的激励效果一样好。**\n这个说法是根本错误的。系统辨识的一个核心原则是，输入信号的选择对最终参数估计的质量至关重要。这些输入的频率成分大相径庭，导致对系统动力学的激励效果截然不同，因此，估计问题的条件数也不同。\n**结论：不正确。**",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "现实世界中的生物力学系统，尤其是肌肉，本质上是高度非线性的，这给参数辨识带来了更大的挑战。本练习将问题提升到一个新的高度，要求您为一个经典的希尔型肌肉模型（Hill-type muscle model）设计最优实验。您需要推导模型输出对关键参数（如最大等长力 $F_{\\max}$ 和最优肌纤维长度 $l_{0}$）的灵敏度，并利用费雪信息矩阵来优化肌电激励信号。这个过程体现了系统辨识的前沿实践——不仅仅是选择一种好的输入类型，而是通过数学优化来精确设计实验条件，以从测量数据中提取最大化的信息量。",
            "id": "4207826",
            "problem": "考虑一个单肌肉、单自由度（single-degree-of-freedom）的铰链关节，其力臂 $r$ 为常数，肌腱为刚性。关节角度 $q(t)$ 是预先设定的，并且测量无误差。肌肉肌腱的几何结构被线性化为 $l_{m}(q) = l_{m,\\mathrm{ref}} - r\\,(q - q_{\\mathrm{ref}})$，其中 $l_{m,\\mathrm{ref}}$ 和 $q_{\\mathrm{ref}}$ 是已知的常数。在所考虑的运动范围内，羽状角可忽略不计，被动力也可忽略不计。该肌肉被建模为一个Hill型致动器，其激活度 $a(t)$ 由肌电（Electromyography, EMG）激励 $u(t)$ 驱动。假设满足准静态条件，使得 $a(t) \\approx u(t)$（相对于测量时间，一阶激活动态足够快），并且肌纤维速度足够小，使得力-速度因子 $f_{v} \\approx 1$。\n\n主动肌力为 $F_{\\mathrm{act}}(t) = a(t)\\,F_{\\max}\\,f_{\\ell}(\\lambda(t))$，其中 $F_{\\max}$ 是肌肉的最大等长力，$l_{0}$ 是最优肌纤维长度，$\\lambda(t) = l_{m}(t)/l_{0}$ 是归一化的肌纤维长度，主动力-长度曲线具体表示为\n$$\nf_{\\ell}(\\lambda) = \\exp\\!\\left(-\\frac{(\\lambda - 1)^{2}}{w^{2}}\\right),\n$$\n其中宽度参数 $w > 0$ 是已知的。产生的关节力矩为 $\\tau(t) = r\\,F_{\\mathrm{act}}(t)$。\n\n您将在预设运动过程中的两个时刻 $t_{1}$ 和 $t_{2}$ 获取两次力矩测量值，对应的关节角度分别为 $q_{1} = q(t_{1})$ 和 $q_{2} = q(t_{2})$，从而得到肌肉长度 $l_{m,1} = l_{m}(q_{1})$ 和 $l_{m,2} = l_{m}(q_{2})$，以及归一化长度 $\\lambda_{1} = l_{m,1}/l_{0}$ 和 $\\lambda_{2} = l_{m,2}/l_{0}$。在这些时刻，您将分别施加EMG激励幅值 $u_{1}$ 和 $u_{2}$，其中 $0 \\leq u_{k} \\leq 1$。假设在每个时刻的力矩测量噪声是独立的、零均值的高斯噪声，其方差为 $\\sigma^{2}$。\n\n任务：\n1. 在一个通用时刻 $t$，推导力矩相对于参数 $\\theta = \\begin{pmatrix} F_{\\max}  l_{0} \\end{pmatrix}^{\\mathsf{T}}$ 的灵敏度向量，即\n$$\ns(t) = \\begin{pmatrix} \\frac{\\partial \\tau(t)}{\\partial F_{\\max}} \\\\ \\\\ \\frac{\\partial \\tau(t)}{\\partial l_{0}} \\end{pmatrix},\n$$\n用 $r$、$a(t)$、$F_{\\max}$、$l_{m}(t)$、$l_{0}$ 和 $w$ 表示。\n\n2. 使用任务1的结果，写出这个双测量实验的费雪信息矩阵\n$$\n\\mathcal{I}(\\theta) = \\frac{1}{\\sigma^{2}}\\sum_{k=1}^{2} s(t_{k})\\,s(t_{k})^{\\mathsf{T}},\n$$\n并且，在给定总激励预算 $A > 0$ 的约束条件 $u_{1}^{2} + u_{2}^{2} = A^{2}$ 下，确定能使 $\\det\\!\\big(\\mathcal{I}(\\theta)\\big)$ 最大化的 $u_{1}$ 和 $u_{2}$ 的选择。假设 $q_{1} \\neq q_{2}$，以使两个灵敏度向量不共线，并假设 $A$ 的值使得最优的 $u_{1}$ 和 $u_{2}$ 位于 $[0,1]$ 区间内。\n\n答案规格：\n- 以 $1 \\times 2$ 行矩阵 $\\begin{pmatrix} u_{1}^{\\star}  u_{2}^{\\star} \\end{pmatrix}$ 的形式，给出两个测量时刻的最优EMG激励幅值作为最终答案。\n- 最终答案应仅以 $A$ 的函数形式符号化表示。在最终的方框答案中不要包含单位。",
            "solution": "用户希望我解决一个与Hill型肌肉模型相关的系统辨识问题。\n\n### 问题验证\n\n**第1步：提取已知信息**\n\n- **模型几何与运动学：**\n  - 关节角度：$q(t)$（预设，已知无误）。\n  - 力臂：$r$（常数）。\n  - 肌腱：刚性。\n  - 肌肉肌腱长度：$l_{m}(q) = l_{m,\\mathrm{ref}} - r\\,(q - q_{\\mathrm{ref}})$，其中 $l_{m,\\mathrm{ref}}$ 和 $q_{\\mathrm{ref}}$ 为已知常数。\n  - 羽状角：可忽略。\n- **肌肉模型（Hill型）：**\n  - 激励：来自肌电图（EMG）的 $u(t)$。\n  - 激活度：$a(t)$。\n  - 准静态假设：$a(t) \\approx u(t)$。\n  - 力-速度因子：$f_{v} \\approx 1$。\n  - 被动力：可忽略。\n  - 主动肌力：$F_{\\mathrm{act}}(t) = a(t)\\,F_{\\max}\\,f_{\\ell}(\\lambda(t))$。\n  - 最大等长力：$F_{\\max}$。\n  - 最优肌纤维长度：$l_{0}$。\n  - 归一化肌纤维长度：$\\lambda(t) = l_{m}(t)/l_{0}$。\n  - 主动力-长度曲线：$f_{\\ell}(\\lambda) = \\exp\\left(-\\frac{(\\lambda - 1)^{2}}{w^{2}}\\right)$，其中宽度参数 $w > 0$ 已知。\n- **关节力矩：**\n  - 力矩方程：$\\tau(t) = r\\,F_{\\mathrm{act}}(t)$。\n- **实验设置：**\n  - 在 $t_{1}$ 和 $t_{2}$ 时刻进行两次测量。\n  - 相应条件：$q_{1} = q(t_{1})$，$l_{m,1} = l_{m}(q_{1})$，$\\lambda_{1} = l_{m,1}/l_{0}$，$u_{1} = u(t_{1})$。\n  - 相应条件：$q_{2} = q(t_{2})$，$l_{m,2} = l_{m}(q_{2})$，$\\lambda_{2} = l_{m,2}/l_{0}$，$u_{2} = u(t_{2})$。\n  - 假设：$q_{1} \\neq q_{2}$。\n  - 测量噪声：独立、零均值、方差为 $\\sigma^{2}$ 的高斯噪声。\n  - 激励预算约束：$u_{1}^{2} + u_{2}^{2} = A^{2}$，给定 $A > 0$。\n  - 激励范围：$0 \\leq u_{k} \\leq 1$。假设最优的 $u_1, u_2$ 在此范围内。\n- **待辨识参数：**\n  - 参数向量：$\\theta = \\begin{pmatrix} F_{\\max}  l_{0} \\end{pmatrix}^{\\mathsf{T}}$。\n- **任务：**\n  1. 推导灵敏度向量 $s(t) = \\begin{pmatrix} \\frac{\\partial \\tau(t)}{\\partial F_{\\max}}  \\frac{\\partial \\tau(t)}{\\partial l_{0}} \\end{pmatrix}^{\\mathsf{T}}$。\n  2. 定义费雪信息矩阵 $\\mathcal{I}(\\theta) = \\frac{1}{\\sigma^{2}}\\sum_{k=1}^{2} s(t_{k})\\,s(t_{k})^{\\mathsf{T}}$，并在给定的预算约束下，找到使 $\\det(\\mathcal{I})$ 最大化的最优 $u_{1}, u_{2}$。\n\n**第2步：使用提取的已知信息进行验证**\n\n- **科学依据：** 该问题使用了简化但标准的Hill型肌肉模型，这是生物力学领域的基石。系统辨识、灵敏度分析和费雪信息的概念是工程和科学领域中用于参数估计和实验设计的标准方法。在生物力学建模的背景下，所有前提在事实上和科学上都是合理的。\n- **良构性：** 问题定义清晰。它要求进行具体的推导和一个具有明确目标函数和约束的优化问题。非共线性假设（$q_{1} \\neq q_{2}$）确保了费雪信息矩阵是可逆的，这使得优化有意义。\n- **客观性：** 问题使用精确的数学和科学语言陈述，不含主观性或个人观点。\n- **完整性与一致性：** 提供了所有必要的方程、变量和约束。明确陈述了假设（例如，准静态、被动力可忽略），这些假设旨在创建一个易于处理的问题。设置中没有矛盾之处。\n- **现实性：** 虽然是对现实的简化，但该模型和问题结构代表了生物力学领域的实际研究问题。条件在物理上是合理的。\n\n**第3步：结论与行动**\n\n该问题科学合理、良构、客观且自洽。这是一个有效的问题。\n\n### 解题过程\n\n**任务1：推导灵敏度向量**\n\n关节力矩 $\\tau(t)$ 由力臂 $r$ 和主动肌力 $F_{\\mathrm{act}}(t)$ 的乘积给出。\n首先，我们通过代入给定的模型分量来写出扭矩的完整表达式：\n$$\n\\tau(t) = r \\, F_{\\mathrm{act}}(t) = r \\, a(t) \\, F_{\\max} \\, f_{\\ell}(\\lambda(t))\n$$\n使用准静态假设 $a(t) \\approx u(t)$ 和力-长度关系 $f_{\\ell}(\\lambda)$ 的定义，我们得到：\n$$\n\\tau(t) = r \\, u(t) \\, F_{\\max} \\, \\exp\\left(-\\frac{(\\lambda(t) - 1)^{2}}{w^{2}}\\right)\n$$\n其中归一化肌纤维长度为 $\\lambda(t) = l_{m}(t)/l_{0}$。待辨识的参数是 $\\theta = \\begin{pmatrix} F_{\\max}  l_{0} \\end{pmatrix}^{\\mathsf{T}}$。我们需要计算灵敏度向量 $s(t) = \\left( \\frac{\\partial \\tau}{\\partial F_{\\max}}, \\frac{\\partial \\tau}{\\partial l_{0}} \\right)^{\\mathsf{T}}$。\n\n1.  **对 $F_{\\max}$ 的偏导数：**\n    我们将包括 $l_{0}$ 在内的所有其他变量和参数视为常数。\n    $$\n    \\frac{\\partial \\tau(t)}{\\partial F_{\\max}} = \\frac{\\partial}{\\partial F_{\\max}} \\left[ r \\, u(t) \\, F_{\\max} \\, f_{\\ell}(\\lambda(t)) \\right] = r \\, u(t) \\, f_{\\ell}(\\lambda(t))\n    $$\n    这是因为 $\\lambda(t)=l_m(t)/l_0$ 不依赖于 $F_{max}$。\n\n2.  **对 $l_{0}$ 的偏导数：**\n    这需要使用链式法则，因为 $\\tau(t)$ 通过归一化长度 $\\lambda(t)$ 依赖于 $l_{0}$。\n    $$\n    \\frac{\\partial \\tau(t)}{\\partial l_{0}} = r \\, u(t) \\, F_{\\max} \\, \\frac{\\partial}{\\partial l_{0}} \\left[ f_{\\ell}(\\lambda(t)) \\right]\n    $$\n    使用链式法则：$\\frac{\\partial f_{\\ell}}{\\partial l_{0}} = \\frac{d f_{\\ell}}{d \\lambda} \\frac{\\partial \\lambda}{\\partial l_{0}}$。\n    我们来计算每个部分：\n    - 力-长度曲线 $f_{\\ell}(\\lambda)$ 对 $\\lambda$ 的导数：\n      $$\n      \\frac{d f_{\\ell}}{d \\lambda} = \\frac{d}{d \\lambda} \\exp\\left(-\\frac{(\\lambda - 1)^{2}}{w^{2}}\\right) = \\exp\\left(-\\frac{(\\lambda - 1)^{2}}{w^{2}}\\right) \\cdot \\left( -\\frac{2(\\lambda - 1)}{w^{2}} \\right) = -f_{\\ell}(\\lambda) \\frac{2(\\lambda - 1)}{w^{2}}\n      $$\n    - $\\lambda(t)$ 对 $l_{0}$ 的偏导数：\n      $$\n      \\frac{\\partial \\lambda(t)}{\\partial l_{0}} = \\frac{\\partial}{\\partial l_{0}} \\left( \\frac{l_{m}(t)}{l_{0}} \\right) = - \\frac{l_{m}(t)}{l_{0}^{2}} = - \\frac{\\lambda(t)}{l_{0}}\n      $$\n    - 结合这些结果：\n      $$\n      \\frac{\\partial f_{\\ell}}{\\partial l_{0}} = \\left( -f_{\\ell}(\\lambda(t)) \\frac{2(\\lambda(t) - 1)}{w^{2}} \\right) \\left( - \\frac{\\lambda(t)}{l_{0}} \\right) = f_{\\ell}(\\lambda(t)) \\frac{2 \\lambda(t) (\\lambda(t) - 1)}{l_{0} w^{2}}\n      $$\n    - 代回 $\\frac{\\partial \\tau(t)}{\\partial l_{0}}$ 的表达式中：\n      $$\n      \\frac{\\partial \\tau(t)}{\\partial l_{0}} = r \\, u(t) \\, F_{\\max} \\, \\left( f_{\\ell}(\\lambda(t)) \\frac{2 \\lambda(t) (\\lambda(t) - 1)}{l_{0} w^{2}} \\right)\n      $$\n      这可以更紧凑地写为：\n      $$\n      \\frac{\\partial \\tau(t)}{\\partial l_{0}} = \\left( r \\, u(t) \\, f_{\\ell}(\\lambda(t)) \\right) \\frac{2 F_{\\max} \\lambda(t) (\\lambda(t) - 1)}{l_{0} w^{2}}\n      $$\n\n3.  **组装灵敏度向量 $s(t)$：**\n    使用 $a(t) = u(t)$，灵敏度向量为：\n    $$\n    s(t) = \\begin{pmatrix} \\frac{\\partial \\tau(t)}{\\partial F_{\\max}} \\\\ \\\\ \\frac{\\partial \\tau(t)}{\\partial l_{0}} \\end{pmatrix} = \\begin{pmatrix} r \\, u(t) \\, f_{\\ell}(\\lambda(t)) \\\\ \\\\ r \\, u(t) \\, F_{\\max} \\, f_{\\ell}(\\lambda(t)) \\frac{2 \\lambda(t) (\\lambda(t) - 1)}{l_{0} w^{2}} \\end{pmatrix}\n    $$\n    我们可以提取公因式：\n    $$\n    s(t) = r \\, u(t) \\, f_{\\ell}(\\lambda(t)) \\begin{pmatrix} 1 \\\\ \\\\ \\frac{2 F_{\\max} \\lambda(t) (\\lambda(t) - 1)}{l_{0} w^{2}} \\end{pmatrix}\n    $$\n    这个表达式是按照要求用 $r$、$a(t)=u(t)$、$F_{\\max}$、$l_{m}(t)$（通过 $\\lambda(t)$）、$l_{0}$ 和 $w$ 表示的。\n\n**任务2：确定最优EMG激励**\n\n双测量实验的费雪信息矩阵（FIM）由下式给出：\n$$\n\\mathcal{I}(\\theta) = \\frac{1}{\\sigma^{2}}\\sum_{k=1}^{2} s(t_{k})\\,s(t_{k})^{\\mathsf{T}} = \\frac{1}{\\sigma^{2}} \\left( s_{1}s_{1}^{\\mathsf{T}} + s_{2}s_{2}^{\\mathsf{T}} \\right)\n$$\n其中 $s_{k} = s(t_k)$。从任务1中，我们可以看到灵敏度向量 $s_k$ 对激励 $u_k$ 是线性的。我们可以写成 $s_k = u_k v_k$，其中 $v_k$ 是一个取决于时刻 $t_k$ 系统属性但与控制输入 $u_k$ 无关的向量：\n$$\nv_k = r \\, f_{\\ell}(\\lambda_k) \\begin{pmatrix} 1 \\\\ \\\\ \\frac{2 F_{\\max} \\lambda_k (\\lambda_k - 1)}{l_{0} w^{2}} \\end{pmatrix}\n$$\n将 $s_k = u_k v_k$ 代入FIM表达式中：\n$$\n\\mathcal{I} = \\frac{1}{\\sigma^{2}} \\left( (u_{1}v_{1})(u_{1}v_{1})^{\\mathsf{T}} + (u_{2}v_{2})(u_{2}v_{2})^{\\mathsf{T}} \\right) = \\frac{1}{\\sigma^{2}} \\left( u_{1}^{2} v_{1}v_{1}^{\\mathsf{T}} + u_{2}^{2} v_{2}v_{2}^{\\mathsf{T}} \\right)\n$$\n令 $V$ 是一个 $2 \\times 2$ 矩阵，其列为 $v_1$ 和 $v_2$，即 $V = \\begin{pmatrix} v_1  v_2 \\end{pmatrix}$。令 $U^2$ 是对角矩阵 $\\mathrm{diag}(u_{1}^2, u_{2}^2)$。FIM可以写成 $\\mathcal{I} = \\frac{1}{\\sigma^2} V U^2 V^{\\mathsf{T}}$。\n我们想最大化FIM的行列式 $\\det(\\mathcal{I})$。利用性质 $\\det(ABC) = \\det(A)\\det(B)\\det(C)$：\n$$\n\\det(\\mathcal{I}) = \\det\\left(\\frac{1}{\\sigma^2} V U^2 V^{\\mathsf{T}}\\right) = \\left(\\frac{1}{\\sigma^2}\\right)^2 \\det(V) \\det(U^2) \\det(V^{\\mathsf{T}})\n$$\n由于 $\\det(V^{\\mathsf{T}}) = \\det(V)$ 且 $\\det(U^2) = u_{1}^{2}u_{2}^{2}$：\n$$\n\\det(\\mathcal{I}) = \\frac{1}{\\sigma^4} (\\det(V))^{2} u_{1}^{2}u_{2}^{2}\n$$\n问题陈述 $q_1 \\neq q_2$，这意味着 $\\lambda_1 \\neq \\lambda_2$（除非 $r=0$，这是一个平凡情况）。这确保了向量 $v_1$ 和 $v_2$ 不共线，因此 $\\det(V) \\neq 0$。项 $K = \\frac{(\\det(V))^2}{\\sigma^4}$ 是一个相对于优化变量 $u_1$ 和 $u_2$ 的正常数。\n\n优化问题是最大化目标函数 $f(u_1, u_2) = K u_{1}^{2}u_{2}^{2}$，约束条件为 $g(u_1, u_2) = u_{1}^{2} + u_{2}^{2} - A^2 = 0$，且 $u_1, u_2 \\ge 0$。最大化 $K u_{1}^{2}u_{2}^{2}$ 等价于最大化乘积 $P = u_{1}^{2}u_{2}^{2}$。\n\n令 $x = u_{1}^{2}$ 和 $y = u_{2}^{2}$。问题变为：\n- 最大化 $P = xy$\n- 约束条件为 $x + y = A^2$，其中 $x \\geq 0$，$y \\geq 0$。\n\n这是一个经典问题。根据算术平均数-几何平均数（AM-GM）不等式，对于非负的 $x$ 和 $y$：\n$$\n\\frac{x+y}{2} \\geq \\sqrt{xy}\n$$\n代入约束条件 $x+y = A^2$：\n$$\n\\frac{A^2}{2} \\geq \\sqrt{P} \\implies P \\leq \\frac{A^4}{4}\n$$\n当且仅当 $x=y$ 时，等号成立，此时 $P$ 达到最大值。\n因此，我们必须有 $u_{1}^{2} = u_{2}^{2}$。由于激励 $u_1$ 和 $u_2$ 必须是非负的（$0 \\le u_k \\le 1$），这意味着 $u_1=u_2$。\n\n将 $u_1=u_2$ 代入约束方程中：\n$$\nu_{1}^{2} + u_{1}^{2} = A^2 \\implies 2u_{1}^{2} = A^2 \\implies u_{1}^{2} = \\frac{A^2}{2}\n$$\n取正平方根得到最优激励：\n$$\nu_{1}^{\\star} = \\frac{A}{\\sqrt{2}}\n$$\n并且由于 $u_2 = u_1$，我们有：\n$$\nu_{2}^{\\star} = \\frac{A}{\\sqrt{2}}\n$$\n问题说明假设 $A$ 的值使得这些最优值落在允许的范围 $[0, 1]$ 内，所以我们不需要考虑边界解。\n\n最优的EMG激励幅值为 $\\begin{pmatrix} u_{1}^{\\star}  u_{2}^{\\star} \\end{pmatrix} = \\begin{pmatrix} \\frac{A}{\\sqrt{2}}  \\frac{A}{\\sqrt{2}} \\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{A}{\\sqrt{2}}  \\frac{A}{\\sqrt{2}}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}