{
    "hands_on_practices": [
        {
            "introduction": "贝叶斯参数估计的第一步是将模型的预测与观测数据联系起来。本练习将指导您推导最常用的似然函数——高斯似然函数。通过将运动学轨迹上的独立高斯测量误差假设转化为精确的数学表达式，您将掌握构建贝叶斯模型核心构件的基本技能。",
            "id": "4157236",
            "problem": "考虑一个正向动力学肌肉骨骼模型，该模型将参数向量 $\\theta$ 确定性地映射到单个标量关节角度在有限观测窗口 $t \\in [0,T]$ 内的连续时间运动学轨迹 $x(t;\\theta)$。动作捕捉在采样时间 $t_{1}, t_{2}, \\dots, t_{N}$ 提供离散时间测量值，得到数据 $\\tilde{x}(t_{i})$，其中 $i=1,\\dots,N$。假设一个加性测量模型 $\\tilde{x}(t_{i}) = x(t_{i};\\theta) + \\varepsilon_{i}$，其中测量误差 $\\varepsilon_{i}$ 在不同时间点上是独立的，并服从均值为零、共同方差为 $\\sigma^{2}$ 的高斯分布。正向动力学轨迹 $x(t;\\theta)$ 是给定 $\\theta$ 时生物力学模型的输出，并假设一旦指定了 $\\theta$，该轨迹就是确定性已知的。\n\n仅使用概率论和贝叶斯推断的基本定义（特别是，似然函数定义为给定参数下观测数据的联合概率、测量误差的独立性以及高斯概率密度函数的形式），推导整个数据集 $\\{\\tilde{x}(t_{i})\\}_{i=1}^{N}$ 关于 $\\theta$ 和 $\\sigma^{2}$ 的似然函数。将你的最终结果表示为仅含 $N$、$\\sigma^{2}$ 以及在采样时刻测量数据与模型预测轨迹之间残差的单个闭式解析表达式，不要引入任何额外的参数。不需要进行数值计算。最终答案必须是单个解析表达式。最终表达式中不应包含任何单位。",
            "solution": "我们从每个离散时间点 $t_{i}$ 的生成测量模型开始：\n$$\n\\tilde{x}(t_{i}) \\;=\\; x(t_{i};\\theta) + \\varepsilon_{i},\n$$\n其中 $\\varepsilon_{i}$ 是独立的、均值为 $0$、方差为 $\\sigma^{2}$ 的高斯随机变量。跨时间点的独立性假设意味着，在所有 $N$ 个时间点上观测数据的联合概率是每个时间点上单个概率的乘积。\n\n在贝叶斯推断中，似然函数被定义为给定参数下观测数据的联合概率密度。设 $\\{\\tilde{x}(t_{i})\\}_{i=1}^{N}$ 表示观测测量值的集合。定义残差\n$$\nr_{i}(\\theta) \\;=\\; \\tilde{x}(t_{i}) - x(t_{i};\\theta).\n$$\n在加性高斯噪声模型下，每个残差 $r_{i}(\\theta)$ 是一个来自均值为 $0$、方差为 $\\sigma^{2}$ 的高斯分布的实现。均值为零、方差为 $\\sigma^{2}$ 的高斯随机变量在 $r_{i}(\\theta)$ 处的概率密度函数 (PDF) 是\n$$\n\\frac{1}{\\sqrt{2\\pi \\sigma^{2}}} \\exp\\!\\left( -\\frac{r_{i}(\\theta)^{2}}{2\\sigma^{2}} \\right).\n$$\n因为误差在不同时间点上是独立的，所以所有残差的联合 PDF 是各个 PDF 的乘积。因此，给定数据集 $\\{\\tilde{x}(t_{i})\\}_{i=1}^{N}$，关于 $\\theta$ 和 $\\sigma^{2}$ 的似然函数是\n$$\nL(\\theta,\\sigma^{2} \\mid \\{\\tilde{x}(t_{i})\\}_{i=1}^{N}) \\;=\\; \\prod_{i=1}^{N} \\frac{1}{\\sqrt{2\\pi \\sigma^{2}}} \\exp\\!\\left( -\\frac{(\\tilde{x}(t_{i}) - x(t_{i};\\theta))^{2}}{2\\sigma^{2}} \\right).\n$$\n我们可以通过合并项来简化这个乘积。归一化常数的乘积变为\n$$\n\\prod_{i=1}^{N} \\frac{1}{\\sqrt{2\\pi \\sigma^{2}}} \\;=\\; (2\\pi \\sigma^{2})^{-N/2}.\n$$\n指数项的乘积变成了指数和的指数：\n$$\n\\prod_{i=1}^{N} \\exp\\!\\left( -\\frac{(\\tilde{x}(t_{i}) - x(t_{i};\\theta))^{2}}{2\\sigma^{2}} \\right) \\;=\\; \\exp\\!\\left( -\\frac{1}{2\\sigma^{2}} \\sum_{i=1}^{N} (\\tilde{x}(t_{i}) - x(t_{i};\\theta))^{2} \\right).\n$$\n因此，闭式似然函数为\n$$\nL(\\theta,\\sigma^{2} \\mid \\{\\tilde{x}(t_{i})\\}_{i=1}^{N}) \\;=\\; (2\\pi \\sigma^{2})^{-N/2} \\exp\\!\\left( -\\frac{1}{2\\sigma^{2}} \\sum_{i=1}^{N} \\left(\\tilde{x}(t_{i}) - x(t_{i};\\theta)\\right)^{2} \\right).\n$$\n该表达式仅依赖于 $N$、$\\sigma^{2}$ 以及在采样时刻动作捕捉数据与模型预测轨迹之间的残差，符合要求。",
            "answer": "$$\\boxed{(2\\pi\\sigma^{2})^{-N/2}\\,\\exp\\!\\left(-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{N}\\bigl(\\tilde{x}(t_{i})-x(t_{i};\\theta)\\bigr)^{2}\\right)}$$"
        },
        {
            "introduction": "现实世界中的生物力学数据往往比理想的高斯噪声更复杂，包含了冲击和伪影等异常值。本练习将介绍一种更稳健的建模方法，使用重尾的学生t分布来描述测量误差。通过为地面反作用力数据构建对数似然函数，您将学会如何选择更符合数据物理特性的概率模型，从而提高参数估计的可靠性。",
            "id": "4157206",
            "problem": "考虑一个下肢逆动力学模型，该模型通过一个在 $T$ 个离散时间点上评估的确定性正向模型 $f(\\theta)$，从一组参数 $\\theta \\in \\mathbb{R}^{p}$ 预测垂直地面反作用力 (GRF) 时间序列。令观测到的GRF数据为向量 $y = (y_{1}, \\dots, y_{T})$，并将在这些相同时间点的正向模型预测值表示为 $f_{t}(\\theta)$，其中 $t = 1, \\dots, T$。假设一个生成式测量模型 $y_{t} = f_{t}(\\theta) + \\varepsilon_{t}$，其中误差 $\\varepsilon_{t}$ 根据自由度为 $\\nu > 0$、位置参数为零、尺度参数为 $\\sigma > 0$ 的学生t分布 (Student-$t$ distribution) 独立同分布。将 $\\nu$ 和 $\\sigma$ 视为已知的超参数。利用时间上的独立性假设和学生t概率密度的基本定义，推导对数似然 $\\ln p(y \\mid \\theta, \\nu, \\sigma)$ 作为 $\\theta$ 的函数的精确解析表达式，并保留所有依赖于 $\\nu$ 和 $\\sigma$ 的归一化常数。你的最终表达式必须明确写成关于 $t = 1, \\dots, T$ 的求和形式，并且仅用标准函数表示。另外，请从足-地冲击和测力台的物理及仪器特性出发，在贝叶斯参数估计框架内，为使用重尾噪声对足-地接触期间的GRF测量误差进行建模提供一个有理有据的论证。不需要进行数值计算。以符号形式表示最终的对数似然表达式；不涉及四舍五入。",
            "solution": "我们将首先推导对数似然表达式，然后为选择重尾误差模型提供理由。\n\n**对数似然的推导**\n\n问题指定了一个生成式测量模型 $y_{t} = f_{t}(\\theta) + \\varepsilon_{t}$，其中 $t = 1, \\dots, T$。测量误差 $\\varepsilon_{t}$ 假定为独立同分布 (i.i.d.)，服从自由度为 $\\nu > 0$、位置参数为零 ($\\mu=0$)、尺度参数为 $\\sigma > 0$ 的学生t分布。\n\n对于一个自由度为 $\\nu$ 的变量 $z$，其标准化学生t分布的概率密度函数 (PDF) 由下式给出：\n$$\np(z \\mid \\nu) = \\frac{\\Gamma\\left(\\frac{\\nu+1}{2}\\right)}{\\sqrt{\\nu\\pi}\\Gamma\\left(\\frac{\\nu}{2}\\right)} \\left(1 + \\frac{z^2}{\\nu}\\right)^{-\\frac{\\nu+1}{2}}\n$$\n其中 $\\Gamma(\\cdot)$ 是伽马函数。\n\n对于一个具有位置参数 $\\mu$ 和尺度参数 $\\sigma$ 的一般学生t分布，变量 $x$ 的PDF可以通过变量替换 $z = \\frac{x-\\mu}{\\sigma}$ 得到：\n$$\np(x \\mid \\nu, \\mu, \\sigma) = \\frac{1}{\\sigma} p\\left(\\frac{x-\\mu}{\\sigma} \\mid \\nu\\right) = \\frac{\\Gamma\\left(\\frac{\\nu+1}{2}\\right)}{\\sigma\\sqrt{\\nu\\pi}\\Gamma\\left(\\frac{\\nu}{2}\\right)} \\left(1 + \\frac{1}{\\nu}\\left(\\frac{x-\\mu}{\\sigma}\\right)^2\\right)^{-\\frac{\\nu+1}{2}}\n$$\n在我们的例子中，随机变量是误差 $\\varepsilon_{t}$，其位置参数 $\\mu=0$，尺度参数为 $\\sigma$。因此，单个误差项 $\\varepsilon_t$ 的PDF为：\n$$\np(\\varepsilon_t \\mid \\nu, \\sigma) = \\frac{\\Gamma\\left(\\frac{\\nu+1}{2}\\right)}{\\sigma\\sqrt{\\nu\\pi}\\Gamma\\left(\\frac{\\nu}{2}\\right)} \\left(1 + \\frac{\\varepsilon_t^2}{\\nu\\sigma^2}\\right)^{-\\frac{\\nu+1}{2}}\n$$\n根据测量模型，我们有 $\\varepsilon_t = y_t - f_t(\\theta)$。由于对于给定的 $\\theta$，从 $\\varepsilon_t$ 到 $y_t$ 的变换只是一个常数 $f_t(\\theta)$ 的简单平移，因此单个观测值 $y_t$ 在参数 $\\theta$（以及超参数 $\\nu, \\sigma$）条件下的PDF为：\n$$\np(y_t \\mid \\theta, \\nu, \\sigma) = \\frac{\\Gamma\\left(\\frac{\\nu+1}{2}\\right)}{\\sigma\\sqrt{\\nu\\pi}\\Gamma\\left(\\frac{\\nu}{2}\\right)} \\left(1 + \\frac{(y_t - f_t(\\theta))^2}{\\nu\\sigma^2}\\right)^{-\\frac{\\nu+1}{2}}\n$$\n问题指出误差 $\\varepsilon_t$ 在时间上是独立的。因此，观测到整个数据向量 $y = (y_1, \\dots, y_T)$ 的似然是各个概率的乘积：\n$$\np(y \\mid \\theta, \\nu, \\sigma) = \\prod_{t=1}^{T} p(y_t \\mid \\theta, \\nu, \\sigma)\n$$\n对数似然，记为 $\\ln p(y \\mid \\theta, \\nu, \\sigma)$，是该乘积的自然对数。乘积的对数等于对数的和：\n$$\n\\ln p(y \\mid \\theta, \\nu, \\sigma) = \\ln \\left( \\prod_{t=1}^{T} p(y_t \\mid \\theta, \\nu, \\sigma) \\right) = \\sum_{t=1}^{T} \\ln p(y_t \\mid \\theta, \\nu, \\sigma)\n$$\n代入 $y_t$ 的PDF表达式：\n$$\n\\ln p(y \\mid \\theta, \\nu, \\sigma) = \\sum_{t=1}^{T} \\ln \\left[ \\frac{\\Gamma\\left(\\frac{\\nu+1}{2}\\right)}{\\sigma\\sqrt{\\nu\\pi}\\Gamma\\left(\\frac{\\nu}{2}\\right)} \\left(1 + \\frac{(y_t - f_t(\\theta))^2}{\\nu\\sigma^2}\\right)^{-\\frac{\\nu+1}{2}} \\right]\n$$\n利用对数的性质 $\\ln(AB) = \\ln A + \\ln B$ 和 $\\ln(A^k) = k \\ln A$，我们可以展开求和内的项：\n$$\n\\ln p(y_t \\mid \\theta, \\nu, \\sigma) = \\ln\\left(\\frac{\\Gamma\\left(\\frac{\\nu+1}{2}\\right)}{\\sigma\\sqrt{\\nu\\pi}\\Gamma\\left(\\frac{\\nu}{2}\\right)}\\right) - \\frac{\\nu+1}{2} \\ln\\left(1 + \\frac{(y_t - f_t(\\theta))^2}{\\nu\\sigma^2}\\right)\n$$\n项 $\\ln\\left(\\frac{\\Gamma\\left(\\frac{\\nu+1}{2}\\right)}{\\sigma\\sqrt{\\nu\\pi}\\Gamma\\left(\\frac{\\nu}{2}\\right)}\\right)$ 是归一化常数的对数。我们可以进一步展开这个常数项：\n$$\n\\ln\\Gamma\\left(\\frac{\\nu+1}{2}\\right) - \\ln\\Gamma\\left(\\frac{\\nu}{2}\\right) - \\ln(\\sigma) - \\ln(\\sqrt{\\nu\\pi}) = \\ln\\Gamma\\left(\\frac{\\nu+1}{2}\\right) - \\ln\\Gamma\\left(\\frac{\\nu}{2}\\right) - \\ln\\sigma - \\frac{1}{2}\\ln(\\nu) - \\frac{1}{2}\\ln(\\pi)\n$$\n该项对于求和指数 $t$ 和模型参数 $\\theta$ 是常数。完整的对数似然则由所有时间点的总和给出：\n$$\n\\ln p(y \\mid \\theta, \\nu, \\sigma) = \\sum_{t=1}^{T} \\left[ \\ln\\Gamma\\left(\\frac{\\nu+1}{2}\\right) - \\ln\\Gamma\\left(\\frac{\\nu}{2}\\right) - \\frac{1}{2}\\ln(\\nu\\pi) - \\ln\\sigma - \\frac{\\nu+1}{2} \\ln\\left(1 + \\frac{(y_t - f_t(\\theta))^2}{\\nu\\sigma^2}\\right) \\right]\n$$\n这就是所要求的表达式，它被明确写成关于 $t=1, \\dots, T$ 的求和形式，并保留了所有归一化常数。\n\n**重尾噪声模型的理由**\n\n选择使用重尾分布（如学生t分布）来为地面反作用力 (GRF) 数据中的测量误差建模，是一个基于生物力学数据采集中物理和仪器现实的有理有据的决定。标准的高斯误差模型假设与模型预测的偏差是小而频繁的，而大的偏差则极为罕见。在足-地冲击动力学的背景下，这一假设常常被违反。\n\n1. **冲击的物理性质：** 足-地接触事件，尤其是在跑步等活动中，并不是一个完全平滑的力传递过程。它是一个快速、高频的事件，可能在测力台及其周围结构中激发瞬态振动。这些振动虽然是测量信号的一部分，但可能不是一个确定性的、较低频率的生物力学模型 $f(\\theta)$ 设计用来捕捉的成分。这些未被建模的机械伪迹可能在GRF时间序列中表现为尖锐、短暂的峰值，相对于模型的预测，它们看起来就像是大幅度的“误差”或离群值。\n\n2. **仪器与信号特性：** 测力台虽然高度灵敏，但会受到各种噪声源的影响。除了典型的电子噪声（可能是高斯分布的）之外，信号还可能受到来自冲击本身或外部来源的高频伪迹的污染。这些伪迹导致数据点显著偏离潜在的平滑生物力学信号。\n\n3. **参数估计的稳健性：** 在贝叶斯框架中，似然函数决定了数据如何为参数 $\\theta$ 的后验分布提供信息。高斯似然对应于最小化误差平方和的目标。二次惩罚意味着单个离群值（一个大的残差 $y_t - f_t(\\theta)$）会对参数估计产生不成比例的巨大影响，从而使整个模型拟合产生偏差。模型会扭曲自身以适应离群值，从而损害其对大部分“表现良好”数据的拟合效果。\n\n学生t分布为稳健估计提供了一种机制。其PDF具有重尾特性，以幂律 ($|\\varepsilon_t|^{-(\\nu+1)}$) 衰减，而不是高斯分布的快速指数衰减 ($\\exp(-\\varepsilon_t^2)$)。从负对数似然的角度来看，高斯误差的惩罚呈二次增长 ($(\\varepsilon_t)^2$)，而学生t误差的惩罚则呈对数增长 ($\\ln(1 + \\varepsilon_t^2/\\nu\\sigma^2)$)。这种对数增长意味着大的误差（离群值）对目标函数的贡献要小得多。模型有效地“降权”了这些离群值，将它们识别为在假定的数据生成过程中是合理的、尽管不常见的事件。因此，得到的参数估计 $\\theta$ 更加稳健，反映了数据的主要趋势，而不会被GRF测量中固有的伪峰和伪迹过度干扰。",
            "answer": "$$\n\\boxed{\\sum_{t=1}^{T} \\left[ \\ln\\Gamma\\left(\\frac{\\nu+1}{2}\\right) - \\ln\\Gamma\\left(\\frac{\\nu}{2}\\right) - \\frac{1}{2}\\ln(\\nu\\pi) - \\ln\\sigma - \\frac{\\nu+1}{2} \\ln\\left(1 + \\frac{(y_t - f_t(\\theta))^2}{\\nu\\sigma^2}\\right) \\right]}\n$$"
        },
        {
            "introduction": "获得参数的后验分布后，下一个关键步骤是解读其含义，特别是诊断模型中潜在的问题。本练习将重点探讨参数可辨识性问题，即模型中不同参数的效应是否能够被数据明确区分。通过计算和解释高度相关的肌肉参数之间的后验协方差，您将学会如何利用后验分布作为诊断工具，以揭示模型结构或实验设计中的内在缺陷。",
            "id": "4157241",
            "problem": "一项单自由度肘关节屈曲实验在准静态条件下进行，因此动态效应可以忽略不计。在第 $i$ 次试验中，净关节力矩 $y_i$ 被建模为肌肉贡献的总和，该贡献与关节角度和肌腱几何结构的已知函数成比例，从而产生一个包含两个无量纲参数的线性化观测模型：归一化激活增益 $\\theta_1$ 和归一化串联弹性刚度缩放 $\\theta_2$。在固定姿势的微小变化下，力矩被建模为\n$$\ny_i \\approx h_{i1}\\,\\theta_1 + h_{i2}\\,\\theta_2 + \\varepsilon_i,\n$$\n其中 $\\varepsilon_i$ 代表未建模的变异性和传感器噪声。系数 $h_{i1}$ 和 $h_{i2}$ 分别由力臂以及肌腱单位力对 $\\theta_1$ 和 $\\theta_2$ 的局部敏感性决定。\n\n假设三次试验的设计矩阵为\n$$\nX=\\begin{pmatrix}\nh_{11}  h_{12} \\\\\nh_{21}  h_{22} \\\\\nh_{31}  h_{32}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1.00  0.98 \\\\\n0.50  0.49 \\\\\n0.20  0.21\n\\end{pmatrix},\n$$\n观测到的力矩为\n$$\ny=\\begin{pmatrix}\n1.49 \\\\\n0.73 \\\\\n0.32\n\\end{pmatrix}.\n$$\n假设噪声为独立同分布的加性噪声，$\\varepsilon \\sim \\mathcal{N}(0,\\sigma^2 I)$，其中 $\\sigma^2=0.50$，并且参数 $\\theta=\\begin{pmatrix}\\theta_1 \\\\ \\theta_2\\end{pmatrix}$ 服从独立的高斯先验，$\\theta \\sim \\mathcal{N}(\\mu_0,\\Sigma_0)$，其中 $\\mu_0=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$ 且 $\\Sigma_0=\\operatorname{diag}(10,10)$。使用贝叶斯定理和高斯分布的标准性质，推导后验分布 $p(\\theta \\mid y)$ 并计算 $\\theta_1$ 和 $\\theta_2$ 之间的后验协方差（即 $2\\times 2$ 后验协方差矩阵的非对角线项）。解释该协方差的符号和大小如何揭示模型中因 $X$ 的近似共线性而引起的可辨识性问题。\n\n将您计算的后验协方差最终数值结果四舍五入到四位有效数字。将其报告为一个纯数（无量纲）。",
            "solution": "该问题要求推导一个线性生物力学模型参数的后验分布，并计算这些参数之间的后验协方差。该模型由方程 $y = X\\theta + \\varepsilon$ 给出，其中 $y$ 是观测到的力矩向量，$X$ 是设计矩阵，$\\theta$ 是参数向量，$\\varepsilon$ 是噪声向量。\n\n这是一个标准的贝叶斯线性回归问题。贝叶斯模型的组成部分是：\n1.  **似然（Likelihood）**：假设噪声是高斯的，$\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2 I)$。这意味着给定参数的数据似然也是高斯的：\n    $$\n    p(y \\mid \\theta) = \\mathcal{N}(X\\theta, \\sigma^2 I) \\propto \\exp\\left( -\\frac{1}{2\\sigma^2}(y - X\\theta)^T (y - X\\theta) \\right)\n    $$\n2.  **先验（Prior）**：假设参数具有高斯先验分布：\n    $$\n    p(\\theta) = \\mathcal{N}(\\mu_0, \\Sigma_0) \\propto \\exp\\left( -\\frac{1}{2}(\\theta - \\mu_0)^T \\Sigma_0^{-1} (\\theta - \\mu_0) \\right)\n    $$\n\n根据贝叶斯定理，后验分布与似然和先验的乘积成正比：$p(\\theta \\mid y) \\propto p(y \\mid \\theta)p(\\theta)$。由于似然和先验都是高斯分布，后验分布也是高斯分布，$p(\\theta \\mid y) = \\mathcal{N}(\\mu_N, \\Sigma_N)$。\n\n后验协方差矩阵 $\\Sigma_N$ 和后验均值向量 $\\mu_N$ 由贝叶斯线性回归的标准公式给出：\n$$\n\\Sigma_N = \\left(\\Sigma_0^{-1} + \\frac{1}{\\sigma^2} X^T X \\right)^{-1}\n$$\n$$\n\\mu_N = \\Sigma_N \\left(\\Sigma_0^{-1} \\mu_0 + \\frac{1}{\\sigma^2} X^T y \\right)\n$$\n问题要求计算 $\\theta_1$ 和 $\\theta_2$ 之间的后验协方差，即后验协方差矩阵 $\\Sigma_N$ 的非对角线元素。我们现在来计算这个矩阵。\n\n给定的值为：\n- 设计矩阵：$X = \\begin{pmatrix} 1.00  0.98 \\\\ 0.50  0.49 \\\\ 0.20  0.21 \\end{pmatrix}$\n- 观测到的力矩：$y = \\begin{pmatrix} 1.49 \\\\ 0.73 \\\\ 0.32 \\end{pmatrix}$（计算协方差时不需要此值）\n- 噪声方差：$\\sigma^2 = 0.50$\n- 先验均值：$\\mu_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$\n- 先验协方差：$\\Sigma_0 = \\begin{pmatrix} 10  0 \\\\ 0  10 \\end{pmatrix}$\n\n首先，我们计算先验协方差矩阵的逆，$\\Sigma_0^{-1}$：\n$$\n\\Sigma_0^{-1} = \\begin{pmatrix} 10  0 \\\\ 0  10 \\end{pmatrix}^{-1} = \\begin{pmatrix} \\frac{1}{10}  0 \\\\ 0  \\frac{1}{10} \\end{pmatrix} = \\begin{pmatrix} 0.1  0 \\\\ 0  0.1 \\end{pmatrix}\n$$\n\n接下来，我们计算矩阵乘积 $X^T X$：\n$$\nX^T X = \\begin{pmatrix} 1.00  0.50  0.20 \\\\ 0.98  0.49  0.21 \\end{pmatrix} \\begin{pmatrix} 1.00  0.98 \\\\ 0.50  0.49 \\\\ 0.20  0.21 \\end{pmatrix}\n$$\n各元素为：\n- $(X^T X)_{11} = (1.00)^2 + (0.50)^2 + (0.20)^2 = 1.00 + 0.25 + 0.04 = 1.29$\n- $(X^T X)_{12} = (1.00)(0.98) + (0.50)(0.49) + (0.20)(0.21) = 0.98 + 0.245 + 0.042 = 1.267$\n- $(X^T X)_{21} = (X^T X)_{12} = 1.267$\n- $(X^T X)_{22} = (0.98)^2 + (0.49)^2 + (0.21)^2 = 0.9604 + 0.2401 + 0.0441 = 1.2446$\n所以，\n$$\nX^T X = \\begin{pmatrix} 1.29  1.267 \\\\ 1.267  1.2446 \\end{pmatrix}\n$$\n\n现在，我们计算 $\\frac{1}{\\sigma^2} X^T X$ 项，这是似然的精度矩阵：\n$$\n\\frac{1}{\\sigma^2} X^T X = \\frac{1}{0.50} \\begin{pmatrix} 1.29  1.267 \\\\ 1.267  1.2446 \\end{pmatrix} = 2 \\begin{pmatrix} 1.29  1.267 \\\\ 1.267  1.2446 \\end{pmatrix} = \\begin{pmatrix} 2.58  2.534 \\\\ 2.534  2.4892 \\end{pmatrix}\n$$\n\n后验精度矩阵 $\\Sigma_N^{-1}$ 是先验精度和似然精度的和：\n$$\n\\Sigma_N^{-1} = \\Sigma_0^{-1} + \\frac{1}{\\sigma^2} X^T X = \\begin{pmatrix} 0.1  0 \\\\ 0  0.1 \\end{pmatrix} + \\begin{pmatrix} 2.58  2.534 \\\\ 2.534  2.4892 \\end{pmatrix} = \\begin{pmatrix} 2.68  2.534 \\\\ 2.534  2.5892 \\end{pmatrix}\n$$\n\n最后，我们通过对后验精度矩阵 $\\Sigma_N^{-1}$ 求逆来找到后验协方差矩阵 $\\Sigma_N$。对于一个 $2 \\times 2$ 矩阵 $A = \\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$，其逆为 $A^{-1} = \\frac{1}{ad-bc} \\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$。\n$\\Sigma_N^{-1}$ 的行列式为：\n$$\n\\det(\\Sigma_N^{-1}) = (2.68)(2.5892) - (2.534)^2 = 6.939056 - 6.421156 = 0.5179\n$$\n现在，我们计算其逆：\n$$\n\\Sigma_N = \\frac{1}{0.5179} \\begin{pmatrix} 2.5892  -2.534 \\\\ -2.534  2.68 \\end{pmatrix}\n$$\n$\\theta_1$ 和 $\\theta_2$ 之间的后验协方差是该矩阵的非对角线元素 $\\Sigma_{N,12}$：\n$$\n\\operatorname{Cov}(\\theta_1, \\theta_2 \\mid y) = \\Sigma_{N,12} = \\frac{-2.534}{0.5179} \\approx -4.8930295...\n$$\n四舍五入到四位有效数字，后验协方差为 $-4.893$。\n\n**结果解释：**\n设计矩阵 $X$ 表现出近似共线性，因为它的列几乎是线性相关的。第二列几乎是第一列的倍数（例如，$h_{12}=0.98 \\cdot h_{11}$ 和 $h_{22}=0.98 \\cdot h_{21}$）。这意味着模型输出 $y_i \\approx h_{i1}\\theta_1 + h_{i2}\\theta_2$ 对参数的某个特定线性组合（近似为 $h_{i1}(\\theta_1 + 0.98\\theta_2)$）敏感，而不是对 $\\theta_1$ 和 $\\theta_2$ 单独敏感。\n\n这种对输出缺乏独立影响的情况是一个典型的参数可辨识性问题。能够保持和 $\\theta_1 + 0.98\\theta_2$ 恒定的不同 $(\\theta_1, \\theta_2)$ 对会产生非常相似的模型预测，因此具有相似的似然值。这在 $(\\theta_1, \\theta_2)$ 参数空间中的似然函数上形成了一个长而窄的“山脊”，其方向沿着直线 $\\theta_1 + 0.98\\theta_2 = \\text{常数}$。\n\n后验分布 $p(\\theta \\mid y)$ 是似然和先验的乘积。虽然宽的、不相关的先验 $\\mathcal{N}(0, 10I)$ 有助于对问题进行正则化并产生一个正常的后验分布，但这个后验的形状主要由似然中的山脊决定。结果是一个形状像一个窄而倾斜的椭圆的后验分布。\n\n后验协方差 $\\operatorname{Cov}(\\theta_1, \\theta_2 \\mid y)$ 从数学上捕捉了这种关系。\n- **符号**：协方差值很大且为负（$-4.893$）。这反映了上面确定的权衡关系：为了保持和 $\\theta_1 + 0.98\\theta_2$ 恒定，$\\theta_1$ 的增加必须由 $\\theta_2$ 的减少来补偿。这导致它们的联合后验分布中存在强烈的负相关性。\n- **大小**：相对于参数的方差，协方差的绝对值很大。我们可以计算后验相关系数 $\\rho$：\n$$\n\\rho = \\frac{\\operatorname{Cov}(\\theta_1, \\theta_2 \\mid y)}{\\sqrt{\\operatorname{Var}(\\theta_1 \\mid y)\\operatorname{Var}(\\theta_2 \\mid y)}} = \\frac{-2.534/0.5179}{\\sqrt{(2.5892/0.5179)(2.68/0.5179)}} = \\frac{-2.534}{\\sqrt{2.5892 \\times 2.68}} \\approx -0.962\n$$\n一个约等于 $-0.962$ 的相关系数，非常接近 $-1$，证实了在后验中参数之间存在极强的负线性关系。这种高绝对值表明，尽管数据（连同先验）可以将参数约束在参数空间中的一条细线上，但它们无法有效地区分该线上的不同点。这是由实验设计（即 $X$ 的近似共线性）导致的严重可辨识性问题的标志。",
            "answer": "$$\\boxed{-4.893}$$"
        }
    ]
}