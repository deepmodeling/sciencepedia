{
    "hands_on_practices": [
        {
            "introduction": "在将人工智能（AI）和机器人技术应用于牙科之前，理解其处理的数据的基础特性至关重要。本练习将引导你完成一项基础但关键的计算：估算一个典型的锥形束计算机断层扫描（CBCT）数据集所需的原始存储空间。这项技能对于为远程诊断和机器人规划系统配置适当的计算资源（如GPU内存）是必不可少的。",
            "id": "4694082",
            "problem": "一个远程牙科平台在远程会诊期间，将人工智能 (AI) 辅助分割和机器人规划直接集成在锥形束计算机断层扫描 (CBCT) 数据集上。为确保传输到 AI 模块的未压缩 CBCT 数据体有足够的图形处理单元 (GPU) 内存，请确定一个维度为 $512 \\times 512 \\times 512$ 体素、每体素 $16$ 位的 CBCT 数据体的未压缩存储大小（以兆字节为单位）。你的推导应仅基于以下基本数据表示事实：$1$ 字节等于 $8$ 位，且此处兆字节 (MB) 定义为 $10^{6}$ 字节。请明确说明你对文件头开销的假设，并在计算中一致地使用该假设。将最终的存储大小以兆字节 (MB) 为单位表示为一个精确的小数（不要四舍五入）。",
            "solution": "该问题要求计算一个锥形束计算机断层扫描 (CBCT) 数据体的未压缩存储大小。计算将基于所提供的数据体维度、每体素的位深度以及标准数据单位转换。\n\n首先，我们必须确定题目陈述中的已知条件：\n- 数据体维度：$512 \\times 512 \\times 512$ 体素。\n- 位深度：每体素 $16$ 位。\n- 转换因子（位到字节）：$1$ 字节 = $8$ 位。\n- 转换因子（字节到兆字节）：$1$ 兆字节 (MB) = $10^{6}$ 字节。\n\n问题要求对文件头开销作出假设。为了计算原始、未压缩的体素数据本身的存储大小，我们将假设文件头开销可以忽略不计，并将其视为 $0$ 字节。在估算与任何特定文件格式元数据相区别的图像数据有效载荷大小时，这是一个标准假设。\n\n数据体中的总体素数，记为 $N_{voxels}$，是其维度的乘积：\n$$N_{voxels} = 512 \\times 512 \\times 512 = 512^{3}$$\n为了方便计算，我们可以将 $512$ 表示为 $2$ 的幂：\n$$512 = 2^{9}$$\n因此，总体素数为：\n$$N_{voxels} = (2^{9})^{3} = 2^{27}$$\n\n接下来，我们计算数据体的总大小（以位为单位），记为 $S_{bits}$。这是总体素数乘以每体素的位数。\n$$S_{bits} = N_{voxels} \\times (\\text{每体素位数})$$\n$$S_{bits} = 2^{27} \\times 16$$\n由于 $16 = 2^{4}$，我们可以写成：\n$$S_{bits} = 2^{27} \\times 2^{4} = 2^{27+4} = 2^{31} \\text{ 位}$$\n\n为了将大小从位转换为字节，我们使用给定的转换因子，其中 $1$ 字节等于 $8$ 位，即 $2^3$ 位。设以字节为单位的大小为 $S_{bytes}$。\n$$S_{bytes} = \\frac{S_{bits}}{8} = \\frac{2^{31}}{2^{3}} = 2^{31-3} = 2^{28} \\text{ 字节}$$\n\n现在我们计算 $2^{28}$ 的数值：\n$$2^{28} = 2^{8} \\times 2^{20} = 256 \\times (2^{10})^{2}$$\n我们知道 $2^{10} = 1024$。\n$$S_{bytes} = 256 \\times (1024)^{2} = 256 \\times 1,048,576 = 268,435,456 \\text{ 字节}$$\n\n最后，我们使用指定的定义 $1 \\text{ MB} = 10^{6} \\text{ bytes}$ 将大小从字节转换为兆字节 (MB)。设以兆字节为单位的大小为 $S_{MB}$。\n$$S_{MB} = \\frac{S_{bytes}}{10^{6}} = \\frac{268,435,456}{1,000,000}$$\n$$S_{MB} = 268.435456$$\n\n问题要求最终答案是一个精确的小数。计算出的值 $268.435456$ 是精确的。因此，CBCT 数据体的未压缩存储大小为 $268.435456$ MB。",
            "answer": "$$\n\\boxed{268.435456}\n$$"
        },
        {
            "introduction": "人工智能的强大之处在于它能自动将复杂的几何数据转化为具有临床意义的诊断信息，从而辅助医生进行决策。在本练习中，你将扮演AI算法的角色，应用向量几何学的基本原理，从给定的头影测量标志点三维坐标中计算出关键的正畸诊断指标——$ANB$角。这个过程将让你亲身体验自动化头影测量分析的核心数学逻辑。",
            "id": "4694099",
            "problem": "一个支持人工智能（AI）的远程牙科平台集成了机器人引导的头部定位和锥形束计算机断层扫描（CBCT）技术，以在一个头部固定的右手坐标系（单位：毫米）中自动定位头影测量标志点。在一次远程正畸评估中，该系统返回了鼻根点（Nasion）、A点和B点的三维坐标，分别为 $N = (120,\\, 90,\\, 95)$、$A = (130,\\, 90,\\, 95)$ 和 $B = (129.9756,\\, 89.3024,\\, 95)$。A点-鼻根点-B点（ANB）角定义为位于正中矢状面内两条射线 $\\,\\overrightarrow{NA}\\,$ 和 $\\,\\overrightarrow{NB}\\,$ 之间的较小平面角。\n\n请使用向量几何的基本原理，根据这些坐标计算ANB角，然后在您的推理中简要解释其在骨骼分类中的临床意义。最终角度以度为单位表示，并将答案四舍五入至$4$位有效数字。最终答案必须是答案框中的一个纯数字，不带单位。",
            "solution": "该问题是有效的、有科学依据且表述清晰的。它要求计算在三维笛卡尔坐标系中由三个点定义的两个向量之间的平面角。这是向量几何的一个标准应用。\n\nA点-鼻根点-B点（ANB）角，记作 $\\theta_{ANB}$，是从鼻根点（$N$）到A点（$A$）的向量与从鼻根点（$N$）到B点（$B$）的向量之间的夹角。设这些向量为 $\\vec{u} = \\overrightarrow{NA}$ 和 $\\vec{v} = \\overrightarrow{NB}$。\n\n三个头影测量标志点的坐标如下：\n$N = (120,\\, 90,\\, 95)$\n$A = (130,\\, 90,\\, 95)$\n$B = (129.9756,\\, 89.3024,\\, 95)$\n\n首先，我们通过将终点（$A$ 和 $B$）的坐标减去起点（$N$）的坐标来计算向量 $\\vec{u}$ 和 $\\vec{v}$ 的分量。\n\n向量 $\\vec{u} = \\overrightarrow{NA}$ 为：\n$$ \\vec{u} = A - N = (130 - 120,\\, 90 - 90,\\, 95 - 95) = (10,\\, 0,\\, 0) $$\n\n向量 $\\vec{v} = \\overrightarrow{NB}$ 为：\n$$ \\vec{v} = B - N = (129.9756 - 120,\\, 89.3024 - 90,\\, 95 - 95) = (9.9756,\\, -0.6976,\\, 0) $$\n\n两个非零向量 $\\vec{u}$ 和 $\\vec{v}$ 之间的夹角 $\\theta$ 可以使用点积公式确定：\n$$ \\vec{u} \\cdot \\vec{v} = \\|\\vec{u}\\| \\|\\vec{v}\\| \\cos(\\theta) $$\n对 $\\theta$ 重新整理，我们得到：\n$$ \\theta = \\arccos\\left(\\frac{\\vec{u} \\cdot \\vec{v}}{\\|\\vec{u}\\| \\|\\vec{v}\\|}\\right) $$\n\n接下来，我们计算点积 $\\vec{u} \\cdot \\vec{v}$：\n$$ \\vec{u} \\cdot \\vec{v} = (10)(9.9756) + (0)(-0.6976) + (0)(0) = 99.756 $$\n\n现在，我们计算向量的模（欧几里得范数），即 $\\|\\vec{u}\\|$ 和 $\\|\\vec{v}\\|$。\n向量 $\\vec{u}$ 的模为：\n$$ \\|\\vec{u}\\| = \\sqrt{10^2 + 0^2 + 0^2} = \\sqrt{100} = 10 $$\n\n向量 $\\vec{v}$ 的模为：\n$$ \\|\\vec{v}\\| = \\sqrt{(9.9756)^2 + (-0.6976)^2 + 0^2} = \\sqrt{99.51261536 + 0.48664576} = \\sqrt{99.99926112} $$\n\n现在，我们将这些值代入反余弦公式中，以弧度为单位求出角度：\n$$ \\theta = \\arccos\\left(\\frac{99.756}{10 \\sqrt{99.99926112}}\\right) $$\n$$ \\theta \\approx \\arccos\\left(\\frac{99.756}{10 \\times 9.999963056}\\right) \\approx \\arccos\\left(\\frac{9.9756}{9.999963056}\\right) $$\n$$ \\theta \\approx \\arccos(0.997563663) \\approx 0.0698188 \\text{ radians} $$\n\n问题要求角度以度为单位。我们使用转换因子 $\\frac{180}{\\pi}$ 将弧度转换为度：\n$$ \\theta_{\\text{deg}} = \\theta_{\\text{rad}} \\times \\frac{180}{\\pi} \\approx 0.0698188 \\times \\frac{180}{\\pi} \\approx 4.000325^{\\circ} $$\n\n最后，我们按照要求将结果四舍五入到$4$位有效数字。值为 $4.000325...$。前四位有效数字是 $4$、$0$、$0$ 和 $0$。第五位数字是 $3$，小于 $5$，因此我们向下舍入。\n$$ \\theta_{ANB} \\approx 4.000^{\\circ} $$\n\n在临床解读方面，ANB角是正畸学中评估上颌骨（上颚）和下颌骨（下颚）之间矢状（前后）关系的一项关键测量指标。\n- 约 $2^{\\circ}$ 的值被认为代表正常，即I类骨骼关系。\n- 显著大于 $2^{\\circ}$ 的角度，例如计算出的 $4.000^{\\circ}$，表示II类骨性错颌。这表明上颌骨相对于下颌骨位置靠前，或下颌骨相对于上颌骨位置靠后，这种情况通常与凸面型和增大的覆颌有关。\n- 显著小于 $2^{\\circ}$ 的值（包括负值）则表示III类骨骼关系，其特征是下颌前突。\n\n因此，计算出的ANB角为 $4.000^{\\circ}$ 表明该患者为II类骨性颌骨关系。",
            "answer": "$$\\boxed{4.000}$$"
        },
        {
            "introduction": "为了让AI模型能精确地从CBCT图像中分割出根尖周病变等微小结构，选择合适的损失函数来指导其训练过程是核心环节。本练习将带你深入了解在医学图像分割中广泛使用的Sørensen-Dice损失函数。通过推导其梯度，你将从根本上理解它为何能有效应对牙科图像中常见的类别不平衡问题（例如，病灶区域远小于健康组织区域）。",
            "id": "4694116",
            "problem": "一个远程牙科平台集成了卷积神经网络（CNN），用于对锥形束计算机断层扫描（CBCT）图像中的根尖周病变进行自动分割，以引导机器人根管治疗进入系统。对于单个二维切片，分割网络输出逐像素的预测值 $\\{p_{i}\\}_{i=1}^{N}$（其中 $p_{i} \\in [0,1]$），真实标签为 $\\{g_{i}\\}_{i=1}^{N}$（其中 $g_{i} \\in \\{0,1\\}$），$N$ 是切片中的总像素数。训练目标使用 Sørensen–Dice 损失函数：\n$$\nL \\;=\\; 1 \\;-\\; \\frac{2 \\sum_{j=1}^{N} p_{j} g_{j}}{\\sum_{j=1}^{N} p_{j} \\;+\\; \\sum_{j=1}^{N} g_{j}}.\n$$\n从基础微积分中偏微分和商法则的基本定义出发，推导关于单个像素索引 $i$ 的预测值 $p_{i}$ 的偏导数 $\\frac{\\partial L}{\\partial p_{i}}$ 的解析表达式。然后，使用推导出的表达式，用科学术语解释 Dice 损失如何内在地解决牙科图像中病变像素与背景像素之间的类别不平衡问题（例如，当病变像素的数量相对于背景像素较少时）。你的最终答案必须是 $\\frac{\\partial L}{\\partial p_{i}}$ 的闭式解析表达式；不需要数值近似，且不涉及单位。",
            "solution": "所述问题具有科学依据、提法明确且客观。它为医学影像机器学习背景下的标准数学推导提供了一个完整且一致的设定。任务是推导 Sørensen–Dice 损失函数的偏导数，并解释其在处理类别不平衡问题中的效用。所有必要的定义均已提供，且没有违背任何科学原理。因此，该问题是有效的，可以构建一个解决方案。\n\nSørensen–Dice 损失函数 $L$ 由下式给出：\n$$\nL = 1 - \\frac{2 \\sum_{j=1}^{N} p_{j} g_{j}}{\\sum_{j=1}^{N} p_{j} + \\sum_{j=1}^{N} g_{j}}\n$$\n其中，$\\{p_j\\}_{j=1}^N$ 是预测概率，$\\{g_j\\}_{j=1}^N$ 是真实的二元标签，$N$ 是总像素数。我们的任务是求出 $L$ 关于单个任意像素 $i$ 的预测值 $p_i$ 的偏导数。\n\n让我们将 Dice 系数 $D$ 定义为分数项：\n$$\nD = \\frac{2 \\sum_{j=1}^{N} p_{j} g_{j}}{\\sum_{j=1}^{N} p_{j} + \\sum_{j=1}^{N} g_{j}}\n$$\n因此，损失为 $L = 1 - D$。$L$ 关于 $p_i$ 的偏导数是：\n$$\n\\frac{\\partial L}{\\partial p_{i}} = \\frac{\\partial}{\\partial p_{i}}(1 - D) = - \\frac{\\partial D}{\\partial p_{i}}\n$$\n为了计算 $\\frac{\\partial D}{\\partial p_{i}}$，我们应用基础微积分中的商法则。设 $f(x) = \\frac{u(x)}{v(x)}$，则 $f'(x) = \\frac{v(x)u'(x) - u(x)v'(x)}{[v(x)]^2}$。\n对于我们的函数 $D$，变量是 $p_i$。让我们定义分子和分母函数：\n$$\nU(p_1, \\dots, p_N) = 2 \\sum_{j=1}^{N} p_{j} g_{j}\n$$\n$$\nV(p_1, \\dots, p_N) = \\sum_{j=1}^{N} p_{j} + \\sum_{j=1}^{N} g_{j}\n$$\n接下来，我们求 $U$ 和 $V$ 关于 $p_i$ 的偏导数。\n\n对于分子 $U$，求和项 $\\sum_{j=1}^{N} p_{j} g_{j}$ 是一个 $p_1 g_1 + p_2 g_2 + \\dots + p_i g_i + \\dots + p_N g_N$ 形式的和。当我们对这个和关于 $p_i$ 求导时，只有包含 $p_i$ 的项会产生非零结果。$p_i g_i$ 关于 $p_i$ 的导数是 $g_i$，因为 $g_i$ 是常数。因此：\n$$\n\\frac{\\partial U}{\\partial p_{i}} = \\frac{\\partial}{\\partial p_{i}} \\left( 2 \\sum_{j=1}^{N} p_{j} g_{j} \\right) = 2 g_{i}\n$$\n对于分母 $V$，项 $\\sum_{j=1}^{N} g_{j}$ 关于任何 $p_k$ 都是常数。项 $\\sum_{j=1}^{N} p_{j}$ 是和 $p_1 + p_2 + \\dots + p_i + \\dots + p_N$。它关于 $p_i$ 的偏导数是 $1$。因此：\n$$\n\\frac{\\partial V}{\\partial p_{i}} = \\frac{\\partial}{\\partial p_{i}} \\left( \\sum_{j=1}^{N} p_{j} + \\sum_{j=1}^{N} g_{j} \\right) = 1 + 0 = 1\n$$\n现在我们可以将这些结果代入商法则来求得 $\\frac{\\partial D}{\\partial p_{i}}$：\n$$\n\\frac{\\partial D}{\\partial p_{i}} = \\frac{V \\frac{\\partial U}{\\partial p_{i}} - U \\frac{\\partial V}{\\partial p_{i}}}{V^2} = \\frac{\\left( \\sum_{j=1}^{N} p_{j} + \\sum_{j=1}^{N} g_{j} \\right)(2 g_{i}) - \\left( 2 \\sum_{j=1}^{N} p_{j} g_{j} \\right)(1)}{\\left( \\sum_{j=1}^{N} p_{j} + \\sum_{j=1}^{N} g_{j} \\right)^2}\n$$\n最后，我们计算 $\\frac{\\partial L}{\\partial p_{i}} = - \\frac{\\partial D}{\\partial p_{i}}$：\n$$\n\\frac{\\partial L}{\\partial p_{i}} = - \\frac{2 g_{i} \\left( \\sum_{j=1}^{N} p_{j} + \\sum_{j=1}^{N} g_{j} \\right) - 2 \\sum_{j=1}^{N} p_{j} g_{j}}{\\left( \\sum_{j=1}^{N} p_{j} + \\sum_{j=1}^{N} g_{j} \\right)^2}\n$$\n重新整理分子中的各项，得到最终的解析表达式：\n$$\n\\frac{\\partial L}{\\partial p_{i}} = \\frac{2 \\sum_{j=1}^{N} p_{j} g_{j} - 2 g_{i} \\left( \\sum_{j=1}^{N} p_{j} + \\sum_{j=1}^{N} g_{j} \\right)}{\\left( \\sum_{j=1}^{N} p_{j} + \\sum_{j=1}^{N} g_{j} \\right)^2}\n$$\n这个表达式是用于反向传播中、根据对像素 $i$ 的预测来更新网络权重的梯度分量。\n\n关于 Dice 损失如何解决类别不平衡问题的科学解释在于该梯度的结构。在典型的牙科影像中，病变像素（前景，$g_j=1$）的数量远小于健康组织像素（背景，$g_j=0$）的数量。\n\n让我们将其与标准的逐像素损失函数（如二元交叉熵，BCE）进行比较，在BCE中，像素 $i$ 的梯度仅取决于局部的预测值 $p_i$ 和标签 $g_i$。在一个高度不平衡的数据集上，总损失和整体梯度由大量的背景像素主导。即使这些像素被高置信度地正确分类（例如，对于 $g_i=0$，有 $p_i \\approx 0$），它们的巨大数量也会淹没来自少数前景像素的学习信号。\n\n然而，Dice 损失的梯度在本质上是不同的。分子和分母都包含对图像中*所有*像素的求和。这意味着任何单个像素 $p_i$ 的梯度都是分割全局状态的函数，而不是一个独立的、局部的量。\n\n让我们分析背景像素（$g_i=0$）的梯度：\n$$\n\\frac{\\partial L}{\\partial p_{i}} \\bigg|_{g_i=0} = \\frac{2 \\sum_{j=1}^{N} p_{j} g_{j}}{\\left( \\sum_{j=1}^{N} p_{j} + \\sum_{j=1}^{N} g_{j} \\right)^2}\n$$\n该梯度是分子中“软”真阳性计数的函数，并被“软”预测正面积和真阳性面积之和的平方进行归一化。每个背景像素对总梯度的贡献受到模型在前景类别上整体性能的调节。如果前景很小且检测效果不佳（$\\sum p_j g_j$ 很小），则背景像素的梯度更新也很小。这可以防止易于分类的背景像素产生大的、分散注意力的梯度。\n\n相反，对于前景像素（$g_i=1$），梯度的分子更为复杂：$2(\\sum p_j g_j - \\sum p_j - \\sum g_j)$。如果整个病变区域被漏检，这一项将是强负的（从而将 $p_i$ 推向 $1$）。\n\n本质上，Dice 损失将优化问题构建为一个最大化预测前景区域与真实前景区域之间重叠的整体性任务，而不是独立逐像素分类任务的聚合。每个像素的梯度反映了其预测值的变化将如何影响这个全局重叠分数。通过相对于预测正集和真实正集的大小进行归一化，损失函数内在地平衡了学习过程，确保稀有的前景类别能够贡献实质性的训练信号，从而缓解了类别不平衡问题。",
            "answer": "$$\n\\boxed{\\frac{2 \\sum_{j=1}^{N} p_{j} g_{j} - 2 g_{i} \\left( \\sum_{j=1}^{N} p_{j} + \\sum_{j=1}^{N} g_{j} \\right)}{\\left( \\sum_{j=1}^{N} p_{j} + \\sum_{j=1}^{N} g_{j} \\right)^{2}}}\n$$"
        }
    ]
}