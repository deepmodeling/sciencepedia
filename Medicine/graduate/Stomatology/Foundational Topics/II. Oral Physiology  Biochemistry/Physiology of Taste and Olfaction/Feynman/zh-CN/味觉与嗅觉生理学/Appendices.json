{
    "hands_on_practices": [
        {
            "introduction": "对味觉生理学的理解始于细胞层面。此练习将深入探讨味觉感受器细胞内复杂的信号转导级联反应，这是甜味、鲜味和苦味感知的共同通路。通过构建从受体激活到离子通道开放的生物物理模型，您将把抽象的分子事件与神经系统通用的电信号语言——膜去极化——直接联系起来。",
            "id": "4753765",
            "problem": "菌状乳头中的一个味觉感受器细胞利用G蛋白偶联受体通路来转导苦味刺激。受体激活后，磷脂酶C-β2 (PLCβ2) 催化 1,4,5-三磷酸肌醇 ($IP_3$) 的形成，$IP_3$ 与内质网 (ER) 上的 1,4,5-三磷酸肌醇受体 (IP$_3$Rs) 结合，从而提高胞质钙离子 ($Ca^{2+}$) 浓度并激活瞬时受体电位M5通道 (TRPM5)，使细胞膜去极化。从核心生物物理学定义和经过充分检验的响应定律出发，构建一个最小符号框架，将 $[IP_3]$ 浓度的升高与 $Ca^{2+}$ 从内质网的释放以及TRPM5的激活联系起来，明确指出 IP$_3$R 开放概率对 $[IP_3]$ 和 $[Ca^{2+}]_{\\mathrm{cyt}}$ 的依赖关系，以及 TRPM5 开放概率对 $[Ca^{2+}]_{\\mathrm{cyt}}$ 的依赖关系。然后，使用电导和驱动力的定义，在以下条件下计算由TRPM5产生的稳态去极化：\n\n- 在 $Ca^{2+}$ 瞬变期间，净TRPM5电导为 $100 \\,\\mathrm{pS}$。\n- 由TRPM5介导的单价阳离子电流的驱动力为 $50 \\,\\mathrm{mV}$。\n- 在所关心的时间尺度内，细胞膜可被视为一个输入电阻为 $1 \\,\\mathrm{G}\\Omega$ 的单一等电位区室，且其他电流可以忽略不计。\n\n假设TRPM5电流是内向且去极化的。将最终数值答案四舍五入至三位有效数字，并以毫伏为单位表示去极化程度。",
            "solution": "首先评估问题的有效性。所描述的苦味信号转导通路在科学上是正确的，并且在生理学中得到了充分证实。问题是自洽的，为定量计算提供了所有必要的参数。这些参数本身（$100 \\,\\mathrm{pS}$, $50 \\,\\mathrm{mV}$, $1 \\,\\mathrm{G}\\Omega$）对于单个细胞来说在生物物理学上是现实的。因此，该问题被认为是有效的，可以构建解决方案。\n\n问题包括两个部分：首先，构建一个最小符号框架，将 1,4,5-三磷酸肌醇的浓度 $[IP_3]$ 与瞬时受体电位M5 (TRPM5) 通道的激活联系起来；其次，在指定条件下计算由此产生的稳态膜去极化。\n\n我们从符号框架开始。信号转导级联过程如下：\n1.  $[IP_3]$ 浓度的增加会激活位于内质网 (ER) 膜上的 1,4,5-三磷酸肌醇受体 (IP$_3$Rs)。\n2.  激活的 IP$_3$Rs 形成通道，将储存的钙离子 ($Ca^{2+}$) 从内质网释放到胞质中，从而增加胞质钙离子浓度 $[Ca^{2+}]_{\\mathrm{cyt}}$。\n3.  升高的 $[Ca^{2+}]_{\\mathrm{cyt}}$ 会激活 TRPM5 通道，这是一种位于质膜上的非选择性阳离子通道。\n4.  TRPM5 通道的激活导致阳离子（主要是 $Na^+$）的内向电流，引起膜去极化。\n\n让我们将这些依赖关系形式化。\n\nIP$_3$R 的开放概率，记为 $P_{\\mathrm{open, IP3R}}$，是 $[IP_3]$ 和 $[Ca^{2+}]_{\\mathrm{cyt}}$ 的一个复杂函数。该受体通过与 IP$_3$ 结合而被激活，并且也受到 $Ca^{2+}$ 本身的协同调节，通常在低微摩尔浓度的 $[Ca^{2+}]_{\\mathrm{cyt}}$ 时表现出激活，而在更高浓度时表现出抑制。一个最小化的表示可以函数式地表达为：\n$$P_{\\mathrm{open, IP3R}} = f([IP_3], [Ca^{2+}]_{\\mathrm{cyt}})$$\n一个更明确但仍简化的模型，基于协同结合（希尔方程），可以将对 $[IP_3]$ 的依赖性和 $[Ca^{2+}]_{\\mathrm{cyt}}$ 的激活效应表示为：\n$$P_{\\mathrm{open, IP3R}} \\propto \\left( \\frac{[IP_3]^m}{K_{IP3}^m + [IP_3]^m} \\right) \\left( \\frac{[Ca^{2+}]_{\\mathrm{cyt}}^n}{K_{a,Ca}^n + [Ca^{2+}]_{\\mathrm{cyt}}^n} \\right) h_{\\infty}([Ca^{2+}]_{\\mathrm{cyt}})$$\n其中 $K_{IP3}$ 和 $K_{a,Ca}$ 分别是 IP$_3$ 和 $Ca^{2+}$ 的半数最大激活常数；$m$ 和 $n$ 是它们各自的希尔系数；$h_{\\infty}([Ca^{2+}]_{\\mathrm{cyt}})$ 是一个描述在较高浓度下由 $Ca^{2+}$ 依赖的抑制作用的函数。\n\n从内质网流出的 $Ca^{2+}$ 通量 $J_{Ca}$，与开放的 IP$_3$R 通道数量 ($N \\cdot P_{\\mathrm{open, IP3R}}$) 以及 $Ca^{2+}$ 的电化学驱动力成正比。由于内质网膜电位可以忽略不计，该驱动力是内质网和胞质之间的 $Ca^{2+}$ 浓度差。\n$$J_{Ca} \\propto P_{\\mathrm{open, IP3R}} \\cdot ([Ca^{2+}]_{\\mathrm{ER}} - [Ca^{2+}]_{\\mathrm{cyt}})$$\n该通量导致 $[Ca^{2+}]_{\\mathrm{cyt}}$ 发生变化。\n\nTRPM5 通道被 $[Ca^{2+}]_{\\mathrm{cyt}}$ 的增加所激活。其开放概率 $P_{\\mathrm{open, TRPM5}}$ 对 $[Ca^{2+}]_{\\mathrm{cyt}}$ 的依赖性是协同的，可以有效地用希尔方程来建模：\n$$P_{\\mathrm{open, TRPM5}} = P_{\\mathrm{max}} \\frac{([Ca^{2+}]_{\\mathrm{cyt}})^k}{K_{d,Ca}^k + ([Ca^{2+}]_{\\mathrm{cyt}})^k}$$\n其中 $P_{\\mathrm{max}}$ 是最大开放概率， $K_{d,Ca}$ 是 $Ca^{2+}$ 的半数最大激活常数，$k$ 是希尔系数。这个方程明确定义了 TRPM5 激活对 $[Ca^{2+}]_{\\mathrm{cyt}}$ 的依赖关系。\n\n至此，符号框架的构建完成。现在，我们进行定量计算。问题要求计算由 TRPM5 电流产生的稳态去极化 $\\Delta V_m$。根据膜片的欧姆定律，膜电位的变化是注入电流 ($I_{\\mathrm{TRPM5}}$) 和膜的输入电阻 ($R_{in}$) 的乘积。\n$$\\Delta V_m = I_{\\mathrm{TRPM5}} \\cdot R_{in}$$\n问题指出其他电流可以忽略不计。通过 TRPM5 通道的电流由总 TRPM5 电导 ($g_{\\mathrm{TRPM5}}$) 和渗透该通道的离子的驱动力的乘积给出。\n$$I_{\\mathrm{TRPM5}} = g_{\\mathrm{TRPM5}} \\cdot (V_m - E_{\\mathrm{ion}})$$\n这里，$(V_m - E_{\\mathrm{ion}})$ 是驱动力。问题直接给出了净 TRPM5 电导和驱动力。\n\n给定的数值是：\n净 TRPM5 电导, $g_{\\mathrm{TRPM5}} = 100 \\,\\mathrm{pS}$。\n驱动力, $(V_m - E_{\\mathrm{ion}})$, 我们记为 $V_{df} = 50 \\,\\mathrm{mV}$。\n输入电阻, $R_{in} = 1 \\,\\mathrm{G}\\Omega$。\n\n我们必须使用国际单位制基本单位：西门子 (S)、伏特 (V) 和欧姆 ($\\Omega$)。\n$g_{\\mathrm{TRPM5}} = 100 \\,\\mathrm{pS} = 100 \\times 10^{-12} \\,\\mathrm{S} = 1 \\times 10^{-10} \\,\\mathrm{S}$。\n$V_{df} = 50 \\,\\mathrm{mV} = 50 \\times 10^{-3} \\,\\mathrm{V} = 5 \\times 10^{-2} \\,\\mathrm{V}$。\n$R_{in} = 1 \\,\\mathrm{G}\\Omega = 1 \\times 10^9 \\,\\Omega$。\n\n首先，我们计算 TRPM5 电流 $I_{\\mathrm{TRPM5}}$：\n$$I_{\\mathrm{TRPM5}} = g_{\\mathrm{TRPM5}} \\cdot V_{df} = (1 \\times 10^{-10} \\,\\mathrm{S}) \\cdot (5 \\times 10^{-2} \\,\\mathrm{V})$$\n$$I_{\\mathrm{TRPM5}} = 5 \\times 10^{-12} \\,\\mathrm{A} = 5 \\,\\mathrm{pA}$$\n\n接下来，我们计算由此产生的稳态去极化 $\\Delta V_m$：\n$$\\Delta V_m = I_{\\mathrm{TRPM5}} \\cdot R_{in} = (5 \\times 10^{-12} \\,\\mathrm{A}) \\cdot (1 \\times 10^9 \\,\\Omega)$$\n$$\\Delta V_m = 5 \\times 10^{-3} \\,\\mathrm{V} = 5 \\,\\mathrm{mV}$$\n\n问题要求答案以毫伏为单位，并四舍五入到三位有效数字。\n$$\\Delta V_m = 5.00 \\,\\mathrm{mV}$$",
            "answer": "$$\\boxed{5.00}$$"
        },
        {
            "introduction": "在理解了单个细胞的反应后，我们将尺度放大到整体感知层面。本练习以经典的心理物理学原理——韦伯定律为起点，探讨我们区分不同刺激强度的能力。您的任务不仅是计算韦伯分数，更重要的是从受体动力学和神经噪声等第一性原理出发，论证为何真实的感知系统与这一定律存在偏差，从而培养连接微观机制与宏观现象的分析能力。",
            "id": "4753774",
            "problem": "在一项与口腔学相关的受控口内味觉阈值评估中，一名训练有素的参与者在稳定的唾液流和缓冲的口腔条件下，接触到一种酸味刺激物（柠檬酸水溶液）。根据心理物理学的定义，恰可察觉差（just noticeable difference）是指能够引起可靠感觉变化的最小刺激强度变化。在此实验中，测得围绕参考浓度 $I = 0.10\\,\\mathrm{M}$ 的恰可察觉差为浓度变化 $\\Delta I = 0.02\\,\\mathrm{M}$。根据对于许多感觉模式而言，恰可察觉差与基线强度成比例这一基本原理，计算此酸味刺激物的韦伯分数。然后，从化学感觉转导和心理物理标度的第一性原理出发，论证在适中的浓度范围内，酸味的味觉感知是否预期会遵循韦伯定律的恒定比例特性，并考虑味觉受体通路中的受体激活特性和噪声限制。将韦伯分数表示为一个无量纲的小数，并四舍五入到三位有效数字。",
            "solution": "该问题要求完成两项任务：首先，根据提供的实验数据计算酸味刺激物的韦伯分数；其次，从第一性原理出发，论证酸味的味觉感知是否预期会遵循韦伯定律。\n\n首先，我们验证问题陈述的有效性。\n已知条件如下：\n- 参考刺激强度（浓度）：$I = 0.10\\,\\mathrm{M}$\n- 强度的恰可察觉差（JND）：$\\Delta I = 0.02\\,\\mathrm{M}$\n\n该问题具有科学依据，因为它使用了来自心理物理学和感觉生理学（口腔学）的标准概念和合理数值。问题提法恰当，为计算提供了所有必要数据。术语定义清晰。因此，该问题是有效的。\n\n为了解决第一部分任务，我们计算韦伯分数。韦伯定律是心理物理学的一项原理，它指出刺激的恰可察觉差 $\\Delta I$ 与参考刺激的强度 $I$ 成正比。其数学公式为：\n$$ \\Delta I = k \\cdot I $$\n其中 $k$ 是一个比例常数，称为韦伯分数。这个分数是衡量刺激可辨别性的一个无量纲指标。我们可以通过重新排列方程来求解 $k$：\n$$ k = \\frac{\\Delta I}{I} $$\n代入酸味刺激物（柠檬酸）的给定值：\n$$ k = \\frac{0.02\\,\\mathrm{M}}{0.10\\,\\mathrm{M}} $$\n摩尔浓度（$\\mathrm{M}$）的单位被消掉，证实了 $k$ 是无量纲的。\n$$ k = 0.2 $$\n问题要求答案表示为一个小数，并四舍五入到三位有效数字。\n$$ k = 0.200 $$\n\n对于第二部分任务，我们必须从第一性原理出发，论证在适中的浓度范围内，酸味的感知是否预期会遵循韦伯定律的恒定比例特性（即 $k$ 是常数）。韦伯定律是一项经验观察，它对许多（但非全部）感觉模式和刺激范围近似成立。第一性原理分析需要考察味觉转导的潜在神经生理学机制。\n\n1.  **受体激活动力学**：酸味转导的主要机制是通过特化的味觉受体细胞检测质子（$H^+$ 离子）。这些细胞的反应由蛋白质通道介导，例如 Otopetrin 1 (OTOP1) 质子通道。刺激物浓度 $C$ 与受体群体生理反应强度 $R$ 之间的关系通常不是线性的。它通常遵循一个S型函数，常由 Hill 方程或其更简单的形式—— Beidler 方程（类似于 Michaelis-Menten 动力学）来建模：\n    $$ R(C) = \\frac{R_{max} \\cdot C}{K_m + C} $$\n    此处，$R_{max}$ 是最大可能反应（当所有受体都饱和时），$K_m$ 是反应达到一半最大值时的浓度。\n\n    心理物理学中恰可察觉差 $\\Delta I$ 的概念，被认为对应于总神经反应中的一个恒定的、恰可检测到的变化 $\\Delta R_{const}$。反应对浓度变化的敏感度由导数 $\\frac{dR}{dC}$ 给出：\n    $$ \\frac{dR}{dC} = \\frac{R_{max} K_m}{(K_m + C)^2} $$\n    使用近似式 $\\Delta R \\approx \\frac{dR}{dC} \\Delta C$，我们可以将产生 $\\Delta R_{const}$ 所需的刺激变化 $\\Delta C$（等同于 $\\Delta I$）表示为：\n    $$ \\Delta C \\approx \\frac{\\Delta R_{const}}{dR/dC} = \\Delta R_{const} \\cdot \\frac{(K_m + C)^2}{R_{max} K_m} $$\n    韦伯分数 $k$ 因而为 $k = \\frac{\\Delta C}{C}$。代入我们关于 $\\Delta C$ 的表达式：\n    $$ k(C) = \\frac{\\Delta C}{C} \\approx \\left(\\frac{\\Delta R_{const}}{R_{max} K_m}\\right) \\frac{(K_m + C)^2}{C} $$\n    这个推导出的函数 $k(C)$ 不是一个常数；它随浓度 $C$ 变化。\n    -   在低浓度下（$C \\ll K_m$），$k(C) \\approx \\text{常数} \\cdot \\frac{K_m^2}{C}$。韦伯分数非常高，并随着 $C$ 的增加而减小。这违反了韦伯定律。\n    -   在高浓度下（$C \\gg K_m$），对应于受体饱和，$k(C) \\approx \\text{常数} \\cdot \\frac{C^2}{C} = \\text{常数} \\cdot C$。韦伯分数随浓度增加而增加，意味着辨别能力逐渐变差。这也违反了韦伯定律。\n    受体饱和模型预测，韦伯定律只能是一个近似，可能在一个有限的、中等浓度范围内成立，在此范围内，半对数坐标图（$R(C)$ vs $\\log C$）上的反应曲线近似是线性的。\n\n2.  **神经通路中的噪声限制**：神经信号本质上是嘈杂的。感觉辨别的一个基本限制是从这种背景噪声中区分出信号的能力。一个被广泛接受的模型假设，神经反应的标准差（即噪声 $\\sigma_N$）与平均反应强度 $R$ 成正比。这被称为信号依赖性噪声：$\\sigma_N \\propto R$。要使两个刺激恰好可以被辨别，它们的平均反应差异 $\\Delta R$ 必须与噪声水平处于同一数量级：$\\Delta R \\propto \\sigma_N$。将这些结合起来，得到 $\\Delta R \\propto R$。\n    使用关系式 $\\Delta R \\approx \\frac{dR}{dC}\\Delta C$，我们得到：\n    $$ \\frac{dR}{dC}\\Delta C \\propto R $$\n    $$ \\frac{\\Delta C}{C} \\propto \\frac{R(C)}{C \\cdot dR/dC} $$\n    使用 Beidler 方程表示 $R(C)$ 及其导数 $dR/dC$：\n    $$ \\frac{R(C)}{C \\cdot dR/dC} = \\frac{\\frac{R_{max} C}{K_m + C}}{C \\cdot \\frac{R_{max} K_m}{(K_m+C)^2}} = \\frac{1/(K_m+C)}{K_m/(K_m+C)^2} = \\frac{K_m + C}{K_m} = 1 + \\frac{C}{K_m} $$\n    因此，该模型预测 $k(C) = \\frac{\\Delta C}{C} \\propto 1 + \\frac{C}{K_m}$。韦伯分数被预测为随浓度线性增加。这种系统性偏差被称为对韦伯定律的“近似违背”（near miss），并且在许多感觉系统中都观察到。\n\n总之，基于受体饱和动力学和神经通路中信号依赖性噪声特性的第一性原理分析表明，酸味的韦伯分数并非真正恒定。因此，酸味的味觉感知不应严格遵循韦伯定律的恒定比例特性。该定律可作为一个有用的局部近似，尤其是在“适中”的浓度范围内，但在低强度（接近阈值）和高强度（接近饱和）时都预期会出现偏差。计算出的值 $k=0.200$ 是在 $I=0.10\\,\\mathrm{M}$ 附近局部辨别能力的有效度量，但不应外推为酸味感觉的普适常数。",
            "answer": "$$\\boxed{0.200}$$"
        },
        {
            "introduction": "最后，我们将注意力转向嗅觉系统及其临床相关性，特别是病毒感染后嗅觉丧失的动态恢复过程。本练习将指导您使用数学建模来模拟嗅觉上皮在损伤后的再生。通过将细胞层面的损伤（支持细胞功能障碍）与功能层面的丧失（嗅觉缺失）联系起来，并基于组织更新的基本原理来预测恢复的时间进程，您将掌握适用于临床预后和再生医学研究的现代定量分析技能。",
            "id": "4753752",
            "problem": "一名开发者被要求基于嗅上皮的生理学，为与口腔科学相关的嗅觉丧失与恢复建立一个形式化的机制模型。严重急性呼吸综合征冠状病毒 $2$ (SARS-CoV-2) 主要通过支持细胞 (sustentacular/supporting cells) 表达的血管紧张素转换酶 $2$ (ACE2) 和跨膜蛋白酶丝氨酸 $2$ (TMPRSS2) 感染嗅上皮，导致气味转导的暂时性功能障碍，而不会引起嗅觉受体神经元的原发性死亡。任务是推导支持细胞的急性损伤如何引起嗅觉丧失 (anosmia)，并计算由上皮更新驱动的预期恢复时间进程。\n\n从以下基本依据和核心定义开始：\n- 支持依赖性转导：气味转导效率取决于支持细胞功能的完整性。令标准化的支持细胞完整性为 $S(t) \\in [0,1]$，其中 $S(t) = 1$ 表示完全完整。气味检测能力 $C(t)$ 是一个由协同支持需求决定的关于 $S(t)$ 的单调递增饱和函数。一类被广泛观察到的生物物理输入输出关系是希尔函数 (Hill function)：$$C(t) = \\frac{S(t)^{\\alpha}}{S(t)^{\\alpha} + \\theta^{\\alpha}},$$ 其中 $\\alpha > 0$ 是希尔系数（协同性），$\\theta \\in (0,1)$ 是能力达到半最大值时的支持水平。\n- 一阶上皮更新：在 $t=0$ 时刻发生急性损伤后，若无持续的细胞毒性损伤，则 $S(t)$ 的恢复遵循朝向基线 $S=1$ 的一阶更新动力学。令平均更新时间为 $\\tau_r > 0$（单位：天）。若初始损伤分数为 $d \\in [0,1)$，则初始完整性为 $S(0) = 1 - d$，恢复过程遵循线性弛豫定律：$$\\frac{dS}{dt} = \\frac{1 - S(t)}{\\tau_r}.$$\n\n待完成的任务：\n$1.$ 根据所述的更新定律推导 $S(t)$，然后使用支持依赖性转导的定义构建 $C(t)$。根据所提供的依据明确说明推导的每一步。\n$2.$ 使用推导出的 $C(t)$，为每个参数集计算三个量化恢复指标：\n- 最早时间 $t_{0.5}$（单位：天），使得对于 $t \\ge 0$ 均有 $C(t) \\ge 0.5$。\n- 最早时间 $t_{\\mathrm{norm}}$（单位：天），使得 $C(t) \\ge c_{\\mathrm{norm}}$，并有此约束：如果到 $T_{\\max}$ 天仍未达到该水平，则返回 $-1$ 而不是时间值。\n- 在有限时间范围 $[0,T_h]$ 内的曲线下面积损伤值 $I_{\\mathrm{AUC}}$（单位：天），定义为：$$I_{\\mathrm{AUC}} = \\int_{0}^{T_h} \\left(1 - C(t)\\right)\\, dt.$$\n$3.$ 所有时间必须以天为单位表示，并四舍五入到三位小数。所有 $I_{\\mathrm{AUC}}$ 值必须以天为单位表示，并四舍五入到三位小数。\n$4.$ 实现一个完整的、可运行的程序，该程序针对以下测试套件，生成单行输出，其中包含结果，形式为由子列表组成的、以逗号分隔的列表，每个子列表按 $[t_{0.5}, t_{\\mathrm{norm}}, I_{\\mathrm{AUC}}]$ 的顺序排列：\n$$\\text{输出示例格式： } [[t_{0.5}^{(1)}, t_{\\mathrm{norm}}^{(1)}, I_{\\mathrm{AUC}}^{(1)}],[t_{0.5}^{(2)}, t_{\\mathrm{norm}}^{(2)}, I_{\\mathrm{AUC}}^{(2)}],\\dots].$$\n\n测试套件（每个元组按 $(d, \\tau_r, \\alpha, \\theta, c_{\\mathrm{norm}}, T_{\\max}, T_h)$ 顺序排列）：\n- 案例 1：$(0.7, 8, 2, 0.3, 0.8, 60, 30)$\n- 案例 2：$(0.2, 5, 2, 0.3, 0.8, 60, 30)$\n- 案例 3：$(0.95, 14, 3, 0.4, 0.8, 60, 30)$\n- 案例 4：$(0, 7, 2, 0.3, 0.8, 60, 30)$\n\n科学真实性说明：\n- 选择一阶更新模型捕捉了经验上观察到的上皮细胞群在以天为单位的特征更新时间 $\\tau_r$ 内向稳态指数弛豫的过程。\n- 希尔函数捕捉了气味转导对支持细胞中多种支持过程（例如，离子稳态、气味剂代谢和黏膜环境）的协同依赖性，而无需预设神经元丢失。\n\n您的程序应生成单行输出，其中包含用方括号括起来的结果，结果是以逗号分隔的列表，并按指定的方式按测试用例分组，每个浮点数四舍五入到三位小数。",
            "solution": "该问题被评估为有效，因为它具有科学依据、问题明确且客观。它提供了一个基于既定原则（一阶动力学、希尔型函数）的形式化生物物理模型，并要求推导和计算定义明确的量化指标。所有必要的参数和条件均已提供。\n\n### 任务1：$S(t)$ 和 $C(t)$ 的推导\n\n支持细胞完整性 $S(t)$ 的恢复过程由一个朝向基线 $1$ 弛豫的一阶线性常微分方程所描述：\n$$ \\frac{dS}{dt} = \\frac{1 - S(t)}{\\tau_r} $$\n初始条件在时间 $t=0$ 时反映了急性损伤分数 $d$，因此 $S(0) = 1 - d$。\n\n这是一个可分离变量的方程。我们将其重排以分离变量 $S$ 和 $t$：\n$$ \\frac{dS}{1 - S} = \\frac{dt}{\\tau_r} $$\n我们对两边进行积分。积分从初始状态 $(S(0), 0)$ 到状态 $(S(t), t)$：\n$$ \\int_{S(0)}^{S(t)} \\frac{dS'}{1 - S'} = \\int_{0}^{t} \\frac{dt'}{\\tau_r} $$\n左侧积分的计算结果为 $-\\ln(1 - S')$。代入积分限：\n$$ \\left[-\\ln(1 - S')\\right]_{S(0)}^{S(t)} = \\left[\\frac{t'}{\\tau_r}\\right]_{0}^{t} $$\n$$ -\\ln(1 - S(t)) - (-\\ln(1 - S(0))) = \\frac{t}{\\tau_r} $$\n$$ \\ln\\left(\\frac{1 - S(0)}{1 - S(t)}\\right) = \\frac{t}{\\tau_r} $$\n代入初始条件 $S(0) = 1 - d$：\n$$ \\ln\\left(\\frac{1 - (1 - d)}{1 - S(t)}\\right) = \\ln\\left(\\frac{d}{1 - S(t)}\\right) = \\frac{t}{\\tau_r} $$\n两边取指数可得：\n$$ \\frac{d}{1 - S(t)} = e^{t/\\tau_r} $$\n$$ 1 - S(t) = d e^{-t/\\tau_r} $$\n对 $S(t)$ 求解，我们得到支持细胞完整性恢复的显式时间进程：\n$$ S(t) = 1 - d e^{-t/\\tau_r} $$\n该函数正确地满足了初始条件，因为 $S(0) = 1 - d e^0 = 1 - d$；也满足长期行为，因为 $\\lim_{t\\to\\infty} S(t) = 1$。\n\n接下来，我们将 $S(t)$ 的表达式代入给定的希尔函数中，以构建气味检测能力 $C(t)$：\n$$ C(t) = \\frac{S(t)^{\\alpha}}{S(t)^{\\alpha} + \\theta^{\\alpha}} $$\n这就得出了能力恢复时间进程的完整表达式：\n$$ C(t) = \\frac{\\left(1 - d e^{-t/\\tau_r}\\right)^{\\alpha}}{\\left(1 - d e^{-t/\\tau_r}\\right)^{\\alpha} + \\theta^{\\alpha}} $$\n任务 $1$ 的推导到此完成。\n\n### 任务2：恢复指标的推导\n\n函数 $S(t)$ 从 $S(0) = 1-d$ 开始单调递增至 $1$。由于 $C(t)$ 的希尔函数也随 $S(t)$ 单调递增，因此 $C(t)$ 是时间 $t$ 的一个单调递增函数。这一性质简化了求解达到特定阈值所需时间的过程。\n\n**指标1：时间 $t_{0.5}$**\n我们需要找到最早的 $t \\ge 0$ 使得 $C(t) \\ge 0.5$。由于单调性，这等价于求解 $C(t) = 0.5$。\n$$ \\frac{S(t)^{\\alpha}}{S(t)^{\\alpha} + \\theta^{\\alpha}} = 0.5 \\implies 2 S(t)^{\\alpha} = S(t)^{\\alpha} + \\theta^{\\alpha} \\implies S(t)^{\\alpha} = \\theta^{\\alpha} $$\n由于 $S(t) > 0$ 且 $\\theta > 0$，我们可以得出结论，当 $S(t) = \\theta$ 时，能力达到其半最大值。\n现在我们求解达到此完整性水平的时间 $t_{0.5}$：\n$$ S(t_{0.5}) = 1 - d e^{-t_{0.5}/\\tau_r} = \\theta $$\n$$ d e^{-t_{0.5}/\\tau_r} = 1 - \\theta \\implies e^{-t_{0.5}/\\tau_r} = \\frac{1 - \\theta}{d} $$\n取自然对数：\n$$ -\\frac{t_{0.5}}{\\tau_r} = \\ln\\left(\\frac{1 - \\theta}{d}\\right) \\implies t_{0.5} = -\\tau_r \\ln\\left(\\frac{1 - \\theta}{d}\\right) = \\tau_r \\ln\\left(\\frac{d}{1 - \\theta}\\right) $$\n这个 $t_{0.5}$ 的表达式在对数函数的参数大于 $1$ 时有效，即 $d > 1 - \\theta$，这等价于 $S(0) = 1 - d  \\theta$。如果 $S(0) \\ge \\theta$，则 $C(0) \\ge 0.5$，条件从一开始就得到满足。在这种情况下，最早时间是 $t_{0.5} = 0$。\n\n**指标2：时间 $t_{\\mathrm{norm}}$**\n我们寻求最早的 $t \\ge 0$ 使得 $C(t) \\ge c_{\\mathrm{norm}}$。首先，我们通过求解 $C(S_{\\text{target}}) = c_{\\mathrm{norm}}$ 来找到所需的完整性水平，我们称之为 $S_{\\text{target}}$：\n$$ \\frac{S_{\\text{target}}^{\\alpha}}{S_{\\text{target}}^{\\alpha} + \\theta^{\\alpha}} = c_{\\mathrm{norm}} \\implies S_{\\text{target}}^{\\alpha} = c_{\\mathrm{norm}}(S_{\\text{target}}^{\\alpha} + \\theta^{\\alpha}) $$\n$$ S_{\\text{target}}^{\\alpha}(1 - c_{\\mathrm{norm}}) = c_{\\mathrm{norm}}\\theta^{\\alpha} \\implies S_{\\text{target}}^{\\alpha} = \\frac{c_{\\mathrm{norm}}}{1 - c_{\\mathrm{norm}}}\\theta^{\\alpha} $$\n$$ S_{\\text{target}} = \\theta \\left(\\frac{c_{\\mathrm{norm}}}{1 - c_{\\mathrm{norm}}}\\right)^{1/\\alpha} $$\n如果 $S_{\\text{target}} \\ge 1$，这个完整性水平是不可能达到的（因为对于有限的 $t$，$S(t)  1$），所以 $C(t)$ 永远不会达到 $c_{\\mathrm{norm}}$。在这种情况下，$t_{\\mathrm{norm}}$ 实际上是无限大，我们返回 $-1$。\n如果 $S(0) = 1-d \\ge S_{\\text{target}}$，则能力从一开始就等于或高于正常水平，所以 $t_{\\mathrm{norm}} = 0$。\n否则，我们求解 $S(t) = S_{\\text{target}}$ 时的时间 $t$：\n$$ 1 - d e^{-t/\\tau_r} = S_{\\text{target}} \\implies t = \\tau_r \\ln\\left(\\frac{d}{1 - S_{\\text{target}}}\\right) $$\n这就给出了 $t_{\\mathrm{norm}}$ 的值。如果这个计算出的时间超过 $T_{\\max}$，我们必须返回 $-1$。\n\n**指标3：曲线下面积损伤值 $I_{\\mathrm{AUC}}$**\n损伤定义为 $1 - C(t)$。在时间范围 $[0, T_h]$ 内的总损伤是以下积分：\n$$ I_{\\mathrm{AUC}} = \\int_{0}^{T_h} (1 - C(t)) dt $$\n被积函数可以简化为：\n$$ 1 - C(t) = 1 - \\frac{S(t)^{\\alpha}}{S(t)^{\\alpha} + \\theta^{\\alpha}} = \\frac{S(t)^{\\alpha} + \\theta^{\\alpha} - S(t)^{\\alpha}}{S(t)^{\\alpha} + \\theta^{\\alpha}} = \\frac{\\theta^{\\alpha}}{S(t)^{\\alpha} + \\theta^{\\alpha}} $$\n代入 $S(t) = 1 - d e^{-t/\\tau_r}$，积分变为：\n$$ I_{\\mathrm{AUC}} = \\int_{0}^{T_h} \\frac{\\theta^{\\alpha}}{\\left(1 - d e^{-t/\\tau_r}\\right)^{\\alpha} + \\theta^{\\alpha}} dt $$\n对于任意参数，该积分通常没有简单的闭式解析解。因此，将使用数值积分方法进行计算。在 $d=0$ 的特殊情况下，$S(t)=1$ 对所有 $t$ 成立，被积函数为常数。积分简化为 $I_{\\mathrm{AUC}} = T_h \\cdot (1 - C(0)) = T_h \\frac{\\theta^\\alpha}{1+\\theta^\\alpha}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes smell recovery metrics based on a biophysical model.\n    \"\"\"\n    # Test suite: each tuple is (d, tau_r, alpha, theta, c_norm, T_max, T_h)\n    test_cases = [\n        (0.7, 8, 2, 0.3, 0.8, 60, 30),\n        (0.2, 5, 2, 0.3, 0.8, 60, 30),\n        (0.95, 14, 3, 0.4, 0.8, 60, 30),\n        (0, 7, 2, 0.3, 0.8, 60, 30),\n    ]\n\n    results = []\n    for case in test_cases:\n        d, tau_r, alpha, theta, c_norm, T_max, T_h = case\n\n        # --- Metric 1: Time to 50% capacity (t_0.5) ---\n        # Condition for C(t) = 0.5 is S(t) = theta\n        s_initial = 1.0 - d\n        if s_initial = theta:\n            t_0_5 = 0.0\n        else:\n            # Requires d  1 - theta. Since d  1, 1-theta  0, so d/(1-theta)  1.\n            t_0_5 = tau_r * np.log(d / (1.0 - theta))\n\n        # --- Metric 2: Time to normal capacity (t_norm) ---\n        if c_norm = 1.0: # Cannot reach 100% capacity in finite time\n            s_target = np.inf\n        else:\n            s_target = theta * (c_norm / (1.0 - c_norm))**(1.0 / alpha)\n\n        if s_target = 1.0:\n            t_norm = -1  # Target integrity is unachievable\n        elif s_initial = s_target:\n            t_norm = 0.0  # Already at or above target from t=0\n        else: # Implies d  0 and 1-d  s_target\n            t = tau_r * np.log(d / (1.0 - s_target))\n            if t  T_max:\n                t_norm = -1 # Recovery takes longer than T_max\n            else:\n                t_norm = t\n        \n        # --- Metric 3: Impairment Area Under the Curve (I_AUC) ---\n        # The integrand is 1 - C(t), which simplifies to theta^alpha / (S(t)^alpha + theta^alpha)\n        if d == 0:\n            # Analytical solution for constant C(t) when no damage occurs\n            c_val = 1.0 / (1.0 + theta**alpha)\n            i_auc = T_h * (1.0 - c_val)\n        else:\n            def integrand(t, d_p, tau_r_p, alpha_p, theta_p):\n                s_t = 1.0 - d_p * np.exp(-t / tau_r_p)\n                # s_t is always  0 for t=0 since d  1 from problem spec.\n                return theta_p**alpha_p / (s_t**alpha_p + theta_p**alpha_p)\n            \n            i_auc, _ = quad(integrand, 0, T_h, args=(d, tau_r, alpha, theta))\n\n        # Round all results to three decimal places, handling the special value -1 for t_norm.\n        t_0_5_r = round(t_0_5, 3)\n        if t_norm == -1:\n            t_norm_r = -1\n        else:\n            t_norm_r = round(t_norm, 3)\n        i_auc_r = round(i_auc, 3)\n\n        results.append([t_0_5_r, t_norm_r, i_auc_r])\n\n    # Final print statement in the exact required format.\n    # Python's str() for a list automatically includes spaces after commas,\n    # which matches the visual style of the example format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}