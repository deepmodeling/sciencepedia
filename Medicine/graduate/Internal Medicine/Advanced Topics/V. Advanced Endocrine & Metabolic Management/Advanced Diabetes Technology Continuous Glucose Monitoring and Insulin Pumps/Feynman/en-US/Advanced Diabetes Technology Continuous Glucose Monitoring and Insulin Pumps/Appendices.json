{
    "hands_on_practices": [
        {
            "introduction": "The foundation of effective diabetes management with technology is reliable data. This practice focuses on quantifying the accuracy of a Continuous Glucose Monitoring (CGM) system by calculating the Mean Absolute Relative Difference (MARD), the industry-standard metric for performance evaluation . By working through this exercise, you will gain a practical understanding of how to assess sensor accuracy and appreciate why performance can vary across hypoglycemic, euglycemic, and hyperglycemic ranges, a crucial skill for interpreting clinical data and device specifications.",
            "id": "4791370",
            "problem": "A clinician is evaluating the performance of Continuous Glucose Monitoring (CGM) against venous plasma glucose, using the conventional reference-based Mean Absolute Relative Difference (MARD). In internal medicine, MARD is construed from first principles of measurement error as the arithmetic mean of absolute relative errors computed against the reference, with the venous plasma glucose serving as the reference. Using the standard definitions of absolute difference, relative difference, and arithmetic mean, and classifying each paired reading into glycemic ranges by the venous value as hypoglycemic if $G_{\\text{venous}} < 70 \\ \\text{mg/dL}$, euglycemic if $70 \\leq G_{\\text{venous}} \\leq 180 \\ \\text{mg/dL}$, and hyperglycemic if $G_{\\text{venous}} > 180 \\ \\text{mg/dL}$, compute range-specific MARDs and compare them across glycemic ranges. Then compute the overall MARD across all readings.\n\nPaired venous (reference) and CGM values (all in $\\text{mg/dL}$) are:\n- Hypoglycemic range candidates:\n  - $G_{\\text{venous}} = 58$, $G_{\\text{CGM}} = 62$\n  - $G_{\\text{venous}} = 65$, $G_{\\text{CGM}} = 60$\n  - $G_{\\text{venous}} = 68$, $G_{\\text{CGM}} = 72$\n- Euglycemic range candidates:\n  - $G_{\\text{venous}} = 92$, $G_{\\text{CGM}} = 95$\n  - $G_{\\text{venous}} = 110$, $G_{\\text{CGM}} = 108$\n  - $G_{\\text{venous}} = 145$, $G_{\\text{CGM}} = 150$\n  - $G_{\\text{venous}} = 160$, $G_{\\text{CGM}} = 152$\n  - $G_{\\text{venous}} = 175$, $G_{\\text{CGM}} = 184$\n- Hyperglycemic range candidates:\n  - $G_{\\text{venous}} = 190$, $G_{\\text{CGM}} = 200$\n  - $G_{\\text{venous}} = 205$, $G_{\\text{CGM}} = 196$\n  - $G_{\\text{venous}} = 230$, $G_{\\text{CGM}} = 220$\n  - $G_{\\text{venous}} = 260$, $G_{\\text{CGM}} = 270$\n\nTreat the venous plasma glucose as the reference for all calculations. Use the standard conception of MARD grounded in absolute relative error and arithmetic mean. After determining range-specific MARDs and identifying which range has the highest and lowest MARD, compute the overall MARD across all readings and report that overall value as a unitless decimal. Round your final reported overall MARD to four significant figures. Express the final answer without a percentage sign.",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary data and definitions for a unique solution. The task is to compute the Mean Absolute Relative Difference (MARD) for a set of paired glucose measurements, both for specific glycemic ranges and overall.\n\nThe fundamental quantity is the Absolute Relative Difference (ARD) for a single paired measurement $i$, defined as:\n$$\n\\text{ARD}_i = \\frac{|G_{\\text{CGM}, i} - G_{\\text{ref}, i}|}{G_{\\text{ref}, i}}\n$$\nwhere $G_{\\text{CGM}, i}$ is the value from the Continuous Glucose Monitor and $G_{\\text{ref}, i}$ is the reference value, which is the venous plasma glucose, denoted as $G_{\\text{venous}}$.\n\nThe MARD for a set of $N$ measurements is the arithmetic mean of the individual ARD values:\n$$\n\\text{MARD} = \\frac{1}{N} \\sum_{i=1}^{N} \\text{ARD}_i = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{|G_{\\text{CGM}, i} - G_{\\text{venous}, i}|}{G_{\\text{venous}, i}}\n$$\nThe problem requires MARD to be expressed as a unitless decimal, which aligns with this formulation.\n\nFirst, we classify all data points into their respective glycemic ranges based on their $G_{\\text{venous}}$ value, according to the provided definitions:\n- Hypoglycemic: $G_{\\text{venous}}  70 \\ \\text{mg/dL}$\n- Euglycemic: $70 \\leq G_{\\text{venous}} \\leq 180 \\ \\text{mg/dL}$\n- Hyperglycemic: $G_{\\text{venous}} > 180 \\ \\text{mg/dL}$\n\nThe provided data points correctly fall into their candidate ranges:\n- Hypoglycemic pairs ($N_{\\text{hypo}}=3$): ($58$, $62$), ($65$, $60$), ($68$, $72$) since $58  70$, $65  70$, and $68  70$.\n- Euglycemic pairs ($N_{\\text{eu}}=5$): ($92$, $95$), ($110$, $108$), ($145$, $150$), ($160$, $152$), ($175$, $184$) since all $G_{\\text{venous}}$ values are in the range [$70, 180$].\n- Hyperglycemic pairs ($N_{\\text{hyper}}=4$): ($190$, $200$), ($205$, $196$), ($230$, $220$), ($260$, $270$) since all $G_{\\text{venous}}$ values are $ 180$.\n\nWe now compute the range-specific MARDs.\n\n**1. Hypoglycemic Range MARD ($M_{\\text{hypo}}$)**\nThe individual ARDs are:\n$$\n\\text{ARD}_1 = \\frac{|62 - 58|}{58} = \\frac{4}{58}\n$$\n$$\n\\text{ARD}_2 = \\frac{|60 - 65|}{65} = \\frac{5}{65}\n$$\n$$\n\\text{ARD}_3 = \\frac{|72 - 68|}{68} = \\frac{4}{68}\n$$\nThe MARD for this range is:\n$$\nM_{\\text{hypo}} = \\frac{1}{3} \\left( \\frac{4}{58} + \\frac{5}{65} + \\frac{4}{68} \\right) \\approx \\frac{1}{3} (0.068966 + 0.076923 + 0.058824) \\approx 0.068237\n$$\n\n**2. Euglycemic Range MARD ($M_{\\text{eu}}$)**\nThe individual ARDs are:\n$$\n\\text{ARD}_4 = \\frac{|95 - 92|}{92} = \\frac{3}{92}\n$$\n$$\n\\text{ARD}_5 = \\frac{|108 - 110|}{110} = \\frac{2}{110}\n$$\n$$\n\\text{ARD}_6 = \\frac{|150 - 145|}{145} = \\frac{5}{145}\n$$\n$$\n\\text{ARD}_7 = \\frac{|152 - 160|}{160} = \\frac{8}{160} = \\frac{1}{20}\n$$\n$$\n\\text{ARD}_8 = \\frac{|184 - 175|}{175} = \\frac{9}{175}\n$$\nThe MARD for this range is:\n$$\nM_{\\text{eu}} = \\frac{1}{5} \\left( \\frac{3}{92} + \\frac{2}{110} + \\frac{5}{145} + \\frac{1}{20} + \\frac{9}{175} \\right) \\approx \\frac{1}{5} (0.032609 + 0.018182 + 0.034483 + 0.05 + 0.051429) \\approx 0.037340\n$$\n\n**3. Hyperglycemic Range MARD ($M_{\\text{hyper}}$)**\nThe individual ARDs are:\n$$\n\\text{ARD}_9 = \\frac{|200 - 190|}{190} = \\frac{10}{190} = \\frac{1}{19}\n$$\n$$\n\\text{ARD}_{10} = \\frac{|196 - 205|}{205} = \\frac{9}{205}\n$$\n$$\n\\text{ARD}_{11} = \\frac{|220 - 230|}{230} = \\frac{10}{230} = \\frac{1}{23}\n$$\n$$\n\\text{ARD}_{12} = \\frac{|270 - 260|}{260} = \\frac{10}{260} = \\frac{1}{26}\n$$\nThe MARD for this range is:\n$$\nM_{\\text{hyper}} = \\frac{1}{4} \\left( \\frac{1}{19} + \\frac{9}{205} + \\frac{1}{23} + \\frac{1}{26} \\right) \\approx \\frac{1}{4} (0.052632 + 0.043902 + 0.043478 + 0.038462) \\approx 0.044618\n$$\n\n**Comparison of Range-Specific MARDs**\nComparing the calculated values:\n- $M_{\\text{hypo}} \\approx 0.0682$\n- $M_{\\text{eu}} \\approx 0.0373$\n- $M_{\\text{hyper}} \\approx 0.0446$\n\nThe highest MARD occurs in the **hypoglycemic** range. The lowest MARD occurs in the **euglycemic** range ($M_{\\text{eu}}  M_{\\text{hyper}}  M_{\\text{hypo}}$). This is a common finding, as CGM accuracy tends to decrease at lower glucose values where the absolute difference constitutes a larger proportion of the reference value.\n\n**Overall MARD**\nThe overall MARD is the arithmetic mean of all $N = N_{\\text{hypo}} + N_{\\text{eu}} + N_{\\text{hyper}} = 3 + 5 + 4 = 12$ individual ARD values.\n$$\nM_{\\text{overall}} = \\frac{1}{12} \\sum_{i=1}^{12} \\text{ARD}_i\n$$\nThe sum of all ARDs is the sum of the sums from each range:\n$$\n\\sum_{i=1}^{12} \\text{ARD}_i = \\left(\\frac{4}{58} + \\frac{5}{65} + \\frac{4}{68}\\right) + \\left(\\frac{3}{92} + \\frac{2}{110} + \\frac{5}{145} + \\frac{8}{160} + \\frac{9}{175}\\right) + \\left(\\frac{10}{190} + \\frac{9}{205} + \\frac{10}{230} + \\frac{10}{260}\\right)\n$$\n$$\n\\sum_{i=1}^{12} \\text{ARD}_i \\approx 0.204712 + 0.186702 + 0.178474 = 0.569888\n$$\nNow, we compute the overall MARD:\n$$\nM_{\\text{overall}} = \\frac{0.569888}{12} \\approx 0.04749067\n$$\nThe problem requires rounding the final overall MARD to four significant figures.\n$$\nM_{\\text{overall}} \\approx 0.04749\n$$\nThis value is the final answer.",
            "answer": "$$\n\\boxed{0.04749}\n$$"
        },
        {
            "introduction": "To prevent hypoglycemia, advanced insulin delivery systems must account for the lingering effects of previous doses—a concept known as 'insulin on board' (IOB). This exercise moves beyond simple heuristics to the fundamental mathematical modeling of insulin pharmacodynamics, treating the body's response as a linear time-invariant system . By applying the principle of convolution, you will model the phenomenon of 'insulin stacking' and calculate the combined glucose-lowering effect of multiple boluses, providing deep insight into the algorithms that power modern insulin pumps and automated delivery systems.",
            "id": "4791423",
            "problem": "A person with type 1 diabetes mellitus uses Continuous Glucose Monitoring (CGM) and an Insulin Pump (IP) delivering subcutaneous rapid-acting insulin boluses. Insulin stacking refers to the physiological phenomenon where overlapping time courses of multiple boluses produce additive glucose-lowering effects, potentially leading to hypoglycemia if not accounted for. Assume the insulin-glucose system can be approximated, over the time window of interest and at the level of CGM-observed dynamics, as a linear time-invariant (LTI) input-output system in which the bolus insulin input produces a time-varying glucose-lowering drive.\n\nLet the bolus input be modeled as $b(t) = \\sum_{i=1}^{N} B_{i}\\,\\delta(t - t_{i})$, where $\\delta(\\cdot)$ is the Dirac delta distribution, $B_{i}$ is the bolus size in units of insulin (U), and $t_{i}$ is the bolus time in minutes. Let the insulin action impulse response per unit insulin be given by a gamma-shaped kernel\n$$\nh(t) = \\begin{cases}\n\\dfrac{S}{\\Gamma(n)\\,\\tau}\\left(\\dfrac{t}{\\tau}\\right)^{n-1}\\exp\\!\\left(-\\dfrac{t}{\\tau}\\right),  t \\ge 0, \\\\\n0,  t  0,\n\\end{cases}\n$$\nwhere $S$ is the total integrated glucose-lowering effect per unit of insulin (insulin sensitivity factor) in $\\text{mg/dL/U}$, $\\Gamma(\\cdot)$ is the gamma function, $\\tau$ is a time scale in minutes, and $n$ is a dimensionless shape parameter. The instantaneous glucose-lowering rate is defined by the convolution\n$$\nr(t) = (b * h)(t) = \\int_{-\\infty}^{\\infty} b(\\xi)\\,h(t - \\xi)\\,d\\xi,\n$$\nwith units $\\text{mg/dL/min}$.\n\nStarting from the definitions above and without invoking any shortcut formulas, derive the expression for $r(t)$ for a finite set of discrete boluses, and then compute $r(90)$ for the following clinically realistic scenario:\n- Two boluses: $B_{1} = 6$ (U) at $t_{1} = 0$ (minutes), and $B_{2} = 4$ (U) at $t_{2} = 45$ (minutes).\n- Impulse response parameters consistent with rapid-acting analog pharmacodynamics: $S = 30 \\ \\text{mg/dL/U}$, $\\tau = 30$ (minutes), and $n = 3$.\n\nExpress your final numerical answer for the instantaneous glucose-lowering rate at $t = 90$ minutes in $\\text{mg/dL/min}$, and round your answer to four significant figures.",
            "solution": "The problem requires the derivation of the instantaneous glucose-lowering rate, $r(t)$, for a series of insulin boluses and its subsequent calculation at a specific time point for a given set of parameters. The system is modeled as a linear time-invariant (LTI) system.\n\nFirst, I will validate the problem statement.\n\n**Step 1: Extract Givens**\n- Bolus input model: $b(t) = \\sum_{i=1}^{N} B_{i}\\,\\delta(t - t_{i})$, where $B_i$ is bolus size (U), $t_i$ is bolus time (min), and $\\delta(\\cdot)$ is the Dirac delta distribution.\n- Impulse response function: \n$$\nh(t) = \\begin{cases}\n\\dfrac{S}{\\Gamma(n)\\,\\tau}\\left(\\dfrac{t}{\\tau}\\right)^{n-1}\\exp\\!\\left(-\\dfrac{t}{\\tau}\\right),  t \\ge 0, \\\\\n0,  t  0,\n\\end{cases}\n$$\nwhere $S$ is insulin sensitivity ($\\text{mg/dL/U}$), $\\tau$ is a time scale (min), $n$ is a shape parameter, and $\\Gamma(\\cdot)$ is the gamma function.\n- Output definition: The instantaneous glucose-lowering rate $r(t)$ is given by the convolution $r(t) = (b * h)(t) = \\int_{-\\infty}^{\\infty} b(\\xi)\\,h(t - \\xi)\\,d\\xi$, with units of $\\text{mg/dL/min}$.\n- Specific scenario data:\n  - Boluses: $B_{1} = 6$ U at $t_{1} = 0$ min; $B_{2} = 4$ U at $t_{2} = 45$ min.\n  - Parameters: $S = 30 \\ \\text{mg/dL/U}$, $\\tau = 30$ min, $n = 3$.\n- Task: Derive the general expression for $r(t)$, then compute $r(90)$ and round the result to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, representing a standard pharmacokinetic/pharmacodynamic (PK/PD) modeling approach used in biomedical engineering for diabetes technology. The LTI system approximation and the gamma-shaped impulse response are well-established methods for modeling insulin action. The problem is well-posed, providing all necessary definitions, equations, and parameters for a unique solution. The language is objective and quantitative. The units are consistent, as $r(t)$ in $\\text{mg/dL/min}$ results from the convolution of $b(t)$ (in U/min) and $h(t)$ (in ($\\text{mg/dL/U}$)/min). The given parameter values are clinically realistic for rapid-acting insulin analogs. The problem is non-trivial and requires a clear understanding of convolution and system response theory.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with the detailed solution.\n\nThe instantaneous glucose-lowering rate $r(t)$ is defined as the convolution of the input bolus signal $b(t)$ with the impulse response function $h(t)$:\n$$\nr(t) = (b * h)(t) = \\int_{-\\infty}^{\\infty} b(\\xi)\\,h(t - \\xi)\\,d\\xi\n$$\nSubstituting the expression for the input signal, $b(t) = \\sum_{i=1}^{N} B_{i}\\,\\delta(t - t_{i})$, into the convolution integral gives:\n$$\nr(t) = \\int_{-\\infty}^{\\infty} \\left( \\sum_{i=1}^{N} B_{i}\\,\\delta(\\xi - t_{i}) \\right) h(t - \\xi)\\,d\\xi\n$$\nDue to the linearity of the integral operator, we can interchange the summation and the integration:\n$$\nr(t) = \\sum_{i=1}^{N} B_{i} \\int_{-\\infty}^{\\infty} \\delta(\\xi - t_{i})\\,h(t - \\xi)\\,d\\xi\n$$\nThe integral can be evaluated using the sifting property of the Dirac delta distribution, which states that $\\int_{-\\infty}^{\\infty} f(\\xi)\\,\\delta(\\xi - a)\\,d\\xi = f(a)$. In our case, the function is $h(t - \\xi)$ and the shift is $t_i$. The integral evaluates to $h(t - t_i)$.\nTherefore, the general expression for the glucose-lowering rate is:\n$$\nr(t) = \\sum_{i=1}^{N} B_{i}\\,h(t - t_{i})\n$$\nThis expression shows that the total rate is the linear superposition of the responses to each individual bolus, scaled by the bolus size and delayed by the bolus time. This is a fundamental characteristic of LTI systems.\n\nNext, we apply this general result to the specific scenario provided. We have two boluses ($N=2$):\n- $B_{1} = 6$ U at $t_{1} = 0$ min\n- $B_{2} = 4$ U at $t_{2} = 45$ min\n\nThe expression for $r(t)$ becomes:\n$$\nr(t) = B_{1}\\,h(t - t_{1}) + B_{2}\\,h(t - t_{2}) = 6\\,h(t - 0) + 4\\,h(t - 45)\n$$\nNow, we must specify the impulse response function $h(t)$ using the given parameters: $S = 30$, $\\tau = 30$, and $n = 3$.\nFirst, we evaluate the gamma function $\\Gamma(n)$ for the integer $n=3$. For positive integers, $\\Gamma(n) = (n-1)!$.\n$$\n\\Gamma(3) = (3-1)! = 2! = 2\n$$\nSubstituting all the parameter values into the definition of $h(t)$:\n$$\nh(t) = \\dfrac{30}{2 \\cdot 30}\\left(\\dfrac{t}{30}\\right)^{3-1}\\exp\\!\\left(-\\dfrac{t}{30}\\right) = \\dfrac{1}{2}\\left(\\dfrac{t}{30}\\right)^{2}\\exp\\!\\left(-\\dfrac{t}{30}\\right) \\quad \\text{for } t \\ge 0\n$$\nSimplifying the expression:\n$$\nh(t) = \\dfrac{1}{2 \\cdot 30^2} t^2 \\exp\\!\\left(-\\dfrac{t}{30}\\right) = \\dfrac{1}{1800} t^2 \\exp\\!\\left(-\\dfrac{t}{30}\\right) \\quad \\text{for } t \\ge 0\n$$\nAnd $h(t)=0$ for $t0$.\n\nWe are asked to compute $r(t)$ at $t = 90$ minutes.\n$$\nr(90) = 6\\,h(90 - 0) + 4\\,h(90 - 45) = 6\\,h(90) + 4\\,h(45)\n$$\nThe arguments for $h$, which are $90$ and $45$, are both greater than or equal to $0$, so we use the derived expression for $h(t)$.\n\nLet's calculate $h(90)$:\n$$\nh(90) = \\dfrac{1}{1800} (90)^2 \\exp\\!\\left(-\\dfrac{90}{30}\\right) = \\dfrac{8100}{1800} \\exp(-3) = 4.5\\,\\exp(-3)\n$$\nNext, let's calculate $h(45)$:\n$$\nh(45) = \\dfrac{1}{1800} (45)^2 \\exp\\!\\left(-\\dfrac{45}{30}\\right) = \\dfrac{2025}{1800} \\exp(-1.5) = 1.125\\,\\exp(-1.5)\n$$\nNow, we substitute these values back into the expression for $r(90)$:\n$$\nr(90) = 6 \\cdot (4.5\\,\\exp(-3)) + 4 \\cdot (1.125\\,\\exp(-1.5))\n$$\n$$\nr(90) = 27\\,\\exp(-3) + 4.5\\,\\exp(-1.5)\n$$\nTo obtain the final numerical answer, we use the values of the exponential function:\n$$\n\\exp(-3) \\approx 0.049787068\n$$\n$$\n\\exp(-1.5) \\approx 0.223130160\n$$\n$$\nr(90) \\approx 27 \\cdot (0.049787068) + 4.5 \\cdot (0.223130160)\n$$\n$$\nr(90) \\approx 1.344250836 + 1.004085720\n$$\n$$\nr(90) \\approx 2.348336556\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nr(90) \\approx 2.348\n$$\nThe units of $r(t)$ are $\\text{mg/dL/min}$.",
            "answer": "$$\n\\boxed{2.348}\n$$"
        },
        {
            "introduction": "The pinnacle of diabetes technology is its ability to integrate multiple streams of data into a single, optimized clinical action. This capstone exercise simulates the complex decision-making process of a modern bolus calculator, challenging you to synthesize diverse physiological inputs—including CGM trend data, recent exercise, and insulin on board—to determine a precise mealtime insulin dose . Mastering this integrated calculation demonstrates a comprehensive understanding of the dynamic interplay between glucose monitoring and insulin delivery that is central to advanced patient management and the operation of hybrid closed-loop systems.",
            "id": "4791432",
            "problem": "A person with type 1 diabetes mellitus using a continuous subcutaneous insulin infusion pump and a real-time Continuous Glucose Monitoring (CGM) system is preparing for a meal. The following clinically standard quantities and models are used:\n\n- The CGM displays a current interstitial glucose of $G_{0} = 218 \\ \\text{mg/dL}$ with a local linear trend (slope) of $v = -1.2 \\ \\text{mg/dL/min}$. Because interstitial glucose lags plasma glucose by approximately $\\tau_{\\mathrm{CGM}} = 10 \\ \\text{min}$, use a first-order linear prediction based on $v$ to estimate the near-future interstitial glucose $G_{\\mathrm{pred}}$ that better reflects concurrent plasma glucose.\n- The target glucose is $T = 110 \\ \\text{mg/dL}$. The insulin sensitivity factor (ISF) is $\\text{ISF} = 45 \\ \\text{mg/dL/U}$, defined as the expected decrease in plasma glucose per U of rapid-acting insulin under resting conditions.\n- The person plans to ingest $C = 60 \\ \\text{g}$ of carbohydrate. The insulin-to-carbohydrate ratio (ICR) is $\\text{ICR} = 9 \\ \\text{g/U}$, defined as grams of carbohydrate covered per U of rapid-acting insulin when at target and at rest.\n- Insulin on board (IOB) arises from a previous meal bolus delivered $t_{\\mathrm{prev}} = 100 \\ \\text{min}$ ago of dose $B_{\\mathrm{prev}} = 4.0 \\ \\text{U}$. Assume a linear insulin activity model with a duration of insulin action $\\text{DIA} = 4.5 \\ \\text{h} = 270 \\ \\text{min}$, so that the active fraction at elapsed time $t$ is $f(t) = \\max\\!\\left(0, 1 - \\frac{t}{\\mathrm{DIA}}\\right)$, and $\\mathrm{IOB} = B_{\\mathrm{prev}} \\cdot f(t_{\\mathrm{prev}})$.\n- The person completed moderate-intensity cycling at $6$ Metabolic Equivalents of Task (METs) for $40 \\ \\text{min}$, ending $\\Delta t = 0.5 \\ \\text{h}$ ago. A physiologically motivated model represents post-exercise enhancement of insulin sensitivity as a multiplicative increase in $\\mathrm{ISF}$ that decays exponentially with time since exercise: \n$$\n\\mathrm{ISF}_{\\mathrm{eff}} = \\mathrm{ISF} \\left(1 + \\alpha \\, E \\, \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right),\n$$\nwhere $E$ is the exercise dose in $\\text{MET}\\cdot\\text{h}$, $\\alpha = 0.06 \\ (\\text{MET}\\cdot\\text{h})^{-1}$, and $\\tau = 3 \\ \\text{h}$. Compute $E$ from the given METs and duration.\n\nUsing only the above definitions and models:\n1) Predict the near-future interstitial glucose $G_{\\mathrm{pred}}$ from $G_{0}$, $v$, and $\\tau_{\\mathrm{CGM}}$.\n2) Determine the activity-adjusted correction bolus by comparing $G_{\\mathrm{pred}}$ to $T$ and dividing by $\\mathrm{ISF}_{\\mathrm{eff}}$.\n3) Determine the meal bolus from $C$ and $\\mathrm{ICR}$.\n4) Determine $\\mathrm{IOB}$ from $B_{\\mathrm{prev}}$, $t_{\\mathrm{prev}}$, and $\\mathrm{DIA}$.\n5) Combine the above to obtain the immediate total bolus for the meal, defined as the sum of the meal bolus and the activity-adjusted correction bolus, minus the insulin on board.\n\nAlso, based on the quantitative model and the observed CGM trend, justify whether reducing the correction component is warranted due to recent activity, but ensure the final numerical result reflects any warranted reduction.\n\nExpress the final dose in U and round your answer to three significant figures.",
            "solution": "The problem statement will first be validated for scientific soundness, completeness, and clarity.\n\n### Step 1: Extract Givens\n- Current interstitial glucose: $G_{0} = 218 \\ \\text{mg/dL}$\n- Local linear trend of interstitial glucose: $v = -1.2 \\ \\text{mg/dL/min}$\n- CGM lag time: $\\tau_{\\mathrm{CGM}} = 10 \\ \\text{min}$\n- Target glucose: $T = 110 \\ \\text{mg/dL}$\n- Insulin Sensitivity Factor (base): $\\text{ISF} = 45 \\ \\text{mg/dL/U}$\n- Meal carbohydrate content: $C = 60 \\ \\text{g}$\n- Insulin-to-Carbohydrate Ratio: $\\text{ICR} = 9 \\ \\text{g/U}$\n- Previous bolus dose: $B_{\\mathrm{prev}} = 4.0 \\ \\text{U}$\n- Time since previous bolus: $t_{\\mathrm{prev}} = 100 \\ \\text{min}$\n- Duration of Insulin Action: $\\text{DIA} = 4.5 \\ \\text{h} = 270 \\ \\text{min}$\n- Insulin on Board (IOB) model: $\\text{IOB} = B_{\\mathrm{prev}} \\cdot \\max\\!\\left(0, 1 - \\frac{t}{\\text{DIA}}\\right)$\n- Exercise intensity: $6 \\ \\text{METs}$\n- Exercise duration: $40 \\ \\text{min}$\n- Time since exercise completion: $\\Delta t = 0.5 \\ \\text{h}$\n- Effective ISF model: $\\mathrm{ISF}_{\\mathrm{eff}} = \\mathrm{ISF} \\left(1 + \\alpha \\, E \\, \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right)$\n- Exercise model parameter: $\\alpha = 0.06 \\ (\\text{MET}\\cdot\\text{h})^{-1}$\n- Exercise model time constant: $\\tau = 3 \\ \\text{h}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, using standard, albeit simplified, pharmacokinetic and pharmacodynamic models prevalent in clinical diabetology and the engineering of automated insulin delivery systems. The parameters provided ($G_0$, $v$, ISF, ICR, etc.) are all within realistic physiological ranges for an individual with type 1 diabetes. The models for IOB and post-exercise insulin sensitivity are well-established heuristics in this field.\n\nThe problem is well-posed. It provides all necessary data and definitions to perform a sequence of calculations leading to a unique numerical answer. The units are consistent, though requiring minor conversion (minutes to hours).\n\nThe problem is objective and free of non-formalizable or scientifically unsound premises. The instruction to \"justify whether reducing the correction component is warranted\" does not introduce ambiguity, as the provided models for glucose prediction ($G_{\\mathrm{pred}}$ from the trend $v$) and activity-adjusted sensitivity ($\\mathrm{ISF}_{\\mathrm{eff}}$) are the quantitative mechanisms *for* this very reduction. The task is to perform the calculation using these models and explain how they achieve this clinical objective.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A complete solution will be provided.\n\n### Solution\n\nThe total insulin bolus, $B_{\\mathrm{total}}$, is calculated as the sum of the meal bolus ($B_{\\mathrm{meal}}$) and the correction bolus ($B_{\\mathrm{corr}}$), adjusted for the insulin on board ($\\mathrm{IOB}$):\n$$\nB_{\\mathrm{total}} = B_{\\mathrm{meal}} + B_{\\mathrm{corr}} - \\mathrm{IOB}\n$$\nEach component will be calculated systematically according to the provided models.\n\n**1) Predicted Near-Future Interstitial Glucose ($G_{\\mathrm{pred}}$)**\nThe interstitial glucose measured by the CGM lags the actual plasma glucose. A first-order linear prediction is used to estimate the glucose level that better reflects the current state.\nGiven $G_{0} = 218 \\ \\text{mg/dL}$, $v = -1.2 \\ \\text{mg/dL/min}$, and $\\tau_{\\mathrm{CGM}} = 10 \\ \\text{min}$:\n$$\nG_{\\mathrm{pred}} = G_{0} + v \\cdot \\tau_{\\mathrm{CGM}} = 218 \\ \\text{mg/dL} + (-1.2 \\ \\text{mg/dL/min}) \\cdot (10 \\ \\text{min})\n$$\n$$\nG_{\\mathrm{pred}} = 218 - 12 = 206 \\ \\text{mg/dL}\n$$\nThis predicted value will be used for the correction calculation.\n\n**2) Activity-Adjusted Correction Bolus ($B_{\\mathrm{corr}}$)**\nThe correction bolus depends on the effective insulin sensitivity, $\\mathrm{ISF}_{\\mathrm{eff}}$, which is modulated by recent exercise.\n\nFirst, calculate the exercise dose, $E$, in $\\text{MET}\\cdot\\text{h}$.\nThe duration is $40 \\ \\text{min}$, which is $\\frac{40}{60} \\ \\text{h} = \\frac{2}{3} \\ \\text{h}$.\n$$\nE = 6 \\ \\text{METs} \\times \\frac{2}{3} \\ \\text{h} = 4 \\ \\text{MET}\\cdot\\text{h}\n$$\nNext, calculate $\\mathrm{ISF}_{\\mathrm{eff}}$ using the given model:\n$$\n\\mathrm{ISF}_{\\mathrm{eff}} = \\mathrm{ISF} \\left(1 + \\alpha \\, E \\, \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right)\n$$\nSubstituting the values $\\text{ISF} = 45$, $\\alpha = 0.06$, $E = 4$, $\\Delta t = 0.5 \\ \\text{h}$, and $\\tau = 3 \\ \\text{h}$:\n$$\n\\mathrm{ISF}_{\\mathrm{eff}} = 45 \\left(1 + (0.06) \\cdot (4) \\cdot \\exp\\!\\left(-\\frac{0.5}{3}\\right)\\right) = 45 \\left(1 + 0.24 \\exp\\!\\left(-\\frac{1}{6}\\right)\\right)\n$$\nThe correction bolus, $B_{\\mathrm{corr}}$, is the amount of insulin needed to bring the predicted glucose $G_{\\mathrm{pred}}$ down to the target $T$. This is only calculated if $G_{\\mathrm{pred}}  T$.\n$$\nB_{\\mathrm{corr}} = \\frac{G_{\\mathrm{pred}} - T}{\\mathrm{ISF}_{\\mathrm{eff}}} = \\frac{206 - 110}{45 \\left(1 + 0.24 \\exp\\!\\left(-\\frac{1}{6}\\right)\\right)} = \\frac{96}{45 \\left(1 + 0.24 \\exp\\!\\left(-\\frac{1}{6}\\right)\\right)}\n$$\n\n**3) Meal Bolus ($B_{\\mathrm{meal}}$)**\nThe meal bolus covers the carbohydrates to be ingested.\nGiven $C = 60 \\ \\text{g}$ and $\\text{ICR} = 9 \\ \\text{g/U}$:\n$$\nB_{\\mathrm{meal}} = \\frac{C}{\\mathrm{ICR}} = \\frac{60}{9} = \\frac{20}{3} \\ \\text{U}\n$$\n\n**4) Insulin On Board ($\\mathrm{IOB}$)**\nIOB accounts for the activity of insulin from a previous bolus.\nGiven $B_{\\mathrm{prev}} = 4.0 \\ \\text{U}$, $t_{\\mathrm{prev}} = 100 \\ \\text{min}$, and $\\text{DIA} = 270 \\ \\text{min}$:\n$$\n\\text{IOB} = B_{\\mathrm{prev}} \\cdot \\max\\!\\left(0, 1 - \\frac{t_{\\mathrm{prev}}}{\\mathrm{DIA}}\\right) = 4.0 \\cdot \\left(1 - \\frac{100}{270}\\right)\n$$\n$$\n\\text{IOB} = 4.0 \\cdot \\left(\\frac{270 - 100}{270}\\right) = 4 \\cdot \\frac{170}{270} = 4 \\cdot \\frac{17}{27} = \\frac{68}{27} \\ \\text{U}\n$$\n\n**Justification for Dose Reduction**\nThe problem asks to justify if reducing the correction component is warranted. The computational framework provided already achieves this warranted reduction through two primary mechanisms:\n1.  **Trend-Based Glucose Prediction:** Instead of using the static glucose reading $G_0 = 218 \\ \\text{mg/dL}$, the calculation uses the trend-adjusted prediction $G_{\\mathrm{pred}} = 206 \\ \\text{mg/dL}$. The negative trend $v  0$ signifies that glucose is already falling. Using the lower $G_{\\mathrm{pred}}$ value reduces the numerator ($G_{\\mathrm{pred}} - T$) of the correction bolus fraction, thus prudently decreasing the dose to account for the glucose's downward momentum.\n2.  **Activity-Adjusted Insulin Sensitivity:** Recent exercise increases insulin sensitivity. The model reflects this by calculating an effective sensitivity $\\mathrm{ISF}_{\\mathrm{eff}}$ that is greater than the baseline $\\mathrm{ISF}$. This increases the denominator of the correction bolus fraction, signifying that less insulin is required to achieve the same glucose-lowering effect.\n\nBoth factors quantitatively reduce the calculated correction bolus compared to a naive calculation based on $G_0$ and the base ISF. Therefore, performing the calculation as specified *is* the method for applying the warranted reduction.\n\n**5) Total Bolus ($B_{\\mathrm{total}}$)**\nNow, combine the components. The total bolus must be non-negative.\n$$\nB_{\\mathrm{total}} = B_{\\mathrm{meal}} + B_{\\mathrm{corr}} - \\mathrm{IOB} = \\frac{20}{3} + \\frac{96}{45 \\left(1 + 0.24 \\exp\\!\\left(-\\frac{1}{6}\\right)\\right)} - \\frac{68}{27}\n$$\nNow, we compute the numerical value:\n$\\exp\\!\\left(-\\frac{1}{6}\\right) \\approx 0.8464817$\n$$\nB_{\\mathrm{corr}} \\approx \\frac{96}{45 \\left(1 + 0.24 \\cdot 0.8464817\\right)} = \\frac{96}{45 \\left(1 + 0.2031556\\right)} = \\frac{96}{45 \\cdot 1.2031556} \\approx \\frac{96}{54.14200} \\approx 1.77313 \\ \\text{U}\n$$\n$$\nB_{\\mathrm{meal}} = \\frac{20}{3} \\approx 6.66667 \\ \\text{U}\n$$\n$$\n\\text{IOB} = \\frac{68}{27} \\approx 2.51852 \\ \\text{U}\n$$\n$$\nB_{\\mathrm{total}} \\approx 6.66667 + 1.77313 - 2.51852 = 8.43980 - 2.51852 = 5.92128 \\ \\text{U}\n$$\nRounding to three significant figures, the final bolus dose is $5.92 \\ \\text{U}$.",
            "answer": "$$\n\\boxed{5.92}\n$$"
        }
    ]
}