{
    "hands_on_practices": [
        {
            "introduction": "生物系统如何在“开”和“关”两种状态之间切换并维持记忆？正反馈回路是实现这一功能的关键网络基序。通过本练习，你将通过数学推导，揭示一个简单的自激活基因如何能够产生双稳态，即系统存在两个不同的稳定平衡点，从而构成一个分子开关。",
            "id": "4365984",
            "problem": "考虑系统生物医学中的一个正反馈网络基序：一个单一的自激活基因，其产物浓度 $X(t)$ 的演化遵循一个确定性常微分方程 (ODE)，\n$$\n\\frac{dX}{dt} \\;=\\; \\alpha\\,\\frac{X^{n}}{K^{n} + X^{n}} \\;-\\; \\beta\\,X,\n$$\n其中 $\\alpha>0$ 是最大合成速率，$K>0$ 是激活阈值，$n\\geq 1$ 是希尔协同系数，$\\beta>0$ 是一级降解速率常数。假设在一个充分混合、体积恒定的细胞中，希尔函数 $\\frac{X^{n}}{K^{n}+X^{n}}$ 描述了 $X$ 对其自身启动子的协同结合。使用稳态（ODE 右侧的根）和一维局部稳定性（ODE 右侧对 $X$ 的导数在稳态点处求值的符号）的标准定义。\n\n从这些定义和给定的 ODE 出发，完成以下基于这些基本原理的、逻辑一致的推导：\n1. 推导 $X$ 的稳态条件，并用参数 $\\alpha$、$\\beta$、$K$ 和 $n$ 表示所有可能的稳态。\n2. 通过要求稳态方程存在重根，确定当 $n>1$ 时发生鞍结分岔的条件。利用此重根条件，求出零斜线恰好与降解线相切时的临界浓度 $X^{\\ast}$，并由此推导出对应的 $\\alpha$ 的临界值，记为 $\\alpha_{\\mathrm{SN}}(n,K,\\beta)$。\n3. 利用 ODE 右侧的导数在每个稳态点的符号，解释为什么当 $n>1$ 且 $\\alpha>\\alpha_{\\mathrm{SN}}(n,K,\\beta)$ 时，系统会表现出具有不同吸引盆的多个稳定平衡点。\n\n作为你的最终输出，仅提供 $\\alpha_{\\mathrm{SN}}(n,K,\\beta)$ 的闭式解析表达式。最终表达式中不应包含单位。无需进行数值舍入。",
            "solution": "该问题要求对一个由确定性常微分方程（ODE）描述的单基因正反馈网络基序进行多部分推导。\n\n控制该系统的 ODE 为：\n$$\n\\frac{dX}{dt} \\;=\\; f(X) \\;=\\; \\alpha\\,\\frac{X^{n}}{K^{n} + X^{n}} \\;-\\; \\beta\\,X\n$$\n其中 $X(t)$ 是基因产物的浓度，参数 $\\alpha > 0$、$K > 0$、$n \\geq 1$ 和 $\\beta > 0$ 分别是最大合成速率、激活阈值、希尔协同系数和降解速率常数。\n\n### 步骤 1：问题验证\n\n首先根据所需标准对问题进行验证。\n\n**1. 提取已知条件：**\n*   ODE：$\\frac{dX}{dt} = \\alpha\\,\\frac{X^{n}}{K^{n} + X^{n}} - \\beta\\,X$\n*   参数：$\\alpha>0$，$K>0$，$n\\geq 1$，$\\beta>0$。\n*   稳态定义：$\\frac{dX}{dt} = 0$ 的点 $X_{ss}$。\n*   局部稳定性定义 (1D)：由在稳态 $X_{ss}$ 处求值的 $\\frac{df}{dX}$ 的符号确定。如果 $\\frac{df}{dX}  0$，稳态是稳定的；如果 $\\frac{df}{dX} > 0$，则是不稳定的。\n\n**2. 使用提取的已知条件进行验证：**\n*   **科学依据：** 这个模型是系统生物学的基石，代表一个具有协同结合（希尔动力学）和一级降解的自激活基因。这是一个成熟且科学上合理的模型。稳态、稳定性和鞍结分岔的概念是动力系统理论的基本原理。\n*   **适定性：** 该问题是适定的。它要求基于所提供的模型和定义，给出特定的、可推导的量和一个逻辑解释。问题在数学上是精确的，并能导出一组唯一的答案。\n*   **客观性：** 语言是形式化的、定量的，并且没有任何主观或模糊的术语。\n\n**3. 结论与行动：**\n该问题被认定为 **有效的**。它在科学上是合理的、适定的和客观的。可以继续求解过程。\n\n### 解的推导\n\n按要求分三部分推导解。\n\n#### 1. 稳态条件\n\n稳态（记为 $X_{ss}$）是变化率为零时的浓度。我们令 $\\frac{dX}{dt} = 0$：\n$$\n\\alpha\\,\\frac{X_{ss}^{n}}{K^{n} + X_{ss}^{n}} \\;-\\; \\beta\\,X_{ss} \\;=\\; 0\n$$\n这个方程可以重排为：\n$$\nX_{ss} \\left( \\alpha\\,\\frac{X_{ss}^{n-1}}{K^{n} + X_{ss}^{n}} \\;-\\; \\beta \\right) \\;=\\; 0\n$$\n这个方程立即给出一个可能的稳态解：\n$$\nX_{ss,1} = 0\n$$\n对于任何非零稳态（$X_{ss}  0$），我们必须满足以下条件：\n$$\n\\alpha\\,\\frac{X_{ss}^{n-1}}{K^{n} + X_{ss}^{n}} \\;=\\; \\beta\n$$\n这可以重写，将非零稳态定义为合成速率曲线与降解速率直线之间的交点：\n$$\n\\alpha\\,\\frac{X_{ss}^{n-1}}{K^{n} + X_{ss}^{n}} = \\beta \\quad \\text{或等价地} \\quad \\alpha\\,\\frac{X_{ss}^{n}}{K^{n} + X_{ss}^{n}} = \\beta X_{ss}\n$$\n正解的数量取决于参数 $\\alpha$、$\\beta$、$K$ 和 $n$。因此，稳态是 $X=0$ 以及方程 $\\alpha X^{n-1} = \\beta(K^n + X^n)$ 的正根。\n\n#### 2. 鞍结分岔条件\n\n当两个稳态（一个稳定，一个不稳定）合并并消失时，发生鞍结分岔。在数学上，这对应于稳态方程的一个重根点 $X^{\\ast}$。这意味着在 $X^{\\ast}$ 处，函数 $f(X)$ 及其导数 $f'(X)$ 均为零。\n令 $f(X) = \\alpha\\,\\frac{X^{n}}{K^{n} + X^{n}} - \\beta\\,X$。分岔的条件是：\n1.  $f(X^{\\ast}) = \\alpha\\,\\frac{(X^{\\ast})^{n}}{K^{n} + (X^{\\ast})^{n}} - \\beta\\,X^{\\ast} = 0$\n2.  $f'(X^{\\ast}) = 0$\n\n首先，我们计算导数 $f'(X)$：\n$$\nf'(X) = \\frac{d}{dX} \\left( \\alpha\\,\\frac{X^{n}}{K^{n} + X^{n}} - \\beta\\,X \\right) = \\alpha \\frac{d}{dX}\\left(\\frac{X^n}{K^n+X^n}\\right) - \\beta\n$$\n使用商法则：\n$$\n\\frac{d}{dX}\\left(\\frac{X^n}{K^n+X^n}\\right) = \\frac{n X^{n-1}(K^n+X^n) - X^n(n X^{n-1})}{(K^n+X^n)^2} = \\frac{n K^n X^{n-1}}{(K^n+X^n)^2}\n$$\n所以，导数是：\n$$\nf'(X) = \\frac{\\alpha n K^n X^{n-1}}{(K^n+X^n)^2} - \\beta\n$$\n现在我们令 $f'(X^{\\ast}) = 0$：\n$$\n\\frac{\\alpha n K^n (X^{\\ast})^{n-1}}{(K^n+(X^{\\ast})^n)^2} = \\beta\n$$\n我们现在有一个包含两个未知数 $X^{\\ast}$ 和 $\\alpha$ 的临界值（我们记为 $\\alpha_{\\mathrm{SN}}$）的方程组。我们求解 $X^{\\ast}  0$ 的情况，因为分岔不可能在 $X=0$ 处发生，因为 $f'(0) = -\\beta  0$。\n\n根据条件 1（对于 $X^{\\ast}0$，$f(X^{\\ast})=0$）：\n$$\n\\alpha_{\\mathrm{SN}} = \\beta X^{\\ast} \\frac{K^n+(X^{\\ast})^n}{(X^{\\ast})^n} \\quad (\\text{方程 A})\n$$\n根据条件 2（$f'(X^{\\ast})=0$）：\n$$\n\\alpha_{\\mathrm{SN}} = \\beta \\frac{(K^n+(X^{\\ast})^n)^2}{n K^n (X^{\\ast})^{n-1}} \\quad (\\text{方程 B})\n$$\n将 (A) 和 (B) 中 $\\alpha_{\\mathrm{SN}}$ 的表达式相等：\n$$\n\\beta X^{\\ast} \\frac{K^n+(X^{\\ast})^n}{(X^{\\ast})^n} = \\beta \\frac{(K^n+(X^{\\ast})^n)^2}{n K^n (X^{\\ast})^{n-1}}\n$$\n我们可以消去两边的 $\\beta$ 和一个因子 $(K^n+(X^{\\ast})^n)$，因为它是严格为正的：\n$$\n\\frac{X^{\\ast}}{(X^{\\ast})^n} = \\frac{K^n+(X^{\\ast})^n}{n K^n (X^{\\ast})^{n-1}}\n$$\n两边同乘以 $(X^{\\ast})^n$：\n$$\nX^{\\ast} = \\frac{(K^n+(X^{\\ast})^n) X^{\\ast}}{n K^n}\n$$\n因为我们寻找的是 $X^{\\ast}  0$，所以可以除以 $X^{\\ast}$：\n$$\n1 = \\frac{K^n+(X^{\\ast})^n}{n K^n}\n$$\n$$\nn K^n = K^n + (X^{\\ast})^n\n$$\n解出 $(X^{\\ast})^n$：\n$$\n(X^{\\ast})^n = (n-1) K^n\n$$\n这给出了发生分岔时的临界浓度 $X^{\\ast}$。这要求 $n1$。\n$$\nX^{\\ast} = K (n-1)^{\\frac{1}{n}}\n$$\n现在，我们将此代回方程 A 以求得 $\\alpha_{\\mathrm{SN}}$。\n$$\n\\alpha_{\\mathrm{SN}} = \\beta X^{\\ast} \\frac{K^n + (X^{\\ast})^n}{(X^{\\ast})^n} = \\beta \\left(K (n-1)^{\\frac{1}{n}}\\right) \\frac{K^n + (n-1)K^n}{(n-1)K^n}\n$$\n$$\n\\alpha_{\\mathrm{SN}} = \\beta K (n-1)^{\\frac{1}{n}} \\frac{n K^n}{(n-1)K^n} = \\beta K (n-1)^{\\frac{1}{n}} \\frac{n}{n-1}\n$$\n$$\n\\alpha_{\\mathrm{SN}} = \\beta n K \\frac{(n-1)^{\\frac{1}{n}}}{(n-1)^1} = \\beta n K (n-1)^{\\frac{1}{n}-1} = \\beta n K (n-1)^{\\frac{1-n}{n}}\n$$\n这可以更简洁地写成：\n$$\n\\alpha_{\\mathrm{SN}}(n,K,\\beta) = \\frac{\\beta n K}{(n-1)^{\\frac{n-1}{n}}}\n$$\n\n#### 3. 对于 $\\alpha  \\alpha_{\\mathrm{SN}}$ 时的多个稳定平衡点\n\n对于 $n1$，合成速率项 $S(X) = \\alpha \\frac{X^n}{K^n+X^n}$ 是 $X$ 的一个 S 型函数。它从 $S(0)=0$ 开始，初始斜率为 $S'(0)=0$，然后增加，并在 $S(\\infty)=\\alpha$ 处饱和。降解速率 $D(X) = \\beta X$ 是一条通过原点、斜率为恒定正值 $\\beta$ 的直线。\n\n稳态是曲线 $y=S(X)$ 和 $y=D(X)$ 的交点。\n*   $X_{ss,1} = 0$ 始终是一个稳态。其稳定性由 $f'(0) = S'(0) - \\beta = 0 - \\beta = -\\beta$ 决定。因为 $\\beta  0$，所以 $f'(0)  0$，因此零稳态总是稳定的。\n\n条件 $\\alpha = \\alpha_{\\mathrm{SN}}$ 对应于直线 $y=\\beta X$ 在点 $X = X^{\\ast}$ 处恰好与 S 型曲线 $y=S(X)$ 相切的情况。\n\n当我们增加合成速率使得 $\\alpha  \\alpha_{\\mathrm{SN}}$ 时，S 型曲线 $y=S(X)$ 会向上移动。由于 $S(X)$ 的初始斜率为零且其饱和值更高，直线 $y=\\beta X$ 现在将与曲线 $y=S(X)$ 在两个正浓度处相交，此外还有原点处的交点。我们称这些稳态为 $X_{ss,1}=0$、$X_{ss,2}$（较低的正值）和 $X_{ss,3}$（较高的正值），其大小顺序为 $0 = X_{ss,1}  X_{ss,2}  X_{ss,3}$。\n\n我们利用 $f'(X_{ss}) = S'(X_{ss}) - \\beta$ 的符号来分析这三个稳态的稳定性。\n1.  **在 $X_{ss,1} = 0$ 处**：我们已经证明这是稳定的（$f'(0)  0$）。\n2.  **在 $X_{ss,2}$ 处**：在这个较低的正值交点处，S 型曲线 $S(X)$ 必须从下方穿过直线 $\\beta X$。这意味着 S 型曲线在该点的斜率必须大于直线的斜率：$S'(X_{ss,2})  \\beta$。因此，$f'(X_{ss,2}) = S'(X_{ss,2}) - \\beta  0$。这个稳态是 **不稳定的**。\n3.  **在 $X_{ss,3}$ 处**：在这个较高的正值交点处，S 型曲线 $S(X)$ 必须从上方穿过直线 $\\beta X$。这意味着 S 型曲线在该点的斜率必须小于直线的斜率：$S'(X_{ss,3})  \\beta$。因此，$f'(X_{ss,3}) = S'(X_{ss,3}) - \\beta  0$。这个稳态是 **稳定的**。\n\n因此，对于 $n1$ 且 $\\alpha  \\alpha_{\\mathrm{SN}}(n,K,\\beta)$，系统具有三个稳态，排列成稳定-不稳定-稳定的构型。这是双稳态的标志。\n\n两个稳定平衡点，$X_{ss,1}=0$（一个“关”态）和 $X_{ss,3}0$（一个“开”态），具有不同的吸引盆。不稳定的稳态 $X_{ss,2}$ 充当阈值或分界线。\n*   如果初始浓度 $X(0)$ 位于区间 $[0, X_{ss,2})$ 内，系统将演化至 $X_{ss,1}=0$ 处的稳定稳态。该区间是“关”态的吸引盆。\n*   如果初始浓度 $X(0)$ 位于区间 $(X_{ss,2}, \\infty)$ 内，系统将演化至 $X_{ss,3}$ 处的稳定稳态。该区间是“开”态的吸引盆。\n\n存在两个具有不同吸引盆的稳定平衡点意味着系统表现出多稳态性，使其能够根据其刺激历史充当开关或记忆模块。",
            "answer": "$$\n\\boxed{\\frac{\\beta n K}{(n-1)^{\\frac{n-1}{n}}}}\n$$"
        },
        {
            "introduction": "从昼夜节律到细胞周期，振荡是生命活动中的普遍现象。负反馈是产生节律性行为的核心机制，但仅有负反馈本身并不足够。本练习将引导你分析一个带有时间延迟的负反馈系统，并证明转录和翻译等过程固有的时间延迟是如何导致一个原本稳定的系统失稳并产生持续振荡的。",
            "id": "4365931",
            "problem": "一个单基因负反馈模体被建模为一个具有显式合成延迟的延迟调控系统，该延迟代表了细胞生物学中的转录-翻译处理时间。设基因产物的浓度表示为 $X(t)$，并假设其时间演化遵循以下标量延迟微分方程\n$$\n\\frac{dX}{dt} \\;=\\; f\\!\\left(X(t-\\tau)\\right) \\;-\\; \\beta\\, X(t),\n$$\n其中 $\\beta0$ 是一阶降解速率常数，$f$ 是一个实现负反馈的光滑生产函数，意味着 $f$ 在一个相关的稳态附近是严格递减的。假设存在一个满足 $f(X^{\\ast})=\\beta\\,X^{\\ast}$ 的稳态 $X^{\\ast}$，并定义局部反馈斜率 $\\alpha \\equiv f'(X^{\\ast})  0$。在极限情况 $\\tau=0$ 下，该负反馈模体在 $X^{\\ast}$ 处达到稳态平衡。\n\n从围绕 $X^{\\ast}$ 线性化的基本原理、通过指数拟设定义稳定性以及分离复数根的实部和虚部出发，分析有限延迟 $\\tau0$ 如何通过振荡不稳定性使 $X^{\\ast}$ 失稳。在符合生物学现实的参数条件 $|\\alpha|\\beta0$ 下，推导一个闭式解析表达式，用于描述稳态 $X^{\\ast}$ 通过霍普夫分岔失去稳定性的最小正延迟 $\\tau_{c}$，该表达式仅用 $\\alpha$ 和 $\\beta$ 表示。你的最终答案必须是单个解析表达式。无需进行四舍五入，且最终表达式中不应包含任何单位。",
            "solution": "问题陈述经评估有效。它具有科学依据，是适定的，并包含推导唯一且有意义的解所需的所有必要信息。该模型和问题在应用于生物学的动力系统领域是标准的。\n\n基因产物浓度 $X(t)$ 的时间演化由以下延迟微分方程决定：\n$$\n\\frac{dX}{dt} = f\\left(X(t-\\tau)\\right) - \\beta X(t)\n$$\n此处，$\\beta  0$ 是降解速率常数，$\\tau  0$ 是时间延迟，$f$ 是生产函数。系统存在一个稳态 $X^{\\ast}$，由变化率为零的条件定义：\n$$\n\\frac{dX}{dt} = 0 \\implies f(X^{\\ast}) = \\beta X^{\\ast}\n$$\n为了分析此稳态的稳定性，我们在 $X^{\\ast}$ 附近对系统进行线性化。设 $x(t) = X(t) - X^{\\ast}$ 为稳态的一个小扰动。将 $X(t) = X^{\\ast} + x(t)$ 代入控制方程，得到：\n$$\n\\frac{d}{dt}(X^{\\ast} + x(t)) = f\\left(X^{\\ast} + x(t-\\tau)\\right) - \\beta (X^{\\ast} + x(t))\n$$\n由于 $X^{\\ast}$ 是一个常数，所以 $\\frac{d(X^{\\ast})}{dt} = 0$。方程左侧变为 $\\frac{dx}{dt}$。对于项 $f(X^{\\ast} + x(t-\\tau))$，我们在 $X^{\\ast}$ 附近进行一阶泰勒展开：\n$$\nf\\left(X^{\\ast} + x(t-\\tau)\\right) \\approx f(X^{\\ast}) + f'(X^{\\ast}) x(t-\\tau)\n$$\n问题将局部反馈斜率定义为 $\\alpha \\equiv f'(X^{\\ast})$。由于是负反馈，所以 $\\alpha  0$。线性化方程变为：\n$$\n\\frac{dx}{dt} \\approx \\left( f(X^{\\ast}) + \\alpha x(t-\\tau) \\right) - \\beta (X^{\\ast} + x(t))\n$$\n使用稳态条件 $f(X^{\\ast}) = \\beta X^{\\ast}$，我们简化该方程：\n$$\n\\frac{dx}{dt} = \\beta X^{\\ast} + \\alpha x(t-\\tau) - \\beta X^{\\ast} - \\beta x(t)\n$$\n这就得到了关于扰动 $x(t)$ 的线性延迟微分方程：\n$$\n\\frac{dx}{dt} = \\alpha x(t-\\tau) - \\beta x(t)\n$$\n为了确定零解 $x(t) = 0$ 的稳定性（这对应于稳态 $X^{\\ast}$ 的稳定性），我们使用指数拟设 $x(t) = C e^{\\lambda t}$，其中 $\\lambda$ 是一个复特征值，$C$ 是一个常数。将其代入线性化方程得到：\n$$\n\\lambda C e^{\\lambda t} = \\alpha C e^{\\lambda (t-\\tau)} - \\beta C e^{\\lambda t}\n$$\n两边同除以 $C e^{\\lambda t}$（假设 $C \\neq 0$）得到关于特征值 $\\lambda$ 的特征方程：\n$$\n\\lambda = \\alpha e^{-\\lambda \\tau} - \\beta\n$$\n如果所有特征值 $\\lambda$ 的实部都为负，即 $\\text{Re}(\\lambda)  0$，则稳态 $X^{\\ast}$ 是稳定的。当至少一个特征值或一对共轭复特征值穿过虚轴时，系统失去稳定性。霍普夫分岔对应于一对共轭复特征值以非零速度穿过虚轴。在分岔点，这些特征值的实部为零。因此我们设 $\\lambda = i\\omega$，其中 $\\omega$ 是所产生振荡的实值角频率。由于特征值成共轭对出现，我们可以不失一般性地假设 $\\omega  0$。\n\n将 $\\lambda = i\\omega$ 代入特征方程：\n$$\ni\\omega = \\alpha e^{-i\\omega\\tau} - \\beta\n$$\n我们使用欧拉公式 $e^{-i\\omega\\tau} = \\cos(\\omega\\tau) - i\\sin(\\omega\\tau)$ 来分离方程的实部和虚部：\n$$\ni\\omega + \\beta = \\alpha (\\cos(\\omega\\tau) - i\\sin(\\omega\\tau))\n$$\n$$\n\\beta + i\\omega = \\alpha\\cos(\\omega\\tau) - i\\alpha\\sin(\\omega\\tau)\n$$\n令等式两边的实部和虚部分别相等，得到一个包含两个方程的方程组：\n1. 实部：$\\beta = \\alpha\\cos(\\omega\\tau)$\n2. 虚部：$\\omega = -\\alpha\\sin(\\omega\\tau)$\n\n从这两个方程中，我们可以解出分岔频率 $\\omega$ 和临界延迟 $\\tau_c$。从方程(1)我们得到 $\\cos(\\omega\\tau) = \\frac{\\beta}{\\alpha}$。从方程(2)我们得到 $\\sin(\\omega\\tau) = -\\frac{\\omega}{\\alpha}$。利用三角恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$：\n$$\n\\left(\\frac{\\beta}{\\alpha}\\right)^2 + \\left(-\\frac{\\omega}{\\alpha}\\right)^2 = 1\n$$\n$$\n\\frac{\\beta^2}{\\alpha^2} + \\frac{\\omega^2}{\\alpha^2} = 1\n$$\n$$\n\\beta^2 + \\omega^2 = \\alpha^2\n$$\n解出 $\\omega^2$：\n$$\n\\omega^2 = \\alpha^2 - \\beta^2\n$$\n为了发生振荡不稳定性，我们需要一个实的、非零的频率 $\\omega$，这要求 $\\omega^2  0$。这意味着 $\\alpha^2 - \\beta^2  0$，或 $\\alpha^2  \\beta^2$。由于 $|\\alpha|$ 和 $\\beta$ 都是正的，这等价于 $|\\alpha|  \\beta$，这是问题陈述中明确给出的条件。因此，分岔点处的振荡频率为：\n$$\n\\omega = \\sqrt{\\alpha^2 - \\beta^2}\n$$\n现在我们来求解延迟 $\\tau$。我们有以下条件：\n$$\n\\cos(\\omega\\tau) = \\frac{\\beta}{\\alpha} \\quad \\text{and} \\quad \\sin(\\omega\\tau) = -\\frac{\\omega}{\\alpha}\n$$\n鉴于 $\\alpha  0$ 且 $\\beta  0$，比率 $\\frac{\\beta}{\\alpha}$ 是负的。因此，$\\cos(\\omega\\tau)  0$。鉴于 $\\omega  0$ 且 $\\alpha  0$，比率 $-\\frac{\\omega}{\\alpha}$ 是正的。因此，$\\sin(\\omega\\tau)  0$。\n一个余弦为负、正弦为正的角度必定位于第二象限。满足这些条件的 $\\omega\\tau$ 的值由下式给出：\n$$\n\\omega\\tau = \\arccos\\left(\\frac{\\beta}{\\alpha}\\right) + 2\\pi k\n$$\n对于任意整数 $k \\geq 0$。对于负自变量，反余弦函数的主值位于区间 $(\\frac{\\pi}{2}, \\pi]$ 内，这对应于第二象限的角度，满足我们的符号条件。\n\n延迟 $\\tau$ 的可能值为：\n$$\n\\tau = \\frac{1}{\\omega} \\left( \\arccos\\left(\\frac{\\beta}{\\alpha}\\right) + 2\\pi k \\right)\n$$\n题目要求的是失去稳定性的最小正延迟 $\\tau_c$。这对应于 $\\tau$ 的最小正值，通过设置 $k=0$ 获得：\n$$\n\\tau_c = \\frac{1}{\\omega} \\arccos\\left(\\frac{\\beta}{\\alpha}\\right)\n$$\n代入 $\\omega= \\sqrt{\\alpha^2 - \\beta^2}$ 的表达式：\n$$\n\\tau_c = \\frac{1}{\\sqrt{\\alpha^2 - \\beta^2}} \\arccos\\left(\\frac{\\beta}{\\alpha}\\right)\n$$\n这就是用 $\\alpha$ 和 $\\beta$ 表示的临界延迟 $\\tau_c$ 的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{\\alpha^2 - \\beta^2}} \\arccos\\left(\\frac{\\beta}{\\alpha}\\right)}\n$$"
        },
        {
            "introduction": "细胞需要区分短暂的噪声和有意义的持续信号，前馈环路 (FFL) 是执行这种信号处理任务的经典基序。本计算练习将让你亲手实现一个相干前馈环路的非线性动力学模型，并对其进行仿真。你将通过参数探索，验证该环路作为“持久性检测器”的功能，即它能有效过滤掉短时脉冲输入，而仅对长时间的信号产生强烈响应。",
            "id": "4366014",
            "problem": "考虑基因调控中的相干前馈环 (Feed-Forward Loop, FFL) 网络基序，其中上游信号激活转录因子 $X$，$X$ 激活转录因子 $Y$，并且需要 $X$ 和 $Y$ 两者（逻辑与）才能激活目标基因产物 $Z$。设维度动力学遵循系统生物医学中用于调控基因表达的标准常微分方程：通过希尔函数 (Hill function)，产量随调控因子单调变化，且蛋白质以一级动力学衰减。从基因产物动力学可由以下模型描述的基本出发点开始：\n$$\n\\frac{dX}{dt} = k_X\\,H_S\\!\\left(S(t)\\right) - \\frac{X}{\\tau_X},\\quad\n\\frac{dY}{dt} = k_Y\\,H_X\\!\\left(X\\right) - \\frac{Y}{\\tau_Y},\\quad\n\\frac{dZ}{dt} = k_Z\\,H_{\\text{AND}}\\!\\left(X,Y\\right) - \\frac{Z}{\\tau_Z},\n$$\n其中 $H_S$、$H_X$ 和 $H_Y$ 是希尔型激活函数，其解离常数分别为 $K_S$、$K_X$ 和 $K_Y$，$H_{\\text{AND}}$ 是通过将底层的希尔激活函数相乘实现的逻辑与门，$k_X$、$k_Y$、$k_Z$ 是最大生产速率，而 $\\tau_X$、$\\tau_Y$、$\\tau_Z$ 是特征衰减时间。输入信号是一个振幅为 $S_0$、持续时间为 $T_{\\text{on}}$ 的矩形脉冲 $S(t)$，即当 $0 \\le t  T_{\\text{on}}$ 时，$S(t) = S_0$，否则为 0。",
            "solution": "该问题要求分析相干1型前馈环 (coherent Type-1 Feed-Forward Loop, FFL)，这是一种基因调控中常见的网络基序。具体任务是确定在给定参数集下，该网络是否能作为一个稳健的持久性检测器。持久性检测器是一种对长时间输入信号有响应，但能滤除短暂、瞬时信号的系统。分析将在一个无量纲化的常微分方程组 (ODEs) 上进行。\n\n首先，我们重述问题陈述中给出的无量纲常微分方程组，该方程组模拟了基因产物 $x$、$y$ 和 $z$ 的浓度：\n$$\n\\frac{dx}{dt^*} = a_X\\,h\\!\\left(s(t^*)\\right) - \\rho_X\\,x\n$$\n$$\n\\frac{dy}{dt^*} = a_Y\\,h\\!\\left(x\\right) - \\rho_Y\\,y\n$$\n$$\n\\frac{dz}{dt^*} = a_Z\\,\\big[h\\!\\left(x\\right)\\,h\\!\\left(y\\right)\\big] - z\n$$\n该系统受初始条件 $x(0)=0$、$y(0)=0$ 和 $z(0)=0$ 的约束。\n\n这些方程的组成部分定义如下：\n-   $t^*$ 是无量纲时间。\n-   $x(t^*)$、$y(t^*)$ 和 $z(t^*)$ 是基因产物 $X$、$Y$ 和 $Z$ 的无量纲浓度。\n-   $s(t^*)$ 是无量纲输入信号，它是一个矩形脉冲：当 $0 \\le t^*  T_{\\text{on}}$ 时，$s(t^*) = s_0$；当 $t^* \\ge T_{\\text{on}}$ 时，$s(t^*) = 0$。$T_{\\text{on}}$ 代表脉冲的无量纲持续时间。\n-   $h(u) = \\frac{u^n}{1+u^n}$ 是无量纲希尔激活函数，其中 $n$ 是希尔系数。该函数描述了基因表达对调控因子 $u$ 浓度的S型响应。\n-   项 $h(x)h(y)$ 模拟了逻辑与门，其中需要 $X$ 和 $Y$ 两者来激活 $Z$。\n-   $a_X, a_Y, a_Z$ 是无量纲最大生产速率。\n-   $\\rho_X = \\tau_Z/\\tau_X$ 和 $\\rho_Y = \\tau_Z/\\tau_Y$ 是特征衰减时间之比。较大的 $\\rho_i$ 值意味着物种 $i$ 的衰减速度远快于物种 $Z$，表明响应时间快。相反，较小的 $\\rho_i$ 值表示响应缓慢。\n\n该问题为稳健的持久性检测定义了一个量化标准。对于每个参数集，必须评估系统对“短”脉冲（$T_{\\text{on}} = T_{\\text{short}}$）和“长”脉冲（$T_{\\text{on}} = T_{\\text{long}}$）的响应。如果满足以下条件，则该标准达成：\n1.  为响应短脉冲，在模拟区间 $[0, T_{\\text{sim}}]$ 内达到的输出最大浓度 $\\max z_{\\text{short}}$ 不超过低阈值：$\\max z_{\\text{short}} \\le \\theta_{\\text{low}}$，其中 $\\theta_{\\text{low}} = 0.25$。\n2.  为响应长脉冲，最大浓度 $\\max z_{\\text{long}}$ 超过高阈值：$\\max z_{\\text{long}} \\ge \\theta_{\\text{high}}$，其中 $\\theta_{\\text{high}} = 0.60$。\n\n为了解决这个问题，我们必须对所提供的五个测试案例中的每一个，都进行常微分方程组的数值积分。对于每个测试用例，需要进行两次独立的模拟：一次使用短脉冲持续时间，另一次使用长脉冲持续时间。\n\n总体的算法流程如下：\n1.  对于每个参数集 $(a_X, a_Y, a_Z, \\rho_X, \\rho_Y, n, s_0, T_{\\text{short}}, T_{\\text{long}}, T_{\\text{sim}})$：\n    a.  定义ODE系统函数。该函数，例如 `odes(t, state, params)`，将根据当前时间 $t^*$、状态向量 `state` $= [x, y, z]$ 和相关参数计算时间导数 $(dx/dt^*, dy/dt^*, dz/dt^*)$。该函数的一个关键部分是实现输入信号 $s(t^*)$ 的分段特性。\n    b.  **短脉冲模拟**：\n        i.  将脉冲持续时间参数 $T_{\\text{on}}$ 设置为 $T_{\\text{short}}$。\n        ii. 使用数值ODE求解器，例如 `scipy.integrate.solve_ivp`，以初始条件 $[0, 0, 0]$ 求解从 $t^*=0$ 到 $t^*=T_{\\text{sim}}$ 的系统。\n        iii. 从解中，提取 $z(t^*)$ 的轨迹并找到其最大值 $\\max z_{\\text{short}}$。\n    c.  **长脉冲模拟**：\n        i.  将脉冲持续时间参数 $T_{\\text{on}}$ 设置为 $T_{\\text{long}}$。\n        ii. 在相同的区间 $[0, T_{\\text{sim}}]$ 上重复数值积分。\n        iii. 找到所得 $z(t^*)$ 轨迹的最大值 $\\max z_{\\text{long}}$。\n    d.  **应用标准**：\n        i.  评估布尔表达式 $(\\max z_{\\text{short}} \\le \\theta_{\\text{low}})$ AND $(\\max z_{\\text{long}} \\ge \\theta_{\\text{high}})$。\n        ii. 存储所得的布尔值（`True` 或 `False`）。\n2.  处理完所有测试用例后，汇编布尔结果列表。\n3.  将最终输出格式化为方括号内由逗号分隔的布尔值字符串。\n\n该实现将利用 `scipy.integrate` 库中的 `solve_ivp` 函数，该函数为求解常微分方程组的初值问题提供了一种稳健而高效的方法。该函数动态调整其步长以满足误差容限，从而确保得到精确的解剖面，从中可以可靠地确定 $z(t^*)$ 的最大值。分段常数输入信号 $s(t^*)$ 的逻辑将被直接编码到定义ODE系统的函数中，使其在每个时间步长都可被求解器访问。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the coherent FFL persistence detection problem for a suite of test cases.\n    \"\"\"\n    # Define dimensionless thresholds for persistence detection\n    theta_low = 0.25\n    theta_high = 0.60\n\n    # Test suite: each tuple is (a_X, a_Y, a_Z, rho_X, rho_Y, n, s0, T_short, T_long, T_sim)\n    test_cases = [\n        # Case A (general \"happy path\")\n        (4.0, 4.0, 5.0, 6.0, 0.4, 2, 3.0, 0.2, 2.5, 5.0),\n        # Case B (both regulators fast, expected non-robust)\n        (4.0, 4.0, 4.0, 6.0, 6.0, 2, 3.0, 0.2, 2.5, 5.0),\n        # Case C (weak Y and Z production, borderline)\n        (3.0, 1.5, 2.0, 4.0, 1.2, 2, 2.0, 0.4, 2.0, 4.0),\n        # Case D (very slow Y requiring longer input, edge)\n        (4.0, 4.0, 5.0, 4.0, 0.2, 2, 3.0, 0.2, 5.0, 8.0),\n        # Case E (weak input amplitude, expected non-robust)\n        (4.0, 4.0, 4.0, 6.0, 0.5, 2, 0.8, 1.0, 3.0, 5.0),\n    ]\n\n    results = []\n\n    def hill(u, n):\n        \"\"\"Dimensionless Hill activation function.\"\"\"\n        # Add a small epsilon to avoid division by zero or log(0) issues if u is negative,\n        # although concentrations should be non-negative.\n        u_pow_n = np.power(max(0, u), n)\n        return u_pow_n / (1.0 + u_pow_n)\n\n    def ffl_odes(t, state, params):\n        \"\"\"\n        Defines the system of ordinary differential equations for the coherent FFL.\n        \"\"\"\n        x, y, z = state\n        a_X, a_Y, a_Z, rho_X, rho_Y, n, s0, T_on = params\n\n        # Implement the rectangular pulse for the input signal s(t*)\n        current_s = s0 if 0 = t  T_on else 0.0\n\n        h_s = hill(current_s, n)\n        h_x = hill(x, n)\n        h_y = hill(y, n)\n\n        dxdt = a_X * h_s - rho_X * x\n        dydt = a_Y * h_x - rho_Y * y\n        dzdt = a_Z * h_x * h_y - z\n\n        return [dxdt, dydt, dzdt]\n\n    for case in test_cases:\n        a_X, a_Y, a_Z, rho_X, rho_Y, n, s0, T_short, T_long, T_sim = case\n        \n        # Initial conditions for all simulations\n        y0 = [0.0, 0.0, 0.0]\n        t_span = [0, T_sim]\n\n        # --- Short pulse simulation ---\n        params_short = (a_X, a_Y, a_Z, rho_X, rho_Y, n, s0, T_short)\n        sol_short = solve_ivp(\n            fun=ffl_odes,\n            t_span=t_span,\n            y0=y0,\n            args=(params_short,),\n            dense_output=True # Ensures we can find a smooth maximum\n        )\n        z_short_trajectory = sol_short.y[2]\n        max_z_short = np.max(z_short_trajectory) if z_short_trajectory.size > 0 else 0.0\n        \n        # --- Long pulse simulation ---\n        params_long = (a_X, a_Y, a_Z, rho_X, rho_Y, n, s0, T_long)\n        sol_long = solve_ivp(\n            fun=ffl_odes,\n            t_span=t_span,\n            y0=y0,\n            args=(params_long,),\n            dense_output=True\n        )\n        z_long_trajectory = sol_long.y[2]\n        max_z_long = np.max(z_long_trajectory) if z_long_trajectory.size > 0 else 0.0\n\n        # --- Apply persistence detection criterion ---\n        is_robust = (max_z_short = theta_low) and (max_z_long >= theta_high)\n        results.append(is_robust)\n\n    # Format and print the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}