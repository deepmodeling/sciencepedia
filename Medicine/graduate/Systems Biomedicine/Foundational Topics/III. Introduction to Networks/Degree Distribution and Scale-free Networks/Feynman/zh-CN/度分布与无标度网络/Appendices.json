{
    "hands_on_practices": [
        {
            "introduction": "在分析真实世界的网络数据时，例如蛋白质-蛋白质相互作用网络，我们常常发现其度分布呈现出“长尾”特性。然而，尾部的数据点非常稀疏，导致原始的频率图充满噪声，难以揭示其潜在的规律。本练习将引导您思考如何通过对数分箱（logarithmic binning）这一关键技术来处理这类数据，该方法通过使用宽度呈指数增长的“箱子”来平滑噪声，从而在对数-对数坐标图上清晰地展示出幂律分布的线性特征。掌握这一实践是识别和分析现实世界无标度网络的第一步 ()。",
            "id": "4333586",
            "problem": "您正在系统生物医学中分析一个具有 $N$ 个节点和整数度 $\\{k_{\\ell}\\}_{\\ell=1}^{N}$ 的蛋白质-蛋白质相互作用（Protein–Protein Interaction (PPI)）网络的度分布 $P(k)$。对于较大的 $k$ 值，数据是稀疏的，并受到较大的抽样方差影响。您决定使用对数分箱来减小方差，同时旨在保留对度等于 $k$ 的潜在概率定律 $P(k)$ 的一个无偏估计。仅从以下核心定义出发：(i) 度分布 $P(k)$ 是整值随机变量 $K$ 的概率质量函数，即 $P(k) = \\Pr(K = k)$ 且 $\\sum_{k=0}^{\\infty} P(k) = 1$；(ii) 在大 $N$ 极限下，任何区间内观测的经验频率近似于相应的概率。请选择最正确地指定了为离散度数据构建对数分箱的有原则的程序，以及与这些分箱兼容的 $P(k)$ 的偏差缩减分箱估计量的选项。\n\nA. 选择一个最小度 $k_{\\min} \\geq 1$ 和一个比率 $b > 1$。定义分箱边界 $k_{j} = \\left\\lfloor k_{\\min} \\, b^{j} \\right\\rfloor$（对于 $j = 0,1,2,\\dots$ 直至最大观测度），以及分箱 $[k_{j}, k_{j+1})$。令 $n_{j}$ 为度在 $[k_{j}, k_{j+1})$ 内的节点数。对于低度值 $k  k_{\\mathrm{switch}}$，使用单位宽度的分箱以尊重离散性；对于 $k \\geq k_{\\mathrm{switch}}$，估计\n$$\n\\widehat{P}\\!\\left(k_{j}^{\\star}\\right) \\;=\\; \\frac{n_{j}}{N \\,\\big(k_{j+1} - k_{j}\\big)} \\quad \\text{其中} \\quad k_{j}^{\\star} \\;=\\; \\sqrt{k_{j}\\,k_{j+1}}.\n$$\n在对数坐标轴上绘制 $\\widehat{P}(k_{j}^{\\star})$ 相对于 $k_{j}^{\\star}$ 的图像。\n\nB. 选择一个最小度 $k_{\\min} \\geq 1$ 和一个比率 $b > 1$。定义分箱边界 $k_{j} = \\left\\lfloor k_{\\min} \\, b^{j} \\right\\rfloor$ 和分箱 $[k_{j}, k_{j+1})$。令 $n_{j}$ 为度在 $[k_{j}, k_{j+1})$ 内的节点数。估计\n$$\n\\widehat{P}\\!\\left(k_{j}^{\\star}\\right) \\;=\\; \\frac{n_{j}}{N} \\quad \\text{其中} \\quad k_{j}^{\\star} \\;=\\; \\frac{k_{j} + k_{j+1}}{2}.\n$$\n在对数坐标轴上绘制 $\\widehat{P}(k_{j}^{\\star})$ 相对于 $k_{j}^{\\star}$ 的图像。\n\nC. 选择一个最小度 $k_{\\min} \\geq 1$ 和一个比率 $b > 1$。定义分箱边界 $k_{j} = \\left\\lfloor k_{\\min} \\, b^{j} \\right\\rfloor$ 和分箱 $[k_{j}, k_{j+1})$。令 $n_{j}$ 为度在 $[k_{j}, k_{j+1})$ 内的节点数。估计\n$$\n\\widehat{P}\\!\\left(k_{j}^{\\star}\\right) \\;=\\; \\frac{n_{j}}{N\\,\\big(\\log k_{j+1} - \\log k_{j}\\big)} \\quad \\text{其中} \\quad k_{j}^{\\star} \\;=\\; \\frac{k_{j} + k_{j+1}}{2}.\n$$\n在对数坐标轴上绘制 $\\widehat{P}(k_{j}^{\\star})$ 相对于 $k_{j}^{\\star}$ 的图像。\n\nD. 避免分箱，而是通过估计互补累积分布函数（Complementary Cumulative Distribution Function, CCDF）来减小方差，即 $\\widehat{S}(k) = \\frac{1}{N}\\sum_{\\ell=1}^{N} \\mathbf{1}\\{k_{\\ell} \\geq k\\}$，然后通过有限差分来近似 $P(k)$\n$$\n\\widehat{P}(k) \\;=\\; \\widehat{S}(k) - \\widehat{S}(k+1).\n$$\n报告每个整数 $k$ 的 $\\widehat{P}(k)$ 值。",
            "solution": "问题陈述在网络科学和统计数据分析领域提出了一个有效且定义明确的问题。它涉及如何从尾部的稀疏数据中对离散概率质量函数（即度分布 $P(k)$）进行有原则的估计，这是分析如蛋白质-蛋白质相互作用（PPI）网络等无标度网络时的一个常见挑战。给定的条件在科学上是合理的且内部一致的。\n\n**已知条件：**\n1. 研究对象是具有 $N$ 个节点的网络的度分布 $P(k)$。\n2. 度 $\\{k_{\\ell}\\}_{\\ell=1}^{N}$ 是整数。\n3. 对于大的 $k$ 值，数据是稀疏的，导致抽样方差很大。\n4. 目标是使用对数分箱来减小方差，同时获得对概率定律 $P(k)$ 的偏差缩减估计。\n5. 定义 (i)：$P(k) = \\Pr(K = k)$ 是离散随机变量 $K$ 的概率质量函数（PMF），且 $\\sum_{k=0}^{\\infty} P(k) = 1$。\n6. 定义 (ii)：在大 $N$ 极限下，区间内观测的经验频率近似于真实的概率。\n\n**从第一性原理推导**\n\n设 $K$ 为表示随机选择节点度的离散随机变量。度分布是其概率质量函数（PMF），$P(k) = \\Pr(K=k)$。对于一个有 $N$ 个节点的网络，其中度为 $k$ 的节点数为 $n_k$，$P(k)$ 的经验估计由 $\\widehat{P}(k) = n_k/N$ 给出。对于大的 $k$，$n_k$ 通常很小（经常是 $0$ 或 $1$），导致该估计的方差很高。\n\n对数分箱的策略是将度分组到宽度随 $k$ 增大的箱中。这确保了每个箱都包含合理数量的节点，从而稳定了估计值。让我们定义一组几何增长的分箱边界 $k_0, k_1, k_2, \\dots$，例如，对于某个 $b1$，$k_j \\approx k_{\\min} b^j$。第 $j$ 个分箱是整数区间 $[k_j, k_{j+1})$。设 $n_j$ 是度落入此分箱的节点数。\n\n节点度在第 $j$ 个分箱内的总概率是：\n$$\n\\Pr(k_j \\le K  k_{j+1}) = \\sum_{k=k_j}^{k_{j+1}-1} P(k)\n$$\n在大 $N$ 极限下，该概率可由经验频率近似：\n$$\n\\sum_{k=k_j}^{k_{j+1}-1} P(k) \\approx \\frac{n_j}{N}\n$$\n问题在于如何从分箱后的计数 $n_j$ 中获得 $P(k)$ 本身的点估计。对于大的 $k$，我们可以用连续的概率密度函数（PDF）$p(k)$ 来近似 PMF $P(k)$。于是，求和可以近似为积分：\n$$\n\\sum_{k=k_j}^{k_{j+1}-1} P(k) \\approx \\int_{k_j}^{k_{j+1}} p(x) \\, dx\n$$\n如果分箱足够窄，使得 $p(x)$ 在其内部变化不大，我们可以使用积分中值定理。该积分约等于函数在区间内某个代表点 $k_j^{\\star}$ 的值乘以区间的宽度。第 $j$ 个分箱的宽度是 $w_j = k_{j+1} - k_j$。\n$$\n\\int_{k_j}^{k_{j+1}} p(x) \\, dx \\approx p(k_j^{\\star}) \\cdot (k_{j+1} - k_j)\n$$\n结合这些近似，我们有：\n$$\n\\frac{n_j}{N} \\approx p(k_j^{\\star}) \\cdot (k_{j+1} - k_j)\n$$\n这使我们能够构建在点 $k_j^{\\star}$ 处密度 $p(k)$ 的估计量：\n$$\n\\widehat{p}(k_j^{\\star}) = \\frac{n_j}{N (k_{j+1} - k_j)}\n$$\n这个 PDF 的估计量通常（尽管略有不精确）在对数坐标轴上被绘制为“度分布”。按分箱宽度 $k_{j+1} - k_j$ 进行归一化是至关重要的。如果不这样做，更宽的分箱会纯粹因为其尺寸而显示出更大的计数，从而扭曲了估计分布的形状。如果 $P(k) \\sim k^{-\\gamma}$，这个估计量 $\\widehat{p}(k_j^{\\star})$ 也会按 $(k_j^{\\star})^{-\\gamma}$ 缩放，从而在双对数图上正确地揭示出指数。\n\n对于代表点 $k_j^{\\star}$，当分箱是对数间隔的且基础函数是幂律时，几何平均值 $k_j^{\\star} = \\sqrt{k_j k_{j+1}}$ 是比算术平均值更优的选择。这是因为在对数轴上，几何平均值正好位于中点：$\\log(\\sqrt{k_j k_{j+1}}) = \\frac{1}{2}(\\log k_j + \\log k_{j+1})$。这导致在估计幂律指数时有更低的偏差。\n\n最后，对于小的 $k$，数据不稀疏，对数分箱是不必要的，并且可能隐藏分布的特征。一个合理的做法是，对于小的 $k$ 使用单位宽度的分箱（即不分箱），而对于大的 $k$ 切换到对数分箱。\n\n**选项评估**\n\n**A. 选择一个最小度 $k_{\\min} \\geq 1$ 和一个比率 $b > 1$。定义分箱边界 $k_{j} = \\left\\lfloor k_{\\min} \\, b^{j} \\right\\rfloor$（对于 $j = 0,1,2,\\dots$ 直至最大观测度），以及分箱 $[k_{j}, k_{j+1})$。令 $n_{j}$ 为度在 $[k_{j}, k_{j+1})$ 内的节点数。对于低度值 $k  k_{\\mathrm{switch}}$，使用单位宽度的分箱以尊重离散性；对于 $k \\geq k_{\\mathrm{switch}}$，估计\n$$\n\\widehat{P}\\!\\left(k_{j}^{\\star}\\right) \\;=\\; \\frac{n_{j}}{N \\,\\big(k_{j+1} - k_{j}\\big)} \\quad \\text{其中} \\quad k_{j}^{\\star} \\;=\\; \\sqrt{k_{j}\\,k_{j+1}}.\n$$\n在对数坐标轴上绘制 $\\widehat{P}(k_{j}^{\\star})$ 相对于 $k_{j}^{\\star}$ 的图像。**\n\n此选项正确地指定了标准的、有原则的程序。\n1. 它使用由 $k_j = \\lfloor k_{\\min} b^j \\rfloor$ 定义的对数分箱。\n2. 关键是，估计量 $\\frac{n_{j}}{N(k_{j+1} - k_{j})}$ 正确地将分箱内的经验频率 $n_j/N$ 按分箱宽度 $k_{j+1} - k_j$ 进行了归一化。这产生了一个概率密度的估计，这是用于可视化缩放行为的正确量。\n3. 它提出了将几何平均值 $k_{j}^{\\star} = \\sqrt{k_{j}k_{j+1}}$ 作为分箱的代表点，这对于对数尺度上的幂律分布是最合适的选择。\n4. 它明智地采用了一种混合策略，在数据密集的低 $k$ 值处使用单位宽度的分箱。\n这个过程正确地减小了尾部的方差，同时最小化了偏差。\n结论：**正确**。\n\n**B. 选择一个最小度 $k_{\\min} \\geq 1$ 和一个比率 $b > 1$。定义分箱边界 $k_{j} = \\left\\lfloor k_{\\min} \\, b^{j} \\right\\rfloor$ 和分箱 $[k_{j}, k_{j+1})$。令 $n_{j}$ 为度在 $[k_{j}, k_{j+1})$ 内的节点数。估计\n$$\n\\widehat{P}\\!\\left(k_{j}^{\\star}\\right) \\;=\\; \\frac{n_{j}}{N} \\quad \\text{其中} \\quad k_{j}^{\\star} \\;=\\; \\frac{k_{j} + k_{j+1}}{2}.\n$$\n在对数坐标轴上绘制 $\\widehat{P}(k_{j}^{\\star})$ 相对于 $k_{j}^{\\star}$ 的图像。**\n\n此选项存在根本性缺陷。估计量 $\\widehat{P}(k_j^*) = n_j/N$ 仅仅是落在第 $j$ 个分箱内的总概率。由于对数分箱的宽度是递增的（$k_{j+1}-k_j$ 随 $j$ 增长），这个量 $n_j/N$ 对于较大的 $k$ 会被人为地放大。将此值与 $k_j^*$ 绘制成图并不能揭示真实的潜在分布 $P(k)$。对于一个幂律 $P(k) \\propto k^{-\\gamma}$，这个估计量的行为将是 $\\approx \\int_{k_j}^{k_{j+1}}C k^{-\\gamma} dk \\propto k_j^{1-\\gamma}$。双对数图的斜率会是 $1-\\gamma$，而不是 $-\\gamma$。缺少按分箱宽度进行的归一化是一个关键错误。\n结论：**不正确**。\n\n**C. 选择一个最小度 $k_{\\min} \\geq 1$ 和一个比率 $b > 1$。定义分箱边界 $k_{j} = \\left\\lfloor k_{\\min} \\, b^{j} \\right\\rfloor$ 和分箱 $[k_{j}, k_{j+1})$。令 $n_{j}$ 为度在 $[k_{j}, k_{j+1})$ 内的节点数。估计\n$$\n\\widehat{P}\\!\\left(k_{j}^{\\star}\\right) \\;=\\; \\frac{n_{j}}{N\\,\\big(\\log k_{j+1} - \\log k_{j}\\big)} \\quad \\text{其中} \\quad k_{j}^{\\star} \\;=\\; \\frac{k_{j} + k_{j+1}}{2}.\n$$\n在对数坐标轴上绘制 $\\widehat{P}(k_{j}^{\\star})$ 相对于 $k_{j}^{\\star}$ 的图像。**\n\n此选项按对数空间中的分箱宽度 $\\log k_{j+1} - \\log k_j$ 进行归一化。这对于估计 $P(k)$ 是不正确的。如推导过程所示，该估计量近似于量 $k P(k)$。如果 $P(k) \\propto k^{-\\gamma}$，该估计量将按 $k \\cdot k^{-\\gamma} = k^{1-\\gamma}$ 缩放。这个程序不估计 $P(k)$ 或一个类似的密度，而是估计一个关于 $k$ 的不同函数。这种归一化有时被专门用来检验 $P(k) \\propto k^{-1}$ 的分布，因为在这种情况下 $kP(k)$ 将是常数，但它不是 $P(k)$ 的通用估计量。\n结论：**不正确**。\n\n**D. 避免分箱，而是通过估计互补累积分布函数（Complementary Cumulative Distribution Function, CCDF），即 $\\widehat{S}(k) = \\frac{1}{N}\\sum_{\\ell=1}^{N} \\mathbf{1}\\{k_{\\ell} \\geq k\\}$，然后通过有限差分来近似 $P(k)$\n$$\n\\widehat{P}(k) \\;=\\; \\widehat{S}(k) - \\widehat{S}(k+1).\n$$\n报告每个整数 $k$ 的 $\\widehat{P}(k)$ 值。**\n\n尽管估计 CCDF（或生存函数 $S(k)$）是可视化幂律数据的一种有效且流行的方法，因为它能减少噪声，但此选项并未止步于此。它接着通过有限差分 $\\widehat{S}(k) - \\widehat{S}(k+1)$ 来计算 $\\widehat{P}(k)$。这个过程完全抵消了噪声的减少。一个简单的计算表明，这在数学上与原始的、高方差的、未分箱的估计量是完全相同的：\n$$\n\\widehat{P}(k) = \\widehat{S}(k) - \\widehat{S}(k+1) = \\frac{\\#\\{k_\\ell \\ge k\\}}{N} - \\frac{\\#\\{k_\\ell \\ge k+1\\}}{N} = \\frac{\\#\\{k_\\ell = k\\}}{N} = \\frac{n_k}{N}\n$$\n因此，该选项描述了对朴素经验 PMF 的一种迂回计算，而问题陈述明确指出，对于大的 $k$ 值，该 PMF 具有高方差。该方法未能实现为 $P(k)$ 的估计减少方差的既定目标。减少方差是通过直接分析 CCDF $\\widehat{S}(k)$ 来实现的，而不是通过对其进行差分来恢复带噪声的 PMF。\n结论：**不正确**。\n\n总之，选项 A 是唯一描述了用于估计度分布的科学上和统计上都合理的对数分箱程序的选项，它正确地处理了方差、归一化和离散性的问题。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "当我们通过可视化方法初步判断一个网络的度分布可能服从幂律分布后，下一步便是对其进行量化，特别是估算其关键参数——幂律指数 $\\gamma$。简单地在对数-对数图上进行线性回归是一种常见但具有误导性的方法。本练习将指导您从第一性原理出发，推导幂律分布指数的最大似然估计（Maximum Likelihood Estimator, MLE）公式，该方法是当前领域内公认的最可靠、最稳健的拟合方法。通过亲手推导，您将深刻理解估算这一核心网络参数背后的统计学原理 ()。",
            "id": "4333638",
            "problem": "在系统生物医学中，分子相互作用网络（如蛋白质-蛋白质相互作用网络）的度分布通常被建模为重尾分布。考虑这样一个网络的单个连通分量，其中观测到了所有满足 $k_{i} \\ge k_{\\min}$ 的节点的度 $\\{k_{i}\\}_{i=1}^{n}$。假设在下限截断值 $k_{\\min}$ 之上，度分布可以很好地用连续幂律来近似，因此对于 $k \\ge k_{\\min}$，概率密度函数 $p(k \\mid \\gamma)$ 与 $k^{-\\gamma}$ 成正比，其中指数 $\\gamma > 1$ 以确保可归一化。\n\n仅使用基本原理——即概率密度归一化和最大似然原理的要求——从观测样本 $\\{k_{i}\\}_{i=1}^{n}$ 中推导出连续模型的指数的最大似然估计量 $\\hat{\\gamma}$。然后，考虑到度本质上是整数值，陈述对该估计量的标准离散连续性校正，该校正通常用于在将连续近似应用于离散度数据时减少偏差。\n\n你的最终答案应表示为使用 LaTeX pmatrix 环境的单行矩阵中的一对符号表达式，其中第一个条目是连续模型的最大似然估计量 $\\hat{\\gamma}$，第二个条目是其离散连续性校正。不要四舍五入，也不要包含单位。",
            "solution": "问题陈述经评估有效。它在科学上植根于统计力学和网络理论，问题阐述清晰，目标明确，语言客观，并包含足够的信息以进行严谨的推导。未发现任何缺陷。\n\n按照要求，解答过程分为两部分。首先，推导连续幂律分布指数的最大似然估计量（MLE）。其次，陈述将此估计量应用于离散数据时所用的标准连续性校正。\n\n**第一部分：最大似然估计量 $\\hat{\\gamma}$ 的推导**\n\n推导遵循概率密度归一化和最大似然估计的原理。\n\n**1. 概率密度函数（PDF）的归一化**\n问题陈述，对于度 $k \\ge k_{\\min}$，概率密度函数 $p(k \\mid \\gamma)$ 与 $k^{-\\gamma}$ 成正比。我们可以将其写作：\n$$p(k \\mid \\gamma) = C k^{-\\gamma}$$\n其中 $C$ 是一个归一化常数。为了使 $p(k \\mid \\gamma)$ 成为一个有效的PDF，它在其定义域上的积分必须等于 $1$。\n$$\\int_{k_{\\min}}^{\\infty} p(k \\mid \\gamma) \\, dk = 1$$\n代入PDF的形式，我们有：\n$$\\int_{k_{\\min}}^{\\infty} C k^{-\\gamma} \\, dk = C \\int_{k_{\\min}}^{\\infty} k^{-\\gamma} \\, dk = 1$$\n我们利用给定的约束条件，即指数 $\\gamma  1$，来计算这个积分：\n$$C \\left[ \\frac{k^{-\\gamma+1}}{-\\gamma+1} \\right]_{k=k_{\\min}}^{k \\to \\infty} = 1$$\n由于 $\\gamma  1$，指数 $1-\\gamma$ 是负数。因此，当 $k \\to \\infty$ 时，项 $k^{1-\\gamma} \\to 0$。积分的计算结果为：\n$$C \\left( 0 - \\frac{k_{\\min}^{1-\\gamma}}{1-\\gamma} \\right) = C \\frac{k_{\\min}^{1-\\gamma}}{\\gamma-1} = 1$$\n求解归一化常数 $C$：\n$$C = \\frac{\\gamma-1}{k_{\\min}^{1-\\gamma}} = (\\gamma-1) k_{\\min}^{\\gamma-1}$$\n因此，连续幂律分布的归一化PDF为：\n$$p(k \\mid \\gamma) = (\\gamma-1) k_{\\min}^{\\gamma-1} k^{-\\gamma}, \\quad \\text{for } k \\ge k_{\\min}$$\n\n**2. 对数似然函数**\n给定一个包含 $n$ 个观测度的样本 $\\{k_i\\}_{i=1}^{n}$，其中每个 $k_i \\ge k_{\\min}$ 都被假定为从 $p(k \\mid \\gamma)$ 中独立同分布（IID）抽取的，似然函数 $L(\\gamma \\mid \\{k_i\\})$ 是观测到这个特定样本的联合概率：\n$$L(\\gamma \\mid \\{k_i\\}) = \\prod_{i=1}^{n} p(k_i \\mid \\gamma) = \\prod_{i=1}^{n} \\left[ (\\gamma-1) k_{\\min}^{\\gamma-1} k_i^{-\\gamma} \\right]$$\n为了简化最大化过程，我们使用对数似然函数 $\\mathcal{L}(\\gamma) = \\ln L(\\gamma \\mid \\{k_i\\})$：\n$$\\mathcal{L}(\\gamma) = \\ln \\left( \\prod_{i=1}^{n} \\left[ (\\gamma-1) k_{\\min}^{\\gamma-1} k_i^{-\\gamma} \\right] \\right)$$\n使用对数的性质（$\\ln(ab) = \\ln(a)+\\ln(b)$ 和 $\\ln(a^b) = b\\ln(a)$）：\n$$\\mathcal{L}(\\gamma) = \\sum_{i=1}^{n} \\ln \\left( (\\gamma-1) k_{\\min}^{\\gamma-1} k_i^{-\\gamma} \\right)$$\n$$\\mathcal{L}(\\gamma) = \\sum_{i=1}^{n} \\left[ \\ln(\\gamma-1) + (\\gamma-1)\\ln(k_{\\min}) - \\gamma\\ln(k_i) \\right]$$\n由于和式中的项除了 $\\ln(k_i)$ 外不依赖于索引 $i$，我们可以写成：\n$$\\mathcal{L}(\\gamma) = n \\ln(\\gamma-1) + n(\\gamma-1)\\ln(k_{\\min}) - \\gamma \\sum_{i=1}^{n} \\ln(k_i)$$\n\n**3. 对数似然的最大化**\n$\\gamma$ 的最大似然估计（MLE），记作 $\\hat{\\gamma}$，是使 $\\mathcal{L}(\\gamma)$ 最大化的 $\\gamma$ 值。我们通过求 $\\mathcal{L}(\\gamma)$ 关于 $\\gamma$ 的导数并将其设为零来找到这个值：\n$$\\frac{d\\mathcal{L}}{d\\gamma} = \\frac{d}{d\\gamma} \\left[ n \\ln(\\gamma-1) + n\\gamma\\ln(k_{\\min}) - n\\ln(k_{\\min}) - \\gamma \\sum_{i=1}^{n} \\ln(k_i) \\right]$$\n$$\\frac{d\\mathcal{L}}{d\\gamma} = \\frac{n}{\\gamma-1} + n\\ln(k_{\\min}) - \\sum_{i=1}^{n} \\ln(k_i)$$\n在 $\\gamma = \\hat{\\gamma}$ 处将导数设为零：\n$$\\frac{n}{\\hat{\\gamma}-1} + n\\ln(k_{\\min}) - \\sum_{i=1}^{n} \\ln(k_i) = 0$$\n现在，我们求解 $\\hat{\\gamma}$：\n$$\\frac{n}{\\hat{\\gamma}-1} = \\sum_{i=1}^{n} \\ln(k_i) - n\\ln(k_{\\min})$$\n$$\\frac{n}{\\hat{\\gamma}-1} = \\sum_{i=1}^{n} (\\ln(k_i) - \\ln(k_{\\min}))$$\n$$\\frac{n}{\\hat{\\gamma}-1} = \\sum_{i=1}^{n} \\ln\\left(\\frac{k_i}{k_{\\min}}\\right)$$\n分离出 $\\hat{\\gamma}-1$：\n$$\\hat{\\gamma}-1 = \\frac{n}{\\sum_{i=1}^{n} \\ln\\left(\\frac{k_i}{k_{\\min}}\\right)}$$\n最后，连续模型的 MLE 是：\n$$\\hat{\\gamma} = 1 + \\frac{n}{\\sum_{i=1}^{n} \\ln\\left(\\frac{k_i}{k_{\\min}}\\right)}$$\n\n**第二部分：离散连续性校正**\n\n上面推导出的估计量 $\\hat{\\gamma}$ 是针对连续变量 $k$ 的。然而，度数据 $\\{k_i\\}$ 本质上是离散整数。将连续估计量直接应用于离散数据会引入已知的正偏差。为了减少这种偏差，通常会应用连续性校正。\n\n标准校正涉及调整数据点，以使离散概率质量函数与连续概率密度函数更好地对齐。这是通过将每个离散数据点 $k_i$ 平移 $-\\frac{1}{2}$ 来实现的，从而有效地将整数值 $k_i$ 视为代表连续区间 $[k_i - \\frac{1}{2}, k_i + \\frac{1}{2})$。同样的平移也应用于下限截断值 $k_{\\min}$。\n\n按照要求，我们直接陈述校正后的估计量而不进行推导。该校正是通过在 $\\hat{\\gamma}$ 的公式中用 $k_i - \\frac{1}{2}$ 替换 $k_i$ 并用 $k_{\\min} - \\frac{1}{2}$ 替换 $k_{\\min}$ 来应用的。得到的估计量是：\n$$\\hat{\\gamma}_{\\text{corr}} = 1 + \\frac{n}{\\sum_{i=1}^{n} \\ln\\left(\\frac{k_i - \\frac{1}{2}}{k_{\\min} - \\frac{1}{2}}\\right)}$$\n\n最终答案由未校正和校正后的估计量的符号表达式对组成。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 + \\frac{n}{\\sum_{i=1}^{n} \\ln\\left(\\frac{k_i}{k_{\\min}}\\right)}  \\quad  1 + \\frac{n}{\\sum_{i=1}^{n} \\ln\\left(\\frac{k_i - \\frac{1}{2}}{k_{\\min} - \\frac{1}{2}}\\right)}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "网络的许多拓扑特性在很大程度上都受到其度序列的制约。因此，要判断一个在真实网络中观察到的结构特征（例如某个网络基序的富集程度）是否具有统计显著性，我们必须将其与一个具有相同度序列但其他方面完全随机的“零模型”进行比较。本练习将探讨“双边交换”（double-edge swap）算法——一种生成度保持的随机图的标准方法。同时，本练习也强调了在将此方法应用于无标度网络时必须面对的关键挑战，例如极长的“混合时间”（mixing time），并探讨了如何进行有效的计算实验设计，以确保假设检验的有效性 ()。",
            "id": "4333604",
            "problem": "在系统生物医学中，许多分子相互作用系统，例如蛋白质-蛋白质相互作用（PPI）网络，被建模为具有重尾度分布的简单无向图，这种分布近似于无标度行为。设一个简单无向图表示为 $G=(V,E)$，其中有 $|V|=n$ 个顶点和 $|E|=m$ 条边，顶点 $i$ 的度为 $k_i$。假设一个观察到的 PPI 网络具有经验度分布 $P(k)\\propto k^{-\\gamma}$ 且 $\\gamma2$，我们希望进行假设检验，以评估一个观察到的网络统计量 $T(G)$（例如与聚类相关的模体计数）是否相对于一个保持度的零模型有所升高。考虑通过运行一个马尔可夫链蒙特卡洛（MCMC）过程来构建零分布，该过程的状态空间是 $V$ 上所有具有与 $G$ 相同的固定度序列 $\\mathbf{k}=(k_1,\\dots,k_n)$ 的简单图的集合 $\\mathcal{G}(\\mathbf{k})$，其转移由双边交换定义：在每一步，从 $E$ 中选择一个无序的不同边对，比如说 $\\{(u,v),(x,y)\\}$，其中 $u,v,x,y\\in V$，以等概率提议重连为 $\\{(u,x),(v,y)\\}$ 或 $\\{(u,y),(v,x)\\}$，并且仅当结果图是简单的且实现度序列 $\\mathbf{k}$ 时才接受该提议；否则拒绝并停留在当前状态。目标是从 $\\mathcal{G}(\\mathbf{k})$ 上的均匀分布中获取样本，以计算蒙特卡洛 $p$ 值 $p=\\Pr_{G'\\sim \\pi}\\!\\big(T(G')\\ge T(G)\\big)$，其中 $\\pi$ 是目标零分布。\n\n基于图论和马尔可夫链理论的基本定义和广为接受的事实，包括边关联下的度守恒、通过细致平衡定义的平稳性，以及混合时间 $t_{\\mathrm{mix}}(\\epsilon)$ 作为总变差距离达到平稳状态 $\\epsilon$ 范围内的最小步数的概念，选择所有关于通过双边交换生成保持度的随机化以及在无标度生物网络中进行假设检验时的混合时间考量的正确陈述：\n\nA. 在一个简单无向图中，选择两条边 $(u,v)$ 和 $(x,y)$，其中 $u,v,x,y$ 均不相同，并重连为 $(u,x)$ 和 $(v,y)$ 或 $(u,y)$ 和 $(v,x)$，会保持度序列 $\\mathbf{k}$。如果均匀选择无序边对和两种重连模式，并且只接受简单的结果，则得到的马尔可夫链相对于 $\\mathcal{G}(\\mathbf{k})$ 上的均匀分布是非周期的和可逆的。\n\nB. 对于无标度 PPI 网络典型的重尾度序列，双边交换链的混合时间可证明为 $O(n)$，因此运行 $n$ 次接受的交换可以保证为假设检验提供近似独立的样本。\n\nC. 如果链的运行时间不足以混合，基于模体的统计量的蒙特卡洛 $p$ 值可能会有偏，因为样本仍然是相关的且非均匀的；在计算 $p$ 值之前，应检查诸如 $T(G_t)$ 的轨迹图和自相关估计等实用诊断方法来评估收敛性。\n\nD. 为了提高在 $\\mathcal{G}(\\mathbf{k})$ 上的均匀性，应以与它们端点度的乘积成正比的概率选择候选边，这可以补偿中心节点并确保每个图的实现都是等可能的。\n\nE. 带有末端匹配的配置模型自动产生一个具有指定度序列的简单图，因此它可以不经任何拒绝或修正地用于在 $\\mathcal{G}(\\mathbf{k})$ 上初始化 MCMC 链以进行假设检验。",
            "solution": "兹确认问题陈述的有效性。该问题在网络科学和统计学领域具有科学依据，是适定的，并使用了客观、标准的术语。所描述的场景——使用双边交换 MCMC 为无标度网络上的假设检验生成一个保持度的零模型——是系统生物学中一个常见且相关的过程。\n\n我们根据图论和马尔可夫链理论的既定原则来评估每个陈述。目标是从所有具有固定度序列 $\\mathbf{k}$ 的简单图的集合 $\\mathcal{G}(\\mathbf{k})$ 上的均匀分布 $\\pi$ 中进行抽样。\n\n**选项A的分析：**\n该陈述声称，一个特定的双边交换过程会保持度序列 $\\mathbf{k}$，并定义了一个在 $\\mathcal{G}(\\mathbf{k})$ 上具有均匀平稳分布的非周期、可逆的马尔可夫链。\n\n1.  **度的保持性：** 考虑两条不同的边 $(u,v)$ 和 $(x,y)$。一次双边交换将它们替换为 $(u,x)$ 和 $(v,y)$。我们来检查每个相关顶点的度变化。原始度为 $k_u, k_v, k_x, k_y$。交换后，新的度 $k'_u, k'_v, k'_x, k'_y$ 为：\n    -   $k'_u = (k_u - 1) + 1 = k_u$ (失去了到 $v$ 的边，获得了到 $x$ 的边)。\n    -   $k'_v = (k_v - 1) + 1 = k_v$ (失去了到 $u$ 的边，获得了到 $y$ 的边)。\n    -   $k'_x = (k_x - 1) + 1 = k_x$ (失去了到 $y$ 的边，获得了到 $u$ 的边)。\n    -   $k'_y = (k_y - 1) + 1 = k_y$ (失去了到 $x$ 的边，获得了到 $v$ 的边)。\n    所有其他顶点的度保持不变。因此，该操作保持了度序列 $\\mathbf{k}$。这是双边交换的一个基本性质。\n\n2.  **可逆性与平稳性：** 马尔可夫链定义在状态空间 $\\mathcal{G}(\\mathbf{k})$ 上。我们希望证明它相对于均匀分布 $\\pi$ 是可逆的。对于均匀分布，$\\pi(G)$ 对所有 $G \\in \\mathcal{G}(\\mathbf{k})$ 都是常数。可逆性（细致平衡）要求 $\\pi(G) P(G \\to G') = \\pi(G') P(G' \\to G)$，对于任何由一步连接的两个状态 $G, G' \\in \\mathcal{G}(\\mathbf{k})$，这简化为 $P(G \\to G') = P(G' \\to G)$。\n    从 $G$ 到 $G'$ 的转移包括：\n    a) 提议一个移动：以均匀概率 $1/\\binom{m}{2}$ 从 $G$ 中选择一个无序的不同边对，例如 $\\{(u,v), (x,y)\\}$。然后以 $1/2$ 的概率选择两种重连方式之一。\n    b) 如果结果图 $G'$ 是简单的，则接受该移动。\n    从 $G'$ 到 $G$ 的反向转移涉及从 $G'$ 中选择边对 $\\{(u,x), (v,y)\\}$ 并重连回 $\\{(u,v), (x,y)\\}$。提议概率是对称的：在两种情况下，都是从 $m$ 条总边中均匀选择两条边。接受条件仅取决于结果图的简单性。如果移动 $G \\to G'$ 被接受，则 $G'$ 是简单的。反向移动 $G' \\to G$ 也必须被接受，因为根据定义 $G$ 是简单的（它是 $\\mathcal{G}(\\mathbf{k})$ 中的一个状态）。因此，转移概率是对称的，$P(G \\to G') = P(G' \\to G)$，该链是可逆的，其平稳分布是均匀的。\n\n3.  **非周期性：** 如果马尔可夫链的状态转移图中存在自环，则该链是非周期的。MCMC 过程规定，如果提议的交换被拒绝（因为它会产生多重边或自环），链将停留在当前状态。这个“停留在当前状态”的规则为任何可以提议出非简单图的状态 $G$ 创造了一个非零的自转移概率 $P(G \\to G)  0$。对于任何非平凡的图，这几乎总是成立的。自环的存在保证了非周期性。\n\n该陈述还假定状态空间 $\\mathcal{G}(\\mathbf{k})$ 通过交换操作是连通的（即，链是不可约的）。对于实践中遇到的大多数图形度序列，这是一个标准结果。\n因此，陈述A是对这个MCMC采样器性质的正确描述。\n\n**结论：正确**\n\n**选项B的分析：**\n该陈述声称，对于重尾度序列，混合时间可证明为 $O(n)$。混合时间 $t_{\\mathrm{mix}}(\\epsilon)$ 是指链接近其平稳分布所需的步数。\n双边交换链的混合时间是一个复杂且被深入研究的课题。虽然对于某些类型的图（例如，正则图），混合时间是多项式有界的，但已知对于具有重尾度分布的图（例如所述的无标度网络），混合速度非常慢。\n高度顶点（“中心节点”）的存在在状态空间中造成了“瓶颈”。涉及与中心节点相连的边的大量提议交换都会被拒绝，因为它们会产生多重边。这使得图结构在中心节点周围变得“粘滞”或“冻结”，极大地减慢了状态空间的探索。\n理论工作已经证实，对于某些幂律度序列，混合时间是 $n$ 的超多项式。它绝对不是 $O(n)$。这种慢混合是在现实世界的无标度网络上应用此方法时的一个主要实践挑战。声称混合时间可证明为 $O(n)$ 在事实上对于所讨论的网络类别是错误的。\n\n**结论：不正确**\n\n**选项C的分析：**\n该陈述讨论了慢混合的实际后果，并推荐了诊断程序。\n\n1.  **混合不充分导致的偏差：** 如果 MCMC 链从观察到的网络 $G$ 开始，且运行的步数不足（$t \\ll t_{\\mathrm{mix}}$），那么生成的样本 $G'$ 将不会是从均匀分布 $\\pi$ 中抽取的。相反，它们将与初始状态 $G$ 以及彼此之间高度相关。这导致对统计量 $T(G')$ 的零分布的有偏估计。因此，计算出的蒙特卡洛 $p$ 值 $p=\\Pr_{G'\\sim \\pi}\\!\\big(T(G')\\ge T(G)\\big)$ 将是不可靠的。例如，如果 $T(G)$ 异常高，而链未能探索到 $T(G')$ 较低的状态空间区域，估计的 $p$ 值将被被人为地夸大，可能导致第二类错误（假阴性）。\n\n2.  **实用诊断方法：** 由于理论混合时间通常是未知的或大到不切实际，应用 MCMC 依赖于经验诊断来评估收敛性。该陈述列出了两种标准方法：\n    -   **轨迹图：** 绘制统计量 $T(G_t)$ 随时间 $t$ 的变化图。一个混合良好的链应该产生一个围绕稳定均值波动的轨迹图，没有任何可辨别的趋势或漂移。\n    -   **自相关估计：** 计算 $T(G_t)$ 和 $T(G_{t+lag})$ 之间的相关性。对于独立样本，随着滞后增加，自相关应迅速降至零。持续的高自相关表明混合缓慢和样本相关。\n这些是任何负责任地使用 MCMC 方法进行假设检验时必不可少的标准实践。\n\n该陈述是对该方法的实际挑战和最佳实践的正确且至关重要的总结。\n\n**结论：正确**\n\n**选项D的分析：**\n该陈述提出了一种替代的采样方案：以与它们端点度的乘积成正比的概率选择候选边，声称这“补偿了中心节点并确保每个图的实现都是等可能的”。\n问题中描述的（并在选项A中分析的）标准方法，即均匀选择边对，已经具有均匀分布作为其平稳分布。提议的方案引入了一个非均匀的提议分布。\n根据 Metropolis-Hastings 算法，为了在使用非均匀提议分布 $q(G \\to G')$ 的同时保持一个特定的目标分布 $\\pi$，接受概率 $\\alpha(G \\to G')$ 必须进行调整。对于一个均匀的目标分布 $(\\pi(G)=\\pi(G'))$，接受概率必须是 $\\alpha(G \\to G') = \\min\\left(1, \\frac{q(G' \\to G)}{q(G \\to G')}\\right)$。\n该陈述建议改变提议机制，但没有提及对接受概率的任何相应改变。如果接受规则仍然是“如果简单则接受”，那么得到的平稳分布将不再是均匀的。它将以一种取决于新的提议概率的方式偏向某些状态。因此，声称该方法“确保每个图的实现都是等可能的”是错误的。虽然有一些高级的 MCMC 技术使用非均匀提议来尝试加速混合，但它们都要求一个正确制定的 Metropolis-Hastings 接受步骤来靶向所需分布。该陈述忽略了这个关键细节，并做出了一个错误的声明。\n\n**结论：不正确**\n\n**选项E的分析：**\n该陈述声称，带有末端匹配的配置模型“自动产生一个简单图”，并且可以“不经任何拒绝或修正”地使用。\n配置模型是生成具有指定度序列 $\\mathbf{k}$ 的随机图的标准算法。它的工作原理是为每个顶点 $i$ 创建 $k_i$ 个“末端”或“半边”，然后在所有末端的集合上创建一个随机完美匹配。\n然而，结果图是一个多重图，而不一定是简单图。随机匹配过程可能连接来自同一顶点的两个末端（产生一个自环），或在相同的两个顶点之间创建多对边（产生多重边）。这类事件的概率非零，并且可能很显著，特别是对于具有高度顶点（中心节点）的度序列，而这正是无标度网络的特征。\n因此，声称该模型“自动产生一个简单图”在事实上是错误的。因此，它不能“不经任何拒绝或修正”地用于为 MCMC 生成一个有效的起始状态，因为 MCMC 是定义在*简单*图的空间 $\\mathcal{G}(\\mathbf{k})$ 上的。为了从配置模型中获得一个简单图，通常使用拒绝采样（如果图不是简单的，则丢弃并重新生成）或应用一个程序来消除自环和多重边。\n\n**结论：不正确**",
            "answer": "$$\\boxed{AC}$$"
        }
    ]
}