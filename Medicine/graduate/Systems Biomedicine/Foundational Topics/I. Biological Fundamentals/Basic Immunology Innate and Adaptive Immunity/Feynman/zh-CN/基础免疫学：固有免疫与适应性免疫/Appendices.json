{
    "hands_on_practices": [
        {
            "introduction": "NF-κB信号通路是先天免疫反应的核心。本练习将引导你分析一个描述TLR4信号传导至NF-κB激活的简化动力学模型。通过推导该系统在持续刺激下的稳态解，你将掌握分析生物网络长期行为的关键方法，并理解负反馈回路在调节免疫应答强度和持续时间中的重要作用。",
            "id": "4317610",
            "problem": "人体固有免疫细胞通过Toll样受体4 (TLR4)感知脂多糖(lipopolysaccharide)。配体结合后，TLR4会招募衔接蛋白myeloid differentiation primary response 88 (MyD88)和TIR-domain-containing adapter-inducing interferon-β (TRIF)，它们共同通过一种类似IκB激酶的有效活性来激活活化B细胞的核因子κ轻链增强子(Nuclear Factor kappa-light-chain-enhancer of activated B cells, NF-κB)。核内NF-κB诱导其抑制剂IκB的转录，从而建立限制其核定位的负反馈。考虑以下最小集总参数模型，该模型捕捉了这些特征，同时抽象了中间的分子细节。\n\n设已占据受体的比例为 $R(t)\\in[0,1]$。在时间 $t=0$ 时施加饱和配体阶跃刺激，假设对于所有 $t\\ge 0$，有 $R(t)=1$。设 $M(t)$ 和 $T(t)$ 分别表示由MyD88和TRIF分支产生的有效激酶驱动活性。假设其为一阶激活-失活动态过程，\n$$\n\\frac{dM}{dt} = k_{M} R(t) - \\lambda_{M} M(t),\\qquad\n\\frac{dT}{dt} = k_{T} R(t) - \\lambda_{T} T(t),\n$$\n因此总有效激酶活性为 $K(t)=M(t)+T(t)$。设 $N(t)\\in[0,1]$ 表示总NF-κB的核内比例，而 $I(t)\\ge 0$ 表示IκB的浓度。NF-κB的核输入由 $K(t)$ 驱动，并受到胞质NF-κB可及性和IκB负反馈的限制；核输出为一阶过程。抑制剂 $I(t)$ 的产生与核内NF-κB成正比，并以一阶方式衰减。这些过程可由以下方程描述：\n$$\n\\frac{dN}{dt} = \\frac{\\alpha\\,K(t)\\,\\big(1-N(t)\\big)}{1 + I(t)/K_{I}} - \\delta\\,N(t),\\qquad\n\\frac{dI}{dt} = \\sigma\\,N(t) - \\mu\\,I(t).\n$$\n此处，$\\alpha,\\delta,\\sigma,\\mu,\\lambda_{M},\\lambda_{T},k_{M},k_{T},K_{I}$ 均为正常数，其中 $K_{I}$ 是反馈效力标度。\n\n在持续饱和刺激 $R(t)=1$ 的条件下，系统趋于一个稳态，在该稳态下 $\\frac{dM}{dt}=\\frac{dT}{dt}=\\frac{dN}{dt}=\\frac{dI}{dt}=0$。仅从上述模型结构以及其中隐含的基本质量作用和守恒定律出发，推导稳态核内NF-κB比例 $N_{\\mathrm{ss}}$ 的闭式解析表达式，该表达式应由参数 $\\alpha,\\delta,\\sigma,\\mu,\\lambda_{M},\\lambda_{T},k_{M},k_{T},K_{I}$ 表示。\n\n将你的最终答案表示为单个闭式解析表达式。不包含任何单位。无需进行四舍五入。",
            "solution": "该问题是有效的。它提出了一个明确定义的常微分方程组（ODEs），用于模拟一个生物信号通路，这是系统生物医学中的一种标准方法。该问题具有科学依据、自成体系且客观。它要求推导一个稳态解，这是一个适定的数学任务。\n\n我们的任务是在持续饱和刺激（其中对于 $t \\ge 0$ 有 $R(t)=1$）下，求解稳态核内NF-κB比例，记为 $N_{\\mathrm{ss}}$。稳态的定义是系统中所有时间导数均为零。\n\n首先，我们求解MyD88和TRIF分支的稳态活性 $M_{\\mathrm{ss}}$ 和 $T_{\\mathrm{ss}}$。其控制方程为：\n$$\n\\frac{dM}{dt} = k_{M} R(t) - \\lambda_{M} M(t)\n$$\n$$\n\\frac{dT}{dt} = k_{T} R(t) - \\lambda_{T} T(t)\n$$\n在稳态下，$\\frac{dM}{dt} = 0$ 且 $\\frac{dT}{dt} = 0$。在持续刺激 $R(t)=1$ 的条件下，我们有：\n$$\n0 = k_{M}(1) - \\lambda_{M} M_{\\mathrm{ss}} \\implies M_{\\mathrm{ss}} = \\frac{k_{M}}{\\lambda_{M}}\n$$\n$$\n0 = k_{T}(1) - \\lambda_{T} T_{\\mathrm{ss}} \\implies T_{\\mathrm{ss}} = \\frac{k_{T}}{\\lambda_{T}}\n$$\n稳态下的总有效激酶活性 $K_{\\mathrm{ss}}$ 是这些单独活性的总和：\n$$\nK_{\\mathrm{ss}} = M_{\\mathrm{ss}} + T_{\\mathrm{ss}} = \\frac{k_{M}}{\\lambda_{M}} + \\frac{k_{T}}{\\lambda_{T}}\n$$\n由于所有参数 $k_M, \\lambda_M, k_T, \\lambda_T$ 均为正常数，因此 $K_{\\mathrm{ss}}$ 是一个正常数。\n\n接下来，我们分析NF-κB和IκB子系统的稳态。其控制方程为：\n$$\n\\frac{dN}{dt} = \\frac{\\alpha\\,K(t)\\,\\big(1-N(t)\\big)}{1 + I(t)/K_{I}} - \\delta\\,N(t)\n$$\n$$\n\\frac{dI}{dt} = \\sigma\\,N(t) - \\mu\\,I(t)\n$$\n在稳态下，$\\frac{dN}{dt} = 0$ 且 $\\frac{dI}{dt} = 0$。设 $N_{\\mathrm{ss}}$ 和 $I_{\\mathrm{ss}}$ 为稳态值。由第二个方程可得：\n$$\n0 = \\sigma N_{\\mathrm{ss}} - \\mu I_{\\mathrm{ss}} \\implies I_{\\mathrm{ss}} = \\frac{\\sigma}{\\mu} N_{\\mathrm{ss}}\n$$\n这个表达式将抑制剂 $I$ 的稳态浓度直接与NF-κB的稳态核内比例 $N$ 相关联。这代表了负反馈回路。\n\n现在，我们将 $K_{\\mathrm{ss}}$ 和 $I_{\\mathrm{ss}}$ 的表达式代入第一个稳态方程：\n$$\n0 = \\frac{\\alpha\\,K_{\\mathrm{ss}}\\,\\big(1-N_{\\mathrm{ss}}\\big)}{1 + I_{\\mathrm{ss}}/K_{I}} - \\delta\\,N_{\\mathrm{ss}}\n$$\n$$\n\\delta\\,N_{\\mathrm{ss}} = \\frac{\\alpha\\,K_{\\mathrm{ss}}\\,(1-N_{\\mathrm{ss}})}{1 + \\left(\\frac{\\sigma}{\\mu K_{I}}\\right) N_{\\mathrm{ss}}}\n$$\n为了求解 $N_{\\mathrm{ss}}$，我们重排此方程：\n$$\n\\delta\\,N_{\\mathrm{ss}} \\left(1 + \\frac{\\sigma}{\\mu K_{I}} N_{\\mathrm{ss}}\\right) = \\alpha\\,K_{\\mathrm{ss}}(1-N_{\\mathrm{ss}})\n$$\n展开两边可得：\n$$\n\\delta\\,N_{\\mathrm{ss}} + \\frac{\\delta \\sigma}{\\mu K_{I}} N_{\\mathrm{ss}}^2 = \\alpha\\,K_{\\mathrm{ss}} - \\alpha\\,K_{\\mathrm{ss}}\\,N_{\\mathrm{ss}}\n$$\n这是一个关于 $N_{\\mathrm{ss}}$ 的二次方程。我们可以将其写成标准形式 $a x^2 + b x + c = 0$：\n$$\n\\left(\\frac{\\delta \\sigma}{\\mu K_{I}}\\right) N_{\\mathrm{ss}}^2 + (\\delta + \\alpha K_{\\mathrm{ss}}) N_{\\mathrm{ss}} - \\alpha K_{\\mathrm{ss}} = 0\n$$\n我们使用求根公式 $N_{\\mathrm{ss}} = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 来求解 $N_{\\mathrm{ss}}$，其系数为：\n$a = \\frac{\\delta \\sigma}{\\mu K_{I}}$\n$b = \\delta + \\alpha K_{\\mathrm{ss}}$\n$c = -\\alpha K_{\\mathrm{ss}}$\n\n$$\nN_{\\mathrm{ss}} = \\frac{-(\\delta + \\alpha K_{\\mathrm{ss}}) \\pm \\sqrt{(\\delta + \\alpha K_{\\mathrm{ss}})^2 - 4\\left(\\frac{\\delta \\sigma}{\\mu K_{I}}\\right)(-\\alpha K_{\\mathrm{ss}})}}{2\\left(\\frac{\\delta \\sigma}{\\mu K_{I}}\\right)}\n$$\n$$\nN_{\\mathrm{ss}} = \\frac{-(\\delta + \\alpha K_{\\mathrm{ss}}) \\pm \\sqrt{(\\delta + \\alpha K_{\\mathrm{ss}})^2 + \\frac{4 \\alpha \\delta \\sigma K_{\\mathrm{ss}}}{\\mu K_{I}}}}{\\frac{2 \\delta \\sigma}{\\mu K_{I}}}\n$$\n问题指明 $N(t)$ 代表一个比例，因此其值必须具有物理意义，即 $N_{\\mathrm{ss}} \\ge 0$。所有参数 $\\alpha, \\delta, \\sigma, \\mu, K_I$ 均为正数，并且我们已经证明 $K_{\\mathrm{ss}}$ 为正数。因此，系数 $a$ 和 $b$ 为正，而 $c$ 为负。平方根下的项，即判别式，是 $(\\delta + \\alpha K_{\\mathrm{ss}})^2 + \\frac{4 \\alpha \\delta \\sigma K_{\\mathrm{ss}}}{\\mu K_{I}}$，该项严格为正。\n我们来检验这两个根。项 $\\sqrt{(\\delta + \\alpha K_{\\mathrm{ss}})^2 + \\frac{4 \\alpha \\delta \\sigma K_{\\mathrm{ss}}}{\\mu K_{I}}}$ 严格大于 $\\sqrt{(\\delta + \\alpha K_{\\mathrm{ss}})^2} = \\delta + \\alpha K_{\\mathrm{ss}}$。\n如果我们在分子中选择减号，即 $-(\\delta + \\alpha K_{\\mathrm{ss}}) - \\sqrt{\\dots}$，则结果将为负。由于分母为正，这个 $N_{\\mathrm{ss}}$ 的根将是负值，这在物理上是不允许的。\n因此，我们必须选择加号，这会得到一个正的分子，从而使 $N_{\\mathrm{ss}}$ 的值为正。\n\n物理上有效的解是：\n$$\nN_{\\mathrm{ss}} = \\frac{-(\\delta + \\alpha K_{\\mathrm{ss}}) + \\sqrt{(\\delta + \\alpha K_{\\mathrm{ss}})^2 + \\frac{4 \\alpha \\delta \\sigma K_{\\mathrm{ss}}}{\\mu K_{I}}}}{\\frac{2 \\delta \\sigma}{\\mu K_{I}}}\n$$\n这可以重写为：\n$$\nN_{\\mathrm{ss}} = \\frac{\\mu K_{I}}{2\\delta\\sigma} \\left( -(\\delta + \\alpha K_{\\mathrm{ss}}) + \\sqrt{(\\delta + \\alpha K_{\\mathrm{ss}})^2 + \\frac{4 \\alpha \\delta \\sigma K_{\\mathrm{ss}}}{\\mu K_{I}}} \\right)\n$$\n最后，我们代入 $K_{\\mathrm{ss}} = \\frac{k_{M}}{\\lambda_{M}} + \\frac{k_{T}}{\\lambda_{T}}$ 的表达式，以获得用给定模型参数表示的最终答案。\n$$\nN_{\\mathrm{ss}} = \\frac{\\mu K_{I}}{2\\delta\\sigma} \\left[ -\\left(\\delta + \\alpha \\left(\\frac{k_{M}}{\\lambda_{M}} + \\frac{k_{T}}{\\lambda_{T}}\\right)\\right) + \\sqrt{\\left(\\delta + \\alpha \\left(\\frac{k_{M}}{\\lambda_{M}} + \\frac{k_{T}}{\\lambda_{T}}\\right)\\right)^2 + \\frac{4 \\alpha \\delta \\sigma}{\\mu K_{I}} \\left(\\frac{k_{M}}{\\lambda_{M}} + \\frac{k_{T}}{\\lambda_{T}}\\right)} \\right]\n$$\n这就是稳态核内NF-κB比例的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{\\mu K_{I}}{2\\delta\\sigma} \\left[ -\\left(\\delta + \\alpha \\left(\\frac{k_{M}}{\\lambda_{M}} + \\frac{k_{T}}{\\lambda_{T}}\\right)\\right) + \\sqrt{\\left(\\delta + \\alpha \\left(\\frac{k_{M}}{\\lambda_{M}} + \\frac{k_{T}}{\\lambda_{T}}\\right)\\right)^2 + \\frac{4 \\alpha \\delta \\sigma}{\\mu K_{I}} \\left(\\frac{k_{M}}{\\lambda_{M}} + \\frac{k_{T}}{\\lambda_{T}}\\right)} \\right]}\n$$"
        },
        {
            "introduction": "B细胞受体（BCR）的多样性是适应性免疫系统能够识别无数抗原的基础，而这一多样性源于一个高度调控的基因重组过程。本练习将一个关键的生物学过程——免疫球蛋白轻链的顺序重组和编辑——抽象为一个概率模型。通过计算成熟B细胞群体中κ轻链和λ轻链的预期使用比例，你将学会如何将复杂的单细胞随机事件转化为可预测的群体水平结果，从而深化对V(D)J重组和克隆选择理论的理解。",
            "id": "4317616",
            "problem": "一个发育中的B细胞会按照生物学既定顺序进行免疫球蛋白轻链基因重组：首先在免疫球蛋白kappa ($\\kappa$) 轻链基因座上进行重组，如果无法利用kappa链形成非自身反应性的B细胞受体 (BCR)，则在免疫球蛋白lambda ($\\lambda$) 轻链基因座上进行重组。请考虑以下基于经过充分验证的免疫学观察的建模假设：(i) 每个等位基因上的重组事件是独立的；(ii) 每个基因座有两个等位基因；(iii) 等位基因排斥确保了细胞成熟需要一条功能性、非自身反应性的轻链；(iv) 受体编辑是一个额外的重组步骤，可以在转换基因座之前，在同一基因座内解决自身反应性问题；(v) 只有在获得非自身反应性BCR的情况下，细胞才会成熟。设单个等位基因重组是功能性的（即码框内且可表达的）概率，在kappa基因座上为 $r_{\\kappa}$，在lambda基因座上为 $r_{\\lambda}$。设kappa基因座上的功能性重排产生自身反应性BCR的概率为 $q_{\\kappa}$，类似地，lambda基因座上为 $q_{\\lambda}$。设kappa或lambda基因座上的受体编辑成功解决自身反应性（导致在同一基因座上产生非自身反应性受体）的概率分别为 $e_{\\kappa}$ 和 $e_{\\lambda}$。假设如果kappa重组产生自身反应性受体且kappa编辑失败，细胞将尝试lambda重组；如果两个kappa等位基因都未能产生功能性受体，细胞将尝试lambda重组；如果lambda重组产生自身反应性受体，lambda编辑可能解决此问题，否则细胞成熟失败。\n\n利用这些定义，计算成熟B细胞中使用kappa与lambda轻链的预期比例。使用以下科学上合理的参数值：$r_{\\kappa} = 0.35$，$r_{\\lambda} = 0.30$，$q_{\\kappa} = 0.60$，$q_{\\lambda} = 0.50$，$e_{\\kappa} = 0.70$，$e_{\\lambda} = 0.75$。设一个拥有两个等位基因的基因座产生至少一次功能性重排的概率为 $1 - (1 - r)^2$。将给定基因座上的成熟定义为在该基因座上通过初始重排或编辑后获得一个功能性、非自身反应性的受体。将kappa和lambda的成熟结果通过总成熟概率进行归一化，以获得总和为一的使用分布。\n\n将每个比例四舍五入至四位有效数字。将最终的使用分布表示为一个分别对应$\\kappa$和$\\lambda$的双元素行向量。",
            "solution": "用户提供了一个在尝试解决之前需要验证的问题。\n\n### 问题验证\n\n**步骤1：提取给定信息**\n- **生物学过程：** B细胞轻链重组首先在免疫球蛋白kappa ($\\kappa$) 基因座上发生，如果kappa失败，则在lambda ($\\lambda$) 基因座上发生。\n- **假设与规则：**\n    - (i) 等位基因上的重组事件是独立的。\n    - (ii) 每个基因座（$\\kappa$, $\\lambda$）有两个等位基因。\n    - (iii) 一个功能性、非自身反应性的轻链是细胞成熟所必需的（等位基因排斥）。\n    - (iv) 受体编辑可以解决自身反应性。\n    - (v) 细胞成熟需要一个非自身反应性的B细胞受体 (BCR)。\n- **转换过程顺序：**\n    - 如果两个kappa等位基因都未能产生功能性受体，细胞将尝试lambda重组。\n    - 如果kappa重组产生自身反应性受体且kappa编辑失败，细胞将尝试lambda重组。\n    - 如果lambda失败（无论是非功能性，还是自身反应性且编辑失败），细胞成熟失败。\n- **概率与定义：**\n    - $r_{\\kappa}$：单个$\\kappa$等位基因功能性重组的概率。\n    - $r_{\\lambda}$：单个$\\lambda$等位基因功能性重组的概率。\n    - $q_{\\kappa}$：一个功能性$\\kappa$重排是自身反应性的概率。\n    - $q_{\\lambda}$：一个功能性$\\lambda$重排是自身反应性的概率。\n    - $e_{\\kappa}$：在$\\kappa$基因座上成功进行受体编辑的概率。\n    - $e_{\\lambda}$：在$\\lambda$基因座上成功进行受体编辑的概率。\n    - 一个拥有两个等位基因的基因座产生至少一次功能性重排的概率给定为 $1 - (1 - r)^2$。\n- **参数值：**\n    - $r_{\\kappa} = 0.35$\n    - $r_{\\lambda} = 0.30$\n    - $q_{\\kappa} = 0.60$\n    - $q_{\\lambda} = 0.50$\n    - $e_{\\kappa} = 0.70$\n    - $e_{\\lambda} = 0.75$\n- **任务：** 计算成熟B细胞中使用$\\kappa$与$\\lambda$轻链的预期比例，归一化使其总和为一。将每个比例四舍五入到四位有效数字，并表示为一个双元素行向量。\n\n**步骤2：使用提取的给定信息进行验证**\n- **科学依据：** 该问题描述了一个简化但标准的免疫球蛋白轻链重组模型，这是免疫学中的一个核心概念。该过程，包括基因座重排的顺序、等位基因排斥和受体编辑，均基于既定的生物学原理。所有概念在科学上都是合理的。\n- **良态的：** 该问题以定量方式定义，包含了所有必要的参数、数值和清晰的事件序列。目标明确无误。提供的基因座功能性概率公式 $1 - (1-r)^2$ 是对两个等位基因独立性直接且一致的应用。\n- **客观性：** 该问题以精确、正式的语言陈述，没有任何主观性或歧义。\n\n**缺陷清单：**\n1.  **科学或事实不准确：** 无。\n2.  **无法形式化或不相关：** 无。该问题是一个应用于系统生物医学的概率论形式化练习。\n3.  **不完整或矛盾的设置：** 无。规则是完整且内部一致的。\n4.  **不切实际或不可行：** 无。该问题是一个具有合理参数的有效理论模型。\n5.  **病态或结构不良：** 无。问题结构导向一个唯一解。\n6.  **伪深刻、琐碎或同义反复：** 无。该问题需要一个非平凡的多步计算。\n7.  **超出科学可验证范围：** 无。\n\n**步骤3：结论与行动**\n该问题**有效**。将提供解答。\n\n### 解答\n\n该问题要求计算一个发育中的B细胞使用kappa ($\\kappa$) 或lambda ($\\lambda$) 轻链成熟的概率，然后将这些概率归一化，以找到它们在成熟B细胞群体中的各自比例。\n\n设 $P(\\text{Prod}_{L})$ 为在给定基因座 $L \\in \\{\\kappa, \\lambda\\}$ 上实现至少一次功能性重排的概率。鉴于每个基因座有两个独立的等位基因，该概率为：\n$$ P(\\text{Prod}_{L}) = 1 - (1 - r_L)^2 $$\n\n计算过程首先分析$\\kappa$基因座的结果，然后对于在$\\kappa$阶段未能成熟的细胞，分析$\\lambda$基因座。\n\n**1. Kappa ($\\kappa$) 基因座的分析**\n\n首先，我们使用 $r_{\\kappa} = 0.35$ 计算在$\\kappa$基因座上获得至少一次功能性重排的概率：\n$$ P(\\text{Prod}_{\\kappa}) = 1 - (1 - r_{\\kappa})^2 = 1 - (1 - 0.35)^2 = 1 - (0.65)^2 = 1 - 0.4225 = 0.5775 $$\n如果发生一次功能性重排，并且产生的BCR最初就是非自身反应性的，或者在成功的受体编辑后变为非自身反应性，则细胞将使用$\\kappa$链成熟。一个功能性受体是或变为非自身反应性的概率为 $(1 - q_{\\kappa}) + q_{\\kappa} e_{\\kappa}$。\n设 $P(\\text{Mat}_{\\kappa})$ 为一个细胞使用$\\kappa$链成熟的总概率。\n$$ P(\\text{Mat}_{\\kappa}) = P(\\text{Prod}_{\\kappa}) \\times [ (1 - q_{\\kappa}) + q_{\\kappa} e_{\\kappa} ] $$\n使用给定值 $q_{\\kappa} = 0.60$ 和 $e_{\\kappa} = 0.70$：\n$$ P(\\text{Mat}_{\\kappa}) = 0.5775 \\times [ (1 - 0.60) + (0.60 \\times 0.70) ] $$\n$$ P(\\text{Mat}_{\\kappa}) = 0.5775 \\times [ 0.40 + 0.42 ] = 0.5775 \\times 0.82 = 0.47355 $$\n\n**2. 向Lambda ($\\lambda$) 基因座的转换**\n\n如果一个细胞未能产生成熟的$\\kappa$链，它将转换到$\\lambda$基因座。这种失败可以通过两种不相交的方式发生：\n(a) 在$\\kappa$基因座上没有发生功能性重排。概率为 $1 - P(\\text{Prod}_{\\kappa})$。\n(b) 发生了功能性重排，但它是自身反应性的，并且随后的受体编辑失败。概率为 $P(\\text{Prod}_{\\kappa}) \\times q_{\\kappa} \\times (1 - e_{\\kappa})$。\n\n设 $P(\\text{Switch})$ 为转换到$\\lambda$基因座的总概率。\n$$ P(\\text{Switch}) = (1 - P(\\text{Prod}_{\\kappa})) + P(\\text{Prod}_{\\kappa}) \\times q_{\\kappa} \\times (1 - e_{\\kappa}) $$\n$$ P(\\text{Switch}) = (1 - 0.5775) + 0.5775 \\times 0.60 \\times (1 - 0.70) $$\n$$ P(\\text{Switch}) = 0.4225 + 0.5775 \\times 0.60 \\times 0.30 $$\n$$ P(\\text{Switch}) = 0.4225 + 0.10395 = 0.52645 $$\n作为检验，在$\\kappa$基因座上成熟的概率加上转换的概率必须总和为1。确实，$P(\\text{Mat}_{\\kappa}) + P(\\text{Switch}) = 0.47355 + 0.52645 = 1.0$。\n\n**3. Lambda ($\\lambda$) 基因座的分析**\n\n对于转换到$\\lambda$基因座的细胞亚群，我们重复此分析。首先，我们使用 $r_{\\lambda} = 0.30$ 计算在$\\lambda$基因座上发生功能性重排的概率：\n$$ P(\\text{Prod}_{\\lambda}) = 1 - (1 - r_{\\lambda})^2 = 1 - (1 - 0.30)^2 = 1 - (0.70)^2 = 1 - 0.49 = 0.51 $$\n在细胞已转换的条件下，使用$\\lambda$链成熟的条件概率为：\n$$ P(\\text{Mat}_{\\lambda} | \\text{Switch}) = P(\\text{Prod}_{\\lambda}) \\times [ (1 - q_{\\lambda}) + q_{\\lambda} e_{\\lambda} ] $$\n使用给定值 $q_{\\lambda} = 0.50$ 和 $e_{\\lambda} = 0.75$：\n$$ P(\\text{Mat}_{\\lambda} | \\text{Switch}) = 0.51 \\times [ (1 - 0.50) + (0.50 \\times 0.75) ] $$\n$$ P(\\text{Mat}_{\\lambda} | \\text{Switch}) = 0.51 \\times [ 0.50 + 0.375 ] = 0.51 \\times 0.875 = 0.44625 $$\n使用$\\lambda$链成熟的绝对概率 $P(\\text{Mat}_{\\lambda})$ 是转换概率乘以该条件概率：\n$$ P(\\text{Mat}_{\\lambda}) = P(\\text{Switch}) \\times P(\\text{Mat}_{\\lambda} | \\text{Switch}) $$\n$$ P(\\text{Mat}_{\\lambda}) = 0.52645 \\times 0.44625 = 0.2349140625 $$\n\n**4. 归一化与最终比例**\n\n一个细胞成熟的总概率是使用$\\kappa$链或$\\lambda$链成熟的概率之和：\n$$ P(\\text{Total Maturation}) = P(\\text{Mat}_{\\kappa}) + P(\\text{Mat}_{\\lambda}) $$\n$$ P(\\text{Total Maturation}) = 0.47355 + 0.2349140625 = 0.7084640625 $$\n使用$\\kappa$链的成熟B细胞比例 $f_{\\kappa}$ 为：\n$$ f_{\\kappa} = \\frac{P(\\text{Mat}_{\\kappa})}{P(\\text{Total Maturation})} = \\frac{0.47355}{0.7084640625} \\approx 0.66841703 $$\n使用$\\lambda$链的成熟B细胞比例 $f_{\\lambda}$ 为：\n$$ f_{\\lambda} = \\frac{P(\\text{Mat}_{\\lambda})}{P(\\text{Total Maturation})} = \\frac{0.2349140625}{0.7084640625} \\approx 0.33158297 $$\n将这些比例四舍五入到四位有效数字，得到：\n$$ f_{\\kappa} \\approx 0.6684 $$\n$$ f_{\\lambda} \\approx 0.3316 $$\n这些比例代表了成熟B细胞群体中$\\kappa$和$\\lambda$轻链的预期使用分布。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6684 & 0.3316\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "辅助T细胞的分化是适应性免疫应答方向的关键决定点，例如，在不同细胞因子环境下，初始T细胞可以分化为促炎性的Th17细胞或抑制性的Treg细胞。本练习将指导你构建一个模拟ROR$\\gamma$t和FOXP3这两个关键转录因子相互作用的基因调控网络动力学模型。通过编写代码进行数值模拟，你将亲身体验细胞命运决定如何从一个双稳态开关的动态行为中涌现，并绘制出不同细胞因子组合如何驱动细胞走向不同谱系的“相图”，这是系统生物学研究复杂细胞决策的典型范例。",
            "id": "4317605",
            "problem": "您的任务是构建一个最小双基因调控网络模型，用以描述T辅助细胞$17$ (Th$17$) 与调节性T细胞 (Treg) 的分化过程，此过程是转化生长因子-β (TGF-beta) 和白细胞介素$6$ (IL-$6$) 的函数。目标是从第一性原理出发，推导一个常微分方程组，该方程组能捕捉细胞因子输入如何通过主转录因子RAR相关孤儿受体γt (ROR$\\gamma t$) 和叉头盒蛋白$P3$ (FOXP$3$) 来影响分化偏向，然后利用该方程组计算在指定细胞因子条件下的稳定细胞谱系结局。最终程序应为所提供的测试套件生成一行输出，汇总分类结果。不允许用户输入。\n\n从以下基本依据和核心定义开始：\n- 分子生物学中心法则：信号传导调控转录因子的表达，而转录因子会随时间降解。\n- 准稳态下的受体-配体结合：对于细胞因子浓度 $C$ 和解离常数 $K$，被占据的受体分数为 $C/(K+C)$。\n- Hill型转录调控：激活和抑制可通过协同结合产生的S型Hill函数进行建模。\n- 线性降解：蛋白质损失速率与其浓度成正比。\n\n用于指定系统的建模假设：\n- 状态变量是ROR$\\gamma t$的归一化浓度 $R(t)$ 和FOXP$3$的归一化浓度 $F(t)$。初始条件代表初始T细胞状态：$R(0) = 0.01$ 和 $F(0) = 0.01$。\n- TGF-beta浓度表示为 $T$；IL-$6$浓度表示为 $I$。定义受体占据分数为 $S_T = \\dfrac{T}{K_T + T}$ 和 $S_I = \\dfrac{I}{K_I + I}$。\n- $R$（Th$17$主调控因子）的合成受TGF-beta和IL-$6$的加性激活，并受$F$的抑制。$F$（Treg主调控因子）的合成受TGF-beta的激活，受$R$的抑制，并额外受IL-$6$的抑制。抑制因子 $X$ 对靶标的乘性抑制因子为 $h_{\\text{rep}}(X) = \\dfrac{1}{1 + (X/K)^n}$。\n- IL-$6$共刺激通过一个乘性因子 $g_{\\text{IL6}}(S_I) = \\dfrac{1}{1 + q_I \\, S_I^{m_I}}$ 抑制 $F$。\n- $R$ 和 $F$ 的降解均为线性过程，具有相应的速率常数。\n\n使用的参数值：\n- 受体占据的Hill参数：$K_T = 0.5$, $K_I = 0.5$。\n- 基础合成和激活权重：对于 $R$ 为 $\\beta_0 = 0.05$, $a_T = 0.8$, $a_I = 1.0$；对于 $F$ 为 $\\beta_0 = 0.05$, $b_T = 2.0$。\n- 相互抑制参数：$F$对$R$的抑制为 $K_{RF} = 1.5$，$R$对$F$的抑制为 $K_{FR} = 1.5$，Hill系数为 $n_{RF} = 2$, $n_{FR} = 2$。\n- IL-$6$对$F$的抑制：$q_I = 6$, $m_I = 2$。\n- 合成规模和降解速率：$\\alpha_R = 1.0$, $\\alpha_F = 1.0$, $\\delta_R = 1.0$, $\\delta_F = 1.0$。\n\n根据这些假设，推导一个二维动力学系统 $dR/dt = \\text{synthesis}_R(R,F,T,I) - \\text{degradation}_R(R)$ 和 $dF/dt = \\text{synthesis}_F(R,F,T,I) - \\text{degradation}_F(F)$。确保推导出的形式与所述的受体占据、加性激活、乘性抑制和线性降解规则一致。不允许使用其他形式。\n\n数值解法要求：\n- 对每个测试用例，使用显式四阶龙格-库塔方法对系统进行积分。\n- 时间步长：$\\Delta t = 0.01$。最大模拟时间：$t_{\\max} = 400.0$。\n- 提前终止：如果 $\\max\\{|dR/dt|, |dF/dt|\\}  \\varepsilon$ 连续出现 $N_{\\text{stable}}$ 步，则提前终止积分，其中 $\\varepsilon = 10^{-8}$ 且 $N_{\\text{stable}} = 100$。\n- 每步之后强制非负性：如果数值更新产生负的 $R$ 或 $F$，则将其截断为 $0$。\n- 对于每个测试用例，从初始条件 $R(0) = 0.01$, $F(0) = 0.01$ 开始。\n\n对数值估计的稳态 $(R^*, F^*)$ 进行细胞谱系结局分类：\n- 定义阈值 $L = 0.2$ 和 $H = 0.6$，以及优势比 $\\eta = 2.0$。\n- 如果 $R^* \\ge H$ 且 $\\dfrac{R^*}{F^*} \\ge \\eta$，则分类为Th$17$主导型，并返回整数 $1$。\n- 否则，如果 $F^* \\ge H$ 且 $\\dfrac{F^*}{R^*} \\ge \\eta$，则分类为Treg主导型，并返回整数 $0$。\n- 否则，如果 $R^* \\ge H$ 且 $F^* \\ge H$，则分类为共存型，并返回整数 $2$。\n- 否则，如果 $R^*  L$ 且 $F^*  L$，则分类为初始型，并返回整数 $3$。\n- 否则，如果 $R^*  F^*$，返回 $1$，否则返回 $0$。\n\n测试套件：\n您的程序必须计算以下六种细胞因子条件 $(T, I)$ 的分类结果：\n- 情况 $1$：$(0.0, 0.0)$。\n- 情况 $2$：$(1.0, 0.0)$。\n- 情况 $3$：$(1.0, 1.0)$。\n- 情况 $4$：$(0.4, 1.0)$。\n- 情况 $5$：$(1.0, 0.2)$。\n- 情况 $6$：$(0.2, 0.0)$。\n\n所有变量和参数均为无量纲。无需进行物理单位转换。\n\n最终输出规范：\n您的程序应生成单行输出，其中包含一个用方括号括起来的、由逗号分隔的整数列表的结果（例如，$[r_1,r_2,\\dots,r_6]$），其中 $r_k$ 是按上述顺序排列的第 $k$ 种情况的分类整数。不应打印任何额外文本。",
            "solution": "该问题要求构建并模拟一个用于T辅助细胞分化的二维常微分方程 (ODE) 模型。该模型描述了主转录因子ROR$\\gamma t$ ($R$) 和FOXP$3$ ($F$) 归一化浓度的动力学过程，这两个因子分别决定了初始T细胞向Th$17$或Treg谱系分化的命运。系统的行为由两种细胞因子TGF-beta ($T$) 和IL-$6$ ($I$) 的外部浓度控制。\n\n第一步是根据所述的原理和假设，正式推导ODE系统。每个转录因子浓度变化率的通用形式由其合成与降解之间的平衡给出：\n$$\n\\frac{dR}{dt} = \\text{Synthesis}_R - \\text{Degradation}_R\n$$\n$$\n\\frac{dF}{dt} = \\text{Synthesis}_F - \\text{Degradation}_F\n$$\n两种蛋白质的降解都被指定为线性过程，意味着损失速率与浓度成正比：\n$$\n\\text{Degradation}_R(R) = \\delta_R R\n$$\n$$\n\\text{Degradation}_F(F) = \\delta_F F\n$$\n使用给定的参数 $\\delta_R = 1.0$ 和 $\\delta_F = 1.0$，降解项简化为 $R$ 和 $F$。\n\n合成项是通过结合基础合成、细胞因子诱导的激活以及相互抑制的效应来构建的。首先，我们定义受体占据分数 $S_T$ 和 $S_I$，它们用于模拟细胞因子信号的强度。这些分数遵循一个标准的类米氏方程 (Michaelis-Menten-like) 形式：\n$$\nS_T = \\frac{T}{K_T + T} \\quad \\text{和} \\quad S_I = \\frac{I}{K_I + I}\n$$\n参数值为 $K_T = 0.5$ 和 $K_I = 0.5$。\n\n接下来，我们构建 $R(t)$ 的合成速率。它包括一个基础速率 $\\beta_0$，并受到来自TGF-beta（通过 $S_T$）和IL-$6$（通过 $S_I$）信号的加性激活。然后，这个激活项被 $F$ 乘性抑制。抑制作用由一个递减的Hill函数建模。$R$ 的总合成速率为：\n$$\n\\text{Synthesis}_R = \\alpha_R \\left( \\beta_0 + a_T S_T + a_I S_I \\right) h_{\\text{rep}}(F)\n$$\n其中 $h_{\\text{rep}}(F) = \\frac{1}{1 + (F/K_{RF})^{n_{RF}}}$。\n代入参数 $\\alpha_R = 1.0$, $\\beta_0 = 0.05$, $a_T = 0.8$, $a_I = 1.0$, $K_{RF} = 1.5$ 和 $n_{RF} = 2$，我们得到：\n$$\n\\text{Synthesis}_R = \\left( 0.05 + 0.8 \\frac{T}{0.5+T} + 1.0 \\frac{I}{0.5+I} \\right) \\frac{1}{1 + (F/1.5)^2}\n$$\n结合合成与降解，得到 $R(t)$ 的完整ODE为：\n$$\n\\frac{dR}{dt} = \\left( 0.05 + 0.8 \\frac{T}{0.5+T} + 1.0 \\frac{I}{0.5+I} \\right) \\frac{1}{1 + (F/1.5)^2} - R\n$$\n\n类似地，我们构建 $F(t)$ 的合成速率。它被TGF-beta激活，被$R$抑制，同时也被IL-$6$抑制。多种抑制作用以乘法方式结合。\n$$\n\\text{Synthesis}_F = \\alpha_F ( \\beta_0 + b_T S_T ) h_{\\text{rep}}(R) g_{\\text{IL6}}(S_I)\n$$\n其中 $h_{\\text{rep}}(R) = \\frac{1}{1 + (R/K_{FR})^{n_{FR}}}$ 且 $g_{\\text{IL6}}(S_I) = \\frac{1}{1 + q_I S_I^{m_I}}$。\n代入参数 $\\alpha_F = 1.0$, $\\beta_0 = 0.05$, $b_T = 2.0$, $K_{FR} = 1.5$, $n_{FR} = 2$, $q_I = 6$ 和 $m_I = 2$，我们得到：\n$$\n\\text{Synthesis}_F = \\left( 0.05 + 2.0 \\frac{T}{0.5+T} \\right) \\frac{1}{1 + (R/1.5)^2} \\frac{1}{1 + 6 \\left(\\frac{I}{0.5+I}\\right)^2}\n$$\n$F(t)$ 的完整ODE为：\n$$\n\\frac{dF}{dt} = \\left( 0.05 + 2.0 \\frac{T}{0.5+T} \\right) \\frac{1}{1 + (R/1.5)^2} \\frac{1}{1 + 6 \\left(\\frac{I}{0.5+I}\\right)^2} - F\n$$\n\n在完整定义了ODE系统之后，下一步是为每个给定的细胞因子条件 $(T, I)$ 对其进行数值求解。问题指定了四阶龙格-库塔 (RK4) 方法。对于一个系统 $\\frac{d\\vec{y}}{dt} = f(t, \\vec{y})$，其中 $\\vec{y} = [R, F]^T$，使用步长 $\\Delta t$ 的一步RK4计算如下：\n$$\n\\vec{k}_1 = \\Delta t \\cdot f(t_n, \\vec{y}_n)\n$$\n$$\n\\vec{k}_2 = \\Delta t \\cdot f(t_n + \\frac{\\Delta t}{2}, \\vec{y}_n + \\frac{\\vec{k}_1}{2})\n$$\n$$\n\\vec{k}_3 = \\Delta t \\cdot f(t_n + \\frac{\\Delta t}{2}, \\vec{y}_n + \\frac{\\vec{k}_2}{2})\n$$\n$$\n\\vec{k}_4 = \\Delta t \\cdot f(t_n + \\Delta t, \\vec{y}_n + \\vec{k}_3)\n$$\n$$\n\\vec{y}_{n+1} = \\vec{y}_n + \\frac{1}{6}(\\vec{k}_1 + 2\\vec{k}_2 + 2\\vec{k}_3 + \\vec{k}_4)\n$$\n我们从初始条件 $\\vec{y}(0) = [R(0), F(0)]^T = [0.01, 0.01]^T$ 开始模拟。模拟运行至 $t_{\\max} = 400.0$，时间步长为 $\\Delta t = 0.01$。如果系统达到稳态，模拟将提前停止。稳态定义为导数的最大绝对值 $\\max\\{|\\frac{dR}{dt}|, |\\frac{dF}{dt}|\\}$ 连续 $N_{\\text{stable}} = 100$ 个时间步长内保持低于容差 $\\varepsilon = 10^{-8}$ 的条件。在每个积分步骤之后，浓度 $R$ 和 $F$ 在 $0$ 处被截断以强制非负性。\n\n最后，根据一组分层规则对模拟得到的稳态浓度 $(R^*, F^*)$ 进行分类：\n- 定义阈值 $L = 0.2$、$H = 0.6$ 和优势比 $\\eta = 2.0$。\n- 规则1：若 $R^* \\ge H$ 且 $R^* \\ge \\eta F^*$，则分类为Th$17$主导型 ($1$)。\n- 规则2：否则，若 $F^* \\ge H$ 且 $F^* \\ge \\eta R^*$，则分类为Treg主导型 ($0$)。\n- 规则3：否则，若 $R^* \\ge H$ 且 $F^* \\ge H$，则分类为共存型 ($2$)。\n- 规则4：否则，若 $R^*  L$ 且 $F^*  L$，则分类为初始型 ($3$)。\n- 规则5：否则，根据简单多数进行分类：若 $R^* > F^*$ 则为Th$17$ ($1$)，否则为Treg ($0$)。\n此过程将应用于所提供测试套件中的每个测试用例，以生成最终的分类结果列表。请注意，分类规则中涉及比率的条件是以乘法形式（例如 $R^* \\ge \\eta F^*$）实现的，以避免潜在的除零错误。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the T-cell differentiation problem.\n    It simulates the gene regulatory network for different cytokine conditions\n    and classifies the steady-state outcomes.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    params = {\n        # Initial conditions\n        'R0': 0.01, 'F0': 0.01,\n        # Receptor occupancy\n        'K_T': 0.5, 'K_I': 0.5,\n        # RORgt (R) synthesis\n        'beta_0_R': 0.05, 'a_T': 0.8, 'a_I': 1.0,\n        # FOXP3 (F) synthesis\n        'beta_0_F': 0.05, 'b_T': 2.0,\n        # Mutual repression\n        'K_RF': 1.5, 'n_RF': 2,\n        'K_FR': 1.5, 'n_FR': 2,\n        # IL-6 repression of F\n        'q_I': 6.0, 'm_I': 2,\n        # Synthesis and degradation scales\n        'alpha_R': 1.0, 'alpha_F': 1.0,\n        'delta_R': 1.0, 'delta_F': 1.0,\n    }\n\n    # --- Numerical Integration Parameters ---\n    num_params = {\n        'dt': 0.01,\n        't_max': 400.0,\n        'epsilon': 1e-8,\n        'N_stable': 100\n    }\n\n    # --- Classification Parameters ---\n    class_params = {\n        'L': 0.2, 'H': 0.6, 'eta': 2.0\n    }\n\n    # --- Test Suite ---\n    test_cases = [\n        # (T, I)\n        (0.0, 0.0),  # Case 1\n        (1.0, 0.0),  # Case 2\n        (1.0, 1.0),  # Case 3\n        (0.4, 1.0),  # Case 4\n        (1.0, 0.2),  # Case 5\n        (0.2, 0.0),  # Case 6\n    ]\n\n    def get_derivatives(y, T, I, p):\n        \"\"\"\n        Calculates the derivatives dR/dt and dF/dt.\n        y: numpy array [R, F]\n        T, I: cytokine concentrations\n        p: dictionary of model parameters\n        \"\"\"\n        R, F = y[0], y[1]\n\n        # Receptor occupancy\n        S_T = T / (p['K_T'] + T) if (p['K_T'] + T) != 0 else 0\n        S_I = I / (p['K_I'] + I) if (p['K_I'] + I) != 0 else 0\n\n        # Synthesis of R\n        activation_R = p['beta_0_R'] + p['a_T'] * S_T + p['a_I'] * S_I\n        repression_R_by_F = 1.0 / (1.0 + (F / p['K_RF'])**p['n_RF'])\n        synthesis_R = p['alpha_R'] * activation_R * repression_R_by_F\n        \n        # Synthesis of F\n        activation_F = p['beta_0_F'] + p['b_T'] * S_T\n        repression_F_by_R = 1.0 / (1.0 + (R / p['K_FR'])**p['n_FR'])\n        repression_F_by_IL6 = 1.0 / (1.0 + p['q_I'] * S_I**p['m_I'])\n        synthesis_F = p['alpha_F'] * activation_F * repression_F_by_R * repression_F_by_IL6\n\n        # Derivatives\n        dR_dt = synthesis_R - p['delta_R'] * R\n        dF_dt = synthesis_F - p['delta_F'] * F\n\n        return np.array([dR_dt, dF_dt])\n\n    def run_simulation(T, I, p, np_):\n        \"\"\"\n        Runs the RK4 simulation for a given cytokine condition.\n        \"\"\"\n        y = np.array([p['R0'], p['F0']])\n        t = 0.0\n        stable_counter = 0\n\n        max_steps = int(np_['t_max'] / np_['dt'])\n        for _ in range(max_steps):\n            # RK4 step\n            k1 = get_derivatives(y, T, I, p)\n            k2 = get_derivatives(y + (np_['dt'] / 2.0) * k1, T, I, p)\n            k3 = get_derivatives(y + (np_['dt'] / 2.0) * k2, T, I, p)\n            k4 = get_derivatives(y + np_['dt'] * k3, T, I, p)\n            y += (np_['dt'] / 6.0) * (k1 + 2*k2 + 2*k3 + k4)\n\n            # Enforce nonnegativity\n            y[y  0] = 0\n\n            # Early stopping check\n            derivatives = get_derivatives(y, T, I, p)\n            if np.max(np.abs(derivatives))  np_['epsilon']:\n                stable_counter += 1\n            else:\n                stable_counter = 0\n            \n            if stable_counter >= np_['N_stable']:\n                break\n            \n            t += np_['dt']\n\n        return y[0], y[1]\n\n    def classify_outcome(R_star, F_star, c_p):\n        \"\"\"\n        Classifies the steady-state outcome based on R* and F*.\n        \"\"\"\n        H, L, eta = c_p['H'], c_p['L'], c_p['eta']\n\n        # Rule 1: Th17-dominant\n        if R_star >= H and R_star >= eta * F_star:\n            return 1\n        # Rule 2: Treg-dominant\n        elif F_star >= H and F_star >= eta * R_star:\n            return 0\n        # Rule 3: Coexistence\n        elif R_star >= H and F_star >= H:\n            return 2\n        # Rule 4: Naive\n        elif R_star  L and F_star  L:\n            return 3\n        # Rule 5: Default based on majority\n        else:\n            return 1 if R_star > F_star else 0\n\n    results = []\n    for t_val, i_val in test_cases:\n        R_final, F_final = run_simulation(t_val, i_val, params, num_params)\n        outcome = classify_outcome(R_final, F_final, class_params)\n        results.append(outcome)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}