{
    "hands_on_practices": [
        {
            "introduction": "本练习将带您完成多基因风险评分 (Polygenic Risk Score, PRS) 的基础计算。通过处理一个小型假设数据集，您将应用加性遗传模型来整合多个单核苷酸多态性 (Single Nucleotide Polymorphism, SNP) 的效应。这项练习巩固了PRS作为等位基因剂量加权和的核心原理，并介绍了在群体中比较得分时至关重要的标准化步骤。",
            "id": "4375612",
            "problem": "在系统生物医学中，复杂性状的加性遗传模型将许多基因位点的累积效应表示为对一个未观测易感性的线性预测子。在此模型下，通过编码为等位基因剂量的单核苷酸多态性（SNP）基因型和源自全基因组关联研究（GWAS）的位点特异性权重，构建多基因风险评分（PRS）。考虑三个SNP，其效应量权重为 $w=(0.05,\\,-0.02,\\,0.03)$，其中每个条目对应于该位点上每个额外效应等位基因对潜在易感性的贡献。一个包含 $N=5$ 个个体的队列，其SNP剂量向量分别为\n$x_{\\mathrm{A}}=(2,\\,1,\\,0)$、\n$x_{\\mathrm{B}}=(1,\\,0,\\,1)$、\n$x_{\\mathrm{C}}=(0,\\,2,\\,2)$、\n$x_{\\mathrm{D}}=(2,\\,0,\\,2)$、\n$x_{\\mathrm{E}}=(0,\\,1,\\,0)$，\n其中每个 $x$ 的条目表示在三个位点上效应等位基因的数量 $\\{0,1,2\\}$。使用加性遗传模型，并将该队列作为标准化群体，计算个体 $\\mathrm{A}$ 的 PRS，然后通过减去队列均值并除以队列标准差来对此评分进行标准化，使用总体方差（除以 $N$，而不是 $N-1$）。将个体 $\\mathrm{A}$ 的最终标准化评分表示为小数，并将您的答案四舍五入到 $4$ 位有效数字。",
            "solution": "复杂性状的加性遗传模型假定，由遗传变异贡献的易感性可以近似为位点特异性效应和等位基因剂量的线性组合。设个体 $i$ 的多基因风险评分（PRS）表示为 $S_{i}$，设 $w=(w_{1},w_{2},w_{3})$ 为SNP权重向量，设 $x_{i}=(x_{i1},x_{i2},x_{i3})$ 为个体 $i$ 的基因型剂量向量。根据线性预测子的基本原理，PRS 定义为\n$$\nS_{i}=\\sum_{j=1}^{3} w_{j}\\,x_{ij}.\n$$\n为了将此PRS置于一个在队列中可比较的标准化尺度上，我们计算队列均值\n$$\n\\mu=\\frac{1}{N}\\sum_{i=1}^{N} S_{i},\n$$\n总体方差\n$$\n\\sigma^{2}=\\frac{1}{N}\\sum_{i=1}^{N} \\left(S_{i}-\\mu\\right)^{2},\n$$\n和标准差 $\\sigma=\\sqrt{\\sigma^{2}}$。那么，个体 $i$ 的标准化评分（由线性预测子导出的易感性尺度上的 $z$-分数）为\n$$\nZ_{i}=\\frac{S_{i}-\\mu}{\\sigma}.\n$$\n\n我们现在使用 $w=(0.05,\\,-0.02,\\,0.03)$ 计算每个队列成员的 $S_{i}$。\n\n- 个体 $\\mathrm{A}$ 的 $x_{\\mathrm{A}}=(2,\\,1,\\,0)$，因此\n$$\nS_{\\mathrm{A}}=0.05\\cdot 2 + (-0.02)\\cdot 1 + 0.03\\cdot 0 = 0.10 - 0.02 + 0 = 0.08.\n$$\n- 个体 $\\mathrm{B}$ 的 $x_{\\mathrm{B}}=(1,\\,0,\\,1)$，因此\n$$\nS_{\\mathrm{B}}=0.05\\cdot 1 + (-0.02)\\cdot 0 + 0.03\\cdot 1 = 0.05 + 0 + 0.03 = 0.08.\n$$\n- 个体 $\\mathrm{C}$ 的 $x_{\\mathrm{C}}=(0,\\,2,\\,2)$，因此\n$$\nS_{\\mathrm{C}}=0.05\\cdot 0 + (-0.02)\\cdot 2 + 0.03\\cdot 2 = 0 - 0.04 + 0.06 = 0.02.\n$$\n- 个体 $\\mathrm{D}$ 的 $x_{\\mathrm{D}}=(2,\\,0,\\,2)$，因此\n$$\nS_{\\mathrm{D}}=0.05\\cdot 2 + (-0.02)\\cdot 0 + 0.03\\cdot 2 = 0.10 + 0 + 0.06 = 0.16.\n$$\n- 个体 $\\mathrm{E}$ 的 $x_{\\mathrm{E}}=(0,\\,1,\\,0)$，因此\n$$\nS_{\\mathrm{E}}=0.05\\cdot 0 + (-0.02)\\cdot 1 + 0.03\\cdot 0 = 0 - 0.02 + 0 = -0.02.\n$$\n\n队列的PRS值为 $\\{0.08,\\,0.08,\\,0.02,\\,0.16,\\,-0.02\\}$。队列大小为 $N=5$，因此均值为\n$$\n\\mu=\\frac{1}{5}\\left(0.08+0.08+0.02+0.16-0.02\\right)=\\frac{0.32}{5}=0.064.\n$$\n我们计算偏差及其平方：\n$$\n\\begin{aligned}\nS_{\\mathrm{A}}-\\mu = 0.08-0.064=0.016,  (S_{\\mathrm{A}}-\\mu)^{2} = 0.000256, \\\\\nS_{\\mathrm{B}}-\\mu = 0.08-0.064=0.016,  (S_{\\mathrm{B}}-\\mu)^{2} = 0.000256, \\\\\nS_{\\mathrm{C}}-\\mu = 0.02-0.064=-0.044,  (S_{\\mathrm{C}}-\\mu)^{2} = 0.001936, \\\\\nS_{\\mathrm{D}}-\\mu = 0.16-0.064=0.096,  (S_{\\mathrm{D}}-\\mu)^{2} = 0.009216, \\\\\nS_{\\mathrm{E}}-\\mu = -0.02-0.064=-0.084,  (S_{\\mathrm{E}}-\\mu)^{2} = 0.007056.\n\\end{aligned}\n$$\n将这些偏差平方相加得到\n$$\n\\sum_{i=1}^{5}\\left(S_{i}-\\mu\\right)^{2} = 0.000256+0.000256+0.001936+0.009216+0.007056 = 0.01872.\n$$\n因此，总体方差和标准差为\n$$\n\\sigma^{2}=\\frac{1}{5}\\cdot 0.01872 = 0.003744, \\qquad \\sigma=\\sqrt{0.003744}.\n$$\n个体 $\\mathrm{A}$ 的标准化评分为\n$$\nZ_{\\mathrm{A}}=\\frac{S_{\\mathrm{A}}-\\mu}{\\sigma}=\\frac{0.016}{\\sqrt{0.003744}}.\n$$\n计算平方根，$\\sqrt{0.003744}\\approx 0.061188234$，所以\n$$\nZ_{\\mathrm{A}}\\approx \\frac{0.016}{0.061188234}\\approx 0.261488.\n$$\n四舍五入到 $4$ 位有效数字，个体 $\\mathrm{A}$ 的标准化评分为 $0.2615$。",
            "answer": "$$\\boxed{0.2615}$$"
        },
        {
            "introduction": "构建PRS的一个关键挑战是连锁不平衡 (Linkage Disequilibrium, LD)，即SNP之间存在相关性。简单地将它们的效应相加会导致遗传信息的重复计算。本练习介绍了一种称为LD剪枝 (LD clumping) 的常用技术，用于筛选出一组相对独立的SNP，为您在构建稳健PRS时提供关键数据修剪步骤的实践经验。",
            "id": "4375562",
            "problem": "在 $1$ 号染色体上的一个基因座区域，考虑七个单核苷酸多态性（SNP），其基因组碱基对位置、全基因组关联研究的 $p$ 值，以及通过相关性平方 $r^{2}$ 测量的成对连锁不平衡（LD）如下所列。使用一种聚类（clumping）程序，每个 SNP 周围的对称基因组窗口为 $\\pm 120{,}000$ 个碱基对（包含边界），LD 阈值为 $r^{2} \\geq 0.20$。聚类过程如下：首先按 $p$ 值升序排列 SNP，然后迭代选择下一个未被修剪的 SNP 作为索引 SNP，接着修剪掉那些位于该索引 SNP 指定窗口内且与该索引 SNP 的 $r^{2}$ 大于或等于 LD 阈值的任何其他 SNP。一旦一个 SNP 被修剪，它就不能在之后被选中。索引 SNP 永远不会被之后更不显著的 SNP 修剪。所列出的所有 SNP 都是符合条件的；除了用于聚类排序外，没有其他的 $p$ 值排除标准。\n\nSNP 和数据：\n- rsA 位于位置 $10{,}050{,}000$，其 $p=3.0 \\times 10^{-6}$，效应量（每个效应等位基因）$\\beta=0.10$。\n- rsB 位于位置 $10{,}115{,}000$，其 $p=1.5 \\times 10^{-7}$，$\\beta=0.14$。\n- rsC 位于位置 $10{,}170{,}000$，其 $p=2.0 \\times 10^{-4}$，$\\beta=-0.06$。\n- rsD 位于位置 $10{,}240{,}000$，其 $p=4.0 \\times 10^{-6}$，$\\beta=0.09$。\n- rsE 位于位置 $10{,}300{,}000$，其 $p=6.0 \\times 10^{-3}$，$\\beta=0.04$。\n- rsF 位于位置 $10{,}380{,}000$，其 $p=9.0 \\times 10^{-8}$，$\\beta=0.12$。\n- rsG 位于位置 $10{,}500{,}000$，其 $p=1.5 \\times 10^{-2}$，$\\beta=-0.05$。\n\n相互之间距离在 $\\pm 120{,}000$ 个碱基对以内的 SNP 对的非零成对 $r^{2}$ 值如下：\n- $r^{2}(\\mathrm{rsA},\\mathrm{rsB})=0.80$, $r^{2}(\\mathrm{rsA},\\mathrm{rsC})=0.18$。\n- $r^{2}(\\mathrm{rsB},\\mathrm{rsC})=0.15$。\n- $r^{2}(\\mathrm{rsC},\\mathrm{rsD})=0.22$。\n- $r^{2}(\\mathrm{rsD},\\mathrm{rsE})=0.05$。\n- $r^{2}(\\mathrm{rsE},\\mathrm{rsF})=0.35$。\n- $r^{2}(\\mathrm{rsF},\\mathrm{rsG})=0.05$。\n\n对于上面未列出的任何 SNP 对，要么其基因组距离超过 $\\pm 120{,}000$ 个碱基对（因此在该对的聚类窗口之外），要么其 $r^{2}$ 值实际上可以忽略不计（小于 $0.01$）因而低于阈值。\n\n某个个体的基因型如下，编码为每个 SNP 的 GWAS 效应等位基因计数：rsA $=2$，rsB $=1$，rsC $=0$，rsD $=1$，rsE $=2$，rsF $=0$，rsG $=2$。假设用于编码基因型的效应等位基因与报告 GWAS 效应量 $\\beta$ 所用的效应等位基因相匹配。\n\n从以上信息和系统生物医学中的常用定义出发，首先确定在所述窗口和阈值下经过 LD 聚类后保留的 SNP 集合。然后，仅使用保留的 SNP，通过对保留的变异进行加权求和，构建该个体的多基因风险评分（PRS），权重由相应的 $\\beta$ 和加性基因型编码给出。将最终的 PRS 报告为单个实数。将您的答案四舍五入到四位有效数字。PRS 是无量纲的；表示时无需任何单位。",
            "solution": "解决方案涉及两个连续的步骤：首先，执行 LD 聚类以确定一组独立的 SNP；其次，仅使用这组保留的 SNP 计算个体的多基因风险评分（PRS）。\n\n**第 1 部分：LD 聚类**\n\n聚类过程是迭代的，从 $p$ 值最小的 SNP 开始。\n\n首先，我们按 GWAS 的 $p$ 值升序排列所有 SNP：\n$1$. rsF ($p = 9.0 \\times 10^{-8}$)\n$2$. rsB ($p = 1.5 \\times 10^{-7}$)\n$3$. rsA ($p = 3.0 \\times 10^{-6}$)\n$4$. rsD ($p = 4.0 \\times 10^{-6}$)\n$5$. rsC ($p = 2.0 \\times 10^{-4}$)\n$6$. rsE ($p = 6.0 \\times 10^{-3}$)\n$7$. rsG ($p = 1.5 \\times 10^{-2}$)\n\n我们将所有 SNP 的集合初始化为未修剪状态。设此集合为 $S = \\{\\text{rsA, rsB, rsC, rsD, rsE, rsF, rsG}\\}$。我们将遍历排序后的列表，选择索引 SNP 并修剪其他 SNP。\n\n**迭代 1：**\n-   选择排名最高的未修剪 SNP 作为第一个索引 SNP：**rsF**。此 SNP 被保留。\n-   rsF 的位置是 $10{,}380{,}000$。基因组窗口为 $[10{,}380{,}000 - 120{,}000, 10{,}380{,}000 + 120{,}000]$，即 $[10{,}260{,}000, 10{,}500{,}000]$。\n-   我们检查集合 $S$ 中落在此窗口内且与 rsF 的 $r^2$ 大于或等于 $0.20$ 的其他 SNP。\n    -   rsE（位置 $10{,}300{,}000$）：它在窗口内。LD 值为 $r^{2}(\\mathrm{rsE},\\mathrm{rsF})=0.35$。由于 $0.35 \\geq 0.20$，**rsE 被修剪**。\n    -   rsG（位置 $10{,}500{,}000$）：它在窗口内。LD 值为 $r^{2}(\\mathrm{rsF},\\mathrm{rsG})=0.05$。由于 $0.05  0.20$，rsG 在此步骤中不被修剪。\n-   状态：保留：$\\{\\text{rsF}\\}$；修剪：$\\{\\text{rsE}\\}$；未修剪：$\\{\\text{rsA, rsB, rsC, rsD, rsG}\\}$。\n\n**迭代 2：**\n-   选择下一个排名最高的未修剪 SNP 作为索引 SNP：**rsB**。此 SNP 被保留。\n-   rsB 的位置是 $10{,}115{,}000$。窗口为 $[10{,}115{,}000 - 120{,}000, 10{,}115{,}000 + 120{,}000]$，即 $[9{,}995{,}000, 10{,}235{,}000]$。\n-   我们检查当前未修剪的 SNP 中落在此窗口内且与 rsB 具有高 LD 的 SNP。\n    -   rsA（位置 $10{,}050{,}000$）：它在窗口内。LD 值为 $r^{2}(\\mathrm{rsA},\\mathrm{rsB})=0.80$。由于 $0.80 \\geq 0.20$，**rsA 被修剪**。\n    -   rsC（位置 $10{,}170{,}000$）：它在窗口内。LD 值为 $r^{2}(\\mathrm{rsB},\\mathrm{rsC})=0.15$。由于 $0.15  0.20$，rsC 不被修剪。\n-   状态：保留：$\\{\\text{rsF, rsB}\\}$；修剪：$\\{\\text{rsE, rsA}\\}$；未修剪：$\\{\\text{rsC, rsD, rsG}\\}$。\n\n**迭代 3：**\n-   p 值列表中的下一个 SNP 是 rsA，但它已被修剪。我们移至下一个，即 **rsD**。此 SNP 被保留。\n-   rsD 的位置是 $10{,}240{,}000$。窗口为 $[10{,}240{,}000 - 120{,}000, 10{,}240{,}000 + 120{,}000]$，即 $[10{,}120{,}000, 10{,}360{,}000]$。\n-   我们检查此窗口中其他当前未修剪的 SNP。\n    -   rsC（位置 $10{,}170{,}000$）：它在窗口内。LD 值为 $r^{2}(\\mathrm{rsC},\\mathrm{rsD})=0.22$。由于 $0.22 \\geq 0.20$，**rsC 被修剪**。\n-   状态：保留：$\\{\\text{rsF, rsB, rsD}\\}$；修剪：$\\{\\text{rsE, rsA, rsC}\\}$；未修剪：$\\{\\text{rsG}\\}$。\n\n**迭代 4：**\n-   p 值列表中的下一个 SNP 是 rsC 和 rsE，但它们都已被修剪。下一个未修剪的 SNP 是 **rsG**。此 SNP 被保留。\n-   rsG 的位置是 $10{,}500{,}000$。窗口为 $[10{,}380{,}000, 10{,}620{,}000]$。\n-   我们检查此窗口中是否有其他未修剪的 SNP。没有。\n-   状态：保留：$\\{\\text{rsF, rsB, rsD, rsG}\\}$；修剪：$\\{\\text{rsE, rsA, rsC}\\}$；未修剪：$\\emptyset$。\n\n未修剪的 SNP 集合现已为空，因此聚类过程终止。\n最终保留的 SNP 集合是 $\\{\\text{rsB, rsD, rsF, rsG}\\}$。\n\n**第 2 部分：多基因风险评分（PRS）计算**\n\nPRS 是通过对个体在保留 SNP 上的基因型进行加权求和来计算的，其中权重是效应量（$\\beta$）。\n公式为：\n$$ \\text{PRS} = \\sum_{i \\in \\{\\text{retained}\\}} \\beta_i G_i $$\n其中 $G_i$ 是 SNP $i$ 的基因型（效应等位基因的计数）。\n\n保留的 SNP 数据如下：\n-   rsB: $\\beta_B = 0.14$, $G_B=1$\n-   rsD: $\\beta_D = 0.09$, $G_D=1$\n-   rsF: $\\beta_F = 0.12$, $G_F=0$\n-   rsG: $\\beta_G = -0.05$, $G_G=2$\n\n将这些值代入 PRS 公式：\n$$ \\text{PRS} = (\\beta_B \\times G_B) + (\\beta_D \\times G_D) + (\\beta_F \\times G_F) + (\\beta_G \\times G_G) $$\n$$ \\text{PRS} = (0.14 \\times 1) + (0.09 \\times 1) + (0.12 \\times 0) + (-0.05 \\times 2) $$\n$$ \\text{PRS} = 0.14 + 0.09 + 0 - 0.10 $$\n$$ \\text{PRS} = 0.23 - 0.10 $$\n$$ \\text{PRS} = 0.13 $$\n\n问题要求答案四舍五入到四位有效数字。为了将 $0.13$ 表示为四位有效数字，我们将其写为 $0.1300$。",
            "answer": "$$\n\\boxed{0.1300}\n$$"
        },
        {
            "introduction": "PRS的准确性在很大程度上取决于SNP的权重，而这些权重通常来自带有估计误差的全基因组关联研究 (Genome-Wide Association Study, GWAS)。本练习深入探讨了一种更高级的贝叶斯方法来优化这些权重。您将推导并应用一个收缩公式来对SNP的效应大小进行正则化，从而阐明现代PRS方法如何通过校正“赢家诅咒” (winner's curse) 来提高预测准确性。",
            "id": "4375580",
            "problem": "在构建多基因风险评分 (PRS) 时，单核苷酸多态性 (SNP) 的权重通常根据全基因组关联汇总统计数据进行估计，然后向零进行正则化以减少估计噪声。考虑一个单核苷酸多态性 (SNP)，其在连续易感性尺度上的边际效应估计值为 $\\hat{\\beta} = 0.05$，标准误为 $SE = 0.02$。该估计值从一个大样本广义线性模型中获得，其中 $\\hat{\\beta}$ 的渐近抽样分布近似为高斯分布。假设真实的 SNP 效应 $\\beta$ 采用零均值高斯先验进行建模，其方差为 $\\tau^{2} = 0.001$，这反映了效应值较小的先验信念。\n\n从贝叶斯定理和高斯分布在共轭性下的性质出发，并以最大似然估计量的大样本正态性和正态-正态共轭先验-似然系统为基础，推导在以下假设下的后验均值 $\\mathbb{E}[\\beta \\mid \\hat{\\beta}]$：\n- 先验：$\\beta \\sim \\mathcal{N}(0, \\tau^{2})$。\n- 似然：$\\hat{\\beta} \\mid \\beta \\sim \\mathcal{N}(\\beta, SE^{2})$。\n\n然后，使用 $\\hat{\\beta} = 0.05$，$SE = 0.02$ 和 $\\tau^{2} = 0.001$ 对推导出的表达式进行数值计算。将后验均值解释为该 SNP 在 PRS 中使用的收缩权重。报告收缩权重的最终数值。将答案四舍五入至六位有效数字。无需单位。",
            "solution": "本问题要求在贝叶斯框架下，基于正态先验和正态似然模型，推导并计算单核苷酸多态性（SNP）效应大小 $\\beta$ 的后验均值。\n\n首先，我们推导后验均值的通用公式。根据贝叶斯定理，后验概率 $p(\\beta \\mid \\hat{\\beta})$ 正比于似然 $p(\\hat{\\beta} \\mid \\beta)$ 与先验 $p(\\beta)$ 的乘积：\n$$\np(\\beta \\mid \\hat{\\beta}) \\propto p(\\hat{\\beta} \\mid \\beta) p(\\beta)\n$$\n给定的先验和似然分布为：\n- 先验：$\\beta \\sim \\mathcal{N}(0, \\tau^{2})$\n- 似然：$\\hat{\\beta} \\mid \\beta \\sim \\mathcal{N}(\\beta, SE^{2})$\n\n它们的概率密度函数（忽略常数项）为：\n$$\np(\\beta) \\propto \\exp\\left(-\\frac{\\beta^2}{2\\tau^2}\\right) \\quad \\text{和} \\quad p(\\hat{\\beta} \\mid \\beta) \\propto \\exp\\left(-\\frac{(\\hat{\\beta} - \\beta)^2}{2SE^2}\\right)\n$$\n后验分布的对数与以下表达式成正比：\n$$\n\\log p(\\beta \\mid \\hat{\\beta}) \\propto -\\frac{1}{2}\\left( \\frac{(\\hat{\\beta} - \\beta)^2}{SE^2} + \\frac{\\beta^2}{\\tau^2} \\right)\n$$\n展开并对 $\\beta$ 进行配方法，可以证明后验分布也是一个正态分布 $\\mathcal{N}(\\mu_{\\text{post}}, \\sigma_{\\text{post}}^2)$。其均值 $\\mu_{\\text{post}}$ 是先验均值（0）和观测数据（$\\hat{\\beta}$）的加权平均，权重由各自的精度（方差的倒数）决定：\n$$\n\\mu_{\\text{post}} = \\mathbb{E}[\\beta \\mid \\hat{\\beta}] = \\frac{\\frac{1}{SE^2}}{\\frac{1}{SE^2} + \\frac{1}{\\tau^2}}\\hat{\\beta} + \\frac{\\frac{1}{\\tau^2}}{\\frac{1}{SE^2} + \\frac{1}{\\tau^2}} \\cdot 0 = \\frac{\\tau^2}{SE^2 + \\tau^2}\\hat{\\beta}\n$$\n这个后验均值就是我们所求的收缩权重。\n\n接下来，我们将给定的数值代入此公式：\n- 观测效应值: $\\hat{\\beta} = 0.05$\n- 标准误: $SE = 0.02 \\implies SE^2 = (0.02)^2 = 0.0004$\n- 先验方差: $\\tau^2 = 0.001$\n\n计算收缩权重：\n$$\n\\mathbb{E}[\\beta \\mid \\hat{\\beta}] = \\left(\\frac{0.001}{0.0004 + 0.001}\\right) \\times 0.05\n$$\n$$\n\\mathbb{E}[\\beta \\mid \\hat{\\beta}] = \\left(\\frac{0.001}{0.0014}\\right) \\times 0.05 = \\frac{1}{1.4} \\times 0.05\n$$\n$$\n\\mathbb{E}[\\beta \\mid \\hat{\\beta}] = \\frac{5}{7} \\times 0.05 = \\frac{0.25}{7} \\approx 0.0357142857...\n$$\n问题要求将答案四舍五入至六位有效数字。第七位有效数字是 8 ($\\ge 5$)，因此我们将第六位有效数字 2 向上取整。\n最终的收缩权重为 $0.0357143$。",
            "answer": "$$\n\\boxed{0.0357143}\n$$"
        }
    ]
}