{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的生物系统模型时，一个核心挑战是确定模型参数。与其完全依赖实验数据拟合，我们可以利用基本的物理原理来设定参数的边界。本练习将探讨扩散过程如何为酶的催化效率设定一个绝对的物理上限，这个上限被称为斯莫卢霍夫斯基极限 (Smoluchowski limit)。通过计算这个极限，我们可以为任何包含酶促反应的系统模型获得一个强有力的、无需拟合的约束条件，从而确保模型的物理真实性。",
            "id": "4356792",
            "problem": "在一个胞质酶促反应的系统生物医学模型中，您希望利用生物物理极限来约束催化效率。考虑在生理温度下，人体胞质中的一种酶 $E$ 和一种小分子底物 $S$。该酶和底物分别以扩散系数 $D_E$ 和 $D_S$ 进行布朗运动，并在考虑了空间和取向限制的有效捕获半径 $R$ 内接触时发生反应。Smoluchowski 扩散限制结合框架给出了双分子结合速率 $k_{\\text{on}}$ 的一个上界，即 $k_{\\text{on}} \\leq 4\\pi D R$，其中 $D$ 是相对扩散系数，定义为 $D = D_E + D_S$。对于相遇复合物形成后的不可逆快速转化，米氏-门顿 (MM) 催化效率 $k_{\\text{cat}}/K_M$ 不能超过扩散限制的结合速率。\n\n给定条件如下：\n- $D_E = 7\\ \\mu\\mathrm{m}^2\\mathrm{/s}$，\n- $D_S = 140\\ \\mu\\mathrm{m}^2\\mathrm{/s}$，\n- $R = 2.4\\ \\mathrm{nm}$，\n- 阿伏伽德罗常数 $N_A = 6.022\\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n\n从基本扩散原理和 Smoluchowski 界限 $k_{\\text{on}} \\leq 4\\pi D R$ 出发，计算米氏-门顿催化效率 $k_{\\text{cat}}/K_M$ 的下界和上界。使用 $D = D_E + D_S$，并通过适当使用 $N_A$ 以及 $\\mathrm{m^3}$ 到 $\\mathrm{L}$ 的转换，将上界单位从 $\\mathrm{m^3\\,s^{-1}}$ 转换为 $\\mathrm{M^{-1}\\,s^{-1}}$。以一个二元行矩阵的形式提供您的界限，其中下界在前，单位为 $\\mathrm{M^{-1}\\,s^{-1}}$，并将上界四舍五入到 $3$ 位有效数字。\n\n最后，根据您计算出的上界，解释在此背景下近扩散控制的生物化学机制：说明系统级参数 $k_{\\text{cat}}/K_M$ 处于扩散限制上界的一个小因子范围内意味着什么，以及这将如何用于约束网络规模模型。",
            "solution": "其物理基础是反应物的扩散输运和在有效捕获半径处的吸收边界条件。对于两个扩散系数为 $D_E$ 和 $D_S$ 的粒子，其相对运动是扩散性的，有效系数为 $D = D_E + D_S$。在 Smoluchowski 框架中，流向半径为 $R$ 的吸收球体的稳态扩散通量为\n$$\nJ = 4\\pi D R\\,c_{\\infty},\n$$\n其中 $c_{\\infty}$ 是以 $\\mathrm{m^{-3}}$ 为单位的体相数浓度。将比例因子等同于数密度单位下的二级速率常数，可得到扩散限制的双分子速率常数\n$$\nk_{\\text{on}}^{\\max} = 4\\pi D R \\quad \\text{单位为}\\ \\mathrm{m^3\\,s^{-1}}。\n$$\n为了以摩尔单位 $\\mathrm{M^{-1}\\,s^{-1}}$ 表示 $k_{\\text{on}}^{\\max}$，注意到 $1\\ \\mathrm{mol/L} = N_A \\times 10^{3}\\ \\mathrm{m^{-3}}$。如果 $k_{\\#}$ 是数密度单位下的速率常数，而 $k_{\\mathrm{M}}$ 是摩尔单位下的速率常数，则令两种单位体系中的反应速率相等可得\n$$\nk_{\\mathrm{M}} = k_{\\#}\\,N_A\\,10^{3}.\n$$\n因此，\n$$\nk_{\\text{on}}^{\\max}(\\mathrm{M^{-1}\\,s^{-1}}) = \\left(4\\pi D R\\right)\\,N_A\\,10^{3}.\n$$\n\n在米氏-门顿 (MM) 动力学下，当底物浓度较低时，初始速率满足 $v \\approx (k_{\\text{cat}}/K_M)\\,[E]\\,[S]$，从而将 $k_{\\text{cat}}/K_M$ 视为从游离的 $E$ 和 $S$ 到产物形成的整个过程的有效二级速率常数。因为扩散到达为任何必须以分子相遇开始的途径设定了上界，所以有\n$$\n0 \\leq \\frac{k_{\\text{cat}}}{K_M} \\leq k_{\\text{on}}^{\\max}.\n$$\n\n我们现在计算数值上界。首先，确定国际单位制 (SI) 中的相对扩散系数 $D$ 和捕获半径 $R$：\n$$\nD = D_E + D_S = 7\\ \\mu\\mathrm{m}^2\\mathrm{/s} + 140\\ \\mu\\mathrm{m}^2\\mathrm{/s} = 147\\ \\mu\\mathrm{m}^2\\mathrm{/s}.\n$$\n使用 $1\\ \\mu\\mathrm{m}^2 = 10^{-12}\\ \\mathrm{m}^2$ 转换为 $\\mathrm{m^2\\,s^{-1}}$：\n$$\nD = 147 \\times 10^{-12}\\ \\mathrm{m^2\\,s^{-1}} = 1.47\\times 10^{-10}\\ \\mathrm{m^2\\,s^{-1}}.\n$$\n同样，使用 $1\\ \\mathrm{nm} = 10^{-9}\\ \\mathrm{m}$ 转换 $R = 2.4\\ \\mathrm{nm}$：\n$$\nR = 2.4 \\times 10^{-9}\\ \\mathrm{m}.\n$$\n计算 Smoluchowski 上界，单位为 $\\mathrm{m^3\\,s^{-1}}$：\n$$\nk_{\\text{on}}^{\\max} = 4\\pi D R = 4\\pi \\times \\left(1.47\\times 10^{-10}\\right)\\times \\left(2.4\\times 10^{-9}\\right)\\ \\mathrm{m^3\\,s^{-1}}.\n$$\n内部的乘积是\n$$\n1.47\\times 10^{-10} \\times 2.4\\times 10^{-9} = 3.528\\times 10^{-19},\n$$\n所以\n$$\nk_{\\text{on}}^{\\max} = 4\\pi \\times 3.528\\times 10^{-19}\\ \\mathrm{m^3\\,s^{-1}} = 4.4327\\times 10^{-18}\\ \\mathrm{m^3\\,s^{-1}},\n$$\n其中 $4\\pi \\approx 12.566$ 且 $12.566 \\times 3.528 \\approx 44.327$，得到 $44.327\\times 10^{-19} = 4.4327\\times 10^{-18}$。\n\n转换为 $\\mathrm{M^{-1}\\,s^{-1}}$：\n$$\nk_{\\text{on}}^{\\max}(\\mathrm{M^{-1}\\,s^{-1}}) = \\left(4.4327\\times 10^{-18}\\right)\\times \\left(6.022\\times 10^{23}\\right)\\times 10^{3} = 2.66937\\times 10^{9}\\ \\mathrm{M^{-1}\\,s^{-1}}.\n$$\n四舍五入到 $3$ 位有效数字，得到\n$$\nk_{\\text{on}}^{\\max} \\approx 2.67\\times 10^{9}\\ \\mathrm{M^{-1}\\,s^{-1}}.\n$$\n因此，催化效率的界限为\n$$\n0 \\leq \\frac{k_{\\text{cat}}}{K_M} \\leq 2.67\\times 10^{9}\\ \\mathrm{M^{-1}\\,s^{-1}}.\n$$\n\n关于近扩散控制的解释：如果对于给定的酶-底物对，实验测得的 $\\frac{k_{\\text{cat}}}{K_M}$ 在计算出的 $k_{\\text{on}}^{\\max}$ 的一个小因子范围内（例如，当界限为 $2.67\\times 10^{9}\\ \\mathrm{M^{-1}\\,s^{-1}}$ 时，$\\frac{k_{\\text{cat}}}{K_M} \\gtrsim 10^{9}\\ \\mathrm{M^{-1}\\,s^{-1}}$），则该反应在近扩散控制机制下运行。在这种机制下，总催化效率主要受限于 $E$ 和 $S$ 相互找到的速度，与输运限制相比，化学步骤带来的任何额外增益都是微不足道的。对于系统模型，这个生物物理天花板为参数估计和正则化提供了一个有原则的上界；将 $\\frac{k_{\\text{cat}}}{K_M}$ 拟合到高于扩散极限的值在物理上是不合理的，而接近该界限的值表明存在输运限制的控制，这可以简化灵敏度分析（例如，改变 $D$ 或 $R$ 的扰动——如分子拥挤或复合物形成——将强烈影响通量）。",
            "answer": "$$\\boxed{\\begin{pmatrix}0  2.67 \\times 10^{9}\\end{pmatrix}}$$"
        },
        {
            "introduction": "生物系统的一个显著特征是其能够对信号产生开关般的响应，这种现象通常源于分子间的协同相互作用。本练习将从单个基因调控模块的层面，探讨协同结合（一种关键的生物物理机制）如何影响基因表达的剂量反应曲线的陡峭程度。此外，我们还将量化这种协同性如何调节基因表达固有的随机性或“噪声”，揭示确定性响应（陡峭性）与随机波动（噪声）之间的内在联系。",
            "id": "4356791",
            "problem": "您需要将生物物理结合整合到基因调控的系统模型中，并定量评估剂量-反应陡峭度和随机噪声。考虑一个在OFF状态和ON状态之间切换的启动子。转录激活剂的结合是协同的，其Hill系数为$n$，启动子激活速率取决于结合分数。\n\n基本原理：\n- 平衡状态下的协同结合产生配体浓度为$c$、解离常数为$K$的Hill占有率函数：$f(c) = \\dfrac{c^n}{K^n + c^n}$。\n- 启动子遵循一个双态连续时间马尔可夫链，其$\\text{OFF} \\to \\text{ON}$速率为$k_{\\mathrm{on}}(c)$，$\\text{ON} \\to \\text{OFF}$速率为$k_{\\mathrm{off}}$。当启动子处于ON状态时，信使核糖核酸（mRNA）以速率$r$产生，并以速率$\\gamma$降解。\n\n模型设定：\n- 激活速率为$k_{\\mathrm{on}}(c) = k_{a,\\max}\\, f(c)$，其中$k_{a,\\max}$是在配体饱和时的最大激活速率。\n- ON状态分数为$p_{\\mathrm{on}}(c) = \\dfrac{k_{\\mathrm{on}}(c)}{k_{\\mathrm{on}}(c) + k_{\\mathrm{off}}}$。\n- 待分析的剂量-反应函数是归一化平均输出$R(c) = \\dfrac{\\mathbb{E}[m(c)]}{\\mathbb{E}[m(\\infty)]}$，其中$\\mathbb{E}[m(c)]$是稳态平均mRNA数量。\n- 稳态噪声使用法诺因子$F(c) = \\dfrac{\\mathrm{Var}[m(c)]}{\\mathbb{E}[m(c)]}$来量化，其中$\\mathrm{Var}[m(c)]$是mRNA数量的稳态方差。\n\n您的任务：\n1. 从上述基本原理出发，推导以下公式：\n   - 所述双态启动子模型中mRNA数量的稳态平均值$\\mathbb{E}[m(c)]$和方差$\\mathrm{Var}[m(c)]$，以及相应的法诺因子$F(c)$。\n   - 归一化剂量-反应的陡峭度，定义为在$R(c)$等于其最大值一半的浓度处评估的$R(c)$的对数斜率。具体来说，计算$S_{\\log} = \\left.\\dfrac{\\mathrm{d}R(c)}{\\mathrm{d}\\log c}\\right|_{R(c) = 1/2}$。\n2. 实现一个程序，对于下面测试套件中的每一组参数，计算：\n   - 如上定义的剂量-反应陡峭度$S_{\\log}$。\n   - 相对于非协同基线$n=1$时，在三个浓度点上的法诺因子变化$\\Delta F(c)$：$\\Delta F(c) = F_{n}(c) - F_{n=1}(c)$，在$c_{\\mathrm{low}} = 0.1 K$、$c_{\\mathrm{mid}} = K$和$c_{\\mathrm{high}} = 10 K$处进行评估。\n\n物理单位：\n- 浓度$c$和$K$的单位是纳摩尔（nM）。\n- 所有速率$k_{a,\\max}$、$k_{\\mathrm{off}}$、$r$和$\\gamma$的单位是$\\mathrm{s}^{-1}$。\n- 陡峭度$S_{\\log}$和法诺因子变化$\\Delta F$是无量纲数，必须以小数形式报告。\n\n测试套件：\n对于每种情况，参数均以上述指定单位给出，形式为$(K, k_{a,\\max}, k_{\\mathrm{off}}, r, \\gamma, n)$。\n\n- 情况1（理想路径）：$(50, 0.2, 0.1, 0.05, 0.003, 2)$。\n- 情况2（高协同性）：$(50, 0.2, 0.05, 0.05, 0.003, 4)$。\n- 情况3（快速降解）：$(10, 0.4, 0.4, 0.1, 0.05, 3)$。\n- 情况4（慢速切换）：$(100, 0.02, 0.02, 0.2, 0.002, 2)$。\n\n算法要求：\n- 使用Hill函数表示$f(c)$，并相应地定义$k_{\\mathrm{on}}(c)$。\n- 使用双态启动子模型计算在指定浓度下的$\\mathbb{E}[m(c)]$、$\\mathrm{Var}[m(c)]$和$F(c)$。\n- 定义$R(c) = \\dfrac{\\mathbb{E}[m(c)]}{\\mathbb{E}[m(\\infty)]}$，确定$R(c_{1/2}) = \\dfrac{1}{2}$时的浓度$c_{1/2}$，然后计算$c_{1/2}$处的$S_{\\log}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例贡献一个内部列表，顺序为$[S_{\\log}, \\Delta F(c_{\\mathrm{low}}), \\Delta F(c_{\\mathrm{mid}}), \\Delta F(c_{\\mathrm{high}})]$，每个值四舍五入到六位小数。例如：$[[s_1,\\delta_1,\\delta_2,\\delta_3],[s_2,\\delta_4,\\delta_5,\\delta_6],...]$。\n\n不允许用户输入。程序必须是自包含且可运行的。所有计算必须遵守指定的单位，所有结果必须以小数表示（而不是百分比）。",
            "solution": "用户提供了一个来自系统生物医学领域的问题，要求推导和计算基因表达双态模型的剂量-反应和噪声特征。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n- **协同结合：** 配体浓度为$c$、解离常数为$K$、Hill系数为$n$的Hill占有率函数$f(c) = \\dfrac{c^n}{K^n + c^n}$。\n- **启动子模型：** 具有$\\text{OFF}$和$\\text{ON}$状态的双态连续时间马尔可夫链。\n- **转换速率：** $\\text{OFF} \\to \\text{ON}$速率为$k_{\\mathrm{on}}(c)$，$\\text{ON} \\to \\text{OFF}$速率为$k_{\\mathrm{off}}$。\n- **mRNA动态：** 生产速率为$r$（当处于$\\text{ON}$状态时），降解速率为$\\gamma$。\n- **模型设定：**\n    - 激活速率：$k_{\\mathrm{on}}(c) = k_{a,\\max}\\, f(c)$。\n    - ON状态分数：$p_{\\mathrm{on}}(c) = \\dfrac{k_{\\mathrm{on}}(c)}{k_{\\mathrm{on}}(c) + k_{\\mathrm{off}}}$。\n    - 归一化剂量-反应：$R(c) = \\dfrac{\\mathbb{E}[m(c)]}{\\mathbb{E}[m(\\infty)]}$，其中$\\mathbb{E}[m(c)]$是稳态平均mRNA数量。\n    - 稳态噪声：法诺因子$F(c) = \\dfrac{\\mathrm{Var}[m(c)]}{\\mathbb{E}[m(c)]}$，其中$\\mathrm{Var}[m(c)]$是mRNA数量的稳态方差。\n- **任务：**\n    1.  推导$\\mathbb{E}[m(c)]$、$\\mathrm{Var}[m(c)]$、$F(c)$以及剂量-反应陡峭度$S_{\\log} = \\left.\\dfrac{\\mathrm{d}R(c)}{\\mathrm{d}\\log c}\\right|_{R(c) = 1/2}$的公式。\n    2.  实现一个程序，为给定的参数集计算$S_{\\log}$以及在$c \\in \\{0.1K, K, 10K\\}$处的法诺因子变化$\\Delta F(c) = F_{n}(c) - F_{n=1}(c)$。\n- **单位：** 浓度（$c, K$）单位为nM；速率（$k_{a,\\max}, k_{\\mathrm{off}}, r, \\gamma$）单位为$\\mathrm{s}^{-1}$。$S_{\\log}$和$\\Delta F$是无量纲的。\n- **测试套件：**\n    - 情况1：$(K, k_{a,\\max}, k_{\\mathrm{off}}, r, \\gamma, n) = (50, 0.2, 0.1, 0.05, 0.003, 2)$。\n    - 情况2：$(50, 0.2, 0.05, 0.05, 0.003, 4)$。\n    - 情况3：$(10, 0.4, 0.4, 0.1, 0.05, 3)$。\n    - 情况4：$(100, 0.02, 0.02, 0.2, 0.002, 2)$。\n\n**第2步：使用提取的已知条件进行验证**\n\n- **科学依据：** 该问题使用了基因表达的双态模型，这是随机基因调控理论的基石。Hill函数是协同结合的标准生物物理模型。所有概念在生物物理学和系统生物学中都已牢固建立。\n- **良态问题：** 该问题提供了所有必要的定义、参数和关系，以推导所要求的量并执行计算。任务具体，能得出唯一且有意义的解。\n- **客观性：** 该问题使用精确的数学和科学语言陈述。它不含主观论断。\n- **一致性与完整性：** 定义内部一致。所提供的参数足够，单位一致。不存在矛盾或模糊之处。\n\n**第3步：结论与行动**\n\n该问题是有效的。它具有科学合理性、良态性、客观性和完整性。我将继续进行求解。\n\n### 第1部分：推导\n\n**A. mRNA数量的平均值、方差和法诺因子**\n\n该系统描述了一个在$\\text{ON}$和$\\text{OFF}$状态之间切换的启动子，mRNA仅在$\\text{ON}$状态下产生。这是基因表达的经典电报模型。\n\n启动子处于$\\text{ON}$状态的稳态概率由下式给出：\n$$\np_{\\mathrm{on}}(c) = \\frac{k_{\\mathrm{on}}(c)}{k_{\\mathrm{on}}(c) + k_{\\mathrm{off}}}\n$$\n处于$\\text{OFF}$状态的概率为 $p_{\\mathrm{off}}(c) = 1 - p_{\\mathrm{on}}(c) = \\dfrac{k_{\\mathrm{off}}}{k_{\\mathrm{on}}(c) + k_{\\mathrm{off}}}$。\n\n平均mRNA产生速率是在$\\text{ON}$状态下的产生速率$r$乘以处于$\\text{ON}$状态的概率$p_{\\mathrm{on}}(c)$。平均mRNA数量$\\mathbb{E}[m]$的动态由下式描述：\n$$\n\\frac{\\mathrm{d}\\mathbb{E}[m]}{\\mathrm{d}t} = r \\cdot p_{\\mathrm{on}}(c) - \\gamma \\mathbb{E}[m]\n$$\n在稳态下，$\\frac{\\mathrm{d}\\mathbb{E}[m]}{\\mathrm{d}t} = 0$，由此可得稳态平均mRNA数量：\n$$\n\\mathbb{E}[m(c)] = \\frac{r}{\\gamma} p_{\\mathrm{on}}(c) = \\frac{r}{\\gamma} \\frac{k_{\\mathrm{on}}(c)}{k_{\\mathrm{on}}(c) + k_{\\mathrm{off}}}\n$$\n\n对于此双态模型，mRNA数量的稳态方差是随机理论的一个标准结果：\n$$\n\\mathrm{Var}[m(c)] = \\mathbb{E}[m(c)] \\left( 1 + \\frac{r}{\\gamma} \\frac{\\gamma p_{\\mathrm{off}}(c)}{k_{\\mathrm{on}}(c) + k_{\\mathrm{off}} + \\gamma} \\right)\n$$\n代入$\\mathbb{E}[m(c)]$和$p_{\\mathrm{off}}(c)$：\n$$\n\\mathrm{Var}[m(c)] = \\frac{r}{\\gamma} \\frac{k_{\\mathrm{on}}(c)}{k_{\\mathrm{on}}(c) + k_{\\mathrm{off}}} + \\left(\\frac{r}{\\gamma}\\right)^2 \\frac{k_{\\mathrm{on}}(c) k_{\\mathrm{off}}}{(k_{\\mathrm{on}}(c) + k_{\\mathrm{off}})^2} \\frac{\\gamma}{k_{\\mathrm{on}}(c) + k_{\\mathrm{off}} + \\gamma}\n$$\n第一项代表内在泊松噪声，第二项代表来自启动子切换的外在噪声。\n\n法诺因子$F(c)$是方差与均值之比：\n$$\nF(c) = \\frac{\\mathrm{Var}[m(c)]}{\\mathbb{E}[m(c)]} = 1 + \\frac{r p_{\\mathrm{off}}(c)}{k_{\\mathrm{on}}(c) + k_{\\mathrm{off}} + \\gamma}\n$$\n代入$p_{\\mathrm{off}}(c) = \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{on}}(c) + k_{\\mathrm{off}}}$，得到用于实现的最终表达式：\n$$\nF(c) = 1 + \\frac{r k_{\\mathrm{off}}}{(k_{\\mathrm{on}}(c) + k_{\\mathrm{off}}) (k_{\\mathrm{on}}(c) + k_{\\mathrm{off}} + \\gamma)}\n$$\n其中 $k_{\\mathrm{on}}(c) = k_{a,\\max} f(c) = k_{a,\\max} \\dfrac{c^n}{K^n + c^n}$。\n\n**B. 剂量-反应陡峭度**\n\n归一化剂量-反应为$R(c) = \\dfrac{\\mathbb{E}[m(c)]}{\\mathbb{E}[m(\\infty)]}$。\n首先，我们计算各个组成部分：\n$$\n\\mathbb{E}[m(c)] = \\frac{r}{\\gamma} \\frac{k_{\\mathrm{on}}(c)}{k_{\\mathrm{on}}(c) + k_{\\mathrm{off}}}\n$$\n当$c \\to \\infty$时，Hill函数$f(c) \\to 1$，因此$k_{\\mathrm{on}}(c) \\to k_{a,\\max}$。\n$$\n\\mathbb{E}[m(\\infty)] = \\frac{r}{\\gamma} \\frac{k_{a,\\max}}{k_{a,\\max} + k_{\\mathrm{off}}}\n$$\n因此，归一化反应为：\n$$\nR(c) = \\frac{\\frac{r}{\\gamma} \\frac{k_{\\mathrm{on}}(c)}{k_{\\mathrm{on}}(c) + k_{\\mathrm{off}}}}{\\frac{r}{\\gamma} \\frac{k_{a,\\max}}{k_{a,\\max} + k_{\\mathrm{off}}}} = \\frac{k_{\\mathrm{on}}(c)}{k_{a,\\max}} \\frac{k_{a,\\max} + k_{\\mathrm{off}}}{k_{\\mathrm{on}}(c) + k_{\\mathrm{off}}}\n$$\n代入$k_{\\mathrm{on}}(c) = k_{a,\\max} f(c)$：\n$$\nR(c) = \\frac{k_{a,\\max} f(c)}{k_{a,\\max}} \\frac{k_{a,\\max} + k_{\\mathrm{off}}}{k_{a,\\max} f(c) + k_{\\mathrm{off}}} = f(c) \\frac{k_{a,\\max} + k_{\\mathrm{off}}}{k_{a,\\max} f(c) + k_{\\mathrm{off}}}\n$$\n我们需要找到$R(c_{1/2}) = 1/2$时的浓度$c_{1/2}$。令$f_{1/2} = f(c_{1/2})$。\n$$\n\\frac{1}{2} = f_{1/2} \\frac{k_{a,\\max} + k_{\\mathrm{off}}}{k_{a,\\max} f_{1/2} + k_{\\mathrm{off}}}\n$$\n$$\nk_{a,\\max} f_{1/2} + k_{\\mathrm{off}} = 2 f_{1/2} (k_{a,\\max} + k_{\\mathrm{off}}) = 2 f_{1/2} k_{a,\\max} + 2 f_{1/2} k_{\\mathrm{off}}\n$$\n求解$f_{1/2}$：\n$$\nk_{\\mathrm{off}} = f_{1/2} k_{a,\\max} + 2 f_{1/2} k_{\\mathrm{off}} = f_{1/2}(k_{a,\\max} + 2k_{\\mathrm{off}})\n$$\n$$\nf_{1/2} = \\frac{k_{\\mathrm{off}}}{k_{a,\\max} + 2k_{\\mathrm{off}}}\n$$\n陡峭度为$S_{\\log} = \\left.\\dfrac{\\mathrm{d}R(c)}{\\mathrm{d}\\ln c}\\right|_{c=c_{1/2}}$。我们使用链式法则：$S_{\\log} = \\dfrac{\\mathrm{d}R}{\\mathrm{d}f} \\dfrac{\\mathrm{d}f}{\\mathrm{d}\\ln c}$。\n\n首先，我们求$\\dfrac{\\mathrm{d}f}{\\mathrm{d}\\ln c}$：\n$$\nf(c) = \\frac{c^n}{K^n+c^n} \\implies \\frac{\\mathrm{d}f}{\\mathrm{d}c} = \\frac{n c^{n-1}(K^n+c^n) - c^n(n c^{n-1})}{(K^n+c^n)^2} = \\frac{n c^{n-1} K^n}{(K^n+c^n)^2}\n$$\n$$\n\\frac{\\mathrm{d}f}{\\mathrm{d}\\ln c} = c \\frac{\\mathrm{d}f}{\\mathrm{d}c} = c \\frac{n c^{n-1} K^n}{(K^n+c^n)^2} = \\frac{n c^n K^n}{(K^n+c^n)^2} = n \\frac{c^n}{K^n+c^n} \\frac{K^n}{K^n+c^n} = n f(c)(1-f(c))\n$$\n接下来，我们求$\\dfrac{\\mathrm{d}R}{\\mathrm{d}f}$：\n$$\nR(f) = (k_{a,\\max} + k_{\\mathrm{off}}) \\frac{f}{k_{a,\\max} f + k_{\\mathrm{off}}}\n$$\n$$\n\\frac{\\mathrm{d}R}{\\mathrm{d}f} = (k_{a,\\max} + k_{\\mathrm{off}}) \\frac{1(k_{a,\\max} f + k_{\\mathrm{off}}) - f(k_{a,\\max})}{(k_{a,\\max} f + k_{\\mathrm{off}})^2} = \\frac{(k_{a,\\max} + k_{\\mathrm{off}})k_{\\mathrm{off}}}{(k_{a,\\max} f + k_{\\mathrm{off}})^2}\n$$\n将这些结合起来，任意点的陡峭度为：\n$$\nS_{\\log}(c) = \\frac{(k_{a,\\max} + k_{\\mathrm{off}})k_{\\mathrm{off}}}{(k_{a,\\max} f(c) + k_{\\mathrm{off}})^2} \\cdot n f(c)(1-f(c))\n$$\n我们在$c_{1/2}$处评估此式，此时$f = f_{1/2} = \\frac{k_{\\mathrm{off}}}{k_{a,\\max} + 2k_{\\mathrm{off}}}$。\n分母项为：\n$$\n(k_{a,\\max} f_{1/2} + k_{\\mathrm{off}})^2 = \\left( k_{a,\\max} \\frac{k_{\\mathrm{off}}}{k_{a,\\max} + 2k_{\\mathrm{off}}} + k_{\\mathrm{off}} \\right)^2 = \\left( \\frac{k_{a,\\max}k_{\\mathrm{off}} + k_{\\mathrm{off}}(k_{a,\\max} + 2k_{\\mathrm{off}})}{k_{a,\\max} + 2k_{\\mathrm{off}}} \\right)^2 = \\left( \\frac{2k_{\\mathrm{off}}(k_{a,\\max} + k_{\\mathrm{off}})}{k_{a,\\max} + 2k_{\\mathrm{off}}} \\right)^2\n$$\n$f(1-f)$项为：\n$$\nf_{1/2}(1-f_{1/2}) = \\frac{k_{\\mathrm{off}}}{k_{a,\\max} + 2k_{\\mathrm{off}}} \\left( 1 - \\frac{k_{\\mathrm{off}}}{k_{a,\\max} + 2k_{\\mathrm{off}}} \\right) = \\frac{k_{\\mathrm{off}}}{k_{a,\\max} + 2k_{\\mathrm{off}}} \\frac{k_{a,\\max} + k_{\\mathrm{off}}}{k_{a,\\max} + 2k_{\\mathrm{off}}}\n$$\n将这些代入$S_{\\log}$的表达式中：\n$$\nS_{\\log} = n (k_{a,\\max} + k_{\\mathrm{off}})k_{\\mathrm{off}} \\frac{\\frac{k_{\\mathrm{off}}(k_{a,\\max} + k_{\\mathrm{off}})}{(k_{a,\\max} + 2k_{\\mathrm{off}})^2}}{\\left( \\frac{2k_{\\mathrm{off}}(k_{a,\\max} + k_{\\mathrm{off}})}{k_{a,\\max} + 2k_{\\mathrm{off}}} \\right)^2}\n$$\n$$\nS_{\\log} = n \\frac{(k_{a,\\max} + k_{\\mathrm{off}})^2 k_{\\mathrm{off}}^2}{4k_{\\mathrm{off}}^2(k_{a,\\max} + k_{\\mathrm{off}})^2} = \\frac{n}{4}\n$$\n在半最大归一化反应处的陡峭度就是Hill系数的四分之一。\n\n### 第2部分：实施计划\n\n程序将遍历每个测试用例。对于每个用例：\n1.  计算$S_{\\log} = n/4$。\n2.  定义一个函数`calculate_fano(c, K, ka_max, k_off, r, gamma, n)`，该函数实现所推导的$F(c)$公式。\n3.  计算三个浓度$c_{\\mathrm{low}} = 0.1K$、$c_{\\mathrm{mid}} = K$和$c_{\\mathrm{high}} = 10K$。\n4.  对于每个浓度，使用给定的$n$计算$F_{n}(c)$，并使用$n=1$计算$F_{n=1}(c)$。计算差值$\\Delta F(c) = F_{n}(c) - F_{n=1}(c)$。\n5.  存储当前用例的结果$[S_{\\log}, \\Delta F(c_{\\mathrm{low}}), \\Delta F(c_{\\mathrm{mid}}), \\Delta F(c_{\\mathrm{high}})]$。\n6.  处理完所有用例后，将收集到的结果格式化为指定的字符串格式，每个数值四舍五入到六位小数。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating dose-response steepness and noise\n    for a two-state model of gene regulation.\n    \"\"\"\n\n    # Test suite: (K, ka_max, k_off, r, gamma, n)\n    test_cases = [\n        (50.0, 0.2, 0.1, 0.05, 0.003, 2),   # Case 1\n        (50.0, 0.2, 0.05, 0.05, 0.003, 4),   # Case 2\n        (10.0, 0.4, 0.4, 0.1, 0.05, 3),    # Case 3\n        (100.0, 0.02, 0.02, 0.2, 0.002, 2),  # Case 4\n    ]\n\n    def calculate_fano(c, K, ka_max, k_off, r, gamma, n):\n        \"\"\"\n        Calculates the Fano factor for a given set of parameters.\n        \n        The formula is F(c) = 1 + (r * k_off) / ((k_on(c) + k_off) * (k_on(c) + k_off + gamma))\n        where k_on(c) = ka_max * c^n / (K^n + c^n).\n        \"\"\"\n        # Ensure floating point arithmetic for potentially large exponents\n        c = float(c)\n        K = float(K)\n        n = float(n)\n\n        # Using np.power for robust handling of large exponents\n        cn = np.power(c, n)\n        Kn = np.power(K, n)\n        \n        if np.isinf(Kn) and np.isinf(cn): # Handles c=K with large n\n            f_c = 0.5\n        elif np.isinf(cn) and not np.isinf(Kn): # Handles large c\n            f_c = 1.0\n        else:\n            f_c = cn / (Kn + cn)\n        \n        k_on_c = ka_max * f_c\n        \n        term1 = k_on_c + k_off\n        term2 = k_on_c + k_off + gamma\n        \n        denominator = term1 * term2\n        \n        if denominator == 0:\n            # This case should not happen with non-negative rates,\n            # but as a precaution, return 1 (Poisson noise)\n            return 1.0\n            \n        fano = 1.0 + (r * k_off) / denominator\n        return fano\n\n    all_results = []\n    \n    for case in test_cases:\n        K, ka_max, k_off, r, gamma, n = case\n        \n        # 1. Calculate dose-response steepness S_log\n        # As derived, S_log = n / 4\n        s_log = n / 4.0\n        \n        # 2. Calculate the change in Fano factor Delta_F\n        concentrations_rel = [0.1, 1.0, 10.0]\n        concentrations_abs = [c_rel * K for c_rel in concentrations_rel]\n        \n        delta_f_values = []\n        for c in concentrations_abs:\n            fano_n = calculate_fano(c, K, ka_max, k_off, r, gamma, n)\n            fano_n1 = calculate_fano(c, K, ka_max, k_off, r, gamma, 1)\n            delta_f = fano_n - fano_n1\n            delta_f_values.append(delta_f)\n            \n        case_results = [s_log] + delta_f_values\n        all_results.append(case_results)\n\n    # Format the final output string as per specifications\n    output_parts = []\n    for result_set in all_results:\n        formatted_values = [f\"{val:.6f}\" for val in result_set]\n        output_parts.append(f'[{\",\".join(formatted_values)}]')\n        \n    final_output_str = f'[{\",\".join(output_parts)}]'\n    \n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "细胞内的生物化学过程并非孤立运行，而是相互竞争有限的共享资源。本练习将我们的视角从单个模块提升到整个细胞系统，通过建立一个简化的细胞能量经济模型来探索这一点。我们将模拟ATP的产生和消耗，并分析有限的ATP供应如何限制多个信号通路的整体“吞吐量”，从而揭示系统层面的生物物理约束如何导致不同功能模块之间的性能权衡。",
            "id": "4356816",
            "problem": "要求您通过将细胞能量预算与ATP依赖性反应速率耦合，并预测压力下的权衡，来量化有限的三磷酸腺苷（ATP）可用性如何限制信号通量。从细胞ATP池的质量守恒和基于生物物理的ATP依赖性催化动力学模型开始。\n\n假设与定义：\n- 令 $A(t)$ 表示在时间 $t$（秒，s）时的细胞内ATP浓度，单位为毫摩尔（mM）。\n- 令 $S$ 表示净ATP供应速率，单位为 mM/s。这代表线粒体产量减去任何未明确建模的外部消耗。\n- 非信号ATP损失（例如，基础水解和泄漏）被建模为一级过程，速率常数为 $k_h$（单位为 s$^{-1}$），产生的损失速率为 $k_h A$（单位为 mM/s）。\n- 存在 $N$ 个信号模块，索引为 $i \\in \\{1,2,\\dots,N\\}$。每个模块通过依赖磷酸化的步骤消耗ATP，其相对于ATP的总ATP依赖性速率由Michaelis-Menten（MM）动力学模型描述，产生信号事件通量 $r_i(A)$（单位为 mM/s）：\n  $$r_i(A) = \\dfrac{V_i A}{K_i + A},$$\n  其中 $V_i$ 是最大信号事件速率（单位为 mM/s），$K_i$ 是模块 $i$ 的Michaelis常数（单位为 mM）。\n- 模块 $i$ 的每个信号事件按化学计量消耗 $c_i$ 个ATP分子，因此由模块 $i$ 引起的ATP消耗速率为 $c_i\\,r_i(A)$（等效单位为 mM/s）。\n- 定义加权信号通量指标为\n  $$J(A) = \\sum_{i=1}^{N} w_i\\, r_i(A),$$\n  其中 $w_i$ 是非负权重（无单位），反映了每个模块对总有效通量的相对贡献。\n\n基本原理：\n- 对ATP池应用质量守恒定律，假设在信号传输的时间尺度上，ATP处于一个充分混合的室和一个准稳态：\n  $$\\dfrac{dA}{dt} = S - k_h A - \\sum_{i=1}^{N} c_i\\, r_i(A).$$\n  在稳态时，设置 $\\dfrac{dA}{dt} = 0$ 以获得确定稳态ATP水平 $A^\\ast$ 的代数平衡方程：\n  $$S = k_h A^\\ast + \\sum_{i=1}^{N} c_i\\, \\dfrac{V_i A^\\ast}{K_i + A^\\ast}.$$\n\n任务：\n- 仅使用上述定义，推导一个算法来计算唯一的稳态ATP浓度 $A^\\ast \\ge 0$，该浓度满足给定参数 $(S, k_h, \\{V_i\\}, \\{K_i\\}, \\{c_i\\})$ 下的稳态ATP平衡。\n- 计算每个模块的信号通量 $r_i(A^\\ast)$ 和加权通量 $J(A^\\ast)$。\n- 将 $A^\\ast$ 以毫摩尔（mM）表示，$r_i(A^\\ast)$ 和 $J(A^\\ast)$ 以毫摩尔每秒（mM/s）表示。将所有报告值四舍五入到六位小数。\n\n固定模型参数（所有测试用例使用这些常数）：\n- 模块数量：$N = 3$。\n- 最大速率：$V_1 = 0.50$ mM/s, $V_2 = 0.30$ mM/s, $V_3 = 0.20$ mM/s。\n- Michaelis常数：$K_1 = 0.05$ mM, $K_2 = 0.02$ mM, $K_3 = 0.10$ mM。\n- 每个事件的ATP化学计量成本：$c_1 = 1.0$, $c_2 = 2.0$, $c_3 = 0.5$。\n- 通量权重：$w_1 = 1.0$, $w_2 = 0.5$, $w_3 = 0.2$。\n\n测试套件：\n为以下四组参数 $(S, k_h)$ 提供输出，分别代表基线、能量贫乏压力、损失增加的严重压力和能量丰富条件：\n- 情况 $1$：$S = 0.30$ mM/s, $k_h = 0.10$ s$^{-1}$。\n- 情况 $2$：$S = 0.01$ mM/s, $k_h = 0.10$ s$^{-1}$。\n- 情况 $3$：$S = 0.12$ mM/s, $k_h = 0.20$ s$^{-1}$。\n- 情况 $4$：$S = 1.00$ mM/s, $k_h = 0.10$ s$^{-1}$。\n\n要求的最终输出格式：\n- 对于每个测试用例，返回列表 $[A^\\ast, J(A^\\ast), r_1(A^\\ast), r_2(A^\\ast), r_3(A^\\ast)]$，所有条目均按指定单位四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含结果，形式为由方括号括起来的、按情况分的列表的逗号分隔列表（例如，$[[\\dots],[\\dots],[\\dots],[\\dots]]$，不含嵌入空格）。",
            "solution": "用户希望解决问题陈述。\n问题陈述已经过验证，是合理的。\n\n### 步骤1：提取已知条件\n- 细胞内ATP浓度：$A(t)$，单位 mM。\n- 净ATP供应速率：$S$，单位 mM/s。\n- 非信号ATP损失的一级速率常数：$k_h$，单位 s$^{-1}$。\n- 信号模块数量：$N$。\n- 模块 $i$ 的总ATP依赖性信号事件通量：$r_i(A) = \\dfrac{V_i A}{K_i + A}$，其中 $V_i$ 是最大速率（mM/s），$K_i$ 是Michaelis常数（mM）。\n- 模块 $i$ 的ATP化学计量成本：$c_i$，每个事件的无单位分子数。\n- 加权信号通量指标：$J(A) = \\sum_{i=1}^{N} w_i r_i(A)$，其中 $w_i$ 是无单位权重。\n- 准稳态下ATP的质量守恒（$\\frac{dA}{dt}=0$）：\n$$S = k_h A^\\ast + \\sum_{i=1}^{N} c_i\\, \\dfrac{V_i A^\\ast}{K_i + A^\\ast}$$\n其中 $A^\\ast$ 是稳态ATP浓度。\n\n- 固定参数：\n  - $N=3$\n  - $\\{V_1, V_2, V_3\\} = \\{0.50, 0.30, 0.20\\}$ mM/s\n  - $\\{K_1, K_2, K_3\\} = \\{0.05, 0.02, 0.10\\}$ mM\n  - $\\{c_1, c_2, c_3\\} = \\{1.0, 2.0, 0.5\\}$\n  - $\\{w_1, w_2, w_3\\} = \\{1.0, 0.5, 0.2\\}$\n\n- $(S, k_h)$ 的测试用例：\n  - 情况 1：$(0.30 \\text{ mM/s}, 0.10 \\text{ s}^{-1})$\n  - 情况 2：$(0.01 \\text{ mM/s}, 0.10 \\text{ s}^{-1})$\n  - 情况 3：$(0.12 \\text{ mM/s}, 0.20 \\text{ s}^{-1})$\n  - 情况 4：$(1.00 \\text{ mM/s}, 0.10 \\text{ s}^{-1})$\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，是适定的、客观且完整的。它基于生物化学动力学的标准原理（质量平衡，Michaelis-Menten动力学）来模拟细胞生物能量学，这是系统生物医学中一种有效且常见的方法。核心任务是求解一个非线性代数方程，以得到稳态ATP浓度 $A^\\ast$。\n为了确认问题是适定的，我们必须确保存在一个唯一的、稳定的、有意义的解 $A^\\ast \\ge 0$。我们通过定义一个函数 $f(A)$ 来分析稳态方程，该函数表示在给定浓度 $A$ 下的净ATP通量：\n$$f(A) = S - \\left(k_h A + \\sum_{i=1}^{N} c_i \\frac{V_i A}{K_i+A}\\right)$$\n我们寻求根 $A^\\ast$ 使得 $f(A^\\ast) = 0$。这等同于找到供应速率 $S$（一个常数）和总消耗速率 $g(A)$ 的交点：\n$$g(A) = k_h A + \\sum_{i=1}^{N} c_i \\frac{V_i A}{K_i+A}$$\n1.  当 $A=0$ 时，消耗为 $g(0)=0$。\n2.  对于 $A0$，$g(A)$ 的行为由其导数决定：\n    $$g'(A) = \\frac{d g}{d A} = k_h + \\sum_{i=1}^{N} c_i V_i \\frac{d}{dA}\\left(\\frac{A}{K_i+A}\\right) = k_h + \\sum_{i=1}^{N} \\frac{c_i V_i K_i}{(K_i+A)^2}$$\n    鉴于所有参数（$k_h, c_i, V_i, K_i$）均为正数，对于所有 $A \\ge 0$，$g'(A)  0$。这证明了 $g(A)$ 是一个严格单调递增的函数。\n3.  当 $A \\to \\infty$ 时，项 $k_h A \\to \\infty$，所以 $g(A) \\to \\infty$。\n由于 $g(A)$ 在定义域 $A \\in [0, \\infty)$ 上是连续的，并从 $0$ 严格增加到 $\\infty$，因此对于任何非负供应速率 $S \\ge 0$，方程 $g(A^\\ast) = S$ 都存在唯一一个非负解 $A^\\ast$。因此，该问题是适定的。\n\n### 步骤3：结论与行动\n问题有效。将开发一个解决方案。\n\n### 基于原理的解决方案设计\n问题的核心是求解稳态ATP浓度 $A^\\ast$ 的非线性代数方程。\n$$S = k_h A^\\ast + \\sum_{i=1}^{N} c_i \\frac{V_i A^\\ast}{K_i + A^\\ast}$$\n该方程可以重写为寻找函数 $F(A)=0$ 的根，其中：\n$$F(A) = k_h A + \\sum_{i=1}^{N} c_i \\frac{V_i A}{K_i + A} - S$$\n\n**算法：**\n1.  **数值求根**：由于方程的非线性特性，不易获得 $A^\\ast$ 的解析解。我们将采用数值求根算法。函数 $F(A)$ 的性质使其非常适合此类方法。\n    - 我们已确定对于 $A \\ge 0$，$F(A)$ 是严格单调的。\n    - 当 $A=0$ 时，$F(0) = -S \\le 0$。\n    - 可以确定根的一个上界。如果信号消耗为零，则平衡方程为 $S = k_h A$，得出 $A = S/k_h$。由于信号传导会消耗ATP，实际的稳态水平 $A^\\ast$ 必须小于 $S/k_h$。\n    - 因此，对于 $S  0$，唯一的正根 $A^\\ast$ 保证位于区间 $[0, S/k_h]$ 内。如果 $S=0$，唯一的解是平凡解 $A^\\ast=0$。\n    - 像Brent-Dekker方法（`brentq`）这样的鲁棒算法是理想选择，它结合了二分法、割线法和逆二次插值。只要给定一个区间 $[a, b]$，其中 $F(a)$ 和 $F(b)$ 符号相反，它就能保证收敛。区间 $[0, S/k_h + \\epsilon]$（对于某个小的 $\\epsilon  0$，以确保如果根恰好是 $S/k_h$ 时区间有效，并避免在 $k_h$ 为零时出现除零错误）是一个可靠的括号区间。\n2.  **指标计算**：一旦数值求解器找到唯一的稳态浓度 $A^\\ast$，后续的量就可以通过直接代入其定义来计算：\n    - 每个模块的信号通量：\n      $$r_i(A^\\ast) = \\frac{V_i A^\\ast}{K_i + A^\\ast} \\quad \\text{对于 } i=1, 2, 3$$\n    - 加权信号通量：\n      $$J(A^\\ast) = \\sum_{i=1}^{N} w_i r_i(A^\\ast)$$\n3.  **实现**：该算法将使用Python实现，借助 `numpy` 库对模块参数进行高效的向量化操作，并使用 `scipy.optimize.root_scalar` 进行求根步骤。\n\n**单个测试用例 $(S, k_h)$ 的分步说明：**\n1.  将固定参数 $V_i, K_i, c_i, w_i$ 定义为数值数组。\n2.  如上所述定义平衡函数 $F(A)$。\n3.  对于给定的 $(S, k_h)$，如果 $S=0$，则设置 $A^\\ast=0$。否则，使用函数 $F$ 和一个合适的括号区间（例如 $[0, S/k_h + 1]$）调用 `scipy.optimize.root_scalar` 来找到 $A^\\ast$。\n4.  使用得到的 $A^\\ast$，计算通量向量 $r_i(A^\\ast)$ 和标量通量 $J(A^\\ast)$。\n5.  收集结果 $[A^\\ast, J(A^\\ast), r_1(A^\\ast), r_2(A^\\ast), r_3(A^\\ast)]$。\n6.  对所有测试用例重复此过程，并按规定格式化最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes steady-state ATP concentration and signaling throughput metrics\n    for a biophysical model of cellular bioenergetics under different stress conditions.\n    \"\"\"\n    \n    # Fixed model parameters (use these constants for all test cases)\n    # Number of modules N = 3 is implicit in the array lengths.\n    V = np.array([0.50, 0.30, 0.20])   # Maximum rates (mM/s)\n    K = np.array([0.05, 0.02, 0.10])   # Michaelis constants (mM)\n    c = np.array([1.0, 2.0, 0.5])      # ATP stoichiometric costs per event\n    w = np.array([1.0, 0.5, 0.2])      # Weights for throughput\n\n    # Test suite: parameter sets (S, k_h)\n    test_cases = [\n        (0.30, 0.10),  # Case 1: Baseline\n        (0.01, 0.10),  # Case 2: Energy-poor stress\n        (0.12, 0.20),  # Case 3: Severe stress with increased loss\n        (1.00, 0.10),  # Case 4: Energy-rich conditions\n    ]\n\n    all_results = []\n    \n    for S, k_h in test_cases:\n        # Define the steady-state balance equation f(A) = 0, where\n        # f(A) = (total consumption) - (supply)\n        def balance_equation(A, S_val, k_h_val, V_vec, K_vec, c_vec):\n            # Michaelis-Menten terms for ATP consumption by signaling modules\n            signaling_rates = (V_vec * A) / (K_vec + A)\n            # Total consumption from signaling, weighted by stoichiometry\n            signaling_consumption = np.sum(c_vec * signaling_rates)\n            # Total consumption including basal hydrolysis\n            total_consumption = k_h_val * A + signaling_consumption\n            return total_consumption - S_val\n\n        # Trivial case: no ATP supply means no ATP at steady state.\n        if S == 0:\n            A_star = 0.0\n        else:\n            # Use a robust root-finding algorithm (Brent's method) to solve for A*.\n            # The root A* is guaranteed to be in [0, S/k_h].\n            # A slightly larger bracket is used for numerical safety.\n            upper_bound = S / k_h + 1.0  \n            sol = root_scalar(balance_equation, \n                              args=(S, k_h, V, K, c), \n                              method='brentq', \n                              bracket=[0, upper_bound])\n            A_star = sol.root\n\n        # Once A_star is found, calculate the per-module signaling fluxes.\n        r_A_star = (V * A_star) / (K + A_star)\n\n        # Calculate the weighted signaling throughput metric.\n        J_A_star = np.sum(w * r_A_star)\n\n        # Collect the results for this case.\n        case_result = [A_star, J_A_star, r_A_star[0], r_A_star[1], r_A_star[2]]\n        all_results.append(case_result)\n\n    # Format the final output string exactly as required.\n    # The output is a comma-separated list of case-wise lists.\n    # e.g., [[val1,val2,...],[val1,val2,...],...]\n    # Each value is rounded to six decimal places.\n    output_parts = []\n    for result_list in all_results:\n        formatted_list = [f\"{val:.6f}\" for val in result_list]\n        output_parts.append(f\"[{','.join(formatted_list)}]\")\n    \n    final_output_string = f\"[{','.join(output_parts)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}