{
    "hands_on_practices": [
        {
            "introduction": "在为生物组织建立连续介质模型时，第一步通常是将基本物理原理（如质量守恒、本构关系）综合成一个可预测的数学模型，即偏微分方程。本练习将引导你完成这一关键过程，以多孔弹性理论为背景，该理论对于理解组织固结和间质液流动等现象至关重要。你将从基本定律推导出控制方程，并运用无量纲化技术揭示该物理过程的特征时间尺度 。",
            "id": "4330694",
            "problem": "一个被组织间液饱和的均质线性多孔弹性组织，占据一个在 $x$ 方向上厚度为 $L$ 的平板区域。设 $p(x,t)$ 表示组织间液压力，由于平面具有对称性，假定其仅沿 $x$ 方向变化（一维，1D）。在小应变和惯性可忽略不计的条件下，使用以下基本要素来推导 $p(x,t)$ 的控制方程：局部流体质量守恒、流体流过多孔弹性固体的达西定律（Darcy’s law），以及由 Biot 模量 $c$ 表征的线性储水关系。\n\n具体而言，使用：\n- 流体质量平衡：$\\frac{\\partial \\zeta}{\\partial t} + \\nabla \\cdot \\mathbf{q} = 0$，其中 $\\zeta$ 是单位参考体积内的流体含量增量，$\\mathbf{q}$ 是达西通量。\n- 达西定律：$\\mathbf{q} = - k \\nabla p$，其中 $k$ 是导水率（一个标量、常数、各向同性）。\n- 线性储水关系：$\\zeta = c\\,p$，其中 $c$ 是 Biot 模量（单位为压力的倒数）。\n\n假设 $k$ 和 $c$ 在空间和时间上是常数，并且没有源或汇。\n\n然后，通过引入长度特征尺度 $L$、时间特征尺度 $t_c$ 和压力特征尺度 $p_0$，并定义无量纲变量 $x^{\\ast} = x/L$、$t^{\\ast} = t/t_c$ 和 $p^{\\ast} = p/p_0$，对得到的瞬态固结方程进行无量纲化。选择 $t_c$，使得无量纲方程中乘以二阶空间导数的系数为1，从而得到一维的标准扩散形式：$\\frac{\\partial p^{\\ast}}{\\partial t^{\\ast}} = \\frac{\\partial^2 p^{\\ast}}{\\partial x^{\\ast 2}}$。\n\n以闭合形式给出特征时间尺度 $t_c$ 作为 $L$、$c$ 和 $k$ 的函数。无需四舍五入。只提供表达式；最终答案中不要包含单位。",
            "solution": "问题陈述被认为是有效的，因为它在科学上基于连续介质力学和多孔弹性理论的原理，是适定的、客观的且自洽的。所提供的方程——质量守恒、达西定律和线性储水关系——是推导线性瞬态固结方程的标准组成部分。任务是首先推导这个控制方程，然后使用无量纲化来找到一个特定的特征时间尺度。\n\n推导过程分两部分进行。首先，我们推导组织间液压力 $p(x,t)$ 的控制偏微分方程。其次，我们对该方程进行无量纲化，以求得特征时间尺度 $t_c$。\n\n第一部分：控制方程的推导\n\n问题提供了三个基本关系：\n1.  流体质量平衡：$\\frac{\\partial \\zeta}{\\partial t} + \\nabla \\cdot \\mathbf{q} = 0$，其中 $\\zeta$ 是流体含量增量，$\\mathbf{q}$ 是达西通量。\n2.  达西定律：$\\mathbf{q} = -k \\nabla p$，其中 $k$ 是恒定的导水率。\n3.  线性储水关系：$\\zeta = c\\,p$，其中 $c$ 是恒定的 Biot 模量。\n\n我们首先将线性储水关系 (3) 代入质量平衡方程 (1)。\n$$\n\\frac{\\partial (c\\,p)}{\\partial t} + \\nabla \\cdot \\mathbf{q} = 0\n$$\n由于 Biot 模量 $c$ 是一个常数，因此可以将其从时间导数中提出：\n$$\nc \\frac{\\partial p}{\\partial t} + \\nabla \\cdot \\mathbf{q} = 0\n$$\n接下来，我们将达西定律 (2) 代入这个中间方程：\n$$\nc \\frac{\\partial p}{\\partial t} + \\nabla \\cdot (-k \\nabla p) = 0\n$$\n鉴于导水率 $k$ 也是一个常数，因此可以将其从散度算子中提出：\n$$\nc \\frac{\\partial p}{\\partial t} - k (\\nabla \\cdot \\nabla p) = 0\n$$\n表达式 $\\nabla \\cdot \\nabla p$ 是拉普拉斯算子（Laplacian operator）的定义，记为 $\\nabla^2 p$。该方程变为：\n$$\nc \\frac{\\partial p}{\\partial t} - k \\nabla^2 p = 0\n$$\n重新整理各项，我们得到固结方程的一般形式：\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{k}{c} \\nabla^2 p\n$$\n问题指定了一个一维 (1D) 系统，其中压力 $p$ 仅随空间坐标 $x$ 和时间 $t$ 变化。因此，拉普拉斯算子简化为关于 $x$ 的二阶偏导数：$\\nabla^2 p = \\frac{\\partial^2 p}{\\partial x^2}$。因此，一维控制方程为：\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{k}{c} \\frac{\\partial^2 p}{\\partial x^2}\n$$\n这是一个扩散方程，其中水力扩散系数为 $D = k/c$。\n\n第二部分：无量纲化与 $t_c$ 的确定\n\n给定以下无量纲变量，它们是使用长度特征尺度 $L$、时间特征尺度 $t_c$ 和压力特征尺度 $p_0$ 定义的：\n$$\nx^{\\ast} = \\frac{x}{L}, \\quad t^{\\ast} = \\frac{t}{t_c}, \\quad p^{\\ast} = \\frac{p}{p_0}\n$$\n根据这些定义，我们可以用无量纲变量表示有量纲变量：\n$$\nx = L x^{\\ast}, \\quad t = t_c t^{\\ast}, \\quad p = p_0 p^{\\ast}\n$$\n现在我们使用链式法则转换控制方程中的偏导数。\n时间导数为：\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{\\partial (p_0 p^{\\ast})}{\\partial t} = p_0 \\frac{\\partial p^{\\ast}}{\\partial t} = p_0 \\frac{\\partial p^{\\ast}}{\\partial t^{\\ast}} \\frac{\\partial t^{\\ast}}{\\partial t} = p_0 \\frac{\\partial p^{\\ast}}{\\partial t^{\\ast}} \\left(\\frac{1}{t_c}\\right) = \\frac{p_0}{t_c} \\frac{\\partial p^{\\ast}}{\\partial t^{\\ast}}\n$$\n通过两次应用链式法则，可以得到二阶空间导数：\n$$\n\\frac{\\partial p}{\\partial x} = \\frac{\\partial (p_0 p^{\\ast})}{\\partial x} = p_0 \\frac{\\partial p^{\\ast}}{\\partial x} = p_0 \\frac{\\partial p^{\\ast}}{\\partial x^{\\ast}} \\frac{\\partial x^{\\ast}}{\\partial x} = p_0 \\frac{\\partial p^{\\ast}}{\\partial x^{\\ast}} \\left(\\frac{1}{L}\\right) = \\frac{p_0}{L} \\frac{\\partial p^{\\ast}}{\\partial x^{\\ast}}\n$$\n$$\n\\frac{\\partial^2 p}{\\partial x^2} = \\frac{\\partial}{\\partial x}\\left(\\frac{p_0}{L} \\frac{\\partial p^{\\ast}}{\\partial x^{\\ast}}\\right) = \\frac{p_0}{L} \\frac{\\partial}{\\partial x^{\\ast}}\\left(\\frac{\\partial p^{\\ast}}{\\partial x^{\\ast}}\\right) \\frac{\\partial x^{\\ast}}{\\partial x} = \\frac{p_0}{L} \\frac{\\partial^2 p^{\\ast}}{\\partial x^{\\ast 2}} \\left(\\frac{1}{L}\\right) = \\frac{p_0}{L^2} \\frac{\\partial^2 p^{\\ast}}{\\partial x^{\\ast 2}}\n$$\n现在，我们将这些导数表达式代回到有量纲的控制方程中：\n$$\n\\frac{p_0}{t_c} \\frac{\\partial p^{\\ast}}{\\partial t^{\\ast}} = \\frac{k}{c} \\left( \\frac{p_0}{L^2} \\frac{\\partial^2 p^{\\ast}}{\\partial x^{\\ast 2}} \\right)\n$$\n特征压力 $p_0$ 从两侧消去，这对于一个正确缩放的方程是必须的：\n$$\n\\frac{1}{t_c} \\frac{\\partial p^{\\ast}}{\\partial t^{\\ast}} = \\frac{k}{c L^2} \\frac{\\partial^2 p^{\\ast}}{\\partial x^{\\ast 2}}\n$$\n为了获得标准的无量纲形式，我们将整个方程乘以 $t_c$ 来分离时间导数项：\n$$\n\\frac{\\partial p^{\\ast}}{\\partial t^{\\ast}} = \\left( \\frac{k t_c}{c L^2} \\right) \\frac{\\partial^2 p^{\\ast}}{\\partial x^{\\ast 2}}\n$$\n问题要求该方程与形式 $\\frac{\\partial p^{\\ast}}{\\partial t^{\\ast}} = \\frac{\\partial^2 p^{\\ast}}{\\partial x^{\\ast 2}}$ 相匹配，这意味着乘以二阶空间导数的系数必须等于1：\n$$\n\\frac{k t_c}{c L^2} = 1\n$$\n求解这个关于特征时间尺度 $t_c$ 的代数方程，得到：\n$$\nt_c = \\frac{c L^2}{k}\n$$\n这就是多孔弹性介质中压力扩散的特征时间。",
            "answer": "$$\n\\boxed{\\frac{c L^{2}}{k}}\n$$"
        },
        {
            "introduction": "现实世界中的大多数连续介质力学问题都极其复杂，难以求得解析解，因此必须依赖数值方法。本练习将介绍将控制方程（“强形式”）转化为其等价的“弱形式”这一核心步骤。这种变分形式是有限元法（FEM）等强大数值技术的数学基石，通过为不可压缩弹性组织模型推导其弱形式，你将学会如何处理耦合场问题及边界条件 。",
            "id": "4330746",
            "problem": "考虑一个生物组织，其模型为一个占据有界域 $\\Omega \\subset \\mathbb{R}^{3}$ 且具有 Lipschitz 边界 $\\partial \\Omega$ 的小应变、准静态、不可压缩线性弹性连续体。边界被划分为位移（Dirichlet）边界 $\\Gamma_{u}$ 和面力（Neumann）边界 $\\Gamma_{t}$，其中 $\\Gamma_{u} \\cup \\Gamma_{t} = \\partial \\Omega$ 且 $\\Gamma_{u} \\cap \\Gamma_{t} = \\emptyset$。令 $\\mathbf{u} : \\Omega \\to \\mathbb{R}^{3}$ 表示位移场，$p : \\Omega \\to \\mathbb{R}$ 表示强制施加不可压缩性的拉格朗日乘子（可解释为压力），$\\mathbf{b} : \\Omega \\to \\mathbb{R}^{3}$ 表示给定的单位体积体力，$\\mathbf{t} : \\Gamma_{t} \\to \\mathbb{R}^{3}$ 表示给定的面力。$\\partial \\Omega$ 上的外单位法向量为 $\\mathbf{n}$。Cauchy 应力为 $\\boldsymbol{\\sigma} = -p \\mathbf{I} + 2 \\mu \\boldsymbol{\\varepsilon}(\\mathbf{u})$，其中 $\\mu > 0$ 是剪切模量，$\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top})$ 是小应变张量。准静态线性动量平衡方程为 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0}$（在 $\\Omega$ 内），不可压缩性条件为 $\\nabla \\cdot \\mathbf{u} = 0$（在 $\\Omega$ 内），边界条件为 $\\mathbf{u} = \\bar{\\mathbf{u}}$（在 $\\Gamma_{u}$上）和 $\\boldsymbol{\\sigma} \\mathbf{n} = \\mathbf{t}$（在 $\\Gamma_{t}$ 上）。\n\n仅从上述局部平衡定律和定义出发（不假设任何预先推导的弱形式），通过引入适当的试函数并应用 Gauss-Green 散度定理，推导动量-不可压缩性耦合系统的弱形式。明确指出试函数空间，并清晰标示出现的自然边界项。将您的最终弱形式紧凑地表示为单个残差泛函 $\\mathcal{R}(\\mathbf{u}, p; \\mathbf{w}, q)$，该泛函用场变量 $\\mathbf{u}$ 和 $p$ 以及试函数 $\\mathbf{w}$ 和 $q$ 表示，使得对于所有容许的试函数，弱形式对应于 $\\mathcal{R}(\\mathbf{u}, p; \\mathbf{w}, q) = 0$。您的最终答案必须是 $\\mathcal{R}(\\mathbf{u}, p; \\mathbf{w}, q)$ 的单个闭式解析表达式，并且必须包含所有内部和边界的贡献。最终答案中不要提供任何中间步骤。不需要进行数值近似。",
            "solution": "该问题是有效的，因为它提出了一个来自连续介质力学（线性弹性、不可压缩固体）的标准、适定的偏微分方程组，并要求对其弱形式进行标准的数学推导。该问题具有科学依据、客观且自成体系。\n\n弱形式的推导始于控制方程的强形式：准静态线性动量平衡和不可压缩约束。\n\n动量平衡方程由下式给出：\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0} \\quad \\text{in } \\Omega\n$$\n不可压缩约束为：\n$$\n\\nabla \\cdot \\mathbf{u} = 0 \\quad \\text{in } \\Omega\n$$\n\n为了推导弱形式，我们引入试函数。对于向量值的动量方程，我们使用一个向量值试函数 $\\mathbf{w}$。对于标量值的不可压缩方程，我们使用一个标量值试函数 $q$。我们将每个方程乘以其各自的试函数，并在域 $\\Omega$ 上积分。\n\n首先，考虑动量方程。我们寻求位移 $\\mathbf{u}$ 的解，该解满足在 $\\Gamma_u$ 上的本质边界条件 $\\mathbf{u} = \\bar{\\mathbf{u}}$。试函数 $\\mathbf{w}$ 必须属于一个满足此条件的函数空间。具体来说，我们要求试函数在位移被规定的地方为零。因此，位移的解空间为 $\\mathbf{u} \\in V = \\{ \\mathbf{v} \\in [H^1(\\Omega)]^3 : \\mathbf{v} = \\bar{\\mathbf{u}} \\text{ on } \\Gamma_u \\}$，试函数空间为 $\\mathbf{w} \\in V_0 = \\{ \\mathbf{v} \\in [H^1(\\Omega)]^3 : \\mathbf{v} = \\mathbf{0} \\text{ on } \\Gamma_u \\}$。压力解和试函数属于平方可积函数空间，即 $p, q \\in Q = L^2(\\Omega)$。\n\n动量方程的加权残差形式为：\n$$\n\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b}) \\cdot \\mathbf{w} \\, dV = 0\n$$\n对于所有容许的试函数 $\\mathbf{w} \\in V_0$。我们可以将此积分拆分：\n$$\n\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{\\sigma}) \\cdot \\mathbf{w} \\, dV + \\int_{\\Omega} \\mathbf{b} \\cdot \\mathbf{w} \\, dV = 0\n$$\n为了降低应力张量 $\\boldsymbol{\\sigma}$ 的微分阶数，我们对第一项应用 Gauss-Green 散度定理，这是一种分部积分的形式。使用恒等式 $\\nabla \\cdot (\\boldsymbol{\\sigma}^{\\top} \\mathbf{w}) = (\\nabla \\cdot \\boldsymbol{\\sigma}) \\cdot \\mathbf{w} + \\boldsymbol{\\sigma} : \\nabla \\mathbf{w}$ 以及 Cauchy 应力张量的对称性 ($\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\top}$)，我们得到 $\\nabla \\cdot (\\boldsymbol{\\sigma}\\mathbf{w}) = (\\nabla \\cdot \\boldsymbol{\\sigma}) \\cdot \\mathbf{w} + \\boldsymbol{\\sigma} : \\nabla \\mathbf{w}$。整理并在 $\\Omega$ 上积分可得：\n$$\n\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{\\sigma}) \\cdot \\mathbf{w} \\, dV = \\int_{\\Omega} \\nabla \\cdot (\\boldsymbol{\\sigma}\\mathbf{w}) \\, dV - \\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla \\mathbf{w} \\, dV\n$$\n对右侧第一项应用散度定理可得：\n$$\n\\int_{\\Omega} \\nabla \\cdot (\\boldsymbol{\\sigma}\\mathbf{w}) \\, dV = \\int_{\\partial \\Omega} (\\boldsymbol{\\sigma}\\mathbf{w}) \\cdot \\mathbf{n} \\, dS = \\int_{\\partial \\Omega} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{w} \\, dS\n$$\n将此代回动量方程的弱形式中：\n$$\n\\int_{\\partial \\Omega} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{w} \\, dS - \\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla \\mathbf{w} \\, dV + \\int_{\\Omega} \\mathbf{b} \\cdot \\mathbf{w} \\, dV = 0\n$$\n在 $\\partial\\Omega$ 上的边界积分被拆分为来自 $\\Gamma_u$ 和 $\\Gamma_t$ 的贡献：\n$$\n\\int_{\\partial \\Omega} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{w} \\, dS = \\int_{\\Gamma_u} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{w} \\, dS + \\int_{\\Gamma_t} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{w} \\, dS\n$$\n根据试函数空间 $V_0$ 的定义，在 $\\Gamma_u$ 上 $\\mathbf{w} = \\mathbf{0}$，因此在 $\\Gamma_u$ 上的积分为零。在 $\\Gamma_t$ 上，我们有 Neumann 边界条件 $\\boldsymbol{\\sigma}\\mathbf{n} = \\mathbf{t}$。代入此条件，边界积分变为 $\\int_{\\Gamma_t} \\mathbf{t} \\cdot \\mathbf{w} \\, dS$。这一项涉及给定的面力 $\\mathbf{t}$，是**自然边界项**，因为它是在积分过程中自然产生的，而不是强加于函数空间的。\n\n动量方程的弱形式现在为：\n$$\n- \\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla \\mathbf{w} \\, dV + \\int_{\\Omega} \\mathbf{b} \\cdot \\mathbf{w} \\, dV + \\int_{\\Gamma_t} \\mathbf{t} \\cdot \\mathbf{w} \\, dS = 0\n$$\n接下来，我们代入应力的本构关系 $\\boldsymbol{\\sigma} = -p \\mathbf{I} + 2 \\mu \\boldsymbol{\\varepsilon}(\\mathbf{u})$：\n$$\n- \\int_{\\Omega} (-p \\mathbf{I} + 2 \\mu \\boldsymbol{\\varepsilon}(\\mathbf{u})) : \\nabla \\mathbf{w} \\, dV + \\int_{\\Omega} \\mathbf{b} \\cdot \\mathbf{w} \\, dV + \\int_{\\Gamma_t} \\mathbf{t} \\cdot \\mathbf{w} \\, dS = 0\n$$\n展开双点积：\n$$\n\\int_{\\Omega} p (\\mathbf{I} : \\nabla \\mathbf{w}) \\, dV - \\int_{\\Omega} 2 \\mu \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\nabla \\mathbf{w} \\, dV + \\int_{\\Omega} \\mathbf{b} \\cdot \\mathbf{w} \\, dV + \\int_{\\Gamma_t} \\mathbf{t} \\cdot \\mathbf{w} \\, dS = 0\n$$\n使用恒等式 $\\mathbf{I} : \\nabla \\mathbf{w} = \\text{tr}(\\nabla \\mathbf{w}) = \\nabla \\cdot \\mathbf{w}$ 和 $\\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\nabla \\mathbf{w} = \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{w})$（由于 $\\boldsymbol{\\varepsilon}(\\mathbf{u})$ 的对称性），方程变为：\n$$\n\\int_{\\Omega} 2 \\mu \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{w}) \\, dV - \\int_{\\Omega} p (\\nabla \\cdot \\mathbf{w}) \\, dV = \\int_{\\Omega} \\mathbf{b} \\cdot \\mathbf{w} \\, dV + \\int_{\\Gamma_t} \\mathbf{t} \\cdot \\mathbf{w} \\, dS\n$$\n这是动量平衡的最终弱形式。\n\n对于不可压缩约束 $\\nabla \\cdot \\mathbf{u} = 0$，我们乘以标量试函数 $q \\in Q$ 并在 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} q (\\nabla \\cdot \\mathbf{u}) \\, dV = 0\n$$\n在混合格式中，为了得到算子的对称性，通常会引入一个负号，从而得到 $-\\int_{\\Omega} q (\\nabla \\cdot \\mathbf{u}) \\, dV = 0$。两种形式是等价的。\n\n问题要求一个单一的残差泛函 $\\mathcal{R}(\\mathbf{u}, p; \\mathbf{w}, q)$，使得对于所有的 $(\\mathbf{w}, q) \\in V_0 \\times Q$，耦合弱形式为 $\\mathcal{R}(\\mathbf{u}, p; \\mathbf{w}, q) = 0$。我们通过将动量和不可压缩性方程的弱形式相加来构造它，在相加前将所有项移到一边。\n由动量方程得到：\n$$\n\\int_{\\Omega} 2 \\mu \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{w}) \\, dV - \\int_{\\Omega} p (\\nabla \\cdot \\mathbf{w}) \\, dV - \\int_{\\Omega} \\mathbf{b} \\cdot \\mathbf{w} \\, dV - \\int_{\\Gamma_t} \\mathbf{t} \\cdot \\mathbf{w} \\, dS = 0\n$$\n由不可压缩约束（使用常规的负号）得到：\n$$\n- \\int_{\\Omega} q (\\nabla \\cdot \\mathbf{u}) \\, dV = 0\n$$\n将这两个方程相加，得到总残差：\n$$\n\\mathcal{R}(\\mathbf{u}, p; \\mathbf{w}, q) = \\int_{\\Omega} 2 \\mu \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{w}) \\, dV - \\int_{\\Omega} p (\\nabla \\cdot \\mathbf{w}) \\, dV - \\int_{\\Omega} q (\\nabla \\cdot \\mathbf{u}) \\, dV - \\int_{\\Omega} \\mathbf{b} \\cdot \\mathbf{w} \\, dV - \\int_{\\Gamma_t} \\mathbf{t} \\cdot \\mathbf{w} \\, dS\n$$\n通过组合体积积分，可以更紧凑地写出此式。",
            "answer": "$$\n\\boxed{\\mathcal{R}(\\mathbf{u}, p; \\mathbf{w}, q) = \\int_{\\Omega} \\left( 2 \\mu \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{w}) - p (\\nabla \\cdot \\mathbf{w}) - q (\\nabla \\cdot \\mathbf{u}) - \\mathbf{b} \\cdot \\mathbf{w} \\right) dV - \\int_{\\Gamma_{t}} \\mathbf{t} \\cdot \\mathbf{w} \\, dS}\n$$"
        },
        {
            "introduction": "在开发并实现一个数值模型后，我们必须回答一个至关重要的问题：“我的代码正确吗？”。本练习将介绍一种用于验证代码准确性和收敛阶的严谨技术——“人造解验证法”（Method of Manufactured Solutions, MMS）。通过求解一个具有已知“人造”解析解的问题，我们可以精确地量化数值误差，并确认我们的程序是否达到了预期的收敛速度 。这个实践将MMS应用于一个一维多孔弹性问题，为你提供验证复杂模拟代码的宝贵经验。",
            "id": "4330764",
            "problem": "考虑一个占据空间域 $x \\in [0,1]$ 的一维、稳态、小应变线性多孔弹性介质。其控制方程源于基于 Biot 多孔弹性理论的准静态力学平衡和达西型流体通量守恒。令 $u(x)$ 表示位移场，$p(x)$ 表示孔隙压力场。力学平衡方程由下式给出\n$$\n-\\frac{d}{dx}\\sigma(x) = f(x),\n$$\n其中柯西应力为\n$$\n\\sigma(x) = E \\frac{du}{dx}(x) - \\alpha p(x),\n$$\n$E$ 为杨氏模量，$\\alpha$ 为 Biot 系数。稳态流体质量守恒简化为\n$$\n-\\frac{d}{dx}\\left(\\kappa \\frac{dp}{dx}(x)\\right) = s(x),\n$$\n其中 $\\kappa$ 为水力传导系数，$s(x)$ 为源项。\n\n为进行严格的数值网格收敛性研究，我们采用制造解方法。规定光滑的精确场\n$$\nu^\\star(x) = \\sin(\\pi x), \\quad p^\\star(x) = \\cos(2\\pi x),\n$$\n并施加与这些精确场一致的狄利克雷边界条件，\n$$\nu(0) = u^\\star(0), \\quad u(1) = u^\\star(1), \\quad p(0) = p^\\star(0), \\quad p(1) = p^\\star(1).\n$$\n根据控制方程，推导出力源项 $f(x)$ 和汇源项 $s(x)$，使得 $(u^\\star, p^\\star)$ 对于任意常数 $E > 0$, $\\alpha \\ge 0$ 和 $\\kappa > 0$ 都是该连续问题的精确解。具体来说，从定义出发并应用基本微积分，\n$$\nf(x) = -\\frac{d}{dx}\\left(E \\frac{du^\\star}{dx}(x) - \\alpha p^\\star(x)\\right) = -E \\frac{d^2 u^\\star}{dx^2}(x) + \\alpha \\frac{dp^\\star}{dx}(x),\n$$\n以及\n$$\ns(x) = -\\frac{d}{dx}\\left(\\kappa \\frac{dp^\\star}{dx}(x)\\right) = -\\kappa \\frac{d^2 p^\\star}{dx^2}(x).\n$$\n\n用 $N$ 个点的均匀网格对区域进行离散，网格间距为 $h = 1/(N-1)$，并使用二阶中心有限差分来近似导数。对于压力，求解与下式对应的线性系统\n$$\n-\\kappa \\frac{p_{i-1} - 2 p_i + p_{i+1}}{h^2} = s(x_i),\n$$\n该方程适用于内部节点 $i = 1, \\dots, N-2$，并采用狄利克雷边界值 $p_0 = p^\\star(0)$ 和 $p_{N-1} = p^\\star(1)$。对于位移，求解\n$$\n- E \\frac{u_{i-1} - 2 u_i + u_{i+1}}{h^2} + \\alpha \\frac{p_{i+1} - p_{i-1}}{2h} = f(x_i),\n$$\n该方程适用于内部节点 $i = 1, \\dots, N-2$，并采用狄利克雷边界值 $u_0 = u^\\star(0)$ 和 $u_{N-1} = u^\\star(1)$。将线性系统组装成标准的三对角形式，并将边界条件适当地并入右侧项。\n\n定义并计算数值解与网格上精确制造场之间的适当离散误差范数：\n- 场 $q \\in \\{u, p\\}$ 的离散 $L^2$ 误差范数：\n$$\n\\| q - q^\\star \\|_{L^2_h} = \\left( h \\sum_{i=0}^{N-1} \\left( q_i - q^\\star(x_i) \\right)^2 \\right)^{1/2}.\n$$\n- 位移和孔隙压力的离散 $H^1$ 半范数误差：\n$$\n| q - q^\\star |_{H^1_h} = \\left( h \\sum_{i=1}^{N-2} \\left( \\frac{q_{i+1} - q_{i-1}}{2h} - \\frac{dq^\\star}{dx}(x_i) \\right)^2 \\right)^{1/2}.\n$$\n\n通过在一系列均匀网格（$N \\in \\{16, 32, 64, 128\\}$）上计算这些误差范数，进行网格收敛性研究。对于每对连续的网格，计算经验收敛率\n$$\n\\rho = \\frac{\\log\\left(\\frac{E_h}{E_{h/2}}\\right)}{\\log(2)},\n$$\n其中 $E_h$ 表示网格间距为 $h$ 时的误差范数，$E_{h/2}$ 表示在加密后的间距下的相同误差范数。报告所有连续网格对计算出的收敛率的平均值。\n\n根据所选中心有限差分格式的精度阶数，解释观测到的位移和孔隙压力的收敛率。使用以下三个具有科学意义的参数集作为测试套件：\n1. 情况 A (耦合，光滑强迫项)：$E = 1.3$, $\\alpha = 0.8$, $\\kappa = 0.6$。\n2. 情况 B (解耦力学)：$E = 2.0$, $\\alpha = 0.0$, $\\kappa = 0.6$。\n3. 情况 C (更刚性的压力算子)：$E = 1.1$, $\\alpha = 0.5$, $\\kappa = 0.05$。\n\n本研究中所有量均为无量纲。您的程序应针对每种情况计算四种误差度量的平均收敛率：位移 $L^2$ 范数、孔隙压力 $L^2$ 范数、位移 $H^1$ 半范数和孔隙压力 $H^1$ 半范数。最终输出必须是单行，包含一个列表的列表，其中每个子列表按上述顺序包含每种情况的四个浮点平均值。格式必须严格如下\n$$\n\\text{[}[r_{A,u,L2}, r_{A,p,L2}, r_{A,u,H1}, r_{A,p,H1}], [r_{B,u,L2}, r_{B,p,L2}, r_{B,u,H1}, r_{B,p,H1}], [r_{C,u,L2}, r_{C,p,L2}, r_{C,u,H1}, r_{C,p,H1}]\\text{]}\n$$\n直接打印数值（无单位）。",
            "solution": "用户提供了一个问题陈述，要求对描述线性多孔弹性的耦合偏微分方程组进行数值求解和验证。所采用的方法是使用制造解方法进行网格收敛性研究。\n\n### 步骤1：问题验证\n\n该问题指定了一个一维、稳态、小应变线性多孔弹性介质。其控制方程基于成熟的 Biot 理论。\n\n**提取的已知条件：**\n- **控制方程**：\n    1. 力学平衡：$-\\frac{d}{dx}\\sigma(x) = f(x)$，其中应力 $\\sigma(x) = E \\frac{du}{dx}(x) - \\alpha p(x)$。\n    2. 流体质量守恒：$-\\frac{d}{dx}\\left(\\kappa \\frac{dp}{dx}(x)\\right) = s(x)$。\n- **制造解**：$u^\\star(x) = \\sin(\\pi x)$，$p^\\star(x) = \\cos(2\\pi x)$。\n- **边界条件**：根据在 $x=0$ 和 $x=1$ 处的制造解导出的狄利克雷条件。\n- **强迫项**：推导为 $f(x) = -E \\frac{d^2 u^\\star}{dx^2}(x) + \\alpha \\frac{dp^\\star}{dx}(x)$ 和 $s(x) = -\\kappa \\frac{d^2 p^\\star}{dx^2}(x)$。\n- **数值格式**：在具有 $N$ 个点和间距 $h = 1/(N-1)$ 的均匀网格上使用二阶中心有限差分。\n- **误差度量**：离散 $L^2$ 误差范数和离散 $H^1$ 半范数误差。\n- **收敛性研究**：网格点数 $N \\in \\{16, 32, 64, 128\\}$。经验收敛率为 $\\rho = \\log(E_h / E_{h/2}) / \\log(2)$。\n- **测试用例**：提供了三组无量纲参数 $(E, \\alpha, \\kappa)$。\n\n**验证结论：**\n- **科学依据**：该问题基于标准的多孔弹性 Biot 理论，这是多孔介质连续介质力学的基石。制造解方法是验证数值代码正确性和准确性的严谨标准技术。所有数学关系均是合理的。\n- **适定性**：该系统由两个带有指定狄利克雷边界条件的线性二阶椭圆型微分方程组成。这构成了一个适定的边值问题。所选的有限差分格式导致了非奇异线性系统，确保了数值解的唯一性。\n- **客观性**：问题以精确的数学和数值术语陈述，没有任何主观性或模糊性。\n- **完整性**：提供了所有必要信息：方程、参数、边界条件、数值方法、误差定义，以及对所需任务和输出格式的清晰描述。\n\n该问题被认为是**有效的**，因为其科学上合理、适定、完整且客观。我现在将继续进行求解。\n\n### 步骤2：求解推导与算法设计\n\n将通过以下步骤来构建解决方案：\n1.  推导强迫项 $f(x)$ 和 $s(x)$ 的显式形式。\n2.  构建由有限差分格式产生的线性代数系统。\n3.  设计一个算法，为一系列网格分辨率求解这些系统。\n4.  计算指定的误差范数并计算平均收敛率。\n\n**1. 解析强迫项**\n给定制造解：\n$u^\\star(x) = \\sin(\\pi x)$\n$p^\\star(x) = \\cos(2\\pi x)$\n\n我们计算它们的导数：\n$\\frac{du^\\star}{dx} = \\pi \\cos(\\pi x)$\n$\\frac{d^2u^\\star}{dx^2} = -\\pi^2 \\sin(\\pi x)$\n\n$\\frac{dp^\\star}{dx} = -2\\pi \\sin(2\\pi x)$\n$\\frac{d^2p^\\star}{dx^2} = -4\\pi^2 \\cos(2\\pi x)$\n\n将这些导数代入 $f(x)$ 和 $s(x)$ 的定义中：\n$s(x) = -\\kappa \\frac{d^2p^\\star}{dx^2} = -\\kappa (-4\\pi^2 \\cos(2\\pi x)) = 4\\kappa \\pi^2 \\cos(2\\pi x)$\n$f(x) = -E \\frac{d^2u^\\star}{dx^2} + \\alpha \\frac{dp^\\star}{dx} = -E (-\\pi^2 \\sin(\\pi x)) + \\alpha (-2\\pi \\sin(2\\pi x)) = E\\pi^2 \\sin(\\pi x) - 2\\alpha\\pi \\sin(2\\pi x)$\n\n**2. 离散系统构建**\n该问题按顺序求解：首先求解压力 $p$，然后求解位移 $u$。\n\n**压力系统：** 内部节点 $i=1, \\dots, N-2$ 的方程为：\n$$-\\kappa \\frac{p_{i-1} - 2p_i + p_{i+1}}{h^2} = s(x_i)$$\n这可以写成一个线性系统 $\\mathbf{A}_p \\mathbf{p}_{int} = \\mathbf{b}_p$，其中 $\\mathbf{p}_{int} = [p_1, p_2, \\dots, p_{N-2}]^T$。矩阵 $\\mathbf{A}_p$ 是一个 $(N-2) \\times (N-2)$ 的三对角矩阵，其元素为：\n- 对角线元素：$2\\kappa/h^2$\n- 非对角线元素：$-\\kappa/h^2$\n\n右侧向量 $\\mathbf{b}_p$ 包含了源项 $s(x_i)$ 和边界条件 $p_0=p^\\star(x_0)$ 与 $p_{N-1}=p^\\star(x_{N-1})$。对于 $i=1, \\dots, N-2$：\n- $b_{p,i} = s(x_i)$\n边界条件通过修改第一个和最后一个方程来处理：\n- 对于 $i=1$：$\\frac{2\\kappa}{h^2} p_1 - \\frac{\\kappa}{h^2} p_2 = s(x_1) + \\frac{\\kappa}{h^2} p_0$\n- 对于 $i=N-2$：$-\\frac{\\kappa}{h^2} p_{N-3} + \\frac{2\\kappa}{h^2} p_{N-2} = s(x_{N-2}) + \\frac{\\kappa}{h^2} p_{N-1}$\n因此，右侧向量变为：$b_{p,1} \\to b_{p,1} + \\frac{\\kappa}{h^2}p_0$ 且 $b_{p,N-2} \\to b_{p,N-2} + \\frac{\\kappa}{h^2}p_{N-1}$。\n\n**位移系统：** 在求出数值压力 $p_i$ 后，我们求解位移 $u_i$。内部节点 $i=1, \\dots, N-2$ 的方程为：\n$$-E \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} + \\alpha \\frac{p_{i+1} - p_{i-1}}{2h} = f(x_i)$$\n这是另一个线性系统 $\\mathbf{A}_u \\mathbf{u}_{int} = \\mathbf{b}_u$，其中 $\\mathbf{u}_{int}=[u_1, u_2, \\dots, u_{N-2}]^T$。矩阵 $\\mathbf{A}_u$ 是一个 $(N-2) \\times (N-2)$ 的三对角矩阵，其元素为：\n- 对角线元素：$2E/h^2$\n- 非对角线元素：$-E/h^2$\n\n右侧向量 $\\mathbf{b}_u$ 由强迫项和已知的压力梯度项构成：\n$$b_{u,i} = f(x_i) - \\alpha \\frac{p_{i+1} - p_{i-1}}{2h}$$\n边界条件 $u_0=u^\\star(x_0)$ 和 $u_{N-1}=u^\\star(x_{N-1})$ 的并入方式与压力系统类似：\n- $b_{u,1} \\to b_{u,1} + \\frac{E}{h^2}u_0$\n- $b_{u,N-2} \\to b_{u,N-2} + \\frac{E}{h^2}u_{N-1}$\n\n**3. 误差计算与收敛率**\n- **$L^2$ 误差**：$\\|q - q^\\star\\|_{L^2_h} = \\left( h \\sum_{i=0}^{N-1} (q_i - q^\\star(x_i))^2 \\right)^{1/2}$ 是使用完整的解向量 $(q_0, \\dots, q_{N-1})$ 和在网格上计算的精确解来计算的。\n- **$H^1$ 半范数误差**：$|q - q^\\star|_{H^1_h} = \\left( h \\sum_{i=1}^{N-2} \\left( \\frac{q_{i+1} - q_{i-1}}{2h} - \\frac{dq^\\star}{dx}(x_i) \\right)^2 \\right)^{1/2}$ 是使用数值解和在内部网格点上的精确导数来计算的。\n- **收敛率**：对于每种误差类型，在 $N \\in [16, 32, 64, 128]$ 的条件下获得一系列误差 $[E_1, E_2, E_3, E_4]$。计算三个收敛率：$\\rho_1 = \\log(E_1/E_2)/\\log(2)$、$\\rho_2 = \\log(E_2/E_3)/\\log(2)$ 和 $\\rho_3 = \\log(E_3/E_4)/\\log(2)$。报告的收敛率是其平均值 $(\\rho_1+\\rho_2+\\rho_3)/3$。\n\n**4. 算法**\n对于每个测试用例 $(E, \\alpha, \\kappa)$，主算法按以下步骤进行：\n1. 初始化四个空列表，用于存储不同网格尺寸下四种误差度量的误差值。\n2. 遍历一系列网格尺寸 $N \\in \\{16, 32, 64, 128\\}$。\n   a. 定义网格：$h = 1/(N-1)$，$x_i = i h$。\n   b. 在网格上计算精确解 $u^\\star, p^\\star$ 和源项 $f, s$。\n   c. 组装并求解压力场 $p$ 的线性系统。\n   d. 使用计算出的压力场 $p$，组装并求解位移场 $u$ 的线性系统。\n   e. 计算四种误差范数（$u$ 的 $L^2$ 范数、$p$ 的 $L^2$ 范数、$u$ 的 $H^1$ 半范数和 $p$ 的 $H^1$ 半范数）。\n   f. 将每个误差附加到其对应的列表中。\n3. 对四个误差列表中的每一个，计算平均收敛率。\n4. 返回该测试用例的四个平均收敛率。\n5. 主函数将对所有三个测试用例执行此操作，并按指定格式化结果。\n\n用于二阶导数（拉普拉斯算子）和一阶导数（梯度）的中心有限差分格式都是二阶精度（$O(h^2)$）的。因此，解的点态误差预计为 $O(h^2)$。涉及积分的 $L^2$ 范数也将是 $O(h^2)$。衡量导数误差的 $H^1$ 半范数对于此格式也预期以 2 阶收敛。因此，所有计算出的收敛率都应接近 2.0。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to run the poroelasticity convergence study for all test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.3, 0.8, 0.6),  # Case A\n        (2.0, 0.0, 0.6),  # Case B\n        (1.1, 0.5, 0.05), # Case C\n    ]\n\n    all_results = []\n    for case in test_cases:\n        E, alpha, kappa = case\n        rates = run_convergence_study(E, alpha, kappa)\n        all_results.append(rates)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\ndef run_convergence_study(E, alpha, kappa):\n    \"\"\"\n    Performs a mesh convergence study for a given set of parameters.\n    \"\"\"\n    Ns = [16, 32, 64, 128]\n    errors = {\n        'u_L2': [], 'p_L2': [],\n        'u_H1': [], 'p_H1': []\n    }\n\n    # Exact solutions and their derivatives\n    u_star = lambda x: np.sin(np.pi * x)\n    du_star_dx = lambda x: np.pi * np.cos(np.pi * x)\n    d2u_star_dx2 = lambda x: -(np.pi**2) * np.sin(np.pi * x)\n\n    p_star = lambda x: np.cos(2 * np.pi * x)\n    dp_star_dx = lambda x: -2 * np.pi * np.sin(2 * np.pi * x)\n    d2p_star_dx2 = lambda x: -4 * (np.pi**2) * np.cos(2 * np.pi * x)\n\n    # Forcing terms\n    f_source = lambda x: -E * d2u_star_dx2(x) + alpha * dp_star_dx(x)\n    s_source = lambda x: -kappa * d2p_star_dx2(x)\n\n    for N in Ns:\n        # 1. Setup grid\n        h = 1.0 / (N - 1)\n        x = np.linspace(0.0, 1.0, N)\n        \n        # Internal nodes for which we solve the system\n        x_int = x[1:-1]\n        num_int_nodes = N - 2\n\n        # 2. Solve for pressure p\n        A_p = np.zeros((num_int_nodes, num_int_nodes))\n        diag_p = (2.0 * kappa) / (h**2)\n        off_diag_p = (-1.0 * kappa) / (h**2)\n        np.fill_diagonal(A_p, diag_p)\n        if num_int_nodes > 1:\n            np.fill_diagonal(A_p[1:], off_diag_p)\n            np.fill_diagonal(A_p[:, 1:], off_diag_p)\n        \n        b_p = s_source(x_int)\n        # Apply boundary conditions\n        p0 = p_star(x[0])\n        pN_1 = p_star(x[-1])\n        b_p[0] -= off_diag_p * p0\n        b_p[-1] -= off_diag_p * pN_1\n\n        p_int = np.linalg.solve(A_p, b_p)\n        p_sol = np.concatenate(([p0], p_int, [pN_1]))\n\n        # 3. Solve for displacement u\n        A_u = np.zeros((num_int_nodes, num_int_nodes))\n        diag_u = (2.0 * E) / (h**2)\n        off_diag_u = (-1.0 * E) / (h**2)\n        np.fill_diagonal(A_u, diag_u)\n        if num_int_nodes > 1:\n            np.fill_diagonal(A_u[1:], off_diag_u)\n            np.fill_diagonal(A_u[:, 1:], off_diag_u)\n        \n        # RHS for displacement eqn\n        f_vals = f_source(x_int)\n        # Centered difference for pressure gradient on internal nodes\n        p_grad_term = alpha * (p_sol[2:] - p_sol[:-2]) / (2.0 * h)\n        b_u = f_vals - p_grad_term\n        \n        # Apply boundary conditions\n        u0 = u_star(x[0])\n        uN_1 = u_star(x[-1])\n        b_u[0] -= off_diag_u * u0\n        b_u[-1] -= off_diag_u * uN_1\n\n        u_int = np.linalg.solve(A_u, b_u)\n        u_sol = np.concatenate(([u0], u_int, [uN_1]))\n\n        # 4. Compute errors\n        u_exact = u_star(x)\n        p_exact = p_star(x)\n\n        # L2 errors\n        err_u_L2 = np.sqrt(h * np.sum((u_sol - u_exact)**2))\n        err_p_L2 = np.sqrt(h * np.sum((p_sol - p_exact)**2))\n        errors['u_L2'].append(err_u_L2)\n        errors['p_L2'].append(err_p_L2)\n        \n        # H1 seminorm errors\n        u_grad_num = (u_sol[2:] - u_sol[:-2]) / (2.0 * h)\n        u_grad_exact = du_star_dx(x_int)\n        err_u_H1 = np.sqrt(h * np.sum((u_grad_num - u_grad_exact)**2))\n        \n        p_grad_num = (p_sol[2:] - p_sol[:-2]) / (2.0 * h)\n        p_grad_exact = dp_star_dx(x_int)\n        err_p_H1 = np.sqrt(h * np.sum((p_grad_num - p_grad_exact)**2))\n        \n        errors['u_H1'].append(err_u_H1)\n        errors['p_H1'].append(err_p_H1)\n\n    # 5. Compute average convergence rates\n    avg_rates = []\n    log2 = np.log(2.0)\n    for key in ['u_L2', 'p_L2', 'u_H1', 'p_H1']:\n        errs = errors[key]\n        rates = [np.log(errs[i] / errs[i+1]) / log2 for i in range(len(errs) - 1)]\n        avg_rates.append(np.mean(rates))\n\n    return avg_rates\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}