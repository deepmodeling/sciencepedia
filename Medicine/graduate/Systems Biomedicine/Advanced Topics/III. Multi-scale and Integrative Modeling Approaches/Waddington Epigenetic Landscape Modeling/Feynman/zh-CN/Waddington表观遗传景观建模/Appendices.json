{
    "hands_on_practices": [
        {
            "introduction": "独特的、稳定的细胞命运的存在是发育生物学的基石。本练习将探讨一个简单的基因回路——“拨动开关”——如何产生这种行为。通过从第一性原理出发进行线性稳定性分析，您将推导出该系统从单一稳定状态转变为两个不同稳定状态的精确条件，从而为沃丁顿景观中“山谷”的形成提供数学基础 。",
            "id": "4398469",
            "problem": "考虑一个用于在瓦丁顿（Waddington）表观遗传景观中模拟细胞命运决定的对称双基因拨动开关。设两种转录因子的浓度为 $x$ 和 $y$，并假设它们具有相同的希尔指数且相互抑制。其动力学由以下常微分方程（ODE）建模：\n$$\n\\dot{x} \\;=\\; \\frac{\\alpha}{1+y^{n}} \\;-\\; \\beta\\,x, \n\\qquad\n\\dot{y} \\;=\\; \\frac{\\alpha}{1+x^{n}} \\;-\\; \\beta\\,y,\n$$\n其中 $\\alpha>0$ 是最大合成速率，$\\beta>0$ 是线性降解速率，$n>0$ 是代表抑制协同性的希尔系数。在瓦丁顿表观遗传景观建模框架内，稳定吸引子对应于谷（细胞命运），而不稳定不动点对应于脊。在对称拨动开关中，当对称不动点失去稳定性并出现双阱景观时，便会产生具有两个不同谷的双稳态。\n\n从动力系统的不动点和线性稳定性的基本定义出发，且不使用任何快捷公式，确定对称不动点从稳定过渡到不稳定的确切参数条件。将您的最终答案表示为临界合成速率 $\\alpha_{\\mathrm{c}}$ 关于 $\\beta$ 和 $n$ 的闭式解析表达式。您的答案必须是单个表达式。如果您的表达式包含参数，请不要代入数值。无需四舍五入。",
            "solution": "该问题要求确定一个双基因拨动开关模型中对称不动点稳定性转变的参数条件。该条件需表示为临界合成速率 $\\alpha_{\\mathrm{c}}$ 作为降解速率 $\\beta$ 和希尔系数 $n$ 的函数。推导必须从第一性原理出发。\n\n系统动力学由以下常微分方程（ODE）组描述：\n$$\n\\dot{x} \\;=\\; \\frac{\\alpha}{1+y^{n}} \\;-\\; \\beta\\,x\n$$\n$$\n\\dot{y} \\;=\\; \\frac{\\alpha}{1+x^{n}} \\;-\\; \\beta\\,y\n$$\n其中 $x$ 和 $y$ 是两种转录因子的浓度。参数为最大合成速率 $\\alpha > 0$、降解速率 $\\beta > 0$ 和希尔系数 $n > 0$。\n\n首先，我们确定系统的对称不动点。不动点是一个状态 $(x^*, y^*)$，在该状态下 $\\dot{x}=0$ 且 $\\dot{y}=0$。对称不动点的特征是 $x^* = y^*$。我们将这个共同的浓度值表示为 $z^*$。将 $x = y = z^*$ 代入第一个 ODE 并将导数设为零，得到：\n$$\n0 \\;=\\; \\frac{\\alpha}{1+(z^*)^{n}} \\;-\\; \\beta\\,z^*\n$$\n该方程给出了不动点浓度 $z^*$ 与系统参数之间的关系：\n$$\n\\alpha \\;=\\; \\beta z^* (1 + (z^*)^n)\n$$\n\n接下来，我们进行线性稳定性分析，以确定该不动点在何种条件下是稳定的。稳定性由系统在不动点处求值的雅可比矩阵 $J$ 的特征值决定。雅可比矩阵定义为：\n$$\nJ(x,y) \\;=\\; \\begin{pmatrix} \\frac{\\partial \\dot{x}}{\\partial x} & \\frac{\\partial \\dot{x}}{\\partial y} \\\\ \\frac{\\partial \\dot{y}}{\\partial x} & \\frac{\\partial \\dot{y}}{\\partial y} \\end{pmatrix}\n$$\n所需的偏导数为：\n$$\n\\frac{\\partial \\dot{x}}{\\partial x} \\;=\\; \\frac{\\partial}{\\partial x} \\left( \\frac{\\alpha}{1+y^{n}} - \\beta x \\right) \\;=\\; -\\beta\n$$\n$$\n\\frac{\\partial \\dot{x}}{\\partial y} \\;=\\; \\frac{\\partial}{\\partial y} \\left( \\frac{\\alpha}{1+y^{n}} - \\beta x \\right) \\;=\\; -\\frac{\\alpha n y^{n-1}}{(1+y^n)^2}\n$$\n由于系统的对称性，我们有：\n$$\n\\frac{\\partial \\dot{y}}{\\partial y} \\;=\\; -\\beta\n$$\n$$\n\\frac{\\partial \\dot{y}}{\\partial x} \\;=\\; -\\frac{\\alpha n x^{n-1}}{(1+x^n)^2}\n$$\n在对称不动点 $(z^*, z^*)$ 处计算雅可比矩阵 $J$：\n$$\nJ^* \\;=\\; J(z^*, z^*) \\;=\\; \\begin{pmatrix} -\\beta & -\\frac{\\alpha n (z^*)^{n-1}}{(1+(z^*)^n)^2} \\\\ -\\frac{\\alpha n (z^*)^{n-1}}{(1+(z^*)^n)^2} & -\\beta \\end{pmatrix}\n$$\n让我们将非对角项表示为 $C$：\n$$\nC \\;=\\; -\\frac{\\alpha n (z^*)^{n-1}}{(1+(z^*)^n)^2}\n$$\n那么雅可比矩阵为 $J^* = \\begin{pmatrix} -\\beta & C \\\\ C & -\\beta \\end{pmatrix}$。该矩阵的特征值 $\\lambda$ 通过求解特征方程 $\\det(J^* - \\lambda I) = 0$ 得到：\n$$\n\\det \\begin{pmatrix} -\\beta - \\lambda & C \\\\ C & -\\beta - \\lambda \\end{pmatrix} \\;=\\; (-\\beta - \\lambda)^2 - C^2 \\;=\\; 0\n$$\n这得到 $(\\lambda + \\beta)^2 = C^2$，所以 $\\lambda + \\beta = \\pm C$。两个特征值为：\n$$\n\\lambda_1 \\;=\\; -\\beta + C \\quad \\text{和} \\quad \\lambda_2 \\;=\\; -\\beta - C\n$$\n如果一个不动点的所有特征值的实部都为负，则该不动点是稳定的。由于所有参数都是实数，因此特征值也是实数。由于 $\\alpha > 0$, $\\beta > 0$, $n > 0$ 且 $z^* > 0$，项 $C$ 严格为负。因此，$\\lambda_2 = -\\beta - C = -\\beta + |C|$ 且 $\\lambda_1 = -\\beta + C = -\\beta - |C|$。\n特征值 $\\lambda_1 = -\\beta - |C|$ 总是负的。因此，不动点的稳定性由 $\\lambda_2$ 的符号决定。\n如果 $\\lambda_2 < 0$，不动点是稳定的，这意味着 $-\\beta + |C| < 0$，或 $|C| < \\beta$。\n如果 $\\lambda_2 > 0$，不动点变得不稳定，这意味着 $|C| > \\beta$。\n从稳定不动点到不稳定不动点的转变，对应于此对称系统中的叉式分岔，恰好发生在 $\\lambda_2 = 0$ 时。此转变的条件是：\n$$\n|C| \\;=\\; \\beta\n$$\n代入 $C$ 的表达式：\n$$\n\\frac{\\alpha n (z^*)^{n-1}}{(1+(z^*)^n)^2} \\;=\\; \\beta\n$$\n该方程定义了分岔边界。为了仅用参数表示此条件，我们使用不动点方程 $\\alpha = \\beta z^* (1 + (z^*)^n)$ 来消去 $z^*$。将此代入分岔条件：\n$$\n\\frac{[\\beta z^* (1+(z^*)^n)] n (z^*)^{n-1}}{(1+(z^*)^n)^2} \\;=\\; \\beta\n$$\n对于 $\\beta > 0$，我们可以消去两边的 $\\beta$：\n$$\n\\frac{n (z^*)^n (1+(z^*)^n)}{(1+(z^*)^n)^2} \\;=\\; 1\n$$\n$$\n\\frac{n(z^*)^n}{1+(z^*)^n} \\;=\\; 1\n$$\n求解 $(z^*)^n$：\n$$\nn(z^*)^n \\;=\\; 1 + (z^*)^n \\quad \\implies \\quad (n-1)(z^*)^n \\;=\\; 1 \\quad \\implies \\quad (z^*)^n \\;=\\; \\frac{1}{n-1}\n$$\n该方程表明，在分岔点处，$z^*$ 的正实数解仅在 $n-1 > 0$ 时存在，即 $n>1$。这是众所周知的实现双稳态所需的协同性要求。\n分岔点处的浓度为 $z^* = \\left(\\frac{1}{n-1}\\right)^{1/n}$。\n\n临界合成速率 $\\alpha_c$ 是在该分岔点处的 $\\alpha$ 值。我们再次使用不动点关系式：\n$$\n\\alpha_c \\;=\\; \\beta z^* (1 + (z^*)^n)\n$$\n在分岔点处代入 $z^*$ 和 $(z^*)^n$ 的表达式：\n$$\n\\alpha_c \\;=\\; \\beta \\left(\\frac{1}{n-1}\\right)^{1/n} \\left(1 + \\frac{1}{n-1}\\right)\n$$\n化简括号中的第二项：\n$$\n1 + \\frac{1}{n-1} \\;=\\; \\frac{n-1+1}{n-1} \\;=\\; \\frac{n}{n-1}\n$$\n将此代回 $\\alpha_c$ 的表达式中：\n$$\n\\alpha_c \\;=\\; \\beta \\left(\\frac{n}{n-1}\\right) \\left(\\frac{1}{n-1}\\right)^{1/n}\n$$\n最后，我们合并包含 $n-1$ 的项以获得闭式表达式：\n$$\n\\alpha_c \\;=\\; \\frac{\\beta n}{(n-1)^{1} (n-1)^{1/n}} \\;=\\; \\frac{\\beta n}{(n-1)^{1+1/n}} \\;=\\; \\frac{\\beta n}{(n-1)^{(n+1)/n}}\n$$\n这是对称单稳态转变为双稳态时的临界合成速率的解析表达式。",
            "answer": "$$\n\\boxed{\\frac{\\beta n}{(n-1)^{(n+1)/n}}}\n$$"
        },
        {
            "introduction": "一旦细胞稳定在某个命运（景观中的一个吸引子），该状态在面对扰动时有多稳健？本练习引入“渠化强度”作为稳定性的定量度量。您将围绕一个给定的不动点对基因调控网络进行线性化，并利用所得雅可比矩阵的特征值来计算最弱的恢复力，从而量化吸引子盆地在其最浅方向上的“深度” 。",
            "id": "4398483",
            "problem": "考虑一个双基因的基因调控网络 (GRN)，它在一个 Waddington 表观遗传景观的背景下被建模为一个代表相互抑制的确定性常微分方程 (ODE) 系统。令状态向量为 $x = (x_{1}, x_{2})^{\\top}$，其中 $x_{i}$ 表示基因 $i$ 的信使 RNA (mRNA) 的拷贝数。其动力学由以下方程给出：\n$$\n\\frac{dx_{1}}{dt} = f_{1}(x_{1}, x_{2}) = \\frac{\\alpha_{1}}{1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}} - \\delta_{1} x_{1}, \\quad\n\\frac{dx_{2}}{dt} = f_{2}(x_{1}, x_{2}) = \\frac{\\alpha_{2}}{1 + \\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}}} - \\delta_{2} x_{2}.\n$$\n假设以下经验校准的参数，这些参数与 Waddington 表观遗传景观中的一个祖细胞吸引子一致：$\\alpha_{1} = \\alpha_{2} = 6.25$ (分子$\\cdot$小时$^{-1}$)，$\\delta_{1} = \\delta_{2} = 1$ (小时$^{-1}$)，$K_{12} = K_{21} = 10$ (分子)，$n_{12} = n_{21} = 2$，以及一个满足 $f(x^{\\ast}) = 0$ 的测量得到的固定点 $x^{\\ast} = (x_{1}^{\\ast}, x_{2}^{\\ast}) = (5, 5)$ (分子)。\n\n从固定点的定义和函数 $f$ 在 $x^{\\ast}$ 附近的多变量泰勒展开出发，将 $x^{\\ast}$ 附近的动力学线性化，以获得在 $x^{\\ast}$ 处求值的雅可比矩阵。然后，计算该雅可比矩阵的特征值，并用它们来确定该固定点在小扰动下的局部稳定性。将渠道化强度 $C$ 定义为最小的恢复速率，即\n$$\nC = \\min_{i:\\,\\Re(\\lambda_{i}) < 0} \\big(-\\Re(\\lambda_{i})\\big),\n$$\n其中 $\\lambda_{i}$ 是雅可比矩阵在 $x^{\\ast}$ 处的特征值，$\\Re(\\cdot)$ 表示实部。将 $C$ 解释为量化了 Waddington 表观遗传景观中将系统拉回吸引子的最弱局部拉力。请以 小时$^{-1}$ 为单位表示 $C$ 的最终答案，并将结果舍入到四位有效数字。",
            "solution": "问题要求计算一个双基因调控网络给定固定点的渠道化强度 $C$。该过程包括在指定的固定点周围线性化系统动力学，计算相应雅可比矩阵的特征值，然后应用给定的 $C$ 的定义。\n\n常微分方程 (ODE) 系统由以下公式给出：\n$$\n\\frac{dx_{1}}{dt} = f_{1}(x_{1}, x_{2}) = \\frac{\\alpha_{1}}{1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}} - \\delta_{1} x_{1}\n$$\n$$\n\\frac{dx_{2}}{dt} = f_{2}(x_{1}, x_{2}) = \\frac{\\alpha_{2}}{1 + \\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}}} - \\delta_{2} x_{2}\n$$\n提供的参数为：$\\alpha_{1} = \\alpha_{2} = 6.25$, $\\delta_{1} = \\delta_{2} = 1$, $K_{12} = K_{21} = 10$, $n_{12} = n_{21} = 2$。固定点为 $x^{\\ast} = (x_{1}^{\\ast}, x_{2}^{\\ast})^{\\top} = (5, 5)^{\\top}$。\n\n首先，我们通过计算雅可比矩阵 $J(x^{\\ast})$，在固定点 $x^{\\ast}$ 附近对系统进行线性化。雅可比矩阵 $J$ 是向量函数 $f = (f_1, f_2)^{\\top}$ 的所有一阶偏导数构成的矩阵：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f_{1}}{\\partial x_{1}} & \\frac{\\partial f_{1}}{\\partial x_{2}} \\\\ \\frac{\\partial f_{2}}{\\partial x_{1}} & \\frac{\\partial f_{2}}{\\partial x_{2}} \\end{pmatrix}\n$$\n我们计算雅可比矩阵的每个元素。\n\n对于对角线元素：\n$$\n\\frac{\\partial f_{1}}{\\partial x_{1}} = \\frac{\\partial}{\\partial x_{1}} \\left( \\frac{\\alpha_{1}}{1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}} - \\delta_{1} x_{1} \\right) = -\\delta_{1}\n$$\n$$\n\\frac{\\partial f_{2}}{\\partial x_{2}} = \\frac{\\partial}{\\partial x_{2}} \\left( \\frac{\\alpha_{2}}{1 + \\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}}} - \\delta_{2} x_{2} \\right) = -\\delta_{2}\n$$\n\n对于非对角线元素：\n$$\n\\frac{\\partial f_{1}}{\\partial x_{2}} = \\frac{\\partial}{\\partial x_{2}} \\left( \\alpha_{1} \\left(1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}\\right)^{-1} - \\delta_{1} x_{1} \\right) = -\\alpha_{1} \\left(1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}\\right)^{-2} \\cdot \\left( \\frac{n_{21} x_{2}^{n_{21}-1}}{K_{21}^{n_{21}}} \\right)\n$$\n$$\n\\frac{\\partial f_{1}}{\\partial x_{2}} = - \\frac{\\alpha_{1} n_{21}}{K_{21}} \\frac{\\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}-1}}{\\left(1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}\\right)^{2}}\n$$\n根据方程的对称性，另一个非对角线元素是：\n$$\n\\frac{\\partial f_{2}}{\\partial x_{1}} = - \\frac{\\alpha_{2} n_{12}}{K_{12}} \\frac{\\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}-1}}{\\left(1 + \\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}}\\right)^{2}}\n$$\n现在，我们使用给定的参数值，在固定点 $x^{\\ast}=(5, 5)$ 处计算雅可比矩阵的值：\n$J_{11} = -\\delta_{1} = -1$\n$J_{22} = -\\delta_{2} = -1$\n\n对于 $J_{12}$：\n$$\nJ_{12}(x^{\\ast}) = - \\frac{6.25 \\times 2}{10} \\frac{\\left(\\frac{5}{10}\\right)^{2-1}}{\\left(1 + \\left(\\frac{5}{10}\\right)^{2}\\right)^{2}} = -1.25 \\frac{0.5}{(1 + 0.5^2)^2} = -1.25 \\frac{0.5}{(1 + 0.25)^2} = -1.25 \\frac{0.5}{1.25^2} = - \\frac{0.5}{1.25} = -0.4\n$$\n由于问题的参数和固定点的对称性，$J_{21}(x^{\\ast}) = J_{12}(x^{\\ast}) = -0.4$。\n\n在固定点处求值的雅可比矩阵为：\n$$\nJ(x^{\\ast}) = \\begin{pmatrix} -1 & -0.4 \\\\ -0.4 & -1 \\end{pmatrix}\n$$\n接下来，我们通过求解特征方程 $\\det(J(x^{\\ast}) - \\lambda I) = 0$ 来找到 $J(x^{\\ast})$ 的特征值 $\\lambda$，其中 $I$ 是单位矩阵。\n$$\n\\det \\begin{pmatrix} -1-\\lambda & -0.4 \\\\ -0.4 & -1-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(-1-\\lambda)(-1-\\lambda) - (-0.4)(-0.4) = 0\n$$\n$$\n(\\lambda + 1)^{2} - 0.16 = 0\n$$\n$$\n(\\lambda + 1)^{2} = 0.16\n$$\n对两边取平方根，得到：\n$$\n\\lambda + 1 = \\pm\\sqrt{0.16} = \\pm 0.4\n$$\n这得到两个实数特征值：\n$$\n\\lambda_{1} = -1 + 0.4 = -0.6\n$$\n$$\n\\lambda_{2} = -1 - 0.4 = -1.4\n$$\n因为两个特征值都是负实数（$\\Re(\\lambda_{1}) = -0.6 < 0$ 且 $\\Re(\\lambda_{2}) = -1.4 < 0$），所以该固定点是一个稳定节点。这与它在 Waddington 景观中作为祖细胞吸引子的解释是一致的。\n\n渠道化强度 $C$ 被定义为最小的恢复速率：\n$$\nC = \\min_{i:\\,\\Re(\\lambda_{i}) < 0} \\big(-\\Re(\\lambda_{i})\\big)\n$$\n特征值的实部分别是 $\\Re(\\lambda_{1}) = -0.6$ 和 $\\Re(\\lambda_{2}) = -1.4$。恢复速率是这些实部的负值：\n$$\n-\\Re(\\lambda_{1}) = 0.6\n$$\n$$\n-\\Re(\\lambda_{2}) = 1.4\n$$\n渠道化强度 $C$ 是这些值中的最小值：\n$$\nC = \\min(0.6, 1.4) = 0.6\n$$\n雅可比矩阵元素的单位是 (浓度变化率) / (浓度)，即 (分子$\\cdot$小时$^{-1}$)/分子 = 小时$^{-1}$。因此，特征值和 $C$ 的单位是 小时$^{-1}$。\n\n问题要求最终答案舍入到四位有效数字。\n$$\nC = 0.6000 \\, \\text{小时}^{-1}\n$$\n这个值代表了最弱的局部恢复速率，它刻画了吸引盆在其最不稳定方向上的“浅度”。",
            "answer": "$$\\boxed{0.6000}$$"
        },
        {
            "introduction": "细胞状态的转变，如分化或重编程，并非确定性过程，而是由分子噪声驱动的随机过程。本计算练习让您能够在一个预定义的沃丁顿景观上直接模拟这些转变。通过实施欧拉-丸山方法，您将研究噪声如何促进细胞逃离一个命运盆地并进入另一个，并量化细胞工程中的一个基本权衡：达到新命运的速度与抵达正确目标的保真度之间的平衡 。",
            "id": "4398501",
            "problem": "考虑一个最小化的双基因瓦丁顿表观遗传学景观，该景观被建模为一个过阻尼随机梯度流，作用于一个支持三个细胞命运盆（一个起始命运、一个期望的目标命运和一个脱靶命运）的合成势上。状态是一个二维向量 $\\mathbf{z}(t) = (x(t), y(t))$。其动力学由伊藤诠释下的朗之万方程决定：\n$$\n\\frac{d\\mathbf{z}}{dt} = -\\nabla U(\\mathbf{z}) + \\sqrt{2\\varepsilon}\\,\\boldsymbol{\\xi}(t),\n$$\n其中 $U(\\mathbf{z})$ 是有效景观势，$\\varepsilon$ 是标量噪声强度，$\\boldsymbol{\\xi}(t)$ 是分量独立且单位方差的高斯白噪声。势 $U(\\mathbf{z})$ 被构建为代表起始、目标和脱靶命运的三个高斯势阱之和，外加一个弱的二次限制项：\n$$\nU(\\mathbf{z}) = k \\|\\mathbf{z}\\|^2 - \\sum_{i \\in \\{S,B,C\\}} A_i \\exp\\!\\left(-\\frac{\\|\\mathbf{z} - \\mathbf{z}_i\\|^2}{2\\sigma^2}\\right),\n$$\n中心点分别为 $\\mathbf{z}_S = (-1.2, 0.0)$、$\\mathbf{z}_B = (0.9, 0.9)$、$\\mathbf{z}_C = (0.9, -0.9)$，深度分别为 $A_S = 3.0$、$A_B = 6.0$、$A_C = 5.2$，高斯宽度 $\\sigma = 0.3$，限制系数 $k = 0.05$。初始条件为 $\\mathbf{z}(0) = \\mathbf{z}_S$，时间是无量纲的。\n\n您将使用欧拉-丸山格式，在步长为 $\\Delta t = 0.01$ 的固定时间网格上，对该随机微分方程进行数值模拟，直至最大时间 $T_{\\max} = 50.0$。设命中半径为 $r_{\\mathrm{hit}} = 0.25$。如果一条轨迹首次进入围绕目标 $\\mathbf{z}_B$ 或脱靶目标 $\\mathbf{z}_C$ 的半径为 $r_{\\mathrm{hit}}$ 的闭球内，则称该轨迹已到达一个命运。对于每个噪声强度 $\\varepsilon$ 和固定数量的独立轨迹 $N = 150$，定义以下量化指标：\n\n- 速度指标 $S(\\varepsilon)$：在时间 $T_{\\max}$ 内命中任一命运的轨迹的首次命中时间的中位数。如果在 $T_{\\max}$ 内没有轨迹命中任一命运，则设 $S(\\varepsilon) = T_{\\max}$。\n- 保真度指标 $F(\\varepsilon)$：在命中一个命运的轨迹中，命中目标命运 $\\mathbf{z}_B$ 的轨迹所占的比例，表示为 0 到 1 之间的小数。如果在 $T_{\\max}$ 内没有轨迹命中任一命运，则设 $F(\\varepsilon) = 0$。\n\n对噪声强度参数使用以下测试组：\n- $\\varepsilon = 0.0$（确定性边界），\n- $\\varepsilon = 0.02$（低噪声），\n- $\\varepsilon = 0.06$（中等噪声），\n- $\\varepsilon = 0.15$（高噪声）。\n\n所有模拟都必须使用固定的伪随机种子进行，以确保可复现性。您的程序应为上述系统实现欧拉-丸山离散化，并为测试组中的每个 $\\varepsilon$ 计算 $(S(\\varepsilon), F(\\varepsilon))$。时间是无量纲的，所有物理量都必须作为无量纲量处理。您的程序应生成单行输出，其中包含结果，格式为一个由四个数对组成的逗号分隔列表，每个数对本身是按 $[S(\\varepsilon),F(\\varepsilon)]$ 顺序排列的两个浮点数组成的逗号分隔列表，并用方括号括起来，例如：\n$$\n\\text{[}[S(\\varepsilon_1),F(\\varepsilon_1)],[S(\\varepsilon_2),F(\\varepsilon_2)],[S(\\varepsilon_3),F(\\varepsilon_3)],[S(\\varepsilon_4),F(\\varepsilon_4)]\\text{]}.\n$$\n每个测试用例的最终输出必须是浮点数，程序不得打印任何其他文本。",
            "solution": "该问题要求对一个模拟瓦丁顿景观中细胞命运决定的二维随机微分方程（SDE）进行数值模拟。解决方案的步骤是：首先推导运动方程的显式形式，然后实现一个合适的数值积分方案，最后根据模拟输出计算指定的统计指标。\n\n系统状态由向量 $\\mathbf{z}(t) = (x(t), y(t))$ 给出，其动力学由伊藤诠释下的过阻尼朗之万方程决定：\n$$\nd\\mathbf{z} = -\\nabla U(\\mathbf{z}) dt + \\sqrt{2\\varepsilon}\\,d\\mathbf{W}(t)\n$$\n其中 $\\mathbf{z}$ 是状态向量，$U(\\mathbf{z})$ 是势能景观，$\\varepsilon$ 是噪声强度，$d\\mathbf{W}(t)$ 表示一个矢量值维纳过程的增量，其分量是独立的高斯白噪声。\n\n势 $U(\\mathbf{z})$ 定义为：\n$$\nU(\\mathbf{z}) = k \\|\\mathbf{z}\\|^2 - \\sum_{i \\in \\{S,B,C\\}} A_i \\exp\\!\\left(-\\frac{\\|\\mathbf{z} - \\mathbf{z}_i\\|^2}{2\\sigma^2}\\right)\n$$\n第一步是计算势的梯度 $\\nabla U(\\mathbf{z})$，它定义了确定性力 $\\mathbf{F}(\\mathbf{z}) = -\\nabla U(\\mathbf{z})$。使用标准矢量微积分，梯度计算如下：\n$$\n\\nabla U(\\mathbf{z}) = \\nabla \\left(k \\|\\mathbf{z}\\|^2\\right) - \\sum_{i \\in \\{S,B,C\\}} \\nabla \\left( A_i \\exp\\!\\left(-\\frac{\\|\\mathbf{z} - \\mathbf{z}_i\\|^2}{2\\sigma^2}\\right) \\right)\n$$\n$$\n\\nabla U(\\mathbf{z}) = 2k\\mathbf{z} + \\frac{1}{\\sigma^2} \\sum_{i \\in \\{S,B,C\\}} A_i (\\mathbf{z} - \\mathbf{z}_i) \\exp\\left(-\\frac{\\|\\mathbf{z} - \\mathbf{z}_i\\|^2}{2\\sigma^2}\\right)\n$$\n该SDE使用欧拉-丸山方法进行数值求解，这是随机积分器的标准格式。从时间步 $n$ 的状态向量 $\\mathbf{z}_n$ 到时间步 $n+1$ 的状态向量 $\\mathbf{z}_{n+1}$ 的离散更新规则如下：\n$$\n\\mathbf{z}_{n+1} = \\mathbf{z}_n - \\nabla U(\\mathbf{z}_n)\\Delta t + \\sqrt{2\\varepsilon\\Delta t}\\,\\boldsymbol{\\eta}_n\n$$\n此处，$\\Delta t$ 是时间步长，$\\boldsymbol{\\eta}_n$ 是一个二维随机向量，其分量是从标准正态分布 $N(0,1)$ 中抽取的独立随机变量。该方程构成了模拟的核心。\n\n整体模拟算法结构如下。对于测试组 $\\{0.0, 0.02, 0.06, 0.15\\}$ 中的每个指定噪声水平 $\\varepsilon$：\n1. 初始化两个空列表，一个用于存储成功轨迹的首次命中时间，另一个用于存储命中了哪个命运（“B”或“C”）。\n2. 对于 $N=150$ 条独立轨迹中的每一条：\n    a. 设置初始条件 $\\mathbf{z}(0) = \\mathbf{z}_S = (-1.2, 0.0)$。\n    b. 从 $t=0$ 到 $T_{\\max}=50.0$ 以 $\\Delta t=0.01$ 的步长进行时间迭代。\n    c. 在每一步中，使用上面推导的欧拉-丸山规则更新位置向量 $\\mathbf{z}$。使用固定的伪随机种子以确保随机数序列 $\\boldsymbol{\\eta}_n$ 是可复现的。\n    d. 每次更新后，检查新位置 $\\mathbf{z}$ 是否已进入目标命运 $\\mathbf{z}_B = (0.9, 0.9)$ 或脱靶命运 $\\mathbf{z}_C = (0.9, -0.9)$ 的命中区域。如果 $\\|\\mathbf{z} - \\mathbf{z}_B\\| \\le r_{\\mathrm{hit}}$ 或 $\\|\\mathbf{z} - \\mathbf{z}_C\\| \\le r_{\\mathrm{hit}}$，则记录一次命中，其中命中半径为 $r_{\\mathrm{hit}} = 0.25$。\n    e. 如果发生命中，当前时间被记录为首次命中时间，并记下相应的命运，然后终止该轨迹的模拟。\n    f. 如果轨迹在时间 $t$ 到达 $T_{\\max}$ 之前没有命中任何命运，则不将其计入命中统计。\n\n3. 在给定 $\\varepsilon$ 的所有 $N$ 条轨迹模拟完毕后，计算指定的指标：\n    - **速度 $S(\\varepsilon)$**：如果有任何轨迹命中了一个命运，$S(\\varepsilon)$ 是收集到的命中时间的中位数。如果没有轨迹命中，则将 $S(\\varepsilon)$ 设置为 $T_{\\max}$，即 $50.0$。\n    - **保真度 $F(\\varepsilon)$**：如果有任何轨迹命中了一个命运，$F(\\varepsilon)$ 是命中目标命运 $\\mathbf{z}_B$ 的轨迹数与命中任一命运的总轨迹数之比。如果没有轨迹命中，则将 $F(\\varepsilon)$ 设置为 $0.0$。\n\n对测试组中的每个 $\\varepsilon$ 值重复整个过程。实现使用了 `numpy` 库来进行高效的矢量化操作。最终结果是一个包含每个 $\\varepsilon$ 对应的数对 $[S(\\varepsilon), F(\\varepsilon)]$ 的列表。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates cell fate transitions on a Waddington landscape and computes\n    speed and fidelity metrics for different noise levels.\n    \"\"\"\n    # Set a fixed seed for reproducibility as required by the problem\n    np.random.seed(42)\n\n    # --- Problem Parameters ---\n    # Potential parameters\n    k = 0.05\n    sigma = 0.3\n    sigma_sq = sigma**2\n    z_S = np.array([-1.2, 0.0])\n    z_B = np.array([0.9, 0.9])\n    z_C = np.array([0.9, -0.9])\n    A_S = 3.0\n    A_B = 6.0\n    A_C = 5.2\n\n    # Simulation parameters\n    dt = 0.01\n    T_max = 50.0\n    N = 150  # Number of trajectories\n\n    # Hitting criteria\n    r_hit = 0.25\n    r_hit_sq = r_hit**2\n\n    # Test cases for the noise strength parameter\n    test_cases = [0.0, 0.02, 0.06, 0.15]\n\n    def grad_U(z):\n        \"\"\"\n        Computes the gradient of the potential U at a given position z.\n        The parameters of the potential are taken from the enclosing scope.\n        \"\"\"\n        grad = 2 * k * z\n        \n        # Contribution from well S\n        diff_S = z - z_S\n        sq_dist_S = np.dot(diff_S, diff_S)\n        exp_S = np.exp(-sq_dist_S / (2 * sigma_sq))\n        grad += (A_S / sigma_sq) * exp_S * diff_S\n        \n        # Contribution from well B\n        diff_B = z - z_B\n        sq_dist_B = np.dot(diff_B, diff_B)\n        exp_B = np.exp(-sq_dist_B / (2 * sigma_sq))\n        grad += (A_B / sigma_sq) * exp_B * diff_B\n\n        # Contribution from well C\n        diff_C = z - z_C\n        sq_dist_C = np.dot(diff_C, diff_C)\n        exp_C = np.exp(-sq_dist_C / (2 * sigma_sq))\n        grad += (A_C / sigma_sq) * exp_C * diff_C\n        \n        return grad\n\n    results = []\n    # Loop over each noise strength\n    for epsilon in test_cases:\n        hitting_times = []\n        hit_fates = []\n        \n        noise_magnitude = np.sqrt(2 * epsilon * dt)\n        \n        # Run N independent trajectories\n        for _ in range(N):\n            z = z_S.copy()\n            num_steps = int(T_max / dt)\n            \n            for i in range(num_steps):\n                # Calculate deterministic force component\n                force_dt = -grad_U(z) * dt\n                \n                # Calculate stochastic displacement component\n                if epsilon > 0:\n                    random_displacement = noise_magnitude * np.random.randn(2)\n                else:\n                    random_displacement = np.array([0.0, 0.0])\n                \n                # Update position using Euler-Maruyama step\n                z += force_dt + random_displacement\n                \n                # Check for hitting a fate\n                if np.sum((z - z_B)**2) = r_hit_sq:\n                    hit_time = (i + 1) * dt\n                    hitting_times.append(hit_time)\n                    hit_fates.append('B')\n                    break  # End this trajectory\n                \n                if np.sum((z - z_C)**2) = r_hit_sq:\n                    hit_time = (i + 1) * dt\n                    hitting_times.append(hit_time)\n                    hit_fates.append('C')\n                    break  # End this trajectory\n        \n        # --- Calculate metrics for this epsilon ---\n        num_hits = len(hitting_times)\n        \n        if num_hits == 0:\n            speed_metric = T_max\n            fidelity_metric = 0.0\n        else:\n            # Speed metric: median of hitting times for successful trajectories\n            speed_metric = np.median(hitting_times)\n            \n            # Fidelity metric: fraction of successful hits that reached target B\n            num_hits_B = hit_fates.count('B')\n            fidelity_metric = num_hits_B / num_hits\n\n        results.append([float(speed_metric), float(fidelity_metric)])\n\n    # Format and print the final output as a single line\n    print(f\"[[{results[0][0]},{results[0][1]}],[{results[1][0]},{results[1][1]}],[{results[2][0]},{results[2][1]}],[{results[3][0]},{results[3][1]}]\")\n\nsolve()\n```"
        }
    ]
}