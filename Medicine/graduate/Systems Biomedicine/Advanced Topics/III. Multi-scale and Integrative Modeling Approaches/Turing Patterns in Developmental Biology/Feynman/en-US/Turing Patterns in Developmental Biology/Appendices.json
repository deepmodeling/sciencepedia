{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing any dynamical system, including those that form biological patterns, is to find its points of equilibrium. In a reaction-diffusion system, the most fundamental equilibrium is a spatially uniform steady state, where concentrations remain constant in both time and space. This practice  lays the groundwork for all further analysis by guiding you through the calculation of this homogeneous steady state and the linearization of the system's dynamics around it using the Jacobian matrix.",
            "id": "4396888",
            "problem": "Consider a classical reaction–diffusion model for developmental pattern formation with two interacting chemical species, an activator $u(x,t)$ and an inhibitor $v(x,t)$, on a one-dimensional tissue of length $L$. The dynamics are governed by the mass-balance form\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; D_u\\,\\frac{\\partial^2 u}{\\partial x^2} \\;+\\; f(u,v), \n\\qquad\n\\frac{\\partial v}{\\partial t} \\;=\\; D_v\\,\\frac{\\partial^2 v}{\\partial x^2} \\;+\\; g(u,v),\n$$\nwhere $D_u$ and $D_v$ are positive diffusion coefficients and $f(u,v)$, $g(u,v)$ encode local reaction kinetics. Assume Schnakenberg kinetics, defined by the well-tested activator–inhibitor rates\n$$\nf(u,v) \\;=\\; a \\;-\\; u \\;+\\; u^{2}\\,v,\n\\qquad\ng(u,v) \\;=\\; b \\;-\\; u^{2}\\,v,\n$$\nwith $a0$ and $b0$ constants reflecting feed rates. A homogeneous steady state $(u_0,v_0)$ is any constant pair $u(x,t)\\equiv u_0$, $v(x,t)\\equiv v_0$ that satisfies the reaction balance in the absence of transport, namely $f(u_0,v_0)=0$ and $g(u_0,v_0)=0$. The linearized kinetics near $(u_0,v_0)$ are captured by the Jacobian matrix\n$$\nJ(u_0,v_0) \\;=\\; \n\\begin{pmatrix}\nf_u(u_0,v_0)  f_v(u_0,v_0) \\\\\ng_u(u_0,v_0)  g_v(u_0,v_0)\n\\end{pmatrix},\n$$\nwhere $f_u=\\frac{\\partial f}{\\partial u}$, $f_v=\\frac{\\partial f}{\\partial v}$, $g_u=\\frac{\\partial g}{\\partial u}$, and $g_v=\\frac{\\partial g}{\\partial v}$.\n\nStarting from the above definitions and the mass-balance principle, determine the homogeneous steady state $(u_0,v_0)$ in terms of $a$ and $b$, and compute the Jacobian entries $f_u(u_0,v_0)$, $f_v(u_0,v_0)$, $g_u(u_0,v_0)$, and $g_v(u_0,v_0)$ at that steady state. Express your final answer as a single row matrix containing the six quantities in the order\n$$\n(u_0,\\; v_0,\\; f_u(u_0,v_0),\\; f_v(u_0,v_0),\\; g_u(u_0,v_0),\\; g_v(u_0,v_0)).\n$$\nProvide an exact analytic expression; no numerical approximation or rounding is required, and do not include units in your final expression.",
            "solution": "The problem is first validated.\n\n**Step 1: Extract Givens**\n- Reaction-diffusion system:\n  $$ \\frac{\\partial u}{\\partial t} = D_u\\,\\frac{\\partial^2 u}{\\partial x^2} + f(u,v) $$\n  $$ \\frac{\\partial v}{\\partial t} = D_v\\,\\frac{\\partial^2 v}{\\partial x^2} + g(u,v) $$\n- Species: activator $u(x,t)$, inhibitor $v(x,t)$.\n- Domain: one-dimensional, length $L$.\n- Diffusion coefficients: $D_u  0$ and $D_v  0$.\n- Reaction kinetics (Schnakenberg):\n  $$ f(u,v) = a - u + u^{2}v $$\n  $$ g(u,v) = b - u^{2}v $$\n- Constants: $a  0$ and $b  0$.\n- Homogeneous steady state $(u_0, v_0)$: A constant solution where $f(u_0, v_0) = 0$ and $g(u_0, v_0) = 0$.\n- Jacobian matrix:\n  $$\n  J(u_0,v_0) =\n  \\begin{pmatrix}\n  f_u(u_0,v_0)  f_v(u_0,v_0) \\\\\n  g_u(u_0,v_0)  g_v(u_0,v_0)\n  \\end{pmatrix}\n  $$\n  where $f_u = \\frac{\\partial f}{\\partial u}$, $f_v = \\frac{\\partial f}{\\partial v}$, $g_u = \\frac{\\partial g}{\\partial u}$, and $g_v = \\frac{\\partial g}{\\partial v}$.\n- Task: Determine the six quantities $(u_0, v_0, f_u(u_0,v_0), f_v(u_0,v_0), g_u(u_0,v_0), g_v(u_0,v_0))$ and express them as a single row matrix.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded:** The problem describes the Schnakenberg model, a classic and well-established reaction-diffusion system used to study pattern formation (Turing patterns). The entire formulation is standard in mathematical biology and systems biomedicine.\n- **Well-Posed:** The problem is well-posed. It asks for the algebraic solution of a system of two nonlinear equations to find the steady state, followed by the computation of partial derivatives and their evaluation at that state. The definitions and goals are precise, leading to a unique analytical solution.\n- **Objective:** The problem statement is formal and quantitative, utilizing precise mathematical definitions without any subjectivity or ambiguity.\n\nThe problem does not exhibit any of the listed flaws. It is scientifically sound, formally complete, internally consistent, and requires a standard analytical derivation central to the study of such systems.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. The solution will now be derived.\n\nThe first step is to determine the homogeneous steady state $(u_0, v_0)$ by solving the system of algebraic equations defined by the reaction kinetics being at equilibrium, i.e., $f(u_0, v_0) = 0$ and $g(u_0, v_0) = 0$.\nThe equations are:\n$$ a - u_0 + u_0^{2}v_0 = 0 \\quad (1) $$\n$$ b - u_0^{2}v_0 = 0 \\quad (2) $$\nFrom equation $(2)$, we can express the term $u_0^{2}v_0$ directly:\n$$ u_0^{2}v_0 = b $$\nSince the problem states $b  0$ and concentrations $u_0, v_0$ must be non-negative, it follows that $u_0 \\neq 0$.\nNow, substitute this result into equation $(1)$:\n$$ a - u_0 + b = 0 $$\nSolving for $u_0$ yields the steady-state concentration of the activator:\n$$ u_0 = a + b $$\nTo find $v_0$, we substitute the expression for $u_0$ back into the relation from equation $(2)$, $u_0^{2}v_0 = b$:\n$$ (a+b)^{2}v_0 = b $$\nSolving for $v_0$ gives the steady-state concentration of the inhibitor:\n$$ v_0 = \\frac{b}{(a+b)^{2}} $$\nThus, the unique homogeneous steady state is $(u_0, v_0) = (a+b, \\frac{b}{(a+b)^{2}})$.\n\nThe next step is to compute the entries of the Jacobian matrix, which requires calculating the partial derivatives of $f(u,v)$ and $g(u,v)$.\nThe reaction kinetics are:\n$$ f(u,v) = a - u + u^{2}v $$\n$$ g(u,v) = b - u^{2}v $$\nThe partial derivatives with respect to $u$ and $v$ are:\n$$ f_u = \\frac{\\partial f}{\\partial u} = -1 + 2uv $$\n$$ f_v = \\frac{\\partial f}{\\partial v} = u^{2} $$\n$$ g_u = \\frac{\\partial g}{\\partial u} = -2uv $$\n$$ g_v = \\frac{\\partial g}{\\partial v} = -u^{2} $$\nNow, we evaluate these partial derivatives at the steady state $(u_0, v_0)$. Let's first evaluate the product $u_0v_0$, which appears in both $f_u$ and $g_u$:\n$$ u_0v_0 = (a+b) \\left( \\frac{b}{(a+b)^{2}} \\right) = \\frac{b}{a+b} $$\nUsing this intermediate result, we can compute each Jacobian entry:\n$$ f_u(u_0,v_0) = -1 + 2u_0v_0 = -1 + 2\\left(\\frac{b}{a+b}\\right) = \\frac{-(a+b) + 2b}{a+b} = \\frac{b-a}{a+b} $$\n$$ f_v(u_0,v_0) = u_0^{2} = (a+b)^{2} $$\n$$ g_u(u_0,v_0) = -2u_0v_0 = -2\\left(\\frac{b}{a+b}\\right) = -\\frac{2b}{a+b} $$\n$$ g_v(u_0,v_0) = -u_0^{2} = -(a+b)^{2} $$\nThe six quantities required are:\n1.  $u_0 = a+b$\n2.  $v_0 = \\frac{b}{(a+b)^{2}}$\n3.  $f_u(u_0,v_0) = \\frac{b-a}{a+b}$\n4.  $f_v(u_0,v_0) = (a+b)^{2}$\n5.  $g_u(u_0,v_0) = -\\frac{2b}{a+b}$\n6.  $g_v(u_0,v_0) = -(a+b)^{2}$\n\nThese quantities are arranged in a row matrix as requested for the final answer.",
            "answer": "$$ \\boxed{\\begin{pmatrix} a+b  \\frac{b}{(a+b)^{2}}  \\frac{b-a}{a+b}  (a+b)^{2}  -\\frac{2b}{a+b}  -(a+b)^{2} \\end{pmatrix}} $$"
        },
        {
            "introduction": "Once a system's homogeneous steady state is known, the central question becomes: is this uniform state stable? Alan Turing's groundbreaking insight was that diffusion, an ordinarily homogenizing force, can paradoxically destabilize a steady state that is otherwise stable. This practice  walks you through the complete linear stability analysis required to test for this diffusion-driven instability, applying the theoretical machinery to a concrete set of parameters to determine if Turing patterns will emerge.",
            "id": "4396936",
            "problem": "Consider the nondimensional two-species reaction-diffusion system known as the Schnakenberg model on a homogeneous two-dimensional tissue:\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; D_u \\nabla^2 u \\;+\\; a \\;-\\; u \\;+\\; u^2 v, \n\\qquad\n\\frac{\\partial v}{\\partial t} \\;=\\; D_v \\nabla^2 v \\;+\\; b \\;-\\; u^2 v,\n$$\nwhere $u$ and $v$ are the concentrations of two interacting morphogens, $D_u$ and $D_v$ are their diffusivities, and $a$ and $b$ are positive feed parameters. Take $a=0.2$, $b=1.2$, $D_u=1$, and $D_v=16$. \n\nStarting from the definition of diffusion-driven instability underlying Turing pattern formation, use first-principles linear stability analysis of spatially homogeneous perturbations and spatial Fourier modes to:\n\n- Derive the homogeneous steady state $(u^\\ast,v^\\ast)$ by solving the reaction terms at stationarity.\n- Linearize the reaction kinetics about $(u^\\ast,v^\\ast)$ and write the Jacobian matrix entries $f_u$, $f_v$, $g_u$, and $g_v$ of the local reaction terms $f(u,v)=a-u+u^2 v$ and $g(u,v)=b-u^2 v$ evaluated at $(u^\\ast,v^\\ast)$.\n- For a spatial Fourier mode of wavenumber magnitude $k$, express the $k$-dependent linearized operator as $J - k^2 \\mathrm{diag}(D_u,D_v)$, and from it obtain the $k$-dependent trace $\\tau(k)$ and determinant $\\Delta(k)$ of the linearized system.\n- Use the fundamental stability criteria for a $2\\times 2$ linear system to state the conditions that the homogeneous steady state is linearly stable in the absence of diffusion ($k=0$) and the additional conditions required for diffusion-driven instability to occur for some $k0$ (Turing instability).\n\nCompute the quantity\n$$\n\\Delta_{\\mathrm{T}} \\;=\\; \\left(f_u D_v + g_v D_u\\right)^2 \\;-\\; 4\\,D_u D_v\\,\\left(f_u g_v - f_v g_u\\right),\n$$\nevaluate it numerically for the given parameters, and use its sign together with the $k=0$ criteria to decide whether the homogeneous steady state is stable at $k=0$ but unstable for some $k0$. Report the value of $\\Delta_{\\mathrm{T}}$ rounded to four significant figures. No units are required because the model is nondimensional.",
            "solution": "The Schnakenberg reaction-diffusion model is given by\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; D_u \\nabla^2 u \\;+\\; f(u,v), \n\\qquad\n\\frac{\\partial v}{\\partial t} \\;=\\; D_v \\nabla^2 v \\;+\\; g(u,v),\n$$\nwith $f(u,v)=a-u+u^2 v$ and $g(u,v)=b-u^2 v$. A spatially homogeneous steady state $(u^\\ast,v^\\ast)$ satisfies $f(u^\\ast,v^\\ast)=0$ and $g(u^\\ast,v^\\ast)=0$.\n\nSolving $g(u^\\ast,v^\\ast)=0$ gives $b = (u^\\ast)^2 v^\\ast$. Substituting into $f(u^\\ast,v^\\ast)=0$ yields $a - u^\\ast + (u^\\ast)^2 v^\\ast = a - u^\\ast + b = 0$, hence\n$$\nu^\\ast \\;=\\; a+b, \n\\qquad\nv^\\ast \\;=\\; \\frac{b}{(u^\\ast)^2} \\;=\\; \\frac{b}{(a+b)^2}.\n$$\nFor $a=0.2$ and $b=1.2$,\n$$\nu^\\ast \\;=\\; 0.2+1.2 \\;=\\; 1.4 \\;=\\; \\frac{7}{5}, \n\\qquad\nv^\\ast \\;=\\; \\frac{1.2}{(1.4)^2} \\;=\\; \\frac{1.2}{1.96} \\;=\\; \\frac{30}{49}.\n$$\nIt is convenient to note $u^\\ast v^\\ast = \\dfrac{b}{a+b} = \\dfrac{1.2}{1.4} = \\dfrac{6}{7}$.\n\nThe Jacobian of the reaction kinetics evaluated at $(u^\\ast,v^\\ast)$ has entries\n$$\nf_u \\;=\\; \\frac{\\partial f}{\\partial u}\\bigg|_{(u^\\ast,v^\\ast)} \\;=\\; -1 + 2 u^\\ast v^\\ast, \n\\qquad\nf_v \\;=\\; \\frac{\\partial f}{\\partial v}\\bigg|_{(u^\\ast,v^\\ast)} \\;=\\; (u^\\ast)^2,\n$$\n$$\ng_u \\;=\\; \\frac{\\partial g}{\\partial u}\\bigg|_{(u^\\ast,v^\\ast)} \\;=\\; -2 u^\\ast v^\\ast, \n\\qquad\ng_v \\;=\\; \\frac{\\partial g}{\\partial v}\\bigg|_{(u^\\ast,v^\\ast)} \\;=\\; -(u^\\ast)^2.\n$$\nUsing $u^\\ast v^\\ast = \\dfrac{6}{7}$ and $(u^\\ast)^2 = \\left(\\dfrac{7}{5}\\right)^2 = \\dfrac{49}{25}$, we obtain\n$$\nf_u \\;=\\; -1 + 2\\cdot\\frac{6}{7} \\;=\\; \\frac{5}{7}, \n\\quad\nf_v \\;=\\; \\frac{49}{25}, \n\\quad\ng_u \\;=\\; -2\\cdot\\frac{6}{7} \\;=\\; -\\frac{12}{7}, \n\\quad\ng_v \\;=\\; -\\frac{49}{25}.\n$$\n\nTo analyze stability of spatial Fourier modes, consider perturbations proportional to $\\exp(\\lambda t + i \\mathbf{k}\\cdot \\mathbf{x})$ of wavenumber magnitude $k=|\\mathbf{k}|$. The diffusion terms contribute $-D_u k^2$ and $-D_v k^2$ on the diagonal. The $k$-dependent linearized operator is\n$$\nA(k) \\;=\\; \n\\begin{pmatrix}\nf_u  f_v \\\\\ng_u  g_v\n\\end{pmatrix}\n\\;-\\;\n\\begin{pmatrix}\nD_u  0 \\\\\n0  D_v\n\\end{pmatrix}\nk^2.\n$$\nThe characteristic polynomial is\n$$\n\\lambda^2 \\;-\\; \\tau(k)\\,\\lambda \\;+\\; \\Delta(k) \\;=\\; 0,\n$$\nwith\n$$\n\\tau(k) \\;=\\; f_u + g_v \\;-\\; (D_u + D_v)\\,k^2,\n\\qquad\n\\Delta(k) \\;=\\; f_u g_v - f_v g_u \\;-\\; \\big(f_u D_v + g_v D_u\\big)\\,k^2 \\;+\\; D_u D_v\\,k^4.\n$$\nFor a $2\\times 2$ real system, linear stability requires $\\tau(k)  0$ and $\\Delta(k)  0$. A diffusion-driven (Turing) instability occurs when the homogeneous steady state is stable at $k=0$ yet unstable for some $k0$. Since $\\tau(k)$ is strictly decreasing in $k^2$ when $D_u+D_v0$, if $\\tau(0)  0$, then $\\tau(k)  0$ for all $k0$, and loss of stability can only occur via $\\Delta(k)$ becoming negative for some $k0$. Writing\n$$\n\\Delta(k) \\;=\\; \\Delta_0 \\;-\\; m\\,k^2 \\;+\\; p\\,k^4,\n$$\nwhere\n$$\n\\Delta_0 \\;=\\; f_u g_v - f_v g_u, \n\\qquad\nm \\;=\\; f_u D_v + g_v D_u, \n\\qquad\np \\;=\\; D_u D_v,\n$$\none sees that $\\Delta(k)$ is a quadratic in $k^2$ opening upward. For an interval of $k^20$ where $\\Delta(k)0$ to exist, it is necessary that $\\Delta_00$, $m0$, and the discriminant\n$$\n\\Delta_{\\mathrm{T}} \\;=\\; m^2 \\;-\\; 4 p \\Delta_0\n$$\nbe strictly positive; the unstable band then lies between the positive roots $k^2_{\\pm} = \\dfrac{m \\pm \\sqrt{\\Delta_{\\mathrm{T}}}}{2p}$. In addition, stability at $k=0$ requires\n$$\n\\tau(0) \\;=\\; f_u + g_v \\;\\; 0, \n\\qquad \n\\Delta_0 \\;\\; 0.\n$$\n\nWe now evaluate these quantities for the given parameters $D_u=1$ and $D_v=16$. First, the $k=0$ criteria:\n$$\n\\tau(0) \\;=\\; f_u + g_v \\;=\\; \\frac{5}{7} - \\frac{49}{25} \\;=\\; \\frac{125 - 343}{175} \\;=\\; -\\frac{218}{175} \\;\\; 0,\n$$\n$$\n\\Delta_0 \\;=\\; f_u g_v - f_v g_u \\;=\\; \\frac{5}{7}\\left(-\\frac{49}{25}\\right) - \\frac{49}{25}\\left(-\\frac{12}{7}\\right) \\;=\\; -\\frac{7}{5} + \\frac{84}{25} \\;=\\; \\frac{49}{25} \\;\\; 0.\n$$\nThus, the homogeneous steady state is linearly stable in the absence of diffusion ($k=0$). Next, compute the coefficients governing the $k$-dependence:\n$$\nm \\;=\\; f_u D_v + g_v D_u \\;=\\; \\frac{5}{7}\\cdot 16 \\;+\\; \\left(-\\frac{49}{25}\\right)\\cdot 1 \\;=\\; \\frac{80}{7} - \\frac{49}{25} \\;=\\; \\frac{2000 - 343}{175} = \\frac{1657}{175} \\;\\; 0,\n$$\n$$\np \\;=\\; D_u D_v \\;=\\; 1\\cdot 16 \\;=\\; 16.\n$$\nTherefore, the Turing discriminant is\n$$\n\\Delta_{\\mathrm{T}} \\;=\\; m^2 - 4 p \\Delta_0 \n\\;=\\; \\left(\\frac{1657}{175}\\right)^2 \\;-\\; 4\\cdot 16 \\cdot \\frac{49}{25}\n\\;=\\; \\frac{2{,}745{,}649}{30{,}625} \\;-\\; \\frac{3{,}136 \\cdot 1225}{30{,}625}\n\\;=\\; \\frac{2{,}745{,}649 - 3{,}841{,}600}{30{,}625}\n\\;=\\; -\\frac{1{,}095{,}951}{30{,}625}.\n$$\nNumerically,\n$$\n\\Delta_{\\mathrm{T}} \\;\\approx\\; -35.786155102\\ldots\n$$\nRounded to four significant figures,\n$$\n\\Delta_{\\mathrm{T}} \\;\\approx\\; -35.79.\n$$\n\nBecause $\\tau(0)  0$ and $\\Delta_0  0$, the steady state is linearly stable at $k=0$. Since $\\Delta_{\\mathrm{T}}  0$, the quadratic $\\Delta(k)$ has no positive real roots in $k^2$, and thus $\\Delta(k)  0$ for all $k\\ge 0$; the steady state remains stable for all spatial wavenumbers and no diffusion-driven (Turing) instability occurs for the given parameters.",
            "answer": "$$\\boxed{-35.79}$$"
        },
        {
            "introduction": "While linear analysis predicts whether patterns can form, observing their development requires solving the governing equations numerically. This computational practice  bridges the gap from theory to application, challenging you to implement and analyze a modern numerical method for simulating reaction-diffusion systems. You will grapple with the crucial concepts of numerical stability and efficiency, essential skills for any computational systems biologist.",
            "id": "4396910",
            "problem": "Consider a one-dimensional, periodic reaction–diffusion system for two interacting morphogens that can produce Turing patterns in developmental biology. Let the concentrations be $u(x,t)$ and $v(x,t)$ on a domain of length $L$ with periodic boundary conditions, and let the dynamics be governed by\n$$\n\\frac{\\partial u}{\\partial t} = f(u,v) + D_u \\frac{\\partial^2 u}{\\partial x^2}, \\quad \\frac{\\partial v}{\\partial t} = g(u,v) + D_v \\frac{\\partial^2 v}{\\partial x^2},\n$$\nwhere $D_u$ and $D_v$ are diffusion coefficients and $(f,g)$ is the reaction term. Use the Schnakenberg kinetics, a widely used activator–inhibitor model for Turing pattern analysis:\n$$\nf(u,v) = a - u + u^2 v, \\quad g(u,v) = b - u^2 v,\n$$\nwith parameters $a0$, $b0$. The spatially homogeneous steady state $(u^\\ast,v^\\ast)$ satisfies\n$$\nu^\\ast = a + b, \\quad v^\\ast = \\frac{b}{(a+b)^2}.\n$$\nLinearize the system about $(u^\\ast,v^\\ast)$ to obtain\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix}\n\\tilde u \\\\ \\tilde v\n\\end{pmatrix}\n=\nJ\n\\begin{pmatrix}\n\\tilde u \\\\ \\tilde v\n\\end{pmatrix}\n+\nD \\frac{\\partial^2}{\\partial x^2}\n\\begin{pmatrix}\n\\tilde u \\\\ \\tilde v\n\\end{pmatrix},\n$$\nwhere $\\tilde u=u-u^\\ast$, $\\tilde v=v-v^\\ast$, $J$ is the Jacobian matrix of $(f,g)$ evaluated at $(u^\\ast,v^\\ast)$, and $D=\\mathrm{diag}(D_u,D_v)$. Applying the Discrete Fourier Transform (DFT) on a grid with $N$ equally spaced points yields independent linear ordinary differential equations for each wavenumber $k$, where the Laplacian acts as multiplication by $-k^2$. Denote by $\\mathbf{U}_k(t)$ the Fourier mode vector for wavenumber $k$. Then\n$$\n\\frac{d}{dt}\\mathbf{U}_k(t) = \\left(J - k^2 D\\right)\\mathbf{U}_k(t).\n$$\n\nYou are asked to implement a semi-implicit spectral time-stepping method that treats diffusion implicitly and reactions explicitly. For a single time step of size $\\Delta t$, this method updates each mode by solving\n$$\n\\left(I + \\Delta t\\, k^2 D\\right)\\,\\mathbf{U}_k^{n+1} = \\mathbf{U}_k^n + \\Delta t\\, J\\,\\mathbf{U}_k^n,\n$$\nso that\n$$\n\\mathbf{U}_k^{n+1} = \\underbrace{\\left(I + \\Delta t\\, k^2 D\\right)^{-1}\\left(I + \\Delta t\\, J\\right)}_{G_k(\\Delta t)} \\mathbf{U}_k^n.\n$$\nProjecting onto an eigenvector of the reaction Jacobian $J$ with eigenvalue $r$ and defining an effective diffusion coefficient $D_{\\mathrm{eff}}$ via the Rayleigh quotient along that eigenvector, the scalar mode amplitude $A_k^n$ obeys the update\n$$\nA_k^{n+1}=\\frac{A_k^n+\\Delta t\\,R_k^n}{1+\\Delta t\\,D_\\mathrm{eff} k^2},\n$$\nwhere for a linearized reaction $R_k^n = r\\,A_k^n$. In contrast, a fully explicit forward Euler scheme updates each mode by\n$$\n\\mathbf{U}_k^{n+1} = \\left(I + \\Delta t\\,(J - k^2 D)\\right)\\mathbf{U}_k^n.\n$$\n\nStarting from the reaction–diffusion equations, the linearization about the steady state, and the DFT property that the Laplacian maps to $-k^2$, derive the semi-implicit per-mode update above. Then, implement a program that, for each given parameter set, computes and compares the linear stability with respect to time stepping for the explicit Euler and the semi-implicit spectral methods. Use the following stability criteria:\n\n- Explicit Euler: For each discrete wavenumber $k$ and each eigenvalue $\\lambda_k$ of $J - k^2 D$, the amplification factor is $1 + \\Delta t\\,\\lambda_k$. The scheme is linearly stable at that $k$ if $\\left|1 + \\Delta t\\,\\lambda_k\\right| \\leq 1$. For a given $\\lambda_k$ with $\\mathrm{Re}(\\lambda_k)  0$, the maximum allowed time step that satisfies this inequality is\n$$\n\\Delta t_{\\max}(\\lambda_k) = -\\frac{2\\,\\mathrm{Re}(\\lambda_k)}{|\\lambda_k|^2}.\n$$\nIf $\\mathrm{Re}(\\lambda_k) \\ge 0$ for any eigenvalue at any $k$, then the maximum stable time step is $0$.\n\n- Semi-implicit spectral scheme: For each discrete wavenumber $k$, compute the amplification matrix $G_k(\\Delta t)$ given above. The scheme is linearly stable if the spectral radius of $G_k(\\Delta t)$ is less than or equal to $1$ for all discrete $k$. The maximum stable time step $\\Delta t_{\\max}$ is the largest $\\Delta t$ such that $\\max_k \\rho\\left(G_k(\\Delta t)\\right)\\le 1$. Numerically determine $\\Delta t_{\\max}$ via bisection on $\\Delta t$ over a positive interval.\n\nAdditionally, detect the presence of a Turing-unstable band by evaluating the maximum real part of the eigenvalues of $J - k^2 D$ across all discrete $k$. If $\\max_k \\max_{\\lambda\\in \\mathrm{eig}(J - k^2 D)} \\mathrm{Re}(\\lambda)  0$, then a diffusion-driven instability is present.\n\nImplement your program to compute:\n1. The maximum stable time step $\\Delta t_{\\max}^{\\mathrm{explicit}}$ for the explicit Euler scheme over all discrete $k$.\n2. The maximum stable time step $\\Delta t_{\\max}^{\\mathrm{semi}}$ for the semi-implicit spectral scheme over all discrete $k$.\n3. A boolean indicator for the presence of a Turing-unstable band as defined above.\n\nYour program must use the following test suite, each specified by $(a,b,D_u,D_v,L,N)$:\n- Test Case 1 (stable, moderately stiff diffusion): $(a,b)=(0.2,1.3)$, $(D_u,D_v)=(1.0,10.0)$, $L=50$, $N=128$.\n- Test Case 2 (potential Turing-unstable band): $(a,b)=(0.2,1.3)$, $(D_u,D_v)=(1.0,40.0)$, $L=50$, $N=128$.\n- Test Case 3 (near boundary with stronger inhibition): $(a,b)=(0.25,0.9)$, $(D_u,D_v)=(1.0,50.0)$, $L=50$, $N=128$.\n\nAll quantities are dimensionless. Use the discrete wavenumbers $k_n = \\frac{2\\pi}{L}\\,n$ for integers $n$ in the range $0 \\le n \\le \\frac{N}{2}$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of three entries $[\\Delta t_{\\max}^{\\mathrm{explicit}},\\Delta t_{\\max}^{\\mathrm{semi}},\\text{unstable\\_band}]$. Express the time-step values as floats rounded to six decimal places, and the instability indicator as a boolean. For example:\n$$\n[\\,[0.012345,0.067890,\\mathrm{False}],\\,[\\ldots],\\,[\\ldots]\\,].\n$$",
            "solution": "The problem statement is a well-posed, scientifically grounded exercise in computational systems biology and numerical analysis. It requests the derivation and implementation of stability analyses for two numerical schemes applied to a linearized reaction-diffusion system. All parameters, equations, and evaluation criteria are explicitly and consistently defined. Therefore, the problem is valid, and I will proceed with a full solution.\n\nThe core of the problem is to analyze the linear stability of a time-stepping scheme for the Fourier modes of the linearized reaction-diffusion system. The system's evolution in Fourier space for a given wavenumber $k$ is described by the linear ordinary differential equation:\n$$\n\\frac{d}{dt}\\mathbf{U}_k(t) = M_k \\mathbf{U}_k(t)\n$$\nwhere $\\mathbf{U}_k$ is the vector of Fourier amplitudes for the concentrations of $u$ and $v$, and $M_k$ is the system matrix for that mode:\n$$\nM_k = J - k^2 D\n$$\nHere, $J$ is the Jacobian matrix of the reaction kinetics, and $D = \\mathrm{diag}(D_u, D_v)$ is the diagonal matrix of diffusion coefficients.\n\nFirst, we must derive the Jacobian matrix $J$ for the Schnakenberg kinetics, $f(u,v) = a - u + u^2 v$ and $g(u,v) = b - u^2 v$. The partial derivatives are:\n$$\n\\frac{\\partial f}{\\partial u} = -1 + 2uv, \\quad \\frac{\\partial f}{\\partial v} = u^2\n$$\n$$\n\\frac{\\partial g}{\\partial u} = -2uv, \\quad \\frac{\\partial g}{\\partial v} = -u^2\n$$\nThe Jacobian matrix is thus:\n$$\nJ(u,v) = \\begin{pmatrix} -1 + 2uv  u^2 \\\\ -2uv  -u^2 \\end{pmatrix}\n$$\nWe evaluate $J$ at the specified homogeneous steady state $(u^\\ast, v^\\ast)$, where $u^\\ast = a+b$ and $v^\\ast = b/(a+b)^2$. The product $u^\\ast v^\\ast$ simplifies to:\n$$\nu^\\ast v^\\ast = (a+b) \\left( \\frac{b}{(a+b)^2} \\right) = \\frac{b}{a+b}\n$$\nSubstituting this into the Jacobian yields:\n$$\nJ = J(u^\\ast, v^\\ast) = \\begin{pmatrix} -1 + 2\\frac{b}{a+b}  (a+b)^2 \\\\ -2\\frac{b}{a+b}  -(a+b)^2 \\end{pmatrix} = \\begin{pmatrix} \\frac{b-a}{a+b}  (a+b)^2 \\\\ -\\frac{2b}{a+b}  -(a+b)^2 \\end{pmatrix}\n$$\nThis matrix, which depends only on the reaction parameters $a$ and $b$, will be computed for each test case.\n\nThe analysis considers a discrete set of wavenumbers $k_n$ corresponding to a spatial discretization of the domain of length $L$ into $N$ points. The wavenumbers are given by $k_n = \\frac{2\\pi}{L}n$ for integers $n$ from $0$ to $N/2$.\n\n**1. Turing Instability Analysis**\n\nA Turing (diffusion-driven) instability occurs if a spatially homogeneous steady state, which is stable to non-spatial perturbations, becomes unstable due to diffusion. This happens if any mode with $k  0$ grows exponentially. The growth rate of a mode is given by the real part of the eigenvalues of the matrix $M_k = J - k^2 D$. The instability condition is therefore $\\max_{k, \\lambda \\in \\mathrm{eig}(M_k)} \\mathrm{Re}(\\lambda)  0$. The analysis must also check the $k=0$ case (no diffusion). For Turing patterns, we require stability at $k=0$, meaning $\\mathrm{Re}(\\lambda)  0$ for all eigenvalues $\\lambda$ of $J$, and instability for some $k0$. The problem simplifies this to finding if any mode has a positive real eigenvalue part. We will compute the eigenvalues of $M_k$ for all discrete $k_n$ and find the maximum real part among all of them. If this maximum is positive, a Turing-unstable band exists.\n\n**2. Explicit Euler Scheme Stability**\n\nThe forward Euler method updates the system as $\\mathbf{U}_k^{n+1} = \\mathbf{U}_k^n + \\Delta t \\, M_k \\, \\mathbf{U}_k^n$. The amplification matrix is $I + \\Delta t M_k$. For stability, the spectral radius of this matrix must be less than or equal to $1$. If $\\lambda_k$ is an eigenvalue of $M_k$, then $1 + \\Delta t \\lambda_k$ is an eigenvalue of the amplification matrix. The stability condition is $|1 + \\Delta t \\lambda_k| \\le 1$ for all eigenvalues of $M_k$ and all wavenumbers $k$.\n\nFor an eigenvalue $\\lambda_k = x + iy$, the condition becomes $|(1+\\Delta t x) + i(\\Delta t y)|^2 \\le 1$, which expands to $(1+\\Delta t x)^2 + (\\Delta t y)^2 \\le 1$. This simplifies to $\\Delta t^2(x^2+y^2) + 2\\Delta t x \\le 0$, or $\\Delta t^2 |\\lambda_k|^2 + 2\\Delta t \\mathrm{Re}(\\lambda_k) \\le 0$.\nAssuming $\\Delta t  0$, we can divide by it: $\\Delta t |\\lambda_k|^2 \\le -2\\mathrm{Re}(\\lambda_k)$.\nFor this to have a positive solution for $\\Delta t$, we must have $\\mathrm{Re}(\\lambda_k)  0$. In this case, the maximum allowable time step for this specific mode is:\n$$\n\\Delta t_{\\max}(\\lambda_k) = -\\frac{2\\mathrm{Re}(\\lambda_k)}{|\\lambda_k|^2}\n$$\nIf $\\mathrm{Re}(\\lambda_k) \\ge 0$ for any mode, the system is physically unstable or marginally stable, and any positive time step $\\Delta t  0$ will lead to numerical instability. Therefore, the maximum stable time step is $\\Delta t = 0$. The overall maximum stable time step for the scheme is the minimum of these individual maximums over all $k_n$ and all corresponding eigenvalues.\n\n**3. Semi-Implicit Spectral Scheme Stability**\n\nThe problem provides the update rule for the semi-implicit scheme:\n$$\n\\mathbf{U}_k^{n+1} = \\left(I + \\Delta t\\, k^2 D\\right)^{-1}\\left(I + \\Delta t\\, J\\right) \\mathbf{U}_k^n = G_k(\\Delta t) \\mathbf{U}_k^n\n$$\nwhere $G_k(\\Delta t)$ is the amplification matrix. The scheme is stable if its spectral radius, $\\rho(G_k(\\Delta t))$, is less than or equal to $1$ for all wavenumbers $k_n$. The goal is to find the maximum $\\Delta t$ that satisfies this condition for all $k_n$ simultaneously:\n$$\n\\Delta t_{\\max}^{\\mathrm{semi}} = \\sup\\left\\{\\Delta t  0 \\mid \\max_{k_n} \\rho\\left(G_k(\\Delta t)\\right) \\le 1\\right\\}\n$$\nThe function $F(\\Delta t) = \\max_{k_n} \\rho\\left(G_k(\\Delta t)\\right)$ is monotonically increasing with $\\Delta t$. We are seeking the root of $F(\\Delta t) - 1 = 0$. This is a perfect application for a numerical root-finding method like bisection. We define a function `check_stability(dt)` which computes $\\max_{k_n} \\rho(G_k(\\Delta t))$ and returns `True` if it is $\\le 1$. We then search for the largest `dt` for which this holds by starting with an interval $[0, \\Delta t_{\\mathrm{high}}]$ and repeatedly narrowing it.\n\nThe matrix inversion $(I + \\Delta t k^2 D)^{-1}$ is computationally inexpensive because $D$ is diagonal, so $(I + \\Delta t k^2 D)$ is also diagonal:\n$$\n(I + \\Delta t k^2 D)^{-1} = \\begin{pmatrix} (1 + \\Delta t k^2 D_u)^{-1}  0 \\\\ 0  (1 + \\Delta t k^2 D_v)^{-1} \\end{pmatrix}\n$$\n\nThe overall algorithm proceeds as follows for each test case:\n1.  Calculate the constant Jacobian matrix $J$ from parameters $a$ and $b$.\n2.  Generate the set of discrete wavenumbers $\\{k_n\\}$.\n3.  Iterate through each $k_n$ to find eigenvalues of $M_k = J - k_n^2 D$. Use these to determine $\\Delta t_{\\max}^{\\mathrm{explicit}}$ and the Turing instability flag.\n4.  Implement a bisection search over $\\Delta t$ for the semi-implicit scheme. The search will rely on a helper function that checks stability by computing $\\max_{k_n} \\rho(G_k(\\Delta t))$.\n5.  Format and record the three resulting values.",
            "answer": "[[0.012211,1.527189,False],[0.003112,0.000000,True],[0.002094,0.000000,True]]"
        }
    ]
}