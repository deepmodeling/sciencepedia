{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of agent-based modeling is capturing the dynamic behavior of individual agents. In cell biology, this often involves modeling phenotypic plasticity, where cells stochastically switch between different states. This first exercise introduces the fundamental mathematical framework for this process, the Continuous-Time Markov Chain, and asks you to determine the long-term population balance that arises from given transition rates. Mastering this concept is key to understanding how tissue-level heterogeneity can emerge from the probabilistic behavior of single cells .",
            "id": "4314010",
            "problem": "Consider an agent-based model for a well-mixed population of cells in a homogeneous tissue microenvironment in which each cell independently switches between two phenotypic states, denoted by $S_{1}$ and $S_{2}$. The switching dynamics are continuous in time and memoryless, and the transitions are characterized by constant rates: a cell in state $S_{1}$ switches to state $S_{2}$ with rate $k_{12} > 0$, and a cell in state $S_{2}$ switches to state $S_{1}$ with rate $k_{21} > 0$. Assume that, on the timescale of interest, birth and death are negligible and the microenvironmental signals are stationary, so that the rates $k_{12}$ and $k_{21}$ do not depend on time or the number of cells.\n\nModel each cell’s phenotypic trajectory as a Continuous-Time Markov Chain (CTMC) with state space $\\{S_{1}, S_{2}\\}$ and the above transition rates. Let $p_{1}(t)$ and $p_{2}(t)$ denote the probabilities that a randomly chosen cell is in state $S_{1}$ or $S_{2}$ at time $t$, respectively, with $p_{1}(t) + p_{2}(t) = 1$ for all $t \\geq 0$. Define the stationary distribution $(\\pi_{1}, \\pi_{2})$ as the time-independent limit of $(p_{1}(t), p_{2}(t))$ as $t \\to \\infty$, assuming the chain is ergodic.\n\nStarting from the fundamental definitions of CTMC dynamics and conservation of probability, derive the stationary distribution $(\\pi_{1}, \\pi_{2})$ in closed form in terms of $k_{12}$ and $k_{21}$. Then, using your result, reason about how the ratio $r = k_{12}/k_{21}$ biologically controls the long-term fraction of cells in $S_{2}$ relative to $S_{1}$ under this agent-based model. Express your final answer as the ordered pair $(\\pi_{1}, \\pi_{2})$ in closed form. No numerical values are required, and no rounding is necessary. The final quantities are dimensionless probabilities, so no units should be reported.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Model:** An agent-based model for a well-mixed cell population in a homogeneous tissue microenvironment.\n- **States:** Two phenotypic states, $S_{1}$ and $S_{2}$.\n- **Dynamics:** Continuous-Time Markov Chain (CTMC) for each cell, continuous in time and memoryless.\n- **Transition Rates:** Constant rates.\n  - From $S_{1}$ to $S_{2}$: rate $k_{12} > 0$.\n  - From $S_{2}$ to $S_{1}$: rate $k_{21} > 0$.\n- **Assumptions:** Birth and death are negligible on the timescale of interest; microenvironmental signals are stationary.\n- **Probabilities:** $p_{1}(t)$ and $p_{2}(t)$ are the probabilities of a cell being in state $S_{1}$ or $S_{2}$ at time $t$.\n- **Constraint:** Conservation of probability, $p_{1}(t) + p_{2}(t) = 1$ for all $t \\geq 0$.\n- **Stationary Distribution:** $(\\pi_{1}, \\pi_{2})$ is the limit of $(p_{1}(t), p_{2}(t))$ as $t \\to \\infty$.\n- **Ergodicity:** The chain is assumed to be ergodic.\n- **Objective 1:** Derive the stationary distribution $(\\pi_{1}, \\pi_{2})$ in closed form in terms of $k_{12}$ and $k_{21}$.\n- **Objective 2:** Interpret how the ratio $r = k_{12}/k_{21}$ controls the long-term fraction of cells in $S_{2}$ relative to $S_{1}$.\n- **Final Answer Format:** The ordered pair $(\\pi_{1}, \\pi_{2})$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a classic two-state Continuous-Time Markov Chain. This is a fundamental and widely used model in systems biology, physics, and chemistry to describe stochastic transitions between discrete states.\n\n1.  **Scientifically Grounded:** The problem is firmly grounded in the established mathematical theory of stochastic processes (specifically, CTMCs) and its application to biological systems (cell phenotype switching). This is a standard approach in systems biomedicine.\n2.  **Well-Posed:** The problem is well-posed. The a priori conditions $k_{12} > 0$ and $k_{21} > 0$ ensure that the CTMC is irreducible (all states are reachable from all other states). For a finite-state, irreducible CTMC, a unique stationary distribution is guaranteed to exist.\n3.  **Objective:** The language is formal, precise, and objective, using well-defined mathematical terms.\n4.  **Completeness:** The problem provides all necessary information (the two transition rates) and constraints (conservation of probability, definition of stationarity) to uniquely determine the solution.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard, self-contained, and well-posed problem in mathematical biology. Proceeding with the solution.\n\nThe dynamics of the probabilities $p_{1}(t)$ and $p_{2}(t)$ for a cell to be in state $S_{1}$ or $S_{2}$ are described by the forward Kolmogorov equations, also known as the master equation for the system. The rate of change of probability for a given state is determined by the flux of probability into that state minus the flux of probability out of it.\n\nFor state $S_{1}$, the probability $p_{1}(t)$ increases due to cells switching from $S_{2}$ to $S_{1}$ (flux in) and decreases due to cells switching from $S_{1}$ to $S_{2}$ (flux out). The corresponding differential equation is:\n$$\n\\frac{dp_{1}(t)}{dt} = k_{21} p_{2}(t) - k_{12} p_{1}(t)\n$$\nSimilarly, for state $S_{2}$, the probability $p_{2}(t)$ increases due to cells switching from $S_{1}$ to $S_{2}$ and decreases due to cells switching from $S_{2}$ to $S_{1}$. The differential equation is:\n$$\n\\frac{dp_{2}(t)}{dt} = k_{12} p_{1}(t) - k_{21} p_{2}(t)\n$$\nThe stationary distribution $(\\pi_{1}, \\pi_{2})$ is defined as the time-independent solution to this system, where the probabilities no longer change with time. This occurs when the time derivatives are zero: $\\frac{dp_{1}(t)}{dt} = 0$ and $\\frac{dp_{2}(t)}{dt} = 0$. Replacing $p_{1}(t)$ with $\\pi_{1}$ and $p_{2}(t)$ with $\\pi_{2}$, we get the steady-state equations:\n$$\n0 = k_{21} \\pi_{2} - k_{12} \\pi_{1}\n$$\n$$\n0 = k_{12} \\pi_{1} - k_{21} \\pi_{2}\n$$\nBoth equations are linearly dependent and simplify to the same relationship, known as the detailed balance condition:\n$$\nk_{12} \\pi_{1} = k_{21} \\pi_{2}\n$$\nThis equation signifies that at equilibrium, the total probabilistic flux from state $S_{1}$ to $S_{2}$ is exactly equal to the total probabilistic flux from $S_{2}$ to $S_{1}$.\n\nTo find a unique solution for $\\pi_{1}$ and $\\pi_{2}$, we must use a second, independent equation. This is provided by the axiom of conservation of probability, which states that a cell must be in one of the possible states. At steady state, this becomes:\n$$\n\\pi_{1} + \\pi_{2} = 1\n$$\nWe now have a system of two linear equations with two unknowns:\n1.  $k_{12} \\pi_{1} = k_{21} \\pi_{2}$\n2.  $\\pi_{1} + \\pi_{2} = 1$\n\nFrom equation (1), we can express $\\pi_{1}$ in terms of $\\pi_{2}$:\n$$\n\\pi_{1} = \\frac{k_{21}}{k_{12}} \\pi_{2}\n$$\nSubstitute this expression for $\\pi_{1}$ into equation (2):\n$$\n\\left(\\frac{k_{21}}{k_{12}}\\right) \\pi_{2} + \\pi_{2} = 1\n$$\nFactor out $\\pi_{2}$:\n$$\n\\pi_{2} \\left(\\frac{k_{21}}{k_{12}} + 1\\right) = 1\n$$\n$$\n\\pi_{2} \\left(\\frac{k_{21} + k_{12}}{k_{12}}\\right) = 1\n$$\nSolving for $\\pi_{2}$ yields:\n$$\n\\pi_{2} = \\frac{k_{12}}{k_{12} + k_{21}}\n$$\nNow, we can find $\\pi_{1}$ using the conservation of probability, $\\pi_{1} = 1 - \\pi_{2}$:\n$$\n\\pi_{1} = 1 - \\frac{k_{12}}{k_{12} + k_{21}} = \\frac{(k_{12} + k_{21}) - k_{12}}{k_{12} + k_{21}} = \\frac{k_{21}}{k_{12} + k_{21}}\n$$\nThus, the stationary distribution is $(\\pi_{1}, \\pi_{2}) = \\left(\\frac{k_{21}}{k_{12} + k_{21}}, \\frac{k_{12}}{k_{12} + k_{21}}\\right)$.\n\nNext, we analyze how the ratio $r = k_{12}/k_{21}$ controls the long-term fraction of cells in $S_{2}$ relative to $S_{1}$. The long-term fraction of cells in each state corresponds to the stationary probabilities $\\pi_{1}$ and $\\pi_{2}$. Let's examine the ratio of these probabilities:\n$$\n\\frac{\\pi_{2}}{\\pi_{1}} = \\frac{\\frac{k_{12}}{k_{12} + k_{21}}}{\\frac{k_{21}}{k_{12} + k_{21}}} = \\frac{k_{12}}{k_{21}}\n$$\nSince the problem defines $r = k_{12}/k_{21}$, we have the direct relationship:\n$$\n\\frac{\\pi_{2}}{\\pi_{1}} = r\n$$\nThis result provides a clear biological interpretation. The ratio $r$ represents the relative propensity for a cell to switch into state $S_{2}$ compared to switching out of it.\n- If $r > 1$, then $k_{12} > k_{21}$. The rate of transition towards $S_{2}$ is greater than the rate of transition back to $S_{1}$. This implies that $\\pi_{2} > \\pi_{1}$, and the population at equilibrium will be dominated by cells in the $S_{2}$ phenotype.\n- If $r < 1$, then $k_{12} < k_{21}$. The rate of transition away from $S_{2}$ is greater than the rate towards it. This implies that $\\pi_{2} < \\pi_{1}$, and the population at equilibrium will be dominated by cells in the $S_{1}$ phenotype.\n- If $r = 1$, then $k_{12} = k_{21}$. The transition rates are equal in both directions. This implies that $\\pi_{2} = \\pi_{1}$, and since they must sum to $1$, $\\pi_1 = \\pi_2 = 0.5$. The cell population will be equally distributed between the two states in the long term.\n\nIn summary, the ratio of the transition rates, $r$, acts as a control parameter that directly sets the equilibrium ratio of the two phenotypic subpopulations.",
            "answer": "$$\n\\boxed{\\left(\\frac{k_{21}}{k_{12} + k_{21}}, \\frac{k_{12}}{k_{12} + k_{21}}\\right)}\n$$"
        },
        {
            "introduction": "Having modeled *what* kind of events can occur, we must next address *when* they occur. The Stochastic Simulation Algorithm (SSA), or Gillespie algorithm, is a pivotal method for simulating systems with discrete, random events. This practice challenges you to derive, from first principles, the rule for determining the time until the next event occurs. By working through the connection between event propensities, Poisson processes, and inverse transform sampling, you will gain a deep and practical understanding of the engine that drives many modern agent-based models .",
            "id": "4314018",
            "problem": "Consider an agent-based model of a confluent epithelial monolayer where each cell is an agent endowed with $M$ stochastic event channels (indexed by $\\mu \\in \\{1,\\dots,M\\}$), such as adhesion bond turnover, cytokine secretion, volume growth, and division. Over a sufficiently small time interval, assume the mesoscopic state of the tissue is quasi-stationary so that each channel’s propensity $a_{\\mu}$ is time-independent, and define the total propensity as $a_{0} = \\sum_{\\mu=1}^{M} a_{\\mu}$. Under the standard assumptions of the Stochastic Simulation Algorithm (SSA), also called the Gillespie algorithm, the timing of the next event is governed by the same stochastic point process that produces memoryless inter-event times consistent with a constant hazard equal to $a_{0}$.\n\nStarting from the defining properties of a time-homogeneous Poisson process and the relationship between the hazard function, the survival function, and the cumulative distribution function, derive the transformation that maps a single sample $u$ drawn from the uniform distribution on the unit interval to the next reaction time $\\tau$ in terms of $a_{0}$ and $u$. Then, for a particular cell at a given global state with measured total propensity $a_{0} = 3.2\\ \\mathrm{s}^{-1}$ and a generated uniform variate $u = 0.10$, compute the value of $\\tau$.\n\nExpress the final time in seconds (s). Round your numerical answer to four significant figures.",
            "solution": "The problem is first assessed for validity.\n\n### Step 1: Extract Givens\n- The system is an agent-based model of a confluent epithelial monolayer.\n- Each cell agent has $M$ stochastic event channels, indexed by $\\mu \\in \\{1,\\dots,M\\}$.\n- The mesoscopic state is quasi-stationary, implying channel propensities $a_{\\mu}$ are time-independent.\n- The total propensity is $a_{0} = \\sum_{\\mu=1}^{M} a_{\\mu}$.\n- The model follows the assumptions of the Stochastic Simulation Algorithm (SSA).\n- The time to the next event, $\\tau$, is governed by a stochastic process with memoryless inter-event times, corresponding to a constant hazard rate equal to $a_{0}$.\n- The derivation must start from the properties of a time-homogeneous Poisson process and the relationships between the hazard function, survival function, and cumulative distribution function (CDF).\n- The goal is to derive the transformation from a uniform random variate $u \\sim U(0,1)$ to the next reaction time $\\tau$.\n- A specific calculation is required for $a_{0} = 3.2\\ \\mathrm{s}^{-1}$ and $u = 0.10$.\n- The final numerical answer for $\\tau$ must be in seconds and rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on the Gillespie algorithm (SSA), a fundamental and widely used method in stochastic chemical kinetics and computational systems biology. The concepts of propensity, Poisson processes, and the derivation via inverse transform sampling are standard and scientifically sound.\n- **Well-Posed:** The problem provides all necessary information and clear objectives. It asks for a standard theoretical derivation followed by a numerical calculation, for which a unique solution exists.\n- **Objective:** The language is formal, precise, and free of any subjectivity or ambiguity.\n- **Completeness and Consistency:** The problem is self-contained. The description of the SSA properties is consistent with its established formulation in the scientific literature. No information is missing or contradictory.\n- **Realism:** The application to cell modeling and the given value for the total propensity are physically and biologically plausible.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, and complete. A full solution will be provided.\n\nThe core of the Stochastic Simulation Algorithm (SSA) is a method to determine two quantities: which event will occur next, and when it will occur. This problem focuses on the latter. The time $\\tau$ until the next event in a system with total propensity $a_0$ follows an exponential distribution. We can derive this from first principles as requested.\n\nLet $P(\\tau, \\mu)d\\tau$ be the probability that the next event will be reaction $\\mu$ and will occur in the infinitesimal time interval $[\\tau, \\tau+d\\tau)$. The quantity $a_{\\mu}d\\tau$ is the probability that reaction $\\mu$ occurs in $[\\tau, \\tau+d\\tau)$, given the state at time $t$. The total probability of any reaction occurring in this interval is $a_{0}d\\tau$, where $a_0 = \\sum_{\\mu} a_{\\mu}$.\n\nThe probability that no event occurs in the time interval $[0, \\tau)$ is given by the survival function, $S(\\tau)$. The relationship between the survival function and the constant hazard rate $a_0$ (the instantaneous probability of an event per unit time, given no event has yet occurred) is given by:\n$$ a_0 = -\\frac{d}{d\\tau} \\ln(S(\\tau)) $$\nWe can solve for $S(\\tau)$ by integrating from time $0$ to time $\\tau$.\n$$ \\int_0^{\\tau} a_0 dt' = -\\int_0^{\\tau} \\frac{d}{dt'} \\ln(S(t')) dt' $$\nSince $a_0$ is constant (time-homogeneous assumption):\n$$ a_0 \\tau = -[\\ln(S(t'))]_0^{\\tau} = -(\\ln(S(\\tau)) - \\ln(S(0))) $$\nAt time $\\tau=0$, no time has elapsed, so the probability of having survived (i.e., no event having occurred yet) is $1$. Thus, $S(0) = 1$, which implies $\\ln(S(0)) = 0$.\nThe equation simplifies to:\n$$ a_0 \\tau = -\\ln(S(\\tau)) $$\nExponentiating both sides gives the survival function:\n$$ S(\\tau) = \\exp(-a_0 \\tau) $$\nThis function gives the probability that the next event occurs *after* time $\\tau$.\n\nThe cumulative distribution function (CDF), $F(\\tau)$, gives the probability that the next-reaction time is less than or equal to $\\tau$. It is the complement of the survival function:\n$$ F(\\tau) = P(T \\le \\tau) = 1 - S(\\tau) $$\nSubstituting the expression for $S(\\tau)$, we get:\n$$ F(\\tau) = 1 - \\exp(-a_0 \\tau) $$\nThis is the CDF of the exponential distribution with rate parameter $a_0$.\n\nTo generate a random variate $\\tau$ from this distribution, we use the inverse transform sampling method. We generate a random number $u$ from the standard uniform distribution on the interval $(0, 1)$, i.e., $u \\sim U(0,1)$. We then set this value equal to the CDF and solve for $\\tau$:\n$$ u = F(\\tau) = 1 - \\exp(-a_0 \\tau) $$\nRearranging to solve for $\\tau$:\n$$ 1 - u = \\exp(-a_0 \\tau) $$\nTaking the natural logarithm of both sides:\n$$ \\ln(1 - u) = -a_0 \\tau $$\n$$ \\tau = -\\frac{1}{a_0} \\ln(1 - u) $$\nA property of the uniform distribution is that if $u$ is a random variate from $U(0,1)$, then $1-u$ is also a random variate from $U(0,1)$. Therefore, for computational convenience, we can replace $1-u$ with $u$:\n$$ \\tau = -\\frac{1}{a_0} \\ln(u) $$\nThis is the required transformation that maps a uniform random variate $u$ to the next reaction time $\\tau$. This formula is often expressed equivalently as $\\tau = \\frac{1}{a_0} \\ln(\\frac{1}{u})$.\n\nNow, we apply this formula to the specific values given in the problem.\nThe givens are:\n- Total propensity, $a_0 = 3.2\\ \\mathrm{s}^{-1}$\n- Uniform random variate, $u = 0.10$\n\nSubstituting these values into the derived transformation:\n$$ \\tau = -\\frac{1}{3.2} \\ln(0.10) $$\nWe can compute the numerical value:\n$$ \\ln(0.10) \\approx -2.30258509... $$\n$$ \\frac{1}{3.2} = 0.3125 $$\n$$ \\tau \\approx -(0.3125) \\times (-2.30258509...) $$\n$$ \\tau \\approx 0.71955784... \\ \\mathrm{s} $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\tau \\approx 0.7196 \\ \\mathrm{s} $$",
            "answer": "$$\\boxed{0.7196}$$"
        },
        {
            "introduction": "This final practice moves our agents from abstract state spaces into a physical, two-dimensional environment. A critical task in tissue modeling is to connect the microscopic interactions between individual cells to the macroscopic mechanical properties of the tissue as a whole. This computational exercise guides you through the process of calculating key tissue-level metrics—such as packing fraction and mechanical pressure—from a given configuration of interacting cells. You will implement the virial theorem for pressure and handle periodic boundary conditions, providing you with essential, practical skills for building and analyzing off-lattice agent-based models .",
            "id": "4313977",
            "problem": "You are asked to implement a two-dimensional agent-based model of disk-like cells under Periodic Boundary Conditions (PBC) with central pairwise repulsion. Each cell is represented by a disk of radius $R$ and interacts with other cells via a repulsive, linear, distance-limited force specified by the positive-part operator. The interaction between two cells at separation distance $r$ is given by a central force of magnitude $F(r) = k \\left(1 - \\frac{r}{r_0}\\right)_+$, where $(x)_+ = \\max(x, 0)$ and $r_0 = 2R$ is the contact cutoff for identical disks. The vector force direction is along the line connecting the two cell centers. The system is athermal (no kinetic contributions).\n\nStarting from the fundamental definition of packing fraction as total nominal occupied area divided by system area, and from the two-dimensional Irving–Kirkwood virial route to mechanical pressure in the athermal limit for central pairwise forces, design and implement a program that:\n- Computes the packing fraction $\\phi$.\n- Computes the two-dimensional mechanical pressure $P$ using the virial expression specialized to pairwise central forces in two dimensions and evaluated under PBC with the minimum-image convention.\n- Computes crowding metrics that quantify local mechanical crowding:\n    1. The mean positive overlap fraction $\\overline{o}$ across unordered interacting pairs, defined by $o_{ij} = \\left(1 - \\frac{r_{ij}}{r_0}\\right)_+$ for $i < j$ and averaged only over pairs with $o_{ij} > 0$. If there are no overlapping pairs, define $\\overline{o} = 0$.\n    2. The mean contact number per cell $\\overline{z}$, where a contact between cells $i$ and $j$ is counted if $r_{ij} < r_0$ using the minimum-image separation. The mean is taken over all cells.\n\nAll distances must be computed under Periodic Boundary Conditions using the minimum-image convention. The mechanical pressure $P$ must be reported in nanoNewton per micrometer, i.e., $\\mathrm{nN}/\\mu\\mathrm{m}$, the packing fraction $\\phi$ and the mean positive overlap fraction $\\overline{o}$ are dimensionless, and the mean contact number $\\overline{z}$ is a float representing the average number of contacts per cell. For clarity and standardization, report all floating-point outputs rounded to six decimal places.\n\nUse the following fixed test suite of four cases. In each case, the box is rectangular with side lengths $L_x$ and $L_y$ in micrometers $\\mu\\mathrm{m}$, the radius is $R$ in micrometers, and the force scale is $k$ in nanoNewtons $\\mathrm{nN}$. The cell centers are specified by coordinates $(x, y)$ in micrometers.\n\n- Case $1$ (low crowding; a few overlaps):\n    - $L_x = 50$, $L_y = 50$, $R = 2$, $k = 0.5$.\n    - Positions (in $\\mu\\mathrm{m}$): $(5, 5)$, $(8.6, 5)$, $(23, 5)$, $(32, 5)$, $(41, 5)$, $(5, 20)$, $(8.6, 20)$, $(23, 20)$, $(32, 20)$, $(41, 20)$.\n\n- Case $2$ (high crowding; dense grid):\n    - $L_x = 20$, $L_y = 20$, $R = 3$, $k = 1.0$.\n    - Positions (in $\\mu\\mathrm{m}$): $(2, 2)$, $(6, 2)$, $(10, 2)$, $(14, 2)$, $(2, 6)$, $(6, 6)$, $(10, 6)$, $(14, 6)$, $(2, 10)$, $(6, 10)$, $(10, 10)$, $(14, 10)$, $(2, 14)$, $(6, 14)$, $(10, 14)$, $(14, 14)$.\n\n- Case $3$ (boundary at cutoff; no force):\n    - $L_x = 30$, $L_y = 30$, $R = 5$, $k = 0.8$.\n    - Positions (in $\\mu\\mathrm{m}$): $(5, 5)$, $(15, 5)$, $(5, 15)$, $(15, 15)$.\n\n- Case $4$ (single cell; trivial crowding):\n    - $L_x = 40$, $L_y = 40$, $R = 7$, $k = 1.2$.\n    - Positions (in $\\mu\\mathrm{m}$): $(10, 10)$.\n\nYour program must:\n- Implement the minimum-image convention for PBC: for each pair of cells $i$ and $j$, compute $\\Delta x = x_j - x_i$ and $\\Delta y = y_j - y_i$, then map each component into the interval $[-\\frac{L}{2}, \\frac{L}{2})$ by subtracting $L$ times the nearest integer, where $L$ is $L_x$ for $\\Delta x$ and $L_y$ for $\\Delta y$.\n- From these minimum-image separations, compute the pair distance $r_{ij}$.\n- Use $r_0 = 2R$ uniformly for identical disks.\n\nFor each test case, return a list of four values $[\\phi, P, \\overline{o}, \\overline{z}]$, with $P$ in $\\mathrm{nN}/\\mu\\mathrm{m}$. The final program output must be a single line with a comma-separated list of these four-element lists enclosed in square brackets, for example, $[[\\phi_1, P_1, \\overline{o}_1, \\overline{z}_1],[\\phi_2, P_2, \\overline{o}_2, \\overline{z}_2],\\ldots]$, and each floating-point number must be rounded to six decimal places.",
            "solution": "The problem statement has been analyzed and is deemed valid. It is scientifically grounded in the principles of statistical mechanics and computational soft matter physics, well-posed with all necessary information provided, and objective in its formulation. We can therefore proceed with a solution.\n\n### 1. Fundamental Principles and Definitions\n\nThe model describes a system of $N$ identical disk-like cells, each with radius $R$, in a rectangular domain of size $L_x \\times L_y$. The total area of the system is $A = L_x L_y$. The cells interact through a central pairwise repulsive force given by:\n$$ F(r) = k \\left(1 - \\frac{r}{r_0}\\right)_+ $$\nwhere $r$ is the center-to-center separation distance, $k$ is the force spring constant, $r_0 = 2R$ is the contact cutoff distance, and $(x)_+ = \\max(x, 0)$ is the positive-part operator. This force is non-zero only when cells overlap, i.e., when $r < r_0$. The system is athermal, meaning there are no kinetic energy contributions to its properties.\n\nAll intercellular distances $r_{ij}$ between cells $i$ and $j$ must be calculated using the minimum-image convention (MIC) to correctly handle the periodic boundary conditions. For a displacement vector $\\Delta\\mathbf{r} = (\\Delta x, \\Delta y)$, the minimum image displacement $\\Delta\\mathbf{r}' = (\\Delta x', \\Delta y')$ is found by:\n$$ \\Delta x' = \\Delta x - L_x \\cdot \\text{round}\\left(\\frac{\\Delta x}{L_x}\\right) $$\n$$ \\Delta y' = \\Delta y - L_y \\cdot \\text{round}\\left(\\frac{\\Delta y}{L_y}\\right) $$\nThe distance is then $r_{ij} = \\sqrt{(\\Delta x')^2 + (\\Delta y')^2}$.\n\nBased on these principles, we define the required metrics:\n\n#### Packing Fraction ($\\phi$)\nThe packing fraction is the ratio of the total nominal area occupied by the cells to the total system area. The area of a single cell is $A_{cell} = \\pi R^2$. For $N$ cells, the total occupied area is $N A_{cell}$.\n$$ \\phi = \\frac{N \\pi R^2}{A} = \\frac{N \\pi R^2}{L_x L_y} $$\n\n#### Mechanical Pressure ($P$)\nThe mechanical pressure in a two-dimensional athermal system with central pairwise forces is derived from the virial theorem. The pressure tensor component from inter-particle forces is given by $\\frac{1}{A} \\sum_{i<j} \\mathbf{r}_{ij} \\otimes \\mathbf{F}_{ij}$, where $\\mathbf{r}_{ij}$ is the minimum-image vector from cell $i$ to $j$ and $\\mathbf{F}_{ij}$ is the force exerted by $j$ on $i$. For a central force $\\mathbf{F}_{ij} = F(r_{ij}) \\frac{\\mathbf{r}_{ij}}{r_{ij}}$, the scalar pressure $P$ is half the trace of this tensor:\n$$ P = \\frac{1}{2A} \\sum_{i<j} r_{ij} F(r_{ij}) $$\nSubstituting the given force law and summing only over interacting pairs (where $r_{ij} < r_0$), the expression becomes:\n$$ P = \\frac{1}{2 L_x L_y} \\sum_{i<j, r_{ij} < r_0} k r_{ij} \\left(1 - \\frac{r_{ij}}{r_0}\\right) $$\n\n#### Mean Positive Overlap Fraction ($\\overline{o}$)\nThe overlap fraction for a pair of cells $(i, j)$ is defined as $o_{ij} = \\left(1 - \\frac{r_{ij}}{r_0}\\right)_+$. This quantity is positive only for interacting pairs ($r_{ij} < r_0$). The mean positive overlap fraction, $\\overline{o}$, is the average of these positive values over all such interacting pairs.\nLet $N_{overlap}$ be the number of unique pairs $(i,j)$ with $i<j$ for which $r_{ij} < r_0$.\n$$ \\overline{o} = \\begin{cases} \\frac{1}{N_{overlap}} \\sum_{i<j, r_{ij} < r_0} \\left(1 - \\frac{r_{ij}}{r_0}\\right) & \\text{if } N_{overlap} > 0 \\\\ 0 & \\text{if } N_{overlap} = 0 \\end{cases} $$\n\n#### Mean Contact Number ($\\overline{z}$)\nA contact between cells $i$ and $j$ exists if their separation $r_{ij}$ is less than the cutoff $r_0$. The contact number for a single cell $i$, denoted $z_i$, is the count of other cells $j$ for which this condition holds. The mean contact number $\\overline{z}$ is the average of $z_i$ over all $N$ cells.\n$$ z_i = \\sum_{j \\neq i, r_{ij} < r_0} 1 $$\n$$ \\overline{z} = \\frac{1}{N} \\sum_{i=1}^N z_i $$\nIf $N=0$, $\\overline{z}=0$. The sum $\\sum_{i=1}^N z_i$ is equal to twice the total number of interacting pairs.\n\n### 2. Algorithmic Implementation\n\nThe computation proceeds by systematically calculating these four metrics for each given test case.\n\n1.  **Initialization**: For each case, retrieve the parameters $L_x, L_y, R, k$ and the list of $N$ cell positions $\\mathbf{r}_i = (x_i, y_i)$. Initialize accumulators for the virial sum, the overlap sum, the count of overlapping pairs, and an array to store contact numbers for each cell.\n2.  **Packing Fraction**: Compute $\\phi$ directly from its definition. This is independent of pairwise interactions.\n3.  **Pairwise Interaction Loop**: Iterate through all unique pairs of cells $(i, j)$ with $i < j$. For each pair:\n    a.  Calculate the displacement vector $\\Delta\\mathbf{r} = \\mathbf{r}_j - \\mathbf{r}_i$.\n    b.  Apply the minimum-image convention to obtain the shortest separation vector $\\Delta\\mathbf{r}'$ and its magnitude, the distance $r_{ij}$.\n    c.  Check for interaction: if $r_{ij} < r_0 = 2R$.\n    d.  If an interaction exists:\n        i.  Calculate the force magnitude $F_{ij} = k(1 - r_{ij}/r_0)$ and its contribution to the virial, $r_{ij} F_{ij}$. Add this to the total virial sum.\n        ii. Calculate the overlap fraction $o_{ij} = 1 - r_{ij}/r_0$. Add this to the total overlap sum and increment the count of overlapping pairs.\n        iii. Increment the contact counters for both cell $i$ and cell $j$.\n4.  **Final Metric Calculation**: After iterating through all pairs:\n    a.  Calculate the pressure $P$ from the total virial sum and the system area $A$.\n    b.  Calculate the mean positive overlap $\\overline{o}$ by dividing the overlap sum by the overlap count. If the count is zero, $\\overline{o}$ is zero.\n    c.  Calculate the mean contact number $\\overline{z}$ by taking the average of the per-cell contact counters.\n5.  **Output Formatting**: Round each of the four computed floating-point values ($\\phi, P, \\overline{o}, \\overline{z}$) to six decimal places as required. Assemble the results into the specified list format.\n\nThis algorithm correctly implements the physical and mathematical definitions provided in the problem statement, ensuring a robust and accurate solution. Special cases, such as a single cell or no interacting pairs, are handled naturally by the logic. For a single cell ($N=1$), the pairwise loops are not entered, correctly resulting in $P=0, \\overline{o}=0, \\overline{z}=0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes packing fraction, pressure, mean overlap, and mean contact number\n    for a 2D agent-based model of cells under periodic boundary conditions.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"Lx\": 50.0, \"Ly\": 50.0, \"R\": 2.0, \"k\": 0.5,\n            \"positions\": [\n                (5.0, 5.0), (8.6, 5.0), (23.0, 5.0), (32.0, 5.0), (41.0, 5.0),\n                (5.0, 20.0), (8.6, 20.0), (23.0, 20.0), (32.0, 20.0), (41.0, 20.0)\n            ]\n        },\n        {\n            \"Lx\": 20.0, \"Ly\": 20.0, \"R\": 3.0, \"k\": 1.0,\n            \"positions\": [\n                (2.0, 2.0), (6.0, 2.0), (10.0, 2.0), (14.0, 2.0),\n                (2.0, 6.0), (6.0, 6.0), (10.0, 6.0), (14.0, 6.0),\n                (2.0, 10.0), (6.0, 10.0), (10.0, 10.0), (14.0, 10.0),\n                (2.0, 14.0), (6.0, 14.0), (10.0, 14.0), (14.0, 14.0)\n            ]\n        },\n        {\n            \"Lx\": 30.0, \"Ly\": 30.0, \"R\": 5.0, \"k\": 0.8,\n            \"positions\": [\n                (5.0, 5.0), (15.0, 5.0), (5.0, 15.0), (15.0, 15.0)\n            ]\n        },\n        {\n            \"Lx\": 40.0, \"Ly\": 40.0, \"R\": 7.0, \"k\": 1.2,\n            \"positions\": [(10.0, 10.0)]\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        Lx, Ly, R, k = case[\"Lx\"], case[\"Ly\"], case[\"R\"], case[\"k\"]\n        positions = np.array(case[\"positions\"], dtype=np.float64)\n        \n        N = positions.shape[0]\n        A = Lx * Ly\n        r0 = 2.0 * R\n\n        # Handle trivial cases (N  2)\n        if N  2:\n            phi = (N * np.pi * R**2) / A if A > 0 else 0.0\n            results = [phi, 0.0, 0.0, 0.0]\n            # Round and append\n            all_results.append([round(val, 6) for val in results])\n            continue\n            \n        # 1. Compute packing fraction (phi)\n        phi = (N * np.pi * R**2) / A\n\n        # Initialize accumulators\n        virial_sum = 0.0\n        overlap_sum = 0.0\n        overlap_count = 0\n        contacts = np.zeros(N, dtype=int)\n\n        # Loop over all unique pairs of cells\n        for i in range(N):\n            for j in range(i + 1, N):\n                # Compute displacement vector\n                delta = positions[j] - positions[i]\n                \n                # Apply minimum-image convention for PBC\n                delta[0] -= Lx * np.rint(delta[0] / Lx)\n                delta[1] -= Ly * np.rint(delta[1] / Ly)\n                \n                r_ij = np.linalg.norm(delta)\n\n                # Check for interaction (overlap)\n                if r_ij  r0:\n                    # Contribution to pressure (Virial)\n                    force_mag = k * (1.0 - r_ij / r0)\n                    virial_sum += r_ij * force_mag\n                    \n                    # Contribution to mean positive overlap\n                    overlap = 1.0 - r_ij / r0\n                    overlap_sum += overlap\n                    overlap_count += 1\n                    \n                    # Increment contact numbers\n                    contacts[i] += 1\n                    contacts[j] += 1\n        \n        # 2. Compute mechanical pressure (P)\n        pressure = virial_sum / (2.0 * A) if A > 0 else 0.0\n        \n        # 3. Compute mean positive overlap fraction (o_bar)\n        mean_overlap = overlap_sum / overlap_count if overlap_count > 0 else 0.0\n\n        # 4. Compute mean contact number (z_bar)\n        mean_contacts = np.mean(contacts)\n\n        # Store rounded results for the current case\n        case_results = [\n            round(phi, 6),\n            round(pressure, 6),\n            round(mean_overlap, 6),\n            round(mean_contacts, 6)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string as specified\n    formatted_results = [\n        f\"[{','.join(f'{v:.6f}' for v in res)}]\" for res in all_results\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}