{
    "hands_on_practices": [
        {
            "introduction": "生物体内的信息传递过程，例如DNA复制和蛋白质合成，其精确度高得惊人。这种高保真度并非凭空而来，而是需要付出热力学代价的。本练习旨在引导你从基本原理出发，推导耗散能量与可达到的最高保真度之间的基本关系，这是动力学校对（kinetic proofreading）理论的基石。",
            "id": "4338024",
            "problem": "考虑一个细胞环境中的单酶选择系统（例如，转移核糖核酸合成酶），该系统在产物形成过程中必须区分正确底物和错误底物。该酶在一个通过与三磷酸腺苷（ATP）水解耦合而维持的静态非平衡稳态下运行。假设正确底物和错误底物的浓度相同，与酶的扩散限制性结合动力学相同，并且一旦达到活化中间体，其催化步骤动力学也相同。这两种底物之间唯一的内在平衡差异在于酶-底物结合步骤中的识别自由能偏置：相对于正确底物，错误底物的结合自由能高出 $\\Delta\\varepsilon>0$。\n\n假设动力学是马尔可夫的，并遵循具有局域细致平衡的微观可逆性：对于酶-底物微观状态之间的任何基元跃迁 $i\\to j$，正向和反向跃迁速率之比满足\n$$\n\\ln\\!\\left(\\frac{k_{ij}}{k_{ji}}\\right)=\\beta\\big(\\Delta\\mu_{ij}-\\Delta G_{ij}\\big),\n$$\n其中 $\\beta\\equiv 1/(k_B T)$，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$\\Delta\\mu_{ij}$ 是ATP耦合在该跃迁上的化学势贡献，而 $\\Delta G_{ij}$ 是在没有ATP耦合时微观状态之间的平衡自由能变化。网络结构可以是任意复杂的，并且可能包含一个或多个校对分支，这些分支在耗散化学功的同时将酶循环回上游状态。\n\n定义稳态下错误产物与正确产物的通量比为\n$$\n\\eta \\equiv \\frac{J_{\\mathrm{wrong}}}{J_{\\mathrm{right}}},\n$$\n其中 $J_{\\mathrm{wrong}}$ 和 $J_{\\mathrm{right}}$ 分别是对应于掺入错误底物和正确底物的吸收产物态的稳态通量。假设酶循环是紧密耦合的，使得每一个被接受的产物（无论其种类）在从初始结合到产物释放的一系列跃迁中，通过ATP水解精确地耗散数量为 $W$ 的化学功。\n\n仅使用上述假设和基本热力学原理，在固定的 $W$ 和 $T$ 下，推导可实现的最小稳态通量比 $\\eta_{\\min}$。将您的最终答案表示为仅包含 $\\Delta\\varepsilon$、$W$、$k_B$ 和 $T$ 的单个闭式解析表达式。无需四舍五入，答案应为无量纲。",
            "solution": "用户希望我解决一个关于酶选择系统中最小错误率的问题。\n\n### 第1步：提取已知条件\n-   **系统**：在静态非平衡稳态下执行底物选择的单个酶。\n-   **底物**：正确（R）和错误（W）。\n-   **条件**：\n    -   $[S_R] = [S_W]$（浓度相同）。\n    -   R和W具有相同的扩散限制性结合动力学。\n    -   达到活化中间体后，催化步骤动力学相同。\n-   **能量偏置**：错误底物的结合自由能比正确底物高 $\\Delta\\varepsilon > 0$。$\\Delta G_{\\text{bind}, W} - \\Delta G_{\\text{bind}, R} = \\Delta\\varepsilon$。\n-   **动力学**：马尔可夫的，具有局域细致平衡。状态 $i,j$ 之间的正向（$k_{ij}$）与反向（$k_{ji}$）跃迁速率之比为 $\\ln(k_{ij}/k_{ji}) = \\beta(\\Delta\\mu_{ij} - \\Delta G_{ij})$，其中 $\\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$\\Delta\\mu_{ij}$ 是ATP耦合的化学功，$\\Delta G_{ij}$ 是平衡自由能变化。\n-   **网络**：任意复杂，可能包含校对分支。\n-   **区分度量**：稳态下错误产物与正确产物的通量比 $\\eta \\equiv J_W / J_R$。\n-   **能量成本**：每个被接受的产物（R或W）在从结合到释放的跃迁过程中，通过ATP水解精确耗散化学功 $W$。\n-   **目标**：推导可实现的最小通量比 $\\eta_{\\min}$，用 $\\Delta\\varepsilon$、$W$、$k_B$ 和 $T$ 表示。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题是生物物理精确性和动力学校对研究中的一个经典表述，最初由 Hopfield 和 Ninio 构想。所使用的概念——非平衡稳态、局域细致平衡、自由能、化学功和反应通量——在统计力学和化学物理中是标准概念。该问题牢固地植根于已确立的科学原理。\n-   **良构的**：该问题要求的是 $\\eta$ 的*最小*可实现值，这是一个明确定义的优化问题：找到一个对任何符合给定热力学和动力学约束的网络结构都成立的 $\\eta$ 的下界。预期这样的界是存在且唯一的。\n-   **目标**：该问题使用精确、定量且无偏见的语言陈述。所有术语在该领域都是标准的。\n\n该问题不违反任何无效标准。它是一个良构的、科学上合理的理论问题。开始求解。\n\n### 第3步：求解推导\n\n该问题要求酶选择过程中错误率 $\\eta = J_W/J_R$ 的一个基本下界。这个界必须对任何符合给定约束的动力学方案（即任何网络结构）都成立。这样的界可以从一般热力学原理推导出来，而无需限定于特定模型。\n\n酶区分正确底物 $S_R$ 和错误底物 $S_W$ 的能力源于被动力学过程放大的热力学差异。我们可以识别出两种可用于区分的热力学资源：\n\n1.  **平衡自由能偏置 ($\\Delta\\varepsilon$)**: 问题陈述，错误底物的结合自由能高出 $\\Delta\\varepsilon$。这是一个内在的、基于平衡的差异。在一个纯粹的平衡系统中（即没有任何能量耗散，$W=0$），过程将是完全可逆的。在平衡状态下，形成错误产物与正确产物的概率之比将由反应的总自由能变化决定。假设溶液中底物 $S_R, S_W$ 的自由能相同（因为浓度相同），并且产物 $P_R, P_W$ 的自由能差异也由相同的结合惩罚决定（这些模型中的一个常见假设，即 $\\Delta G(P_W) - \\Delta G(P_R) = \\Delta\\varepsilon$），那么总自由能变化将是 $\\Delta G_{S_R \\to P_R}$ 和 $\\Delta G_{S_W \\to P_W} = \\Delta G_{S_R \\to P_R} + \\Delta\\varepsilon$。平衡时产物之比将是 $\\eta_{eq} = \\exp(-\\beta \\Delta\\varepsilon)$。任何最优的、可逆的（$W=0$）动力学方案最多只能达到这个平衡区分极限。因此，$\\eta_{\\min}(W=0) = \\exp(-\\beta\\Delta\\varepsilon)$。\n\n2.  **非平衡驱动 ($W$)**: 系统通过将反应与ATP水解耦合而被驱动脱离平衡，每形成一个产物分子就耗散数量为 $W$ 的功。这个耗散的功是一种热力学资源，可用于将选择过程的准确性提高到平衡极限之上。这就是动力学校对的原理。功 $W$ 允许系统执行动力学上不可逆的步骤，这些步骤可以被设计成优先丢弃错误底物，从而放大由 $\\Delta\\varepsilon$ 提供的初始区分能力。\n\n我们正在寻找最小可能错误 $\\eta_{\\min}$。这对应于将可用热力学资源转化为准确性的最有效可能机制。在这样一个理想的过程中，两种资源——平衡偏置和耗散的功——将加性地贡献于一个总的有效区分势。\n\n让我们定义可用于区分的总热力学势 $\\Delta G_{\\text{discrim}}$。这个势是内在自由能差异和由外部过程提供的自由能之和：\n$$\n\\Delta G_{\\text{discrim}} = \\Delta\\varepsilon + W\n$$\n这个和代表了一个假设的、完全高效的“麦克斯韦妖”酶可以用来区分错误底物和正确底物的总自由能。\n\n在任何热力学过程中，两个结果之间的最大可达到概率比通过一个类玻尔兹曼因子与它们之间的自由能差相关联。在我们的例子中，正确与错误结果的比率（$1/\\eta = J_R/J_W$）与区分能有关。对于最有效的过程，这种关系成为一个等式：\n$$\n\\left(\\frac{J_R}{J_W}\\right)_{\\max} = \\exp\\left(\\frac{\\Delta G_{\\text{discrim}}}{k_B T}\\right)\n$$\n这对应于最小可能错误率 $\\eta_{\\min}$：\n$$\n\\eta_{\\min} = \\frac{1}{(J_R/J_W)_{\\max}} = \\exp\\left(-\\frac{\\Delta G_{\\text{discrim}}}{k_B T}\\right)\n$$\n代入总区分势的表达式并使用定义 $\\beta = 1/(k_B T)$：\n$$\n\\eta_{\\min} = \\exp\\left(-\\frac{\\Delta\\varepsilon + W}{k_B T}\\right) = \\exp(-\\beta(\\Delta\\varepsilon + W))\n$$\n\n这个结果代表了准确性的最终热力学极限。任何真实世界的动力学方案效率都会更低，导致错误率 $\\eta \\ge \\eta_{\\min}$。低效率可能源于在不增强区分能力的情况下浪费能量的无效循环，或者源于没有在每个可能的检查点充分利用 $\\Delta\\varepsilon$ 的动力学设计。问题要求的是可实现的最小比率，这正是这个热力学界限。\n\n该公式正确地捕捉了极限情况：\n-   如果 $W=0$（无能量消耗），界限变为 $\\eta_{\\min} = \\exp(-\\beta\\Delta\\varepsilon)$，这是由平衡热力学施加的我们所熟悉的极限。\n-   如果 $\\Delta\\varepsilon=0$（无内在结合差异），界限为 $\\eta_{\\min} = \\exp(-\\beta W)$。这是朗道尔原理的一种体现，它将能量成本与在测量或计算中获得的信息（或减少的错误）联系起来。\n\n最终表达式仅依赖于给定的热力学量 $\\Delta\\varepsilon$、$W$ 和 $T$，符合题目要求。",
            "answer": "$$\\boxed{\\exp\\left(-\\frac{\\Delta\\varepsilon + W}{k_B T}\\right)}$$"
        },
        {
            "introduction": "在理解了生物保真度的普适热力学极限后，我们将这一理论应用于一个具体的生物学过程。本练习要求你量化DNA聚合酶为达到人类细胞中观察到的极低错误率，所必须消耗的最小能量（以ATP水解的形式）。通过这个计算，你将把抽象的热力学原理与可测量的生物化学量联系起来。",
            "id": "4337963",
            "problem": "人体细胞中的一种脱氧核糖核酸（DNA）聚合酶在温度 $T=310\\,\\mathrm{K}$ 下，通过将在活性位点的平衡碱基配对区分与一个消耗三磷酸腺苷（ATP）水解产生的化学自由能的下游动力学校对步骤相结合，实现了高复制保真度。假设存在以下具有科学依据的设定：\n\n- 活性位点对正确与错误核苷酸的平衡区分提供了一个大小为 $\\Delta G_{d}=15\\,\\mathrm{kJ\\,mol^{-1}}$ 的自由能偏置，有利于正确底物。\n- 动力学校对步骤由每个掺入的核苷酸的净化学自由能输入 $\\Delta \\mu$（源于ATP水解及后续耦合）驱动，其作用是进一步抑制错误核苷酸的掺入。\n- 系统在稳态非平衡状态附近运行，其中选择过程可以通过与玻尔兹曼分布和化学循环亲和力一致的能量偏置占有率和通量比进行建模。\n\n从温度 $T$ 下状态概率与自由能差异之间的基本关系，以及一个被驱动的化学循环贡献的亲和力与输入自由能成正比这一事实出发，推导出一个解析表达式，用于计算实现每个掺入核苷酸的目标错误概率 $\\epsilon_{t}=10^{-9}$ 所需的最小 $\\Delta \\mu$。然后，使用 $R=8.314\\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$ 和 $T=310\\,\\mathrm{K}$ 计算 $\\Delta \\mu$ 的数值。最终答案以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "首先对问题的有效性进行评估。\n\n### 第一步：提取已知条件\n- 系统：人类细胞中的DNA聚合酶。\n- 温度：$T = 310\\,\\mathrm{K}$。\n- 保真机制：平衡碱基配对区分与随后的单一步骤动力学校对相结合。\n- 校对能量来源：ATP水解，为每个核苷酸提供净自由能输入 $\\Delta \\mu$。\n- 平衡区分自由能偏置：$\\Delta G_{d} = 15\\,\\mathrm{kJ\\,mol^{-1}}$，有利于正确底物。\n- 每个掺入核苷酸的目标错误概率：$\\epsilon_{t} = 10^{-9}$。\n- 物理常数：普适气体常数，$R = 8.314 \\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。\n- 建模框架：稳态非平衡状态，通过能量偏置的占有率/通量比和化学亲和力对选择过程进行建模。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于成熟的动力学校对理论，该理论最初由 John Hopfield 和 Jacques Ninio 提出，用以解释生物信息传递过程（如DNA复制和蛋白质合成）的高保真度。给定的温度、自由能差异和错误率等数值，对于这些系统而言，均在物理和生物学上的现实范围内。\n- **适定性**：该问题提供了所有必要的参数（$T$, $\\Delta G_d$, $\\epsilon_t$, $R$），以确定唯一的未知变量，即最小 $\\Delta \\mu$。问题陈述清晰，可以导出一个唯一、稳定且有意义的解。\n- **客观性**：问题使用了精确、定量且无偏见的科学语言进行陈述。\n\n### 第三步：结论与行动\n该问题被判定为**有效**，因为它具有科学依据、适定且客观。将推导完整的解。\n\n### 解题推导\n\n在一个多步选择过程中，总错误概率 $\\epsilon_t$ 是各个独立步骤错误概率的乘积，前提是假设这些步骤是顺序且独立的。所描述的系统有两个这样的步骤：一个初始的平衡区分步骤和一个随后的非平衡动力学校对步骤。\n\n设第一步（平衡区分）的错误抑制因子为 $f_d$，第二步（动力学校对）的错误抑制因子为 $f_k$。则总错误概率由下式给出：\n$$\n\\epsilon_t = f_d \\cdot f_k\n$$\n\n1.  **平衡区分 ($f_d$)**\n    平衡区分步骤根据结合自由能的差异 $\\Delta G_d$ 来区分正确与错误的核苷酸。错误核苷酸与正确核苷酸的结合概率之比遵循玻尔兹曼分布。在假设竞争底物浓度相等的情况下，这个比率可以作为此步骤的错误因子。\n    $$\n    f_d = \\exp\\left(-\\frac{\\Delta G_d}{RT}\\right)\n    $$\n    此处，$R$ 是普适气体常数，$T$ 是绝对温度。\n\n2.  **动力学校对 ($f_k$)**\n    动力学校对步骤利用来自ATP水解的外部自由能来源 $\\Delta \\mu$ 来驱动一个非平衡过程，从而进一步抑制错误。此步骤提供了一个额外的错误抑制因子 $f_k$。根据应用于信息处理的非平衡热力学原理，要实现一个错误抑制因子 $f_k$，必须耗散至少为 $\\Delta \\mu$ 的自由能。在这个热力学极限下的关系是：\n    $$\n    f_k = \\exp\\left(-\\frac{\\Delta \\mu}{RT}\\right)\n    $$\n    这个方程给出了在给定能量输入 $\\Delta \\mu$ 下可能的最大错误抑制。由于题目要求的是实现目标错误率所需的*最小* $\\Delta \\mu$，我们假设该过程在此最大效率下运行。\n\n3.  **总错误与 $\\Delta \\mu$ 的推导**\n    结合这两个因子，总错误概率为：\n    $$\n    \\epsilon_t = f_d \\cdot f_k = \\exp\\left(-\\frac{\\Delta G_d}{RT}\\right) \\cdot \\exp\\left(-\\frac{\\Delta \\mu}{RT}\\right) = \\exp\\left(-\\frac{\\Delta G_d + \\Delta \\mu}{RT}\\right)\n    $$\n    我们现在可以对这个方程求解 $\\Delta \\mu$。对两边取自然对数：\n    $$\n    \\ln(\\epsilon_t) = -\\frac{\\Delta G_d + \\Delta \\mu}{RT}\n    $$\n    两边同乘以 $-RT$：\n    $$\n    -RT \\ln(\\epsilon_t) = \\Delta G_d + \\Delta \\mu\n    $$\n    分离出 $\\Delta \\mu$ 得到所需最小自由能输入的解析表达式：\n    $$\n    \\Delta \\mu = -RT \\ln(\\epsilon_t) - \\Delta G_d\n    $$\n\n4.  **数值计算**\n    我们将给定值代入推导出的表达式。\n    -   $\\epsilon_t = 10^{-9}$\n    -   $\\Delta G_d = 15\\,\\mathrm{kJ\\,mol^{-1}}$\n    -   $R = 8.314 \\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$\n    -   $T = 310\\,\\mathrm{K}$\n\n    首先，计算热能项 $RT$：\n    $$\n    RT = (8.314 \\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}) \\times (310\\,\\mathrm{K}) = 2.57734\\,\\mathrm{kJ\\,mol^{-1}}\n    $$\n    接着，计算包含错误率对数的项：\n    $$\n    \\ln(\\epsilon_t) = \\ln(10^{-9}) = -9 \\ln(10)\n    $$\n    使用近似值 $\\ln(10) \\approx 2.302585$：\n    $$\n    \\ln(\\epsilon_t) \\approx -9 \\times 2.302585 = -20.723265\n    $$\n    现在，我们可以计算 $\\Delta \\mu$ 表达式的第一项：\n    $$\n    -RT \\ln(\\epsilon_t) = -(2.57734\\,\\mathrm{kJ\\,mol^{-1}}) \\times (-20.723265) \\approx 53.411605\\,\\mathrm{kJ\\,mol^{-1}}\n    $$\n    最后，我们减去 $\\Delta G_d$ 以求得 $\\Delta \\mu$：\n    $$\n    \\Delta \\mu = (53.411605\\,\\mathrm{kJ\\,mol^{-1}}) - (15\\,\\mathrm{kJ\\,mol^{-1}}) = 38.411605\\,\\mathrm{kJ\\,mol^{-1}}\n    $$\n    题目要求答案四舍五入到四位有效数字。\n    $$\n    \\Delta \\mu \\approx 38.41\\,\\mathrm{kJ\\,mol^{-1}}\n    $$",
            "answer": "$$\n\\boxed{38.41}\n$$"
        },
        {
            "introduction": "现在，让我们将视角从单个分子的精确性转向大规模系统的复杂性。生物功能通常源于分子间相互作用形成的复杂网络。本计算练习将介绍几种基于熵的度量方法，用于量化这些网络的结构和信息含量，为你提供从网络视角比较和分析不同生物系统的实用工具。",
            "id": "4338023",
            "problem": "给定的是用于模拟生物分子实体间相互作用的无向加权网络。设网络由一个对称的非负权重矩阵 $W \\in \\mathbb{R}_{\\ge 0}^{n \\times n}$ 表示，其中 $W_{ii} = 0$ 且 $W_{ij} = W_{ji}$。考虑网络上的离散时间随机游走，其行随机转移矩阵 $P$ 定义为 $P_{ij} = \\frac{W_{ij}}{\\sum_{k=1}^{n} W_{ik}}$，适用于所有满足 $\\sum_{k} W_{ik} > 0$ 的 $i$ 和 $j$。假设网络是连通的，因此马尔可夫链是不可约的。平稳分布 $\\pi \\in \\mathbb{R}^{n}$ 满足 $\\pi^{\\top} P = \\pi^{\\top}$ 和 $\\sum_{i=1}^{n} \\pi_{i} = 1$，且 $\\pi_{i} \\ge 0$。\n\n使用 Gibbs–Shannon 熵和 Kullback–Leibler 散度的基本定义，以及组合图拉普拉斯算子 $L = D - W$（其中 $D = \\mathrm{diag}(s)$，$s_{i} = \\sum_{j=1}^{n} W_{ij}$）的定义，定义以下三种网络熵度量，单位为奈特（nats，以自然对数 $e$ 为底）：\n\n1. 随机游走的熵率：\n   $$H_{\\mathrm{rate}}(P,\\pi) = - \\sum_{i=1}^{n} \\pi_{i} \\sum_{j=1}^{n} P_{ij} \\log P_{ij},$$\n   约定 $0 \\log 0 = 0$。\n\n2. 网络拉普拉斯密度矩阵的 von Neumann 熵。构造半正定矩阵 $L = D - W$，并定义密度矩阵 $\\rho = \\frac{L}{\\mathrm{Tr}(L)}$。设 $\\{\\lambda_{k}\\}_{k=1}^{n}$ 是 $\\rho$ 的特征值。von Neumann 熵为\n   $$S_{\\mathrm{vN}}(\\rho) = - \\sum_{k=1}^{n} \\lambda_{k} \\log \\lambda_{k},$$\n   约定 $0 \\log 0 = 0$。\n\n3. 在相同节点集上定义的两个随机游走 $P^{A}$ 和 $P^{B}$ 之间的 Kullback–Leibler 散度率，在 $P^{A}$ 的平稳分布 $\\pi^{A}$ 下进行评估：\n   $$D_{\\mathrm{rate}}(P^{A} \\,\\|\\, P^{B}; \\pi^{A}) = \\sum_{i=1}^{n} \\pi^{A}_{i} \\sum_{j=1}^{n} P^{A}_{ij} \\log \\frac{P^{A}_{ij}}{P^{B}_{ij}},$$\n   假设只要 $P^{A}_{ij} > 0$，就有 $P^{B}_{ij} > 0$。\n\n您的任务是实现一个程序，对于每个指定的测试用例，从提供的 $W^{A}$ 和 $W^{B}$ 构建 $P^{A}$ 和 $P^{B}$，计算 $\\pi^{A}$，并返回一个包含三个实数的三元组\n$$\\left[ H_{\\mathrm{rate}}(P^{A},\\pi^{A}),\\ S_{\\mathrm{vN}}\\!\\left(\\frac{L^{A}}{\\mathrm{Tr}(L^{A})}\\right),\\ D_{\\mathrm{rate}}(P^{A} \\,\\|\\, P^{B}; \\pi^{A}) \\right],$$\n所有值均以奈特表示，并四舍五入到恰好 $6$ 位小数。此处 $L^{A} = D^{A} - W^{A}$ 且 $D^{A} = \\mathrm{diag}(s^{A})$，$s^{A}_{i} = \\sum_{j=1}^{n} W^{A}_{ij}$。\n\n在整个计算过程中使用自然对数。所有网络都是连通的，并满足所述的 Kullback–Leibler 散度率的支撑集条件。\n\n参数值测试套件：\n\n- 测试用例 1 ($n = 3$):\n  $$W^{A} = \\begin{bmatrix}\n  0  2  1 \\\\\n  2  0  1 \\\\\n  1  1  0\n  \\end{bmatrix},\\quad\n  W^{B} = \\begin{bmatrix}\n  0  1.5  1.5 \\\\\n  1.5  0  1 \\\\\n  1.5  1  0\n  \\end{bmatrix}.$$\n\n- 测试用例 2 ($n = 4$):\n  $$W^{A} = \\begin{bmatrix}\n  0  1  0.5  0.5 \\\\\n  1  0  2  0 \\\\\n  0.5  2  0  1 \\\\\n  0.5  0  1  0\n  \\end{bmatrix},\\quad\n  W^{B} = \\begin{bmatrix}\n  0  0.8  0.7  0.5 \\\\\n  0.8  0  1.5  0.2 \\\\\n  0.7  1.5  0  0.9 \\\\\n  0.5  0.2  0.9  0\n  \\end{bmatrix}.$$\n\n- 测试用例 3 ($n = 5$):\n  $$W^{A} = \\begin{bmatrix}\n  0  1  0  0.5  0.2 \\\\\n  1  0  0.3  0  0.4 \\\\\n  0  0.3  0  0.7  1.0 \\\\\n  0.5  0  0.7  0  0.6 \\\\\n  0.2  0.4  1.0  0.6  0\n  \\end{bmatrix},\\quad\n  W^{B} = \\begin{bmatrix}\n  0  1.2  0.1  0.4  0.3 \\\\\n  1.2  0  0.5  0.2  0.5 \\\\\n  0.1  0.5  0  0.9  0.8 \\\\\n  0.4  0.2  0.9  0  0.7 \\\\\n  0.3  0.5  0.8  0.7  0\n  \\end{bmatrix}.$$\n\n最终输出格式要求：\n\n- 对于每个测试用例，按 $\\left[H_{\\mathrm{rate}}, S_{\\mathrm{vN}}, D_{\\mathrm{rate}}\\right]$ 的顺序输出一个包含三个浮点数的列表，每个浮点数四舍五入到恰好 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的、由逗号分隔的各用例列表。例如：$\\left[[h_{1}, s_{1}, d_{1}], [h_{2}, s_{2}, d_{2}], [h_{3}, s_{3}, d_{3}]\\right]$，其中每个 $h_{i}$、$s_{i}$ 和 $d_{i}$ 都是小数点后恰好有 $6$ 位数字的十进制数。",
            "solution": "用户提供的问题陈述是有效的。它具有科学依据，定义明确，客观，并包含进行求解所需的所有必要信息。该问题要求实现三种定义明确的网络熵度量，这些度量源于信息论和谱图论的基本原理。提供的测试用例是完整的，并与问题的约束条件一致。\n\n将通过对每个测试用例遵循系统、分步的计算程序来实现解决方案。每个测试用例为定义在相同节点集上的网络提供了两个权重矩阵 $W^A$ 和 $W^B$。\n\n解决方案的核心涉及对每对 $(W^A, W^B)$ 进行以下一系列计算：\n\n1.  **网络 A 的预处理**：\n    a.  从权重矩阵 $W^A$，我们首先计算节点强度向量 $s^A$，其中每个元素 $s^A_i = \\sum_{j=1}^{n} W^A_{ij}$。\n    b.  然后构建随机游走的转移矩阵 $P^A$。每个元素 $P^A_{ij}$ 由归一化 $W^A_{ij} / s^A_i$ 给出。问题陈述保证了网络是连通的，这意味着所有节点至少有一条边，因此所有 $s^A_i > 0$，从而避免了除以零。\n    c.  对于一个无向连通网络，随机游走的平稳分布 $\\pi^A$ 有一个已知的闭式解：$\\pi^A_i = s^A_i / \\sum_{k=1}^{n} s^A_k$。分母是所有强度的总和，也等于图拉普拉斯算子的迹，$\\mathrm{Tr}(L^A)$。\n    d.  网络 A 的组合图拉普拉斯算子 $L^A$ 计算为 $L^A = D^A - W^A$，其中 $D^A$ 是节点强度的对角矩阵，$D^A = \\mathrm{diag}(s^A)$。\n\n2.  **网络 B 的预处理**：\n    a.  同样地，我们计算网络 B 的强度向量 $s^B$ 和转移矩阵 $P^B$。\n\n3.  **熵度量的计算**：\n    a.  **熵率, $H_{\\mathrm{rate}}(P^A, \\pi^A)$**：这是转移概率的期望香农熵，在平稳分布上取平均。公式为 $H_{\\mathrm{rate}} = - \\sum_{i} \\pi^A_i \\sum_{j} P^A_{ij} \\log P^A_{ij}$。这可以通过首先计算转移矩阵 $P^A$ 的每一行的香农熵（我们称此向量为 $H(P^A_{\\text{rows}})$），然后与平稳分布向量进行点积来计算：$H_{\\mathrm{rate}} = \\pi^A \\cdot H(P^A_{\\text{rows}})$。约定 $0 \\log 0 = 0$ 通过确保 $P^A_{ij} = 0$ 的项对总和的贡献为零来处理。\n\n    b.  **von Neumann 熵, $S_{\\mathrm{vN}}$**：这个度量量化了由其拉普拉斯算子捕获的网络结构的熵。我们首先构建密度矩阵 $\\rho^A = L^A / \\mathrm{Tr}(L^A)$。由于 $L^A$ 是一个对称半正定矩阵，$\\rho^A$ 也是。$\\rho^A$ 的特征值 $\\{\\lambda_k\\}$ 是非负的，并且总和为 1，形成一个概率分布。von Neumann 熵是该特征值分布的香农熵：$S_{\\mathrm{vN}} = - \\sum_{k} \\lambda_k \\log \\lambda_k$。计算过程涉及求 $\\rho^A$ 的特征值，然后应用熵公式，同样遵守对于任何零特征值的 $0 \\log 0 = 0$ 约定。\n\n    c.  **Kullback–Leibler (KL) 散度率, $D_{\\mathrm{rate}}$**：这个度量衡量了使用网络 B 的转移概率来预测网络 A 上随机游走步骤的低效率。它是转移概率之间的期望 KL 散度，在网络 A 的平稳分布上取平均。公式为 $D_{\\mathrm{rate}} = \\sum_{i} \\pi^A_i \\left( \\sum_{j} P^A_{ij} \\log \\frac{P^A_{ij}}{P^B_{ij}} \\right)$。内部的和是 $P^A$ 的第 $i$ 行与 $P^B$ 的第 $i$ 行之间的 KL 散度。与熵率类似，这是通过首先计算每对相应行的 KL 散度，然后与 $\\pi^A$ 进行点积来计算的。问题条件 $P^A_{ij} > 0 \\implies P^B_{ij} > 0$ 确保了对数总是有定义的。\n\n如指定，所有计算均使用自然对数（以 $e$ 为底）。三种度量的最终数值结果将四舍五入到恰好六位小数，并按要求格式化。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import entropy\n\ndef solve():\n    \"\"\"\n    Computes three network entropy measures for a suite of test cases.\n    \"\"\"\n    # Define the test cases as pairs of weight matrices (W^A, W^B).\n    test_cases = [\n        (\n            np.array([[0, 2, 1], [2, 0, 1], [1, 1, 0]], dtype=float),\n            np.array([[0, 1.5, 1.5], [1.5, 0, 1], [1.5, 1, 0]], dtype=float)\n        ),\n        (\n            np.array([[0, 1, 0.5, 0.5], [1, 0, 2, 0], [0.5, 2, 0, 1], [0.5, 0, 1, 0]], dtype=float),\n            np.array([[0, 0.8, 0.7, 0.5], [0.8, 0, 1.5, 0.2], [0.7, 1.5, 0, 0.9], [0.5, 0.2, 0.9, 0]], dtype=float)\n        ),\n        (\n            np.array([[0, 1, 0, 0.5, 0.2], [1, 0, 0.3, 0, 0.4], [0, 0.3, 0, 0.7, 1.0], [0.5, 0, 0.7, 0, 0.6], [0.2, 0.4, 1.0, 0.6, 0]], dtype=float),\n            np.array([[0, 1.2, 0.1, 0.4, 0.3], [1.2, 0, 0.5, 0.2, 0.5], [0.1, 0.5, 0, 0.9, 0.8], [0.4, 0.2, 0.9, 0, 0.7], [0.3, 0.5, 0.8, 0.7, 0]], dtype=float)\n        )\n    ]\n    \n    # This list will hold the formatted string for each test case result.\n    final_results_str = []\n\n    # Process each test case.\n    for W_A, W_B in test_cases:\n        # --- Calculations for Network A ---\n\n        # Strengths s_i = sum_j W_ij.\n        s_A = W_A.sum(axis=1)\n        # Total strength (volume of the graph), also Tr(L).\n        total_strength_A = s_A.sum()\n        \n        # Stationary distribution pi_i = s_i / sum(s).\n        pi_A = s_A / total_strength_A\n        \n        # Transition matrix P_A (P_ij = W_ij / s_i).\n        # np.errstate guards against division by zero, though the problem statement\n        # guarantees connectivity, so s_i > 0 for all i.\n        with np.errstate(divide='ignore', invalid='ignore'):\n            P_A = W_A / s_A[:, np.newaxis]\n        P_A = np.nan_to_num(P_A)\n\n        # --- Calculations for Network B ---\n\n        # Strengths s_i for network B.\n        s_B = W_B.sum(axis=1)\n        # Transition matrix P_B for network B.\n        with np.errstate(divide='ignore', invalid='ignore'):\n            P_B = W_B / s_B[:, np.newaxis]\n        P_B = np.nan_to_num(P_B)\n        \n        # --- Compute the three entropy measures ---\n\n        # 1. Entropy Rate H_rate(P^A, pi^A)\n        # H_rate = sum_i(pi_i * H(P^A_i)), where H(P^A_i) is the Shannon entropy of row i of P_A.\n        h_row_entropies = entropy(P_A, axis=1, base=np.e)\n        h_rate = np.dot(pi_A, h_row_entropies)\n\n        # 2. Von Neumann Entropy S_vN(rho^A)\n        # Combinatorial Laplacian L = D - W.\n        D_A = np.diag(s_A)\n        L_A = D_A - W_A\n        # Density matrix rho = L / Tr(L).\n        rho_A = L_A / total_strength_A\n        # Eigenvalues of the symmetric matrix rho^A.\n        eigs_rho = np.linalg.eigvalsh(rho_A)\n        # Filter for positive eigenvalues to handle numerical precision (0 could be ~-1e-17)\n        # and to match the 0 log 0 = 0 convention.\n        pos_eigs = eigs_rho[eigs_rho > 1e-15]\n        # S_vN = - sum(lambda * log(lambda)) for the eigenvalue distribution.\n        s_vn = -np.sum(pos_eigs * np.log(pos_eigs))\n\n        # 3. KL Divergence Rate D_rate(P^A || P^B; pi^A)\n        # D_rate = sum_i(pi_i * D_KL(P^A_i || P^B_i)).\n        # scipy.stats.entropy(p, q) computes KL divergence D_KL(p || q).\n        kl_divs_rows = entropy(P_A, P_B, axis=1, base=np.e)\n        d_rate = np.dot(pi_A, kl_divs_rows)\n        \n        # Format the results for this case into a string \"[h, s, d]\".\n        case_str = f\"[{h_rate:.6f}, {s_vn:.6f}, {d_rate:.6f}]\"\n        final_results_str.append(case_str)\n\n    # Combine all case strings into the final output format \"[[...], [...], ...]\".\n    print(f\"[{', '.join(final_results_str)}]\")\n\nsolve()\n```"
        }
    ]
}