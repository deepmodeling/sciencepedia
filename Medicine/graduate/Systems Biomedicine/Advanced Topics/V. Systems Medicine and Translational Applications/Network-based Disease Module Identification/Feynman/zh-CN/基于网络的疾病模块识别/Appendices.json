{
    "hands_on_practices": [
        {
            "introduction": "在网络医学中，一个核心假设是与特定疾病相关的基因倾向于在蛋白质相互作用（PPI）网络中形成紧密连接的“疾病模块”。因此，识别这些模块是理解疾病机制的关键一步。模块度（Modularity, $Q$）是衡量网络划分为社区（或模块）的质量的经典指标。本练习通过一个具体的计算任务，帮助你深入理解模块度的定义，即比较社区内部连接的紧密程度与在保持节点度数不变的随机网络中的期望值，从而为基于社区发现的模块识别方法打下坚实基础 。",
            "id": "4369095",
            "problem": "在系统生物医学中，基于网络的疾病模块识别通常通过最大化一个质量函数来推断社群，该函数将观测到的模块内连通性与一个度保持的零模型进行比较。考虑一个由$8$个基因产物组成的无向、无权、无自环的蛋白质-蛋白质相互作用网络，其邻接矩阵为 $\\mathbf{A}$，节点标签为 $\\{1,2,3,4,5,6,7,8\\}$：\n$$\n\\mathbf{A}=\n\\begin{pmatrix}\n0  1  1  0  0  0  0  0\\\\\n1  0  1  1  0  0  0  0\\\\\n1  1  0  1  1  0  0  0\\\\\n0  1  1  0  1  1  0  0\\\\\n0  0  1  1  0  1  1  0\\\\\n0  0  0  1  1  0  1  1\\\\\n0  0  0  0  1  1  0  1\\\\\n0  0  0  0  0  1  1  0\n\\end{pmatrix}.\n$$\n为推定的疾病模块搜索提出了两种候选划分：\n- 划分 $\\mathcal{P}_{A}$，社群为 $\\{1,2,3,4\\}$ 和 $\\{5,6,7,8\\}$，\n- 划分 $\\mathcal{P}_{B}$，社群为 $\\{1,2,3\\}$ 和 $\\{4,5,6,7,8\\}$。\n\n使用基于配置模型零模型（其中零模型下的期望边数保持节点度数）的模块度 $Q$ 的标准定义，仅根据给定信息计算每个划分的 $Q$ 值，并选择模块度更高的划分。然后，用一句话解释，在社群内连通性与度驱动的期望方面，模块度更高的划分对于该网络中合理的疾病模块意味着什么。\n\n仅将较高的模块度值 $Q_{\\max}$ 作为最终数值答案报告，四舍五入到四位有效数字。答案以纯数字形式表示（无单位）。",
            "solution": "该问题在网络科学中有科学依据，提法明确且包含所有必要信息，陈述客观，因此是有效的。我们可以进行计算。\n\n网络划分为社群的模块度 $Q$ 是衡量该划分强度的一个指标。它被定义为：落在给定社群内部的边所占的比例，减去在保持节点度数的情况下（即配置模型）随机分布边时期望的这一比例。对于一个无权、无向网络，其公式为：\n$$\nQ = \\frac{1}{2m} \\sum_{i,j} \\left[ A_{ij} - \\frac{k_i k_j}{2m} \\right] \\delta(c_i, c_j)\n$$\n其中 $m$ 是总边数，$A_{ij}$ 是节点 $i$ 和 $j$ 之间的邻接矩阵元素，$k_i$ 是节点 $i$ 的度，$c_i$ 是节点 $i$ 所属的社群，$\\delta(c_i, c_j)$ 是克罗内克δ函数。一个等价且更实用的公式是对社群进行求和：\n$$\nQ = \\sum_{c} \\left[ \\frac{L_c}{m} - \\left( \\frac{K_c}{2m} \\right)^2 \\right]\n$$\n其中 $L_c$ 是完全在社群 $c$ 内部的边数，$K_c$ 是社群 $c$ 中所有节点的度之和。\n\n首先，我们根据给定的邻接矩阵 $\\mathbf{A}$ 确定整个网络的属性。每个节点 $i$ 的度 $k_i$ 是矩阵 $\\mathbf{A}$ 第 $i$ 行各项之和：\n$k_1 = 1+1 = 2$\n$k_2 = 1+1+1 = 3$\n$k_3 = 1+1+1+1 = 4$\n$k_4 = 1+1+1+1 = 4$\n$k_5 = 1+1+1+1 = 4$\n$k_6 = 1+1+1+1 = 4$\n$k_7 = 1+1+1 = 3$\n$k_8 = 1+1 = 2$\n\n总边数 $m$ 是所有度之和的一半：\n$$\nm = \\frac{1}{2}\\sum_{i=1}^{8} k_i = \\frac{1}{2}(2+3+4+4+4+4+3+2) = \\frac{26}{2} = 13\n$$\n\n现在，我们计算每个候选划分的模块度。\n\n**划分 $\\mathcal{P}_{A}$:**\n社群为 $C_1 = \\{1,2,3,4\\}$ 和 $C_2 = \\{5,6,7,8\\}$。\n\n对于社群 $C_1$：\n度之和为 $K_{C_1} = k_1+k_2+k_3+k_4 = 2+3+4+4 = 13$。\n内部边数 $L_{C_1}$ 是指两个端点都在 $C_1$ 内的边。这些边是 $(1,2)$、$(1,3)$、$(2,3)$、$(2,4)$ 和 $(3,4)$。因此，$L_{C_1} = 5$。\n\n对于社群 $C_2$：\n度之和为 $K_{C_2} = k_5+k_6+k_7+k_8 = 4+4+3+2 = 13$。\n内部边数 $L_{C_2}$ 是指两个端点都在 $C_2$ 内的边。这些边是 $(5,6)$、$(5,7)$、$(6,7)$、$(6,8)$ 和 $(7,8)$。因此，$L_{C_2} = 5$。\n\n划分 $\\mathcal{P}_A$ 的模块度 $Q_A$ 为：\n$$\nQ_A = \\left[ \\frac{L_{C_1}}{m} - \\left( \\frac{K_{C_1}}{2m} \\right)^2 \\right] + \\left[ \\frac{L_{C_2}}{m} - \\left( \\frac{K_{C_2}}{2m} \\right)^2 \\right]\n$$\n$$\nQ_A = \\left[ \\frac{5}{13} - \\left( \\frac{13}{2 \\times 13} \\right)^2 \\right] + \\left[ \\frac{5}{13} - \\left( \\frac{13}{2 \\times 13} \\right)^2 \\right]\n$$\n$$\nQ_A = 2 \\times \\left[ \\frac{5}{13} - \\left( \\frac{1}{2} \\right)^2 \\right] = 2 \\times \\left[ \\frac{5}{13} - \\frac{1}{4} \\right] = 2 \\times \\left[ \\frac{20-13}{52} \\right] = 2 \\times \\frac{7}{52} = \\frac{14}{52} = \\frac{7}{26}\n$$\n数值上，$Q_A \\approx 0.26923$。\n\n**划分 $\\mathcal{P}_{B}$:**\n社群为 $C'_1 = \\{1,2,3\\}$ 和 $C'_2 = \\{4,5,6,7,8\\}$。\n\n对于社群 $C'_1$：\n度之和为 $K_{C'_1} = k_1+k_2+k_3 = 2+3+4 = 9$。\n内部边为 $(1,2)$、$(1,3)$ 和 $(2,3)$。因此，$L_{C'_1} = 3$。\n\n对于社群 $C'_2$：\n度之和为 $K_{C'_2} = k_4+k_5+k_6+k_7+k_8 = 4+4+4+3+2 = 17$。\n内部边为 $(4,5)$、$(4,6)$、$(5,6)$、$(5,7)$、$(6,7)$、$(6,8)$ 和 $(7,8)$。因此，$L_{C'_2} = 7$。\n（作为检验，社群之间的边数为 $A_{24}+A_{34}+A_{35} = 1+1+1 = 3$。总边数 $m = L_{C'_1} + L_{C'_2} + (\\text{社群间边数}) = 3+7+3 = 13$，这是正确的）。\n\n划分 $\\mathcal{P}_B$ 的模块度 $Q_B$ 为：\n$$\nQ_B = \\left[ \\frac{L_{C'_1}}{m} - \\left( \\frac{K_{C'_1}}{2m} \\right)^2 \\right] + \\left[ \\frac{L_{C'_2}}{m} - \\left( \\frac{K_{C'_2}}{2m} \\right)^2 \\right]\n$$\n$$\nQ_B = \\left[ \\frac{3}{13} - \\left( \\frac{9}{26} \\right)^2 \\right] + \\left[ \\frac{7}{13} - \\left( \\frac{17}{26} \\right)^2 \\right]\n$$\n$$\nQ_B = \\frac{3}{13} + \\frac{7}{13} - \\frac{9^2}{26^2} - \\frac{17^2}{26^2} = \\frac{10}{13} - \\frac{81+289}{676} = \\frac{10}{13} - \\frac{370}{676}\n$$\n为了比较，我们通分到公分母 $676 = 13 \\times 52$：\n$$\nQ_B = \\frac{10 \\times 52}{676} - \\frac{370}{676} = \\frac{520 - 370}{676} = \\frac{150}{676} = \\frac{75}{338}\n$$\n数值上，$Q_B \\approx 0.22189$。\n\n比较两个模块度值：\n$Q_A = \\frac{7}{26} = \\frac{91}{338}$\n$Q_B = \\frac{75}{338}$\n由于 $91 > 75$，我们得到 $Q_A > Q_B$。模块度更高的划分是 $\\mathcal{P}_A$。\n\n较高的模块度值为 $Q_{\\max} = Q_A = \\frac{7}{26} \\approx 0.2692307...$\n四舍五入到四位有效数字，$Q_{\\max} \\approx 0.2692$。\n\n划分 $\\mathcal{P}_A$ 较高的模块度意味着，相对于基于节点度的随机期望，其社群展现出更强的内部连通性，这表明它是在此蛋白质相互作用网络中对不同疾病相关模块更合理的表示。",
            "answer": "$$\n\\boxed{0.2692}\n$$"
        },
        {
            "introduction": "虽然社区发现算法可以识别网络中密集的区域，但它们通常不直接整合关于哪些基因与疾病相关的先验知识。为了解决这个问题，我们可以采用更复杂的优化方法，例如“集奖斯坦纳树”（Prize-Collecting Steiner Tree, PCST）。PCST框架允许我们为节点（代表我们认为重要的基因）分配“奖金”，同时为边（代表互作的不确定性或成本）分配“成本”，旨在找到一个能以最小成本连接高奖金节点的连通子网络。这个练习将引导你手动求解一个小型PCST问题，从而直观地理解如何在网络拓扑和外部生物学证据之间进行权衡，以精确地勾勒出疾病模块 。",
            "id": "4369080",
            "problem": "在系统生物医学中基于网络的疾病模块识别中，奖品收集斯坦纳树（PCST）用于选择一个连通的子网络，该网络在包含生物学相关节点（具有非负节点奖品）与边上的不确定性成本之间取得平衡。考虑以下小规模的蛋白质-蛋白质相互作用图，建模为一个无向图 $G = (V, E)$，其中有三个疾病种子基因和两个潜在的斯坦纳基因：\n- 节点：$V = \\{A, B, C, D, E\\}$。\n- 种子集：$S = \\{A, B, C\\}$。\n- 节点奖品 $p(v)$：$p(A) = 6$，$p(B) = 5$，$p(C) = 5$，$p(D) = 1$，$p(E) = 1$。\n- 以下边上的边成本 $c(e)$：\n  - $c(A, D) = 2$，$c(D, B) = 1$，$c(B, E) = 2$，$c(E, C) = 2$，\n  - $c(A, B) = 6$，$c(B, C) = 6$，$c(A, C) = 7$，\n  - $c(A, E) = 5$，$c(D, C) = 5$。\n\n一个可行的疾病模块是任意连通树 $T$，其节点集 $V(T) \\subseteq V$ 包含所有种子节点 $A$、$B$ 和 $C$（可以包含如 $D$ 和 $E$ 的额外节点），且其边集 $E(T) \\subseteq E$ 在 $G$ 内部导出 $V(T)$ 的连通性。树 $T$ 的PCST目标是\n$$\n\\Phi(T) \\;=\\; \\sum_{v \\in V(T)} p(v) \\;-\\; \\sum_{e \\in E(T)} c(e).\n$$\n\n仅根据上述定义和数据，手动计算最优PCST，即在约束 $\\{A, B, C\\} \\subseteq V(T)$ 下最大化 $\\Phi(T)$ 的连通树 $T^{\\star}$。你的答案必须是精确的最大目标值 $\\Phi(T^{\\star})$，以单个实数形式表示。在你的推理中，通过比较它们的目标值或基于最短路径距离和导出连通性的界限论证，严格证明所有可能的替代树相对于 $T^{\\star}$ 都是次优的。\n\n将最终答案表示为一个精确整数。不要四舍五入。",
            "solution": "### 步骤 1: 提取已知条件\n问题为在无向图 $G = (V, E)$ 上进行奖品收集斯坦纳树（PCST）分析提供了以下信息：\n-   **节点集**: $V = \\{A, B, C, D, E\\}$。\n-   **种子集**: $S = \\{A, B, C\\}$，必须包含在解树中。\n-   **节点奖品**，$p(v)$: $p(A) = 6$，$p(B) = 5$，$p(C) = 5$，$p(D) = 1$，$p(E) = 1$。\n-   **边成本**，$c(e)$:\n    -   $c(A, D) = 2$\n    -   $c(D, B) = 1$\n    -   $c(B, E) = 2$\n    -   $c(E, C) = 2$\n    -   $c(A, B) = 6$\n    -   $c(B, C) = 6$\n    -   $c(A, C) = 7$\n    -   $c(A, E) = 5$\n    -   $c(D, C) = 5$\n-   **目标函数**: 对于一个可行树 $T=(V(T), E(T))$，其中 $S \\subseteq V(T)$，最大化 $\\Phi(T) = \\sum_{v \\in V(T)} p(v) - \\sum_{e \\in E(T)} c(e)$。\n\n### 步骤 2: 使用提取的已知条件进行验证\n该问题具有科学依据，使用了系统生物医学中的一个标准优化模型（PCST）。它的提法是适定的，提供了所有必要的数据（奖品、成本、图结构）和一个清晰、明确的目标函数及约束。可行树的集合是有限的，保证了最大目标值的存在。该问题是自足的、客观的，并且没有违反任何科学或数学原理。没有矛盾或缺失任何关键信息。数据值在数值上是一致的。因此，该问题被判定为**有效**。\n\n### 步骤 3: 结论与行动\n问题有效。求解过程将继续进行。\n\n### 解题推导\n任务是找到一个连通树 $T^{\\star}$，它在种子节点集 $S = \\{A, B, C\\}$ 是其节点集 $V(T^{\\star})$ 的子集的约束下，最大化目标函数 $\\Phi(T)$。其他节点 $D$ 和 $E$ 是潜在的斯坦纳节点，如果它们能改善目标值，就可以被包含进来。\n\n一种系统性的方法是评估满足约束条件的树的顶点集 $V(T)$ 的所有可能构成。由于必须包含 $S$，因此 $V(T)$ 的可能集合有：\n1.  $V_1 = \\{A, B, C\\}$\n2.  $V_2 = \\{A, B, C, D\\}$\n3.  $V_3 = \\{A, B, C, E\\}$\n4.  $V_4 = \\{A, B, C, D, E\\}$\n\n对于这些节点集中的每一个，我们都必须找到使 $\\Phi(T)$ 最大化的树 $T$。对于一个固定的节点集 $V(T)$，总奖品 $\\sum p(v)$ 是恒定的。因此，为了最大化 $\\Phi(T)$，我们必须最小化总边成本 $\\sum c(e)$。连接给定节点集的最小成本边集构成了由这些节点导出的子图上的最小生成树（MST）。我们将计算这四种情况下最优树的 $\\Phi(T)$。\n\n**情况 1: $V(T) = \\{A, B, C\\}$**\n树必须只连接种子节点。\n-   **总奖品**: $P_1 = p(A) + p(B) + p(C) = 6 + 5 + 5 = 16$。\n-   **最小边成本**: 我们需要在由 $\\{A, B, C\\}$ 导出的子图上找到MST。可用的边有成本为 $6$ 的 $(A,B)$，成本为 $6$ 的 $(B,C)$，以及成本为 $7$ 的 $(A,C)$。要连接 3 个节点，我们需要 2 条边。使用 Kruskal 算法，我们选择两条不形成环路的最便宜的边：$(A,B)$ 和 $(B,C)$。\n    -   MST的边集是 $E_1 = \\{(A,B), (B,C)\\}$。\n    -   总成本是 $C_1 = c(A,B) + c(B,C) = 6 + 6 = 12$。\n-   **目标值**: $\\Phi_1 = P_1 - C_1 = 16 - 12 = 4$。\n\n**情况 2: $V(T) = \\{A, B, C, D\\}$**\n树包含种子节点和斯坦纳节点 D。\n-   **总奖品**: $P_2 = p(A) + p(B) + p(C) + p(D) = 6 + 5 + 5 + 1 = 17$。\n-   **最小边成本**: 我们在由 $\\{A, B, C, D\\}$ 导出的子图上找到MST。可用的边及其成本是：$(D,B)$ 成本 $1$，$(A,D)$ 成本 $2$，$(D,C)$ 成本 $5$，$(A,B)$ 成本 $6$，$(B,C)$ 成本 $6$，$(A,C)$ 成本 $7$。\n    -   应用 Kruskal 算法（按成本递增顺序选择边）：\n        1. 选择 $(D,B)$，成本为 $1$。\n        2. 选择 $(A,D)$，成本为 $2$。\n        3. 选择 $(D,C)$，成本为 $5$。（其他便宜的边如 $(A,B)$，成本为 $6$，会与已选边形成环路）。\n    -   MST的边集是 $E_2 = \\{(D,B), (A,D), (D,C)\\}$。这棵树连接了所有四个节点。\n    -   总成本是 $C_2 = c(D,B) + c(A,D) + c(D,C) = 1 + 2 + 5 = 8$。\n-   **目标值**: $\\Phi_2 = P_2 - C_2 = 17 - 8 = 9$。\n\n**情况 3: $V(T) = \\{A, B, C, E\\}$**\n树包含种子节点和斯坦纳节点 E。\n-   **总奖品**: $P_3 = p(A) + p(B) + p(C) + p(E) = 6 + 5 + 5 + 1 = 17$。\n-   **最小边成本**: 我们在由 $\\{A, B, C, E\\}$ 导出的子图上找到MST。可用的边及其成本是：$(B,E)$ 成本 $2$，$(E,C)$ 成本 $2$，$(A,E)$ 成本 $5$，$(A,B)$ 成本 $6$，$(B,C)$ 成本 $6$，$(A,C)$ 成本 $7$。\n    -   应用 Kruskal 算法：\n        1. 选择 $(B,E)$，成本为 $2$。\n        2. 选择 $(E,C)$，成本为 $2$。\n        3. 选择 $(A,E)$，成本为 $5$。\n    -   MST的边集是 $E_3 = \\{(B,E), (E,C), (A,E)\\}$。这棵树连接了所有四个节点。\n    -   总成本是 $C_3 = c(B,E) + c(E,C) + c(A,E) = 2 + 2 + 5 = 9$。\n-   **目标值**: $\\Phi_3 = P_3 - C_3 = 17 - 9 = 8$。\n\n**情况 4: $V(T) = \\{A, B, C, D, E\\}$**\n树包含图 $G$ 中的所有节点。\n-   **总奖品**: $P_4 = p(A) + p(B) + p(C) + p(D) + p(E) = 6 + 5 + 5 + 1 + 1 = 18$。\n-   **最小边成本**: 我们在整个图 $G$ 上找到MST。按成本排序的边是：$(D,B)$ 成本 $1$；$(A,D)$ 成本 $2$；$(B,E)$ 成本 $2$；$(E,C)$ 成本 $2$；$(A,E)$ 成本 $5$；$(D,C)$ 成本 $5$；等。\n    -   应用 Kruskal 算法：\n        1. 选择 $(D,B)$，成本为 $1$。\n        2. 选择 $(A,D)$，成本为 $2$。\n        3. 选择 $(B,E)$，成本为 $2$。（没有形成环路。对于成本相同的边，如 $(B,E)$ 和 $(E,C)$，选择的顺序不影响总成本）。\n        4. 选择 $(E,C)$，成本为 $2$。（没有形成环路。所有 5 个节点现已连接）。\n    -   MST的边集是 $E_4 = \\{(D,B), (A,D), (B,E), (E,C)\\}$。\n    -   总成本是 $C_4 = c(D,B) + c(A,D) + c(B,E) + c(E,C) = 1 + 2 + 2 + 2 = 7$。\n-   **目标值**: $\\Phi_4 = P_4 - C_4 = 18 - 7 = 11$。\n\n### 结论\n通过比较所有可能的有效树配置的目标值，我们可以确定最大值。\n-   $\\Phi_1 = 4$\n-   $\\Phi_2 = 9$\n-   $\\Phi_3 = 8$\n-   $\\Phi_4 = 11$\n\n最大目标值为 $\\Phi_{\\max} = 11$。这个值是由节点集为 $V(T^{\\star}) = \\{A, B, C, D, E\\}$ 和边集为 $E(T^{\\star}) = \\{(D,B), (A,D), (B,E), (E,C)\\}$ 的树 $T^{\\star}$ 实现的。这个穷尽性分析证明了任何其他可行树都是次优的。对于任何给定的节点集，除MST外的任何树都会有更高的边成本，从而有更低的目标值。既然我们已经考虑了所有有效的节点集，并找到了它们各自的最优得分，那么这些得分中的最高分就是全局最优解。",
            "answer": "$$\\boxed{11}$$"
        },
        {
            "introduction": "无论我们使用何种算法来识别疾病模块或对候选基因进行排序，最后都必须评估其性能。这个评估过程通常被构建为一个二元分类问题：我们的算法能在多大程度上将已知的致病基因（正例）与非致病基因（负例）区分开来？本练习将指导你计算两个关键的性能评估指标：受试者工作特征曲线下面积（AUROC）和精确率-召回率曲线下面积（AUPRC）。通过这个实践，你将理解为何在生物医学研究中常见的类别不平衡（即致病基因远少于非致病基因）情况下，这两个指标会给出不同的性能评估视角，并学会如何批判性地解读算法的预测结果 。",
            "id": "4369048",
            "problem": "一个蛋白质-蛋白质相互作用网络被用于识别疾病模块，其方法是使用一个以已知疾病基因为种子的基于扩散的排序算法对基因进行评分。一部分基因被注释为已知的疾病相关基因（$\\text{positive}$），所有其他基因则被认为是非疾病相关基因（$\\text{negative}$）。给定一个由基于网络的疾病模块识别流程产生的、按置信度降序排列的单个预测排序（分数唯一）。请从第一性原理出发，计算受试者工作特征曲线下面积（AUROC）和精确率-召回率曲线下面积（AUPRC），并解释在存在类别不平衡和早期假阳性的情况下，这两个指标为何会存在差异。\n\n使用以下包含$12$个基因及其分数和标签的数据集，按分数从高到低排序：\n- 基因 $N\\_A$ (阴性)，分数 $0.97$\n- 基因 $D\\_1$ (阳性)，分数 $0.95$\n- 基因 $D\\_2$ (阳性)，分数 $0.93$\n- 基因 $D\\_3$ (阳性)，分数 $0.90$\n- 基因 $N\\_B$ (阴性)，分数 $0.85$\n- 基因 $N\\_C$ (阴性)，分数 $0.82$\n- 基因 $N\\_D$ (阴性)，分数 $0.79$\n- 基因 $N\\_E$ (阴性)，分数 $0.76$\n- 基因 $N\\_F$ (阴性)，分数 $0.73$\n- 基因 $N\\_G$ (阴性)，分数 $0.70$\n- 基因 $N\\_H$ (阴性)，分数 $0.68$\n- 基因 $N\\_I$ (阴性)，分数 $0.65$\n\n已知疾病基因是 $D\\_1$、$D\\_2$ 和 $D\\_3$（阳性）。所有 $N\\_*$ 基因都是阴性。请从通过对排序列表进行阈值处理构建的真阳性率、假阳性率、精确率和召回率的定义开始，并相应地将受试者工作特征（ROC）曲线和精确率-召回率（PR）曲线定义为阈值的函数。然后，在离散排序的设置下，推导出每条曲线下面积的表达式。\n\n计算此排序的 AUROC 和 AUPRC。将您的 AUROC 和 AUPRC 值四舍五入到四位有效数字。将两个最终值表示为不带单位的小数。此外，在您的解答中，请简要解释为什么这两个值在此数据集上存在差异。",
            "solution": "我们首先从排序列表出发，对二元分类进行形式化。假设有 $P$ 个阳性样本和 $N$ 个阴性样本。对于应用于排序的任何阈值 $t$，令 $\\text{TP}(t)$、$\\text{FP}(t)$、$\\text{TN}(t)$ 和 $\\text{FN}(t)$ 分别表示分数高于阈值 $t$（预测为阳性）与低于或等于 $t$（预测为阴性）的项目中的真阳性、假阳性、真阴性和假阴性的数量。\n\n在阈值 $t$ 下，真阳性率（TPR，也称为灵敏度或召回率）和假阳性率（FPR）定义为\n$$\n\\text{TPR}(t) = \\frac{\\text{TP}(t)}{P}, \\qquad \\text{FPR}(t) = \\frac{\\text{FP}(t)}{N}.\n$$\n在阈值 $t$ 下的精确率是\n$$\n\\text{Precision}(t) = \\frac{\\text{TP}(t)}{\\text{TP}(t) + \\text{FP}(t)},\n$$\n且召回率（如上所述）为 $\\text{Recall}(t) = \\text{TPR}(t) = \\text{TP}(t)/P$。\n\n受试者工作特征（ROC）曲线是通过将阈值 $t$ 从高于最高分（此时 $\\text{TPR} = 0$, $\\text{FPR} = 0$）扫描到低于最低分（此时 $\\text{TPR} = 1$, $\\text{FPR} = 1$）而获得的一系列点 $\\left(\\text{FPR}(t), \\text{TPR}(t)\\right)$。精确率-召回率（PR）曲线是类似地构建的一系列点 $\\left(\\text{Recall}(t), \\text{Precision}(t)\\right)$。\n\n在具有唯一分数的离散排序设置中，当阈值逐个项目遍历时，$\\text{TP}(t)$ 和 $\\text{FP}(t)$ 会根据下一个项目是阳性还是阴性而以1为增量变化。因此，ROC曲线是 $\\text{FPR}$–$\\text{TPR}$ 平面上的一个单调阶梯状图形，PR曲线是 $\\text{Recall}$–$\\text{Precision}$ 平面上的一个单调阶梯状图形。这些曲线下的面积可以通过对由这些阶梯决定的矩形和梯形的面积求和来计算。\n\n在这种离散情况下，该面积有两种广泛使用的精确表征方法：\n1. AUROC 等于随机选择一个阳性样本其分数高于随机选择一个阴性样本的概率，对于唯一分数的情况，这等于正确排序的阳性-阴性对的比例。这可以通过注意到ROC曲线的面积等于由 $P \\times N$ 归一化的 Mann–Whitney 统计量来推导，而该统计量本身等同于通过对每个阴性样本的宽度 $\\Delta \\text{FPR} = 1/N$ 以及由阳性样本累积的相应 $\\text{TPR}$ 高度进行求和来对阶梯状ROC进行积分。形式上，\n$$\n\\text{AUROC} = \\frac{1}{P N} \\sum\\_{\\text{positives } i} \\sum\\_{\\text{negatives } j} \\mathbf{1}\\{s\\_i > s\\_j\\},\n$$\n其中 $s\\_i$ 和 $s\\_j$ 是分数，$\\mathbf{1}\\{\\cdot\\}$ 是指示函数。\n\n2. 在称为平均精确率（AP）的阶梯式插值方法下，PR曲线下面积可以通过对每个阳性样本处的召回率增量进行求和来计算：\n$$\n\\text{AUPRC} = \\sum\\_{k=1}^{P} \\left( R\\_k - R\\_{k-1} \\right) \\cdot \\Pi\\_k,\n$$\n其中 $R\\_k$ 是在排序中检索到第 $k$ 个阳性样本后的召回率，$R\\_0 = 0$，而 $\\Pi\\_k$ 是第 $k$ 个阳性样本出现排名处的精确率。这个公式是通过对PR阶梯状曲线进行积分得出的，其中精确率在连续两个阳性样本之间的召回率区间内被视为常数。\n\n现在我们将这些定义应用于给定的排序。首先，计算阳性和阴性样本的数量。阳性样本是 $D\\_1$、$D\\_2$、$D\\_3$，所以 $P = 3$。所有 $N\\_*$ 基因都是阴性样本，总计 $N = 9$（一个阴性样本在所有阳性样本之上，八个在之下）。\n\n通过成对排序计算 AUROC。共有 $P \\times N = 3 \\times 9 = 27$ 个阳性-阴性对。检查每个阳性样本下方有多少个阴性样本：\n- 对于 $D\\_1$（排名第 $2$）：除了 $N\\_A$ 之外的所有阴性样本都在其下方。由于总共有 $9$ 个阴性样本，其中 $1$ 个在其上方，所以有 $9 - 1 = 8$ 个阴性样本在 $D\\_1$ 下方。\n- 对于 $D\\_2$（排名第 $3$）：同样地，有 $8$ 个阴性样本在 $D\\_2$ 下方。\n- 对于 $D\\_3$（排名第 $4$）：同样地，有 $8$ 个阴性样本在 $D\\_3$ 下方。\n\n因此，正确排序的阳性-阴性对的数量为 $8 + 8 + 8 = 24$。所以，\n$$\n\\text{AUROC} = \\frac{24}{27} = \\frac{8}{9}.\n$$\n\n接下来，计算 AUPRC（平均精确率）。确定阳性样本的排名，并在每个阳性样本处计算 $\\Pi\\_k$（精确率）和 $R\\_k$（召回率）。\n- 检索到 $D\\_1$（第一个阳性样本）时，排名为 $2$：$\\text{TP} = 1$，$\\text{FP} = 1$。精确率 $\\Pi\\_1 = \\frac{1}{1+1} = \\frac{1}{2}$，召回率 $R\\_1 = \\frac{1}{3}$。\n- 检索到 $D\\_2$（第二个阳性样本）时，排名为 $3$：$\\text{TP} = 2$，$\\text{FP} = 1$。精确率 $\\Pi\\_2 = \\frac{2}{2+1} = \\frac{2}{3}$，召回率 $R\\_2 = \\frac{2}{3}$。\n- 检索到 $D\\_3$（第三个阳性样本）时，排名为 $4$：$\\text{TP} = 3$，$\\text{FP} = 1$。精确率 $\\Pi\\_3 = \\frac{3}{3+1} = \\frac{3}{4}$，召回率 $R\\_3 = \\frac{3}{3} = 1$。\n\n使用 $R\\_0 = 0$ 和 AP 求和公式，\n$$\n\\text{AUPRC} = (R\\_1 - R\\_0)\\Pi\\_1 + (R\\_2 - R\\_1)\\Pi\\_2 + (R\\_3 - R\\_2)\\Pi\\_3 = \\left(\\frac{1}{3}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{3}\\right)\\left(\\frac{2}{3}\\right) + \\left(\\frac{1}{3}\\right)\\left(\\frac{3}{4}\\right).\n$$\n精确计算：\n$$\n\\text{AUPRC} = \\frac{1}{6} + \\frac{2}{9} + \\frac{1}{4} = \\frac{6}{36} + \\frac{8}{36} + \\frac{9}{36} = \\frac{23}{36}.\n$$\n\n数值和四舍五入到四位有效数字：\n- $\\text{AUROC} = \\frac{8}{9} \\approx 0.888888\\ldots \\Rightarrow 0.8889$ (四位有效数字)。\n- $\\text{AUPRC} = \\frac{23}{36} \\approx 0.638888\\ldots \\Rightarrow 0.6389$ (四位有效数字)。\n\n对差异的解释：AUROC 之所以高，是因为成对来看，几乎所有的阳性样本都排在几乎所有的阴性样本之上；只有一个阴性样本（$N\\_A$）排在阳性样本之上，这使得27对阳性-阴性对中有24对是正确排序的。然而，AUPRC 则显著较低，因为在早期召回率阶段的精确率会因单个出现在任何阳性样本之前的早期假阳性（$N\\_A$）而受到惩罚。这将第一个阳性样本处的精确率降低到 $\\frac{1}{2}$，并继续将后续阳性样本处的精确率压低至 $\\frac{2}{3}$ 和 $\\frac{3}{4}$。在系统生物医学中常见的类别不平衡设置下，阳性样本（$P = 3$）相对于阴性样本（$N = 9$）是罕见的，AUROC 由于强大的全局排名区分度而可能保持较高水平，而 AUPRC 对早期的假阳性和阳性样本的普遍性更为敏感，因此为与疾病模块识别相关的列表顶部检索提供了对排序质量更保守的评估。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.8889  0.6389\\end{pmatrix}}$$"
        }
    ]
}