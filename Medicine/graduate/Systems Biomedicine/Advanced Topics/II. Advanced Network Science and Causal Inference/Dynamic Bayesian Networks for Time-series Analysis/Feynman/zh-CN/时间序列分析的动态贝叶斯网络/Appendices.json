{
    "hands_on_practices": [
        {
            "introduction": "在时间序列分析中，一项核心任务是根据可观测数据估计系统在每个时间点的潜在状态。本练习将通过一个具体案例，带领你手动执行滤波算法，这是在动态贝叶斯网络中进行实时状态追踪的核心引擎。通过为一个小型基因调控网络手动计算置信度，你将对证据如何在时间维度上传播与整合获得深刻的机械性理解 。",
            "id": "4336551",
            "problem": "考虑一个由动态贝叶斯网络 (DBN) 建模的基因调控时间序列，其中隐变量为转录因子活性 $T_t \\in \\{0,1\\}$ 和基因激活状态 $G_t \\in \\{0,1\\}$，观测变量为时间 $t$ 的离散化表达测量值 $Y_t \\in \\{0,1\\}$。该 DBN 由以下结构定义：一个初始先验 $p(T_1)$ 和 $p(G_1 \\mid T_1)$；马尔可夫转移 $p(T_t \\mid T_{t-1})$ 和 $p(G_t \\mid G_{t-1}, T_t)$；以及一个发射模型 $p(Y_t \\mid G_t)$。条件概率表 (CPT) 如下所示（所有数值均为概率）：\n\n- 转录因子的初始先验：$p(T_1=1) = 0.6$, $p(T_1=0) = 0.4$。\n- 给定转录因子的初始基因状态：$p(G_1=1 \\mid T_1=1) = 0.7$, $p(G_1=0 \\mid T_1=1) = 0.3$；$p(G_1=1 \\mid T_1=0) = 0.2$, $p(G_1=0 \\mid T_1=0) = 0.8$。\n- 转录因子动态：$p(T_t=1 \\mid T_{t-1}=1) = 0.8$, $p(T_t=0 \\mid T_{t-1}=1) = 0.2$；$p(T_t=1 \\mid T_{t-1}=0) = 0.3$, $p(T_t=0 \\mid T_{t-1}=0) = 0.7$。\n- 以先前基因状态和当前转录因子为条件的基因动态：$p(G_t=1 \\mid G_{t-1}=1, T_t=1) = 0.9$, $p(G_t=0 \\mid G_{t-1}=1, T_t=1) = 0.1$；$p(G_t=1 \\mid G_{t-1}=0, T_t=1) = 0.5$, $p(G_t=0 \\mid G_{t-1}=0, T_t=1) = 0.5$；$p(G_t=1 \\mid G_{t-1}=1, T_t=0) = 0.6$, $p(G_t=0 \\mid G_{t-1}=1, T_t=0) = 0.4$；$p(G_t=1 \\mid G_{t-1}=0, T_t=0) = 0.1$, $p(G_t=0 \\mid G_{t-1}=0, T_t=0) = 0.9$。\n- 发射模型：$p(Y_t=1 \\mid G_t=1) = 0.85$, $p(Y_t=0 \\mid G_t=1) = 0.15$；$p(Y_t=1 \\mid G_t=0) = 0.2$, $p(Y_t=0 \\mid G_t=0) = 0.8$。\n\n你观测到序列 $y_{1:3} = (y_1, y_2, y_3) = (1, 0, 1)$。使用贝叶斯定理的基本原理、全概率定律以及由 DBN 条件独立性编码的马尔可夫性质，执行精确滤波，为有序状态对 $(T_t,G_t) \\in \\{(1,1),(1,0),(0,1),(0,0)\\}$ 计算当 $t \\in \\{1,2,3\\}$ 时的归一化联合置信度 $p(T_t, G_t \\mid y_{1:t})$。\n\n最后，计算后验概率 $p(G_3 = 1 \\mid y_{1:3})$ 并将其作为最终答案报告。将您的最终答案四舍五入到四位有效数字。将最终答案表示为纯数字（无单位，无百分号）。",
            "solution": "该问题要求对一个动态贝叶斯网络（DBN）执行精确滤波，以计算给定观测序列下隐状态的后验概率。时间 $t$ 的隐状态是一个复合变量 $X_t = (T_t, G_t)$，其中 $T_t$ 是转录因子活性，$G_t$ 是基因激活状态。$X_t$ 的状态空间包含 $4$ 个可能的状态，我们将始终按 $\\{(1,1), (1,0), (0,1), (0,0)\\}$ 的顺序排列。时间 $t$ 的观测值为 $Y_t$。我们得到的观测序列为 $y_{1:3}=(1,0,1)$。\n\n滤波任务是计算在 $t=1, 2, 3$ 时的后验分布 $p(X_t \\mid y_{1:t})$。这通过一个包含预测步骤和更新步骤的递归过程来实现。令 $\\pi_t(X_t) \\equiv p(X_t \\mid y_{1:t})$ 为时间 $t$ 的滤波置信度。\n\n递归过程如下：\n1.  **预测**：状态的一步预测由 Chapman-Kolmogorov 方程给出：\n    $$p(X_t \\mid y_{1:t-1}) = \\sum_{X_{t-1}} p(X_t \\mid X_{t-1}) p(X_{t-1} \\mid y_{1:t-1})$$\n    转移概率 $p(X_t \\mid X_{t-1})$ 由 DBN 结构决定：$p(X_t \\mid X_{t-1}) = p(T_t, G_t \\mid T_{t-1}, G_{t-1}) = p(T_t \\mid T_{t-1}) p(G_t \\mid G_{t-1}, T_t)$。\n\n2.  **更新**：通过贝叶斯法则，使用观测值 $y_t$ 来更新预测分布：\n    $$p(X_t \\mid y_{1:t}) = \\frac{p(y_t \\mid X_t, y_{1:t-1}) p(X_t \\mid y_{1:t-1})}{p(y_t \\mid y_{1:t-1})}$$\n    给定 DBN 结构，发射值 $Y_t$ 在给定当前状态 $X_t$ 的条件下，与过去的状态和观测值条件独立。具体来说，$p(y_t \\mid X_t, y_{1:t-1}) = p(y_t \\mid X_t) = p(y_t \\mid G_t)$。分母是一个归一化常数。因此，更新可以写成：\n    $$\\pi_t(X_t) \\propto p(y_t \\mid G_t) p(X_t \\mid y_{1:t-1})$$\n\n我们现在将对 $t=1, 2, 3$ 应用此过程。\n\n**时间步 $t=1$**\n\n对于 $t=1$，\"预测\" 就是初始状态 $X_1$ 的先验分布 $p(X_1) = p(T_1, G_1) = p(T_1) p(G_1 \\mid T_1)$。\n$p(T_1=1, G_1=1) = 0.6 \\times 0.7 = 0.42$\n$p(T_1=1, G_1=0) = 0.6 \\times 0.3 = 0.18$\n$p(T_1=0, G_1=1) = 0.4 \\times 0.2 = 0.08$\n$p(T_1=0, G_1=0) = 0.4 \\times 0.8 = 0.32$\n\n接下来，用观测值 $y_1=1$ 更新这个先验。未归一化的后验（前向消息）$\\alpha_1(X_1)$ 为 $\\alpha_1(X_1) = p(y_1 \\mid G_1) p(X_1)$。\n$\\alpha_1(1,1) = p(Y_1=1 \\mid G_1=1) p(1,1) = 0.85 \\times 0.42 = 0.357$\n$\\alpha_1(1,0) = p(Y_1=1 \\mid G_1=0) p(1,0) = 0.20 \\times 0.18 = 0.036$\n$\\alpha_1(0,1) = p(Y_1=1 \\mid G_1=1) p(0,1) = 0.85 \\times 0.08 = 0.068$\n$\\alpha_1(0,0) = p(Y_1=1 \\mid G_1=0) p(0,0) = 0.20 \\times 0.32 = 0.064$\n\n归一化常数为 $Z_1 = \\sum_{X_1} \\alpha_1(X_1) = 0.357 + 0.036 + 0.068 + 0.064 = 0.525$。\n滤波置信度 $\\pi_1(X_1)=p(X_1 \\mid y_1)$ 为：\n$\\pi_1(1,1) = 0.357 / 0.525 \\approx 0.68$\n$\\pi_1(1,0) = 0.036 / 0.525 \\approx 0.06857$\n$\\pi_1(0,1) = 0.068 / 0.525 \\approx 0.12952$\n$\\pi_1(0,0) = 0.064 / 0.525 \\approx 0.12190$\n\n**时间步 $t=2$**\n\n首先是预测步骤，计算 $p(X_2 \\mid y_1) = \\sum_{X_1} p(X_2 \\mid X_1) \\pi_1(X_1)$。这得到预测概率向量 $p(X_2 \\mid y_1) \\approx (0.57029, 0.10400, 0.14590, 0.17981)$。\n接下来，用观测值 $y_2=0$ 进行更新。未归一化的后验为 $\\alpha_2(X_2) \\propto p(y_2 \\mid G_2) p(X_2 \\mid y_1)$。\n$\\alpha_2(1,1) \\propto 0.15 \\times 0.57029 \\approx 0.08554$\n$\\alpha_2(1,0) \\propto 0.80 \\times 0.10400 \\approx 0.08320$\n$\\alpha_2(0,1) \\propto 0.15 \\times 0.14590 \\approx 0.02189$\n$\\alpha_2(0,0) \\propto 0.80 \\times 0.17981 \\approx 0.14385$\n\n归一化后，滤波置信度 $\\pi_2(X_2)=p(X_2 \\mid y_{1:2})$ 为：\n$\\pi_2(1,1) \\approx 0.25575$\n$\\pi_2(1,0) \\approx 0.24875$\n$\\pi_2(0,1) \\approx 0.06543$\n$\\pi_2(0,0) \\approx 0.43007$\n\n**时间步 $t=3$**\n\n预测步骤：$p(X_3 \\mid y_{1:2}) = \\sum_{X_2} p(X_3 \\mid X_2) \\pi_2(X_2)$。这得到预测概率向量 $p(X_3 \\mid y_{1:2}) \\approx (0.36582, 0.18643, 0.09325, 0.35450)$。\n用观测值 $y_3=1$ 进行更新。未归一化的后验为 $\\alpha_3(X_3) \\propto p(y_3 \\mid G_3) p(X_3 \\mid y_{1:2})$。\n$\\alpha_3(1,1) \\propto 0.85 \\times 0.36582 \\approx 0.31095$\n$\\alpha_3(1,0) \\propto 0.20 \\times 0.18643 \\approx 0.03729$\n$\\alpha_3(0,1) \\propto 0.85 \\times 0.09325 \\approx 0.07926$\n$\\alpha_3(0,0) \\propto 0.20 \\times 0.35450 \\approx 0.07090$\n\n归一化后，滤波置信度 $\\pi_3(X_3)=p(X_3 \\mid y_{1:3})$ 为：\n$\\pi_3(1,1) \\approx 0.62388$\n$\\pi_3(1,0) \\approx 0.07481$\n$\\pi_3(0,1) \\approx 0.15904$\n$\\pi_3(0,0) \\approx 0.14225$\n\n**最终答案计算**\n\n问题要求计算后验概率 $p(G_3=1 \\mid y_{1:3})$。这可以通过对联合后验分布 $p(T_3, G_3 \\mid y_{1:3})$ 关于变量 $T_3$ 进行边缘化来获得。\n$$p(G_3=1 \\mid y_{1:3}) = \\sum_{T_3 \\in \\{0,1\\}} p(T_3, G_3=1 \\mid y_{1:3})$$\n$$p(G_3=1 \\mid y_{1:3}) = p(T_3=1, G_3=1 \\mid y_{1:3}) + p(T_3=0, G_3=1 \\mid y_{1:3})$$\n$$p(G_3=1 \\mid y_{1:3}) = \\pi_3(1,1) + \\pi_3(0,1) \\approx 0.62388 + 0.15904 = 0.78292$$\n使用更精确的中间值进行计算，得到：\n$$p(G_3=1 \\mid y_{1:3}) \\approx 0.78293605$$\n将结果四舍五入到四位有效数字，得到 $0.7829$。",
            "answer": "$$\\boxed{0.7829}$$"
        },
        {
            "introduction": "知道了如何在给定模型参数的情况下进行推断，下一个自然的问题是：我们如何从实验数据中学习模型本身的参数（例如状态转移概率）？本练习将通过经典的Baum-Welch算法（EM算法的一种特例）来解决这个问题。你将基于一个观测序列，亲手计算状态转移的期望次数，这是参数最大似然估计的基础，从而揭示如何从数据中“学习”出一个隐马尔可夫模型 。",
            "id": "4336550",
            "problem": "考虑一个用于系统生物医学中单个基因调控活动的双状态隐马尔可夫模型（HMM）的动态贝叶斯网络（DBN）表示。潜在的调控状态由 $Z_t \\in \\{1,2\\}$ 表示，其中 $Z_t=1$ 表示非活动状态，$Z_t=2$ 表示活动状态。在时间 $t$ 观测到的表达测量值是一个连续变量 $Y_t \\in \\mathbb{R}$。该模型遵循一阶马尔可夫性质以及给定潜在状态下观测值之间的条件独立性，其基本组成部分如下：\n- 初始分布 $p(Z_1=i)=\\pi_i$。\n- 转移分布 $p(Z_t=j \\mid Z_{t-1}=i)=a_{ij}$，其中对于每个 $i$，$\\sum_{j} a_{ij}=1$ 且 $a_{ij} \\ge 0$。\n- 发射分布 $p(Y_t \\mid Z_t=i)$。\n\n假设发射模型是高斯分布：$Y_t \\mid Z_t=i \\sim \\mathcal{N}(\\mu_i,\\sigma^2)$，其中 $\\mu_1=0$，$\\mu_2=2$ 且 $\\sigma^2=1$。潜在动态的 HMM 参数为：\n- 初始分布 $\\pi_1=0.6$, $\\pi_2=0.4$。\n- 转移矩阵项 $a_{11}=0.85$, $a_{12}=0.15$, $a_{21}=0.30$, $a_{22}=0.70$。\n\n您观测到时间序列 $Y_1=0.3$, $Y_2=1.9$, $Y_3=2.1$（即 $T=3$）。使用从联合分解 $p(Z_{1:T},Y_{1:T}) = p(Z_1)\\prod_{t=2}^{T}p(Z_t\\mid Z_{t-1})\\prod_{t=1}^{T}p(Y_t\\mid Z_t)$ 推导出的前向-后向算法和条件期望的定义，计算 $t=2$ 和 $t=3$ 时的期望转移计数 $\\mathbb{E}\\left[\\mathbb{I}\\{Z_{t-1}=1,Z_t=2\\}\\mid Y_{1:3}\\right]$，并使用它们在归一化约束 $\\sum_{j} a_{1j}=1$ 下对转移概率 $p(Z_t=2\\mid Z_{t-1}=1)$ 进行最大似然更新。\n\n将 $p(Z_t=2\\mid Z_{t-1}=1)$ 的最终更新值以单个实数形式提供。将您的答案四舍五入到四位有效数字。以小数形式表示概率（不带百分号）。",
            "solution": "该问题要求使用Baum-Welch算法（期望最大化（EM）算法的一种特例）的一个M步，基于给定的观测序列来更新隐马尔可夫模型（HMM）的转移概率 $a_{12} = p(Z_t=2 \\mid Z_{t-1}=1)$。\n\n在Baum-Welch算法中，$a_{ij}$ 的重估公式是从状态 $i$ 到状态 $j$ 的期望转移次数与从状态 $i$ 离开的期望转移总次数之比。\n$$ \\hat{a}_{ij} = \\frac{\\sum_{t=2}^{T} p(Z_{t-1}=i, Z_t=j \\mid Y_{1:T})}{\\sum_{t=1}^{T-1} p(Z_t=i \\mid Y_{1:T})} $$\n这些期望值（平滑后验概率）需要通过前向-后向算法计算。令 $\\alpha_t(i) = p(Y_{1:t}, Z_t=i)$ 为前向变量，$\\beta_t(i) = p(Y_{t+1:T} \\mid Z_t=i)$ 为后向变量。平滑概率可以表示为：\n$p(Z_t=i \\mid Y_{1:T}) = \\gamma_t(i) = \\frac{\\alpha_t(i)\\beta_t(i)}{p(Y_{1:T})}$\n$p(Z_{t-1}=i, Z_t=j \\mid Y_{1:T}) = \\xi_t(i,j) = \\frac{\\alpha_{t-1}(i) a_{ij} p(Y_t \\mid Z_t=j) \\beta_t(j)}{p(Y_{1:T})}$\n对于本问题，$T=3$，更新 $a_{12}$ 的公式为：\n$$ \\hat{a}_{12} = \\frac{\\xi_2(1,2) + \\xi_3(1,2)}{\\gamma_1(1) + \\gamma_2(1)} $$\n\n**1. 计算发射概率**\n令 $b_i(Y_t) = p(Y_t \\mid Z_t=i) = \\mathcal{N}(Y_t; \\mu_i, \\sigma^2)$。给定参数 $\\mu_1=0, \\mu_2=2, \\sigma^2=1$ 和观测值：\n- $b_1(0.3) \\approx 0.381384$, $b_2(0.3) \\approx 0.094045$\n- $b_1(1.9) \\approx 0.065616$, $b_2(1.9) \\approx 0.396953$\n- $b_1(2.1) \\approx 0.043984$, $b_2(2.1) \\approx 0.396953$\n\n**2. 前向传递**\n- $t=1$:\n  $\\alpha_1(1) = \\pi_1 b_1(Y_1) = 0.6 \\times 0.381384 = 0.228830$\n  $\\alpha_1(2) = \\pi_2 b_2(Y_1) = 0.4 \\times 0.094045 = 0.037618$\n- $t=2$:\n  $\\alpha_2(1) = (\\alpha_1(1)a_{11} + \\alpha_1(2)a_{21}) b_1(Y_2) \\approx 0.013504$\n  $\\alpha_2(2) = (\\alpha_1(1)a_{12} + \\alpha_1(2)a_{22}) b_2(Y_2) \\approx 0.024078$\n- $t=3$:\n  $\\alpha_3(1) = (\\alpha_2(1)a_{11} + \\alpha_2(2)a_{21}) b_1(Y_3) \\approx 0.00082256$\n  $\\alpha_3(2) = (\\alpha_2(1)a_{12} + \\alpha_2(2)a_{22}) b_2(Y_3) \\approx 0.00749448$\n数据似然 $p(Y_{1:3}) = \\alpha_3(1) + \\alpha_3(2) \\approx 0.00831704$。\n\n**3. 后向传递**\n- $t=3$: $\\beta_3(1) = 1, \\beta_3(2) = 1$。\n- $t=2$:\n  $\\beta_2(1) = a_{11}b_1(Y_3)\\beta_3(1) + a_{12}b_2(Y_3)\\beta_3(2) \\approx 0.096929$\n  $\\beta_2(2) = a_{21}b_1(Y_3)\\beta_3(1) + a_{22}b_2(Y_3)\\beta_3(2) \\approx 0.291062$\n- $t=1$:\n  $\\beta_1(1) = a_{11}b_1(Y_2)\\beta_2(1) + a_{12}b_2(Y_2)\\beta_2(2) \\approx 0.022734$\n  $\\beta_1(2) = a_{21}b_1(Y_2)\\beta_2(1) + a_{22}b_2(Y_2)\\beta_2(2) \\approx 0.082778$\n\n**4. 计算平滑概率并更新参数**\n更新公式的分母为 $\\sum_{t=1}^2 \\gamma_t(1) = \\gamma_1(1) + \\gamma_2(1)$：\n$\\gamma_1(1) = \\frac{\\alpha_1(1)\\beta_1(1)}{p(Y_{1:3})} = \\frac{0.228830 \\times 0.022734}{0.00831704} \\approx 0.62557$\n$\\gamma_2(1) = \\frac{\\alpha_2(1)\\beta_2(1)}{p(Y_{1:3})} = \\frac{0.013504 \\times 0.096929}{0.00831704} \\approx 0.15738$\n分母 $\\approx 0.62557 + 0.15738 = 0.78295$。\n\n更新公式的分子为 $\\sum_{t=2}^3 \\xi_t(1,2) = \\xi_2(1,2) + \\xi_3(1,2)$：\n$\\xi_2(1,2) = \\frac{\\alpha_1(1) a_{12} b_2(Y_2) \\beta_2(2)}{p(Y_{1:3})} \\approx \\frac{0.228830 \\times 0.15 \\times 0.396953 \\times 0.291062}{0.00831704} \\approx 0.47691$\n$\\xi_3(1,2) = \\frac{\\alpha_2(1) a_{12} b_2(Y_3) \\beta_3(2)}{p(Y_{1:3})} \\approx \\frac{0.013504 \\times 0.15 \\times 0.396953 \\times 1}{0.00831704} \\approx 0.096726$\n分子 $\\approx 0.47691 + 0.096726 = 0.573636$。\n\n最后，更新后的转移概率 $\\hat{a}_{12}$ 为：\n$$ \\hat{a}_{12} = \\frac{0.573636}{0.78295} \\approx 0.73266 $$\n四舍五入到四位有效数字，结果为 $0.7327$。",
            "answer": "$$\\boxed{0.7327}$$"
        },
        {
            "introduction": "在系统生物学中，我们不仅希望描述一个系统，更希望预测当系统受到扰动（例如基因敲除）时其行为会如何改变。本练习将引导你从观测模型走向因果与干预模型，展示如何将外部干预正式地整合进动态贝叶斯网络的框架中。通过推导干预下的联合概率分布的数学形式，你将掌握在模型中模拟实验、进行因果推理的理论基础 。",
            "id": "4336566",
            "problem": "在系统生物医学背景下，考虑一个被建模为动态贝叶斯网络 (DBN) 的调控模块，该网络由一个双切片时序贝叶斯网络 (2TBN) 表示。在每个时间索引 $t \\in \\{0,1,\\dots,T\\}$，该模块包含三个离散值生物状态变量：一个转录因子 $X_t$、一个下游基因产物 $Y_t$ 和一个翻译后修饰状态 $Z_t$。假设时间切片之间具有一阶马尔可夫性质且无切片内边缘，切片间的父节点集由 $\\mathrm{Pa}(X_t)=\\{X_{t-1},Z_{t-1}\\}$、$\\mathrm{Pa}(Y_t)=\\{X_{t-1},Y_{t-1}\\}$ 和 $\\mathrm{Pa}(Z_t)=\\{Y_{t-1},Z_{t-1}\\}$ 给出。令 $p(X_0,Y_0,Z_0)$ 表示在时间 $t=0$ 时的初始联合分布，对于 $t \\ge 1$，令 $p(X_t \\mid X_{t-1},Z_{t-1})$、$p(Y_t \\mid X_{t-1},Y_{t-1})$ 和 $p(Z_t \\mid Y_{t-1},Z_{t-1})$ 表示观测条件概率分布 (CPD)。\n\n要求您引入显式的干预节点来表示时间局域化的实验扰动。为每个时间 $t \\in \\{1,\\dots,T\\}$ 引入一个二元干预节点 $I_t \\in \\{0,1\\}$，并带有一条有向边 $I_t \\to X_t$，其语义为：当 $I_t=0$ 时，$X_t$ 的观测动态适用；当 $I_t=1$ 时，变量 $X_t$ 被外源性地设置为一个固定值 $x^{\\star}$，与其父节点无关。考虑在特定时间 $t_{\\mathrm{int}} \\in \\{1,\\dots,T\\}$ 应用的单个硬干预，其中 $I_{t_{\\mathrm{int}}}=1$ 从而 $X_{t_{\\mathrm{int}}}$ 被强制设为 $x^{\\star}$，而对于所有 $t \\ne t_{\\mathrm{int}}$，我们有 $I_t=0$。令 $\\delta_{a,b}$ 表示克罗内克δ函数，如果 $a=b$ 则等于 $1$，否则等于 $0$。\n\n仅从联合分布的链式法则、贝叶斯网络分解法则以及上述双切片模板定义的一阶马尔可夫性质出发，推导由所述干预引起的全轨迹 $(X_0,\\dots,X_T,Y_0,\\dots,Y_T,Z_0,\\dots,Z_T)$ 上的干预联合分布的修正分解式。您的最终表达式应随时间分解，并清楚地反映出 $X_{t_{\\mathrm{int}}}$ 被设为 $x^{\\star}$，而所有其他CPD保持为观测形式。请用一个包含 $p(X_0,Y_0,Z_0)$、观测CPD和克罗内克δ函数 $\\delta_{\\,\\cdot,\\cdot}$ 的单闭式解析表达式来表示您的最终答案。最终答案中不要包含等号。不需要进行数值近似或四舍五入，也不适用任何物理单位。",
            "solution": "我们从定义动态贝叶斯网络 (DBN) 的双切片时序贝叶斯网络 (2TBN) 的标准原理开始。两个关键的基础要素是：联合分布的链式法则和贝叶斯网络分解性质。结合一阶马尔可夫性质，这些要素意味着，在有限时间范围 $t \\in \\{0,1,\\dots,T\\}$ 内，联合观测分布可分解为\n$$\np(X_0,Y_0,Z_0) \\prod_{t=1}^{T} p(X_t \\mid X_{t-1},Z_{t-1}) \\, p(Y_t \\mid X_{t-1},Y_{t-1}) \\, p(Z_t \\mid Y_{t-1},Z_{t-1}) .\n$$\n这是因为一阶马尔可夫性质和指定的父节点集 $\\mathrm{Pa}(X_t)=\\{X_{t-1},Z_{t-1}\\}$、$\\mathrm{Pa}(Y_t)=\\{X_{t-1},Y_{t-1}\\}$ 和 $\\mathrm{Pa}(Z_t)=\\{Y_{t-1},Z_{t-1}\\}$ 决定了2TBN编码的条件独立性，而贝叶斯网络分解将联合分布写为每个节点在其父节点给定下的条件概率的乘积。\n\n现在我们引入显式干预节点。对于每个时间 $t \\in \\{1,\\dots,T\\}$，我们添加一个二元干预变量 $I_t \\in \\{0,1\\}$ 及一条有向边 $I_t \\to X_t$。其语义如下：当 $I_t=0$ 时，$X_t$ 遵循其观测CPD $p(X_t \\mid X_{t-1},Z_{t-1})$；当 $I_t=1$ 时，从其观测父节点指向 $X_t$ 的入边被有效切断，$X_t$ 被确定性地设置为一个固定值 $x^{\\star}$，与 $(X_{t-1},Z_{t-1})$ 无关。一种方便且标准的、将此编码到 $X_t$ 的单个条件概率表中的方法是定义\n$$\np(X_t \\mid X_{t-1},Z_{t-1},I_t) = (1-I_t)\\, p(X_t \\mid X_{t-1},Z_{t-1}) + I_t \\, \\delta_{X_t,\\,x^{\\star}} ,\n$$\n其中 $\\delta_{a,b}$ 是克罗内克δ函数，当 $a=b$ 时等于 $1$，否则等于 $0$。这对 $X_t$ 定义了一个有效的条件分布，因为对于所有 $I_t \\in \\{0,1\\}$，它都是两个有效条件分布的凸组合，并且在 $X_t$ 的支撑集上求和为 $1$。\n\n添加这些干预节点后，$(X_{0:T},Y_{0:T},Z_{0:T},I_{1:T})$ 上的增广贝叶斯网络可分解为\n$$\np(X_0,Y_0,Z_0)\\,\\prod_{t=1}^{T} p(I_t)\\, p(X_t \\mid X_{t-1},Z_{t-1},I_t)\\, p(Y_t \\mid X_{t-1},Y_{t-1})\\, p(Z_t \\mid Y_{t-1},Z_{t-1}) .\n$$\n这里 $p(I_t)$ 是干预节点的任意外源先验。在 $t_{\\mathrm{int}} \\in \\{1,\\dots,T\\}$ 进行硬性的、时间局域化的干预下，即设置 $I_{t_{\\mathrm{int}}}=1$ 且对于所有 $t \\ne t_{\\mathrm{int}}$ 都有 $I_t=0$，我们运用干预语义来固定这些变量，并消除了将它们的概率包含在生物状态变量 $(X_{0:T},Y_{0:T},Z_{0:T})$ 的干预分布中的必要性。具体来说，干预联合分布 $p_{\\mathrm{do}}(X_{0:T},Y_{0:T},Z_{0:T})$ 是通过将观测因子 $p(X_{t_{\\mathrm{int}}} \\mid X_{t_{\\mathrm{int}}-1},Z_{t_{\\mathrm{int}}-1})$ 替换为退化因子 $\\delta_{X_{t_{\\mathrm{int}}},\\,x^{\\star}}$ 而得到的，同时保持所有其他因子不变。这是贝叶斯网络分解的直接结果，其中 $X_{t_{\\mathrm{int}}}$ 的条件概率由 $I_{t_{\\mathrm{int}}}=1$ 修正，而对于所有 $t \\ne t_{\\mathrm{int}}$ 的 $I_t=0$ 则恢复了 $X_t$ 在那些时间的观测条件概率。\n\n因此，生物状态全轨迹上的干预联合分布的修正分解式为\n$$\np(X_0,Y_0,Z_0)\\;\n\\left[\\prod_{\\substack{t=1\\\\ t \\ne t_{\\mathrm{int}}}}^{T} p(X_t \\mid X_{t-1},Z_{t-1})\\right]\\;\n\\delta_{X_{t_{\\mathrm{int}}},\\,x^{\\star}}\\;\n\\left[\\prod_{t=1}^{T} p(Y_t \\mid X_{t-1},Y_{t-1})\\; p(Z_t \\mid Y_{t-1},Z_{t-1})\\right] .\n$$\n该表达式精确地反映了干预的效果：$X_{t_{\\mathrm{int}}}$ 的因子被替换为 $\\delta_{X_{t_{\\mathrm{int}}},\\,x^{\\star}}$，编码了 $X_{t_{\\mathrm{int}}}$ 被固定为 $x^{\\star}$，而所有其他因子保持为观测形式，并保留了2TBN所蕴含的原始时间分解结构。干预的下游影响通过对于 $t \\ge t_{\\mathrm{int}}+1$ 依赖于 $X_{t}$ 的、未改变的观测CPD随时间向前传播。",
            "answer": "$$\\boxed{p(X_0,Y_0,Z_0)\\,\\left[\\prod_{\\substack{t=1\\\\ t \\ne t_{\\mathrm{int}}}}^{T} p(X_t \\mid X_{t-1},Z_{t-1})\\right]\\,\\delta_{X_{t_{\\mathrm{int}}},\\,x^{\\star}}\\,\\left[\\prod_{t=1}^{T} p(Y_t \\mid X_{t-1},Y_{t-1})\\,p(Z_t \\mid Y_{t-1},Z_{t-1})\\right]}$$"
        }
    ]
}