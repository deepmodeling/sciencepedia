{
    "hands_on_practices": [
        {
            "introduction": "药物的作用强度与其在靶点上的结合程度（即占有率）密切相关。在多药理学背景下，一个药物分子可能与多个靶点相互作用，因此评估其在不同靶点上的占有率对于理解其疗效和潜在副作用至关重要。本练习将引导你运用质量作用定律，从基本的生物物理原理出发，推导并计算在给定药物浓度下，药物对不同亲和力靶点的平衡占有率，这是定量分析多药理学效应的基础。",
            "id": "4375871",
            "problem": "在强调多向药理学和不良反应预测的系统生物医学框架中，对一种旨在用于药物重定位的小分子候选药物进行评估。假设存在以下基于质量作用定律的生物物理学背景，针对一个单一的、非协同的结合位点：受体 $R$ 与配体（游离药物）$L$ 结合，通过平衡反应 $R + L \\rightleftharpoons RL$ 形成复合物 $RL$。解离常数 $K_d$ 定义为 $K_d = \\frac{[R][L]}{[RL]}$，分数占据率 $\\theta$ 定义为已结合的受体占总受体的比例，即 $\\theta = \\frac{[RL]}{[R]_{\\text{tot}}}$，其中 $[R]_{\\text{tot}} = [R] + [RL]$。假设 $[L]$ 等于最大游离血浆浓度 $C_{\\max,\\mathrm{free}}$，因为靶点浓度相对于循环药物浓度较低，可以忽略配体的消耗。\n\n单次口服剂量产生的 $C_{\\max,\\mathrm{free}} = 150\\ \\mathrm{nM}$。与治疗效果和不良反应均相关的三个分子靶点的解离常数分别为 $K_d \\in \\{30\\ \\mathrm{nM}, 100\\ \\mathrm{nM}, 300\\ \\mathrm{nM}\\}$。\n\n请仅使用上述给出的质量作用平衡定义的 $K_d$ 和分数占据率 $\\theta$ 的定义，推导出 $\\theta$ 关于 $[L]$ 和 $K_d$ 的表达式，然后计算在 $[L] = C_{\\max,\\mathrm{free}}$ 时每个靶点的分数占据率。最后，确定在 $C_{\\max,\\mathrm{free}}$ 时哪些靶点的占据率超过 $0.5$。\n\n将您的最终答案表示为一个单行矩阵，按顺序包含三个分数占据率，然后是占据率超过 $0.5$ 的靶点的索引，其中索引 $1$ 对应 $K_d = 30\\ \\mathrm{nM}$，索引 $2$ 对应 $K_d = 100\\ \\mathrm{nM}$，索引 $3$ 对应 $K_d = 300\\ \\mathrm{nM}$。请提供精确值，不要四舍五入。",
            "solution": "首先，对问题进行严格的验证过程。\n\n### 步骤1：提取已知条件\n- 结合平衡：$R + L \\rightleftharpoons RL$。\n- 系统特性：单一、非协同的平衡结合位点。\n- 解离常数的定义：$K_d = \\frac{[R][L]}{[RL]}$。\n- 分数占据率的定义：$\\theta = \\frac{[RL]}{[R]_{\\text{tot}}}$。\n- 总受体浓度的定义：$[R]_{\\text{tot}} = [R] + [RL]$。\n- 关于配体浓度的假设：$[L]$ 恒定且等于 $C_{\\max,\\mathrm{free}}$。\n- 具体配体浓度：$C_{\\max,\\mathrm{free}} = 150\\ \\mathrm{nM}$。\n- 靶点解离常数集合：$K_d \\in \\{30\\ \\mathrm{nM}, 100\\ \\mathrm{nM}, 300\\ \\mathrm{nM}\\}$。\n- 任务要求：\n    1.  推导 $\\theta$ 作为 $[L]$ 和 $K_d$ 的函数。\n    2.  在 $[L] = C_{\\max,\\mathrm{free}}$ 时计算三个靶点各自的 $\\theta$。\n    3.  确定 $\\theta > 0.5$ 的靶点。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题的有效性进行评估。\n- **科学依据**：该问题基于质量作用定律，这是物理化学和药理学的基石。所给出的解离常数（$K_d$）和分数占据率（$\\theta$）的定义在受体理论领域是标准的。多向药理学和不良反应预测的背景是现代系统生物医学的核心。所有前提都具有科学合理性。\n- **适定性**：该问题提供了执行所需推导和计算的所有必要定义、常数和变量。目标明确，并能导出一个唯一的、确定性的解。\n- **客观性**：问题以精确、定量的语言陈述，没有歧义或主观解释的余地。\n\n经查，该问题不存在科学上不合理、信息缺失或含糊不清等任何缺陷。它代表了生物物理化学中一个标准的、可形式化的问题。\n\n### 步骤3：结论与行动\n问题是**有效的**。将提供解答。\n\n第一个任务是推导分数占据率 $\\theta$ 关于配体浓度 $[L]$ 和解离常数 $K_d$ 的表达式。我们从给定的定义开始。\n\n总受体浓度由下式给出：\n$$[R]_{\\text{tot}} = [R] + [RL]$$\n分数占据率 $\\theta$ 是结合的受体-配体复合物浓度 $[RL]$ 与总受体浓度 $[R]_{\\text{tot}}$ 的比值：\n$$\\theta = \\frac{[RL]}{[R]_{\\text{tot}}} = \\frac{[RL]}{[R] + [RL]}$$\n解离常数 $K_d$ 由平衡关系定义：\n$$K_d = \\frac{[R][L]}{[RL]}$$\n根据这个定义，我们可以用其他物种的浓度来表示游离受体 $[R]$ 的浓度：\n$$[R] = \\frac{K_d [RL]}{[L]}$$\n现在，我们将这个 $[R]$ 的表达式代入 $\\theta$ 方程的分母中：\n$$\\theta = \\frac{[RL]}{\\left(\\frac{K_d [RL]}{[L]}\\right) + [RL]}$$\n分数中的每一项都含有 $[RL]$，因此可以从分母中提取公因式 $[RL]$ 并消去：\n$$\\theta = \\frac{[RL]}{[RL] \\left(\\frac{K_d}{[L]} + 1\\right)} = \\frac{1}{\\frac{K_d}{[L]} + 1}$$\n为简化这个繁分数，我们对主分母中的各项通分：\n$$\\theta = \\frac{1}{\\frac{K_d + [L]}{[L]}}$$\n最后，将分母取倒数，得到所需的表达式，即单一位点的 Hill-Langmuir 方程：\n$$\\theta = \\frac{[L]}{[L] + K_d}$$\n下一个任务是使用给定的最大游离血浆浓度 $[L] = C_{\\max,\\mathrm{free}} = 150 \\ \\mathrm{nM}$ 来计算三个靶点各自的分数占据率。\n\n对于第一个靶点（索引 $1$），$K_{d,1} = 30\\ \\mathrm{nM}$。\n$$\\theta_1 = \\frac{[L]}{[L] + K_{d,1}} = \\frac{150}{150 + 30} = \\frac{150}{180} = \\frac{15}{18} = \\frac{5}{6}$$\n\n对于第二个靶点（索引 $2$），$K_{d,2} = 100\\ \\mathrm{nM}$。\n$$\\theta_2 = \\frac{[L]}{[L] + K_{d,2}} = \\frac{150}{150 + 100} = \\frac{150}{250} = \\frac{15}{25} = \\frac{3}{5}$$\n\n对于第三个靶点（索引 $3$），$K_{d,3} = 300\\ \\mathrm{nM}$。\n$$\\theta_3 = \\frac{[L]}{[L] + K_{d,3}} = \\frac{150}{150 + 300} = \\frac{150}{450} = \\frac{15}{45} = \\frac{1}{3}$$\n\n最后一个任务是确定哪些靶点的分数占据率大于 $0.5$，即大于 $\\frac{1}{2}$。\n\n- 对于靶点 $1$，$\\theta_1 = \\frac{5}{6}$。因为 $5 \\times 2 = 10$ 且 $6 \\times 1 = 6$，我们有 $10 > 6$，这意味着 $\\frac{5}{6} > \\frac{1}{2}$。因此，靶点 $1$ 的占据率超过 $0.5$。\n- 对于靶点 $2$，$\\theta_2 = \\frac{3}{5}$。因为 $3 \\times 2 = 6$ 且 $5 \\times 1 = 5$，我们有 $6 > 5$，这意味着 $\\frac{3}{5} > \\frac{1}{2}$。因此，靶点 $2$ 的占据率超过 $0.5$。\n- 对于靶点 $3$，$\\theta_3 = \\frac{1}{3}$。因为 $1 \\times 2 = 2$ 且 $3 \\times 1 = 3$，我们有 $2  3$，这意味着 $\\frac{1}{3}  \\frac{1}{2}$。因此，靶点 $3$ 的占据率未超过 $0.5$。\n\n总之，计算出的分数占据率分别为 $\\theta_1 = \\frac{5}{6}$，$\\theta_2 = \\frac{3}{5}$ 和 $\\theta_3 = \\frac{1}{3}$。占据率超过 $0.5$ 的靶点是索引为 $1$ 和 $2$ 的靶点。\n\n最终答案以一个单行矩阵的形式呈现，其中包含三个分数占据率，后面跟着占据率超过 $0.5$ 的靶点的索引。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{5}{6}  \\frac{3}{5}  \\frac{1}{3}  1  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在药物重新定位和系统生物学研究中，我们往往只知道一小部分已验证的药物-靶标相互作用（DTI），而巨大的未知空间则蕴含着新的治疗机会。矩阵分解是一种强大的机器学习方法，它能通过分析已知的稀疏DTI数据来预测未知的相互作用。本练习将带你深入该技术的核心，通过完成“交替最小二乘法”（ALS）算法中的一个关键更新步骤，亲身体验如何利用潜变量模型来填补DTI矩阵中的空白。",
            "id": "4375888",
            "problem": "在系统生物医学中，对药物-靶点相互作用（DTI）数据进行矩阵分解是一种成熟的方法，用于建模多重药理学、实现药物重定位并支持不良反应预测。考虑一个 $3 \\times 3$ 的DTI矩阵 $\\mathbf{Y}$，其中条目 $y_{ij} \\in \\{0,1\\}$ 表示药物 $i$ 和靶点 $j$ 之间观测到的二元相互作用。给定以下观测到的条目：$(1,1)$ 等于 $1$，$(1,2)$ 等于 $0$，以及 $(2,3)$ 等于 $1$。所有其他条目均为未观测值。\n\n假设一个秩为2的矩阵分解 $\\mathbf{Y} \\approx \\mathbf{X} \\mathbf{T}^{\\top}$，其中 $\\mathbf{X} \\in \\mathbb{R}^{3 \\times 2}$ 包含药物隐因子，$\\mathbf{T} \\in \\mathbb{R}^{3 \\times 2}$ 包含靶点隐因子。使用交替最小二乘法（ALS）来估计 $\\mathbf{X}$ 和 $\\mathbf{T}$，其方法是交替固定一个因子，同时为另一个因子求解正则化最小二乘问题。正则化使用系数为 $\\lambda = 0.1$ 的 $\\ell_{2}$ 惩罚项。\n\n提供了以下初始隐因子：\n- 靶点隐向量（$\\mathbf{T}$ 的行）：$\\mathbf{t}_{1} = \\begin{pmatrix}1  0\\end{pmatrix}$，$\\mathbf{t}_{2} = \\begin{pmatrix}0  1\\end{pmatrix}$，$\\mathbf{t}_{3} = \\begin{pmatrix}1  1\\end{pmatrix}$。\n- 药物隐向量（$\\mathbf{X}$ 的行）：$\\mathbf{x}_{1}^{(0)} = \\begin{pmatrix}0  0\\end{pmatrix}$，$\\mathbf{x}_{2}^{(0)} = \\begin{pmatrix}1  -1\\end{pmatrix}$，$\\mathbf{x}_{3}^{(0)} = \\begin{pmatrix}\\frac{1}{2}  \\frac{3}{10}\\end{pmatrix}$。\n\n请对药物1的隐因子（记为 $\\mathbf{x}_{1}$）执行一次ALS更新，仅使用药物1的观测条目和已提供的靶点隐向量。具体而言，将此更新视为一个仅限于药物1的已观测相互作用的正则化最小二乘问题的解。\n\n以行矩阵的形式提供更新后的 $\\mathbf{x}_{1}$，使用精确值，无需四舍五入。",
            "solution": "用户提供了一个关于在药物-靶点相互作用（DTI）预测背景下，使用交替最小二乘（ALS）算法进行矩阵分解的问题。在进行求解之前，需要对问题陈述进行严格验证。\n\n### 步骤1：提取已知条件\n- 药物-靶点相互作用（DTI）矩阵是 $\\mathbf{Y}$，一个 $3 \\times 3$ 矩阵。\n- 条目 $y_{ij} \\in \\{0,1\\}$ 代表观测到的二元相互作用。\n- 观测到的条目为：$y_{11} = 1$，$y_{12} = 0$，$y_{23} = 1$。\n- $\\mathbf{Y}$ 的所有其他条目均为未观测。\n- 模型是一个秩为2的矩阵分解：$\\mathbf{Y} \\approx \\mathbf{X} \\mathbf{T}^{\\top}$。\n- 药物隐因子矩阵是 $\\mathbf{X} \\in \\mathbb{R}^{3 \\times 2}$。其行向量记为 $\\mathbf{x}_{i}$。\n- 靶点隐因子矩阵是 $\\mathbf{T} \\in \\mathbb{R}^{3 \\times 2}$。其行向量记为 $\\mathbf{t}_{j}$。\n- 优化方法是交替最小二乘法（ALS）。\n- 正则化是系数为 $\\lambda = 0.1$ 的 $\\ell_{2}$ 惩罚项。\n- 提供的固定靶点隐向量是：\n  $\\mathbf{t}_{1} = \\begin{pmatrix}1  0\\end{pmatrix}$，$\\mathbf{t}_{2} = \\begin{pmatrix}0  1\\end{pmatrix}$，$\\mathbf{t}_{3} = \\begin{pmatrix}1  1\\end{pmatrix}$。\n- 初始的（但在本次特定更新步骤中未使用）药物隐向量是：\n  $\\mathbf{x}_{1}^{(0)} = \\begin{pmatrix}0  0\\end{pmatrix}$，$\\mathbf{x}_{2}^{(0)} = \\begin{pmatrix}1  -1\\end{pmatrix}$，$\\mathbf{x}_{3}^{(0)} = \\begin{pmatrix}\\frac{1}{2}  \\frac{3}{10}\\end{pmatrix}$。\n- 任务是为药物1的隐因子（记为 $\\mathbf{x}_{1}$）执行一次ALS更新。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据充分**：该问题在计算系统生物学领域有充分的科学依据。使用带有 $\\ell_{2}$ 正则化的ALS进行低秩矩阵分解是协同过滤的一种标准且被广泛接受的方法，并常规应用于DTI预测以完成药物重定位等任务。该问题的设置是此技术的一个典型范例。\n2.  **适定性**：该问题是适定的。它要求解一个正则化最小二乘优化问题，该问题存在唯一的解析解。所有必要的数据都已提供：药物1的观测相互作用、相应的靶点隐向量以及正则化参数。\n3.  **客观性**：问题陈述完全客观，使用精确的数学语言，不含任何主观论断。\n4.  **不完整或矛盾的设置**：该问题是自洽且一致的。所有矩阵和向量的维度都相互兼容。提供的初始值不会造成矛盾；它们仅仅代表了所请求的更新步骤之前的系统状态。\n5.  **不现实或不可行**：对于算法的小规模演示来说，这些条件和数据是现实的。数值很简单，可以进行易于处理的计算。\n6.  **不适定或结构不良**：问题结构清晰，要求进行一个特定的、定义明确的数学运算。解是唯一且稳定的。\n7.  **伪深刻、琐碎或同义反复**：该问题并非琐碎；它要求正确地构建和求解一个正则化最小二乘问题，这是机器学习和数据科学中的一个基本概念。\n8.  **超出科学可验证性**：结果可以通过数学推导得出并进行验证。\n\n### 步骤3：结论与行动\n问题是**有效的**。将推导解答。\n\n交替最小二乘（ALS）算法通过固定一个维度（例如，靶点）的因子，来更新另一个维度（例如，药物）的隐因子。单个药物隐向量 $\\mathbf{x}_{i}$ 的更新是通过最小化其观测相互作用的平方误差总和，再加上一个 $\\ell_{2}$ 正则化项来找到的。\n\n设 $\\mathbf{x}_{1} = \\begin{pmatrix} u  v \\end{pmatrix}$ 是我们想要确定的药物1的隐向量。与药物1有观测相互作用的靶点索引集合是 $\\mathcal{O}_1 = \\{1, 2\\}$。相应的相互作用值是 $y_{11} = 1$ 和 $y_{12} = 0$。\n\n仅限于药物1的已观测条目的正则化最小二乘目标函数 $L(\\mathbf{x}_1)$ 为：\n$$\nL(\\mathbf{x}_1) = \\sum_{j \\in \\mathcal{O}_1} (y_{1j} - \\mathbf{x}_1 \\mathbf{t}_j^{\\top})^2 + \\lambda \\|\\mathbf{x}_1\\|_2^2\n$$\n在更新药物向量 $\\mathbf{x}_i$ 的一般情况下，这个最小化问题的解由行向量 $\\mathbf{x}_i$ 的转置的闭式方程给出：\n$$\n\\mathbf{x}_i^{\\top} = \\left( \\mathbf{T}_{\\mathcal{O}_i}^{\\top} \\mathbf{T}_{\\mathcal{O}_i} + \\lambda \\mathbf{I} \\right)^{-1} \\mathbf{T}_{\\mathcal{O}_i}^{\\top} \\mathbf{y}_i^{(\\mathcal{O}_i)}\n$$\n其中 $\\mathbf{T}_{\\mathcal{O}_i}$ 是由 $j \\in \\mathcal{O}_i$ 的靶点向量 $\\mathbf{t}_j$ 作为行的矩阵，$\\mathbf{y}_i^{(\\mathcal{O}_i)}$ 是由 $j \\in \\mathcal{O}_i$ 的观测相互作用值 $y_{ij}$ 组成的列向量，$\\lambda$ 是正则化参数，$\\mathbf{I}$ 是相应大小的单位矩阵（此处为 $2 \\times 2$）。\n\n对于我们的具体问题，我们正在更新 $\\mathbf{x}_1$。相关参数如下：\n- 药物1的观测靶点索引集合：$\\mathcal{O}_1 = \\{1, 2\\}$。\n- 观测值向量：$\\mathbf{y}_1^{(\\mathcal{O}_1)} = \\begin{pmatrix} y_{11} \\\\ y_{12} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n- 相应的靶点隐向量矩阵：$\\mathbf{T}_{\\mathcal{O}_1} = \\begin{pmatrix} \\mathbf{t}_1 \\\\ \\mathbf{t}_2 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。这是一个 $2 \\times 2$ 的单位矩阵 $\\mathbf{I}_2$。\n- 正则化参数：$\\lambda = 0.1$。\n\n现在，我们可以将这些值代入闭式解中。首先，我们计算方程的各个组成部分。\n乘积 $\\mathbf{T}_{\\mathcal{O}_1}^{\\top} \\mathbf{T}_{\\mathcal{O}_1}$ 为：\n$$\n\\mathbf{T}_{\\mathcal{O}_1}^{\\top} \\mathbf{T}_{\\mathcal{O}_1} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}^{\\top} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n乘积 $\\mathbf{T}_{\\mathcal{O}_1}^{\\top} \\mathbf{y}_1^{(\\mathcal{O}_1)}$ 为：\n$$\n\\mathbf{T}_{\\mathcal{O}_1}^{\\top} \\mathbf{y}_1^{(\\mathcal{O}_1)} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}^{\\top} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n现在构建要求逆的项 $(\\mathbf{T}_{\\mathcal{O}_1}^{\\top} \\mathbf{T}_{\\mathcal{O}_1} + \\lambda \\mathbf{I})$：\n$$\n\\mathbf{T}_{\\mathcal{O}_1}^{\\top} \\mathbf{T}_{\\mathcal{O}_1} + \\lambda \\mathbf{I} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + 0.1 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\begin{pmatrix} 0.1  0 \\\\ 0  0.1 \\end{pmatrix} = \\begin{pmatrix} 1.1  0 \\\\ 0  1.1 \\end{pmatrix}\n$$\n该矩阵可以用分数表示为 $\\begin{pmatrix} \\frac{11}{10}  0 \\\\ 0  \\frac{11}{10} \\end{pmatrix}$。\n这个对角矩阵的逆矩阵可以通过对每个对角元素取倒数得到：\n$$\n\\left( \\mathbf{T}_{\\mathcal{O}_1}^{\\top} \\mathbf{T}_{\\mathcal{O}_1} + \\lambda \\mathbf{I} \\right)^{-1} = \\begin{pmatrix} \\frac{11}{10}  0 \\\\ 0  \\frac{11}{10} \\end{pmatrix}^{-1} = \\begin{pmatrix} \\frac{10}{11}  0 \\\\ 0  \\frac{10}{11} \\end{pmatrix}\n$$\n最后，我们通过将逆矩阵乘以 $\\mathbf{T}_{\\mathcal{O}_1}^{\\top} \\mathbf{y}_1^{(\\mathcal{O}_1)}$ 来计算 $\\mathbf{x}_1^{\\top}$：\n$$\n\\mathbf{x}_1^{\\top} = \\begin{pmatrix} \\frac{10}{11}  0 \\\\ 0  \\frac{10}{11} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (\\frac{10}{11} \\cdot 1) + (0 \\cdot 0) \\\\ (0 \\cdot 1) + (\\frac{10}{11} \\cdot 0) \\end{pmatrix} = \\begin{pmatrix} \\frac{10}{11} \\\\ 0 \\end{pmatrix}\n$$\n这个结果是列向量 $\\mathbf{x}_1^{\\top}$。药物1更新后的隐因子 $\\mathbf{x}_1$ 是一个行向量，即 $\\mathbf{x}_1^{\\top}$ 的转置：\n$$\n\\mathbf{x}_1 = \\left( \\mathbf{x}_1^{\\top} \\right)^{\\top} = \\begin{pmatrix} \\frac{10}{11}  0 \\end{pmatrix}\n$$\n因此，药物1更新后的隐因子是 $\\begin{pmatrix} \\frac{10}{11}  0 \\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{10}{11}  0 \\end{pmatrix}}\n$$"
        }
    ]
}