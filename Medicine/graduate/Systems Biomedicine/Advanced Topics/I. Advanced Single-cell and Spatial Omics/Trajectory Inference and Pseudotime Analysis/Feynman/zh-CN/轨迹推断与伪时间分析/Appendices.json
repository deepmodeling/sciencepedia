{
    "hands_on_practices": [
        {
            "introduction": "在将离散的细胞聚类转化为连续的发育轨迹时，首要任务是确定它们之间最可能的连接方式。本练习利用最小生成树 (Minimum Spanning Tree, MST) 的概念，该方法基于简约性原则，旨在找到连接所有细胞状态的最“经济”的路径骨架。通过这个实践，你将掌握如何从细胞间的距离矩阵中构建出代表生物过程核心通路的基础结构。",
            "id": "4614364",
            "problem": "一项单细胞转录组学实验产生了六个簇中心，代表了嵌入在二维主成分分析 (PCA) 空间中的推定细胞状态。状态之间的距离以 PCA 空间中的标准化欧几里得距离（无量纲）来衡量。考虑一个无向加权图，其顶点集为标记为 $1,2,3,4,5,6$ 的六个状态，其边权重是由对称矩阵给出的两两之间的距离\n$$\nD \\;=\\; \\begin{pmatrix}\n0  1  2  3  4  \\sqrt{5} \\\\\n1  0  1  2  3  \\sqrt{2} \\\\\n2  1  0  1  2  1 \\\\\n3  2  1  0  1  \\sqrt{2} \\\\\n4  3  2  1  0  \\sqrt{5} \\\\\n\\sqrt{5}  \\sqrt{2}  1  \\sqrt{2}  \\sqrt{5}  0\n\\end{pmatrix}.\n$$\n在细胞演进的轨迹推断和伪时间分析中，一个适当构建的图的最小生成树 (MST) 常被用来表示无环的线性或分支发育轨迹。\n\n从图、距离和生成树的基本定义出发，确定由 $D$ 定义的图的最小生成树 (MST) 的总权重（边权重之和），并从基本原理出发解释为什么在伪时间分析中，MST 经常被用来表示无环的线性或分支轨迹。将最终的总权重表示为一个不进行四舍五入的精确数，并且不带单位。",
            "solution": "该问题要求确定代表细胞状态的图的最小生成树 (MST) 的总权重，并解释 MST 在轨迹推断中的作用。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件：**\n- 系统由六个细胞状态组成，标记为顶点 $1, 2, 3, 4, 5, 6$。\n- 该图是无向和加权的。\n- 权重代表标准化的欧几里得距离，由对称矩阵 $D$ 给出：\n$$\nD \\;=\\; \\begin{pmatrix}\n0  1  2  3  4  \\sqrt{5} \\\\\n1  0  1  2  3  \\sqrt{2} \\\\\n2  1  0  1  2  1 \\\\\n3  2  1  0  1  \\sqrt{2} \\\\\n4  3  2  1  0  \\sqrt{5} \\\\\n\\sqrt{5}  \\sqrt{2}  1  \\sqrt{2}  \\sqrt{5}  0\n\\end{pmatrix}.\n$$\n- 任务是找到由 $D$ 定义的图的 MST 的总权重。\n- 另一项解释性任务是，从基本原理出发，论证在伪时间分析中使用 MST 表示细胞轨迹的合理性。\n\n**1.2. 依据标准进行验证：**\n- **科学依据：** 该问题牢固地植根于生物信息学，特别是单细胞转录组数据的分析。使用 PCA 进行降维，使用欧几里得距离衡量细胞状态之间的差异性，以及使用 MST 进行轨迹推断都是标准且成熟的方法（例如，在 Monocle 算法中实现的方法）。该设置是对一个真实世界科学问题的简化但概念上准确的表示。\n- **良构性：** 该问题提供了一个具有 $V=6$ 个顶点的完全、加权、无向图。由于距离矩阵 $D$ 中的所有非对角线元素均为正，该图是连通的。对于任何具有非负边权重的连通无向图，都保证存在一个 MST。虽然重复边权重（例如，多个权重为 $1$ 的边）的存在意味着 MST 本身可能不唯一，但图论的一个基本定理指出，对于给定的图，所有可能的 MST 都将具有相同的总权重。因此，询问“MST 的总权重”的问题是良构的，并且有唯一的答案。\n- **客观性：** 该问题使用精确的数学和科学术语进行陈述。它不含主观或模糊的语言。\n\n**1.3. 结论：**\n该问题是有效的，因为它具有科学依据、是良构的且客观的。\n\n### 步骤 2：求解\n\n#### A 部分：计算 MST 总权重\n\n要找到最小生成树 (MST)，我们可以采用标准的贪心算法，例如 Kruskal 算法或 Prim 算法。我们将使用 Kruskal 算法，该算法涉及迭代地添加权重最小且不会与已选边形成环路的边。\n\n该图有 $V=6$ 个顶点。该图的任何生成树都必须恰好包含 $V-1 = 5$ 条边。\n\n1.  **按升序排列所有唯一的边及其权重。** 边由顶点对 $(i, j)$ 及其权重 $D_{ij}$ 表示。我们只考虑矩阵 $D$ 的上三角部分以避免重复。\n    -   权重 $1$：边 $(1, 2)$, $(2, 3)$, $(3, 4)$, $(4, 5)$, $(3, 6)$。\n    -   权重 $\\sqrt{2} \\approx 1.414$：边 $(2, 6)$, $(4, 6)$。\n    -   权重 $2$：边 $(1, 3)$, $(2, 4)$, $(3, 5)$。\n    -   权重 $\\sqrt{5} \\approx 2.236$：边 $(1, 6)$, $(5, 6)$。\n    -   权重 $3$：边 $(1, 4)$, $(2, 5)$。\n    -   权重 $4$：边 $(1, 5)$。\n\n2.  **执行 Kruskal 算法：** 我们通过按权重递增的顺序添加边来构建 MST，并确保不形成环路。我们从一个包含 $6$ 个不相交集合的森林开始，每个顶点一个集合：$\\{1\\}, \\{2\\}, \\{3\\}, \\{4\\}, \\{5\\}, \\{6\\}$。\n\n    -   **考虑权重为 $1$ 的边**：\n        a.  选择边 $(1, 2)$。它连接两个不相交的集合。没有环路。\n            -   MST 边集：$\\{(1, 2)\\}$。\n            -   集合：$\\{\\{1, 2\\}, \\{3\\}, \\{4\\}, \\{5\\}, \\{6\\}\\}$。\n            -   当前总权重：$1$。\n        b.  选择边 $(2, 3)$。它将顶点 $3$ 连接到集合 $\\{1, 2\\}$。没有环路。\n            -   MST 边集：$\\{(1, 2), (2, 3)\\}$。\n            -   集合：$\\{\\{1, 2, 3\\}, \\{4\\}, \\{5\\}, \\{6\\}\\}$。\n            -   当前总权重：$1 + 1 = 2$。\n        c.  选择边 $(3, 4)$。它将顶点 $4$ 连接到集合 $\\{1, 2, 3\\}$。没有环路。\n            -   MST 边集：$\\{(1, 2), (2, 3), (3, 4)\\}$。\n            -   集合：$\\{\\{1, 2, 3, 4\\}, \\{5\\}, \\{6\\}\\}$。\n            -   当前总权重：$2 + 1 = 3$。\n        d.  选择边 $(4, 5)$。它将顶点 $5$ 连接到集合 $\\{1, 2, 3, 4\\}$。没有环路。\n            -   MST 边集：$\\{(1, 2), (2, 3), (3, 4), (4, 5)\\}$。\n            -   集合：$\\{\\{1, 2, 3, 4, 5\\}, \\{6\\}\\}$。\n            -   当前总权重：$3 + 1 = 4$。\n        e.  选择边 $(3, 6)$。它将顶点 $6$ 连接到集合 $\\{1, 2, 3, 4, 5\\}$。没有环路。\n            -   MST 边集：$\\{(1, 2), (2, 3), (3, 4), (4, 5), (3, 6)\\}$。\n            -   集合：$\\{\\{1, 2, 3, 4, 5, 6\\}\\}$。\n            -   当前总权重：$4 + 1 = 5$。\n\n3.  **终止：** 我们现在已经选择了 $5$ 条边，所有 $6$ 个顶点都连接在一个连通分量中。算法终止。得到的结构是一棵生成树。因为我们遵循了 Kruskal 算法的贪心选择性质，所以这是一棵 MST。\n\nMST 的总权重是所选边权重之和：\n$$ W_{MST} = 1 + 1 + 1 + 1 + 1 = 5 $$\n\n#### B 部分：MST 在轨迹推断中应用的合理性论证\n\n使用 MST 对细胞轨迹进行建模是基于一系列将生物学假设转化为图论框架的逻辑假设。\n\n1.  **状态的表示：** 在单细胞分析中，细胞由高维基因表达向量来表征。相似的细胞群被聚类成“状态”（我们图中的顶点）。两个状态中心之间的距离（例如，PCA 空间中的欧几里得距离）是其转录组差异性的度量。距离小意味着相似性高。\n\n2.  **简约性原则（奥卡姆剃刀）：** 像细胞分化这样的生物过程，被假设为通过一系列渐进的变化来进行。两个非常不相似的状态之间的直接转变，被认为比通过一系列中间的、更相似的状态的转变序列的可能性要小。在数学上，这转化为寻找一个使总差异性最小化的路径结构。我们寻求连接细胞状态的“阻力最小的路径”。\n\n3.  **轨迹的连通性和无环性：**\n    -   **连通性：** 模型假设所有观察到的细胞状态都是单个、连贯的生物过程的一部分。因此，连接它们的结构必须是一个**连通图**。要连接所有 $V$ 个顶点，我们需要一个**生成子图**。\n    -   **无环性：** 简单的发育或分化过程通常不是循环的；细胞沿着一条路径向前发展（例如，从干细胞到神经元），而不是循环回到祖先状态。这要求底层的图结构应该是一棵**树**（一种无向、连通、无环的图），它自然地代表了线性或分支的演进。\n\n4.  **通过 MST 进行综合：** 最小生成树是唯一满足这些标准的数学对象。\n    -   根据定义，它是一个**生成**子图，因此它连接所有顶点（满足连通性）。\n    -   根据定义，它是一棵**树**，因此是无环的（对非循环的演进进行建模）。\n    -   在所有可能的生成树中，MST 是具有**最小可能总边权重**的那一个。这直接实现了简约性原则，找到了状态之间具有最低总差异性的连接集合。\n\n总之，MST 提供了连接所有细胞状态而又不形成环路的最简约（总距离最低）的骨架。这个结构为生物过程的底层拓扑结构提供了一个稳健的假设，在此基础上，可以通过根据细胞沿树分支到指定根状态（例如，已知的祖细胞类型）的距离来排序，从而计算出“伪时间”。",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "轨迹的骨架结构固然重要，但更关键的是确定细胞沿轨迹移动的方向和“速度”。RNA速度 (RNA velocity) 模型通过分析新生（未剪接）和成熟（已剪接）$mRNA$ 的丰度，为我们提供了推断细胞状态瞬时变化的有力工具。本练习将带你从化学动力学的第一性原理出发，推导并计算RNA速度向量，让你亲身体验如何揭示驱动细胞命运转变的潜在动力学。",
            "id": "4614291",
            "problem": "在单细胞核糖核酸测序 (scRNA-seq) 轨迹推断中，一种量化瞬时转录状态变化的常用方法是使用一级质量作用动力学来模拟信使核糖核酸前体 (pre-mRNA) 的剪接和成熟信使核糖核酸 (mRNA) 的降解。考虑一个分析了 $2$ 个基因的单细胞，其观测到的未剪接计数向量为 $\\mathbf{u}=(5,4)$，已剪接计数向量为 $\\mathbf{s}=(10,8)$。假设一个线性的两阶段动力学模型，其中未剪接分子以恒定的转录速率产生，并以一级剪接速率转化为已剪接分子，而已剪接分子则以一级降解速率降解。设剪接速率为 $\\beta=0.2$，降解速率为 $\\gamma=0.1$，并假设两者在对应于细胞局部伪时间邻域的短时间窗口内是恒定的。仅使用一级反应的质量作用原理以及未剪接和已剪接物种的定义，从第一性原理推导出每个基因的已剪接计数瞬时变化率（即已剪接RNA速率）的表达式，然后计算该细胞的 $2$ 维速率向量。根据每个分量的符号，在 $2$ 基因状态空间中解释每个基因沿伪时间的瞬时状态变化方向。无需四舍五入。请将最终的速率向量表示为行向量。",
            "solution": "该问题是有效的。它在科学上基于应用于基因表达的质量作用动力学原理，这是生物信息学中RNA速率模型的基石。问题表述清晰，提供了推导和计算所要求的速率向量所需的所有数据——未剪接计数 $\\mathbf{u}$、已剪接计数 $\\mathbf{s}$、剪接速率 $\\beta$ 和降解速率 $\\gamma$。术语精确客观。\n\n中心任务是为单个基因推导已剪接信使核糖核酸 (mRNA) 计数（表示为 $s$）的瞬时变化率的表达式。这个量也被称为已剪接RNA速率。该推导基于一个由一级质量作用动力学控制的两阶段基因表达动力学模型。\n\n设 $u(t)$ 为给定基因在时间 $t$ 的未剪接 pre-mRNA 分子数， $s(t)$ 为已剪接 mRNA 分子数。该模型涉及影响已剪接 mRNA 群体的两个关键过程：\n\n1.  **已剪接mRNA的产生**：未剪接分子被转化为已剪接分子。这就是剪接过程。问题指出这是一个速率常数为 $\\beta$ 的一级反应。\n    该反应可示意性地表示为：\n    $$\n    u \\xrightarrow{\\beta} s\n    $$\n    根据一级反应的质量作用原理，此过程的速率与反应物的量（即未剪接 mRNA 计数 $u$）成正比。因此， $s$ 的产生速率由下式给出：\n    $$\n    \\text{Rate of Production} = \\beta u\n    $$\n\n2.  **已剪接mRNA的降解**：已剪接分子被降解并从系统中移除。问题指出这是一个速率常数为 $\\gamma$ 的一级反应。\n    该反应可示意性地表示为：\n    $$\n    s \\xrightarrow{\\gamma} \\emptyset\n    $$\n    其中 $\\emptyset$ 代表降解状态。根据质量作用原理，此过程的速率与反应物的量（即已剪接 mRNA 计数 $s$）成正比。因此， $s$ 的损失速率由下式给出：\n    $$\n    \\text{Rate of Loss} = \\gamma s\n    $$\n\n已剪接计数的瞬时变化率 $\\frac{ds}{dt}$ 是这两个过程的净结果：产生速率减去损失速率。这就得出了已剪接 mRNA 的基本 RNA 速率方程：\n$$\n\\frac{ds}{dt} = \\beta u - \\gamma s\n$$\n这个从第一性原理出发的推导，为单个基因的已剪接 RNA 速率提供了表达式。\n\n问题要求我们为一个具有 $2$ 个基因的细胞计算 $2$ 维速率向量。我们可以将推导出的公式独立地应用于每个基因。设未剪接计数向量为 $\\mathbf{u} = (u_1, u_2)$，已剪接计数向量为 $\\mathbf{s} = (s_1, s_2)$。那么速率向量 $\\mathbf{v}$ 由 $\\mathbf{v} = \\frac{d\\mathbf{s}}{dt} = (\\frac{ds_1}{dt}, \\frac{ds_2}{dt})$ 给出。\n\n给定的值为：\n- 未剪接计数向量：$\\mathbf{u} = (u_1, u_2) = (5, 4)$\n- 已剪接计数向量：$\\mathbf{s} = (s_1, s_2) = (10, 8)$\n- 剪接速率常数：$\\beta = 0.2$\n- 降解速率常数：$\\gamma = 0.1$\n\n现在我们可以计算速率向量的两个分量：\n\n对于第一个基因（$i=1$）：\n$$\nv_1 = \\frac{ds_1}{dt} = \\beta u_1 - \\gamma s_1\n$$\n代入数值：\n$$\nv_1 = (0.2)(5) - (0.1)(10) = 1.0 - 1.0 = 0\n$$\n\n对于第二个基因（$i=2$）：\n$$\nv_2 = \\frac{ds_2}{dt} = \\beta u_2 - \\gamma s_2\n$$\n代入数值：\n$$\nv_2 = (0.2)(4) - (0.1)(8) = 0.8 - 0.8 = 0\n$$\n\n因此，该细胞的 $2$ 维速率向量为 $\\mathbf{v} = (0, 0)$。\n\n任务的最后一部分是解释每个分量的符号。\n- 基因 1 的速率分量为 $v_1 = 0$。速率为零表示从其前体产生已剪接 mRNA 的速率（$\\beta u_1 = 1.0$）与其降解速率（$\\gamma s_1 = 1.0$）完全平衡。这意味着该基因在其表达动力学中处于稳态（或不动点）。已剪接 mRNA 的量没有瞬时变化。\n- 基因 2 的速率分量为 $v_2 = 0$。类似地，这表示基因 2 的已剪接 mRNA 的产生速率（$\\beta u_2 = 0.8$）与其降解速率（$\\gamma s_2 = 0.8$）完全平衡。该基因也处于稳态。\n\n由于速率向量的两个分量都为零，由这两个已剪接 mRNA 的丰度所描述的细胞转录状态，在伪时间的这一瞬间没有发生变化。在轨迹推断的背景下，该细胞位于动力学系统的一个不动点上，这可能代表一个稳定的细胞状态、一个不稳定的祖细胞状态，或动态过程中波峰或波谷处的瞬时状态。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "任何计算模型都存在不确定性，对轨迹推断的结果进行严格的评估是科学研究中必不可少的一环。本练习引入了一种基于信息论的方法，通过自助法 (bootstrap) 重采样来模拟数据的变异性，并利用香农熵来量化不同发育路径选择上的不确定性。完成此练习将帮助你建立评估计算生物学模型稳定性的思维框架，并掌握一种量化轨迹推断结果可靠性的实用指标。",
            "id": "4614298",
            "problem": "在生物信息学和医学数据分析领域的单细胞转录组学轨迹推断中，一种常见方法是将细胞状态表示为图中的节点，并使用从根细胞到目标细胞的最短路径作为伪时间的代理。为了评估推断出的伪时间相对于数据变异性的稳定性，可以对特征（例如基因）进行非参数自举重采样，以获得一个图的集合，其中每个图都通过标准流程（例如，在嵌入上构建$k$-最近邻（KNN）图）构建，并在每个自举图上提取从固定根细胞 $s$ 到目标细胞 $t$ 的最短路径。\n\n从以下基本概念出发：(i) 自举法通过有放回重采样来近似采样变异性，以及 (ii) 信息论中的熵量化了离散分布中的不确定性。请为目标细胞 $t$ 提出一个有原则的、无量纲的路径模糊性指数，该指数基于在 $R$ 个自举图中从 $s$ 到 $t$ 的最短路径选择的不确定性。您的构建必须满足以下性质：它是根据在自举中观察到的不同最短路径的经验频率计算的；当所有自举都选择相同的最短路径时，它为零；当在观察到的不同最短路径之间的选择具有最大不确定性时，它为一。\n\n然后，在以下小型合成示例上计算此指数。一个单细胞数据集在自举中产生了 $s$ 和 $t$ 之间的三条不同的简单最短路径：$P_{1}$、$P_{2}$ 和 $P_{3}$。在 $R = 10$ 个自举图中，所选最短路径的序列是\n$$\nP_{1},\\ P_{1},\\ P_{2},\\ P_{1},\\ P_{3},\\ P_{2},\\ P_{1},\\ P_{2},\\ P_{1},\\ P_{3}.\n$$\n将最终答案表示为小数，并四舍五入到四位有效数字。",
            "solution": "用户需要该问题的解答，该问题分为两部分：首先，为轨迹推断分析提出一个有原则的、无量纲的路径模糊性指数；其次，在一个给定的合成示例上计算此指数。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n- **领域**：轨迹推断、单细胞转录组学、生物信息学、医学数据分析。\n- **方法**：对特征进行非参数自举重采样，共计 $R$ 个自举图。\n- **分析目标**：评估推断出的伪时间的稳定性，该伪时间由从根细胞 $s$ 到目标细胞 $t$ 的最短路径表示。\n- **任务**：为细胞 $t$ 提出一个“路径模糊性指数”。\n- **指数性质**：\n    1.  无量纲。\n    2.  根据在 $R$ 次自举中观察到的从 $s$ 到 $t$ 的不同最短路径的经验频率计算。\n    3.  当所有自举都产生相同的最短路径时，指数必须为 $0$。\n    4.  当在观察到的不同最短路径之间的选择具有最大不确定性时，指数必须为 $1$。\n- **合成示例数据**：\n    -   总自举次数：$R = 10$。\n    -   观察到的不同最短路径数量：$3$，表示为 $P_{1}$、$P_{2}$ 和 $P_{3}$。\n    -   观察到的路径序列：$P_{1},\\ P_{1},\\ P_{2},\\ P_{1},\\ P_{3},\\ P_{2},\\ P_{1},\\ P_{2},\\ P_{1},\\ P_{3}$。\n- **输出要求**：计算该示例的指数，并将结果四舍五入到四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题牢固地植根于计算生物学和信息论的既定原则。使用自举法评估统计稳定性、基于图的细胞状态模型以及使用熵来量化不确定性，这些都是标准、有效的科学概念。\n- **良定性**：该问题是良定的。它要求构建一个必须满足一组明确约束条件的指数。这些约束条件唯一地将构建引向归一化的 Shannon 熵。为计算部分提供的数据是完整且充分的。“最大不确定性”的定义被指定为相对于*观察到的*路径，这消除了歧义。\n- **客观性**：问题以精确、客观、技术性的语言陈述，没有主观或偏颇的主张。\n- **结论**：该问题在科学上是合理的、良定的、客观的，并且没有任何在问题验证清单中列出的使其无效的缺陷。\n\n**步骤 3：结论与行动**\n问题有效。将提供解决方案。\n\n**第 1 部分：提出路径模糊性指数**\n\n该问题要求一个基于选择的离散分布（不同的最短路径）来量化不确定性的指数。衡量概率分布不确定性的最有原则的方法是 Shannon 熵。\n\n假设有 $R$ 次自举复制。将在这些复制中观察到的从细胞 $s$ 到细胞 $t$ 的唯一最短路径集合设为 $\\mathcal{P} = \\{P_1, P_2, \\dots, P_K\\}$，其中 $K$ 是不同路径的数量。设 $n_i$ 为路径 $P_i$ 被观察到的次数，使得 $\\sum_{i=1}^{K} n_i = R$。观察到路径 $P_i$ 的经验概率（或频率）由 $p_i = \\frac{n_i}{R}$ 给出。概率集合 $\\{p_1, p_2, \\dots, p_K\\}$ 构成一个离散概率分布，且 $\\sum_{i=1}^{K} p_i = 1$。\n\n该分布的 Shannon 熵用于衡量其不确定性，其公式为：\n$$\nH = - \\sum_{i=1}^{K} p_i \\ln(p_i)\n$$\n我们使用自然对数 ($\\ln$)，因此熵的单位是“奈特 (nat)”。按照惯例，如果 $p_i=0$，则项 $p_i \\ln(p_i)$ 取为 $0$，这与极限 $\\lim_{x \\to 0^+} x \\ln(x) = 0$ 一致。\n\n这个熵 $H$ 总是非负的。\n- 如果没有不确定性（即，总是选择一条路径），那么对于某个索引 $j$，$p_j = 1$ 并且对于所有 $i \\neq j$，$p_i = 0$。熵为 $H = -(1 \\ln(1) + \\sum_{i \\neq j} 0 \\ln(0)) = 0$。这满足了指数所需的第三个性质。\n- 当不确定性最大时，熵也达到最大值。对于一组 $K$ 个可能的结果，当分布是均匀的，即对于所有 $i=1, \\dots, K$，$p_i = \\frac{1}{K}$ 时，就会发生这种情况。最大可能熵为：\n$$\nH_{\\text{max}} = - \\sum_{i=1}^{K} \\frac{1}{K} \\ln\\left(\\frac{1}{K}\\right) = -K \\left(\\frac{1}{K} \\ln\\left(\\frac{1}{K}\\right)\\right) = -\\ln\\left(\\frac{1}{K}\\right) = \\ln(K)\n$$\n\n为了创建一个范围从 $0$ 到 $1$ 的无量纲指数，我们可以用最大可能熵 $H_{\\text{max}}$ 来归一化观察到的熵 $H$。我们将路径模糊性指数 $A$ 定义为：\n$$\nA = \\frac{H}{H_{\\text{max}}} = \\frac{- \\sum_{i=1}^{K} p_i \\ln(p_i)}{\\ln(K)}\n$$\n该指数满足所有要求的性质：\n1.  **无量纲**：它是两个熵（单位相同）的比值，因此是无量纲的。\n2.  **基于经验频率**：它是直接从概率 $p_i$ 计算出来的。\n3.  **无不确定性时为零**：如果总是选择一条路径，则 $K=1$。在这种情况下，分母 $\\ln(1)=0$，分子也为 $0$。我们必须为这种情况定义该指数。如果 $K=1$，则没有模糊性，因此指数必须为 $0$。我们正式定义，如果 $K \\le 1$，则 $A=0$。该公式用于 $K > 1$ 的情况。\n4.  **最大不确定性时为一**：如果所有 $K$ 条观察到的路径都是等可能的（$p_i = 1/K$），那么 $H = \\ln(K)$，并且 $A = \\frac{\\ln(K)}{\\ln(K)} = 1$。\n\n因此，这个有原则的路径模糊性指数就是归一化的 Shannon 熵。\n\n**第 2 部分：合成示例的计算**\n\n我们得到以下 $R=10$ 次观察到的最短路径序列：\n$$\nP_{1},\\ P_{1},\\ P_{2},\\ P_{1},\\ P_{3},\\ P_{2},\\ P_{1},\\ P_{2},\\ P_{1},\\ P_{3}\n$$\n\n首先，我们计算每条不同路径的出现次数：\n-   $P_1$ 的计数：$n_1 = 5$\n-   $P_2$ 的计数：$n_2 = 3$\n-   $P_3$ 的计数：$n_3 = 2$\n观察总数为 $n_1 + n_2 + n_3 = 5 + 3 + 2 = 10$，与 $R$ 相符。\n\n观察到的不同路径数量为 $K = 3$。由于 $K > 1$，我们可以使用指数 $A$ 的公式。\n\n接下来，我们计算经验概率 $p_i = n_i/R$：\n-   $p_1 = \\frac{5}{10} = 0.5$\n-   $p_2 = \\frac{3}{10} = 0.3$\n-   $p_3 = \\frac{2}{10} = 0.2$\n分布为 $\\{p_1, p_2, p_3\\} = \\{0.5, 0.3, 0.2\\}$。\n\n现在，我们计算 Shannon 熵 $H$：\n$$\nH = - \\sum_{i=1}^{3} p_i \\ln(p_i) = - \\left( 0.5 \\ln(0.5) + 0.3 \\ln(0.3) + 0.2 \\ln(0.2) \\right)\n$$\n使用性质 $\\ln(x/y) = \\ln(x) - \\ln(y)$：\n-   $0.5 \\ln(0.5) = 0.5 \\ln(1/2) = -0.5 \\ln(2)$\n-   $0.3 \\ln(0.3) = 0.3 \\ln(3/10) = 0.3 (\\ln(3) - \\ln(10))$\n-   $0.2 \\ln(0.2) = 0.2 \\ln(1/5) = -0.2 \\ln(5)$\n\n数值上：\n-   $\\ln(0.5) \\approx -0.693147$\n-   $\\ln(0.3) \\approx -1.203973$\n-   $\\ln(0.2) \\approx -1.609438$\n所以，熵为：\n$$\nH \\approx - \\left( 0.5 \\times (-0.693147) + 0.3 \\times (-1.203973) + 0.2 \\times (-1.609438) \\right)\n$$\n$$\nH \\approx - \\left( -0.346574 - 0.361192 - 0.321888 \\right) = -(-1.029654) = 1.029654\n$$\n\n对于 $K=3$ 个不同结果，最大可能熵为：\n$$\nH_{\\text{max}} = \\ln(K) = \\ln(3) \\approx 1.098612\n$$\n\n最后，我们计算路径模糊性指数 $A$：\n$$\nA = \\frac{H}{H_{\\text{max}}} \\approx \\frac{1.029654}{1.098612} \\approx 0.937227\n$$\n\n题目要求将答案四舍五入到四位有效数字。\n$$\nA \\approx 0.9372\n$$",
            "answer": "$$\\boxed{0.9372}$$"
        }
    ]
}