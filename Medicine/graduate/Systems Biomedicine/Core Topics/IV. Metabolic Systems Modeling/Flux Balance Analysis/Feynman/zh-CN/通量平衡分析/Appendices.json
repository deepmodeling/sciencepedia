{
    "hands_on_practices": [
        {
            "introduction": "通量平衡分析的第一步是将生物反应网络转化为精确的数学形式。本练习将引导你构建化学计量矩阵（$S$），它是FBA模型的基石。通过分析该矩阵的性质，我们可以获得关于网络能力的基本见解，例如它是否能够维持一个非零的稳态通量。这项实践旨在巩固你对生物反应与其线性代数表示之间联系的理解。",
            "id": "3913505",
            "problem": "考虑一个小代谢网络，使用流通平衡分析 (FBA) 进行分析，其中的代谢物为 $A$、$B$、$C$ 和 $D$，反应由 $R_1:\\ A + B \\to C$、$R_2:\\ C \\to D$ 和 $R_3:\\ D \\to A$ 给出。将所有代谢物 $A$、$B$、$C$ 和 $D$ 视为内部代谢物，并假设不存在交换反应。仅使用以下基本定义：(i) 化学计量矩阵 $S$ 的每一行对应一种代谢物，每一列对应一个反应；(ii) 元素 $S_{ij}$ 是代谢物 $i$ 在反应 $j$ 中的化学计量系数；(iii) 内部代谢物的稳态质量平衡要求反应通量向量 $v$ 满足 $S\\,v = 0$。基于这些定义，执行以下操作：\n\n- 构建化学计量矩阵 $S$，其行序为 $(A, B, C, D)$，列序为 $(R_1, R_2, R_3)$。在你的推理过程中，请说明用于底物和产物的符号约定。\n- 然后，使用稳态约束 $S\\,v = 0$ 并且没有交换反应，确定 $S$ 的零空间维度（等价于稳态通量向量 $v$ 的自由度数）。\n\n最终答案以单个整数形式提供，不带单位。无需四舍五入。答案必须是单个实数值。",
            "solution": "该问题要求从一个小型代谢网络中得出两个结果：构建其化学计量矩阵 $S$ 和确定 $S$ 的零空间维度。分析将基于流通平衡分析 (FBA) 的原理进行。\n\n首先，我们构建化学计量矩阵 $S$。问题规定，行按顺序对应代谢物 ($A$, $B$, $C$, $D$)，列按顺序对应反应 ($R_1$, $R_2$, $R_3$)。元素 $S_{ij}$ 表示代谢物 $i$ 在反应 $j$ 中的化学计量系数。我们将使用标准约定，其中底物（反应物）的系数为负，产物的系数为正。\n\n给出的反应如下：\n$R_1:\\ A + B \\to C$\n$R_2:\\ C \\to D$\n$R_3:\\ D \\to A$\n\n我们来确定这个 $4 \\times 3$ 矩阵 $S$ 的各列：\n\n对于反应 $R_1$，代谢物 $A$ 和 $B$ 被消耗（底物，系数为 $-1$），代谢物 $C$ 被生成（产物，系数为 $+1$）。代谢物 $D$ 不参与反应（系数为 $0$）。因此，$S$ 的第一列是：\n$$\n\\begin{pmatrix} -1 \\\\ -1 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n\n对于反应 $R_2$，代谢物 $C$ 被消耗（底物，系数为 $-1$），代谢物 $D$ 被生成（产物，系数为 $+1$）。代谢物 $A$ 和 $B$ 不参与反应（系数为 $0$）。$S$ 的第二列是：\n$$\n\\begin{pmatrix} 0 \\\\ 0 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\n\n对于反应 $R_3$，代谢物 $D$ 被消耗（底物，系数为 $-1$），代谢物 $A$ 被生成（产物，系数为 $+1$）。代谢物 $B$ 和 $C$ 不参与反应（系数为 $0$）。$S$ 的第三列是：\n$$\n\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n\n按指定顺序组合这些列，得到化学计量矩阵 $S$：\n$$\nS = \\begin{pmatrix}\n-1  0  1 \\\\\n-1  0  0 \\\\\n1  -1  0 \\\\\n0  1  -1\n\\end{pmatrix}\n$$\n\n接下来，我们必须确定 $S$ 的零空间的维度。$S$ 的零空间是所有满足稳态质量平衡约束 $S\\,v=0$ 的反应通量向量 $v = \\begin{pmatrix} v_1  v_2  v_3 \\end{pmatrix}^T$ 的集合。该向量空间的维度对应于系统稳态通量的自由度数。\n\n方程 $S\\,v=0$ 可以写成一个线性齐次方程组：\n$$\n\\begin{pmatrix}\n-1  0  1 \\\\\n-1  0  0 \\\\\n1  -1  0 \\\\\n0  1  -1\n\\end{pmatrix}\n\\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix}\n= \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这对应于以下四个方程，分别代表在稳态下每种代谢物（$A, B, C, D$）浓度的净变化：\n1.  $-v_1 + v_3 = 0$\n2.  $-v_1 = 0$\n3.  $v_1 - v_2 = 0$\n4.  $v_2 - v_3 = 0$\n\n我们求解这个关于 $v_1$、$v_2$ 和 $v_3$ 的方程组。\n从方程（2）中，我们立即得出 $v_1 = 0$。\n将 $v_1=0$ 代入方程（1），我们得到 $-0 + v_3 = 0$，这意味着 $v_3 = 0$。\n将 $v_1=0$ 代入方程（3），我们得到 $0 - v_2 = 0$，这意味着 $v_2 = 0$。\n最后，将 $v_2=0$ 和 $v_3=0$ 代入方程（4）得到 $0 - 0 = 0$，这与其他结果一致。\n\n该方程组的唯一解是 $v_1=0$、$v_2=0$ 和 $v_3=0$。这意味着通量向量必须是零向量，$v = \\begin{pmatrix} 0  0  0 \\end{pmatrix}^T$。\n因此，$S$ 的零空间只包含一个元素：零向量。一个只包含零向量的向量空间，其维度定义为 $0$。\n\n或者，我们可以使用秩-零度定理，该定理指出对于一个有 $n$ 列的矩阵 $S$，$\\text{rank}(S) + \\text{dim}(\\text{null}(S)) = n$。在这里，$n=3$（反应的数量）。为了求 $S$ 的秩，我们可以检查其列向量的线性无关性。如果方程 $k_1 c_1 + k_2 c_2 + k_3 c_3 = 0$ 的唯一解是 $k_1=k_2=k_3=0$，则列向量是线性无关的。这正是我们求解通量 $v_i$ 时所解的方程组，并且我们发现唯一解是平凡解。因此，列向量是线性无关的，$S$ 的秩等于列数，即 $3$。\n应用秩-零度定理：\n$$\n\\text{dim}(\\text{null}(S)) = n - \\text{rank}(S) = 3 - 3 = 0\n$$\n两种方法得出了相同的结果。其物理解释是，该网络消耗代谢物 $B$，但没有生成它的反应。由于没有交换反应从外部来源供应 $B$，除非其消耗速率为零，否则其浓度无法维持在稳态。唯一消耗 $B$ 的反应是 $R_1$，因此其通量 $v_1$ 必须为 $0$。这迫使其他通量 $v_2$ 和 $v_3$ 也必须为 $0$，以维持其他代谢物的平衡。因此，唯一可能的稳态是没有任何代谢活动的状态。\n零空间的维度是 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在数学模型建立之后，FBA的真正威力在于通过优化来预测代谢行为。这个问题模拟了一个常见的生物工程场景：在满足细胞基本生长需求的同时，最大化某种高价值化合物的产量。你将应用线性规划的原理来处理代谢中的权衡问题，特别是在细胞生长和目标产物合成之间的资源分配。这个练习展示了如何将FBA用作代谢工程的预测工具。",
            "id": "1434421",
            "problem": "一个生物工程团队正在优化一种转基因微生物，以生产一种高价值化合物——Producene (P)。该微生物从环境中消耗单一底物——SubstrateAlpha (S)。简化的相关代谢网络在稳态下运行，并由以下不可逆反应组成，其中 A、B 和 C 是代谢中间产物：\n\n1.  **吸收反应 ($v_{uptake}$):** `S_external -> S`\n2.  **转化 1 ($v_1$):** `S -> A`\n3.  **分支 1 ($v_2$):** `A -> B` (通往 Producene 的途径)\n4.  **分支 2 ($v_3$):** `A -> C` (用于细胞组分的途径)\n5.  **产物生成 ($v_4$):** `B -> P`\n6.  **生物质合成 ($v_{biomass}$):** `1B + 4C -> Biomass`\n7.  **产物输出 ($v_{export}$):** `P -> P_external`\n\nSubstrateAlpha 的吸收速率由外部控制，并固定为 $v_{uptake} = 20$ mmol/gDW/hr。为使微生物保持活力并生长，生物质合成速率必须维持在最低水平，即 $v_{biomass} \\geq 2$ mmol/gDW/hr。\n\n您的任务是计算 Producene 的最大理论产率。产率定义为 Producene 输出速率 ($v_{export}$) 与 SubstrateAlpha 吸收速率 ($v_{uptake}$) 的无量纲比值。请将您的答案表示为最简分数形式。",
            "solution": "在稳态下，内部代谢物满足质量平衡，所有通量都是不可逆且非负的。将通量表示为：$v_{uptake}$、$v_{1}$、$v_{2}$、$v_{3}$、$v_{4}$、$v_{biomass}$ 和 $v_{export}$。吸收速率固定为 $v_{uptake}=20$，生物质约束为 $v_{biomass}\\geq 2$。\n\n写出每个内部代谢物的稳态平衡方程：\n\n对于 $S$：\n$$\nv_{uptake}-v_{1}=0 \\quad \\Rightarrow \\quad v_{1}=v_{uptake}.\n$$\n\n对于 $A$：\n$$\nv_{1}-v_{2}-v_{3}=0 \\quad \\Rightarrow \\quad v_{2}+v_{3}=v_{1}=v_{uptake}.\n$$\n\n对于 $C$ (使用化学计量关系 $1B+4C\\to$ Biomass):\n$$\nv_{3}-4v_{biomass}=0 \\quad \\Rightarrow \\quad v_{3}=4v_{biomass}.\n$$\n\n对于 $B$：\n$$\nv_{2}-v_{4}-v_{biomass}=0 \\quad \\Rightarrow \\quad v_{4}=v_{2}-v_{biomass}.\n$$\n\n对于 $P$：\n$$\nv_{4}-v_{export}=0 \\quad \\Rightarrow \\quad v_{export}=v_{4}.\n$$\n\n结合这些关系，用 $v_{uptake}$ 和 $v_{biomass}$ 来表示 $v_{export}$。由 $v_{2}+v_{3}=v_{uptake}$ 和 $v_{3}=4v_{biomass}$，得到\n$$\nv_{2}=v_{uptake}-v_{3}=v_{uptake}-4v_{biomass}.\n$$\n然后由 $v_{4}=v_{2}-v_{biomass}$，\n$$\nv_{4}=v_{uptake}-4v_{biomass}-v_{biomass}=v_{uptake}-5v_{biomass}.\n$$\n使用 $v_{export}=v_{4}$，\n$$\nv_{export}=v_{uptake}-5v_{biomass}.\n$$\n\n不可逆性要求 $v_{2}\\geq 0$ 和 $v_{4}\\geq 0$，这意味着 $v_{uptake}-4v_{biomass}\\geq 0$ 和 $v_{uptake}-5v_{biomass}\\geq 0$，即分别为 $v_{biomass}\\leq \\frac{v_{uptake}}{4}$ 和 $v_{biomass}\\leq \\frac{v_{uptake}}{5}$。当 $v_{uptake}=20$ 时，这些条件给出 $v_{biomass}\\leq 5$ 和 $v_{biomass}\\leq 4$，因此更严格的约束是 $v_{biomass}\\leq 4$。结合活力约束 $v_{biomass}\\geq 2$，可行范围是 $2\\leq v_{biomass}\\leq 4$。\n\n目标是最大化产率\n$$\nY=\\frac{v_{export}}{v_{uptake}}=\\frac{v_{uptake}-5v_{biomass}}{v_{uptake}}=1-\\frac{5v_{biomass}}{v_{uptake}}.\n$$\n对于固定的 $v_{uptake}=20$，$Y$ 的最大值通过在可行范围内最小化 $v_{biomass}$ 来实现，即当 $v_{biomass}=2$ 时。代入可得\n$$\nY=1-\\frac{5\\cdot 2}{20}=1-\\frac{10}{20}=1-\\frac{1}{2}=\\frac{1}{2}.\n$$\n因此，Producene 的最大理论产率为 $\\frac{1}{2}$。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "标准FBA可能会产生多种同等最优的通量分布，但并非所有分布都具有生物学上的高效性。本练习介绍简约通量平衡分析（pFBA），这是一种高级技术，它通过增加第二个优化目标——最小化总代谢投入——来精炼解空间。通过首先最大化生长，然后最小化总通量，pFBA能够提供一个单一、更符合生理现实的解。这个问题将指导你完成这种强大的两步优化方法的构建与应用。",
            "id": "4342817",
            "problem": "考虑一个处于稳态的代谢网络，由化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$ 和通量向量 $v \\in \\mathbb{R}^{n}$ 描述，其通量边界为 $l \\leq v \\leq u$。稳态假设施加了质量平衡约束 $S v = 0$。设细胞生长速率由线性目标 $c^{\\top} v$ 建模，其中 $c \\in \\mathbb{R}^{n}$ 选择生物质反应（$v$ 的一个分量）。简约通量平衡分析 (Parsimonious Flux Balance Analysis, pFBA) 是一种字典序优化，它首先最大化生长，然后最小化总通量大小。从基本的稳态和线性化学计量约束出发，并且不使用任何快捷公式，完成以下任务：\n\n1. 将 pFBA 构建为一个双层优化问题，该问题首先最大化生长 $c^{\\top} v$，然后在所有最优生长解中，最小化总通量 $\\sum_{i=1}^{n} |v_i|$。\n2. 通过引入适当的辅助变量，提出了一个等效的单层线性规划，使得绝对值目标被线性目标替换，同时保持在第一层中达到的生长最优值 $c^{\\top} v = z^{\\star}$。以符号形式提供最终的单层线性规划。\n3. 现在考虑以下具体网络，包含内部代谢物 $A$、$B$ 和 $C$，以及反应 $R_1$ 到 $R_6$：\n\n- $R_1$: $A_{\\mathrm{ext}} \\rightarrow A$，通量为 $v_1$，边界为 $0 \\leq v_1 \\leq 10$，\n- $R_2$: $A \\rightarrow B$，通量为 $v_2$，边界为 $0 \\leq v_2 \\leq 1000$，\n- $R_3$: $A \\rightarrow C$，通量为 $v_3$，边界为 $0 \\leq v_3 \\leq 1000$，\n- $R_4$: $B + C \\rightarrow \\mathrm{Biomass}$，通量为 $v_4$，边界为 $0 \\leq v_4 \\leq 1000$，\n- $R_5$: $C \\rightarrow C_{\\mathrm{ext}}$，通量为 $v_5$，边界为 $0 \\leq v_5 \\leq 1000$，\n- $R_6$: $B \\rightarrow A$，通量为 $v_6$，边界为 $0 \\leq v_6 \\leq 1000$。\n\n假设 $A$、$B$ 和 $C$ 的内部稳态质量平衡为：\n$$\n\\begin{aligned}\nA: \\quad v_1 - v_2 - v_3 + v_6 = 0, \\\\\nB: \\quad v_2 - v_4 - v_6 = 0, \\\\\nC: \\quad v_3 - v_4 - v_5 = 0.\n\\end{aligned}\n$$\n设生长（生物质）目标为 $c^{\\top} v = v_4$。在上述 pFBA 框架下，计算在所有最大化 $v_4$ 的通量向量 $v$ 中可实现的最小可能总通量 $\\sum_{i=1}^{6} |v_i|$。用 $\\mathrm{mmol\\,gDW^{-1}\\,h^{-1}}$ 单位表示您的最终数值答案。提供精确值，不要四舍五入。",
            "solution": "### 第 1 部分：pFBA 的双层优化构建\n\n简约通量平衡分析 (pFBA) 是一个字典序优化问题。这意味着它解决一系列优化问题，其中一个问题的最优值成为下一个问题的约束。\n\n首先，我们定义通量向量的可行空间 $\\mathcal{F}$，它包含所有满足稳态和边界约束的通量：\n$$\n\\mathcal{F} = \\{v \\in \\mathbb{R}^n \\mid Sv = 0, l \\le v \\le u\\}\n$$\n优化的第一层是一个标准的 FBA 问题，它最大化细胞生长目标 $c^{\\top}v$。我们将最优生长速率定义为 $z^{\\star}$：\n$$\nz^{\\star} = \\max_{v \\in \\mathcal{F}} c^{\\top}v\n$$\n优化的第二层旨在在所有达到此最大生长速率 $z^{\\star}$ 的通量分布中，找到一个最小化总通量大小的分布，即所有通量绝对值的总和。达到最大生长的通量向量集合是：\n$$\n\\mathcal{F}^{\\star} = \\{v \\in \\mathcal{F} \\mid c^{\\top}v = z^{\\star} \\}\n$$\n双层 pFBA 问题可以正式表述为找到一个向量 $v_{pFBA}$，使其成为以下最小化问题的解：\n$$\n\\min_{v \\in \\mathcal{F}^{\\star}} \\sum_{i=1}^{n} |v_i|\n$$\n这可以紧凑地写成一个字典序优化：\n$$\n\\text{lex max}_{v} \\begin{pmatrix} c^{\\top}v \\\\ -\\sum_{i=1}^{n} |v_i| \\end{pmatrix} \\quad \\text{subject to } v \\in \\mathcal{F}\n$$\n\n### 第 2 部分：等效的单层线性规划\n\n双层优化是按顺序求解的。在从第一个 LP 中找到最大生长速率 $z^{\\star}$ 后，构建第二个问题。第二个问题的目标函数 $\\sum_{i=1}^{n} |v_i|$ 是非线性的。为了将其转换为线性规划，我们引入辅助变量。\n\n对于每个通量 $v_i$，我们可以将其表示为两个非负变量 $v_i^{+}$ 和 $v_i^{-}$ 的差：\n$v_i = v_i^{+} - v_i^{-}$，其中 $v_i^{+} \\ge 0, v_i^{-} \\ge 0$\n绝对值 $|v_i|$ 随后可以表示为这些变量的和，即 $|v_i| = v_i^{+} + v_i^{-}$。这种表示在最小化问题的背景下是有效的，因为优化会内在地将两个变量之一（$v_i^{+}$ 或 $v_i^{-}$）驱动为零，以最小化它们的和。\n\n假设 $z^{\\star}$ 已确定，pFBA 第二步（最小化总通量）的单层线性规划构建如下：\n\n**最小化：**\n$$\n\\sum_{i=1}^{n} (v_i^{+} + v_i^{-})\n$$\n**约束条件：**\n1. 稳态质量平衡： $S(v^{+} - v^{-}) = 0$\n2. 最大生长约束： $c^{\\top}(v^{+} - v^{-}) = z^{\\star}$\n3. 通量边界： $l \\le v^{+} - v^{-} \\le u$\n4. 辅助变量的非负性： $v_i^{+} \\ge 0$ 和 $v_i^{-} \\ge 0$ 对于所有 $i=1, \\dots, n$\n\n这里，$v^{+}$ 和 $v^{-}$ 分别是包含 $v_i^{+}$ 和 $v_i^{-}$ 变量的向量。这个构建是一个标准的线性规划。\n\n### 第 3 部分：具体网络的 pFBA\n\n我们将两步 pFBA 程序应用于给定的代谢网络。\n\n**步骤 1：最大化生长 ($v_4$)**\n\n问题是在稳态方程和通量边界的约束下最大化 $v_4$。\n稳态方程为：\n1. $v_1 - v_2 - v_3 + v_6 = 0$\n2. $v_2 - v_4 - v_6 = 0 \\implies v_2 = v_4 + v_6$\n3. $v_3 - v_4 - v_5 = 0 \\implies v_3 = v_4 + v_5$\n\n将 $v_2$ 和 $v_3$ 的表达式代入第一个方程：\n$v_1 - (v_4 + v_6) - (v_4 + v_5) + v_6 = 0$\n$v_1 - v_4 - v_6 - v_4 - v_5 + v_6 = 0$\n$v_1 - 2v_4 - v_5 = 0 \\implies v_1 = 2v_4 + v_5$\n\n所有通量 $v_i$ 都被约束为非负。右侧的变量（$v_4, v_5, v_6$）是独立的，受通量边界的约束。$v_1, v_2, v_3$ 的约束也必须满足。\n关键的边界是 $0 \\le v_1 \\le 10$。代入 $v_1$ 的表达式：\n$0 \\le 2v_4 + v_5 \\le 10$\n\n我们希望最大化 $v_4$。由于 $v_4 \\ge 0$ 和 $v_5 \\ge 0$，项 $2v_4 + v_5$ 总是非负的，因此下界 $0 \\le 2v_4 + v_5$ 得到满足。为了在约束 $2v_4 + v_5 \\le 10$ 下最大化 $v_4$，我们必须使 $v_5$ 尽可能小。$v_5$ 的下界是 $0$。\n设 $v_5 = 0$，约束变为 $2v_4 \\le 10$，这意味着 $v_4 \\le 5$。\n因此，最大可能的生长速率是 $z^{\\star} = v_{4, \\text{max}} = 5$。\n\n我们来验证一下对于 $v_4=5$ 是否存在一个有效的通量分布。\n如果 $v_4 = 5$ 且 $v_5 = 0$：\n- $v_1 = 2(5) + 0 = 10$。这满足了 $0 \\le v_1 \\le 10$。\n- $v_3 = v_4 + v_5 = 5 + 0 = 5$。这满足了 $0 \\le v_3 \\le 1000$。\n- $v_2 = v_4 + v_6 = 5 + v_6$。$v_2$ 的边界是 $0 \\le v_2 \\le 1000$。由于 $v_6 \\ge 0$，$v_2 \\ge 5$，满足下界。上界要求 $5 + v_6 \\le 1000$，所以 $v_6 \\le 995$。\n- $v_6$ 的边界是 $0 \\le v_6 \\le 1000$。因此，$v_6$ 的组合约束是 $0 \\le v_6 \\le 995$。\n\n任何具有 $v_4=5$，$v_5=0$ 和 $v_6 \\in [0, 995]$ 的通量向量都将实现最大生长。\n\n**步骤 2：最小化总通量大小**\n\n现在我们在 $v_4 = 5$ 的约束下最小化总通量和 $\\sum_{i=1}^{6} |v_i|$。由于所有通量 $v_i$ 都被约束为非负，所以 $|v_i| = v_i$。目标是最小化 $\\sum_{i=1}^{6} v_i$。\n对应于最大生长的通量可以用自由参数 $v_6$ 表示：\n- $v_1 = 10$\n- $v_2 = 5 + v_6$\n- $v_3 = 5$\n- $v_4 = 5$\n- $v_5 = 0$\n- $v_6$ 是变量，且 $v_6 \\in [0, 995]$。\n\n总通量和 $J$ 为：\n$J = v_1 + v_2 + v_3 + v_4 + v_5 + v_6$\n$J = 10 + (5 + v_6) + 5 + 5 + 0 + v_6$\n$J = 25 + 2v_6$\n\n为了最小化 $J$，我们必须从其允许范围 $[0, 995]$ 中为 $v_6$ 选择尽可能小的值。最小值为 $v_6 = 0$。\n当 $v_6 = 0$ 时，最小总通量为 $J_{min} = 25 + 2(0) = 25$。\n\n唯一的 pFBA 通量向量是：\n- $v_1 = 10$\n- $v_2 = 5 + 0 = 5$\n- $v_3 = 5$\n- $v_4 = 5$\n- $v_5 = 0$\n- $v_6 = 0$\n\n这些通量的总和是 $10 + 5 + 5 + 5 + 0 + 0 = 25$。该值的单位为 $\\mathrm{mmol\\,gDW^{-1}\\,h^{-1}}$。",
            "answer": "$$\\boxed{25}$$"
        }
    ]
}