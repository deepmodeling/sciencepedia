{
    "hands_on_practices": [
        {
            "introduction": "在RNA测序分析中，直接使用原始的读段计数（raw counts）来比较基因表达水平是不可靠的，因为它们受到测序深度和基因长度的严重影响。这个练习将指导你亲手计算几种关键的归一化指标，包括 RPKM、FPKM 和 TPM，从而深刻理解为何以及如何通过校正这些偏差来获得更准确的基因表达量估算 。通过本练习，你将能够辨别不同归一化策略的细微差别及其对数据解读的影响。",
            "id": "4351520",
            "problem": "一项系统生物医学领域的队列研究使用高通量测序技术，从两个生物样本中生成了信使核糖核酸 (mRNA) 表达谱。为了进行基因表达的下游分析，核心处理流程包括质量控制、与参考基因组的比对以及对比对上的读数进行定量。考虑四个蛋白质编码基因，记为 $G_1$、$G_2$、$G_3$ 和 $G_4$，其基因组长度分别为 $L_{1} = 2000$ 碱基对、$L_{2} = 10000$ 碱基对、$L_{3} = 500$ 碱基对和 $L_{4} = 3000$ 碱基对。样本 $1$ 进行单端测序，总共得到 $N_1 = 3.0 \\times 10^{7}$ 条比对上的读数，产生的原始基因水平读数计数为 $c_{1}^{(1)} = 600$、$c_{2}^{(1)} = 900$、$c_{3}^{(1)} = 450$ 和 $c_{4}^{(1)} = 300$。样本 $2$ 进行双端测序，总共得到 $N_2 = 1.5 \\times 10^{7}$ 个比对上的片段，产生的原始基因水平片段计数为 $c_{1}^{(2)} = 800$、$c_{2}^{(2)} = 300$、$c_{3}^{(2)} = 400$ 和 $c_{4}^{(2)} = 500$。\n\n从转录本定量中长度归一化和文库大小缩放的基本定义出发，执行以下操作：\n\n- 计算样本 $1$ 中每个基因的每千碱基每百万比对读数 (RPKM) 和每百万转录本 (TPM)。\n- 计算样本 $2$ 中每个基因的每千碱基每百万比对片段 (FPKM) 和每百万转录本 (TPM)。\n- 对每个样本，分别确定按原始计数排列的基因顺序是否与按 TPM 排列的顺序不同，并使用第一性原理推断简要论证结果。\n\n最后，将同一项目集上两个全序之间的 Kendall tau 距离定义为这两个排序之间的逆序对数量。使用此定义，计算样本 $1$ 的原始计数排序与 TPM 排序之间的 Kendall tau 距离。仅报告此 Kendall tau 距离作为您的最终数值答案。无需四舍五入，最终答案不应提供单位。",
            "solution": "该问题被评估为有效的，因为它基于转录组学数据分析的标准原则，具有科学依据，提法恰当且提供了所有必要信息，并且其表述是客观的。\n\n此问题的核心涉及应用 RNA 测序 (RNA-seq) 数据分析中用于比较基因表达水平的标准归一化技术。两个主要的归一化指标是每千碱基每百万读数/片段 (RPKM/FPKM) 和每百万转录本 (TPM)。\n\n对于一个基因 $i$，基本定义如下：\n设 $c_i$ 为比对到基因 $i$ 的原始读数（对于单端测序）或片段（对于双端测序）的计数。\n设 $L_i$ 为对应于基因 $i$ 的转录本长度，单位为碱基对 (bp)。我们通过 $L_i^{\\text{kb}} = L_i / 1000$ 将其转换为千碱基 (kb)。\n设 $N$ 为测序文库中比对上的读数或片段的总数。我们通过 $N^{\\text{millions}} = N / 10^6$ 将其转换为百万单位。\n\nRPKM（对于单端测序）或 FPKM（对于双端测序）定义为：\n$$ \\text{RPKM}_i \\text{ or } \\text{FPKM}_i = \\frac{c_i}{L_i^{\\text{kb}} \\cdot N^{\\text{millions}}} = \\frac{10^9 \\cdot c_i}{L_i \\cdot N} $$\n该公式首先按总文库大小（测序深度）对原始计数进行归一化，然后再按基因长度进行归一化。\n\nTPM 的定义采用了不同的操作顺序。首先，对原始计数进行基因长度归一化，以获得转录本丰度率的度量。然后，将这些率除以所有率的总和，以校正文库大小。\n1.  计算率（每千碱基的读数）：$R_i = \\frac{c_i}{L_i^{\\text{kb}}} = \\frac{1000 \\cdot c_i}{L_i}$\n2.  所有率的总和：$T = \\sum_j R_j$\n3.  TPM 计算：$\\text{TPM}_i = \\left(\\frac{R_i}{T}\\right) \\cdot 10^6$\n\n有了这些定义，我们可以对每个样本进行计算。\n\n**样本 1 分析**\n样本 $1$ 的已知数据：\n- 比对上的读数总数：$N_1 = 3.0 \\times 10^7$，所以 $N_1^{\\text{millions}} = 30$。\n- 基因长度：$L_1 = 2000$ bp ($2$ kb)，$L_2 = 10000$ bp ($10$ kb)，$L_3 = 500$ bp ($0.5$ kb)，$L_4 = 3000$ bp ($3$ kb)。\n- 原始计数：$c_{1}^{(1)} = 600$，$c_{2}^{(1)} = 900$，$c_{3}^{(1)} = 450$，$c_{4}^{(1)} = 300$。\n\n**样本 1 的 RPKM 计算：**\n- $G_1$: $\\text{RPKM}_1^{(1)} = \\frac{600}{2 \\cdot 30} = 10$\n- $G_2$: $\\text{RPKM}_2^{(1)} = \\frac{900}{10 \\cdot 30} = 3$\n- $G_3$: $\\text{RPKM}_3^{(1)} = \\frac{450}{0.5 \\cdot 30} = \\frac{450}{15} = 30$\n- $G_4$: $\\text{RPKM}_4^{(1)} = \\frac{300}{3 \\cdot 30} = \\frac{300}{90} = \\frac{10}{3}$\n\n**样本 1 的 TPM 计算：**\n首先，我们计算率 $R_i^{(1)} = c_i^{(1)}/L_i^{\\text{kb}}$：\n- $R_1^{(1)} = \\frac{600}{2} = 300$\n- $R_2^{(1)} = \\frac{900}{10} = 90$\n- $R_3^{(1)} = \\frac{450}{0.5} = 900$\n- $R_4^{(1)} = \\frac{300}{3} = 100$\n率的总和为 $T^{(1)} = 300 + 90 + 900 + 100 = 1390$。\n现在，我们计算 TPM 值：\n- $G_1$: $\\text{TPM}_1^{(1)} = \\left(\\frac{300}{1390}\\right) \\cdot 10^6 \\approx 215827$\n- $G_2$: $\\text{TPM}_2^{(1)} = \\left(\\frac{90}{1390}\\right) \\cdot 10^6 \\approx 64748$\n- $G_3$: $\\text{TPM}_3^{(1)} = \\left(\\frac{900}{1390}\\right) \\cdot 10^6 \\approx 647482$\n- $G_4$: $\\text{TPM}_4^{(1)} = \\left(\\frac{100}{1390}\\right) \\cdot 10^6 \\approx 71942$\n\n**样本 2 分析**\n样本 $2$ 的已知数据：\n- 比对上的片段总数：$N_2 = 1.5 \\times 10^7$，所以 $N_2^{\\text{millions}} = 15$。\n- 基因长度与样本 $1$ 相同。\n- 原始计数：$c_{1}^{(2)} = 800$，$c_{2}^{(2)} = 300$，$c_{3}^{(2)} = 400$，$c_{4}^{(2)} = 500$。\n\n**样本 2 的 FPKM 计算：**\n- $G_1$: $\\text{FPKM}_1^{(2)} = \\frac{800}{2 \\cdot 15} = \\frac{800}{30} = \\frac{80}{3}$\n- $G_2$: $\\text{FPKM}_2^{(2)} = \\frac{300}{10 \\cdot 15} = \\frac{300}{150} = 2$\n- $G_3$: $\\text{FPKM}_3^{(2)} = \\frac{400}{0.5 \\cdot 15} = \\frac{400}{7.5} = \\frac{160}{3}$\n- $G_4$: $\\text{FPKM}_4^{(2)} = \\frac{500}{3 \\cdot 15} = \\frac{500}{45} = \\frac{100}{9}$\n\n**样本 2 的 TPM 计算：**\n首先，我们计算率 $R_i^{(2)} = c_i^{(2)}/L_i^{\\text{kb}}$：\n- $R_1^{(2)} = \\frac{800}{2} = 400$\n- $R_2^{(2)} = \\frac{300}{10} = 30$\n- $R_3^{(2)} = \\frac{400}{0.5} = 800$\n- $R_4^{(2)} = \\frac{500}{3}$\n率的总和为 $T^{(2)} = 400 + 30 + 800 + \\frac{500}{3} = 1230 + \\frac{500}{3} = \\frac{3690 + 500}{3} = \\frac{4190}{3}$。\n现在，我们计算 TPM 值：\n- $G_1$: $\\text{TPM}_1^{(2)} = \\left(\\frac{400}{4190/3}\\right) \\cdot 10^6 = \\frac{1200}{4190} \\cdot 10^6 \\approx 286396$\n- $G_2$: $\\text{TPM}_2^{(2)} = \\left(\\frac{30}{4190/3}\\right) \\cdot 10^6 = \\frac{90}{4190} \\cdot 10^6 \\approx 21480$\n- $G_3$: $\\text{TPM}_3^{(2)} = \\left(\\frac{800}{4190/3}\\right) \\cdot 10^6 = \\frac{2400}{4190} \\cdot 10^6 \\approx 572792$\n- $G_4$: $\\text{TPM}_4^{(2)} = \\left(\\frac{500/3}{4190/3}\\right) \\cdot 10^6 = \\frac{500}{4190} \\cdot 10^6 \\approx 119332$\n\n**排序比较**\n\n对于样本 1：\n- 原始计数排序：$c_2^{(1)}(900) > c_1^{(1)}(600) > c_3^{(1)}(450) > c_4^{(1)}(300) \\implies G_2 > G_1 > G_3 > G_4$。\n- TPM 排序（与率 $R_i^{(1)}$ 成正比）：$R_3^{(1)}(900) > R_1^{(1)}(300) > R_4^{(1)}(100) > R_2^{(1)}(90) \\implies G_3 > G_1 > G_4 > G_2$。\n样本内按原始计数排列的顺序与按 TPM 排列的顺序不同。\n\n对于样本 2：\n- 原始计数排序：$c_1^{(2)}(800) > c_4^{(2)}(500) > c_3^{(2)}(400) > c_2^{(2)}(300) \\implies G_1 > G_4 > G_3 > G_2$。\n- TPM 排序（与率 $R_i^{(2)}$ 成正比）：$R_3^{(2)}(800) > R_1^{(2)}(400) > R_4^{(2)}(500/3) > R_2^{(2)}(30) \\implies G_3 > G_1 > G_4 > G_2$。\n样本内按原始计数排列的顺序也与按 TPM 排列的顺序不同。\n\n**基于第一性原理的论证：**\n从机制上讲，一个基因的原始读数计数是其真实转录本丰度（摩尔浓度）和其长度的乘积。更长的基因为随机片段化和测序提供了更大的靶标，因此即使表达水平相同，也会比更短的基因累积更多的读数。这种长度偏差混淆了将原始计数作为表达直接度量的解释。\nTPM 计算纠正了这一点。第一步，$R_i = c_i / L_i^{\\text{kb}}$，明确地除去了基因长度，得出一个与实际转录本丰度成正比的率。随后的按总率缩放对文库大小进行了归一化。由于这个最终的缩放因子对于样本内的所有基因都是相同的，它不会改变由初始长度归一化步骤建立的样本内排序。因此，原始计数排序与 TPM 排序之间的差异根本上是由于对基因长度偏差的校正。例如，在样本 1 中，基因 $G_2$ 最长（$10000$ bp）且原始计数最高，但在长度归一化后，其相对表达量最低。相反，基因 $G_3$ 最短（$500$ bp），其不高的原始计数在长度归一化后转化为最高的相对表达量。\n\n**样本 1 的 Kendall Tau 距离**\n两个排序之间的 Kendall tau 距离是这两个排序中相对顺序不同的项目对的数量。项目集为 {$G_1, G_2, G_3, G_4$}。\n- 排序 1（来自原始计数）：$\\pi_1 = (G_2, G_1, G_3, G_4)$\n- 排序 2（来自 TPM）：$\\pi_2 = (G_3, G_1, G_4, G_2)$\n\n我们检查所有 $\\binom{4}{2} = 6$ 对基因：\n1.  对 $(G_1, G_2)$：在 $\\pi_1$ 中，$G_2 > G_1$。在 $\\pi_2$ 中，$G_1 > G_2$。不一致。\n2.  对 $(G_1, G_3)$：在 $\\pi_1$ 中，$G_1 > G_3$。在 $\\pi_2$ 中，$G_3 > G_1$。不一致。\n3.  对 $(G_1, G_4)$：在 $\\pi_1$ 中，$G_1 > G_4$。在 $\\pi_2$ 中，$G_1 > G_4$。一致。\n4.  对 $(G_2, G_3)$：在 $\\pi_1$ 中，$G_2 > G_3$。在 $\\pi_2$ 中，$G_3 > G_2$。不一致。\n5.  对 $(G_2, G_4)$：在 $\\pi_1$ 中，$G_2 > G_4$。在 $\\pi_2$ 中，$G_4 > G_2$。不一致。\n6.  对 $(G_3, G_4)$：在 $\\pi_1$ 中，$G_3 > G_4$。在 $\\pi_2$ 中，$G_3 > G_4$。一致。\n\n有 $4$ 对不一致的配对。因此，样本 $1$ 的原始计数排序与 TPM 排序之间的 Kendall tau 距离为 $4$。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "在真实的基因组中，基因之间常常存在外显子重叠的区域，这会导致一部分测序读段（reads）能够同时比对到多个基因上，产生所谓的“多重比对读段”（multi-mapping reads）。如何处理这些模糊的信号是转录本定量中的一个关键决策点，不同的处理策略可能会产生截然不同的表达量估计。本练习将引导你探索两种经典的多重比对处理策略，并通过计算它们对TPM值的影响来量化这种差异，让你亲身体会定量算法选择的重要性 。",
            "id": "4351466",
            "problem": "一项单端核糖核酸测序 (RNA-Seq) 实验对一个基因组位点进行分析，该位点上两个分别表示为 $A$ 和 $B$ 的基因，其部分外显子序列存在重叠。该位点是样本中唯一表达的区域。基因 $A$ 的总外显子长度为 $L_A = 1200$ 个碱基对，基因 $B$ 的总外显子长度为 $L_B = 900$ 个碱基对。其中，一个长度为 $300$ 个碱基对的重叠片段在 $A$ 和 $B$ 之间完全相同，而其余的外显子序列则为各自基因所特有。一个短读长比对器报告了来自该位点测序读长的三类比对结果：\n- $180$ 个比对唯一地映射到基因 $A$ 的特有外显子区域。\n- $120$ 个比对唯一地映射到基因 $B$ 的特有外显子区域。\n- $200$ 个比对以同等可能性映射到相同的重叠片段，并被报告为与 $A$ 和 $B$ 均兼容的多重比对读数。\n\n假设该位点的所有 $500$ 个比对均源自此样本的表达转录组，并且该位点之外没有表达。定量遵循标准的长度归一化原则：通过除以基因的外显子长度（以千碱基为单位）将分配的读数计数转换为每千碱基读数，然后缩放这些值，使得样本中所有基因的转录本丰度值总和为 $10^6$，从而得到每百万转录本数 (TPM)。\n\n考虑两种针对多重比对读数的消歧策略：\n- 策略 $\\mathrm{U}$ (仅唯一比对)：丢棄多重比对读数，只计算唯一映射到单个基因的读数。\n- 策略 $\\mathrm{F}$ (分数式分配)：将每个多重比对读数按分数平均分配给所有兼容的基因。\n\n基于上述核心定义，计算在每种策略下基因 $A$ 和 $B$ 的 TPM 值，然后计算所得的两个 TPM 向量之间的欧几里得距离。也就是说，如果 $\\mathbf{t}^{(\\mathrm{U})}$ 和 $\\mathbf{t}^{(\\mathrm{F})}$ 分别表示在策略 $\\mathrm{U}$ 和 $\\mathrm{F}$ 下基因 $\\{A,B\\}$ 的二维 TPM 向量，请计算 $\\mathbf{t}^{(\\mathrm{F})} - \\mathbf{t}^{(\\mathrm{U})}$ 的欧几里得范数。\n\n将最终距离四舍五入至四位有效数字。以 TPM 单位表示最终距离。",
            "solution": "首先将对问题的科学合理性、自洽性和客观性进行验证。验证成功后，将推导出完整的解决方案。\n\n### 步骤 1：提取已知条件\n-   基因 $A$ 总外显子长度：$L_A = 1200$ 碱基对。\n-   基因 $B$ 总外显子长度：$L_B = 900$ 碱基对。\n-   重叠且相同的片段长度：$300$ 碱基对。\n-   基因 $A$ 特有的比对数：$N_{A,u} = 180$。\n-   基因 $B$ 特有的比对数：$N_{B,u} = 120$。\n-   与 $A$ 和 $B$ 均兼容的多重比对数：$N_{AB,m} = 200$。\n-   定量方法：每百万转录本数 (TPM)。\n    -   步骤 1：通过将分配的读数计数除以基因的外显子长度（单位：千碱基）来计算每千碱基读数 (RPK)。\n    -   步骤 2：缩放 RPK 值，使其总和为 $10^6$。\n-   消歧策略 $\\mathrm{U}$ (仅唯一比对)：丢弃多重比对读数。\n-   消歧策略 $\\mathrm{F}$ (分数式分配)：将每个多重比对读数平均分配给所有兼容的基因。\n-   目标：计算欧几里得距离 $||\\mathbf{t}^{(\\mathrm{F})} - \\mathbf{t}^{(\\mathrm{U})}||$，其中 $\\mathbf{t}$ 表示基因 $\\{A,B\\}$ 的二维 TPM 向量。\n-   四舍五入：最终结果必须四舍五入至四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题陈述具有科学依据且定义明确。所呈现的概念——RNA-Seq、多重比对读数、TPM定量和读数消歧策略——在生物信息学和系统生物医学领域是标准和基础的。所提供的数据是自洽的、数值上一致的，并且足以推导出唯一解。两种策略 $\\mathrm{U}$ 和 $\\mathrm{F}$ 的定义清晰客观。问题不违反任何科学原则，也不包含任何主观或模糊的语言。重叠片段的长度（$300$ bp）是描述性背景信息，但根据 TPM 的标准定义，计算 TPM 并不直接需要它，而是使用总外显子长度。此问题有效。\n\n### 步骤 3：结论与行动\n此问题有效。现在提供解决方案。\n\n问题的核心是计算在两种处理多重比对读数的不同模型下，两个基因 $A$ 和 $B$ 的每百万转录本数 (TPM) 值。基因 $i$ 的 TPM 定义为：\n$$TPM_i = \\left( \\frac{C_i / l_i}{\\sum_j (C_j / l_j)} \\right) \\times 10^6$$\n其中 $C_i$ 是分配给基因 $i$ 的读数数量，$l_i$ 是基因 $i$ 的长度（单位为千碱基）。$C_i/l_i$ 项是每千碱基读数 (RPK)。\n\n基因的长度（单位：千碱基 kb）为：\n$l_A = \\frac{L_A}{1000} = \\frac{1200}{1000} = 1.2$ kb。\n$l_B = \\frac{L_B}{1000} = \\frac{900}{1000} = 0.9$ kb。\n\n我们现在为每种策略计算 TPM 向量。\n\n**策略 U (仅唯一比对)**\n在此策略下，多重比对读数被丢弃。每个基因的计数仅来自唯一映射的读数。\n-   基因 $A$ 的计数：$C_A^{(U)} = N_{A,u} = 180$。\n-   基因 $B$ 的计数：$C_B^{(U)} = N_{B,u} = 120$。\n\n接下来，我们计算 RPK 值：\n-   $RPK_A^{(U)} = \\frac{C_A^{(U)}}{l_A} = \\frac{180}{1.2} = 150$。\n-   $RPK_B^{(U)} = \\frac{C_B^{(U)}}{l_B} = \\frac{120}{0.9} = \\frac{1200}{9} = \\frac{400}{3}$。\n\n所有 RPK 值的总和，即缩放因子，为：\n$S^{(U)} = RPK_A^{(U)} + RPK_B^{(U)} = 150 + \\frac{400}{3} = \\frac{450}{3} + \\frac{400}{3} = \\frac{850}{3}$。\n\n现在我们可以计算 TPM 值：\n-   $TPM_A^{(U)} = \\left( \\frac{RPK_A^{(U)}}{S^{(U)}} \\right) \\times 10^6 = \\left( \\frac{150}{850/3} \\right) \\times 10^6 = \\frac{450}{850} \\times 10^6 = \\frac{9}{17} \\times 10^6$。\n-   $TPM_B^{(U)} = \\left( \\frac{RPK_B^{(U)}}{S^{(U)}} \\right) \\times 10^6 = \\left( \\frac{400/3}{850/3} \\right) \\times 10^6 = \\frac{400}{850} \\times 10^6 = \\frac{8}{17} \\times 10^6$。\n\n策略 U 的 TPM 向量是 $\\mathbf{t}^{(U)} = \\left( \\frac{9}{17} \\times 10^6, \\frac{8}{17} \\times 10^6 \\right)$。\n\n**策略 F (分数式分配)**\n在此策略下，每个多重比对读数被分数式分配给所有兼容的基因。由于 $N_{AB,m} = 200$ 个读数与两个基因（$A$ 和 $B$）兼容，每个基因从每个这样的读数中获得 $1/2$ 的计数。\n-   基因 $A$ 的计数：$C_A^{(F)} = N_{A,u} + \\frac{1}{2}N_{AB,m} = 180 + \\frac{1}{2}(200) = 180 + 100 = 280$。\n-   基因 $B$ 的计数：$C_B^{(F)} = N_{B,u} + \\frac{1}{2}N_{AB,m} = 120 + \\frac{1}{2}(200) = 120 + 100 = 220$。\n\n接下来，我们计算 RPK 值：\n-   $RPK_A^{(F)} = \\frac{C_A^{(F)}}{l_A} = \\frac{280}{1.2} = \\frac{2800}{12} = \\frac{700}{3}$。\n-   $RPK_B^{(F)} = \\frac{C_B^{(F)}}{l_B} = \\frac{220}{0.9} = \\frac{2200}{9}$。\n\nRPK 值的总和为：\n$S^{(F)} = RPK_A^{(F)} + RPK_B^{(F)} = \\frac{700}{3} + \\frac{2200}{9} = \\frac{2100}{9} + \\frac{2200}{9} = \\frac{4300}{9}$。\n\n现在我们计算 TPM 值：\n-   $TPM_A^{(F)} = \\left( \\frac{RPK_A^{(F)}}{S^{(F)}} \\right) \\times 10^6 = \\left( \\frac{700/3}{4300/9} \\right) \\times 10^6 = \\left( \\frac{700}{3} \\cdot \\frac{9}{4300} \\right) \\times 10^6 = \\frac{2100}{4300} \\times 10^6 = \\frac{21}{43} \\times 10^6$。\n-   $TPM_B^{(F)} = \\left( \\frac{RPK_B^{(F)}}{S^{(F)}} \\right) \\times 10^6 = \\left( \\frac{2200/9}{4300/9} \\right) \\times 10^6 = \\frac{2200}{4300} \\times 10^6 = \\frac{22}{43} \\times 10^6$。\n\n策略 F 的 TPM 向量是 $\\mathbf{t}^{(F)} = \\left( \\frac{21}{43} \\times 10^6, \\frac{22}{43} \\times 10^6 \\right)$。\n\n**欧几里得距离**\n最后一步是计算欧几里得距离 $D = ||\\mathbf{t}^{(F)} - \\mathbf{t}^{(U)}||$。首先，我们计算差分向量 $\\Delta\\mathbf{t} = \\mathbf{t}^{(F)} - \\mathbf{t}^{(U)}$。\n-   $\\Delta TPM_A = TPM_A^{(F)} - TPM_A^{(U)} = \\left(\\frac{21}{43} - \\frac{9}{17}\\right) \\times 10^6 = \\left(\\frac{21 \\cdot 17 - 9 \\cdot 43}{43 \\cdot 17}\\right) \\times 10^6 = \\left(\\frac{357 - 387}{731}\\right) \\times 10^6 = -\\frac{30}{731} \\times 10^6$。\n-   $\\Delta TPM_B = TPM_B^{(F)} - TPM_B^{(U)} = \\left(\\frac{22}{43} - \\frac{8}{17}\\right) \\times 10^6 = \\left(\\frac{22 \\cdot 17 - 8 \\cdot 43}{43 \\cdot 17}\\right) \\times 10^6 = \\left(\\frac{374 - 344}{731}\\right) \\times 10^6 = \\frac{30}{731} \\times 10^6$。\n\n欧几里得距离是差值平方和的平方根：\n$D = \\sqrt{(\\Delta TPM_A)^2 + (\\Delta TPM_B)^2} = \\sqrt{\\left(-\\frac{30}{731} \\times 10^6\\right)^2 + \\left(\\frac{30}{731} \\times 10^6\\right)^2}$\n$D = \\sqrt{2 \\left(\\frac{30}{731} \\times 10^6\\right)^2} = \\sqrt{2} \\left| \\frac{30}{731} \\times 10^6 \\right| = \\frac{30\\sqrt{2}}{731} \\times 10^6$。\n\n最后，我们计算数值并四舍五入至四位有效数字。\n$D \\approx \\frac{30 \\times 1.41421356}{731} \\times 10^6 \\approx \\frac{42.4264068}{731} \\times 10^6 \\approx 0.058038860 \\times 10^6 = 58038.860$。\n四舍五入至四位有效数字得到 $58040$。用科学记数法表示为 $5.804 \\times 10^4$。",
            "answer": "$$\\boxed{5.804 \\times 10^{4}}$$"
        },
        {
            "introduction": "当分析目标从基因水平深入到更为精细的转录本异构体（isoform）水平时，定量问题变得更加复杂，因为同一基因的不同异构体共享大量序列。一个核心的理论问题是：我们拥有的读段证据是否足以唯一地确定每种异构体的丰度？这个问题被称为“可识别性”（identifiability）问题，可以用线性代数的语言来精确描述。通过这个高级练习，你将学习如何使用等价类关联矩阵（equivalence class incidence matrix）来分析一个系统的可识别性，从而从根本上理解异构体定量的理论局限 。",
            "id": "4351378",
            "problem": "在一个对具有可变剪接的单个基因进行的链特异性RNA测序（RNA-seq）实验中，高通量测序读数经过了接头修剪、碱基质量过滤和低复杂度读数移除的处理。伪比对将每个读数分配给一个等价类，该等价类定义为与该读数兼容的异构体集合。经过偏差校正后，在无噪声极限下，跨等价类的期望片段计数向量 $\\mathbf{y} \\in \\mathbb{R}^{m}_{\\ge 0}$ 由线性系统 $\\mathbf{y} = A \\mathbf{x}$ 建模，其中 $A \\in \\{0,1\\}^{m \\times n}$ 是等价类关联矩阵，$\\mathbf{x} \\in \\mathbb{R}^{n}_{\\ge 0}$ 是异构体特异性有效片段计数的向量。文库大小施加了归一化约束 $\\sum_{i=1}^{n} x_{i} = N$，其中 $N \\in \\mathbb{R}_{>0}$ 是已知的。\n\n考虑一个具有 $n = 4$ 个异构体 $(T_{1}, T_{2}, T_{3}, T_{4})$ 和 $m = 5$ 个等价类 $(E_{1},\\dots,E_{5})$ 的基因。等价类关联矩阵 $A$（行由 $E_{j}$ 索引，列由 $T_{i}$ 索引）为\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1  0  0  1 \\\\\n0  1  0  1 \\\\\n1  1  1  1 \\\\\n1  0  0  1 \\\\\n0  1  0  1\n\\end{pmatrix}\n$$。\n\n从等价类和线性可识别性的核心定义出发，在模型 $\\mathbf{y}=A\\mathbf{x}$ 和归一化约束 $\\sum_{i=1}^{n} x_{i} = N$下，完成以下任务：\n\n1. 计算 $A$ 在 $\\mathbb{R}$ 上的秩。\n2. 确定异构体丰度（即向量 $\\mathbf{x}$）是否是可识别的，即可识别性意味着在约束 $\\sum_{i=1}^{n} x_{i} = N$ 下，从 $\\mathbf{x}$ 到 $\\mathbf{y}$ 的映射是一对一的。如果可识别，则结论为 $1$，如果不可识别，则为 $0$。\n\n将您的最终答案表示为一个包含两个条目的行矩阵 $\\begin{pmatrix} r  I \\end{pmatrix}$，其中 $r$ 是 $A$ 的秩，$I \\in \\{0,1\\}$ 是可识别性指标。不需要四舍五入，最终答案框内不应报告任何单位。",
            "solution": "该问题被评估为有效，因为它科学地基于RNA-seq数据转录本定量的原理，给出了所有必要信息且问题设定良好，并使用客观、正式的语言进行表述。我们开始解答。\n\n该问题要求对线性系统 $\\mathbf{y} = A \\mathbf{x}$ 在约束 $\\sum_{i=1}^{n} x_{i} = N$ 下进行两部分分析。给定的参数是异构体数量 $n=4$，等价类数量 $m=5$，以及等价类关联矩阵 $A$：\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1  0  0  1 \\\\\n0  1  0  1 \\\\\n1  1  1  1 \\\\\n1  0  0  1 \\\\\n0  1  0  1\n\\end{pmatrix}\n$$\n异构体计数向量为 $\\mathbf{x} = \\begin{pmatrix} x_1  x_2  x_3  x_4 \\end{pmatrix}^T$。\n\n**第1部分：计算 $A$ 的秩**\n\n矩阵的秩是其列空间或等价地，其行空间的维度。它是线性无关的列或行的最大数量。我们可以通过将矩阵简化为其行阶梯形来确定秩。\n\n首先，我们观察到第1行和第4行相同，第2行和第5行相同。因此，$A$ 的秩等于由 $A$ 的唯一行组成的矩阵 $A'$ 的秩：\n$$\nA' \\;=\\;\n\\begin{pmatrix}\n1  0  0  1 \\\\\n0  1  0  1 \\\\\n1  1  1  1\n\\end{pmatrix}\n$$\n我们对 $A'$ 应用高斯消元法来求其秩。设 $R_1$、$R_2$ 和 $R_3$ 表示 $A'$ 的行。\n我们执行行操作 $R_3 \\leftarrow R_3 - R_1$：\n$$\n\\begin{pmatrix}\n1  0  0  1 \\\\\n0  1  0  1 \\\\\n(1-1)  (1-0)  (1-0)  (1-1)\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n1  0  0  1 \\\\\n0  1  0  1 \\\\\n0  1  1  0\n\\end{pmatrix}\n$$\n接下来，我们执行行操作 $R_3 \\leftarrow R_3 - R_2$：\n$$\n\\begin{pmatrix}\n1  0  0  1 \\\\\n0  1  0  1 \\\\\n(0-0)  (1-1)  (1-0)  (0-1)\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n1  0  0  1 \\\\\n0  1  0  1 \\\\\n0  0  1  -1\n\\end{pmatrix}\n$$\n该矩阵是行阶梯形。非零行的数量为 $3$。因此，$A'$ 的秩为 $3$。由于 $A$ 的秩等于 $A'$ 的秩，我们有 $\\text{rank}(A) = 3$。所以，$r=3$。\n\n**第2部分：确定 $\\mathbf{x}$ 的可识别性**\n\n如果从 $\\mathbf{x}$ 到 $\\mathbf{y}$ 的映射在 $\\mathbf{x}$ 的约束条件下是一对一的，则异构体丰度向量 $\\mathbf{x}$ 是可识别的。约束条件是 $\\mathbf{x} \\in \\mathbb{R}^{n}_{\\ge 0}$ 和 $\\sum_{i=1}^{n} x_i = N$。\n一对一条件意味着，如果我们有两个解 $\\mathbf{x}_1$ 和 $\\mathbf{x}_2$ 满足：\n$1.$ $A\\mathbf{x}_1 = A\\mathbf{x}_2$\n$2.$ $\\sum_{i=1}^{n} x_{1,i} = N$ 且 $\\sum_{i=1}^{n} x_{2,i} = N$\n$3.$ $\\mathbf{x}_1, \\mathbf{x}_2 \\in \\mathbb{R}^{n}_{\\ge 0}$\n那么必须推导出 $\\mathbf{x}_1 = \\mathbf{x}_2$。\n\n我们定义一个差分向量 $\\mathbf{z} = \\mathbf{x}_1 - \\mathbf{x}_2$。从条件1，我们有 $A(\\mathbf{x}_1 - \\mathbf{x}_2) = \\mathbf{0}$，这意味着 $A\\mathbf{z} = \\mathbf{0}$。这表明 $\\mathbf{z}$ 必须在 $A$ 的零空间中，记为 $\\text{ker}(A)$。\n从条件2，我们有 $\\sum_{i=1}^{n} x_{1,i} - \\sum_{i=1}^{n} x_{2,i} = N - N = 0$，这意味着 $\\sum_{i=1}^{n} z_i = 0$。这可以写成 $\\mathbf{1}^T \\mathbf{z} = 0$，其中 $\\mathbf{1}$ 是一个适当维度的全一列向量。\n\n如果满足 $A\\mathbf{z} = \\mathbf{0}$ 和 $\\mathbf{1}^T \\mathbf{z} = 0$ 的唯一向量 $\\mathbf{z}$ 是零向量 $\\mathbf{z} = \\mathbf{0}$，则该系统是可识别的。\n\n我们首先刻画 $A$ 的零空间。根据秩-零度定理，零空间的维度由 $\\text{dim}(\\text{ker}(A)) = n - \\text{rank}(A)$ 给出。\n对于 $n=4$ 和 $\\text{rank}(A)=3$，我们有 $\\text{dim}(\\text{ker}(A)) = 4 - 3 = 1$。零空间是一维的，意味着存在对 $A\\mathbf{z} = \\mathbf{0}$ 的非零解。\n\n为了找到 $\\text{ker}(A)$ 的一个基，我们使用我们为 $A'$ 推导出的行阶梯形来求解 $A\\mathbf{z} = \\mathbf{0}$：\n$$\n\\begin{pmatrix}\n1  0  0  1 \\\\\n0  1  0  1 \\\\\n0  0  1  -1\n\\end{pmatrix}\n\\begin{pmatrix} z_1 \\\\ z_2 \\\\ z_3 \\\\ z_4 \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这给出了方程组：\n$z_1 + z_4 = 0 \\implies z_1 = -z_4$\n$z_2 + z_4 = 0 \\implies z_2 = -z_4$\n$z_3 - z_4 = 0 \\implies z_3 = z_4$\n如果我们选择 $z_4 = c$ 作为任意标量 $c \\in \\mathbb{R}$，那么零空间中的任何向量 $\\mathbf{z}$ 都具有形式 $\\mathbf{z} = c \\begin{pmatrix} -1 \\\\ -1 \\\\ 1 \\\\ 1 \\end{pmatrix}$。$\\text{ker}(A)$ 的一个基是向量 $\\mathbf{v} = \\begin{pmatrix} -1 \\\\ -1 \\\\ 1 \\\\ 1 \\end{pmatrix}$。\n\n现在，我们检查这个非零向量 $\\mathbf{z}$ 是否也满足第二个条件 $\\mathbf{1}^T \\mathbf{z} = 0$。我们计算基向量 $\\mathbf{v}$ 的分量之和：\n$$\n\\mathbf{1}^T \\mathbf{v} = (-1) + (-1) + 1 + 1 = 0\n$$\n由于 $\\mathbf{1}^T \\mathbf{v} = 0$，对于 $c \\neq 0$ 的任何向量 $\\mathbf{z} = c\\mathbf{v}$ 都是一个满足 $A\\mathbf{z} = \\mathbf{0}$ 和 $\\mathbf{1}^T \\mathbf{z} = 0$ 的非零向量。\n这意味着我们可以找到不同的解 $\\mathbf{x}_1$ 和 $\\mathbf{x}_2 = \\mathbf{x}_1 + c\\mathbf{v}$，它们产生相同的观测向量 $\\mathbf{y}$ 并具有相同的总和 $N$。为了使解在实践中不唯一，我们还必须满足非负性约束 $\\mathbf{x} \\ge \\mathbf{0}$。对于一个给定的有效解 $\\mathbf{x}_1$，可以选择一个足够小的 $c$，使得 $\\mathbf{x}_2 = \\mathbf{x}_1 + c\\mathbf{v}$ 的所有分量也都是非负的。例如，如果 $\\mathbf{x}_1 = \\begin{pmatrix} N/2  N/2  0  0 \\end{pmatrix}^T$，取 $c=N/4$ 得到 $\\mathbf{x}_2 = \\begin{pmatrix} N/4  N/4  N/4  N/4 \\end{pmatrix}^T$。由于 $\\mathbf{x}_1 \\ne \\mathbf{x}_2$，解不是唯一的。\n\n因此，该系统是不可识别的。可识别性指标为 $I=0$。\n\n总之，$A$ 的秩为 $r=3$，且系统不可识别，因此 $I=0$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 3  0 \\end{pmatrix}}$$"
        }
    ]
}