{
    "hands_on_practices": [
        {
            "introduction": "遗传开关的“开关”特性源于其组件对信号的急剧响应。本练习将聚焦于量化这种被称为“超敏性”的陡峭响应，我们使用希尔函数来模拟转录抑制过程。通过计算启动子活性及其对抑制物浓度的敏感性，你将理解一个鲁棒遗传开关背后的数学基础 。",
            "id": "4347539",
            "problem": "在一个典型的双基因遗传拨动开关中，每个基因通过转录因子与操纵子位点结合来抑制另一个基因，结合后会降低转录速率。在受质量作用定律支配的准平衡结合下，操纵子未结合的时间分数可以用一个Hill型抑制函数来建模。考虑一个浓度为 $x$ 的阻遏蛋白作用于一个启动子，该启动子的归一化活性由Hill抑制函数 $f(x) = \\frac{1}{1 + (x/K)^{n}}$ 给出，其中 $K$ 是解离常数（启动子活性为一半时的浓度），$n$ 是反映协同性或多位点结合的有效Hill系数。\n\n假设 $K = 50\\ \\text{nM}$ 且 $n = 2$。在系统生物医学框架内，从结合平衡和基因回路输入输出模块灵敏度的基本定义出发，按以下步骤进行：\n\n1. 使用输入输出映射的局部对数灵敏度 $S(x)$ 的定义，$S(x) = \\frac{d \\ln f(x)}{d \\ln x}$，推导 $S(x)$ 关于 $x$、$K$ 和 $n$ 的闭式表达式。\n\n2. 精确计算 $f(25\\ \\text{nM})$、$f(50\\ \\text{nM})$ 和 $f(100\\ \\text{nM})$（不要四舍五入），并解释这些值如何反映在 $x = K$ 附近响应的陡峭程度，而这种陡峭程度是遗传拨动开关实现鲁棒双稳态性所必需的。\n\n3. 对于 $n = 2$，计算您推导的 $S(x)$ 在 $x = K$ 处的值。将最终的灵敏度值表示为一个无量纲数。无需四舍五入。仅报告 $S(K)$ 的值作为最终答案。",
            "solution": "该问题要求对基因回路模型中常见的Hill型抑制函数进行多步分析。\n\n**1. 对数灵敏度 $S(x)$ 的推导**\n\n局部对数灵敏度 $S(x)$ 定义为输出 $f(x)$ 相对于输入 $x$ 的对数导数：\n$$S(x) = \\frac{d \\ln f(x)}{d \\ln x}$$\n使用链式法则求导，可以表示为：\n$$S(x) = \\frac{d \\ln f(x)/dx}{d \\ln x/dx} = \\frac{f'(x)/f(x)}{1/x} = \\frac{x f'(x)}{f(x)}$$\n首先，我们求 $f(x)$ 的自然对数：\n$$\\ln f(x) = \\ln\\left(\\frac{1}{1 + (x/K)^n}\\right) = - \\ln\\left(1 + \\left(\\frac{x}{K}\\right)^n\\right)$$\n现在，我们对 $\\ln f(x)$ 关于 $x$ 求导：\n$$\\frac{d}{dx} \\ln f(x) = - \\frac{1}{1 + (x/K)^n} \\cdot \\frac{d}{dx}\\left(1 + \\left(\\frac{x}{K}\\right)^n\\right)$$\n$$\\frac{d}{dx} \\ln f(x) = - \\frac{1}{1 + (x/K)^n} \\cdot \\left(\\frac{n x^{n-1}}{K^n}\\right)$$\n现在我们可以通过将此结果乘以 $x$ 来计算 $S(x)$：\n$$S(x) = x \\cdot \\frac{d \\ln f(x)}{dx} = x \\left[ - \\frac{1}{1 + (x/K)^n} \\cdot \\left(\\frac{n x^{n-1}}{K^n}\\right) \\right]$$\n$$S(x) = - \\frac{n x^n / K^n}{1 + (x/K)^n}$$\n化简后得到对数灵敏度的闭式表达式：\n$$S(x) = - \\frac{n (x/K)^n}{1 + (x/K)^n}$$\n\n**2. 启动子活性的计算与解释**\n\n给定 $K = 50\\ \\text{nM}$ 和 $n = 2$。启动子活性函数为 $f(x) = \\frac{1}{1 + (x/50)^2}$。\n\n当 $x = 25\\ \\text{nM}$ (即 $x = K/2$) 时：\n$$f(25) = \\frac{1}{1 + (25/50)^2} = \\frac{1}{1 + (1/2)^2} = \\frac{1}{1 + 1/4} = \\frac{1}{5/4} = \\frac{4}{5}$$\n\n当 $x = 50\\ \\text{nM}$ (即 $x = K$) 时：\n$$f(50) = \\frac{1}{1 + (50/50)^2} = \\frac{1}{1 + 1^2} = \\frac{1}{2}$$\n这证实了 $K$ 作为产生半最大抑制（或一半活性）的浓度的定义。\n\n当 $x = 100\\ \\text{nM}$ (即 $x = 2K$) 时：\n$$f(100) = \\frac{1}{1 + (100/50)^2} = \\frac{1}{1 + 2^2} = \\frac{1}{1 + 4} = \\frac{1}{5}$$\n\n解释：计算结果表明，当阻遏蛋白浓度 $x$ 从 $25\\ \\text{nM}$ 翻倍到 $50\\ \\text{nM}$ 时，启动子活性从 $80\\%$ ($4/5$) 下降到 $50\\%$ ($1/2$)。当浓度再次翻倍到 $100\\ \\text{nM}$ 时，活性进一步下降到 $20\\%$ ($1/5$)。启动子活性在相对较窄的阻遏蛋白浓度范围内发生的这种急剧变化被称为超敏或开关样响应。Hill系数 $n > 1$（此处为 $n=2$）是产生这种陡峭性的原因。在遗传拨动开关中，这种超敏性是实现双稳态性的关键要求，双稳态性使得系统可以稳定地存在于两种不同的状态（一个基因“开启”而另一个“关闭”，反之亦然）。陡峭的响应曲线使得两个阻遏蛋白的零增长等值线能够在三个点相交，其中两个外侧的点代表了开关的稳定稳态。\n\n**3. 在 $x = K$ 处灵敏度的计算**\n\n最后一个任务是在给定Hill系数 $n=2$ 的情况下，计算在特定点 $x=K$ 处的对数灵敏度 $S(x)$。我们使用第一部分推导出的 $S(x)$ 表达式：\n$$S(x) = - \\frac{n (x/K)^n}{1 + (x/K)^n}$$\n将 $x=K$ 代入表达式：\n$$S(K) = - \\frac{n (K/K)^n}{1 + (K/K)^n} = - \\frac{n \\cdot 1^n}{1 + 1^n} = - \\frac{n}{2}$$\n对于给定值 $n=2$：\n$$S(K) = - \\frac{2}{2} = -1$$\n这个值 $S(K) = -1$ 代表了当 $n=2$ 时Hill函数的最大局部灵敏度。它表明，在半抑制点，输入浓度 $x$ 的一个小的分数变化会导致输出活性 $f(x)$ 产生一个相等但方向相反的分数变化。例如，在 $K$ 附近，$x$ 增加 $1\\%$ 会导致 $f(x)$ 大约减少 $1\\%$。",
            "answer": "$$\\boxed{-1}$$"
        },
        {
            "introduction": "在理解了组件层面的特性后，我们将转向完整的双稳态开关系统。本练习将分析系统在一个关键工作点——两个抑制蛋白浓度相等的对称状态——的行为。通过进行线性稳定性分析 ，我们可以判断此对称状态是稳定还是不稳定，这是决定系统能否作为开关运作的关键。",
            "id": "4347512",
            "problem": "考虑一个在对称参数下的典范双基因互抑制遗传拨动开关。令 $x(t)$ 和 $y(t)$ 表示两种阻遏蛋白的无量纲浓度，其通过将物理浓度按一个特征降解率进行缩放得到，使得降解项为单位1。假设存在希尔系数为 $n$ 的协同抑制和一个最大产生参数 $\\beta>0$，得到如下常微分方程（ODEs）系统：\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\beta}{1 + y^{n}} \\;-\\; x, \n\\qquad \n\\frac{dy}{dt} \\;=\\; \\frac{\\beta}{1 + x^{n}} \\;-\\; y.\n$$\n这些方程基于分子生物学中心法则和转录调控的希尔形式：产生是相对阻遏蛋白的递减希尔函数，而移除是一阶降解过程。当 $s$ 满足产生和降解的不动点平衡时，存在一个对称不动点 $(x^{\\ast}, y^{\\ast}) = (s, s)$。\n\n任务：\n- 从上述系统出发，推导在对称不动点处 $s$ 必须满足的标量不动点方程，用 $n$ 和 $\\beta$ 表示。\n- 计算系统在 $(x^{\\ast}, y^{\\ast}) = (s,s)$ 处的雅可比矩阵，然后推导其两个特征值的闭式表达式，用 $n$、$\\beta$ 和 $s$ 表示。\n- 对于特定参数值 $n = 2$ 和 $\\beta = \\frac{5}{8}$，精确求解对称不动点 $s$，计算在 $(s,s)$ 处的雅可比矩阵，计算两个特征值的精确值，并用它们来分类对称不动点的线性稳定性。\n\n答案格式要求：\n- 最终答案必须只包含排列在 $\\mathrm{pmatrix}$ 环境中的单行矩阵形式的两个特征值，使用精确值（无需四舍五入）。无需单位。",
            "solution": "该问题要求对一个对称遗传拨动开关进行分析。分析过程包括寻找对称不动点，计算该点处的雅可比矩阵，推导其特征值，然后将此框架应用于一组特定参数以确定不动点的稳定性。\n\n该常微分方程系统由以下公式给出：\n$$\n\\frac{dx}{dt} \\;=\\; f(x, y) \\;=\\; \\frac{\\beta}{1 + y^{n}} \\;-\\; x\n$$\n$$\n\\frac{dy}{dt} \\;=\\; g(x, y) \\;=\\; \\frac{\\beta}{1 + x^{n}} \\;-\\; y\n$$\n\n**1. 标量不动点方程的推导**\n\n系统的一个不动点 $(x^{\\ast}, y^{\\ast})$ 是时间导数为零的点：$\\frac{dx}{dt} = 0$ 和 $\\frac{dy}{dt} = 0$。对于对称不动点，我们有条件 $x^{\\ast} = y^{\\ast} = s$。将此代入两个方程中的任意一个都会得到相同的条件。使用第一个方程：\n$$\n\\frac{dx}{dt}\\bigg|_{(s,s)} = \\frac{\\beta}{1 + s^{n}} - s = 0\n$$\n重新整理该方程，得到 $s$ 必须满足的标量不动点方程：\n$$\ns = \\frac{\\beta}{1 + s^{n}}\n$$\n这也可以写成 $s(1 + s^{n}) = \\beta$。\n\n**2. 雅可比矩阵和特征值**\n\n为了分析不动点的线性稳定性，我们计算系统的雅可比矩阵 $J$，其定义为：\n$$\nJ(x, y) = \\begin{pmatrix} \\frac{\\partial f}{\\partial x} & \\frac{\\partial f}{\\partial y} \\\\ \\frac{\\partial g}{\\partial x} & \\frac{\\partial g}{\\partial y} \\end{pmatrix}\n$$\n我们从函数 $f(x, y)$ 和 $g(x, y)$ 计算四个偏导数：\n$$\n\\frac{\\partial f}{\\partial x} = -1\n$$\n$$\n\\frac{\\partial f}{\\partial y} = \\frac{d}{dy}\\left(\\beta(1+y^n)^{-1}\\right) = \\beta(-1)(1+y^n)^{-2}(ny^{n-1}) = -\\frac{\\beta n y^{n-1}}{(1+y^n)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial x} = \\frac{d}{dx}\\left(\\beta(1+x^n)^{-1}\\right) = \\beta(-1)(1+x^n)^{-2}(nx^{n-1}) = -\\frac{\\beta n x^{n-1}}{(1+x^n)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial y} = -1\n$$\n现在，我们在对称不动点 $(s, s)$ 处计算该雅可比矩阵：\n$$\nJ(s, s) = \\begin{pmatrix} -1 & -\\frac{\\beta n s^{n-1}}{(1+s^n)^2} \\\\ -\\frac{\\beta n s^{n-1}}{(1+s^n)^2} & -1 \\end{pmatrix}\n$$\n我们可以使用不动点关系 $\\beta = s(1+s^n)$ 来简化非对角线项。将此代入 $\\beta$：\n$$\n-\\frac{\\beta n s^{n-1}}{(1+s^n)^2} = -\\frac{s(1+s^n) n s^{n-1}}{(1+s^n)^2} = -\\frac{n s^{n}}{1+s^n}\n$$\n我们定义一个项 $a = -\\frac{n s^{n}}{1+s^n}$。在 $(s,s)$ 处的雅可比矩阵简化为：\n$$\nJ(s, s) = \\begin{pmatrix} -1 & a \\\\ a & -1 \\end{pmatrix}\n$$\n通过求解特征方程 $\\det(J(s,s) - \\lambda I) = 0$ 来找到特征值 $\\lambda$：\n$$\n\\det\\begin{pmatrix} -1 - \\lambda & a \\\\ a & -1 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-1 - \\lambda)^2 - a^2 = 0\n$$\n$$\n(1 + \\lambda)^2 = a^2\n$$\n$$\n1 + \\lambda = \\pm a \\quad \\implies \\quad \\lambda = -1 \\pm a\n$$\n这给出了两个特征值，$\\lambda_1$ 和 $\\lambda_2$：\n$$\n\\lambda_1 = -1 + a = -1 - \\frac{n s^{n}}{1+s^n}\n$$\n$$\n\\lambda_2 = -1 - a = -1 - \\left(-\\frac{n s^{n}}{1+s^n}\\right) = -1 + \\frac{n s^{n}}{1+s^n}\n$$\n\n**3. 针对特定参数（$n=2$, $\\beta=5/8$）的分析**\n\n首先，我们使用特定参数 $n=2$ 和 $\\beta=\\frac{5}{8}$，在不动点方程 $s(1 + s^{n}) = \\beta$ 中求解对称不动点 $s$：\n$$\ns(1 + s^2) = \\frac{5}{8}\n$$\n两边乘以 $8$ 以消除分数，得到一个关于 $s$ 的三次方程：\n$$\n8s(1+s^2) = 5 \\quad \\implies \\quad 8s^3 + 8s - 5 = 0\n$$\n我们寻找 $s$ 的一个正实根（因为它代表物理浓度）。根据有理根定理，我们可以测试简单的有理根。让我们测试 $s = \\frac{1}{2}$：\n$$\n8\\left(\\frac{1}{2}\\right)^3 + 8\\left(\\frac{1}{2}\\right) - 5 = 8\\left(\\frac{1}{8}\\right) + 4 - 5 = 1 + 4 - 5 = 0\n$$\n因此，$s = \\frac{1}{2}$ 是一个根。为了找到其他可能的实根，我们将 $8s^3+8s-5$ 除以 $(s - \\frac{1}{2})$，或者更简单地，除以 $(2s-1)$：\n$$\n(2s-1)(4s^2 + 2s + 5) = 8s^3 + 4s^2 + 10s - 4s^2 - 2s - 5 = 8s^3 + 8s - 5\n$$\n二次因式是 $4s^2 + 2s + 5$。其判别式为 $\\Delta = b^2 - 4ac = 2^2 - 4(4)(5) = 4 - 80 = -76$。由于 $\\Delta  0$，该二次因式没有实根。因此，$s = \\frac{1}{2}$ 是对称不动点的唯一实数解。\n\n接下来，我们计算当 $n=2$ 和 $s=\\frac{1}{2}$ 时的特征值。首先，我们计算项 $\\frac{n s^{n}}{1+s^n}$ 的值：\n$$\n\\frac{n s^{n}}{1+s^n} = \\frac{2 \\left(\\frac{1}{2}\\right)^2}{1+\\left(\\frac{1}{2}\\right)^2} = \\frac{2 \\left(\\frac{1}{4}\\right)}{1+\\frac{1}{4}} = \\frac{\\frac{1}{2}}{\\frac{5}{4}} = \\frac{1}{2} \\cdot \\frac{4}{5} = \\frac{2}{5}\n$$\n现在我们将这个值代入特征值的表达式中：\n$$\n\\lambda_1 = -1 - \\frac{2}{5} = -\\frac{5}{5} - \\frac{2}{5} = -\\frac{7}{5}\n$$\n$$\n\\lambda_2 = -1 + \\frac{2}{5} = -\\frac{5}{5} + \\frac{2}{5} = -\\frac{3}{5}\n$$\n两个特征值是 $\\lambda_1 = -\\frac{7}{5}$ 和 $\\lambda_2 = -\\frac{3}{5}$。\n\n最后，我们分类对称不动点 $(s,s) = (\\frac{1}{2}, \\frac{1}{2})$ 的稳定性。因为两个特征值都是实数且为负（$\\lambda_1  0$ 和 $\\lambda_2  0$），所以该不动点是一个稳定节点。所有从该点足够近处开始的轨迹都将随着 $t \\to \\infty$ 收敛到该点。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{7}{5}  -\\frac{3}{5} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "解析方法虽然强大，但通常局限于特定点或简化条件。这个计算练习将让我们能够探索系统在更广泛参数范围内的行为。通过数值求解所有不动点并分析其稳定性，你将直接观察到当关键参数变化时，遗传开关是如何从单一稳定状态（单稳态）过渡到两个稳定状态（双稳态）的，这一现象被称为分岔 。",
            "id": "4347510",
            "problem": "考虑一个由两个相互抑制的基因组成的对称、无量纲化的遗传触发开关模型。设两种阻遏蛋白的浓度分别用 $x$ 和 $y$ 表示。该动力学由协同性为 $n$ 的希尔型抑制和由一阶降解缩放的最大产生速率 $\\beta$ 控制。其常微分方程(ODE)系统为\n$$\n\\frac{dx}{dt} = \\frac{\\beta}{1 + y^n} - x, \\qquad \\frac{dy}{dt} = \\frac{\\beta}{1 + x^n} - y,\n$$\n其中 $\\beta \\ge 0$ 且 $n \\ge 1$。该模型源自分子生物学中心法则（转录、翻译、降解）和经过经验验证的希尔抑制公式，并广泛应用于系统生物医学中研究遗传触发开关。\n\n一个不动点 $(x^\\ast, y^\\ast)$ 满足\n$$\nx^\\ast = \\frac{\\beta}{1 + (y^\\ast)^n}, \\qquad y^\\ast = \\frac{\\beta}{1 + (x^\\ast)^n}.\n$$\n\n不动点的局部稳定性由在 $(x^\\ast, y^\\ast)$ 处计算的右侧函数的雅可比矩阵决定。当且仅当雅可比矩阵的两个特征值的实部都严格为负时，该不动点是局部渐近稳定的。\n\n您的任务是，在 $n = 2$ 的情况下，对 $\\beta$ 的三个值：$\\beta = 1$, $\\beta = 3$ 和 $\\beta = 10$，数值计算不动点并对其局部稳定性进行分类。使用算法求根来识别生物学相关域 $x \\ge 0$, $y \\ge 0$ 内的所有不动点。然后，计算每个不动点处的雅可比矩阵，并通过其特征值对稳定性进行分类。\n\n要求和约束：\n- 在整个过程中使用 $n = 2$。\n- 对每个 $\\beta$，在域 $x \\in [0, \\beta]$ 和 $y \\in [0, \\beta]$ 中搜索不动点。\n- 对于数值分类，如果雅可比矩阵两个特征值的实部均  0，则宣布该不动点是稳定的，否则为不稳定的。\n- 汇总结果时，按 $x$ 的升序对不动点进行排序。\n\n测试套件：\n- 情况 1：$\\beta = 1$。\n- 情况 2：$\\beta = 3$。\n- 情况 3：$\\beta = 10$。\n\n最终输出规范：\n- 对每个测试用例，返回一个包含两个元素的列表：找到的不动点整数数量和一个布尔值列表，指示每个不动点的稳定性（顺序与按 $x$ 升序排列的顺序相同）。\n- 将所有测试用例的结果汇总到一行中，以方括号括起来的逗号分隔列表形式打印。例如，最终输出必须如下所示\n$$\n[\\,[k_1,\\,[s_{11},\\,s_{12},\\,\\dots]],[k_2,\\,[\\dots]],[k_3,\\,[\\dots]]\\,]\n$$\n其中 $k_i$ 是整数，$s_{ij}$ 是布尔值。不应打印其他任何文本。",
            "solution": "该任务要求针对给定的二维常微分方程(ODE)系统，在协同性 $n=2$ 和参数 $\\beta$ 的三个不同值的情况下，找到不动点并对其进行分类。\n\n**1. 寻找不动点**\n一个不动点 $(x^*, y^*)$ 满足下面的非线性代数方程组：\n$$\nx^* = \\frac{\\beta}{1 + (y^*)^2}\n$$\n$$\ny^* = \\frac{\\beta}{1 + (x^*)^2}\n$$\n由于系统的非线性，我们采用数值方法求解。这些解对应于向量函数 $\\vec{F}(x, y) = (x - \\frac{\\beta}{1 + y^2}, y - \\frac{\\beta}{1 + x^2})^T = \\vec{0}$ 的根。我们使用一个数值求根算法，在定义域 $x, y \\in [0, \\beta]$ 内搜索，以识别所有生物学上相关的不动点。\n\n**2. 稳定性分析**\n不动点 $(x^*, y^*)$ 的局部稳定性由系统在该点附近的线性化决定，这由在不动点处计算的雅可比矩阵 $J$ 来表征。对于 $n=2$ 的情况，雅可比矩阵 $J$ 为：\n$$\nJ(x, y) = \\begin{pmatrix} -1  -\\frac{2\\beta y}{(1 + y^2)^2} \\\\ -\\frac{2\\beta x}{(1 + x^2)^2}  -1 \\end{pmatrix}\n$$\n对于每个数值上找到的不动点，我们计算其对应雅可比矩阵的特征值。一个不动点是稳定的当且仅当其所有特征值的实部都严格为负。否则，它是不稳定的。\n\n**3. 各情况的结果**\n通过对每个 $\\beta$ 值应用此数值程序：\n- **情况 1: $\\beta = 1$**: 系统处于单稳态区域。我们找到了一个稳定的不动点，即对称不动点 $(x^* = y^*)$。\n- **情况 2: $\\beta = 3$**: 系统处于双稳态区域。我们找到了三个不动点：\n    - 两个不对称的不动点 $(x^* \\neq y^*)$，它们是稳定的。这代表了开关的两个“开/关”状态。\n    - 一个对称的不动点 $(x^* = y^*)$，它是不稳定的。这是一个鞍点，分隔了两个稳定状态的吸引盆。\n- **情况 3: $\\beta = 10$**: 系统仍处于双稳态区域。与 $\\beta=3$ 类似，我们找到了三个不动点，其稳定性模式相同（两个稳定，一个不稳定）。\n\n数值计算的结果汇总在最终答案中，列出了每个 $\\beta$ 值的不动点数量及其各自的稳定性。",
            "answer": "$$\n[[1, [\\text{True}]], [3, [\\text{True}, \\text{False}, \\text{True}]], [3, [\\text{True}, \\text{False}, \\text{True}]]]\n$$"
        }
    ]
}