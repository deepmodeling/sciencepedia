{
    "hands_on_practices": [
        {
            "introduction": "在系统生物学中，一个基础问题是：我们能否从实验数据中唯一地确定模型的参数？这个练习从一个经典的双指数模型入手，帮助你掌握结构可辨识性的核心定义。通过对比线性和非线性参数化方案 ，你将亲身体会到模型结构是如何直接影响参数的可辨识性的，并初步接触到用于量化实际可辨识性的强大工具——费雪信息矩阵（Fisher Information Matrix）。",
            "id": "4372069",
            "problem": "在一个受控的体外系统中，一个双指数药代动力学信号被建模为 $y(t)=\\theta_{1}\\exp(-a t)+\\theta_{2}\\exp(-b t)$，其中 $a>0$ 和 $b>0$ 是由实验条件设定的不同且已知的速率常数，而 $t\\in[0,T]$ 表示时间。我们得知，测量过程是加性的，并且在无噪声的测量条件下，系数 $\\theta_{1}$ 和 $\\theta_{2}$ 分别代表两种生化上不同物种的未知丰度。在有仪器噪声的应用中，读数为 $z(t)=y(t)+\\varepsilon(t)$，其中 $\\varepsilon(t)$ 是均值为零、谱密度为常数 $\\sigma^{2}$ 的高斯白噪声。\n\n仅使用系统辨识和统计学中的基本定义和经过充分检验的事实：\n\n- 结构可辨识性指的是输入-输出映射相对于参数的单射性，这是从理想化的无噪声数据得出的。\n- 在零均值、谱密度恒定的高斯白噪声下，对于参数化输出的连续时间观测，其费雪信息矩阵 (FIM) 为 $J=(1/\\sigma^{2})\\int_{0}^{T} s(t)s(t)^{\\top}\\,dt$，其中 $s(t)$ 是灵敏度向量 $s(t)=\\partial y(t)/\\partial \\theta$。\n\n任务：\n\n$1.$ 考虑在任意两个不同时间 $t_{1}\\neq t_{2}$（其中 $t_{1},t_{2}\\in(0,T]$）的两次无噪声测量 $y(t_{1})$ 和 $y(t_{2})$，证明 $(\\theta_{1},\\theta_{2})$ 的结构可辨识性。推导出用 $y(t_{1})$、$y(t_{2})$、$a$、$b$、$t_{1}$ 和 $t_{2}$ 表示 $\\theta_{1}$ 和 $\\theta_{2}$ 的显式表达式。\n\n$2.$ 对于在 $[0,T]$ 上的带噪声连续时间观测，计算 $\\theta=(\\theta_{1},\\theta_{2})$ 的费雪信息矩阵 $J$，并推导出用 $a$、$b$、$T$ 和 $\\sigma$ 表示的 $\\det(J)$ 的闭式表达式。\n\n$3.$ 考虑一个非线性变体，其中两个生化分支由单个催化效率参数 $\\kappa_{1}$ 和两个分支特异性因子 $\\kappa_{2}$ 和 $\\kappa_{3}$ 调节，得到 $y(t)=\\kappa_{1}\\kappa_{2}\\exp(-a t)+\\kappa_{1}\\kappa_{3}\\exp(-b t)$，其中 $a\\neq b>0$ 为已知。使用结构可辨识性的定义，判断 $(\\kappa_{1},\\kappa_{2},\\kappa_{3})$ 是否可以从 $[0,T]$ 上的理想无噪声 $y(t)$ 中被结构性辨识，并通过显式构造一个使 $y(t)$ 保持不变的非平凡参数变换（如果存在）来证明你的结论。\n\n请将任务2中获得的 $\\det(J)$ 的单个闭式解析表达式作为最终答案。不需要进行数值近似。请勿在最终答案框中包含单位。",
            "solution": "问题陈述的验证如下。\n\n**步骤1：提取给定条件**\n- 模型1（线性）：$y(t)=\\theta_{1}\\exp(-a t)+\\theta_{2}\\exp(-b t)$\n- 模型参数：$\\theta_{1}$ 和 $\\theta_{2}$ 是未知的丰度。\n- 模型常数：$a>0$ 和 $b>0$ 是不同的 ($a \\neq b$) 且已知的速率常数。\n- 时间域：$t \\in [0, T]$。\n- 噪声模型：$z(t)=y(t)+\\varepsilon(t)$，其中 $\\varepsilon(t)$ 是均值为零、谱密度为常数 $\\sigma^{2}$ 的高斯白噪声。\n- 结构可辨识性的定义：输入-输出映射相对于参数的单射性，这是从理想化的无噪声数据得出的。\n- 连续时间观测的费雪信息矩阵 (FIM) 定义：$J=(1/\\sigma^{2})\\int_{0}^{T} s(t)s(t)^{\\top}\\,dt$，其中 $s(t)=\\partial y(t)/\\partial \\theta$。\n- 任务1：使用在任意两个不同时间 $t_{1}\\neq t_{2}$（其中 $t_{1},t_{2}\\in(0,T]$）的两次无噪声测量 $y(t_{1})$ 和 $y(t_{2})$，证明 $(\\theta_{1},\\theta_{2})$ 的结构可辨识性。推导出 $\\theta_{1}$ 和 $\\theta_{2}$ 的显式表达式。\n- 任务2：对于在 $[0,T]$ 上的带噪声连续时间观测，计算 $\\theta=(\\theta_{1},\\theta_{2})$ 的费雪信息矩阵 $J$，并推导出 $\\det(J)$ 的闭式表达式。\n- 模型2（非线性）：$y(t)=\\kappa_{1}\\kappa_{2}\\exp(-a t)+\\kappa_{1}\\kappa_{3}\\exp(-b t)$，其中已知的 $a \\neq b > 0$。\n- 模型参数：$(\\kappa_{1}, \\kappa_{2}, \\kappa_{3})$ 是未知的。\n- 任务3：判断 $(\\kappa_{1},\\kappa_{2},\\kappa_{3})$ 是否可以从 $[0,T]$ 上的无噪声 $y(t)$ 中被结构性辨识，并证明结论。\n\n**步骤2：使用提取的给定条件进行验证**\n该问题具有科学依据，是适定且客观的。\n- **科学性和事实合理性：**模型 $y(t)=\\theta_{1}\\exp(-a t)+\\theta_{2}\\exp(-b t)$ 是双室药代动力学模型或平行一级反应的标准表示，在系统生物学、化学和工程学中是基础。结构可辨识性和费雪信息矩阵的定义在系统辨识和统计估计理论中是标准且正确的。\n- **适定性和完整性：**每个任务都有明确的规定。问题提供了所有必需的方程、定义和约束（例如，$a \\neq b$）以进行所需的推导。问题是明确的。\n- **客观性和可行性：**问题使用精确的数学语言陈述，没有主观论断。所需的计算是标准的积分学和线性代数，使得任务是可行的。\n\n**步骤3：结论和行动**\n问题是有效的。将提供完整的解答。\n\n**解题推导**\n\n**任务1：$(\\theta_{1},\\theta_{2})$的结构可辨识性**\n为证明参数 $\\theta = (\\theta_{1}, \\theta_{2})^{\\top}$ 的结构可辨识性，我们必须证明它们可以从无噪声输出 $y(t)$ 中唯一确定。按照指示，我们考虑在两个不同时间点 $t_{1} \\neq t_{2}$（其中 $t_{1}, t_{2} \\in (0, T]$）的两次测量。这产生了一个关于两个未知数 $\\theta_{1}$ 和 $\\theta_{2}$ 的二元线性方程组：\n$$\ny(t_{1}) = \\theta_{1}\\exp(-a t_{1}) + \\theta_{2}\\exp(-b t_{1})\n$$\n$$\ny(t_{2}) = \\theta_{1}\\exp(-a t_{2}) + \\theta_{2}\\exp(-b t_{2})\n$$\n该方程组可以写成矩阵形式：\n$$\n\\begin{pmatrix} y(t_{1}) \\\\ y(t_{2}) \\end{pmatrix} = \\begin{pmatrix} \\exp(-a t_{1}) & \\exp(-b t_{1}) \\\\ \\exp(-a t_{2}) & \\exp(-b t_{2}) \\end{pmatrix} \\begin{pmatrix} \\theta_{1} \\\\ \\theta_{2} \\end{pmatrix}\n$$\n$(\\theta_{1}, \\theta_{2})$ 存在唯一解的充要条件是系数矩阵的行列式不为零。设系数矩阵为 $M$。其行列式为：\n$$\n\\det(M) = \\exp(-a t_{1}) \\exp(-b t_{2}) - \\exp(-b t_{1}) \\exp(-a t_{2}) = \\exp(-(a t_{1} + b t_{2})) - \\exp(-(b t_{1} + a t_{2}))\n$$\n行列式为零的充要条件是 $a t_{1} + b t_{2} = b t_{1} + a t_{2}$，重新整理为 $a(t_{1}-t_{2}) - b(t_{1}-t_{2}) = 0$，即 $(a-b)(t_{1}-t_{2}) = 0$。根据问题陈述，速率常数是不同的 ($a \\neq b$)，测量时间也是不同的 ($t_{1} \\neq t_{2}$)。因此，$(a-b) \\neq 0$ 且 $(t_{1}-t_{2}) \\neq 0$，这意味着 $\\det(M) \\neq 0$。\n由于对于任何不同的 $t_{1}, t_{2}$ 的选择，系数矩阵都是可逆的，所以参数 $(\\theta_{1}, \\theta_{2})$ 是唯一确定的。这证明了它们是结构可辨识的。\n\n$\\theta_{1}$ 和 $\\theta_{2}$ 的显式表达式可以通过使用Cramer法则或矩阵求逆得到。使用Cramer法则：\n$$\n\\theta_{1} = \\frac{\\begin{vmatrix} y(t_{1}) & \\exp(-b t_{1}) \\\\ y(t_{2}) & \\exp(-b t_{2}) \\end{vmatrix}}{\\det(M)} = \\frac{y(t_{1})\\exp(-b t_{2}) - y(t_{2})\\exp(-b t_{1})}{\\exp(-a t_{1}-b t_{2}) - \\exp(-a t_{2}-b t_{1})}\n$$\n$$\n\\theta_{2} = \\frac{\\begin{vmatrix} \\exp(-a t_{1}) & y(t_{1}) \\\\ \\exp(-a t_{2}) & y(t_{2}) \\end{vmatrix}}{\\det(M)} = \\frac{y(t_{2})\\exp(-a t_{1}) - y(t_{1})\\exp(-a t_{2})}{\\exp(-a t_{1}-b t_{2}) - \\exp(-a t_{2}-b t_{1})}\n$$\n\n**任务2：$\\theta=(\\theta_{1},\\theta_{2})$的费雪信息矩阵**\n参数向量为 $\\theta = (\\theta_{1}, \\theta_{2})^{\\top}$。灵敏度向量 $s(t)$ 是输出 $y(t)$ 关于参数的偏导数向量：\n$$\ns(t) = \\frac{\\partial y(t)}{\\partial \\theta} = \\begin{pmatrix} \\frac{\\partial y(t)}{\\partial \\theta_{1}} \\\\ \\frac{\\partial y(t)}{\\partial \\theta_{2}} \\end{pmatrix} = \\begin{pmatrix} \\exp(-a t) \\\\ \\exp(-b t) \\end{pmatrix}\n$$\n费雪信息矩阵 $J$ 由 $J = (1/\\sigma^{2})\\int_{0}^{T} s(t)s(t)^{\\top}\\,dt$ 给出。首先，我们计算外积 $s(t)s(t)^{\\top}$：\n$$\ns(t)s(t)^{\\top} = \\begin{pmatrix} \\exp(-a t) \\\\ \\exp(-b t) \\end{pmatrix} \\begin{pmatrix} \\exp(-a t) & \\exp(-b t) \\end{pmatrix} = \\begin{pmatrix} \\exp(-2at) & \\exp(-(a+b)t) \\\\ \\exp(-(a+b)t) & \\exp(-2bt) \\end{pmatrix}\n$$\n现在，我们将这个矩阵的每个元素从 $t=0$ 积分到 $t=T$：\n$$\nJ_{11} = \\frac{1}{\\sigma^{2}}\\int_{0}^{T} \\exp(-2at) \\,dt = \\frac{1}{\\sigma^{2}}\\left[-\\frac{1}{2a}\\exp(-2at)\\right]_{0}^{T} = \\frac{1-\\exp(-2aT)}{2a\\sigma^{2}}\n$$\n$$\nJ_{22} = \\frac{1}{\\sigma^{2}}\\int_{0}^{T} \\exp(-2bt) \\,dt = \\frac{1}{\\sigma^{2}}\\left[-\\frac{1}{2b}\\exp(-2bt)\\right]_{0}^{T} = \\frac{1-\\exp(-2bT)}{2b\\sigma^{2}}\n$$\n$$\nJ_{12} = J_{21} = \\frac{1}{\\sigma^{2}}\\int_{0}^{T} \\exp(-(a+b)t) \\,dt = \\frac{1}{\\sigma^{2}}\\left[-\\frac{1}{a+b}\\exp(-(a+b)t)\\right]_{0}^{T} = \\frac{1-\\exp(-(a+b)T)}{(a+b)\\sigma^{2}}\n$$\n完整的费雪信息矩阵是：\n$$\nJ = \\frac{1}{\\sigma^{2}} \\begin{pmatrix} \\frac{1-\\exp(-2aT)}{2a} & \\frac{1-\\exp(-(a+b)T)}{a+b} \\\\ \\frac{1-\\exp(-(a+b)T)}{a+b} & \\frac{1-\\exp(-2bT)}{2b} \\end{pmatrix}\n$$\n最后，我们计算 $J$ 的行列式：\n$$\n\\det(J) = J_{11}J_{22} - J_{12}^{2}\n$$\n$$\n\\det(J) = \\left(\\frac{1-\\exp(-2aT)}{2a\\sigma^{2}}\\right)\\left(\\frac{1-\\exp(-2bT)}{2b\\sigma^{2}}\\right) - \\left(\\frac{1-\\exp(-(a+b)T)}{(a+b)\\sigma^{2}}\\right)^{2}\n$$\n$$\n\\det(J) = \\frac{1}{\\sigma^{4}} \\left( \\frac{(1-\\exp(-2aT))(1-\\exp(-2bT))}{4ab} - \\frac{(1-\\exp(-(a+b)T))^{2}}{(a+b)^{2}} \\right)\n$$\n这就是所要求的闭式表达式。\n\n**任务3：$(\\kappa_{1},\\kappa_{2},\\kappa_{3})$的结构可辨识性**\n非线性模型为 $y(t)=\\kappa_{1}\\kappa_{2}\\exp(-a t)+\\kappa_{1}\\kappa_{3}\\exp(-b t)$。通过定义新参数，该模型可以映射到线性模型：\n$$\n\\theta_{1} = \\kappa_{1}\\kappa_{2}\n$$\n$$\n\\theta_{2} = \\kappa_{1}\\kappa_{3}\n$$\n从任务1中，我们确定了参数 $(\\theta_{1}, \\theta_{2})$ 是结构可辨识的。$(\\kappa_{1}, \\kappa_{2}, \\kappa_{3})$ 是否可辨识的问题等价于问从 $(\\kappa_{1}, \\kappa_{2}, \\kappa_{3})$到 $(\\theta_{1}, \\theta_{2})$ 的映射是否是单射的。我们有了一个包含3个未知数的2个方程的方程组。该系统是欠定的，这表明参数是不可辨识的。\n\n为了形式上证明这一点，我们必须构造一个使输出 $y(t)$ 保持不变的非平凡参数变换。设 $\\alpha$ 为一个任意非零且非1的常数（$\\alpha \\neq 0, \\alpha \\neq 1$）。考虑由以下变换定义的一组新参数 $(\\kappa'_{1}, \\kappa'_{2}, \\kappa'_{3})$：\n$$\n\\kappa'_{1} = \\alpha \\kappa_{1}\n$$\n$$\n\\kappa'_{2} = \\frac{1}{\\alpha} \\kappa_{2}\n$$\n$$\n\\kappa'_{3} = \\frac{1}{\\alpha} \\kappa_{3}\n$$\n原始参数集是 $(\\kappa_{1}, \\kappa_{2}, \\kappa_{3})$。由于 $\\alpha \\neq 1$，新的参数集 $(\\kappa'_{1}, \\kappa'_{2}, \\kappa'_{3})$ 与原始参数集不同。\n现在我们为这组新参数计算 $\\theta_{1}$ 和 $\\theta_{2}$ 的值，我们将其记为 $\\theta'_{1}$ 和 $\\theta'_{2}$：\n$$\n\\theta'_{1} = \\kappa'_{1} \\kappa'_{2} = (\\alpha \\kappa_{1}) \\left(\\frac{1}{\\alpha} \\kappa_{2}\\right) = \\kappa_{1} \\kappa_{2} = \\theta_{1}\n$$\n$$\n\\theta'_{2} = \\kappa'_{1} \\kappa'_{3} = (\\alpha \\kappa_{1}) \\left(\\frac{1}{\\alpha} \\kappa_{3}\\right) = \\kappa_{1} \\kappa_{3} = \\theta_{2}\n$$\n由于 $(\\theta'_{1}, \\theta'_{2}) = (\\theta_{1}, \\theta_{2})$，输出函数 $y(t)$ 在此参数变换下保持不变。对于任何给定的参数集 $(\\kappa_{1}, \\kappa_{2}, \\kappa_{3})$，都存在一个无穷的参数集族 $(\\alpha\\kappa_{1}, \\kappa_{2}/\\alpha, \\kappa_{3}/\\alpha)$，它们产生完全相同的输出 $y(t)$。因此，不可能从 $y(t)$ 的测量中唯一确定 $(\\kappa_{1}, \\kappa_{2}, \\kappa_{3})$。\n结论：参数集 $(\\kappa_{1},\\kappa_{2},\\kappa_{3})$ 是结构不可辨识的。",
            "answer": "$$\n\\boxed{\\frac{1}{\\sigma^{4}} \\left[ \\frac{\\left(1-\\exp(-2aT)\\right)\\left(1-\\exp(-2bT)\\right)}{4ab} - \\frac{\\left(1-\\exp(-(a+b)T)\\right)^{2}}{(a+b)^{2}} \\right]}\n$$"
        },
        {
            "introduction": "理论上的可辨识性分析固然重要，但在处理真实世界的含噪声数据时，我们需要更实用的工具。这个练习将指导你通过编程实现剖面似然（Profile Likelihood）分析，这是一种评估参数不确定性的通用且强大的计算方法。通过模拟不同实验设计（例如，仅有晚期时间点的数据），你将直观地看到“扁平”的似然曲线是如何揭示参数的实际不可辨识性的，从而深刻理解优化实验设计对于参数估计的关键作用 。",
            "id": "4372027",
            "problem": "考虑由常微分方程（ODE）$$\\frac{dx}{dt} = -\\theta x,$$ 给出的指数衰减模型，在未知初始条件下，其解为 $$x(t) = x(0)\\,e^{-\\theta t}.$$ 假设采集到的测量值为 $$y_i = x(t_i) + \\varepsilon_i,$$ 其中测量噪声满足 $$\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$$，在各时间点上独立，且 $$\\sigma$$ 是已知的。任务是通过计算在最大似然估计（MLE）下 $$\\theta$$ 的剖面似然（PL），来评估当 $$x(0)$$ 未知时参数 $$\\theta$$ 的可识别性，并说明在只有稳态或晚期数据可用时出现的平坦方向。\n\n您必须实现一个程序，该程序针对 $$\\theta$$ 值的网格，通过在每个 $$\\theta$$ 值上对无关参数 $$x(0)$$ 的负对数似然进行最小化，来计算剖面负对数似然 $$\\ell(\\theta)$$。然后，对于每个测试用例，您必须报告：\n- 以 $$\\mathrm{s}^{-1}$$ 为单位的最大似然估计 $$\\hat{\\theta}$$，\n- 在似然比阈值 $$\\Delta \\ell^\\star$$ 下，PL 的宽度，以 $$\\mathrm{s}^{-1}$$ 为单位，\n- 一个布尔标志，根据指定标准指示 PL 是否呈现平坦方向。\n\n必须使用的定义：\n- 剖面似然（PL）：在对 $$x(0)$$ 进行优化后，似然作为 $$\\theta$$ 的函数。\n- 最大似然估计（MLE）：通过最小化剖面负对数似然获得的估计值 $$\\hat{\\theta}$$。\n- 此处的平坦方向定义为以下任一情况：在阈值 $$\\Delta \\ell^\\star$$ 下的置信集触及 $$\\theta$$-网格边界，或者其宽度至少为总网格跨度的 $$w_{\\mathrm{flat}}$$ 比例。\n\n您必须在区间 $$[\\theta_{\\min},\\theta_{\\max}]$$ 上使用固定的 $$\\theta$$ 网格，步长均匀为 $$\\delta_\\theta$$，并通过优化掉 $$x(0)$$ 来计算每个网格点上的 PL。使用似然比阈值 $$\\Delta \\ell^\\star$$ 来定义置信集 $$\\{\\theta : \\ell(\\theta) - \\min_{\\theta} \\ell(\\theta) \\le \\Delta \\ell^\\star\\}$$，并报告其宽度，即该集合中最大和最小 $$\\theta$$ 之间的差值。对于布尔标志，请使用上述平坦度标准。\n\n您的程序必须使用合成数据实现以下测试套件。在所有情况下，测量值均以任意浓度单位表示，时间以秒为单位；报告 $$\\hat{\\theta}$$ 和宽度时均以 $$\\mathrm{s}^{-1}$$ 为单位。对于有噪声的场景，使用指定的种子生成高斯噪声以确保可复现性。\n\n- 测试用例 $$1$$（完整时间过程，可识别）：\n  - 真实参数：$$\\theta_{\\mathrm{true}} = 0.5$$, $$x(0)_{\\mathrm{true}} = 5.0$$。\n  - 时间点：$$t = [0.0,\\,0.5,\\,1.0,\\,2.0,\\,3.5,\\,5.0,\\,6.0]$$。\n  - 噪声水平：$$\\sigma = 0.05$$。\n  - 噪声种子：$$12345$$。\n\n- 测试用例 $$2$$（仅晚期时间，实践上平坦）：\n  - 真实参数：$$\\theta_{\\mathrm{true}} = 0.5$$, $$x(0)_{\\mathrm{true}} = 5.0$$。\n  - 时间点：$$t = [5.0,\\,6.0,\\,8.0,\\,10.0,\\,12.0]$$。\n  - 噪声水平：$$\\sigma = 0.05$$。\n  - 噪声种子：$$23456$$。\n\n- 测试用例 $$3$$（仅稳态，结构上平坦）：\n  - 时间点：$$t = [100.0]$$。\n  - 观测测量值：$$y = [0.0]$$ 精确值（无噪声抽取）。\n  - 似然中使用的噪声水平：$$\\sigma = 0.01$$。\n\n在所有测试用例中统一使用以下全局分析设置：\n- $$\\theta_{\\min} = 0.001$$，\n- $$\\theta_{\\max} = 3.000$$，\n- $$\\delta_\\theta = 0.001$$，\n- 似然比阈值 $$\\Delta \\ell^\\star = 2.0$$，\n- 平坦度分数阈值 $$w_{\\mathrm{flat}} = 0.7$$。\n\n程序必须为每个测试用例执行的算法任务：\n- 根据用例规范模拟或设置观测到的 $$y_i$$。\n- 对于网格上的每个 $$\\theta$$，数值优化掉 $$x(0)$$ 并计算剖面负对数似然 $$\\ell(\\theta)$$。\n- 将在网格上最小化 $$\\ell(\\theta)$$ 的 $$\\theta$$ 计算为 $$\\hat{\\theta}$$。\n- 计算在 $$\\Delta \\ell^\\star$$ 下的 PL 宽度。\n- 使用指定标准计算平坦度标志。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且本身是一个包含三个条目 $$[\\hat{\\theta},\\text{width},\\text{is\\_flat}]$$ 的子列表。前两个条目是 $$\\mathrm{s}^{-1}$$ 单位的浮点数，第三个是布尔值。例如，格式应如 $$[[0.500000,0.123000,\\mathrm{False}],[\\dots],[\\dots]]$$ 所示，不含空格。\n\n不允许外部输入；所有值和数据都在程序内部定义。",
            "solution": "该问题要求使用剖面似然法评估指数衰减模型的参数可识别性。这是系统生物学和其他定量领域中的一项基本技术，用于分析参数估计的置信度，特别是当某些参数（所谓的无关参数）不是主要关注对象时。\n\n该模型由一个常微分方程的解来描述：\n$$x(t) = x(0)\\,e^{-\\theta t}$$\n其中 $$x(t)$$ 是时间 $$t$$ 时的状态，$$x(0)$$ 是初始状态，$$\\theta$$ 是衰减速率常数。在时间点 $$t_i$$ 采集测量值 $$y_i$$，这些测量值服从独立同分布的高斯噪声：\n$$y_i = x(t_i) + \\varepsilon_i, \\quad \\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$$\n噪声的标准差 $$\\sigma$$ 假定为已知。需要从数据 $$\\{y_i, t_i\\}$$ 中估计的参数是 $$\\theta$$ 和 $$x(0)$$。我们的兴趣在于 $$\\theta$$ 的可识别性，并将 $$x(0)$$ 视为无关参数。\n\n分析过程首先构建似然函数，该函数量化了在给定一组参数的情况下观测到数据的可能性。对于单个数据点 $$y_i$$，其概率密度函数为：\n$$p(y_i | \\theta, x(0)) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(y_i - x(0)e^{-\\theta t_i})^2}{2\\sigma^2} \\right)$$\n假设测量是独立的，整个包含 $$N$$ 个点的数据集的总似然 $$\\mathcal{L}(\\theta, x(0))$$ 是各个概率的乘积：\n$$\\mathcal{L}(\\theta, x(0)) = \\prod_{i=1}^{N} p(y_i | \\theta, x(0))$$\n在数值上，处理负对数似然 $$\\ell(\\theta, x(0)) = -\\log(\\mathcal{L}(\\theta, x(0)))$$ 更为方便。取对数并取反可得：\n$$\\ell(\\theta, x(0)) = \\frac{N}{2}\\log(2\\pi\\sigma^2) + \\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} (y_i - x(0)e^{-\\theta t_i})^2$$\n为了找到参数的最大似然估计（MLE），需要最小化此函数。\n\n对于我们感兴趣的参数 $$\\theta$$，其剖面似然是通过对每个固定的 $$\\theta$$ 值，就无关参数 $$x(0)$$ 最小化负对数似然得到的。我们将剖面负对数似然定义为：\n$$\\ell_{PL}(\\theta) = \\min_{x(0)} \\ell(\\theta, x(0))$$\n由于常数项 $$\\frac{N}{2}\\log(2\\pi\\sigma^2)$$ 不依赖于 $$x(0)$$，这等价于最小化残差平方和 $$S(\\theta, x(0)) = \\sum_{i=1}^{N} (y_i - x(0)e^{-\\theta t_i})^2$$。这是一个关于 $$x(0)$$ 的线性最小二乘问题。为了找到最优的 $$x(0)$$（我们记为 $$\\hat{x}(0)(\\theta)$$），我们将 $$S$$ 关于 $$x(0)$$ 的偏导数设为零：\n$$\\frac{\\partial S}{\\partial x(0)} = -2 \\sum_{i=1}^{N} (y_i - x(0)e^{-\\theta t_i})e^{-\\theta t_i} = 0$$\n求解 $$x(0)$$，可得在给定 $$\\theta$$ 时其最优值的解析解：\n$$\\hat{x}(0)(\\theta) = \\frac{\\sum_{i=1}^{N} y_i e^{-\\theta t_i}}{\\sum_{i=1}^{N} e^{-2\\theta t_i}}$$\n其二阶导数 $$\\frac{\\partial^2 S}{\\partial x(0)^2} = 2 \\sum_{i=1}^{N} e^{-2\\theta t_i}$$ 对于实数 $$t_i$$ 和 $$\\theta$$ 恒为正，这证实了该点为最小值点。\n\n将 $$\\hat{x}(0)(\\theta)$$ 代回负对数似然表达式，得到 $$\\theta$$ 的剖面负对数似然：\n$$\\ell_{PL}(\\theta) = \\frac{N}{2}\\log(2\\pi\\sigma^2) + \\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} (y_i - \\hat{x}(0)(\\theta)e^{-\\theta t_i})^2$$\n\n需要实现的算法如下：\n1. 对于每个测试用例，在时间点 $$\\{t_i\\}$$ 生成或定义测量数据 $$\\{y_i\\}$$。\n2. 创建一个从 $$\\theta_{\\min}$$ 到 $$\\theta_{\\max}$$，步长为 $$\\delta_\\theta$$ 的离散 $$\\theta$$ 值网格。\n3. 对于网格上的每个 $$\\theta_j$$，使用上述解析公式计算 $$\\hat{x}(0)(\\theta_j)$$。然后，计算剖面负对数似然的值 $$\\ell_{PL}(\\theta_j)$$。\n4. 找到计算出的剖面的全局最小值 $$\\ell_{\\min} = \\min_j \\ell_{PL}(\\theta_j)$$。对应的参数值 $$\\hat{\\theta} = \\arg\\min_j \\ell_{PL}(\\theta_j)$$，即为 $$\\theta$$ 的最大似然估计。\n5. 基于似然比检验确定置信集。在特定置信水平下与数据一致的参数集合由 $$\\{\\theta : \\ell_{PL}(\\theta) - \\ell_{\\min} \\le \\Delta \\ell^\\star\\}$$ 给出。此处，$$\\Delta \\ell^\\star$$ 是一个预定义的阈值。该集合的宽度是其最大值和最小值之差。\n6. 根据指定标准评估剖面似然是否呈现“平坦方向”：置信集与 $$\\theta$$ 网格的边界相交，或者其宽度超过总网格跨度的一个分数 $$w_{\\text{flat}}$$。\n\n此过程应用于三个旨在说明不同可识别性场景的测试用例：\n- **案例 1：** 来自完整时间过程的数据预计能很好地约束 $$x(0)$$ 和 $$\\theta$$，从而在剖面似然中产生一个明确的最小值和一个狭窄的置信区间。这代表一个可识别的参数。\n- **案例 2：** 仅使用晚期时间点的数据，此时信号 $$x(t)$$ 接近于零。信息含量低，难以区分不同（足够大的）$$\\theta$$ 值。这导致参数“实践上不可识别”，其特征是似然剖面宽而平坦，置信区间大。\n- **案例 3：** 在非常晚的时间点（稳态）的单个数据点，此时 $$x(t \\to \\infty) \\to 0$$。对于任何正的衰减率 $$\\theta$$，将 $$\\hat{x}(0) = 0$$ 设为零可以完美解释零测量值。对于所有 $$\\theta > 0$$，似然将是恒定的，使得参数从这些数据来看是“结构上不可识别”的。置信区间将跨越整个参数范围。\n实现将对每个案例进行数值分析，并按要求报告结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for parameter identifiability in an exponential decay model\n    using profile likelihood for three test cases.\n    \"\"\"\n\n    # Global analysis settings\n    theta_min = 0.001\n    theta_max = 3.000\n    delta_theta = 0.001\n    delta_ell_star = 2.0\n    w_flat = 0.7\n\n    # Test case definitions\n    test_cases = [\n        {\n            \"name\": \"Case 1: Full time-course, identifiable\",\n            \"true_params\": {\"theta\": 0.5, \"x0\": 5.0},\n            \"time_points\": np.array([0.0, 0.5, 1.0, 2.0, 3.5, 5.0, 6.0]),\n            \"sigma\": 0.05,\n            \"noise_seed\": 12345,\n            \"y_data\": None\n        },\n        {\n            \"name\": \"Case 2: Late-time-only, practically flat\",\n            \"true_params\": {\"theta\": 0.5, \"x0\": 5.0},\n            \"time_points\": np.array([5.0, 6.0, 8.0, 10.0, 12.0]),\n            \"sigma\": 0.05,\n            \"noise_seed\": 23456,\n            \"y_data\": None\n        },\n        {\n            \"name\": \"Case 3: Steady-state-only, structurally flat\",\n            \"true_params\": None,\n            \"time_points\": np.array([100.0]),\n            \"sigma\": 0.01,\n            \"noise_seed\": None,\n            \"y_data\": np.array([0.0])\n        }\n    ]\n\n    # Generate theta grid\n    # Use linspace for robustness against floating point errors with arange\n    num_points = int(round((theta_max - theta_min) / delta_theta)) + 1\n    theta_grid = np.linspace(theta_min, theta_max, num_points)\n\n    all_results = []\n\n    for case in test_cases:\n        t = case[\"time_points\"]\n        sigma = case[\"sigma\"]\n        y = case[\"y_data\"]\n        N = len(t)\n        \n        # Generate synthetic data if not provided directly\n        if y is None:\n            rng = np.random.default_rng(case[\"noise_seed\"])\n            theta_true = case[\"true_params\"][\"theta\"]\n            x0_true = case[\"true_params\"][\"x0\"]\n            x_true = x0_true * np.exp(-theta_true * t)\n            noise = rng.normal(0, sigma, size=N)\n            y = x_true + noise\n\n        # Compute profile negative log-likelihood\n        profile_nll = np.zeros_like(theta_grid)\n        \n        for i, theta_val in enumerate(theta_grid):\n            exp_t = np.exp(-theta_val * t)\n            exp_2t = np.exp(-2 * theta_val * t)\n            \n            numerator = np.sum(y * exp_t)\n            denominator = np.sum(exp_2t)\n\n            # If denominator underflows to 0, it means all exp(-theta*t) are\n            # effectively 0. The model predicts 0, and x0 is indeterminate.\n            # The RSS is then simply sum of squares of y.\n            if denominator = np.finfo(float).tiny:\n                rss = np.sum(y**2)\n            else:\n                x0_hat = numerator / denominator\n                rss = np.sum((y - x0_hat * exp_t)**2)\n            \n            # The full negative log-likelihood formula\n            nll = N / 2 * np.log(2 * np.pi * sigma**2) + rss / (2 * sigma**2)\n            profile_nll[i] = nll\n\n        # Find MLE and confidence interval\n        nll_min = np.min(profile_nll)\n        mle_idx = np.argmin(profile_nll)\n        theta_mle = theta_grid[mle_idx]\n        \n        threshold = nll_min + delta_ell_star\n        confidence_indices = np.where(profile_nll = threshold)[0]\n        \n        # Calculate width of confidence interval\n        if len(confidence_indices) > 0:\n            ci_min_theta = theta_grid[confidence_indices[0]]\n            ci_max_theta = theta_grid[confidence_indices[-1]]\n            width = ci_max_theta - ci_min_theta\n        else: # Should not happen if logic is correct\n            width = 0.0\n\n        # Check for flatness\n        touches_boundary = False\n        if len(confidence_indices) > 0:\n            touches_boundary = (confidence_indices[0] == 0) or \\\n                               (confidence_indices[-1] == len(theta_grid) - 1)\n        \n        grid_span = theta_max - theta_min\n        width_is_large = (width >= w_flat * grid_span)\n        \n        is_flat = touches_boundary or width_is_large\n        \n        all_results.append([theta_mle, width, is_flat])\n\n    # Format output string\n    result_strings = []\n    for res in all_results:\n        theta_str = f\"{res[0]:.6f}\"\n        width_str = f\"{res[1]:.6f}\"\n        bool_str = str(res[2])\n        result_strings.append(f\"[{theta_str},{width_str},{bool_str}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "当模型存在固有的结构不可辨识性（例如，由缩放对称性引起）时，我们是否就束手无策了？这个练习展示了一种解决此问题的有效策略：引入先验知识。你将首先分析一个由于参数乘积形式而导致结构不可辨识性的模型，然后通过引入贝叶斯框架下的先验分布，从最大似然估计（MLE）过渡到最大后验（MAP）估计。这个过程清晰地表明，即使模型本身存在模糊性，结合合理的先验信息也能够帮助我们获得唯一且有意义的参数估计结果 。",
            "id": "4372090",
            "problem": "考虑一个由常微分方程(ODE) $\\,\\frac{dX}{dt}=-\\lambda X\\,$ 描述的单室生化清除模型，其中衰减率 $\\,\\lambda0\\,$ 已知，初始浓度 $\\,X_0=X(0)0\\,$ 未知。测量输出是经过缩放的浓度 $\\,y(t)=\\alpha X(t)+\\varepsilon(t)\\,$，其中 $\\,\\alpha0\\,$ 是一个未知的测量比例因子，$\\,\\varepsilon(t)\\,$ 是测量噪声。假设在观测时间 $\\,t_1,\\dots,t_M\\,$ 的噪声为独立同分布的加性高斯噪声，其均值为零，方差为 $\\,\\sigma^2\\,$，从而得到数据 $\\,y_i=y(t_i)\\,$，其中 $\\,i=1,\\dots,M\\,$。\n\n您可以将以下内容作为基本事实：\n- 该常微分方程的解为 $\\,X(t)=X_0\\exp(-\\lambda t)\\,$.\n- 在具有共同方差的独立高斯噪声下，给定模型的数据似然与 $\\exp\\!\\big(-\\frac{1}{2\\sigma^2}\\sum_{i=1}^M\\big(y_i-\\alpha X_0 \\exp(-\\lambda t_i)\\big)^2\\big)$ 成正比。\n- 结构可辨识性指的是在给定完美的无噪声数据和已知输入的情况下，参数值的唯一性；模型中的尺度对称性可能导致独立参数的不可辨识性，而这些参数的乘积却是唯一确定的。\n\n任务：\n1. 证明模型输出仅通过乘积 $\\,\\eta=\\alpha X_0\\,$ 依赖于参数，并解释为什么这因尺度对称性而意味着 $\\,\\alpha\\,$ 和 $\\,X_0\\,$ 的结构不可辨识性。\n2. 令 $\\,w_i=\\exp(-\\lambda t_i)\\,$. 根据给定数据 $\\{(t_i,y_i)\\}_{i=1}^M$ 推导 $\\,\\eta\\,$ 的最大似然估计 $\\,\\widehat{\\eta}\\,$.\n3. 为实现实际可辨识性，对 $\\,\\alpha\\,$ 施加一个信息先验：假设 $\\,\\ln \\alpha\\sim \\mathcal{N}(\\mu,\\sigma_{\\alpha}^2)\\,$，这是一个对数正态先验。在此先验下最大化后验概率，会沿着由 $\\,\\eta=\\widehat{\\eta}\\,$ 表征的似然脊线选择一个唯一的 $\\,\\alpha\\,$。仅使用给定的基本事实，推导 $X_0$ 的最大后验 (MAP) 估计 $\\,X_0^{\\mathrm{MAP}}\\,$，将其表示为关于 $\\,\\mu\\,$、$\\,\\sigma_{\\alpha}^2\\,$、数据 $\\{(t_i,y_i)\\}_{i=1}^M$ 和已知 $\\,\\lambda\\,$ 的封闭形式符号表达式。\n\n将您的最终结果表示为单个封闭形式的解析表达式。不需要单位。不要引入任何数值近似；答案必须是精确的。",
            "solution": "该问题要求对一个单室生化清除模型进行三部分分析，重点关注参数可辨识性。我们将首先论证结构不可辨识性，然后为一个集总参数推导最大似然估计，最后使用贝叶斯方法和一个先验来求得初始浓度 $X_0$ 的最大后验 (MAP) 估计。\n\n**第一部分：结构不可辨识性**\n\n该模型用常微分方程 $\\frac{dX}{dt}=-\\lambda X$ 描述浓度 $X(t)$ 的动态变化，其中 $\\lambda0$ 是已知的衰减率，而 $X_0=X(0)0$ 是未知的初始浓度。该常微分方程的解已给出，为 $X(t)=X_0\\exp(-\\lambda t)$。\n\n测量输出由 $y(t)=\\alpha X(t)+\\varepsilon(t)$ 给出，其中 $\\alpha0$ 是一个未知的比例因子，$\\varepsilon(t)$ 是测量噪声。代入 $X(t)$ 的解，模型的无噪声输出预测为：\n$$ y(t) = \\alpha \\left( X_0 \\exp(-\\lambda t) \\right) = (\\alpha X_0) \\exp(-\\lambda t) $$\n我们定义一个新的集总参数 $\\eta = \\alpha X_0$。那么无噪声输出的模型可以写成：\n$$ y(t) = \\eta \\exp(-\\lambda t) $$\n模型输出仅通过其乘积 $\\eta$ 依赖于参数 $\\alpha$ 和 $X_0$。结构可辨识性关注的是在给定完美的无噪声数据下参数的唯一性。在这种情况下，任何一组测量值 $\\{y(t_i)\\}_i$ 只能用于确定 $\\eta$ 的值。我们无法唯一地分别确定 $\\alpha$ 和 $X_0$。\n\n这种不可辨识性源于一种尺度对称性。对于任何常数 $c0$，我们可以定义一组新参数 $(\\alpha', X_0')$ 如下：\n$$ \\alpha' = c\\alpha \\quad \\text{和} \\quad X_0' = \\frac{X_0}{c} $$\n这些新参数的乘积是不变的：\n$$ \\eta' = \\alpha' X_0' = (c\\alpha)\\left(\\frac{X_0}{c}\\right) = \\alpha X_0 = \\eta $$\n由于对于双曲线上 $\\alpha X_0 = \\eta$ 的任何一对 $(\\alpha, X_0)$，模型输出都是相同的，因此存在无穷多组解 $(\\alpha, X_0)$ 能产生相同的无噪声数据。因此，参数 $\\alpha$ 和 $X_0$ 是结构不可辨识的。\n\n**第二部分：$\\eta$ 的最大似然估计**\n\n给定数据 $\\{ (t_i, y_i) \\}_{i=1}^M$ 并假设噪声为均值为零的独立同分布高斯噪声，参数的似然函数正比于：\n$$ L(\\alpha, X_0 | \\{y_i\\}) \\propto \\exp\\left(-\\frac{1}{2\\sigma^2}\\sum_{i=1}^M \\left(y_i - \\alpha X_0 \\exp(-\\lambda t_i)\\right)^2\\right) $$\n如第一部分所述，似然函数仅通过乘积 $\\eta = \\alpha X_0$ 依赖于 $\\alpha$ 和 $X_0$。我们定义 $w_i = \\exp(-\\lambda t_i)$。$\\eta$ 的似然函数为：\n$$ L(\\eta | \\{y_i\\}) \\propto \\exp\\left(-\\frac{1}{2\\sigma^2}\\sum_{i=1}^M (y_i - \\eta w_i)^2\\right) $$\n最大化似然函数 $L(\\eta)$ 等价于最小化其负对数。对数似然函数为：\n$$ \\ln L(\\eta) = C - \\frac{1}{2\\sigma^2} \\sum_{i=1}^M (y_i - \\eta w_i)^2 $$\n其中 $C$ 是一个常数。这又等价于最小化误差平方和项：\n$$ S(\\eta) = \\sum_{i=1}^M (y_i - \\eta w_i)^2 $$\n为了找到使 $S(\\eta)$ 最小的 $\\eta$ 值，我们计算其关于 $\\eta$ 的导数并令其为零。\n$$ \\frac{dS}{d\\eta} = \\sum_{i=1}^M \\frac{d}{d\\eta}(y_i - \\eta w_i)^2 = \\sum_{i=1}^M 2(y_i - \\eta w_i)(-w_i) = -2 \\sum_{i=1}^M (y_i w_i - \\eta w_i^2) $$\n为求最大似然估计 $\\widehat{\\eta}$，将导数设为零：\n$$ -2 \\sum_{i=1}^M (y_i w_i - \\widehat{\\eta} w_i^2) = 0 $$\n$$ \\sum_{i=1}^M y_i w_i - \\widehat{\\eta} \\sum_{i=1}^M w_i^2 = 0 $$\n求解 $\\widehat{\\eta}$：\n$$ \\widehat{\\eta} \\sum_{i=1}^M w_i^2 = \\sum_{i=1}^M y_i w_i $$\n$$ \\widehat{\\eta} = \\frac{\\sum_{i=1}^M y_i w_i}{\\sum_{i=1}^M w_i^2} $$\n将 $w_i = \\exp(-\\lambda t_i)$ 的定义代回，我们得到 $\\eta$ 的最大似然估计：\n$$ \\widehat{\\eta} = \\frac{\\sum_{i=1}^M y_i \\exp(-\\lambda t_i)}{\\sum_{i=1}^M \\exp(-2\\lambda t_i)} $$\n\n**第三部分：$X_0$ 的最大后验 (MAP) 估计**\n\n为了解决不可辨识性问题，我们对其中一个参数引入先验分布。我们给定 $\\alpha$ 的一个对数正态先验，记为 $\\ln \\alpha \\sim \\mathcal{N}(\\mu, \\sigma_{\\alpha}^2)$。目标是找到 $X_0$ 的 MAP 估计，记为 $X_0^{\\mathrm{MAP}}$。\n\n参数的后验概率正比于似然函数与先验概率的乘积：\n$$ p(\\alpha, X_0 | \\{y_i\\}) \\propto p(\\{y_i\\} | \\alpha, X_0) \\, p(\\alpha) \\, p(X_0) $$\n假设 $X_0$ 的先验为无信息先验（均匀分布），则 $p(X_0)$ 是一个常数。MAP 估计涉及最大化这个后验概率，这等价于最小化其负对数。需要最小化的负对数后验（不计常数项）是：\n$$ J(\\alpha, X_0) = -\\ln(L(\\alpha, X_0)) - \\ln(p(\\alpha)) $$\n$\\ln \\alpha$ 的先验对应于概率密度函数 $p(\\ln \\alpha) \\propto \\exp\\left(-\\frac{(\\ln \\alpha - \\mu)^2}{2\\sigma_{\\alpha}^2}\\right)$。$\\alpha$ 的概率密度函数通过变量替换得到，$p(\\alpha) = p(\\ln \\alpha) |\\frac{d(\\ln \\alpha)}{d\\alpha}| = \\frac{1}{\\alpha} p(\\ln \\alpha)$。\n因此，$-\\ln(p(\\alpha)) = \\ln\\alpha - \\ln(p(\\ln \\alpha)) + \\text{const} = \\ln\\alpha + \\frac{(\\ln \\alpha - \\mu)^2}{2\\sigma_{\\alpha}^2} + \\text{const}$。\n需要最小化的完整目标函数是：\n$$ J(\\alpha, X_0) = \\frac{1}{2\\sigma^2} \\sum_{i=1}^M (y_i - \\alpha X_0 w_i)^2 + \\ln\\alpha + \\frac{(\\ln \\alpha - \\mu)^2}{2\\sigma_{\\alpha}^2} $$\n我们通过将关于 $X_0$ 和 $\\alpha$ 的偏导数设为零来找到最小值。\n首先，对 $X_0$ 求偏导：\n$$ \\frac{\\partial J}{\\partial X_0} = \\frac{1}{\\sigma^2} \\sum_{i=1}^M (y_i - \\alpha X_0 w_i)(-\\alpha w_i) = 0 $$\n对于 $\\alpha \\neq 0$，这简化为 $\\sum_{i=1}^M (y_i w_i - \\alpha X_0 w_i^2) = 0$，从而得到：\n$$ \\alpha X_0 = \\frac{\\sum_{i=1}^M y_i w_i}{\\sum_{i=1}^M w_i^2} = \\widehat{\\eta} $$\n这表明任何 MAP 估计 $(\\alpha^{\\mathrm{MAP}}, X_0^{\\mathrm{MAP}})$ 都必须位于由条件 $\\alpha X_0 = \\widehat{\\eta}$ 定义的“似然脊线”上。\n\n接下来，我们对 $\\alpha$ 求偏导：\n$$ \\frac{\\partial J}{\\partial \\alpha} = \\frac{1}{\\sigma^2} \\sum_{i=1}^M (y_i - \\alpha X_0 w_i)(-X_0 w_i) + \\frac{1}{\\alpha} + \\frac{2(\\ln \\alpha - \\mu)}{2\\sigma_{\\alpha}^2}\\frac{1}{\\alpha} = 0 $$\n$$ \\frac{-X_0}{\\sigma^2} \\sum_{i=1}^M (y_i w_i - \\alpha X_0 w_i^2) + \\frac{1}{\\alpha} \\left( 1 + \\frac{\\ln\\alpha - \\mu}{\\sigma_\\alpha^2} \\right) = 0 $$\n根据第一个导数条件，我们知道在最优点 $\\sum (y_i w_i - \\alpha X_0 w_i^2) = 0$。因此，第一项消失：\n$$ 0 + \\frac{1}{\\alpha} \\left( 1 + \\frac{\\ln\\alpha - \\mu}{\\sigma_\\alpha^2} \\right) = 0 $$\n因为 $\\alpha  0$，我们可以两边乘以 $\\alpha$ 并求解 $\\ln\\alpha$：\n$$ 1 + \\frac{\\ln\\alpha - \\mu}{\\sigma_\\alpha^2} = 0 \\implies \\ln\\alpha - \\mu = -\\sigma_\\alpha^2 \\implies \\ln(\\alpha^{\\mathrm{MAP}}) = \\mu - \\sigma_\\alpha^2 $$\n因此 $\\alpha$ 的 MAP 估计是 $\\alpha^{\\mathrm{MAP}} = \\exp(\\mu - \\sigma_\\alpha^2)$。\n\n最后，我们使用脊线条件 $\\alpha^{\\mathrm{MAP}} X_0^{\\mathrm{MAP}} = \\widehat{\\eta}$ 来求 $X_0^{\\mathrm{MAP}}$：\n$$ X_0^{\\mathrm{MAP}} = \\frac{\\widehat{\\eta}}{\\alpha^{\\mathrm{MAP}}} = \\frac{1}{\\exp(\\mu - \\sigma_\\alpha^2)} \\left( \\frac{\\sum_{i=1}^M y_i \\exp(-\\lambda t_i)}{\\sum_{i=1}^M \\exp(-2\\lambda t_i)} \\right) $$\n简化指数项，得到初始浓度 MAP 估计的最终表达式：\n$$ X_0^{\\mathrm{MAP}} = \\exp(-\\mu + \\sigma_{\\alpha}^2) \\frac{\\sum_{i=1}^M y_i \\exp(-\\lambda t_i)}{\\sum_{i=1}^M \\exp(-2\\lambda t_i)} $$",
            "answer": "$$\\boxed{\\exp(-\\mu + \\sigma_{\\alpha}^2) \\frac{\\sum_{i=1}^M y_i \\exp(-\\lambda t_i)}{\\sum_{i=1}^M \\exp(-2\\lambda t_i)}}$$"
        }
    ]
}