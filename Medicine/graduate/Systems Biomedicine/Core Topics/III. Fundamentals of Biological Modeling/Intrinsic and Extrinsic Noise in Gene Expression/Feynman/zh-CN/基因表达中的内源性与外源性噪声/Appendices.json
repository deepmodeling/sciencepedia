{
    "hands_on_practices": [
        {
            "introduction": "分离内在和外在噪声的贡献是定量生物学中的一个核心挑战。本练习为双报告基因实验（一种为此目的设计的基石实验技术）奠定了统计学基础。通过推导内在和外在噪声方差的无偏估计量，您将深入理解如何利用两个相同报告基因的关联和非关联波动，在数学上分离并量化这两种截然不同的细胞变异来源 。",
            "id": "4357122",
            "problem": "在基因表达的双报告基因检测中，于同一细胞内测量两个受相同调控的荧光报告基因，以将总变异分解为内在和外在组分。考虑一个由 $N$ 个独立细胞组成的群体，索引为 $i \\in \\{1,\\dots,N\\}$，两个报告基因的测量表达水平分别为 $X_i$ 和 $Y_i$。假设以下基于系统生物医学基因表达变异性观点的机制性分解：每个细胞都有一个潜在的外在状态 $M_i$，它以加性且相同的方式影响两个报告基因，并且每个报告基因在细胞内都有其自身的内在波动。形式上，假设\n$$\nX_i \\;=\\; M_i \\;+\\; \\epsilon_{x,i}, \n\\qquad\nY_i \\;=\\; M_i \\;+\\; \\epsilon_{y,i},\n$$\n其中，细胞在索引 $i$ 上是独立的，外在状态 $\\{M_i\\}$ 是独立同分布的，其均值为 $\\mu_m$，方差为 $\\sigma_{e}^{2}$，内在波动 $\\{\\epsilon_{x,i}\\}$ 和 $\\{\\epsilon_{y,i}\\}$ 是独立同分布的，其均值为零，方差为 $\\sigma_{i}^{2}$，并且对于每个 $i$，$(M_i,\\epsilon_{x,i},\\epsilon_{y,i})$ 是相互独立的。进一步假设联合高斯性，使得 $(X_i,Y_i)$ 是协方差矩阵为 $\\Sigma$ 的二元正态分布，且样本协方差矩阵服从 Wishart 分布。\n\n将内在噪声定义为可归因于细胞内报告基因特异性波动的方差组分，将外在噪声定义为可归因于潜在状态的细胞间变异的方差组分。使用上述机制性假设，并仅利用关于正态样本的基础统计事实，根据观测数据 $\\{(X_i,Y_i)\\}_{i=1}^{N}$ 推导出内在方差 $\\sigma_{i}^{2}$ 和外在方差 $\\sigma_{e}^{2}$ 的无偏估计量。然后，在联合高斯假设下，推导出这些估计量的抽样方差 $\\operatorname{Var}(\\widehat{\\sigma}_{i}^{2})$ 和 $\\operatorname{Var}(\\widehat{\\sigma}_{e}^{2})$，作为总体参数 $\\sigma_{i}^{2}$ 和 $\\sigma_{e}^{2}$ 以及样本大小 $N$ 的函数。\n\n你的最终答案必须是一个单行矩阵，按顺序包含 $\\sigma_{i}^{2}$ 的无偏估计量、$\\sigma_{e}^{2}$ 的无偏估计量、内在估计量的抽样方差以及外在估计量的抽样方差，每个都以封闭形式表示。不需要数值近似或四舍五入。使用分母为 $N-1$ 的传统样本均值和无偏样本方差及协方差定义。",
            "solution": "双报告基因的构造为将变异分解为内在和外在组分提供了一个机制上合理的解释。其基本基础是加性模型\n$$\nX_i \\;=\\; M_i \\;+\\; \\epsilon_{x,i}, \n\\qquad\nY_i \\;=\\; M_i \\;+\\; \\epsilon_{y,i},\n$$\n其中 $M_i$ 代表外在的细胞间波动，而 $\\epsilon_{x,i},\\epsilon_{y,i}$ 代表同一细胞内内在的报告基因特异性波动。根据独立性和相同调控，我们有\n$$\n\\mathbb{E}[M_i] \\;=\\; \\mu_m, \\quad \\operatorname{Var}(M_i) \\;=\\; \\sigma_{e}^{2},\n\\quad \\mathbb{E}[\\epsilon_{x,i}] \\;=\\; \\mathbb{E}[\\epsilon_{y,i}] \\;=\\; 0,\n\\quad \\operatorname{Var}(\\epsilon_{x,i}) \\;=\\; \\operatorname{Var}(\\epsilon_{y,i}) \\;=\\; \\sigma_{i}^{2},\n$$\n并且对于每个 $i$，$(M_i,\\epsilon_{x,i},\\epsilon_{y,i})$ 是相互独立的，且在细胞 $i$ 之间也是独立的。\n\n根据这些定义，\n$$\n\\operatorname{Var}(X_i) \\;=\\; \\operatorname{Var}(M_i) + \\operatorname{Var}(\\epsilon_{x,i}) \\;=\\; \\sigma_{e}^{2} + \\sigma_{i}^{2},\n$$\n$$\n\\operatorname{Var}(Y_i) \\;=\\; \\sigma_{e}^{2} + \\sigma_{i}^{2},\n\\qquad\n\\operatorname{Cov}(X_i,Y_i) \\;=\\; \\operatorname{Var}(M_i) \\;=\\; \\sigma_{e}^{2}.\n$$\n定义细胞内差异 $D_i = X_i - Y_i$。那么\n$$\n\\mathbb{E}[D_i] \\;=\\; \\mathbb{E}[X_i - Y_i] \\;=\\; \\mathbb{E}[M_i + \\epsilon_{x,i} - M_i - \\epsilon_{y,i}] \\;=\\; 0,\n$$\n并且，利用 $\\epsilon_{x,i}$ 和 $\\epsilon_{y,i}$ 的独立性，\n$$\n\\operatorname{Var}(D_i) \\;=\\; \\operatorname{Var}(X_i - Y_i) \\;=\\; \\operatorname{Var}(\\epsilon_{x,i} - \\epsilon_{y,i})\n\\;=\\; \\operatorname{Var}(\\epsilon_{x,i}) + \\operatorname{Var}(\\epsilon_{y,i})\n\\;=\\; 2 \\sigma_{i}^{2}.\n$$\n因此，内在方差组分为 $\\sigma_{i}^{2} = \\frac{1}{2} \\operatorname{Var}(D_i)$，而外在方差组分是两个报告基因的协方差，即 $\\sigma_{e}^{2} = \\operatorname{Cov}(X_i,Y_i)$。\n\n给定观测数据 $\\{(X_i,Y_i)\\}_{i=1}^{N}$，令\n$$\n\\bar{X} = \\frac{1}{N} \\sum_{i=1}^{N} X_i, \n\\quad\n\\bar{Y} = \\frac{1}{N} \\sum_{i=1}^{N} Y_i,\n\\quad\nD_i = X_i - Y_i,\n\\quad\n\\bar{D} = \\frac{1}{N} \\sum_{i=1}^{N} D_i = \\bar{X} - \\bar{Y}.\n$$\n定义差异的无偏样本方差和报告基因的无偏样本协方差为\n$$\ns_{D}^{2} = \\frac{1}{N-1} \\sum_{i=1}^{N} (D_i - \\bar{D})^{2},\n\\qquad\ns_{XY} = \\frac{1}{N-1} \\sum_{i=1}^{N} (X_i - \\bar{X})(Y_i - \\bar{Y}).\n$$\n根据独立同分布样本的无偏样本方差和协方差估计量的标准性质，\n$$\n\\mathbb{E}[s_{D}^{2}] = \\operatorname{Var}(D_i) = 2 \\sigma_{i}^{2},\n\\qquad\n\\mathbb{E}[s_{XY}] = \\operatorname{Cov}(X_i,Y_i) = \\sigma_{e}^{2}.\n$$\n因此，内在和外在方差组分的无偏估计量为\n$$\n\\widehat{\\sigma}_{i}^{2} = \\frac{1}{2} \\, s_{D}^{2} = \\frac{1}{2(N-1)} \\sum_{i=1}^{N} (D_i - \\bar{D})^{2},\n\\qquad\n\\widehat{\\sigma}_{e}^{2} = s_{XY} = \\frac{1}{N-1} \\sum_{i=1}^{N} (X_i - \\bar{X})(Y_i - \\bar{Y}).\n$$\n\n我们现在在联合高斯假设下推导这些估计量的抽样方差。对于内在估计量，注意到 $D_i$ 是独立且服从均值为 $0$、方差为 $\\sigma_{D}^{2} = \\operatorname{Var}(D_i) = 2 \\sigma_{i}^{2}$ 的正态分布。缩放后的样本方差服从卡方分布：\n$$\n\\frac{(N-1)\\, s_{D}^{2}}{\\sigma_{D}^{2}} \\sim \\chi^{2}_{N-1}.\n$$\n自由度为 $k$ 的卡方随机变量的方差为 $2k$，因此\n$$\n\\operatorname{Var}\\!\\left( (N-1) s_{D}^{2} \\right) = 2 (N-1) \\sigma_{D}^{4},\n$$\n两边除以 $(N-1)^{2}$ 得到\n$$\n\\operatorname{Var}\\!\\left( s_{D}^{2} \\right) = \\frac{2 \\sigma_{D}^{4}}{N-1}.\n$$\n代入 $\\sigma_{D}^{2} = 2 \\sigma_{i}^{2}$ 得到 $\\sigma_{D}^{4} = 4 \\sigma_{i}^{4}$ 以及\n$$\n\\operatorname{Var}\\!\\left( s_{D}^{2} \\right) = \\frac{2 \\cdot 4 \\sigma_{i}^{4}}{N-1} = \\frac{8 \\sigma_{i}^{4}}{N-1}.\n$$\n由于 $\\widehat{\\sigma}_{i}^{2} = \\frac{1}{2} s_{D}^{2}$，因此\n$$\n\\operatorname{Var}\\!\\left( \\widehat{\\sigma}_{i}^{2} \\right) = \\frac{1}{4} \\operatorname{Var}\\!\\left( s_{D}^{2} \\right) = \\frac{1}{4} \\cdot \\frac{8 \\sigma_{i}^{4}}{N-1} = \\frac{2 \\sigma_{i}^{4}}{N-1}.\n$$\n\n对于外在估计量，考虑无偏样本协方差 $s_{XY}$。在二元正态假设下，协方差矩阵为\n$$\n\\Sigma = \\begin{pmatrix}\n\\sigma_{x}^{2}  \\sigma_{xy} \\\\\n\\sigma_{xy}  \\sigma_{y}^{2}\n\\end{pmatrix}\n= \\begin{pmatrix}\n\\sigma_{e}^{2} + \\sigma_{i}^{2}  \\sigma_{e}^{2} \\\\\n\\sigma_{e}^{2}  \\sigma_{e}^{2} + \\sigma_{i}^{2}\n\\end{pmatrix},\n$$\n缩放后的样本协方差矩阵 $(N-1)\\, S$（其中 $S$ 的元素为 $s_{XX}, s_{XY}, s_{YY}$）服从 Wishart 分布 $\\mathcal{W}_{2}(N-1, \\Sigma)$。一个经过充分检验的 Wishart 分布公式给出，对于非对角线元素，\n$$\n\\operatorname{Var}\\!\\left( s_{XY} \\right) = \\frac{1}{N-1} \\left( \\sigma_{xy}^{2} + \\sigma_{x}^{2} \\sigma_{y}^{2} \\right).\n$$\n代入 $\\sigma_{xy} = \\sigma_{e}^{2}$ 和 $\\sigma_{x}^{2} = \\sigma_{y}^{2} = \\sigma_{e}^{2} + \\sigma_{i}^{2}$，我们得到\n$$\n\\operatorname{Var}\\!\\left( \\widehat{\\sigma}_{e}^{2} \\right) = \\operatorname{Var}\\!\\left( s_{XY} \\right) = \\frac{1}{N-1} \\left( \\sigma_{e}^{4} + (\\sigma_{e}^{2} + \\sigma_{i}^{2})^{2} \\right)\n= \\frac{1}{N-1} \\left( 2 \\sigma_{e}^{4} + 2 \\sigma_{e}^{2} \\sigma_{i}^{2} + \\sigma_{i}^{4} \\right).\n$$\n\n汇总结果，无偏估计量及其抽样方差为：\n$$\n\\widehat{\\sigma}_{i}^{2} = \\frac{1}{2(N-1)} \\sum_{i=1}^{N} (X_i - Y_i - \\bar{X} + \\bar{Y})^{2},\n\\qquad\n\\widehat{\\sigma}_{e}^{2} = \\frac{1}{N-1} \\sum_{i=1}^{N} (X_i - \\bar{X})(Y_i - \\bar{Y}),\n$$\n$$\n\\operatorname{Var}\\!\\left( \\widehat{\\sigma}_{i}^{2} \\right) = \\frac{2 \\sigma_{i}^{4}}{N-1},\n\\qquad\n\\operatorname{Var}\\!\\left( \\widehat{\\sigma}_{e}^{2} \\right) = \\frac{2 \\sigma_{e}^{4} + 2 \\sigma_{e}^{2} \\sigma_{i}^{2} + \\sigma_{i}^{4}}{N-1}.\n$$\n这些表达式根据内在和外在方差组分以及样本大小来量化估计量的精度。",
            "answer": "$$\\boxed{\\begin{pmatrix}\n\\frac{1}{2(N-1)} \\sum_{i=1}^{N} (X_i - Y_i - \\bar{X} + \\bar{Y})^{2} \n\\frac{1}{N-1} \\sum_{i=1}^{N} (X_i - \\bar{X})(Y_i - \\bar{Y}) \n\\frac{2 \\sigma_{i}^{4}}{N-1} \n\\frac{2 \\sigma_{e}^{4} + 2 \\sigma_{e}^{2} \\sigma_{i}^{2} + \\sigma_{i}^{4}}{N-1}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然双报告基因实验功能强大，但单细胞蛋白质组学等现代高通量技术可同时测量数千种蛋白质，为我们提供了细胞状态的全局视图。本实践探讨了如何在没有关于其来源的先验假设的情况下，从此类高维数据中识别外在噪声的主要来源。您将在合成数据上实施主成分分析（PCA）工作流程，并运用随机矩阵理论的原理来区分显著的共享变异轴和随机噪声，这是现代系统生物学数据分析的一项基本技能 。",
            "id": "4357150",
            "problem": "给定一个关于多细胞中多种蛋白质的单细胞蛋白质组学概念模型，其中每个细胞测得的蛋白质丰度受两种变异性的影响：内在噪声（对每个基因或蛋白质具有特异性，且在蛋白质之间不相关）和外在噪声（共同调节许多蛋白质的共享细胞因子）。本问题要求您基于加刺协方差模型和随机矩阵理论，形式化并实现一个流程，以识别主导的外在轴，并使用主成分分析（PCA (Principal Component Analysis)）量化其对总方差的贡献。\n\n假设数据矩阵 $\\mathbf{X} \\in \\mathbb{R}^{N \\times P}$ 的生成模型如下，其中 $N$ 是细胞数量，$P$ 是蛋白质数量：\n1. 内在变异性和测量变异性被建模为各向同性高斯噪声 $\\mathbf{Z} \\in \\mathbb{R}^{N \\times P}$，其条目独立且具有单位方差，即 $\\mathbf{Z}_{ij} \\sim \\mathcal{N}(0,1)$。\n2. 外在变异性被建模为低秩因子模型：$\\mathbf{F} \\in \\mathbb{R}^{N \\times r}$，其条目独立，$\\mathbf{F}_{ik} \\sim \\mathcal{N}(0,1)$，以及一个蛋白质载荷矩阵 $\\mathbf{L} \\in \\mathbb{R}^{P \\times r}$，使得 $\\mathbf{L} \\mathbf{L}^{\\top}$ 的秩为 $r$，非零特征值为 $\\{\\beta_1,\\ldots,\\beta_r\\}$（称为群体刺强度）。\n3. 观测到的中心化数据生成如下\n$$\n\\mathbf{X} \\;=\\; \\mathbf{Z} \\;+\\; \\mathbf{F}\\mathbf{L}^{\\top} \\,,\n$$\n然后按蛋白质进行中心化（每种蛋白质在所有细胞中的均值为零）。在此模型下，蛋白质间的群体协方差为\n$$\n\\boldsymbol{\\Sigma} \\;=\\; \\mathbb{E}\\left[\\frac{1}{N}\\mathbf{X}^{\\top}\\mathbf{X}\\right] \\;=\\; \\mathbf{I}_P \\;+\\; \\mathbf{L}\\mathbf{L}^{\\top},\n$$\n因此，外在轴对应于与各向同性基线 $1$ 之上的 $r$ 个刺 $\\{1+\\beta_k\\}$ 相关联的特征向量。\n\n给定根据中心化数据计算的样本协方差估计量\n$$\n\\mathbf{S} \\;=\\; \\frac{1}{N-1}\\,\\mathbf{X}^{\\top}\\mathbf{X} \\;\\in\\; \\mathbb{R}^{P \\times P},\n$$\n主成分分析（PCA）通过特征值 $\\lambda_1 \\ge \\lambda_2 \\ge \\cdots \\ge \\lambda_P \\ge 0$ 和标准正交特征向量对 $\\mathbf{S}$ 进行对角化。在没有外在因子（$r=0$）的情况下，随机矩阵理论（Marchenko–Pastur 定律）预测，当 $N,P \\to \\infty$ 且纵横比 $c = P/(N-1)$ 保持固定时，$\\mathbf{S}$ 的特征值分布集中在\n$$\n\\left[\\lambda_{-}, \\lambda_{+}\\right] \\;=\\; \\left[(1-\\sqrt{c})^2,\\,(1+\\sqrt{c})^2\\right].\n$$\n在有刺的情况下，与足够强的外在轴相关的特征值会从随机主体中分离出来，表现为离群值。我们将操作性地定义主导外在轴为那些样本特征值超过 Marchenko–Pastur 分布上界的主成分\n$$\n\\lambda_{+} \\;=\\; (1+\\sqrt{c})^2 \\quad \\text{其中} \\quad c \\;=\\; \\frac{P}{N-1}.\n$$\n\n您的任务是：\n1. 根据上述模型，为一小组参数设置的测试套件生成合成数据集。对于每个测试，使用固定的随机种子以确保可复现性。构造 $\\mathbf{L}$，使其具有标准正交列，并进行缩放以匹配所需的刺强度 $\\{\\beta_k\\}$，即，如果 $\\mathbf{Q} \\in \\mathbb{R}^{P \\times r}$ 具有标准正交列，则设置 $\\mathbf{L} = \\mathbf{Q}\\,\\mathrm{diag}(\\sqrt{\\beta_1},\\ldots,\\sqrt{\\beta_r})$，从而使 $\\mathbf{L}\\mathbf{L}^{\\top}$ 的非零特征值恰好为 $\\{\\beta_k\\}$。\n2. 对 $\\mathbf{X}$ 按蛋白质进行中心化（使每列均值为零），计算 $\\mathbf{S} = \\frac{1}{N-1}\\mathbf{X}^{\\top}\\mathbf{X}$，并通过对 $\\mathbf{S}$ 进行特征分解来执行 PCA。\n3. 将主导外在轴的数量 $\\hat{r}$ 识别为严格大于 $\\lambda_{+}$ 的特征值的计数。\n4. 通过报告每个 $j \\in \\{1,\\ldots,\\hat{r}\\}$ 的分数，量化每个检测到的外在轴对总方差的贡献\n$$\nf_j \\;=\\; \\frac{\\lambda_j}{\\sum_{i=1}^{P}\\lambda_i},\n$$\n四舍五入到六位小数。\n\n测试套件。对于每个案例，使用基础种子 $s_0 = 20231107$ 和每个案例的种子 $s = s_0 + \\Delta$，其中 $\\Delta$ 在下面指定。对于所有案例，如上所述，将 $\\mathbf{Z}$ 和 $\\mathbf{F}$ 的方差设置为 $1$。刺强度以列表 $\\{\\beta_k\\}$ 的形式给出（可能为空）。\n- 案例 A（理想路径）：$N = 1000$，$P = 60$，刺 $\\{\\beta_1,\\beta_2\\} = \\{2.5,\\,1.6\\}$，$\\Delta = 0$。\n- 案例 B（零边界）：$N = 800$，$P = 80$，刺为空（即 $r=0$），$\\Delta = 1$。\n- 案例 C（小 $N$ 且接近 $P$，一个强刺）：$N = 120$，$P = 100$，刺 $\\{\\beta_1,\\beta_2\\} = \\{5.0,\\,0.8\\}$，$\\Delta = 2$。\n- 案例 D（多个刺，只有一个在边界之上）：$N = 600$，$P = 50$，刺 $\\{\\beta_1,\\beta_2,\\beta_3\\} = \\{1.5,\\,0.4,\\,0.3\\}$，$\\Delta = 3$。\n\n要求的最终输出格式。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。每个测试案例贡献一个内部列表。对于每个测试案例，输出一个内部列表，其第一个元素是整数 $\\hat{r}$，后跟 $\\hat{r}$ 个浮点数，给出四舍五入到六位小数的 $f_1,\\ldots,f_{\\hat{r}}$。例如，两个案例的输出可能如下所示\n$$\n[[2,0.123456,0.078901],[0]].\n$$\n请注意，此问题中没有物理单位，也不涉及角度。所有浮点数必须在输出中四舍五入到六位小数。",
            "solution": "该问题在科学上根植于统计信号处理、随机矩阵理论（RMT）及其在系统生物学，特别是单细胞蛋白质组学中的应用。它概述了一个使用加刺协方差模型来区分结构化的外在变异性与非结构化的内在噪声的流程。任务是适定的，具有明确定义的生成模型、确定性分析流程以及用于测试的特定、客观的参数集。所有术语都经过了数学定义，问题本身是自洽的，没有矛盾或歧义。\n\n在此，我们遵循用户的形式要求，提供一个有原则的、分步的解决方案。\n\n### 方法论框架\n\n核心任务是在一个合成的单细胞蛋白质组学数据集中，识别并量化主导的外在变异因子的贡献。该方法基于加刺协方差模型，并利用随机矩阵理论的结果来建立一个显著性阈值。整个过程分为四个主要阶段：数据生成、协方差估计与PCA、显著成分的识别，以及方差贡献的量化。\n\n#### 1. 合成数据生成\n\n我们首先根据指定的生成模型生成一个合成数据矩阵 $\\mathbf{X} \\in \\mathbb{R}^{N \\times P}$，其中 $N$ 是细胞数量，$P$ 是蛋白质数量：\n$$\n\\mathbf{X} \\;=\\; \\mathbf{Z} \\;+\\; \\mathbf{F}\\mathbf{L}^{\\top}\n$$\n- 项 $\\mathbf{Z} \\in \\mathbb{R}^{N \\times P}$ 代表内在噪声和测量误差。它被建模为一个由独立同分布随机变量组成的矩阵，其中每个条目 $\\mathbf{Z}_{ij}$ 均从标准正态分布中抽取，即 $\\mathbf{Z}_{ij} \\sim \\mathcal{N}(0,1)$。\n- 项 $\\mathbf{F}\\mathbf{L}^{\\top}$ 代表由 $r$ 个共享细胞因子引起的外在变异性。\n  - $\\mathbf{F} \\in \\mathbb{R}^{N \\times r}$ 是因子得分矩阵，其条目 $\\mathbf{F}_{ik}$ 也从标准正态分布中抽取，即 $\\mathbf{F}_{ik} \\sim \\mathcal{N}(0,1)$。\n  - $\\mathbf{L} \\in \\mathbb{R}^{P \\times r}$ 是蛋白质载荷矩阵。它的构造旨在将一个特定的特征谱嵌入到群体协方差中。我们首先通过对一个随机 $P \\times r$ 矩阵进行 QR 分解，生成一个具有标准正交列的矩阵 $\\mathbf{Q} \\in \\mathbb{R}^{P \\times r}$。然后，给定一组期望的群体刺强度 $\\{\\beta_1, \\ldots, \\beta_r\\}$，我们设置 $\\mathbf{L} = \\mathbf{Q} \\, \\mathrm{diag}(\\sqrt{\\beta_1}, \\ldots, \\sqrt{\\beta_r})$。这种构造确保矩阵 $\\mathbf{L}\\mathbf{L}^{\\top} = \\mathbf{Q} \\, \\mathrm{diag}(\\beta_1, \\ldots, \\beta_r) \\, \\mathbf{Q}^{\\top}$ 恰好具有所需的非零特征值 $\\{\\beta_k\\}$。\n- 在没有外在因子（$r=0$）的零假设情况下，`spikes` 列表为空，项 $\\mathbf{F}\\mathbf{L}^{\\top}$ 是一个零矩阵，从而导致 $\\mathbf{X} = \\mathbf{Z}$。\n- 为保证可复现性，对于每个测试案例，伪随机数生成器都使用一个特定的值 $s = s_0 + \\Delta$ 进行种子设定，其中 $s_0 = 20231107$。\n\n#### 2. 协方差估计和主成分分析 (PCA)\n\n原始数据矩阵 $\\mathbf{X}$ 首先进行中心化，以使每种蛋白质（每列）的均值为零。设 $\\mathbf{X}_{\\text{c}}$ 为中心化矩阵，其中 $(\\mathbf{X}_{\\text{c}})_{ij} = \\mathbf{X}_{ij} - \\frac{1}{N}\\sum_{k=1}^{N} \\mathbf{X}_{kj}$。\n\n从中心化数据中，我们使用无偏估计量计算样本协方差矩阵 $\\mathbf{S} \\in \\mathbb{R}^{P \\times P}$：\n$$\n\\mathbf{S} \\;=\\; \\frac{1}{N-1}\\mathbf{X}_{\\text{c}}^{\\top}\\mathbf{X}_{\\text{c}}\n$$\n然后通过计算 $\\mathbf{S}$ 的特征分解来执行主成分分析。由于 $\\mathbf{S}$ 是一个实对称矩阵，它有 $P$ 个实数、非负的特征值，我们按降序表示为 $\\lambda_1 \\ge \\lambda_2 \\ge \\cdots \\ge \\lambda_P \\ge 0$。这些特征值代表每个主成分所捕获的方差。\n\n#### 3. 识别主导的外在轴\n\n为了区分对应于真实外在因子的特征值和纯粹由随机噪声产生的特征值，我们采用了随机矩阵理论的一个结果。Marchenko-Pastur (MP) 定律描述了由纯随机数据构成的样本协方差矩阵特征值的极限分布。对于一个由均值为零、方差为一的独立同分布随机变量组成的矩阵，在极限 $N, P \\to \\infty$ 且固定纵横比 $c = P/(N-1)$ 的情况下，$\\mathbf{S}$ 的特征值谱收敛到一个支撑在区间 $[\\lambda_{-}, \\lambda_{+}]$ 上的连续分布，其中：\n$$\n\\lambda_{-} = (1-\\sqrt{c})^2 \\quad \\text{和} \\quad \\lambda_{+} = (1+\\sqrt{c})^2\n$$\n值 $\\lambda_{+}$ 作为噪声产生的主体特征值的理论上界。任何严格位于此阈值之上的样本特征值 $\\lambda_j  \\lambda_{+}$，都被认为是对应于一个非随机的、结构化的变异源的“刺”——在我们的模型中，即一个主导的外在轴。我们计算此类特征值的数量，以确定检测到的主导轴的数量 $\\hat{r}$。\n\n#### 4. 方差贡献的量化\n\n对于 $\\hat{r}$ 个已识别的主导轴中的每一个，我们量化其对数据中观测到的总方差的贡献。总方差是所有特征值的总和，等于样本协方差矩阵的迹，即 $\\mathrm{Tr}(\\mathbf{S}) = \\sum_{i=1}^{P}\\lambda_i$。因此，第 $j$ 个主成分的比例贡献为：\n$$\nf_j \\;=\\; \\frac{\\lambda_j}{\\sum_{i=1}^{P}\\lambda_i}\n$$\n每个案例的最终结果包括整数计数 $\\hat{r}$，后跟 $\\hat{r}$ 个比例方差贡献 $\\{f_1, \\ldots, f_{\\hat{r}}\\}$，每个分数都四舍五入到六位小数。\n\n### 实现\n\n该流程使用 Python 中的 `numpy` 库实现所有数值运算。单个函数封装了每个测试案例的逻辑：它使用指定的参数和随机种子生成数据，计算中心化协方差矩阵，找到其特征值，应用 Marchenko-Pastur 阈值以识别刺，并计算相应的方差分数。一个主脚本遍历提供的测试套件，调用此函数，并将收集到的结果格式化为指定的单个输出字符串。",
            "answer": "$$[[2,0.049449,0.038161],[0],[1,0.054366],[1,0.033527]]$$"
        }
    ]
}