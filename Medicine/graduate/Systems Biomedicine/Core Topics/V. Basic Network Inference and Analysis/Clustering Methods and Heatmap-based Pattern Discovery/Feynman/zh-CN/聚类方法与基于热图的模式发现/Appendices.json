{
    "hands_on_practices": [
        {
            "introduction": "层次聚类是发现组学数据中潜在模式的基石方法之一，而Ward连锁法因其旨在最小化簇内方差的特性而被广泛使用。要真正掌握Ward连锁法，关键在于理解其每一步合并决策背后的量化标准。本练习将引导你亲手计算簇合并所引起的总簇内平方误差和（SSE）的增量，从而让你从根本上理解Ward算法是如何构建聚类树的。",
            "id": "4328388",
            "problem": "一项系统生物医学中的高通量转录组学研究生成了一个标准化的热图，该热图展示了跨越三个生物轴的基因表达，这三个轴代表了聚合的通路活性得分。数据按基因进行了 $z$-score 标准化，使得所有变量都无量纲。初步的层次聚类已生成了三个不重叠的样本簇，其簇的大小和质心（在三维通路空间中）由 $n_1 = 12$，$n_2 = 18$，$n_3 = 10$ 和下式给出：\n$$\n\\boldsymbol{m}_1 = (0.5,\\,-0.2,\\,1.1),\\quad \\boldsymbol{m}_2 = (0.4,\\,-0.1,\\,0.9),\\quad \\boldsymbol{m}_3 = (-0.6,\\,0.3,\\,0.2).\n$$\n考虑使用 Ward 联动法的凝聚式层次聚类，该方法在每一步合并导致簇内平方误差和 (SSE) 增加最小的一对簇。令 $J$ 表示总的簇内平方误差和，\n$$\nJ \\equiv \\sum_{c} \\sum_{i \\in c} \\|\\boldsymbol{x}_i - \\boldsymbol{m}_c\\|_2^{2},\n$$\n其中 $\\|\\cdot\\|_2$ 是欧几里得范数，$\\boldsymbol{x}_i$ 是样本 $i$ 的特征向量，$\\boldsymbol{m}_c$ 是簇 $c$ 的质心。假设在给定的特征空间中为欧几里得几何，并且质心由算术平均值定义。\n\n仅以上述定义为基础，确定 Ward 联动法接下来将执行的单次合并，并计算此次合并导致的 $J$ 的相应增量。仅报告 $J$ 的最小增量，结果为一个实数。将您的答案四舍五入到四位有效数字。量 $J$ 是无量纲的。",
            "solution": "问题要求确定在使用 Ward 联动法的凝聚式层次聚类过程中的下一次合并，并计算总簇内平方误差和 $J$ 的相关增量。初始状态包含三个簇，其大小和质心均已给出。\n\n总簇内平方误差和 $J$ 定义为：\n$$\nJ \\equiv \\sum_{c} \\sum_{i \\in c} \\|\\boldsymbol{x}_i - \\boldsymbol{m}_c\\|_2^{2}\n$$\n其中 $c$ 为簇的索引，$\\boldsymbol{x}_i$ 为样本 $i$ 的特征向量，$\\boldsymbol{m}_c$ 为簇 $c$ 的质心。\n\nWard 联动法的操作是合并那一对能使 $J$ 增量最小的簇 $(c_a, c_b)$。让我们推导这个增量 $\\Delta J_{ab}$ 的表达式。合并前，簇 $c_a$ 和 $c_b$ 对总 SSE 的贡献是：\n$$\nJ_{ab}^{\\text{before}} = \\sum_{i \\in c_a} \\|\\boldsymbol{x}_i - \\boldsymbol{m}_a\\|_2^{2} + \\sum_{j \\in c_b} \\|\\boldsymbol{x}_j - \\boldsymbol{m}_b\\|_2^{2}\n$$\n其中 $n_a$ 和 $n_b$ 是簇 $c_a$ 和 $c_b$ 的大小，$\\boldsymbol{m}_a$ 和 $\\boldsymbol{m}_b$ 是它们各自的质心。\n\n将 $c_a$ 和 $c_b$ 合并成一个新簇 $c_{ab}$ 后，新簇的大小为 $n_{ab} = n_a + n_b$。其质心 $\\boldsymbol{m}_{ab}$ 是新簇中所有点的算术平均值：\n$$\n\\boldsymbol{m}_{ab} = \\frac{1}{n_a + n_b} \\left( \\sum_{i \\in c_a} \\boldsymbol{x}_i + \\sum_{j \\in c_b} \\boldsymbol{x}_j \\right) = \\frac{n_a \\boldsymbol{m}_a + n_b \\boldsymbol{m}_b}{n_a + n_b}\n$$\n这个新合并簇的 SSE 是：\n$$\nJ_{ab}^{\\text{after}} = \\sum_{k \\in c_{ab}} \\|\\boldsymbol{x}_k - \\boldsymbol{m}_{ab}\\|_2^{2}\n$$\n总 SSE 的增量是 $\\Delta J_{ab} = J_{ab}^{\\text{after}} - J_{ab}^{\\text{before}}$。我们可以使用平行轴定理（也称为惠更斯-施泰纳定理或方差分解）来展开 $J_{ab}^{\\text{after}}$。对于任何均值为 $\\bar{\\boldsymbol{y}}$ 的向量集 $\\boldsymbol{y}_k$，到任意点 $\\boldsymbol{p}$ 的平方距离之和为 $\\sum_k \\|\\boldsymbol{y}_k - \\boldsymbol{p}\\|_2^2 = \\sum_k \\|\\boldsymbol{y}_k - \\bar{\\boldsymbol{y}}\\|_2^2 + N \\|\\bar{\\boldsymbol{y}} - \\boldsymbol{p}\\|_2^2$，其中 $N$ 是向量的数量。将其应用于我们合并的簇：\n$$\nJ_{ab}^{\\text{after}} = \\left( \\sum_{i \\in c_a} \\|\\boldsymbol{x}_i - \\boldsymbol{m}_a\\|_2^{2} + n_a \\|\\boldsymbol{m}_a - \\boldsymbol{m}_{ab}\\|_2^{2} \\right) + \\left( \\sum_{j \\in c_b} \\|\\boldsymbol{x}_j - \\boldsymbol{m}_b\\|_2^{2} + n_b \\|\\boldsymbol{m}_b - \\boldsymbol{m}_{ab}\\|_2^{2} \\right)\n$$\n$$\nJ_{ab}^{\\text{after}} = J_{ab}^{\\text{before}} + n_a \\|\\boldsymbol{m}_a - \\boldsymbol{m}_{ab}\\|_2^{2} + n_b \\|\\boldsymbol{m}_b - \\boldsymbol{m}_{ab}\\|_2^{2}\n$$\n因此，SSE的增量为：\n$$\n\\Delta J_{ab} = n_a \\|\\boldsymbol{m}_a - \\boldsymbol{m}_{ab}\\|_2^{2} + n_b \\|\\boldsymbol{m}_b - \\boldsymbol{m}_{ab}\\|_2^{2}\n$$\n代入 $\\boldsymbol{m}_{ab}$ 的表达式：\n$$\n\\boldsymbol{m}_a - \\boldsymbol{m}_{ab} = \\boldsymbol{m}_a - \\frac{n_a \\boldsymbol{m}_a + n_b \\boldsymbol{m}_b}{n_a + n_b} = \\frac{(n_a + n_b)\\boldsymbol{m}_a - n_a \\boldsymbol{m}_a - n_b \\boldsymbol{m}_b}{n_a + n_b} = \\frac{n_b(\\boldsymbol{m}_a - \\boldsymbol{m}_b)}{n_a + n_b}\n$$\n$$\n\\boldsymbol{m}_b - \\boldsymbol{m}_{ab} = \\boldsymbol{m}_b - \\frac{n_a \\boldsymbol{m}_a + n_b \\boldsymbol{m}_b}{n_a + n_b} = \\frac{(n_a + n_b)\\boldsymbol{m}_b - n_a \\boldsymbol{m}_a - n_b \\boldsymbol{m}_b}{n_a + n_b} = \\frac{-n_a(\\boldsymbol{m}_a - \\boldsymbol{m}_b)}{n_a + n_b}\n$$\n将这些代回 $\\Delta J_{ab}$ 的方程中：\n$$\n\\Delta J_{ab} = n_a \\left\\| \\frac{n_b(\\boldsymbol{m}_a - \\boldsymbol{m}_b)}{n_a + n_b} \\right\\|_2^{2} + n_b \\left\\| \\frac{-n_a(\\boldsymbol{m}_a - \\boldsymbol{m}_b)}{n_a + n_b} \\right\\|_2^{2}\n$$\n$$\n\\Delta J_{ab} = \\left( \\frac{n_a n_b^2}{(n_a + n_b)^2} + \\frac{n_b n_a^2}{(n_a + n_b)^2} \\right) \\|\\boldsymbol{m}_a - \\boldsymbol{m}_b\\|_2^{2} = \\frac{n_a n_b (n_b + n_a)}{(n_a + n_b)^2} \\|\\boldsymbol{m}_a - \\boldsymbol{m}_b\\|_2^{2}\n$$\n这可以简化为著名的 Ward 联动法准则公式：\n$$\n\\Delta J_{ab} = \\frac{n_a n_b}{n_a + n_b} \\|\\boldsymbol{m}_a - \\boldsymbol{m}_b\\|_2^{2}\n$$\n问题给出了簇的大小 $n_1 = 12$, $n_2 = 18$, $n_3 = 10$ 和质心 $\\boldsymbol{m}_1 = (0.5, -0.2, 1.1)$，$\\boldsymbol{m}_2 = (0.4, -0.1, 0.9)$，以及 $\\boldsymbol{m}_3 = (-0.6, 0.3, 0.2)$。我们必须为三种可能的合并情况分别计算 $\\Delta J$。\n\n1.  合并簇 $1$ 和簇 $2$：\n    权重因子为 $\\frac{n_1 n_2}{n_1 + n_2} = \\frac{12 \\times 18}{12 + 18} = \\frac{216}{30} = 7.2$。\n    质心之间的欧几里得距离平方为：\n    $\\|\\boldsymbol{m}_1 - \\boldsymbol{m}_2\\|_2^{2} = \\|(0.5 - 0.4, -0.2 - (-0.1), 1.1 - 0.9)\\|_2^{2} = \\|(0.1, -0.1, 0.2)\\|_2^{2}$\n    $\\|\\boldsymbol{m}_1 - \\boldsymbol{m}_2\\|_2^{2} = (0.1)^2 + (-0.1)^2 + (0.2)^2 = 0.01 + 0.01 + 0.04 = 0.06$。\n    SSE 的增量为 $\\Delta J_{12} = 7.2 \\times 0.06 = 0.432$。\n\n2.  合并簇 $1$ 和簇 $3$：\n    权重因子为 $\\frac{n_1 n_3}{n_1 + n_3} = \\frac{12 \\times 10}{12 + 10} = \\frac{120}{22} = \\frac{60}{11}$。\n    质心之间的欧几里得距离平方为：\n    $\\|\\boldsymbol{m}_1 - \\boldsymbol{m}_3\\|_2^{2} = \\|(0.5 - (-0.6), -0.2 - 0.3, 1.1 - 0.2)\\|_2^{2} = \\|(1.1, -0.5, 0.9)\\|_2^{2}$\n    $\\|\\boldsymbol{m}_1 - \\boldsymbol{m}_3\\|_2^{2} = (1.1)^2 + (-0.5)^2 + (0.9)^2 = 1.21 + 0.25 + 0.81 = 2.27$。\n    SSE 的增量为 $\\Delta J_{13} = \\frac{60}{11} \\times 2.27 = \\frac{136.2}{11} \\approx 12.3818$。\n\n3.  合并簇 $2$ 和簇 $3$：\n    权重因子为 $\\frac{n_2 n_3}{n_2 + n_3} = \\frac{18 \\times 10}{18 + 10} = \\frac{180}{28} = \\frac{45}{7}$。\n    质心之间的欧几里得距离平方为：\n    $\\|\\boldsymbol{m}_2 - \\boldsymbol{m}_3\\|_2^{2} = \\|(0.4 - (-0.6), -0.1 - 0.3, 0.9 - 0.2)\\|_2^{2} = \\|(1.0, -0.4, 0.7)\\|_2^{2}$\n    $\\|\\boldsymbol{m}_2 - \\boldsymbol{m}_3\\|_2^{2} = (1.0)^2 + (-0.4)^2 + (0.7)^2 = 1.00 + 0.16 + 0.49 = 1.65$。\n    SSE 的增量为 $\\Delta J_{23} = \\frac{45}{7} \\times 1.65 = \\frac{74.25}{7} \\approx 10.6071$。\n\n比较 $J$ 的三种可能增量：\n$\\Delta J_{12} = 0.432$\n$\\Delta J_{13} \\approx 12.3818$\n$\\Delta J_{23} \\approx 10.6071$\n\n最小增量是 $\\min(\\Delta J_{12}, \\Delta J_{13}, \\Delta J_{23}) = \\Delta J_{12} = 0.432$。\n因此，Ward 联动法将执行簇 1 和簇 2 的合并。问题要求的是由这次合并引起的 $J$ 的最小增量。\n该值为 $0.432$。四舍五入到四位有效数字，我们得到 $0.4320$。",
            "answer": "$$\n\\boxed{0.4320}\n$$"
        },
        {
            "introduction": "在系统生物学中，我们常常需要整合来自不同技术平台的多组学数据，例如基因表达、DNA甲基化和蛋白质组学数据。直接将这些尺度、分布和方差迥异的数据输入聚类算法，往往会导致由某一类型数据主导的错误结论。本练习旨在揭示为何像Ward连锁法这样的方法对变量尺度如此敏感，并挑战你思考和设计一个科学合理的数据预处理流程，以确保后续的热图模式发现是可靠且可解释的。",
            "id": "4328399",
            "problem": "在一项整合多组学谱的系统生物医学研究中，您计划通过层次聚类发现患者亚型，并可视化样本-特征热图。您拥有 $n=120$ 名患者和三个数据块：$p_{\\mathrm{RNA}}=500$ 个特征基因的信使核糖核酸（mRNA）表达数据（每百万计数的对数值，近似连续），$p_{\\mathrm{Meth}}=1000$ 个胞嘧啶-磷酸-鸟嘌呤位点的脱氧核糖核酸（DNA）甲基化数据（beta值，范围在 $[0,1]$），以及 $p_{\\mathrm{Prot}}=200$ 种蛋白质的蛋白质组学数据（强度跨越几个数量级）。您计划使用带Ward联动法的层次凝聚聚类对患者（行）进行聚类，以支持基于热图的模式发现。\n\n基本定义：\n- 两个样本之间的欧几里得距离是 $p$ 个特征上特征差异平方和的平方根。\n- 簇内平方和是指在一个簇中，所有样本和所有特征上，样本值与簇均值之差的平方的总和。\n- Ward联动法在每一步选择合并后能产生最小总簇内平方和增量的那一对簇。\n\n基于这些定义，哪个选项最好地解释了为什么Ward联动法在这种情况下对变量缩放敏感，并提出了一个科学合理的数据预处理流程来减轻这种敏感性，从而产生可解释的样本聚类和热图？\n\nA. Ward联动法对缩放敏感，因为合并时簇内平方和的增量取决于簇中心之间的欧几里得距离的平方，所以将一个特征线性缩放一个因子，其贡献会乘以该因子的平方；高方差或大范围的模态会占主导地位。一个合适的流程是：通过对稳健缩放后的版本进行初步的主成分分析（PCA；Principal Component Analysis）筛选来移除明显的离群值；应用适合各模态的方差稳定化转换（例如，对蛋白质组学数据使用带一个小的偏移量的 $\\log_2$ 转换，对甲基化数据使用反正弦平方根或logit转换，对mRNA计数使用 $\\log_2(1+x)$）；如果存在批次，使用经验贝叶斯（EB）方法在每个模态内校正批次效应；在模态内使用$k$-最近邻（KNN；$k$-nearest neighbors）方法填补零星的缺失值；将每个特征在所有样本上标准化为零均值和单位方差；可选地应用数据块缩放来平衡每个模态的总方差贡献（例如，将模态 $m$ 中的所有特征乘以 $1/\\sqrt{p_m}$）；在标准化数据上计算欧几里得距离并应用Ward联动法进行样本聚类；显示热图时将特征在样本间进行z-score标准化以强调相对模式。\n\nB. Ward联动法对缩放不敏感，因为它基于质心而非原始特征进行聚类；为进一步确保不变性，将每个样本（行）缩放到 $[0,1]$ 范围（每行进行最小-最大值缩放），计算相关距离代替欧几里得距离，并应用Ward联动法；在热图中，将每行归一化为均值 $1$ 和方差 $1$。\n\nC. Ward联动法仅在特征未中心化时才对缩放敏感；一旦特征进行了均值中心化，尺度的差异就不再重要，因为聚类是由质心差异驱动的。因此，正确的流程是从每个特征中减去其在所有样本上的均值，保持方差不变以保留生物信号的幅度，计算欧几里得距离，并应用Ward联动法；热图应显示中心化但未缩放的特征。\n\nD. Ward联动法对缩放敏感仅仅是因为欧几里得距离过度惩罚大的差异；改用曼哈顿距离可以解决这个问题。流程是将特征保留在其原始尺度上以保持可解释性，计算曼哈顿距离，并直接应用Ward联动法；热图应显示原始（未转换）值以避免绝对水平的失真。\n\n选择唯一的最佳选项。",
            "solution": "问题陈述经过验证，是有效的。\n\n**1. 问题验证**\n\n**步骤1：提取已知条件**\n-   患者数量：$n=120$\n-   mRNA数据：$p_{\\mathrm{RNA}}=500$ 个基因，每百万计数的对数值\n-   DNA甲基化数据：$p_{\\mathrm{Meth}}=1000$ 个位点，beta值范围在 $[0,1]$\n-   蛋白质组学数据：$p_{\\mathrm{Prot}}=200$ 种蛋白质，强度跨越几个数量级\n-   聚类目标：患者（行）\n-   聚类算法：使用Ward联动法的层次凝聚聚类\n-   目标：支持基于热图的模式发现\n-   欧几里得距离的定义：两个样本之间特征差异平方和的平方根。对于两个具有 $p$ 个特征的样本 $\\mathbf{x}_a$ 和 $\\mathbf{x}_b$，$d(\\mathbf{x}_a, \\mathbf{x}_b) = \\sqrt{\\sum_{k=1}^{p} (x_{ak} - x_{bk})^2}$。\n-   簇内平方和（WCSS）的定义：在一个簇中，所有特征和样本上，样本值与簇均值之差的平方的总和。对于一个有 $n_C$ 个样本和质心 $\\bar{\\mathbf{x}}_C$ 的簇 $C$，$WCSS(C) = \\sum_{i \\in C} \\sum_{k=1}^{p} (x_{ik} - \\bar{x}_{Ck})^2 = \\sum_{i \\in C} d^2(\\mathbf{x}_i, \\bar{\\mathbf{x}}_C)$。\n-   Ward联动法的定义：合并能产生最小总WCSS增量的那一对簇。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上是可靠的、提法恰当且客观的。它描述了一个在系统生物医学中标准且现实的多组学数据分析场景。所提供的定义在数学上是正确的，并且是该领域的标准。数据类型和分析挑战（不同的尺度、特征数量和分布）是典型的。没有会妨碍严谨分析的矛盾、模糊之处或缺失信息。\n\n**步骤3：结论与行动**\n问题陈述是有效的。我将继续进行解题推导和选项分析。\n\n**2. 解题推导**\n\n问题的核心在于Ward联动法的性质及其与欧几里得距离的关系。\n\n**Ward联动法对缩放的敏感性：**\nWard方法旨在合并能使总簇内平方和增量最小化的簇 $C_i$ 和 $C_j$。这个增量 $\\Delta_{ij}$ 由下式给出：\n$$ \\Delta_{ij} = \\frac{n_i n_j}{n_i + n_j} d^2(\\bar{\\mathbf{x}}_i, \\bar{\\mathbf{x}}_j) $$\n其中 $n_i$ 和 $n_j$ 分别是簇 $C_i$ 和 $C_j$ 中的样本数，而 $d^2(\\bar{\\mathbf{x}}_i, \\bar{\\mathbf{x}}_j)$ 是它们质心之间的欧几里得距离的平方。\n\n欧几里得距离的平方是：\n$$ d^2(\\bar{\\mathbf{x}}_i, \\bar{\\mathbf{x}}_j) = \\sum_{k=1}^{p} (\\bar{x}_{ik} - \\bar{x}_{jk})^2 $$\n其中 $k$ 是特征的索引。\n\n考虑将单个特征 $k$ 线性缩放因子 $\\alpha$ 的效果。设新的特征值为 $x'_{k} = \\alpha x_{k}$。新的质心分量为 $\\bar{x}'_{ik} = \\alpha \\bar{x}_{ik}$ 和 $\\bar{x}'_{jk} = \\alpha \\bar{x}_{jk}$。该特征对距离平方的贡献变为：\n$$ (\\bar{x}'_{ik} - \\bar{x}'_{jk})^2 = (\\alpha \\bar{x}_{ik} - \\alpha \\bar{x}_{jk})^2 = \\alpha^2 (\\bar{x}_{ik} - \\bar{x}_{jk})^2 $$\n特征 $k$ 对距离度量的贡献乘以了 $\\alpha^2$。因此，具有大数值范围或高方差的特征将对总距离产生不成比例的巨大影响，从而主导聚类决策。在这个多组学问题中，跨越几个数量级的蛋白质组学强度将比限制在 $[0,1]$ 区间内的甲基化beta值具有大得多的方差。如果没有适当的缩放，聚类将几乎完全由蛋白质组学数据驱动，而忽略了其他两种模态中的生物学信息。\n\n**一个合理的预处理流程：**\n为了解决这种敏感性并适当地整合不同的数据类型，需要一个多步骤的流程。\n1.  **模态特异性转换：** 不同的数据类型具有独特的统计特性。应用方差稳定化转换是关键的第一步。对于蛋白质组学强度，对数转换（例如，$\\log_2(x+c)$）是标准方法。对于甲基化beta值，logit转换（$\\log(\\beta/(1-\\beta))$）或反正弦平方根转换是合适的。对于RNA-seq计数（即使是log-CPM），确保方差在整个表达范围内相当稳定是关键。\n2.  **数据清洗和校正：** 真实世界的数据通常有缺失值，并可能受到批次效应的影响。缺失值应该被填补（例如，使用$k$-最近邻，KNN，插补法），批次效应应该被校正（例如，使用像ComBat这样的经验贝叶斯方法），理想情况下应在合并前在每个模态内部完成。\n3.  **特征标准化：** 这是减轻缩放敏感性的关键步骤。在转换和清洗之后，每个特征（跨所有模态）都应该被缩放到一个共同的参考标准。标准方法是z-score标准化，即每个特征都被中心化为均值为 $0$ 并缩放为标准差为 $1$。这确保了在聚类之前，每个特征在欧几里得距离计算中具有相等的先验权重。\n4.  **数据块级别缩放（可选）：** z-score标准化后，每个特征的方差为单位1。然而，一个拥有更多特征的数据块（例如，甲基化数据有 $p_{\\mathrm{Meth}}=1000$ 个特征）将比一个拥有较少特征的数据块（例如，蛋白质组学数据有 $p_{\\mathrm{Prot}}=200$ 个特征）对总方差贡献更多。为了给予每个*模态*相等的权重，可以应用一个数据块缩放因子，例如将模态 $m$ 中的所有特征乘以 $1/\\sqrt{p_m}$。\n5.  **聚类和可视化：** 在这个全面的预处理之后，可以计算欧几里得距离，并应用Ward联动法。对于热图可视化，显示z-score标准化（按特征，跨样本）的数据是标准做法，因为它突出显示了高值和低值的相对模式，使簇特异性特征易于观察。\n\n**3. 逐项选项分析**\n\n**A. Ward联动法对缩放敏感，因为合并时簇内平方和的增量取决于簇中心之间的欧几里得距离的平方，所以将一个特征线性缩放一个因子，其贡献会乘以该因子的平方；高方差或大范围的模态会占主导地位。一个合适的流程是：通过对稳健缩放后的版本进行初步的主成分分析（PCA；Principal Component Analysis）筛选来移除明显的离群值；应用适合各模态的方差稳定化转换（例如，对蛋白质组学数据使用带一个小的偏移量的 $\\log_2$ 转换，对甲基化数据使用反正弦平方根或logit转换，对mRNA计数使用 $\\log_2(1+x)$）；如果存在批次，使用经验贝叶斯（EB）方法在每个模态内校正批次效应；在模态内使用$k$-最近邻（KNN；$k$-nearest neighbors）方法填补零星的缺失值；将每个特征在所有样本上标准化为零均值和单位方差；可选地应用数据块缩放来平衡每个模态的总方差贡献（例如，将模态 $m$ 中的所有特征乘以 $1/\\sqrt{p_m}$）；在标准化数据上计算欧几里得距离并应用Ward联动法进行样本聚类；显示热图时将特征在样本间进行z-score标准化以强调相对模式。**\n\n-   **分析**：对敏感性的解释完全正确，与上面的推导相符。所提出的流程是全面的、科学上合理的，并反映了生物信息学和多组学数据分析中的最佳实践。它正确地指出了在应用基于距离的聚类方法之前，需要进行模态特异性转换、数据清洗和多层次缩放（包括特征级和可选的数据块级）。可视化策略也是标准和恰当的。\n-   **结论**：**正确**。\n\n**B. Ward联动法对缩放不敏感，因为它基于质心而非原始特征进行聚类；为进一步确保不变性，将每个样本（行）缩放到 $[0,1]$ 范围（每行进行最小-最大值缩放），计算相关距离代替欧几里得距离，并应用Ward联动法；在热图中，将每行归一化为均值 $1$ 和方差 $1$。**\n\n-   **分析**：初始前提（“对缩放不敏感”）是根本上错误的。质心直接受到特征尺度的影响。所提出的流程是有缺陷的：（1）将每个*样本*（行）缩放到 $[0,1]$ 是错误的；缩放应该按*特征*（列）进行，以使特征具有可比性。（2）将Ward联动法与相关距离一起使用在概念上是有问题的。Ward方法被定义为最小化平方和，这与欧几里得空间内在相关。虽然在计算上是可能的，但它失去了其作为方差最小化方法的理论依据。（3）为热图将行归一化为均值 $1$ 和方差 $1$ 是不合常规的，通常不是所期望的。\n-   **结论**：**不正确**。\n\n**C. Ward联动法仅在特征未中心化时才对缩放敏感；一旦特征进行了均值中心化，尺度的差异就不再重要，因为聚类是由质心差异驱动的。因此，正确的流程是从每个特征中减去其在所有样本上的均值，保持方差不变以保留生物信号的幅度，计算欧几里得距离，并应用Ward联动法；热图应显示中心化但未缩放的特征。**\n\n-   **分析**：这个选项误解了中心化与缩放的效果。对特征进行均值中心化对样本间的欧几里得距离没有影响，因为减去的均值会相互抵消：$(x_{ak}-\\mu_k) - (x_{bk}-\\mu_k) = x_{ak} - x_{bk}$。问题在于方差（尺度），而不是位置（均值）。提议保持方差不变恰恰与所要求的相反，并将导致聚类被高方差特征主导。“保留生物信号幅度”的论点在这种情况下具有误导性，因为它会阻碍来自不同模态信号的公平整合。\n-   **结论**：**不正确**。\n\n**D. Ward联动法对缩放敏感仅仅是因为欧几里得距离过度惩罚大的差异；改用曼哈顿距离可以解决这个问题。流程是将特征保留在其原始尺度上以保持可解释性，计算曼哈顿距离，并直接应用Ward联动法；热图应显示原始（未转换）值以避免绝对水平的失真。**\n\n-   **分析**：这个选项在多个方面都是错误的。（1）虽然曼哈顿距离比欧几里得距离对离群值不那么敏感，但它仍然对线性缩放敏感。一个范围大$1000$倍的特征仍然会主导绝对差之和。更换距离并不能“解决”缩放问题。（2）更关键的是，Ward联动法是基于最小化WCSS（簇内平方和）定义的，而WCSS基于欧几里得距离的平方。将Ward联动法与曼哈顿距离一起使用，在数学上和概念上都不一致。（3）将特征保留在原始尺度上是主要问题，并且由于巨大的尺度差异，在热图中显示原始多组学数据通常信息量不足。\n-   **结论**：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}