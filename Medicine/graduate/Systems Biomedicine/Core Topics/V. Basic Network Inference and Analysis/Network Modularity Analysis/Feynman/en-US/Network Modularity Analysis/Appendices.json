{
    "hands_on_practices": [
        {
            "introduction": "Understanding network modularity begins with mastering its fundamental calculation. This first exercise provides a clear, step-by-step application of the modularity formula to a simple, unweighted network. By working through this problem, you will learn how to compute the modularity score, $Q$, from first principles, comparing the observed intra-community edge density against the expectation from a random null model. This foundational skill is essential for interpreting the results of any community detection algorithm .",
            "id": "4365529",
            "problem": "In systems biomedicine, community structure within molecular interaction networks is often quantified by the modularity score, which compares the observed within-module connectivity to a degree-preserving random null model. Consider an undirected, simple weighted network with node set $\\{1,2,3,4\\}$ and edges $(1,2)$, $(2,3)$, $(3,4)$, each with weight $1$. Let $A_{ij}$ denote the symmetric weighted adjacency matrix entries and let $k_i$ denote the node strength (the sum of weights of edges incident to node $i$). Let $m$ denote the total edge weight, so that $2m=\\sum_{i}k_i$. The degree-preserving null (the Configuration Model (CM)) has expected adjacency $\\mathbb{E}[A_{ij}]$ that depends only on $\\{k_i\\}$ and $m$.\n\nStarting from the fundamental definition that modularity is the normalized difference between the observed fraction of intra-community edge weight and its expectation under the degree-preserving null, derive the expression for the modularity $Q$ of the partition $\\{\\{1,2\\},\\{3,4\\}\\}$ and compute its value for this network. Conclude, based on the sign of $Q$, whether this partition increases $Q$ relative to random. Express your final numerical value as an exact rational number without rounding.",
            "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded in network theory, well-posed with a unique answer, objective, and contains all necessary information for a solution.\n\nThe problem asks for the derivation and computation of the modularity score, $Q$, for a specific partition of a given weighted network. The fundamental definition of modularity, as stated, is the normalized difference between the observed fraction of intra-community edge weight and its expectation under a degree-preserving null model (the Configuration Model).\n\nFirst, we formalize the network structure and properties based on the givens.\nThe network has a node set $V=\\{1,2,3,4\\}$ and three edges, each with weight $1$: $(1,2)$, $(2,3)$, and $(3,4)$.\nThe weighted adjacency matrix $A$, where $A_{ij}$ is the weight of the edge between nodes $i$ and $j$, is:\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n1 & 0 & 1 & 0 \\\\\n0 & 1 & 0 & 1 \\\\\n0 & 0 & 1 & 0\n\\end{pmatrix}\n$$\nThe strength of a node $i$, denoted $k_i$, is the sum of the weights of all edges connected to it, $k_i = \\sum_j A_{ij}$. We calculate the strengths for each node:\n- $k_1 = A_{12} = 1$\n- $k_2 = A_{21} + A_{23} = 1 + 1 = 2$\n- $k_3 = A_{32} + A_{34} = 1 + 1 = 2$\n- $k_4 = A_{43} = 1$\n\nThe total edge weight of the network, $m$, is the sum of all edge weights: $m = 1+1+1=3$. This can be verified using the relation $2m = \\sum_i k_i$, which gives $2m = k_1+k_2+k_3+k_4 = 1+2+2+1=6$, thus $m=3$.\n\nThe specified partition divides the nodes into two communities: $C_1 = \\{1,2\\}$ and $C_2 = \\{3,4\\}$.\n\nWe can derive the expression for modularity $Q$ from first principles. Let $L_s$ be the sum of edge weights within a community $s$, and let $K_s$ be the sum of the strengths of all nodes in community $s$. Let $m$ be the total edge weight in the network.\n\nThe fraction of the total edge weight that falls within community $s$ is $e_{ss} = \\frac{L_s}{m}$.\nThe fraction of all edge \"ends\" (or \"stubs\" in the Configuration Model) that are attached to nodes in community $s$ is $a_s = \\frac{K_s}{2m}$. In a random network where edges are formed by connecting stubs uniformly at random, the probability that both ends of a randomly chosen edge fall within community $s$ is $a_s \\times a_s = a_s^2$. This term, $a_s^2$, represents the expected fraction of total edge weight that would be internal to community $s$ under the degree-preserving null model.\n\nModularity, $Q$, is the sum of the differences between the observed and expected fractions over all communities in the partition:\n$$\nQ = \\sum_{s} (e_{ss} - a_s^2) = \\sum_{s} \\left[ \\frac{L_s}{m} - \\left(\\frac{K_s}{2m}\\right)^2 \\right]\n$$\nThis is a standard and direct formulation of modularity for weighted networks. Now, we compute the necessary quantities for the given partition.\n\nFor community $C_1 = \\{1,2\\}$:\n- The intra-community weight, $L_1$, is the weight of the edge $(1,2)$, so $L_1 = 1$.\n- The sum of node strengths, $K_1$, is $k_1 + k_2 = 1 + 2 = 3$.\n\nFor community $C_2 = \\{3,4\\}$:\n- The intra-community weight, $L_2$, is the weight of the edge $(3,4)$, so $L_2 = 1$.\n- The sum of node strengths, $K_2$, is $k_3 + k_4 = 2 + 1 = 3$.\n\nThe total network weight is $m=3$, and $2m=6$.\n\nNow we can calculate the terms for each community's contribution to $Q$.\n\nContribution from $C_1$:\n$$e_{11} - a_1^2 = \\frac{L_1}{m} - \\left(\\frac{K_1}{2m}\\right)^2 = \\frac{1}{3} - \\left(\\frac{3}{6}\\right)^2 = \\frac{1}{3} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{3} - \\frac{1}{4}$$\n$$ = \\frac{4}{12} - \\frac{3}{12} = \\frac{1}{12}$$\n\nContribution from $C_2$:\n$$e_{22} - a_2^2 = \\frac{L_2}{m} - \\left(\\frac{K_2}{2m}\\right)^2 = \\frac{1}{3} - \\left(\\frac{3}{6}\\right)^2 = \\frac{1}{3} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{3} - \\frac{1}{4}$$\n$$ = \\frac{4}{12} - \\frac{3}{12} = \\frac{1}{12}$$\n\nThe total modularity $Q$ is the sum of these contributions:\n$$Q = (e_{11} - a_1^2) + (e_{22} - a_2^2) = \\frac{1}{12} + \\frac{1}{12} = \\frac{2}{12} = \\frac{1}{6}$$\n\nThe calculated modularity is $Q = \\frac{1}{6}$.\n\nThe sign of the modularity score indicates whether the partition identifies a community structure that is more pronounced than would be expected at random. Since $Q > 0$, the density of intra-community edges (total weight) in the partition $\\{\\{1,2\\},\\{3,4\\}\\}$ is greater than what is expected under the Configuration Model null hypothesis. Therefore, this partition reflects a meaningful community structure in the network, and it increases $Q$ relative to a random baseline.",
            "answer": "$$\n\\boxed{\\frac{1}{6}}\n$$"
        },
        {
            "introduction": "Many biological systems, such as gene regulatory or signaling networks, are best represented as directed graphs where interactions have a clear origin and target. This practice extends the concept of modularity to these directed networks, which requires a more nuanced null model. You will practice calculating modularity by accounting for the in-degree, $k^{\\text{in}}$, and out-degree, $k^{\\text{out}}$, of each node, a critical distinction for accurately assessing community structure in networks with directional relationships .",
            "id": "4365539",
            "problem": "In systems biomedicine, community detection in directed biomolecular interaction networks such as a Gene Regulatory Network (GRN) is often quantified by a scalar quantity called network modularity, which measures how much a given partition concentrates edges within communities beyond what would be expected under a random null model that preserves the in-degree and out-degree sequences. Consider a directed network with nodes $1$, $2$, and $3$, and directed edges $1 \\to 2$, $2 \\to 3$, and $3 \\to 1$. Let the partition of nodes be $\\{\\{1,2\\},\\{3\\}\\}$, where nodes $1$ and $2$ form one community and node $3$ is alone in the other community. Using the standard configuration-model null ensemble for directed networks that preserves the in-degree and out-degree of each node, compute the modularity $Q$ for this partition. Your computation must proceed by first explicitly calculating the in-degree $k_{i}^{\\text{in}}$ and out-degree $k_{i}^{\\text{out}}$ for each node $i \\in \\{1,2,3\\}$, then evaluating the observed within-community edge count and its expectation under the null model, and finally assembling these into the modularity $Q$ for the specified partition. Express your final answer as an exact rational number, with no rounding.",
            "solution": "The problem requires the computation of the modularity, $Q$, for a given partition of a specific directed network. The modularity for a directed network measures the extent to which edges are concentrated within communities compared to a random null model. The standard definition of modularity, $Q$, for a partition of a directed network into a set of communities $\\{c\\}$ is given by:\n\n$$ Q = \\frac{1}{M} \\sum_{i,j} \\left[ A_{ij} - P_{ij} \\right] \\delta(c_i, c_j) $$\n\nwhere:\n- $M$ is the total number of edges in the network.\n- $A_{ij}$ is the adjacency matrix element, equal to $1$ if a directed edge exists from node $i$ to node $j$, and $0$ otherwise.\n- $P_{ij}$ is the probability of an edge existing from node $i$ to node $j$ in the configuration null model, given by $P_{ij} = \\frac{k_i^{\\text{out}} k_j^{\\text{in}}}{M}$. Here, $k_i^{\\text{out}}$ is the out-degree of node $i$ and $k_j^{\\text{in}}$ is the in-degree of node $j$.\n- $c_i$ is the community assignment of node $i$.\n- $\\delta(c_i, c_j)$ is the Kronecker delta, which is $1$ if nodes $i$ and $j$ are in the same community ($c_i = c_j$) and $0$ otherwise.\n\nThe calculation will proceed by following the steps outlined in the problem statement.\n\nFirst, we identify the network's properties from the problem description.\nThe network has nodes $V = \\{1, 2, 3\\}$.\nThe directed edges are $1 \\to 2$, $2 \\to 3$, and $3 \\to 1$.\nThe total number of edges is $M=3$.\nThe adjacency matrix $A$ is:\n$$ A = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 1 & 0 & 0 \\end{pmatrix} $$\n\nThe specified partition is $\\{\\{1,2\\},\\{3\\}\\}$. Let's denote community $C_1 = \\{1, 2\\}$ and community $C_2 = \\{3\\}$.\n\n**Step 1: Calculate the in-degree and out-degree for each node.**\n\n- For node $1$: There is one outgoing edge ($1 \\to 2$) and one incoming edge ($3 \\to 1$).\n  $$ k_1^{\\text{out}} = 1, \\quad k_1^{\\text{in}} = 1 $$\n- For node $2$: There is one outgoing edge ($2 \\to 3$) and one incoming edge ($1 \\to 2$).\n  $$ k_2^{\\text{out}} = 1, \\quad k_2^{\\text{in}} = 1 $$\n- For node $3$: There is one outgoing edge ($3 \\to 1$) and one incoming edge ($2 \\to 3$).\n  $$ k_3^{\\text{out}} = 1, \\quad k_3^{\\text{in}} = 1 $$\nThe sum of out-degrees is $\\sum_{i} k_i^{\\text{out}} = 1+1+1=3$, and the sum of in-degrees is $\\sum_{j} k_j^{\\text{in}} = 1+1+1=3$. Both sums are equal to the total number of edges $M$, as expected.\n\n**Step 2: Evaluate the observed within-community edge count.**\n\nThe modularity formula can be expressed as the difference between the fraction of edges that are within communities and the expected fraction of such edges in the null model.\nThe fraction of edges within communities is given by $\\frac{1}{M}\\sum_{i,j} A_{ij} \\delta(c_i, c_j)$.\nWe sum the number of edges that start and end in the same community.\n- For community $C_1 = \\{1, 2\\}$, we check for edges $(i,j)$ where $i,j \\in \\{1,2\\}$. The only such edge is $1 \\to 2$. Thus, the number of internal edges is $L_{C_1} = 1$.\n- For community $C_2 = \\{3\\}$, we check for edges $(i,j)$ where $i,j \\in \\{3\\}$. There are no self-loops on node $3$. Thus, the number of internal edges is $L_{C_2} = 0$.\n\nThe total number of observed within-community edges is $L = L_{C_1} + L_{C_2} = 1 + 0 = 1$.\nThe fraction of observed within-community edges is $\\frac{L}{M} = \\frac{1}{3}$.\n\n**Step 3: Evaluate the expected within-community edge count under the null model.**\n\nThe expected fraction of edges within communities is given by $\\frac{1}{M}\\sum_{i,j} P_{ij} \\delta(c_i, c_j) = \\frac{1}{M^2}\\sum_{i,j} k_i^{\\text{out}} k_j^{\\text{in}} \\delta(c_i, c_j)$.\nThis term can be calculated by summing the contributions from each community. Let $K_c^{\\text{out}} = \\sum_{i \\in c} k_i^{\\text{out}}$ and $K_c^{\\text{in}} = \\sum_{j \\in c} k_j^{\\text{in}}$. The expected fraction is $\\sum_{c} \\frac{K_c^{\\text{out}} K_c^{\\text{in}}}{M^2}$.\n\n- For community $C_1 = \\{1, 2\\}$:\n  The total out-degree is $K_{C_1}^{\\text{out}} = k_1^{\\text{out}} + k_2^{\\text{out}} = 1 + 1 = 2$.\n  The total in-degree is $K_{C_1}^{\\text{in}} = k_1^{\\text{in}} + k_2^{\\text{in}} = 1 + 1 = 2$.\n  The expected fraction of edges within $C_1$ is $\\frac{K_{C_1}^{\\text{out}} K_{C_1}^{\\text{in}}}{M^2} = \\frac{2 \\times 2}{3^2} = \\frac{4}{9}$.\n\n- For community $C_2 = \\{3\\}$:\n  The total out-degree is $K_{C_2}^{\\text{out}} = k_3^{\\text{out}} = 1$.\n  The total in-degree is $K_{C_2}^{\\text{in}} = k_3^{\\text{in}} = 1$.\n  The expected fraction of edges within $C_2$ is $\\frac{K_{C_2}^{\\text{out}} K_{C_2}^{\\text{in}}}{M^2} = \\frac{1 \\times 1}{3^2} = \\frac{1}{9}$.\n\nThe total expected fraction of within-community edges is the sum of these contributions:\n$$ \\frac{4}{9} + \\frac{1}{9} = \\frac{5}{9} $$\n\n**Step 4: Assemble these components to compute the modularity $Q$.**\n\nThe modularity $Q$ is the difference between the observed fraction of within-community edges and the expected fraction:\n$$ Q = (\\text{Observed fraction}) - (\\text{Expected fraction}) $$\n$$ Q = \\frac{1}{3} - \\frac{5}{9} $$\nTo subtract, we find a common denominator, which is $9$:\n$$ Q = \\frac{3}{9} - \\frac{5}{9} = -\\frac{2}{9} $$\n\nThe modularity for the given partition is $-\\frac{2}{9}$. The negative value indicates that the given partition has fewer internal edges than would be expected at random under the specified configuration null model.",
            "answer": "$$\\boxed{-\\frac{2}{9}}$$"
        },
        {
            "introduction": "Systems biomedicine often involves analyzing bipartite networks, where nodes belong to two distinct sets, such as transcription factors and their target genes. Standard modularity calculations are not appropriate for such structures, as they do not forbid connections between nodes of the same type. This exercise introduces the specialized formula for bipartite modularity, enabling you to quantify community structure in a way that respects the inherent two-part nature of these important biological networks .",
            "id": "4365476",
            "problem": "Consider a small gene regulatory network in systems biomedicine modeled as a weighted bipartite graph where Transcription Factors (TFs) and genes form the two disjoint node sets. The TF set is $\\{T_1, T_2\\}$ and the gene set is $\\{G_1, G_2\\}$. Edge weights represent normalized regulatory interaction strength inferred from experimental assays, and only TF-to-gene interactions are present. Treat the graph as undirected for the purpose of modularity analysis on a bipartite structure. The nonzero edge weights are: $w_{T_1 G_1} = 2$, $w_{T_1 G_2} = 1$, $w_{T_2 G_1} = 1$, and $w_{T_2 G_2} = 3$. All other TF–gene pairs have weight $0$. Consider the partitioning of the network into $2$ communities: one community groups $(T_1, G_1)$ and the other groups $(T_2, G_2)$. Using the canonical bipartite modularity that compares observed TF–gene weights to their expected values under the bipartite configuration null model that preserves node strengths, compute the modularity $Q$ of this partition. Express your final answer as a reduced fraction with no units.",
            "solution": "The user-provided problem has been analyzed and is deemed valid. It is scientifically grounded, well-posed, and objective, with all necessary information provided for a unique solution.\n\nThe problem requires the computation of the modularity $Q$ for a given partition of a weighted bipartite graph. The graph represents a gene regulatory network with two disjoint sets of nodes: a set of Transcription Factors (TFs), $U = \\{T_1, T_2\\}$, and a set of genes, $V = \\{G_1, G_2\\}$.\n\nThe canonical modularity for a bipartite graph, denoted as $Q_b$, is defined based on the comparison of the actual number of edges within communities to the number expected under a suitable null model. For a weighted bipartite graph, the formula is:\n$$Q_b = \\frac{1}{m} \\sum_{i \\in U, j \\in V} \\left( A_{ij} - \\frac{k_i d_j}{m} \\right) \\delta(c_i, c_j)$$\nwhere:\n- $A_{ij}$ is the weight of the edge between node $i$ from the first partition (TFs) and node $j$ from the second partition (genes).\n- $m$ is the total weight of all edges in the network.\n- $k_i$ is the strength (weighted degree) of node $i \\in U$, calculated as $k_i = \\sum_{j \\in V} A_{ij}$.\n- $d_j$ is the strength (weighted degree) of node $j \\in V$, calculated as $d_j = \\sum_{i \\in U} A_{ij}$.\n- $c_i$ is the community assignment of node $i$.\n- $\\delta(c_i, c_j)$ is the Kronecker delta function, which is $1$ if nodes $i$ and $j$ are in the same community ($c_i=c_j$) and $0$ otherwise.\n\nFirst, we must calculate the necessary quantities from the given problem statement.\n\nThe edge weights are provided as:\n- $w_{T_1 G_1} = A_{T_1, G_1} = 2$\n- $w_{T_1 G_2} = A_{T_1, G_2} = 1$\n- $w_{T_2 G_1} = A_{T_2, G_1} = 1$\n- $w_{T_2 G_2} = A_{T_2, G_2} = 3$\n\nThe total weight of all edges, $m$, is the sum of these weights:\n$$m = A_{T_1, G_1} + A_{T_1, G_2} + A_{T_2, G_1} + A_{T_2, G_2} = 2 + 1 + 1 + 3 = 7$$\n\nNext, we compute the strengths (weighted degrees) of each node.\nFor the TF nodes in set $U$:\n- $k_{T_1} = A_{T_1, G_1} + A_{T_1, G_2} = 2 + 1 = 3$\n- $k_{T_2} = A_{T_2, G_1} + A_{T_2, G_2} = 1 + 3 = 4$\n\nFor the gene nodes in set $V$:\n- $d_{G_1} = A_{T_1, G_1} + A_{T_2, G_1} = 2 + 1 = 3$\n- $d_{G_2} = A_{T_1, G_2} + A_{T_2, G_2} = 1 + 3 = 4$\n\nThe problem specifies a partition into $2$ communities:\n- Community $1$ ($C_1$): contains nodes $\\{T_1, G_1\\}$.\n- Community $2$ ($C_2$): contains nodes $\\{T_2, G_2\\}$.\n\nThe modularity formula sums the contributions for pairs of nodes $(i,j)$ where $i \\in U$ and $j \\in V$ that are in the same community. The term $\\delta(c_i, c_j)$ ensures this.\nFor the given partition, the pairs of nodes from different sets $(U, V)$ that are in the same community are $(T_1, G_1)$ in $C_1$, and $(T_2, G_2)$ in $C_2$. All other pairs, $(T_1, G_2)$ and $(T_2, G_1)$, are in different communities, so their contribution to the sum is zero.\n\nThus, the modularity calculation simplifies to:\n$$Q = \\frac{1}{m} \\left[ \\left( A_{T_1, G_1} - \\frac{k_{T_1} d_{G_1}}{m} \\right) + \\left( A_{T_2, G_2} - \\frac{k_{T_2} d_{G_2}}{m} \\right) \\right]$$\n\nNow we substitute the calculated values into this expression:\n- $m = 7$\n- $A_{T_1, G_1} = 2$ and $A_{T_2, G_2} = 3$\n- $k_{T_1} = 3$ and $d_{G_1} = 3$\n- $k_{T_2} = 4$ and $d_{G_2} = 4$\n\n$$Q = \\frac{1}{7} \\left[ \\left( 2 - \\frac{3 \\times 3}{7} \\right) + \\left( 3 - \\frac{4 \\times 4}{7} \\right) \\right]$$\n$$Q = \\frac{1}{7} \\left[ \\left( 2 - \\frac{9}{7} \\right) + \\left( 3 - \\frac{16}{7} \\right) \\right]$$\nTo perform the subtractions inside the parentheses, we find a common denominator:\n$$Q = \\frac{1}{7} \\left[ \\left( \\frac{14}{7} - \\frac{9}{7} \\right) + \\left( \\frac{21}{7} - \\frac{16}{7} \\right) \\right]$$\n$$Q = \\frac{1}{7} \\left[ \\frac{5}{7} + \\frac{5}{7} \\right]$$\n$$Q = \\frac{1}{7} \\left[ \\frac{10}{7} \\right]$$\n$$Q = \\frac{10}{49}$$\nThe fraction $\\frac{10}{49}$ is already in its reduced form, as the greatest common divisor of $10$ and $49$ is $1$.\nThe modularity of the given partition is $\\frac{10}{49}$.",
            "answer": "$$\\boxed{\\frac{10}{49}}$$"
        }
    ]
}