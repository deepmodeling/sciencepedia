{
    "hands_on_practices": [
        {
            "introduction": "将复杂的基因调控网络抽象为图和矩阵，是系统生物学研究的核心方法之一。这个练习让你能够亲手将一组实验观察到的调控关系转化为一个有向、有符号的邻接矩阵，并计算节点的度和与反馈回路相关的指标，从而对网络结构有一个定量的初步认识。",
            "id": "4345473",
            "problem": "考虑一个包含 $5$ 个基因（标记为 $g_1, g_2, g_3, g_4, g_5$）的基因调控网络 (GRN)。该网络由一个有向、带符号的邻接矩阵 $A \\in \\mathbb{R}^{5 \\times 5}$ 表示，其中如果基因 $g_i$ 激活基因 $g_j$，则 $A_{ij} = 1$；如果基因 $g_i$ 抑制基因 $g_j$，则 $A_{ij} = -1$；否则 $A_{ij} = 0$。允许自调控。观察到以下经实验支持的调控关系：\n\n- $g_1$ 激活 $g_2$。\n- $g_2$ 抑制 $g_1$。\n- $g_3$ 激活 $g_1$。\n- $g_3$ 抑制 $g_2$。\n- $g_4$ 激活自身。\n- $g_4$ 抑制 $g_5$。\n- $g_5$ 激活 $g_4$。\n- $g_2$ 激活 $g_5$。\n- $g_5$ 抑制 $g_3$。\n- $g_1$ 抑制 $g_5$。\n\n任务：\n1. 根据所述约定，构建编码上述关系的邻接矩阵 $A$。\n2. 对每个基因 $g_i$，计算其出度 $d_i^{\\mathrm{out}}$ 和入度 $d_i^{\\mathrm{in}}$，其中 $d_i^{\\mathrm{out}} = \\sum_{j=1}^{5} \\mathbf{1}\\{A_{ij} \\neq 0\\}$ 且 $d_i^{\\mathrm{in}} = \\sum_{j=1}^{5} \\mathbf{1}\\{A_{ji} \\neq 0\\}$。自环同时计入入度和出度。\n3. 令 $S = \\mathrm{tr}(A^2)$，即邻接矩阵平方的迹。精确计算 $S$。\n\n最终报告结果仅提供 $S$ 的值。无需四舍五入。",
            "solution": "首先，我们根据给定的调控关系构建邻接矩阵 $A$。行代表源基因，列代表目标基因。\n- $g_1$ 激活 $g_2$：$A_{12} = 1$\n- $g_2$ 抑制 $g_1$：$A_{21} = -1$\n- $g_3$ 激活 $g_1$：$A_{31} = 1$\n- $g_3$ 抑制 $g_2$：$A_{32} = -1$\n- $g_4$ 激活自身：$A_{44} = 1$\n- $g_4$ 抑制 $g_5$：$A_{45} = -1$\n- $g_5$ 激活 $g_4$：$A_{54} = 1$\n- $g_2$ 激活 $g_5$：$A_{25} = 1$\n- $g_5$ 抑制 $g_3$：$A_{53} = -1$\n- $g_1$ 抑制 $g_5$：$A_{15} = -1$\n\n所有其他项均为零。得到的邻接矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix}\n0  & 1 & 0 & 0 & -1 \\\\\n-1 & 0 & 0 & 0 & 1 \\\\\n1 & -1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & -1 \\\\\n0 & 0 & -1 & 1 & 0\n\\end{pmatrix}\n$$\n问题要求计算量 $S = \\mathrm{tr}(A^2)$，即邻接矩阵平方的迹。矩阵的迹是其对角线元素之和，所以 $S = \\sum_{i=1}^5 (A^2)_{ii}$。\n\n$A^2$ 的对角线元素由公式 $(A^2)_{ii} = \\sum_{k=1}^5 A_{ik} A_{ki}$ 给出。我们来计算这些值：\n\n- $(A^2)_{11} = A_{11}A_{11} + A_{12}A_{21} + A_{13}A_{31} + A_{14}A_{41} + A_{15}A_{51} = (0)(0) + (1)(-1) + (0)(1) + (0)(0) + (-1)(0) = -1$\n- $(A^2)_{22} = A_{21}A_{12} + A_{22}A_{22} + A_{23}A_{32} + A_{24}A_{42} + A_{25}A_{52} = (-1)(1) + (0)(0) + (0)(-1) + (0)(0) + (1)(0) = -1$\n- $(A^2)_{33} = A_{31}A_{13} + A_{32}A_{23} + A_{33}A_{33} + A_{34}A_{43} + A_{35}A_{53} = (1)(0) + (-1)(0) + (0)(0) + (0)(0) + (0)(-1) = 0$\n- $(A^2)_{44} = A_{41}A_{14} + A_{42}A_{24} + A_{43}A_{34} + A_{44}A_{44} + A_{45}A_{54} = (0)(0) + (0)(0) + (0)(0) + (1)(1) + (-1)(1) = 0$\n- $(A^2)_{55} = A_{51}A_{15} + A_{52}A_{25} + A_{53}A_{35} + A_{54}A_{45} + A_{55}A_{55} = (0)(-1) + (0)(1) + (-1)(0) + (1)(-1) + (0)(0) = -1$\n\n最后，我们将这些对角线元素相加来求迹 $S$：\n$$\nS = (A^2)_{11} + (A^2)_{22} + (A^2)_{33} + (A^2)_{44} + (A^2)_{55} = -1 + (-1) + 0 + 0 + (-1) = -3\n$$\n尽管问题也要求计算每个基因的入度和出度，但计算 $S$ 并不需要这些值。",
            "answer": "$$\n\\boxed{-3}\n$$"
        },
        {
            "introduction": "在理解了网络的静态结构之后，下一步是分析其动态行为。负反馈，即一个基因产物抑制自身的产生，是基因调控网络中最常见和最重要的基序之一，它能起到稳定基因表达水平的作用。这个练习将带你使用常微分方程来模拟一个简单的负自调节回路，并通过求解稳态来预测系统最终将达到的蛋白质浓度。",
            "id": "1435734",
            "problem": "一位合成生物学家正在一个细菌宿主中设计一个简单的基因回路。该回路旨在实现负向自动调节，即一种我们称之为阻遏蛋白（R）的蛋白质会抑制其自身基因的表达。在时间 $t$ 时，阻遏蛋白的浓度用 $R(t)$ 表示。该系统的动力学由以下原理建模：\n\n1.  **生成：** 阻遏蛋白的合成速率由一个抑制性希尔函数描述。当 R 的浓度为零时，其生成速率达到最大值 $k_p$。随着浓度 $R(t)$ 的增加，该蛋白质与其自身的启动子区域结合，从而抑制合成。这种抑制作用由一个常数 $K$ 表征，定义为使生成速率降至其最大值一半时的 R 浓度。该结合过程是非协同的，对应于希尔系数 $n=1$。\n\n2.  **降解：** 阻遏蛋白会不断地从细胞中被移除。该移除过程遵循一级动力学，由降解速率常数 $k_d$ 表征。\n\n所有参数 $k_p$、$k_d$ 和 $K$ 均为正实数常数。经过足够长的时间后，观察到系统达到一个稳定状态，此时阻遏蛋白的浓度不再变化。确定在这个最终的稳定状态下，阻遏蛋白 R 的浓度。你的答案应为一个以参数 $k_p$、$k_d$ 和 $K$ 表示的解析表达式。",
            "solution": "设 $R(t)$ 表示阻遏蛋白的浓度。根据问题描述：\n- 生成过程遵循抑制性希尔函数，其中 $n=1$，在 $R=0$ 时达到最大速率 $k_{p}$，在 $R=K$ 时为半最大速率。因此，生成速率为\n$$\n\\text{Production}(R) = \\frac{k_{p}}{1 + \\frac{R}{K}}.\n$$\n- 降解过程遵循一级动力学，速率常数为 $k_{d}$，因此降解速率为\n$$\n\\text{Degradation}(R) = k_{d} R.\n$$\n\n因此，动力学方程为\n$$\n\\frac{dR}{dt} = \\frac{k_{p}}{1 + \\frac{R}{K}} - k_{d} R.\n$$\n\n在最终的稳定状态（稳态）下，$\\frac{dR}{dt}=0$。因此 $R$ 满足\n$$\n\\frac{k_{p}}{1 + \\frac{R}{K}} - k_{d} R = 0.\n$$\n重新整理可得\n$$\n\\frac{k_{p}}{1 + \\frac{R}{K}} = k_{d} R.\n$$\n两边同乘以 $1 + \\frac{R}{K}$：\n$$\nk_{p} = k_{d} R \\left(1 + \\frac{R}{K}\\right) = k_{d} R + \\frac{k_{d}}{K} R^{2}.\n$$\n因此 $R$ 满足以下二次方程\n$$\n\\frac{k_{d}}{K} R^{2} + k_{d} R - k_{p} = 0.\n$$\n设 $a = \\frac{k_{d}}{K}$，$b = k_{d}$，及 $c = -k_{p}$。根据二次方程求根公式，\n$$\nR = \\frac{-b \\pm \\sqrt{b^{2} - 4 a c}}{2 a} = \\frac{-k_{d} \\pm \\sqrt{k_{d}^{2} + \\frac{4 k_{d} k_{p}}{K}}}{2 \\frac{k_{d}}{K}}.\n$$\n由于 $k_{p}, k_{d}, K > 0$，具有物理意义的（非负）根应取正号。在平方根内提取因子 $k_{d}$ 进行化简，\n$$\nR^{\\ast} = \\frac{K}{2 k_{d}} \\left(-k_{d} + \\sqrt{k_{d}^{2} + \\frac{4 k_{d} k_{p}}{K}}\\right)\n= \\frac{K}{2} \\left(-1 + \\sqrt{1 + \\frac{4 k_{p}}{k_{d} K}}\\right).\n$$\n这就是以 $k_{p}$、$k_{d}$ 和 $K$ 表示的阻遏蛋白的稳态浓度。",
            "answer": "$$\\boxed{\\frac{K}{2}\\left(\\sqrt{1+\\frac{4 k_{p}}{k_{d} K}}-1\\right)}$$"
        },
        {
            "introduction": "许多生物过程，如细胞分化，依赖于能够做出“非此即彼”决定的分子开关。基因触发器（toggle switch）是一个经典的双基因回路，它能够实现这种双稳态行为。仅仅找到系统的稳态是不够的，我们还必须确定它们的稳定性。这个练习将引导你应用线性稳定性分析，通过构建雅可比矩阵和计算其特征值，来判断一个双基因抑制系统的稳态是稳定的还是不稳定的，这对于理解基因调控网络如何实现记忆和决策功能至关重要。",
            "id": "4345428",
            "problem": "考虑在单个充分混合的细胞中的一个最小双基因调控网络，该网络在蛋白质浓度水平上进行建模。设 $x(t)$ 和 $y(t)$ 分别表示基因 $X$ 和基因 $Y$ 的蛋白质浓度，单位为纳摩尔 (nM)。基因 $Y$ 通过系数为 $n$ 的希尔型抑制来抑制 $X$ 的产生，基因 $X$ 通过系数为 $m$ 的希尔型抑制来抑制 $Y$ 的产生。假设合成和降解遵循标准的质量作用动力学和希尔型调控函数，这与分子生物学的中心法则以及广泛使用的基因调控网络 (GRN) 的唯象模型相一致。其常微分方程 (ODE) 为\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\alpha_{x}}{1 + \\left(\\frac{y}{K_{y}}\\right)^{n}} \\;-\\; \\delta_{x}\\,x,\n\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{\\alpha_{y}}{1 + \\left(\\frac{x}{K_{x}}\\right)^{m}} \\;-\\; \\delta_{y}\\,y,\n$$\n其中 $K_{x}$ 和 $K_{y}$ 是抑制阈值 (nM)，$\\alpha_{x}$ 和 $\\alpha_{y}$ 是最大合成速率 (nM/min)，$\\delta_{x}$ 和 $\\delta_{y}$ 是一阶降解速率常数 (min$^{-1}$)。参数值如下：\n$$\n\\delta_{x} = 0.20,\\quad \\delta_{y} = 0.25,\\quad K_{x} = 100,\\quad K_{y} = 80,\\quad n = 2,\\quad m = 1,\n$$\n并且选择合成速率，使得稳态出现在抑制阈值处：\n$$\n\\alpha_{x} = 2\\,\\delta_{x}\\,K_{x},\\qquad \\alpha_{y} = 2\\,\\delta_{y}\\,K_{y}.\n$$\n从给定的 ODE 和定义出发，完成以下任务：\n1. 验证在给定的参数选择下，$\\big(x^{\\ast}, y^{\\ast}\\big) = \\big(K_{x}, K_{y}\\big)$ 是一个稳态。\n2. 在 $\\big(x^{\\ast}, y^{\\ast}\\big)$ 附近对系统进行线性化，并构建雅可比矩阵 $J$，其元素为 $J_{ij} = \\left.\\frac{\\partial f_{i}}{\\partial z_{j}}\\right|_{(x^{\\ast}, y^{\\ast})}$，其中 $\\mathbf{f} = \\big(f_{x}, f_{y}\\big)$ 是 ODE 的右侧项，$\\mathbf{z} = (x,y)$。\n3. 使用线性稳定性分析的基本原理，通过计算 $J$ 的特征值来评估 $\\big(x^{\\ast}, y^{\\ast}\\big)$ 处的局部稳定性，并报告这些特征值中的最大实部。\n\n答案规格：\n- 提供 $J$ 的特征值的最大实部，形式为单个实数。\n- 以 min$^{-1}$ 为单位表示最终数值答案。\n- 将您的答案四舍五入到四位有效数字。",
            "solution": "题目要求分析一个双基因调控网络在指定稳态下的局部稳定性。分析过程分三步：首先，验证稳态；其次，通过在稳态点对系统进行线性化来构建雅可比矩阵；第三，计算雅可比矩阵的特征值以确定稳定性。\n\n常微分方程 (ODE) 系统由下式给出：\n$$\n\\frac{dx}{dt} = f_{x}(x, y) = \\frac{\\alpha_{x}}{1 + \\left(\\frac{y}{K_{y}}\\right)^{n}} - \\delta_{x}\\,x,\n$$\n$$\n\\frac{dy}{dt} = f_{y}(x, y) = \\frac{\\alpha_{y}}{1 + \\left(\\frac{x}{K_{x}}\\right)^{m}} - \\delta_{y}\\,y.\n$$\n\n参数值如下：\n$\\delta_{x} = 0.20$，$\\delta_{y} = 0.25$，$K_{x} = 100$，$K_{y} = 80$，$n = 2$，$m = 1$。\n合成速率定义为 $\\alpha_{x} = 2\\,\\delta_{x}\\,K_{x}$ 和 $\\alpha_{y} = 2\\,\\delta_{y}\\,K_{y}$。\n\n**步骤1：验证稳态**\n\n稳态 $(x^{\\ast}, y^{\\ast})$ 是一个时间导数均为零的点，即 $f_{x}(x^{\\ast}, y^{\\ast}) = 0$ 且 $f_{y}(x^{\\ast}, y^{\\ast}) = 0$。我们必须验证 $(x^{\\ast}, y^{\\ast}) = (K_{x}, K_{y})$ 是一个稳态。\n\n将 $x = K_{x}$ 和 $y = K_{y}$ 代入第一个 ODE：\n$$\n\\left.\\frac{dx}{dt}\\right|_{(K_{x}, K_{y})} = \\frac{\\alpha_{x}}{1 + \\left(\\frac{K_{y}}{K_{y}}\\right)^{n}} - \\delta_{x}K_{x} = \\frac{\\alpha_{x}}{1 + 1^{n}} - \\delta_{x}K_{x} = \\frac{\\alpha_{x}}{2} - \\delta_{x}K_{x}.\n$$\n使用给定的关系式 $\\alpha_{x} = 2\\,\\delta_{x}\\,K_{x}$，我们得到：\n$$\n\\frac{2\\,\\delta_{x}\\,K_{x}}{2} - \\delta_{x}K_{x} = \\delta_{x}K_{x} - \\delta_{x}K_{x} = 0.\n$$\n将 $x = K_{x}$ 和 $y = K_{y}$ 代入第二个 ODE：\n$$\n\\left.\\frac{dy}{dt}\\right|_{(K_{x}, K_{y})} = \\frac{\\alpha_{y}}{1 + \\left(\\frac{K_{x}}{K_{x}}\\right)^{m}} - \\delta_{y}K_{y} = \\frac{\\alpha_{y}}{1 + 1^{m}} - \\delta_{y}K_{y} = \\frac{\\alpha_{y}}{2} - \\delta_{y}K_{y}.\n$$\n使用给定的关系式 $\\alpha_{y} = 2\\,\\delta_{y}\\,K_{y}$，我们得到：\n$$\n\\frac{2\\,\\delta_{y}\\,K_{y}}{2} - \\delta_{y}K_{y} = \\delta_{y}K_{y} - \\delta_{y}K_{y} = 0.\n$$\n由于两个导数都为零，因此确认 $(x^{\\ast}, y^{\\ast}) = (K_{x}, K_{y})$ 是系统的一个稳态。\n\n**步骤2：构建雅可比矩阵**\n\n系统的雅可比矩阵 $J$ 定义为：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f_x}{\\partial x} & \\frac{\\partial f_x}{\\partial y} \\\\ \\frac{\\partial f_y}{\\partial x} & \\frac{\\partial f_y}{\\partial y} \\end{pmatrix}.\n$$\n我们计算四个偏导数：\n$$\nJ_{11} = \\frac{\\partial f_x}{\\partial x} = -\\delta_x\n$$\n$$\nJ_{12} = \\frac{\\partial f_x}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\alpha_x \\left(1 + \\left(\\frac{y}{K_y}\\right)^n \\right)^{-1} \\right) = -\\alpha_x \\left(1 + \\left(\\frac{y}{K_y}\\right)^n \\right)^{-2} \\left( n\\frac{y^{n-1}}{K_y^n} \\right)\n$$\n$$\nJ_{21} = \\frac{\\partial f_y}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\alpha_y \\left(1 + \\left(\\frac{x}{K_x}\\right)^m \\right)^{-1} \\right) = -\\alpha_y \\left(1 + \\left(\\frac{x}{K_x}\\right)^m \\right)^{-2} \\left( m\\frac{x^{m-1}}{K_x^m} \\right)\n$$\n$$\nJ_{22} = \\frac{\\partial f_y}{\\partial y} = -\\delta_y\n$$\n现在，我们在稳态 $(x^{\\ast}, y^{\\ast}) = (K_x, K_y)$ 处计算这些导数的值：\n$$\nJ_{11} = -\\delta_x\n$$\n$$\nJ_{12} = -\\alpha_x \\left(1 + \\left(\\frac{K_y}{K_y}\\right)^n \\right)^{-2} \\left( n\\frac{K_y^{n-1}}{K_y^n} \\right) = -\\alpha_x (1+1)^{-2} \\left( \\frac{n}{K_y} \\right) = -\\frac{n\\alpha_x}{4K_y}\n$$\n$$\nJ_{21} = -\\alpha_y \\left(1 + \\left(\\frac{K_x}{K_x}\\right)^m \\right)^{-2} \\left( m\\frac{K_x^{m-1}}{K_x^m} \\right) = -\\alpha_y (1+1)^{-2} \\left( \\frac{m}{K_x} \\right) = -\\frac{m\\alpha_y}{4K_x}\n$$\n$$\nJ_{22} = -\\delta_y\n$$\n代入 $\\alpha_x = 2\\delta_x K_x$ 和 $\\alpha_y = 2\\delta_y K_y$：\n$$\nJ_{12} = -\\frac{n(2\\delta_x K_x)}{4K_y} = -\\frac{n\\delta_x K_x}{2K_y}\n$$\n$$\nJ_{21} = -\\frac{m(2\\delta_y K_y)}{4K_x} = -\\frac{m\\delta_y K_y}{2K_x}\n$$\n因此，稳态下的符号雅可比矩阵为：\n$$\nJ = \\begin{pmatrix} -\\delta_x & -\\frac{n\\delta_x K_x}{2K_y} \\\\ -\\frac{m\\delta_y K_y}{2K_x} & -\\delta_y \\end{pmatrix}\n$$\n代入数值：\n$$\nJ_{11} = -0.20\n$$\n$$\nJ_{12} = -\\frac{2 \\times 0.20 \\times 100}{2 \\times 80} = -\\frac{40}{160} = -0.25\n$$\n$$\nJ_{21} = -\\frac{1 \\times 0.25 \\times 80}{2 \\times 100} = -\\frac{20}{200} = -0.10\n$$\n$$\nJ_{22} = -0.25\n$$\n数值雅可比矩阵为：\n$$\nJ = \\begin{pmatrix} -0.20 & -0.25 \\\\ -0.10 & -0.25 \\end{pmatrix}\n$$\n\n**步骤3：通过特征值进行稳定性分析**\n\n稳态的稳定性由 $J$ 的特征值决定。特征值 $\\lambda$ 是特征方程 $\\det(J - \\lambda I) = 0$ 的根，对于一个 $2 \\times 2$ 矩阵，该方程为 $\\lambda^2 - \\text{tr}(J)\\lambda + \\det(J) = 0$。\n\n首先，我们计算 $J$ 的迹和行列式：\n$$\n\\text{tr}(J) = J_{11} + J_{22} = -0.20 + (-0.25) = -0.45\n$$\n$$\n\\det(J) = J_{11}J_{22} - J_{12}J_{21} = (-0.20)(-0.25) - (-0.25)(-0.10) = 0.050 - 0.025 = 0.025\n$$\n特征方程为：\n$$\n\\lambda^2 - (-0.45)\\lambda + 0.025 = 0 \\implies \\lambda^2 + 0.45\\lambda + 0.025 = 0\n$$\n我们使用公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解这个关于 $\\lambda$ 的二次方程：\n$$\n\\lambda = \\frac{-0.45 \\pm \\sqrt{(0.45)^2 - 4(1)(0.025)}}{2} = \\frac{-0.45 \\pm \\sqrt{0.2025 - 0.1}}{2} = \\frac{-0.45 \\pm \\sqrt{0.1025}}{2}\n$$\n判别式 $\\Delta = 0.1025$ 为正，因此有两个不同的实数特征值。特征值的最大实部将是这两个实数根中较大的一个。\n$$\n\\lambda_{\\text{max}} = \\frac{-0.45 + \\sqrt{0.1025}}{2}\n$$\n对此表达式进行数值计算：\n$$\n\\sqrt{0.1025} \\approx 0.3201562\n$$\n$$\n\\lambda_{\\text{max}} \\approx \\frac{-0.45 + 0.3201562}{2} = \\frac{-0.1298438}{2} = -0.0649219\n$$\n题目要求四舍五入到四位有效数字。\n$$\n\\lambda_{\\text{max}} \\approx -0.06492\n$$\n特征值的单位与雅可比矩阵对角元素的单位相同，即 min$^{-1}$。由于最大实部为负，稳态 $(K_x, K_y)$ 是局部稳定的。\n\n特征值的最大实部约为 $-0.06492$ min$^{-1}$。",
            "answer": "$$\\boxed{-0.06492}$$"
        }
    ]
}