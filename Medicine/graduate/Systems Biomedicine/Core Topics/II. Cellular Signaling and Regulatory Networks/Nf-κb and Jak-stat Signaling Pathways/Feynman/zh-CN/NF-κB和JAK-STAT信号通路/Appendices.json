{
    "hands_on_practices": [
        {
            "introduction": "许多信号通路的最终目的是调节基因表达。本练习以 NF-κB 通路为模型，旨在建立核内转录因子浓度与靶基因启动子激活水平之间的定量联系 。通过应用平衡热力学原理，您将练习构建一个基础模型，以预测细胞如何响应分子浓度的变化，这是定量生物学中的一项基本技能。",
            "id": "4369720",
            "problem": "一个启动子包含一个经典的kappa B基序，该基序能结合活化B细胞核因子κ轻链增强子 (NF-$\\kappa$B)。假设核区室混合均匀且处于稳态，启动子上有一个非协同结合位点，并且启动子结合对游离NF-$\\kappa$B的消耗可忽略不计。设核内游离NF-$\\kappa$B的浓度表示为 $[N]$，游离启动子位点的浓度表示为 $[S]$，NF-$\\kappa$B-启动子复合物的浓度表示为 $[NS]$。解离常数由质量作用平衡定义为 $K_d = \\frac{[N][S]}{[NS]}$。启动子占据率是已结合位点的比例，由 $\\frac{[NS]}{[S] + [NS]}$ 给出，转录速率与占据率成正比。\n\n您测得kappa B基序的 $K_d = 15\\,\\text{nM}$，初始核内游离NF-$\\kappa$B浓度为 $[N] = 10\\,\\text{nM}$。经过细胞因子刺激后，核内游离NF-$\\kappa$B浓度加倍至 $2[N]$。请仅使用$K_d$的质量作用定义和上述假设，推导启动子占据率作为$K_d$和$[N]$的函数，并预测当$[N]$增加两倍时转录速率的倍数变化。将倍数变化报告为一个四舍五入到$4$位有效数字的无量纲小数值。在需要时以$\\text{nM}$为单位表示浓度，但最终的倍数变化不带单位。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、提法恰当且客观。\n**1. 提取已知条件：**\n- 系统：一个启动子，带有一个用于NF-$\\kappa$B的非协同结合位点。\n- 状态变量：$[N]$ (游离NF-$\\kappa$B浓度)，$[S]$ (游离启动子位点浓度)，$[NS]$ (复合物浓度)。\n- 假设：核区室混合均匀，处于稳态平衡，游离NF-$\\kappa$B的消耗可忽略不计。\n- 定义：\n  - 解离常数：$K_d = \\frac{[N][S]}{[NS]}$\n  - 启动子占据率 ($\\theta$)：$\\theta = \\frac{[NS]}{[S] + [NS]}$\n  - 转录速率 ($R_{txn}$)：$R_{txn} \\propto \\theta$\n- 常数和条件：\n  - $K_d = 15\\,\\text{nM}$\n  - 初始NF-$\\kappa$B浓度：$[N]_1 = 10\\,\\text{nM}$\n  - 最终NF-$\\kappa$B浓度：$[N]_2 = 2 \\times [N]_1$\n\n**2. 验证：**\n该问题陈述是有效的。它使用既定的质量作用动力学原理，描述了一个标准的生化平衡模型（$n=1$时的Hill-Langmuir模型）。参数具有生物学合理性，假设陈述清晰，是此类简化分析的标准做法，并且问题提法恰当、明确无歧义。该问题是自洽的，并且在科学上是可靠的。\n\n**3. 求解推导：**\n首要任务是推导启动子占据率$\\theta$作为游离NF-$\\kappa$B浓度$[N]$和解离常数$K_d$的函数表达式。\n\n启动子占据率定义为被NF-$\\kappa$B结合的总启动子位点的比例：\n$$\n\\theta = \\frac{[NS]}{[S]_{total}} = \\frac{[NS]}{[S] + [NS]}\n$$\n系统处于稳态平衡，由解离常数$K_d$描述：\n$$\nK_d = \\frac{[N][S]}{[NS]}\n$$\n我们可以重排这个平衡方程，用其他物种的浓度来表示游离启动子位点的浓度$[S]$：\n$$\n[S] = K_d \\frac{[NS]}{[N]}\n$$\n现在，将这个$[S]$的表达式代入占据率$\\theta$的方程中：\n$$\n\\theta = \\frac{[NS]}{\\left(K_d \\frac{[NS]}{[N]}\\right) + [NS]}\n$$\n项$[NS]$是分数中所有项的公因子。我们可以将其从分母中提取出来：\n$$\n\\theta = \\frac{[NS]}{[NS] \\left(\\frac{K_d}{[N]} + 1\\right)}\n$$\n假设复合物的浓度非零（$[NS] > 0$），我们可以从分子和分母中消去此项：\n$$\n\\theta = \\frac{1}{\\frac{K_d}{[N]} + 1}\n$$\n为了简化这个繁分数，我们将分子和分母同乘以$[N]$：\n$$\n\\theta([N], K_d) = \\frac{[N]}{K_d + [N]}\n$$\n这个表达式给出了启动子占据率作为游离配体浓度$[N]$和解离常数$K_d$的函数，正如所要求的。\n\n第二个任务是计算转录速率的倍数变化。问题陈述说明转录速率$R_{txn}$与占据率$\\theta$成正比。我们可以将此关系写为$R_{txn} = c \\cdot \\theta$，其中$c$是一个比例常数。\n\n转录速率的倍数变化是最终速率($R_2$)与初始速率($R_1$)的比值：\n$$\n\\text{倍数变化} = \\frac{R_2}{R_1} = \\frac{c \\cdot \\theta_2}{c \\cdot \\theta_1} = \\frac{\\theta_2}{\\theta_1}\n$$\n我们需要计算初始占据率$\\theta_1$和最终占据率$\\theta_2$。\n\n给定的初始值和常数值为：\n- 初始NF-$\\kappa$B浓度：$[N]_1 = 10\\,\\text{nM}$\n- 解离常数：$K_d = 15\\,\\text{nM}$\n\n初始占据率$\\theta_1$为：\n$$\n\\theta_1 = \\frac{[N]_1}{K_d + [N]_1} = \\frac{10}{15 + 10} = \\frac{10}{25} = \\frac{2}{5} = 0.4\n$$\n经过细胞因子刺激后，核内游离NF-$\\kappa$B浓度加倍。最终浓度$[N]_2$为：\n$$\n[N]_2 = 2 \\times [N]_1 = 2 \\times 10\\,\\text{nM} = 20\\,\\text{nM}\n$$\n最终占据率$\\theta_2$为：\n$$\n\\theta_2 = \\frac{[N]_2}{K_d + [N]_2} = \\frac{20}{15 + 20} = \\frac{20}{35} = \\frac{4}{7}\n$$\n现在，我们可以通过计算最终占据率与初始占据率的比值来计算倍数变化：\n$$\n\\text{倍数变化} = \\frac{\\theta_2}{\\theta_1} = \\frac{4/7}{2/5} = \\frac{4}{7} \\times \\frac{5}{2} = \\frac{20}{14} = \\frac{10}{7}\n$$\n问题要求答案为四舍五入到$4$位有效数字的小数。\n$$\n\\text{倍数变化} = \\frac{10}{7} \\approx 1.428571...\n$$\n四舍五入到$4$位有效数字得到$1.429$。",
            "answer": "$$\n\\boxed{1.429}\n$$"
        },
        {
            "introduction": "信号通路必须受到精确调控，负反馈是维持体内平衡和终止信号的关键机制。本练习将焦点转移到 JAK-STAT 通路，并运用竞争性酶抑制的框架来模拟负调控因子 SOCS3 的作用 。通过这个练习，您将亲手计算调控元件的突变如何改变通路输出的稳态水平，从而加深对信号衰减动力学的理解。",
            "id": "4369735",
            "problem": "一个细胞因子信号转导模块被建模，用于描述白细胞介素-6 (IL-6) 对Janus激酶–信号转导与转录激活子 (JAK–STAT) 通路的激活过程。磷酸化的信号转导与转录激活子3 (pSTAT3) 由一种激酶活性产生，该活性受IL-6浓度有效驱动，而细胞因子信号抑制因子3 (SOCS3) 通过竞争性抑制IL-6有效激活步骤来负向调节该信号通路。假设这是一个单酶单底物系统，其中STAT3的瞬时磷酸化速率可以很好地用包含竞争性抑制剂的经典酶动力学来描述，并且磷酸化的STAT3稳态满足 $[p\\mathrm{STAT3}]_{\\mathrm{ss}} = v_{\\mathrm{phos}}/k_{\\mathrm{dephos}}$，其中 $k_{\\mathrm{dephos}}$ 不受所考虑的突变影响。\n\n在一次IL-6刺激实验中，使用以下科学上合理且自洽的参数化：\n- IL-6 浓度 $[L] = 1.0 \\,\\mathrm{nM}$。\n- 相对于 $[L]$ 的米氏常数，$K_{m} = 0.50 \\,\\mathrm{nM}$。\n- SOCS3 浓度 $[I] = 20 \\,\\mathrm{nM}$ (不受突变影响)。\n- 野生型SOCS3抑制常数 $K_{i}^{\\mathrm{WT}} = 10 \\,\\mathrm{nM}$。\n- SOCS3的功能丧失性突变使抑制常数增加了5倍，因此 $K_{i}^{\\mathrm{mut}} = 5 \\,K_{i}^{\\mathrm{WT}}$。\n- 催化能力 $V_{\\max}$ 和去磷酸化速率常数 $k_{\\mathrm{dephos}}$ 不受突变影响。\n\n将SOCS3视为相对于IL-6驱动的激活步骤的纯粹竞争性抑制剂。在这些假设下，计算pSTAT3稳态的倍数变化，\n$$\nF \\equiv \\frac{[p\\mathrm{STAT3}]_{\\mathrm{ss}}^{\\mathrm{mut}}}{[p\\mathrm{STAT3}]_{\\mathrm{ss}}^{\\mathrm{WT}}}.\n$$\n将 $F$ 报告为无单位小数。将您的答案四舍五入至四位有效数字。",
            "solution": "用户提供了一个问题陈述，在尝试解决之前需要进行验证。\n\n### 第1步：提取已知信息\n- **模型**：白细胞介素-6 (IL-6) 对Janus激酶–信号转导与转录激活子 (JAK–STAT) 通路的激活被建模为一个单酶单底物系统。\n- **机制**：STAT3的磷酸化速率 $v_{\\mathrm{phos}}$ 由IL-6浓度驱动。细胞因子信号抑制因子3 (SOCS3) 作为此IL-6驱动的激活过程的竞争性抑制剂。\n- **动力学**：磷酸化速率由经典的竞争性抑制酶动力学描述。\n- **稳态**：磷酸化STAT3的稳态浓度 $[p\\mathrm{STAT3}]_{\\mathrm{ss}}$ 由关系式 $[p\\mathrm{STAT3}]_{\\mathrm{ss}} = v_{\\mathrm{phos}}/k_{\\mathrm{dephos}}$ 给出。\n- **常数**：去磷酸化速率常数 $k_{\\mathrm{dephos}}$ 和最大催化能力 $V_{\\max}$ 不受突变影响。\n- **参数**:\n    - IL-6 浓度 (底物): $[L] = 1.0 \\,\\mathrm{nM}$。\n    - IL-6 的米氏常数: $K_{m} = 0.50 \\,\\mathrm{nM}$。\n    - SOCS3 浓度 (抑制剂): $[I] = 20 \\,\\mathrm{nM}$。\n    - 野生型SOCS3抑制常数: $K_{i}^{\\mathrm{WT}} = 10 \\,\\mathrm{nM}$。\n    - 突变型SOCS3抑制常数: $K_{i}^{\\mathrm{mut}} = 5 \\times K_{i}^{\\mathrm{WT}} = 50 \\,\\mathrm{nM}$。\n- **目标**：计算倍数变化 $F \\equiv \\frac{[p\\mathrm{STAT3}]_{\\mathrm{ss}}^{\\mathrm{mut}}}{[p\\mathrm{STAT3}]_{\\mathrm{ss}}^{\\mathrm{WT}}}$。\n\n### 第2步：使用提取的已知信息进行验证\n根据验证标准评估问题陈述。\n\n- **科学依据**：问题描述了一个公认的生物信号通路 (JAK-STAT)、一个已知的激活剂 (IL-6) 和一个已知的负调节因子 (SOCS3)。应用带有竞争性抑制的米氏-孟顿动力学是系统生物学中对此类系统建模的标准且科学合理的方法。抑制剂功能丧失性突变导致抑制常数 ($K_i$) 增加的前提是正确的，因为较高的 $K_i$ 值表示抑制剂结合能力较弱。给定的参数值在合理的生理范围内。该问题具有科学依据。\n- **问题定义良好**：提供了所有必要的参数和关系。问题要求计算一个比率（倍数变化），这使得未知常数（$V_{\\max}$ 和 $k_{\\mathrm{dephos}}$）可以被约去，从而使问题可解。目标明确，预期有唯一解。\n- **客观性**：语言精确且定量，没有主观或含糊的陈述。\n\n该问题不具备任何导致验证无效的缺陷。它科学合理、可形式化、完整且定义良好。\n\n### 第3步：结论与行动\n该问题是**有效的**。将提供解决方案。\n\n### 求解推导\nSTAT3的磷酸化速率 $v_{\\mathrm{phos}}$ 由竞争性抑制的米氏-孟顿方程建模。在此模型中，IL-6作为底物（浓度为 $[L]$），SOCS3作为竞争性抑制剂（浓度为 $[I]$）。速率方程为：\n$$\nv_{\\mathrm{phos}} = \\frac{V_{\\max} [L]}{K_{m}^{\\mathrm{app}} + [L]}\n$$\n对于竞争性抑制，表观米氏常数 $K_{m}^{\\mathrm{app}}$ 按如下方式修正：\n$$\nK_{m}^{\\mathrm{app}} = K_m \\left(1 + \\frac{[I]}{K_i}\\right)\n$$\n将此代入速率方程得到：\n$$\nv_{\\mathrm{phos}} = \\frac{V_{\\max} [L]}{K_m \\left(1 + \\frac{[I]}{K_i}\\right) + [L]}\n$$\n问题陈述指出，pSTAT3的稳态浓度 $[p\\mathrm{STAT3}]_{\\mathrm{ss}}$ 与此速率成正比：\n$$\n[p\\mathrm{STAT3}]_{\\mathrm{ss}} = \\frac{v_{\\mathrm{phos}}}{k_{\\mathrm{dephos}}}\n$$\n我们可以写出野生型 (WT) 和突变型 (mut) 情况下的稳态浓度。\n\n对于野生型，抑制常数为 $K_{i}^{\\mathrm{WT}}$。稳态浓度为：\n$$\n[p\\mathrm{STAT3}]_{\\mathrm{ss}}^{\\mathrm{WT}} = \\frac{1}{k_{\\mathrm{dephos}}} \\cdot v_{\\mathrm{phos}}^{\\mathrm{WT}} = \\frac{1}{k_{\\mathrm{dephos}}} \\cdot \\frac{V_{\\max} [L]}{K_m \\left(1 + \\frac{[I]}{K_{i}^{\\mathrm{WT}}}\\right) + [L]}\n$$\n对于突变型，抑制常数为 $K_{i}^{\\mathrm{mut}}$。问题陈述指出 $V_{\\max}$、$k_{\\mathrm{dephos}}$、$[L]$、$[I]$ 和 $K_m$ 保持不变。稳态浓度为：\n$$\n[p\\mathrm{STAT3}]_{\\mathrm{ss}}^{\\mathrm{mut}} = \\frac{1}{k_{\\mathrm{dephos}}} \\cdot v_{\\mathrm{phos}}^{\\mathrm{mut}} = \\frac{1}{k_{\\mathrm{dephos}}} \\cdot \\frac{V_{\\max} [L]}{K_m \\left(1 + \\frac{[I]}{K_{i}^{\\mathrm{mut}}}\\right) + [L]}\n$$\n所求量为倍数变化 $F$：\n$$\nF = \\frac{[p\\mathrm{STAT3}]_{\\mathrm{ss}}^{\\mathrm{mut}}}{[p\\mathrm{STAT3}]_{\\mathrm{ss}}^{\\mathrm{WT}}} = \\frac{\\frac{1}{k_{\\mathrm{dephos}}} \\cdot \\frac{V_{\\max} [L]}{K_m \\left(1 + \\frac{[I]}{K_{i}^{\\mathrm{mut}}}\\right) + [L]}}{\\frac{1}{k_{\\mathrm{dephos}}} \\cdot \\frac{V_{\\max} [L]}{K_m \\left(1 + \\frac{[I]}{K_{i}^{\\mathrm{WT}}}\\right) + [L]}}\n$$\n分子和分母中的项 $\\frac{1}{k_{\\mathrm{dephos}}}$、$V_{\\max}$ 和 $[L]$ 可以约去，表达式简化为：\n$$\nF = \\frac{K_m \\left(1 + \\frac{[I]}{K_{i}^{\\mathrm{WT}}}\\right) + [L]}{K_m \\left(1 + \\frac{[I]}{K_{i}^{\\mathrm{mut}}}\\right) + [L]}\n$$\n现在，我们代入给定的数值：\n- $[L] = 1.0 \\,\\mathrm{nM}$\n- $K_{m} = 0.50 \\,\\mathrm{nM}$\n- $[I] = 20 \\,\\mathrm{nM}$\n- $K_{i}^{\\mathrm{WT}} = 10 \\,\\mathrm{nM}$\n- $K_{i}^{\\mathrm{mut}} = 5 \\times K_{i}^{\\mathrm{WT}} = 5 \\times 10 \\,\\mathrm{nM} = 50 \\,\\mathrm{nM}$\n\n我们计算 $F$ 表达式的分子：\n$$\n\\text{分子} = K_m \\left(1 + \\frac{[I]}{K_{i}^{\\mathrm{WT}}}\\right) + [L] = 0.50 \\left(1 + \\frac{20}{10}\\right) + 1.0\n$$\n$$\n\\text{分子} = 0.50(1 + 2) + 1.0 = 0.50(3) + 1.0 = 1.5 + 1.0 = 2.5\n$$\n接下来，我们计算分母：\n$$\n\\text{分母} = K_m \\left(1 + \\frac{[I]}{K_{i}^{\\mathrm{mut}}}\\right) + [L] = 0.50 \\left(1 + \\frac{20}{50}\\right) + 1.0\n$$\n$$\n\\text{分母} = 0.50(1 + 0.4) + 1.0 = 0.50(1.4) + 1.0 = 0.7 + 1.0 = 1.7\n$$\n最后，我们计算倍数变化 $F$：\n$$\nF = \\frac{2.5}{1.7} \\approx 1.4705882...\n$$\n将结果四舍五入至四位有效数字，我们得到：\n$$\nF \\approx 1.471\n$$\n这一结果表明，SOCS3抑制剂的功能丧失性突变削弱了其结合亲和力，在这些条件下导致磷酸化STAT3的稳态水平增加了约 $47.1\\%$。这与负调节因子效力降低的生物学现象相符。",
            "answer": "$$\\boxed{1.471}$$"
        },
        {
            "introduction": "理论模型必须与实验数据相结合才能发挥其预测能力。这项实践性的编码练习旨在连接理论与实验，要求您分析模拟的蛋白质印迹（Western blot）时间序列数据，这些数据涉及 NF-κB 和 JAK-STAT 通路中的关键蛋白（IκBα 和 pSTAT3） 。您将通过拟合一级动力学模型来估算降解速率和半衰期等基本参数，这是系统生物学家必备的核心技能。",
            "id": "4369738",
            "problem": "本问题提供了一个来自Western blot实验的时间分辨光密度测定数据集，该数据集涉及活化B细胞核因子κ轻链增强子（NF-κB）信号通路中kappa B抑制蛋白alpha（IκBα）的降解，以及Janus激酶-信号转导与转录激活因子（JAK-STAT）信号通路中磷酸化信号转导与转录激活因子3（pSTAT3）的去磷酸化。这些测量值代表相对于时间 $t = 0$ 分钟处初始值归一化的相对条带强度，因此所有初始值在任意单位下均约为 $1$。请假设以下基于原理的动力学基础：在刺激下，IκBα的降解和pSTAT3的去磷酸化遵循一级质量作用动力学，趋向一个非零的稳态基线，该基线反映了由合成或基础激酶/磷酸酶活性维持的残留蛋白或磷酸化水平。任务是使用基于原理的指数拟合方法，对所提供的时程数据进行拟合，从而估算两种分子种类的动力学速率常数并计算其半衰期。\n\n您必须设计程序，通过拟合一个与趋向基线的一阶过程相符的模型，来为每个轨迹推断一阶速率常数。将初始值视为 $t = 0$ 分钟时的测量值。对于每个轨迹，估算速率常数 $k$（单位为 $\\text{min}^{-1}$）和半衰期 $t_{1/2}$（单位为分钟），其中半衰期定义为与基线的偏差减少到 $1/2$ 所需的时间。所有半衰期均以分钟表示，四舍五入到 $4$ 位小数。所有速率常数均以 $\\text{min}^{-1}$ 表示，四舍五入到 $4$ 位小数。\n\n为每个轨迹实现一个拟合程序，该程序对小的测量噪声具有鲁棒性，并且能够处理有限的数据点。对于每个测试用例，您必须报告一个包含四个值的列表，顺序如下：IκBα的估算速率常数 $k$（单位 $\\text{min}^{-1}$），IκBα的估算半衰期 $t_{1/2}$（单位分钟），pSTAT3的估算速率常数 $k$（单位 $\\text{min}^{-1}$），pSTAT3的估算半衰期 $t_{1/2}$（单位分钟）。所有报告值必须四舍五入到 $4$ 位小数。\n\n请使用以下针对IκBα和pSTAT3的时间点（单位：分钟）和归一化光密度强度（无量纲）的测试套件。每个测试用例由 $(t, \\text{IκBα}(t), \\text{pSTAT3}(t))$ 组成：\n\n- 测试用例 1（一般情况，中度衰减至非零基线）：\n  - $t = [\\,0, 5, 10, 20, 40, 60\\,]$\n  - $\\text{IκBα}(t) = [\\,1.00, 0.78, 0.62, 0.40, 0.23, 0.19\\,]$\n  - $\\text{pSTAT3}(t) = [\\,1.00, 0.84, 0.72, 0.50, 0.28, 0.19\\,]$\n\n- 测试用例 2（去磷酸化缓慢，降解中度）：\n  - $t = [\\,0, 15, 30, 60, 120\\,]$\n  - $\\text{IκBα}(t) = [\\,1.00, 0.79, 0.64, 0.44, 0.27\\,]$\n  - $\\text{pSTAT3}(t) = [\\,1.00, 0.93, 0.87, 0.75, 0.57\\,]$\n\n- 测试用例 3（数据点最少的边界情况）：\n  - $t = [\\,0, 30, 90\\,]$\n  - $\\text{IκBα}(t) = [\\,1.00, 0.47, 0.16\\,]$\n  - $\\text{pSTAT3}(t) = [\\,1.00, 0.79, 0.53\\,]$\n\n- 测试用例 4（含噪声数据和非零基线）：\n  - $t = [\\,0, 10, 20, 30, 40, 50\\,]$\n  - $\\text{IκBα}(t) = [\\,1.00, 0.71, 0.54, 0.43, 0.36, 0.34\\,]$\n  - $\\text{pSTAT3}(t) = [\\,1.00, 0.80, 0.66, 0.51, 0.40, 0.34\\,]$\n\n您的程序必须生成单行输出，其中包含一个以逗号分隔的列表的列表，用方括号括起来，并严格按照上述测试用例的顺序排列。例如，一个有效的输出形状是\n$[\\,[k_{\\text{IκBα},1}, t_{1/2,\\text{IκBα},1}, k_{\\text{pSTAT3},1}, t_{1/2,\\text{pSTAT3},1}],\\,[k_{\\text{IκBα},2}, t_{1/2,\\text{IκBα},2}, k_{\\text{pSTAT3},2}, t_{1/2,\\text{pSTAT3},2}],\\,\\dots\\,]$,\n其中每个 $k$ 的单位是 $\\text{min}^{-1}$，每个 $t_{1/2}$ 的单位是分钟，每个数值条目都四舍五入到 $4$ 位小数，不打印单位。\n\n最终输出必须严格按照要求的单行格式打印。",
            "solution": "该问题是有效的。它在科学上基于既定的生物化学动力学原理，在数学上是适定的，并以客观、正式的方式呈现。提供了唯一解所需的所有数据和定义。\n\n目标是估算IκBα降解和pSTAT3去磷酸化的一阶速率常数 $k$ 及相应的半衰期 $t_{1/2}$。这需要通过将动力学模型拟合到所提供的时程数据来实现。\n\n### 第 1 步：动力学过程的数学建模\n\n问题指出，该过程遵循一级质量作用动力学，趋向一个非零的稳态基线。设 $C(t)$ 表示分子种类在时间 $t$ 的浓度（或归一化强度），$B$ 为非零基线浓度。$C(t)$ 的变化速率与当前浓度和基线之间的差值成正比。这可以表示为常微分方程（ODE）：\n$$\n\\frac{dC(t)}{dt} = -k(C(t) - B)\n$$\n其中 $k$ 是一阶速率常数，单位为时间倒数（此处为 $\\text{min}^{-1}$）。\n\n这是一个可分离的一阶线性常微分方程。我们可以通过分离变量并积分来求解它：\n$$\n\\int_{C_0}^{C(t)} \\frac{dC'}{C' - B} = \\int_{0}^{t} -k \\, dt'\n$$\n其中 $C_0 = C(0)$ 是初始浓度。积分得出：\n$$\n[\\ln|C' - B|]_{C_0}^{C(t)} = [-kt']_{0}^{t}\n$$\n$$\n\\ln|C(t) - B| - \\ln|C_0 - B| = -kt\n$$\n$$\n\\ln\\left(\\frac{C(t) - B}{C_0 - B}\\right) = -kt\n$$\n对两边取指数，得到 $C(t)$ 的解：\n$$\nC(t) = (C_0 - B)e^{-kt} + B\n$$\n问题指明数据经过归一化，使得 $t=0$ 时的初始值为 $1.0$。因此，我们设定初始条件 $C_0 = 1$。用于拟合数据的模型变为：\n$$\nC(t) = (1 - B)e^{-kt} + B\n$$\n对于每个轨迹，需要从实验数据中估计的参数是速率常数 $k$ 和基线 $B$。\n\n### 第 2 步：通过非线性最小二乘法进行参数估计\n\n为了从提供的数据点 $(t_i, C_i)$ 估计参数 $k$ 和 $B$，我们使用非线性最小二乘法。该方法寻找使模型预测值与测量数据之间的残差平方和（SSR）最小化的参数值：\n$$\nSSR(k, B) = \\sum_{i} [C_i - C(t_i; k, B)]^2 = \\sum_{i} \\left[C_i - \\left((1 - B)e^{-kt_i} + B\\right)\\right]^2\n$$\n此最小化过程将使用 `scipy.optimize.curve_fit` 函数进行数值计算，该函数非常适合将用户定义的函数拟合到数据。该函数通常实现Levenberg-Marquardt算法。为保证鲁棒性，我们必须为参数提供物理上合理的边界：\n- 速率常数 $k$ 必须为非负数，所以 $k \\ge 0$。\n- 基线浓度 $B$ 必须为非负数。由于浓度从初始值 $1$ 开始衰减，基线不能超过此初始值。因此，$0 \\le B \\le 1$。\n\n### 第 3 步：半衰期的计算\n\n半衰期 $t_{1/2}$ 被定义为“与基线的偏差减少 $1/2$ 所需的时间”。在时间 $t$ 时与基线的偏差由 $C(t) - B$ 给出。在 $t=0$ 时，初始偏差为 $C_0 - B$。我们寻求时间 $t_{1/2}$ 使得：\n$$\nC(t_{1/2}) - B = \\frac{1}{2}(C_0 - B)\n$$\n代入模型方程 $C(t) - B = (C_0 - B)e^{-kt}$：\n$$\n(C_0 - B)e^{-kt_{1/2}} = \\frac{1}{2}(C_0 - B)\n$$\n假设初始浓度不等于基线（$C_0 \\neq B$），我们可以除以 $(C_0 - B)$：\n$$\ne^{-kt_{1/2}} = \\frac{1}{2}\n$$\n对两边取自然对数：\n$$\n-kt_{1/2} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n$$\n求解 $t_{1/2}$ 得到一阶过程的经典公式：\n$$\nt_{1/2} = \\frac{\\ln(2)}{k}\n$$\n一旦通过数据拟合估算出速率常数 $k$，就可以直接计算半衰期 $t_{1/2}$。由于时间数据的单位是分钟，拟合出的 $k$ 的单位将是 $\\text{min}^{-1}$，得到的 $t_{1/2}$ 的单位将是分钟。\n\n### 第 4 步：实施策略\n\n对于每个测试用例和每个分子种类（IκBα 和 pSTAT3），应用以下步骤：\n1.  将时程数据 $(t, C(t))$ 作为输入提供给 `curve_fit` 函数。\n2.  拟合函数定义为 $f(t, k, B) = (1 - B)e^{-kt} + B$。\n3.  为参数 ($k, B$) 提供初始猜测值和指定的边界（$k \\in [0, \\infty)$, $B \\in [0, 1]$）给拟合算法，以确保收敛到物理上有意义的解。对于 $B$ 的一个合理初始猜测是最后一个数据点，对于 $k$ 的合理初始猜测是最后一个时间点的倒数。\n4.  算法返回 $k$ 和 $B$ 的优化值。\n5.  使用公式 $t_{1/2} = \\ln(2)/k$ 计算半衰期 $t_{1/2}$。\n6.  按要求将估算的 $k$ 和计算出的 $t_{1/2}$ 四舍五入到 $4$ 位小数。对所有轨迹重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves for kinetic parameters from time-course data based on a first-order\n    decay model to a non-zero baseline.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"t\": [0, 5, 10, 20, 40, 60],\n            \"ikba\": [1.00, 0.78, 0.62, 0.40, 0.23, 0.19],\n            \"pstat3\": [1.00, 0.84, 0.72, 0.50, 0.28, 0.19],\n        },\n        {\n            \"t\": [0, 15, 30, 60, 120],\n            \"ikba\": [1.00, 0.79, 0.64, 0.44, 0.27],\n            \"pstat3\": [1.00, 0.93, 0.87, 0.75, 0.57],\n        },\n        {\n            \"t\": [0, 30, 90],\n            \"ikba\": [1.00, 0.47, 0.16],\n            \"pstat3\": [1.00, 0.79, 0.53],\n        },\n        {\n            \"t\": [0, 10, 20, 30, 40, 50],\n            \"ikba\": [1.00, 0.71, 0.54, 0.43, 0.36, 0.34],\n            \"pstat3\": [1.00, 0.80, 0.66, 0.51, 0.40, 0.34],\n        },\n    ]\n\n    def model_func(t, k, B):\n        \"\"\"\n        Defines the first-order decay model to a non-zero baseline.\n        C(t) = (C0 - B) * exp(-k*t) + B, with C0 = 1.0.\n        \n        Args:\n            t (np.ndarray): Time points.\n            k (float): First-order rate constant.\n            B (float): Non-zero baseline.\n        \n        Returns:\n            np.ndarray: Modeled concentration at time points t.\n        \"\"\"\n        return (1.0 - B) * np.exp(-k * t) + B\n\n    def process_trajectory(t_data, y_data):\n        \"\"\"\n        Fits the model to a single data trajectory to find k and calculates t_1/2.\n        \n        Args:\n            t_data (np.ndarray): Time data.\n            y_data (np.ndarray): Concentration data.\n            \n        Returns:\n            tuple[float, float]: Estimated rate constant k and half-life t_1/2.\n        \"\"\"\n        # Heuristic initial guesses for parameters k and B for robustness.\n        # Guess k as the reciprocal of the last time point.\n        # Guess B as the last measured concentration.\n        # Handle case where t_data might only have one point after t=0.\n        k_guess = 1.0 / t_data[-1] if t_data[-1] > 0 else 0.1\n        b_guess = y_data[-1]\n        p0 = [k_guess, b_guess]\n        \n        # Define physical bounds for parameters. k must be non-negative.\n        # B must be between 0 and 1 (inclusive).\n        bounds = ([0, 0], [np.inf, 1.0])\n        \n        try:\n            params, _ = curve_fit(model_func, t_data, y_data, p0=p0, bounds=bounds, maxfev=5000)\n            k_est, _ = params\n        except RuntimeError:\n            # Fallback in case of fitting failure, though unlikely with these data\n            k_est = 0.0\n\n        # Calculate half-life from the estimated rate constant\n        if k_est > 0:\n            t_half = np.log(2) / k_est\n        else:\n            t_half = np.inf\n            \n        return k_est, t_half\n\n    all_results = []\n    for case in test_cases:\n        t_arr = np.array(case[\"t\"], dtype=float)\n        ikba_arr = np.array(case[\"ikba\"], dtype=float)\n        pstat3_arr = np.array(case[\"pstat3\"], dtype=float)\n\n        k_ikba, t_half_ikba = process_trajectory(t_arr, ikba_arr)\n        k_pstat3, t_half_pstat3 = process_trajectory(t_arr, pstat3_arr)\n        \n        case_results = [k_ikba, t_half_ikba, k_pstat3, t_half_pstat3]\n        all_results.append(case_results)\n\n    # Format the final output string exactly as specified.\n    # Each sublist is converted to a string with numbers formatted to 4 decimal places.\n    # These sublist strings are then joined by commas and enclosed in brackets.\n    sublist_strings = []\n    for res in all_results:\n        formatted_res = [f'{x:.4f}' for x in res]\n        sublist_strings.append(f\"[{','.join(formatted_res)}]\")\n    \n    final_output_string = f\"[{','.join(sublist_strings)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}