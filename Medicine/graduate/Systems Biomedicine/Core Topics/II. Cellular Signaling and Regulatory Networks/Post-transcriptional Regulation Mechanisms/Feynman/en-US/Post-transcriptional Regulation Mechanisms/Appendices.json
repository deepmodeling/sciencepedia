{
    "hands_on_practices": [
        {
            "introduction": "To quantitatively understand post-transcriptional regulation, we first need a mathematical framework to describe the lifecycle of an mRNA molecule. This practice guides you through building a foundational model of gene expression using mass-action kinetics, a core principle in systems biology. By translating the biological steps of transcription, processing, export, and decay into a system of ordinary differential equations, you will derive the steady-state abundance of cytoplasmic mRNA, revealing how the cell maintains equilibrium . This exercise develops essential skills in mathematical modeling and provides a critical insight: at steady state, the concentration of the final product is determined solely by the overall production and degradation rates.",
            "id": "4376249",
            "problem": "Consider a two-compartment post-transcriptional regulation model in a single cell within the systems biomedicine framework. In the nuclear compartment, newly synthesized unprocessed precursor messenger ribonucleic acid (pre-mRNA) molecules are produced at transcription rate $\\alpha$ (units: molecules per unit time). These nuclear pre-mRNA molecules are processed to mature nuclear messenger ribonucleic acid (mRNA) at a first-order nuclear processing rate $k_{p}$ (units: per unit time). Mature nuclear mRNA is exported to the cytoplasm at a first-order export rate $k_{e}$ (units: per unit time). In the cytoplasmic compartment, mature mRNA is degraded at a first-order cytoplasmic decay rate $\\delta$ (units: per unit time). Assume the following foundational bases:\n- The Central Dogma of molecular biology establishes that messenger ribonucleic acid (mRNA) is synthesized from deoxyribonucleic acid (DNA), processed, and exported to the cytoplasm where it can be translated and degraded.\n- Under mass-action kinetics, the instantaneous rate of each unimolecular transition is proportional to the abundance of the substrate species involved, with proportionality constants given by the rate parameters.\n\nUse these bases to formulate a dynamical system for the abundances of nuclear pre-mRNA, mature nuclear mRNA, and cytoplasmic mature mRNA, treating the abundances as absolute molecule counts. Assume all parameters $\\alpha$, $k_{p}$, $k_{e}$, and $\\delta$ are positive constants, there is no nuclear degradation, and the system reaches a time-invariant steady state.\n\nStarting from the mass-action dynamical system you construct, derive the steady-state abundance of cytoplasmic mature mRNA as a closed-form analytic expression in terms of $\\alpha$, $k_{p}$, $k_{e}$, and $\\delta$. Express the final abundance in molecules. Provide your answer as a single closed-form expression and do not include units inside the expression. No numerical evaluation or rounding is required.",
            "solution": "The problem requires the derivation of the steady-state abundance of cytoplasmic mature messenger ribonucleic acid (mRNA) based on a two-compartment model of post-transcriptional regulation. The problem is valid as it is scientifically grounded in molecular biology, well-posed, and objective. It provides a complete set of parameters and constraints to formulate a solvable mathematical model.\n\nFirst, we define the variables representing the abundances (absolute molecule counts) of the species in the system as functions of time $t$.\nLet $P(t)$ be the abundance of nuclear pre-mRNA.\nLet $N(t)$ be the abundance of mature nuclear mRNA.\nLet $C(t)$ be the abundance of cytoplasmic mature mRNA.\n\nThe problem statement describes the following processes, which we translate into a system of ordinary differential equations (ODEs) based on the principle of mass-action kinetics:\n\n1.  **Nuclear pre-mRNA ($P(t)$):** Pre-mRNA is produced at a constant transcription rate $\\alpha$. It is consumed by being processed into mature nuclear mRNA at a first-order rate $k_{p}$, meaning the rate of consumption is $k_{p}P(t)$. The problem specifies no other production or consumption terms for $P(t)$.\n    The rate of change of $P(t)$ is given by:\n    $$ \\frac{dP}{dt} = \\alpha - k_{p}P(t) $$\n\n2.  **Mature nuclear mRNA ($N(t)$):** Mature nuclear mRNA is produced from the processing of pre-mRNA at a rate of $k_{p}P(t)$. It is consumed by being exported to the cytoplasm at a first-order rate $k_{e}$, meaning the rate of consumption is $k_{e}N(t)$. The problem states to assume no nuclear degradation.\n    The rate of change of $N(t)$ is given by:\n    $$ \\frac{dN}{dt} = k_{p}P(t) - k_{e}N(t) $$\n\n3.  **Cytoplasmic mature mRNA ($C(t)$):** Cytoplasmic mRNA is produced from the export of mature nuclear mRNA at a rate of $k_{e}N(t)$. It is consumed by degradation at a first-order rate $\\delta$, meaning the rate of consumption is $\\delta C(t)$.\n    The rate of change of $C(t)$ is given by:\n    $$ \\frac{dC}{dt} = k_{e}N(t) - \\delta C(t) $$\n\nThe problem asks for the steady-state abundance. At steady state, the system is time-invariant, which implies that the rate of change for each species is zero. We denote the steady-state abundances as $P_{ss}$, $N_{ss}$, and $C_{ss}$.\n$$ \\frac{dP}{dt} = 0, \\quad \\frac{dN}{dt} = 0, \\quad \\frac{dC}{dt} = 0 $$\n\nWe solve the resulting system of algebraic equations sequentially.\n\nFrom the equation for $P(t)$, we have:\n$$ 0 = \\alpha - k_{p}P_{ss} $$\nSolving for $P_{ss}$ yields:\n$$ k_{p}P_{ss} = \\alpha $$\n$$ P_{ss} = \\frac{\\alpha}{k_{p}} $$\n\nNext, we use the steady-state equation for $N(t)$:\n$$ 0 = k_{p}P_{ss} - k_{e}N_{ss} $$\n$$ k_{e}N_{ss} = k_{p}P_{ss} $$\nWe substitute the expression for $P_{ss}$ that we just found:\n$$ k_{e}N_{ss} = k_{p}\\left(\\frac{\\alpha}{k_{p}}\\right) = \\alpha $$\nSolving for $N_{ss}$ yields:\n$$ N_{ss} = \\frac{\\alpha}{k_{e}} $$\n\nFinally, we use the steady-state equation for $C(t)$ to find the desired quantity, $C_{ss}$:\n$$ 0 = k_{e}N_{ss} - \\delta C_{ss} $$\n$$ \\delta C_{ss} = k_{e}N_{ss} $$\nWe substitute the expression for $N_{ss}$:\n$$ \\delta C_{ss} = k_{e}\\left(\\frac{\\alpha}{k_{e}}\\right) = \\alpha $$\nSolving for $C_{ss}$ gives the steady-state abundance of cytoplasmic mature mRNA:\n$$ C_{ss} = \\frac{\\alpha}{\\delta} $$\n\nThis result indicates that at steady state, the total rate of production of mRNA ($\\alpha$) is exactly balanced by the total rate of degradation ($\\delta C_{ss}$). The intermediate processing and export steps, governed by rates $k_p$ and $k_e$, determine the steady-state levels of the precursor species but do not influence the final steady-state level of the cytoplasmic mRNA, provided that the pathway is linear and irreversible as specified.",
            "answer": "$$\\boxed{\\frac{\\alpha}{\\delta}}$$"
        },
        {
            "introduction": "Modern biology is driven by the interpretation of large-scale, multi-modal datasets. This exercise moves from theoretical modeling to a realistic data analysis scenario focused on the epitranscriptomic modification $N^6$-methyladenosine ($m^6A$), a pivotal regulator of mRNA fate. Faced with a rich dataset combining RNA-seq, ribosome profiling, MeRIP-seq, and half-life measurements, your task is to play the role of a computational biologist and deduce the specific function of $m^6A$ on different transcripts . This practice hones your ability to synthesize diverse data types, develop quantitative classification criteria, and distinguish between an RNA modification's effects on stability versus translation, a key challenge in contemporary gene regulation research.",
            "id": "4376227",
            "problem": "A research team perturbs $N^6$-methyladenosine ($m^6A$) installation by acutely inhibiting Methyltransferase-like 3 (METTL3) and profiles messenger RNA (mRNA) using methylated RNA immunoprecipitation sequencing (MeRIP-seq), RNA sequencing (RNA-seq), and ribosome profiling to estimate translation efficiency (TE). Changes are reported as $\\log_2$ fold changes for the METTL3-inhibited condition relative to control, and mRNA half-life $t_{1/2}$ is measured by metabolic labeling. You may assume that post-transcriptional control of steady-state mRNA abundance is dominated by degradation kinetics and that translation efficiency is estimated as the ratio of ribosome-protected fragments to mRNA abundance. Four transcripts (X, Y, Z, W) each harbor a single dominant $m^6A$ peak with the following features:\n- Transcript X: peak position $3'$ untranslated region, MeRIP-seq peak $\\log_2$ fold change $-2.0$; mRNA $\\log_2$ fold change $+0.8$; TE $\\log_2$ fold change $+0.05$; $t_{1/2}$ increases from $3\\,\\text{h}$ to $5.5\\,\\text{h}$.\n- Transcript Y: peak position $5'$ untranslated region, MeRIP-seq peak $\\log_2$ fold change $-1.2$; mRNA $\\log_2$ fold change $+0.1$; TE $\\log_2$ fold change $-0.7$; $t_{1/2}$ increases from $4.0\\,\\text{h}$ to $4.1\\,\\text{h}$.\n- Transcript Z: peak position coding sequence near the stop codon, MeRIP-seq peak $\\log_2$ fold change $-1.0$; mRNA $\\log_2$ fold change $+0.7$; TE $\\log_2$ fold change $-0.6$; $t_{1/2}$ increases from $2.5\\,\\text{h}$ to $3.5\\,\\text{h}$.\n- Transcript W: peak position $3'$ untranslated region, MeRIP-seq peak $\\log_2$ fold change $-0.4$; mRNA $\\log_2$ fold change $0.0$; TE $\\log_2$ fold change $0.0$; $t_{1/2}$ unchanged at $6.0\\,\\text{h}$.\n\nUsing first principles about mRNA turnover and translation, select the option that proposes defensible quantitative criteria for classifying an $m^6A$ site as acting primarily through mRNA stability versus translation, and that correctly applies those criteria to X, Y, Z, and W.\n\nA. Criteria: Restrict to transcripts with strong $m^6A$ loss (MeRIP-seq $\\log_2$ fold change $\\leq -0.8$). Classify “stability-mediated” if mRNA $\\log_2$ fold change $\\geq +0.5$, TE $\\log_2$ fold change within $[-0.2,+0.2]$, and $t_{1/2}$ increases by $\\geq 30\\%$. Classify “translation-mediated” if $|\\text{mRNA } \\log_2 \\text{ fold change}| \\leq 0.2$, TE $\\log_2$ fold change $\\leq -0.5$, and $t_{1/2}$ change within $\\pm 10\\%$. Classify “mixed” if both stability and translation thresholds are crossed (mRNA $\\log_2$ fold change $\\geq +0.5$ and TE $\\log_2$ fold change $\\leq -0.5$ or $t_{1/2}$ increases by $\\geq 30\\%$ alongside a TE decrease $\\leq -0.5$). If MeRIP-seq loss $>-0.8$ or none of the thresholds are crossed, classify as “no functional effect.” Application: X stability-mediated; Y translation-mediated; Z mixed; W no functional effect.\n\nB. Criteria: Restrict to transcripts with strong $m^6A$ loss (MeRIP-seq $\\log_2$ fold change $\\leq -0.8$). Classify “stability-mediated” if mRNA $\\log_2$ fold change $\\leq -0.5$ or $t_{1/2}$ decreases by $\\geq 30\\%$; classify “translation-mediated” if TE $\\log_2$ fold change $\\geq +0.5$ with $|\\text{mRNA } \\log_2 \\text{ fold change}| \\leq 0.2$; otherwise “no functional effect.” Application: X translation-mediated; Y translation-mediated; Z stability-mediated; W no functional effect.\n\nC. Criteria: Use peak position only. Classify any $3'$ untranslated region peak as “stability-mediated,” any $5'$ untranslated region peak as “translation-mediated,” and any coding sequence peak near the stop codon as “stability-mediated,” irrespective of fold changes in mRNA, TE, or $t_{1/2}$. Application: X stability-mediated; Y translation-mediated; Z stability-mediated; W stability-mediated.\n\nD. Criteria: Winner-take-all by effect magnitude without hard thresholds. Compute the absolute magnitudes of mRNA and TE $\\log_2$ fold changes; classify as “stability-mediated” if $|\\text{mRNA } \\log_2 \\text{ fold change}| > |\\text{TE } \\log_2 \\text{ fold change}|$, as “translation-mediated” if the reverse, and as “no functional effect” if both are $\\leq 0.1$. Ignore $t_{1/2}$ and MeRIP-seq magnitude. Application: X stability-mediated; Y translation-mediated; Z stability-mediated; W no functional effect.",
            "solution": "This problem requires the analysis and interpretation of multi-modal sequencing data to classify the function of an $m^6A$ site on four different transcripts. The problem is scientifically valid, well-posed, and requires the synthesis of quantitative data to make a reasoned biological conclusion.\n\n**First Principles of Data Interpretation:**\nThe experiment involves inhibiting METTL3, the primary $m^6A$ \"writer.\" Therefore, a loss of $m^6A$ marks is expected, which is confirmed by the negative MeRIP-seq $\\log_2$ fold changes. The functional consequence of this loss depends on the role of the $m^6A$ mark.\n- **Stability-mediated effect:** If $m^6A$ promotes mRNA decay (a common role for YTHDF2 readers), its loss will stabilize the mRNA. This should be observed as an *increase* in mRNA half-life ($t_{1/2}$) and a corresponding *increase* in steady-state mRNA abundance (positive mRNA $\\log_2$ fold change), with little to no change in translation efficiency (TE).\n- **Translation-mediated effect:** If $m^6A$ promotes translation (a role for YTHDF1 readers), its loss will decrease translation efficiency. This should be observed as a *decrease* in TE (negative TE $\\log_2$ fold change), with little to no change in mRNA abundance or half-life.\n- **Mixed effect:** If $m^6A$ affects both processes, changes will be seen in both stability (mRNA abundance/$t_{1/2}$) and translation (TE).\n- **No functional effect:** If the $m^6A$ site is non-functional or the loss of methylation is insufficient to cause a measurable change, none of the metrics will change significantly.\n\n**Analysis of Individual Transcripts:**\n1.  **Transcript X:** Strong $m^6A$ loss ($\\log_2 \\text{FC} = -2.0$). mRNA abundance significantly increases ($\\log_2 \\text{FC} = +0.8$), while TE is unchanged ($\\log_2 \\text{FC} = +0.05$). The half-life increases from $3.0$ to $5.5$ hours, an increase of $(5.5-3.0)/3.0 = 83.3\\%$. These data are a canonical signature of a stability-mediated effect where the $m^6A$ mark promotes decay.\n2.  **Transcript Y:** Strong $m^6A$ loss ($\\log_2 \\text{FC} = -1.2$). TE significantly decreases ($\\log_2 \\text{FC} = -0.7$), while mRNA abundance is unchanged ($\\log_2 \\text{FC} = +0.1$). The half-life is also nearly unchanged, increasing from $4.0$ to $4.1$ hours (a $2.5\\%$ increase). This is a clear signature of a translation-mediated effect where the $m^6A$ mark promotes translation.\n3.  **Transcript Z:** Strong $m^6A$ loss ($\\log_2 \\text{FC} = -1.0$). Both mRNA abundance and TE change significantly: mRNA increases ($\\log_2 \\text{FC} = +0.7$) and TE decreases ($\\log_2 \\text{FC} = -0.6$). The half-life increase from $2.5$ to $3.5$ hours ($40\\%$) confirms a strong stability effect. The concurrent, strong decrease in TE indicates a translation effect as well. This is a mixed-effect site.\n4.  **Transcript W:** Weak $m^6A$ loss ($\\log_2 \\text{FC} = -0.4$). No change in mRNA abundance, TE, or half-life. This site shows no functional effect in this experiment.\n\n**Evaluation of Options:**\n- **Option A:** Proposes sound, quantitative criteria that align with first principles.\n    - Application to X: `mRNA FC ≥ +0.5`, `TE FC` near zero, `$t_{1/2}$ increase ≥ 30%`. Correctly classifies as **stability-mediated**.\n    - Application to Y: `mRNA FC` near zero, `TE FC ≤ -0.5`, `$t_{1/2}$ change` minimal. Correctly classifies as **translation-mediated**.\n    - Application to Z: `mRNA FC ≥ +0.5` and `TE FC ≤ -0.5`. Correctly classifies as **mixed**.\n    - Application to W: `MeRIP FC > -0.8`. Fails the initial filter. Correctly classifies as **no functional effect**.\n    - The criteria and application in Option A are fully consistent with the data.\n\n- **Option B:** The criteria are flawed. It states that stability mediation results in an `mRNA $\\log_2$ fold change ≤ -0.5`, which is the opposite of what is expected when a decay-promoting mark is removed.\n\n- **Option C:** The criteria are overly simplistic. While there is a correlation between peak position and function, it is not absolute. Relying only on position and ignoring quantitative data is poor scientific practice.\n\n- **Option D:** The \"winner-take-all\" approach is a reasonable heuristic but less nuanced than A. It correctly classifies X and Y, but for Z, it would classify it as \"stability-mediated\" because $|\\text{mRNA FC}| (0.7) > |\\text{TE FC}| (0.6)$, missing the significant, concurrent effect on translation. It also ignores the valuable, direct measurement of half-life.\n\n**Conclusion:**\nOption A provides the most scientifically rigorous and defensible framework for classifying the function of the $m^6A$ sites, and its application of those criteria to the four transcripts is correct.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "A central challenge in systems biology is moving beyond correlation to establish causation. While high-throughput experiments reveal numerous molecular associations, confounding variables can obscure the true, direct regulatory effects of a factor like an RNA-binding protein (RBP). This practice introduces you to the principles of causal inference by applying a linear structural model to dissect a regulatory network . By implementing a program to perform multiple regression, you will learn how to statistically control for confounders and mediators to estimate the direct causal impact of an RBP on both mRNA stability and translation efficiency. This computational exercise equips you with a powerful approach for untangling complex cause-and-effect relationships from observational genomic data.",
            "id": "4376240",
            "problem": "You are given per-transcript measurements relevant to post-transcriptional regulation by a specific RNA-binding protein (RBP). The goal is to infer causal regulatory effects from observed features using a principled model that accounts for measured confounders. The scientific base includes the Central Dogma of Molecular Biology, the definition of messenger ribonucleic acid (mRNA) half-life as the expected time until degradation, and ribosome density as a proxy for translation efficiency, together with standard causal graphical modeling assumptions. Enhanced CrossLinking and ImmunoPrecipitation (eCLIP) occupancy is used as a proxy for the probability of RBP binding on a transcript. All changes are defined as differences relative to appropriate matched controls, so that residual baseline offsets are effectively zero and intercepts can be omitted.\n\nAssume there exist measured confounders that jointly affect eCLIP occupancy, mRNA half-life change, and ribosome density change. Let the variables be:\n- eCLIP occupancy $O$ (scaled in $[0,1]$, unitless),\n- mRNA half-life change $H$ ($\\log_2$ fold-change, unitless),\n- ribosome density change $R$ ($\\log_2$ fold-change, unitless),\n- a vector of measured confounders $C = (C_1, C_2)$ (unitless).\n\nYou are to assume the following linear structural equations with independent, zero-mean noise terms and no intercepts (because all variables are changes relative to control):\n- $H = \\beta_{OH}\\, O + \\beta_{CH}^{\\top} C + \\varepsilon_H$ with $\\mathbb{E}[\\varepsilon_H \\mid O, C] = 0$,\n- $R = \\gamma_{OR}\\, O + \\gamma_{HR}\\, H + \\gamma_{CR}^{\\top} C + \\varepsilon_R$ with $\\mathbb{E}[\\varepsilon_R \\mid O, H, C] = 0$.\n\nUnder the back-door criterion, when conditioning on measured confounders $C$, the causal effect of $O$ on $H$ is identified by the partial regression coefficient $\\beta_{OH}$. Under standard identifiability conditions for controlled direct effects, the direct causal effect of $O$ on $R$ not mediated by $H$ is identified by the partial regression coefficient $\\gamma_{OR}$ in a multiple regression of $R$ on $(O, H, C)$.\n\nYour task is to implement a program that, for each provided dataset, estimates:\n- the adjusted causal effect of eCLIP occupancy on half-life, $\\beta_{OH}$, via least squares regression of $H$ on $(O, C_1, C_2)$ without an intercept, and\n- the adjusted direct causal effect of eCLIP occupancy on ribosome density, $\\gamma_{OR}$, via least squares regression of $R$ on $(O, H, C_1, C_2)$ without an intercept.\n\nAll datasets are small, deterministic, and scientifically plausible. They are designed to satisfy linearity and to include slight noise terms to avoid exact collinearity, while keeping the results interpretable. Each dataset corresponds to transcripts indexed by $i = 1, \\dots, n$.\n\nTest suite. For each case below, use the exact arrays as given. All numbers are unitless.\n\nCase A (general, identifiable, mediated and direct effects present):\n- $O$: $[\\,0.2,\\,0.6,\\,1.0,\\,0.4,\\,0.8,\\,1.2\\,]$\n- $C_1$: $[\\,0,\\,1,\\,2,\\,0,\\,1,\\,2\\,]$\n- $C_2$: $[\\,1,\\,1,\\,1,\\,2,\\,2,\\,2\\,]$\n- $H$: $[\\,0.01,\\,0.39,\\,0.82,\\,-0.02,\\,0.40,\\,0.81\\,]$\n- $R$: $[\\,0.087,\\,0.613,\\,1.174,\\,0.146,\\,0.70,\\,1.247\\,]$\n\nCase B (no direct effect on $R$, only mediated through $H$):\n- $O$: $[\\,0.2,\\,0.6,\\,1.0,\\,0.4,\\,0.8,\\,1.2\\,]$\n- $C_1$: $[\\,0,\\,1,\\,2,\\,0,\\,1,\\,2\\,]$\n- $C_2$: $[\\,1,\\,1,\\,1,\\,2,\\,2,\\,2\\,]$\n- $H$: $[\\,0.175,\\,0.505,\\,0.860,\\,0.330,\\,0.680,\\,1.025\\,]$\n- $R$: $[\\,0.090,\\,0.454,\\,0.838,\\,0.164,\\,0.544,\\,0.920\\,]$\n\nCase C (negative direct effect on $R$, weak effect on $H$):\n- $O$: $[\\,0.1,\\,0.3,\\,0.5,\\,0.7,\\,0.9\\,]$\n- $C_1$: $[\\,0,\\,1,\\,0,\\,1,\\,2\\,]$\n- $C_2$: $[\\,1,\\,0,\\,2,\\,1,\\,0\\,]$\n- $H$: $[\\, -0.19,\\,0.34,\\,-0.36,\\,0.17,\\,0.695\\,]$\n- $R$: $[\\,0.05,\\,0.05,\\,-0.05,\\,-0.05,\\,-0.05\\,]$\n\nAlgorithmic requirements:\n- For each case, construct the design matrices for the two regressions as specified, omitting the intercept column.\n- Use ordinary least squares to estimate coefficients. If the design matrix is not full rank, use the minimum-norm least squares solution returned by a numerically stable solver.\n- Extract $\\beta_{OH}$ as the coefficient multiplying $O$ in the model for $H$.\n- Extract $\\gamma_{OR}$ as the coefficient multiplying $O$ in the model for $R$.\n\nAngle units do not apply. There are no physical units; all quantities are dimensionless. Percentages must not be used; use decimals as given.\n\nOutput specification:\n- For each case, return a list with two floats $[\\,\\widehat{\\beta}_{OH},\\,\\widehat{\\gamma}_{OR}\\,]$, each rounded to three decimal places.\n- Aggregate the three case results into a single line printed by the program as a list of lists, with no extra text. The exact format must be:\n\"[[bA,gA],[bB,gB],[bC,gC]]\" but without spaces except those necessary to separate numbers by commas and brackets, and each number shown with exactly three decimal digits, for example: \"[[0.500,0.400],[0.600,0.000],[1.000,-0.500]]\".\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets as described above.",
            "solution": "The user has provided a problem in the domain of systems biomedicine, focusing on post-transcriptional gene regulation. The task is to estimate causal parameters from observational data using a specified linear structural model.\n\nThe problem has been validated and is determined to be sound. It is scientifically grounded in molecular biology and employs standard statistical methods for causal inference, specifically, regression analysis for adjusting for confounders. The problem is well-posed, objective, and provides all necessary data and specifications for a unique solution.\n\nThe core of the problem is to estimate two parameters, $\\beta_{OH}$ and $\\gamma_{OR}$, from a set of linear structural equations:\n1. $H = \\beta_{OH}\\, O + \\beta_{CH}^{\\top} C + \\varepsilon_H$\n2. $R = \\gamma_{OR}\\, O + \\gamma_{HR}\\, H + \\gamma_{CR}^{\\top} C + \\varepsilon_R$\n\nwhere $O$ represents eCLIP occupancy, $H$ is mRNA half-life change, $R$ is ribosome density change, and $C=(C_1, C_2)$ is a vector of measured confounders. The models are to be fitted without an intercept, as all variables are defined as changes relative to a control.\n\nThe estimation method prescribed is Ordinary Least Squares (OLS). For a general linear model of the form $y = X\\beta + \\varepsilon$, the OLS estimator $\\hat{\\beta}$ for the parameter vector $\\beta$ is the vector that minimizes the sum of squared residuals, $\\|y - X\\hat{\\beta}\\|_2^2$. This is found by solving the normal equations $X^\\top X \\hat{\\beta} = X^\\top y$. A numerically stable way to solve this, which also handles cases where the design matrix $X$ is not of full column rank, is to use a solver based on Singular Value Decomposition (SVD), such as the `numpy.linalg.lstsq` function. This function returns the minimum-norm solution in rank-deficient cases, as required.\n\nWe must perform two separate regressions for each provided dataset.\n\nFirst, to estimate $\\beta_{OH}$, we consider the model for $H$:\n$$ H = \\beta_{OH} O + \\beta_{C_1H} C_1 + \\beta_{C_2H} C_2 + \\varepsilon_H $$\nThis corresponds to a linear regression problem where the response vector, $y_H$, is the set of observations for $H$. The design matrix, $X_H$, is constructed by arranging the observation vectors for $O$, $C_1$, and $C_2$ as its columns.\n$$ y_H = \\begin{pmatrix} H_1 \\\\ \\vdots \\\\ H_n \\end{pmatrix}, \\quad X_H = \\begin{pmatrix} O_1 & C_{1,1} & C_{2,1} \\\\ \\vdots & \\vdots & \\vdots \\\\ O_n & C_{1,n} & C_{2,n} \\end{pmatrix} $$\nThe vector of coefficients to be estimated is $\\beta_H = [\\beta_{OH}, \\beta_{C_1H}, \\beta_{C_2H}]^{\\top}$. By solving the linear system $X_H \\beta_H = y_H$ using least squares, we obtain the estimate $\\hat{\\beta}_H$. The desired parameter estimate, $\\widehat{\\beta}_{OH}$, is the first element of the vector $\\hat{\\beta}_H$.\n\nSecond, to estimate $\\gamma_{OR}$, we use the model for $R$:\n$$ R = \\gamma_{OR} O + \\gamma_{HR} H + \\gamma_{C_1R} C_1 + \\gamma_{C_2R} C_2 + \\varepsilon_R $$\nHere, the response vector, $y_R$, is the set of observations for $R$. The design matrix, $X_R$, is constructed from the observation vectors for $O$, $H$, $C_1$, and $C_2$. It is crucial to note that the *measured* values of $H$ are used as a predictor in this regression, consistent with the identification strategy for controlled direct effects.\n$$ y_R = \\begin{pmatrix} R_1 \\\\ \\vdots \\\\ R_n \\end{pmatrix}, \\quad X_R = \\begin{pmatrix} O_1 & H_1 & C_{1,1} & C_{2,1} \\\\ \\vdots & \\vdots & \\vdots & \\vdots \\\\ O_n & H_n & C_{1,n} & C_{2,n} \\end{pmatrix} $$\nThe coefficient vector is $\\gamma_R = [\\gamma_{OR}, \\gamma_{HR}, \\gamma_{C_1R}, \\gamma_{C_2R}]^{\\top}$. Solving the system $X_R \\gamma_R = y_R$ via least squares yields the estimate $\\hat{\\gamma}_R$. The direct causal effect estimate, $\\widehat{\\gamma}_{OR}$, is the first element of $\\hat{\\gamma}_R$.\n\nThis procedure is applied to each of the three provided cases (A, B, and C). The resulting estimates for $\\beta_{OH}$ and $\\gamma_{OR}$ are collected and rounded to three decimal places. The final implementation will automate this process for all test cases and format the output as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Estimates causal effects from transcriptional data using OLS regression.\n\n    For each test case, the function performs two linear regressions without intercept:\n    1. Regresses H on (O, C1, C2) to find beta_OH.\n    2. Regresses R on (O, H, C1, C2) to find gamma_OR.\n\n    The results are formatted and printed as specified in the problem statement.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'name': 'A',\n            'O': np.array([0.2, 0.6, 1.0, 0.4, 0.8, 1.2]),\n            'C1': np.array([0, 1, 2, 0, 1, 2]),\n            'C2': np.array([1, 1, 1, 2, 2, 2]),\n            'H': np.array([0.01, 0.39, 0.82, -0.02, 0.40, 0.81]),\n            'R': np.array([0.087, 0.613, 1.174, 0.146, 0.70, 1.247]),\n        },\n        {\n            'name': 'B',\n            'O': np.array([0.2, 0.6, 1.0, 0.4, 0.8, 1.2]),\n            'C1': np.array([0, 1, 2, 0, 1, 2]),\n            'C2': np.array([1, 1, 1, 2, 2, 2]),\n            'H': np.array([0.175, 0.505, 0.860, 0.330, 0.680, 1.025]),\n            'R': np.array([0.090, 0.454, 0.838, 0.164, 0.544, 0.920]),\n        },\n        {\n            'name': 'C',\n            'O': np.array([0.1, 0.3, 0.5, 0.7, 0.9]),\n            'C1': np.array([0, 1, 0, 1, 2]),\n            'C2': np.array([1, 0, 2, 1, 0]),\n            'H': np.array([-0.19, 0.34, -0.36, 0.17, 0.695]),\n            'R': np.array([0.05, 0.05, -0.05, -0.05, -0.05]),\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Extract data for the current case\n        O, C1, C2, H, R = case['O'], case['C1'], case['C2'], case['H'], case['R']\n\n        # --- Regression 1: Estimate beta_OH ---\n        # Model: H = beta_OH*O + beta_C1H*C1 + beta_C2H*C2\n        # Design matrix X_H, response vector y_H = H\n        X_H = np.vstack([O, C1, C2]).T \n        \n        # Solve for coefficients using least squares.\n        # np.linalg.lstsq returns a tuple, the first element is the solution vector.\n        coeffs_H = np.linalg.lstsq(X_H, H, rcond=None)[0]\n        beta_OH = coeffs_H[0]\n\n        # --- Regression 2: Estimate gamma_OR ---\n        # Model: R = gamma_OR*O + gamma_HR*H + gamma_C1R*C1 + gamma_C2R*C2\n        # Design matrix X_R, response vector y_R = R\n        X_R = np.vstack([O, H, C1, C2]).T\n\n        # Solve for coefficients using least squares.\n        coeffs_R = np.linalg.lstsq(X_R, R, rcond=None)[0]\n        gamma_OR = coeffs_R[0]\n        \n        all_results.append((beta_OH, gamma_OR))\n\n    # Format the final output string exactly as required.\n    # Each number is formatted to three decimal places.\n    # The final string is a list of lists, e.g., [[bA,gA],[bB,gB],...].\n    results_str_list = [f\"[{res[0]:.3f},{res[1]:.3f}]\" for res in all_results]\n    final_output = f\"[{','.join(results_str_list)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}