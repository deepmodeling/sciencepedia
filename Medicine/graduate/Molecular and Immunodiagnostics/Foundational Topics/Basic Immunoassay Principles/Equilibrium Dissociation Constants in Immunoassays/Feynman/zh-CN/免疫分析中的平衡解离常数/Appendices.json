{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个实践是基本概念的基石。我们将从一个直接的场景入手，根据平衡状态下的浓度数据直接计算平衡解离常数（$K_d$）。这项练习不仅巩固了 $K_d$ 的定义，还揭示了它在决定免疫分析灵敏度和动态范围方面的关键作用。",
            "id": "5113381",
            "problem": "在一个均相结合免疫分析中，抗体物质 $A$ 与抗原 $B$ 结合形成一个 $1{:}1$ 的复合物 $AB$。在平衡状态下，测得的游离浓度为 $[A] = 10$ nM，$[B] = 90$ nM，复合物浓度为 $[AB] = 40$ nM。假设每个 $A$ 有一个单一的非协同结合位点，非特异性结合可忽略不计，且溶液为理想溶液。从可逆反应 $A + B \\rightleftharpoons AB$、平衡解离常数的定义以及基元反应的质量作用定律出发，推导平衡解离常数 $K_{d}$ 关于 $[A]$、$[B]$ 和 $[AB]$ 的表达式，然后使用给定数据以纳摩尔为单位计算 $K_{d}$ 的数值。最后，基于推导出的 $1{:}1$ 结合等温线的占有率关系，解释在分析灵敏度的背景下，该亲和力是低、中等还是高，并说明该分析的动态范围预计将集中在哪里。以 nM 为单位表示 $K_{d}$ 的最终数值。没有四舍五入要求；报告精确的计算值。",
            "solution": "该问题要求推导平衡解离常数 $K_d$ 的表达式，进行数值计算，并在免疫分析性能的背景下解释结果。\n\n该过程从化学平衡的基本原理应用于给定的双分子反应开始。抗体 $A$ 和抗原 $B$ 之间形成复合物 $AB$ 的可逆反应如下：\n$$\nA + B \\rightleftharpoons AB\n$$\n该反应的特点是正向（结合）过程和逆向（解离）过程。根据基元反应的质量作用定律，正向反应速率 $R_{fwd}$ 与反应物浓度的乘积成正比，逆向反应速率 $R_{rev}$ 与产物浓度成正比。\n\n设 $k_{on}$ 为结合速率常数（例如，单位为 M$^{-1}$s$^{-1}$），$k_{off}$ 为解离速率常数（单位为 s$^{-1}$）。速率表示为：\n$$\nR_{fwd} = k_{on}[A][B]\n$$\n$$\nR_{rev} = k_{off}[AB]\n$$\n在化学平衡时，净反应速率为零，这意味着正向反应速率等于逆向反应速率：\n$$\nR_{fwd} = R_{rev}\n$$\n代入速率表达式得到平衡条件：\n$$\nk_{on}[A][B] = k_{off}[AB]\n$$\n平衡解离常数 $K_d$ 定义为解离速率常数与结合速率常数之比：\n$$\nK_d \\equiv \\frac{k_{off}}{k_{on}}\n$$\n通过重新整理平衡条件方程，我们可以用所涉及物质的平衡浓度来表示这个比率：\n$$\n\\frac{[A][B]}{[AB]} = \\frac{k_{off}}{k_{on}}\n$$\n因此，平衡解离常数 $K_d$ 的表达式为：\n$$\nK_d = \\frac{[A][B]}{[AB]}\n$$\n这就完成了问题的第一部分。\n\n接下来，我们使用提供的平衡浓度计算 $K_d$ 的数值。给定的数据是：\n- 游离抗体浓度，$[A] = 10 \\text{ nM}$\n- 游离抗原浓度，$[B] = 90 \\text{ nM}$\n- 复合物浓度，$[AB] = 40 \\text{ nM}$\n\n将这些值代入推导出的 $K_d$ 表达式中：\n$$\nK_d = \\frac{(10 \\text{ nM})(90 \\text{ nM})}{40 \\text{ nM}}\n$$\n进行计算：\n$$\nK_d = \\frac{900 \\text{ (nM)}^2}{40 \\text{ nM}} = \\frac{90}{4} \\text{ nM} = 22.5 \\text{ nM}\n$$\n平衡解离常数的数值为 $22.5$ nM。\n\n最后，我们解释这个结果。解离常数 $K_d$ 是衡量抗体与抗原之间亲和力的指标。较小的 $K_d$ 值表示较高的亲和力（更强的结合），而较大的 $K_d$ 值表示较低的亲和力（较弱的结合）。在免疫分析的背景下：\n- 高亲和力通常以 $K_d  1 \\text{ nM}$ 为特征。\n- 中等亲和力在 $K_d \\approx 1-100 \\text{ nM}$ 的范围内。\n- 低亲和力对应于 $K_d > 100 \\text{ nM}$。\n\n计算出的 $K_d = 22.5 \\text{ nM}$ 值属于**中等亲和力**范围。这种亲和力水平在许多诊断性免疫分析中很常见且有用。\n\n免疫分析的动态范围是指分析物在该浓度范围内能提供有用且分级响应的区间。这种响应与被抗原占据的抗体结合位点的分数有关。对于单个非协同结合位点，分数占有率 $\\theta$ 由 Langmuir 结合等温线描述：\n$$\n\\theta = \\frac{[\\text{Bound Antibody}]}{[\\text{Total Antibody}]} = \\frac{[AB]}{[A] + [AB]}\n$$\n使用关系式 $[A] = K_d \\frac{[AB]}{[B]}$，这可以重写为游离抗原浓度 $[B]$ 的函数：\n$$\n\\theta = \\frac{[B]}{K_d + [B]}\n$$\n当绘制 $\\theta$ 与 $\\log([B])$ 的关系图时，该方程描述了一个 S 形关系。该曲线最敏感的部分，即斜率最陡峭处，发生在拐点。拐点对应于总抗体结合位点有一半被占据（$\\theta = 0.5$）时的游离抗原浓度。设 $\\theta = 0.5$：\n$$\n0.5 = \\frac{[B]}{K_d + [B]} \\implies 0.5(K_d + [B]) = [B] \\implies 0.5 K_d = 0.5 [B] \\implies [B] = K_d\n$$\n这表明，分析动态范围的中心，即其对分析物浓度变化最敏感的地方，位于分析物浓度等于 $K_d$ 值处。因此，对于这个特定的分析，动态范围预计将集中在抗原浓度约为 $22.5 \\text{ nM}$ 处。在这个浓度下，该分析对于检测抗原 $B$ 量的变化具有最高的灵敏度。",
            "answer": "$$\\boxed{22.5}$$"
        },
        {
            "introduction": "在掌握了 $K_d$ 的基本概念之后，这项实践将带我们进入一个更复杂而现实的挑战：分析方法的特异性。我们将模拟一个交叉反应干扰物与目标分析物竞争结合的情景，这是临床样本中常见的问题。这项练习将指导你量化干扰造成的影响，并确定为保证测量结果的可靠性，抗体需要达到的特异性标准。",
            "id": "5113414",
            "problem": "一种夹心免疫分析法，例如酶联免疫吸附测定（ELISA），使用一种单克隆捕获抗体，该抗体能结合目标分析物 $T$ 和一种潜在的交叉反应干扰物 $X$。在单价结合的平衡状态下，捕获位点在游离态以及与 $T$ 或 $X$ 形成的复合物之间的分布遵循质量作用定律和平衡解离常数 $K_{D}$ 的定义，其中对于竞争相同位点的每种配体 $L$，都有 $K_{D} = [A][L]/[AL]$。假设检测步骤产生的信号与被 $T$ 占据的位点分数成正比，并加上被 $X$ 占据的位点分数的相对贡献，该贡献由一个交叉反应信号效率因子 $\\beta$ 进行缩放，其中 $0 \\le \\beta \\le 1$。\n\n给定以下平衡状态下的分析和基质参数：\n- 目标物浓度 $[T] = 1.0 \\,\\mathrm{nM}$。\n- 生理性干扰物浓度 $[X] = 1.0 \\,\\mathrm{\\mu M}$。\n- 目标物亲和力（捕获抗体对 $T$）：$K_{D,T} = 100 \\,\\mathrm{pM}$。\n- 干扰物亲和力，表示为比率 $r \\equiv K_{D,X}/K_{D,T}$。当前达到的比率是 $r_{\\mathrm{current}} = 1.0 \\times 10^{4}$。\n- 结合态 $X$ 的相对信号效率（与 $T$ 相比）：$\\beta = 0.050$。\n\n定义平衡状态下测得的信号与被 $T$ 占据的捕获位点分数加上 $\\beta$ 乘以被 $X$ 占据的分数之和成正比。令 $S$ 表示同时存在 $T$ 和 $X$ 时的信号，$S_{0}$ 表示在没有 $X$ 时（其他条件均相同）的信号。定义测得的目标信号中的干扰为相对变化 $I \\equiv (S - S_{0})/S_{0}$，以小数形式表示（无单位）。\n\n任务：\n1. 仅从 $K_{D}$ 的定义和单一类型位点竞争性结合的质量作用平衡出发，推导出一个用 $[T]$, $[X]$, $K_{D,T}$, $K_{D,X}$ 和 $\\beta$ 表示的 $I$ 的表达式。然后使用 $r_{\\mathrm{current}}$ 对上述参数下的 $I$ 进行数值计算。\n2. 设交叉反应性的接受标准为干扰的绝对值满足 $|I| \\le I_{\\mathrm{acc}}$，其中 $I_{\\mathrm{acc}} = 0.050$。推导出保证在给定 $[T]$, $[X]$, $K_{D,T}$ 和 $\\beta$ 条件下满足此标准的 $r$ 的解析不等式，然后计算满足该边界的最小 $r$ 值。\n\n将阈值比率四舍五入到三位有效数字。将最终答案表示为对应于最小可接受比率 $r_{\\min}$ 的单个数字（无单位）。仅报告 $r_{\\min}$ 作为您的最终答案。",
            "solution": "用户提供的问题经评估是有效的。它在科学上基于化学平衡和质量作用定律的原理，特别是这些原理在免疫分析中竞争性结合的应用。该问题表述清晰、客观，并包含推导唯一且有意义的解所需的所有数据和定义。没有内部矛盾、不切实际的参数或其他缺陷。因此，我们可以着手求解。\n\n令 $[A]$ 表示平衡时游离抗体捕获位点的浓度。令 $[AT]$ 和 $[AX]$ 分别表示与目标分析物 $T$ 和干扰物 $X$ 结合的位点的浓度。捕获位点的总浓度是恒定的：$[A]_{\\text{total}} = [A] + [AT] + [AX]$。\n\n目标物 $K_{D,T}$ 和干扰物 $K_{D,X}$ 的平衡解离常数由质量作用定律定义：\n$$K_{D,T} = \\frac{[A][T]}{[AT]}$$\n$$K_{D,X} = \\frac{[A][X]}{[AX]}$$\n根据这些定义，我们可以用游离抗体浓度来表示结合复合物的浓度：\n$$[AT] = \\frac{[A][T]}{K_{D,T}}$$\n$$[AX] = \\frac{[A][X]}{K_{D,X}}$$\n目标物 $\\theta_T$ 和干扰物 $\\theta_X$ 对位点的占据分数分别为：\n$$\\theta_T = \\frac{[AT]}{[A]_{\\text{total}}} = \\frac{[AT]}{[A] + [AT] + [AX]}$$\n$$\\theta_X = \\frac{[AX]}{[A]_{\\text{total}}} = \\frac{[AX]}{[A] + [AT] + [AX]}$$\n代入 $[AT]$ 和 $[AX]$ 的表达式并消去公因子 $[A]$：\n$$\\theta_T = \\frac{\\frac{[T]}{K_{D,T}}}{1 + \\frac{[T]}{K_{D,T}} + \\frac{[X]}{K_{D,X}}}$$\n$$\\theta_X = \\frac{\\frac{[X]}{K_{D,X}}}{1 + \\frac{[T]}{K_{D,T}} + \\frac{[X]}{K_{D,X}}}$$\n测得的信号 $S$ 与被 $T$ 占据的位点分数加上 $\\beta$ 乘以被 $X$ 占据的分数之和成正比。令 $k$ 为比例常数。\n$$S = k (\\theta_T + \\beta \\theta_X) = k \\left( \\frac{\\frac{[T]}{K_{D,T}} + \\beta \\frac{[X]}{K_{D,X}}}{1 + \\frac{[T]}{K_{D,T}} + \\frac{[X]}{K_{D,X}}} \\right)$$\n在没有干扰物的情况下，信号 $S_0$ 可通过设置 $[X]=0$ 得到：\n$$S_0 = k \\left( \\frac{\\frac{[T]}{K_{D,T}}}{1 + \\frac{[T]}{K_{D,T}}} \\right)$$\n干扰 $I$ 定义为 $I = (S - S_0)/S_0 = S/S_0 - 1$。\n$$\\frac{S}{S_0} = \\frac{\\frac{\\frac{[T]}{K_{D,T}} + \\beta \\frac{[X]}{K_{D,X}}}{1 + \\frac{[T]}{K_{D,T}} + \\frac{[X]}{K_{D,X}}}}{\\frac{\\frac{[T]}{K_{D,T}}}{1 + \\frac{[T]}{K_{D,T}}}}$$\n为简化起见，令 $u = [T]/K_{D,T}$ 和 $v = [X]/K_{D,X}$。\n$$I = \\frac{\\frac{u + \\beta v}{1+u+v}}{\\frac{u}{1+u}} - 1 = \\frac{(u+\\beta v)(1+u)}{u(1+u+v)} - 1$$\n$$I = \\frac{u + u^2 + \\beta v + \\beta uv - u(1+u+v)}{u(1+u+v)} = \\frac{u + u^2 + \\beta v + \\beta uv - u - u^2 - uv}{u(1+u+v)}$$\n$$I = \\frac{\\beta v + \\beta uv - uv}{u(1+u+v)} = \\frac{v(\\beta + u(\\beta-1))}{u(1+u+v)}$$\n将原始变量代回，我们得到 $I$ 的通用表达式：\n$$I = \\frac{\\frac{[X]}{K_{D,X}} \\left( \\beta + \\frac{[T]}{K_{D,T}}(\\beta - 1) \\right)}{\\frac{[T]}{K_{D,T}} \\left(1 + \\frac{[T]}{K_{D,T}} + \\frac{[X]}{K_{D,X}}\\right)}$$\n\n**任务1：$I$ 的数值计算**\n给定：\n$[T] = 1.0 \\times 10^{-9} \\, \\mathrm{M}$\n$[X] = 1.0 \\times 10^{-6} \\, \\mathrm{M}$\n$K_{D,T} = 100 \\, \\mathrm{pM} = 1.0 \\times 10^{-10} \\, \\mathrm{M}$\n$r_{\\mathrm{current}} = K_{D,X}/K_{D,T} = 1.0 \\times 10^4$\n$\\beta = 0.050$\n\n首先，计算无量纲项 $u$ 和 $v$：\n$$u = \\frac{[T]}{K_{D,T}} = \\frac{1.0 \\times 10^{-9} \\, \\mathrm{M}}{1.0 \\times 10^{-10} \\, \\mathrm{M}} = 10$$\n$K_{D,X} = r_{\\mathrm{current}} \\times K_{D,T} = (1.0 \\times 10^4) \\times (1.0 \\times 10^{-10} \\, \\mathrm{M}) = 1.0 \\times 10^{-6} \\, \\mathrm{M}$\n$$v = \\frac{[X]}{K_{D,X}} = \\frac{1.0 \\times 10^{-6} \\, \\mathrm{M}}{1.0 \\times 10^{-6} \\, \\mathrm{M}} = 1$$\n现在，将这些值代入 $I$ 的表达式中：\n$$I = \\frac{1 \\times (0.050 + 10(0.050-1))}{10 \\times (1 + 10 + 1)} = \\frac{0.050 + 10(-0.950)}{10 \\times 12} = \\frac{0.050 - 9.50}{120} = \\frac{-9.45}{120} = -0.07875$$\n\n**任务2：最小可接受比率 $r_{\\min}$ 的推导**\n接受标准为 $|I| \\le I_{\\mathrm{acc}}$，其中 $I_{\\mathrm{acc}} = 0.050$。\n如任务1中所计算，项 $\\beta + u(\\beta-1) = -9.45$ 为负。由于 $I$ 表达式中的所有其他项均为正，因此在给定的参数空间内 $I$ 为负。因此，标准 $|I| \\le I_{\\mathrm{acc}}$ 变为 $-I \\le I_{\\mathrm{acc}}$，或 $I \\ge -I_{\\mathrm{acc}}$。\n\n令 $r = K_{D,X}/K_{D,T}$ 为可变比率。那么 $K_{D,X} = r K_{D,T}$。项 $v$ 变为：\n$$v = \\frac{[X]}{K_{D,X}} = \\frac{[X]}{r K_{D,T}} = \\frac{1}{r} \\frac{[X]}{K_{D,T}}$$\n我们定义 $v_0 = [X]/K_{D,T} = (1.0 \\times 10^{-6})/(1.0 \\times 10^{-10}) = 10^4$。因此，$v = v_0/r$。\n不等式为：\n$$\\frac{\\frac{v_0}{r}(\\beta + u(\\beta-1))}{u(1+u+\\frac{v_0}{r})} \\ge -I_{\\mathrm{acc}}$$\n项 $\\beta + u(\\beta-1)$ 是负的。我们将其写为 $-(u(1-\\beta)-\\beta)$。\n$$\\frac{\\frac{v_0}{r}(-(u(1-\\beta)-\\beta))}{u(1+u+\\frac{v_0}{r})} \\ge -I_{\\mathrm{acc}}$$\n两边乘以 $-1$ 会反转不等号：\n$$\\frac{\\frac{v_0}{r}(u(1-\\beta)-\\beta)}{u(1+u+\\frac{v_0}{r})} \\le I_{\\mathrm{acc}}$$\n为了消除分母中的分数，分子和分母同乘以 $r$：\n$$\\frac{v_0(u(1-\\beta)-\\beta)}{u(r(1+u)+v_0)} \\le I_{\\mathrm{acc}}$$\n由于所有项都是正的，我们可以乘以分母：\n$$v_0(u(1-\\beta)-\\beta) \\le I_{\\mathrm{acc}} u (r(1+u)+v_0)$$\n$$v_0(u(1-\\beta)-\\beta) \\le I_{\\mathrm{acc}} u r(1+u) + I_{\\mathrm{acc}} u v_0$$\n我们希望找到最小的 $r$，因此我们求解 $r$：\n$$v_0(u(1-\\beta)-\\beta) - I_{\\mathrm{acc}} u v_0 \\le I_{\\mathrm{acc}} u r(1+u)$$\n$$v_0(u(1-\\beta-I_{\\mathrm{acc}})-\\beta) \\le I_{\\mathrm{acc}} u (1+u) r$$\n$$r \\ge \\frac{v_0(u(1-\\beta-I_{\\mathrm{acc}})-\\beta)}{I_{\\mathrm{acc}}u(1+u)}$$\n这个不等式定义了最小可接受比率 $r_{\\min}$：\n$$r_{\\min} = \\frac{v_0(u(1-\\beta-I_{\\mathrm{acc}})-\\beta)}{I_{\\mathrm{acc}}u(1+u)}$$\n现在，代入数值：\n$u = 10$\n$v_0 = 10^4$\n$\\beta = 0.050$\n$I_{\\mathrm{acc}} = 0.050$\n$$r_{\\min} = \\frac{10^4 \\times (10(1-0.050-0.050)-0.050)}{0.050 \\times 10 \\times (1+10)}$$\n$$r_{\\min} = \\frac{10^4 \\times (10(0.90)-0.050)}{0.5 \\times 11} = \\frac{10^4 \\times (9-0.050)}{5.5} = \\frac{10^4 \\times 8.95}{5.5}$$\n$$r_{\\min} = \\frac{89500}{5.5} \\approx 16272.727...$$\n四舍五入到三位有效数字，最小可接受比率为 $1.63 \\times 10^4$。\n这意味着干扰物的平衡解离常数 $K_{D,X}$ 必须至少是目标物 $K_{D,T}$ 的 $16300$ 倍，才能满足干扰规范。",
            "answer": "$$\\boxed{1.63 \\times 10^4}$$"
        },
        {
            "introduction": "最后的实践将我们从理想化的平衡模型带入基于表面的免疫分析的动态现实中。通过计算机模拟，你将研究诸如传质等物理过程如何阻碍系统在典型的测量时间内达到真正的平衡。这项练习旨在展示动力学限制如何导致系统误差，并使实验测得的“表观”$K_d$ 值偏离其真实的热力学值。",
            "id": "5113363",
            "problem": "你的任务是模拟微孔板孔中的一种伪平衡免疫分析，其中配体到表面的供应受到传输的限制。你将对一个双室系统（主体层和近表面层）进行建模，该系统在两室之间存在质量传递，并在表面发生可逆结合。你的目标是计算当过早假设达到平衡时，平衡解离常数的系统误差。这必须完全在一个程序内完成。\n\n使用的基本原理：\n- 单一位点可逆结合反应的质量作用动力学：主体浓度为 $C_b(t)$ 的配体与近表面浓度为 $C_s(t)$ 进行交换，并与总表面位点密度为 $R_{\\text{tot}}$ 的表面受体结合，形成结合密度 $B(t)$。结合（on-rate）常数为 $k_{\\text{on}}$，解离（off-rate）常数为 $k_{\\text{off}}$。\n- 真实的平衡解离常数定义为 $K_d = \\dfrac{k_{\\text{off}}}{k_{\\text{on}}}$。\n- 质量传递由跨越厚度为 $d$ 的边界层的通量 $J(t) = k_m A \\left(C_b(t) - C_s(t)\\right)$ 表示，其中 $k_m$ 是质量传递系数，$A$ 是表面积，$V_b$ 是主体体积。\n\n基于质量守恒和一级过程需要实现的模型方程：\n- 每单位面积的表面结合动力学由常微分方程（Ordinary Differential Equation (ODE)）给出：$$\\dfrac{dB}{dt} = k_{\\text{on}}\\,C_s(t)\\,\\big(R_{\\text{tot}} - B(t)\\big) - k_{\\text{off}}\\,B(t).$$\n- 近表面层浓度动力学由以下方程给出：$$\\dfrac{dC_s}{dt} = \\dfrac{k_m}{d}\\,\\big(C_b(t) - C_s(t)\\big) - \\dfrac{1}{d}\\,\\dfrac{dB}{dt}.$$\n- 主体浓度动力学由以下方程给出：$$\\dfrac{dC_b}{dt} = -\\dfrac{A}{V_b}\\,k_m\\,\\big(C_b(t) - C_s(t)\\big).$$\n\n$t=0$ 时的初始条件：\n- $B(0)=0$,\n- $C_s(0)=C_b(0)=C_{b,0}$.\n\n所需计算：\n- 对于给定的测量时间 $t_{\\text{meas}}$，对耦合的常微分方程组进行数值积分，以获得 $B(t_{\\text{meas}})$ 和 $C_b(t_{\\text{meas}})$。\n- 在错误的假设下，即系统在 $t_{\\text{meas}}$ 时已达到平衡，且测量时的表面浓度等于主体浓度，通过反转测量快照处的单位点 Langmuir 关系，来推断表观平衡解离常数 $K_d^{\\text{app}}$。在该反转计算中使用测得的 $B(t_{\\text{meas}})$、$R_{\\text{tot}}$ 和 $C_b(t_{\\text{meas}})$。\n- 计算系统相对误差，结果为无量纲小数：$$\\varepsilon = \\dfrac{K_d^{\\text{app}} - K_d}{K_d}.$$\n\n物理单位：\n- $k_{\\text{on}}$ 的单位为 $\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$，\n- $k_{\\text{off}}$ 的单位为 $\\mathrm{s^{-1}}$，\n- $C_b$, $C_s$ 的单位为 $\\mathrm{mol\\,m^{-3}}$，\n- $A$ 的单位为 $\\mathrm{m^2}$，\n- $V_b$ 的单位为 $\\mathrm{m^3}$，\n- $d$ 的单位为 $\\mathrm{m}$，\n- $k_m$ 的单位为 $\\mathrm{m\\,s^{-1}}$，\n- $R_{\\text{tot}}$ 的单位为 $\\mathrm{mol\\,m^{-2}}$，\n- $B$ 的单位为 $\\mathrm{mol\\,m^{-2}}$，\n- $t_{\\text{meas}}$ 的单位为 $\\mathrm{s}$。\n将最终的系统误差 $\\varepsilon$ 表示为无量纲小数。\n\n数值方法要求：\n- 为该 ODE 系统实现一个固定步长的显式四阶 Runge–Kutta 积分器，所选步长需足够小，以能处理 $k_{\\text{on}}\\,C_{b,0} + k_{\\text{off}}$、$k_m/d$ 和 $(A/V_b)\\,k_m$ 中的最快速率。\n- 在每一步强制执行非负约束以及物理边界 $0 \\le B(t) \\le R_{\\text{tot}}$。\n\n测试套件（五个案例）：\n- 案例1（正常路径）：$k_{\\text{on}} = 10^{2}\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$, $k_{\\text{off}} = 10^{-3}\\ \\mathrm{s^{-1}}$, $K_d = 10^{-5}\\ \\mathrm{mol\\,m^{-3}}$, $A = 3.2\\times 10^{-5}\\ \\mathrm{m^2}$, $V_b = 2.0\\times 10^{-7}\\ \\mathrm{m^3}$, $d = 3.0\\times 10^{-4}\\ \\mathrm{m}$, $k_m = 2.0\\times 10^{-5}\\ \\mathrm{m\\,s^{-1}}$, $R_{\\text{tot}} = 2.0\\times 10^{-12}\\ \\mathrm{mol\\,m^{-2}}$, $C_{b,0} = 3.0\\times 10^{-5}\\ \\mathrm{mol\\,m^{-3}}$, $t_{\\text{meas}} = 6.0\\times 10^{2}\\ \\mathrm{s}$。\n- 案例2（过早测量）：与案例1相同，但 $t_{\\text{meas}} = 6.0\\times 10^{1}\\ \\mathrm{s}$。\n- 案例3（快速传输边界）：与案例1相同，但 $k_m = 1.0\\times 10^{-3}\\ \\mathrm{m\\,s^{-1}}$, $t_{\\text{meas}} = 6.0\\times 10^{2}\\ \\mathrm{s}$。\n- 案例4（接近饱和）：与案例1相同，但 $C_{b,0} = 1.0\\times 10^{-4}\\ \\mathrm{mol\\,m^{-3}}$, $t_{\\text{meas}} = 6.0\\times 10^{2}\\ \\mathrm{s}$。\n- 案例5（低浓度边缘情况）：与案例1相同，但 $C_{b,0} = 1.0\\times 10^{-6}\\ \\mathrm{mol\\,m^{-3}}$, $t_{\\text{meas}} = 6.0\\times 10^{2}\\ \\mathrm{s}$。\n\n最终输出格式：\n- 你的程序应产生单行输出，其中包含用方括号括起来的逗号分隔列表，按测试案例1到5的顺序，每个元素是相应案例的系统相对误差 $\\varepsilon$。例如，你的程序必须打印类似 $\\big[$result1$,$result2$,$result3$,$result4$,$result5$\\big]$ 的内容，不含空格。",
            "solution": "用户提供了一个问题，该问题要求对传输限制的免疫分析进行数值模拟，以量化表观平衡解离常数中的系统误差。\n\n### 步骤1：问题验证\n\n我将首先根据指定标准验证问题陈述。\n\n#### 已知条件提取\n\n问题提供了以下模型组件、参数和任务：\n\n**模型方程（耦合ODE）：**\n系统状态由三个变量描述：$B(t)$，结合配体的表面密度；$C_s(t)$，近表面配体浓度；以及 $C_b(t)$，主体配体浓度。\n1.  结合配体密度的变化率：\n    $$\\dfrac{dB}{dt} = k_{\\text{on}}\\,C_s(t)\\,\\big(R_{\\text{tot}} - B(t)\\big) - k_{\\text{off}}\\,B(t)$$\n2.  近表面浓度的变化率：\n    $$\\dfrac{dC_s}{dt} = \\dfrac{k_m}{d}\\,\\big(C_b(t) - C_s(t)\\big) - \\dfrac{1}{d}\\,\\dfrac{dB}{dt}$$\n3.  主体浓度的变化率：\n    $$\\dfrac{dC_b}{dt} = -\\dfrac{A k_m}{V_b}\\,(y_2 - y_1)$$\n\n**初始条件（在 $t=0$ 时）：**\n-   $B(0) = 0$\n-   $C_s(0) = C_{b,0}$\n-   $C_b(0) = C_{b,0}$\n\n**定义：**\n-   真实平衡解离常数：$K_d = \\dfrac{k_{\\text{off}}}{k_{\\text{on}}}$。\n-   表观平衡解离常数（在 $t_{\\text{meas}}$ 推断）：$K_d^{\\text{app}}$ 通过使用 $B(t_{\\text{meas}})$、$R_{\\text{tot}}$ 并假设平衡浓度为 $C_b(t_{\\text{meas}})$ 来反转 Langmuir 等温线 $B = R_{\\text{tot}} \\frac{C}{K_d+C}$ 计算得出。\n-   系统相对误差：$\\varepsilon = \\dfrac{K_d^{\\text{app}} - K_d}{K_d}$。\n\n**参数和物理单位：**\n-   $k_{\\text{on}}$: 结合速率常数 ($\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$)\n-   $k_{\\text{off}}$: 解离速率常数 ($\\mathrm{s^{-1}}$)\n-   $C_b, C_s$: 浓度 ($\\mathrm{mol\\,m^{-3}}$)\n-   $A$: 表面积 ($\\mathrm{m^2}$)\n-   $V_b$: 主体体积 ($\\mathrm{m^3}$)\n-   $d$: 近表面层厚度 ($\\mathrm{m}$)\n-   $k_m$: 质量传递系数 ($\\mathrm{m\\,s^{-1}}$)\n-   $R_{\\text{tot}}$: 总表面受体密度 ($\\mathrm{mol\\,m^{-2}}$)\n-   $B$: 结合的表面受体密度 ($\\mathrm{mol\\,m^{-2}}$)\n-   $t_{\\text{meas}}$: 测量时间 ($\\mathrm{s}$)\n\n**计算要求：**\n-   使用固定步长的显式四阶 Runge-Kutta (RK4) 积分器。\n-   选择足够小的步长以适应系统中的最快速率。\n-   在每一步强制执行约束 $0 \\le B(t) \\le R_{\\text{tot}}$ 和浓度的非负性。\n\n**测试套件：**\n提供了五个测试案例，包含（$k_{\\text{on}}$, $k_{\\text{off}}$, $A$, $V_b$, $d$, $k_m$, $R_{\\text{tot}}$, $C_{b,0}$, $t_{\\text{meas}}$）的具体参数值。\n\n#### 使用提取的已知条件进行验证\n\n1.  **科学依据：** 问题描述了一个带有质量传输限制的表面结合反应的双室模型。这是一个在生物物理学和化学工程中用于分析表面等离振子共振（SPR）、石英晶体微天平（QCM）和免疫分析动力学的标准且物理上真实的模型。方程基于质量作用动力学和质量守恒的基本原理。该模型在科学上是合理的。\n\n2.  **适定性：** 该问题是一个耦合常微分方程组的初值问题（IVP）。方程、初始条件以及所有必需的参数都已提供。任务是将系统积分到指定时间，然后执行代数计算。这种结构确保了唯一且有意义的解的存在。要求实现特定的数值方法（RK4）并提供步长选择指导，使得计算任务定义明确。\n\n3.  **客观性：** 问题使用精确的数学语言和可量化的参数进行陈述。目标是计算一个特定的、客观的度量（系统相对误差）。没有主观性或模糊性。\n\n4.  **未发现缺陷：**\n    -   模型方程内部一致。对配体总摩尔数守恒的检查证实了这一点：$\\frac{d}{dt} (C_b V_b + C_s A d + B A) = 0$。\n    -   问题是自包含的。模拟和计算所需的所有数据都在五个测试案例中提供。\n    -   测试案例中给出的参数值对于典型的微孔板免疫分析是物理上合理的。例如，体积 $V_b = 2.0\\times 10^{-7}\\ \\mathrm{m^3}$ 是 $200\\ \\mu\\mathrm{L}$，一个典型的孔体积。浓度 $K_d = 10^{-5}\\ \\mathrm{mol\\,m^{-3}}$ 是 $10\\ \\mu\\mathrm{M}$，是生物化学中的一个常见值。\n    -   该任务既不简单（它需要对非线性系统进行数值积分），也不是故作高深。它解决了诊断分析中的一个实际问题。\n\n#### 结论与行动\n\n问题是**有效的**。它具有科学依据、适定、客观且自包含。我现在将继续进行解题。\n\n### 解题设计\n\n问题的核心是数值求解一个包含三个耦合常微分方程的系统，然后使用其解来计算平衡测量中的系统误差。\n\n**1. 状态向量和ODE系统**\n\n设系统状态由向量 $\\mathbf{y}(t) = [y_0(t), y_1(t), y_2(t)]^T$ 表示，其中：\n-   $y_0(t) = B(t)$\n-   $y_1(t) = C_s(t)$\n-   $y_2(t) = C_b(t)$\n\nODE系统 $\\dfrac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$ 可以写为：\n$$\n\\begin{cases}\n\\dfrac{dy_0}{dt} = k_{\\text{on}}\\,y_1\\,\\big(R_{\\text{tot}} - y_0\\big) - k_{\\text{off}}\\,y_0 \\\\\n\\dfrac{dy_2}{dt} = -\\dfrac{A k_m}{V_b}\\,(y_2 - y_1) \\\\\n\\dfrac{dy_1}{dt} = \\dfrac{k_m}{d}\\,(y_2 - y_1) - \\dfrac{1}{d}\\,\\dfrac{dy_0}{dt}\n\\end{cases}\n$$\n注意，$y_1$ 的导数依赖于 $y_0$ 的导数。在评估函数 $\\mathbf{f}$ 时，必须先计算 $\\frac{dy_0}{dt}$。\n\n初始条件为 $\\mathbf{y}(0) = [0, C_{b,0}, C_{b,0}]^T$。\n\n**2. 数值积分：四阶 Runge-Kutta (RK4)**\n\n我们将使用显式固定步长 RK4 方法将系统从 $t=0$ 积分到 $t=t_{\\text{meas}}$。对于步长 $h$，在时间 $t_{n+1} = t_n + h$ 的状态由在 $t_n$ 的状态更新如下：\n$$ \\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{h}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4) $$\n其中\n$$\n\\begin{aligned}\n\\mathbf{k}_1 = \\mathbf{f}(t_n, \\mathbf{y}_n) \\\\\n\\mathbf{k}_2 = \\mathbf{f}(t_n + \\frac{h}{2}, \\mathbf{y}_n + \\frac{h}{2}\\mathbf{k}_1) \\\\\n\\mathbf{k}_3 = \\mathbf{f}(t_n + \\frac{h}{2}, \\mathbf{y}_n + \\frac{h}{2}\\mathbf{k}_2) \\\\\n\\mathbf{k}_4 = \\mathbf{f}(t_n + h, \\mathbf{y}_n + h\\mathbf{k}_3)\n\\end{aligned}\n$$\n由于我们的系统是自治的，函数 $\\mathbf{f}$ 不显式依赖于 $t$。\n\n**3. 时间步长选择**\n\n步长 $h$ 必须足够小，以解析系统中最快的动力学。特征速率为：\n-   结合/解离速率：$r_{\\text{bind}} = k_{\\text{on}}C_{b,0} + k_{\\text{off}}$\n-   近表面传输速率：$r_{\\text{transport}, s} = k_m/d$\n-   主体传输速率：$r_{\\text{transport}, b} = (A/V_b)k_m$\n\n最快的特征时间是 $\\tau_{\\text{min}} = 1 / \\max(r_{\\text{bind}}, r_{\\text{transport}, s}, r_{\\text{transport}, b})$。一个稳定且精确的步长的保守选择是 $h \\approx \\tau_{\\text{min}}/20$。为确保积分恰好在 $t_{\\text{meas}}$ 结束，我们将计算步数 $N = \\lceil t_{\\text{meas}} / h \\rceil$ 并使用修正后的步长 $h_{\\text{actual}} = t_{\\text{meas}} / N$。\n\n**4. 约束执行**\n\n在每个 RK4 步骤之后，将通过投影强制执行状态变量的物理约束：\n-   $y_0 \\leftarrow \\max(0, \\min(y_0, R_{\\text{tot}}))$\n-   $y_1 \\leftarrow \\max(0, y_1)$\n-   $y_2 \\leftarrow \\max(0, y_2)$\n这可以防止数值解漂移到非物理区域。\n\n**5. 系统误差（$\\varepsilon$）的计算**\n\n积分到 $t = t_{\\text{meas}}$ 后，我们获得最终状态向量 $\\mathbf{y}(t_{\\text{meas}}) = [B(t_{\\text{meas}}), C_s(t_{\\text{meas}}), C_b(t_{\\text{meas}})]^T$。\n1.  真实的平衡解离常数是 $K_d = k_{\\text{off}} / k_{\\text{on}}$。\n2.  表观常数 $K_d^{\\text{app}}$ 是基于 Langmuir 等温线，并错误地假设已达到平衡，且相关浓度为主体浓度 $C_b(t_{\\text{meas}})$：\n    $$ K_d^{\\text{app}} = C_b(t_{\\text{meas}}) \\left( \\frac{R_{\\text{tot}}}{B(t_{\\text{meas}})} - 1 \\right) $$\n    将向分母 $B(t_{\\text{meas}})$ 添加一个很小的 epsilon，以防止除以零，以防其在数值上为零。\n3.  然后，系统相对误差计算如下：\n    $$ \\varepsilon = \\frac{K_d^{\\text{app}} - K_d}{K_d} $$\n\n将对五个测试案例中的每一个执行此过程，以生成最终所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It simulates a transport-limited immunoassay, calculates the apparent\n    dissociation constant, and determines the systematic error.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (happy path)\n        {\n            'k_on': 1.0e2, 'k_off': 1.0e-3, 'A': 3.2e-5, 'V_b': 2.0e-7,\n            'd': 3.0e-4, 'k_m': 2.0e-5, 'R_tot': 2.0e-12,\n            'C_b0': 3.0e-5, 't_meas': 6.0e2\n        },\n        # Case 2 (premature measurement)\n        {\n            'k_on': 1.0e2, 'k_off': 1.0e-3, 'A': 3.2e-5, 'V_b': 2.0e-7,\n            'd': 3.0e-4, 'k_m': 2.0e-5, 'R_tot': 2.0e-12,\n            'C_b0': 3.0e-5, 't_meas': 6.0e1\n        },\n        # Case 3 (transport-fast boundary)\n        {\n            'k_on': 1.0e2, 'k_off': 1.0e-3, 'A': 3.2e-5, 'V_b': 2.0e-7,\n            'd': 3.0e-4, 'k_m': 1.0e-3, 'R_tot': 2.0e-12,\n            'C_b0': 3.0e-5, 't_meas': 6.0e2\n        },\n        # Case 4 (near saturation)\n        {\n            'k_on': 1.0e2, 'k_off': 1.0e-3, 'A': 3.2e-5, 'V_b': 2.0e-7,\n            'd': 3.0e-4, 'k_m': 2.0e-5, 'R_tot': 2.0e-12,\n            'C_b0': 1.0e-4, 't_meas': 6.0e2\n        },\n        # Case 5 (low-concentration edge)\n        {\n            'k_on': 1.0e2, 'k_off': 1.0e-3, 'A': 3.2e-5, 'V_b': 2.0e-7,\n            'd': 3.0e-4, 'k_m': 2.0e-5, 'R_tot': 2.0e-12,\n            'C_b0': 1.0e-6, 't_meas': 6.0e2\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        error = _solve_single_case(params)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15g}' for r in results)}]\")\n\ndef _solve_single_case(params):\n    \"\"\"\n    Solves the ODE system for a single set of parameters and returns the systematic error.\n    \"\"\"\n    k_on = params['k_on']\n    k_off = params['k_off']\n    A = params['A']\n    V_b = params['V_b']\n    d = params['d']\n    k_m = params['k_m']\n    R_tot = params['R_tot']\n    C_b0 = params['C_b0']\n    t_meas = params['t_meas']\n\n    def ode_system(y, p):\n        \"\"\"\n        Defines the system of ODEs dy/dt = f(y, p).\n        y = [B, Cs, Cb]\n        \"\"\"\n        B, Cs, Cb = y\n        k_on, k_off, A, V_b, d, k_m, R_tot = p\n        \n        # Rate of change for bound ligand density B\n        dB_dt = k_on * Cs * (R_tot - B) - k_off * B\n        \n        # Rate of change for bulk concentration Cb\n        dCb_dt = -(A * k_m / V_b) * (Cb - Cs)\n        \n        # Rate of change for near-surface concentration Cs\n        dCs_dt = (k_m / d) * (Cb - Cs) - (1 / d) * dB_dt\n        \n        return np.array([dB_dt, dCs_dt, dCb_dt])\n\n    # Pack parameters for the ODE function\n    p_tuple = (k_on, k_off, A, V_b, d, k_m, R_tot)\n\n    # Initial conditions: y = [B, Cs, Cb]\n    y = np.array([0.0, C_b0, C_b0])\n\n    # Time step selection\n    rate_bind = k_on * C_b0 + k_off\n    rate_transport_s = k_m / d\n    rate_transport_b = (A / V_b) * k_m\n    max_rate = max(rate_bind, rate_transport_s, rate_transport_b)\n    \n    # Heuristic for time step\n    tau_min = 1.0 / max_rate\n    h_suggested = tau_min / 20.0  # Use factor of 20 for safety\n\n    # Ensure the integration ends exactly at t_meas\n    if t_meas == 0:\n        num_steps = 0\n        h = 0\n    else:\n        num_steps = int(np.ceil(t_meas / h_suggested))\n        h = t_meas / num_steps\n\n    # RK4 integration loop\n    for _ in range(num_steps):\n        k1 = ode_system(y, p_tuple)\n        k2 = ode_system(y + 0.5 * h * k1, p_tuple)\n        k3 = ode_system(y + 0.5 * h * k2, p_tuple)\n        k4 = ode_system(y + h * k3, p_tuple)\n        y = y + (h / 6.0) * (k1 + 2 * k2 + 2 * k3 + k4)\n\n        # Enforce physical constraints\n        y[0] = max(0.0, min(y[0], R_tot))  # 0 = B = R_tot\n        y[1] = max(0.0, y[1])              # Cs >= 0\n        y[2] = max(0.0, y[2])              # Cb >= 0\n\n    B_meas, _, Cb_meas = y\n\n    # Calculate true and apparent Kd\n    K_d_true = k_off / k_on\n\n    # Add machine epsilon to prevent division by zero\n    if B_meas == 0:\n        # If no binding, apparent affinity is zero (Kd is infinite)\n        # This implies an infinite relative error\n        K_d_app = np.inf\n    else:\n        K_d_app = Cb_meas * (R_tot / B_meas - 1.0)\n    \n    # Calculate relative error\n    if K_d_true == 0:\n        # Avoid division by zero if k_off is 0 (irreversible binding)\n        if K_d_app == 0:\n            error = 0.0\n        else:\n            error = np.inf\n    else:\n        error = (K_d_app - K_d_true) / K_d_true\n\n    return error\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}