{
    "hands_on_practices": [
        {
            "introduction": "在变异识别的旅程开始之前，我们必须首先学会评估我们原始数据的质量。高通量测序中的每个碱基检出都伴随着一个Phred质量分数，它是衡量该碱基准确性的通用语言。这个练习将指导您将这个对数尺度的分数 $Q$ 转换回直观的错误概率 $p$，这是所有下游分析，从变异识别到基因型确定，都依赖的根本基石 。",
            "id": "5170233",
            "problem": "在用于分子诊断和免疫诊断的高通量测序中，碱基检出结果会附带一个Phred质量分数，该分数编码了错误碱基检出的后验概率，这对于变异检出、注释和优先排序至关重要。请提供Phred质量分数的精确定义，即其作为碱基检出错误概率的对数转换，并从此定义出发，推导出从报告的碱基质量 $Q$ 到相应错误概率 $p$ 的显式映射关系。然后，计算当 $Q=30$ 和 $Q=20$ 时的 $p$ 值。将每个 $p$ 表示为精确的十进制小数，不进行四舍五入。",
            "solution": "Phred质量分数，记为 $Q$，为测序数据中碱基检出的质量提供了一个定量度量。它被定义为相应碱基检出不正确的后验概率 $p$ 的以10为底的负对数。其数学定义为：\n$$Q = -10 \\log_{10}(p)$$\n负号确保了较低的错误概率 $p$ 对应较高的质量分数 $Q$。\n\n为了推导出从质量分数 $Q$ 到错误概率 $p$ 的显式映射关系，我们对定义方程进行代数求解：\n$$-\\frac{Q}{10} = \\log_{10}(p)$$\n$$10^{\\left(-\\frac{Q}{10}\\right)} = 10^{\\log_{10}(p)}$$\n$$p = 10^{-\\frac{Q}{10}}$$\n该方程允许根据给定的Phred质量分数 $Q$ 直接计算碱基检出错误概率 $p$。\n\n我们现在使用这个推导出的公式来计算指定 $Q$ 值对应的 $p$。\n\n对于Phred质量分数 $Q=30$：\n$$p = 10^{-\\frac{30}{10}} = 10^{-3} = 0.001$$\n这对应于错误碱基检出的概率为千分之一，或者说碱基检出准确率为 $99.9\\%$。\n\n对于Phred质量分数 $Q=20$：\n$$p = 10^{-\\frac{20}{10}} = 10^{-2} = 0.01$$\n这对应于错误碱基检出的概率为百分之一，或者说碱基检出准确率为 $99\\%$。\n\n$Q=30$ 和 $Q=20$ 计算出的概率分别为 $0.001$ 和 $0.01$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.001 & 0.01 \\end{pmatrix}}$$"
        },
        {
            "introduction": "理解了单个碱基的错误概率后，下一步自然是整合来自多条测序读数（reads）的证据，以推断特定位点的最可能基因型。本练习将介绍基因型似然性 $P(D \\mid G)$ 的核心概念，它使用二项分布模型，将观察到的等位基因读数计数和已知的测序错误率结合起来，量化对不同基因型（如纯合参考、杂合或纯合变异）的支持程度 。这是变异识别引擎核心的统计推理过程。",
            "id": "5170271",
            "problem": "在变异调用格式 (VCF) 中评估一个双等位基因单核苷酸变异，其中等位基因深度 (AD) 字段报告了支持参考等位基因和备选等位基因的观测测序读数计数。设观测数据为 $D$，由 $AD=(28,2)$ 概括，表示在该位点有 $28$ 条测序读数支持参考等位基因， $2$ 条测序读数支持备选等位基因。假设所有测序读数的均一碱基检出错误率为 $e=0.01$，且该错误率与测序读数位置和碱基身份无关，并且在给定真实二倍体基因型 $G \\in \\{AA, AB, BB\\}$ 的条件下，测序读数是独立的。\n\n从基因型似然 $P(D \\mid G)$ 的定义（即在一个经过充分检验的测序错误模型下，给定基因型时观测到数据的概率）出发，利用测序读数的独立性和聚合具有相同单次测序读数发射概率的测序读数所蕴含的二项分布，推导出 $P(D \\mid AA)$、$P(D \\mid AB)$ 和 $P(D \\mid BB)$ 的表达式。然后，描述VCF PL字段中使用的Phred质量分数编码，其中 $PL=-10\\log_{10}\\big(P(D \\mid G)\\big)$，并利用给定的 $AD$ 和 $e$ 计算三种基因型 $AA$、$AB$ 和 $BB$ 的 $PL$ 值。\n\n请将您的最终答案表示为按 $AA$、$AB$、$BB$ 顺序排列的单行矩阵，并将每个值四舍五入到三位有效数字。无需单位。",
            "solution": "### 基因型似然的推导\n基因型似然 $P(D \\mid G)$ 指的是在给定真实基因型 $G$ 的情况下，观测到特定测序数据 $D$ 的概率。我们可以使用二项分布对此进行建模。数据 $D$ 为 $n_{ref}=28$ 条参考读数和 $n_{alt}=2$ 条备选读数，总读数 $N=30$。碱基检出错误率为 $e=0.01$。我们为三种可能的基因型推导似然性：\n\n1.  **基因型 $G=AA$ (纯合参考型)**：观测到备选等位基因 ($B$) 的概率为测序错误率 $p_{AA} = e$。\n    $$P(D \\mid AA) = \\binom{30}{2} e^{2} (1-e)^{28}$$\n\n2.  **基因型 $G=AB$ (杂合型)**：假设从两条染色体中抽样的概率相等，观测到备选等位基因的概率为 $p_{AB} = 0.5(1-e) + 0.5e = 0.5$。\n    $$P(D \\mid AB) = \\binom{30}{2} (0.5)^{2} (0.5)^{28} = \\binom{30}{2} (0.5)^{30}$$\n\n3.  **基因型 $G=BB$ (纯合备选型)**：观测到备选等位基因的概率为正确读取的概率 $p_{BB} = 1-e$。\n    $$P(D \\mid BB) = \\binom{30}{2} (1-e)^{2} e^{28}$$\n\n### PL值的计算\nPhred标度似然（PL）字段定义为 $PL(G) = -10\\log_{10}(P(D \\mid G))$。较低的PL值表示较高的似然性。\n二项式系数 $\\binom{30}{2} = 435$。\n\n-   **$AA$ 的 PL 值**：\n    $P(D \\mid AA) = 435 \\times (0.01)^{2} \\times (0.99)^{28} \\approx 0.03285$\n    $PL_{AA} = -10 \\log_{10}(0.03285) \\approx 14.835$\n\n-   **$AB$ 的 PL 值**：\n    $P(D \\mid AB) = 435 \\times (0.5)^{30} \\approx 4.051 \\times 10^{-7}$\n    $PL_{AB} = -10 \\log_{10}(4.051 \\times 10^{-7}) \\approx 63.924$\n\n-   **$BB$ 的 PL 值**：\n    $P(D \\mid BB) = 435 \\times (0.99)^{2} \\times (0.01)^{28} \\approx 4.264 \\times 10^{-54}$\n    $PL_{BB} = -10 \\log_{10}(4.264 \\times 10^{-54}) \\approx 533.70$\n\n四舍五入到三位有效数字，PL值分别为 $14.8$ ($AA$), $63.9$ ($AB$), 和 $534$ ($BB$)。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n14.8 & 63.9 & 534\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在成功识别并注释一个变异后，临床诊断的最终目标是评估其致病性。这个过程需要整合来自不同来源的、性质各异的证据，包括家族共分离、人群频率、功能实验和计算机预测。本练习将演示如何应用强大的贝叶斯框架，将这些独立的证据（以似然比 $LR$ 的形式量化）结合起来，从而系统性地更新我们对一个变异是否致病的先验信念，最终得出一个后验概率 。这个过程模拟了美国医学遗传学与基因组学学会（ACMG）等权威机构推荐的变异解读标准。",
            "id": "5170293",
            "problem": "一个与原发性免疫缺陷相关的细胞因子受体基因中的罕见错义变异正在被评估其致病性，评估采用的是分子和免疫诊断证据。根据历史数据整理，一个基因和变异类别特异性的致病性基线先验概率已知：先验概率为 $P_{0} = 0.02$。已收集了多条独立的证据，并将其校准为定量的似然比，每个似然比定义为 $LR = \\frac{P(\\text{evidence} \\mid \\text{pathogenic})}{P(\\text{evidence} \\mid \\text{benign})}$。可用的证据及其校准后的似然比如下：\n- 跨越三代的家族共分离分析得出的分离贝叶斯因子为 $BF_{\\text{seg}} = 5.0$，可视为似然比 $LR_{\\text{seg}} = 5.0$。\n- 在受影响队列与对照组中的病例-对照富集分析得出 $LR_{\\text{case}} = 8.5$。\n- 基于细胞的功能性分析显示信号活性降至野生型的 $15\\%$，该分析的校准将此结果映射为 $LR_{\\text{func}} = 12.0$。\n- 群体约束分析表明，该变异的观测等位基因频率略高于完全外显疾病的预期值；这映射为一个支持良性的似然比 $LR_{\\text{pop}} = 0.2$。\n- 一个根据金标准变异集校准的集成计算预测得出 $LR_{\\text{comp}} = 3.2$。\n\n假设在真实的致病性状态条件下，这些证据成分在优势比框架下是独立的且可乘的。仅从贝叶斯定理和优势比的定义出发，推导致病性后验概率 $P_{1} = P(\\text{pathogenic} \\mid \\text{all evidence})$ 关于 $P_{0}$ 和所提供似然比的解析表达式，然后根据给定数据计算其数值。将先验概率 $P_{0}$ 和后验概率 $P_{1}$ 均以小数形式报告，并四舍五入至四位有效数字。百分比必须表示为小数。",
            "solution": "该问题要求在给定先验概率 $P_0$ 和几条量化为似然比（$LR$）的独立证据的情况下，推导并计算致病性的后验概率 $P_1$。\n\n设 $H_P$ 为变异是致病的假设，$H_B$ 为变异是良性的假设。先验概率 $P(H_P) = P_0 = 0.02$。\n根据贝叶斯定理的优势比形式，后验优势比是先验优势比与总似然比的乘积。由于证据独立，总似然比 $LR_{\\text{total}}$ 是各独立似然比的乘积：\n$$LR_{\\text{total}} = \\prod_{i} LR_i = 5.0 \\times 8.5 \\times 12.0 \\times 0.2 \\times 3.2 = 326.4$$\n\n后验概率 $P_1 = P(H_P \\mid \\text{evidence})$ 可以直接通过以下公式计算：\n$$P_1 = \\frac{P_0 \\times LR_{\\text{total}}}{(1-P_0) + P_0 \\times LR_{\\text{total}}}$$\n\n代入数值进行计算：\n$$P_1 = \\frac{0.02 \\times 326.4}{(1-0.02) + (0.02 \\times 326.4)} = \\frac{6.528}{0.98 + 6.528} = \\frac{6.528}{7.508} \\approx 0.86947256$$\n\n问题要求将 $P_0$ 和 $P_1$ 都四舍五入到四位有效数字后报告。\n- 先验概率 $P_0 = 0.02000$\n- 后验概率 $P_1 = 0.8695$",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.02000 & 0.8695 \\end{pmatrix}}$$"
        }
    ]
}