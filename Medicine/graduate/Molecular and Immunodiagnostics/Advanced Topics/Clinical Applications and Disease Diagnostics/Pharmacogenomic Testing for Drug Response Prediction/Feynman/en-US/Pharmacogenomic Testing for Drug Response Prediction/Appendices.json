{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of clinical pharmacogenomics is the ability to translate complex genetic information, such as a patient's diplotype, into a simple, actionable metric for predicting drug metabolism. The activity score system provides this standardized translation, and this exercise focuses on its calculation. You will practice applying the additive model to a diplotype that includes a gene duplication , a common and clinically significant type of structural variation in genes like $CYP2D6$.",
            "id": "5146988",
            "problem": "A clinical pharmacogenomics assay in a molecular diagnostics laboratory uses quantitative Polymerase Chain Reaction (PCR) to detect copy number variation at the cytochrome P450 family 2 subfamily D member 6 (CYP2D6) locus and allele-specific genotyping to assign star-alleles. Consider a patient whose diplotype is reported as $\\ast 1 \\times 2 / \\ast 4$, indicating two copies of the $\\ast 1$ allele on one chromosome and a single $\\ast 4$ allele on the other chromosome. In the commonly adopted activity score framework, each star-allele is assigned a normalized functional contribution, here $1.0$ for $\\ast 1$ and $0.0$ for $\\ast 4$. Assume the following fundamental base consistent with the Central Dogma and first-order gene dosage principles: genetic copy number proportionally scales messenger ribonucleic acid (mRNA) and enzyme abundance under comparable regulatory context, and independent allele contributions to catalytic capacity add under sub-saturating conditions. Further assume that duplication multiplies the contribution of the duplicated allele by its copy number.\n\nUsing these principles, compute the CYP2D6 activity score for this diplotype. Express your final result as a dimensionless real number. No rounding is required.",
            "solution": "The problem requires the calculation of a Cytochrome P450 family 2 subfamily D member 6 ($\\text{CYP2D6}$) activity score for a given diplotype based on a set of clearly defined principles. The validation of the problem statement is the mandatory first step.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n-   **Patient Diplotype**: $\\ast 1 \\times 2 / \\ast 4$. This is specified to mean \"two copies of the $\\ast 1$ allele on one chromosome and a single $\\ast 4$ allele on the other chromosome.\"\n-   **Allele Activity Values**: The normalized functional contribution for the $\\ast 1$ allele is $1.0$. The normalized functional contribution for the $\\ast 4$ allele is $0.0$.\n-   **Fundamental Principles**:\n    1.  **Gene Dosage**: Genetic copy number proportionally scales messenger ribonucleic acid ($\\text{mRNA}$) and enzyme abundance.\n    2.  **Additivity**: Independent allele contributions to catalytic capacity are additive.\n    3.  **Duplication Rule**: The contribution of a duplicated allele is its base activity value multiplied by its copy number.\n-   **Objective**: Compute the $\\text{CYP2D6}$ activity score for the specified diplotype.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem is firmly rooted in the established clinical field of pharmacogenomics. The use of star-allele nomenclature ($\\ast$ alleles) for the $\\text{CYP2D6}$ gene, the concept of copy number variation (CNV), and the calculation of an activity score to predict metabolic phenotype are standard practices in molecular diagnostics. The activity values assigned to the $\\ast 1$ (normal function) and $\\ast 4$ (no function) alleles are correct and widely accepted. The principles of gene dosage and additivity are the foundational assumptions for this scoring system. The problem is scientifically sound and factually correct.\n-   **Well-Posedness**: The problem is well-posed. It provides an unambiguous diplotype, specific activity values for each allele type, and a clear, deterministic algorithm for combining these values (summation of contributions from each chromosome, with multiplication for copy number). This structure leads to a unique and meaningful numerical solution.\n-   **Objectivity**: The problem is stated in precise, objective, and technical language, free from ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically sound, well-posed, objective, and contains all necessary information for a unique solution. It is therefore deemed **valid**. The solution process will now proceed.\n\n**Solution Derivation**\n\nThe total $\\text{CYP2D6}$ activity score, which we denote as $S_{\\text{activity}}$, is calculated by summing the contributions from each of the two haplotypes (the set of alleles on each chromosome). The patient's diplotype is given as $\\ast 1 \\times 2 / \\ast 4$. This represents two haplotypes: Haplotype A, which is $\\ast 1 \\times 2$, and Haplotype B, which is $\\ast 4$.\n\nLet $S_A$ be the activity score contribution from Haplotype A and $S_B$ be the contribution from Haplotype B. The total activity score is given by the principle of additivity:\n$$S_{\\text{activity}} = S_A + S_B$$\n\nWe must first calculate the contribution of each haplotype.\n\n**1. Contribution of Haplotype A ($\\ast 1 \\times 2$)**\nThis notation signifies that the $\\ast 1$ allele is present in two copies on this chromosome due to a gene duplication event. According to the stated duplication rule, the contribution of this haplotype is the activity score of the base allele multiplied by its copy number.\nLet $v(\\ast 1)$ be the activity value of the $\\ast 1$ allele, and let $n_A$ be its copy number on this haplotype.\n-   The activity value for the $\\ast 1$ allele is given as $v(\\ast 1) = 1.0$.\n-   The copy number is given as $n_A = 2$.\n\nThe contribution from Haplotype A is:\n$$S_A = v(\\ast 1) \\times n_A = 1.0 \\times 2 = 2.0$$\n\n**2. Contribution of Haplotype B ($\\ast 4$)**\nThis haplotype consists of a single copy of the $\\ast 4$ allele.\nLet $v(\\ast 4)$ be the activity value of the $\\ast 4$ allele. The copy number is implicitly $n_B = 1$.\n-   The activity value for the $\\ast 4$ allele is given as $v(\\ast 4) = 0.0$.\n-   The copy number is $n_B = 1$.\n\nThe contribution from Haplotype B is:\n$$S_B = v(\\ast 4) \\times n_B = 0.0 \\times 1 = 0.0$$\n\n**3. Total Activity Score**\nFinally, we sum the contributions from both haplotypes to find the total activity score for the diplotype.\n$$S_{\\text{activity}} = S_A + S_B = 2.0 + 0.0 = 2.0$$\n\nThe resulting $\\text{CYP2D6}$ activity score is a dimensionless real number, as required. This score is commonly used to classify the patient's metabolic phenotype. In this case, a score of $2.0$ typically corresponds to a normal metabolizer, despite the presence of a non-functional allele, because the duplication of the functional allele compensates for it.",
            "answer": "$$\\boxed{2.0}$$"
        },
        {
            "introduction": "While a patient's genotype provides a baseline for their metabolic capacity, this prediction is not static and can be significantly altered by external factors like co-administered medications. This phenomenon, known as phenoconversion, can lead to a divergence between the genetically predicted phenotype and the actual metabolic activity observed in the patient. This practice  demonstrates how to quantitatively adjust a basal activity score to account for the functional inhibition caused by a co-medication, providing a more accurate, context-dependent prediction.",
            "id": "5147014",
            "problem": "A clinical laboratory is assessing the predicted metabolic phenotype for Cytochrome P450 2D6 (CYP2D6) in a patient to inform drug response prediction. The patient’s CYP2D6 diplotype is reported as $\\ast 4/\\ast 10$. Paroxetine, a time-dependent inhibitor of CYP2D6, is coadministered and causes a fractional functional inhibition of $\\alpha = 0.80$ under steady-state therapeutic exposure conditions.\n\nUse the following foundational principles, which are standard in pharmacogenomic implementation and enzyme kinetics:\n\n- Under the Michaelis–Menten framework, the steady-state metabolic rate for a substrate $S$ is $v = \\frac{V_{\\max}[S]}{K_{m} + [S]}$. In the clinically relevant regime where $[S] \\ll K_{m}$, the capacity scales with $\\frac{V_{\\max}}{K_{m}}$ and is linearly proportional to enzyme quantity and function.\n- The CYP2D6 activity score is an additive index of allele function contributions that scales the basal metabolic capacity: normal function allele contributes $1$, increased function allele contributes $2$, decreased function allele contributes $0.25$, and no function allele contributes $0$. For this patient, $\\ast 4$ is a no function allele and $\\ast 10$ is a decreased function allele.\n- Phenoconversion due to a mechanism-based or strong inhibitor that produces a fractional inhibition $\\alpha$ reduces the apparent metabolic capacity to the fraction of uninhibited enzyme, which, under the low-substrate linear regime, is the remaining fraction $1 - \\alpha$ of the basal capacity.\n\nAssume no copy number variation, no concurrent inducers, and that allelic effects are additive and substrate-neutral for the purposes of the activity score. Compute the effective activity score after accounting for phenoconversion by paroxetine. Then, classify the metabolizer category using the following activity-score thresholds applied to the effective activity score: poor metabolizer if $AS < 0.10$, intermediate metabolizer if $0.10 \\leq AS < 1.0$, normal metabolizer if $1.0 \\leq AS \\leq 2.25$, and ultrarapid metabolizer if $AS > 2.25$.\n\nProvide your final answer as a row matrix containing two entries:\n- the effective activity score, expressed exactly (no rounding), and\n- a category code defined as $0$ for poor metabolizer, $1$ for intermediate metabolizer, $2$ for normal metabolizer, and $3$ for ultrarapid metabolizer.\n\nNo units are required for the final answer.",
            "solution": "The goal is to compute an effective CYP2D6 activity score that accounts for the patient’s genotype-derived basal activity and the reduction in apparent capacity caused by the inhibitor paroxetine. We begin from enzyme kinetic principles and the activity score construct.\n\nFundamental base in enzyme kinetics: The Michaelis–Menten equation $v = \\frac{V_{\\max}[S]}{K_{m} + [S]}$ implies that when $[S] \\ll K_{m}$, the rate $v$ is approximately linear in $[S]$ with proportionality constant $\\frac{V_{\\max}}{K_{m}}$. In this regime, any proportional changes in effective enzyme quantity or catalytic function scale $V_{\\max}$ (or equivalently the ratio $\\frac{V_{\\max}}{K_{m}}$) linearly. Genotype affects basal $V_{\\max}$ through altered enzyme expression or function, and inhibitors reduce apparent $V_{\\max}$ or increase apparent $K_{m}$ depending on mechanism. For a mechanism-based or strong time-dependent inhibitor producing a fractional inhibition $\\alpha$ of the functional enzyme, the remaining uninhibited fraction is $1 - \\alpha$, thus effective capacity scales by $1 - \\alpha$ relative to the basal capacity.\n\nActivity score construct: The CYP2D6 activity score (AS) used in implementation (for example, by the Clinical Pharmacogenetics Implementation Consortium (CPIC)) is an additive index of allele contributions, where no function contributes $0$, decreased function contributes $0.25$, normal function contributes $1$, and increased function contributes $2$. For this patient’s diplotype $\\ast 4/\\ast 10$, we have:\n- $\\ast 4$ is a no function allele, contributing $0$.\n- $\\ast 10$ is a decreased function allele, contributing $0.25$.\n\nTherefore, the basal activity score is the sum of the two contributions:\n$$\nAS_{\\text{basal}} = 0 + 0.25 = 0.25.\n$$\n\nPhenoconversion by paroxetine: Paroxetine produces a fractional functional inhibition of $\\alpha = 0.80$, which implies the remaining fraction of capacity is $1 - \\alpha = 0.20$. Under the low-substrate linear regime and the additive activity score framework that scales capacity, the effective activity score becomes:\n$$\nAS_{\\text{eff}} = (1 - \\alpha)\\,AS_{\\text{basal}} = 0.20 \\times 0.25 = 0.05 = \\frac{1}{20}.\n$$\n\nMetabolizer category classification: Using the provided thresholds applied to $AS_{\\text{eff}}$:\n- Poor metabolizer if $AS < 0.10$.\n- Intermediate metabolizer if $0.10 \\leq AS < 1.0$.\n- Normal metabolizer if $1.0 \\leq AS \\leq 2.25$.\n- Ultrarapid metabolizer if $AS > 2.25$.\n\nSince $AS_{\\text{eff}} = 0.05$ satisfies $AS_{\\text{eff}} < 0.10$, the category is poor metabolizer. The corresponding code is $0$.\n\nThus, the final answer is the row matrix containing the exact effective activity score and the category code:\n$$\n\\begin{pmatrix}\n\\frac{1}{20} & 0\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{20} & 0\\end{pmatrix}}$$"
        },
        {
            "introduction": "The clinical utility of any pharmacogenomic prediction hinges on the analytical accuracy of the test used to generate the genotype data. Before a laboratory can report results, it must rigorously validate the performance of its assay. This final exercise  provides hands-on practice with this critical quality assurance step, guiding you through the calculation of fundamental diagnostic performance metrics—sensitivity, specificity, positive predictive value (PPV), and negative predictive value (NPV)—from a validation dataset.",
            "id": "5147039",
            "problem": "A clinical laboratory is validating a targeted Next-Generation Sequencing (NGS) pharmacogenomics panel used to predict drug response by detecting functionally relevant single-nucleotide variants and small insertions or deletions across pharmacogenes (for example, cytochrome P450 family genes and human leukocyte antigen loci). The validation dataset consists of $10000$ independently verified loci, partitioned into $1000$ loci that truly harbor variants and $9000$ loci that are truly non-variant. The assay under test reports $980$ correctly detected variant loci and exhibits $20$ missed variant loci and $10$ spurious variant calls relative to the truth set. Using standard diagnostic test performance measures grounded in the confusion matrix framework for binary classification in molecular diagnostics, compute the sensitivity, specificity, positive predictive value (PPV), and negative predictive value (NPV) of the assay.\n\nExpress all four quantities as decimals and round each to four significant figures. Provide your results in the order: sensitivity, specificity, PPV, NPV.",
            "solution": "The problem requires the calculation of four standard performance metrics for a diagnostic assay: sensitivity, specificity, positive predictive value (PPV), and negative predictive value (NPV). The problem statement is validated as scientifically grounded, well-posed, objective, and internally consistent. All necessary data are provided to construct a confusion matrix and compute the required values.\n\nLet us first define the fundamental quantities used in a binary classification context. The performance of the assay is evaluated by comparing its output (test positive or test negative) against the true condition of each locus (variant present or variant absent).\n\n-   **Condition Positive ($P$)**: Loci that truly harbor a variant.\n-   **Condition Negative ($N_{neg}$)**: Loci that are truly non-variant.\n-   **True Positive ($TP$)**: The number of condition positive loci correctly identified by the assay as having a variant.\n-   **False Negative ($FN$)**: The number of condition positive loci incorrectly identified by the assay as non-variant (i.e., missed variants).\n-   **True Negative ($TN$)**: The number of condition negative loci correctly identified by the assay as non-variant.\n-   **False Positive ($FP$)**: The number of condition negative loci incorrectly identified by the assay as having a variant (i.e., spurious calls).\n\nFrom the problem statement, we are given the following values:\n-   Total loci, $N_{total} = 10000$.\n-   The number of true variant loci, $P = 1000$.\n-   The number of true non-variant loci, $N_{neg} = 9000$.\n-   The number of correctly detected variant loci, $TP = 980$.\n-   The number of missed variant loci, $FN = 20$.\n-   The number of spurious variant calls, $FP = 10$.\n\nWe must check the internal consistency of these givens. The total number of condition positive loci is the sum of those correctly identified and those missed:\n$$P = TP + FN$$\nSubstituting the provided values:\n$$1000 = 980 + 20$$\nThis is consistent.\n\nThe total number of condition negative loci is the sum of those correctly identified as non-variant ($TN$) and those incorrectly identified as variant ($FP$). Thus, we can deduce the number of true negatives:\n$$N_{neg} = TN + FP$$\n$$9000 = TN + 10$$\n$$TN = 9000 - 10 = 8990$$\n\nWe can summarize these values in a $2 \\times 2$ confusion matrix:\n\n| | Test Positive | Test Negative | Row Total |\n| :--- | :---: | :---: | :---: |\n| **Condition Positive** | $TP = 980$ | $FN = 20$ | $1000$ |\n| **Condition Negative** | $FP = 10$ | $TN = 8990$ | $9000$ |\n| **Column Total**| $990$ | $9010$ | $10000$ |\n\nWith these values, we can compute the four requested metrics.\n\n**1. Sensitivity (True Positive Rate)**\nSensitivity measures the proportion of actual positives that are correctly identified as such.\n$$ \\text{Sensitivity} = \\frac{TP}{TP + FN} $$\nSubstituting the values:\n$$ \\text{Sensitivity} = \\frac{980}{980 + 20} = \\frac{980}{1000} = 0.9800 $$\nThis value is exact and already has four significant figures.\n\n**2. Specificity (True Negative Rate)**\nSpecificity measures the proportion of actual negatives that are correctly identified as such.\n$$ \\text{Specificity} = \\frac{TN}{TN + FP} $$\nSubstituting the values:\n$$ \\text{Specificity} = \\frac{8990}{8990 + 10} = \\frac{8990}{9000} = 0.99888\\ldots $$\nRounding to four significant figures, we get $0.9989$.\n\n**3. Positive Predictive Value (PPV)**\nPPV measures the proportion of positive test results that are true positives.\n$$ \\text{PPV} = \\frac{TP}{TP + FP} $$\nSubstituting the values:\n$$ \\text{PPV} = \\frac{980}{980 + 10} = \\frac{980}{990} \\approx 0.989898\\ldots $$\nRounding to four significant figures, we get $0.9899$.\n\n**4. Negative Predictive Value (NPV)**\nNPV measures the proportion of negative test results that are true negatives.\n$$ \\text{NPV} = \\frac{TN}{TN + FN} $$\nSubstituting the values:\n$$ \\text{NPV} = \\frac{8990}{8990 + 20} = \\frac{8990}{9010} \\approx 0.997780\\ldots $$\nRounding to four significant figures, we get $0.9978$.\n\nThe final results, rounded to four significant figures and presented in the requested order (sensitivity, specificity, PPV, NPV), are $0.9800$, $0.9989$, $0.9899$, and $0.9978$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9800 & 0.9989 & 0.9899 & 0.9978\n\\end{pmatrix}\n}\n$$"
        }
    ]
}